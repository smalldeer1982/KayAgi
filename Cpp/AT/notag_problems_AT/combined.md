

---

---
title: "[ABC012D] バスと避けられない運命"
layout: "post"
diff: 普及/提高-
pid: AT_abc012_4
tag: []
---

# [ABC012D] バスと避けられない運命

## 题目描述

高桥君，不太喜欢公共汽车。

但是，一进入社会，就无法避免乘坐公共汽车的行为。

进入社会后，从自家到公司，必须坐公共汽车上班。高桥君还没拿到录取单，不知道要进入哪家公司，自然也就不知道公司在哪儿。高桥君经常想象乘坐巴士情况。他只想象时间最长、最坏的情况。我想把乘坐这个最坏情况的巴士的时间搬到让高桥君上班时间尽量缩短的地方。

PS：最坏的情况是指，乘坐巴士的时间合计最短，选择所乘坐的巴士时，是指在坐公共汽车的时间合计会变长的位置有公司的情况。

另外，从家中去公司时，可以选择高桥乘坐的巴士，高桥君选择乘坐巴士的时间合计最短的路径。各巴士在 $2$ 个公交车站来回行驶，去、回所需时间没有差别。随时都可以乘坐巴士，可以忽略转乘所花费的时间等。

另外，自家和公司与公共汽车站相邻，不能步行到其他巴士站，也不能通过巴士以外的方法进行移动。为高桥君找个搬家的地方，请输出搬到那里时，要坐公交车时间的最大值。

## 输入格式

在第一行，以空格分隔提供表示停靠站数的整数 $N(2\le N\le 300)$ 和表示路线数量的整数 $M(N-1\le M\le 44850)$。

接下来的第 $2$ 行到 $M$ 行表示总线的信息。在第 $i$ 行中，表示与总线的出发地点往返的 $2$ 个停靠站的编号 $a_i,b_i(1\le a_i,b_i\le N,b_{i+1}\le a_i,b_i\le N)$，和表示该移动需要多少分钟的数字 $t_i(1\le t_i\le 1000)$，分别由整数给出。保障了不存在的巴士站的对不存在。保证 $a_i\ne b_i$。

在某 $2$ 个停靠站上往返的路线只有 $1$ 个。

## 输出格式

如题，注意末尾要换行。

感谢 @longtaoxuan 提供的翻译。

## 样例 #1

### 输入

```
3 2

1 2 10

2 3 10
```

### 输出

```
10
```

## 样例 #2

### 输入

```
5 5

1 2 12

2 3 14

3 4 7

4 5 9

5 1 18
```

### 输出

```
26
```

## 样例 #3

### 输入

```
4 6

1 2 1

2 3 1

3 4 1

4 1 1

1 3 1

4 2 1
```

### 输出

```
1
```



---

---
title: "[ABC015C] 高橋くんのバグ探し"
layout: "post"
diff: 普及/提高-
pid: AT_abc015_3
tag: []
---

# [ABC015C] 高橋くんのバグ探し

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc015/tasks/abc015_3

高橋くんは上司からあるアンケートアプリにバグがあるかどうか調べて欲しいと頼まれました。

このアプリは、ユーザに選択肢が $ K $ 個ある質問を $ N $ 回答えさせることにより、ユーザの性格を判定します。 質問や選択肢はユーザの回答によって変わらず一定であり、ユーザは全ての質問にちょうど $ 1 $ つの選択肢を選ぶことで、結果を閲覧できます。

全ての選択肢はある整数値を持ちます。このアプリは、ユーザによって選ばれた、全ての回答がそれぞれ保持する整数値の排他的論理和（XOR）を使って結果を算出します。計算の最後でこの値が $ 0 $ になってしまうと、結果が表示されずバグが発生してしまいます。

あなたには全ての選択肢が持つ整数値が与えられるので、高橋くんの代わりに、ユーザの選択によってはバグが発生する可能性があるかどうかを判定してください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ K $ $ T_{1,1} $ $ T_{1,2} $ … $ T_{1,K} $ $ T_{2,1} $ $ T_{2,2} $ … $ T_{2,K} $ : $ T_{N,1} $ $ T_{N,2} $ … $ T_{N,K} $

- $ 1 $ 行目には、質問の個数を表す整数 $ N\ (1≦N≦5) $ と、それぞれの質問に対する選択肢の個数を表す整数 $ K\ (1≦K≦5) $ が、スペース区切りで与えられる。
- $ 2 $ 行目から $ N $ 行は、選択肢が保持する整数値が、スペース区切りで与えられる。 このうち、 $ i $ 行目の $ j $ 番目にある整数 $ T_{i,j}\ (0≦T_{i,j}≦127) $ は、 $ i $ 番目の質問に対する $ j $ 番目の選択肢が保持する整数値である。

## 输出格式

バグが発生することがある場合は`Found`、そうでなければ`Nothing`を $ 1 $ 行で出力せよ。出力の末尾には改行をいれること。

## 说明/提示

### Sample Explanation 1

$ 1 $ つ目の質問で $ 1 $ つ目の選択肢を、$ 2 $ つ目の質問で $ 3 $ つ目の選択肢を、 $ 3 $ つ目の質問で、$ 2 $ つ目の選択肢を選んだとします。 すると、対応する数字はそれぞれ、 $ 1,2,3 $ となり、これらのXORを取ると、$ 0 $ となります。 よって、バグが発生してしまうため、`Found`と出力します。

### Sample Explanation 2

バグの発生する回答の組み合わせはありません。

## 样例 #1

### 输入

```
3 4

1 3 5 17

2 4 2 3

1 3 2 9
```

### 输出

```
Found
```

## 样例 #2

### 输入

```
5 3

89 62 15

44 36 17

4 24 24

25 98 99

66 33 57
```

### 输出

```
Nothing
```



---

---
title: "[ABC016D] 一刀両断"
layout: "post"
diff: 普及/提高-
pid: AT_abc016_4
tag: []
---

# [ABC016D] 一刀両断

## 题目描述

# 一刀两断

高桥君是一位空手道练习者，现在他已经成为了一名大犇，用手劈木板就像劈空气一样（而且劈出的轨迹是一条线段）。

现在他找了一个多边形木桩，求他这一手下去可以把这个多边形木桩劈成几段。

## 输入格式

共N+2行,第一行四个整数Ax,Ay,Bx,By,分别表示线段（即他劈出的轨迹）的两个端点的坐标



第二行一个整数N，表示多边形顶点数



第三到n+2行，每行两个整数，表示一个顶点的横纵坐标



其中3≦N≦100，坐标的取值大于-1000小于1000

同时给出的多边形和线段具有以下性质：



给出的多边形的顶点是按逆时针方向排列的。



多边形的顶点与线段相隔0.1以上。



线段的端点与多边形相隔0.1以上。



线段的端点在多边形的外部。



多边形的连续的3个顶点不会排列在一条直线上



也就是说：如下面五张图，给出的数据不会有这些情况：

![](https://cdn.luogu.com.cn/upload/vjudge_pic/AT1020/98af351a3c771628dc4ac50aaf39554649a5b820.png)



图A,B:线段过多边形顶点（要不然手疼死了）



图C：线段的端点在多边形上



图D：线段和多边形的边重合



图E：线段的端点在多边形内部（卡里面了）

## 输出格式

一行，一个整数，输出末尾要加换行

## 样例 #1

### 输入

```
-2 0 2 0

4

1 1

-1 1

-1 -1

1 -1
```

### 输出

```
2
```

## 样例 #2

### 输入

```
-3 1 3 1

8

2 2

1 2

1 0

-1 0

-1 2

-2 2

-2 -1

2 -1
```

### 输出

```
3
```



---

---
title: "[ABC019D] 高橋くんと木の直径"
layout: "post"
diff: 普及/提高-
pid: AT_abc019_4
tag: []
---

# [ABC019D] 高橋くんと木の直径

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc019/tasks/abc019_4

高橋くんは木の直径を求めるのに夢中です。 木とは、頂点とそれを結ぶ辺からなる構造「グラフ」の $ 1 $ 種で、頂点の数を $ N $ 個とすると、辺は $ N-1 $ 本あり、どの頂点も他の全ての頂点に辺で間接・直接的につながっています。

 ![](https://cdn.luogu.com.cn/upload/vjudge_pic/AT_abc019_4/cfb0270dd13592a982ed72200a9f86b2a95a3a4d.png)

この問題では、辺には整数の重みがついています。2頂点の間の距離を、その2つの頂点をつなぐ辺の重みの和と定義します。

木の直径とは、最も離れた2つの頂点の間の距離です。

以下のような木を考えてみましょう。辺の側に書かれた数が、その辺の重みです。

 ![](https://cdn.luogu.com.cn/upload/vjudge_pic/AT_abc019_4/a33a3d0111cd3e05457375697b0a6985f92b86a4.png)

この場合、頂点 $ 1 $ と $ 2 $ の距離は $ 1 $、頂点 $ 2 $ と $ 4 $ の間の距離は $ 1+2=3 $ となります。頂点 $ 3 $ と $ 5 $ の間の距離は $ 3+4=7 $、頂点 $ 4 $ と $ 5 $ の間の距離も $ 2+1+4=7 $ で、この距離がこの木の頂点の間では最大なので、木の直径は $ 7 $ となります。

高橋くんは、頂点の数と $ 2 $ 頂点間の距離の情報から、木の直径を求めることに興味が出てきました。 この問題では、あなたは木の頂点の数 $ N $ を最初に与えられ、$ 2 $ 頂点の間の距離を尋ねる質問を何回か行い、木の直径を求めます。

ただし、$ 2 $ 頂点間の距離を聞く回数には制限があります。

制限された質問の回数以内で木の直径を求めるプログラムを書いてください。

### Input &amp; Output Format

まず，木の頂点の数 $ N $ が標準入力に与えられる。

> $ N $

続いて，あなたのプログラムは何回か応答プログラムに質問をする．質問のフォーマットは以下のとおりである。

> ? $ a $ $ b $

この質問で，$ a,b $ 間の距離が標準入力に1行で渡される。$ 1\ ≦\ a,\ b\ ≦\ N $ かつ $ a≠b $ を満たしていなければならない。

何回か質問を行った後、あなたは木の直径を当てる。木の直径を $ diameter $ とおくと、

> ! $ diameter $

というフォーマットで出力する。木の直径を出力した後、あなたのプログラムは直ちに終了しなければならない。終了しなかった場合のジャッジ結果は不定である。

また、これら以外のフォーマットで出力した場合のジャッジ結果も不定である。

この問題ではテストケースごとに質問回数の上限値が設定されており、プログラムの行った質問の回数がその上限値を上回ると誤答と判定される。

正答かどうかは木の直径の出力で判断される。木の直径を特定し得ない質問しかしていない場合でも、直径が正しければ正答となる。

- - - - - -

頂点 $ 1 $ と頂点 $ 2 $ の間の距離を質問し、$ dist $ という変数で結果を受け取る例をいくつかの言語について示す。

ただし、ここに書かれている方法以外で入出力を行っても良い。

出力した後に、出力をflushしなければならないことに注意せよ。flushしなかった場合、TLEとなることがある。

C

```
<pre class="prettyprint linenums" style="font-size: 12px; letter-spacing: 0;">
printf("? %d %d\n", 1, 2);
fflush(stdout);
scanf("%d", &dist);
```

C++

```
<pre class="prettyprint linenums" style="font-size: 12px; letter-spacing: 0;">
cout > dist;
```

Java

```
<pre class="prettyprint linenums" style="font-size: 12px; letter-spacing: 0;">
System.out.printf("? %d %d\n", 1, 2);
Scanner scanner = new Scanner(System.in);
dist = scanner.nextInt();
```

C#

```
<pre class="prettyprint linenums" style="font-size: 12px; letter-spacing: 0;">
Console.WriteLine("? {0} {1}", 1, 2);
dist = int.Parse(Console.ReadLine());
```

D

```
<pre class="prettyprint linenums" style="font-size: 12px; letter-spacing: 0;">
writeln("? ", 1, " ", 2);
stdout.flush();
dist = readln.chomp.to!int;
```

PHP

```
<pre class="prettyprint linenums" style="font-size: 12px; letter-spacing: 0;">
echo "? ", 1, " ", 2, PHP_EOL;
$ dist\ =\ trim(fgets(STDIN));





Python



print\ "?\ {0}\ {1}".format(1,\ 2)

sys.stdout.flush()

dist\ =\ int(raw_input())





Perl $|=1;
print "? ", 1, " ", 2, "\n";
$dist = ;
```

Ruby

```
<pre class="prettyprint linenums" style="font-size: 12px; letter-spacing: 0;">
print "? ", 1, " ", 2, "\n"
STDOUT.flush
dist = gets.to_i
```

## 说明/提示

### 制約

- $ 2\ ≦\ N\ ≦\ 50 $
- $ 1\ ≦\ (それぞれの辺の重み)\ ≦\ 10^6 $

### 部分点

この問題には部分点が設定されている。

- $ 20 $ 点分のテストケースにおいて、質問回数の上限値は 1300 回である。
- 別の $ 80 $ 点分のテストケースにおいて、質問回数の上限値は 100 回である。

### 入出力例

木が以下のような形状のとき、

 ![](https://cdn.luogu.com.cn/upload/vjudge_pic/AT_abc019_4/cee5f2e74e5e3c979be3ad1dfb861be11590dd76.png)

以下のような入出力が考えられる。

 プログラムへの入力 プログラムの出力 5     ? 1 2 5     ? 2 4 1     ? 4 5 2     ? 2 3 9     ? 1 5 8     ! 14これは入出力の一つの例であり、意味のある質問をしているとは限らない。



---

---
title: "[ABC021C] 正直者の高橋くん"
layout: "post"
diff: 普及/提高-
pid: AT_abc021_c
tag: []
---

# [ABC021C] 正直者の高橋くん

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc021/tasks/abc021_c

あなたと高橋君は、AtCoder 王国に住んでいます。AtCoder 王国には、$ N $ 個の町と、町どうしを結ぶ $ M $ 本の道路が存在し、それらは双方向に移動可能です。 $ N $ 個の町はそれぞれ 町 $ 1 $,町 $ 2 $,…,町 $ N $ と呼ばれています。 また、$ M $ 個の道路はそれぞれ 道路 $ 1 $,道路 $ 2 $,…,道路 $ M $ と呼ばれています。

高橋君はあなたの家に遊びに行くことにしました。そして、高橋君は町 $ a $ から出発して、AtCoder 王国のいくつかの町（$ 0 $ 個でも良い）を経由して町 $ b $ にあるあなたの家に到着しました。

高橋君は最短経路を辿ってきたと主張しています。 高橋君は正直なので、絶対に嘘をつきません。

そこで、あなたは町 $ a $ から町 $ b $ への最短経路が何通りあるかを数えることにしました。答えは非常に大きくなる可能性があるので、実際の答えを $ 1,000,000,007(=10^9+7) $ で割った余りを出力してください。

町 $ a $ から町 $ b $ への最短経路とは、町 $ a $ から町 $ b $ への移動経路において道路を通る回数が最小となるような経路のことを言います。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ a $ $ b $ $ M $ $ x_1 $ $ y_1 $ $ x_2 $ $ y_2 $ : $ x_M $ $ y_M $

- $ 1 $ 行目には、AtCoder 王国に存在する町の個数を表す整数 $ N(2≦N≦100) $ が与えられる。
- $ 2 $ 行目には、高橋君が出発する町とあなたの家がある町の番号を表す $ 2 $ つの整数 $ a,b(1≦a,b≦N,a≠b) $ が空白区切りで与えられる。
- $ 3 $ 行目には、AtCoder 王国に存在する道路の個数を表す整数 $ M(1≦M≦200) $ が与えられる。
- $ 4 $ 行目から $ M $ 行には、道路の情報が与えられる。そのうち $ i(1≦i≦M) $ 行目には道路 $ i $ が結んでいる $ 2 $ つの町の番号 $ x_i,y_i(1≦x_i,y_i≦N,x_i≠y_i) $ が空白区切りで与えられる。
- どの町からどの町へもいくつかの道を辿ることによって行くことができる。

## 输出格式

$ 1 $ 行目に、町 $ a $ から町 $ b $ への最短経路の個数を $ 1,000,000,007 $ で割った余りを出力してください。

末尾の改行を忘れないこと。

## 说明/提示

### Sample Explanation 1

この入力例に対する図は以下の通りで、最短経路として次の $ 4 $ 通りが考えられます。 - $ 1→2→4→5→7 $ - $ 1→3→4→5→7 $ - $ 1→2→4→6→7 $ - $ 1→3→4→6→7 $ !\[\](http://abc021.contest.atcoder.jp/img/abc/021/enJQfEfKt-baQEUDjCrVFLSw/C\_sample1.png)

### Sample Explanation 2

この入力例に対する図は以下の通りです。 !\[\](http://abc021.contest.atcoder.jp/img/abc/021/enJQfEfKt-baQEUDjCrVFLSw/C\_sample2.png)

## 样例 #1

### 输入

```
7

1 7

8

1 2

1 3

4 2

4 3

4 5

4 6

7 5

7 6
```

### 输出

```
4
```

## 样例 #2

### 输入

```
7

1 7

9

1 2

1 3

4 2

4 3

4 5

4 6

7 5

7 6

4 7
```

### 输出

```
2
```



---

---
title: "[ABC024C] 民族大移動"
layout: "post"
diff: 普及/提高-
pid: AT_abc024_c
tag: []
---

# [ABC024C] 民族大移動

## 题目描述

### 题意简述
高桥君的王国有 $N$ 个城市，每个城市用编号 $1$ ~ $N$ 表示。

高桥国有 $K$ 个民族居住，第 $i$ 个民族生活在编号为 $S_i$ 的城市。

高桥国有百年一度的所有民族共同习俗**民族大迁徙**，但由于交通拥堵，所以设置了**第 $i$ 天只能在编号在 $L_i$ 到 $R_i$ 的城市来来去去**的限制，并最多花费 $D$ 天进行。

每个民族都遵守这一行动限制，在经过几个城市的同时前往目的地城市。

第 $i$ 个民族的目的地是 $T_i$ ，每个民族都希望尽可能早的到达目的地。

求每个民族最早到达目的地的时间。

## 输入格式

第一行有 $3$ 个整数，分别为高桥国城市的个数 $N$ ，大迁徙的时间 $D$，高桥国所住的民族数 $K$。

接下来的 $D$ 行，有 $2$ 个整数 $L_i,R_i$，表示第 $i$ 天可来来去去的城市编号范围。

接下来的 $K$ 行，每行 $2$ 个整数 $S_i,T_i$，表示第 $i$ 个民族原本居住的城市编号和目的地城市编号。

## 输出格式

共 $K$ 行，每行一个整数表示第 $i$ 个民族到达目的地的最少天数。

数据保证每个民族 $D$ 天内能到达目的地。

## 样例 #1

### 输入

```
10 10 3

1 5

3 6

7 10

5 8

4 4

1 4

2 9

1 3

1 1

4 5

1 6

2 7

10 1
```

### 输出

```
2

4

8
```

## 样例 #2

### 输入

```
10 10 4

1 2

2 4

3 6

4 8

5 10

9 10

7 8

5 6

3 5

1 3

10 1

3 8

2 4

1 3
```

### 输出

```
10

4

2

2
```

## 样例 #3

### 输入

```
314159265 10 1

1 10000

500 12031

1414 113232

111111 777777

666661 23423423

12345678 123456789

111111111 314159265

112334 235235235

1 223445

314 1592

1 314159265
```

### 输出

```
7
```



---

---
title: "[ABC026C] 高橋君の給料"
layout: "post"
diff: 普及/提高-
pid: AT_abc026_c
tag: []
---

# [ABC026C] 高橋君の給料

## 题目描述

现在一个公司有 $n$ 名员工。保证 $n\le20$。

除了 $1$ 号员工以外，每个员工都有一个直属上司。保证上司的编号严格小于这个员工的编号。

没有下属的员工工资为 $1$。对于有下属的员工，他的工资是其直接下属中的最大工资和最小工资之和加上 $1$。

求出 $1$ 号员工的工资。

## 输入格式

第一行，一个整数 $n$，表示有 $n$ 名员工。

第 $2$ 至 $n$ 行，第 $i$ 行一个整数 $b_i$，表示第 $i$ 名员工的直属上司是第 $b_i$ 名员工。

## 样例 #1

### 输入

```
5

1

1

1

1
```

### 输出

```
3
```

## 样例 #2

### 输入

```
7

1

1

2

2

3

3
```

### 输出

```
7
```

## 样例 #3

### 输入

```
6

1

2

3

3

2
```

### 输出

```
11
```

## 样例 #4

### 输入

```
10

1

2

3

4

5

6

7

8

9
```

### 输出

```
1023
```



---

---
title: "[ABC027B] 島と橋"
layout: "post"
diff: 普及/提高-
pid: AT_abc027_b
tag: []
---

# [ABC027B] 島と橋

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc027/tasks/abc027_b

$ N $ 個の島が横一列に並んでいる。 $ 1≦i≦N-1 $ について、左から $ i $ 番目の島と $ i+1 $ 番目の島は隣り合っている。

はじめ、左から $ i $ ($ 1≦i≦N $) 番目の島には $ a_i $ 人の住人が住んでいる。 高橋君はすべての島に同じ人数の住人が住むようにしたいと考えている。

高橋君は隣り合う $ 2 $ つの島の間に橋を架けることができる。 また、直接的または間接的に橋で結ばれた複数の島の間で、住人を自由に移動させることができる。

すべての島に同じ人数の住人が住むようにするために、架ける必要のある橋の本数の最小値を求めよ。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ a_1 $ $ a_2 $ $ .. $ $ a_N $

- $ 1 $ 行目には、島の個数を表す整数 $ N $ ($ 2≦N≦100 $) が与えられる。
- $ 2 $ 行目には、整数 $ a_i $ ($ 0≦a_i≦100 $) が空白区切りで与えられる。これは、左から $ i $ 番目の島には $ a_i $ 人の住人が住んでいることを表す。

## 输出格式

すべての島に同じ人数の住人が住むようにするために、架ける必要のある橋の本数の最小値を $ 1 $ 行に出力せよ。 ただし、どのように橋を架けてもすべての島に同じ人数の住人が住むようにできないならば、代わりに `-1` を出力せよ。 出力の末尾には改行を入れること。

## 说明/提示

### Sample Explanation 1

図のように橋を架ければよい。 !\[\](https://abc027.contest.atcoder.jp/img/abc/027/kakofvcs22vft/bridge\_1.png)

### Sample Explanation 2

図のように橋を架ければよい。 !\[\](https://abc027.contest.atcoder.jp/img/abc/027/kakofvcs22vft/bridge\_2.png)

### Sample Explanation 3

どのように橋を架けてもすべての島に同じ人数の住人が住むようにできない。

### Sample Explanation 4

はじめからすべての島に同じ人数の住人が住んでいる。

## 样例 #1

### 输入

```
3

1 2 3
```

### 输出

```
2
```

## 样例 #2

### 输入

```
5

2 0 0 0 3
```

### 输出

```
3
```

## 样例 #3

### 输入

```
2

0 99
```

### 输出

```
-1
```

## 样例 #4

### 输入

```
4

0 0 0 0
```

### 输出

```
0
```



---

---
title: "[ABC030C] 飛行機乗り"
layout: "post"
diff: 普及/提高-
pid: AT_abc030_c
tag: []
---

# [ABC030C] 飛行機乗り

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc030/tasks/abc030_c

ウナギの高橋くんは飛行機に乗ることが趣味です。今回は空港Aと空港Bを往復することにしました。

空港Aから空港Bの飛行機には $ X $ 時間かかり、空港Bから空港Aへの飛行機には $ Y $ 時間かかります。 空港Aから空港Bへの飛行機は $ N $ 本あり、$ i $ 番目の便は $ a_i $ 時に出発します。 空港Bから空港Aへの飛行機は $ M $ 本あり、$ j $ 番目の便は $ b_j $ 時に出発します。

ある飛行機には、出発する空港に出発する時刻以前にいれば乗ることができます。出発する時刻ちょうどに到着した場合も、すぐに飛行機に乗って出発できます。 高橋くんははじめ空港Aに $ 0 $ 時にいます。 空港Aと空港Bの間を最大何往復できるか調べてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ M $ $ X $ $ Y $ $ a_1 $ $ a_2 $ .. $ a_N $ $ b_1 $ $ b_2 $ .. $ b_M $

- $ 1 $ 行目には、空港Aから空港Bへの本数 $ N\ (\ 1\ ≦\ N\ ≦\ 10^5) $、空港Bから空港Aへの本数 $ M\ (\ 1\ ≦\ M\ ≦\ 10^5) $ が空白区切りで与えられる。
- $ 2 $ 行目には、空港Aから空港Bへの飛行機にかかる時間 $ X\ (\ 1\ ≦\ X\ ≦\ 10^9) $、空港Bから空港Aへの飛行機にかかる時間 $ Y\ (\ 1\ ≦\ Y\ ≦\ 10^9) $ が空白区切りで与えられる。
- $ 3 $ 行目には、$ N $ 個の空港Aから飛行機が出発する時刻を表す整数 $ a_i $ が空白を区切りとして与えられる。
- $ 4 $ 行目には、$ M $ 個の空港Bから飛行機が出発する時刻を表す整数 $ b_j $ が空白を区切りとして与えられる。
- $ 1\ ≦\ a_i\ ≦\ 10^9\ (1\ ≦\ i\ ≦\ N) $ であることが保証される。
- $ 1\ ≦\ b_j\ ≦\ 10^9\ (1\ ≦\ j\ ≦\ M) $ であることが保証される。
- $ a_i\ <\ a_{i+1}\ (1\ ≦\ i\ ≦\ N-1) $ であることが保証される。
- $ b_i\ <\ b_{j+1}\ (1\ ≦\ j\ ≦\ M-1) $ であることが保証される。

## 输出格式

高橋くんが空港Aと空港Bの間を最大何往復できるかを $ 1 $ 行に出力せよ。

末尾の改行を忘れないこと。

## 说明/提示

### 部分点

この問題には部分点が設定されている。

- $ 30 $ 点分のテストケースにおいて、$ 1\ ≦\ a_i\ ≦\ 10^5,\ 1\ ≦\ b_j\ ≦\ 10^5\ (\ 1\ ≦\ i\ ≦\ N,\ 1\ ≦\ j\ ≦\ M) $ を満たす。

### Sample Explanation 1

$ 1 $ 時の空港Aを出発する飛行機に乗り、$ 3 $ 時に到着しますが、すぐに $ 3 $ 時の空港Bを出発する飛行機に乗り、$ 6 $ 時に空港Aに到着します。 次に、$ 7 $ 時の空港Aを出発する飛行機に乗り、$ 9 $ 時に到着、$ 12 $ 時の空港Bを出発する飛行機に乗ると、合計 $ 2 $ 往復できます。$ 3 $ 往復する手段はありません。

### Sample Explanation 2

空港Bに行くと空港Aに帰れないので、$ 1 $ 度も往復できません。

## 样例 #1

### 输入

```
3 4

2 3

1 5 7

3 8 12 13
```

### 输出

```
2
```

## 样例 #2

### 输入

```
1 1

1 1

1

1
```

### 输出

```
0
```

## 样例 #3

### 输入

```
6 7

5 3

1 7 12 19 20 26

4 9 15 23 24 31 33
```

### 输出

```
3
```



---

---
title: "[ABC031C] 数列ゲーム"
layout: "post"
diff: 普及/提高-
pid: AT_abc031_c
tag: []
---

# [ABC031C] 数列ゲーム

## 题目描述

高桥和青木用长度为N的数列S玩游戏。



游戏中，高桥和青木各进行一回合。



游戏按照以下规则进行：



	首先，高桥在数列中圈一个数字。

	然后，青木在高桥没圈的数字中圈一个。

	接着，留下圈中的数字以及它们之间的数字，去掉其它数字。留下的数列叫T。

	最后，在数列T中，从左开始奇数个数字的和为高桥的得分，偶数个数字为青木的得分。



青木在能圈的数字中，圈出能使他得到最多分数的数字。如果这样的数有多个，圈出最左的数字。



高桥知道青木的圈数方法。请求出高桥能得到的最大得分。

## 输入格式

按照以下标准格式输入。



	第一行输入整数N(2<=N<=50)，N是数列S的数字数量。

	第二行输入N个整数a1,a2,...,aN(-50<=ai<=50,1<=i<=50)，整数ai是数列S从左往右数第i个数字。

## 输出格式

用一行输出高桥的最大得分。



在输出的末尾加上换行

## 样例 #1

### 输入

```
6

1 -3 3 9 1 6
```

### 输出

```
6
```

## 样例 #2

### 输入

```
3

5 5 5
```

### 输出

```
10
```

## 样例 #3

### 输入

```
8

-1 10 -1 2 -1 10 -1 0
```

### 输出

```
-1
```



---

---
title: "[ABC033C] 数式の書き換え"
layout: "post"
diff: 普及/提高-
pid: AT_abc033_c
tag: []
---

# [ABC033C] 数式の書き換え

## 题目描述

给出满足以下限制的公式$S$。

1.运算符仅由+（加法）和*（乘法）组成。优先计算乘法；

2.不存在括号；

3.每一个数都是是$1$位数的整数。

例如，1+3*4*0、1+2+3+4+5等公式满足此条件，但12+3+5、4*6*7-3、（3+4）*5+2等公式不满足条件。

请您通过在公式中选几个数字并将其改为$0$，将此公式的最后结果变成$0$。求最少要改写几个数字。

## 输入格式

输入以下标准形式。
```
$ S $ 
```
一行一个字符串$S$，满足问题条件的数学式$S$（$S$的长度为$1$以上$100000$以下）。

## 输出格式

一行一个整数，表示必须改写为$0$的数字的个数的最小值。

输出的末尾也要另起一行$（ATcoder规范）$。

## 说明/提示

给出的公式是：$0+0+2*0=0$。因此，因此，不需要改写数字。


通过将输入的第一个字符和第五个字符改写为0，可以得到$0*1+0*2=0$，最终使运算结果变为0。

## 样例 #1

### 输入

```
0+0+2*0
```

### 输出

```
0
```

## 样例 #2

### 输入

```
3*1+1*2
```

### 输出

```
2
```

## 样例 #3

### 输入

```
3*1*4+0+2*0+5*2+9*8*6+1+3
```

### 输出

```
5
```



---

---
title: "[ABC035B] ドローン"
layout: "post"
diff: 普及/提高-
pid: AT_abc035_b
tag: []
---

# [ABC035B] ドローン

## 题目描述

### 题意翻译

有一个无限大的二维网格，在网格上有一架无人机，高桥先生在（ $0$ , $0$ ）处放飞无人机。
有一个字符串 $S$ 代表高桥先生发送给无人机的指令：

- ``L`` 代表无人机从（ $x$ , $y$ ）飞到（ $x-1$ , $y$ ）
- ``R`` 代表无人机从（ $x$ , $y$ ）飞到（ $x+1$ , $y$ ）
- ``U`` 代表无人机从（ $x$ , $y$ ）飞到（ $x$ , $y+1$ ）
- ``D`` 代表无人机从（ $x$ , $y$ ）飞到（ $x$ , $y-1$ ）


现在给出这个指令字符串 $S$ ，但这个字符串有些地方损坏了，损坏的地方用 ``?`` 表示，保证 ``?`` 只能为 ``L``、``R``、``U``、``D`` 之一。

无人机和高桥先生之间的距离为 $|x|+|y|$ 。

之后给出一个数 $T$ ，$T$ 保证只有如下两种情况：
- 当 $T=1$ 时，表示要输出的数是高桥先生和无人机距离的最大值。
- 当 $T=2$ 时，表示要输出的数是高桥先生和无人机距离的最小值。

----------

## 输入格式

- 第一行输入一个字符串 $S$ ，定义 $|S|$ 为字符串的长度$（1≤|S|≤10^5）$，表示高桥先生发给无人机的指令串，保证 $S$ 只含 ``L``、``R``、``U``、``D``、``？`` 五种字符。

- 第二行输入一个数 $T$ ，保证$（1≤T≤2）$。

-------------

## 输出格式

- 当 $T=1$ 时，输出无人机和高桥先生距离的最大值。

- 当 $T=2$ 时，输出无人机和高桥先生距离的最小值。

- 别忘最后输出换行符。

Translated by 2c_s

## 样例 #1

### 输入

```
UL?

1
```

### 输出

```
3
```

## 样例 #2

### 输入

```
UD?

1
```

### 输出

```
1
```

## 样例 #3

### 输入

```
UUUU?DDR?LLLL

1
```

### 输出

```
7
```

## 样例 #4

### 输入

```
UULL?

2
```

### 输出

```
3
```



---

---
title: "[ABC039D] 画像処理高橋君"
layout: "post"
diff: 普及/提高-
pid: AT_abc039_d
tag: []
---

# [ABC039D] 画像処理高橋君

## 题目描述

对一幅黑白图像进行“收缩”处理。

“收缩”是指，对于每个像素，如果在它周围（$8$个方向）有一个黑色的像素，即将该像素视为黑色。

给你一幅被收缩过的图像，判断是否有一幅图像可以通过收缩得到这幅图像。如果有，请复原其中之一。
图像是由 $H$ 行 $W $ 列字符组成的图形。

## 输入格式

第一行输入 $H$ 和  $W$ 。

第 $2  $ 到第 $H+1$ 行，每行 $W$ 个字符，共同表示了一幅图像。

## 输出格式

如果没有满足条件的图像，输出一行 impossible 。

否则，输出一行 possible 后，输出 $H$ 行 $W$ 列，由 . 和 # 构成的字符串，表示一副满足条件的图像。

对于每个字符，如其为 . 则为白色，如为 # 则是黑色

## 样例 #1

### 输入

```
4 4

##..

##..

..##

..##
```

### 输出

```
possible

#...

....

....

...#
```

## 样例 #2

### 输入

```
4 4

###.

####

..##

..##
```

### 输出

```
possible

##..

....

...#

...#
```

## 样例 #3

### 输入

```
4 4

###.

##.#

..##

..##
```

### 输出

```
impossible
```



---

---
title: "[ABC040C] 柱柱柱柱柱"
layout: "post"
diff: 普及/提高-
pid: AT_abc040_c
tag: []
---

# [ABC040C] 柱柱柱柱柱

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc040/tasks/abc040_c

$ N $ 本の木の柱が左から右へ一列に並んだアスレチックがあります。左から $ i $ 本目の柱の高さは $ a_i $ センチメートルです。

高橋君は左から $ 1 $ 本目の柱からスタートし、右へ柱を渡っていき $ N $ 本目の柱まで行こうとしています。

高橋君がある柱にいるとき、次には現在の柱から $ 1 $ 個もしくは $ 2 $ 個右にある柱のどちらかへ移動することができます。

移動するときには、現在いる柱の高さと、移動後の柱の高さの差の絶対値のぶんだけコストがかかります。

$ N $ 本目の柱まで行くとき、コストの合計の最小値はいくらになるでしょうか。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ a_1 $ $ a_2 $ ... $ a_N $

## 输出格式

$ 1 $ 本目の柱から $ N $ 本目の柱へ移動するまでに必要な合計コストの最小値を $ 1 $ 行に出力せよ。

## 说明/提示

### 制約

- $ 2\ ≦\ N\ ≦\ 100,000 $
- $ 0\ ≦\ a_i\ ≦\ 10,000 $
- $ a_i $ はすべて整数である。

### Sample Explanation 1

このケースでは以下のような移動によって最小コストを達成できる。 - $ 1 $ 本目の柱から $ 3 $ 本目の柱へ移動する。(コスト $ 30 $) - $ 3 $ 本目の柱から $ 4 $ 本目の柱へ移動する。(コスト $ 10 $) 合計コストは $ 40 $ となる。

### Sample Explanation 2

このケースでは以下のような移動によって最小コストを達成できる。 - $ 1 $ 本目の柱から $ 2 $ 本目の柱へ移動する。(コスト $ 25 $) - $ 2 $ 本目の柱から $ 4 $ 本目の柱へ移動する。(コスト $ 15 $) 合計コストは $ 40 $ となる。

## 样例 #1

### 输入

```
4

100 150 130 120
```

### 输出

```
40
```

## 样例 #2

### 输入

```
4

100 125 80 110
```

### 输出

```
40
```

## 样例 #3

### 输入

```
9

314 159 265 358 979 323 846 264 338
```

### 输出

```
310
```



---

---
title: "[ABC045B] 3人でカードゲームイージー"
layout: "post"
diff: 普及/提高-
pid: AT_abc045_b
tag: []
---

# [ABC045B] 3人でカードゲームイージー

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc045/tasks/abc045_b

A さん、B さん、C さんの $ 3 $ 人が以下のようなカードゲームをプレイしています。

- 最初、$ 3 $ 人はそれぞれ `a`、`b`、`c` いずれかの文字が書かれたカードを、何枚か持っている。これらは入力で与えられた順番に持っており、途中で並べ替えたりしない。
- $ A $ さんのターンから始まる。
- 現在自分のターンである人がカードを $ 1 $ 枚以上持っているならば、そのうち先頭のカードを捨てる。その後、捨てられたカードに書かれているアルファベットと同じ名前の人 (例えば、カードに `a` と書かれていたならば A さん) のターンとなる。
- 現在自分のターンである人がカードを $ 1 $ 枚も持っていないならば、その人がゲームの勝者となり、ゲームは終了する。

$ 3 $ 人が最初に持っているカードがそれぞれ先頭から順に与えられます。 具体的には、文字列 $ S_A $、$ S_B $、$ S_C $ が与えられます。文字列 $ S_A $ の $ i $ 文字目 ( $ 1\ \leq\ i\ \leq\ |S_A| $ ) に書かれている文字が、A さんの持っている中で先頭から $ i $ 番目のカードに 書かれている文字です。文字列 $ S_B $、 $ S_C $ についても同様です。

最終的に誰がこのゲームの勝者となるかを求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ S_A $ $ S_B $ $ S_C $

## 输出格式

A さんが勝つなら `A`、B さんが勝つなら `B`、C さんが勝つなら `C` と出力せよ。

## 说明/提示

### 制約

- $ 1\ \leq\ S_A\ \leq\ 100 $
- $ 1\ \leq\ S_B\ \leq\ 100 $
- $ 1\ \leq\ S_C\ \leq\ 100 $
- $ S_A $、$ S_B $、$ S_C $ に含まれる文字はそれぞれ `a`、`b`、`c` のいずれか

### Sample Explanation 1

ゲームは以下のように進行します。 - A さんが、持っている中で最初のカード `a` を捨てる。次は A さんの番となる。 - A さんが、持っている中で最初のカード `c` を捨てる。次は C さんの番となる。 - C さんが、持っている中で最初のカード `c` を捨てる。次は C さんの番となる。 - C さんが、持っている中で最初のカード `a` を捨てる。次は A さんの番となる。 - A さんが、持っている中で最初のカード `a` を捨てる。次は A さんの番となる。 - A さんはもう持っているカードがない。よって A さんの勝利となり、ゲームは終了する。

## 样例 #1

### 输入

```
aca

accc

ca
```

### 输出

```
A
```

## 样例 #2

### 输入

```
abcb

aacb

bccc
```

### 输出

```
C
```



---

---
title: "[ABC054B] Template Matching"
layout: "post"
diff: 普及/提高-
pid: AT_abc054_b
tag: []
---

# [ABC054B] Template Matching

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc054/tasks/abc054_b

縦 $ N $ 行、横 $ N $ 列に画素が並んだ画像Aと、縦 $ M $ 行、横 $ M $ 列に画素が並んだテンプレート画像Bが与えられます。   
 画素は画像を構成する最小単位であり、ここでは $ 1×1 $ の正方形とします。   
 また、与えられる画像は全て2値画像であり、各画素の色は白と黒の2種類で表されます。

入力において、全ての画素は文字で表されており、`.`は白色の画素、 `#` は黒色の画素に対応します。   
 画像Aは $ N $ 個の文字列 $ A_1,...,A_N $ で表されます。   
 文字列 $ A_i $ の $ j $ 文字目は、画像Aの上から $ i $ 番目、左から $ j $ 番目の画素に対応します。$ (1≦i,j≦N) $   
 同様に、テンプレート画像Bは $ M $ 個の文字列 $ B_1,...,B_M $ で表されます。   
 文字列 $ B_i $ の $ j $ 文字目は、テンプレート画像Bの上から $ i $ 番目、左から $ j $ 番目の画素に対応します。$ (1≦i,j≦M) $

画像の平行移動のみ許されるとき、テンプレート画像Bが画像Aの中に含まれているかを判定してください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ M $ $ A_1 $ $ A_2 $ $ : $ $ A_N $ $ B_1 $ $ B_2 $ $ : $ $ B_M $

## 输出格式

画像Aの中にテンプレート画像Bを含む場合は `Yes`、含まない場合は `No` を出力せよ。

## 说明/提示

### 制約

- $ 1≦M≦N≦50 $
- $ A_i $ は `#` と `.` からなる長さ $ N $ の文字列
- $ B_i $ は `#` と `.` からなる長さ $ M $ の文字列

### Sample Explanation 1

テンプレート画像Bが、画像A中の左上の $ 2\ ×\ 2 $ の部分画像と右下の $ 2\ ×\ 2 $ の部分画像に一致するため、`Yes` と出力します。

### Sample Explanation 2

画像Aは白色の画素、テンプレート画像Bは黒色の画素で構成されるため、含まれることはありません。

## 样例 #1

### 输入

```
3 2

#.#

.#.

#.#

#.

.#
```

### 输出

```
Yes
```

## 样例 #2

### 输入

```
4 1

....

....

....

....

#
```

### 输出

```
No
```



---

---
title: "[ABC054C] One-stroke Path"
layout: "post"
diff: 普及/提高-
pid: AT_abc054_c
tag: []
---

# [ABC054C] One-stroke Path

## 题目描述

给定一个没有重边和自环的 $N$ 个点 $M$ 条边的无权无向图，第 $i$ 条边连接顶点 $a _ i$ 和 $b _ i$。

求以顶点 $1$ 为起点，只访问 $1$ 次所有顶点的路径有多少条？特别地，起点和终点也视为被访问。

## 输入格式

第一行两个整数 $N, M$。

接下来 $m$ 行，其中第 $i$ 行两个整数 $a _ i, b _ i$。

$
N M \\
a _ 1 b _ 1 \\
a _ 2 b _ 2 \\
\kern {0.667 em} \vdots \\
a _ M b _ M
$

## 输出格式

输出满足条件的路径有多少。

## 说明/提示

$
2 \le N \le 8 \\
0 \le M \le N(N - 1) \\
1 \le a _ i < b _ i \le N
$

给定的无向图中不包含重边和自环。

## 样例 #1

### 输入

```
3 3

1 2

1 3

2 3
```

### 输出

```
2
```

## 样例 #2

### 输入

```
7 7

1 3

2 7

3 4

4 5

4 6

5 6

6 7
```

### 输出

```
1
```



---

---
title: "[ABC054D] Mixing Experiment"
layout: "post"
diff: 普及/提高-
pid: AT_abc054_d
tag: []
---

# [ABC054D] Mixing Experiment

## 题目描述

------------

有 $N$ 个物体，第 $i$ 个物体含有 $a_i$ 质量的 A 元素 和 $b_i$ 质量的 B 元素，代价为 $c_i$ 。

问能否取若干个物体，使 A 元素与 B 元素质量之比为 $M_a : M_b$ ，并使代价最小。

------------

## 输入格式

第一行3个整数 $N ,M_a ,M_b$

下面 $N$ 行，每行3个整数 $a_i ,b_i ,c_i$

$ N $   $ M_a $   $ M_b $   
$ a_1 $   $ b_1 $   $ c_1 $   
$ a_2 $   $ b_2 $   $ c_2 $ 

$ : $   
$ a_N $   $ b_N $   $ c_N $ 

------------

## 输出格式

若能满足条件则输出 **最小代价**。

否则输出 -1

------------

## 说明/提示

- $1\le N\le 40$

- $1\le a_i,b_i\le 10$

- $1\le c_i\le 100$

- $1\le M_a,M_b\le 10$

-  $gcd(M_a,M_b)=1$

- 输入都为整数。

------------

translated by @君のNOIP。

## 样例 #1

### 输入

```
3 1 1

1 2 1

2 1 2

3 3 10
```

### 输出

```
3
```

## 样例 #2

### 输入

```
1 1 10

10 10 10
```

### 输出

```
-1
```



---

---
title: "[ABC057B] Checkpoints"
layout: "post"
diff: 普及/提高-
pid: AT_abc057_b
tag: []
---

# [ABC057B] Checkpoints

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc057/tasks/abc057_b

$ xy $ 平面があり、その上に $ N $ 人の学生がいて、$ M $ 個のチェックポイントがあります。  
 $ i $ 番目の学生がいる座標は $ (a_i,b_i)\ (1≦i≦N) $ であり、番号 $ j $ のチェックポイントの座標は $ (c_j,d_j)\ (1≦j≦M) $ です。   
 これから合図があり、各学生はマンハッタン距離で一番近いチェックポイントに集合しなければなりません。   
 2つの地点 $ (x_1,y_1) $ と $ (x_2,y_2) $ 間のマンハッタン距離は $ |x_1-x_2|+|y_1-y_2| $ で表されます。  
 ここで、$ |x| $ は $ x $ の絶対値を表します。  
 ただし、一番近いチェックポイントが複数ある場合には、番号が最も小さいチェックポイントに移動することとします。  
 合図の後に、各学生がどのチェックポイントに移動するかを求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ M $ $ a_1 $ $ b_1 $ $ : $ $ a_N $ $ b_N $ $ c_1 $ $ d_1 $ $ : $ $ c_M $ $ d_M $

## 输出格式

解答を $ N $ 行に出力せよ。  
 $ i\ (1\ ≦i≦N) $ 番目の行には、$ i $ 番目の学生が訪れるチェックポイントの番号を出力せよ。

## 说明/提示

### 制約

- $ 1≦N,M≦50 $
- $ -10^8≦a_i,b_i,c_j,d_j≦10^8 $
- 入力は全て整数である。

### Sample Explanation 1

$ 1 $ 番目の学生と各チェックポイント間のマンハッタン距離は以下の通りです。 - 番号 $ 1 $ のチェックポイントへのマンハッタン距離は $ |2-(-1)|+|0-0|=3 $ - 番号 $ 2 $ のチェックポイントへのマンハッタン距離は $ |2-1|+|0-0|=1 $ したがって、最も近いチェックポイントの番号は $ 2 $ であるため、$ 1 $ 行目には $ 2 $ と出力します。 $ 2 $ 番目の学生と各チェックポイント間のマンハッタン距離は以下の通りです。 - 番号 $ 1 $ のチェックポイントへのマンハッタン距離は $ |0-(-1)|+|0-0|=1 $ - 番号 $ 2 $ のチェックポイントへのマンハッタン距離は $ |0-1|+|0-0|=1 $ 最も近いチェックポイントが複数ある場合は、番号が最も小さいチェックポイントに移動するため、$ 2 $ 行目には $ 1 $ と出力します。

### Sample Explanation 2

同じ座標に複数のチェックポイントが存在する場合もあります。

## 样例 #1

### 输入

```
2 2

2 0

0 0

-1 0

1 0
```

### 输出

```
2

1
```

## 样例 #2

### 输入

```
3 4

10 10

-10 -10

3 3

1 2

2 3

3 5

3 5
```

### 输出

```
3

1

2
```

## 样例 #3

### 输入

```
5 5

-100000000 -100000000

-100000000 100000000

100000000 -100000000

100000000 100000000

0 0

0 0

100000000 100000000

100000000 -100000000

-100000000 100000000

-100000000 -100000000
```

### 输出

```
5

4

3

2

1
```



---

---
title: "[ABC070C] Multiple Clocks"
layout: "post"
diff: 普及/提高-
pid: AT_abc070_c
tag: []
---

# [ABC070C] Multiple Clocks

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc070/tasks/abc070_c

$ N $ 台の時計があり、$ i(1≦i≦N) $ 番目の時計の針はちょうど $ T_i $ 秒で時計盤を $ 1 $ 周します。   
 最初、全ての時計の針は真っ直ぐ上に向いており、止まっています。   
 イルカは、全ての時計の針を同時に動かし始めました。   
 再び、全ての時計の針が真っ直ぐ上に向くのは何秒後でしょうか?

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ T_1 $ $ : $ $ T_N $

## 输出格式

時計の針を動かし始めてから、再び全ての時計の針が真っ直ぐ上に向くまでの秒数を出力せよ。

## 说明/提示

### 制約

- $ 1≦N≦100 $
- $ 1≦T_i≦10^{18} $
- 入力は全て整数である。
- 答えは $ 10^{18} $ 秒以内である。

### Sample Explanation 1

$ 2 $ つの時計があり、各時計の針が真っ直ぐ上に向くのは以下の時刻です。 - $ 1 $ 番目の時計の針: 時計の針を動かし始めてから、$ 2 $ 秒後、$ 4 $ 秒後、$ 6 $ 秒後、$ ... $ - $ 2 $ 番目の時計の針: 時計の針を動かし始めてから、$ 3 $ 秒後、$ 6 $ 秒後、$ 9 $ 秒後、$ ... $ したがって、$ 2 $ つの時計の針が真っ直ぐ上に向くのにかかる秒数は $ 6 $ 秒となります。

## 样例 #1

### 输入

```
2

2

3
```

### 输出

```
6
```

## 样例 #2

### 输入

```
5

2

5

10

1000000000000000000

1000000000000000000
```

### 输出

```
1000000000000000000
```



---

---
title: "[ABC075C] Bridge"
layout: "post"
diff: 普及/提高-
pid: AT_abc075_c
tag: []
---

# [ABC075C] Bridge

## 题目描述

给你一个$N$个点$M$条边无重边无自环的无向图。

求有几个桥（自行百度）。

## 输入格式

第一行两个正整数$N,M$，之后$M$行每行两个数$u,v$描述无向边。

## 输出格式

一个正整数代表图里有几个桥。

## 说明/提示

$1 \leq N \leq 50$

$N-1 \leq M \leq N(N-1)/2$

## 样例 #1

### 输入

```
7 7

1 3

2 7

3 4

4 5

4 6

5 6

6 7
```

### 输出

```
4
```

## 样例 #2

### 输入

```
3 3

1 2

1 3

2 3
```

### 输出

```
0
```

## 样例 #3

### 输入

```
6 5

1 2

2 3

3 4

4 5

5 6
```

### 输出

```
5
```



---

---
title: "[ABC076C] Dubious Document 2"
layout: "post"
diff: 普及/提高-
pid: AT_abc076_c
tag: []
---

# [ABC076C] Dubious Document 2

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc076/tasks/abc076_c

E869120 は、宝物が入ってそうな箱を見つけました。  
 しかし、これには鍵がかかっており、鍵を開けるためには英小文字からなる文字列 $ S $ が必要です。  
 彼は文字列 $ S' $ を見つけ、これは文字列 $ S $ の $ 0 $ 個以上 $ |S| $ 個以内の文字が `?` に置き換わった文字列であることも分かりました。  
 ただし、文字列 $ A $ に対して、$ |A| $ を「文字列 $ A $ の長さ」とします。

そこで、E869120 はヒントとなる紙を見つけました。

- 条件1：文字列 $ S $ の中に連続する部分文字列として英小文字から成る文字列 $ T $ が含まれている。
- 条件2：$ S $ は、条件1を満たす文字列の中で辞書順最小の文字列である。

そのとき、鍵となる文字列 $ S $ を出力しなさい。  
 ただし、そのような文字列 $ S $ が存在しない場合は代わりに `UNRESTORABLE` と出力しなさい。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ S' $ $ T $

## 输出格式

鍵となる文字列 $ S $ を出力しなさい。  
 ただし、そのような文字列 $ S $ が存在しない場合は、代わりに `UNRESTORABLE` と出力しなさい。

## 说明/提示

### 制約

- $ 1\ \leq\ |S'|,\ |T|\ \leq\ 50 $
- $ S' $ は英小文字と `?` から成る
- $ T $ は英小文字から成る

### Sample Explanation 1

条件1 を満たす文字列は `atcoder`, `btcoder`, `ctcoder`,..., `ztcoder` の $ 26 $ 個がありますが、その中で最も辞書順で小さいものは `atcoder` なので、$ S\ = $`atcoder` と特定できます。

### Sample Explanation 2

条件1を満たすような文字列 $ S $ が存在しないので、鍵となる文字列 $ S $ は存在しません。

## 样例 #1

### 输入

```
?tc????

coder
```

### 输出

```
atcoder
```

## 样例 #2

### 输入

```
??p??d??

abc
```

### 输出

```
UNRESTORABLE
```



---

---
title: "[ABC080C] Shopping Street"
layout: "post"
diff: 普及/提高-
pid: AT_abc080_c
tag: []
---

# [ABC080C] Shopping Street

## 题目描述

Joisino计划要在商店街开一家店。

这家店在周一到周五的$5$ 个工作日都有营业，其中每个工作日又被划分成上午和下午$2$ 个时间段，也就是共有$10$ 个时间段。当然，至少要有$1$ 个时间段这家店营业。

商店街原来有$N$ 个店铺，从$1$ 到$N$ 编号。

这些店铺的营业时间将以$F_{i,j,k}=1$ 的形式给出。如果$F_{i,j,k}=1$ ，第$i$ 家店将在第$j$ 天的第$k$ 个时间段营业。在这里，我们这样定义：第$1$ 天是周一，第$2$ 天是周二，第$3$ 天是周三，第$4$ 天是周四，第$5$ 天是周五。同样的，第$1$ 个时间段是上午，第$2$ 个时间段是下午。

设$c_i$ 为第$i$ 家店和Joisino的店同时营业的时间段数，则Joisino商店的收益将会是$P_{1,c1}+P_{2,c2}+...+P_{N,cN}$ 。

请决定Joisino在这$10$ 个时间段分别是否营业，并求出Joisino商店可能的最大收益，且保证它至少要有$1$ 个时间段营业。

## 输入格式

第一行，一个整数$N$ 。

接下来$N$ 行，第i行有10个整数，分别表示$F_{i,1,1}, F_{i,1,2}, ..., F_{i,5,1}, F_{i,5,2}$ 。

再接下来$N$ 行，第i行有11个整数，分别表示$P_{i,0}, ..., P_{i, 10}$ 。

## 输出格式

只有一行，一个整数，表示Joisino商店可能的最大收益。

## 说明/提示

### 样例解释1
如果商店仅在第$1$ 家店营业时营业，收益将会是$8$ ，这是可能的最大收益。

### 样例解释2
由于必须至少有一个时间段商店营业，所以收益可能会是负数。

- $1 \leq N \leq 100$ 
- $0 \leq F_{i,j,k} \leq 1$ 
- 对所有满足 $1 \leq i \leq N$ 的 $i$ , 总有一对$(j, k)$ 满足$F_{i,j,k}=1$ 。
- $-10^7 \leq P_{i,j} \leq 10^7$ 
- 所有输入数据均为整数。

by @月见之兔

## 样例 #1

### 输入

```
1

1 1 0 1 0 0 0 1 0 1

3 4 5 6 7 8 9 -2 -3 4 -2
```

### 输出

```
8
```

## 样例 #2

### 输入

```
2

1 1 1 1 1 0 0 0 0 0

0 0 0 0 0 1 1 1 1 1

0 -2 -2 -2 -2 -2 -1 -1 -1 -1 -1

0 -2 -2 -2 -2 -2 -1 -1 -1 -1 -1
```

### 输出

```
-2
```

## 样例 #3

### 输入

```
3

1 1 1 1 1 1 0 0 1 1

0 1 0 1 1 1 1 0 1 0

1 0 1 1 0 1 0 1 0 1

-8 6 -2 -8 -8 4 8 7 -6 2 2

-9 2 0 1 7 -5 0 -2 -6 5 5

6 -6 7 -9 6 -5 8 0 -9 -7 -7
```

### 输出

```
23
```



---

---
title: "[ABC088D] Grid Repainting"
layout: "post"
diff: 普及/提高-
pid: AT_abc088_d
tag: []
---

# [ABC088D] Grid Repainting

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc088/tasks/abc088_d

縦 $ H $ マス, 横 $ W $ マスに広がるマス目があり, 各マスは白または黒で塗られている. 上から $ i $ 番目で左から $ j $ 番目のマスを $ (i,\ j) $ で表す. すぬけ君は, このマス目を使って次のようなゲームをしたい. ゲームの開始時点ではマス $ (1,\ 1) $ にゲームキャラクター「けぬす君」がいる. プレイヤーはけぬす君を上下左右の $ 4 $ 方向のいずれかに $ 1 $ マスだけ動かすことを繰り返す. けぬす君が白いマスだけを通って $ (H,\ W) $ にたどり着けばゲームクリアとなる.  
 ゲームを開始する前に, すぬけ君はいくつかの白いマス目の色を黒に変えることができる. ただし, マス $ (1,\ 1) $ と $ (H,\ W) $ の色を変えることはできず, ゲームを開始するまでにすべての色の変更を行わなければならない.  
 ゲームをクリアしたとき, ゲームの開始前にマスの色を変えた回数がすぬけ君のスコアとなる. そのとき, すぬけ君が取る可能性のある最大のスコアを求めなさい.ただし, すぬけ君がどのようにマス目の色を変えてもけぬす君が $ (H,\ W) $ にたどり着くことが出来ない場合、$ -1 $ と出力しなさい.

ただし, 各マスの色の情報は文字 $ s_{i,\ j} $ として与えられる. マス $ (i,\ j) $ が最初白で塗られている場合 $ s_{i,\ j} $ は `.` であり, マス $ (i,\ j) $ が最初黒で塗られている場合 $ s_{i,\ j} $ は `#` である.

## 输入格式

入力は以下の形式で標準入力から与えられる.

> $ H $ $ W $ $ s_{1,\ 1}s_{1,\ 2}s_{1,\ 3}\ ...\ s_{1,\ W} $ $ s_{2,\ 1}s_{2,\ 2}s_{2,\ 3}\ ...\ s_{2,\ W} $ $ : $ $ : $ $ s_{H,\ 1}s_{H,\ 2}s_{H,\ 3}\ ...\ s_{H,\ W} $

## 输出格式

すぬけ君が取る可能性のある最大のスコアを出力しなさい. ただし, すぬけ君がどのようにマス目の色を変えてもけぬす君が $ (H,\ W) $ にたどり着くことが出来ない場合、$ -1 $ と出力しなさい.

## 说明/提示

### 制約

- $ H $ は $ 2 $ 以上 $ 50 $ 以下の整数
- $ W $ は $ 2 $ 以上 $ 50 $ 以下の整数
- $ s_{i,\ j} $ は `.` または `#` $ (1\ \leq\ i\ \leq\ H,\ 1\ \leq\ j\ \leq\ W) $
- $ s_{1,\ 1},\ s_{H,\ W} $ は `.` である

### Sample Explanation 1

下の図のようにマス目の色を変えれば, スコア $ 2 $ を達成できます. !\[Explanation of Sample 1\](https://img.atcoder.jp/abc088/bc944898899615e35f898654b68cd517.png)

## 样例 #1

### 输入

```
3 3

..#

#..

...
```

### 输出

```
2
```

## 样例 #2

### 输入

```
10 37

.....................................

...#...####...####..###...###...###..

..#.#..#...#.##....#...#.#...#.#...#.

..#.#..#...#.#.....#...#.#...#.#...#.

.#...#.#..##.#.....#...#.#.###.#.###.

.#####.####..#.....#...#..##....##...

.#...#.#...#.#.....#...#.#...#.#...#.

.#...#.#...#.##....#...#.#...#.#...#.

.#...#.####...####..###...###...###..

.....................................
```

### 输出

```
209
```



---

---
title: "[ABC089D] Practical Skill Test"
layout: "post"
diff: 普及/提高-
pid: AT_abc089_d
tag: []
---

# [ABC089D] Practical Skill Test

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc089/tasks/abc089_d

$ H $ 行 $ W $ 列のマス目があり、$ i $ 行目の $ j $ 列目のマスをマス $ (i,j) $ と呼びます。

このマス目には $ 1 $ から $ H×W $ までの整数が重複なく書かれており、マス $ (i,j) $ に書かれている整数は $ A_{i,j} $ です。

魔法少女であるあなたは、魔力 $ |x-i|+|y-j| $ を消費することでマス $ (i,j) $ に置かれた駒をマス $ (x,y) $ に瞬間移動させることができます。

あなたは、魔法少女としての能力を計るために、$ Q $ 回の実技試験を受けなければなりません。

$ i $ 回目の実技試験は、以下の手順で行われます。

- 初めに、駒が整数 $ L_i $ の書かれているマスに置かれている。
- 駒の置かれているマスに書かれている整数を $ x $ とする。$ x $ が $ R_i $ でない限り、駒を $ x+D $ の書かれているマスに移動することを繰り返す。$ x=R_i $ となったら終了する。
- ただし、$ R_i-L_i $ が $ D $ の倍数であることは保証される。

それぞれの実技試験に対し、あなたの消費する魔力の総和を求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ H $ $ W $ $ D $ $ A_{1,1} $ $ A_{1,2} $ $ ... $ $ A_{1,W} $ $ : $ $ A_{H,1} $ $ A_{H,2} $ $ ... $ $ A_{H,W} $ $ Q $ $ L_1 $ $ R_1 $ $ : $ $ L_Q $ $ R_Q $

## 输出格式

それぞれの実技試験に対し、あなたの消費する魔力の総和を出力せよ。

ただし、出力する順番は実技試験の行われる順とすること。

## 说明/提示

### 制約

- $ 1\ \leq\ H,W\ \leq\ 300 $
- $ 1\ \leq\ D\ \leq\ H×W $
- $ 1\ \leq\ A_{i,j}\ \leq\ H×W $
- $ A_{i,j}\ \neq\ A_{x,y}\ ((i,j)\ \neq\ (x,y)) $
- $ 1\ \leq\ Q\ \leq\ 10^5 $
- $ 1\ \leq\ L_i\ \leq\ R_i\ \leq\ H×W $
- $ (R_i-L_i) $ は $ D $ の倍数

### Sample Explanation 1

\- $ 4 $ が書かれたマスは、マス $ (1,2) $ です。 - $ 6 $ が書かれたマスは、マス $ (3,3) $ です。 - $ 8 $ が書かれたマスは、マス $ (3,1) $ です。 よって、$ 1 $ 回目の実技試験であなたの消費する魔力の総和は、$ (|3-1|+|3-2|)+(|3-3|+|1-3|)=5 $ です。

### Sample Explanation 2

駒を全く移動しない実技試験が存在する場合や、複数の実技試験の内容が同じ場合に注意してください。

## 样例 #1

### 输入

```
3 3 2

1 4 3

2 5 7

8 9 6

1

4 8
```

### 输出

```
5
```

## 样例 #2

### 输入

```
4 2 3

3 7

1 4

5 2

6 8

2

2 2

2 2
```

### 输出

```
0

0
```

## 样例 #3

### 输入

```
5 5 4

13 25 7 15 17

16 22 20 2 9

14 11 12 1 19

10 6 23 8 18

3 21 5 24 4

3

13 13

2 10

13 13
```

### 输出

```
0

5

0
```



---

---
title: "[ABC096D] Five, Five Everywhere"
layout: "post"
diff: 普及/提高-
pid: AT_abc096_d
tag: []
---

# [ABC096D] Five, Five Everywhere

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc096/tasks/abc096_d

以下の条件を満たす, 長さ $ N $ の数列 $ a_1,\ a_2,\ ...,\ a_N $ を $ 1 $ つ出力してください.

- $ a_i\ (1\ \leq\ i\ \leq\ N) $ は $ 55\ 555 $ 以下の素数である.
- $ a_1,\ a_2,\ ...,\ a_N $ の値はすべて異なる.
- $ a_1,\ a_2,\ ...,\ a_N $ からどの異なる $ 5 $ 個の整数を選んでも, この合計は合成数になる.

条件を満たす数列が複数個存在するとき、条件を満たすもののうちどのような数列を出力しても正解となります.

## 输入格式

入力は以下の形式で標準入力から与えられる.

> $ N $

## 输出格式

$ 1 $ 行に, $ N $ 個の数 $ a_1,\ a_2,\ a_3,\ ...,\ a_N $ を空白区切りで出力しなさい.

## 说明/提示

### 備考

$ 2 $ 以上の整数 $ N $ が, $ 1 $ と $ N $ 以外のどの正の整数でも割り切れなければ $ N $ は「素数」であり, そうでない場合 $ N $ は「合成数」である.

### 制約

- $ N $ は $ 5 $ 以上 $ 55 $ 以下の整数

### Sample Explanation 1

まず, $ 3 $, $ 5 $, $ 7 $, $ 11 $, $ 31 $ は全て異なり, 全て素数です. これらから $ 5 $ 個の整数を選ぶ方法は, 「全てを選ぶ」の 1 通りのみです. $ a_1+a_2+a_3+a_4+a_5=57 $ であり, この値は合成数なので問題文の条件を満たします. 他にも, `2 3 5 7 13` `11 13 17 19 31` `7 11 5 31 3` などを出力しても正解となります.

### Sample Explanation 2

\- $ 2 $, $ 3 $, $ 5 $, $ 7 $, $ 11 $, $ 13 $ は全て異なる素数です. - $ 2+3+5+7+11=28 $ であり, 合成数です. - $ 2+3+5+7+13=30 $ であり, 合成数です. - $ 2+3+5+11+13=34 $ であり, 合成数です. - $ 2+3+7+11+13=36 $ であり, 合成数です. - $ 2+5+7+11+13=38 $ であり, 合成数です. - $ 3+5+7+11+13=39 $ であり, 合成数です. よって, `2 3 5 7 11 13` は条件を満たす数列です.

## 样例 #1

### 输入

```
5
```

### 输出

```
3 5 7 11 31
```

## 样例 #2

### 输入

```
6
```

### 输出

```
2 3 5 7 11 13
```

## 样例 #3

### 输入

```
8
```

### 输出

```
2 5 7 13 19 37 67 79
```



---

---
title: "[ABC099C] Strange Bank"
layout: "post"
diff: 普及/提高-
pid: AT_abc099_c
tag: []
---

# [ABC099C] Strange Bank

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc099/tasks/abc099_c

ある銀行では、お金の引き出しを難しくするために、一回の操作で引き出せる金額が以下のいずれかとなっています。

- $ 1 $ 円
- $ 6 $ 円、$ 6^2(=36) $ 円、$ 6^3(=216) $ 円、$ ... $
- $ 9 $ 円、$ 9^2(=81) $ 円、$ 9^3(=729) $ 円、$ ... $

この銀行からちょうど $ N $ 円を引き出すには少なくとも何回の操作が必要か求めてください。

ただし、一度引き出したお金を再び預け入れてはならないとします。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $

## 输出格式

この銀行からちょうど $ N $ 円を引き出すのに少なくとも $ x $ 回の操作が必要な時、$ x $ を出力せよ。

## 说明/提示

### 制約

- $ 1\ \leq\ N\ \leq\ 100000 $
- $ N $ は整数

### Sample Explanation 1

$ 1 $ 円、$ 9 $ 円、$ 36(=6^2) $ 円、$ 81(=9^2) $ 円を引き出す操作をそれぞれ $ 1 $ 回ずつ行うことで、合計 $ 4 $ 回の操作で $ 127 $ 円を引き出すことができます。

### Sample Explanation 2

$ 1 $ 円を 引き出す操作を $ 3 $ 回 行うことで、合計 $ 3 $ 回の操作で $ 3 $ 円を引き出すことができます。

## 样例 #1

### 输入

```
127
```

### 输出

```
4
```

## 样例 #2

### 输入

```
3
```

### 输出

```
3
```

## 样例 #3

### 输入

```
44852
```

### 输出

```
16
```



---

---
title: "[ABC103C] Modulo Summation"
layout: "post"
diff: 普及/提高-
pid: AT_abc103_c
tag: []
---

# [ABC103C] Modulo Summation

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc103/tasks/abc103_c

$ N $ 個の正整数 $ a_1,\ a_2,\ ...,\ a_N $ が与えられます。

非負整数 $ m $ に対して、$ f(m)\ =\ (m\ mod\ a_1)\ +\ (m\ mod\ a_2)\ +\ ...\ +\ (m\ mod\ a_N) $ とします。

ここで、$ X\ mod\ Y $ は $ X $ を $ Y $ で割った余りを表します。

$ f $ の最大値を求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ a_1 $ $ a_2 $ $ ... $ $ a_N $

## 输出格式

$ f $ の最大値を出力せよ。

## 说明/提示

### 制約

- 入力は全て整数である
- $ 2\ \leq\ N\ \leq\ 3000 $
- $ 2\ \leq\ a_i\ \leq\ 10^5 $

### Sample Explanation 1

$ f(11)\ =\ (11\ mod\ 3)\ +\ (11\ mod\ 4)\ +\ (11\ mod\ 6)\ =\ 10 $ が $ f $ の最大値です。

## 样例 #1

### 输入

```
3

3 4 6
```

### 输出

```
10
```

## 样例 #2

### 输入

```
5

7 46 11 20 11
```

### 输出

```
90
```

## 样例 #3

### 输入

```
7

994 518 941 851 647 2 581
```

### 输出

```
4527
```



---

---
title: "[ABC103D] Islands War"
layout: "post"
diff: 普及/提高-
pid: AT_abc103_d
tag: []
---

# [ABC103D] Islands War

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc103/tasks/abc103_d

東西一列に並んだ $ N $ 個の島と $ N-1 $ 本の橋があります。

$ i $ 番目の橋は、西から $ i $ 番目の島と西から $ i+1 $ 番目の島を接続しています。

ある日、いくつかの島同士で争いが起こり、島の住人たちから $ M $ 個の要望がありました。

要望 $ i $: 西から $ a_i $ 番目の島と西から $ b_i $ 番目の島の間で争いが起こったために、これらの島をいくつかの橋を渡って行き来できないようにしてほしい

あなたは橋をいくつか取り除くことでこれら $ M $ 個の要望全てを叶えることにしました。

取り除く必要のある橋の本数の最小値を求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ M $ $ a_1 $ $ b_1 $ $ a_2 $ $ b_2 $ $ : $ $ a_M $ $ b_M $

## 输出格式

取り除く必要のある橋の本数の最小値を出力せよ。

## 说明/提示

### 制約

- 入力は全て整数である
- $ 2\ \leq\ N\ \leq\ 10^5 $
- $ 1\ \leq\ M\ \leq\ 10^5 $
- $ 1\ \leq\ a_i $
- 組 $ (a_i,\ b_i) $ は全て異なる

### Sample Explanation 1

西から $ 2 $ 番目の島と $ 3 $ 番目の島を接続する橋を取り除くことで達成できます。

## 样例 #1

### 输入

```
5 2

1 4

2 5
```

### 输出

```
1
```

## 样例 #2

### 输入

```
9 5

1 8

2 7

3 5

4 6

7 9
```

### 输出

```
2
```

## 样例 #3

### 输入

```
5 10

1 2

1 3

1 4

1 5

2 3

2 4

2 5

3 4

3 5

4 5
```

### 输出

```
4
```



---

---
title: "[ABC109D] Make Them Even"
layout: "post"
diff: 普及/提高-
pid: AT_abc109_d
tag: []
---

# [ABC109D] Make Them Even

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc109/tasks/abc109_d

縦 $ H $ 行横 $ W $ 列に区切られたマス目があり、上から $ i $ 番目、左から $ j $ 列目のマスをマス $ (i,\ j) $ と呼びます。

マス $ (i,\ j) $ には $ a_{ij} $ 枚のコインが置かれています。

あなたは以下の操作を何度でも行うことができます。

操作: まだ選んだことのないマスのうち $ 1 $ 枚以上のコインが置かれているマスを $ 1 $ つ選び、そのマスに置かれているコインのうち $ 1 $ 枚を上下左右に隣接するいずれかのマスに移動する

偶数枚のコインが置かれたマスの数を最大化してください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ H $ $ W $ $ a_{11} $ $ a_{12} $ $ ... $ $ a_{1W} $ $ a_{21} $ $ a_{22} $ $ ... $ $ a_{2W} $ $ : $ $ a_{H1} $ $ a_{H2} $ $ ... $ $ a_{HW} $

## 输出格式

偶数枚のコインが置かれたマスの数が最大となるような操作の列を次の形式で出力せよ。

> $ N $ $ y_1 $ $ x_1 $ $ y_1' $ $ x_1' $ $ y_2 $ $ x_2 $ $ y_2' $ $ x_2' $ $ : $ $ y_N $ $ x_N $ $ y_N' $ $ x_N' $

すなわち、$ 1 $ 行目には操作の回数を表す $ 0 $ 以上 $ H\ \times\ W $ 以下の整数 $ N $ を出力せよ。

$ i+1 $ ($ 1\ \leq\ i\ \leq\ N $) 行目には $ i $ 回目の操作を表す整数 $ y_i,\ x_i,\ y_i',\ x_i' $ ($ 1\ \leq\ y_i,\ y_i'\ \leq\ H $ かつ $ 1\ \leq\ x_i,\ x_i'\ \leq\ W $) を出力せよ。 ただし、これはマス $ (y_i,\ x_i) $ にあるコインのうち $ 1 $ 枚を上下左右に隣接するマス $ (y_i',\ x_i') $ に移動させる操作を表す。

問題文中の操作でないような操作が与えられた場合や、出力の形式が正しくない場合には *Wrong Answer* となるので注意せよ。

## 说明/提示

### 制約

- 入力はすべて整数である
- $ 1\ \leq\ H,\ W\ \leq\ 500 $
- $ 0\ \leq\ a_{ij}\ \leq\ 9 $

### Sample Explanation 1

次のように操作を行えば、全てのマスに置かれたコインの数を偶数にできます。 - マス $ (2,\ 2) $ に置かれているコインのうち $ 1 $ 枚をマス $ (2,\ 3) $ に移動します - マス $ (1,\ 1) $ に置かれているコインのうち $ 1 $ 枚をマス $ (1,\ 2) $ に移動します - マス $ (1,\ 3) $ に置かれているコインのうち $ 1 $ 枚をマス $ (1,\ 2) $ に移動します

## 样例 #1

### 输入

```
2 3

1 2 3

0 1 1
```

### 输出

```
3

2 2 2 3

1 1 1 2

1 3 1 2
```

## 样例 #2

### 输入

```
3 2

1 0

2 1

1 0
```

### 输出

```
3

1 1 1 2

1 2 2 2

3 1 3 2
```

## 样例 #3

### 输入

```
1 5

9 9 9 9 9
```

### 输出

```
2

1 1 1 2

1 3 1 4
```



---

---
title: "[ABC110C] String Transformation"
layout: "post"
diff: 普及/提高-
pid: AT_abc110_c
tag: []
---

# [ABC110C] String Transformation

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc110/tasks/abc110_c

英小文字のみからなる文字列 $ S $, $ T $ が与えられます。

文字列 $ S $ に対して、次の操作を何度でも行うことができます。

操作: 2つの異なる英小文字 $ c_1 $, $ c_2 $ を選び、$ S $ に含まれる全ての $ c_1 $ を $ c_2 $ に、$ c_2 $ を $ c_1 $ に置き換える

$ 0 $ 回以上操作を行って、$ S $ を $ T $ に一致させられるか判定してください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ S $ $ T $

## 输出格式

$ S $ を $ T $ に一致させられる場合は `Yes`、そうでない場合は `No` を出力せよ。

## 说明/提示

### 制約

- $ 1\ \leq\ |S|\ \leq\ 2\ \times\ 10^5 $
- $ |S|\ =\ |T| $
- $ S $, $ T $ は英小文字のみからなる

### Sample Explanation 1

次のように操作を行えば、`azzel` を `apple` にできます。 - $ c_1 $ として `e` を、$ c_2 $ として `l` を選ぶと、`azzel` が `azzle` になる - $ c_1 $ として `z` を、$ c_2 $ として `p` を選ぶと、`azzle` が `apple` になる

### Sample Explanation 2

どのように操作を行っても `chokudai` を `redcoder` にできません。

## 样例 #1

### 输入

```
azzel

apple
```

### 输出

```
Yes
```

## 样例 #2

### 输入

```
chokudai

redcoder
```

### 输出

```
No
```

## 样例 #3

### 输入

```
abcdefghijklmnopqrstuvwxyz

ibyhqfrekavclxjstdwgpzmonu
```

### 输出

```
Yes
```



---

---
title: "[ABC112C] Pyramid"
layout: "post"
diff: 普及/提高-
pid: AT_abc112_c
tag: []
---

# [ABC112C] Pyramid

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc112/tasks/abc112_c

古代すぬけ国では, AtCoder 社長「高橋君」の権威を高めるために, ピラミッドが建てられていた.  
 ピラミッドには **中心座標** $ (C_X,\ C_Y) $ と **高さ** $ H $ が定まっており, 座標 $ (X,\ Y) $ の高度は $ max(H\ -\ |X\ -\ C_X|\ -\ |Y\ -\ C_Y|,\ 0) $ であった.

探検家の青木君は, このピラミッドの中心座標と高さを求めるために調査を行った. その結果, 次のような情報が得られた.

- $ C_X,\ C_Y $ は $ 0 $ 以上 $ 100 $ 以下の整数で, $ H $ は $ 1 $ 以上の整数であった.
- 上記と別に $ N $ 個の情報が得られた. そのうち $ i $ 個目の情報は, 「座標 $ (x_i,\ y_i) $ の高度は $ h_i $ である」

この情報は, ピラミッドの中心座標と高さを特定するのに十分であった. 情報を手掛かりに, これらの値を求めなさい.

## 输入格式

入力は以下の形式で標準入力から与えられる.

> $ N $ $ x_1 $ $ y_1 $ $ h_1 $ $ x_2 $ $ y_2 $ $ h_2 $ $ x_3 $ $ y_3 $ $ h_3 $ $ : $ $ x_N $ $ y_N $ $ h_N $

## 输出格式

特定した中心座標と高さを表す整数 $ C_X,\ C_Y,\ H $ を空白区切りで, 1 行に出力しなさい.

## 说明/提示

### 制約

- $ N $ は $ 1 $ 以上 $ 100 $ 以下の整数
- $ x_i $, $ y_i $ は $ 0 $ 以上 $ 100 $ 以下の整数
- $ h_i $ は $ 0 $ 以上 $ 10^9 $ 以下の整数
- $ N $ 個の座標 $ (x_1,\ y_1),\ (x_2,\ y_2),\ (x_3,\ y_3),\ ...,\ (x_N,\ y_N) $ はすべて異なる
- ピラミッドの中心座標と高さをちょうど $ 1 $ つに特定することができる

### Sample Explanation 1

この場合, 中心座標は $ (2,\ 2) $, 高さは $ 6 $ と特定することができる.

### Sample Explanation 2

この場合, 中心座標は $ (0,\ 0) $, 高さは $ 100 $ と特定することができる. $ C_X,\ C_Y $ が $ 0 $ 以上 $ 100 $ 以下の整数であると分かっていることに注意せよ.

### Sample Explanation 3

この場合, 中心座標は $ (100,\ 0) $, 高さは $ 193 $ と特定することができる.

## 样例 #1

### 输入

```
4

2 3 5

2 1 5

1 2 5

3 2 5
```

### 输出

```
2 2 6
```

## 样例 #2

### 输入

```
2

0 0 100

1 1 98
```

### 输出

```
0 0 100
```

## 样例 #3

### 输入

```
3

99 1 191

100 1 192

99 0 192
```

### 输出

```
100 0 193
```



---

---
title: "[ABC112D] Partition"
layout: "post"
diff: 普及/提高-
pid: AT_abc112_d
tag: []
---

# [ABC112D] Partition

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc112/tasks/abc112_d

整数 $ N,\ M $ が与えられます。

$ a_1\ +\ a_2\ +\ ...\ +\ a_N $ = $ M $ となる正整数からなる長さ $ N $ の数列 $ a $ において、$ a_1,\ a_2,\ ...,\ a_N $ の最大公約数のとり得る最大値を求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ M $

## 输出格式

条件を満たす数列 $ a_1,\ a_2,\ ...,\ a_N $ の最大公約数のとり得る最大値を出力せよ。

## 说明/提示

### 制約

- 入力はすべて整数である
- $ 1\ \leq\ N\ \leq\ 10^5 $
- $ N\ \leq\ M\ \leq\ 10^9 $

### Sample Explanation 1

$ (a_1,\ a_2,\ a_3)\ =\ (2,\ 4,\ 8) $ としたときこれらの最大公約数が $ 2 $ となり最大です。

## 样例 #1

### 输入

```
3 14
```

### 输出

```
2
```

## 样例 #2

### 输入

```
10 123
```

### 输出

```
3
```

## 样例 #3

### 输入

```
100000 1000000000
```

### 输出

```
10000
```



---

---
title: "[ABC113C] ID"
layout: "post"
diff: 普及/提高-
pid: AT_abc113_c
tag: []
---

# [ABC113C] ID

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc113/tasks/abc113_c

Atcoder国には $ N $ 個の県があり、これらの県には合計で $ M $ 個の市が属しています。

市 $ i $ が誕生したのは $ Y_i $ 年であり、県 $ P_i $ に属しています。

ただし、同じ年に誕生した市が複数存在することはないとします。

それぞれの市に $ 12 $ 桁の認識番号を割り振ることとなりました。

市 $ i $ が 県 $ P_i $ に属する市の中で $ x $ 番目に誕生した市のとき、市 $ i $ の認識番号の上 $ 6 $ 桁は $ P_i $、下 $ 6 $ 桁は $ x $ となります。

ただし、$ P_i $ や $ x $ が $ 6 $ 桁に満たない場合は $ 6 $ 桁になるまで $ 0 $ を左に追加するものとします。

全ての市の認識番号を求めてください。

ただし、市が $ 1 $ つも属さない県がある場合に注意してください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ M $ $ P_1 $ $ Y_1 $ $ : $ $ P_M $ $ Y_M $

## 输出格式

全ての市の認識番号を市の番号の昇順に出力せよ。

## 说明/提示

### 制約

- $ 1\ \leq\ N\ \leq\ 10^5 $
- $ 1\ \leq\ M\ \leq\ 10^5 $
- $ 1\ \leq\ P_i\ \leq\ N $
- $ 1\ \leq\ Y_i\ \leq\ 10^9 $
- $ Y_i $ は全て異なる
- 入力は全て整数

### Sample Explanation 1

\- 市 $ 1 $ は県 $ 1 $ に属する市の中で $ 2 $ 番目に誕生したので、認識番号は $ 000001000002 $ となります。 - 市 $ 2 $ は県 $ 2 $ に属する市の中で $ 1 $ 番目に誕生したので、認識番号は $ 000002000001 $ となります。 - 市 $ 3 $ は県 $ 1 $ に属する市の中で $ 1 $ 番目に誕生したので、認識番号は $ 000001000001 $ となります。

## 样例 #1

### 输入

```
2 3

1 32

2 63

1 12
```

### 输出

```
000001000002

000002000001

000001000001
```

## 样例 #2

### 输入

```
2 3

2 55

2 77

2 99
```

### 输出

```
000002000001

000002000002

000002000003
```



---

---
title: "[ABC115D] Christmas"
layout: "post"
diff: 普及/提高-
pid: AT_abc115_d
tag: []
---

# [ABC115D] Christmas

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc115/tasks/abc115_d

とある世界では、今日はクリスマスです。

高羽氏のパーティで、彼は多次元バーガーを作ることにしました。*レベル $ L $ バーガー* ($ L $ は $ 0 $ 以上の整数) とは次のようなものです。

- レベル $ 0 $ バーガーとは、パティ $ 1 $ 枚である。
- レベル $ L $ バーガー $ (L\ \geq\ 1) $ とは、バン $ 1 $ 枚、レベル $ L-1 $ バーガー、パティ $ 1 $ 枚、レベル $ L-1 $ バーガー、バン $ 1 $ 枚、をこの順に下から積み重ねたものである。

例えば、パティを `P`、バンを `B` で表すと、レベル $ 1 $ バーガーは `BPPPB` (を $ 90 $ 度回転したもの)、レベル $ 2 $ バーガーは `BBPPPBPBPPPBB` といった見た目になります。

高羽氏が作るのはレベル $ N $ バーガーです。ダックスフンドのルンルンは、このバーガーの下から $ X $ 層を食べます (パティまたはバン $ 1 $ 枚を $ 1 $ 層とします)。ルンルンはパティを何枚食べるでしょうか？

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ X $

## 输出格式

レベル $ N $ バーガーの下から $ X $ 層に含まれるパティの枚数を出力せよ。

## 说明/提示

### 制約

- $ 1\ \leq\ N\ \leq\ 50 $
- $ 1\ \leq\ X\ \leq\ ( $ レベル $ N $ バーガーの層の総数 $ ) $
- $ N,\ X $ は整数である。

### Sample Explanation 1

レベル $ 2 $ バーガー (`BBPPPBPBPPPBB`) の下から $ 7 $ 層にはパティが $ 4 $ 枚含まれます。

### Sample Explanation 2

レベル $ 1 $ バーガーの一番下の層はバンです。

### Sample Explanation 3

レベル $ 50 $ バーガーは層の数が $ 32 $ ビット整数に収まらない程度に分厚いです。

## 样例 #1

### 输入

```
2 7
```

### 输出

```
4
```

## 样例 #2

### 输入

```
1 1
```

### 输出

```
0
```

## 样例 #3

### 输入

```
50 4321098765432109
```

### 输出

```
2160549382716056
```



---

---
title: "[ABC121D] XOR World"
layout: "post"
diff: 普及/提高-
pid: AT_abc121_d
tag: []
---

# [ABC121D] XOR World

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc121/tasks/abc121_d

$ f(A,\ B) $ を $ A,\ A+1,\ ...,\ B $ の排他的論理和としたとき、$ f(A,\ B) $ を求めてください。

排他的論理和とは

整数 $ c_1,\ c_2,\ ...,\ c_n $ のビットごとの排他的論理和 $ y $ は、以下のように定義されます。

- $ y $ を二進表記した際の $ 2^k $ ($ k\ \geq\ 0 $) の位の数は、$ c_1,\ c_2,\ ...,\ c_n $ のうち、二進表記した際の $ 2^k $ の位の数が $ 1 $ となるものが奇数個ならば $ 1 $、偶数個ならば $ 0 $ である。

例えば、$ 3 $ と $ 5 $ の排他的論理和は $ 6 $ です(二進数表記すると: `011` と `101` の排他的論理和は `110` です)。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ A $ $ B $

## 输出格式

$ f(A,\ B) $ を計算し、出力せよ。

## 说明/提示

### 制約

- 入力は全て整数である。
- $ 0\ \leq\ A\ \leq\ B\ \leq\ 10^{12} $

### Sample Explanation 1

$ 2,\ 3,\ 4 $ は $ 2 $ 進数でそれぞれ `010`, `011`, `100` です。 これらの排他的論理和は `101` であり、これを $ 10 $ 進数表記にすると $ 5 $ になります。

## 样例 #1

### 输入

```
2 4
```

### 输出

```
5
```

## 样例 #2

### 输入

```
123 456
```

### 输出

```
435
```

## 样例 #3

### 输入

```
123456789012 123456789012
```

### 输出

```
123456789012
```



---

---
title: "[ABC122C] GeT AC"
layout: "post"
diff: 普及/提高-
pid: AT_abc122_c
tag: []
---

# [ABC122C] GeT AC

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc122/tasks/abc122_c

`A`, `C`, `G`, `T` からなる長さ $ N $ の文字列 $ S $ が与えられます。以下の $ Q $ 個の問いに答えてください。

- 問 $ i $ ($ 1\ \leq\ i\ \leq\ Q $): 整数 $ l_i,\ r_i $ ($ 1\ \leq\ l_i\ <\ r_i\ \leq\ N $) が与えられる。$ S $ の先頭から $ l_i $ 文字目から $ r_i $ 文字目までの (両端含む) 部分文字列を考える。この文字列に `AC` は部分文字列として何回現れるか。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ Q $ $ S $ $ l_1 $ $ r_1 $ $ : $ $ l_Q $ $ r_Q $

## 输出格式

$ Q $ 行出力せよ。$ i $ 行目に問 $ i $ への答えを出力すること。

## 说明/提示

### 注記

文字列 $ T $ の部分文字列とは、$ T $ の先頭と末尾から $ 0 $ 文字以上を取り去って得られる文字列です。

例えば、`ATCODER` の部分文字列には `TCO`, `AT`, `CODER`, `ATCODER`, `` (空文字列) が含まれ、`AC` は含まれません。

### 制約

- $ 2\ \leq\ N\ \leq\ 10^5 $
- $ 1\ \leq\ Q\ \leq\ 10^5 $
- $ S $ は長さ $ N $ の文字列である。
- $ S $ の各文字は `A`, `C`, `G`, `T` のいずれかである。
- $ 1\ \leq\ l_i\ <\ r_i\ \leq\ N $

### Sample Explanation 1

\- 問 $ 1 $: $ S $ の先頭から $ 3 $ 文字目から $ 7 $ 文字目までの部分文字列は `ACTAC` です。この文字列に `AC` は部分文字列として $ 2 $ 回現れます。 - 問 $ 2 $: $ S $ の先頭から $ 2 $ 文字目から $ 3 $ 文字目までの部分文字列は `CA` です。この文字列に `AC` は部分文字列として $ 0 $ 回現れます。 - 問 $ 3 $: $ S $ の先頭から $ 1 $ 文字目から $ 8 $ 文字目までの部分文字列は `ACACTACG` です。この文字列に `AC` は部分文字列として $ 3 $ 回現れます。

## 样例 #1

### 输入

```
8 3

ACACTACG

3 7

2 3

1 8
```

### 输出

```
2

0

3
```



---

---
title: "[ABC124D] Handstand"
layout: "post"
diff: 普及/提高-
pid: AT_abc124_d
tag: []
---

# [ABC124D] Handstand

## 题目描述

有一个长为 $n$ 的字符串 $s$，只含 $0$ 和 $1$。  

你可以进行最多 $k$ 次如下操作（$0$ 次也可以）：



- 选择字符串 $s$ 的一个子串，将其中的字符反转（$0$ 变成 $1$，$1$ 变成 $0$）。



进行不超过 $k$ 次操作后，求最长的连续的 $1$ 的长度。

## 输入格式

第一行，$2$ 个正整数 $n,k$；  

第二行，字符串 $s$。

## 输出格式

输出不超过 $k$ 次操作后，最长的连续的 $1$ 的长度。



### 数据约定



对于 $100\%$ 的数据：$1 \le n, k \le 10^5$。  

字符串 $s$ 只由 $0$ 和 $1$ 组成，长度为 $n$。

## 样例 #1

### 输入

```
5 1

00010
```

### 输出

```
4
```

## 样例 #2

### 输入

```
14 2

11101010110011
```

### 输出

```
8
```

## 样例 #3

### 输入

```
1 1

1
```

### 输出

```
1
```



---

---
title: "[ABC125C] GCD on Blackboard"
layout: "post"
diff: 普及/提高-
pid: AT_abc125_c
tag: []
---

# [ABC125C] GCD on Blackboard

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc125/tasks/abc125_c

$ N $ 個の整数 $ A_1,\ A_2,\ ...,\ A_N $ が黒板に書かれています。

あなたはこの中から整数を $ 1 $ つ選んで、$ 1 $ 以上 $ 10^9 $ 以下の好きな整数に書き換えます。

元の整数と同じ整数に書き換えても構いません。

書き換えた後の $ N $ 個の整数の最大公約数の最大値を求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ A_1 $ $ A_2 $ $ ... $ $ A_N $

## 输出格式

書き換えた後の $ N $ 個の整数の最大公約数の最大値を出力せよ。

## 说明/提示

### 制約

- 入力は全て整数である。
- $ 2\ \leq\ N\ \leq\ 10^5 $
- $ 1\ \leq\ A_i\ \leq\ 10^9 $

### Sample Explanation 1

$ 7 $ を $ 4 $ に書き換えると $ 3 $ つの整数の最大公約数は $ 2 $ となり、これが最大です。

### Sample Explanation 3

元の整数と同じ整数に書き換えることも可能です。

## 样例 #1

### 输入

```
3

7 6 8
```

### 输出

```
2
```

## 样例 #2

### 输入

```
3

12 15 18
```

### 输出

```
6
```

## 样例 #3

### 输入

```
2

1000000000 1000000000
```

### 输出

```
1000000000
```



---

---
title: "[ABC125D] Flipping Signs"
layout: "post"
diff: 普及/提高-
pid: AT_abc125_d
tag: []
---

# [ABC125D] Flipping Signs

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc125/tasks/abc125_d

$ N $ 個の整数が並んでおり、順に $ A_1,\ A_2,\ ...,\ A_N $ です。

あなたはこの整数列に対して次の操作を好きなだけ行うことができます。

**操作**: $ 1\ \leq\ i\ \leq\ N-1 $ を満たす整数 $ i $ を選ぶ。$ A_i $ と $ A_{i+1} $ に $ -1 $ を乗算する。

操作終了後の整数列を $ B_1,\ B_2,\ ...,\ B_N $ とします。

$ B_1\ +\ B_2\ +\ ...\ +\ B_N $ の最大値を求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ A_1 $ $ A_2 $ $ ... $ $ A_N $

## 输出格式

$ B_1\ +\ B_2\ +\ ...\ +\ B_N $ の最大値を出力せよ。

## 说明/提示

### 制約

- 入力は全て整数である。
- $ 2\ \leq\ N\ \leq\ 10^5 $
- $ -10^9\ \leq\ A_i\ \leq\ 10^9 $

### Sample Explanation 1

次のように操作を行うと、$ B_1\ =\ 10,\ B_2\ =\ 5,\ B_3\ =\ 4 $ になり、このときの $ B_1\ +\ B_2\ +\ B_3\ =\ 10\ +\ 5\ +\ 4\ =\ 19 $ が最大です。 - $ i $ として $ 1 $ を選ぶ。操作により、整数列は $ 10,\ -5,\ -4 $ に変化する。 - $ i $ として $ 2 $ を選ぶ。操作により、整数列は $ 10,\ 5,\ 4 $ に変化する。

### Sample Explanation 3

出力が $ 32 $ ビット整数型に収まらない場合があります。

## 样例 #1

### 输入

```
3

-10 5 -4
```

### 输出

```
19
```

## 样例 #2

### 输入

```
5

10 -4 -8 -11 3
```

### 输出

```
30
```

## 样例 #3

### 输入

```
11

-1000000000 1000000000 -1000000000 1000000000 -1000000000 0 1000000000 -1000000000 1000000000 -1000000000 1000000000
```

### 输出

```
10000000000
```



---

---
title: "[ABC126D] Even Relation"
layout: "post"
diff: 普及/提高-
pid: AT_abc126_d
tag: []
---

# [ABC126D] Even Relation

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc126/tasks/abc126_d

$ N $ 頂点の木があります。 この木の $ i $ 番目の辺は頂点 $ u_i $ と頂点 $ v_i $ を結んでおり、その長さは $ w_i $ です。 あなたは以下の条件を満たすように、この木の頂点を白と黒の $ 2 $ 色で塗り分けたいです (すべての頂点を同じ色で塗っても構いません)。

- 同じ色に塗られた任意の $ 2 $ 頂点について、その距離が偶数である。

条件を満たす塗り分け方を $ 1 $ つ見つけて出力してください。この問題の制約下では、そのような塗り分け方が必ず $ 1 $ つは存在することが証明できます。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ u_1 $ $ v_1 $ $ w_1 $ $ u_2 $ $ v_2 $ $ w_2 $ $ . $ $ . $ $ . $ $ u_{N\ -\ 1} $ $ v_{N\ -\ 1} $ $ w_{N\ -\ 1} $

## 输出格式

題意の条件を満たすような頂点の塗り分け方を $ N $ 行に分けて出力せよ。 $ i $ 行目には、頂点 $ i $ を白く塗る場合は `0` を、黒く塗る場合は `1` を出力せよ。

条件を満たす塗り分け方が複数存在する場合、どれを出力してもよい。

## 说明/提示

### 制約

- 入力は全て整数である。
- $ 1\ \leq\ N\ \leq\ 10^5 $
- $ 1\ \leq\ u_i\ <\ v_i\ \leq\ N $
- $ 1\ \leq\ w_i\ \leq\ 10^9 $

## 样例 #1

### 输入

```
3

1 2 2

2 3 1
```

### 输出

```
0

0

1
```

## 样例 #2

### 输入

```
5

2 5 2

2 3 10

1 3 8

3 4 2
```

### 输出

```
1

0

1

0

1
```



---

---
title: "[ABC127D] Integer Cards"
layout: "post"
diff: 普及/提高-
pid: AT_abc127_d
tag: []
---

# [ABC127D] Integer Cards

## 题目描述

有一个长度为 $n$ 的序列 $A_{1},A_{2},\cdots,A_{n} $

你可以对这个序列依次进行 $m$ 次操作，第 $ i$ 次操作中，你可以选择至多 $B_{i}$ 个数（可以一个都不选），然后将这些数变成 $C_{i}$

问进行这 $m$ 次操作后，这个序列所有元素之和可能的最大值是多少

## 输入格式

第一行两个整数 $n,m$

第二行 $n$ 个整数，表示序列 $A$

接下来 $m$ 行，每行两个整数 $B_{i},C_{i}$ ，表示一次操作

## 输出格式

一行一个整数，表示答案

## 说明/提示

$1 \le n,m \le 10^5,1 \le A_{i},C{i} \le 10^9,1 \le B_{i} \le n$

## 样例 #1

### 输入

```
3 2

5 1 4

2 3

1 5
```

### 输出

```
14
```

## 样例 #2

### 输入

```
10 3

1 8 5 7 100 4 52 33 13 5

3 10

4 30

1 4
```

### 输出

```
338
```

## 样例 #3

### 输入

```
3 2

100 100 100

3 99

3 99
```

### 输出

```
300
```

## 样例 #4

### 输入

```
11 3

1 1 1 1 1 1 1 1 1 1 1

3 1000000000

4 1000000000

3 1000000000
```

### 输出

```
10000000001
```



---

---
title: "[ABC129D] Lamp"
layout: "post"
diff: 普及/提高-
pid: AT_abc129_d
tag: []
---

# [ABC129D] Lamp

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc129/tasks/abc129_d

縦 $ H $ 行横 $ W $ 列のグリッドが与えられます。このグリッドのうち、いくつかのマスには障害物が存在します。

すぬけ君は、障害物のないマスのうち一つを選び、そのマスに明かりを設置しようとしています。 設置されたマスから、上下左右の四方向にまっすぐに光線が伸びます。それぞれの方向について、最初に障害物が存在するマスにぶつかる、もしくはグリッドの端にぶつかる手前のマスまで照らされます。明かりを設置したマスも照らされますが、障害物が存在するマスは照らされません。

すぬけ君は明かりによって照らされるマスの個数を最大化したいです。

$ H $ 個の長さ $ W $ の文字列 $ S_i $ ($ 1\ <\ =\ i\ <\ =\ H $) が与えられます。$ S_i $ の $ j $ 文字目 ($ 1\ <\ =\ j\ <\ =\ W $) が `#` のとき、グリッドの上から $ i $ 行目で左から $ j $ 列目のマスには障害物があり、 `.` のときは障害物がありません。

照らされるマスの個数の最大値を求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ H $ $ W $ $ S_1 $ $ : $ $ S_H $

## 输出格式

照らされるマスの個数の最大値を出力せよ。

## 说明/提示

### 制約

- $ 1\ <\ =\ H\ <\ =\ 2,000 $
- $ 1\ <\ =\ W\ <\ =\ 2,000 $
- $ S_i $ は `#` と `.` のみからなる長さ $ W $ の文字列
- $ S_i $ ($ 1\ <\ =\ i\ <\ =\ H $) のうちいずれかに `.` は最低 $ 1 $ つ存在する

### Sample Explanation 1

すぬけ君が上から $ 2 $ 行目、左から $ 2 $ 列目のマスに明かりを設置すると、上から $ 2 $ 行目のうち左から $ 1 $ 〜 $ 5 $ 列目のマス、 左から $ 2 $ 列目のうち上から $ 1 $ 〜 $ 4 $ 列目のマス全てが照らされ、全部で $ 8 $ マスです。

## 样例 #1

### 输入

```
4 6

#..#..

.....#

....#.

#.#...
```

### 输出

```
8
```

## 样例 #2

### 输入

```
8 8

..#...#.

....#...

##......

..###..#

...#..#.

##....#.

#...#...

###.#..#
```

### 输出

```
13
```



---

---
title: "[ABC130D] Enough Array"
layout: "post"
diff: 普及/提高-
pid: AT_abc130_d
tag: []
---

# [ABC130D] Enough Array

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc130/tasks/abc130_d

長さ $ N $ の正整数列 $ A=a_1,a_2,…,a_{N} $ と整数 $ K $ が与えられます。$ A $ の連続する部分列であって、以下の条件を満たすようなものは何個あるでしょうか。

- (条件) 連続部分列に含まれる全ての要素の値の和は、$ K $ 以上である。

ただし、ある二つの連続部分列が列として同じでも、取り出された位置が異なるならそれらは別々に数えるものとします。

出力が $ 32bit $ 整数型に収まらない場合があることに注意してください。

## 输入格式

入力は以下の形式で標準入力から与えられます。

> $ N $ $ K $ $ a_1 $ $ a_2 $ $ ... $ $ a_N $

## 输出格式

条件を満たすような連続部分列の個数を出力してください。

## 说明/提示

### 制約

- $ 1\ \leqq\ a_i\ \leqq\ 10^5 $
- $ 1\ \leqq\ N\ \leqq\ 10^5 $
- $ 1\ \leqq\ K\ \leqq\ 10^{10} $

### Sample Explanation 1

\- $ A[1..4]=a_1,a_2,a_3,a_4 $ (要素の値の和は $ 16 $) - $ A[2..4]=a_2,a_3,a_4 $ (要素の値の和は $ 10 $) の二通りです。

### Sample Explanation 2

ある二つの連続部分列が列として同じでも、取り出された位置が異なるならそれらは別々に数えることに注意してください。

## 样例 #1

### 输入

```
4 10

6 1 2 7
```

### 输出

```
2
```

## 样例 #2

### 输入

```
3 5

3 3 3
```

### 输出

```
3
```

## 样例 #3

### 输入

```
10 53462

103 35322 232 342 21099 90000 18843 9010 35221 19352
```

### 输出

```
36
```



---

---
title: "[ABC133D] Rain Flows into Dams"
layout: "post"
diff: 普及/提高-
pid: AT_abc133_d
tag: []
---

# [ABC133D] Rain Flows into Dams

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc133/tasks/abc133_d

円形に $ N $ 個の山が連なっており、時計回りに山 $ 1 $, 山 $ 2 $, $ … $, 山 $ N $ と呼ばれます。$ N $ は**奇数**です。

これらの山の間に $ N $ 個のダムがあり、ダム $ 1 $, ダム $ 2 $, $ … $, ダム $ N $ と呼ばれます。ダム $ i $ ($ 1\ \leq\ i\ \leq\ N $) は山 $ i $ と山 $ i+1 $ の間にあります (山 $ N+1 $ は山 $ 1 $ のことを指します)。

山 $ i $ ($ 1\ \leq\ i\ \leq\ N $) に $ 2x $ リットルの雨が降ると、ダム $ i-1 $ とダム $ i $ にそれぞれ $ x $ リットルずつ水が溜まります (ダム $ 0 $ はダム $ N $ のことを指します)。

ある日、各山に非負の**偶数**リットルの雨が降りました。

その結果、ダム $ i $ ($ 1\ \leq\ i\ \leq\ N $) には合計で $ A_i $ リットルの水が溜まりました。

各山に降った雨の量を求めてください。この問題の制約下では解が一意に定まることが証明できます。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ A_1 $ $ A_2 $ $ ... $ $ A_N $

## 输出格式

山 $ 1 $, 山 $ 2 $, $ … $, 山 $ N $ に降った雨の量を表す $ N $ 個の整数をこの順に出力せよ。

## 说明/提示

### 制約

- 入力は全て整数である。
- $ 3\ \leq\ N\ \leq\ 10^5-1 $
- $ N $ は奇数である。
- $ 0\ \leq\ A_i\ \leq\ 10^9 $
- 入力が表す状況は、各山に非負の偶数リットルの雨が降った際に発生しうる。

### Sample Explanation 1

山 $ 1,\ 2,\ 3 $ に降った雨の量をそれぞれ $ 4 $ リットル, $ 0 $ リットル, $ 4 $ リットルとすると以下のように辻褄が合います。 - ダム $ 1 $ には $ \frac{4}{2}\ +\ \frac{0}{2}\ =\ 2 $ リットルの水が溜まります。 - ダム $ 2 $ には $ \frac{0}{2}\ +\ \frac{4}{2}\ =\ 2 $ リットルの水が溜まります。 - ダム $ 3 $ には $ \frac{4}{2}\ +\ \frac{4}{2}\ =\ 4 $ リットルの水が溜まります。

## 样例 #1

### 输入

```
3

2 2 4
```

### 输出

```
4 0 4
```

## 样例 #2

### 输入

```
5

3 8 7 5 5
```

### 输出

```
2 4 12 2 8
```

## 样例 #3

### 输入

```
3

1000000000 1000000000 0
```

### 输出

```
0 2000000000 0
```



---

---
title: "[ABC134D] Preparing Boxes"
layout: "post"
diff: 普及/提高-
pid: AT_abc134_d
tag: []
---

# [ABC134D] Preparing Boxes

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc134/tasks/abc134_d

$ N $ 個の空の箱が横一列に並んでいます。 左から $ i $ $ \ (1\ \leq\ i\ \leq\ N) $ 番目の箱には整数 $ i $ が書かれています。

すぬけさんは、それぞれの箱に対してボールを $ 1 $ 個入れるか何も入れないかを選ぶことができます。

ここで、以下の条件を満たすようなボールの入れ方を、いいボールの入れ方と定めます。

- $ 1 $ 以上 $ N $ 以下の任意の整数 $ i $ について、$ i $ の倍数が書かれた箱に入っているボールの個数の和を $ 2 $ で割った余りが $ a_i $ である。

いいボールの入れ方は存在するでしょうか。存在するならば $ 1 $ つ求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ a_1 $ $ a_2 $ ... $ a_N $

## 输出格式

いいボールの入れ方が存在しないなら `-1` を出力せよ。

存在するならば、そのような入れ方のうちの $ 1 $ つを以下の形式で出力せよ。

> $ M $ $ b_1 $ $ b_2 $ $ ... $ $ b_M $

ここで $ M $ はボールを入れる箱の個数を表し、$ b_1,\ b_2,\ ...,\ b_M $ はボールを入れる箱に書かれた整数を任意の順番に並べたものである。

## 说明/提示

### 制約

- 入力は全て整数である。
- $ 1\ \leq\ N\ \leq\ 2\ \times\ 10^5 $
- $ a_i $ は $ 0 $ または $ 1 $ である。

### Sample Explanation 1

$ 1 $ が書かれた箱だけにボールを入れることを考えます。 - $ 1 $ の倍数が書かれた箱は、$ 1 $ が書かれた箱、$ 2 $ が書かれた箱、$ 3 $ が書かれた箱の $ 3 $ 個です。これらの箱に入っているボールの個数の和は $ 1 $ です。 - $ 2 $ の倍数が書かれた箱は、$ 2 $ が書かれた箱の $ 1 $ 個だけです。これらの箱に入っているボールの個数の和は $ 0 $ です。 - $ 3 $ の倍数が書かれた箱は、$ 3 $ が書かれた箱の $ 1 $ 個だけです。これらの箱に入っているボールの個数の和は $ 0 $ です。 以上より、$ 1 $ が書かれた箱だけにボールを入れるのは、与えられた条件を満たすいいボールの入れ方です。

### Sample Explanation 2

ボールを $ 1 $ つも入れない入れ方が、いい入れ方になる場合もあります。

## 样例 #1

### 输入

```
3

1 0 0
```

### 输出

```
1

1
```

## 样例 #2

### 输入

```
5

0 0 0 0 0
```

### 输出

```
0
```



---

---
title: "[ABC134E] Sequence Decomposing"
layout: "post"
diff: 普及/提高-
pid: AT_abc134_e
tag: []
---

# [ABC134E] Sequence Decomposing

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc134/tasks/abc134_e

$ N $ 個の整数からなる数列 $ A\ =\ \{\ A_1,\ A_2,\ \cdots,\ A_N\ \} $ が与えられます。 $ N $ 個それぞれの整数に対して、色を $ 1 $ つ選んでその色を塗ります。 この時、以下の条件を満たす必要があります:

- $ A_i $ と $ A_j\ (i\ <\ j) $ が同じ色で塗られているならば $ A_i\ <\ A_j $ が成立する

条件を満たすように色を塗る時、用いる色の数の最小値を求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ A_1 $ $ : $ $ A_N $

## 输出格式

条件を満たすように色を塗る時、用いる色の数の最小値を出力せよ。

## 说明/提示

### 制約

- $ 1\ \leq\ N\ \leq\ 10^5 $
- $ 0\ \leq\ A_i\ \leq\ 10^9 $

### Sample Explanation 1

例えば、$ 2,\ 3 $ を赤色、$ 1,\ 4,\ 5 $ を青色で塗れば $ 2 $ 色で条件を満たす塗り方が出来ます。

### Sample Explanation 2

全ての整数を異なる色で塗るしかありません。

## 样例 #1

### 输入

```
5

2

1

4

5

3
```

### 输出

```
2
```

## 样例 #2

### 输入

```
4

0

0

0

0
```

### 输出

```
4
```



---

---
title: "[ABC135D] Digits Parade"
layout: "post"
diff: 普及/提高-
pid: AT_abc135_d
tag: []
---

# [ABC135D] Digits Parade

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc135/tasks/abc135_d

文字列 $ S $ が与えられます。$ S $ の各文字は、数字 (`0` ～ `9`) か `?` です。

`?` を数字に置き換えてできる整数のうち、$ 13 $ で割って $ 5 $ あまる数は何通りあるでしょうか？ただし、頭文字が $ 0 $ である場合も整数とみなすものとします。

答えは非常に大きくなる可能性があるため、$ 10^9+7 $ で割ったあまりを答えてください。

## 输入格式

入力は以下の形式で標準入力から与えられます。

> $ S $

## 输出格式

条件を満たす整数の個数を $ 10^9+7 $ で割ったあまりを出力してください。

## 说明/提示

### 制約

- $ S $ は数字 (`0` ～ `9`) と `?` からなる文字列。
- $ 1\ \leq\ |S|\ \leq\ 10^5 $

### Sample Explanation 1

たとえば $ 482305,\ 002865,\ 972665 $ などが条件を満たします。

### Sample Explanation 2

$ 044 $ のみが条件を満たします。

### Sample Explanation 3

条件を満たす整数を作ることが不可能な場合もあります。

## 样例 #1

### 输入

```
??2??5
```

### 输出

```
768
```

## 样例 #2

### 输入

```
?44
```

### 输出

```
1
```

## 样例 #3

### 输入

```
7?4
```

### 输出

```
0
```

## 样例 #4

### 输入

```
?6?42???8??2??06243????9??3???7258??5??7???????774????4?1??17???9?5?70???76???
```

### 输出

```
153716888
```



---

---
title: "[ABC137C] Green Bin"
layout: "post"
diff: 普及/提高-
pid: AT_abc137_c
tag: []
---

# [ABC137C] Green Bin

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc137/tasks/abc137_c

文字列 $ a $ に含まれる文字を何らかの順序で並べることで得られる文字列を $ a $ の *アナグラム* と呼びます。

例えば、`greenbin` は `beginner` のアナグラムです。このように、同じ文字が複数回現れるときはその文字をちょうどその回数だけ使わなければなりません。

$ N $ 個の文字列 $ s_1,\ s_2,\ \ldots,\ s_N $ が与えられます。それぞれの文字列は長さが $ 10 $ で英小文字からなり、またこれらの文字列はすべて異なります。二つの整数 $ i,\ j $ $ (1\ \leq\ i\ <\ j\ \leq\ N) $ の組であって、$ s_i $ が $ s_j $ のアナグラムであるようなものの個数を求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ s_1 $ $ s_2 $ $ : $ $ s_N $

## 输出格式

二つの整数 $ i,\ j $ $ (1\ \leq\ i\ <\ j\ \leq\ N) $ の組であって、$ s_i $ が $ s_j $ のアナグラムであるようなものの個数を出力せよ。

## 说明/提示

### 制約

- $ 2\ \leq\ N\ \leq\ 10^5 $
- $ s_i $ は長さ $ 10 $ の文字列である。
- $ s_i $ の各文字は英小文字である。
- $ s_1,\ s_2,\ \ldots,\ s_N $ はすべて異なる。

### Sample Explanation 1

$ s_1\ = $ `acornistnt` は $ s_3\ = $ `constraint` のアナグラムです。他に $ s_i $ が $ s_j $ のアナグラムであるような $ i,\ j $ の組はないため、答えは $ 1 $ です。

### Sample Explanation 2

$ s_i $ が $ s_j $ のアナグラムであるような $ i,\ j $ の組がないときは $ 0 $ と出力してください。

### Sample Explanation 3

ここにそのようなケースを置くことはできませんが、答えは $ 32 $ bit 整数型に収まらない可能性があるので注意してください。

## 样例 #1

### 输入

```
3

acornistnt

peanutbomb

constraint
```

### 输出

```
1
```

## 样例 #2

### 输入

```
2

oneplustwo

ninemodsix
```

### 输出

```
0
```

## 样例 #3

### 输入

```
5

abaaaaaaaa

oneplustwo

aaaaaaaaba

twoplusone

aaaabaaaaa
```

### 输出

```
4
```



---

---
title: "[ABC138D] Ki"
layout: "post"
diff: 普及/提高-
pid: AT_abc138_d
tag: []
---

# [ABC138D] Ki

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc138/tasks/abc138_d

$ 1 $ から $ N $ までの番号がついた $ N $ 個の頂点を持つ根付き木が与えられます。 この木の根は頂点 $ 1 $ で、$ i $ 番目の辺 $ (1\ \leq\ i\ \leq\ N\ -\ 1) $ は頂点 $ a_i $ と頂点 $ b_i $ を結びます。

各頂点にはカウンターが設置されており、はじめすべての頂点のカウンターの値は $ 0 $ です。

これから、以下のような $ Q $ 回の操作が行われます。

- 操作 $ j $ $ (1\ \leq\ j\ \leq\ Q) $: 頂点 $ p_j $ を根とする部分木に含まれるすべての頂点のカウンターの値に $ x_j $ を足す。

すべての操作のあとの各頂点のカウンターの値を求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ Q $ $ a_1 $ $ b_1 $ $ : $ $ a_{N-1} $ $ b_{N-1} $ $ p_1 $ $ x_1 $ $ : $ $ p_Q $ $ x_Q $

## 输出格式

すべての操作のあとの各頂点のカウンターの値を、頂点 $ 1,\ 2,\ \ldots,\ N $ の順に空白区切りで出力せよ。

## 说明/提示

### 制約

- $ 2\ \leq\ N\ \leq\ 2\ \times\ 10^5 $
- $ 1\ \leq\ Q\ \leq\ 2\ \times\ 10^5 $
- $ 1\ \leq\ a_i\ <\ b_i\ \leq\ N $
- $ 1\ \leq\ p_j\ \leq\ N $
- $ 1\ \leq\ x_j\ \leq\ 10^4 $
- 与えられるグラフは木である。
- 入力中の値はすべて整数である。

### Sample Explanation 1

この入力中の木は次のようなものです。 !\[図\](https://img.atcoder.jp/ghi/c771b2231be06af79a9994cbe6867552.png) 各操作で、頂点のカウンターの値は次のように変化します。 - 操作 $ 1 $: 頂点 $ 2 $ を根とする部分木に含まれるすべての頂点、すなわち頂点 $ 2,\ 3,\ 4 $ のカウンターの値に $ 10 $ を足す。頂点 $ 1,\ 2,\ 3,\ 4 $ のカウンターの値はそれぞれ $ 0,\ 10,\ 10,\ 10 $ となる。 - 操作 $ 2 $: 頂点 $ 1 $ を根とする部分木に含まれるすべての頂点、すなわち頂点 $ 1,\ 2,\ 3,\ 4 $ のカウンターの値に $ 100 $ を足す。頂点 $ 1,\ 2,\ 3,\ 4 $ のカウンターの値はそれぞれ $ 100,\ 110,\ 110,\ 110 $ となる。 - 操作 $ 3 $: 頂点 $ 3 $ を根とする部分木に含まれるすべての頂点、すなわち頂点 $ 3 $ のカウンターの値に $ 1 $ を足す。頂点 $ 1,\ 2,\ 3,\ 4 $ のカウンターの値はそれぞれ $ 100,\ 110,\ 111,\ 110 $ となる。

## 样例 #1

### 输入

```
4 3

1 2

2 3

2 4

2 10

1 100

3 1
```

### 输出

```
100 110 111 110
```

## 样例 #2

### 输入

```
6 2

1 2

1 3

2 4

3 6

2 5

1 10

1 10
```

### 输出

```
20 20 20 20 20 20
```



---

---
title: "[ABC140D] Face Produces Unhappiness"
layout: "post"
diff: 普及/提高-
pid: AT_abc140_d
tag: []
---

# [ABC140D] Face Produces Unhappiness

## 题目描述

有 $N$ 个人从东向西排成一排，每个人的状态用一个字符串 $S$ 表示，第i个字符 $s_i$

 表示从西边数起第 $i$ 个人的朝向```L```
表示面朝西， ```R``` 表示面朝东。

对于队伍中的每个人，如果自己面前的人的朝向和自己一样，那么这个人就会感到幸福。如果面前的人朝向和自己不一样，或者面前没有人，这个人就感到不幸福。

你可以进行以下操作最多 $K$ 次（也可以一次都不进行）：

选择整数$l,r（1≤l≤r≤N）$，让从西边数起第 $l,l+1,⋯,r$ 个人转身180度。

经过最多 $K$ 次操作后，感到幸福的人最多有多少人？

## 输入格式

第1行，2个正整数 $N,K$。

第2行，一个字符串 $S$ 。

## 输出格式

一行一个正数表示答案

## 样例 #1

### 输入

```
6 1

LRLRRL
```

### 输出

```
3
```

## 样例 #2

### 输入

```
13 3

LRRLRLRRLRLLR
```

### 输出

```
9
```

## 样例 #3

### 输入

```
10 1

LLLLLRRRRR
```

### 输出

```
9
```

## 样例 #4

### 输入

```
9 2

RRRLRLRLL
```

### 输出

```
7
```



---

---
title: "[ABC142D] Disjoint Set of Common Divisors"
layout: "post"
diff: 普及/提高-
pid: AT_abc142_d
tag: []
---

# [ABC142D] Disjoint Set of Common Divisors

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc142/tasks/abc142_d

正整数 $ A,\ B $ が与えられます。

$ A $ と $ B $ の正の公約数の中からいくつかを選びます。

ただし、選んだ整数の中のどの異なる $ 2 $ つの整数についても互いに素でなければなりません。

最大でいくつ選べるでしょうか。

 公約数とは整数 $ d $ が整数 $ x $ と整数 $ y $ の公約数であるとは、$ d $ が $ x $ と $ y $ をともに割り切ることをいいます。

 

互いに素とは整数 $ x,\ y $ が互いに素であるとは、$ x,\ y $ の正の公約数が $ 1 $ のみであることをいいます。

 

割り切るとは整数 $ x $ が整数 $ y $ を割り切るとは、$ y\ =\ \alpha\ x $ なる整数 $ \alpha $ が存在することをいいます。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ A $ $ B $

## 输出格式

条件を満たすように選べる整数の個数の最大値を出力せよ。

## 说明/提示

### 制約

- 入力は全て整数である。
- $ 1\ \leq\ A,\ B\ \leq\ 10^{12} $

### Sample Explanation 1

$ 12 $ と $ 18 $ の正の公約数は $ 1,\ 2,\ 3,\ 6 $ です。 $ 1 $ と $ 2 $、$ 2 $ と $ 3 $、$ 3 $ と $ 1 $ は互いに素なので、$ 1,\ 2,\ 3 $ を選ぶことができ、このときが最大です。

### Sample Explanation 3

$ 1 $ と $ 2019 $ の正の公約数は $ 1 $ しかありません。

## 样例 #1

### 输入

```
12 18
```

### 输出

```
3
```

## 样例 #2

### 输入

```
420 660
```

### 输出

```
4
```

## 样例 #3

### 输入

```
1 2019
```

### 输出

```
1
```



---

---
title: "[ABC144D] Water Bottle"
layout: "post"
diff: 普及/提高-
pid: AT_abc144_d
tag: []
---

# [ABC144D] Water Bottle

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc144/tasks/abc144_d

高橋君は、底面が $ 1 $ 辺 $ a~\mathrm{cm} $ の正方形であり、高さが $ b~\mathrm{cm} $ であるような直方体型の水筒を持っています。(水筒の厚みは無視できます。)

この水筒の中に体積 $ x~\mathrm{cm}^3 $ の水を入れ、底面の正方形の $ 1 $ 辺を軸として、この水筒を徐々に傾けます。

水を溢れさせずに水筒を傾けることができる最大の角度を求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ a $ $ b $ $ x $

## 输出格式

水を溢れさせずに水筒を傾けることができる最大の角度を度数法で出力せよ。 出力は、ジャッジの出力との絶対誤差または相対誤差が $ 10^{-6} $ 以下のとき正解と判定される。

## 说明/提示

### 制約

- 入力は全て整数
- $ 1\ <\ =\ a\ \leq\ 100 $
- $ 1\ <\ =\ b\ \leq\ 100 $
- $ 1\ <\ =\ x\ <\ =\ a^2b $

### Sample Explanation 1

水筒は立方体であり、水は半分まで入っています。この水筒を $ 45 $° より大きく傾けると水が溢れます。

### Sample Explanation 2

水筒はほぼ空であり、水が溢れるときにはほぼ水平になっています。

### Sample Explanation 3

水筒はほぼ満杯であり、ほぼ垂直の状態で水が溢れます。

## 样例 #1

### 输入

```
2 2 4
```

### 输出

```
45.0000000000
```

## 样例 #2

### 输入

```
12 21 10
```

### 输出

```
89.7834636934
```

## 样例 #3

### 输入

```
3 1 8
```

### 输出

```
4.2363947991
```



---

---
title: "[ABC144E] Gluttony"
layout: "post"
diff: 普及/提高-
pid: AT_abc144_e
tag: []
---

# [ABC144E] Gluttony

## 题目描述

高桥君参加大胃王比赛。比赛由 $N$ 人组成的团队为基本单位参赛，高桥君的队伍的队员从 $1\sim N$ 编号。第 $i$ 名队员的消化代价为 $A_i$。

比赛有 $N$ 种不同的食物，每位队员需要负责吃掉其中一种食物，不能有两名队员吃同一种食物，也不能让一名队员吃多与一种食物。第 $j$ 种食物的难吃程度为 $F_j$。 消化代价 $x$ 的队员吃完难吃程度 $y$ 的食物需要花费 $x\times y$ 秒。 整个队伍的成绩是 $N$ 名队员吃完食物花费时间的最大值。

比赛前，高桥君的队伍会进行修行。一次修行可以将一名消化代价大于 $0$ 的队员的消化代价减少 $1$。由于修行需要消耗庞大的食费，因此最多只能进行 $K$ 次修行。

通过修行和适当选择每位队员吃的食物，高桥队在比赛中能够获得的最好成绩是多少？

## 输入格式

第 $1$ 行，两个正整数 $N,K$。

第 $2$ 行，$N$ 个正整数 $A_1,A_2,\cdots,A_N$。

第 $3$ 行，$N$ 个正整数 $F_1,F_2,\cdots,F_N$。

## 输出格式

输出高桥队的最好成绩。

## 说明/提示

$1$ 号队员进行 $4$ 次修行，吃 $2$ 号食物，花费 $0$ 秒。

$2$ 号队员进行 $1$ 次修行，吃 $3$ 号食物，花费 $1$ 秒。

$3$ 号队员进行 $0$ 次修行，吃 $1$ 号食物，花费 $2$ 秒。

总成绩取最大值 $2$ 秒。


$1 \le N \le 2\times 10^5$

$0 \le K \le 10^{18}$

$1 \le A_i \le 10^6$

$1 \le F_i \le 10^6$

## 样例 #1

### 输入

```
3 5

4 2 1

2 3 1
```

### 输出

```
2
```

## 样例 #2

### 输入

```
3 8

4 2 1

2 3 1
```

### 输出

```
0
```

## 样例 #3

### 输入

```
11 14

3 1 4 1 5 9 2 6 5 3 5

8 9 7 9 3 2 3 8 4 6 2
```

### 输出

```
12
```



---

---
title: "[ABC145D] Knight"
layout: "post"
diff: 普及/提高-
pid: AT_abc145_d
tag: []
---

# [ABC145D] Knight

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc145/tasks/abc145_d

二次元グリッドの原点 $ (0,0) $ にチェスのナイトの駒があります。

ナイトの駒はマス $ (i,j) $ にあるとき $ (i+1,j+2) $ か $ (i+2,\ j+1) $ のどちらかのマスにのみ動かすことができます。

ナイトの駒をマス $ (X,Y) $ まで移動させる方法は何通りありますか？

$ 10^9+7 $ で割った余りを求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ X $ $ Y $

## 输出格式

ナイトの駒を $ (0,0) $ から $ (X,Y) $ まで移動させる方法の数を、$ 10^9+7 $ で割った余りを出力せよ。

## 说明/提示

### 制約

- $ 1\ \leq\ X\ \leq\ 10^6 $
- $ 1\ \leq\ Y\ \leq\ 10^6 $
- 入力中のすべての値は整数である。

### Sample Explanation 1

$ (0,0)\ \to\ (1,2)\ \to\ (3,3) $ と $ (0,0)\ \to\ (2,1)\ \to\ (3,3) $ の $ 2 $ 通りが考えられます。

### Sample Explanation 2

$ (2,2) $ にナイトの駒を移動させることはできません。

### Sample Explanation 3

方法の数を $ 10^9+7 $ で割った余りを出力してください。

## 样例 #1

### 输入

```
3 3
```

### 输出

```
2
```

## 样例 #2

### 输入

```
2 2
```

### 输出

```
0
```

## 样例 #3

### 输入

```
999999 999999
```

### 输出

```
151840682
```



---

---
title: "[ABC147C] HonestOrUnkind2"
layout: "post"
diff: 普及/提高-
pid: AT_abc147_c
tag: []
---

# [ABC147C] HonestOrUnkind2

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc147/tasks/abc147_c

$ 1 $ から $ N $ までの番号がついた $ N $ 人の人がいます。彼らはみな、必ず正しい証言を行う「正直者」か、真偽不明の証言を行う「不親切な人」のいずれかです。

人 $ i $ は $ A_i $ 個の証言を行っています。人 $ i $ の $ j $ 個目の証言は $ 2 $ つの整数 $ x_{ij} $ , $ y_{ij} $ で表され、$ y_{ij}\ =\ 1 $ のときは「人 $ x_{ij} $ は正直者である」という証言であり、$ y_{ij}\ =\ 0 $ のときは「人 $ x_{ij} $ は不親切な人である」という証言です。

この $ N $ 人の中には最大で何人の正直者が存在し得るでしょうか？

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ A_1 $ $ x_{11} $ $ y_{11} $ $ x_{12} $ $ y_{12} $ $ : $ $ x_{1A_1} $ $ y_{1A_1} $ $ A_2 $ $ x_{21} $ $ y_{21} $ $ x_{22} $ $ y_{22} $ $ : $ $ x_{2A_2} $ $ y_{2A_2} $ $ : $ $ A_N $ $ x_{N1} $ $ y_{N1} $ $ x_{N2} $ $ y_{N2} $ $ : $ $ x_{NA_N} $ $ y_{NA_N} $

## 输出格式

存在し得る正直者の最大人数を出力せよ。

## 说明/提示

### 制約

- 入力は全て整数
- $ 1\ <\ =\ N\ <\ =\ 15 $
- $ 0\ \leq\ A_i\ \leq\ N\ -\ 1 $
- $ 1\ \leq\ x_{ij}\ \leq\ N $
- $ x_{ij}\ \neq\ i $
- $ x_{ij_1}\ \neq\ x_{ij_2}\ (j_1\ \neq\ j_2) $
- $ y_{ij}\ =\ 0,\ 1 $

### Sample Explanation 1

人 $ 1 $ と人 $ 2 $ が正直者であり、人 $ 3 $ が不親切な人であると仮定すると、正直者は $ 2 $ 人であり、矛盾が生じません。これが存在し得る正直者の最大人数です。

### Sample Explanation 2

$ 1 $ 人でも正直者が存在すると仮定すると、直ちに矛盾します。

## 样例 #1

### 输入

```
3

1

2 1

1

1 1

1

2 0
```

### 输出

```
2
```

## 样例 #2

### 输入

```
3

2

2 1

3 0

2

3 1

1 0

2

1 1

2 0
```

### 输出

```
0
```

## 样例 #3

### 输入

```
2

1

2 0

1

1 0
```

### 输出

```
1
```



---

---
title: "[ABC147D] Xor Sum 4"
layout: "post"
diff: 普及/提高-
pid: AT_abc147_d
tag: []
---

# [ABC147D] Xor Sum 4

## 题目描述

给出 $n$ 个整数 $a_i$，请求出 $\sum_{i=1}^{n-1}\sum_{j=i+1}^{n}(a_i \operatorname{xor}a_j)$ 对 $10^9 + 7$ 取模的值。

## 输入格式

第一行为一个正整数 $n$。

第二行有 $n$ 个整数 $a_i$。

## 输出格式

输出 $\sum_{i=1}^{n-1}\sum_{j=i+1}^{n}(a_i \operatorname{xor}a_j)$ 对 $10^9 + 7$ 取模的值。

## 说明/提示

$2 \le n \le 3 \times 10 ^ 5, 0 \le a_i \le 2^{60}$。

## 样例 #1

### 输入

```
3

1 2 3
```

### 输出

```
6
```

## 样例 #2

### 输入

```
10

3 1 4 1 5 9 2 6 5 3
```

### 输出

```
237
```

## 样例 #3

### 输入

```
10

3 14 159 2653 58979 323846 2643383 27950288 419716939 9375105820
```

### 输出

```
103715602
```



---

---
title: "[ABC147E] Balanced Path"
layout: "post"
diff: 普及/提高-
pid: AT_abc147_e
tag: []
---

# [ABC147E] Balanced Path

## 题目描述

高桥君有一个 $H$ 行 $W$ 列的棋盘，第 $i$ 行 $j$ 列记为 ( $i$ , $j$ ),每个格子里有两个整数， $a_{i,j}$ 和 $b_{i,j}$。

高桥君从( 1,1 )出发要走到( $H$ , $W$ )。每一次只能向左或向下走一格，每一次走过的方格，高桥君会把它上面的数一个染成红色，一个染成蓝色，求做过路径中红色数字的总和减蓝色数字总和的绝对值的最小值。

## 输入格式

第一行两个整数 $H$ , $W$ 。

从2到 $H + 1$ 行每行 $W$ 个整数 ,第 $i$ 个是 $A_{i,j}$。

从 $H+2$ 到 $2H+1$ 行每行 $W$ 个整数，第 $i$ 个是 $B_{i,j}$。

## 输出格式

一行一个整数表示答案

## 样例 #1

### 输入

```
2 2

1 2

3 4

3 4

2 1
```

### 输出

```
0
```

## 样例 #2

### 输入

```
2 3

1 10 80

80 10 1

1 2 3

4 5 6
```

### 输出

```
2
```



---

---
title: "[ABC148E] Double Factorial"
layout: "post"
diff: 普及/提高-
pid: AT_abc148_e
tag: []
---

# [ABC148E] Double Factorial

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc148/tasks/abc148_e

$ 0 $ 以上の整数 $ n $ に対し、 $ f(n) $ を次のように定義します。

- $ f(n)\ =\ 1 $ ($ n\ <\ 2 $ のとき)
- $ f(n)\ =\ n\ f(n-2) $ ($ n\ >\ =\ 2 $ のとき)

整数 $ N $ が与えられます。$ f(N) $ を $ 10 $ 進法で表記した時に末尾に何個の $ 0 $ が続くかを求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $

## 输出格式

$ f(N) $ を $ 10 $ 進法で表記した時の末尾の $ 0 $ の個数を出力せよ。

## 说明/提示

### 制約

- $ 0\ <\ =\ N\ <\ =\ 10^{18} $

### Sample Explanation 1

$ f(12)\ =\ 12\ ×\ 10\ ×\ 8\ ×\ 6\ ×\ 4\ ×\ 2\ =\ 46080 $ なので、末尾の $ 0 $ の個数は $ 1 $ 個です。

### Sample Explanation 2

$ f(5)\ =\ 5\ ×\ 3\ ×\ 1\ =\ 15 $ なので、末尾の $ 0 $ の個数は $ 0 $ 個です。

## 样例 #1

### 输入

```
12
```

### 输出

```
1
```

## 样例 #2

### 输入

```
5
```

### 输出

```
0
```

## 样例 #3

### 输入

```
1000000000000000000
```

### 输出

```
124999999999999995
```



---

---
title: "[ABC149D] Prediction and Restriction"
layout: "post"
diff: 普及/提高-
pid: AT_abc149_d
tag: []
---

# [ABC149D] Prediction and Restriction

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc149/tasks/abc149_d

高橋君は、ゲームセンターで「じゃんけんバトル」というゲームをプレイすることにしました。このゲームのルールは以下の通りです。

- プレイヤーは筐体と $ N $ 回じゃんけんを行う (あいこの場合も $ 1 $ 回のジャンケンと数える)。
- プレイヤーがじゃんけんで勝った場合、プレイヤーは出した手に応じて以下のスコアを得る (あいこや負けは $ 0 $ 点)。
  - グーで勝った場合、 $ R $ 点
  - チョキで勝った場合、 $ S $ 点
  - パーで勝った場合、 $ P $ 点
- ただし、ちょうど $ K $ 回前のじゃんけんで出した手と同じ手を出すことはできない。( $ K $ 回目までのじゃんけんでは好きな手を出せる。)

筐体は、各回のジャンケンで出す手をゲーム開始前に決定します。能力者である高橋君は、ゲーム開始前にこれをすべて読み取りました。

高橋君が読み取った情報は文字列 $ T $ として与えられます。$ T $ の $ i(1\ \leq\ i\ \leq\ N) $ 文字目が `r` のときは $ i $ 回目のじゃんけんで筐体がグーを出すことを、`s` のときはチョキを出すことを、`p` のときはパーを出すことを表します。

高橋君が $ N $ 回のじゃんけんで出す手を最適に選んだとき、ゲーム終了までに最大で合計何点を得られるでしょうか。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ K $ $ R $ $ S $ $ P $ $ T $

## 输出格式

得られる最大の合計スコアを出力せよ。

## 说明/提示

### 制約

- $ 2\ \leq\ N\ \leq\ 10^5 $
- $ 1\ \leq\ K\ \leq\ N-1 $
- $ 1\ \leq\ R,S,P\ \leq\ 10^4 $
- $ N,K,R,S,P $ は全て整数である。
- $ |T|\ =\ N $
- $ T $ に含まれる文字は `r` , `s` , `p` のいずれかである。

### Sample Explanation 1

筐体は、{グー、チョキ、グー、パー、グー} と手を出します。 これに対して、例えば {パー、グー、グー、チョキ、パー} と出せば、$ 27 $ 点を獲得できます。 これより大きい点は獲得できないので、$ 27 $ を出力します。

## 样例 #1

### 输入

```
5 2

8 7 6

rsrpr
```

### 输出

```
27
```

## 样例 #2

### 输入

```
7 1

100 10 1

ssssppr
```

### 输出

```
211
```

## 样例 #3

### 输入

```
30 5

325 234 123

rspsspspsrpspsppprpsprpssprpsr
```

### 输出

```
4996
```



---

---
title: "[ABC152D] Handstand 2"
layout: "post"
diff: 普及/提高-
pid: AT_abc152_d
tag: []
---

# [ABC152D] Handstand 2

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc152/tasks/abc152_d

正の整数 $ N $ が与えられます。  
 $ N $ 以下の正の整数の組 $ (A,B) $ であって、次の条件を満たすものの個数を求めてください。

- $ A,B $ を先頭に $ 0 $ のつかない $ 10 $ 進数表記で表したときに、 $ A $ の末尾の桁が $ B $ の先頭の桁に等しく、 $ A $ の先頭の桁が $ B $ の末尾の桁に等しい

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $

## 输出格式

答えを出力せよ。

## 说明/提示

### 制約

- $ 1\ \leq\ N\ \leq\ 2\ \times\ 10^5 $
- 入力はすべて整数である。

### Sample Explanation 1

条件を満たす正の整数の組 $ (A,B) $ は、 $ (1,1) $, $ (1,11) $, $ (2,2) $, $ (2,22) $, $ (3,3) $, $ (4,4) $, $ (5,5) $, $ (6,6) $, $ (7,7) $, $ (8,8) $, $ (9,9) $, $ (11,1) $, $ (11,11) $, $ (12,21) $, $ (21,12) $, $ (22,2) $, $ (22,22) $ の $ 17 $ 個あります。

## 样例 #1

### 输入

```
25
```

### 输出

```
17
```

## 样例 #2

### 输入

```
1
```

### 输出

```
1
```

## 样例 #3

### 输入

```
100
```

### 输出

```
108
```

## 样例 #4

### 输入

```
2020
```

### 输出

```
40812
```

## 样例 #5

### 输入

```
200000
```

### 输出

```
400000008
```



---

---
title: "[ABC153E] Crested Ibis vs Monster"
layout: "post"
diff: 普及/提高-
pid: AT_abc153_e
tag: []
---

# [ABC153E] Crested Ibis vs Monster

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc153/tasks/abc153_e

トキはモンスターと戦っています。

モンスターの体力は $ H $ です。

トキは $ N $ 種類の魔法が使え、$ i $ 番目の魔法を使うと、モンスターの体力を $ A_i $ 減らすことができますが、トキの魔力を $ B_i $ 消耗します。

同じ魔法は何度でも使うことができます。魔法以外の方法でモンスターの体力を減らすことはできません。

モンスターの体力を $ 0 $ 以下にすればトキの勝ちです。

トキがモンスターに勝つまでに消耗する魔力の合計の最小値を求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ H $ $ N $ $ A_1 $ $ B_1 $ $ : $ $ A_N $ $ B_N $

## 输出格式

トキがモンスターに勝つまでに消耗する魔力の最小値を出力せよ。

## 说明/提示

### 制約

- $ 1\ \leq\ H\ \leq\ 10^4 $
- $ 1\ \leq\ N\ \leq\ 10^3 $
- $ 1\ \leq\ A_i\ \leq\ 10^4 $
- $ 1\ \leq\ B_i\ \leq\ 10^4 $
- 入力中のすべての値は整数である。

### Sample Explanation 1

最初に $ 1 $ 番目の魔法を使い、トキの魔力を $ 3 $ 消耗して、モンスターの体力を $ 8 $ 減らします。モンスターの体力は $ 1 $ になります。 次に $ 3 $ 番目の魔法を使い、トキの魔力を $ 1 $ 消耗して、モンスターの体力を $ 2 $ 減らします。モンスターの体力は $ -1 $ になります。 これにより、トキが消耗した魔力の合計は $ 4 $ になります。

### Sample Explanation 2

$ 1 $ 番目の魔法を $ 100 $ 回使うのが最適です。

## 样例 #1

### 输入

```
9 3

8 3

4 2

2 1
```

### 输出

```
4
```

## 样例 #2

### 输入

```
100 6

1 1

2 3

3 9

4 27

5 81

6 243
```

### 输出

```
100
```

## 样例 #3

### 输入

```
9999 10

540 7550

691 9680

700 9790

510 7150

415 5818

551 7712

587 8227

619 8671

588 8228

176 2461
```

### 输出

```
139815
```



---

---
title: "[ABC156D] Bouquet"
layout: "post"
diff: 普及/提高-
pid: AT_abc156_d
tag: []
---

# [ABC156D] Bouquet

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc156/tasks/abc156_d

あかりさんは $ n $ 種類の花を $ 1 $ 本ずつ持っています。

あかりさんは、これらの花から $ 1 $ 本以上を選び、花束を作ろうとしています。

ただし、あかりさんは $ a $ と $ b $ の $ 2 $ つの数を苦手としていて、いずれかと一致するような本数の花からなる花束は作ることができません。

あかりさんが作ることのできる花束は何種類あるでしょうか。

$ (10^9\ +\ 7) $ で割った余りを求めてください。

ここで $ 2 $ つの花束は、一方では使われているが、 もう一方では使われていない種類の花があるとき、別の種類の花束であるとみなします。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ n $ $ a $ $ b $

## 输出格式

あかりさんが作ることのできる花束の種類数を $ (10^9\ +\ 7) $ で割った余りを出力せよ。(そのような花束がないときは `0` と出力せよ。)

## 说明/提示

### 制約

- 入力は全て整数である。
- $ 2\ \leq\ n\ \leq\ 10^9 $
- $ 1\ \leq\ a\ <\ b\ \leq\ \textrm{min}(n,\ 2\ \times\ 10^5) $

### Sample Explanation 1

この場合、あかりさんは $ 2 $ 本または $ 4 $ 本の花を選んで花束を作ることができます。 $ 4 $ 本ある花の中から $ 2 $ 本を選ぶ方法は $ 6 $ 通り、$ 4 $ 本を選ぶ方法は $ 1 $ 通りあるので、 あかりさんが作ることができる花束の種類数は合わせて $ 7 $ 通りです。

### Sample Explanation 2

$ (10^9\ +\ 7) $ で割った余りを出力してください。

## 样例 #1

### 输入

```
4 1 3
```

### 输出

```
7
```

## 样例 #2

### 输入

```
1000000000 141421 173205
```

### 输出

```
34076506
```



---

---
title: "[ABC157D] Friend Suggestions"
layout: "post"
diff: 普及/提高-
pid: AT_abc157_d
tag: []
---

# [ABC157D] Friend Suggestions

## 题目描述

### 题目大意

某平台上有 $N$ 名用户，其中，有 $M$ 对用户是互相关注的，有 $K$ 对用户是互相拉黑的。

当用户 $i$ 和用户 $j$ 满足以下条件时，用户 $j$ 就是用户 $i$ 的“推荐用户”：

+ 用户 $i$ 可以与 用户 $j$ 通过若干对用户的互相关注关系连接起来。（比如用户 1 与用户 2，用户 2 与用户 3 都互相关注，则用户 1 和 用户 3 就可以通过他们的关系连接起来）
+ 用户 $i$ 与用户 $j$ 没有互相关注或互相拉黑。

求每位用户的“推荐用户”的数量。

数据保证不会存在一对用户既互相关注又互相拉黑。

## 输入格式

第一行输入三个正整数 $N,M,K$；

接下来 $M$ 行，每行两个正整数 $A_i,B_i$，表示一对互相关注的用户；

再接下来 $K$ 行，每行两个正整数 $C_i,D_i$，表示一对互相拉黑的用户。

## 输出格式

输出用空格隔开的 $N$ 个整数，第 $i$ 个数表示用户 $i$ 的“推荐用户”的数量。

## 说明/提示

$2 \le N \le 10^5, 0 \le M,K \le 10^5$。

翻译 by @CarroT1212

## 样例 #1

### 输入

```
4 4 1

2 1

1 3

3 2

3 4

4 1
```

### 输出

```
0 1 0 1
```

## 样例 #2

### 输入

```
5 10 0

1 2

1 3

1 4

1 5

3 2

2 4

2 5

4 3

5 3

4 5
```

### 输出

```
0 0 0 0 0
```

## 样例 #3

### 输入

```
10 9 3

10 1

6 7

8 2

2 5

8 4

7 3

10 9

6 4

5 8

2 6

7 5

3 1
```

### 输出

```
1 3 5 4 3 3 3 3 1 0
```



---

---
title: "[ABC158D] String Formation"
layout: "post"
diff: 普及/提高-
pid: AT_abc158_d
tag: []
---

# [ABC158D] String Formation

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc158/tasks/abc158_d

高橋君は、英小文字から成る文字列 $ S $ を持っています。

この $ S $ から始めて、ある与えられた手順に従って文字列を作ることにしました。

手順は $ Q $ 回の操作から成ります。操作 $ i(1\ \leq\ i\ \leq\ Q) $ では、まず整数 $ T_i $ が与えられます。

- $ T_i\ =\ 1 $ のとき : 文字列 $ S $ の前後を反転する。
- $ T_i\ =\ 2 $ のとき : 追加で整数 $ F_i $ と英小文字 $ C_i $ が与えられる。
  
  
  - $ F_i\ =\ 1 $ のとき : 文字列 $ S $ の先頭に $ C_i $ を追加する。
  - $ F_i\ =\ 2 $ のとき : 文字列 $ S $ の末尾に $ C_i $ を追加する。

高橋君のために、手順の後に最終的にできる文字列を求めてあげてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ S $ $ Q $ $ Query_1 $ $ : $ $ Query_Q $

$ 3 $ 行目から $ Q\ +\ 2 $ 行目の $ Query_i $ は、以下の $ 2 $ つのいずれかである。

> $ 1 $

$ T_i\ =\ 1 $ として操作を行うことを表す。

> $ 2 $ $ F_i $ $ C_i $

$ T_i\ =\ 2 $ として操作を行うことを表す。

## 输出格式

手順の後に最終的にできる文字列を出力せよ。

## 说明/提示

### 制約

- $ 1\ \leq\ |S|\ \leq\ 10^5 $
- $ S $ は英小文字から成る
- $ 1\ \leq\ Q\ \leq\ 2\ \times\ 10^5 $
- $ T_i\ =\ 1 $ または $ 2 $
- $ F_i\ =\ 1 $ または $ 2 $
- $ C_i $ は英小文字である

### Sample Explanation 1

$ Q\ =\ 4 $ 回の操作を行います。初め $ S $ は `a` です。 - 操作 $ 1 $ : $ S $ の先頭に `p` を追加する。$ S $ は `pa` となる。 - 操作 $ 2 $ : $ S $ の前後を反転する。$ S $ は `ap` となる。 - 操作 $ 3 $ : $ S $ の末尾に `c` を追加する。$ S $ は `apc` となる。 - 操作 $ 4 $ : $ S $ の前後を反転する。$ S $ は `cpa` となる。 よって最終的にできる文字列は `cpa` となります。

### Sample Explanation 2

$ Q\ =\ 6 $ 回の操作を行います。初め $ S $ は `a` です。 - 操作 $ 1 $ : $ S $ は `aa` となる。 - 操作 $ 2 $ : $ S $ は `baa` となる。 - 操作 $ 3 $ : $ S $ は `aab` となる。 - 操作 $ 4 $ : $ S $ は `aabc` となる。 - 操作 $ 5 $ : $ S $ は `cbaa` となる。 - 操作 $ 6 $ : $ S $ は `aabc` となる。 よって最終的にできる文字列は `aabc` となります。

## 样例 #1

### 输入

```
a

4

2 1 p

1

2 2 c

1
```

### 输出

```
cpa
```

## 样例 #2

### 输入

```
a

6

2 2 a

2 1 b

1

2 2 c

1

1
```

### 输出

```
aabc
```

## 样例 #3

### 输入

```
y

1

2 1 x
```

### 输出

```
xy
```



---

---
title: "[ABC161D] Lunlun Number"
layout: "post"
diff: 普及/提高-
pid: AT_abc161_d
tag: []
---

# [ABC161D] Lunlun Number

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc161/tasks/abc161_d

正の整数 $ X $ が以下の条件を満たすとき、 $ X $ はルンルン数であると言います。

- $ X $ を(leading zeroなしで)十進数表記した際に、隣り合うどの $ 2 $ つの桁の値についても、差の絶対値が $ 1 $ 以下

例えば、 $ 1234 $ , $ 1 $ , $ 334 $ などはルンルン数ですが、 $ 31415 $ , $ 119 $ , $ 13579 $ などはルンルン数ではありません。

正の整数 $ K $ が与えられます。小さい方から $ K $ 番目のルンルン数を求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ K $

## 输出格式

答えを出力せよ。

## 说明/提示

### 制約

- $ 1\ \leq\ K\ \leq\ 10^5 $
- 入力はすべて整数である。

### Sample Explanation 1

小さい方から $ 15 $ 番目までのルンルン数を順に並べると、 $ 1 $, $ 2 $, $ 3 $, $ 4 $, $ 5 $, $ 6 $, $ 7 $, $ 8 $, $ 9 $, $ 10 $, $ 11 $, $ 12 $, $ 21 $, $ 22 $, $ 23 $ ですので、答えは $ 23 $ です。

### Sample Explanation 4

答えが $ 32 $ ビット符号付き整数の範囲に収まらない可能性があるので注意してください。

## 样例 #1

### 输入

```
15
```

### 输出

```
23
```

## 样例 #2

### 输入

```
1
```

### 输出

```
1
```

## 样例 #3

### 输入

```
13
```

### 输出

```
21
```

## 样例 #4

### 输入

```
100000
```

### 输出

```
3234566667
```



---

---
title: "[ABC161E] Yutori"
layout: "post"
diff: 普及/提高-
pid: AT_abc161_e
tag: []
---

# [ABC161E] Yutori

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc161/tasks/abc161_e

高橋君は明日からの $ N $ 日間のうち $ K $ 日を選んで働くことにしました。

整数 $ C $ と文字列 $ S $ が与えられるので、次の $ 2 $ つの条件を満たすようにして働く日を選びます。

- ある日働いたら、その直後の $ C $ 日間は働かない
- $ S $ の $ i $ 文字目が `x` のとき、今日から $ i $ 日後には働かない

高橋君が必ず働く日をすべて求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ K $ $ C $ $ S $

## 输出格式

高橋君が必ず働く日を昇順に改行区切りですべて出力せよ。

## 说明/提示

### 制約

- $ 1\ \leq\ N\ \leq\ 2\ \times\ 10^5 $
- $ 1\ \leq\ K\ \leq\ N $
- $ 0\ \leq\ C\ \leq\ N $
- $ S $ の長さは $ N $
- $ S $ の各文字は `o` か `x`
- 問題文中の条件を満たすように働く日を選ぶことが可能

### Sample Explanation 1

高橋君は $ 11 $ 日間のうち $ 3 $ 日働こうとしています。ある日働いたらその後 $ 2 $ 日間は働きません。 働く日としてありえる組み合わせは「$ 1,6,10 $ 日目」「$ 1,6,11 $ 日目」「$ 2,6,10 $ 日目」「$ 2,6,11 $ 日目」の $ 4 $ 通りです。 したがって、$ 6 $ 日目に必ず働きます。

### Sample Explanation 2

働く日としてありえる組み合わせは「$ 1,5 $ 日目」のみです。

### Sample Explanation 3

必ず働く日が存在しないこともあります。

## 样例 #1

### 输入

```
11 3 2

ooxxxoxxxoo
```

### 输出

```
6
```

## 样例 #2

### 输入

```
5 2 3

ooxoo
```

### 输出

```
1

5
```

## 样例 #3

### 输入

```
5 1 0

ooooo
```

### 输出

```

```

## 样例 #4

### 输入

```
16 4 3

ooxxoxoxxxoxoxxo
```

### 输出

```
11

16
```



---

---
title: "[ABC162D] RGB Triplets"
layout: "post"
diff: 普及/提高-
pid: AT_abc162_d
tag: []
---

# [ABC162D] RGB Triplets

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc162/tasks/abc162_d

`R`, `G`, `B` のみからなる、長さ $ N $ の文字列 $ S $ があります。

以下の $ 2 $ つの条件をともに満たす組 $ (i,~j,~k)~(1\ \leq\ i\ <\ j\ <\ k\ \leq\ N) $ の数を求めてください。

- $ S_i\ \neq\ S_j $ かつ $ S_i\ \neq\ S_k $ かつ $ S_j\ \neq\ S_k $ である
- $ j\ -\ i\ \neq\ k\ -\ j $ である

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ S $

## 输出格式

題意を満たす組の数を出力せよ。

## 说明/提示

### 制約

- $ 1\ \leq\ N\ \leq\ 4000 $
- $ S $ は `R`, `G`, `B` のみからなる、長さ $ N $ の文字列である

### Sample Explanation 1

組 $ (1,~3,~4) $ だけが $ 2 $ つの条件をともに満たします。組 $ (2,~3,~4) $ は、$ 1 $ つ目の条件は満たしますが $ 2 $ つ目の条件を満たさないので不適です。

## 样例 #1

### 输入

```
4

RRGB
```

### 输出

```
1
```

## 样例 #2

### 输入

```
39

RBRBGRBGGBBRRGBBRRRBGGBRBGBRBGBRBBBGBBB
```

### 输出

```
1800
```



---

---
title: "[ABC162F] Select Half"
layout: "post"
diff: 普及/提高-
pid: AT_abc162_f
tag: []
---

# [ABC162F] Select Half

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc162/tasks/abc162_f

長さ $ N $ の整数列 $ A_1,...,A_N $ が与えられます。

この中からちょうど $ \left\lfloor\ \frac{N}{2}\ \right\rfloor $ 個の整数を、どの $ 2 $ 箇所も連続しないように選びます。

選んだ要素の和としてありえる最大値を求めてください。

ここで、$ \lfloor\ x\ \rfloor $ は、$ x $ を超えない最大の整数を表します。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ A_1 $ $ ... $ $ A_N $

## 输出格式

選ばれた要素の和としてありえる最大値を出力せよ。

## 说明/提示

### 制約

- $ 2\ \leq\ N\ \leq\ 2\times\ 10^5 $
- $ |A_i|\leq\ 10^9 $
- 入力は全て整数

### Sample Explanation 1

$ 2,4,6 $ を選ぶと和は $ 12 $ となり、これが最大です。

### Sample Explanation 2

$ -10,10 $ を選ぶと和は $ 0 $ となり、これが最大です。

### Sample Explanation 3

オーバーフローに注意してください。

## 样例 #1

### 输入

```
6

1 2 3 4 5 6
```

### 输出

```
12
```

## 样例 #2

### 输入

```
5

-1000 -100 -10 0 10
```

### 输出

```
0
```

## 样例 #3

### 输入

```
10

1000000000 1000000000 1000000000 1000000000 1000000000 1000000000 1000000000 1000000000 1000000000 1000000000
```

### 输出

```
5000000000
```

## 样例 #4

### 输入

```
27

18 -28 18 28 -45 90 -45 23 -53 60 28 -74 -71 35 -26 -62 49 -77 57 24 -70 -93 69 -99 59 57 -49
```

### 输出

```
295
```



---

---
title: "[ABC163D] Sum of Large Numbers"
layout: "post"
diff: 普及/提高-
pid: AT_abc163_d
tag: []
---

# [ABC163D] Sum of Large Numbers

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc163/tasks/abc163_d

$ 10^{100} $, $ 10^{100}+1 $, ..., $ 10^{100}+N $ の $ N+1 $ 個の数があります。

この中から $ K $ 個以上の数を選ぶとき、その和としてあり得るものの個数を $ \bmod\ (10^9+7) $ で求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ K $

## 输出格式

和としてあり得るものの個数を $ \bmod\ (10^9+7) $ で出力せよ。

## 说明/提示

### 制約

- $ 1\ \leq\ N\ \leq\ 2\times\ 10^5 $
- $ 1\ \leq\ K\ \leq\ N+1 $
- 入力は全て整数

### Sample Explanation 1

以下の $ 10 $ 通りが考えられます。 - $ (10^{100})+(10^{100}+1)=2\times\ 10^{100}+1 $ - $ (10^{100})+(10^{100}+2)=2\times\ 10^{100}+2 $ - $ (10^{100})+(10^{100}+3)=(10^{100}+1)+(10^{100}+2)=2\times\ 10^{100}+3 $ - $ (10^{100}+1)+(10^{100}+3)=2\times\ 10^{100}+4 $ - $ (10^{100}+2)+(10^{100}+3)=2\times\ 10^{100}+5 $ - $ (10^{100})+(10^{100}+1)+(10^{100}+2)=3\times\ 10^{100}+3 $ - $ (10^{100})+(10^{100}+1)+(10^{100}+3)=3\times\ 10^{100}+4 $ - $ (10^{100})+(10^{100}+2)+(10^{100}+3)=3\times\ 10^{100}+5 $ - $ (10^{100}+1)+(10^{100}+2)+(10^{100}+3)=3\times\ 10^{100}+6 $ - $ (10^{100})+(10^{100}+1)+(10^{100}+2)+(10^{100}+3)=4\times\ 10^{100}+6 $

### Sample Explanation 2

全てを選ぶしかないので $ 1 $ 通りです。

## 样例 #1

### 输入

```
3 2
```

### 输出

```
10
```

## 样例 #2

### 输入

```
200000 200001
```

### 输出

```
1
```

## 样例 #3

### 输入

```
141421 35623
```

### 输出

```
220280457
```



---

---
title: "[ABC164D] Multiple of 2019"
layout: "post"
diff: 普及/提高-
pid: AT_abc164_d
tag: []
---

# [ABC164D] Multiple of 2019

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc164/tasks/abc164_d

`1` から `9` までの数字のみからなる文字列 $ S $ が与えられます。

次のような条件を満たす整数の組 $ (i,j) $ ($ 1\ <\ =\ i\ <\ =\ j\ <\ =\ |S| $) の総数を求めてください。

条件: $ S $ の $ i $ 文字目から $ j $ 文字目までを $ 10 $ 進法の整数としてみると、この整数は $ 2019 $ の倍数である。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ S $

## 输出格式

条件を満たす整数の組 $ (i,j) $ ($ 1\ <\ =\ i\ <\ =\ j\ <\ =\ |S| $) の総数を出力せよ。

## 说明/提示

### 制約

- $ 1\ <\ =\ |S|\ <\ =\ 200000 $
- $ S $ は `1` から `9` までの数字のみからなる文字列

### Sample Explanation 1

条件を満たすのは $ (1,5),\ (5,9),\ (9,13) $ の $ 3 $ 個です。

### Sample Explanation 3

条件を満たす整数の組は存在しません。

## 样例 #1

### 输入

```
1817181712114
```

### 输出

```
3
```

## 样例 #2

### 输入

```
14282668646
```

### 输出

```
2
```

## 样例 #3

### 输入

```
2119
```

### 输出

```
0
```



---

---
title: "[ABC165C] Many Requirements"
layout: "post"
diff: 普及/提高-
pid: AT_abc165_c
tag: []
---

# [ABC165C] Many Requirements

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc165/tasks/abc165_c

正整数 $ N $ , $ M $ , $ Q $ と、$ 4 $ つの整数の組 ( $ a_i $ , $ b_i $ , $ c_i $ , $ d_i $ ) $ Q $ 組が与えられます。

以下の条件を満たす数列 $ A $ を考えます。

- $ A $ は、長さ $ N $ の正整数列である。
- $ 1\ \leq\ A_1\ \leq\ A_2\ \le\ \cdots\ \leq\ A_N\ \leq\ M $

この数列の得点を、以下のように定めます。

- $ A_{b_i}\ -\ A_{a_i}\ =\ c_i $ を満たすような $ i $ についての、 $ d_i $ の総和 (そのような $ i $ が存在しないときは $ 0 $)

$ A $ の得点の最大値を求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ M $ $ Q $ $ a_1 $ $ b_1 $ $ c_1 $ $ d_1 $ $ : $ $ a_Q $ $ b_Q $ $ c_Q $ $ d_Q $

## 输出格式

$ A $ の得点の最大値を出力せよ。

## 说明/提示

### 制約

- 入力は全て整数
- $ 2\ <\ =\ N\ <\ =\ 10 $
- $ 1\ \leq\ M\ \leq\ 10 $
- $ 1\ \leq\ Q\ \leq\ 50 $
- $ 1\ \leq\ a_i\ <\ b_i\ \leq\ N $ ( $ i\ =\ 1,\ 2,\ ...,\ Q $ )
- $ 0\ \leq\ c_i\ \leq\ M\ -\ 1 $ ( $ i\ =\ 1,\ 2,\ ...,\ Q $ )
- $ (a_i,\ b_i,\ c_i)\ \neq\ (a_j,\ b_j,\ c_j) $ ( $ i\ \neq\ j $ のとき)
- $ 1\ \leq\ d_i\ \leq\ 10^5 $ ( $ i\ =\ 1,\ 2,\ ...,\ Q $ )

### Sample Explanation 1

$ A\ =\ \{1,\ 3,\ 4\} $ のとき、この数列の得点は $ 110 $ となります。この条件の下では $ 110 $ より高い得点を持つ数列は存在しませんから、答えは $ 110 $ です。

## 样例 #1

### 输入

```
3 4 3

1 3 3 100

1 2 2 10

2 3 2 10
```

### 输出

```
110
```

## 样例 #2

### 输入

```
4 6 10

2 4 1 86568

1 4 0 90629

2 3 0 90310

3 4 1 29211

3 4 3 78537

3 4 2 8580

1 2 1 96263

1 4 2 2156

1 2 0 94325

1 4 3 94328
```

### 输出

```
357500
```

## 样例 #3

### 输入

```
10 10 1

1 10 9 1
```

### 输出

```
1
```



---

---
title: "[ABC166E] This Message Will Self-Destruct in 5s"
layout: "post"
diff: 普及/提高-
pid: AT_abc166_e
tag: []
---

# [ABC166E] This Message Will Self-Destruct in 5s

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc166/tasks/abc166_e

AtCoder 王国の優秀なエージェントであるあなたは、盗まれた極秘情報が AlDebaran 王国の手に渡ることを阻止するため、取引現場であるパーティに潜入しました。

パーティには $ N $ 人の参加者がおり、それぞれ $ 1 $ から $ N $ までの番号がついています。参加者 $ i $ の身長は $ A_i $ です。

あなたは事前の尋問によって、極秘情報を取引するのは以下の条件を満たす $ 2 $ 人組であることを知っています。

- $ 2 $ 人の持つ番号の差の絶対値が、$ 2 $ 人の身長の和に等しい。

$ N $ 人の参加者のうちから $ 2 $ 人を選んでペアにする方法は $ \frac{N(N-1)}{2} $ 通りありますが、このうち上の条件を満たすペアは何通りあるでしょう？

なお、極秘情報の内容が何であるかはあなたの知るところではありません。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ A_1 $ $ A_2 $ $ \dots $ $ A_N $

## 输出格式

条件を満たすペアの個数を出力せよ。

## 说明/提示

### 制約

- 入力はすべて整数
- $ 2\ \leq\ N\ \leq\ 2\ \times\ 10^5 $
- $ 1\ \leq\ A_i\ \leq\ 10^9\ (1\ \leq\ i\ \leq\ N) $

### Sample Explanation 1

\- $ A_1\ +\ A_4\ =\ 3 $ なので、参加者 $ 1,\ 4 $ のペアは条件を満たします。 - $ A_2\ +\ A_6\ =\ 4 $ なので、参加者 $ 2,\ 6 $ のペアは条件を満たします。 - $ A_4\ +\ A_6\ =\ 2 $ なので、参加者 $ 4,\ 6 $ のペアは条件を満たします。 その他に作れるペアはいずれも条件を満たさないので、$ 3 $ を出力します。

### Sample Explanation 2

条件を満たすペアが存在しないので、$ 0 $ を出力します。

## 样例 #1

### 输入

```
6

2 3 3 1 3 1
```

### 输出

```
3
```

## 样例 #2

### 输入

```
6

5 2 4 2 8 8
```

### 输出

```
0
```

## 样例 #3

### 输入

```
32

3 1 4 1 5 9 2 6 5 3 5 8 9 7 9 3 2 3 8 4 6 2 6 4 3 3 8 3 2 7 9 5
```

### 输出

```
22
```



---

---
title: "[ABC167D] Teleporter"
layout: "post"
diff: 普及/提高-
pid: AT_abc167_d
tag: []
---

# [ABC167D] Teleporter

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc167/tasks/abc167_d

高橋王国には $ N $ 個の町があります。町は $ 1 $ から $ N $ まで番号が振られています。

それぞれの町にはテレポーターが $ 1 $ 台ずつ設置されています。町 $ i\ (1\ \leq\ i\ \leq\ N) $ のテレポーターの転送先は町 $ A_i $ です。

高橋王は正の整数 $ K $ が好きです。わがままな高橋王は、町 $ 1 $ から出発してテレポーターをちょうど $ K $ 回使うと、どの町に到着するかが知りたいです。

高橋王のために、これを求めるプログラムを作成してください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ K $ $ A_1 $ $ A_2 $ $ \dots $ $ A_N $

## 输出格式

町 $ 1 $ から出発してテレポーターをちょうど $ K $ 回使ったとき到着する町の番号を出力せよ。

## 说明/提示

### 制約

- $ 2\ \leq\ N\ \leq\ 2\ \times\ 10^5 $
- $ 1\ \leq\ A_i\ \leq\ N $
- $ 1\ \leq\ K\ \leq\ 10^{18} $

### Sample Explanation 1

町 $ 1 $ から出発してテレポーターを $ 5 $ 回使うと、$ 1\ \to\ 3\ \to\ 4\ \to\ 1\ \to\ 3\ \to\ 4 $ と移動します。

## 样例 #1

### 输入

```
4 5

3 2 4 1
```

### 输出

```
4
```

## 样例 #2

### 输入

```
6 727202214173249351

6 5 2 5 3 2
```

### 输出

```
2
```



---

---
title: "[ABC168D] .. (Double Dots)"
layout: "post"
diff: 普及/提高-
pid: AT_abc168_d
tag: []
---

# [ABC168D] .. (Double Dots)

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc168/tasks/abc168_d

あるところに、洞窟があります。

洞窟には $ N $ 個の部屋と $ M $ 本の通路があり、部屋には $ 1 $ から $ N $ の、通路には $ 1 $ から $ M $ の番号がついています。通路 $ i $ は部屋 $ A_i $ と部屋 $ B_i $ を双方向につないでいます。どの $ 2 $ 部屋間も、通路をいくつか通って行き来できます。部屋 $ 1 $ は洞窟の入り口がある特別な部屋です。

洞窟の中は薄暗いので、部屋 $ 1 $ 以外の各部屋に $ 1 $ つずつ道しるべを設けることにしました。各部屋の道しるべは、その部屋と通路で直接つながっている部屋の $ 1 $ つを指すように置きます。

洞窟の中は危険なので、部屋 $ 1 $ 以外のどの部屋についても以下の条件を満たすことが目標です。

- その部屋から出発し、「いまいる部屋にある道しるべを見て、それが指す部屋に移動する」ことを繰り返すと、部屋 $ 1 $ に最小の移動回数でたどり着く。

目標を達成できる道しるべの配置が存在するか判定し、存在するならばそのような配置を $ 1 $ つ出力してください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ M $ $ A_1 $ $ B_1 $ $ : $ $ A_M $ $ B_M $

## 输出格式

目標を達成できる道しるべの配置が存在しなければ `No` を出力せよ。

存在する場合、$ N $ 行出力せよ。$ 1 $ 行目には `Yes` を、$ i\ (2\ \leq\ i\ \leq\ N) $ 行目には部屋 $ i $ の道しるべが指す部屋の番号を出力せよ。

## 说明/提示

### 制約

- 入力はすべて整数
- $ 2\ \leq\ N\ \leq\ 10^5 $
- $ 1\ \leq\ M\ \leq\ 2\ \times\ 10^5 $
- $ 1\ \leq\ A_i,\ B_i\ \leq\ N\ (1\ \leq\ i\ \leq\ M) $
- $ A_i\ \neq\ B_i\ (1\ \leq\ i\ \leq\ M) $
- どの $ 2 $ 部屋間も、通路をいくつか通って行き来できる

### Sample Explanation 1

出力例のように道しるべを置いたとき、 - 部屋 $ 2 $ から出発した場合 $ (2)\ \to\ 1 $ と $ 1 $ 回移動することになり、これが最小です。 - 部屋 $ 3 $ から出発した場合 $ (3)\ \to\ 2\ \to\ 1 $ と $ 2 $ 回移動することになり、これが最小です。 - 部屋 $ 4 $ から出発した場合 $ (4)\ \to\ 2\ \to\ 1 $ と $ 2 $ 回移動することになり、これが最小です。 したがって、出力例のように道しるべを置けば目標を達成できます。

### Sample Explanation 2

答えが複数あり得る場合、どれを出力してもかまいません。

## 样例 #1

### 输入

```
4 4

1 2

2 3

3 4

4 2
```

### 输出

```
Yes

1

2

2
```

## 样例 #2

### 输入

```
6 9

3 4

6 1

2 4

5 3

4 6

1 5

6 2

4 5

5 6
```

### 输出

```
Yes

6

5

5

1

1
```



---

---
title: "[ABC169D] Div Game"
layout: "post"
diff: 普及/提高-
pid: AT_abc169_d
tag: []
---

# [ABC169D] Div Game

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc169/tasks/abc169_d

正の整数 $ N $ が与えられます。 $ N $ に対して、以下の操作を繰り返し行うことを考えます。

- はじめに、以下の条件を全て満たす正の整数 $ z $ を選ぶ。
  - ある素数 $ p $ と正の整数 $ e $ を用いて、 $ z=p^e $ と表せる
  - $ N $ が $ z $ で割り切れる
  - 以前の操作で選んだどの整数とも異なる
- $ N $ を、$ N/z $ に置き換える

最大で何回操作を行うことができるか求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $

## 输出格式

答えを整数として出力せよ。

## 说明/提示

### 制約

- 入力はすべて整数である。
- $ 1\ \leq\ N\ \leq\ 10^{12} $

### Sample Explanation 1

例えば、次のように操作を行うことで、 $ 3 $ 回操作を行うことができます。 - $ z=2\ (=2^1) $ とする。( 操作後、 $ N=12 $ となる。) - $ z=3\ (=3^1) $ とする。( 操作後、 $ N=4 $ となる。 ) - $ z=4\ (=2^2) $ とする。( 操作後、 $ N=1 $ となる。 )

### Sample Explanation 2

一度も操作を行うことができません。

### Sample Explanation 3

例えば、次のように操作を行うことで、 $ 3 $ 回操作を行うことができます。 - $ z=2\ (=2^1) $ とする。( 操作後、 $ N=32 $ となる。) - $ z=4\ (=2^2) $ とする。( 操作後、 $ N=8 $ となる。 ) - $ z=8\ (=2^3) $ とする。( 操作後、 $ N=1 $ となる。 )

### Sample Explanation 4

例えば、次のように操作を行うことで、 $ 1 $ 回操作を行うことができます。 - $ z=1000000007\ (=1000000007^1) $ とする。( 操作後、 $ N=1 $ となる。 )

## 样例 #1

### 输入

```
24
```

### 输出

```
3
```

## 样例 #2

### 输入

```
1
```

### 输出

```
0
```

## 样例 #3

### 输入

```
64
```

### 输出

```
3
```

## 样例 #4

### 输入

```
1000000007
```

### 输出

```
1
```

## 样例 #5

### 输入

```
997764507000
```

### 输出

```
7
```



---

---
title: "[ABC170D] Not Divisible"
layout: "post"
diff: 普及/提高-
pid: AT_abc170_d
tag: []
---

# [ABC170D] Not Divisible

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc170/tasks/abc170_d

長さ $ N $ の数列 $ A $ が与えられます。

次の性質を満たす整数 $ i $ $ \left(1\ \leq\ i\ \leq\ N\ \right) $ の数を答えてください。

- $ i\ \neq\ j $ である任意の整数 $ j $ $ \left(1\ \leq\ j\ \leq\ N\right) $ について $ A_i $ は $ A_j $ で割り切れない

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ A_1 $ $ A_2 $ $ \cdots $ $ A_N $

## 输出格式

答えを出力せよ。

## 说明/提示

### 制約

- 入力は全て整数
- $ 1\ \leq\ N\ \leq\ 2\ \times\ 10^5 $
- $ 1\ \leq\ A_i\ \leq\ 10^6 $

### Sample Explanation 1

問の性質を満たすのは $ 2 $ , $ 3 $ , $ 4 $ です。

### Sample Explanation 2

同じ数が存在する場合に注意してください。

## 样例 #1

### 输入

```
5

24 11 8 3 16
```

### 输出

```
3
```

## 样例 #2

### 输入

```
4

5 5 5 5
```

### 输出

```
0
```

## 样例 #3

### 输入

```
10

33 18 45 28 8 19 89 86 2 4
```

### 输出

```
5
```



---

---
title: "[ABC171E] Red Scarf"
layout: "post"
diff: 普及/提高-
pid: AT_abc171_e
tag: []
---

# [ABC171E] Red Scarf

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc171/tasks/abc171_e

猫のすぬけくんが $ N\ (\textbf{偶数}) $ 匹います。各すぬけくんには $ 1,\ 2,\ \ldots,\ N $ の番号が振られています。

各すぬけくんは首に赤いスカーフを巻いており、スカーフにはそのすぬけくんが一番好きな非負整数が $ 1 $ つ書き込まれています。

すぬけくんたちは最近、整数の xor（排他的論理和）と呼ばれる演算を覚えました。

 xor とは $ n $ 個の非負整数 $ x_1,x_2,\ \ldots,\ x_n $ について、それらの xor、 $ x_1~\textrm{xor}~x_2~\textrm{xor}~\ldots~\textrm{xor}~x_n $ は以下のように定義されます。

- $ x_1~\textrm{xor}~x_2~\textrm{xor}~\ldots~\textrm{xor}~x_n $ を二進表記した際の $ 2^k(k\ \geq\ 0) $ の位の数は、$ x_1,x_2,\ \ldots,\ x_n $ のうち、二進表記した際の $ 2^k(k\ \geq\ 0) $ の位の数が $ 1 $ となるものの個数が奇数ならば $ 1 $、そうでなければ $ 0 $ となる。
 
 例えば、$ 3~\textrm{xor}~5\ =\ 6 $ となります。 早速この演算を使いたくなったすぬけくんたちは、自分以外のすぬけくんのスカーフに書かれた整数の xor を計算することにしました。

番号 $ i $ が振られたすぬけくんが計算した、自分以外のすぬけくんのスカーフに書かれた整数の xor が $ a_i $ であることが分かっています。 この情報を元に、各すぬけくんのスカーフに書かれた整数を特定してください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ a_1 $ $ a_2 $ $ \ldots $ $ a_N $

## 输出格式

$ 1 $ 行に $ N $ 個の整数を空白区切りで出力せよ。

このうち左から $ i $ 番目の整数は、番号 $ i $ が振られたすぬけくんのスカーフに書かれた整数を表すものとする。

与えられた条件を満たす解が複数存在する場合、どれを出力しても構わない。

## 说明/提示

### 制約

- 入力はすべて整数である
- $ 2\ \leq\ N\ \leq\ 200000 $
- $ N $ は$ \textbf{偶数} $
- $ 0\ \leq\ a_i\ \leq\ 10^9 $
- 与えられた情報と整合するようなスカーフ上の整数の組合せが存在する

### Sample Explanation 1

\- $ 5~\textrm{xor}~7~\textrm{xor}~22\ =\ 20 $ - $ 26~\textrm{xor}~7~\textrm{xor}~22\ =\ 11 $ - $ 26~\textrm{xor}~5~\textrm{xor}~22\ =\ 9 $ - $ 26~\textrm{xor}~5~\textrm{xor}~7\ =\ 24 $ より、この出力は与えられた情報と整合します。

## 样例 #1

### 输入

```
4

20 11 9 24
```

### 输出

```
26 5 7 22
```



---

---
title: "[ABC172C] Tsundoku"
layout: "post"
diff: 普及/提高-
pid: AT_abc172_c
tag: []
---

# [ABC172C] Tsundoku

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc172/tasks/abc172_c

二台の机 A, B があります。机 A には $ N $ 冊の本が、机 B には $ M $ 冊の本が、それぞれ縦に積まれています。

机 A に現在上から $ i $ 番目に積まれている本 $ (1\ \leq\ i\ \leq\ N) $ は読むのに $ A_i $ 分を要し、机 B に現在上から $ i $ 番目に積まれている本 $ (1\ \leq\ i\ \leq\ M) $ は読むのに $ B_i $ 分を要します。

次の行為を考えます。

- 本が残っている机を選び、その机の最も上に積まれた本を読んで机から取り除く。

合計所要時間が $ K $ 分を超えないようにこの行為を繰り返すとき、最大で何冊の本を読むことができるでしょうか。本を読むこと以外に要する時間は無視します。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ M $ $ K $ $ A_1 $ $ A_2 $ $ \ldots $ $ A_N $ $ B_1 $ $ B_2 $ $ \ldots $ $ B_M $

## 输出格式

読むことのできる本の最大数を表す整数を出力せよ。

## 说明/提示

### 制約

- $ 1\ \leq\ N,\ M\ \leq\ 200000 $
- $ 1\ \leq\ K\ \leq\ 10^9 $
- $ 1\ \leq\ A_i,\ B_i\ \leq\ 10^9 $
- 入力中の値はすべて整数である。

### Sample Explanation 1

この場合、机 A の上から $ 1,2,3 $ 番目の本はそれぞれ読むのに $ 60 $ 分、$ 90 $ 分、$ 120 $ 分を要し、机 B の上から $ 1,2,3,4 $ 番目の本はそれぞれ読むのに $ 80 $ 分、$ 150 $ 分、$ 80 $ 分、$ 150 $ 分を要します。 以下のようにすることで $ 230 $ 分で $ 3 $ 冊の本を読むことができ、これが $ 240 $ 分以内に読むことのできる本の最大数です。 - 机 A の最も上に積まれている本を $ 60 $ 分かけて読み、この本を机から取り除く。 - 机 B の最も上に積まれている本を $ 80 $ 分かけて読み、この本を机から取り除く。 - 机 A の最も上に積まれている本を $ 90 $ 分かけて読み、この本を机から取り除く。

### Sample Explanation 3

整数のオーバーフローに注意してください。

## 样例 #1

### 输入

```
3 4 240

60 90 120

80 150 80 150
```

### 输出

```
3
```

## 样例 #2

### 输入

```
3 4 730

60 90 120

80 150 80 150
```

### 输出

```
7
```

## 样例 #3

### 输入

```
5 4 1

1000000000 1000000000 1000000000 1000000000 1000000000

1000000000 1000000000 1000000000 1000000000
```

### 输出

```
0
```



---

---
title: "[ABC172D] Sum of Divisors"
layout: "post"
diff: 普及/提高-
pid: AT_abc172_d
tag: []
---

# [ABC172D] Sum of Divisors

## 题目描述

### 题意翻译
- $f(x)$ 表示正整数 $x$ 的因数个数
- 现在给你一个正整数 $ N $ ，让你求出 $  \sum_{K=1}^N\ K\times\ f(K) $  。
----------


-------------

## 输出格式

- 共一行，输出 $ \sum_{K=1}^N\ K\times\ f(K) $ 的结果
- 最后别忘了输出回车

## 说明/提示

-  $ 1\ \leq\ N\ \leq\ 10^7 $
- $f(1)=1 $ ,  $ f(2)=2 $ ,  $ f(3)=2 $ ,  $ f(4)=3 $ , 所以答案为  $ 1\times\ 1\ +\ 2\times\ 2\ +\ 3\times\ 2\ +\ 4\times\ 3\ =23 $ 。

 _Translated by qinmingze_

## 样例 #1

### 输入

```
4
```

### 输出

```
23
```

## 样例 #2

### 输入

```
100
```

### 输出

```
26879
```

## 样例 #3

### 输入

```
10000000
```

### 输出

```
838627288460105
```



---

---
title: "[ABC173D] Chat in a Circle"
layout: "post"
diff: 普及/提高-
pid: AT_abc173_d
tag: []
---

# [ABC173D] Chat in a Circle

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc173/tasks/abc173_d

あなたはオンラインゲーム「ATChat」のチュートリアルを終え、その場に居合わせたプレイヤー $ N $ 人で早速とある場所を訪ねることにしました。この $ N $ 人には $ 1 $ から $ N $ の番号が振られており、人 $ i\ (1\ \leq\ i\ \leq\ N) $ の **フレンドリーさ** は $ A_i $ です。

訪ねる際、$ N $ 人は好きな順番で $ 1 $ 人ずつ到着します。あなたたちは迷子にならないために、既に到着した人たちで環状に並び、新たに到着した人は好きな位置に割り込んで加わるというルールを決めました。

最初に到着した人以外の各人は、割り込んだ位置から到着した時点で「時計回りで最も近い人」と「反時計回りで最も近い人」のフレンドリーさのうち小さい方に等しい **心地よさ** を感じます。最初に到着した人の心地よさは $ 0 $ です。

$ N $ 人が到着する順番や割り込む位置を適切に決めたとき、$ N $ 人の心地よさの合計の最大値はいくらになるでしょう？

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ A_1 $ $ A_2 $ $ \dots $ $ A_N $

## 输出格式

$ N $ 人の心地よさの合計の最大値を出力せよ。

## 说明/提示

### 制約

- 入力はすべて整数
- $ 2\ \leq\ N\ \leq\ 2\ \times\ 10^5 $
- $ 1\ \leq\ A_i\ \leq\ 10^9 $

### Sample Explanation 1

人 $ 4,\ 2,\ 1,\ 3 $ がこの順に到着し、図のように輪に割り込むことで、心地よさの合計は $ 7 $ になります。 !\[図\](https://img.atcoder.jp/ghi/766a260a0019ea93e86e0588cc4db868.png) 心地よさの合計を $ 7 $ より大きくすることはできないので、$ 7 $ が答えになります。

## 样例 #1

### 输入

```
4

2 2 1 3
```

### 输出

```
7
```

## 样例 #2

### 输入

```
7

1 1 1 1 1 1 1
```

### 输出

```
6
```



---

---
title: "[ABC174E] Logs"
layout: "post"
diff: 普及/提高-
pid: AT_abc174_e
tag: []
---

# [ABC174E] Logs

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc174/tasks/abc174_e

丸太が $ N $ 本あり、それぞれ長さは $ A_1,A_2,\cdots,A_N $ です。

これらの丸太を合計 $ K $ 回まで切ることができます。 長さ $ L $ の丸太を片端から $ t\ (0\ <\ t\ <\ L) $ の位置で切ると、長さ $ t,L-t $ の丸太に分かれます。

丸太を合計 $ K $ 回まで切った後最も長い丸太の長さが最小でいくつになるか求め、小数点以下を切り上げた値を出力してください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ K $ $ A_1 $ $ A_2 $ $ \cdots $ $ A_N $

## 输出格式

答えとなる整数を出力せよ。

## 说明/提示

### 制約

- $ 1\ \leq\ N\ \leq\ 2\ \times\ 10^5 $
- $ 0\ \leq\ K\ \leq\ 10^9 $
- $ 1\ \leq\ A_i\ \leq\ 10^9 $
- 入力はすべて整数である。

### Sample Explanation 1

\- まず、長さ $ 7 $ の丸太を片端から $ 3.5 $ の位置で切り、長さ $ 3.5 $ の丸太二本に分けます。 - 次に、長さ $ 9 $ の丸太を片端から $ 3 $ の位置で切り、長さ $ 3 $ と $ 6 $ の丸太に分けます。 - 最後に、長さ $ 6 $ の丸太を片端から $ 3.3 $ の位置で切り、長さ $ 3.3 $ と $ 2.7 $ の丸太に分けます。 すると、最も長い丸太の長さは $ 3.5 $ になります。これが最小なので、小数点以下を切り上げた $ 4 $ を出力します。

## 样例 #1

### 输入

```
2 3

7 9
```

### 输出

```
4
```

## 样例 #2

### 输入

```
3 0

3 4 5
```

### 输出

```
5
```

## 样例 #3

### 输入

```
10 10

158260522 877914575 602436426 24979445 861648772 623690081 433933447 476190629 262703497 211047202
```

### 输出

```
292638192
```



---

---
title: "[ABC176D] Wizard in Maze"
layout: "post"
diff: 普及/提高-
pid: AT_abc176_d
tag: []
---

# [ABC176D] Wizard in Maze

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc176/tasks/abc176_d

縦 $ H $ マス、横 $ W $ マスの $ H\times\ W $ マスからなる迷路があります。

上から $ i $ 行目、左から $ j $ 列目のマス $ (i,j) $ は、$ S_{ij} $ が `#` のとき壁であり、`.`のとき道です。

マス $ (C_h,C_w) $ に魔法使いがいます。魔法使いは次の $ 2 $ 種類の方法で移動することができます。

- 移動A：現在いるマスと上下左右に隣接する道のマスへ歩いて移動する。
- 移動B：現在いるマスを中心とする $ 5\times\ 5 $ の範囲内にある道のマスへワープ魔法で移動する。

どちらの行動でも、迷路の外へ移動することはできません。

マス $ (D_h,D_w) $ まで移動するには、ワープ魔法を最低で何度使う必要があるでしょうか。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ H $ $ W $ $ C_h $ $ C_w $ $ D_h $ $ D_w $ $ S_{11}\ldots\ S_{1W} $ $ \vdots $ $ S_{H1}\ldots\ S_{HW} $

## 输出格式

ワープ魔法を使う最小回数を出力せよ。$ (D_h,D_w) $ に到達不可能な場合、かわりに `-1` と出力せよ。

## 说明/提示

### 制約

- $ 1\ \leq\ H,W\ \leq\ 10^3 $
- $ 1\ \leq\ C_h,D_h\ \leq\ H $
- $ 1\ \leq\ C_w,D_w\ \leq\ W $
- $ S_{ij} $ は `#` か `.`
- $ S_{C_h\ C_w} $ と $ S_{D_h\ D_w} $ は `.`
- $ (C_h,C_w)\ \neq\ (D_h,D_w) $

### Sample Explanation 1

例えば $ (2,2) $ まで歩いて移動し、$ (2,2) $ から $ (4,4) $ へワープ魔法で移動することで、ワープ魔法の使用回数を $ 1 $ 回にできます。 歩いて斜めに移動することはできません。

### Sample Explanation 2

現在地から動くことができません。

### Sample Explanation 3

ワープ魔法を使う必要はありません。

## 样例 #1

### 输入

```
4 4

1 1

4 4

..#.

..#.

.#..

.#..
```

### 输出

```
1
```

## 样例 #2

### 输入

```
4 4

1 4

4 1

.##.

####

####

.##.
```

### 输出

```
-1
```

## 样例 #3

### 输入

```
4 4

2 2

3 3

....

....

....

....
```

### 输出

```
0
```

## 样例 #4

### 输入

```
4 5

1 2

2 5

#.###

####.

#..##

#..##
```

### 输出

```
2
```



---

---
title: "[ABC176E] Bomber"
layout: "post"
diff: 普及/提高-
pid: AT_abc176_e
tag: []
---

# [ABC176E] Bomber

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc176/tasks/abc176_e

$ H\ \times\ W $ マスの二次元グリッドがあります。この中には $ M $ 個の爆破対象があります。 $ i $ 個目の爆破対象の位置は $ \left(h_i,\ w_i\ \right) $です。

高橋君は $ 1 $ つのマスを選び、そのマスに爆弾を設置し、起爆します。爆弾と同じ行または同じ列に存在する爆破対象が爆破されます。爆破対象が存在するマスに爆弾を設置することも出来ます。

高橋君は、爆破する爆破対象の数を最大化しようとしています。最大でいくつの爆破対象を爆破出来るか答えてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ H $ $ W $ $ M $ $ h_1 $ $ w_1 $ $ \vdots $ $ h_M $ $ w_M $

## 输出格式

答えを出力せよ。

## 说明/提示

### 制約

- 入力は全て整数
- $ 1\ \leq\ H,\ W\ \leq\ 3\ \times\ 10^5 $
- $ 1\ \leq\ M\ \leq\ \min\left(H\times\ W,\ 3\ \times\ 10^5\right) $
- $ 1\ \leq\ h_i\ \leq\ H $
- $ 1\ \leq\ w_i\ \leq\ W $
- $ \left(h_i,\ w_i\right)\ \neq\ \left(h_j,\ w_j\right)\ \left(i\ \neq\ j\right) $

### Sample Explanation 1

爆弾を $ \left(1,\ 2\right) $ に設置することで、全ての爆破対象を爆破することが出来ます。

## 样例 #1

### 输入

```
2 3 3

2 2

1 1

1 3
```

### 输出

```
3
```

## 样例 #2

### 输入

```
3 3 4

3 3

3 1

1 1

1 2
```

### 输出

```
3
```

## 样例 #3

### 输入

```
5 5 10

2 5

4 3

2 3

5 5

2 2

5 4

5 3

5 1

3 5

1 4
```

### 输出

```
6
```



---

---
title: "[ABC177D] Friends"
layout: "post"
diff: 普及/提高-
pid: AT_abc177_d
tag: []
---

# [ABC177D] Friends

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc177/tasks/abc177_d

人 $ 1 $ から 人 $ N $ までの $ N $ 人の人がいます。

「人 $ A_i $ と人 $ B_i $ は友達である」という情報が $ M $ 個与えられます。同じ情報が複数回与えられることもあります。

$ X $ と $ Y $ が友達、かつ、$ Y $ と $ Z $ が友達ならば、$ X $ と $ Z $ も友達です。また、$ M $ 個の情報から導くことができない友達関係は存在しません。

悪の高橋君は、この $ N $ 人をいくつかのグループに分け、全ての人について「同じグループの中に友達がいない」という状況を作ろうとしています。

最小でいくつのグループに分ければ良いでしょうか？

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ M $ $ A_1 $ $ B_1 $ $ \vdots $ $ A_M $ $ B_M $

## 输出格式

答えを出力せよ。

## 说明/提示

### 制約

- $ 2\ \leq\ N\ \leq\ 2\times\ 10^5 $
- $ 0\ \leq\ M\ \leq\ 2\times\ 10^5 $
- $ 1\leq\ A_i,B_i\leq\ N $
- $ A_i\ \neq\ B_i $

### Sample Explanation 1

例えば $ \{1,3\},\{2,4\},\{5\} $ という $ 3 $ つのグループに分けることで目的を達成できます。

## 样例 #1

### 输入

```
5 3

1 2

3 4

5 1
```

### 输出

```
3
```

## 样例 #2

### 输入

```
4 10

1 2

2 1

1 2

2 1

1 2

1 3

1 4

2 3

2 4

3 4
```

### 输出

```
4
```

## 样例 #3

### 输入

```
10 4

3 1

4 1

5 9

2 6
```

### 输出

```
3
```



---

---
title: "[ABC177E] Coprime"
layout: "post"
diff: 普及/提高-
pid: AT_abc177_e
tag: []
---

# [ABC177E] Coprime

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc177/tasks/abc177_e

$ N $ 個の整数があります。$ i $ 番目の数は $ A_i $ です。

「全ての $ 1\leq\ i\ <\ j\ \leq\ N $ について、$ GCD(A_i,A_j)=1 $」が成り立つとき、$ \{A_i\} $ は pairwise coprime であるといいます。

$ \{A_i\} $ が pairwise coprime ではなく、かつ、$ GCD(A_1,\ldots,A_N)=1 $ であるとき、$ \{A_i\} $ は setwise coprime であるといいます。

$ \{A_i\} $ が pairwise coprime、setwise coprime、そのどちらでもない、のいずれであるか判定してください。

ただし $ GCD(\ldots) $ は最大公約数を表します。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ A_1 $ $ \ldots $ $ A_N $

## 输出格式

$ \{A_i\} $ が pairwise coprime ならば `pairwise coprime`、setwise coprime ならば `setwise coprime`、そのどちらでもなければ `not coprime` と出力せよ。

## 说明/提示

### 制約

- $ 2\ \leq\ N\ \leq\ 10^6 $
- $ 1\ \leq\ A_i\leq\ 10^6 $

### Sample Explanation 1

$ GCD(3,4)=GCD(3,5)=GCD(4,5)=1 $ なので pairwise coprime です。

### Sample Explanation 2

$ GCD(6,10)=2 $ なので pairwise coprime ではありませんが、$ GCD(6,10,15)=1 $ なので setwise coprime です。

### Sample Explanation 3

$ GCD(6,10,16)=2 $ なので、pairwise coprime でも setwise coprime でもありません。

## 样例 #1

### 输入

```
3

3 4 5
```

### 输出

```
pairwise coprime
```

## 样例 #2

### 输入

```
3

6 10 15
```

### 输出

```
setwise coprime
```

## 样例 #3

### 输入

```
3

6 10 16
```

### 输出

```
not coprime
```



---

---
title: "[ABC178D] Redistribution"
layout: "post"
diff: 普及/提高-
pid: AT_abc178_d
tag: []
---

# [ABC178D] Redistribution

## 题目描述

给定整数 $ S $。请求出有几个序列，所有项都是 $ 3 $ 以上的整数，其总和是 $ S $。因为答案可能会非常大，所以请输出除以$ 1e9+7 $ 后的余数。

## 输入格式

一个整数$ S $

## 输出格式

答案除以$ 1e9+7 $后的余数

## 样例 #1

### 输入

```
7
```

### 输出

```
3
```

## 样例 #2

### 输入

```
2
```

### 输出

```
0
```

## 样例 #3

### 输入

```
1729
```

### 输出

```
294867501
```



---

---
title: "[ABC178E] Dist Max"
layout: "post"
diff: 普及/提高-
pid: AT_abc178_e
tag: []
---

# [ABC178E] Dist Max

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc178/tasks/abc178_e

二次元平面上に $ N $ 個の点があり、$ i $ 番目の点の座標は $ (x_i,y_i) $ です。 同じ座標に複数の点があることもあります。 異なる二点間のマンハッタン距離として考えられる最大の値はいくつでしょうか。

ただし、二点 $ (x_i,y_i) $ と $ (x_j,y_j) $ のマンハッタン距離は $ |x_i-x_j|+|y_i-y_j| $ のことをいいます。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ x_1 $ $ y_1 $ $ x_2 $ $ y_2 $ $ : $ $ x_N $ $ y_N $

## 输出格式

答えを出力せよ。

## 说明/提示

### 制約

- $ 2\ \leq\ N\ \leq\ 2\ \times\ 10^5 $
- $ 1\ \leq\ x_i,y_i\ \leq\ 10^9 $
- 入力はすべて整数

### Sample Explanation 1

$ 1 $ 番目の点と $ 2 $ 番目の点のマンハッタン距離は $ |1-2|+|1-4|=4 $ で、これが最大です。

## 样例 #1

### 输入

```
3

1 1

2 4

3 2
```

### 输出

```
4
```

## 样例 #2

### 输入

```
2

1 1

1 1
```

### 输出

```
0
```



---

---
title: "[ABC179D] Leaping Tak"
layout: "post"
diff: 普及/提高-
pid: AT_abc179_d
tag: []
---

# [ABC179D] Leaping Tak

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc179/tasks/abc179_d

一列に並んだ $ N $ マスから成るマス目があり、マスには左から順番に$ 1,\ 2,\ \ldots,\ N $ の番号がついています。

このマス目で暮らしている高橋君は、現在マス $ 1 $ にいて、後述の方法で移動を繰り返してマス $ N $ へ行こうとしています。

$ 10 $ 以下の整数 $ K $ と、共通部分を持たない $ K $ 個の区間 $ [L_1,\ R_1],\ [L_2,\ R_2],\ \ldots,\ [L_K,\ R_K] $ が与えられ、これらの区間の和集合を $ S $ とします。ただし、区間 $ [l,\ r] $ は $ l $ 以上 $ r $ 以下の整数の集合を表します。

- マス $ i $ にいるとき、$ S $ から整数を $ 1 $ つ選んで ($ d $ とする)、マス $ i\ +\ d $ に移動する。ただし、マス目の外に出るような移動を行ってはならない。

高橋君のために、マス $ N $ に行く方法の個数を $ 998244353 $ で割った余りを求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ K $ $ L_1 $ $ R_1 $ $ L_2 $ $ R_2 $ $ : $ $ L_K $ $ R_K $

## 输出格式

高橋くんがマス $ 1 $ からマス $ N $ に行く方法の個数を $ 998244353 $ で割った余りを出力せよ。

## 说明/提示

### 制約

- $ 2\ \leq\ N\ \leq\ 2\ \times\ 10^5 $
- $ 1 \leq\ K\ \leq\ \min(N,\ 10) $
- $ 1\ \leq\ L_i\ \leq\ R_i\ \leq\ N $
- $ [L_i,\ R_i] $ と $ [L_j,\ R_j] $ は共通部分を持たない ($ i\ \neq\ j $)
- 入力はすべて整数である

### Sample Explanation 1

集合 $ S $ は 区間 $ [1,\ 1] $ と区間 $ [3,\ 4] $ の和集合であり、$ S\ =\ \{\ 1,\ 3,\ 4\ \} $ です。 マス $ 5 $ へ移動する方法は次の $ 4 $ 通りが考えられます。 - マス $ 1,\ 2,\ 3,\ 4,\ 5 $ の順に移動する。 - マス $ 1,\ 2,\ 5 $ の順に移動する。 - マス $ 1,\ 4,\ 5 $ の順に移動する。 - マス $ 1,\ 5 $ の順に移動する。

### Sample Explanation 2

$ S\ =\ \{\ 3,\ 5\ \} $ であり、そもそもマス $ 5 $ にたどり着けないので $ 0 $ を出力してください。

### Sample Explanation 4

$ 998244353 $ で割った余りを出力することに注意してください。

## 样例 #1

### 输入

```
5 2

1 1

3 4
```

### 输出

```
4
```

## 样例 #2

### 输入

```
5 2

3 3

5 5
```

### 输出

```
0
```

## 样例 #3

### 输入

```
5 1

1 2
```

### 输出

```
5
```

## 样例 #4

### 输入

```
60 3

5 8

1 3

10 15
```

### 输出

```
221823067
```



---

---
title: "[ABC179E] Sequence Sum"
layout: "post"
diff: 普及/提高-
pid: AT_abc179_e
tag: []
---

# [ABC179E] Sequence Sum

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc179/tasks/abc179_e

$ x $ を $ m $ で割った余りを $ f(x,m) $ と表します。

初期値 $ A_1=X $ および漸化式 $ A_{n+1}=\ f(A_n^2,\ M) $ で定まる数列を $ A $ とします。$ \displaystyle{\sum_{i=1}^N\ A_i} $ を求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ X $ $ M $

## 输出格式

$ \displaystyle{\sum_{i=1}^N\ A_i} $ を出力せよ。

## 说明/提示

### 制約

- $ 1\ \leq\ N\ \leq\ 10^{10} $
- $ 0\ \leq\ X\ <\ M\ \leq\ 10^5 $
- 入力は全て整数

### Sample Explanation 1

数列 $ A $ は $ 2,4,16,256,471,620,\ldots $ となるので、答えは $ 2+4+16+256+471+620=1369 $ となります。

### Sample Explanation 2

数列 $ A $ は $ 2,4,0,0,\ldots $ となるので、答えは $ 6 $ となります。

## 样例 #1

### 输入

```
6 2 1001
```

### 输出

```
1369
```

## 样例 #2

### 输入

```
1000 2 16
```

### 输出

```
6
```

## 样例 #3

### 输入

```
10000000000 10 99959
```

### 输出

```
492443256176507
```



---

---
title: "[ABC180D] Takahashi Unevolved"
layout: "post"
diff: 普及/提高-
pid: AT_abc180_d
tag: []
---

# [ABC180D] Takahashi Unevolved

## 题目描述

Iroha 正在玩一个宠物养成的游戏。

Iroha 的宠物名字叫 Takahashi。初始，Takahashi 的 **STR** 值为 $X$，**EXP** 值为 $0$。Iroha 可以带宠物到以下任意一个 Gym 进行训练：

- Kakomon Gym：**STR** 值将会变为原来的 $A$ 倍，**EXP** 值将会加上 $1$。
- AtCoder Gym：**STR** 值将会加上 $B$，**EXP** 值将会加上 $1$。

当 Takahashi 的 **STR** 值大于等于 $Y$，Takahashi 会进化形态。

但是 Iroha 认为进化的 Takahashi 没那么可爱，于是 Iroha 想求出在保证 Takahashi 不进化的情况下，能达到的最大 **EXP** 值是多少。

## 输入格式

一行四个整数，$X\ Y\ A\ B$。

## 输出格式

一行一个表示最大 **EXP** 值的整数。

@[hellolin](/user/751017) 译

## 样例 #1

### 输入

```
4 20 2 10
```

### 输出

```
2
```

## 样例 #2

### 输入

```
1 1000000000000000000 10 1000000000
```

### 输出

```
1000000007
```



---

---
title: "[ABC180E] Traveling Salesman among Aerial Cities"
layout: "post"
diff: 普及/提高-
pid: AT_abc180_e
tag: []
---

# [ABC180E] Traveling Salesman among Aerial Cities

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc180/tasks/abc180_e

$ 3 $ 次元空間内に $ N $ 個の都市、都市 $ 1 $ から 都市 $ N $ があります。都市 $ i $ は座標 $ (X_i,Y_i,Z_i) $ にあります。

座標 $ (a,b,c) $ の都市から $ (p,q,r) $ の都市に移動する際には $ |p-a|+|q-b|+\max(0,r-c) $ のコストがかかります。

都市 $ 1 $ からスタートし、全ての都市を $ 1 $ 度以上巡って都市 $ 1 $ に戻るまでの最小コストを求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ X_1 $ $ Y_1 $ $ Z_1 $ $ \vdots $ $ X_N $ $ Y_N $ $ Z_N $

## 输出格式

都市 $ 1 $ からスタートし、全ての都市を $ 1 $ 度以上巡って都市 $ 1 $ に戻るまでの最小コストを出力せよ。

## 说明/提示

### 制約

- $ 2\ \leq\ N\ \leq\ 17 $
- $ -10^6\ \leq\ X_i,Y_i,Z_i\ \leq\ 10^6 $
- 同じ座標に複数の都市があることはない
- 入力は全て整数

### Sample Explanation 1

都市 $ 1 $ から都市 $ 2 $ へ向かう時には $ |1-0|+|2-0|+\max(0,3-0)=6 $ のコストがかかります。 都市 $ 2 $ から都市 $ 1 $ へ向かう時には $ |0-1|+|0-2|+\max(0,0-3)=3 $ のコストがかかります。 よって合計で $ 9 $ のコストがかかります。

### Sample Explanation 2

例えば 都市 $ 1 $, $ 2 $, $ 1 $, $ 3 $, $ 1 $ の順に移動するとコストが $ 10 $ になります。途中で都市 $ 1 $ に戻ってきても構いません。

## 样例 #1

### 输入

```
2

0 0 0

1 2 3
```

### 输出

```
9
```

## 样例 #2

### 输入

```
3

0 0 0

1 1 1

-1 -1 -1
```

### 输出

```
10
```

## 样例 #3

### 输入

```
17

14142 13562 373095

-17320 508075 68877

223606 -79774 9979

-24494 -89742 783178

26457 513110 -64591

-282842 7124 -74619

31622 -77660 -168379

-33166 -24790 -3554

346410 16151 37755

-36055 51275 463989

37416 -573867 73941

-3872 -983346 207417

412310 56256 -17661

-42426 40687 -119285

43588 -989435 -40674

-447213 -59549 -99579

45825 7569 45584
```

### 输出

```
6519344
```



---

---
title: "[ABC181E] Transformable Teacher"
layout: "post"
diff: 普及/提高-
pid: AT_abc181_e
tag: []
---

# [ABC181E] Transformable Teacher

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc181/tasks/abc181_e

$ N $ 人の児童がおり、 $ i $ 番目の児童の身長は $ H_i $ です。 $ N $ は奇数です。

今から、先生であるあなたを含めた $ N+1 $ 人で $ 2 $ 人 $ 1 $ 組を $ \large\frac{N+1}2 $ ペア組みます。

あなたの目標は、それぞれのペアの身長の差の合計を最小化することです。  
 すなわち、 $ i $ 番目のペアの身長の組を $ (x_i,\ y_i) $ としたとき、 $ \displaystyle\ \sum_{i=1}^{(N+1)/2}|x_i-y_i| $ を最小化したいです。

あなたには $ M $ 個の変身形態があり、 $ i $ 番目の変身形態での身長は $ W_i $ です。

あなたの変身形態とペアの組み方を工夫することで、それぞれのペアの身長の差の合計が最小でいくつにできるか求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ M $ $ H_1 $ $ \dots $ $ H_N $ $ W_1 $ $ \dots $ $ W_M $

## 输出格式

変身形態とペアの組み方を工夫したときの、それぞれのペアの身長の差の合計の最小値を出力せよ。

## 说明/提示

### 制約

- 入力はすべて整数
- $ 1\ \leq\ N,\ M\ \leq\ 2\ \times\ 10^5 $
- $ N $ は奇数
- $ 1\ \leq\ H_i\ \leq\ 10^9 $
- $ 1\ \leq\ W_i\ \leq\ 10^9 $

### Sample Explanation 1

身長 $ 8 $ の変身形態を選び、身長が $ (1,\ 2),\ (3,\ 4),\ (7,\ 8) $ のペアを作ると最小になります。

## 样例 #1

### 输入

```
5 3

1 2 3 4 7

1 3 8
```

### 输出

```
3
```

## 样例 #2

### 输入

```
7 7

31 60 84 23 16 13 32

96 80 73 76 87 57 29
```

### 输出

```
34
```

## 样例 #3

### 输入

```
15 10

554 525 541 814 661 279 668 360 382 175 833 783 688 793 736

496 732 455 306 189 207 976 73 567 759
```

### 输出

```
239
```



---

---
title: "[ABC182D] Wandering"
layout: "post"
diff: 普及/提高-
pid: AT_abc182_d
tag: []
---

# [ABC182D] Wandering

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc182/tasks/abc182_d

数列 $ A_1,\ A_2,\ A_3,\ \dots,\ A_N $ が与えられます。 この数列は負の要素を含むかもしれません。  
 数直線上の座標 $ 0 $ に置かれているロボットが、以下の動作を順に行います。

- 正の向きに $ A_1 $ 進む。
- 正の向きに $ A_1 $ 進み、正の向きに $ A_2 $ 進む。
- 正の向きに $ A_1 $ 進み、正の向きに $ A_2 $ 進み、正の向きに $ A_3 $ 進む。

$ \hspace{140pt}\ \vdots $

- 正の向きに $ A_1 $ 進み、正の向きに $ A_2 $ 進み、正の向きに $ A_3 $ 進み、$ \dots $ 、正の向きに $ A_N $ 進む。

動作開始時から終了時までのロボットの座標の最大値を求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ A_1\ \hspace{7pt}\ A_2\ \hspace{7pt}\ A_3\ \hspace{5pt}\ \dots\ \hspace{5pt}\ A_N $

## 输出格式

動作開始時から終了時までのロボットの座標の最大値を出力せよ。

## 说明/提示

### 制約

- $ 1\ \le\ N\ \le\ 200000 $
- $ -10^8\ \le\ A_i\ \le\ 10^8 $
- 入力はすべて整数

### Sample Explanation 1

ロボットは以下のように動きます。 - 正の向きに $ 2 $ 進み、座標が $ 2 $ になる。 - 正の向きに $ 2 $ 進み、座標が $ 4 $ になる。続けて正の向きに $ -1 $ 進み、座標が $ 3 $ になる。 - 正の向きに $ 2 $ 進み、座標が $ 5 $ になる。続けて正の向きに $ -1 $ 進み、座標が $ 4 $ になる。更に正の向きに $ -2 $ 進み、座標が $ 2 $ になる。 動作中の座標の最大値は $ 5 $ なので、 $ 5 $ を出力してください。

### Sample Explanation 3

この場合最初にいた座標 $ 0 $ が最大値です。

## 样例 #1

### 输入

```
3

2 -1 -2
```

### 输出

```
5
```

## 样例 #2

### 输入

```
5

-2 1 3 -1 -1
```

### 输出

```
2
```

## 样例 #3

### 输入

```
5

-1000 -1000 -1000 -1000 -1000
```

### 输出

```
0
```



---

---
title: "[ABC182E] Akari"
layout: "post"
diff: 普及/提高-
pid: AT_abc182_e
tag: []
---

# [ABC182E] Akari

## 题目描述

有一个 $H$ 行 $W$ 列的网格，定义 $(i,j)$ 是第 $i$ 行 $j$ 列的方格。

这个网格上有 $N$ 个灯泡和 $M$ 个障碍物，第 $i$ 个灯泡在 $(A_i,B_i)$ 处，第 $i$ 个障碍物在 $(C_i, D_i)$ 处。每个方格保证最多只有一个灯泡或障碍物。

每一个灯泡都会将光照向上下左右四个方向延伸，直至遇到障碍物或到达边界。灯泡所在的方格也会有光照。

请你计算，被光照照到且没有障碍物的方格有多少。

## 输入格式

第一行四个整数 $H$、$W$、$N$ 和 $M$。

接下来 $N$ 行，每行两个整数 $A_i$ 和 $B_i$ 表示第 $i$ 个灯泡的坐标。

接下来 $M$ 行，每行两个整数 $C_i$ 和 $D_i$ 表示第 $i$ 个障碍物的坐标。

## 输出格式

一行一个表示答案的整数。

@[hellolin](/user/751017) 译。

## 样例 #1

### 输入

```
3 3 2 1

1 1

2 3

2 2
```

### 输出

```
7
```

## 样例 #2

### 输入

```
4 4 3 3

1 2

1 3

3 4

2 3

2 4

3 2
```

### 输出

```
8
```

## 样例 #3

### 输入

```
5 5 5 1

1 1

2 2

3 3

4 4

5 5

4 2
```

### 输出

```
24
```



---

---
title: "[ABC183E] Queen on Grid"
layout: "post"
diff: 普及/提高-
pid: AT_abc183_e
tag: []
---

# [ABC183E] Queen on Grid

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc183/tasks/abc183_e

縦 $ H $ マス、横 $ W $ マスのグリッドがあります。 上から $ i $ 行目、左から $ j $ 列目のマス $ (i,j) $ は、$ S_{ij} $ が `#` のとき壁であり、`.` のとき道です。

マス $ (1,1) $ にチェスのクイーンの駒が置いてあります。 クイーンの駒は、今いる位置から右・下・右下方向に伸びる直線上にあり、壁を飛び越えずに到達できる道のマスに $ 1 $ 手で移動することができます。

クイーンの駒がマス $ (1,1) $ からマス $ (H,W) $ まで移動する方法は何通りありますか？ $ \bmod\ (10^9+7) $ で求めてください。

ただし、移動する方法が異なるとは、ある $ i $ が存在して、$ i $ 手目の移動の後にクイーンの駒があるマスの位置が異なることを指します。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ H $ $ W $ $ S_{11}\ldots\ S_{1W} $ $ \vdots $ $ S_{H1}\ldots\ S_{HW} $

## 输出格式

クイーンの駒がマス $ (1,1) $ から $ (H,W) $ まで移動する方法の数を $ \mod\ (10^9+7) $ で出力せよ。

## 说明/提示

### 制約

- $ 2\ \leq\ H,W\ \leq\ 2000 $
- $ S_{ij} $ は `#` か `.`
- $ S_{11} $ と $ S_{HW} $ は `.`

### Sample Explanation 1

移動方法として次の $ 10 $ 通りが考えられます。 - $ (1,1)\to\ (1,2)\to\ (1,3)\to\ (2,3)\to\ (3,3) $ - $ (1,1)\to\ (1,2)\to\ (1,3)\to\ (3,3) $ - $ (1,1)\to\ (1,2)\to\ (2,3)\to\ (3,3) $ - $ (1,1)\to\ (1,3)\to\ (2,3)\to\ (3,3) $ - $ (1,1)\to\ (1,3)\to\ (3,3) $ - $ (1,1)\to\ (2,1)\to\ (3,1)\to\ (3,2)\to\ (3,3) $ - $ (1,1)\to\ (2,1)\to\ (3,1)\to\ (3,3) $ - $ (1,1)\to\ (2,1)\to\ (3,2)\to\ (3,3) $ - $ (1,1)\to\ (3,1)\to\ (3,2)\to\ (3,3) $ - $ (1,1)\to\ (3,1)\to\ (3,3) $

### Sample Explanation 2

$ (1,1) $ からは $ 1 $ 手で $ (1,2),(1,3),(2,1),(2,2),(3,1),(4,1) $ のいずれかへ移動することが出来ます。 $ (4,4) $ への移動経路として、例えば $ (1,1)\to\ (3,1)\to\ (3,2)\to\ (4,3)\to\ (4,4) $ などがあります。

### Sample Explanation 3

移動方法の数を $ \bmod\ (10^9+7) $ で求めてください。

## 样例 #1

### 输入

```
3 3

...

.#.

...
```

### 输出

```
10
```

## 样例 #2

### 输入

```
4 4

...#

....

..#.

....
```

### 输出

```
84
```

## 样例 #3

### 输入

```
8 10

..........

..........

..........

..........

..........

..........

..........

..........
```

### 输出

```
13701937
```



---

---
title: "[ABC184C] Super Ryuma"
layout: "post"
diff: 普及/提高-
pid: AT_abc184_c
tag: []
---

# [ABC184C] Super Ryuma

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc184/tasks/abc184_c

無限に広がる $ 2 $ 次元グリッドがあり、マス $ (r_1,\ c_1) $ に駒「超竜馬」が置かれています。  
 この駒は、 $ 1 $ 手で次のような動きができます。

![](https://cdn.luogu.com.cn/upload/vjudge_pic/AT_abc184_c/5bfa39c442ba1e792051275842c037db26123fff.png)

より正確には、超竜馬がマス $ (a,\ b) $ にあるとき、以下のいずれかの条件を満たすマス $ (c,\ d) $ に動かすことができます。

- $ a\ +\ b\ =\ c\ +\ d $
- $ a\ -\ b\ =\ c\ -\ d $
- $ |a\ -\ c|\ +\ |b\ -\ d|\ \le\ 3 $

超竜馬を $ (r_1,\ c_1) $ から $ (r_2,\ c_2) $ に動かすのに必要な最小手数を求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ r_1 $ $ c_1 $ $ r_2 $ $ c_2 $

## 输出格式

超竜馬を $ (r_1,\ c_1) $ から $ (r_2,\ c_2) $ に動かすのに必要な最小手数を出力せよ。

## 说明/提示

### 制約

- 入力は全て整数
- $ 1\ \le\ r_1,\ c_1,\ r_2,\ c_2\ \le\ 10^9 $

### Sample Explanation 1

例えば、 $ (1,\ 1)\ \rightarrow\ (5,\ 5)\ \rightarrow\ (5,\ 6) $ と動かすと $ 2 $ 手になります。

### Sample Explanation 2

例えば、 $ (1,\ 1)\ \rightarrow\ (100001,\ 100001)\ \rightarrow\ (1,\ 200001) $ と動かすと $ 2 $ 手になります。

### Sample Explanation 3

例えば、 $ (2,\ 3)\ \rightarrow\ (3,\ 3)\ \rightarrow\ (-247,\ 253)\ \rightarrow\ (998244353,\ 998244853) $ と動かすと $ 3 $ 手になります。

## 样例 #1

### 输入

```
1 1

5 6
```

### 输出

```
2
```

## 样例 #2

### 输入

```
1 1

1 200001
```

### 输出

```
2
```

## 样例 #3

### 输入

```
2 3

998244353 998244853
```

### 输出

```
3
```

## 样例 #4

### 输入

```
1 1

1 1
```

### 输出

```
0
```



---

---
title: "[ABC184D] increment of coins"
layout: "post"
diff: 普及/提高-
pid: AT_abc184_d
tag: []
---

# [ABC184D] increment of coins

## 题目描述

袋子里原本有金币 $ A $ 枚、银币 $ B $ 枚、铜币 $ C $ 枚。

直到袋子中有一种硬币达到 $100$ 枚之前，都会进行以下操作。

操作：每秒钟都有 $1$ 枚硬币被等概率地取出，然后向袋子中放入两枚相同的硬币。

求出操作次数的数学期望。

## 输入格式

输入为一行三个整数

> $ A $ $ B $ $ C $

## 输出格式

一行一个浮点数，为操作次数的数学期望。若与标准答案的误差不超过 $ 10^{-6} $，则视为正确答案

## 说明/提示

- $ 0\ \leq\ A,B,C\ \leq\ 99 $
- $ A+B+C\ \geq\ 1 $

### 【样例解释1】 

不论第一次操作取出哪种硬币，袋中都会出现 $ 100 $ 枚该种硬币。

### 【样例解释2】 

我们只会在第一次取出金币的情况下进行第二次操作，操作次数的数学期望为 $ 2\times\ \frac{98}{98+99+99}+1\times\ \frac{99}{98+99+99}+1\times\ \frac{99}{98+99+99}=1.331081081\ldots $。

### 【样例解释3】 

每次操作只会取出铜币

## 样例 #1

### 输入

```
99 99 99
```

### 输出

```
1.000000000
```

## 样例 #2

### 输入

```
98 99 99
```

### 输出

```
1.331081081
```

## 样例 #3

### 输入

```
0 0 1
```

### 输出

```
99.000000000
```

## 样例 #4

### 输入

```
31 41 59
```

### 输出

```
91.835008202
```



---

---
title: "[ABC185F] Range Xor Query"
layout: "post"
diff: 普及/提高-
pid: AT_abc185_f
tag: []
---

# [ABC185F] Range Xor Query

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc185/tasks/abc185_f

長さ $ N $ の整数列 $ A $ があります。  
 あなたは今からこの数列について $ Q $ 個のクエリを処理します。$ i $ 番目のクエリでは、 $ T_i,\ X_i,\ Y_i $ が与えられるので、以下の処理をしてください。

- $ T_i\ =\ 1 $ のとき  
   $ A_{X_i} $ を $ A_{X_i}\ \oplus\ Y_i $ で置き換える
- $ T_i\ =\ 2 $ のとき  
   $ A_{X_i}\ \oplus\ A_{X_i\ +\ 1}\ \oplus\ A_{X_i\ +\ 2}\ \oplus\ \dots\ \oplus\ A_{Y_i} $ を出力する

ただし $ a\ \oplus\ b $ は $ a $ と $ b $ のビット単位 xor を表します。  
 ビット単位 xor とは  整数 $ A,\ B $ のビット単位 xor 、$ A\ \oplus\ B $ は、以下のように定義されます。

\- $ A\ \oplus\ B $ を二進表記した際の $ 2^k $ ($ k\ \geq\ 0 $) の位の数は、$ A,\ B $ を二進表記した際の $ 2^k $ の位の数のうち一方のみが $ 1 $ であれば $ 1 $、そうでなければ $ 0 $ である。
 
 例えば、$ 3\ \oplus\ 5\ =\ 6 $ となります (二進表記すると: $ 011\ \oplus\ 101\ =\ 110 $)。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ Q $ $ A_1\ \hspace{7pt}\ A_2\ \hspace{7pt}\ A_3\ \hspace{5pt}\ \dots\ \hspace{5pt}\ A_N $ $ T_1 $ $ X_1 $ $ Y_1 $ $ T_2 $ $ X_2 $ $ Y_2 $ $ T_3 $ $ X_3 $ $ Y_3 $ $ \hspace{22pt}\ \vdots $ $ T_Q $ $ X_Q $ $ Y_Q $

## 输出格式

$ T_i\ =\ 2 $ であるような各クエリについて、答えを $ 1 $ 行に $ 1 $ つずつ、順に出力せよ。

## 说明/提示

### 制約

- $ 1\ \le\ N\ \le\ 300000 $
- $ 1\ \le\ Q\ \le\ 300000 $
- $ 0\ \le\ A_i\ \lt\ 2^{30} $
- $ T_i $ は $ 1 $ または $ 2 $
- $ T_i\ =\ 1 $ なら $ 1\ \le\ X_i\ \le\ N $ かつ $ 0\ \le\ Y_i\ \lt\ 2^{30} $
- $ T_i\ =\ 2 $ なら $ 1\ \le\ X_i\ \le\ Y_i\ \le\ N $
- 入力は全て整数

### Sample Explanation 1

$ 1 $ 個目のクエリでは $ 1\ \oplus\ 2\ \oplus\ 3\ =\ 0 $ を出力します。 $ 2 $ 個目のクエリでは $ 2\ \oplus\ 3\ =\ 1 $ を出力します。 $ 3 $ 個目のクエリでは $ A_2 $ が $ 2\ \oplus\ 3\ =\ 1 $ で置き換えられます。 $ 4 $ 個目のクエリでは $ 1\ \oplus\ 3\ =\ 2 $ を出力します。

## 样例 #1

### 输入

```
3 4

1 2 3

2 1 3

2 2 3

1 2 3

2 2 3
```

### 输出

```
0

1

2
```

## 样例 #2

### 输入

```
10 10

0 5 3 4 7 0 0 0 1 0

1 10 7

2 8 9

2 3 6

2 1 6

2 1 10

1 9 4

1 6 1

1 6 3

1 1 7

2 3 5
```

### 输出

```
1

0

5

3

0
```



---

---
title: "[ABC188D] Snuke Prime"
layout: "post"
diff: 普及/提高-
pid: AT_abc188_d
tag: []
---

# [ABC188D] Snuke Prime

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc188/tasks/abc188_d

株式会社すぬけは様々なサービスを提供しています。  
 この会社は、すぬけプライムという支払いプランを用意しています。  
 すぬけプライムへの加入中は、$ 1 $ 日あたり $ C $ 円を支払うことで、提供される全てのサービスを追加料金の支払いなしに利用することができます。  
 すぬけプライムへの加入および脱退は、それぞれ $ 1 $ 日の始めおよび終わりに自由に行うことができます。

高橋くんは、この会社のサービスのうち $ N $ 個を利用しようとしています。  
 そのうち $ i $ 個目のサービスは、今日を $ 1 $ 日目として、$ a_i $ 日目の始めから $ b_i $ 日目の終わりまで利用する予定です。  
 すぬけプライムに加入していない期間中は、$ i $ 個目のサービスを利用する際に $ 1 $ 日あたり $ c_i $ 円を支払う必要があります。

サービスを利用するために高橋くんが支払う必要のある最小の合計金額を求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ C $ $ a_1 $ $ b_1 $ $ c_1 $ $ \vdots $ $ a_N $ $ b_N $ $ c_N $

## 输出格式

高橋くんが支払う必要のある最小の合計金額を出力せよ。

## 说明/提示

### 制約

- $ 1\ \leq\ N\ \leq\ 2\ \times\ 10^5 $
- $ 1\ \leq\ C\ \leq\ 10^9 $
- $ 1\ \leq\ a_i\ \leq\ b_i\ \leq\ 10^9 $
- $ 1\ \leq\ c_i\ \leq\ 10^9 $
- 入力に含まれる値は全て整数

### Sample Explanation 1

$ 1 $ 番目のサービスは $ 1 $ 日目と $ 2 $ 日目に、 $ 2 $ 番目のサービスは $ 2 $ 日目に利用します。 $ 2 $ 日目のみすぬけプライムに加入すると、 $ 1 $ 日目に $ 4 $ 円、 $ 2 $ 日目に $ 6 $ 円がかかるため、高橋くんが支払う合計金額は $ 10 $ 円です。 高橋くんが支払う金額を $ 10 $ 円より少なくすることはできないため、 $ 10 $ を出力します。

### Sample Explanation 2

すぬけプライムに全く加入しないのが最適です。

## 样例 #1

### 输入

```
2 6

1 2 4

2 2 4
```

### 输出

```
10
```

## 样例 #2

### 输入

```
5 1000000000

583563238 820642330 44577

136809000 653199778 90962

54601291 785892285 50554

5797762 453599267 65697

468677897 916692569 87409
```

### 输出

```
163089627821228
```

## 样例 #3

### 输入

```
5 100000

583563238 820642330 44577

136809000 653199778 90962

54601291 785892285 50554

5797762 453599267 65697

468677897 916692569 87409
```

### 输出

```
88206004785464
```



---

---
title: "[ABC188E] Peddler"
layout: "post"
diff: 普及/提高-
pid: AT_abc188_e
tag: []
---

# [ABC188E] Peddler

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc188/tasks/abc188_e

高橋国には、町 $ 1 $ から町 $ N $ までの $ N $ 個の町があります。  
 また、この国には道 $ 1 $ から道 $ M $ までの $ M $ 本の道があります。道 $ i $ を使うと、町 $ X_i $ から町 $ Y_i $ へ移動することができます。逆向きへは移動できません。ここで $ X_i\ <\ Y_i $ であることが保証されます。  
 この国では金の取引が盛んであり、町 $ i $ では、金 $ 1\,\mathrm{kg} $ を $ A_i $ 円で売ったり買ったりすることができます。

旅商人である高橋君は、高橋国内のある町で金を $ 1\,\mathrm{kg} $ だけ買い、いくつかの道を使った後、**買った町とは別の町で**金を $ 1\,\mathrm{kg} $ だけ売ろうと考えています。  
 このとき、高橋君の利益 (すなわち $ ( $金を売った価格$ )\ -\ ( $金を買った価格$ ) $) として考えられる最大値を求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ M $ $ A_1 $ $ A_2 $ $ A_3 $ $ \dots $ $ A_N $ $ X_1 $ $ Y_1 $ $ X_2 $ $ Y_2 $ $ X_3 $ $ Y_3 $ $ \hspace{15pt}\ \vdots $ $ X_M $ $ Y_M $

## 输出格式

答えを出力せよ。

## 说明/提示

### 制約

- $ 2\ \le\ N\ \le\ 2\ \times\ 10^5 $
- $ 1\ \le\ M\ \le\ 2\ \times\ 10^5 $
- $ 1\ \le\ A_i\ \le\ 10^9 $
- $ 1\ \le\ X_i\ \lt\ Y_i\ \le\ N $
- $ (X_i,\ Y_i)\ \neq\ (X_j,\ Y_j)\ (i\ \neq\ j) $
- 入力に含まれる値は全て整数

### Sample Explanation 1

以下のようにして利益 $ 3 $ 円を達成できます。 - 町 $ 1 $ で $ 2 $ 円で金 $ 1\,\mathrm{kg} $ を買う - 道 $ 2 $ を使って町 $ 2 $ に移動する - 道 $ 1 $ を使って町 $ 4 $ に移動する - 町 $ 4 $ で $ 5 $ 円で金 $ 1\,\mathrm{kg} $ を売る

### Sample Explanation 2

以下のようにして利益 $ 10 $ 円を達成できます。 - 町 $ 2 $ で $ 8 $ 円で金 $ 1\,\mathrm{kg} $ を買う - 道 $ 1 $ を使って町 $ 4 $ に移動する - 道 $ 3 $ を使って町 $ 5 $ に移動する - 町 $ 5 $ で $ 18 $ 円で金 $ 1\,\mathrm{kg} $ を売る

### Sample Explanation 3

金を買った町で売ることはできないため、答えが負になる可能性があることに注意してください。

## 样例 #1

### 输入

```
4 3

2 3 1 5

2 4

1 2

1 3
```

### 输出

```
3
```

## 样例 #2

### 输入

```
5 5

13 8 3 15 18

2 4

1 2

4 5

2 3

1 3
```

### 输出

```
10
```

## 样例 #3

### 输入

```
3 1

1 100 1

2 3
```

### 输出

```
-99
```



---

---
title: "[ABC189D] Logical Expression"
layout: "post"
diff: 普及/提高-
pid: AT_abc189_d
tag: []
---

# [ABC189D] Logical Expression

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc189/tasks/abc189_d

$ N $ 個の文字列 $ S_1,\ldots,S_N $ が与えられます。各文字列は `AND` または `OR` です。

値が $ \text{True} $ または $ \text{False} $ であるような $ N+1 $ 個の変数の組 $ (x_0,\ldots,x_N) $ であって、 以下のような計算を行った際に、$ y_N $ が $ \text{True} $ となるようなものの個数を求めてください。

- $ y_0=x_0 $
- $ i\geq\ 1 $ のとき、$ S_i $ が `AND` なら $ y_i=y_{i-1}\ \land\ x_i $、$ S_i $ が `OR` なら $ y_i=y_{i-1}\ \lor\ x_i $

$ a\ \land\ b $ は $ a $ と $ b $ の論理積を表し、$ a\ \lor\ b $ は $ a $ と $ b $ の論理和を表します。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ S_1 $ $ \vdots $ $ S_N $

## 输出格式

答えを出力せよ。

## 说明/提示

### 制約

- $ 1\ \leq\ N\ \leq\ 60 $
- $ S_i $ は `AND` または `OR`

### Sample Explanation 1

例えば $ (x_0,x_1,x_2)=(\text{True},\text{False},\text{True}) $ のとき - $ y_0=x_0=\text{True} $ - $ y_1=y_0\ \land\ x_1\ =\ \text{True}\ \land\ \text{False}=\text{False} $ - $ y_2=y_1\ \lor\ x_2\ =\ \text{False}\ \lor\ \text{True}=\text{True} $ となり、$ y_2 $ は $ \text{True} $ になります。 $ y_2 $ が $ \text{True} $ となるような $ (x_0,x_1,x_2) $ の組み合わせは、 - $ (\text{True},\text{True},\text{True}) $ - $ (\text{True},\text{True},\text{False}) $ - $ (\text{True},\text{False},\text{True}) $ - $ (\text{False},\text{True},\text{True}) $ - $ (\text{False},\text{False},\text{True}) $ の $ 5 $ 通りで全てです。

### Sample Explanation 2

全てが $ \text{False} $ のときを除く $ 2^6-1 $ 通りで $ y_5 $ は $ \text{True} $ になります。

## 样例 #1

### 输入

```
2

AND

OR
```

### 输出

```
5
```

## 样例 #2

### 输入

```
5

OR

OR

OR

OR

OR
```

### 输出

```
63
```



---

---
title: "[ABC190D] Staircase Sequences"
layout: "post"
diff: 普及/提高-
pid: AT_abc190_d
tag: []
---

# [ABC190D] Staircase Sequences

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc190/tasks/abc190_d

整数からなる公差 $ 1 $ の等差数列のうち、総和が $ N $ であるものはいくつあるでしょうか？

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $

## 输出格式

答えを出力せよ。

## 说明/提示

### 制約

- $ 1\ <\ =\ N\ <\ =\ 10^{12} $
- $ N $ は整数

### Sample Explanation 1

\- $ [12] $ - $ [3,\ 4,\ 5] $ - $ [-2,\ -1,\ 0,\ 1,\ 2,\ 3,\ 4,\ 5] $ - $ [-11,\ -10,\ -9,\ \dots,\ 10,\ 11,\ 12] $ の $ 4 $ 個です。

### Sample Explanation 2

\- $ [1] $ - $ [0,\ 1] $ の $ 2 $ 個です。

## 样例 #1

### 输入

```
12
```

### 输出

```
4
```

## 样例 #2

### 输入

```
1
```

### 输出

```
2
```

## 样例 #3

### 输入

```
963761198400
```

### 输出

```
1920
```



---

---
title: "[ABC191C] Digital Graffiti"
layout: "post"
diff: 普及/提高-
pid: AT_abc191_c
tag: []
---

# [ABC191C] Digital Graffiti

## 题目描述

有一个 $H$ 行 $W$ 列的表格，格子要么为黑色，用‘#’表示，要么为白色，用‘.’表示。第一行和最后一行，第一列和最后一列都是白色格子。 考虑黑色部分组成的多边形，问多边形有多少条边？ 保证表格中，黑色部分为四联通区域，白色部分也为四联通区域。所谓四联通，即通过上、下、左、右四个方向，可以访问所有格子。 表格中至少存在一个黑色格子。

## 输入格式

第一行两个整数 $H$ , $W$ . 接下来 $H$ 行，每行一个长度为 $W$ 的字符串，由'#'或'.'组成。

## 输出格式

一个整数，表示答案

## 说明/提示

$3 \leq H \leq 10, 3 \leq W \leq 10$

## 样例 #1

### 输入

```
5 5

.....

.###.

.###.

.###.

.....
```

### 输出

```
4
```



---

---
title: "[ABC192E] Train"
layout: "post"
diff: 普及/提高-
pid: AT_abc192_e
tag: []
---

# [ABC192E] Train

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc192/tasks/abc192_e

AtCoder国には $ 1 $ から $ N $ の番号がついた $ N $ 個の都市と、$ 1 $ から $ M $ の番号がついた $ M $ 本の鉄道があります。

鉄道 $ i $ は都市 $ A_i $ と都市 $ B_i $ の間を結んでおり、時刻が $ K_i $ の倍数になる毎に、双方の都市からそれぞれ他方の都市への列車が発車します。この列車は出発から到着までに $ T_i $ の時間がかかります。

あなたはいま都市 $ X $ にいます。時刻 $ 0 $ またはそれ以降に都市 $ X $ を発車する列車に乗って移動を開始するとき、都市 $ Y $ には最速でいつたどり着けるか求めてください。都市 $ Y $ にたどり着くことが出来ない場合はそのことを報告してください。  
 ただし、乗り換えにかかる時間は無視できるため、どの都市においても、あなたの乗っている列車の到着時刻と同時に発車する別の列車に乗り換えることが可能であるとします。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ M $ $ X $ $ Y $ $ A_1 $ $ B_1 $ $ T_1 $ $ K_1 $ $ \vdots $ $ A_M $ $ B_M $ $ T_M $ $ K_M $

## 输出格式

都市 $ Y $ にたどり着くことができる最も早い時刻を出力せよ。ただし、都市 $ Y $ にたどり着くことが出来ない場合はかわりに `-1` と出力せよ。

## 说明/提示

### 制約

- $ 2\ \leq\ N\ \leq\ 10^5 $
- $ 0\ \leq\ M\ \leq\ 10^5 $
- $ 1\ \leq\ X,Y\ \leq\ N $
- $ X\ \neq\ Y $
- $ 1\ \leq\ A_i,B_i\ \leq\ N $
- $ A_i\ \neq\ B_i $
- $ 1\ \leq\ T_i\ \leq\ 10^9 $
- $ 1\ \leq\ K_i\ \leq\ 10^9 $
- 入力は全て整数

### Sample Explanation 1

まず、時刻 $ 0 $ に鉄道 $ 1 $ に乗って、都市 $ 1 $ から都市 $ 2 $ へ移動します。都市 $ 2 $ には時刻 $ 2 $ に到着します。 その後、時刻 $ 4 $ に鉄道 $ 2 $ に乗って、都市 $ 2 $ から都市 $ 3 $ へ移動します。都市 $ 3 $ には時刻 $ 7 $ に到着します。 これより早く都市 $ 3 $ に着く方法はありません。

### Sample Explanation 2

まず、時刻 $ 0 $ に鉄道 $ 2 $ に乗って、都市 $ 3 $ から都市 $ 2 $ へ移動します。都市 $ 2 $ には時刻 $ 3 $ に到着します。 その後、時刻 $ 3 $ に鉄道 $ 1 $ に乗って、都市 $ 2 $ から都市 $ 1 $ へ移動します。都市 $ 1 $ には時刻 $ 5 $ に到着します。

## 样例 #1

### 输入

```
3 2 1 3

1 2 2 3

2 3 3 4
```

### 输出

```
7
```

## 样例 #2

### 输入

```
3 2 3 1

1 2 2 3

2 3 3 4
```

### 输出

```
5
```

## 样例 #3

### 输入

```
3 0 3 1
```

### 输出

```
-1
```

## 样例 #4

### 输入

```
9 14 6 7

3 1 4 1

5 9 2 6

5 3 5 8

9 7 9 3

2 3 8 4

6 2 6 4

3 8 3 2

7 9 5 2

8 4 1 9

7 1 6 9

3 9 9 3

7 5 1 5

8 2 9 7

4 9 4 4
```

### 输出

```
26
```



---

---
title: "[ABC193D] Poker"
layout: "post"
diff: 普及/提高-
pid: AT_abc193_d
tag: []
---

# [ABC193D] Poker

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc193/tasks/abc193_d

$ 1,\ 2,\ \dots,\ 9 $ が表に書かれたカードが $ K $ 枚ずつ、計 $ 9K $ 枚のカードがあります。  
 これらのカードをランダムにシャッフルして、高橋くんと青木くんにそれぞれ、$ 4 $ 枚を表向きに、$ 1 $ 枚を裏向きにして配りました。  
 高橋くんに配られたカードが文字列 $ S $ として、青木くんに配られたカードが文字列 $ T $ として与えられます。  
 $ S,\ T $ は $ 5 $ 文字の文字列で、先頭 $ 4 $ 文字は `1`, `2`, $ \dots $, `9` からなり、表向きのカードに書かれた数を表します。 末尾 $ 1 $ 文字は `#` であり、裏向きのカードであることを表します。  
 $ 5 $ 枚の手札の点数を、$ c_i $ をその手札に含まれる $ i $ の枚数として、$ \displaystyle\ \sum_{i=1}^9\ i\ \times\ 10^{c_i} $ で定義します。  
 高橋くんが青木くんより点数の高い手札を持っていたら高橋くんの勝ちです。  
 高橋くんの勝つ確率を求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ K $ $ S $ $ T $

## 输出格式

高橋くんの勝つ確率を小数で出力せよ。  
 想定解答との絶対誤差または相対誤差が $ 10^{-5} $ 以下であれば正解と判定される。

## 说明/提示

### 制約

- $ 2\ <\ = K\ <\ =\ 10^5 $
- $ |S|\ =\ |T|\ =\ 5 $
- $ S,\ T $ の $ 1 $ 文字目から $ 4 $ 文字目は `1`, `2`, $ \dots $, `9` のいずれか
- `1`, `2`, $ \dots $, `9` はそれぞれ、$ S $ と $ T $ に合計 $ K $ 回までしか出現しない
- $ S,\ T $ の $ 5 $ 文字目は `#`

### Sample Explanation 1

例えば、高橋くんの手札が `11449` 、青木くんの手札が `22338` の場合、高橋くんの点数は $ 100+2+3+400+5+6+7+8+90=621 $ 、青木くんの点数は $ 1+200+300+4+5+6+7+80+9=612 $ で、高橋くんの勝ちになります。 裏向きのカードの大小によって勝敗が決まるので、高橋くんの勝つ確率は $ \frac49 $ です。

### Sample Explanation 3

高橋くんの手札が `11222` 、青木くんの手札が `22281` の場合にのみ高橋くんの勝ちになります。 高橋くんの勝つ確率は $ \frac2{1035} $ です。

## 样例 #1

### 输入

```
2

1144#

2233#
```

### 输出

```
0.4444444444444444
```

## 样例 #2

### 输入

```
2

9988#

1122#
```

### 输出

```
1.0
```

## 样例 #3

### 输入

```
6

1122#

2228#
```

### 输出

```
0.001932367149758454
```

## 样例 #4

### 输入

```
100000

3226#

3597#
```

### 输出

```
0.6296297942426154
```



---

---
title: "[ABC194D] Journey"
layout: "post"
diff: 普及/提高-
pid: AT_abc194_d
tag: []
---

# [ABC194D] Journey

## 题目描述

在一张有 $n$ 个节点的图上，高桥站在节点 $1$ 处。现在的图没有任何连边。

高桥在图连通之前，会重复执行下列操作：

- 随机选择一个点，每个点被选中的概率在每一次都是相等的，都是 $\frac{1}{n}$。
- 从当前点连一条边到选中的点。图允许重边和自环。然后，去到那个选中的点。

求出其期望操作次数。你的答案与标准答案的误差不超过 $10^{-6}$ 即可被判为通过。

## 输入格式

一行一个整数 $n$（$2\le n\le 10^5$）。

## 输出格式

一行一个实数，期望操作次数。

## 样例 #1

### 输入

```
2
```

### 输出

```
2.00000000000
```

## 样例 #2

### 输入

```
3
```

### 输出

```
4.50000000000
```



---

---
title: "[ABC194E] Mex Min"
layout: "post"
diff: 普及/提高-
pid: AT_abc194_e
tag: []
---

# [ABC194E] Mex Min

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc194/tasks/abc194_e

$ \mathrm{mex}(x_1,\ x_2,\ x_3,\ \dots,\ x_k) $ を、$ x_1,\ x_2,\ x_3,\ \dots,\ x_k $ に含まれない最小の非負整数と定義します。  
 長さ $ N $ の整数列 $ A\ =\ (A_1,\ A_2,\ A_3,\ \dots,\ A_N) $ が与えられます。  
 $ 0\ \le\ i\ \le\ N\ -\ M $ を満たす全ての整数 $ i $ について $ \mathrm{mex}(A_{i\ +\ 1},\ A_{i\ +\ 2},\ A_{i\ +\ 3},\ \dots,\ A_{i\ +\ M}) $ を計算したとき、この $ N\ -\ M\ +\ 1 $ 個の値のうちの最小値を求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ M $ $ A_1 $ $ A_2 $ $ A_3 $ $ \cdots $ $ A_N $

## 输出格式

答えを出力せよ。

## 说明/提示

### 制約

- $ 1\ \le\ M\ \le\ N\ \le\ 1.5\ \times\ 10^6 $
- $ 0\ \le\ A_i\ \lt\ N $
- 入力に含まれる値は全て整数

### Sample Explanation 1

\- $ i\ =\ 0 $ のとき : $ \mathrm{mex}(A_{i\ +\ 1},\ A_{i\ +\ 2})\ =\ \mathrm{mex}(0,\ 0)\ =\ 1 $ - $ i\ =\ 1 $ のとき : $ \mathrm{mex}(A_{i\ +\ 1},\ A_{i\ +\ 2})\ =\ \mathrm{mex}(0,\ 1)\ =\ 2 $ よって $ 1 $ と $ 2 $ のうちの最小値である $ 1 $ が答えです。

### Sample Explanation 2

\- $ i\ =\ 0 $ のとき : $ \mathrm{mex}(A_{i\ +\ 1},\ A_{i\ +\ 2})\ =\ \mathrm{mex}(1,\ 1)\ =\ 0 $ - $ i\ =\ 1 $ のとき : $ \mathrm{mex}(A_{i\ +\ 1},\ A_{i\ +\ 2})\ =\ \mathrm{mex}(1,\ 1)\ =\ 0 $ となります。

### Sample Explanation 3

\- $ i\ =\ 0 $ のとき : $ \mathrm{mex}(A_{i\ +\ 1},\ A_{i\ +\ 2})\ =\ \mathrm{mex}(0,\ 1)\ =\ 2 $ - $ i\ =\ 1 $ のとき : $ \mathrm{mex}(A_{i\ +\ 1},\ A_{i\ +\ 2})\ =\ \mathrm{mex}(1,\ 0)\ =\ 2 $ となります。

## 样例 #1

### 输入

```
3 2

0 0 1
```

### 输出

```
1
```

## 样例 #2

### 输入

```
3 2

1 1 1
```

### 输出

```
0
```

## 样例 #3

### 输入

```
3 2

0 1 0
```

### 输出

```
2
```

## 样例 #4

### 输入

```
7 3

0 0 1 2 0 1 0
```

### 输出

```
2
```



---

---
title: "[ABC195D] Shipping Center"
layout: "post"
diff: 普及/提高-
pid: AT_abc195_d
tag: []
---

# [ABC195D] Shipping Center

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc195/tasks/abc195_d

$ 1 $ から $ N $ の番号がついた $ N $ 個の荷物と、$ 1 $ から $ M $ の番号がついた $ M $ 個の箱があります。

荷物 $ i $ の大きさは $ W_i $ で、価値は $ V_i $ です。

箱 $ i $ には大きさが $ X_i $ 以下の荷物を入れることができます。$ 1 $ つの箱に $ 2 $ つ以上の荷物を入れることはできません。

$ Q $ 個のクエリが与えられます。各クエリでは $ 2 $ つの整数 $ L,R $ が与えられるので、次の問題を解いてください。

- 問題：$ M $ 個の箱のうち、箱 $ L,L+1,\ldots,R $ の $ R-L+1 $ 個の箱が使えなくなってしまいました。 残りの箱の中に同時に入れることができる荷物の価値の合計の最大値を求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ M $ $ Q $ $ W_1 $ $ V_1 $ $ \vdots $ $ W_N $ $ V_N $ $ X_1 $ $ \ldots $ $ X_M $ $ \mathrm{Query}_1 $ $ \vdots $ $ \mathrm{Query}_Q $

各クエリは以下の形式で与えられる。

> $ L $ $ R $

## 输出格式

$ Q $ 行出力せよ。

$ i $ 行目には、$ \mathrm{Query}_i $ に対応する問題の答えを出力せよ。

## 说明/提示

### 制約

- $ 1\ \leq\ N\ \leq\ 50 $
- $ 1\ \leq\ M\ \leq\ 50 $
- $ 1\ \leq\ Q\ \leq\ 50 $
- $ 1\ \leq\ W_i\ \leq\ 10^6 $
- $ 1\ \leq\ V_i\ \leq\ 10^6 $
- $ 1\ \leq\ X_i\ \leq\ 10^6 $
- $ 1\ \leq\ L\ \leq\ R\ \leq\ M $
- 入力は全て整数

### Sample Explanation 1

$ 1 $ 番目のクエリでは箱 $ 4 $ が使えません。 箱 $ 1 $ に荷物 $ 1 $ を、箱 $ 2 $ に荷物 $ 3 $ を、箱 $ 3 $ に荷物 $ 2 $ を入れることで、 全ての荷物を箱の中に入れることができ、箱の中の荷物の価値の合計を $ 20 $ にすることができます。 $ 2 $ 番目のクエリでは全ての箱が使えません。したがって、答えは $ 0 $ です。 $ 3 $ 番目のクエリでは、箱 $ 4 $ だけが使えます。箱 $ 4 $ に荷物 $ 1 $ を入れることで、箱の中の荷物の価値の合計は $ 9 $ となり、これが最大です。

## 样例 #1

### 输入

```
3 4 3

1 9

5 3

7 8

1 8 6 9

4 4

1 4

1 3
```

### 输出

```
20

0

9
```



---

---
title: "[ABC196D] Hanjo"
layout: "post"
diff: 普及/提高-
pid: AT_abc196_d
tag: []
---

# [ABC196D] Hanjo

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc196/tasks/abc196_d

縦 $ H $ メートル、横 $ W $ メートルの長方形の部屋があります。  
 この部屋に $ 2 $ メートル $ × $ $ 1 $ メートルの区別できない畳 (長方形のタイル) $ A $ 枚と、$ 1 $ メートル $ × $ $ 1 $ メートルの区別できない半畳 (正方形のタイル) $ B $ 枚を敷き詰めます。 $ 2 $ メートル $ × $ $ 1 $ メートルの畳は縦長にも横長にも使うことができます。  
 敷き詰める方法は何通りあるでしょうか？  
 なお、$ 2A\ +\ B\ =\ HW $ であることが保証されます。 また、回転や反転を行うことで初めて一致するような敷き詰め方は区別します。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ H $ $ W $ $ A $ $ B $

## 输出格式

答えを出力せよ。

## 说明/提示

### 制約

- 入力は全て整数
- $ 1\ <\ =\ H,\ W $
- $ HW\ <\ =\ 16 $
- $ 0\ <\ =\ A,\ B $
- $ 2A\ +\ B\ =\ HW $

### Sample Explanation 1

以下の $ 4 $ つです。 !\[\](https://img.atcoder.jp/ghi/d01b63c75c91bd87a73e9a4cc43dda28.png)

### Sample Explanation 2

以下の $ 6 $ つと、これらを回転させたものが含まれます。 !\[\](https://img.atcoder.jp/ghi/b7a492abe22e30683e8f9a7b309acd52.png)

## 样例 #1

### 输入

```
2 2 1 2
```

### 输出

```
4
```

## 样例 #2

### 输入

```
3 3 4 1
```

### 输出

```
18
```

## 样例 #3

### 输入

```
4 4 8 0
```

### 输出

```
36
```



---

---
title: "[ABC197C] ORXOR"
layout: "post"
diff: 普及/提高-
pid: AT_abc197_c
tag: []
---

# [ABC197C] ORXOR

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc197/tasks/abc197_c

長さ $ N $ の数列 $ A $ が与えられます。  
 この数列を、$ 1 $ つ以上の空でない連続した区間に分けます。  
 その後、分けた各区間で、区間内の数のビット単位 $ \mathrm{OR} $ を計算します。  
 こうして得られた全ての値のビット単位 $ \mathrm{XOR} $ として考えられる最小値を求めてください。

  ビット単位 $ \mathrm{OR} $ 演算とは  整数 $ A,\ B $ のビット単位 $ \mathrm{OR} $、$ A\ \mathrm{OR}\ B $ は以下のように定義されます。

- $ A\ \mathrm{OR}\ B $ を二進表記した際の $ 2^k $ ($ k\ \geq\ 0 $) の位の数は、$ A,\ B $ を二進表記した際の $ 2^k $ の位の数のうち少なくとも片方が $ 1 $ であれば $ 1 $、そうでなければ $ 0 $ である。
 
 例えば、$ 3\ \mathrm{OR}\ 5\ =\ 7 $ となります (二進表記すると: $ 011\ \mathrm{OR}\ 101\ =\ 111 $)。  
 一般に $ k $ 個の整数 $ p_1,\ p_2,\ p_3,\ \dots,\ p_k $ のビット単位 $ \mathrm{OR} $ は $ (\dots\ ((p_1\ \mathrm{OR}\ p_2)\ \mathrm{OR}\ p_3)\ \mathrm{OR}\ \dots\ \mathrm{OR}\ p_k) $ と定義され、これは $ p_1,\ p_2,\ p_3,\ \dots\ p_k $ の順番によらないことが証明できます。  ビット単位 $ \mathrm{XOR} $ 演算とは  整数 $ A,\ B $ のビット単位 $ \mathrm{XOR} $ 、$ A\ \mathrm{XOR}\ B $ は、以下のように定義されます。

- $ A\ \mathrm{XOR}\ B $ を二進表記した際の $ 2^k $ ($ k\ \geq\ 0 $) の位の数は、$ A,\ B $ を二進表記した際の $ 2^k $ の位の数のうち一方のみが $ 1 $ であれば $ 1 $、そうでなければ $ 0 $ である。
 
 例えば、$ 3\ \mathrm{XOR}\ 5\ =\ 6 $ となります (二進表記すると: $ 011\ \mathrm{XOR}\ 101\ =\ 110 $)。  
 一般に $ k $ 個以上の整数 $ p_1,\ p_2,\ p_3,\ \dots,\ p_k $ のビット単位 $ \mathrm{XOR} $ は $ (\dots\ ((p_1\ \mathrm{XOR}\ p_2)\ \mathrm{XOR}\ p_3)\ \mathrm{XOR}\ \dots\ \mathrm{XOR}\ p_k) $ と定義され、これは $ p_1,\ p_2,\ p_3,\ \dots\ p_k $ の順番によらないことが証明できます。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ A_1 $ $ A_2 $ $ A_3 $ $ \dots $ $ A_N $

## 输出格式

答えを出力せよ。

## 说明/提示

### 制約

- $ 1\ \le\ N\ \le\ 20 $
- $ 0\ \le\ A_i\ \lt\ 2^{30} $
- 入力に含まれる値は全て整数である

### Sample Explanation 1

$ [1,\ 5,\ 7] $ を $ [1,\ 5] $ と $ [7] $ の $ 2 $ つの区間に分けると、それぞれの区間内の数のビット単位 $ \mathrm{OR} $ は $ 5,\ 7 $ となり、その $ \mathrm{XOR} $ は $ 2 $ です。 これより小さくすることはできないので、$ 2 $ を出力します。

### Sample Explanation 2

$ [10] $ と $ [10,\ 10] $ に分けるとよいです。

### Sample Explanation 3

$ [1,\ 3] $ と $ [3,\ 1] $ に分けるとよいです。

## 样例 #1

### 输入

```
3

1 5 7
```

### 输出

```
2
```

## 样例 #2

### 输入

```
3

10 10 10
```

### 输出

```
0
```

## 样例 #3

### 输入

```
4

1 3 3 1
```

### 输出

```
0
```



---

---
title: "[ABC197D] Opposite"
layout: "post"
diff: 普及/提高-
pid: AT_abc197_d
tag: []
---

# [ABC197D] Opposite

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc197/tasks/abc197_d

$ \mathrm{x} $ 軸の正の向きを右、$ \mathrm{y} $ 軸の正の向きを上とする $ 2 $ 次元座標平面上に、$ p_0,\ p_1,\ p_2,\ \dots,\ p_{N\ -\ 1} $ の $ N $ 個の頂点からなる正 $ N $ 角形があります。  
 ここで $ N $ は偶数であることが保証され、頂点 $ p_0,\ p_1,\ p_2,\ \dots,\ p_{N\ -\ 1} $ はこの順に反時計回りに並んでいます。  
 $ p_i $ の座標を $ (x_i,\ y_i) $ とします。  
 $ x_0,\ y_0,\ x_{\frac{N}{2}},\ y_{\frac{N}{2}} $ が与えられるので、$ x_1,\ y_1 $ を求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ x_0 $ $ y_0 $ $ x_{\frac{N}{2}} $ $ y_{\frac{N}{2}} $

## 输出格式

$ x_1,\ y_1 $ をこの順に空白区切りで出力せよ。  
 出力されたそれぞれの値について、想定解答との絶対誤差または相対誤差が $ 10^{-5} $ 以下であれば正解と判定される。

## 说明/提示

### 制約

- $ 4\ \le\ N\ \le\ 100 $
- $ N $ は偶数
- $ 0\ \le\ x_0,\ y_0\ \le\ 100 $
- $ 0\ \le\ x_{\frac{N}{2}},\ y_{\frac{N}{2}}\ \le\ 100 $
- $ (x_0,\ y_0)\ \neq\ (x_{\frac{N}{2}},\ y_{\frac{N}{2}}) $
- 入力に含まれる値は全て整数である

### Sample Explanation 1

$ p_0\ =\ (1,\ 1),\ p_2\ =\ (2,\ 2) $ という情報が与えられています。 $ p_0,\ p_1,\ p_2,\ p_3 $ が正方形をなし、反時計回りに並んでいるという情報から残りの頂点の座標は一意に定まり、以下のようになります。 - $ p_1\ =\ (2,\ 1) $ - $ p_3\ =\ (1,\ 2) $

## 样例 #1

### 输入

```
4

1 1

2 2
```

### 输出

```
2.00000000000 1.00000000000
```

## 样例 #2

### 输入

```
6

5 3

7 4
```

### 输出

```
5.93301270189 2.38397459622
```



---

---
title: "[ABC198D] Send More Money"
layout: "post"
diff: 普及/提高-
pid: AT_abc198_d
tag: []
---

# [ABC198D] Send More Money

## 题目描述

给你三个由小写字母组成的字符串 $ S_1, S_2, S_3 $。请解出这道覆面算：$ S_1 + S_2 = S_3 $。

具体来说，要求你确定是否存在一组符合以下条件的正整数 $ N_1, N_2, N_3 $，如果存在，请输出其中一个组合：

1. $ N_1, N_2, N_3 $ 分别表示的十进制数字串 $ N'_1, N'_2, N'_3 $ 的长度与对应的字符串 $ S_1, S_2, S_3 $ 的长度相同，并且不含前导零。
2. 满足 $ N_1 + N_2 = N_3 $。
3. 如果 $ S_i $ 的第 $ x $ 个字符和 $ S_j $ 的第 $ y $ 个字符相同，那么 $ N'_i $ 的第 $ x $ 个数字和 $ N'_j $ 的第 $ y $ 个数字也必须相同。

## 输入格式

输入为一行，其中包含三个字符串 $ S_1, S_2, S_3 $。

## 输出格式

如果存在符合条件的正整数组合 $ N_1, N_2, N_3 $，则每行输出其中一个可能的组合。如果没有满足条件的组合，则输出 `UNSOLVABLE`。

## 说明/提示

- $ S_1, S_2, S_3 $ 是长度在 $ 1 $ 到 $ 10 $ 之间的小写字母字符串。

### 示例解释

在示例 1 中，输出 $ (N_1, N_2, N_3) = (4, 5, 9) $ 是正确的组合，而 $ (1, 1, 2) $ 因不满足条件 3 （例如，字符 `a` 和 `b` 都对应 $ 1 $）因此是错误的。

在示例 2 中，输出 $ (N_1, N_2, N_3) = (3, 3, 6) $ 是一个正确的答案，而 $ (1, 2, 3) $ 因为未满足条件 3（例如，数字 $ 1 $ 和 $ 2 $ 在对应字符 `x` 时不一致）是错误的。

 **本翻译由 AI 自动生成**

## 样例 #1

### 输入

```
a

b

c
```

### 输出

```
1

2

3
```

## 样例 #2

### 输入

```
x

x

y
```

### 输出

```
1

1

2
```

## 样例 #3

### 输入

```
p

q

p
```

### 输出

```
UNSOLVABLE
```

## 样例 #4

### 输入

```
abcd

efgh

ijkl
```

### 输出

```
UNSOLVABLE
```

## 样例 #5

### 输入

```
send

more

money
```

### 输出

```
9567

1085

10652
```



---

---
title: "[ABC198E] Unique Color"
layout: "post"
diff: 普及/提高-
pid: AT_abc198_e
tag: []
---

# [ABC198E] Unique Color

## 题目描述

给定一棵以 $1$ 节点为根的树。每个节点上都被染了一种颜色，不同颜色用不同整数表示。问：有多少个节点，它们到根节点的路径上的所有点（除了自己）的颜色都与自己的颜色不同。

## 输入格式

第一行输入整数 $n$（$2\le n\le 10^5$）。

第二行输入 $n$ 个整数，第 $i$ 个整数表示节点 $i$ 的颜色。（$1\le$ 每个节点的颜色 $\le 10^5$）

最后 $(n-1)$ 行：每行两个数 $a_i$,$b_i$，表示一条树边。

## 输出格式

一行一个整数，题目所求。

## 样例 #1

### 输入

```
6

2 7 1 8 2 8

1 2

3 6

3 2

4 3

2 5
```

### 输出

```
1

2

3

4

6
```

## 样例 #2

### 输入

```
10

3 1 4 1 5 9 2 6 5 3

1 2

2 3

3 4

4 5

5 6

6 7

7 8

8 9

9 10
```

### 输出

```
1

2

3

5

6

7

8
```



---

---
title: "[ABC200D] Happy Birthday! 2"
layout: "post"
diff: 普及/提高-
pid: AT_abc200_d
tag: []
---

# [ABC200D] Happy Birthday! 2

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc200/tasks/abc200_d

$ N $ 個の正整数からなる数列 $ A\ =\ (A_1,\ A_2,\ \dots,\ A_N) $ が与えられます。 以下の条件を全て満たす $ 2 $ つの数列 $ B\ =\ (B_1,\ B_2,\ \dots,\ B_x),\ C\ =\ (C_1,\ C_2,\ \dots,\ C_y) $ が存在するか判定し、存在する場合はひとつ出力してください。

- $ 1\ <\ = x,\ y\ <\ =\ N $
- $ 1\ \le\ B_1\ <\ B_2\ <\ \dots\ <\ B_{x}\ \le\ N $
- $ 1\ \le\ C_1\ <\ C_2\ <\ \dots\ <\ C_{y}\ \le\ N $
- $ B $ と $ C $ は、異なる数列である。
  - $ x\ ≠\ y $ のとき、または、ある整数 $ i\ (1\ <\ = i\ <\ = \min(x,\ y)) $ が存在して $ B_i\ ≠\ C_i $ であるとき、$ B $ と $ C $ は異なるものとする。
- $ A_{B_1}\ +\ A_{B_2}\ +\ \dots\ +\ A_{B_x} $ を $ 200 $ で割った余りと $ A_{C_1}\ +\ A_{C_2}\ +\ \dots\ +\ A_{C_y} $ を $ 200 $ で割った余りが等しい。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ A_1 $ $ A_2 $ $ \dots $ $ A_N $

## 输出格式

条件を満たす数列の組 $ B,C $ が存在しない場合、$ 1 $ 行に `No` と出力せよ。 存在する場合、以下の形式で $ B,C $ を出力せよ。

> Yes $ x $ $ B_1 $ $ B_2 $ $ \dots $ $ B_x $ $ y $ $ C_1 $ $ C_2 $ $ \dots $ $ C_y $

なお、正誤判定器は英大文字と英小文字を区別せず、どちらも受理する。

## 说明/提示

### 制約

- 入力はすべて整数
- $ 2\ \le\ N\ \le\ 200 $
- $ 1\ \le\ A_i\ \le\ 10^9 $

### Sample Explanation 1

$ B=(1),C=(3,4) $ とすると、$ A_1\ =\ 180,\ A_3\ +\ A_4\ =\ 380 $ となり、この $ 2 $ つを $ 200 $ で割った余りは等しくなります。 他にも、以下のような出力も正答として扱われます。 ``` yEs 4 2 3 4 5 3 1 2 5 ```

### Sample Explanation 3

条件を満たす数列の組が存在しない場合、$ 1 $ 行に `No` と出力してください。

## 样例 #1

### 输入

```
5

180 186 189 191 218
```

### 输出

```
Yes

1 1

2 3 4
```

## 样例 #2

### 输入

```
2

123 523
```

### 输出

```
Yes

1 1

1 2
```

## 样例 #3

### 输入

```
6

2013 1012 2765 2021 508 6971
```

### 输出

```
No
```



---

---
title: "[ABC202D] aab aba baa"
layout: "post"
diff: 普及/提高-
pid: AT_abc202_d
tag: []
---

# [ABC202D] aab aba baa

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc202/tasks/abc202_d

$ A $ 個の `a` と $ B $ 個の `b` からなる長さ $ A\ +\ B $ の文字列のうち、辞書順で $ K $ 番目のものを求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ A $ $ B $ $ K $

## 输出格式

答えを出力せよ。

## 说明/提示

### 制約

- $ 1\ \leq\ A,\ B\ \leq\ 30 $
- $ A $ 個の `a` と $ B $ 個の `b` からなる長さ $ A\ +\ B $ の文字列の総数を $ S $ 個とおいたとき、$ 1\ \leq\ K\ \leq\ S $
- 入力は全て整数である。

### Sample Explanation 1

$ 2 $ 個の `a` と $ 2 $ 個の `b` からなる文字列を辞書順に並べると、`aabb`、`abab`、`abba`、`baab`、`baba`、`bbaa` となります。 よって、$ 4 $ 番目である `baab` を出力します。

### Sample Explanation 2

$ K $ の値は $ 32 $ bit 整数に収まらないことがあります。

## 样例 #1

### 输入

```
2 2 4
```

### 输出

```
baab
```

## 样例 #2

### 输入

```
30 30 118264581564861424
```

### 输出

```
bbbbbbbbbbbbbbbbbbbbbbbbbbbbbbaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa
```



---

---
title: "[ABC204D] Cooking"
layout: "post"
diff: 普及/提高-
pid: AT_abc204_d
tag: []
---

# [ABC204D] Cooking

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc204/tasks/abc204_d

高橋君は料理 $ 1 $ から $ N $ の $ N $ 品の料理を作ろうとしています。

料理 $ i $ はオーブンを連続した $ T_i $ 分間使うことで作れます。$ 1 $ つのオーブンを $ 2 $ つ以上の料理のために同時に使うことはできません。

$ 2 $ つのオーブンを使えるとき、$ N $ 品の料理を全て作るまでに最短で何分かかりますか？ なお、オーブンを使う時間以外は無視できるものとします。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ T_1 $ $ \ldots $ $ T_N $

## 输出格式

答えを出力せよ。

## 说明/提示

### 制約

- $ 1\ \leq\ N\ \leq\ 100 $
- $ 1\ \leq\ T_i\ \leq\ 10^3 $
- 入力に含まれる値は全て整数である

### Sample Explanation 1

例えば $ 2 $ つのオーブンを次のように使うことで、$ 13 $ 分で全ての料理を作ることができます。 - $ 1 $ つ目のオーブン：料理 $ 5,1 $ を順に作る。 - $ 2 $ つ目のオーブン：料理 $ 2,4,3 $ を順に作る。

## 样例 #1

### 输入

```
5

8 3 7 2 5
```

### 输出

```
13
```

## 样例 #2

### 输入

```
2

1000 1
```

### 输出

```
1000
```

## 样例 #3

### 输入

```
9

3 14 15 9 26 5 35 89 79
```

### 输出

```
138
```



---

---
title: "[ABC205D] Kth Excluded"
layout: "post"
diff: 普及/提高-
pid: AT_abc205_d
tag: []
---

# [ABC205D] Kth Excluded

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc205/tasks/abc205_d

長さ $ N $ の正整数列 $ A\ =\ (A_1,\ A_2,\ \dots,\ A_N) $ と $ Q $ 個のクエリが与えられます。

$ i\ \,\ (1\ \leq\ i\ \leq\ Q) $ 番目のクエリでは、正整数 $ K_i $ が与えられるので、$ A_1,\ A_2,\ \dots,\ A_N $ のいずれとも異なる正整数のうち、小さい方から数えて $ K_i $ 番目のものを求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ Q $ $ A_1 $ $ A_2 $ $ \ldots $ $ A_N $ $ K_1 $ $ K_2 $ $ \vdots $ $ K_Q $

## 输出格式

$ Q $ 行出力せよ。$ i $ 行目には $ i $ 番目のクエリに対する答えを出力せよ。

## 说明/提示

### 制約

- $ 1\ \leq\ N,\ Q\ \leq\ 10^5 $
- $ 1\ \leq\ A_1\ <\ A_2\ <\ \dots\ <\ A_N\ \leq\ 10^{18} $
- $ 1\ \leq\ K_i\ \leq\ 10^{18} $
- 入力は全て整数である。

### Sample Explanation 1

$ 3,\ 5,\ 6,\ 7 $ のいずれとも異なる正整数を小さい順に並べると $ 1,\ 2,\ 4,\ 8,\ 9,\ 10,\ 11,\ \dots $ となります。 小さい方から $ 2 $ 番目、$ 5 $ 番目、$ 3 $ 番目はそれぞれ $ 2,\ 9,\ 4 $ です。

## 样例 #1

### 输入

```
4 3

3 5 6 7

2

5

3
```

### 输出

```
2

9

4
```

## 样例 #2

### 输入

```
5 2

1 2 3 4 5

1

10
```

### 输出

```
6

15
```



---

---
title: "[ABC206D] KAIBUNsyo"
layout: "post"
diff: 普及/提高-
pid: AT_abc206_d
tag: []
---

# [ABC206D] KAIBUNsyo

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc206/tasks/abc206_d

$ N $ 項からなる正整数列 $ A=(A_1,A_2,\ \dots\ A_N) $ が与えられます。  
 以下の操作を $ 0 $ 回以上何度でも行える時、操作を最小何回行えば、$ A $ を回文にすることができますか？

- ある正整数の組 $ (x,y) $ を選ぶ。その後、現在 $ A $ に含まれる $ x $ をすべて $ y $ に置き換える。

なお、この問題では、全ての整数 $ i $ ($ 1\ \le\ i\ \le\ N $) について、$ A_i=A_{N+1-i} $ が成り立つとき、またその時に限って、$ A $ が回文であると言います。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ A_1 $ $ A_2 $ $ \dots $ $ A_N $

## 输出格式

答えを整数として出力せよ。

## 说明/提示

### 制約

- 入力は全て整数
- $ 1\ \le\ N\ \le\ 2\ \times\ 10^5 $
- $ 1\ \le\ A_i\ \le\ 2\ \times\ 10^5 $

### Sample Explanation 1

\- はじめ、$ A=(1,5,3,2,5,2,3,1) $ です。 - $ A $ に含まれる $ 3 $ を全て $ 2 $ に置き換えると、$ A=(1,5,2,2,5,2,2,1) $ となります。 - $ A $ に含まれる $ 2 $ を全て $ 5 $ に置き換えると、$ A=(1,5,5,5,5,5,5,1) $ となります。 以上の操作を行うと、$ A $ を $ 2 $ 回の操作で回文にすることができ、これが最小です。

### Sample Explanation 3

$ A $ がはじめから回文である可能性もあります。

## 样例 #1

### 输入

```
8

1 5 3 2 5 2 3 1
```

### 输出

```
2
```

## 样例 #2

### 输入

```
7

1 2 3 4 1 2 3
```

### 输出

```
1
```

## 样例 #3

### 输入

```
1

200000
```

### 输出

```
0
```



---

---
title: "[ABC211D] Number of Shortest paths"
layout: "post"
diff: 普及/提高-
pid: AT_abc211_d
tag: []
---

# [ABC211D] Number of Shortest paths

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc211/tasks/abc211_d

AtCoder 国には $ 1 $ から $ N $ の番号がついた $ N $ 個の都市と、$ 1 $ から $ M $ の番号がついた $ M $ 個の道路があります。

道路 $ i $ を通ると都市 $ A_i $ と都市 $ B_i $ の間を双方向に $ 1 $ 時間で移動することができます。

都市 $ 1 $ から都市 $ N $ へ最も早く移動することができる経路は何通りありますか？  
 答えは非常に大きくなる可能性があるので $ (10^9+7) $ で割ったあまりを求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ M $ $ A_1 $ $ B_1 $ $ \vdots $ $ A_M $ $ B_M $

## 输出格式

答えを出力せよ。  
 都市 $ 1 $ から都市 $ N $ へ移動することが出来ない場合は $ 0 $ と出力せよ。

## 说明/提示

### 制約

- $ 2\ \leq\ N\ \leq\ 2\times\ 10^5 $
- $ 0\ \leq\ M\ \leq\ 2\times\ 10^5 $
- $ 1\ \leq\ A_i\ <\ B_i\ \leq\ N $
- $ (A_i,B_i) $ は相異なる
- 入力に含まれる値は全て整数である

### Sample Explanation 1

都市 $ 1 $ から都市 $ 4 $ へは最短 $ 2 $ 時間で移動することができ、それを実現する経路は $ 1\ \to\ 2\ \to\ 4 $ と $ 1\ \to\ 3\ \to\ 4 $ の $ 2 $ つです。

### Sample Explanation 2

都市 $ 1 $ から都市 $ 4 $ へは最短 $ 3 $ 時間で移動することができ、それを実現する経路は $ 1\ \to\ 3\ \to\ 2\ \to\ 4 $ の $ 1 $ つです。

### Sample Explanation 3

都市 $ 1 $ から都市 $ 2 $ に移動することはできません。この場合 $ 0 $ を出力してください。

## 样例 #1

### 输入

```
4 5

2 4

1 2

2 3

1 3

3 4
```

### 输出

```
2
```

## 样例 #2

### 输入

```
4 3

1 3

2 3

2 4
```

### 输出

```
1
```

## 样例 #3

### 输入

```
2 0
```

### 输出

```
0
```

## 样例 #4

### 输入

```
7 8

1 3

1 4

2 3

2 4

2 5

2 6

5 7

6 7
```

### 输出

```
4
```



---

---
title: "[ABC212D] Querying Multiset"
layout: "post"
diff: 普及/提高-
pid: AT_abc212_d
tag: []
---

# [ABC212D] Querying Multiset

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc212/tasks/abc212_d

高橋君は何も書かれていないたくさんのボールと $ 1 $ つの袋を持っています。 最初、袋は空で、高橋君は $ Q $ 回の操作を行います。 それぞれの操作は以下の $ 3 $ 種類のうちのいずれかです。

- 操作 $ 1 $ : まだ何も書かれていないボール $ 1 $ つに整数 $ X_i $ を書き込み、袋に入れる。
- 操作 $ 2 $ : 袋に入っているすべてのボールについて、そこに書かれている数を、それに $ X_i $ を加えたものに書き換える。
- 操作 $ 3 $ : 袋に入っているボールのうち書かれている数が最小のもの（複数ある場合はそのうちの $ 1 $ つ）を取り出し、そこに書かれている数を記録する。その後、そのボールを捨てる。

$ 1\leq\ i\leq\ Q $ について $ i $ 回目の操作の種類 $ P_i $ および操作 $ 1 $ , $ 2 $ における $ X_i $ の値が与えられるので、操作 $ 3 $ において記録された数を順に出力してください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ Q $ $ query_1 $ $ query_2 $ $ : $ $ query_Q $

$ 2 $ 行目から $ Q+1 $ 行目の各 $ query_i $ は次のいずれかの形で与えられる。

> $ 1 $ $ X_i $

> $ 2 $ $ X_i $

> $ 3 $

まず、$ 1\leq\ P_i\leq\ 3 $ が与えられる。これは操作の種類を表す。 $ P_i=1 $ または $ P_i=2 $ ならば、その後に空白区切りで $ X_i $ が与えられる。

## 输出格式

$ Q $ 回の操作のうち操作の種類が $ P_i=3 $ であるような各操作について、記録された数を改行区切りで出力せよ。

## 说明/提示

### 制約

- $ 1\ \leq\ Q\ \leq\ 2\times\ 10^5 $
- $ 1\ \leq\ P_i\ \leq\ 3 $
- $ 1\ \leq\ X_i\ \leq\ 10^9 $
- 入力は全て整数である。
- $ P_i=3 $ であるような $ i $ が $ 1 $ つ以上存在する。
- $ P_i=3 $ であるとき、 $ i $ 回目の操作の直前の時点で、袋には $ 1 $ つ以上のボールが入っている。

### Sample Explanation 1

高橋君は次のように操作を行います。 - $ 3 $ の書かれたボールを袋に入れる。 - $ 5 $ の書かれたボールを袋に入れる。 - 今、袋には $ 3 $ の書かれたボールと $ 5 $ の書かれたボールが入っているため、このうち小さい $ 3 $ の書かれたボールを取り出し、 $ 3 $ を記録した後に捨てる。 - 今、袋には $ 5 $ の書かれたボールのみが入っているため、この数を $ 5+2=7 $ に書き換える。 - 今、袋には $ 7 $ の書かれたボールのみが入っているため、このボールを取り出し、 $ 7 $ を記録した後に捨てる。 よって、記録された順に $ 3 $ , $ 7 $ を出力します。

### Sample Explanation 2

答えが $ 32 $ bit整数に収まらないことがある事に注意してください。

## 样例 #1

### 输入

```
5

1 3

1 5

3

2 2

3
```

### 输出

```
3

7
```

## 样例 #2

### 输入

```
6

1 1000000000

2 1000000000

2 1000000000

2 1000000000

2 1000000000

3
```

### 输出

```
5000000000
```



---

---
title: "[ABC213D] Takahashi Tour"
layout: "post"
diff: 普及/提高-
pid: AT_abc213_d
tag: []
---

# [ABC213D] Takahashi Tour

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc213/tasks/abc213_d

AtCoder 国には $ 1 $ から $ N $ の番号がついた $ N $ 個の都市と、$ 1 $ から $ N-1 $ の番号がついた $ N-1 $ 個の道路があります。  
 道路 $ i $ を通ると都市 $ A_i $ と都市 $ B_i $ の間を相互に移動することができます。全ての都市は道路を使って互いに行き来できることが保証されます。

高橋くんは都市 $ 1 $ を出発し、次のルールで旅をします。

- いまいる都市と道路で直接つながっている都市のうち、まだ訪れたことがない都市が存在するとき、そのような都市のうち番号が最も小さい都市へ移動する
- そのような都市が存在しないとき
  - いまいる都市が都市 $ 1 $ なら旅を終了する
  - そうでないなら、いまいる都市を初めて訪れたときに直前にいた都市へ移動する

高橋くんが旅の過程で訪れる都市を順に答えてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ A_1 $ $ B_1 $ $ \vdots $ $ A_{N-1} $ $ B_{N-1} $

## 输出格式

高橋くんが訪れる都市を、旅の開始時及び終了時の都市 $ 1 $ も含めて順に空白区切りで出力せよ。

## 说明/提示

### 制約

- $ 2\ \leq\ N\ \leq\ 2\times\ 10^5 $
- $ 1\leq\ A_i,B_i\ \leq\ N $
- 全ての都市は道路を使って互いに行き来できる

### Sample Explanation 1

高橋くんの旅は次のようになります。 - 最初都市 $ 1 $ にいます。 - 都市 $ 1 $ から道路で直接つながっている都市のうち未訪問なのは都市 $ 2,3 $ です。番号が小さい都市 $ 2 $ へ移動します。 - 都市 $ 2 $ から道路で直接つながっている都市のうち未訪問なのは都市 $ 4 $ です。都市 $ 4 $ へ移動します。 - 都市 $ 4 $ から道路で直接つながっている都市のうち未訪問の都市はありません。直前にいた都市 $ 2 $ へ移動します。 - 都市 $ 2 $ から道路で直接つながっている都市のうち未訪問の都市はありません。初めて都市 $ 2 $ に来る直前にいた都市 $ 1 $ へ移動します。 - 都市 $ 1 $ から道路で直接つながっている都市のうち未訪問なのは都市 $ 3 $ です。都市 $ 3 $ へ移動します。 - 都市 $ 3 $ から道路で直接つながっている都市のうち未訪問の都市はありません。直前にいた都市 $ 1 $ へ移動します。 - 都市 $ 1 $ から道路で直接つながっている都市のうち未訪問の都市はありません。旅を終了します。

## 样例 #1

### 输入

```
4

1 2

4 2

3 1
```

### 输出

```
1 2 4 2 1 3 1
```

## 样例 #2

### 输入

```
5

1 2

1 3

1 4

1 5
```

### 输出

```
1 2 1 3 1 4 1 5 1
```



---

---
title: "[ABC215D] Coprime 2"
layout: "post"
diff: 普及/提高-
pid: AT_abc215_d
tag: []
---

# [ABC215D] Coprime 2

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc215/tasks/abc215_d

長さ $ N $ の正整数列 $ A=(A_1,A_2,\dots,A_N) $ が与えられるので、以下の条件を満たす $ 1 $ 以上 $ M $ 以下の整数 $ k $ を全て求めてください。

- 全ての $ 1\ \le\ i\ \le\ N $ を満たす整数 $ i $ について、 $ \gcd(A_i,k)=1 $ である。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ M $ $ A_1 $ $ A_2 $ $ \dots $ $ A_N $

## 输出格式

$ 1 $ 行目に、出力する整数の数 $ x $ を出力せよ。  
 続く $ x $ 行に、答えとなる整数を小さい方から順に $ 1 $ 行に $ 1 $ つずつ出力せよ。

## 说明/提示

### 制約

- 入力は全て整数
- $ 1\ \le\ N,M\ \le\ 10^5 $
- $ 1\ \le\ A_i\ \le\ 10^5 $

### Sample Explanation 1

例えば、 $ 7 $ は $ \gcd(6,7)=1,\gcd(1,7)=1,\gcd(5,7)=1 $ を満たすので答えとなる整数の集合に含まれます。 一方、 $ 9 $ は $ \gcd(6,9)=3 $ となるため、答えとなる整数の集合に含まれません。 条件を満たす $ 1 $ 以上 $ 12 $ 以下の整数は $ 1,7,11 $ の $ 3 $ つです。これらを小さい方から出力することに注意してください。

## 样例 #1

### 输入

```
3 12

6 1 5
```

### 输出

```
3

1

7

11
```



---

---
title: "[ABC216D] Pair of Balls"
layout: "post"
diff: 普及/提高-
pid: AT_abc216_d
tag: []
---

# [ABC216D] Pair of Balls

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc216/tasks/abc216_d

$ 2N $ 個のボールがあります。各ボールには $ 1 $ 以上 $ N $ 以下の整数によって表される色が塗られており、各色で塗られたボールはちょうど $ 2 $ 個ずつ存在します。

これらのボールが、底が地面と平行になるように置かれた $ M $ 本の筒に入れられています。はじめ、$ i\ (1\ \leq\ i\ \leq\ M) $ 本目の筒には $ k_i $ 個のボールが入っており、上から $ j\ (1\ \leq\ j\ \leq\ k_i) $ 番目のボールの色は $ a_{i,\ j} $ です。

あなたの目標は、以下の操作を繰り返すことで $ M $ 本の筒全てを空にすることです。

- 異なる $ 2 $ 本の空でない筒を選び、それぞれの筒の一番上にあるボールを取り出して捨てる。ここで、取り出して捨てた $ 2 $ つのボールは同じ色で塗られている必要がある。

目標が達成可能かを判定してください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ M $ $ k_1 $ $ a_{1,1} $ $ a_{1,2} $ $ \ldots $ $ a_{1,k_1} $ $ k_2 $ $ a_{2,1} $ $ a_{2,2} $ $ \ldots $ $ a_{2,k_2} $ $ \hspace{2.1cm}\vdots $ $ k_M $ $ a_{M,1} $ $ a_{M,2} $ $ \ldots $ $ a_{M,k_M} $

## 输出格式

目標が達成可能なら `Yes` を、達成不可能なら `No` を出力せよ。

## 说明/提示

### 制約

- $ 1\ \leq\ N\ \leq\ 2\ \times\ 10^5 $
- $ 2\ \leq\ M\ \leq\ 2\ \times\ 10^5 $
- $ 1\ \leq\ k_i\ (1\ \leq\ i\ \leq\ M) $
- $ 1\ \leq\ a_{i,j}\ \leq\ N\ (1\ \leq\ i\ \leq\ M,1\ \leq\ j\ \leq\ k_i) $
- $ \sum_{i=1}^{M}\ k_i\ =\ 2N $
- 全ての $ x\ (1\ \leq\ x\ \leq\ N) $ について、$ 1\ \leq\ i\ \leq\ M $ かつ $ 1\ \leq\ j\ \leq\ k_i $ かつ $ a_{i,j}=x $ なる整数の組 $ (i,j) $ はちょうど $ 2 $ つ存在する
- 入力は全て整数

### Sample Explanation 1

以下のように操作を行えばよいです。 1. $ 1 $ つ目の筒と $ 2 $ つ目の筒を選び、それぞれの筒の一番上にあるボールを取り出して捨てる。捨てられるボールの色は共に $ 1 $ であり等しいので、この操作は有効である。 2. $ 1 $ つ目の筒と $ 2 $ つ目の筒を選び、それぞれの筒の一番上にあるボールを取り出して捨てる。捨てられるボールの色は共に $ 2 $ であり等しいので、この操作は有効である。

### Sample Explanation 2

そもそも一度も操作を行うことができないため、目標を達成する、すなわち $ M $ 本の筒全てを空にすることは不可能です。

## 样例 #1

### 输入

```
2 2

2

1 2

2

1 2
```

### 输出

```
Yes
```

## 样例 #2

### 输入

```
2 2

2

1 2

2

2 1
```

### 输出

```
No
```



---

---
title: "[ABC216E] Amusement Park"
layout: "post"
diff: 普及/提高-
pid: AT_abc216_e
tag: []
---

# [ABC216E] Amusement Park

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc216/tasks/abc216_e

髙橋君は遊園地に遊びに行きました。  
 この遊園地には $ N $ 個のアトラクションがあり、$ i $ 個目のアトラクションの「楽しさ」の初期値は $ A_i $ です。

髙橋君が $ i $ 個目のアトラクションに乗ると、以下の現象が順番に起きます。

- 髙橋君の「満足度」に、$ i $ 個目のアトラクションの現在の「楽しさ」が加算される。
- $ i $ 個目のアトラクションの「楽しさ」が、$ 1 $ 減少する。

髙橋君の「満足度」の初期値は $ 0 $ です。髙橋君はアトラクションに合計 $ K $ 回まで乗ることができます。  
 最終的な髙橋君の「満足度」の最大値はいくつですか？

なお、髙橋君の「満足度」はアトラクションに乗ること以外で変化しません。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ K $ $ A_1 $ $ A_2 $ $ \dots $ $ A_N $

## 输出格式

最終的な髙橋君の「満足度」の最大値を出力せよ。

## 说明/提示

### 制約

- $ 1\ \leq\ N\ \leq\ 10^5 $
- $ 1\ \leq\ K\ \leq\ 2\ \times\ 10^9 $
- $ 1\ \leq\ A_i\ \leq\ 2\ \times\ 10^9 $
- 入力は全て整数

### Sample Explanation 1

$ 1 $ 個目のアトラクションに $ 2 $ 回、$ 3 $ 個目のアトラクションに $ 3 $ 回乗ります。 最終的な「満足度」は、$ (100+99)+(102+101+100)=502 $ です。 「満足度」を $ 503 $ 以上にする方法はないので、$ 502 $ が答えになります。

### Sample Explanation 2

アトラクションに乗る合計回数は、$ K $ 回より少なくても構いません。

## 样例 #1

### 输入

```
3 5

100 50 102
```

### 输出

```
502
```

## 样例 #2

### 输入

```
2 2021

2 3
```

### 输出

```
9
```



---

---
title: "[ABC217D] Cutting Woods"
layout: "post"
diff: 普及/提高-
pid: AT_abc217_d
tag: []
---

# [ABC217D] Cutting Woods

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc217/tasks/abc217_d

長さ $ L $ メートルの直線状の木材があります。  
 $ x\ =\ 1,\ 2,\ \dots,\ L\ -\ 1 $ に対して、木材の左端から $ x $ メートルの地点には目印として線 $ x $ が引かれています。

$ Q $ 個のクエリが与えられます。 $ i $ 番目のクエリは数の組 $ (c_i,\ x_i) $ によって表されます。  
 以下の説明に従ってクエリを $ i $ の昇順に処理してください。

- $ c_i\ =\ 1 $ のとき : 線 $ x_i $ がある地点で木材を $ 2 $ つに切る。
- $ c_i\ =\ 2 $ のとき : 線 $ x_i $ を含む木材を選び、その長さを出力する。

ただし $ c_i\ =\ 1,\ 2 $ の両方に対して、線 $ x_i $ はクエリを処理する時点で切られていないことが保証されます。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ L $ $ Q $ $ c_1 $ $ x_1 $ $ c_2 $ $ x_2 $ $ \vdots $ $ c_Q $ $ x_Q $

## 输出格式

$ c_i\ =\ 2 $ を満たすクエリの回数と等しい行数だけ出力せよ。 $ j $ 行目では $ j $ 番目のそのようなクエリに対する答えを出力せよ。

## 说明/提示

### 制約

- $ 1\ \leq\ L\ \leq\ 10^9 $
- $ 1\ \leq\ Q\ \leq\ 2\ \times\ 10^5 $
- $ c_i\ =\ 1,\ 2 $ $ (1\ \leq\ i\ \leq\ Q) $
- $ 1\ \leq\ x_i\ \leq\ L\ -\ 1 $ $ (1\ \leq\ i\ \leq\ Q) $
- 全ての $ i $ $ (1\ \leq\ i\ \leq\ Q) $ に対して次が成り立つ: $ 1\ \leq\ j\ \lt\ i $ かつ $ (c_j,x_j)\ =\ (1,\ x_i) $ を満たす $ j $ は存在しない。
- 入力は全て整数である。

### Sample Explanation 1

$ 1 $ 番目のクエリ時点では木材は一度も切られていないので、線 $ 2 $ を含む木材の長さは $ 5 $ メートルです。よって $ 5 $ を出力します。 $ 2 $ 番目のクエリによって、木材は $ 3 $ メートルの木材と $ 2 $ メートルの木材に分割されます。 $ 3 $ 番目のクエリ時点では 線 $ 2 $ を含む木材の長さは $ 3 $ メートルなので、$ 3 $ を出力します。

## 样例 #1

### 输入

```
5 3

2 2

1 3

2 2
```

### 输出

```
5

3
```

## 样例 #2

### 输入

```
5 3

1 2

1 4

2 3
```

### 输出

```
2
```

## 样例 #3

### 输入

```
100 10

1 31

2 41

1 59

2 26

1 53

2 58

1 97

2 93

1 23

2 84
```

### 输出

```
69

31

6

38

38
```



---

---
title: "[ABC217E] Sorting Queries"
layout: "post"
diff: 普及/提高-
pid: AT_abc217_e
tag: []
---

# [ABC217E] Sorting Queries

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc217/tasks/abc217_e

空の列 $ A $ があります。クエリが $ Q $ 個与えられるので、与えられた順番に処理してください。  
 クエリは次の $ 3 $ 種類のいずれかです。

- `1 x` : $ A $ の最後尾に $ x $ を追加する。
- `2` : $ A $ の最初の要素を出力する。その後、その要素を削除する。このクエリが与えられるとき、$ A $ は空でないことが保証される。
- `3` : $ A $ を昇順にソートする。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ Q $ $ \mathrm{query}\ 1 $ $ \mathrm{query}\ 2 $ $ \vdots $ $ \mathrm{query}\ Q $

$ i $ 番目のクエリ $ \mathrm{query}\ i $ では、まずクエリの種類 $ c_i $（ $ 1,\ 2,\ 3 $ のいずれか）が与えられる。 $ c_i\ =\ 1 $ の場合はさらに整数 $ x $ が追加で与えられる。

すなわち、各クエリは以下に示す $ 3 $ つの形式のいずれかである。

> $ 1 $ $ x $

> $ 2 $

> $ 3 $

## 输出格式

$ c_i\ =\ 2 $ を満たすクエリの回数を $ q $ として $ q $ 行出力せよ。  
 $ j $ $ (1\ \leq\ j\ \leq\ q) $ 行目では $ j $ 番目のそのようなクエリに対する答えを出力せよ。

## 说明/提示

### 制約

- $ 1\ \leq\ Q\ \leq\ 2\ \times\ 10^5 $
- $ 0\ \leq\ x\ \leq\ 10^9 $
- クエリ `2` が与えられるとき、$ A $ は空でない。
- 入力は全て整数である。

### Sample Explanation 1

入力例 $ 1 $ において、 $ i $ 番目のクエリを処理した後の $ A $ の状態を $ i $ 行目に示すと以下のようになります。 - $ (4) $ - $ (4,\ 3) $ - $ (4,\ 3,\ 2) $ - $ (4,\ 3,\ 2,\ 1) $ - $ (1,\ 2,\ 3,\ 4) $ - $ (2,\ 3,\ 4) $ - $ (2,\ 3,\ 4,\ 0) $ - $ (3,\ 4,\ 0) $

### Sample Explanation 2

入力例 $ 2 $ において、 $ i $ 番目のクエリを処理した後の $ A $ の状態を $ i $ 行目に示すと以下のようになります。 - $ (5) $ - $ (5,\ 5) $ - $ (5,\ 5,\ 3) $ - $ (5,\ 3) $ - $ (3,\ 5) $ - $ (5) $ - $ (5,\ 6) $ - $ (5,\ 6) $ - $ (6) $

## 样例 #1

### 输入

```
8

1 4

1 3

1 2

1 1

3

2

1 0

2
```

### 输出

```
1

2
```

## 样例 #2

### 输入

```
9

1 5

1 5

1 3

2

3

2

1 6

3

2
```

### 输出

```
5

3

5
```



---

---
title: "[ABC218C] Shapes"
layout: "post"
diff: 普及/提高-
pid: AT_abc218_c
tag: []
---

# [ABC218C] Shapes

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc218/tasks/abc218_c

$ 2 $ 次元グリッド上に $ 2 $ つの図形 $ S $ と $ T $ があります。グリッドは正方形のマスからなります。

$ S $ は $ N $ 行 $ N $ 列のグリッド内にあり、$ S_{i,j} $ が `#` であるようなマス全体からなります。  
 $ T $ も $ N $ 行 $ N $ 列のグリッド内にあり、$ T_{i,j} $ が `#` であるようなマス全体からなります。

$ S $ と $ T $ を $ 90 $ 度回転及び平行移動の繰り返しによって一致させることができるか判定してください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ S_{1,1}S_{1,2}\ldots\ S_{1,N} $ $ \vdots $ $ S_{N,1}S_{N,2}\ldots\ S_{N,N} $ $ T_{1,1}T_{1,2}\ldots\ T_{1,N} $ $ \vdots $ $ T_{N,1}T_{N,2}\ldots\ T_{N,N} $

## 输出格式

$ S $ と $ T $ を$ 90 $ 度回転及び平行移動の繰り返しによって一致させることができるとき `Yes` を、そうでないとき `No` を出力せよ。

## 说明/提示

### 制約

- $ 1\ \leq\ N\ \leq\ 200 $
- $ S,T $ は `#` と `.` のみからなる
- $ S,T $ は $ 1 $ つ以上 `#` を含む

### Sample Explanation 1

$ S $ を左回りに $ 90 $ 度回転させ、平行移動することで $ T $ に一致させることができます。

### Sample Explanation 2

$ 90 $ 度回転と平行移動の繰り返しによって一致させることはできません。

### Sample Explanation 3

$ S $ 及び $ T $ は連結とは限りません。

### Sample Explanation 4

回転や移動の操作は連結成分ごとにできるわけではなく、$ S,T $ 全体に対して行うことに注意してください。

## 样例 #1

### 输入

```
5

.....

..#..

.###.

.....

.....

.....

.....

....#

...##

....#
```

### 输出

```
Yes
```

## 样例 #2

### 输入

```
5

#####

##..#

#..##

#####

.....

#####

#..##

##..#

#####

.....
```

### 输出

```
No
```

## 样例 #3

### 输入

```
4

#...

..#.

..#.

....

#...

#...

..#.

....
```

### 输出

```
Yes
```

## 样例 #4

### 输入

```
4

#...

.##.

..#.

....

##..

#...

..#.

....
```

### 输出

```
No
```



---

---
title: "[ABC218D] Rectangles"
layout: "post"
diff: 普及/提高-
pid: AT_abc218_d
tag: []
---

# [ABC218D] Rectangles

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc218/tasks/abc218_d

$ 2 $ 次元平面上に $ N $ 個の相異なる点があり、$ 1,2,\ldots\ ,N $ の番号がついています。点 $ i\,(1\ \leq\ i\ \leq\ N) $ の座標は $ (x_i,y_i) $ です。

これらの点のうち $ 4 $ つを頂点とし、全ての辺が $ x $ 軸または $ y $ 軸に平行であるような長方形はいくつありますか？

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ x_1 $ $ y_1 $ $ x_2 $ $ y_2 $ $ \vdots $ $ x_N $ $ y_N $

## 输出格式

答えを出力せよ。

## 说明/提示

### 制約

- $ 4\ \leq\ N\ \leq\ 2000 $
- $ 0\ \leq\ x_i,\ y_i\ \leq\ 10^9 $
- $ (x_i,y_i)\ \neq\ (x_j,y_j) $ $ (i\ \neq\ j) $
- 入力は全て整数である。

### Sample Explanation 1

点 $ 1 $ 、点 $ 2 $ 、点 $ 3 $ 、点 $ 4 $ を頂点とする長方形、 点 $ 1 $ 、点 $ 2 $ 、点 $ 5 $ 、点 $ 6 $ を頂点とする長方形、 点 $ 3 $ 、点 $ 4 $ 、点 $ 5 $ 、点 $ 6 $ を頂点とする長方形 の合計 $ 3 $ つです。

## 样例 #1

### 输入

```
6

0 0

0 1

1 0

1 1

2 0

2 1
```

### 输出

```
3
```

## 样例 #2

### 输入

```
4

0 1

1 2

2 3

3 4
```

### 输出

```
0
```

## 样例 #3

### 输入

```
7

0 1

1 0

2 0

2 1

2 2

3 0

3 2
```

### 输出

```
1
```



---

---
title: "[ABC218E] Destruction"
layout: "post"
diff: 普及/提高-
pid: AT_abc218_e
tag: []
---

# [ABC218E] Destruction

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc218/tasks/abc218_e

$ N $ 頂点 $ M $ 辺の連結無向グラフがあります。  
 頂点には $ 1 $ から $ N $ の番号が、辺には $ 1 $ から $ M $ の番号がついており、辺 $ i $ は頂点 $ A_i $ と $ B_i $ を結んでいます。

高橋君は、このグラフから $ 0 $ 個以上の辺を取り除こうとしています。

辺 $ i $ を取り除くと、$ C_i\ \geq\ 0 $ のとき $ C_i $ の報酬を得、$ C_i\ <\ 0 $ のとき $ |C_i| $ の罰金を払います。

辺を取り除いたあともグラフが連結でなければならないとき、高橋君が得られる報酬の最大値を求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ M $ $ A_1 $ $ B_1 $ $ C_1 $ $ A_2 $ $ B_2 $ $ C_2 $ $ \vdots $ $ A_M $ $ B_M $ $ C_M $

## 输出格式

答えを出力せよ。

## 说明/提示

### 制約

- $ 2\ \leq\ N\ \leq\ 2\times\ 10^5 $
- $ N-1\ \leq\ M\ \leq\ 2\times\ 10^5 $
- $ 1\ \leq\ A_i,B_i\ \leq\ N $
- $ -10^9\ \leq\ C_i\ \leq\ 10^9 $
- 与えられるグラフは連結である
- 入力に含まれる値は全て整数である

### Sample Explanation 1

辺 $ 4,5 $ を取り除くことで合計 $ 4 $ の報酬を得られます。これより多くの報酬を得ることはできないため、答えは $ 4 $ となります。

### Sample Explanation 2

報酬が負であるような辺が存在することもあります。

### Sample Explanation 3

多重辺や自己ループが存在することもあります。

## 样例 #1

### 输入

```
4 5

1 2 1

1 3 1

1 4 1

3 2 2

4 2 2
```

### 输出

```
4
```

## 样例 #2

### 输入

```
3 3

1 2 1

2 3 0

3 1 -1
```

### 输出

```
1
```

## 样例 #3

### 输入

```
2 3

1 2 -1

1 2 2

1 1 3
```

### 输出

```
5
```



---

---
title: "[ABC219D] Strange Lunchbox"
layout: "post"
diff: 普及/提高-
pid: AT_abc219_d
tag: []
---

# [ABC219D] Strange Lunchbox

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc219/tasks/abc219_d

$ N $ 種類の弁当が、それぞれ $ 1 $ 個ずつ売られています。  
 $ i\ =\ 1,\ 2,\ \ldots,\ N $ について、$ i $ 種類目の弁当には $ A_i $ 個のたこ焼きと $ B_i $ 個のたい焼きが入っています。

高橋君は、 $ X $ 個以上のたこ焼きと $ Y $ 個以上のたい焼きを食べたいです。  
 高橋君がいくつかの弁当を選んで買うことで、 $ X $ 個以上のたこ焼きと $ Y $ 個以上のたい焼きを手に入れることが可能かどうか判定して下さい。また、可能な場合はそのために高橋君が購入しなければならない弁当の個数の最小値を求めて下さい。

各種類の弁当は $ 1 $ 個しか売られていないため、同じ種類の弁当を $ 2 $ 個以上購入することは出来ないことに注意して下さい。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ X $ $ Y $ $ A_1 $ $ B_1 $ $ A_2 $ $ B_2 $ $ \vdots $ $ A_N $ $ B_N $

## 输出格式

高橋君が $ X $ 個以上のたこ焼きと $ Y $ 個以上のたい焼きを手に入れることが不可能な場合は $ -1 $ を出力し、 可能な場合はそのために高橋君が購入しなければならない弁当の個数の最小値を出力せよ。

## 说明/提示

### 制約

- $ 1\ \leq\ N\ \leq\ 300 $
- $ 1\ \leq\ X,\ Y\ \leq\ 300 $
- $ 1\ \leq\ A_i,\ B_i\ \leq\ 300 $
- 入力はすべて整数

### Sample Explanation 1

高橋君は、$ 5 $ 個以上のたこ焼きと $ 6 $ 個以上のたい焼きを食べたいです。 高橋君は $ 2 $ 種類目の弁当と $ 3 $ 種類目の弁当を買うことで、 たこ焼きを $ 3\ +\ 2\ =\ 5 $ 個、たい焼きを $ 4\ +\ 3\ =\ 7 $ 個手に入れることができます。

### Sample Explanation 2

高橋君がたとえすべての弁当を買ったとしても、高橋君は $ 8 $ 個以上のたこ焼きと $ 8 $ 個以上のたい焼きを手に入れることが出来ません。 よって、$ -1 $ を出力します。

## 样例 #1

### 输入

```
3

5 6

2 1

3 4

2 3
```

### 输出

```
2
```

## 样例 #2

### 输入

```
3

8 8

3 4

2 3

2 1
```

### 输出

```
-1
```



---

---
title: "[ABC221D] Online games"
layout: "post"
diff: 普及/提高-
pid: AT_abc221_d
tag: []
---

# [ABC221D] Online games

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc221/tasks/abc221_d

あるオンラインゲームがあり、 $ N $ 人のプレイヤーが登録しています。  
 サービス開始日から $ 10^{100} $ 日を迎えた今日、 開発者である高橋君がログイン履歴を調べたところ、 $ i $ 番目のプレイヤーはサービス開始日を $ 1 $ 日目として、 $ A_i $ 日目から $ B_i $ 日間連続でログインし、 それ以外の日はログインしていなかったことが判明しました。 すなわち、$ i $ 番目のプレイヤーはサービス開始日から、$ A_i $ , $ A_i+1 $ , $ \ldots $ , $ A_i+B_i-1 $ 日目に、 かつそれらの日にのみログインしていたことが分かりました。  
 $ 1\leq\ k\leq\ N $ をみたす各整数 $ k $ について、 サービス開始日から今日までの間で、ちょうど $ k $ 人がログインしていた日数を答えてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ A_1 $ $ B_1 $ $ A_2 $ $ B_2 $ $ : $ $ A_N $ $ B_N $

## 输出格式

次のように空白区切りで $ N $ 個の整数を出力せよ。

> $ D_1 $ $ D_2 $ $ \cdots $ $ D_N $

ただし、 $ D_i $ はちょうど $ i $ 人がゲームにログインしていた日数を表す。

## 说明/提示

### 制約

- $ 1\ \leq\ N\ \leq\ 2\times\ 10^5 $
- $ 1\ \leq\ A_i\ \leq\ 10^9 $
- $ 1\ \leq\ B_i\ \leq\ 10^9 $
- 入力は全て整数である。

### Sample Explanation 1

$ 1 $ 番目のプレイヤーは $ 1 $ 日目と $ 2 $ 日目に、 $ 2 $ 番目のプレイヤーは $ 2 $ 日目と $ 3 $ 日目と $ 4 $ 日目に、 $ 3 $ 番目のプレイヤーは $ 3 $ 日目だけにログインしています。 よって、$ 1 $, $ 4 $ 日目には $ 1 $ 人が、$ 2 $, $ 3 $ 日目には $ 2 $ 人がログインしており、 それ以外の日は誰もログインしていない事が分かります。 答えはちょうど $ 1 $ 人がログインした日数が $ 2 $ 日、 ちょうど $ 2 $ 人がログインした日数が $ 2 $ 日、 ちょうど $ 3 $ 人がログインした日数が $ 0 $ 日となります。

### Sample Explanation 2

$ 2 $ 人以上のプレイヤーがちょうど同じ期間にログインしていることもあり得ます。

## 样例 #1

### 输入

```
3

1 2

2 3

3 1
```

### 输出

```
2 2 0
```

## 样例 #2

### 输入

```
2

1000000000 1000000000

1000000000 1000000000
```

### 输出

```
0 1000000000
```



---

---
title: "[ABC222D] Between Two Arrays"
layout: "post"
diff: 普及/提高-
pid: AT_abc222_d
tag: []
---

# [ABC222D] Between Two Arrays

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc222/tasks/abc222_d

長さ $ n $ の数列 $ S\ =\ (s_1,\ s_2,\ \dots,\ s_n) $ がすべての $ i $ $ (1\ \leq\ i\ \leq\ n\ -\ 1) $ に対して $ s_i\ \leq\ s_{i+1} $ を満たすとき、かつそのときに限り「数列 $ S $ は広義単調増加である」と呼びます。

広義単調増加な長さ $ N $ の整数列 $ A\ =\ (a_1,\ a_2,\ \dots,\ a_N),\ B\ =\ (b_1,\ b_2,\ \dots,\ b_N) $ が与えられます。  
 このとき、次の条件を満たす広義単調増加な長さ $ N $ の整数列 $ C\ =\ (c_1,\ c_2,\ \dots,\ c_N) $ を考えます。

- すべての $ i $ $ (1\ \leq\ i\ \leq\ N) $ に対して $ a_i\ \leq\ c_i\ \leq\ b_i $ が成り立つ。

整数列 $ C $ としてあり得る数列の個数を $ 998244353 $ で割ったあまりを求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ a_1 $ $ a_2 $ $ \dots $ $ a_N $ $ b_1 $ $ b_2 $ $ \dots $ $ b_N $

## 输出格式

$ C $ としてあり得る数列の個数を $ 998244353 $ で割ったあまりを出力せよ。

## 说明/提示

### 制約

- $ 1\ \leq\ N\ \leq\ 3000 $
- $ 0\ \leq\ a_i\ \leq\ b_i\ \leq\ 3000 $ $ (1\ \leq\ i\ \leq\ N) $
- 整数列 $ A,B $ は広義単調増加である。
- 入力はすべて整数である。

### Sample Explanation 1

$ C $ としてあり得る数列は次の $ 5 $ 個です。 - $ (1,\ 1) $ - $ (1,\ 2) $ - $ (1,\ 3) $ - $ (2,\ 2) $ - $ (2,\ 3) $ 数列 $ (2,\ 1) $ は広義単調増加でないため条件を満たさないことに注意してください。

### Sample Explanation 2

$ C $ としてあり得る数列は次の $ 1 $ 個です。 - $ (2,\ 2,\ 2) $

### Sample Explanation 3

個数を $ 998244353 $ で割ったあまりを求めることに注意してください。

## 样例 #1

### 输入

```
2

1 1

2 3
```

### 输出

```
5
```

## 样例 #2

### 输入

```
3

2 2 2

2 2 2
```

### 输出

```
1
```

## 样例 #3

### 输入

```
10

1 2 3 4 5 6 7 8 9 10

1 4 9 16 25 36 49 64 81 100
```

### 输出

```
978222082
```



---

---
title: "[ABC223D] Restricted Permutation"
layout: "post"
diff: 普及/提高-
pid: AT_abc223_d
tag: []
---

# [ABC223D] Restricted Permutation

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc223/tasks/abc223_d

$ (1,\ 2,\ \dots,\ N) $ を並び替えて得られる数列 $ P $ であって以下の条件を満たすもののうち、辞書順で最小のものを求めてください。

- $ i\ =\ 1,\ \dots,\ M $ に対し、$ P $ において $ A_i $ は $ B_i $ よりも先に現れる。

ただし、そのような $ P $ が存在しない場合は `-1` と出力してください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ M $ $ A_1 $ $ B_1 $ $ \vdots $ $ A_M $ $ B_M $

## 输出格式

答えを出力せよ。

## 说明/提示

### 制約

- $ 2\ \leq\ N\ \leq\ 2\ \times\ 10^5 $
- $ 1\ \leq\ M\ \leq\ 2\ \times\ 10^5 $
- $ 1\ \leq\ A_i,\ B_i\ \leq\ N $
- $ A_i\ \neq\ B_i $
- 入力は全て整数である。

### Sample Explanation 1

条件を満たす $ P $ は $ (2,\ 1,\ 3,\ 4),\ (2,\ 3,\ 1,\ 4),\ (2,\ 3,\ 4,\ 1),\ (3,\ 2,\ 1,\ 4),\ (3,\ 2,\ 4,\ 1) $ の $ 5 $ つです。これらのうち辞書順で最小のものは $ (2,\ 1,\ 3,\ 4) $ です。

### Sample Explanation 2

条件を満たす $ P $ は存在しません。

## 样例 #1

### 输入

```
4 3

2 1

3 4

2 4
```

### 输出

```
2 1 3 4
```

## 样例 #2

### 输入

```
2 3

1 2

1 2

2 1
```

### 输出

```
-1
```



---

---
title: "[ABC225D] Play Train"
layout: "post"
diff: 普及/提高-
pid: AT_abc225_d
tag: []
---

# [ABC225D] Play Train

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc225/tasks/abc225_d

高橋君は電車のおもちゃを連結させたり分離させたりして遊んでいます。  
 電車は $ N $ 個あり、電車 $ 1 $ 、電車 $ 2 $ 、$ \ldots $ 、電車 $ N $ と名前がついています。  
 はじめ電車どうしは連結しておらず全てバラバラです。

クエリが $ Q $ 個与えられるので、与えられた順番に処理してください。  
 クエリは次の $ 3 $ 種類のいずれかです。

- `1 x y` ：電車 $ x $ の後部と、電車 $ y $ の前部を連結させる。  
   以下のことが保証されます。
  
  
  - $ x\ \neq\ y $
  - クエリを処理する直前に、電車 $ x $ の後部と連結している電車は存在しない
  - クエリを処理する直前に、電車 $ y $ の前部と連結している電車は存在しない
  - クエリを処理する直前に、電車 $ x $ と電車 $ y $ は異なる連結成分に属する
- `2 x y` ：電車 $ x $ の後部と、電車 $ y $ の前部を分離させる。  
   以下のことが保証されます。
  
  
  - $ x\ \neq\ y $
  - クエリを処理する直前に、電車 $ x $ の後部と電車 $ y $ の前部は直接連結している
- `3 x` ：電車 $ x $ が含まれる連結成分に属する電車の番号を、**先頭から順番に**全て出力する。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ Q $ $ \mathrm{query}_1 $ $ \mathrm{query}_2 $ $ \vdots $ $ \mathrm{query}_Q $

$ i $ 番目のクエリ $ \mathrm{query}_i $ では、まずクエリの種類 $ c_i $（ $ 1,\ 2,\ 3 $ のいずれか）が与えられる。  
 $ c_i\ =\ 1,2 $ の場合は $ x,y $ が追加で与えられ、$ c_i\ =3 $ の場合は $ x $ が追加で与えられる。

すなわち、各クエリは以下に示す $ 3 $ つの形式のいずれかである。

> $ 1 $ $ x $ $ y $

> $ 2 $ $ x $ $ y $

> $ 3 $ $ x $

## 输出格式

ある $ c_i\ =\ 3 $ のタイプのクエリにおいて、出力すべき値が $ j_1,\ j_2,\ \ldots\ ,\ j_M $ であるとする。  
 このとき以下の形式で $ 1 $ 行に出力せよ。

> $ M $ $ j_1 $ $ j_2 $ $ \ldots $ $ j_M $

$ c_i\ =\ 3 $ のタイプのクエリの数を $ q $ として、$ q $ 行出力せよ。  
 $ k\ (1\ \leq\ k\ \leq\ q) $ 行目では $ k $ 番目のそのようなクエリに対する答えを出力せよ。

## 说明/提示

### 制約

- $ 2\ \leq\ N\ \leq\ 10^5 $
- $ 1\ \leq\ Q\ \leq\ 10^5 $
- $ 1\ \leq\ x\ \leq\ N $
- $ 1\ \leq\ y\ \leq\ N $
- 入力は全て整数
- クエリは全て問題文の条件を満たす
- `3 x` の形式のクエリで出力する電車の番号の個数の合計は $ 10^6 $ 以下

### Sample Explanation 1

$ \mathrm{query}_5 $ まで処理した時、電車は以下のようになっています。 この時、たとえば電車 $ 2 $ は、電車 $ 3,5,6,7 $ と同じ連結成分に属していますが、電車 $ 1,4 $ とは同じ連結成分に属していません。 !\[\](https://img.atcoder.jp/ghi/dbfd2666776e351752bba67e9b65fafa.png) $ \mathrm{query}_{11} $ まで処理した時、電車は以下のようになっています。 !\[\](https://img.atcoder.jp/ghi/dad814ca77ec58f31cb88c62b9825bef.png)

## 样例 #1

### 输入

```
7 14

1 6 3

1 4 1

1 5 2

1 2 7

1 3 5

3 2

3 4

3 6

2 3 5

2 4 1

1 1 5

3 2

3 4

3 6
```

### 输出

```
5 6 3 5 2 7

2 4 1

5 6 3 5 2 7

4 1 5 2 7

1 4

2 6 3
```



---

---
title: "[ABC226D] Teleportation"
layout: "post"
diff: 普及/提高-
pid: AT_abc226_d
tag: []
---

# [ABC226D] Teleportation

## 题目描述

AtCoder国家位于无限多的笛卡尔坐标上。

AtCoder国家有 $N$ 个城镇，编号为 $1,2,...,N$。

镇i位于点$(x_i,y_i)$，没有两个不同编号的镇可以在同一坐标上。
AtCoder国家有过渡魔法 (以下简称魔法）。

魔法由一对整数 $(a,b)$ 标识，如果你在点 $(x,y)$ 并使用魔法 $(a,b)$，你可以穿越到 $(x+a，y+b)$。

有一个伟大的魔术师（以下简称魔法师），他可以选择任何一对整数 $(a,b)$ 并学习魔术 $(a,b)$。 魔法师还可以学习任何数量的不同种类的魔法。

当他想用魔法从一个城市移动到另一个城市时，他决定学习一些魔法，这样他就可以对所有一对 $(i,j)$ 不同的城市进行以下操作。

在你所学的魔法中只选择一种类型的魔法时，就只能重复使用所选的魔法，从城市 $i$ 移动到城市 $j$。

为了满足上述条件，魔法师至少要学会多少种不同的魔法？

## 输入格式

第 1 行输入一个数 $N$.

第 2 行至第 N+1 行每行输入两个数 $x_i,y_i$

## 输出格式

输出大魔法师至少需要学习的魔法数。

## 样例 #1

### 输入

```
3

1 2

3 6

7 4
```

### 输出

```
6
```

## 样例 #2

### 输入

```
3

1 2

2 2

4 2
```

### 输出

```
2
```

## 样例 #3

### 输入

```
4

0 0

0 1000000000

1000000000 0

1000000000 1000000000
```

### 输出

```
8
```



---

---
title: "[ABC227C] ABC conjecture"
layout: "post"
diff: 普及/提高-
pid: AT_abc227_c
tag: []
---

# [ABC227C] ABC conjecture

## 题目描述

给出正整数 $ N $。

求 $ A\leq\ B\leq\ C $ 并且 $ ABC\leq\ N $ 的正整数对 $ (A,B,C) $ 的个数。

注意，在限制的条件下，保证答案小于 $ 2^{63}$。

## 输入格式

输入按以下格式：

> $ N $

## 输出格式

输出答案。

## 说明/提示

条件

- $ 1\ \leq\ N\ \leq\ 10^{11} $
- $ N $是整数

样例解释 $1$：

满足条件的组有 $5$ 组：$(1,1,1),(1,1,2),(1,1,3),(1,1,4),(1,2,2)$。

## 样例 #1

### 输入

```
4
```

### 输出

```
5
```

## 样例 #2

### 输入

```
100
```

### 输出

```
323
```

## 样例 #3

### 输入

```
100000000000
```

### 输出

```
5745290566750
```



---

---
title: "[ABC228D] Linear Probing"
layout: "post"
diff: 普及/提高-
pid: AT_abc228_d
tag: []
---

# [ABC228D] Linear Probing

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc228/tasks/abc228_d

$ N\ =\ 2^{20} $ 項からなる数列 $ A\ =\ (A_0,\ A_1,\ \dots,\ A_{N\ -\ 1}) $ があります。はじめ、全ての要素は $ -1 $ です。

$ Q $ 個のクエリを順番に処理してください。$ i\ \,\ (1\ \leq\ i\ \leq\ Q) $ 個目のクエリは $ t_i\ =\ 1 $ または $ t_i\ =\ 2 $ を満たす整数 $ t_i $ および整数 $ x_i $ で表され、内容は以下の通りです。

- $ t_i\ =\ 1 $ のとき、以下の処理を順番に行う。
  1. 整数 $ h $ を $ h\ =\ x_i $ で定める。
  2. $ A_{h\ \bmod\ N}\ \neq\ -1 $ である間、$ h $ の値を $ 1 $ 増やすことを繰り返す。この問題の制約下でこの操作が有限回で終了することは証明できる。
  3. $ A_{h\ \bmod\ N} $ の値を $ x_i $ で書き換える。
- $ t_i\ =\ 2 $ のとき、その時点での $ A_{x_i\ \bmod\ N} $ の値を出力する。

なお、整数 $ a,\ b $ に対し、$ a $ を $ b $ で割った余りを $ a\ \bmod\ b $ と表します。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ Q $ $ t_1 $ $ x_1 $ $ \vdots $ $ t_{Q} $ $ x_{Q} $

## 输出格式

$ t_i\ =\ 2 $ であるようなクエリに対し、それぞれ答えを $ 1 $ 行に出力せよ。そのようなクエリが $ 1 $ つ以上存在することは保証される。

## 说明/提示

### 制約

- $ 1\ \leq\ Q\ \leq\ 2\ \times\ 10^5 $
- $ t_i\ \in\ \{\ 1,\ 2\ \}\ \,\ (1\ \leq\ i\ \leq\ Q) $
- $ 0\ \leq\ x_i\ \leq\ 10^{18}\ \,\ (1\ \leq\ i\ \leq\ Q) $
- $ t_i\ =\ 2 $ であるような $ i\ \,\ (1\ \leq\ i\ \leq\ Q) $ が $ 1 $ つ以上存在する。
- 入力は全て整数である。

### Sample Explanation 1

$ x_1\ \bmod\ N\ =\ 1 $ であるので、$ 1 $ 番目のクエリによって $ A_1\ =\ 1048577 $ となります。 $ 2 $ 番目のクエリにおいて、はじめ $ h\ =\ x_2 $ ですが、$ A_{h\ \bmod\ N}\ =\ A_{1}\ \neq\ -1 $ であるので $ h $ の値を $ 1 $ 増やします。すると $ A_{h\ \bmod\ N}\ =\ A_{2}\ =\ -1 $ となるので、このクエリによって $ A_2\ =\ 1 $ となります。 $ 3 $ 番目のクエリにおいて、$ A_{x_3\ \bmod\ N}\ =\ A_{1}\ =\ 1048577 $ を出力します。 $ 4 $ 番目のクエリにおいて、$ A_{x_4\ \bmod\ N}\ =\ A_{3}\ =\ -1 $ を出力します。 この問題において $ N\ =\ 2^{20}\ =\ 1048576 $ は定数であり、入力では与えられないことに注意してください。

## 样例 #1

### 输入

```
4

1 1048577

1 1

2 2097153

2 3
```

### 输出

```
1048577

-1
```



---

---
title: "[ABC229D] Longest X"
layout: "post"
diff: 普及/提高-
pid: AT_abc229_d
tag: []
---

# [ABC229D] Longest X

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc229/tasks/abc229_d

`X` と `.` からなる文字列 $ S $ が与えられます。

$ S $ に対して、次の操作を $ 0 $ 回以上 $ K $ 回以下行うことができます。

- `.` を `X` に置き換える

操作後に、`X` を最大で何個連続させることができますか？

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ S $ $ K $

## 输出格式

答えを出力せよ。

## 说明/提示

### 制約

- $ 1\ \leq\ |S|\ \leq\ 2\ \times\ 10^5 $
- $ S $ の各文字は `X` または `.` である
- $ 0\ \leq\ K\ \leq\ 2\ \times\ 10^5 $
- $ K $ は整数である

### Sample Explanation 1

$ S $ の $ 7 $ 文字目と $ 9 $ 文字目の `.` を `X` に置き換えて `XX...XXXXX.` とすると、$ 6 $ 文字目から $ 10 $ 文字目で `X` が $ 5 $ 個連続しています。 `X` を $ 6 $ 個以上連続させることはできないので、答えは $ 5 $ です。

### Sample Explanation 2

操作を行う回数は $ 0 $ 回でも構いません。

## 样例 #1

### 输入

```
XX...X.X.X.

2
```

### 输出

```
5
```

## 样例 #2

### 输入

```
XXXX

200000
```

### 输出

```
4
```



---

---
title: "[ABC229E] Graph Destruction"
layout: "post"
diff: 普及/提高-
pid: AT_abc229_e
tag: []
---

# [ABC229E] Graph Destruction

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc229/tasks/abc229_e

$ N $ 頂点 $ M $ 辺の単純な無向グラフが与えられます。  
 辺 $ i $ は、頂点 $ A_i $ と $ B_i $ を結んでいます。

頂点 $ 1,2,\ldots,N $ を順番に消していきます。  
 なお、頂点 $ i $ を消すとは、頂点 $ i $ と、頂点 $ i $ に接続する全ての辺をグラフから削除することです。

$ i=1,2,\ldots,N $ について、頂点 $ i $ まで消した時にグラフはいくつの連結成分に分かれていますか？

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ M $ $ A_1 $ $ B_1 $ $ A_2 $ $ B_2 $ $ \vdots $ $ A_M $ $ B_M $

## 输出格式

$ N $ 行出力せよ。  
 $ i $ 行目には、頂点 $ i $ まで消した時のグラフの連結成分の数を出力せよ。

## 说明/提示

### 制約

- $ 1\ \leq\ N\ \leq\ 2\ \times\ 10^5 $
- $ 0\ \leq\ M\ \leq\ \min(\frac{N(N-1)}{2}\ ,\ 2\ \times\ 10^5\ ) $
- $ 1\ \leq\ A_i\ \lt\ B_i\ \leq\ N $
- $ i\ \neq\ j $ ならば $ (A_i,B_i)\ \neq\ (A_j,B_j) $
- 入力は全て整数である

### Sample Explanation 1

!\[\](https://img.atcoder.jp/ghi/3320212a9093132a80105bf02feeb195.png) グラフは上図のように変化していきます。

### Sample Explanation 2

はじめからグラフが非連結なこともあります。

## 样例 #1

### 输入

```
6 7

1 2

1 4

1 5

2 4

2 3

3 5

3 6
```

### 输出

```
1

2

3

2

1

0
```

## 样例 #2

### 输入

```
8 7

7 8

3 4

5 6

5 7

5 8

6 7

6 8
```

### 输出

```
3

2

2

1

1

1

1

0
```



---

---
title: "[ABC230D] Destroyer Takahashi"
layout: "post"
diff: 普及/提高-
pid: AT_abc230_d
tag: []
---

# [ABC230D] Destroyer Takahashi

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc230/tasks/abc230_d

$ N $ 行 $ 10^9 $ 列の格子状の区画に区切られた街に $ N $ 枚の壁があり、$ 1 $ から $ N $ までの番号が割り振られています。  
 壁 $ i $ は上から $ i $ 行目、左から $ L_i $ 列目から $ R_i $ 列目の範囲にあります。(入出力例 $ 1 $ の図も参考にしてください。)

高橋君は $ N $ 枚の壁をすべて破壊することにしました。  
 超人的な腕力を持つ高橋君は、$ 1 $ 回のパンチで連続する $ D $ 列にまとめてダメージを与えることができます。

- より厳密に言い換えると、$ 1 $ 以上 $ 10^9\ -\ D\ +\ 1 $ 以下の **整数** $ x $ を選んで、$ x $ 列目から $ x\ +\ D\ -\ 1 $ 列目に (一部でも) 存在するすべての破壊されていない壁にパンチによるダメージを与えることができます。

壁は一部分でもダメージを受けると、パンチの衝撃波により全体が木っ端みじんに破壊されてしまいます。  
 (入出力例 $ 1 $ の説明も参考にしてください。)

高橋君がすべての壁を破壊するには、少なくとも何回のパンチを放つ必要がありますか？

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ D $ $ L_1 $ $ R_1 $ $ L_2 $ $ R_2 $ $ \vdots $ $ L_N $ $ R_N $

## 输出格式

すべての壁を破壊するのに必要なパンチの最少回数を出力せよ。

## 说明/提示

### 制約

- $ 1\ \leq\ N\ \leq\ 2\ \times\ 10^5 $
- $ 1\ \leq\ D\ \leq\ 10^9 $
- $ 1\ \leq\ L_i\ \leq\ R_i\ \leq\ 10^9 $
- 入力はすべて整数である。

### Sample Explanation 1

入力例 $ 1 $ に対応する壁の配置を図示したものが下図です。 !\[image\](https://img.atcoder.jp/ghi/b7b9e6741514f51c6c0aac924589c9d2.png) たとえば次のようにパンチを放つことで、 $ 2 $ 回のパンチですべての壁を破壊することができます。(以下の説明では、$ a $ 列目から $ b $ 列目までの範囲を $ \lbrack\ a,\ b\ \rbrack $ と表記します。) - まず、 $ \lbrack\ 2,\ 4\ \rbrack $ にパンチを放つ。 $ \lbrack\ 2,\ 4\ \rbrack $ に存在する壁である壁 $ 1 $ と壁 $ 2 $ はダメージを受け、破壊される。 - 次に $ \lbrack\ 5,\ 7\rbrack $ にパンチを放つ。$ \lbrack\ 5,\ 7\rbrack $ に存在する壁 $ 3 $ はダメージを受け、破壊される。 また、次の方法でもすべての壁を $ 2 $ 回のパンチで破壊することができます。 - まず、$ \lbrack\ 7,\ 9\ \rbrack $ にパンチを放ち、壁 $ 2 $ と壁 $ 3 $ を破壊する。 - 次に、$ \lbrack\ 1,\ 3\ \rbrack $ にパンチを放ち、壁 $ 1 $ を破壊する。

### Sample Explanation 2

入出力例 $ 1 $ と比べると、壁 $ 3 $ の範囲が $ \lbrack\ 5,\ 9\ \rbrack $ から $ \lbrack\ 4,\ 9\ \rbrack $ に変わりました。 この場合は $ \lbrack\ 2,\ 4\ \rbrack $ にパンチを放つことで $ 1 $ 回ですべての壁を破壊できます。

## 样例 #1

### 输入

```
3 3

1 2

4 7

5 9
```

### 输出

```
2
```

## 样例 #2

### 输入

```
3 3

1 2

4 7

4 9
```

### 输出

```
1
```

## 样例 #3

### 输入

```
5 2

1 100

1 1000000000

101 1000

9982 44353

1000000000 1000000000
```

### 输出

```
3
```



---

---
title: "[ABC230E] Fraction Floor Sum"
layout: "post"
diff: 普及/提高-
pid: AT_abc230_e
tag: []
---

# [ABC230E] Fraction Floor Sum

## 题目描述

求 $\large{\sum\limits_{i=1}^N ⌊\frac{N}{i}⌋}$ 的值

## 输入格式

一行一个整数 $N$

## 输出格式

一行一个整数，你的答案

## 样例 #1

### 输入

```
3
```

### 输出

```
5
```

## 样例 #2

### 输入

```
10000000000
```

### 输出

```
231802823220
```



---

---
title: "[ABC231D] Neighbors"
layout: "post"
diff: 普及/提高-
pid: AT_abc231_d
tag: []
---

# [ABC231D] Neighbors

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc231/tasks/abc231_d

$ 1 $ から $ N $ の番号がついた $ N $ 人を横一列に並べる方法のうち、以下の形式の $ M $ 個の条件全てを満たすものが存在するか判定してください。

- 条件：人 $ A_i $ と人 $ B_i $ は隣り合っている

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ M $ $ A_1 $ $ B_1 $ $ \vdots $ $ A_M $ $ B_M $

## 输出格式

条件を満たす並べ方が存在するなら `Yes`、存在しないなら `No` と出力せよ。

## 说明/提示

### 制約

- $ 2\ \leq\ N\ \leq\ 10^5 $
- $ 0\ \leq\ M\ \leq\ 10^5 $
- $ 1\leq\ A_i\ <\ B_i\ \leq\ N $
- $ (A_i,B_i) $ は相異なる

### Sample Explanation 1

例えば $ 4,1,3,2 $ の順に並べることで全ての条件を満たすことができます。

### Sample Explanation 2

どのように並べても全ての条件を満たすことはできません。

## 样例 #1

### 输入

```
4 2

1 3

2 3
```

### 输出

```
Yes
```

## 样例 #2

### 输入

```
4 3

1 4

2 4

3 4
```

### 输出

```
No
```



---

---
title: "[ABC233D] Count Interval"
layout: "post"
diff: 普及/提高-
pid: AT_abc233_d
tag: []
---

# [ABC233D] Count Interval

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc233/tasks/abc233_d

長さ $ N $ の数列 $ A=(A_1,A_2,\ldots,A_N) $ と、整数 $ K $ が与えられます。

$ A $ の連続部分列のうち、要素の和が $ K $ になるものはいくつありますか？  
 すなわち、以下の条件を全て満たす整数の組 $ (l,r) $ はいくつありますか？

- $ 1\leq\ l\leq\ r\leq\ N $
- $ \displaystyle\sum_{i=l}^{r}A_i\ =\ K $

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ K $ $ A_1 $ $ A_2 $ $ \ldots $ $ A_N $

## 输出格式

答えを出力せよ。

## 说明/提示

### 制約

- $ 1\leq\ N\ \leq\ 2\times\ 10^5 $
- $ |A_i|\ \leq\ 10^9 $
- $ |K|\ \leq\ 10^{15} $
- 入力に含まれる値は全て整数である

### Sample Explanation 1

$ (l,r)=(1,2),(3,3),(2,6) $ の $ 3 $ 組が条件を満たします。

### Sample Explanation 2

条件を満たす $ (l,r) $ の組が $ 1 $ つも存在しないこともあります。

## 样例 #1

### 输入

```
6 5

8 -3 5 7 0 -4
```

### 输出

```
3
```

## 样例 #2

### 输入

```
2 -1000000000000000

1000000000 -1000000000
```

### 输出

```
0
```



---

---
title: "[ABC233E] Σ[k=0..10^100]floor(X／10^k)"
layout: "post"
diff: 普及/提高-
pid: AT_abc233_e
tag: []
---

# [ABC233E] Σ[k=0..10^100]floor(X／10^k)

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc233/tasks/abc233_e

$ \displaystyle\ \sum_{k=0}^{10^{100}}\ \left\ \lfloor\ \frac{X}{10^k}\ \right\ \rfloor $ を求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ X $

## 输出格式

答えを整数として出力せよ。  
 但し、たとえ答えが大きな整数であっても、求める答えを正確に整数として出力する必要がある。たとえば、 `2.33e+21` のような指数表記や、 `0523` のような先頭に不要な $ 0 $ を付けたような表記は許されない。

## 说明/提示

### 注釈

$ \lfloor\ A\ \rfloor $ は、 $ A $ の小数点以下を切り捨てた値を指します。

### 制約

- $ X $ は整数
- $ 1\ \le\ X\ <\ 10^{500000} $

### Sample Explanation 1

求める値は、 $ 1225+122+12+1+0+0+\dots+0=1360 $ となります。

### Sample Explanation 2

繰り上がりに注意してください。

### Sample Explanation 3

入力される値も出力すべき値も非常に大きくなる場合があります。

## 样例 #1

### 输入

```
1225
```

### 输出

```
1360
```

## 样例 #2

### 输入

```
99999
```

### 输出

```
111105
```

## 样例 #3

### 输入

```
314159265358979323846264338327950288419716939937510
```

### 输出

```
349065850398865915384738153697722542688574377708317
```



---

---
title: "[ABC234E] Arithmetic Number"
layout: "post"
diff: 普及/提高-
pid: AT_abc234_e
tag: []
---

# [ABC234E] Arithmetic Number

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc234/tasks/abc234_e

以下の条件を満たす正の整数 $ n $ を、 **等差数** と呼びます。

- ($ n $ を先頭に余計な $ 0 $ を付けずに $ 10 $ 進法で表記した際、) $ n $ の上から $ i $ 桁目を $ d_i $ とする。このとき、 $ n $ が $ k $ 桁の整数であったとすると、 $ (d_2-d_1)=(d_3-d_2)=\dots=(d_k-d_{k-1}) $ が成立する。
  - この条件は、「 数列 $ (d_1,d_2,\dots,d_k) $ が等差数列である」と言い換えることができる。
  - 但し、 $ n $ が $ 1 $ 桁の整数である時、 $ n $ は等差数であるものとする。

たとえば、 $ 234,369,86420,17,95,8,11,777 $ は等差数ですが、 $ 751,919,2022,246810,2356 $ は等差数ではありません。

等差数のうち、 $ X $ 以上で最小のものを求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ X $

## 输出格式

答えを整数として出力せよ。

## 说明/提示

### 制約

- $ X $ は $ 1 $ 以上 $ 10^{17} $ 以下の整数である

### Sample Explanation 1

$ 152 $ 以上で最小の等差数は $ 159 $ です。

### Sample Explanation 2

$ X $ 自身が等差数である場合もあります。

## 样例 #1

### 输入

```
152
```

### 输出

```
159
```

## 样例 #2

### 输入

```
88
```

### 输出

```
88
```

## 样例 #3

### 输入

```
8989898989
```

### 输出

```
9876543210
```



---

---
title: "[ABC235D] Multiply and Rotate"
layout: "post"
diff: 普及/提高-
pid: AT_abc235_d
tag: []
---

# [ABC235D] Multiply and Rotate

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc235/tasks/abc235_d

正の整数 $ a $ があります。また、黒板に $ 1 $ 個の数が $ 10 $ 進表記で書かれています。  
 黒板に現在書かれている数を $ x $ としたとき、高橋君は次のいずれかの操作を行い、黒板に書かれている数を変化させることができます。

- $ x $ を消し、 $ x $ を $ a $ 倍した数を $ 10 $ 進表記で新たに書きこむ。
- $ x $ を文字列とみなして、列の末尾の数字を文字列の先頭に移動させる。  
   ただし、この操作は $ x\ \geq\ 10 $ かつ $ x $ が $ 10 $ で割り切れないときにしか行えない。

たとえば $ a\ =\ 2,\ x\ =\ 123 $ であるとき、高橋君は次のいずれかの操作を行うことができます。

- $ x $ を消して、 $ x\ \times\ a\ =\ 123\ \times\ 2\ =\ 246 $ を新たに書きこむ。
- $ x $ を文字列とみなして、`123` の末尾の数字である `3` を先頭に移動させる。黒板に書かれている数は $ 123 $ から $ 312 $ に変化する。

はじめ、黒板には $ 1 $ が書かれています。書かれている数を $ N $ に変化させるには最小で何回の操作が必要ですか？ただし、どのように操作しても書かれている数を $ N $ に変化させられない場合は $ -1 $ を出力してください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ a $ $ N $

## 输出格式

答えを出力せよ。

## 说明/提示

### 制約

- $ 2\ \leq\ a\ \lt\ 10^6 $
- $ 2\ \leq\ N\ \lt\ 10^6 $
- 入力はすべて整数である。

### Sample Explanation 1

以下に説明する操作を行うことで、 黒板に書かれている数を $ 4 $ 回で $ 1 $ から $ 72 $ に変化させることができます。 - $ 1 $ つ目の操作を行う。黒板に書かれている数は $ 1\ \to\ 3 $ に変わる。 - $ 1 $ つ目の操作を行う。黒板に書かれている数は $ 3\ \to\ 9 $ に変わる。 - $ 1 $ つ目の操作を行う。黒板に書かれている数は $ 9\ \to\ 27 $ に変わる。 - $ 2 $ つ目の操作を行う。黒板に書かれている数は $ 27\ \to\ 72 $ に変わる。 $ 3 $ 回以下の操作で $ 72 $ に変化させることはできないため、答えは $ 4 $ になります。

### Sample Explanation 2

どのように操作しても黒板に書かれている数を $ 5 $ に変化させることはできません。

### Sample Explanation 3

適切に操作を選ぶことで、 $ 1\ \to\ 2\ \to\ 4\ \to\ 8\ \to\ 16\ \to\ 32\ \to\ 64\ \to\ 46\ \to\ 92\ \to\ 29\ \to\ 58\ \to\ 116\ \to\ 611 $ と $ 12 $ 回の操作で黒板に書かれている数を $ 611 $ に変化させることができ、これが最小です。

## 样例 #1

### 输入

```
3 72
```

### 输出

```
4
```

## 样例 #2

### 输入

```
2 5
```

### 输出

```
-1
```

## 样例 #3

### 输入

```
2 611
```

### 输出

```
12
```

## 样例 #4

### 输入

```
2 767090
```

### 输出

```
111
```



---

---
title: "[ABC236D] Dance"
layout: "post"
diff: 普及/提高-
pid: AT_abc236_d
tag: []
---

# [ABC236D] Dance

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc236/tasks/abc236_d

$ 1,\ 2,\ \ldots,\ 2N $ と番号づけられた $ 2N $ 人の人が舞踏会に参加します。 彼らは $ N $ 個の $ 2 $ 人組にわかれてダンスを踊ります。

$ 2 $ 人組を構成する人のうち、番号の小さい方の人が人 $ i $ 、番号の大きい方の人が人 $ j $ のとき、 その $ 2 $ 人組の「相性」は $ A_{i,\ j} $ です。  
 $ N $ 個の $ 2 $ 人組の相性がそれぞれ $ B_1,\ B_2,\ \ldots,\ B_N $ であるとき、 「舞踏会全体の楽しさ」はそれらのビットごとの排他的論理和である $ B_1\ \oplus\ B_2\ \oplus\ \cdots\ \oplus\ B_N $ です。

「 $ 2N $ 人の参加者が $ N $ 個の $ 2 $ 人組に分かれる方法」を自由に選べるとき、「舞踏会全体の楽しさ」としてあり得る最大値を出力してください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ A_{1,\ 2} $ $ A_{1,\ 3} $ $ A_{1,\ 4} $ $ \cdots $ $ A_{1,\ 2N} $ $ A_{2,\ 3} $ $ A_{2,\ 4} $ $ \cdots $ $ A_{2,\ 2N} $ $ A_{3,\ 4} $ $ \cdots $ $ A_{3,\ 2N} $ $ \vdots $ $ A_{2N-1,\ 2N} $

## 输出格式

舞踏会全体の楽しさとしてあり得る最大値を出力せよ。

## 说明/提示

### 制約

- $ 1\ \leq\ N\ \leq\ 8 $
- $ 0\ \leq\ A_{i,\ j}\ <\ 2^{30} $
- 入力はすべて整数

### Sample Explanation 1

人 $ i $ と人 $ j $ からなる $ 2 $ 人組を $ \lbrace\ i,\ j\rbrace $ で表します。 $ 4 $ 人が $ 2 $ 個の $ 2 $ 人組にわかれる方法は下記の $ 3 $ 通りです。 - $ \lbrace\ 1,\ 2\rbrace,\ \lbrace\ 3,\ 4\rbrace $ という $ 2 $ 組にわかれる。 このとき、舞踏会全体の楽しさは $ A_{1,\ 2}\ \oplus\ A_{3,\ 4}\ =\ 4\ \oplus\ 2\ =\ 6 $ です。 - $ \lbrace\ 1,\ 3\rbrace,\ \lbrace\ 2,\ 4\rbrace $ という $ 2 $ 組にわかれる。 このとき、舞踏会全体の楽しさは $ A_{1,\ 3}\ \oplus\ A_{2,\ 4}\ =\ 0\ \oplus\ 3\ =\ 3 $ です。 - $ \lbrace\ 1,\ 4\rbrace,\ \lbrace\ 2,\ 3\rbrace $ という $ 2 $ 組にわかれる。 このとき、舞踏会全体の楽しさは $ A_{1,\ 4}\ \oplus\ A_{2,\ 3}\ =\ 1\ \oplus\ 5\ =\ 4 $ です。 よって、舞踏会全体の楽しさとしてあり得る最大値は $ 6 $ です。

### Sample Explanation 2

人 $ 1 $ と人 $ 2 $ からなる $ 2 $ 人組のみが作られ、このときの舞踏会全体の楽しさは $ 5 $ です。

## 样例 #1

### 输入

```
2

4 0 1

5 3

2
```

### 输出

```
6
```

## 样例 #2

### 输入

```
1

5
```

### 输出

```
5
```

## 样例 #3

### 输入

```
5

900606388 317329110 665451442 1045743214 260775845 726039763 57365372 741277060 944347467

369646735 642395945 599952146 86221147 523579390 591944369 911198494 695097136

138172503 571268336 111747377 595746631 934427285 840101927 757856472

655483844 580613112 445614713 607825444 252585196 725229185

827291247 105489451 58628521 1032791417 152042357

919691140 703307785 100772330 370415195

666350287 691977663 987658020

1039679956 218233643

70938785
```

### 输出

```
1073289207
```



---

---
title: "[ABC237E] Skiing"
layout: "post"
diff: 普及/提高-
pid: AT_abc237_e
tag: []
---

# [ABC237E] Skiing

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc237/tasks/abc237_e

AtCoder スキー場には広場 $ 1 $ 、広場 $ 2 $ 、$ \ldots $ 、広場 $ N $ の $ N $ 個の広場があり、広場 $ i $ の標高は $ H_i $ です。 また、$ 2 $ つの広場を双方向に結ぶ $ M $ 本の坂があり、$ i $ $ (1\ \leq\ i\ \leq\ M) $ 本目の坂は広場 $ U_i $ と広場 $ V_i $ を双方向に結んでいます。どの $ 2 $ つの広場の間もいくつかの坂を使って移動することができます。

高橋君は坂を使うことによってのみ広場の間を移動でき、坂を通るごとに**楽しさ**が変化します。具体的には広場 $ X $ と広場 $ Y $ を直接結ぶ坂を使って広場 $ X $ から広場 $ Y $ まで移動したとき次のように楽しさが変化します。

- 広場 $ X $ が広場 $ Y $ より標高が真に高い場合、その標高差、すなわち $ H_X-H_Y $ だけ楽しさが**増加**する。
- 広場 $ X $ が広場 $ Y $ より標高が真に低い場合、その標高差の $ 2 $ 倍、すなわち $ 2(H_Y-H_X) $ だけ楽しさが**減少**する。
- 広場 $ X $ と広場 $ Y $ の標高が等しい場合、楽しさは変化しない。

楽しさは負の値になることもあります。

最初、高橋君は広場 $ 1 $ におり、楽しさは $ 0 $ です。 高橋君はいくつかの坂（ $ 0 $ 本でも良い）を移動した後に好きな広場で行動を終えることができるとしたとき、行動を終えた時点の高橋君の楽しさとしてありうる最大の値を求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ M $ $ H_1 $ $ H_2 $ $ \ldots $ $ H_N $ $ U_1 $ $ V_1 $ $ U_2 $ $ V_2 $ $ \vdots $ $ U_M $ $ V_M $

## 输出格式

答えを出力せよ。

## 说明/提示

### 制約

- $ 2\ \leq\ N\ \leq\ 2\times\ 10^5 $
- $ N-1\ \leq\ M\ \leq\ \min(\ 2\times\ 10^5,\frac{N(N-1)}{2}) $
- $ 0\ \leq\ H_i\leq\ 10^8 $ $ (1\ \leq\ i\ \leq\ N) $
- $ 1\ \leq\ U_i\ <\ V_i\ \leq\ N $ $ (1\ \leq\ i\ \leq\ M) $
- $ i\ \neq\ j $ ならば $ (U_i,V_i)\ \neq\ (U_j,\ V_j) $
- 入力はすべて整数である。
- どの $ 2 $ つの広場の間もいくつかの坂を使って移動することができる。

### Sample Explanation 1

広場 $ 1 $ $ \to $ 広場 $ 3 $ $ \to $ 広場 $ 4 $ と移動したとき、楽しさは次のように変化します。 - 広場 $ 1 $（標高 $ 10 $ ）から坂を使って広場 $ 3 $（標高 $ 12 $ ）へ移動します。楽しさは $ 2\times\ (12-10)=4 $ だけ減少し、$ 0-4=-4 $ になります。 - 広場 $ 3 $（標高 $ 12 $ ）から坂を使って広場 $ 4 $（標高 $ 5 $ ）へ移動します。楽しさは $ 12-5=7 $ だけ増加し、$ -4+7=3 $ になります。 ここで行動を終了したとき終了時の楽しさは $ 3 $ であり、このときが最大となります。

### Sample Explanation 2

一度も移動を行わない時、楽しさが最大となります。

## 样例 #1

### 输入

```
4 4

10 8 12 5

1 2

1 3

2 3

3 4
```

### 输出

```
3
```

## 样例 #2

### 输入

```
2 1

0 10

1 2
```

### 输出

```
0
```



---

---
title: "[ABC238D] AND and SUM"
layout: "post"
diff: 普及/提高-
pid: AT_abc238_d
tag: []
---

# [ABC238D] AND and SUM

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc238/tasks/abc238_d

$ T $ 個のテストケースについて、以下の問題を解いてください。

> 非負整数 $ a,s $ が与えられます。以下の条件を両方とも満たす非負整数の組 $ (x,y) $ は存在しますか？
> 
> - $ x\ \text{AND}\ y=a $
> - $ x+y=s $

 $ \text{AND} $ とは 非負整数 $ n,\ m $ の bit ごとの論理積 $ n\ \text{AND}\ m $ は、以下のように定義されます。

- $ n\ \text{AND}\ m $ を二進表記した際の $ 2^k\ \,\ (k\ \geq\ 0) $ の位の数は、$ n,\ m $ を二進表記した際の $ 2^k $ の位の数のうち**両方**が $ 1 $ であれば $ 1 $、そうでなければ $ 0 $ である。
 
 例えば、$ 4\ \text{AND}\ 6\ =\ 4 $ となります（二進表記すると: $ 100\ \text{AND}\ 110\ =\ 100 $）。

## 输入格式

入力は標準入力から与えられる。入力の $ 1 $ 行目は以下の形式である。

> $ T $

その後、 $ T $ 個のテストケースが続く。各テストケースは以下の形式で与えられる。

> $ a $ $ s $

## 输出格式

$ T $ 行出力せよ。$ i\ (1\ \leq\ i\ \leq\ T) $ 行目には、$ i $ 番目に与えられるテストケースについて問題文中の条件を両方とも満たす非負整数の組 $ (x,y) $ が存在するなら `Yes` を、存在しないなら `No` を出力せよ。

## 说明/提示

### 制約

- $ 1\ \leq\ T\ \leq\ 10^5 $
- $ 0\ \leq\ a,s\ \lt\ 2^{60} $
- 入力はすべて整数

### Sample Explanation 1

$ 1 $ 番目のテストケースにおいては、$ (x,y)=(3,5) $ などが条件を満たします。 $ 2 $ 番目のテストケースにおいては、条件を満たす非負整数の組 $ (x,y) $ は存在しません。

## 样例 #1

### 输入

```
2

1 8

4 2
```

### 输出

```
Yes

No
```

## 样例 #2

### 输入

```
4

201408139683277485 381410962404666524

360288799186493714 788806911317182736

18999951915747344 451273909320288229

962424162689761932 1097438793187620758
```

### 输出

```
No

Yes

Yes

No
```



---

---
title: "[ABC239E] Subtree K-th Max"
layout: "post"
diff: 普及/提高-
pid: AT_abc239_e
tag: []
---

# [ABC239E] Subtree K-th Max

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc239/tasks/abc239_e

$ N $ 頂点の根付き木があります。頂点には $ 1 $ から $ N $ の番号がついており、根は頂点 $ 1 $ です。  
 $ i $ 番目の辺は頂点 $ A_i $ と $ B_i $ を結んでいます。  
 頂点 $ i $ には整数 $ X_i $ が書かれています。

$ Q $ 個のクエリが与えられます。$ i $ 番目のクエリでは整数の組 $ (V_i,K_i) $ が与えられるので、次の問題に答えてください。

- 問題：頂点 $ V_i $ の部分木に含まれる頂点に書かれた整数のうち、大きい方から $ K_i $ 番目の値を求めよ

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ Q $ $ X_1 $ $ \ldots $ $ X_N $ $ A_1 $ $ B_1 $ $ \vdots $ $ A_{N-1} $ $ B_{N-1} $ $ V_1 $ $ K_1 $ $ \vdots $ $ V_Q $ $ K_Q $

## 输出格式

$ Q $ 行出力せよ。$ i $ 行目には $ i $ 番目のクエリに対する答えを出力せよ。

## 说明/提示

### 制約

- $ 2\ \leq\ N\ \leq\ 10^5 $
- $ 0\leq\ X_i\leq\ 10^9 $
- $ 1\leq\ A_i,B_i\leq\ N $
- $ 1\leq\ Q\ \leq\ 10^5 $
- $ 1\leq\ V_i\leq\ N $
- $ 1\leq\ K_i\leq\ 20 $
- 与えられるグラフは木である
- 頂点 $ V_i $ の部分木は頂点を $ K_i $ 個以上持つ
- 入力に含まれる値は全て整数である

### Sample Explanation 1

この入力において与えられる木は下図のようなものです。 !\[図\](https://img.atcoder.jp/ghi/e2bc1237d64f79f33181e6f54c9f7ce7.png) $ 1 $ 番目のクエリでは、頂点 $ 1 $ の部分木に含まれる頂点 $ 1,2,3,4,5 $ に書かれた数のうち大きい方から $ 2 $ 番目である $ 4 $ を出力します。 $ 2 $ 番目のクエリでは、頂点 $ 2 $ の部分木に含まれる頂点 $ 2,3,5 $ に書かれた数のうち大きい方から $ 1 $ 番目である $ 5 $ を出力します。

## 样例 #1

### 输入

```
5 2

1 2 3 4 5

1 4

2 1

2 5

3 2

1 2

2 1
```

### 输出

```
4

5
```

## 样例 #2

### 输入

```
6 2

10 10 10 9 8 8

1 4

2 1

2 5

3 2

6 4

1 4

2 2
```

### 输出

```
9

10
```

## 样例 #3

### 输入

```
4 4

1 10 100 1000

1 2

2 3

3 4

1 4

2 3

3 2

4 1
```

### 输出

```
1

10

100

1000
```



---

---
title: "[ABC240E] Ranges on Tree"
layout: "post"
diff: 普及/提高-
pid: AT_abc240_e
tag: []
---

# [ABC240E] Ranges on Tree

## 题目描述

### 题面简述

给出一个有 $N$ 个节点的树和其中的 $N-1$ 条树边（描述无向），其中我们规定节点编号为 $1,2,\cdots,N-1,N$，其中节点 $1$ 为树根。

你需要给予每一个节点 $i$ 一个闭区间 $[L_i,R_i]$，你需要保证一下性质。

- 虽然当 $L_i=R_i$ 的时候不满足闭区间书写规范，但是在本题中允许出现。

- $\forall_i,1\le L_i\le R_i$。

- 如果 $i$ 是 $j$ 的父亲节点，保证 $[L_j,R_j]\subseteq [L_i,R_i]$。

- 如果 $i,j$ 为兄弟节点（拥有相同的父亲节点），那么保证 $[L_i,R_i]\cap[L_j,R_j]=\varnothing$。

你需要保证你构造出的方案的 $\max\limits_{i=1}^{N} R_i$ 最小。

## 输入格式

如以下形式输入。

> $ N $ $ u_1 $ $ v_1 $ $ u_2 $ $ v_2 $ $ \vdots $ $ u_{N-1} $ $ v_{N-1} $

## 输出格式

如一下形式输出，对于每一组 $L_i$ 与 $R_i$ 之间需要空格，不同组之间用换行分开。

> $ L_1 $ $ R_1 $ $ L_2 $ $ R_2 $ $ \vdots $ $ L_N $ $ R_N $

@[_qingshu_](https://www.luogu.com.cn/user/602803) 译。

## 样例 #1

### 输入

```
3

2 1

3 1
```

### 输出

```
1 2

2 2

1 1
```

## 样例 #2

### 输入

```
5

3 4

5 4

1 2

1 4
```

### 输出

```
1 3

3 3

2 2

1 2

1 1
```

## 样例 #3

### 输入

```
5

4 5

3 2

5 2

3 1
```

### 输出

```
1 1

1 1

1 1

1 1

1 1
```



---

---
title: "[ABC241D] Sequence Query"
layout: "post"
diff: 普及/提高-
pid: AT_abc241_d
tag: []
---

# [ABC241D] Sequence Query

## 题目描述

# 题意简述
有一个空序列 $A$。给定 $Q$ 次操作，每次询问是以下三种之一：

>`1 x`：向 $A$ 中插入元素 $x$。
>
>`2 x k`：输出 $A$ 中所有 $\le x$ 的元素中的第 $k$ 大值。如果不存在输出 `-1`。
>
>`3 x k`：输出 $A$ 中所有 $\ge x$ 的元素中的第 $k$ 小值。如果不存在输出 `-1`。

## 输入格式

第一行包含一个整数 $Q$，接下来 $Q$ 行每行一次操作。
具体询问输入参考题意简述。

## 输出格式

对于操作 $2,3$，输出一个数表示答案。
Translated by @[tianbiandeshenghuo1](/user/714285)

## 说明/提示

>$1\le Q\le2\times10^5$。
>
>$1\le x\le10^{18}$。
>
>$1\le k\le5$。
>
>所有输入均为整数。

## 样例 #1

### 输入

```
11
1 20
1 10
1 30
1 20
3 15 1
3 15 2
3 15 3
3 15 4
2 100 5
1 1
2 100 5
```

### 输出

```
20
20
30
-1
-1
1
```



---

---
title: "[ABC241E] Putting Candies"
layout: "post"
diff: 普及/提高-
pid: AT_abc241_e
tag: []
---

# [ABC241E] Putting Candies

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc241/tasks/abc241_e

给你一个长度为 $ N $ 的数列$A $， $ A=(A_0,A_1,\ldots,A_{N-1}) $。 
 最初是空盘，高桥君会执行$K $次以下操作。

- 设盘子里有$ X $ 颗糖。每次在盘中放入$ A_{(X\bmod\ N)} $ 颗糖。 $ X\bmod\ N $ 表示 $ X $ 除以 $ N $ 的余数。

求$K$次后盘子里糖的颗数。

## 输入格式

输入以以下形式从标准输入给出:

> $ N $ $ K $ $ A_0 $ $ A_1 $ $ \ldots $ $ A_{N-1} $

## 输出格式

输出答案

## 说明/提示

### 制約

- $ 2\ \leq\ N\ \leq\ 2\times\ 10^5 $
- $ 1\ \leq\ K\ \leq\ 10^{12} $
- $ 1\ \leq\ A_i\leq\ 10^6 $
- 输入都是整数

## 样例 #1

### 输入

```
5 3

2 1 6 3 1
```

### 输出

```
11
```

## 样例 #2

### 输入

```
10 1000000000000

260522 914575 436426 979445 648772 690081 933447 190629 703497 47202
```

### 输出

```
826617499998784056
```



---

---
title: "[ABC242D] ABC Transform"
layout: "post"
diff: 普及/提高-
pid: AT_abc242_d
tag: []
---

# [ABC242D] ABC Transform

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc242/tasks/abc242_d

`A`, `B`, `C` のみからなる文字列 $ S $ が与えられます。

$ S^{(0)}:=S $ とし、$ i=1,2,3,\ldots $ について $ S^{(i)} $ を $ S^{(i-1)} $ の各文字を `A` → `BC`, `B` → `CA`, `C` → `AB` と同時に置き換えたものと定義します。

以下の $ Q $ 個のクエリに答えてください。$ i $ 個目のクエリの内容は以下の通りです。

- $ S^{(t_i)} $ の先頭から $ k_i $ 文字目を出力せよ。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ S $ $ Q $ $ t_1 $ $ k_1 $ $ t_2 $ $ k_2 $ $ \hspace{0.4cm}\vdots $ $ t_Q $ $ k_Q $

## 输出格式

$ Q $ 個のクエリを添字の昇順に、すなわち与えられる順に処理し、出力ごとに改行せよ。

## 说明/提示

### 制約

- $ S $ は `A`, `B`, `C` のみからなる長さ $ 1 $ 以上 $ 10^5 $ 以下の文字列
- $ 1\ \leq\ Q\ \leq\ 10^5 $
- $ 0\ \leq\ t_i\ \leq\ 10^{18} $
- $ 1\ \leq\ k_i\ \leq\ \min(10^{18},\ S^{(t_i)} $ の長さ$ ) $
- $ Q,\ t_i,\ k_i $ は整数

### Sample Explanation 1

$ S^{(0)}= $`ABC`, $ S^{(1)}= $`BCCAAB` です。 よって各クエリへの答えは順に `A`, `B`, `C`, `B` となります。

## 样例 #1

### 输入

```
ABC

4

0 1

1 1

1 3

1 6
```

### 输出

```
A

B

C

B
```

## 样例 #2

### 输入

```
CBBAACCCCC

5

57530144230160008 659279164847814847

29622990657296329 861239705300265164

509705228051901259 994708708957785197

176678501072691541 655134104344481648

827291290937314275 407121144297426665
```

### 输出

```
A

A

C

A

A
```



---

---
title: "[ABC243D] Moves on Binary Tree"
layout: "post"
diff: 普及/提高-
pid: AT_abc243_d
tag: []
---

# [ABC243D] Moves on Binary Tree

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc243/tasks/abc243_d

頂点数 $ 2^{10^{100}}-1 $ の完全二分木があり、頂点には $ 1,2,...,2^{10^{100}}-1 $ の番号がついています。  
 頂点 $ 1 $ が根であり、各 $ 1\leq\ i\ <\ 2^{10^{100}-1} $ について、頂点 $ i $ は 頂点 $ 2i $ を左の子、頂点 $ 2i+1 $ を右の子として持ちます。

高橋君は最初頂点 $ X $ におり、$ N $ 回移動を行います。移動は文字列 $ S $ により表され、$ i $ 回目の移動は次のように行います。

- $ S $ の $ i $ 番目の文字が `U` のとき、今いる頂点の親に移動する
- $ S $ の $ i $ 番目の文字が `L` のとき、今いる頂点の左の子に移動する
- $ S $ の $ i $ 番目の文字が `R` のとき、今いる頂点の右の子に移動する

$ N $ 回の移動後に高橋君がいる頂点の番号を求めてください。なお、答えが $ 10^{18} $ 以下になるような入力のみが与えられます。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ X $ $ S $

## 输出格式

答えを出力せよ。

## 说明/提示

### 制約

- $ 1\ \leq\ N\ \leq\ 10^6 $
- $ 1\ \leq\ X\ \leq\ 10^{18} $
- $ N,X $ は整数
- $ S $ は長さ $ N $ であり、`U`,`L`,`R` のみからなる
- 高橋君が根にいるとき、親に移動しようとすることはない
- 高橋君が葉にいるとき、子に移動しようとすることはない
- 高橋君が $ N $ 回の移動後にいる頂点の番号は $ 10^{18} $ 以下である

### Sample Explanation 1

完全二分木は次のような構造をしています。 !\[図\](https://img.atcoder.jp/ghi/9e199e154f481af436c8eaec9c487e2c.png) 各移動により、高橋君がいる頂点の番号は $ 2\ \to\ 1\ \to\ 3\ \to\ 6 $ と変化します。

### Sample Explanation 2

移動の途中過程において、高橋君がいる頂点の番号が $ 10^{18} $ を超えることもあります。

## 样例 #1

### 输入

```
3 2

URL
```

### 输出

```
6
```

## 样例 #2

### 输入

```
4 500000000000000000

RRUU
```

### 输出

```
500000000000000000
```

## 样例 #3

### 输入

```
30 123456789

LRULURLURLULULRURRLRULRRRUURRU
```

### 输出

```
126419752371
```



---

---
title: "[ABC244E] King Bombee"
layout: "post"
diff: 普及/提高-
pid: AT_abc244_e
tag: []
---

# [ABC244E] King Bombee

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc244/tasks/abc244_e

$ N $ 頂点 $ M $ 辺の単純無向グラフが与えられます。このグラフの頂点には $ 1 $ から $ N $ の番号が付けられており、辺には $ 1 $ から $ M $ の番号が付けられています。辺 $ i $ は頂点 $ U_i $ と頂点 $ V_i $ の間を結んでいます。

整数 $ K,\ S,\ T,\ X $ が与えられます。以下の条件を満たす数列 $ A\ =\ (A_0,\ A_1,\ \dots,\ A_K) $ は何通りありますか？

- $ A_i $ は $ 1 $ 以上 $ N $ 以下の整数
- $ A_0\ =\ S $
- $ A_K\ =\ T $
- 頂点 $ A_i $ と頂点 $ A_{i\ +\ 1} $ の間を直接結ぶ辺が存在する
- 数列 $ A $ の中に整数 $ X\ (X≠S,X≠T) $ は偶数回出現する ( $ 0 $ 回でも良い)

ただし、答えは非常に大きくなることがあるので、答えを $ 998244353 $ で割ったあまりを求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ M $ $ K $ $ S $ $ T $ $ X $ $ U_1 $ $ V_1 $ $ U_2 $ $ V_2 $ $ \vdots $ $ U_M $ $ V_M $

## 输出格式

答えを $ 998244353 $ で割ったあまりを出力せよ。

## 说明/提示

### 制約

- 入力は全て整数
- $ 2\ <\ =N\ <\ =2000 $
- $ 1\ <\ =M\ <\ =2000 $
- $ 1\ <\ =K\ <\ =2000 $
- $ 1\ <\ =S,T,X\ <\ =N $
- $ X≠S $
- $ X≠T $
- $ 1\ <\ =U_i\ <\ V_i\ <\ =N $
- $ i≠j $ ならば $ (U_i,\ V_i)≠(U_j,\ V_j) $

### Sample Explanation 1

\- $ (1,\ 2,\ 1,\ 2,\ 3) $ - $ (1,\ 2,\ 3,\ 2,\ 3) $ - $ (1,\ 4,\ 1,\ 4,\ 3) $ - $ (1,\ 4,\ 3,\ 4,\ 3) $ の $ 4 $ 個が条件を満たします。$ (1,\ 2,\ 3,\ 4,\ 3) $ や $ (1,\ 4,\ 1,\ 2,\ 3) $ は $ 2 $ が奇数回出現するため、条件を満たしません。

### Sample Explanation 2

グラフは連結であるとは限りません。

### Sample Explanation 3

$ 998244353 $ で割ったあまりを求めてください。

## 样例 #1

### 输入

```
4 4 4 1 3 2

1 2

2 3

3 4

1 4
```

### 输出

```
4
```

## 样例 #2

### 输入

```
6 5 10 1 2 3

2 3

2 4

4 6

3 6

1 5
```

### 输出

```
0
```

## 样例 #3

### 输入

```
10 15 20 4 4 6

2 6

2 7

5 7

4 5

2 4

3 7

1 7

1 4

2 9

5 10

1 3

7 8

7 9

1 6

1 2
```

### 输出

```
952504739
```



---

---
title: "[ABC245D] Polynomial division"
layout: "post"
diff: 普及/提高-
pid: AT_abc245_d
tag: []
---

# [ABC245D] Polynomial division

## 题目描述

现在有 $N$ 次多项式 $A（x）=A_Nx^N+A_{N-1}x^{N-1}+\cdots\ +A_1x+A_0$ 和 $M$ 次多项式 $B(x)=B_Mx^M+B_{M-1}x^{M-1}+\cdots\ +B_1x+B_0$。

其中，$A(x)、B(x)$ 中的每个系数都是绝对值小于等于 $100$ 的整数，并且最高的下一个系数不是 $0$。

定义它们的积为 $C(x)=A(x)B(x)=C_{N+M}x^{N+M}+C_{N+M-1}x^{N+M-1}+\cdots\ +C_1x+C_0$。

已知 $A_0,A_1,\ldots,\ A_N$ 和 $C_0,C_1,\ldots,\ C_{N+M}$，请求出 $B_0,B_1,\ldots,\ B_M$。

输入保证只有一种 $B_0,B_1,\ldots,\ B_M$。

## 输入格式

第一行输入 $N,M$；

第二行输入 $A_0,A_1,\ldots,A_{N-1}$；

第三行输入 $C_0,C_1,\ldots,C_{N+M}$。

## 输出格式

输出 $M+1$ 个整数 $B_0,B_1,\ldots,\ B_M$。

## 说明/提示

- $ 1\leq N<100 $

- $ 1\leq M<100 $

- $ |A_i|\leq100 $

- $ |C_i|\leq10^6 $

- $ A_N\neq0 $

- $ C_{N+M}\neq0 $

- 满足条件的 $B_0,B_1,\ldots,\ B_M$ 只有一个

## 样例 #1

### 输入

```
1 2

2 1

12 14 8 2
```

### 输出

```
6 4 2
```

## 样例 #2

### 输入

```
1 1

100 1

10000 0 -1
```

### 输出

```
100 -1
```



---

---
title: "[ABC246D] 2-variable Function"
layout: "post"
diff: 普及/提高-
pid: AT_abc246_d
tag: []
---

# [ABC246D] 2-variable Function

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc246/tasks/abc246_d

整数 $ N $ が与えられるので、以下の条件を全て満たす最小の整数 $ X $ を求めてください。

- $ X $ は $ N $ 以上である。
- 非負整数 $ (a,b) $ の組であって、 $ X=a^3+a^2b+ab^2+b^3 $ を満たすようなものが存在する。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $

## 输出格式

答えを整数として出力せよ。

## 说明/提示

### 制約

- $ N $ は整数
- $ 0\ \le\ N\ \le\ 10^{18} $

### Sample Explanation 1

$ 9\ \le\ X\ \le\ 14 $ であるようなどの整数 $ X $ についても、問題文中の条件を満たすような $ (a,b) $ は存在しません。 $ X=15 $ は $ (a,b)=(2,1) $ とすると問題文中の条件を満たします。

### Sample Explanation 2

$ N $ 自身が条件を満たすこともあります。

### Sample Explanation 3

入出力が $ 32 $bit 整数型に収まらない場合があります。

## 样例 #1

### 输入

```
9
```

### 输出

```
15
```

## 样例 #2

### 输入

```
0
```

### 输出

```
0
```

## 样例 #3

### 输入

```
999999999989449206
```

### 输出

```
1000000000000000000
```



---

---
title: "[ABC247E] Max Min"
layout: "post"
diff: 普及/提高-
pid: AT_abc247_e
tag: []
---

# [ABC247E] Max Min

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc247/tasks/abc247_e

長さ $ N $ の数列 $ A\ =\ (A_1,\ A_2,\ \dots,\ A_N) $ および整数 $ X,\ Y $ があります。 次の条件をすべて満たす整数の組 $ (L,\ R) $ の個数を求めてください。

- $ 1\ \leq\ L\ \leq\ R\ \leq\ N $
- $ A_L,\ A_{L+1},\ \dots,\ A_R $ の最大値は $ X $ であり、最小値は $ Y $ である。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ X $ $ Y $ $ A_1 $ $ A_2 $ $ \dots $ $ A_N $

## 输出格式

答えを出力せよ。

## 说明/提示

### 制約

- $ 1\ \leq\ N\ \leq\ 2\ \times\ 10^5 $
- $ 1\ \leq\ A_i\ \leq\ 2\ \times\ 10^5 $
- $ 1\ \leq\ Y\ \leq\ X\ \leq\ 2\ \times\ 10^5 $
- 入力される値はすべて整数である。

### Sample Explanation 1

条件を満たすのは $ (L,R)=(1,3),(1,4),(2,4),(3,4) $ の $ 4 $ 通りです。

### Sample Explanation 2

条件を満たす $ (L,R) $ は存在しません。

### Sample Explanation 3

$ X=Y $ である場合もあります。

## 样例 #1

### 输入

```
4 3 1
1 2 3 1
```

### 输出

```
4
```

## 样例 #2

### 输入

```
5 2 1
1 3 2 4 1
```

### 输出

```
0
```

## 样例 #3

### 输入

```
5 1 1
1 1 1 1 1
```

### 输出

```
15
```

## 样例 #4

### 输入

```
10 8 1
2 7 1 8 2 8 1 8 2 8
```

### 输出

```
36
```



---

---
title: "[ABC248C] Dice Sum"
layout: "post"
diff: 普及/提高-
pid: AT_abc248_c
tag: []
---

# [ABC248C] Dice Sum

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc248/tasks/abc248_c

長さ $ N $ の整数からなる数列 $ A=(A_1,\ldots,A_N) $ であって、以下の条件を全て満たすものは何通りありますか？

- $ 1\le\ A_i\ \le\ M $ $ (1\ \le\ i\ \le\ N) $
- $ \displaystyle\sum\ _{i=1}^N\ A_i\ \leq\ K $

ただし、答えは非常に大きくなることがあるので、答えを $ 998244353 $ で割った余りを求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ M $ $ K $

## 输出格式

答えを $ 998244353 $ で割った余りを出力せよ。

## 说明/提示

### 制約

- $ 1\ \leq\ N,\ M\ \leq\ 50 $
- $ N\ \leq\ K\ \leq\ NM $
- 入力は全て整数

### Sample Explanation 1

条件を満たす数列は以下の $ 6 $ つです。 - $ (1,1) $ - $ (1,2) $ - $ (1,3) $ - $ (2,1) $ - $ (2,2) $ - $ (3,1) $

### Sample Explanation 2

答えを $ 998244353 $ で割った余りを出力してください。

## 样例 #1

### 输入

```
2 3 4
```

### 输出

```
6
```

## 样例 #2

### 输入

```
31 41 592
```

### 输出

```
798416518
```



---

---
title: "[ABC248D] Range Count Query"
layout: "post"
diff: 普及/提高-
pid: AT_abc248_d
tag: []
---

# [ABC248D] Range Count Query

## 题目描述

给定一个长度为$N$的序列 $A=(A 
1
​	
 ,…,A 
N
​	
 )$ 
以及$Q$组询问，每组询问包括： $L,R,X$ 
三个整数。

请你求出在 $A 
L
​	
 , …,A 
R
​	
$
中，值等于 $X$ 的数有多少个。

## 输入格式

第一行一个正整数 $N$。

第二行一共 $N$ 个数，表示序列 $A$。

第三行一个正整数 $Q$。

之后$Q$行，每行$3$个整数 $L,R,X$。

## 输出格式

对于每一组询问，输出一个数 $ans$ 。

## 说明/提示

- $ 1\ \leq\ N\ \leq\ 2\times\ 10^5 $
- $ 1\ \leq\ A_i\ \leq\ N $
- $ 1\ \leq\ Q\ \leq\ 2\times\ 10^5 $
- 对于每一组询问， $ 1\le\ L\ \leq\ R\ \leq\ N,\ 1\ \leq\ X\ \leq\ N $
- 输入数据均为整数

## 样例 #1

### 输入

```
5
3 1 4 1 5
4
1 5 1
2 4 3
1 5 2
1 3 3
```

### 输出

```
2
0
0
1
```



---

---
title: "[ABC248E] K-colinear Line"
layout: "post"
diff: 普及/提高-
pid: AT_abc248_e
tag: []
---

# [ABC248E] K-colinear Line

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc248/tasks/abc248_e

座標平面上の $ N $ 個の点が与えられます。 $ 1\leq\ i\leq\ N $ について、$ i $ 番目の点の座標は $ (X_i,\ Y_i) $ です。

座標平面上の直線であって、$ N $ 個の点のうち $ K $ 個以上の点を通るものの個数を求めてください。  
ただし、そのようなものが無数に存在する場合は `Infinity` を出力してください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ K $ $ X_1 $ $ Y_1 $ $ X_2 $ $ Y_2 $ $ \vdots $ $ X_N $ $ Y_N $

## 输出格式

与えられた $ N $ 個の点のうち $ K $ 個以上の点を通る直線の数を出力せよ。ただし、そのようなものが無数に存在する場合は `Infinity` を出力せよ。

## 说明/提示

### 制約

- $ 1\ \leq\ K\ \leq\ N\ \leq\ 300 $
- $ \lvert\ X_i\ \rvert,\ \lvert\ Y_i\ \rvert\ \leq\ 10^9 $
- $ i\neq\ j $ ならば $ X_i\neq\ X_j $ または $ Y_i\neq\ Y_j $
- 入力はすべて整数

### Sample Explanation 1

$ x=0 $, $ y=0 $, $ y=x\pm\ 1 $, $ y=-x\pm\ 1 $ の $ 6 $ 本の直線が条件をみたします。 例えば、$ x=0 $ は、$ 1 $, $ 3 $, $ 5 $ 番目の $ 3 $ 個の点を通ります。 よって、$ 6 $ を出力します。

### Sample Explanation 2

原点を通る直線は無数に存在します。 よって、`Infinity` を出力します。

## 样例 #1

### 输入

```
5 2
0 0
1 0
0 1
-1 0
0 -1
```

### 输出

```
6
```

## 样例 #2

### 输入

```
1 1
0 0
```

### 输出

```
Infinity
```



---

---
title: "[ABC249D] Index Trio"
layout: "post"
diff: 普及/提高-
pid: AT_abc249_d
tag: []
---

# [ABC249D] Index Trio

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc249/tasks/abc249_d

長さ $ N $ の整数列 $ A\ =\ (A_1,\ \dots,\ A_N) $ が与えられます。

以下の条件を全て満たす整数の組 $ (i,\ j,\ k) $ の総数を求めてください。

- $ 1\ \leq\ i,\ j,\ k\ \leq\ N $
- $ \frac{A_i}{A_j}\ =\ A_k $

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ A_1 $ $ \ldots $ $ A_N $

## 输出格式

答えを出力せよ。

## 说明/提示

### 制約

- $ 1\ \leq\ N\ \leq\ 2\ \times\ 10^5 $
- $ 1\ \leq\ A_i\ \leq\ 2\ \times\ 10^5\ \,\ (1\ \leq\ i\ \leq\ N) $
- 入力は全て整数

### Sample Explanation 1

$ (i,\ j,\ k)\ =\ (1,\ 2,\ 3),\ (1,\ 3,\ 2) $ が条件を満たします。

## 样例 #1

### 输入

```
3
6 2 3
```

### 输出

```
2
```

## 样例 #2

### 输入

```
1
2
```

### 输出

```
0
```

## 样例 #3

### 输入

```
10
1 3 2 4 6 8 2 2 3 7
```

### 输出

```
62
```



---

---
title: "[ABC250D] 250-like Number"
layout: "post"
diff: 普及/提高-
pid: AT_abc250_d
tag: []
---

# [ABC250D] 250-like Number

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc250/tasks/abc250_d

以下の条件を満たす整数 $ k $ を「 $ 250 $ に似た数」と呼びます。

- $ k $ が素数 $ p\ <\ q $ を使って $ k=p\ \times\ q^3 $ と表される。

$ N $ 以下の「 $ 250 $ に似た数」は全部でいくつありますか？

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $

## 输出格式

答えを整数として出力せよ。

## 说明/提示

### 制約

- $ N $ は $ 1 $ 以上 $ 10^{18} $ 以下の整数

### Sample Explanation 1

\- $ 54\ =\ 2\ \times\ 3^3 $ なので、「 $ 250 $ に似た数」です。 - $ 250\ =\ 2\ \times\ 5^3 $ なので、「 $ 250 $ に似た数」です。 $ 250 $ 以下の「 $ 250 $ に似た数」は、以上の $ 2 $ つです。

## 样例 #1

### 输入

```
250
```

### 输出

```
2
```

## 样例 #2

### 输入

```
1
```

### 输出

```
0
```

## 样例 #3

### 输入

```
123456789012345
```

### 输出

```
226863
```



---

---
title: "[ABC252D] Distinct Trio"
layout: "post"
diff: 普及/提高-
pid: AT_abc252_d
tag: []
---

# [ABC252D] Distinct Trio

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc252/tasks/abc252_d

長さ $ N $ の数列 $ A=(A_1,A_2,\ldots,A_N) $ が与えられます。  
 以下の $ 2 $ 条件をともに満たすような整数の組 $ (i,j,k) $ の個数を求めてください。

- $ 1\leq\ i\ \lt\ j\ \lt\ k\ \leq\ N $
- $ A_i,A_j,A_k $ は相異なる

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ A_1 $ $ A_2 $ $ \ldots $ $ A_N $

## 输出格式

答えを出力せよ。

## 说明/提示

### 制約

- $ 3\ \leq\ N\ \leq\ 2\times\ 10^5 $
- $ 1\ \leq\ A_i\ \leq\ 2\times\ 10^5 $
- 入力に含まれる値は全て整数である

### Sample Explanation 1

条件を満たす整数の組 $ (i,j,k) $ は $ (1,2,3),(1,3,4) $ の $ 2 $ つです。

## 样例 #1

### 输入

```
4

3 1 4 1
```

### 输出

```
2
```

## 样例 #2

### 输入

```
10

99999 99998 99997 99996 99995 99994 99993 99992 99991 99990
```

### 输出

```
120
```

## 样例 #3

### 输入

```
15

3 1 4 1 5 9 2 6 5 3 5 8 9 7 9
```

### 输出

```
355
```



---

---
title: "[ABC254D] Together Square"
layout: "post"
diff: 普及/提高-
pid: AT_abc254_d
tag: []
---

# [ABC254D] Together Square

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc254/tasks/abc254_d

整数 $ N $ が与えられます。以下の条件を満たす $ N $ 以下の正整数の組 $ (i,j) $ の個数を求めてください。

- $ i\ \times\ j $ は平方数である。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $

## 输出格式

答えを出力せよ。

## 说明/提示

### 制約

- $ 1\ \le\ N\ \le\ 2\ \times\ 10^5 $
- $ N $ は整数である。

### Sample Explanation 1

$ (1,1),(1,4),(2,2),(3,3),(4,1),(4,4) $ の $ 6 $ 個が条件を満たします。 $ (2,3) $ は $ 2\ \times\ 3\ =6 $ が平方数でないため条件を満たしません。

## 样例 #1

### 输入

```
4
```

### 输出

```
6
```

## 样例 #2

### 输入

```
254
```

### 输出

```
896
```



---

---
title: "[ABC255D] ±1 Operation 2"
layout: "post"
diff: 普及/提高-
pid: AT_abc255_d
tag: []
---

# [ABC255D] ±1 Operation 2

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc255/tasks/abc255_d

長さ $ N $ の数列 $ A=(A_1,A_2,\dots,A_N) $ が与えられます。この $ A $ に以下を施すことを「操作」と呼びます。

- まず、 $ 1\ \le\ i\ \le\ N $ を満たす整数 $ i $ を選択する。
- 次に、以下の $ 2 $ つのうちどちらかを選択し、実行する。
  - $ A_i $ に $ 1 $ を加算する。
  - $ A_i $ から $ 1 $ を減算する。

$ Q $ 個の質問に答えてください。  
$ i $ 個目の質問は以下です。

- 「操作」を $ 0 $ 回以上何度でも使って $ A $ の要素を全て $ X_i $ にする時、必要な「操作」の最小回数を求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ Q $ $ A_1 $ $ A_2 $ $ \dots $ $ A_N $ $ X_1 $ $ X_2 $ $ \vdots $ $ X_Q $

## 输出格式

$ Q $ 行にわたって出力せよ。  
出力のうち $ i $ 行目には、 $ i $ 個目の質問に対する答えを整数として出力せよ。

## 说明/提示

### 制約

- 入力は全て整数
- $ 1\ \le\ N,Q\ \le\ 2\ \times\ 10^5 $
- $ 0\ \le\ A_i\ \le\ 10^9 $
- $ 0\ \le\ X_i\ \le\ 10^9 $

### Sample Explanation 1

$ A=(6,11,2,5,5) $ であり、この入力には $ 3 $ つの質問が含まれます。 $ 1 $ つ目の質問について、 $ A $ に以下のように $ 10 $ 回の「操作」を施すことで、 $ A $ の要素を全て $ 5 $ にすることができます。 - $ A_1 $ から $ 1 $ 減算する。 - $ A_2 $ から $ 1 $ 減算することを $ 6 $ 度繰り返す。 - $ A_3 $ に $ 1 $ 加算することを $ 3 $ 度繰り返す。 $ 9 $ 回以下の「操作」で $ A $ の要素を全て $ 5 $ にすることはできません。 $ 2 $ つ目の質問について、 $ A $ に $ 71 $ 回の「操作」を施すことで、 $ A $ の要素を全て $ 20 $ にすることができます。 $ 3 $ つ目の質問について、 $ A $ に $ 29 $ 回の「操作」を施すことで、 $ A $ の要素を全て $ 0 $ にすることができます。

### Sample Explanation 2

出力が $ 32 $bit 整数に収まらない場合もあります。

## 样例 #1

### 输入

```
5 3
6 11 2 5 5
5
20
0
```

### 输出

```
10
71
29
```

## 样例 #2

### 输入

```
10 5
1000000000 314159265 271828182 141421356 161803398 0 777777777 255255255 536870912 998244353
555555555
321654987
1000000000
789456123
0
```

### 输出

```
3316905982
2811735560
5542639502
4275864946
4457360498
```



---

---
title: "[ABC257D] Jumping Takahashi 2"
layout: "post"
diff: 普及/提高-
pid: AT_abc257_d
tag: []
---

# [ABC257D] Jumping Takahashi 2

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc257/tasks/abc257_d

高橋君が住んでいる二次元平面上の街には $ N $ 個のジャンプ台があります。$ i $ 番目のジャンプ台は点 $ (x_i,\ y_i) $ にあり、ジャンプ台のパワーは $ P_i $ です。また高橋君のジャンプ力は $ S $ で表され、はじめ $ S=0 $ です。高橋君が訓練を $ 1 $ 回行う度に $ S $ は $ 1 $ 増えます。

高橋君は以下の条件を満たす場合に限り、$ i $ 番目のジャンプ台から $ j $ 番目のジャンプ台にジャンプすることができます。

- $ P_iS\geq\ |x_i\ -\ x_j|\ +|y_i\ -\ y_j| $

高橋君の目的は、適切に始点とするジャンプ台を決めることで、そのジャンプ台からどのジャンプ台にも何回かのジャンプで移動できるようにすることです。

目的を達成するためには高橋君は最低で何回訓練を行う必要があるでしょうか？

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ x_1 $ $ y_1 $ $ P_1 $ $ \vdots $ $ x_N $ $ y_N $ $ P_N $

## 输出格式

答えを出力せよ。

## 说明/提示

### 制約

- $ 2\ \leq\ N\ \leq\ 200 $
- $ -10^9\ \leq\ x_i,y_i\ \leq\ 10^9 $
- $ 1\ \leq\ P_i\ \leq\ 10^9 $
- $ (x_i,\ y_i)\ \neq\ (x_j,y_j)\ (i\neq\ j) $
- 入力は全て整数

### Sample Explanation 1

高橋君が $ 2 $ 回訓練したとすると、 $ S=2 $ です。 このとき、$ 2 $ 番目のジャンプ台から全てのジャンプ台に移動することができます。 例えば、$ 4 $ 番目のジャンプ台へは以下の方法で移動ができます。 - $ 2 $ 番目のジャンプ台から $ 3 $ 番目のジャンプ台へジャンプする。（ $ P_2\ S\ =\ 10,\ |x_2-x_3|\ +\ |y_2-y_3|\ =\ 10 $ であり、 $ P_2\ S\ \geq\ |x_2-x_3|\ +\ |y_2-y_3| $ を満たす。） - $ 3 $ 番目のジャンプ台から $ 4 $ 番目のジャンプ台へジャンプする。（ $ P_3\ S\ =\ 2,\ |x_3-x_4|\ +\ |y_3-y_4|\ =\ 1 $ であり、 $ P_3\ S\ \geq\ |x_3-x_4|\ +\ |y_3-y_4| $ を満たす。）

## 样例 #1

### 输入

```
4

-10 0 1

0 0 5

10 0 1

11 0 1
```

### 输出

```
2
```

## 样例 #2

### 输入

```
7

20 31 1

13 4 3

-10 -15 2

34 26 5

-2 39 4

0 -50 1

5 -20 2
```

### 输出

```
18
```



---

---
title: "[ABC259D] Circumferences"
layout: "post"
diff: 普及/提高-
pid: AT_abc259_d
tag: []
---

# [ABC259D] Circumferences

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc259/tasks/abc259_d

$ xy $ -平面上の $ N $ 個の円が与えられます。 $ i\ =\ 1,\ 2,\ \ldots,\ N $ について、$ i $ 番目の円は点 $ (x_i,\ y_i) $ を中心とする半径 $ r_i $ の円です。

$ N $ 個の円のうち少なくとも $ 1 $ つ以上の円の円周上にある点のみを通って、点 $ (s_x,\ s_y) $ から点 $ (t_x,\ t_y) $ に行くことができるかどうかを判定してください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ s_x $ $ s_y $ $ t_x $ $ t_y $ $ x_1 $ $ y_1 $ $ r_1 $ $ x_2 $ $ y_2 $ $ r_2 $ $ \vdots $ $ x_N $ $ y_N $ $ r_N $

## 输出格式

点 $ (s_x,\ s_y) $ から点 $ (t_x,\ t_y) $ に行くことができる場合は `Yes` を、そうでない場合は `No` を出力せよ。 ジャッジは英小文字と英大文字を厳密に区別することに注意せよ。

## 说明/提示

### 制約

- $ 1\ \leq\ N\ \leq\ 3000 $
- $ -10^9\ \leq\ x_i,\ y_i\ \leq\ 10^9 $
- $ 1\ \leq\ r_i\ \leq\ 10^9 $
- $ (s_x,\ s_y) $ は $ N $ 個の円のうち少なくとも $ 1 $ つ以上の円の円周上にある
- $ (t_x,\ t_y) $ は $ N $ 個の円のうち少なくとも $ 1 $ つ以上の円の円周上にある
- 入力はすべて整数

### Sample Explanation 1

!\[\](https://img.atcoder.jp/abc259/7b850385b9d67dc150435ffc7818bd94.png) 例えば、下記の経路で点 $ (0,\ -2) $ から点 $ (3,\ 3) $ へ行くことができます。 - 点 $ (0,\ -2) $ から $ 1 $ つ目の円の円周上を反時計回りに通って点 $ (1,\ -\sqrt{3}) $ へ行く。 - 点 $ (1,\ -\sqrt{3}) $ から $ 2 $ つ目の円の円周上を時計回りに通って点 $ (2,\ 2) $ へ行く。 - 点 $ (2,\ 2) $ から $ 3 $ つ目の円の円周上を反時計回りに通って点 $ (3,\ 3) $ へ行く。 よって、`Yes` を出力します。

### Sample Explanation 2

!\[\](https://img.atcoder.jp/abc259/924efa40ff28e5d7125841da2710d012.png) 少なくとも $ 1 $ つ以上の円の円周上にある点のみを通って点 $ (0,\ 1) $ から点 $ (0,\ 3) $ に行くことはできないので `No` を出力します。

## 样例 #1

### 输入

```
4
0 -2 3 3
0 0 2
2 0 2
2 3 1
-3 3 3
```

### 输出

```
Yes
```

## 样例 #2

### 输入

```
3
0 1 0 3
0 0 1
0 0 2
0 0 3
```

### 输出

```
No
```



---

---
title: "[ABC260D] Draw Your Cards"
layout: "post"
diff: 普及/提高-
pid: AT_abc260_d
tag: []
---

# [ABC260D] Draw Your Cards

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc260/tasks/abc260_d

$ 1 $ から $ N $ が書かれた $ N $ 枚のカードが裏向きで積まれた山札があり、上から $ i $ 枚目のカードには整数 $ P_i $ が書かれています。

この山札を使って、以下の行動を $ N $ ターン繰り返します。

- 山札の一番上のカードを引いて、そこに書かれた整数を $ X $ とする。
- 場に見えている表向きのカードであって書かれた整数が $ X $ 以上であるもののうち、書かれた整数が最小のものの上に、引いたカードを表向きで重ねる。もし場にそのようなカードがなければ、引いたカードをどれにも重ねずに表向きで場に置く。
- その後、表向きのカードが $ K $ 枚重ねられた山が場にあればその山のカードを全て食べる。食べられたカードは全て場から消滅する。

各カードについて、何ターン目に食べられるか、あるいは最後まで食べられないかを求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ K $ $ P_1 $ $ P_2 $ $ \dots $ $ P_N $

## 输出格式

$ N $ 行出力せよ。  
 そのうち $ i $ ($ 1\ \le\ i\ \le\ N $) 行目には、整数 $ i $ が書かれたカードについて、以下のように出力せよ。

- もし $ i $ が書かれたカードが食べられるなら、それが何ターン目であるかを整数として出力せよ。
- そうでないなら $ -1 $ と出力せよ。

## 说明/提示

### 制約

- 入力は全て整数
- $ 1\ \le\ K\ \le\ N\ \le\ 2\ \times\ 10^5 $
- $ P $ は $ (1,2,\dots,N) $ の順列 ( $ (1,2,\dots,N) $ を並べ替えて得られる列 ) である

### Sample Explanation 1

この入力では、 $ P=(3,5,2,1,4),K=2 $ です。 - $ 1 $ ターン目に、 $ 3 $ が書かれたカードが他のカードに重ねられずに表向きで場に置かれます。 - $ 2 $ ターン目に、 $ 5 $ が書かれたカードが他のカードに重ねられずに表向きで場に置かれます。 - $ 3 $ ターン目に、 $ 2 $ が書かれたカードが $ 3 $ が書かれたカードの上に表向きで重ねられます。 - この時点で上から $ 2,3 $ が書かれたカードが表向きで重ねられた山が $ K=2 $ 枚に達したので、両カードは食べられます。 - $ 4 $ ターン目に、 $ 1 $ が書かれたカードが $ 5 $ が書かれたカードの上に表向きで重ねられます。 - この時点で上から $ 1,5 $ が書かれたカードが表向きで重ねられた山が $ K=2 $ 枚に達したので、両カードは食べられます。 - $ 5 $ ターン目に、 $ 4 $ が書かれたカードが他のカードに重ねられずに表向きで場に置かれます。 - $ 4 $ が書かれたカードは、最後まで食べられませんでした。

### Sample Explanation 2

$ K=1 $ である場合、全てのカードは場に置かれたターンに食べられます。

## 样例 #1

### 输入

```
5 2

3 5 2 1 4
```

### 输出

```
4

3

3

-1

4
```

## 样例 #2

### 输入

```
5 1

1 2 3 4 5
```

### 输出

```
1

2

3

4

5
```

## 样例 #3

### 输入

```
15 3

3 14 15 9 2 6 5 13 1 7 10 11 8 12 4
```

### 输出

```
9

9

9

15

15

6

-1

-1

6

-1

-1

-1

-1

6

15
```



---

---
title: "[ABC261D] Flipping and Bonus"
layout: "post"
diff: 普及/提高-
pid: AT_abc261_d
tag: []
---

# [ABC261D] Flipping and Bonus

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc261/tasks/abc261_d

高橋君が $ N $ 回コイントスを行います。 また、高橋君はカウンタを持っており、最初カウンタの数値は $ 0 $ です。

$ i $ 回目のコイントスで表裏のどちらが出たかによって、次のことが起こります。

- 表が出たとき：高橋君はカウンタの数値を $ 1 $ 増やし、$ X_i $ 円もらう。
- 裏が出たとき：高橋君はカウンタの数値を $ 0 $ に戻す。お金をもらうことは出来ない。

また、$ M $ 種類の連続ボーナスがあり、$ i $ 種類目の連続ボーナスではカウンタの数値が $ C_i $ になる**たびに** $ Y_i $ 円もらうことができます。

高橋君は最大で何円もらうことができるかを求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ M $ $ X_1 $ $ X_2 $ $ \ldots $ $ X_N $ $ C_1 $ $ Y_1 $ $ C_2 $ $ Y_2 $ $ \vdots $ $ C_M $ $ Y_M $

## 输出格式

高橋君がもらうことのできる金額の最大値を整数で出力せよ。

## 说明/提示

### 制約

- $ 1\leq\ M\leq\ N\leq\ 5000 $
- $ 1\leq\ X_i\leq\ 10^9 $
- $ 1\leq\ C_i\leq\ N $
- $ 1\leq\ Y_i\leq\ 10^9 $
- $ C_1,C_2,\ldots,C_M $ はすべて異なる。
- 入力はすべて整数

### Sample Explanation 1

順に 表, 表, 裏, 表, 表, 表 が出た時、もらえる金額は次のようになります。 - $ 1 $ 回目のコイントスで表が出る。カウンタの数値を $ 0 $ から $ 1 $ にして、$ 2 $ 円もらう。 - $ 2 $ 回目のコイントスで表が出る。カウンタの数値を $ 1 $ から $ 2 $ にして、$ 7 $ 円もらう。さらに、連続ボーナスとして $ 10 $ 円もらう。 - $ 3 $ 回目のコイントスで裏が出る。カウンタの数値を $ 2 $ から $ 0 $ にする。 - $ 4 $ 回目のコイントスで表が出る。カウンタの数値を $ 0 $ から $ 1 $ にして、$ 8 $ 円もらう。 - $ 5 $ 回目のコイントスで表が出る。カウンタの数値を $ 1 $ から $ 2 $ にして、$ 2 $ 円もらう。さらに、連続ボーナスとして $ 10 $ 円もらう。 - $ 6 $ 回目のコイントスで表が出る。カウンタの数値を $ 2 $ から $ 3 $ にして、$ 8 $ 円もらう。さらに、連続ボーナスとして $ 1 $ 円もらう。 このとき高橋君は合計で $ 2+(7+10)+0+8+(2+10)+(8+1)=48 $ 円もらうことができ、このときが最大です。 連続ボーナスはカウンタの数値が $ C_i $ になるたびに何度でももらえることに注意してください。 ちなみに、$ 6 $ 回のコイントスで全部表が出た時は $ 2+(7+10)+(1+1)+8+(2+5)+8=44 $ 円しかもらうことが出来ず、この時は最大ではありません。

### Sample Explanation 2

答えが $ 32 $ bit 整数型に収まらないこともあることに注意してください。

## 样例 #1

### 输入

```
6 3
2 7 1 8 2 8
2 10
3 1
5 5
```

### 输出

```
48
```

## 样例 #2

### 输入

```
3 2
1000000000 1000000000 1000000000
1 1000000000
3 1000000000
```

### 输出

```
5000000000
```



---

---
title: "[ABC262D] I Hate Non-integer Number"
layout: "post"
diff: 普及/提高-
pid: AT_abc262_d
tag: []
---

# [ABC262D] I Hate Non-integer Number

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc262/tasks/abc262_d

項数が $ N $ の正整数列 $ A=(a_1,\ldots,a_N) $ が与えられます。  
 $ A $ の項を $ 1 $ 個以上選ぶ方法は $ 2^N-1 $ 通りありますが、そのうち選んだ項の平均値が整数であるものが何通りかを $ 998244353 $ で割った余りを求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ a_1 $ $ \ldots $ $ a_N $

## 输出格式

答えを出力せよ。

## 说明/提示

### 制約

- $ 1\ \leq\ N\ \leq\ 100 $
- $ 1\ \leq\ a_i\ \leq\ 10^9 $
- 入力はすべて整数

### Sample Explanation 1

$ A $ の項を選ぶ方法それぞれに対する平均値は以下のようになります。 - $ a_1 $ のみを選んだ場合、平均値は $ \frac{a_1}{1}=\frac{2}{1}\ =\ 2 $ であり、整数である。 - $ a_2 $ のみを選んだ場合、平均値は $ \frac{a_2}{1}=\frac{6}{1}\ =\ 6 $ であり、整数である。 - $ a_3 $ のみを選んだ場合、平均値は $ \frac{a_3}{1}=\frac{2}{1}\ =\ 2 $ であり、整数である。 - $ a_1 $ と $ a_2 $ を選んだ場合、平均値は $ \frac{a_1+a_2}{2}=\frac{2+6}{2}\ =\ 4 $ であり、整数である。 - $ a_1 $ と $ a_3 $ を選んだ場合、平均値は $ \frac{a_1+a_3}{2}=\frac{2+2}{2}\ =\ 2 $ であり、整数である。 - $ a_2 $ と $ a_3 $ を選んだ場合、平均値は $ \frac{a_2+a_3}{2}=\frac{6+2}{2}\ =\ 4 $ であり、整数である。 - $ a_1 $ と $ a_2 $ と $ a_3 $ を選んだ場合、平均値は $ \frac{a_1+a_2+a_3}{3}=\frac{2+6+2}{3}\ =\ \frac{10}{3} $ であり、整数ではない。 以上より、$ 6 $ 通りの選び方が条件を満たします。

### Sample Explanation 2

どのように $ A $ の項を $ 1 $ 個以上選んでも平均値が $ 5 $ になります。

## 样例 #1

### 输入

```
3

2 6 2
```

### 输出

```
6
```

## 样例 #2

### 输入

```
5

5 5 5 5 5
```

### 输出

```
31
```



---

---
title: "[ABC263D] Left Right Operation"
layout: "post"
diff: 普及/提高-
pid: AT_abc263_d
tag: []
---

# [ABC263D] Left Right Operation

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc263/tasks/abc263_d

長さ $ N $ の整数列 $ A=(A_1,A_2,\ldots,A_N) $ が与えられます。

あなたは以下の連続する操作をちょうど一度だけ行います。

- 整数 $ x\ (0\leq\ x\ \leq\ N) $ を選ぶ。$ x $ として $ 0 $ を選んだ場合何もしない。 $ x $ として $ 1 $ 以上の整数を選んだ場合、$ A_1,A_2,\ldots,A_x $ をそれぞれ $ L $ で置き換える。
- 整数 $ y\ (0\leq\ y\ \leq\ N) $ を選ぶ。$ y $ として $ 0 $ を選んだ場合何もしない。 $ y $ として $ 1 $ 以上の整数を選んだ場合、$ A_{N},A_{N-1},\ldots,A_{N-y+1} $ をそれぞれ $ R $ で置き換える。

操作後の $ A $ の要素の総和として考えられる最小値を求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ L $ $ R $ $ A_1 $ $ A_2 $ $ \ldots $ $ A_N $

## 输出格式

答えを出力せよ。

## 说明/提示

### 制約

- $ 1\ \leq\ N\ \leq\ 2\times\ 10^5 $
- $ -10^9\ \leq\ L,\ R\leq\ 10^9 $
- $ -10^9\ \leq\ A_i\leq\ 10^9 $
- 入力は全て整数

### Sample Explanation 1

$ x=2,y=2 $ として操作をすると、数列 $ A\ =\ (4,4,0,3,3) $ となり、要素の総和は $ 14 $ になります。 これが達成可能な最小値です。

### Sample Explanation 2

$ x=0,y=0 $ として操作をすると、数列 $ A\ =\ (1,2,3,4) $ となり、要素の総和は $ 10 $ になります。 これが達成可能な最小値です。

### Sample Explanation 3

$ L,R,A_i $ は負であることがあります。

## 样例 #1

### 输入

```
5 4 3

5 5 0 6 3
```

### 输出

```
14
```

## 样例 #2

### 输入

```
4 10 10

1 2 3 4
```

### 输出

```
10
```

## 样例 #3

### 输入

```
10 -5 -3

9 -6 10 -1 2 10 -1 7 -15 5
```

### 输出

```
-58
```



---

---
title: "[ABC264C] Matrix Reducing"
layout: "post"
diff: 普及/提高-
pid: AT_abc264_c
tag: []
---

# [ABC264C] Matrix Reducing

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc264/tasks/abc264_c

$ H_1 $ 行 $ W_1 $ 列の行列 $ A $ と、$ H_2 $ 行 $ W_2 $ 列の行列 $ B $ が与えられます。

- $ 1\ \leq\ i\ \leq\ H_1 $ かつ $ 1\ \leq\ j\ \leq\ W_1 $ を満たす整数の組 $ (i,\ j) $ について、行列 $ A $ の $ i $ 行目 $ j $ 列目の要素は $ A_{i,\ j} $ です。
- $ 1\ \leq\ i\ \leq\ H_2 $ かつ $ 1\ \leq\ j\ \leq\ W_2 $ を満たす整数の組 $ (i,\ j) $ について、行列 $ B $ の $ i $ 行目 $ j $ 列目の要素は $ B_{i,\ j} $ です。

行列 $ A $ に対して、下記の $ 2 $ つの操作のうちどちらかを行うことを、好きなだけ（ $ 0 $ 回でも良い）繰り返すことができます。

- $ A $ の行を任意に $ 1 $ つ選んで削除する。
- $ A $ の列を任意に $ 1 $ つ選んで削除する。

行列 $ A $ を行列 $ B $ に一致させることができるかどうかを判定して下さい。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ H_1 $ $ W_1 $ $ A_{1,\ 1} $ $ A_{1,\ 2} $ $ \ldots $ $ A_{1,\ W_1} $ $ A_{2,\ 1} $ $ A_{2,\ 2} $ $ \ldots $ $ A_{2,\ W_1} $ $ \vdots $ $ A_{H_1,\ 1} $ $ A_{H_1,\ 2} $ $ \ldots $ $ A_{H_1,\ W_1} $ $ H_2 $ $ W_2 $ $ B_{1,\ 1} $ $ B_{1,\ 2} $ $ \ldots $ $ B_{1,\ W_2} $ $ B_{2,\ 1} $ $ B_{2,\ 2} $ $ \ldots $ $ B_{2,\ W_2} $ $ \vdots $ $ B_{H_2,\ 1} $ $ B_{H_2,\ 2} $ $ \ldots $ $ B_{H_2,\ W_2} $

## 输出格式

行列 $ A $ を行列 $ B $ に一致させることができる場合は `Yes` を、 一致させることができない場合は `No` を出力せよ。 ジャッジは英小文字と英大文字を厳密に区別することに注意せよ。

## 说明/提示

### 制約

- $ 1\ \leq\ H_2\ \leq\ H_1\ \leq\ 10 $
- $ 1\ \leq\ W_2\ \leq\ W_1\ \leq\ 10 $
- $ 1\ \leq\ A_{i,\ j}\ \leq\ 10^9 $
- $ 1\ \leq\ B_{i,\ j}\ \leq\ 10^9 $
- 入力中の値はすべて整数

### Sample Explanation 1

初期状態の行列 $ A $ から $ 2 $ 列目を削除すると、行列 $ A $ は ``` 1 3 4 5 6 8 9 10 11 13 14 15 16 18 19 20 ``` となります。そこからさらに $ 3 $ 行目を削除すると、行列 $ A $ は ``` 1 3 4 5 6 8 9 10 16 18 19 20 ``` となります。そこからさらに $ 1 $ 行目を削除すると、行列 $ A $ は ``` 6 8 9 10 16 18 19 20 ``` となります。そこからさらに $ 4 $ 列目を削除すると、行列 $ A $ は ``` 6 8 9 16 18 19 ``` となります。これは行列 $ B $ と一致します。 操作の繰り返しによって行列 $ A $ を行列 $ B $ に一致させることができるので `Yes` を出力します。

### Sample Explanation 2

どのように操作を行っても、 行列 $ A $ を行列 $ B $ に一致させることはできません。 よって、`No` を出力します。

## 样例 #1

### 输入

```
4 5

1 2 3 4 5

6 7 8 9 10

11 12 13 14 15

16 17 18 19 20

2 3

6 8 9

16 18 19
```

### 输出

```
Yes
```

## 样例 #2

### 输入

```
3 3

1 1 1

1 1 1

1 1 1

1 1

2
```

### 输出

```
No
```



---

---
title: "[ABC265D] Iroha and Haiku (New ABC Edition)"
layout: "post"
diff: 普及/提高-
pid: AT_abc265_d
tag: []
---

# [ABC265D] Iroha and Haiku (New ABC Edition)

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc265/tasks/abc265_d

長さ $ N $ の数列 $ A=(A_0,\ldots,A_{N-1}) $ があります。  
次の条件を全て満たす整数の組 $ (x,y,z,w) $ が存在するか判定してください。

- $ 0\ \leq\ x\ <\ y\ <\ z\ <\ w\ \leq\ N $
- $ A_x\ +\ A_{x+1}\ +\ \ldots\ +\ A_{y-1}\ =\ P $
- $ A_y\ +\ A_{y+1}\ +\ \ldots\ +\ A_{z-1}\ =\ Q $
- $ A_z\ +\ A_{z+1}\ +\ \ldots\ +\ A_{w-1}\ =\ R $

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ P $ $ Q $ $ R $ $ A_0 $ $ A_1 $ $ \ldots $ $ A_{N-1} $

## 输出格式

条件を満たす組が存在するなら `Yes`、存在しないなら `No` を出力せよ。

## 说明/提示

### 制約

- $ 3\ \leq\ N\ \leq\ 2\times\ 10^5 $
- $ 1\ \leq\ A_i\ \leq\ 10^9 $
- $ 1\ \leq\ P,Q,R\ \leq\ 10^{15} $
- 入力に含まれる値は全て整数である

### Sample Explanation 1

$ (x,y,z,w)=(1,3,6,8) $ が条件を満たします。

## 样例 #1

### 输入

```
10 5 7 5
1 3 2 2 2 3 1 4 3 2
```

### 输出

```
Yes
```

## 样例 #2

### 输入

```
9 100 101 100
31 41 59 26 53 58 97 93 23
```

### 输出

```
No
```

## 样例 #3

### 输入

```
7 1 1 1
1 1 1 1 1 1 1
```

### 输出

```
Yes
```



---

---
title: "[ABC266C] Convex Quadrilateral"
layout: "post"
diff: 普及/提高-
pid: AT_abc266_c
tag: []
---

# [ABC266C] Convex Quadrilateral

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc266/tasks/abc266_c

$ 2 $ 次元座標平面があります。$ x $ 軸正方向を右向き、$ y $ 軸正方向を上向きとします。

この平面上に自己交差のない四角形があります。  
 $ 4 $ つの頂点の座標は反時計回りに $ (A_x,A_y),(B_x,B_y),(C_x,C_y),(D_x,D_y) $ です。

この四角形が凸であるか判定してください。

なお、四角形の $ 4 $ つの内角が全て $ 180 $ 度未満であるとき、かつ、その時に限り、その四角形は凸であるといいます。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ A_x $ $ A_y $ $ B_x $ $ B_y $ $ C_x $ $ C_y $ $ D_x $ $ D_y $

## 输出格式

与えられる四角形が凸なら `Yes`、凸でないなら `No` を出力せよ。

## 说明/提示

### 制約

- $ -100\ \leq\ A_x,A_y,B_x,B_y,C_x,C_y,D_x,D_y\ \leq\ 100 $
- 入力に含まれる値は全て整数である
- 与えられる $ 4 $ 点は四角形の $ 4 $ 頂点を反時計回りに並べたものである
- 与えられる $ 4 $ 点のなす四角形は自己交差がなく退化していない。すなわち
  - どの $ 2 $ 頂点も同じ座標にない
  - どの $ 3 $ 頂点も同一直線上にない
  - 隣接しない $ 2 $ 辺は共有点を持たない

### Sample Explanation 1

与えられた四角形は正方形であり、$ 4 $ つの内角は全て $ 90 $ 度です。したがって、この四角形は凸です。 !\[図\](https://img.atcoder.jp/abc266/cda66d9b9f4291781d1ce47f59f29ab0.png)

### Sample Explanation 2

角 $ A $ が $ 270 $ 度です。したがって、この四角形は凸ではありません。 !\[図\](https://img.atcoder.jp/abc266/2927f9f67e2cb7c35aeab05269b6fcc2.png)

## 样例 #1

### 输入

```
0 0

1 0

1 1

0 1
```

### 输出

```
Yes
```

## 样例 #2

### 输入

```
0 0

1 1

-1 0

1 -1
```

### 输出

```
No
```



---

---
title: "[ABC266D] Snuke Panic (1D)"
layout: "post"
diff: 普及/提高-
pid: AT_abc266_d
tag: []
---

# [ABC266D] Snuke Panic (1D)

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc266/tasks/abc266_d

高橋君はすぬけ君たちを捕まえようとしています。

数直線上の座標 $ 0,1,2,3,4 $ の $ 5 $ 箇所に穴があり、すぬけ君たちの巣につながっています。

これから $ N $ 匹のすぬけ君が穴から出てきます。$ i $ 番目のすぬけ君は時刻 $ T_i $ に座標 $ X_i $ の穴から出てきて、大きさは $ A_i $ であることがわかっています。

高橋君は時刻 $ 0 $ に座標 $ 0 $ におり、数直線上を単位時間あたり $ 1 $ 以下の速さで移動することができます。  
すぬけ君が穴から出てきたのと同じ時刻に同じ座標に高橋君がいるとき、かつ、そのときに限り、高橋君はすぬけ君を捕まえることができます。  
すぬけ君を捕まえるのにかかる時間は無視できます。

高橋君が適切に行動したとき、捕まえることができるすぬけ君の大きさの合計の最大値を求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ T_1 $ $ X_1 $ $ A_1 $ $ T_2 $ $ X_2 $ $ A_2 $ $ \vdots $ $ T_N $ $ X_N $ $ A_N $

## 输出格式

答えを整数として出力せよ。

## 说明/提示

### 制約

- $ 1\ \leq\ N\ \leq\ 10^5 $
- $ 0\ <\ T_1\ <\ T_2\ <\ \ldots\ <\ T_N\ \leq\ 10^5 $
- $ 0\ \leq\ X_i\ \leq\ 4 $
- $ 1\ \leq\ A_i\ \leq\ 10^9 $
- 入力に含まれる値は全て整数である

### Sample Explanation 1

次のように行動するのが最適です。 - 座標 $ 0 $ で待機し、時刻 $ 1 $ に $ 1 $ 番目のすぬけ君を捕まえる - 座標 $ 4 $ へ移動し、時刻 $ 5 $ に $ 3 $ 番目のすぬけ君を捕まえる $ 1 $ 番目と $ 2 $ 番目のすぬけ君を両方とも捕まえることはできないので、これが最大です。

### Sample Explanation 2

高橋君はすぬけ君を $ 1 $ 匹も捕まえることができません。

## 样例 #1

### 输入

```
3
1 0 100
3 3 10
5 4 1
```

### 输出

```
101
```

## 样例 #2

### 输入

```
3
1 4 1
2 4 1
3 4 1
```

### 输出

```
0
```

## 样例 #3

### 输入

```
10
1 4 602436426
2 1 623690081
3 3 262703497
4 4 628894325
5 3 450968417
6 1 161735902
7 1 707723857
8 2 802329211
9 0 317063340
10 2 125660016
```

### 输出

```
2978279323
```



---

---
title: "[ABC266E] Throwing the Die"
layout: "post"
diff: 普及/提高-
pid: AT_abc266_e
tag: []
---

# [ABC266E] Throwing the Die

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc266/tasks/abc266_e

サイコロを使ったゲームをします。ゲームは最大 $ N $ 回のターンからなり、各ターンは次のように進行します。

- $ 1,\ldots,6 $ の目が等確率で出る $ 6 $ 面ダイスを振り、出目を $ X $ とする(出目は各ターンで独立とする)。
- 現在が $ N $ ターン目なら、**スコア** を $ X $ とし、ゲームを終了する。
- そうでないとき、ゲームを続行するか終了するか選択する。
  - ゲームを終了する場合、スコアを $ X $ とし、残りのターンは行わずにゲームを終了する。

スコアの期待値が最大になるように行動したとき、スコアの期待値を求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $

## 输出格式

答えを出力せよ。  
 なお、真の解との絶対誤差または相対誤差が $ 10^{-6} $ 以下であれば正解として扱われる。

## 说明/提示

### 制約

- $ 1\ \leq\ N\ \leq\ 100 $

## 样例 #1

### 输入

```
1
```

### 输出

```
3.5000000000
```

## 样例 #2

### 输入

```
2
```

### 输出

```
4.2500000000
```

## 样例 #3

### 输入

```
10
```

### 输出

```
5.6502176688
```



---

---
title: "[ABC267D] Index × A(Not Continuous ver.)"
layout: "post"
diff: 普及/提高-
pid: AT_abc267_d
tag: []
---

# [ABC267D] Index × A(Not Continuous ver.)

## 题目描述

有一个长度为 $N$ 整数数列 $A=(A_1,A_2,...,A_N)$ 。

现在假设有一个长度为 $M$ 的序列 $B$ ,并且 $B$ 是 $A$ 的**子序列**。请找到 $\sum_{i=1}^M i\times B_i$ 的最大值。

## 输入格式

输入按照下面的标准格式给出：

> $ N\ M \newline A_1 \ A_2 \ \dots\  A_N $

## 输出格式

一个整数，表示$\sum_{i=1}^M i\times B_i$ 的最大值。

## 说明/提示

#### 注意事项
若序列 $S$ 是长度为 $L$ 的数列 $T$ 的**子序列**，则 $S$ 是数列 $T$ 删除任意 $i\ (i\in [0,L])$ 个元素得到的。

比如说， $(10,30)$ 是 $(10,20,30)$ 的字串，但是 $(20,10)$ 不是。


+ $1\le M\le N\le 2000$
+ $-2\times 10^5\le A_i\le 2\times 10^5$
+ 所有输入数据均为整数

#### 样例解释
对于**样例一**，当 $B=(A_1,A_4)$ 时，$\sum_{i=1}^M i\times B_i=1\times 5+2\times 8=21$ 。因为不可能达到 $22$ 或者更大的值，所以答案是 $21$ 。

## 样例 #1

### 输入

```
4 2

5 4 -1 8
```

### 输出

```
21
```

## 样例 #2

### 输入

```
10 4

-3 1 -4 1 -5 9 -2 6 -5 3
```

### 输出

```
54
```



---

---
title: "[ABC269E] Last Rook"
layout: "post"
diff: 普及/提高-
pid: AT_abc269_e
tag: []
---

# [ABC269E] Last Rook

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc269/tasks/abc269_e

**この問題はインタラクティブな問題**（あなたの作成したプログラムとジャッジプログラムが入出力を介して対話を行う形式の問題）です。

縦横 $ N $ マスのチェス盤と $ N $ 個のルークの駒があります。以下では上から $ i $ 行目、左から $ j $ 列目のマスを $ (i,\ j) $ と表します。  
 チェス盤のマスにルークを置くことを考えます。ただし、あなたは次の条件をすべて満たすようにルークをチェス盤に置く必要があります。

- 1 つの行に $ 2 $ 個以上のルークが存在しない。
- 1 つの列に $ 2 $ 個以上のルークが存在しない。

今、チェス盤に $ N-1 $ 個のルークが上の条件をすべて満たした状態で置かれています。あなたはルークが置かれていないマスを 1 つ選び、そのマスにルークを置くことにしました。(上の条件をすべて満たすようにルークを置くことができるマスは少なくとも 1 つ以上存在することが証明できます。)

ただし、あなたはチェス盤のどのマスにルークが置かれているかを直接知ることはできません。  
 そのかわりに、ジャッジシステムに対して以下の質問を $ 20 $ 回まで行うことができます。

- 整数 $ A,\ B,\ C,\ D $ を $ 1\ \leq\ A\ \leq\ B\ \leq\ N,\ 1\ \leq\ C\ \leq\ D\ \leq\ N $ を満たすように選ぶ。そして、$ A\ \leq\ i\ \leq\ B,\ C\ \leq\ j\ \leq\ D $ を満たすマス $ (i,\ j) $ からなる長方形領域に置かれているルークの個数を聞く。

ルークを置くことができるマスを見つけてください。

### Input &amp; Output Format

この問題はインタラクティブな問題（あなたの作成したプログラムとジャッジプログラムが入出力を介して対話を行う形式の問題）です。

最初に、チェス盤のサイズ $ N $ を標準入力から受け取ってください。

> $ N $

次に、ルークを置くことができるマスが見つかるまで質問を繰り返してください。  
 質問は、以下の形式で標準出力に出力してください。

> $ ? $ $ A $ $ B $ $ C $ $ D $

これに対する応答は、次の形式で標準入力から与えられます。

> $ T $

ここで、$ T $ は質問に対する答えです。ただし、不正な質問を行った、あるいは質問の回数が $ 20 $ 回を超えた場合は $ T $ は `-1` となります。

ジャッジが `-1` を返した場合、提出はすでに不正解とみなされています。この場合、ただちにプログラムを終了してください。

ルークを置くことができるマスを見つけたら、そのマスを $ (X,\ Y) $ として、解答を以下の形式で出力してください。その後、ただちにプログラムを終了してください。

> $ ! $ $ X $ $ Y $

答えが複数ある場合、どれを出力しても正解とみなされます。

## 说明/提示

### 制約

- $ 2\ \leq\ N\ \leq\ 10^3 $
- $ N $ は整数

### 注意点

- **出力を行うたびに、末尾に改行を入れて標準出力を flush してください。そうしなかった場合、ジャッジ結果が TLE となる可能性があります。**
- **対話の途中で不正な出力を行った場合のジャッジ結果は不定です。**
- 解答を出力したらただちにプログラムを終了してください。そうしない場合、ジャッジ結果は不定です。

### 入出力例

以下は、$ N=3 $ で $ (1,\ 2),\ (2,\ 1) $ にルークが置かれている場合の入出力例です。

 入力 出力 説明 `3`  まず整数 $ N $ が与えられます。  `? 1 2 1 3`  $ (A,B,C,D)=(1,2,1,3) $ として質問を行います。 `2`  質問の答えは $ 2 $ なので、ジャッジはその値を返します。  `? 2 3 1 1` $ (A,B,C,D)=(2,3,1,1) $ として質問を行います。 `1`  質問の答えは $ 1 $ なので、ジャッジはその値を返します。  `? 1 3 3 3` $ (A,B,C,D)=(1,3,3,3) $ として質問を行います。 `0`  質問の答えは $ 0 $ なので、ジャッジはその値を返します。  `! 3 3` 答えは $ (3,\ 3) $ だとわかったので、それを出力します。



---

---
title: "[ABC270E] Apple Baskets on Circle"
layout: "post"
diff: 普及/提高-
pid: AT_abc270_e
tag: []
---

# [ABC270E] Apple Baskets on Circle

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc270/tasks/abc270_e

$ 1,2,\ldots,N $ の番号がついた $ N $ 個のかごが円状に置かれています。  
 $ 1\leq\ i\ \leq\ N-1 $ についてかご $ i $ の右隣にはかご $ i+1 $ があり、かご $ N $ の右隣にはかご $ 1 $ があります。

かご $ i $ の中には $ A_i $ 個りんごが入っています。

高橋君は最初かご $ 1 $ の前におり、以下の行動を繰り返します。

- 目の前にあるかごの中にりんごがあれば $ 1 $ 個かごから取り出して食べる。その後、りんごを食べたかどうかにかかわらず、右隣のかごの前に移動する。

高橋君がちょうど $ K $ 個のりんごを食べた時点で、各かごの中に残っているりんごの個数を求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ K $ $ A_1 $ $ A_2 $ $ \ldots $ $ A_N $

## 输出格式

$ N $ 個の整数を空白区切りで出力せよ。  
 $ i $ 番目には、高橋君がちょうど $ K $ 個のりんごを食べた時点で、かご $ i $ の中に残っているりんごの個数を出力せよ。

## 说明/提示

### 制約

- $ 1\ \leq\ N\ \leq\ 10^5 $
- $ 0\ \leq\ A_i\ \leq\ 10^{12} $
- $ 1\ \leq\ K\ \leq\ 10^{12} $
- りんごは全部で $ K $ 個以上ある。すなわち、$ \sum_{i=1}^{N}A_i\geq\ K $
- 入力に含まれる値は全て整数である

### Sample Explanation 1

高橋君は次のように行動します。 - 目の前にあるかご $ 1 $ の中にりんごがあるので $ 1 $ 個かごから取り出して食べる。その後、かご $ 2 $ の前に移動する。この時点で各かごの中のりんごの個数は $ (0,3,0) $ である。 - 目の前にあるかご $ 2 $ の中にりんごがあるので $ 1 $ 個かごから取り出して食べる。その後、かご $ 3 $ の前に移動する。この時点で各かごの中のりんごの個数は $ (0,2,0) $ である。 - 目の前にあるかご $ 3 $ の中にりんごはない。かご $ 1 $ の前に移動する。この時点で各かごの中のりんごの個数は $ (0,2,0) $ である。 - 目の前にあるかご $ 1 $ の中にりんごはない。かご $ 2 $ の前に移動する。この時点で各かごの中のりんごの個数は $ (0,2,0) $ である。 - 目の前にあるかご $ 2 $ の中にりんごがあるので $ 1 $ 個かごから取り出して食べる。その後、かご $ 3 $ の前に移動する。この時点で各かごの中のりんごの個数は $ (0,1,0) $ である。

## 样例 #1

### 输入

```
3 3

1 3 0
```

### 输出

```
0 1 0
```

## 样例 #2

### 输入

```
2 1000000000000

1000000000000 1000000000000
```

### 输出

```
500000000000 500000000000
```



---

---
title: "[ABC271C] Manga"
layout: "post"
diff: 普及/提高-
pid: AT_abc271_c
tag: []
---

# [ABC271C] Manga

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc271/tasks/abc271_c

高橋君は全 $ 10^9 $ 巻の漫画『すぬけ君』を読むことにしました。  
 初め、高橋君は『すぬけ君』の単行本を $ N $ 冊持っています。$ i $ 番目の単行本は $ a_i $ 巻です。

高橋君は『すぬけ君』を**読み始める前に限り**次の操作を $ 0 $ 回以上何度でも繰り返せます。

- 現在持っている単行本が $ 1 $ 冊以下の場合、何もしない。そうでない場合、現在持っている単行本から $ 2 $ 冊を選んで売り、代わりに好きな巻を選んで $ 1 $ 冊買う

その後、高橋君は『すぬけ君』を $ 1 $ 巻、$ 2 $ 巻、$ 3 $ 巻、$ \ldots $ と順番に読みます。ただし、次に読むべき巻を持っていない状態になった場合、(他の巻を持っているかどうかに関わらず)その時点で『すぬけ君』を読むのをやめます。

高橋君が『すぬけ君』を最大で何巻まで読めるかを求めてください。ただし、$ 1 $ 巻を読めない場合の答えは $ 0 $ とします。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ a_1 $ $ \ldots $ $ a_N $

## 输出格式

答えを出力せよ。

## 说明/提示

### 制約

- $ 1\ \leq\ N\ \leq\ 3\ \times\ 10^5 $
- $ 1\ \leq\ a_i\ \leq\ 10^9 $
- 入力はすべて整数

### Sample Explanation 1

『すぬけ君』を読み始める前に「$ 7 $ 巻と $ 271 $ 巻を選んで売り、代わりに $ 3 $ 巻を選んで $ 1 $ 冊買う」という内容で操作をすると、高橋君は $ 1 $ 巻、$ 2 $ 巻、$ 3 $ 巻、$ 4 $ 巻、$ 6 $ 巻を $ 1 $ 冊ずつ持っている状態になります。 この状態から『すぬけ君』を読み始めると、高橋君は $ 1 $ 巻、$ 2 $ 巻、$ 3 $ 巻、$ 4 $ 巻を読み、続いて $ 5 $ 巻を読もうとしますが持っていないためこの時点で『すぬけ君』を読むのをやめます。 操作の方法を変えても $ 5 $ 巻を読むことは出来ないため、$ 4 $ が答えです。

### Sample Explanation 2

高橋君は同じ巻を $ 2 $ 冊以上持っているかもしれません。 この入力に対しては以下のように $ 4 $ 回操作をしてから『すぬけ君』を読み始めることで $ 5 $ 巻まで読むことが出来、これが最大です。 - $ 1 $ 巻を $ 2 $ 冊選んで売り、代わりに $ 2 $ 巻を選んで $ 1 $ 冊買う - $ 1 $ 巻を $ 2 $ 冊選んで売り、代わりに $ 3 $ 巻を選んで $ 1 $ 冊買う - $ 1 $ 巻を $ 2 $ 冊選んで売り、代わりに $ 4 $ 巻を選んで $ 1 $ 冊買う - $ 1 $ 巻を $ 2 $ 冊選んで売り、代わりに $ 5 $ 巻を選んで $ 1 $ 冊買う

### Sample Explanation 3

高橋君は $ 1 $ 巻を読めません。

## 样例 #1

### 输入

```
6

1 2 4 6 7 271
```

### 输出

```
4
```

## 样例 #2

### 输入

```
10

1 1 1 1 1 1 1 1 1 1
```

### 输出

```
5
```

## 样例 #3

### 输入

```
1

5
```

### 输出

```
0
```



---

---
title: "[ABC272D] Root M Leaper"
layout: "post"
diff: 普及/提高-
pid: AT_abc272_d
tag: []
---

# [ABC272D] Root M Leaper

## 题目描述

有一个大小为 $N\times N$ 的方格图（网格）。在本题中，我们所说的方格 $(i,j)$ 指网格从上往下数第 $i$ 行，从左往右数第 $j$ 列。

最开始，有一个棋子位于方格 $(1,1)$ 。现在你可以进行下面这个操作若干次：

+ 当前棋子位于 $(i,j)$ ，那么移动它到一个距离它刚好 $\sqrt{M}$ 的点（不超出网格）。

本题中的“**距离**”，指欧几里得距离。即方格 $(i,j)$ 与 $(k,l)$ 的距离是 $\sqrt{(i-k)^2+(j-l)^2}$ 。

现在对于整个网格，请你确定棋子能否到达方格 $(i,j)$ 。如果可以，输出到达它的最少操作次数；如果不行，输出 ```-1``` 。

## 输入格式

输入两个正整数 $N$ ， $M$ 。
>$N\ M$

## 输出格式

输出共 $N$ 行。 第 $i$ 行包含 $N$ 个整数，中间以一个空格隔开。如果棋子可以到达方格 $(i,j)$ ，第 $i$ 行第 $j$ 列应输出到达它的最少操作次数；如果不行，输出 ```-1``` 。

## 说明/提示

- $ 1\ \le\ N\ \le\ 400 $
- $ 1\ \le\ M\ \le\ 10^6 $
- 输入全为整数


对于**样例1**，你可以把棋子通过一定次数的操作挪到这个方格图的任意位置。

比如说，我们可以通过如下操作把棋子移到 $(2,2)$ ：

1. 开始棋子在 $(1,1)$ 。 $(1,1)$ 到 $(1,2)$ 的距离刚好是 $\sqrt 1$ ，所以我们把它移到 $(1,2)$ 。
1. 现在棋子在 $(1,2)$ 了。$(1,2)$ 到 $(2,2)$的距离也刚好是 $\sqrt 1$ ，所以我们就把它移到了 $(2,2)$ 。

## 样例 #1

### 输入

```
3 1
```

### 输出

```
0 1 2

1 2 3

2 3 4
```

## 样例 #2

### 输入

```
10 5
```

### 输出

```
0 3 2 3 2 3 4 5 4 5

3 4 1 2 3 4 3 4 5 6

2 1 4 3 2 3 4 5 4 5

3 2 3 2 3 4 3 4 5 6

2 3 2 3 4 3 4 5 4 5

3 4 3 4 3 4 5 4 5 6

4 3 4 3 4 5 4 5 6 5

5 4 5 4 5 4 5 6 5 6

4 5 4 5 4 5 6 5 6 7

5 6 5 6 5 6 5 6 7 6
```



---

---
title: "[ABC273D] LRUD Instructions"
layout: "post"
diff: 普及/提高-
pid: AT_abc273_d
tag: []
---

# [ABC273D] LRUD Instructions

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc273/tasks/abc273_d

$ H $ 行 $ W $ 列のグリッドがあります。上から $ i $ 行目、左から $ j $ 列目にあるマスをマス $ (i,\ j) $ で表します。  
 $ N $ 個のマス $ (r_1,\ c_1),\ (r_2,\ c_2),\ \ldots,\ (r_N,\ c_N) $ は壁になっています。

はじめ、高橋君はマス $ (r_\mathrm{s},\ c_\mathrm{s}) $ にいます。

高橋君に $ Q $ 個の指示が与えられます。 $ i\ =\ 1,\ 2,\ \ldots,\ Q $ について、$ i $ 番目の指示は文字 $ d_i $ と正整数 $ l_i $ の組で表されます。$ d_i $ は `L` 、`R` 、`U` 、`D` のいずれかの文字であり、それぞれ左、右、上、下の方向を表します。

$ i $ 番目の指示に対して高橋君は下記の行動を $ l_i $ 回繰り返します。

> 現在いるマスに対して、$ d_i $ が表す向きに壁のないマスが隣接しているなら、そのマスに移動する。 そのようなマスが存在しない場合は、何もしない。

$ i\ =\ 1,\ 2,\ \ldots,\ Q $ について、$ i $ 番目までの指示を実行した直後に高橋君がいるマスを出力してください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ H $ $ W $ $ r_\mathrm{s} $ $ c_\mathrm{s} $ $ N $ $ r_1 $ $ c_1 $ $ r_2 $ $ c_2 $ $ \vdots $ $ r_N $ $ c_N $ $ Q $ $ d_1 $ $ l_1 $ $ d_2 $ $ l_2 $ $ \vdots $ $ d_Q $ $ l_Q $

## 输出格式

$ Q $ 行出力せよ。 下記の形式にしたがい、$ i\ =\ 1,\ 2,\ \ldots,\ Q $ について、$ i $ 番目までの指示を実行した直後に高橋君がいるマス $ (R_i,\ C_i) $ を $ i $ 行目に出力せよ。

> $ R_1 $ $ C_1 $ $ R_2 $ $ C_2 $ $ \vdots $ $ R_Q $ $ C_Q $

## 说明/提示

### 制約

- $ 2\ \leq\ H,\ W\ \leq\ 10^9 $
- $ 1\ \leq\ r_\mathrm{s}\ \leq\ H $
- $ 1\ \leq\ c_\mathrm{s}\ \leq\ W $
- $ 0\ \leq\ N\ \leq\ 2\ \times\ 10^5 $
- $ 1\ \leq\ r_i\ \leq\ H $
- $ 1\ \leq\ c_i\ \leq\ W $
- $ i\ \neq\ j\ \Rightarrow\ (r_i,\ c_i)\ \neq\ (r_j,\ c_j) $
- すべての $ i\ =\ 1,\ 2,\ \ldots,\ N $について、$ (r_\mathrm{s},\ c_\mathrm{s})\ \neq\ (r_i,\ c_i) $
- $ 1\ \leq\ Q\ \leq\ 2\ \times\ 10^5 $
- $ d_i $ は `L` 、`R` 、`U` 、`D` のいずれかの文字
- $ 1\ \leq\ l_i\ \leq\ 10^9 $
- $ d_i $ 以外の入力値は整数

### Sample Explanation 1

与えられるグリッドと高橋君の初期位置は下記の通りです。 ここで、`#` は壁のマスを、`T` は高橋君がいるマスを表し、`.` がその他のマスを表します。 ``` ...#. .#... ..... ...T. ..#.. ``` $ 1 $ つ目の指示に対して高橋君は、左に $ 2 $ マス移動し、高橋君の位置は下記の通り、マス $ (4,\ 2) $ になります。 ``` ...#. .#... ..... .T... ..#.. ``` $ 2 $ つ目の指示に対して高橋君は、上に $ 1 $ マスに移動した後、次の移動先が壁であるために「何もしない」を $ 2 $ 回行います。その結果、高橋君の位置は下記の通り、マス $ (3,\ 2) $ になります。 ``` ...#. .#... .T... ..... ..#.. ``` $ 3 $ つ目の指示に対して高橋君は、左に $ 1 $ マス移動した後、次の移動先となるマスが存在しないために「何もしない」を $ 1 $ 回行います。その結果、高橋君の位置は下記の通り、マス $ (3,\ 1) $ になります。 ``` ...#. .#... T.... ..... ..#.. ``` $ 4 $ つ目の指示に対して高橋君は、右に $ 4 $ マス移動し、高橋君の位置は下記の通り、マス $ (3,\ 5) $ になります。 ``` ...#. .#... ....T ..... ..#.. ```

## 样例 #1

### 输入

```
5 5 4 4

3

5 3

2 2

1 4

4

L 2

U 3

L 2

R 4
```

### 输出

```
4 2

3 2

3 1

3 5
```

## 样例 #2

### 输入

```
6 6 6 3

7

3 1

4 3

2 6

3 4

5 5

1 1

3 2

10

D 3

U 3

L 2

D 2

U 3

D 3

U 3

R 3

L 3

D 1
```

### 输出

```
6 3

5 3

5 1

6 1

4 1

6 1

4 1

4 2

4 1

5 1
```



---

---
title: "[ABC274D] Robot Arms 2"
layout: "post"
diff: 普及/提高-
pid: AT_abc274_d
tag: []
---

# [ABC274D] Robot Arms 2

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc274/tasks/abc274_d

長さ $ N $ の正整数列 $ A\ =\ (A_1,\ A_2,\ \dots,\ A_N) $ および整数 $ x,\ y $ が与えられます。  
次の条件をすべて満たすように、$ xy $ 座標平面上に $ N+1 $ 個の点 $ p_1,\ p_2,\ \dots,\ p_N,\ p_{N+1} $ を配置することができるか判定してください。(同じ座標に $ 2 $ 個以上の点を配置してもよいです。)

- $ p_1\ =\ (0,\ 0) $
- $ p_2\ =\ (A_1,\ 0) $
- $ p_{N+1}\ =\ (x,\ y) $
- 点 $ p_i $ と点 $ p_{i+1} $ の距離は $ A_i $ ($ 1\ \leq\ i\ \leq\ N $)
- 線分 $ p_i\ p_{i+1} $ と線分 $ p_{i+1}\ p_{i+2} $ のなす角は $ 90 $ 度 ($ 1\ \leq\ i\ \leq\ N\ -\ 1 $)

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ x $ $ y $ $ A_1 $ $ A_2 $ $ \dots $ $ A_N $

## 输出格式

問題文の条件をすべて満たすように $ p_1,\ p_2,\ \dots,\ p_N,\ p_{N+1} $ を配置することができる場合は `Yes` を、そうでない場合は `No` を出力せよ。

## 说明/提示

### 制約

- $ 2\ \leq\ N\ \leq\ 10^3 $
- $ 1\ \leq\ A_i\ \leq\ 10 $
- $ |x|,\ |y|\ \leq\ 10^4 $
- 入力される値はすべて整数

### Sample Explanation 1

$ xy $ 座標平面に $ p_1\ =\ (0,\ 0),\ p_2\ =\ (2,\ 0),\ p_3\ =\ (2,\ 1),\ p_4\ =\ (-1,\ 1) $ として点を配置したのが以下の図です。これは問題文の条件をすべて満たしています。 !\[\](https://img.atcoder.jp/ghi/9e66a2e8cd081f011d3baba22dbe64fa.jpg)

### Sample Explanation 2

$ p_1\ =\ (0,\ 0),\ p_2\ =\ (2,\ 0),\ p_3\ =\ (2,\ 2),\ p_4\ =\ (0,\ 2),\ p_5\ =\ (0,\ 0),\ p_6\ =\ (2,\ 0) $ とすれば問題文の条件をすべて満たすことができます。同じ座標に複数の点を置いてもよいのに注意してください。

## 样例 #1

### 输入

```
3 -1 1
2 1 3
```

### 输出

```
Yes
```

## 样例 #2

### 输入

```
5 2 0
2 2 2 2 2
```

### 输出

```
Yes
```

## 样例 #3

### 输入

```
4 5 5
1 2 3 4
```

### 输出

```
No
```

## 样例 #4

### 输入

```
3 2 7
2 7 4
```

### 输出

```
No
```

## 样例 #5

### 输入

```
10 8 -7
6 10 4 1 5 9 8 6 5 1
```

### 输出

```
Yes
```



---

---
title: "[ABC275C] Counting Squares"
layout: "post"
diff: 普及/提高-
pid: AT_abc275_c
tag: []
---

# [ABC275C] Counting Squares

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc275/tasks/abc275_c

二次元平面があります。$ 1 $ 以上 $ 9 $ 以下の整数 $ r,c $ について、$ S_{r} $ の $ c $ 番目の文字が `#` であるとき座標 $ (r,c) $ にポーンが置いてあり、$ S_{r} $ の $ c $ 番目の文字が `.` であるとき座標 $ (r,c) $ に何も置かれていません。

この平面上の正方形であって、$ 4 $ 頂点全てにポーンが置いてあるものの個数を求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ S_1 $ $ S_2 $ $ \vdots $ $ S_9 $

## 输出格式

答えを出力せよ。

## 说明/提示

### 制約

- $ S_1,\ldots,S_9 $ はそれぞれ `#` と `.` からなる長さ $ 9 $ の文字列

### Sample Explanation 1

座標 $ (1,1),(1,2),(2,2),(2,1) $ を頂点とする正方形は、$ 4 $ 頂点全てにポーンが置かれています。 座標 $ (4,8),(5,6),(7,7),(6,9) $ を頂点とする正方形も、$ 4 $ 頂点全てにポーンが置かれています。 よって答えは $ 2 $ です。

## 样例 #1

### 输入

```
##.......
##.......
.........
.......#.
.....#...
........#
......#..
.........
.........
```

### 输出

```
2
```

## 样例 #2

### 输入

```
.#.......
#.#......
.#.......
.........
....#.#.#
.........
....#.#.#
........#
.........
```

### 输出

```
3
```



---

---
title: "[ABC275E] Sugoroku 4"
layout: "post"
diff: 普及/提高-
pid: AT_abc275_e
tag: []
---

# [ABC275E] Sugoroku 4

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc275/tasks/abc275_e

高橋君は双六で遊んでいます。

この双六には $ 0 $ から $ N $ の番号がついた $ N+1 $ 個のマスがあります。 高橋君はマス $ 0 $ からスタートし、マス $ N $ を目指します。

この双六では、$ 1 $ から $ M $ までの $ M $ 種類の目が等確率で出るルーレットを使います。 高橋君はルーレットを回して出た目の数だけ進みます。もし、マス $ N $ を超えて進むことになる場合、マス $ N $ を超えた分だけ引き返します。

例えば、 $ N=4 $ で高橋君がマス $ 3 $ にいるとき、ルーレットを回して出た目が $ 4 $ の場合は、マス $ 4 $ を $ 3+4-4=3 $ マス超えてしまいます。そのため、 $ 3 $ マスだけマス $ 4 $ から引き返し、マス $ 1 $ に移動します。

高橋君がマス $ N $ に到達するとゴールとなり、双六を終了します。

高橋君がルーレットを $ K $ 回まで回す時、ゴールできる確率を $ \text{mod\ }\ 998244353 $ で求めてください。

 確率 $ \text{mod\ }\ 998244353 $ の定義この問題で求める確率は必ず有理数になることが証明できます。 また、この問題の制約下では、求める確率を既約分数 $ \frac{y}{x} $ で表したときに $ x $ が $ 998244353 $ で割り切れないことが保証されます。

このとき $ xz\ \equiv\ y\ \pmod{998244353} $ を満たすような $ 0 $ 以上 $ 998244352 $ 以下の整数 $ z $ が一意に定まります。この $ z $ を答えてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ M $ $ K $

## 输出格式

答えを出力せよ。

## 说明/提示

### 制約

- $ M\ \leq\ N\ \leq\ 1000 $
- $ 1\ \leq\ M\ \leq\ 10 $
- $ 1\ \leq\ K\ \leq\ 1000 $
- 入力は全て整数

### Sample Explanation 1

$ 1 $ 回ルーレットを回してゴールできるのは、ルーレットで $ 2 $ が出るときです。よってゴールできる確率は $ \frac{1}{2} $ です。 このとき、$ 2\times\ 499122177\ \equiv\ 1\ \pmod{998244353} $ が成り立つので、答えとして $ 499122177 $ を出力してください。

## 样例 #1

### 输入

```
2 2 1
```

### 输出

```
499122177
```

## 样例 #2

### 输入

```
10 5 6
```

### 输出

```
184124175
```

## 样例 #3

### 输入

```
100 1 99
```

### 输出

```
0
```



---

---
title: "[ABC276D] Divide by 2 or 3"
layout: "post"
diff: 普及/提高-
pid: AT_abc276_d
tag: []
---

# [ABC276D] Divide by 2 or 3

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc276/tasks/abc276_d

正整数列 $ A=(a_1,a_2,\ldots,a_N) $ が与えられます。  
 あなたは以下の操作のうち $ 1 $ つを選んで行うことを $ 0 $ 回以上何度でも繰り返せます。

- $ 1\ \leq\ i\ \leq\ N $ かつ $ a_i $ が $ 2 $ の倍数であるような整数 $ i $ を選び、$ a_i $ を $ \frac{a_i}{2} $ に置き換える
- $ 1\ \leq\ i\ \leq\ N $ かつ $ a_i $ が $ 3 $ の倍数であるような整数 $ i $ を選び、$ a_i $ を $ \frac{a_i}{3} $ に置き換える

あなたの目標は $ A $ が $ a_1=a_2=\ldots=a_N $ を満たす状態にすることです。  
 目標を達成するために必要な操作の回数の最小値を求めてください。ただし、どのように操作を行っても目標を達成できない場合、代わりに `-1` と出力してください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ a_1 $ $ a_2 $ $ \ldots $ $ a_N $

## 输出格式

答えを出力せよ。

## 说明/提示

### 制約

- $ 2\ \leq\ N\ \leq\ 1000 $
- $ 1\ \leq\ a_i\ \leq\ 10^9 $
- 入力はすべて整数

### Sample Explanation 1

次のように操作をすると $ 3 $ 回で目標を達成でき、これが最小の回数です。 - $ a_i $ が $ 2 $ の倍数であるような整数 $ i $ として $ 2 $ を選び、$ a_2 $ を $ \frac{a_2}{2} $ に置き換える。$ A $ は $ (1,2,3) $ となる。 - $ a_i $ が $ 2 $ の倍数であるような整数 $ i $ として $ 2 $ を選び、$ a_2 $ を $ \frac{a_2}{2} $ に置き換える。$ A $ は $ (1,1,3) $ となる。 - $ a_i $ が $ 3 $ の倍数であるような整数 $ i $ として $ 3 $ を選び、$ a_3 $ を $ \frac{a_3}{3} $ に置き換える。$ A $ は $ (1,1,1) $ となる。

### Sample Explanation 2

どのように操作を行っても目標を達成できません。

## 样例 #1

### 输入

```
3

1 4 3
```

### 输出

```
3
```

## 样例 #2

### 输入

```
3

2 7 6
```

### 输出

```
-1
```

## 样例 #3

### 输入

```
6

1 1 1 1 1 1
```

### 输出

```
0
```



---

---
title: "[ABC276E] Round Trip"
layout: "post"
diff: 普及/提高-
pid: AT_abc276_e
tag: []
---

# [ABC276E] Round Trip

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc276/tasks/abc276_e

縦 $ H $ 行、横 $ W $ 列のマス目があり、上から $ i\ \,\ (1\ \leq\ i\ \leq\ H) $ 行目、左から $ j\ \,\ (1\ \leq\ j\ \leq\ W) $ 列目のマスを $ (i,\ j) $ と表します。

各マスは「始点」「道」「障害物」のいずれかです。  
マス $ (i,\ j) $ の状態は文字 $ C_{i,\ j} $ で表され、$ C_{i,\ j}\ = $ `S` なら始点、$ C_{i,\ j}\ = $ `.` なら道、$ C_{i,\ j}\ = $ `#` なら障害物です。始点のマスはただ一つ存在します。

始点のマスを出発し、上下または左右に隣接するマスに移動することを繰り返して、障害物のマスを通らずに始点のマスへ戻ってくるような長さ $ 4 $ 以上の経路であって、最初と最後を除き同じマスを通らないようなものが存在するか判定してください。  
より厳密には、以下の条件を満たす整数 $ n $ およびマスの列 $ (x_0,\ y_0),\ (x_1,\ y_1),\ \dots,\ (x_n,\ y_n) $ が存在するか判定してください。

- $ n\ \geq\ 4 $
- $ C_{x_0,\ y_0}\ =\ C_{x_n,\ y_n}\ = $ `S`
- $ 1\ \leq\ i\ \leq\ n\ -\ 1 $ ならば $ C_{x_i,\ y_i}\ = $ `.`
- $ 1\ \leq\ i\ \lt\ j\ \leq\ n\ -\ 1 $ ならば $ (x_i,\ y_i)\ \neq\ (x_j,\ y_j) $
- $ 0\ \leq\ i\ \leq\ n\ -\ 1 $ ならばマス $ (x_i,\ y_i) $ とマス $ (x_{i+1},\ y_{i+1}) $ は上下または左右に隣接する

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ H $ $ W $ $ C_{1,\ 1}\ \ldots\ C_{1,\ W} $ $ \vdots $ $ C_{H,\ 1}\ \ldots\ C_{H,\ W} $

## 输出格式

問題文の条件を満たす経路が存在するならば `Yes` を、存在しないならば `No` を出力せよ。

## 说明/提示

### 制約

- $ 4\ \leq\ H\ \times\ W\ \leq\ 10^6 $
- $ H,\ W $ は $ 2 $ 以上の整数
- $ C_{i,\ j} $ は `S`、`.`、`#` のいずれか
- $ C_{i,\ j}\ = $ `S` となる $ (i,\ j) $ がただ一つ存在する

### Sample Explanation 1

$ (3,\ 2)\ \rightarrow\ (2,\ 2)\ \rightarrow\ (1,\ 2)\ \rightarrow\ (1,\ 3)\ \rightarrow\ (1,\ 4)\ \rightarrow\ (2,\ 4)\ \rightarrow\ (3,\ 4)\ \rightarrow\ (3,\ 3)\ \rightarrow\ (3,\ 2) $ という経路が条件を満たします。

## 样例 #1

### 输入

```
4 4
....
#.#.
.S..
.##.
```

### 输出

```
Yes
```

## 样例 #2

### 输入

```
2 2
S.
.#
```

### 输出

```
No
```

## 样例 #3

### 输入

```
5 7
.#...#.
..#.#..
...S...
..#.#..
.#...#.
```

### 输出

```
No
```



---

---
title: "[ABC277D] Takahashi's Solitaire"
layout: "post"
diff: 普及/提高-
pid: AT_abc277_d
tag: []
---

# [ABC277D] Takahashi's Solitaire

## 题目描述

【题面翻译】

给定 $n$ 张牌，每张牌上有一个数字 $a_i$。

你要先选一张牌放在桌子上。假设当前最后一张放置的牌为 $x$，接下来，你每次只能放写着 $x$ 或 $(x + 1) \bmod m$ 的牌。

一直操作下去。你需要让你手上剩下的牌的总和**最小**。

translated by @[liangbowen](https://www.luogu.com.cn/user/367488).

## 输入格式

第一行两个数 $n$，$m$。

接下来 $n$ 个数，表示卡牌上的数字 $a_i$。

## 输出格式

输出最小和值。

## 说明/提示

$1 \le n \le 2 \times 10^5$

$2 \le m \le 10^9$

保证 $0 \le a_i < m$。

## 样例 #1

### 输入

```
9 7

3 0 2 5 5 3 0 6 3
```

### 输出

```
11
```

## 样例 #2

### 输入

```
1 10

4
```

### 输出

```
0
```

## 样例 #3

### 输入

```
20 20

18 16 15 9 8 8 17 1 3 17 11 9 12 11 7 3 2 14 3 12
```

### 输出

```
99
```



---

---
title: "[ABC278D] All Assign Point Add"
layout: "post"
diff: 普及/提高-
pid: AT_abc278_d
tag: []
---

# [ABC278D] All Assign Point Add

## 题目描述

【题目翻译】

给定长度为 $n$ 的数组 $a$，每次有三种操作：

+ $op_i = 1$，表示将 $a$ 数组全部元素替换成 $k$。
+ $op_i = 2$，表示 $a_i \gets a_i + k$。
+ $op_i = 3$，表示查询 $a_i$ 的值。

对于每个 $op_i = 3$，输出结果。

translated by @[liangbowen](https://www.luogu.com.cn/user/367488).

## 输入格式

第一行一个数 $n$。

接下来 $n$ 个数，表示 $a$ 数组。

第三行一个数 $q$。$q$ 表示操作次数。

接下来 $q$ 行，每行表示一次操作：

+ $op_i = 1$，则再读入一个数 $k$。
+ $op_i = 2$，则再读入两个数 $i$，$k$。
+ $op_i = 3$，则再读入一个数 $i$。

## 输出格式

对于每个 $op_i = 3$，输出结果。

## 说明/提示

$1 \le n, q \le 2 \times 10^5$

保证 $1 \le i \le n$，$1 \le a_i, k \le 10^9$。

## 样例 #1

### 输入

```
5

3 1 4 1 5

6

3 2

2 3 4

3 3

1 1

2 3 4

3 3
```

### 输出

```
1

8

5
```

## 样例 #2

### 输入

```
1

1000000000

8

2 1 1000000000

2 1 1000000000

2 1 1000000000

2 1 1000000000

2 1 1000000000

2 1 1000000000

2 1 1000000000

3 1
```

### 输出

```
8000000000
```

## 样例 #3

### 输入

```
10

1 8 4 15 7 5 7 5 8 0

20

2 7 0

3 7

3 8

1 7

3 3

2 4 4

2 4 9

2 10 5

1 10

2 4 2

1 10

2 3 1

2 8 11

2 3 14

2 1 9

3 8

3 8

3 1

2 6 5

3 7
```

### 输出

```
7

5

7

21

21

19

10
```



---

---
title: "[ABC278E] Grid Filling"
layout: "post"
diff: 普及/提高-
pid: AT_abc278_e
tag: []
---

# [ABC278E] Grid Filling

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc278/tasks/abc278_e

縦 $ H $ 行、横 $ W $ 列のグリッドがあります。 上から $ i $ 行目、左から $ j $ 列目のマスを $ (i,j) $ で表します。 $ (i,j)\ (1\leq\ i\leq\ H,1\leq\ j\leq\ W) $ には $ 1 $ 以上 $ N $ 以下の整数 $ A\ _\ {i,j} $ が書かれています。

整数 $ h,w $ が与えられます。$ 0\leq\ k\leq\ H-h,0\leq\ l\leq\ W-w $ を満たすすべての $ (k,l) $ の組について、次の問題を解いてください。

- $ k\lt\ i\leq\ k+h,l\lt\ j\leq\ l+w $ を満たす $ (i,j) $ を塗りつぶしたとき、塗りつぶされていないマスに書かれている数が何種類あるか求めよ。
 
ただし、問題を解く際に実際にマスを塗りつぶすことはない（各問題が独立である）ことに注意してください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ H $ $ W $ $ N $ $ h $ $ w $ $ A\ _\ {1,1} $ $ A\ _\ {1,2} $ $ \dots $ $ A\ _\ {1,W} $ $ A\ _\ {2,1} $ $ A\ _\ {2,2} $ $ \dots $ $ A\ _\ {2,W} $ $ \vdots $ $ A\ _\ {H,1} $ $ A\ _\ {H,2} $ $ \dots $ $ A\ _\ {H,W} $

## 输出格式

$ (k,l) $ に対する答えを $ \operatorname{ans}_{k,l} $ として、以下の形式で出力せよ。

> $ \operatorname{ans}\ _\ {0,0} $ $ \operatorname{ans}\ _\ {0,1} $ $ \dots $ $ \operatorname{ans}\ _\ {0,W-w} $ $ \operatorname{ans}\ _\ {1,0} $ $ \operatorname{ans}\ _\ {1,1} $ $ \dots $ $ \operatorname{ans}\ _\ {1,W-w} $ $ \vdots $ $ \operatorname{ans}\ _\ {H-h,0} $ $ \operatorname{ans}\ _\ {H-h,1} $ $ \dots $ $ \operatorname{ans}\ _\ {H-h,W-w} $

## 说明/提示

### 制約

- $ 1\ \leq\ H,W,N\ \leq\ 300 $
- $ 1\ \leq\ h\ \leq\ H $
- $ 1\ \leq\ w\ \leq\ W $
- $ (h,w)\neq(H,W) $
- $ 1\ \leq\ A\ _\ {i,j}\ \leq\ N\ (1\leq\ i\leq\ H,1\leq\ j\leq\ W) $
- 入力される値はすべて整数
 
### Sample Explanation 1

与えられた盤面は下の図のようになります。 !\[\](https://img.atcoder.jp/abc278/d3542563ea2e11fda78c3307c0a2b0fe.png) 例えば、$ (k,l)=(0,0) $ のときは塗りつぶされていないマスに書かれている数は $ 1,3,4,5 $ の $ 4 $ 種類なので、$ 4 $ が答えになります。

## 样例 #1

### 输入

```
3 4 5 2 2

2 2 1 1

3 2 5 3

3 4 4 3
```

### 输出

```
4 4 3

5 3 4
```

## 样例 #2

### 输入

```
5 6 9 3 4

7 1 5 3 9 5

4 5 4 5 1 2

6 1 6 2 9 7

4 7 1 5 8 8

3 4 3 3 5 3
```

### 输出

```
8 8 7

8 9 7

8 9 8
```

## 样例 #3

### 输入

```
9 12 30 4 7

2 2 2 2 2 2 2 2 2 2 2 2

2 2 20 20 2 2 5 9 10 9 9 23

2 29 29 29 29 29 28 28 26 26 26 15

2 29 29 29 29 29 25 25 26 26 26 15

2 29 29 29 29 29 25 25 8 25 15 15

2 18 18 18 18 1 27 27 25 25 16 16

2 19 22 1 1 1 7 3 7 7 7 7

2 19 22 22 6 6 21 21 21 7 7 7

2 19 22 22 22 22 21 21 21 24 24 24
```

### 输出

```
21 20 19 20 18 17

20 19 18 19 17 15

21 19 20 19 18 16

21 19 19 18 19 18

20 18 18 18 19 18

18 16 17 18 19 17
```



---

---
title: "[ABC279D] Freefall"
layout: "post"
diff: 普及/提高-
pid: AT_abc279_d
tag: []
---

# [ABC279D] Freefall

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc279/tasks/abc279_d

スーパーマンである高橋くんは、地上で困っている人を助けるため、あるビルの屋上から飛び降りようとしています。 高橋くんがいる星には重力の大きさを表す $ g $ という値が定まっており、 高橋くんが落下を開始してから地面に到達するまでにかかる時間は $ \frac{A}{\sqrt{g}} $ です。

現在の時刻は $ 0 $ であり、$ g\ =\ 1 $ が成り立ちます。 高橋くんは、今から次の操作を好きな回数（$ 0 $ 回でもよい）行います。

- 超能力により $ g $ の値を $ 1 $ 増やす。時間が $ B $ 経過する。
 
その後、高橋くんはビルから飛び降ります。落下を開始した後は $ g $ の値を変えることはできません。 また、操作によって経過する時間と落下にかかる時間以外は考えないものとします。

高橋くんが地面に到達できる最も早い時刻を求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ A $ $ B $

## 输出格式

高橋くんが地面に到達できる最も早い時刻を出力せよ。 出力は、真の値との絶対誤差または相対誤差が $ 10^{-6} $ 以下のとき正解と判定される。

## 说明/提示

### 制約

- $ 1\ \leq\ A\ \leq\ 10^{18} $
- $ 1\ \leq\ B\ \leq\ 10^{18} $
- 入力は全て整数
 
### Sample Explanation 1

\- 操作を $ 0 $ 回行うとき、地面に到達する時刻は $ 1\times\ 0+\frac{10}{\sqrt{1}}\ =\ 10 $ です。 - 操作を $ 1 $ 回行うとき、地面に到達する時刻は $ 1\times\ 1+\frac{10}{\sqrt{2}}\ \fallingdotseq\ 8.07 $ です。 - 操作を $ 2 $ 回行うとき、地面に到達する時刻は $ 1\times\ 2+\frac{10}{\sqrt{3}}\ \fallingdotseq\ 7.77 $ です。 - 操作を $ 3 $ 回行うとき、地面に到達する時刻は $ 1\times\ 3+\frac{10}{\sqrt{4}}\ =\ 8 $ です。 操作を $ 4 $ 回以上行っても、地面への到達時刻は遅くなるのみです。 よって、操作を $ 2 $ 回行ってから飛び降りるのが最適で、答えは $ 2+\frac{10}{\sqrt{3}} $ です。

### Sample Explanation 2

操作を $ 1 $ 回も行わないのが最適です。

## 样例 #1

### 输入

```
10 1
```

### 输出

```
7.7735026919
```

## 样例 #2

### 输入

```
5 10
```

### 输出

```
5.0000000000
```

## 样例 #3

### 输入

```
1000000000000000000 100
```

### 输出

```
8772053214538.5976562500
```



---

---
title: "[ABC280D] Factorial and Multiple"
layout: "post"
diff: 普及/提高-
pid: AT_abc280_d
tag: []
---

# [ABC280D] Factorial and Multiple

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc280/tasks/abc280_d

$ 2 $ 以上の整数 $ K $ が与えられます。  
正の整数 $ N $ であって、$ N! $ が $ K $ の倍数となるようなもののうち最小のものを求めてください。

ただし、$ N! $ は $ N $ の階乗を表し、問題の制約下で、そのような $ N $ が必ず存在することが証明できます。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ K $

## 输出格式

$ N! $ が $ K $ の倍数となるような最小の正整数 $ N $ を出力せよ。

## 说明/提示

### 制約

- $ 2\leq\ K\leq\ 10^{12} $
- $ K $ は整数

### Sample Explanation 1

\- $ 1!=1 $ - $ 2!=2\times\ 1=2 $ - $ 3!=3\times\ 2\times\ 1=6 $ - $ 4!=4\times\ 3\times\ 2\times\ 1=24 $ - $ 5!=5\times\ 4\times\ 3\times\ 2\times\ 1=120 $ より、$ N! $ が $ 30 $ の倍数となる最小の正整数 $ N $ は $ 5 $ です。よって、$ 5 $ を出力します。

## 样例 #1

### 输入

```
30
```

### 输出

```
5
```

## 样例 #2

### 输入

```
123456789011
```

### 输出

```
123456789011
```

## 样例 #3

### 输入

```
280
```

### 输出

```
7
```



---

---
title: "[ABC280E] Critical Hit"
layout: "post"
diff: 普及/提高-
pid: AT_abc280_e
tag: []
---

# [ABC280E] Critical Hit

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc280/tasks/abc280_e

最初、体力が $ N $ であるモンスターが $ 1 $ 体います。  
 高橋君はモンスターに対し、モンスターの体力が $ 1 $ 以上残っている限り繰り返し攻撃を行います。

高橋君は $ 1 $ 回の攻撃で、$ \frac{P}{100} $ の確率でモンスターの体力を $ 2 $ 減らし、 $ 1-\frac{P}{100} $ の確率でモンスターの体力を $ 1 $ 減らします。

モンスターの体力が $ 0 $ 以下になるまでに行う攻撃回数の期待値を $ \text{mod\ }\ 998244353 $ で出力してください（注記参照）。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ P $

## 输出格式

高橋君の攻撃回数の期待値を $ \text{mod\ }\ 998244353 $ で出力せよ。

## 说明/提示

### 注記

求める期待値は必ず有限値かつ有理数となることが証明できます。また、この問題の制約下では、その値を互いに素な $ 2 $ つの整数 $ P $, $ Q $ を用いて $ \frac{P}{Q} $ と表したとき、$ R\ \times\ Q\ \equiv\ P\pmod{998244353} $ かつ $ 0\ \leq\ R\ \lt\ 998244353 $ を満たす整数 $ R $ がただ一つ存在することが証明できます。この $ R $ を出力してください。

### 制約

- $ 1\ \leq\ N\ \leq\ 2\times\ 10^5 $
- $ 0\ \leq\ P\ \leq\ 100 $
- 入力は全て整数
 
### Sample Explanation 1

高橋君は $ 1 $ 回の攻撃で、 $ \frac{10}{100}=\frac{1}{10} $ の確率でモンスターの体力を $ 2 $ 減らし、 $ 1-\frac{10}{100}=\frac{9}{10} $ の確率でモンスターの体力を $ 1 $ 減らします。 - 最初、モンスターの体力は $ 3 $ です。 - $ 1 $ 回目の攻撃の後、$ \frac{9}{10} $の確率でモンスターの体力は $ 2 $、$ \frac{1}{10} $の確率でモンスターの体力は $ 1 $ となります。 - $ 2 $ 回目の攻撃の後、$ \frac{81}{100} $の確率でモンスターの体力は $ 1 $、$ \frac{18}{100} $ の確率でモンスターの体力は $ 0 $、$ \frac{1}{100} $ の確率でモンスターの体力は $ -1 $ となります。 $ \frac{18}{100}+\frac{1}{100}=\frac{19}{100} $ の確率で体力は $ 0 $ 以下となり、高橋君は $ 2 $ 回で攻撃をやめます。 - $ 2 $ 回目の攻撃の後で体力が $ 1 $ 残っている場合、$ 3 $ 回目の攻撃の後でモンスターの体力は必ず $ 0 $ 以下となり、高橋君は $ 3 $ 回で攻撃をやめます。 よって、期待値は $ 2\times\ \frac{19}{100}+3\times\left(1-\frac{19}{100}\right)=\frac{281}{100} $ となります。$ 229596204\ \times\ 100\ \equiv\ 281\pmod{998244353} $ であるため、$ 229596204 $ を出力します。

### Sample Explanation 2

高橋君は $ 1 $ 回の攻撃で、つねにモンスターの体力を $ 2 $ 減らします。 $ 2 $ 回目の攻撃が終わった時点では体力が $ 5-2\times\ 2=1 $ 残っているため、$ 3 $ 回目の攻撃を行う必要があります。

## 样例 #1

### 输入

```
3 10
```

### 输出

```
229596204
```

## 样例 #2

### 输入

```
5 100
```

### 输出

```
3
```

## 样例 #3

### 输入

```
280 59
```

### 输出

```
567484387
```



---

---
title: "[ABC287D] Match or Not"
layout: "post"
diff: 普及/提高-
pid: AT_abc287_d
tag: []
---

# [ABC287D] Match or Not

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc287/tasks/abc287_d

英小文字と `?` からなる文字列 $ S,T $ が与えられます。ここで、$ |S|\ \gt\ |T| $ が成り立ちます(文字列 $ X $ に対し、 $ |X| $ で $ X $ の長さを表します)。

また、$ |X|=|Y| $ を満たす文字列 $ X,Y $ は、次の条件を満たすとき及びそのときに限り**マッチする**といいます。

- $ X,Y $ に含まれる `?` をそれぞれ独立に好きな英小文字に置き換えることで $ X $ と $ Y $ を一致させることができる
 
$ x=0,1,\ldots,|T| $ に対して次の問題を解いてください。

- $ S $ の先頭の $ x $ 文字と末尾の $ |T|-x $ 文字を順番を保ったまま連結することで得られる長さ $ |T| $ の文字列を $ S' $ とする。$ S' $ と $ T $ がマッチするならば `Yes` と、そうでなければ `No` と出力せよ。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ S $ $ T $

## 输出格式

$ |T|+1 $ 行出力せよ。  
 $ i $ 行目には $ x=i-1 $ に対する出力をせよ。

## 说明/提示

### 制約

- $ S,T $ は英小文字と `?` からなる文字列
- $ 1\ \leq\ |T|\ \lt\ |S|\ \leq\ 3\ \times\ 10^5 $
 
### Sample Explanation 1

$ x=0 $ の場合、$ S' $ は `?c` となります。ここで、$ S' $ の $ 1 $ 文字目の `?` を `b` に、$ T $ の $ 2 $ 文字目の `?` を `c` に置き換えることで $ S' $ と $ T $ を一致させることができるため、$ S' $ と $ T $ はマッチします。このため、$ 1 $ 行目の出力は `Yes` です。 $ x=1,2 $ の場合は $ S' $ はそれぞれ `ac`、`a?` であり、$ T $ とマッチしません。このため、$ 2,3 $ 行目の出力は `No` です。

## 样例 #1

### 输入

```
a?c

b?
```

### 输出

```
Yes

No

No
```

## 样例 #2

### 输入

```
atcoder

?????
```

### 输出

```
Yes

Yes

Yes

Yes

Yes

Yes
```

## 样例 #3

### 输入

```
beginner

contest
```

### 输出

```
No

No

No

No

No

No

No

No
```



---

---
title: "[ABC287E] Karuta"
layout: "post"
diff: 普及/提高-
pid: AT_abc287_e
tag: []
---

# [ABC287E] Karuta

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc287/tasks/abc287_e

英小文字からなる文字列が $ N $ 個与えられます。$ i\ \,\ (i\ =\ 1,\ 2,\ \dots,\ N) $ 番目のものを $ S_i $ と表します。

二つの文字列 $ x,\ y $ に対し、以下の条件を全て満たす最大の整数 $ n $ を $ \mathrm{LCP}(x,\ y) $ と表します。

- $ x,\ y $ の長さはいずれも $ n $ 以上
- $ 1 $ 以上 $ n $ 以下の全ての整数 $ i $ に対し、$ x $ の $ i $ 文字目と $ y $ の $ i $ 文字目が等しい
 
全ての $ i\ =\ 1,\ 2,\ \dots,\ N $ に対し、以下の値を求めてください。

- $ \displaystyle\ \max_{i\ \neq\ j}\ \mathrm{LCP}(S_i,\ S_j) $

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ S_1 $ $ S_2 $ $ \vdots $ $ S_N $

## 输出格式

$ N $ 行出力せよ。$ i\ \,\ (i\ =\ 1,\ 2,\ \dots,\ N) $ 行目には、$ \displaystyle\ \max_{i\ \neq\ j}\ \mathrm{LCP}(S_i,\ S_j) $ を出力せよ。

## 说明/提示

### 制約

- $ 2\ \leq\ N\ \leq\ 5\ \times\ 10^5 $
- $ N $ は整数
- $ S_i $ は英小文字からなる長さ $ 1 $ 以上の文字列 $ (i\ =\ 1,\ 2,\ \dots,\ N) $
- $ S_i $ の長さの総和は $ 5\ \times\ 10^5 $ 以下
 
### Sample Explanation 1

$ \mathrm{LCP}(S_1,\ S_2)\ =\ 2,\ \mathrm{LCP}(S_1,\ S_3)\ =\ 1,\ \mathrm{LCP}(S_2,\ S_3)\ =\ 1 $ です。

## 样例 #1

### 输入

```
3

abc

abb

aac
```

### 输出

```
2

2

1
```

## 样例 #2

### 输入

```
11

abracadabra

bracadabra

racadabra

acadabra

cadabra

adabra

dabra

abra

bra

ra

a
```

### 输出

```
4

3

2

1

0

1

0

4

3

2

1
```



---

---
title: "[ABC289E] Swap Places"
layout: "post"
diff: 普及/提高-
pid: AT_abc289_e
tag: []
---

# [ABC289E] Swap Places

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc289/tasks/abc289_e

頂点に $ 1 $ から $ N $ までの、辺に $ 1 $ から $ M $ までの番号がついた $ N $ 頂点 $ M $ 辺の単純無向グラフがあります。 辺 $ i $ は頂点 $ u_i $ と頂点 $ v_i $ を結んでいます。  
 また、全ての頂点は赤か青のいずれか一方で塗られています。頂点 $ i $ の色は $ C_i $ で表されて、$ C_i $ が $ 0 $ ならば頂点 $ i $ は赤く、$ 1 $ ならば頂点 $ i $ は青く塗られています。

今、高橋君が頂点 $ 1 $ に、青木君が頂点 $ N $ にいます。  
 2 人は次の行動を $ 0 $ 回以上好きな回数繰り返します。

- 2 人が同時に、今いる頂点に隣接している頂点のいずれか 1 個に移動する。  
   ただし、高橋君の移動先の頂点の色と、青木君の移動先の頂点の色は異なる必要がある。
 
上記の行動を繰り返すことで、高橋君が頂点 $ N $ に、青木君が頂点 $ 1 $ にいる状態にできますか？  
 可能である場合は必要な行動回数の最小値を答えてください。不可能である場合は `-1` を出力してください。

入力のはじめに $ T $ が与えられるので、$ T $ 個のテストケースについて問題を解いてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。ここで $ \text{test}_i $ は $ i $ 番目のテストケースを意味する。

> $ T $ $ \text{test}_1 $ $ \text{test}_2 $ $ \vdots $ $ \text{test}_T $

各テストケースは以下の形式で与えられる。

> $ N $ $ M $ $ C_1 $ $ C_2 $ $ \dots $ $ C_N $ $ u_1 $ $ v_1 $ $ u_2 $ $ v_2 $ $ \vdots $ $ u_M $ $ v_M $

## 输出格式

$ T $ 行出力せよ。$ i $ 行目には $ i $ 番目のテストケースに対する答えを出力せよ。  
 各テストケースでは、高橋君が頂点 $ N $ に、青木君が頂点 $ 1 $ にいる状態にできる場合は必要な行動回数の最小値を、できない場合は `-1` を出力せよ。

## 说明/提示

### 制約

- $ 1\ \leq\ T\ \leq\ 1000 $
- $ 2\ \leq\ N\ \leq\ 2000 $
- $ 1\ \leq\ M\ \leq\ \min(\frac{N(N-1)}{2},\ 2000) $
- $ C_i\ \in\ \lbrace\ 0,\ 1\ \rbrace $
- $ 1\ \leq\ u_i,\ v_i\ \leq\ N $
- 入力で与えられるグラフは単純
- 入力される値は全て整数
- 全てのテストケースに対する $ N $ の総和は $ 2000 $ を超えない。
- 全てのテストケースに対する $ M $ の総和は $ 2000 $ を超えない。
 
### Sample Explanation 1

1 番目のテストケースでは、高橋君と青木君は以下のように行動することで、 $ 3 $ 回の行動で目的の状態を達成することができて、これが最小です。 - 高橋君が頂点 $ 3 $ に、青木君が頂点 $ 2 $ に移動する。 - 高橋君が頂点 $ 2 $ に、青木君が頂点 $ 3 $ に移動する。 - 高橋君が頂点 $ 4 $ に、青木君が頂点 $ 1 $ に移動する。 ここで、$ 1 $ 回目の移動で高橋君と青木君がともに頂点 $ 2 $ に移動することはできないのに注意してください。(なぜならば、高橋君の移動先の頂点の色と青木君の移動先の頂点の色は異なる必要があるからです。) 2 番目のテストケースでは、2 人はどのように行動しても目的の状態を達成することはできません。

## 样例 #1

### 输入

```
3

4 4

0 1 0 1

1 2

2 3

1 3

2 4

3 3

0 1 0

1 2

2 3

1 3

6 6

0 0 1 1 0 1

1 2

2 6

3 6

4 6

4 5

2 4
```

### 输出

```
3

-1

3
```



---

---
title: "[ABC290D] Marking"
layout: "post"
diff: 普及/提高-
pid: AT_abc290_d
tag: []
---

# [ABC290D] Marking

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc290/tasks/abc290_d

$ 0 $ から $ N-1 $ までの番号がつけられた $ N $ 個のマスが並んでいます。 今から、すぬけくんが以下の手順に従って全てのマスに印をつけていきます。

1. マス $ 0 $ に印をつける。
2. 次の i - iii の手順を $ N−1 $ 回繰り返す。 
  1. 最後に印をつけたマスの番号を $ A $ としたとき、変数 $ x $ を $ (A+D)\ \bmod\ N $ で初期化する。
  2. マス $ x $ に印が付いている限り、 $ x $ を $ (x+1)\ \bmod\ N $ に更新することを繰り返す。
  3. マス $ x $ に印をつける。

すぬけくんが $ K $ 番目に印をつけるマスの番号を求めてください。

$ T $ 個のテストケースが与えられるので、それぞれについて答えを求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。ここで、$ \mathrm{test}_i $ は $ i $ 番目のテストケースを意味する。

> $ T $ $ \mathrm{test}_1 $ $ \mathrm{test}_2 $ $ \vdots $ $ \mathrm{test}_T $

各テストケースは以下の形式で与えられる。

> $ N $ $ D $ $ K $

## 输出格式

$ T $ 行出力せよ。

$ i\ (1\leq\ i\ \leq\ T) $ 行目には、$ i $ 番目のテストケースに対する答えを出力せよ。

## 说明/提示

### 制約

- $ 1\leq\ T\ \leq\ 10^5 $
- $ 1\leq\ K\leq\ N\ \leq\ 10^9 $
- $ 1\leq\ D\ \leq\ 10^9 $
- 入力は全て整数

### Sample Explanation 1

$ N=4,D=2 $ のとき、すぬけくんは以下のように印をつけていきます。 1. マス $ 0 $ に印をつける。 2. (1回目) $ x=(0+2)\bmod\ 4=2 $ と初期化する。マス $ 2 $ は印がついていないので、印をつける。 (2回目) $ x=(2+2)\bmod\ 4=0 $ と初期化する。マス $ 0 $ は印がついているので、$ x=(0+1)\bmod\ 4=1 $ と更新する。マス $ 1 $ は印がついていないので、印をつける。 (3回目) $ x=(1+2)\bmod\ 4=3 $ と初期化する。マス $ 3 $ は印がついていないので、印をつける。

## 样例 #1

### 输入

```
9
4 2 1
4 2 2
4 2 3
4 2 4
5 8 1
5 8 2
5 8 3
5 8 4
5 8 5
```

### 输出

```
0
2
1
3
0
3
1
4
2
```



---

---
title: "[ABC291D] Flip Cards"
layout: "post"
diff: 普及/提高-
pid: AT_abc291_d
tag: []
---

# [ABC291D] Flip Cards

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc291/tasks/abc291_d

$ 1 $ から $ N $ までの番号がついた $ N $ 枚のカードが一列に並んでいて、各 $ i\ (1\leq\ i\ <\ N) $ に対してカード $ i $ とカード $ i+1 $ が隣り合っています。 カード $ i $ の表には $ A_i $ が、裏には $ B_i $ が書かれており、最初全てのカードは表を向いています。

今から、$ N $ 枚のカードのうち好きな枚数 ($ 0 $ 枚でも良い) を選んで裏返すことを考えます。 裏返すカードの選び方は $ 2^N $ 通りありますが、そのうち以下の条件を満たすものの数を $ 998244353 $ で割った余りを求めてください。

- 選んだカードを裏返した後、どの隣り合う $ 2 $ 枚のカードについても、向いている面に書かれた数が相異なる。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ A_1 $ $ B_1 $ $ A_2 $ $ B_2 $ $ \vdots $ $ A_N $ $ B_N $

## 输出格式

答えを整数として出力せよ。

## 说明/提示

### 制約

- $ 1\leq\ N\ \leq\ 2\times\ 10^5 $
- $ 1\leq\ A_i,B_i\ \leq\ 10^9 $
- 入力は全て整数

### Sample Explanation 1

裏返すカードの番号の集合を $ S $ とします。 例えば $ S=\{2,3\} $ を選ぶと、向いている面に書かれた数はカード $ 1 $ から順に $ 1,2,4 $ となるため条件を満たします。 一方 $ S=\{3\} $ を選ぶと、向いている面に書かれた数はカード $ 1 $ から順に $ 1,4,4 $ となり、カード $ 2 $ とカード $ 3 $ の数が一致するため条件を満たしません。 条件を満たす $ S $ は $ \{\},\{1\},\{2\},\{2,3\} $ の $ 4 $ 通りです。

## 样例 #1

### 输入

```
3
1 2
4 2
3 4
```

### 输出

```
4
```

## 样例 #2

### 输入

```
4
1 5
2 6
3 7
4 8
```

### 输出

```
16
```

## 样例 #3

### 输入

```
8
877914575 602436426
861648772 623690081
476190629 262703497
971407775 628894325
822804784 450968417
161735902 822804784
161735902 822804784
822804784 161735902
```

### 输出

```
48
```



---

---
title: "[ABC291E] Find Permutation"
layout: "post"
diff: 普及/提高-
pid: AT_abc291_e
tag: []
---

# [ABC291E] Find Permutation

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc291/tasks/abc291_e

$ 1,\ldots,N $ の並び替えである長さ $ N $ の数列 $ A=(A_1,\ldots,A_N) $ があります。

あなたは $ A $ を知りませんが、$ M $ 個の整数の組 $ (X_i,Y_i) $ について、$ A_{X_i}\ <\ A_{Y_i} $ が成り立つことを知っています。

$ A $ を一意に特定できるかどうか判定し、できるなら $ A $ を求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ M $ $ X_1 $ $ Y_1 $ $ \vdots $ $ X_M $ $ Y_M $

## 输出格式

$ A $ を一意に特定できるとき、1行目に `Yes` と出力し、2行目に $ A_1,\ldots,A_N $ をこの順に空白区切りで出力せよ。

$ A $ を一意に特定できないとき、`No` とのみ出力せよ。

## 说明/提示

### 制約

- $ 2\ \leq\ N\ \leq\ 2\times\ 10^5 $
- $ 1\ \leq\ M\ \leq\ 2\times\ 10^5 $
- $ 1\leq\ X_i,Y_i\ \leq\ N $
- 入力は全て整数である
- 入力に矛盾しない $ A $ が存在する

### Sample Explanation 1

$ A=(3,1,2) $ であると一意に特定できます。

### Sample Explanation 2

$ A $ として $ (2,3,1),(3,2,1) $ の $ 2 $ 通りが考えられます。

## 样例 #1

### 输入

```
3 2
3 1
2 3
```

### 输出

```
Yes
3 1 2
```

## 样例 #2

### 输入

```
3 2
3 1
3 2
```

### 输出

```
No
```

## 样例 #3

### 输入

```
4 6
1 2
1 2
2 3
2 3
3 4
3 4
```

### 输出

```
Yes
1 2 3 4
```



---

---
title: "[ABC292E] Transitivity"
layout: "post"
diff: 普及/提高-
pid: AT_abc292_e
tag: []
---

# [ABC292E] Transitivity

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc292/tasks/abc292_e

頂点に $ 1 $ から $ N $ の番号が、辺に $ 1 $ から $ M $ の番号がついた $ N $ 頂点 $ M $ 辺の単純有向グラフが与えられます。辺 $ i $ は頂点 $ u_i $ から頂点 $ v_i $ への有向辺です。

また、あなたは次の操作を $ 0 $ 回以上何度でも行えます。

- 相異なる頂点 $ x,y $ であって頂点 $ x $ から頂点 $ y $ への有向辺が存在しないようなものを選ぶ。そして、頂点 $ x $ から頂点 $ y $ への有向辺を追加する。

このグラフが次の条件を満たす状態にするために最小で何回操作を行う必要があるかを求めてください。

- 相異なる頂点 $ a,b,c $ すべてについて、頂点 $ a $ から頂点 $ b $ への有向辺と頂点 $ b $ から頂点 $ c $ への有向辺がともに存在するならば頂点 $ a $ から頂点 $ c $ への有向辺も存在する。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ M $ $ u_1 $ $ v_1 $ $ \vdots $ $ u_M $ $ v_M $

## 输出格式

答えを出力せよ。

## 说明/提示

### 制約

- $ 3\ \leq\ N\ \leq\ 2000 $
- $ 0\ \leq\ M\ \leq\ 2000 $
- $ 1\ \leq\ u_i\ ,v_i\ \leq\ N $
- $ u_i\ \neq\ v_i $
- $ i\ \neq\ j $ ならば $ (u_i,v_i)\ \neq\ (u_j,v_j) $
- 入力はすべて整数

### Sample Explanation 1

初め、一例として頂点 $ 2,4,3 $ について、頂点 $ 2 $ から頂点 $ 4 $ への有向辺と頂点 $ 4 $ から頂点 $ 3 $ への有向辺がともに存在するにもかかわらず、頂点 $ 2 $ から頂点 $ 3 $ への有向辺は存在せず、条件を満たさない状態です。 そこで、以下の $ 3 $ 本の有向辺を追加すると条件を満たす状態になります。 - 頂点 $ 2 $ から頂点 $ 3 $ への有向辺 - 頂点 $ 2 $ から頂点 $ 1 $ への有向辺 - 頂点 $ 4 $ から頂点 $ 1 $ への有向辺 一方、$ 3 $ 本未満の追加で条件を満たす状態には出来ないため、答えは $ 3 $ です。

## 样例 #1

### 输入

```
4 3
2 4
3 1
4 3
```

### 输出

```
3
```

## 样例 #2

### 输入

```
292 0
```

### 输出

```
0
```

## 样例 #3

### 输入

```
5 8
1 2
2 1
1 3
3 1
1 4
4 1
1 5
5 1
```

### 输出

```
12
```



---

---
title: "[ABC293D] Tying Rope"
layout: "post"
diff: 普及/提高-
pid: AT_abc293_d
tag: []
---

# [ABC293D] Tying Rope

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc293/tasks/abc293_d

一方の端が赤に塗られており、もう一方の端が青に塗られているロープが $ N $ 本あります。ロープには $ 1 $ から $ N $ までの番号がつけられています。

これからロープの端を結ぶ操作を $ M $ 回行います。$ i $ 回目の操作ではロープ $ A_i $ の色 $ B_i $ の端とロープ $ C_i $ の色 $ D_i $ の端を結びます。ただし、色 `R` は赤を意味し、色 `B` は青を意味します。各ロープについて、同じ色の端が複数回結ばれることはありません。

すべての操作を終えた後に、ひとつながりになっているロープの組について環状になっているものとそうでないものの個数を出力してください。

ただし、ひとつながりになっているロープの組 $ \lbrace\ v_0,\ v_1,\ \ldots,\ v_{x-1}\ \rbrace $ が環状になっているとは、$ v $ の要素の順序を適切に入れ替えることで各 $ 0\ \leq\ i\ <\ x $ についてロープ $ v_i $ とロープ $ v_{(i+1)\ \bmod\ x} $ が結ばれているようにできることをいいます。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ M $ $ A_1 $ $ B_1 $ $ C_1 $ $ D_1 $ $ A_2 $ $ B_2 $ $ C_2 $ $ D_2 $ $ \vdots $ $ A_M $ $ B_M $ $ C_M $ $ D_M $

## 输出格式

ひとつながりになっているロープの組について、環状になっているものの個数を $ X $、そうでないものの個数を $ Y $ として $ X $ と $ Y $ をこの順に空白区切りで出力せよ。

## 说明/提示

### 制約

- $ 1\ \leq\ N\ \leq\ 2\ \times\ 10^5 $
- $ 0\ \leq\ M\ \leq\ 2\ \times\ 10^5 $
- $ 1\ \leq\ A_i,\ C_i\ \leq\ N $
- $ (A_i,\ B_i)\ \neq\ (A_j,\ B_j),\ (C_i,\ D_i)\ \neq\ (C_j,\ D_j) $ $ (i\ \neq\ j) $
- $ (A_i,\ B_i)\ \neq\ (C_j,\ D_j) $
- $ N,\ M,\ A_i,\ C_i $ は整数
- $ B_i,\ D_i $ は `R` か `B` のいずれか
 
### Sample Explanation 1

ひとつながりになっているロープの組は $ \lbrace\ 1\ \rbrace $、$ \lbrace\ 2,4\ \rbrace $、$ \lbrace\ 3,5\ \rbrace $ の $ 3 $ つです。 ロープ $ \lbrace\ 3,5\ \rbrace $ の組は環状になっており、ロープ $ \lbrace\ 1\ \rbrace $ と $ \lbrace\ 2,4\ \rbrace $ の組は環状になっていません。したがって、$ X\ =\ 1,\ Y\ =\ 2 $ です。

## 样例 #1

### 输入

```
5 3

3 R 5 B

5 R 3 B

4 R 2 B
```

### 输出

```
1 2
```

## 样例 #2

### 输入

```
7 0
```

### 输出

```
0 7
```

## 样例 #3

### 输入

```
7 6

5 R 3 R

7 R 4 R

4 B 1 R

2 R 3 B

2 B 5 B

1 B 7 B
```

### 输出

```
2 1
```



---

---
title: "[ABC294E] 2xN Grid"
layout: "post"
diff: 普及/提高-
pid: AT_abc294_e
tag: []
---

# [ABC294E] 2xN Grid

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc294/tasks/abc294_e

$ 2 $ 行 $ L $ 列のマス目があります。 上から $ i $ 行目 $ (i\in\lbrace1,2\rbrace) $、左から $ j $ 列目 $ (1\leq\ j\leq\ L) $のマス目を $ (i,j) $ で表します。 $ (i,j) $ には整数 $ x\ _\ {i,j} $ が書かれています。

$ x\ _\ {1,j}=x\ _\ {2,j} $ であるような整数 $ j $ の個数を求めてください。

ただし、$ x\ _\ {i,j} $ の情報は $ (x\ _\ {1,1},x\ _\ {1,2},\ldots,x\ _\ {1,L}) $ と $ (x\ _\ {2,1},x\ _\ {2,2},\ldots,x\ _\ {2,L}) $ をそれぞれ連長圧縮した、長さ $ N\ _\ 1 $ の列 $ ((v\ _\ {1,1},l\ _\ {1,1}),\ldots,(v\ _\ {1,N\ _\ 1},l\ _\ {1,N\ _\ 1})) $ と長さ $ N\ _\ 2 $ の列 $ ((v\ _\ {2,1},l\ _\ {2,1}),\ldots,(v\ _\ {2,N\ _\ 2},l\ _\ {2,N\ _\ 2})) $ として与えられます。

ここで、列 $ A $ の連長圧縮とは、$ A $ の要素 $ v\ _\ i $ と正整数 $ l\ _\ i $ の組 $ (v\ _\ i,l\ _\ i) $ の列であって、次の操作で得られるものです。

1. $ A $ を異なる要素が隣り合っている部分で分割する。
2. 分割した各列 $ B\ _\ 1,B\ _\ 2,\ldots,B\ _\ k $ に対して、$ v\ _\ i $ を $ B\ _\ i $ の要素、$ l\ _\ i $ を $ B\ _\ i $ の長さとする。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ L $ $ N\ _\ 1 $ $ N\ _\ 2 $ $ v\ _\ {1,1} $ $ l\ _\ {1,1} $ $ v\ _\ {1,2} $ $ l\ _\ {1,2} $ $ \vdots $ $ v\ _\ {1,N\ _\ 1} $ $ l\ _\ {1,N\ _\ 1} $ $ v\ _\ {2,1} $ $ l\ _\ {2,1} $ $ v\ _\ {2,2} $ $ l\ _\ {2,2} $ $ \vdots $ $ v\ _\ {2,N\ _\ 2} $ $ l\ _\ {2,N\ _\ 2} $

## 输出格式

答えを $ 1 $ 行で出力せよ。

## 说明/提示

### 制約

- $ 1\leq\ L\leq\ 10\ ^\ {12} $
- $ 1\leq\ N\ _\ 1,N\ _\ 2\leq\ 10\ ^\ 5 $
- $ 1\leq\ v\ _\ {i,j}\leq\ 10\ ^\ 9\ (i\in\lbrace1,2\rbrace,1\leq\ j\leq\ N\ _\ i) $
- $ 1\leq\ l\ _\ {i,j}\leq\ L\ (i\in\lbrace1,2\rbrace,1\leq\ j\leq\ N\ _\ i) $
- $ v\ _\ {i,j}\neq\ v\ _\ {i,j+1}\ (i\in\lbrace1,2\rbrace,1\leq\ j\lt\ N\ _\ i) $
- $ l\ _\ {i,1}+l\ _\ {i,2}+\cdots+l\ _\ {i,N\ _\ i}=L\ (i\in\lbrace1,2\rbrace) $
- 入力はすべて整数
 
### Sample Explanation 1

マス目は以下の図のようになっています。 !\[\](https://img.atcoder.jp/abc294/14f38720983c464a322b504738344f24.png) $ x\ _\ {1,j}=x\ _\ {2,j} $ となるような整数 $ j $ は、$ j=1,2,5,8 $ の $ 4 $ つなので、出力すべき値は $ 4 $ です。

### Sample Explanation 2

答えが $ 32\operatorname{bit} $ 整数に収まらない場合があることに注意してください。

## 样例 #1

### 输入

```
8 4 3

1 2

3 2

2 3

3 1

1 4

2 1

3 3
```

### 输出

```
4
```

## 样例 #2

### 输入

```
10000000000 1 1

1 10000000000

1 10000000000
```

### 输出

```
10000000000
```

## 样例 #3

### 输入

```
1000 4 7

19 79

33 463

19 178

33 280

19 255

33 92

34 25

19 96

12 11

19 490

33 31
```

### 输出

```
380
```



---

---
title: "[ABC295D] Three Days Ago"
layout: "post"
diff: 普及/提高-
pid: AT_abc295_d
tag: []
---

# [ABC295D] Three Days Ago

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc295/tasks/abc295_d

`20230322` は並べ替えると `02320232` となり、これは `0232` を $ 2 $ 度繰り返しています。  
 このように、数字のみからなる文字列であって、適切に文字を並び替える (そのままでもよい) ことによって同じ列を $ 2 $ 度繰り返すようにできるものを **嬉しい列** と呼びます。  
 数字のみからなる文字列 $ S $ が与えられるので、以下の条件を全て満たす整数の組 $ (l,r) $ はいくつあるか求めてください。

- $ 1\ \le\ l\ \le\ r\ \le\ |S| $ ( $ |S| $ は $ S $ の長さ)
- $ S $ の $ l $ 文字目から $ r $ 文字目までの (連続する) 部分文字列は嬉しい列である。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ S $

## 输出格式

答えを整数として出力せよ。

## 说明/提示

### 制約

- $ S $ は数字のみからなる長さ $ 1 $ 以上 $ 5\ \times\ 10^5 $ 以下の文字列
 
### Sample Explanation 1

$ S= $ `20230322` です。 条件を満たす整数組 $ (l,r) $ は $ (1,6),(1,8),(2,7),(7,8) $ の $ 4 $ つです。

### Sample Explanation 2

$ S $ の先頭が `0` である場合もあります。

## 样例 #1

### 输入

```
20230322
```

### 输出

```
4
```

## 样例 #2

### 输入

```
0112223333444445555556666666777777778888888889999999999
```

### 输出

```
185
```

## 样例 #3

### 输入

```
3141592653589793238462643383279502884197169399375105820974944
```

### 输出

```
9
```



---

---
title: "[ABC296D] M<=ab"
layout: "post"
diff: 普及/提高-
pid: AT_abc296_d
tag: []
---

# [ABC296D] M<=ab

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc296/tasks/abc296_d

正整数 $ N,M $ が与えられます。  
 次の条件をともにみたす最小の正整数 $ X $ を求めてください。 ただし、そのようなものが存在しない場合は $ -1 $ を出力してください。

- $ X $ は $ 1 $ 以上 $ N $ 以下の整数 $ a,b $ の積として表される。ここで、$ a $ と $ b $ は同じ整数でも良い。
- $ X $ は $ M $ 以上である。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ M $

## 输出格式

問題文の条件をともにみたす最小の正整数 $ X $ を出力せよ。そのようなものが存在しない場合は $ -1 $ を出力せよ。

## 说明/提示

### 制約

- $ 1\leq\ N\leq\ 10^{12} $
- $ 1\leq\ M\leq\ 10^{12} $
- $ N,M $ は整数
 
### Sample Explanation 1

まず、$ 7 $ を $ 1 $ 以上 $ 5 $ 以下の整数 $ 2 $ つの積として表すことはできません。 次に、$ 8 $ は $ 8=2\times\ 4 $ などとして、$ 1 $ 以上 $ 5 $ 以下の整数 $ 2 $ つの積として表すことができます。 よって、$ 8 $ を出力します。

### Sample Explanation 2

$ 1\times\ 1=1 $、$ 1\times\ 2=2 $、$ 2\times\ 1=2 $、$ 2\times\ 2=4 $ より、 $ 1 $ 以上 $ 2 $ 以下の整数 $ 2 $ つの積として表す事ができるのは $ 1,2,4 $ のみであるため、 $ 5 $ 以上の数はそのような整数 $ 2 $ つの積として表すことができません。 よって、$ -1 $ を出力します。

### Sample Explanation 3

$ a=b=100000 $ $ (=10^5) $とした時、$ a,b $ の積は $ 10000000000 $ $ (=10^{10}) $ となり、これが答えとなります。 答えが $ 32 $ bit 整数型に収まらない場合があることに注意してください。

## 样例 #1

### 输入

```
5 7
```

### 输出

```
8
```

## 样例 #2

### 输入

```
2 5
```

### 输出

```
-1
```

## 样例 #3

### 输入

```
100000 10000000000
```

### 输出

```
10000000000
```



---

---
title: "[ABC296E] Transition Game"
layout: "post"
diff: 普及/提高-
pid: AT_abc296_e
tag: []
---

# [ABC296E] Transition Game

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc296/tasks/abc296_e

長さ $ N $ の数列 $ A=(A_1,A_2,\ldots,A_N) $ が与えられます。ここで、各 $ A_i $ $ (1\leq\ i\leq\ N) $ は $ 1\leq\ A_i\ \leq\ N $ をみたします。

高橋君と青木君が $ N $ 回ゲームを行います。$ i=1,2,\ldots,N $ 回目のゲームは次のようにして行われます。

1. 青木君が正整数 $ K_i $ を指定する。
2. 青木君の指定した $ K_i $ を聞いた後、高橋君は $ 1 $ 以上 $ N $ 以下の整数 $ S_i $ を選び、黒板に書く。
3. その後、 $ K_i $ 回次の操作を繰り返す。
  
  
  - 黒板に $ x $ が書かれているとき、それを消し、$ A_x $ を新しく書く。

$ K_i $ 回の操作の後で黒板に書かれている整数が $ i $ ならば $ i $ 回目のゲームは高橋君の勝ち、そうでないならば青木君の勝ちとなります。  
ここで、$ K_i,S_i $ は $ i=1,2,\ldots,N $ に対して独立に選ぶ事ができます。

両者が、自身が勝つために最善の行動をとったとき、$ N $ 回のゲームのうち高橋君が勝つ回数を求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ A_1 $ $ A_2 $ $ \ldots $ $ A_N $

## 输出格式

両者が最善の行動をとったとき、$ N $ 回のゲームのうち高橋君が勝つ回数を出力せよ。

## 说明/提示

### 制約

- $ 1\leq\ N\leq\ 2\times\ 10^5 $
- $ 1\leq\ A_i\leq\ N $
- 入力はすべて整数

### Sample Explanation 1

$ 1 $ 回目のゲームにおいて、青木君が $ K_1=2 $ を指定したとき、高橋君は $ S_1 $ として、$ 1,2,3 $ のいずれを選んでも勝つことはできません。 例えば、高橋君が最初に黒板に $ S_1=1 $ と書いたとすると、$ 2 $ 回の操作で黒板に書かれている数は順に $ 1\to\ 2(=A_1) $ 、$ 2\to\ 2(=A_2) $ と変化し、 最終的に黒板に書かれている数は $ 2(\neq\ 1) $ であるため、青木君の勝ちとなります。 一方、$ 2,3 $ 回目のゲームにおいては、青木君の指定した $ K_i $ の値によらず、高橋君はそれぞれ $ 2,3 $ を最初に黒板に書くことで勝つ事ができます。 よって、両者が、自分が勝つために最善の行動をとったとき、高橋君が勝つゲームは $ 2,3 $ 回目の $ 2 $ 回であるため、$ 2 $ を出力します。

### Sample Explanation 2

$ 1 $ 回目のゲームにおいて、高橋君は、青木君が指定した $ K_1 $ が奇数のときは $ 2 $、偶数のときは $ 1 $ を最初に黒板に書く事で勝つ事ができます。 同様に $ 2 $ 回目のゲームにおいても勝つ方法が存在するため、$ 1,2 $ 回目のゲームのいずれでも高橋君は勝利する事ができ、$ 2 $ が答えとなります。

## 样例 #1

### 输入

```
3
2 2 3
```

### 输出

```
2
```

## 样例 #2

### 输入

```
2
2 1
```

### 输出

```
2
```



---

---
title: "[ABC297E] Kth Takoyaki Set"
layout: "post"
diff: 普及/提高-
pid: AT_abc297_e
tag: []
---

# [ABC297E] Kth Takoyaki Set

## 题目描述

AtCoder 王国出售 $N$ 种类的章鱼烧。第 $i$ 种章鱼烧的价格是 $A_i$ 日元。
高桥一共买了 $1$ 个以上的章鱼烧。这个时候，也允许买多个同样的章鱼烧。
高桥君可以支付的金额中，请从便宜的一方寻求第 $K$ 的金额。但是，如果存在多个支付相同金额的方法，则只计算$ 1 $个。

## 输入格式

输入以以下形式由标准输入给出。
> $ N $ $ K $ $ A_1 $ $ A_2 $ $ \dots $ $ A_N $

## 输出格式

把答案作为整数输出。
### 示例#1
### 样例输入#1
```
4 6
20 25 30 100
```
### 样例输出#1
```
50
```
## 示例#2
### 样例输入#2
```
2 10
2 1
```
### 样例输出#2
```
10
```
## 样例#3
### 样例输入#3
```
10 200000
955277671 764071525 871653439 819642859 703677532 515827892 127889502 881462887 330802980 503797872
```
### 样例输出#3
```
5705443819
```

## 说明/提示

### 约束条件
- $ 1\ \le\ N\ \le\ 10 $
- $ 1\ \le\ K\ \le\ 2\ \times\ 10^5 $
- $ 1\ \le\ A_i\ \le\ 10^9 $
- 所有输入均为整数
### Sample Explanation 1
AtCoder王国出售的4个种类的章鱼烧，分别是$ 20 $日元、$ 25 $日元、$ 30 $日元、$ 100 $日元。高桥君支付的金额可能是，从便宜的一方列举$ 6 $个的话，$ 20 $日元，$ 25 $日元，$ 30 $日元，$ 40 $日元，$ 45 $日元，$ 50 $日元。因此，答案是$ 50 $个日元。请注意总共需要买$ 1 $个以上的章鱼烧。
### Sample Explanation 2
请注意，即使有几种相同金额的购买方法，也不要重复计算。

## 样例 #1

### 输入

```
4 6

20 25 30 100
```

### 输出

```
50
```

## 样例 #2

### 输入

```
2 10

2 1
```

### 输出

```
10
```

## 样例 #3

### 输入

```
10 200000

955277671 764071525 871653439 819642859 703677532 515827892 127889502 881462887 330802980 503797872
```

### 输出

```
5705443819
```



---

---
title: "[ABC298D] Writing a Numeral"
layout: "post"
diff: 普及/提高-
pid: AT_abc298_d
tag: []
---

# [ABC298D] Writing a Numeral

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc298/tasks/abc298_d

文字列 $ S $ があり、初め $ S= $ `1` です。  
以下の形式のクエリが $ Q $ 個与えられるので順に処理してください。

- `1 x` : $ S $ の末尾に数字 $ x $ を追加する
- `2` : $ S $ の先頭の数字を削除する
- `3` : $ S $ を十進数表記の数とみなした値を $ 998244353 $ で割った余りを出力する

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ Q $ $ \mathrm{query}_1 $ $ \vdots $ $ \mathrm{query}_Q $

ただし $ \mathrm{query}_i $ は $ i $ 番目のクエリを表し、以下のいずれかの形式である。

> $ 1 $ $ x $

> $ 2 $

> $ 3 $

## 输出格式

$ 3 $ 番目の形式のクエリの個数を $ q $ として、$ q $ 行出力せよ。$ i $ $ (1\ \leq\ i\ \leq\ q) $ 行目には $ i $ 番目の $ 3 $ 番目の形式のクエリに対する出力をせよ。

## 说明/提示

### 制約

- $ 1\ \leq\ Q\ \leq\ 6\ \times\ 10^5 $
- $ 1 $ 番目の形式のクエリについて、$ x\ \in\ \{1,2,3,4,5,6,7,8,9\} $
- $ 2 $ 番目の形式のクエリは $ S $ が $ 2 $ 文字以上の時にのみ与えられる
- $ 3 $ 番目の形式のクエリが $ 1 $ 個以上存在する

### Sample Explanation 1

$ 1 $ 番目のクエリにおいて、$ S $ は `1` なので ( $ 1 $ を $ 998244353 $ で割った余りに等しい) $ 1 $ を出力します。 $ 2 $ 番目のクエリにおいて、$ S $ は `12` になります。 $ 3 $ 番目のクエリにおいて、$ S $ は `12` なので ( $ 12 $ を $ 998244353 $ で割った余りに等しい) $ 12 $ を出力します。

### Sample Explanation 3

出力されるべき値は $ 998244353 $ で割った余りであることに注意してください。

## 样例 #1

### 输入

```
3
3
1 2
3
```

### 输出

```
1
12
```

## 样例 #2

### 输入

```
3
1 5
2
3
```

### 输出

```
5
```

## 样例 #3

### 输入

```
11
1 9
1 9
1 8
1 2
1 4
1 4
1 3
1 5
1 3
2
3
```

### 输出

```
0
```



---

---
title: "[ABC299D] Find by Query"
layout: "post"
diff: 普及/提高-
pid: AT_abc299_d
tag: []
---

# [ABC299D] Find by Query

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc299/tasks/abc299_d

この問題は **インタラクティブな問題**（あなたが作成したプログラムとジャッジプログラムが標準入出力を介して対話を行う形式の問題）です。

ジャッジが $ 0 $ と $ 1 $ のみからなる長さ $ N $ の文字列 $ S\ =\ S_1S_2\ldots\ S_N $ を持っています。 文字列 $ S $ は、$ S_1\ =\ 0 $ および $ S_N\ =\ 1 $ を満たします。

あなたには $ S $ の長さ $ N $ が与えられますが、$ S $ 自体は与えられません。 その代わり、あなたはジャッジに対して以下の質問を $ 20 $ 回まで行うことができます。

- $ 1\ \leq\ i\ \leq\ N $ を満たす整数 $ i $ を選び、$ S_i $ の値を尋ねる。
 
$ 1\ \leq\ p\ \leq\ N-1 $ かつ $ S_p\ \neq\ S_{p+1} $ を満たす整数 $ p $ を $ 1 $ 個出力してください。  
 なお、本問題の条件下でそのような整数 $ p $ が必ず存在することが示せます。

### Input &amp; Output Format

最初に、文字列 $ S $ の長さ $ N $ を標準入力から受け取ってください。

> $ N $

次に、あなたはジャッジに対して問題文中の質問を $ 20 $ 回まで繰り返すことができます。

質問は、以下の形式で標準出力に出力してください。 ここで、$ i $ は $ 1\ \leq\ i\ \leq\ N $ を満たす整数でなければなりません。

> ? $ i $

これに対する応答として、$ S_i $ の値が次の形式で標準入力から与えられます。

> $ S_i $

ここで、$ S_i $ は $ 0 $ または $ 1 $ です。

問題文中の条件を満たす整数 $ p $ を見つけたら、解答を以下の形式で出力してください。 その後、ただちにプログラムを終了してください。

> ! $ p $

答えが複数ある場合、どれを出力しても正解とみなされます。

## 说明/提示

### 制約

- $ 2\ \leq\ N\ \leq\ 2\ \times\ 10^5 $
 
### 注意点

- **出力を行うたびに、末尾に改行を入れて標準出力を flush してください。そうしなかった場合、ジャッジ結果が TLE となる可能性があります。**
- **対話の途中で不正な出力を行った、あるいはプログラムが途中で終了した場合のジャッジ結果は不定です。**
- 解答を出力したらただちにプログラムを終了してください。そうしない場合、ジャッジ結果は不定です。
- 文字列 $ S $ はあなたとジャッジの対話の開始時に固定され、あなたが行った質問などに応じて変更されることはありません。
 
### 入出力例

以下は、$ N\ =\ 7,\ S\ =\ 0010011 $ の場合の入出力例です。

    入力 出力 説明     `7`  $ N $ が与えられます。    `? 1` $ S_1 $ が何かをジャッジに質問します。     `0`  質問に対する答えとして $ S_1\ =\ 0 $ がジャッジから返されます。    `? 6` $ S_6 $ が何かをジャッジに質問します。     `1`  質問に対する答えとして $ S_6\ =\ 1 $ がジャッジから返されます。    `? 5` $ S_5 $ が何かをジャッジに質問します。     `0`  質問に対する答えとして $ S_5\ =\ 0 $ がジャッジから返されます。    `! 5` 問題文中の条件を満たす整数 $ p $ として、$ p\ =\ 5 $ を解答します。    解答した $ p\ =\ 5 $ について、$ 1\ \leq\ p\ \leq\ N-1 $ かつ $ S_p\ \neq\ S_{p+1} $ が成り立ちます。 よって、この後ただちにプログラムを終了することで、正解と判定されます。



---

---
title: "[ABC299E] Nearest Black Vertex"
layout: "post"
diff: 普及/提高-
pid: AT_abc299_e
tag: []
---

# [ABC299E] Nearest Black Vertex

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc299/tasks/abc299_e

$ N $ 個の頂点と $ M $ 本の辺からなる、単純（自己ループおよび多重辺を含まない）かつ連結な無向グラフが与えられます。  
$ i\ =\ 1,\ 2,\ \ldots,\ M $ について、$ i $ 番目の辺は頂点 $ u_i $ と頂点 $ v_i $ を結ぶ無向辺です。

各頂点を白または黒で塗る方法であって、下記の $ 2 $ つの条件をともに満たすものが存在するかを判定し、存在する場合はその一例を示してください。

- $ 1 $ 個以上の頂点が黒で塗られている。
- すべての $ i\ =\ 1,\ 2,\ \ldots,\ K $ について、下記の条件が成り立つ。
  - 頂点 $ p_i $ と「黒で塗られた頂点のうち頂点 $ p_i $ からの距離が最小であるもの」の距離がちょうど $ d_i $ である。

ここで、頂点 $ u $ と頂点 $ v $ の距離は、$ u $ と $ v $ を結ぶパスの辺の本数としてあり得る最小値として定義されます。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ M $ $ u_1 $ $ v_1 $ $ u_2 $ $ v_2 $ $ \vdots $ $ u_M $ $ v_M $ $ K $ $ p_1 $ $ d_1 $ $ p_2 $ $ d_2 $ $ \vdots $ $ p_K $ $ d_K $

## 输出格式

問題文中の条件を満たすように各頂点を白または黒で塗る方法が存在しない場合は、`No` を出力せよ。  
存在する場合は、下記の形式の通り、$ 1 $ 行目に `Yes` と出力し、$ 2 $ 行目に各頂点を塗る方法を表す文字列 $ S $ を出力せよ。 ここで、$ S $ は長さ $ N $ の文字列であり、$ i\ =\ 1,\ 2,\ \ldots,\ N $ について $ S $ の $ i $ 文字目は、頂点 $ i $ を黒で塗るとき $ 1 $ 、白で塗るとき $ 0 $ である。

> Yes $ S $

答えが複数ある場合、どれを出力しても正解とみなされる。

## 说明/提示

### 制約

- $ 1\ \leq\ N\ \leq\ 2000 $
- $ N-1\ \leq\ M\ \leq\ \min\lbrace\ N(N-1)/2,\ 2000\ \rbrace $
- $ 1\ \leq\ u_i,\ v_i\ \leq\ N $
- $ 0\ \leq\ K\ \leq\ N $
- $ 1\ \leq\ p_1\ \lt\ p_2\ \lt\ \cdots\ \lt\ p_K\ \leq\ N $
- $ 0\ \leq\ d_i\ \leq\ N $
- 与えられるグラフは単純かつ連結
- 入力はすべて整数

### Sample Explanation 1

例えば、頂点 $ 1,\ 3 $ を黒に、頂点 $ 2,\ 4,\ 5 $ を白に塗るという方法が、問題文中の条件を満たします。 実際、$ i\ =\ 1,\ 2,\ 3,\ 4,\ 5 $ について、頂点 $ i $ と「黒で塗られた頂点のうち頂点 $ i $ からの距離が最小であるもの」の距離を $ A_i $ で表すと、 $ (A_1,\ A_2,\ A_3,\ A_4,\ A_5)\ =\ (0,\ 1,\ 0,\ 1,\ 2) $ であり、特に、$ A_1\ =\ 0,\ A_5\ =\ 2 $ が成り立ちます。

### Sample Explanation 2

問題文中の条件を満たすように各頂点を白または黒で塗る方法が存在しないため、`No` を出力します。

## 样例 #1

### 输入

```
5 5
1 2
2 3
3 1
3 4
4 5
2
1 0
5 2
```

### 输出

```
Yes
10100
```

## 样例 #2

### 输入

```
5 5
1 2
2 3
3 1
3 4
4 5
5
1 1
2 1
3 1
4 1
5 1
```

### 输出

```
No
```

## 样例 #3

### 输入

```
1 0
0
```

### 输出

```
Yes
1
```



---

---
title: "[ABC301D] Bitmask"
layout: "post"
diff: 普及/提高-
pid: AT_abc301_d
tag: []
---

# [ABC301D] Bitmask

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc301/tasks/abc301_d

`0`, `1`, `?` からなる文字列 $ S $ および整数 $ N $ が与えられます。 $ S $ に含まれる `?` をそれぞれ `0` または `1` に置き換えて $ 2 $ 進整数とみなしたときに得られる値の集合を $ T $ とします。 たとえば、$ S= $ `?0?` のとき、 $ T=\lbrace\ 000_{(2)},001_{(2)},100_{(2)},101_{(2)}\rbrace=\lbrace\ 0,1,4,5\rbrace $ です。

$ T $ に含まれる $ N $ 以下の値のうち最大のものを ($ 10 $ 進整数として) 出力してください。 $ N $ 以下の値が $ T $ に含まれない場合は、代わりに `-1` を出力してください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ S $ $ N $

## 输出格式

答えを出力せよ。

## 说明/提示

### 制約

- $ S $ は `0`, `1`, `?` からなる文字列
- $ S $ の長さは $ 1 $ 以上 $ 60 $ 以下
- $ 1\leq\ N\ \leq\ 10^{18} $
- $ N $ は整数

### Sample Explanation 1

問題文中で例示したとおり、$ T=\lbrace\ 0,1,4,5\rbrace $ です。 $ T $ に含まれる $ N $ 以下の値は $ 0 $ と $ 1 $ なので、そのうちの最大である $ 1 $ を出力します。

### Sample Explanation 2

$ T=\lbrace\ 5\rbrace $ であるため、$ N $ 以下の値は $ T $ に含まれません。

## 样例 #1

### 输入

```
?0?
2
```

### 输出

```
1
```

## 样例 #2

### 输入

```
101
4
```

### 输出

```
-1
```

## 样例 #3

### 输入

```
?0?
1000000000000000000
```

### 输出

```
5
```



---

---
title: "[ABC302E] Isolation"
layout: "post"
diff: 普及/提高-
pid: AT_abc302_e
tag: []
---

# [ABC302E] Isolation

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc302/tasks/abc302_e

最初 $ N $ 頂点 $ 0 $ 辺の無向グラフがあり、各頂点には $ 1 $ から $ N $ まで番号がついています。  
 $ Q $ 個のクエリが与えられるので、順に処理し、各クエリの後における「他のどの頂点とも辺で結ばれていない頂点」の数を出力してください。

$ i $ 個目のクエリは $ \mathrm{query}_i $ であり、各クエリは次の $ 2 $ 種類いずれかです。

- `1 u v`: 頂点 $ u $ と頂点 $ v $ を辺で結ぶ。このクエリが与えられる直前の時点で、頂点 $ u $ と頂点 $ v $ は辺で結ばれていない事が保証される。
- `2 v` : 頂点 $ v $ と他の頂点を結ぶ辺をすべて削除する。（頂点 $ v $ 自体は削除しない。）

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ Q $ $ \mathrm{query}_1 $ $ \mathrm{query}_2 $ $ \vdots $ $ \mathrm{query}_Q $

## 输出格式

$ Q $ 行出力せよ。  
 $ i $ 行目 $ (1\leq\ i\leq\ Q) $ には、$ i $ 個目のクエリを処理した後の「他のどの頂点とも辺で結ばれていない頂点」の数を出力せよ。

## 说明/提示

### 制約

- $ 2\ \leq\ N\leq\ 3\times\ 10^5 $
- $ 1\ \leq\ Q\leq\ 3\times\ 10^5 $
- $ 1 $ 番目の種類のクエリにおいて、$ 1\leq\ u,v\leq\ N $, $ u\neq\ v $
- $ 2 $ 番目の種類のクエリにおいて、$ 1\leq\ v\leq\ N $
- $ 1 $ 番目の種類のクエリの直前の時点で、そのクエリの $ u,v $ について頂点 $ u $ と頂点 $ v $ は辺で結ばれていない。
- 入力はすべて整数
 
### Sample Explanation 1

$ 1 $ 個目のクエリの後で、頂点 $ 1 $ と頂点 $ 2 $ は互いに結ばれており、頂点 $ 3 $ のみが他のどの頂点とも辺で結ばれていません。 よって、$ 1 $ 行目には $ 1 $ を出力します。 また、$ 3 $ 個目のクエリの後でどの相異なる $ 2 $ 頂点の間も辺で結ばれていますが、$ 4 $ 個目のクエリによって、 頂点 $ 1 $ と他の頂点を結ぶ辺、すなわち 頂点 $ 1 $ と頂点 $ 2 $ を結ぶ辺および頂点 $ 1 $ と頂点 $ 3 $ を結ぶ辺が削除されます。 この結果として、頂点 $ 2 $ と頂点 $ 3 $ は互いに結ばれているが、頂点 $ 1 $ は他のどの頂点とも辺で結ばれていない状態となります。 よって、$ 3 $ 行目には $ 0 $ を、$ 4 $ 行目には $ 1 $ を出力します。

### Sample Explanation 2

$ 2 $ 番目の種類のクエリを行う直前の時点で、すでにその頂点と他の頂点を結ぶ辺が $ 1 $ 本も存在しないこともあります。

## 样例 #1

### 输入

```
3 7

1 1 2

1 1 3

1 2 3

2 1

1 1 2

2 2

1 1 2
```

### 输出

```
1

0

0

1

0

3

1
```

## 样例 #2

### 输入

```
2 1

2 1
```

### 输出

```
2
```



---

---
title: "[ABC303D] Shift vs. CapsLock"
layout: "post"
diff: 普及/提高-
pid: AT_abc303_d
tag: []
---

# [ABC303D] Shift vs. CapsLock

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc303/tasks/abc303_d

あなたのパソコンのキーボードには、a キー・Shift キー・CapsLock キーの $ 3 $ 種類のキーがあります。また、CapsLock キーにはランプが付いています。 初め、CapsLock キーのランプは OFF であり、パソコンの画面には空文字列が表示されています。

あなたは、以下の $ 3 $ 種類の操作のうち $ 1 $ つを選んで実行するということを $ 0 $ 回以上何度でも行うことができます。

- $ X $ ミリ秒かけて a キーのみを押す。CapsLock キーのランプが OFF ならば画面の文字列の末尾に `a` が付け足され、ON ならば `A` が付け足される。
- $ Y $ ミリ秒かけて Shift キーと a キーを同時に押す。CapsLock キーのランプが OFF ならば画面の文字列の末尾に `A` が付け足され、 ON ならば `a` が付け足される。
- $ Z $ ミリ秒かけて CapsLock キーを押す。CapsLock キーのランプが OFF ならば ON に、ON ならば OFF に切り替わる。

`A` と `a` からなる文字列 $ S $ が与えられます。画面の文字列を $ S $ に一致させるのに必要な最短の時間は何ミリ秒かを求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ X $ $ Y $ $ Z $ $ S $

## 输出格式

答えを出力せよ。

## 说明/提示

### 制約

- $ 1\ \leq\ X,Y,Z\ \leq\ 10^9 $
- $ X,Y,Z $ は整数
- $ 1\ \leq\ |S|\ \leq\ 3\ \times\ 10^5 $
- $ S $ は `A` と `a` からなる文字列

### Sample Explanation 1

以下のように操作を行うと $ 9 $ ミリ秒で画面の文字列を `AAaA` に一致させられます。これが最短の時間です。 - $ Z(=3) $ ミリ秒かけて CapsLock キーを押す。CapsLock キーのランプが ON になる。 - $ X(=1) $ ミリ秒かけて a キーを押す。`A` が画面の文字列の末尾に付け足される。 - $ X(=1) $ ミリ秒かけて a キーを押す。`A` が画面の文字列の末尾に付け足される。 - $ Y(=3) $ ミリ秒かけて Shift キーと a キーを同時に押す。`a` が画面の文字列の末尾に付け足される。 - $ X(=1) $ ミリ秒かけて a キーを押す。`A` が画面の文字列の末尾に付け足される。

## 样例 #1

### 输入

```
1 3 3
AAaA
```

### 输出

```
9
```

## 样例 #2

### 输入

```
1 1 100
aAaAaA
```

### 输出

```
6
```

## 样例 #3

### 输入

```
1 2 4
aaAaAaaAAAAaAaaAaAAaaaAAAAA
```

### 输出

```
40
```



---

---
title: "[ABC303E] A Gift From the Stars"
layout: "post"
diff: 普及/提高-
pid: AT_abc303_e
tag: []
---

# [ABC303E] A Gift From the Stars

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc303/tasks/abc303_e

以下の条件を満たす $ k+1 $ 頂点 $ k $ 辺のグラフをレベル $ k\ (k\geq\ 2) $ の星と呼びます。

- ある $ 1 $ つの頂点が、他の $ k $ 個の頂点と $ 1 $ 本ずつ辺で結ばれている。それ以外の辺は存在しない。
 
高橋君は、はじめ何個かの星からなるグラフを持っていました。そして、以下の手続きを全てのグラフの頂点が連結になるまでくり返し行いました。

- 持っているグラフの頂点から二つの頂点を選ぶ。このとき、選んだ二つの頂点の次数は共に $ 1 $ であり、かつ選んだ二つの頂点は非連結である必要がある。選んだ二つの頂点を結ぶ辺を張る。
 
その後、高橋君は手続きが終了した後のグラフの頂点に、適当に $ 1 $ から $ N $ の番号を付けました。このグラフは木となっており、これを $ T $ と呼びます。$ T $ には $ N-1 $ 本の辺があり、 $ i $ 番目の辺は $ u_i $ と $ v_i $ を結んでいました。

その後高橋君は、はじめ持っていた星の個数とレベルを忘れてしまいました。$ T $ の情報からはじめ持っていた星の個数とレベルを求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ u_1 $ $ v_1 $ $ \vdots $ $ u_{N-1} $ $ v_{N-1} $

## 输出格式

高橋君が持っていた星が $ M $ 個であり、星のレベルがそれぞれ $ L=(L_1,L_2,\ldots,L_M) $ であったとする。 このとき、$ L $ を昇順に並び替え空白区切りで出力せよ。

なお、この問題では常に解が一意に定まることが証明できる。

## 说明/提示

### 制約

- $ 3\leq\ N\leq\ 2\times\ 10^5 $
- $ 1\leq\ u_i,\ v_i\leq\ N $
- 与えられるグラフは、問題文中の手続きによって得られる $ N $ 頂点の木
- 入力は全て整数
 
### Sample Explanation 1

以下の図のように、$ 2 $ つのレベル $ 2 $ の星から $ T $ は得られます。 !\[\](https://img.atcoder.jp/abc303/59ab8e04c23d5f727300be7544b1df7e.png)

## 样例 #1

### 输入

```
6

1 2

2 3

3 4

4 5

5 6
```

### 输出

```
2 2
```

## 样例 #2

### 输入

```
9

3 9

7 8

8 6

4 6

4 1

5 9

7 3

5 2
```

### 输出

```
2 2 2
```

## 样例 #3

### 输入

```
20

8 3

8 18

2 19

8 20

9 17

19 7

8 7

14 12

2 15

14 10

2 13

2 16

2 1

9 5

10 15

14 6

2 4

2 11

5 12
```

### 输出

```
2 3 4 7
```



---

---
title: "[ABC304D] A Piece of Cake"
layout: "post"
diff: 普及/提高-
pid: AT_abc304_d
tag: []
---

# [ABC304D] A Piece of Cake

## 题目描述

在 $xy$-平面上，一块带有一些草莓的蛋糕占据了一块矩形区域 $\{(x,y):0\le x\le W,0\le y\le H\}$。

蛋糕上有 $N$ 个草莓，第 $i$ 个草莓的坐标是 $(p_i,q_i)$。现在，高桥要用小刀按照以下规则将蛋糕切成小块。

- 首先，沿着平行于 $y$ 轴的 $A$ 条直线：直线 $x=a_1$、直线 $x=a_2$、……、直线 $x=a_A$，将蛋糕切开。
- 接着，沿着平行于 $x$ 轴的 $Y$ 条直线：直线 $y=b_1$、直线 $y=b_2$、……、直线 $y=b_B$，将蛋糕切开。

到了最后，蛋糕会被切成 $(A+1)(B+1)$ 块长方形，现在高桥要选择其中一块，求他选择的蛋糕上草莓个数可能的最大值和最小值。

保证切割的边缘线上没有草莓，具体请参照数据范围。

## 输入格式

输入共 $(6+N)$ 行。

第一行两个整数 $W,H$。

第二行一个整数 $N$。

第 $3\sim N+2$ 行，第 $i+2$ 行两个整数 $p_i,q_i$。

第 $N+3$ 行，一个整数 $A$。

接下来一行 $A$ 个整数 $a_1$，$a_2$，……，$a_A$。

第 $N+5$ 行，一个整数 $B$。

接下来一行 $B$ 个整数 $b_1$，$b_2$，……，$b_B$。

以上变量含义均参考题意。

## 输出格式

共一行用空格隔开的两个整数，第一个表示可能的最少的草莓数量，第二个表示可能的最多的草莓数量。

## 样例 #1

### 输入

```
7 6
5
6 1
3 1
4 2
1 5
6 2
2
2 5
2
3 4
```

### 输出

```
0 2
```

## 样例 #2

### 输入

```
4 4
4
1 1
3 1
3 3
1 3
1
2
1
2
```

### 输出

```
1 1
```



---

---
title: "[ABC304E] Good Graph"
layout: "post"
diff: 普及/提高-
pid: AT_abc304_e
tag: []
---

# [ABC304E] Good Graph

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc304/tasks/abc304_e

$ N $ 頂点 $ M $ 辺の無向グラフ $ G $ が与えられます。 $ i\ =\ 1,\ 2,\ \ldots,\ M $ について、$ i $ 番目の辺は頂点 $ u_i $ と頂点 $ v_i $ を結ぶ無向辺です。

$ N $ 頂点のグラフは、すべての $ i\ =\ 1,\ 2,\ \ldots,\ K $ について下記の条件が成り立つとき、**良いグラフ**と呼ばれます。

- $ G $ 上で頂点 $ x_i $ と頂点 $ y_i $ を結ぶパスが存在しない。
 
与えられるグラフ $ G $ は良いグラフです。

$ Q $ 個の独立な質問が与えられるので、それらすべてに答えてください。 $ i\ =\ 1,\ 2,\ \ldots,\ Q $ について、$ i $ 番目の質問は

- 入力で与えられたグラフ $ G $ に頂点 $ p_i $ と頂点 $ q_i $ を結ぶ無向辺を $ 1 $ 本追加して得られるグラフ $ G^{(i)} $ は良いグラフですか？
 
という質問です。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ M $ $ u_1 $ $ v_1 $ $ u_2 $ $ v_2 $ $ \vdots $ $ u_M $ $ v_M $ $ K $ $ x_1 $ $ y_1 $ $ x_2 $ $ y_2 $ $ \vdots $ $ x_K $ $ y_K $ $ Q $ $ p_1 $ $ q_1 $ $ p_2 $ $ q_2 $ $ \vdots $ $ p_Q $ $ q_Q $

## 输出格式

$ Q $ 行出力せよ。 $ i\ =\ 1,\ 2,\ \ldots,\ Q $ について、$ i $ 行目には $ i $ 番目の質問に対する答えを出力せよ。 具体的には、グラフ $ G^{(i)} $ が良いグラフである場合は `Yes` を、良いグラフでない場合は `No` を出力せよ。

## 说明/提示

### 制約

- $ 2\ \leq\ N\ \leq\ 2\ \times\ 10^5 $
- $ 0\ \leq\ M\ \leq\ 2\ \times\ 10^5 $
- $ 1\ \leq\ u_i,\ v_i\ \leq\ N $
- $ 1\ \leq\ K\ \leq\ 2\ \times\ 10^5 $
- $ 1\ \leq\ x_i,\ y_i\ \leq\ N $
- $ x_i\ \neq\ y_i $
- $ i\ \neq\ j\ \implies\ \lbrace\ x_i,\ y_i\ \rbrace\ \neq\ \lbrace\ x_j,\ y_j\ \rbrace $
- すべての $ i\ =\ 1,\ 2,\ \ldots,\ K $ について次が成り立つ：頂点 $ x_i $ と頂点 $ y_i $ を結ぶパスは存在しない。
- $ 1\ \leq\ Q\ \leq\ 2\ \times\ 10^5 $
- $ 1\ \leq\ p_i,\ q_i\ \leq\ N $
- $ p_i\ \neq\ q_i $
- 入力はすべて整数
 
### Sample Explanation 1

\- $ 1 $ 番目の質問に関して、グラフ $ G^{(1)} $ は良いグラフではありません。なぜなら、頂点 $ x_1\ =\ 1 $ と頂点 $ y_1\ =\ 5 $ を結ぶパス $ 1\ \rightarrow\ 2\ \rightarrow\ 5 $ を持つからです。よって、`No` と出力します。 - $ 2 $ 番目の質問に関して、グラフ $ G^{(2)} $ は良いグラフではありません。なぜなら、頂点 $ x_2\ =\ 2 $ と頂点 $ y_2\ =\ 6 $ を結ぶパス $ 2\ \rightarrow\ 6 $ を持つからです。よって、`No` と出力します。 - $ 3 $ 番目の質問に関して、グラフ $ G^{(3)} $ は良いグラフです。よって、`Yes` と出力します。 - $ 4 $ 番目の質問に関して、グラフ $ G^{(4)} $ は良いグラフです。よって、`Yes` と出力します。 この入力例のように、与えられるグラフ $ G $ が自己ループや多重辺を持つ場合があることに注意してください。

## 样例 #1

### 输入

```
6 6

1 2

2 3

2 3

3 1

5 4

5 5

3

1 5

2 6

4 3

4

2 5

2 6

5 6

5 4
```

### 输出

```
No

No

Yes

Yes
```



---

---
title: "[ABC305D] Sleep Log"
layout: "post"
diff: 普及/提高-
pid: AT_abc305_d
tag: []
---

# [ABC305D] Sleep Log

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc305/tasks/abc305_d

高橋くんは睡眠記録をつけています。 睡眠記録は奇数長の数列 $ A=(A\ _\ 1(=0),\ A\ _\ 2,\ldots,A\ _\ N) $ で表され、奇数番目は起床時刻を、偶数番目は就寝時刻を表しています。 より厳密には、睡眠記録をつけている間に高橋くんは次のような睡眠をとりました。

- すべての $ 1\leq\ i\leq\dfrac{N-1}2 $ を満たす整数 $ i $ について、睡眠記録をつけ始めてから $ A\ _\ {2i} $ 分後ちょうどに寝て、$ A\ _\ {2i+1} $ 分後ちょうどに起きた。
- それ以外の時間に寝ることも起きることもなかった。
 
次の $ Q $ 個の質問に答えてください。 $ i $ 番目の質問では、$ 0\leq\ l\ _\ i\leq\ r\ _\ i\leq\ A\ _\ N $ を満たす整数の組 $ (l\ _\ i,r\ _\ i) $ が与えられます。

- 睡眠記録をつけ始めてから $ l\ _\ i $ 分後ちょうどから $ r\ _\ i $ 分後ちょうどまでの $ r\ _\ i-l\ _\ i $ 分のうち、高橋くんが寝ていたのは何分間ですか？

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ A\ _\ 1 $ $ A\ _\ 2 $ $ \ldots $ $ A\ _\ N $ $ Q $ $ l\ _\ 1 $ $ r\ _\ 1 $ $ l\ _\ 2 $ $ r\ _\ 2 $ $ \vdots $ $ l\ _\ Q $ $ r\ _\ Q $

## 输出格式

答えを $ Q $ 行で出力せよ。 $ i $ 行目には $ i $ 番目の質問の答えを整数として出力せよ。

## 说明/提示

### 制約

- $ 3\leq\ N\lt2\times10^5 $
- $ N $ は奇数
- $ 0=A\ _\ 1\lt\ A\ _\ 2\lt\cdots\lt\ A\ _\ N\leq10^9 $
- $ 1\leq\ Q\leq2\times10^5 $
- $ 0\leq\ l\ _\ i\leq\ r\ _\ i\leq\ A\ _\ N\ (1\leq\ i\leq\ Q) $
- 入力はすべて整数
 
### Sample Explanation 1

高橋くんは、以下の図のように睡眠をとりました。 ![](https://img.atcoder.jp/abc305/fe8152a63de7fea649d1d02197649a6a.png) それぞれの質問の答えは以下のようになります。 - 睡眠記録をつけ始めてから $ 480 $ 分後から $ 1920 $ 分後の間、高橋くんは $ 480 $ 分後から $ 720 $ 分後、$ 1320 $ 分後から $ 1440 $ 分後、$ 1800 $ 分後から $ 1920 $ 分後の $ 3 $ つの睡眠をとりました。睡眠時間の合計は $ 240+120+120=480 $ 分です。 - 睡眠記録をつけ始めてから $ 720 $ 分後から $ 1200 $ 分後の間、高橋くんは睡眠をとりませんでした。睡眠時間の合計は $ 0 $ 分です。 - 睡眠記録をつけ始めてから $ 0 $ 分後から $ 2160 $ 分後の間、高橋くんは $ 240 $ 分後から $ 720 $ 分後、$ 1320 $ 分後から $ 1440 $ 分後、$ 1800 $ 分後から $ 2160 $ 分後の $ 3 $ つの睡眠をとりました。睡眠時間の合計は $ 480+120+360=960 $ 分です。 よって、それぞれの行に $ 480,0,960 $ と出力してください。

## 样例 #1

### 输入

```
7

0 240 720 1320 1440 1800 2160

3

480 1920

720 1200

0 2160
```

### 输出

```
480

0

960
```

## 样例 #2

### 输入

```
21

0 20 62 192 284 310 323 324 352 374 409 452 486 512 523 594 677 814 838 946 1000

10

77 721

255 541

478 970

369 466

343 541

42 165

16 618

222 592

730 983

338 747
```

### 输出

```
296

150

150

49

89

20

279

183

61

177
```



---

---
title: "[ABC305E] Art Gallery on Graph"
layout: "post"
diff: 普及/提高-
pid: AT_abc305_e
tag: []
---

# [ABC305E] Art Gallery on Graph

## 题目描述

### 题面

给定一张 $N$ 个点（编号为 $1 \sim N$），$M$ 条边的无向图，保证无重边无自环。现在有 $K$ 个被标记的点，其中第 $i$ 个被标记的点的编号为 $p_i$，任何从 $p_i$ 出发经过不超过 $h_i$ 条边能到达的点都会被染色（包括 $p_i$ 自身）。你需要求出这张图最终有哪些点被染色。


接下来 $M$ 行，每行两个正整数 $a_i,b_i$，表示编号为 $a_i,b_i$ 的点连有一条无向边。

## 输出格式

第一行一个数字 $G$，表示被染色的点的个数。

第二行 $G$ 个数字，表示被染色的点，按照从小到大的顺序输出。

## 说明/提示

$1 \le N \le 2 \times 10^5$，$0 \le M \le 2 \times 10^5$，$1 \le K,a_i,b_i,p_i,h_i \le N$，$p_i$ 互不相同。

保证给定的图无重边，无自环。

## 样例 #1

### 输入

```
5 5 2

1 2

2 3

2 4

3 5

1 5

1 1

5 2
```

### 输出

```
4

1 2 3 5
```

## 样例 #2

### 输入

```
3 0 1

2 3
```

### 输出

```
1

2
```

## 样例 #3

### 输入

```
10 10 2

2 1

5 1

6 1

2 4

2 5

2 10

8 5

8 6

9 6

7 9

3 4

8 2
```

### 输出

```
7

1 2 3 5 6 8 9
```



---

---
title: "[ABC306E] Best Performances"
layout: "post"
diff: 普及/提高-
pid: AT_abc306_e
tag: []
---

# [ABC306E] Best Performances

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc306/tasks/abc306_e

長さ $ N $ の数列 $ A=(A_1,A_2,\dots,A_N) $ があり、最初全ての項が $ 0 $ です。  
 入力で与えられる整数 $ K $ を用いて関数 $ f(A) $ を以下のように定義します。

- $ A $ を降順に (広義単調減少となるように) ソートしたものを $ B $ とする。
- このとき、 $ f(A)=B_1\ +\ B_2\ +\ \dots\ +\ B_K $ とする。
 
この数列に合計 $ Q $ 回の更新を行うことを考えます。  
 数列 $ A $ に対し以下の更新を $ i=1,2,\dots,Q $ の順に行い、各更新ごとにその時点での $ f(A) $ の値を出力してください。

- $ A_{X_i} $ を $ Y_i $ に変更する。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ K $ $ Q $ $ X_1 $ $ Y_1 $ $ X_2 $ $ Y_2 $ $ \vdots $ $ X_Q $ $ Y_Q $

## 输出格式

全体で $ Q $ 行出力せよ。そのうち $ i $ 行目には $ i $ 回目の更新を終えた時点での $ f(A) $ の値を整数として出力せよ。

## 说明/提示

### 制約

- 入力は全て整数
- $ 1\ \le\ K\ \le\ N\ \le\ 5\ \times\ 10^5 $
- $ 1\ \le\ Q\ \le\ 5\ \times\ 10^5 $
- $ 1\ \le\ X_i\ \le\ N $
- $ 0\ \le\ Y_i\ \le\ 10^9 $
 
### Sample Explanation 1

この入力では $ N=4,K=2 $ です。 $ Q=10 $ 回の更新を行います。 - $ 1 $ 回目の更新を受けて $ A=(5,0,0,0) $ となります。このとき $ f(A)=5 $ です。 - $ 2 $ 回目の更新を受けて $ A=(5,1,0,0) $ となります。このとき $ f(A)=6 $ です。 - $ 3 $ 回目の更新を受けて $ A=(5,1,3,0) $ となります。このとき $ f(A)=8 $ です。 - $ 4 $ 回目の更新を受けて $ A=(5,1,3,2) $ となります。このとき $ f(A)=8 $ です。 - $ 5 $ 回目の更新を受けて $ A=(5,10,3,2) $ となります。このとき $ f(A)=15 $ です。 - $ 6 $ 回目の更新を受けて $ A=(0,10,3,2) $ となります。このとき $ f(A)=13 $ です。 - $ 7 $ 回目の更新を受けて $ A=(0,10,3,0) $ となります。このとき $ f(A)=13 $ です。 - $ 8 $ 回目の更新を受けて $ A=(0,10,1,0) $ となります。このとき $ f(A)=11 $ です。 - $ 9 $ 回目の更新を受けて $ A=(0,0,1,0) $ となります。このとき $ f(A)=1 $ です。 - $ 10 $ 回目の更新を受けて $ A=(0,0,0,0) $ となります。このとき $ f(A)=0 $ です。

## 样例 #1

### 输入

```
4 2 10

1 5

2 1

3 3

4 2

2 10

1 0

4 0

3 1

2 0

3 0
```

### 输出

```
5

6

8

8

15

13

13

11

1

0
```



---

---
title: "[ABC307C] Ideal Sheet"
layout: "post"
diff: 普及/提高-
pid: AT_abc307_c
tag: []
---

# [ABC307C] Ideal Sheet

## 题目描述

高桥有两张由方格组成的薄片，每个方格可能是透明的或黑色的。第一张的高 $H_A$ 宽 $W_A$ 个格子, 第二张高 $H_B$ 宽 $W_B$ 个格子。现在高桥将它们通过平移重叠在一起（不能旋转翻转），相对位置任意，想要得到图形 $X$ (高宽$H_X$,$W_X$)，请输出是否可能。用`.`表示透明格子，`#`表示黑色格子。

## 输入格式

第一行两个整数 $H_A$ , $W_A$
接下来 $H_A$ 行字符，表示薄片 $A$。
同理输入薄片 $B$ , $X$。

## 输出格式

一行，`Yes`表示可能，`No`表示不可能得到 $X$。

## 说明/提示

$1\leq$ 所有薄片高、宽 $\leq 10$ 
### 样例解释
Sample Explanation $2$ 
不能旋转薄片，因此不能得到 $X$ 。

## 样例 #1

### 输入

```
3 5
#.#..
.....
.#...
2 2
#.
.#
5 3
...
#.#
.#.
.#.
...
```

### 输出

```
Yes
```

## 样例 #2

### 输入

```
2 2
#.
.#
2 2
#.
.#
2 2
##
##
```

### 输出

```
No
```

## 样例 #3

### 输入

```
1 1
#
1 2
##
1 1
#
```

### 输出

```
No
```

## 样例 #4

### 输入

```
3 3
###
...
...
3 3
#..
#..
#..
3 3
..#
..#
###
```

### 输出

```
Yes
```



---

---
title: "[ABC307D] Mismatched Parentheses"
layout: "post"
diff: 普及/提高-
pid: AT_abc307_d
tag: []
---

# [ABC307D] Mismatched Parentheses

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc307/tasks/abc307_d

英小文字および `(`, `)` からなる長さ $ N $ の文字列 $ S $ が与えられます。  
 以下の操作を可能な限り繰り返したあとの $ S $ を出力してください。

- $ S $ の連続部分文字列であって、最初の文字が `(` かつ 最後の文字が `)` かつ 最初と最後以外に `(` も `)` も含まないものを自由に $ 1 $ つ選び削除する
 
なお、操作を可能な限り繰り返したあとの $ S $ は操作の手順によらず一意に定まることが証明できます。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ S $

## 输出格式

答えを出力せよ。

## 说明/提示

### 制約

- $ 1\ \leq\ N\ \leq\ 2\ \times\ 10^5 $
- $ N $ は整数である
- $ S $ は英小文字および `(`, `)` からなる長さ $ N $ の文字列である
 
### Sample Explanation 1

例えば、以下の手順により操作後の $ S $ が `ac` となります。 - $ S $ の $ 4 $ 文字目から $ 6 $ 文字目までからなる部分文字列 `(d)` を削除する。$ S $ は `a(b)c` となる。 - $ S $ の $ 2 $ 文字目から $ 4 $ 文字目までからなる部分文字列 `(b)` を削除する。$ S $ は `ac` となる。 - これ以上操作を行うことはできない。

### Sample Explanation 3

操作後の $ S $ は空文字列になる可能性があります。

## 样例 #1

### 输入

```
8

a(b(d))c
```

### 输出

```
ac
```

## 样例 #2

### 输入

```
5

a(b)(
```

### 输出

```
a(
```

## 样例 #3

### 输入

```
2

()
```

### 输出

```

```

## 样例 #4

### 输入

```
6

)))(((
```

### 输出

```
)))(((
```



---

---
title: "[ABC307E] Distinct Adjacent"
layout: "post"
diff: 普及/提高-
pid: AT_abc307_e
tag: []
---

# [ABC307E] Distinct Adjacent

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc307/tasks/abc307_e

$ 1 $ から $ N $ の番号がついた $ N $ 人の人が輪になってならんでいます。人 $ 1 $ の右隣には人 $ 2 $ が、人 $ 2 $ の右隣には人 $ 3 $ が、……、人 $ N $ の右隣には人 $ 1 $ がいます。

$ N $ 人の人にそれぞれ $ 0 $ 以上 $ M $ 未満の整数を $ 1 $ つずつ渡します。  
$ M^N $ 通りの渡し方のうち、どの隣り合う $ 2 $ 人が渡された数も異なるものの数を、$ 998244353 $ で割ったあまりを求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ M $

## 输出格式

答えを出力せよ。

## 说明/提示

### 制約

- $ 2\ \leq\ N,M\ \leq\ 10^6 $
- $ N,M $ は整数である

### Sample Explanation 1

人 $ 1,2,3 $ に渡す整数がそれぞれ $ (0,1,2),(0,2,1),(1,0,2),(1,2,0),(2,0,1),(2,1,0) $ のときの $ 6 $ 通りです。

### Sample Explanation 2

人 $ 1,2,3,4 $ に渡す整数がそれぞれ $ (0,1,0,1),(1,0,1,0) $ のときの $ 2 $ 通りです。

### Sample Explanation 3

$ 998244353 $ で割ったあまりを求めてください。

## 样例 #1

### 输入

```
3 3
```

### 输出

```
6
```

## 样例 #2

### 输入

```
4 2
```

### 输出

```
2
```

## 样例 #3

### 输入

```
987654 456789
```

### 输出

```
778634319
```



---

---
title: "[ABC308D] Snuke Maze"
layout: "post"
diff: 普及/提高-
pid: AT_abc308_d
tag: []
---

# [ABC308D] Snuke Maze

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc308/tasks/abc308_d

$ H $ 行 $ W $ 列のグリッドがあります。 以下、上から $ i $ 行目、左から $ j $ 列目のマスを $ (i,j) $ と表記します。 グリッドの各マスには英小文字が書かれており、$ (i,j) $ に書かれた文字は与えられる文字列 $ S_i $ の $ j $ 文字目と一致します。

すぬけくんは、辺で隣接するマスに移動することを繰り返して $ (1,1) $ から $ (H,W) $ まで移動しようと思っています。 訪れるマス （最初の $ (1,1) $ と 最後の $ (H,W) $ を含む）に書かれた文字が、 訪れる順に `s` $ \rightarrow $ `n` $ \rightarrow $ `u` $ \rightarrow $ `k` $ \rightarrow $ `e` $ \rightarrow $ `s` $ \rightarrow $ `n` $ \rightarrow\ \dots $ となるような経路が存在するか判定してください。 なお、$ 2 $ つのマス $ (i_1,j_1),(i_2,j_2) $ は $ |i_1-i_2|+|j_1-j_2|\ =\ 1 $ を満たすとき、またそのときに限り「辺で隣接する」といいます。

より厳密には、マスの列 $ ((i_1,j_1),(i_2,j_2),\dots,(i_k,j_k)) $ であって以下の条件を全て満たすものが存在するか判定してください。

- $ (i_1,j_1)\ =\ (1,1),(i_k,j_k)\ =\ (H,W) $
- すべての $ t\ (1\ \leq\ t\ <\ k) $ について、$ (i_t,j_t) $ と $ (i_{t+1},j_{t+1}) $ は辺で隣接する
- すべての $ t\ (1\ \leq\ t\ \leq\ k) $ について、$ (i_t,j_t) $ に書かれた文字は `snuke` の $ ((t-1)\ \bmod\ 5)\ +\ 1 $ 文字目と一致する

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ H $ $ W $ $ S_1 $ $ S_2 $ $ \vdots $ $ S_H $

## 输出格式

問題文中の条件を満たす経路が存在するならば `Yes` を、存在しないならば `No` を出力せよ。

## 说明/提示

### 制約

- $ 2\leq\ H,W\ \leq\ 500 $
- $ H,W $ は整数
- $ S_i $ は英小文字からなる長さ $ W $ の文字列
 
### Sample Explanation 1

$ (1,1)\ \rightarrow\ (1,2)\ \rightarrow\ (2,2)\ \rightarrow\ (2,3) $ という経路は、訪れたマスに書かれた文字が訪れた順に `s` $ \rightarrow $ `n` $ \rightarrow $ `u` $ \rightarrow $ `k` となるため条件を満たします。

## 样例 #1

### 输入

```
2 3

sns

euk
```

### 输出

```
Yes
```

## 样例 #2

### 输入

```
2 2

ab

cd
```

### 输出

```
No
```

## 样例 #3

### 输入

```
5 7

skunsek

nukesnu

ukeseku

nsnnesn

uekukku
```

### 输出

```
Yes
```



---

---
title: "[ABC309D] Add One Edge"
layout: "post"
diff: 普及/提高-
pid: AT_abc309_d
tag: []
---

# [ABC309D] Add One Edge

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc309/tasks/abc309_d

$ N_1+N_2 $ 頂点 $ M $ 辺の無向グラフがあります。$ i=1,2,\ldots,M $ に対し、$ i $ 番目の辺は頂点 $ a_i $ と頂点 $ b_i $ を結びます。  
 また、以下を満たすことが保障されます。

- $ 1\ \leq\ u,v\ \leq\ N_1 $ を満たす整数 $ u,v $ に対し、頂点 $ u $ と頂点 $ v $ は連結
- $ N_1+1\ \leq\ u,v\ \leq\ N_1+N_2 $ を満たす整数 $ u,v $ に対し、頂点 $ u $ と頂点 $ v $ は連結
- 頂点 $ 1 $ と頂点 $ N_1+N_2 $ は非連結
 
次の操作をちょうど $ 1 $ 回行います。

- $ 1\ \leq\ u\ \leq\ N_1 $ を満たす整数 $ u $ と $ N_1+1\ \leq\ v\ \leq\ N_1+N_2 $ を満たす整数 $ v $ を選び、頂点 $ u $ と頂点 $ v $ を結ぶ辺を追加する
 
操作後のグラフにおいて、頂点 $ 1 $ と頂点 $ N_1+N_2 $ は必ず連結であることが示せます。そこで、頂点 $ 1 $ と頂点 $ N_1+N_2 $ を結ぶ経路の長さ(辺の本数)の最小値を $ d $ とします。

操作で追加する辺を適切に選んだ時にありえる $ d $ の最大値を求めてください。

  連結とは？ 無向グラフの頂点 $ u,v $ が連結であるとは、頂点 $ u $ と頂点 $ v $ を結ぶ経路が存在することをいいます。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N_1 $ $ N_2 $ $ M $ $ a_1 $ $ b_1 $ $ \vdots $ $ a_M $ $ b_M $

## 输出格式

答えを出力せよ。

## 说明/提示

### 制約

- $ 1\ \leq\ N_1,N_2\ \leq\ 1.5\ \times\ 10^5 $
- $ 0\ \leq\ M\ \leq\ 3\ \times\ 10^5 $
- $ 1\ \leq\ a_i\ \leq\ b_i\ \leq\ N_1+N_2 $
- $ i\ \neq\ j $ ならば $ (a_i,b_i)\ \neq\ (a_j,b_j) $
- $ 1\ \leq\ u,v\ \leq\ N_1 $ を満たす整数 $ u,v $ に対し、頂点 $ u $ と頂点 $ v $ は連結
- $ N_1+1\ \leq\ u,v\ \leq\ N_1+N_2 $ を満たす整数 $ u,v $ に対し、頂点 $ u $ と頂点 $ v $ は連結
- 頂点 $ 1 $ と頂点 $ N_1+N_2 $ は非連結
- 入力はすべて整数
 
### Sample Explanation 1

$ u=2,v=5 $ として操作することで $ d=5 $ と出来ます。これが最大値です。 !\[\](https://img.atcoder.jp/abc309/a64d8034b08cfa7d1f655767cc164653.png)

## 样例 #1

### 输入

```
3 4 6

1 2

2 3

4 5

4 6

1 3

6 7
```

### 输出

```
5
```

## 样例 #2

### 输入

```
7 5 20

10 11

4 5

10 12

1 2

1 5

5 6

2 4

3 5

9 10

2 5

1 4

11 12

9 12

8 9

5 7

3 7

3 6

3 4

8 12

9 11
```

### 输出

```
4
```



---

---
title: "[ABC309E] Family and Insurance"
layout: "post"
diff: 普及/提高-
pid: AT_abc309_e
tag: []
---

# [ABC309E] Family and Insurance

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc309/tasks/abc309_e

人 $ 1 $、人 $ 2 $、$ \ldots $、人 $ N $ からなる家系があります。$ i\geq\ 2 $ に対し、人 $ i $ の親は人 $ p_i $ です。

この家系の人たちは $ M $ 回保険に加入しました。$ i=1,2,\ldots,M $ に対し、$ i $ 番目の保険の加入者は人 $ x_i $ で、本人及びその $ y_i $ 代先までの子たちが補償対象者です。

$ 1 $ 個以上の保険の補償対象者になっている人が何人いるかを求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ M $ $ p_2 $ $ \ldots $ $ p_N $ $ x_1 $ $ y_1 $ $ \vdots $ $ x_M $ $ y_M $

## 输出格式

答えを出力せよ。

## 说明/提示

### 制約

- $ 2\ \leq\ N\ \leq\ 3\ \times\ 10^5 $
- $ 1\ \leq\ M\ \leq\ 3\ \times\ 10^5 $
- $ 1\ \leq\ p_i\ \leq\ i-1 $
- $ 1\ \leq\ x_i\ \leq\ N $
- $ 1\ \leq\ y_i\ \leq\ 3\ \times\ 10^5 $
- 入力はすべて整数
 
### Sample Explanation 1

$ 1 $ 番目の保険について、人 $ 1 $ の $ 1 $ 代先の子たちは人 $ 2 $ と人 $ 4 $ なので人 $ 1,2,4 $ が補償対象者です。 $ 2 $ 番目の保険について、人 $ 1 $ の $ 1 $ 代先の子たちは人 $ 2 $ と人 $ 4 $、$ 2 $ 代先の子は人 $ 3 $ なので人 $ 1,2,3,4 $ が補償対象者です。 $ 3 $ 番目の保険について、人 $ 4 $ の $ 1,2,3 $ 代先の子は存在しないので人 $ 4 $ が補償対象者です。 以上より、$ 1 $ 個以上の保険の補償対象者になっている人は人 $ 1,2,3,4 $ の $ 4 $ 人です。

## 样例 #1

### 输入

```
7 3

1 2 1 3 3 3

1 1

1 2

4 3
```

### 输出

```
4
```

## 样例 #2

### 输入

```
10 10

1 1 3 1 2 3 3 5 7

2 1

5 1

4 3

6 3

2 1

7 3

9 2

1 2

6 2

8 1
```

### 输出

```
10
```



---

---
title: "[ABC324D] Square Permutation"
layout: "post"
diff: 普及/提高-
pid: AT_abc324_d
tag: []
---

# [ABC324D] Square Permutation

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc324/tasks/abc324_d

数字のみからなる、長さ $ N $ の文字列 $ S $ が与えられます。

$ S $ を並べ替えてできる文字列を十進法の整数として解釈したもののうち、平方数であるようなものがいくつあるか求めてください。

より厳密には、次のようになります。

$ S $ の先頭から $ i $ 番目 $ (1\leq\ i\leq\ N) $ の数字に対応する数を $ s\ _\ i $ とします。

$ (1,\ \ldots,\ N) $ の順列 $ P=(p\ _\ 1,p\ _\ 2,\ldots,p\ _\ N) $ によって $ \displaystyle\ \sum\ _\ {i=1}\ ^\ N\ s\ _\ {p\ _\ i}10\ ^\ {N-i} $ と書ける整数のうち、平方数であるようなものがいくつあるか求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ S $

## 输出格式

答えを $ 1 $ 行で出力せよ。

## 说明/提示

### 制約

- $ 1\leq\ N\leq\ 13 $
- $ S $ は数字のみからなる長さ $ N $ の文字列
- $ N $ は整数
 
### Sample Explanation 1

$ P=(4,2,3,1) $ とすると、$ s\ _\ 4\times10\ ^\ 3+s\ _\ 2\times10\ ^\ 2+s\ _\ 3\times10\ ^\ 1+s\ _\ 1=324=18\ ^\ 2 $ となります。 $ P=(3,2,4,1) $ とすると、$ s\ _\ 3\times10\ ^\ 3+s\ _\ 2\times10\ ^\ 2+s\ _\ 4\times10\ ^\ 1+s\ _\ 1=2304=48\ ^\ 2 $ となります。 これら以外の並べ替え方では平方数にならないため、$ 2 $ を出力してください。

### Sample Explanation 2

$ P=(1,3,2) $ もしくは $ P=(3,1,2) $ とすると、$ \displaystyle\sum\ _\ {i=1}\ ^\ Ns\ _\ {p\ _\ i}10\ ^\ {N-i}=1=1\ ^\ 2 $ となります。 $ P=(2,1,3) $ もしくは $ P=(2,3,1) $ とすると、$ \displaystyle\sum\ _\ {i=1}\ ^\ Ns\ _\ {p\ _\ i}10\ ^\ {N-i}=100=10\ ^\ 2 $ となります。 これら以外の並べ替え方では平方数にならないため、$ 2 $ を出力してください。 異なる並べ替え方でも、並べ替えた結果の数が同じなら $ 1 $ つと数えることに注意してください。

## 样例 #1

### 输入

```
4

4320
```

### 输出

```
2
```

## 样例 #2

### 输入

```
3

010
```

### 输出

```
2
```

## 样例 #3

### 输入

```
13

8694027811503
```

### 输出

```
840
```



---

---
title: "[ABC324E] Joint Two Strings"
layout: "post"
diff: 普及/提高-
pid: AT_abc324_e
tag: []
---

# [ABC324E] Joint Two Strings

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc324/tasks/abc324_e

英小文字からなる $ N $ 個の文字列 $ S_1,\ S_2,\ \ldots,\ S_N $ 、および、英小文字からなる文字列 $ T $ が与えられます。

$ 1 $ 以上 $ N $ 以下の $ 2 $ つの整数からなる組 $ (i,\ j) $ は $ N^2 $ 個ありますが、そのうち下記の条件を満たすものの個数を出力してください。

- $ S_i $ と $ S_j $ をこの順に連結して得られる文字列は、$ T $ を（連続とは限らない）部分列として含む。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ T $ $ S_1 $ $ S_2 $ $ \vdots $ $ S_N $

## 输出格式

答えを出力せよ。

## 说明/提示

### 制約

- $ N $ は整数
- $ 1\ \leq\ N\ \leq\ 5\ \times\ 10^5 $
- $ S_i $ および $ T $ は英小文字からなる長さ $ 1 $ 以上 $ 5\ \times\ 10^5 $ 以下の文字列
- $ S_1,\ S_2,\ \ldots,\ S_N $ の長さの総和は $ 5\ \times\ 10^5 $ 以下
 
### Sample Explanation 1

問題文中の条件を満たす組 $ (i,\ j) $ は、下記に示す $ 3 $ 個の組 $ (1,\ 2),\ (1,\ 3),\ (2,\ 3) $ です。 - $ (i,\ j)\ =\ (1,\ 2) $ について、$ S_1 $ と $ S_2 $ をこの順に連結して得られる文字列 `abbabcb` は `bac` を部分列として含みます。 - $ (i,\ j)\ =\ (1,\ 3) $ について、$ S_1 $ と $ S_3 $ をこの順に連結して得られる文字列 `abbaaaca` は `bac` を部分列として含みます。 - $ (i,\ j)\ =\ (2,\ 3) $ について、$ S_2 $ と $ S_3 $ をこの順に連結して得られる文字列 `bcbaaca` は `bac` を部分列として含みます。

## 样例 #1

### 输入

```
3 bac

abba

bcb

aaca
```

### 输出

```
3
```

## 样例 #2

### 输入

```
5 xx

x

x

x

x

x
```

### 输出

```
25
```

## 样例 #3

### 输入

```
1 y

x
```

### 输出

```
0
```

## 样例 #4

### 输入

```
10 ms

mkgn

m

hlms

vmsle

mxsm

nnzdhi

umsavxlb

ffnsybomr

yvmm

naouel
```

### 输出

```
68
```



---

---
title: "[ABC326D] ABC Puzzle"
layout: "post"
diff: 普及/提高-
pid: AT_abc326_d
tag: []
---

# [ABC326D] ABC Puzzle

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc326/tasks/abc326_d

整数 $ N $ と `A`, `B`, `C` からなる長さ $ N $ の文字列 $ R,C $ が与えられるので、以下の問題を解いてください。

$ N\ \times\ N $ のマス目があり、最初全てのマスは空きマスです。  
 各マスに `A`, `B`, `C` のうち高々 $ 1 $ 文字を書き込みます。( 空きマスのままにすることも許されます )

以下の条件を全て満たすことが可能であるか判定し、可能であれば書き込み方を $ 1 $ つ出力して下さい。

- 各行 / 各列 に `A`, `B`, `C` がちょうど $ 1 $ 個ずつ含まれる
- $ i $ 行目に書かれた文字の中で最も左にある文字は $ R $ の $ i $ 文字目と一致する
- $ i $ 列目に書かれた文字の中で最も上にある文字は $ C $ の $ i $ 文字目と一致する

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ R $ $ C $

## 输出格式

問題文中の条件を満たす書き込み方が存在しない場合、 `No` と $ 1 $ 行に出力してください。  
 そうでない場合、以下の形式に従い書き込み方を出力してください。

> Yes $ A_1 $ $ A_2 $ $ \vdots $ $ A_N $

まず、 $ 1 $ 行目に `Yes` と出力してください。 続く $ N $ 行のうちの $ i $ 行目に、長さ $ N $ の文字列である $ A_i $ を出力してください。

- $ A_i $ の $ j $ 文字目が `.` であるとき、上から $ i $ 行目、左から $ j $ 列目のマスは空きマスであることを示します。
- $ A_i $ の $ j $ 文字目が `A` であるとき、上から $ i $ 行目、左から $ j $ 列目のマスに `A` が書き込まれたことを示します。
- $ A_i $ の $ j $ 文字目が `B` であるとき、上から $ i $ 行目、左から $ j $ 列目のマスに `B` が書き込まれたことを示します。
- $ A_i $ の $ j $ 文字目が `C` であるとき、上から $ i $ 行目、左から $ j $ 列目のマスに `C` が書き込まれたことを示します。
 
正しい書き込み方が複数存在する場合、どれを出力しても構いません。

## 说明/提示

### 制約

- $ N $ は $ 3 $ 以上 $ 5 $ 以下の整数
- $ R,C $ は `A`, `B`, `C` からなる長さ $ N $ の文字列
 
### Sample Explanation 1

出力例のマス目は以下の条件を全て満たすため、正解として扱われます。 - 全ての行に `A`, `B`, `C` がちょうど $ 1 $ 個ずつ含まれる - 全ての列に `A`, `B`, `C` がちょうど $ 1 $ 個ずつ含まれる - 各行に書かれた最も左の文字は上から順に `A`, `B`, `C`, `B`, `C` である - 各列に書かれた最も上の文字は左から順に `A`, `C`, `A`, `A`, `B` である

### Sample Explanation 2

この入力では、条件を満たす書き込み方は存在しません。

## 样例 #1

### 输入

```
5

ABCBC

ACAAB
```

### 输出

```
Yes

AC..B

.BA.C

C.BA.

BA.C.

..CBA
```

## 样例 #2

### 输入

```
3

AAA

BBB
```

### 输出

```
No
```



---

---
title: "[ABC327D] Good Tuple Problem"
layout: "post"
diff: 普及/提高-
pid: AT_abc327_d
tag: []
---

# [ABC327D] Good Tuple Problem

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc327/tasks/abc327_d

$ N $ 以下の正整数からなる長さ $ M $ の数列の組 $ (S,\ T)\ =\ ((S_1,\ S_2,\ \dots,\ S_M),\ (T_1,\ T_2,\ \dots,\ T_M)) $ が **良い数列の組である** とは、$ (S,\ T) $ が次の条件を満たすことを言います。

- $ 0,1 $ からなる長さ $ N $ の数列 $ X\ =\ (X_1,\ X_2,\ \dots,\ X_N) $ であって次の条件を満たすものが存在する。
  - $ i=1,\ 2,\ \dots,\ M $ それぞれについて、$ X_{S_i}\ \neq\ X_{T_i} $ が成立する。
 
$ N $ 以下の正整数からなる長さ $ M $ の数列の組 $ (A,\ B)\ =\ ((A_1,\ A_2,\ \dots,\ A_M),\ (B_1,\ B_2,\ \dots,\ B_M)) $ が与えられます。$ (A,\ B) $ が良い数列の組である場合は `Yes` を、そうでない場合は `No` を出力してください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ M $ $ A_1 $ $ A_2 $ $ \dots $ $ A_M $ $ B_1 $ $ B_2 $ $ \dots $ $ B_M $

## 输出格式

$ (A,\ B) $ が良い数列の組である場合は `Yes` を、そうでない場合は `No` を出力せよ。

## 说明/提示

### 制約

- $ 1\ \leq\ N,\ M\ \leq\ 2\ \times\ 10^5 $
- $ 1\ \leq\ A_i,\ B_i\ \leq\ N $
- 入力される値は全て整数
 
### Sample Explanation 1

$ X=(0,1,0) $ とすると、$ X $ は $ 0,1 $ からなる長さ $ N $ の数列で、 $ X_{A_1}\ \neq\ X_{B_1} $ かつ $ X_{A_2}\ \neq\ X_{B_2} $ を満たします。 よって、$ (A,B) $ は良い数列の組としての条件を満たしています。

### Sample Explanation 2

条件を満たすような数列 $ X $ は存在しないので、$ (A,\ B) $ は良い数列の組ではありません。

## 样例 #1

### 输入

```
3 2

1 2

2 3
```

### 输出

```
Yes
```

## 样例 #2

### 输入

```
3 3

1 2 3

2 3 1
```

### 输出

```
No
```

## 样例 #3

### 输入

```
10 1

1

1
```

### 输出

```
No
```

## 样例 #4

### 输入

```
7 8

1 6 2 7 5 4 2 2

3 2 7 2 1 2 3 3
```

### 输出

```
Yes
```



---

---
title: "[ABC329F] Colored Ball"
layout: "post"
diff: 普及/提高-
pid: AT_abc329_f
tag: []
---

# [ABC329F] Colored Ball

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc329/tasks/abc329_f

$ 1,\ 2,\ \ldots,\ N $ の番号がついた $ N $ 個の箱があり、はじめ箱 $ i $ には色 $ C_i $ のボールが $ 1 $ つ入っています。

$ Q $ 個のクエリが与えられるので、これらを順に処理してください。

各クエリは整数の組 $ (a,b) $ によって与えられ、その内容は以下の通りです。

- 箱 $ a $ のボールをすべて箱 $ b $ に移し、その後箱 $ b $ に何種類の色のボールが入っているかを出力する。
 
ただし、箱 $ a $ や箱 $ b $ が空の場合もあることに注意してください。

## 输入格式

入力は以下の形式で標準入力から与えられる。ここで、 $ \text{query}_i $ は $ i $ 番目のクエリを意味する。

> $ N $ $ Q $ $ C_1 $ $ C_2 $ $ \ldots $ $ C_N $ $ \text{query}_1 $ $ \text{query}_2 $ $ \vdots $ $ \text{query}_Q $

各クエリは次の形式で与えられる。

> $ a $ $ b $

## 输出格式

$ Q $ 行出力せよ。 $ i $ 行目には $ i $ 番目のクエリに対する答えを出力せよ。

## 说明/提示

### 制約

- $ 1\ \leq\ N,\ Q\ \leq\ 200000 $
- $ 1\ \leq\ C_i\ \leq\ N $
- $ 1\ \leq\ a,\ b\ \leq\ N $
- $ a\ \neq\ b $
- 入力される数値はすべて整数
 
### Sample Explanation 1

\- $ 1 $ 番目のクエリでは、箱 $ 1 $ のボールをすべて箱 $ 2 $ に移します。箱 $ 2 $ には色 $ 1 $ のボールが $ 2 $ つ入っている状態となるため、$ 1 $ を出力します。 - $ 2 $ 番目のクエリでは、箱 $ 6 $ のボールをすべて箱 $ 4 $ に移します。箱 $ 4 $ には色 $ 2 $ のボールが $ 1 $ つ、色 $ 3 $ のボールが $ 1 $ つ入っている状態となるため、$ 2 $ を出力します。 - $ 3 $ 番目のクエリでは、箱 $ 5 $ のボールをすべて箱 $ 1 $ に移します。箱 $ 1 $ には色 $ 2 $ のボールが $ 1 $ つ入っている状態となるため、$ 1 $ を出力します。 - $ 4 $ 番目のクエリでは、箱 $ 3 $ のボールをすべて箱 $ 6 $ に移します。箱 $ 6 $ には色 $ 1 $ のボールが $ 1 $ つ入っている状態となるため、$ 1 $ を出力します。 - $ 5 $ 番目のクエリでは、箱 $ 4 $ のボールをすべて箱 $ 6 $ に移します。箱 $ 6 $ には色 $ 1 $ のボールが $ 1 $ つ、色 $ 2 $ のボールが $ 1 $ つ、色 $ 3 $ のボールが $ 1 $ つ入っている状態となるため、$ 3 $ を出力します。

## 样例 #1

### 输入

```
6 5

1 1 1 2 2 3

1 2

6 4

5 1

3 6

4 6
```

### 输出

```
1

2

1

1

3
```

## 样例 #2

### 输入

```
5 3

2 4 2 4 2

3 1

2 5

3 2
```

### 输出

```
1

2

0
```



---

---
title: "[ABC330E] Mex and Update"
layout: "post"
diff: 普及/提高-
pid: AT_abc330_e
tag: []
---

# [ABC330E] Mex and Update

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc330/tasks/abc330_e

長さ $ N $ の数列 $ A=(A_1,A_2,\dots,A_N) $ が与えられます。  
 以下の $ Q $ 個のクエリに、与えられる順番で対応してください。

$ k $ 番目のクエリは以下の形式で与えられます。

> $ i_k $ $ x_k $

- まず、 $ A_{i_k}\ =\ x_k $ と変更する。この変更は以降のクエリにも引き継がれる。
- その後、 $ A $ の $ \rm{mex} $ を出力する。
  - $ A $ の $ \rm{mex} $ とは、 $ A $ に含まれない最小の非負整数を指す。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ Q $ $ A_1 $ $ A_2 $ $ \dots $ $ A_N $ $ i_1 $ $ x_1 $ $ i_2 $ $ x_2 $ $ \vdots $ $ i_Q $ $ x_Q $

## 输出格式

全体で $ Q $ 行出力せよ。  
 そのうち $ k $ 行目には $ k $ 番目のクエリに対する答えを整数として出力せよ。

## 说明/提示

### 制約

- 入力は全て整数
- $ 1\ \le\ N,Q\ \le\ 2\ \times\ 10^5 $
- $ 0\ \le\ A_i\ \le\ 10^9 $
- $ 1\ \le\ i_k\ \le\ N $
- $ 0\ \le\ x_k\ \le\ 10^9 $
 
### Sample Explanation 1

最初、数列 $ A $ は $ (2,0,2,2,1,1,2,5) $ です。 この入力では、 $ 5 $ つのクエリを処理します。 - $ 1 $ 番目のクエリで $ A_4\ =\ 3 $ と変更し、 $ A=(2,0,2,3,1,1,2,5) $ となりました。 - この時点で、 $ A $ の $ \rm{mex} $ は $ 4 $ です。 - $ 2 $ 番目のクエリで $ A_4\ =\ 4 $ と変更し、 $ A=(2,0,2,4,1,1,2,5) $ となりました。 - この時点で、 $ A $ の $ \rm{mex} $ は $ 3 $ です。 - $ 3 $ 番目のクエリで $ A_6\ =\ 3 $ と変更し、 $ A=(2,0,2,4,1,3,2,5) $ となりました。 - この時点で、 $ A $ の $ \rm{mex} $ は $ 6 $ です。 - $ 4 $ 番目のクエリで $ A_8\ =\ 1000000000 $ と変更し、 $ A=(2,0,2,4,1,3,2,1000000000) $ となりました。 - この時点で、 $ A $ の $ \rm{mex} $ は $ 5 $ です。 - $ 5 $ 番目のクエリで $ A_2\ =\ 1 $ と変更し、 $ A=(2,1,2,4,1,3,2,1000000000) $ となりました。 - この時点で、 $ A $ の $ \rm{mex} $ は $ 0 $ です。

## 样例 #1

### 输入

```
8 5

2 0 2 2 1 1 2 5

4 3

4 4

6 3

8 1000000000

2 1
```

### 输出

```
4

3

6

5

0
```



---

---
title: "[ABC331D] Tile Pattern"
layout: "post"
diff: 普及/提高-
pid: AT_abc331_d
tag: []
---

# [ABC331D] Tile Pattern

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc331/tasks/abc331_d

縦横 $ 10^9 $ マスのグリッドがあります。上から $ i\ +\ 1 $ 行目、左から $ j\ +\ 1 $ 列目 $ (0\ \leq\ i,\ j\ \lt\ 10^9) $ にあるマスを $ (i,\ j) $ と呼びます。(通常と異なる index の割り当て方に注意してください。)  
 各マスは黒マスか白マスのいずれかです。マス $ (i,\ j) $ の色は文字 $ P[i\ \bmod\ N][j\ \bmod\ N] $ によって表されて、`B` ならばマス $ (i,\ j) $ は黒マス、`W` ならば白マスです。ここで $ a\ \bmod\ b $ は $ a $ を $ b $ で割った余りを意味します。

$ Q $ 個のクエリが与えられるので順に処理してください。  
 各クエリでは $ 4 $ つの整数 $ A,\ B,\ C,\ D $ が与えられるので、$ (A,\ B) $ を左上隅、$ (C,\ D) $ を右下隅とする長方形領域に含まれる黒マスの個数を求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。ここで $ \text{query}_i $ は $ i $ 番目に処理するクエリである。

> $ N $ $ Q $ $ P[0][0]P[0][1]\dots\ P[0][N-1] $ $ P[1][0]P[1][1]\dots\ P[1][N-1] $ $ \vdots $ $ P[N-1][0]P[N-1][1]\dots\ P[N-1][N-1] $ $ \text{query}_1 $ $ \text{query}_2 $ $ \vdots $ $ \text{query}_Q $

各クエリは以下の形式で与えられる。

> $ A $ $ B $ $ C $ $ D $

## 输出格式

問題文の指示に従ってクエリへの答えを改行区切りで出力せよ。

## 说明/提示

### 制約

- $ 1\ \leq\ N\ \leq\ 1000 $
- $ P[i][j] $ は `W` または `B`
- $ 1\ \leq\ Q\ \leq\ 2\ \times\ 10^5 $
- $ 0\ \leq\ A\ \leq\ C\ \lt\ 10^9 $
- $ 0\ \leq\ B\ \leq\ D\ \lt\ 10^9 $
- $ N,\ Q,\ A,\ B,\ C,\ D $ は全て整数
 
### Sample Explanation 1

グリッドの左上部分を図示すると次の図のようになります。 !\[image\](https://img.atcoder.jp/abc331/2c3ff3c4018817a0839f1fbe0e7c431d.jpg) $ 1 $ 番目のクエリについて、$ (1,\ 2) $ を左上隅、$ (3,\ 4) $ を右下隅とする長方形領域は図の赤い枠線に囲まれた部分で、領域に含まれる黒マスの個数は $ 4 $ 個です。 $ 2 $ 番目のクエリについて、$ (0,\ 3) $ を左上隅、$ (4,\ 5) $ を右下隅とする長方形領域は図の青い枠線に囲まれた部分で、領域に含まれる黒マスの個数は $ 7 $ 個です。

## 样例 #1

### 输入

```
3 2

WWB

BBW

WBW

1 2 3 4

0 3 4 5
```

### 输出

```
4

7
```

## 样例 #2

### 输入

```
10 5

BBBWWWBBBW

WWWWWBBBWB

BBBWBBWBBB

BBBWWBWWWW

WWWWBWBWBW

WBBWBWBBBB

WWBBBWWBWB

WBWBWWBBBB

WBWBWBBWWW

WWWBWWBWWB

5 21 21 93

35 35 70 43

55 72 61 84

36 33 46 95

0 0 999999999 999999999
```

### 输出

```
621

167

44

344

500000000000000000
```



---

---
title: "[ABC331E] Set Meal"
layout: "post"
diff: 普及/提高-
pid: AT_abc331_e
tag: []
---

# [ABC331E] Set Meal

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc331/tasks/abc331_e

AtCoder 食堂では主菜と副菜からなる定食が販売されています。  
 主菜は $ N $ 種類あり、順に主菜 $ 1 $, 主菜 $ 2 $, $ \dots $, 主菜 $ N $ と呼びます。主菜 $ i $ の価格は $ a_i $ 円です。  
 副菜は $ M $ 種類あり、順に副菜 $ 1 $, 副菜 $ 2 $, $ \dots $, 副菜 $ M $ と呼びます。副菜 $ i $ の価格は $ b_i $ 円です。

定食は主菜と副菜を $ 1 $ 種類ずつ選んで構成されます。定食の価格は選んだ主菜の価格と副菜の価格の和です。   
 ただし、$ L $ 個の相異なる組 $ (c_1,\ d_1),\ \dots,\ (c_L,\ d_L) $ について、主菜 $ c_i $ と副菜 $ d_i $ からなる定食は食べ合わせが悪いため提供されていません。  
 つまり、提供されている定食は $ NM\ -\ L $ 種類あることになります。(提供されている定食が少なくとも $ 1 $ 種類存在することが制約によって保証されています。)

提供されている定食のうち、最も価格の高い定食の価格を求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ M $ $ L $ $ a_1 $ $ a_2 $ $ \dots $ $ a_N $ $ b_1 $ $ b_2 $ $ \dots $ $ b_M $ $ c_1 $ $ d_1 $ $ c_2 $ $ d_2 $ $ \vdots $ $ c_L $ $ d_L $

## 输出格式

提供されている定食のうち、最も価格の高い定食が何円であるかを出力せよ。

## 说明/提示

### 制約

- $ 1\ \leq\ N,\ M\ \leq\ 10^5 $
- $ 0\ \leq\ L\ \leq\ \min(10^5,\ N\ M\ -\ 1) $
- $ 1\ \leq\ a_i,\ b_i\ \leq\ 10^9 $
- $ 1\ \leq\ c_i\ \leq\ N $
- $ 1\ \leq\ d_j\ \leq\ M $
- $ i\ \neq\ j $ ならば $ (c_i,\ d_i)\ \neq\ (c_j,\ d_j) $
- 入力される値は全て整数
 
### Sample Explanation 1

提供されている定食、及びその価格は次の $ 3 $ 種類です。 - 主菜 $ 1 $ と副菜 $ 1 $ からなる定食。価格は $ 2\ +\ 10\ =\ 12 $ 円である。 - 主菜 $ 1 $ と副菜 $ 3 $ からなる定食。価格は $ 2\ +\ 20\ =\ 22 $ 円である。 - 主菜 $ 2 $ と副菜 $ 2 $ からなる定食。価格は $ 1\ +\ 30\ =\ 31 $ 円である。 この中で最も高い定食は $ 3 $ 番目の定食です。よって $ 31 $ を出力してください。

## 样例 #1

### 输入

```
2 3 3

2 1

10 30 20

1 2

2 1

2 3
```

### 输出

```
31
```

## 样例 #2

### 输入

```
2 1 0

1000000000 1

1000000000
```

### 输出

```
2000000000
```

## 样例 #3

### 输入

```
10 10 10

47718 21994 74148 76721 98917 73766 29598 59035 69293 29127

7017 46004 16086 62644 74928 57404 32168 45794 19493 71590

1 3

2 6

4 5

5 4

5 5

5 6

5 7

5 8

5 10

7 3
```

### 输出

```
149076
```



---

---
title: "[ABC332D] Swapping Puzzle"
layout: "post"
diff: 普及/提高-
pid: AT_abc332_d
tag: []
---

# [ABC332D] Swapping Puzzle

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc332/tasks/abc332_d

$ H $ 行 $ W $ 列の $ 2 $ つのグリッド A, B が与えられます。

$ 1\ \leq\ i\ \leq\ H $ と $ 1\ \leq\ j\ \leq\ W $ を満たす各整数の組 $ (i,\ j) $ について、 $ i $ 行目 $ j $ 列目にあるマスをマス $ (i,\ j) $ と呼ぶとき、 グリッド A の マス $ (i,\ j) $ には整数 $ A_{i,\ j} $ が、 グリッド B の マス $ (i,\ j) $ には整数 $ B_{i,\ j} $ がそれぞれ書かれています。

あなたは「下記の $ 2 $ つのうちのどちらか $ 1 $ つを行う」という操作を好きな回数（ $ 0 $ 回でもよい）だけ繰り返します。

- $ 1\ \leq\ i\ \leq\ H-1 $ を満たす整数 $ i $ を選び、グリッド A の $ i $ 行目と $ (i+1) $ 行目を入れ替える。
- $ 1\ \leq\ i\ \leq\ W-1 $ を満たす整数 $ i $ を選び、グリッド A の $ i $ 列目と $ (i+1) $ 列目を入れ替える。

上記の操作の繰り返しによって、グリッド A をグリッド B に一致させることが可能かどうかを判定してください。 さらに、一致させることが可能な場合は、そのために行う操作回数の最小値を出力してください。

ここで、グリッド A とグリッド B が一致しているとは、 $ 1\ \leq\ i\ \leq\ H $ と $ 1\ \leq\ j\ \leq\ W $ を満たす全ての整数の組 $ (i,\ j) $ について、 グリッド A の マス $ (i,\ j) $ とグリッド B の マス $ (i,\ j) $ に書かれた整数が等しいこととします。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ H $ $ W $ $ A_{1,\ 1} $ $ A_{1,\ 2} $ $ \cdots $ $ A_{1,\ W} $ $ A_{2,\ 1} $ $ A_{2,\ 2} $ $ \cdots $ $ A_{2,\ W} $ $ \vdots $ $ A_{H,\ 1} $ $ A_{H,\ 2} $ $ \cdots $ $ A_{H,\ W} $ $ B_{1,\ 1} $ $ B_{1,\ 2} $ $ \cdots $ $ B_{1,\ W} $ $ B_{2,\ 1} $ $ B_{2,\ 2} $ $ \cdots $ $ B_{2,\ W} $ $ \vdots $ $ B_{H,\ 1} $ $ B_{H,\ 2} $ $ \cdots $ $ B_{H,\ W} $

## 输出格式

グリッド A をグリッド B に一致させることが不可能な場合は `-1` を、 可能な場合はグリッド A をグリッド B に一致させるために行う操作回数の最小値を出力せよ。

## 说明/提示

### 制約

- 入力される値は全て整数
- $ 2\ \leq\ H,\ W\ \leq\ 5 $
- $ 1\ \leq\ A_{i,\ j},\ B_{i,\ j}\ \leq\ 10^9 $

### Sample Explanation 1

初期状態のグリッド A の $ 4 $ 列目と $ 5 $ 列目を入れ替えると、グリッド A は下記の通りになります。 ``` 1 2 3 5 4 6 7 8 10 9 11 12 13 15 14 16 17 18 20 19 ``` 続けて、グリッド A の $ 2 $ 行目と $ 3 $ 行目を入れ替えると、グリッド A は下記の通りになります。 ``` 1 2 3 5 4 11 12 13 15 14 6 7 8 10 9 16 17 18 20 19 ``` 最後に、グリッド A の $ 2 $ 列目と $ 3 $ 列目を入れ替えると、グリッド A は下記の通りになり、グリッド B に一致します。 ``` 1 3 2 5 4 11 13 12 15 14 6 8 7 10 9 16 18 17 20 19 ``` 上に述べた $ 3 $ 回の操作でグリッド A をグリッド B に一致させることができ、 これより少ない回数の操作でグリッド A をグリッド B に一致させることはできないため、 $ 3 $ を出力します。

### Sample Explanation 2

問題文中の操作をどのように行ってもグリッド A をグリッド B に一致させることは不可能であるため `-1` を出力します。

### Sample Explanation 3

グリッド A ははじめからグリッド B に一致しています。

## 样例 #1

### 输入

```
4 5
1 2 3 4 5
6 7 8 9 10
11 12 13 14 15
16 17 18 19 20
1 3 2 5 4
11 13 12 15 14
6 8 7 10 9
16 18 17 20 19
```

### 输出

```
3
```

## 样例 #2

### 输入

```
2 2
1 1
1 1
1 1
1 1000000000
```

### 输出

```
-1
```

## 样例 #3

### 输入

```
3 3
8 1 6
3 5 7
4 9 2
8 1 6
3 5 7
4 9 2
```

### 输出

```
0
```

## 样例 #4

### 输入

```
5 5
710511029 136397527 763027379 644706927 447672230
979861204 57882493 442931589 951053644 152300688
43971370 126515475 962139996 541282303 834022578
312523039 506696497 664922712 414720753 304621362
325269832 191410838 286751784 732741849 806602693
806602693 732741849 286751784 191410838 325269832
304621362 414720753 664922712 506696497 312523039
834022578 541282303 962139996 126515475 43971370
152300688 951053644 442931589 57882493 979861204
447672230 644706927 763027379 136397527 710511029
```

### 输出

```
20
```



---

---
title: "[ABC337E] Bad Juice"
layout: "post"
diff: 普及/提高-
pid: AT_abc337_e
tag: []
---

# [ABC337E] Bad Juice

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc337/tasks/abc337_e

この問題は **インタラクティブな問題**（あなたが作成したプログラムとジャッジプログラムが標準入出力を介して対話を行う形式の問題）です。

$ 1 $ から $ N $ の番号がついた $ N $ 本のジュースがあります。 このうちちょうど $ 1 $ 本が腐っていることが判明しました。 そのジュースを微量でも飲むと、翌日お腹を壊してしまいます。

高橋君は翌日までに腐ったジュースを特定しなければなりません。 高橋君はそのために**必要な最小の数**の友人を呼び、それぞれに $ N $ 本のジュースのうちの一部を振る舞うことにしました。 各友人には何本でもジュースを与えることができ、各ジュースは何人の友人にでも与えることができます。

呼ぶ友人の数とジュースの与え方を出力して、翌日に各友人がお腹を壊したかどうかの情報を受け取り、腐ったジュースの番号を出力してください。

### Input &amp; Output Format

この問題はインタラクティブな問題（あなたが作成したプログラムとジャッジプログラムが標準入出力を介して対話を行う形式の問題）です。

対話を行う前にジャッジは、腐ったジュースの番号 $ X $ として $ 1 $ 以上 $ N $ 以下の整数を秘密裏に選択します。 $ X $ の値はあなたには与えられません。また、**対話の途中で $ X $ の値が制約および以前の出力に矛盾しない範囲で変わる場合があります。**

まず、ジャッジから $ N $ が入力から与えられます。

> $ N $

あなたは呼ぶ友人の数 $ M $ を出力し改行してください。

> $ M $

さらに、あなたは次に述べる $ M $ 回の出力からなる手続きを行ってください。 $ i\ =\ 1,\ 2,\ \ldots,\ M $ について $ i $ 回目の出力では、 $ i $ 番目の友人に飲ませるジュースの本数 $ K_i $ および、それら $ K_i $ 本のジュースの番号を**昇順に**並べた列 $ A_{i,\ 1},\ A_{i,\ 2},\ \ldots,\ A_{i,\ K_i} $ を下記の形式で空白区切りで出力し、改行してください。

> $ K_i $ $ A_{i,\ 1} $ $ A_{i,\ 2} $ $ \ldots $ $ A_{i,\ K_i} $

その後ジャッジから、各友人が翌日にお腹を壊したかどうかの情報が、`0` と `1` のみからなる長さ $ M $ の文字列 $ S $ として与えられます。

> $ S $

$ i\ =\ 1,\ 2,\ \ldots,\ M $ について、$ S $ の $ i $ 文字目が `1` のとき、かつそのときに限り、$ i $ 番目の友人がお腹を壊したことを表します。

それに対し、あなたは腐ったジュースの番号 $ X' $ を出力し、改行してください。

> $ X' $

その後、直ちにプログラムを終了してください。

あなたが出力した $ M $ が $ N $ 本のジュースから腐ったジュースを特定するために**必要な最小の**友人の数であり、かつ、あなたが出力した $ X' $ が腐ったジュースの番号 $ X $ と一致していれば、正解となります。

## 说明/提示

### 制約

- $ N $ は整数
- $ 2\ \leq\ N\ \leq\ 100 $
 
### 注意点

- **出力を行うたびに、末尾に改行を入れて標準出力を flush してください。そうしなかった場合、ジャッジ結果が TLE となる可能性があります。**
- **対話の途中で不正な出力を行った、あるいはプログラムが途中で終了した場合のジャッジ結果は不定です。** 特に、プログラムの実行中に実行時エラーが起こった場合に、ジャッジ結果が RE ではなく WA や TLE になる可能性があることに注意してください。
- $ X' $ を出力したらただちにプログラムを終了してください。そうしない場合、ジャッジ結果は不定です。
- **この問題のジャッジはアダプティブです。つまり、制約および以前の出力に矛盾しない範囲で $ X $ の値が変わる場合があります。**
 
### 入出力例

以下は、$ N\ =\ 3 $ の場合の入出力例です。

    入力 出力 説明     `3`  ジュースの本数 $ N $ が与えられます。    `2` 呼ぶ友人の数 $ M $ を出力します。    `2 1 2` $ 1 $ 人目の友人にジュース $ 1 $ とジュース $ 2 $ を与えます。     `1 2` $ 2 $ 人目の友人に、ジュース $ 2 $ を与えます。     `10`  翌日に各友人がお腹を壊したかどうかを表す文字列 $ S $ が与えられます。    `1` 腐ったジュースの番号を出力します。



---

---
title: "[ABC346E] Paint"
layout: "post"
diff: 普及/提高-
pid: AT_abc346_e
tag: []
---

# [ABC346E] Paint

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc346/tasks/abc346_e

$ H $ 行 $ W $ 列のグリッドがあり、はじめすべてのマスは色 $ 0 $ で塗られています。

これから $ i\ =\ 1,\ 2,\ \ldots,\ M $ の順で以下の操作を行います。

- $ T_i\ =\ 1 $ のとき、$ A_i $ **行目**のマスをすべて色 $ X_i $ に塗り替える
- $ T_i\ =\ 2 $ のとき、$ A_i $ **列目**のマスをすべて色 $ X_i $ に塗り替える

すべての操作を終えたとき、最終的に色 $ i $ で塗られたマスが存在するような各色 $ i $ についてその色で塗られたマスの個数を求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ H $ $ W $ $ M $ $ T_1 $ $ A_1 $ $ X_1 $ $ T_2 $ $ A_2 $ $ X_2 $ $ \vdots $ $ T_M $ $ A_M $ $ X_M $

## 输出格式

色 $ i $ で塗られたマスが存在するような整数 $ i $ の個数を $ K $ として、$ K\ +\ 1 $ 行出力せよ。

$ 1 $ 行目には $ K $ の値を出力せよ。

$ 2 $ 行目以降には色 $ i $ で塗られたマスが存在するような各色 $ i $ について、色の番号およびその色で塗られたマスの個数を出力せよ。

具体的には、$ i\ +\ 1 $ $ (1\ \leq\ i\ \leq\ K) $ 行目には色の番号 $ c_i $ と色 $ c_i $ で塗られたマスの個数 $ x_i $ をこの順に空白区切りで出力せよ。

ただし、色の番号は**昇順で**出力せよ。すなわち、$ c_1\ <\ c_2\ <\ \ldots\ <\ c_K $ を満たすように出力せよ。また、$ x_i\ >\ 0 $ が必要であることに注意せよ。

## 说明/提示

### 制約

- $ 1\ \leq\ H,\ W,\ M\ \leq\ 2\ \times\ 10^5 $
- $ T_i\ \in\ \lbrace\ 1,\ 2\ \rbrace $
- $ T_i\ =\ 1 $ なる $ i $ に対して $ 1\ \leq\ A_i\ \leq\ H $
- $ T_i\ =\ 2 $ なる $ i $ に対して $ 1\ \leq\ A_i\ \leq\ W $
- $ 0\ \leq\ X_i\ \leq\ 2\ \times\ 10^5 $
- 入力される値はすべて整数

### Sample Explanation 1

操作によってグリッドの各マスの色は以下のように変化します。 ``` 0000 0000 0000 0000 0000 0000 → 5555 → 5550 → 5550 → 5550 0000 0000 0000 3333 2222 ``` 最終的に色 $ 0 $ で塗られたマスは $ 5 $ つ、色 $ 2 $ で塗られたマスは $ 4 $ つ、色 $ 5 $ で塗られたマスは $ 3 $ つです。

## 样例 #1

### 输入

```
3 4 4
1 2 5
2 4 0
1 3 3
1 3 2
```

### 输出

```
3
0 5
2 4
5 3
```

## 样例 #2

### 输入

```
1 1 5
1 1 1
1 1 10
2 1 100
1 1 1000
2 1 10000
```

### 输出

```
1
10000 1
```

## 样例 #3

### 输入

```
5 5 10
1 1 1
1 2 2
1 3 3
1 4 4
1 5 5
2 1 6
2 2 7
2 3 8
2 4 9
2 5 10
```

### 输出

```
5
6 5
7 5
8 5
9 5
10 5
```



---

---
title: "[ABC348F] Oddly Similar"
layout: "post"
diff: 普及/提高-
pid: AT_abc348_f
tag: []
---

# [ABC348F] Oddly Similar

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc348/tasks/abc348_f

$ N $ 個の長さ $ M $ の数列 $ A_1,\ A_2,\ \ldots,\ A_N $ があります。$ i $ 番目の数列は $ M $ 個の整数 $ A_{i,1},\ A_{i,2},\ \ldots,\ A_{i,M} $ で表されます。

それぞれの長さが $ M $ の数列 $ X,Y $ について、$ X_i\ =\ Y_i $ となるような $ i(1\ \leq\ i\ \leq\ M) $ の個数が奇数であるときに、$ X $ と $ Y $ は似ていると言います。

$ 1\ \leq\ i\ <\ j\ \leq\ N $ を満たす整数の組 $ (i,j) $ のうち、$ A_i $ と $ A_j $ が似ているものの個数を求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ M $ $ A_{1,1} $ $ A_{1,2} $ $ \ldots $ $ A_{1,M} $ $ A_{2,1} $ $ A_{2,2} $ $ \ldots $ $ A_{2,M} $ $ \vdots $ $ A_{N,1} $ $ A_{N,2} $ $ \ldots $ $ A_{N,M} $

## 输出格式

答えを整数として出力せよ。

## 说明/提示

### 制約

- $ 1\ \leq\ N\ \leq\ 2000 $
- $ 1\ \leq\ M\ \leq\ 2000 $
- $ 1\ \leq\ A_{i,j}\ \leq\ 999 $
- 入力は全て整数である。
 
### Sample Explanation 1

$ (i,j)\ =\ (1,2) $ は条件を満たします。なぜならば、$ A_{1,k}\ =\ A_{2,k} $ となるような $ k $ は $ k=1 $ の $ 1 $ 個だけだからです。 $ (i,j)\ =\ (1,3)\ ,(2,3) $ は条件を満たさないため、条件を満たす $ (i,j) $ の組は $ (1,2) $ だけです。

## 样例 #1

### 输入

```
3 3

1 2 3

1 3 4

2 3 4
```

### 输出

```
1
```

## 样例 #2

### 输入

```
6 5

8 27 27 10 24

27 8 2 4 5

15 27 26 17 24

27 27 27 27 27

27 7 22 11 27

19 27 27 27 27
```

### 输出

```
5
```



---

---
title: "[ABC357D] 88888888"
layout: "post"
diff: 普及/提高-
pid: AT_abc357_d
tag: ['逆元']
---

# [ABC357D] 88888888

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc357/tasks/abc357_d

正整数 $ N $ に対して、$ N $ を $ N $ 個つなげた整数を $ V_N $ とします。  
 より厳密には、$ N $ を文字列とみなしたものを $ N $ 個連結し、 それを再度整数とみなしたものを $ V_N $ とします。  
 例えば、$ V_3=333 $, $ V_{10}=10101010101010101010 $ です。

$ V_N $ を $ 998244353 $ で割った余りを求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $

## 输出格式

$ V_N $ を $ 998244353 $ で割った余りを出力せよ。

## 说明/提示

### 制約

- $ 1\leq\ N\leq\ 10^{18} $
- $ N $ は整数
 
### Sample Explanation 1

$ V_5=55555 $ を $ 998244353 $ で割った余りは $ 55555 $ です。

### Sample Explanation 2

$ V_9=999999999 $ を $ 998244353 $ で割った余りは $ 1755646 $ です。

### Sample Explanation 3

入力が $ 32 $ bit 整数型に収まらない可能性があることに注意してください。

## 样例 #1

### 输入

```
5
```

### 输出

```
55555
```

## 样例 #2

### 输入

```
9
```

### 输出

```
1755646
```

## 样例 #3

### 输入

```
10000000000
```

### 输出

```
468086693
```



---

---
title: "[ABC387D] Snaky Walk"
layout: "post"
diff: 普及/提高-
pid: AT_abc387_d
tag: []
---

# [ABC387D] Snaky Walk

## 题目描述

给你一张地图，图中只包含起点```S```，终点```G```，障碍```#```，道路```.```。从起点出发，第一步方向任意，但之后的每一步都不能与之前相同。以这样的移动方式，求出到达终点的最少步数。

## 输入格式

输入按照如下格式由标准输入给出。
>$H$,$W$     
$S_1$     
$S_2$  
.      
.     
.     
$S_H$

## 输出格式

求出到达终点的最少步数。如不能到达，输出-1。

## 说明/提示

#### 约定
- $1\le H,W\le 1000$
- $H,W$均为整数
- $S_i$均为```S```，```G```，```#```，```.```组成的长为$W$的字符串。
- 每行，每列字符均相邻
#### 样例解释 1
![](https://img.atcoder.jp/abc387/6ef2f123adae6bc6bb157af8f30afe89.png)
如左图，路线为$(1,2)\rightarrow (2,2)\rightarrow (2,3)\rightarrow (3,3)\rightarrow (3,4)\rightarrow (2,4)\rightarrow (2,5)\rightarrow (1,5)$，移动7次即可到达终点。6次以下均不能到达终点，所以答案是7。       
请注意，如右图，不能走连续横向的路径（或走连续纵向的路径）。
#### 样例解释 2
模拟一下，明显到不了。

## 样例 #1

### 输入

```
3 5

.S#.G

.....

.#...
```

### 输出

```
7
```

## 样例 #2

### 输入

```
3 5

..#.G

.....

S#...
```

### 输出

```
-1
```

## 样例 #3

### 输入

```
8 63

...............................................................

..S...#............................#####..#####..#####..####G..

..#...#................................#..#...#......#..#......

..#####..####...####..####..#..#...#####..#...#..#####..#####..

..#...#..#..#...#..#..#..#..#..#...#......#...#..#..........#..

..#...#..#####..####..####..####...#####..#####..#####..#####..

................#.....#........#...............................

................#.....#........#...............................
```

### 输出

```
148
```



---

---
title: "[ABC389D] Squares in Circle"
layout: "post"
diff: 普及/提高-
pid: AT_abc389_d
tag: []
---

# [ABC389D] Squares in Circle

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc389/tasks/abc389_d

二次元座標平面上に $ 1\times\ 1 $ の正方形が無限に敷き詰められています。

ある正方形の中心を中心として、半径 $ R $ の円を描いたとき、円に完全に内包される正方形は何個あるでしょうか？

より厳密には、整数組 $ (i,j) $ であって、$ 4 $ 点 $ (i+0.5,j+0.5),(i+0.5,j-0.5),(i-0.5,j+0.5),(i-0.5,j-0.5) $ 全てが原点との距離が $ R $ 以下という条件を満たすものの個数を求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ R $

## 输出格式

答えを出力せよ。

## 说明/提示

### 制約

- $ 1\leq\ R\leq\ 10^{6} $
- 入力される数値は全て整数
 
### Sample Explanation 1

正方形の中心が円の中心と一致するような正方形、及びその正方形に隣接する正方形 $ 4 $ 個の、合計 $ 5 $ 個の正方形が円に完全に内包されています。

## 样例 #1

### 输入

```
2
```

### 输出

```
5
```

## 样例 #2

### 输入

```
4
```

### 输出

```
37
```

## 样例 #3

### 输入

```
26
```

### 输出

```
2025
```



---

---
title: "[ABC390E] Vitamin Balance"
layout: "post"
diff: 普及/提高-
pid: AT_abc390_e
tag: []
---

# [ABC390E] Vitamin Balance

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc390/tasks/abc390_e

$ N $ 個の食べ物があり、それぞれの食べ物にはビタミン $ 1,2,3 $ のうちちょうど $ 1 $ つのみが含まれています。  
具体的には、$ i $ 個目の食べ物を食べると、ビタミン $ V_i $ が $ A_i $ だけ摂取でき、またカロリーが $ C_i $ だけ摂取されます。

高橋君は、摂取するカロリーが合計で $ X $ 以下となるように、$ N $ 個の食べ物のうちいくつか（$ 0 $ 個でも良い）を選んで食べることができます。  
このとき、「ビタミン $ 1,2,3 $ のうちもっとも摂取量が少ないものの摂取量」としてあり得る最大の値を求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ X $ $ V_1 $ $ A_1 $ $ C_1 $ $ V_2 $ $ A_2 $ $ C_2 $ $ \vdots $ $ V_N $ $ A_N $ $ C_N $

## 输出格式

高橋君が摂取カロリーの合計が $ X $ 以下となるように食べ物を食べたとき、「ビタミン $ 1,2,3 $ のうちもっとも摂取量が少ないものの摂取量」としてあり得る最大の値を出力せよ。

## 说明/提示

### 制約

- $ 1\leq\ N\ \leq\ 5000 $
- $ 1\leq\ X\ \leq\ 5000 $
- $ 1\leq\ V_i\leq\ 3 $
- $ 1\leq\ A_i\leq\ 2\times\ 10^5 $
- $ 1\leq\ C_i\leq\ X $
- 入力はすべて整数

### Sample Explanation 1

それぞれの食べ物を食べると高橋君は次のものを摂取します。 - $ 1 $ 個目の食べ物を食べると、ビタミン $ 1 $ を $ 8 $ とカロリーを $ 5 $ だけ摂取する。 - $ 2 $ 個目の食べ物を食べると、ビタミン $ 2 $ を $ 3 $ とカロリーを $ 5 $ だけ摂取する。 - $ 3 $ 個目の食べ物を食べると、ビタミン $ 2 $ を $ 7 $ とカロリーを $ 10 $ だけ摂取する。 - $ 4 $ 個目の食べ物を食べると、ビタミン $ 3 $ を $ 2 $ とカロリーを $ 5 $ だけ摂取する。 - $ 5 $ 個目の食べ物を食べると、ビタミン $ 3 $ を $ 3 $ とカロリーを $ 10 $ だけ摂取する。 高橋君が $ 1 $, $ 2 $, $ 4 $, $ 5 $ 個目の食べ物を食べると、 高橋君はビタミン $ 1 $ を $ 8 $、ビタミン $ 2 $ を $ 3 $、ビタミン $ 3 $ を $ 5 $、そしてカロリーを $ 25 $ だけ摂取します。 このとき、「ビタミン $ 1,2,3 $ のうちもっとも摂取量が少ないもの」はビタミン $ 2 $ であり、その摂取量は $ 3 $ です。 どのように食べ物を選んで食べても、摂取カロリーの合計が $ 25 $ 以下となるようにビタミン $ 1,2,3 $ すべてを $ 4 $ 以上摂取することはできないため、$ 3 $ を出力します。

## 样例 #1

### 输入

```
5 25
1 8 5
2 3 5
2 7 10
3 2 5
3 3 10
```

### 输出

```
3
```

## 样例 #2

### 输入

```
2 5000
1 200000 1
2 200000 1
```

### 输出

```
0
```



---

---
title: "[ABC391D] Gravity"
layout: "post"
diff: 普及/提高-
pid: AT_abc391_d
tag: []
---

# [ABC391D] Gravity

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc391/tasks/abc391_d

$ 10^9 $ 行 $ W $ 列のグリッドがあります。左から $ x $ 列目、**下から** $ y $ 行目のマスを $ (x,y) $ と表します。

$ N $ 個のブロックがあります。各ブロックは $ 1\ \times\ 1 $ の正方形で、ブロック $ i $ $ (1\ \leq\ i\ \leq\ N) $ は時刻 $ 0 $ にマス $ (X_i,Y_i) $ にあります。

時刻 $ t=1,2,\dots,10^{100} $ に、以下のルールに従ってブロックを動かします。

- グリッドの下から $ 1 $ 行目がすべてブロックで埋まっているならば、下から $ 1 $ 行目にあるブロックをすべて消滅させる。
- 残っているブロックについて、下にあるブロックから順番に、以下の操作を行う。
  - ブロックが一番下の行にある、またはそのブロックの $ 1 $ つ下のマスにもブロックがあるならば、何もしない
  - そうでなければ、ブロックを $ 1 $ つ下のマスに動かす。

$ Q $ 個の質問が与えられます。$ j $ 番目 $ (1\ \leq\ j\ \leq\ Q) $ の質問では、時刻 $ T_j+0.5 $ にブロック $ A_j $ が存在するかどうか答えてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ W $ $ X_1 $ $ Y_1 $ $ X_2 $ $ Y_2 $ $ \vdots $ $ X_N $ $ Y_N $ $ Q $ $ T_1 $ $ A_1 $ $ T_2 $ $ A_2 $ $ \vdots $ $ T_Q $ $ A_Q $

## 输出格式

$ Q $ 行出力せよ。$ i $ 行目には、時刻 $ T_i+0.5 $ にブロック $ A_i $ が存在するならば `Yes` を、存在しないならば `No` を出力せよ。

## 说明/提示

### 制約

- $ 1\ \leq\ N\ \leq\ 2\ \times\ 10^5 $
- $ 1\ \leq\ W\ \leq\ N $
- $ 1\ \leq\ X_i\ \leq\ W $
- $ 1\ \leq\ Y_i\ \leq\ 10^9 $
- $ i\ \neq\ j $ なら $ (X_i,Y_i)\ \neq\ (X_j,Y_j) $
- $ 1\ \leq\ Q\ \leq\ 2\ \times\ 10^5 $
- $ 1\ \leq\ T_j\ \leq\ 10^9 $
- $ 1\ \leq\ A_j\ \leq\ N $
- 入力はすべて整数

### Sample Explanation 1

ブロックの位置は以下のように変化します。 ![](https://img.atcoder.jp/abc391/4a6590753edcbad7ea1e8ce7f172902a.png) - 質問 $ 1 $: 時刻 $ 1.5 $ にブロック $ 1 $ は存在するので、答えは `Yes` です。 - 質問 $ 2 $: 時刻 $ 1.5 $ にブロック $ 2 $ は存在するので、答えは `Yes` です。 - 質問 $ 3 $: ブロック $ 3 $ は時刻 $ 2 $ に消滅します。よって、時刻 $ 2.5 $ にブロック $ 3 $ は存在しないので、答えは `No` です。

## 样例 #1

### 输入

```
5 3
1 1
1 2
2 2
3 2
2 3
6
1 1
1 2
2 3
2 5
3 4
3 5
```

### 输出

```
Yes
Yes
No
Yes
No
Yes
```

## 样例 #2

### 输入

```
3 2
1 1
2 1
1 2
4
1 1
1 2
1 3
2 3
```

### 输出

```
No
No
Yes
Yes
```



---

---
title: "[AGC002C] Knot Puzzle"
layout: "post"
diff: 普及/提高-
pid: AT_agc002_c
tag: []
---

# [AGC002C] Knot Puzzle

## 题目描述

[problemUrl]: https://atcoder.jp/contests/agc002/tasks/agc002_c





---

---
title: "[AGC003B] Simplified mahjong"
layout: "post"
diff: 普及/提高-
pid: AT_agc003_b
tag: []
---

# [AGC003B] Simplified mahjong

## 题目描述

[problemUrl]: https://atcoder.jp/contests/agc003/tasks/agc003_b

高橋君は $ 1 $ から $ N $ までの整数のうちのどれかが書かれたカードをたくさん持っています。 高橋君は整数 $ i $ が書かれたカードを $ A_i $ 枚持っています。

$ 2 $ 枚のカードについて、それらに書かれた整数の差の絶対値が $ 1 $ 以下のとき、これらをペアにすることができます。

高橋君は、同じカードが複数のペアに使われないように、できるだけ多くのペアを作りたいです。高橋君が作れるペアの個数の最大値を求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ A_1 $ : $ A_N $

## 输出格式

高橋君が作れるペアの個数の最大値を出力せよ。

## 说明/提示

### 制約

- $ 1\ ≦\ N\ ≦\ 10^5 $
- $ 0\ ≦\ A_i\ ≦\ 10^9\ (1\ ≦\ i\ ≦\ N) $
- 入力はすべて整数である。

### Sample Explanation 1

一例として、$ (1,1),(1,1),(3,4),(3,4) $ の $ 4 $ つのペアをつくることができます。

## 样例 #1

### 输入

```
4

4

0

3

2
```

### 输出

```
4
```

## 样例 #2

### 输入

```
8

2

0

1

6

0

8

2

1
```

### 输出

```
9
```



---

---
title: "[AGC008A] Simple Calculator"
layout: "post"
diff: 普及/提高-
pid: AT_agc008_a
tag: []
---

# [AGC008A] Simple Calculator

## 题目描述

[problemUrl]: https://atcoder.jp/contests/agc008/tasks/agc008_a

すぬけ君は電卓を持っています。 この電卓にはディスプレイと $ 2 $ 個のボタンが付いています。

最初、ディスプレイの値は整数 $ x $ です。 すぬけ君の目標は、ディスプレイの値を整数 $ y $ にすることです。 そのために、すぬけ君は次の $ 2 $ 個のボタンを好きな順番で何回か押すことができます。

- ボタン A : ディスプレイの値を $ 1 $ 増やす。
- ボタン B : ディスプレイの値の符号を反転する。

目標を達成するためにすぬけ君がボタンを押す回数の最小値を求めてください。 なお、整数 $ x $, $ y $ の値によらず、必ず目標を達成できることが示せます。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ x $ $ y $

## 输出格式

目標を達成するためにすぬけ君がボタンを押す回数の最小値を出力せよ。

## 说明/提示

### 制約

- $ x $, $ y $ は整数である。
- $ |x|,\ |y|\ <\ =\ 10^9 $
- $ x $, $ y $ は相異なる。

### Sample Explanation 1

ボタン A を $ 10 $ 回押せばよいです。

### Sample Explanation 2

ボタン B を $ 1 $ 回押せばよいです。

### Sample Explanation 3

次の順でボタンを押せばよいです。 - ボタン B を $ 1 $ 回押す。 - ボタン A を $ 10 $ 回押す。 - ボタン B を $ 1 $ 回押す。

## 样例 #1

### 输入

```
10 20
```

### 输出

```
10
```

## 样例 #2

### 输入

```
10 -10
```

### 输出

```
1
```

## 样例 #3

### 输入

```
-10 -20
```

### 输出

```
12
```



---

---
title: "[AGC009A] Multiple Array"
layout: "post"
diff: 普及/提高-
pid: AT_agc009_a
tag: []
---

# [AGC009A] Multiple Array

## 题目描述

[problemUrl]: https://atcoder.jp/contests/jrex2017/tasks/agc009_a

$ N $ 項からなる数列 $ A_1,...,A_N $ があり、$ N $ 個のボタンがあります。 $ i(1\ ≦\ i\ ≦\ N) $ 個目のボタンを押すと、数列 $ A $ の $ 1 $ 項目から $ i $ 項目までの値が $ 1 $ ずつ増加します。

数列 $ B_1,...,B_N $ が与えられます。高橋君は、これらのボタンを何回か押して、すべての $ i $ に対し、$ A_i $ が $ B_i $ の倍数になるようにします。

高橋君がボタンを押す回数の最小値を求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ A_1 $ $ B_1 $ : $ A_N $ $ B_N $

## 输出格式

高橋君がボタンを押す回数の最小値を表す整数を出力せよ。

## 说明/提示

### 制約

- 入力はすべて整数である。
- $ 1\ ≦\ N\ ≦\ 10^5 $
- $ 0\ ≦\ A_i\ ≦\ 10^9(1\ ≦\ i\ ≦\ N) $
- $ 1\ ≦\ B_i\ ≦\ 10^9(1\ ≦\ i\ ≦\ N) $

### Sample Explanation 1

$ 1 $ つめのボタンを $ 2 $ 回、$ 2 $ つめのボタンを $ 2 $ 回、$ 3 $ つめのボタンを $ 3 $ 回押せばよいです。

## 样例 #1

### 输入

```
3

3 5

2 7

9 4
```

### 输出

```
7
```

## 样例 #2

### 输入

```
7

3 1

4 1

5 9

2 6

5 3

5 8

9 7
```

### 输出

```
22
```



---

---
title: "[AGC011A] Airport Bus"
layout: "post"
diff: 普及/提高-
pid: AT_agc011_a
tag: []
---

# [AGC011A] Airport Bus

## 题目描述

[problemUrl]: https://atcoder.jp/contests/agc011/tasks/agc011_a

高橋空港には，毎日飛行機で $ N $ 人の乗客が到着します． $ i $ 番目の乗客は時刻 $ T_i $ に到着します．

高橋空港に到着する乗客は全員バスで市内へ移動します．どのバスも定員は $ C $ 人であり，$ C $ 人以下の乗客を乗せることができます． 飛行機の乗客は，飛行機の到着時刻よりも早く出発するバスには乗ることができません． また，飛行機の到着時刻から $ K $ の時間が経過した後にもバスに乗れていないと，怒り出してしまいます． そのため，$ i $ 番目の乗客は，出発時刻が $ T_i $ 以上 $ T_i\ +\ K $ 以下であるようなバスに乗れるようにしないといけません．

この条件のもとで，うまくバスの出発時刻を定めるとき，必要なバスの数の最小値を求めてください． ただし，バスの出発時刻は必ずしも整数である必要はなく，同じ時刻に出発するバスが複数あってもかまいません．

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ C $ $ K $ $ T_1 $ $ T_2 $ $ : $ $ T_N $

## 输出格式

必要なバスの数の最小値を出力せよ．

## 说明/提示

### 制約

- $ 2\ \leq\ N\ \leq\ 100000 $
- $ 1\ \leq\ C\ \leq\ 10^9 $
- $ 1\ \leq\ K\ \leq\ 10^9 $
- $ 1\ \leq\ T_i\ \leq\ 10^9 $
- $ C,\ K,\ T_i $ は整数

### Sample Explanation 1

例えば，時刻 $ 4.5 $, $ 6 $, $ 12 $ にバスを出発させ，次のように乗客をバスに乗せるとよいです． - 時刻 $ 4.5 $ に出発するバスには，時刻 $ 2,\ 3 $ に到着する乗客を乗せる． - 時刻 $ 6 $ に出発するバスには，時刻 $ 1,\ 6 $ に到着する乗客を乗せる． - 時刻 $ 12 $ に出発するバスには，時刻 $ 12 $ に到着する乗客を乗せる．

## 样例 #1

### 输入

```
5 3 5

1

2

3

6

12
```

### 输出

```
3
```

## 样例 #2

### 输入

```
6 3 3

7

6

2

8

10

6
```

### 输出

```
3
```



---

---
title: "[AGC011B] Colorful Creatures"
layout: "post"
diff: 普及/提高-
pid: AT_agc011_b
tag: []
---

# [AGC011B] Colorful Creatures

## 题目描述

[problemUrl]: https://atcoder.jp/contests/agc011/tasks/agc011_b

すぬけ君は，$ N $ 匹の変わった生き物を見つけました． それぞれの生き物には色と大きさが定まっており，$ i $ 番目の生き物の色は $ i $，大きさは $ A_i $ で表されます．

どの生き物も，大きさが自分の $ 2 $ 倍以下であるような他の生き物を吸収することができます． 大きさ $ A $，色 $ B $ の生き物が大きさ $ C $，色 $ D $ の生き物を吸収すると ($ C\ \leq\ 2\ \times\ A $)，合体して大きさ $ A+C $，色 $ B $ の生き物になります． ここで，$ 2 $ 匹の生き物の大きさによっては，どちらも他方を吸収することが可能な場合があります．

すぬけ君がこの生き物たちを観察していると，合体を繰り返して，最終的に $ 1 $ 匹になりました． このとき，残った生き物の色として考えられるものは何種類あるかを求めてください．

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ A_1 $ $ A_2 $ … $ A_N $

## 输出格式

この生き物たちが合体を繰り返して，最終的に $ 1 $ 匹になったとき，残った生き物の色として考えられるものは何通りあるかを出力せよ．

## 说明/提示

### 制約

- $ 2\ \leq\ N\ \leq\ 100000 $
- $ 1\ \leq\ A_i\ \leq\ 10^9 $
- $ A_i $ は整数

### Sample Explanation 1

最終的に残った生き物の色としては色 $ 1 $, $ 3 $ が考えられます． 例えば，色 $ 3 $ の生き物が色 $ 2 $ の生き物を吸収し，次に色 $ 1 $ の生き物が色 $ 3 $ の生き物と合体すると，色 $ 1 $ の生き物のみが残ります．

### Sample Explanation 2

同じ大きさの生き物が複数いる場合もあります．

## 样例 #1

### 输入

```
3

3 1 4
```

### 输出

```
2
```

## 样例 #2

### 输入

```
5

1 1 1 1 1
```

### 输出

```
5
```

## 样例 #3

### 输入

```
6

40 1 30 2 7 20
```

### 输出

```
4
```



---

---
title: "[AGC012A] AtCoder Group Contest"
layout: "post"
diff: 普及/提高-
pid: AT_agc012_a
tag: []
---

# [AGC012A] AtCoder Group Contest

## 题目描述

[problemUrl]: https://atcoder.jp/contests/agc012/tasks/agc012_a

AtCoder Group Contestの参加者に $ 3N $ 人が参加します。 $ i $ 番目の参加者の *強さ* は整数 $ a_i $ で表されます。 参加者が $ 3 $ 人 $ 1 $ 組となるようにチームを $ N $ 組作ることにしました。$ 1 $ 人の参加者が複数のチームに所属することはできません。

チームの強さはチームメンバーの強さのうち $ 2 $ 番目に大きい値で表されます。 例えば、強さが $ 1,5,2 $ のメンバーからなるチームの強さは $ 2 $ になり、強さが $ 3,2,3 $ のメンバーからなるチームの強さは $ 3 $ になります。

$ N $ 組のチームの強さの和としてありうる値のうち、最大の値を求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ a_1 $ $ a_2 $ $ ... $ $ a_{3N} $

## 输出格式

答えを出力せよ。

## 说明/提示

### 制約

- $ 1\ ≦\ N\ ≦\ 10^5 $
- $ 1\ ≦\ a_i\ ≦\ 10^{9} $
- $ a_i $ は整数

### Sample Explanation 1

例えば以下のようにチームを作ったとき、チームの強さの和が最大となります。 - チーム $ 1 $：$ 1,4,5 $ 番目の参加者からなる。 - チーム $ 2 $：$ 2,3,6 $ 番目の参加者からなる。

### Sample Explanation 2

チームの強さの和は非常に大きくなることがあります。

## 样例 #1

### 输入

```
2

5 2 8 5 1 5
```

### 输出

```
10
```

## 样例 #2

### 输入

```
10

1000000000 1000000000 1000000000 1000000000 1000000000 1000000000 1000000000 1000000000 1000000000 1000000000 1000000000 1000000000 1000000000 1000000000 1000000000 1000000000 1000000000 1000000000 1000000000 1000000000 1000000000 1000000000 1000000000 1000000000 1000000000 1000000000 1000000000 1000000000 1000000000 1000000000
```

### 输出

```
10000000000
```



---

---
title: "[AGC013A] Sorted Arrays"
layout: "post"
diff: 普及/提高-
pid: AT_agc013_a
tag: []
---

# [AGC013A] Sorted Arrays

## 题目描述

## 题目翻译

给出长度为N的数列A，你需要把A划分成几个连续子串，要求每个子串都为单调不降子串或单调不升子串，求子串的最少个数。

## 输入格式

第一行一个数N，第2行为数列A

## 输出格式

一个数，代表子串的最小个数

## 样例 #1

### 输入

```
6

1 2 3 2 2 1
```

### 输出

```
2
```

## 样例 #2

### 输入

```
9

1 2 1 2 1 2 1 2 1
```

### 输出

```
5
```

## 样例 #3

### 输入

```
7

1 2 3 2 1 999999999 1000000000
```

### 输出

```
3
```



---

---
title: "[AGC013B] Hamiltonish Path"
layout: "post"
diff: 普及/提高-
pid: AT_agc013_b
tag: []
---

# [AGC013B] Hamiltonish Path

## 题目描述

[problemUrl]: https://atcoder.jp/contests/agc013/tasks/agc013_b

$ N $ 頂点 $ M $ 辺の、連結な単純無向グラフが与えられます。 頂点には $ 1 $ から $ N $ までの番号がついており、辺には $ 1 $ から $ M $ までの番号がついています。 辺 $ i $ は、頂点 $ A_i $ と頂点 $ B_i $ を結んでいます。 次の条件を満たすパスを $ 1 $ つ見つけて、出力してください。

- $ 2 $ 個以上の頂点を通る
- 同じ頂点を $ 2 $ 度以上通らない
- パスの少なくとも一方の端点と直接辺で結ばれている頂点は、必ずパスに含まれる

ただし、この問題の制約の下で、このようなパスが必ず存在することが証明できます。 また、あり得る答えのうちどれを出力しても構いません。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ M $ $ A_1 $ $ B_1 $ $ A_2 $ $ B_2 $ $ : $ $ A_M $ $ B_M $

## 输出格式

条件を満たすパスを $ 1 $ つ見つけて出力せよ。 出力の $ 1 $ 行目には、パスに含まれる頂点の個数を出力せよ。 出力の $ 2 $ 行目には、パスに含まれる頂点の番号を、パスを形成するような順序で、空白区切りにして出力せよ。

## 说明/提示

### 制約

- $ 2\ \leq\ N\ \leq\ 10^5 $
- $ 1\ \leq\ M\ \leq\ 10^5 $
- $ 1\ \leq\ A_i\ <\ B_i\ \leq\ N $
- 与えられるグラフは連結かつ単純（どの $ 2 $ 頂点を直接結ぶ辺も高々 $ 1 $ つ）である

### Sample Explanation 1

頂点 $ 2 $ と直接辺で結ばれている頂点は、頂点 $ 3 $ と $ 4 $ です。 頂点 $ 4 $ と直接辺で結ばれている頂点は、頂点 $ 1 $ と $ 2 $ です。 なので、$ 2 $ → $ 3 $ → $ 1 $ → $ 4 $ というパスは条件を満たします。

## 样例 #1

### 输入

```
5 6

1 3

1 4

2 3

1 5

3 5

2 4
```

### 输出

```
4

2 3 1 4
```

## 样例 #2

### 输入

```
7 8

1 2

2 3

3 4

4 5

5 6

6 7

3 5

2 6
```

### 输出

```
7

1 2 3 4 5 6 7
```

## 样例 #3

### 输入

```
12 18

3 5

4 12

9 11

1 10

2 5

6 10

8 11

1 3

4 10

2 4

3 7

2 10

3 12

3 9

1 7

2 3

2 11

10 11
```

### 输出

```
8

12 4 2 5 3 9 11 8
```



---

---
title: "[AGC015B] Evilator"
layout: "post"
diff: 普及/提高-
pid: AT_agc015_b
tag: []
---

# [AGC015B] Evilator

## 题目描述

[problemUrl]: https://atcoder.jp/contests/agc015/tasks/agc015_b

すけぬ君は、$ N $ 階建てのビルを建てました。ビルにはエレベーターが $ 1 $ 基あり、すべての階に止まります。

すけぬ君は、各階に上下の方向ボタンを設置しましたが、うっかりしていたため、どの階にも上向きか下向きの片方のボタンしかありません。 そのため、どの階からも上か下のどちらかにしか進むことができません。 $ S_i $ が `U` のとき $ i $ 階には上向きのボタンしかなく、上にしか進めないことを、`D` のとき下向きのボタンしかなく、 下にしか進めないことを表します。

ある階から目的の階へと移動したい住民は、仕方がないので必要があれば他の階を経由して目的の階へと向かうことにしました。 全ての階の順序対 $ (i,j) $ についての、$ i $ 階から $ j $ 階へ行くときのエレベーターに乗る回数の最小値の合計を求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ S_1S_2...S_{|S|} $

## 输出格式

全ての階の順序対 $ (i,j) $ についての、$ i $ 階から $ j $ 階へ行くときのエレベーターに乗る回数の最小値の合計を出力せよ。

## 说明/提示

### 制約

- $ 2\ ≦\ |S|\ ≦\ 10^5 $
- $ S_i $ は `U` または `D` である
- $ S_1 $ は `U` である
- $ S_{|S|} $ は `D` である

### Sample Explanation 1

$ 1 $ 階から $ 2 $ 階までは、$ 1 $ 回エレベーターに乗れば行くことができます。 $ 1 $ 階から $ 3 $ 階までは、$ 1 $ 回エレベーターに乗れば行くことができます。 $ 2 $ 階から $ 1 $ 階までは、$ 2 $ 回エレベーターに乗れば行くことができます。 $ 2 $ 階から $ 3 $ 階までは、$ 1 $ 回エレベーターに乗れば行くことができます。 $ 3 $ 階から $ 1 $ 階までは、$ 1 $ 回エレベーターに乗れば行くことができます。 $ 3 $ 階から $ 2 $ 階までは、$ 1 $ 回エレベーターに乗れば行くことができます。 これらの合計は $ 7 $ なので、$ 7 $ を出力します。

## 样例 #1

### 输入

```
UUD
```

### 输出

```
7
```

## 样例 #2

### 输入

```
UUDUUDUD
```

### 输出

```
77
```



---

---
title: "[AGC016A] Shrinking"
layout: "post"
diff: 普及/提高-
pid: AT_agc016_a
tag: []
---

# [AGC016A] Shrinking

## 题目描述

[problemUrl]: https://atcoder.jp/contests/agc016/tasks/agc016_a

すぬけ君は、次のルールに従い、長さ $ N $ の文字列 $ t $ を長さ $ N\ -\ 1 $ の文字列 $ t' $ へ変えることができます。

- 各 $ i $ ($ 1\ <\ =\ i\ <\ =\ N\ -\ 1 $) について、$ t' $ の $ i $ 文字目は $ t $ の $ i $, $ i\ +\ 1 $ 文字目のどちらかである。

英小文字のみからなる文字列 $ s $ があります。 すぬけ君の目標は、$ s $ に上記の操作を繰り返し行い、$ s $ が単一の文字のみからなるようにすることです。 目標を達成するために必要な操作回数の最小値を求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ s $

## 输出格式

目標を達成するために必要な操作回数の最小値を出力せよ。

## 说明/提示

### 制約

- $ 1\ <\ =\ |s|\ <\ =\ 100 $
- $ s $ は英小文字のみからなる。

### Sample Explanation 1

例えば、`serval` → `srvvl` → `svvv` → `vvv` と変えればよいです。

### Sample Explanation 2

例えば、`jackal` → `aacaa` → `aaaa` と変えればよいです。

### Sample Explanation 3

最初から $ s $ が単一の文字のみからなっています。

### Sample Explanation 4

$ 8 $ 回の操作によって、$ s $ を `rrrrrrrrrrrrrrrrrr` へ変えることができます。

## 样例 #1

### 输入

```
serval
```

### 输出

```
3
```

## 样例 #2

### 输入

```
jackal
```

### 输出

```
2
```

## 样例 #3

### 输入

```
zzz
```

### 输出

```
0
```

## 样例 #4

### 输入

```
whbrjpjyhsrywlqjxdbrbaomnw
```

### 输出

```
8
```



---

---
title: "[AGC019B] Reverse and Compare"
layout: "post"
diff: 普及/提高-
pid: AT_agc019_b
tag: []
---

# [AGC019B] Reverse and Compare

## 题目描述

[problemUrl]: https://atcoder.jp/contests/agc019/tasks/agc019_b

英小文字からなる文字列 $ A\ =\ A_1\ A_2\ ...\ A_n $ があります。

あなたは $ 1\ \leq\ i\ \leq\ j\ \leq\ n $ であるような任意の二つの添字 $ i,\ j $ を選び、$ A $ のうち部分文字列 $ A_i\ A_{i+1}\ ...\ A_j $ を反転することができます。

この操作は一回まで行うことができます。

これによって得られる文字列は何通りあるでしょうか？

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ A $

## 输出格式

$ A $ のうち任意の部分文字列を一回まで反転することによって、何通りの文字列が得られるか出力せよ。

## 说明/提示

### 制約

- $ 1\ \leq\ |A|\ \leq\ 200,000 $
- $ A $ は英小文字からなる。

### Sample Explanation 1

得られる文字列は `aatt`（何もしない）、`atat`（$ A[2..3] $ を反転）、`atta`（$ A[2..4] $ を反転）、`ttaa`（$ A[1..4] $ を反転）、`taat`（$ A[1..3] $ を反転）です。

### Sample Explanation 2

どの部分文字列を反転しても、結果は `xxxxxxxxxx` です。

## 样例 #1

### 输入

```
aatt
```

### 输出

```
5
```

## 样例 #2

### 输入

```
xxxxxxxxxx
```

### 输出

```
1
```

## 样例 #3

### 输入

```
abracadabra
```

### 输出

```
44
```



---

---
title: "[AGC021A] Digit Sum 2"
layout: "post"
diff: 普及/提高-
pid: AT_agc021_a
tag: []
---

# [AGC021A] Digit Sum 2

## 题目描述

[problemUrl]: https://atcoder.jp/contests/agc021/tasks/agc021_a

$ N $ 以下の正の整数の $ 10 $ 進法での各桁の和の最大値を求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $

## 输出格式

$ N $ 以下の正の整数の $ 10 $ 進法での各桁の和の最大値を出力せよ。

## 说明/提示

### 制約

- $ 1\leq\ N\ \leq\ 10^{16} $
- $ N $ は整数である

### Sample Explanation 1

例えば $ 99 $ の各桁の和は $ 18 $ で、これが求める最大値となります。

### Sample Explanation 2

例えば $ 9989 $ の各桁の和は $ 35 $ で、これが求める最大値となります。

## 样例 #1

### 输入

```
100
```

### 输出

```
18
```

## 样例 #2

### 输入

```
9995
```

### 输出

```
35
```

## 样例 #3

### 输入

```
3141592653589793
```

### 输出

```
137
```



---

---
title: "[AGC022A] Diverse Word"
layout: "post"
diff: 普及/提高-
pid: AT_agc022_a
tag: []
---

# [AGC022A] Diverse Word

## 题目描述

[problemUrl]: https://atcoder.jp/contests/agc022/tasks/agc022_a

ゴトウは辞書をもらいました。ところが、その辞書は知らない言語で書かれていました。 分析した結果、その辞書にはありうるすべての **多彩** な単語が辞書順に載っていることがわかりました。

単語は、それが英小文字からなる空でない文字列であって、単語内の文字がすべて異なる場合、そしてその場合に限って **多彩** であると呼ばれます。例えば、`atcoder`、`zscoder`、`agc` は多彩な単語ですが、`gotou`、`connect` は多彩な単語ではありません。

多彩な単語 $ S $ が与えられるので、この辞書で $ S $ の次に載っている単語、すなわち、$ S $ より辞書順で大きいような、辞書順で最小の多彩な単語を求めてください。あるいは、そのような単語は存在しないと判定してください。

なお、$ X\ =\ x_{1}x_{2}...x_{n} $、$ Y\ =\ y_{1}y_{2}...y_{m} $ を二つの異なる文字列とするとき、$ Y $ が $ X $ の接頭辞であるか、$ j $ を $ x_{j}\ \neq\ y_{j} $ であるような最小の整数として $ x_{j}\ >\ y_{j} $ である場合、そしてその場合に限って $ X $ は $ Y $ より辞書順で大きいといいます。

## 输入格式

入力は標準入力から以下の形式で与えられる。

> $ S $

## 输出格式

辞書で $ S $ の次に載っている単語を出力せよ。ただし、そのような単語が存在しない場合は `-1` と出力せよ。

## 说明/提示

### 制約

- $ 1\ \leq\ |S|\ \leq\ 26 $
- $ S $ は多彩な単語である。

### Sample Explanation 1

`atcoder` より辞書順で大きいような、辞書順で最小の多彩な単語は `atcoderb` です。`atcoderb` は `b` より辞書順で小さいことに注意してください。

### Sample Explanation 3

これが辞書順で最も大きい多彩な単語なので、答えは `-1` です。

## 样例 #1

### 输入

```
atcoder
```

### 输出

```
atcoderb
```

## 样例 #2

### 输入

```
abc
```

### 输出

```
abcd
```

## 样例 #3

### 输入

```
zyxwvutsrqponmlkjihgfedcba
```

### 输出

```
-1
```

## 样例 #4

### 输入

```
abcdefghijklmnopqrstuvwzyx
```

### 输出

```
abcdefghijklmnopqrstuvx
```



---

---
title: "[AGC023A] Zero-Sum Ranges"
layout: "post"
diff: 普及/提高-
pid: AT_agc023_a
tag: []
---

# [AGC023A] Zero-Sum Ranges

## 题目描述

[problemUrl]: https://atcoder.jp/contests/agc023/tasks/agc023_a

長さ $ N $ の整数列 $ A $ があります。

$ A $ の **空でない** **連続する** 部分列であって、その総和が $ 0 $ になるものの個数を求めてください。 ただし、ここで数えるのは **部分列の取り出し方** であることに注意してください。 つまり、ある $ 2 $ つの部分列が列として同じでも、取り出した位置が異なるならば、それらは別々に数えるものとします。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ A_1 $ $ A_2 $ $ ... $ $ A_N $

## 输出格式

$ A $ の空でない連続する部分列であって、その総和が $ 0 $ になるものの個数を出力せよ。

## 说明/提示

### 制約

- $ 1\ \leq\ N\ \leq\ 2\ \times\ 10^5 $
- $ -10^9\ \leq\ A_i\ \leq\ 10^9 $
- 入力はすべて整数である。

### Sample Explanation 1

空でない連続した部分列であって、その総和が $ 0 $ になるのは、$ (1,3,-4) $, $ (-4,2,2) $, $ (2,-2) $ の $ 3 $ つです。

### Sample Explanation 2

この例では、列として同じだが取り出す位置の異なる部分列が複数回数えられています。 例えば、$ (1,-1) $ は $ 3 $ 回数えられています。

### Sample Explanation 3

空でない連続した部分列であって、その総和が $ 0 $ になるものはありません。

## 样例 #1

### 输入

```
6

1 3 -4 2 2 -2
```

### 输出

```
3
```

## 样例 #2

### 输入

```
7

1 -1 1 -1 1 -1 1
```

### 输出

```
12
```

## 样例 #3

### 输入

```
5

1 -2 3 -4 5
```

### 输出

```
0
```



---

---
title: "Alternating Path"
layout: "post"
diff: 普及/提高-
pid: AT_aising2019_c
tag: []
---

# Alternating Path

## 题目描述

[problemUrl]: https://atcoder.jp/contests/aising2019/tasks/aising2019_c

$ H $ 行 $ W $ 列のマス目があり、各マスは黒または白に塗られています。

各マスの色を表す $ H $ 個の長さ $ W $ の文字列 $ S_1,\ S_2,\ ...,\ S_H $ が与えられます。 マス目の上から $ i $ 番目、左から $ j $ 番目 ($ 1\ \leq\ i\ \leq\ H,\ 1\ \leq\ j\ \leq\ W $) のマスが黒く塗られているとき 文字列 $ S_i $ の $ j $ 文字目は `#` となっており、白く塗られているとき文字列 $ S_i $ の $ j $ 文字目は `.` となっています。

黒く塗られたマス $ c_1 $ と白く塗られたマス $ c_2 $ の組であって、以下の条件を満たすものの個数を求めてください。

- 上下左右に隣り合うマスへの移動を繰り返してマス $ c_1 $ からマス $ c_2 $ へ行く方法であって、通るマスの色が黒、白、黒、白・・・と交互になっているものが存在する。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ H $ $ W $ $ S_1 $ $ S_2 $ $ : $ $ S_H $

## 输出格式

答えを出力せよ。

## 说明/提示

### 制約

- $ 1\ \leq\ H,\ W\ \leq\ 400 $
- $ |S_i|\ =\ W $ ($ 1\ \leq\ i\ \leq\ H $)
- 各 $ i $ ($ 1\ \leq\ i\ \leq\ H $) に対して、文字列 $ S_i $ は文字 `#` と文字 `.` だけからなる。

### Sample Explanation 1

上から $ i $ 行目、左から $ j $ 列目のマスを $ (i,\ j) $ と書くとき、条件を満たすマスの組として $ ((1,\ 2),\ (3,\ 3)) $ や $ ((3,\ 1),\ (3,\ 2)) $ などがあります。

## 样例 #1

### 输入

```
3 3

.#.

..#

#..
```

### 输出

```
10
```

## 样例 #2

### 输入

```
2 4

....

....
```

### 输出

```
0
```

## 样例 #3

### 输入

```
4 3

###

###

...

###
```

### 输出

```
6
```



---

---
title: "Two Arrays"
layout: "post"
diff: 普及/提高-
pid: AT_apc001_b
tag: []
---

# Two Arrays

## 题目描述

[problemUrl]: https://atcoder.jp/contests/apc001/tasks/apc001_b

長さ $ N $ の数列 $ a_1,a_2,..,a_N $ と $ b_1,b_2,..,b_N $ が与えられます。 以下の操作を $ 0 $ 回以上好きなだけ繰り返して、数列 $ a $ と $ b $ を一致させられるか判定してください。

操作： $ 1 $ 以上 $ N $ 以下の整数 $ i,j $ (一致していてもよい)を選び、次の2つのことを**同時に**行う。

- $ a_i $ に $ 2 $ を足す
- $ b_j $ に $ 1 $ を足す

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ a_1 $ $ a_2 $ $ .. $ $ a_N $ $ b_1 $ $ b_2 $ $ .. $ $ b_N $

## 输出格式

操作を $ 0 $ 回以上繰り返して数列 $ a $ と $ b $ を一致させられるなら `Yes` を、 そうでないなら `No` を出力せよ。

## 说明/提示

### 制約

- $ 1\ <\ =\ N\ <\ =\ 10,000 $
- $ 0\ <\ =\ a_i,b_i\ <\ =\ 10^9 $ ($ 1\ <\ =\ i\ <\ =\ N $)
- 入力は全て整数

### Sample Explanation 1

例えば、次のように $ 3 $ 回操作すればよいです。 - $ 1 $ 回目： $ i=1,j=2 $. これによって $ a\ =\ \{3,2,3\} $, $ b\ =\ \{5,3,2\} $ となります。 - $ 2 $ 回目： $ i=1,j=2 $. これによって $ a\ =\ \{5,2,3\} $, $ b\ =\ \{5,4,2\} $ となります。 - $ 3 $ 回目： $ i=2,j=3 $. これによって $ a\ =\ \{5,4,3\} $, $ b\ =\ \{5,4,3\} $ となります。

## 样例 #1

### 输入

```
3

1 2 3

5 2 2
```

### 输出

```
Yes
```

## 样例 #2

### 输入

```
5

3 1 4 1 5

2 7 1 8 2
```

### 输出

```
No
```

## 样例 #3

### 输入

```
5

2 7 1 8 2

3 1 4 1 5
```

### 输出

```
No
```



---

---
title: "Vacant Seat"
layout: "post"
diff: 普及/提高-
pid: AT_apc001_c
tag: []
---

# Vacant Seat

## 题目描述

[problemUrl]: https://atcoder.jp/contests/apc001/tasks/apc001_c

**これはインタラクティブな問題です。**

$ N $ を $ 3 $ 以上の奇数とします。

$ N $ 個の席が円状に並んでいます。 席には $ 0 $ から $ N\ -\ 1 $ まで番号が振られています。 各 $ i $ ($ 0\ <\ =\ i\ <\ =\ N\ -\ 2 $) について、席 $ i $ と席 $ i\ +\ 1 $ は隣り合っています。 また、席 $ N\ -\ 1 $ と席 $ 0 $ は隣り合っています。

各席の状態は「空席」「男性が座っている」「女性が座っている」のどれかです。 ただし、同性どうしが隣り合う席に座っていることはありません。 $ N $ が $ 3 $ 以上の奇数の場合、空席が少なくとも $ 1 $ つは存在することが示せます。

あなたには $ N $ のみが与えられ、各席の状態は与えられません。 あなたの目標は、どれか $ 1 $ つの空席の番号を当てることです。 そのために、あなたは次のクエリを繰り返し送ることができます。

- 整数 $ i $ ($ 0\ <\ =\ i\ <\ =\ N\ -\ 1 $) を選ぶ。 席 $ i $ が空席ならば、正答となる。 そうでなければ、席 $ i $ に座っている人の性別が知らされる。

クエリを高々 $ 20 $ 回まで送ることで、どれか $ 1 $ つの空席の番号を当ててください。

### Input &amp; Output Format

最初に、$ N $ が次の形式で標準入力から与えられる。

> $ N $

次に、クエリを繰り返し送る。 クエリは次の形式で標準出力へ出力する。 行末には改行を出力せよ。

> $ i $

これに対するクエリの答えは、次の形式で標準入力から与えられる。

> $ s $

$ s $ は `Vacant`, `Male`, `Female` のどれかである。 これらはそれぞれ、席 $ i $ の状態が「空席」「男性が座っている」「女性が座っている」であることを表す。

## 说明/提示

### 制約

- $ N $ は奇数である。
- $ 3\ <\ =\ N\ <\ =\ 99,999 $

### 注意

- 出力の度に標準出力を flush せよ。 そうしない場合、`TLE` の可能性がある。
- $ s $ が `Vacant` の場合、すぐにプログラムを終了せよ。 そうしない場合、ジャッジ結果は不定である。
- クエリ回数が $ 20 $ を超えた場合、およびクエリの形式が正しくない場合、ジャッジ結果は不定である。

### 入出力例 1

このサンプルでは、$ N\ =\ 3 $ であり、席 $ 0 $, $ 1 $, $ 2 $ の状態はそれぞれ「男性が座っている」「女性が座っている」「空席」である。

 InputOutput30Male1Female2Vacant



---

---
title: "[ARC004C] 平均値太郎の憂鬱 ( The melancholy of Taro Heikinchi )"
layout: "post"
diff: 普及/提高-
pid: AT_arc004_3
tag: []
---

# [ARC004C] 平均値太郎の憂鬱 ( The melancholy of Taro Heikinchi )

## 题目描述

太郎在计算1到n的平均数时漏加了一个m，给定算错的平均数，求正确的N和M

## 输入格式

仅1行，格式为X/Y，（1<=X<=10^18且1<=Y<=10^9），表示错误的平均数为Y分之X，X/Y不一定为最简分数

## 输出格式

一行两个整数N，M，中间以一个空格隔开，如果输出答案有多组，按N从小到大的顺序在1行输出，如果没有可行答案则输出"Impossible"



---

---
title: "[ARC006C] 積み重ね"
layout: "post"
diff: 普及/提高-
pid: AT_arc006_3
tag: []
---

# [ARC006C] 積み重ね

## 题目描述

[problemUrl]: https://atcoder.jp/contests/arc006/tasks/arc006_3

 高橋君はもう大人なので、親元を離れて一人暮らしをすることにしました。トラックから引越し先の部屋へと荷物のダンボールを運びたいのですが、部屋の床がダンボールで埋まってしまうと、今日高橋君が寝るための布団がひけません。  
 そこで、$ 1 $ 箱ずつ広げて置くのではなく、ある程度ダンボールを積み重ねた山を作ることにしました。しかし、ダンボールには重さが決まっており、下にあるダンボールよりも重いダンボールを上に積み重ねると下のダンボールが潰れてしまいます。

 ![](https://cdn.luogu.com.cn/upload/vjudge_pic/AT_arc006_3/330a155330da3a362b0b8091145394d207d35d61.png)図：下にあるダンボールは上にあるダンボール以上の重さでなければならない

 

   
 トラックから運ぶ順にダンボールの重さが与えられるので、ダンボールを潰さないような積み重ね方を考えなさい。そして、その積み重ねた山の個数が最小となる場合の山の個数を求めなさい。 入力は以下の形式で標準入力から与えられる。 > $ N $ $ w_1 $ $ w_2 $ : : $ w_N $

- 入力は $ N+1 $ 行ある。
- $ 1 $ 行目には、ダンボールの個数を表す整数 $ N(1≦N≦50) $ が与えられる。
- $ 2 $ 行目からの $ N $ 行には、$ i+1(1≦i≦N) $ 行目に $ i $ 番目に運ぶダンボールの重さを表す整数 $ w_i(1≦w_i≦100,000) $ が与えられる。

 ダンボールを順番に運び、上のダンボールが下のダンボールと同じ重さまたはそれよりも軽くなるように積み重ねたときに、できるダンボールの山の数の最小値を標準出力に $ 1 $ 行で出力せよ。  
 なお、最後には改行を出力せよ。 ```

5
4
3
1
2
1
```

 ```

2
```

- 下図の例の順に積み重ねると、$ 2 $ つのダンボールの山ができる。
- $ 3 $ 番目のダンボールの次に重さ $ 2 $ のダンボールをその上に重ねることはできないので $ 1 $ つの山にすることはできず、最小は $ 2 $ となる。

 ![](https://cdn.luogu.com.cn/upload/vjudge_pic/AT_arc006_3/5cdad1a3c2b4df6c6e3065e4cf34b9c2180d2f93.png)

 ```

7
93
249
150
958
442
391
25
```

 ```

3
```

- 下図の形に積み重ねると、山の数は $ 3 $ となる。
訂正：下図の225のダンボールは25の誤りです。申し訳ありません。


 ![](https://cdn.luogu.com.cn/upload/vjudge_pic/AT_arc006_3/87e99baa40b995194b9f08a6b6727576d861b3de.png)

 ```

4
100
100
100
100
```

 ```

1
```

- 同じ重さのダンボールは積み重ねられるので、$ 1 $ つの山にすることができる。
 
```

6
5
10
15
20
25
30
```

 ```

6
```

- どのダンボールも前に運んだダンボールの上に重ねられないので、$ 1 $ つも積み重ねることができない。
- したがって、$ 6 $ つの山が最小となる。
 
```

15
3
1
4
1
5
9
2
6
5
3
5
8
9
7
9
```

 ```

6
```

- 下図のように積み重ねると最小となる。

 ![](https://cdn.luogu.com.cn/upload/vjudge_pic/AT_arc006_3/6ff699ef802388c8a1126c225e6825673732bcea.png)



---

---
title: "[ARC007C] 節約生活"
layout: "post"
diff: 普及/提高-
pid: AT_arc007_3
tag: []
---

# [ARC007C] 節約生活

## 题目描述

[problemUrl]: https://atcoder.jp/contests/arc007/tasks/arc007_3

 高橋君は有料の衛星放送を見ようとしています。有料衛星放送はお金を払わないと見ることが出来ませんが、高橋君はその契約を行なっていません。  
 しかし、有料衛星放送はどのような内容を放送しているか視聴者がわかるように、無料でも視聴可能な時間が定期的に存在し、視聴可能な時間とできない時間が交互に繰り返されます。このような視聴可能な時間とそうでない時間を視聴パターンと呼ぶことにします。  
 視聴パターンは `o` と `x` から成り立っており、図 $ 1 $ で示すように視聴可能な時間を `o` の個数、視聴できない時間を `x` の個数で表しています。

 ![](https://cdn.luogu.com.cn/upload/vjudge_pic/AT_arc007_3/c5eb5a21de826083a4af9ac1eec2edaa30369137.png)図 $ 1 $:視聴パターンの例(入力は10文字以下なので、この入力はテストに存在しません)

 

 一度テレビを点けると途切れることなくこの視聴パターンが繰り返される。また、テレビは一度点けると消すことはできません。  
 高橋君は複数のテレビを点けるタイミングをずらして並行して利用することで、無料でも常にいずれかのテレビで視聴ができる方法を思いつきました。  
 例えば図 $ 1 $ の視聴パターンの場合は図 $ 2 $ で示すように $ 5 $ 分後にもう $ 1 $ 台テレビを点ければ常に視聴ができます。  ![](https://cdn.luogu.com.cn/upload/vjudge_pic/AT_arc007_3/517dbd3c013b729576e4fa4fb70355deef1c50c3.png)図 $ 2 $:$ 2 $ 台のテレビで常に視聴する例

 

 その場合高橋君が用意しなければいけない最低限のテレビの台数を答えなさい。  
 なお、必要なテレビを全て点け終えるまでの間には視聴できない時間があっても構いませんが、全てのテレビを点けてからは常にいずれかのテレビで視聴ができないといけません。  
 入力は以下の形式で標準入力から与えられる。 > $ c_0c_1 $‥‥$ c_{N-1} $

- 入力は $ 1 $ 行のみで視聴パターンを表す長さ $ N(1≦N≦10) $ の文字列が与えられる。
- 視聴パターンは `o` と `x` から成り、$ i+1(0≦i≦N-1) $ 番目の文字 $ c_i $ はテレビを点けてから $ i $ 分から $ i+1 $ 分の間はテレビが以下の状態であることを意味する。 
  - `o`:視聴可能である。
  - `x`:視聴できない。
- 視聴パターンは少なくとも $ 1 $ つの `o` を含む。
- テレビは最初にテレビをつけてから $ j(j\ : $正の整数) 分後にのみ点けることができる。



 常にいずれかのテレビが視聴可能であるために用意しなければいけないテレビの台数の最小値を標準出力に $ 1 $ 行で出力せよ。  
 必要なテレビを全て点け終えるまでの間は視聴できない時間があっても構わないが、全てのテレビを点けてからは常にいずれかのテレビが視聴できないといけない。  
 なお、最後には改行を出力せよ。 ```

oxoxx
```

 ```

3
```

- 以下の図のタイミングでテレビを点けることで $ 3 $ 台のテレビで常に視聴ができます。

 ![](https://cdn.luogu.com.cn/upload/vjudge_pic/AT_arc007_3/0ec6f675c53f19a2dd17db5988b73005b245d24c.png)

 ```

oxxxxoooo
```

 ```

2
```

- $ 1 $ 台目のテレビを点けてから $ 4 $ 分目に $ 2 $ 台目のテレビを点けることで $ 1 $ 分目から $ 5 $ 分目直前までは視聴が不可能だが、$ 5 $ 分目以降は視聴が可能になります。
 
```

ox
```

 ```

2
```

- $ 1 $ 台目のテレビを点けてから $ 1 $ 分後に $ 2 $ 台目のテレビを点けることで $ 2 $ 台で視聴可能です。
 
```

o
```

 ```

1
```

- 視聴パターンに視聴できない時間が含まれない場合もあります。
 
```

xxxoxo
```

 ```

4
```



---

---
title: "[ARC010B] 超大型連休"
layout: "post"
diff: 普及/提高-
pid: AT_arc010_2
tag: []
---

# [ARC010B] 超大型連休

## 题目描述

[problemUrl]: https://atcoder.jp/contests/arc010/tasks/arc010_2

$ 2011 $ 年、$ AtCoder $ 国の高橋首相はある重大な決定を行った。  
 その決定とは...法改正である。国民の祝日に関する法律を変更し、休日を増やすことにした!!  
 国民の創造性を尊重するその決定が、霞が関を魔境へと変えたッ！  
  
 あなたは霞が関の国土交通省に勤務する職員であり、この法改正により上司から新たな任務を与えられた。  
 その任務とは、$ 2012 $ 年の「連休の最大日数」を計算することである。  
 連休の大きさを事前に計算することで国民の行動を予想し、高速道路の部分的な値下げを行い、経済を活性させるためだ。  
 したがって、あなたに失敗することは許されない。国民の行動を正確に予想できなくなるからだ。  
  
 以下に、「連休」の定義と諸注意を記す。

1. $ AtCoder $ 国が使用する暦は[グレゴリオ暦](http://ja.wikipedia.org/wiki/%E3%82%B0%E3%83%AC%E3%82%B4%E3%83%AA%E3%82%AA%E6%9A%A6)に従う。
2. 「連休」とは、「休日」が連続して続くことである。
3. 「土曜日」「日曜日」「祝日」「振替休日」が「休日」に相当する。
4. 「祝日」が他の休日と同じ日に指定されていた場合、「振替休日」を必ず設置する。
5. 「振替休日」は祝日の時系列順に決定していき、その祝日以降最も近い平日（休日を除いた日）となる。
6. $ 2012 $ 年 $ 1 $ 月 $ 1 $ 日は日曜日である。
 
 入力は以下の形式で標準入力から与えられる。 > $ N $ $ m_{1} $/$ d_{1} $ $ m_{2} $/$ d_{2} $ $ : $ $ : $ $ m_{n} $/$ d_{n} $

- $ 1 $ 行目には祝日の日数を表す整数 $ N $ が与えられ、 $ 0≦N≦366 $ を満たす。
- $ 2 $ 行目から $ N+1 $ 行目までの $ N $ 行で祝日の日付が与えられる。

1. $ m_{i} $ は $ i(1≦i≦366) $ 番目に与えられる祝日の月で、 $ 1≦m_{i}≦12 $ を満たす。
2. $ d_{i} $ は $ i(1≦i≦366) $ 番目に与えられる祝日の日で、
1. $ m_{i}\ =\ 2 $ のとき、 $ 1≦d_{i}≦29 $ を満たす。
2. $ m_{i}\ =\ (4,\ 6,\ 9,\ 11) $ のとき、 $ 1≦d_{i}≦30 $ を満たす。
3. $ m_{i}\ =\ (1,\ 3,\ 5,\ 7,\ 8,\ 10,\ 12) $ のとき、 $ 1≦d_{i}≦31 $ を満たす。

4. $ m_{i} $ と $ d_{i} $ はともに整数である。
5. $ m_{i} $ と $ d_{i} $ は必ず`/`で区切られて与えられる。
6. 祝日は時系列順に与えられるとは限らないことに注意せよ。ただし、同じ日付が複数与えられないことは保証されている。
 
 法改正後における $ 2012 $ 年の連休の最大日数を出力せよ。  
 出力は標準出力におこない、末尾には改行をいれること。  
```

1
1/9
```

 ```

3
```

- 1/7(土),1/8(日),1/9(月)の $ 3 $ 連休が最長です。
 
```

1
1/10
```

 ```

2
```

- 1/10(火)が祝日となり、1/7(土),1/8(日)などの $ 2 $ 連休が最長です。
 
```

1
1/7
```

 ```

3
```

- 1/7は土曜日なので、以降で最も近い平日である1/9が振替休日になります。
- よって、1/7(土)、1/8(日)、1/9(月)の3連休が最長です。
 
```

2
1/7
1/9
```

 ```

4
```

- 1/7は土曜日なので振替休日を以降に設定したく、1/9が祝日なので1/10が振替休日になります。
- よって、1/7(土)、1/8(日)、1/9(月)、1/10(火)の4連休が最長です。



---

---
title: "[ARC011B] ルイス・キャロルの記憶術"
layout: "post"
diff: 普及/提高-
pid: AT_arc011_2
tag: []
---

# [ARC011B] ルイス・キャロルの記憶術

## 题目描述

例如，莫扎特的生卒年可以通过记忆句子 `Mozart plays magic.` 来记住。其中，词 $ plays $ 转换成 $ 756 $，词 $ magic $ 转换成 $ 791 $，从而得到 $ 1756 $ 年至 $ 1791 $ 年。你的任务是，编写一个程序，根据输入的记忆句子，从左到右逐个词进行转换，输出转换得到的数字。

## 输入格式

输入包括以下内容：
- 第一行是一个整数 $ N (1 \leq N \leq 1000) $，表示有多少个单词。
- 第二行是 $ N $ 个单词，每个单词由字母、句点或逗号组成，单词之间用空格分隔。

## 输出格式

输出转换后的数字，每个数字之间用一个空格隔开。如果转换后的数字以 `0` 开头，也输出 `0`。最后请输出一个换行符。

## 示例

输入：
```
3
Mozart plays magic.
```

输出：
```
7003 756 791
```

- `Mozart`：`M` 转换为 $ 7 $，`z` 转换为 $ 0 $，`r` 转换为 $ 0 $，`t` 转换为 $ 3 $，结果为 $ 7003 $。
- 类似地，`plays` 转换为 $ 756 $，`magic` 转换为 $ 791 $。

输入：
```
3
Columbus found USA.
```

输出：
```
15716 492 6
```

- `Columbus` 转换为 $ 15716 $。
- `found` 转换为 $ 492 $。
- `USA` 转换为 $ 6 $。

输入：
```
7
I have a scissors for right hand.
```

输出：
```
85 616606 40 0983 892
```

- `I` 和 `a` 完全由元音组成，因此被忽略，结果输出 $ 5 $ 个整数。

输入：
```
4
abc ab aa aiueo
```

输出：
```
11 1
```

- 输出时不能有多余的空格。

修订：2013.01.19 21:16 第一行的 $ 5 $ 是错误的，已更正为 $ 4 $。

输入：
```
4
aaa aa a aa
```

输出：
```
```

- 因为所有单词都只含元音字母，所以仅输出一个换行符。

 **本翻译由 AI 自动生成**



---

---
title: "[ARC013B] 引越しできるかな？"
layout: "post"
diff: 普及/提高-
pid: AT_arc013_2
tag: []
---

# [ARC013B] 引越しできるかな？

## 题目描述

### 题意

给出 $C$ 个长方体的长、宽、高。

求一个最小体积的纸箱可以放入每一个长方体。

## 输入格式

第一行一个整数 $C$ 表示有 $C$ 个长方体。

接下来 $C$ 行每行三个整数 $N_i, M_i, L_i$ 表示每个长方体的长、宽、高。

$1 \le C \le 100$

$1 \le N_i,M_i,L_i \le 100$

## 输出格式

一个整数表示最小纸箱的体积。



---

---
title: "[ARC014B] あの日したしりとりの結果を僕達はまだ知らない。"
layout: "post"
diff: 普及/提高-
pid: AT_arc014_2
tag: []
---

# [ARC014B] あの日したしりとりの結果を僕達はまだ知らない。

## 题目描述

高桥君会分身之术。

今天高桥君想做个单词接龙，但是不巧附近没有朋友，所以决定分身出一个自己来陪自己完。

为了方便起见，高桥君将原本就存在的高桥君称为高桥君。

那么，高桥君和高桥分身君充分享受了单词接龙的乐趣，可悲的是，因为他们不知道单词接龙的规则，所以无法分出胜负。

可是这样的事怎么能忍?

于是高桥君们决定录下自己的发言以得到说过的单词的清单。

单词接龙的规则极其简单。只是遵循以下条件说单词:

1.当前词的开头字母是上一个词的结尾字母。(第一个单词不限)

2.不能使用曾经使用过的单词。

先违反这个规则的一方就输了,所以请你帮高桥君们来判定比赛的胜负。

## 输入格式

>第一排一个N,表示回合数
>
>接下来N行表示双方说的单词
>
>第一个单词是高桥君说的,第二个单词是分身说的,依此类推

## 输出格式

>高桥君先违反规则就输出LOSE
>
>分身先违反规则就输出WIN
>
>如果结束时双方都未违反规则就输出DRAW



---

---
title: "[ARC014C] 魂の還る場所"
layout: "post"
diff: 普及/提高-
pid: AT_arc014_3
tag: []
---

# [ARC014C] 魂の還る場所

## 题目描述

[problemUrl]: https://atcoder.jp/contests/arc014/tasks/arc014_3

高橋君が大好きなプラスチック製の円筒と不思議な赤青緑$ 3 $色のボールがある。  
 このボールはぎりぎり円筒に入れることができる大きさである。  
 円筒の両端を便宜上、右と左と呼ぶことにすると、左右好きな方からボールを入れることができる。  
 このボールは同じ色のボールと接触すると消える性質を持っている。  
 さらに、これら $ 3 $ 色の複数個のボールを入れる順番のみが決まっている時、それぞれのボールを左右のどちらから入れるかによって全てのボールを入れ終わった後に残るボールの数が変化する。  
  
 $ 3 $ 色の複数個のボールを入れる順番のみが与えられ、最後に円筒に残るボールの数が最小になるよう計画したとき、円筒に残るボール数の最小値を答えよ。  
 入力は以下の形式で標準入力から与えられる。

> $ N $ $ S $

1. $ 1 $ 行目にはボールの数を表す整数 $ N(1≦N≦50) $ が与えられる。
2. $ 2 $ 行目には入れるボールの順番 $ S $ が与えられ、 $ R $ は赤、 $ G $ は緑、 $ B $ は青色のボールを表す。 $ S $ は $ R,\ G,\ B $ の $ 3 $ 種類の文字のみが $ N $ 文字で構成される。

- $ 1≦N≦15 $ を満たす入力にのみ正解した場合、部分点として $ 30 $ 点が与えられる。
 
 最後に残るボールの数が最小になるように計画を行った時、その残る最小の数を $ 1 $ 行で出力すること。  
 また、出力の最後には改行をいれること。 ```
<pre class="prettyprint linenums">
9
RGBGGBGBR
```

 ```
<pre class="prettyprint linenums">
1
```

- まず $ R $ を入れる。 $ R $
- 次に $ G $ を左から入れる。 $ GR $
- $ B $ を右から入れる。 $ GRB $
- $ G $ を右から入れる。 $ GRBG $
- $ G $ を右から入れる。 $ GRBGG $
- この時 $ G $ が揃うので消える。 $ GRB $

- $ B $ を右から入れる。 $ GRBB $
- この時 $ B $ が揃うので消える。 $ GR $

- $ G $ を左から入れる。 $ GGR $
- この時 $ G $ が揃うので消える。 $ R $

- $ B $ を左から入れる。 $ BR $
- $ R $ を右から入れる。 $ BRR $
- この時 $ R $ が揃うので消える。 $ B $

- よって $ B $ が$ 1 $つ残るので、答えは$ 1 $である。

```
<pre class="prettyprint linenums">
6
RGBRGB
```

 ```
<pre class="prettyprint linenums">
0
```



---

---
title: "[ARC017B] 解像度が低い。"
layout: "post"
diff: 普及/提高-
pid: AT_arc017_2
tag: []
---

# [ARC017B] 解像度が低い。

## 题目描述

[problemUrl]: https://atcoder.jp/contests/arc017/tasks/arc017_2

大変なことになってしまった！！

なんと、我が社の次の決算報告会の発表者に僕が選ばれてしまったのだ！我が社のイメージのためにも、そして社内での僕の地位のためにも、なんとしても好印象を与える発表をせねばならない。

我が社の直近の業績は $ N $ 個の数からなる数列で表される。これを発表したいところだけれど……、あいにく、我が社の業績はそこまで良いとは言えないのが実情だ。一体どうすればいいんだろうか……。

途方に暮れた僕は、とりあえず発表会場の設備を調査した。なんと、これが僕の生まれ持った強運か、プロジェクターの解像度がとても低く、画面には一度に $ K $ 個の数を表示するのが限界であることがわかった。業績の数列のうちの連続する $ K $ 個をうまく選べれば、我が社の業績がうなぎのぼりであるように見せかけられるのではないだろうか？

これは最高のアイデアだと思ったが、聴衆から「それって業績の一部ですよね？他の部分も見せて頂けませんか？」と言われたらジ・エンドだ。そこで用意周到な僕は、業績の数列のうち、プロジェクターで映したときに業績が常に上昇しているように見せられるような箇所がいくつあるのか、事前に調べておくことにした。

常に成長を続ける企業であるとアピールするためには、ある値はその前の値より真に大きくなくてはいけない。つまり $ 100,\ 200,\ 300 $ という列は常に上昇していると考えるが、 $ 100,\ 200,\ 200 $ という列は常に上昇しているとは考えない。

※この問題文はフィクションです。業績はきちんと発表しましょう。

入力は以下の形式で標準入力から与えられる。

> $ N $ $ K $ $ A_1 $ $ A_2 $ : $ A_N $

- $ 1 $ 行目には、業績を表す数列の要素数 $ N\ (1\ \leq\ N\ \leq\ 300,000) $、プロジェクターで一度に表示できる数の個数 $ K\ (1\ \leq\ K\ \leq\ N) $ が半角空白区切りで与えられる。
- $ 2 $ 行目から $ N $ 行では、業績を表す数列が与えられる。このうち $ i $ 行目が $ i $ 番目の業績を表す整数 $ A_i\ (1\ \leq\ A_i\ \leq\ 300,000) $ である。

**注意:** この問題では最大で $ 300,000 $ 行ほどの入力を読み込む必要がある。ほとんどの言語では問題ないが、**Python 2.x で `input()` を使うと時間制限に間に合わないおそれがあるので、かわりに整数を読み込む際には `int(raw_input())` を使うこと。**

 業績を表す数列のうち、プロジェクターで画面に映せるような $ K $ 個の連続した部分で、その部分だけ見ると業績が常に上昇しているように見えるものの個数を標準出力に１行で出力せよ。 ```
<pre class="prettyprint linenums">
10 4
100
300
600
700
800
400
500
800
900
900
```

 ```
<pre class="prettyprint linenums">
3
```

 業績を表す $ 10 $ 個の数列から、連続する $ 4 $ 個を抜き出してみると、 - $ (100,\,\ 300,\,\ 600,\,\ 700) $ は常に上昇しているように見える
- $ (300,\,\ 600,\,\ 700,\,\ 800) $ は常に上昇しているように見える
- $ (600,\,\ 700,\,\ 800,\,\ 400) $ は常に上昇しているように見えない
- $ (700,\,\ 800,\,\ 400,\,\ 500) $ は常に上昇しているように見えない
- $ (800,\,\ 400,\,\ 500,\,\ 800) $ は常に上昇しているように見えない
- $ (400,\,\ 500,\,\ 800,\,\ 900) $ は常に上昇しているように見える
- $ (500,\,\ 800,\,\ 900,\,\ 900) $ は常に上昇しているように見えない
 
 となるので、答えは $ 3 $ であることがわかる。 ```
<pre class="prettyprint linenums">
10 3
10
40
50
80
90
30
20
40
90
95
```

 ```
<pre class="prettyprint linenums">
5
```

 この場合、常に上昇しているように見える箇所は以下の画像に矢印で示された 5 箇所となる。  
 ![](https://cdn.luogu.com.cn/upload/vjudge_pic/AT_arc017_2/fb99d046b6e768145edbb7e1ae5398f78b193ad8.png)

 ```
<pre class="prettyprint linenums">
8 4
1
2
3
4
5
6
7
8
```

 ```
<pre class="prettyprint linenums">
5
```

 元々の業績が常に上昇しているので、どこをプロジェクターに映しても大丈夫である。 ```
<pre class="prettyprint linenums">
8 2
100000
90000
50000
30000
10000
4000
200
1
```

 ```
<pre class="prettyprint linenums">
0
```

 元々の業績があまりに良くない場合、どこを映しても業績を右肩上がりに見せかけられないことがある。



---

---
title: "[ARC018B] 格子点と整数"
layout: "post"
diff: 普及/提高-
pid: AT_arc018_2
tag: []
---

# [ARC018B] 格子点と整数

## 题目描述

[problemUrl]: https://atcoder.jp/contests/arc018/tasks/arc018_2

諸君、私は整数が好きだ。  
 私は格子点が好きだ。  
 私は面積が好きだ。  
 私は三角形が好きだ。  
 私は座標平面上の、頂点が全て格子点上にある、面積が整数の三角形が大好きだ。  
 格子点の集合をみたとき、その中の任意の $ 3 $ 点を選んで作ることができる面積が整数の三角形の個数を数えるときは心が踊る。  
 心が踊るが、格子点が多いと数えるのが面倒臭い。  
 ぜひ有能なプログラマーである諸君に私の代わりに数えてほしい。  
 $ N $ 個の格子点を与えるので、その中の任意の $ 3 $ 点を選んで作ることができる、面積が整数の三角形の個数を数えるプログラムを作って欲しい。面積が $ 0 $ の三角形は三角形とは認めん！  
 ちなみに、格子点というのは座標平面上の点 $ (x,y) $ のうち $ x $ も $ y $ も整数である点のことである。

入力は以下の形式で標準入力から与えられる。

> $ N $ $ x_1 $ $ y_1 $ $ x_2 $ $ y_2 $ : $ x_N $ $ y_N $

- $ 1 $ 行目には、格子点の個数を表す整数 $ N\ (3\ ≦\ N\ ≦\ 100) $ が与えられる。
- $ 2 $ 行目から $ N $ 行では、2つの整数が空白区切りで与えられる。 $ (x_i,\ y_i)　(1\ ≦\ x_i,\ y_i\ ≦\ 10^9) $ は $ i $ 番目の格子点の位置である。同じ格子点が二度与えられることはない。( $ i\ \neq\ j $ ならば $ (x_i,\ y_i)\ \neq\ (x_j,\ y_j) $ )
 
 $ N $ 個の格子点のうち $ 3 $ つを選んで作ることができる面積が正の整数である三角形の個数を一行で出力せよ。  
 なお、出力の最後には改行を入れること。 ```
<pre class="prettyprint linenums">
3
1 1
1 2
3 1
```

 ```
<pre class="prettyprint linenums">
1
```

 $ (1,1),\ (1,\ 2),\ (3,\ 1) $ の面積が $ 1 $ の三角形が一つだけ作れる。 ```
<pre class="prettyprint linenums">
3
1 1
1 2
2 1
```

 ```
<pre class="prettyprint linenums">
0
```

 三角形 $ (1,\ 1)\ (1,\ 2)\ (2,\ 1) $ の面積は $ 0.5 $ で整数ではない。これ以外に三角形は作ることができない。 ```
<pre class="prettyprint linenums">
3
1 1
2 2
3 3
```

 ```
<pre class="prettyprint linenums">
0
```

 $ 3 $ 点は一直線上に並ぶので、三角形を作ることができない。 ```
<pre class="prettyprint linenums">
8
3 1
4 1
5 9
2 6
5 3
5 8
9 7
9 3
```

 ```
<pre class="prettyprint linenums">
38
```



---

---
title: "[ARC019B] こだわりの名前"
layout: "post"
diff: 普及/提高-
pid: AT_arc019_2
tag: []
---

# [ARC019B] こだわりの名前

## 题目描述

给定一个字符串 $A$（仅包含大写字母），求出 $A$ 修改一个字符后**不是**回文串的情况有多少种。

## 输入格式

一个字符串，表示给定的字符串 $A$。

## 输出格式

一个数，表示 $A$ 修改一个字符后**不是**回文串的情况有多少种。

## 说明/提示

$1 \le |A| \le 3 \times 10^5$。

样例解释：
- 样例 1：如果修改第一个字符，那么有 $24$ 种改法（除了字符串是`CRC`的情况其他全部）；如果修改第二个字符，有 $25$ 种改法；如果修改第三个字符，有 $24$ 种改法（除了字符串是`ARA`的情况其他全部），总共有 $24 + 25 + 24 = 73$ 种。
- 样例 2：只有 $1$ 个字符，无论怎么改都是回文串。

## 样例 #1

### 输入

```
ARC
```

### 输出

```
73
```

## 样例 #2

### 输入

```
S
```

### 输出

```
0
```

## 样例 #3

### 输入

```
NOLEMONNOMELON
```

### 输出

```
350
```



---

---
title: "[ARC020B] 縞模様"
layout: "post"
diff: 普及/提高-
pid: AT_arc020_2
tag: []
---

# [ARC020B] 縞模様

## 题目描述

小学生的高桥喜欢条纹图案。现在，Takahashi正在寻找从左到右直线排列的n*n的彩色绘图纸。由于Takahashi非常喜欢条纹图案，所以我想通过用一种带涂料的新颜色重新绘制一些绘图纸来使它看起来像条纹一样。

作为条纹的整体观察意味着整体中使用的颜色仅为2 2并且其旁边的绘图纸的颜色与其旁边的绘图纸的颜色不同。

你的工作是给已经放置的建筑纸的数量nn和油漆的成本cc用另一种颜色替换一张绘图纸所以实现条纹的最低成本它是创建一个输出值的程序。就此而言，为方便起见，每种颜色为1~10这10个数字。可用于重新涂漆的涂料颜色也只有1~10这10种。

## 输入格式

```cpp

$ n　c $

a1 a_1 a1​

a2 a_2 a2​

:

an a_n an​

```

- 在第一行，数字n（2≤ n ≤ 100）n（2≤n≤100）表示绘图纸的数量和重绘一张建筑纸所需的油漆成本c （1 ≤ c ≤ 1000）给出c（1≤c≤1000）。

- 在第2行到第nn行中，分别给出了已经排列的绘图纸的颜色。 在这些i i行中，整数a_i （1 ≤ a _ i ≤ 10）表示在直线a上对齐的绘图纸左边的第i种颜色

## 输出格式

输出在第1行中实现条纹图案所需的总成本的最小值,并 在结尾输出一个回车。

## 样例 #1

### 输入

```
3 10

3

2

1
```

### 输出

```
10
```

## 样例 #2

### 输入

```
4 100

1

1

1

1
```

### 输出

```
200
```

## 样例 #3

### 输入

```
10 1000

1

2

3

4

5

6

7

8

9

10
```

### 输出

```
8000
```



---

---
title: "[ARC023B] 謎の人物X"
layout: "post"
diff: 普及/提高-
pid: AT_arc023_2
tag: []
---

# [ARC023B] 謎の人物X

## 题目描述

[problemUrl]: https://atcoder.jp/contests/arc023/tasks/arc023_2

高橋君は謎の人物Xに連れ去られてしまい、謎の施設に閉じ込められてしまいました。この施設の床には $ R $ 行 $ C $ 列 のマス目が書かれていて、それぞれのマスには $ 1 $ つずつ数字が書かれています。高橋君はこのマス目の $ 1 $ 行目の $ 1 $ 列目のマスにいます。

長い時間閉じ込められていたので、高橋君はお腹が減ってきました。謎の人物Xによると、「隣のマスに移動する」ということをちょうど $ D $ 回行った後に高橋君がいるマスに書いてある数字と同じ値段のたこ焼きを用意してくれるそうです。あるマスの「隣のマス」とは、そのマスと辺を共有するマスのことを指します。高橋君は出来るだけ値段の高いたこ焼きが食べたいと思ったので、最大でいくらのたこ焼きを食べることが出来るかを考えることにしました。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ R $ $ C $ $ D $ $ A_{1,1} $ $ A_{1,2} $ ... $ A_{1,C} $ $ A_{2,1} $ $ A_{2,2} $ ... $ A_{2,C} $ : $ A_{R,1} $ $ A_{R,2} $ ... $ A_{R,C} $

- $ 1 $ 行目には、マス目の行数を表した整数 $ R\ (2\ ≦\ R\ ≦\ 1,000) $ と、マス目の列数を表した整数 $ C\ (2\ ≦\ C\ ≦\ 1,000) $ と、高橋君が移動しなければならない回数を表した整数 $ D\ (1\ ≦\ D\ ≦\ 2,000) $ が空白区切りで与えられる。
- 続く $ R $ 行には、マス目に書かれている数字の情報が与えられる。このうちの $ i $ 番目の行には $ C $ 個の整数が空白区切りで与えられる。このうち $ j $ 番目の整数 $ A_{i,j}\ (1\ ≦\ A_{i,j}\ ≦\ 999) $ は、$ i $ 行目の $ j $ 列目のマスに書かれている数字が $ A_{i,j} $ であることを表す。

## 输出格式

高橋君が食べることができるたこ焼きの値段の最大値を $ 1 $ 行に出力せよ。出力の末尾に改行をいれること。

## 说明/提示

### 部分点

この問題には部分点が設定されている。

- $ R\ ≦\ 100 $ かつ $ C\ ≦\ 100 $ かつ $ D\ ≦\ 200 $ を満たすテストケースすべてに正解した場合は $ 60 $ 点が与えられる。

### Sample Explanation 1

ちょうど $ 1 $ 回移動することで行くことが出来るマスは、$ 1 $ 行目の $ 2 $ 列目のマスか $ 2 $ 行目の $ 1 $ 列目のマスだけです。このケースでは、高橋君は最大で $ 5 $ 円のたこ焼きを食べることが出来ます。

### Sample Explanation 2

このケースでは、高橋君はどのように移動しても $ 999 $ 円のたこ焼きを食べることが出来ます。

### Sample Explanation 3

このケースでは、高橋君はどのように移動しても $ 198 $ 円のたこ焼きしか食べることが出来ません。

## 样例 #1

### 输入

```
3 2 1

9 5

3 1

8 9
```

### 输出

```
5
```

## 样例 #2

### 输入

```
4 4 100

999 999 999 999

999 999 999 999

999 999 999 999

999 999 999 999
```

### 输出

```
999
```

## 样例 #3

### 输入

```
3 4 5

700 198 700 198

198 700 198 700

700 198 700 198
```

### 输出

```
198
```



---

---
title: "[ARC030B] ツリーグラフ"
layout: "post"
diff: 普及/提高-
pid: AT_arc030_2
tag: []
---

# [ARC030B] ツリーグラフ

## 题目描述

### 题目大意

给定一棵 $n$ 无权树，树上每个结点有 $0$ 或 $1$ 个宝石，求从结点 $x$ 出发拿到所有宝石再回到 $x$ 的最短路径。

## 输入格式

第一行输入两个整数 $n\ (1\le n\le 100)$ 和 $x\ (1\le x\le n)$，表示有 $n$ 个节点，起点为 $x$。

第二行输入 $n$ 个整数 $h_i\ (0\le h_i\le1)$，表示节点 $i$ 上有 $h_i$ 个宝石。

第三行至第 $n$ 行，每行输入两个整数 $u_i$ 和 $v_i$，表示连接节点 $u_i$ 和 $v_i$ 之间的一条边。

## 输出格式

一行一个整数表示最短路径的长度。

## 样例 #1

### 输入

```
5 1

1 0 1 0 1

1 2

2 3

2 4

1 5
```

### 输出

```
6
```

## 样例 #2

### 输入

```
3 2

0 1 0

1 2

2 3
```

### 输出

```
0
```



---

---
title: "[ARC031B] 埋め立て"
layout: "post"
diff: 普及/提高-
pid: AT_arc031_2
tag: []
---

# [ARC031B] 埋め立て

## 题目描述

很久很久以前，某地曾有一个岛国。这个岛国由一些岛屿组成。现在，这个岛国决定填海造陆，但还没有决定填海造陆的位置。政府希望填海造陆工程能够将所有岛屿连接起来，成为一个岛屿。



给出 $10$ 格 $×10$ 格的该国地图，请判断：能否仅将一格海洋变成陆地，使该国所有岛屿连接成一个岛屿。另外，地图中表示陆地的格子上下左右互相连接的区域称为一个岛屿。

## 输入格式

输入按以下形式：

$$ A_{1,1} \space A_{1,2} \space \dots \space A_{1,10} $$

$$ A_{2,1} \space A_{2,2} \space \dots \space A_{2,10} $$

$$ : $$

$$ A_{10,1} \space A_{10,2} \space \dots \space A_{10,10} $$ 



- 岛国的地图一定为 $10$ 行。

- 每行一定由 $10$ 个字符组成，每个字符为 'o'（表示陆地）或 'x'（表示海洋）

- 保证至少有一格为陆地。

- 保证至少有一格为海洋。

## 输出格式

如果能将 $1$ 个格子的海洋变成陆地使得整个岛国只含一个岛屿，则输出'YES'，否则输出'NO'。输出结尾请换行。

（如果本来就只有一个岛，也输出'YES'）



## 样例1解释

将红色方框处的格子变成陆地，就能将两个岛屿合并为一个。

![](https://arc031.contest.atcoder.jp/img/arc/031/2-1.png)

## 样例 #1

### 输入

```
xxxxxxxxxx

xoooooooxx

xxoooooxxx

xxxoooxxxx

xxxxoxxxxx

xxxxxxxxxx

xxxxoxxxxx

xxxoooxxxx

xxoooooxxx

xxxxxxxxxx
```

### 输出

```
YES
```

## 样例 #2

### 输入

```
xxxxxxxxxx

xoooooooxx

xxoooooxxx

xxxoooxxxx

xxxxxxxxxx

xxxxxxxxxx

xxxxxxxxxx

xxxoooxxxx

xxoooooxxx

xxxxxxxxxx
```

### 输出

```
NO
```

## 样例 #3

### 输入

```
xxxxoxxxxx

xxxxoxxxxx

xxxxoxxxxx

xxxxoxxxxx

ooooxooooo

xxxxoxxxxx

xxxxoxxxxx

xxxxoxxxxx

xxxxoxxxxx

xxxxoxxxxx
```

### 输出

```
YES
```



---

---
title: "[ARC032B] 道路工事"
layout: "post"
diff: 普及/提高-
pid: AT_arc032_2
tag: []
---

# [ARC032B] 道路工事

## 题目描述

[problemUrl]: https://atcoder.jp/contests/arc032/tasks/arc032_2

大工のチョーさん(Daiku Cho)の町では道路の建設が進んでいます。チョーさんの町には $ N $ 個の交差点と $ M $ 個の道路があり、道路は異なる2つの交差点を双方向に結んでいます。 不便なことに、ある交差点から別の交差点まで道路を使って行き来できるとは限りません。

チョーさんの建設会社は、異なる交差点を結ぶいくつかの道路を作って、$ N $ 個のどの交差点からも道路を使って他のどの交差点へも行けるようにしたいと思っています。

どの交差点からも道路を使って別のどの交差点にも行けるようにするには最小で何本の道路を建設する必要があるかを答えてください。ただし、すでにある道路でどの交差点からも別のどの交差点へ行けるとき、$ 0 $ を出力してください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ M $ $ a_1 $ $ b_1 $ $ a_2 $ $ b_2 $ : $ a_M $ $ b_M $

- $ 1 $ 行目には、チョーさんの町の交差点の数と、既にある道路の数を表す $ 2 $ つの整数 $ N\ (1\ ≦\ N\ ≦\ 100,000) $ と $ M\ (0\ ≦\ M\ ≦\ 100,000) $ がスペース区切りで与えられる。
- $ 2 $ 行目から $ M $ 行には、既にある道路の情報が与えられる。そのうち $ i $ 行目には、$ i $ 番目の道路がつなぐ $ 2 $ つの交差点を表す $ 2 $ つの整数 $ a_i,\ b_i\ (1\ ≦\ a_i\ がスペース区切りで与えられる。 $
- 同じ交差点をつなぐ道路が与えられることはない。すなわち、$ i,j\ (1≦i,j≦M) $ に対し、$ i≠j $ ならば $ a_i≠a_j $ または $ b_i≠b_j $ が成り立つ。

## 输出格式

新たに建設する道路の最小の本数を1行目に出力せよ。

末尾の改行を忘れないこと。

## 说明/提示

### Sample Explanation 1

交差点 $ 1 $、$ 2 $、$ 3 $ は互いに道路でつながっているが、交差点 $ 4 $ はつながっていない。例えば、交差点 $ 1 $ と $ 4 $ を結ぶ道路を作れば十分である。 !\[\](http://arc032.contest.atcoder.jp/img/arc/032/B1.png)

## 样例 #1

### 输入

```
4 2

1 2

1 3
```

### 输出

```
1
```

## 样例 #2

### 输入

```
6 4

1 2

2 3

1 3

5 6
```

### 输出

```
2
```



---

---
title: "[ARC033B] メタ構文変数"
layout: "post"
diff: 普及/提高-
pid: AT_arc033_2
tag: []
---

# [ARC033B] メタ構文変数

## 题目描述

[problemUrl]: https://atcoder.jp/contests/arc033/tasks/arc033_2

「$ foo $」や「$ bar $」「$ hoge $」などの、特に意味を持たない変数の名前に使用される文字列のことを「メタ構文変数」と呼びます。

高橋君は今、メタ構文変数について調べています。メタ構文変数には色々な種類があることが分かり、見つけたメタ構文変数にそれぞれに番号をつけました。高橋君はアリの $ Ant $ さんと $ Bug $ くんのソースコードを読み、それぞれのソースコードに現れるメタ構文変数の番号を列挙しました。そして、$ Ant $ さんと $ Bug $ くんの使うメタ構文変数の集合がどれくらい似ているのかを調べるために「$ Jaccard $ 係数」を計算することにしました。$ Ant $ さんのソースコードに現れるメタ構文変数の集合を $ S_A $、$ Bug $ くんのソースコードに現れるメタ構文変数の集合を $ S_B $ とするとこれらの集合の $ Jaccard $ 係数は、

- $ ||S_{A}\ ∩\ S_{B}||\ /\ ||S_{A}\ ∪\ S_{B}|| $

という式で計算できます。ここで、$ ||S|| $ は集合 $ S $ の要素数を表すものとします。別の言い方をすると、

- 「$ S_{A} $ と $ S_{B} $ の両方に現れる要素の個数」$ / $「$ S_{A} $ と $ S_{B} $ の少なくともどちらか一方には現れる要素の個数」

となります。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N_A $ $ N_B $ $ A_1 $ $ A_2 $ ... $ A_{N_A} $ $ B_1 $ $ B_2 $ ... $ B_{N_B} $

- $ 1 $ 行目には、$ 2 $ つの整数 $ N_A\ (1\ ≦\ N_A\ ≦\ 10^5),\ N_B\ (1\ ≦\ N_B\ ≦\ 10^5) $ が空白区切りで与えられる。これは、$ Ant $ さんのソースコードに $ N_A $ 個、$ Bug $ くんのソースコードに $ N_B $ 個のメタ構文変数が現れたということを表す。
- $ 2 $ 行目には、$ Ant $ さんのソースコードに現れたメタ構文変数の番号を表す $ N_A $ 個の整数が空白区切りで与えられる。このうち $ i $ 番目の整数 $ A_i\ (1\ ≦\ A_i\ ≦\ 10^9) $ は、$ Ant $ さんのソースコードに $ A_i $ 番のメタ構文変数が現れることを表す。ただし、$ p\ \neq\ q $ のとき $ A_p\ \neq\ A_q $ であることが保証される。
- $ 3 $ 行目には、$ Bug $ くんのソースコードに現れたメタ構文変数の番号を表す $ N_B $ 個の整数が空白区切りで与えられる。このうち $ i $ 番目の整数 $ B_i\ (1\ ≦\ B_i\ ≦\ 10^9) $ は、$ Bug $ さんのソースコードに $ B_i $ 番のメタ構文変数が現れることを表す。ただし、$ p\ \neq\ q $ のとき $ B_p\ \neq\ B_q $ であることが保証される。

## 输出格式

$ Ant $ さんと $ Bug $ くんのソースコードに現れるメタ構文変数の集合の $ Jaccard $ 係数を $ 1 $ 行に出力せよ。小数点以下何桁でも出力してよいが、$ 10^{-6} $ を超える絶対誤差を含んではならない。出力の末尾に改行を入れること。

## 说明/提示

### 部分点

この問題には部分点が設定されている。

- $ N_A,N_B\ ≦\ 1000 $ と $ A_i,B_i\ ≦\ 10^5 $ を満たすテストケース全てに正解した場合は、$ 40 $ 点が与えられる。
- $ A_i,B_i\ ≦\ 10^5 $ を満たすテストケース全てに正解した場合は、$ 70 $ 点が与えられる。

### Sample Explanation 1

$ Ant $ さんと $ Bug $ くんのソースコードの両方に現れるメタ構文変数は $ 1 $ 番のみで、$ Ant $ さんと $ Bug $ くんのソースコードの少なくともどちらか一方には現れるメタ構文変数は $ 1,2,3,5 $ 番の $ 4 $ つです。 よって、$ Jaccard $ 係数は $ 1/4 $ となります。

## 样例 #1

### 输入

```
3 2

1 3 5

1 2
```

### 输出

```
0.2500000000
```

## 样例 #2

### 输入

```
9 10

11 2 33 4 55 6 77 8 99

10 11 14 19 55 1000000000 4 5 7 8
```

### 输出

```
0.2666666667
```



---

---
title: "[ARC035B] アットコーダー王国のコンテスト事情"
layout: "post"
diff: 普及/提高-
pid: AT_arc035_b
tag: []
---

# [ARC035B] アットコーダー王国のコンテスト事情

## 题目描述

[problemUrl]: https://atcoder.jp/contests/arc035/tasks/arc035_b

高橋くん様は、アットコーダー王国の王様です。

プログラミングコンテスト好きな彼が統治するアットコーダー王国では、年に一度コンテストが開催されます。

このコンテストでは $ N $ 問の問題が出題されます。また、順位を付ける際の $ 1 $ つの要素としてペナルティというものが存在します。 ある問題を正解したとき、コンテスト開始から経過した時間分だけのペナルティが、各問題ごとに発生します。そして、その発生したペナルティの総和がコンテストペナルティとなります。ARCのペナルティとは異なるルールであることに注意してください。

非常に優秀な国民である貴方には、全ての問題を解く力があります。 しかも、全ての問題について、その問題を正解するためにどれだけ時間をかければよいのかを知っており、ちょうどその時間取り組むと必ず正解することができます。

貴方は、自由な順番で問題を解くことができるので、コンテストペナルティが最小となるように解こうと思いました。

全ての問題を解くときのコンテストペナルティの最小値と、そのような解き方が何通りあるかを $ 1,000,000,007(10^9+7) $ で割った余りを答えて下さい。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ T_1 $ $ T_2 $ : $ T_N $

- $ 1 $ 行目には、コンテストでの問題数を表す整数 $ N\ (1\ ≦\ N\ ≦\ 10,000) $ がスペース区切りで与えられる。
- $ 2 $ 行目からの $ N $ 行には、各問題を解くのにかかる時間の情報が与えられる。そのうち $ i\ (1≦i≦N) $ 行目には、整数 $ T_i\ (1≦T_i≦10,000) $ が書かれており、$ i $ 番目の問題を解くのに $ T_i $ 分かかることを示す。

## 输出格式

出力は以下の形式で標準出力に出力せよ。

- $ 1 $ 行目には、コンテストペナルティの最小値を出力せよ。32bit整数型ではオーバーフローする可能性があることに気をつけること。
- $ 2 $ 行目には、コンテストペナルティが最小となるような解き方の数を $ 1,000,000,007(10^9+7) $ で割った余りを出力せよ。

## 说明/提示

### 部分点

この問題には部分点が存在する。

- $ 100 $ 点中 $ 50 $ 点分のテストケースにおいて、コンテストペナルティが最小となるような解き方の数は $ 1 $ 通りである。

### Sample Explanation 1

$ 2 $ 番目の問題を解いてから $ 1 $ 番目の問題を解くのがよい。 - コンテストが開始する(時刻：$ 0 $ 分)。 - $ 10 $ 分後、$ 2 $ 番目の問題に正解する(時刻：$ 10 $ 分)。この時点で発生するペナルティは $ 10 $ 分である。 - その $ 20 $ 分後、$ 1 $ 番目の問題に正解する(時刻： $ 30 $ 分)。この時点で発生するペナルティは $ 30 $ 分である。 コンテストペナルティは $ 40(=10+30) $ 分となる。

### Sample Explanation 3

どのような順番で解いても良い。余りを取るのを忘れないこと。

## 样例 #1

### 输入

```
2

20

10
```

### 输出

```
40

1
```

## 样例 #2

### 输入

```
5

2

1

2

1

2
```

### 输出

```
21

12
```

## 样例 #3

### 输入

```
13

1

1

1

1

1

1

1

1

1

1

1

1

1
```

### 输出

```
91

227020758
```



---

---
title: "[ARC036B] 山のデータ"
layout: "post"
diff: 普及/提高-
pid: AT_arc036_b
tag: []
---

# [ARC036B] 山のデータ

## 题目描述

现在，有 $N$ 个地点。从西起第 $i(1 \le i \le N)$ 个地点的高度为 $h_i$。

这样，就有了一个三元组 $(s，t，u)$，$(1 \le s \le t \le u \le N)$。

那么，这一个三元组是山，当且仅当：

对于满足 $s \le i \le t-1$ 的任意整数中的 $i$，满足 $h_i < h_{i+1}$ 且在对于满足 $t \le i \le u-1$ 的任意整数中的 $i$，满足 $h_i > h_{i+1}$。

现在，需要找出山的**最大**长度。（定义山的长度为 $u - s + 1$）。

## 输入格式

第一行，一个整数 $N$。

第二行到第 $N + 1$ 行，每行一个整数 $h_i$。表示第 $i$ 个地点的高度。

## 输出格式

一个整数，表示山的**最大**长度。（定义山的长度为 $u - s + 1$）。

## 说明/提示

$1 \le N \le 3 \times 10^5, 1 \le h_i \le 10^9$。

每一个 $h_i$ 互不相同（即对于 $1 \le i < j \le N$，$h_i \ne h_j$）。

## 样例 #1

### 输入

```
6

4

5

1

6

9

7
```

### 输出

```
4
```

## 样例 #2

### 输入

```
7

90

70

50

30

20

10

5
```

### 输出

```
7
```



---

---
title: "[ARC037B] バウムテスト"
layout: "post"
diff: 普及/提高-
pid: AT_arc037_b
tag: []
---

# [ARC037B] バウムテスト

## 题目描述

给出由 $N$ 个顶点和 $M$ 条边构成的无向图表。求出该图表中的像树一样的部分，即不具有闭路的部分的个数。

## 输入格式

第 $1$ 行表示无向图表中包含的顶点数 $N$ 和边的数量 $M$。

接下来的第 $2$ 行到第 $M+1$ 行，第 $i$ 行输入连接两个顶点的编号 $u_i$ 与 $v_i$。

## 输出格式

一行，输出无向图表的树的个数。

## 说明/提示

($ 2 $ $ ≦ $ $ N $ $ ≦ $ $ 100 $) 

($ 1 $ $ ≦ $ $ M $ $ ≦ $ $ N×(N-1)/2 $)

($ 1 $ $ ≦ $ $ i $ $ ≦ $ $ M $)

($ 1 $ $ ≦ $ $ u_i $ $ ＜ $ $ v_i $ $ ≦ $ $ N $) 

值得注意的是：对于任何两个顶点，直接连接它们的边最多只有一条。

## 样例 #1

### 输入

```
8 7

1 2

2 3

2 4

5 6

6 7

6 8

7 8
```

### 输出

```
1
```

## 样例 #2

### 输入

```
5 1

1 2
```

### 输出

```
4
```

## 样例 #3

### 输入

```
11 11

1 2

1 3

2 4

3 5

4 6

5 7

6 8

7 9

8 10

9 11

10 11
```

### 输出

```
0
```



---

---
title: "[ARC040B] 直線塗り"
layout: "post"
diff: 普及/提高-
pid: AT_arc040_b
tag: []
---

# [ARC040B] 直線塗り

## 题目描述

[problemUrl]: https://atcoder.jp/contests/arc040/tasks/arc040_b

イカの高橋君は床を塗るのが大好きです。床は $ N $ 個のマスが左右に $ 1 $ 列に並んでいるような形をしています。左から $ i $ 個目のマスをマス $ i $ と呼ぶことにします。すでにいくつかのマスは塗られていますが、いくつかのマスは塗られていません。高橋君はインクを発射できる射程が $ R $ の銃を使って全てのマスを塗ろうとしています。高橋君は最初マス $ 1 $ にいます。そして、$ 1 $ 秒の間に以下のいずれか $ 1 $ つの行動が行えます。

- $ 1 $ つ右のマスに移動する。すなわち、マス $ i $ からマス $ i+1 $ に移動する。ただし、マス $ N $ にいるときは行えない。
- 銃を撃って床を塗る。マス $ i $ にいるときに銃を撃つと、マス $ i $ からマス $ i+R-1 $ までのマスを全て塗ることができる。ただし、$ i+R-1 $ が $ N $ より大きい場合は、マス $ i $ からマス $ N $ までのマスが塗られる。

高橋君が全てのマスを塗るためにかかる時間の最小値を求めてください。

## 输入格式

入力はイカの形式で標準入力から与えられる。

> $ N $ $ R $ $ S $

- $ 1 $ 行目には、マス目の個数を表す整数 $ N\ (1\ ≦\ N\ ≦\ 100) $ と銃の射程を表す整数 $ R\ (1\ ≦\ R\ ≦\ N) $ が空白区切りで与えられる。
- $ 2 $ 行目には、長さ $ N $ の文字列 $ S $ が与えられる。このうち $ i\ (1\ ≦\ i\ ≦\ N) $ 文字目は、マス $ i $ の情報を以下のように表す。 
  - `.` の場合：このマスがまだ塗られていないことを表す。
  - `o` の場合：このマスがすでに塗られていることを表す。

## 输出格式

高橋君が全てのマスを塗るためにかかる時間の最小値を $ 1 $ 行に出力せよ。出力の末尾に改行を入れること。

## 说明/提示

### Sample Explanation 1

銃を撃つ → $ 4 $ 歩前進 → 銃を撃つ、という行動をとると時間が最小となります。

### Sample Explanation 2

銃を撃つ → $ 1 $ 歩前進 → 銃を撃つ、という行動をとると時間が最小となります。

### Sample Explanation 3

最初から全てのマスが塗られています。

## 样例 #1

### 输入

```
7 3

...o.o.
```

### 输出

```
6
```

## 样例 #2

### 输入

```
8 4

...o.ooo
```

### 输出

```
3
```

## 样例 #3

### 输入

```
4 4

oooo
```

### 输出

```
0
```



---

---
title: "[ARC040C] Z塗り"
layout: "post"
diff: 普及/提高-
pid: AT_arc040_c
tag: []
---

# [ARC040C] Z塗り

## 题目描述

[problemUrl]: https://atcoder.jp/contests/arc040/tasks/arc040_c

イカの高橋君は床を塗るのが大好きです。床は $ N\ \times\ N $ のマス目状に区切られており、すでにいくつかのマスは塗られています。$ i $ 行目 $ j $ 列目のマスをマス $ (i,j) $ と呼ぶことにします。高橋君は特殊なインク発射装置を用いて床を塗ろうとしています。この装置を使うと、以下のように床を塗ることができます。

- 任意の整数 $ r,\ c $ を入力して装置のボタンを押すと、「$ i\ =\ r $ かつ $ j\ ≦\ c $」または「$ i\ =\ r+1 $ かつ $ j\ ≧\ c $」を満たすようなすべてのマス $ (i,j) $ を塗ることができる。

高橋君は、全てのマスをこの装置で塗ろうと思っています。このとき、装置を使う必要のある回数の最小値を求めてください。

## 输入格式

入力はイカの形式で標準入力から与えられる。

> $ N $ $ S_1 $ $ S_2 $ : $ S_N $

- $ 1 $ 行目には、マス目の $ 1 $ 辺の個数を表す整数 $ N\ (1\ ≦\ N\ ≦\ 100) $ が与えられる。
- $ 2 $ 行目からの $ N $ 行には、マス目の情報が与えられる。このうち $ i\ (1\ ≦\ i\ ≦\ N) $ 行目には、長さ $ N $ の文字列 $ S_i $ が与えられる。このうち $ j\ (1\ ≦\ j\ ≦\ N) $ 文字目は、マス $ (i,j) $ の情報を以下のように表す。 
  - `.` の場合：このマスがまだ塗られていないことを表す。
  - `o` の場合：このマスがすでに塗られていることを表す。

## 输出格式

装置を使う回数の最小値を $ 1 $ 行に出力せよ。出力の末尾に改行を入れること。

## 说明/提示

### Sample Explanation 1

インク発射装置はこの入力のような形を綺麗に塗ることができます。

### Sample Explanation 3

はじめから全て塗られていることもあります。

## 样例 #1

### 输入

```
7

...oooo

oo.....

ooooooo

ooooooo

.....oo

oooo...

ooooooo
```

### 输出

```
2
```

## 样例 #2

### 输入

```
4

.oo.

..oo

o..o

oo..
```

### 输出

```
3
```

## 样例 #3

### 输入

```
1

o
```

### 输出

```
0
```



---

---
title: "[ARC041B] アメーバ"
layout: "post"
diff: 普及/提高-
pid: AT_arc041_b
tag: []
---

# [ARC041B] アメーバ

## 题目描述

[problemUrl]: https://atcoder.jp/contests/arc041/tasks/arc041_b

縦 $ N $ マス、横 $ M $ マスの盤面がある。 上から $ i $ ($ 1≦i≦N $) マス目、左から $ j $ ($ 1≦j≦M $) マス目の位置を $ (i,j) $ と表す。

はじめ、マス $ (i,j) $ には $ a_{ij} $ 匹のアメーバがいた。 ただし、盤面の端にアメーバはいなかった。 すなわち、$ i=1,N $ または $ j=1,M $ ならば $ a_{ij}=0 $ である。

高橋君が大声を出すと、アメーバたちは驚いてそれぞれ次の行動をとった。

- $ 1 $ 匹のアメーバが $ 4 $ 匹に分裂し、上下左右のマスへ $ 1 $ 匹ずつ移動した。

その結果、マス $ (i,j) $ には $ b_{ij} $ 匹のアメーバがいることになった。

今のアメーバの配置 $ (b_{ij}) $ が与えられるので、はじめのアメーバの配置 $ (a_{ij}) $ を $ 1 $ つ求めよ。 ただし、$ (a_{ij}) $ は少なくとも $ 1 $ つ存在する。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ M $ $ b_{11} $$ b_{12} $$ .. $$ b_{1M} $ $ b_{21} $$ b_{22} $$ .. $$ b_{2M} $ $ : $ $ b_{N1} $$ b_{N2} $$ .. $$ b_{NM} $

- $ 1 $ 行目には、盤面の縦のマス数 $ N $ ($ 3≦N≦500 $) と横のマス数 $ M $ ($ 3≦M≦500 $) が空白区切りで与えられる。
- $ 2 $ 行目からの $ N $ 行には、今のアメーバの配置が与えられる。このうち $ i $ 行目の $ j $ 文字目の数字が $ b_{ij} $ ($ 0≦b_{ij}≦9 $) を表す。

## 输出格式

はじめのアメーバの配置を 1 つ、以下の形式で $ N $ 行に出力せよ。 ただし、$ i $ 行目の $ j $ 文字目の数字が $ a_{ij} $ を表す。 出力の末尾に改行を入れること。

> $ a_{11} $$ a_{12} $$ .. $$ a_{1M} $ $ a_{21} $$ a_{22} $$ .. $$ a_{2M} $ $ : $ $ a_{N1} $$ a_{N2} $$ .. $$ a_{NM} $

## 样例 #1

### 输入

```
3 3

010

101

010
```

### 输出

```
000

010

000
```

## 样例 #2

### 输入

```
3 4

0230

2323

0230
```

### 输出

```
0000

0230

0000
```

## 样例 #3

### 输入

```
5 5

00100

03040

20903

05060

00300
```

### 输出

```
00000

00100

02030

00300

00000
```



---

---
title: "[ARC042B] アリの高橋くん"
layout: "post"
diff: 普及/提高-
pid: AT_arc042_b
tag: []
---

# [ARC042B] アリの高橋くん

## 题目描述

阿里的高桥在凸多边形的木板上。高桥一直朝着对面的方向走，但是不知道朝着哪个方向。高桥君一走到木板周围就掉下来了。因为高桥君的位置和构成板子的凸多边形的顶点的位置被给予，所以请求高桥君从板子上掉下来之前走的最短距离。位置全部以二维坐标给出。

## 输入格式

输入以以下形式由标准输入给出。

> $ x $ $ y $ $ N $ $ x_1 $ $ y_1 $ $ x_2 $ $ y_2 $ : $ x_N $ $ y_N $

- 第1行是表示以空格分隔的高桥所在位置坐标的整数 $ x,\ y\ (-100\ ≦\ x\ ≦\ 100,\ -100\ ≦\ y\ ≦\ 100) $
- 第二行给出表示构成板的凸多边形的顶点数的整数$N$。 $ \ (3\ ≦\ N\ ≦\ 10) $
- 第$N$行是表示板顶点坐标的整数 $ x_i\ y_i\ (-100\ ≦\ x_i\ ≦\ 100,\ -100\ ≦\ y_i\ ≦\ 100) $以空格分隔。但是，板的顶点按逆时针方向的顺序给出。
- 高桥所在的位置是不包括周围的板子的内部。
- 保证板为凸多边形。

## 输出格式

把高桥从木板上掉下来之前走的最短距离输出到$1$行。如果绝对误差或相对误差的至少一方为$10^{-6}$以下，则输出被允许

### 翻译 说明/提示

## 说明/提示

如果你垂直走到哪一边，你只需走100步就从木板上掉下来。


------------

翻译者：[Eric1030](https://www.luogu.com.cn/user/995571)

## 样例 #1

### 输入

```
0 0

4

100 100

-100 100

-100 -100

100 -100
```

### 输出

```
100
```

## 样例 #2

### 输入

```
10 10

3

0 100

-100 -100

100 -100
```

### 输出

```
31.3049516850
```

## 样例 #3

### 输入

```
34 6

7

-43 -65

-23 -99

54 -68

65 92

16 83

-18 43

-39 2
```

### 输出

```
25.0284205314
```



---

---
title: "[ARC043A] 点数変換"
layout: "post"
diff: 普及/提高-
pid: AT_arc043_a
tag: []
---

# [ARC043A] 点数変換

## 题目描述

[problemUrl]: https://atcoder.jp/contests/arc043/tasks/arc043_a

$ N $ 人がテストを受けた。$ i $ 番目の人の得点は $ S_i $ である。

得点に偏りがあったので、平均が $ A $、最大値と最小値の差が $ B $ となるように得点を変換したい。

得点の変換は適切な実数 $ P,\ Q $ を選んで行う。$ i $ 番目の人の変換後の得点は $ P×S_i\ +\ Q $である。

適切な $ P,Q $ があるかどうか判断し、もしあるならばそれを出力せよ。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ A $ $ B $ $ S_1 $ $ S_2 $ : $ S_N $

- $ 1 $ 行目にはテストを受けた人数を表す整数 $ N\ (2\ ≦\ N\ ≦\ 10^5) $、変換後の平均を表す整数 $ A\ (1\ ≦\ A\ ≦\ 10^9) $、変換後の最大値と最小値の差を表す整数 $ B\ (1\ ≦\ B\ ≦\ 10^9) $ が空白区切りで与えられる。
- $ 2 $ 行目からの $ N $ 行のうち $ i $ 行目には $ i $ 番目の人の得点を表す整数 $ S_i\ (0\ ≦\ S_i\ ≦\ 10^9) $ が与えられる。

## 输出格式

もし適切な変換が存在しないならば $ -1 $ を $ 1 $ 行に出力せよ。

適切な変換が存在するならば、$ P,\ Q $ を空白区切りで $ 1 $ 行に出力せよ。 出力は絶対誤差あるいは相対誤差の少なくとも片方が $ 10^{-6} $ 以下であれば許容される。

出力の末尾に改行を入れること。

## 说明/提示

### Sample Explanation 1

$ P\ =\ 0.5,\ Q=-1 $とすると得点は順に $ 0,\ 1,\ 2,\ 3,\ 4 $ となり平均が $ 2 $, 最大値と最小値の差が $ 4 $になる。

## 样例 #1

### 输入

```
5 2 4

2

4

6

8

10
```

### 输出

```
0.5 -1
```

## 样例 #2

### 输入

```
13 29 31

3

1

4

1

5

9

2

6

5

3

5

8

9
```

### 输出

```
3.875 10.8173076
```

## 样例 #3

### 输入

```
5 1 2

34

34

34

34

34
```

### 输出

```
-1
```



---

---
title: "[ARC043B] 難易度"
layout: "post"
diff: 普及/提高-
pid: AT_arc043_b
tag: []
---

# [ARC043B] 難易度

## 题目描述

cdcq想出一场模拟赛  
作为暴力选手，cdcq出的题自然是要有明显的梯度，来让更多的选手拿到自己的分数  
现在cdcq的idea库里有$ N(4\leq N\leq 10^5) $个idea，并且他给每个idea评估了一个难度值  
他要从中选择4个idea来出题，并且这些idea需要满足如下三个条件：  
第二道题的难度值必须大于等于第一道题的两倍  
第三道题的难度值必须大于等于第二道题的两倍  
第四道题的难度值必须大于等于第三道题的两倍  
现在cdcq想考考你他总共能组出多少套题  
因为答案太大，所以你需要对$ 1,000,000,007(10^9+7) $取模

## 输入格式

第一行是一个正整数N  
接下来有N行，第i行是一个正整数$ D_i(1\leq D_i \leq 10^5) $,表示第i个idea的难度值

## 输出格式

一行一个整数，表示你的答案  
输出的末尾需要换行

## 说明/提示

部分点  
有50分满足$ 4\leq N \leq 3,000 $  
剩下的50分满足$ N(4\leq N\leq 10^5) $，共计100分  
Sample Explanation 1  
$ 1,2,3,5 $和$ 1,2,4,5 $都是可行的题目组合  
Sample Explanation 2  
没有任何一种组合满足题目条件  

感谢 @cdcq 提供的翻译

## 样例 #1

### 输入

```
5

1

2

4

5

10
```

### 输出

```
2
```

## 样例 #2

### 输入

```
10

11

12

13

14

15

16

17

18

19

20
```

### 输出

```
0
```

## 样例 #3

### 输入

```
20

1

2

3

4

5

6

7

8

9

10

11

12

13

14

15

16

17

18

19

20
```

### 输出

```
94
```



---

---
title: "[ARC045B] ドキドキデート大作戦高橋君"
layout: "post"
diff: 普及/提高-
pid: AT_arc045_b
tag: []
---

# [ARC045B] ドキドキデート大作戦高橋君

## 题目描述

# 高桥君的心跳约会大作战

高桥君在读的学校即将进行一次大扫除。学校中有N个教室，分别编号为 $1,2,3, \dots ,N$ 。这些教室排成了一排。

高桥君的学校中共有含高桥君在内的 $M$ 个学生，需要扫除的连续教室区间（称为扫除区间）有 $M$ 个。但是，还没有决定由哪个学生来负责哪个扫除区间。不同的学生负责不同的扫除区间，每个学生必须打扫被分配到的所有教室。 $1$ 个教室可能被多个扫除区间包含。

高桥君突然发现，大扫除当天他正好与女同学有约会。无论怎么样高桥君都不想毁掉这次约会，所以只能把大扫除翘掉了。但是高桥君很在意自己会不会暴露：高桥君负责的教室中如果有任何教室没有被打扫，高桥君就会暴露。

你的任务是：替高桥君找出就算翘掉扫除也不会暴露的所有扫除区间。

另外，这所学校里的学生们都非常勤奋努力，故假定除高桥君外的所有人都不会缺席大扫除。

## 输入格式

输入按以下标准：
$$ N \space M $$
$$ s_1 \space t_1 $$
$$ s_2 \space t_3 $$
$$ : $$
$$ s_M \space t_M $$

- 第一行为两个整数 $N(1 \leq N \leq 300,000)$ 和 $M(1 \leq M \leq 100,000)$ ，分别表示学校的教室数和学生数。
- 接下来的 $M$ 行，分别给出 $M$ 个扫除区间。这其中的第 $i(1 \leq i \leq M)$ 行给出表示第 $i$ 个扫除区间的整数 $s_i,t_i(1 \leq s_i \leq t_i \leq N)$ 。这表示某个学生需要打扫从 $s_i$ 到 $t_i$ 的所有教室。
- 可能有多个完全相同的区间。
- 任意教室至少被一个扫除区间包含。

## 输出格式

第一行：输出即使翘掉扫除也不会暴露的扫除区间个数 $k$ 。
接下来 $k$ 行，输出这些区间的编号（升序排列）。最后一行的末尾需换行。

## 部分分
对于 $30\%$ 的数据：
- 对于任意的教室 $i(1 \leq i \leq N)$ ，包含这个教室的扫除区间的个数最大为 $2$ 。

## 样例1解释
当高桥君负责第 $2,5$ 个扫除区间时不会暴露。具体来说：
- 当高桥君负责第 $2$ 个扫除区间时，第 $5$ 个扫除区间包含了教室 $5$ 所以不会暴露。
- 当高桥君负责第 $5$ 个扫除区间时，第 $2$ 个扫除区间包含了教室 $5$ ，且第 $3$ 个扫除区间包含了教室 $6$ ，所以不会暴露。

然而，当高桥君负责第 $1,3,4$ 个扫除区间时，会暴露。具体来说：
- 当高桥君负责第 $1$ 个扫除区间时，教室 $1,2,3,4$ 没有被扫除，故暴露了。
- 当高桥君负责第 $3$ 个扫除区间时，教室 $7,8$ 没有被扫除，故暴露了。
- 当高桥君负责第 $4$ 个扫除区间时，教室 $9,10$ 没有被扫除，故暴露了。

（个人认为第 $2,3$ 个样例解释是没有必要的）

## 样例 #1

### 输入

```
10 5

1 4

5 5

6 8

9 10

5 6
```

### 输出

```
2

2

5
```

## 样例 #2

### 输入

```
3 6

1 1

1 1

2 2

2 2

3 3

3 3
```

### 输出

```
6

1

2

3

4

5

6
```

## 样例 #3

### 输入

```
10 3

1 4

2 6

6 10
```

### 输出

```
0
```



---

---
title: "[ARC048B] AtCoderでじゃんけんを"
layout: "post"
diff: 普及/提高-
pid: AT_arc048_b
tag: []
---

# [ARC048B] AtCoderでじゃんけんを

## 题目描述

### 题意翻译

有 $n$ 个人在猜拳，每个人有一个 AtCoder 值 $r_i$，出拳出的是 $h_i$（这里规定 $1$ 是石头，$2$ 是剪刀，$3$ 是布）。

- 如果他们的 AtCoder 值不相等，AtCoder 值高的获胜。
- 如果他们的 AtCoder 值相等，猜拳赢的获胜。
- 否则平局。

现在每个人都与 $n-1$ 个人猜过了拳，求出最后的结果。

## 输入格式

第一行一个整数 $n$。

第二行到第 $n+1$ 行：每行两个整数 $r_i,h_i$。

## 输出格式

输出 $n$ 行，每行按输入顺序输出对应的胜、负、平局。

## 说明/提示

$1 \le n,r_i \le 10^5,h_i \in[1,2,3]$。

## 样例 #1

### 输入

```
6

2 1

2 2

3 2

5 3

2 2

3 3
```

### 输出

```
2 3 0

0 4 1

4 1 0

5 0 0

0 4 1

3 2 0
```

## 样例 #2

### 输入

```
2

1999 3

2000 1
```

### 输出

```
0 1 0

1 0 0
```

## 样例 #3

### 输入

```
8

3200 2

2800 3

2800 2

2700 1

2800 2

3200 1

2700 1

3200 3
```

### 输出

```
6 1 0

2 5 0

3 3 1

0 6 1

3 3 1

6 1 0

0 6 1

6 1 0
```



---

---
title: "[ARC053B] 回文分割"
layout: "post"
diff: 普及/提高-
pid: AT_arc053_b
tag: []
---

# [ARC053B] 回文分割

## 题目描述

[problemUrl]: https://atcoder.jp/contests/arc053/tasks/arc053_b





---

---
title: "[ARC054A] 動く歩道"
layout: "post"
diff: 普及/提高-
pid: AT_arc054_a
tag: []
---

# [ARC054A] 動く歩道

## 题目描述

[problemUrl]: https://atcoder.jp/contests/arc054/tasks/arc054_a

高梁空港には、周長 $ L $ の円形の動く歩道があり、その床面は $ 1 $ 秒間に距離 $ X $ 進む速度で時計回りに動いています。 動く歩道のある円周上の点の位置は、その中で最も北にある点から時計回りに測った距離 ( $ 0 $ 以上 $ L $ 未満) であらわされます。 動く歩道の外周の位置 $ D $ の点には出口があり、そこから動く歩道の外に出ることができるようになっています。 それ以外の外周と内周には手すりがあるため、高橋君は出口以外の場所から外に出ることはできません。

高橋君は動く歩道の床面に対して $ 1 $ 秒間に距離 $ Y $ 進む速度で時計回りまたは反時計回りに歩くことができ、動く歩道上の位置 $ S $ の点に乗っています。

高橋君が出口にたどり着くまでにかかる最小の時間を求めてください。

なお、出口の $ 1 $ 箇所しかない動く歩道にわざわざ乗るような物好きな人は高橋君以外にはいないので、動く歩道を逆走しても誰にも迷惑をかけることはありません。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ L $ $ X $ $ Y $ $ S $ $ D $

## 输出格式

高橋君が出口にたどり着くまでにかかる最小の時間を $ 1 $ 行に出力せよ。絶対誤差あるいは相対誤差が $ 10^{-6} $ 以下のとき正答と認められる。

出力の最後には改行を忘れないこと。

## 说明/提示

### 制約

- $ 1\ ≦\ L,X,Y\ ≦\ 10^9,\ 0\ ≦\ S,D\ ≦\ L-1 $
- 入力はすべて整数である。

### Sample Explanation 1

時計回りに歩き続けると $ 0.8 $ 秒で出口にたどり着くことができます。

### Sample Explanation 2

反時計回りに歩き続けると $ 0.25 $ 秒で出口にたどり着くことができます。

## 样例 #1

### 输入

```
6 2 3 1 5
```

### 输出

```
0.8000000000
```

## 样例 #2

### 输入

```
6 2 10 1 5
```

### 输出

```
0.2500000000
```

## 样例 #3

### 输入

```
6 3 1 5 3
```

### 输出

```
1.0000000000
```

## 样例 #4

### 输入

```
10 7 7 6 0
```

### 输出

```
0.2857142857
```



---

---
title: "[ARC054B] ムーアの法則"
layout: "post"
diff: 普及/提高-
pid: AT_arc054_b
tag: []
---

# [ARC054B] ムーアの法則

## 题目描述

原题网址:[link](https://atcoder.jp/contests/arc054/tasks/arc054_b)



高橋君对塔卡哈什曼函数感兴趣。高桥君想计算$T（334）$的值（$T$表示塔卡哈什曼函数[译者注:可能是暗示了哈克曼函数:`Ackermann`，可能是解题方法的暗示]），但由于现代计算机需要$P$年，所以很难计算。

高橋君几乎放弃了一半的计算，知道了世界上有摩尔法则这个法则。根据摩尔法则，我们发现计算机的速度是每$1.5$年翻倍的速度，呈指数增长。

更准确地说，$x$年后计算机的速度将是现代的$2^{x/1.5}$倍。

高桥君想通过在适当的时机开始计算，并尽快结束$T（334）$的计算。当然，因为在计算过程中不能改变计算机，所以计算结束之前的时间是（开始计算之前的时间）+（开始计算时的计算机计算$T（334）$所需的时间）。

请计算结束前的最短时间$m$。

## 输入格式

输入$P$，即计算机计算时间。

## 输出格式

输出$m$，即结束前的最短时间。  
输出最后一行可以换行。

## 说明/提示

- $0<P\leqslant10^{18}$  
- $P$是实数，保留小数点后$4$位输出。

## 样例 #1

### 输入

```
3.0000
```

### 输出

```
2.8708930019
```

## 样例 #2

### 输入

```
0.0400
```

### 输出

```
0.0400000000
```

## 样例 #3

### 输入

```
1000000000000000000.0000
```

### 输出

```
90.1855078128
```



---

---
title: "[ARC059D] アンバランス"
layout: "post"
diff: 普及/提高-
pid: AT_arc059_b
tag: []
---

# [ARC059D] アンバランス

## 题目描述

[problemUrl]: https://atcoder.jp/contests/arc059/tasks/arc059_b

文字列 $ t $ について、$ t $ の長さが $ 2 $ 以上であり、かつ $ t $ の中の文字のうち過半数が同じ文字であるとき、$ t $ を*アンバランス*であると呼ぶことにします。例えば、`voodoo` や `melee` はアンバランスであり、`noon` や `a` はアンバランスではありません。

小文字のアルファベットからなる文字列 $ s $ が与えられます。$ s $ にアンバランスな (連続する) 部分文字列が存在するか判定してください。存在する場合は、$ s $ の中でそのような部分文字列が存在する位置を一つ示してください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ s $

## 输出格式

$ s $ にアンバランスな部分文字列が存在しない場合は、`-1 -1` と出力せよ。

$ s $ にアンバランスな部分文字列が存在する場合は、そのような部分文字列の一つを $ s_a\ s_{a+1}\ ...\ s_{b} $ $ (1\ ≦\ a\ <\ b\ ≦\ |s|) $ として、`$ a $ $ b $` と出力せよ。そのような部分文字列が複数存在する場合は、いずれも正解とみなされる。

## 说明/提示

### 制約

- $ 2\ ≦\ |s|\ ≦\ 10^5 $
- $ s $ は小文字のアルファベットのみからなる。

### 部分点

- $ 2\ ≦\ |s|\ ≦\ 100 $ を満たすデータセットに正解した場合は、$ 200 $ 点が与えられる。

### Sample Explanation 1

文字列 $ s_2\ s_3\ s_4\ s_5 $ $ = $ `eede` はアンバランスな文字列です。他にもアンバランスな部分文字列は存在し、例えば `2 6` と出力しても正解となります。

### Sample Explanation 2

文字列 `atcoder` はアンバランスな部分文字列を持ちません。

## 样例 #1

### 输入

```
needed
```

### 输出

```
2 5
```

## 样例 #2

### 输入

```
atcoder
```

### 输出

```
-1 -1
```



---

---
title: "[ABC044C] 高橋君とカード"
layout: "post"
diff: 普及/提高-
pid: AT_arc060_a
tag: []
---

# [ABC044C] 高橋君とカード

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc044/tasks/arc060_a

高橋君は、$ N $ 枚のカードを持っています。 $ i\ \,\ (1\ \leq\ i\ \leq\ N) $ 番目のカードには、整数 $ x_i $ が書かれています。 高橋君は、これらのカードの中から $ 1 $ 枚以上を選び、 選んだカードに書かれた整数の平均をちょうど $ A $ にしたいと考えています。 そのようなカードの選び方が何通りあるか求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ A $ $ x_1 $ $ x_2 $ $ ... $ $ x_N $

## 输出格式

書かれた整数の平均がちょうど $ A $ となるようなカードの選び方の総数を出力せよ。

## 说明/提示

### 制約

- $ 1\ \leq\ N\ \leq\ 50 $
- $ 1\ \leq\ A\ \leq\ 50 $
- $ 1\ \leq\ x_i\ \leq\ 50 $
- $ N,\,A,\,x_i $ はいずれも整数である

### 部分点

- $ 1\ \leq\ N\ \leq\ 16 $ を満たすデータセットに正解した場合は、$ 200 $ 点が与えられる。

### Sample Explanation 1

\- 平均が $ 8 $ となるカードの選び方は、以下の $ 5 $ 通りです。 - $ 3 $ 枚目のカードのみを選ぶ。 - $ 1 $ 枚目と $ 2 $ 枚目のカードを選ぶ。 - $ 1 $ 枚目と $ 4 $ 枚目のカードを選ぶ。 - $ 1 $ 枚目、$ 2 $ 枚目および $ 3 $ 枚目のカードを選ぶ。 - $ 1 $ 枚目、$ 3 $ 枚目および $ 4 $ 枚目のカードを選ぶ。

### Sample Explanation 4

\- 答えは $ 32 $ ビット整数型に収まらない場合があります。

## 样例 #1

### 输入

```
4 8

7 9 8 9
```

### 输出

```
5
```

## 样例 #2

### 输入

```
3 8

6 6 9
```

### 输出

```
0
```

## 样例 #3

### 输入

```
8 5

3 6 2 8 7 6 5 9
```

### 输出

```
19
```

## 样例 #4

### 输入

```
33 3

3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3
```

### 输出

```
8589934591
```



---

---
title: "[ABC045C] たくさんの数式"
layout: "post"
diff: 普及/提高-
pid: AT_arc061_a
tag: []
---

# [ABC045C] たくさんの数式

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc045/tasks/arc061_a

`1` 以上 `9` 以下の数字のみからなる文字列 $ S $ が与えられます。 この文字列の中で、あなたはこれら文字と文字の間のうち、いくつかの場所に `+` を入れることができます。 一つも入れなくてもかまいません。 ただし、`+` が連続してはいけません。

このようにして出来る全ての文字列を数式とみなし、和を計算することができます。

ありうる全ての数式の値を計算し、その合計を出力してください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ S $

## 输出格式

ありうる全ての数式の値の総和を $ 1 $ 行に出力せよ。

## 说明/提示

### 制約

- $ 1\ \leq\ &#124;S&#124;\ \leq\ 10 $
- $ S $ に含まれる文字は全て `1` 〜 `9` の数字

### Sample Explanation 1

考えられる数式としては、 `125`、`1+25`、`12+5`、`1+2+5` の $ 4 $ 通りがあります。それぞれの数式を計算すると、 - $ 125 $ - $ 1+25=26 $ - $ 12+5=17 $ - $ 1+2+5=8 $ となり、これらの総和は $ 125+26+17+8=176 $ となります。

## 样例 #1

### 输入

```
125
```

### 输出

```
176
```

## 样例 #2

### 输入

```
9999999999
```

### 输出

```
12656242944
```



---

---
title: "[ABC048C] Boxes and Candies"
layout: "post"
diff: 普及/提高-
pid: AT_arc064_a
tag: []
---

# [ABC048C] Boxes and Candies

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc048/tasks/arc064_a

$ N $ 個の箱が横一列に並んでいます。 最初、左から $ i $ 番目の箱には $ a_i $ 個のキャンディが入っています。

すぬけ君は次の操作を好きな回数だけ行うことができます。

- キャンディが $ 1 $ 個以上入っている箱をひとつ選び、その箱のキャンディを $ 1 $ 個食べる。

すぬけ君の目標は次の通りです。

- どの隣り合う $ 2 $ つの箱を見ても、それらの箱に入っているキャンディの個数の総和が $ x $ 以下である。

目標を達成するために必要な操作回数の最小値を求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ x $ $ a_1 $ $ a_2 $ $ ... $ $ a_N $

## 输出格式

目標を達成するために必要な操作回数の最小値を出力せよ。

## 说明/提示

### 制約

- $ 2\ <\ =\ N\ <\ =\ 10^5 $
- $ 0\ <\ =\ a_i\ <\ =\ 10^9 $
- $ 0\ <\ =\ x\ <\ =\ 10^9 $

### Sample Explanation 1

$ 2 $ 番目の箱のキャンディを $ 1 $ 個食べればよいです。 すると、各箱のキャンディの個数は $ (2,\ 1,\ 2) $ となります。

### Sample Explanation 2

たとえば、$ 2 $ 番目の箱のキャンディを $ 6 $ 個食べ、$ 4 $ 番目の箱のキャンディを $ 2 $ 個食べ、$ 6 $ 番目の箱のキャンディを $ 3 $ 個食べればよいです。 すると、各箱キャンディの個数は $ (1,\ 0,\ 1,\ 0,\ 0,\ 1) $ となります。

### Sample Explanation 3

最初から目標が達成されているので、操作を行う必要はありません。

### Sample Explanation 4

すべてのキャンディを食べなければなりません。

## 样例 #1

### 输入

```
3 3

2 2 2
```

### 输出

```
1
```

## 样例 #2

### 输入

```
6 1

1 6 1 2 0 4
```

### 输出

```
11
```

## 样例 #3

### 输入

```
5 9

3 1 4 1 5
```

### 输出

```
0
```

## 样例 #4

### 输入

```
2 0

5 5
```

### 输出

```
10
```



---

---
title: "[ABC049C] 白昼夢"
layout: "post"
diff: 普及/提高-
pid: AT_arc065_a
tag: []
---

# [ABC049C] 白昼夢

## 题目描述

# 题目大意
输入一个以英文小写字母组成的字符串S，规定一个空的字符串T，现在你可对字符串T进行你喜欢的操作，问是否能让字符串T变为字符串S？

**喜欢的操作如下 ：**

在字符串T的末尾加入
“dream”或“dreamer”或“erase”或“eraser”。

------------

## 输入格式

一个字符串S

## 输出格式

若可以输出**YES**,否则输出**NO**。

## 样例 #1

### 输入

```
erasedream
```

### 输出

```
YES
```

## 样例 #2

### 输入

```
dreameraser
```

### 输出

```
YES
```

## 样例 #3

### 输入

```
dreamerer
```

### 输出

```
NO
```



---

---
title: "[ABC049D] 連結"
layout: "post"
diff: 普及/提高-
pid: AT_arc065_b
tag: []
---

# [ABC049D] 連結

## 题目描述

有$N$个城市，$K$条道路（指地面上的道路）和$L$条地铁。道路和地铁都是无向的。对于每个点，请你求出它只通过道路**和**只通过地铁都能到达的点的个数。道路和地铁之间不能换乘，你只能**完全**通过地铁到达某个点，或者**完全**通过道路到达某个点。

## 输入格式

第一行三个正整数$N,K,L$
($N\le2\times 10^5,K,L\le10^5$)  
然后$K$行，每行两个数$p,q$，表示城市$p$和城市$q$通过道路连接。   
然后$L$行，每行两个数$r,s$，表示城市$r$和城市$s$通过地铁连接。

## 输出格式

一行$N$个正整数，表示每个点只通过道路和只通过地铁都能到达的点的个数。

## 样例 #1

### 输入

```
4 3 1

1 2

2 3

3 4

2 3
```

### 输出

```
1 2 2 1
```

## 样例 #2

### 输入

```
4 2 2

1 2

2 3

1 4

2 3
```

### 输出

```
1 2 2 1
```

## 样例 #3

### 输入

```
7 4 4

1 2

2 3

2 5

6 7

3 5

4 5

3 4

6 7
```

### 输出

```
1 1 2 1 2 2 2
```



---

---
title: "[ABC050C] Lining Up"
layout: "post"
diff: 普及/提高-
pid: AT_arc066_a
tag: []
---

# [ABC050C] Lining Up

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc050/tasks/arc066_a

$ 1～N $ までの番号がついた、$ N $ 人の人がいます。 彼らは昨日、ある順番で左右一列に並んでいましたが、今日になってその並び方が分からなくなってしまいました。 しかし、彼らは全員、「自分の左に並んでいた人数と自分の右に並んでいた人数の差の絶対値」を覚えています。 彼らの報告によると、人 $ i $ の、「自分の左に並んでいた人数と自分の右に並んでいた人数の差の絶対値」は $ A_i $ です。

彼らの報告を元に、元の並び方が何通りあり得るかを求めてください。 ただし、答えは非常に大きくなることがあるので、$ 10^9+7 $ で割った余りを出力してください。 また、彼らの報告が間違っており、ありうる並び方がないこともありえます。 その際は $ 0 $ を出力してください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ A_1 $ $ A_2 $ $ ... $ $ A_N $

## 输出格式

元の並び順としてありうるものが何通りあるか求め、$ 10^9+7 $ で割った余りを出力せよ。

## 说明/提示

### 制約

- $ 1≦N≦10^5 $
- $ 0≦A_i≦N-1 $

### Sample Explanation 1

ありうる並び方は、人の番号で書くと、 - $ 2,1,4,5,3 $ - $ 2,5,4,1,3 $ - $ 3,1,4,5,2 $ - $ 3,5,4,1,2 $ の $ 4 $ 通りです。

### Sample Explanation 2

どのような並び方でも、報告と矛盾するので、$ 0 $ が答えになります。

## 样例 #1

### 输入

```
5

2 4 4 0 2
```

### 输出

```
4
```

## 样例 #2

### 输入

```
7

6 4 0 2 4 0 2
```

### 输出

```
0
```

## 样例 #3

### 输入

```
8

7 5 1 1 7 3 5 3
```

### 输出

```
16
```



---

---
title: "[ABC052D] Walk and Teleport"
layout: "post"
diff: 普及/提高-
pid: AT_arc067_b
tag: []
---

# [ABC052D] Walk and Teleport

## 题目描述

在东西方向延伸的直线上，有N个城市。城市坐标按从西到东递增。

你现在在某个城市里，想去其他所有的城市。移动的方法有以下两种。

一，在直线上按东西方向平移，每移动一个单位距离疲劳值加A

二，直接瞬移到某个坐标，并且疲劳值加B

请使用以上两种方式直到去完其他所有的城市，并求出最小的疲劳值。

## 输入格式

第一行三个数,即N,A,B,

第二行N个数，即X[1],X[2]...,X[N]。

## 输出格式

输出最小的疲劳值。

## 说明/提示

2<=N<=1e5

1<=Xi,A,B<=1e9且X(i)<X(i+1)

## 样例 #1

### 输入

```
4 2 5

1 2 5 7
```

### 输出

```
11
```

## 样例 #2

### 输入

```
7 1 100

40 43 45 105 108 115 124
```

### 输出

```
84
```

## 样例 #3

### 输入

```
7 1 2

24 35 40 68 72 99 103
```

### 输出

```
12
```



---

---
title: "[ABC058D] 井井井"
layout: "post"
diff: 普及/提高-
pid: AT_arc071_b
tag: []
---

# [ABC058D] 井井井

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc058/tasks/arc071_b

$ 2 $ 次元平面上に $ x $ 軸と平行な直線が $ m $ 本と $ y $ 軸と平行な直線が $ n $ 本引いてあります。 $ x $ 軸と平行な直線のうち下から $ i $ 番目は $ y\ =\ y_i $ で表せます。 $ y $ 軸と平行な直線のうち左から $ i $ 番目は $ x\ =\ x_i $ で表せます。

この中に存在しているすべての長方形についてその面積を求め、 合計を $ 10^9+7 $ で割ったあまりを出力してください。

つまり、$ 1\leq\ i\ <\ j\leq\ n $ と $ 1\leq\ k\ <\ l\leq\ m $ を満たすすべての組 $ (i,j,k,l) $ について、  直線 $ x=x_i $, $ x=x_j $, $ y=y_k $, $ y=y_l $ で囲まれる 長方形の面積を求め、合計を $ 10^9+7 $ で割ったあまりを出力してください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ n $ $ m $ $ x_1 $ $ x_2 $ $ ... $ $ x_n $ $ y_1 $ $ y_2 $ $ ... $ $ y_m $

## 输出格式

長方形の面積の合計を $ 10^9+7 $ で割ったあまりを $ 1 $ 行に出力せよ。

## 说明/提示

### 制約

- $ 2\ \leq\ n,m\ \leq\ 10^5 $
- $ -10^9\ \leq\ x_1\ <\ ...\ <\ x_n\ \leq\ 10^9 $
- $ -10^9\ \leq\ y_1\ <\ ...\ <\ y_m\ \leq\ 10^9 $
- $ x_i,\ y_i $ は整数である。

### Sample Explanation 1

この入力を図にすると、以下のようになります。 !\[sample1-1\](https://atcoder.jp/img/arc071/aec4d5cc2e5c73dbee455be237a649a5.png) 長方形 A,B,...,I それぞれの面積を合計すると $ 60 $ になります。 !\[sample1-2\](https://atcoder.jp/img/arc071/f0771c0f7e68af2b00e7513186f585ff.png)

## 样例 #1

### 输入

```
3 3

1 3 4

1 3 6
```

### 输出

```
60
```

## 样例 #2

### 输入

```
6 5

-790013317 -192321079 95834122 418379342 586260100 802780784

-253230108 193944314 363756450 712662868 735867677
```

### 输出

```
835067060
```



---

---
title: "[ARC071E] TrBBnsformBBtion"
layout: "post"
diff: 普及/提高-
pid: AT_arc071_c
tag: []
---

# [ARC071E] TrBBnsformBBtion

## 题目描述

考虑对一个只含 `A`，`B` 的字符串的如下操作：

1. 将一个 `A` 替换成 `BB`，或将一个 `B` 替换成 `AA`

2. 将三个连续相同的字符（`AAA` 或 `BBB`）消掉

例如说，串 `ABA` 可以通过第一个操作变成 `BBBA`，串 `BBBAAAA` 可以通过第二个操作变成 `BBBA`.

这些操作可以以任意顺序，不限次数地进行。

给出两个串 $S$ 和 $T$，以及 $q$ 次询问 $a_i, b_i, c_i, d_i$，每次询问你需要回答 $S_{a_i...b_i}$ 这一子串是否能通过这两个操作变成 $T_{c_i...d_i}$.

## 输入格式

将从标准输入输出输入以下格式：
```
$ S $ 
$ T $ 
$ q $ 
$ a_1 $   $ b_1 $   $ c_1 $   $ d_1 $ 
$ ... $ 
$ a_q $   $ b_q $   $ c_q $   $ d_q $ 
```

## 输出格式

输出 $q$ 行，每行包含一个询问的答案。若第 $i$ 个询问 $S_{a_i...b_i}$ 这一子串能通过这两个操作变成 $T_{c_i...d_i}$，则输出 `YES`，否则输出 `NO`.

## 样例 #1

### 输入

```
BBBAAAABA

BBBBA

4

7 9 2 5

7 9 1 4

1 7 2 5

1 7 2 4
```

### 输出

```
YES

NO

YES

NO
```

## 样例 #2

### 输入

```
AAAAABBBBAAABBBBAAAA

BBBBAAABBBBBBAAAAABB

10

2 15 2 13

2 13 6 16

1 13 2 20

4 20 3 20

1 18 9 19

2 14 1 11

3 20 3 15

6 16 1 17

4 18 8 20

7 20 3 14
```

### 输出

```
YES

YES

YES

YES

YES

YES

NO

NO

NO

NO
```



---

---
title: "[ABC060D] Simple Knapsack"
layout: "post"
diff: 普及/提高-
pid: AT_arc073_b
tag: []
---

# [ABC060D] Simple Knapsack

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc060/tasks/arc073_b

あなたは $ N $ 個の物と、強度 $ W $ のバッグを持っています。 $ i $ 個目の物は、重さが $ w_i $ で価値が $ v_i $ です。

あなたは、物のうちいくつかを選び、バッグに入れます。 ただし、選んだ物の重さの和は $ W $ 以下でなくてはいけません。

あなたは、バッグに入れた物の価値の総和を最大化したいです。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ W $ $ w_1 $ $ v_1 $ $ w_2 $ $ v_2 $ : $ w_N $ $ v_N $

## 输出格式

価値の総和の最大値を出力する。

## 说明/提示

### 制約

- $ 1\ ≦\ N\ ≦\ 100 $
- $ 1\ ≦\ W\ ≦\ 10^9 $
- $ 1\ ≦\ w_i\ ≦\ 10^9 $
- すべての $ i\ =\ 2,3,...,N $ について、$ w_1\ ≦\ w_i\ ≦\ w_1\ +\ 3 $
- $ 1\ ≦\ v_i\ ≦\ 10^7 $
- $ W,\ w_i,\ v_i $ はすべて整数である

### Sample Explanation 1

$ 1,\ 3 $ 個目の物を選ぶと良いです。

### Sample Explanation 2

$ 2,\ 4 $ 個目の物を選ぶと良いです。

### Sample Explanation 3

すべての物が選べます。

### Sample Explanation 4

$ 1 $ 個も物が選べません。

## 样例 #1

### 输入

```
4 6

2 1

3 4

4 10

3 4
```

### 输出

```
11
```

## 样例 #2

### 输入

```
4 6

2 1

3 7

4 10

3 6
```

### 输出

```
13
```

## 样例 #3

### 输入

```
4 10

1 100

1 100

1 100

1 100
```

### 输出

```
400
```

## 样例 #4

### 输入

```
4 1

10 100

10 100

10 100

10 100
```

### 输出

```
0
```



---

---
title: "[ABC062C] Chocolate Bar"
layout: "post"
diff: 普及/提高-
pid: AT_arc074_a
tag: []
---

# [ABC062C] Chocolate Bar

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc062/tasks/arc074_a

縦 $ H $ ブロック、横 $ W $ ブロックの板チョコがあります。 すぬけ君は、この板チョコをちょうど $ 3 $ つのピースに分割しようとしています。 ただし、各ピースはブロックの境目に沿った長方形でなければなりません。

すぬけ君は、$ 3 $ つのピースの面積 (ブロック数) をできるだけ均等にしようとしています。 具体的には、$ 3 $ つのピースの面積の最大値を $ S_{max} $、最小値を $ S_{min} $ としたとき、$ S_{max}\ -\ S_{min} $ を最小化しようとしています。 $ S_{max}\ -\ S_{min} $ の最小値を求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ H $ $ W $

## 输出格式

$ S_{max}\ -\ S_{min} $ の最小値を出力せよ。

## 说明/提示

### 制約

- $ 2\ <\ =\ H,\ W\ <\ =\ 10^5 $

### Sample Explanation 1

次図のように分割すると、$ S_{max}\ -\ S_{min}\ =\ 5\ -\ 5\ =\ 0 $ となります。 !\[2a9b2ef47b750c0b7ba3e865d4fb4203.png\](https://atcoder.jp/img/arc074/2a9b2ef47b750c0b7ba3e865d4fb4203.png)

### Sample Explanation 2

次図のように分割すると、$ S_{max}\ -\ S_{min}\ =\ 8\ -\ 6\ =\ 2 $ となります。 !\[a42aae7aaaadc4640ac5cdf88684d913.png\](https://atcoder.jp/img/arc074/a42aae7aaaadc4640ac5cdf88684d913.png)

### Sample Explanation 3

次図のように分割すると、$ S_{max}\ -\ S_{min}\ =\ 10\ -\ 6\ =\ 4 $ となります。 !\[eb0ad0cb3185b7ae418e21c472ff7f26.png\](https://atcoder.jp/img/arc074/eb0ad0cb3185b7ae418e21c472ff7f26.png)

## 样例 #1

### 输入

```
3 5
```

### 输出

```
0
```

## 样例 #2

### 输入

```
4 5
```

### 输出

```
2
```

## 样例 #3

### 输入

```
5 5
```

### 输出

```
4
```

## 样例 #4

### 输入

```
100000 2
```

### 输出

```
1
```

## 样例 #5

### 输入

```
100000 100000
```

### 输出

```
50000
```



---

---
title: "[ABC062D] 3N Numbers"
layout: "post"
diff: 普及/提高-
pid: AT_arc074_b
tag: []
---

# [ABC062D] 3N Numbers

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc062/tasks/arc074_b

$ N $ を $ 1 $ 以上の整数とします。

長さ $ 3N $ の数列 $ a\ =\ (a_1,\ a_2,\ ...,\ a_{3N}) $ があります。 すぬけ君は、$ a $ からちょうど $ N $ 個の要素を取り除き、残った $ 2N $ 個の要素を元の順序で並べ、長さ $ 2N $ の数列 $ a' $ を作ろうとしています。 このとき、$ a' $ のスコアを $ (a'\ の前半\ N\ 要素の総和)\ -\ (a'\ の後半\ N\ 要素の総和) $ と定義します。

$ a' $ のスコアの最大値を求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ a_1 $ $ a_2 $ $ ... $ $ a_{3N} $

## 输出格式

$ a' $ のスコアの最大値を出力せよ。

## 说明/提示

### 制約

- $ 1\ <\ =\ N\ <\ =\ 10^5 $
- $ a_i $ は整数である。
- $ 1\ <\ =\ a_i\ <\ =\ 10^9 $

### 部分点

- $ 300 $ 点分のテストケースでは、$ N\ <\ =\ 1,000 $ が成り立つ。

### Sample Explanation 1

$ a_2 $, $ a_6 $ を取り除くと、$ a'\ =\ (3,\ 4,\ 1,\ 5) $ となり、スコアは $ (3\ +\ 4)\ -\ (1\ +\ 5)\ =\ 1 $ となります。

### Sample Explanation 2

例えば、$ a_1 $ を取り除くと、$ a'\ =\ (2,\ 3) $ となり、スコアは $ 2\ -\ 3\ =\ -1 $ となります。

### Sample Explanation 3

例えば、$ a_2 $, $ a_3 $, $ a_9 $ を取り除くと、$ a'\ =\ (8,\ 7,\ 4,\ 6,\ 5,\ 3) $ となり、スコアは $ (8\ +\ 7\ +\ 4)\ -\ (6\ +\ 5\ +\ 3)\ =\ 5 $ となります。

## 样例 #1

### 输入

```
2

3 1 4 1 5 9
```

### 输出

```
1
```

## 样例 #2

### 输入

```
1

1 2 3
```

### 输出

```
-1
```

## 样例 #3

### 输入

```
3

8 2 2 7 4 6 5 3 8
```

### 输出

```
5
```



---

---
title: "[ABC065C] Reconciled?"
layout: "post"
diff: 普及/提高-
pid: AT_arc076_a
tag: []
---

# [ABC065C] Reconciled?

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc065/tasks/arc076_a

すぬけ君は、犬を $ N $ 匹と猿を $ M $ 匹飼っています。すぬけ君は、この $ N+M $ 匹を一列に並べようと思っています。

文字通り犬猿の仲の犬たちと猿たちを仲直りさせたいすぬけ君は、犬同士、または猿同士が隣り合うところができないように並べようと思っています。

このような並べ方は何通りあるでしょうか。犬と猿は $ 10^9+7 $ 以上の数を理解できないので、並べ方の個数を $ 10^9+7 $ で割ったあまりを求めてください。 ただし、犬同士、また猿同士は互いに区別します。また、左右が反転しただけの列も異なる列とみなします。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ M $

## 输出格式

並べ方の個数を $ 10^9+7 $ で割ったあまりを出力せよ。

## 说明/提示

### 制約

- $ 1\ ≦\ N,M\ ≦\ 10^5 $

### Sample Explanation 1

犬をそれぞれ `A`,`B` とし、猿をそれぞれ `C`,`D` とすると、`ACBD`,`ADBC`,`BCAD`,`BDAC`,`CADB`,`CBDA`,`DACB`,`DBCA` の $ 8 $ 通りの並べ方があります。

## 样例 #1

### 输入

```
2 2
```

### 输出

```
8
```

## 样例 #2

### 输入

```
3 2
```

### 输出

```
12
```

## 样例 #3

### 输入

```
1 8
```

### 输出

```
0
```

## 样例 #4

### 输入

```
100000 100000
```

### 输出

```
530123477
```



---

---
title: "[ABC069D] Grid Coloring"
layout: "post"
diff: 普及/提高-
pid: AT_arc080_b
tag: []
---

# [ABC069D] Grid Coloring

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc069/tasks/arc080_b

縦 $ H $ 行、横 $ W $ 列のマス目があります。 すぬけ君は、このマス目を色 $ 1 $, $ 2 $, $ ... $, $ N $ で塗り分けようとしています。 このとき、次の条件が成り立つようにします。

- 各 $ i $ ($ 1\ <\ =\ i\ <\ =\ N $) について、色 $ i $ のマスはちょうど $ a_i $ 個存在する。 ただし、$ a_1\ +\ a_2\ +\ ...\ +\ a_N\ =\ H\ W $ である。
- 各 $ i $ ($ 1\ <\ =\ i\ <\ =\ N $) について、色 $ i $ のマスは上下左右に連結である。 すなわち、どの色 $ i $ のマスからどの色 $ i $ のマスへも、上下左右に隣り合う色 $ i $ のマスのみを辿って行き来できる。

条件を満たす塗り分け方をひとつ求めてください。 解は必ず存在することが示せます。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ H $ $ W $ $ N $ $ a_1 $ $ a_2 $ $ ... $ $ a_N $

## 输出格式

条件を満たす塗り分け方をひとつ出力せよ。 塗り分け方は次のフォーマットで出力せよ。 ただし、$ c_{i\ j} $ は、上から $ i $ 行目、左から $ j $ 列目のマスの色である。

> $ c_{1\ 1} $ $ ... $ $ c_{1\ W} $ $ : $ $ c_{H\ 1} $ $ ... $ $ c_{H\ W} $

## 说明/提示

### 制約

- $ 1\ <\ =\ H,\ W\ <\ =\ 100 $
- $ 1\ <\ =\ N\ <\ =\ H\ W $
- $ a_i\ >\ =\ 1 $
- $ a_1\ +\ a_2\ +\ ...\ +\ a_N\ =\ H\ W $

### Sample Explanation 1

例えば、次の塗り分け方は条件を満たしません。 色 $ 1 $ のマスが上下左右に連結でないからです。 ``` 1 2 3 1 ```

## 样例 #1

### 输入

```
2 2

3

2 1 1
```

### 输出

```
1 1

2 3
```

## 样例 #2

### 输入

```
3 5

5

1 2 3 4 5
```

### 输出

```
1 4 4 4 3

2 5 4 5 3

2 5 5 5 3
```

## 样例 #3

### 输入

```
1 1

1

1
```

### 输出

```
1
```



---

---
title: "[ABC071D] Coloring Dominoes"
layout: "post"
diff: 普及/提高-
pid: AT_arc081_b
tag: []
---

# [ABC071D] Coloring Dominoes

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc071/tasks/arc081_b

$ 2\ \times\ N $ のマス目があります． すぬけ君は，このマス目に $ N $ 個のドミノを，重ならないように敷き詰めました． ここで，ドミノは，$ 1\ \times\ 2 $ または $ 2\ \times\ 1 $ のマス目を覆うことができます．

すぬけ君は，赤色，水色，緑色の $ 3 $ 色を使って，これらのドミノを塗ることにしました． このとき，辺で接しているドミノは異なる色で塗るようにします． ここで，必ずしも $ 3 $ 色すべてを使う必要はありません．

このような塗り方が何通りあるかを mod $ 1000000007 $ で求めてください．

ただし，ドミノの敷き詰め方は，文字列 $ S_1,\ S_2 $ を用いて，次のようにして与えられます．

- 各ドミノは，それぞれ異なる英小文字または英大文字で表される．
- $ S_i $ の $ j $ 文字目は，マス目の上から $ i $ 番目，左から $ j $ 番目のマスにどのドミノがあるかを表す．

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ S_1 $ $ S_2 $

## 输出格式

ドミノを塗る方法の数を mod $ 1000000007 $ で出力せよ．

## 说明/提示

### 制約

- $ 1\ \leq\ N\ \leq\ 52 $
- $ |S_1|\ =\ |S_2|\ =\ N $
- $ S_1,\ S_2 $ は英小文字または英大文字からなる
- $ S_1,\ S_2 $ は正しいドミノの敷き詰め方を表している

### Sample Explanation 1

次の $ 6 $ 通りあります． !\[\](https://atcoder.jp/img/arc081/899673bd23529f4fb5e41c6e7d5bc372.png)

### Sample Explanation 2

必ずしもすべての色を使わなくてもよいことに注意してください．

## 样例 #1

### 输入

```
3

aab

ccb
```

### 输出

```
6
```

## 样例 #2

### 输入

```
1

Z

Z
```

### 输出

```
3
```

## 样例 #3

### 输入

```
52

RvvttdWIyyPPQFFZZssffEEkkaSSDKqcibbeYrhAljCCGGJppHHn

RLLwwdWIxxNNQUUXXVVMMooBBaggDKqcimmeYrhAljOOTTJuuzzn
```

### 输出

```
958681902
```



---

---
title: "[ABC074C] Sugar Water"
layout: "post"
diff: 普及/提高-
pid: AT_arc083_a
tag: []
---

# [ABC074C] Sugar Water

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc074/tasks/arc083_a

すぬけ君はビーカーに砂糖水を作ろうとしています。 最初ビーカーは空です。すぬけ君は以下の $ 4 $ 種類の操作をそれぞれ何回でも行うことができます。一度も行わない操作があっても構いません。

- 操作 1: ビーカーに水を $ 100A $ \[g\] 入れる。
- 操作 2: ビーカーに水を $ 100B $ \[g\] 入れる。
- 操作 3: ビーカーに砂糖を $ C $ \[g\] 入れる。
- 操作 4: ビーカーに砂糖を $ D $ \[g\] 入れる。

すぬけ君の実験環境下では、水 $ 100 $ \[g\] あたり砂糖は $ E $ \[g\] 溶けます。

すぬけ君はできるだけ濃度の高い砂糖水を作りたいと考えています。

ビーカーに入れられる物質の質量 (水の質量と砂糖の質量の合計) が $ F $ \[g\] 以下であり、 ビーカーの中に砂糖を溶け残らせてはいけないとき、 すぬけ君が作る砂糖水の質量と、それに溶けている砂糖の質量を求めてください。 答えが複数ある場合はどれを答えても構いません。

水 $ a $ \[g\] と砂糖 $ b $ \[g\] を混ぜた砂糖水の濃度は $ \frac{100b}{a\ +\ b} $ \[%\]です。 また、この問題では、砂糖が全く溶けていない水も濃度 $ 0 $ \[%\] の砂糖水と考えることにします。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ A $ $ B $ $ C $ $ D $ $ E $ $ F $

## 输出格式

整数を空白区切りで $ 2 $ つ出力せよ。 $ 1 $ つ目は求める砂糖水の質量、$ 2 $ つ目はそれに溶けている砂糖の質量とせよ。

## 说明/提示

### 制約

- $ 1\ ≦\ A\ <\ B\ ≦\ 30 $
- $ 1\ ≦\ C\ <\ D\ ≦\ 30 $
- $ 1≦\ E\ ≦\ 100 $
- $ 100A\ ≦\ F\ ≦\ 3,000 $
- $ A,\ B,\ C,\ D,\ E,\ F $ はすべて整数である。

### Sample Explanation 1

この入力例の状況では、水 $ 100 $ \\\[g\\\] あたり砂糖は $ 15 $ \\\[g\\\] 溶けます。 また、ビーカーに物質を $ 200 $ \\\[g\\\] まで入れることができます。 操作 1 と操作 3 を $ 1 $ 回ずつ行うことで $ 110 $ \\\[g\\\] の砂糖水を作ることができます。 また、これ以上濃度の高い砂糖水を作ることはできません。 たとえば、以下のような操作は条件を満たしません。 - 操作 1 と操作 4 を $ 1 $ 回ずつ行うと、ビーカーに砂糖が溶け残ってしまいます。 - 操作 2 を $ 1 $ 回と操作 3 を $ 3 $ 回行うと、ビーカーの中の物質の量が $ 200 $ \\\[g\\\] を超えてしまいます。

### Sample Explanation 2

ほかに、たとえば以下の出力も正解となります。 ``` 400 200 ``` 一方、以下の出力は不正解となります。 ``` 300 150 ``` なぜなら、砂糖が $ 150 $ \\\[g\\\] 溶けた $ 300 $ \\\[g\\\] の砂糖水を作るにはビーカーに水をちょうど $ 150 $ \\\[g\\\] 入れる必要がありますが、そのようなことは不可能だからです。

## 样例 #1

### 输入

```
1 2 10 20 15 200
```

### 输出

```
110 10
```

## 样例 #2

### 输入

```
1 2 1 2 100 1000
```

### 输出

```
200 100
```

## 样例 #3

### 输入

```
17 19 22 26 55 2802
```

### 输出

```
2634 934
```



---

---
title: "[ABC078D] ABS"
layout: "post"
diff: 普及/提高-
pid: AT_arc085_b
tag: []
---

# [ABC078D] ABS

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc078/tasks/arc085_b

$ N $ 枚のカードからなる山札があります。カードにはそれぞれ数が書かれており， 上から $ i $ 枚目には $ a_i $ が書かれています。

この山札を使い，X さんと Y さんが $ 2 $ 人でゲームをします。 X, Y さんは最初，$ Z,\ W $ が書かれたカードを持っています。 そして X さんから交互に以下を行います。

- 山札から何枚かカードを引く。そして今持っているカードを捨て，最後に引いたカードを代わりに持つ。ただし，必ず $ 1 $ 枚は引かなくてはならない。

山札がなくなるとゲームは終了で，$ 2 $ 人の持っているカードに書かれた数の差の絶対値がこのゲームのスコアになります。

X さんはスコアを最大化するように，Y さんはスコアを最小化するようにゲームをプレイした時， スコアはいくつになるでしょうか？

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ Z $ $ W $ $ a_1 $ $ a_2 $ $ ... $ $ a_N $

## 输出格式

求めたスコアを出力してください。

## 说明/提示

### 制約

- 入力は全て整数
- $ 1\ \leq\ N\ \leq\ 2000 $
- $ 1\ \leq\ Z,\ W,\ a_i\ \leq\ 10^9 $

### Sample Explanation 1

X さんが最初に $ 2 $ 枚カードを引くと，次に Y さんが最後のカードを引き，スコアは $ |1000\ -\ 100|\ =\ 900 $ になります。

### Sample Explanation 2

X さんが最初に全てのカードを引くと，スコアは $ |100\ -\ 1000|\ =\ 900 $ になります。

## 样例 #1

### 输入

```
3 100 100

10 1000 100
```

### 输出

```
900
```

## 样例 #2

### 输入

```
3 100 1000

10 100 100
```

### 输出

```
900
```

## 样例 #3

### 输入

```
5 1 1

1 1 1 1 1
```

### 输出

```
0
```

## 样例 #4

### 输入

```
1 1 1

1000000000
```

### 输出

```
999999999
```



---

---
title: "[ABC083D] Wide Flip"
layout: "post"
diff: 普及/提高-
pid: AT_arc088_b
tag: []
---

# [ABC083D] Wide Flip

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc083/tasks/arc088_b

`0` と `1` からなる文字列 $ S $ が与えられます。 以下の操作を好きな回数繰り返すことで $ S $ の要素をすべて `0` にできるような、$ |S| $ 以下の最大の整数 $ K $ を求めてください。

- $ S $ の長さ $ K $ 以上の連続する区間 $ [l,r] $ を選ぶ(すなわち、$ r-l+1\geq\ K $ が満たされる必要がある)。$ l\leq\ i\leq\ r $ なるすべての整数 $ i $ に対し、$ S_i $ が `0` なら $ S_i $ を `1` に、$ S_i $ が `1` なら $ S_i $ を `0` に置き換える。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ S $

## 输出格式

操作を好きな回数繰り返すことで $ S $ の要素をすべて `0` にできるような *最大の* (21:08 JST 修正) 整数 $ K $ を出力せよ。

## 说明/提示

### 制約

- $ 1\leq\ |S|\leq\ 10^5 $
- $ S_i(1\leq\ i\leq\ N) $ は `0` または `1` である

### Sample Explanation 1

以下の操作で、$ S $ の要素をすべて `0` にできます。 - 長さ $ 3 $ の区間 $ [1,3] $ に操作を行う。$ S $ は `101` になる。 - 長さ $ 2 $ の区間 $ [1,2] $ に操作を行う。$ S $ は `011` になる。 - 長さ $ 2 $ の区間 $ [2,3] $ に操作を行う。$ S $ は `000` になる。

## 样例 #1

### 输入

```
010
```

### 输出

```
2
```

## 样例 #2

### 输入

```
100000000
```

### 输出

```
8
```

## 样例 #3

### 输入

```
00001111
```

### 输出

```
4
```



---

---
title: "[ABC090D] Remainder Reminder"
layout: "post"
diff: 普及/提高-
pid: AT_arc091_b
tag: []
---

# [ABC090D] Remainder Reminder

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc090/tasks/arc091_b

高橋君は、$ N $ 以下の正の整数の $ 2 $ つ組 $ (a,b) $ を持っていましたが、忘れてしまいました。 高橋君は、$ a $ を $ b $ で割ったあまりが $ K $ 以上であったことを覚えています。 高橋君が持っていた組としてあるうるものの個数を求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ K $

## 输出格式

高橋君が持っていた組としてあるうるものの個数を出力せよ。

## 说明/提示

### 制約

- $ 1\ \leq\ N\ \leq\ 10^5 $
- $ 0\ \leq\ K\ \leq\ N-1 $
- 入力は全て整数である

### Sample Explanation 1

ありうる組は、$ (2,3),(5,3),(2,4),(3,4),(2,5),(3,5),(4,5) $ の $ 7 $ 組です。

## 样例 #1

### 输入

```
5 2
```

### 输出

```
7
```

## 样例 #2

### 输入

```
10 0
```

### 输出

```
100
```

## 样例 #3

### 输入

```
31415 9265
```

### 输出

```
287927211
```



---

---
title: "[ABC091C] 2D Plane 2N Points"
layout: "post"
diff: 普及/提高-
pid: AT_arc092_a
tag: []
---

# [ABC091C] 2D Plane 2N Points

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc091/tasks/arc092_a

二次元平面に，赤い点と青い点が $ N $ 個ずつあります。 $ i $ 個目の赤い点の座標は $ (a_i,\ b_i) $ で，$ i $ 個目の青い点の座標は $ (c_i,\ d_i) $ です。

赤い点と青い点は，赤い点の $ x $ 座標が青い点の $ x $ 座標より小さく， また赤い点の $ y $ 座標も青い点の $ y $ 座標より小さいとき，仲良しペアになれます。

あなたは最大で何個の仲良しペアを作ることができますか？ ただし，$ 1 $ つの点が複数のペアに所属することはできません。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ a_1 $ $ b_1 $ $ a_2 $ $ b_2 $ $ : $ $ a_N $ $ b_N $ $ c_1 $ $ d_1 $ $ c_2 $ $ d_2 $ $ : $ $ c_N $ $ d_N $

## 输出格式

仲良しペアの個数の最大値を出力せよ。

## 说明/提示

### 制約

- 入力は全て整数
- $ 1\ \leq\ N\ \leq\ 100 $
- $ 0\ \leq\ a_i,\ b_i,\ c_i,\ d_i\ <\ 2N $
- $ a_1,\ a_2,\ ...,\ a_N,\ c_1,\ c_2,\ ...,\ c_N $ はすべて異なる
- $ b_1,\ b_2,\ ...,\ b_N,\ d_1,\ d_2,\ ...,\ d_N $ はすべて異なる

### Sample Explanation 1

例えば， $ (2,\ 0) $ と $ (4,\ 2) $ をペアにし， $ (3,\ 1) $ と $ (5,\ 5) $ をペアにすればよいです。

### Sample Explanation 2

例えば， $ (0,\ 0) $ と $ (2,\ 3) $ をペアにし， $ (1,\ 1) $ と $ (3,\ 4) $ をペアにすればよいです。

### Sample Explanation 3

一つもペアが作れない場合もあります。

## 样例 #1

### 输入

```
3

2 0

3 1

1 3

4 2

0 4

5 5
```

### 输出

```
2
```

## 样例 #2

### 输入

```
3

0 0

1 1

5 2

2 3

3 4

4 5
```

### 输出

```
2
```

## 样例 #3

### 输入

```
2

2 2

3 3

0 0

1 1
```

### 输出

```
0
```

## 样例 #4

### 输入

```
5

0 0

7 3

2 2

4 8

1 6

8 5

6 9

5 4

9 1

3 7
```

### 输出

```
5
```

## 样例 #5

### 输入

```
5

0 0

1 1

5 5

6 6

7 7

2 2

3 3

4 4

8 8

9 9
```

### 输出

```
4
```



---

---
title: "[ABC094D] Binomial Coefficients"
layout: "post"
diff: 普及/提高-
pid: AT_arc095_b
tag: []
---

# [ABC094D] Binomial Coefficients

## 题目描述

从 $n$ 个物品中不考虑顺序地选出 $r$ 个的情况数记为 ${\rm comb}(n, r)$。请从 $n$ 个非负整数 $a _ 1, a _ 2, \ldots, a _ n$ 中选择 $2$ 个数 $a _ i > a _ j$，使得 ${\rm comb}(a _ i, a _ j)$ 最大化。如果有多个组合可以达到最大值，可以选择任意一个。

## 输入格式

输入以以下格式从标准输入中提供：

> $n$  
> $a _ 1$ $a _ 2$ $\ldots$ $a _ n$

## 输出格式

请输出选出的两个数，以空格分隔，并按降序排列。

### 限制条件

- $2 \leq n \leq 10 ^ 5$
- $0 \leq a _ i \leq 10 ^ 9$
- $a _ 1, a _ 2, \ldots, a _ n$ 互不相同
- 所有输入均为整数

### 样例解释 1

逐个计算如下：

- ${\rm comb}(4, 2) = 6$
- ${\rm comb}(6, 2) = 15$
- ${\rm comb}(6, 4) = 15$
- ${\rm comb}(9, 2) = 36$
- ${\rm comb}(9, 4) = 126$
- ${\rm comb}(9, 6) = 84$
- ${\rm comb}(11, 2) = 55$
- ${\rm comb}(11, 4) = 330$
- ${\rm comb}(11, 6) = 462$
- ${\rm comb}(11, 9) = 55$

因此，应输出 $11$ 和 $6$。

---

Translated by User 735713.

## 样例 #1

### 输入

```
5

6 9 4 2 11
```

### 输出

```
11 6
```

## 样例 #2

### 输入

```
2

100 0
```

### 输出

```
100 0
```



---

---
title: "[ABC097C] K-th Substring"
layout: "post"
diff: 普及/提高-
pid: AT_arc097_a
tag: []
---

# [ABC097C] K-th Substring

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc097/tasks/arc097_a

文字列 $ s $ が与えられます。 $ s $ の**異なる** substring のうち、辞書順で $ K $ 番目に小さいものを出力してください。

ただし、$ s $ の substring とは、 $ s $ の空でない連続した部分を取り出してできる文字列とします。 例えば、 $ s $ $ = $ `ababc` とすると、 `a`, `bab`, `ababc` は $ s $ の substring ですが、 `ac`, `z`, 空文字列 は $ s $ の substring ではありません。 また、substring が異なるとは、文字列として異なることを指します。

なお、$ X\ =\ x_{1}x_{2}...x_{n}, $ $ Y\ =\ y_{1}y_{2}...y_{m} $ を二つの異なる文字列とするとき、$ Y $ が $ X $ の接頭辞であるか、$ j $ を $ x_{j}\ \neq\ y_{j} $ であるような最小の整数として $ x_{j}\ >\ y_{j} $ である場合、そしてその場合に限って $ X $ は $ Y $ より辞書順で大きいといいます。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ s $ $ K $

## 输出格式

辞書順で $ K $ 番目に小さい $ s $ の substring を出力せよ。

## 说明/提示

### 制約

- $ 1 $ $ <\ = $ $ |s| $ $ <\ = $ $ 5000 $
- $ s $ は英小文字からなる
- $ 1 $ $ <\ = $ $ K $ $ <\ = $ $ 5 $
- $ s $ は異なる substring を $ K $ 個以上持つ

### 部分点

- $ |s| $ $ <\ = $ $ 50 $ を満たすデータセットに正解した場合は、部分点として $ 200 $ 点が与えられる。

### Sample Explanation 1

$ s $ の substring は `a`, `b`, `ab`, `ba`, `aba` の $ 5 $ つです。 このうち $ 4 $ 番目に小さい `b` を出力してください。 `a` を $ 2 $ 回カウントしないことに注意してください。

## 样例 #1

### 输入

```
aba

4
```

### 输出

```
b
```

## 样例 #2

### 输入

```
atcoderandatcodeer

5
```

### 输出

```
andat
```

## 样例 #3

### 输入

```
z

1
```

### 输出

```
z
```



---

---
title: "[ABC097D] Equals"
layout: "post"
diff: 普及/提高-
pid: AT_arc097_b
tag: []
---

# [ABC097D] Equals

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc097/tasks/arc097_b

$ 1 $ から $ N $ までの整数を並び替えた順列 $ p_1 $, $ p_2 $, .., $ p_N $ があります。 また、 $ 1 $ 以上 $ N $ 以下の整数のペアが $ M $ 個与えられます。 これらは $ (x_1,y_1) $, $ (x_2,y_2) $, .., $ (x_M,y_M) $ で表されます。 シカの AtCoDeer くんは順列 $ p $ に次の操作を好きなだけ行って、 $ p_i\ =\ i $ となる $ i $ ($ 1 $ $ <\ = $ $ i $ $ <\ = $ $ N $) の数を最大にしようと考えています。

- $ 1 $ $ <\ = $ $ j $ $ <\ = $ $ M $ なる $ j $ を選び、 $ p_{x_j} $ と $ p_{y_j} $ をスワップする

操作後の $ p_i\ =\ i $ となる $ i $ の数として考えうる最大値を求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ M $ $ p_1 $ $ p_2 $ $ .. $ $ p_N $ $ x_1 $ $ y_1 $ $ x_2 $ $ y_2 $ $ : $ $ x_M $ $ y_M $

## 输出格式

操作後の $ p_i\ =\ i $ となる $ i $ ($ 1 $ $ <\ = $ $ i $ $ <\ = $ $ N $) の数として考えうる最大値を出力せよ。

## 说明/提示

### 制約

- $ 2 $ $ <\ = $ $ N $ $ <\ = $ $ 10^5 $
- $ 1 $ $ <\ = $ $ M $ $ <\ = $ $ 10^5 $
- $ p $ は $ 1 $ から $ N $ までの整数を並び替えた順列
- $ 1 $ $ <\ = $ $ x_j,y_j $ $ <\ = $ $ N $
- $ x_j $ $ ≠ $ $ y_j $
- $ i $ $ ≠ $ $ j $ なら、 $ \{x_i,y_i\} $ $ ≠ $ $ \{x_j,y_j\} $
- 入力は全て整数

### Sample Explanation 1

$ j=1 $ を選んで操作すると、 $ p $ は `1 3 5 4 2` となり、これがベストなので答えは $ 2 $ です。

### Sample Explanation 2

例えば $ j=1 $, $ j=2 $, $ j=1 $ の順に操作すると、 $ p $ は `1 2 3` となり明らかにこれがベストです。 同じ $ j $ を何回選んでもいいことに注意してください。

### Sample Explanation 4

操作をする必要はありません。

## 样例 #1

### 输入

```
5 2

5 3 1 4 2

1 3

5 4
```

### 输出

```
2
```

## 样例 #2

### 输入

```
3 2

3 2 1

1 2

2 3
```

### 输出

```
3
```

## 样例 #3

### 输入

```
10 8

5 3 6 8 7 10 9 1 2 4

3 1

4 1

5 9

2 5

6 5

3 5

8 9

7 9
```

### 输出

```
8
```

## 样例 #4

### 输入

```
5 1

1 2 3 4 5

1 5
```

### 输出

```
5
```



---

---
title: "[ABC098D] Xor Sum 2"
layout: "post"
diff: 普及/提高-
pid: AT_arc098_b
tag: []
---

# [ABC098D] Xor Sum 2

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc098/tasks/arc098_b

長さ $ N $ の整数列 $ A $ があります。

次の条件を満たす整数 $ l $, $ r $ ( $ 1\ \leq\ l\ \leq\ r\ \leq\ N $ ) の組の個数を求めてください。

- $ A_l\ xor\ A_{l+1}\ xor\ ...\ xor\ A_r\ =\ A_l\ +\ A_{l+1}\ +\ ...\ +\ A_r $

xorの説明

整数 $ c_1,\ c_2,\ ...,\ c_m $ の $ xor $ は以下のように定義されます。

- $ xor $ の値を $ X $ とおく。$ X $ を $ 2 $ 進数表記したときの $ 2^k $ ( $ 0\ \leq\ k $, $ k $ は整数 ) の位の値は、$ c_1,\ c_2,\ ...c_m $ のうち、$ 2 $ 進数表記したときの $ 2^k $ の位の値が $ 1 $ となるものが奇数個ならば $ 1 $、偶数個ならば $ 0 $ となる。

例えば、$ 3 $ と $ 5 $ の $ xor $ の値は、$ 3 $ の $ 2 $ 進数表記が $ 011 $、$ 5 $ の $ 2 $ 進数表記が $ 101 $ のため、$ 2 $ 進数表記が $ 110 $ の $ 6 $ となります。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ A_1 $ $ A_2 $ $ ... $ $ A_N $

## 输出格式

条件を満たす整数 $ l $, $ r $ ( $ 1\ \leq\ l\ \leq\ r\ \leq\ N $ ) の組の個数を出力せよ。

## 说明/提示

### 制約

- $ 1\ \leq\ N\ \leq\ 2\ \times\ 10^5 $
- $ 0\ \leq\ A_i $
- 入力はすべて整数である

### Sample Explanation 1

明らかに、$ (l,r)=(1,1),(2,2),(3,3),(4,4) $ は条件を満たします。 また、$ (l,r)=(1,2) $ の場合、$ A_1\ xor\ A_2\ =\ A_1\ +\ A_2\ =\ 7 $ となるので、これも条件を満たします。 ほかに条件を満たす組はないので、答えは $ 5 $ になります。

## 样例 #1

### 输入

```
4

2 5 4 6
```

### 输出

```
5
```

## 样例 #2

### 输入

```
9

0 0 0 0 0 0 0 0 0
```

### 输出

```
45
```

## 样例 #3

### 输入

```
19

885 8 1 128 83 32 256 206 639 16 4 128 689 32 8 64 885 969 1
```

### 输出

```
37
```



---

---
title: "[ABC101C] Minimization"
layout: "post"
diff: 普及/提高-
pid: AT_arc099_a
tag: []
---

# [ABC101C] Minimization

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc101/tasks/arc099_a

長さ $ N $ の数列 $ A_1,\ A_2,\ ...,\ A_N $ があります．最初，この数列の要素は $ 1,\ 2,\ ...,\ N $ を並び替えたものになっています．

スヌケ君は，この数列に対して次の操作を行うことができます．

- 数列のうち，連続した $ K $ 個の要素を選ぶ．その後，選んだ要素それぞれの値を，選んだ要素の中の最小値で置き換える．

スヌケ君は，上の操作を何回か繰り返すことで，この数列の要素をすべて等しくしたいです． 必要な操作の回数の最小値を求めてください． この問題の制約の下，このようなことは必ず可能であることが証明できます．

## 输入格式

入力は以下の形式で標準入力から与えられる．

> $ N $ $ K $ $ A_1 $ $ A_2 $ $ ... $ $ A_N $

## 输出格式

必要な操作の回数の最小値を出力せよ．

## 说明/提示

### 制約

- $ 2\ \leq\ K\ \leq\ N\ \leq\ 100000 $
- $ A_1,\ A_2,\ ...,\ A_N $ は $ 1,\ 2,\ ...,\ N $ の並び替え

### Sample Explanation 1

例えば，次のようにするとよいです： - $ 1 $ 回目の操作では，$ 1,\ 2,\ 3 $ 番目の要素を選ぶ．すると，数列 $ A $ は $ 1,\ 1,\ 1,\ 4 $ になる． - $ 2 $ 回目の操作では，$ 2,\ 3,\ 4 $ 番目の要素を選ぶ．すると，数列 $ A $ は $ 1,\ 1,\ 1,\ 1 $ になる．

## 样例 #1

### 输入

```
4 3

2 3 1 4
```

### 输出

```
2
```

## 样例 #2

### 输入

```
3 3

1 2 3
```

### 输出

```
1
```

## 样例 #3

### 输入

```
8 3

7 3 1 8 4 6 2 5
```

### 输出

```
4
```



---

---
title: "[ABC107C] Candles"
layout: "post"
diff: 普及/提高-
pid: AT_arc101_a
tag: []
---

# [ABC107C] Candles

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc107/tasks/arc101_a

数直線上に $ N $ 本のろうそくが置かれています。 左から $ i $ 番目のろうそくは座標 $ x_i $ に置かれています。 ただし、$ x_1\ <\ x_2\ <\ ...\ <\ x_N $ が成り立ちます。

最初、どのろうそくにも火が付いていません。 すぬけ君は、$ N $ 本のうち $ K $ 本のろうそくに火を付けることにしました。

今、すぬけ君は座標 $ 0 $ にいます。 すぬけ君は、数直線上を左右に速度 $ 1 $ で移動することができます。 また、自分と同じ座標のろうそくに火を付けることができます。 このとき、火を付けるのに掛かる時間は無視できます。

$ K $ 本のろうそくに火を付けるのに必要な最小の時間を求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ K $ $ x_1 $ $ x_2 $ $ ... $ $ x_N $

## 输出格式

$ K $ 本のろうそくに火を付けるのに必要な最小の時間を出力せよ。

## 说明/提示

### 制約

- $ 1\ \leq\ N\ \leq\ 10^5 $
- $ 1\ \leq\ K\ \leq\ N $
- $ x_i $ は整数である。
- $ |x_i|\ \leq\ 10^8 $
- $ x_1\ <\ x_2\ <\ ...\ <\ x_N $

### Sample Explanation 1

次のように移動しながらろうそくに火を付ければよいです。 - 座標 $ 0 $ から $ -10 $ へ移動する。 - 左から $ 2 $ 番目のろうそくに火を付ける。 - 座標 $ -10 $ から $ 10 $ へ移動する。 - 左から $ 3 $ 番目のろうそくに火を付ける。 - 座標 $ 10 $ から $ 20 $ へ移動する。 - 左から $ 4 $ 番目のろうそくに火を付ける。

### Sample Explanation 3

座標 $ 0 $ にろうそくが置かれていることもあります。

## 样例 #1

### 输入

```
5 3

-30 -10 10 20 50
```

### 输出

```
40
```

## 样例 #2

### 输入

```
3 2

10 20 30
```

### 输出

```
20
```

## 样例 #3

### 输入

```
1 1

0
```

### 输出

```
0
```

## 样例 #4

### 输入

```
8 5

-9 -7 -4 -3 1 2 3 4
```

### 输出

```
10
```



---

---
title: "[ABC108C] Triangular Relationship"
layout: "post"
diff: 普及/提高-
pid: AT_arc102_a
tag: []
---

# [ABC108C] Triangular Relationship

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc108/tasks/arc102_a

整数 $ N,K $ が与えられます。$ N $ 以下の正の整数の組 $ (a,b,c) $ であって、$ a+b,b+c,c+a $ がすべて $ K $ の倍数であるようなものの個数を求めてください。 ただし、$ a,b,c $ の順番を入れ替えただけの組も異なるものとして数えます。また、$ a,b,c $ の中に同じものがあっても構いません。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ K $

## 输出格式

$ N $ 以下の正の整数の組 $ (a,b,c) $ であって、$ a+b,b+c,c+a $ がすべて $ K $ の倍数であるようなものの個数を出力せよ。

## 说明/提示

### 制約

- $ 1\ \leq\ N,K\ \leq\ 2\times\ 10^5 $
- $ N,K $ は整数である

### Sample Explanation 1

$ (1,1,1),(1,1,3),(1,3,1),(1,3,3),(2,2,2),(3,1,1),(3,1,3),(3,3,1),(3,3,3) $ が条件を満たします。

## 样例 #1

### 输入

```
3 2
```

### 输出

```
9
```

## 样例 #2

### 输入

```
5 3
```

### 输出

```
1
```

## 样例 #3

### 输入

```
31415 9265
```

### 输出

```
27
```

## 样例 #4

### 输入

```
35897 932
```

### 输出

```
114191
```



---

---
title: "[ABC111C] /\/\/\/"
layout: "post"
diff: 普及/提高-
pid: AT_arc103_a
tag: []
---

# [ABC111C] /\/\/\/

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc111/tasks/arc103_a

数列 $ a_1,a_2,...\ ,a_n $ が以下の条件を満たすとき、 /\\/\\/\\/ と呼ぶことにします。

- 各 $ i\ =\ 1,2,...,\ n-2 $ について、$ a_i\ =\ a_{i+2} $
- 数列に現れる数はちょうど $ 2 $ 種類

偶数長の数列 $ v_1,v_2,...,v_n $ が与えられます。 要素をいくつか書き換えることでこの数列を /\\/\\/\\/ にしたいです。 書き換える要素の数は最小でいくつになるか求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ n $ $ v_1 $ $ v_2 $ $ ... $ $ v_n $

## 输出格式

書き換える要素数の最小値を出力してください。

## 说明/提示

### 制約

- $ 2\ \leq\ n\ \leq\ 10^5 $
- $ n $ は偶数
- $ 1\ \leq\ v_i\ \leq\ 10^5 $
- $ v_i $ は整数

### Sample Explanation 1

数列 $ 3,1,3,2 $ は /\\\\/\\\\/\\\\/ ではありませんが、$ 1 $ 要素書き換えることで /\\\\/\\\\/\\\\/ にすることができます。 例えば、$ 4 $ 要素目を書き換えて $ 3,1,3,1 $ とすればよいです。

### Sample Explanation 2

数列 $ 105,119,105,119,105,119 $ は /\\\\/\\\\/\\\\/ です。

### Sample Explanation 3

数列 $ 1,1,1,1 $ は $ 1 $ 種類の数からなる数列であるため、 /\\\\/\\\\/\\\\/ ではありません。

## 样例 #1

### 输入

```
4

3 1 3 2
```

### 输出

```
1
```

## 样例 #2

### 输入

```
6

105 119 105 119 105 119
```

### 输出

```
0
```

## 样例 #3

### 输入

```
4

1 1 1 1
```

### 输出

```
2
```



---

---
title: "[ARC106B] Values"
layout: "post"
diff: 普及/提高-
pid: AT_arc106_b
tag: []
---

# [ARC106B] Values

## 题目描述

有一个由 $N$ 顶点和 $M$ 边构成的简单无向图。第 $i$ 条边连接顶点 $c_i$ 和顶点 $d_i$。

开始时，顶点 $i$ 的值为 $a_i$。您希望通过执行以下操作(至少一次)，使操作后的每个顶点的值分别为 $b_1,b_2,⋯⋯,b_N$。

您每次可选 $1$ 条边。当选择的边连接顶点 $x$ 和顶点 $y$ 时，可进行以下任意一个操作。

让 $a_x-1,a_y+1$，或者让 $a_x+1,a_y-1$

确定是否有操作可以达到您的目的。

## 输入格式

第 $1$ 行：输入 $N,M$。

第 $2$ 行输入 $N$ 个数，$a_1,a_2,⋯⋯,a_N$。
第 3 行输入 $M$ 个数，$b_1,b_2,⋯⋯,b_M$。
第 4 至 $M+3$ 行，每行输入 $2$ 个数，$c_i,d_i$。

## 输出格式

如果可以，输出 "Yes"，否则，输出 "No"。

## 样例 #1

### 输入

```
3 2

1 2 3

2 2 2

1 2

2 3
```

### 输出

```
Yes
```

## 样例 #2

### 输入

```
1 0

5

5
```

### 输出

```
Yes
```

## 样例 #3

### 输入

```
2 1

1 1

2 1

1 2
```

### 输出

```
No
```

## 样例 #4

### 输入

```
17 9

-905371741 -999219903 969314057 -989982132 -87720225 -175700172 -993990465 929461728 895449935 -999016241 782467448 -906404298 578539175 9684413 -619191091 -952046546 125053320

-440503430 -997661446 -912471383 -995879434 932992245 -928388880 -616761933 929461728 210953513 -994677396 648190629 -530944122 578539175 9684413 595786809 -952046546 125053320

2 10

6 12

9 11

11 5

7 6

3 15

3 1

1 9

10 4
```

### 输出

```
Yes
```



---

---
title: "[ARC106C] Solutions"
layout: "post"
diff: 普及/提高-
pid: AT_arc106_c
tag: []
---

# [ARC106C] Solutions

## 题目描述

[problemUrl]: https://atcoder.jp/contests/arc106/tasks/arc106_c

$ 2 $ つの区間 $ [L_1:R_1],\ [L_2:R_2] $ について, $ L_1\ \leq\ R_2 $ かつ $ L_2\ \leq\ R_1 $ であるとき, この $ 2 $ つの区間が*交わる*と定義します。

以下の問題 $ P $ を考えます。

> 入力: $ N $ 個の区間 $ [L_1:\ R_1],\ \cdots,\ [L_N:R_N] $ $ L_1,\ L_2,\ \cdots,\ L_N,\ R_1,\ R_2,\ \cdots,\ R_N $は全て異なる。 出力: どの $ 2 $ つの区間も交わらないように選べる区間の最大数

高橋君は、以下のように動作するプログラムを実装しました。

> $ R_i $ の値が昇順となるように, 入力された区間を $ [L_{p_1}:R_{p_1}],\ [L_{p_2}:R_{p_2}],\ \cdots\ ,\ [L_{p_N}:R_{p_N}] $ と並び替える。 $ i\ =\ 1,\ 2,\ \cdots\ ,\ N $ について、以下を行う。 これまでに選んだどの区間とも交わらないならば、 $ [L_{p_i}:R_{p_i}] $ を選ぶ。 選んだ区間の数を出力する。

一方、青木君は、以下のように動作するプログラムを実装しました。

> $ L_i $ の値が昇順となるように, 入力された区間を $ [L_{p_1}:R_{p_1}],\ [L_{p_2}:R_{p_2}],\ \cdots\ ,\ [L_{p_N}:R_{p_N}] $ と並び替える。 $ i\ =\ 1,\ 2,\ \cdots\ ,\ N $ について、以下を行う。 これまでに選んだどの区間とも交わらないならば、 $ [L_{p_i}:R_{p_i}] $ を選ぶ。 選んだ区間の数を出力する。

整数 $ N,\ M $が与えられます。 $ N $ 個の区間から成る問題 $ P $ の入力であって、

$ $

(高橋君のプログラムが出力する値)\ -\ (青木君のプログラムが出力する値)\ =\ M $$

となるものを構築してください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ M $

## 输出格式

条件を満たす $ N $ 個の区間が存在しない場合は `-1` と出力せよ。

存在する場合は、 以下のように $ N $ 行出力せよ。

> $ L_1 $ $ R_1 $ $ L_2 $ $ R_2 $ $ \vdots $ $ L_N $ $ R_N $

ただし, $ [L_1:R_1],\ \cdots,\ [L_N:R_N] $は以下の条件を満たさなければならない。

- $ 1\ \leq\ L_i\ <\ R_i\ \leq\ 10^9 $
- $ L_i\ \neq\ L_j $ ($ i\ \neq\ j $)
- $ R_i\ \neq\ R_j $ ($ i\ \neq\ j $)
- $ L_i\ \neq\ R_j $
- $ L_1,\ \cdots\ ,\ L_N\ ,\ R_1,\ \cdots\ ,\ R_N $ は整数 (21:46 追記)

答えが複数存在する場合は、どれを出力しても構わない。

出力の最後には必ず改行を行うこと。

## 说明/提示

### 制約

- 入力は全て整数
- $ 1\ \leq\ N\ \leq\ 2\ \times\ 10^5 $
- $ -N\ \leq\ M\ \leq\ N $

### Sample Explanation 1

$ 5 $ つの区間を順に区間 $ 1 $ 、区間 $ 2 $ 、$ \cdots $ 、区間 $ 5 $ と名付けます。 高橋君のプログラムは以下のように動作します。 &gt; 区間を区間 $ 5 $ 、区間 $ 1 $ 、区間 $ 2 $ 、区間 $ 4 $ 、区間 $ 3 $ と並び替えます。 区間 $ 5 $ を選びます。 区間 $ 1 $ は選びません。(区間 $ 5 $ と交わっている為) 区間 $ 2 $ を選びます。 区間 $ 4 $ は選びません。 (区間 $ 2 $ と交わっている為) 区間 $ 3 $ を選びます。 以上より、高橋君のプログラムが出力する値は $ 3 $ となります。 青木君のプログラムは以下のように動作します。 &gt; 区間を区間 $ 1 $ 、区間 $ 5 $ 、区間 $ 2 $ 、区間 $ 4 $ 、区間 $ 3 $ と並び替えます。 区間 $ 1 $ を選びます。 区間 $ 5 $ は選びません。(区間 $ 1 $ と交わっている為) 区間 $ 2 $ は選びません。 (区間 $ 1 $ と交わっている為) 区間 $ 4 $ を選びます。 区間 $ 3 $ は選びません。 (区間 $ 4 $ と交わっている為) 以上より、青木君のプログラムが出力する値は $ 2 $ となります。 このとき、 $ 3\ -\ 2\ =\ 1\ \left(=\ M\ \right) $ であり、この $ 5 $ つの区間は条件を満たします。

## 样例 #1

### 输入

```
5 1
```

### 输出

```
1 10

8 12

13 20

11 14

2 4
```

## 样例 #2

### 输入

```
10 -10
```

### 输出

```
-1
```



---

---
title: "[ARC109C] Large RPS Tournament"
layout: "post"
diff: 普及/提高-
pid: AT_arc109_c
tag: []
---

# [ARC109C] Large RPS Tournament

## 题目描述

[problemUrl]: https://atcoder.jp/contests/arc109/tasks/arc109_c

最強のじゃんけんの手を決めるため、トーナメント形式のじゃんけん大会が開催されます。 大会の参加者は $ 2^k $ 人で、それぞれ $ 0 $ 以上 $ 2^k $ 未満の整数が振られています。どの参加者もそれぞれ得意な手を持っていて、毎試合得意な手のみを出します。

参加者の得意な手は、長さ $ n $ の `R`, `P`, `S` からなる文字列 $ s $ によって表されます。 具体的には、番号 $ i $ の参加者の得意な手は $ s $ の $ (i\text{\ mod\ }\ n)\ +\ 1 $ 文字目の文字で表されます。ここで、`R` はグー、`P` はパー、`S` はチョキを表します。

$ r-l $ が $ 2 $ のべき乗であるような $ l,\ r $ について、番号が $ l $ 以上 $ r $ 未満の参加者による大会を開いたとき、勝者は次のようにして決定されます。

- $ r-l=1 $ であるとき（つまり、参加者がただ一人であるとき）、勝者は $ l $ とする。
- $ r-l\geq\ 2 $ であるとき、$ m=(l+r)/2 $ として、$ l $ 以上 $ m $ 未満の参加者による大会と、$ m $ 以上 $ r $ 未満の参加者による大会を開催する。それぞれの勝者が $ a,\ b $ であるとき、$ a $ と $ b $ がじゃんけんをして勝ったほうを勝者とする。あいこの場合 $ a $ を勝者とする。

番号が $ 0 $ 以上 $ 2^k $ 未満の参加者による大会の勝者の得意な手を求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ n $ $ k $ $ s $

## 输出格式

大会の勝者の得意な手を `R` か `P` か `S` で出力せよ。

## 说明/提示

### 注意

- $ a\text{\ mod\ }\ b $ は $ a $ を $ b $ で割ったあまりを表す
- じゃんけんの勝敗は次のように決められる
  - 同じ手同士はあいこである
  - `R` は `S` に勝つ
  - `P` は `R` に勝つ
  - `S` は `P` に勝つ

### 制約

- $ 1\ \leq\ n,k\ \leq\ 100 $
- $ s $ は `R`, `P`, `S` のみからなる長さ $ n $ の文字列

### Sample Explanation 1

\- 番号が $ 0 $ 以上 $ 2 $ 未満の参加者による大会の勝者の得意な手は `P` です。 - 番号が $ 2 $ 以上 $ 4 $ 未満の参加者による大会の勝者の得意な手は `R` です。 - 番号が $ 0 $ 以上 $ 4 $ 未満の参加者による大会の勝者の得意な手は `P` です。 よって、答えは `P` となります。 ``` P ┌─┴─┐ P R ┌┴┐ ┌┴┐ R P S R ```

## 样例 #1

### 输入

```
3 2

RPS
```

### 输出

```
P
```

## 样例 #2

### 输入

```
11 1

RPSSPRSPPRS
```

### 输出

```
P
```

## 样例 #3

### 输入

```
1 100

S
```

### 输出

```
S
```



---

---
title: "[ARC110C] Exoswap"
layout: "post"
diff: 普及/提高-
pid: AT_arc110_c
tag: []
---

# [ARC110C] Exoswap

## 题目描述

[problemUrl]: https://atcoder.jp/contests/arc110/tasks/arc110_c

$ 1,\ 2,\ \ldots,\ N $ を並び替えた数列 $ P\ =\ P_1,\ P_2,\ \ldots,\ P_N $ があります。

あなたは $ P $ に対して、以下の $ N\ -\ 1 $ 種類の操作を、任意の順番で**ちょうど $ 1 $ 回ずつ**行わなければなりません。

- $ P_1 $ と $ P_2 $ を入れ替える
- $ P_2 $ と $ P_3 $ を入れ替える
  
  $ \vdots $
- $ P_{N\ -\ 1} $ と $ P_N $ を入れ替える

操作の順番を適切に決めることで、$ P $ を昇順に並び替えてください。 もしそれが不可能な場合、`-1` を出力してください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ P_1 $ $ P_2 $ $ \ldots $ $ P_N $

## 输出格式

どのような順番で操作しても $ P $ を昇順に並び替えることができない場合、`-1` を出力せよ。

$ P $ を昇順に並び替えることができる場合、そのような操作列を $ N\ -\ 1 $ 行使って出力せよ。 $ i\ ~\ (1\ \leq\ i\ \leq\ N\ -\ 1) $ 行目には、$ i $ 回目の操作で $ P_j $ と $ P_{j\ +\ 1} $ を入れ替えるとして、$ j $ を出力せよ。

$ P $ を昇順に並び替える操作列が複数存在する場合、どれを出力しても構わない。

## 说明/提示

### 制約

- 入力は全て整数
- $ 2\ \leq\ N\ \leq\ 2\ \times\ 10^5 $
- $ P $ は $ 1,\ 2,\ \ldots,\ N $ を並び替えた数列

### Sample Explanation 1

以下のような操作列が $ P $ を昇順に並び替えます。 - まず $ P_4 $ と $ P_5 $ を入れ替える。$ P $ は $ 2,\ 4,\ 1,\ 3,\ 5 $ になる - 次に $ P_2 $ と $ P_3 $ を入れ替える。$ P $ は $ 2,\ 1,\ 4,\ 3,\ 5 $ になる - 次に $ P_3 $ と $ P_4 $ を入れ替える。$ P $ は $ 2,\ 1,\ 3,\ 4,\ 5 $ になる - 次に $ P_1 $ と $ P_2 $ を入れ替える。$ P $ は $ 1,\ 2,\ 3,\ 4,\ 5 $ になる

## 样例 #1

### 输入

```
5

2 4 1 5 3
```

### 输出

```
4

2

3

1
```

## 样例 #2

### 输入

```
5

5 4 3 2 1
```

### 输出

```
-1
```



---

---
title: "[ARC111A] Simple Math 2"
layout: "post"
diff: 普及/提高-
pid: AT_arc111_a
tag: []
---

# [ARC111A] Simple Math 2

## 题目描述

[problemUrl]: https://atcoder.jp/contests/arc111/tasks/arc111_a

正整数 $ N,\ M $ が与えられます。$ \lfloor\ \frac{10^N}{M}\ \rfloor $ を $ M $ で割った余りを求めてください。

  $ \lfloor\ x\ \rfloor $ について $ \lfloor\ x\ \rfloor $ は、 $ x $ を超えない最大の整数を表します。例としては次のようになります。 - $ \lfloor\ 2.5\ \rfloor\ =\ 2 $
- $ \lfloor\ 3\ \rfloor\ =\ 3 $
- $ \lfloor\ 9.9999999\ \rfloor\ =\ 9 $
- $ \lfloor\ \frac{100}{3}\ \rfloor\ =\ \lfloor\ 33.33...\ \rfloor\ =\ 33 $

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ M $

## 输出格式

答えを出力せよ。

## 说明/提示

### 制約

- $ 1\ \leq\ N\ \leq\ 10^{18} $
- $ 1\ \leq\ M\ \leq\ 10000 $

### Sample Explanation 1

$ \lfloor\ \frac{10^1}{2}\ \rfloor\ =\ 5 $ なので、$ 5 $ を $ 2 $ で割った余りの $ 1 $ を出力します。

## 样例 #1

### 输入

```
1 2
```

### 输出

```
1
```

## 样例 #2

### 输入

```
2 7
```

### 输出

```
0
```

## 样例 #3

### 输入

```
1000000000000000000 9997
```

### 输出

```
9015
```



---

---
title: "[ARC112B] -- - B"
layout: "post"
diff: 普及/提高-
pid: AT_arc112_b
tag: []
---

# [ARC112B] -- - B

## 题目描述

[problemUrl]: https://atcoder.jp/contests/arc112/tasks/arc112_b

すぬけくんは、整数 $ B $ を持って整数やさんを訪れました。 整数やさんでは、お金を払うことで、持っている整数を別の整数にしてもらうことができます。

具体的には、次の $ 2 $ 種類のサービスを好きな順で好きなだけ購入することができます。

- $ 1 $ 円を払い、持っている整数を $ -1 $ 倍する。
- $ 2 $ 円を払い、持っている整数から $ 1 $ を引く。

すぬけくんが $ C $ 円以内で作ることのできる整数は何通りありますか？

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ B $ $ C $

## 输出格式

答えを出力せよ。

## 说明/提示

### 制約

- $ -10^{18}\le\ B\ \le\ 10^{18} $
- $ 1\le\ C\ \le\ 10^{18} $
- 入力はすべて整数

### Sample Explanation 1

以下のように、$ -11,10,11 $ の $ 3 $ 通りの数を作ることができます。 - 何もしないとき、$ 0 $ 円を使って $ 11 $ を作ることができる - $ 11 $ を $ -1 $ 倍すると、$ 1 $ 円を使って $ -11 $ を作ることができる - $ 11 $ から $ 1 $ を引くと、$ 2 $ 円を使って $ 10 $ を作ることができる

### Sample Explanation 2

以下のように、$ -2,-1,0,1 $ の $ 4 $ 通りの数を作ることができます。 - 何もしないとき、$ 0 $ 円を使って $ 0 $ を作ることができる - $ 0 $ から $ 1 $ を引くと、$ 2 $ 円を使って $ -1 $ を作ることができる - $ 0 $ から $ 1 $ を引いて $ -1 $ 倍すると、$ 3 $ 円を使って $ 1 $ を作ることができる - $ 0 $ から $ 1 $ を引いて $ 1 $ を引くと、$ 4 $ 円を使って $ -2 $ を作ることができる

## 样例 #1

### 输入

```
11 2
```

### 输出

```
3
```

## 样例 #2

### 输入

```
0 4
```

### 输出

```
4
```

## 样例 #3

### 输入

```
112 20210213
```

### 输出

```
20210436
```

## 样例 #4

### 输入

```
-211 1000000000000000000
```

### 输出

```
1000000000000000422
```



---

---
title: "[ARC113C] String Invasion"
layout: "post"
diff: 普及/提高-
pid: AT_arc113_c
tag: []
---

# [ARC113C] String Invasion

## 题目描述

[problemUrl]: https://atcoder.jp/contests/arc113/tasks/arc113_c

長さ $ N $ の文字列 $ S $ が与えられます。$ S $ の $ i $ 文字目を $ s_i $ で表します。以下の操作を繰り返せる回数の最大値を求めてください。

- 連続する $ 3 $ 文字 $ s_i,s_{i+1},s_{i+2}\quad\ (1\leq\ i\leq\ |S|-2) $ であって、$ s_i=s_{i+1}\neq\ s_{i+2} $ であるものを選ぶ。$ s_{i+2} $ を $ s_i $ で置き換える。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ S $

## 输出格式

操作を繰り返せる回数の最大値を出力せよ。

## 说明/提示

### 制約

- $ 3\ \leq\ |S|\ \leq\ 2\times\ 10^5 $
- $ S $ は英小文字からなる

### Sample Explanation 1

以下のように $ 3 $ 回の操作を行うことができます。 - $ i=2 $ に対して操作を行う。操作後の文字列は `acccpt` になる。 - $ i=3 $ に対して操作を行う。操作後の文字列は `acccct` になる。 - $ i=4 $ に対して操作を行う。操作後の文字列は `accccc` になる。

## 样例 #1

### 输入

```
accept
```

### 输出

```
3
```

## 样例 #2

### 输入

```
atcoder
```

### 输出

```
0
```

## 样例 #3

### 输入

```
anerroroccurred
```

### 输出

```
16
```



---

---
title: "[ARC114A] Not coprime"
layout: "post"
diff: 普及/提高-
pid: AT_arc114_a
tag: []
---

# [ARC114A] Not coprime

## 题目描述

[problemUrl]: https://atcoder.jp/contests/arc114/tasks/arc114_a

$ N $ 個の $ 2 $ 以上 $ 50 $ 以下の整数 $ X_1,\ X_2,\ \cdots,\ X_N $ が与えられます．全ての $ i\ =\ 1,\ 2,\ \cdots,\ N $ について次の条件を満たす正の整数 $ Y $ のうち，最小のものを求めてください．

- $ X_i $ と $ Y $ は互いに素でない

## 输入格式

入力は以下の形式で標準入力から与えられる．

> $ N $ $ X_1 $ $ X_2 $ $ \ldots $ $ X_N $

## 输出格式

条件を満たす最小の正の整数を出力せよ．

## 说明/提示

### 制約

- $ 1\ \leq\ N\ \leq\ 49 $
- $ 2\ \leq\ X_i\ \leq\ 50 $
- $ X_i\ \neq\ X_j\ (i\ \neq\ j) $
- 入力は全て整数

### Sample Explanation 1

$ 4 $ と互いに素でないためには偶数である必要があり，$ 3 $ と互いに素でないためには $ 3 $ の倍数である必要があります．

## 样例 #1

### 输入

```
2

4 3
```

### 输出

```
6
```

## 样例 #2

### 输入

```
1

47
```

### 输出

```
47
```

## 样例 #3

### 输入

```
7

3 4 6 7 8 9 10
```

### 输出

```
42
```



---

---
title: "[ARC114B] Special Subsets"
layout: "post"
diff: 普及/提高-
pid: AT_arc114_b
tag: []
---

# [ARC114B] Special Subsets

## 题目描述

[problemUrl]: https://atcoder.jp/contests/arc114/tasks/arc114_b

$ 1 $ 以上 $ N $ 以下の整数すべてから成る集合を $ S $ とします．

$ f $ は $ S $ から $ S $ への関数であり，$ f(1),\ f(2),\ \cdots,\ f(N) $ の値が $ f_1,\ f_2,\ \cdots,\ f_N $ として与えられます．

$ S $ の空でない部分集合 $ T $ であって，次の両方の条件を満たすものの個数を $ 998244353 $ で割った余りを求めてください．

- 全ての $ a\ \in\ T $ について $ f(a)\ \in\ T $ である．
- 全ての $ a,\ b\ \in\ T $ について $ a\ \neq\ b $ ならば $ f(a)\ \neq\ f(b) $ である．

## 输入格式

入力は以下の形式で標準入力から与えられる．

> $ N $ $ f_1 $ $ f_2 $ $ \ldots $ $ f_N $

## 输出格式

$ S $ の空でない部分集合であって，両方の条件を満たすものの個数を $ 998244353 $ で割った余りを出力せよ．

## 说明/提示

### 制約

- $ 1\ \leq\ N\ \leq\ 2\ \times\ 10^5 $
- $ 1\ \leq\ f_i\ \leq\ N $
- 入力は全て整数

### Sample Explanation 1

$ f(1)\ =\ 2,\ f(2)\ =\ 1 $ です．$ f(1)\ \neq\ f(2) $ であるため条件の $ 2 $ つ目は常に満たしますが，$ 1 $ つ目の条件より $ 1,\ 2 $ は同時に $ T $ に入っている必要があります．

### Sample Explanation 2

$ f(1)\ =\ f(2)\ =\ 1 $ です．$ 1 $ つ目の条件のため $ 1 $ は $ T $ に属する必要があり，さらに $ 2 $ つ目の条件により $ 2 $ は $ T $ に属することはできません．

### Sample Explanation 3

$ f(1)\ =\ 1,\ f(2)\ =\ 2,\ f(3)\ =\ 3 $ です．$ 1 $ つ目の条件も $ 2 $ つ目の条件も常に満たされるため，$ S $ の空でない部分集合全てが条件を満たします．

## 样例 #1

### 输入

```
2

2 1
```

### 输出

```
1
```

## 样例 #2

### 输入

```
2

1 1
```

### 输出

```
1
```

## 样例 #3

### 输入

```
3

1 2 3
```

### 输出

```
7
```



---

---
title: "[ARC115C] ℕ Coloring"
layout: "post"
diff: 普及/提高-
pid: AT_arc115_c
tag: []
---

# [ARC115C] ℕ Coloring

## 题目描述

[problemUrl]: https://atcoder.jp/contests/arc115/tasks/arc115_c

整数 $ N $ が与えられます。以下の条件を満たす長さ $ N $ の正の整数の列 $ A_1,A_2,\ldots,A_N $ であって、数列に現れる値の最大値が最小になるものを一つ出力してください。

- $ i $ が $ j $ の約数ならば、$ A_i\ \neq\ A_j $ $ (1\ \leq\ i\ <\ j\ \leq\ N) $

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $

## 输出格式

数列の各要素を空白で区切って一行に出力せよ。

条件を満たす解が複数存在する場合は、どれを出力してもよい。

> $ A_1 $ $ A_2 $ $ \ldots $ $ A_N $

## 说明/提示

### 制約

- $ 1\ \leq\ N\ \leq\ 10^5 $

### Sample Explanation 1

この出力は以下の条件をすべて満たします。 - $ A_1\ \neq\ A_2 $ - $ A_1\ \neq\ A_3 $ - $ A_1\ \neq\ A_4 $ - $ A_2\ \neq\ A_4 $ また、登場する値の最大値が $ 2 $ 以下である数列であって、これらの条件をすべて満たすものは存在しないので、この出力は適当です。

## 样例 #1

### 输入

```
4
```

### 输出

```
1 2 2 3
```



---

---
title: "[ARC116B] Products of Min-Max"
layout: "post"
diff: 普及/提高-
pid: AT_arc116_b
tag: []
---

# [ARC116B] Products of Min-Max

## 题目描述

[problemUrl]: https://atcoder.jp/contests/arc116/tasks/arc116_b

長さ $ N $ の整数列 $ A $ が与えられます。$ A $ の空でない部分列 $ B $ は $ 2^N\ -\ 1 $ 個あります。これらについて $ \max\left(B\right)\ \times\ \min\left(B\right) $ の値を計算し、その総和を答えてください。

ただし、答えは非常に大きくなる場合があるので、 $ 998244353 $ で割った余りを答えてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ A_1 $ $ A_2 $ $ \cdots $ $ A_N $

## 输出格式

答えを出力せよ。

## 说明/提示

### 制約

- 入力は全て整数
- $ 1\ \leq\ N\ \leq\ 2\ \times\ 10^5 $
- $ 0\ \leq\ A_i\ \leq\ 998244352 $

### Sample Explanation 1

$ B $ として、以下の $ 7 $ つが考えられます。 - $ B\ =\ \left(2\right) $ : $ \max\left(B\right)\ \times\ \min\left(B\right)\ =\ 4 $ - $ B\ =\ \left(4\right) $ : $ \max\left(B\right)\ \times\ \min\left(B\right)\ =\ 16 $ - $ B\ =\ \left(3\right) $ : $ \max\left(B\right)\ \times\ \min\left(B\right)\ =\ 9 $ - $ B\ =\ \left(2,\ 4\right) $ : $ \max\left(B\right)\ \times\ \min\left(B\right)\ =\ 8 $ - $ B\ =\ \left(2,\ 3\right) $ : $ \max\left(B\right)\ \times\ \min\left(B\right)\ =\ 6 $ - $ B\ =\ \left(4,\ 3\right) $ : $ \max\left(B\right)\ \times\ \min\left(B\right)\ =\ 12 $ - $ B\ =\ \left(2,\ 4,\ 3\right) $ : $ \max\left(B\right)\ \times\ \min\left(B\right)\ =\ 8 $ 以上の $ 7 $ つの値を足した値 $ 63 $ が答えです。

## 样例 #1

### 输入

```
3

2 4 3
```

### 输出

```
63
```

## 样例 #2

### 输入

```
1

10
```

### 输出

```
100
```

## 样例 #3

### 输入

```
7

853983 14095 543053 143209 4324 524361 45154
```

### 输出

```
206521341
```



---

---
title: "[ARC118B] Village of M People"
layout: "post"
diff: 普及/提高-
pid: AT_arc118_b
tag: []
---

# [ARC118B] Village of M People

## 题目描述

[problemUrl]: https://atcoder.jp/contests/arc118/tasks/arc118_b

ARC 国には $ N $ 人の国民がおり、全国民が競技プログラミングのプレイヤーです。各国民にはその競技プログラミングの実力によって、$ 1,\ 2,\ \ldots,\ K $ のいずれかひとつの段位が与えられています。

ARC 国では国勢調査が行われて、その結果、段位 $ i $ の国民はちょうど $ A_i $ 人居ることが分かりました。ARC 国の国王はこの統計データをより理解しやすい形にするために、なるべく各段位の人数の割合を保ったまま、ARC 国の状況を $ M $ 人の村に例えることにしました。

$ M $ 人の村における段位 $ i $ の村民の人数 $ B_i $ を上手く定めることで、$ \max_i\left|\frac{B_i}{M}\ -\ \frac{A_i}{N}\right| $ を最小にしてください。ただし、次が成り立つ必要があります。

- 各 $ B_i $ は非負整数で、$ \sum_{i=1}^K\ B_i\ =\ M $ を満たす

そのような $ B\ =\ (B_1,\ B_2,\ \ldots,\ B_K) $ の定め方を、ひとつ出力してください。

## 输入格式

入力は以下の形式で標準入力から与えられます。

> $ K $ $ N $ $ M $ $ A_1 $ $ A_2 $ $ \ldots $ $ A_K $

## 输出格式

条件を満たす整数列 $ B $ の各要素を、空白で区切って $ 1 $ 行で出力してください。

> $ B_1 $ $ B_2 $ $ \ldots $ $ B_K $

条件を満たす整数列が複数存在する場合は、どれを出力しても正解となります。

## 说明/提示

### 制約

- $ 1\leq\ K\leq\ 10^5 $
- $ 1\leq\ N,\ M\leq\ 10^9 $
- 各 $ A_i $ は非負整数で、$ \sum_{i=1}^K\ A_i\ =\ N $ を満たす

### Sample Explanation 1

この出力において、$ \max_i\left|\frac{B_i}{M}\ -\ \frac{A_i}{N}\right|\ =\ \max\left(\left|\frac{3}{20}-\frac{1}{7}\right|,\ \left|\frac{6}{20}-\frac{2}{7}\right|,\ \left|\frac{11}{20}-\frac{4}{7}\right|\right)\ =\ \max\left(\frac{1}{140},\ \frac{1}{70},\ \frac{3}{140}\right)\ =\ \frac{3}{140} $ となっています。

### Sample Explanation 2

和を $ M\ =\ 100 $ にしなければならないので、$ B_1\ =\ B_2\ =\ B_3\ =\ 33 $ では 条件が満たされないことに注意してください。 なおこの例においては、`34 33 33` の他、`33 34 33` や `33 33 34` という出力も正解となります。

## 样例 #1

### 输入

```
3 7 20

1 2 4
```

### 输出

```
3 6 11
```

## 样例 #2

### 输入

```
3 3 100

1 1 1
```

### 输出

```
34 33 33
```

## 样例 #3

### 输入

```
6 10006 10

10000 3 2 1 0 0
```

### 输出

```
10 0 0 0 0 0
```

## 样例 #4

### 输入

```
7 78314 1000

53515 10620 7271 3817 1910 956 225
```

### 输出

```
683 136 93 49 24 12 3
```



---

---
title: "[ARC118C] Coprime Set"
layout: "post"
diff: 普及/提高-
pid: AT_arc118_c
tag: []
---

# [ARC118C] Coprime Set

## 题目描述

[problemUrl]: https://atcoder.jp/contests/arc118/tasks/arc118_c

正の整数 $ N $ が与えられます。整数列 $ A\ =\ (A_1,\ A_2,\ \ldots,\ A_N) $ であって、次の条件をすべて満たすものをひとつ出力してください。

- $ 1\leq\ A_i\leq\ 10000 $
- $ i\neq\ j $ に対して、$ A_i\neq\ A_j $ かつ $ \gcd(A_i,\ A_j)\ >\ 1 $
- $ \gcd(A_1,\ A_2,\ \ldots,\ A_N)\ =\ 1 $

なお、この問題の制約のもとで、条件を満たす整数列が存在することが証明できます。

## 输入格式

入力は以下の形式で標準入力から与えられます。

> $ N $

## 输出格式

条件を満たす整数列 $ A $ の各要素を、空白で区切って $ 1 $ 行で出力してください。

> $ A_1 $ $ A_2 $ $ \ldots $ $ A_N $

条件を満たす整数列が複数存在する場合は、どれを出力しても正解となります。

## 说明/提示

### 制約

- $ 3\leq\ N\leq\ 2500 $

### Sample Explanation 1

\- $ \gcd(84,60)\ =\ 12 $ - $ \gcd(84,105)\ =\ 21 $ - $ \gcd(84,70)\ =\ 14 $ - $ \gcd(60,105)\ =\ 15 $ - $ \gcd(60,70)\ =\ 10 $ - $ \gcd(105,70)\ =\ 35 $ - $ \gcd(84,60,105,70)\ =\ 1 $ が成り立ち、すべての条件が満たされていることが確認できます。

## 样例 #1

### 输入

```
4
```

### 输出

```
84 60 105 70
```



---

---
title: "[ARC119B] Electric Board"
layout: "post"
diff: 普及/提高-
pid: AT_arc119_b
tag: []
---

# [ARC119B] Electric Board

## 题目描述

[problemUrl]: https://atcoder.jp/contests/arc119/tasks/arc119_b

いま、電光掲示板に `0` と `1` から成る長さ $ N $ の文字列 $ S $ が表示されています。

あなたは次の操作を何回でも行うことができます。なお、ここでは電光掲示板に表示されている文字列の $ i $ $ (1\ \leq\ i\ \leq\ N) $ 文字目を $ S_i $ と表します。

> **操作** 整数 $ (l,\ r) $ $ (1\ \leq\ l\ <\ r\ \leq\ N) $ であって、次の条件のうちいずれかを満たすものを $ 1 $ 組選び、$ S_l $ と $ S_r $ を入れ替える。
> 
> - $ S_l= $ `0` かつ $ S_{l+1}=\cdots=S_r= $ `1` を満たす。
> - $ S_{l}=\cdots=S_{r-1}= $ `1` かつ $ S_r= $ `0` を満たす。

電光掲示板に表示されている文字列を $ T $ に一致させることができるか判定し、可能な場合は操作回数として考えられる最小の値を求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられます。

> $ N $ $ S $ $ T $

## 输出格式

電光掲示板に表示されている文字列を $ T $ にすることが不可能な場合は、`-1` を出力してください。

可能な場合は、操作回数として考えられる最小の値を出力してください。

## 说明/提示

### 制約

- $ 2\ \leq\ N\ \leq\ 500000 $
- $ S $ は `0` と `1` からなる長さ $ N $ の文字列である
- $ T $ は `0` と `1` からなる長さ $ N $ の文字列である

### Sample Explanation 1

例えば以下のように操作を行えば、$ 2 $ 回の操作で電光掲示板に表示されている文字列を `1010111` にすることができます。 - $ (l,\ r)\ =\ (2,\ 4) $ を選んで操作を行う。そのとき、電光掲示板の文字列は `1110110` から `1011110` に変化する。 - $ (l,\ r)\ =\ (4,\ 7) $ を選んで操作を行う。そのとき、電光掲示板の文字列は `1011110` から `1010111` に変化する。

### Sample Explanation 2

操作を行う前の時点で、電光掲示板に表示されている文字列が $ T $ であるため、答えは $ 0 $ となります。

### Sample Explanation 3

どのように操作を行っても、電光掲示板に文字列 $ T $ を表示させることが不可能な場合は、`-1` と出力してください。

## 样例 #1

### 输入

```
7

1110110

1010111
```

### 输出

```
2
```

## 样例 #2

### 输入

```
20

11111000000000011111

11111000000000011111
```

### 输出

```
0
```

## 样例 #3

### 输入

```
6

111100

111000
```

### 输出

```
-1
```

## 样例 #4

### 输入

```
119

10101111011101001011111000111111101011110011010111111111111111010111111111111110111111110111110111101111111111110111011

11111111111111111111111111011111101011111011110111110010100101001110111011110111111111110010011111101111111101110111011
```

### 输出

```
22
```



---

---
title: "[ARC120B] Uniformly Distributed"
layout: "post"
diff: 普及/提高-
pid: AT_arc120_b
tag: []
---

# [ARC120B] Uniformly Distributed

## 题目描述

给定一个大小为 $H \times W$ 的网格图，每个格子可以被染成红色（R）、蓝色（B）或为空（.）。记空格数量为 $k$，将所有空格依次染成红色或蓝色，总共有 $2^k$ 种染色方案。

现在要求在从 $(1,1)$ 出发，向下或向右移动一格到达 $(H,W)$ 的过程中，所有经过的格子（包括起点和终点）中被染成红色的格子数目相等。求有多少种方案满足条件。答案对 $998244353$ 取模。

## 输入格式

第一行包含两个整数 $H$ 和 $W$。接下来 $H$ 行，每行包含一个长度为 $W$ 的字符串，表示该行格子的染色情况。

## 输出格式

输出一个整数，表示满足条件的染色方案数对 $998244353$ 取模的结果。

## 说明/提示

$1 \leq H,W \leq 500$

## 样例 #1

### 输入

```
2 2

B.

.R
```

### 输出

```
2
```

## 样例 #2

### 输入

```
3 3

R.R

BBR

...
```

### 输出

```
0
```

## 样例 #3

### 输入

```
2 2

BB

BB
```

### 输出

```
1
```



---

---
title: "[ARC121B] RGB Matching"
layout: "post"
diff: 普及/提高-
pid: AT_arc121_b
tag: []
---

# [ARC121B] RGB Matching

## 题目描述

[problemUrl]: https://atcoder.jp/contests/arc121/tasks/arc121_b

すぬけ君は $ 1 $ から $ 2N $ の番号がついた $ 2N $ 匹の犬を飼っています。

犬 $ i $ のかわいさは $ a_i $ です。 それぞれの犬の体色は赤、緑、青のいずれかで、犬 $ i $ の体色は $ c_i $ です。 $ c_i $ は `R`, `G`, `B` のいずれかであり、`R` ならばその犬の体色が赤であることを、`G` ならば緑であることを、`B` ならば青であることを表します。

すぬけ君は $ N $ 棟の犬小屋を持っており、それぞれの犬小屋に $ 2 $ 匹の犬を住まわせようとしています。 どの犬もちょうど一つの犬小屋に住んでいるように住まわせる必要があることに注意してください。

$ 2 $ 匹の犬を同じ犬小屋に住まわせるとその小屋には *不満* が生じます。 不満の度合いは整数で表され、犬 $ i,j $ が同じ小屋にいるとき生じる不満は $ c_i\ =\ c_j $ ならば $ 0 $、そうでなければ $ |a_i\ -\ a_j| $ です。

$ N $ 棟の犬小屋に犬を $ 2 $ 匹ずつ住まわせた結果生じる不満の総和としてありうる値の最小値を求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ a_{1} $ $ c_{1} $ $ \vdots $ $ a_{2N} $ $ c_{2N} $

## 输出格式

$ N $ 棟の犬小屋に犬を $ 2 $ 匹ずつ住まわせた結果生じる不満の総和としてありうる値の最小値を出力せよ。

## 说明/提示

### 制約

- $ 1\ \leq\ N\ \leq\ 10^{5} $
- $ 1\ \leq\ a_i\ \leq\ 10^{15} $
- $ a_i $ は整数
- $ c_i $ は `R`, `G`, `B` のいずれか

### Sample Explanation 1

\- 犬 $ 1 $ のかわいさは $ 1 $、犬 $ 2 $ のかわいさは $ 2 $ です。 - $ c_1\ \neq\ c_2 $ より、不満は $ 1 $ となります。

### Sample Explanation 2

\- 犬 $ 1 $ のかわいさは $ 1 $、犬 $ 2 $ のかわいさは $ 2 $ です。 - $ c_1\ =\ c_2 $ より、不満は $ 0 $ となります。

## 样例 #1

### 输入

```
1

1 R

2 G
```

### 输出

```
1
```

## 样例 #2

### 输入

```
1

1 B

2 B
```

### 输出

```
0
```

## 样例 #3

### 输入

```
10

585 B

293 B

788 B

222 B

772 G

841 B

115 R

603 G

450 B

325 R

851 B

205 G

134 G

651 R

565 R

548 B

391 G

19 G

808 B

475 B
```

### 输出

```
0
```



---

---
title: "[ARC122A] Many Formulae"
layout: "post"
diff: 普及/提高-
pid: AT_arc122_a
tag: []
---

# [ARC122A] Many Formulae

## 题目描述

[problemUrl]: https://atcoder.jp/contests/arc122/tasks/arc122_a

長さ $ N $ の非負整数列 $ A_1,A_2,\cdots,A_N $ が与えられます．

この数列の隣接する $ 2 $ 項の間に `+` または `-` を入れて，一つの式を作ることを考えます．

式を作る方法は $ 2^{N-1} $ 通りありますが，この中でも以下の条件を満たす式を，**良い式**と呼ぶことにします．

- `-` が $ 2 $ 回以上連続で登場しない．

全ての良い式の値を足し合わせた値を求めて下さい． なお，この値はかならず非負整数となることが証明できます． そこで，この値を $ 10^9+7 $ で割った余りを出力してください．

## 输入格式

入力は以下の形式で標準入力から与えられる．

> $ N $ $ A_1 $ $ A_2 $ $ \cdots $ $ A_N $

## 输出格式

答えを $ 10^9+7 $ で割った余りを出力せよ．

## 说明/提示

### 制約

- $ 1\ \leq\ N\ \leq\ 10^5 $
- $ 1\ \leq\ A_i\ \leq\ 10^9 $
- 入力される値はすべて整数である

### Sample Explanation 1

以下の $ 3 $ 通りの良い式が考えられます． - $ 3+1+5=9 $ - $ 3+1-5=-1 $ - $ 3-1+5=7 $ $ 3-1-5 $ は `-` が $ 2 $ 回以上連続で登場するため，良い式ではありません． よって，答えは $ 9+(-1)+7=15 $ となります．

### Sample Explanation 2

以下の $ 5 $ 通りの良い式が考えられます． - $ 1+1+1+1=4 $ - $ 1+1+1-1=2 $ - $ 1+1-1+1=2 $ - $ 1-1+1+1=2 $ - $ 1-1+1-1=0 $ よって答えは $ 4+2+2+2+0=10 $ となります．

### Sample Explanation 3

答えを $ 10^9+7 $ で割った余りを出力してください．

## 样例 #1

### 输入

```
3

3 1 5
```

### 输出

```
15
```

## 样例 #2

### 输入

```
4

1 1 1 1
```

### 输出

```
10
```

## 样例 #3

### 输入

```
10

866111664 178537096 844917655 218662351 383133839 231371336 353498483 865935868 472381277 579910117
```

### 输出

```
279919144
```



---

---
title: "[ARC122B] Insurance"
layout: "post"
diff: 普及/提高-
pid: AT_arc122_b
tag: []
---

# [ARC122B] Insurance

## 题目描述

[problemUrl]: https://atcoder.jp/contests/arc122/tasks/arc122_b

すぬけくんは明日の運勢を占いました． その結果，$ N $ 個のシナリオのうちどれか一つが等確率で発生し，そのうち $ i $ 番目のシナリオでは $ A_i $ 円を失うことを知りました．

そこですぬけくんは，今日保険に入ることにしました． 保険会社に $ x $ 円を支払ったとすると，$ A_i $ 円を失った場合には $ \min(A_i,2x) $ 円が補填されます． ここで，$ x $ として任意の非負**実数**を選ぶことができます．

すぬけくんは，最終的に自分が失う金額（$ =x+A_i-\min(A_i,2x) $）の期待値を最小化したいです． この最小値を求めてください．

## 输入格式

入力は以下の形式で標準入力から与えられる．

> $ N $ $ A_1 $ $ A_2 $ $ \cdots $ $ A_N $

## 输出格式

答えを出力せよ． 絶対誤差または相対誤差が $ 10^{-6} $ 以下ならば，正解と判定される．

## 说明/提示

### 制約

- $ 1\ \leq\ N\ \leq\ 10^5 $
- $ 1\ \leq\ A_i\ \leq\ 10^9 $
- 入力される値はすべて整数である

### Sample Explanation 1

$ x=1.5 $ とするのが最適です． $ 1.5 $ 円支払ったあと，以下の $ 3 $ つのシナリオが等確率で起こります． - シナリオ $ 1 $: $ 3 $ 円失ったあと，$ \min(3,2x)=3 $ 円が補填される． 最終的にすぬけくんが失う金額は，$ x+A_1-\min(A_1,2x)=1.5+3-3=1.5 $ 円である． - シナリオ $ 2 $: $ 1 $ 円失ったあと，$ \min(1,2x)=1 $ 円が補填される． 最終的にすぬけくんが失う金額は，$ x+A_2-\min(A_2,2x)=1.5+1-1=1.5 $ 円である． - シナリオ $ 3 $: $ 4 $ 円失ったあと，$ \min(4,2x)=3 $ 円が補填される． 最終的にすぬけくんが失う金額は，$ x+A_3-\min(A_3,2x)=1.5+4-3=2.5 $ 円である． よって，失う金額の期待値は，$ (1.5+1.5+2.5)/3=1.833333\cdots $ です．

## 样例 #1

### 输入

```
3

3 1 4
```

### 输出

```
1.83333333333333333333
```

## 样例 #2

### 输入

```
10

866111664 178537096 844917655 218662351 383133839 231371336 353498483 865935868 472381277 579910117
```

### 输出

```
362925658.10000000000000000000
```



---

---
title: "[ARC124B] XOR Matching 2"
layout: "post"
diff: 普及/提高-
pid: AT_arc124_b
tag: []
---

# [ARC124B] XOR Matching 2

## 题目描述

[problemUrl]: https://atcoder.jp/contests/arc124/tasks/arc124_b

非負整数のみからなる長さ $ N $ の数列 $ a,b $ が与えられます。$ a,b $ の $ i $ 番目の要素はそれぞれ $ a_i,\ b_i $ です。

非負整数 $ x $ が以下の条件を満たすとき、$ x $ を **よい数** と呼びます。

- 条件：$ b $ を並べ替えて、$ 1\ \leq\ i\ \leq\ N $ を満たすどの整数 $ i $ についても $ a_i\ \text{\ XOR\ }\ b_i\ =\ x $ が成立するようにすることができる。ここで、$ \text{XOR\ } $ はビットごとの排他的論理和である。

よい数を小さい方からすべて列挙してください。

 $ \text{\ XOR\ } $ とは 整数 $ x,\ y $ のビットごとの排他的論理和 $ x\ \text{\ XOR\ }\ y $ は、以下のように定義されます。

- $ x\ \text{\ XOR\ }\ y $ を二進表記した際の $ 2^k $ ($ k\ \geq\ 0 $) の位の数は、$ x,\ y $ を二進表記した際の $ 2^k $ の位の数のうち一方のみが $ 1 $ であれば $ 1 $、そうでなければ $ 0 $ である。
 
 例えば、$ 3\ \text{\ XOR\ }\ 5\ =\ 6 $ となります (二進表記すると: $ 011\ \text{\ XOR\ }\ 101\ =\ 110 $)。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ a_1 $ $ \cdots $ $ a_N $ $ b_1 $ $ \cdots $ $ b_N $

## 输出格式

$ 1 $ 行目によい数の個数 $ K $ を出力せよ。 続けて $ K $ 行出力せよ。続く $ K $ 行の $ i $ 行目には小さい方から $ i $ 番目のよい数を出力せよ。

## 说明/提示

### 制約

- 与えられる入力は全て整数
- $ 1\ \leq\ N\ \leq\ 2000 $
- $ 0\ \leq\ a_i,\ b_i\ <\ 2^{30} $

### Sample Explanation 1

\- $ b $ を $ (4,\ 7,\ 6) $ と並び替えたとき、$ a_1\ \text{\ XOR\ }\ b_1\ =\ a_2\ \text{\ XOR\ }\ b_2\ =\ a_3\ \text{\ XOR\ }\ b_3\ =\ 5 $ となるため、$ 5 $ はよい数です。他によい数はありません。

## 样例 #1

### 输入

```
3

1 2 3

6 4 7
```

### 输出

```
1

5
```

## 样例 #2

### 输入

```
2

0 1

0 2
```

### 输出

```
0
```

## 样例 #3

### 输入

```
24

14911005 70152939 282809711 965900047 168465665 337027481 520073861 20800623 934711525 944543101 522277111 580736275 468493313 912814743 99651737 439502451 365446123 198473587 285587229 253330309 591640417 761745547 247947767 750367481

805343020 412569406 424258892 329301584 123050452 1042573510 1073384116 495212986 158432830 145726540 623594202 836660574 380872916 722447664 230460104 718360386 620079272 109804454 60321058 38178640 475708360 207775930 393038502 310271010
```

### 输出

```
8

107543995

129376201

139205201

160626723

312334911

323172429

481902037

493346727
```



---

---
title: "[ARC125B] Squares"
layout: "post"
diff: 普及/提高-
pid: AT_arc125_b
tag: []
---

# [ARC125B] Squares

## 题目描述

[problemUrl]: https://atcoder.jp/contests/arc125/tasks/arc125_b

整数 $ N $ が与えられます． 以下の条件を満たす整数の組 $ (x,y) $ の個数を $ 998244353 $ で割った余りを求めてください．

- $ 1\ \leq\ x,y\ \leq\ N $
- $ x^2-y $ は平方数である．（特に，$ 0 $ も平方数とする．）

## 输入格式

入力は以下の形式で標準入力から与えられる．

> $ N $

## 输出格式

答えを出力せよ．

## 说明/提示

### 制約

- $ 1\ \leq\ N\ \leq\ 10^{12} $
- 入力される値はすべて整数である

### Sample Explanation 1

以下の $ 2 $ 通りが考えられます． - $ x=1,y=1 $ - $ x=2,y=3 $

## 样例 #1

### 输入

```
3
```

### 输出

```
2
```

## 样例 #2

### 输入

```
10
```

### 输出

```
8
```

## 样例 #3

### 输入

```
10000000000
```

### 输出

```
52583544
```



---

---
title: "[ARC127A] Leading 1s"
layout: "post"
diff: 普及/提高-
pid: AT_arc127_a
tag: []
---

# [ARC127A] Leading 1s

## 题目描述

[problemUrl]: https://atcoder.jp/contests/arc127/tasks/arc127_a

整数 $ x $ を $ 10 $ 進表記した時，先頭に並ぶ $ 1 $ の個数を $ f(x) $ で表すことにします． 例えば，$ f(1)=1,f(2)=0,f(10)=1,f(11)=2,f(101)=1 $ です．

整数 $ N $ が与えられるので，$ f(1)+f(2)+\cdots+f(N) $ の値を求めてください．

## 输入格式

入力は以下の形式で標準入力から与えられる．

> $ N $

## 输出格式

答えを出力せよ．

## 说明/提示

### 制約

- $ 1\ \leq\ N\ \leq\ 10^{15} $
- 入力される値はすべて整数である

### Sample Explanation 1

$ f(2)=f(3)=\cdots\ =f(9)=0 $ です． 答えは，$ f(1)+f(10)+f(11)=4 $ です．

## 样例 #1

### 输入

```
11
```

### 输出

```
4
```

## 样例 #2

### 输入

```
120
```

### 输出

```
44
```

## 样例 #3

### 输入

```
987654321
```

### 输出

```
123456789
```



---

---
title: "[ARC128B] Balls of Three Colors"
layout: "post"
diff: 普及/提高-
pid: AT_arc128_b
tag: []
---

# [ARC128B] Balls of Three Colors

## 题目描述

[problemUrl]: https://atcoder.jp/contests/arc128/tasks/arc128_b

$ R $ 個の赤いボール，$ G $ 個の緑のボール，$ B $ 個の青いボールがあります． あなたは，以下の操作を好きな回数繰り返すことができます．

- 色の異なる $ 2 $ つのボールを選び，それら両方を残るもう一つの色のボールに変える．

例えば，赤いボールと青いボールを選んだ際は，それら両方を緑のボールに変えます．

あなたの目標は，すべてのボールを同じ色にすることです． 目標が達成可能であるか判定し，また可能であるなら，必要な操作回数の最小値を求めてください．

$ 1 $ つの入力ファイルにつき，$ T $ 個のテストケースを解いてください．

## 输入格式

入力は以下の形式で標準入力から与えられる．

> $ T $ $ case_1 $ $ case_2 $ $ \vdots $ $ case_T $

各ケースは以下の形式で与えられる．

> $ R $ $ G $ $ B $

## 输出格式

各ケースについて，目標が達成不可能な場合は `-1` を，そうでなければ必要な操作回数の最小値を出力せよ．

## 说明/提示

### 制約

- $ 1\ \leq\ T\ \leq\ 100 $
- $ 1\ \leq\ R,G,B\ \leq\ 10^8 $
- 入力される値はすべて整数である

### Sample Explanation 1

例えば，$ case_3 $ については，以下のように操作を行えばよいです． - 緑のボールと青いボールを選び，それら両方を赤いボールに変える - 赤いボールと青いボールを選び，それら両方を緑のボールに変える - 赤いボールと青いボールを選び，それら両方を緑のボールに変える - 赤いボールと青いボールを選び，それら両方を緑のボールに変える

## 样例 #1

### 输入

```
3

1 2 2

1 2 3

1 2 4
```

### 输出

```
2

-1

4
```



---

---
title: "[ARC129A] Smaller XOR"
layout: "post"
diff: 普及/提高-
pid: AT_arc129_a
tag: []
---

# [ARC129A] Smaller XOR

## 题目描述

[problemUrl]: https://atcoder.jp/contests/arc129/tasks/arc129_a

整数 $ N,L,R $ が与えられます． 以下の条件を両方満たす整数 $ x $ の個数を数えてください．

- $ L\ \leq\ x\ \leq\ R $
- $ (x\ \oplus\ N)\ <\ N $ （ここで $ \oplus $ はビット単位 $ \mathrm{XOR} $ 演算を表す）
 
 ビット単位 $ \mathrm{XOR} $ 演算とは  整数 $ A,\ B $ のビット単位 $ \mathrm{XOR} $ 、$ A\ \oplus\ B $ は、以下のように定義されます。

- $ A\ \oplus\ B $ を二進表記した際の $ 2^k $ ($ k\ \geq\ 0 $) の位の数は、$ A,\ B $ を二進表記した際の $ 2^k $ の位の数のうち一方のみが $ 1 $ であれば $ 1 $、そうでなければ $ 0 $ である。
 
 例えば、$ 3\ \oplus\ 5\ =\ 6 $ となります (二進表記すると: $ 011\ \oplus\ 101\ =\ 110 $)。

## 输入格式

入力は以下の形式で標準入力から与えられる．

> $ N $ $ L $ $ R $

## 输出格式

答えを出力せよ．

## 说明/提示

### 制約

- $ 1\ \leq\ N\ \leq\ 10^{18} $
- $ 1\ \leq\ L\ \leq\ R\ \leq\ 10^{18} $
- 入力される値はすべて整数である

### Sample Explanation 1

$ x=1 $ の場合，$ L\ \leq\ x\ \leq\ R $ は満たしますが，$ (x\ \oplus\ N)\ <\ N $ は満たしません． $ x=2 $ の場合，両方の条件を満たします． 他に条件を満たす $ x $ は存在しません．

## 样例 #1

### 输入

```
2 1 2
```

### 输出

```
1
```

## 样例 #2

### 输入

```
10 2 19
```

### 输出

```
10
```

## 样例 #3

### 输入

```
1000000000000000000 1 1000000000000000000
```

### 输出

```
847078495393153025
```



---

---
title: "[ARC129B] Range Point Distance"
layout: "post"
diff: 普及/提高-
pid: AT_arc129_b
tag: []
---

# [ARC129B] Range Point Distance

## 题目描述

对于一组整数 $l,r,x$，其中 $l \le r$，定义 $dist(l,r,x)$ 为：

- 若 $x < l$，则 $dist(l,r,x) = l - x$
- 若 $l \le x \le r$，则 $dist(l,r,x) = 0$
- 若 $x >r$，则 $dist(l,r,x) = x - r$ 

可以简要理解为 $x$ 在数轴上到区间 $[l,r]$ 的距离。

现在给定 $N$ 对整数，第 $i$ 对整数形如 $(L_i, R_i)$。对于 $k=1,2,\dots,N$，分别求解下面的问题：

- 自由选择一个整数 $x$，计算 $max_{i=1}^k dist(L_i,R_i,x)$，求其可能的最小值。

## 输入格式

第一行一个整数 $N$，表示给定 $N$ 对整数。

接下来 $N$ 行每行两个整数 $L_i,R_i$。

## 输出格式

共 $N$ 行，**依次输出** $k=1,2,\dots,N$ 时的答案，输出一个答案换一行。

## 说明/提示

- $1 \le N \le 2 \times 10^5$
- $1 \le L_i \le R_i \le 10^9$
- 所有输入均为整数。

## 样例 #1

### 输入

```
3

1 3

2 4

5 6
```

### 输出

```
0

0

1
```

## 样例 #2

### 输入

```
10

64 96

30 78

52 61

18 28

9 34

42 86

11 49

1 79

13 59

70 95
```

### 输出

```
0

0

2

18

18

18

18

18

18

21
```



---

---
title: "[ARC131C] Zero XOR"
layout: "post"
diff: 普及/提高-
pid: AT_arc131_c
tag: []
---

# [ARC131C] Zero XOR

## 题目描述

[problemUrl]: https://atcoder.jp/contests/arc131/tasks/arc131_c

机の上に $ N $ 枚のクッキーがあります。クッキーの表面にはそれぞれ正の整数 $ A_1,\ A_2,\ \dots,\ A_N $ が書かれており、これらはすべて異なります。

このクッキーを使って 2 人でゲームを行います。このゲームでは、各プレイヤーは次の行動を交互に行います。

> 机にあるクッキーを 1 枚選んで食べる。  
>  その際に、机に残ったクッキーに書かれた整数の $ \mathrm{XOR} $ が $ 0 $ になったならば、そのプレイヤーは勝利し、ゲームは終了する。

あなたは E869120 君に対戦を申し込みました。あなたは先手で、E869120 君は後手です。さて、両者が最適に行動したときに、あなたは E869120 君に勝ちますか？

  $ \mathrm{XOR} $ とは  整数 $ A,\ B $ のビット単位 XOR、$ A\ \mathrm{XOR}\ B $ は、以下のように定義されます。

- $ A\ \mathrm{XOR}\ B $ を二進表記した際の $ 2^k $ ($ k\ \geq\ 0 $) の位の数は、$ A,\ B $ を二進表記した際の $ 2^k $ の位の数のうち一方のみが $ 1 $ であれば $ 1 $、そうでなければ $ 0 $ である。
 
 例えば、$ 3\ \mathrm{XOR}\ 5\ =\ 6 $ となります (二進表記すると: $ 011\ \mathrm{XOR}\ 101\ =\ 110 $)。  
 一般に、$ k $ 個の整数 $ p_1,\ p_2,\ p_3,\ \dots,\ p_k $ のビット単位 XOR は $ (\dots\ ((p_1\ \mathrm{XOR}\ p_2)\ \mathrm{XOR}\ p_3)\ \mathrm{XOR}\ \dots\ \mathrm{XOR}\ p_k) $ と定義され、これは $ p_1,\ p_2,\ p_3,\ \dots\ p_k $ の順番によらないことが証明できます。特に $ k\ =\ 0 $ の場合、$ \mathrm{XOR} $ は $ 0 $ となります。

## 输入格式

入力は以下の形式で標準入力から与えられます。

> $ N $ $ A_1 $ $ A_2 $ $ \cdots $ $ A_N $

## 输出格式

両者が最適に行動したときにあなたが勝つなら `Win`、負けるなら `Lose` と出力してください。

## 说明/提示

### 制約

- $ 1\ \leq\ N\ \leq\ 400000 $
- $ 1\ \leq\ A_i\ \leq\ 10^9\ (1\ \leq\ i\ \leq\ N) $
- $ A_1,\ A_2,\ \dots,\ A_N $ はすべて異なる
- $ A_1,\ A_2,\ \dots,\ A_N $ の $ \mathrm{XOR} $ は $ 0 $ ではない
- 入力はすべて整数

### Sample Explanation 1

この例では、あなたがどんな方法を使っても、E869120 君が最適に行動し続ければ負けてしまいます。 例えば、最初に $ 11 $ が書かれたクッキーを食べるとしましょう。すると、次に E869120 君が $ 9 $ が書かれたクッキーを食べることで、残ったクッキーに書かれた数 $ 14,\ 3,\ 5,\ 8 $ の $ \mathrm{XOR} $ が $ 0 $ になるので、E869120 君が勝ちます。 それ以外の行動をとっても、最終的には E869120 君が勝ちます。

### Sample Explanation 2

この例では、あなたは最初のターンで $ 131 $ が書かれたクッキーを食べることしかできません。すると、机の上からクッキーがなくなるので、残ったクッキーに書かれた数の $ \mathrm{XOR} $ は $ 0 $ になります。したがって、E869120 君が何もできないまま、あなたが勝ちます。

## 样例 #1

### 输入

```
6

9 14 11 3 5 8
```

### 输出

```
Lose
```

## 样例 #2

### 输入

```
1

131
```

### 输出

```
Win
```

## 样例 #3

### 输入

```
8

12 23 34 45 56 78 89 98
```

### 输出

```
Win
```



---

---
title: "[ARC132B] Shift and Reverse"
layout: "post"
diff: 普及/提高-
pid: AT_arc132_b
tag: []
---

# [ARC132B] Shift and Reverse

## 题目描述

[problemUrl]: https://atcoder.jp/contests/arc132/tasks/arc132_b

$ 1,\dots,\ n $ の順列 $ p_1,\dots,p_n $ が与えられます。 この順列に対して以下の操作を、好きな順で何度でも行えます。

- 全体をひっくりかえす。つまり、$ p_1,p_2,\dots,p_n $ を $ p_n,p_{n-1},\dots,p_1 $ に並び替える。
- 先頭の項を末尾に移動させる。つまり、$ p_1,\ p_2,\ \dots,p_n $ を $ p_2,\dots,\ p_n,\ p_1 $ に並び替える。

順列を昇順に並び替えるのに必要な操作回数の最小値を求めてください。 ただし、与えられる入力について、これらの操作によって順列を昇順に並び替えられることが保証されています。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ n $ $ p_1 $ $ \dots $ $ p_n $

## 输出格式

順列を昇順に並び替えるのに必要な操作回数の最小値を出力せよ。

## 说明/提示

### 制約

- $ 2\ \leq\ n\ \leq\ 10^5 $
- $ p_1,\dots,p_n $ は $ 1,\dots,n $ の順列
- 問題文中の操作によって $ p_1,\dots,p_n $ を昇順に並び替えられる

### Sample Explanation 1

次のように操作すると $ 2 $ 回で昇順に並び替えできます。 1. 先頭の項を末尾に移動させ、 $ 3,\ 2,\ 1 $ に並び替える。 2. 全体をひっくりかえし、$ 1,\ 2,\ 3 $ に並び替える。 $ 2 $ 回未満の操作で昇順に並び替えることはできないため、答えは $ 2 $ です。

### Sample Explanation 2

どちらの操作をしても $ 1 $ 回で昇順に並び替えできます。 $ 1 $ 回未満の操作で昇順に並び替えることはできないため、答えは $ 1 $ です。

### Sample Explanation 3

次のように操作すると $ 3 $ 回で昇順に並び替えできます。 1. 全体をひっくりかえし、$ 1,10,9,8,7,6,5,4,3,2 $ に並び替える。 2. 先頭の項を末尾に移動させ、 $ 10,9,8,7,6,5,4,3,2,1 $ に並び替える。 3. 全体をひっくりかえし、 $ 1,2,3,4,5,6,7,8,9,10 $ に並び替える。 $ 3 $ 回未満の操作で昇順に並び替えることはできないため、答えは $ 3 $ です。

### Sample Explanation 4

一度も操作する必要がありません。

## 样例 #1

### 输入

```
3

1 3 2
```

### 输出

```
2
```

## 样例 #2

### 输入

```
2

2 1
```

### 输出

```
1
```

## 样例 #3

### 输入

```
10

2 3 4 5 6 7 8 9 10 1
```

### 输出

```
3
```

## 样例 #4

### 输入

```
12

1 2 3 4 5 6 7 8 9 10 11 12
```

### 输出

```
0
```



---

---
title: "[ARC134B] Reserve or Reverse"
layout: "post"
diff: 普及/提高-
pid: AT_arc134_b
tag: []
---

# [ARC134B] Reserve or Reverse

## 题目描述

[problemUrl]: https://atcoder.jp/contests/arc134/tasks/arc134_b

長さ $ N $ の文字列 $ s $ が与えられます。 $ s $ の $ i $ 文字目は $ s_i $ と表します。

すぬけ君は以下の手順で $ s $ を変化させます。

- $ (1,2,\ \ldots,\ N) $ の長さが**偶数の**（連続するとは限らない）部分列 $ x=(x_1,\ x_2,\ \ldots,\ x_{2k}) $ を選ぶ($ k=0 $ でも構わない)。
- $ s_{x_1} $ と $ s_{x_{2k}} $ を入れ替える。
- $ s_{x_2} $ と $ s_{x_{2k-1}} $ を入れ替える。
- $ s_{x_3} $ と $ s_{x_{2k-2}} $ を入れ替える。
- $ \vdots $
- $ s_{x_{k}} $ と $ s_{x_{k+1}} $ を入れ替える。

すぬけ君が手順を終えたあとの $ s $ としてありうる文字列のうち、辞書順最小のものを求めてください。

 辞書順とは？ 辞書順とは簡単に説明すると「単語が辞書に載っている順番」を意味します。より厳密な説明として、相異なる文字列 $ S $ と文字列 $ T $ の大小を判定するアルゴリズムを以下に説明します。

以下では「 $ S $ の $ i $ 文字目の文字」を $ S_i $ のように表します。また、 $ S $ が $ T $ より辞書順で小さい場合は $ S\ \lt\ T $ 、大きい場合は $ S\ \gt\ T $ と表します。

1. $ S $ と $ T $ のうち長さが短い方の文字列の長さを $ L $ とします。$ i=1,2,\dots,L $ に対して $ S_i $ と $ T_i $ が一致するか調べます。
2. $ S_i\ \neq\ T_i $ である $ i $ が存在する場合、そのような $ i $ のうち最小のものを $ j $ とします。そして、$ S_j $ と $ T_j $ を比較して、 $ S_j $ がアルファベット順で $ T_j $ より小さい場合は $ S\ \lt\ T $ 、大きい場合は $ S\ \gt\ T $ と決定して、アルゴリズムを終了します。
3. $ S_i\ \neq\ T_i $ である $ i $ が存在しない場合、 $ S $ と $ T $ の長さを比較して、$ S $ が $ T $ より短い場合は $ S\ \lt\ T $ 、長い場合は $ S\ \gt\ T $ と決定して、アルゴリズムを終了します。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ s $

## 输出格式

すぬけ君が手順を終えたあとの $ s $ としてありうる文字列のうち、辞書順最小のものを出力せよ。

## 说明/提示

### 制約

- $ 1\ \leq\ N\ \leq\ 2\ \times\ 10^5 $
- $ s $ は長さ $ N $ の英小文字のみからなる文字列

### Sample Explanation 1

\- $ x=(1,3) $ のとき、$ s_{1} $ と $ s_{3} $ のみが入れ替わります。 - 手順を終えたあとの $ s $ は `acdb` となり辞書順最小です。

### Sample Explanation 2

\- $ x=() $ のとき、手順を終えたあとの $ s $ は `ab` となり辞書順最小です。 - $ x $ の長さが $ 0 $ でもよいことに注意してください。

## 样例 #1

### 输入

```
4

dcab
```

### 输出

```
acdb
```

## 样例 #2

### 输入

```
2

ab
```

### 输出

```
ab
```

## 样例 #3

### 输入

```
16

cabaaabbbabcbaba
```

### 输出

```
aaaaaaabbbbcbbbc
```

## 样例 #4

### 输入

```
17

snwfpfwipeusiwkzo
```

### 输出

```
effwpnwipsusiwkzo
```



---

---
title: "[ARC135B] Sum of Three Terms"
layout: "post"
diff: 普及/提高-
pid: AT_arc135_b
tag: []
---

# [ARC135B] Sum of Three Terms

## 题目描述

[problemUrl]: https://atcoder.jp/contests/arc135/tasks/arc135_b

項数 $ N $ の整数列 $ S\ =\ (S_1,\ \ldots,\ S_N) $ が与えられます。 項数 $ N+2 $ の整数列 $ A\ =\ (A_1,\ \ldots,\ A_{N+2}) $ であって、次の条件を満たすものが存在するか否かを判定してください。

- 任意の $ i $ ($ 1\leq\ i\leq\ N+2 $) に対して $ 0\leq\ A_i $ が成り立つ。
- 任意の $ i $ ($ 1\leq\ i\leq\ N $) に対して、$ S_i\ =\ A_{i}\ +\ A_{i+1}\ +\ A_{i+2} $ が成り立つ。

存在する場合には、そのようなものをひとつ出力してください。

## 输入格式

入力は以下の形式で標準入力から与えられます。

> $ N $ $ S_1 $ $ \ldots $ $ S_N $

## 输出格式

問題の条件を満たす整数列 $ A $ が存在するならば `Yes` を、そうでなければ `No` を出力してください。 `Yes` の場合には、$ 2 $ 行目にそのような整数列 $ A $ の各要素を、空白で区切って $ 1 $ 行で出力してください。

> $ A_1 $ $ \ldots $ $ A_{N+2} $

条件を満たす整数列が複数存在する場合は、どれを出力しても正解となります。

## 说明/提示

### 制約

- $ 1\leq\ N\leq\ 3\times\ 10^5 $
- $ 0\leq\ S_i\leq\ 10^9 $

### Sample Explanation 1

以下のように、任意の $ i $ ($ 1\leq\ i\leq\ N $) に対して $ S_i\ =\ A_i\ +\ A_{i+1}\ +\ A_{i+2} $ が成り立つことが確認できます。 - $ 6\ =\ 0\ +\ 4\ +\ 2 $。 - $ 9\ =\ 4\ +\ 2\ +\ 3 $。 - $ 6\ =\ 2\ +\ 3\ +\ 1 $。 - $ 6\ =\ 3\ +\ 1\ +\ 2 $。 - $ 5\ =\ 1\ +\ 2\ +\ 2 $。

## 样例 #1

### 输入

```
5

6 9 6 6 5
```

### 输出

```
Yes

0 4 2 3 1 2 2
```

## 样例 #2

### 输入

```
5

0 1 2 1 0
```

### 输出

```
No
```

## 样例 #3

### 输入

```
1

10
```

### 输出

```
Yes

0 0 10
```



---

---
title: "[ARC137B] Count 1's"
layout: "post"
diff: 普及/提高-
pid: AT_arc137_b
tag: []
---

# [ARC137B] Count 1's

## 题目描述

[problemUrl]: https://atcoder.jp/contests/arc137/tasks/arc137_b

$ 0,1 $ からなる長さ $ N $ の整数列 $ A=(A_1,A_2,\cdots,A_N) $ が与えられます．

あなたはこれから，次の操作をちょうど $ 1 $ 回行います．

- $ A $ の**連続する**部分列を選び，そこに含まれる要素を flip する．つまり，$ 0 $ ならば $ 1 $ に変え，$ 1 $ ならば $ 0 $ に変える． なお，ここで選ぶ部分列は空であることも許され，その場合 $ A $ の要素は全く変化しない．

あなたのスコアは，$ A $ に含まれる $ 1 $ の個数です． あなたが取るスコアとしてあり得る値が何通りあるか求めてください．

## 输入格式

入力は以下の形式で標準入力から与えられる．

> $ N $ $ A_1 $ $ A_2 $ $ \cdots $ $ A_N $

## 输出格式

答えを出力せよ．

## 说明/提示

### 制約

- $ 1\ \leq\ N\ \leq\ 3\ \times\ 10^5 $
- $ 0\ \leq\ A_i\ \leq\ 1 $
- 入力される値はすべて整数

### Sample Explanation 1

スコアとしてあり得る値は，$ 0,1,2,3 $ の $ 4 $ 通りです． 例えば，$ A $ の $ 2 $ 番目から $ 4 $ 番目までの要素を flip すると，$ A=(0,0,0,1) $ となり，スコアは $ 1 $ になります．

## 样例 #1

### 输入

```
4

0 1 1 0
```

### 输出

```
4
```

## 样例 #2

### 输入

```
5

0 0 0 0 0
```

### 输出

```
6
```

## 样例 #3

### 输入

```
6

0 1 0 1 0 1
```

### 输出

```
3
```



---

---
title: "[ARC138A] Larger Score"
layout: "post"
diff: 普及/提高-
pid: AT_arc138_a
tag: []
---

# [ARC138A] Larger Score

## 题目描述

[problemUrl]: https://atcoder.jp/contests/arc138/tasks/arc138_a

長さ $ N $ の整数列 $ A=(A_1,A_2,\cdots,A_N) $ があります． 以降この問題では，$ A $ の先頭 $ K $ 項の和を **スコア** と呼ぶことにします． また，入力で与えられた $ A $ のスコアを $ s $ と置くことにします．

あなたは，以下の操作を好きな回数繰り返すことができます．

- $ A $ のある隣接する $ 2 $ 要素を選び，それらの値を入れ替える．

あなたの目標は，スコアを $ s+1 $ 以上にすることです． 目標が達成可能であるかどうか判定し，また可能であるなら必要な最小の操作回数を求めてください．

## 输入格式

入力は以下の形式で標準入力から与えられる．

> $ N $ $ K $ $ A_1 $ $ A_2 $ $ \cdots $ $ A_N $

## 输出格式

目標が達成可能でない場合，`-1` を出力せよ． 可能である場合，必要な最小の操作回数を出力せよ．

## 说明/提示

### 制約

- $ 2\ \leq\ N\ \leq\ 4\ \times\ 10^5 $
- $ 1\ \leq\ K\ \leq\ N-1 $
- $ 1\ \leq\ A_i\ \leq\ 10^9 $
- 入力される値はすべて整数

### Sample Explanation 1

まず，$ s=2+1=3 $ です． 以下のように操作することで，スコアを $ 4 $ 以上にすることができます． - $ (2,1,1,2)\ \to\ (A_3 $ と $ A_4 $ の値を入れ替える $ )\to\ (2,1,2,1)\ \to\ (A_2 $ と $ A_3 $ の値を入れ替える $ )\to\ (2,2,1,1) $ $ 1 $ 回の操作では目標を達成できないため，必要な最小の操作回数は $ 2 $ になります．

## 样例 #1

### 输入

```
4 2

2 1 1 2
```

### 输出

```
2
```

## 样例 #2

### 输入

```
3 1

3 2 1
```

### 输出

```
-1
```

## 样例 #3

### 输入

```
20 13

90699850 344821203 373822335 437633059 534203117 523743511 568996900 694866636 683864672 836230375 751240939 942020833 865334948 142779837 22252499 197049878 303376519 366683358 545670804 580980054
```

### 输出

```
13
```



---

---
title: "[ARC138B] 01 Generation"
layout: "post"
diff: 普及/提高-
pid: AT_arc138_b
tag: []
---

# [ARC138B] 01 Generation

## 题目描述

[problemUrl]: https://atcoder.jp/contests/arc138/tasks/arc138_b

すぬけくんは，$ 0 $ と $ 1 $ からなる長さ $ N $ の整数列を作ろうとしています． 今すぬけ君は空の数列 $ x $ を持っており，これから以下の $ 2 $ 種類の操作を好きな順番で $ N $ 回行います．

- 操作A: $ x $ の要素をすべて flip する．つまり，$ 0 $ ならば $ 1 $ に変え，$ 1 $ ならば $ 0 $ に変える． その後，$ x $ の先頭に $ 0 $ を追加する．
- 操作B: $ x $ の末尾に $ 0 $ を追加する．

$ 0 $ と $ 1 $ からなる長さ $ N $ の整数列 $ A=(A_1,A_2,\cdots,A_N) $ が与えられます． $ x $ を $ A $ に一致させることが可能かどうか判定してください．

## 输入格式

入力は以下の形式で標準入力から与えられる．

> $ N $ $ A_1 $ $ A_2 $ $ \cdots $ $ A_N $

## 输出格式

$ x $ を $ A $ に一致させることが可能ならば `Yes` を，不可能ならば `No` を出力せよ．

## 说明/提示

### 制約

- $ 1\ \leq\ N\ \leq\ 2\ \times\ 10^5 $
- $ 0\ \leq\ A_i\ \leq\ 1 $
- 入力される値はすべて整数

### Sample Explanation 1

以下のように操作すればよいです． - 始状態：$ x=() $ - 操作Aを行う．$ x=(0) $ となる． - 操作Bを行う．$ x=(0,0) $ となる． - 操作Aを行う．$ x=(0,1,1) $ となる． - 操作Bを行う．$ x=(0,1,1,0) $ となる．

## 样例 #1

### 输入

```
4

0 1 1 0
```

### 输出

```
Yes
```

## 样例 #2

### 输入

```
4

1 0 0 0
```

### 输出

```
No
```

## 样例 #3

### 输入

```
4

0 0 0 1
```

### 输出

```
No
```



---

---
title: "[ARC140A] Right String"
layout: "post"
diff: 普及/提高-
pid: AT_arc140_a
tag: []
---

# [ARC140A] Right String

## 题目描述

[problemUrl]: https://atcoder.jp/contests/arc140/tasks/arc140_a

英小文字からなる文字列 $ T $ に対して次の問題を考え、その答えを $ f(T) $ とします。

> $ T $ の先頭の文字を削除し末尾に追加する操作を任意の回数行うことによって作ることのできる文字列の種類数を求めてください。

英小文字からなる長さ $ N $ の文字列 $ S $ が与えられます。あなたは以下の操作を $ K $ 回以下行うことが出来ます。($ 1 $ 回も行わなくてもよいです。)

- $ S $ の文字を $ 1 $ 個選び、任意の英小文字に変更する。

操作終了後の $ f(S) $ の値としてあり得る最小値を求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ K $ $ S $

## 输出格式

答えを出力せよ。

## 说明/提示

### 制約

- $ 1\ \le\ N\ \le\ 2000 $
- $ 0\ \le\ K\ \le\ N $
- $ S $ は英小文字からなる長さ $ N $ の文字列である。
- $ N,K $ は整数である。

### Sample Explanation 1

$ 1 $ 回目の操作で $ 4 $ 文字目を `c` から `b` に変更すると $ S= $ `abab` となり、$ f(S)=2 $ となります。 $ f(S) $ を $ 1 $ 回以下の操作で $ 1 $ 以下にすることはできないため、答えは $ 2 $ です。

## 样例 #1

### 输入

```
4 1

abac
```

### 输出

```
2
```

## 样例 #2

### 输入

```
10 0

aaaaaaaaaa
```

### 输出

```
1
```

## 样例 #3

### 输入

```
6 1

abcaba
```

### 输出

```
3
```



---

---
title: "[ARC140B] Shorten ARC"
layout: "post"
diff: 普及/提高-
pid: AT_arc140_b
tag: []
---

# [ARC140B] Shorten ARC

## 题目描述

---

给出一个仅由 $A,R,C$ 组成的长度为 $n$ $(1\le n\le 2\times 10^5)$ 的字符串 $S$，您可以进行操作：

- 如果进行第奇数次操作，您需要用 $R$ 替换一次 $S$ 中的任意一个子串 $ARC$

- 如果进行第偶数次操作，您需要用 $AC$ 替换一次 $S$ 中的任意一个子串 $ARC$

最多能进行多少次操作？

翻译 by wukaichen888

## 输入格式

输入共两行，第一行含一个正整数 $n$。

第二行包括一个长度为 $n$ 的字符串 $S$。

## 输出格式

一行，表示答案。

## 样例 #1

### 输入

```
6

AARCCC
```

### 输出

```
2
```

## 样例 #2

### 输入

```
5

AAAAA
```

### 输出

```
0
```

## 样例 #3

### 输入

```
9

ARCARCARC
```

### 输出

```
3
```



---

---
title: "[ARC141A] Periodic Number"
layout: "post"
diff: 普及/提高-
pid: AT_arc141_a
tag: []
---

# [ARC141A] Periodic Number

## 题目描述

[problemUrl]: https://atcoder.jp/contests/arc141/tasks/arc141_a

正整数 $ n $ に対し、$ n $ を十進法表記した文字列を $ \mathrm{str}(n) $ で表します。

正整数 $ n $ について、ある正整数 $ m $ が存在して $ \mathrm{str}(n) $ が $ \mathrm{str}(m) $ を $ 2 $ 個以上連結したものになっているとき、 $ n $ は「周期的な数」であるといいます。たとえば $ 11,\ 1212,\ 123123123 $ は「周期的な数」です。

$ 11 $ 以上の正整数 $ N $ が与えられます。 $ N $ 以下の「周期的な数」の最大値を求めてください。 $ N $ 以下の「周期的な数」は $ 1 $ つ以上存在することが示せます。

$ T $ 個のテストケースが与えられるので、それぞれについて答えを求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられます。

> $ T $ $ \mathrm{case}_1 $ $ \vdots $ $ \mathrm{case}_T $

各ケースは以下の形式で与えられます。

> $ N $

## 输出格式

$ T $ 行出力してください。$ i $ 行目には $ i $ 番目のテストケースに対する答えを出力してください。

## 说明/提示

### 制約

- $ 1\ \leq\ T\ \leq\ 10^4 $
- $ 11\ \leq\ N\ <\ 10^{18} $
- 入力される値はすべて整数

### Sample Explanation 1

$ 1 $ 個目のテストケースについて、 $ 1412 $ 以下の「周期的な数」にはたとえば $ 11,\ 222,\ 1212,\ 1313 $ などが考えられますが、このうち最大のものは $ 1313 $ です。

## 样例 #1

### 输入

```
3

1412

23

498650499498649123
```

### 输出

```
1313

22

498650498650498650
```



---

---
title: "[ARC141B] Increasing Prefix XOR"
layout: "post"
diff: 普及/提高-
pid: AT_arc141_b
tag: []
---

# [ARC141B] Increasing Prefix XOR

## 题目描述

[problemUrl]: https://atcoder.jp/contests/arc141/tasks/arc141_b

正整数 $ N,\ M $ が与えられます。

長さ $ N $ の正整数列 $ A=(A_1,\ A_2,\ \dots,\ A_N) $ であって、以下の条件を満たすものの個数を $ 998244353 $ で割った余りを求めてください。

- $ 1\ \leq\ A_1\ <\ A_2\ <\ \dots\ <\ A_N\ \leq\ M $
- $ B_i\ =\ A_1\ \oplus\ A_2\ \oplus\ \dots\ \oplus\ A_i $ としたとき、 $ B_1\ <\ B_2\ <\ \dots\ <\ B_N $

ただしここで、 $ \oplus $ はビット単位 $ \mathrm{XOR} $ 演算を表します。

  ビット単位 $ \mathrm{XOR} $ 演算とは  非負整数 $ A,\ B $ のビット単位 $ \mathrm{XOR} $ 、$ A\ \oplus\ B $ は、以下のように定義されます。

- $ A\ \oplus\ B $ を二進表記した際の $ 2^k $ ($ k\ \geq\ 0 $) の位の数は、$ A,\ B $ を二進表記した際の $ 2^k $ の位の数のうち一方のみが $ 1 $ であれば $ 1 $、そうでなければ $ 0 $ である。
 
 例えば、$ 3\ \oplus\ 5\ =\ 6 $ となります (二進表記すると: $ 011\ \oplus\ 101\ =\ 110 $)。  
 一般に $ k $ 個の非負整数 $ p_1,\ p_2,\ p_3,\ \dots,\ p_k $ のビット単位 $ \mathrm{XOR} $ は $ (\dots\ ((p_1\ \oplus\ p_2)\ \oplus\ p_3)\ \oplus\ \dots\ \oplus\ p_k) $ と定義され、これは $ p_1,\ p_2,\ p_3,\ \dots,\ p_k $ の順番によらないことが証明できます。

## 输入格式

入力は以下の形式で標準入力から与えられます。

> $ N $ $ M $

## 输出格式

答えを出力してください。

## 说明/提示

### 制約

- $ 1\ \leq\ N\ \leq\ M\ <\ 2^{60} $
- 入力される値はすべて整数

### Sample Explanation 1

例えば $ (A_1,\ A_2)=(1,\ 3) $ とすると $ A_1\ <\ A_2 $ であり、$ B_1=A_1=1,\ B_2=A_1\oplus\ A_2=2 $ より $ B_1\ <\ B_2 $ が成り立つので条件を満たします。 この他には $ (A_1,\ A_2)=(1,\ 2),\ (1,\ 4),\ (2,\ 4),\ (3,\ 4) $ が条件を満たします。

## 样例 #1

### 输入

```
2 4
```

### 输出

```
5
```

## 样例 #2

### 输入

```
4 4
```

### 输出

```
0
```

## 样例 #3

### 输入

```
10 123456789
```

### 输出

```
205695670
```



---

---
title: "[ARC144B] Gift Tax"
layout: "post"
diff: 普及/提高-
pid: AT_arc144_b
tag: []
---

# [ARC144B] Gift Tax

## 题目描述

[problemUrl]: https://atcoder.jp/contests/arc144/tasks/arc144_b

$ a\leq\ b $ を満たす正整数 $ a,\ b $ および，正整数列 $ A\ =\ (A_1,\ A_2,\ \ldots,\ A_N) $ が与えられます．

あなたはこの数列に対して，以下の操作を何度でも行うことができます（$ 0 $ 回でもよいです）：

- 相異なる添字 $ i,\ j $ ($ 1\leq\ i,\ j\ \leq\ N $) を選ぶ．$ A_i $ に $ a $ を加え，$ A_j $ から $ b $ を引く．

操作後の $ \min(A_1,\ A_2,\ \ldots,\ A_N) $ としてありうる最大値を求めてください．

## 输入格式

入力は以下の形式で標準入力から与えられます．

> $ N $ $ a $ $ b $ $ A_1 $ $ A_2 $ $ \ldots $ $ A_N $

## 输出格式

操作後の $ \min(A_1,\ A_2,\ \ldots,\ A_N) $ としてありうる最大値を出力してください．

## 说明/提示

### 制約

- $ 2\leq\ N\leq\ 3\times\ 10^5 $
- $ 1\leq\ a\leq\ b\leq\ 10^9 $
- $ 1\leq\ A_i\leq\ 10^{9} $

### Sample Explanation 1

例えば次のように操作を行うことで， $ \min(A_1,\ A_2,\ A_3)\ =\ 5 $ を達成できます． - $ i\ =\ 1,\ j\ =\ 3 $ として操作を行う．$ A $ は $ (3,\ 5,\ 7) $ に変化する． - $ i\ =\ 1,\ j\ =\ 3 $ として操作を行う．$ A $ は $ (5,\ 5,\ 5) $ に変化する．

### Sample Explanation 2

例えば次のように操作を行うことで， $ \min(A_1,\ A_2,\ A_3)\ =\ 3 $ を達成できます． - $ i\ =\ 1,\ j\ =\ 3 $ として操作を行う．$ A $ は $ (13,\ 1,\ -1) $ に変化する． - $ i\ =\ 2,\ j\ =\ 1 $ として操作を行う．$ A $ は $ (10,\ 3,\ -1) $ に変化する． - $ i\ =\ 3,\ j\ =\ 1 $ として操作を行う．$ A $ は $ (7,\ 3,\ 1) $ に変化する． - $ i\ =\ 3,\ j\ =\ 1 $ として操作を行う．$ A $ は $ (4,\ 3,\ 3) $ に変化する．

### Sample Explanation 3

一度も操作を行わないことにより， $ \min(A_1,\ A_2,\ A_3)\ =\ 5 $ を達成できます．

## 样例 #1

### 输入

```
3 2 2

1 5 9
```

### 输出

```
5
```

## 样例 #2

### 输入

```
3 2 3

11 1 2
```

### 输出

```
3
```

## 样例 #3

### 输入

```
3 1 100

8 5 6
```

### 输出

```
5
```

## 样例 #4

### 输入

```
6 123 321

10 100 1000 10000 100000 1000000
```

### 输出

```
90688
```



---

---
title: "[ARC145B] AB Game"
layout: "post"
diff: 普及/提高-
pid: AT_arc145_b
tag: []
---

# [ARC145B] AB Game

## 题目描述

[problemUrl]: https://atcoder.jp/contests/arc145/tasks/arc145_b

以下のゲームをゲーム $ n $ と呼びます。

> Alice と Bob でゲームをします。はじめ $ n $ 個の石があります。
> 
> Alice から始めて、交互に次の操作を行い、操作を行えなくなった方が負けとなります。
> 
> - もし Alice が操作を行うなら、石を $ A $ の正の倍数の個数取り除く。
> - もし Bob が操作を行うなら、石を $ B $ の正の倍数の個数取り除く。

ゲーム $ 1 $、ゲーム $ 2 $、…、ゲーム $ N $ のうち、二人が最適に行動したとき Alice が勝つゲームは何個あるか求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ A $ $ B $

## 输出格式

答えを出力せよ。

## 说明/提示

### 制約

- $ 1\ \leq\ N\ ,A,B\ \leq\ 10^{18} $
- 入力は全て整数

### Sample Explanation 1

ゲーム $ 1 $ では、Alice は操作を行えないため Alice の負けとなります。 ゲーム $ 2 $ では、Alice が石を $ 2 $ 個取ることで Bob は操作を行えなくなり、Alice の勝ちとなります。 ゲーム $ 3 $ では、Alice が石を $ 2 $ 個取り、Bob が石を $ 1 $ 個取るとAlice は操作を行えないため Alice の負けとなります。 ゲーム $ 4 $ では、Alice が石を $ 2\ \times\ 2\ =\ 4 $ 個取ることで Bob は操作を行えなくなり、Alice の勝ちとなります。 以上より、ゲーム $ 1,2,3,4 $ のうちAlice が勝つゲームは $ 2 $ 個です。

## 样例 #1

### 输入

```
4 2 1
```

### 输出

```
2
```

## 样例 #2

### 输入

```
27182818284 59045 23356
```

### 输出

```
10752495144
```



---

---
title: "[ARC146A] Three Cards"
layout: "post"
diff: 普及/提高-
pid: AT_arc146_a
tag: []
---

# [ARC146A] Three Cards

## 题目描述

[problemUrl]: https://atcoder.jp/contests/arc146/tasks/arc146_a

$ N $ 枚のカードがあります。カードには $ 1 $ から $ N $ の番号がついています。

カード $ i $ には正整数 $ A_i $ が書かれています。

この中から $ 3 $ 枚のカードを選び、好きな順で書かれている整数を連結し新しく整数を作ります。例えば、$ 1,23,4 $ が書かれたカードを選んだとき、$ 1234 $ や $ 4231 $ を作ることができます。

作ることのできる整数の最大値を求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ A_1 $ $ A_2 $ $ \dots $ $ A_N $

## 输出格式

答えを出力せよ。

## 说明/提示

### 制約

- $ 3\ \le\ N\ \le\ 2\ \times\ 10^5 $
- $ 1\ \le\ A_i\ <\ 10^6 $
- 入力は全て整数である。

### Sample Explanation 1

$ 4,5,8 $ が書かれたカードを選んだ場合、$ 458,485,548,584,845,854 $ を作ることができます。 $ 855 $ 以上の整数を作ることはできないので解は $ 854 $ です。

## 样例 #1

### 输入

```
5

1 4 3 5 8
```

### 输出

```
854
```

## 样例 #2

### 输入

```
8

813 921 481 282 120 900 555 409
```

### 输出

```
921900813
```



---

---
title: "[ARC147B] Swap to Sort"
layout: "post"
diff: 普及/提高-
pid: AT_arc147_b
tag: []
---

# [ARC147B] Swap to Sort

## 题目描述

现有一个$1$到$N$的排列$ P=(P_1,P_2,\ldots,P_N) $ 。你可以重复执行以下两种操作来使$P$从小到大排序。

- 操作$A:$选择一个整数$i$满足$1\ \leq\ i\ \leq\ N-1$，然后交换$P_i$和$P_{i+1}$。
- 操作$B:$选择一个整数$i$满足$1\ \leq\ i\ \leq\ N-2$，然后交换$P_i$和$P_{i+2}$。

请找出一个满足以下要求的操作序列
* 操作$A$的数量最少
* 操作的总数不超过$10^5$

在题目条件的约束下，我们可以证明合法的解总是存在的

## 输入格式

#### $ N $     
$ P_1 $ $ P_2 $ $ \ldots $ $ P_N $

## 输出格式

设你的答案中的操作次数为$S$。输出有$S+1$行。

第一行包含整数$S$

第$(s+1)(1≤s≤S)$行中应包含以下内容。

- 如果第$s$个操作为$A$,输出`A i`，$i$为此次操作选择的整数
- 如果第$s$个操作为$B$,输出`B i`，$i$为此次操作选择的整数

如果有多个合法解，输出一个即可。

## 样例 #1

### 样例输入 #1

```
4
3 2 4 1
```

### 样例输出 #1

```
4
A 3
B 1
B 2
B 2
```

## 样例 #2

### 样例输入 #2

```
3
1 2 3
```

### 样例输出 #2

```
0
```

## 样例 #3

### 样例输入 #3

```
6
2 1 4 3 6 5
```

### 样例输出 #3

```
3
A 1
A 3
A 5
```

## 说明/提示

- $ 2\ \leq\ N\ \leq\ 400 $
- $ 1\ \leq\ P_i\ \leq\ N\ \,(1\ \leq\ i\ \leq\ N) $
- $ P_i\ \neq\ P_j\ \,(1\ \leq\ i\ <\ j\ \leq\ N) $
- 输入均为正数

## 样例 #1

### 输入

```
4

3 2 4 1
```

### 输出

```
4

A 3

B 1

B 2

B 2
```

## 样例 #2

### 输入

```
3

1 2 3
```

### 输出

```
0
```

## 样例 #3

### 输入

```
6

2 1 4 3 6 5
```

### 输出

```
3

A 1

A 3

A 5
```



---

---
title: "[ARC148B] dp"
layout: "post"
diff: 普及/提高-
pid: AT_arc148_b
tag: []
---

# [ARC148B] dp

## 题目描述

[problemUrl]: https://atcoder.jp/contests/arc148/tasks/arc148_b

`d` と `p` からなる長さ $ L $ の文字列 $ T $ に対して、$ T $ を $ 180 $ 度回転した文字列を $ f(T) $ と表します。より厳密には、$ f(T) $ を次の条件を満たす文字列として定めます。

- $ f(T) $ は `d` と `p` からなる長さ $ L $ の文字列である。
- $ 1\ \leq\ i\ \leq\ L $ であるすべての整数 $ i $ について、$ f(T) $ の $ i $ 文字目は $ T $ の $ L\ +\ 1\ -\ i $ 文字目と異なる。

例えば $ T\ = $ `ddddd` のとき $ f(T)\ = $ `ppppp`, $ T\ = $ `dpdppp` のとき $ f(T)= $ `dddpdp` です。

`d` と `p` からなる長さ $ N $ の文字列 $ S $ が与えられます。  
 あなたは次の操作を **$ 0 $ 回以上 $ 1 $ 回以下**行うことができます。

- $ 1\ \leq\ L\ \leq\ R\ \leq\ N $ である整数の組 $ (L,\ R) $ を $ 1 $ つ選び、$ S $ の $ L $ 文字目から $ R $ 文字目までからなる部分文字列を $ T $ とする。そして、$ S $ の $ L $ 文字目から $ R $ 文字目までを $ f(T) $ に置き換える。

例えば $ S= $ `dpdpp`, $ (L,R)=(2,4) $ の場合、$ T= $ `pdp`, $ f(T)= $ `dpd` なので $ S $ は `ddpdp` に変化します。

最終的な $ S $ としてあり得る文字列のうち辞書順最小のものを出力してください。

  辞書順とは？文字列 $ S\ =\ S_1S_2\ldots\ S_{|S|} $ が文字列 $ T\ =\ T_1T_2\ldots\ T_{|T|} $ より**辞書順で小さい**とは、下記の 1. と 2. のどちらかが成り立つことを言います。 ここで、$ |S|,\ |T| $ はそれぞれ $ S,\ T $ の長さを表します。

1. $ |S|\ \lt\ |T| $ かつ $ S_1S_2\ldots\ S_{|S|}\ =\ T_1T_2\ldots\ T_{|S|} $。
2. ある整数 $ 1\ \leq\ i\ \leq\ \min\lbrace\ |S|,\ |T|\ \rbrace $ が存在して、下記の $ 2 $ つがともに成り立つ。 
  - $ S_1S_2\ldots\ S_{i-1}\ =\ T_1T_2\ldots\ T_{i-1} $
  - $ S_i $ が $ T_i $ よりアルファベット順で小さい文字である。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ S $

## 输出格式

答えを出力せよ。

## 说明/提示

### 制約

- $ 1\ \leq\ N\ \leq\ 5000 $
- $ S $ は `d` と `p` からなる長さ $ N $ の文字列
- $ N $ は整数

### Sample Explanation 1

$ (L,\ R)\ =\ (2,\ 5) $ とします。$ T\ = $ `pdpp`, $ f(T)\ = $ `ddpd` なので、操作後の $ S $ は `dddpdd` になります。 得られる文字列のうち `dddpdd` が辞書順最小なので、これを出力します。

### Sample Explanation 2

操作を行わないことが最適な場合もあります。

## 样例 #1

### 输入

```
6

dpdppd
```

### 输出

```
dddpdd
```

## 样例 #2

### 输入

```
3

ddd
```

### 输出

```
ddd
```

## 样例 #3

### 输入

```
11

ddpdpdppddp
```

### 输出

```
ddddpdpdddp
```



---

---
title: "[ARC150A] Continuous 1"
layout: "post"
diff: 普及/提高-
pid: AT_arc150_a
tag: []
---

# [ARC150A] Continuous 1

## 题目描述

[problemUrl]: https://atcoder.jp/contests/arc150/tasks/arc150_a

`0`, `1`, `?` のみからなる長さ $ N $ の文字列 $ S=S_1S_2\dots\ S_N $ が与えられます。

これから $ S $ に含まれるすべての `?` を `0`, `1` のいずれかに置き換えることで、以下の条件がすべて満たされるようにしたいです。

- $ S $ は `1` をちょうど $ K $ 個含む。
- $ K $ 個の `1` は連続している。すなわち、ある $ i\ (1\ \leq\ i\ \le\ N-K+1) $ があって、$ S_i=S_{i+1}=\dots=S_{i+K-1}= $ `1` が成り立つ。

条件を満たすような `?` の置き換え方がちょうど $ 1 $ 通りであるか判定してください。

$ T $ 個のテストケースが与えられるので、それぞれについて答えを求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられます。

> $ T $ $ \mathrm{case}_1 $ $ \vdots $ $ \mathrm{case}_T $

各ケースは以下の形式で与えられます。

> $ N $ $ K $ $ S $

## 输出格式

$ T $ 行出力してください。$ i $ 行目には $ i $ 番目のテストケースについて、条件を満たすような `?` の置き換え方がちょうど $ 1 $ 通りである場合は `Yes` を、そうでない場合は `No` を出力してください。

## 说明/提示

### 制約

- $ 1\ \leq\ T\ \leq\ 10^5 $
- $ 1\ \leq\ K\ <\ N\ \leq\ 3\ \times\ 10^5 $
- $ S $ は `0`, `1`, `?` のみからなる長さ $ N $ の文字列
- 全テストケースに対する $ N $ の総和は $ 3\ \times\ 10^5 $ 以下

### Sample Explanation 1

$ 1 $ 個目のテストケースについて、例えば $ S $ を `101` に変えることができますが、この場合は `1` が連続していないため、条件を満たしません。 $ S $ が条件を満たすようにするには $ S $ を `110` に変えるしかありません。 $ 2 $ 個目のテストケースについて、 $ S $ が条件を満たすようにするには $ S $ を `1100`, または `0110` に変えればよく、条件を満たすような `?` の置き換え方は $ 2 $ 通りあります。 $ 3 $ 個目のテストケースについて、$ S $ が条件を満たすよう `?` を置き換える方法は存在しません。

## 样例 #1

### 输入

```
4

3 2

1??

4 2

?1?0

6 3

011?1?

10 5

00?1???10?
```

### 输出

```
Yes

No

No

Yes
```



---

---
title: "[ARC182A] Chmax Rush!"
layout: "post"
diff: 普及/提高-
pid: AT_arc182_a
tag: ['分类讨论']
---

# [ARC182A] Chmax Rush!

## 题目描述

[problemUrl]: https://atcoder.jp/contests/arc182/tasks/arc182_a

長さ $ N $ の整数列 $ S $ があります。はじめ、$ S $ の要素はすべて $ 0 $ です。

また、長さ $ Q $ の整数列 $ P=(P_1,P_2,\dots,P_Q) $ と $ V=(V_1,V_2,\dots,V_Q) $ が与えられます。

すぬけ君は、数列 $ S $ に $ Q $ 回の操作を順に行いたいです。$ i $ 回目の操作は以下です。

- 以下のどちらかの操作を行う。
  - $ S_1,S_2,\dots,S_{P_i} $ をすべて $ V_i $ に置き換える。ただし、この操作の前に $ S_1,S_2,\dots,S_{P_i} $ の中に $ V_i $ より真に大きい要素がある場合、すぬけ君は泣き出す。
  - $ S_{P_i},S_{P_i+1},\dots,S_N $ をすべて $ V_i $ に置き換える。ただし、この操作の前に $ S_{P_i},S_{P_i+1},\dots,S_N $ の中に $ V_i $ より真に大きい要素がある場合、すぬけ君は泣き出す。

すぬけ君が泣き出さないように $ Q $ 回の操作をすべて行うことのできるような操作列の個数を $ 998244353 $ で割った余りを求めてください。

ただし、$ 2 $ つの操作列が異なるとは、ある $ 1\leq\ i\leq\ Q $ が存在して、$ i $ 番目の操作でどちらの操作を選択したかが異なることを指します。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ Q $ $ P_1 $ $ V_1 $ $ P_2 $ $ V_2 $ $ \vdots $ $ P_Q $ $ V_Q $

## 输出格式

答えを整数として出力せよ。

## 说明/提示

### 制約

- $ 2\ \leq\ N\ \leq\ 5000 $
- $ 1\ \leq\ Q\ \leq\ 5000 $
- $ 1\ \leq\ P_i\ \leq\ N $
- $ 1\ \leq\ V_i\ \leq\ 10^9 $
- 入力はすべて整数

### Sample Explanation 1

以下のようにするとすぬけ君が泣き出さないように $ 3 $ 回の操作を行うことができます。 - $ S_1 $ を $ 8 $ に置き換える。 - $ S_8 $ を $ 1 $ に置き換える。 - $ S_2,S_3,\dots,S_8 $ を $ 1 $ に置き換える。 これ以外に条件を満たす操作列はないので、$ 1 $ が答えです。例えば、$ 1 $ 回目の操作で $ S_1,S_2,\dots,S_8 $ を $ 8 $ に置き換えると、$ 2 $ 回目の操作でどちらを選んでもすぬけ君が泣き出してしまいます。

### Sample Explanation 2

$ 2 $ 回目までの操作をどのように行っても $ 3 $ 回目の操作ですぬけ君が泣き出してしまいます。

### Sample Explanation 3

$ 998244353 $ で割った余りを求めることを忘れないでください。

## 样例 #1

### 输入

```
8 3
1 8
8 1
2 1
```

### 输出

```
1
```

## 样例 #2

### 输入

```
8 3
8 1
1 8
1 2
```

### 输出

```
0
```

## 样例 #3

### 输入

```
241 82
190 3207371
229 3639088
61 4428925
84 17258698
34 42692503
207 59753183
180 67198566
78 99285033
60 102449991
234 122146510
111 126959145
141 152331579
78 159855439
11 169658471
22 189991287
37 204602946
73 209329065
72 215363269
152 236450854
175 237822921
22 261431608
144 252550201
54 268889550
238 276997357
69 313065279
226 330144323
6 335788783
126 345410019
220 348318997
166 365778763
142 382251905
200 406191336
234 392702679
83 409660987
183 410908761
142 445707116
205 470279207
230 486436406
156 494269002
113 495687706
200 500005738
162 505246499
201 548652987
86 449551554
62 459527873
32 574001635
230 601073337
175 610244315
174 613857555
181 637452273
158 637866397
148 648101378
172 646898076
144 682578257
239 703460335
192 713255331
28 727075136
196 730768166
111 751850547
90 762445737
204 762552166
72 773170159
240 803415865
32 798873367
195 814999380
72 842641864
125 851815348
116 858041919
200 869948671
195 873324903
5 877767414
105 877710280
150 877719360
9 884707717
230 880263190
88 967344715
49 977643789
167 979463984
70 981400941
114 991068035
94 991951735
141 995762200
```

### 输出

```
682155965
```



---

---
title: "[ARC191A] Replace Digits"
layout: "post"
diff: 普及/提高-
pid: AT_arc191_a
tag: []
---

# [ARC191A] Replace Digits

## 题目描述

给出长度为 $ N $ 的字符串 $ S $ 和长度为 $ M $ 的字符串 $ T $。$ S $ 和 $ T $ 都由 `1` 到 `9` 的数字组成。

您将按照 $ k = 1,2, \dots ,M $ 的顺序执行以下操作。
* 选择满足 $ 1 \le i \le N $ 的整数 $ i $。然后用 $ T $ 的第 $ k $ 个字母替换 $ S $ 的第 $ i $ 个字母。

求 $ M $ 次操作结束后的字符串 $ S $ 作为整数的最大值。

## 输入格式

输入以以下形式从标准输入给出：
> $ N $ $ M $ $ S $ $ T $

## 输出格式

输出 $ M $ 次操作结束后的字符串 $ S $ 作为整数的最大值。

## 说明/提示

#### 制约

- $ 1\le\ N,M\le\ 10^6 $
- $ N,M $ 是整数
- $ S $ 是长度 $ N $ 的字符串，由 `1` 到 `9` 的数字组成。
- $ T $ 是长度为 $ M $ 的字符串，由 `1` 到 `9` 的数字组成。


以下操作方法是最佳的。
- 当 $k = 1$ 时，选择 $i = 3$。这时$S = $ `193`。
- 当 $k = 2$ 时，选择 $i = 1$。这时$S = $ `293`。
- 当 $k = 3$ 时，选择 $i = 1$。这时$S = $ `593`。

在这种情况下，$ S $ 作为整数的值是 $ 593 $，这是最大值。

## 样例 #1

### 输入

```
3 3
191
325
```

### 输出

```
593
```

## 样例 #2

### 输入

```
3 9
191
998244353
```

### 输出

```
993
```

## 样例 #3

### 输入

```
11 13
31415926535
2718281828459
```

### 输出

```
98888976555
```



---

---
title: "[ARC191B] XOR = MOD"
layout: "post"
diff: 普及/提高-
pid: AT_arc191_b
tag: []
---

# [ARC191B] XOR = MOD

## 题目描述

[problemUrl]: https://atcoder.jp/contests/arc191/tasks/arc191_b

正整数 $ N,K $ が与えられます。 以下の条件を満たす正整数 $ X $ を **$ N $ と相性の良い数** と呼びます。

- $ X $ と $ N $ の排他的論理和は、$ X $ を $ N $ で割ったあまりと等しい。

$ N $ と相性の良い数が $ K $ 個以上存在するか判定し、存在する場合は $ N $ と相性の良い数のうち $ K $ 番目に小さい値を求めてください。

$ T $ 個のテストケースが与えられるので、それぞれについて答えを求めてください。

  排他的論理和とは  非負整数 $ A,\ B $ の排他的論理和、$ A\ \mathrm{XOR}\ B $ は、以下のように定義されます。

- $ A\ \mathrm{XOR}\ B $ を二進表記した際の $ 2^k $ ($ k\ \geq\ 0 $) の位の数は、$ A,\ B $ を二進表記した際の $ 2^k $ の位の数のうち一方のみが $ 1 $ であれば $ 1 $、そうでなければ $ 0 $ である。
 
 例えば、$ 3\ \mathrm{XOR}\ 5\ =\ 6 $ となります (二進表記すると: $ 011\ \mathrm{XOR}\ 101\ =\ 110 $)。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ T $ $ \text{case}_1 $ $ \text{case}_2 $ $ \vdots $ $ \text{case}_T $

ここで、 $ \text{case}_i $ は $ i $ 番目のテストケースを意味する。

各テストケースは以下の形式で与えられる。

> $ N $ $ K $

## 输出格式

それぞれのテストケースについて、$ N $ と相性の良い数が $ K $ 個以上存在するならば $ K $ 番目に小さい値を、存在しないならば $ -1 $ を出力せよ。

## 说明/提示

### 制約

- $ 1\le\ T\le\ 2\times\ 10^5 $
- $ 1\le\ N,K\le\ 10^9 $
- 入力される値は全て整数

### Sample Explanation 1

$ N=2 $ の場合について考えます。 - $ X=1 $ のとき、 $ X $ と $ N $ の排他的論理和は $ 3 $ 、$ X $ を $ N $ で割ったあまりは $ 1 $ です。したがって、 $ 1 $ は $ N $ と相性の良い数ではありません。 - $ X=2 $ のとき、 $ X $ と $ N $ の排他的論理和は $ 0 $ 、$ X $ を $ N $ で割ったあまりは $ 0 $ です。したがって、 $ 2 $ は $ N $ と相性の良い数です。 - $ X=3 $ のとき、 $ X $ と $ N $ の排他的論理和は $ 1 $ 、$ X $ を $ N $ で割ったあまりは $ 1 $ です。したがって、 $ 3 $ は $ N $ と相性の良い数です。 よって、 $ 2 $ と相性の良い数のうち $ 1 $ 番目に小さい正整数は $ 2 $ 、$ 2 $ 番目に小さい正整数は $ 3 $ です。したがって、 $ \text{case}_1 $ の答えは $ 2 $ 、 $ \text{case}_2 $ の答えは $ 3 $ です。

## 样例 #1

### 输入

```
4
2 1
2 2
1 7
20250126 191
```

### 输出

```
2
3
-1
20381694
```



---

---
title: "A + B"
layout: "post"
diff: 普及/提高-
pid: AT_birthday0410_a
tag: []
---

# A + B

## 题目描述

### 问题描述

> ### A + B 问题
> 
> #### 问题描述
> 
> 编写一个程序来计算两个整数 $A, B$ 的和。
> 
> 保证 $A, B, A + B$ 都能用 $32$ 位有符号整数表示。
>

## 输入格式

> 
> > $A _ 1$ $B _ 1$  
> > $A _ 2$ $B _ 2$  
> > $\dots$  
> > $0$ $0$  
>
> 输入包括最多 $100$ 个测试用例。每个测试用例在一行中给出两个整数 $A$ 和 $B$，用空格分隔。
> 
> 输入以一行 $A = B = 0$ 结束，这一行不需要处理。
> 

> $t$

只有一行包含一个整数 $t$，表示需要找到击败第 $t$ 个回答的测试用例。


### 限制

所有输入数据满足以下限制条件：

- $1 \le t \le 3$

### 评分标准

总共有 3 个测试用例：

- 如果 $t = 1$ 的测试用例正确，将获得 **33 分**。
- 如果 $t = 2$ 的测试用例正确，将获得 **33 分**。
- 如果 $t = 3$ 的测试用例正确，将获得 **34 分**。

---

Translated by User 735713.

## 输出格式

> 
> 对于每个测试用例，输出 $A + B$ 的值，每个结果占一行。

一场比赛的问题 A 已经完成，现在正进入测试阶段。然而，由于疲劳的原因，不幸的是 JAPLJ 在 A + B 问题中出现了 Bug。大学生丸桥，这个比赛的负责人，提出了解决条件……

丸桥说：“你要把错误的源代码改正确，快点！”

你需要为 JAPLJ 的三个错误程序各找出一个能够击败它们的测试用例，并输出这些测试用例。

### 课题

针对 A + B 问题（请参阅问题描述），下面有三个用 C++ 编写的错误程序。为每个错误程序找到一个可以击败它们的测试用例。

更准确地说，对于每个错误程序，请编写一个满足 A + B 问题的描述和输入部分约束的测试用例。当将这个测试用例输入到错误程序中时，该程序将输出错误的答案。编写一个程序来输出这样的测试用例。

回答 1 的源代码:

```cpp
#include <iostream>

using namespace std;

int main()
{
  int A, B;

  while(cin >> A >> B, A+B!=0) {
    cout << A+B << endl;
  }

  return 0;
}
```

回答 2 的源代码：

```cpp
#include <iostream>

using namespace std;

int myAbs(int n)
{
  if(n < 0) return -n;
  else return n;
}

int main()
{
  int A, B;

  while(cin >> A >> B, (A|B) != 0) {
    while(myAbs(A) >= 100000) {
      if(A > 0) {
        B += 100000;
        A -= 100000;
      } else {
        B -= 100000;
        A += 100000;
      }
    }

    if(A > 0) {
      for(int i=0; i<A; ++i) {
        B++;
      }
    } else {
      for(int i=0; i<-A; ++i) {
        B--;
      }
    }

    cout << B << endl;
  }

  return 0;
}
```

回答 3 的源代码：

```cpp
#include<iostream>

using namespace std;

int C[3][32];

int main()
{
  int A, B;

  while(cin >> A >> B, A!=0 || B!=0) {
    for(int i=0; i<32; ++i) {
      C[0][i] = (A >> i) & 1;
      C[1][i] = (B >> i) & 1;
    }

    for(int i=0; i<32; ++i) {
      if(C[0][i] + C[1][i] >= 2) {
        C[C[1][i-1] & 1][i+1]++;
        C[0][i]--;
        C[1][i]--;
      }
      C[2][i] = C[0][i] + C[1][i];
    }

    int R = 0;
    for(int i=0; i<32; ++i) {
      R |= C[2][i] << i;
    }

    cout << R << endl;
  }

  return 0;
}
```


输出一个能够击败第 $t$ 个回答的测试用例。



---

---
title: "Product and GCD"
layout: "post"
diff: 普及/提高-
pid: AT_caddi2018_a
tag: []
---

# Product and GCD

## 题目描述

[problemUrl]: https://atcoder.jp/contests/caddi2018b/tasks/caddi2018_a

$ N $ 個の $ 1 $ 以上の整数 $ a_1,\ a_2,\ ...,\ a_N $ があります． $ a_1,\ a_2,\ ...,\ a_N $ の値はわかりませんが，$ a_1\ \times\ a_2\ \times\ ...\ \times\ a_N\ =\ P $ がわかっています．

$ a_1,\ a_2,\ ...,\ a_N $ の最大公約数として考えられるもののうち，最も大きいものを求めてください．

## 输入格式

入力は以下の形式で標準入力から与えられる．

> $ N $ $ P $

## 输出格式

答えを出力せよ．

## 说明/提示

### 制約

- $ 1\ \leq\ N\ \leq\ 10^{12} $
- $ 1\ \leq\ P\ \leq\ 10^{12} $

### Sample Explanation 1

例えば $ a_1=2,\ a_2=6,\ a_3=2 $ の場合，最大公約数は $ 2 $ となります．

### Sample Explanation 2

$ a_i $ は正の整数なので，$ a_1\ =\ a_2\ =\ a_3\ =\ a_4\ =\ a_5\ =\ 1 $ 以外にはありえません．

## 样例 #1

### 输入

```
3 24
```

### 输出

```
2
```

## 样例 #2

### 输入

```
5 1
```

### 输出

```
1
```

## 样例 #3

### 输入

```
1 111
```

### 输出

```
111
```

## 样例 #4

### 输入

```
4 972439611840
```

### 输出

```
206
```



---

---
title: "Harlequin"
layout: "post"
diff: 普及/提高-
pid: AT_caddi2018_b
tag: []
---

# Harlequin

## 题目描述

[problemUrl]: https://atcoder.jp/contests/caddi2018b/tasks/caddi2018_b

一本のりんごの木があり、$ N $ 色のりんごが実っています。これらのりんごの $ N $ 種類の色には $ 1 $ から $ N $ までの番号が振られており、$ i $ 番の色のりんごは $ a_i $ 個あります。

あなたとダックスフンドのルンルンは、以下の行動を交互に行います (あなたから始めます)。

- 木から $ 1 $ 個以上のりんごを選んで食べる。ただし、一度に選ぶりんごは全て異なる色でなければならない。

木から最後のりんごを食べた者を勝者とします。あなたとルンルンがともに最善を尽くすとき、どちらが勝つでしょうか？

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ a_1 $ $ a_2 $ $ : $ $ a_N $

## 输出格式

あなたが勝つなら `first`、ルンルンが勝つなら `second` と出力せよ。

## 说明/提示

### 制約

- $ 1\ <\ =\ N\ <\ =\ 10^5 $
- $ 1\ <\ =\ a_i\ <\ =\ 10^9 $
- 入力中の値はすべて整数である。

### Sample Explanation 1

$ 1 $ 番の色を赤、$ 2 $ 番の色を青とします。この例では、木には赤いりんご $ 1 $ 個と青いりんご $ 2 $ 個が実っています。 あなたは最初の手番で赤いりんごを食べるべきです。すると、ルンルンは青いりんごのうち片方を食べるほかなく、次の手番であなたがもう片方を食べて勝つことができます。 なお、あなたは最初の手番で両方の色のりんごを $ 1 $ 個ずつ食べることもできます (勝ちには繋がりませんが)。

## 样例 #1

### 输入

```
2

1

2
```

### 输出

```
first
```

## 样例 #2

### 输入

```
3

100000

30000

20000
```

### 输出

```
second
```



---

---
title: "Palindrome-phobia"
layout: "post"
diff: 普及/提高-
pid: AT_cf17_final_b
tag: []
---

# Palindrome-phobia

## 题目描述

[problemUrl]: https://atcoder.jp/contests/cf17-final/tasks/cf17_final_b

すぬけ君は `a`、`b`、`c` の $ 3 $ 種類の文字のみからなる文字列 $ S $ を持っています。

回文恐怖症のすぬけ君は $ S $ の文字を自由に並び替えて、$ 2 $ 文字以上の回文を部分文字列として含まないようにしようと思いました。 これが可能かどうかを判定して下さい。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ S $

## 输出格式

可能な場合は `YES`、不可能な場合は `NO` を出力せよ。

## 说明/提示

### 制約

- $ 1\ \leq\ |S|\ \leq\ 10^5 $
- $ S $ は `a`、`b`、`c` 以外の文字を含まない。

### Sample Explanation 1

このままだと `aba` という回文を含みますが、例えば `acba` のように並び替えると $ 2 $ 文字以上の回文を含まなくなります。

## 样例 #1

### 输入

```
abac
```

### 输出

```
YES
```

## 样例 #2

### 输入

```
aba
```

### 输出

```
NO
```

## 样例 #3

### 输入

```
babacccabab
```

### 输出

```
YES
```



---

---
title: "Time Gap"
layout: "post"
diff: 普及/提高-
pid: AT_cf17_final_c
tag: []
---

# Time Gap

## 题目描述

### 题目大意
给定$n$个数$d$，每个$d$都可以选择变成$24-d$或者保留数值，求任意两个数之间差的最小值中的最大值。

## 输入格式

第一行：$n$\
第二行：$d_1$,$d_2$……$d_n$

## 输出格式

任意两个数之间差的最小值中的最大值。

## 说明/提示

1$\leq$$n$$\leq$50\
0$\leq$$d_i$$\leq$12

## 样例 #1

### 输入

```
3

7 12 8
```

### 输出

```
4
```

## 样例 #2

### 输入

```
2

11 11
```

### 输出

```
2
```

## 样例 #3

### 输入

```
1

0
```

### 输出

```
0
```



---

---
title: "次のアルファベット"
layout: "post"
diff: 普及/提高-
pid: AT_codefestival_2016_qualA_c
tag: []
---

# 次のアルファベット

## 题目描述

# 题意翻译
高桥君有一个仅由小写字母组成的字符串s。高桥君对s执行以下操作正好是k次。在所需位置从字符串s中选择一个字母并将该字母更改为下一个字母。但是,z后面的字母是a。例如，如果选择字符串aaz的第2个字符并执行操作aaz → abz。 然后，如果选择abz的 第3个字符并执行操作，则它变为aba。高桥君 希望在k操作后，按字典顺序使字符串s尽可能小。仅在k次操作后，按字典顺序输出最小的字符串s。

## 输入格式

第一行一个字符串s，第二行一个整数k。

## 输出格式

k次操作后字典顺序最小的字符串s.
# 输入输出样例
## 输入#1
xyz          
4
## 输出#1
aya
## 输入#2
a   
25
## 输出#2
z
## 输入#3
codefestival   
100
## 输出#3
aaaafeaaivap

## 说明/提示

设字符串s的长度为n  
+ 1≤n≤100000
+ 1≤k≤1000000000

## 样例 #1

### 输入

```
xyz

4
```

### 输出

```
aya
```

## 样例 #2

### 输入

```
a

25
```

### 输出

```
z
```

## 样例 #3

### 输入

```
codefestival

100
```

### 输出

```
aaaafeaaivap
```



---

---
title: "K個のケーキ"
layout: "post"
diff: 普及/提高-
pid: AT_codefestival_2016_qualC_b
tag: []
---

# K個のケーキ

## 题目描述

[problemUrl]: https://atcoder.jp/contests/code-festival-2016-qualc/tasks/codefestival_2016_qualC_b

$ K $ 個のケーキがあります。高橋君は、1日に一つずつ、$ K $ 日かけてこれらのケーキを食べようと考えています。

ケーキは$ T $ 種類あり、種類$ i\ (1≦i≦T) $ のケーキは$ a_i $ 個あります。

二日連続で同じ種類のケーキを食べると飽きてしまうため、高橋君は、うまくケーキを食べる順番を決めて、前日と同じ種類のケーキを食べる日数を最小にしようと考えました。

高橋君のために前日と同じ種類のケーキを食べる日数の最小値を求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ K $ $ T $ $ a_1 $ $ a_2 $ $ ... $ $ a_T $

## 输出格式

前日と同じ種類のケーキを食べる日数の最小値を出力せよ。

## 说明/提示

### 制約

- $ 1≦K≦10000,\ 1≦T≦100 $
- $ 1≦a_i≦100 $
- $ a_1+a_2+ $...$ +a_T\ =\ K $

### Sample Explanation 1

ケーキは$ 7 $個あります。例えば種類$ 2,1,2,3,1,3,1 $の順で食べると一度も前日と同じ種類のケーキを食べなくてすみます。

### Sample Explanation 2

ケーキは$ 6 $個あります。種類$ 2,3,2,2,1,2 $の順で食べると4日目だけ前日と同じ種類$ 2 $のケーキを食べることになり、これが最小になるので答えは$ 1 $です。

### Sample Explanation 3

高橋君は一種類のケーキしか持っていないため、2日目以降は毎日前日と同じ種類のケーキを食べるしかありません。

## 样例 #1

### 输入

```
7 3

3 2 2
```

### 输出

```
0
```

## 样例 #2

### 输入

```
6 3

1 4 1
```

### 输出

```
1
```

## 样例 #3

### 输入

```
100 1

100
```

### 输出

```
99
```



---

---
title: "fLIP"
layout: "post"
diff: 普及/提高-
pid: AT_code_festival_2017_quala_b
tag: []
---

# fLIP

## 题目描述

[problemUrl]: https://atcoder.jp/contests/code-festival-2017-quala/tasks/code_festival_2017_quala_b

$ N $ 行 $ M $ 列のマス目があり、最初は全てのマスが白いです。

各行各列には $ 1 $ つずつボタンがあります。 ある行のボタンを押すと、その行のマスの色が全て反転します。すなわち、白なら黒、黒なら白に色が変わります。 また、ある列のボタンを押すと、その列のマスの色が全て反転します。

高橋君は、ボタンを押す操作を好きな回数行うことができます。黒く塗られたマスの個数をちょうど $ K $ 個にすることができるかどうか判定してください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ M $ $ K $

## 输出格式

黒く塗られたマスの個数をちょうど $ K $ 個にできるなら `Yes` を、そうでないなら `No` を出力せよ。

## 说明/提示

### 制約

- $ 1\ \leq\ N,M\ \leq\ 1000 $
- $ 0\ \leq\ K\ \leq\ NM $

### Sample Explanation 1

$ 1 $ 行目、 $ 1 $ 列目の順にボタンを押せばよいです。

### Sample Explanation 3

$ 1 $ 列目、$ 3 $ 列目、$ 2 $ 行目、$ 5 $ 列目の順にボタンを押せばよいです。

## 样例 #1

### 输入

```
2 2 2
```

### 输出

```
Yes
```

## 样例 #2

### 输入

```
2 2 1
```

### 输出

```
No
```

## 样例 #3

### 输入

```
3 5 8
```

### 输出

```
Yes
```

## 样例 #4

### 输入

```
7 9 20
```

### 输出

```
No
```



---

---
title: "Inserting &#39;x&#39;"
layout: "post"
diff: 普及/提高-
pid: AT_code_festival_2017_qualc_c
tag: []
---

# Inserting &#39;x&#39;

## 题目描述

输入一个字符串S，您可以重复执行以下操作：

在S的任意位置（包含开头和结尾），插入一个小写字母 x ， 使其变成回文的字符串。

请输出所需的最少操作次数 ，如果不能变为回文 ，输出 -1 。

## 输入格式

输入文件仅有一行，一个仅包含小写字母的字符串S。

## 输出格式

如果目标可实现 ，则输出所需的最少操作次数。如果不行，请输出-1。

## 样例 #1

### 输入

```
xabxa
```

### 输出

```
2
```

## 样例 #2

### 输入

```
ab
```

### 输出

```
-1
```

## 样例 #3

### 输入

```
a
```

### 输出

```
0
```

## 样例 #4

### 输入

```
oxxx
```

### 输出

```
3
```



---

---
title: "Lock"
layout: "post"
diff: 普及/提高-
pid: AT_code_festival_china_a
tag: []
---

# Lock

## 题目描述

[problemUrl]: https://atcoder.jp/contests/code-festival-2014-china-open/tasks/code_festival_china_a



## 输入格式

Input is given in the following format.

> $ n $

- On the first line, you will be given $ n\ (1\ \leq\ n\ \leq\ 5) $, the number of digits of the dial lock.

## 输出格式

On the first line, output $ m $, the minimum number of procedures to try all combinations of digits.

On the following $ m+1 $ lines, output the combination of digits that appears during the trial in order. If there are more than $ 1 $ possible answer, you may choose any one of them. Make sure to insert a line break at the end of the last line.

## 说明/提示

### Problem

Alice has a box locked with $ n $ digits dial lock. Each dial of the lock can be set to a digit from $ 0 $ to $ 9 $. Unfortunately, she forgot the passcode (of $ n $ digits). Now she will try all possible combinations of digits to unlock the key.

She can do one of the following procedure each time.

- Choose $ 1 $ dial and add $ 1 $ to that digit. (If the digit chosen was $ 9 $, it will be $ 0 $).
- Choose $ 1 $ dial and subtract $ 1 $ from that digit. (If the digit chosen was $ 0 $, it will be $ 9 $).

Curiously, she wants to try all combinations even if she found the correct passcode during the trials. But it is a hard work to try all the $ 10^n $ combinations. Help her by showing the way how to make the procedure less as possible.

Initially, the combination of digits of the lock is set to $ 00..0 $.

Calculate $ m $, the minimum number of procedures to try all combinations of digits, and show the $ m+1 $ combinations of digits after each procedures, including the initial combination $ 00..0 $. If there are more than one possible answer, you may choose any one of them.

Checking if the current combination of digits matches the passcode doesn't count as a procedure.

### Sample Explanation 1

Don't forget to output the minimum number of procedures $ 9 $ on the first line. On the following lines, note that you have to output $ m+1 $ lines including the initial combination $ 0 $.

## 样例 #1

### 输入

```
1
```

### 输出

```
9

0

1

2

3

4

5

6

7

8

9
```

## 样例 #2

### 输入

```
2
```

### 输出

```
99

00

01

02

03

04

05

06

07

08

09

19

18

17

16

15

14

13

12

11

10

20

21

22

23

24

25

26

27

28

29

39

38

37

36

35

34

33

32

31

30

40

41

42

43

44

45

46

47

48

49

59

58

57

56

55

54

53

52

51

50

60

61

62

63

64

65

66

67

68

69

79

78

77

76

75

74

73

72

71

70

80

81

82

83

84

85

86

87

88

89

99

98

97

96

95

94

93

92

91

90
```



---

---
title: "常ならずグラフ"
layout: "post"
diff: 普及/提高-
pid: AT_code_festival_final_e
tag: []
---

# 常ならずグラフ

## 题目描述

[problemUrl]: https://atcoder.jp/contests/code-festival-2014-final/tasks/code_festival_final_e

Tさんは，諸行無常をモットーにいろいろなことに挑戦しています． Tさんはあるコンテストに長期的に参加していますが，そのコンテストにはレーティング機能があり，一度参加する毎にレーティングが変動します．それらの変動はグラフにまとめられています．

今，Tさんは彼のレーティング変動がプロットされたグラフを眺めています．彼はふと，グラフから一部の点を取り除いてそれらを結び，常に上下に変動しているような折れ線グラフ，名付けて「常ならずグラフ」を作りたくなりました． さらに，グラフに含まれる点の数が最も多いものに興味があります．

さて，あなたはTさんのために，彼のレーティング変動がプロットされたグラフから作ることのできる「常ならずグラフ」の中での最大の点の数を求めてあげることにしました．

あなたには，Tさんのあるコンテスト参加後でのレーティングが，$ N $ 個，時系列で与えられます．その中からいくつかの点を取り除き「常ならずグラフ」を作るとき，ありうる点の最大数を求めなさい．常ならずグラフが作れないときは $ 0 $ を出力しなさい．

あるグラフ $ X=\{x_1,x_2,x_3,..x_n\} $ が「常ならずグラフ」であるとは， $ |X| $ が $ 3 $ 以上かつ， $ x_1＜x_2＞x_3＜x_4＞... $ もしくは $ x_1＞x_2＜x_3＞x_4\ <\ ...$ が成り立つことを意味します．
つまり，含まれる頂点数が $ 3 $ 未満のとき，「常ならずグラフ」ではありません．

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ R_1 $ $ R_2 $ … $ R_N $

- $ 1 $ 行目には，Tさんのコンテスト参加回数を表す整数 $ N\ (1\ ≦\ N\ ≦\ 3000) $ が与えられる．
- $ 2 $ 行目には, Tさんが $ i\ (1\ ≦\ i\ ≦\ N) $ 番目のコンテストに参加した直後のレーティング $ R_i\ (-10^5\ ≦\ R_i\ ≦\ 10^5) $ が空白切りで与えられる．

## 输出格式

与えられたグラフからいくつかの点を取り除き「常ならずグラフ」を作るとき，ありうる点の最大数を求め，$ 1 $ 行に出力しなさい．末尾の改行を忘れないこと．

## 样例 #1

### 输入

```
4

1 2 5 1
```

### 输出

```
3
```

## 样例 #2

### 输入

```
5

1 2 3 4 5
```

### 输出

```
0
```



---

---
title: "ループを探せ"
layout: "post"
diff: 普及/提高-
pid: AT_code_festival_relay_f
tag: []
---

# ループを探せ

## 题目描述

# 寻找环


众所周知，顶点数和边数均为 $n$ 的无向图仅包含一个环。

给出一个这样的图，求出图中包含的环的长度。

## 输入格式

* 对于第一行，给出表示图的顶点数的整数 $ n $ ( $ 3\ \leq\ n\ \leq\ 100{,}000 $ ) 。
* 随后的 $n$ 行给出图的边的信息。
* 每个顶点都有从 $1$ 到 $n$ 的编号， $ x_i,\ y_i $ ( $ 1\ \leq\ x_i,y_i\ \leq\ n $ ) 表示顶点 $x_i$ 和 $y_i$ 通过第 $i$ 条边连接。
* 保证所给出的图是连通图，保证不包含自身边或多重边。

## 输出格式

输出图中包含的环的长度。

最后换行，不包含多余的文字或空行。

## 样例 #1

### 输入

```
4

1 2

2 3

3 1

1 4
```

### 输出

```
3
```

## 样例 #2

### 输入

```
4

1 2

2 3

3 4

4 1
```

### 输出

```
4
```



---

---
title: "100個の円"
layout: "post"
diff: 普及/提高-
pid: AT_code_formula_2014_final_f
tag: []
---

# 100個の円

## 题目描述

[problemUrl]: https://atcoder.jp/contests/code-formula-2014-final/tasks/code_formula_2014_final_f

$ 100 $ 個の円があります。 このうち $ k $ 番目の円の半径は $ k $ であることがわかっています。

これを、$ 1500 $ × $ 1500 $ の正方形の中に敷き詰めることにしました。

敷き詰め方の一例を出力してください。

なお、円の中心の座標は、$ x $ 座標、 $ y $ 座標ともに、整数でないといけないことに注意してください。

## 输入格式

入力は与えられない。

## 输出格式

出力形式は、以下のようなものである。

> $ X_1 $ $ Y_1 $ $ X_2 $ $ Y_2 $ : $ X_{100} $ $ Y_{100} $

円の情報を $ 100 $ 行で出力せよ。

$ k $ 行目には、$ k $ 番目の円の中心の $ x $ 座標と $ y $ 座標を表す $ X_k,\ Y_k $ を、スペース区切りで $ 1 $ 行で出力せよ。

なお、出力は整数しか認められず、全ての円が、座標 $ (0,0) $ と $ (1500,1500) $ を結ぶ線分を対角線とする正方形の内部に収まっている必要がある。

円や正方形が接していても良いが、重なることは許されない。

## 说明/提示

### Sample Explanation 1

以上の例では、半径 $ 1 $ の円を座標 $ (1,1) $ に、半径 $ 2 $ の円を座標 $ (5,10) $ に、半径 $ 3 $ の円を座標 $ (500,30) $ に置いています。 上記のような形で、 $ 100 $ 行出力するのが、今回の課題です。

## 样例 #1

### 输入

```
None
```

### 输出

```
1 1

5 10

500 30

:
```



---

---
title: "暴露"
layout: "post"
diff: 普及/提高-
pid: AT_code_thanks_festival_2015_d
tag: []
---

# 暴露

## 题目描述

[problemUrl]: https://atcoder.jp/contests/code-thanks-festival-2015-open/tasks/code_thanks_festival_2015_d

$ 1 $ から $ N $ までの番号が付けられた $ N $ 人の生徒からなるある学園で期末試験が行われた。試験は $ 100 $ 点満点で、どの生徒も非負の整数の得点を獲得した。

この学園ではどの生徒も自分の得点と全受験者の合計点を通知されるが、それ以外の情報は通知されない。

しかしながらどの生徒も他の生徒の得点が気になる。そのため生徒は他の生徒から得点を聞き出し、それらの値を基に他の生徒の得点を予想することにしている。

学園の教師であり、生徒が他の生徒の得点をどれくらい正確に把握しているのかが気になったあなたは、生徒の行動によってどのくらい得点が特定できているのかを調査することにした。

具体的には、以下に示す $ M $ 個の情報クエリあるいは質問クエリを番号の昇順に処理した際の質問クエリの答えを計算することにした。

- クエリには $ 1 $ から $ M $ までの番号が付けられている。どのクエリも $ 3 $ つの整数 $ a_i\ (0\ ≦\ a_i\ ≦\ 1) $, $ b_i\ (1\ ≦\ b_i\ ≦\ N) $, $ c_i\ (1\ ≦\ c_i\ ≦\ N,\ b_i≠c_i) $ によって定められる。
- $ a_i $ = $ 0 $ のとき、クエリ $ i $ は情報クエリである。これは、生徒 $ b_i $ が生徒 $ c_i $ の得点を知ったことを表す。
- $ a_i $ = $ 1 $ のとき、クエリ $ i $ は質問クエリである。これは、生徒 $ b_i $ がクエリ $ i $ までの情報クエリと元々知っている情報のみで、生徒 $ c_i $ の得点が何点以上何点以下であると判定できるのかを答えなければならないことを表す。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ s_1 $ $ s_2 $ : $ s_N $ $ M $ $ a_1 $ $ b_1 $ $ c_1 $ $ a_2 $ $ b_2 $ $ c_2 $ : $ a_M $ $ b_M $ $ c_M $

- $ 1 $ 行目には、学園の生徒数 $ N\ (2\ ≦\ N\ ≦\ 50) $ が与えられる。
- $ 2 $ 行目から $ N $ 行には、生徒の得点が与えられる。$ N $ 行のうち $ i\ (1\ ≦\ i\ ≦\ N) $ 行目には、生徒 $ i $ が獲得した得点 $ s_i\ (0\ ≦\ s_i\ ≦\ 100) $ が与えられる。
- $ N+2 $ 行目には、クエリ数 $ M\ (1\ ≦\ M\ ≦\ 5,000) $ が与えられる。
- $ N+3 $ 行目から $ M $ 行には、クエリの情報が与えられる。$ M $ 行のうち $ i\ (1\ ≦\ i\ ≦\ M) $ 行目には、クエリ $ i $ を定める $ 3 $ つの整数 $ a_i\ (0\ ≦\ a_i\ ≦\ 1) $, $ b_i\ (1\ ≦\ b_i\ ≦\ N) $, $ c_i\ (1\ ≦\ c_i\ ≦\ N,\ b_i≠c_i) $ が空白区切りで与えられる。
- $ 1\ ≦\ i\ ＜\ j\ ≦\ M $ となる整数 $ i $, $ j $ に対して、$ a_i $ = $ a_j $ = $ 0 $ ならば、$ b_i $ ≠ $ b_j $ または $ c_i $ ≠ $ c_j $ が成り立ちます。
- 入力では $ 1\ ≦\ i\ ≦\ M $ を満たすある整数 $ i $ において $ a_i $ = $ 1 $ であること (すなわち少なくとも $ 1 $ つは質問クエリがあること) が保証されています。

## 输出格式

$ M $ 個のクエリ中の質問クエリ数を $ Q $ 個としたとき、出力は $ Q $ 行からなる。$ Q $ 行のうち $ i\ (1\ ≦\ i\ ≦\ Q) $ 行目には、$ i $ 番目の質問クエリに対する答えを出力せよ。$ i $ 番目の質問クエリに対する答えが、$ x $ 点以上 $ y $ 点以下であるという答えならば、$ x $ と $ y $ をこの順に空白区切りで出力せよ。出力の末尾にも改行を入れること。

## 说明/提示

### Sample Explanation 1

生徒は $ 4 $ 人であり、クエリは $ 6 $ 個ある。 - クエリ $ 1 $ は情報クエリである。生徒 $ 2 $ は生徒 $ 3 $ の得点が $ 70 $ 点であることを知る。 - クエリ $ 2 $ は情報クエリである。生徒 $ 4 $ は生徒 $ 2 $ の得点が $ 90 $ 点であることを知る。 - クエリ $ 3 $ は質問クエリである。この時点で生徒 $ 2 $ は合計点が $ 80+90+70+100=340 $ 点であること、生徒 $ 2 $ の得点が $ 90 $ 点であること、生徒 $ 3 $ の得点が $ 70 $ 点であることを知っているので、生徒 $ 4 $ の得点は $ 80 $ 点以上 $ 100 $ 点以下であることがわかる。よって出力の $ 1 $ 行目は `80 100` となる。 - クエリ $ 4 $ は情報クエリである。生徒 $ 2 $ は生徒 $ 4 $ の得点が $ 100 $ 点であることを知る。 - クエリ $ 5 $ は質問クエリである。この時点で生徒 $ 2 $ は合計点および生徒 $ 1 $ 以外すべての生徒の得点を知っているので、生徒 $ 1 $ の得点はちょうど $ 80 $ 点であることがわかる。よって出力の $ 2 $ 行目は `80 80` となる。 - クエリ $ 6 $ は質問クエリである。この時点で生徒 $ 4 $ は合計点が $ 340 $ 点であること、生徒 $ 2 $ の得点が $ 90 $ 点であること、生徒 $ 4 $ の得点が $ 100 $ 点であることを知っているので、生徒 $ 1 $ の得点は $ 50 $ 点以上 $ 100 $ 点以下であることがわかる。よって出力の $ 3 $ 行目は `50 100` となる。

### Sample Explanation 2

既に得点を知っている相手に対して質問クエリが飛んで来る場合もあります。

## 样例 #1

### 输入

```
4

80

90

70

100

6

0 2 3

0 4 2

1 2 4

0 2 4

1 2 1

1 4 1
```

### 输出

```
80 100

80 80

50 100
```

## 样例 #2

### 输入

```
3

25

12

31

3

1 1 2

0 1 2

1 1 2
```

### 输出

```
0 43

12 12
```

## 样例 #3

### 输入

```
7

32

19

22

25

23

17

18

11

0 1 2

0 4 5

0 1 4

0 2 3

0 2 7

1 1 5

1 2 7

1 2 1

0 4 3

1 4 2

1 6 7
```

### 输出

```
0 80

18 18

0 97

0 86

0 100
```



---

---
title: "Concatenated Palindrome"
layout: "post"
diff: 普及/提高-
pid: AT_code_thanks_festival_2017_b
tag: []
---

# Concatenated Palindrome

## 题目描述

[problemUrl]: https://atcoder.jp/contests/code-thanks-festival-2017/tasks/code_thanks_festival_2017_b

英小文字からなる文字列 $ S $ が与えられます。   
 $ S $ の後ろに英小文字からなる任意の文字列 $ T $ (空文字列も含む)を連結することで、回文にしたいです。   
 条件を満たす文字列 $ T $ のうち、$ T $ の最小の長さを求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ S $

## 输出格式

条件を満たす文字列 $ T $ の最小の長さを求めよ。

## 说明/提示

### 制約

- $ 1≦|S|≦50 $ ($ |S| $ は文字列 $ S $ の長さ)
- 文字列 $ S $ は英小文字から成る。

### Sample Explanation 1

$ T="dcba" $ とすると、文字列 $ S $ と 文字列 $ T $ を順番に連結した文字列は回文になります。 この文字列 $ T $ は条件を満たす中で最小の長さであるため、答えは $ 4 $ です。

### Sample Explanation 2

文字列 $ S $ は回文であるため、文字列 $ T $ は空文字列でも条件を満たします。 空文字列の長さは $ 0 $ であるため、答えは $ 0 $ です。

## 样例 #1

### 输入

```
abcde
```

### 输出

```
4
```

## 样例 #2

### 输入

```
level
```

### 输出

```
0
```

## 样例 #3

### 输入

```
codethanksfestival
```

### 输出

```
17
```

## 样例 #4

### 输入

```
abcdefghijklmnopqrstuvwxyzyxwvutsrqponmlkjihgfedcb
```

### 输出

```
1
```



---

---
title: "Bus Tour"
layout: "post"
diff: 普及/提高-
pid: AT_code_thanks_festival_2017_d
tag: []
---

# Bus Tour

## 题目描述

[problemUrl]: https://atcoder.jp/contests/code-thanks-festival-2017/tasks/code_thanks_festival_2017_d

あなたはバスツアーを計画しています。

バスツアーの参加者は必ず $ 1 $ グループ $ N $ 人で申し込みます。運転手を除いた各バスの定員は必ず $ M $ 人です。  
 このバスツアーは、全ての参加者がバスに乗り切れるようなバスの最小台数で行います。   
 同じグループに属する人が必ずしも同じバスに乗り込む必要はありません。

このバスツアーに参加するグループ数には上限がないため、申し込みを締め切るまでバスツアーに参加するグループ数は分かりません。   
 したがって、参加者の申し込み具合によってはバスに空席が生じてしまいます。   
 最大で何席の空席ができるでしょうか?

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ M $

## 输出格式

バスツアーにおける空席の最大数を出力せよ。

## 说明/提示

### 制約

- $ 1≦N≦10^9 $
- $ 1≦M≦10^9 $
- $ N $ と $ M $ は整数である。

### Sample Explanation 1

申し込みが $ 1 $ グループだった場合、参加者 $ 5 $ 人に対して定員 $ 4 $ 名のバス $ 2 $ 台で バスツアーを行うため、$ 3 $ 席の空席が生じます。

### Sample Explanation 2

申し込みグループ数に関わらず、常にバスが満員である場合もあります。

## 样例 #1

### 输入

```
5 4
```

### 输出

```
3
```

## 样例 #2

### 输入

```
1000000 10
```

### 输出

```
0
```

## 样例 #3

### 输入

```
500000000 1000000000
```

### 输出

```
500000000
```



---

---
title: "Two Piles"
layout: "post"
diff: 普及/提高-
pid: AT_cpsco2019_s2_d
tag: []
---

# Two Piles

## 题目描述

[problemUrl]: https://atcoder.jp/contests/cpsco2019-s2/tasks/cpsco2019_s2_d

 $ A $ 枚のコインがある $ 1 $ つの山と、 $ B $ 枚のコインがある $ 1 $ つの山があります。 この$ 2 $つの山を使ってAliceとBobがゲームをします。

Aliceを先手として、$ 2 $ 人は以下の操作を交互に繰り返します。

- $ 1 $ 枚以上のコインがある山を $ 1 $ つ選ぶ。そこにあるコインの枚数を $ X $ とする。
- その後、$ 2 $ つの山からそれぞれ $ 0 $ 枚以上のコインを取り除く。
- ただし、取り除くコインの枚数の合計は $ X $ でなければならない。

 どの山にもコインがなくなった時点で終了し、最後に操作した人が勝ちます。

$ 2 $ 人が最適に行動したとき、Aliceが勝つかどうか判定してください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ A $ $ B $

## 输出格式

Aliceが勝つなら `Yes` を、Bobが勝つなら `No` を出力せよ。

## 说明/提示

### 制約

- $ 1\ \leq\ A\ \leq\ 10^5 $
- $ 1\ \leq\ B\ \leq\ 10^5 $
- 入力はすべて整数である。

### Sample Explanation 1

Aliceがそれぞれの山から $ 1 $ 枚ずつコインを取って $ (1,\ 1) $ にすると、Bobは残りのどちらか $ 1 $ 枚を取って $ (1,\ 0) $ にするしかなく、残りの $ 1 $ 枚をAliceが取って勝利します。

## 样例 #1

### 输入

```
2 2
```

### 输出

```
Yes
```

## 样例 #2

### 输入

```
3 3
```

### 输出

```
No
```



---

---
title: "正方形のチップ"
layout: "post"
diff: 普及/提高-
pid: AT_ddcc_2016_final_a
tag: []
---

# 正方形のチップ

## 题目描述

[problemUrl]: https://atcoder.jp/contests/ddcc2016-final/tasks/ddcc_2016_final_a

半径 $ R $ cmの*ウェーハ*に*ダイシング*という操作を行い、正方形のチップをいくつか作成することにしました。 作成される正方形のチップの個数を求めてください。

ウェーハとは、ある部品を作るのに使われる薄い円盤状の物体です。 ダイシングという操作は、ウェーハの中心から $ C $ cm間隔で水平方向と垂直方向に切れ目を入れてウェーハを分割する操作です。

例として、$ R=15,\ \,\ C=4 $ の例を示します。 破線で示されるようなマス目状に分割がなされ、緑色の領域で示されるような $ 32 $ 個の正方形のチップを作成することができます。

 ![3b83484e97d59df50e3ee39c4a3cbca7.png](https://cdn.luogu.com.cn/upload/vjudge_pic/AT_ddcc_2016_final_a/4884165f81392986b1bb775c3cf1b058de7f8e4a.png)

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ R $ $ C $

## 输出格式

作成される正方形のチップの個数を $ 1 $ 行に出力せよ。

## 说明/提示

### 制約

- $ 1\ ≦\ R,\ \,\ C\ ≦\ 100 $
- $ R,\ \,\ C $ はいずれも整数

### Sample Explanation 1

\- 問題文中で示した通りです。

### Sample Explanation 2

\- ウェーハの中心を $ (0,0) $ としたとき $ (2,3),(3,3),(2,4),(3,4) $ の $ 4 $ 点で表される正方形のチップは $ (3,4) $ がウェーハの周上にありますが、このようなチップも作成することが可能です。

## 样例 #1

### 输入

```
15 4
```

### 输出

```
32
```

## 样例 #2

### 输入

```
5 1
```

### 输出

```
60
```



---

---
title: "C-Filter"
layout: "post"
diff: 普及/提高-
pid: AT_digitalarts_1
tag: []
---

# C-Filter

## 题目描述

[problemUrl]: https://atcoder.jp/contests/digitalarts2012/tasks/digitalarts_1

セキュリティに興味がある高橋君は、デジタルアーツ株式会社に就職したい青年です。  
 彼は、面接で自分をアピールするために、得意なプログラミングでフィルタリングソフト「C-Filter」を作ろうと考えています。  
 「C-Filter」は、与えられた文字列 $ s $ に、あらかじめ登録しておいた「NGワード」と一致する文字列が存在する場合、その文字列の長さと等しい数の `*`に置き換えて出力するソフトウェアです。この文字列を置き換える処理をフィルタリングと呼びます。  
 「NGワード」とは、半角英小文字と`*`から構成されます。`*`はすべての半角英小文字 $ 1 $ 文字と一致します。  
 例えば `myonmyon` は、NGワード`myo*myon`と一致します。  
 ただし、NGワードは単語ごとに適用されるため、`myo myon` はNGワード `myo*myon`とは一致しません。  
 また、NGワードはある単語に対して完全に一致する必要があります。  
 例えば、`abcde`は、NGワード`abc`や`bcd`、`cde`に一致しません。   
  
 文字列 $ s $ と、NGワードが与えられるので、C-Filterの出力する文字列を答えてください。  
 入力は以下の形式で標準入力から与えられる。

> $ s $ $ N $ $ t_{1} $ : : $ t_{N} $

1. 入力は $ N+2 $ 行からなる。
2. $ 1 $ 行目には $ 1 $ 文字以上 $ 1,000 $ 文字以下の文字列 $ s $ が与えられる。

- $ s $ はフィルタリングする対象の文字列を半角スペースで区切って繋げた文字列である。

5. $ 2 $ 行目にはNGワードの個数を表す整数 $ N(0≦N≦50) $ が与えられる。
6. $ 3 $ 行目から $ N+2 $ 行目までNGワードを表す文字列 $ t_{i}(1≦i≦N) $が与えられる。
- 文字列 $ t_{i} $ は半角英小文字と `*` から構成される。
- 文字列 $ t_{i} $ の長さは $ 1 $ 文字以上、 $ 20 $ 文字以下である。
- 文字列 $ t_{i} $ に含まれる `*` は、半角スペースを除くすべての半角英小文字 $ 1 $ 文字をフィルタリングの対象とします。
 
 入力された文字列 $ s $ をC-Filterでフィルタリングした結果を $ 1 $ 行で出力せよ。  
 なお、最後には改行を出力せよ。 ```

abc aaa ababa abcba abc
2
abc
**a**
```

 ```

*** aaa ***** abcba ***
```

- NGワードには`abc`と`**a**`の $ 2 $ つの文字列が登録されています。
- $ 1 $ 番目と $ 5 $ 番目に入力される`abc`はNGワード`abc`に一致するので、`***`と出力されます。
- $ 3 $ 番目に入力される`ababa`はNGワード`**a**`に一致するので、`*****`と出力されます。
 
```

aaaa aaa aaaaaa aaaa
3
a
aa
aaa
```

 ```

aaaa *** aaaaaa aaaa
```

- 完全一致のパターンだけを考慮すれば良いため、`aaaa` や `aaaaa` は変える必要がありません。
 
```

i have a pen
1
*
```

 ```

* have * pen
```

- １文字の単語だけNGワードとして認識されます。
 
```

digital arts
1
digital*arts
```

 ```

digital arts
```

- 半角スペースは`*`にマッチしません。



---

---
title: "Picking Up"
layout: "post"
diff: 普及/提高-
pid: AT_diverta2019_2_b
tag: []
---

# Picking Up

## 题目描述

[problemUrl]: https://atcoder.jp/contests/diverta2019-2/tasks/diverta2019_2_b

$ 2 $ 次元平面上に $ N $ 個のボールがあり、$ i $ 番目のボールは $ (x_i,\ y_i) $ にあります。

まず、$ p\ \neq\ 0 $ または $ q\ \neq\ 0 $ を満たす $ 2 $ つの整数 $ p,\ q $ を決め、その後以下の操作を繰り返してボールを全て回収します。

- 残っているボールを $ 1 $ つ選んで回収する。このボールの座標を $ (a,\ b) $ とする。この時、直前に選んだボールの座標が $ (a\ -\ p,\ b\ -\ q) $ である時コスト $ 0 $ 、そうでない時コスト $ 1 $ かかる。ただし、$ 1 $ つ目に選んだボールについては必ずコスト $ 1 $ かかる。

$ p,\ q $ を最適に選んだ場合にボールを全て回収するのにかかるコストの和の最小値を計算してください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ x_1 $ $ y_1 $ $ : $ $ x_N $ $ y_N $

## 输出格式

ボールを全て回収するのにかかるコストの和の最小値を出力せよ。

## 说明/提示

### 制約

- $ 1\ \leq\ N\ \leq\ 50 $
- $ |x_i|,\ |y_i|\ \leq\ 10^9 $
- $ x_i\ \neq\ x_j $ または $ y_i\ \neq\ y_j\ (i\ \neq\ j) $
- 入力は全て整数である

### Sample Explanation 1

$ p\ =\ 1,\ q\ =\ 1 $ とすると、$ (1,\ 1) $ のボール、$ (2,\ 2) $ のボールの順に選ぶことでコスト $ 1 $ でボールを全て回収することができます。

### Sample Explanation 2

$ p\ =\ -3,\ q\ =\ -2 $ とすると、$ (7,\ 8) $ のボール、$ (4,\ 6) $ のボール、$ (1,\ 4) $ のボールの順に選ぶことでコスト $ 1 $ でボールを全て回収することができます。

## 样例 #1

### 输入

```
2

1 1

2 2
```

### 输出

```
1
```

## 样例 #2

### 输入

```
3

1 4

4 6

7 8
```

### 输出

```
1
```

## 样例 #3

### 输入

```
4

1 1

1 2

2 1

2 2
```

### 输出

```
2
```



---

---
title: "Successive Subtraction"
layout: "post"
diff: 普及/提高-
pid: AT_diverta2019_2_c
tag: []
---

# Successive Subtraction

## 题目描述

[problemUrl]: https://atcoder.jp/contests/diverta2019-2/tasks/diverta2019_2_c

黒板に $ A_1,\ A_2,\ ...,\ A_N $ の $ N $ 個の整数が書かれています。

以下の操作を $ N-1 $ 回繰り返して黒板にただ $ 1 $ つの整数が書かれているようにします。

- $ 2 $ 個の整数 $ x,\ y $ を選んで消し、新たに $ 1 $ 個の整数 $ x-y $ を書く。

ただ $ 1 $ つ残る整数としてありうる値の最大値と、その最大値を達成する操作列を求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ A_1 $ $ A_2 $ $ ... $ $ A_N $

## 输出格式

ただ $ 1 $ つ残る整数としてありうる値の最大値 $ M $ と、その最大値を達成する操作列 $ x_i,\ y_i $ を以下の形式に従って出力せよ。

ただし、$ x_i,\ y_i $ は $ i $ 回目の操作で選ぶ $ x,\ y $ を表す。

また、最大値を達成する操作列が複数存在する場合は、そのうちどれを出力しても良い。

> $ M $ $ x_1 $ $ y_1 $ $ : $ $ x_{N-1} $ $ y_{N-1} $

## 说明/提示

### 制約

- $ 2\ \leq\ N\ \leq\ 10^5 $
- $ -10^4\ \leq\ A_i\ \leq\ 10^4 $
- 入力は全て整数である

### Sample Explanation 1

$ 1 $ 回目の操作で $ x $ として $ -1 $、$ y $ として$ 1 $ を選ぶと、黒板に書かれている整数は $ (-2,\ 2) $ になります。 $ 2 $ 回目の操作で $ x $ として $ 2 $、$ y $ として$ -2 $ を選ぶと、黒板に書かれている整数は $ (4) $ になります。 よって $ 4 $ がただ $ 1 $ つ残り、$ 5 $ 以上の整数がただ $ 1 $ つ残ることはないので、これが最大です。

## 样例 #1

### 输入

```
3

1 -1 2
```

### 输出

```
4

-1 1

2 -2
```

## 样例 #2

### 输入

```
3

1 1 1
```

### 输出

```
1

1 1

1 0
```



---

---
title: "AB Substrings"
layout: "post"
diff: 普及/提高-
pid: AT_diverta2019_c
tag: []
---

# AB Substrings

## 题目描述

[problemUrl]: https://atcoder.jp/contests/diverta2019/tasks/diverta2019_c

すぬけ君は $ N $ 個の文字列を持っています。$ i $ 番目の文字列は $ s_i $ です。

これらの文字列を好きな順序で並べたあと、連結して $ 1 $ つの文字列を作ることを考えます。 作った文字列に `AB` という部分文字列が含まれる個数としてありうる値のうち、最大値を求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ s_1 $ $ \vdots $ $ s_N $

## 输出格式

答えを出力せよ。

## 说明/提示

### 制約

- $ 1\ \leq\ N\ \leq\ 10^{4} $
- $ 2\ \leq\ |s_i|\ \leq\ 10 $
- $ s_i $ は英大文字のみからなる

### Sample Explanation 1

\- 例えば、`ABCA`, `BAD`, `XBAZ` の順で連結して `ABCABADXBAZ` を作ったとき、`AB` という部分文字列は $ 2 $ つ含まれます。

## 样例 #1

### 输入

```
3

ABCA

XBAZ

BAD
```

### 输出

```
2
```

## 样例 #2

### 输入

```
9

BEWPVCRWH

ZZNQYIJX

BAVREA

PA

HJMYITEOX

BCJHMRMNK

BP

QVFABZ

PRGKSPUNA
```

### 输出

```
4
```

## 样例 #3

### 输入

```
7

RABYBBE

JOZ

BMHQUVA

BPA

ISU

MCMABAOBHZ

SZMEHMA
```

### 输出

```
4
```



---

---
title: "DivRem Number"
layout: "post"
diff: 普及/提高-
pid: AT_diverta2019_d
tag: []
---

# DivRem Number

## 题目描述

[problemUrl]: https://atcoder.jp/contests/diverta2019/tasks/diverta2019_d

すぬけ君は高橋君から正の整数 $ N $ をもらいました。 正の整数 $ m $ が以下の条件を満たすとき、 *お気に入りの数* と呼ばれます。

- $ N $ を $ m $ で割った商とあまりが等しい、すなわち $ \lfloor\ \frac{N}{m}\ \rfloor\ =\ N\ \bmod\ m $ が成立する

お気に入りの数を全て求め、その総和を出力してください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $

## 输出格式

答えを出力せよ。

## 说明/提示

### 制約

- 入力は全て整数
- $ 1\ \leq\ N\ \leq\ 10^{12} $

### Sample Explanation 1

\- お気に入りの数は $ 3 $ と $ 7 $ の $ 2 $ つです。これらの総和である $ 10 $ を出力してください。

### Sample Explanation 2

\- オーバーフローに注意してください。

## 样例 #1

### 输入

```
8
```

### 输出

```
10
```

## 样例 #2

### 输入

```
1000000000000
```

### 输出

```
2499686339916
```



---

---
title: "Tokyo 7th シスターズ"
layout: "post"
diff: 普及/提高-
pid: AT_donuts_2015_2
tag: []
---

# Tokyo 7th シスターズ

## 题目描述

[problemUrl]: https://atcoder.jp/contests/donuts-2015/tasks/donuts_2015_2

[![](https://cdn.luogu.com.cn/upload/vjudge_pic/AT_donuts_2015_2/74c2b3e1b85ca8314470521a99add6ad2f49176a.png)](http://t7s.jp/)[《东京 7th Sisters》](https://mzh.moegirl.org.cn/%E4%B8%9C%E4%BA%AC_7th_Sisters)是一款集成了偶像育成、音乐节奏和文字冒险三大要素的手机网络社交游戏，可以在 iPhone 和 Android 设备上玩。 您正在考虑某些游戏规格的简化版本。


在这款简化规格的游戏中，可以从众多偶像中选择九个不同的偶像，组成一个单位进行节奏游戏和舞台对战。在这种情况下，游戏中使用的单位的基本能力值由所选偶像的能力值总和决定。

游戏还有一个连击系统，玩家可以通过满足连击要求获得连击奖励。如果一个单位有三个或三个以上的成员满足组合规定的条件，该单位就会获得该组合的奖励。对于每个组合，你都可以提前知道哪些偶像将满足指定条件。

单位的最终能力值是单位的基础能力值加上所有组合奖励的总和。

我们希望通过组合偶像来尽可能提高单位的最终能力值。 找出最大最终能力值。

请注意，本题中的单位组合和组合是简化规格，与《东京 7th Sisters》的规格略有不同。

## 输入格式

输入通过如下标准格式输入

> $ N $ $ M $ $ A_1 $ $ A_2 $ ．．． $ A_N $ $ B_1 $ $ C_1 $ $ I_{1,1} $ $ I_{1,2} $ ．．． $ I_{1,C_1} $ $ B_2 $ $ C_2 $ $ I_{2,1} $ $ I_{2,2} $ ．．． $ I_{2,C_2} $ : $ B_M $ $ C_M $ $ I_{M,1} $ $ I_{M,2} $ ．．． $ I_{M,C_M} $

- 第$ 1 $ 行给出了可选偶像的数量 $ N\ (9≦N≦16) $ ，以及仅使用可选偶像生成的组合数 $ M\ (0≦M≦50) $ ，中间用空格隔开。
- 第$ 2 $ 行中有 $ N $ 个整数，用空格隔开。 第 $ i $ 个整数代表第 $ i $ 个偶像的基本能力值 $A_i(1≤A_i≤10,000)$。
- 在 $ 3 $ 至 $ M $ 行中，给出了各自组合的信息。 其中，$ i $(1≤i≤M) 行给出了 $ i $ 个组合的信息，用空格分隔。 组合信息由几个整数组成，其中第一个整数 $ B_i（1≤ B_i≤10,000）$代表第 $ i $ 个组合的组合奖金。第二个整数 $ C_i(3≤C_i≤N)$，代表满足该组合条件的偶像数量。 随后的第三个整数 $ j\ (1≤j≤C_i) $ ，代表有多少偶像满足条件 $ I_{i,j}(1≤I_{i,j}≤N) $。 如果 $ j≠k $ 满足条件，那么 $ I_{i,j}≠ I_{i,k} $ 满足条件。

## 输出格式

在一行上输出单位的最大最终能力值。

### 样例 #1

#### 样例输入 #1

```
10 1
100 200 300 400 500 600 700 800 900 1000
1000 3 1 2 3
```

#### 样例输出 #1

```
6100
```

### 样例 #2

#### 样例输入 #2

```
12 10
1000 1000 1000 1000 1000 1000 1000 1000 1000 1000 1000 1000
1000 4 1 2 4 7
1000 4 1 9 11 12
1000 4 3 5 8 9
1000 4 6 10 11 12
1000 4 2 4 7 10
1000 4 1 8 9 10
1000 3 1 9 12
1000 4 3 8 11 12
1000 4 1 2 3 4
1000 4 7 8 9 10
```

#### 样例输出 #2

```
19000
```

### 样例 #3

#### 样例输入 #3

```
13 8
328 781 104 102 132 108 100 102 104 108 168 102 100
184 4 10 11 3 4
190 4 9 6 2 5
282 6 9 1 3 12 10 8
205 8 13 10 1 12 7 2 8 11
122 8 13 5 4 3 8 9 12 10
112 7 11 6 12 8 2 13 5
102 4 4 13 6 12
109 6 7 2 13 1 8 6
```

#### 样例输出 #3

```
3239
```

## 样例 #1

### 输入

```
10 1

100 200 300 400 500 600 700 800 900 1000

1000 3 1 2 3
```

### 输出

```
6100
```

## 样例 #2

### 输入

```
12 10

1000 1000 1000 1000 1000 1000 1000 1000 1000 1000 1000 1000

1000 4 1 2 4 7

1000 4 1 9 11 12

1000 4 3 5 8 9

1000 4 6 10 11 12

1000 4 2 4 7 10

1000 4 1 8 9 10

1000 3 1 9 12

1000 4 3 8 11 12

1000 4 1 2 3 4

1000 4 7 8 9 10
```

### 输出

```
19000
```

## 样例 #3

### 输入

```
13 8

328 781 104 102 132 108 100 102 104 108 168 102 100

184 4 10 11 3 4

190 4 9 6 2 5

282 6 9 1 3 12 10 8

205 8 13 10 1 12 7 2 8 11

122 8 13 5 4 3 8 9 12 10

112 7 11 6 12 8 2 13 5

102 4 4 13 6 12

109 6 7 2 13 1 8 6
```

### 输出

```
3239
```



---

---
title: "サバゲー"
layout: "post"
diff: 普及/提高-
pid: AT_donuts_live2014_4
tag: []
---

# サバゲー

## 题目描述

[problemUrl]: https://atcoder.jp/contests/donuts-live2014/tasks/donuts_live2014_4

パンチくんが運営している会社では、サバイバルゲームが大流行りです。

通常のサバイバルゲームはチームが $ 2 $ つですが、パンチくんは普通のゲームに飽きてしまったため、多くのチームで対戦することにしました。

参加人数と、チームの数が与えられるので、チームの分け方が何パターンあるか求めて下さい。

ただし、各参加者は必ずどれか $ 1 $ つだけのチームに所属するものとし、また $ 0 $ 人のチームがあってはならないものとします。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ M $

- サバイバルゲームに参加する人数 $ N\ (2\ ≦\ N\ ≦\ 1000) $ と、チームの数 $ M\ (2\ ≦\ M\ ≦\ N) $ が与えられる。

## 输出格式

チームの分け方のパターン数を $ 1000000007(\ =\ 1,000,000,007) $ で割った余りを出力せよ。出力の末尾には改行をいれること。

## 说明/提示

### 部分点

$ M\ =\ 2 $ を満たすテストケースに正解した場合、部分点として $ 40 $ 点が与えられる。

### Sample Explanation 1

$ 2 $ 人を $ 2 $ チームに分ける分け方は、 $ 1 $ 通りしかありません。

### Sample Explanation 2

$ 3 $ 人を $ 2 $ チームに分ける分け方は、 - { $ A,\ B $ }, { $ C $ } - { $ A,\ C $ }, { $ B $ } - { $ A $ }, { $ B,\ C $ } の $ 3 $ 通りです。 参加者は互いに区別がつきますが、チームは区別がつかないことに注意して下さい。 { $ A,\ B $ }, { $ C $ }と、{ $ C $ }, { $ A,\ B $ } は同じものとしてカウントします。

## 样例 #1

### 输入

```
2 2
```

### 输出

```
1
```

## 样例 #2

### 输入

```
3 2
```

### 输出

```
3
```

## 样例 #3

### 输入

```
500 2
```

### 输出

```
695241506
```

## 样例 #4

### 输入

```
20 10
```

### 输出

```
584923236
```



---

---
title: "Knapsack 2"
layout: "post"
diff: 普及/提高-
pid: AT_dp_e
tag: []
---

# Knapsack 2

## 题目描述

$N$ 个物品被编号为 $1, 2, \ldots, N$。对于 $1 \leq i \leq N$，物品 $i$ 的重量是 $w _ i$，价值是 $v _ i$。

太郎君决定从 $N$ 个物品中选择一些放入背包中带回家。背包的容量为 $W$，带回的物品的总重量不能超过 $W$。

请计算太郎君能带回的物品的最大总价值。

## 输入格式

输入以以下格式从标准输入中提供：

> $N$ $W$  
> $w _ 1$ $v _ 1$  
> $w _ 2$ $v _ 2$  
> $\ldots$  
> $w _ N$ $v _ N$

## 输出格式

输出太郎君能带回的物品的最大总价值。

### 限制条件

- 所有输入均为整数。
- $1 \leq N \leq 100$
- $1 \leq W \leq 10 ^ 9$
- $1 \leq w _ i \leq W$
- $1 \leq v _ i \leq 10 ^ 3$

### 样例解释 1

可以选择物品 $1$ 和 $3$。这样，总重量为 $3 + 5 = 8$，总价值为 $30 + 60 = 90$。

### 样例解释 3

可以选择物品 $2, 4, 5$。这样，总重量为 $5 + 6 + 3 = 14$，总价值为 $6 + 6 + 5 = 17$。

---

Translated by User 735713.

## 样例 #1

### 输入

```
3 8

3 30

4 50

5 60
```

### 输出

```
90
```

## 样例 #2

### 输入

```
1 1000000000

1000000000 10
```

### 输出

```
10
```

## 样例 #3

### 输入

```
6 15

6 5

5 6

6 4

6 6

3 5

7 2
```

### 输出

```
17
```



---

---
title: "LCS"
layout: "post"
diff: 普及/提高-
pid: AT_dp_f
tag: []
---

# LCS

## 题目描述

给定一个字符串 $s$ 和一个字符串 $t$ ，输出 $s$ 和 $t$ 的最长公共子序列。

## 输入格式

两行，第一行输入 $s$ ，第二行输入 $t$ 。

## 输出格式

输出 $s$ 和 $t$ 的最长公共子序列。如果有多种答案，输出任何一个都可以。

## 说明/提示

数据保证 $s$ 和 $t$ 仅含英文小写字母，并且 $s$ 和 $t$ 的长度小于等于3000。

## 样例 #1

### 输入

```
axyb

abyxb
```

### 输出

```
axb
```

## 样例 #2

### 输入

```
aa

xayaz
```

### 输出

```
aa
```

## 样例 #3

### 输入

```
a

z
```

### 输出

```

```

## 样例 #4

### 输入

```
abracadabra

avadakedavra
```

### 输出

```
aaadara
```



---

---
title: "Longest Path"
layout: "post"
diff: 普及/提高-
pid: AT_dp_g
tag: []
---

# Longest Path

## 题目描述

[problemUrl]: https://atcoder.jp/contests/dp/tasks/dp_g

$ N $ 頂点 $ M $ 辺の有向グラフ $ G $ があります。 頂点には $ 1,\ 2,\ \ldots,\ N $ と番号が振られています。 各 $ i $ ($ 1\ \leq\ i\ \leq\ M $) について、$ i $ 番目の有向辺は頂点 $ x_i $ から $ y_i $ へ張られています。 $ G $ は**有向閉路を含みません**。

$ G $ の有向パスのうち、最長のものの長さを求めてください。 ただし、有向パスの長さとは、有向パスに含まれる辺の本数のことです。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ M $ $ x_1 $ $ y_1 $ $ x_2 $ $ y_2 $ $ : $ $ x_M $ $ y_M $

## 输出格式

$ G $ の有向パスのうち、最長のものの長さを出力せよ。

## 说明/提示

### 制約

- 入力はすべて整数である。
- $ 2\ \leq\ N\ \leq\ 10^5 $
- $ 1\ \leq\ M\ \leq\ 10^5 $
- $ 1\ \leq\ x_i,\ y_i\ \leq\ N $
- ペア $ (x_i,\ y_i) $ はすべて相異なる。
- $ G $ は**有向閉路を含まない**。

### Sample Explanation 1

次図の赤い有向パスが最長です。 ![](https://img.atcoder.jp/dp/longest_0_muffet.png)

### Sample Explanation 2

次図の赤い有向パスが最長です。 ![](https://img.atcoder.jp/dp/longest_1_muffet.png)

### Sample Explanation 3

例えば、次図の赤い有向パスが最長です。 ![](https://img.atcoder.jp/dp/longest_2_muffet.png)

## 样例 #1

### 输入

```
4 5

1 2

1 3

3 2

2 4

3 4
```

### 输出

```
3
```

## 样例 #2

### 输入

```
6 3

2 3

4 5

5 6
```

### 输出

```
2
```

## 样例 #3

### 输入

```
5 8

5 3

2 3

2 4

5 2

5 1

1 4

4 3

1 3
```

### 输出

```
3
```



---

---
title: "Stones"
layout: "post"
diff: 普及/提高-
pid: AT_dp_k
tag: []
---

# Stones

## 题目描述

$N$ 个正整数组成的集合 $A = \{ a _ 1, a _ 2, \ldots, a _ N \}$。太郎君和次郎君将用以下游戏进行对决。

首先，准备一个有 $K$ 个石子的堆。两人依次进行以下操作。太郎君先手。

- 从集合 $A$ 中选择一个元素 $x$，从石堆中恰好移除 $x$ 个石子。

不能进行操作的人输掉游戏。当两人都按照最优策略行动时，判断谁会获胜。

## 输入格式

输入以以下格式从标准输入中提供：

> $N$ $K$  
> $a_1$ $a_2$ $\ldots$ $a_N$

## 输出格式

如果先手太郎君获胜，输出 `First`；如果后手次郎君获胜，输出 `Second`。

### 限制条件

- 所有输入均为整数。
- $1 \leq N \leq 100$
- $1 \leq K \leq 10^5$
- $1 \leq a _ 1 < a _ 2 < \cdots < a _ N \leq K$

### 样例解释 1

先手取走 $3$ 个石子，后手无法进行操作。因此，先手获胜。

### 样例解释 2

无论先手如何操作，后手总能获胜：

- 如果先手取走 $2$ 个石子，后手取走 $3$ 个石子，先手将无法进行操作。
- 如果先手取走 $3$ 个石子，后手取走 $2$ 个石子，先手将无法进行操作。

### 样例解释 3

先手可以取走 $2$ 个石子。之后，无论后手如何操作，先手都能获胜：

- 如果后手取走 $2$ 个石子，先手取走 $3$ 个石子，后手将无法进行操作。
- 如果后手取走 $3$ 个石子，先手取走 $2$ 个石子，后手将无法进行操作。

---

Translated by User 735713.

## 样例 #1

### 输入

```
2 4

2 3
```

### 输出

```
First
```

## 样例 #2

### 输入

```
2 5

2 3
```

### 输出

```
Second
```

## 样例 #3

### 输入

```
2 7

2 3
```

### 输出

```
First
```

## 样例 #4

### 输入

```
3 20

1 2 3
```

### 输出

```
Second
```

## 样例 #5

### 输入

```
3 21

1 2 3
```

### 输出

```
First
```

## 样例 #6

### 输入

```
1 100000

1
```

### 输出

```
Second
```



---

---
title: "Deque"
layout: "post"
diff: 普及/提高-
pid: AT_dp_l
tag: []
---

# Deque

## 题目描述

[problemUrl]: https://atcoder.jp/contests/dp/tasks/dp_l

太郎君と次郎君が次のゲームで勝負します。

最初に、数列 $ a\ =\ (a_1,\ a_2,\ \ldots,\ a_N) $ が与えられます。 $ a $ が空になるまで、二人は次の操作を交互に行います。 先手は太郎君です。

- $ a $ の先頭要素または末尾要素を取り除く。 取り除いた要素を $ x $ とすると、操作を行った人は $ x $ 点を得る。

ゲーム終了時の太郎君の総得点を $ X $、次郎君の総得点を $ Y $ とします。 太郎君は $ X\ -\ Y $ を最大化しようとし、次郎君は $ X\ -\ Y $ を最小化しようとします。

二人が最適に行動すると仮定したとき、$ X\ -\ Y $ を求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ a_1 $ $ a_2 $ $ \ldots $ $ a_N $

## 输出格式

二人が最適に行動すると仮定したとき、$ X\ -\ Y $ を出力せよ。

## 说明/提示

### 制約

- 入力はすべて整数である。
- $ 1\ \leq\ N\ \leq\ 3000 $
- $ 1\ \leq\ a_i\ \leq\ 10^9 $

### Sample Explanation 1

二人が最適に行動すると、次のように操作が行われます。 操作対象の要素を太字で表しています。 - 先手: (10, 80, 90, \*\*30\*\*) → (10, 80, 90) - 後手: (10, 80, \*\*90\*\*) → (10, 80) - 先手: (10, \*\*80\*\*) → (10) - 後手: (\*\*10\*\*) → () このとき、$ X\ =\ 30\ +\ 80\ =\ 110 $, $ Y\ =\ 90\ +\ 10\ =\ 100 $ となります。

### Sample Explanation 2

二人が最適に行動すると、例えば次のように操作が行われます。 - 先手: (\*\*10\*\*, 100, 10) → (100, 10) - 後手: (\*\*100\*\*, 10) → (10) - 先手: (\*\*10\*\*) → () このとき、$ X\ =\ 10\ +\ 10\ =\ 20 $, $ Y\ =\ 100 $ となります。

### Sample Explanation 4

答えは 32-bit 整数型に収まらない場合があります。

### Sample Explanation 5

二人が最適に行動すると、例えば次のように操作が行われます。 - 先手: (4, 2, 9, 7, 1, \*\*5\*\*) → (4, 2, 9, 7, 1) - 後手: (\*\*4\*\*, 2, 9, 7, 1) → (2, 9, 7, 1) - 先手: (2, 9, 7, \*\*1\*\*) → (2, 9, 7) - 後手: (2, 9, \*\*7\*\*) → (2, 9) - 先手: (2, \*\*9\*\*) → (2) - 後手: (\*\*2\*\*) → () このとき、$ X\ =\ 5\ +\ 1\ +\ 9\ =\ 15 $, $ Y\ =\ 4\ +\ 7\ +\ 2\ =\ 13 $ となります。

## 样例 #1

### 输入

```
4

10 80 90 30
```

### 输出

```
10
```

## 样例 #2

### 输入

```
3

10 100 10
```

### 输出

```
-80
```

## 样例 #3

### 输入

```
1

10
```

### 输出

```
10
```

## 样例 #4

### 输入

```
10

1000000000 1 1000000000 1 1000000000 1 1000000000 1 1000000000 1
```

### 输出

```
4999999995
```

## 样例 #5

### 输入

```
6

4 2 9 7 1 5
```

### 输出

```
2
```



---

---
title: "Slimes"
layout: "post"
diff: 普及/提高-
pid: AT_dp_n
tag: []
---

# Slimes

## 题目描述

[problemUrl]: https://atcoder.jp/contests/dp/tasks/dp_n

$ N $ 匹のスライムが横一列に並んでいます。 最初、左から $ i $ 番目のスライムの大きさは $ a_i $ です。

太郎君は、すべてのスライムを合体させて $ 1 $ 匹のスライムにしようとしています。 スライムが $ 1 $ 匹になるまで、太郎君は次の操作を繰り返し行います。

- 左右に隣り合う $ 2 $ 匹のスライムを選び、それらを合体させて新しい $ 1 $ 匹のスライムにする。 合体前の $ 2 $ 匹のスライムの大きさを $ x $ および $ y $ とすると、合体後のスライムの大きさは $ x\ +\ y $ となる。 このとき、太郎君は $ x\ +\ y $ のコストを支払う。 なお、合体の前後でスライムたちの位置関係は変わらない。

太郎君が支払うコストの総和の最小値を求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ a_1 $ $ a_2 $ $ \ldots $ $ a_N $

## 输出格式

太郎君が支払うコストの総和の最小値を出力せよ。

## 说明/提示

### 制約

- 入力はすべて整数である。
- $ 2\ \leq\ N\ \leq\ 400 $
- $ 1\ \leq\ a_i\ \leq\ 10^9 $

### Sample Explanation 1

次のように操作を行えばよいです。 操作対象のスライムを太字で表しています。 - (\*\*10\*\*, \*\*20\*\*, 30, 40) → (\*\*30\*\*, 30, 40) - (\*\*30\*\*, \*\*30\*\*, 40) → (\*\*60\*\*, 40) - (\*\*60\*\*, \*\*40\*\*) → (\*\*100\*\*)

### Sample Explanation 2

例えば、次のように操作を行えばよいです。 - (\*\*10\*\*, \*\*10\*\*, 10, 10, 10) → (\*\*20\*\*, 10, 10, 10) - (20, \*\*10\*\*, \*\*10\*\*, 10) → (20, \*\*20\*\*, 10) - (20, \*\*20\*\*, \*\*10\*\*) → (20, \*\*30\*\*) - (\*\*20\*\*, \*\*30\*\*) → (\*\*50\*\*)

### Sample Explanation 3

答えは 32-bit 整数型に収まらない場合があります。

### Sample Explanation 4

例えば、次のように操作を行えばよいです。 - (7, 6, 8, 6, \*\*1\*\*, \*\*1\*\*) → (7, 6, 8, 6, \*\*2\*\*) - (7, 6, 8, \*\*6\*\*, \*\*2\*\*) → (7, 6, 8, \*\*8\*\*) - (\*\*7\*\*, \*\*6\*\*, 8, 8) → (\*\*13\*\*, 8, 8) - (13, \*\*8\*\*, \*\*8\*\*) → (13, \*\*16\*\*) - (\*\*13\*\*, \*\*16\*\*) → (\*\*29\*\*)

## 样例 #1

### 输入

```
4

10 20 30 40
```

### 输出

```
190
```

## 样例 #2

### 输入

```
5

10 10 10 10 10
```

### 输出

```
120
```

## 样例 #3

### 输入

```
3

1000000000 1000000000 1000000000
```

### 输出

```
5000000000
```

## 样例 #4

### 输入

```
6

7 6 8 6 1 1
```

### 输出

```
68
```



---

---
title: "すべては1になる"
layout: "post"
diff: 普及/提高-
pid: AT_fuka_insider
tag: []
---

# すべては1になる

## 题目描述

[problemUrl]: https://atcoder.jp/contests/fuka5/tasks/fuka_insider





---

---
title: "流れ"
layout: "post"
diff: 普及/提高-
pid: AT_fuka_liquid
tag: []
---

# 流れ

## 题目描述

有一个$w\times h$的网格，网格上的每个格子都有对应的高度。

现在，往方格上倒水。

当某个方格内有水，而相邻的方格又比此方格低时，水就会向相邻的方格扩散。

两个方格在有同一条边时被认为是相邻的。

求一格水扩散的方格数量。

## 输入格式

输入文件有多组数据，输入三个$0$表示结束。

对于每组数据，用以下形式给出。

$w\;h\;p$

$Z_{0,0}\;Z_{0,1}\cdots\!Z_{0,w-1}$\
$Z_{1,0}\;Z_{1,1}\cdots\!Z_{1,w-1}$\
$\cdots$\
$Z_{h-1,0},Z_{h-1,1}\cdots\!Z_{h-1,w-1}$

$X_{1} Y_{1}$\
$\cdots$\
$X_{p} Y_{p}$

其中每组数据的第一行为$3$个整数$w,h,p$，

其中$w,h$表示网格的边长，$p$表示倒水的次数。

接下来$h$行，每行$w$个整数$Z_{i,j}$，

表示第$i$行第$j$列的方格的高度。

接下来$p$行，每行$2$个整数$X_{i},Y_{i}$，

表示在第$X_{i}$行第$Y_{i}$列的方格倒水。

数据存在往倒过水的方格再次倒水的情况。

测试数据不超过$20$个。

## 输出格式

对于每组测试数据，输出一行一个整数，表示水扩散到的方格数量。
### 输入样例
```
2 2 1
1 0
0 1
1 0
2 2 1
1 0
0 1
1 1
1 1 0
100
5 5 2
5 4 5 5 5
5 3 5 1 5
5 2 1 2 5
5 3 5 3 5
5 5 5 5 5
0 0
2 2
0 0 0
```
### 输出样例
```
1
3
0
5
```

## 说明/提示

$1\leq w,h\leq 20$\
$0\leq p\leq w \times h$\
$0\leq Z_{i,j}\leq 100$\
$0\leq X_{i}<w$\
$0\leq Y_{i}<h$



---

---
title: "国際情報オリンピック日本代表プログラミングコンテスト (Welcome to IJPC)"
layout: "post"
diff: 普及/提高-
pid: AT_ijpc_ijpc
tag: []
---

# 国際情報オリンピック日本代表プログラミングコンテスト (Welcome to IJPC)

## 题目描述

[problemUrl]: https://atcoder.jp/contests/ijpc2012pr/tasks/ijpc_ijpc





---

---
title: "Table Tennis"
layout: "post"
diff: 普及/提高-
pid: AT_indeednow_2015_finala_a
tag: []
---

# Table Tennis

## 题目描述

[problemUrl]: https://atcoder.jp/contests/indeednow-finala-open/tasks/indeednow_2015_finala_a

 Indeed 社のオフィスには卓球台がある。  
 $ n $ 人の社員が卓球のダブルスで試合をすることにした。  
 $ 2 $ 人ずつのペアを作ることにしたが、みんなが楽しめるようにできるだけ各ペアの強さを均等にしたいと考えている。  
 $ i $ 番目の人の卓球の強さは $ a_i $ で表され、ペアの強さは $ 2 $ 人の強さの和で決まる。  
 一番強いペアと一番弱いペアの強さの差が最小になるようにペアを作ったときに、その差はいくつになるだろうか。

## 输入格式

入力は以下の形式で与えられる。

> $ n $ $ a_1 $ $ a_2 $ $ ... $ $ a_n $

- $ 1 $ 行目には、社員の数を表す整数 $ n $ ($ 4\ \leq\ n\ \leq\ 100 $, $ n $ は偶数) が与えられる。
- $ 2 $ 行目には、社員の卓球の強さを表す整数 $ a_i $ ($ 1\ \leq\ a_i\ \leq\ 1{,}000 $) がスペース区切りで $ n $ 個与えられる。

## 输出格式

求める値を一行で出力せよ。

## 说明/提示

### Sample Explanation 1

{$ (1,3),\ (4,10) $}, {$ (1,4),\ (3,\ 10) $}, {$ (1,10),\ (3,4) $} の $ 3 $ 通りのチーム分けが考えられる。 このうち、もっともペアの強さの差が小さいものは {$ (1,10),\ (3,4) $} であり、その差は $ 4 $ である

## 样例 #1

### 输入

```
4

1 3 4 10
```

### 输出

```
4
```

## 样例 #2

### 输入

```
4

1 3 4 4
```

### 输出

```
2
```



---

---
title: "How are you?"
layout: "post"
diff: 普及/提高-
pid: AT_indeednow_2015_finalb_b
tag: []
---

# How are you?

## 题目描述

[problemUrl]: https://atcoder.jp/contests/indeednow-finalb-open/tasks/indeednow_2015_finalb_b

Indeed 社には $ N $ 人の社員がいます。社員 $ i\ (1\ ≦\ i\ ≦\ N) $ は時刻 $ S_i $ に出社し、時刻 $ T_i $ に退社します。各社員は、自分がオフィスにいる間に出社してきた社員に対して "How are you?" と聞きます。すなわち、$ S_i\ <\ S_j\ <\ T_i $ を満たすとき、社員 $ i $ は社員 $ j $ に対して "How are you?" と聞きます。

あなたは、それぞれの社員が何人に対して "How are you?" と聞くかを計算することにしました。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ S_1 $ $ T_1 $ $ S_2 $ $ T_2 $ : $ S_N $ $ T_N $

- $ 1 $ 行目には、社員の人数を表す整数 $ N\ (1\ ≦\ N\ ≦\ 10^5) $ が与えられる。
- $ 2 $ 行目からの $ N $ 行には、社員の出社時刻と退社時刻の情報が与えられる。このうち $ i $ 行目には、$ 2 $ つの整数 $ S_i,\ T_i\ (1\ ≦\ S_i\ <\ T_i\ ≦\ N*2) $ が空白区切りで与えられる。これは、社員 $ i $ が時刻 $ S_i $ に出社し、時刻 $ T_i $ に退社することを表す。ただし、$ S_i\ =\ S_j $ または $ S_i\ =\ T_j $ を満たすような $ i,j\ (1\ ≦\ i\ <\ j\ ≦\ N) $ は存在しないことが保証される。(16:18削除)
- 与えられる出社時刻と退社時刻は全て相異なる。つまり、$ S_1,…,S_N,T_1,…,T_N $ は全て異なる。(16:18追加)

## 输出格式

出力は $ N $ 行からなる。このうち $ i $ 行目には、社員 $ i $ が "How are you?" と聞く社員の人数を表す $ 1 $ つの整数を出力せよ。出力の末尾にも改行を入れること。

## 说明/提示

### 部分点

この問題には部分点が設定されている。

- $ N\ ≦\ 2000 $ を満たすデータセット $ 1 $ に正解した場合は、$ 30 $ 点が与えられる。
- 全てのテストケースに正解した場合は、上記とは別に $ 70 $ 点が与えられる。

### Sample Explanation 1

この入力例では、 - 社員 $ 1 $ は、社員 $ 2 $ と 社員 $ 3 $ と社員 $ 4 $ に対して "How are you?" と聞きます。 - 社員 $ 2 $ は、社員 $ 3 $ に対して "How are you?" と聞きます。 - 社員 $ 3 $ は、社員 $ 4 $ に対して "How are you?" と聞きます。 - 社員 $ 4 $ は、誰にも "How are you?" と聞きません。

## 样例 #1

### 输入

```
4

1 6

2 4

3 7

5 8
```

### 输出

```
3

1

1

0
```

## 样例 #2

### 输入

```
7

5 12

10 11

1 2

6 13

4 7

3 8

9 14
```

### 输出

```
3

0

0

2

2

3

1
```



---

---
title: "高橋くんと数列"
layout: "post"
diff: 普及/提高-
pid: AT_indeednow_2015_qualb_4
tag: []
---

# 高橋くんと数列

## 题目描述

[problemUrl]: https://atcoder.jp/contests/indeednow-qualb/tasks/indeednow_2015_qualb_4

高橋くんは長さ $ N $ の $ 1 $ から $ C $ の整数からなる数列 $ \{a_N\}\ =\ \{a_1,a_2,\ ...,a_N\} $ を受け取って、 $ 1 $ 以上 $ C $ 以下のそれぞれの整数について、その数を1つでも含む連続する部分列の数を返す機械です。

より正確には、 $ 1 $ 以上 $ C $ 以下の整数 $ k $ について、 $ 1\ ≦\ l\ ≦\ r\ ≦\ N $ となるような $ l,r $ で、 $ a_i\ =\ k $ かつ $ l≦\ i\ ≦\ r $ を満たすものが存在するような $ (l,r) $ の組の数を高橋くんは求めます。

連続する部分列の中身が同じでも、$ (l,r) $ の組が異なれば異なるものとして認識することに注意してください。 高橋くんの動作を確認するためのプログラムを書いてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ C $ $ a_1 $ $ a_2 $ … $ a_N $

- $ 1 $ 行目には、数列の長さ $ N\ (1\ ≦\ N\ ≦\ 10^5) $ と数列の要素の最大値 $ C\ (1\ ≦\ C\ ≦\ N) $ がスペース区切りで与えられる。
- $ 2 $ 行目には、高橋くんが受け取った数列の要素の数を表す $ N $ 個の数が空白区切りで与えられる。$ 1\ ≦\ a_i\ ≦\ C $ であることが保証される。また、$ 1 $ 以上 $ C $ 以下のすべての整数 $ k $ に対し、 $ a_i\ =\ k $を満たす $ i $ が存在することが保証される。

## 输出格式

$ i\ (1\ ≦\ i\ ≦\ C) $ 行目には、$ \{a_N\} $ のうち $ i $ を含む連続する部分列の数を出力せよ。

末尾の改行を忘れないこと。また、それぞれの行の末尾に余計な空白を付け加えないこと。

## 说明/提示

### 部分点

この問題には部分点が設定されている。

- $ 30 $ 点分のテストケースにおいて、$ 1≦C≦20 $ を満たす。

### Sample Explanation 1

$ 1 $ を含む連続する部分列として当てはまるものは、 $ (l,r)=(1,1),(1,2),(1,3),(1,4),(2,4),(3,4),(4,4) $ $ 2 $ を含む連続する部分列として当てはまるものは、 $ (l,r)=(1,2),(1,3),(1,4),(2,2),(2,3),(2,4),(3,3),(3,4) $ です。

## 样例 #1

### 输入

```
4 2

1 2 2 1
```

### 输出

```
7

8
```

## 样例 #2

### 输入

```
4 4

1 4 2 3
```

### 输出

```
4

6

4

6
```

## 样例 #3

### 输入

```
5 1

1 1 1 1 1
```

### 输出

```
15
```



---

---
title: "木"
layout: "post"
diff: 普及/提高-
pid: AT_indeednow_2015_qualc_3
tag: []
---

# 木

## 题目描述

[problemUrl]: https://atcoder.jp/contests/indeednow-qualb/tasks/indeednow_2015_qualc_3

木とは、頂点とそれを結ぶ辺からなる構造「グラフ」の $ 1 $ 種で、頂点の数を $ N $ 個とすると、辺は $ N-1 $ 本あり、どの頂点も他の全ての頂点に辺で間接・直接的につながっています。

 ![](https://cdn.luogu.com.cn/upload/vjudge_pic/AT_indeednow_2015_qualc_3/db302ed5e6211ee095f87c2aa4b931b136442faf.png)

この問題では、頂点は $ N $ 個あり、$ 1 $ から $ N $ まで番号付けられています。

木が与えられたとき、以下の操作で作られる数列のうち、辞書順で最小のものを出力してください。

1. 頂点1を選ぶ。
2. 今まで選ばれた頂点と辺で結ばれている頂点のうち、まだ選ばれていない頂点を1つ選ぶ、という操作を選ばれていない頂点が無くなるまで繰り返す。
3. 頂点の番号を選ばれた順に並べた数列を作る。

ただし、長さ $ N $ の列 $ A=\{a_1,a_2,\ ...,a_N\} $ と $ B=\{b_1,b_2,\ ...,b_N\} $ に対し、辞書順で $ A $ が $ B $ より小さいとは、

- $ i\ で\ a_i $=$ b_i $
- $ i\ =\ k $ で $ a_i $b\_i

となるような $ k(1≦k≦N) $ が存在するということです。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ a_1 $ $ b_1 $ $ a_2 $ $ b_2 $ ： $ a_{N-1} $ $ b_{N-1} $

- $ 1 $ 行目には、木の頂点の数を表す整数 $ N\ (2\ ≦\ N\ ≦\ 10^5) $ が与えられる。
- $ 2 $ 行目から $ N-1 $ 行には、木の辺の情報が与えられる。このうち $ i\ (1\ ≦\ i\ ≦\ N-1) $ 行目には頂点 $ a_i $ と頂点 $ b_i $ を結ぶ辺があることを表す $ 2 $ つの整数 $ a_i $ , $ b_i $ が与えられる。
- $ N-1 $ 本の辺で結ばれる $ N $ 個の頂点は木を成すことが保障される。

## 输出格式

$ 1 $ 行目に、与えられた木から作られる辞書順で最小の数列を空白区切りで出力せよ。

行末の改行を忘れないこと。また，行末に余分な空白を入れてはならない。

## 说明/提示

### 部分点

この問題には部分点が設定されている。

- $ 50 $ 点分のテストケースにおいて、 $ 1\ ≦\ N\ ≦\ 3,000 $ を満たす。

### Sample Explanation 1

問題文中の図の木です。 まず、初めに頂点 $ 1 $ を選びます。 !\[\](http://indeednow-qualb.contest.atcoder.jp/img/other/indeednow-qualb/C\_sample2.png) 次に、頂点 $ 3 $ を選びます。頂点 $ 2 $ は今まで選んだ頂点(この場合、頂点 $ 1 $ のみ)と辺で結ばれていないので、選ぶことができないことに注意してください。 !\[\](http://indeednow-qualb.contest.atcoder.jp/img/other/indeednow-qualb/C\_sample3.png) 次に、頂点 $ 2 $ を選びます。 !\[\](http://indeednow-qualb.contest.atcoder.jp/img/other/indeednow-qualb/C\_sample4.png) 次に、頂点 $ 4 $ を選びます。 !\[\](http://indeednow-qualb.contest.atcoder.jp/img/other/indeednow-qualb/C\_sample5.png) 頂点の番号を選んだ順に並べると、$ 1 $ $ 3 $ $ 2 $ $ 4 $ となります。この列より辞書順で小さい選び方は存在しません。

## 样例 #1

### 输入

```
4

1 3

1 4

2 3
```

### 输出

```
1 3 2 4
```

## 样例 #2

### 输入

```
6

1 2

2 3

2 6

6 4

1 5
```

### 输出

```
1 2 3 5 6 4
```

## 样例 #3

### 输入

```
7

1 5

5 2

5 3

5 7

5 6

6 4
```

### 输出

```
1 5 2 3 6 4 7
```



---

---
title: "Not Say "NO""
layout: "post"
diff: 普及/提高-
pid: AT_iroha2019_day3_c
tag: []
---

# Not Say "NO"

## 题目描述

[problemUrl]: https://atcoder.jp/contests/iroha2019-day3/tasks/iroha2019_day3_c

まず、以下の問題を読んでください。

> $ 1,2,\dots,N $ の番号のついた $ N $ 人の子供がいて、**互いに価値の異なる**プレゼントが $ K $ 個ある。 $ i $ 個目のプレゼントの価値は $ V_i $ である。 全てのプレゼントを子供たちに分けるとき、全ての子供が最終的に合計で同じ価値のプレゼントを得るようにできるだろうか? 可能なら`YES`と出力し、分け方の一例を示してください。 不可能なら`NO`と出力してください。
> 
> ### 制約
> 
> - $ 1\ \le\ N\ \le\ 100 $
> - $ 2\times\ N-1\ \le\ K\ \le\ 10^4 $
> - $ 1\ \le\ V_i\ \le\ 10^{14}(1\ \le\ i\ \le\ K) $
> - $ V_i\ \neq\ V_j(1\ \le\ i\ <\ j\ \le\ K) $

 $ N,K $ が与えられるので、この問題のテストケースを解の一例とともに生成してください。 ただし、解が`NO`となるケースを生成してはいけません。 なお、この問題においてこの制約のもとでどんな入力でも解が存在することが示せます。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N\ K $

## 输出格式

以下の形式で出力せよ。

> $ V_1\ V_2\ \cdots\ V_K $ $ S $ $ R_1\ R_2\ \cdots\ R_K $

まず、 $ 1 $ 行目に生成したテストケース $ V_i $ を出力してください。

次に、テストケースの解である $ S $ を出力してください。 $ S $ は`YES`か`NO`である必要がありますが、解が`NO`となるケースを生成してはいけません。

最後に、 $ S $ が`YES`の場合、分け方の一例を示してください。 $ R_i=X(1\le\ X\ \le\ N) $ の場合、 $ i $ 番目のプレゼントが $ R_i $ 番の子供に渡されたことを表します。

## 说明/提示

### 解説

 [Not Say "NO" - 解説](https://img.atcoder.jp/iroha2019-day3/editorial-C.pdf)

## 样例 #1

### 输入

```
3 6
```

### 输出

```
3 5 2 6 4 1

YES

3 2 2 1 3 1
```

## 样例 #2

### 输入

```
2 5
```

### 输出

```
100 10 20 30 40

YES

2 1 1 1 1
```



---

---
title: "共通部分文字列"
layout: "post"
diff: 普及/提高-
pid: AT_joi2008ho_b
tag: []
---

# 共通部分文字列

## 题目描述

[problemUrl]: https://atcoder.jp/contests/joi2008ho/tasks/joi2008ho_b





---

---
title: "JOIOI の塔 (Tower of JOIOI)"
layout: "post"
diff: 普及/提高-
pid: AT_joi2013ho4
tag: []
---

# JOIOI の塔 (Tower of JOIOI)

## 题目描述

JOIOI 塔是一种单人游戏。

这个游戏要用到一些写有 `J`, `O`, `I` 中任一文字的圆盘。这些圆盘的直径互不相同。游戏开始时，这些圆盘按照直径大的在下面的规则堆叠。你需要用这些圆盘做尽量多的迷你 JOIOI 塔。迷你 JOIOI 塔由 $3$ 个圆盘构成，从直径较小的圆盘开始分别为 `J`, `O`, `I` 或分别为 `I`, `O`, `I` 。不过，每个圆盘最多只能使用一次。

给出长为 $N$ 的字符串 $S$ ，表示直径从小到大的圆盘上的文字。请编写程序求出使用这些圆盘能够做出的迷你 JOIOI 塔个数的最大值。

## 输入格式

第一行为一个整数 $N$ ，表示字符串 $S$ 的长度。

第二行是一个字符串 $S$ 。

## 输出格式

一行一个整数：表示能够做出的迷你 JOIOI 塔数量的最大值。

### 输入输出样例解释

#### 样例 1

`JOIIOI` 分别含子串 `JOI` 和子串 `IOI` 各一个，故可以做出 2 个迷你 JOIOI 塔。

#### 样例 2

虽然 `JOIOI` 也分别含子串 `JOI` 和子串 `IOI` 各一个，但每个字符不能被使用两次或以上。

#### 样例 3

## 说明/提示

对于所有数据，$1\leq N \leq 10^6$。

| 子任务 |     分值      |   $N\le$    |
| :----: | :-----------: | :---------: |
|  $1$   |     $10$      | $N \leq 15$ |
|  $2$   |     $20$      | $N \leq 50$ |
|  $3$   | $N \leq 3000$ | $N\leq3000$ |
|  $4$   |     $50$      | $N\leq10^6$ |

## 样例 #1

### 输入

```
6
JOIIOI
```

### 输出

```
2
```

## 样例 #2

### 输入

```
5
JOIOI
```

### 输出

```
1
```

## 样例 #3

### 输入

```
6
JOIOII
```

### 输出

```
2
```

## 样例 #4

### 输入

```
15
JJOIIOOJOJIOIIO
```

### 输出

```
4
```



---

---
title: "シルクロード (Silk Road)"
layout: "post"
diff: 普及/提高-
pid: AT_joi2015yo_d
tag: []
---

# シルクロード (Silk Road)

## 题目描述

商人JOI先生带着货物，从0号城市出发，丝绸之路包括起点和终点一共有N+1个城市。要求不超过M天内必须到达终点。一天的时间可以从一个城市到连续的下一个城市。从i-1城市到i城市距离是Di。

JOI先生在一个城市时，可以有以下选择：

移动：向下一个城市进发

休息：呆在原来的城市不动

沙漠天气变化无常，在天气很不好时，前进会遇到很多困难。我们把M天的第j(1<=j<=M)天的气候恶劣值记为Cj。从i-1城市移动到i城市在第j天进发时，需要耗费Di*Cj的疲劳度。

不过JOI先生还是有选择权的，可以避开比较恶劣的天气，休息是不会消耗疲劳值的。现在他想知道整个行程最少要消耗多少疲劳值。

## 输入格式

第一行2个整数N，M

连续N行每行一个整数Dj

连续M行每行一个整数Cj

## 输出格式

一个整数，表示最小疲劳度

## 样例 #1

### 输入

```
3 5
10
25
15
50
30
15
40
30
```

### 输出

```
1125
```

## 样例 #2

### 输入

```
2 6
99
20
490
612
515
131
931
1000
```

### 输出

```
31589
```



---

---
title: "オレンジの出荷 (Oranges)"
layout: "post"
diff: 普及/提高-
pid: AT_joi2016ho_a
tag: []
---

# オレンジの出荷 (Oranges)

## 题目描述

CXR决定将收获的$n$个橙子分装进一些箱子内。在NXY的工厂中，橙子排列在输送带上，依次编号为$1...n$。橙子$i(1\leq i\leq n$)的大小为$A_i$。由于分拣不方便，同一个箱子内，橙子的编号必须连续。



一个箱子内最多可以装$m$个橙子。在一个箱子内装一些橙子的成本为$k+s\times (a-b)$。$k$是箱子本身的成本，所有箱子的成本一样。$s$是该箱子中橙子的数目。 $a$是该箱子中最大橙子的大小，$b$是该箱子中最小橙子的大小。



求包装这$n$个橙子所需的最小成本。

## 输入格式

第一行有三个整数$n,m,k$，用空格分隔。



在接下来的$n$行中，第$i$行$(1\leq i\leq n)$有一个整数$A_i$。

## 输出格式

输出一个整数，表示包装这$n$个橙子所需的最小成本。



## 输入样例 1

```

6 3 6

1

2

3

1

2

1

```

## 输出样例 1

```

21

```



## 输入样例 2

```

16 4 12

3

10

13

10

19

9

12

16

11

2

19

9

13

2

13

19

```

## 输出样例 2

```

164

```



## 样例输入 3

```

16 6 14

19

7

2

15

17

7

14

12

3

14

5

10

17

20

19

12

```

## 样例输出 3

```

177

```

## 样例输入 4

```

10 1 1000000000

1

1

1

1

1

1

1

1

1

1

```

## 样例输出 4

```

10000000000

```

## 样例解释 4



答案可能会爆$int$。

## 说明/提示

- 1≤N≤20 000

- 1≤M≤1 000

- 0≤K≤1 000 000 000

- 1≤A_i≤1 000 000 000 (1≤i≤N)

- M≤N



本题：JOI 2016 Final T1「オレンジの出荷」

## 样例 #1

### 输入

```
6 3 6
1
2
3
1
2
1
```

### 输出

```
21
```

## 样例 #2

### 输入

```
16 4 12
3
10
13
10
19
9
12
16
11
2
19
9
13
2
13
19
```

### 输出

```
164
```

## 样例 #3

### 输入

```
16 6 14
19
7
2
15
17
7
14
12
3
14
5
10
17
20
19
12
```

### 输出

```
177
```

## 样例 #4

### 输入

```
10 1 1000000000
1
1
1
1
1
1
1
1
1
1
```

### 输出

```
10000000000
```



---

---
title: "美術展 (Art Exhibition)"
layout: "post"
diff: 普及/提高-
pid: AT_joi2018ho_b
tag: []
---

# 美術展 (Art Exhibition)

## 题目描述

[problemUrl]: https://atcoder.jp/contests/joi2018ho/tasks/joi2018ho_b

JOI 国で美術展が行われることになった．美術展では，国中から集まった様々な美術品が展示される予定である．

展示される美術品の候補として，$ N $ 点の美術品が集まった．これらの美術品には $ 1,\ 2,\ \ldots,\ N $ の番号が付けられている．それぞれの美術品には大きさと価値と呼ばれる値が定まっている．美術品 $ i $ ($ 1\ \leqq\ i\ \leqq\ N $) の大きさは $ A_i $，価値は $ B_i $ である．

美術展では，これらの美術品のうちから $ 1 $ 点以上を選んで展示する．美術展の会場は十分に広く，$ N $ 点の美術品すべてを展示することも可能である．しかし，JOI 国の人々の美的感覚のため，美術品の間で大きさの差があまり大きくならないように展示する美術品を選びたい．一方，できるだけ価値の大きい美術品を多く展示したい．そのため，次の条件を満たすように展示する美術品を選ぶことにした：

- 選んだ美術品の中で，大きさが最大のものの大きさを $ A_{\mathrm{max}} $，最小のものの大きさを $ A_{\mathrm{min}} $ とする．また，選んだ美術品の価値の総和を $ S $ とする．
- このとき，$ S\ -\ (A_{\mathrm{max}}\ -\ A_{\mathrm{min}} $) を最大化する．

## 输入格式

標準入力から以下の入力を読み込め．

- $ 1 $ 行目には，整数 $ N $ が書かれている．これは，展示される美術品の候補の個数を表す．
- 続く $ N $ 行のうちの $ i $ 行目 ($ 1\ \leqq\ i\ \leqq\ N $) には，$ 2 $ 個の整数 $ A_i,\ B_i $ が空白を区切りとして書かれている．これらは，美術品 $ i $ の大きさが $ A_i $，価値が $ B_i $ であることを表す．

## 输出格式

標準出力に，$ S\ -\ (A_{\mathrm{max}}\ -\ A_{\mathrm{min}}) $ の最大値を $ 1 $ 行で出力せよ．

- - - - - -

## 说明/提示

### 課題

展示される美術品の候補の個数と，それぞれの美術品の大きさと価値が与えられたとき，$ S\ -\ (A_{\mathrm{max}}\ -\ A_{\mathrm{min}}) $ の最大値を求めよ．

- - - - - -

### 制限

すべての入力データは以下の条件を満たす．

- $ 2\ \leqq\ N\ \leqq\ 500\,000 $．
- $ 1\ \leqq\ A_i\ \leqq\ 1\,000\,000\,000\,000\,000\ =\ 10^{15} $ ($ 1\ \leqq\ i\ \leqq\ N $)．
- $ 1\ \leqq\ B_i\ \leqq\ 1\,000\,000\,000 $ ($ 1\ \leqq\ i\ \leqq\ N $)．

### 小課題

#### 小課題 1 \[10 点\]

- $ N\ \leqq\ 16 $ を満たす．

#### 小課題 2 \[20 点\]

- $ N\ \leqq\ 300 $ を満たす．

#### 小課題 3 \[20 点\]

- $ N\ \leqq\ 5\,000 $ を満たす．

#### 小課題 4 \[50 点\]

- 追加の制限はない．

- - - - - -

### Sample Explanation 1

この入力例では，展示される美術品の候補が $ 3 $ 点ある．それぞれの美術品の大きさ，価値は次の通りである． - 美術品 $ 1 $ の大きさは $ 2 $，価値は $ 3 $ である． - 美術品 $ 2 $ の大きさは $ 11 $，価値は $ 2 $ である． - 美術品 $ 3 $ の大きさは $ 4 $，価値は $ 5 $ である． この場合，美術品 $ 1 $ と美術品 $ 3 $ を展示するために選ぶと，次のようにして $ S\ -\ (A_{\mathrm{max}}\ -\ A_{\mathrm{min}})\ =\ 6 $ となる． - 選んだ中で大きさが最大の美術品は，美術品 $ 3 $ である．よって，$ A_{max}\ =\ 4 $ である． - 選んだ中で大きさが最小の美術品は，美術品 $ 1 $ である．よって，$ A_{min}\ =\ 2 $ である． - 選んだ美術品の価値の総和は $ 3\ +\ 5\ =\ 8 $ であるから，$ S\ =\ 8 $ である． $ S\ -\ (A_{max}\ -\ A_{min}) $ を $ 7 $ 以上にすることは不可能なので，$ 6 $ を出力する． - - - - - -

### Sample Explanation 2

\- - - - - -

## 样例 #1

### 输入

```
3
2 3
11 2
4 5
```

### 输出

```
6
```

## 样例 #2

### 输入

```
6
4 1
1 5
10 3
9 1
4 2
5 3
```

### 输出

```
7
```

## 样例 #3

### 输入

```
15
1543361732 260774320
2089759661 257198921
1555665663 389548466
4133306295 296394520
2596448427 301103944
1701413087 274491541
2347488426 912791996
2133012079 444074242
2659886224 656957044
1345396764 259870638
2671164286 233246973
2791812672 585862344
2996614635 91065315
971304780 488995617
1523452673 988137562
```

### 输出

```
4232545716
```



---

---
title: "勇者ビ太郎 (Bitaro the Brave)"
layout: "post"
diff: 普及/提高-
pid: AT_joi2019ho_a
tag: []
---

# 勇者ビ太郎 (Bitaro the Brave)

## 题目描述

[problemUrl]: https://atcoder.jp/contests/joi2019ho/tasks/joi2019ho_a

![2019-ho-t1-fig01.jpg](https://cdn.luogu.com.cn/upload/vjudge_pic/AT_joi2019ho_a/09009490d7383ad8a773f434baef49f70d623222.png)

勇者のビ太郎は，魔王と対峙することとなった．

ビ太郎は，縦 $ H $ 行，横 $ W $ 列のマス目上に宝石 (Jewel)，オーブ (Orb)，金塊 (Ingot) を配置し，魔法を発動することによって魔王に攻撃をしようとしている．以下，マス目のうち上から $ i $ 行目 ($ 1\ \leqq\ i\ \leqq\ H $)，左から $ j $ 列目 ($ 1\ \leqq\ j\ \leqq\ W $) のマスを，マス $ (i,\ j) $ と表す．

ビ太郎は今，それぞれのマスにこれら $ 3 $ 種類のうち $ 1 $ 個を配置した．今から魔法を発動しようとしているが，この魔法の威力はマス目上の宝石，オーブ，金塊の配置によって決まる．具体的には，次の条件を満たす整数 $ (i,\ j,\ k,\ l) $ ($ 1\ \leqq\ i\ <\ k\ \leqq\ H $，$ 1\ \leqq\ j\ <\ l\ \leqq\ W $) の組の個数が，魔法の威力である．

条件：マス $ (i,\ j) $ には宝石が，マス $ (i,\ l) $ にはオーブが，マス $ (k,\ j) $ には金塊が置かれている．

ビ太郎は，この魔法の威力が気になっている．

マス目上の宝石，オーブ，金塊の配置が与えられたとき，ビ太郎が発動する魔法の威力を求めるプログラムを作成せよ．

- - - - - -

## 输入格式

入力は以下の形式で標準入力から与えられる．

> $ H $ $ W $ $ S_1 $ $ \vdots $ $ S_H $

$ S_i $ ($ 1\ \leqq\ i\ \leqq\ H $) は長さ $ W $ の文字列で，その $ j $ 文字目 ($ 1\ \leqq\ j\ \leqq\ W $) が `J` のときはマス $ (i,\ j) $ に宝石が，`O` のときはマス $ (i,\ j) $ にオーブが，`I` のときはマス $ (i,\ j) $ に金塊が置かれていることを表す．

## 输出格式

標準出力に，魔法の威力を表す整数を $ 1 $ 行で出力せよ．

- - - - - -

## 说明/提示

### 制約

- $ 2\ \leqq\ H\ \leqq\ 3\,000 $．
- $ 2\ \leqq\ W\ \leqq\ 3\,000 $．
- $ S_i $ は長さ $ W $ の文字列である ($ 1\ \leqq\ i\ \leqq\ H $)．
- $ S_i $ の各文字は `J`，`O`，`I` のいずれかである ($ 1\ \leqq\ i\ \leqq\ H $)．

### 小課題

1. ($ 20 $ 点) $ H\ \leqq\ 100 $，$ W\ \leqq\ 100 $．
2. ($ 30 $ 点) $ H\ \leqq\ 500 $，$ W\ \leqq\ 500 $．
3. ($ 50 $ 点) 追加の制約はない．

- - - - - -

### Sample Explanation 1

この入力例では，$ (i,\ j,\ k,\ l)\ =\ (1,\ 1,\ 3,\ 2),\ (2,\ 1,\ 3,\ 3),\ (2,\ 1,\ 3,\ 4) $ の $ 3 $ 個の組が条件を満たすので，答えは $ 3 $ である． - - - - - -

## 样例 #1

### 输入

```
3 4
JOIJ
JIOO
IIII
```

### 输出

```
3
```

## 样例 #2

### 输入

```
4 4
JJOO
JJOO
IIJO
IIIJ
```

### 输出

```
17
```



---

---
title: "とてもたのしい家庭菜園 (Growing Vegetables is Fun 4)"
layout: "post"
diff: 普及/提高-
pid: AT_joi2021ho_a
tag: []
---

# とてもたのしい家庭菜園 (Growing Vegetables is Fun 4)

## 题目描述

[problemUrl]: https://atcoder.jp/contests/joi2021ho/tasks/joi2021ho_a

家庭菜園が趣味のビ太郎は自宅の庭でビバ草という植物を育てている．庭には $ N $ 株のビバ草が東西方向に一列に植えられており，西側から順に $ 1 $ から $ N $ までの番号が付いている．現在，ビバ草 $ i $ ($ 1\ \leqq\ i\ \leqq\ N $) の背丈は $ A_i $ である．

育てているビバ草は特別な品種改良の結果，水を与えるたびに背丈が $ 1 $ 伸びる．ビ太郎は庭の見栄えを良くするために水やりを複数回行い，以下の条件を満たすようにしたいと考えている．

- すべての水やりを行った後のビバ草 $ i $ ($ 1\ \leqq\ i\ \leqq\ N $) の背丈を $ B_i $ とする．このとき，「$ 1\ \leqq\ j\ \leqq\ k\ -\ 1 $ に対し $ B_j\ <\ B_{j\ +\ 1} $」かつ「$ k\ \leqq\ j\ \leqq\ N\ -\ 1 $ に対し $ B_j\ >\ B_{j\ +\ 1} $」を満たすような整数 $ k $ ($ 1\ \leqq\ k\ \leqq\ N $) が存在する．

ただし，ビ太郎は不器用なため，$ 1 $ 回の水やりにおいて，ある区間上のビバ草に一斉に水を与えることしかできない．すなわち，水やりを行うたびにある整数 $ L,\ R $ ($ 1\ \leqq\ L\ \leqq\ R\ \leqq\ N $) を選び，ビバ草 $ L,\ L\ +\ 1,\ \ldots,\ R $ に水を与える．

ビ太郎は水やりの回数をできるだけ少なくしたい．

ビバ草の数と現在の背丈の情報が与えられたとき，条件を満たすのに必要な水やりの回数の最小値を求めるプログラムを作成せよ．

- - - - - -

## 输入格式

入力は以下の形式で標準入力から与えられる．入力される値はすべて整数である．

> $ N $ $ A_1 $ $ \cdots $ $ A_N $

## 输出格式

必要な水やりの回数の最小値を，標準出力に $ 1 $ 行で出力せよ．

- - - - - -

## 说明/提示

### 制約

- $ 2\ \leqq\ N\ \leqq\ 200\,000 $．
- $ 1\ \leqq\ A_i\ \leqq\ 1\,000\,000\,000 $ ($ 1\ \leqq\ i\ \leqq\ N $)．

### 小課題

1. ($ 40 $ 点) $ N\ \leqq\ 2\,000 $．
2. ($ 60 $ 点) 追加の制約はない．

- - - - - -

### Sample Explanation 1

以下のように水やりを $ 3 $ 回行うことで条件を満たすことができる． - $ L=2 $，$ R=5 $ として，ビバ草 $ 2,\ 3,\ 4,\ 5 $ に水を与える．ビバ草の背丈は西から順に $ 3,\ 3,\ 3,\ 4,\ 2 $ となる． - $ L=2 $，$ R=3 $ として，ビバ草 $ 2,\ 3 $ に水を与える．ビバ草の背丈は西から順に $ 3,\ 4,\ 4,\ 4,\ 2 $ となる． - $ L=3 $，$ R=3 $ として，ビバ草 $ 3 $ に水を与える．ビバ草の背丈は西から順に $ 3,\ 4,\ 5,\ 4,\ 2 $ となる． $ 2 $ 回以下の水やりで条件を満たすことは不可能なので，必要な水やりの回数の最小値は $ 3 $ である． - - - - - -

### Sample Explanation 2

すでに条件を満たしているため，必要な水やりの回数の最小値は $ 0 $ である． - - - - - -

### Sample Explanation 3

1 回の水やりで条件を満たすためには，$ L\ =\ 1 $，$ R\ =\ 1 $ としてビバ草 $ 1 $ に水を与えるか，または，$ L\ =\ 2 $，$ R\ =\ 2 $ としてビバ草 $ 2 $ に水を与えればよい． - - - - - -

## 样例 #1

### 输入

```
5
3 2 2 3 1
```

### 输出

```
3
```

## 样例 #2

### 输入

```
5
9 7 5 3 1
```

### 输出

```
0
```

## 样例 #3

### 输入

```
2
2021 2021
```

### 输出

```
1
```

## 样例 #4

### 输入

```
8
12 2 34 85 4 91 29 85
```

### 输出

```
93
```



---

---
title: "自習 (Self Study)"
layout: "post"
diff: 普及/提高-
pid: AT_joi2022ho_b
tag: []
---

# 自習 (Self Study)

## 题目描述

在 JOI 高中高一的第三个学期的 $M$ 个星期的时间内，有 $N$ 门课，编号为 $1 \sim N$。每个星期有 $N$ 个课时，第 $i$ 个课时上课程 $i$ 的一节课。

比太郎是一位高一学生。对于 $N \times M$ 个课时中的每一个，他会选择如下行动中的一个：

- 行动 1：比太郎去上课。如果他去上了课程 $i$ 的一节课，那么他对课程 $i$ 的理解程度会增加 $A_i$。
- 行动 2：比太郎不去上课。他转而选择任意一门课，并且自学选中的那门课。如果他选中了课程 $i$ 进行了时长为一课时的自学，那么他对课程 $i$ 的理解程度会增加 $B_i$。

一开始，对每门课的理解程度都为 $0$。由于比太郎想要在课后练习算法竞赛，他在非上课时间内不会学习。当第三个学期的所有课时结束后，期末考就会举行。

比太郎不想挂科。所以他想要最大化在期末考时对每门课的理解程度的最小值。

给定学期的长度，课程的数量，以及对理解程度的提升数值，请写一个程序计算在期末考时对每门课的理解程度的最小值的最大可能值。

## 输入格式

第一行，两个正整数 $N, M$。

第二行，$N$ 个正整数 $A_1, A_2, \ldots, A_N$。

第三行，$N$ 个正整数 $B_1, B_2, \ldots, B_N$。

## 输出格式

输出一行，一个数，表示在期末考时对每门课的理解程度的最小值的最大可能值。

## 样例 #1

### 样例输入 #1

```
3 3
19 4 5
2 6 2
```

### 样例输出 #1

```
18
```

## 样例 #2

### 样例输入 #2

```
2 1
9 7
2 6
```

### 样例输出 #2

```
7
```

## 样例 #3

### 样例输入 #3

```
5 60000
630510219 369411957 874325200 990002527 567203997
438920902 634940661 593780254 315929832 420627496
```

### 样例输出 #3

```
41397427274960
```

## 样例 #4

### 样例输入 #4

```
4 25
1 2 3 4
1 2 3 4
```

### 样例输出 #4

```
48
```

## 说明/提示

**【样例解释 \#1】**

举个例子，如果比太郎按如下方式学习，则他对课程 $1, 2, 3$ 的理解程度将分别为 $19, 18, 19$。

- 第一周课程 $1$ 的课：自学课程 $2$；
- 第一周课程 $2$ 的课：自学课程 $2$；
- 第一周课程 $3$ 的课：去上课程 $3$ 的课；
- 第二周课程 $1$ 的课：去上课程 $1$ 的课；
- 第二周课程 $2$ 的课：自学课程 $3$；
- 第二周课程 $3$ 的课：去上课程 $3$ 的课；
- 第三周课程 $1$ 的课：自学课程 $3$；
- 第三周课程 $2$ 的课：自学课程 $2$；
- 第三周课程 $3$ 的课：去上课程 $3$ 的课。

由于对每门课的最小的理解程度不能大于等于 $19$，输出 $18$。

这个样例满足子任务 $3, 5$ 的限制。

**【样例解释 \#2】**

这个样例满足子任务 $1, 3, 5$ 的限制。

**【样例解释 \#3】**

这个样例满足子任务 $3, 5$ 的限制。

**【样例解释 \#4】**

这个样例满足子任务 $2, 3, 4, 5$ 的限制。

----


**本题采用捆绑测试。**

对于 $100 \%$ 的数据，$1 \le N \le 3 \times {10}^5$，$1 \le M \le {10}^9$，$1 \le A_i, B_i \le {10}^9$。

- 子任务 $1$（$10$ 分）：$M = 1$。
- 子任务 $2$（$25$ 分）：$N \cdot M \le 3 \times {10}^5$，$A_i = B_i$。
- 子任务 $3$（$27$ 分）：$N \cdot M \le 3 \times {10}^5$。
- 子任务 $4$（$29$ 分）：$A_i = B_i$。
- 子任务 $5$（$9$ 分）：无特殊限制。

----

**译自 [JOI 2022 Final](https://www.ioi-jp.org/joi/2021/2022-ho/index.html) T2「[自習](https://www.ioi-jp.org/joi/2021/2022-ho/2022-ho-t2.pdf) / [Self Study](https://www.ioi-jp.org/joi/2021/2022-ho/2022-ho-t2-en.pdf)」**

## 样例 #1

### 输入

```
3 3
19 4 5
2 6 2
```

### 输出

```
18
```

## 样例 #2

### 输入

```
2 1
9 7
2 6
```

### 输出

```
7
```

## 样例 #3

### 输入

```
5 60000
630510219 369411957 874325200 990002527 567203997
438920902 634940661 593780254 315929832 420627496
```

### 输出

```
41397427274960
```

## 样例 #4

### 输入

```
4 25
1 2 3 4
1 2 3 4
```

### 输出

```
48
```



---

---
title: "ラーメンの食べ比べ"
layout: "post"
diff: 普及/提高-
pid: AT_joisc2014_d
tag: []
---

# ラーメンの食べ比べ

## 题目描述

**这是一道交互题。**

#### 背景

JOI 君和 IOI 酱都喜欢吃拉面。JOI 君喜欢吃清汤拉面，而 IOI 酱喜欢吃浓汤拉面，在 JOI 君和 IOI 酱居住的城镇里，共有 $N$ 家拉面馆，编号为 $0$ 到 $N-1$。

我们不知道每家拉面馆卖的是清汤拉面还是浓汤拉面，因此，JOI 君和 IOI 酱决定去附近的一些拉面馆寻找最好吃的清汤和浓汤拉面。

JOI 君和 IOI 酱到附近的拉面馆，分别确定两家拉面馆拉面的浓厚度，浓厚度是一个大于等于 $0$ 小于等于 $N-1$ 的整数，每家面馆拉面的浓厚度两两不同。JOI 君和 IOI 酱每天每人去一家拉面馆，通过品尝味道，可以比较出两家拉面馆哪一家浓厚度更高。

出于健康因素考虑，JOI 君和 IOI 酱最多吃 $600$ 天拉面。

#### 任务

给定城镇里拉面馆数 $N$，请在最多吃 $600$ 天拉面的情况下确定浓厚度最高的拉面馆和浓厚度最低的拉面馆。

#### 实现细节

你需要用一个程序实现上述任务。该程序必须实现以下函数：

```cpp
void Ramen(int N)
```

- 对于每个测试用例，该函数**仅调用一次**。
- 参数 $N$ 表示城镇里的拉面馆数。

你可以且仅可以在该函数中调用以下两个函数：

```cpp
int Compare(int X, int Y)
```

- 该函数用来比较两家拉面馆 $X,Y$ 的浓厚程度。
- 参数 $X,Y$ 表示用来比较的两家拉面馆的编号，其**必须是大于等于 $0$ 小于等于 $N-1$ 的整数**。如果不满足该条件，会被判为 `Wrong Answer [1]`。
- 如果拉面馆 $X$ 的浓厚程度大于拉面馆 $Y$ 的浓厚程度，该函数的返回值为 $1$，否则为 $-1$。
- 如果该函数被调用超过 $600$ 次，会被判为 `Wrong Answer [2]`。

```cpp
int Answer(int X, int Y)
```

- 该函数用来回答哪家拉面馆的浓厚程度最低和哪家拉面馆的浓厚程度最高。其中 $X$ 表示浓厚程度**最低**的拉面馆的编号，$Y$ 表示浓厚程度**最高**的拉面馆的编号。$X,Y$ **必须是大于等于 $0$ 小于等于 $N-1$ 的整数**。如果不满足该条件，会被判为 `Wrong Answer [4]`。
- **`Ramen` 函数必须调用该函数来结束**，否则会被判为 `Wrong Answer [3]`。
- 可以保证，与调用 `Compare` 函数的结果一致的答案是唯一的。如果与答案不一致，则会被判为 `Wrong Answer [5]`，一致则会被判为 `Accepted`。
- 调用此函数后，程序结束。

**编译与运行方法**

本体提供了 ramen.h、grader.c 和 grader.cpp 三个文件。可前往 [LOJ](https://loj.ac/p/2875/files) 下载本题的附加文件。

若你编写的程序名称为 ramen.c 或 ramen.cpp，请运行以下命令来编译：

- 对于 C 语言：`gcc -O2 -lm -o grader grader.c ramen.c`
- 对于 C++ 语言：`g++ -O2 -o grader grader.cpp ramen.cpp`

当命令成功时，会产生一个可执行文件 grader。

注意实际评测时的程序与下发的样例评测程序并不相同。实际的 ramen.h 函数实现将通过标准输入/输出与单独运行的交互器进行交互。

## 输入格式

样例评测程序将从标准输入读入以下数据：

第一行两个整数 $N,T$，用一个空格隔开。$N$ 表示拉面馆数，评测程序只会处理 $T=1$ 的数据。  
接下来 $N$ 行，第 $i$ 行表示拉面馆 $i$ 的浓厚度 。

## 输出格式

样例评测程序将向标准输出输出以下信息。

- 判为正确时，输出 `Accepted`；
- 运行过程中被判为错误时，以 `Wrong Answer [x]` 的格式报告并退出。

**样例输入**

```
3 1
1
2
0
```

**样例交互示例**

| 调用函数 | 返回值 |
| :----------: | :----------: |
| `Compare(0, 1)` | -1 |
| `Compare(0, 2)` | 1 |
| `Answer(2, 1)` | / |

## 说明/提示

对于所有数据，$1\leqslant N\leqslant 400$。

翻译来源自 LOJ。



---

---
title: "Kleene Inversion"
layout: "post"
diff: 普及/提高-
pid: AT_jsc2019_qual_b
tag: []
---

# Kleene Inversion

## 题目描述

[problemUrl]: https://atcoder.jp/contests/jsc2019-qual/tasks/jsc2019_qual_b

長さ $ N $ の整数列 $ A~=~A_0,~A_1,~...,~A_{N\ -\ 1} $ があります。

$ A $ を $ K $ 回繰り返した長さ $ K\ \times\ N $ の整数列を $ B $ とします。たとえば $ A~=~1,~3,~2 $、$ K~=~2 $ のとき、 $ B~=~1,~3,~2,~1,~3,~2 $ です。

$ B $ の転倒数を $ 10^9\ +\ 7 $ で割った余りを求めてください。

ここで $ B $ の転倒数は、整数の順序対 $ (i,~j)~(0\ \leq\ i\ <\ j\ \leq\ K\ \times\ N\ -\ 1) $ であって $ B_i\ >\ B_j $ を満たすものの個数として定義されます。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ K $ $ A_0 $ $ A_1 $ $ ... $ $ A_{N\ -\ 1} $

## 输出格式

$ B $ の転倒数を $ 10^9\ +\ 7 $ で割った余りを出力せよ。

## 说明/提示

### 制約

- 入力は全て整数である。
- $ 1\ \leq\ N\ \leq\ 2000 $
- $ 1\ \leq\ K\ \leq\ 10^9 $
- $ 1\ \leq\ A_i\ \leq\ 2000 $

### Sample Explanation 1

このケースでは $ B~=~2,~1,~2,~1 $ です。 - $ B_0\ >\ B_1 $ - $ B_0\ >\ B_3 $ - $ B_2\ >\ B_3 $ であり、$ B $ の転倒数は $ 3 $ です。

### Sample Explanation 2

$ A $ は同じ数を複数含むこともあります。

### Sample Explanation 3

$ 10^9\ +\ 7 $ で割った余りを出力することに注意してください。

## 样例 #1

### 输入

```
2 2

2 1
```

### 输出

```
3
```

## 样例 #2

### 输入

```
3 5

1 1 1
```

### 输出

```
0
```

## 样例 #3

### 输入

```
10 998244353

10 9 8 7 5 6 3 4 2 1
```

### 输出

```
185297239
```



---

---
title: "Nowhere P"
layout: "post"
diff: 普及/提高-
pid: AT_jsc2021_d
tag: []
---

# Nowhere P

## 题目描述

给你一个大于或等于 $2$ 的整数 $P$。 

如果一个整数序列 $A_1, A_2, ..., A_N$ 满足以下条件，那么它被称为一个非常好的序列。

对于 $1$ 到 $N$ 之间的任何整数 $i$，$A_1+A_2+\dots+A_i$ 不是 $P$ 的倍数

总共有 $(P-1)^N$ 个长度为 $N$ 的整数序列，其中每个元素都在 $1$ 和 $P-1$ 之间，这些序列中有多少个是非常好的？

答案可能非常大，所以输出对 $10^9+7$ 取模后的答案。

## 输入格式

一行，输入 $N$，$P$。

## 输出格式

输出对 $10^9+7$ 取模后的答案

## 样例 #1

### 输入

```
3 3
```

### 输出

```
2
```

## 样例 #2

### 输入

```
3 2
```

### 输出

```
0
```

## 样例 #3

### 输入

```
45108 2571593
```

### 输出

```
224219544
```



---

---
title: "ブロックの移動(Blocks)"
layout: "post"
diff: 普及/提高-
pid: AT_k4pc_a
tag: []
---

# ブロックの移動(Blocks)

## 题目描述

给出长度为 $n$ 的序列 $a$，每次操作可以任选 $i, j$ 让 $a_i = a_i - 1, a_j = a_j + 1$，求使整个序列满足 $a_i = i$ 所需要的最少操作步数。题目满足一定有解。

## 输入格式

第一行为一个数 $n$。

接下来 $n$ 行为序列 $a$。

## 输出格式

输出一个数，为所需要的最少操作数。

## 说明/提示

$1 \le n \le 100$。

## 样例 #1

### 输入

```
3

3

2

1
```

### 输出

```
2
```

## 样例 #2

### 输入

```
4

3

1

5

1
```

### 输出

```
4
```

## 样例 #3

### 输入

```
5

7

8

0

0

0
```

### 输出

```
12
```



---

---
title: "Wikipedia"
layout: "post"
diff: 普及/提高-
pid: AT_kupc2012pr_1
tag: []
---

# Wikipedia

## 题目描述

PA君某天在维基百科上看到了阿克曼函数。根据维基百科上的解释，阿克曼函数按以下函数进行递归。
- $A(0,n)=n+1(n≥0)$
- $A(m,0)=A(m-1,1)(m≥1)$
- $A(m,n)=A(m-1,A(m,n-1))(m,n≥1)$

阿克曼函数以它随给定参数爆炸式增长而著名。PA君试着手算了一下阿克曼函数的值，但这实在是太毒瘤了因此他很快便放弃了。你的任务就是帮PA君计算阿克曼函数的值。

## 输入格式

输入遵从以下形式
```
m n
```
m和n各为阿克曼函数的第一个和第二个参数。

## 输出格式

输出一行A(m,n)的值。
## 样例
### 输入1
```
2 3
```
### 输出1
```
9
```
### 输入2
```
3 45
```
### 输出2
```
281474976710653
```

## 说明/提示

- $0≤m≤3$
- $0≤n≤60$
- 输入都为整数。

注：亲测答案在long long范围内。

感谢@ミク 提供的翻译



---

---
title: "GUARDIANS"
layout: "post"
diff: 普及/提高-
pid: AT_kupc2015_b
tag: []
---

# GUARDIANS

## 题目描述

[problemUrl]: https://atcoder.jp/contests/kupc2015/tasks/kupc2015_b

あなたは幾多の試練を乗り越えた凄腕の冒険者であり，冒険で数々の宝物を手にした．これらを隠しダンジョンの奥にある宝物庫に保管し，*番犬*と妖怪*鎖頭*に守ってもらうことにした．隠しダンジョンは以下のような $ 10\ \times\ 10 $ の空間であり，一番左の $ 10 $ マス全てがダンジョンの入り口とつながっていて，一番右の $ 10 $ マス全てが宝物庫へとつながっている．

 ```

..........
..........
..........
..........
..........
..........
..........
..........
..........
..........
```

 現在，隠しダンジョンには何も置かれていない．宝を狙う命知らずな侵入者は一番左のいずれかのマスから侵入し，一番右のいずれかのマスを目指す． 侵入者が隠しダンジョンに入ると同時に*番犬*が左から侵入者を追いかけるので，**侵入者は右上，右，右下のいずれかのマスにしか移動できない．** また，$ 10\ \times\ 10 $ の空間の外に出ることもできない． あなたは隠しダンジョンに*鎖頭*をたくさん配置して侵入者を阻むことにした．*鎖頭*は以下の特徴をもつ．

- *鎖頭*は移動することができない．
- *鎖頭*は縦横斜めの好きな方向に自分がいるマスから2マス先まで頭を投げつける一撃必殺の攻撃を放つ．

*鎖頭*がいる場所を `C` とすると，その *鎖頭* の攻撃可能な範囲は以下の `X` で表される．侵入者は以下の`C`, `X`が書かれた範囲に立ち入ると，再起不能となる． ```

.......
.X.X.X.
..XXX..
.XXCXX.
..XXX..
.X.X.X.
.......
```

隠しダンジョンを*鎖頭*で埋め尽くしてしまうと全ての侵入者を排除できるが，それでは面白くないと感じたあなたは，侵入者が*鎖頭*に攻撃されずにスタートからゴールへたどり着けるルートが**ただひとつだけ**存在するように*鎖頭*を配置し，見事突破した侵入者にはその知略を称えて宝物の一部を差し出すことにした．

*鎖頭*を雇うには大金がかかる．あなたは倹約家でもあり，雇う*鎖頭*の数はなるべく少ないほうが良い．多くても誤答とはならないが，満点が得られるとは限らない．詳しくは部分点の制約を確認してほしい．経路が一通りに定まる配置をひとつ出力せよ．

## 输入格式

この問題に入力は存在しない．

## 输出格式

$ 10\ \times\ 10 $ の隠しダンジョンの盤面を出力せよ．`C`はそこに*鎖頭*が配置されることを表し，`.`はそこには何もないことを表す．**追記: `C`は大文字であることに注意せよ．** 出力にこれら2種類の文字と改行以外が含まれている場合，出力は問題の条件を満たしていないものとみなされるので注意せよ．

## 说明/提示

### 部分点

 この問題には部分点が存在する．配点は以下の通りである．

- 盤面が問題文中の左端から右端への経路をただ一通りに定める場合，*Accepted* と判定され， $ N $ 体の*鎖頭* を配置した時，$ floor(400 $ $ ／ $ $ (max(4,\ N-1))) $ 点が与えられる．
- そうでない場合，*Wrong Answer* と判定され，点数は得られない．
- **システムの都合上，*Accepted* で $ X $ 点を獲得した場合，それまでに提出した *Accepted* な解法のうち，$ X $ 点 未満のものは全て誤答としてカウントされ，ペナルティが発生するので注意すること．**

### ヒント

- $ N\ =\ 5 $ の解でも満点が得られるが， $ N\ =\ 4 $ の解も存在する．

### Sample Explanation 1

左端から右端までの経路が一通りのみ存在し，配置した\*鎖頭\*は $ 50 $ 体である．この盤面を提出した場合，$ 8 $ 点が得られる．

### Sample Explanation 2

左端から右端までの経路が一通りのみ存在し，配置した\*鎖頭\*は $ 44 $ 体である．この盤面を提出した場合，$ 9 $ 点が得られる．

### Sample Explanation 3

この盤面では，左端から右端への道がただ一通りに定まらない．左から右へ直進するルートと，一度右下に移動した後に右上に移動するルートがある．提出した場合， \*Wrong Answer\* と判定され，点は得られない．

### Sample Explanation 4

この盤面では，左端から右端への道が存在しない．侵入者は`C`のマスにも立ち入れず，$ 10\ \times\ 10 $ の空間の外に出ることもできない点に注意せよ．提出した場合， \*Wrong Answer\* と判定され，点は得られない．

## 样例 #1

### 输入

```
None
```

### 输出

```
CCCCCCCCCC

CCCCCCCCCC

..........

..........

..........

..........

..........

CCCCCCCCCC

CCCCCCCCCC

CCCCCCCCCC
```

## 样例 #2

### 输入

```
None
```

### 输出

```
CCCCC.C...

CCCC.C....

CCC.C.....

CC.C.....C

C.C.....C.

.C.....C.C

C.....C.CC

.....C.CCC

....C.CCCC

...C.CCCCC
```

## 样例 #3

### 输入

```
None
```

### 输出

```
CCCCCCCCCC

CCCCCCCCCC

..........

..........

..........

..........

..........

CC.....CCC

CCCCCCCCCC

CCCCCCCCCC
```

## 样例 #4

### 输入

```
None
```

### 输出

```
CCCCCCCCCC

..........

..........

..........

.C........

..........

..........

.C........

..........

..........
```



---

---
title: "ナップサック問題"
layout: "post"
diff: 普及/提高-
pid: AT_kupc2019_b
tag: []
---

# ナップサック問題

## 题目描述

[problemUrl]: https://atcoder.jp/contests/kupc2019/tasks/kupc2019_b

$ n $ 個の品物があり、$ 1 $ から $ n $ までの番号が付けられています。

各品物には価値と重さが定められていて、$ i $ 番目の品物の価値は $ v_i $、重さは $ w_i $ です。

あなたはこれらの品物から重さの総和が $ W $ を超えないようにいくつか選び、選んだ品物の価値の総和を最大化したいです。

ただし、$ m $ 個の条件があります。

$ j $ 番目の条件は $ (a_j,\ b_j) $ で表され、それぞれ「 $ a_j $ 番目の品物を選ぶならば $ b_j $ 番目の品物を選ばなければならず、$ b_j $ 番目の品物を選ぶならば $ a_j $ 番目の品物を選ばなければならない」 という意味です。

これらの条件を全て満たした上で、$ n $ 個の品物から重さの総和が $ W $ を超えないようにいくつか品物を選んだときの価値の総和の最大値を求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ n $ $ m $ $ W $ $ w_1 $ $ v_1 $ $ w_2 $ $ v_2 $ $ \vdots $ $ w_n $ $ v_n $ $ a_1 $ $ b_1 $ $ a_2 $ $ b_2 $ $ \vdots $ $ a_m $ $ b_m $

## 输出格式

$ m $ 個の条件を全て満たした上で、$ n $ 個の品物から重さの総和が $ W $ を超えないようにいくつか品物を選んだときの価値の総和の最大値を出力せよ。

## 说明/提示

### 制約

- 入力中の値は全て整数である。
- $ 1\ \leq\ n\ \leq\ 100 $
- $ 0\ \leq\ m\ \leq\ \frac\ {n(n-1)}{2} $
- $ 1\ \leq\ W\ \leq\ 10^4 $
- $ 1\ \leq\ w_i\ \leq\ W $
- $ 1\ \leq\ v_i\ \leq\ 10^7 $
- $ 1\ \leq\ a_i,\ b_i\ \leq\ n $
- $ a_i\ \neq\ b_i $
- $ i\ \neq\ j $ ならば、$ (a_i,\ b_i)\ \neq\ (a_j,\ b_j) $ かつ $ (a_i,\ b_i)\ \neq\ (b_j,\ a_j) $

### Sample Explanation 1

$ 1 $ 番目の品物と $ 2 $ 番目の品物を選ぶことで価値の総和を $ 6 $ にすることができ、これが最適です。 条件から、$ 2 $ 番目の品物と $ 3 $ 番目の品物だけを選ぶことはできないことに注意してください。

### Sample Explanation 2

全ての品物を選ぶことができます。

### Sample Explanation 3

一つも品物を選ぶことができません。

## 样例 #1

### 输入

```
3 1 10

3 2

5 4

3 3

1 2
```

### 输出

```
6
```

## 样例 #2

### 输入

```
4 0 10

1 1

2 2

3 3

4 4
```

### 输出

```
10
```

## 样例 #3

### 输入

```
3 3 6

2 5

3 8

3 4

1 2

2 3

3 1
```

### 输出

```
0
```

## 样例 #4

### 输入

```
1 0 10000

10000 10000000
```

### 输出

```
10000000
```



---

---
title: "ロボットアーム"
layout: "post"
diff: 普及/提高-
pid: AT_mujin_pc_2016_b
tag: []
---

# ロボットアーム

## 题目描述

想象一只机器人手臂，将其看作是二维的一条线 $O-A-B-C$，其中 $O$ 这个点固定在原点 $(0,0)$。

如下图所示。

![](https://mujin-pc-2016.contest.atcoder.jp/img/other/mujin2016/arm_01.png)

现在，你可以改变 $\angle O,\ \angle A$ 和 $\angle B$ 的角度，但不可以改变任何线段的长度。

现在给定各条线段的长度，你需要计算 $C$ 能到达的范围总面积。

## 输入格式

$$l_{OA}\ l_{AB}\ l_{BC}$$

## 输出格式

输出 $C$ 可以到达的范围面积，误差不超过 $10^{-6}$ 都会视作正确答案。

**在最后输出换行。**

### 样例数据

**样例 1**

```
1 1 1
```

```
28.2743338823
```

解释：

![](https://mujin-pc-2016.contest.atcoder.jp/img/other/mujin2016/arm_02.png)

**样例 2**

```
3 1 1
```

```
75.3982236862
```

解释：

![](https://mujin-pc-2016.contest.atcoder.jp/img/other/mujin2016/arm_03.png)

**样例 3**

```
16 2 27
```

```
6107.2561185786
```

## 说明/提示

$1\le l_{OA},\ l_{AB},\ l_{BC}\le 100$

### 翻译贡献

@[hellolin](https://www.luogu.com.cn/user/751017) 译。



---

---
title: "右折"
layout: "post"
diff: 普及/提高-
pid: AT_mujin_pc_2018_c
tag: []
---

# 右折

## 题目描述

[problemUrl]: https://atcoder.jp/contests/mujin-pc-2018/tasks/mujin_pc_2018_c

$ N $ 行 $ M $ 列のマス目があります。上から $ i $ 行目、左から $ j $ 列目にあるマスを $ (i,j) $ で表します。 特に、左上のマスは $ (1,1) $ であり、右下のマスは $ (N,M) $ です。 マス目の状態は 二次元配列 $ s $ で表され、$ s_{ij} $ が `#` のときマス $ (i,j) $ には障害物があり、`.` のとき障害物がないことを表します。

高橋君は、このマス目のいずれかのマスに、上下左右いずれかの方向を向けたロボットを置きました。 ロボットは向いている方向に $ 1 $ マス以上まっすぐ進んだ後、向きを右に $ 90 $ 度変え、再びまっすぐに $ 1 $ マス以上進んで停止しました。 この過程でロボットが通ったマス(置かれたマスおよび停止したマスを含む)のいずれにも障害物はなく、またロボットがマス目の外に出ることはありませんでした。

ロボットが置かれたマスと停止したマスの順序対としてありうるものの個数を求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ M $ $ s_{11}...s_{1M} $ $ : $ $ s_{N1}...s_{NM} $

## 输出格式

ロボットが置かれたマスと停止したマスの順序対としてありうるものの個数を出力せよ。

## 说明/提示

### 制約

- $ 2\ \leq\ N,M\ \leq\ 2\times\ 10^3 $
- $ s_{ij} $ は `#` または `.` である

### Sample Explanation 1

$ ((1,1),(2,2)),((1,1),(3,2)),((1,2),(2,1)),((2,1),(1,2)),((2,1),(3,2)),((2,2),(1,1)),((2,3),(1,2)),((2,3),(1,1)),((3,2),(2,3)) $ の $ 9 $ 個が条件を満たします。

## 样例 #1

### 输入

```
3 3

..#

...

#.#
```

### 输出

```
9
```

## 样例 #2

### 输入

```
2 5

.#.#.

..#..
```

### 输出

```
2
```

## 样例 #3

### 输入

```
6 8

#......#

##....##

#.#..#.#

#..##..#

#......#

#......#
```

### 输出

```
182
```



---

---
title: "Maximum Sum of Minimum"
layout: "post"
diff: 普及/提高-
pid: AT_m_solutions2019_d
tag: []
---

# Maximum Sum of Minimum

## 题目描述

[problemUrl]: https://atcoder.jp/contests/m-solutions2019/tasks/m_solutions2019_d

$ N $ 個の頂点 $ 1,2,\ldots,N $ からなる木 $ T $ と正の整数 $ c_1,c_2,\ldots,c_N $ が与えられます。 $ i(1\ \leq\ i\ \leq\ N-1) $ 番目の辺は頂点 $ a_i $ と頂点 $ b_i $ をつなぐ辺です。

$ T $ の各頂点に正の整数を書き込んだとき、以下のようにしてスコアを計算します。

- 各辺に、$ 2 $ つの端点に書き込まれた整数のうち小さい方を書き込む。
- 各辺に書き込まれた整数の総和をスコアとする。

$ T $ の各頂点に $ c_1,c_2,\ldots,c_N $ を $ 1 $ つずつ書き込んだときのスコアの最大値を求め、 それを達成する正の整数の書き込み方を $ 1 $ つ構成してください。

$ c_1,c_2,\ldots,c_N $ に複数回現れる整数があるときは、 その整数はその回数だけ使わなければならないことに注意してください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ a_1 $ $ b_1 $ $ : $ $ a_{N-1} $ $ b_{N-1} $ $ c_1 $ $ \ldots $ $ c_N $

## 输出格式

次の形式で出力せよ。

> $ M $ $ d_1 $ $ \ldots $ $ d_N $

$ M $ はスコアの最大値を表す。 $ d_i $ は頂点 $ i $ に書き込むべき整数を表す。 $ d_1,d_2,\ldots,d_N $ は $ c_1,c_2,\ldots,c_N $ の並べ替えでなければならない。

最大のスコアを達成する方法が複数個あるときは、 そのうちのどれを出力してもよい。

## 说明/提示

### 制約

- $ 1\ \leq\ N\ \leq\ 10000 $
- $ 1\ \leq\ a_i,b_i\ \leq\ N $
- $ 1\ \leq\ c_i\ \leq\ 10^5 $
- 与えられるグラフは木である

### Sample Explanation 1

頂点 $ 1,2,3,4,5 $ にそれぞれ $ 1,2,3,4,5 $ を書き込むと、 $ 4 $ つの辺にはそれぞれ $ 1,2,3,4 $ が書き込まれるので、スコアは $ 10 $ になります。 これが最大のスコアです。

### Sample Explanation 2

$ c_1,c_2,\ldots,c_N $ は互いに異なるとは限りません。

## 样例 #1

### 输入

```
5

1 2

2 3

3 4

4 5

1 2 3 4 5
```

### 输出

```
10

1 2 3 4 5
```

## 样例 #2

### 输入

```
5

1 2

1 3

1 4

1 5

3141 59 26 53 59
```

### 输出

```
197

59 26 3141 59 53
```



---

---
title: "Counting of Trees"
layout: "post"
diff: 普及/提高-
pid: AT_nikkei2019_2_qual_b
tag: []
---

# Counting of Trees

## 题目描述

[problemUrl]: https://atcoder.jp/contests/nikkei2019-2-qual/tasks/nikkei2019_2_qual_b

$ N $ 要素からなる整数列 $ D_1,...,D_N $ が与えられます。頂点に $ 1 $ から $ N $ の番号が付けられた $ N $ 頂点からなる木であって、 以下の条件をみたすものの個数を $ 998244353 $ で割ったあまりを求めてください。

- $ 1 $ 以上 $ N $ 以下の任意の整数 $ i $ に対して、頂点 $ 1 $ と頂点 $ i $ の距離が $ D_i $ である。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ D_1 $ $ D_2 $ $ ... $ $ D_N $

## 输出格式

答えを出力せよ。

## 说明/提示

### 注記

- $ N $ 頂点の木とは $ N $ 頂点 $ N-1 $ 辺からなる連結無向グラフのことであり、$ 2 $ 頂点の距離とは一方から他方への最短路に用いられる辺の個数を指します。
- $ 2 $ つの木が異なるとは、ある $ 2 $ 頂点 $ x $, $ y $ が存在して、$ x $ と $ y $ の間に一方の木では辺が存在し、 もう一方の木では辺が存在しないことを指します。

### 制約

- $ 1\ ≦\ N\ ≦\ 10^5 $
- $ 0\ ≦\ D_i\ ≦\ N-1 $

### Sample Explanation 1

例えば、$ (1,2) $, $ (1,3) $, $ (2,4) $ の間に辺があるような木が条件をみたします。

## 样例 #1

### 输入

```
4

0 1 1 2
```

### 输出

```
2
```

## 样例 #2

### 输入

```
4

1 1 1 1
```

### 输出

```
0
```

## 样例 #3

### 输入

```
7

0 3 2 1 2 2 1
```

### 输出

```
24
```



---

---
title: "Different Strokes"
layout: "post"
diff: 普及/提高-
pid: AT_nikkei2019_qual_c
tag: []
---

# Different Strokes

## 题目描述

[problemUrl]: https://atcoder.jp/contests/nikkei2019-qual/tasks/nikkei2019_qual_c

高橋くんと青木さんの前に $ N $ 皿の料理が置かれています。 便宜上、これらの料理を料理 $ 1 $、料理 $ 2 $、…、料理 $ N $ と呼びます。

高橋くんが料理 $ i $ を食べると彼は $ A_i $ ポイントの *幸福度* を得ます。 また、青木さんが料理 $ i $ を食べると彼女は $ B_i $ ポイントの幸福度を得ます。

彼らは、高橋くんから始めて交互に、料理を $ 1 $ 皿ずつ選んで食べることを料理が尽きるまで続けます。 ただし、彼らはともに、「最終的に自分が得る幸福度の総和」から「最終的に相手が得る幸福度の総和」を引いた値を最大化するように料理を選びます。

このとき、「最終的に高橋くんが得る幸福度の総和」から「最終的に青木さんが得る幸福度の総和」を引いた値はいくつになるでしょうか？

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ A_1 $ $ B_1 $ $ : $ $ A_N $ $ B_N $

## 输出格式

「最終的に高橋くんが得る幸福度の総和」から「最終的に青木さんが得る幸福度の総和」を引いた値を出力せよ。

## 说明/提示

### 制約

- $ 1\ \leq\ N\ \leq\ 10^5 $
- $ 1\ \leq\ A_i\ \leq\ 10^9 $
- $ 1\ \leq\ B_i\ \leq\ 10^9 $
- 入力される値はすべて整数である。

### Sample Explanation 1

この例では、二人のどちらも、料理 $ 1 $ を食べると $ 10 $ ポイント、料理 $ 2 $ を食べると $ 20 $ ポイント、料理 $ 3 $ を食べると $ 30 $ ポイントの幸福度を得ます。 この場合、高橋くんと青木さんの「好み」が一致しているため、彼らは毎回残っている料理のうち最も幸福度を多く得られる料理を選びます。よって、最初に高橋くんは料理 $ 3 $ を選び、次に青木さんは料理 $ 2 $ を選び、最後に高橋くんが料理 $ 1 $ を選ぶため、答えは $ (30\ +\ 10)\ -\ 20\ =\ 20 $ です。

### Sample Explanation 2

この例では、高橋くんは料理 $ 1,2,3 $ のいずれを食べても $ 20 $ ポイントの幸福度を得ますが、青木さんは料理 $ 1 $ を食べると $ 10 $ ポイント、料理 $ 2 $ を食べると $ 20 $ ポイント、料理 $ 3 $ を食べると $ 30 $ ポイントの幸福度を得ます。 今回は、青木さんのみに料理の好き嫌いがあるため、彼らは毎回残っている料理のうち青木さんが最も幸福度を多く得られる料理を選びます。よって、最初に高橋くんは料理 $ 3 $ を選び、次に青木さんは料理 $ 2 $ を選び、最後に高橋くんが料理 $ 1 $ を選ぶため、答えは $ (20\ +\ 20)\ -\ 20\ =\ 20 $ です。

### Sample Explanation 3

答えは $ 32 $ ビット整数に収まらない可能性があります。

## 样例 #1

### 输入

```
3

10 10

20 20

30 30
```

### 输出

```
20
```

## 样例 #2

### 输入

```
3

20 10

20 20

20 30
```

### 输出

```
20
```

## 样例 #3

### 输入

```
6

1 1000000000

1 1000000000

1 1000000000

1 1000000000

1 1000000000

1 1000000000
```

### 输出

```
-2999999997
```



---

---
title: "Folia"
layout: "post"
diff: 普及/提高-
pid: AT_nomura2020_c
tag: []
---

# Folia

## 题目描述

[问题网址](https://atcoder.jp/contests/nomura2020/tasks/nomura2020_c)

给定一个长度为 $N+1$ 的非负整数序列 $A_0,A_1,A_2,\cdots,A_N$。问是否存在一棵深度为 $N$ 的二叉树，对于每一个 $d=0,1,2,\cdots,N$，使得在深度 $d$ 处正好有 $A_d$ 个叶子结点。如果存在，则输出此类二叉树的最大顶点数量，如果不存在，则输出 $-1$。

## 输入格式

> $N$   
> $A_0$ $A_1$ $A_2$ $\cdots$ $A_N$

## 输出格式

$1$ 行 $1$ 个整数，代表答案。

## 说明/提示

### 注释

- 二叉树是一棵有根树，每个结点最多有两个子结点。
- 二叉树中的叶子是没有子结点的结点。
- 二叉树中结点 $v$ 的深度是从根结点到 $v$ 的距离（根结点的深度为 $0$）。
- 二叉树的深度是树中结点的最大深度。


- $0\le N\le 10^5$
- $0\leq A_i\le 10^8$（$0\le i\le N$）
- $A_N\ge 1$
- 所有输入均为非负整数。


对于样例 $1$，以下是一种可能的答案：  
![0d8d99d13df036f23b0c9fcec52b842b.png](https://img.atcoder.jp/nomura2020/0d8d99d13df036f23b0c9fcec52b842b.png)   
翻译@[ans_mod998244353](https://www.luogu.com.cn/user/582360)。

## 样例 #1

### 输入

```
3

0 1 1 2
```

### 输出

```
7
```

## 样例 #2

### 输入

```
4

0 0 1 0 2
```

### 输出

```
10
```

## 样例 #3

### 输入

```
2

0 3 1
```

### 输出

```
-1
```

## 样例 #4

### 输入

```
1

1 1
```

### 输出

```
-1
```

## 样例 #5

### 输入

```
10

0 0 1 1 2 3 5 8 13 21 34
```

### 输出

```
264
```



---

---
title: "文字列の書き換え"
layout: "post"
diff: 普及/提高-
pid: AT_nyc2015_3
tag: []
---

# 文字列の書き換え

## 题目描述

作为新年礼物，溜君收到了字串s。通过重复下面的操作，判断能否跳过s，成为你喜欢的文字列t。



操作：从s中选择一个字符，然后插入一个与紧接着选择的字符不同的字符。

1 ≤ ∣s∣ ≤ ∣t∣ < = 5000

## 输入格式

第一行输入s

第二行输入t

## 输出格式

请输出“是”或“否”。



---

---
title: "パ研軍旗"
layout: "post"
diff: 普及/提高-
pid: AT_pakencamp_2019_day3_d
tag: []
---

# パ研軍旗

## 题目描述

[problemUrl]: https://atcoder.jp/contests/pakencamp-2019-day3/tasks/pakencamp_2019_day3_d

筑駒パ研は，近い将来，パ研戦争に臨むことになりました．そのために，軍旗を作ることになりました．

旗のデザインは縦に $ 5 $ 個，横に $ N $ 個に分かれた $ 5\ \times\ N $ のマス目で表されます．上から $ i $ 行目，左から $ j $ 列目のマスを，$ (i,\ j) $ で表すことにします．

現在，旗のそれぞれのマスは赤・青・白・黒のいずれかで塗られています．より具体的には，マス $ (i,\ j) $ は色 $ S_{i,\ j} $ で塗られています．ただし，$ S_{i,\ j} $ は `R`, `B`, `W`, `#` のいずれかで，それぞれ赤・青・白・黒で塗られていることを表しています．

E869120 君は，パ研軍旗を、次の条件を満たすように青・白・赤で塗り替えたいです．

- $ N $ 個の列すべてにおいて，その列の $ 5 $ マスが「全部青」「全部白」「全部赤」のいずれかである
- どの隣り合った $ 2 $ つの列も，色が異なる

ただし，黒いマスがあったら条件を満たさないことに注意してください．

以下が，条件を満たす旗と条件を満たさない旗の例です．

![ ](https://cdn.luogu.com.cn/upload/vjudge_pic/AT_pakencamp_2019_day3_d/6f1da94e1beb878e9f99f1bce0627c77a75d904e.png)

- 例 $ 1 $ は条件を満たします．
- 例 $ 2 $ は，例えば左から $ 2 $ 番目の列で青と白のマスがあり，$ 5 $ つ全部同じになっている必要があるという条件を満たしません．
- 例 $ 3 $ は，例えば左から $ 3 $ 番目の列と左から $ 4 $ 番目の列の色が同じなので，条件を満たしません．
- 例 $ 4 $ は，例えば左から $ 5 $ 番目の色が黒になっているので，条件を満たしません．

E869120 君は，旗の作成時間を短くするため，できるだけ塗り替えるマスの個数を少なくしたいです．  
 最小でいくつのマスを塗り替える必要があるか求めるプログラムを書いてください．

## 输入格式

入力は以下の形式で標準入力から与えられます．  
 ただし、旗のそれぞれの行の色の情報 $ S_{i,\ 1},\ S_{i,\ 2},\ S_{i,\ 3},\ \dots,\ S_{i,\ N} $ は，これがつながった $ N $ 文字の文字列として入力されることに注意してください．

> $ N $ $ S_{1,\ 1}\ S_{1,\ 2}\ S_{1,\ 3}\ \cdots\ S_{1,\ N} $ $ S_{2,\ 1}\ S_{2,\ 2}\ S_{2,\ 3}\ \cdots\ S_{2,\ N} $ $ S_{3,\ 1}\ S_{3,\ 2}\ S_{3,\ 3}\ \cdots\ S_{3,\ N} $ $ S_{4,\ 1}\ S_{4,\ 2}\ S_{4,\ 3}\ \cdots\ S_{4,\ N} $ $ S_{5,\ 1}\ S_{5,\ 2}\ S_{5,\ 3}\ \cdots\ S_{5,\ N} $

## 输出格式

パ研軍旗を作るときに塗り替える必要のあるマスの個数の最小値を，$ 1 $ 行で出力してください．

## 说明/提示

### 制約

すべての入力データは，以下の制約を満たす．

- $ N $ は $ 1\ \leq\ N\ \leq\ 999 $ をみたす整数
- $ S_{i,\ j} $ は `R`, `B`, `W`, `#` のいずれか

### 部分点

この問題はいくつかの小課題に分けられ，その小課題のすべてのテストケースに正解した場合に「この小課題に正解した」とみなされます．  
 提出したソースコードの得点は，正解した小課題の点数の合計となります．

1. (11 点) $ N\ =\ 1 $ である．
2. (13 点) $ N\ =\ 3 $ である．
3. (29 点) $ N\ \leq\ 10 $ である．
4. (22 点) $ 5 $ つの行すべてにおいて，その行の $ N $ 個のマスがすべて同じ色である．
5. (25 点) 追加の制約はない．

**ただし，小課題 $ 4 $ について，「$ N $ 個の列すべてにおいて，その列の $ 5 $ 個のマスがすべて同じ色である」のような読み間違えをしないように注意してください．**

### Sample Explanation 1

以下の $ 3 $ 通りのパ研軍旗を作ることができます． - すべてのマスを赤にする．そのとき，マス $ (1,\ 1),\ (3,\ 1),\ (4,\ 1),\ (5,\ 1) $ の $ 4 $ マスを塗り替える必要がある． - すべてのマスを青にする．そのとき，マス $ (2,\ 1),\ (3,\ 1),\ (4,\ 1) $ の $ 3 $ マスを塗り替える必要がある． - すべてのマスを白にする．そのとき，マス $ (1,\ 1),\ (2,\ 1),\ (3,\ 1),\ (5,\ 1) $ の $ 4 $ マスを塗り替える必要がある． その中では，「すべてのマスを青」にするのが最適です．そのとき，塗り替えるマスの個数は $ 3 $ 個になります． ちなみに，これは $ N\ =\ 1 $ なので，小課題 $ 1 $ の制約をみたします．

### Sample Explanation 2

$ 1 $ 列目を青、$ 2 $ 列目を白、$ 3 $ 列目を赤にすると，塗り替えるマスの個数を $ 10 $ 個にできて，これが最適です． !\[ \](https://img.atcoder.jp/pakencamp-2019-day3/7607c1554c09d7d875918ccf09d65f78.png) (ここでは，「★」は塗り替えられたマスを表します) ちなみに，これは $ N\ =\ 3 $ なので，小課題 $ 2 $ の制約をみたします．

### Sample Explanation 3

次の図のように塗り替えるのが最適です．塗り替えるマスの数は $ 28 $ 個となります．(ここでは，「★」は塗り替えられたマスを表します) !\[ \](https://img.atcoder.jp/pakencamp-2019-day3/a660d84b5614953bf2b4e7ee8342fabd.png)

### Sample Explanation 4

次の図のように塗り替えるのが最適です．塗り替えるマスの数は $ 21 $ 個となります．(ここでは，「★」は塗り替えられたマスを表します) !\[ \](https://img.atcoder.jp/pakencamp-2019-day3/cb86f987229c1ab46e30411860964c19.png)

## 样例 #1

### 输入

```
1

B

R

#

W

B
```

### 输出

```
3
```

## 样例 #2

### 输入

```
3

WWR

#RW

BW#

##B

RBR
```

### 输出

```
10
```

## 样例 #3

### 输入

```
8

RRRRRRRR

########

BBBBBBBB

RRRRRRRR

WWWWWWWW
```

### 输出

```
28
```

## 样例 #4

### 输入

```
7

BR#WB#R

RWW#WRB

##WBR#W

WB#B#RW

BRW##BB
```

### 输出

```
21
```



---

---
title: "整地"
layout: "post"
diff: 普及/提高-
pid: AT_past201912_n
tag: []
---

# 整地

## 题目描述

坐标轴上有 $n$ 个区间，每个区间均在左端点为 $0$，右端点为 $w$ 的线段内。第 $i$ 个区间的左右端点表示的数字分别为 $l_i$ 和 $r_i$。

现在你要去掉一部分区间，使得有一段长度为 $c$ 的线段没有被任何区间覆盖。第 $i$ 个区间删去的代价为 $p_i$。请输出你所花费的最小代价。

## 输入格式

第一行为三个整数 $n,w,c$。

接下来 $n$ 行，每行三个整数 $l_i,r_i,p_i$。

## 输出格式

一行一个整数，最小代价。（若不需要删去任何一个区间，输出`0`即可。）

### 数据规模与约定

$1 \le n \le 100000$，$10 \le w \le 10^9$，$1 \le c \le w$，$0 \le l_i \lt r_i \le w$，$1 \le p_i \le 10^9$。

## 样例 #1

### 输入

```
3 10 5

1 3 100

8 10 123

4 6 3
```

### 输出

```
3
```

## 样例 #2

### 输入

```
22 30 10

0 30 1000000000

0 30 1000000000

0 30 1000000000

7 30 261806

6 19 1

5 18 1238738

12 28 84

10 14 5093

9 20 9

15 26 8739840

6 8 240568

14 19 198

2 4 1102

1 29 5953283

9 20 183233

9 13 44580

6 23 787237159

12 14 49

28 29 9020727

14 20 318783

2 19 9862194

9 30 166652
```

### 输出

```
3805189325
```



---

---
title: "行列操作"
layout: "post"
diff: 普及/提高-
pid: AT_past202005_i
tag: []
---

# 行列操作

## 题目描述

有一个满足以下条件的一个 $n \times n$ 的矩阵 $a$。若将该数列上起第 $i$ 行，左起第 $j$ 列上的数记为 $a_{i,j}$，则：

- 当 $1 \le i,j \le n$ 时，$a_{i,j}=n \times (i-1)+j-1$。

## 输入格式

- `1 x y`：对于所有满足 $1 \le i \le n$ 的 $i$，交换 $a_{x,i}$ 与 $a_{y,i}$ 的值。
- `2 x y`：对于所有满足 $1 \le i \le n$ 的 $i$，交换 $a_{i,x}$ 与 $a_{i,y}$ 的值。
- `3`：转置矩阵 $a$，即对于所有满足 $1 \le i,j \le n$ 的 $i$ 和 $j$，将原来 $a_{i,j}$ 的值改为 $a_{j,i}$ 的值。
- `4 x y`：输出当前矩阵中 $a_{x,y}$ 的值并换行。

请注意，在进行 $1$ 操作和 $2$ 操作时，如果 $x=y$，则矩阵在操作后无变化。

## 输出格式

对于形如`4 x y`形式的操作，输出 $a_{x,y}$ 的值并换行。请注意， $32$ 位整数类型可能不适合。

## 说明/提示

**数据规模与约定**

对于全部测试点，数据保证：

- $1 \le n,q \le 10^5$；
- $1 \le x,y \le n$；
- 保证至少存在一个形如`4 x y`格式的查询；
- 输入中的所有数值均为整数。

## 样例 #1

### 输入

```
2

19

4 1 1

4 1 2

4 2 1

4 2 2

3

4 1 1

4 1 2

4 2 1

4 2 2

1 1 2

4 1 1

4 1 2

4 2 1

4 2 2

2 2 1

4 1 1

4 1 2

4 2 1

4 2 2
```

### 输出

```
0

1

2

3

0

2

1

3

1

3

0

2

3

1

2

0
```

## 样例 #2

### 输入

```
3

9

2 2 3

3

1 2 1

2 3 2

1 1 3

3

4 1 1

4 2 2

4 2 3
```

### 输出

```
1

6

8
```



---

---
title: "べき表現"
layout: "post"
diff: 普及/提高-
pid: AT_past202107_g
tag: []
---

# べき表現

## 题目描述

给定一个整数 $n(1\le n\le 10^{15})$，请输出一个长为 $m(1\le m\le 100)$ 的整数数列 $a$，满足：

- $\sum a_i=n$；
- $|a_i|\le 10^{18}$，且当 $i\neq j$ 时，$|a_i|\neq|a_j|$；
- 对于每一个满足 $1\le i\le m$ 的整数 $i$，$|a_i|=3^x$，其中 $x$ 为自然数。

数据保证，在本题数据范围下，数列 $a$ 一定存在。若有多解，输出任一解即可。

## 输入格式

一行一个整数 $n$。

## 输出格式

两行，第一行输出整数 $m$，第二行输出 $m$ 个整数，表示数列 $a$。

## 样例 #1

### 输入

```
6
```

### 输出

```
2

9 -3
```

## 样例 #2

### 输入

```
9193
```

### 输出

```
9

2187 27 1 -243 3 9 -81 6561 729
```

## 样例 #3

### 输入

```
10120190919012
```

### 输出

```
16

-1594323 9 -177147 -531441 1162261467 -4782969 387420489 -6561 -2187 2541865828329 -27 7625597484987 3486784401 10460353203 -94143178827 31381059609
```



---

---
title: "数列の反転"
layout: "post"
diff: 普及/提高-
pid: AT_past202109_j
tag: []
---

# 数列の反転

## 题目描述

维护一个长度为 $2n$ 的序列 $a$。开始时，对于每个满足 $1 \le a \le 2n$ 的整数 $i$，都有 $a_i=i$。

给出 $q$ 次操作，每次操作都为以下两种形式中的一种：

- `1 k`：输出 $a_k$ 的值并换行。保证 $1 \le k \le 2n$。
- `2 k`：反转 $[n-k+1,n+k]$ 这个区间。反转后，原来的第 $p$ 个元素被换到了第 $2n-p+1$ 个元素的位置。保证 $1 \le k \le n$。

请按顺序执行操作。

## 输入格式

第一行输入两个整数 $n,q$。

接下来 $q$ 行，每行两个整数 $t_i$ 和 $k_i$。$t_i$ 为操作类型，$k_i$ 为操作参数。

## 输出格式

对于每个操作 $1$，输出此时 $a_k$ 的值并换行。

## 说明/提示

#### 数据规模与约定

$1 \le n,q \le 2 \times10^5$，$1 \le t_i \le 2$。

## 样例 #1

### 输入

```
3 2

2 2

1 4
```

### 输出

```
3
```

## 样例 #2

### 输入

```
3 3

2 3

1 3

1 1
```

### 输出

```
4

6
```

## 样例 #3

### 输入

```
5 6

2 2

2 1

2 1

2 3

1 2

2 3
```

### 输出

```
2
```



---

---
title: "回転と反転"
layout: "post"
diff: 普及/提高-
pid: AT_past202112_j
tag: []
---

# 回転と反転

## 题目描述

有一个 $n$ 行 $n$ 列的网格图，开始时全部被涂为白色。

给出 $q$ 次操作，每次操作的格式及内容如下：

- `1 x y`：若上起第 $x$ 行左起第 $y$ 列的网格为白色，将其涂黑；若为黑色，将其涂白。
- `2 c`：若 $c$ 为`Ａ`，将整张图顺时针旋转 $90°$；否则，将整张图逆时针旋转 $90°$。
- `3 c`：若 $c$ 为`Ａ`，垂直翻转整张图；否则，水平翻转整张图。

请在全部操作完成后输出每一个格子的颜色。

## 输入格式

第一行：两个整数 $n,q$。

## 输出格式

输出一个 $n\times n$ 的字符图，其中第 $i$ 行第 $j$ 列的字符表示了第 $i$ 行第 $j$ 个格子的颜色。用`0`表示白色，`1`表示黑色。

## 说明/提示

#### 样例 #1 说明

将 $(1,1)$ 涂黑，然后顺时针旋转 $90°$。

#### 数据规模与约定

$100\%$ 的数据保证：

- $1 \le n\le 300$；
- $1 \le q\le 2 \times 10^5$；
- $1 \le x,y \le n$；
- $c$ 为 `A` 或 `B`。

## 样例 #1

### 输入

```
3 2

1 1 1

2 A
```

### 输出

```
001

000

000
```

## 样例 #2

### 输入

```
3 3

1 1 1

3 A

3 B
```

### 输出

```
000

000

001
```

## 样例 #3

### 输入

```
4 8

2 A

1 4 2

2 A

1 2 2

3 B

3 B

3 A

1 3 1
```

### 输出

```
0000

0000

0100

0000
```



---

---
title: "Capture"
layout: "post"
diff: 普及/提高-
pid: AT_relay2_f
tag: []
---

# Capture

## 题目描述

# 题目大意

在东西方向延伸的细长的森林里栖息着 $N$ 只动物。从森林的最左端到 $p$ 米的地点称为地点 $p$ 。若第i头动物到森林最左端的距离为 $x$（1≤i≤N）那么它就在地点 $x_i$ ，若捕获的话你可以以 $s_i$ 日元卖出。

选择两个整数 $L$ 和 $R$（L≤R），那么，从 $L$ 到 $R$ 范围内的动物就会全部被捕获。但是，买网要花费 $R$-$L$日元，所以你的利益=(被捕获的所有的除物i的合计)-($R$-$L$)日元。

若你只放一次网，得到的最大利益是多少呢？

## 输入格式

$x_1$ $s_1$

$x_2$ $s_2$

$:$

$x_N$ $s_N$

## 输出格式

输出最大利益X

## 说明/提示

1 ≤ $N$ ≤ 2 × $10_5$

1 ≤ x1 < x2 < ... < $x_N$ ≤ $10_15$

1 ≤ $s_i$ ≤ $10_9$

所有输入数据皆为整数.

## 样例 #1

### 输入

```
5

10 20

40 50

60 30

70 40

90 10
```

### 输出

```
90
```

## 样例 #2

### 输入

```
5

10 2

40 5

60 3

70 4

90 1
```

### 输出

```
5
```

## 样例 #3

### 输入

```
4

1 100

3 200

999999999999999 150

1000000000000000 150
```

### 输出

```
299
```



---

---
title: "何通りの分割方法がある？"
layout: "post"
diff: 普及/提高-
pid: AT_s8pc_2_c
tag: []
---

# 何通りの分割方法がある？

## 题目描述

[problemUrl]: https://atcoder.jp/contests/s8pc-2/tasks/s8pc_2_c

$ square1001 $の部分文字列である「$ 1001 $」は、各位の数字の和が$ 1+0+0+1=2 $と非常に少なく、

しかも「1001」を分割しても{$ 1,0,01 $}や{$ 1,001 $}のようにすると和がそれぞれ$ 1+0+1=2,1+1=2 $と非常に少なくなります。

$ 1001 $はとても不思議な数です。それについて、彼は考えてみることにしました。

整数$ n $を分割するとき、その和が$ D $以下にならなければなりません。

ここでいう「分割」の定義は以下のようになります。

- 整数$ N $を文字列と考えられる。これを$ S $と置く。
- $ S $をいくつかのパーツに分ける。
- 例えば「$ "1234567" $」だと{$ "1","234567" $}や{$ "12","34","56","7" $}や{$ "1234567" $}など、というように分けることができる。
- 分けたパーツをそれぞれ数字としてとらえるようにする。
- 例えば、"1234"は$ 1234 $という数字ととらえることができる。
- ただし、各パーツは$ 0 $から始まってもよい。

例えば、「1355」を和が50以下になるように分割する方法は、以下の$ 3 $通りがあります。

 分割方法合計1+3+5+51413+5+5231+35+541何通りの分け方があるか数え上げましょう。$ 1,000,000,007 $で割った余りを求めなさい。

- 問題文中の例と同じである。

- 以下の5通りの条件を満たす分け方がある。

分割方法合計2+4+3+91824+3+9362+4+39452+43+95424+3963

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ D $

- $ 1 $ 行目には、分割されるもののもととなる整数 $ N $ が与えられる。
- $ 2 $ 行目には、数の合計の上限 $ D $が与えられる。

## 输出格式

出力は以下の形式で標準出力に従うこと。

- 分割の通り数を$ 1,000,000,007 $で割った余りを $ 1 $ 行で出力せよ。

## 说明/提示

### 制約

- $ 1≦N≦{10}^{100} $
- $ 1≦D≦100,000 $

### 小課題

小課題 $ 1 $ \[ $ 10 $ 点 \]

- 解は全て$ 1 $通り以下である。

小課題 $ 2 $ \[ $ 30 $ 点 \]

- $ 1≦N≦10,000,000,000 $を満たす。

小課題 $ 3 $ \[ $ 60 $ 点 \]

- 追加の制約はない。

## 样例 #1

### 输入

```
1355

50
```

### 输出

```
3
```

## 样例 #2

### 输入

```
2439

100
```

### 输出

```
5
```

## 样例 #3

### 输入

```
1225

20
```

### 输出

```
2
```

## 样例 #4

### 输入

```
123456

10000
```

### 输出

```
29
```



---

---
title: "Emblem"
layout: "post"
diff: 普及/提高-
pid: AT_s8pc_5_b
tag: []
---

# Emblem

## 题目描述

在一个坐标平面上有 $N$ 个给定的圆心和半径的圆，和 $M$ 个给定圆心但不给定半径的圆，请问如何设置这 $M$ 个圆的半径，使得这些圆中没有两两相交或内含的两个圆。求出所有方法中，半径最小的圆的半径的最大值。

## 输入格式

第 $1$ 行，两个整数 $N,M$ 用空格隔开。

第 $2\sim N+1$ 行，每行三个整数 $x_i,y_i,r_i$ 表示给定圆的圆心坐标和半径。（$i=1,2,\cdots,N$）

第 $N+2\sim N+M+1$ 行，每行两个整数 $x_i,y_i$ 表示没给定半径的圆的圆心坐标。（$i=N+1,N+2,\cdots,N+M$）

## 输出格式

一个浮点数表示答案，误差不超过 $10^{-6}$ 可以判为正确。

### 样例解释

**对于样例 #1：**

将这两个圆的半径设置为 $\dfrac{\sqrt{17}}{2}$ 满足题意，使得最小的圆的半径最大。

![](https://img.atcoder.jp/s8pc-5/9428c9380834bcaccb9efc3fd8004a8c.png)

**对于样例 #2：**

![](https://img.atcoder.jp/s8pc-5/ffba20c8caa71e91f1a68bc0436797b7.png)

**对于样例 #3：**

没有没给定半径的圆，则半径最小的圆一定是给定圆中半径最小的，最小值一定为 $2$。

**对于样例 #4：**

可以设置半径为 $3\sqrt{5}-5$。

![](https://img.atcoder.jp/s8pc-5/4b66f305d185ab848356d4d62e951182.png)

## 说明/提示

- $N,M\in[0,100]$。
- $N+M\ge 2$。
- $x_i,y_i\in[-100,100]$。（$1\le i\le N+M$）
- $r_i\in[1,100]$。（$1\le i\le N$）
- $\forall i,j\in[1,N+M]$ 且 $i\neq j$ 满足 $(x_i,y_i)\neq(x_j,y_j)$。
- $\forall i,j\in[1,N]$ 且 $i\neq j$ 满足第 $i$ 个圆与第 $j$ 个圆不相交或内含。
- $\forall i\in[1,N],j\in[N+1,M]$ 满足 $(x_j,y_j)$ 不在第 $i$ 个圆上。

## 样例 #1

### 输入

```
0 2

6 3

2 4
```

### 输出

```
2.061552812808830
```

## 样例 #2

### 输入

```
0 5

8 6

9 1

2 0

1 0

0 1
```

### 输出

```
0.500000000000000
```

## 样例 #3

### 输入

```
3 0

5 2 3

-1 0 2

2 -6 4
```

### 输出

```
2.000000000000000
```

## 样例 #4

### 输入

```
1 1

0 0 5

6 -3
```

### 输出

```
1.708203932499369
```



---

---
title: "Lucky PIN"
layout: "post"
diff: 普及/提高-
pid: AT_sumitb2019_d
tag: []
---

# Lucky PIN

## 题目描述

[problemUrl]: https://atcoder.jp/contests/sumitrust2019/tasks/sumitb2019_d

AtCoder 社は、オフィスの入り口に $ 3 $ 桁の暗証番号を設定することにしました。

AtCoder 社には $ N $ 桁のラッキーナンバー $ S $ があります。社長の高橋君は、$ S $ から $ N-3 $ 桁を消して残りの $ 3 $ 桁を左から読んだものを暗証番号として設定することにしました。

このとき、設定されうる暗証番号は何種類あるでしょうか？

ただし、ラッキーナンバーや暗証番号はいずれも $ 0 $ から始まっても良いものとします。

## 输入格式

入力は以下の形式で標準入力から与えられます。

> $ N $ $ S $

## 输出格式

設定されうる暗証番号の種類数を出力してください。

## 说明/提示

### 制約

- $ 4\ \leq\ N\ \leq\ 30000 $
- $ S $ は半角数字からなる長さ $ N $ の文字列

### Sample Explanation 1

高橋君には以下の選択肢があります。 - $ S $ の $ 1 $ 桁目を消し、暗証番号を `224` とする。 - $ S $ の $ 2 $ 桁目を消し、暗証番号を `024` とする。 - $ S $ の $ 3 $ 桁目を消し、暗証番号を `024` とする。 - $ S $ の $ 4 $ 桁目を消し、暗証番号を `022` とする。 よって、設定されうる暗証番号は `022`, `024`, `224` の $ 3 $ 種類です。

## 样例 #1

### 输入

```
4

0224
```

### 输出

```
3
```

## 样例 #2

### 输入

```
6

123123
```

### 输出

```
17
```

## 样例 #3

### 输入

```
19

3141592653589793238
```

### 输出

```
329
```



---

---
title: "Colorful Hats 2"
layout: "post"
diff: 普及/提高-
pid: AT_sumitb2019_e
tag: []
---

# Colorful Hats 2

## 题目描述

[problemUrl]: https://atcoder.jp/contests/sumitrust2019/tasks/sumitb2019_e

$ N $ 人の人が一列に並んでおり、前から順に $ 1,\ 2,\ 3,\ ...,\ N $ と番号が付けられています。それぞれの人は、赤色・青色・緑色のいずれかの帽子を被っています。

さて、番号 $ i $ の人は以下の発言をしました。

- 「自分より前に、自分と同じ色の帽子を被っている人はちょうど $ A_i $ 人いる。」

すべての人の発言が正しいとして、$ N $ 人の人の帽子の色の組合せとして考えられるものが何通りあるか求めてください。

ただし、答えがとても大きくなる場合があるので、代わりに $ 1000000007 $ で割った余りを計算してください。

## 输入格式

入力は以下の形式で標準入力から与えられます。

> $ N $ $ A_1 $ $ A_2 $ $ A_3 $ $ ... $ $ A_N $

## 输出格式

$ N $ 人の帽子の色の組合せとして考えられるものの個数を $ 1000000007 $ で割った余りを出力してください。

## 说明/提示

### 制約

- $ 1\ \leq\ N\ \leq\ 100000 $
- $ 0\ \leq\ A_i\ \leq\ N-1 $
- 入力中の値はすべて整数

### Sample Explanation 1

以下の $ 3 $ 通りの組合せが考えられます。 - 赤, 赤, 赤, 赤, 赤, 赤 - 青, 青, 青, 青, 青, 青 - 緑, 緑, 緑, 緑, 緑, 緑

## 样例 #1

### 输入

```
6

0 1 2 3 4 5
```

### 输出

```
3
```

## 样例 #2

### 输入

```
3

0 0 0
```

### 输出

```
6
```

## 样例 #3

### 输入

```
54

0 0 1 0 1 2 1 2 3 2 3 3 4 4 5 4 6 5 7 8 5 6 6 7 7 8 8 9 9 10 10 11 9 12 10 13 14 11 11 12 12 13 13 14 14 15 15 15 16 16 16 17 17 17
```

### 输出

```
115295190
```



---

---
title: "ロイヤルストレートフラッシュ"
layout: "post"
diff: 普及/提高-
pid: AT_tenka1_2012_10
tag: []
---

# ロイヤルストレートフラッシュ

## 题目描述

### 题目大意



有一副牌，花色是 $S,H,D,C$ 共4种，点数是 $A,2,3,4,5,6,7,8,9,10,J,Q,K$ 共13种。



任务是凑成一副同花顺 $10,J,Q,K,A$，注意必须同花且必须是 $10,J,Q,K,A$ 这5张牌。

## 输入格式

一行字符串，表示牌堆中的牌。

## 输出格式

一行字符串，表示你在摸到的最后一张凑成同花顺的牌之前舍弃的牌。如果前5张就可以凑成同花顺，请输出一个‘0’（不含引号）。



注意换行。



---

---
title: "camel_case"
layout: "post"
diff: 普及/提高-
pid: AT_tenka1_2012_6
tag: []
---

# camel_case

## 题目描述

在编程中，我们常用到两种字符串格式：「驼峰命名法」和「下划线分隔」。它们的定义如下：

- **单词**：一个以小写字母开头的字符串，由小写字母和数字构成。
- **驼峰命名法字符串**：由一个或多个单词连接而成，除了第一个单词外，其他单词首字母需大写。
- **下划线分隔字符串**：由一个或多个单词通过下划线连接形成。

这些字符串可能会在头尾被加上多余的下划线。

给定一个字符串，若它符合驼峰命名法或下划线分隔格式，要求将其互相转换，否则直接输出原字符串。同时，若某个字符串既符合驼峰命名法又符合下划线分隔，保证无论哪种解释方式，转换结果都是一致的。

输入格式如下：
> $ c_1c_2…c_N $

- 输入为一行字符串。
- 字符串长度 $ N $ 满足 $ 1 \leq N \leq 50 $。
- 字符 $ c_i $ 可以是大写字母（`A` 到 `Z`）、小写字母（`a` 到 `z`）、数字（`0` 到 `9`）或下划线（`_`）。

请将输入的字符串进行转换，结果以一行形式输出，并保证以换行符结尾。

## 输入格式

输入包含一行字符串。

## 输出格式

输出转换后的字符串结果，并在行末附加换行符。

## 说明/提示

字符串长度 $ N $ 满足 $ 1 \leq N \leq 50 $。

 **本翻译由 AI 自动生成**

## 样例 #1

### 输入

```
lower_camel_case
```

### 输出

```
lowerCamelCase
```

## 样例 #2

### 输入

```
_snakeCase_
```

### 输出

```
_snake_case_
```

## 样例 #3

### 输入

```
KLab
```

### 输出

```
KLab
```

## 样例 #4

### 输入

```
_
```

### 输出

```
_
```

## 样例 #5

### 输入

```
a_bc_9a_b
```

### 输出

```
a_bc_9a_b
```



---

---
title: "ぶんたん"
layout: "post"
diff: 普及/提高-
pid: AT_tenka1_2012_final_a
tag: []
---

# ぶんたん

## 题目描述

[problemUrl]: https://atcoder.jp/contests/tenka1-2012-final/tasks/tenka1_2012_final_a

 フィボナッチ数列は、以下のような漸化式で表される数列 $ F_0,\ F_1,\ F_2,\ …\ (=0,\ 1,\ 1,\ 2,\ 3,\ 5,\ 8,\ 13,\ …) $ であり、フィボナッチ数はこの数列に現れる数 $ F_i\ (i\ \geq\ 0) $ です。

- $ F_{0}\ =\ 0 $
- $ F_{1}\ =\ 1 $
- $ F_{i+2}\ =\ F_{i}\ +\ F_{i+1} $ ($ i\ \geq\ 0 $)

 ある正整数 $ n $ をいくつかのフィボナッチ数の和として表すことを考えます。  
 このとき、和が正整数 $ n $ となるフィボナッチ数の個数として考えられる最小の値を答えなさい。  
 ただし、同じフィボナッチ数を複数回用いることもできるものとし、複数回用いた場合はそれぞれ別々に数えるものとします。

 入力は以下の形式で標準入力から与えられる。 > $ n $

- 正整数 $ n $ ($ 1\ \leq\ n\ \leq\ 10^{10} $) が $ 1 $ 行で与えられる。
 
 与えられる数が小さい入力 ($ 1\ \leq\ N\ \leq\ 10^5 $) のみ正解すると、$ 100 $ 点満点に対して部分点として $ 50 $ 点が与えられる。 和が正整数 $ n $ となるフィボナッチ数の個数として考えられる最小の値を $ 1 $ 行で出力せよ。  
 なお、行の終端には改行が必要である。



---

---
title: "エターナルスタティックファイナル"
layout: "post"
diff: 普及/提高-
pid: AT_tenka1_2014_qualB_b
tag: []
---

# エターナルスタティックファイナル

## 题目描述

## 题意
小A通过组合他所学的短语来吟唱咒语。

同一个短语可以在诵读咒语的过程中使用多次。

例如，如果你记住了 $aaa$、$bbb$ 和 $ccc$ 三个短语，你就可以念出 $aaaccc$、$aaabbb$ 和 $cccaaaaaa$ 这样的咒语。

小A不确定他是否能够通过组合他所记住的短语来吟唱他所要学习的新咒语。

为小A创建一个程序，计算有多少种短语的排列组合可以构建他所要学习的新咒语。

变化的数量可能很大，所以输出对 $10^9+7$ 取模后的结果。

## 输入格式

在第一行中，给出小A已经记住的短语的数量 $N$（$1 \le N \le 100$）。

在第二行，给出小A想记住的咒语 $S$。

$S$ 的长度，$|S|$，满足 $1 \le |S| \le 1000$ 且 $S$ 由小写字母组成。

第 $3$ 至第 $N$ 行给出了智明已经记住的短语 $T_i$。

$T_i$ 的长度，$|T_i|$，满足 $1 \le |T_i| \le 1000$ 且 $T_i$ 由小写字母组成。

PS：如果 $i \neq j$，则 $Ti \neq Tj$。

## 输出格式

用这 $n$ 个短语构成的 $S$ 的方案数，对 $10^9+7$ 取模

## 样例 #1

### 输入

```
3

eternalstaticfinal

eternal

static

final
```

### 输出

```
1
```

## 样例 #2

### 输入

```
5

eternalstaticfinal

eternal

static

final

fin

al
```

### 输出

```
2
```

## 样例 #3

### 输入

```
5

abcdef

abc

def

abcdef

d

ef
```

### 输出

```
3
```

## 样例 #4

### 输入

```
5

aaaa

a

aa

aaa

aaaa

b
```

### 输出

```
8
```

## 样例 #5

### 输入

```
10

aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa

a

aa

aaa

aaaa

aaaaa

aaaaaa

aaaaaaa

aaaaaaaa

aaaaaaaaa

aaaaaaaaaa
```

### 输出

```
146491918
```



---

---
title: "天下一リテラル"
layout: "post"
diff: 普及/提高-
pid: AT_tenka1_2015_qualB_b
tag: []
---

# 天下一リテラル

## 题目描述

一种脚本语言 hnw 有 $3$ 种类型，分别是整数（integer）、字典（dict）和非空集合（set）。其组成如下：
```
dict={expr:expr{,expr:expr}}或{}；
set={expr{,expr}}；
expr=dict或set或integer。
（内层大括号内的元素为可继续添加的元素的类型）
```
现在输入一段脚本，请判断它是字典型脚本还是非空集合型脚本？

## 输入格式

一行一个字符串 $s$，即输入的脚本，其必为字典型或非空集合型。输入不含空格。

## 输出格式

输出一行一个字符串，表示输入的脚本的类型。如果是字典型请输出`dict`，是非空集合型请输出`set`。**输出完毕请换行。**

## 说明/提示

**数据规模与约定**

所有输入数据保证：

- $s$ 的长度不大于 $50000$；

## 样例 #1

### 输入

```
{1:2}
```

### 输出

```
dict
```

## 样例 #2

### 输入

```
{1,2}
```

### 输出

```
set
```

## 样例 #3

### 输入

```
{}
```

### 输出

```
dict
```



---

---
title: "PackDrop"
layout: "post"
diff: 普及/提高-
pid: AT_tenka1_2016_qualA_b
tag: []
---

# PackDrop

## 题目描述

# PackDrop


[问题链接](https://atcoder.jp/contests/tenka1-2016-quala/tasks/tenka1_2016_qualA_b)

山本同学发明了一种名为 PackDrop 的设备，它有 $0.01$ 的概率丢弃数据包，用于在通信环境不佳的网络中验证应用程序的运行。

山本同学需要在由 $N$ 台设备组成的网络中安装一些 PackDrop，以满足以下条件。并且，他希望使用的 PackDrop 的数量最少。

这个网络中的每个设备都有一个从 $0$ 到 $N-1$ 的编号。

除设备 $0$ 外，每个设备都有一个父设备，设备 $i$ 的父设备是设备 $P_i$。设备 $P_i$ 被称为设备 $i$ 的子设备。

直接具有父子关系的设备可以直接连接，或者通过串联几个 PackDrop 来连接。

当父设备和子设备之间有 $n$ 个 PackDrop 时，从父设备到子设备的数据包到达率为 $0.99^n$。换句话说，直接连接时，数据包到达率为 $1$。

设设备 $x$ 到设备 $y$ 的数据包到达率为 $p$，设备 $y$ 到设备 $z$ 的数据包到达率为 $q$，则设备 $x$ 到设备 $z$ 的数据包到达率为 $p × q$。

除了 PackDrop 丢弃数据包外，没有其他因素会影响数据包的到达率。

没有子设备的设备共有 $M$ 台，它们的编号为 $B_0, B_1, \ldots, B_{M-1}$。对于每个 $i$ ($0 \leq i \leq N-1$)，当希望设备 $0$ 到设备 $B_i$ 的到达率为 $0.99^{C_i}$ 时，求出最少需要的 PackDrop 数量。

## 输入格式

输入的格式如下所示：

> $N\ M\ P_1 : P_{N-1}\ B_0\ C_0 : B_{M-1}\ C_{M-1}$

## 输出格式

输出最少的 PackDrop 数量。

## 说明/提示

### 约束条件

- $2 \leq N \leq 1000$
- $1 \leq M \leq N - 1$
- $0 \leq P_i \leq i - 1$
- $1 \leq B_i \leq N - 1$
- $1 \leq C_i \leq 100000$
- 如果 $i \neq j$，则 $B_i \neq B_j$。
- 存在 $i, j$ 使得 $P_i = B_j$。
- 整数 $k$ ($1 \leq k \leq N - 1$) 如果不在 $P_1, P_2, \ldots, P_{N-1}$ 中，则它一定在 $B_0, B_1, \ldots, B_{M-1}$ 中。
- $N, M, P_i, B_i, C_i$ 均为整数。

## 样例 #1

### 输入

```
3 2
0
0
1 5
2 10
```

### 输出

```
15
```

## 样例 #2

### 输入

```
5 3
0
1
0
1
2 5
3 3
4 7
```

### 输出

```
10
```

## 样例 #3

### 输入

```
7 4
0
0
2
2
3
3
1 3
4 2
5 8
6 6
```

### 输出

```
11
```



---

---
title: "山田山本問題"
layout: "post"
diff: 普及/提高-
pid: AT_tenka1_2016_qualA_c
tag: []
---

# 山田山本問題

## 题目描述

[problemUrl]: https://atcoder.jp/contests/tenka1-2016-quala/tasks/tenka1_2016_qualA_c

天下一株式会社に勤務するワタナベくんは、社内のコミュニケーションにチャットツールを使っています。 チャットツールには補完機能があり、@で始まるアカウント名を入力しようとすると、プレフィックスの一致するアカウント名の一覧を辞書順で補完候補として表示してくれます。

ところが、ワタナベくんは補完候補の中から @yamamoto を選ぼうとした時に、間違って @yamada を選択してしまうことが多々あります。 @yamada は @yamamoto より辞書順で小さく、 `@yama` まで入力した際に、候補の先頭に表示されてしまうためです。

ワタナベくんは不思議な特技を持っていて、アルファベットの順番を自由に並べ替えることができます。 例えば、ワタナベくんが特技を使ってアルファベットの順番を abcefghijklmdnopqrstuvwxyz にすると、 `m` は `d` より小さくなり、 @yamamoto を @yamada より辞書順で小さくすることができます。

アカウント名 $ A_i $ をアカウント名 $ B_i $ より辞書順で小さくしたいという要求が $ N $ 個与えられます。 与えられた要求をすべて満たすような、ワタナベくんの特技によって並べ替えられたアルファベットの順番を求めてください。 条件を満たすようなアルファベットの順番が複数存在する場合は、並べ替えられる前のアルファベットの順番での辞書順最小の順番を求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ A_1 $ $ B_1 $ $ A_2 $ $ B_2 $ : $ A_N $ $ B_N $

## 输出格式

条件を満たすようなアルファベットの順番のうち、辞書順最小のものを1行に出力せよ。  
そのようなアルファベットの順番が存在しない場合は、-1を出力せよ。

## 说明/提示

### 制約

- $ 1\ \leq\ N\ \leq\ 1000 $
- $ A_i\ \neq\ B_i $
- $ 1\ \leq\ |A_i|,\ |B_i|\ \leq\ 1000 $
- $ A_i,B_i $は英小文字で構成される

## 样例 #1

### 输入

```
1
yamamoto yamada
```

### 输出

```
abcefghijklmdnopqrstuvwxyz
```

## 样例 #2

### 输入

```
3
xx xy
z w
v w
```

### 输出

```
abcdefghijklmnopqrstuvxyzw
```

## 样例 #3

### 输入

```
2
a b
b a
```

### 输出

```
-1
```

## 样例 #4

### 输入

```
1
yamamoto yama
```

### 输出

```
-1
```



---

---
title: "天下一魔力発電"
layout: "post"
diff: 普及/提高-
pid: AT_tenka1_2016_qualB_b
tag: []
---

# 天下一魔力発電

## 题目描述

## 题目翻译：天下一魔力发电

天下一魔力发电厂能够通过神奇的魔法生成电力。

用于魔力发电的燃料是一串由字符 `(` 和 `)` 组成的字符串 $S$，并且字符串的长度是偶数。

当我们将字符串 $S$ 转换成“匹配的括号字符串”时，魔力发电就会成功。

所谓的“匹配的括号字符串”满足以下条件：

- `()` 是一个匹配的括号字符串。
- 如果 $T$ 是一个匹配的括号字符串，那么 `(T)` 也是一个匹配的括号字符串。
- 如果 $T$ 和 $U$ 都是匹配的括号字符串，那么 $TU$ 也是匹配的括号字符串。

天下一魔力发电厂的文本处理器提供了四种操作方式：

1. 将光标向右移动（如果光标已经指向最后一个字符，则无法继续右移）。
2. 将光标向左移动（如果光标已经指向第一个字符，则无法继续左移）。
3. 如果光标指向的字符是 `(`，可以将其改为 `)`。
4. 如果光标指向的字符是 `)`，可以将其改为 `(`。

例如，给定字符串 $S$ 为：

```
())(()))
```

通过适当的第 1 和第 4 种操作，可以将其转换为：

```
(()(()))
```

这时，字符串变成了一个匹配的括号字符串。

作为发电厂的负责人，Fude-kun 想要通过最少的操作次数将字符串 $S$ 转换为匹配的括号字符串。

请你计算出将字符串 $S$ 转换为匹配的括号字符串所需的最少操作次数。

## 输入格式

输入包含一个字符串 $S$。

## 输出格式

输出将字符串 $S$ 转换为匹配的括号字符串所需的最少操作次数，最后需要换行符。

## 样例 #1

### 输入 #1

```
())(()))
```

### 输出 #1

```
2
```

## 样例 #2

### 输入 #2

```
((((
```

### 输出 #2

```
5
```

## 样例 #3

### 输入 #3

```
)))(((
```

### 输出 #3

```
9
```

## 说明/提示

- 字符串 $S$ 的长度 $|S|$ 是偶数。
- $2 \leq |S| \leq 100$

## 样例 #1

### 输入

```
())(()))
```

### 输出

```
2
```

## 样例 #2

### 输入

```
((((
```

### 输出

```
5
```

## 样例 #3

### 输入

```
)))(((
```

### 输出

```
9
```



---

---
title: "4/N"
layout: "post"
diff: 普及/提高-
pid: AT_tenka1_2017_c
tag: []
---

# 4/N

## 题目描述

[problemUrl]: https://atcoder.jp/contests/tenka1-2017/tasks/tenka1_2017_c

整数 $ N $ が与えられる。

$ 4/N\ =\ 1/h\ +\ 1/n\ +\ 1/w $ を満たす正整数 $ h,\ n,\ w $ を求めよ。

条件を満たす解が複数ある場合、どれを出力しても良い。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $

## 输出格式

条件を満たす正整数 $ h,\ n,\ w $ の組を空白区切りで１つ出力せよ。

 ```
h n w
```

## 说明/提示

### 制約

- $ N $ に対して $ h,\ n,\ w\ \leq\ 3500 $ となる解が存在することが保証される。

### Sample Explanation 1

$ 4/2\ =\ 1/1\ +\ 1/2\ +\ 1/2 $である。

## 样例 #1

### 输入

```
2
```

### 输出

```
1 2 2
```

## 样例 #2

### 输入

```
3485
```

### 输出

```
872 1012974 1539173474040
```

## 样例 #3

### 输入

```
4664
```

### 输出

```
3498 3498 3498
```



---

---
title: "Align"
layout: "post"
diff: 普及/提高-
pid: AT_tenka1_2018_c
tag: []
---

# Align

## 题目描述

[problemUrl]: https://atcoder.jp/contests/tenka1-2018/tasks/tenka1_2018_c

整数が $ N $ 個与えられます。$ i $ 個目の整数は $ A_i $ です。 これらを好きな順に一列に並べるとき、隣り合う要素の差の合計の最大値を求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ A_1 $ $ : $ $ A_N $

## 输出格式

与えられた整数たちを好きな順に一列に並べるとき、隣り合う要素の差の合計の最大値を出力せよ。

## 说明/提示

### 制約

- $ 2\ \leq\ N\ \leq\ 10^5 $
- $ 1\ \leq\ A_i\ \leq\ 10^9 $
- 入力はすべて整数である

### Sample Explanation 1

$ 3,8,1,6,2 $ の順に並べたとき、隣り合う要素の差の合計は $ 21 $ になり、 これが達成できる最大の値です。

## 样例 #1

### 输入

```
5

6

8

1

2

3
```

### 输出

```
21
```

## 样例 #2

### 输入

```
6

3

1

4

1

5

9
```

### 输出

```
25
```

## 样例 #3

### 输入

```
3

5

5

1
```

### 输出

```
8
```



---

---
title: "Stones"
layout: "post"
diff: 普及/提高-
pid: AT_tenka1_2019_c
tag: []
---

# Stones

## 题目描述

[problemUrl]: https://atcoder.jp/contests/tenka1-2019/tasks/tenka1_2019_c

$ N $ 個の石が一列に並んでおり、すべての石は白か黒で塗られています。 石の状態は長さ $ N $ の文字列 $ S $ で表され、$ S $ の $ i $ 文字目が `.` のとき左から $ i $ 個目の石が白であり、`#` のとき左から $ i $ 個目の石が黒であることを表します。

高橋君は、$ 0 $ 個以上の石の色を黒または白に変更し、黒い石のすぐ右に白い石があるような箇所がないようにしたいです。 色を変更する必要のある石の個数の最小値を求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ S $

## 输出格式

色を変更する必要のある石の個数の最小値を出力せよ。

## 说明/提示

### 制約

- $ 1\ \leq\ N\ \leq\ 2\times\ 10^5 $
- $ S $ は `.`, `#` のみからなる長さ $ N $ の文字列である

### Sample Explanation 1

例えば、$ 1 $ 個目の石の色を白に変更すればよいです。

## 样例 #1

### 输入

```
3

#.#
```

### 输出

```
1
```

## 样例 #2

### 输入

```
5

#.##.
```

### 输出

```
2
```

## 样例 #3

### 输入

```
9

.........
```

### 输出

```
0
```



---

---
title: "超大型連休"
layout: "post"
diff: 普及/提高-
pid: AT_test001_d
tag: []
---

# 超大型連休

## 题目描述

[problemUrl]: https://atcoder.jp/contests/language-test-ver1/tasks/test001_d

$ 2011 $ 年、$ AtCoder $ 国の高橋首相はある重大な決定を行った。  
 その決定とは...法改正である。国民の祝日に関する法律を変更し、休日を増やすことにした!!  
 国民の創造性を尊重するその決定が、霞が関を魔境へと変えたッ！  
  
 あなたは霞が関の国土交通省に勤務する職員であり、この法改正により上司から新たな任務を与えられた。  
 その任務とは、$ 2012 $ 年の「連休の最大日数」を計算することである。  
 連休の大きさを事前に計算することで国民の行動を予想し、高速道路の部分的な値下げを行い、経済を活性させるためだ。  
 したがって、あなたに失敗することは許されない。国民の行動を正確に予想できなくなるからだ。  
  
 以下に、「連休」の定義と諸注意を記す。

1. $ AtCoder $ 国が使用する暦は[グレゴリオ暦](http://ja.wikipedia.org/wiki/%E3%82%B0%E3%83%AC%E3%82%B4%E3%83%AA%E3%82%AA%E6%9A%A6)に従う。
2. 「連休」とは、「休日」が連続して続くことである。
3. 「土曜日」「日曜日」「祝日」「振替休日」が「休日」に相当する。
4. 「祝日」が他の休日と同じ日に指定されていた場合、「振替休日」を必ず設置する。
5. 「振替休日」は祝日の時系列順に決定していき、その祝日以降最も近い平日（休日を除いた日）となる。
6. $ 2012 $ 年 $ 1 $ 月 $ 1 $ 日は日曜日である。
 
 入力は以下の形式で標準入力から与えられる。 > $ N $ $ m_{1} $/$ d_{1} $ $ m_{2} $/$ d_{2} $ $ : $ $ : $ $ m_{n} $/$ d_{n} $

- $ 1 $ 行目には祝日の日数を表す整数 $ N $ が与えられ、 $ 0≦N≦366 $ を満たす。
- $ 2 $ 行目から $ N+1 $ 行目までの $ N $ 行で祝日の日付が与えられる。

1. $ m_{i} $ は $ i(1≦i≦366) $ 番目に与えられる祝日の月で、 $ 1≦m_{i}≦12 $ を満たす。
2. $ d_{i} $ は $ i(1≦i≦366) $ 番目に与えられる祝日の日で、
1. $ m_{i}\ =\ 2 $ のとき、 $ 1≦d_{i}≦29 $ を満たす。
2. $ m_{i}\ =\ (4,\ 6,\ 9,\ 11) $ のとき、 $ 1≦d_{i}≦30 $ を満たす。
3. $ m_{i}\ =\ (1,\ 3,\ 5,\ 7,\ 8,\ 10,\ 12) $ のとき、 $ 1≦d_{i}≦31 $ を満たす。

4. $ m_{i} $ と $ d_{i} $ はともに整数である。
5. $ m_{i} $ と $ d_{i} $ は必ず`/`で区切られて与えられる。
6. 祝日は時系列順に与えられるとは限らないことに注意せよ。ただし、同じ日付が複数与えられないことは保証されている。
 
 法改正後における $ 2012 $ 年の連休の最大日数を出力せよ。  
 出力は標準出力におこない、末尾には改行をいれること。  
```

1
1/9
```

 ```

3
```

- 1/7(土),1/8(日),1/9(月)の $ 3 $ 連休が最長です。
 
```

1
1/10
```

 ```

2
```

- 1/10(火)が祝日となり、1/7(土),1/8(日)などの $ 2 $ 連休が最長です。
 
```

1
1/7
```

 ```

3
```

- 1/7は土曜日なので、以降で最も近い平日である1/9が振替休日になります。
- よって、1/7(土)、1/8(日)、1/9(月)の3連休が最長です。
 
```

2
1/7
1/9
```

 ```

4
```

- 1/7は土曜日なので振替休日を以降に設定したく、1/9が祝日なので1/10が振替休日になります。
- よって、1/7(土)、1/8(日)、1/9(月)、1/10(火)の4連休が最長です。



---

---
title: "Lamps"
layout: "post"
diff: 普及/提高-
pid: AT_tokiomarine2020_c
tag: []
---

# Lamps

## 题目描述

# Lamps


[problemUrl]: https://atcoder.jp/contests/tokiomarine2020/tasks/tokiomarine2020_c

给定 $ N $ 个灯泡，其亮度分别为 $ A_i $。每个灯泡的作用范围为 $ i-A_i-0.5$ 到 $ i+A_i+0.5 $。

有 $ K $ 轮操作。

每轮操作使得每个灯泡的亮度更改为照亮它的灯泡的个数。

## 输入格式

> $ N $ 
> $ K $ 
> $ A_i $

## 输出格式

输出更改后的 $ A_i $ 

> $ A{'}_1 $ $ A{'}_2 $ $ \ldots $ $ A{'}_N $

## 样例 #1

### 样例输入 #1

```
5 1
1 0 0 1 0
```

### 样例输出 #1

```
1 2 2 1 2
```

## 样例 #2

### 样例输入 #2

```
5 2
1 0 0 1 0
```

### 样例输出 #2

```
3 3 4 4 3
```

## 说明/提示

- $ 1\ \leqq\ N\ \leqq\ 2\ \times\ 10^5 $
- $ 1\ \leqq\ K\ \leqq\ 2\ \times\ 10^5 $
- $ 0\ \leqq\ A_i\ \leqq\ N $

### 样例1解释 

$ 1 $ 号数只有第 $ 1 $ 个数本身作用 ，第 $ 2 $ 个数有第 $ 1 $ 和 第 $ 2 $ 个数作用，以此类推。

## 样例 #1

### 输入

```
5 1

1 0 0 1 0
```

### 输出

```
1 2 2 1 2
```

## 样例 #2

### 输入

```
5 2

1 0 0 1 0
```

### 输出

```
3 3 4 4 3
```



---

---
title: "一変数方程式"
layout: "post"
diff: 普及/提高-
pid: AT_tricky_2
tag: []
---

# 一変数方程式

## 题目描述

求解关于 $x$ 的方程 $ax^2 + bx + c=0$ 所有实数解。

## 输入格式

包含 $T$ 组数据。

对于每组数据，包含三个整数 $a,b,c$ ，使用半角符号进行分割。

## 输出格式

一行一组数据。
 
对于每组数据，输出解的数量后从小到大输出解，解的数量与解使用空格隔开。

若无解输出 `0` ，若有三个及以上的解只需输出 `3` ，与标准答案相差小于 $10^{-9}$ 次方即视为正确。

## 说明/提示

$0 \le T \le 2\times 10^5 , -2^{31} \le a,b,c < 2^{31}$

Translated By @Ferm_Tawn



---

---
title: "titech分離"
layout: "post"
diff: 普及/提高-
pid: AT_ttpc2015_g
tag: []
---

# titech分離

## 题目描述

[problemUrl]: https://atcoder.jp/contests/ttpc2015/tasks/ttpc2015_g

英小文字(a-z)からなる文字列$ S $が与えられる。

$ S $をいくつかの(連続とは限らない)部分文字列に分解する。 つまり、$ S $の各文字がちょうど1つの部分文字列に含まれるように、$ S $から複数の部分文字列を選ぶ。

分解した結果の部分文字列が全て`titech`になるような分解方法があるかどうか判定せよ。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ S $

- $ 1 $ 行目に文字列$ S(1\ ≦\ |\ S\ |\ ≦\ 100) $が与えられる。

## 输出格式

分解が可能なら`Yes`、不可能なら`No`を出力せよ。 出力の末尾に改行を入れること。

## 说明/提示

### Sample Explanation 1

1つの`titech`に分解できる。

### Sample Explanation 2

例えば、1,2,5,6,7,8文字目と3,4,9,10,11,12文字目に分解すれば2つの`titech`に分解できる。

### Sample Explanation 4

3つの`titech`に分解できる。

## 样例 #1

### 输入

```
titech
```

### 输出

```
Yes
```

## 样例 #2

### 输入

```
tititechtech
```

### 输出

```
Yes
```

## 样例 #3

### 输入

```
titecg
```

### 输出

```
No
```

## 样例 #4

### 输入

```
tttiiittteeeccchhh
```

### 输出

```
Yes
```



---

---
title: "Union Find"
layout: "post"
diff: 普及/提高-
pid: AT_unionfind_a
tag: []
---

# Union Find

## 题目描述

[problemUrl]: https://atcoder.jp/contests/atc001/tasks/unionfind_a

この問題は、講座用問題です。ページ下部に解説が掲載されています。

$ N $ 頂点の、単純とは限らない無向グラフを考えます。 初期状態では、頂点のみが存在し、辺は全く存在せず、全ての頂点が孤立しているとします。 以下の $ 2 $ 種類のクエリが、$ Q $ 回与えられます。

- 連結クエリ： 頂点 $ A $ と、頂点 $ B $ を繋ぐ辺を追加します。
- 判定クエリ： 頂点 $ A $ と、頂点 $ B $ が、連結であるかどうか判定します。連結であれば `Yes`、そうでなければ `No` を出力します。

クエリを順番に処理し、判定クエリへの回答を出力して下さい。 この際、同じ辺が何度も追加されることや、自分自身への辺が追加されることもある事に注意してください。

連結であるとは、頂点 $ A $ から頂点 $ B $ まで辺をたどって到達可能であることを意味します。 $ A $ と $ B $ が同じ頂点の場合、連結であると定義します。 グラフは無向であるため、連結クエリによって頂点 $ A,\ B $ 間の辺が追加されると、$ A $ から $ B $ へも $ B $ から $ A $ へも辿れるようになります。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ Q $ $ P_1 $ $ A_1 $ $ B_1 $ $ P_2 $ $ A_2 $ $ B_2 $ : $ P_Q $ $ A_Q $ $ B_Q $

- $ 1 $ 行目には、頂点の個数を表す整数 $ N\ (1≦N≦100,000) $ と、クエリの個数を表す整数 $ Q\ (1\ ≦\ Q\ ≦\ 200,000) $ が、スペース区切りで与えられる。
- $ 2 $ 行目からの $ Q $ 行のうち $ i $ 行目には、$ i $ 番目のクエリの種類を表す整数 $ P_i\ (0\ ≦\ P_i\ ≦\ 1) $ と、クエリの対象となる頂点の番号を表す整数 $ A_i,\ B_i\ (0\ ≦\ A_i,\ B_i\ ≦\ N\ -\ 1) $ が、 スペース区切りで与えられる。 
  - $ P_i\ =\ 0 $ の時、そのクエリが連結クエリであることを表す。
  - $ P_i\ =\ 1 $ の時、そのクエリが判定クエリであることを表す。

## 输出格式

各判定クエリに対し、出力をおこなって下さい。 毎回の出力の後に改行を行うこと。

## 说明/提示

### 解説

  **[Union find(素集合データ構造)](https://www.slideshare.net/secret/CIWAduFPvzGrrE "Union find(素集合データ構造)")**  from **[AtCoder Inc.](http://www.slideshare.net/chokudai)** 

### Sample Explanation 1

以下のような手順で実行されます。 - $ 1 $ つ目のクエリで、頂点 $ 1 $ と頂点 $ 2 $ を繋ぎます。 - $ 2 $ つ目のクエリで、頂点 $ 3 $ と頂点 $ 2 $ を繋ぎます。 - $ 3 $ つ目のクエリで、頂点 $ 1 $ と頂点 $ 3 $ の連結判定を行います。連結しているので、`Yes`と出力します。 - $ 4 $ つ目のクエリで、頂点 $ 1 $ と頂点 $ 4 $ の連結判定を行います。連結していないので、`No`と出力します。 - $ 5 $ つ目のクエリで、頂点 $ 2 $ と頂点 $ 4 $ を繋ぎます。 - $ 6 $ つ目のクエリで、頂点 $ 4 $ と頂点 $ 1 $ の連結判定を行います。連結しているで、`Yes`と出力します。 - $ 7 $ つ目のクエリで、頂点 $ 4 $ と頂点 $ 2 $ を繋ぎます。これらは既に繋がれていますが、多重辺が出来ることもあります。 - $ 8 $ つ目のクエリで、頂点 $ 0 $ と頂点 $ 0 $ を繋ぎます。これらは同じ頂点ですが、自己ループが出来ることもあります。 - $ 9 $ つ目のクエリで、頂点 $ 0 $ と頂点 $ 0 $ の連結判定を行います。同じ頂点は常に連結していると見做せるので、`Yes`と出力します。

## 样例 #1

### 输入

```
8 9

0 1 2

0 3 2

1 1 3

1 1 4

0 2 4

1 4 1

0 4 2

0 0 0

1 0 0
```

### 输出

```
Yes

No

Yes

Yes
```



---

---
title: "Row of Tents"
layout: "post"
diff: 普及/提高-
pid: AT_utpc2020_a
tag: []
---

# Row of Tents

## 题目描述

[problemUrl]: https://atcoder.jp/contests/utpc2020/tasks/utpc2020_a

 UT 大学にはテント列というサークル紹介イベントがあります。長さ $ L $ の道があり、 umg くんは位置 $ 0 $ から位置 $ L $ まで一方通行で歩きます。 umg くんには気力というパラメータがあり、その初期値を $ T $ とします。ここで、$ T $ は整数値とします。 umg くんは、距離 $ 1 $ 歩くごとに、気力が $ T $ 未満である場合は 気力が $ 1 $ 回復します。気力が $ T $ である場合は回復しません。

道上には $ N $ 個のテントがあり、$ i $ 番目のテントは位置 $ X_i $ にあります。 umg くんは $ i $ 番目のテントに着くとサークル勧誘にあい、気力が $ A_i $ 減少します。もしここで気力が $ 0 $ 未満になると、 umg くんはその場で倒れてしまいます。

 umg くんが途中で倒れずに位置 $ L $ までたどり着くのに必要な、気力の初期値 $ T $ の最小値を求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ L $ $ X_1 $ $ A_1 $ $ X_2 $ $ A_2 $ $ \vdots $ $ X_N $ $ A_N $

## 输出格式

答えを $ 1 $ 行に出力せよ。

## 说明/提示

### 制約

- 入力は全て整数である。
- $ 1\ \leq\ N\ \leq\ 2\times\ 10^5 $
- $ N\ \lt\ L\ \leq\ 10^9 $
- $ 0\lt\ X_1\ \lt\ X_2\ \lt\ \cdots\ \lt\ X_N\ \lt\ L $
- $ 1\ \leq\ A_i\ \leq\ 10^9\ (1\leq\ i\ \leq\ N) $

### Sample Explanation 1

気力の初期値 $ T=6 $ でスタートした場合は以下のような気力の変動になります。 - $ 1 $ 番目のテントにたどり着いて気力が $ 5 $ 減少し、気力が $ 1 $ になる。 - $ 2 $ 番目のテントにたどり着くまでに気力が $ 3 $ 回復し、気力が $ 4 $ になる。 - $ 2 $ 番目のテントにたどり着いて気力が $ 4 $ 減少し、気力が $ 0 $ になる。 - 位置 $ 7 $ にたどり着くまでに気力が $ 3 $ 回復し、気力 $ 3 $ の状態でテント列を終える。 気力の初期値 $ T=5 $ でスタートすると、$ 2 $ 番目のテントで気力が $ 0 $ 未満になってしまうので、答えは $ 6 $ となります。

## 样例 #1

### 输入

```
2 7

1 5

4 4
```

### 输出

```
6
```

## 样例 #2

### 输入

```
8 11

2 6

3 10

4 8

5 7

7 7

8 1

9 9

10 2
```

### 输出

```
42
```



---

---
title: "自宅からの脱出"
layout: "post"
diff: 普及/提高-
pid: AT_wupc2012_3
tag: []
---

# 自宅からの脱出

## 题目描述

一张地图用一些字符串来描述。地图上的位置代表对应的平面坐标。

上端表示北方。西北角为坐标 $(1,1)$，东南角为坐标 $(M,N)$。坐标 $(x,y)$ 表示第 $y$ 行的第 $x$ 个字符。

- `.` 空地
- `C` 笔记本电脑
- `S` 出发地
- `G` 门

你可以在 $1$ 个单位时间内从当前位置，移动到 $(x+1,y),(x,y+1),(x-1,y),(x,y-1)$ 中的任意一个。

特别的，还有一些不能移动到的要求：

- 不能移动到墙壁（`#`）所在的地方。

- 移动到计算机所在地之后立刻拿上电脑，不用考虑此动作所花的时间。

- 到达家的门口时，如果此时没有拿上笔记本电脑，那么什么也不会发生。

请求出拿上电脑并到达门口的所花的最短时间。

![](https://cdn.luogu.org/upload/pic/23163.png)

## 输入格式

第一行两个以空格隔开的正整数 $n$ 和 $m$，代表房间的大小为 $n$ 行 $m$ 列。

第二行至第 $n+1$ 行，每行一个字符串，为房间的平面图。

## 输出格式

输出拿上电脑并到达门口的所花的最短时间。

如果不能达到目标，则输出 `-1`。

## 说明/提示

对于 $100\%$ 的数据，$5\le n\le 500$，$5\le m\le 500$。

保证数据中墙壁围成了一个封闭图形。 

保证每行的首字符与末字符都为 `#`。

翻译 by @[159号程序员](https://www.luogu.com.cn/user/334586)



---

---
title: "最後の問題"
layout: "post"
diff: 普及/提高-
pid: AT_wupc2012_6
tag: []
---

# 最後の問題

## 题目描述

[problemUrl]: https://atcoder.jp/contests/wupc2012/tasks/wupc2012_6

 いよいよコンテスト当日，僕は早稲田大学・西早稲田キャンパスに到着した．しかも，到達時間は4でも7でも割り切れる数字であった．とても縁起がいい．今ならどんな問題だって解ける気がする．  
 会場の教室には既に数十名の学生が集まっていた．運営チームがジャッジシステム，AtCoderの説明を終え，もうあと数分でコンテストが始まろうとしているところだった．僕は持ってきたノートブック型計算機を広げ，高鳴る心臓を抑えつつコンテストに備える．  
  
 *(それでは，始めてください！)*  
  
 そして，コンテストが始まった．  
  
 挑戦はどんな結果だったのか，そして，コンテストを通じて僕は何を得たのだろうか… しかし，これはまた別の話．機会があれば語ることにしよう．ところで，このコンテストに出題された最後の問題は，次のようなものであった．  
 二次元の座標平面上に格子点が $ N $ 個与えられる．それらの点の中から $ 4 $ 点を選んで長方形を作る時，その最大面積を求めるプログラムを作成せよ．ただし，長方形は以下の条件を満たす必要がある．

- 長方形の各辺は $ x $ 軸または $ y $ 軸と並行になっていなければならない．
- 長方形の内部(辺は含まない)に他の点を含んではならない．
 
 長方形を構成する4点以外の点が辺の上にある時は，内部にはないと考えるものとする．また，条件を満たす長方形が一つも作れない時は，$ 0 $ を出力してほしい．  
 入力は以下の形式で標準入力から与えられる． > $ N $ $ x_{1}　y_{1} $ $ x_{2}　y_{2} $ $ ... $ $ x_{i}　y_{i} $ $ ... $ $ x_{N}　y_{N} $

- $ 1 $ 行目に点の数を表す $ N $($ 4\ ≦\ N\ ≦\ 10000 $)が与えられる．
- $ 2 $ 行目〜$ N+1 $行目にはそれぞれの点の $ x $ 座標と $ y $ 座標が半角スペース区切りで与えられる．
- 各 $ i $ について $ 0\ ≦\ x_{i}\ ≦\ 999 $ かつ $ 0\ ≦\ y_{i}\ ≦\ 999 $ を満たす．
- $ N $ 点の座標はすべて異なる．
 
 与えられた点を使って条件を満たすような長方形を作る時，その最大面積を一行に出力せよ．もし，条件を満たす長方形が一つも作れない場合は，$ 0 $ を出力せよ．  
 なお，最後には改行を出力せよ． 100点満点中，10点分については，$ N\ ≦\ 100 $ を満たす．  
 また，別の20点分については，$ N\ ≦\ 1000 $ を満たす．



---

---
title: "String Problem"
layout: "post"
diff: 普及/提高-
pid: AT_xmascon17_e
tag: []
---

# String Problem

## 题目描述

[problemUrl]: https://atcoder.jp/contests/xmascon17/tasks/xmascon17_e

$ 2 $ つの文字列 $ S,\ T $ が与えられます。 以下のような操作を好きな順番で好きなだけ行うことで $ S $ を $ T $ にできるかどうかを判定してください。

- 操作 $ A $：$ S $ に含まれる文字 `A` を $ 1 $ つ削除する。
- 操作 $ B $：$ S $ の好きな位置に文字 `B` を $ 1 $ つ挿入する。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ S $ $ T $

## 输出格式

可能な場合は `YES` を、不可能な場合は `NO` を出力せよ。

## 说明/提示

### 制約

- $ 1\ \leq\ |S|,\ |T|\ \leq\ 1000 $
- $ S,\ T $ は大文字アルファベットのみからなる

### 部分点

- $ |S|\ \leq\ 10 $ を満たすデータセットに正解した場合は、$ 50 $ 点が与えられる。
- 追加制約のないデータセットに正解した場合は、上記とは別に $ 50 $ 点が与えられる。

### Sample Explanation 1

例えば `XMAS` → `XBMAS` → `XBMS` のように操作すれば良いです。

### Sample Explanation 2

例えば `AABABA` → `ABABA` → `BABABA` → `BABABAB` → `BABBABAB` のように操作すれば良いです。

## 样例 #1

### 输入

```
XMAS

XBMS
```

### 输出

```
YES
```

## 样例 #2

### 输入

```
AABABA

BABBABAB
```

### 输出

```
YES
```

## 样例 #3

### 输入

```
AB

AA
```

### 输出

```
NO
```

## 样例 #4

### 输入

```
ATCODER

CONTEST
```

### 输出

```
NO
```



---

---
title: "宇宙人からのメッセージ"
layout: "post"
diff: 普及/提高-
pid: AT_zone2021_d
tag: []
---

# 宇宙人からのメッセージ

## 题目描述

给出密文 $S$，解读方法如下：

- 设 $T$ 为空字符串；
- $i=1,2,...,|S|$ 以下按顺序进（$|S|$ 表示 $S$ 的长度）；
    - 当 $S$ 的第 $i$ 字母是 $R$ 时，将 $T$ 反转；
   - 当 $S$ 的第 $i$ 个字母不是 $R$ 时，在 $T$ 的末尾加上该字母。
- 然后，如果 $T$ 中连续出现了两个相同的字母，就去掉这两个字母。尽可能地继续这个操作(可以证明最终得到的字符串不会取决于去除的顺序)。

请输出通过以上操作得到的字符串 $T$。

## 输入格式

共一行，一个字符串 $S$。

## 输出格式

共一行，一个字符串 $T$。

## 说明/提示

- 字符串 $S$ 由英文小写字母和R组成；
- $1 \le |S| \le 5 × 10^5 $。

### 样例 1 解释

- 最初，$T$ 是空字符串。
- 在 $T$ 的末尾加上 `o`，$T$ 变成了 `o`。
- 在 $T$ 的末尾加上 `z`，$T$ 变成了 `oz`。
- $T$ 反转，$T$ 变成了 `zo`。
- 在 $T$ 的末尾加上 `n`，$T$ 变成了 `zon`。
- 在 $T$ 的末尾加上 `o`，$T$ 变成了 `zono`。
- 在 $T$ 的末尾加上 `n`，$T$ 变成了 `zonon`。
- 在 $T$ 的末尾加上 `n`，$T$ 变成了 `zononn`。
- 在 $T$ 的末尾加上 `o`，$T$ 变成了 `zononno`。
- 在 $T$ 的末尾加上 `e`，$T$ 变成了 `zononnoe`。
- 删除连续排列的 `n`，$T$ 变成了 `zonooe`。
- 删除连续排列的 `o`，$T$ 变成了 `zone`。

### 样例 2 解释
空串有时也会成为答案。

## 样例 #1

### 输入

```
ozRnonnoe
```

### 输出

```
zone
```

## 样例 #2

### 输入

```
hellospaceRhellospace
```

### 输出

```

```



---



---

# 无标签题目列表

- AT_abc012_4 - [ABC012D] バスと避けられない運命
- AT_abc015_3 - [ABC015C] 高橋くんのバグ探し
- AT_abc016_4 - [ABC016D] 一刀両断
- AT_abc019_4 - [ABC019D] 高橋くんと木の直径
- AT_abc021_c - [ABC021C] 正直者の高橋くん
- AT_abc024_c - [ABC024C] 民族大移動
- AT_abc026_c - [ABC026C] 高橋君の給料
- AT_abc027_b - [ABC027B] 島と橋
- AT_abc030_c - [ABC030C] 飛行機乗り
- AT_abc031_c - [ABC031C] 数列ゲーム
- AT_abc033_c - [ABC033C] 数式の書き換え
- AT_abc035_b - [ABC035B] ドローン
- AT_abc039_d - [ABC039D] 画像処理高橋君
- AT_abc040_c - [ABC040C] 柱柱柱柱柱
- AT_abc045_b - [ABC045B] 3人でカードゲームイージー
- AT_abc054_b - [ABC054B] Template Matching
- AT_abc054_c - [ABC054C] One-stroke Path
- AT_abc054_d - [ABC054D] Mixing Experiment
- AT_abc057_b - [ABC057B] Checkpoints
- AT_abc070_c - [ABC070C] Multiple Clocks
- AT_abc075_c - [ABC075C] Bridge
- AT_abc076_c - [ABC076C] Dubious Document 2
- AT_abc080_c - [ABC080C] Shopping Street
- AT_abc088_d - [ABC088D] Grid Repainting
- AT_abc089_d - [ABC089D] Practical Skill Test
- AT_abc096_d - [ABC096D] Five, Five Everywhere
- AT_abc099_c - [ABC099C] Strange Bank
- AT_abc103_c - [ABC103C] Modulo Summation
- AT_abc103_d - [ABC103D] Islands War
- AT_abc109_d - [ABC109D] Make Them Even
- AT_abc110_c - [ABC110C] String Transformation
- AT_abc112_c - [ABC112C] Pyramid
- AT_abc112_d - [ABC112D] Partition
- AT_abc113_c - [ABC113C] ID
- AT_abc115_d - [ABC115D] Christmas
- AT_abc121_d - [ABC121D] XOR World
- AT_abc122_c - [ABC122C] GeT AC
- AT_abc124_d - [ABC124D] Handstand
- AT_abc125_c - [ABC125C] GCD on Blackboard
- AT_abc125_d - [ABC125D] Flipping Signs
- AT_abc126_d - [ABC126D] Even Relation
- AT_abc127_d - [ABC127D] Integer Cards
- AT_abc129_d - [ABC129D] Lamp
- AT_abc130_d - [ABC130D] Enough Array
- AT_abc133_d - [ABC133D] Rain Flows into Dams
- AT_abc134_d - [ABC134D] Preparing Boxes
- AT_abc134_e - [ABC134E] Sequence Decomposing
- AT_abc135_d - [ABC135D] Digits Parade
- AT_abc137_c - [ABC137C] Green Bin
- AT_abc138_d - [ABC138D] Ki
- AT_abc140_d - [ABC140D] Face Produces Unhappiness
- AT_abc142_d - [ABC142D] Disjoint Set of Common Divisors
- AT_abc144_d - [ABC144D] Water Bottle
- AT_abc144_e - [ABC144E] Gluttony
- AT_abc145_d - [ABC145D] Knight
- AT_abc147_c - [ABC147C] HonestOrUnkind2
- AT_abc147_d - [ABC147D] Xor Sum 4
- AT_abc147_e - [ABC147E] Balanced Path
- AT_abc148_e - [ABC148E] Double Factorial
- AT_abc149_d - [ABC149D] Prediction and Restriction
- AT_abc152_d - [ABC152D] Handstand 2
- AT_abc153_e - [ABC153E] Crested Ibis vs Monster
- AT_abc156_d - [ABC156D] Bouquet
- AT_abc157_d - [ABC157D] Friend Suggestions
- AT_abc158_d - [ABC158D] String Formation
- AT_abc161_d - [ABC161D] Lunlun Number
- AT_abc161_e - [ABC161E] Yutori
- AT_abc162_d - [ABC162D] RGB Triplets
- AT_abc162_f - [ABC162F] Select Half
- AT_abc163_d - [ABC163D] Sum of Large Numbers
- AT_abc164_d - [ABC164D] Multiple of 2019
- AT_abc165_c - [ABC165C] Many Requirements
- AT_abc166_e - [ABC166E] This Message Will Self-Destruct in 5s
- AT_abc167_d - [ABC167D] Teleporter
- AT_abc168_d - [ABC168D] .. (Double Dots)
- AT_abc169_d - [ABC169D] Div Game
- AT_abc170_d - [ABC170D] Not Divisible
- AT_abc171_e - [ABC171E] Red Scarf
- AT_abc172_c - [ABC172C] Tsundoku
- AT_abc172_d - [ABC172D] Sum of Divisors
- AT_abc173_d - [ABC173D] Chat in a Circle
- AT_abc174_e - [ABC174E] Logs
- AT_abc176_d - [ABC176D] Wizard in Maze
- AT_abc176_e - [ABC176E] Bomber
- AT_abc177_d - [ABC177D] Friends
- AT_abc177_e - [ABC177E] Coprime
- AT_abc178_d - [ABC178D] Redistribution
- AT_abc178_e - [ABC178E] Dist Max
- AT_abc179_d - [ABC179D] Leaping Tak
- AT_abc179_e - [ABC179E] Sequence Sum
- AT_abc180_d - [ABC180D] Takahashi Unevolved
- AT_abc180_e - [ABC180E] Traveling Salesman among Aerial Cities
- AT_abc181_e - [ABC181E] Transformable Teacher
- AT_abc182_d - [ABC182D] Wandering
- AT_abc182_e - [ABC182E] Akari
- AT_abc183_e - [ABC183E] Queen on Grid
- AT_abc184_c - [ABC184C] Super Ryuma
- AT_abc184_d - [ABC184D] increment of coins
- AT_abc185_f - [ABC185F] Range Xor Query
- AT_abc188_d - [ABC188D] Snuke Prime
- AT_abc188_e - [ABC188E] Peddler
- AT_abc189_d - [ABC189D] Logical Expression
- AT_abc190_d - [ABC190D] Staircase Sequences
- AT_abc191_c - [ABC191C] Digital Graffiti
- AT_abc192_e - [ABC192E] Train
- AT_abc193_d - [ABC193D] Poker
- AT_abc194_d - [ABC194D] Journey
- AT_abc194_e - [ABC194E] Mex Min
- AT_abc195_d - [ABC195D] Shipping Center
- AT_abc196_d - [ABC196D] Hanjo
- AT_abc197_c - [ABC197C] ORXOR
- AT_abc197_d - [ABC197D] Opposite
- AT_abc198_d - [ABC198D] Send More Money
- AT_abc198_e - [ABC198E] Unique Color
- AT_abc200_d - [ABC200D] Happy Birthday! 2
- AT_abc202_d - [ABC202D] aab aba baa
- AT_abc204_d - [ABC204D] Cooking
- AT_abc205_d - [ABC205D] Kth Excluded
- AT_abc206_d - [ABC206D] KAIBUNsyo
- AT_abc211_d - [ABC211D] Number of Shortest paths
- AT_abc212_d - [ABC212D] Querying Multiset
- AT_abc213_d - [ABC213D] Takahashi Tour
- AT_abc215_d - [ABC215D] Coprime 2
- AT_abc216_d - [ABC216D] Pair of Balls
- AT_abc216_e - [ABC216E] Amusement Park
- AT_abc217_d - [ABC217D] Cutting Woods
- AT_abc217_e - [ABC217E] Sorting Queries
- AT_abc218_c - [ABC218C] Shapes
- AT_abc218_d - [ABC218D] Rectangles
- AT_abc218_e - [ABC218E] Destruction
- AT_abc219_d - [ABC219D] Strange Lunchbox
- AT_abc221_d - [ABC221D] Online games
- AT_abc222_d - [ABC222D] Between Two Arrays
- AT_abc223_d - [ABC223D] Restricted Permutation
- AT_abc225_d - [ABC225D] Play Train
- AT_abc226_d - [ABC226D] Teleportation
- AT_abc227_c - [ABC227C] ABC conjecture
- AT_abc228_d - [ABC228D] Linear Probing
- AT_abc229_d - [ABC229D] Longest X
- AT_abc229_e - [ABC229E] Graph Destruction
- AT_abc230_d - [ABC230D] Destroyer Takahashi
- AT_abc230_e - [ABC230E] Fraction Floor Sum
- AT_abc231_d - [ABC231D] Neighbors
- AT_abc233_d - [ABC233D] Count Interval
- AT_abc233_e - [ABC233E] Σ[k=0..10^100]floor(X／10^k)
- AT_abc234_e - [ABC234E] Arithmetic Number
- AT_abc235_d - [ABC235D] Multiply and Rotate
- AT_abc236_d - [ABC236D] Dance
- AT_abc237_e - [ABC237E] Skiing
- AT_abc238_d - [ABC238D] AND and SUM
- AT_abc239_e - [ABC239E] Subtree K-th Max
- AT_abc240_e - [ABC240E] Ranges on Tree
- AT_abc241_d - [ABC241D] Sequence Query
- AT_abc241_e - [ABC241E] Putting Candies
- AT_abc242_d - [ABC242D] ABC Transform
- AT_abc243_d - [ABC243D] Moves on Binary Tree
- AT_abc244_e - [ABC244E] King Bombee
- AT_abc245_d - [ABC245D] Polynomial division
- AT_abc246_d - [ABC246D] 2-variable Function
- AT_abc247_e - [ABC247E] Max Min
- AT_abc248_c - [ABC248C] Dice Sum
- AT_abc248_d - [ABC248D] Range Count Query
- AT_abc248_e - [ABC248E] K-colinear Line
- AT_abc249_d - [ABC249D] Index Trio
- AT_abc250_d - [ABC250D] 250-like Number
- AT_abc252_d - [ABC252D] Distinct Trio
- AT_abc254_d - [ABC254D] Together Square
- AT_abc255_d - [ABC255D] ±1 Operation 2
- AT_abc257_d - [ABC257D] Jumping Takahashi 2
- AT_abc259_d - [ABC259D] Circumferences
- AT_abc260_d - [ABC260D] Draw Your Cards
- AT_abc261_d - [ABC261D] Flipping and Bonus
- AT_abc262_d - [ABC262D] I Hate Non-integer Number
- AT_abc263_d - [ABC263D] Left Right Operation
- AT_abc264_c - [ABC264C] Matrix Reducing
- AT_abc265_d - [ABC265D] Iroha and Haiku (New ABC Edition)
- AT_abc266_c - [ABC266C] Convex Quadrilateral
- AT_abc266_d - [ABC266D] Snuke Panic (1D)
- AT_abc266_e - [ABC266E] Throwing the Die
- AT_abc267_d - [ABC267D] Index × A(Not Continuous ver.)
- AT_abc269_e - [ABC269E] Last Rook
- AT_abc270_e - [ABC270E] Apple Baskets on Circle
- AT_abc271_c - [ABC271C] Manga
- AT_abc272_d - [ABC272D] Root M Leaper
- AT_abc273_d - [ABC273D] LRUD Instructions
- AT_abc274_d - [ABC274D] Robot Arms 2
- AT_abc275_c - [ABC275C] Counting Squares
- AT_abc275_e - [ABC275E] Sugoroku 4
- AT_abc276_d - [ABC276D] Divide by 2 or 3
- AT_abc276_e - [ABC276E] Round Trip
- AT_abc277_d - [ABC277D] Takahashi's Solitaire
- AT_abc278_d - [ABC278D] All Assign Point Add
- AT_abc278_e - [ABC278E] Grid Filling
- AT_abc279_d - [ABC279D] Freefall
- AT_abc280_d - [ABC280D] Factorial and Multiple
- AT_abc280_e - [ABC280E] Critical Hit
- AT_abc287_d - [ABC287D] Match or Not
- AT_abc287_e - [ABC287E] Karuta
- AT_abc289_e - [ABC289E] Swap Places
- AT_abc290_d - [ABC290D] Marking
- AT_abc291_d - [ABC291D] Flip Cards
- AT_abc291_e - [ABC291E] Find Permutation
- AT_abc292_e - [ABC292E] Transitivity
- AT_abc293_d - [ABC293D] Tying Rope
- AT_abc294_e - [ABC294E] 2xN Grid
- AT_abc295_d - [ABC295D] Three Days Ago
- AT_abc296_d - [ABC296D] M<=ab
- AT_abc296_e - [ABC296E] Transition Game
- AT_abc297_e - [ABC297E] Kth Takoyaki Set
- AT_abc298_d - [ABC298D] Writing a Numeral
- AT_abc299_d - [ABC299D] Find by Query
- AT_abc299_e - [ABC299E] Nearest Black Vertex
- AT_abc301_d - [ABC301D] Bitmask
- AT_abc302_e - [ABC302E] Isolation
- AT_abc303_d - [ABC303D] Shift vs. CapsLock
- AT_abc303_e - [ABC303E] A Gift From the Stars
- AT_abc304_d - [ABC304D] A Piece of Cake
- AT_abc304_e - [ABC304E] Good Graph
- AT_abc305_d - [ABC305D] Sleep Log
- AT_abc305_e - [ABC305E] Art Gallery on Graph
- AT_abc306_e - [ABC306E] Best Performances
- AT_abc307_c - [ABC307C] Ideal Sheet
- AT_abc307_d - [ABC307D] Mismatched Parentheses
- AT_abc307_e - [ABC307E] Distinct Adjacent
- AT_abc308_d - [ABC308D] Snuke Maze
- AT_abc309_d - [ABC309D] Add One Edge
- AT_abc309_e - [ABC309E] Family and Insurance
- AT_abc324_d - [ABC324D] Square Permutation
- AT_abc324_e - [ABC324E] Joint Two Strings
- AT_abc326_d - [ABC326D] ABC Puzzle
- AT_abc327_d - [ABC327D] Good Tuple Problem
- AT_abc329_f - [ABC329F] Colored Ball
- AT_abc330_e - [ABC330E] Mex and Update
- AT_abc331_d - [ABC331D] Tile Pattern
- AT_abc331_e - [ABC331E] Set Meal
- AT_abc332_d - [ABC332D] Swapping Puzzle
- AT_abc337_e - [ABC337E] Bad Juice
- AT_abc346_e - [ABC346E] Paint
- AT_abc348_f - [ABC348F] Oddly Similar
- AT_abc357_d - [ABC357D] 88888888
- AT_abc387_d - [ABC387D] Snaky Walk
- AT_abc389_d - [ABC389D] Squares in Circle
- AT_abc390_e - [ABC390E] Vitamin Balance
- AT_abc391_d - [ABC391D] Gravity
- AT_agc002_c - [AGC002C] Knot Puzzle
- AT_agc003_b - [AGC003B] Simplified mahjong
- AT_agc008_a - [AGC008A] Simple Calculator
- AT_agc009_a - [AGC009A] Multiple Array
- AT_agc011_a - [AGC011A] Airport Bus
- AT_agc011_b - [AGC011B] Colorful Creatures
- AT_agc012_a - [AGC012A] AtCoder Group Contest
- AT_agc013_a - [AGC013A] Sorted Arrays
- AT_agc013_b - [AGC013B] Hamiltonish Path
- AT_agc015_b - [AGC015B] Evilator
- AT_agc016_a - [AGC016A] Shrinking
- AT_agc019_b - [AGC019B] Reverse and Compare
- AT_agc021_a - [AGC021A] Digit Sum 2
- AT_agc022_a - [AGC022A] Diverse Word
- AT_agc023_a - [AGC023A] Zero-Sum Ranges
- AT_aising2019_c - Alternating Path
- AT_apc001_b - Two Arrays
- AT_apc001_c - Vacant Seat
- AT_arc004_3 - [ARC004C] 平均値太郎の憂鬱 ( The melancholy of Taro Heikinchi )
- AT_arc006_3 - [ARC006C] 積み重ね
- AT_arc007_3 - [ARC007C] 節約生活
- AT_arc010_2 - [ARC010B] 超大型連休
- AT_arc011_2 - [ARC011B] ルイス・キャロルの記憶術
- AT_arc013_2 - [ARC013B] 引越しできるかな？
- AT_arc014_2 - [ARC014B] あの日したしりとりの結果を僕達はまだ知らない。
- AT_arc014_3 - [ARC014C] 魂の還る場所
- AT_arc017_2 - [ARC017B] 解像度が低い。
- AT_arc018_2 - [ARC018B] 格子点と整数
- AT_arc019_2 - [ARC019B] こだわりの名前
- AT_arc020_2 - [ARC020B] 縞模様
- AT_arc023_2 - [ARC023B] 謎の人物X
- AT_arc030_2 - [ARC030B] ツリーグラフ
- AT_arc031_2 - [ARC031B] 埋め立て
- AT_arc032_2 - [ARC032B] 道路工事
- AT_arc033_2 - [ARC033B] メタ構文変数
- AT_arc035_b - [ARC035B] アットコーダー王国のコンテスト事情
- AT_arc036_b - [ARC036B] 山のデータ
- AT_arc037_b - [ARC037B] バウムテスト
- AT_arc040_b - [ARC040B] 直線塗り
- AT_arc040_c - [ARC040C] Z塗り
- AT_arc041_b - [ARC041B] アメーバ
- AT_arc042_b - [ARC042B] アリの高橋くん
- AT_arc043_a - [ARC043A] 点数変換
- AT_arc043_b - [ARC043B] 難易度
- AT_arc045_b - [ARC045B] ドキドキデート大作戦高橋君
- AT_arc048_b - [ARC048B] AtCoderでじゃんけんを
- AT_arc053_b - [ARC053B] 回文分割
- AT_arc054_a - [ARC054A] 動く歩道
- AT_arc054_b - [ARC054B] ムーアの法則
- AT_arc059_b - [ARC059D] アンバランス
- AT_arc060_a - [ABC044C] 高橋君とカード
- AT_arc061_a - [ABC045C] たくさんの数式
- AT_arc064_a - [ABC048C] Boxes and Candies
- AT_arc065_a - [ABC049C] 白昼夢
- AT_arc065_b - [ABC049D] 連結
- AT_arc066_a - [ABC050C] Lining Up
- AT_arc067_b - [ABC052D] Walk and Teleport
- AT_arc071_b - [ABC058D] 井井井
- AT_arc071_c - [ARC071E] TrBBnsformBBtion
- AT_arc073_b - [ABC060D] Simple Knapsack
- AT_arc074_a - [ABC062C] Chocolate Bar
- AT_arc074_b - [ABC062D] 3N Numbers
- AT_arc076_a - [ABC065C] Reconciled?
- AT_arc080_b - [ABC069D] Grid Coloring
- AT_arc081_b - [ABC071D] Coloring Dominoes
- AT_arc083_a - [ABC074C] Sugar Water
- AT_arc085_b - [ABC078D] ABS
- AT_arc088_b - [ABC083D] Wide Flip
- AT_arc091_b - [ABC090D] Remainder Reminder
- AT_arc092_a - [ABC091C] 2D Plane 2N Points
- AT_arc095_b - [ABC094D] Binomial Coefficients
- AT_arc097_a - [ABC097C] K-th Substring
- AT_arc097_b - [ABC097D] Equals
- AT_arc098_b - [ABC098D] Xor Sum 2
- AT_arc099_a - [ABC101C] Minimization
- AT_arc101_a - [ABC107C] Candles
- AT_arc102_a - [ABC108C] Triangular Relationship
- AT_arc103_a - [ABC111C] /\/\/\/
- AT_arc106_b - [ARC106B] Values
- AT_arc106_c - [ARC106C] Solutions
- AT_arc109_c - [ARC109C] Large RPS Tournament
- AT_arc110_c - [ARC110C] Exoswap
- AT_arc111_a - [ARC111A] Simple Math 2
- AT_arc112_b - [ARC112B] -- - B
- AT_arc113_c - [ARC113C] String Invasion
- AT_arc114_a - [ARC114A] Not coprime
- AT_arc114_b - [ARC114B] Special Subsets
- AT_arc115_c - [ARC115C] ℕ Coloring
- AT_arc116_b - [ARC116B] Products of Min-Max
- AT_arc118_b - [ARC118B] Village of M People
- AT_arc118_c - [ARC118C] Coprime Set
- AT_arc119_b - [ARC119B] Electric Board
- AT_arc120_b - [ARC120B] Uniformly Distributed
- AT_arc121_b - [ARC121B] RGB Matching
- AT_arc122_a - [ARC122A] Many Formulae
- AT_arc122_b - [ARC122B] Insurance
- AT_arc124_b - [ARC124B] XOR Matching 2
- AT_arc125_b - [ARC125B] Squares
- AT_arc127_a - [ARC127A] Leading 1s
- AT_arc128_b - [ARC128B] Balls of Three Colors
- AT_arc129_a - [ARC129A] Smaller XOR
- AT_arc129_b - [ARC129B] Range Point Distance
- AT_arc131_c - [ARC131C] Zero XOR
- AT_arc132_b - [ARC132B] Shift and Reverse
- AT_arc134_b - [ARC134B] Reserve or Reverse
- AT_arc135_b - [ARC135B] Sum of Three Terms
- AT_arc137_b - [ARC137B] Count 1's
- AT_arc138_a - [ARC138A] Larger Score
- AT_arc138_b - [ARC138B] 01 Generation
- AT_arc140_a - [ARC140A] Right String
- AT_arc140_b - [ARC140B] Shorten ARC
- AT_arc141_a - [ARC141A] Periodic Number
- AT_arc141_b - [ARC141B] Increasing Prefix XOR
- AT_arc144_b - [ARC144B] Gift Tax
- AT_arc145_b - [ARC145B] AB Game
- AT_arc146_a - [ARC146A] Three Cards
- AT_arc147_b - [ARC147B] Swap to Sort
- AT_arc148_b - [ARC148B] dp
- AT_arc150_a - [ARC150A] Continuous 1
- AT_arc182_a - [ARC182A] Chmax Rush!
- AT_arc191_a - [ARC191A] Replace Digits
- AT_arc191_b - [ARC191B] XOR = MOD
- AT_birthday0410_a - A + B
- AT_caddi2018_a - Product and GCD
- AT_caddi2018_b - Harlequin
- AT_cf17_final_b - Palindrome-phobia
- AT_cf17_final_c - Time Gap
- AT_code_festival_2017_quala_b - fLIP
- AT_code_festival_2017_qualc_c - Inserting &#39;x&#39;
- AT_code_festival_china_a - Lock
- AT_code_festival_final_e - 常ならずグラフ
- AT_code_festival_relay_f - ループを探せ
- AT_code_formula_2014_final_f - 100個の円
- AT_code_thanks_festival_2015_d - 暴露
- AT_code_thanks_festival_2017_b - Concatenated Palindrome
- AT_code_thanks_festival_2017_d - Bus Tour
- AT_codefestival_2016_qualA_c - 次のアルファベット
- AT_codefestival_2016_qualC_b - K個のケーキ
- AT_cpsco2019_s2_d - Two Piles
- AT_ddcc_2016_final_a - 正方形のチップ
- AT_digitalarts_1 - C-Filter
- AT_diverta2019_2_b - Picking Up
- AT_diverta2019_2_c - Successive Subtraction
- AT_diverta2019_c - AB Substrings
- AT_diverta2019_d - DivRem Number
- AT_donuts_2015_2 - Tokyo 7th シスターズ
- AT_donuts_live2014_4 - サバゲー
- AT_dp_e - Knapsack 2
- AT_dp_f - LCS
- AT_dp_g - Longest Path
- AT_dp_k - Stones
- AT_dp_l - Deque
- AT_dp_n - Slimes
- AT_fuka_insider - すべては1になる
- AT_fuka_liquid - 流れ
- AT_ijpc_ijpc - 国際情報オリンピック日本代表プログラミングコンテスト (Welcome to IJPC)
- AT_indeednow_2015_finala_a - Table Tennis
- AT_indeednow_2015_finalb_b - How are you?
- AT_indeednow_2015_qualb_4 - 高橋くんと数列
- AT_indeednow_2015_qualc_3 - 木
- AT_iroha2019_day3_c - Not Say "NO"
- AT_joi2008ho_b - 共通部分文字列
- AT_joi2013ho4 - JOIOI の塔 (Tower of JOIOI)
- AT_joi2015yo_d - シルクロード (Silk Road)
- AT_joi2016ho_a - オレンジの出荷 (Oranges)
- AT_joi2018ho_b - 美術展 (Art Exhibition)
- AT_joi2019ho_a - 勇者ビ太郎 (Bitaro the Brave)
- AT_joi2021ho_a - とてもたのしい家庭菜園 (Growing Vegetables is Fun 4)
- AT_joi2022ho_b - 自習 (Self Study)
- AT_joisc2014_d - ラーメンの食べ比べ
- AT_jsc2019_qual_b - Kleene Inversion
- AT_jsc2021_d - Nowhere P
- AT_k4pc_a - ブロックの移動(Blocks)
- AT_kupc2012pr_1 - Wikipedia
- AT_kupc2015_b - GUARDIANS
- AT_kupc2019_b - ナップサック問題
- AT_m_solutions2019_d - Maximum Sum of Minimum
- AT_mujin_pc_2016_b - ロボットアーム
- AT_mujin_pc_2018_c - 右折
- AT_nikkei2019_2_qual_b - Counting of Trees
- AT_nikkei2019_qual_c - Different Strokes
- AT_nomura2020_c - Folia
- AT_nyc2015_3 - 文字列の書き換え
- AT_pakencamp_2019_day3_d - パ研軍旗
- AT_past201912_n - 整地
- AT_past202005_i - 行列操作
- AT_past202107_g - べき表現
- AT_past202109_j - 数列の反転
- AT_past202112_j - 回転と反転
- AT_relay2_f - Capture
- AT_s8pc_2_c - 何通りの分割方法がある？
- AT_s8pc_5_b - Emblem
- AT_sumitb2019_d - Lucky PIN
- AT_sumitb2019_e - Colorful Hats 2
- AT_tenka1_2012_10 - ロイヤルストレートフラッシュ
- AT_tenka1_2012_6 - camel_case
- AT_tenka1_2012_final_a - ぶんたん
- AT_tenka1_2014_qualB_b - エターナルスタティックファイナル
- AT_tenka1_2015_qualB_b - 天下一リテラル
- AT_tenka1_2016_qualA_b - PackDrop
- AT_tenka1_2016_qualA_c - 山田山本問題
- AT_tenka1_2016_qualB_b - 天下一魔力発電
- AT_tenka1_2017_c - 4/N
- AT_tenka1_2018_c - Align
- AT_tenka1_2019_c - Stones
- AT_test001_d - 超大型連休
- AT_tokiomarine2020_c - Lamps
- AT_tricky_2 - 一変数方程式
- AT_ttpc2015_g - titech分離
- AT_unionfind_a - Union Find
- AT_utpc2020_a - Row of Tents
- AT_wupc2012_3 - 自宅からの脱出
- AT_wupc2012_6 - 最後の問題
- AT_xmascon17_e - String Problem
- AT_zone2021_d - 宇宙人からのメッセージ


---

---
title: "[ABC002D] 派閥"
layout: "post"
diff: 普及+/提高
pid: AT_abc002_4
tag: []
---

# [ABC002D] 派閥

## 题目描述

从上帝和母亲鼓励的话语中重新获得信心（中二）的高桥君决定去任选国会议员，以纠正AtCoder国家的腐败政治。
以实践操控和演讲而闻名的高桥君最终以实践操控和演讲而闻名的高桥君最终没有困难地赢得了大家的信任，成为了国会议员。
成为国会议员后，接下来就是实际操作。为了纠正这个国家的腐败政治，他需要被任命为总理。
在AtCoder国家除了高桥君之外，还有**N名议员**，存在**M个人际关系（x，y）**。
**人际关系（x，y）的意思是表示成员x和成员y彼此熟悉**（就是可以搞投票的意思）。
高桥君计划通过从N位议员中选出一些议员来制造自己的派系（就是会支持自己）。
**要求包括在该派系中的所有成员必须彼此了解。**
请你动动你的小手写一个程序，求出能属于高桥派系的最大成员人数。

## 输出格式

请输出属于高桥君可以创建的派系的最大成员数量。
另外，请在输出结尾处放置一个回车符。

## 说明/提示

（样例一）

第1行：与五位议员有三种人际关系。
第2行：议员1和2互相熟悉。（1,2）
第3行：议员2和3互相熟悉。 （2,3）
第4行：议员1和3互相熟悉。 （1,3）
因为国会议员1，国会议员2，国会议员3相互认识，所以这三个人可以组成高桥君的~~后宫~~支持队伍。

（样例二）

这一个样例有以下可能的关系 ：
1.议员1和议员2互相熟悉（1,2）
2.议员2和议员3互相熟悉 （2,3）
3.议员3和议员4互相熟悉（3,4）
（但是议员1和议员4不互相熟悉所以只能是选择2号议员和3号议员）

翻译：Forgetrmber~这个小小蒟蒻



---

---
title: "[ABC005D] おいしいたこ焼きの焼き方"
layout: "post"
diff: 普及+/提高
pid: AT_abc005_4
tag: []
---

# [ABC005D] おいしいたこ焼きの焼き方

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc005/tasks/abc005_4

高橋君のたこ焼き屋で使っているたこ焼き器は焼く場所によって美味しさの変わるクセの強いたこ焼き器です。  
 また、店員の力量によって一度に焼けるたこ焼きの数が違います。  
 高橋君はそれぞれの店員ができるだけ美味しくたこ焼きを焼けるようにしようと思いました。  
  
 たこ焼き器は$ N×N $の正方形をしています。  
 それぞれの場所ごとにたこ焼きの美味しさ$ D_{ij} $が決まっています。  
 それぞれの店員は一度に焼けるたこ焼きの上限$ P_k $が決まっています。  
 また、一度に焼くたこ焼きは必ずたこ焼き器の長方形の部分になっていて、その中の全てを使わなければなりません。  
 それぞれの店員について一度に焼けるたこ焼きの美味しさの合計の最大値を求めて下さい。  
 ただし、店員が焼き始める時はたこ焼き器が完全に空いていてどの場所でも使えるとします。 入力は以下の形式で標準入力から与えられる。

> $ N $ $ D_{11} $ $ D_{12} $ ... $ D_{1N} $ $ D_{21} $ $ D_{22} $ ... $ D_{2N} $ $ ... $ $ D_{N1} $ $ D_{N2} $ ... $ D_{NN} $ $ Q $ $ P_1 $ $ P_2 $ $ ... $ $ P_Q $

- １行目にたこ焼き器の一辺の大きさを表す整数$ N(1≦N≦50) $が与えられます。
- 続く$ N $行にたこ焼き器のそれぞれの場所で焼けるたこ焼きの美味しさを表す整数$ D_{ij}(1≦D_{ij}≦100) $が与えられます。
- 次の行に店員の人数を表す整数$ Q $($ 1≦Q≦N^2 $)が与えられます。
- 続く$ Q $行にそれぞれの店員が焼けるたこ焼きの数を表す整数$ P_k(1≦P_k≦N^2) $が与えられます。
 
 それぞれの店員について一度に焼けるたこ焼きの美味しさの合計の最大値を出力して下さい。  
また、出力の末尾には改行を入れて下さい。$ 1≦N≦5 $を満たすテストケース全てに正解すると、$ 100 $点満点のうち $ 50 $点が与えられる。

 ```

3
3 2 1
2 2 1
1 1 1
3
1
4
9
```

 ```

3
9
14
```

- １人目の店員は左上でたこ焼きを焼くと美味しさの合計が$ 3 $になります。
- ２人目の店員は左上の2×2の範囲でたこ焼きを焼くと美味しさの合計が$ 9 $になります。
- ３人目の店員はたこ焼き器全てを使えるので美味しさの合計が$ 14 $になります。
 
 これは部分点に含まれる入力になります。 ```

3
1 1 1
1 1 1
9 9 9
1
4
```

 ```

27
```

- 一番下の列の範囲1×3でたこ焼きを焼くと美味しさの合計が$ 27 $になります。
- この店員はたこ焼きを４個焼くことができますが、３個しか焼かないほうが美味しさの合計が大きくなります。
 
 これは部分点に含まれる入力になります。



---

---
title: "[ABC008C] コイン"
layout: "post"
diff: 普及+/提高
pid: AT_abc008_3
tag: []
---

# [ABC008C] コイン

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc008/tasks/abc008_3

高橋君は裏表が区別できる $ N $ 枚のコインを持っている。コインの大きさは異なり、それぞれのコインには $ 1 $ つずつ正の整数が書かれている。

これらのコインを無作為に ($ N! $ 通りの組み合わせがすべて同じ確率で出てくるように) 一列に並べる。その後、以下の手順を実行する。

1. すべてのコインを表向きにする。
2. 左端のコインから順に、現在見ているコインよりも右側 (それ自身を除く) にあるコインのうち、現在見ているコインに書かれている整数の倍数が書かれているコインすべての裏表をひっくり返す。

高橋君はこの操作を終了した後に表を向いているコインの枚数の期待値が知りたい。

あなたは高橋くんの代わりに、期待値を計算するプログラムを作成してほしい。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ C_1 $ $ C_2 $ : $ C_N $

- $ 1 $ 行目には、コインの枚数を表す整数 $ N\ (1\ ≦\ N\ ≦\ 100) $ が与えられる。
- $ 2 $ 行目から $ N $ 行のうち $ i\ (1\ ≦\ i\ ≦\ N) $ 行目には、$ i $ 番目に大きいコインに書かれている整数 $ C_i\ (1\ ≦\ C_i\ ≦\ 10^9) $ が書かれている。

## 输出格式

表を向いているコインの枚数の期待値を出力せよ。絶対誤差または相対誤差が $ 10^{-6} $ 以下であれば許容される。出力の末尾にも改行を入れること。

## 说明/提示

### 部分点

この問題には部分点が設定されている。

- $ N\ ≦\ 8 $ を満たすデータセット $ 1 $ に正解した場合は、$ 99 $ 点が与えられる。
- 追加制約のないデータセット $ 2 $ に正解した場合は、さらに $ 1 $ 点が与えられ、合計で $ 100 $ 点が得られる。

### Sample Explanation 1

コインには、サイズの小さい方から順にそれぞれ $ 2 $ , $ 4 $ , $ 8 $ という数が書かれています。例えば、$ 3! $ 通りの並べ方のうち、コインが大きさの昇順に並んでいる場合は、以下の手順が行われることになります。 1. 初期状態で、すべてのコインを表に向けるので、コインは左から順に、\\\[`表`, `表`, `表`\\\] となっています。 2. 次に、左から $ 2 $ 番目以降のコインの中で、$ 2 $ の倍数が書かれたコインを探します。左から $ 2 $ 番目のコインと左から $ 3 $ 番目のコインが該当するので、これらのコインを裏返します。その結果、コインは左から順に \\\[`表`, `裏`, `裏`\\\] となります。 3. 次に、左から $ 3 $ 番目以降のコインの中で、$ 4 $ の倍数が書かれたコインを探します。左から $ 3 $ 番目のコインのみが該当するので、このコインを裏返します。その結果、コインは左から順に \\\[`表`, `裏`, `表`\\\] となります。 コインの裏表は下図のように変化します。この図において、白いコインは表向きのコイン、黒いコインは裏向きのコインで表してあります。 !\[\](http://abc008.contest.atcoder.jp/img/abc/008/3-1.png)このように、$ 3!\ =\ 6 $ 通りの並べ方について、それぞれの並べ方での最終状態は下図のようになります。 !\[\](http://abc008.contest.atcoder.jp/img/abc/008/3-2.png)以上より期待値は $ 13/6\ =\ 2.16666666666... $ となります。

### Sample Explanation 2

どのような順番で並べても、左から順に、\\\[`表`, `裏`, `表`, `裏`\\\] となります。

## 样例 #1

### 输入

```
3

2

4

8
```

### 输出

```
2.166666666667
```

## 样例 #2

### 输入

```
4

5

5

5

5
```

### 输出

```
2.000000000000
```

## 样例 #3

### 输入

```
5

2

3

2

6

12
```

### 输出

```
3.100000000000
```



---

---
title: "[ABC011D] 大ジャンプ"
layout: "post"
diff: 普及+/提高
pid: AT_abc011_4
tag: []
---

# [ABC011D] 大ジャンプ

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc011/tasks/abc011_4

$ XY $ 座標上に、スタート地点とゴール地点が $ 1 $ つずつあります。 スタート地点は $ (0,\ 0) $ にあり、ゴール地点は $ (X,\ Y) $ です。

あなたは、ジャンプという移動法を用いて、移動を行います。 ジャンプを $ 1 $ 回行うと、あなたは、以下の $ 4 $ つのうち、ランダムで選ばれた $ 1 $ つの移動が行われます。

- $ X $ 軸に平行に $ +D $ だけ移動する。
- $ X $ 軸に平行に $ -D $ だけ移動する。
- $ Y $ 軸に平行に $ +D $ だけ移動する。
- $ Y $ 軸に平行に $ -D $ だけ移動する。

これらの移動は、どれもちょうど $ 1/4 $ の確率で選択されます。

あなたは、最初にスタート地点におり、ちょうど $ N $ 回のジャンプでゴール地点にたどり着きたいです。

目的を達成できる確率を出力しなさい。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ D $ $ X $ $ Y $

- $ 1 $ 行目には、ジャンプする回数を表す整数 $ N\ (1\ ≦\ N\ ≦\ 1,000) $ と、ジャンプの距離 $ D\ (1\ ≦\ D\ ≦\ 10^9) $ が、スペース区切りで与えられる。
- $ 2 $ 行目には、ゴール地点の座標を表す整数 $ X,\ Y\ (-10^9\ ≦\ X,\ Y\ ≦\ 10^9) $ が、スペース区切りで与えられる。

## 输出格式

あなたが最終的にゴール地点にたどり着ける確率を $ 1 $ 行で出力せよ。出力の末尾にも改行をいれること。

なお、想定解答との絶対誤差または相対誤差が、$ 10^{-9} $ 以下であれば、正解として扱われる。

## 说明/提示

### 部分点

$ 1\ ≦\ N\ ≦\ 8 $ のケースに全て正解すると、部分点として $ 90 $ 点が与えられる。

$ 1\ ≦\ N\ ≦\ 30 $ のケースに全て正解すると、追加で $ 10 $ 点が与えられる。

全てのケースに正解すると、ボーナス点として $ 1 $ 点が与えられる。

### Sample Explanation 1

$ (0,\ 0) $ から $ 2 $ 回のジャンプで $ (10000000,\ 10000000) $ へ飛ぶ確率は、 $ 1/8 $ です。

### Sample Explanation 2

偶数の距離のジャンプでは、奇数の座標にたどり着くことはできないため、到達する確率は $ 0 $ となります。

## 样例 #1

### 输入

```
2 10000000

10000000 10000000
```

### 输出

```
0.125
```

## 样例 #2

### 输入

```
100 2

3 7
```

### 输出

```
0.0
```

## 样例 #3

### 输入

```
11 8562174

25686522 17124348
```

### 输出

```
0.018174648284912
```



---

---
title: "[ABC013C] 節制"
layout: "post"
diff: 普及+/提高
pid: AT_abc013_3
tag: []
---

# [ABC013C] 節制

## 题目描述

安全意识很高的高桥君买了最好的锁，然而他的钱包因此出现了一场金钱危机

高桥君领工资的时间不稳定，下一次领工资的时间是从现在开始N日后，于是高桥君在N天内开始尽量抑制伙食费，过起了节约的生活。

首先，高桥的饱食度是H，对于N天中的每一天高桥君可以选择下列三种饮食中的一种：

· 普通的饮食：支付A日元的费用，增加B点饱食度

· 朴素的饮食：支出C日元，增加D饱食度

· 不吃饭：不支出费用，但是高桥君的肚子饿极了，会降低E点饱食度

对于以上饮食方案，C<A，D<B

如果严格节约的话，可以减少支出，但是如果太节约了，高桥君的身体就会不舒服，所以N天内每一天的饱食度都不能降到0以下

高桥君有超人级的胃袋，其饱食度是没有上限的，也就是说，无论怎么吃，高桥君的饱食度都不会达到最大值

现在请你回答高桥君最低能用多少日元的伙食费坚持这N天呢？

## 输入格式

输入按以下标准提供

第一行输入表示节约生活天数的整数N（1<=N<=5e5），表示节约生活开始前高桥的饱食度的整数H（1<=H<=1e9），中间以空格分开

第二行输入表示3种饮食的信息的整数A、B、C、D、E，中间以空格分开

对于支出，保证1<=C<A<=1e6

对于饱食度的增减，保证1<=D<B<=1e6，1<=E<=1e6

## 输出格式

一行，输出在饱食度不小于0的情况下，高桥君度过N天所需的最少伙食费

输出末尾添加换行符

## 说明/提示

对于10%的数据，N<=10

对于50%的数据，N<=50，H<=50，B<=50，D<=50

对于100%的数据，N<=1000

对于数据，请勿使用32位整形（取自原题面）

Translated by @权御天下

## 样例 #1

### 输入

```
4 5

100 4 60 1 4
```

### 输出

```
160
```

## 样例 #2

### 输入

```
10 1

5000 2 2000 1 300
```

### 输出

```
20000
```

## 样例 #3

### 输入

```
9 23

170 8 120 5 12
```

### 输出

```
650
```

## 样例 #4

### 输入

```
653 314159

6728 123456 5141 41928 222222
```

### 输出

```
2818162
```



---

---
title: "[ABC013D] 阿弥陀"
layout: "post"
diff: 普及+/提高
pid: AT_abc013_4
tag: []
---

# [ABC013D] 阿弥陀

## 题目描述

你知道从古至今传承下来的日本传统抽签方法——鬼脚图（日语：阿弥陀籤/あみだくじ）吗？

进行鬼脚图时，首先画出 $N$ 条平行的竖线。接着，在这些竖线之间画 $M$ 条横线。每条横线必须连接相邻的两条竖线，且不能有两条或更多的横线在完全相同的高度上。假设从上往下数的第 $i$ 条横线连接了从左往右数的第 $A_i$ ($1\le A_i < N$) 条竖线和第 $A_i + 1$ 条竖线。

以下是 $N = 5,M = 7,A = \{1,4,3,4,2,3,1\}$ 情况下的鬼脚图示例。抽签时，从某条竖线的顶部出发，沿着线向下走。当遇到横线时，必须转弯，且不能回头向上。例如，在这个鬼脚图中，从左往右数第 $4$ 条竖线顶部开始，最终会到达左边数第 $3$ 条竖线的底部。

![](https://cdn.luogu.com.cn/upload/vjudge_pic/AT_abc013_4/287d97cea4ffe55ad2fe3822a307197d29129150.png)

以上是普通的鬼脚图。然而，在“大数据”这一术语流行的当下，鬼脚图若想在未来继续存在下去，也需要“大”起来，以迎战“大数据”。

因此，我们考虑通过将多个鬼脚图**纵向连接 $D$ 次**，构造一个巨大的鬼脚图。例如，将上面提到的鬼脚图纵向连接 $2$ 次，可以得到如下示例。在这种情况下，从左边数第 $4$ 条竖线顶部开始抽签，最终会到达左边数第 $5$ 条竖线的底部。

![](https://cdn.luogu.com.cn/upload/vjudge_pic/AT_abc013_4/ff270a32cd6de8309812dd03feb2e11021ca985c.png)

虽然我们构造了如此巨大的鬼脚图，但如果无法高效计算抽签的结果，这个巨大的鬼脚图也不过是徒有其表的涂鸦。因此，请编写一个程序，对于满足 $1\le k\le N$ 的每个整数 $k$，计算在巨大鬼脚图中，从左边数第 $k$ 条竖线顶部开始抽签，最终会到达左边数第几条竖线底部。

## 输入格式

输入以以下格式通过标准输入提供：

> $N$ $M$ $D$ $A_1$ $A_2$ $\cdots$ $A_M$

- 第 1 行包含 $3$ 个整数，表示初始鬼脚图的竖线数量 $N$（$2\le N\le 10^5$）、横线数量 $M$（$0\le M\le 2 \times 10^5$）、以及将初始鬼脚图纵向连接的次数 $D$（$1\le D\le 10^9$）。
- 第 2 行包含 $M$ 个整数 $A_1, A_2, \cdots, A_M$（$1\le A_i < N$），表示每条横线的连接信息。

## 输出格式

输出 $N$ 行，第 $k$ 行输出一个整数，表示在巨大鬼脚图中，从左边数第 $k$ 条竖线顶部开始抽签，最终会到达左边数第几条竖线底部。

输出的末尾需包含换行符。

### 部分分

测试样例分为 4 组，分别有如下限制条件及分数：

1. 第一组：$D = 1$，全部正确可得 $10$ 分。
2. 第二组：$N\le 1000$ 且 $D\le 1000$，全部正确可得 $20$ 分。
3. 第三组：$N\le 8$，全部正确可得 $20$ 分。
4. 第四组：无额外限制条件，全部正确可得 $50$ 分。

题面译自 [D - 阿弥陀](https://atcoder.jp/contests/abc013/tasks/abc013_4)。翻译来自于 [ChatGPT](https://chatgpt.com) 并进行人工校对，若有误请联系 [rui_er](https://www.luogu.com.cn/user/122461)。

## 样例 #1

### 输入

```
5 7 1

1 4 3 4 2 3 1
```

### 输出

```
4

2

5

3

1
```

## 样例 #2

### 输入

```
5 7 2

1 4 3 4 2 3 1
```

### 输出

```
3

2

1

5

4
```

## 样例 #3

### 输入

```
10 20 300

9 1 2 5 8 1 9 3 5 6 4 5 4 6 8 3 2 7 9 6
```

### 输出

```
3

7

2

4

5

9

6

1

8

10
```



---

---
title: "[ABC014D] 閉路"
layout: "post"
diff: 普及+/提高
pid: AT_abc014_4
tag: []
---

# [ABC014D] 閉路

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc014/tasks/abc014_4

$ n $ 個の頂点と $ n-1 $ 本の辺からなる連結な無向グラフが与えられます．それぞれの頂点には $ 1 $ から $ n $ までの番号が順番にふられています．

グラフ理論において，このような条件を満たすグラフは木と呼ばれ，閉路を含まないという性質があります． このグラフに対し，元のグラフに含まれない追加辺 $ (a,b) $ を1つ追加したグラフについて考えてみると，このグラフはちょうど1つの閉路を含みます． あなたの仕事は，そのようなグラフについて，閉路の長さ(閉路に含まれる辺の数)を出力することです．ただ，追加辺の候補はいくつかあり，$ Q $ 個与えられるので，それら全ての候補について答えを出力してください．

## 输入格式

入力は以下の形式で標準入力から与えられる．

> $ N $ $ x_1\ y_1 $ $ x_2\ y_2 $ ： $ x_{N-1}\ y_{N-1} $ $ Q $ $ a_1\ b_1 $ $ a_2\ b_2 $ ： $ a_{Q}\ b_{Q} $

- $ 1 $ 行目には，グラフの頂点数を表す整数 $ N\ (1≦N≦100,000) $ が与えられる．
- 続く$ 2 $ 行目から$ N-1 $行は，グラフの辺情報を表す．$ i $番目の行には，辺が結ぶ頂点 $ x_i $ と $ y_i $が空白区切りで与えられる．
- 続く$ 1+N $ 行目には，辺$ (a,b) $の候補の数を表す整数 $ Q\ (1≦Q≦100,000) $ が与えられる．
- 続く$ 2+N $ 行目から$ Q $行は，$ i $番目の追加辺候補の情報を表す．$ i $ 番目の行には，追加辺が結ぶ頂点 $ a_i $ と $ b_i $が空白区切りで与えられる．
- 与えられる辺は全て，存在する頂点を結んでいる．
- グラフは自己辺を含まない．つまり，任意の$ i $について，$ x_i≠y_i $が成り立つ．
- グラフは多重辺を含まない．つまり，任意の$ i,j(i≠j) $について，$ x_i≠x_j $もしくは$ y_i≠y_j $が成り立つ．
- 追加辺は，元のグラフに含まれない辺であり自己辺でないことが保障されている．

## 输出格式

全ての追加辺候補について，それを元のグラフに追加したときにできる閉路の長さを，$ 1 $ 行目から $ Q $ 行順番に出力せよ．出力の末尾に改行を入れること．

## 说明/提示

### 部分点

この問題には2つのデータセットがあり，データセット毎に部分点が設定されている．

- $ Q=1 $ を満たすデータセット 1 に正解した場合は $ 30 $ 点が与えられる．
- 追加制約のないデータセット 2 に正解した場合は，上記のデータセットとは別に $ 70 $ 点が与えられる．

### Sample Explanation 1

図は以下の通りです．
![](https://atcoder.jp/img/abc/014/d1.png)

## 样例 #1

### 输入

```
5

1 2

1 3

1 4

4 5

3

2 3

2 5

2 4
```

### 输出

```
3

4

3
```

## 样例 #2

### 输入

```
6

1 2

2 3

3 4

4 5

5 6

4

1 3

1 4

1 5

1 6
```

### 输出

```
3

4

5

6
```

## 样例 #3

### 输入

```
7

3 1

2 1

2 4

2 5

3 6

3 7

5

4 5

1 6

5 6

4 7

5 3
```

### 输出

```
3

3

5

5

4
```



---

---
title: "[ABC015D] 高橋くんの苦悩"
layout: "post"
diff: 普及+/提高
pid: AT_abc015_4
tag: []
---

# [ABC015D] 高橋くんの苦悩

## 题目描述

# 题目大意

你有 $N$ 个物品，第 $i$ 个物品的重量为 $A_i$ ，体积为 $1$ ，价值为 $B_i$ ，你还有一个背包，背包的容积为 $K$ ，所能承受的最大重量为 $W$ ，现在你要将一些物品放入背包中，求放入背包的物品的最大价值。

## 输入格式

输入共三行。

第一行输入一个数 $W(1\le W\le10000)$ ，表示背包所能承受的最大重量。

第二行输入两个数 $N,K(1\le K\le N\le50)$ ，表示物品的数量和背包的容积。

剩下的 $n$ 行分别输入两个数 $A_i,B_i(1\le A_i\le1000,1\le B_i\le100)$ ，表示第 $i$ 个物品的重量和价值。

## 输出格式

一个数 $ans$ ，表示放入背包的物品的最大价值。

## 样例 #1

### 输入

```
10

3 2

4 20

3 40

6 100
```

### 输出

```
140
```

## 样例 #2

### 输入

```
10

5 4

9 10

3 7

3 1

2 6

4 5
```

### 输出

```
18
```

## 样例 #3

### 输入

```
22

5 3

5 40

8 50

3 60

4 70

6 80
```

### 输出

```
210
```



---

---
title: "[ABC017C] ハイスコア"
layout: "post"
diff: 普及+/提高
pid: AT_abc017_3
tag: []
---

# [ABC017C] ハイスコア

## 题目描述

### 题意 

高桥君非常喜欢打电动。

现在他在玩的这个游戏中有 $N$ 个遗迹，你可以按照你喜欢的顺序去探索这些遗迹（不一定都要探索）。在探索遗迹的过程中会获得宝石，游戏中一共有 $M$ 种宝石。

当你探索过第 $i(1\le i \le N)$ 个遗迹后，你的得分将增加 $s_i$，同时，你将得到所有种类编号在 $l_i$ 到 $r_i$ 之间的宝石各一个，但是再一次探索同一个遗迹的话，你将什么都无法得到。

获得的宝石无法被丢弃，当所有种类的宝石都获得之后，会复活魔王导致得分清零且不再能得分。

高桥君想要得到尽可能高的分数，请求出在不复活魔王的情况下，可以得到的分数最高能是多少。

## 输入格式

输入是由标准输入提供的，格式如下：

```
N M
l1 r1 s1
l2 r2 s2
:
lN rN sN
```

## 输出格式

一行一个整数，表示你的答案。**注意在最后输出一个换行**。

## 说明/提示

- $1\le N \le 10^5$
- $1\le M \le 10^5$
- $1\le l_i,r_i \le M$
- $1\le s_i \le 5\times 10^3$
- 所有读入的数值都是整数。

---

## 样例 #1

### 输入

```
4 6

1 3 30

2 3 40

3 6 25

6 6 10
```

### 输出

```
80
```

## 样例 #2

### 输入

```
2 7

1 3 90

5 7 90
```

### 输出

```
180
```

## 样例 #3

### 输入

```
1 4

1 4 70
```

### 输出

```
0
```



---

---
title: "[ABC018C] 菱型カウント"
layout: "post"
diff: 普及+/提高
pid: AT_abc018_3
tag: []
---

# [ABC018C] 菱型カウント

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc018/tasks/abc018_3

縦 $ R $ 行、横 $ C $ 列の長方形領域がある。上から $ i\ (1\ ≦\ i\ ≦\ R) $ 行目、左から $ j\ (1\ ≦\ j\ ≦\ C) $ 列目にあるマスをマス ($ i $, $ j $) と呼ぶことにする。これらのマスのうちいくつかのマスは黒く、他のマスは白く塗られている。

また、ある整数 $ K $ が定められている。

ここで、以下の条件を満たすように新たに緑色を塗ることを考える。この操作は1 回だけ行う。

- ある整数 の組 $ x\ (K\ ≦\ x\ ≦\ R\ -\ K\ +\ 1) $, $ y\ (K\ ≦\ y\ ≦\ C\ -\ K\ +\ 1) $ に対して、|$ i-x $|+|$ j-y $|$ ≦\ K\ -\ 1 $ を満たすすべてのマス ($ i $,$ j $) について、マス ($ i $,$ j $) は元々白いマスで、かつ、この操作で緑色に塗られる。さらに、|$ i-x $|+|$ j-y $|$ ≧\ K $ を満たすすべてのマスについて、そのマスは緑色に塗らない。

このような色の塗り方の総数はいくらか。ただし、ここでいう塗り方とは、どのマスがどの色になったかという組み合わせのことで、色の塗る順番は考慮しないものとする。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ R $ $ C $ $ K $ $ s_1 $ $ s_2 $ : $ s_R $

- $ 1 $ 行目には、$ 3 $ つの整数 $ R\ (3\ ≦\ R\ ≦\ 500) $, $ C\ (3\ ≦\ C\ ≦\ 500) $, $ K\ (2\ ≦\ K\ ≦\ 500) $ が空白区切りで書かれている。これは、長方形領域が縦 $ R $ 行、横 $ C $ 列あることを表す。$ K $ は文中で定められた整数である。
- $ 2 $ 行目から $ R $ 行には、マスに関する情報が与えられる。$ R $ 行のうち $ i\ (1\ ≦\ i\ ≦\ R) $ 行目には、長さ $ C $ の文字列 $ s_i $ が与えられる。文字列 $ s_i $ は `o`, `x` の $ 2 $ 種類の文字でのみ構成されており、$ s_i $ の左から $ j\ (1\ ≦\ j\ ≦\ C) $ 文字目の文字が `o` ならマス ($ i $,$ j $) が白いマスであることを、`x` ならマス ($ i $,$ j $) が黒いマスであることを表す。

## 输出格式

緑色の塗り方の総数を $ 1 $ 行に出力せよ。出力の末尾に改行を入れること。

## 说明/提示

### 部分点

この問題には部分点が設定されている。

- $ R\ ≦\ 50 $ かつ $ C\ ≦\ 50 $ を満たすデータセット $ 1 $ に正解した場合は、$ 30 $ 点が与えられる。

### Sample Explanation 1

以下の $ 3 $ 通りが考えられます (`o` は白いマス、`x` は黒いマス、`\*` は緑色のマスを表します)。 x\\\*ooo\\\*\\\*\\\*oxo\\\*ooooxxoo xo\\\*ooo\\\*\\\*\\\*xoo\\\*oooxxoo xooooooo\\\*xoo\\\*\\\*\\\*oxx\\\*o

## 样例 #1

### 输入

```
4 5 2

xoooo

oooox

ooooo

oxxoo
```

### 输出

```
3
```

## 样例 #2

### 输入

```
4 5 2

ooooo

oxoox

oooox

oxxoo
```

### 输出

```
0
```

## 样例 #3

### 输入

```
8 6 3

oooooo

oooooo

oooooo

oooooo

oxoooo

oooooo

oooooo

oooooo
```

### 输出

```
4
```



---

---
title: "[ABC018D] バレンタインデー"
layout: "post"
diff: 普及+/提高
pid: AT_abc018_4
tag: []
---

# [ABC018D] バレンタインデー

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc018/tasks/abc018_4

あるクラスには女子が $ N $ 人、男子が $ M $ 人いる。女子には $ 1 $ から $ N $ までの出席番号が、男子には $ 1 $ から $ M $ までの出席番号が割り当てられている。

幸運のキューピットはここから女子 $ P $ 人と男子 $ Q $ 人からなる、1 つの旅行グループを作る。

$ N $ 人の女子は合わせて $ R $ 個のチョコレートを持っており、チョコレートには $ 1 $ から $ R $ までの番号が付けられている。

チョコレート $ i\ (1\ ≦\ i\ ≦\ R) $ は出席番号が $ x_i $ である女子が持っており、旅行中に出席番号が $ y_i $ である男子に渡す予定である。そのため旅行グループに出席番号が $ x_i $ である女子と出席番号が $ y_i $ である男子が両方含まれていた場合に限り渡すことができる。無事にチョコレート $ i $ が渡された場合の幸福度は $ z_i $ である。

無事に渡されたチョコレートによる幸福度の合計値として考えられる最大値はいくらか。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ M $ $ P $ $ Q $ $ R $ $ x_1 $ $ y_1 $ $ z_1 $ $ x_2 $ $ y_2 $ $ z_2 $ : $ x_R $ $ y_R $ $ z_R $

- $ 1 $ 行目には、$ 5 $ つの整数 $ N\ (1\ ≦\ N\ ≦\ 18) $, $ M\ (1\ ≦\ M\ ≦\ 18) $, $ P\ (1\ ≦\ P\ ≦\ N) $, $ Q\ (1\ ≦\ Q\ ≦\ M) $, $ R\ (1\ ≦\ R\ ≦\ N×M) $ が空白区切りで書かれている。これは、クラスに女子が $ N $ 人、男子が $ M $ 人おり、旅行グループは女子 $ P $ 人、男子 $ Q $ 人からなり、チョコレートが $ R $ 個あることを表す。
- $ 2 $ 行目から $ R $ 行には、チョコレートに関する情報が与えられる。$ R $ 行のうち $ i\ (1\ ≦\ i\ ≦\ R) $ 行目には、$ 3 $ つの整数 $ x_i\ (1\ ≦\ x_i\ ≦\ N) $, $ y_i\ (1\ ≦\ y_i\ ≦\ M) $, $ z_i\ (1\ ≦\ z_i\ ≦\ 10,000) $ が空白区切りで与えられる。これは、チョコレート $ i $ を出席番号が $ x_i $ である女子が持っており、旅行中に出席番号が $ y_i $ である男子に渡す予定であり、チョコレート $ i $ の幸福度が $ z_i $ であることを表す。
- $ 1\ ≦\ i\ ＜\ j\ ≦\ R $ である整数 $ i $,$ j $ に対して、$ x_i≠x_j $ または $ y_i≠y_j $ が成り立つ。

## 输出格式

無事に渡されたチョコレートによる幸福度の合計値として考えられる最大値を $ 1 $ 行に出力せよ。(21:51 表現の変更)出力の末尾に改行を入れること。

## 说明/提示

### 部分点

この問題には部分点が設定されている。

- $ N\ ≦\ 8 $ かつ $ M\ ≦\ 8 $ を満たすデータセット $ 1 $ に正解した場合は、$ 30 $ 点が与えられる。

### Sample Explanation 1

出席番号が $ 1 $, $ 2 $ の女子と出席番号が $ 2 $, $ 3 $, $ 4 $ の男子からなる旅行グループを考えます。 - チョコレート $ 1 $ は出席番号が $ 1 $ の男子が旅行に参加しないため、渡されません。 - チョコレート $ 2 $ は受け渡しする男女がともに旅行に参加するため、無事に渡されます。チョコレートの幸福度は $ 7 $ です。 - チョコレート $ 3 $ は受け渡しする男女がともに旅行に参加するため、無事に渡されます。チョコレートの幸福度は $ 15 $ です。 - チョコレート $ 4 $ は受け渡しする男女がともに旅行に参加するため、無事に渡されます。チョコレートの幸福度は $ 6 $ です。 - チョコレート $ 5 $ は受け渡しする男女がともに旅行に参加するため、無事に渡されます。チョコレートの幸福度は $ 3 $ です。 - チョコレート $ 6 $ は受け渡しする男女がともに旅行に参加するため、無事に渡されます。チョコレートの幸福度は $ 6 $ です。 - チョコレート $ 7 $ は出席番号が $ 3 $ の女子が旅行に参加しないため、渡されません。 幸福度の合計値は $ 7\ +\ 15\ +\ 6\ +\ 3\ +\ 6\ =\ 37 $ となり、これが最大値となります。

## 样例 #1

### 输入

```
3 4 2 3 7

1 1 9

1 2 7

1 3 15

1 4 6

2 2 3

2 4 6

3 3 6
```

### 输出

```
37
```

## 样例 #2

### 输入

```
4 5 3 2 9

2 3 5

3 1 4

2 2 2

4 1 9

3 5 3

3 3 8

1 4 5

1 5 7

2 4 8
```

### 输出

```
26
```



---

---
title: "[ABC020C] 壁抜け"
layout: "post"
diff: 普及+/提高
pid: AT_abc020_c
tag: []
---

# [ABC020C] 壁抜け

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc020/tasks/abc020_c

正方形のマスが縦 $ H $ 行、横 $ W $ 列に並んでいます。各マスは白または黒で塗られており、白マスのうち $ 2 $ つがそれぞれスタート地点とゴール地点として指定されています。

高橋君はスタート地点から出発して $ T $ 秒以内にゴール地点に到着したいです。高橋君は、各マスから上下左右に隣接する別のマスに移動することができます。このとき、移動先が白マスであれば $ 1 $ 秒、黒マスであれば $ x $ 秒の時間がかかります（移動前のマスの色は移動時間に影響しません）。ここで、 $ x $ の値は高橋君がスタート地点から出発する前にあなたに選んでもらいます。 $ x $ の値は正整数でなければならず、高橋君の出発後に値を変更することはできません。

高橋君が $ T $ 秒以内にゴール地点に到着することが可能であるような正整数 $ x $ の最大値を求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ H $ $ W $ $ T $ $ s_{1,1} $$ s_{1,2} $ .. $ s_{1,W} $ $ s_{2,1} $$ s_{2,2} $ .. $ s_{2,W} $ : $ s_{H,1} $$ s_{H,2} $ .. $ s_{H,W} $

- $ 1 $ 行目には、 $ 3 $ 個の整数 $ H, $ $ W, $ $ T $ ($ 2 $ $ ≦ $ $ H, $ $ W $ $ ≦ $ $ 10, $ $ 2 $ $ ≦ $ $ T $ $ ≦ $ $ 10^9 $) が与えられる。これらはそれぞれ、マスの行数と列数、および高橋君の目標時間を表す。
- $ 2 $ 行目から $ H\ +\ 1 $ 行目には、各マスの情報が与えられる。 $ i\ +\ 1 $ 行目の $ j $ 文字目 $ s_{i,j} $ が $ i $ 行 $ j $ 列目のマスに対応する。各文字の意味は以下の通り： 
  - `.` : スタート地点にもゴール地点にも指定されていない白マス
  - `S` : スタート地点として指定された白マス
  - `G` : ゴール地点として指定された白マス
  - `#` : 黒マス
   
   これら以外の文字は $ s_{i,j} $ として出現せず、 `S` および `G` はそれぞれちょうど $ 1 $ 個ずつ出現する。また、入力では求める最大値が存在することが保証される。すなわち、少なくとも $ 1 $ 度は黒マスに移動しなければスタート地点から出発してゴール地点に到着できないこと、および $ x\ =\ 1 $ のとき $ T $ 秒以内にゴール地点に到着することが可能であることが保証される。

## 输出格式

標準出力に、 高橋君が $ T $ 秒以内にゴール地点に到着することが可能であるような正整数 $ x $ の最大値を出力せよ。

末尾の改行を忘れないこと。

## 说明/提示

### 部分点

この問題には部分点が設定されている。

- $ 40 $ 点分のテストケースは $ 2 $ $ ≦ $ $ H, $ $ W $ $ ≦ $ $ 3, $ $ 2 $ $ ≦ $ $ T $ $ ≦ $ $ 30 $ を満たす。
- 別の $ 30 $ 点分のテストケースは $ 2 $ $ ≦ $ $ T $ $ ≦ $ $ 30 $ を満たす。

（※ 問題 D にも部分点が設定されています。そちらもご確認ください。）

### Sample Explanation 1

$ i $ 行 $ j $ 列目のマスを $ (i,\ j) $ で表します。 $ x\ =\ 8 $ のとき、 $ (1,\ 1)\ →\ (2,\ 1)\ →\ (2,\ 2)\ →\ (2,\ 3) $ と移動すると $ 1\ +\ 8\ +\ 1\ =\ 10 $ 秒でゴール地点に到着することができます。 $ x\ \geq\ 9 $ のとき、 $ 10 $ 秒以内にゴール地点に到着することはできません。

### Sample Explanation 2

スタート地点から右に直進すると $ 2x\ +\ 1 $ 秒でゴール地点に到達できます。遠回りすることで黒マスへの移動回数を減らすことができますが、 $ x $ の値によってはかえって時間がかかってしまいます。

## 样例 #1

### 输入

```
2 3 10

S##

.#G
```

### 输出

```
8
```

## 样例 #2

### 输入

```
3 4 7

S##G

.##.

..#.
```

### 输出

```
3
```

## 样例 #3

### 输入

```
4 4 1000000000

S###

####

####

###G
```

### 输出

```
199999999
```



---

---
title: "[ABC021D] 多重ループ"
layout: "post"
diff: 普及+/提高
pid: AT_abc021_d
tag: []
---

# [ABC021D] 多重ループ

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc021/tasks/abc021_d

新入社員の高橋君は、とある企業の新人プログラマーとして部署に配属されました。 高橋君が担当した初めての仕事は、以下の擬似コードで表されるプログラムを高速化するというものでした。

 ```

n←(標準入力)
ans←0
for i=1..n
  for j=i..n
    ans ← ans+1
ansの値を表示
```

高橋君にかかってしまえばこんな仕事はお茶の子さいさいです。 各 $ i $ に対する内側のループ回数を考えて総和の公式を用いれば $ ans=n+n-1+…+1=n(n+1)/2 $ となり、これを用いればすぐ答えが出せます。

劇的な高速化に成功した高橋君への部署からの期待は鰻登りです。そこで、上司は彼に更なる仕事を与えることにしました。

その仕事内容は、以下のような for ループのネストの深さが $ k $ の場合におけるプログラムの高速化です。

 ```

n←(標準入力)
k←(標準入力)
ans←0
for a_1=1..n
  for a_2=a_1..n
    for a_3=a_2..n
      …
      for a_k=a_{k-1}..n // a_0=1とする
        ans ← ans+1
ansの値を表示
```

さすがの高橋君もこれには少し悩みました。総和の公式が使えないからです。

いろいろ考えてみたところ、このプログラムの出力する答えは $ 1≦a_1≦a_2≦…≦a_k≦n $ であるような整数の組 $ (a_1,a_2,…,a_k) $ の個数に等しいということに気づきました。 しかし、彼はそのようなものの個数を数える方法を思いつきませんでした。

彼の同僚であるあなたは、彼の代わりにこの課題をこなすプログラムを作ってあげることにしました。 ただし、答えは非常に大きくなることがあるので、ans の代わりに ans を $ 1,000,000,007(=10^9+7) $ で割った余りを出力してください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ n $ $ k $

- $ 1 $ 行目には、整数 $ n\ (1\ ≦\ n\ ≦\ 10^5) $ が与えられる。
- $ 2 $ 行目には、整数 $ k\ (1\ ≦\ k\ ≦\ 10^5) $ が与えられる。

## 输出格式

$ 1 $ 行目に、$ 2 $ つ目のプログラムにおける最終的な ans の値を $ 1,000,000,007 $ で割った余りを出力してください。

末尾の改行を忘れないこと。

## 说明/提示

### 部分点

この問題には部分点が設定されている。

- $ 1≦n≦1000 $ かつ $ 1≦k≦1000 $ であるようなデータセットに正解した場合は $ 99 $ 点が得られる。
- 上記のデータセットを含む全てのデータセットに正解した場合はさらに $ 1 $ 点が得られる。

## 样例 #1

### 输入

```
10

2
```

### 输出

```
55
```

## 样例 #2

### 输入

```
10

3
```

### 输出

```
220
```

## 样例 #3

### 输入

```
10

4
```

### 输出

```
715
```

## 样例 #4

### 输入

```
400

296
```

### 输出

```
546898535
```

## 样例 #5

### 输入

```
100000

100000
```

### 输出

```
939733670
```



---

---
title: "[ABC022C] Blue Bird"
layout: "post"
diff: 普及+/提高
pid: AT_abc022_c
tag: []
---

# [ABC022C] Blue Bird

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc022/tasks/abc022_c

高橋君の住む街には $ N $ 個の家と $ M $ 個の道があります。 家は $ 1 $ ～ $ N $ の整数によって番号付けされています。 高橋君は家 $ 1 $ に住んでいます。 道も $ 1 $ ～ $ M $ の整数によって番号付けされています。 $ i $ 番目の道は家 $ u_i $ と 家 $ v_i $ を双方向につなぐ長さ $ l_i $ メートルの道です。

高橋君は街のどこかの家に居るという「幸せの青い鳥」を探しています。 実は、「幸せの青い鳥」は高橋くんの家にいて、高橋君もそのことを知っています。 しかし、形だけでも探す旅に出ないと盛り上がりに欠けて面白くないので、仕方なく旅の計画をたてることにしました。

高橋君は自分の家から開始して、同じ道を二度以上通らないようにいくつかの家に訪れ、最後に自分の家に戻ってくる、という旅の計画をたてる予定です。 このとき盛り上がりを作るために、旅の途中で自分の家以外の家を少なくとも $ 1 $ 軒訪れる予定です。 高橋君はこの茶番をできるだけ早く終わらせたいので、通る道の長さの総和が最も小さくなるような計画が最適だと考えています。

高橋君の住む街の家と道の情報が与えられるので、高橋君が上の条件のもとで最適な計画をたてることができるかどうかを求めてください。 もし最適な計画をたてることができるならば、そのとき通る道の長さの総和を求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる

> $ N $ $ M $ $ u_1 $ $ v_1 $ $ l_1 $ $ u_2 $ $ v_2 $ $ l_2 $ : $ u_M $ $ v_M $ $ l_M $

- $ 1 $ 行目には高橋君の住む街にある家の個数 $ N(3\ ≦\ N\ ≦\ 300) $ と 道の本数 $ M(3\ ≦\ M\ ≦\ N(N-1)/2) $ が空白区切りで与えられる。
- $ 2 $ 行目からの $ M $ 行のうち $ i $ 行目には $ i $ 番目の道路が結ぶ家の番号 $ u_i,\ v_i(1\ ≦\ u_i\ ＜\ v_i\ ≦\ N) $ とその長さを表す整数 $ l_i(1\ ≦\ l_i\ ≦\ 10^5) $ が空白区切りで与えられる。
- $ i\ ≠\ j $ ならば $ u_i\ ≠\ u_j $ または $ v_i\ ≠\ v_j $ の少なくとも一方が成り立つ。

## 输出格式

最適な計画をたてることができないならば $ -1 $ を、できるならばそのとき通る道の長さの総和を $ 1 $ 行に出力せよ。出力の末尾にも改行を入れること。

## 说明/提示

### Sample Explanation 1

家と道の様子は以下のようになります !\[\](/img/abc/022/ajfsieojafioes/C\_sample1.png) $ 1,\ 2,\ 5,\ 3,\ 4,\ 1 $ という順番に訪れる計画が最適です。 $ 1,\ 2,\ 1 $ という順番に訪れる計画は $ 1 $ 番目の道を $ 2 $ 回通っているので条件を満たしていません。

### Sample Explanation 2

同じ道を $ 2 $ 度以上通らない旅の計画をたてることはできません。よって $ -1 $ を出力します。

## 样例 #1

### 输入

```
5 7

1 2 2

1 4 1

2 3 7

1 5 12

3 5 2

2 5 3

3 4 5
```

### 输出

```
13
```

## 样例 #2

### 输入

```
5 4

1 2 1

1 3 1

1 4 1

1 5 1
```

### 输出

```
-1
```

## 样例 #3

### 输入

```
10 12

1 4 3

1 9 1

2 5 4

2 6 1

3 7 5

3 10 9

4 7 2

5 6 6

5 8 5

6 8 3

7 9 5

8 10 8
```

### 输出

```
11
```



---

---
title: "[ABC022D] Big Bang"
layout: "post"
diff: 普及+/提高
pid: AT_abc022_d
tag: []
---

# [ABC022D] Big Bang

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc022/tasks/abc022_d

宇宙はビッグバンによって誕生して以来、膨張し続けていることが知られています。

天文学者である高橋君はその宇宙の膨張の速度を計測することにしました。

高橋君はある $ 2 $ つの日について、同じ $ N $ 個の星の位置を観測しました。星の位置は座標平面上の点として記録されます。つまり各日の観測結果は座標平面上の $ N $ 個の点からなる点集合になります。

$ 2 $ 回の観測の結果を見比べてみると、$ 1 $ 回目の観測結果である点集合に対して以下の $ 3 $ つの操作を順に実行すると $ 2 $ 回目の観測結果である点集合に一致することがわかりました。

1. 同じ向きに同じ距離だけ平行移動する。
2. 原点を中心に同じ角度だけ回転する。
3. 原点を中心に $ P $ 倍 $ (1\ ≦\ P) $ に相似拡大する。つまり点 $ (a,\ b) $ を点 $ (a×P,\ b×P) $ に移すという操作をすべての点に実行する。

ここで $ P $ の値がわかれば膨張速度を求めることができそうです。

いざ $ P $ を求めようとした高橋君でしたが、うっかりどの点がどの星に対応するのか記したデータをなくしてしまいました。

そこで高橋君は優秀なプログラマーであるあなたに助けを借りることにしました。

$ 1 $ 回目と $ 2 $ 回目の観測結果が与えられるので $ P $ を求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる

> $ N $ $ Ax_1 $ $ Ay_1 $ $ Ax_2 $ $ Ay_2 $ : $ Ax_N $ $ Ay_N $ $ Bx_1 $ $ By_1 $ $ Bx_2 $ $ By_2 $ : $ Bx_N $ $ By_N $

- $ 1 $ 行目には高橋君が観測した星の個数 $ N\ (2\ ≦\ N\ ≦\ 10^5) $ が与えられる。
- $ 2 $ 行目からの $ N $ 行のうち $ i $ 行目には $ 1 $ 回目に観測された $ i $ 番目の星の位置の $ x $ 座標と $ y $ 座標の値を表す $ 2 $ つの整数 $ Ax_i,\ Ay_i\ (-15,000\ ≦Ax_i,\ Ay_i\ ≦\ 15,000) $ が空白区切りで与えられる。
- $ N+2 $ 行目からの $ N $ 行のうち $ i $ 行目には $ 2 $ 回目に観測された $ i $ 番目の星の位置の $ x $ 座標と $ y $ 座標の値を表す $ 2 $ つの整数 $ Bx_i,\ By_i\ (-10^9\ ≦Bx_i,\ By_i\ ≦\ 10^9) $ が空白区切りで与えられる。
- $ 1 $ 回目も $ 2 $ 回目も、同じ点に複数の星が観測されることはない。
- $ 1 $ 回目に観測された $ i $ 番目の星と $ 2 $ 回目に観測された $ i $ 番目の星が同一の星とは限らない。

## 输出格式

$ P $ の値を $ 1 $ 行に出力せよ。 出力は絶対誤差あるいは相対誤差の少なくとも片方が $ 10^{-6} $ 以下であれば許容される。出力の末尾にも改行を入れること。

## 说明/提示

### 部分点

この問題には部分点が設定されている。

- $ 1\ ≦\ N\ ≦\ 3,000 $を満たすデータセットに正解した場合は $ 50 $ 点が与えられる。
- $ 1\ ≦\ N\ ≦\ 10^5 $を満たすデータセットに正解した場合はさらに $ 50 $ 点が与えられる。合計で$ 100 $点となる。

### Sample Explanation 1

以下のように操作を実行すれば、 $ 1 $ 回目の観測結果の点集合が、 $ 2 $ 回目の観測結果の点集合に移されます。 1. $ x $ 軸方向に $ -0.5 $、 $ y $ 軸方向に $ -0.5 $ 平行移動させる。 2. 原点を中心にして、$ 45° $ 時計回りに回転させる。 3. 原点を中心に $ 2√2 $ 倍する。 よって $ P\ =\ 2√2 $ となります。

## 样例 #1

### 输入

```
4

0 0

0 1

1 0

1 1

0 2

2 0

-2 0

0 -2
```

### 输出

```
2.8284271247
```

## 样例 #2

### 输入

```
6

3 4

1 3

4 3

2 2

0 1

2 0

5 5

-1 2

-1 -3

2 1

2 6

4 -3
```

### 输出

```
2.2360679775
```



---

---
title: "[ABC023C] 収集王"
layout: "post"
diff: 普及+/提高
pid: AT_abc023_c
tag: []
---

# [ABC023C] 収集王

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc023/tasks/abc023_c

高橋君はある部屋に移動する予定です。

部屋は正方形のマスが縦に $ R $ 行、横に $ C $ 列並んだ形状をしています。このうち $ i\ (1\ ≦\ i\ ≦\ R) $ 行目の $ j\ (1\ ≦\ j\ ≦\ C) $ 列目にあるマスをマス $ (i,j) $ と呼ぶことにします。

これらのマスには飴が合計 $ N $ 個存在します。飴には $ 1 $ から $ N $ までの番号が付けられており、飴 $ i\ (1\ ≦\ i\ ≦\ N) $ はマス $ (r_i,c_i) $ に置いてあります。これらのうちどの $ 2 $ つの飴も同一のマス上にありません。

高橋君はマスのうち任意の $ 1 $ マスに移動します。移動した後、高橋君は次に示すように飴を獲得します。

- 最初に、高橋君がいるマスと同じ行にあるすべてのマスについて、そのマスにある飴をすべて獲得する。
- 次に、高橋君がいるマスと同じ列にあるすべてのマスについて、そのマスにあるすべての飴を獲得する。

高橋君はこの行動以外には何も行動しません。

高橋君は獲得する飴の個数がちょうど $ K $ 個になるようにしたいです。このような移動先として考えられるマスの総数を求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ R $ $ C $ $ K $ $ N $ $ r_1 $ $ c_1 $ $ r_2 $ $ c_2 $ : $ r_N $ $ c_N $

- $ 1 $ 行目には、$ 3 $ つの整数 $ R\ (1\ ≦\ R\ ≦\ 100,000) $, $ C\ (1\ ≦\ C\ ≦\ 100,000) $, $ K\ (1\ ≦\ K\ ≦\ 100,000) $ が空白区切りで書かれている。これは、部屋を構成する正方形マスが縦 $ R $ 行、横 $ C $ 列あることを表す。$ K $ は高橋君が獲得したい飴の個数である。
- $ 2 $ 行目には、飴の個数を表す整数 $ N\ (K\ ≦\ N\ ≦\ 100,000) $ が与えられる。
- $ 3 $ 行目から $ N $ 行には、飴に関する情報が与えられる。$ N $ 行のうち $ i\ (1\ ≦\ i\ ≦\ N) $ 行目には、$ 2 $ つの整数 $ r_i\ (1\ ≦\ r_i\ ≦\ R) $, $ c_i\ (1\ ≦\ c_i\ ≦\ C) $ が空白区切りで書かれている。これは飴 $ i $ がマス ($ r_i $,$ c_i $) にあることを表す。
- $ i≠j $ のとき、$ (r_i,c_i)≠(r_j,c_j) $ となる。

## 输出格式

獲得する飴の個数がちょうど $ K $ 個になるような移動先の総数を $ 1 $ 行に出力せよ。出力の末尾にも改行を入れること。

## 说明/提示

### 部分点

この問題には部分点が設定されている。

- $ R\ ≦\ 50 $ かつ $ C\ ≦\ 50 $ かつ $ N\ ≦\ 50 $ を満たすデータセット $ 1 $ に正解した場合は、$ 30 $ 点が与えられる。
- 追加制約のないデータセット $ 2 $ に正解した場合は、上記とは別に $ 70 $ 点が与えられる。

### Sample Explanation 1

例えば、マス $ (3,2) $ に高橋君が移動した場合を考えます。 - 飴 $ 1 $ は、マス $ (1,2) $ にあります。このマスはマス $ (3,2) $ と同じ列にあるので、高橋君は飴 $ 1 $ を獲得します。 - 飴 $ 2 $ は、マス $ (2,1) $ にあります。このマスはマス $ (3,2) $ と同じ行にも同じ列にもないので、高橋君は飴 $ 2 $ を獲得しません。 - 飴 $ 3 $ は、マス $ (2,5) $ にあります。このマスはマス $ (3,2) $ と同じ行にも同じ列にもないので、高橋君は飴 $ 3 $ を獲得しません。 - 飴 $ 4 $ は、マス $ (3,2) $ にあります。このマスはマス $ (3,2) $ と同じマス (同じ行かつ同じ列) にあるので、高橋君は飴 $ 4 $ を獲得します。 - 飴 $ 5 $ は、マス $ (3,5) $ にあります。このマスはマス $ (3,2) $ と同じ行にあるので、高橋君は飴 $ 5 $ を獲得します。 以上より、飴 $ 1 $, $ 4 $, $ 5 $ のちょうど $ 3 $ 個だけ飴を獲得するので、マス $ (3,2) $ は獲得する飴の個数がちょうど $ K $ 個になるような移動先です。 他にもマス $ (1,5) $, $ (2,5) $, $ (3,1) $, $ (3,5) $ が条件をみたすので答えとして $ 5 $ を出力します。

### Sample Explanation 2

どのように移動先を指定しても、獲得する飴の個数をちょうど $ 1 $ 個にすることはできません。

## 样例 #1

### 输入

```
3 5 3

5

1 2

2 1

2 5

3 2

3 5
```

### 输出

```
5
```

## 样例 #2

### 输入

```
7 3 1

4

3 2

3 3

4 2

4 3
```

### 输出

```
0
```

## 样例 #3

### 输入

```
5 5 2

5

1 1

2 2

3 3

4 4

5 5
```

### 输出

```
20
```



---

---
title: "[ABC023D] 射撃王"
layout: "post"
diff: 普及+/提高
pid: AT_abc023_d
tag: []
---

# [ABC023D] 射撃王

## 题目描述

高桥最近正在练习射击。
他参加了一个射击比赛，比赛内容是射击气球，让自己得到的分数尽量小。
气球从1到N依次编号。每个气球都有一个起始高度Hi，每个气球每秒可以升高的高度为Si。
高桥开始时可以先打掉一个气球，随后每一秒他可以射击一次。当他打掉气球后，所得的分数就是气球的高度。而最终的的得分就是这些分数中的一个最大值。
高桥想知道他自己能得到的尽量小的分数是多少，来判断自己是否真的是一个菜鸡。

## 输入格式

第一行为气球的个数N（1 ≦ N ≦ 100,000）
下面N+1行，每行两个整数Hi和Si，表示气球的初始高度和气球的升高速度。 (1 ≦ Hi,Si ≦ 1,000,000,000)
输入数据保证气球的高度只会增加而不会下降

## 输出格式

输出一个数，表示高桥能拿到的最小分数

## 样例 #1

### 输入

```
4

5 6

12 4

14 7

21 2
```

### 输出

```
23
```

## 样例 #2

### 输入

```
6

100 1

100 1

100 1

100 1

100 1

1 30
```

### 输出

```
105
```



---

---
title: "[ABC025C] 双子と○×ゲーム"
layout: "post"
diff: 普及+/提高
pid: AT_abc025_c
tag: []
---

# [ABC025C] 双子と○×ゲーム

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc025/tasks/abc025_c

直大くんと直子さんは双子の兄妹です。時々、休日に $ 2 $ 人でゲームをしています。

ゲームは○×ゲームをベースにしており、以下の要領でゲームが行われます。

- ゲームは縦 $ 3 $ マス、横 $ 3 $ マスの盤面を使います。ゲーム開始時点ではどのマスにも文字が書かれていません。
- 挨拶した後、直大くんから始めて交互に文字を書いていきます。文字は盤面上のまだ文字が書かれていないマスの上にのみ書くことができます。そのようなマスが複数ある場合は好きな $ 1 $ 箇所を選んで書きます。書く文字は、直大くんが○、直子さんが×です。
- 合わせて $ 9 $ 回文字を書いた時点で、すべてのマスが埋まります。その後、得点計算を行い、得点の高い方が勝ちます。

得点計算は以下の方法で行われます。ここで、盤面の左上のマスをマス $ (1,\ 1) $ とし、左上から下に $ i-1\ (1\ ≦\ i\ ≦\ 3) $ マス、右に $ j-1\ (1\ ≦\ j\ ≦\ 3) $ マス進んだところにあるマスをマス $ (i,\ j) $ と呼ぶことにします。

- $ 1\ ≦\ i\ ≦\ 2 $ および $ 1\ ≦\ j\ ≦\ 3 $ を満たすすべての整数組 $ (i,j) $ に対して、マス $ (i,j) $ とマス $ (i+1,j) $ に書かれているマスを見て、同じ文字が書かれていたなら直大くんに、違う文字が書かれていたなら直子さんに $ b_{i,j} $ 点が入る。
- $ 1\ ≦\ i\ ≦\ 3 $ および $ 1\ ≦\ j\ ≦\ 2 $ を満たすすべての整数組 $ (i,j) $ に対して、マス $ (i,j) $ とマス $ (i,j+1) $ に書かれているマスを見て、同じ文字が書かれていたなら直大くんに、違う文字が書かれていたなら直子さんに $ c_{i,j} $ 点が入る。

直大くんも直子さんも、最終的に得られる自分の得点ができるだけ多くなるようにゲームを行います。両者が最善を尽くしたときのそれぞれの得点を計算してください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ b_{1,1} $ $ b_{1,2} $ $ b_{1,3} $ $ b_{2,1} $ $ b_{2,2} $ $ b_{2,3} $ $ c_{1,1} $ $ c_{1,2} $ $ c_{2,1} $ $ c_{2,2} $ $ c_{3,1} $ $ c_{3,2} $

- $ 1 $ 行目には、$ 3 $ つの整数 $ b_{1,1}\ (0\ ≦\ b_{1,1}\ ≦\ 100) $ と $ b_{1,2}\ (0\ ≦\ b_{1,2}\ ≦\ 100) $ と $ b_{1,3}\ (0\ ≦\ b_{1,3}\ ≦\ 100) $ が空白区切りで書かれている。
- $ 2 $ 行目には、$ 3 $ つの整数 $ b_{2,1}\ (0\ ≦\ b_{2,1}\ ≦\ 100) $ と $ b_{2,2}\ (0\ ≦\ b_{2,2}\ ≦\ 100) $ と $ b_{2,3}\ (0\ ≦\ b_{2,3}\ ≦\ 100) $ が空白区切りで書かれている。
- $ 3 $ 行目には、$ 2 $ つの整数 $ c_{1,1}\ (0\ ≦\ c_{1,1}\ ≦\ 100) $ と $ c_{1,2}\ (0\ ≦\ c_{1,2}\ ≦\ 100) $ が空白区切りで書かれている。
- $ 4 $ 行目には、$ 2 $ つの整数 $ c_{2,1}\ (0\ ≦\ c_{2,1}\ ≦\ 100) $ と $ c_{2,2}\ (0\ ≦\ c_{2,2}\ ≦\ 100) $ が空白区切りで書かれている。
- $ 5 $ 行目には、$ 2 $ つの整数 $ c_{3,1}\ (0\ ≦\ c_{3,1}\ ≦\ 100) $ と $ c_{3,2}\ (0\ ≦\ c_{3,2}\ ≦\ 100) $ が空白区切りで書かれている。

## 输出格式

出力は $ 2 $ 行からなる。$ 1 $ 行目には直大くんの得点を、$ 2 $ 行目には直子さんの得点を出力せよ。出力の末尾に改行を入れること。

## 说明/提示

### Sample Explanation 1

\- 例えば、マス $ (2,1) $ →マス $ (1,1) $ →マス $ (2,2) $ →マス $ (1,3) $ →マス $ (1,2) $ →マス $ (2,3) $ →マス $ (3,1) $ →マス $ (3,2) $ →マス $ (3,3) $ の順に文字が書かれた場合を考えます。この場合、盤面は最終的に以下のようになります。 ×○×○○×○×○- この場合、直大くんの得点は、$ (b_{1,2}\ +\ b_{1,3}\ +\ b_{2,1}\ +\ c_{1,2}\ =\ )\ 15\ +\ 0\ +\ 0\ +\ 0\ =\ 15 $ 点となります。 - 一方、直子さんの得点は、$ (b_{1,1}\ +\ b_{2,2}\ +\ b_{2,3}\ +\ c_{1,1}\ +\ c_{1,2}\ +\ c_{2,2}\ +\ c_{3,1}\ +\ c_{3,2}\ =\ )\ 0\ +\ 0\ +\ 25\ +\ 20\ +\ 10\ +\ 0\ +\ 25\ +\ 0\ =\ 80 $ 点となります。

## 样例 #1

### 输入

```
0 15 0

0 0 25

20 10

0 0

25 0
```

### 输出

```
15

80
```

## 样例 #2

### 输入

```
18 22 15

11 16 17

4 25

22 15

10 4
```

### 输出

```
72

107
```



---

---
title: "[ABC026D] 高橋君ボール1号"
layout: "post"
diff: 普及+/提高
pid: AT_abc026_d
tag: []
---

# [ABC026D] 高橋君ボール1号

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc026/tasks/abc026_d

高橋君は野球が得意です。高橋君は、高橋君ボール $ 1 $ 号という変化球を投げることが出来ます。

このボールは、投げてから $ t $ 秒後のボールの位置を $ f(t) $ とすると、 $ f(t)\ =\ A\ \times\ t\ +\ B\ \times{\rm\ sin}(C\ \times\ t\ \times\ π) $ と表すことが出来ます。

あなたは、$ t\ ≧\ 0 $ かつ $ f(t)\ =\ 100 $ となるタイミングで、ボールを打たなければいけません。この時の $ t $ を求めたいです。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ A $ $ B $ $ C $

- $ 1 $ 行目には、$ f(t) $ の式を表す整数 $ A,B,C\ (1≦A,B,C≦100) $ が、スペース区切りで与えられる。

## 输出格式

$ f(t)\ =\ 100 $ となる、 $ 0 $ 以上の $ t $ を $ 1 $ つ出力せよ。解が複数ある場合は、どの解を出力しても良い。 この問題は誤差が発生するが、 $ |f(t)\ -\ 100|\ ≦\ 10^{-6} $ であれば、正解となる。

出力の末尾には改行を入れること。

誤差が出やすい問題ですので、誤差に十分に注意してください。

## 说明/提示

### Sample Explanation 1

$ t\ =\ 100 $ のとき、 $ f(t)\ =\ 100 $ となります。

### Sample Explanation 2

解が一つではないことに注意してください。

## 样例 #1

### 输入

```
1 1 1
```

### 输出

```
100
```

## 样例 #2

### 输入

```
53 82 49
```

### 输出

```
1.63372043395339
```



---

---
title: "[ABC027C] 倍々ゲーム"
layout: "post"
diff: 普及+/提高
pid: AT_abc027_c
tag: []
---

# [ABC027C] 倍々ゲーム

## 题目描述

高桥君和青木君通过以下的双人游戏决定胜负。

给定正整数 $N$ 并将变量 $x$ 初始化为 $1$ 。从高桥君开始，高桥君和青木君交替操作，将 $x$ 的值换成 $2x$ 或 $2x+1$ 。

当 $x$ 比 $N$ 大的时候游戏结束，最后进行操作的人输。

两个人均以最优策略进行操作，问谁会赢。

## 输入格式

一行一个正整数 $ N $ ($ 1 \le N \le 10^{18} $)

## 输出格式

如果高桥君获胜,就输出 `Takahashi`；如果青木君获胜,就输出 `Aoki`。末尾输出一个换行。

## 样例 #1

### 输入

```
1
```

### 输出

```
Aoki
```

## 样例 #2

### 输入

```
5
```

### 输出

```
Takahashi
```

## 样例 #3

### 输入

```
7
```

### 输出

```
Aoki
```

## 样例 #4

### 输入

```
10
```

### 输出

```
Takahashi
```

## 样例 #5

### 输入

```
123456789123456789
```

### 输出

```
Aoki
```



---

---
title: "[ABC030D] へんてこ辞書"
layout: "post"
diff: 普及+/提高
pid: AT_abc030_d
tag: []
---

# [ABC030D] へんてこ辞書

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc030/tasks/abc030_d

ミカミくんは怪しい英単語帳を使っています。その単語帳には $ N $ 個の単語の意味が載っており、単語 $ i $ の説明には「単語 $ b_i $ と同じ意味である」とだけ書いてあります。ここで、$ i $ 番目の単語を単語 $ i $ と呼ぶことにします。 ミカミくんはまだ一つの英単語も知らないので、単語 $ i $ の意味を調べようとしたとき、単語 $ b_i $ の意味を調べようとします。ミカミくんは真面目なので、今までにすでに調べようとしたことのある単語でも同じように単語帳をひき続けます。 しかし、残念ながらこの単語帳では英単語の意味自体はどこにも書いていないため、意味を知ることはできません。 ある単語 $ i $ を調べようとして、単語帳を参照し、単語 $ b_i $ を調べようとするまでを1ステップとします。

ミカミくんが単語 $ i $ を調べようとして、$ k $ ステップ経ったとき、ミカミくんはどの単語を調べようとしているでしょうか？

### Input &amp; Output Format

入力は以下の形式で標準入力から与えられる。

> $ N $ $ a $ $ k $ $ b_1 $ $ b_2 $ … $ b_N $

- $ 1 $ 行目には、単語の数 $ N\ (2\ ≦\ N\ ≦\ 10^5) $ とミカミくんが調べようとしている単語の番号 $ a\ (1\ ≦\ a\ ≦\ N) $ がスペース区切りで与えられる。
- $ 2 $ 行目には、ミカミくんが単語を調べるステップ数 $ k(1\ ≦\ k\ ≦\ 10^{100000}) $ が与えられる。
- $ 3 $ 行目には、各単語の説明を表す $ N $ 個の整数 $ b_1,...,b_N $ が空白区切りで与えられる。
- $ 1\ ≦\ b_i\ ≦\ N\ かつ\ b_i\ ≠\ i\ (1\ ≦\ i\ ≦\ N) $ であることが保証される。

## 输出格式

ミカミくんが単語 $ a $ を調べようとしてから $ k $ ステップ経ったとき、調べようとしている単語の番号を $ 1 $ 行に出力せよ。出力の末尾にも改行をいれること。

## 说明/提示

### 部分点

この問題には部分点が設定されている。

- $ k\ ≦\ 10^{18} $ を満たすデータセットに正解した場合は $ 50 $ 点が与えられる。

### Sample Explanation 1

ミカミくんは、それぞれのステップで以下のように単語を調べます。 $ 1 $ ステップ目で、単語 $ 4 $ の意味を知るため、単語 $ 2 $ を調べようとします。 $ 2 $ ステップ目で、単語 $ 2 $ の意味を知るため、単語 $ 3 $ を調べようとします。 $ 3 $ ステップ目で、単語 $ 3 $ の意味を知るため、単語 $ 1 $ を調べようとします。 $ 4 $ ステップ目で、単語 $ 1 $ の意味を知るため、単語 $ 2 $ を調べようとします。 $ 5 $ ステップ目で、単語 $ 2 $ の意味を知るため、単語 $ 3 $ を調べようとします。 よって、$ 5 $ ステップ経ったとき、ミカミくんは単語 $ 3 $ を調べようとしています。

### Sample Explanation 2

$ k $ はたいへん大きくなることがあります。

## 样例 #1

### 输入

```
6 4

5

2 3 1 2 6 5
```

### 输出

```
3
```

## 样例 #2

### 输入

```
4 1

100000000000000000000

2 3 4 1
```

### 输出

```
1
```

## 样例 #3

### 输入

```
8 1

1

2 3 4 5 3 2 4 5
```

### 输出

```
2
```



---

---
title: "[ABC031D] 語呂合わせ"
layout: "post"
diff: 普及+/提高
pid: AT_abc031_d
tag: []
---

# [ABC031D] 語呂合わせ

## 题目描述

日本有一种将数字与短字符串对应的记忆文化。

对此产生兴趣的高桥君，决定推断出仅由 $1$ 以上 $K$ 以下的数字组成的正整数 $v_1,v_2,\cdots,v_n$ 以及对应的字符串 $w_1,w_2,\cdots,w_n$ 的组合 $(v_1,w_1),(v_2,w_2),\cdots,(v_n,w_n)$ 中，哪个数字对应哪个字符串。

也就是说，想要找出满足以下条件的 $K$ 个字符串 $s_1,s_2,\cdots,s_K$。

- 对于满足 $1 \leqq i \leqq K$ 的任意整数 $i$，必须满足 $1 \leqq |s_i| \leqq 3$。
- 对于满足 $1 \leqq i \leqq N$ 的任意整数 $i$，当将整数 $v_i$ 按位分解时，得到的数字从上到下依次为 $d_1,d_2,\cdots,d_l$，则将字符串 $s_{d_1},s_{d_2},\cdots,s_{d_l}$ 按此顺序连接的字符串等于 $w_i$。

请编写程序输出 $K$ 个字符串 $s_1,s_2,\cdots,s_k$。

## 输入格式

输入通过标准输入以以下格式给出。

> $K \space N$  
> $v_1 \space w_1$  
> $v_2 \space w_2$  
> $\vdots$  
> $v_N \space w_N$  

- 第 $1$ 行包含用空格分隔的两个整数 $K,N$。
- 第 $2 \sim N$ 行，每一行给出关于数字和字符串组合的信息。在每一行中，包含空格分隔的完全由 $1 \sim K$ **组成的数字**和完全由**半角小写字母**组成的字符串。


翻译来自 @[lby_commandBlock](/user/791222)。

## 输出格式

共 $K$ 行。第 $i(1 \leqq i \leqq K)$ 行输出字符串 $s_i$。

若有多种组合，输出任意一个组合即可。

注意输出的末尾要加上换行。

### 样例解释 1

在这个样例中，通过将 $s_1=$ `i`，$s_2=$ `ni`，$s_3=$ `mi`，$s_4=$ `yo`，$s_5=$ `go`，$s_6=$ `ro` 设定为可以满足题意的 $K$ 个字符串。事实上，

- 当将 $v_1=356$ 按位分解时，得到 $3,5,6$，将 $s_3=$ `mi`，$s_5=$ `go`，$s_6=$ `ro` 按此按此顺序连接的字符串 `migoro` 等于 $w_1$。
- 当将 $v_2=461$ 按位分解时，得到 $4,6,1$，将 $s_4=$ `yo`，$s_6=$ `ro`，$s_1=$ `i` 按此按此顺序连接的字符串 `yoroi` 等于 $w_2$。
- 当将 $v_3=2$ 按位分解时，得到 $2$，$s_2=$ `ni` 等于 $w_3$。
- 当将 $v_4=12$ 按位分解时，得到 $1,2$，$s_1=$ `i`，$s_2=$ `ni` 按此顺序连接的字符串 `ini` 等于 $w_4$。

### 数据规模与约定

- 对于所有数据，满足 $1 \leqq K \leqq 9,1 \leqq N \leqq 50$。
- 满足 $1 \sim K$ 的所有数字在 $v_1,v_2,\cdots,v_N$ 中**至少出现过一次**。
- 满足 $s_1,s_2,\cdots,s_K$ 一定存在。

### 部分分

本题设置了部分分。

- 如果通过了由 $K \leqq 3$ 和 $w_1$ 到 $w_N$ 的任何字符串组成的数据集 $1$，将获得 $40$ 分。

## 样例 #1

### 输入

```
6 4

356 migoro

461 yoroi

2 ni

12 ini
```

### 输出

```
i

ni

mi

yo

go

ro
```

## 样例 #2

### 输入

```
3 4

21 aaa

12 aaa

123 aaaaaa

13 aaaa
```

### 输出

```
a

aa

aaa
```

## 样例 #3

### 输入

```
2 3

12211 abcaaaaabcabc

2121 aaabcaaabc

222221 aaaaaaaaaaabc
```

### 输出

```
abc

aa
```

## 样例 #4

### 输入

```
2 1

12 abcab
```

### 输出

```
ab

cab
```



---

---
title: "[ABC032C] 列"
layout: "post"
diff: 普及+/提高
pid: AT_abc032_c
tag: []
---

# [ABC032C] 列

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc032/tasks/abc032_c

 長さ $ N $ の非負整数列 $ S={s_1,s_2,...,s_N} $ と整数 $ K $ があります。 あなたの仕事は、以下の条件を満たす $ S $ の **連続する** 部分列のうち、最も長いものの長さを求めることです。部分列の長さは $ 1 $ 以上の列でないといけません。

- その部分列に含まれる全ての要素の値の積は、$ K $ 以下である。

もし条件を満たす部分列が一つも存在しないときは、$ 0 $ を出力してください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ K $ $ s_1 $ $ s_2 $ : $ s_N $

- $ 1 $ 行目には、数列の長さを表す整数 $ N\ (1≦N≦10^5) $ と問題文中の整数 $ K\ (0≦K≦10^9) $ が空白区切りで与えられる。
- $ 2 $ 行目からの $ N $ 行には、数列の各要素の値が与えられる。そのうち $ i(1≦i≦N) $ 行目には、$ s_i\ (0≦s_i≦10^9) $ が書かれている。

## 输出格式

出力は以下の形式で標準出力に行うこと。

$ 1 $ 行目に、含まれる全ての要素の値の積が $ K $ 以下となる連続する部分列のうち最長のものの長さを出力せよ。もし条件を満たす部分列が一つも存在しないときは、$ 0 $ を出力せよ。末尾の改行を忘れないこと。

## 说明/提示

### 部分点

この問題には部分点が設定されている。満点は $ 100 $ 点である。

- $ N≦1000 $ を満たすデータセット $ 1 $ に正解した場合は、$ 20 $ 点が与えられる。
- 追加制約のないデータセット $ 2 $ に正解した場合、上記の点数に加え $ 80 $ 点が与えられる。

### Sample Explanation 1

部分列 $ S[2..5]=s_2,s_3,s_4,s_5 $ を選ぶと、積は $ 3×1×1×2=6 $ となり、$ K $ 以下になります。

## 样例 #1

### 输入

```
7 6

4

3

1

1

2

10

2
```

### 输出

```
4
```

## 样例 #2

### 输入

```
6 10

10

10

10

10

0

10
```

### 输出

```
6
```

## 样例 #3

### 输入

```
6 9

10

10

10

10

10

10
```

### 输出

```
0
```

## 样例 #4

### 输入

```
4 0

1

2

3

4
```

### 输出

```
0
```



---

---
title: "[ABC032D] ナップサック問題"
layout: "post"
diff: 普及+/提高
pid: AT_abc032_d
tag: []
---

# [ABC032D] ナップサック問題

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc032/tasks/abc032_d

0/1ナップサック問題を解いてください。0/1ナップサック問題とは以下のような問題のことです。

- $ N $ 個の荷物があり、$ i\ (1≦i≦N) $ 番目の荷物には価値 $ v_i $ と重さ $ w_i $ が割り当てられている。
- 許容重量 $ W $ のナップサックが1つある。
- 重さの和が $ W $ 以下となるように荷物の集合を選びナップサックに詰め込むとき、価値の和の最大値を求めよ。ただし、同じ荷物は一度しか選ぶことができない。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ W $ $ v_1 $ $ w_1 $ $ v_2 $ $ w_2 $ : $ v_N $ $ w_N $

- $ 1 $ 行目には、荷物の数を表す整数 $ N\ (1≦N≦200) $ とナップサックの許容重量を表す整数 $ W(1≦W≦10^9) $ が空白区切りで与えられる。
- $ 2 $ 行目からの $ N $ 行には、各荷物の情報が与えられる。そのうち $ i(1≦i≦N) $ 行目には、$ i $ 番目の荷物の価値を表す整数 $ v_i\ (1≦v_i≦10^9) $ と重さを表す整数 $ w_i\ (1≦w_i≦10^9) $ が空白区切りで与えられる。
- 「$ N≦30 $」、「全ての$ i(1≦i≦N) $ について $ 1≦w_i≦1000 $」、「全ての$ i(1≦i≦N) $ について $ 1≦v_i≦1000 $」という $ 3 $ つの条件のうち少なくとも1つの条件が成り立つ。

## 输出格式

出力は以下の形式で標準出力に行うこと。

$ 1 $ 行目に、達成できる最大の合計価値を出力せよ。末尾の改行を忘れないこと。

## 说明/提示

### 部分点

この問題には部分点が設定されている。満点は $ 100 $ 点である。

- $ N≦30 $ を満たすデータセット $ 1 $ に正解した場合は、$ 34 $ 点が与えられる。
- $ N≦200 $ かつ全ての $ i(1≦i≦N) $ について $ 1≦w_i≦1000 $ を満たすデータセット $ 2 $ に正解した場合は、上記の点数とは別に $ 33 $ 点が与えられる。
- $ N≦200 $ かつ全ての $ i(1≦i≦N) $ について $ 1≦v_i≦1000 $ を満たすデータセット $ 3 $ に正解した場合は、上記の点数とは別に $ 33 $ 点が与えられる。

### Sample Explanation 1

$ 2 $ 番目と $ 3 $ 番目のアイテムを選ぶと、合計の重みが $ 10 $ で価値が $ 16 $ となり、最大価値を達成できます。 この入出力例は、データセット $ 1,2,3 $ の制約を満たしているため、全てのデータセットの採点に用いられます。

### Sample Explanation 2

この入出力例は、データセット $ 1 $ の制約のみ満たしているため、データセット $ 2,3 $ の採点には用いられません。

### Sample Explanation 3

この入出力例は、データセット $ 3 $ の制約を満たしていないため、データセット $ 3 $ の採点には用いられません。

### Sample Explanation 4

この入出力例は、データセット $ 2 $ の制約を満たしていないため、データセット $ 2 $ の採点には用いられません。

## 样例 #1

### 输入

```
3 10

15 9

10 6

6 4
```

### 输出

```
16
```

## 样例 #2

### 输入

```
30 499887702

128990795 137274936

575374246 989051853

471048785 85168425

640066776 856699603

819841327 611065509

704171581 22345022

536108301 678298936

119980848 616908153

117241527 28801762

325850062 478675378

623319578 706900574

998395208 738510039

475707585 135746508

863910036 599020879

340559411 738084616

122579234 545330137

696368935 86797589

665665204 592749599

958833732 401229830

371084424 523386474

463433600 5310725

210508742 907821957

685281136 565237085

619500108 730556272

88215377 310581512

558193168 136966252

475268130 132739489

303022740 12425915

122379996 137199296

304092766 23505143
```

### 输出

```
3673016420
```

## 样例 #3

### 输入

```
10 2921

981421680 325

515936168 845

17309336 371

788067075 112

104855562 96

494541604 960

32007355 161

772339969 581

55112800 248

98577050 22
```

### 输出

```
3657162058
```

## 样例 #4

### 输入

```
10 936447862

854 810169801

691 957981784

294 687140254

333 932608409

832 42367415

642 727293784

139 870916042

101 685539955

853 243593312

369 977358410
```

### 输出

```
1686
```



---

---
title: "[ABC034D] 食塩水"
layout: "post"
diff: 普及+/提高
pid: AT_abc034_d
tag: []
---

# [ABC034D] 食塩水

## 题目描述

有$N$ $(1≤N≤1000)$个装有食盐水的容器。容器从$1$到$N$标号。第$i$号容器有浓度为$p_i\%$ $(0≤p_i≤100)$的食盐水$w_i$ $(1≤w_i≤10^9)$克。高桥君需要选择$K$ $(1≤K≤1000)$个容器，并把选择的容器里的食盐水全部混合在一起。请你编程求出高桥君可以获得的盐水的最大浓度。

## 输入格式

第一行两个整数$N$、$K$；
接下来$N$行，每行两个数$w_i$、$p_i$。

## 输出格式

一行一个实数$x$，表示高桥君能得到的最大浓度的盐水浓度为$x\%$。

## 样例 #1

### 输入

```
3 2
100 15
300 20
200 30

```

### 输出

```
25.000000000

```



---

---
title: "[ABC035D] トレジャーハント"
layout: "post"
diff: 普及+/提高
pid: AT_abc035_d
tag: []
---

# [ABC035D] トレジャーハント

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc035/tasks/abc035_d

高橋君が住む国には $ N $ 箇所の町と町同士をつなぐ一方通行の道が $ M $ 本あり、それぞれの町には $ 1 $ から $ N $ の番号が割りふられています。 $ i $ 番目の道は $ a_i $ 番の町から $ b_i $ 番の町へ移動することが可能であり、移動に $ c_i $ 分だけかかります。

所持金が $ 0 $ 円の高橋君は $ T $ 分間のトレジャーハントに出かけることにしました。高橋君は開始 $ 0 $ 分の時点で $ 1 $ 番の町にいます。また、開始から $ T $ 分の時点にも $ 1 $ 番の町にいなくてはなりません。高橋君が $ i $ 番の町に $ 1 $ 分間滞在すると、 $ A_i $ 円が高橋君の所持金に加算されます。

$ T $ 分間のトレジャーハントによって高橋君の所持金は最大いくらになるか求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ M $ $ T $ $ A_1 $ … $ A_N $ $ a_1 $ $ b_1 $ $ c_1 $ . . . $ a_M $ $ b_M $ $ c_M $

- $ 1 $ 行目に町の数と道の数、トレジャーハントの分数を表す $ 3 $ つの整数 $ N,M,T\ (2≦N≦10^5,\ 1≦M≦min(N(N-1),10^5),\ 1≦T≦10^9) $ が空白区切りで与えられる。
- $ 2 $ 行目には $ i $ 番目の町に滞在したときに得られるお金の情報を表す整数 $ A_i(1≦A_i≦10^5) $ が空白区切りで与えられる。
- $ 3 $ 行目から続く $ M $ 行のうち $ i $ 行目においては、 $ i $ 番目の道の情報を表す $ 3 $ つの整数 $ a_i,\ b_i,\ c_i\ (1≦a_i,b_i≦N,a_i≠b_i,\ 1≦c_i≦10^5) $が空白区切りで与えられる。
- $ i≠j $ であるような $ i,j $ において、$ a_i≠a_j $ または $ b_i≠b_j $ のどちらかが成立する。

## 输出格式

トレジャーハントの結果としてありうる高橋君の所持金のうち最大値を $ 1 $ 行に出力せよ。改行を忘れないこと。

## 说明/提示

### 部分点

この問題には部分点が設定されている。

- $ 1≦N≦200 $ を満たすデータセットに正解した場合 $ 50 $ 点が与えられる。
- 追加制約のないデータセットに正解した場合は、追加で $ 50 $ 点が与えられ、合計 $ 100 $ 点が得られる。

### Sample Explanation 1

\- 開始から $ 0 $ 分の時点から $ 2 $ 分かけて町 $ 1 $ から町 $ 2 $ に移動します。 - 開始から $ 2 $ 分の時点から $ 2 $ 分間、町 $ 2 $ に滞在します。所持金は $ 6 $ 円になります。 - 開始から $ 4 $ 分の時点から $ 1 $ 分かけて町 $ 2 $ から町 $ 1 $ に移動します。 - 開始から $ 5 $ 分の時点で町 $ 1 $ にいます。トレジャーハントが終了します。 - このケースは部分点の制約を満たします。

### Sample Explanation 2

\- 開始 $ 0 $ 分の時点から $ 3 $ 分間、町 $ 1 $ に滞在するのが最適であり、所持金を $ 3 $ 円にすることができます。 - このケースは部分点の制約を満たします。

### Sample Explanation 3

\- このケースは部分点の制約を満たします。

## 样例 #1

### 输入

```
2 2 5

1 3

1 2 2

2 1 1
```

### 输出

```
6
```

## 样例 #2

### 输入

```
2 2 3

1 3

1 2 2

2 1 1
```

### 输出

```
3
```

## 样例 #3

### 输入

```
8 15 120

1 2 6 16 1 3 11 9

1 8 1

7 3 14

8 2 13

3 5 4

5 7 5

6 4 1

6 8 17

7 8 5

1 4 2

4 7 1

6 1 3

3 1 10

2 6 5

2 4 12

5 1 30
```

### 输出

```
1488
```



---

---
title: "[ABC036D] 塗り絵"
layout: "post"
diff: 普及+/提高
pid: AT_abc036_d
tag: []
---

# [ABC036D] 塗り絵

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc036/tasks/abc036_d





---

---
title: "[ABC037D] 経路"
layout: "post"
diff: 普及+/提高
pid: AT_abc037_d
tag: []
---

# [ABC037D] 経路

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc037/tasks/abc037_d

$ H\ *\ W $ のマス目があり、それぞれのマスには整数が書かれています。 $ i $ 行 $ j $ 列に書かれている数は $ a_{ij} $ です。

あなたはこのグリッドの中の好きなマスから好きなだけ動きます(最初のマスから動かなくてもかまいません)。 今いるマスの上下左右に隣接しているマスのうち、今いるマスより大きな整数が書かれたマスに移動することができます。

ありうる移動経路の個数を$ 10^9+7 $で割った余りを求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ H $ $ W $ $ a_{11} $ .. $ a_{1W} $ : $ a_{H1} $ .. $ a_{HW} $

## 输出格式

移動経路の個数を$ 10^9+7 $で割った余りを出力せよ。

## 说明/提示

### 制約

- $ 1\ \leq\ H,\ W\ \leq\ 1,000 $
- $ 1\ \leq\ a_{ij}\ \leq\ 10^9 $

### Sample Explanation 1

例えば、$ 1 $ 行 $ 2 $ 列から出発し、右、下と移動する経路や、 $ 1 $ 行 $ 1 $ 列から出発し、下に移動する経路などがあります。 全部で $ 18 $ 種類の経路があります。

## 样例 #1

### 输入

```
2 3

1 4 5

2 4 9
```

### 输出

```
18
```

## 样例 #2

### 输入

```
6 6

1 3 4 6 7 5

1 2 4 8 8 7

2 7 9 2 7 2

9 4 2 7 6 5

2 8 4 6 7 6

3 7 9 1 2 7
```

### 输出

```
170
```



---

---
title: "[ABC040D] 道路の老朽化対策について"
layout: "post"
diff: 普及+/提高
pid: AT_abc040_d
tag: []
---

# [ABC040D] 道路の老朽化対策について

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc040/tasks/abc040_d

ある国には $ N $ 個の都市があり、それぞれ $ 1 $ から $ N $ までの番号がつけられています。これらの都市間を結ぶ $ M $ 本の道路があり、$ i $ 本目の道路は都市 $ a_i $ と都市 $ b_i $ を結ぶもので、$ y_i $ 年に造られたものです。

この国の国民はとても心配性なので、あまりに古い道は事故の危険性が高いと考えて使わないことがあります。そこであなたは、この国の交通状況を調査することにしました。

$ Q $ 人の国民の情報が与えられます。$ j $ 人目の国民について、都市 $ v_j $ に住んでおり、造られた年が $ w_j $ 年以前 ($ w_j $ 年ちょうども含む) であるような道路を使わないことがわかっています。

それぞれの国民に対し、その人が住んでいる都市から道路のみを使って行き来できるような都市の個数を求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ M $ $ a_1 $ $ b_1 $ $ y_1 $ : $ a_M $ $ b_M $ $ y_M $ $ Q $ $ v_1 $ $ w_1 $ : $ v_Q $ $ w_Q $

## 输出格式

$ Q $ 行出力せよ。そのうちの $ j $ 行目には、$ j $ 人目の国民が道路のみを使って行き来可能な都市の個数を出力せよ。

## 说明/提示

### 制約

- $ 1\ ≦\ N\ ≦\ 100,000 $
- $ 0\ ≦\ M\ ≦\ 200,000 $
- $ 1\ ≦\ a_i,b_i\ ≦\ N $
- $ a_i\ ≠\ b_i $
- $ 1\ ≦\ y_i\ ≦\ 200,000 $
- $ 1\ ≦\ Q\ ≦\ 100,000 $
- $ 1\ ≦\ v_j\ ≦\ N $
- $ 0\ ≦\ w_j\ ≦\ 200,000 $

### 部分点

- $ 50 $ 点分のテストケースでは、$ N\ ≦\ 1,000 $, $ M\ ≦\ 2,000 $, $ Q\ ≦\ 1,000 $ をみたす。

### Sample Explanation 1

$ Q $ 人それぞれの国民について、答えは以下のようになります。 - $ 1 $ 人目は都市 $ 1 $ に住んでおり、$ 2000 $ 年以前に造られた道を使いません。都市 $ 1 $ につながる唯一の道は $ 2000 $ 年に造られているので、都市 $ 1 $ 以外へ行くことができません。したがって答えは $ 1 $ となります。 - $ 2 $ 人目は都市 $ 1 $ に住んでおり、都市 $ 2 $ や $ 3 $ へ行くことができます。しかし、$ 1999 $ 年以前に造られた道を使わないので都市 $ 4 $ へ行くことはできません。したがって答えは $ 3 $ となります。 - $ 3 $ 人目は $ 1995 $ 年以前に造られた道を使いませんが、すべての道はそれより新しいため、すべての道をつかってすべての都市へ行くことができます。したがって答えは $ 5 $ となります。

### Sample Explanation 3

同じふたつの都市間を結ぶ道が $ 2 $ 本以上あることや、すべての道を使っても辿り着けない都市がありうることに注意してください。

## 样例 #1

### 输入

```
5 4

1 2 2000

2 3 2004

3 4 1999

4 5 2001

3

1 2000

1 1999

3 1995
```

### 输出

```
1

3

5
```

## 样例 #2

### 输入

```
4 5

1 2 2005

3 1 2001

3 4 2002

1 4 2004

4 2 2003

5

1 2003

2 2003

1 2001

3 2003

4 2004
```

### 输出

```
3

3

4

1

1
```

## 样例 #3

### 输入

```
4 5

1 2 10

1 2 1000

2 3 10000

2 3 100000

3 1 200000

4

1 0

2 10000

3 100000

4 0
```

### 输出

```
3

3

2

1
```



---

---
title: "[ABC041D] 徒競走"
layout: "post"
diff: 普及+/提高
pid: AT_abc041_d
tag: []
---

# [ABC041D] 徒競走

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc041/tasks/abc041_d



## 样例 #1

### 输入

```
3 2
2 1
2 3

```

### 输出

```
2

```

## 样例 #2

### 输入

```
5 5
1 2
2 3
3 5
1 4
4 5

```

### 输出

```
3

```

## 样例 #3

### 输入

```
16 1
1 2

```

### 输出

```
10461394944000

```



---

---
title: "[ABC051D] Candidates of No Shortest Paths"
layout: "post"
diff: 普及+/提高
pid: AT_abc051_d
tag: []
---

# [ABC051D] Candidates of No Shortest Paths

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc051/tasks/abc051_d

自己ループと二重辺を含まない $ N $ 頂点 $ M $ 辺の重み付き無向連結グラフが与えられます。  
 $ i\ (1≦i≦M) $ 番目の辺は頂点 $ a_i $ と頂点 $ b_i $ を距離 $ c_i $ で結びます。   
 ここで、自己ループは $ a_i\ =\ b_i\ (1≦i≦M) $ となる辺のことを表します。   
 また、二重辺は $ (a_i,b_i)=(a_j,b_j) $ または $ (a_i,b_i)=(b_j,a_j)\ (1≦i\ <\ j≦M) $ となる辺のことを表します。   
 連結グラフは、どの異なる $ 2 $ 頂点間にも経路が存在するグラフのことを表します。   
 どの異なる $ 2 $ 頂点間の、どの最短経路にも含まれない辺の数を求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ M $ $ a_1 $ $ b_1 $ $ c_1 $ $ a_2 $ $ b_2 $ $ c_2 $ $ : $ $ a_M $ $ b_M $ $ c_M $

## 输出格式

グラフ上の、どの異なる $ 2 $ 頂点間の、どの最短経路にも含まれない辺の数を出力せよ。

## 说明/提示

### 制約

- $ 2≦N≦100 $
- $ N-1≦M≦min(N(N-1)/2,1000) $
- $ 1≦a_i,b_i≦N $
- $ 1≦c_i≦1000 $
- $ c_i $ は整数である。
- 与えられるグラフは自己ループと二重辺を含まない。
- 与えられるグラフは連結である。

### Sample Explanation 1

この入力例で与えられるグラフにおける、全ての異なる $ 2 $ 頂点間の最短経路は以下の通りです。 - 頂点 $ 1 $ から頂点 $ 2 $ への最短経路は、頂点 $ 1 $ → 頂点 $ 2 $ で経路長は $ 1 $ - 頂点 $ 1 $ から頂点 $ 3 $ への最短経路は、頂点 $ 1 $ → 頂点 $ 3 $ で経路長は $ 1 $ - 頂点 $ 2 $ から頂点 $ 1 $ への最短経路は、頂点 $ 2 $ → 頂点 $ 1 $ で経路長は $ 1 $ - 頂点 $ 2 $ から頂点 $ 3 $ への最短経路は、頂点 $ 2 $ → 頂点 $ 1 $ → 頂点 $ 3 $ で経路長は $ 2 $ - 頂点 $ 3 $ から頂点 $ 1 $ への最短経路は、頂点 $ 3 $ → 頂点 $ 1 $ で経路長は $ 1 $ - 頂点 $ 3 $ から頂点 $ 2 $ への最短経路は、頂点 $ 3 $ → 頂点 $ 1 $ → 頂点 $ 2 $ で経路長は $ 2 $ したがって、一度も最短経路として使用されていない辺は、頂点 $ 2 $ と頂点 $ 3 $ を結ぶ長さ $ 3 $ の辺のみであるため、$ 1 $ を出力します。

### Sample Explanation 2

全ての辺が異なる $ 2 $ 頂点間のある最短経路で使用されます。

## 样例 #1

### 输入

```
3 3

1 2 1

1 3 1

2 3 3
```

### 输出

```
1
```

## 样例 #2

### 输入

```
3 2

1 2 1

2 3 1
```

### 输出

```
0
```



---

---
title: "[ABC070D] Transit Tree Path"
layout: "post"
diff: 普及+/提高
pid: AT_abc070_d
tag: []
---

# [ABC070D] Transit Tree Path

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc070/tasks/abc070_d

$ N $ 頂点の木が与えられます。   
 木とはグラフの一種であり、頂点の数を $ N $ とすると、辺の数が $ N-1 $ 本である閉路のない連結グラフです。   
 $ i(1≦i≦N-1) $ 番目の辺は 頂点 $ a_i $ と 頂点 $ b_i $ を距離 $ c_i $ で結びます。

また、$ Q $ 個の質問クエリと整数 $ K $ が与えられます。

- $ j(1≦j≦Q) $ 番目の質問クエリでは、頂点 $ x_j $ から 頂点 $ K $ を経由しつつ、頂点 $ y_j $ まで移動する場合の最短経路の距離を求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ a_1 $ $ b_1 $ $ c_1 $ $ : $ $ a_{N-1} $ $ b_{N-1} $ $ c_{N-1} $ $ Q $ $ K $ $ x_1 $ $ y_1 $ $ : $ $ x_{Q} $ $ y_{Q} $

## 输出格式

質問クエリの解答を $ Q $ 行出力せよ。   
 $ j(1≦j≦Q) $ 行目には、$ j $ 番目のクエリの答えを出力せよ。

## 说明/提示

### 制約

- $ 3≦N≦10^5 $
- $ 1≦a_i,b_i≦N\ (1≦i≦N-1) $
- $ 1≦c_i≦10^9\ (1≦i≦N-1) $
- 与えられるグラフは木である。
- $ 1≦Q≦10^5 $
- $ 1≦K≦N $
- $ 1≦x_j,y_j≦N\ (1≦j≦Q) $
- $ x_j≠y_j\ (1≦j≦Q) $
- $ x_j≠K,y_j≠K\ (1≦j≦Q) $

### Sample Explanation 1

与えられた $ 3 $ つの質問クエリに対する最短経路は以下の通りです。 - $ 1 $ つ目の質問クエリ: 頂点 $ 2 $ → 頂点 $ 1 $ → 頂点 $ 2 $ → 頂点 $ 4 $ : 距離 $ 1+1+1=3 $ - $ 2 $ つ目の質問クエリ: 頂点 $ 2 $ → 頂点 $ 1 $ → 頂点 $ 3 $ : 距離 $ 1+1=2 $ - $ 3 $ つ目の質問クエリ: 頂点 $ 4 $ → 頂点 $ 2 $ → 頂点 $ 1 $ → 頂点 $ 3 $ → 頂点 $ 5 $ : 距離 $ 1+1+1+1=4 $

### Sample Explanation 2

質問クエリに対する最短経路は、必ず頂点 $ K=2 $ を通過する必要があります。

## 样例 #1

### 输入

```
5

1 2 1

1 3 1

2 4 1

3 5 1

3 1

2 4

2 3

4 5
```

### 输出

```
3

2

4
```

## 样例 #2

### 输入

```
7

1 2 1

1 3 3

1 4 5

1 5 7

1 6 9

1 7 11

3 2

1 3

4 5

6 7
```

### 输出

```
5

14

22
```

## 样例 #3

### 输入

```
10

1 2 1000000000

2 3 1000000000

3 4 1000000000

4 5 1000000000

5 6 1000000000

6 7 1000000000

7 8 1000000000

8 9 1000000000

9 10 1000000000

1 1

9 10
```

### 输出

```
17000000000
```



---

---
title: "[ABC073D] joisino&#39;s travel"
layout: "post"
diff: 普及+/提高
pid: AT_abc073_d
tag: []
---

# [ABC073D] joisino&#39;s travel

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc073/tasks/abc073_d

Atcoder国には $ N $ 個の町があり、$ M $ 本の双方向に移動可能な道で結ばれています。

また、 $ i $ 本目の道は町 $ A_i $ と町 $ B_i $ の間を距離 $ C_i $ で結んでいます。

joisinoお姉ちゃんは、この国の $ R $ 個の町 $ r_1,r_2..r_R $ を訪れることとなりました。

最初に訪れる町までの移動と、最後に訪れる町からの移動は空路で行うが、それ以外は道を使わなければなりません。

町を訪れる順番を、道での移動距離が最小となるように決めた時の移動距離を答えてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ M $ $ R $ $ r_1 $ $ ... $ $ r_R $ $ A_1 $ $ B_1 $ $ C_1 $ $ : $ $ A_M $ $ B_M $ $ C_M $

## 输出格式

町を訪れる順番を、道での移動距離が最小となるように決めた時の移動距離を出力せよ。

## 说明/提示

### 制約

- $ 2≦N≦200 $
- $ 1≦M≦N×(N-1)/2 $
- $ 2≦R≦min(8,N) $ ( $ min(8,N) $ は $ 8 $ と $ N $ のうち小さい方)
- $ r_i≠r_j\ (i≠j) $
- $ 1≦A_i,B_i≦N\ ,\ A_i≠B_i $
- $ (A_i,B_i)≠(A_j,B_j),(A_i,B_i)≠(B_j,A_j)\ (i≠j) $
- $ 1≦C_i≦100000 $
- すべての町の間は道のみで移動することができる。
- 入力は全て整数である。

### Sample Explanation 1

例えば、町 $ 1 $ ,町 $ 2 $ ,町 $ 3 $ の順番で訪れると、移動距離が $ 2 $ となり、最小となります。

### Sample Explanation 2

町 $ 1 $ を訪れたあとに町 $ 3 $ を訪れても、町 $ 3 $ を訪れたあとに町 $ 1 $ を訪れても、町 $ 1 $ と町 $ 3 $ の間の最短距離は $ 4 $ であるため、どの順番を選んだとしても答えは $ 4 $ となります。

## 样例 #1

### 输入

```
3 3 3

1 2 3

1 2 1

2 3 1

3 1 4
```

### 输出

```
2
```

## 样例 #2

### 输入

```
3 3 2

1 3

2 3 2

1 3 6

1 2 2
```

### 输出

```
4
```

## 样例 #3

### 输入

```
4 6 3

2 3 4

1 2 4

2 3 3

4 3 1

1 4 1

4 2 2

3 1 6
```

### 输出

```
3
```



---

---
title: "[ABC075D] Axis-Parallel Rectangle"
layout: "post"
diff: 普及+/提高
pid: AT_abc075_d
tag: []
---

# [ABC075D] Axis-Parallel Rectangle

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc075/tasks/abc075_d

2次元座標上に $ N $ 個の点があります。   
 $ i(1≦i≦N) $ 番目の点の座標は $ (x_i,y_i) $ です。   
 長方形の内部に $ N $ 点のうち $ K $ 個以上の点を含みつつ、それぞれの辺がX軸かY軸に平行な長方形を考えます。  
 このとき、長方形の辺上の点は長方形の内部に含みます。   
 それらの長方形の中で、最小の面積となるような長方形の面積を求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ K $ $ x_1 $ $ y_1 $ $ : $ $ x_{N} $ $ y_{N} $

## 输出格式

条件を満たす長方形の中で最小面積となるような長方形の面積を出力せよ。

## 说明/提示

### 制約

- $ 2≦K≦N≦50 $
- $ -10^9≦x_i,y_i≦10^9\ (1≦i≦N) $
- $ x_i≠x_j\ (1≦i\ <\ j≦N) $
- $ y_i≠y_j\ (1≦i\ <\ j≦N) $
- 入力値はすべて整数である。(21:50 追記)

### Sample Explanation 1

条件を満たす最小面積となる長方形の $ 1 $ つは $ (1,1),(8,1),(1,4),(8,4) $ の $ 4 $ つの頂点で構成されます。 その面積は $ (8-1)\ ×\ (4-1)\ =\ 21 $ であるため、$ 21 $ と出力します。

### Sample Explanation 3

オーバーフローに注意してください。

## 样例 #1

### 输入

```
4 4

1 4

3 3

6 2

8 1
```

### 输出

```
21
```

## 样例 #2

### 输入

```
4 2

0 0

1 1

2 2

3 3
```

### 输出

```
1
```

## 样例 #3

### 输入

```
4 3

-1000000000 -1000000000

1000000000 1000000000

-999999999 999999999

999999999 -999999999
```

### 输出

```
3999999996000000001
```



---

---
title: "[ABC099D] Good Grid"
layout: "post"
diff: 普及+/提高
pid: AT_abc099_d
tag: []
---

# [ABC099D] Good Grid

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc099/tasks/abc099_d

$ N $ 行 $ N $ 列からなるグリッドがあり、上から $ i $ 行目の左から $ j $ 列目のマスを $ (i,j) $ とします。

これらのマスは色 $ 1 $ から 色 $ C $ までのいずれかの色で塗られていなければならず、はじめに $ (i,j) $ は色 $ c_{i,j} $ で塗られています。

グリッドが、$ 1\ \leq\ i,j,x,y\ \leq\ N $ を満たす任意の $ i,j,x,y $ に対して以下の条件を満たす場合、良いグリッドであるとします。

- $ (i+j)\ \%\ 3=(x+y)\ \%\ 3 $ ならば $ (i,j) $ の色と $ (x,y) $ の色は同じ
- $ (i+j)\ \%\ 3\ \neq\ (x+y)\ \%\ 3 $ ならば $ (i,j) $ の色と $ (x,y) $ の色は異なる

ただし、$ X\ \%\ Y $ は $ X $ を $ Y $ で割った余りを表すこととします。

グリッドが良いグリッドになるように $ 0 $ 個以上のマスを塗り替えます。

あるマスにおいて、塗り替える前の色が $ X $ であり、塗り替えた後の色が $ Y $ である場合に感じる、そのマスに対して感じる違和感は $ D_{X,Y} $ です。

すべてのマスに対して感じる違和感の和のとりうる最小値を求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ C $ $ D_{1,1} $ $ ... $ $ D_{1,C} $ $ : $ $ D_{C,1} $ $ ... $ $ D_{C,C} $ $ c_{1,1} $ $ ... $ $ c_{1,N} $ $ : $ $ c_{N,1} $ $ ... $ $ c_{N,N} $

## 输出格式

すべてのマスに対して感じる違和感の和のとりうる最小値が $ x $ のとき、$ x $ を出力せよ。

## 说明/提示

### 制約

- $ 1\ \leq\ N\ \leq\ 500 $
- $ 3\ \leq\ C\ \leq\ 30 $
- $ 1\ \leq\ D_{i,j}\ \leq\ 1000\ (i\ \neq\ j),D_{i,j}=0\ (i=j) $
- $ 1\ \leq\ c_{i,j}\ \leq\ C $
- 入力は全て整数

### Sample Explanation 1

\- $ (1,1) $ を色 $ 2 $ に塗り替えます。$ (1,1) $ に対して感じる違和感は $ D_{1,2}=1 $ となります。 - $ (1,2) $ を色 $ 3 $ に塗り替えます。$ (1,2) $ に対して感じる違和感は $ D_{2,3}=1 $ となります。 - $ (2,2) $ を色 $ 1 $ に塗り替えます。$ (2,2) $ に対して感じる違和感は $ D_{3,1}=1 $ となります。 このとき、すべてのマスに対して感じる違和感の和は $ 3 $ です。 なお、$ D_{i,j}\ \neq\ D_{j,i} $ である場合に注意してください。

## 样例 #1

### 输入

```
2 3

0 1 1

1 0 1

1 4 0

1 2

3 3
```

### 输出

```
3
```

## 样例 #2

### 输入

```
4 3

0 12 71

81 0 53

14 92 0

1 1 2 1

2 1 1 2

2 2 1 3

1 1 2 2
```

### 输出

```
428
```



---

---
title: "[ABC100D] Patisserie ABC"
layout: "post"
diff: 普及+/提高
pid: AT_abc100_d
tag: []
---

# [ABC100D] Patisserie ABC

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc100/tasks/abc100_d

高橋君はプロのパティシエになり, AtCoder Beginner Contest 100 を記念して, 「ABC洋菓子店」というお店を開いた.

ABC洋菓子店では, $ N $ 種類のケーキを売っている.  
 各種類のケーキには「綺麗さ」「おいしさ」「人気度」の $ 3 $ つの値を持ち, $ i $ 種類目のケーキの綺麗さは $ x_i $, おいしさは $ y_i $, 人気度は $ z_i $ である.  
 これらの値は $ 0 $ 以下である可能性もある.

りんごさんは, ABC洋菓子店で $ M $ 個のケーキを食べることにした. 彼は次のように, 食べるケーキの組み合わせを選ぶことにした.

- 同じ種類のケーキを $ 2 $ 個以上食べない.
- 上の条件を満たしつつ, (綺麗さの合計の絶対値) + (おいしさの合計の絶対値) + (人気度の合計の絶対値) が最大になるように選ぶ.

このとき, りんごさんが選ぶケーキの (綺麗さの合計の絶対値) + (おいしさの合計の絶対値) + (人気度の合計の絶対値) の最大値を求めなさい.

## 输入格式

入力は以下の形式で標準入力から与えられる.

> $ N $ $ M $ $ x_1 $ $ y_1 $ $ z_1 $ $ x_2 $ $ y_2 $ $ z_2 $ $ : $ $ : $ $ x_N $ $ y_N $ $ z_N $

## 输出格式

りんごさんが選ぶケーキの (綺麗さの合計の絶対値) + (おいしさの合計の絶対値) + (人気度の合計の絶対値) の最大値を出力しなさい.

## 说明/提示

### 制約

- $ N $ は $ 1 $ 以上 $ 1\ 000 $ 以下の整数
- $ M $ は $ 0 $ 以上 $ N $ 以下の整数
- $ x_i,\ y_i,\ z_i\ (1\ \leq\ i\ \leq\ N) $ は, それぞれ $ -10\ 000\ 000\ 000 $ 以上 $ 10\ 000\ 000\ 000 $ 以下の整数.

### Sample Explanation 1

$ 2,\ 4,\ 5 $ 種類目のケーキを食べることを考える. そのとき, 「綺麗さ」「おいしさ」「人気度」の合計はそれぞれ次のようになる. - 綺麗さ：$ 1\ +\ 3\ +\ 9\ =\ 13 $ - おいしさ：$ 5\ +\ 5\ +\ 7\ =\ 17 $ - 人気度：$ 9\ +\ 8\ +\ 9\ =\ 26 $ このときの (綺麗さの合計の絶対値) + (おいしさの合計の絶対値) + (人気度の合計の絶対値) は $ 13\ +\ 17\ +\ 26\ =\ 56 $ となり, これが最大になる.

### Sample Explanation 2

$ 1,\ 3,\ 5 $ 種類目のケーキを食べることを考える. そのとき, 「綺麗さ」「おいしさ」「人気度」の合計はそれぞれ次のようになる. - 綺麗さ：$ 1\ +\ 7\ +\ 13\ =\ 21 $ - おいしさ：$ (-2)\ +\ (-8)\ +\ (-14)\ =\ -24 $ - 人気度：$ 3\ +\ (-9)\ +\ 15\ =\ 9 $ このときの (綺麗さの合計の絶対値) + (おいしさの合計の絶対値) + (人気度の合計の絶対値) は $ 21\ +\ 24\ +\ 9\ =\ 54 $ となり, これが最大になる.

### Sample Explanation 3

$ 3,\ 4,\ 5,\ 7,\ 10 $ 種類目のケーキを食べると, 綺麗さの合計は $ -323 $, おいしさの合計は $ 66 $, 人気度の合計は $ 249 $ となる. このときの (綺麗さの合計の絶対値) + (おいしさの合計の絶対値) + (人気度の合計の絶対値) は $ 323\ +\ 66\ +\ 249\ =\ 638 $ となり, これが最大になる.

### Sample Explanation 4

ケーキの綺麗さ, おいしさ, 人気度や出力すべき値が, 32bit 整数に収まらない場合もある.

## 样例 #1

### 输入

```
5 3

3 1 4

1 5 9

2 6 5

3 5 8

9 7 9
```

### 输出

```
56
```

## 样例 #2

### 输入

```
5 3

1 -2 3

-4 5 -6

7 -8 -9

-10 11 -12

13 -14 15
```

### 输出

```
54
```

## 样例 #3

### 输入

```
10 5

10 -80 21

23 8 38

-94 28 11

-26 -2 18

-69 72 79

-26 -86 -54

-72 -50 59

21 65 -32

40 -94 87

-62 18 82
```

### 输出

```
638
```

## 样例 #4

### 输入

```
3 2

2000000000 -9000000000 4000000000

7000000000 -5000000000 3000000000

6000000000 -1000000000 8000000000
```

### 输出

```
30000000000
```



---

---
title: "[ABC104C] All Green"
layout: "post"
diff: 普及+/提高
pid: AT_abc104_c
tag: []
---

# [ABC104C] All Green

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc104/tasks/abc104_c

プログラミングコンペティションサイト *AtCode* は、アルゴリズムの問題集を提供しています。 それぞれの問題には、難易度に応じて点数が付けられています。 現在、$ 1 $ 以上 $ D $ 以下のそれぞれの整数 $ i $ に対して、$ 100i $ 点を付けられた問題が $ p_i $ 問存在します。 これらの $ p_1\ +\ …\ +\ p_D $ 問が AtCode に収録された問題のすべてです。

AtCode のユーザーは *総合スコア* と呼ばれる値を持ちます。 ユーザーの総合スコアは、以下の $ 2 $ つの要素の和です。

- 基本スコア: ユーザーが解いた問題すべての配点の合計です。
- コンプリートボーナス: $ 100i $ 点を付けられた $ p_i $ 問の問題すべてを解いたユーザーは、基本スコアと別にコンプリートボーナス $ c_i $ 点を獲得します $ (1\ <\ =\ i\ <\ =\ D) $。

AtCode の新たなユーザーとなった高橋くんは、まだ問題を $ 1 $ 問も解いていません。 彼の目標は、総合スコアを $ G $ 点以上にすることです。 このためには、少なくとも何問の問題を解く必要があるでしょうか？

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ D $ $ G $ $ p_1 $ $ c_1 $ $ : $ $ p_D $ $ c_D $

## 输出格式

総合スコアを $ G $ 点以上にするために解く必要のある最小の問題数を出力せよ。なお、この目標は必ず達成可能である（制約を参照のこと）。

## 说明/提示

### 制約

- $ 1\ <\ =\ D\ <\ =\ 10 $
- $ 1\ <\ =\ p_i\ <\ =\ 100 $
- $ 100\ <\ =\ c_i\ <\ =\ 10^6 $
- $ 100\ <\ =\ G $
- 入力中のすべての値は整数である。
- $ c_i,\ G $ はすべて $ 100 $ の倍数である。
- 総合スコアを $ G $ 点以上にすることは可能である。

### Sample Explanation 1

この場合、AtCode には $ 100 $ 点を付けられた問題が $ 3 $ 問、$ 200 $ 点を付けられた問題が $ 5 $ 問あります。$ 100 $ 点の $ 3 $ 問をすべて解いた際のコンプリートボーナスは $ 500 $ 点、$ 200 $ 点の $ 5 $ 問をすべて解いた際のコンプリートボーナスは $ 800 $ 点です。高橋くんの目標は総合スコアを $ 700 $ 点以上にすることです。 目標を達成する方法の一つは、$ 200 $ 点問題を $ 4 $ 問解いて $ 800 $ 点の基本スコアを得ることです。しかし、$ 100 $ 点問題を $ 3 $ 問すべて解くと、基本スコア $ 300 $ 点に加えてコンプリートボーナスの $ 500 $ 点が与えられて総合スコアが $ 800 $ 点となり、より少ない問題数で目標を達成することができます。

### Sample Explanation 2

入力例 1 と似たケースですが、今回の高橋くんの目標は $ 2000 $ 点以上です。この場合、$ 200 $ 点の $ 5 $ 問は必ずすべて解かなければならず、さらに $ 100 $ 点問題を $ 2 $ 問解くことで総合スコアが $ 2000 $ 点となります。

### Sample Explanation 3

ふたたび入力例 1 と似たケースですが、今回の高橋くんの目標は $ 400 $ 点以上です。この場合、$ 200 $ 点問題を $ 2 $ 問解くだけで目標を達成できます。

### Sample Explanation 4

$ 500 $ 点の問題が $ 1 $ 問しか存在しませんが、このような場合でもその問題を解くことでコンプリートボーナスが与えられます。

## 样例 #1

### 输入

```
2 700

3 500

5 800
```

### 输出

```
3
```

## 样例 #2

### 输入

```
2 2000

3 500

5 800
```

### 输出

```
7
```

## 样例 #3

### 输入

```
2 400

3 500

5 800
```

### 输出

```
2
```

## 样例 #4

### 输入

```
5 25000

20 1000

40 1000

50 1000

30 1000

1 1000
```

### 输出

```
66
```



---

---
title: "[ABC104D] We Love ABC"
layout: "post"
diff: 普及+/提高
pid: AT_abc104_d
tag: []
---

# [ABC104D] We Love ABC

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc104/tasks/abc104_d

文字列 $ T $ の *ABC 数* とは、以下の条件をすべて満たす整数の組 $ (i,\ j,\ k) $ の個数です。

- $ 1\ <\ =\ i\ <\ j\ <\ k\ <\ =\ |T| $（$ |T| $ は $ T $ の長さ）
- $ T_i\ = $ `A`（$ T_i $ は $ T $ の先頭から $ i $ 番目の文字）
- $ T_j\ = $ `B`
- $ T_k\ = $ `C`

例えば、$ T\ = $ `ABCBC` のとき、条件をすべて満たす組 $ (i,\ j,\ k) $ は $ (1,\ 2,\ 3),\ (1,\ 2,\ 5),\ (1,\ 4,\ 5) $ の $ 3 $ 個であるため、$ T $ の ABC 数は $ 3 $ です。

文字列 $ S $ が与えられます。$ S $ のそれぞれの文字は `A`, `B`, `C`, `?` のいずれかです。

$ S $ に含まれる `?` の個数を $ Q $ とします。$ S $ に含まれる `?` をそれぞれ `A`, `B`, `C` のいずれかに置き換えることで $ 3^Q $ 通りの文字列が作られます。これらの文字列すべての ABC 数の和を求めてください。

ただし、この和は非常に大きくなりうるため、和を $ 10^9\ +\ 7 $ で割った余りを出力してください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ S $

## 输出格式

$ 3^Q $ 通りの文字列すべての ABC 数の和を $ 10^9\ +\ 7 $ で割った余りを出力せよ。

## 说明/提示

### 制約

- $ 3\ <\ =\ |S|\ <\ =\ 10^5 $
- $ S $ のそれぞれの文字は `A`, `B`, `C`, `?` のいずれかである。

### Sample Explanation 1

この場合、$ Q\ =\ 2 $ であり、`?` をそれぞれ `A`, `B`, `C` のいずれかに置き換えることで $ 3^Q\ =\ 9 $ 通りの文字列が作られます。これらの文字列それぞれの ABC 数を以下に示します。 - `AAAC`: $ 0 $ - `AABC`: $ 2 $ - `AACC`: $ 0 $ - `ABAC`: $ 1 $ - `ABBC`: $ 2 $ - `ABCC`: $ 2 $ - `ACAC`: $ 0 $ - `ACBC`: $ 1 $ - `ACCC`: $ 0 $ これらの和は $ 0\ +\ 2\ +\ 0\ +\ 1\ +\ 2\ +\ 2\ +\ 0\ +\ 1\ +\ 0\ =\ 8 $ であり、$ 8 $ を $ 10^9\ +\ 7 $ で割った余りである $ 8 $ を出力します。

### Sample Explanation 2

$ Q\ =\ 0 $ のときは、$ S $ 自体の ABC 数を $ 10^9\ +\ 7 $ で割った余りを出力します。この文字列は問題文中で例として挙げたものと同じであり、その ABC 数は $ 3 $ です。

### Sample Explanation 3

この場合、$ 3^Q $ 通りの文字列すべての ABC 数の和は $ 2291979612924 $ であり、これを $ 10^9\ +\ 7 $ で割った余りである $ 979596887 $ を出力します。

## 样例 #1

### 输入

```
A??C
```

### 输出

```
8
```

## 样例 #2

### 输入

```
ABCBC
```

### 输出

```
3
```

## 样例 #3

### 输入

```
????C?????B??????A???????
```

### 输出

```
979596887
```



---

---
title: "[ABC106D] AtCoder Express 2"
layout: "post"
diff: 普及+/提高
pid: AT_abc106_d
tag: []
---

# [ABC106D] AtCoder Express 2

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc106/tasks/abc106_d

高橋王国には, 東西にのびる $ 1 $ 本の線路がある. これに沿って $ N $ 個の都市があり, 西から順に都市 $ 1,\ 2,\ 3,\ \cdots,\ N $ と番号づけられている.  
 AtCoder Express という会社は $ M $ 本の列車を保有しており, 列車 $ i $ は都市 $ L_i $ から都市 $ R_i $ の区間 ($ L_i\ =\ R_i $ の場合もある) を走っている.

この王国の国王である高橋君は, $ Q $ 個のことに興味を持った. 具体的には, $ i=1,\ 2,\ 3,\ \dots,\ Q $ のときの以下の質問の答えを求めたくなった.

- 都市 $ p_i $ から都市 $ q_i $ までの区間に, 走る区間が **完全に含まれる** 列車の本数. 言い換えれば, $ p_i\ \leq\ L_j $ と $ R_j\ \leq\ q_i $ が両方成り立つような列車 $ j $ の本数.

高橋君は天才である. しかし流石の彼でも, 膨大なデータを処理することはできない. 高橋君のために, $ Q $ 個の質問それぞれに対して答えを求めよ.

## 输入格式

入力は以下の形式で標準入力から与えられる.

> $ N $ $ M $ $ Q $ $ L_1 $ $ R_1 $ $ L_2 $ $ R_2 $ $ : $ $ L_M $ $ R_M $ $ p_1 $ $ q_1 $ $ p_2 $ $ q_2 $ $ : $ $ p_Q $ $ q_Q $

## 输出格式

$ Q $ 行出力せよ. $ i $ 行目には, 都市 $ p_i $ から都市 $ q_i $ までの区間に, それぞれの走る区間が完全に含まれる列車の本数を出力せよ.

## 说明/提示

### 制約

- $ N $ は $ 1 $ 以上 $ 500 $ 以下の整数
- $ M $ は $ 1 $ 以上 $ 200\ 000 $ 以下の整数
- $ Q $ は $ 1 $ 以上 $ 100\ 000 $ 以下の整数
- $ 1\ \leq\ L_i\ \leq\ R_i\ \leq\ N $ $ (1\ \leq\ i\ \leq\ M) $
- $ 1\ \leq\ p_i\ \leq\ q_i\ \leq\ N $ $ (1\ \leq\ i\ \leq\ Q) $

### Sample Explanation 1

全ての列車の走る区間が, 都市 $ 1 $ から都市 $ 2 $ までの区間に含まれているので, この質問の答えは $ 3 $ となる.

### Sample Explanation 2

$ 1 $ 個目の質問は, 都市 $ 1 $ から $ 7 $ までの区間についてである. その区間に走る区間が完全に含まれている列車は, 列車 $ 1 $ のみである. $ 2 $ 個目の質問は, 都市 $ 3 $ から $ 10 $ までの区間についてである. その区間に走る区間が完全に含まれている列車は, 列車 $ 3 $ のみである.

## 样例 #1

### 输入

```
2 3 1

1 1

1 2

2 2

1 2
```

### 输出

```
3
```

## 样例 #2

### 输入

```
10 3 2

1 5

2 8

7 10

1 7

3 10
```

### 输出

```
1

1
```

## 样例 #3

### 输入

```
10 10 10

1 6

2 9

4 5

4 7

4 7

5 8

6 6

6 7

7 9

10 10

1 8

1 9

1 10

2 8

2 9

2 10

3 8

3 9

3 10

1 10
```

### 输出

```
7

9

10

6

8

9

6

7

8

10
```



---

---
title: "[ABC110D] Factorization"
layout: "post"
diff: 普及+/提高
pid: AT_abc110_d
tag: []
---

# [ABC110D] Factorization

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc110/tasks/abc110_d

正整数 $ N,\ M $ が与えられます。

$ a_1\ \times\ a_2\ \times\ ...\ \times\ a_N\ =\ M $ となる正整数からなる長さ $ N $ の数列 $ a $ が何通りあるかを $ 10^9+7 $ で割った余りを求めてください。

ただし、数列 $ a' $ と $ a'' $ が異なるとは、ある $ i $ が存在して $ a_i'\ \neq\ a_i'' $ であることをいいます。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ M $

## 输出格式

条件を満たす正整数からなる数列が何通りあるかを $ 10^9\ +\ 7 $ で割った余りを出力せよ。

## 说明/提示

### 制約

- 入力はすべて整数である
- $ 1\ \leq\ N\ \leq\ 10^5 $
- $ 1\ \leq\ M\ \leq\ 10^9 $

### Sample Explanation 1

$ \{a_1,\ a_2\}\ =\ \{1,\ 6\},\ \{2,\ 3\},\ \{3,\ 2\},\ \{6,\ 1\} $ の $ 4 $ 通りの数列が条件を満たします。

## 样例 #1

### 输入

```
2 6
```

### 输出

```
4
```

## 样例 #2

### 输入

```
3 12
```

### 输出

```
18
```

## 样例 #3

### 输入

```
100000 1000000000
```

### 输出

```
957870001
```



---

---
title: "[ABC113D] Number of Amidakuji"
layout: "post"
diff: 普及+/提高
pid: AT_abc113_d
tag: []
---

# [ABC113D] Number of Amidakuji

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc113/tasks/abc113_d

あみだくじは, 日本に古くから伝わる伝統的なくじ引きである.

あみだくじを作るには, まず $ W $ 本の平行な縦線を引き, 次にそれらを繋ぐ横線を引いていく. それぞれの縦棒の長さは $ H+1 $ \[cm\] であり、横線の端点となれるのは上から $ 1,2,3,...,H $ \[cm\] の位置のみである.

ここで,「正しいあみだくじ」とは, 以下のような条件を満たすあみだくじのことである.

- どの $ 2 $ つの横棒も端点を共有しない.
- それぞれの横棒の $ 2 $ つの端点は同じ高さになければならない.
- 横棒は隣り合う縦線を繋がなければならない.

![ ](https://cdn.luogu.com.cn/upload/vjudge_pic/AT_abc113_d/76ad4dbaf6281d141632ee1be437fcd6eb62cf06.png)

縦棒 $ 1 $ の上端から, 横線があれば必ずそれを通るというルールで下へたどったときに, 最終的にたどり着く縦棒の番号が $ K $ となるような「正しいあみだくじ」の本数を $ 1\ 000\ 000\ 007 $ で割った余りを求めなさい.

例として, 以下のあみだくじにおいて, 最終的にたどり着く縦棒の番号は $ 4 $ である.

![ ](https://cdn.luogu.com.cn/upload/vjudge_pic/AT_abc113_d/798f2b4676c5cd94b2fff66ef18034da71e67ad6.png)

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ H $ $ W $ $ K $

## 输出格式

条件を満たすあみだくじの本数を $ 1\ 000\ 000\ 007 $ で割った余りを出力しなさい.

## 说明/提示

### 制約

- $ H $ は $ 1 $ 以上 $ 100 $ 以下の整数
- $ W $ は $ 1 $ 以上 $ 8 $ 以下の整数
- $ K $ は $ 1 $ 以上 $ W $ 以下の整数

### Sample Explanation 1

以下の $ 1 $ 個のあみだくじのみが条件を満たす. !\[ \](https://img.atcoder.jp/abc113/c68c6daccfc4cba8bc94af5f1a80ef2f.png)

### Sample Explanation 2

以下の $ 2 $ 個のあみだくじのみが条件を満たす. !\[ \](https://img.atcoder.jp/abc113/4be150946de8bef9b14d9bc17814d963.png)

### Sample Explanation 3

以下の $ 1 $ 個のあみだくじのみが条件を満たす. !\[ \](https://img.atcoder.jp/abc113/9b2e9f49832458c3488b1e04afd51ed4.png)

### Sample Explanation 4

以下の $ 5 $ 個のあみだくじのみが条件を満たす. !\[ \](https://img.atcoder.jp/abc113/bf6ec766f8923ac2f082f538a6c736b6.png)

### Sample Explanation 5

縦線が $ 1 $ 本しかないので, 横線をそもそも引くことができない. よって条件を満たすあみだくじは「一本も横線を引かない」の $ 1 $ 通りしかない.

### Sample Explanation 6

答えを $ 1\ 000\ 000\ 007 $ で割った余りを出力すること.

## 样例 #1

### 输入

```
1 3 2
```

### 输出

```
1
```

## 样例 #2

### 输入

```
1 3 1
```

### 输出

```
2
```

## 样例 #3

### 输入

```
2 3 3
```

### 输出

```
1
```

## 样例 #4

### 输入

```
2 3 1
```

### 输出

```
5
```

## 样例 #5

### 输入

```
7 1 1
```

### 输出

```
1
```

## 样例 #6

### 输入

```
15 8 5
```

### 输出

```
437760187
```



---

---
title: "[ABC114D] 756"
layout: "post"
diff: 普及+/提高
pid: AT_abc114_d
tag: []
---

# [ABC114D] 756

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc114/tasks/abc114_d

整数 $ N $ が与えられます。$ N! $ $ (=\ 1\ \times\ 2\ \times\ ...\ \times\ N) $ の約数のうち、*七五数* は何個あるでしょうか？

ここで、七五数とは約数をちょうど $ 75 $ 個持つ正の整数です。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $

## 输出格式

$ N! $ の約数であるような七五数の個数を出力せよ。

## 说明/提示

### 注記

正の整数 $ A $ が正の整数 $ B $ を割り切るとき、$ A $ を $ B $ の *約数* といいます。 例えば、$ 6 $ の約数は $ 1,2,3,6 $ の $ 4 $ 個です。

### 制約

- $ 1\ \leq\ N\ \leq\ 100 $
- $ N $ は整数である。

### Sample Explanation 1

$ 9!\ =\ 1\ \times\ 2\ \times\ ...\ \times\ 9\ =\ 362880 $ の約数に七五数はありません。

### Sample Explanation 2

$ 10!\ =\ 3628800 $ の約数のうち、七五数であるのは $ 32400 $ の $ 1 $ 個です。

## 样例 #1

### 输入

```
9
```

### 输出

```
0
```

## 样例 #2

### 输入

```
10
```

### 输出

```
1
```

## 样例 #3

### 输入

```
100
```

### 输出

```
543
```



---

---
title: "[ABC116D] Various Sushi"
layout: "post"
diff: 普及+/提高
pid: AT_abc116_d
tag: []
---

# [ABC116D] Various Sushi

## 题目描述

现有 $N$ 个寿司。每个寿司有两个参数：“寿司种类” $t_i$ 和 “美味程度” $d_i$。您现在需要在这 $N$ 个寿司中选择吃 $K$ 个。您的 “满足感” 会被按照如下标准计算：

- 满足感是 “基础美味程度总和” 和 “多样性加成” 数值的总和。

- “基础美味程度总和” 指的是你吃的所有寿司的美味程度的总和。

- “多样性加成” 是 $x \times x$，其中 $x$ 是你吃的寿司种类 （即一共有多少种 $t$）。

您现在想要得到最大的 “满足感”。找到这个 “满足感” 的最大值。

## 输入格式

第一行为两个整数 $N$ 和 $K$。

接下来从第 $2$ 行到第 $N + 1$ 行，第 $i$ 行两个整数 $t_i$ 和 $d_i$，分别代表第 $i$ 种寿司的寿司种类和美味程度。

## 输出格式

输出您可以得到的 “满足感” 的最大值。

## 说明/提示

- $1 \leq K \leq N \leq 10 ^ 5$

- $1 \leq t_i \leq N$

- $1 \leq d_i \leq 10 ^ 9$

- 所有输入数据均为整数

### 样例解释 1

吃第 $1,2,3$ 个寿司时，“基础美味程度总和” 为 $9 + 7 + 6 = 22$，“多样性加成” 为 $2 \times 2 = 4$ ，得到 “满足感” 最大值为 $26$ ，可以验证不存在更好的吃法。

### 样例解释 2

吃第 $1,2,3,4$ 个寿司，可以验证不存在更好的吃法。

### 样例解释 3

注意数据可能会爆 $int$

### 样例解释 4、5、6

同上

## 样例 #1

### 输入

```
5 3

1 9

1 7

2 6

2 5

3 1
```

### 输出

```
26
```

## 样例 #2

### 输入

```
7 4

1 1

2 1

3 1

4 6

4 5

4 5

4 5
```

### 输出

```
25
```

## 样例 #3

### 输入

```
6 5

5 1000000000

2 990000000

3 980000000

6 970000000

6 960000000

4 950000000
```

### 输出

```
4900000016
```



---

---
title: "[ABC117D] XXOR"
layout: "post"
diff: 普及+/提高
pid: AT_abc117_d
tag: []
---

# [ABC117D] XXOR

## 题目描述

有n个数$a_1,a_2……a_n$和一个数k，$\oplus$表示按位异或。对于$0\leq x\leq k，f(x)=(x \oplus a_1)+(x \oplus a_2)……(x \oplus a_n)$。求$f_{max}$为多少。

## 输入格式

一行两个数n，m，接下来一行m个用空格隔开的整数$x_1,x_2……x_n$。

## 输出格式

一行一个数表示答案。

## 说明/提示

$1\leq n\leq 10^5,0\leq k,a_i\leq 10^{12}$

## 样例 #1

### 输入

```
3 7

1 6 3
```

### 输出

```
14
```

## 样例 #2

### 输入

```
4 9

7 4 0 3
```

### 输出

```
46
```

## 样例 #3

### 输入

```
1 0

1000000000000
```

### 输出

```
1000000000000
```



---

---
title: "[ABC119D] Lazy Faith"
layout: "post"
diff: 普及+/提高
pid: AT_abc119_d
tag: []
---

# [ABC119D] Lazy Faith

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc119/tasks/abc119_d

東西方向に伸びる道路に沿って $ A $ 社の神社と $ B $ 軒の寺が建っています。 西から $ i $ 社目の神社は道路の西端から $ s_i $ メートルの地点に、西から $ i $ 軒目の寺は道路の西端から $ t_i $ メートルの地点にあります。

以下の $ Q $ 個の問いに答えてください。

問 $ i $ ($ 1\ \leq\ i\ \leq\ Q $): 道路の西端から $ x_i $ メートルの地点から出発して道路上を自由に移動するとき、神社一社と寺一軒を訪れるのに必要な最小の移動距離は何メートルか？ (必要数を超えた数の寺社を通過してもよい。)

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ A $ $ B $ $ Q $ $ s_1 $ $ : $ $ s_A $ $ t_1 $ $ : $ $ t_B $ $ x_1 $ $ : $ $ x_Q $

## 输出格式

$ Q $ 行出力せよ。$ i $ 行目に問 $ i $ への答えを出力すること。

## 说明/提示

### 制約

- $ 1\ \leq\ A,\ B\ \leq\ 10^5 $
- $ 1\ \leq\ Q\ \leq\ 10^5 $
- $ 1\ \leq\ s_1\ <\ s_2\ <\ ...\ <\ s_A\ \leq\ 10^{10} $
- $ 1\ \leq\ t_1\ <\ t_2\ <\ ...\ <\ t_B\ \leq\ 10^{10} $
- $ 1\ \leq\ x_i\ \leq\ 10^{10} $
- $ s_1,\ ...,\ s_A,\ t_1,\ ...,\ t_B,\ x_1,\ ...,\ x_Q $ はすべて異なる。
- 入力される値はすべて整数である。

### Sample Explanation 1

$ 2 $ 社の神社と $ 3 $ 軒の寺があり、神社は道路の西端から $ 100,\ 600 $ メートルの地点に、寺は道路の西端から $ 400,\ 900,\ 1000 $ メートルの地点にあります。 - 問 $ 1 $: 道路の西端から $ 150 $ メートルの地点から出発する場合、まず西に $ 50 $ メートル進んで神社を訪れ、次に東に $ 300 $ メートル進んで寺を訪れるのが最適です。 - 問 $ 2 $: 道路の西端から $ 2000 $ メートルの地点から出発する場合、まず西に $ 1000 $ メートル進んで寺を訪れ、次に西に $ 400 $ メートル進んで神社を訪れるのが最適です。途中で寺をもう一軒通過しますが、構いません。 - 問 $ 3 $: 道路の西端から $ 899 $ メートルの地点から出発する場合、まず東に $ 1 $ メートル進んで寺を訪れ、次に西に $ 300 $ メートル進んで神社を訪れるのが最適です。 - 問 $ 4 $: 道路の西端から $ 799 $ メートルの地点から出発する場合、まず西に $ 199 $ メートル進んで神社を訪れ、次に西に $ 200 $ メートル進んで寺を訪れるのが最適です。

### Sample Explanation 2

道路は長く、$ 32 $ ビット整数に収まらない距離を移動する必要があるかもしれません。

## 样例 #1

### 输入

```
2 3 4

100

600

400

900

1000

150

2000

899

799
```

### 输出

```
350

1400

301

399
```

## 样例 #2

### 输入

```
1 1 3

1

10000000000

2

9999999999

5000000000
```

### 输出

```
10000000000

10000000000

14999999998
```



---

---
title: "[ABC122D] We Like AGC"
layout: "post"
diff: 普及+/提高
pid: AT_abc122_d
tag: []
---

# [ABC122D] We Like AGC

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc122/tasks/abc122_d

整数 $ N $ が与えられます。次の条件を満たす長さ $ N $ の文字列の数を $ 10^9+7 $ で割った余りを求めてください。

- `A`, `C`, `G`, `T` 以外の文字を含まない。
- `AGC` を部分文字列として含まない。
- 隣接する $ 2 $ 文字の入れ替えを $ 1 $ 回行うことで上記の条件に違反させることはできない。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $

## 输出格式

条件を満たす文字列の数を $ 10^9+7 $ で割った余りを出力せよ。

## 说明/提示

### 注記

文字列 $ T $ の部分文字列とは、$ T $ の先頭と末尾から $ 0 $ 文字以上を取り去って得られる文字列です。

例えば、`ATCODER` の部分文字列には `TCO`, `AT`, `CODER`, `ATCODER`, `` (空文字列) が含まれ、`AC` は含まれません。

### 制約

- $ 3\ \leq\ N\ \leq\ 100 $

### Sample Explanation 1

`A`, `C`, `G`, `T` 以外の文字を含まない長さ $ 3 $ の文字列は $ 4^3\ =\ 64 $ 通り存在し、そのうち `AGC`, `ACG`, `GAC` のみが条件に違反するため、答えは $ 64\ -\ 3\ =\ 61 $ 通りです。

### Sample Explanation 3

文字列の数を $ 10^9+7 $ で割った余りを出力することをお忘れなく。

## 样例 #1

### 输入

```
3
```

### 输出

```
61
```

## 样例 #2

### 输入

```
4
```

### 输出

```
230
```

## 样例 #3

### 输入

```
100
```

### 输出

```
388130742
```



---

---
title: "[ABC123D] Cake 123"
layout: "post"
diff: 普及+/提高
pid: AT_abc123_d
tag: []
---

# [ABC123D] Cake 123

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc123/tasks/abc123_d

AtCoder 洋菓子店は数字の形をしたキャンドルがついたケーキを販売しています。  
 ここには $ 1,\ 2,\ 3 $ の形をしたキャンドルがついたケーキがそれぞれ $ X $ 種類、$ Y $ 種類、$ Z $ 種類あります。  
 それぞれのケーキには「美味しさ」という整数の値が以下のように割り当てられています。

- $ 1 $ の形のキャンドルがついたケーキの美味しさはそれぞれ $ A_1,\ A_2,\ ...,\ A_X $
- $ 2 $ の形のキャンドルがついたケーキの美味しさはそれぞれ $ B_1,\ B_2,\ ...,\ B_Y $
- $ 3 $ の形のキャンドルがついたケーキの美味しさはそれぞれ $ C_1,\ C_2,\ ...,\ C_Z $

高橋君は ABC 123 を記念するために、$ 1,\ 2,\ 3 $ の形のキャンドルがついたケーキを $ 1 $ つずつ買うことにしました。  
 そのようにケーキを買う方法は $ X\ \times\ Y\ \times\ Z $ 通りあります。

これらの選び方を $ 3 $ つのケーキの美味しさの合計が大きい順に並べたとき、$ 1,\ 2,\ ...,\ K $ 番目の選び方でのケーキの美味しさの合計をそれぞれ出力してください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ X $ $ Y $ $ Z $ $ K $ $ A_1\ A_2\ A_3\ ...\ A_X $ $ B_1\ B_2\ B_3\ ...\ B_Y $ $ C_1\ C_2\ C_3\ ...\ C_Z $

## 输出格式

$ i $ 行目に、問題文中の $ i $ 番目の値を出力せよ。

## 说明/提示

### 制約

- $ 1\ \leq\ X\ \leq\ 1\ 000 $
- $ 1\ \leq\ Y\ \leq\ 1\ 000 $
- $ 1\ \leq\ Z\ \leq\ 1\ 000 $
- $ 1\ \leq\ K\ \leq\ \min(3\ 000,\ X\ \times\ Y\ \times\ Z) $
- $ 1\ \leq\ A_i\ \leq\ 10\ 000\ 000\ 000 $
- $ 1\ \leq\ B_i\ \leq\ 10\ 000\ 000\ 000 $
- $ 1\ \leq\ C_i\ \leq\ 10\ 000\ 000\ 000 $
- 入力中の値はすべて整数である。

### Sample Explanation 1

$ 3 $ つのケーキの選び方は $ 2\ \times\ 2\ \times\ 2\ =\ 8 $ 通りあり、それらをケーキの美味しさの合計が大きい順に並べると以下の通りです。 - $ (A_2,\ B_2,\ C_2) $: $ 6\ +\ 5\ +\ 8\ =\ 19 $ - $ (A_1,\ B_2,\ C_2) $: $ 4\ +\ 5\ +\ 8\ =\ 17 $ - $ (A_2,\ B_1,\ C_2) $: $ 6\ +\ 1\ +\ 8\ =\ 15 $ - $ (A_2,\ B_2,\ C_1) $: $ 6\ +\ 5\ +\ 3\ =\ 14 $ - $ (A_1,\ B_1,\ C_2) $: $ 4\ +\ 1\ +\ 8\ =\ 13 $ - $ (A_1,\ B_2,\ C_1) $: $ 4\ +\ 5\ +\ 3\ =\ 12 $ - $ (A_2,\ B_1,\ C_1) $: $ 6\ +\ 1\ +\ 3\ =\ 10 $ - $ (A_1,\ B_1,\ C_1) $: $ 4\ +\ 1\ +\ 3\ =\ 8 $

### Sample Explanation 2

美味しさの合計が同じになる組み合わせが複数ある可能性もあります。例えば、このテストケースで $ (A_1,\ B_3,\ C_3) $ を選ぶときと $ (A_3,\ B_3,\ C_1) $ を選ぶときはともに、美味しさの合計が $ 301 $ となります。 しかし、これらは異なる選び方であるため、出力には $ 301 $ が $ 2 $ 回出現します。

### Sample Explanation 3

入力・出力は $ 32 $ ビット整数に収まらない可能性があることに注意してください。

## 样例 #1

### 输入

```
2 2 2 8

4 6

1 5

3 8
```

### 输出

```
19

17

15

14

13

12

10

8
```

## 样例 #2

### 输入

```
3 3 3 5

1 10 100

2 20 200

1 10 100
```

### 输出

```
400

310

310

301

301
```

## 样例 #3

### 输入

```
10 10 10 20

7467038376 5724769290 292794712 2843504496 3381970101 8402252870 249131806 6310293640 6690322794 6082257488

1873977926 2576529623 1144842195 1379118507 6003234687 4925540914 3902539811 3326692703 484657758 2877436338

4975681328 8974383988 2882263257 7690203955 514305523 6679823484 4263279310 585966808 3752282379 620585736
```

### 输出

```
23379871545

22444657051

22302177772

22095691512

21667941469

21366963278

21287912315

21279176669

21160477018

21085311041

21059876163

21017997739

20703329561

20702387965

20590247696

20383761436

20343962175

20254073196

20210218542

20150096547
```



---

---
title: "[ABC127F] Absolute Minima"
layout: "post"
diff: 普及+/提高
pid: AT_abc127_f
tag: []
---

# [ABC127F] Absolute Minima

## 题目描述

有一个函数 $f(x)$ ，初始时 $f(x)=0$

接下来你会对这个函数进行 $Q$ 次以下操作：

- $\texttt{1 a b}$，将 $f(x)$ 替换为 $g(x)=f(x)+|x-a|+b$
- $\texttt{2}$，询问最小的整数 $x$ ，使得  $f(x)$ 取到最小值，以及 $f(x)$ 的最小值

## 输入格式

第一行一个整数 $Q$

接下来 $Q$ 行，每行一个或三个整数，表示一次操作。

## 输出格式

对于每一次询问，输出一行两个整数，分别表示最小的整数 $x$ ，使得 $f(x)$ 取到最小值，和 $f(x)$ 的最小值

## 说明/提示

$1 \le Q \le 200000,-10^9 \le a,b \le 10^9$ ，保证第一次操作一定是修改操作

## 样例 #1

### 输入

```
4

1 4 2

2

1 1 -8

2
```

### 输出

```
4 2

1 -3
```

## 样例 #2

### 输入

```
4

1 -1000000000 1000000000

1 -1000000000 1000000000

1 -1000000000 1000000000

2
```

### 输出

```
-1000000000 3000000000
```



---

---
title: "[ABC128D] equeue"
layout: "post"
diff: 普及+/提高
pid: AT_abc128_d
tag: []
---

# [ABC128D] equeue

## 题目描述

有一个双端队列，初始时队列中共有 $n$ 个元素，元素从头到尾的权值为 $v_{1},v_{2},\cdots,v_{n}$

你可以进行不超过 $k$ 次操作（也可以一次都不操作），每次操作可以选择队头或队尾的一个元素，将它归为己有，或将自己手上的一个元素塞到队头或队尾

问最终你手上所有元素的权值之和的最大值是多少

## 输入格式

第一行两个整数 $n,k$

接下来一行 $n$ 个整数表示 $v_{i}$

## 输出格式

一行一个整数，表示答案

## 说明/提示

$ 1 \le n \le 50,1 \le k \le 100, -10^7 \le v_{i} \le 10^7 $

## 样例 #1

### 输入

```
6 4

-10 8 2 1 2 6
```

### 输出

```
14
```

## 样例 #2

### 输入

```
6 4

-6 -100 50 -2 -5 -3
```

### 输出

```
44
```

## 样例 #3

### 输入

```
6 3

-6 -100 50 -2 -5 -3
```

### 输出

```
0
```



---

---
title: "[ABC128E] Roadwork"
layout: "post"
diff: 普及+/提高
pid: AT_abc128_e
tag: []
---

# [ABC128E] Roadwork

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc128/tasks/abc128_e

東西に無限に続く $ 1 $ 本の大通りがあり、数直線とみなすことができます。

この大通り上で $ N $ 回道路工事が行われます。 $ i $ 番目の道路工事は時刻 $ S_i\ -\ 0.5 $ から時刻 $ T_i\ -\ 0.5 $ まで座標 $ X_i $ を通行止めにします。

$ Q $ 人の人が座標 $ 0 $ に立っています。 $ i $ 番目の人は時刻 $ D_i $ に座標 $ 0 $ を出発し、速度 $ 1 $ で正の方向へ歩き続けます。 歩いている途中で通行止めとなっている地点に到達した場合には、そこで歩くのをやめます。

$ Q $ 人それぞれが進む距離を求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ Q $ $ S_1 $ $ T_1 $ $ X_1 $ $ : $ $ S_N $ $ T_N $ $ X_N $ $ D_1 $ $ : $ $ D_Q $

## 输出格式

$ Q $ 行出力せよ。

$ i $ 行目には $ i $ 番目の人が進む距離を出力せよ。 ただし $ i $ 番目の人が無限に歩き続ける場合は、代わりに $ -1 $ を出力せよ。

## 说明/提示

### 制約

- 入力は全て整数
- $ 1\ \leq\ N,\ Q\ \leq\ 2\ \times\ 10^5 $
- $ 0\ \leq\ S_i\ <\ T_i\ \leq\ 10^9 $
- $ 1\ \leq\ X_i\ \leq\ 10^9 $
- $ 0\ \leq\ D_1\ <\ D_2\ <\ ...\ <\ D_Q\ \leq\ 10^9 $
- $ i\ \neq\ j $ かつ $ X_i\ =\ X_j $ の時、区間 $ [S_i,\ T_i) $ と 区間 $ [S_j,\ T_j) $ は重ならない

### Sample Explanation 1

$ 1 $ 番目の人は時刻 $ 0 $ に座標 $ 0 $ を出発し、時刻 $ 2 $ に座標 $ 2 $ に到着した時点で、$ 1 $ 番目の道路工事による通行止めによって歩くのをやめます。 $ 2 $ 番目の人は時刻 $ 1 $ に座標 $ 0 $ を出発し、時刻 $ 3 $ に座標 $ 2 $ に到着します。この時、$ 1 $ 番目の道路工事は既に終了していますが、$ 4 $ 番目の道路工事が始まっているため、同様に座標 $ 2 $ で歩くのをやめます。 $ 4 $ 番目および $ 6 $ 番目の人は、歩いている最中に通行止めに出くわさないため、無限に歩き続けます。

## 样例 #1

### 输入

```
4 6

1 3 2

7 13 10

18 20 13

3 4 2

0

1

2

3

5

8
```

### 输出

```
2

2

10

-1

13

-1
```



---

---
title: "[ABC129E] Sum Equals Xor"
layout: "post"
diff: 普及+/提高
pid: AT_abc129_e
tag: []
---

# [ABC129E] Sum Equals Xor

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc129/tasks/abc129_e

正整数 $ L $ が二進数表記で与えられます。 以下の条件を満たす非負整数 $ a,\ b $ の組 $ (a,\ b) $ がいくつ存在するか求めてください:

- $ a\ +\ b\ \leq\ L $
- $ a\ +\ b\ =\ a\ \text{\ XOR\ }\ b $

ただし、この値は非常に大きくなることがあるので、$ 10^9\ +\ 7 $ で割った余りを出力してください。

XOR とは

整数 $ A,\ B $ のビットごとの排他的論理和 $ a\ \text{\ XOR\ }\ b $ は、以下のように定義されます。

$ a\ \text{\ XOR\ }\ b $ を二進数表記した際の $ 2^k $ ($ k\ \geq\ 0 $) の位の数は、$ A,\ B $ を二進数表記した際の $ 2^k $ の位の数のうち一方のみが $ 1 $ であれば $ 1 $、そうでなければ $ 0 $ である。 例えば、$ 3\ \text{\ XOR\ }\ 5\ =\ 6 $ となります (二進数表記すると: $ 011\ \text{\ XOR\ }\ 101\ =\ 110 $)。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ L $

## 输出格式

条件を満たす組 $ (a,\ b) $ の個数を $ 10^9\ +\ 7 $ で割った余りを出力せよ。

## 说明/提示

### 制約

- $ L $は二進数表記で与えられ、先頭文字は必ず $ 1 $ である
- $ 1\ \leq\ L\ <\ 2^{100,001} $

### Sample Explanation 1

条件を満たす $ (a,\ b) $ としては $ (0,\ 0),\ (0,\ 1),\ (1,\ 0),\ (0,\ 2),\ (2,\ 0) $ の $ 5 $ つが考えられます。

## 样例 #1

### 输入

```
10
```

### 输出

```
5
```

## 样例 #2

### 输入

```
1111111111111111111
```

### 输出

```
162261460
```



---

---
title: "[ABC130E] Common Subsequence"
layout: "post"
diff: 普及+/提高
pid: AT_abc130_e
tag: []
---

# [ABC130E] Common Subsequence

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc130/tasks/abc130_e

$ 1 $ 以上 $ 10^5 $ 以下の整数から成る、長さ $ N $ の整数列 $ S $ と 長さ $ M $ の整数列 $ T $ が与えられます。

$ S $ の部分列と $ T $ の部分列の組であって、整数列として等しいような組は何通りあるでしょうか。

ただし、整数列 $ A $ の部分列とは、$ A $ の要素を $ 0 $ 個以上いくつか選んで削除し、残ったものを元の順序を保って並べた整数列を表します。

また、$ S,\ T $ それぞれの部分列は、整数列として等しい場合でも、削除した要素の添字の集合が異なる場合には異なる部分列として区別してください。

答えは非常に大きくなることがあるので、$ 10^9+7 $ で割った余りを出力してください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ M $ $ S_1 $ $ S_2 $ $ ... $ $ S_{N-1} $ $ S_{N} $ $ T_1 $ $ T_2 $ $ ... $ $ T_{M-1} $ $ T_{M} $

## 输出格式

整数列として等しいような、$ S,\ T $ の部分列の組の個数を $ 10^9+7 $ で割った余りを出力せよ。

## 说明/提示

### 制約

- $ 1\ \leq\ N,\ M\ \leq\ 2\ \times\ 10^3 $
- $ S $ の長さは $ N $ である
- $ T $ の長さは $ M $ である
- $ 1\ \leq\ S_i,\ T_i\ \leq\ 10^5 $
- 入力は全て整数である

### Sample Explanation 1

$ S $ の部分列としては $ (),\ (1),\ (3),\ (1,\ 3) $ が考えられます。 $ T $ の部分列としては $ (),\ (3),\ (1),\ (3,\ 1) $ が考えられます。 共に部分列が $ () $ である組は $ 1\ \times\ 1 $ 通り、共に部分列が $ (1) $ である組は $ 1\ \times\ 1 $ 通り、共に部分列が $ (3) $ である組は $ 1\ \times\ 1 $ 通り考えられるので、合計 $ 3 $ 通りの組が存在します。

### Sample Explanation 2

$ S $ の部分列としては $ (),\ (1),\ (1),\ (1,\ 1) $ が考えられます。 $ T $ の部分列としては $ (),\ (1),\ (1),\ (1,\ 1) $ が考えられます。 共に部分列が $ () $ である組は $ 1\ \times\ 1 $ 通り、共に部分列が $ (1) $ である組は $ 2\ \times\ 2 $ 通り、共に部分列が $ (1,\ 1) $ である組は $ 1\ \times\ 1 $ 通り考えられるので、合計 $ 6 $ 通りの組が存在します。 部分列において削除する要素の添字の集合が異なるものを区別することに注意してください。

### Sample Explanation 5

個数を $ 10^9+7 $ で割った余りを出力することに注意してください。

## 样例 #1

### 输入

```
2 2

1 3

3 1
```

### 输出

```
3
```

## 样例 #2

### 输入

```
2 2

1 1

1 1
```

### 输出

```
6
```

## 样例 #3

### 输入

```
4 4

3 4 5 6

3 4 5 6
```

### 输出

```
16
```

## 样例 #4

### 输入

```
10 9

9 6 5 7 5 9 8 5 6 7

8 6 8 5 5 7 9 9 7
```

### 输出

```
191
```

## 样例 #5

### 输入

```
20 20

1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1

1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1
```

### 输出

```
846527861
```



---

---
title: "[ABC131E] Friendships"
layout: "post"
diff: 普及+/提高
pid: AT_abc131_e
tag: []
---

# [ABC131E] Friendships

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc131/tasks/abc131_e

以下の条件を満たす $ N $ 頂点の無向グラフは存在するでしょうか？

- グラフは単純かつ連結である。
- 各頂点には $ 1,\ 2,\ ...,\ N $ の番号が付けられている。
- グラフの辺数を $ M $ としたとき、各辺には $ 1,\ 2,\ ...,\ M $ の番号が付けられていて、辺 $ i $ は頂点 $ u_i $ と頂点 $ v_i $ をつなぐ長さ $ 1 $ の辺である。
- 最短距離が $ 2 $ であるような頂点対 $ (i,\ j)\ (i\ <\ j) $ が、ちょうど $ K $ 個存在する。

条件を満たすグラフが存在するならば $ 1 $ つ構築してください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ K $

## 输出格式

条件を満たすグラフが存在しなければ `-1` を出力せよ。

存在するならば、そのようなグラフを $ 1 $ つ、以下の形式で出力せよ (記号の意味は問題文を参照せよ)。

> $ M $ $ u_1 $ $ v_1 $ $ : $ $ u_M $ $ v_M $

条件を満たすグラフが複数存在する場合、どれを出力してもよい。

## 说明/提示

### 制約

- 入力は全て整数である。
- $ 2\ \leq\ N\ \leq\ 100 $
- $ 0\ \leq\ K\ \leq\ \frac{N(N\ -\ 1)}{2} $

### Sample Explanation 1

このグラフには最短距離が $ 2 $ であるような頂点対が $ (1,\ 4),\ (2,\ 4),\ (3,\ 5) $ の $ 3 $ 個存在します。よって条件を満たしています。

### Sample Explanation 2

条件を満たすグラフは存在しません。

## 样例 #1

### 输入

```
5 3
```

### 输出

```
5

4 3

1 2

3 1

4 5

2 3
```

## 样例 #2

### 输入

```
5 8
```

### 输出

```
-1
```



---

---
title: "[ABC132D] Blue and Red Balls"
layout: "post"
diff: 普及+/提高
pid: AT_abc132_d
tag: []
---

# [ABC132D] Blue and Red Balls

## 题目描述

有 $K$ 个蓝球和 $N-K$ 个红球。同一颜色的球是完全相同的。Snuke 和 Takahashi 在玩这些球。

首先，Snuke 将把 $N$ 个球从左到右排成一排。

然后，Takahashi 将收走 $K$ 个蓝球。在一次操作中，他可以收走连续的一个区间的蓝球。他将以最少的操作数收走所有蓝球。

Snuke 有多少种排列这 $N$ 个球的方法，使得 Takahashi 恰好操作 $i$ 次才能收走所有的 $K$ 个蓝球？对于每个 $i$（$1\le i\le K$）计算排列数对 $10^9+7$ 取模的结果。

------------

## 输入格式

$N\ K$

------------

## 输出格式

输出 $K$ 行。第 $i$ 行（$1\le i\le K$）表示有多少种排列这 $N$ 个球的方法，使得 Takahashi 恰好操作 $i$ 次才能收走所有的 $K$ 个蓝球，对 $10^9+7$ 取模。

------------

## 说明/提示

#### 样例解释 1
有三种方法来排列球，使得 Takahashi 恰好操作 $1$ 次：$(B, B, B, R, R)$，$(R, B, B, B, R)$ 和 $(R, R, B, B, B)$。（$R$ 和 $B$ 分别代表红色和蓝色）。

有六种方法来排列球，使得 Takahashi 恰好操作 $2$ 次：$(B, B, R, B, R)$，$(B, B, R, R, B)$，$(R, B, B, R, B)$，$(R, B, B, R, B)$，$(B, R, B, B, R)$，和 $(B, R, R, B, B)$。

有一种方法来排列球，使得 Takahashi 恰好操作 $3$ 次：$(B, R, B, R, B)$。

#### 样例解释 2
务必输出对 $10^9+7$ 的排列数。

## 样例 #1

### 输入

```
5 3
```

### 输出

```
3

6

1
```

## 样例 #2

### 输入

```
2000 3
```

### 输出

```
1998

3990006

327341989
```



---

---
title: "[ABC132E] Hopscotch Addict"
layout: "post"
diff: 普及+/提高
pid: AT_abc132_e
tag: []
---

# [ABC132E] Hopscotch Addict

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc132/tasks/abc132_e

ケンくんはけんけんぱが大好きです。今日は有向グラフ $ G $ の上でけんけんぱをすることにしました。 $ G $ は $ 1 $ から $ N $ で番号付けされた $ N $ 頂点および $ M $ 辺からなり、 $ i $ 番目の辺は頂点 $ u_i $ から頂点 $ v_i $ に接続しています。

ケンくんははじめ頂点 $ S $ にいて、頂点 $ T $ までけんけんぱで移動したいです。 $ 1 $ 回のけんけんぱでは、「自分の今いる頂点から出ている辺を $ 1 $ つ選んで、その辺が接続する頂点に移動する」という操作をちょうど $ 3 $ 回連続で行います。

ケンくんが頂点 $ T $ に移動することができるか、また移動できるなら最小何回のけんけんぱで頂点 $ T $ まで移動することができるかを答えてください。 けんけんぱの操作の途中で頂点 $ T $ に訪れても、「頂点 $ T $ に移動できた」とは見なさないことに注意してください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ M $ $ u_1 $ $ v_1 $ $ : $ $ u_M $ $ v_M $ $ S $ $ T $

## 输出格式

何回けんけんぱを繰り返しても頂点 $ S $ から頂点 $ T $ へ移動できない場合には、$ -1 $ を出力せよ。 移動できる場合には、移動するのに必要なけんけんぱの最小回数を出力せよ。

## 说明/提示

### 制約

- $ 2\ \leq\ N\ \leq\ 10^5 $
- $ 0\ \leq\ M\ \leq\ \min(10^5,\ N\ (N-1)) $
- $ 1\ \leq\ u_i,\ v_i\ \leq\ N(1\ \leq\ i\ \leq\ M) $
- $ u_i\ \neq\ v_i\ (1\ \leq\ i\ \leq\ M) $
- $ i\ \neq\ j $ ならば $ (u_i,\ v_i)\ \neq\ (u_j,\ v_j) $
- $ 1\ \leq\ S,\ T\ \leq\ N $
- $ S\ \neq\ T $

### Sample Explanation 1

$ 1 $ 回目のけんけんぱでは $ 1\ \rightarrow\ 2\ \rightarrow\ 3\ \rightarrow\ 4 $、$ 2 $ 回目のけんけんぱでは $ 4\ \rightarrow\ 1\ \rightarrow\ 2\ \rightarrow\ 3 $ と移動することで頂点 $ 3 $ に辿り着くことができ、これが最小回数です。

### Sample Explanation 2

何回けんけんぱを繰り返しても頂点 $ 1 $ に辿り着くため、頂点 $ 2 $ に移動することは不可能です。 けんけんぱの途中で頂点 $ 2 $ を通過することはできますが、これは移動できたとは見なしません。

### Sample Explanation 3

頂点 $ S $ と頂点 $ T $ は非連結である場合があります。

## 样例 #1

### 输入

```
4 4

1 2

2 3

3 4

4 1

1 3
```

### 输出

```
2
```

## 样例 #2

### 输入

```
3 3

1 2

2 3

3 1

1 2
```

### 输出

```
-1
```

## 样例 #3

### 输入

```
2 0

1 2
```

### 输出

```
-1
```

## 样例 #4

### 输入

```
6 8

1 2

2 3

3 4

4 5

5 1

1 4

1 5

4 6

1 6
```

### 输出

```
2
```



---

---
title: "[ABC133E] Virus Tree 2"
layout: "post"
diff: 普及+/提高
pid: AT_abc133_e
tag: []
---

# [ABC133E] Virus Tree 2

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc133/tasks/abc133_e

$ N $ 頂点、$ N-1 $ 辺を持つ木が与えられます。 頂点には番号 $ 1,2,...,N $ がつけられており、$ i $ 番目の辺は頂点 $ a_i,b_i $ をつないでいます。

あなたは $ K $ 色の絵の具を持っています。 木の頂点それぞれに対して、以下の条件を満たすように、$ K $ 色の中から $ 1 $ 色を選んで塗ることにしました。

- 二つの異なる頂点 $ x,y $ 間の距離が $ 2 $ 以下ならば、頂点 $ x $ の色と頂点 $ y $ の色は異なる。

木を塗り分ける方法は何通りあるでしょうか。 総数を $ 1,000,000,007 $ で割った余りを求めてください。

木とは

木とはグラフの一種です。詳しくはこちらをご覧ください: [Wikipedia「木 (数学)」](https://ja.wikipedia.org/wiki/%E6%9C%A8_(%E6%95%B0%E5%AD%A6))

距離とは

二つの頂点 $ x,y $ 間の距離とは、$ x $ から $ y $ に到達する際にたどる必要のある最小の辺数です。

## 输入格式

入力は以下の形式で標準入力から与えられます。

> $ N $ $ K $ $ a_1 $ $ b_1 $ $ a_2 $ $ b_2 $ $ . $ $ . $ $ . $ $ a_{N-1} $ $ b_{N-1} $

## 输出格式

木の塗り分け方の総数を $ 1,000,000,007 $ で割った余りを出力してください。

## 说明/提示

### 制約

- $ 1\ \leqq\ N,K\ \leqq\ 10^5 $
- $ 1\ \leqq\ a_i,b_i\ \leqq\ N $
- 与えられるグラフは木である。

### Sample Explanation 1

!\[zu\](https://img.atcoder.jp/ghi/491cd56a53e99ba7677ee4827b8f767a.png) 塗り分け方は $ 6 $ 通りです。

## 样例 #1

### 输入

```
4 3

1 2

2 3

3 4
```

### 输出

```
6
```

## 样例 #2

### 输入

```
5 4

1 2

1 3

1 4

4 5
```

### 输出

```
48
```

## 样例 #3

### 输入

```
16 22

12 1

3 1

4 16

7 12

6 2

2 15

5 16

14 16

10 11

3 10

3 13

8 6

16 8

9 12

4 3
```

### 输出

```
271414432
```



---

---
title: "[ABC136E] Max GCD"
layout: "post"
diff: 普及+/提高
pid: AT_abc136_e
tag: []
---

# [ABC136E] Max GCD

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc136/tasks/abc136_e

長さ $ N $ の整数列 $ A_1,\ A_2,\ \cdots,\ A_N $ があります。

次の操作を $ 0 $ 回以上 $ K $ 回以下行うことができます。

- $ i\ \neq\ j $ なる $ 1 $ 以上 $ N $ 以下の $ 2 $ つの整数 $ i,\ j $ を選び、$ A_i $ に $ 1 $ を足し、$ A_j $ に $ -1 $ を足す。この操作の後いずれかの要素が負になってもよい。

操作後の $ A $ の全ての要素を割り切る正の整数として考えられる値の最大値を計算してください。ただし、正の整数 $ x $ が整数 $ y $ を割り切るとは、ある整数 $ z $ を用いて $ y\ =\ xz $ と表せる場合を表します。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ K $ $ A_1 $ $ A_2 $ $ \cdots $ $ A_{N-1} $ $ A_{N} $

## 输出格式

操作後の $ A $ の全ての要素を割り切る正の整数として考えられる値の最大値を出力せよ。

## 说明/提示

### 制約

- $ 2\ \leq\ N\ \leq\ 500 $
- $ 1\ \leq\ A_i\ \leq\ 10^6 $
- $ 0\ \leq\ K\ \leq\ 10^9 $
- 入力は全て整数である

### Sample Explanation 1

例えば以下の操作で、$ 7 $ が $ A $ の全ての要素を割り切るようにできます。 - $ i\ =\ 2,\ j\ =\ 1 $ とする。$ A $ は $ (7,\ 21) $ となる。 また、$ 8 $ 以上の整数が $ A $ の全ての要素を割り切るようにはできません。

### Sample Explanation 2

例えば、以下のように操作を $ 5 $ 回行います。 - $ i\ =\ 2,\ j\ =\ 1 $ とする。$ A $ は $ (2,\ 6) $ となる。 - $ i\ =\ 2,\ j\ =\ 1 $ とする。$ A $ は $ (1,\ 7) $ となる。 - $ i\ =\ 2,\ j\ =\ 1 $ とする。$ A $ は $ (0,\ 8) $ となる。 - $ i\ =\ 2,\ j\ =\ 1 $ とする。$ A $ は $ (-1,\ 9) $ となる。 - $ i\ =\ 1,\ j\ =\ 2 $ とする。$ A $ は $ (0,\ 8) $ となる。 このとき、$ 0\ =\ 8\ \times\ 0,\ 8\ =\ 8\ \times\ 1 $ と表せるので、$ 8 $ は $ A $ の全ての要素を割り切ります。また、$ 9 $ 以上の整数が $ A $ の全ての要素を割り切るようにはできません。

## 样例 #1

### 输入

```
2 3

8 20
```

### 输出

```
7
```

## 样例 #2

### 输入

```
2 10

3 5
```

### 输出

```
8
```

## 样例 #3

### 输入

```
4 5

10 1 2 22
```

### 输出

```
7
```

## 样例 #4

### 输入

```
8 7

1 7 5 6 8 2 6 5
```

### 输出

```
5
```



---

---
title: "[ABC137D] Summer Vacation"
layout: "post"
diff: 普及+/提高
pid: AT_abc137_d
tag: []
---

# [ABC137D] Summer Vacation

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc137/tasks/abc137_d

$ N $ 件の日雇いアルバイトがあり、$ i $ 件目の日雇いアルバイトを請けて働くと、その $ A_i $ 日後に報酬 $ B_i $ が得られます。

あなたは、これらの中から $ 1 $ 日に $ 1 $ 件まで選んで請け、働くことができます。

ただし、請けたことのある日雇いアルバイトは選べません。

今日から $ M $ 日後まで($ M $ 日後を含む)に得られる報酬の合計の最大値を求めてください。

なお、日雇いアルバイトは今日から請けて働くことができます。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ M $ $ A_1 $ $ B_1 $ $ A_2 $ $ B_2 $ $ \vdots $ $ A_N $ $ B_N $

## 输出格式

$ M $ 日後までに得られる報酬の合計の最大値を出力せよ。

## 说明/提示

### 制約

- 入力は全て整数である。
- $ 1\ \leq\ N\ \leq\ 10^5 $
- $ 1\ \leq\ M\ \leq\ 10^5 $
- $ 1\ \leq\ A_i\ \leq\ 10^5 $
- $ 1\ \leq\ B_i\ \leq\ 10^4 $

### Sample Explanation 1

以下のように日雇いアルバイトを請けて働くと、報酬の合計は $ 5 $ となり、このときが最大です。 - 今日、$ 1 $ 件目の日雇いアルバイトを請けて働き、今日から $ 4 $ 日後に報酬 $ 3 $ を得ます。 - 明日(今日から $ 1 $ 日後)、$ 3 $ 件目の日雇いアルバイトを請けて働き、今日から $ 1+2\ =\ 3 $ 日後に報酬 $ 2 $ を得ます。

## 样例 #1

### 输入

```
3 4

4 3

4 1

2 2
```

### 输出

```
5
```

## 样例 #2

### 输入

```
5 3

1 2

1 3

1 4

2 1

2 3
```

### 输出

```
10
```

## 样例 #3

### 输入

```
1 1

2 1
```

### 输出

```
0
```



---

---
title: "[ABC137E] Coins Respawn"
layout: "post"
diff: 普及+/提高
pid: AT_abc137_e
tag: []
---

# [ABC137E] Coins Respawn

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc137/tasks/abc137_e

$ 1 $ から $ N $ までの番号がつけられた $ N $ 頂点と $ M $ 辺からなる有向グラフがあります。 $ i $ 番目の辺は頂点 $ A_i $ から頂点 $ B_i $ へと向かい、この辺の上には $ C_i $ 枚のコインが置かれています。 また、頂点 $ N $ にはボタンが設置されています。

このグラフ上でゲームを行います。 あなたは頂点 $ 1 $ でコインを $ 0 $ 枚持ってゲームを開始し、辺をたどってコインを拾いながら頂点 $ N $ を目指します。 $ 1 $ 本の辺を通るには $ 1 $ 分の時間がかかり、辺を通るたびにその辺の上に置かれているすべてのコインを拾うことができます。 ゲームの世界ではよくあるように、ある辺を通ってその上のコインを拾っても、その辺を次に通る際には同じ枚数のコインが再び出現しており、それらを再び拾うことができます。

頂点 $ N $ に到着したとき、ボタンを押してゲームを終了することができます。(ボタンを押さずに移動を続けることもできます。) ただし、ゲームを終了する際に、ゲーム開始からの経過時間を $ T $ 分として $ T\ \times\ P $ 枚のコインの支払いが要求されます。持っているコインの枚数が $ T\ \times\ P $ 枚未満の場合は、代わりに持っているコインをすべて支払います。

この支払いの後に残ったコインの枚数があなたのスコアとなります。 獲得できるスコアの最大値が存在するか判定し、存在する場合はその最大値を求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ M $ $ P $ $ A_1 $ $ B_1 $ $ C_1 $ $ : $ $ A_M $ $ B_M $ $ C_M $

## 输出格式

獲得できるスコアの最大値が存在する場合はその最大値を、存在しない場合は `-1` を出力せよ。

## 说明/提示

### 制約

- $ 2\ \leq\ N\ \leq\ 2500 $
- $ 1\ \leq\ M\ \leq\ 5000 $
- $ 1\ \leq\ A_i,\ B_i\ \leq\ N $
- $ 1\ \leq\ C_i\ \leq\ 10^5 $
- $ 0\ \leq\ P\ \leq\ 10^5 $
- 入力中の値はすべて整数である。
- 頂点 $ 1 $ から頂点 $ N $ に到達することが可能である。

### Sample Explanation 1

!\[入力例 1 で与えられるグラフの図\](https://img.atcoder.jp/ghi/5cb074e2d7c3282da137ac4ab2fbc700.png) 頂点 $ 1 $ から頂点 $ 3 $ に移動する方法は以下の $ 2 $ 通りです。 - 頂点 $ 1\ \rightarrow\ 2\ \rightarrow\ 3 $: 道中でコインを $ 20\ +\ 30\ =\ 50 $ 枚拾う。ゲーム開始から $ 2 $ 分後に頂点 $ 3 $ に着き、ボタンを押してコインを $ 2\ \times\ 10\ =\ 20 $ 枚支払い、$ 50\ -\ 20\ =\ 30 $ 枚残る。 - 頂点 $ 1\ \rightarrow\ 3 $: 道中でコインを $ 45 $ 枚拾う。ゲーム開始から $ 1 $ 分後に頂点 $ 3 $ に着き、ボタンを押してコインを $ 1\ \times\ 10\ =\ 10 $ 枚支払い、$ 45\ -\ 10\ =\ 35 $ 枚残る。 よって、獲得できるスコアの最大値は $ 35 $ です。

### Sample Explanation 2

!\[入力例 2 で与えられるグラフの図\](https://img.atcoder.jp/ghi/eb2188ad1e8189f963d233415fb293b6.png) 頂点 $ 1 $ から伸びる辺を通ると頂点 $ 2 $ に着き、ここで頂点 $ 2 $ から自分自身へと向かう辺を $ t $ 回通ってからボタンを押すとスコアは $ 90\ +\ 90t $ となります。よってスコアは無限に高めることができ、獲得できるスコアの最大値は存在しません。

### Sample Explanation 3

!\[入力例 3 で与えられるグラフの図\](https://img.atcoder.jp/ghi/217f7a224b80a05d8e25140c57e65ae7.png) 頂点 $ 1 $ から頂点 $ 4 $ へと直接向かう辺を通ること以外に頂点 $ 1 $ から頂点 $ 4 $ に移動する方法はありません。この辺の上で $ 1 $ 枚のコインを拾いますが、ゲーム終了時に $ 10 $ 枚のコインの支払いを要求されてスコアは $ 0 $ となります。 なお、頂点 $ 1 $ から頂点 $ 2 $ へと向かう辺を通るとその後コインを無限に拾えますが、頂点 $ 4 $ に到達してゲームを終了することができなくなるため無意味です。

## 样例 #1

### 输入

```
3 3 10

1 2 20

2 3 30

1 3 45
```

### 输出

```
35
```

## 样例 #2

### 输入

```
2 2 10

1 2 100

2 2 100
```

### 输出

```
-1
```

## 样例 #3

### 输入

```
4 5 10

1 2 1

1 4 1

3 4 1

2 2 100

3 3 100
```

### 输出

```
0
```



---

---
title: "[ABC138E] Strings of Impurity"
layout: "post"
diff: 普及+/提高
pid: AT_abc138_e
tag: []
---

# [ABC138E] Strings of Impurity

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc138/tasks/abc138_e

英小文字からなる二つの文字列 $ s,\ t $ が与えられます。次の条件を満たす整数 $ i $ $ (1\ \leq\ i\ \leq\ 10^{100}\ \times\ |s|) $ が存在するか判定し、存在する場合はそのような $ i $ の最小値を求めてください。

- $ s $ を $ 10^{100} $ 個連結して得られる文字列を $ s' $ とする。$ t $ は、文字列 $ {s'}_1{s'}_2\ldots{s'}_i $ ($ s' $ の先頭 $ i $ 文字) の部分列である。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ s $ $ t $

## 输出格式

条件を満たす整数 $ i $ が存在する場合はそのような $ i $ の最小値を、存在しない場合は `-1` を出力せよ。

## 说明/提示

### 注記

- 文字列 $ a $ の部分列とは、$ a $ から $ 0 $ 文字以上を削除して残った文字を相対的な順序を保ったまま連結して得られる文字列です。例えば、`contest` の部分列には `net`, `c`, `contest` などがあります。

### 制約

- $ 1\ \leq\ |s|\ \leq\ 10^5 $
- $ 1\ \leq\ |t|\ \leq\ 10^5 $
- $ s,\ t $ は英小文字からなる。

### Sample Explanation 1

$ t\ = $ `son` は文字列 `contestcon` ($ s'\ = $ `contestcontestcontest...` の先頭 $ 10 $ 文字) の部分列であるため、$ i\ =\ 10 $ は条件を満たします。 一方で、$ t $ は文字列 `contestco` ($ s' $ の先頭 $ 9 $ 文字) の部分列ではないため、$ i\ =\ 9 $ は条件を満たしません。 同様に、$ 8 $ 以下の任意の整数も条件を満たしません。よって、条件を満たす整数 $ i $ の最小値は $ 10 $ です。

### Sample Explanation 2

$ t\ = $ `programming` は $ s'\ = $ `contestcontestcontest...` の部分列ではありません。よって、条件を満たす整数 $ i $ は存在しません。

### Sample Explanation 3

ここにそのようなケースを置くことはできませんが、答えは $ 32 $ bit 整数に収まらない可能性があるのでご注意ください。

## 样例 #1

### 输入

```
contest

son
```

### 输出

```
10
```

## 样例 #2

### 输入

```
contest

programming
```

### 输出

```
-1
```

## 样例 #3

### 输入

```
contest

sentence
```

### 输出

```
33
```



---

---
title: "[ABC139E] League"
layout: "post"
diff: 普及+/提高
pid: AT_abc139_e
tag: []
---

# [ABC139E] League

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc139/tasks/abc139_e

$ N $ 人の選手がテニスの大会に参加します。彼らを選手 $ 1 $、選手 $ 2 $、$ \ldots $、選手 $ N $ と呼びます。

大会は総当たり戦で、合計 $ N(N-1)/2 $ 試合が行われます。 これらの試合の日程を、以下の条件をすべて満たすように決めることは可能でしょうか。可能である場合、必要な最小の日数も求めてください。

- 各選手は一日に最大で一試合を行う。
- 各選手 $ i $ $ (1\ \leq\ i\ \leq\ N) $ は、選手 $ A_{i,\ 1},\ A_{i,\ 2},\ \ldots,\ A_{i,\ N-1} $ とこの順に一度ずつ試合を行う。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ A_{1,\ 1} $ $ A_{1,\ 2} $ $ \ldots $ $ A_{1,\ N-1} $ $ A_{2,\ 1} $ $ A_{2,\ 2} $ $ \ldots $ $ A_{2,\ N-1} $ $ : $ $ A_{N,\ 1} $ $ A_{N,\ 2} $ $ \ldots $ $ A_{N,\ N-1} $

## 输出格式

条件をすべて満たすように全試合の日程を決めることが可能なら必要な最小の日数を、不可能なら `-1` を出力せよ。

## 说明/提示

### 制約

- $ 3\ \leq\ N\ \leq\ 1000 $
- $ 1\ \leq\ A_{i,\ j}\ \leq\ N $
- $ A_{i,\ j}\ \neq\ i $
- $ A_{i,\ 1},\ A_{i,\ 2},\ \ldots,\ A_{i,\ N-1} $ はすべて異なる。

### Sample Explanation 1

$ 3 $ 日間で次のように試合を行えばすべての条件を満たせます。 - $ 1 $ 日目: 選手 $ 1 $ 対 選手 $ 2 $ - $ 2 $ 日目: 選手 $ 1 $ 対 選手 $ 3 $ - $ 3 $ 日目: 選手 $ 2 $ 対 選手 $ 3 $ これが必要な最小日数です。

### Sample Explanation 2

$ 4 $ 日間で次のように試合を行えばすべての条件を満たせます。 - $ 1 $ 日目: 選手 $ 1 $ 対 選手 $ 2 $、選手 $ 3 $ 対 選手 $ 4 $ - $ 2 $ 日目: 選手 $ 1 $ 対 選手 $ 3 $ - $ 3 $ 日目: 選手 $ 1 $ 対 選手 $ 4 $、選手 $ 2 $ 対 選手 $ 3 $ - $ 4 $ 日目: 選手 $ 2 $ 対 選手 $ 4 $ これが必要な最小日数です。

### Sample Explanation 3

どのような日程で試合を行っても何らかの条件に違反します。

## 样例 #1

### 输入

```
3

2 3

1 3

1 2
```

### 输出

```
3
```

## 样例 #2

### 输入

```
4

2 3 4

1 3 4

4 1 2

3 1 2
```

### 输出

```
4
```

## 样例 #3

### 输入

```
3

2 3

3 1

1 2
```

### 输出

```
-1
```



---

---
title: "[ABC140E] Second Sum"
layout: "post"
diff: 普及+/提高
pid: AT_abc140_e
tag: []
---

# [ABC140E] Second Sum

## 题目描述

### 题面描述

给出一个 $1 \sim n$ 的排列（即 $1 \sim n$ 每个数只出现一次）$P$。

给出一对 $[L, R]$，设 $X_{L, R}$ 是 $P_L \sim P_R$ 中的次大值（第二大值）。

求 $\sum_{L = 1}^{N - 1} \sum_{R = L + 1}^{N} X_{L, R}$。

注：即求所有 $[L, R]$ 区间的次大值之和。

## 输入格式

第一行一个整数 $N$，表示之后给出的排列长度为 $N$。

第二行一个长度为 $N$ 的排列 $P$。

## 输出格式

输出一个整数，表示 $\sum_{L = 1}^{N - 1} \sum_{R = L + 1}^{N} X_{L, R}$

## 说明/提示

#### 样例 1 解释

$X_{1, 2} = 2, X_{1, 3} = 2, X_{2, 3} = 1$，次大值和为 $2 + 2 + 1 = 5$。

#### 数据约束

对于 $100\%$ 的数据，保证：
- $2 \le N \le 10^5$
- $1 \le P_i \le N$
- $P_i \ne P_j (i \ne j)$
- $1 \le L < R \le N$
- 所有输入均为整数。

---

署名：[George222](https://www.luogu.com.cn/user/848194)

## 样例 #1

### 输入

```
3

2 3 1
```

### 输出

```
5
```

## 样例 #2

### 输入

```
5

1 2 3 4 5
```

### 输出

```
30
```

## 样例 #3

### 输入

```
8

8 2 7 3 4 5 6 1
```

### 输出

```
136
```



---

---
title: "[ABC141E] Who Says a Pun?"
layout: "post"
diff: 普及+/提高
pid: AT_abc141_e
tag: []
---

# [ABC141E] Who Says a Pun?

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc141/tasks/abc141_e

長さ $ N $ の文字列 $ S $ が与えられます。

非空文字列であって、$ S $ の連続する部分文字列として重ならずに $ 2 $ 回以上現れるもののうち、最長のものの長さを答えてください。

より厳密には、

- $ l_1\ +\ len\ \leq\ l_2 $
- $ S[l_1+i]\ =\ S[l_2+i]\ (i\ =\ 0,\ 1,\ ...,\ len\ -\ 1) $

を満たす整数 $ l_1 $ , $ l_2 $ ( $ 1\ \leq\ l_1,\ l_2\ \leq\ N\ -\ len\ +\ 1 $ ) が存在するような正整数 $ len $ の最大値を求めてください。そのような $ len $ が存在しないときは、$ 0 $ を出力してください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ S $

## 输出格式

非空文字列であって、$ S $ の連続する部分文字列として重ならずに $ 2 $ 回以上現れるもののうち、最長のものの長さを出力せよ。そのような非空文字列が存在しないときは、$ 0 $ を出力せよ。

## 说明/提示

### 制約

- $ 2\ <\ =\ N\ <\ =\ 5\ \times\ 10^3 $
- $ |S|\ =\ N $
- $ S $ は英小文字から成る

### Sample Explanation 1

条件を満たす文字列として、`a`, `b`, `ab`, `ba` が考えられます。これらの長さの最大値 $ 2 $ が答えです。 `aba` は $ S $ の連続する部分文字列として $ 2 $ 度現れますが、$ l_1\ +\ len\ \leq\ l_2 $ を満たすような $ l_1 $ , $ l_2 $ が取れないことに注意してください。

### Sample Explanation 2

条件を満たす非空文字列は存在しません。

## 样例 #1

### 输入

```
5

ababa
```

### 输出

```
2
```

## 样例 #2

### 输入

```
2

xy
```

### 输出

```
0
```

## 样例 #3

### 输入

```
13

strangeorange
```

### 输出

```
5
```



---

---
title: "[ABC142E] Get Everything"
layout: "post"
diff: 普及+/提高
pid: AT_abc142_e
tag: []
---

# [ABC142E] Get Everything

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc142/tasks/abc142_e

鍵のかかった宝箱が $ N $ 個あり、$ 1 $ から $ N $ までの番号がつけられています。

店で $ M $ 個の鍵が売られています。$ i $ 個目の鍵は $ a_i $ 円で販売されており、$ b_i $ 種類の宝箱 $ c_{i1} $ , $ c_{i2} $ , ..., $ c_{i{b_i}} $ を開けることが出来ます。購入した鍵は何度でも使うことが出来ます。

全ての宝箱を開ける為に必要な費用の最小値を答えてください。全ての宝箱を開けることが不可能である場合は $ -1 $ を出力してください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ M $ $ a_1 $ $ b_1 $ $ c_{11} $ $ c_{12} $ $ ... $ $ c_{1{b_1}} $ $ : $ $ a_M $ $ b_M $ $ c_{M1} $ $ c_{M2} $ $ ... $ $ c_{M{b_M}} $

## 输出格式

全ての宝箱を開ける為に必要な費用の最小値を出力せよ。 全ての宝箱を開けることが不可能である場合は $ -1 $ を出力せよ。

## 说明/提示

### 制約

- 入力は全て整数
- $ 1\ <\ =\ N\ <\ =\ 12 $
- $ 1\ <\ =\ M\ <\ =\ 10^3 $
- $ 1\ \leq\ a_i\ \leq\ 10^5 $
- $ 1\ \leq\ b_i\ \leq\ N $
- $ 1\ \leq\ c_{i1}\ <\ c_{i2}\ <\ ...\ <\ c_{i{b_i}}\ \leq\ N $

### Sample Explanation 1

鍵 $ 1 $ と鍵 $ 2 $ を購入すると、全ての宝箱を開けることが出来ます。このときの費用は $ 25 $ 円であり、これが最小値です。

### Sample Explanation 2

全ての宝箱を開けることは出来ません。

## 样例 #1

### 输入

```
2 3

10 1

1

15 1

2

30 2

1 2
```

### 输出

```
25
```

## 样例 #2

### 输入

```
12 1

100000 1

2
```

### 输出

```
-1
```

## 样例 #3

### 输入

```
4 6

67786 3

1 3 4

3497 1

2

44908 3

2 3 4

2156 3

2 3 4

26230 1

2

86918 1

3
```

### 输出

```
69942
```



---

---
title: "[ABC142F] Pure"
layout: "post"
diff: 普及+/提高
pid: AT_abc142_f
tag: []
---

# [ABC142F] Pure

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc142/tasks/abc142_f

$ N $ 頂点 $ M $ 辺の有向グラフ $ G $ が与えられます。  
 このグラフの頂点には $ 1 $ から $ N $ までの番号が付けられており、$ i $ 番目の辺は頂点 $ A_i $ から頂点 $ B_i $ に向けて張られています。  
 このグラフは自己辺や多重辺を持たないことが保証されています。

すべての頂点の入次数が $ 1 $、出次数が $ 1 $ であるような $ G $ の誘導部分グラフ (注記を参照) が存在するか判定し、 存在するならその一例を示してください。  
 ただし、空グラフは含めないものとします。

## 输入格式

入力は以下の形式で標準入力から与えられます。

> $ N $ $ M $ $ A_1 $ $ B_1 $ $ A_2 $ $ B_2 $ $ : $ $ A_M $ $ B_M $

## 输出格式

条件を満たす $ G $ の誘導部分グラフが存在しないとき、`-1` と出力してください。 そうでないとき、以下のフォーマットで条件を満たす $ G $ の誘導部分グラフの一例を出力してください。

> $ K $ $ v_1 $ $ v_2 $ : $ v_K $

これは、頂点数が $ K $、頂点集合が $ \{v_1,\ v_2,\ \ldots,\ v_K\} $ であるような $ G $ の誘導部分グラフを表します。($ v_1,\ v_2,\ \ldots,\ v_K $ の順序は問いません。) 条件を満たす $ G $ の誘導部分グラフが複数存在するときは、そのうちのどれを出力しても構いません。

## 说明/提示

### 注記

有向グラフ $ G\ =\ (V,\ E) $ に対し、次のような条件を満たす有向グラフ $ G'\ =\ (V',\ E') $ を $ G $ の誘導部分グラフと呼びます。

- $ V' $ は $ V $ の (空でない) 部分集合である。
- $ E' $ は、$ E $ の辺であって両端点がともに $ V' $ に含まれるものすべてを含む集合である。

### 制約

- $ 1\ \leq\ N\ \leq\ 1000 $
- $ 0\ \leq\ M\ \leq\ 2000 $
- $ 1\ \leq\ A_i,B_i\ \leq\ N $
- $ A_i\ \neq\ B_i $
- 組 $ (A_i,\ B_i) $ はすべて異なる。
- 入力はすべて整数である。

### Sample Explanation 1

頂点集合が $ \{1,\ 2,\ 4\} $ であるような $ G $ の誘導部分グラフの辺集合は $ \{(1,\ 2),\ (2,\ 4),\ (4,\ 1)\} $ であり、すべての頂点の入次数が $ 1 $、出次数が $ 1 $ となります。

### Sample Explanation 2

条件を満たす $ G $ の誘導部分グラフは存在しません。

## 样例 #1

### 输入

```
4 5

1 2

2 3

2 4

4 1

4 3
```

### 输出

```
3

1

2

4
```

## 样例 #2

### 输入

```
4 5

1 2

2 3

2 4

1 4

4 3
```

### 输出

```
-1
```

## 样例 #3

### 输入

```
6 9

1 2

2 3

3 4

4 5

5 6

5 1

5 2

6 1

6 2
```

### 输出

```
4

2

3

4

5
```



---

---
title: "[ABC143E] Travel by Car"
layout: "post"
diff: 普及+/提高
pid: AT_abc143_e
tag: []
---

# [ABC143E] Travel by Car

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc143/tasks/abc143_e

$ 1 $ から $ N $ までの番号がついた $ N $ 個の町と $ M $ 本の道があります。$ i $ 本目の道は町 $ A_i $ と町 $ B_i $ を双方向に結び、その長さは $ C_i $ です。

高橋君はこれらの町の間を、道を車で通行することで移動します。車の燃料タンクの容量は $ L $ リットルであり、距離 $ 1 $ を移動する度に燃料を $ 1 $ リットル消費します。移動中に町を訪れた場合、燃料をタンクが一杯になるまで補給することが出来ます (補給しないという選択も可能です)。道の途中で燃料が尽きるような移動は出来ません。

以下の $ Q $ 個のクエリに答えてください。

- はじめ、車の燃料タンクは一杯です。町 $ s_i $ から町 $ t_i $ へ移動するとき、最小で何回途中で燃料を補給する必要があるかを答えてください。町 $ t_i $ まで移動出来ない場合は $ −1 $ を出力してください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ M $ $ L $ $ A_1 $ $ B_1 $ $ C_1 $ $ : $ $ A_M $ $ B_M $ $ C_M $ $ Q $ $ s_1 $ $ t_1 $ $ : $ $ s_Q $ $ t_Q $

## 输出格式

$ Q $ 行出力せよ。

$ i $ 行目には、町 $ s_i $ から町 $ t_i $ へ移動するとき、最小で何回燃料を補給する必要があるかを出力せよ。町 $ t_i $ まで移動出来ない場合は $ −1 $ を出力せよ。

## 说明/提示

### 制約

- 入力は全て整数
- $ 2\ <\ =\ N\ <\ =\ 300 $
- $ 0\ <\ =\ M\ <\ =\ \frac{N(N-1)}{2} $
- $ 1\ \leq\ L\ \leq\ 10^9 $
- $ 1\ <\ =\ A_i,\ B_i\ <\ =\ N $
- $ A_i\ \neq\ B_i $
- $ \left(A_i,\ B_i\right)\ \neq\ \left(A_j,\ B_j\right) $ ( $ i\ \neq\ j $ のとき)
- $ \left(A_i,\ B_i\right)\ \neq\ \left(B_j,\ A_j\right) $ ( $ i\ \neq\ j $ のとき)
- $ 1\ \leq\ C_i\ \leq\ 10^9 $
- $ 1\ <\ =\ Q\ <\ =\ N\left(N-1\right) $
- $ 1\ <\ =\ s_i,\ t_i\ <\ =\ N $
- $ s_i\ \neq\ t_i $
- $ \left(s_i,\ t_i\right)\ \neq\ \left(s_j,\ t_j\right) $ ( $ i\ \neq\ j $ のとき)

### Sample Explanation 1

町 $ 3 $ から町 $ 2 $ へ移動するときは、 $ 2 $ 本目の道を使えば、途中で燃料を補給することなく町 $ 2 $ へ到着することが出来ます。 町 $ 1 $ から町 $ 3 $ へ移動するときは、まず $ 1 $ 本目の道を使って町 $ 2 $ へ移動し、燃料をタンク一杯まで補給し、 $ 2 $ 本目の道を使うことにより、町 $ 3 $ へ到着することが出来ます。

### Sample Explanation 2

道が無いこともあります。

## 样例 #1

### 输入

```
3 2 5

1 2 3

2 3 3

2

3 2

1 3
```

### 输出

```
0

1
```

## 样例 #2

### 输入

```
4 0 1

1

2 1
```

### 输出

```
-1
```

## 样例 #3

### 输入

```
5 4 4

1 2 2

2 3 2

3 4 3

4 5 2

20

2 1

3 1

4 1

5 1

1 2

3 2

4 2

5 2

1 3

2 3

4 3

5 3

1 4

2 4

3 4

5 4

1 5

2 5

3 5

4 5
```

### 输出

```
0

0

1

2

0

0

1

2

0

0

0

1

1

1

0

0

2

2

1

0
```



---

---
title: "[ABC145E] All-you-can-eat"
layout: "post"
diff: 普及+/提高
pid: AT_abc145_e
tag: []
---

# [ABC145E] All-you-can-eat

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc145/tasks/abc145_e

高橋君は食べ放題のお店に来ました。

$ N $ 種類の料理があり、$ i $ 番目の料理は、食べるために $ A_i $ 分必要で、美味しさは $ B_i $ です。

この店のルールは以下の通りです。

- $ 1 $ 度に $ 1 $ つの料理のみを注文することができます。注文した料理は即座に提供され、食べ始めることができます。
- 同じ種類の料理を $ 2 $ 度以上注文することはできません。
- 提供済みの料理を食べ終わるまで次の料理を注文することはできません。
- 最初の注文から $ T-0.5 $ 分後以降に注文することはできませんが、提供済みの料理を食べることはできます。

高橋君の満足度を、この来店で高橋君が食べる料理の美味しさの合計とします。

高橋君が適切に行動したとき、満足度は最大でいくらになるでしょうか。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ T $ $ A_1 $ $ B_1 $ $ : $ $ A_N $ $ B_N $

## 输出格式

高橋君が適切に行動したときの、満足度の最大値を出力せよ。

## 说明/提示

### 制約

- $ 2\ \leq\ N\ \leq\ 3000 $
- $ 1\ \leq\ T\ \leq\ 3000 $
- $ 1\ \leq\ A_i\ \leq\ 3000 $
- $ 1\ \leq\ B_i\ \leq\ 3000 $
- 入力中のすべての値は整数である。

### Sample Explanation 1

$ 1 $ 番目、$ 2 $ 番目の順に料理を注文することで、満足度は $ 110 $ になります。 注文が時間内に間に合えば、食べるのにどれだけ時間がかかっても良いことに注意してください。

### Sample Explanation 2

$ 60 $ 分以内に全ての料理を食べることができます。

### Sample Explanation 3

$ 2 $ 番目、$ 3 $ 番目の順に料理に注文することで、満足度を $ 50 $ にできます。 どのような順に料理を注文しても、料理を $ 3 $ つ注文することはできません。

## 样例 #1

### 输入

```
2 60

10 10

100 100
```

### 输出

```
110
```

## 样例 #2

### 输入

```
3 60

10 10

10 20

10 30
```

### 输出

```
60
```

## 样例 #3

### 输入

```
3 60

30 10

30 20

30 30
```

### 输出

```
50
```

## 样例 #4

### 输入

```
10 100

15 23

20 18

13 17

24 12

18 29

19 27

23 21

18 20

27 15

22 25
```

### 输出

```
145
```



---

---
title: "[ABC146E] Rem of Sum is Num"
layout: "post"
diff: 普及+/提高
pid: AT_abc146_e
tag: []
---

# [ABC146E] Rem of Sum is Num

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc146/tasks/abc146_e

長さ $ N $ の正整数列 $ A_1,\ A_2,\ \ldots\ ,\ A_N $ と正の整数 $ K $ が与えられます。

$ A $ の空でない連続する部分列であって、要素の和を $ K $ で割った余りが要素の数と等しくなるものの数を求めてください。ただし、$ 2 $ つの部分列が列として同じでも、取り出す位置が異なるならば区別するものとします。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ K $ $ A_1 $ $ A_2 $ $ \cdots $ $ A_N $

## 输出格式

条件をみたす部分列の個数を出力してください。

## 说明/提示

### 制約

- 入力は全て整数である。
- $ 1\ \leq\ N\ \leq\ 2\times\ 10^5 $
- $ 1\ \leq\ K\ \leq\ 10^9 $
- $ 1\ \leq\ A_i\ \leq\ 10^9 $

### Sample Explanation 1

$ (1) $, $ (4,2) $, $ (1,4,2) $, $ (5) $ の $ 4 $ つが条件をみたす部分列です。

### Sample Explanation 2

$ (4,2) $ が $ 4 $ 回、$ (2,4) $ が $ 3 $ 回数えられています。

## 样例 #1

### 输入

```
5 4

1 4 2 3 5
```

### 输出

```
4
```

## 样例 #2

### 输入

```
8 4

4 2 4 2 4 2 4 2
```

### 输出

```
7
```

## 样例 #3

### 输入

```
10 7

14 15 92 65 35 89 79 32 38 46
```

### 输出

```
8
```



---

---
title: "[ABC146F] Sugoroku"
layout: "post"
diff: 普及+/提高
pid: AT_abc146_f
tag: []
---

# [ABC146F] Sugoroku

## 题目描述

ABC146F 双六


高桥君在玩双六棋，棋盘格由用$0$到$N$编号的共$N+1$个格子构成。每一回合，高桥君会扔一个点数$1$到$M$的骰子。如果高桥君当前在第$i$格，骰子扔出$k$点，高桥君就前进到第$i+k$格。 如果此时$i+k > N$，高桥君立刻输掉。另外，棋盘上还有若干个“GameOver格”，如果高桥停在这些格子，也立刻输掉游戏。

假设高桥君可以自由控制骰子的点数，那么他从$0$号格子出发，到达$N$号格子，最短需要多少回合？输出用最短回合到达$N$格时，每回合骰子的点数组成的序列；如果无法到达$N$号格子，输出-1。

## 输入格式

第1行，两个正整数$N,M$

第2行，一个长为$N+1$的字符串$S$。$S_i=0$表示第$i$格是一个普通格子；$S_i=1$表示第$i$格是一个GameOver格。

## 输出格式

输出用最短回合到达$N$格时，每回合骰子的点数组成的序列，若有多种序列回合数都是最短，输出其中字典序最小的。

如果无法到达$N$号格子，输出-1。

【输入样例\#1】

```
9 3
0001000100
```

【输出样例\#1】

```
1 3 2 3
```

## 说明/提示

按$1,3,2,3$的顺序扔出骰子的点数，高桥君会经过第$1,4,6$格最终到达第$9$格。

无法在$3$次以内到达第$9$格。$1,3,2,3$是所有$4$次到达第$9$格的点数序列中，字典序最小的。


$1 \le N \le 10^5$

$1 \le M \le 10^5$

$S$长度为$N+1$，只由字符'0'和'1'组成，保证$S_0=0$，$S_N=0$。

## 样例 #1

### 输入

```
9 3

0001000100
```

### 输出

```
1 3 2 3
```

## 样例 #2

### 输入

```
5 4

011110
```

### 输出

```
-1
```

## 样例 #3

### 输入

```
6 6

0101010
```

### 输出

```
6
```



---

---
title: "[ABC148F] Playing Tag on Tree"
layout: "post"
diff: 普及+/提高
pid: AT_abc148_f
tag: []
---

# [ABC148F] Playing Tag on Tree

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc148/tasks/abc148_f

$ N $ 頂点の木があります。$ i $ 番目の辺は頂点 $ A_i $ と $ B_i $ を双方向に結んでいます。

この木の頂点 $ u $ に高橋君が、頂点 $ v $ に青木君がいます。

$ 2 $ 人は次のような手順で鬼ごっこをします。

- $ 1 $. 高橋君と青木君が同じ頂点にいるときゲームを終了する。そうでないとき、高橋君は隣接する頂点を $ 1 $ つ選んでその頂点に移動する。
- $ 2 $. 高橋君と青木君が同じ頂点にいるときゲームを終了する。そうでないとき、青木君は隣接する頂点を $ 1 $ つ選んでその頂点に移動する。
- $ 3 $. $ 1 $ に戻る。

高橋君はできるだけ遅くゲームが終了するように移動し、青木君はできるだけ早くゲームが終了するように移動します。

高橋君と青木君が常に互いの位置と戦略を把握し最適に移動するとき、ゲームが終了するまでに青木君が移動する回数を求めてください。

なお、ゲームは必ず終了することが証明できます。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ u $ $ v $ $ A_1 $ $ B_1 $ $ : $ $ A_{N-1} $ $ B_{N-1} $

## 输出格式

ゲームが終了するまでに青木君が移動する回数を出力せよ。

## 说明/提示

### 制約

- $ 2\ \leq\ N\ \leq\ 10^5 $
- $ 1\ \leq\ u,v\ \leq\ N $
- $ u\ \neq\ v $
- $ 1\ \leq\ A_i,B_i\ \leq\ N $
- 与えられるグラフは木である

### Sample Explanation 1

互いに最適に移動した場合、ゲームは次のように進行します。 - 高橋君が頂点 $ 3 $ に移動 - 青木君が頂点 $ 2 $ に移動 - 高橋君が頂点 $ 5 $ に移動 - 青木君が頂点 $ 3 $ に移動 - 高橋君が頂点 $ 3 $ に移動 このとき、ゲームが終了するまでの青木君の移動回数は $ 2 $ 回です。 各手番で同じ頂点にとどまることは出来ないことに注意してください。

## 样例 #1

### 输入

```
5 4 1

1 2

2 3

3 4

3 5
```

### 输出

```
2
```

## 样例 #2

### 输入

```
5 4 5

1 2

1 3

1 4

1 5
```

### 输出

```
1
```

## 样例 #3

### 输入

```
2 1 2

1 2
```

### 输出

```
0
```

## 样例 #4

### 输入

```
9 6 1

1 2

2 3

3 4

4 5

5 6

4 7

7 8

8 9
```

### 输出

```
5
```



---

---
title: "[ABC149E] Handshake"
layout: "post"
diff: 普及+/提高
pid: AT_abc149_e
tag: []
---

# [ABC149E] Handshake

## 题目描述

Takahashi  作为特殊嘉宾参加一个晚会 , 晚会上还有 N 个非特殊嘉宾 , 第 i  个特殊嘉宾有 A_i  的欢乐值.晚会目前的欢乐值是 0 .  
 Takahashi  想跟非特殊嘉宾握 M  次手来提高晚会的欢乐值.每一次握手可以被描述为以下的操作:  
1.  Takahashi  选择两个非特殊嘉宾 x  和 y   
2.  Takahashi  用左手和 x  握手 , 用右手和 y  握手 , 晚会的欢乐值增加 A_x + A_y .    

然而 ,  Takahashi  不能以同一种握手方式握两次手.也就是说 ,  Takahashi  的 M  次握手必须满足以下条件:  
- 假设在第 k  次握手中 ,  Takashi  握了非特殊嘉宾 x_k  的左手和 y_k  的右手 , 则没有一组 p  ,  q  (  1 ≤ p < q ≤ M)  可以满足 (  x_p  ,  y_p  ) = (  x_q  ,  y_q  ) .  

请问:在 M  次握手后 , 晚会的欢乐值最大是多少 ?

## 输入格式

第一行: N  ,  M   
第二行: A_1  ,  A_2  , ··· ,  A_N

## 输出格式

一行 , 最大的欢乐值  


---
[翻译者的个人中心](https://www.luogu.com.cn/user/324250)  
[翻译者的博客](https://324250.blog.luogu.org)

## 样例 #1

### 输入

```
5 3

10 14 19 34 33
```

### 输出

```
202
```

## 样例 #2

### 输入

```
9 14

1 3 5 110 24 21 34 5 3
```

### 输出

```
1837
```

## 样例 #3

### 输入

```
9 73

67597 52981 5828 66249 75177 64141 40773 79105 16076
```

### 输出

```
8128170
```



---

---
title: "[ABC150D] Semi Common Multiple"
layout: "post"
diff: 普及+/提高
pid: AT_abc150_d
tag: []
---

# [ABC150D] Semi Common Multiple

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc150/tasks/abc150_d

長さ $ N $ の偶数からなる正の整数列 $ A=\ {a_1,a_2,...,a_N} $ と、整数 $ M $ が与えられます。

任意の $ k(1\ \leq\ k\ \leq\ N) $ に対して以下の条件を満たす正の整数 $ X $ を $ A $ の「半公倍数」と定義します。

- $ X=\ a_k\ \times\ (p+0.5) $ を満たす負でない整数 $ p $ が存在する。

$ 1 $ 以上 $ M $ 以下の整数のうちの $ A $ の半公倍数の個数を求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ M $ $ a_1 $ $ a_2 $ $ ... $ $ a_N $

## 输出格式

$ 1 $ 以上 $ M $ 以下の整数のうちの $ A $ の半公倍数の個数を出力せよ。

## 说明/提示

### 制約

- $ 1\ \leq\ N\ \leq\ 10^5 $
- $ 1\ \leq\ M\ \leq\ 10^9 $
- $ 2\ \leq\ a_i\ \leq\ 10^9 $
- $ a_i $ は偶数である。
- 入力は全て整数である。

### Sample Explanation 1

\- $ 15\ =\ 6\ \times\ 2.5 $ - $ 15\ =\ 10\ \times\ 1.5 $ - $ 45\ =\ 6\ \times\ 7.5 $ - $ 45\ =\ 10\ \times\ 4.5 $ より、$ 15,45 $ は $ A $ の半公倍数です。$ 1 $ 以上 $ 50 $ 以下の整数に他に $ A $ の半公倍数はないので、答えは $ 2 $ となります。

### Sample Explanation 2

答えが $ 0 $ の場合もあります。

## 样例 #1

### 输入

```
2 50

6 10
```

### 输出

```
2
```

## 样例 #2

### 输入

```
3 100

14 22 40
```

### 输出

```
0
```

## 样例 #3

### 输入

```
5 1000000000

6 6 2 6 2
```

### 输出

```
166666667
```



---

---
title: "[ABC152E] Flatten"
layout: "post"
diff: 普及+/提高
pid: AT_abc152_e
tag: []
---

# [ABC152E] Flatten

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc152/tasks/abc152_e

$ N $ 個の正整数 $ A_1,...,A_N $ が与えられます。

次の条件を満たすような正整数 $ B_1,...,B_N $ を考えます。

条件：$ 1\ \leq\ i\ <\ j\ \leq\ N $ を満たすどのような $ i,j $ についても $ A_i\ B_i\ =\ A_j\ B_j $ が成り立つ。

このような $ B_1,...,B_N $ における $ B_1\ +\ ...\ +\ B_N $ の最小値を求めてください。

ただし、答えは非常に大きくなる可能性があるため、$ (10^9\ +7) $ で割ったあまりを出力してください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ A_1 $ $ ... $ $ A_N $

## 输出格式

条件を満たすような $ B_1,...,B_N $ における $ B_1\ +\ ...\ +\ B_N $ の最小値を $ (10^9\ +7) $ で割ったあまりを出力せよ。

## 说明/提示

### 制約

- $ 1\ \leq\ N\ \leq\ 10^4 $
- $ 1\ \leq\ A_i\ \leq\ 10^6 $
- 入力中のすべての値は整数である。

### Sample Explanation 1

$ B_1=6 $, $ B_2=4 $, $ B_3=3 $ とすると条件を満たします。

### Sample Explanation 2

全ての $ B_i $ を $ 1 $ とすればよいです。

### Sample Explanation 3

和を $ (10^9+7) $ で割った余りを出力してください。

## 样例 #1

### 输入

```
3

2 3 4
```

### 输出

```
13
```

## 样例 #2

### 输入

```
5

12 12 12 12 12
```

### 输出

```
5
```

## 样例 #3

### 输入

```
3

1000000 999999 999998
```

### 输出

```
996989508
```



---

---
title: "[ABC155D] Pairs"
layout: "post"
diff: 普及+/提高
pid: AT_abc155_d
tag: []
---

# [ABC155D] Pairs

## 题目描述

$N$个数两两相乘的结果有 $\frac{N(N-1)}{2}$ 种，问第 $K$ 小的乘积是多少。

## 输入格式

第一行两个整数 $N,K$。  
第二行 $N$ 个整数 $A_i$，为那 $N$ 个要乘起来的数

## 输出格式

一行一个整数，第 $K$ 小的乘积

## 说明/提示

$N \leq 2 \times 10^5,-10^9 \leq A_i \leq 10^9$

## 样例 #1

### 输入

```
4 3

3 3 -4 -2
```

### 输出

```
-6
```

## 样例 #2

### 输入

```
10 40

5 4 3 2 -1 0 0 0 0 0
```

### 输出

```
6
```

## 样例 #3

### 输入

```
30 413

-170202098 -268409015 537203564 983211703 21608710 -443999067 -937727165 -97596546 -372334013 398994917 -972141167 798607104 -949068442 -959948616 37909651 0 886627544 -20098238 0 -948955241 0 -214720580 277222296 -18897162 834475626 0 -425610555 110117526 663621752 0
```

### 输出

```
448283280358331064
```



---

---
title: "[ABC155E] Payment"
layout: "post"
diff: 普及+/提高
pid: AT_abc155_e
tag: []
---

# [ABC155E] Payment

## 题目描述

给定正整数 $N$，设 $f(x)$ 表示 $x$ 在十进制下各个数位上的数的和，求一个正整数 $x$ 满足 $x\ge N$ 且最小化 $f(x)+f(x-N)$。

## 输入格式

一行一个正整数 $N$，含义如题所述。

## 输出格式

一行一个正整数 $ans$，表示最小的 $f(x)+f(x-N)$。

## 说明/提示

$1\le N\le10^{1000000}$。

## 样例 #1

### 输入

```
36
```

### 输出

```
8
```

## 样例 #2

### 输入

```
91
```

### 输出

```
3
```

## 样例 #3

### 输入

```
314159265358979323846264338327950288419716939937551058209749445923078164062862089986280348253421170
```

### 输出

```
243
```



---

---
title: "[ABC157E] Simple String Queries"
layout: "post"
diff: 普及+/提高
pid: AT_abc157_e
tag: []
---

# [ABC157E] Simple String Queries

## 题目描述

给定长度为n的原字符串与q次操作或询问。其格式如下:

①1 i c: 将第i位字符改为c(c也是字符)。

②2 l r: 询问区间[l,r]内不同字符的个数。



感谢ducati小蒟蒻的翻译

## 输入格式

第一行输入n，表示原字符串的长度。

第二行输入原字符串。

第三行输入q，表示询问或操作的次数。

## 样例 #1

### 输入

```
7

abcdbbd

6

2 3 6

1 5 z

2 1 1

1 4 a

1 7 d

2 1 7
```

### 输出

```
3

1

5
```



---

---
title: "[ABC159F] Knapsack for All Segments"
layout: "post"
diff: 普及+/提高
pid: AT_abc159_f
tag: []
---

# [ABC159F] Knapsack for All Segments

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc159/tasks/abc159_f

長さ $ N $ の整数列 $ A_1 $, $ A_2 $, $ \ldots $, $ A_N $ と正の整数 $ S $ が与えられます。  
 $ 1\leq\ L\ \leq\ R\ \leq\ N $ をみたす整数 $ (L,\ R) $ の組について、$ f(L,\ R) $ を以下のように定めます。

- $ L\ \leq\ x_1\ <\ x_2\ <\ \cdots\ <\ x_k\ \leq\ R $ かつ $ A_{x_1}+A_{x_2}+\cdots\ +A_{x_k}\ =\ S $ を満たすような整数列 $ (x_1,\ x_2,\ \ldots\ ,\ x_k) $ の個数

$ 1\leq\ L\ \leq\ R\leq\ N $ を満たす整数 $ (L,\ R) $ の組すべてに対する $ f(L,\ R) $ の和を求めてください。ただし、答えは非常に大きくなることがあるので、$ 998244353 $ で割ったあまりを出力してください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ S $ $ A_1 $ $ A_2 $ $ ... $ $ A_N $

## 输出格式

$ f(L,\ R) $ の和を $ 998244353 $ で割ったあまりを出力せよ。

## 说明/提示

### 制約

- 入力は全て整数である。
- $ 1\ \leq\ N\ \leq\ 3000 $
- $ 1\ \leq\ S\ \leq\ 3000 $
- $ 1\ \leq\ A_i\ \leq\ 3000 $

### Sample Explanation 1

それぞれ以下のように計算できて、その和は $ 5 $ です。 - $ f(1,1)\ =\ 0 $ - $ f(1,2)\ =\ 1 $ ($ (1,\ 2) $ の $ 1 $ つ) - $ f(1,3)\ =\ 2 $ ($ (1,\ 2) $ と $ (3) $ の $ 2 $ つ) - $ f(2,2)\ =\ 0 $ - $ f(2,3)\ =\ 1 $ ($ (3) $ の $ 1 $ つ) - $ f(3,3)\ =\ 1 $ ($ (3) $ の $ 1 $ つ)

## 样例 #1

### 输入

```
3 4

2 2 4
```

### 输出

```
5
```

## 样例 #2

### 输入

```
5 8

9 9 9 9 9
```

### 输出

```
0
```

## 样例 #3

### 输入

```
10 10

3 1 4 1 5 9 2 6 5 3
```

### 输出

```
152
```



---

---
title: "[ABC162E] Sum of gcd of Tuples (Hard)"
layout: "post"
diff: 普及+/提高
pid: AT_abc162_e
tag: []
---

# [ABC162E] Sum of gcd of Tuples (Hard)

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc162/tasks/abc162_e

$ 1 $ 以上 $ K $ 以下の整数からなる長さ $ N $ の数列 $ \{A_1,...,A_N\} $ を考えます。

そのようなものは $ K^N $ 個ありますが、その全てについての $ \gcd(A_1,...,A_N) $ の和を求めてください。

ただし、答えは非常に大きくなる可能性があるため、和を $ (10^9+7) $ で割ったあまりを出力してください。

なお、$ \gcd(A_1,...,A_N) $ は $ A_1,...,A_N $ の最大公約数を表します。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ K $

## 输出格式

$ K^N $ 個の数列全てについての $ \gcd(A_1,...,A_N) $ の和を $ (10^9+7) $ で割ったあまりを出力せよ。

## 说明/提示

### 制約

- $ 2\ \leq\ N\ \leq\ 10^5 $
- $ 1\ \leq\ K\ \leq\ 10^5 $
- 入力は全て整数

### Sample Explanation 1

$ \gcd(1,1,1)+\gcd(1,1,2)+\gcd(1,2,1)+\gcd(1,2,2) $ $ +\gcd(2,1,1)+\gcd(2,1,2)+\gcd(2,2,1)+\gcd(2,2,2) $ $ =1+1+1+1+1+1+1+2=9 $ となるため、答えは $ 9 $ です。

### Sample Explanation 3

和を $ 10^9+7 $ で割った余りを出力してください。

## 样例 #1

### 输入

```
3 2
```

### 输出

```
9
```

## 样例 #2

### 输入

```
3 200
```

### 输出

```
10813692
```

## 样例 #3

### 输入

```
100000 100000
```

### 输出

```
742202979
```



---

---
title: "[ABC165E] Rotation Matching"
layout: "post"
diff: 普及+/提高
pid: AT_abc165_e
tag: []
---

# [ABC165E] Rotation Matching

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc165/tasks/abc165_e

あなたは「AtCoderじゃんけん」という一対一のゲームの大会を主催することになりました。 大会の参加者は $ N $ 人で、それぞれには $ 1 $ から $ N $ の相異なる番号が割り振られています。 アリーナには二人が入ることのできる対戦場が $ M $ 個用意されており、あなたはそれぞれの対戦場に二つの相異なる $ 1 $ 以上 $ N $ 以下の整数を割り当てなければいけません。 複数の対戦場に同じ整数を割り当てることはできません。 大会は $ N $ ラウンドによって構成され、それぞれのラウンドは以下のようにして取り行われます。

- それぞれの参加者は、自分の番号が割り当てられた対戦場が存在するならそこに行き、そこに来たもう一方の相手と対戦する。
- その後、それぞれの参加者が、自分の番号に $ 1 $ を足す。もし $ 1 $ を足した後の番号が $ N+1 $ であるなら、その値を $ 1 $ に変更する。

$ N $ 回のラウンドを通じて、二回以上同じ参加者と対戦するような参加者が存在しないようにしたいです。 このような条件を満たす対戦場への整数の割り当てをひとつ出力してください。 ただし、与えられる制約のもとでそのような割り当てが必ず存在することが示せます。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ M $

## 输出格式

以下の形式で $ M $ 行に出力せよ。 $ i $ 行目には $ i $ 個目の対戦場に割り当てる二つの整数を出力せよ。

> $ a_1 $ $ b_1 $ $ a_2 $ $ b_2 $ $ : $ $ a_M $ $ b_M $

## 说明/提示

### 制約

- $ 1\ \leq\ M $
- $ M\ \times\ 2\ +1\ \leq\ N\ \leq\ 200000 $

### Sample Explanation 1

参加者 $ 4 $ 人を $ A,B,C,D $ とし、はじめ A には $ 1 $、Bには $ 2 $、Cには $ 3 $、Dには $ 4 $ が割り振られているとします。 - $ 1 $ 回目のラウンドでは $ 2 $ の割り振られた B と $ 3 $ の割り振られた C が対戦し、A の番号が $ 2 $ 、B の番号が $ 3 $、Cの番号が $ 4 $、D の番号が $ 1 $となります。 - $ 2 $ 回目のラウンドでは $ 2 $ の割り振られた A と $ 3 $ の割り振られた B が対戦し、A の番号が $ 3 $ 、B の番号が $ 4 $、C の番号が $ 1 $、D の番号が $ 2 $ となります。 - $ 3 $ 回目のラウンドでは $ 2 $ の割り振られた D と $ 3 $ の割り振られた A が対戦し、A の番号が $ 4 $ 、B の番号が $ 1 $、C の番号が $ 2 $、D の番号が $ 3 $ となります。 - $ 4 $ 回目のラウンドでは $ 2 $ の割り振られた C と $ 3 $ の割り振られた D が対戦し、A の番号が $ 1 $ 、B の番号が $ 2 $、C の番号が $ 3 $、D の番号が $ 4 $ となります。 $ 4 $ 回のラウンドを通じて二回以上同じ参加者と対戦するような参加者が存在しないため、この出力は正解となります。

## 样例 #1

### 输入

```
4 1
```

### 输出

```
2 3
```

## 样例 #2

### 输入

```
7 3
```

### 输出

```
1 6

2 5

3 4
```



---

---
title: "[ABC166F] Three Variables Game"
layout: "post"
diff: 普及+/提高
pid: AT_abc166_f
tag: []
---

# [ABC166F] Three Variables Game

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc166/tasks/abc166_f

あるゲームでは $ 3 $ つの変数があり、それぞれ $ A,B,C $ で表されます。

ゲームの進行と共に、あなたは $ N $ 回の選択に迫られます。 それぞれの選択は文字列 $ s_i $ によって示され、 $ s_i $ が `AB` のとき、$ A $ と $ B $ のどちらかに $ 1 $ を足しもう一方から $ 1 $ を引くこと、 `AC` のとき、$ A $ と $ C $ のどちらかに $ 1 $ を足しもう一方から $ 1 $ を引くこと、 `BC` のとき、$ B $ と $ C $ のどちらかに $ 1 $ を足しもう一方から $ 1 $ を引くことを意味します。

いずれの選択の後にも、$ A,B,C $ のいずれも負の値になってはいけません。

この条件を満たしつつ $ N $ 回すべての選択を終えることが可能であるか判定し、可能であるならそのような選択方法をひとつ示してください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ A $ $ B $ $ C $ $ s_1 $ $ s_2 $ $ : $ $ s_N $

## 输出格式

条件を満たしつつ $ N $ 個すべての選択を終えることが可能である場合は `Yes` を、そうでない場合は `No` を出力せよ。

加えて、前者の場合は続く $ N $ 行に選択方法を示せ。$ i+1 $ 行目には $ i $ 回目の選択で $ 1 $ を足す変数の名前 (`A`, `B`, `C` のいずれか) を出力せよ。

## 说明/提示

### 制約

- $ 1\ \leq\ N\ \leq\ 10^5 $
- $ 0\ \leq\ A,B,C\ \leq\ 10^9 $
- $ N,\ A,\ B,\ C $ は整数である。
- $ s_i $ は `AB`, `AC`, `BC` のいずれか

### Sample Explanation 1

次のようにすることで $ 2 $ 回すべての選択を終えることができます。 - $ 1 $ 回目の選択では、$ A $ に $ 1 $ を足し $ B $ から $ 1 $ を引く。$ A $ の値が $ 2 $ に、$ B $ の値が $ 2 $ に変化する。 - $ 2 $ 回目の選択では、$ C $ に $ 1 $ を足し $ A $ から $ 1 $ を引く。$ C $ の値が $ 1 $ に、$ A $ の値が $ 1 $ に変化する。

## 样例 #1

### 输入

```
2 1 3 0

AB

AC
```

### 输出

```
Yes

A

C
```

## 样例 #2

### 输入

```
3 1 0 0

AB

BC

AB
```

### 输出

```
No
```

## 样例 #3

### 输入

```
1 0 9 0

AC
```

### 输出

```
No
```

## 样例 #4

### 输入

```
8 6 9 1

AC

BC

AB

BC

AC

BC

AB

AB
```

### 输出

```
Yes

C

B

B

C

C

B

A

A
```



---

---
title: "[ABC167E] Colorful Blocks"
layout: "post"
diff: 普及+/提高
pid: AT_abc167_e
tag: []
---

# [ABC167E] Colorful Blocks

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc167/tasks/abc167_e

$ N $ 個のブロックが横一列に並んでいます。このブロック列に色を塗ります。

$ 2 $ つのブロック列の塗り方が異なるとは、あるブロックが存在して、そのブロックが異なる色で塗られていることと定義します。

次の条件を満たすブロック列の塗り方が何通りあるか求めてください。

- 各ブロックを色 $ 1 $ から色 $ M $ までのいずれか一色で塗る。使わない色があってもよい。
- 隣り合うブロックの組であって同じ色で塗られている組は、 $ K $ 組以下である。

ただし、答えは非常に大きくなる場合があるので、 $ 998244353 $ で割った余りを出力してください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ M $ $ K $

## 输出格式

答えを出力せよ。

## 说明/提示

### 制約

- 入力は全て整数
- $ 1\ \leq\ N,\ M\ \leq\ 2\ \times\ 10^5 $
- $ 0\ \leq\ K\ \leq\ N\ -\ 1 $

### Sample Explanation 1

ブロック列の塗り方を色を書き並べた文字列で表すと、条件を満たすブロック列の色の塗り方は、`112` , `121`, `122`, `211`, `212`, `221` です。

## 样例 #1

### 输入

```
3 2 1
```

### 输出

```
6
```

## 样例 #2

### 输入

```
100 100 0
```

### 输出

```
73074801
```

## 样例 #3

### 输入

```
60522 114575 7559
```

### 输出

```
479519525
```



---

---
title: "[ABC168E] ∙ (Bullet)"
layout: "post"
diff: 普及+/提高
pid: AT_abc168_e
tag: []
---

# [ABC168E] ∙ (Bullet)

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc168/tasks/abc168_e

$ N $ 匹のイワシが釣れました。$ i $ 匹目のイワシの美味しさは $ A_i $、香り高さは $ B_i $ です。

この中から $ 1 $ 匹以上のイワシを選んで同じクーラーボックスに入れますが、互いに仲が悪い $ 2 $ 匹を同時に選ぶことはできません。

$ i $ 匹目と $ j\ (\neq\ i) $ 匹目のイワシは、$ A_i\ \cdot\ A_j\ +\ B_i\ \cdot\ B_j\ =\ 0 $ を満たすとき(また、その時に限り)仲が悪いです。

イワシの選び方は何通りあるでしょう？答えは非常に大きくなる可能性があるので、$ 1000000007 $ で割ったあまりを出力してください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ A_1 $ $ B_1 $ $ : $ $ A_N $ $ B_N $

## 输出格式

答えを $ 1000000007 $ で割ったあまりを出力せよ。

## 说明/提示

### 制約

- 入力はすべて整数
- $ 1\ \leq\ N\ \leq\ 2\ \times\ 10^5 $
- $ -10^{18}\ \leq\ A_i,\ B_i\ \leq\ 10^{18} $

### Sample Explanation 1

条件を満たす選び方は以下の $ 5 $ 通りです。 - $ 1 $ 匹目 - $ 1,\ 2 $ 匹目 - $ 2 $ 匹目 - $ 2,\ 3 $ 匹目 - $ 3 $ 匹目

## 样例 #1

### 输入

```
3

1 2

-1 1

2 -1
```

### 输出

```
5
```

## 样例 #2

### 输入

```
10

3 2

3 2

-1 1

2 -1

-3 -9

-8 12

7 7

8 1

8 2

8 4
```

### 输出

```
479
```



---

---
title: "[ABC169E] Count Median"
layout: "post"
diff: 普及+/提高
pid: AT_abc169_e
tag: []
---

# [ABC169E] Count Median

## 题目描述

有 $N$ 个整数 $X_1, X_2, X_3,\cdots,X_N $，满足 $A_i \le X_i \le B_i$。

求 $X_1，X_2,\cdots,X_N$ 的中位数可能的不同值的数量。

## 输入格式

第一行，一个整数 $N$。  
接下来 $N$ 行，每行两个整数 $A_i$，$B_i$。

## 输出格式

一行一个整数，代表可能的不同中位数取值。

Translated by @[immccn123](https://www.luogu.com.cn/user/385633).

## 样例 #1

### 输入

```
2

1 2

2 3
```

### 输出

```
3
```

## 样例 #2

### 输入

```
3

100 100

10 10000

1 1000000000
```

### 输出

```
9991
```



---

---
title: "[ABC169F] Knapsack for All Subsets"
layout: "post"
diff: 普及+/提高
pid: AT_abc169_f
tag: []
---

# [ABC169F] Knapsack for All Subsets

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc169/tasks/abc169_f

長さ $ N $ の正整数列 $ A_1 $, $ A_2 $, $ \ldots $, $ A_N $ と正の整数 $ S $ が与えられます。  
 集合$ \{1,\ 2,\ \ldots\ ,\ N\ \} $ の空でない部分集合 $ T $ について、$ f(T) $ を以下のように定めます。

- $ T $ の空でない部分集合 $ \{x_1,\ x_2,\ \ldots\ ,\ x_k\ \} $ であって、 $ A_{x_1}+A_{x_2}+\cdots\ +A_{x_k}\ =\ S $ をみたすものの個数

$ T $ として考えられる集合は $ 2^N-1 $ 通りありますが、そのすべてに対する $ f(T) $ の和を求めてください。ただし、答えは非常に大きくなることがあるので、$ 998244353 $ で割ったあまりを出力してください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ S $ $ A_1 $ $ A_2 $ $ ... $ $ A_N $

## 输出格式

$ f(T) $ の和を $ 998244353 $ で割ったあまりを出力せよ。

## 说明/提示

### 制約

- 入力は全て整数である。
- $ 1\ \leq\ N\ \leq\ 3000 $
- $ 1\ \leq\ S\ \leq\ 3000 $
- $ 1\ \leq\ A_i\ \leq\ 3000 $

### Sample Explanation 1

それぞれ以下のように計算できて、その和は $ 6 $ です。 - $ f(\{1\})\ =\ 0 $ - $ f(\{2\})\ =\ 0 $ - $ f(\{3\})\ =\ 1 $ ( $ \{3\} $ の $ 1 $ つ) - $ f(\{1,\ 2\})\ =\ 1 $ ( $ \{1,\ 2\} $ の $ 1 $ つ) - $ f(\{2,\ 3\})\ =\ 1 $ ( $ \{3\} $ の $ 1 $ つ) - $ f(\{1,\ 3\})\ =\ 1 $ ( $ \{3\} $ の $ 1 $ つ) - $ f(\{1,\ 2,\ 3\})\ =\ 2 $ ( $ \{1,\ 2\},\ \{3\} $ の $ 2 $ つ)

## 样例 #1

### 输入

```
3 4

2 2 4
```

### 输出

```
6
```

## 样例 #2

### 输入

```
5 8

9 9 9 9 9
```

### 输出

```
0
```

## 样例 #3

### 输入

```
10 10

3 1 4 1 5 9 2 6 5 3
```

### 输出

```
3296
```



---

---
title: "[ABC170E] Smart Infants"
layout: "post"
diff: 普及+/提高
pid: AT_abc170_e
tag: []
---

# [ABC170E] Smart Infants

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc170/tasks/abc170_e

AtCoder に参加している幼児が $ N $ 人おり、$ 1 $ から $ N $ の番号が付けられています。また、幼稚園が $ 2\times\ 10^5 $ 校あり、$ 1 $ から $ 2\times\ 10^5 $ の番号が付けられています。 幼児 $ i $ のレートは $ A_i $ であり、はじめ幼稚園 $ B_i $ に所属しています。

これから $ Q $ 回にわたって、転園が行われます。 $ j $ 回目の転園では、幼児 $ C_j $ の所属を幼稚園 $ D_j $ に変更します。

ここで、「平等さ」を、AtCoderに参加している幼児が一人以上いるような幼稚園それぞれについて園内で最もレートの高い幼児のレートを求め、その最小値として得られる値とします。

$ Q $ 回それぞれの転園後の平等さを求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ Q $ $ A_1 $ $ B_1 $ $ A_2 $ $ B_2 $ $ : $ $ A_N $ $ B_N $ $ C_1 $ $ D_1 $ $ C_2 $ $ D_2 $ $ : $ $ C_Q $ $ D_Q $

## 输出格式

$ Q $ 行出力せよ。 $ j $ 行目には、$ j $ 回目の転園の後の平等さを出力せよ。

## 说明/提示

### 制約

- $ 1\ \leq\ N,Q\ \leq\ 2\ \times\ 10^5 $
- $ 1\ \leq\ A_i\ \leq\ 10^9 $
- $ 1\ \leq\ C_j\ \leq\ N $
- $ 1\ \leq\ B_i,D_j\ \leq\ 2\ \times\ 10^5 $
- 入力はすべて整数である。
- $ j $ 回目の転園の前後で幼児 $ C_j $ の所属は異なる。

### Sample Explanation 1

はじめ、幼稚園 $ 1 $ には幼児 $ 1,\ 4 $、幼稚園 $ 2 $ には幼児 $ 2,\ 5 $、幼稚園 $ 3 $ には幼児 $ 3,\ 6 $ が所属しています。 $ 1 $ 回目の転園で幼児 $ 4 $ の所属を幼稚園 $ 3 $ に変更すると、幼稚園 $ 1 $ には幼児 $ 1 $、幼稚園 $ 2 $ には幼児 $ 2,\ 5 $、幼稚園 $ 3 $ には幼児 $ 3,\ 4,\ 6 $ が所属している状態になります。幼稚園 $ 1 $ で最もレートの高い幼児のレートは $ 8 $、幼稚園 $ 2 $ では $ 6 $、幼稚園 $ 3 $ では $ 9 $ です。これらの最小値は $ 6 $ であるので、$ 1 $ 行目には $ 6 $ を出力します。 $ 2 $ 回目の転園で $ 2 $ 番目の幼児の所属を幼稚園 $ 1 $ に変更すると、幼稚園 $ 1 $ には幼児 $ 1,\ 2 $、幼稚園 $ 2 $ には幼児 $ 5 $、幼稚園 $ 3 $ には幼児 $ 3,\ 4,\ 6 $ が所属している状態になります。幼稚園 $ 1 $ で最もレートの高い幼児のレートは $ 8 $、幼稚園 $ 2 $ では $ 2 $、幼稚園 $ 3 $ では $ 9 $ です。これらの最小値は $ 2 $ であるので、$ 2 $ 行目には $ 2 $ を出力します。 $ 3 $ 回目の転園で $ 1 $ 番目の幼児の所属を幼稚園 $ 2 $ に変更すると、幼稚園 $ 1 $ には幼児 $ 2 $、幼稚園 $ 2 $ には幼児 $ 1,\ 5 $、幼稚園 $ 3 $ には幼児 $ 3,\ 4,\ 6 $ が所属している状態になります。幼稚園 $ 1 $ で最もレートの高い幼児のレートは $ 6 $、幼稚園 $ 2 $ では $ 8 $、幼稚園 $ 3 $ では $ 9 $ です。これらの最小値は $ 6 $ であるので、$ 3 $ 行目には $ 6 $ を出力します。

## 样例 #1

### 输入

```
6 3

8 1

6 2

9 3

1 1

2 2

1 3

4 3

2 1

1 2
```

### 输出

```
6

2

6
```

## 样例 #2

### 输入

```
2 2

4208 1234

3056 5678

1 2020

2 2020
```

### 输出

```
3056

4208
```



---

---
title: "[ABC171F] Strivore"
layout: "post"
diff: 普及+/提高
pid: AT_abc171_f
tag: []
---

# [ABC171F] Strivore

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc171/tasks/abc171_f

「好きな英小文字 $ 1 $ 文字を好きな位置に挿入する」という操作を文字列 $ S $ にちょうど $ K $ 回繰り返してできる文字列は何通りあるでしょう？

答えは非常に大きくなる可能性があるので、$ (10^9+7) $ で割ったあまりを出力してください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ K $ $ S $

## 输出格式

条件を満たす文字列の個数を $ (10^9+7) $ で割ったあまりを出力せよ。

## 说明/提示

### 制約

- $ K $ は $ 1 $ 以上 $ 10^6 $ 以下の整数
- $ S $ は英小文字からなる長さ $ 1 $ 以上 $ 10^6 $ 以下の文字列

### Sample Explanation 1

たとえば、`proofend`、`moonwolf`、`onionpuf` などが条件を満たします。 それに対し、`oofsix`、`oofelevennn`、`voxafolt`、`fooooooo` などは条件を満たしません。

## 样例 #1

### 输入

```
5

oof
```

### 输出

```
575111451
```

## 样例 #2

### 输入

```
37564

whydidyoudesertme
```

### 输出

```
318008117
```



---

---
title: "[ABC172E] NEQ"
layout: "post"
diff: 普及+/提高
pid: AT_abc172_e
tag: []
---

# [ABC172E] NEQ

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc172/tasks/abc172_e

$ 1 $ 以上 $ M $ 以下の整数からなる長さ $ N $ の数列 $ A_1,A_2,\cdots,\ A_{N} $ と $ B_1,B_2,\cdots,\ B_{N} $ の組であって、以下の条件をすべて満たすものの個数を求めてください。

- $ 1\leq\ i\leq\ N $ なる任意の $ i $ について $ A_i\ \neq\ B_i $
- $ 1\leq\ i\ <\ j\leq\ N $ なる任意の $ (i,j) $ について $ A_i\ \neq\ A_j $ かつ $ B_i\ \neq\ B_j $

ただし、答えは非常に大きくなる可能性があるので、$ (10^9+7) $ で割ったあまりを出力してください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ M $

## 输出格式

答えを $ (10^9+7) $ で割ったあまりを出力せよ。

## 说明/提示

### 制約

- $ 1\leq\ N\ \leq\ M\ \leq\ 5\times10^5 $
- 入力はすべて整数

### Sample Explanation 1

$ A_1=1,A_2=2,B_1=2,B_2=1 $ のときと $ A_1=2,A_2=1,B_1=1,B_2=2 $ のとき条件が満たされます。

## 样例 #1

### 输入

```
2 2
```

### 输出

```
2
```

## 样例 #2

### 输入

```
2 3
```

### 输出

```
18
```

## 样例 #3

### 输入

```
141421 356237
```

### 输出

```
881613484
```



---

---
title: "[ABC173E] Multiplication 4"
layout: "post"
diff: 普及+/提高
pid: AT_abc173_e
tag: []
---

# [ABC173E] Multiplication 4

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc173/tasks/abc173_e

$ N $ 個の整数 $ A_1,\ldots,A_N $ が与えられます。

このなかからちょうど $ K $ 個の要素を選ぶとき、選んだ要素の積としてありえる最大値を求めてください。

そして、答えを $ (10^9+7) $ で割った余りを $ 0 $ 以上 $ 10^9+6 $ 以下の整数として出力してください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ K $ $ A_1 $ $ \ldots $ $ A_N $

## 输出格式

答えを $ (10^9+7) $ で割った余りを、$ 0 $ 以上 $ 10^9+6 $ 以下の整数として出力せよ。

## 说明/提示

### 制約

- $ 1\ \leq\ K\ \leq\ N\ \leq\ 2\times\ 10^5 $
- $ |A_i|\ \leq\ 10^9 $

### Sample Explanation 1

要素を $ 2 $ 個選んだときの積としてありえる値は $ 2,-3,-4,-6,-8,12 $ なので、最大値は $ 12 $ です。

### Sample Explanation 2

要素を $ 3 $ 個選んだときの積としてありえる値は $ -24,-12,-8,-6 $ なので、最大値は $ -6 $ です。 これを $ (10^9+7) $ で割った余りである $ 1000000001 $ を出力します。

### Sample Explanation 3

要素を $ 1 $ 個選んだときの積としてありえる値は $ -1,1000000000 $ なので、最大値は $ 1000000000 $ です。

### Sample Explanation 4

答えを $ (10^9+7) $ で割った余りを出力してください。

## 样例 #1

### 输入

```
4 2

1 2 -3 -4
```

### 输出

```
12
```

## 样例 #2

### 输入

```
4 3

-1 -2 -3 -4
```

### 输出

```
1000000001
```

## 样例 #3

### 输入

```
2 1

-1 1000000000
```

### 输出

```
1000000000
```

## 样例 #4

### 输入

```
10 10

1000000000 100000000 10000000 1000000 100000 10000 1000 100 10 1
```

### 输出

```
999983200
```



---

---
title: "[ABC173F] Intervals on Tree"
layout: "post"
diff: 普及+/提高
pid: AT_abc173_f
tag: []
---

# [ABC173F] Intervals on Tree

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc173/tasks/abc173_f

$ N $ 頂点 $ N-1 $ 辺から成る木があり、頂点には $ 1,\ 2,\cdots,\ N $ の番号が、辺には $ 1,\ 2,\ \cdots,\ N-1 $ の番号がついています。辺 $ i $ は頂点 $ u_i,\ v_i $ を繋いでいます。

整数 $ 1\ \leq\ L\ \leq\ R\ \leq\ N $ に対して関数 $ f(L,\ R) $ を次のように定義します。

- $ S $ を番号が $ L $ 以上 $ R $ 以下の頂点から成る集合とする。頂点集合 $ S $ と、両端が $ S $ に属する辺のみから成るような部分グラフの連結成分の個数を $ f(L,\ R) $ で表す。

$ \sum_{L=1}^{N}\ \sum_{R=L}^{N}\ f(L,\ R) $ を計算してください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ u_1 $ $ v_1 $ $ u_2 $ $ v_2 $ $ : $ $ u_{N-1} $ $ v_{N-1} $

## 输出格式

$ \sum_{L=1}^{N}\ \sum_{R=L}^{N}\ f(L,\ R) $ を出力せよ。

## 说明/提示

### 制約

- $ 1\ \leq\ N\ \leq\ 2\ \times\ 10^5 $
- $ 1\ \leq\ u_i,\ v_i\ \leq\ N $
- 与えられるグラフは木である
- 入力は全て整数である

### Sample Explanation 1

考えられる $ L,\ R $ の組み合わせは以下の $ 6 $ 通りがあります。 - $ L\ =\ 1,\ R\ =\ 1 $ のとき、$ S\ =\ \{1\} $ であり、連結成分の個数は $ 1 $ です。 - $ L\ =\ 1,\ R\ =\ 2 $ のとき、$ S\ =\ \{1,\ 2\} $ であり、連結成分の個数は $ 2 $ です。 - $ L\ =\ 1,\ R\ =\ 3 $ のとき、$ S\ =\ \{1,\ 2,\ 3\} $ であり、辺 $ 1,\ 2 $ は両端が $ S $ に含まれるので、連結成分の個数は $ 1 $ です。 - $ L\ =\ 2,\ R\ =\ 2 $ のとき、$ S\ =\ \{2\} $ であり、連結成分の個数は $ 1 $ です。 - $ L\ =\ 2,\ R\ =\ 3 $ のとき、$ S\ =\ \{2,\ 3\} $ であり、辺 $ 2 $ は両端が $ S $ に含まれるので、連結成分の個数は $ 1 $ です。 - $ L\ =\ 3,\ R\ =\ 3 $ のとき、$ S\ =\ \{3\} $ であり、連結成分の個数は $ 1 $ です。 これらの和は $ 7 $ です。

## 样例 #1

### 输入

```
3

1 3

2 3
```

### 输出

```
7
```

## 样例 #2

### 输入

```
2

1 2
```

### 输出

```
3
```

## 样例 #3

### 输入

```
10

5 3

5 7

8 9

1 9

9 10

8 4

7 4

6 10

7 2
```

### 输出

```
113
```



---

---
title: "[ABC175D] Moving Piece"
layout: "post"
diff: 普及+/提高
pid: AT_abc175_d
tag: []
---

# [ABC175D] Moving Piece

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc175/tasks/abc175_d

高橋君は $ 1,\ 2,\ \cdots,\ N $ の番号のついた $ N $ マスから成るマス目の上で、コマを使ってゲームを行おうとしています。マス $ i $ には整数 $ C_i $ が書かれています。また、$ 1,\ 2\ …,\ N $ の順列 $ P_1,\ P_2,\ \cdots,\ P_N $ が与えられています。

これから高橋君は好きなマスを $ 1 $ つ選んでコマを $ 1 $ つ置き、$ 1 $ 回以上 $ K $ 回以下の好きな回数だけ、次のような方法でコマを移動させます。

- $ 1 $ 回の移動では、現在コマがマス $ i\ (1\ \leq\ i\ \leq\ N) $ にあるなら、コマをマス $ P_i $ に移動させる。このとき、スコアに $ C_{P_i} $ が加算される。

高橋君のために、ゲーム終了時のスコアとしてあり得る値の最大値を求めてください。(ゲーム開始時のスコアは $ 0 $ です。)

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ K $ $ P_1 $ $ P_2 $ $ \cdots $ $ P_N $ $ C_1 $ $ C_2 $ $ \cdots $ $ C_N $

## 输出格式

ゲーム終了時のスコアとしてあり得る値の最大値を出力せよ。

## 说明/提示

### 制約

- $ 2\ \leq\ N\ \leq\ 5000 $
- $ 1\ \leq\ K\ \leq\ 10^9 $
- $ 1\ \leq\ P_i\ \leq\ N $
- $ P_i\ \neq\ i $
- $ P_1,\ P_2,\ \cdots,\ P_N $ は全て異なる
- $ -10^9\ \leq\ C_i\ \leq\ 10^9 $
- 入力は全て整数である

### Sample Explanation 1

好きなマスから始めて $ 2 $ 回以下コマを移動させる方法は以下の通りです。 - 初めマス $ 1 $ にコマを置く場合。$ 1 $ 回移動するとマス $ 2 $ に動き、スコアが $ 4 $ になる。$ 2 $ 回移動するとマス $ 4 $ に動き、スコアが $ 4\ +\ (-8)\ =\ -4 $ になる。 - 初めマス $ 2 $ にコマを置く場合。$ 1 $ 回移動するとマス $ 4 $ に動き、スコアが $ -8 $ になる。$ 2 $ 回移動するとマス $ 1 $ に動き、スコアが $ -8\ +\ 3\ =\ -5 $ になる。 - 初めマス $ 3 $ にコマを置く場合。$ 1 $ 回移動するとマス $ 5 $ に動き、スコアが $ 8 $ になる。$ 2 $ 回移動するとマス $ 3 $ に動き、スコアが $ 8\ +\ (-10)\ =\ -2 $ になる。 - 初めマス $ 4 $ にコマを置く場合。$ 1 $ 回移動するとマス $ 1 $ に動き、スコアが $ 3 $ になる。$ 2 $ 回移動するとマス $ 2 $ に動き、スコアが $ 3\ +\ 4\ =\ 7 $ になる。 - 初めマス $ 5 $ にコマを置く場合。$ 1 $ 回移動するとマス $ 3 $ に動き、スコアが $ -10 $ になる。$ 2 $ 回移動するとマス $ 5 $ に動き、スコアが $ -10\ +\ 8\ =\ -2 $ になる。 これらの最大値は $ 8 $ です。

### Sample Explanation 3

最低 $ 1 $ 回はコマを移動させる必要があります。

### Sample Explanation 4

答えの絶対値は非常に大きくなる場合があります。

## 样例 #1

### 输入

```
5 2

2 4 5 1 3

3 4 -10 -8 8
```

### 输出

```
8
```

## 样例 #2

### 输入

```
2 3

2 1

10 -7
```

### 输出

```
13
```

## 样例 #3

### 输入

```
3 3

3 1 2

-1000 -2000 -3000
```

### 输出

```
-1000
```

## 样例 #4

### 输入

```
10 58

9 1 6 7 8 4 3 2 10 5

695279662 988782657 -119067776 382975538 -151885171 -177220596 -169777795 37619092 389386780 980092719
```

### 输出

```
29507023469
```



---

---
title: "[ABC175E] Picking Goods"
layout: "post"
diff: 普及+/提高
pid: AT_abc175_e
tag: []
---

# [ABC175E] Picking Goods

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc175/tasks/abc175_e

$ R $ 行 $ C $ 列に並んだマス目に $ K $ 個のアイテムが置いてあります。$ 1\ \leq\ i\ \leq\ R $ 行目、 $ 1\ \leq\ j\ \leq\ C $ 列目のマスを $ (i,\ j) $ と表すとき、$ i $ 番目のアイテムはマス $ (r_i,\ c_i) $ に存在し、その価値は $ v_i $ です。

高橋君はマス $ (1,\ 1) $ からスタートしてゴールのマス $ (R,\ C) $ まで移動します。高橋君はマス $ (i,\ j) $ にいるとき、次には (存在すれば) マス $ (i\ +\ 1,\ j) $ またはマス $ (i,\ j\ +\ 1) $ に移動することができます。

高橋君は通ったマス (スタートとゴールも含む) のアイテムを拾うことができます。ただし、マス目の同じ行では $ 3 $ 個までしかアイテムを拾うことができません。通ったマスにアイテムがある場合に、そのアイテムを拾わないことはできます。

高橋君が拾うことのできるアイテムの価値の合計としてありうる値の最大値を求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ R $ $ C $ $ K $ $ r_1 $ $ c_1 $ $ v_1 $ $ r_2 $ $ c_2 $ $ v_2 $ $ : $ $ r_K $ $ c_K $ $ v_K $

## 输出格式

高橋君が拾うことのできるアイテムの価値の合計としてありうる値の最大値を出力せよ。

## 说明/提示

### 制約

- $ 1\ \leq\ R,\ C\ \leq\ 3000 $
- $ 1\ \leq\ K\ \leq\ \min(2\ \times\ 10^5,\ R\ \times\ C) $
- $ 1\ \leq\ r_i\ \leq\ R $
- $ 1\ \leq\ c_i\ \leq\ C $
- $ (r_i,\ c_i)\ \neq\ (r_j,\ c_j)\ (i\ \neq\ j) $
- $ 1\ \leq\ v_i\ \leq\ 10^9 $
- 入力は全て整数である

### Sample Explanation 1

移動の方法は以下の $ 2 $ 通りあります。 - マス $ (1,\ 1) $ 、マス $ (1,\ 2) $、マス $ (2,\ 2) $ の順に移動する。このとき拾うことのできるアイテムの価値の合計は $ 3\ +\ 5\ =\ 8 $ である。 - マス $ (1,\ 1) $ 、マス $ (2,\ 1) $、マス $ (2,\ 2) $ の順に移動する。このとき拾うことのできるアイテムの価値の合計は $ 3\ +\ 4\ =\ 7 $ である。 よって、高橋君が拾うことのできるアイテムの価値の合計としてありうる値の最大値は $ 8 $ です。

### Sample Explanation 2

$ 1 $ 行目にアイテムが $ 4 $ 個あります。次のように移動してアイテムを拾う方法が最適です。 - マス $ (1,\ 1) $ 、マス $ (1,\ 2) $、マス $ (1,\ 3) $、マス $ (1,\ 4) $ 、マス $ (2,\ 4) $、マス $ (2,\ 5) $ の順に移動する。このうちマス $ (1,\ 2) $ にあるアイテムのみ拾わないことにすると、アイテムの価値の合計は $ 3\ +\ 4\ +\ 2\ +\ 20\ =\ 29 $ である。

## 样例 #1

### 输入

```
2 2 3

1 1 3

2 1 4

1 2 5
```

### 输出

```
8
```

## 样例 #2

### 输入

```
2 5 5

1 1 3

2 4 20

1 2 1

1 3 4

1 4 2
```

### 输出

```
29
```

## 样例 #3

### 输入

```
4 5 10

2 5 12

1 5 12

2 3 15

1 2 20

1 1 28

2 4 26

3 2 27

4 5 21

3 5 10

1 3 10
```

### 输出

```
142
```



---

---
title: "[ABC178F] Contrast"
layout: "post"
diff: 普及+/提高
pid: AT_abc178_f
tag: []
---

# [ABC178F] Contrast

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc178/tasks/abc178_f

長さ $ N $ の数列 $ A $ と $ B $ が与えられます。 $ A,B $ はそれぞれ昇順にソートされています。 $ B $ を好きに並べ替えてすべての $ i(1\ \leq\ i\ \leq\ N) $ について $ A_i\ \neq\ B_i $ を満たすようにできるか判定し、できるならそのような $ B $ の並べ替え方を一つ示してください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ A_1 $ $ A_2 $ $ \cdots $ $ A_N $ $ B_1 $ $ B_2 $ $ \cdots $ $ B_N $

## 输出格式

条件を満たす並べ替え方が存在しない場合 `No` と出力せよ。

条件を満たす並べ替え方が存在する場合、一行目に `Yes` を出力し、二行目に並べ替え方を出力せよ。 二行目には並び替えた後の $ B $ を空白区切りで出力せよ。

条件を満たす並べ替え方が複数存在する場合、そのうちどれを出力しても構わない。

## 说明/提示

### 制約

- $ 1\leq\ N\ \leq\ 2\ \times\ 10^5 $
- $ 1\leq\ A_i,B_i\ \leq\ N $
- $ A,B $ はそれぞれ昇順にソートされている。
- 入力はすべて整数

## 样例 #1

### 输入

```
6

1 1 1 2 2 3

1 1 1 2 2 3
```

### 输出

```
Yes

2 2 3 1 1 1
```

## 样例 #2

### 输入

```
3

1 1 2

1 1 3
```

### 输出

```
No
```

## 样例 #3

### 输入

```
4

1 1 2 3

1 2 3 3
```

### 输出

```
Yes

3 3 1 2
```



---

---
title: "[ABC179F] Simplified Reversi"
layout: "post"
diff: 普及+/提高
pid: AT_abc179_f
tag: []
---

# [ABC179F] Simplified Reversi

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc179/tasks/abc179_f

縦 $ N $ マス、横 $ N $ マスのグリッドがあります。上から $ i $ 行目、左から $ j $ 列目のマスをマス$ (i,j) $ と表します。

グリッドの中央 $ (N-2)\times\ (N-2) $ マスには黒い石が $ 1 $ 個ずつ置いてあり、下辺と右辺の計 $ 2N-1 $ マスには白い石が $ 1 $ 個ずつ置いてあります。

$ Q $ 個のクエリが与えられるので、順番に処理してください。 クエリには $ 2 $ 種類あり、入力形式とクエリの内容は以下のとおりです。

- `1 x`： $ (1,x) $ に白い石を置く。そこから下方向に最も近い白い石との間にある黒い石を全て白い石に置き換える
- `2 x`： $ (x,1) $ に白い石を置く。そこから右方向に最も近い白い石との間にある黒い石を全て白い石に置き換える

$ Q $ 個のクエリを全て処理したあとグリッド上に黒い石はいくつありますか。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ Q $ $ Query_1 $ $ \vdots $ $ Query_Q $

## 输出格式

$ Q $ 個のクエリを全て処理したあとグリッド上にある黒い石の個数を出力せよ。

## 说明/提示

### 制約

- $ 3\ \leq\ N\ \leq\ 2\times\ 10^5 $
- $ 0\ \leq\ Q\ \leq\ \min(2N-4,2\times\ 10^5) $
- $ 2\ \leq\ x\ \leq\ N-1 $
- 同じクエリが複数回与えられることはない

### Sample Explanation 1

各クエリにより、グリッドは次のように変化します。 !\[図\](https://img.atcoder.jp/ghi/31ba2cd6b3155b137f0e007299225028.png)

## 样例 #1

### 输入

```
5 5

1 3

2 3

1 4

2 2

1 2
```

### 输出

```
1
```

## 样例 #2

### 输入

```
200000 0
```

### 输出

```
39999200004
```

## 样例 #3

### 输入

```
176527 15

1 81279

2 22308

2 133061

1 80744

2 44603

1 170938

2 139754

2 15220

1 172794

1 159290

2 156968

1 56426

2 77429

1 97459

2 71282
```

### 输出

```
31159505795
```



---

---
title: "[ABC183F] Confluence"
layout: "post"
diff: 普及+/提高
pid: AT_abc183_f
tag: []
---

# [ABC183F] Confluence

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc183/tasks/abc183_f

$ N $ 人の生徒が登校しようとしています。生徒 $ i $ はクラス $ C_i $ に属しています。

各生徒はそれぞれの家から出発したあと、他の生徒と合流を繰り返しながら学校へ向かいます。一度合流した生徒が分かれることはありません。

$ Q $ 個のクエリが与えられるので、順番に処理してください。クエリには $ 2 $ 種類あり、入力形式とクエリの内容は以下の通りです。

- `1 a b` : 生徒 $ a $ を含む集団と、生徒 $ b $ を含む集団が合流する (既に合流しているときは何も起こらない)
- `2 x y` : クエリの時点で既に生徒 $ x $ と合流している生徒(生徒 $ x $ を含む)のうち、クラス $ y $ に属している生徒の数を求める

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ Q $ $ C_1 $ $ \ldots $ $ C_N $ $ Query_1 $ $ \vdots $ $ Query_Q $

## 输出格式

`2 x y` のクエリに対する答えを、$ 1 $ 行に $ 1 $ つずつ、順に出力せよ。

## 说明/提示

### 制約

- $ 1\ \leq\ N\ \leq\ 2\ \times\ 10^5 $
- $ 1\ \leq\ Q\ \leq\ 2\ \times\ 10^5 $
- $ 1\ \leq\ C_i,a,b,x,y\ \leq\ N $
- `1 a b` のクエリにおいて、$ a\ \neq\ b $
- 入力はすべて整数

### Sample Explanation 1

$ 3 $ 番目のクエリの時点で、生徒 $ 1 $ は、生徒 $ 2,5 $ と合流しています。生徒 $ 1,2,5 $ のうちクラス $ 1 $ に属する生徒は $ 2 $ 人です。 $ 5 $ 番目のクエリの時点で、生徒 $ 3 $ は、生徒 $ 4 $ と合流しています。生徒 $ 3,4 $ のうちクラス $ 4 $ に属する生徒は $ 0 $ 人です。

### Sample Explanation 2

すでに同じ集団に属している生徒に対して、`1 a b` のクエリが与えられることもあります。

## 样例 #1

### 输入

```
5 5

1 2 3 2 1

1 1 2

1 2 5

2 1 1

1 3 4

2 3 4
```

### 输出

```
2

0
```

## 样例 #2

### 输入

```
5 4

2 2 2 2 2

1 1 2

1 1 3

1 2 3

2 2 2
```

### 输出

```
3
```

## 样例 #3

### 输入

```
12 9

1 2 3 1 2 3 1 2 3 1 2 3

1 1 2

1 3 4

1 5 6

1 7 8

2 2 1

1 9 10

2 5 6

1 4 8

2 6 1
```

### 输出

```
1

0

0
```



---

---
title: "[ABC184E] Third Avenue"
layout: "post"
diff: 普及+/提高
pid: AT_abc184_e
tag: []
---

# [ABC184E] Third Avenue

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc184/tasks/abc184_e

縦 $ H $ マス、横 $ W $ マスの $ 2 $ 次元グリッドで表された街があります。  
 上から $ i $ 行目、左から $ j $ 列目のマスの情報が文字 $ a_{i,j} $ により与えられます。 $ a_{i,j} $ は `S` , `G` , `.` , `#` , `a` ~ `z` のいずれかです。  
`#` は入ることができないマスを、`a` ~ `z` はテレポーターのあるマスを表します。

高橋くんははじめ `S` のマスにおり、 $ 1 $ 秒ごとに以下のいずれかの移動を行います。

- 現在いるマスと上下左右に隣り合う、`#` でないマスに移動する。
- 今いるマスと同じ文字が書かれているマスを $ 1 $ つ選び、そこにテレポートする。この移動は現在いるマスが `a` ~ `z` のいずれかであるとき使える。

高橋くんが `S` のマスから `G` のマスに移動するのに必要な最短の時間を求めてください。  
 ただし、どうしても `G` のマスにたどり着けない場合は、代わりに `-1` を出力してください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ H $ $ W $ $ a_{1,1}\dots\ a_{1,W} $ $ \vdots $ $ a_{H,1}\dots\ a_{H,W} $

## 输出格式

`S` のマスから `G` のマスに移動するのに必要な最短時間を出力せよ。  
`S` のマスから `G` のマスに移動する方法が存在しない場合は、代わりに `-1` を出力せよ。

## 说明/提示

### 制約

- $ 1\ \le\ H,\ W\ \le\ 2000 $
- $ a_{i,j} $ は `S` , `G` , `.` , `#` , 英小文字のいずれか
- `S` のマスと `G` のマスはちょうど $ 1 $ つ存在する

### Sample Explanation 1

上から $ i $ 行目、左から $ j $ 列目のマスを $ (i,\ j) $ で表すこととします。 はじめ、高橋くんは $ (1,\ 1) $ にいます。 例えば、以下のような手順で $ 4 $ 秒で $ (2,\ 5) $ に移動することができます。 - $ (1,\ 1) $ から $ (2,\ 1) $ に移動する - $ (2,\ 1) $ と同じ `a` のマスである $ (2,\ 3) $ にテレポートする - $ (2,\ 3) $ から $ (2,\ 4) $ に移動する - $ (2,\ 4) $ から $ (2,\ 5) $ に移動する

## 样例 #1

### 输入

```
2 5

S.b.b

a.a.G
```

### 输出

```
4
```

## 样例 #2

### 输入

```
11 11

S##...#c...

...#d.#.#..

..........#

.#....#...#

#.....bc...

#.##......#

.......c..#

..#........

a..........

d..#...a...

.#........G
```

### 输出

```
14
```

## 样例 #3

### 输入

```
11 11

.#.#.e#a...

.b..##..#..

#....#.#..#

.#dd..#..#.

....#...#e.

c#.#a....#.

.....#..#.e

.#....#b.#.

.#...#..#..

......#c#G.

#..S...#...
```

### 输出

```
-1
```



---

---
title: "[ABC184F] Programming Contest"
layout: "post"
diff: 普及+/提高
pid: AT_abc184_f
tag: []
---

# [ABC184F] Programming Contest

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc184/tasks/abc184_f

高橋くんはプログラミングコンテストに参加します。 このコンテストのコンテスト時間は $ T $ 分間で、 $ N $ 問の問題が出題されます。  
 高橋くんは超能力者なので、 $ i $ 番目の問題が $ A_i $ 分で解けることが分かっています。  
 高橋くんは $ N $ 問の中から $ 0 $ 問以上を、解くのにかかる時間の総和が $ T $ 分以下になるように選び、それらの問題を解きます。  
 選んだ問題を解くのにかかる時間の総和の最大値を求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ T $ $ A_1 $ $ \dots $ $ A_N $

## 输出格式

答えを整数として出力せよ。

## 说明/提示

### 制約

- 入力は全て整数
- $ 1\ \le\ N\ \le\ 40 $
- $ 1\ \le\ T\ \le\ 10^9 $
- $ 1\ \le\ A_i\ \le\ 10^9 $

### Sample Explanation 1

$ 1,2,3,4 $ 問目を選ぶと、解くのにかかる時間の総和が $ 2+3+5+7=17 $ 分となり、 $ T=17 $ 分以下での最大になります。

### Sample Explanation 2

全ての問題を解くのが最適です。

### Sample Explanation 3

どの問題も解くことができません。

### Sample Explanation 4

$ 2,3,7 $ 問目を選ぶと、解くのにかかる時間の総和が $ 273555143 $ 分になります。

## 样例 #1

### 输入

```
5 17

2 3 5 7 11
```

### 输出

```
17
```

## 样例 #2

### 输入

```
6 100

1 2 7 5 8 10
```

### 输出

```
33
```

## 样例 #3

### 输入

```
6 100

101 102 103 104 105 106
```

### 输出

```
0
```

## 样例 #4

### 输入

```
7 273599681

6706927 91566569 89131517 71069699 75200339 98298649 92857057
```

### 输出

```
273555143
```



---

---
title: "[ABC185E] Sequence Matching"
layout: "post"
diff: 普及+/提高
pid: AT_abc185_e
tag: []
---

# [ABC185E] Sequence Matching

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc185/tasks/abc185_e

長さ $ N $ の整数列 $ A $ と、長さ $ M $ の整数列 $ B $ があります。  
 高橋君は $ A $ から、いくつかの要素を取り除き、残った要素をそのままの順番で繋げることで新たな数列 $ A' $ を作ります。(一つも取り除かなくても、全部取り除いても構いません。)  
 $ B $ についても同様に、いくつかの要素を取り除き、残った要素をそのままの順番で繋げることで新たな数列 $ B' $ を作ります。(一つも取り除かなくても、全部取り除いても構いません。)  
 このとき、$ |A'|\ =\ |B'| $ となるような取り除き方をします。(数列 $ s $ について $ |s| $ は $ s $ の長さを表します。)  
 $ A,\ B $ から取り除いた合計要素数を $ x $ とし、$ 1\ \le\ i\ \le\ |A'| $ かつ $ {A'}_i\ \neq\ {B'}_i $ を満たす整数 $ i $ の数を $ y $ とするとき、$ x\ +\ y $ として考えられる最小の値を求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ M $ $ A_1\ \hspace{7pt}\ A_2\ \hspace{7pt}\ A_3\ \hspace{5pt}\ \dots\ \hspace{5pt}\ A_N $ $ B_1\ \hspace{7pt}\ B_2\ \hspace{7pt}\ B_3\ \hspace{5pt}\ \dots\ \hspace{5pt}\ B_M $

## 输出格式

$ x\ +\ y $ として考えられる最小の値を出力せよ。

## 说明/提示

### 制約

- $ 1\ \le\ N,\ M\ \le\ 1000 $
- $ 1\ \le\ A_i,\ B_i\ \le\ 10^9 $
- 入力は全て整数

### Sample Explanation 1

$ A $ から $ A_4 $ を削除して $ A' $ を作り、$ B $ からは何も削除せず $ B' $ を作ることにすると、$ x\ =\ 1 $ となります。 また、このとき $ 1\ \le\ i\ \le\ |A'| $ かつ $ {A'}_i\ \neq\ {B'}_i $ を満たす整数 $ i $ は $ 2 $ の一つのみなので $ y\ =\ 1 $ となります。そして $ x\ +\ y $ は $ 2 $ となり、これが最小です。

### Sample Explanation 2

$ A $ からは何も取り除かず、$ B $ からは $ B_4,\ B_6 $ の $ 2 $ 要素を削除すると $ x\ =\ 2,\ y\ =\ 1 $ となり、 $ x\ +\ y $ は $ 3 $ で、これが最小です。

### Sample Explanation 3

$ A $ からも $ B $ からも何も取り除かないことも許されます。

## 样例 #1

### 输入

```
4 3

1 2 1 3

1 3 1
```

### 输出

```
2
```

## 样例 #2

### 输入

```
4 6

1 3 2 4

1 5 2 6 4 3
```

### 输出

```
3
```

## 样例 #3

### 输入

```
5 5

1 1 1 1 1

2 2 2 2 2
```

### 输出

```
5
```



---

---
title: "[ABC186E] Throne"
layout: "post"
diff: 普及+/提高
pid: AT_abc186_e
tag: []
---

# [ABC186E] Throne

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc186/tasks/abc186_e

円周上に $ N $ 個の椅子が並べられています。そのうち $ 1 $ つは玉座です。

高橋君は最初、玉座から時計回りに数えて $ S $ 個隣の椅子に座っており、次の行動を繰り返します。

行動：いま座っている椅子から時計回りに数えて $ K $ 個隣の椅子に移動し座る。

高橋君がはじめて玉座に座ることができるのは何回目の行動の後ですか？ ただし、玉座に座ることが永遠にできない場合は、代わりに `-1` を出力してください。

$ T $ 個のテストケースに答えてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。$ 1 $ 行目は以下の通りである。

> $ T $

そして、続く $ T $ 行が $ T $ 個のテストケースを表す。これらはそれぞれ以下の形式の行である。

> $ N $ $ S $ $ K $

## 输出格式

各テストケースに対し、答えを出力せよ。テストケースごとに改行すること。

## 说明/提示

### 制約

- $ 1\leq\ T\ \leq\ 100 $
- $ 2\leq\ N\ \leq\ 10^9 $
- $ 1\leq\ S\ <\ N $
- $ 1\leq\ K\ \leq\ 10^9 $

### Sample Explanation 1

$ 1 $ つ目のテストケースでは、椅子が $ 10 $ 個あり、高橋君は最初、玉座から時計回りに数えて $ 4 $ 個隣の席に座っています。 時計回りに $ 3 $ 個隣の席に移動する行動を $ 2 $ 回行うと玉座に座れます。 $ 2 $ つ目のテストケースでは、高橋君が玉座に座ることは永遠にできないので、`-1` を出力します。

## 样例 #1

### 输入

```
4

10 4 3

1000 11 2

998244353 897581057 595591169

10000 6 14
```

### 输出

```
2

-1

249561088

3571
```



---

---
title: "[ABC186F] Rook on Grid"
layout: "post"
diff: 普及+/提高
pid: AT_abc186_f
tag: []
---

# [ABC186F] Rook on Grid

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc186/tasks/abc186_f

縦 $ H $ マス、横 $ W $ マスのグリッドがあります。上から $ i $ 行目、左から $ j $ 列目のマスをマス $ (i,j) $ と表します。

グリッド上には $ M $ 個の障害物があり、$ i $ 番目の障害物はマス $ (X_i,Y_i) $ に置かれています。

マス $ (1,1) $ に飛車の駒が置いてあります。飛車の駒は、今いる位置から右または下方向に伸びる直線上にあり、障害物を飛び越えずに到達できるマスに $ 1 $ 手で移動することができます。

$ 2 $ 手以内の移動で飛車の駒が到達できるマスの数を求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ H $ $ W $ $ M $ $ X_1 $ $ Y_1 $ $ \vdots $ $ X_M $ $ Y_M $

## 输出格式

$ 2 $ 手以内の移動で飛車の駒が到達できるマスの数を出力せよ。

## 说明/提示

### 制約

- $ 1\leq\ H,W\ \leq\ 2\times\ 10^5 $
- $ 0\leq\ M\ \leq\ 2\times\ 10^5 $
- $ 1\leq\ X_i\ \leq\ H $
- $ 1\leq\ Y_i\ \leq\ W $
- $ (X_i,Y_i)\ \neq\ (1,1) $
- $ (X_i,Y_i) $ は相異なる
- 入力は全て整数

### Sample Explanation 1

障害物のない全てのマスに $ 2 $ 手以内で移動できます。

### Sample Explanation 2

障害物のないマスのうち、$ (4,4),(5,4) $ 以外の全てのマスに $ 2 $ 手以内で移動できます。

## 样例 #1

### 输入

```
4 3 2

2 2

3 3
```

### 输出

```
10
```

## 样例 #2

### 输入

```
5 4 4

3 2

3 4

4 2

5 2
```

### 输出

```
14
```

## 样例 #3

### 输入

```
200000 200000 0
```

### 输出

```
40000000000
```



---

---
title: "[ABC187E] Through Path"
layout: "post"
diff: 普及+/提高
pid: AT_abc187_e
tag: []
---

# [ABC187E] Through Path

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc187/tasks/abc187_e

$ N $ 頂点 $ N-1 $ 辺から成る木があり、頂点には $ 1,\ 2,\ \dots,\ N $ の番号が、辺には $ 1,\ 2,\ \dots,\ N-1 $ の番号がついています。辺 $ i $ は頂点 $ a_i $ と頂点 $ b_i $ を結びます。 この木の各頂点には $ 1 $ つの整数が書かれています。頂点 $ i $ に書かれている整数を $ c_i $ とします。はじめ、 $ c_i\ =\ 0 $ です。

$ Q $ 個のクエリが与えられます。 $ i $ 番目のクエリでは、整数 $ t_i,\ e_i,\ x_i $ が与えられます。クエリの内容は以下の通りです。

- $ t_i\ =\ 1 $ のとき : 頂点 $ a_{e_i} $ から辺をたどって頂点 $ b_{e_i} $ を通らずに到達できるような全ての頂点 $ v $ に対して、$ c_v $ を $ c_v\ +\ x_i $ に書き換える。
- $ t_i\ =\ 2 $ のとき : 頂点 $ b_{e_i} $ から辺をたどって頂点 $ a_{e_i} $ を通らずに到達できるような全ての頂点 $ v $ に対して、$ c_v $ を $ c_v\ +\ x_i $ に書き換える。

すべてのクエリを処理した後、各頂点に書かれた整数を出力してください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ a_1 $ $ b_1 $ $ \vdots $ $ a_{N-1} $ $ b_{N-1} $ $ Q $ $ t_1 $ $ e_1 $ $ x_1 $ $ \vdots $ $ t_Q $ $ e_Q $ $ x_Q $

## 输出格式

すべてのクエリを処理した後の $ c_1,\ c_2,\ \dots,\ c_N $ をこの順に改行区切りで出力せよ。

## 说明/提示

### 制約

- 入力は全て整数
- $ 2\ \le\ N\ \le\ 2\ \times\ 10^5 $
- $ 1\ \le\ a_i,\ b_i\ \le\ N $
- 与えられるグラフは木である
- $ 1\ \le\ Q\ \le\ 2\ \times\ 10^5 $
- $ t_i\ \in\ \{1,\ 2\} $
- $ 1\ \le\ e_i\ \le\ N-1 $
- $ 1\ \le\ x_i\ \le\ 10^9 $

### Sample Explanation 1

$ 1 $ 番目のクエリでは、頂点 $ 1 $ から始めて頂点 $ 2 $ を通らずに到達できる頂点 $ 1 $ に $ 1 $ を足します。 $ 2 $ 番目のクエリでは、頂点 $ 4 $ から始めて頂点 $ 5 $ を通らずに到達できる頂点 $ 1,\ 2,\ 3,\ 4 $ に $ 10 $ を足します。 $ 3 $ 番目のクエリでは、頂点 $ 2 $ から始めて頂点 $ 1 $ を通らずに到達できる頂点 $ 2,\ 3,\ 4,\ 5 $ に $ 100 $ を足します。 $ 4 $ 番目のクエリでは、頂点 $ 3 $ から始めて頂点 $ 2 $ を通らずに到達できる頂点 $ 3 $ に $ 1000 $ を足します。

## 样例 #1

### 输入

```
5

1 2

2 3

2 4

4 5

4

1 1 1

1 4 10

2 1 100

2 2 1000
```

### 输出

```
11

110

1110

110

100
```

## 样例 #2

### 输入

```
7

2 1

2 3

4 2

4 5

6 1

3 7

7

2 2 1

1 3 2

2 2 4

1 6 8

1 3 16

2 4 32

2 1 64
```

### 输出

```
72

8

13

26

58

72

5
```

## 样例 #3

### 输入

```
11

2 1

1 3

3 4

5 2

1 6

1 7

5 8

3 9

3 10

11 4

10

2 6 688

1 10 856

1 8 680

1 8 182

2 2 452

2 4 183

2 6 518

1 3 612

2 6 339

2 3 206
```

### 输出

```
1657

1657

2109

1703

1474

1657

3202

1474

1247

2109

2559
```



---

---
title: "[ABC188F] +1-1x2"
layout: "post"
diff: 普及+/提高
pid: AT_abc188_f
tag: []
---

# [ABC188F] +1-1x2

## 题目描述

高桥君在黑板上写下了一个正整数 X，现在高桥君想要让这个正整数变成 Y，每一次都可以按以下三种中的任意一种方式来改变这个数:

1. 将目前黑板上的数加1。

2. 将目前黑板上的数减1。

3. 将目前黑板上的数乘以2。

现在高桥君想要知道从 X 变成 Y 的最小次数。

## 输入格式

两个正整数 X ， Y。

## 输出格式

X 变成 Y 的最小操作的次数。

## 说明/提示

- 1≤X≤${10^{18}}$
- 1≤Y≤${10^{18}}$

## 样例 #1

### 输入

```
3 9
```

### 输出

```
3
```

## 样例 #2

### 输入

```
7 11
```

### 输出

```
3
```

## 样例 #3

### 输入

```
1000000000000000000 1000000000000000000
```

### 输出

```
0
```



---

---
title: "[ABC189E] Rotate and Flip"
layout: "post"
diff: 普及+/提高
pid: AT_abc189_e
tag: []
---

# [ABC189E] Rotate and Flip

## 题目描述

给出 $N$ 个点，以及每个点得坐标 $(x_i,y_i)$，给出 $M$ 次操作，操作如下：

- 第一种操作：将所有点绕原点 $(0,0)$ 顺时针旋转 $90$ 度。

- 第二种操作：将所有点绕原点 $(0,0)$ 逆时针旋转 $90$ 度。

- 第三种操作：以 $x=p$ 为对称轴，将所有的点对称过去。

- 第四种操作：以 $y=p$ 为对称轴，将所有的点对称过去。

接着给出 $Q$ 组询问，每次询问在某次操作过后某个点的坐标。

## 输入格式

第一行输入 $N$，表示 $N$ 个点。

接下来 $N$ 行，每行输入 $x_i,y_i$，表示第 $i$ 个点的坐标。

第 $N+2$ 行输入 $M$，表示操作次数。

接下来 $M$ 行，每行首先输入 $opt_i$，表示执行第 $opt_i$ 种操作。如果 $opt_i=3$ 或者 $opt_i=4$，再输入一个数字 $p$，表示一条直线。

第 $N+M+3$ 行输入 $Q$，表示询问个数。

接下来 $Q$ 行，每行两个数字 $A_i,B_i$，表示询问在第 $A_i$ 次操作过后第 $B_i$ 个点的坐标。特别的，$A_i=0$  表示询问初始的坐标。

## 输出格式

输出 $Q$ 行，每行输出对于一次询问的答案。

## 样例 #1

### 输入

```
1

1 2

4

1

3 3

2

4 2

5

0 1

1 1

2 1

3 1

4 1
```

### 输出

```
1 2

2 -1

4 -1

1 4

1 0
```

## 样例 #2

### 输入

```
2

1000000000 0

0 1000000000

4

3 -1000000000

4 -1000000000

3 1000000000

4 1000000000

2

4 1

4 2
```

### 输出

```
5000000000 4000000000

4000000000 5000000000
```



---

---
title: "[ABC190E] Magical Ornament"
layout: "post"
diff: 普及+/提高
pid: AT_abc190_e
tag: []
---

# [ABC190E] Magical Ornament

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc190/tasks/abc190_e

AtCoder 王国には $ 1,\ 2,\ \dots,\ N $ の番号がついた $ N $ 種類の魔法石が流通しています。  
 高橋くんは、魔法石を一列に並べて飾りを作ろうとしています。  
 魔法石には隣り合わせにできる組とできない組があります。 隣り合わせにできる組は $ ( $魔法石 $ A_1, $ 魔法石 $ B_1),\ ( $魔法石 $ A_2, $ 魔法石 $ B_2),\ \dots,\ ( $魔法石 $ A_M, $ 魔法石 $ B_M) $ の $ M $ 組で、それ以外の組は隣り合わせることができません。(これらの組において、石の順序は不問です。)  
 魔法石 $ C_1,\ C_2,\ \dots,\ C_K $ をそれぞれ $ 1 $ 個以上含む魔法石の列を作ることができるか判定し、作れる場合はそのような列を作るのに必要な魔法石の個数の最小値を求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ M $ $ A_1 $ $ B_1 $ $ A_2 $ $ B_2 $ $ \hspace{7mm}\vdots $ $ A_M $ $ B_M $ $ K $ $ C_1 $ $ C_2 $ $ \cdots $ $ C_K $

## 输出格式

魔法石 $ C_1,\ C_2,\ \dots,\ C_K $ を含む魔法石の列を作るのに必要な魔法石の個数の最小値を出力せよ。  
 作ることができない場合、代わりに `-1` を出力せよ。

## 说明/提示

### 制約

- 入力は全て整数
- $ 1\ <\ = N\ <\ =\ 10^5 $
- $ 0\ <\ = M\ <\ =\ 10^5 $
- $ 1\ <\ =\ A_i\ <\ B_i\ <\ =\ N $
- $ i\ ≠\ j $ ならば $ (A_i,\ B_i)\ ≠\ (A_j,\ B_j) $
- $ 1\ <\ =\ K\ <\ =\ 17 $
- $ 1\ <\ =\ C_1\ <\ C_2\ <\ \dots\ <\ C_K\ <\ =\ N $

### Sample Explanation 1

例えば、魔法石を $ [1,\ 4,\ 2,\ 4,\ 3] $ と並べると、魔法石 $ 1,\ 2,\ 3 $ を含む長さ $ 5 $ の列を作ることができます。

### Sample Explanation 3

例えば、魔法石を $ [1,\ 6,\ 7,\ 5,\ 8,\ 3,\ 9,\ 3,\ 8,\ 10,\ 2] $ と並べると、魔法石 $ 1,\ 2,\ 7,\ 9 $ を含む長さ $ 11 $ の列を作ることができます。

## 样例 #1

### 输入

```
4 3

1 4

2 4

3 4

3

1 2 3
```

### 输出

```
5
```

## 样例 #2

### 输入

```
4 3

1 4

2 4

1 2

3

1 2 3
```

### 输出

```
-1
```

## 样例 #3

### 输入

```
10 10

3 9

3 8

8 10

2 10

5 8

6 8

5 7

6 7

1 6

2 4

4

1 2 7 9
```

### 输出

```
11
```



---

---
title: "[ABC190F] Shift and Inversions"
layout: "post"
diff: 普及+/提高
pid: AT_abc190_f
tag: []
---

# [ABC190F] Shift and Inversions

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc190/tasks/abc190_f

$ 0,\ 1,\ 2,\ \dots,\ N\ -\ 1 $ を並び替えた数列 $ A\ =\ [a_0,\ a_1,\ a_2,\ \dots,\ a_{N-1}] $ が与えられます。  
 $ k\ =\ 0,\ 1,\ 2,\ \dots,\ N\ -\ 1 $ のそれぞれについて、$ b_i\ =\ a_{i+k\ \bmod\ N} $ で定義される数列 $ B\ =\ [b_0,\ b_1,\ b_2,\ \dots,\ b_{N-1}] $ の転倒数を求めてください。

 転倒数とは 数列 $ A\ =\ [a_0,\ a_1,\ a_2,\ \dots,\ a_{N-1}] $ の転倒数とは、$ i\ かつ\ a_i\ >\ a_j $ を満たす添字の組 $ (i,\ j) $ の個数のことです。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ a_0 $ $ a_1 $ $ a_2 $ $ \cdots $ $ a_{N-1} $

## 输出格式

$ N $ 行出力せよ。  
 $ i\ +\ 1 $ 行目には、$ k\ =\ i $ としたときの答えを出力せよ。

## 说明/提示

### 制約

- 入力は全て整数
- $ 2\ <\ =\ N\ <\ =\ 3\ \times\ 10^5 $
- $ a_0,\ a_1,\ a_2,\ \dots,\ a_{N-1} $ は $ 0,\ 1,\ 2,\ \dots,\ N\ -\ 1 $ の並び替えである

### Sample Explanation 1

$ A\ =\ [0,\ 1,\ 2,\ 3] $ です。 $ k\ =\ 0 $ のとき、$ B\ =\ [0,\ 1,\ 2,\ 3] $ の転倒数は $ 0 $ です。 $ k\ =\ 1 $ のとき、$ B\ =\ [1,\ 2,\ 3,\ 0] $ の転倒数は $ 3 $ です。 $ k\ =\ 2 $ のとき、$ B\ =\ [2,\ 3,\ 0,\ 1] $ の転倒数は $ 4 $ です。 $ k\ =\ 3 $ のとき、$ B\ =\ [3,\ 0,\ 1,\ 2] $ の転倒数は $ 3 $ です。

## 样例 #1

### 输入

```
4

0 1 2 3
```

### 输出

```
0

3

4

3
```

## 样例 #2

### 输入

```
10

0 3 1 5 4 2 9 6 8 7
```

### 输出

```
9

18

21

28

27

28

33

24

21

14
```



---

---
title: "[ABC191E] Come Back Quickly"
layout: "post"
diff: 普及+/提高
pid: AT_abc191_e
tag: []
---

# [ABC191E] Come Back Quickly

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc191/tasks/abc191_e

AtCoder 国には、町 $ 1 $ から町 $ N $ までの $ N $ 個の町と、道路 $ 1 $ から道路 $ M $ までの $ M $ 本の道路があります。  
 道路 $ i $ は町 $ A_i $ から町 $ B_i $ への一方通行で、通るのに $ C_i $ 分かかります。$ A_i\ =\ B_i $ かもしれませんし、同じ町の組を結ぶ道路が複数あるかもしれません。  
 高橋君はこの国で散歩をしようと考えました。ある町から出発し、$ 1 $ 本以上の道路を通り、出発した町に帰ってくるような経路を**正しい散歩経路**と呼ぶことにします。  
 各町について、その町から出発する正しい散歩経路が存在するかを判定してください。また、存在するなら、そのような経路を通るのにかかる時間の最小値を求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ M $ $ A_1 $ $ B_1 $ $ C_1 $ $ A_2 $ $ B_2 $ $ C_2 $ $ A_3 $ $ B_3 $ $ C_3 $ $ \hspace{25pt}\ \vdots $ $ A_M $ $ B_M $ $ C_M $

## 输出格式

$ N $ 行に渡って出力せよ。 $ i(1\ \le\ i\ \le\ N) $ 行目には以下を出力せよ。

- 町 $ i $ から出発する正しい散歩経路が存在するなら、そのような経路を通るのにかかる時間の最小値
- 存在しないなら `-1`

## 说明/提示

### 制約

- $ 1\ \le\ N\ \le\ 2000 $
- $ 1\ \le\ M\ \le\ 2000 $
- $ 1\ \le\ A_i\ \le\ N $
- $ 1\ \le\ B_i\ \le\ N $
- $ 1\ \le\ C_i\ \le\ 10^5 $
- 入力は全て整数

### Sample Explanation 1

道路 $ 1,\ 2,\ 3 $ によって、町 $ 1,\ 2,\ 3 $ は一周に $ 30 $ 分かかる一つの輪のように繋がっています。 町 $ 4 $ から町 $ 1,\ 2,\ 3 $ に行くことはできますが、町 $ 4 $ に帰ってくることはできません。

### Sample Explanation 2

$ A_i\ =\ B_i $ であるような道路が存在するかもしれません。 この場合、町 $ 1 $ からは、道路 $ 6 $ だけを使って $ 10 $ 分で町 $ 1 $ に帰ってくることができます。

### Sample Explanation 3

同じ町の組を結ぶ道路が複数あるかもしれないことに注意してください。

## 样例 #1

### 输入

```
4 4

1 2 5

2 3 10

3 1 15

4 3 20
```

### 输出

```
30

30

30

-1
```

## 样例 #2

### 输入

```
4 6

1 2 5

1 3 10

2 4 5

3 4 10

4 1 10

1 1 10
```

### 输出

```
10

20

30

20
```

## 样例 #3

### 输入

```
4 7

1 2 10

2 3 30

1 4 15

3 4 25

3 4 20

4 3 20

4 3 30
```

### 输出

```
-1

-1

40

40
```



---

---
title: "[ABC192D] Base n"
layout: "post"
diff: 普及+/提高
pid: AT_abc192_d
tag: []
---

# [ABC192D] Base n

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc192/tasks/abc192_d

`0` ～ `9` からなる文字列 $ X $ と、整数 $ M $ が与えられます。

$ X $ に含まれる最も大きい数字を $ d $ とします。

$ d+1 $ 以上の整数 $ n $ を選んで $ X $ を $ n $ 進法表記の数とみなして得られる値のうち、$ M $ 以下であるようなものは何種類あるでしょうか？

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ X $ $ M $

## 输出格式

答えを出力せよ。

## 说明/提示

### 制約

- $ X $ は `0` ～ `9` のみからなる
- $ X $ の長さは $ 1 $ 以上 $ 60 $ 以下
- $ X $ の先頭の文字は `0` ではない
- $ 1\ \leq\ M\ \leq\ 10^{18} $

### Sample Explanation 1

$ X $ に含まれる最も大きい数字は `2` です。 - $ X $ を $ 3 $ 進法表記とみなして得られる値は $ 8 $ です。 - $ X $ を $ 4 $ 進法表記とみなして得られる値は $ 10 $ です。 得られる値のうち $ 10 $ 以下のものはこの $ 2 $ つのみです。

### Sample Explanation 2

$ X $ に含まれる最も大きい数字は `9` です。 - $ X $ を $ 10 $ 進法表記とみなして得られる値は $ 999 $ です。 - $ X $ を $ 11 $ 進法表記とみなして得られる値は $ 1197 $ です。 - $ X $ を $ 12 $ 進法表記とみなして得られる値は $ 1413 $ です。 得られる値のうち $ 1500 $ 以下のものはこの $ 3 $ つのみです。

### Sample Explanation 3

$ X $ を $ 2 $ 進法表記とみなして得られる $ 576460752303423488 $ が、唯一の $ 1000000000000000000 $ 以下の得られる数です。

## 样例 #1

### 输入

```
22

10
```

### 输出

```
2
```

## 样例 #2

### 输入

```
999

1500
```

### 输出

```
3
```

## 样例 #3

### 输入

```
100000000000000000000000000000000000000000000000000000000000

1000000000000000000
```

### 输出

```
1
```



---

---
title: "[ABC192F] Potion"
layout: "post"
diff: 普及+/提高
pid: AT_abc192_f
tag: []
---

# [ABC192F] Potion

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc192/tasks/abc192_f

$ N $ 種類の素材があり、素材 $ i $ には $ A_i $ の魔力があります。

魔法使いの高橋君は、この中から $ 1 $ 種類以上を選んで合成し、ポーションを作ろうとしています。

$ k $ 種類の素材を合成して出来たポーションの魔力は、合成した直後には素材の魔力の合計であり、時間が $ 1 $ 経過するごとに $ k $ 増加します。 魔力の増加は連続的ではなく離散的であることに注意してください。

高橋君が時刻 $ 0 $ に $ 1 $ 度だけ素材の合成を行うとき、魔力がちょうど $ X $ のポーションは、最速でいつ手に入りますか？

なお、制約下で魔力がちょうど $ X $ のポーションを作れることが証明されます。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ X $ $ A_1 $ $ \ldots $ $ A_N $

## 输出格式

魔力がちょうど $ X $ のポーションを手に入れることができる最も早い時刻を出力せよ。

## 说明/提示

### 制約

- $ 1\ \leq\ N\ \leq\ 100 $
- $ 1\ \leq\ A_i\ \leq\ 10^7 $
- $ 10^9\ \leq\ X\ \leq\ 10^{18} $
- 入力は全て整数

### Sample Explanation 1

素材 $ 1 $ と素材 $ 3 $ を合成して出来たポーションの魔力は、時刻 $ 0 $ で $ 3+8=11 $ であり、時間が $ 1 $ 経過するごとに $ 2 $ 増加するので、時刻 $ 4999999994 $ に $ 9999999999 $ になります。これが最速です。 素材 $ 1,2,3 $ 全てを合成して出来たポーションの魔力は、時刻 $ 3333333327 $ に $ 9999999998 $、時刻 $ 3333333328 $ に $ 10000000001 $ となり、ちょうど $ 9999999999 $ にはなりません。

## 样例 #1

### 输入

```
3 9999999999

3 6 8
```

### 输出

```
4999999994
```

## 样例 #2

### 输入

```
1 1000000000000000000

1
```

### 输出

```
999999999999999999
```



---

---
title: "[ABC195E] Lucky 7 Battle"
layout: "post"
diff: 普及+/提高
pid: AT_abc195_e
tag: []
---

# [ABC195E] Lucky 7 Battle

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc195/tasks/abc195_e

`0`,$ \ldots $,`9` からなる長さ $ N $ の文字列 $ S $ と、`A`,`T` からなる長さ $ N $ の文字列 $ X $ が与えられます。また、空文字列で初期化された文字列 $ T $ があります。

高橋君と青木君がこれらを使ってゲームをします。ゲームは $ N $ ラウンドからなり、$ i $ 回目 $ (1\leq\ i\ \leq\ N) $ のラウンドでは次の操作が行われます。

- $ X_i $ が `A` なら青木君が、`T` なら高橋君が以下の操作を行う
- 操作：$ T $ の末尾に $ S_i $ か `0` のどちらか一方を加える

$ N $ 回の操作が終了したあと、$ T $ は `0`,$ \ldots $,`9` からなる長さ $ N $ の文字列となります。 $ T $ を (先頭の余計な $ 0 $ を取り除いた上で) $ 10 $ 進法で表された数と解釈したとき、$ 7 $ の倍数であれば高橋君の勝ちであり、そうでなければ青木君の勝ちです。

$ 2 $ 人が最適に行動する時、どちらが勝つか判定してください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ S $ $ X $

## 输出格式

$ 2 $ 人が最適に行動する時、高橋君が勝つなら `Takahashi`、 青木君が勝つなら `Aoki` と出力せよ。

## 说明/提示

### 制約

- $ 1\ \leq\ N\ \leq\ 2\times\ 10^5 $
- $ S,X $ の長さは $ N $
- $ S $ は `0`,$ \ldots $,`9` のみからなる
- $ X $ は `A`,`T` のみからなる

### Sample Explanation 1

$ 1 $ 回目のラウンドでは青木君が `3` か `0` を $ T $ の末尾に加え、$ 2 $ 回目のラウンドでは高橋君が `5` か `0` を $ T $ の末尾に加えます。 青木君が `3` を加えた場合、高橋君が `5` を追加すると $ T $ は `35` となり、これは $ 7 $ の倍数です。 青木君が `0` を加えた場合、高橋君が `0` を追加すると $ T $ は `00` となり、これは $ 7 $ の倍数です。 したがって、かならず高橋君が勝ちます。

## 样例 #1

### 输入

```
2

35

AT
```

### 输出

```
Takahashi
```

## 样例 #2

### 输入

```
5

12345

AAAAT
```

### 输出

```
Aoki
```

## 样例 #3

### 输入

```
5

67890

TTTTA
```

### 输出

```
Takahashi
```

## 样例 #4

### 输入

```
5

12345

ATATA
```

### 输出

```
Aoki
```



---

---
title: "[ABC196E] Filters"
layout: "post"
diff: 普及+/提高
pid: AT_abc196_e
tag: []
---

# [ABC196E] Filters

## 题目描述

给出整数数列 $A=(a_1,a_2,...,a_n)$，$T=(t_1,t_2,...,t_n)$，$X=(x_1,x_2,...,x_q)$。

定义 $n$ 个函数 $f_1(x),f_2(x),...,f_n(x)$：
$$
f_i(x)=\begin{cases}
x+a_i& t_i=1\\
\max(x,a_i)& t_i=2\\
\min(x,a_i)& t_i=3\\
\end{cases}
$$
对于 $i=1,2,...,q$，求出 $f_n(...f_2(f_1(x_i))...)$ 的值。

## 输入格式

第一行一个整数 $n$，为函数的个数。

接下来 $n$ 行每行两个整数 $a_i,t_i$，含义如题面所示。

下一行有一个整数 $q$，为需要求值的点数。

接下来一行 $q$ 个整数，第 $i$ 个数为 $x_i$。

## 输出格式

输出$q$ 行，第 $i$ 行为 $f_n(...f_2(f_1(x_i))...)$ 的值。

## 说明/提示

对于 $100\%$ 的数据所有输入的值均为整数，$1 \leqslant n,q \leqslant 2 \times 10^5$，$1 \leqslant t_i \leqslant 3$，$|a_i|,|x_i| \leqslant 10^9$。

## 样例 #1

### 输入

```
3

-10 2

10 1

10 3

5

-15 -10 -5 0 5
```

### 输出

```
0

0

5

10

10
```



---

---
title: "[ABC197E] Traveler"
layout: "post"
diff: 普及+/提高
pid: AT_abc197_e
tag: []
---

# [ABC197E] Traveler

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc197/tasks/abc197_e

数直線上にボール $ 1 $ からボール $ N $ までの $ N $ 個のボールがあります。  
 ボール $ i $ は座標 $ X_i $ にあります。  
 各ボールには $ 1 $ 以上 $ N $ 以下の整数で表される色がついていて、ボール $ i $ の色は整数 $ C_i $ で表されます。  
 今座標 $ 0 $ にいるあなたは、毎秒 $ 1 $ の速さで数直線上を動き、全てのボールを回収してから再び座標 $ 0 $ に戻ります。  
 このとき、ボールの色を表す整数を回収順に並べた時に広義単調増加となっている必要があります。  
 ボールを回収するにはボールと同じ座標にいる必要がありますが、ボールを回収できる時に必ずしも回収する必要はありません。  
 座標 $ 0 $ を出発してから、全てのボールを回収して再び座標 $ 0 $ に戻るまでにかかる時間の最小値を求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ X_1 $ $ C_1 $ $ X_2 $ $ C_2 $ $ X_3 $ $ C_3 $ $ \hspace{15pt}\ \vdots $ $ X_N $ $ C_N $

## 输出格式

答え \[秒\] を出力せよ。

## 说明/提示

### 制約

- $ 1\ \le\ N\ \le\ 2\ \times\ 10^5 $
- $ |X_i|\ \le\ 10^9 $
- $ X_i\ \neq\ X_j\ (i\ \neq\ j) $
- $ X_i\ \neq\ 0 $
- $ 1\ \le\ C_i\ \le\ N $
- 入力に含まれる値は全て整数である

### Sample Explanation 1

以下のように行動するのが最適です。 - $ 3 $ 秒かけて座標 $ 3 $ に移動し、ボール $ 2 $ を回収する - $ 1 $ 秒かけて座標 $ 2 $ に移動し、ボール $ 1 $ を回収する - $ 2 $ 秒かけて座標 $ 4 $ に移動し、ボール $ 4 $ を回収する - $ 1 $ 秒かけて座標 $ 5 $ に移動し、ボール $ 5 $ を回収する - $ 4 $ 秒かけて座標 $ 1 $ に移動し、ボール $ 3 $ を回収する - $ 1 $ 秒かけて座標 $ 0 $ に戻る ボールの色を表す整数を回収順に並べると $ 1,\ 2,\ 2,\ 3,\ 3 $ と広義単調増加になっています。

## 样例 #1

### 输入

```
5

2 2

3 1

1 3

4 2

5 3
```

### 输出

```
12
```

## 样例 #2

### 输入

```
9

5 5

-4 4

4 3

6 3

-5 5

-3 2

2 2

3 3

1 4
```

### 输出

```
38
```



---

---
title: "[ABC199D] RGB Coloring 2"
layout: "post"
diff: 普及+/提高
pid: AT_abc199_d
tag: []
---

# [ABC199D] RGB Coloring 2

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc199/tasks/abc199_d

$ N $ 頂点 $ M $ 辺の単純無向グラフがあります。頂点には $ 1 $ から $ N $ までの、辺には $ 1 $ から $ M $ までの番号がついています。  
 辺 $ i $ は頂点 $ A_i $ と頂点 $ B_i $ を結んでいます。  
 このグラフの各頂点を赤、緑、青の $ 3 $ 色のいずれかで塗る方法であって、以下の条件を満たすものの数を求めてください。

- 辺で直接結ばれている $ 2 $ 頂点は必ず異なる色で塗られている

なお、使われない色があっても構いません。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ M $ $ A_1 $ $ B_1 $ $ A_2 $ $ B_2 $ $ A_3 $ $ B_3 $ $ \hspace{15pt}\ \vdots $ $ A_M $ $ B_M $

## 输出格式

答えを出力せよ。

## 说明/提示

### 制約

- $ 1\ \le\ N\ \le\ 20 $
- $ 0\ \le\ M\ \le\ \frac{N(N\ -\ 1)}{2} $
- $ 1\ \le\ A_i\ \le\ N $
- $ 1\ \le\ B_i\ \le\ N $
- 与えられるグラフは単純 (多重辺や自己ループを含まない)

### Sample Explanation 1

頂点 $ 1,\ 2,\ 3 $ の色をそれぞれ $ c_1,\ c_2,\ c_3 $ とし、赤、緑、青をそれぞれ `R`, `G`, `B` で表すと、以下の $ 6 $ 通りが条件を満たします。 - $ c_1c_2c_3\ = $ `RGB` - $ c_1c_2c_3\ = $ `RBG` - $ c_1c_2c_3\ = $ `GRB` - $ c_1c_2c_3\ = $ `GBR` - $ c_1c_2c_3\ = $ `BRG` - $ c_1c_2c_3\ = $ `BGR`

### Sample Explanation 2

辺がないため、各頂点の色を自由に決めることができます。

### Sample Explanation 3

条件を満たす塗り方が存在しない場合もあります。

### Sample Explanation 4

答えは $ 32 $ ビット符号付き整数型に収まらないことがあります。

## 样例 #1

### 输入

```
3 3

1 2

2 3

3 1
```

### 输出

```
6
```

## 样例 #2

### 输入

```
3 0
```

### 输出

```
27
```

## 样例 #3

### 输入

```
4 6

1 2

2 3

3 4

2 4

1 3

1 4
```

### 输出

```
0
```

## 样例 #4

### 输入

```
20 0
```

### 输出

```
3486784401
```



---

---
title: "[ABC199E] Permutation"
layout: "post"
diff: 普及+/提高
pid: AT_abc199_e
tag: []
---

# [ABC199E] Permutation

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc199/tasks/abc199_e

$ (1,\ 2,\ 3,\ \dots,\ N) $ を並び替えてできる数列 $ a $ であって、以下の条件を満たすものの数を出力してください。

- $ 1\ \le\ i\ \le\ M $ を満たす全ての整数 $ i $ について、$ a_1,\ a_2,\ a_3,\ \dots,\ a_{X_i} $ の中に $ Y_i $ 以下の数は $ Z_i $ 個以下しか存在しない

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ M $ $ X_1 $ $ Y_1 $ $ Z_1 $ $ X_2 $ $ Y_2 $ $ Z_2 $ $ X_3 $ $ Y_3 $ $ Z_3 $ $ \hspace{23pt}\ \vdots $ $ X_M $ $ Y_M $ $ Z_M $

## 输出格式

答えを出力せよ。

## 说明/提示

### 制約

- $ 2\ \le\ N\ \le\ 18 $
- $ 0\ \le\ M\ \le\ 100 $
- $ 1\ \le\ X_i\ \lt\ N $
- $ 1\ \le\ Y_i\ \lt\ N $
- $ 0\ \le\ Z_i\ \lt\ N $
- 入力に含まれる値は全て整数である

### Sample Explanation 1

条件を満たす $ a $ は以下の $ 4 $ つです。 - $ (1,\ 3,\ 2) $ - $ (2,\ 3,\ 1) $ - $ (3,\ 1,\ 2) $ - $ (3,\ 2,\ 1) $ $ (1,\ 2,\ 3) $ や $ (2,\ 1,\ 3) $ は、$ a_1,\ a_2 $ の中に $ 2 $ 以下の数が $ 2 $ つあるため条件を満たしません。

## 样例 #1

### 输入

```
3 1

2 2 1
```

### 输出

```
4
```

## 样例 #2

### 输入

```
5 2

3 3 2

4 4 3
```

### 输出

```
90
```

## 样例 #3

### 输入

```
18 0
```

### 输出

```
6402373705728000
```



---

---
title: "[ABC201D] Game in Momotetsu World"
layout: "post"
diff: 普及+/提高
pid: AT_abc201_d
tag: []
---

# [ABC201D] Game in Momotetsu World

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc201/tasks/abc201_d

$ H $ 行 $ W $ 列のマス目があり、各マスは青マスまたは赤マスのどちらかです。上から $ i $ 番目、左から $ j $ 番目のマスは、$ A_{i,\ j} $ が `+` なら青マスであり、`-` なら赤マスです。  
 最初、このマス目の一番左上のマスに一つ駒が置かれていて、高橋君と青木君はこの駒を使ってゲームをします。  
 $ 2 $ 人の得点は最初 $ 0 $ 点ずつです。$ 2 $ 人は、高橋君から始めて交互に次の操作をします。

- 駒を一つ右または一つ下のマスに動かす。ただし、駒がマス目の外に出るような動かし方はできない。動かした人は、駒の移動後のマスが青マスなら $ 1 $ 点を得て、赤マスなら $ 1 $ 点を失う。

どちらかが操作できなくなった時点でゲームは終了します。ゲームの結果は、終了時の $ 2 $ 人の得点が異なるならば得点の大きい方が勝ち、同じならば引き分けとなります。  
 両者とも自分の勝敗が最適になるように行動したとき、ゲームの結果を求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ H $ $ W $ $ A_{1,\ 1}A_{1,\ 2}A_{1,\ 3}\ \dots\ A_{1,\ W} $ $ A_{2,\ 1}A_{2,\ 2}A_{2,\ 3}\ \dots\ A_{2,\ W} $ $ A_{3,\ 1}A_{3,\ 2}A_{3,\ 3}\ \dots\ A_{3,\ W} $ $ \hspace{2cm}\vdots $ $ A_{H,\ 1}A_{H,\ 2}A_{H,\ 3}\ \dots\ A_{H,\ W} $

## 输出格式

高橋君が勝つなら `Takahashi` を、青木君が勝つなら `Aoki` を、引き分けになるなら `Draw` を出力せよ。

## 说明/提示

### 制約

- $ 1\ \le\ H,\ W\ \le\ 2000 $
- $ A_{i,\ j} $ は `+` または `-`

### Sample Explanation 1

高橋君は以下のような戦略で勝つことができます。 まず高橋君が最初に駒を右に動かします。移動先のマスは赤マスなので高橋君は $ 1 $ 点を失い、高橋君と青木君の得点はそれぞれ $ -1,\ 0 $ となります。 - 青木君が次に駒を右に動かしたなら、高橋君は駒を下に動かします - 青木君が次に駒を下に動かしたなら、高橋君は駒を右に動かします いずれの場合でも青木君は赤マスに駒を動かして $ 1 $ 点を失い、高橋君は青マスに駒を動かして $ 1 $ 点を得るため、両者の得点はそれぞれ $ 0,\ -1 $ となります。 現在駒はマス目の上から $ 2 $ 番目、左から $ 3 $ 番目のマスにあるので、次の移動では青木君は下に動かすほかなく、移動先が赤マスなので両者の得点はそれぞれ $ 0,\ -2 $ となります。 もう駒は右にも下にも動かせないのでゲームは終了し、得点の大きい高橋君が勝利します。

### Sample Explanation 2

青木君は、高橋君がどのように操作しても、上手く操作すれば勝つことができます。

### Sample Explanation 3

この場合ゲームは直ちに終了し、両者得点 $ 0 $ であるため結果は引き分けとなります。

## 样例 #1

### 输入

```
3 3

---

+-+

+--
```

### 输出

```
Takahashi
```

## 样例 #2

### 输入

```
2 4

+++-

-+-+
```

### 输出

```
Aoki
```

## 样例 #3

### 输入

```
1 1

-
```

### 输出

```
Draw
```



---

---
title: "[ABC201E] Xor Distances"
layout: "post"
diff: 普及+/提高
pid: AT_abc201_e
tag: []
---

# [ABC201E] Xor Distances

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc201/tasks/abc201_e

$ N $ 頂点の重み付き木があります。$ i $ 本目の辺は頂点 $ u_i $ と頂点 $ v_i $ を双方向に結んでいて、その重みは $ w_i $ です。

頂点の組 $ (x,y) $ について、$ \text{dist}(x,y) $ を以下のように定めます。

- $ x $ から $ y $ への最短パスに含まれる辺全ての重みの **XOR**

$ 1\ \leq\ i\ \lt\ j\ \leq\ N $ を満たす全ての組 $ (i,j) $ について $ \text{dist}(i,j) $ を求め、その総和を $ (10^9+7) $ で割った余りを出力してください。

 $ \text{\ XOR\ } $ とは 整数 $ a,\ b $ のビットごとの排他的論理和 $ a\ \text{\ XOR\ }\ b $ は、以下のように定義されます。

- $ a\ \text{\ XOR\ }\ b $ を二進表記した際の $ 2^k $ ($ k\ \geq\ 0 $) の位の数は、$ a,\ b $ を二進表記した際の $ 2^k $ の位の数のうち一方のみが $ 1 $ であれば $ 1 $、そうでなければ $ 0 $ である。
 
 例えば、$ 3\ \text{\ XOR\ }\ 5\ =\ 6 $ となります (二進表記すると: $ 011\ \text{\ XOR\ }\ 101\ =\ 110 $)。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ u_1 $ $ v_1 $ $ w_1 $ $ u_2 $ $ v_2 $ $ w_2 $ $ \vdots $ $ u_{N-1} $ $ v_{N-1} $ $ w_{N-1} $

## 输出格式

$ \text{dist}(i,j) $ の総和を $ (10^9+7) $ で割った余りを出力せよ。

## 说明/提示

### 制約

- $ 2\ \leq\ N\ \leq\ 2\ \times\ 10^5 $
- $ 1\ \leq\ u_i\ \lt\ v_i\ \leq\ N $
- $ 0\ \leq\ w_i\ \lt\ 2^{60} $
- 与えられるグラフは木
- 入力は全て整数

### Sample Explanation 1

$ \text{dist}(1,2)=1, $ $ \text{dist}(1,3)=3, $ $ \text{dist}(2,3)=2 $ であり、これらの総和は $ 6 $ です。

### Sample Explanation 3

$ (10^9+7) $ で割った余りを出力してください。

## 样例 #1

### 输入

```
3

1 2 1

1 3 3
```

### 输出

```
6
```

## 样例 #2

### 输入

```
5

3 5 2

2 3 2

1 5 1

4 5 13
```

### 输出

```
62
```

## 样例 #3

### 输入

```
10

5 7 459221860242673109

6 8 248001948488076933

3 5 371922579800289138

2 5 773108338386747788

6 10 181747352791505823

1 3 803225386673329326

7 8 139939802736535485

9 10 657980865814127926

2 4 146378247587539124
```

### 输出

```
241240228
```



---

---
title: "[ABC202E] Count Descendants"
layout: "post"
diff: 普及+/提高
pid: AT_abc202_e
tag: []
---

# [ABC202E] Count Descendants

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc202/tasks/abc202_e

$ N $ 頂点の根付き木があり、頂点は $ 1,\ 2,\ \dots,\ N $ と番号付けられています。

頂点 $ 1 $ が根であり、頂点 $ i\ \,\ (2\ \leq\ i\ \leq\ N) $ の親は $ P_i $ です。

$ Q $ 個のクエリが与えられます。$ i\ \,\ (1\ \leq\ i\ \leq\ Q) $ 番目のクエリでは、整数 $ U_i,\ D_i $ が与えられるので、次の条件を全て満たす頂点 $ u $ の個数を求めてください。

- $ u $ から根への最短パス上（端点も含む）に頂点 $ U_i $ が存在する。
- $ u $ から根への最短パスに含まれる辺の数が**ちょうど** $ D_i $ である。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ P_2 $ $ P_3 $ $ \ldots $ $ P_N $ $ Q $ $ U_1 $ $ D_1 $ $ U_2 $ $ D_2 $ $ \vdots $ $ U_Q $ $ D_Q $

## 输出格式

$ Q $ 行出力せよ。 $ i $ 行目には $ i $ 番目のクエリに対する答えを出力せよ。

## 说明/提示

### 制約

- $ 2\ \leq\ N\ \leq\ 2\ \times\ 10^5 $
- $ 1\ \leq\ P_i\ <\ i $
- $ 1\ \leq\ Q\ \leq\ 2\ \times\ 10^5 $
- $ 1\ \leq\ U_i\ \leq\ N $
- $ 0\ \leq\ D_i\ \leq\ N\ -\ 1 $
- 入力は全て整数である。

### Sample Explanation 1

$ 1 $ 番目のクエリでは、頂点 $ 4,\ 5,\ 7 $ が条件を満たします。 $ 2 $ 番目のクエリでは、頂点 $ 7 $ のみが条件を満たします。 $ 3 $ 番目、$ 4 $ 番目のクエリでは、条件を満たす頂点は存在しません。 !\[sample\](https://img.atcoder.jp/ghi/abc202\_e\_sample\_00.jpg)

## 样例 #1

### 输入

```
7

1 1 2 2 4 2

4

1 2

7 2

4 1

5 5
```

### 输出

```
3

1

0

0
```



---

---
title: "[ABC203D] Pond"
layout: "post"
diff: 普及+/提高
pid: AT_abc203_d
tag: []
---

# [ABC203D] Pond

## 题目描述

### 题目大意

给定一个 $n\times n$ 的矩阵 $A$，再给定一个数 $k$，求矩阵中所有大小为 $k\times k$ 的子矩阵的中位数的最小值。

一个 $k\times k$ 的矩阵的中位数被定义为将矩阵中的所有数从大到小排序后的第 $\lfloor\frac{k^2}{2}\rfloor+1$ 个数。

## 输入格式

第一行两个正整数 $n,k$。

接下来 $n$ 行，每行 $n$ 个数，描述了一个矩阵。

## 输出格式

输出一行一个数，表示中位数的最小值。

## 说明/提示

$1\le k\le n\le 800,0\le A_{i,j}\le 10^9$。

Translated by \_Ponder_

## 样例 #1

### 输入

```
3 2

1 7 0

5 8 11

10 4 2
```

### 输出

```
4
```

## 样例 #2

### 输入

```
3 3

1 2 3

4 5 6

7 8 9
```

### 输出

```
5
```



---

---
title: "[ABC203E] White Pawn"
layout: "post"
diff: 普及+/提高
pid: AT_abc203_e
tag: []
---

# [ABC203E] White Pawn

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc203/tasks/abc203_e

$ N $ を正の整数とします。 行と列にそれぞれ $ 0 $ から $ 2N $ までの番号が付いた $ (2N+1)\times\ (2N+1) $ のマス目があり、行 $ i $ かつ列 $ j $ に属するマスを $ (i,j) $ で表します。

白のポーンが $ 1 $ つあり、最初 $ (0,N) $ に置かれています。 黒のポーンは $ M $ 個あり、$ i $ 個目の黒のポーンは $ (X_i,\ Y_i) $ に置かれています。

白のポーンが $ (i,j) $ にあるとき、あなたは以下のいずれかの操作で白のポーンを動かすことができます。

- $ 0\leq\ i\leq\ 2N-1 $, $ 0\ \leq\ j\leq\ 2N $ を満たし、$ (i+1,j) $ に黒のポーンが**無い**ならば、白のポーンを $ (i+1,j) $ に動かす。
- $ 0\leq\ i\leq\ 2N-1 $, $ 0\ \leq\ j\leq\ 2N-1 $ を満たし、$ (i+1,j+1) $ に黒のポーンが**有る**ならば、白のポーンを $ (i+1,j+1) $ に動かす。
- $ 0\leq\ i\leq\ 2N-1 $, $ 1\ \leq\ j\leq\ 2N $ を満たし、$ (i+1,j-1) $ に黒のポーンが**有る**ならば、白のポーンを $ (i+1,j-1) $ に動かす。

黒のポーンは動かすことができません。

この操作を繰り返した結果、$ (2N,Y) $ に白のポーンが置かれている状態にできるような $ Y $ の値としてあり得るものの個数を求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ M $ $ X_1 $ $ Y_1 $ $ : $ $ X_M $ $ Y_M $

## 输出格式

答えを出力せよ。

## 说明/提示

### 制約

- $ 1\ \leq\ N\ \leq\ 10^9 $
- $ 0\ \leq\ M\ \leq\ 2\times\ 10^5 $
- $ 1\ \leq\ X_i\ \leq\ 2N $
- $ 0\ \leq\ Y_i\ \leq\ 2N $
- $ (X_i,\ Y_i)\ \neq\ (X_j,\ Y_j) $ $ (i\ \neq\ j) $
- 入力は全て整数である。

### Sample Explanation 1

$ (4,0) $, $ (4,1) $, $ (4,2) $ の $ 3 $ つへはそれぞれ次のように動かせます: - $ (0,2)\to\ (1,1)\to\ (2,1)\to\ (3,1)\to\ (4,2) $ - $ (0,2)\to\ (1,1)\to\ (2,1)\to\ (3,1)\to\ (4,1) $ - $ (0,2)\to\ (1,1)\to\ (2,0)\to\ (3,0)\to\ (4,0) $ 一方、 $ (4,3) $ と $ (4,4) $ へは動かすことができません。 よって、 $ 3 $ を出力します。

### Sample Explanation 2

白のポーンを $ (0,1) $ から動かすことはできません。

## 样例 #1

### 输入

```
2 4

1 1

1 2

2 0

4 2
```

### 输出

```
3
```

## 样例 #2

### 输入

```
1 1

1 1
```

### 输出

```
0
```



---

---
title: "[ABC204E] Rush Hour 2"
layout: "post"
diff: 普及+/提高
pid: AT_abc204_e
tag: []
---

# [ABC204E] Rush Hour 2

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc204/tasks/abc204_e

AtCoder国には $ N $ 個の都市と $ M $ 本の道路があります。

都市には $ 1 $ から $ N $ の番号が、道路には $ 1 $ から $ M $ の番号が振られています。道路 $ i $ は都市 $ A_i $ と都市 $ B_i $ を双方向に結びます。

AtCoder国には時刻 $ 0 $ をピークとするラッシュアワーがあり、時刻 $ t $ に道路 $ i $ の通行を始めると、移動するのに $ C_i+\ \left\lfloor\ \frac{D_i}{t+1}\ \right\rfloor $ の時間がかかります。 ( $ \lfloor\ x\rfloor $ は $ x $ を超えない最大の整数を表す)

高橋君は時刻 $ 0 $ またはそれ以降の **整数時刻に** 都市 $ 1 $ を出発して、道路を通行することで都市 $ N $ へ向かおうとしています。

高橋君が各都市で **整数時間** 待機することができるとき、高橋君が都市 $ N $ に到達することができる最も早い時刻を出力してください。なお、制約の下で答えは整数になることが証明できます。

ただし、都市 $ N $ に到達できないときはかわりに `-1` を出力してください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ M $ $ A_1 $ $ B_1 $ $ C_1 $ $ D_1 $ $ \vdots $ $ A_M $ $ B_M $ $ C_M $ $ D_M $

## 输出格式

高橋君が都市 $ N $ に到達することができる最も早い時刻を整数で出力せよ。ただし、都市 $ N $ に到達できないときはかわりに `-1` を出力せよ。

## 说明/提示

### 制約

- $ 2\ \leq\ N\ \leq\ 10^5 $
- $ 0\ \leq\ M\ \leq\ 10^5 $
- $ 1\ \leq\ A_i,B_i\ \leq\ N $
- $ 0\ \leq\ C_i,D_i\ \leq\ 10^9 $
- 入力は全て整数

### Sample Explanation 1

最初に都市 $ 1 $ で時刻 $ 1 $ まで待機します。そして時刻 $ 1 $ に道路 $ 1 $ を使って移動をすると、移動に $ 2+\left\lfloor\ \frac{3}{1+1}\ \right\rfloor\ =\ 3 $ の時間がかかり、都市 $ 2 $ には時刻 $ 4 $ に到着することができます。 時刻 $ 4 $ より早く都市 $ 2 $ に到着することはできません。

### Sample Explanation 2

同じ都市の組を結ぶ道路が複数ある場合や、同じ都市に戻ってくる道路がある場合もあります。

### Sample Explanation 3

都市 $ 1 $ から都市 $ N $ に至る経路がないこともあります。

## 样例 #1

### 输入

```
2 1

1 2 2 3
```

### 输出

```
4
```

## 样例 #2

### 输入

```
2 3

1 2 2 3

1 2 2 1

1 1 1 1
```

### 输出

```
3
```

## 样例 #3

### 输入

```
4 2

1 2 3 4

3 4 5 6
```

### 输出

```
-1
```

## 样例 #4

### 输入

```
6 9

1 1 0 0

1 3 1 2

1 5 2 3

5 2 16 5

2 6 1 10

3 4 3 4

3 5 3 10

5 6 1 100

4 2 0 110
```

### 输出

```
20
```



---

---
title: "[ABC206E] Divide Both"
layout: "post"
diff: 普及+/提高
pid: AT_abc206_e
tag: []
---

# [ABC206E] Divide Both

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc206/tasks/abc206_e

整数 $ L,R\ (L\ \le\ R) $ が与えられるので、以下の条件を全て満たす整数組 $ (x,y) $ の数を求めてください。

- $ L\ \le\ x,y\ \le\ R $
- $ g $ を $ x,y $ の最大公約数とすると、以下が成立する。
  - $ g\ \neq\ 1 $ かつ $ \frac{x}{g}\ \neq\ 1 $ かつ $ \frac{y}{g}\ \neq\ 1 $

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ L $ $ R $

## 输出格式

答えを整数として出力せよ。

## 说明/提示

### 制約

- 入力は全て整数
- $ 1\ \le\ L\ \le\ R\ \le\ 10^6 $

### Sample Explanation 1

いくつかの整数組を例として示します。 - $ (x,y)=(4,6) $ は条件を満たします。 - $ (x,y)=(7,5) $ は $ g=1 $ となり、条件に違反します。 - $ (x,y)=(6,3) $ は $ \frac{y}{g}=1 $ となり、条件に違反します。 条件を満たすのは $ (x,y)=(4,6),(6,4) $ の $ 2 $ 組です。

## 样例 #1

### 输入

```
3 7
```

### 输出

```
2
```

## 样例 #2

### 输入

```
4 10
```

### 输出

```
12
```

## 样例 #3

### 输入

```
1 1000000
```

### 输出

```
392047955148
```



---

---
title: "[ABC207E] Mod i"
layout: "post"
diff: 普及+/提高
pid: AT_abc207_e
tag: []
---

# [ABC207E] Mod i

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc207/tasks/abc207_e

長さ $ N $ の数列 $ A $ が与えられます。$ A $ をいくつかの連続した空でない部分列 $ B_1,B_2,\ldots,B_k $ に切り分ける方法であって、以下の条件を満たすものの個数を求めてください。

- 全ての $ i\ (1\ \leq\ i\ \leq\ k) $ について、$ B_i $ に含まれる要素の総和が $ i $ で割り切れる。

答えは非常に大きくなることがあるので、$ (10^9+7) $ で割ったあまりを出力してください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ A_1 $ $ A_2 $ $ \ldots $ $ A_N $

## 输出格式

問題文中の条件を満たすような切り分け方の個数を $ (10^9+7) $ で割ったあまりを出力せよ。

## 说明/提示

### 制約

- $ 1\ \leq\ N\ \leq\ 3000 $
- $ 1\ \leq\ A_i\ \leq\ 10^{15} $
- 入力は全て整数

### Sample Explanation 1

以下の $ 3 $ 通りの切り分け方があります。 - $ (1),(2),(3),(4) $ - $ (1,2,3),(4) $ - $ (1,2,3,4) $

### Sample Explanation 3

入力が $ 32 $ bit 整数型に収まりきらない場合があります。

## 样例 #1

### 输入

```
4

1 2 3 4
```

### 输出

```
3
```

## 样例 #2

### 输入

```
5

8 6 3 3 3
```

### 输出

```
5
```

## 样例 #3

### 输入

```
10

791754273866483 706434917156797 714489398264550 918142301070506 559125109706263 694445720452148 648739025948445 869006293795825 718343486637033 934236559762733
```

### 输出

```
15
```



---

---
title: "[ABC208D] Shortest Path Queries 2"
layout: "post"
diff: 普及+/提高
pid: AT_abc208_d
tag: []
---

# [ABC208D] Shortest Path Queries 2

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc208/tasks/abc208_d

高橋王国には $ N $ 個の都市と $ M $ 本の道路があります。

都市には $ 1 $ から $ N $ の番号が、道路には $ 1 $ から $ M $ の番号が割り振られています。道路 $ i $ は都市 $ A_i $ から $ B_i $ へ向かう**一方通行**の道で、移動するのに $ C_i $ 分かかります。

$ f(s,\ t,\ k) $ を次のクエリへの答えとして定めます。

- 都市 $ s $ を出発して都市 $ t $ に到着するまでの最短時間を計算してください。ただし、通ってよい都市は $ s,\ t $ および番号が $ k $ 以下の都市のみとします。また、都市 $ t $ に到着できない場合や $ s\ =\ t $ である場合におけるクエリの答えは $ 0 $ とします。

全ての $ s,t,k $ に対して $ f(s,t,k) $ を計算して総和を出力してください。より厳密には、$ \displaystyle\ \sum_{s\ =\ 1}^N\ \sum_{t\ =\ 1}^N\ \sum_{k\ =\ 1}^N\ f(s,\ t,\ k) $ を出力してください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ M $ $ A_1 $ $ B_1 $ $ C_1 $ $ \vdots $ $ A_M $ $ B_M $ $ C_M $

## 输出格式

$ \displaystyle\ \sum_{s\ =\ 1}^N\ \sum_{t\ =\ 1}^N\ \sum_{k\ =\ 1}^N\ f(s,\ t,\ k) $ を出力せよ。

## 说明/提示

### 制約

- $ 1\ \leq\ N\ \leq\ 400 $
- $ 0\ \leq\ M\ \leq\ N(N-1) $
- $ 1\ \leq\ A_i\ \leq\ N $ $ (1\ \leq\ i\ \leq\ M) $
- $ 1\ \leq\ B_i\ \leq\ N $ $ (1\ \leq\ i\ \leq\ M) $
- $ A_i\ \neq\ B_i $ $ (1\ \leq\ i\ \leq\ M) $
- $ 1\ \leq\ C_i\ \leq\ 10^6 $ $ (1\ \leq\ i\ \leq\ M) $
- $ i\ \neq\ j $ ならば $ A_i\ \neq\ A_j $ または $ B_i\ \neq\ B_j $ である。
- 入力は全て整数である。

### Sample Explanation 1

$ f(s,t,k)\ \neq\ 0 $ であるような $ s,t,k $ を以下に挙げます。 - $ k\ =\ 1 $ のとき：$ f(1,2,1)\ =\ 3,\ f(2,3,1)\ =\ 2 $ - $ k\ =\ 2 $ のとき：$ f(1,2,2)\ =\ 3,\ f(2,3,2)\ =\ 2,\ f(1,3,2)\ =\ 5 $ - $ k\ =\ 3 $ のとき：$ f(1,2,3)\ =\ 3,\ f(2,3,3)\ =\ 2,\ f(1,3,3)\ =\ 5 $

### Sample Explanation 2

全ての $ s,t,k $ に対して $ f(s,t,k)\ =\ 0 $ です。

## 样例 #1

### 输入

```
3 2

1 2 3

2 3 2
```

### 输出

```
25
```

## 样例 #2

### 输入

```
3 0
```

### 输出

```
0
```

## 样例 #3

### 输入

```
5 20

1 2 6

1 3 10

1 4 4

1 5 1

2 1 5

2 3 9

2 4 8

2 5 6

3 1 5

3 2 1

3 4 7

3 5 9

4 1 4

4 2 6

4 3 4

4 5 8

5 1 2

5 2 5

5 3 6

5 4 5
```

### 输出

```
517
```



---

---
title: "[ABC210D] National Railway"
layout: "post"
diff: 普及+/提高
pid: AT_abc210_d
tag: []
---

# [ABC210D] National Railway

## 题目描述

## 题目翻译

国王想在他 $ H $ 行 $ W $ 列的国土上建铁路  
具体地，建铁路的花费可以表示为两部分：建车站和建轨道。  
- 在 $ (i,\ j) $ 处建车站的费用表示为 $ A_{i,j} $  
- 连接 $ (i,\ j) $ 处的车站和 $ (i',\ j') $ 处车站之间铁路的花费为 $ C\ \times\ (|i-i'|\ +\ |j-j'|) $  

由于不修铁路会下台，而国王又没有太多钱，所以想知道在不考虑便利性的前提下修铁路的最小花费。

## 输入格式

>第一行三个整数 $ H $ $ W $ $ C $  
 接下来 $ H $ 行 $ W $ 列表示在各地建车站的费用

## 输出格式

>最小花费

## 样例 #1

### 输入

```
3 4 2

1 7 7 9

9 6 3 7

7 8 6 4
```

### 输出

```
10
```

## 样例 #2

### 输入

```
3 3 1000000000

1000000 1000000 1

1000000 1000000 1000000

1 1000000 1000000
```

### 输出

```
1001000001
```



---

---
title: "[ABC210E] Ring MST"
layout: "post"
diff: 普及+/提高
pid: AT_abc210_e
tag: []
---

# [ABC210E] Ring MST

## 题目描述

- 给定一张 $n$ 个点的图，顶点的编号为 $[0, n - 1]$，同时给出两个长度为 $m$ 的数组 $a_1, a_2, \cdots, a_m$ 和 $b_1, b_2, \cdots, b_m$。

- 初始时图中并没有任何边，你可以按照以下操作加边：选择一个 $1 \le i \le m$ 和一个 $0 \le x < n$，并在顶点 $x$ 和顶点 $(x + a_i) \bmod n$ 中添加一条长度为 $b_i$ 的边。

- 你现在想要知道，你添加的边的长度总和至少为多少，才能使得整个图连通?如果无论如何都不能使整个图连通，输出 `-1`。

## 输入格式

- 第一行包含两个整数 $n, m$，分别表示图的顶点个数和数组的数组的长度。

- 接下来 $m$ 行，第 $i$ 行包含两个整数 $a_i, b_i\space(1 \le a_i \le n - 1)$。

## 输出格式

- 输出一个数，表示答案。

## 说明/提示

- 对于 $30 \%$ 的数据：$1 \le n, m \le 1000, 1 \le b_i \le 10^9$。

- 对于 $60 \%$ 的数据：$1 \le n, m \le 10^5, 1 \le b_i \le 10^9$。

- 对于 $100 \%$ 的数据：$1 \le n \le 10^9, 1 \le m \le 10^5, 1 \le b_i \le 10^9$。

翻译提供者：[Sunrize](https://www.luogu.com.cn/user/502658)。

## 样例 #1

### 输入

```
4 2

2 3

3 5
```

### 输出

```
11
```

## 样例 #2

### 输入

```
6 1

3 4
```

### 输出

```
-1
```



---

---
title: "[ABC211E] Red Polyomino"
layout: "post"
diff: 普及+/提高
pid: AT_abc211_e
tag: []
---

# [ABC211E] Red Polyomino

## 题目描述

## 题目翻译
&emsp;给你边长为 $ N $ 的且仅由字符 `#` 和 `.` 组成的正方形阵列，其中 `#` 表示黑色格子， `.` 表示白色格子。  
&emsp;你需要在白色格子中选择 $ K $ 个涂成红色，且使红色格子互相连接（仅包括上下左右相邻），求有多少种可能的方案。

## 输入格式

第一行一个整数 $ N $  
第二行一个整数 $ K $ 
以下 $ N $ 行每行 $ N $ 个字符表示给出的阵列

## 输出格式

可能的答案

## 样例 #1

### 输入

```
3

5

#.#

...

..#
```

### 输出

```
5
```

## 样例 #2

### 输入

```
2

2

#.

.#
```

### 输出

```
0
```

## 样例 #3

### 输入

```
8

8

........

........

........

........

........

........

........

........
```

### 输出

```
64678
```



---

---
title: "[ABC212E] Safety Journey"
layout: "post"
diff: 普及+/提高
pid: AT_abc212_e
tag: []
---

# [ABC212E] Safety Journey

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc212/tasks/abc212_e

AtCoder国には $ N $ 個の都市があり、都市 $ 1 $ , 都市 $ 2 $ , $ \ldots $ , 都市 $ N $ と番号付けられています。 最初、どの $ 2 $ つの相異なる都市の間も双方向に通れる道で結ばれていましたが、老朽化が進み、これらのうち $ M $ 本の道が使えなくなってしまいました。具体的には $ 1\leq\ i\ \leq\ M $ について都市 $ U_i $ と都市 $ V_i $ を結ぶ道が使えなくなってしまいました。

いま、高橋君は都市 $ 1 $ で始まり、都市 $ 1 $ で終わる $ K $ 日間の旅をしようと考えました。都市 $ 1 $ で始まり、都市 $ 1 $ で終わる $ K $ 日間の旅とは、 $ K+1 $ 個の都市の列 $ (A_0,\ A_1,\ \ldots,\ A_K) $ であって、$ A_0=A_K=1 $ をみたし、 $ 0\leq\ i\leq\ K-1 $ について $ A_i $ と $ A_{i+1} $ が相異なり、かつ都市 $ A_i $ と都市 $ A_{i+1} $ が現在も使用可能な道で結ばれているものを指します。

都市 $ 1 $ で始まり、都市 $ 1 $ で終わる $ K $ 日間の相異なる旅の数を $ 998244353 $ で割った余りを出力してください。ただし、 $ 2 $ つの $ K $ 日間の旅 $ (A_0,\ A_1,\ \ldots,\ A_K) $ と $ (B_0,\ B_1,\ \ldots,\ B_K) $ が相異なるとは、ある $ i $ が存在して $ A_i\neq\ B_i $ となることを言います。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ M $ $ K $ $ U_1 $ $ V_1 $ $ : $ $ U_M $ $ V_M $

## 输出格式

答えを出力せよ。

## 说明/提示

### 制約

- $ 2\ \leq\ N\ \leq\ 5000 $
- $ 0\ \leq\ M\ \leq\ \min\left(\ \frac{N(N-1)}{2},5000\ \right) $
- $ 2\ \leq\ K\ \leq\ 5000 $
- $ 1\ \leq\ U_i\ <\ V_i\ \leq\ N $
- $ (U_i,\ V_i) $ は全て互いに相異なる。
- 入力は全て整数である。

### Sample Explanation 1

次のような $ 4 $ 種類の旅が存在します。 - ($ 1,2,1,2,1 $) - ($ 1,2,1,3,1 $) - ($ 1,3,1,2,1 $) - ($ 1,3,1,3,1 $) これ以外に条件をみたすようなものは無いため、 $ 4 $ を出力します。

### Sample Explanation 2

使える道が $ 1 $ 本も残っておらず、条件をみたすような旅は存在しません。

## 样例 #1

### 输入

```
3 1 4

2 3
```

### 输出

```
4
```

## 样例 #2

### 输入

```
3 3 3

1 2

1 3

2 3
```

### 输出

```
0
```

## 样例 #3

### 输入

```
5 3 100

1 2

4 5

2 3
```

### 输出

```
428417047
```



---

---
title: "[ABC213E] Stronger Takahashi"
layout: "post"
diff: 普及+/提高
pid: AT_abc213_e
tag: []
---

# [ABC213E] Stronger Takahashi

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc213/tasks/abc213_e

$ H $ 行 $ W $ 列の格子状の区画に区切られた街があります。上から $ i $ 行目、左から $ j $ 列目の区画は、$ S_{i,j} $ が `.` のとき道、`#` のとき塀です。

高橋君は自分の家から魚屋に買い物に行くことにしました。高橋君の家は街の左上隅の区画にあり、魚屋は街の右下隅の区画にあります。

高橋君は、自分がいる区画から上下左右に隣接する道の区画に移動することができます。街の外に出ることはできません。  
 塀の区画に移動することはできませんが、高橋君は非常に腕力が強いため、パンチを $ 1 $ 回繰り出すことで任意の $ 2\times\ 2 $ の区画内の塀を壊して道にすることができます。

高橋君が魚屋にたどり着くためには、最低何回パンチを繰り出せばよいか求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ H $ $ W $ $ S_{1,1}\ \ldots\ S_{1,W} $ $ \vdots $ $ S_{H,1}\ \ldots\ S_{H,W} $

## 输出格式

答えを出力せよ。

## 说明/提示

### 制約

- $ 2\ \leq\ H,W\ \leq\ 500 $
- $ H,W $ は整数
- $ S_{i,j} $ は `.` または `#`
- $ S_{1,1} $ と $ S_{H,W} $ は `.`

### Sample Explanation 1

例えば、以下の `\*` で表す $ 2\times\ 2 $ の区画にある塀を破壊すると魚屋にたどり着くことができます。 ``` ..#.. #.\*\*# ##\*\*# #.#.# ..#.. ``` 破壊対象の $ 2\ \times\ 2 $ の区画の全てが塀である必要はありません。

### Sample Explanation 2

遠回りが必要ですが、塀を破壊することなく魚屋にたどり着くことができます。

## 样例 #1

### 输入

```
5 5

..#..

#.#.#

##.##

#.#.#

..#..
```

### 输出

```
1
```

## 样例 #2

### 输入

```
5 7

.......

######.

.......

.######

.......
```

### 输出

```
0
```

## 样例 #3

### 输入

```
8 8

.#######

########

########

########

########

########

########

#######.
```

### 输出

```
5
```



---

---
title: "[ABC214D] Sum of Maximum Weights"
layout: "post"
diff: 普及+/提高
pid: AT_abc214_d
tag: []
---

# [ABC214D] Sum of Maximum Weights

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc214/tasks/abc214_d

$ N $ 頂点の木があり、頂点は $ 1,\ 2,\ \dots,\ N $ と番号付けられています。  
 $ i\ \,\ (1\ \leq\ i\ \leq\ N\ -\ 1) $ 番目の辺は頂点 $ u_i $ と頂点 $ v_i $ を結び、重みは $ w_i $ です。

異なる頂点 $ u,\ v $ に対し、頂点 $ u $ から頂点 $ v $ までの最短パスに含まれる辺の重みの最大値を $ f(u,\ v) $ とおきます。

$ \displaystyle\ \sum_{i\ =\ 1}^{N\ -\ 1}\ \sum_{j\ =\ i\ +\ 1}^N\ f(i,\ j) $ を求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ u_1 $ $ v_1 $ $ w_1 $ $ \vdots $ $ u_{N\ -\ 1} $ $ v_{N\ -\ 1} $ $ w_{N\ -\ 1} $

## 输出格式

答えを出力せよ。

## 说明/提示

### 制約

- $ 2\ \leq\ N\ \leq\ 10^5 $
- $ 1\ \leq\ u_i,\ v_i\ \leq\ N $
- $ 1\ \leq\ w_i\ \leq\ 10^7 $
- 与えられるグラフは木である。
- 入力は全て整数である。

### Sample Explanation 1

$ f(1,\ 2)\ =\ 10,\ f(2,\ 3)\ =\ 20,\ f(1,\ 3)\ =\ 20 $ であるので、これらの和である $ 50 $ を出力します。

## 样例 #1

### 输入

```
3

1 2 10

2 3 20
```

### 输出

```
50
```

## 样例 #2

### 输入

```
5

1 2 1

2 3 2

4 2 5

3 5 14
```

### 输出

```
76
```



---

---
title: "[ABC214E] Packing Under Range Regulations"
layout: "post"
diff: 普及+/提高
pid: AT_abc214_e
tag: []
---

# [ABC214E] Packing Under Range Regulations

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc214/tasks/abc214_e

$ T $ 個のテストケースについて、以下の問題を解いてください。

$ 1,2,\dots,10^9 $ の番号がついた $ 10^9 $ 個の箱と、 $ 1,2,\dots,N $ の番号がついた $ N $ 個のボールがあります。  
 それぞれの箱に入れることのできるボールの個数は多くとも $ 1 $ 個です。  
 以下の条件を満たすように、 $ N $ 個のボールを全て箱に入れることができるか判定してください。

- 全ての $ 1 $ 以上 $ N $ 以下の整数 $ i $ について、番号 $ i $ のボールが $ L_i $ 以上 $ R_i $ 以下の番号がついた箱に入っている。

## 输入格式

入力は標準入力から与えられる。入力の $ 1 $ 行目は以下の形式である。

> $ T $

その後、 $ T $ 個のテストケースが続く。各テストケースは以下の形式で与えられる。

> $ N $ $ L_1 $ $ R_1 $ $ L_2 $ $ R_2 $ $ \dots $ $ L_N $ $ R_N $

## 输出格式

出力は $ T $ 行からなる。  
 $ i(1\ \le\ i\ \le\ T) $ 行目には、 $ i $ 番目に入力されたテストケースについて、問題文中の条件を満たすように $ N $ 個のボールを全て箱に入れることができるなら `Yes` 、そうでないなら `No` と出力せよ。  
 なお、正誤判定器は英大文字と英小文字を区別せず、どちらも受理する。

## 说明/提示

### 制約

- $ 1\ \le\ T\ \le\ 2\ \times\ 10^5 $
- $ 1\ \le\ N\ \le\ 2\ \times\ 10^5 $
- $ 1\ \le\ L_i\ \le\ R_i\ \le\ 10^9 $
- $ 1 $ つの入力に含まれるテストケースについて、それらの $ N $ の総和は $ 2\ \times\ 10^5 $ を超えない。

### Sample Explanation 1

この入力には $ 2 $ つのテストケースが含まれます。 - $ 1 $ つ目のテストケースについて、以下のようにボールを箱に入れると、問題文中の条件を満たすように $ 3 $ 個のボールを全て箱に入れることができるので、 `Yes` と出力します。 - ボール $ 1 $ を箱 $ 1 $ に入れる。 - ボール $ 2 $ を箱 $ 2 $ に入れる。 - ボール $ 3 $ を箱 $ 3 $ に入れる。 - $ 2 $ つ目のテストケースについて、問題文中の条件を満たすように $ 5 $ 個のボールを全て箱に入れることはできないので、 `No` と出力します。

## 样例 #1

### 输入

```
2

3

1 2

2 3

3 3

5

1 2

2 3

3 3

1 3

999999999 1000000000
```

### 输出

```
Yes

No
```



---

---
title: "[ABC214F] Substrings"
layout: "post"
diff: 普及+/提高
pid: AT_abc214_f
tag: []
---

# [ABC214F] Substrings

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc214/tasks/abc214_f

文字列 $ S $ が与えられます。高橋君はこの文字列から以下の手順にしたがって新しい文字列 $ T $ を作ります。

- まず、$ S $ の文字のうちの一つ以上に印をつける。ただし、印をつけた文字どうしが隣り合ってはならない。
- 次に、印がついていない文字を全て削除する。
- 最後に、残った文字列を $ T $ とする。ただし、この時に文字を並び替えてはならない。

$ T $ としてありうる文字列は何種類ありますか？ $ (10^9\ +\ 7) $ で割ったあまりを求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ S $

## 输出格式

$ T $ としてありうる文字列の種類数を $ (10^9\ +\ 7) $ で割ったあまりを出力せよ。

## 说明/提示

### 制約

- $ S $ は英小文字のみからなる長さ $ 1 $ 以上 $ 2\ \times\ 10^5 $ 以下の文字列

### Sample Explanation 1

$ T $ としてありうるものは `a`、 `b`、 `c`、 `ac` の $ 4 $ つです。 $ S $ の $ 1 $ 文字目のみに印をつけたとき $ T $ は `a`、 $ S $ の $ 2 $ 文字目のみに印をつけたとき $ T $ は `b`、 $ S $ の $ 3 $ 文字目のみに印をつけたとき $ T $ は `c`、 $ S $ の $ 1 $ 文字目と $ 3 $ 文字目のみに印をつけたとき $ T $ は `ac`、 となります。例えば $ 1 $ 文字目と $ 2 $ 文字目の両方に印をつけることはできないことに注意してください。

### Sample Explanation 2

$ T $ としてありうるものは `a` のみです。 印をつけた位置が異なっていても $ T $ が同じ文字列となる可能性があることに注意してください。

### Sample Explanation 3

$ T $ としてありうるものは `a`、 `b`、 `c`、 `aa`、 `ab`、 `ca` の $ 6 $ つです。

## 样例 #1

### 输入

```
abc
```

### 输出

```
4
```

## 样例 #2

### 输入

```
aa
```

### 输出

```
1
```

## 样例 #3

### 输入

```
acba
```

### 输出

```
6
```

## 样例 #4

### 输入

```
chokudai
```

### 输出

```
54
```



---

---
title: "[ABC215E] Chain Contestant"
layout: "post"
diff: 普及+/提高
pid: AT_abc215_e
tag: []
---

# [ABC215E] Chain Contestant

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc215/tasks/abc215_e

別世界の AtCoder では現在、 AAC, ..., AJC の $ 10 $ 種類のコンテストが開催されており、これから $ N $ 回のコンテストが開催されます。  
 各コンテストの種類は文字列 $ S $ として与えられ、 $ S $ の $ i $ 文字目が $ x $ なら $ i $ 回目には A$ x $C が開催されます。  
 シカの AtCoDeer くんは、 $ N $ 個のコンテストから $ 1 $ 個以上いくつか選んで、以下の条件を満たすように選んで出場します。

- 出るコンテストを順番を保ったまま抜き出したとき、コンテストの種類ごとにひとかたまりとなっている。
  - 厳密には、 AtCoDeer くんが $ x $ 個のコンテストに出場し、そのうち $ i $ 回目のコンテストの種類が $ T_i $ であるとき、全ての $ 1\ \le\ i\ <\ j\ <\ k\ \le\ x $ を満たす整数組 $ (i,j,k) $ に対して、 $ T_i=T_k $ であるならば $ T_i=T_j $ でなければならない。

AtCoDeer くんが出場するコンテストの選び方として考えられるものの総数を $ 998244353 $ で割った余りを求めてください。  
 ただし、 $ 2 $ つのコンテストの選び方が異なるとは、あるコンテスト $ c $ が存在して、片方の選び方では $ c $ に出場するがもう片方の選び方では出場しないということを指します。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ S $

## 输出格式

答えを整数として出力せよ。

## 说明/提示

### 制約

- $ 1\ \le\ N\ \le\ 1000 $
- $ |S|=N $
- $ S $ は `A` から `J` までの英大文字のみからなる

### Sample Explanation 1

例えば、 $ 1,3 $ 回目のコンテストに出場する、 $ 2,4 $ 回目のコンテストに出場するという選び方は条件を満たします。 一方、 $ 1,2,3,4 $ 回目のコンテストに出場する場合、 ABC への出場がひとかたまりになっておらず、整数組 $ (i,j,k)=(1,2,3) $ について条件に違反します。 また、全てのコンテストに出場しないということも認められません。 問題文の条件に適する出場するコンテストの選び方は $ 13 $ 通りあります。

### Sample Explanation 2

総数を $ 998244353 $ で割った余りを求めることに注意してください。

## 样例 #1

### 输入

```
4

BGBH
```

### 输出

```
13
```

## 样例 #2

### 输入

```
100

BBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBIEIJEIJIJCGCCFGIEBIHFCGFBFAEJIEJAJJHHEBBBJJJGJJJCCCBAAADCEHIIFEHHBGF
```

### 输出

```
330219020
```



---

---
title: "[ABC215F] Dist Max 2"
layout: "post"
diff: 普及+/提高
pid: AT_abc215_f
tag: []
---

# [ABC215F] Dist Max 2

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc215/tasks/abc215_f

$ 2 $ 次元平面上の $ N $ 個の相異なる点が与えられます。点 $ i\,\ (1\ \leq\ i\ \leq\ N) $ の座標は $ (x_i,y_i) $ です。

$ 2 $ つの点 $ i,j\,\ (1\ \leq\ i,j\ \leq\ N) $ の距離を $ \mathrm{min}\ (|x_i-x_j|,|y_i-y_j|) $ 、すなわち $ x $ 座標の差と $ y $ 座標の差の小さい方と定義します。

異なる $ 2 $ つの点の距離の最大値を求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ x_1 $ $ y_1 $ $ x_2 $ $ y_2 $ $ \vdots $ $ x_N $ $ y_N $

## 输出格式

異なる $ 2 $ つの点の距離の最大値を出力せよ。

## 说明/提示

### 制約

- $ 2\ \leq\ N\ \leq\ 200000 $
- $ 0\ \leq\ x_i,y_i\ \leq\ 10^9 $
- $ (x_i,y_i) $ $ \neq $ $ (x_j,y_j) $ $ (i\ \neq\ j) $
- 入力は全て整数である。

### Sample Explanation 1

点 $ 1 $ と点 $ 2 $ の距離は $ 2 $ 、点 $ 1 $ と点 $ 3 $ の距離は $ 4 $ 、点 $ 2 $ と点 $ 3 $ の距離は $ 1 $ です。よって $ 4 $ を出力してください。

## 样例 #1

### 输入

```
3

0 3

3 1

4 10
```

### 输出

```
4
```

## 样例 #2

### 输入

```
4

0 1

0 4

0 10

0 6
```

### 输出

```
0
```

## 样例 #3

### 输入

```
8

897 729

802 969

765 184

992 887

1 104

521 641

220 909

380 378
```

### 输出

```
801
```



---

---
title: "[ABC216F] Max Sum Counting"
layout: "post"
diff: 普及+/提高
pid: AT_abc216_f
tag: []
---

# [ABC216F] Max Sum Counting

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc216/tasks/abc216_f

長さ $ N $ の数列 $ A\ =\ (A_1,\ \dots,\ A_N),\ B\ =\ (B_1,\ \dots,\ B_N) $ が与えられます。$ \{1,2,\ldots,N\} $ の空でない部分集合 $ S $ であって、以下の条件を満たすものの個数を数えてください。

- $ \max_{i\ \in\ S}\ A_i\ \geq\ \sum_{i\ \in\ S}\ B_i $

なお、答えは非常に大きくなることがあるため、$ 998244353 $ で割ったあまりを出力してください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ A_1 $ $ A_2 $ $ \ldots $ $ A_N $ $ B_1 $ $ B_2 $ $ \ldots $ $ B_N $

## 输出格式

問題文中の条件を満たす $ S $ の個数を $ 998244353 $ で割ったあまりを出力せよ。

## 说明/提示

### 制約

- $ 1\ \leq\ N\ \leq\ 5000 $
- $ 1\ \leq\ A_i,B_i\ \leq\ 5000 $
- 入力は全て整数

### Sample Explanation 1

$ \{1,2,\ldots,N\} $ の空でない部分集合としてあり得るものは、$ \{1\} $, $ \{2\} $, $ \{1,2\} $ の $ 3 $ 通りです。 - $ S=\{1\} $ のとき $ \max_{i\ \in\ S}\ A_i=3 $, $ \sum_{i\ \in\ S}\ B_i=1 $ - $ S=\{2\} $ のとき $ \max_{i\ \in\ S}\ A_i=1 $, $ \sum_{i\ \in\ S}\ B_i=2 $ - $ S=\{1,2\} $ のとき $ \max_{i\ \in\ S}\ A_i=3 $, $ \sum_{i\ \in\ S}\ B_i=3 $ であるため、問題文中の条件、即ち $ \max_{i\ \in\ S}\ A_i\ \geq\ \sum_{i\ \in\ S}\ B_i $ を満たす $ S $ は $ \{1\} $ と $ \{1,2\} $ の $ 2 $ 通りです。

### Sample Explanation 2

条件を満たす $ S $ が存在しない場合もあります。

## 样例 #1

### 输入

```
2

3 1

1 2
```

### 输出

```
2
```

## 样例 #2

### 输入

```
2

1 1

2 2
```

### 输出

```
0
```

## 样例 #3

### 输入

```
20

1937 3980 2689 1208 3640 1979 581 2271 4229 3948 3708 1522 4161 4661 3797 96 3388 3395 2920 2247

4485 2580 174 1156 3770 3396 3558 3500 3494 479 269 3383 1230 1711 3545 3919 134 475 3796 1017
```

### 输出

```
476
```



---

---
title: "[ABC216G] 01Sequence"
layout: "post"
diff: 普及+/提高
pid: AT_abc216_g
tag: []
---

# [ABC216G] 01Sequence

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc216/tasks/abc216_g

`0` と `1` のみからなる長さ $ N $ の数列 $ A=(A_1,A_2,\dots,A_N) $ であって、以下の条件を満たすものを考えます。

> すべての $ i=1,2,\dots,M $ について、$ A_{L_i}, A_{L_i+1},\dots\ ,A_{R_i} $ に `1` が $ X_i $ 個以上含まれる

条件を満たす数列 $ A $ のうち、含まれる `1` の数が**最も少ない**例を $ 1 $ つ出力してください。

なお、制約のもとで条件を満たす数列 $ A $ は必ず存在します。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ M $ $ L_1 $ $ R_1 $ $ X_1 $ $ L_2 $ $ R_2 $ $ X_2 $ $ \vdots $ $ L_M $ $ R_M $ $ X_M $

## 输出格式

`0` と `1` のみからなる数列 $ A $ を空白区切りで出力せよ。

> $ A_1 $ $ A_2 $ $ \dots $ $ A_N $

数列 $ A $ は上記の条件を全て満たさなければならない。

## 说明/提示

### 制約

- $ 1\ \leq\ N\ \leq\ 2\ \times\ 10^5 $
- $ 1\ \leq\ M\ \leq\ \min(2\ \times\ 10^5,\ \frac{N(N+1)}{2}\ ) $
- $ 1\ \leq\ L_i\ \leq\ R_i\ \leq\ N $
- $ 1\ \leq\ X_i\ \leq\ R_i-L_i+1 $
- $ i\ \neq\ j $ ならば $ (L_i,R_i)\ \neq\ (L_j,R_j) $
- 入力は全て整数

### Sample Explanation 1

`1 1 0 1 1 0` などの答えも正解です。 `0 1 1 1 1 1` などの答えは含まれる `1` の数が最小化されていないので、不正解です。

## 样例 #1

### 输入

```
6 3

1 4 3

2 2 1

4 6 2
```

### 输出

```
0 1 1 1 0 1
```

## 样例 #2

### 输入

```
8 2

2 6 1

3 5 3
```

### 输出

```
0 0 1 1 1 0 0 0
```



---

---
title: "[ABC218F] Blocked Roads"
layout: "post"
diff: 普及+/提高
pid: AT_abc218_f
tag: []
---

# [ABC218F] Blocked Roads

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc218/tasks/abc218_f

$ N $ 頂点 $ M $ 辺の有向グラフが与えられます。頂点には $ 1 $ から $ N $ の番号、辺には $ 1 $ から $ M $ の番号がついています。辺 $ i\,(1\ \leq\ i\ \leq\ M) $ は頂点 $ s_i $ から頂点 $ t_i $ に向かう長さ $ 1 $ の辺です。

各 $ i\,(1\ \leq\ i\ \leq\ M) $ について、辺 $ i $ のみ通れないときの頂点 $ 1 $ から頂点 $ N $ までの最短距離を求めてください。ただし、頂点 $ 1 $ から頂点 $ N $ にたどり着けない場合は `-1` を出力してください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ M $ $ s_1 $ $ t_1 $ $ s_2 $ $ t_2 $ $ \vdots $ $ s_M $ $ t_M $

## 输出格式

$ M $ 行出力せよ。

$ i $ 行目には、辺 $ i $ のみ通れないときの頂点 $ 1 $ から頂点 $ N $ までの最短距離を出力せよ。ただし、頂点 $ 1 $ から頂点 $ N $ にたどり着けない場合は `-1` を出力せよ。

## 说明/提示

### 制約

- $ 2\ \leq\ N\ \leq\ 400 $
- $ 1\ \leq\ M\ \leq\ N(N-1) $
- $ 1\ \leq\ s_i,t_i\ \leq\ N $
- $ s_i\ \neq\ t_i $
- $ (s_i,t_i)\ \neq\ (s_j,t_j) $ $ (i\ \neq\ j) $
- 入力は全て整数である。

### Sample Explanation 2

辺 $ 1 $ のみ通れないとき、頂点 $ 1 $ から頂点 $ N $ にたどり着けないので `-1` を出力します。

## 样例 #1

### 输入

```
3 3

1 2

1 3

2 3
```

### 输出

```
1

2

1
```

## 样例 #2

### 输入

```
4 4

1 2

2 3

2 4

3 4
```

### 输出

```
-1

2

3

2
```

## 样例 #3

### 输入

```
5 10

1 2

1 4

1 5

2 1

2 3

3 1

3 2

3 5

4 2

4 3
```

### 输出

```
1

1

3

1

1

1

1

1

1

1
```

## 样例 #4

### 输入

```
4 1

1 2
```

### 输出

```
-1
```



---

---
title: "[ABC219E] Moat"
layout: "post"
diff: 普及+/提高
pid: AT_abc219_e
tag: []
---

# [ABC219E] Moat

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc219/tasks/abc219_e

$ xy $ -平面上のいくつかの点に村があります。  
 高橋君はこれらの村を民兵や魔女などの外敵から守るため、これらのすべての村を囲むようなお堀を建設します。

$ 0 $ と $ 1 $ からなる $ 4\ \times\ 4 $ 行列 $ A\ =\ (A_{i,\ j}) $ が与えられます。  
 $ A_{i,\ j}\ =\ 1 $ を満たす整数の組 $ (i,\ j) $ $ (1\ \leq\ i,\ j\ \leq\ 4) $ ごとに、座標 $ (i-0.5,\ j-0.5) $ に村があります。

お堀は平面上の多角形です。 高橋君は以下の条件をすべて満たすお堀を建設します（入力例１・出力例１の説明も参考にして下さい）。

1. 自己交差がない
2. 内部にすべての村を含む
3. すべての頂点の $ x $ 座標と $ y $ 座標は $ 0 $ 以上 $ 4 $ 以下の整数
4. すべての辺は $ x $ 軸と $ y $ 軸のどちらかに平行
5. それぞれの内角の大きさは $ 90 $ 度または $ 270 $ 度

高橋君が建設するお堀として考えられるものが何通りあるかを出力して下さい。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ A_{1,\ 1} $ $ A_{1,\ 2} $ $ A_{1,\ 3} $ $ A_{1,\ 4} $ $ A_{2,\ 1} $ $ A_{2,\ 2} $ $ A_{2,\ 3} $ $ A_{2,\ 4} $ $ A_{3,\ 1} $ $ A_{3,\ 2} $ $ A_{3,\ 3} $ $ A_{3,\ 4} $ $ A_{4,\ 1} $ $ A_{4,\ 2} $ $ A_{4,\ 3} $ $ A_{4,\ 4} $

## 输出格式

高橋君が建設するお堀として考えられるものが何通りあるかを出力せよ。

## 说明/提示

### 制約

- $ A_{i,\ j}\ \in\ \lbrace\ 0,\ 1\rbrace $
- $ A_{i,\ j}\ =\ 1 $ となる $ (i,\ j) $ が少なくとも $ 1 $ つ存在する

### Sample Explanation 1

下記の $ 2 $ つの画像の例は、高橋君が建設する**お堀の条件を満たします**。 

![](https://img.atcoder.jp/ghi/7b3181deb4e1df72e4c0661b1137db4d.png)
![](https://img.atcoder.jp/ghi/a1e46c7db32d63942caa7119a4f3a593.png) 

下記の $ 4 $ つの画像の例は、高橋君が建設する**お堀の条件を満たしません**。 
![](https://img.atcoder.jp/ghi/335053c01a13eb99e55767a3dc02eb38.png)
![](https://img.atcoder.jp/ghi/c4df3d1fa24557b0d4d94ac0eaa8b9ab.png)
![](https://img.atcoder.jp/ghi/be93de595e9222d5e20c90bd28d24563.png)
![](https://img.atcoder.jp/ghi/37dac3af065c013ce0b8c0ee7591b97a.png) 

上記の $ 4 $ つの例が高橋君の建設するお堀の条件を満たさない理由は、以下の通りです。 - $ 1 $ つ目の画像の例は、「自己交差がない」という条件を満たしません。 - $ 2 $ つ目の画像の例は、「内部にすべての村を含む」という条件を満たしません。 - $ 3 $ つ目の画像の例は、「すべての頂点の $ x $ 座標と $ y $ 座標は $ 0 $ 以上 $ 4 $ 以下の整数」という条件を満たしません。（座標が整数でない頂点があります。） - $ 4 $ つ目の画像の例は、「すべての辺は $ x $ 軸と $ y $ 軸のどちらかに平行」という条件を満たしません。

## 样例 #1

### 输入

```
1 0 0 0

0 0 1 0

0 0 0 0

1 0 0 0
```

### 输出

```
1272
```

## 样例 #2

### 输入

```
1 1 1 1

1 1 1 1

1 1 1 1

1 1 1 1
```

### 输出

```
1
```



---

---
title: "[ABC220E] Distance on Large Perfect Binary Tree"
layout: "post"
diff: 普及+/提高
pid: AT_abc220_e
tag: []
---

# [ABC220E] Distance on Large Perfect Binary Tree

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc220/tasks/abc220_e

$ 2^N-1 $ 頂点からなる木があります。  
 頂点には $ 1 $ から $ 2^N-1 $ の番号がつけられており、各 $ 1\leq\ i\ <\ 2^{N-1} $ について、

- 頂点 $ i $ と頂点 $ 2i $ を結ぶ無向辺
- 頂点 $ i $ と頂点 $ 2i+1 $ を結ぶ無向辺

が存在します。これら以外の辺はありません。

$ 2 $ 頂点間の距離を、その $ 2 $ 頂点を結ぶ単純パスに含まれる辺の個数とします。

頂点の組 $ (i,j) $ であって、距離が $ D $ であるようなものの個数を $ 998244353 $ で割った余りを求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ D $

## 输出格式

答えを出力せよ。

## 说明/提示

### 制約

- $ 2\ \leq\ N\ \leq\ 10^6 $
- $ 1\ \leq\ D\ \leq\ 2\times\ 10^6 $
- 入力に含まれる値は全て整数である

### Sample Explanation 1

与えられる木は以下の図のようなものです。 !\[図\](https://img.atcoder.jp/ghi/86d098048a50638decb39ed6659d32cf.png) 距離が $ 2 $ であるような頂点の組は $ (1,4),(1,5),(1,6),(1,7),(2,3),(3,2),(4,1),(4,5),(5,1),(5,4),(6,1),(6,7),(7,1),(7,6) $ の $ 14 $ 組存在します。

## 样例 #1

### 输入

```
3 2
```

### 输出

```
14
```

## 样例 #2

### 输入

```
14142 17320
```

### 输出

```
11284501
```



---

---
title: "[ABC220F] Distance Sums 2"
layout: "post"
diff: 普及+/提高
pid: AT_abc220_f
tag: []
---

# [ABC220F] Distance Sums 2

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc220/tasks/abc220_f

$ N $ 頂点の木が与えられます。頂点には $ 1,2,\ldots\ ,N $ の番号がついており、$ i $ 番目の辺は頂点 $ u_i,v_i $ を結ぶ無向辺です。

各整数 $ i\,(1\ \leq\ i\ \leq\ N) $ に対して、$ \sum_{j=1}^{N}dis(i,j) $ を求めてください。

ただし、$ dis(i,j) $ は頂点 $ i $ から頂点 $ j $ に到達する際にたどる必要のある最小の辺数です。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ u_1 $ $ v_1 $ $ u_2 $ $ v_2 $ $ \vdots $ $ u_{N-1} $ $ v_{N-1} $

## 输出格式

$ N $ 行出力せよ。

$ i $ 行目には $ \sum_{j=1}^{N}dis(i,j) $ を出力せよ。

## 说明/提示

### 制約

- $ 2\ \leq\ N\ \leq\ 2\ \times\ 10^5 $
- $ 1\ \leq\ u_i\ <\ v_i\ \leq\ N $
- 与えられるグラフは木
- 入力は全て整数

### Sample Explanation 1

$ dis(1,1)+dis(1,2)+dis(1,3)=0+1+2=3 $、 $ dis(2,1)+dis(2,2)+dis(2,3)=1+0+1=2 $、 $ dis(3,1)+dis(3,2)+dis(3,3)=2+1+0=3 $、 です。

## 样例 #1

### 输入

```
3

1 2

2 3
```

### 输出

```
3

2

3
```

## 样例 #2

### 输入

```
2

1 2
```

### 输出

```
1

1
```

## 样例 #3

### 输入

```
6

1 6

1 5

1 3

1 4

1 2
```

### 输出

```
5

9

9

9

9

9
```



---

---
title: "[ABC221E] LEQ"
layout: "post"
diff: 普及+/提高
pid: AT_abc221_e
tag: []
---

# [ABC221E] LEQ

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc221/tasks/abc221_e

長さ $ N $ の整数列 $ A\ =\ (A_1,\ A_2,\ \dots,\ A_N) $ が与えられます。

$ A $ の連続するとは限らない、長さが $ 2 $ 以上である部分列 $ A'=(A'_1,A'_2,\ldots,A'_k) $ のうち以下の条件を満たすものの個数を求めてください。

- $ A'_1\ \leq\ A'_k $

なお、この値は非常に大きくなることがあるため、$ 998244353 $ で割ったあまりを出力してください。

ただし、$ 2 $ つの部分列は、列として同じであっても、取り出す添字が異なる場合は区別されます。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ A_1 $ $ A_2 $ $ \ldots $ $ A_N $

## 输出格式

$ A $ の連続するとは限らない、長さが $ 2 $ 以上である部分列のうち問題文中の条件を満たすものの個数を、$ 998244353 $ で割ったあまりを出力せよ。

## 说明/提示

### 制約

- $ 2\ \leq\ N\ \leq\ 3\ \times\ 10^5 $
- $ 1\ \leq\ A_i\ \leq\ 10^9 $
- 入力はすべて整数

### Sample Explanation 1

$ A=(1,2,1) $ の連続するとは限らない、長さが $ 2 $ 以上である部分列は $ (1,2) $, $ (1,1) $, $ (2,1) $, $ (1,2,1) $ の $ 4 $ 通りあります。 そのうち問題文中の条件を満たすものは、$ (1,2) $, $ (1,1) $, $ (1,2,1) $ の $ 3 $ 通りです。

### Sample Explanation 2

列として同じであっても、取り出す添字が異なる場合 $ 2 $ つの部分列は区別されることに注意してください。 この入出力例において、問題文中の条件を満たすような部分列は $ (1,2) $, $ (1,2) $, $ (2,2) $, $ (1,2,2) $ の $ 4 $ 通りです。

### Sample Explanation 3

問題文中の条件を満たすような部分列が存在しない場合もあります。

## 样例 #1

### 输入

```
3

1 2 1
```

### 输出

```
3
```

## 样例 #2

### 输入

```
3

1 2 2
```

### 输出

```
4
```

## 样例 #3

### 输入

```
3

3 2 1
```

### 输出

```
0
```

## 样例 #4

### 输入

```
10

198495780 28463047 859606611 212983738 946249513 789612890 782044670 700201033 367981604 302538501
```

### 输出

```
830
```



---

---
title: "[ABC222E] Red and Blue Tree"
layout: "post"
diff: 普及+/提高
pid: AT_abc222_e
tag: []
---

# [ABC222E] Red and Blue Tree

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc222/tasks/abc222_e

$ N $ 頂点の木と、長さ $ M $ の数列 $ A=(A_1,\ldots,A_M) $、整数 $ K $ が与えられます。  
 木の頂点には $ 1 $ から $ N $ の番号がつけられており、$ i $ 番目の辺は頂点 $ U_i $ と $ V_i $ を結んでいます。

この木の $ N-1 $ 個の辺をそれぞれ赤か青のどちらかに塗ります。そのような方法は $ 2^{N-1} $ 通りありますが、そのうち次の条件を満たすような塗り方の個数を $ 998244353 $ で割った余りを求めてください。

条件：  
 最初、駒を頂点 $ A_1 $ におく。$ i=1,\ldots,M-1 $ の順に、駒を頂点 $ A_i $ から頂点 $ A_{i+1} $ まで、辺をたどって最短経路で動かす。 これらの操作を最後まで行ったとき、赤く塗られた辺を通過した回数を $ R $、青く塗られた辺を通過した回数を $ B $ とすると、$ R-B=K $ である。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ M $ $ K $ $ A_1 $ $ A_2 $ $ \ldots $ $ A_M $ $ U_1 $ $ V_1 $ $ \vdots $ $ U_{N-1} $ $ V_{N-1} $

## 输出格式

答えを出力せよ。

## 说明/提示

### 制約

- $ 2\ \leq\ N\ \leq\ 1000 $
- $ 2\ \leq\ M\ \leq\ 100 $
- $ |K|\ \leq\ 10^5 $
- $ 1\ \leq\ A_i\ \leq\ N $
- $ 1\leq\ U_i,V_i\leq\ N $
- 与えられるグラフは木である
- 入力に含まれる値は全て整数である

### Sample Explanation 1

$ 1,3 $ 番目の辺を赤く、$ 2 $ 番目の辺を青く塗ったとき、 - 頂点 $ 2 $ から頂点 $ 3 $ への移動で赤い辺を $ 0 $ 回、青い辺を $ 1 $ 回 - 頂点 $ 3 $ から頂点 $ 2 $ への移動で赤い辺を $ 0 $ 回、青い辺を $ 1 $ 回 - 頂点 $ 2 $ から頂点 $ 1 $ への移動で赤い辺を $ 1 $ 回、青い辺を $ 0 $ 回 - 頂点 $ 1 $ から頂点 $ 4 $ への移動で赤い辺を $ 2 $ 回、青い辺を $ 1 $ 回 それぞれ通過し、全体では赤い辺を $ 3 $ 回、青い辺を $ 3 $ 回通るため、条件を満たします。 !\[図\](https://img.atcoder.jp/ghi/f9b2b199fb6eedaca02e15ff556b72b1.png) この他、$ 1,3 $ 番目の辺を青く、$ 2 $ 番目の辺を赤く塗るときも条件を満たし、これら以外の塗り方は条件を満たさないため、答えは $ 2 $ 通りです。

### Sample Explanation 2

条件を満たす塗り方が存在しないこともあります。

## 样例 #1

### 输入

```
4 5 0

2 3 2 1 4

1 2

2 3

3 4
```

### 输出

```
2
```

## 样例 #2

### 输入

```
3 10 10000

1 2 1 2 1 2 2 1 1 2

1 2

1 3
```

### 输出

```
0
```

## 样例 #3

### 输入

```
10 2 -1

1 10

1 2

2 3

3 4

4 5

5 6

6 7

7 8

8 9

9 10
```

### 输出

```
126
```

## 样例 #4

### 输入

```
5 8 -1

1 4 1 4 2 1 3 5

1 2

4 1

3 1

1 5
```

### 输出

```
2
```



---

---
title: "[ABC223E] Placing Rectangles"
layout: "post"
diff: 普及+/提高
pid: AT_abc223_e
tag: []
---

# [ABC223E] Placing Rectangles

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc223/tasks/abc223_e

正整数 $ X,\ Y $ に対し、$ 2 $ 次元平面上において以下の条件を満たす長方形を**良い長方形**と呼びます。

- 全ての辺は $ x $ 軸または $ y $ 軸に並行である。
- 全ての頂点に対し、その $ x $ 座標は $ 0 $ 以上 $ X $ 以下の整数であり、その $ y $ 座標は $ 0 $ 以上 $ Y $ 以下の整数である。

面積がそれぞれ $ A $ 以上、$ B $ 以上、$ C $ 以上であるような $ 3 $ つの良い長方形を重ならないように配置することができるか判定してください。

ただし、$ 3 $ つの長方形が重ならないとは、どの $ 2 $ つの長方形についても、それらの共通部分の面積が $ 0 $ であることを指します。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ X $ $ Y $ $ A $ $ B $ $ C $

## 输出格式

問題文で与えられた条件を満たすように長方形を配置することができるならば `Yes`、できないならば `No` と出力せよ。

## 说明/提示

### 制約

- $ 1\ \leq\ X,\ Y\ \leq\ 10^9 $
- $ 1\ \leq\ A,\ B,\ C\ \leq\ 10^{18} $
- 入力は全て整数である。

### Sample Explanation 1

下の図のように配置すればよいです。長方形内の数値は面積を表します。 $ 2\ \geq\ A,\ 3\ \geq\ B,\ 3\ \geq\ C $ であるので、問題文で与えられた条件を満たします。 !\[image\](https://img.atcoder.jp/ghi/abc223e\_sample.png)

### Sample Explanation 2

条件を満たすように配置することはできません。

## 样例 #1

### 输入

```
3 3 2 2 3
```

### 输出

```
Yes
```

## 样例 #2

### 输入

```
3 3 4 4 1
```

### 输出

```
No
```

## 样例 #3

### 输入

```
1000000000 1000000000 1000000000000000000 1000000000000000000 1000000000000000000
```

### 输出

```
No
```



---

---
title: "[ABC223F] Parenthesis Checking"
layout: "post"
diff: 普及+/提高
pid: AT_abc223_f
tag: []
---

# [ABC223F] Parenthesis Checking

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc223/tasks/abc223_f

以下のいずれかの条件を満たす文字列を**正しい括弧列**と定義します。

- 空文字列
- ある**正しい括弧列** $ A $ が存在して、`(`, $ A $, `)` をこの順に連結した文字列
- ある空でない**正しい括弧列** $ A $, $ B $ が存在して、$ A $, $ B $ をこの順に連結した文字列

`(` と `)` のみからなる長さ $ N $ の文字列 $ S $ があります。

$ Q $ 個のクエリ $ \text{Query}_1,\text{Query}_2,\ldots,\text{Query}_Q $ が与えられるので、順番に処理してください。クエリには $ 2 $ 種類があり、入力形式とクエリの内容は以下の通りです。

- `1 l r` : $ S $ の $ l $ 文字目と $ r $ 文字目を入れ替える。
- `2 l r` : $ S $ の $ l $ 文字目から $ r $ 文字目までの連続部分文字列が**正しい括弧列**であるか判定する。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ Q $ $ S $ $ \text{Query}_1 $ $ \text{Query}_2 $ $ \vdots $ $ \text{Query}_Q $

## 输出格式

`2 l r` の形式の各クエリに対して、連続部分文字列が**正しい括弧列**である場合 `Yes`、そうでない場合 `No` と出力し、改行せよ。

## 说明/提示

### 制約

- $ 1\ \leq\ N,Q\ \leq\ 2\ \times\ 10^5 $
- $ S $ は `(` と `)` のみからなる長さ $ N $ の文字列
- $ 1\ \leq\ l\ <\ r\ \leq\ N $
- $ N,Q,l,r $ はいずれも整数
- 各クエリは `1 l r`、`2 l r` のいずれかの形式で与えられる。
- `2 l r` の形式のクエリは $ 1 $ つ以上与えられる。

### Sample Explanation 1

$ 1 $ つ目のクエリにおいて、`(())` は\*\*正しい括弧列\*\*です。 $ 2 $ つ目のクエリにおいて、`((` は\*\*正しい括弧列\*\*ではありません。 $ 3 $ つ目のクエリにおいて、`)(` は\*\*正しい括弧列\*\*ではありません。

### Sample Explanation 2

$ 1 $ つ目のクエリにおいて、`(())` は\*\*正しい括弧列\*\*です。 $ 2 $ つ目のクエリによって、$ S $ は `)()((` となります。 $ 3 $ つ目のクエリにおいて、`)()(` は\*\*正しい括弧列\*\*ではありません。

## 样例 #1

### 输入

```
5 3

(())(

2 1 4

2 1 2

2 4 5
```

### 输出

```
Yes

No

No
```

## 样例 #2

### 输入

```
5 3

(())(

2 1 4

1 1 4

2 1 4
```

### 输出

```
Yes

No
```

## 样例 #3

### 输入

```
8 8

(()(()))

2 2 7

2 2 8

1 2 5

2 3 4

1 3 4

1 3 5

1 1 4

1 6 8
```

### 输出

```
Yes

No

No
```



---

---
title: "[ABC224D] 8 Puzzle on Graph"
layout: "post"
diff: 普及+/提高
pid: AT_abc224_d
tag: []
---

# [ABC224D] 8 Puzzle on Graph

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc224/tasks/abc224_d

高橋君は道端であるパズルを拾いました。  
 このパズルは、$ 9 $ 個の頂点と $ M $ 本の辺からなる無向グラフ、および、$ 8 $ つのコマで構成されます。

グラフの $ 9 $ つの頂点はそれぞれ頂点 $ 1 $、頂点 $ 2 $、$ \ldots $、頂点 $ 9 $ と呼ばれ、 $ i\ =\ 1,\ 2,\ \ldots,\ M $ について、$ i $ 番目の辺は頂点 $ u_i $ と頂点 $ v_i $ を結んでいます。  
 $ 8 $ つのコマはそれぞれコマ $ 1 $、コマ $ 2 $、$ \ldots $、コマ $ 8 $ と呼ばれ、 $ j\ =\ 1,\ 2,\ \ldots,\ 8 $ について、コマ $ j $ は頂点 $ p_j $ に置かれています。 ここで、すべてのコマはそれぞれ異なる頂点に置かれていることが保証されます。 コマが置かれていない「空の頂点」がただ一つ存在することに注意してください。

高橋君はこのパズルに対して下記の操作を好きな回数（ $ 0 $ 回でもよい）だけ行うことができます。

> 空の頂点に隣接する頂点に置かれたコマを $ 1 $ つ選び、選んだコマを空の頂点に移動する。

高橋君は上記の操作を繰り返して、このパズルを「完成」させようとしています。 パズルは、下記の状態を満たしたときに完成となります。

> $ j\ =\ 1,\ 2,\ \ldots,\ 8 $ について、コマ $ j $ は 頂点 $ j $ に置かれている。

高橋君がパズルを完成させることが可能かどうかを判定し、可能な場合はそのために必要な操作回数の最小値を出力してください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ M $ $ u_1 $ $ v_1 $ $ u_2 $ $ v_2 $ $ \vdots $ $ u_M $ $ v_M $ $ p_1 $ $ p_2 $ $ \ldots $ $ p_8 $

## 输出格式

高橋君がパズルを完成させることが可能な場合は、そのために必要な操作回数の最小値を出力せよ。 高橋君がパズルを完成させることが不可能な場合は、$ -1 $ を出力せよ。

## 说明/提示

### 制約

- $ 0\ \leq\ M\ \leq\ 36 $
- $ 1\ \leq\ u_i,\ v_i\ \leq\ 9 $
- 与えられるグラフは多重辺、自己ループを持たない
- $ 1\ \leq\ p_j\ \leq\ 9 $
- $ j\ \neq\ j'\ \Rightarrow\ p_j\ \neq\ p_{j'} $
- 入力はすべて整数

### Sample Explanation 1

下記の手順によって、$ 5 $ 回の操作でパズルを完成させることができます。 1. コマ $ 2 $ を頂点 $ 9 $ から頂点 $ 1 $ に移動する。 2. コマ $ 3 $ を頂点 $ 2 $ から頂点 $ 9 $ に移動する。 3. コマ $ 2 $ を頂点 $ 1 $ から頂点 $ 2 $ に移動する。 4. コマ $ 1 $ を頂点 $ 3 $ から頂点 $ 1 $ に移動する。 5. コマ $ 3 $ を頂点 $ 9 $ から頂点 $ 3 $ に移動する。 一方、$ 5 $ 回未満の操作でパズルを完成させることはできません。よって、$ 5 $ を出力します。 与えられるグラフは連結とは限らないことに注意してください。

### Sample Explanation 2

パズルは初めから完成しています。よって、完成させるために必要な操作回数の最小値は $ 0 $ 回です。

### Sample Explanation 3

操作の繰り返しによってパズルを完成させることができないので、$ -1 $ を出力します。

## 样例 #1

### 输入

```
5

1 2

1 3

1 9

2 9

3 9

3 9 2 4 5 6 7 8
```

### 输出

```
5
```

## 样例 #2

### 输入

```
5

1 2

1 3

1 9

2 9

3 9

1 2 3 4 5 6 7 8
```

### 输出

```
0
```

## 样例 #3

### 输入

```
12

8 5

9 6

4 5

4 1

2 5

8 9

2 1

3 6

8 7

6 5

7 4

2 3

1 2 3 4 5 6 8 7
```

### 输出

```
-1
```

## 样例 #4

### 输入

```
12

6 5

5 4

4 1

4 7

8 5

2 1

2 5

6 9

3 6

9 8

8 7

3 2

2 3 4 6 1 9 7 8
```

### 输出

```
16
```



---

---
title: "[ABC224E] Integers on Grid"
layout: "post"
diff: 普及+/提高
pid: AT_abc224_e
tag: []
---

# [ABC224E] Integers on Grid

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc224/tasks/abc224_e

縦 $ H $ 行、横 $ W $ 列のマス目があります。上から $ i $ 行目、左から $ j $ 列目のマスをマス $ (i,\ j) $ と呼びます。

それぞれのマスには整数が書かれています。 $ i\ =\ 1,\ 2,\ \ldots,\ N $ について、マス $ (r_i,\ c_i) $ には正整数 $ a_i $ が書かれており、それら以外のマスには $ 0 $ が書かれています。

はじめ、マス $ (R,\ C) $ にコマが置かれています。 高橋君は、コマを「いま置かれているマスから別のマスに移動させる」ことを好きな回数だけ行うことができます。 ただし、コマを移動する際には下記の $ 2 $ つの条件をともに満たさなければなりません。

- 移動先のマスに書かれている整数は、移動前のマスに書かれている整数より真に大きい。
- 移動先のマスは移動前のマスと同じ行にある、または、移動先のマスは移動前のマスと同じ列にある。

$ i\ =\ 1,\ 2,\ \ldots,\ N $ のそれぞれについて、$ (R,\ C)\ =\ (r_i,\ c_i) $ の場合に高橋君がコマの移動を行うことができる回数の最大値を出力してください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ H $ $ W $ $ N $ $ r_1 $ $ c_1 $ $ a_1 $ $ r_2 $ $ c_2 $ $ a_2 $ $ \vdots $ $ r_N $ $ c_N $ $ a_N $

## 输出格式

$ N $ 行出力せよ。 $ i\ =\ 1,\ 2,\ \ldots,\ N $ について、$ i $ 行目には $ (R,\ C)\ =\ (r_i,\ c_i) $ の場合に高橋君がコマの移動を行うことができる回数の最大値を出力せよ。

## 说明/提示

### 制約

- $ 2\ \leq\ H,\ W\ \leq\ 2\ \times\ 10^5 $
- $ 1\ \leq\ N\ \leq\ \min(2\ \times\ 10^5,\ HW) $
- $ 1\ \leq\ r_i\ \leq\ H $
- $ 1\ \leq\ c_i\ \leq\ W $
- $ 1\ \leq\ a_i\ \leq\ 10^9 $
- $ i\ \neq\ j\ \Rightarrow\ (r_i,\ c_i)\ \neq\ (r_j,\ c_j) $
- 入力はすべて整数

### Sample Explanation 1

マス目に書かれた整数は下記の通りです。 ``` 4 7 0 3 0 5 2 5 5 ``` - $ (R,\ C)\ =\ (r_1,\ c_1)\ =\ (1,\ 1) $ の場合、$ (1,\ 1)\ \rightarrow\ (1,\ 2) $ と移動すると、コマの移動を $ 1 $ 回行うことができます。 - $ (R,\ C)\ =\ (r_2,\ c_2)\ =\ (1,\ 2) $ の場合、一度もコマの移動を行うことができません。 - $ (R,\ C)\ =\ (r_3,\ c_3)\ =\ (2,\ 1) $ の場合、$ (2,\ 1)\ \rightarrow\ (1,\ 1)\ \rightarrow\ (1,\ 2) $ と移動すると、コマの移動を $ 2 $ 回行うことができます。 - $ (R,\ C)\ =\ (r_4,\ c_4)\ =\ (2,\ 3) $ の場合、一度もコマの移動を行うことができません。 - $ (R,\ C)\ =\ (r_5,\ c_5)\ =\ (3,\ 1) $ の場合、$ (3,\ 1)\ \rightarrow\ (2,\ 1)\ \rightarrow\ (1,\ 1)\ \rightarrow\ (1,\ 2) $ と移動すると、コマの移動を $ 3 $ 回行うことができます。 - $ (R,\ C)\ =\ (r_6,\ c_6)\ =\ (3,\ 2) $ の場合、$ (3,\ 2)\ \rightarrow\ (1,\ 2) $ と移動すると、コマの移動を $ 1 $ 回行うことができます。 - $ (R,\ C)\ =\ (r_7,\ c_7)\ =\ (3,\ 3) $ の場合、一度もコマの移動を行うことができません。

## 样例 #1

### 输入

```
3 3 7

1 1 4

1 2 7

2 1 3

2 3 5

3 1 2

3 2 5

3 3 5
```

### 输出

```
1

0

2

0

3

1

0
```

## 样例 #2

### 输入

```
5 7 20

2 7 8

2 6 4

4 1 9

1 5 4

2 2 7

5 5 2

1 7 2

4 6 6

1 4 1

2 1 10

5 6 9

5 3 3

3 7 9

3 6 3

4 3 4

3 3 10

4 2 1

3 5 4

1 2 6

4 7 9
```

### 输出

```
2

4

1

5

3

6

6

2

7

0

0

4

1

5

3

0

5

2

4

0
```



---

---
title: "[ABC224F] Problem where +s Separate Digits"
layout: "post"
diff: 普及+/提高
pid: AT_abc224_f
tag: []
---

# [ABC224F] Problem where +s Separate Digits

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc224/tasks/abc224_f

$ 1 $ から $ 9 $ までの数字のみで構成された文字列 $ S $ が与えられます。  
 この文字列 $ S $ から、以下の操作によって式 $ T $ を作ります。

- はじめ、 $ T=S $ であるとする。
- 各要素が $ 1 $ 以上 $ |S|-1 $ 以下の整数である、値に重複のない集合 $ A $ を選ぶ。なお、 $ A $ が空集合であってもよい。
- $ A $ の全ての要素 $ x $ について、 $ x $ の降順に以下の操作を行う。
  - $ T $ の $ x $ 文字目と $ x+1 $ 文字目の間に、 `+` を挿入する。

例えば、 $ S= $ `1234`、 $ A=\ \lbrace\ 2,3\ \rbrace $ であるとき、 $ T $= `12+3+4` となります。

この操作によって得られる $ T $ としてあり得る全ての式に対して、式を計算したときの値の総和を $ 998244353 $ で割った余りを求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ S $

## 输出格式

答えを整数として出力せよ。

## 说明/提示

### 制約

- $ 1\ \le\ |S|\ \le\ 2\ \times\ 10^5 $
- $ S $ は `1`, `2`, `3`, `4`, `5`, `6`, `7`, `8`, `9` のみからなる。

### Sample Explanation 1

式 $ T $ としてあり得るものは `1234`, `123+4`, `12+34`, `12+3+4`, `1+234`, `1+23+4`, `1+2+34`, `1+2+3+4` の $ 8 $ つです。 これらを計算した値の総和は $ 1736 $ です。

### Sample Explanation 2

$ S $ の長さが $ 1 $ であることもあります。この場合、 $ A $ として指定可能なのは空集合のみです。

### Sample Explanation 3

答えを $ 998244353 $ で割った余りを求めてください。

## 样例 #1

### 输入

```
1234
```

### 输出

```
1736
```

## 样例 #2

### 输入

```
1
```

### 输出

```
1
```

## 样例 #3

### 输入

```
31415926535897932384626433832795
```

### 输出

```
85607943
```



---

---
title: "[ABC225E] フ"
layout: "post"
diff: 普及+/提高
pid: AT_abc225_e
tag: []
---

# [ABC225E] フ

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc225/tasks/abc225_e

二次元平面上の第一象限上に $ N $ 個のフの字があります。

$ i\ (1\ \leq\ i\ \leq\ N) $ 個目のフの字は、$ (x_i-1,y_i) $ と $ (x_i,y_i) $ を結ぶ線分と $ (x_i,y_i-1) $ と $ (x_i,y_i) $ を結ぶ線分の $ 2 $ つを組み合わせた図形です。

あなたは、$ N $ 個のフの字から $ 0 $ 個以上を選び、削除することができます。

適切に削除するフの字を選んだとき、原点から全体が見えるフの字の個数は最大でいくつになりますか？

ここで、原点からあるフの字（便宜上 $ i $ 個目のフの字とする）の全体が見える必要十分条件は、以下の通りです。

- 原点、$ (x_i-1,y_i) $、$ (x_i,y_i) $、$ (x_i,y_i-1) $ の $ 4 $ 点を頂点とする四角形の内部（境界を除く）と他のフの字が共通部分を持たない。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ x_1 $ $ y_1 $ $ x_2 $ $ y_2 $ $ \hspace{0.45cm}\vdots $ $ x_N $ $ y_N $

## 输出格式

原点から全体が見えるフの字の個数の最大値を出力せよ。

## 说明/提示

### 制約

- $ 1\ \leq\ N\ \leq\ 2\ \times\ 10^5 $
- $ 1\ \leq\ x_i,y_i\ \leq\ 10^9 $
- $ (x_i,y_i)\ \neq\ (x_j,y_j)\ (i\ \neq\ j) $
- 入力はすべて整数

### Sample Explanation 1

$ 1 $ 個目のフの字を削除したとき原点からは $ 2 $ 個目のフの字と $ 3 $ 個目のフの字の $ 2 $ つが見えるようになり、これが最大です。 $ 1 $ つのフの字も削除しない場合、原点からは $ 1 $ 個目のフの字のみしか見えません。

### Sample Explanation 2

すべてのフの字を削除せずに残すのが最善です。

## 样例 #1

### 输入

```
3

1 1

2 1

1 2
```

### 输出

```
2
```

## 样例 #2

### 输入

```
10

414598724 87552841

252911401 309688555

623249116 421714323

605059493 227199170

410455266 373748111

861647548 916369023

527772558 682124751

356101507 249887028

292258775 110762985

850583108 796044319
```

### 输出

```
10
```



---

---
title: "[ABC226E] Just one"
layout: "post"
diff: 普及+/提高
pid: AT_abc226_e
tag: []
---

# [ABC226E] Just one

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc226/tasks/abc226_e

$ N $ 頂点 $ M $ 辺の無向グラフが与えられます。 頂点は頂点 $ 1 $ ,頂点 $ 2 $ , $ \ldots $ ,頂点 $ N $、辺は辺 $ 1 $ ,辺 $ 2 $ , $ \ldots $ ,辺 $ M $ と番号付けられており、特に辺 $ i $ $ (1\ \leq\ i\ \leq\ M) $ は頂点 $ U_i $ と頂点 $ V_i $ を結んでいます。 また、このグラフは単純であることが保証されます。すなわち、自己ループや多重辺は存在しません。

このグラフの $ M $ 本の辺すべてに向き付けをする方法は $ 2^M $ 通り考えられますが、 そのうち、どの頂点についても、その頂点から他の頂点に向かう辺がちょうど $ 1 $ 本ずつ存在するような向き付けの方法は何通りありますか。 答えは非常に大きくなる可能性があるので、$ 998244353 $ で割った余りを出力してください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ M $ $ U_1 $ $ V_1 $ $ U_2 $ $ V_2 $ $ \vdots $ $ U_M $ $ V_M $

## 输出格式

答えを出力せよ。

## 说明/提示

### 制約

- $ 2\ \leq\ N\ \leq\ 2\times\ 10^5 $
- $ 1\ \leq\ M\ \leq\ 2\times\ 10^5 $
- $ 1\ \leq\ U_i,V_i\ \leq\ N $
- $ U_i\ \neq\ V_i $
- 入力は全て整数である。
- 与えられるグラフは単純である。

### Sample Explanation 1

条件をみたす辺の向き付けの方法は、 - $ 1\rightarrow\ 2 $ , $ 2\rightarrow\ 3 $ , $ 1\leftarrow\ 3 $ - $ 1\leftarrow\ 2 $ , $ 2\leftarrow\ 3 $ , $ 1\rightarrow\ 3 $ の $ 2 $ 通りです。

### Sample Explanation 2

すべての頂点から $ 1 $ 本ずつ辺が出ているようにすることは明らかに不可能です。

## 样例 #1

### 输入

```
3 3

1 2

1 3

2 3
```

### 输出

```
2
```

## 样例 #2

### 输入

```
2 1

1 2
```

### 输出

```
0
```

## 样例 #3

### 输入

```
7 7

1 2

2 3

3 4

4 2

5 6

6 7

7 5
```

### 输出

```
4
```



---

---
title: "[ABC227D] Project Planning"
layout: "post"
diff: 普及+/提高
pid: AT_abc227_d
tag: []
---

# [ABC227D] Project Planning

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc227/tasks/abc227_d

キーエンスには $ N $ 個の部署があり、$ i\,(1\ \leq\ i\ \leq\ N) $ 番目の部署には $ A_i $ 人の社員が所属しています。異なる部署に同じ社員が所属していることはありません。

キーエンスは、部署をまたいだ全社横断プロジェクトを計画しています。$ 1 $ つのプロジェクトは $ K $ 個の相異なる部署から $ 1 $ 人ずつ選出して作り、ちょうど $ K $ 人から構成されるようにします。

プロジェクトは最大でいくつ作れますか？ただし、$ 1 $ 人が複数のプロジェクトに参加することはできません。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ K $ $ A_1 $ $ A_2 $ $ \ldots $ $ A_N $

## 输出格式

プロジェクトの個数の最大値を出力せよ。

## 说明/提示

### 制約

- $ 1\ \leq\ K\ \leq\ N\ \leq\ 2\ \times\ 10^5 $
- $ 1\ \leq\ A_i\ \leq\ 10^{12} $
- 入力は全て整数

### Sample Explanation 1

$ 3 $ 個の部署それぞれから $ 1 $ 人ずつ選出したプロジェクトを $ 2 $ つ作ることができます。

## 样例 #1

### 输入

```
3 3

2 3 4
```

### 输出

```
2
```

## 样例 #2

### 输入

```
4 2

1 1 3 4
```

### 输出

```
4
```

## 样例 #3

### 输入

```
4 3

1 1 3 4
```

### 输出

```
2
```



---

---
title: "[ABC228E] Integer Sequence Fair"
layout: "post"
diff: 普及+/提高
pid: AT_abc228_e
tag: []
---

# [ABC228E] Integer Sequence Fair

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc228/tasks/abc228_e

整数列を一堂に集めてその優劣を定める、整数列品評会が行われます。 品評会では、$ 1 $ 以上 $ K $ 以下の整数からなる長さ $ N $ の整数列すべてが審査対象となり、 審査対象の数列それぞれに対して $ 1 $ 以上 $ M $ 以下の整数の点数をつけます。

「審査対象の数列それぞれに対して $ 1 $ 以上 $ M $ 以下の整数の点数をつける方法」が何通りあるかを $ 998244353 $ で割ったあまりを出力してください。

ただし、$ 2 $ つの方法が異なるとは「審査対象となるある数列 $ A\ =\ (A_1,\ A_2,\ \ldots,\ A_N) $ が存在して、 $ A $ に対してつける点数が $ 2 $ つの方法で異なる」ことを言います。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ K $ $ M $

## 输出格式

「審査対象の数列それぞれに対して $ 1 $ 以上 $ M $ 以下の整数の点数をつける方法」が何通りあるかを $ 998244353 $ で割ったあまりを出力せよ。

## 说明/提示

### 制約

- $ 1\ \leq\ N,\ K,\ M\ \leq\ 10^{18} $
- $ N,\ K,\ M $ は整数

### Sample Explanation 1

審査対象となる数列は、$ (1,\ 1),\ (1,\ 2),\ (2,\ 1),\ (2,\ 2) $ の $ 4 $ つです。「審査対象の数列それぞれに対して $ 1 $ 以上 $ 2 $ 以下の整数の点数をつける方法」は、以下の $ 16 $ 通りあります。 - $ (1,\ 1) $ に $ 1 $ 点、$ (1,\ 2) $ に $ 1 $ 点、$ (2,\ 1) $ に $ 1 $ 点、$ (2,\ 2) $ に $ 1 $ 点をつける方法 - $ (1,\ 1) $ に $ 1 $ 点、$ (1,\ 2) $ に $ 1 $ 点、$ (2,\ 1) $ に $ 1 $ 点、$ (2,\ 2) $ に $ 2 $ 点をつける方法 - $ (1,\ 1) $ に $ 1 $ 点、$ (1,\ 2) $ に $ 1 $ 点、$ (2,\ 1) $ に $ 2 $ 点、$ (2,\ 2) $ に $ 1 $ 点をつける方法 - $ (1,\ 1) $ に $ 1 $ 点、$ (1,\ 2) $ に $ 1 $ 点、$ (2,\ 1) $ に $ 2 $ 点、$ (2,\ 2) $ に $ 2 $ 点をつける方法 - $ \cdots $ - $ (1,\ 1) $ に $ 2 $ 点、$ (1,\ 2) $ に $ 2 $ 点、$ (2,\ 1) $ に $ 2 $ 点、$ (2,\ 2) $ に $ 2 $ 点をつける方法 よって、$ 16 $ を出力します。

### Sample Explanation 2

$ 998244353 $ で割ったあまりを出力することに注意してください。

## 样例 #1

### 输入

```
2 2 2
```

### 输出

```
16
```

## 样例 #2

### 输入

```
3 14 15926535
```

### 输出

```
109718301
```



---

---
title: "[ABC231E] Minimal payments"
layout: "post"
diff: 普及+/提高
pid: AT_abc231_e
tag: []
---

# [ABC231E] Minimal payments

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc231/tasks/abc231_e

Atcoder 王国では $ A_1 $ 円, $ A_2 $ 円, $ \ldots $, $ A_N $ 円の $ N $ 種類の硬貨が使用されています。  
 ここで、$ 1=A_1\ <\ \ldots\ <\ A_N $ であり、全ての $ 1\leq\ i\ \leq\ N-1 $ に対し、$ A_{i+1} $ は $ A_i $ の倍数です。

硬貨のみを使って $ X $ 円を支払うとき、支払いに使う硬貨の枚数とお釣りでもらう硬貨の枚数の合計の最小値はいくつですか？

正確には、$ Y $ が $ X $ 以上の整数を自由に動く時、$ Y $ 円ちょうどを表すために必要な硬貨の枚数と、$ Y-X $ 円ちょうどを表すために必要な硬貨の枚数の和の最小値を求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ X $ $ A_1 $ $ \ldots $ $ A_N $

## 输出格式

答えを出力せよ。

## 说明/提示

### 制約

- 入力に含まれる値は全て整数である
- $ 1\ \leq\ N\ \leq\ 60 $
- $ 1=A_1\ <\ \ldots\ <\ A_N\ \leq\ 10^{18} $
- 全ての $ 1\leq\ i\ \leq\ N-1 $ で $ A_{i+1} $ は $ A_i $ の倍数である
- $ 1\leq\ X\ \leq\ 10^{18} $

### Sample Explanation 1

$ 100 $ 円硬貨 $ 1 $ 枚で支払いを行い、$ 10 $ 円硬貨 $ 1 $ 枚と $ 1 $ 円硬貨 $ 3 $ 枚をお釣りでもらうと、合計枚数は $ 5 $ 枚になります。

### Sample Explanation 2

$ 7 $ 円硬貨 $ 7 $ 枚で支払いを行うのが最適です。

## 样例 #1

### 输入

```
3 87

1 10 100
```

### 输出

```
5
```

## 样例 #2

### 输入

```
2 49

1 7
```

### 输出

```
7
```

## 样例 #3

### 输入

```
10 123456789012345678

1 100 10000 1000000 100000000 10000000000 1000000000000 100000000000000 10000000000000000 1000000000000000000
```

### 输出

```
233
```



---

---
title: "[ABC231F] Jealous Two"
layout: "post"
diff: 普及+/提高
pid: AT_abc231_f
tag: []
---

# [ABC231F] Jealous Two

## 题目描述

&emsp;滑头君要给他的两个好基友 A、B 每人送一个礼物。\
&emsp;滑头君有 **$ N $ 种**礼物，对于每种礼物，两个好基友都有不同的喜爱值。\
&emsp;两个好基友非常嫉妒。对于任意一个人来说，如果对方收到的礼物对自己的喜爱值比自己的礼物对自己的喜爱值更高，换句话说就是如果有人更喜欢对方的礼物的话，两个人就会打架。\
&emsp;滑头君不想失去他的朋友，于是请你求出共有几种可能的送礼方案。  
**请注意，可以给两个人送同样的礼物。**

## 输入格式

>第一行一个整数 $ N $  
第二行 $ N $ 个整数$ A_1 $ $ \ldots $ $ A_N $ 表示 A 对第 $i$个礼物的喜欢值。  
第三行 $ N $ 个整数$ B_1 $ $ \ldots $ $ B_N $ 表示 B 对第 $i$个礼物的喜欢值。

## 输出格式

输出可能的方案数。

## 样例 #1

### 输入

```
3

50 100 150

1 3 2
```

### 输出

```
4
```

## 样例 #2

### 输入

```
3

123456789 123456 123

987 987654 987654321
```

### 输出

```
6
```

## 样例 #3

### 输入

```
10

3 1 4 1 5 9 2 6 5 3

2 7 1 8 2 8 1 8 2 8
```

### 输出

```
37
```



---

---
title: "[ABC232E] Rook Path"
layout: "post"
diff: 普及+/提高
pid: AT_abc232_e
tag: []
---

# [ABC232E] Rook Path

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc232/tasks/abc232_e

縦 $ H $ 行、横 $ W $ 行の $ H\ \times\ W $ マスからなるグリッドがあります。上から $ i $ 行目、左から $ j $ 列目のマスを $ (i,\ j) $ と表します。

はじめ、マス $ (x_1,\ y_1) $ にルークが置かれており、高橋君は以下の操作を $ K $ 回行います。

- 現在ルークが置かれているマスと行または列が同じマスにルークを移動させる。ただし、現在ルークが置かれているマスとは異なるマスに移動させる必要がある。

$ K $ 回の操作の後、ルークがマス $ (x_2,\ y_2) $ に置かれているようにする方法は何通りありますか？答えは非常に大きくなることがあるので、$ 998244353 $ で割った余りを求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ H $ $ W $ $ K $ $ x_1 $ $ y_1 $ $ x_2 $ $ y_2 $

## 输出格式

$ K $ 回の操作の後、ルークがマス $ (x_2,\ y_2) $ に置かれているようにする方法の総数を $ 998244353 $ で割った余りを出力せよ。

## 说明/提示

### 制約

- $ 2\ \leq\ H,\ W\ \leq\ 10^9 $
- $ 1\ \leq\ K\ \leq\ 10^6 $
- $ 1\ \leq\ x_1,\ x_2\ \leq\ H $
- $ 1\ \leq\ y_1,\ y_2\ \leq\ W $

### Sample Explanation 1

以下の $ 2 $ 通りです。 - $ 1 $ 回目の操作でルークをマス $ (1,\ 2) $ からマス $ (1,\ 1) $ へ動かし、$ 2 $ 回目の操作でルークをマス $ (1,\ 1) $ からマス $ (2,\ 1) $ に動かす。 - $ 1 $ 回目の操作でルークをマス $ (1,\ 2) $ からマス $ (2,\ 2) $ へ動かし、$ 2 $ 回目の操作でルークをマス $ (2,\ 2) $ からマス $ (2,\ 1) $ に動かす。

### Sample Explanation 2

$ 998244353 $ で割った余りを求めなければならないことに注意して下さい。

## 样例 #1

### 输入

```
2 2 2

1 2 2 1
```

### 输出

```
2
```

## 样例 #2

### 输入

```
1000000000 1000000000 1000000

1000000000 1000000000 1000000000 1000000000
```

### 输出

```
24922282
```

## 样例 #3

### 输入

```
3 3 3

1 3 3 3
```

### 输出

```
9
```



---

---
title: "[ABC232F] Simple Operations on Sequence"
layout: "post"
diff: 普及+/提高
pid: AT_abc232_f
tag: []
---

# [ABC232F] Simple Operations on Sequence

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc232/tasks/abc232_f

長さ $ N $ の $ 2 $ つの整数列 $ A\ =\ (A_1,\ A_2,\ \ldots,\ A_N) $ および $ B\ =\ (B_1,\ B_2\ \ldots,\ B_N) $ が与えられます。

整数列 $ A $ に対して、「下記の $ 2 $ つの操作のうちどちらかを行う」ということを好きな回数（ $ 0 $ 回でもよい）繰り返すことができます。

- $ 1\ \leq\ i\ \leq\ N $ を満たす整数 $ i $ を選び、$ A_i $ の値を $ 1 $ 増やすか $ 1 $ 減らす。この操作には $ X $ 円の費用がかかる。
- $ 1\ \leq\ i\ \leq\ N-1 $ を満たす整数 $ i $ を選び、$ A_i $ の値と $ A_{i+1} $ の値を入れ替える。この操作には $ Y $ 円の費用がかかる。

上記の繰り返しによって整数列 $ A $ を整数列 $ B $ に一致させるためにかかる合計費用としてあり得る最小値を出力してください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ X $ $ Y $ $ A_1 $ $ A_2 $ $ \ldots $ $ A_N $ $ B_1 $ $ B_2 $ $ \ldots $ $ B_N $

## 输出格式

$ A $ を $ B $ に一致させるためにかかる合計費用としてあり得る最小値を求めよ。

## 说明/提示

### 制約

- $ 2\ \leq\ N\ \leq\ 18 $
- $ 1\ \leq\ X\ \leq\ 10^8 $
- $ 1\ \leq\ Y\ \leq\ 10^{16} $
- $ 1\ \leq\ A_i,\ B_i\ \leq\ 10^8 $
- 入力はすべて整数

### Sample Explanation 1

はじめ、$ A\ =\ (4,\ 2,\ 5,\ 2) $ です。 下記の通りに操作を行うと、$ A $ を $ B $ に一致させることができます。 - $ X\ =\ 3 $ 円払い、$ A_3 $ の値を $ 1 $ 増やす。その結果 $ A\ =\ (4,\ 2,\ 6,\ 2) $ となる。 - $ Y\ =\ 5 $ 円払い、$ A_2 $ の値と $ A_3 $ の値を入れ替える。その結果 $ A\ =\ (4,\ 6,\ 2,\ 2) $ となる。 - $ Y\ =\ 5 $ 円払い、$ A_1 $ の値と $ A_2 $ の値を入れ替える。その結果 $ A\ =\ (6,\ 4,\ 2,\ 2) $ となる。 - $ X\ =\ 3 $ 円払い、$ A_4 $ の値を $ 1 $ 減らす。その結果 $ A\ =\ (6,\ 4,\ 2,\ 1)\ =\ B $ となる。 上記の操作にかかる費用の合計は $ 3+5+5+3\ =\ 16 $ 円であり、これが最小となります。

### Sample Explanation 2

$ A $ と $ B $ は初めから一致しているため、一度も操作を行う必要がありません。

### Sample Explanation 3

入力や出力が $ 32 $ bit 整数型に収まらないことがあることに注意してください。

## 样例 #1

### 输入

```
4 3 5

4 2 5 2

6 4 2 1
```

### 输出

```
16
```

## 样例 #2

### 输入

```
5 12345 6789

1 2 3 4 5

1 2 3 4 5
```

### 输出

```
0
```

## 样例 #3

### 输入

```
18 20719114 5117250357733867

10511029 36397527 63027379 44706927 47672230 79861204 57882493 42931589 51053644 52300688 43971370 26515475 62139996 41282303 34022578 12523039 6696497 64922712

14720753 4621362 25269832 91410838 86751784 32741849 6602693 60719353 28911226 88280613 18745325 80675202 34289776 37849132 99280042 73760634 43897718 40659077
```

### 输出

```
13104119429316474
```



---

---
title: "[ABC234F] Reordering"
layout: "post"
diff: 普及+/提高
pid: AT_abc234_f
tag: []
---

# [ABC234F] Reordering

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc234/tasks/abc234_f

文字列 $ S $ が与えられます。$ S $ の空でない、**連続するとは限らない**部分列を並び替えて得られる文字列は何種類ありますか？

答えは非常に大きくなる場合があるので、$ 998244353 $ で割ったあまりを出力してください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ S $

## 输出格式

$ S $ の部分列を並び替えて得られる文字列の種類数を $ 998244353 $ で割ったあまりを出力せよ。

## 说明/提示

### 制約

- $ S $ は英小文字のみからなる長さ $ 1 $ 以上 $ 5000 $ 以下の文字列

### Sample Explanation 1

$ S $ の部分列を並び替えて得られる文字列は、`a`, `b`, `aa`, `ab`, `ba`, `aab`, `aba`, `baa` の $ 8 $ 種類です。

### Sample Explanation 3

$ 998244353 $ で割ったあまりを出力することに注意してください。

## 样例 #1

### 输入

```
aab
```

### 输出

```
8
```

## 样例 #2

### 输入

```
aaa
```

### 输出

```
3
```

## 样例 #3

### 输入

```
abcdefghijklmnopqrstuvwxyz
```

### 输出

```
149621752
```



---

---
title: "[ABC235E] MST + 1"
layout: "post"
diff: 普及+/提高
pid: AT_abc235_e
tag: []
---

# [ABC235E] MST + 1

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc235/tasks/abc235_e

$ N $ 頂点 $ M $ 辺の重み付き無向連結グラフ $ G $ が与えられます。$ G $ には自己ループや多重辺が含まれている可能性があります。  
 頂点には頂点 $ 1 $, 頂点 $ 2 $, $ \dots $, 頂点 $ N $ と番号がついています。  
 辺には辺 $ 1 $, 辺 $ 2 $, $ \dots $, 辺 $ M $ と番号がついています。辺 $ i $ は頂点 $ a_i $ と頂点 $ b_i $ を結ぶ重み $ c_i $ の辺です。ここで、$ 1\ \leq\ i\ \lt\ j\ \leq\ M $ を満たすすべての整数の組 $ (i,\ j) $ について $ c_i\ \neq\ c_j $ が成り立ちます。

以下で説明される $ Q $ 個のクエリに答えてください。  
 $ i $ 番目のクエリでは整数の組 $ (u_i,\ v_i,\ w_i) $ が与えられます。ここで、$ 1\ \leq\ j\ \leq\ M $ を満たすすべての整数 $ j $ について $ w_i\ \neq\ c_j $ が成り立ちます。   
 頂点 $ u_i $ と頂点 $ v_i $ を結ぶ重み $ w_i $ の無向辺を $ e_i $ として、$ G $ に $ e_i $ を追加してできるグラフ $ G_i $ を考えます。 このとき $ G_i $ の最小全域木 $ T_i $ は一意に定まることが証明できますが、$ T_i $ に $ e_i $ は含まれるでしょうか？答えを `Yes` あるいは `No` で出力してください。

ここで、クエリの前後で $ G $ は変化しないことに注意してください。言い換えると、クエリ $ i $ で $ G $ に $ e_i $ を追加したグラフを考えたとしても、他のクエリで出てくる $ G $ に $ e_i $ が追加されていることはありません。

 最小全域木とは？ $ G $ の **全域木** とは、$ G $ に含まれるすべての頂点と $ G $ に含まれる辺の一部からなる木のことを言います。  
 $ G $ の **最小全域木** とは、$ G $ の全域木の中で辺の重みの和が最小である木のことを言います。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ M $ $ Q $ $ a_1 $ $ b_1 $ $ c_1 $ $ a_2 $ $ b_2 $ $ c_2 $ $ \vdots $ $ a_M $ $ b_M $ $ c_M $ $ u_1 $ $ v_1 $ $ w_1 $ $ u_2 $ $ v_2 $ $ w_2 $ $ \vdots $ $ u_Q $ $ v_Q $ $ w_Q $

## 输出格式

$ Q $ 行出力せよ。$ i $ 行目ではクエリ $ i $ への答えを `Yes` または `No` で出力せよ。

## 说明/提示

### 制約

- $ 2\ \leq\ N\ \leq\ 2\ \times\ 10^5 $
- $ N\ -\ 1\ \leq\ M\ \leq\ 2\ \times\ 10^5 $
- $ 1\ \leq\ a_i\ \leq\ N $ $ (1\ \leq\ i\ \leq\ M) $
- $ 1\ \leq\ b_i\ \leq\ N $ $ (1\ \leq\ i\ \leq\ M) $
- $ 1\ \leq\ c_i\ \leq\ 10^9 $ $ (1\ \leq\ i\ \leq\ M) $
- $ c_i\ \neq\ c_j $ $ (1\ \leq\ i\ \lt\ j\ \leq\ M) $
- グラフ $ G $ は連結である。
- $ 1\ \leq\ Q\ \leq\ 2\ \times\ 10^5 $
- $ 1\ \leq\ u_i\ \leq\ N $ $ (1\ \leq\ i\ \leq\ Q) $
- $ 1\ \leq\ v_i\ \leq\ N $ $ (1\ \leq\ i\ \leq\ Q) $
- $ 1\ \leq\ w_i\ \leq\ 10^9 $ $ (1\ \leq\ i\ \leq\ Q) $
- $ w_i\ \neq\ c_j $ $ (1\ \leq\ i\ \leq\ Q,\ 1\ \leq\ j\ \leq\ M) $
- 入力はすべて整数である。

### Sample Explanation 1

以下では頂点 $ u $ と頂点 $ v $ を結ぶ重み $ w $ の無向辺を $ (u,v,w) $ と表します。 $ G $ を図に表したものを以下に挙げます。 !\[image\](https://img.atcoder.jp/ghi/15ac15edee5a8b055f65192d7323d43b.png) たとえばクエリ $ 1 $ では $ G $ に $ e_1\ =\ (1,3,1) $ を追加したグラフ $ G_1 $ を考えます。$ G_1 $ の最小全域木 $ T_1 $ の辺集合は $ \lbrace\ (1,2,2),(1,3,1),(2,4,5),(3,5,8)\ \rbrace $ であり $ e_1 $ を含みます。よって `Yes` を出力します。

## 样例 #1

### 输入

```
5 6 3

1 2 2

2 3 3

1 3 6

2 4 5

4 5 9

3 5 8

1 3 1

3 4 7

3 5 7
```

### 输出

```
Yes

No

Yes
```

## 样例 #2

### 输入

```
2 3 2

1 2 100

1 2 1000000000

1 1 1

1 2 2

1 1 5
```

### 输出

```
Yes

No
```



---

---
title: "[ABC236E] Average and Median"
layout: "post"
diff: 普及+/提高
pid: AT_abc236_e
tag: []
---

# [ABC236E] Average and Median

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc236/tasks/abc236_e

$ N $ 枚のカードがあり、$ i\ \,\ (1\ \leq\ i\ \leq\ N) $ 番目のカードには整数 $ A_i $ が書かれています。

高橋君は、これらのカードから好きな枚数選びます。ただし、各 $ i\ \,\ (1\ \leq\ i\ \leq\ N\ -\ 1) $ について、$ i $ 番目のカードと $ i\ +\ 1 $ 番目のカードの少なくとも一方を選ぶ必要があります。

以下の値を求めてください。

- 選んだカードに書かれた整数の平均値としてあり得る最大値
- 選んだカードに書かれた整数の中央値としてあり得る最大値

ただし、$ n $ 個の整数の中央値は、それらのうち小さい方から数えて $ \lceil\ \frac{n}{2}\ \rceil $ 番目であるものとします。ここで、$ \lceil\ x\ \rceil $ は $ x $ 以上の最小の整数を表します。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ A_1 $ $ \ldots $ $ A_N $

## 输出格式

$ 2 $ 行出力せよ。$ 1 $ 行目には選んだカードに書かれた整数の平均値としてあり得る最大値を、$ 2 $ 行目には選んだカードに書かれた整数の中央値としてあり得る最大値を出力せよ。 平均値の出力については、正しい値との相対誤差または絶対誤差が $ 10^{-3} $ 以下であれば正答とみなされる。

## 说明/提示

### 制約

- $ 2\ \leq\ N\ \leq\ 10^5 $
- $ 1\ \leq\ A_i\ \leq\ 10^{9} $
- 入力は全て整数である。

### Sample Explanation 1

$ 2 $ 番目、$ 4 $ 番目、$ 6 $ 番目のカードを選ぶと、書かれた整数の平均は $ \frac{12}{3}\ =\ 4 $ となり、これが最大です。 $ 1 $ 番目、$ 3 $ 番目、$ 5 $ 番目、$ 6 $ 番目のカードを選ぶと、書かれた整数の中央値は $ 2 $ となり、これが最大です。

### Sample Explanation 2

平均値の出力については誤差が認められるので、例えば $ 5.2491 $ と出力しても正答とみなされます。ただし、中央値は正確な値を出力しなければなりません。

## 样例 #1

### 输入

```
6

2 1 2 1 1 10
```

### 输出

```
4

2
```

## 样例 #2

### 输入

```
7

3 1 4 1 5 9 2
```

### 输出

```
5.250000000

4
```



---

---
title: "[ABC237F] |LIS| = 3"
layout: "post"
diff: 普及+/提高
pid: AT_abc237_f
tag: []
---

# [ABC237F] |LIS| = 3

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc237/tasks/abc237_f

以下の条件を全て満たす数列の個数を、$ 998244353 $ で割った余りを求めてください。

- 数列の長さが $ N $
- 数列の各項は $ 1 $ 以上 $ M $ 以下の整数
- 最長増加部分列の長さがちょうど $ 3 $

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ M $

## 输出格式

答えを出力せよ。

## 说明/提示

### 注記

数列の**部分列**とは、数列から $ 0 $ 個以上の要素を取り除いた後、残りの要素を元の順序で連結して得られる数列のことをいいます。  
 例えば、$ (10,30) $ は $ (10,20,30) $ の部分列ですが、$ (20,10) $ は $ (10,20,30) $ の部分列ではありません。

数列の**最長増加部分列**とは、数列の**狭義**単調増加な部分列のうち、長さが最大のもののことをいいます。

### 制約

- $ 3\ \leq\ N\ \leq\ 1000 $
- $ 3\ \leq\ M\ \leq\ 10 $
- 入力は全て整数である

### Sample Explanation 1

例えば $ (3,4,1,5) $ は条件を満たす数列です。 一方 $ (4,4,1,5) $ は最長増加部分列の長さが $ 2 $ なので条件を満たしません。

### Sample Explanation 3

$ 998244353 $ で割った余りを求めてください。

## 样例 #1

### 输入

```
4 5
```

### 输出

```
135
```

## 样例 #2

### 输入

```
3 4
```

### 输出

```
4
```

## 样例 #3

### 输入

```
111 3
```

### 输出

```
144980434
```



---

---
title: "[ABC238E] Range Sums"
layout: "post"
diff: 普及+/提高
pid: AT_abc238_e
tag: []
---

# [ABC238E] Range Sums

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc238/tasks/abc238_e

高橋くんは秘密の整数列 $ a $ を持っており、現時点で、$ a $ の長さが $ N $ であることは分かっています。

$ a $ の中身を当てたいあなたに対し、高橋くんは以下の $ Q $ 個の情報を追加で与えてくれることを約束しました。

- $ i\ (1\ \leq\ i\ \leq\ Q) $ 個目の情報: $ a_{l_i}+a_{l_i+1}+\cdots+a_{r_i} $ の値

高橋くんが約束を守り、$ Q $ 個の情報すべてが与えられた場合、$ a $ に含まれる全要素の総和 $ a_1+a_2+\cdots+a_N $ を特定することは可能ですか？

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ Q $ $ l_1 $ $ r_1 $ $ l_2 $ $ r_2 $ $ \hspace{0.4cm}\vdots $ $ l_Q $ $ r_Q $

## 输出格式

$ a $ に含まれる全要素の総和を特定することが可能なら `Yes` を、そうでないなら `No` を出力せよ。

## 说明/提示

### 制約

- $ 1\ \leq\ N\ \leq\ 2\ \times\ 10^5 $
- $ 1\ \leq\ Q\ \leq\ \min(2\ \times\ 10^5,\frac{N(N+1)}{2}) $
- $ 1\ \leq\ l_i\ \leq\ r_i\ \leq\ N $
- $ (l_i,r_i)\ \neq\ (l_j,r_j)\ (i\ \neq\ j) $
- 入力はすべて整数

### Sample Explanation 1

$ 1 $ 個目の情報と $ 2 $ 個目の情報から、$ a_1+a_2+a_2+a_3 $ の値が分かります。そこから $ 3 $ 個目の情報によって得られる $ a_2 $ の値を引くと、$ a_1+a_2+a_3 $ の値を特定可能です。

### Sample Explanation 2

$ a $ の先頭 $ 3 $ 項の総和を特定することは可能ですが、全要素の総和を特定することは不可能です。

### Sample Explanation 3

$ 4 $ 個目の情報によって全要素の総和が直接与えられています。

## 样例 #1

### 输入

```
3 3

1 2

2 3

2 2
```

### 输出

```
Yes
```

## 样例 #2

### 输入

```
4 3

1 3

1 2

2 3
```

### 输出

```
No
```

## 样例 #3

### 输入

```
4 4

1 1

2 2

3 3

1 4
```

### 输出

```
Yes
```



---

---
title: "[ABC240F] Sum Sum Max"
layout: "post"
diff: 普及+/提高
pid: AT_abc240_f
tag: []
---

# [ABC240F] Sum Sum Max

## 题目描述

有三个数列 $A,B,C$。

其中 $C$ 表示为 $ x_1,\ \dots,\ x_N,\ y_1,\ \dots,\ y_N $ 的形式，意思是前 $y_1$ 个数为 $x_1$,之后 $y_2$ 个数为 $x_2$……最后 $y_N$ 个数为 $x_N$。

$B$ 为 $C$ 的前缀和数组。

$A$ 为 $B$ 的前缀和数组。

求 $A$ 中最大值。

## 输入格式

对于每组数据，

第一行为两个数 $N$ 和 $M$，

第 $2$ 至 $N+1$ 行，第 $i$ 行为两个数 $x_{i-1}$ 和 $y_{i-1}$。

## 输出格式

对于每组数据，输出一行一个整数表示答案

## 样例 #1

### 样例输入 #1

```
3
3 7
-1 2
2 3
-3 2
10 472
-4 12
1 29
2 77
-1 86
0 51
3 81
3 17
-2 31
-4 65
4 23
1 1000000000
4 1000000000
```

### 样例输出 #1

```
4
53910
2000000002000000000
```

## 说明/提示

- $ 1\ \leq\ T\ \leq\ 2\ \times\ 10^5 $
- $ 1\ \leq\ N\ \leq\ 2\ \times\ 10^5 $
- $ \sum\ N\ \leq\ 2\times\ 10^5 $
- $ 1\ \leq\ M\ \leq\ 10^9 $
- $ |x_i|\ \leq\ 4\ \,\ (1\ \leq\ i\ \leq\ N) $
- $ y_i\ \gt\ 0\ \,\ (1\ \leq\ i\ \leq\ N) $
- $ \sum_{k\ =\ 1}^N\ y_k\ =\ M $

## 样例 #1

### 输入

```
3

3 7

-1 2

2 3

-3 2

10 472

-4 12

1 29

2 77

-1 86

0 51

3 81

3 17

-2 31

-4 65

4 23

1 1000000000

4 1000000000
```

### 输出

```
4

53910

2000000002000000000
```



---

---
title: "[ABC241F] Skate"
layout: "post"
diff: 普及+/提高
pid: AT_abc241_f
tag: []
---

# [ABC241F] Skate

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc241/tasks/abc241_f

$ H $ 行 $ W $ 列のグリッド型のスケート場があります。上から $ i $ 行目、左から $ j $ 行目のマスを $ (i,j) $ で表します。

スケート場には $ N $ 個の障害物があり、$ i $ 個目の障害物は $ (X_i,Y_i) $ に置かれています。

高橋君は $ 1 $ 回の移動において、上下左右いずれかの方向を選んで、障害物に当たるまで進み続けます。  
 障害物に当たるとその $ 1 $ つ手前のマスで停止します。 なお、スケート場の周りは崖になっており、障害物に当たらないような移動は禁止とします。

高橋君ははじめ $ (s_x,s_y) $ にいて、何回か移動することで $ (g_x,g_y) $ で停止したいと考えています。

$ (g_x,g_y) $ へ辿り着くには最小で何回の移動が必要ですか？辿り着けないときはその旨を伝えてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ H $ $ W $ $ N $ $ s_x $ $ s_y $ $ g_x $ $ g_y $ $ X_1 $ $ Y_1 $ $ X_2 $ $ Y_2 $ $ \vdots $ $ X_N $ $ Y_N $

## 输出格式

$ (g_x,g_y) $ へ辿り着くには最小で何回の移動が必要か出力せよ。  
 ただし、辿り着けないならば `-1` と出力せよ。

## 说明/提示

### 制約

- $ 1\leq\ H\ \leq\ 10^9 $
- $ 1\leq\ W\ \leq\ 10^9 $
- $ 1\leq\ N\ \leq\ 10^5 $
- $ 1\leq\ s_x,g_x\leq\ H $
- $ 1\leq\ s_y,g_y\leq\ W $
- $ 1\leq\ X_i\ \leq\ H $
- $ 1\leq\ Y_i\ \leq\ W $
- $ (s_x,s_y)\neq\ (g_x,g_y) $
- $ (s_x,s_y)\neq\ (X_i,Y_i) $
- $ (g_x,g_y)\neq\ (X_i,Y_i) $
- $ i\neq\ j $ ならば、$ (X_i,Y_i)\neq\ (X_j,Y_j) $
- 入力は全て整数である

### Sample Explanation 1

!\[\](https://img.atcoder.jp/ghi/c376ca3813eb4c947eb605dea2d30454.png) 図は、$ (s_x,s_y) $ を `S` で、$ (g_x,g_y) $ を `G` で表しています。 $ (3,4)\rightarrow(2,4)\ \rightarrow(2,2)\ \rightarrow(5,2)\ \rightarrow(5,6) $ と移動すると、$ 4 $ 回の移動で $ (g_x,g_y) $ に辿り着くことができます。

### Sample Explanation 2

!\[\](https://img.atcoder.jp/ghi/07ab8a3e7c94525cd52704dd43e43b87.png) $ (g_x,g_y) $ で停止する必要があります。 通過しただけでは $ (g_x,g_y) $ へ辿り着いたとみなされないことに注意してください。

### Sample Explanation 3

!\[\](https://img.atcoder.jp/ghi/a423524262f4a075b94e2ab5f9e61164.png) 左を選んで進むと、高橋君は $ (g_x,g_y) $ を通過したのちに崖に落ちてしまいます。 スケート場の周りは崖になっており、障害物に当たらないような移動は禁止されていることに注意してください。

## 样例 #1

### 输入

```
7 8 7

3 4

5 6

1 4

2 1

2 8

4 5

5 7

6 2

6 6
```

### 输出

```
4
```

## 样例 #2

### 输入

```
4 6 2

3 2

3 5

4 5

2 5
```

### 输出

```
-1
```

## 样例 #3

### 输入

```
1 10 1

1 5

1 1

1 7
```

### 输出

```
-1
```



---

---
title: "[ABC242E] (∀x∀)"
layout: "post"
diff: 普及+/提高
pid: AT_abc242_e
tag: []
---

# [ABC242E] (∀x∀)

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc242/tasks/abc242_e

$ T $ 個のテストケースについて、次の問題を解いてください。

整数 $ N $ と文字列 $ S $ が与えられるので、以下の条件を全て満たす文字列 $ X $ の数を $ 998244353 $ で割った余りを求めてください。

- $ X $ は英大文字のみからなる長さ $ N $ の文字列
- $ X $ は回文
- 辞書順で $ X\ \le\ S $
  - すなわち、 $ X=S $ であるか、辞書順で $ X $ が $ S $ より前に来る

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ T $ $ \mathrm{case}_1 $ $ \mathrm{case}_2 $ $ \vdots $ $ \mathrm{case}_T $

ただし、 $ \mathrm{case}_i $ は $ i $ 個目のテストケースを表す。

各テストケースは以下の形式で与えられる。

> $ N $ $ S $

## 输出格式

全体で $ T $ 行出力せよ。  
 $ i $ 行目には $ i $ 個目のテストケースに対する答えを整数として出力せよ。

## 说明/提示

### 制約

- $ 1\ \le\ T\ \le\ 250000 $
- $ N $ は $ 1 $ 以上 $ 10^6 $ 以下の整数
- ひとつの入力について、含まれるテストケースの $ N $ の総和は $ 10^6 $ を超えない
- $ S $ は英大文字のみからなる長さ $ N $ の文字列

### Sample Explanation 1

この入力には $ 5 $ 個のテストケースが含まれます。 $ 1 $ 個目のテストケース: 問題文中の条件を満たす文字列は `AAA`$ , $ `ABA`$ , $ `ACA`$ ,..., $ `AXA` の $ 24 $ 個です。 $ 2 $ 個目のテストケース: $ S $ が回文であるとは限りません。 $ 3 $ 個目のテストケース: $ 998244353 $ で割った余りを求めることに注意してください。

## 样例 #1

### 输入

```
5

3

AXA

6

ABCZAZ

30

QWERTYUIOPASDFGHJKLZXCVBNMQWER

28

JVIISNEOXHSNEAAENSHXOENSIIVJ

31

KVOHEEMSOZZASHENDIGOJRTJVMVSDWW
```

### 输出

```
24

29

212370247

36523399

231364016
```



---

---
title: "[ABC243E] Edge Deletion"
layout: "post"
diff: 普及+/提高
pid: AT_abc243_e
tag: []
---

# [ABC243E] Edge Deletion

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc243/tasks/abc243_e

$ N $ 頂点 $ M $ 辺の単純連結無向グラフが与えられます。  
 辺 $ i $ は頂点 $ A_i $ と頂点 $ B_i $ を結ぶ長さ $ C_i $ の辺です。

以下の条件を満たすようにいくつかの辺を削除します。削除する辺の数の最大値を求めてください。

- 辺を削除した後のグラフも連結である。
- 全ての頂点対 $ (s,t) $ について、頂点 $ s $ と頂点 $ t $ の間の距離が削除前と削除後で変化しない。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ M $ $ A_1 $ $ B_1 $ $ C_1 $ $ A_2 $ $ B_2 $ $ C_2 $ $ \vdots $ $ A_M $ $ B_M $ $ C_M $

## 输出格式

答えを出力せよ。

## 说明/提示

### 注釈

単純連結無向グラフとは、単純かつ連結で辺に向きの無いグラフのことをいいます。  
 グラフが単純であるとは、グラフが自己ループや多重辺を含まないことをいいます。  
 グラフが連結であるとは、グラフ上の任意の $ 2 $ 頂点 $ s,\ t $ について $ s $ から $ t $ へ辺をたどって行けることをいいます。  
 頂点 $ s $ と頂点 $ t $ の間の距離とは、頂点 $ s $ と頂点 $ t $ の間の最短路の長さのことをいいます。

### 制約

- $ 2\ \leq\ N\ \leq\ 300 $
- $ N-1\ \leq\ M\ \leq\ \frac{N(N-1)}{2} $
- $ 1\ \leq\ A_i\ \lt\ B_i\ \leq\ N $
- $ 1\ \leq\ C_i\ \leq\ 10^9 $
- $ i\ \neq\ j $ ならば $ (A_i,\ B_i)\ \neq\ (A_j,\ B_j) $ である。
- 与えられるグラフは連結である。
- 入力はすべて整数である。

### Sample Explanation 1

辺を削除する前の全ての頂点対の距離は次の通りです。 - 頂点 $ 1 $ と頂点 $ 2 $ の距離は $ 2 $ - 頂点 $ 1 $ と頂点 $ 3 $ の距離は $ 5 $ - 頂点 $ 2 $ と頂点 $ 3 $ の距離は $ 3 $ 辺 $ 3 $ を削除しても全ての頂点間の距離は変化しません。また、問題文の条件を満たすように $ 2 $ 本以上の辺を削除することはできないので、答えは $ 1 $ 本になります。

### Sample Explanation 2

どの辺も削除することができません。

## 样例 #1

### 输入

```
3 3

1 2 2

2 3 3

1 3 6
```

### 输出

```
1
```

## 样例 #2

### 输入

```
5 4

1 3 3

2 3 9

3 5 3

4 5 3
```

### 输出

```
0
```

## 样例 #3

### 输入

```
5 10

1 2 71

1 3 9

1 4 82

1 5 64

2 3 22

2 4 99

2 5 1

3 4 24

3 5 18

4 5 10
```

### 输出

```
5
```



---

---
title: "[ABC244F] Shortest Good Path"
layout: "post"
diff: 普及+/提高
pid: AT_abc244_f
tag: []
---

# [ABC244F] Shortest Good Path

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc244/tasks/abc244_f

$ N $ 個の頂点と $ M $ 本の辺からなる単純（自己ループおよび多重辺を持たない）かつ連結な無向グラフが与えられます。  
 $ i\ =\ 1,\ 2,\ \ldots,\ M $ について、$ i $ 番目の辺は頂点 $ u_i $ と頂点 $ v_i $ を結びます。

下記の $ 2 $ つの条件をともに満たす整数列 $ (A_1,\ A_2,\ \ldots,\ A_k) $ を長さ $ k $ の**パス**と呼びます。

- すべての $ i\ =\ 1,\ 2,\ \dots,\ k $ について、$ 1\ \leq\ A_i\ \leq\ N $ 。
- すべての $ i\ =\ 1,\ 2,\ \ldots,\ k-1 $ について、頂点 $ A_i $ と頂点 $ A_{i+1} $ は辺で直接結ばれている。

空列も長さ $ 0 $ のパスとみなします。

$ S\ =\ s_1s_2\ldots\ s_N $ を $ 0 $ と $ 1 $ のみからなる長さ $ N $ の文字列とします。 パス $ A\ =\ (A_1,\ A_2,\ \ldots,\ A_k) $ が下記を満たすとき、パス $ A $ を $ S $ に関する**良いパス**と呼びます。

- すべての $ i\ =\ 1,\ 2,\ \ldots,\ N $ について、次を満たす。
  - $ s_i\ =\ 0 $ ならば、$ A $ に含まれる $ i $ の個数は偶数である。
  - $ s_i\ =\ 1 $ ならば、$ A $ に含まれる $ i $ の個数は奇数である。

$ S $ として考えられる文字列（すなわち、$ 0 $ と $ 1 $ のみからなる長さ $ N $ の文字列）は $ 2^N $ 個ありますが、そのすべてにわたる「 $ S $ に関する良いパスのうち最短のものの長さ」の総和を出力してください。

この問題の制約下において、$ 0 $ と $ 1 $ からなる長さ $ N $ のどのような文字列を $ S $ として選んでも、$ S $ に関する良いパスが少なくとも $ 1 $ つ存在することが示せます。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ M $ $ u_1 $ $ v_1 $ $ u_2 $ $ v_2 $ $ \vdots $ $ u_M $ $ v_M $

## 输出格式

答えを出力せよ。

## 说明/提示

### 制約

- $ 2\ \leq\ N\ \leq\ 17 $
- $ N-1\ \leq\ M\ \leq\ \frac{N(N-1)}{2} $
- $ 1\ \leq\ u_i,\ v_i\ \leq\ N $
- 与えられるグラフは単純かつ連結
- 入力はすべて整数

### Sample Explanation 1

\- $ S\ =\ 000 $ のとき、空列 $ () $ は $ S $ に関する最短の良いパスであり、その長さは $ 0 $ です。 - $ S\ =\ 100 $ のとき、$ (1) $ は $ S $ に関する最短の良いパスであり、その長さは $ 1 $ です。 - $ S\ =\ 010 $ のとき、$ (2) $ は $ S $ に関する最短の良いパスであり、その長さは $ 1 $ です。 - $ S\ =\ 110 $ のとき、$ (1,\ 2) $ は $ S $ に関する最短の良いパスであり、その長さは $ 2 $ です。 - $ S\ =\ 001 $ のとき、$ (3) $ は $ S $ に関する最短の良いパスであり、その長さは $ 1 $ です。 - $ S\ =\ 101 $ のとき、$ (1,\ 2,\ 3,\ 2) $ は $ S $ に関する最短の良いパスであり、その長さは $ 4 $ です。 - $ S\ =\ 011 $ のとき、$ (2,\ 3) $ は $ S $ に関する最短の良いパスであり、その長さは $ 2 $ です。 - $ S\ =\ 111 $ のとき、$ (1,\ 2,\ 3) $ は $ S $ に関する最短の良いパスであり、その長さは $ 3 $ です。 よって、求める答えは $ 0\ +\ 1\ +\ 1\ +\ 2\ +\ 1\ +\ 4\ +\ 2\ +\ 3\ =\ 14 $ です。

## 样例 #1

### 输入

```
3 2

1 2

2 3
```

### 输出

```
14
```

## 样例 #2

### 输入

```
5 5

4 2

2 3

1 3

2 1

1 5
```

### 输出

```
108
```



---

---
title: "[ABC245E] Wrapping Chocolate"
layout: "post"
diff: 普及+/提高
pid: AT_abc245_e
tag: []
---

# [ABC245E] Wrapping Chocolate

## 题目描述

高桥先生有 $N$ 块巧克力。第 $i$ 块巧克力是长为 $A_i$，宽为 $B_i$ cm 的长方形。高桥先生还有 $M$ 个盒子。第 $i$ 个盒子是长为 $C_i$，宽为 $D_i$ cm 的长方形。

请问是否能在满足以下条件的情况下把所有巧克力放入盒子中。

- 一个盒子中最多放入一块巧克力。
- 当把第 $i$ 块巧克力放入第 $j$ 个盒子的时候，必须满足 $A_i\le C_j$ 并且 $B_i\le D_j$（不允许旋转）。

## 输入格式

从标准格式读入数据，格式如下：

> $N\space M\space A_i … A_N\space B_i … B_N\space C_i … C_M\space D_i … D_M$

## 输出格式

如果可以把所有巧克力都放在盒子里，就输出 ``Yes``，否则输出 ``No``。

### 样例解释 1

把第 $1$ 块巧克力放进第 $3$ 个盒子，把第 $2$ 块巧克力放进第 $1$ 个盒子。

### 样例解释 2

如果想全部放入盒子中，第 $1$ 个盒子至少应该放 $2$ 块巧克力。

## 说明/提示

- $1\le N\le M\le 2\times 10^5$
- $1\le A_i,B_i,C_i,D_i\le 10^9$
- 所有数据均为整数。

—— Translated by 2c_s

## 样例 #1

### 输入

```
2 3

2 4

3 2

8 1 5

2 10 5
```

### 输出

```
Yes
```

## 样例 #2

### 输入

```
2 2

1 1

2 2

100 1

100 1
```

### 输出

```
No
```

## 样例 #3

### 输入

```
1 1

10

100

100

10
```

### 输出

```
No
```

## 样例 #4

### 输入

```
1 1

10

100

10

100
```

### 输出

```
Yes
```



---

---
title: "[ABC245F] Endless Walk"
layout: "post"
diff: 普及+/提高
pid: AT_abc245_f
tag: []
---

# [ABC245F] Endless Walk

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc245/tasks/abc245_f

$ N $ 頂点 $ M $ 辺からなる単純な有向グラフ $ G $ があり、頂点には頂点 $ 1 $, 頂点 $ 2 $, $ \ldots $, 頂点 $ N $ と番号がついています。 また、$ i $ $ (1\leq\ i\leq\ M) $ 本目の辺は頂点 $ U_i $ から頂点 $ V_i $ へ張られています。

高橋君がある頂点から始めて、$ G $ の上を有向辺に沿って頂点から頂点へ移動することを繰り返します。 $ G $ の頂点のうち、高橋君がうまく経路を選ぶことで、その頂点から始めていくらでも移動を繰り返すことができるようなものの個数を求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ M $ $ U_1 $ $ V_1 $ $ U_2 $ $ V_2 $ $ \vdots $ $ U_M $ $ V_M $

## 输出格式

答えを出力せよ。

## 说明/提示

### 制約

- $ 1\ \leq\ N\ \leq\ 2\times\ 10^5 $
- $ 0\ \leq\ M\ \leq\ \min(N(N-1),\ 2\times\ 10^5) $
- $ 1\ \leq\ U_i,V_i\leq\ N $
- $ U_i\neq\ V_i $
- $ i\neq\ j $ ならば $ (U_i,V_i)\neq\ (U_j,V_j) $
- 入力はすべて整数である。

### Sample Explanation 1

頂点 $ 2 $ を始点とした場合、頂点 $ 2 $ $ \to $ 頂点 $ 3 $ $ \to $ 頂点 $ 4 $ $ \to $ 頂点 $ 2 $ $ \to $ 頂点 $ 3 $ $ \to $ $ \cdots $ と高橋君はいくらでも移動を繰り返す事ができます。 頂点 $ 3 $, 頂点 $ 4 $ を始点とした場合も同様です。 頂点 $ 1 $ からは最初に頂点 $ 2 $ に移動して、以下同様にいくらでも行動を繰り返すことができます。 一方、頂点 $ 5 $ からは一度も移動することができません。 よって、条件を満たすのは頂点 $ 1 $, $ 2 $, $ 3 $, $ 4 $ の $ 4 $ つであるので、 $ 4 $ を出力します。

### Sample Explanation 2

単純な有向グラフにおいて、$ 2 $ つの頂点の間を互いに逆向きに結ぶ辺が、ともに存在する事はあり得ることに注意してください。 また、$ G $ は連結であるとは限りません。

## 样例 #1

### 输入

```
5 5

1 2

2 3

3 4

4 2

4 5
```

### 输出

```
4
```

## 样例 #2

### 输入

```
3 2

1 2

2 1
```

### 输出

```
2
```



---

---
title: "[ABC246E] Bishop 2"
layout: "post"
diff: 普及+/提高
pid: AT_abc246_e
tag: []
---

# [ABC246E] Bishop 2

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc246/tasks/abc246_e

ここに、 $ N\ \times\ N $ のチェス盤があります。このチェス盤の上から $ i $ 行目、左から $ j $ 列目にあるマスをマス $ (i,j) $ と呼びます。  
 チェス盤の情報は $ N $ 個の文字列 $ S_i $ として与えられます。  
 文字列 $ S_i $ の $ j $ 文字目である $ S_{i,j} $ には、以下の情報が含まれています。

- $ S_{i,j}= $ `.` のとき マス $ (i,j) $ には何も置かれていない。
- $ S_{i,j}= $ `#` のとき マス $ (i,j) $ には白のポーンが $ 1 $ つ置かれている。このポーンを動かしたり取り除いたりすることはできない。

この盤面のマス $ (A_x,A_y) $ に、白のビショップを $ 1 $ つ置きました。  
 この白のビショップをチェスのルール (注記参照) に従ってマス $ (A_x,A_y) $ からマス $ (B_x,B_y) $ に移動させるために必要な最小の手数を求めてください。  
 ただし、移動できない場合は代わりに `-1` を出力してください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ A_x $ $ A_y $ $ B_x $ $ B_y $ $ S_1 $ $ S_2 $ $ \vdots $ $ S_N $

## 输出格式

答えを出力せよ。

## 说明/提示

### 注記

マス $ (i,j) $ に置かれている白の [ビショップ](https://ja.wikipedia.org/wiki/%E3%83%93%E3%82%B7%E3%83%A7%E3%83%83%E3%83%97) は、 $ 1 $ 手で以下のルールに従って移動することができます。

- 各正整数 $ d $ について、以下の条件を全て満たせばマス $ (i+d,j+d) $ に移動できる。
  
  
  - マス $ (i+d,j+d) $ が盤内に存在する
  - 全ての正整数 $ l\ \le\ d $ について、 $ (i+l,j+l) $ に白のポーンがない
- 各正整数 $ d $ について、以下の条件を全て満たせばマス $ (i+d,j-d) $ に移動できる。
  
  
  - マス $ (i+d,j-d) $ が盤内に存在する
  - 全ての正整数 $ l\ \le\ d $ について、 $ (i+l,j-l) $ に白のポーンがない
- 各正整数 $ d $ について、以下の条件を全て満たせばマス $ (i-d,j+d) $ に移動できる。
  
  
  - マス $ (i-d,j+d) $ が盤内に存在する
  - 全ての正整数 $ l\ \le\ d $ について、 $ (i-l,j+l) $ に白のポーンがない
- 各正整数 $ d $ について、以下の条件を全て満たせばマス $ (i-d,j-d) $ に移動できる。
  
  
  - マス $ (i-d,j-d) $ が盤内に存在する
  - 全ての正整数 $ l\ \le\ d $ について、 $ (i-l,j-l) $ に白のポーンがない

### 制約

- $ 2\ \le\ N\ \le\ 1500 $
- $ 1\ \le\ A_x,A_y\ \le\ N $
- $ 1\ \le\ B_x,B_y\ \le\ N $
- $ (A_x,A_y)\ \neq\ (B_x,B_y) $
- $ S_i $ は `.` および `#` からなる $ N $ 文字の文字列
- $ S_{A_x,A_y}= $ `.`
- $ S_{B_x,B_y}= $ `.`

### Sample Explanation 1

以下のように移動させることで $ 3 $ 手でビショップを $ (1,3) $ から $ (3,5) $ まで移動させることができます。 $ 2 $ 手以内でビショップを $ (1,3) $ から $ (3,5) $ まで移動させることはできません。 - $ (1,3)\ \rightarrow\ (2,2)\ \rightarrow\ (4,4)\ \rightarrow\ (3,5) $

### Sample Explanation 2

どのようにビショップを動かしても $ (3,2) $ から $ (4,2) $ に移動させることはできません。

## 样例 #1

### 输入

```
5

1 3

3 5

....#

...#.

.....

.#...

#....
```

### 输出

```
3
```

## 样例 #2

### 输入

```
4

3 2

4 2

....

....

....

....
```

### 输出

```
-1
```

## 样例 #3

### 输入

```
18

18 1

1 18

..................

.####.............

.#..#..####.......

.####..#..#..####.

.#..#..###...#....

.#..#..#..#..#....

.......####..#....

.............####.

..................

..................

.####.............

....#..#..#.......

.####..#..#..####.

.#.....####..#....

.####.....#..####.

..........#..#..#.

.............####.

..................
```

### 输出

```
9
```



---

---
title: "[ABC246F] typewriter"
layout: "post"
diff: 普及+/提高
pid: AT_abc246_f
tag: []
---

# [ABC246F] typewriter

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc246/tasks/abc246_f

$ N $ 段からなるタイプライターがあります。このうち、上から $ i $ 段目のキーでは文字列 $ S_i $ に含まれる文字が打てます。

このキーボードを使って、以下のルールで文字列をひとつ入力することを考えます。

- まず、整数 $ 1\ \le\ k\ \le\ N $ を選択する。
- その後、空文字列から始めて、上から $ k $ 段目にあるキーだけを使ってちょうど $ L $ 文字の文字列を入力する。

このルールに従って入力可能な $ L $ 文字の文字列は何通りありますか？ 答えは非常に大きくなる場合があるので $ 998244353 $ で割った余りを出力してください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ L $ $ S_1 $ $ S_2 $ $ \dots $ $ S_N $

## 输出格式

答えを出力せよ。

## 说明/提示

### 制約

- $ N,L $ は整数
- $ 1\ \le\ N\ \le\ 18 $
- $ 1\ \le\ L\ \le\ 10^9 $
- $ S_i $ は `abcdefghijklmnopqrstuvwxyz` の(連続とは限らない)空でない部分列

### Sample Explanation 1

入力可能な文字列は `aa`, `ab`, `ac`, `ba`, `bb`, `ca`, `cc` の $ 7 $ つです。

### Sample Explanation 3

答えを $ 998244353 $ で割った余りを出力してください。

## 样例 #1

### 输入

```
2 2

ab

ac
```

### 输出

```
7
```

## 样例 #2

### 输入

```
4 3

abcdefg

hijklmnop

qrstuv

wxyz
```

### 输出

```
1352
```

## 样例 #3

### 输入

```
5 1000000000

abc

acde

cefg

abcfh

dghi
```

### 输出

```
346462871
```



---

---
title: "[ABC249F] Ignore Operations"
layout: "post"
diff: 普及+/提高
pid: AT_abc249_f
tag: []
---

# [ABC249F] Ignore Operations

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc249/tasks/abc249_f

高橋君は整数 $ x $ を持っています。はじめ、$ x\ =\ 0 $ です。

$ N $ 個の操作があります。$ i\ \,\ (1\ \leq\ i\ \leq\ N) $ 個目の操作は整数 $ t_i,\ y_i $ を用いて以下のように表されます。

- $ t_i\ =\ 1 $ のとき、$ x $ を $ y_i $ で置き換える。
- $ t_i\ =\ 2 $ のとき、$ x $ を $ x\ +\ y_i $ で置き換える。

高橋君は $ 0 $ 個以上 $ K $ 個以下の好きな個数の操作を無視することができます。残った操作を一度ずつ順序を変えずに行ったとき、最終的な $ x $ の値としてあり得る最大値を求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ K $ $ t_1 $ $ y_1 $ $ \vdots $ $ t_N $ $ y_N $

## 输出格式

答えを出力せよ。

## 说明/提示

### 制約

- $ 1\ \leq\ N\ \leq\ 2\ \times\ 10^5 $
- $ 0\ \leq\ K\ \leq\ N $
- $ t_i\ \in\ \{1,2\}\ \,\ (1\ \leq\ i\ \leq\ N) $
- $ |y_i|\ \leq\ 10^9\ \,\ (1\ \leq\ i\ \leq\ N) $
- 入力は全て整数

### Sample Explanation 1

$ 5 $ 個目の操作を無視すると、$ x $ は $ 0\ \rightarrow\ 4\ \rightarrow\ 1\ \rightarrow\ 2\ \rightarrow\ 3 $ と変化し、最終的な $ x $ の値は $ 3 $ となります。これが最大です。

## 样例 #1

### 输入

```
5 1
2 4
2 -3
1 2
2 1
2 -3
```

### 输出

```
3
```

## 样例 #2

### 输入

```
1 0
2 -1000000000
```

### 输出

```
-1000000000
```

## 样例 #3

### 输入

```
10 3
2 3
2 -1
1 4
2 -1
2 5
2 -9
2 2
1 -6
2 5
2 -3
```

### 输出

```
15
```



---

---
title: "[ABC251D] At Most 3 (Contestant ver.)"
layout: "post"
diff: 普及+/提高
pid: AT_abc251_d
tag: []
---

# [ABC251D] At Most 3 (Contestant ver.)

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc251/tasks/abc251_d

整数 $ W $ が与えられます。  
 あなたは以下の条件をすべて満たすようにいくつかのおもりを用意することにしました。

- おもりの個数は $ 1 $ 個以上 $ 300 $ 個以下である。
- おもりの重さは $ 10^6 $ 以下の正整数である。
- $ 1 $ 以上 $ W $ 以下のすべての正整数は **良い整数** である。ここで、以下の条件を満たす正整数 $ n $ を良い整数と呼ぶ。
  - 用意したおもりのうち $ \bf{3} $ **個以下** の異なるおもりを自由に選んで、選んだおもりの重さの和を $ n $ にすることができる。

条件を満たすようなおもりの組を $ 1 $ つ出力してください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ W $

## 输出格式

$ N $ をおもりの個数、$ A_i $ を $ i $ 番目のおもりの重さとして、以下の形式で出力せよ。答えが複数存在する場合、どれを出力しても正解とみなされる。

> $ N $ $ A_1 $ $ A_2 $ $ \dots $ $ A_N $

ただし、$ N $ および $ A_1,A_2,\dots,A_N $ は以下の条件を満たす必要がある。

- $ 1\ \leq\ N\ \leq\ 300 $
- $ 1\ \leq\ A_i\ \leq\ 10^6 $

## 说明/提示

### 制約

- $ 1\ \leq\ W\ \leq\ 10^6 $
- $ W $ は整数

### Sample Explanation 1

上の出力は重さ $ 1 $ のおもり、重さ $ 2 $ のおもり、重さ $ 3 $ のおもりの $ 3 $ 個のおもりを用意しています。 この出力は条件を満たしています。特に $ 3 $ 番目の条件について、以下のようにおもりを選ぶことで $ 1 $ 以上 $ W $ 以下の整数すべてが良い整数であることが確認できます。 - $ 1 $ 番目のおもりのみを選ぶと、重さの和は $ 1 $ になる。 - $ 2 $ 番目のおもりのみを選ぶと、重さの和は $ 2 $ になる。 - $ 3 $ 番目のおもりのみを選ぶと、重さの和は $ 3 $ になる。 - $ 1 $ 番目と $ 3 $ 番目のおもりを選ぶと、重さの和は $ 4 $ になる。 - $ 2 $ 番目と $ 3 $ 番目のおもりを選ぶと、重さの和は $ 5 $ になる。 - $ 1 $ 番目、$ 2 $ 番目と $ 3 $ 番目のおもりを選ぶと、重さの和は $ 6 $ になる。

### Sample Explanation 2

同じ重さのおもりを $ 2 $ 個以上用意しても良いです。

## 样例 #1

### 输入

```
6
```

### 输出

```
3

1 2 3
```

## 样例 #2

### 输入

```
12
```

### 输出

```
6

2 5 1 2 5 1
```



---

---
title: "[ABC259E] LCM on Whiteboard"
layout: "post"
diff: 普及+/提高
pid: AT_abc259_e
tag: []
---

# [ABC259E] LCM on Whiteboard

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc259/tasks/abc259_e

$ N $ 個の整数 $ a_1,\ldots,a_N $ が白板に書かれています。  
 ここで、$ a_i $ は $ m_i $ 個の素数 $ p_{i,1}\ \lt\ \ldots\ \lt\ p_{i,m_i} $ と正整数 $ e_{i,1},\ldots,e_{i,m_i} $ を用いて $ a_i\ =\ p_{i,1}^{e_{i,1}}\ \times\ \ldots\ \times\ p_{i,m_i}^{e_{i,m_i}} $ と表せる整数です。  
 あなたは $ N $ 個の整数から $ 1 $ つ選んで $ 1 $ に書き換えます。  
 書き換えた後の $ N $ 個の整数の最小公倍数としてあり得る値の個数を求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ m_1 $ $ p_{1,1} $ $ e_{1,1} $ $ \vdots $ $ p_{1,m_1} $ $ e_{1,m_1} $ $ m_2 $ $ p_{2,1} $ $ e_{2,1} $ $ \vdots $ $ p_{2,m_2} $ $ e_{2,m_2} $ $ \vdots $ $ m_N $ $ p_{N,1} $ $ e_{N,1} $ $ \vdots $ $ p_{N,m_N} $ $ e_{N,m_N} $

## 输出格式

答えを出力せよ。

## 说明/提示

### 制約

- $ 1\ \leq\ N\ \leq\ 2\ \times\ 10^5 $
- $ 1\ \leq\ m_i $
- $ \sum{m_i}\ \leq\ 2\ \times\ 10^5 $
- $ 2\ \leq\ p_{i,1}\ \lt\ \ldots\ \lt\ p_{i,m_i}\ \leq\ 10^9 $
- $ p_{i,j} $ は素数
- $ 1\ \leq\ e_{i,j}\ \leq\ 10^9 $
- 入力はすべて整数

### Sample Explanation 1

白板に書かれている整数は $ a_1\ =7^2=49,\ a_2=2^2\ \times\ 5^1\ =\ 20,\ a_3\ =\ 5^1\ =\ 5,\ a_4=2^1\ \times\ 7^1\ =\ 14 $ です。 $ a_1 $ を $ 1 $ に書き換えると白板に書かれている整数は $ 1,20,5,14 $ となり、これらの最小公倍数は $ 140 $ です。 $ a_2 $ を $ 1 $ に書き換えると白板に書かれている整数は $ 49,1,5,14 $ となり、これらの最小公倍数は $ 490 $ です。 $ a_3 $ を $ 1 $ に書き換えると白板に書かれている整数は $ 49,20,1,14 $ となり、これらの最小公倍数は $ 980 $ です。 $ a_4 $ を $ 1 $ に書き換えると白板に書かれている整数は $ 49,20,5,1 $ となり、これらの最小公倍数は $ 980 $ です。 以上より、書き換えた後の $ N $ 個の整数の最小公倍数としてあり得る値は $ 140,490,980 $ であり、この入力における答えが $ 3 $ と分かります。

### Sample Explanation 2

白板に書かれている整数はとても大きい場合があります。

## 样例 #1

### 输入

```
4

1

7 2

2

2 2

5 1

1

5 1

2

2 1

7 1
```

### 输出

```
3
```

## 样例 #2

### 输入

```
1

1

998244353 1000000000
```

### 输出

```
1
```



---

---
title: "[ABC260E] At Least One"
layout: "post"
diff: 普及+/提高
pid: AT_abc260_e
tag: []
---

# [ABC260E] At Least One

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc260/tasks/abc260_e

整数 $ M $ および $ N $ 個の整数の組 $ (A_1,\ B_1),\ (A_2,\ B_2),\ \dots,\ (A_N,\ B_N) $ が与えられます。  
 すべての $ i $ について $ 1\ \leq\ A_i\ \lt\ B_i\ \leq\ M $ が成り立っています。

次の条件を満たす数列 $ S $ を**良い数列**と呼びます。

- $ S $ は数列 $ (1,2,3,...,\ M) $ の連続部分列である。
- すべての $ i $ について $ S $ は $ A_i,\ B_i $ の少なくとも一方を含んでいる。

長さ $ k $ の良い数列としてあり得るものの個数を $ f(k) $ とします。  
 $ f(1),\ f(2),\ \dots,\ f(M) $ を列挙してください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ M $ $ A_1 $ $ B_1 $ $ A_2 $ $ B_2 $ $ \vdots $ $ A_N $ $ B_N $

## 输出格式

答えを以下の形式で出力せよ。

> $ f(1) $ $ f(2) $ $ \dots $ $ f(M) $

## 说明/提示

### 制約

- $ 1\ \leq\ N\ \leq\ 2\ \times\ 10^5 $
- $ 2\ \leq\ M\ \leq\ 2\ \times\ 10^5 $
- $ 1\ \leq\ A_i\ \lt\ B_i\ \leq\ M $
- 入力される値はすべて整数

### Sample Explanation 1

良い数列としてあり得るものを列挙すると次のようになります。 - $ (1,2) $ - $ (1,2,3) $ - $ (2,3,4) $ - $ (3,4,5) $ - $ (1,2,3,4) $ - $ (2,3,4,5) $ - $ (1,2,3,4,5) $

## 样例 #1

### 输入

```
3 5

1 3

1 4

2 5
```

### 输出

```
0 1 3 2 1
```

## 样例 #2

### 输入

```
1 2

1 2
```

### 输出

```
2 1
```

## 样例 #3

### 输入

```
5 9

1 5

1 7

5 6

5 8

2 6
```

### 输出

```
0 0 1 2 4 4 3 2 1
```



---

---
title: "[ABC261E] Many Operations"
layout: "post"
diff: 普及+/提高
pid: AT_abc261_e
tag: []
---

# [ABC261E] Many Operations

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc261/tasks/abc261_e

変数 $ X $ と、$ X $ の値を変更する $ N $ 種類の操作があります。操作 $ i $ は整数の組 $ (T_i,A_i) $ で表され、意味は次の通りです。

- $ T_i=1 $ のとき、$ X $ の値を $ X\ {\rm\ and}\ A_i $ に置き換える。
- $ T_i=2 $ のとき、$ X $ の値を $ X\ {\rm\ or}\ A_i $ に置き換える。
- $ T_i=3 $ のとき、$ X $ の値を $ X\ {\rm\ xor}\ A_i $ に置き換える。

変数 $ X $ を値 $ C $ で初期化した状態から、以下の処理を順に実行してください。

- 操作 $ 1 $ を行い、操作後の $ X $ の値を出力する。
- 続けて、操作 $ 1,2 $ を順に行い、操作後の $ X $ の値を出力する。
- 続けて、操作 $ 1,2,3 $ を順に行い、操作後の $ X $ の値を出力する。
- $ \vdots $
- 続けて、操作 $ 1,2,\ldots,N $ を順に行い、操作後の $ X $ の値を出力する。
 
$ {\rm\ and},\ {\rm\ or},\ {\rm\ xor} $ とは 非負整数 $ A,\ B $ の $ {\rm\ and},\ {\rm\ or},\ {\rm\ xor} $ は、以下のように定義されます。 - $ A\ {\rm\ and}\ B $ を二進表記した際の $ 2^k $ ($ k\ \geq\ 0 $) の位の数は、$ A,\ B $ を二進表記した際の $ 2^k $ の位の数のうち両方が $ 1 $ であれば $ 1 $、そうでなければ $ 0 $ である。
- $ A\ {\rm\ or}\ B $ を二進表記した際の $ 2^k $ ($ k\ \geq\ 0 $) の位の数は、$ A,\ B $ を二進表記した際の $ 2^k $ の位の数のうち少なくとも一方が $ 1 $ であれば $ 1 $、そうでなければ $ 0 $ である。
- $ A\ {\rm\ xor}\ B $ を二進表記した際の $ 2^k $ ($ k\ \geq\ 0 $) の位の数は、$ A,\ B $ を二進表記した際の $ 2^k $ の位の数のうちちょうど一方が $ 1 $ であれば $ 1 $、そうでなければ $ 0 $ である。
 
 例えば、$ 3\ {\rm\ and}\ 5\ =\ 1 $、 $ 3\ {\rm\ or}\ 5\ =\ 7 $、 $ 3\ {\rm\ xor}\ 5\ =\ 6 $ となります。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ C $ $ T_1 $ $ A_1 $ $ T_2 $ $ A_2 $ $ \vdots $ $ T_N $ $ A_N $

## 输出格式

問題文中の指示に従って $ N $ 行出力せよ。

## 说明/提示

### 制約

- $ 1\ \leq\ N\ \leq\ 2\times\ 10^5 $
- $ 1\leq\ T_i\ \leq\ 3 $
- $ 0\leq\ A_i\ \lt\ 2^{30} $
- $ 0\leq\ C\ \lt\ 2^{30} $
- 入力に含まれる値は全て整数である

### Sample Explanation 1

最初、$ X $ の値は $ 10 $ です。 - 操作 $ 1 $ を行うと $ X $ の値は $ 9 $ になります。 - 続けて操作 $ 1 $ を行うと $ X $ の値は $ 10 $ になり、さらに操作 $ 2 $ を行うと $ 15 $ になります。 - 続けて操作 $ 1 $ を行うと $ X $ の値は $ 12 $ になり、さらに操作 $ 2 $ を行うと $ 13 $ に、さらに続けて操作 $ 3 $ を行うと $ 12 $ になります。

## 样例 #1

### 输入

```
3 10

3 3

2 5

1 12
```

### 输出

```
9

15

12
```

## 样例 #2

### 输入

```
9 12

1 1

2 2

3 3

1 4

2 5

3 6

1 7

2 8

3 9
```

### 输出

```
0

2

1

0

5

3

3

11

2
```



---

---
title: "[ABC261F] Sorting Color Balls"
layout: "post"
diff: 普及+/提高
pid: AT_abc261_f
tag: []
---

# [ABC261F] Sorting Color Balls

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc261/tasks/abc261_f

$ N $ 個の球が左右一列に並んでいます。 左から $ i $ 番目の球の色は色 $ C_i $ であり、整数 $ X_i $ が書かれています。

高橋君の目標は球を左から右に見た時に書かれている数が非減少になるように球を並べ替えることです。 言い換えれば、高橋君の目標は、任意の $ 1\leq\ i\leq\ N-1 $ について、左から $ i+1 $ 番目の球に書かれている数 が左から $ i $ 番目に書かれている数以上であるようにすることです。

高橋君は目標を達成するために、次の操作を好きなだけ（ $ 0 $ 回でも良い ）繰り返すことができます。

> $ 1\leq\ i\leq\ N-1 $ をみたす整数 $ i $ を選ぶ。  
>  左から $ i $ 番目の球と $ i+1 $ 番目の球の色が異なっているならば、コストを $ 1 $ 支払う。 （色が等しいならばコストを支払う必要は無い。）  
>  左から $ i $ 番目の球と $ i+1 $ 番目の球を入れ替える。

高橋君が目標を達成するために支払う必要のあるコストの最小値を求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ C_1 $ $ C_2 $ $ \ldots $ $ C_N $ $ X_1 $ $ X_2 $ $ \ldots $ $ X_N $

## 输出格式

高橋君が支払う必要のあるコストの最小値を整数で出力せよ。

## 说明/提示

### 制約

- $ 2\ \leq\ N\ \leq\ 3\times\ 10^5 $
- $ 1\leq\ C_i\leq\ N $
- $ 1\leq\ X_i\leq\ N $
- 入力は全て整数

### Sample Explanation 1

球の情報を $ (色,\ 整数) $ で表すとします。 最初の状態は $ (1,3) $, $ (5,2) $, $ (2,1) $, $ (2,2) $, $ (1,1) $ です。 例えば、高橋君は次のように操作を行うことができます。 - 左から $ 1 $ 番目の球 (色 $ 1 $) と $ 2 $ 番目の球 (色 $ 5 $) を入れ替える。 球は左から $ (5,2) $, $ (1,3) $, $ (2,1) $, $ (2,2) $, $ (1,1) $ となる。 - 左から $ 2 $ 番目の球 (色 $ 1 $) と $ 3 $ 番目の球 (色 $ 2 $) を入れ替える。 球は左から $ (5,2) $, $ (2,1) $, $ (1,3) $, $ (2,2) $, $ (1,1) $ となる。 - 左から $ 3 $ 番目の球 (色 $ 1 $) と $ 4 $ 番目の球 (色 $ 2 $) を入れ替える。 球は左から $ (5,2) $, $ (2,1) $, $ (2,2) $, $ (1,3) $, $ (1,1) $ となる。 - 左から $ 4 $ 番目の球 (色 $ 1 $) と $ 5 $ 番目の球 (色 $ 1 $) を入れ替える。 球は左から $ (5,2) $, $ (2,1) $, $ (2,2) $, $ (1,1) $, $ (1,3) $ となる。 - 左から $ 3 $ 番目の球 (色 $ 2 $) と $ 4 $ 番目の球 (色 $ 1 $) を入れ替える。 球は左から $ (5,2) $, $ (2,1) $, $ (1,1) $, $ (2,2) $, $ (1,3) $ となる。 - 左から $ 1 $ 番目の球 (色 $ 5 $) と $ 2 $ 番目の球 (色 $ 2 $) を入れ替える。 球は左から $ (2,1) $, $ (5,2) $, $ (1,1) $, $ (2,2) $, $ (1,3) $ となる。 - 左から $ 2 $ 番目の球 (色 $ 5 $) と $ 3 $ 番目の球 (色 $ 1 $) を入れ替える。 球は左から $ (2,1) $, $ (1,1) $, $ (5,2) $, $ (2,2) $, $ (1,3) $ となる。 最後の操作の後で球に書かれている数は左から順に $ 1,1,2,2,3 $ となっているため、高橋君は目的を達成しています。 $ 1,2,3,5,6,7 $ 回目の操作にコストが $ 1 $ ずつかかるため、 このとき合計でコストは $ 6 $ かかり、このときが最小となります。 $ 4 $ 回目の操作では、入れ替えた球の色がともに色 $ 1 $ であるためコストがかからないことに注意してください。

### Sample Explanation 2

すべての球の色は同じであるため、球の入れ替えにコストがかかることはありません。

### Sample Explanation 3

高橋君は一度も操作を行わずとも、目的を達成できています。

## 样例 #1

### 输入

```
5

1 5 2 2 1

3 2 1 2 1
```

### 输出

```
6
```

## 样例 #2

### 输入

```
3

1 1 1

3 2 1
```

### 输出

```
0
```

## 样例 #3

### 输入

```
3

3 1 2

1 1 2
```

### 输出

```
0
```



---

---
title: "[ABC262E] Red and Blue Graph"
layout: "post"
diff: 普及+/提高
pid: AT_abc262_e
tag: []
---

# [ABC262E] Red and Blue Graph

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc262/tasks/abc262_e

$ N $ 頂点 $ M $ 辺の単純無向グラフが与えられます。頂点は $ 1,\ \dots,\ N $ と番号付けられ、$ i\ \,\ (1\ \leq\ i\ \leq\ M) $ 番目の辺は頂点 $ U_i,\ V_i $ を結んでいます。

それぞれの頂点を赤または青で塗る方法は全部で $ 2^N $ 通りあります。これらのうち、以下の条件を全て満たすものの総数を $ 998244353 $ で割った余りを求めてください。

- 赤く塗られた頂点がちょうど $ K $ 個ある
- 異なる色で塗られた頂点を結ぶ辺の本数は偶数である

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ M $ $ K $ $ U_1 $ $ V_1 $ $ \vdots $ $ U_M $ $ V_M $

## 输出格式

答えを出力せよ。

## 说明/提示

### 制約

- $ 2\ \leq\ N\ \leq\ 2\ \times\ 10^5 $
- $ 1\ \leq\ M\ \leq\ 2\ \times\ 10^5 $
- $ 0\ \leq\ K\ \leq\ N $
- $ 1\ \leq\ U_i\ \lt\ V_i\ \leq\ N\ \,\ (1\ \leq\ i\ \leq\ M) $
- $ (U_i,\ V_i)\ \neq\ (U_j,\ V_j)\ \,\ (i\ \neq\ j) $
- 入力は全て整数

### Sample Explanation 1

以下の $ 2 $ 通りが条件を満たします。 - 頂点 $ 1,\ 2 $ を赤く、頂点 $ 3,\ 4 $ を青く塗る。 - 頂点 $ 3,\ 4 $ を赤く、頂点 $ 1,\ 2 $ を青く塗る。 上記の塗り方について、異なる色で塗られた頂点を結ぶ辺は $ 2 $ 番目の辺と $ 3 $ 番目の辺です。

## 样例 #1

### 输入

```
4 4 2

1 2

1 3

2 3

3 4
```

### 输出

```
2
```

## 样例 #2

### 输入

```
10 10 3

1 2

2 4

1 5

3 6

3 9

4 10

7 8

9 10

5 9

3 4
```

### 输出

```
64
```



---

---
title: "[ABC263E] Sugoroku 3"
layout: "post"
diff: 普及+/提高
pid: AT_abc263_e
tag: []
---

# [ABC263E] Sugoroku 3

## 题目描述

一共有 $N$ 个格子编号 $1$ 到 $N$。有一个人站在 $1$ 号格子。

对于 $\forall i \in [1,N-1]$ 号格子有一个 $A_i + 1$ 面的骰子，写有 $0$ 到 $A_i$ 这些数。如果 ta 掷到了 $k$，他将往前走 $k$ 格，走到 $i+k$ 号方格。

求走到 $N$ 号方格的期望次数。对 $998244353$ 取模。

## 输入格式

第一行一个正整数 $N$，第二行 $N-1$ 个正整数表示 $A_i$。

## 输出格式

如果期望次数为 $\frac{P}{Q}$，输入最小非负整数 $R$ 使得 $R\times Q \equiv P\pmod {998244353}$。

## 说明/提示

$2\leq N\leq 2\times 10^5$

$\forall i \in [1,N-1],1\leq A_i\leq N-i$

## 样例 #1

### 输入

```
3

1 1
```

### 输出

```
4
```

## 样例 #2

### 输入

```
5

3 1 2 1
```

### 输出

```
332748122
```



---

---
title: "[ABC264E] Blackout 2"
layout: "post"
diff: 普及+/提高
pid: AT_abc264_e
tag: []
---

# [ABC264E] Blackout 2

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc264/tasks/abc264_e

ある国には $ N $ 個の都市と $ M $ 個の発電所があります。これらを総称して地点と呼びます。  
 地点には $ 1,2,\dots,N+M $ の番号がつけられており、そのうち都市は地点 $ 1,2,\dots,N $ で発電所は地点 $ N+1,N+2,\dots,N+M $ です。

この国には電線が $ E $ 本あり、電線 $ i $ ( $ 1\ \le\ i\ \le\ E $ ) は地点 $ U_i $ と地点 $ V_i $ を双方向に結びます。  
 また、ある都市に **電気が通っている** とは、ある都市から電線をいくつか辿って少なくともひとつの発電所に辿り着くことができる状態を言います。

今、 $ Q $ 個のイベントが起こります。そのうち $ i $ ( $ 1\ \le\ i\ \le\ Q $ ) 番目のイベントでは電線 $ X_i $ が切れ、その電線を辿ることができなくなります。一度切れた電線は、その後のイベントにおいても切れたままです。

全てのイベントについて、そのイベントが終わった直後に電気が通っている都市の数を求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ M $ $ E $ $ U_1 $ $ V_1 $ $ U_2 $ $ V_2 $ $ \vdots $ $ U_E $ $ V_E $ $ Q $ $ X_1 $ $ X_2 $ $ \vdots $ $ X_Q $

## 输出格式

$ Q $ 行出力せよ。  
 そのうち $ i $ ( $ 1\ \le\ i\ \le\ Q $ ) 行目には $ i $ 番目のイベントが終わった直後に電気が通っている都市の数を出力せよ。

## 说明/提示

### 制約

- 入力は全て整数
- $ 1\ \le\ N,M $
- $ N+M\ \le\ 2\ \times\ 10^5 $
- $ 1\ \le\ Q\ \le\ E\ \le\ 5\ \times\ 10^5 $
- $ 1\ \le\ U_i\ <\ V_i\ \le\ N+M $
- $ i\ \neq\ j $ ならば、 $ U_i\ \neq\ U_j $ または $ V_i\ \neq\ V_j $
- $ 1\ \le\ X_i\ \le\ E $
- $ X_i $ は相異なる

### Sample Explanation 1

はじめ、全ての都市に電気が通っています。 - $ 1 $ 番目のイベントによって地点 $ 5 $ と地点 $ 10 $ を結ぶ電線 $ 3 $ が切れます。 - これにより、都市 $ 5 $ に電気が通らなくなり、電気が通っている都市の数は $ 4 $ となります。 - $ 2 $ 番目のイベントによって地点 $ 2 $ と地点 $ 9 $ を結ぶ電線 $ 5 $ が切れます。 - $ 3 $ 番目のイベントによって地点 $ 3 $ と地点 $ 6 $ を結ぶ電線 $ 8 $ が切れます。 - これにより、都市 $ 2,3 $ に電気が通らなくなり、電気が通っている都市の数は $ 2 $ となります。 - $ 4 $ 番目のイベントによって地点 $ 1 $ と地点 $ 8 $ を結ぶ電線 $ 10 $ が切れます。 - $ 5 $ 番目のイベントによって地点 $ 4 $ と地点 $ 10 $ を結ぶ電線 $ 2 $ が切れます。 - $ 6 $ 番目のイベントによって地点 $ 1 $ と地点 $ 7 $ を結ぶ電線 $ 7 $ が切れます。 - これにより、都市 $ 1 $ に電気が通らなくなり、電気が通っている都市の数は $ 1 $ となります。

## 样例 #1

### 输入

```
5 5 10

2 3

4 10

5 10

6 9

2 9

4 8

1 7

3 6

8 10

1 8

6

3

5

8

10

2

7
```

### 输出

```
4

4

2

2

2

1
```



---

---
title: "[ABC266F] Well-defined Path Queries on a Namori"
layout: "post"
diff: 普及+/提高
pid: AT_abc266_f
tag: []
---

# [ABC266F] Well-defined Path Queries on a Namori

## 题目描述

给定一张有 $N$ 个点、$N$ 条边的简单连通无向图和 $Q$ 次询问，对于每次询问，给定 $x_i,y_i$，表示两点的编号，请你回答第 $x_i$ 个点和第 $y_i$ 个点之间是否**有且仅有**一条简单路径。

+ 什么是简单路径？

如果路径上的各顶点均不重复，则称这样的路径为简单路径。

## 输入格式

第一行包含一个整数 $N$；

接下来 $N$ 行，每行两个整数 $u_i,v_i$，表示第 $i$ 条边连接的两个点；

再接下来一行包含一个整数 $Q$；

## 输出格式

对于每次询问，输出一个字符串 `Yes` 或 `No`，分别表示两点之间是否仅存在一条简单路径，每个询问分别输出一行。

### 样例

见原题面。

### 样例解析

样例 #1 解析：

对于第一次询问，从 $1$ 到 $2$ 有两条简单路径 $(1,2)$、$(1,3,2)$，所以输出 `No`。

对于第二次询问，从 $1$ 到 $4$ 仅有一条路径 $(1,4)$，所以输出 `Yes`。

对于第三次询问，从 $1$ 到 $5$ 有两条简单路径 $(1,2,5)$、$(1,3,2,5)$，所以输出 `No`。

## 说明/提示

对于 $30\%$ 的数据，$N \le 100$，$Q \le \frac{N(N-1)}{2}$；

对于 $100\%$ 的数据，$3 \le N \le 2 \times 10^5$，$1 \le u_i<v_i \le N$，$1 \le Q \le 2 \times 10^5$，$1 \le x_i < y_i \le N$，保证图没有重边或自环，且给定询问均不重复。

翻译 by @CarroT1212

## 样例 #1

### 输入

```
5
1 2
2 3
1 3
1 4
2 5
3
1 2
1 4
1 5
```

### 输出

```
No
Yes
No
```

## 样例 #2

### 输入

```
10
3 5
5 7
4 8
2 9
1 2
7 9
1 6
4 10
2 5
2 10
10
1 8
6 9
8 10
6 8
3 10
3 9
1 10
5 8
1 10
7 8
```

### 输出

```
Yes
No
Yes
Yes
No
No
Yes
No
Yes
No
```



---

---
title: "[ABC267E] Erasing Vertices 2"
layout: "post"
diff: 普及+/提高
pid: AT_abc267_e
tag: []
---

# [ABC267E] Erasing Vertices 2

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc267/tasks/abc267_e

$ N $ 頂点 $ M $ 辺の単純無向グラフ（すなわち、自己辺も多重辺もない無向グラフ）が与えられます。$ i $ 本目の辺は頂点 $ U_i $ と頂点 $ V_i $ を結んでいます。頂点 $ i $ には正整数 $ A_i $ が書かれています。

あなたは、以下の操作を $ N $ 回繰り返します。

- まだ削除されていない頂点 $ x $ を選び、「頂点 $ x $ 」と「頂点 $ x $ を端点に持つ辺全て」を削除する。この操作のコストは、頂点 $ x $ と辺で直接結ばれていて、かつまだ削除されていない頂点に書かれている整数の総和である。

$ N $ 回の操作全体のコストを、$ 1 $ 回ごとの操作におけるコストのうちの最大値として定めます。操作全体のコストとして取り得る値の最小値を求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ M $ $ A_1 $ $ A_2 $ $ \dots $ $ A_N $ $ U_1 $ $ V_1 $ $ U_2 $ $ V_2 $ $ \vdots $ $ U_M $ $ V_M $

## 输出格式

答えを出力せよ。

## 说明/提示

### 制約

- $ 1\ \le\ N\ \le\ 2\ \times\ 10^5 $
- $ 0\ \le\ M\ \le\ 2\ \times\ 10^5 $
- $ 1\ \le\ A_i\ \le\ 10^9 $
- $ 1\ \le\ U_i,V_i\ \le\ N $
- 与えられるグラフは単純。
- 入力は全て整数。

### Sample Explanation 1

以下のように操作を行うことにより、$ N $ 回の操作のコストのうちの最大値を $ 3 $ にすることができます。 - 頂点 $ 3 $ を選ぶ。コストは $ A_1=3 $ である。 - 頂点 $ 1 $ を選ぶ。コストは $ A_2+A_4=3 $ である。 - 頂点 $ 2 $ を選ぶ。コストは $ 0 $ である。 - 頂点 $ 4 $ を選ぶ。コストは $ 0 $ である。 $ N $ 回の操作のコストのうちの最大値を $ 2 $ 以下にすることはできないため、解は $ 3 $ です。

## 样例 #1

### 输入

```
4 3

3 1 4 2

1 2

1 3

4 1
```

### 输出

```
3
```

## 样例 #2

### 输入

```
7 13

464 661 847 514 74 200 188

5 1

7 1

5 7

4 1

4 5

2 4

5 2

1 3

1 6

3 5

1 2

4 6

2 7
```

### 输出

```
1199
```



---

---
title: "[ABC268D] Unique Username"
layout: "post"
diff: 普及+/提高
pid: AT_abc268_d
tag: []
---

# [ABC268D] Unique Username

## 题目描述

高桥君有取名选择困难症，于是他找到你，希望帮他取一个用户名。

具体取名规则是：把给定的 $N$ 个字符串 $S_1，S_2,\ldots,S_N$ 以任意顺序排列，并在每两个字符串中间加 $\ge1$ 个下划线，要求不能与后面给定的 $M$ 个字符串 $T_1，T_2,\ldots,T_M$ 中的任意一个相同。

其中，你给出的字符串的长度 $X$ 应该满足 $3\le X \le 16$ 。如果无法满足条件，输出 $-1$。

## 输入格式

第一行两个整数，分别为 $N$ 和 $M$ ；

后 $N$ 行每行一个字符串 $S_i$ ；

后 $M$ 行每行一个字符串 $T_i$ 。

## 输出格式

一个满足题意的字符串 $X$ 。如果没有满足的，输出一个数 $-1$ 。

## 样例 #1

### 输入

```
1 1

chokudai

chokudai
```

### 输出

```
-1
```

## 样例 #2

### 输入

```
2 2

choku

dai

chokudai

choku_dai
```

### 输出

```
dai_choku
```

## 样例 #3

### 输入

```
2 2

chokudai

atcoder

chokudai_atcoder

atcoder_chokudai
```

### 输出

```
-1
```

## 样例 #4

### 输入

```
4 4

ab

cd

ef

gh

hoge

fuga

____

_ab_cd_ef_gh_
```

### 输出

```
ab__ef___cd_gh
```



---

---
title: "[ABC268F] Best Concatenation"
layout: "post"
diff: 普及+/提高
pid: AT_abc268_f
tag: []
---

# [ABC268F] Best Concatenation

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc268/tasks/abc268_f

`1` から `9` の数字および `X` のみからなる $ N $ 個の文字列 $ S_1,\ S_2,\ \ldots,\ S_N $ が与えられます。

$ (1,\ 2,\ \ldots,\ N) $ を並べ替えた列 $ P\ =\ (P_1,\ P_2,\ \ldots,\ P_N) $ を一つ選び、 文字列 $ T\ =\ S_{P_1}\ +\ S_{P_2}\ +\ \cdots\ +\ S_{P_N} $ を作ります。ここで、$ + $ は文字列の連結を表します。

そして、文字列 $ T\ =\ T_1T_2\ldots\ T_{|T|} $ の「スコア」を計算します（ $ |T| $ は文字列 $ T $ の長さを表します）。  
 $ T $ のスコアは、スコアが $ 0 $ の状態から始め、下記の $ 9 $ 個の手順を行うことで計算されます。

- $ 1\ \leq\ i\ \lt\ j\ \leq\ |T| $ および $ T_i\ = $ `X` かつ $ T_j\ = $ `1` を満たす整数の組 $ (i,\ j) $ の個数だけ、スコアを $ 1 $ 点加算する 。
- $ 1\ \leq\ i\ \lt\ j\ \leq\ |T| $ および $ T_i\ = $ `X` かつ $ T_j\ = $ `2` を満たす整数の組 $ (i,\ j) $ の個数だけ、スコアを $ 2 $ 点加算する。
- $ 1\ \leq\ i\ \lt\ j\ \leq\ |T| $ および $ T_i\ = $ `X` かつ $ T_j\ = $ `3` を満たす整数の組 $ (i,\ j) $ の個数だけ、スコアを $ 3 $ 点加算する。
- $ \cdots $
- $ 1\ \leq\ i\ \lt\ j\ \leq\ |T| $ および $ T_i\ = $ `X` かつ $ T_j\ = $ `9` を満たす整数の組 $ (i,\ j) $ の個数だけ、スコアを $ 9 $ 点加算する。

$ P $ を任意に選ぶときの、$ T $ のスコアとしてあり得る最大値を出力してください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ S_1 $ $ S_2 $ $ \vdots $ $ S_N $

## 输出格式

答えを出力せよ。

## 说明/提示

### 制約

- $ 2\ \leq\ N\ \leq\ 2\ \times\ 10^5 $
- $ N $ は整数
- $ S_i $ は `1` から `9` の数字および `X` のみからなる長さ $ 1 $ 以上の文字列
- $ S_1,\ S_2,\ \ldots,\ S_N $ の長さの総和は $ 2\ \times\ 10^5 $ 以下

### Sample Explanation 1

$ P\ =\ (3,\ 1,\ 2) $ とすると、$ T\ =\ S_3\ +\ S_1\ +\ S_2\ = $ `XXX1X359` です。 このとき、$ T $ のスコアは次の通り計算されます。 - $ 1\ \leq\ i\ \lt\ j\ \leq\ |T| $ および $ T_i\ = $ `X` かつ $ T_j\ = $ `1` を満たす整数の組 $ (i,\ j) $ が $ 3 $ 個あり、 - $ 1\ \leq\ i\ \lt\ j\ \leq\ |T| $ および $ T_i\ = $ `X` かつ $ T_j\ = $ `3` を満たす整数の組 $ (i,\ j) $ が $ 4 $ 個あり、 - $ 1\ \leq\ i\ \lt\ j\ \leq\ |T| $ および $ T_i\ = $ `X` かつ $ T_j\ = $ `5` を満たす整数の組 $ (i,\ j) $ が $ 4 $ 個あり、 - $ 1\ \leq\ i\ \lt\ j\ \leq\ |T| $ および $ T_i\ = $ `X` かつ $ T_j\ = $ `9` を満たす整数の組 $ (i,\ j) $ が $ 4 $ 個あります。 よって、$ T $ のスコアは $ 1\ \times\ 3\ +\ 3\ \times\ 4\ +\ 5\ \times\ 4\ +\ 9\ \times\ 4\ =\ 71 $ であり、これが考えられる最大値です。

## 样例 #1

### 输入

```
3

1X3

59

XXX
```

### 输出

```
71
```

## 样例 #2

### 输入

```
10

X63X395XX

X2XX3X22X

13

3716XXX6

45X

X6XX

9238

281X92

1XX4X4XX6

54X9X711X1
```

### 输出

```
3010
```



---

---
title: "[ABC269F] Numbered Checker"
layout: "post"
diff: 普及+/提高
pid: AT_abc269_f
tag: []
---

# [ABC269F] Numbered Checker

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc269/tasks/abc269_f

$ N $ 行 $ M $ 列のグリッドがあり、上から $ i $ 行目、左から $ j $ 列目のマス $ (i,j) $ には整数 $ (i-1)\ \times\ M\ +\ j $ が書かれています。  
 このグリッドに、以下の操作を施します。

- 全てのマス $ (i,j) $ について、 $ i+j $ が奇数ならそのマスに書かれている数字を $ 0 $ に書き換える。

操作後のグリッドについて、$ Q $ 個の質問に答えてください。  
 $ i $ 個目の質問は以下の通りです:

- 以下の条件を全て満たすマス $ (p,q) $ 全てについて、そこに書かれている整数を全て足し合わせた値を $ 998244353 $ で割った余りを求めよ。
  - $ A_i\ \le\ p\ \le\ B_i $
  - $ C_i\ \le\ q\ \le\ D_i $

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ M $ $ Q $ $ A_1 $ $ B_1 $ $ C_1 $ $ D_1 $ $ A_2 $ $ B_2 $ $ C_2 $ $ D_2 $ $ \vdots $ $ A_Q $ $ B_Q $ $ C_Q $ $ D_Q $

## 输出格式

$ Q $ 行出力せよ。  
 そのうち $ i $ 行目には、 $ i $ 個目の質問に対する答えを整数として出力せよ。

## 说明/提示

### 制約

- 入力は全て整数
- $ 1\ \le\ N,M\ \le\ 10^9 $
- $ 1\ \le\ Q\ \le\ 2\ \times\ 10^5 $
- $ 1\ \le\ A_i\ \le\ B_i\ \le\ N $
- $ 1\ \le\ C_i\ \le\ D_i\ \le\ M $

### Sample Explanation 1

この入力では、グリッドは以下の通りです。 !\[\](https://img.atcoder.jp/abc269/81d92debe7aa949266f3a00cff13b513.png) この入力には $ 6 $ つの質問が含まれます。 - $ 1 $ 個目の質問の答えは $ 0+3+0+6+0+8+0+11+0=28 $ です。 - $ 2 $ 個目の質問の答えは $ 1+0+9+0+17=27 $ です。 - $ 3 $ 個目の質問の答えは $ 17+0+19+0=36 $ です。 - $ 4 $ 個目の質問の答えは $ 14 $ です。 - $ 5 $ 個目の質問の答えは $ 0 $ です。 - $ 6 $ 個目の質問の答えは $ 104 $ です。

### Sample Explanation 2

$ 1 $ 個目の質問について、マス $ (10^9,10^9) $ に書かれている整数は $ 10^{18} $ ですが、それを $ 998244353 $ で割った余りを求めることに注意してください。

## 样例 #1

### 输入

```
5 4

6

1 3 2 4

1 5 1 1

5 5 1 4

4 4 2 2

5 5 4 4

1 5 1 4
```

### 输出

```
28

27

36

14

0

104
```

## 样例 #2

### 输入

```
1000000000 1000000000

3

1000000000 1000000000 1000000000 1000000000

165997482 306594988 719483261 992306147

1 1000000000 1 1000000000
```

### 输出

```
716070898

240994972

536839100
```

## 样例 #3

### 输入

```
999999999 999999999

3

999999999 999999999 999999999 999999999

216499784 840031647 84657913 415448790

1 999999999 1 999999999
```

### 输出

```
712559605

648737448

540261130
```



---

---
title: "[ABC270D] Stones"
layout: "post"
diff: 普及+/提高
pid: AT_abc270_d
tag: []
---

# [ABC270D] Stones

## 题目描述

#### 题目翻译
Takahashi 和 Aoki 在玩一个取石子的游戏。

刚开始，有 $N$ 个石子，还有一个长度为 $K$ 的序列 $A = \{A_1,A_2,\cdots,A_K\}$。

现在，他们要按照以下规则轮流取石子：

* 对于每次操作，他可以选择一个 $i$（$1 \leq i \leq K$），这时他会取走 $A_i$ 块石子。

* 当一个人没法取石子时，游戏结束。

现在，Takahashi 先取石子，Aoki 后取石子。
他们都想尽可能的最大化他们自己取走的石子数量。

若他们都以最优策略取石子，最后 Takahashi 会取走多少块石子？

## 输入格式

第一行两个正整数 $N, K$

第二行有 $K$ 个正整数，其中第 $i$ 个表示 $A_i$

## 输出格式

一行一个正整数，表示若他们都以最优策略取石子，最后 Takahashi 取走的石子数量。

## 说明/提示

对于 $100\%$ 的数据，保证：
* $1 \leq N \leq 10^4$
* $1 \leq K \leq 100$
* $1 = A_1 < A_2 < \cdots < A_K \leq N$

## 样例 #1

### 输入

```
10 2
1 4
```

### 输出

```
5
```

## 样例 #2

### 输入

```
11 4
1 2 3 6
```

### 输出

```
8
```

## 样例 #3

### 输入

```
10000 10
1 2 4 8 16 32 64 128 256 512
```

### 输出

```
5136
```



---

---
title: "[ABC270F] Transportation"
layout: "post"
diff: 普及+/提高
pid: AT_abc270_f
tag: []
---

# [ABC270F] Transportation

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc270/tasks/abc270_f

AtCoder 国には $ N $ 個の島があり、 最初、どの島にも空港・港はなく、どの島の間にも道路はありません。 王である高橋君はこれらの島の間に交通手段を用意することにしました。 具体的には、高橋君は次の操作のうち $ 1 $ つを選んで行うことを好きなだけ繰り返す事ができます。

- $ 1\leq\ i\leq\ N $ をみたす $ i $ を選び、コスト $ X_i $ を払って、島 $ i $ に空港を建設する。
- $ 1\leq\ i\leq\ N $ をみたす $ i $ を選び、コスト $ Y_i $ を払って、島 $ i $ に港を建設する。
- $ 1\leq\ i\leq\ M $ をみたす $ i $ を選び、コスト $ Z_i $ を払って、島 $ A_i $ と島 $ B_i $ の間を双方向に結ぶ道路を建設する。

高橋君の目標は、任意の相異なる $ 2 $ つの島 $ U $, $ V $ について、 島 $ U $ からはじめて次の行動のうち $ 1 $ つを選んで行うことを好きなだけ繰り返す事で、 島 $ V $ に到達することができるようにする事です。

- 島 $ S,T $ の両方に空港がある時、島 $ S $ から島 $ T $ まで移動する。
- 島 $ S,T $ の両方に港がある時、島 $ S $ から島 $ T $ まで移動する。
- 島 $ S,T $ を結ぶ道路が存在する時、島 $ S $ から島 $ T $ まで移動する。

高橋君が目標を達成するのに必要な最小コストを求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ M $ $ X_1 $ $ X_2 $ $ \ldots $ $ X_N $ $ Y_1 $ $ Y_2 $ $ \ldots $ $ Y_N $ $ A_1 $ $ B_1 $ $ Z_1 $ $ A_2 $ $ B_2 $ $ Z_2 $ $ \vdots $ $ A_M $ $ B_M $ $ Z_M $

## 输出格式

高橋君が目標を達成するのに必要な最小コストを出力せよ。

## 说明/提示

### 制約

- $ 2\ \leq\ N\ \leq\ 2\times\ 10^5 $
- $ 1\ \leq\ M\ \leq\ 2\times\ 10^5 $
- $ 1\leq\ X_i\leq\ 10^9 $
- $ 1\leq\ Y_i\leq\ 10^9 $
- $ 1\leq\ A_i\ <\ B_i\leq\ N $
- $ 1\leq\ Z_i\leq\ 10^9 $
- $ i\neq\ j $ ならば $ (A_i,B_i)\neq\ (A_j,B_j) $
- 入力は全て整数

### Sample Explanation 1

高橋君は次のように交通手段を建設します。 - コスト $ X_1=1 $ を払って、島 $ 1 $ に空港を建設する。 - コスト $ X_3=4 $ を払って、島 $ 3 $ に空港を建設する。 - コスト $ Y_2=2 $ を払って、島 $ 2 $ に港を建設する。 - コスト $ Y_4=3 $ を払って、島 $ 4 $ に港を建設する。 - コスト $ Z_2=6 $ を払って、島 $ 1 $ と島 $ 4 $ の間を結ぶ道路を建設する。 このとき、目標は達成されており、かかったコストは $ 16 $ となります。 コスト $ 15 $ 以下で目標を達成する方法はないため、$ 16 $ を出力します。

### Sample Explanation 2

空港・港・道路のうち、一度も建設されないものがあっても構いません。

## 样例 #1

### 输入

```
4 2

1 20 4 7

20 2 20 3

1 3 5

1 4 6
```

### 输出

```
16
```

## 样例 #2

### 输入

```
3 1

1 1 1

10 10 10

1 2 100
```

### 输出

```
3
```

## 样例 #3

### 输入

```
7 8

35 29 36 88 58 15 25

99 7 49 61 67 4 57

2 3 3

2 5 36

2 6 89

1 6 24

5 7 55

1 3 71

3 4 94

5 6 21
```

### 输出

```
160
```



---

---
title: "[ABC271E] Subsequence Path"
layout: "post"
diff: 普及+/提高
pid: AT_abc271_e
tag: []
---

# [ABC271E] Subsequence Path

## 题目描述

某地区有 $N$ 个城镇，编号为 1 到 $N$ ，并且由 $M$ 条公路连接，编号 1 到 $M$ 。

每条公路都是有向的；而且编号为 $i(1 \le i \le M)$ 的道路将带领你从编号 $A_i$ 的城镇到编号为 $B_i$ 的城镇去,它的长度为 $C_i$。

现在给你一个长度为 $K$ 的正整数序列 $E=(E_1,E_2,...,E_K)$ 且 $\forall i \in [1,K],E_i \in [1,M]$ 。我们说一条由一些连通的公路组成的路径为“**好路**”，当且仅当满足以下条件：

+ 这条路径的起点为 1 ，终点为 $N$ 。
+ 按经过顺序组成这条路径的公路的编号组成的序列是 $E$ 的子序列。

**注意**，若序列 $S$ 是长度为 $L$ 的数列 $T$ 的**子序列**，则 $S$ 是数列 $T$ 删除任意 $i\ (i\in [0,L])$ 个元素得到的。

现在你要找到最短的“**好路**”。如果没有，输出 ```-1``` 。

## 输入格式

一切按照以下标准输入：

>$N\ M\ K\newline A_1\ B_1\ C_1\newline\vdots\newline A_M\ B_M\ C_M\newline E_1\ ...\ E_K$

## 输出格式

输出最短的“**好路**”。如果没有，输出 ```-1``` 。

## 说明/提示

- $ 2\ \leq\ N\ \leq\ 2\ \times\ 10^5 $
- $ 1\ \leq\ M,\ K\ \leq\ 2\ \times\ 10^5 $
- $ 1\ \leq\ A_i,\ B_i\ \leq\ N,\ A_i\ \neq\ B_i\ \,\ (1\ \leq\ i\ \leq\ M) $
- $ 1\ \leq\ C_i\ \leq\ 10^9\ \,\ (1\ \leq\ i\ \leq\ M) $
- $ 1\ \leq\ E_i\ \leq\ M\ \,\ (1\ \leq\ i\ \leq\ K) $
+ 所有输入都是整数

#### 样例解释

对于**样例1**，有两条好路：

+ 选择编号为 $4$ 的公路。在这种情况下，“**好路**”的长度是 $5$ 。
+ 依次选择编号为 $1$ 和 $2$ 的公路。在这种情况下，“**好路**”的长度就变为了 $2+2=4$ 。

因此，输出的期望值为 $4$ 。

对于**样例2**，没有“**好路**”，输出 ``` -1 ``` 。

## 样例 #1

### 输入

```
3 4 4

1 2 2

2 3 2

1 3 3

1 3 5

4 2 1 2
```

### 输出

```
4
```

## 样例 #2

### 输入

```
3 2 3

1 2 1

2 3 1

2 1 1
```

### 输出

```
-1
```

## 样例 #3

### 输入

```
4 4 5

3 2 2

1 3 5

2 4 7

3 4 10

2 4 1 4 3
```

### 输出

```
14
```



---

---
title: "[ABC272E] Add and Mex"
layout: "post"
diff: 普及+/提高
pid: AT_abc272_e
tag: []
---

# [ABC272E] Add and Mex

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc272/tasks/abc272_e

長さ $ N $ の整数列 $ A=(A_1,A_2,\ldots,A_N) $ が与えられます。

以下の操作を $ M $ 回行ってください。

- 各 $ i\ (1\leq\ i\ \leq\ N) $ について、 $ A_i $ に $ i $ を加算する。その後 $ A $ に含まれない最小の非負整数を求める。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ M $ $ A_1 $ $ A_2 $ $ \ldots $ $ A_N $

## 输出格式

$ M $ 行出力せよ。

$ i $ $ (1\leq\ i\ \leq\ M) $ 行目には $ i $ 回目の操作後に $ A $ に含まれない最小の非負整数を出力せよ。

## 说明/提示

### 制約

- $ 1\leq\ N,M\ \leq\ 2\times\ 10^5 $
- $ -10^9\leq\ A_i\leq\ 10^9 $
- 入力は全て整数

### Sample Explanation 1

$ 1 $ 回目の操作では、数列 $ A $ は $ (-1\ +\ 1,\ -1\ +2\ ,-6+3)\ =\ (0,1,-3) $ になります。 $ A $ に含まれない最小の非負整数は $ 2 $ です。 $ 2 $ 回目の操作では、数列 $ A $ は $ (0\ +\ 1,\ 1\ +2\ ,-3+3)\ =\ (1,3,0) $ になります。 $ A $ に含まれない最小の非負整数は $ 2 $ です。 $ 3 $ 回目の操作では、数列 $ A $ は $ (1\ +\ 1,\ 3\ +2\ ,0+3)\ =\ (2,5,3) $ になります。 $ A $ に含まれない最小の非負整数は $ 0 $ です。

## 样例 #1

### 输入

```
3 3
-1 -1 -6
```

### 输出

```
2
2
0
```

## 样例 #2

### 输入

```
5 6
-2 -2 -5 -7 -15
```

### 输出

```
1
3
2
0
0
0
```



---

---
title: "[ABC273E] Notebook"
layout: "post"
diff: 普及+/提高
pid: AT_abc273_e
tag: []
---

# [ABC273E] Notebook

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc273/tasks/abc273_e

整数列 $ A $ とノートがあります。ノートには $ 10^9 $ 枚のページがあります。

$ Q $ 個のクエリが与えられます。各クエリは下記の $ 4 $ 種類のいずれかです。

> ADD $ x $ : 整数 $ x $ を $ A $ の末尾に追加する。

> DELETE : $ A $ の末尾の要素を削除する。ただし、$ A $ が空である場合は何もしない。

> SAVE $ y $ : ノートの $ y $ ページ目に書かれている数列を消し、代わりに現在の $ A $ を $ y $ ページ目に書き込む。

> LOAD $ z $ : $ A $ をノートの $ z $ ページ目に書かれている数列で置き換える。

はじめ、$ A $ は空列であり、ノートのすべてのページには空列の情報が書かれています。 その初期状態から、$ Q $ 個のクエリを与えられる順に実行し、各クエリの実行直後における $ A $ の末尾の要素を出力してください。

なお、入出力の量が多くなる場合があるので、高速な方法で入出力を行うことを推奨します。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ Q $ $ \mathrm{query}_1 $ $ \mathrm{query}_2 $ $ \vdots $ $ \mathrm{query}_Q $

## 输出格式

下記の形式にしたがい、$ i\ =\ 1,\ 2,\ \ldots,\ Q $ について、$ i $ 番目までのクエリを実行した直後の $ A $ の末尾の要素 $ X_i $ を（ $ A $ が空の場合は $ X_i\ :=\ -1 $ とする）出力せよ。

> $ X_1 $ $ X_2 $ $ \ldots $ $ X_Q $

## 说明/提示

### 制約

- $ 1\ \leq\ Q\ \leq\ 5\ \times\ 10^5 $
- $ 1\ \leq\ x,\ y,\ z\ \leq\ 10^9 $
- $ Q,\ x,\ y,\ z $ は整数
- 与えられるクエリは問題文中の $ 4 $ 種類のいずれか

### Sample Explanation 1

はじめ、$ A $ は空列、すなわち $ A\ =\ () $ であり、ノートのすべてのページには空列の情報が書かれています。 - $ 1 $ 番目のクエリによって、 $ A $ の末尾に $ 3 $ が追加され、$ A\ =\ (3) $ となります。 - $ 2 $ 番目のクエリによって、ノートの $ 1 $ ページ目に書かれた数列が $ (3) $ になります。$ A $ は変わらず $ A\ =\ (3) $ です。 - $ 3 $ 番目のクエリによって、 $ A $ の末尾に $ 4 $ が追加され、$ A\ =\ (3,\ 4) $ となります。 - $ 4 $ 番目のクエリによって、ノートの $ 2 $ ページ目に書かれた数列が $ (3,\ 4) $ になります。$ A $ は変わらず $ A\ =\ (3,\ 4) $ です。 - $ 5 $ 番目のクエリによって、 $ A $ がノートの $ 1 $ ページ目に書かれた数列 $ (3) $ で置き換えられ、$ A\ =\ (3) $ となります。 - $ 6 $ 番目のクエリによって、 $ A $ の末尾の要素が削除され、$ A\ =\ () $ となります。 - $ 7 $ 番目のクエリでは、$ A $ がすでに空であるので何もしません。$ A $ は変わらず $ A\ =\ () $ です。 - $ 8 $ 番目のクエリによって、 $ A $ がノートの $ 2 $ ページ目に書かれた数列 $ (3,\ 4) $ で置き換えられ、$ A\ =\ (3,\ 4) $ となります。 - $ 9 $ 番目のクエリによって、ノートの $ 1 $ ページ目に書かれた数列が $ (3,\ 4) $ になります。$ A $ は変わらず $ A\ =\ (3,\ 4) $ です。 - $ 10 $ 番目のクエリによって、 $ A $ がノートの $ 3 $ ページ目に書かれた数列 $ () $ で置き換えられ、$ A\ =\ () $ となります。 - $ 11 $ 番目のクエリによって、 $ A $ がノートの $ 1 $ ページ目に書かれた数列 $ (3,\ 4) $ で置き換えられ、$ A\ =\ (3,\ 4) $ となります。

## 样例 #1

### 输入

```
11

ADD 3

SAVE 1

ADD 4

SAVE 2

LOAD 1

DELETE

DELETE

LOAD 2

SAVE 1

LOAD 3

LOAD 1
```

### 输出

```
3 3 4 4 3 -1 -1 4 4 -1 4
```

## 样例 #2

### 输入

```
21

ADD 4

ADD 3

DELETE

ADD 10

LOAD 7

SAVE 5

SAVE 5

ADD 4

ADD 4

ADD 5

SAVE 5

ADD 2

DELETE

ADD 1

SAVE 5

ADD 7

ADD 8

DELETE

ADD 4

DELETE

LOAD 5
```

### 输出

```
4 3 4 10 -1 -1 -1 4 4 5 5 2 5 1 1 7 8 7 4 7 1
```



---

---
title: "[ABC274E] Booster"
layout: "post"
diff: 普及+/提高
pid: AT_abc274_e
tag: []
---

# [ABC274E] Booster

## 题目描述

在平面直角坐标系中，有 $n$ 个城镇和 $m$ 个箱子。

你现在在 $(0,0)$，速度为 $1$，你需要走遍所有城镇后回到 $(0,0)$。

你可以选择走到箱子所处的位置，如果你第一次走到这个箱子，你可以吞下箱子里仅剩的一颗能量球，然后你的速度就翻倍了。

求从 $(0,0)$ 走遍所有城镇后回到 $(0,0)$ 所需的最短时间。

## 输入格式

第一行两个整数 $n,m$，含义如题中所述。

接下来 $n$ 行，第 $i+1$ 行两个整数表示第 $i$ 个城镇的坐标 $(x_i,y_i)$。

接下来 $m$ 行，第 $i+n+1$ 行两个整数表示第 $i$ 个箱子的坐标 $(p_i,q_i)$。

## 输出格式

一行一个小数，表示答案。

## 说明/提示

样例一：路径为 $O-Chest_1-Town_1-Town_2-O$。  
样例二：路径为 $O-Town_1-Town_2-O$。


对于所有数据，$1\leq n\leq 12,0\leq m\leq 5,0\leq |x_i|,|y_i|,|p_i|,|q_i|\leq 10^9$。

Translate by Zek3L.

## 样例 #1

### 输入

```
2 1
1 1
0 1
1 0
```

### 输出

```
2.5000000000
```

## 样例 #2

### 输入

```
2 1
1 1
0 1
100 0
```

### 输出

```
3.4142135624
```

## 样例 #3

### 输入

```
1 2
4 4
1 0
0 1
```

### 输出

```
4.3713203436
```



---

---
title: "[ABC275F] Erase Subarrays"
layout: "post"
diff: 普及+/提高
pid: AT_abc275_f
tag: []
---

# [ABC275F] Erase Subarrays

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc275/tasks/abc275_f

正整数列 $ A=(a_1,a_2,\ldots,a_N) $ が与えられます。  
あなたは次の操作を $ 0 $ 回以上何度でも繰り返せます。

- $ A $ から（空でない）連続する部分列を選び、削除する。

$ x=1,2,\ldots,M $ に対し、次の問題を解いてください。

- $ A $ の要素の総和をちょうど $ x $ にするために必要な操作回数の最小値を求めてください。ただし、どのように操作を行っても $ A $ の要素の総和をちょうど $ x $ にできない場合は代わりに `-1` と出力してください。

なお、$ A $ が空である時、$ A $ の要素の総和は $ 0 $ であるとします。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ M $ $ a_1 $ $ \ldots $ $ a_N $

## 输出格式

$ M $ 行出力せよ。$ i $ 行目には $ x=i $ に対する答えを出力せよ。

## 说明/提示

### 制約

- $ 1\ \leq\ N,M\ \leq\ 3000 $
- $ 1\ \leq\ a_i\ \leq\ 3000 $
- 入力はすべて整数

### Sample Explanation 1

操作回数が最小である操作の例を以下に示します。 - $ x=1 $ について、$ a_2,a_3,a_4 $ に対して操作をすることで $ A $ の要素の総和が $ x $ になります。 - $ x=2 $ について、$ a_3,a_4 $ に対して操作をした後、$ a_1 $ に対して操作をすることで $ A $ の要素の総和が $ x $ になります。 - $ x=3 $ について、$ a_3,a_4 $ に対して操作をすることで $ A $ の要素の総和が $ x $ になります。 - $ x=4 $ について、$ a_1,a_2,a_3 $ に対して操作をすることで $ A $ の要素の総和が $ x $ になります。 - $ x=5 $ について、$ a_2,a_3 $ に対して操作をすることで $ A $ の要素の総和が $ x $ になります。

## 样例 #1

### 输入

```
4 5
1 2 3 4
```

### 输出

```
1
2
1
1
1
```

## 样例 #2

### 输入

```
1 5
3
```

### 输出

```
-1
-1
0
-1
-1
```

## 样例 #3

### 输入

```
12 20
2 5 6 5 2 1 7 9 7 2 5 5
```

### 输出

```
2
1
2
2
1
2
1
2
2
1
2
1
1
1
2
2
1
1
1
1
```



---

---
title: "[ABC276F] Double Chance"
layout: "post"
diff: 普及+/提高
pid: AT_abc276_f
tag: []
---

# [ABC276F] Double Chance

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc276/tasks/abc276_f

カード $ 1 $, カード $ 2 $, $ \ldots $, カード $ N $ の $ N $ 枚のカードがあり、 カード $ i $ $ (1\leq\ i\leq\ N) $ には整数 $ A_i $ が書かれています。

$ K=1,2,\ldots,N $ について、次の問題を解いてください。

> カード $ 1 $, カード $ 2 $, $ \ldots $, カード $ K $ の $ K $ 枚のカードが入っている袋があります。  
> 次の操作を $ 2 $ 回繰り返し、記録された数を順に $ x,y $ とします。
> 
> > 袋から無作為にカードを $ 1 $ 枚取り出し、カードに書かれている数を記録する。その後、カードを **袋の中に戻す** 。
> 
> $ \max(x,y) $ の値の期待値を $ \text{mod}\ 998244353 $ で出力してください（注記参照）。  
> ただし、$ \max(x,y) $ で $ x $ と $ y $ のうち小さくない方の値を表します。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ A_1 $ $ A_2 $ $ \ldots $ $ A_N $

## 输出格式

$ N $ 行出力せよ。 $ i $ 行目 $ (1\leq\ i\leq\ N) $ には、$ K=i $ の時の問題に対する答えを出力せよ。

## 说明/提示

### 注記

求める期待値は必ず有限値かつ有理数となることが証明できます。また、この問題の制約下では、その値を互いに素な $ 2 $ つの整数 $ P $, $ Q $ を用いて $ \frac{P}{Q} $ と表したとき、$ R\ \times\ Q\ \equiv\ P\pmod{998244353} $ かつ $ 0\ \leq\ R\ \lt\ 998244353 $ を満たす整数 $ R $ がただ一つ存在することが証明できます。この $ R $ を出力してください。

### 制約

- $ 1\ \leq\ N\ \leq\ 2\times\ 10^5 $
- $ 1\ \leq\ A_i\ \leq\ 2\times\ 10^5 $
- 入力は全て整数

### Sample Explanation 1

例えば、$ K=2 $ の時の答えは次のようにして求まります。 袋の中にはカード $ 1 $ とカード $ 2 $ が入っており、それぞれには $ A_1=5 $ と $ A_2=7 $ が書かれています。 - $ 1 $ 回目に取り出されたカードがカード $ 1 $ 、$ 2 $ 回目に取り出されたカードもカード $ 1 $ のとき、$ x=y=5 $ であり、$ \max(x,y)=5 $ となります。 - $ 1 $ 回目に取り出されたカードがカード $ 1 $ 、$ 2 $ 回目に取り出されたカードはカード $ 2 $ のとき、$ x=5 $, $ y=7 $ であり、$ \max(x,y)=7 $ となります。 - $ 1 $ 回目に取り出されたカードがカード $ 2 $ 、$ 2 $ 回目に取り出されたカードはカード $ 1 $ のとき、$ x=7 $, $ y=5 $ であり、$ \max(x,y)=7 $ となります。 - $ 1 $ 回目に取り出されたカードがカード $ 2 $ 、$ 2 $ 回目に取り出されたカードもカード $ 2 $ のとき、$ x=y=7 $ であり、$ \max(x,y)=7 $ となります。 これらが等確率で起こるため、期待値は $ \frac{5+7+7+7}{4}=\frac{13}{2} $ となります。 $ 499122183\times\ 2\equiv\ 13\ \pmod{998244353} $ であるため、$ 499122183 $ を出力します。

## 样例 #1

### 输入

```
3
5 7 5
```

### 输出

```
5
499122183
443664163
```

## 样例 #2

### 输入

```
7
22 75 26 45 72 81 47
```

### 输出

```
22
249561150
110916092
873463862
279508479
360477194
529680742
```



---

---
title: "[ABC277E] Crystal Switches"
layout: "post"
diff: 普及+/提高
pid: AT_abc277_e
tag: []
---

# [ABC277E] Crystal Switches

## 题目描述

【题面翻译】

给定一张 $n$ 个点 $m$ 条边的无向图。每条边有一个权值 $w \in \{0, 1\}$。$w = 0$ 表示这条边无法通过，$w = 1$ 则可以通过。

有 $k$ 个点上面有按钮 $s_i$。

你现在位于 $1$ 号点。每次，你可以做两件事情中的一件：

1. 移动。移到相邻的一个点上，注意这条边一定是可以通行的。
2. 按开关。此时，全部路的边权取反。即：$w = 0$ 变成 $1$，$w = 1$ 变成 $0$。

请问你是否能够到达 $n$ 号点。如果可以，求出最少移动次数。

translated by @[liangbowen](https://www.luogu.com.cn/user/367488).

## 输入格式

第一行三个数 $n, m, k$。

接下来 $m$ 行，每行三个数 $u_i, v_i, w_i$表示一条连接 $u_i$ 与 $v_i$ 的边。

最后一行 $k$ 个数，表示按钮的位置。

## 输出格式

如果无法到达，输出 $-1$。否则输出最少移动次数。

## 说明/提示

$2 \le n \le 2 \times 10^5$

$1 \le m \le 2 \times 10^5$

$1 \le k \le n$

保证 $1 \le u_i, v_i \le n$，且 $u_i \ne v_i$。

保证 $1 \le s_1 < s_2 < \cdots < s_k \le n$。

## 样例 #1

### 输入

```
5 5 2

1 3 0

2 3 1

5 4 1

2 1 1

1 4 0

3 4
```

### 输出

```
5
```

## 样例 #2

### 输入

```
4 4 2

4 3 0

1 2 1

1 2 0

2 1 1

2 4
```

### 输出

```
-1
```



---

---
title: "[ABC278F] Shiritori"
layout: "post"
diff: 普及+/提高
pid: AT_abc278_f
tag: []
---

# [ABC278F] Shiritori

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc278/tasks/abc278_f

$ N $ 個の文字列 $ S\ _\ 1,S\ _\ 2,\ldots,S\ _\ N $ が与えられます。 $ S\ _\ i\ (1\leq\ i\leq\ N) $ は英小文字からなる長さ $ 10 $ 以下の空でない文字列で、互いに異なります。

先手太郎君と後手次郎君がしりとりをします。 このしりとりでは、先手太郎君と後手次郎君の手番が交互に訪れます。 はじめの手番は先手太郎君の手番です。 それぞれのプレイヤーは自分の手番において整数 $ i\ (1\leq\ i\leq\ N) $ を $ 1 $ つ選びます。 このとき、$ i $ は次の $ 2 $ つの条件を満たしていなければなりません。

- $ i $ は、しりとりが開始してからこれまでの $ 2 $ 人の手番で選ばれたどの整数とも異なる
- この手番がしりとりの最初の手番であるか、直前に選ばれた整数を $ j $ として、$ S\ _\ j $ の最後の文字と $ S\ _\ i $ の最初の文字が等しい
 
条件を満たす $ i $ を選べなくなったプレイヤーの負けで、負けなかったプレイヤーの勝ちです。

$ 2 $ 人が最適に行動したときに勝つのはどちらかを判定してください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ S_1 $ $ S_2 $ $ \vdots $ $ S_N $

## 输出格式

$ 2 $ 人が最適に行動したとき、先手太郎君が勝つなら `First`、後手次郎君が勝つなら `Second` と出力せよ。

## 说明/提示

### 制約

- $ 1\ \leq\ N\ \leq\ 16 $
- $ N $ は整数
- $ S\ _\ i\ (1\leq\ i\leq\ N) $ は英小文字からなる長さ $ 10 $ 以下の空でない文字列
- $ S\ _\ i\neq\ S\ _\ j\ (1\leq\ i\lt\ j\leq\ N) $
 
### Sample Explanation 1

例えば、ゲームは以下のように進行します。 この進行例では $ 2 $ 人の行動が必ずしも最適とは限らないことに注意してください。 - 先手太郎君が $ i=3 $ を選ぶ。$ S\ _\ i= $`if` である。 - 後手次郎君が $ i=2 $ を選ぶ。$ S\ _\ i= $`float` であり、`if` の最後の文字と `float` の最初の文字は等しい。 - 先手太郎君が $ i=5 $ を選ぶ。$ S\ _\ i= $`takahashi` であり、`float` の最後の文字と `takahashi` の最初の文字は等しい。 - 後手次郎君は $ i\neq2,3,5 $ であって $ S\ _\ i $ の最初の文字が `i` と等しいものを選べないため、負ける。 このとき、先手太郎君が勝ちます。

## 样例 #1

### 输入

```
6

enum

float

if

modint

takahashi

template
```

### 输出

```
First
```

## 样例 #2

### 输入

```
10

catch

chokudai

class

continue

copy

exec

havoc

intrinsic

static

yucatec
```

### 输出

```
Second
```

## 样例 #3

### 输入

```
16

mnofcmzsdx

lgeowlxuqm

ouimgdjxlo

jhwttcycwl

jbcuioqbsj

mdjfikdwix

jhvdpuxfil

peekycgxco

sbvxszools

xuuqebcrzp

jsciwvdqzl

obblxzjhco

ptobhnpfpo

muizaqtpgx

jtgjnbtzcl

sivwidaszs
```

### 输出

```
First
```



---

---
title: "[ABC279E] Cheating Amidakuji"
layout: "post"
diff: 普及+/提高
pid: AT_abc279_e
tag: []
---

# [ABC279E] Cheating Amidakuji

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc279/tasks/abc279_e

<!-- 
$ N $ 本の縦棒と、それらの間を結ぶ $ M $ 本の横棒からなるあみだくじがあります。
各横棒は縦棒と垂直に引かれていて、その高さは相異なります。
縦棒を左から順に $ 1,2,\dots,N $、横棒を上から順に $ 1,2,\dots,M $ としたとき、
横棒 $ i\ (1\ \leq\ i\ \leq\ M) $ は縦棒 $ A_i $ と縦棒 $ A_i+1 $ の間を結んでいます。

縦棒 $ 1 $ の上端からあみだくじを下に辿っていったとき、最終的に到達する縦棒の番号を**スコア**と定義します。

$ i=1,2,\dots,M $ について、以下の質問に答えてください。

- 横棒 $ i $ を消したときのスコアを $ S_i $ と定義する。$ S_i $ を求めよ。

なお、実際には横棒は消さないため、各質問は独立であることに注意してください。

より厳密には、以下の通りです。
-->$ 1 $ 以上 $ N-1 $ 以下の整数からなる長さ $ M $ の数列 $ A=(A_1,A_2,\dots,A_M) $ が与えられます。 $ i=1,2,\dots,M $ について、以下の質問に答えてください。

- 数列 $ B=(B_1,B_2,\dots,B_N) $ がある。最初、各 $ j $ について $ B_j=j $ である。今から、$ k=1,2,\dots,i-1,i+1,\dots,M $ の順に以下の操作を行う （すなわち、$ i $ を除いた $ 1 $ 以上 $ M $ 以下の整数 $ k $ について、昇順に以下の操作を行う）。
  - $ B_{A_k} $ と $ B_{A_k+1} $ の値を入れ替える。
- 全ての操作が終了した段階で、$ B_j=1 $ を満たす $ j $ の値を $ S_i $ と定義する。$ S_i $ を求めよ。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ M $ $ A_1 $ $ A_2 $ $ \dots $ $ A_M $

## 输出格式

$ M $ 行出力せよ。 $ i\ (1\leq\ i\ \leq\ M) $ 行目には、$ S_i $ の値を整数として出力せよ。

## 说明/提示

### 制約

- $ 2\ \leq\ N\ \leq\ 2\times\ 10^5 $
- $ 1\ \leq\ M\ \leq\ 2\times\ 10^5 $
- $ 1\ \leq\ A_i\ \leq\ N-1\ (1\leq\ i\ \leq\ M) $
- 入力は全て整数
 
### Sample Explanation 1

$ i\ =\ 2 $ のとき、操作によって $ B $ は以下のように変化します。 - 最初、$ B\ =\ (1,2,3,4,5) $ - $ k=1 $ として操作を行う。すなわち $ B_1 $ と $ B_2 $ の値を入れ替えて、$ B\ =\ (2,1,3,4,5) $ - $ k=3 $ として操作を行う。すなわち $ B_3 $ と $ B_4 $ の値を入れ替えて、$ B\ =\ (2,1,4,3,5) $ - $ k=4 $ として操作を行う。すなわち $ B_2 $ と $ B_3 $ の値を入れ替えて、$ B\ =\ (2,4,1,3,5) $ 全ての操作が終了した段階で $ B_3=1 $ であるため、$ S_2\ =\ 3 $ です。 同様に、 - $ i=1 $ のとき：$ k=2,3,4 $ の順に操作を行うと $ B=(1,4,3,2,5) $ になるので、$ S_1=1 $ - $ i=3 $ のとき：$ k=1,2,4 $ の順に操作を行うと $ B=(2,1,3,4,5) $ になるので、$ S_3=2 $ - $ i=4 $ のとき：$ k=1,2,3 $ の順に操作を行うと $ B=(2,3,4,1,5) $ になるので、$ S_4=4 $ です。

## 样例 #1

### 输入

```
5 4

1 2 3 2
```

### 输出

```
1

3

2

4
```

## 样例 #2

### 输入

```
3 3

2 2 2
```

### 输出

```
1

1

1
```

## 样例 #3

### 输入

```
10 10

1 1 1 9 4 4 2 1 3 3
```

### 输出

```
2

2

2

3

3

3

1

3

4

4
```



---

---
title: "[ABC279F] BOX"
layout: "post"
diff: 普及+/提高
pid: AT_abc279_f
tag: []
---

# [ABC279F] BOX

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc279/tasks/abc279_f

$ N $ 個の箱 $ 1,2,\dots,N $ と、 $ 10^{100} $ 個のボール $ 1,2,\dots,10^{100} $ があります。 最初、箱 $ i $ にはボール $ i $ のみが入っています。

ここに以下の操作が合計 $ Q $ 回行われるので、処理してください。

操作にはタイプ $ 1,2,3 $ の $ 3 $ 種類があります。

タイプ $ 1 $ : 箱 $ X $ に箱 $ Y $ の中身を全て入れる。 この操作では $ X\ \neq\ Y $ が保証される。

> 1 $ X $ $ Y $

タイプ $ 2 $ : 現在いずれかの箱に入っているボールの数の合計を $ k $ とすると、箱 $ X $ にボール $ k+1 $ を入れる。

> 2 $ X $

タイプ $ 3 $ : ボール $ X $ が入っている箱の番号を答える。

> 3 $ X $

## 输入格式

入力は以下の形式で標準入力から与えられる。  
但し、 $ op_i $ は $ i $ 回目の操作を表す。

> $ N $ $ Q $ $ op_1 $ $ op_2 $ $ \vdots $ $ op_Q $

## 输出格式

各タイプ $ 3 $ の操作に対して、答えを $ 1 $ 行に $ 1 $ つ、整数として出力せよ。

## 说明/提示

### 制約

- 入力は全て整数
- $ 2\ \le\ N\ \le\ 3\ \times\ 10^5 $
- $ 1\ \le\ Q\ \le\ 3\ \times\ 10^5 $
- タイプ $ 1 $ の操作について、 $ 1\ \le\ X,Y\ \le\ N $ かつ $ X\ \neq\ Y $
- タイプ $ 2 $ の操作について、 $ 1\ \le\ X\ \le\ N $
- タイプ $ 3 $ の操作について、その時点でボール $ X $ がいずれかの箱に入っている
- タイプ $ 3 $ の操作が少なくとも $ 1 $ つ与えられる

### Sample Explanation 1

この入力は $ 10 $ 個の操作を含みます。 - $ 1 $ 回目の操作はタイプ $ 3 $ です。ボール $ 5 $ は箱 $ 5 $ に入っています。 - $ 2 $ 回目の操作はタイプ $ 1 $ です。箱 $ 1 $ に箱 $ 4 $ の中身を全て入れます。 - 箱 $ 1 $ の中身はボール $ 1,4 $ 、箱 $ 4 $ の中身は空になります。 - $ 3 $ 回目の操作はタイプ $ 2 $ です。箱 $ 1 $ にボール $ 6 $ を入れます。 - $ 4 $ 回目の操作はタイプ $ 2 $ です。箱 $ 4 $ にボール $ 7 $ を入れます。 - $ 5 $ 回目の操作はタイプ $ 3 $ です。ボール $ 7 $ は箱 $ 4 $ に入っています。 - $ 6 $ 回目の操作はタイプ $ 1 $ です。箱 $ 3 $ に箱 $ 1 $ の中身を全て入れます。 - 箱 $ 3 $ の中身はボール $ 1,3,4,6 $ 、箱 $ 1 $ の中身は空になります。 - $ 7 $ 回目の操作はタイプ $ 3 $ です。ボール $ 4 $ は箱 $ 3 $ に入っています。 - $ 8 $ 回目の操作はタイプ $ 1 $ です。箱 $ 1 $ に箱 $ 4 $ の中身を全て入れます。 - 箱 $ 1 $ の中身はボール $ 7 $ 、箱 $ 4 $ の中身は空になります。 - $ 9 $ 回目の操作はタイプ $ 3 $ です。ボール $ 7 $ は箱 $ 1 $ に入っています。 - $ 10 $ 回目の操作はタイプ $ 3 $ です。ボール $ 6 $ は箱 $ 3 $ に入っています。

## 样例 #1

### 输入

```
5 10
3 5
1 1 4
2 1
2 4
3 7
1 3 1
3 4
1 1 4
3 7
3 6
```

### 输出

```
5
4
3
1
3
```



---

---
title: "[ABC280F] Pay or Receive"
layout: "post"
diff: 普及+/提高
pid: AT_abc280_f
tag: []
---

# [ABC280F] Pay or Receive

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc280/tasks/abc280_f

$ 1,\ldots,N $ の番号がついた $ N $ 個の街と、$ 1,\ldots,M $ の番号がついた $ M $ 本の道路があります。

道路 $ i $ は街 $ A_i $ と $ B_i $ を結んでいます。道路を通行すると、所持している **ポイント** が次の通り増減します。

- 道路 $ i $ を使って、街 $ A_i $ から街 $ B_i $ に移動するときにはポイントが $ C_i $ 増加し、街 $ B_i $ から街 $ A_i $ に移動するときにはポイントが $ C_i $ 減少する。
 
所持しているポイントは負にもなりえます。

次の $ Q $ 個の質問に答えてください。

- 所持しているポイントが $ 0 $ である状態で街 $ X_i $ から移動を始めたとき、街 $ Y_i $ にいる状態で所持しているポイントの最大値を出力せよ。  
   ただし、街 $ X_i $ から街 $ Y_i $ に到達できないときは `nan`、街 $ Y_i $ にいる状態で所持しているポイントをいくらでも増やせるときは `inf` を代わりに出力せよ。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ M $ $ Q $ $ A_1 $ $ B_1 $ $ C_1 $ $ \vdots $ $ A_M $ $ B_M $ $ C_M $ $ X_1 $ $ Y_1 $ $ \vdots $ $ X_Q $ $ Y_Q $

## 输出格式

問題文の指示通りに $ Q $ 行出力せよ。  
 $ i $ 行目には $ i $ 番目の質問に対する答えを出力せよ。

## 说明/提示

### 制約

- $ 2\leq\ N\ \leq\ 10^5 $
- $ 0\leq\ M\ \leq\ 10^5 $
- $ 1\leq\ Q\ \leq\ 10^5 $
- $ 1\leq\ A_i,B_i,X_i,Y_i\ \leq\ N $
- $ 0\leq\ C_i\ \leq\ 10^9 $
- 入力は全て整数である
 
### Sample Explanation 1

$ 1 $ 番目の質問では、道路 $ 5 $ を使って街 $ 5 $ から街 $ 3 $ に移動すると、ポイントを $ -2 $ 所持している状態で街 $ 3 $ にいることができます。 これ以上ポイントを大きくすることはできないので答えは $ -2 $ になります。 $ 2 $ 番目の質問では、「道路 $ 2 $ を使って街 $ 1 $ から街 $ 2 $ に移動し、道路 $ 1 $ を使って街 $ 2 $ から街 $ 1 $ に移動する」 という行動を好きなだけ繰り返したあと、道路 $ 2 $ を使って街 $ 1 $ から街 $ 2 $ に移動することで、 街 $ 2 $ にいる状態で所持しているポイントをいくらでも増やすことができます。 $ 3 $ 番目の質問では、街 $ 3 $ から移動を始めて街 $ 1 $ へ到達することはできません。

### Sample Explanation 2

始点と終点が同じ街である道路や、始点と終点が同じ街である質問が含まれることもあります。

## 样例 #1

### 输入

```
5 5 3

1 2 1

1 2 2

3 4 1

4 5 1

3 5 2

5 3

1 2

3 1
```

### 输出

```
-2

inf

nan
```

## 样例 #2

### 输入

```
2 1 1

1 1 1

1 1
```

### 输出

```
inf
```

## 样例 #3

### 输入

```
9 7 5

3 1 4

1 5 9

2 6 5

3 5 8

9 7 9

3 2 3

8 4 6

2 6

4 3

3 8

3 2

7 9
```

### 输出

```
inf

nan

nan

inf

-9
```



---

---
title: "[ABC281E] Least Elements"
layout: "post"
diff: 普及+/提高
pid: AT_abc281_e
tag: []
---

# [ABC281E] Least Elements

## 题目描述

给定一个序列 $A$，对于每个 $1 \le i \le N - M + 1$，将 $A_i A_{i + 1} \cdots A_{i + M - 1}$ **从小到大**排序后（不影响原序列），求出 $\displaystyle ans_i = \sum\limits_{j=i}^{i+k-1} A_j$。

## 输入格式

> $N, M, K\\ A_1 A_2 \cdots A_N$

## 输出格式

> $\mathrm{ans}_1 \mathrm{ans}_2 \cdots \mathrm{ans}_{N-M+1}$

## 说明/提示

$1 \le K \le M \le N \le 2 \times 10^5$

$1 \le A_i \le 10^9$

## 样例 #1

### 输入

```
6 4 3

3 1 4 1 5 9
```

### 输出

```
5 6 10
```

## 样例 #2

### 输入

```
10 6 3

12 2 17 11 19 8 4 3 6 20
```

### 输出

```
21 14 15 13 13
```



---

---
title: "[ABC285E] Work or Rest"
layout: "post"
diff: 普及+/提高
pid: AT_abc285_e
tag: []
---

# [ABC285E] Work or Rest

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc285/tasks/abc285_e

高橋君が住む世界の一週間は $ N $ 日からなります。  
 一週間は曜日 $ 1,2,\dots,N $ と進んでいき、曜日 $ N $ が終わると次の週の曜日 $ 1 $ が始まります。

ABC 国の国王である高橋君は、各曜日に「平日」「休日」のどちらかを割り当てます。この割り当ては毎週同じでなければなりません。また、少なくとも $ 1 $ つの曜日を「休日」に割り当てなければなりません。

この条件の下で、曜日 $ i $ の生産量は長さ $ N $ の数列 $ A $ を用いて以下のように定義されます。

- 曜日 $ i $ が「休日」である場合は $ 0 $
- 曜日 $ i $ が「平日」のとき、直前の休日が $ x $ 日前、直後の休日が $ y $ 日後である場合は $ A_{\min(x,y)} $
  - 割り当ては毎週繰り返されるため、 直前 / 直後 の「休日」が当日とは別の週に属する可能性があることに注意してください。詳しくはサンプルを参照してください。
 
上手く割り当てを決めたときの一週間当たりの生産量の最大値を答えてください。  
 但し、一週間当たりの生産量とは曜日 $ 1,2,\dots,N $ の生産量の総和を指します。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ A_1 $ $ A_2 $ $ \dots $ $ A_N $

## 输出格式

答えを整数として出力せよ。

## 说明/提示

### 制約

- 入力はすべて整数
- $ 1\ \le\ N\ \le\ 5000 $
- $ 1\ \le\ A_i\ \le\ 10^9 $
 
### Sample Explanation 1

例えば曜日 $ 2,4 $ を「休日」、残りを「平日」に割り当てることで、以下のように一週間当たりの生産量 $ 50 $ を達成できます。 - 曜日 $ 1 $ ... $ x=4,y=1 $ なので、この曜日の生産量は $ A_1\ =\ 10 $ である。 - 曜日 $ 2 $ ... 「休日」であるので、この曜日の生産量は $ 0 $ である。 - 曜日 $ 3 $ ... $ x=1,y=1 $ なので、この曜日の生産量は $ A_1\ =\ 10 $ である。 - 曜日 $ 4 $ ... 「休日」であるので、この曜日の生産量は $ 0 $ である。 - 曜日 $ 5 $ ... $ x=1,y=4 $ なので、この曜日の生産量は $ A_1\ =\ 10 $ である。 - 曜日 $ 6 $ ... $ x=2,y=3 $ なので、この曜日の生産量は $ A_2\ =\ 10 $ である。 - 曜日 $ 7 $ ... $ x=3,y=2 $ なので、この曜日の生産量は $ A_2\ =\ 10 $ である。 一週間当たりの生産量を $ 51 $ 以上にすることはできません。

## 样例 #1

### 输入

```
7

10 10 1 1 1 1 1
```

### 输出

```
50
```

## 样例 #2

### 输入

```
10

200000000 500000000 1000000000 800000000 100000000 80000000 600000 900000000 1 20
```

### 输出

```
5100000000
```

## 样例 #3

### 输入

```
20

38 7719 21238 2437 8855 11797 8365 32285 10450 30612 5853 28100 1142 281 20537 15921 8945 26285 2997 14680
```

### 输出

```
236980
```



---

---
title: "[ABC287Ex] Directed Graph and Query"
layout: "post"
diff: 普及+/提高
pid: AT_abc287_h
tag: []
---

# [ABC287Ex] Directed Graph and Query

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc287/tasks/abc287_h

$ N $ 頂点 $ M $ 辺の有向グラフがあります。頂点には $ 1 $ から $ N $ までの番号が付いており、$ i $ 番目の有向辺は頂点 $ a_i $ から頂点 $ b_i $ へと結ばれています。

また、このグラフ上の経路について、コストを次のように定めます。

- 経路上の頂点(始点・終点を含む)の番号の最大値
 
$ x=1,2,\ldots,Q $ に対して次の問題を解いてください。

- 頂点 $ s_x $ から頂点 $ t_x $ への経路のコストの最小値を求めよ。ただし、そのような経路が一つも存在しない場合は代わりに `-1` と出力せよ。
 
なお、入力の量が多くなる場合があるので、高速な方法で入出力を行うことを推奨します。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ M $ $ a_1 $ $ b_1 $ $ \vdots $ $ a_M $ $ b_M $ $ Q $ $ s_1 $ $ t_1 $ $ \vdots $ $ s_Q $ $ t_Q $

## 输出格式

$ Q $ 行出力せよ。  
 $ i $ 行目には $ x=i $ に対する出力をせよ。

## 说明/提示

### 制約

- $ 2\ \leq\ N\ \leq\ 2000 $
- $ 0\ \leq\ M\ \leq\ N(N-1) $
- $ 1\ \leq\ a_i,b_i\ \leq\ N $
- $ a_i\ \neq\ b_i $
- $ i\ \neq\ j $ ならば $ (a_i,b_i)\ \neq\ (a_j,b_j) $
- $ 1\ \leq\ Q\ \leq\ 10^4 $
- $ 1\ \leq\ s_i,t_i\ \leq\ N $
- $ s_i\ \neq\ t_i $
- 入力はすべて整数
 
### Sample Explanation 1

$ x=1 $ に対しては、$ 1 $ 番目の辺を通って頂点 $ 1 $ から頂点 $ 2 $ へ行く経路のコストが $ 2 $ であり、これが最小です。 $ x=2 $ に対しては、$ 2 $ 番目の辺を通って頂点 $ 2 $ から頂点 $ 3 $ へ、そして $ 3 $ 番目の辺を通って頂点 $ 3 $ から頂点 $ 1 $ へ行く経路のコストが $ 3 $ であり、これが最小です。 $ x=3 $ に対しては、頂点 $ 1 $ から頂点 $ 4 $ への経路が存在しないため `-1` と出力します。

## 样例 #1

### 输入

```
4 4

1 2

2 3

3 1

4 3

3

1 2

2 1

1 4
```

### 输出

```
2

3

-1
```



---

---
title: "[ABC288D] Range Add Query"
layout: "post"
diff: 普及+/提高
pid: AT_abc288_d
tag: []
---

# [ABC288D] Range Add Query

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc288/tasks/abc288_d

長さ $ N $ の整数列 $ A\ =\ (A_1,\ A_2,\ \ldots,\ A_N) $ と正整数 $ K $ が与えられます。

各 $ i\ =\ 1,\ 2,\ \ldots,\ Q $ について、$ A $ の連続部分列 $ (A_{l_i},\ A_{l_i+1},\ \ldots,\ A_{r_i}) $ が**良い数列**かどうかを判定してください。

ここで、長さ $ n $ の数列 $ X\ =\ (X_1,\ X_2,\ \ldots,\ X_n) $ は、下記の操作を好きな回数（ $ 0 $ 回でも良い）だけ行うことによって、$ X $ のすべての要素を $ 0 $ にすることができるとき、かつ、そのときに限り**良い数列**です。

> $ 1\ \leq\ i\ \leq\ n-K+1 $ を満たす整数 $ i $ および、整数 $ c $ （負の数でも良い）を選び、$ K $ 個の要素 $ X_{i},\ X_{i+1},\ \ldots,\ X_{i+K-1} $ のそれぞれに $ c $ を加算する。

なお、すべての $ i\ =\ 1,\ 2,\ \ldots,\ Q $ について、$ r_i\ -\ l_i\ +\ 1\ \geq\ K $ が保証されます。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ K $ $ A_1 $ $ A_2 $ $ \ldots $ $ A_N $ $ Q $ $ l_1 $ $ r_1 $ $ l_2 $ $ r_2 $ $ \vdots $ $ l_Q $ $ r_Q $

## 输出格式

$ Q $ 行出力せよ。 $ i\ =\ 1,\ 2,\ \ldots,\ Q $ について、$ i $ 行目には数列 $ (A_{l_i},\ A_{l_i+1},\ \ldots,\ A_{r_i}) $ が良い数列である場合は `Yes` を、 そうでない場合は `No` を出力せよ。

## 说明/提示

### 制約

- $ 1\ \leq\ N\ \leq\ 2\ \times\ 10^5 $
- $ 1\ \leq\ K\ \leq\ \min\lbrace\ 10,\ N\ \rbrace $
- $ -10^9\ \leq\ A_i\ \leq\ 10^9 $
- $ 1\ \leq\ Q\ \leq\ 2\ \times\ 10^5 $
- $ 1\ \leq\ l_i,\ r_i\ \leq\ N $
- $ r_i-l_i+1\ \geq\ K $
- 入力はすべて整数
 
### Sample Explanation 1

数列 $ X\ \coloneqq\ (A_1,\ A_2,\ A_3,\ A_4,\ A_5,\ A_6)\ =\ (3,\ -1,\ 1,\ -2,\ 2,\ 0) $ は良い数列です。 実際、下記の手順で操作を行うことで、すべての要素を $ 0 $ にすることができます。 - まず、$ i\ =\ 2,\ c\ =\ 4 $ として操作を行う。その結果、$ X\ =\ (3,\ 3,\ 5,\ 2,\ 2,\ 0) $ となる。 - 次に、$ i\ =\ 3,\ c\ =\ -2 $ として操作を行う。その結果、$ X\ =\ (3,\ 3,\ 3,\ 0,\ 0,\ 0) $ となる。 - 最後に、$ i\ =\ 1,\ c\ =\ -3 $ として操作を行う。その結果、$ X\ =\ (0,\ 0,\ 0,\ 0,\ 0,\ 0) $ となる。 よって、$ 1 $ 行目には `Yes` を出力します。 一方、数列 $ (A_2,\ A_3,\ A_4,\ A_5,\ A_6,\ A_7)\ =\ (-1,\ 1,\ -2,\ 2,\ 0,\ 5) $ は、 どのような手順で操作を行ってもすべての要素を $ 0 $ にすることはできないため、良い数列ではありません。 よって、$ 2 $ 行目には `No` を出力します。

## 样例 #1

### 输入

```
7 3

3 -1 1 -2 2 0 5

2

1 6

2 7
```

### 输出

```
Yes

No
```

## 样例 #2

### 输入

```
20 4

-19 -66 -99 16 18 33 32 28 26 11 12 0 -16 4 21 21 37 17 55 -19

5

13 16

4 11

3 12

13 18

4 10
```

### 输出

```
No

Yes

No

Yes

No
```



---

---
title: "[ABC288F] Integer Division"
layout: "post"
diff: 普及+/提高
pid: AT_abc288_f
tag: []
---

# [ABC288F] Integer Division

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc288/tasks/abc288_f

$ 10 $ 進表記で $ N $ 桁の正整数 $ X $ が与えられます。$ X $ の各桁は $ 0 $ ではありません。  
$ \lbrace\ 1,2,\ \ldots,\ N-1\ \rbrace $ の部分集合 $ S $ に対し、$ f(S) $ を以下のように定義します。

> $ X $ を $ 10 $ 進表記したものを長さ $ N $ の文字列とみなし、$ i\ \in\ S $ のとき、またそのときに限り文字列の $ i $ 文字目と $ i\ +\ 1 $ 文字目に区切りを入れることで $ |S|\ +\ 1 $ 個の文字列に分解する。  
> このようにして得られた $ |S|+1 $ 個の文字列を $ 10 $ 進表記された整数とみなし、$ f(S) $ をこれら $ |S|+1 $ 個の整数の積で定める。

$ S $ としてあり得るものは空集合を含めて $ 2^{N-1} $ 通りありますが、これら全てに対する $ f(S) $ の総和を $ 998244353 $ で割った余りを求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ X $

## 输出格式

答えを出力せよ。

## 说明/提示

### 制約

- $ 2\ \leq\ N\ \leq\ 2\ \times\ 10^5 $
- $ X $ は $ 10 $ 進表記で $ N $ 桁で、各桁は $ 0 $ でない
- 入力はすべて整数

### Sample Explanation 1

$ S\ =\ \emptyset $ とすると、$ f(S)\ =\ 234 $ です。 $ S\ =\ \lbrace\ 1\ \rbrace $ とすると、$ f(S)\ =\ 2\ \times\ 34\ =\ 68 $ です。 $ S\ =\ \lbrace\ 2\ \rbrace $ とすると、$ f(S)\ =\ 23\ \times\ 4\ =\ 92 $ です。 $ S\ =\ \lbrace\ 1,\ 2\ \rbrace $ とすると、$ f(S)\ =\ 2\ \times\ 3\ \times\ 4\ =\ 24 $ です。 $ 234\ +\ 68\ +\ 92\ +\ 24\ =\ 418 $ であるため、$ 418 $ を出力します。

## 样例 #1

### 输入

```
3
234
```

### 输出

```
418
```

## 样例 #2

### 输入

```
4
5915
```

### 输出

```
17800
```

## 样例 #3

### 输入

```
9
998244353
```

### 输出

```
258280134
```



---

---
title: "[ABC290E] Make it Palindrome"
layout: "post"
diff: 普及+/提高
pid: AT_abc290_e
tag: []
---

# [ABC290E] Make it Palindrome

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc290/tasks/abc290_e

数列 $ X $ に対し、 $ f(X)\ = $ ( $ X $ を回文にするために変更する必要のある要素の個数の最小値 ) とします。

与えられた長さ $ N $ の数列 $ A $ の全ての **連続** 部分列 $ X $ に対する $ f(X) $ の総和を求めてください。

但し、長さ $ m $ の数列 $ X $ が回文であるとは、全ての $ 1\ \le\ i\ \le\ m $ を満たす整数 $ i $ について、 $ X $ の $ i $ 項目と $ m+1-i $ 項目が等しいことを指します。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ A_1 $ $ A_2 $ $ \dots $ $ A_N $

## 输出格式

答えを整数として出力せよ。

## 说明/提示

### 制約

- 入力は全て整数
- $ 1\ \le\ N\ \le\ 2\ \times\ 10^5 $
- $ 1\ \le\ A_i\ \le\ N $
 
### Sample Explanation 1

\- $ f(5)\ =\ 0 $ - $ f(2)\ =\ 0 $ - $ f(1)\ =\ 0 $ - $ f(2)\ =\ 0 $ - $ f(2)\ =\ 0 $ - $ f(5,2)\ =\ 1 $ - $ f(2,1)\ =\ 1 $ - $ f(1,2)\ =\ 1 $ - $ f(2,2)\ =\ 0 $ - $ f(5,2,1)\ =\ 1 $ - $ f(2,1,2)\ =\ 0 $ - $ f(1,2,2)\ =\ 1 $ - $ f(5,2,1,2)\ =\ 2 $ - $ f(2,1,2,2)\ =\ 1 $ - $ f(5,2,1,2,2)\ =\ 1 $ 以上より、求める答えは $ 9 $ です。

## 样例 #1

### 输入

```
5

5 2 1 2 2
```

### 输出

```
9
```



---

---
title: "[ABC291F] Teleporter and Closed off"
layout: "post"
diff: 普及+/提高
pid: AT_abc291_f
tag: []
---

# [ABC291F] Teleporter and Closed off

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc291/tasks/abc291_f

$ N $ 個の都市があり、都市 $ 1 $, 都市 $ 2 $, $ \ldots $, 都市 $ N $ と番号づけられています。  
いくつかの異なる都市の間は一方通行のテレポーターによって移動できます。 都市 $ i $ $ (1\leq\ i\leq\ N) $ からテレポーターによって直接移動できる都市は `0` と `1` からなる長さ $ M $ の文字列 $ S_i $ によって表されます。具体的には、$ 1\leq\ j\leq\ N $ に対して、

- $ 1\leq\ j-i\leq\ M $ かつ $ S_i $ の $ (j-i) $ 文字目が `1` ならば、都市 $ i $ から都市 $ j $ に直接移動できる。
- そうでない時、都市 $ i $ から都市 $ j $ へは直接移動できない。

$ k=2,3,\ldots,\ N-1 $ に対して次の問題を解いてください。

> テレポータを繰り返し使用することによって、**都市 $ k $ を通らずに**都市 $ 1 $ から 都市 $ N $ へ移動できるか判定し、 できるならばそのために必要なテレポーターの使用回数の最小値を、 できないならば $ -1 $ を出力せよ。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ M $ $ S_1 $ $ S_2 $ $ \vdots $ $ S_N $

## 输出格式

$ N-2 $ 個の整数を空白区切りで一行に出力せよ。 $ i $ $ (1\leq\ i\leq\ N-2) $ 番目には、$ k=i+1 $ に対する問題の答えを出力せよ。

## 说明/提示

### 制約

- $ 3\ \leq\ N\ \leq\ 10^5 $
- $ 1\leq\ M\leq\ 10 $
- $ M\ <\ N $
- $ S_i $ は `0` と `1` のみからなる長さ $ M $ の文字列
- $ i+j\ >\ N $ ならば $ S_i $ の $ j $ 文字目は `0`
- $ N,M $ は整数

### Sample Explanation 1

テレポータによって各都市からはそれぞれ以下の都市へ直接移動する事ができます。 - 都市 $ 1 $ からは都市 $ 2,3 $ へ移動できる。 - 都市 $ 2 $ からは都市 $ 4 $ へ移動できる。 - 都市 $ 3 $ からは都市 $ 4,5 $ へ移動できる。 - 都市 $ 4 $ からは都市 $ 5 $ へ移動できる。 - 都市 $ 5 $ から移動できる都市は存在しない。 よって、都市 $ 1 $ から都市 $ 5 $ へ移動する方法は、 - 経路 $ 1 $ : 都市 $ 1 $ $ \to $ 都市 $ 2 $ $ \to $ 都市 $ 4 $ $ \to $ 都市 $ 5 $ - 経路 $ 2 $ : 都市 $ 1 $ $ \to $ 都市 $ 3 $ $ \to $ 都市 $ 4 $ $ \to $ 都市 $ 5 $ - 経路 $ 3 $ : 都市 $ 1 $ $ \to $ 都市 $ 3 $ $ \to $ 都市 $ 5 $ の $ 3 $ つがあり、 - 都市 $ 2 $ を通らない経路は経路 $ 2 $, 経路 $ 3 $ の $ 2 $つであり、そのうちテレポーターの使用回数が最小となるのは経路 $ 3 $ で、この時 $ 2 $ 回使用する。 - 都市 $ 3 $ を通らない経路は経路 $ 1 $ のみであり、この時テレポーターは $ 3 $ 回使用する。 - 都市 $ 4 $ を通らない経路は経路 $ 3 $ のみであり、この時テレポーターは $ 2 $ 回使用する。 となります。よって、$ 2,3,2 $ をこの順に空白区切りで出力します。

### Sample Explanation 2

都市 $ 1 $ から都市 $ 6 $ へ移動する方法は、都市 $ 1 $ $ \to $ 都市 $ 2 $ $ \to $ 都市 $ 5 $ $ \to $ 都市 $ 6 $ のみであるため、 $ k=2,5 $ の場合には都市 $ k $ を通らずに都市 $ 1 $ から都市 $ 6 $ へ移動する方法は存在せず、 $ k=3,4 $ の場合には上の方法が条件をみたし、テレポーターを $ 3 $ 回使用します。 よって、$ -1,3,3,-1 $ をこの順に空白区切りで出力します。 テレポーターは一方通行であるため、 都市 $ 3 $ から都市 $ 4 $ へはテレポーターによって移動できますが、 都市 $ 4 $ から都市 $ 3 $ へは移動できず、 都市 $ 1 $ $ \to $ 都市 $ 4 $ $ \to $ 都市 $ 3 $ $ \to $ 都市 $ 6 $ のような移動はできない事に注意してください。

## 样例 #1

### 输入

```
5 2
11
01
11
10
00
```

### 输出

```
2 3 2
```

## 样例 #2

### 输入

```
6 3
101
001
101
000
100
000
```

### 输出

```
-1 3 3 -1
```



---

---
title: "[ABC292F] Regular Triangle Inside a Rectangle"
layout: "post"
diff: 普及+/提高
pid: AT_abc292_f
tag: []
---

# [ABC292F] Regular Triangle Inside a Rectangle

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc292/tasks/abc292_f

縦の長さが $ A $、横の長さが $ B $ の長方形の内部に描ける正三角形の一辺の長さの最大値を求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ A $ $ B $

## 输出格式

答えを出力せよ。  
 なお、真の値との絶対誤差または相対誤差が $ 10^{-9} $ 以下であれば正解として扱われる。

## 说明/提示

### 制約

- $ 1\ \leq\ A,B\ \leq\ 1000 $
- $ A,B $ は整数
 
### Sample Explanation 1

下図のように描くのが最適で、一辺の長さが $ \sqrt{6}\ -\ \sqrt{2} $ になります。 ![image](https://img.atcoder.jp/abc292/2cd44ddc3d8241e510a356be9533631f.png) なお、この出力例の値は $ \sqrt{6}-\ \sqrt{2} $ と厳密には一致しませんが、誤差が $ 10^{-9} $ 以下なので正解として扱われます。

## 样例 #1

### 输入

```
1 1
```

### 输出

```
1.03527618041008295791
```



---

---
title: "[ABC293E] Geometric Progression"
layout: "post"
diff: 普及+/提高
pid: AT_abc293_e
tag: []
---

# [ABC293E] Geometric Progression

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc293/tasks/abc293_e

整数 $ A,\ X,\ M $ が与えられます。$ \displaystyle\ \sum_{i\ =\ 0}^{X-1}\ A^i $ を $ M $ で割った余りを求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ A $ $ X $ $ M $

## 输出格式

答えを出力せよ。

## 说明/提示

### 制約

- $ 1\ \leq\ A,\ M\ \leq\ 10^9 $
- $ 1\ \leq\ X\ \leq\ 10^{12} $
- 入力はすべて整数

### Sample Explanation 1

$ 3^0\ +\ 3^1\ +\ 3^2\ +\ 3^3\ =\ 40 $ です。$ 40 $ を $ 7 $ で割った余りは $ 5 $ であるため、$ 5 $ を出力します。

## 样例 #1

### 输入

```
3 4 7
```

### 输出

```
5
```

## 样例 #2

### 输入

```
8 10 9
```

### 输出

```
0
```

## 样例 #3

### 输入

```
1000000000 1000000000000 998244353
```

### 输出

```
919667211
```



---

---
title: "[ABC294F] Sugar Water 2"
layout: "post"
diff: 普及+/提高
pid: AT_abc294_f
tag: []
---

# [ABC294F] Sugar Water 2

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc294/tasks/abc294_f

高橋君は $ N $ 本の砂糖水を、青木君は $ M $ 本の砂糖水を持っています。  
 高橋君の持っている $ i $ 番目の砂糖水は砂糖 $ A_i $ グラムと水 $ B_i $ グラムからなります。  
 青木君の持っている $ i $ 番目の砂糖水は砂糖 $ C_i $ グラムと水 $ D_i $ グラムからなります。  
 2 人の持つ砂糖水をそれぞれ 1 本ずつ選んで混ぜる方法は $ NM $ 通りあります。そのような方法でできる砂糖水の中で、濃度が高い方から $ K $ 番目の砂糖水の濃度が何 $ \% $ であるかを求めてください。  
 ここで、砂糖 $ x $ グラムと水 $ y $ グラムからなる砂糖水の濃度は $ \dfrac{100x}{x+y}\ \% $ です。また、砂糖が溶け残ることは考えないものとします。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ M $ $ K $ $ A_1 $ $ B_1 $ $ A_2 $ $ B_2 $ $ \vdots $ $ A_N $ $ B_N $ $ C_1 $ $ D_1 $ $ C_2 $ $ D_2 $ $ \vdots $ $ C_M $ $ D_M $

## 输出格式

濃度が高い方から $ K $ 番目の砂糖水の濃度をパーセントで出力せよ。  
 なお、真の値との絶対誤差または相対誤差が $ 10^{−9} $ 以下であれば正解として扱われる。

## 说明/提示

### 制約

- $ 1\ \leq\ N,\ M\ \leq\ 5\ \times\ 10^4 $
- $ 1\ \leq\ K\ \leq\ N\ \times\ M $
- $ 1\ \leq\ A_i,\ B_i,\ C_i,\ D_i\ \leq\ 10^5 $
- 入力される値はすべて整数
 
### Sample Explanation 1

以下では高橋君が持っている $ i $ 番目の砂糖水と青木君が持っている $ j $ 番目の砂糖水を混ぜてできる砂糖水を $ (i,\ j) $ と表します。 あり得る砂糖水の混ぜ方とその濃度を列挙すると以下のようになります。 - $ (1,\ 1) $ : $ 100\ \times\ \frac{1\ +\ 1}{(1\ +\ 1)\ +\ (2\ +\ 4)}\ =\ 25\ \% $ - $ (2,\ 1) $ : $ 100\ \times\ \frac{1\ +\ 4}{(4\ +\ 1)\ +\ (1\ +\ 4)}\ =\ 50\ \% $ - $ (3,\ 1) $ : $ 100\ \times\ \frac{1\ +\ 1}{(1\ +\ 1)\ +\ (4\ +\ 4)}\ =\ 20\ \% $ この中で濃度が高い方から $ 1 $ 番目の砂糖水は $ (2,\ 1) $ で、濃度は $ 50\ \% $ です。

## 样例 #1

### 输入

```
3 1 1

1 2

4 1

1 4

1 4
```

### 输出

```
50.000000000000000
```

## 样例 #2

### 输入

```
2 2 2

6 4

10 1

5 8

9 6
```

### 输出

```
62.500000000000000
```

## 样例 #3

### 输入

```
4 5 10

5 4

1 6

7 4

9 8

2 2

5 6

6 7

5 3

8 1
```

### 输出

```
54.166666666666664
```



---

---
title: "[ABC294G] Distance Queries on a Tree"
layout: "post"
diff: 普及+/提高
pid: AT_abc294_g
tag: []
---

# [ABC294G] Distance Queries on a Tree

## 题目描述

给定一颗有 $n$ 个节点的树，带边权，要进行 $Q$ 次操作，操作有两种：

`1 i w`：将第 $i$ 条边的边权改为 $w$。  
`2 u v`：询问 $u,v$ 两点的距离。

## 输入格式

第一行，一个正整数 $n$。  
接下来 $n-1$ 行，每行三个数 $u,v,w$，表示一条树边。  
接下来一个正整数 $Q$。  
接下来 $Q$ 行，每行三个数，描述一个询问，格式如上。

## 输出格式

对于每个 $2$ 操作，输出一行一个数，表示该询问的答案。

## 说明/提示

$1\le n,Q\le 2\times10^5，1\le w_i\le 10^9$

## 样例 #1

### 输入

```
5
1 2 3
1 3 6
1 4 9
4 5 10
4
2 2 3
2 1 5
1 3 1
2 1 5
```

### 输出

```
9
19
11
```

## 样例 #2

### 输入

```
7
1 2 1000000000
2 3 1000000000
3 4 1000000000
4 5 1000000000
5 6 1000000000
6 7 1000000000
3
2 1 6
1 1 294967296
2 1 6
```

### 输出

```
5000000000
4294967296
```

## 样例 #3

### 输入

```
1
1
2 1 1
```

### 输出

```
0
```

## 样例 #4

### 输入

```
8
1 2 105
1 3 103
2 4 105
2 5 100
5 6 101
3 7 106
3 8 100
18
2 2 8
2 3 6
1 4 108
2 3 4
2 3 5
2 5 5
2 3 1
2 4 3
1 1 107
2 3 1
2 7 6
2 3 8
2 1 5
2 7 6
2 4 7
2 1 7
2 5 3
2 8 6
```

### 输出

```
308
409
313
316
0
103
313
103
525
100
215
525
421
209
318
519
```



---

---
title: "[ABC296F] Simultaneous Swap"
layout: "post"
diff: 普及+/提高
pid: AT_abc296_f
tag: []
---

# [ABC296F] Simultaneous Swap

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc296/tasks/abc296_f

長さ $ N $ の数列 $ A=(A_1,A_2,\ldots,A_N) $, $ B=(B_1,B_2,\ldots,B_N) $ が与えられます。

高橋君は次の操作を好きなだけ ($ 0 $ 回でも良い) 繰り返す事ができます。

> $ 1 $ 以上 $ N $ 以下の、どの $ 2 $ つも互いに相異なる $ 3 $ つの整数 $ i,j,k $ を選ぶ。  
>  $ A $ の $ i $ 番目の要素と $ j $ 番目の要素を交換し、$ B $ の $ i $ 番目の要素と $ k $ 番目の要素を交換する。

高橋君がうまく操作を繰り返すことによって、 $ A $ と $ B $ を一致させる事が可能ならば `Yes` を、不可能ならば `No` を出力してください。  
 ただし、$ A $ と $ B $ が一致しているとは、任意の $ 1\leq\ i\leq\ N $ について $ A $ の $ i $ 番目の要素と $ B $ の $ i $ 番目の要素が等しいことを言います。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ A_1 $ $ A_2 $ $ \ldots $ $ A_N $ $ B_1 $ $ B_2 $ $ \ldots $ $ B_N $

## 输出格式

操作を繰り返すことによって、高橋君が $ A $ と $ B $ を一致させる事が可能ならば `Yes` を、不可能ならば `No` を出力せよ。

## 说明/提示

### 制約

- $ 3\ \leq\ N\ \leq\ 2\times\ 10^5 $
- $ 1\leq\ A_i,B_i\leq\ N $
- 入力はすべて整数
 
### Sample Explanation 1

$ (i,j,k)=(1,2,3) $ として $ 1 $ 回操作を行うことで、$ A_1 $ と $ A_2 $、$ B_1 $ と $ B_3 $ がそれぞれ交換され、 $ A,B $ はともに $ (2,1,1) $ となって一致します。よって、`Yes` を出力します。

### Sample Explanation 2

どのように操作を行っても $ A $ と $ B $ を一致させることはできません。よって、`No` を出力します。

## 样例 #1

### 输入

```
3

1 2 1

1 1 2
```

### 输出

```
Yes
```

## 样例 #2

### 输入

```
3

1 2 2

1 1 2
```

### 输出

```
No
```

## 样例 #3

### 输入

```
5

1 2 3 2 1

3 2 2 1 1
```

### 输出

```
Yes
```

## 样例 #4

### 输入

```
8

1 2 3 4 5 6 7 8

7 8 5 6 4 3 1 2
```

### 输出

```
No
```



---

---
title: "[ABC297G] Constrained Nim 2"
layout: "post"
diff: 普及+/提高
pid: AT_abc297_g
tag: []
---

# [ABC297G] Constrained Nim 2

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc297/tasks/abc297_g

$ N $ 個の石の山があり、はじめ $ i $ 番目の山には石が $ A_i $ 個あります。これらの山を使って先手太郎君と後手次郎君でゲームをします。

先手太郎君と後手次郎君は、先手太郎君が先手で交互に以下の操作を行います。

- 石の山を一つ選び、そこから $ L $ 個以上 $ R $ 個以下の石を取り除く。

操作が行えなくなった方が負けで、負けなかった方が勝ちです。両者が勝ちを目指して最適な行動を取るとき、どちらが勝つか判定してください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ L $ $ R $ $ A_1 $ $ A_2 $ $ \ldots $ $ A_N $

## 输出格式

先手太郎君が勝つ場合 `First` を、後手次郎君が勝つ場合 `Second` を出力せよ。

## 说明/提示

### 制約

- $ 1\leq\ N\ \leq\ 2\times\ 10^5 $
- $ 1\leq\ L\ \leq\ R\ \leq\ 10^9 $
- $ 1\leq\ A_i\ \leq\ 10^9 $
- 入力はすべて整数である。

### Sample Explanation 1

先手太郎君が最初に $ 1 $ 番目の山の石を $ 2 $ 個取り除くことで、必ず勝つことができます。

## 样例 #1

### 输入

```
3 1 2
2 3 3
```

### 输出

```
First
```

## 样例 #2

### 输入

```
5 1 1
3 1 4 1 5
```

### 输出

```
Second
```

## 样例 #3

### 输入

```
7 3 14
10 20 30 40 50 60 70
```

### 输出

```
First
```



---

---
title: "[ABC298E] Unfair Sugoroku"
layout: "post"
diff: 普及+/提高
pid: AT_abc298_e
tag: []
---

# [ABC298E] Unfair Sugoroku

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc298/tasks/abc298_e

高橋君と青木君がすごろくをします。  
 高橋君ははじめ地点 $ A $、青木君ははじめ地点 $ B $ にいて、交互にサイコロを振ります。  
 高橋君が振るサイコロは $ 1,\ 2,\ \ldots,\ P $ の出目が一様ランダムに出るサイコロで、青木君が振るサイコロは $ 1,\ 2,\ \ldots,\ Q $ の出目が一様ランダムに出るサイコロです。  
 地点 $ x $ にいるときに自分の振ったサイコロの出目が $ i $ であるとき、地点 $ \min(x\ +\ i,\ N) $ に進みます。  
 地点 $ N $ に先に着いた人をすごろくの勝者とします。  
 高橋君が先にサイコロを振るとき、高橋君が勝つ確率を $ \text{mod\ }998244353 $ で求めてください。

 確率 $ \text{mod\ }998244353 $ とは この問題で求める確率は必ず有理数になることが証明できます。また、この問題の制約下では、求める確率を既約分数 $ \frac{y}{x} $ で表したときに $ x $ が $ 998244353 $ で割り切れないことが保証されます。  
 このとき $ xz\ \equiv\ y\ \pmod\ {998244353} $ を満たすような $ 0 $ 以上 $ 998244352 $ 以下の整数 $ z $ が一意に定まります。この $ z $ を答えてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ A $ $ B $ $ P $ $ Q $

## 输出格式

答えを出力せよ。

## 说明/提示

### 制約

- $ 2\ \leq\ N\ \leq\ 100 $
- $ 1\ \leq\ A,\ B\ <\ N $
- $ 1\ \leq\ P,\ Q\ \leq\ 10 $
- 入力はすべて整数
 
### Sample Explanation 1

高橋君が最初の手番で $ 2 $ あるいは $ 3 $ の出目を出すと、高橋君は地点 $ 4 $ に進んで高橋君が勝利します。 高橋君が最初の手番で $ 1 $ の出目を出すと、高橋君は地点 $ 3 $ に進み、青木君は次の手番で必ず地点 $ 4 $ に進んで青木君が勝利します。 よって、高橋君が勝つ確率は $ \frac{2}{3} $ です。

### Sample Explanation 2

サイコロの出目は常に $ 1 $ です。 このとき高橋君が地点 $ 5 $ に進み、次いで青木君が地点 $ 3 $ に進み、次いで高橋君が地点 $ 6 $ に進むので、高橋君は必ず勝ちます。

## 样例 #1

### 输入

```
4 2 3 3 2
```

### 输出

```
665496236
```

## 样例 #2

### 输入

```
6 4 2 1 1
```

### 输出

```
1
```

## 样例 #3

### 输入

```
100 1 1 10 10
```

### 输出

```
264077814
```



---

---
title: "[ABC298F] Rook Score"
layout: "post"
diff: 普及+/提高
pid: AT_abc298_f
tag: []
---

# [ABC298F] Rook Score

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc298/tasks/abc298_f

縦 $ 10^9 $ マス、横 $ 10^9 $ マスのマス目があります。上から $ i $ 番目、左から $ j $ 番目のマスを $ (i,j) $ と表記します。

$ i=1,2,\ldots,N $ に対し $ (r_i,c_i) $ には正整数 $ x_i $ が、他の $ 10^{18}-N $ 個のマスには $ 0 $ が書かれています。

あなたはあるマス $ (R,C) $ を選び、 $ (R,C) $ と行または列が同じ $ 2\ \times\ 10^9\ -\ 1 $ 個のマスに書かれた整数の総和 $ S $ を求めました。

$ S $ として考えられる最大値を求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ r_1 $ $ c_1 $ $ x_1 $ $ \vdots $ $ r_N $ $ c_N $ $ x_N $

## 输出格式

答えを出力せよ。

## 说明/提示

### 制約

- $ 1\ \leq\ N\ \leq\ 2\ \times\ 10^5 $
- $ 1\ \leq\ r_i,c_i,x_i\ \leq\ 10^9 $
- $ i\ \neq\ j $ ならば $ (r_i,c_i)\ \neq\ (r_j,c_j) $
- 入力はすべて整数

### Sample Explanation 1

$ (R,C) $ として $ (2,2) $ を選ぶと $ S $ が $ 20 $ となります。これが最大値です。

## 样例 #1

### 输入

```
4
1 1 2
1 2 9
2 1 8
3 2 3
```

### 输出

```
20
```

## 样例 #2

### 输入

```
1
1 1000000000 1
```

### 输出

```
1
```

## 样例 #3

### 输入

```
15
158260522 877914575 602436426
24979445 861648772 623690081
433933447 476190629 262703497
211047202 971407775 628894325
731963982 822804784 450968417
430302156 982631932 161735902
880895728 923078537 707723857
189330739 910286918 802329211
404539679 303238506 317063340
492686568 773361868 125660016
650287940 839296263 462224593
492601449 384836991 191890310
576823355 782177068 404011431
818008580 954291757 160449218
155374934 840594328 164163676
```

### 输出

```
1510053068
```



---

---
title: "[ABC300E] Dice Product 3"
layout: "post"
diff: 普及+/提高
pid: AT_abc300_e
tag: []
---

# [ABC300E] Dice Product 3

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc300/tasks/abc300_e

あなたは $ 1 $ 以上 $ 6 $ 以下の整数が等確率で出るサイコロと整数 $ 1 $ を持っています。  
 あなたは持っている整数が $ N $ 未満である間、次の操作を繰り返します。

- サイコロを振り、出た目を $ x $ とする。持っている整数に $ x $ を掛ける。
 
全ての操作を終了した時に、持っている整数が $ N $ に一致する確率を $ \text{mod\ }998244353 $ で求めてください。

   確率 $ \text{mod\ }998244353 $ とは？ 求める確率は必ず有理数となることが証明できます。 またこの問題の制約下では、その値を互いに素な $ 2 $ つの整数 $ P $, $ Q $ を用いて $ \frac{P}{Q} $ と表したとき、$ R\ \times\ Q\ \equiv\ P\pmod{998244353} $ かつ $ 0\ \leq\ R\ \lt\ 998244353 $ を満たす整数 $ R $ がただ一つ存在することが証明できます。この $ R $ を求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $

## 输出格式

全ての操作を終了した時に、持っている整数が $ N $ に一致する確率を $ \text{mod\ }998244353 $ で出力せよ。

## 说明/提示

### 制約

- $ 2\ \leq\ N\ \leq\ 10^{18} $
- $ N $ は整数
 
### Sample Explanation 1

操作が終了するまでの手順としてあり得る一例を挙げると次のようになります。 - はじめ, 持っている整数は $ 1 $ である。 - サイコロを振り, $ 2 $ が出る。持っている整数は $ 1\ \times\ 2\ =\ 2 $ になる。 - サイコロを振り, $ 4 $ が出る。持っている整数は $ 2\ \times\ 4\ =\ 8 $ になる。 - 持っている整数が $ 6 $ 以上になったので操作を終了する。 操作がこのように進んだ場合、操作後に持っている整数は $ 8 $ であり $ N\ =\ 6 $ に一致しません。 操作後に持っている整数が $ 6 $ である確率は $ \frac{7}{25} $ です。 $ 239578645\ \times\ 25\ \equiv\ 7\ \pmod{998244353} $ より、 $ 239578645 $ を出力してください。

### Sample Explanation 2

どのような目が出ても、操作後に持っている整数が $ 7 $ になることはありません。

## 样例 #1

### 输入

```
6
```

### 输出

```
239578645
```

## 样例 #2

### 输入

```
7
```

### 输出

```
0
```

## 样例 #3

### 输入

```
300
```

### 输出

```
183676961
```

## 样例 #4

### 输入

```
979552051200000000
```

### 输出

```
812376310
```



---

---
title: "[ABC300F] More Holidays"
layout: "post"
diff: 普及+/提高
pid: AT_abc300_f
tag: []
---

# [ABC300F] More Holidays

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc300/tasks/abc300_f

`o` と `x` からなる長さ $ N $ の文字列 $ S $ と、整数 $ M,K $ が与えられます。  
$ S $ には少なくとも $ 1 $ つの `x` が含まれることが保証されます。

$ S $ を $ M $ 個連結して得られる長さ $ NM $ の文字列を $ T $ とします。 $ T $ に含まれる `x` のうち丁度 $ K $ 個を選んで `o` に変えることを考えます。  
あなたの目標は、変更後の $ T $ に `o` のみからなるできるだけ長い連続部分文字列が含まれるようにすることです。  
`o` のみからなる連続部分文字列の長さとして達成可能な最大値を求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ M $ $ K $ $ S $

## 输出格式

答えを整数として出力せよ。

## 说明/提示

### 制約

- $ N,M,K $ は整数
- $ 1\ \le\ N\ \le\ 3\ \times\ 10^5 $
- $ 1\ \le\ M\ \le\ 10^9 $
- $ x $ を文字列 $ T $ に含まれる `x` の総数としたとき、 $ 1\ \le\ K\ \le\ x $
- $ S $ は `o` と `x` からなる長さ $ N $ の文字列
- $ S $ には少なくとも $ 1 $ つの `x` が含まれる

### Sample Explanation 1

$ S= $ `ooxxooooox` 、 $ T= $ `ooxxooooox` です。 $ 3 $ 文字目と $ 4 $ 文字目の `x` を `o` に変更することにより、変更後の $ T= $ `ooooooooox` となります。 このとき `o` のみからなる長さ $ 9 $ の連続部分文字列が得られ、これが達成可能な最大値です。

### Sample Explanation 2

$ S= $ `oxxox` 、 $ T= $ `oxxoxoxxoxoxxox` です。 $ 5,7,8,10 $ 文字目の `x` を `o` に変更することにより、変更後の $ T= $ `oxxooooooooxxox` となります。 このとき `o` のみからなる長さ $ 8 $ の連続部分文字列が得られ、これが達成可能な最大値です。

## 样例 #1

### 输入

```
10 1 2
ooxxooooox
```

### 输出

```
9
```

## 样例 #2

### 输入

```
5 3 4
oxxox
```

### 输出

```
8
```

## 样例 #3

### 输入

```
30 1000000000 9982443530
oxoxooxoxoxooxoxooxxxoxxxooxox
```

### 输出

```
19964887064
```



---

---
title: "[ABC302F] Merge Set"
layout: "post"
diff: 普及+/提高
pid: AT_abc302_f
tag: []
---

# [ABC302F] Merge Set

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc302/tasks/abc302_f

黒板に $ 1 $ 以上 $ M $ 以下の整数からなる集合 $ N $ 個 $ S_1,S_2,\dots,S_N $ が書かれています。ここで、$ S_i\ =\ \lbrace\ S_{i,1},S_{i,2},\dots,S_{i,A_i}\ \rbrace $ です。

あなたは、以下の操作を好きな回数（$ 0 $ 回でもよい）行うことが出来ます。

- $ 1 $ 個以上の共通した要素を持つ $ 2 $ 個の集合 $ X,Y $ を選ぶ。$ X,Y $ の $ 2 $ 個を黒板から消し、新たに $ X\cup\ Y $ を黒板に書く。
 
ここで、$ X\cup\ Y $ とは $ X $ か $ Y $ の少なくともどちらかに含まれている要素のみからなる集合を意味します。

$ 1 $ と $ M $ が両方含まれる集合を作ることが出来るか判定してください。出来るならば、必要な操作回数の最小値を求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ M $ $ A_1 $ $ S_{1,1} $ $ S_{1,2} $ $ \dots $ $ S_{1,A_1} $ $ A_2 $ $ S_{2,1} $ $ S_{2,2} $ $ \dots $ $ S_{2,A_2} $ $ \vdots $ $ A_N $ $ S_{N,1} $ $ S_{N,2} $ $ \dots $ $ S_{N,A_N} $

## 输出格式

$ 1 $ と $ M $ が両方含まれる集合を作ることが出来るならば必要な操作回数の最小値を、出来ないならば `-1` を出力せよ。

## 说明/提示

### 制約

- $ 1\ \le\ N\ \le\ 2\ \times\ 10^5 $
- $ 2\ \le\ M\ \le\ 2\ \times\ 10^5 $
- $ 1\ \le\ \sum_{i=1}^{N}\ A_i\ \le\ 5\ \times\ 10^5 $
- $ 1\ \le\ S_{i,j}\ \le\ M(1\ \le\ i\ \le\ N,1\ \le\ j\ \le\ A_i) $
- $ S_{i,j}\ \neq\ S_{i,k}(1\ \le\ j\ <\ k\ \le\ A_i) $
- 入力は全て整数である。
 
### Sample Explanation 1

まず、$ \lbrace\ 1,2\ \rbrace $ と $ \lbrace\ 2,3\ \rbrace $ を選んで消し、$ \lbrace\ 1,2,3\ \rbrace $ を追加します。 そして、$ \lbrace\ 1,2,3\ \rbrace $ と $ \lbrace\ 3,4,5\ \rbrace $ を選んで消し、$ \lbrace\ 1,2,3,4,5\ \rbrace $ を追加します。 すると $ 2 $ 回の操作で $ 1 $ と $ M $ を両方含む集合を作ることが出来ます。$ 1 $ 回の操作では目標を達成できないため、答えは $ 2 $ です。

### Sample Explanation 2

始めから $ S_1 $ が $ 1,M $ を共に含むため、必要な操作回数の最小値は $ 0 $ 回です。

## 样例 #1

### 输入

```
3 5

2

1 2

2

2 3

3

3 4 5
```

### 输出

```
2
```

## 样例 #2

### 输入

```
1 2

2

1 2
```

### 输出

```
0
```

## 样例 #3

### 输入

```
3 5

2

1 3

2

2 4

3

2 4 5
```

### 输出

```
-1
```

## 样例 #4

### 输入

```
4 8

3

1 3 5

2

1 2

3

2 4 7

4

4 6 7 8
```

### 输出

```
2
```



---

---
title: "[ABC302G] Sort from 1 to 4"
layout: "post"
diff: 普及+/提高
pid: AT_abc302_g
tag: []
---

# [ABC302G] Sort from 1 to 4

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc302/tasks/abc302_g

全ての要素が $ 1 $ 以上 $ 4 $ 以下の整数である、長さ $ N $ の数列 $ A=(A_1,A_2,\ldots,A_N) $ が与えられます。

高橋君は次の操作を何回でも ($ 0 $ 回でも良い) 繰り返し行う事ができます。

- $ 1\leq\ i\ <\ j\leq\ N $ をみたす整数の組 $ (i,j) $ を選び、$ A_i $ と $ A_j $ を交換する。
 
数列 $ A $ を広義単調増加にするために必要な操作回数の最小値を求めてください。  
 ただし、数列 $ A $ が広義単調増加であるとは、$ 1\leq\ i\leq\ N-1 $ をみたすすべての整数について $ A_i\leq\ A_{i+1} $ が成り立つことをさします。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ A_1 $ $ A_2 $ $ \ldots $ $ A_N $

## 输出格式

数列 $ A $ を広義単調増加にするために必要な操作回数の最小値を一行に出力せよ。

## 说明/提示

### 制約

- $ 2\ \leq\ N\ \leq\ 2\times\ 10^5 $
- $ 1\leq\ A_i\ \leq\ 4 $
- 入力はすべて整数
 
### Sample Explanation 1

次のようにして $ 3 $ 回の操作で $ A $ を広義単調増加にすることができます。 - $ (i,j)=(2,3) $ を選び、$ A_2 $ と $ A_3 $ を交換する。$ A=(3,1,4,1,2,4) $ となる。 - $ (i,j)=(1,4) $ を選び、$ A_1 $ と $ A_4 $ を交換する。$ A=(1,1,4,3,2,4) $ となる。 - $ (i,j)=(3,5) $ を選び、$ A_3 $ と $ A_5 $ を交換する。$ A=(1,1,2,3,4,4) $ となる。 $ 2 $ 回以下の操作で $ A $ を広義単調増加にすることはできないため、このとき操作回数が最小となります。 よって、$ 3 $ を出力します。

## 样例 #1

### 输入

```
6

3 4 1 1 2 4
```

### 输出

```
3
```

## 样例 #2

### 输入

```
4

2 3 4 1
```

### 输出

```
3
```



---

---
title: "[ABC305F] Dungeon Explore"
layout: "post"
diff: 普及+/提高
pid: AT_abc305_f
tag: []
---

# [ABC305F] Dungeon Explore

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc305/tasks/abc305_f

この問題は **インタラクティブな問題**（あなたが作成したプログラムとジャッジプログラムが標準入出力を介して対話を行う形式の問題）です。

$ N $ 個の頂点と $ M $ 本の辺からなる連結かつ単純な無向グラフがあります。 頂点には $ 1 $ から $ N $ までの整数の番号がついています。

あなたは、はじめ頂点 $ 1 $ にいます。 隣り合う頂点に移動することを最大 $ 2N $ 回まで繰り返して、頂点 $ N $ へ移動してください。

ただし、はじめはグラフの辺をすべて知ることはできず、今いる頂点と隣り合っている頂点の情報を知ることができます。

### Input &amp; Output Format

最初に、グラフの頂点数 $ N $ と辺数 $ M $ を標準入力から受け取ってください。

> $ N $ $ M $

次に、あなたはジャッジに対して問題文中の操作を $ 2N $ 回まで繰り返すことができます。

各操作のはじめには、あなたが現在いる頂点に隣接する頂点が次の形式で標準入力から与えられます。

> $ k $ $ v\ _\ 1 $ $ v\ _\ 2 $ $ \ldots $ $ v\ _\ k $

ここで、$ v\ _\ i\ (1\leq\ i\leq\ k) $ は $ 1 $ 以上 $ N $ 以下の整数で、$ v\ _\ 1\lt\ v\ _\ 2\lt\cdots\lt\ v\ _\ k $ を満たします。

あなたは、$ v\ _\ i\ (1\leq\ i\leq\ k) $ を $ 1 $ つ選んで以下の形式で標準出力へ出力してください。

> $ v\ _\ i $

この操作をすることで、あなたは頂点 $ v\ _\ i $ へ移動します。

移動回数が $ 2N $ 回を上回ったり、不正な出力を行った場合、ジャッジは標準入力に `-1` を送ります。

移動する先の頂点が頂点 $ N $ である場合、ジャッジは標準入力に `OK` を送り、終了します。

`-1` もしくは `OK` を受け取った場合、ただちにあなたのプログラムを終了させてください。

## 说明/提示

### 制約

- $ 2\leq\ N\leq100 $
- $ N-1\leq\ M\leq\dfrac{N(N-1)}2 $
- グラフは連結かつ単純
- 入力はすべて整数
 
### 注意点

- **出力を行うたびに、末尾に改行を入れて標準出力を flush してください。そうしなかった場合、ジャッジ結果が TLE となる可能性があります。**
- **対話の途中で不正な出力を行った、あるいはプログラムが途中で終了した場合のジャッジ結果は不定です。**
- 頂点 $ N $ に到達したらただちにプログラムを終了してください。そうしない場合、ジャッジ結果は不定です。
- **この問題のジャッジはアダプティブです。つまり、制約および以前の出力に矛盾しない範囲でグラフの形が変わる場合があります。**
 
### 入出力例

以下は、$ N=4,M=5 $ の場合の入出力例です。 この入出力では、グラフは以下の図のようになっています。

![](https://cdn.luogu.com.cn/upload/vjudge_pic/AT_abc305_f/c0782babede862d29b96c59cb832ffd123590408.png)

    入力 出力 説明     `4 5`  $ N $ と $ M $ が与えられます。   `2 2 3`  はじめ、あなたは頂点 $ 1 $ にいます。頂点 $ 1 $ に隣接している頂点が与えられます。    `3` 移動する頂点として、頂点 $ v\ _\ 2=3 $ を選びます。    `3 1 2 4`  頂点 $ 3 $ に隣接している頂点が与えられます。    `2` 移動する頂点として、頂点 $ v\ _\ 2=2 $ を選びます。    `3 1 3 4`  頂点 $ 2 $ に隣接している頂点が与えられます。    `4` 移動する頂点として、頂点 $ v\ _\ 3=4 $ を選びます。    `OK`  $ 8(=2\times4) $ 回以内で頂点 $ 4 $ に到達したので、`OK` が渡されます。   `OK` を受け取ったあと、ただちにプログラムを終了することで正解と判定されます。



---

---
title: "[ABC306F] Merge Sets"
layout: "post"
diff: 普及+/提高
pid: AT_abc306_f
tag: []
---

# [ABC306F] Merge Sets

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc306/tasks/abc306_f

$ A\ \cap\ B\ =\ \emptyset $ を満たす $ 2 $ つの整数の集合 $ A,\ B $ に対して、$ f(A,B) $ を以下のように定義します。

- $ A\ \cup\ B $ に含まれる要素を昇順に並べた数列を $ C=(C_1,C_2,\dots,C_{|A|+|B|}) $ とする。
- $ A=\lbrace\ C_{k_1},C_{k_2},\dots,C_{k_{|A|}}\rbrace $ となるような $ k_1,k_2,\dots,k_{|A|} $ をとる。 このとき、$ \displaystyle\ f(A,B)=\sum_{i=1}^{|A|}\ k_i $ とする。
 
例えば、$ A=\lbrace\ 1,3\rbrace,B=\lbrace\ 2,8\rbrace $ のとき、$ C=(1,2,3,8) $ より $ A=\lbrace\ C_1,C_3\rbrace $ なので、$ f(A,B)=1+3=4 $ です。

それぞれが $ M $ 個の要素からなる $ N $ 個の整数の集合 $ S_1,S_2\dots,S_N $ があり、各 $ i\ (1\ \leq\ i\ \leq\ N) $ について $ S_i\ =\ \lbrace\ A_{i,1},A_{i,2},\dots,A_{i,M}\rbrace $ です。 ただし、$ S_i\ \cap\ S_j\ =\ \emptyset\ (i\ \neq\ j) $ が保証されます。

$ \displaystyle\ \sum_{1\leq\ i\ <\ j\ \leq\ N}\ f(S_i,\ S_j) $ を求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ M $ $ A_{1,1} $ $ A_{1,2} $ $ \dots $ $ A_{1,M} $ $ \vdots $ $ A_{N,1} $ $ A_{N,2} $ $ \dots $ $ A_{N,M} $

## 输出格式

答えを整数として出力せよ。

## 说明/提示

### 制約

- $ 1\leq\ N\ \leq\ 10^4 $
- $ 1\leq\ M\ \leq\ 10^2 $
- $ 1\leq\ A_{i,j}\ \leq\ 10^9 $
- $ i_1\ \neq\ i_2 $ または $ j_1\ \neq\ j_2 $ ならば $ A_{i_1,j_1}\ \neq\ A_{i_2,j_2} $
- 入力は全て整数
 
### Sample Explanation 1

$ S_1,S_2 $ はそれぞれ問題文中で例示した $ A,B $ と一致し、$ f(S_1,S_2)=1+3=4 $ です。 $ f(S_1,S_3)=1+2=3,f(S_2,S_3)=1+4=5 $ であるため、$ 4+3+5=12 $ が答えです。

## 样例 #1

### 输入

```
3 2

1 3

2 8

4 6
```

### 输出

```
12
```

## 样例 #2

### 输入

```
1 1

306
```

### 输出

```
0
```

## 样例 #3

### 输入

```
4 4

155374934 164163676 576823355 954291757

797829355 404011431 353195922 138996221

191890310 782177068 818008580 384836991

160449218 545531545 840594328 501899080
```

### 输出

```
102
```



---

---
title: "[ABC309F] Box in Box"
layout: "post"
diff: 普及+/提高
pid: AT_abc309_f
tag: []
---

# [ABC309F] Box in Box

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc309/tasks/abc309_f

$ N $ 個の箱があります。 $ i $ 番目の箱は高さ・幅・奥行きがそれぞれ $ h_i,w_i,d_i $ の直方体の形をしています。

二つの箱であって、必要ならば回転させることで片方の高さ・幅・奥行きがもう片方の高さ・幅・奥行きをそれぞれ上回るようなものが存在するかを判定してください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ h_1 $ $ w_1 $ $ d_1 $ $ \vdots $ $ h_N $ $ w_N $ $ d_N $

## 输出格式

二つの箱であって、必要ならば回転させることで片方の高さ・幅・奥行きがもう片方の高さ・幅・奥行きをそれぞれ上回るようなものが存在するならば `Yes` と、そうでなければ `No` と出力せよ。

## 说明/提示

### 制約

- $ 2\ \leq\ N\ \leq\ 2\ \times\ 10^5 $
- $ 1\ \leq\ h_i,w_i,d_i\ \leq\ 10^9 $
- 入力はすべて整数
 
### Sample Explanation 1

$ 2 $ 番目の箱を回転させて高さと奥行きを入れ替えると、$ 3 $ 番目の箱が高さ・幅・奥行きをそれぞれ上回ります。

## 样例 #1

### 输入

```
3

19 8 22

10 24 12

15 25 11
```

### 输出

```
Yes
```

## 样例 #2

### 输入

```
3

19 8 22

10 25 12

15 24 11
```

### 输出

```
No
```

## 样例 #3

### 输入

```
2

1 1 2

1 2 2
```

### 输出

```
No
```



---

---
title: "[ABC310D] Peaceful Teams"
layout: "post"
diff: 普及+/提高
pid: AT_abc310_d
tag: []
---

# [ABC310D] Peaceful Teams

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc310/tasks/abc310_d

$ N $ 人のスポーツ選手がいます。

$ N $ 人の選手たちには互いに相性の悪い選手のペアが $ M $ 組あり、相性の悪い組のうち $ i\ (1\leq\ i\leq\ M) $ 組目は $ A\ _\ i $ 番目の選手と $ B\ _\ i $ 番目の選手です。

あなたは、選手を $ T $ チームに分けます。 どの選手もちょうど一つのチームに属さなければならず、どのチームにも少なくとも一人の選手が属さなければなりません。 さらに、どの $ i=1,2,\ldots,M $ についても、 $ A\ _\ i $ 番目の選手と $ B\ _\ i $ 番目の選手が同じチームに属していてはいけません。

この条件を満たすチーム分けの方法は何通りあるか求めてください。 ただし、チーム分けの方法が異なるとは、ある二人が存在して、彼らが一方のチーム分けでは同じチームに所属し、もう一方では異なるチームに所属することをいいます。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ T $ $ M $ $ A\ _\ 1 $ $ B\ _\ 1 $ $ A\ _\ 2 $ $ B\ _\ 2 $ $ \vdots $ $ A\ _\ M $ $ B\ _\ M $

## 输出格式

答えを $ 1 $ 行で出力せよ。

## 说明/提示

### 制約

- $ 1\leq\ T\leq\ N\leq10 $
- $ 0\leq\ M\leq\dfrac{N(N-1)}2 $
- $ 1\leq\ A\ _\ i\lt\ B\ _\ i\leq\ N\ (1\leq\ i\leq\ M) $
- $ (A\ _\ i,B\ _\ i)\neq\ (A\ _\ j,B\ _\ j)\ (1\leq\ i\lt\ j\leq\ M) $
- 入力はすべて整数
 
### Sample Explanation 1

次の $ 4 $ 通りのチーム分けが条件を満たします。 !\[\](https://img.atcoder.jp/abc310/b92c2629f68d56350fe18e6d0a8fa060.png) 他に条件を満たすチーム分けは存在しないので、$ 4 $ を出力してください。

### Sample Explanation 2

条件を満たすチーム分けがひとつも存在しないこともあります。

### Sample Explanation 3

相性の悪いペアがひとつも存在しないこともあります。

## 样例 #1

### 输入

```
5 2 2

1 3

3 4
```

### 输出

```
4
```

## 样例 #2

### 输入

```
5 1 2

1 3

3 4
```

### 输出

```
0
```

## 样例 #3

### 输入

```
6 4 0
```

### 输出

```
65
```

## 样例 #4

### 输入

```
10 6 8

5 9

1 4

3 8

1 6

4 10

5 7

5 6

3 7
```

### 输出

```
8001
```



---

---
title: "[ABC310E] NAND repeatedly"
layout: "post"
diff: 普及+/提高
pid: AT_abc310_e
tag: []
---

# [ABC310E] NAND repeatedly

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc310/tasks/abc310_e

`0` と `1` からなる長さ $ N $ の文字列 $ S $ が与えられます。 $ S $ は長さ $ N $ の数列 $ A=(A\ _\ 1,A\ _\ 2,\ldots,A\ _\ N) $ の情報を表しており、$ S $ の $ i $ 文字目 $ (1\leq\ i\leq\ N) $ が `0` のとき $ A\ _\ i=0 $ 、`1` のとき $ A\ _\ i=1 $です。

\\\[\\sum \_ {1\\leq i\\leq j\\leq N}(\\cdots((A \_ i\\barwedge A \_ {i+1})\\barwedge A \_ {i+2})\\barwedge\\cdots\\barwedge A \_ j)\\\]

を求めてください。

より厳密には、次のように定められる $ f(i,j)\ (1\leq\ i\leq\ j\leq\ N) $ に対して $ \displaystyle\sum\ _\ {i=1}\ ^\ {N}\sum\ _\ {j=i}\ ^\ Nf(i,j) $ を求めてください。

\\\[f(i,j)=\\left\\{\\begin{matrix} A \_ i&amp;(i=j)\\\\ f(i,j-1)\\barwedge A \_ j\\quad&amp;(i\\lt j) \\end{matrix}\\right.\\\]

ただし、否定論理積 $ \barwedge $ は次を満たす二項演算子です。

\\\[0\\barwedge0=1,0\\barwedge1=1,1\\barwedge0=1,1\\barwedge1=0\\\]

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ S $

## 输出格式

答えを $ 1 $ 行で出力せよ。

## 说明/提示

### 制約

- $ 1\leq\ N\leq10^6 $
- $ S $ は `0` と `1` からなる長さ $ N $ の文字列
- 入力はすべて整数
 
### Sample Explanation 1

$ 1\leq\ i\leq\ j\leq\ N $ を満たすすべての組 $ (i,j) $ に対して、$ f(i,j) $ の値は以下のようになります。 - $ f(1,1)=0=0 $ - $ f(1,2)=0\barwedge0=1 $ - $ f(1,3)=(0\barwedge0)\barwedge1=0 $ - $ f(1,4)=((0\barwedge0)\barwedge1)\barwedge1=1 $ - $ f(1,5)=(((0\barwedge0)\barwedge1)\barwedge1)\barwedge0=1 $ - $ f(2,2)=0=0 $ - $ f(2,3)=0\barwedge1=1 $ - $ f(2,4)=(0\barwedge1)\barwedge1=0 $ - $ f(2,5)=((0\barwedge1)\barwedge1)\barwedge0=1 $ - $ f(3,3)=1=1 $ - $ f(3,4)=1\barwedge1=0 $ - $ f(3,5)=(1\barwedge1)\barwedge0=1 $ - $ f(4,4)=1=1 $ - $ f(4,5)=1\barwedge0=1 $ - $ f(5,5)=0=0 $ これらの総和は $ 0+1+0+1+1+0+1+0+1+1+0+1+1+1+0=9 $ なので、$ 9 $ を出力してください。 $ \barwedge $ は結合法則を満たさないことに注意してください。 例えば、$ (1\barwedge1)\barwedge0=0\barwedge0=1\neq0=1\barwedge1=1\barwedge(1\barwedge0) $ です。

## 样例 #1

### 输入

```
5

00110
```

### 输出

```
9
```

## 样例 #2

### 输入

```
30

101010000100101011010011000010
```

### 输出

```
326
```



---

---
title: "[ABC322D] Polyomino"
layout: "post"
diff: 普及+/提高
pid: AT_abc322_d
tag: []
---

# [ABC322D] Polyomino

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc322/tasks/abc322_d

いくつかの正方形を辺でつなげてできる、連結な多角形の形をしたパズルのピースのことを **ポリオミノ** と呼びます。

縦 $ 4 $ マス、横 $ 4 $ マスのグリッドと、グリッドに収まる大きさの $ 3 $ 個のポリオミノがあります。  
 $ i $ 番目のポリオミノの形は $ 16 $ 個の文字 $ P_{i,j,k} $ ($ 1\ \leq\ j,\ k\ \leq\ 4 $) によって表されます。$ P_{i,\ j,\ k} $ は何も置かれていないグリッドに $ i $ 番目のポリオミノを置いたときの状態を意味して、$ P_{i,\ j,\ k} $ が `#` の場合は上から $ j $ 行目、左から $ k $ 列目のマスにポリオミノが置かれていることを、`.` の場合は置かれていないことを意味します。(入出力例 $ 1 $ の図も参考にしてください。)

あなたは次の条件を全て満たすように $ 3 $ 個のポリオミノ全てをグリッドに敷き詰めることにしました。

- グリッドの全てのマスはポリオミノで覆われている。
- ポリオミノ同士が重なるように置くことはできない。
- ポリオミノがグリッドからはみ出るように置くことはできない。
- ポリオミノの平行移動と回転は自由に行うことができるが、裏返すことはできない。
 
条件を満たすようにグリッドにポリオミノを敷き詰めることは可能ですか？

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ P_{1,1,1}P_{1,1,2}P_{1,1,3}P_{1,1,4} $ $ P_{1,2,1}P_{1,2,2}P_{1,2,3}P_{1,2,4} $ $ P_{1,3,1}P_{1,3,2}P_{1,3,3}P_{1,3,4} $ $ P_{1,4,1}P_{1,4,2}P_{1,4,3}P_{1,4,4} $ $ P_{2,1,1}P_{2,1,2}P_{2,1,3}P_{2,1,4} $ $ P_{2,2,1}P_{2,2,2}P_{2,2,3}P_{2,2,4} $ $ P_{2,3,1}P_{2,3,2}P_{2,3,3}P_{2,3,4} $ $ P_{2,4,1}P_{2,4,2}P_{2,4,3}P_{2,4,4} $ $ P_{3,1,1}P_{3,1,2}P_{3,1,3}P_{3,1,4} $ $ P_{3,2,1}P_{3,2,2}P_{3,2,3}P_{3,2,4} $ $ P_{3,3,1}P_{3,3,2}P_{3,3,3}P_{3,3,4} $ $ P_{3,4,1}P_{3,4,2}P_{3,4,3}P_{3,4,4} $

## 输出格式

問題文の条件を満たすようにポリオミノを敷き詰めることが可能である場合は `Yes` を、そうでない場合は `No` を出力せよ。

## 说明/提示

### 制約

- $ P_{i,\ j,\ k} $ は `#` または `.`
- 与えられるポリオミノは連結である。つまり、ポリオミノを構成する正方形同士は、正方形のみを上下左右に辿って互いに行き来できる
- 与えられるポリオミノは空でない
 
### Sample Explanation 1

入力例 $ 1 $ に対応するポリオミノの形は次の図のようになります。 !\[image1\](https://img.atcoder.jp/abc322/f0e25c2abcdbeade76fcb12eaee39f23.jpg) この場合、次の図のようにポリオミノを配置することで、問題文の条件を満たすようにグリッドにポリオミノを敷き詰めることができます。 !\[image2\](https://img.atcoder.jp/abc322/81e983f85e958e0d612063adcc455c71.jpg) よって答えは `Yes` になります。

### Sample Explanation 2

入力例 $ 2 $ の $ 1 $ 番目のポリオミノのように、ポリオミノは穴の空いた多角形の形をしている場合があります。

### Sample Explanation 3

ポリオミノを敷き詰めるときに、ポリオミノを裏返してはならないのに注意してください。

## 样例 #1

### 输入

```
....

###.

.#..

....

....

.###

.##.

....

..#.

.##.

.##.

.##.
```

### 输出

```
Yes
```

## 样例 #2

### 输入

```
###.

#.#.

##..

....

....

..#.

....

....

####

##..

#...

#...
```

### 输出

```
Yes
```

## 样例 #3

### 输入

```
##..

#..#

####

....

....

##..

.##.

....

.#..

.#..

.#..

.#..
```

### 输出

```
No
```

## 样例 #4

### 输入

```
....

..#.

....

....

....

..#.

....

....

....

..#.

....

....
```

### 输出

```
No
```

## 样例 #5

### 输入

```
....

####

#...

#...

....

####

...#

..##

....

..##

..#.

..##
```

### 输出

```
No
```

## 样例 #6

### 输入

```
###.

.##.

..#.

.###

....

...#

..##

...#

....

#...

#...

#...
```

### 输出

```
Yes
```



---

---
title: "[ABC322E] Product Development"
layout: "post"
diff: 普及+/提高
pid: AT_abc322_e
tag: []
---

# [ABC322E] Product Development

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc322/tasks/abc322_e

AtCoder 社はある商品の開発をしようとしています。この商品には $ K $ 個のパラメーターがあり、現段階ではすべてのパラメーターの値が $ 0 $ です。AtCoder 社の目標は、パラメーターの値を全て $ P $ 以上にすることです。

ここで、$ N $ 個の開発案があります。$ i(1\ \le\ i\ \le\ N) $ 個目の開発案を実行すると、$ 1\ \le\ j\ \le\ K $ を満たす整数 $ j $ 全てに対して $ j $ 個目のパラメーターが $ A_{i,j} $ 上がりますが、この開発案を実行するにはコストが $ C_i $ かかります。

同じ開発案を $ 2 $ 回以上実行することは出来ません。AtCoder 社が目標を達成出来るか判定し、出来る場合は目標を達成するのに必要なコストの総和の最小値を求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ K $ $ P $ $ C_1 $ $ A_{1,1} $ $ A_{1,2} $ $ \dots $ $ A_{1,K} $ $ C_2 $ $ A_{2,1} $ $ A_{2,2} $ $ \dots $ $ A_{2,K} $ $ \dots $ $ C_N $ $ A_{N,1} $ $ A_{N,2} $ $ \dots $ $ A_{N,K} $

## 输出格式

AtCoder 社が目標を達成出来るならば目標を達成するのに必要なコストの総和の最小値を、出来ないならば `-1` を出力せよ。

## 说明/提示

### 制約

- $ 1\ \le\ N\ \le\ 100 $
- $ 1\ \le\ K,P\ \le\ 5 $
- $ 0\ \le\ A_{i,j}\ \le\ P(1\ \le\ i\ \le\ N,1\ \le\ j\ \le\ K) $
- $ 1\ \le\ C_i\ \le\ 10^9(1\ \le\ i\ \le\ N) $
- 入力は全て整数
 
### Sample Explanation 1

$ 1 $ 個目と $ 3 $ 個目と $ 4 $ 個目の開発案を実行すると、それぞれのパラメーターが $ 3+2+0=5,0+4+1=5,2+0+4=6 $ で全て $ 5 $ 以上となるため目標を達成できます。この場合コストの総和は $ 5\ +\ 3\ +\ 1\ =\ 9 $ となります。 コストの総和 $ 8 $ 以下で目標を達成することは出来ません。よって答えは $ 9 $ です。

### Sample Explanation 2

どのようにしても目標を達成することは出来ません。よって `-1` を出力します。

## 样例 #1

### 输入

```
4 3 5

5 3 0 2

3 1 2 3

3 2 4 0

1 0 1 4
```

### 输出

```
9
```

## 样例 #2

### 输入

```
7 3 5

85 1 0 1

37 1 1 0

38 2 0 0

45 0 2 2

67 1 1 0

12 2 2 0

94 2 2 1
```

### 输出

```
-1
```



---

---
title: "[ABC322F] Vacation Query"
layout: "post"
diff: 普及+/提高
pid: AT_abc322_f
tag: []
---

# [ABC322F] Vacation Query

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc322/tasks/abc322_f

`0`, `1` からなる長さ $ N $ の文字列 $ S $ が与えられます。$ S $ の $ i $ 文字目を $ S_i $ とします。

$ Q $ 個のクエリを与えられた順に処理してください。  
 クエリは $ 3 $ 個の整数の組 $ (c,\ L,\ R) $ で表されて、$ c $ の値によってクエリの種類が異なります。

- $ c=1 $ のとき : $ L\ \leq\ i\ \leq\ R $ を満たす整数 $ i $ について、$ S_i $ が `1` ならば `0` に、`0` ならば `1` に変更する。
- $ c=2 $ のとき : $ S $ の $ L $ 文字目から $ R $ 文字目までを取り出して出来る文字列を $ T $ とする。$ T $ に含まれる連続する `1` の長さの最大値を出力する。

## 输入格式

入力は以下の形式で標準入力から与えられる。ここで $ \mathrm{query}_i $ は $ i $ 番目のクエリを意味する。

> $ N $ $ Q $ $ S $ $ \mathrm{query}_1 $ $ \mathrm{query}_2 $ $ \vdots $ $ \mathrm{query}_Q $

各クエリは次の形式で与えられる。

> $ c $ $ L $ $ R $

## 输出格式

$ c=2 $ であるクエリの個数を $ k $ として、$ k $ 行出力せよ。  
 $ i $ 行目には $ i $ 番目の $ c=2 $ であるクエリに対する答えを出力せよ。

## 说明/提示

### 制約

- $ 1\ \leq\ N\ \leq\ 5\ \times\ 10^5 $
- $ 1\ \leq\ Q\ \leq\ 10^5 $
- $ S $ は長さ $ N $ の `0`, `1` からなる文字列
- $ c\ \in\ \lbrace\ 1,\ 2\ \rbrace $
- $ 1\ \leq\ L\ \leq\ R\ \leq\ N $
- $ N,\ Q,\ c,\ L,\ R $ は全て整数
 
### Sample Explanation 1

クエリを順に処理すると次のようになります。 - はじめ、$ S= $ `1101110` です。 - $ 1 $ 番目のクエリについて、$ T\ = $ `1101110` です。$ T $ に含まれる連続する `1` の中で最も長いものは、$ T $ の $ 4 $ 文字目から $ 6 $ 文字目からなる `111` なので、答えは $ 3 $ になります。 - $ 2 $ 番目のクエリについて、$ T\ = $ `101` です。$ T $ に含まれる連続する `1` の中で最も長いものは、$ T $ の $ 1 $ 文字目あるいは $ 3 $ 文字目の `1` なので、答えは $ 1 $ になります。 - $ 3 $ 番目のクエリについて、操作後の $ S $ は `1110000` です。 - $ 4 $ 番目のクエリについて、$ T\ = $ `00` です。$ T $ に `1` は含まれないので答えは $ 0 $ になります。 - $ 5 $ 番目のクエリについて、操作後の $ S $ は `1111111` です。 - $ 6 $ 番目のクエリについて、$ T\ = $ `1111111` です。$ T $ に含まれる連続する `1` の中で最も長いものは、$ T $ の $ 1 $ 文字目から $ 7 $ 文字目からなる `1111111` なので、答えは $ 7 $ になります。

## 样例 #1

### 输入

```
7 6

1101110

2 1 7

2 2 4

1 3 6

2 5 6

1 4 7

2 1 7
```

### 输出

```
3

1

0

7
```



---

---
title: "[ABC324F] Beautiful Path"
layout: "post"
diff: 普及+/提高
pid: AT_abc324_f
tag: []
---

# [ABC324F] Beautiful Path

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc324/tasks/abc324_f

$ N $ 個の頂点と $ M $ 本の辺からなる有向グラフがあります。各辺には**美しさ**と**コスト**の $ 2 $ つの正整数値が定められています。

$ i\ =\ 1,\ 2,\ \ldots,\ M $ について、$ i $ 番目の辺は頂点 $ u_i $ から頂点 $ v_i $ への有向辺であり、その美しさは $ b_i $ 、コストは $ c_i $ です。 ここで、$ u_i\ \lt\ v_i $ が制約として保証されます。

頂点 $ 1 $ から頂点 $ N $ へのパス $ P $ を $ 1 $ つ選んだときの、下記の値としてあり得る最大値を求めてください。

- $ P $ 上のすべての辺の美しさの総和を、$ P $ 上のすべての辺のコストの総和で割った値
 
ここで、与えられるグラフにおいて頂点 $ 1 $ から頂点 $ N $ へのパスが $ 1 $ 個以上存在することが制約として保証されます。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ M $ $ u_1 $ $ v_1 $ $ b_1 $ $ c_1 $ $ u_2 $ $ v_2 $ $ b_2 $ $ c_2 $ $ \vdots $ $ u_M $ $ v_M $ $ b_M $ $ c_M $

## 输出格式

答えを出力せよ。出力された値と真の値の相対誤差もしくは絶対誤差が $ 10^{-9} $ 以下のとき、正答と判定される。

## 说明/提示

### 制約

- $ 2\ \leq\ N\ \leq\ 2\ \times\ 10^5 $
- $ 1\ \leq\ M\ \leq\ 2\ \times\ 10^5 $
- $ 1\ \leq\ u_i\ \lt\ v_i\ \leq\ N $
- $ 1\ \leq\ b_i,\ c_i\ \leq\ 10^4 $
- 頂点 $ 1 $ から頂点 $ N $ へのパスが存在する
- 入力される値はすべて整数
 
### Sample Explanation 1

パス $ P $ として、 $ 2,\ 6,\ 7 $ 番目の辺をこの順に通り頂点 $ 1\ \rightarrow\ 3\ \rightarrow\ 4\ \rightarrow\ 5 $ とたどるバスを選んだとき、「 $ P $ 上のすべての辺の美しさの総和を $ P $ 上のすべての辺のコストの総和で割った値」 は、 $ (b_2\ +\ b_6\ +\ b_7)\ /\ (c_2\ +\ c_6\ +\ c_7)\ =\ (9\ +\ 4\ +\ 2)\ /\ (5\ +\ 8\ +\ 7)\ =\ 15\ /\ 20\ =\ 0.75 $ であり、これがあり得る最大値です。

## 样例 #1

### 输入

```
5 7

1 2 3 6

1 3 9 5

2 3 1 5

2 4 5 3

2 5 1 9

3 4 4 8

4 5 2 7
```

### 输出

```
0.7500000000000000
```

## 样例 #2

### 输入

```
3 3

1 3 1 1

1 3 2 1

1 3 3 1
```

### 输出

```
3.0000000000000000
```

## 样例 #3

### 输入

```
10 20

3 4 1 2

7 9 4 5

2 4 4 5

4 5 1 4

6 9 4 1

9 10 3 2

6 10 5 5

5 6 1 2

5 6 5 2

2 3 2 3

6 10 4 4

4 6 3 4

4 8 4 1

3 5 3 2

2 4 3 2

3 5 4 2

1 5 3 4

1 2 4 2

3 7 2 2

7 8 1 3
```

### 输出

```
1.8333333333333333
```



---

---
title: "[ABC326E] Revenge of "The Salary of AtCoder Inc.""
layout: "post"
diff: 普及+/提高
pid: AT_abc326_e
tag: []
---

# [ABC326E] Revenge of "The Salary of AtCoder Inc."

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc326/tasks/abc326_e

AtCoder社の社員である青木さんの今月の給料は、整数 $ N $ と長さ $ N $ の数列 $ A $ を用いて以下のように決められます。  
 まず、青木さんに $ 1 $ から $ N $ までの整数が等確率で出る $ N $ 面ダイスと変数 $ x=0 $ を渡します。

その後、以下の手順を終了まで繰り返します。

- ダイスを $ 1 $ 度振り、出た目を $ y $ とする。
  - もし $ x\ <\ y $ なら $ A_y $ 円支給し、 $ x=y $ と更新する。
  - そうでないなら終了する。
 
青木さんの今月の給料は、この手順によって支給された金額の合計です。  
 青木さんの今月の給料の期待値を $ {}\bmod{998244353} $ で求めてください。

 期待値 $ {}\bmod{998244353} $ の定義 この問題で求める期待値は必ず有理数になることが証明できます。 また、この問題の制約下では、求める期待値を既約分数 $ \frac\ yx $ で表したときに $ x $ が $ 998244353 $ で割り切れないことが保証されます。 このとき、$ y\equiv\ xz\pmod{998244353} $ を満たす $ 0\leq\ z\lt998244353 $ がただ一つ存在するので、$ z $ を出力してください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ A_1 $ $ A_2 $ $ \dots $ $ A_N $

## 输出格式

答えを出力せよ。

## 说明/提示

### 制約

- 入力は全て整数
- $ 1\ \le\ N\ \le\ 3\ \times\ 10^5 $
- $ 0\ \le\ A_i\ <\ 998244353 $
 
### Sample Explanation 1

手順の一例は、以下の通りです。 - 最初、 $ x=0 $ である。 - ダイスを $ 1 $ 度振り、出た目が $ 1 $ であった。 $ 0\ <\ 1 $ であるため、 $ A_1\ =\ 3 $ 円支給し、 $ x=1 $ とする。 - ダイスを $ 1 $ 度振り、出た目が $ 3 $ であった。 $ 1\ <\ 3 $ であるため、 $ A_3\ =\ 6 $ 円支給し、 $ x=3 $ とする。 - ダイスを $ 1 $ 度振り、出た目が $ 1 $ であった。 $ 3\ \ge\ 1 $ であるため、終了する。 この例では、青木さんの今月の給料は $ 9 $ 円です。 なお、青木さんの今月の給料の期待値は $ \frac{49}{9} $ 円と求めることができ、これを $ {}\bmod{998244353} $ 上で表現すると $ 776412280 $ となります。

## 样例 #1

### 输入

```
3

3 2 6
```

### 输出

```
776412280
```

## 样例 #2

### 输入

```
1

998244352
```

### 输出

```
998244352
```

## 样例 #3

### 输入

```
9

3 14 159 2653 58979 323846 2643383 27950288 419716939
```

### 输出

```
545252774
```



---

---
title: "[ABC330F] Minimize Bounding  Square"
layout: "post"
diff: 普及+/提高
pid: AT_abc330_f
tag: []
---

# [ABC330F] Minimize Bounding  Square

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc330/tasks/abc330_f

$ xy $ 平面上に $ N $ 個の点 $ 1,2,\dots,N $ があります。このうち点 $ i $ は座標 $ (X_i,Y_i) $ にあります。  
あなたは、以下の操作を $ 0 $ 回以上 $ K $ 回以下行うことができます。

- まず、 $ N $ 点の中からひとつを選択する。選ばれた点を $ k $ とし、この点が現在 $ (x,y) $ にあるものとする。
- 次に、以下の $ 4 $ つからひとつを選択し、実行する。
  - 点 $ k $ を $ x $ 軸沿いに $ +1 $ だけ移動させる。点 $ k $ の座標は $ (x+1,y) $ となる。
  - 点 $ k $ を $ x $ 軸沿いに $ -1 $ だけ移動させる。点 $ k $ の座標は $ (x-1,y) $ となる。
  - 点 $ k $ を $ y $ 軸沿いに $ +1 $ だけ移動させる。点 $ k $ の座標は $ (x,y+1) $ となる。
  - 点 $ k $ を $ y $ 軸沿いに $ -1 $ だけ移動させる。点 $ k $ の座標は $ (x,y-1) $ となる。
- 複数の点を同じ座標に存在させることも許されます。また、入力で複数の点が同じ座標に存在しうることに注意してください。

全ての操作が終わった後、 $ N $ 個全ての点を内部または周上に包含する、各辺が $ x $ 軸または $ y $ 軸に平行な正方形をひとつ書き込みます。  
このとき、書き込む正方形の一辺の長さとしてありうる最小の値を求めてください。全ての点が常に格子点にあることから、この値は整数であることが示せます。

**特に、全ての点を同じ座標に存在させられる時、答えは $ 0 $ であるものとします。**

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ K $ $ X_1 $ $ Y_1 $ $ X_2 $ $ Y_2 $ $ \vdots $ $ X_N $ $ Y_N $

## 输出格式

答えを整数として出力せよ。

## 说明/提示

### 制約

- 入力は全て整数
- $ 1\ \le\ N\ \le\ 2\ \times\ 10^5 $
- $ 0\ \le\ K\ \le\ 4\ \times\ 10^{14} $
- $ 0\ \le\ X_i,Y_i\ \le\ 10^9 $

### Sample Explanation 1

このケースについて、横を $ x $ 軸、縦を $ y $ 軸として図示したものが以下です。 !\[\](https://img.atcoder.jp/abc330/932178d158b342b9bda6bdc72b439f0e.png) 例えば、図中の矢印に従って $ 4 $ 度の移動を行った後、図中に示した一辺が $ 3 $ の正方形で全ての点を内部または周上に含むことができ、これが最小値であることが示せます。

### Sample Explanation 2

最初から全ての点が同じ座標に存在します。 例えば操作を $ 0 $ 回行う (即ち、全く行わない) ことにより、全ての点を同じ座標に存在させられるので、この入力に対する答えは $ 0 $ です。

## 样例 #1

### 输入

```
6 5
2 0
5 2
0 3
3 2
3 4
1 5
```

### 输出

```
3
```

## 样例 #2

### 输入

```
4 400000000000000
1000000000 1000000000
1000000000 1000000000
1000000000 1000000000
1000000000 1000000000
```

### 输出

```
0
```

## 样例 #3

### 输入

```
10 998244353
489733278 189351894
861289363 30208889
450668761 133103889
306319121 739571083
409648209 922270934
930832199 304946211
358683490 923133355
369972904 539399938
915030547 735320146
386219602 277971612
```

### 输出

```
484373824
```



---

---
title: "[ABC335E] Non-Decreasing Colorful Path"
layout: "post"
diff: 普及+/提高
pid: AT_abc335_e
tag: []
---

# [ABC335E] Non-Decreasing Colorful Path

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc335/tasks/abc335_e

$ N $ 頂点 $ M $ 辺の連結な無向グラフがあり、 $ i $ 番目の辺は頂点 $ U_i $ と頂点 $ V_i $ を双方向に結びます。  
 また、全ての頂点に整数が書いてあり、頂点 $ v $ には整数 $ A_v $ が書かれています。

頂点 $ 1 $ から頂点 $ N $ への単純なパス ( 同じ頂点を複数回通らないパス ) に対して、以下のように得点を定めます。

- パス上の頂点に書かれた整数を通った順に並べた数列 を $ S $ とする。
- $ S $ が広義単調増加になっていない場合、そのパスの得点は $ 0 $ である。
- そうでない場合、 $ S $ に含まれる整数の種類数が得点となる。
 
頂点 $ 1 $ から頂点 $ N $ への全ての単純なパスのうち、最も得点が高いものを求めてその得点を出力してください。

  $ S $ が広義単調増加であるとは? 長さ $ l $ の数列 $ S=(S_1,S_2,\dots,S_l) $ が広義単調増加であるとは、 全ての整数 $ 1\ \le\ i\ について\ S_i\ \le\ S_{i+1} $ を満たすことを言います。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ M $ $ A_1 $ $ A_2 $ $ \dots $ $ A_N $ $ U_1 $ $ V_1 $ $ U_2 $ $ V_2 $ $ \vdots $ $ U_M $ $ V_M $

## 输出格式

答えを整数として出力せよ。

## 说明/提示

### 制約

- 入力は全て整数
- $ 2\ \le\ N\ \le\ 2\ \times\ 10^5 $
- $ N-1\ \le\ M\ \le\ 2\ \times\ 10^5 $
- $ 1\ \le\ A_i\ \le\ 2\ \times\ 10^5 $
- グラフは連結である
- $ 1\ \le\ U_i\ <\ V_i\ \le\ N $
- $ i\ \neq\ j $ なら $ (U_i,V_i)\ \neq\ (U_j,V_j) $
 
### Sample Explanation 1

$ 1\ \rightarrow\ 3\ \rightarrow\ 4\ \rightarrow\ 5 $ というパスについて $ S=(10,30,40,50) $ となり、このパスの得点は $ 4 $ で、これが最大です。

### Sample Explanation 2

頂点 $ 1 $ から頂点 $ N $ への単純パスであって、 $ S $ が広義単調増加となるものはありません。この場合、最大の得点は $ 0 $ です。

## 样例 #1

### 输入

```
5 6

10 20 30 40 50

1 2

1 3

2 5

3 4

3 5

4 5
```

### 输出

```
4
```

## 样例 #2

### 输入

```
4 5

1 10 11 4

1 2

1 3

2 3

2 4

3 4
```

### 输出

```
0
```

## 样例 #3

### 输入

```
10 12

1 2 3 3 4 4 4 6 5 7

1 3

2 9

3 4

5 6

1 2

8 9

4 5

8 10

7 10

4 6

2 8

6 7
```

### 输出

```
5
```



---

---
title: "[ABC387C] Snake Numbers"
layout: "post"
diff: 普及+/提高
pid: AT_abc387_c
tag: []
---

# [ABC387C] Snake Numbers

## 题目描述

在 $10$ 以上（含）的正整数中，我们称一个数字为**蛇数**当且仅当其开头的位（首位）数字严格大于其他位数。例如， $31$ 和 $201$ 是蛇数，而 $35$ 和 $202$ 不是。

求 $L$ 以上 $R$ 以下的蛇数的个数。

## 输入格式

输入按照如下格式由标准输入给出。

> $L$ $R$

## 输出格式

输出答案即可。

## 说明/提示

#### 约定

- $10\leq L \leq R \leq 10^{18}$
- 输入均为整数


$97$ 以上 $210$ 以下的蛇数有 $97,98,100,200,201,210$ 这 $6$ 个。

Translation by @[$\varLambda\omicron\varrho\acute{\varepsilon}\nu\tau\zeta$](/user/1232305).

## 样例 #1

### 输入

```
97 210
```

### 输出

```
6
```

## 样例 #2

### 输入

```
1000 9999
```

### 输出

```
2025
```

## 样例 #3

### 输入

```
252509054433933519 760713016476190692
```

### 输出

```
221852052834757
```



---

---
title: "[ABC390D] Stone XOR"
layout: "post"
diff: 普及+/提高
pid: AT_abc390_d
tag: []
---

# [ABC390D] Stone XOR

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc390/tasks/abc390_d

袋 $ 1 $, 袋 $ 2 $, $ \ldots $, 袋 $ N $ と番号づけられた $ N $ 個の袋があります。  
 袋 $ i $ $ (1\leq\ i\leq\ N) $ には $ A_i $ 個の石が入っています。

高橋君は次の操作を好きなだけ（$ 0 $ 回でも良い）繰り返すことができます。

> $ 2 $ つの袋 A, B を選び、袋 A に入っている石を **すべて** 袋 B に入れる。

操作を繰り返した後の状態における次の値としてあり得るものが何個あるか求めてください。

- 袋 $ i $ に入っている石の個数を $ B_i $ として、$ B_1\oplus\ B_2\oplus\cdots\oplus\ B_N $ の値。  
   ただし、$ \oplus $ は排他的論理和を表す。
 
  排他的論理和とは 非負整数 $ a,b $ の排他的論理和 $ a\ \oplus\ b $ は、以下のように定義されます。 > $ a\ \oplus\ b $ を二進表記した際の $ 2^k $ $ (k\ \geq\ 0) $ の位の数は、 $ a $, $ b $ を二進表記した際の $ 2^k $ の位の数のうち一方のみが $ 1 $ であれば $ 1 $ 、 そうでなければ $ 0 $ である。

 例えば、$ 3\ \oplus\ 5\ =\ 6 $ となります（二進表記すると $ 011\ \oplus\ 101\ =\ 110 $）。  
 一般に $ k $ 個の非負整数 $ x_1,\ x_2,\ \ldots,\ x_k $ の排他的論理和 $ x_1\oplus\ x_2\oplus\cdots\oplus\ x_k $ は $ (\cdots((x_1\ \oplus\ x_2)\ \oplus\ x_3)\ \oplus\ \cdots\ \oplus\ x_k) $ と定義され、 これは $ x_1,\ x_2,\ \ldots,\ x_k $ の順番によらないことが証明できます。 なお、問題の制約下において、操作を繰り返した後の状態における上記の値としてあり得るものが有限個しかないことが証明できます。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ A_1 $ $ A_2 $ $ \ldots $ $ A_N $

## 输出格式

高橋君が操作を繰り返した後の状態における、問題文中で定義された値としてあり得るものの個数を出力せよ。

## 说明/提示

### 制約

- $ 2\leq\ N\ \leq\ 12 $
- $ 1\leq\ A_i\ \leq\ 10^{17} $
- 入力はすべて整数
 
### Sample Explanation 1

例えば、高橋君が袋 A, B として袋 $ 1 $, $ 3 $ を選び、操作を行ったとすると、袋 $ 1,2,3 $ に入っている石はそれぞれ $ 0,5,9 $ となります。 ここで高橋君が操作を終了したとき、この状態における、袋に入っている石の個数の排他的論理和は $ 0\oplus\ 5\oplus\ 9=12 $ となります。 他に、高橋君が操作を繰り返した後の状態における、袋に入っている石の個数の排他的論理和としてあり得るものは $ 0,14 $ があります。 よって、あり得る値は $ 0,12,14 $ の $ 3 $ 個であるため、$ 3 $ を出力します。

## 样例 #1

### 输入

```
3

2 5 7
```

### 输出

```
3
```

## 样例 #2

### 输入

```
2

100000000000000000 100000000000000000
```

### 输出

```
2
```

## 样例 #3

### 输入

```
6

71 74 45 34 31 60
```

### 输出

```
84
```



---

---
title: "[ABC390F] Double Sum 3"
layout: "post"
diff: 普及+/提高
pid: AT_abc390_f
tag: []
---

# [ABC390F] Double Sum 3

## 题目描述

给你一个长为 $N$ 的整数序列 $A=(A_1,A_2, \dots A_N)$。\
定义 $f(L,R)$ 如下
- 从一块空黑板开始。在黑板上依次写下 $R−L+1$ 个整数 $A_L,A_{l+1}, \dots,A_R$
- 重复下面的操作，直到擦去黑板上的所有整数：
	- 选择 $l,r(l \le r)$ 使得**数值**在 $[l,r]$ 的每个整数都至少在黑板上出现一次。然后，擦除所有**数值**在 $[l,r]$ 之间的整数。
- 设 $f(L,R)$ 是擦除黑板上所有整数所需的最少次数。

求出 $\displaystyle \sum_{L=1}^N \sum_{R=L}^N f(L,R)$。

## 输入格式

第一行一个正整数 $N$。第二行 $N$ 个正整数 $A_1,A_2,\dots,A_N$。

## 输出格式

输出一行，即所求答案。
### 样例1解释
以 $(L,R)$ 为例。\
黑板上有 $1,3,1,4$。\
选择 $(L,R)=(1,1)$ 并擦除所有 $1$。现在黑板上有 $(3,4)$。\
选择 $(L,R)=(3,4)$ 并擦除所有 $3$ 和 $4$。黑板就变成空的了。\
不能少于 $2$ 次操作完成。\
$\displaystyle \sum_{L=1}^N \sum_{R=L}^N f(L,R)=16$，所以打印 $16$。

## 样例 #1

### 输入

```
4
1 3 1 4
```

### 输出

```
16
```

## 样例 #2

### 输入

```
5
3 1 4 2 4
```

### 输出

```
23
```

## 样例 #3

### 输入

```
10
5 1 10 9 2 5 6 9 1 6
```

### 输出

```
129
```



---

---
title: "Flat Subsequence"
layout: "post"
diff: 普及+/提高
pid: AT_abl_d
tag: []
---

# Flat Subsequence

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abl/tasks/abl_d

数列 $ A_1,\ A_2,\ ...,\ A_N $ と整数 $ K $ が与えられます。

以下の条件を満たす数列 $ B $ の長さとして考えられる最大値を出力してください。

- $ B $ は $ A $ の (連続とは限らない) 部分列である。
- どの $ B $ の隣り合う要素の差の絶対値も $ K $ 以下である。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ K $ $ A_1 $ $ A_2 $ $ : $ $ A_N $

## 输出格式

答えを出力せよ。

## 说明/提示

### 制約

- $ 1\ \leq\ N\ \leq\ 300,000 $
- $ 0\ \leq\ A_i\ \leq\ 300,000 $
- $ 0\ \leq\ K\ \leq\ 300,000 $
- 入力は全て整数である。

### Sample Explanation 1

たとえば、 $ B\ =\ (1,\ 4,\ 3,\ 6,\ 9,\ 7,\ 4) $ は条件を満たします。 - これは $ A\ =\ (1,\ 5,\ 4,\ 3,\ 8,\ 6,\ 9,\ 7,\ 2,\ 4) $ の部分列です。 - 全ての隣り合う要素の差の絶対値 ($ |1-4|,\ |4-3|,\ |3-6|,\ |6-9|,\ |9-7|,\ |7-4| $) は $ K\ =\ 3 $ 以下です。

## 样例 #1

### 输入

```
10 3

1

5

4

3

8

6

9

7

2

4
```

### 输出

```
7
```



---

---
title: "Replace Digits"
layout: "post"
diff: 普及+/提高
pid: AT_abl_e
tag: []
---

# Replace Digits

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abl/tasks/abl_e

長さ $ N $ の文字列 $ S $ があります。 最初は $ S $ のすべての文字が `1` です。

クエリを $ Q $ 回処理します。 $ i $ 番目のクエリでは、整数 $ L_i,\ R_i $ と文字 (数字) $ D_i $ が与えられます。 $ L_i $ 番目から $ R_i $ 番目までの全ての文字を $ D_i $ に書き換えてください。

各クエリの後、$ S $ を十進法で書かれた整数とみなし、その値を $ 998,244,353 $ でわった余りを出力してください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ Q $ $ L_1 $ $ R_1 $ $ D_1 $ $ : $ $ L_Q $ $ R_Q $ $ D_Q $

## 输出格式

$ Q $ 行出力せよ。 $ i $ 行目には $ i $ 番目のクエリの後の $ S $ の値を modulo $ 998,244,353 $ で出力せよ。

## 说明/提示

### 制約

- $ 1\ \leq\ N,\ Q\ \leq\ 200,000 $
- $ 1\ \leq\ L_i\ \leq\ R_i\ \leq\ N $
- $ 1\ \leq\ D_i\ \leq\ 9 $
- 入力は全て整数である。

### Sample Explanation 2

あまりをとるのを忘れないでください。

## 样例 #1

### 输入

```
8 5

3 6 2

1 4 7

3 8 3

2 2 2

4 5 1
```

### 输出

```
11222211

77772211

77333333

72333333

72311333
```

## 样例 #2

### 输入

```
200000 1

123 456 7
```

### 输出

```
641437905
```



---

---
title: "Reachable Towns"
layout: "post"
diff: 普及+/提高
pid: AT_acl1_a
tag: []
---

# Reachable Towns

## 题目描述

[problemUrl]: https://atcoder.jp/contests/acl1/tasks/acl1_a

$ 2 $ 次元平面上に $ N $ 個の街があります。$ i $ 個目の街の座標は $ (x_i,\ y_i) $ です。ここで、$ (x_1,\ x_2,\ \dots,\ x_N) $ と $ (y_1,\ y_2,\ \dots,\ y_N) $ は、ともに $ (1,\ 2,\ \dots,\ N) $ の順列となっています。

各 $ k\ =\ 1,2,\dots,N $ について、以下の問題の答えを求めてください。

rngさんが街 $ k $ にいる。 rngさんは、今いる街よりも「$ x,\ y $ 座標がともに小さい街」か「$ x,\ y $ 座標がともに大きい街」に移動することを好きな回数繰り返すことができる。 rngさんが到達可能な街は、(街 $ k $ を含めて) 何種類あるか？

## 输入格式

> $ N $ $ x_1 $ $ y_1 $ $ x_2 $ $ y_2 $ $ : $ $ x_N $ $ y_N $

## 输出格式

$ N $ 行出力する。$ i $ 行目には、$ k\ =\ i $ のときの答えを出力すること。

## 说明/提示

### 制約

- $ 1\ \leq\ N\ \leq\ 200,000 $
- $ (x_1,\ x_2,\ \dots,\ x_N) $ は $ (1,\ 2,\ \dots,\ N) $ の並び替え
- $ (y_1,\ y_2,\ \dots,\ y_N) $ は $ (1,\ 2,\ \dots,\ N) $ の並び替え
- 入力される数は全て整数である．

### Sample Explanation 1

街 $ 3 $ からは街 $ 4 $ に、また逆に街 $ 4 $ からは街 $ 3 $ へ移動できます。

## 样例 #1

### 输入

```
4

1 4

2 3

3 1

4 2
```

### 输出

```
1

1

2

2
```

## 样例 #2

### 输入

```
7

6 4

4 3

3 5

7 1

2 7

5 2

1 6
```

### 输出

```
3

3

1

1

2

3

2
```



---

---
title: "[AGC003C] BBuBBBlesort!"
layout: "post"
diff: 普及+/提高
pid: AT_agc003_c
tag: []
---

# [AGC003C] BBuBBBlesort!

## 题目描述

[problemUrl]: https://atcoder.jp/contests/agc003/tasks/agc003_c

高橋君は、誕生日に長さ $ N $ の数列をもらいました。$ i(1\ ≦\ i\ ≦\ N) $ 番目の要素は整数 $ A_i $ です。どの $ 2 $ つの要素も、互いに異なります。 高橋君はこの数列を単調増加になるように並べ替えたいです。 高橋君は超能力者なので、以下の $ 2 $ つの操作が任意のタイミングでできます。

- 操作$ 1 $: 数列の連続する $ 2 $ つの要素を選び、その $ 2 $ つの順番を反転する。
- 操作$ 2 $: 数列の連続する $ 3 $ つの要素を選び、その $ 3 $ つの順番を反転する。

高橋君は操作$ 2 $は好きですが、操作$ 1 $は嫌いです。この $ 2 $ 種類の操作を使って数列を単調増加になるように並び替えるときの、操作$ 1 $の最小回数を求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ A_1 $ : $ A_N $

## 输出格式

操作$ 1 $の最小回数を出力せよ。

## 说明/提示

### 制約

- $ 1\ ≦\ N\ ≦\ 10^5 $
- $ 0\ ≦\ A_i\ ≦\ 10^9 $
- $ i\ ≠\ j $ ならば $ A_i\ ≠\ A_j $
- 入力はすべて整数である。

### Sample Explanation 1

以下の操作で、単調増加な数列にすることができます。 - まず、後ろの $ 3 $ つの要素を反転する。数列は $ 2,1,3,4 $ となる。 - 次に、前の $ 2 $ つの要素を反転する。数列は $ 1,2,3,4 $ となる。 この操作列において、連続する $ 2 $ つの要素を入れ替える操作の回数は $ 1 $ です。これより少ない回数で単調増加な数列は作れないので、$ 1 $ を出力します。

## 样例 #1

### 输入

```
4

2

4

3

1
```

### 输出

```
1
```

## 样例 #2

### 输入

```
5

10

8

5

3

2
```

### 输出

```
0
```



---

---
title: "[AGC004B] Colorful Slimes"
layout: "post"
diff: 普及+/提高
pid: AT_agc004_b
tag: []
---

# [AGC004B] Colorful Slimes

## 题目描述

[problemUrl]: https://atcoder.jp/contests/agc004/tasks/agc004_b

高橋君は異世界に住んでいます。 この世界には $ N $ 色のスライムがいます。 最初、高橋君はどの色のスライムも飼っていません。 高橋君の目標は、全色のスライムを一緒に飼うことです。

高橋君は次の $ 2 $ 種類の操作を行えます。

- 今飼っていないスライムの色 $ i $ ($ 1\ <\ =i\ <\ =N $) をひとつ選ぶ。 色 $ i $ のスライムを捕まえて飼う。 この操作には $ a_i $ 秒掛かる。
- 魔法を唱える。 すると、今飼っている各スライムについて、色 $ i $ ($ 1\ <\ =i\ <\ =N-1 $) のスライムは色 $ i+1 $ へ変色する。 ただし、色 $ N $ のスライムは色 $ 1 $ へ変色する。 この操作には $ x $ 秒掛かる。

高橋君が全色のスライムを一緒に飼うためには、最短で合計何秒掛かるかを求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ x $ $ a_1 $ $ a_2 $ $ ... $ $ a_N $

## 输出格式

高橋君が全色のスライムを一緒に飼うためには、最短で合計何秒掛かるかを出力せよ。

## 说明/提示

### 制約

- $ 2\ <\ =N\ <\ =2,000 $
- $ a_i $ は整数である。
- $ 1\ <\ =a_i\ <\ =10^9 $
- $ x $ は整数である。
- $ 1\ <\ =x\ <\ =10^9 $

### Sample Explanation 1

次のように操作を行えばよいです。 - 色 $ 1 $ のスライムを捕まえて飼う。 $ 1 $ 秒掛かる。 - 魔法を唱える。 スライムの色が $ 1 $ → $ 2 $ と変わる。 $ 10 $ 秒掛かる。 - 色 $ 1 $ のスライムを捕まえて飼う。 $ 1 $ 秒掛かる。

### Sample Explanation 2

次のように操作を行えばよいです。 - 色 $ 2 $ のスライムを捕まえて飼う。 $ 1 $ 秒掛かる。 - 魔法を唱える。 スライムの色が $ 2 $ → $ 3 $ と変わる。 $ 10 $ 秒掛かる。 - 色 $ 2 $ のスライムを捕まえて飼う。 $ 1 $ 秒掛かる。 - 魔法を唱える。 スライムの色が $ 3 $ → $ 1 $，$ 2 $ → $ 3 $ とそれぞれ変わる。 $ 10 $ 秒掛かる。 - 色 $ 2 $ のスライムを捕まえて飼う。 $ 1 $ 秒掛かる。

### Sample Explanation 3

次のように操作を行えばよいです。 - 色 $ 1 $ のスライムを捕まえて飼う。 $ 1 $ 秒掛かる。 - 色 $ 2 $ のスライムを捕まえて飼う。 $ 2 $ 秒掛かる。 - 色 $ 3 $ のスライムを捕まえて飼う。 $ 3 $ 秒掛かる。 - 色 $ 4 $ のスライムを捕まえて飼う。 $ 4 $ 秒掛かる。

## 样例 #1

### 输入

```
2 10

1 100
```

### 输出

```
12
```

## 样例 #2

### 输入

```
3 10

100 1 100
```

### 输出

```
23
```

## 样例 #3

### 输入

```
4 10

1 2 3 4
```

### 输出

```
10
```



---

---
title: "[AGC012B] Splatter Painting"
layout: "post"
diff: 普及+/提高
pid: AT_agc012_b
tag: []
---

# [AGC012B] Splatter Painting

## 题目描述

[problemUrl]: https://atcoder.jp/contests/agc012/tasks/agc012_b

イカはグラフの頂点に色を塗るのが好きです。

$ 1 $ から $ N $ までの番号がついた $ N $ 個の頂点と $ M $ 本の辺からなる単純無向グラフが与えられます。 全ての頂点ははじめ、色 $ 0 $ で塗られています。$ i $ 番目の辺は頂点 $ a_i $ と頂点 $ b_i $ を双方向につなぐ長さ $ 1 $ の辺です。

イカはこのグラフに対して $ Q $ 回の操作を行いました。 $ i $ 回目の操作では、頂点 $ v_i $ から距離 $ d_i $ 以内にあるような頂点たち全ての色を色 $ c_i $ で上書きしました。

$ Q $ 回の操作後において、各頂点がどの色で塗られているか調べてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ M $ $ a_1 $ $ b_1 $ $ : $ $ a_{M} $ $ b_{M} $ $ Q $ $ v_1 $ $ d_1 $ $ c_1 $ $ : $ $ v_{Q} $ $ d_{Q} $ $ c_{Q} $

## 输出格式

答えを $ N $ 行に出力せよ。 $ i $ 行目では $ Q $ 回の操作後における頂点 $ i $ の色を出力せよ。

## 说明/提示

### 制約

- $ 1\ ≦\ N,M,Q\ ≦\ 10^5 $
- $ 1\ ≦\ a_i,b_i,v_i\ ≦\ N $
- $ a_i\ ≠\ b_i $
- $ 0\ ≦\ d_i\ ≦\ 10 $
- $ 1\ ≦\ c_i\ ≦10^5 $
- $ d_i,\ c_i $ いずれも整数
- 与えられるグラフに自己ループや多重辺は存在しない

### 部分点

- $ 1\ ≦\ N,M,Q\ ≦\ 2{,}000 $ を満たすデータセットに正解した場合は、部分点として $ 200 $ 点が与えられる。

### Sample Explanation 1

はじめ、各頂点は色 $ 0 $ で塗られています。 $ 1 $ 回目の操作により、頂点 $ 5,6 $ が色 $ 1 $ で塗られます。 $ 2 $ 回目の操作により、頂点 $ 1,2,3,4,5 $ が色 $ 2 $ で塗られます。 !\[2ab7e180230b159d42d35ea7e555b3b0.png\](https://atcoder.jp/img/agc012/2ab7e180230b159d42d35ea7e555b3b0.png)

### Sample Explanation 2

与えられるグラフは連結とは限りません。

## 样例 #1

### 输入

```
7 7

1 2

1 3

1 4

4 5

5 6

5 7

2 3

2

6 1 1

1 2 2
```

### 输出

```
2

2

2

2

2

1

0
```

## 样例 #2

### 输入

```
14 10

1 4

5 7

7 11

4 10

14 7

14 3

6 14

8 11

5 13

8 3

8

8 6 2

9 7 85

6 9 3

6 7 5

10 3 1

12 9 4

9 6 6

8 2 3
```

### 输出

```
1

0

3

1

5

5

3

3

6

1

3

4

5

3
```



---

---
title: "[AGC014C] Closed Rooms"
layout: "post"
diff: 普及+/提高
pid: AT_agc014_c
tag: []
---

# [AGC014C] Closed Rooms

## 题目描述

[problemUrl]: https://atcoder.jp/contests/agc014/tasks/agc014_c

高橋君は建物の中に閉じ込められてしまいました。

この建物は $ H $ 行 $ W $ 列に並んだ $ H×W $ 個の部屋からなり、上から $ i $ 行目、左から $ j $ 列目の部屋は $ (i,j) $ で表され、その部屋の状態は $ A_{i,j} $ で表されています。 $ A_{i,j}= $ `#` の場合は、この部屋は閉じられており、$ A_{i,j}= $ `.` の場合は、この部屋には自由に出入りできます。 そして、 $ A_{i,j}= $ `S` となる部屋が高橋君の今いる部屋です。ただし、高橋君が今いる部屋も自由に出入りできる部屋です。

また、$ 1 $ 行目、$ 1 $ 列目、$ H $ 行目、$ W $ 列目のいずれかに含まれる部屋は建物の外につながっており、 それ以外の各部屋 $ (i,j) $ は $ 4 $ つの部屋 $ (i-1,j) $ $ , $ $ (i+1,j) $ $ , $ $ (i,j-1) $ $ , $ $ (i,j+1) $ と隣接しています。

高橋君はこの建物から脱出するために魔法を使うことにしました。一回の魔法で高橋君は以下の操作ができます。

- 高橋君は今いる部屋から隣り合う部屋に移動することを $ K $ 回まで繰り返す。ただし、閉じられている部屋には移動することはできない。
- その後、閉じられている部屋を $ K $ 個まで選び、それらを開いた状態にする。それらの部屋は以降自由に出入りできるようになる。

ただし、これらの操作では、全く動かなかったり、閉じられている部屋があっても開かなかったりしてもよいです。

高橋君の目標は建物の外につながっている部屋のいずれかにたどり着くことです。そのために必要な魔法の回数の最小値を求めてください。

ただし、はじめに高橋君がいる部屋は建物の外とはつながっていないことが保証されています。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ H $ $ W $ $ K $ $ A_{1,1}A_{1,2} $...$ A_{1,W} $ : $ A_{H,1}A_{H,2} $...$ A_{H,W} $

## 输出格式

高橋君が必要な魔法の回数の最小値を出力せよ。

## 说明/提示

### 制約

- $ 3\ ≦\ H\ ≦\ 800 $
- $ 3\ ≦\ W\ ≦\ 800 $
- $ 1\ ≦\ K\ ≦\ H×W $
- $ A_{i,j} $ は `#` , `.` , `S` のいずれかである。
- $ A_{i,j}= $ `S` となる $ (i,j) $ は一意に存在し、$ 2\ ≦\ i\ ≦\ H-1\ ,\ 2\ ≦\ j\ ≦\ W-1 $ を満たす。

### Sample Explanation 1

高橋君は最初の魔法で部屋 $ (1,2) $ に移動することができるので、$ 1 $ 回の魔法で十分です。

### Sample Explanation 2

高橋君は最初の魔法では移動することができないですが、部屋 $ (1,2) $ を $ 1 $ 回目の魔法で開けることができます。 そして、次の魔法で部屋 $ (1,2) $ に移動することで、$ 2 $ 回の魔法で目標を達成できます。

## 样例 #1

### 输入

```
3 3 3

#.#

#S.

###
```

### 输出

```
1
```

## 样例 #2

### 输入

```
3 3 3

###

#S#

###
```

### 输出

```
2
```

## 样例 #3

### 输入

```
7 7 2

#######

#######

##...##

###S###

##.#.##

###.###

#######
```

### 输出

```
2
```



---

---
title: "[AGC016C] +/- Rectangle"
layout: "post"
diff: 普及+/提高
pid: AT_agc016_c
tag: []
---

# [AGC016C] +/- Rectangle

## 题目描述

[problemUrl]: https://atcoder.jp/contests/agc016/tasks/agc016_c

整数 $ H $, $ W $, $ h $, $ w $ ($ 1\ <\ =\ h\ <\ =\ H $, $ 1\ <\ =\ w\ <\ =\ W $) が与えられます。 次の条件がすべて成り立つような行列が存在するか判定し、存在するならばひとつ構成してください。

- 行列は $ H $ 行 $ W $ 列である。
- 行列の各要素は $ -10^9 $ 以上 $ 10^9 $ 以下の整数である。
- 行列の全要素の総和は正の値である。
- どこから $ h $ 行 $ w $ 列の部分長方形を取り出しても、部分長方形に含まれる全要素の総和は負の値である。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ H $ $ W $ $ h $ $ w $

## 输出格式

条件がすべて成り立つような行列が存在しないならば、`No` を出力せよ。

存在するならば、$ 1 $ 行目に `Yes` を出力し、$ 2 $ 行目以降に行列をひとつ出力せよ。 行列は以下の形式で出力せよ。 ただし、$ a_{ij} $ は行列の $ (i,\ j) $ 要素を表す。

> $ a_{11} $ $ ... $ $ a_{1W} $ $ : $ $ a_{H1} $ $ ... $ $ a_{HW} $

## 说明/提示

### 制約

- $ 1\ <\ =\ h\ <\ =\ H\ <\ =\ 500 $
- $ 1\ <\ =\ w\ <\ =\ W\ <\ =\ 500 $

### Sample Explanation 1

行列の全要素の総和は $ 4 $ であり、正の値です。 また、部分長方形を取り出す方法は次図の $ 4 $ 通りですが、どの場合も、部分長方形に含まれる全要素の総和は $ -1 $ であり、負の値です。 !\[bbdb651fa1f05996886da9f0c4d8090a.png\](https://atcoder.jp/img/agc016/bbdb651fa1f05996886da9f0c4d8090a.png)

## 样例 #1

### 输入

```
3 3 2 2
```

### 输出

```
Yes

1 1 1

1 -4 1

1 1 1
```

## 样例 #2

### 输入

```
2 4 1 2
```

### 输出

```
No
```

## 样例 #3

### 输入

```
3 4 2 3
```

### 输出

```
Yes

2 -5 8 7

3 -5 -4 -5

2 1 -1 7
```



---

---
title: "[AGC020B] Ice Rink Game"
layout: "post"
diff: 普及+/提高
pid: AT_agc020_b
tag: []
---

# [AGC020B] Ice Rink Game

## 题目描述

[problemUrl]: https://atcoder.jp/contests/agc020/tasks/agc020_b

スケートリンクで、一人の大人の司会と $ N $ 人の子供がゲームを行います。 ゲームは $ K $ ラウンドからなり、ラウンド $ i $ では司会が次のように言います。

- $ A_i $ 人組を作って！

すると、まだ脱落していない子供たちは $ A_i $ 人からなるグループをできるだけ多く組みます。 一人につき一つのグループにしか入れません。 グループに入れなかった子供たちは脱落し、その他は次のラウンドに進みます。 ラウンドで誰も脱落しないこともありえます。

最後まで、つまりラウンド $ K $ のあとまで残ったのは $ 2 $ 人で、彼らが勝者となりました。

あなたは $ A_1 $, $ A_2 $, ..., $ A_K $ の値を聞き、$ N $ の値は知りませんが、推定してみたくなりました。

ゲームの開始前にいた子供たちの人数として考えられる最小の値と、最大の値を求めてください。もしくは、考えられる $ N $ の値は存在しないと判定してください。

## 输入格式

入力は標準入力から以下の形式で与えられる。

> $ K $ $ A_1 $ $ A_2 $ $ ... $ $ A_K $

## 输出格式

考えられる最小の $ N $ の値と最大の $ N $ の値をそれぞれ表す二つの整数を出力せよ。ただし、問題文で述べた状況が発生しえない場合は、整数 $ -1 $ を単独で出力せよ。

## 说明/提示

### 制約

- $ 1\ \leq\ K\ \leq\ 10^5 $
- $ 2\ \leq\ A_i\ \leq\ 10^9 $
- 入力値はすべて整数である。

### Sample Explanation 1

例えば、ゲームの開始時に子供が $ 6 $ 人いた場合、以下のように進行します。 - ラウンド $ 1 $ では、$ 6 $ 人の子供たちが $ 3 $ 人組を $ 2 $ つ作り、誰も脱落しません。 - ラウンド $ 2 $ では、$ 6 $ 人の子供たちが $ 4 $ 人組を $ 1 $ つ作り、$ 2 $ 人が脱落します。 - ラウンド $ 3 $ では、$ 4 $ 人の子供たちが $ 3 $ 人組を $ 1 $ つ作り、$ 1 $ 人が脱落します。 - ラウンド $ 4 $ では、$ 3 $ 人の子供たちが $ 2 $ 人組を $ 1 $ つ作り、$ 1 $ 人が脱落します。 最後まで残った二人が勝者となります。

### Sample Explanation 2

このような状況はありえません。 特に、ゲームの開始時の子供たちの人数が $ 100 $ 人未満の場合は、ラウンド $ 3 $ で全員が脱落します。

## 样例 #1

### 输入

```
4

3 4 3 2
```

### 输出

```
6 8
```

## 样例 #2

### 输入

```
5

3 4 100 3 2
```

### 输出

```
-1
```

## 样例 #3

### 输入

```
10

2 2 2 2 2 2 2 2 2 2
```

### 输出

```
2 3
```



---

---
title: "[AGC023B] Find Symmetries"
layout: "post"
diff: 普及+/提高
pid: AT_agc023_b
tag: []
---

# [AGC023B] Find Symmetries

## 题目描述

Snuke 有两块板子。每块板都是一个 $n$ 行 $n$ 列的网格。对于这两块板子，记第 $i$ 行 $j$ 列的格子为 $(i,j)$。

第一块板子的每个格子上都写着一个小写字母：格子 $(i,j)$ 上的字母为 $S_{i,j}$。第二块板子上没有写任何东西。

Snuke 将以以下方法在第二块板子上写下字母：

首先，选择两个整数 $A$，$B$；然后在第二块板子的每个格子上写下一个字母。具体的说，第二块板子的格子 $(i+A,j+B)$ 将写上 $S_{i,j}$。这里第 $n+k$ 行即第 $k$ 行，第 $n+k$ 列即为第 $k$ 列。

此操作后，若对任意的 $i,j$，第二块板的格子 $(j,i)$ 上的字母和格子 $(i,j)$ 上的字母相同，则称第二块板为“好板”。

请你求出有多少 $A,B$ 满足 $0\le A,B<n$，且经过上述操作后第二块板为“好板”。

## 输入格式

输入来自以下格式的标准输入：

$\boxed{\begin{matrix}n\\
S_{1,1}S_{1,2}\dots S_{1,n}\\
S_{2,1}S_{2,2}\dots S_{2,n}\\
\vdots\\
S_{n,1}S_{n,2}\dots S_{n,n}\end{matrix}}$

## 输出格式

输出一个数，表示有多少 $A,B$ 满足 $0\le A,B<n$，且经过上述操作后第二块板为“好板”。

## 说明/提示

- $1\le n\le 300$。
- $S_{i,j}$ 都是小写字母。

#### 样例解释：

对于样例 1：对于所有可能的 $A$ 和 $B$，二号板上的字母如下所示：

![](https://img.atcoder.jp/agc023/2414e26dc3abb6dd7bfa0c800bb4af0c.png)

当且仅当 $(A,B)=(0,1)$ 或 $(A,B)=(1,0)$ 时满足第二块板是“好板”，因此答案是 $22$。

对于样例 2，所有被选中的 $A$ 和 $B$ 都会使第二块板成为“好板”。

对于样例 3，没有 $A$ 和 $B$ 可以使第二块板成为“好板”。

## 样例 #1

### 输入

```
2

ab

ca
```

### 输出

```
2
```

## 样例 #2

### 输入

```
4

aaaa

aaaa

aaaa

aaaa
```

### 输出

```
16
```

## 样例 #3

### 输入

```
5

abcde

fghij

klmno

pqrst

uvwxy
```

### 输出

```
0
```



---

---
title: "[AGC024B] Backfront"
layout: "post"
diff: 普及+/提高
pid: AT_agc024_b
tag: []
---

# [AGC024B] Backfront

## 题目描述

[problemUrl]: https://atcoder.jp/contests/agc024/tasks/agc024_b

$ 1 $ 以上 $ N $ 以下の整数を並び替えてできる数列 $ (P_1,P_2,...,P_N) $ が与えられます。 次の操作を繰り返してこの列を昇順に並び替えるとき、操作の回数の最小値を求めてください。

- 数列の要素を $ 1 $ つ選び、その要素を列の先頭または末尾のうち好きなほうに移動する

なお、この操作によって与えられた列を昇順に並び替えられることは証明できます。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ P_1 $ $ : $ $ P_N $

## 输出格式

操作の回数の最小値を出力せよ。

## 说明/提示

### 制約

- $ 1\ \leq\ N\ \leq\ 2\times\ 10^5 $
- $ (P_1,P_2,...,P_N) $ は $ (1,2,...,N) $ の並び替えである
- 入力はすべて整数である

### Sample Explanation 1

例えば、以下の操作によって列を昇順に並び替えることができます。 - $ 2 $ を先頭に移動する。新しい数列は $ (2,1,3,4) $ となる。 - $ 1 $ を先頭に移動する。新しい数列は $ (1,2,3,4) $ となる。

## 样例 #1

### 输入

```
4

1

3

2

4
```

### 输出

```
2
```

## 样例 #2

### 输入

```
6

3

2

5

1

4

6
```

### 输出

```
4
```

## 样例 #3

### 输入

```
8

6

3

1

2

7

4

8

5
```

### 输出

```
5
```



---

---
title: "[AGC024C] Sequence Growing Easy"
layout: "post"
diff: 普及+/提高
pid: AT_agc024_c
tag: []
---

# [AGC024C] Sequence Growing Easy

## 题目描述

[problemUrl]: https://atcoder.jp/contests/agc024/tasks/agc024_c

長さ $ N $ の数列 $ X $ があり、最初はすべての要素が $ 0 $ です。$ X $ の $ i $ 項目を $ X_i $ で表すことにします。

長さ $ N $ の数列 $ A $ が与えられます。$ A $ の $ i $ 項目は $ A_i $ です。 以下の操作を繰り返すことで $ X $ を $ A $ と等しくすることができるかどうか判定し、できるなら最小の操作回数を求めてください。

- $ 1\leq\ i\leq\ N-1 $ なる整数 $ i $ を選ぶ。$ X_{i+1} $ の値を $ X_i $ の値に $ 1 $ を足したもので置き換える。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ A_1 $ $ : $ $ A_N $

## 输出格式

操作を繰り返すことで $ X $ を $ A $ と等しくすることができるなら最小の操作回数を、できないなら $ -1 $ を出力せよ。

## 说明/提示

### 制約

- $ 1\ \leq\ N\ \leq\ 2\ \times\ 10^5 $
- $ 0\ \leq\ A_i\ \leq\ 10^9(1\leq\ i\leq\ N) $
- 入力はすべて整数である

### Sample Explanation 1

次のようにして、$ X $ を $ A $ と等しくすることができます。 - $ i=2 $ に対して操作する。$ X $ は $ (0,0,1,0) $ となる。 - $ i=1 $ に対して操作する。$ X $ は $ (0,1,1,0) $ となる。 - $ i=3 $ に対して操作する。$ X $ は $ (0,1,1,2) $ となる。

## 样例 #1

### 输入

```
4

0

1

1

2
```

### 输出

```
3
```

## 样例 #2

### 输入

```
3

1

2

1
```

### 输出

```
-1
```

## 样例 #3

### 输入

```
9

0

1

1

0

1

2

2

1

2
```

### 输出

```
8
```



---

---
title: "[AGC025B] RGB Coloring"
layout: "post"
diff: 普及+/提高
pid: AT_agc025_b
tag: []
---

# [AGC025B] RGB Coloring

## 题目描述

[problemUrl]: https://atcoder.jp/contests/agc025/tasks/agc025_b

高橋君はタワーを $ 1 $ つ持っており、それは $ N $ 個のブロックが縦一列に重なって構成されています。 はじめすべてのブロックは無色ですが、高橋君はいくつかのブロックを赤色、緑色、青色のいずれかの色で塗ることで、 タワーを美しくしようとしています。そこで、高橋君は *タワーの美しさ* を以下のように定義することにしました。

- 各ブロックの得点を、赤色に塗られていれば $ A $ 点、緑色に塗られていれば $ A+B $ 点、青色に塗られていれば $ B $ 点、無色ならば $ 0 $ 点として、 $ N $ 個のブロックの得点の合計をタワーの美しさとする。

ただし、$ A,B $ はあらかじめ与えられる正整数の定数であり、各マスが $ 2 $ つ以上の色で同時に塗られることがないことにも注意してください。

高橋君はタワーの美しさがちょうど $ K $ になるようにブロックを塗ろうと考えています。 そのようにタワーを塗る方法は何通りあるでしょうか。 $ 998244353 $ で割った余りを求めてください。 ただし、$ 2 $ つのタワーを塗る方法が異なるとは、あるブロックが存在し、そのブロックに塗られている色が異なること、もしくは、そのブロックが一方では塗られているが、 他方では無色であることを指します。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ A $ $ B $ $ K $

## 输出格式

タワーを塗る方法の個数を $ 998244353 $ で割った余りを出力せよ。

## 说明/提示

### 制約

- $ 1\ ≦\ N\ ≦\ 3×10^5 $
- $ 1\ ≦\ A,B\ ≦\ 3×10^5 $
- $ 0\ ≦\ K\ ≦\ 18×10^{10} $
- 入力される値は全て整数である

### Sample Explanation 1

この場合、赤色 $ 1 $ つにつき $ 1 $ 点、緑色 $ 1 $ つにつき $ 3 $ 点、青色 $ 1 $ つにつき $ 2 $ 点なので、美しさが $ 5 $ になるのは、 - 緑色 $ 1 $ つ、青色 $ 1 $ つ - 赤色 $ 1 $ つ、青色 $ 2 $ つ - 赤色 $ 2 $ つ、緑色 $ 1 $ つ - 赤色 $ 3 $ つ、青色 $ 1 $ つ のいずれかの場合だけです。よって、求める答えは $ 40 $ になります。

### Sample Explanation 2

美しさが $ 0 $ であるタワーは、すべてのブロックが無色であるものだけです。よって、答えは $ 1 $ になります。

## 样例 #1

### 输入

```
4 1 2 5
```

### 输出

```
40
```

## 样例 #2

### 输入

```
2 5 6 0
```

### 输出

```
1
```

## 样例 #3

### 输入

```
90081 33447 90629 6391049189
```

### 输出

```
577742975
```



---

---
title: "[AGC026B] rng_10s"
layout: "post"
diff: 普及+/提高
pid: AT_agc026_b
tag: []
---

# [AGC026B] rng_10s

## 题目描述

[problemUrl]: https://atcoder.jp/contests/agc026/tasks/agc026_b

コンビニエンスストアのりんごマートでは，りんごジュースを販売しています。

りんごマートはある日の朝に開店し，その時にはジュースの在庫が $ A $ 本ありました。 すぬけ君は毎日昼にりんごマートでジュースを $ B $ 本買います。 りんごマートでは毎日夜にジュースの在庫を確認し，$ C $ 本以下だった場合，次の日の朝までに $ D $ 本在庫を追加します。

すぬけ君がジュースを永遠に買い続けられるかを判定して下さい。 つまり，ジュースを買おうとした時，必ず在庫が $ B $ 本以上あるかどうかを判定して下さい。 すぬけ君以外がジュースを買うことはありません。

また，今回の問題では入力ケースは $ T $ 個のクエリからなります。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ T $ $ A_1 $ $ B_1 $ $ C_1 $ $ D_1 $ $ A_2 $ $ B_2 $ $ C_2 $ $ D_2 $ $ : $ $ A_T $ $ B_T $ $ C_T $ $ D_T $

$ i $ 個目のクエリにおいては，$ A\ =\ A_i,\ B\ =\ B_i,\ C\ =\ C_i,\ D\ =\ D_i $ である。

## 输出格式

$ T $ 行出力せよ。$ i $ 行目には，$ i $ 個目のクエリですぬけ君が永遠にりんごジュースを買い続けられる場合 `Yes`，そうでない場合 `No` と出力せよ。

## 说明/提示

### 制約

- $ 1\ \leq\ T\ \leq\ 300 $
- $ 1\ \leq\ A,\ B,\ C,\ D\ \leq\ 10^{18} $
- 入力される値は全て整数である

### Sample Explanation 1

$ 1 $ 個目のクエリでは在庫の個数は以下のように変動します。 $ 9 $ →昼 $ 2 $ →夜 $ 11 $ →昼 $ 4 $ →夜 $ 13 $ →昼 $ 6 $ →夜 $ 6 $ →昼 x $ 2 $ 個目のクエリでは在庫の個数は以下のように変動します。 $ 9 $ →昼 $ 2 $ →夜 $ 11 $ →昼 $ 4 $ →夜 $ 13 $ →昼 $ 6 $ →夜 $ 15 $ →昼 $ 8 $ →夜 $ 8 $ →昼 $ 1 $ →夜 $ 10 $ →昼 $ 3 $ →夜 $ 12 $ →昼 $ 5 $ →夜 $ 14 $ →昼 $ 7 $ →夜 $ 7 $ →昼 $ 0 $ →夜 $ 9 $ →昼 $ 2 $ →夜 $ 11 $ →昼 … と続いていき，このまま永遠に購入し続けられます。

## 样例 #1

### 输入

```
14

9 7 5 9

9 7 6 9

14 10 7 12

14 10 8 12

14 10 9 12

14 10 7 11

14 10 8 11

14 10 9 11

9 10 5 10

10 10 5 10

11 10 5 10

16 10 5 10

1000000000000000000 17 14 999999999999999985

1000000000000000000 17 15 999999999999999985
```

### 输出

```
No

Yes

No

Yes

Yes

No

No

Yes

No

Yes

Yes

No

No

Yes
```

## 样例 #2

### 输入

```
24

1 2 3 4

1 2 4 3

1 3 2 4

1 3 4 2

1 4 2 3

1 4 3 2

2 1 3 4

2 1 4 3

2 3 1 4

2 3 4 1

2 4 1 3

2 4 3 1

3 1 2 4

3 1 4 2

3 2 1 4

3 2 4 1

3 4 1 2

3 4 2 1

4 1 2 3

4 1 3 2

4 2 1 3

4 2 3 1

4 3 1 2

4 3 2 1
```

### 输出

```
No

No

No

No

No

No

Yes

Yes

No

No

No

No

Yes

Yes

Yes

No

No

No

Yes

Yes

Yes

No

No

No
```



---

---
title: "[AGC027C] ABland Yard"
layout: "post"
diff: 普及+/提高
pid: AT_agc027_c
tag: []
---

# [AGC027C] ABland Yard

## 题目描述

[problemUrl]: https://atcoder.jp/contests/agc027/tasks/agc027_c

$ N $ 頂点 $ M $ 本の辺からなる無向グラフが与えられます。 頂点には $ 1 $ から $ N $ の番号が、辺には $ 1 $ から $ M $ の番号がついています。 頂点には番号以外に `A` か `B` のラベルがついており、頂点 $ i $ には $ s_i $ のラベルがついています。

辺 $ i $ は頂点 $ a_i $ と $ b_i $ を双方向につなぐ辺です。

怪盗ヌスークは好きな頂点を始点として選び、そこから $ 0 $ 回以上辺を辿って移動するのが好きです。 今日は移動後に、訪れた頂点についているラベルを始点から訪問した順に並べて文字列を作ることにしました。

例えば、頂点 $ 1 $ にラベル `A` が、頂点 $ 2 $ にラベル `B` がついているグラフにおいて、ヌスークが $ 1\ \rightarrow\ 2\ \rightarrow\ 1\ \rightarrow\ 2\ \rightarrow\ 2 $ と移動した場合、`ABABB` が作られます。

怪盗ヌスークが文字 `A`,`B` のみからなる任意の文字列が作れるかどうかを判定してください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ M $ $ s $ $ a_1 $ $ b_1 $ $ : $ $ a_{M} $ $ b_{M} $

## 输出格式

ヌスークが文字 `A`,`B` のみからなる任意の文字列が作ることが可能なら `Yes` を、そうでなければ `No` を出力せよ。

## 说明/提示

### 制約

- $ 2\ \leq\ N\ \leq\ 2\ \times\ 10^{5} $
- $ 1\ \leq\ M\ \leq\ 2\ \times\ 10^{5} $
- $ |s|\ =\ N $
- $ s_i $ は `A` または `B`
- $ 1\ \leq\ a_i,\ b_i\ \leq\ N $
- 与えられるグラフは単純とも連結とも限らない

### Sample Explanation 1

\- ヌスークは頂点 $ 1 $ と頂点 $ 2 $ を自由に訪れることができるため、`A`,`B` のみからなる任意の文字列が作ることが可能です !\[77e96cf8e213d606ddd8f3c3f8315d32.png\](https://img.atcoder.jp/agc027/77e96cf8e213d606ddd8f3c3f8315d32.png)

### Sample Explanation 2

\- 例えば、`BB` を作ることができません - 与えられるグラフは連結とは限りません !\[1ab1411cb9d6ee023d14ca4e77c4b584.png\](https://img.atcoder.jp/agc027/1ab1411cb9d6ee023d14ca4e77c4b584.png)

## 样例 #1

### 输入

```
2 3

AB

1 1

1 2

2 2
```

### 输出

```
Yes
```

## 样例 #2

### 输入

```
4 3

ABAB

1 2

2 3

3 1
```

### 输出

```
No
```

## 样例 #3

### 输入

```
13 23

ABAAAABBBBAAB

7 1

10 6

1 11

2 10

2 8

2 11

11 12

8 3

7 12

11 2

13 13

11 9

4 1

9 7

9 6

8 13

8 6

4 10

8 7

4 3

2 1

8 12

6 9
```

### 输出

```
Yes
```

## 样例 #4

### 输入

```
13 17

BBABBBAABABBA

7 1

7 9

11 12

3 9

11 9

2 1

11 5

12 11

10 8

1 11

1 8

7 7

9 10

8 8

8 12

6 2

13 11
```

### 输出

```
No
```



---

---
title: "[AGC029B] Powers of two"
layout: "post"
diff: 普及+/提高
pid: AT_agc029_b
tag: []
---

# [AGC029B] Powers of two

## 题目描述

[problemUrl]: https://atcoder.jp/contests/agc029/tasks/agc029_b

高橋君は正整数が書かれたボールを $ N $ 個持っています。$ i $ 番目のボールに書かれている正整数は $ A_i $ です。 高橋君は $ N $ 個のボールからいくつかのペアを作って、それぞれのペアのボールに書かれた数の和が $ 2 $ べきとなるようにしたいです。 ただし、同じボールが複数のペアに属することはできません。 最大でいくつのペアが作れるか求めてください。

ただし、正整数が $ 2 $ べきであるとは、ある非負整数 $ t $ を用いて $ 2^t $ と書けることを指します。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ A_1 $ $ A_2 $ $ ... $ $ A_N $

## 输出格式

$ 2 $ つのボールに書かれた数の和が $ 2 $ べきとなるペアの個数として考えられる最大値を出力せよ。

## 说明/提示

### 制約

- $ 1\ \leq\ N\ \leq\ 2\times\ 10^5 $
- $ 1\ \leq\ A_i\ \leq\ 10^9 $
- $ A_i $ は整数

### Sample Explanation 1

$ 1 $ 番目のボールと $ 3 $ 番目のボールをペアにすることで、書かれた数の和が $ 4 $ となるペアを $ 1 $ つ作ることができます。 $ 2 $ 番目のボール同士をペアにできないことに注意してください。

## 样例 #1

### 输入

```
3

1 2 3
```

### 输出

```
1
```

## 样例 #2

### 输入

```
5

3 11 14 5 13
```

### 输出

```
2
```



---

---
title: "Nearest Card Game"
layout: "post"
diff: 普及+/提高
pid: AT_aising2019_d
tag: []
---

# Nearest Card Game

## 题目描述

## 题面描述
现在高桥和青木有N张卡片，每张卡片上有一个整数 $ A_i $ ，并且**任意2张卡片**上的整数都不相同

高桥和青木决定用这些卡玩下面这个游戏：

- 首先青木决定了一个整数 $ x $ 。
- **从高桥开始**，每人轮流拿一张卡。此时，取的卡如下选择。
	- 高桥取**剩下**的卡片中写的整数**最大**的卡片。
	- 青木取**剩下**的卡片中写的整数**最接近** $ x $ 的卡片。但是，在有多张这样的卡的情况下，取它们中写的整数**最小**的卡。
	- 剩下的卡数量为零（也就是全被拿走了）时游戏结束。

对于 $ x $ 的值，你将获得 $ Q $ 个候选值：$ X_1,\ X_2,\ ...,\ X_Q $ 。对于每个 $ i $ （ $ 1\ \leq\ i\ \leq\ Q $ ），请找出**当青木所选的 $ x $ 值为 $ X_i $ 时**，高桥所选的所有卡片上整数的和。

## 输入格式

```
 $ N $   $ Q $ 
 $ A_1 $   $ A_2 $   $ ... $   $ A_N $ 
 $ X_1 $ 
 $ X_2 $ 
 $ : $ 
 $ X_Q $ 
```

## 输出格式

输出 $ Q $ 行，第 $ i $ （ $ 1\ \leq\ i\ \leq\ Q $ ）行应该包含 $ x $ = $ X_i $ 的答案

## 样例 #1

### 输入

```
5 5

3 5 7 11 13

1

4

9

10

13
```

### 输出

```
31

31

27

23

23
```

## 样例 #2

### 输入

```
4 3

10 20 30 40

2

34

34
```

### 输出

```
70

60

60
```



---

---
title: "Anything Goes to Zero"
layout: "post"
diff: 普及+/提高
pid: AT_aising2020_d
tag: []
---

# Anything Goes to Zero

## 题目描述

# 任何东西都会归零
[problemUrl]: https://atcoder.jp/contests/aising2020/tasks/aising2020_d
定义 $ \mathrm{popcount}(n) $ 为 $ n $ 在二进制表示中 '1' 的个数。例如，$ \mathrm{popcount}(3)\ =\ 2,\ \mathrm{popcount}(7)\ =\ 3,\ \mathrm{popcount}(0)\ =\ 0 $。
定义 $ f(n) $ 为将 $ n $ 用 $ \mathrm{popcount}(n) $ 除后取余数替换 $ n $ 的操作次数，直到 $ n $ 变为 $ 0 $ 为止（在这个问题的约束下，可以证明 $ n $ 经过有限次操作后一定会变为 $ 0 $）。
以下是以 $ n=7 $ 为例，经过 2 次操作 $ n $ 变为 0 的过程。
- 因为 $ \mathrm{popcount}(7)=3 $，所以用 3 除 7 后的余数 1 替换 7。
- 因为 $ \mathrm{popcount}(1)=1 $，所以用 1 除 1 后的余数 0 替换 1。
给定一个二进制表示的 $ N $ 位整数 $ X $。对于满足 $ 1\ \leq\ i\ \leq\ N $ 的整数 $ i $，定义将 $ X $ 的第 $ i $ 位取反后的整数为 $ X_i $。求 $ f(X_1),\ f(X_2),\ \ldots,\ f(X_N) $。

## 输入格式

输入从标准输入中以以下形式给出。
> $ N $ $ X $

## 输出格式

输出 $ N $ 行。第 $ i $ 行输出 $ f(X_i) $ 的值。
## 样例 #1
### 样例输入 #1
```
3
011
```
### 样例输出 #1
```
2
1
1
```
## 样例 #2
### 样例输入 #2
```
23
00110111001011011001110
```
### 样例输出 #2
```
2
1
2
2
1
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
1
3
```

## 说明/提示

### 制約
- $ 1\ \leq\ N\ \leq\ 2\ \times\ 10^5 $
- $ X $ 是二进制表示的 $ N $ 位的整数（首位不一定是 '1'）
### 样例解释 #1
- $ X_1 $ 是 7。因为 7 变为 1 再变为 0，所以 $ f(7) = 2 $。
- $ X_2 $ 是 1。因为 1 变为 0，所以 $ f(1) = 1 $。
- $ X_3 $ 是 2。因为 2 变为 0，所以 $ f(2) = 1 $。

## 样例 #1

### 输入

```
3

011
```

### 输出

```
2

1

1
```

## 样例 #2

### 输入

```
23

00110111001011011001110
```

### 输出

```
2

1

2

2

1

2

2

2

2

2

2

2

2

2

2

2

2

2

2

2

2

1

3
```



---

---
title: "[ARC003C] 暗闇帰り道"
layout: "post"
diff: 普及+/提高
pid: AT_arc003_3
tag: []
---

# [ARC003C] 暗闇帰り道

## 题目描述

## 漆黑归家路



高桥君一个人走夜路从学校回家。



他所居住的城市是一个被分为小格的长方形。高桥君一秒只能向东、南、西、北方向移动一格。



输入给出格子$i,j$的阳光值$c_i,_j$，$t$秒时，该格子的明亮度为$0.99^t×c_i,_j$$（出发时间为$0$秒）。



从学校回到家的路径明亮度为路线所经格子的明亮度的**最小值**。



高桥君有黑暗恐惧症，会尽可能地选择**明亮度大**的路径。



请求出他回家路径中的最大明亮度。

## 输入格式

第$1$行为空格隔开的$N$,$M$,第$2-N+1$行是一个$N×M$的矩阵。格子的状态用```s```,```g```,```1```-```9```,```#```来表示。



第$i$行的第$j$个字母$c_i,_j$ 表示格子$i,j$的状态。



- ```s``` 学校的位置。

- ```g``` 家的位置。

- ```1```-```9``` 该格的阳光值。

- ```#``` 此路不通。

- 高桥君无法走出城市外。

- ```s```,```g```唯一且不相邻。

## 输出格式

输出的第一行为所求的最大明亮度，若路径不存在则输出```-1```，答案的相对误差控制在```1e-9```以内，请在末尾输出换行。



样例1



输入

```

3 3

s52

743

32g

```



输出



```

2.910897

```

## 说明/提示

- 時刻0: 从学校$(1,1)$出发。

- 時刻1: 移动到$(2,1) $。时间 $t=1$, 阳光值$=7$ 、$(2,1)$ 的明亮度为$6.93$。

- 時刻2: 移动到$(2,2)$ 。时间 $t=2$, 阳光值$=4$ 、$(2,2)$的明亮度为$3.9204$。

- 時刻3: 移动到$(2,3)$ 。时间 $t=3$, 阳光值$=3$、$(2,3)$的明亮度为$2.910897$。

- 時刻4: 回到家$(3,3)$了 。当前最小的明亮值是时间 $t=3$时的$(2,3)$的明亮度为$2.910897$，答案也就是$2.910897$。

![样例1](https://cdn.luogu.org/upload/pic/39444.png)



样例2



输入

```

4 6

g31784

621415

627914

7451s3

```



输出



```

2.97

```



![样例2](https://cdn.luogu.org/upload/pic/39446.png)



不需要解释。



---

---
title: "[ARC006D] アルファベット探し"
layout: "post"
diff: 普及+/提高
pid: AT_arc006_4
tag: []
---

# [ARC006D] アルファベット探し

## 题目描述

在长为H，宽为W的矩阵中，可以用黑格子组成一些字母。



例如图1



![图1](https://cdn.luogu.com.cn/upload/image_hosting/8yah7syy.png)

图1（用7*7的格子分别组成了A，B，C）



矩阵中只能由黑格组成A，B，C字母，并且将A，B，C分别放大或缩小后的图案以及将3个字母分别旋转90°后的图案都算A，B，C的相同形状。



例如图2



![图2](https://cdn.luogu.com.cn/upload/image_hosting/zb1lce1g.png)



图2（以上字母均为合法字母，并分别属于A，B，C）



设这个字母最长的长为h，最长的宽为w，则该字母所占的矩阵大小为：（h+1）*（w+1）



如果两个字母的矩阵相互重叠，则两个字母均为不合法。



例如图3



![图3](https://cdn.luogu.com.cn/upload/image_hosting/v3hirerx.png)



图3（因为两个A所占的矩阵有重叠部分，所以均为不合法）



现在给出H*W的矩阵，分别求其中A，B，C 3个字母的个数。

## 输入格式

第一行两个整数H，W



接下来输入H*M大小的矩阵，由"o"和"."组成。



"o"代表黑块，可以算作字母的一部分。



"."代表白块，不能算作字母的一部分

## 输出格式

分别输出矩阵中所含的合法的A，B，C个数。中间用空格隔开。



---

---
title: "[ARC008C] THE☆たこ焼き祭り2012"
layout: "post"
diff: 普及+/提高
pid: AT_arc008_3
tag: []
---

# [ARC008C] THE☆たこ焼き祭り2012

## 题目描述

[problemUrl]: https://atcoder.jp/contests/arc008/tasks/arc008_3

 たこ焼き屋の開店にあたって、たこ焼きの味を皆に分かってもらうために試食イベントを行うことにしました。  
 しかし、高橋社長はたこ焼きをより多くの人に食べてもらいたいので、試食イベントを兼ねたお祭り『THE☆たこ焼き祭り2012』をすることを提案してきました。高橋社長が提案してきた『THE☆たこ焼き祭り2012』の試食イベント内容は以下のようになっています。

 会場にはあなたと参加者を足して $ N $ 人の人がいます。あなたはたこ焼きを $ N $ 個持っており、それを全員に $ 1 $ 人 $ 1 $ 個ずつ行き渡るようにします。  
 会場は広いのであなたはたこ焼きを投げて配らないといけません。 あなただけで全員に配ることは大変なので、参加者にも協力してもらうことにし、参加者は受け取ったたこ焼きを別の参加者へと投げることもできます。  
 あなたと参加者はつまようじを$ 1 $ 人につき $ 1 $ 本しか持っていないので同じタイミングで複数のたこ焼きを投げることはできず、たこ焼きを投げてから $ 1 $ 秒間は次のたこ焼きを投げることができません。受け取る側はいつでも何個でも受け取ることができます。  
 さらに、あなたと参加者は立っている位置から動いてはいけません。  
 参加者は大人から子供までいるのでそれぞれにはたこ焼きをキャッチできる速度の上限があり、たこ焼きを投げる側にも投げられる速度の上限があります。投げられたたこ焼きの速度は減衰することなく受け取り手に届きます。

 たこ焼きはなるべく出来立てを食べて欲しいので、たこ焼きを全員に配り切るために必要な時間の最小値を答えなさい。

 入力は以下の形式で標準入力から与えられる。 > $ N $ $ x_{0} $ $ y_{0} $ $ t_{0} $ $ r_{0} $ $ x_{1} $ $ y_{1} $ $ t_{1} $ $ r_{1} $ : : $ x_{N-1} $ $ y_{N-1} $ $ t_{N-1} $ $ r_{N-1} $

- 入力は $ N+1 $ 行ある。
- $ 1 $ 行目には、たこ焼き祭りの参加者数とあなたを足した数を表す整数 $ N\ (1≦N≦1,000) $ が与えられる。
- $ 2 $ 行目には、あなたが立っている位置の $ x $ 座標を表す整数 $ x_0\ (-10,000≦x_0≦10,000) $、$ y $ 座標を表す整数 $ y_0\ (-10,000≦y_0≦10,000) $、たこ焼きを投げる速度の上限を表す整数 $ t_0\ (3≦t_0≦340) $ とたこ焼きを受け取る速度の上限を表す整数 $ r_0\ (3≦r_0≦340) $ が空白で区切られて与えられる。
- $ 3 $ 行目から $ N-1 $ 行のうち $ i+2\ (1≦i≦N-1) $ 行目には $ i $ 番目の参加者が立っている位置の $ x $ 座標を表す整数 $ x_i\ (-10,000≦x_i≦10,000) $、$ y $ 座標を表す整数 $ y_i\ (-10,000≦y_i≦10,000) $、たこ焼きを投げる速度の上限を表す整数 $ t_i\ (3≦t_i≦340) $ とたこ焼きを受け取る速度の上限を表す整数 $ r_i\ (3≦r_i≦340) $ が空白で区切られて与えられる。
- 与えられる速度は $ 1 $ 秒辺りの速度である。
- 複数の人が同じ位置に立つことはない。
 
 たこ焼きを全ての参加者が $ 1 $ つずつ受け取るためまでに必要な秒数の最小値を $ 1 $ 行で出力せよ。  
 出力は整数および小数のみとし、誤差は絶対誤差あるいは相対誤差の少なくとも片方が $ 10^{−6} $ 以下であれば許容する。  
 なお、最後には改行を出力せよ。 ```

4
0 0 300 10
0 100 10 100
0 200 10 200
0 300 10 300
```

 ```

3
```

- $ 0 $ 秒目 : 
  - あなた : $ 1 $ 番目の参加者に速度 $ 100 $ でたこ焼きを投げる。
- $ 1 $ 秒目 : 
  - あなた : $ 2 $ 番目の参加者に速度 $ 200 $ でたこ焼きを投げる。
  - $ 1 $ 番目の参加者 : あなたが $ 0 $ 秒目に投げたたこ焼きをキャッチする。
- $ 2 $ 秒目 : 
  - あなた : $ 3 $ 番目の参加者に速度 $ 300 $ でたこ焼きを投げる。
  - $ 2 $ 番目の参加者 : あなたが $ 1 $ 秒目に投げたたこ焼きをキャッチする。
- $ 3 $ 秒目 : 
  - $ 3 $ 番目の参加者 : あなたが $ 2 $ 秒目に投げたたこ焼きをキャッチする。
 
```

4
0 0 100 10
0 90 10 10
0 100 30 100
-20 100 10 10
```

 ```

3
```

- $ 0 $ 秒目 : 
  - あなた : $ 2 $ 番目の参加者に速度 $ 100 $ でたこ焼きを投げる。
- $ 1 $ 秒目 : 
  - あなた : $ 2 $ 番目の参加者に速度 $ 100 $ でたこ焼きを投げる。
  - $ 2 $ 番目の参加者 : あなたが $ 0 $ 秒目に投げたたこ焼きをキャッチし、$ 3 $ 番目の参加者に速度 $ 10 $ で投げる。
- $ 2 $ 秒目 : 
  - あなた : $ 2 $ 番目の参加者に速度 $ 100 $ でたこ焼きを投げる。
  - $ 2 $ 番目の参加者 : あなたが $ 1 $ 秒目に投げたたこ焼きをキャッチし、$ 2 $ 番目の参加者に速度 $ 10 $ で投げる。
- $ 3 $ 秒目 : 
  - $ 1 $ 番目の参加者 : $ 2 $ 番目の参加者が $ 2 $ 秒目に投げたたこ焼きをキャッチする。
  - $ 2 $ 番目の参加者 : あなたが $ 2 $ 秒目に投げたたこ焼きをキャッチする。
  - $ 3 $ 番目の参加者 : $ 2 $ 番目の参加者が $ 1 $ 秒目に投げたたこ焼きをキャッチする。
 
```

1
0 0 3 3
```

 ```

0
```

- 参加者があなただけなので配る必要がありません。
 
```

4
58 -49 38 109
45 -29 200 56
-32 123 103 98
49 -234 289 43
```

 ```

4.874179
```


```

8
100 100 30 50
100 50 93 123
100 0 89 111
50 100 13 18
50 0 155 86
0 100 30 58
0 50 58 49
0 0 98 153
```

 ```

7.666667
```



---

---
title: "[ARC011C] ダブレット"
layout: "post"
diff: 普及+/提高
pid: AT_arc011_3
tag: []
---

# [ARC011C] ダブレット

## 题目描述

你正在玩一个单词接龙游戏。

一个单词可以变换为另一个单词，当且仅当这两个单词恰有一个字母不同。

给定起始单词 $first$ 和目标单词 $last$，以及一个含有 $N$ 个单词的 **可重** 词集 $\{s_0,s_1,...,s_{N-1}\}$。请回答，在只使用词集中的词进行变换的情况下，从 $first$ 变换到 $last$ 最少需要多少步 **（所使用的词集中的词的个数）**，并给出一组方案。

特别地：

- 若 $first$ 和 $last$ 相同，则步数为 $0$；
- 若无法完成变换，仅输出一行 `-1` 即可；
- **若 $first$ 只经过一次变换即可得到 $last$，则步数也为 $0$。（这段话原题没写）**

## 输入格式

第一行输入两个单词 $first$ 和 $last$。

第二行输入一个正整数 $N$，表示词集大小。

第三行到第 $(N+2)$ 行，每行输入一个单词 $s_i$ 表示词集中的一个词。

## 输出格式

若无法完成变换，仅输出一行一个整数 `-1`。

否则，按如下格式输出：

- 第一行输出一个整数 $k$，表示中间词的个数；
- 接下来 $(k+2)$ 行，每行一个单词。这 $(k+2)$ 行展示的即为从 $first$ 变换至 $last$ 的一种可能的过程。

若有多解，输出任一解即可。

**输出末尾换行。**

### 输入输出样例

#### 输入 #1

```
eye lid
4
lie
die
did
dye
```

#### 输出 #1

```
3
eye
dye
die
lie
lid
```

#### 输入 #2

```
eye eye
4
lie
die
did
dye
```

#### 输出 #2

```
0
eye
eye
```

#### 输入 #3

```
eye lid
4
lie
lip
did
dye
```

#### 输出 #3

```
-1
```

## 说明/提示

- $1\le N\le 1\ 000$；
- 词集中可能含有重复的单词，也可能含有 $first$ 和 $last$；
- 输入的每个单词长度都相同，且该长度 $L$ 满足 $1\le L\le 30$；
- 每个单词仅由英文小写字母 `a-z` 构成。



---

---
title: "[ARC012C] 五目並べチェッカー"
layout: "post"
diff: 普及+/提高
pid: AT_arc012_3
tag: []
---

# [ARC012C] 五目並べチェッカー

## 题目描述

[problemUrl]: https://atcoder.jp/contests/arc012/tasks/arc012_3

高橋君は、五目並べが大好きです。  
 五目並べとは、 $ 19 $ × $ 19 $ の碁盤の上に交互に碁石を $ 1 $ つずつ並べ、 $ 5 $ つ以上の碁石が縦・横・ななめに並べたプレーヤーが勝ちとなってゲームが終了する、というルールのゲームです。  
 ゲームは必ず黒のプレーヤーから始めるものとします。  
 高橋君は、友達の青木君と五目並べをしていたのですが、うっかり居眠りをしてしまいました。  
 高橋君は寝ている間に青木君が不正をしたのではないかと疑っているので、盤面から五目並べの状態として異常なところがないかを探したいです。  
 五目並べの状態として、正常であるかどうか判定するプログラムを作ってください。  
 ここでの異常な状態とは、

- どちらかのプレーヤーの勝利条件を満たしているのに、もう片方のプレーヤーがさらに碁石を置いている。
- お互いが置いた個数がありえない状態になっている。
 
 のどちらかであることを指します。 入力は以下の形式で標準入力から与えられる。 > $ b_{1,1}\ b_{2,1}\ ‥‥\ b_{19,1} $ $ b_{1,2}\ b_{2,2}\ ‥‥\ b_{19,2} $ $ : $ $ : $ $ b_{1,19}\ b_{2,19}\ ‥‥\ b_{19,19} $

- 入力は $ 19 $ 行与えられる。
- $ i(1≦i≦19) $ 行目の $ j(1≦j≦19) $ 文字目には、盤面の縦 $ i $ 番目、横 $ j $ 番目のマスの情報を表す文字 $ b_{i,j} $ が与えられる。
- $ b_{i,j} $ は、`o`、`x`、`.` の $ 3 $ 種類のいずれかの文字である。 
  - `o` は、黒石が置かれていることを表す。
  - `x` は、白石が置かれていることを表す。
  - `.` は、何も置かれていないことを表す。


 盤面が正常な状態であれば、`YES`、そうでなければ `NO` と出力しなさい。   
 出力は標準出力におこない、末尾には改行をいれること。  
```

...................
...................
...................
...................
....x......o.......
...................
...................
.......o....o......
...................
........x..........
..............o....
...................
.......x...........
...................
...................
...................
...................
...................
...................
```

 ```

YES
```

- 黒が $ 4 $ 手、白が $ 3 $ 手打った状態です。
- （記述に誤りがありましたので、修正しました。）
 
```

...................
...................
...................
...................
....x......o.......
...................
...................
.......o....o......
...................
........x..........
..............o....
...................
.......x...........
...................
...................
.........o.........
...................
...................
...................
```

 ```

NO
```

- 黒が $ 5 $ 手、白が $ 3 $ 手打った状態です。
- 黒が $ 1 $ 手多く打ってしまっているので、異常な状態です。
 
```

...................
...................
...................
...................
...................
...................
...................
...................
........ooooo......
.........xxxx......
........x..........
...................
...................
...................
...................
...................
...................
...................
...................
```

 ```

NO
```

- 黒が $ 5 $ 手、白が $ 5 $ 手打った状態です。
- 片方が勝利条件を満たしていればゲームは終了しているので、黒が勝利条件を満たしているのは異常な状態です。
- （記述に間違いがありましたので、訂正しました。）
 
```

...................
...................
...................
...................
...................
...................
...................
...................
........ooooo......
.........xxxx......
...................
...................
...................
...................
...................
...................
...................
...................
...................
```

 ```

YES
```

- 黒が $ 5 $ 手、白が $ 4 $ 手打った状態です。
- 黒が $ 5 $ つ並べて勝利した状態となり、正常です。
 
```

...................
...................
...................
...................
...................
...................
...................
...................
.........x.........
......oooooo.......
........xxxx.......
...................
...................
...................
...................
...................
...................
...................
...................
```

 ```

YES
```

- 黒石が $ 6 $ つ並んでいますが、正常です。
- 例えば黒石が $ 2 $ つ並んでおり、$ 1 $ マス空いてさらに $ 3 $ つ並んでいる状態で、空いている真ん中のマスに黒石を置いた場合このような形になります。
 
```

...................
...................
...................
...................
...................
...................
........x..........
........x....x.....
...........x.......
...oooooooooo......
...................
......x......x.....
....x......x.......
.........x.........
...................
...................
...................
...................
...................
```

 ```

NO
```

- 黒が $ 10 $ 手、白が $ 9 $ 手打った状態です。
- 黒石を $ 10 $ 個並べる前に、黒が勝利してゲームが終了していないとおかしいので、異常な状態です。
 
```

...................
...................
...................
...................
...................
...................
...................
...................
...................
...................
...................
...................
...................
...................
...................
...................
...................
...................
...................
```

 ```

YES
```

- 黒が高橋君で、一手も打たないうちに居眠りしてしまった場合も、正常な状態です。



---

---
title: "[ARC013C] 笑いをとれるかな？"
layout: "post"
diff: 普及+/提高
pid: AT_arc013_3
tag: []
---

# [ARC013C] 笑いをとれるかな？

## 题目描述

新晋艺人组合「あっとこーだー」的高桥君和青木君将在一个地方电视节目中亮相。其中有一项非常受欢迎的游戏叫做「惊险☆哈瓦那辣椒游戏」。这个游戏的规则如下：

1. 两个玩家轮流从一个长方体豆腐中切下一部分，然后吃掉。
2. 谁吃到包含哈瓦那辣椒的部分谁就输。
3. 高桥君和青木君每次轮流切一块。
4. 豆腐中某些部分暗藏哈瓦那辣椒。
5. 游戏中可能会有多个豆腐。
6. 每个豆腐至少藏有一个哈瓦那辣椒。

因为高桥君和青木君都不擅长作出滑稽的表演，如果不小心吃到包含哈瓦那辣椒的部分，很可能会遭到观众的嘲笑。所以，他们都努力让对方吃到哈瓦那辣椒与自己出丑。于是，他们偷偷地从节目制作人那里了解到哈瓦那辣椒的具体位置。在双方都采取最佳策略的情况下，谁会先吃到哈瓦那辣椒输掉比赛呢？出于上帝视角的你决定只告诉高桥君结果。注意高桥君是先手，切割豆腐的方式如下：

- 只能从三个水平方向进行切割，不能斜切。
- 切割后每一块豆腐的边长必须是整数。
- 例如，一个 $2 \times 2 \times 2$ 的豆腐可以像图中那样进行切割。

输入数据格式如下：

\[ N\ X_1\ Y_1\ Z_1\ M_1\ x_{1,0}\ y_{1,0}\ z_{1,0}\ x_{1,1}\ y_{1,1}\ z_{1,1}\ :\ x_{1,M_1-1}\ y_{1,M_1-1}\ z_{1,M_1-1}\ \ \cdots \]

1. 第一行的数字表示豆腐的数量 $ N\ (1 \leq N \leq 1,000) $。
2. 对于每块豆腐，有三维尺寸 $X_i, Y_i, Z_i$：
   - $X_i$ 是第 $i$ 块豆腐的长。
   - $Y_i$ 是第 $i$ 块豆腐的宽。
   - $Z_i$ 是第 $i$ 块豆腐的高。
   - $ X_{i}, Y_{i}, Z_{i} $ 都是整数，并且范围在 $ 1 \leq X_{i}, Y_{i}, Z_{i} \leq 1,000,000,000 $。
3. $ M_i(1 \leq M_i \leq 100) $ 表示第 $i$ 块豆腐内藏的哈瓦那辣椒数目。
4. 接下来每一个坐标 $x_{i,j}, y_{i,j}, z_{i,j}$ 表示在第 $i$ 个豆腐中第 $j$ 个哈瓦那辣椒的位置：
   - 例如，坐标 $(1, 1, 1)$ 处放置哈瓦那辣椒时，它在豆腐中的位置如图所示。

输出要求如下：
- 如果高桥君能够获胜，输出`WIN`。
- 如果高桥君会输掉，输出`LOSE`。
- 输出结果后需要换行。

示例输入1：
```
1
2 3 3
1
1 1 1
```

示例输出1：
```
WIN
```

- 高桥君可以通过先切掉 $ x=0 $ 的豆腐部分，确保自己获胜。

示例输入2：
```
1
3 3 3
1
1 1 1
```

示例输出2：
```
LOSE
```

- 由于豆腐和哈瓦那辣椒的位置是对称的，无论高桥君怎么切，青木君都能通过对称位置的切割保证高桥君必输。

示例输入3：
```
2
4 4 4
1
1 1 1
4 4 4
1
2 2 2
```

示例输出3：
```
LOSE
```

- 两块豆腐形状相同，无论高桥君怎么切��青木君都能通过对称位置的切割保证高桥君必输。

 **本翻译由 AI 自动生成**



---

---
title: "[ARC014D] grepマスター"
layout: "post"
diff: 普及+/提高
pid: AT_arc014_4
tag: []
---

# [ARC014D] grepマスター

## 题目描述

高桥君对使用 `grep` 命令很在行。然而，由于很多人也擅长 `grep`，这已不足以证明他的特别之处。为了掌握新的技能，他正在研究 `grep` 命令的手册。

在 `grep` 命令中，有 `-B` 和 `-A` 选项。使用这些选项时，例如：

```sh
grep -B x -A y "needle" kakikomi.txt
```

这行命令会在文件 `kakikomi.txt` 中，不仅显示符合模式 `"needle"` 的行，还会显示该行前面的 `x` 行和后面的 `y` 行。如果文件没有足够的前后行数，就仅显示实际存在的行数。而且，每一行只会被显示一次，即使它被多个命中行所覆盖。关于这个行为，可以参考输出示例。

现在，已知道在某个模式下对文件 `kakikomi.txt` 执行 `grep` 命令后，得到了匹配的行号列表 $L_1, L_2, \ldots, L_n$。现在有 $m$ 个查询，每个查询给定 `x` 和 `y`。对每个查询，求出使用 `-B x -A y` 选项时，将会显示多少行。

### 输入格式

1. 输入的第一行包含三个整数：文件 `kakikomi.txt` 的总行数 $all (1 \leq all \leq 10^9)$，命中行数 $N (1 \leq N \leq \min(all, 10^5))$，以及查询数量 $M (1 \leq M \leq 10^5)$。
2. 接下来有 $N$ 行，每行包含一个整数 $L_i (1 \leq L_i \leq all)$，表示每个命中行的行号。
3. 接下来是 $M$ 行，每行包含两个整数 $x_i, y_i (0 \leq x_i, y_i \leq 10^9)$，表示查询中的 `x` 和 `y`。

### 输出格式

对于每一个查询 $(x, y)$，输出一行，表示使用 `-B x -A y` 选项时，将会显示的行数。在输出的最后要有一个换行符。

### 示例
#### 输入
```
7 2 3
2
4
1 1
3 0
3 4
```

#### 输出
```
5
4
7
```

#### 解释
- 匹配的行是第 2 行和第 4 行。
- 对于第一个查询 $x = 1, y = 1$，命中范围为第 1 到 3 行和第 3 到 5 行，加起来共 5 行。
- 对于第二个查询 $x = 3, y = 0$，命中范围为第 1 到 2 行和第 1 到 4 行，加起来共 4 行。
- 对于第三个查询 $x = 3, y = 4$，命中范围为第 1 到 6 行和第 1 到 7 行，加起来共 7 行。

#### 输入
```
100 5 5
3
18
24
57
90
1 8
27 0
15 16
22 3
2 2
```

#### 输出
```
46
80
98
79
25
```

通过这样的调整和润色，题目描述变得更加简明和易于理解，增强了中文阅读的流畅性。

 **本翻译由 AI 自动生成**



---

---
title: "[ARC018C] 席替え"
layout: "post"
diff: 普及+/提高
pid: AT_arc018_3
tag: []
---

# [ARC018C] 席替え

## 题目描述

我所在的学校每个班级的人数特别多，甚至有多达 $1,000,000$ 人的班级。我的班级也不例外。教室的座位排成 $N$ 行 $M$ 列的矩形，共有 $N \times M$ 名学生，每人拥有一张自己的桌子。

学校非常重视防灾意识，如果发生意外，教室后面的墙壁可以打开，让学生从这里避难。最近，学校决定让成绩好的学生优先撤离，所以我们班决定重新安排座位，让成绩好的学生坐得更靠后。具体来说，把最前面的一行称为第 $0$ 行，最左边的一列称为第 $0$ 列。位于第 $i$ 行第 $j$ 列的座位用 $(i, j)$ 表示，坐在这个位置的学生成绩用 $G[i][j]$ 表示。对于任意两个座位 $(a, b)$ 和 $(c, d)$，如果 $a > c$，则无论 $b, d$ 的值如何，必须满足 $G[a][b] \geq G[c][d]$。

学生可以自由移动到任意座位，但是不能有两个或更多学生坐在同一座位，也不能有空位。同时，桌子数量不能改变，仍保持 $N$ 行 $M$ 列的布局。

重新安排座位是好事，但由于人数众多，我们希望尽量减少所有学生移动的总距离。这里的移动距离是指从原座位到新座位的曼哈顿距离，即如果一个学生从 $(a, b)$ 移动到 $(c, d)$，则移动距离为 $|a - c| + |b - d|$。

给定所有学生在重新安排前的成绩数据，请计算所有学生的最小移动距离总和。

### 输入格式

- 第一行包含两个整数 $N$ 和 $M$，分别表示教室的行数和列数（$1 \le N, M \le 1,000$）。
- 第二行包含三个整数 $x_0$、$a$ 和 $p$，用来生成每位学生的初始成绩（$0 \le x_0, a \le 10^9$，$N \times M \le p \le 10^9$，$p$ 必为素数）。初始成绩通过递归式 $x_i = (x_{i-1} + a) \mod p$ 生成。在位置 $(i, j)$ 的学生成绩为 $x_{i \times M + j}$。

### 输出格式

输出所有学生移动距离最小总和。最后包括一个换行符。

### 数据范围和提示

- $1 \le N, M \le 1,000$
- $0 \le x_0, a \le 10^9$
- $N \times M \le p \le 10^9$ 且 $p$ 为素数

### 示例

#### 输入
```
2 3
1 2 59
```

#### 输出
```
0
```

#### 解释

重新安排座位前，学生的成绩如下：
```
1  3  5
7  9 11
```

各座位在自己后面（屏幕下方）没有比自己成绩更差的学生，因此无需重新安排。

#### 输入
```
2 3
6 55 59
```

#### 输出
```
2
```

#### 解释

重新安排座位前，学生的成绩如下：
```
6  2 57
53 49 45
```

交换座位 $(0, 2)$ 和 $(1, 2)$ 的学生即可。两者分别移动 1 个单位，总移动距离为 2。

#### 输入
```
4 5
15 25 79
```

#### 输出
```
26
```

#### 解释

重新安排座位前，学生的成绩如下：
```
15 40 65 11 36
61  7 32 57  3
28 53 78 24 49
74 20 45 70 16
```

符合条件的重新安排如：
```
15  7 16 11  3
28 20 32 24 36
53 40 45 57 49
74 61 65 70 78
```

 **本翻译由 AI 自动生成**



---

---
title: "[ARC021B] Your Numbers are XORed..."
layout: "post"
diff: 普及+/提高
pid: AT_arc021_2
tag: []
---

# [ARC021B] Your Numbers are XORed...

## 题目描述

有两个序列 $a$ 和 $b$。

已知序列 $b$ 的构造方法：
- 对于 $1 \le i < L$ 的情况，$b_i = a_i \operatorname{xor} a_{i + 1}$，其中 $\operatorname{xor}$ 表示异或；
- $b_L = a_L \operatorname{xor} a_1$。

给定序列 $b$ 的长度 $L$ ，以及序列 $b$，求序列 $a$，如果没有一个满足的序列 $a$，请输出`-1`。

如果你不知道什么是异或，请点[这个链接](https://baike.baidu.com/item/%E5%BC%82%E6%88%96/10993677)。

## 输入格式

第一行一个整数 $L$。

第二行到第 $L + 1$ 行，每行一个整数，代表 $b_i$。

## 输出格式

输出符合要求的 $a$ 数列，一行一个数，如果没有，输出`-1`。

## 说明/提示

对于 $100\%$ 的数据：
- $2 \le L \le 10^5$；
- $0 \le b_i < 2^{31}$。

## 样例 #1

### 输入

```
2

1

1
```

### 输出

```
0

1
```

## 样例 #2

### 输入

```
3

1

4

1
```

### 输出

```
-1
```

## 样例 #3

### 输入

```
3

1

2

3
```

### 输出

```
0

1

3
```



---

---
title: "[ARC022B] 細長いお菓子"
layout: "post"
diff: 普及+/提高
pid: AT_arc022_2
tag: []
---

# [ARC022B] 細長いお菓子

## 题目描述

### 题目简述



有一个长度为$N$的序列。



请从这个序列里面找出**满足全部的值都是不相同的**子序列。



请输出最长子序列的**这个长度**。

## 输入格式

第一行是一个正整数$N(1 \le N \le 10^5)$。



第二行是$N$个正整数用空格分隔，表示这个序列的全部的值。

## 输出格式

输出一个正整数，表示满足要求的最长子序列的长度

## 样例 #1

### 输入

```
7

1 2 1 3 1 4 4
```

### 输出

```
3
```

## 样例 #2

### 输入

```
1

100
```

### 输出

```
1
```



---

---
title: "[ARC022C] ロミオとジュリエット"
layout: "post"
diff: 普及+/提高
pid: AT_arc022_3
tag: []
---

# [ARC022C] ロミオとジュリエット

## 题目描述

[problemUrl]: https://atcoder.jp/contests/arc022/tasks/arc022_3

高橋王国には $ N $ 個の村があり、$ 1 $ から $ N $ の番号がついています。$ N-1 $ 組の村の間は道で繋がっていて、どの村と村の間も道をいくつか辿ることによって移動できるようになっています。

高橋王国に住んでいるロミオさんとジュリエット君が引っ越しをすることになりました。$ 2 $ 人はとても仲が悪いので出来るだけ離れた村に引っ越したいと思っています。あなたは、$ 2 $ 人がそれぞれどの村に引っ越せば $ 2 $ 人の住む村の間の距離が最大になるのかを計算してあげてください。ただし「村の間の距離」とは、片方の村からもう片方の村まで行くために通る必要のある道の本数であるとします。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ A_1 $ $ B_1 $ $ A_2 $ $ B_2 $ : $ A_{N-1} $ $ B_{N-1} $

- $ 1 $ 行目には、高橋王国にある村の個数を表す整数 $ N\ (2\ ≦\ N\ ≦\ 10^5) $ が与えられる。
- $ 2 $ 行目から $ N-1 $ 行では、村どうしをつなぐ道の情報が与えられる。このうち $ i $ 行目には、整数 $ A_i\ (1\ ≦\ A_i\ ≦\ N) $ と $ B_i\ (1\ ≦\ B_i\ ≦\ N) $ が空白区切りで書かれており、これは村 $ A_i $ と村 $ B_i $ を繋ぐ道があることを表す。

## 输出格式

$ 2 $ 人の住む村の間の距離が最大にするときに、ロミオさんが住むべき村とジュリエット君が住むべき村の番号を表す整数を空白区切りで $ 1 $ 行に出力せよ。出力の末尾に改行をいれること。答えが複数考えられる場合は、そのうちのいずれかを出力すれば良い。

## 说明/提示

### 部分点

この問題には部分点が設定されている。

- $ N\ ≦\ 1,000 $ を満たすテストケースすべてに正解した場合は $ 40 $ 点が与えられる。

### Sample Explanation 1

!\[\](/img/arc/022/3-1.png) この入力では、高橋王国は図のような構造をしている。 「10 5」と出力しても正解である。

### Sample Explanation 2

!\[\](/img/arc/022/3-2.png) この入力では、高橋王国は図のような構造をしている。 「2 3」「3 2」「2 4」「4 2」「3 4」と出力しても正解である。

## 样例 #1

### 输入

```
10

7 6

3 2

2 4

4 5

8 9

1 8

1 6

1 2

9 10
```

### 输出

```
5 10
```

## 样例 #2

### 输入

```
4

1 2

1 3

1 4
```

### 输出

```
4 3
```



---

---
title: "[ARC024B] 赤と黒の木"
layout: "post"
diff: 普及+/提高
pid: AT_arc024_2
tag: []
---

# [ARC024B] 赤と黒の木

## 题目描述

在红黑岛上生长着一种奇特的树，它们的颜色会在红色和黑色之间变化。这些树以一个圆圈的形式排列在岛上。

这种树具有独特的“平衡”特性：如果一棵树和它相邻的两棵树颜色相同，那么第二天这棵树的颜色会改变。具体来说，假设有三棵连续的树 $A, B, C$，它们的颜色分别为 $C_A, C_B, C_C$。如果当天三棵树的颜色都为红色，即 $C_A = C_B = C_C = $ 红色，那么第二天 $C_B$ 的颜色会变为黑色，反之亦然。

需要注意的是，这些树在“平衡”时，只根据当天自己的颜色情况来做决定，而不考虑邻居的变化。因此，即便经过一天，也可能出现三个连续的同色树（请参见示例）。在这种情况下，第二天也会继续“平衡”。

作为研究者，你已经观察到了由 $N$ 棵树组成的这个群体第一天的颜色分布。请你计算出经过多少天这些树的颜色才不再变化。

## 输入格式

输入格式如下：

> $ N $  
> $ color_1 $  
> $ color_2 $  
> ...  
> $ color_N $

- 第一行是树的数量 $N\ (3 \leq N \leq 10^5)$。
- 随后的 $N$ 行中，第 $i$ 行表示第 $i$ 棵树的颜色 $color_i\ (color_i = 0, 1)$。
- 如果 $color_i = 0$，则表示该树为黑色；如果 $color_i = 1$，则为红色。
- 树呈圆形排列，意味着第 $i$ 棵树与第 $i+1$ 棵树相邻，第 $N$ 棵树与第 $1$ 棵树相邻。

## 输出格式

输出所有树的颜色不再变化的那一天。如果这种情况永远不会出现，则输出 $-1$。

## 说明/提示

### 示例解释

#### 示例 1
如图所示，变化停留在第二天。
- 第一天，第 3 棵树与其相邻的树颜色相同，因此颜色改变。
- 从第二天开始，颜色不再变化。

#### 示例 2
如图所示。注意第 6 棵树和第 1 棵树是相邻的。
- 第一天，第 1、5 和 6 棵树因为与相邻树相同颜色，因此颜色改变。
- 第二天，第 6 棵树颜色改变。
- 从第三天开始，颜色不再变化。

#### 示例 3
所有树仅在全黑或全红两种状态间交替。


 **本翻译由 AI 自动生成**

## 样例 #1

### 输入

```
5

0

1

1

1

0
```

### 输出

```
2
```

## 样例 #2

### 输入

```
6

1

1

0

1

1

1
```

### 输出

```
3
```

## 样例 #3

### 输入

```
3

1

1

1
```

### 输出

```
-1
```



---

---
title: "[ARC025B] チョコレート"
layout: "post"
diff: 普及+/提高
pid: AT_arc025_2
tag: []
---

# [ARC025B] チョコレート

## 题目描述

有一块纵 $H$ 格，横 $W$ 格的巧克力。每一格要么是黑巧克力要么是白巧克力。黑巧克力之间、白巧克力之间没有共有的边。每一格的巧克力都有自己的浓度。以下是巧克力的一个例子（其中的数字表示巧克力浓度）。



![](https://arc025.contest.atcoder.jp/img/arc/025/2-1.png)



Imouto想从这块巧克力中取出一块长方形区域，将其熔化成为巧克力酱。Imouto很重视巧克力的口味，因此她希望取出的长方形区域中的白巧克力浓度合计值等于黑巧克力浓度合计值（如果没有使用黑/白巧克力，则浓度为 $0$ ）。



Imouto想知道满足条件的方案中，使用的巧克力格子数最大是多少。

## 输入格式

输入按以下形式：

$$ H \space W $$

$$ C_{1,1} \space C_{1,2} \space \dots \space C_{1,W} $$

$$ C_{2,1} \space C_{2,2} \space \dots \space C_{2,W} $$

$$ : $$

$$ C_{H,1} \space C_{H,2} \space \dots \space C_{H,W} $$



- 第 $1$ 行两个整数 $H(1 \le H \leq 100)$ 和 $W(1 \leq W \leq 100)$ 分别表示纵向格子数和横向格子数。

- 第 $2$ 行开始的 $H$ 行，为每个格子的浓度。每行为 $W$ 个以空格分开的非负整数。浓度 $C_{i,j}$ 满足 $(0 \leq C_{i,j} \leq 99)$ 。

## 输出格式

如果存在满足条件的方案，输出这些方案中使用格子数的最大值。如果不存在满足条件的方案，输出 '0' 。输出的末尾请换行。



## 样例解释

### 样例1解释

将如下图所示的纵 $2$ 格，横 $3$ 格的长方形取出。格子数为 $6$ ，黑白巧克力的浓度总和都为 $17$ ，故满足条件。



![](https://arc025.contest.atcoder.jp/img/arc/025/2-2.png)



### 样例2解释

注意：浓度为 $0$ 的情况也可能存在。



### 样例4解释

在此输入的情况下，不存在满足条件的方案。



### 样例5解释

注意：存在只选择黑白巧克力中一方的情况。

## 样例 #1

### 输入

```
3 4

4 6 2 5

3 5 6 7

2 5 5 6
```

### 输出

```
6
```

## 样例 #2

### 输入

```
2 2

4 0

7 3
```

### 输出

```
4
```

## 样例 #3

### 输入

```
2 3

0 0 0

1 2 3
```

### 输出

```
3
```

## 样例 #4

### 输入

```
3 3

1 2 3

6 5 4

7 8 9
```

### 输出

```
0
```

## 样例 #5

### 输入

```
1 5

0 1 2 3 4
```

### 输出

```
1
```



---

---
title: "[ARC027B] 大事な数なのでZ回書きまLた。"
layout: "post"
diff: 普及+/提高
pid: AT_arc027_2
tag: []
---

# [ARC027B] 大事な数なのでZ回書きまLた。

## 题目描述

有一个长度为 $N$ 的数字串 $S$。它现在被2个混有大写字母的字符串替代。

你需要找到有多少个数字串 $S$ ，可以符合以下条件：

> - 不含前导零；
>
> - 在给出的2个字符串中，可以把每一个大写字母都分别替换成一种数字，相同的字母替换为相同的数字；
>
> - 替换完成后，两个字符串都和这个字符串 $S$ 相等。

## 输入格式

输入共三行

- 第一行是一个整数 $ N\ (1\ ≦\ N\ ≦\ 18) $ ，代表长度。
- 接下来两行，分别各是一个长度为 $N$ 的字符串。它只包含了数字和大写字母。

## 输出格式

输出一个整数代表答案。**输出最后也要换行。**

## 样例 #1

### 输入

```
4

1XYX

1Z48
```

### 输出

```
1
```

## 样例 #2

### 输入

```
3

XXX

YYY
```

### 输出

```
9
```

## 样例 #3

### 输入

```
6

PRBLMB

ARC027
```

### 输出

```
90
```



---

---
title: "[ARC027C] 最高のトッピングにしような"
layout: "post"
diff: 普及+/提高
pid: AT_arc027_3
tag: []
---

# [ARC027C] 最高のトッピングにしような

## 题目描述

在我常去的一家餐馆里，用餐可以获得兑换券。

兑换券有两种类型：一种是提供额外功能的“特殊兑换券”，另一种是“普通兑换券”。

这家餐馆提供 $N$ 种配料，你可以用 $t_i$ 张票券换得每种配料 $i$。在组合兑换中，同一种配料不可重复获取。兑换时，尽管两种类型的兑换券等值，但需保证每种配料的兑换至少包含一张“特殊兑换券”。例如，若某种配料需要 4 张票券，有以下 4 种兑换组合：

- 1 张特殊兑换券和 3 张普通兑换券。
- 2 张特殊兑换券和 2 张普通兑换券。
- 3 张特殊兑换券和 1 张普通兑换券。
- 全用 4 张特殊兑换券。

每种配料都有各自的“快乐值”，用 $h_i$ 表示获取配料 $i$ 时的快乐值。

今天是个特别的日子，我希望通过合理利用现有的兑换券，最大化兑换配料带来的总快乐值。请设计一个程序，计算出在当前的票券和配料信息下，能够获取的最大快乐值。

## 输入格式

输入由标准输入提供，格式如下：

> $X$ $Y$ $N$ $t_1$ $h_1$ $t_2$ $h_2$ : $t_N$ $h_N$

- 第一行有两个整数 $X$ 和 $Y$（$1 \leq X \leq 300$，$0 \leq Y \leq 300$），分别表示初始持有的特殊兑换券数和普通兑换券数。
- 第二行有一个整数 $N$（$1 \leq N \leq 300$），表示配料种类数。
- 接下来的 $N$ 行中，每行包含两个整数 $t_i$ 和 $h_i$（$1 \leq t_i \leq 600$，$1 \leq h_i \leq 5,000,000$），分别表示配料 $i$ 需要的票券数和对应的快乐值。

## 输出格式

输出可能获得的最大快乐值，以一个整数形式输出。记得在最后加上换行。

## 说明/提示

### 部分得分

题目设有部分得分：

- 对于数据集 1，满足条件 $X \leq 50$，$Y \leq 50$，$N \leq 50$，$t_i \leq 100$ 的正确解答可以获得 30 分。
- 对于没有额外限制的通用数据集 2，正确解答可以获得 70 分。

### 样例解释

- 初始有 3 张特殊兑换券和 5 张普通兑换券。通过以下组合可以得到最大快乐值 100（即40 + 60）：
  - 使用 1 张特殊兑换券和 2 张普通兑换券兑换配料 2（需 3 张票券），获得快乐值 40。
  - 使用 2 张特殊兑换券和 3 张普通兑换券兑换配料 3（需 5 张票券），获得快乐值 60。
  这个组合用掉了 3 张特殊和 5 张普通兑换券，是可行的。

- 最优选择是获取配料 1 和配料 2。

- 选择配料 3，并留下一张票券，是最优解。

- 可以获取所有的配料。

 **本翻译由 AI 自动生成**

## 样例 #1

### 输入

```
3 5

4

3 30

3 40

5 60

7 80
```

### 输出

```
100
```

## 样例 #2

### 输入

```
3 3

4

3 30

3 40

5 60

7 80
```

### 输出

```
70
```

## 样例 #3

### 输入

```
1 5

4

3 30

3 40

5 60

7 80
```

### 输出

```
60
```

## 样例 #4

### 输入

```
6 12

4

3 30

3 40

5 60

7 80
```

### 输出

```
210
```



---

---
title: "[ARC028B] 特別賞"
layout: "post"
diff: 普及+/提高
pid: AT_arc028_2
tag: []
---

# [ARC028B] 特別賞

## 题目描述

[problemUrl]: https://atcoder.jp/contests/arc028/tasks/arc028_2

高橋君はプログラミングコンテストを行い、$ N $ 人の人が参加しました。賞品がないと物足りないのではないかと思った高橋君は「$ i $ 位以上の人のうち、$ K $ 番目に若い人」に特別賞を出すことにしました。参加者全員の年齢は分かっています。$ K $ の値はもう既に決めているのですが、$ i $ の値はまだ決めていません。$ i $ の値を決めるために高橋君は、$ K $ 以上 $ N $ 以下の整数 $ i $ それぞれについて誰が特別賞を取ることが出来るのかを計算してみることにしました。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ K $ $ X_1 $ $ X_2 $ ... $ X_N $

- $ 1 $ 行目には、コンテストに参加した人数を表した整数 $ N\ (1\ ≦\ N\ ≦\ 100,000) $ と、整数 $ K\ (1\ ≦\ K\ ≦\ N) $ が空白区切りで与えられる。
- $ 2 $ 行目には、参加者の年齢の情報を表す $ N $ 個の整数が空白区切りで与えられる。このうち $ i $ 番目の整数 $ X_i\ (1\ ≦\ X_i\ ≦\ N) $ は、順位が $ i $ 位の参加者の年齢が全参加者のうち $ X_i $ 番目に若いことを表す。ただし、$ p\ \neq\ q $ のとき $ X_p\ \neq\ X_q $ であることが保証される。

## 输出格式

$ N-K+1 $ 行に出力せよ。そのうち $ i $ 行目には、「$ i+K-1 $ 位以上の人のうち、$ K $ 番目に若い人」の順位を表す $ 1 $ つの整数を出力せよ。

## 说明/提示

### 部分点

この問題には部分点が設定されている。

- $ N\ ≦\ 1000 $ を満たすテストケースすべてに正解した場合は $ 40 $ 点が与えられる。

### Sample Explanation 1

以下は、出力の各行についての説明です。 - $ 1 $ 行目： $ 2 $ 位以上の人のうち $ 2 $ 番目に若い人は $ 2 $ 位の人です。 - $ 2 $ 行目： $ 3 $ 位以上の人のうち $ 2 $ 番目に若い人は $ 1 $ 位の人です。 - $ 3 $ 行目： $ 4 $ 位以上の人のうち $ 2 $ 番目に若い人は $ 3 $ 位の人です。 - $ 4 $ 行目： $ 5 $ 位以上の人のうち $ 2 $ 番目に若い人は $ 5 $ 位の人です。

## 样例 #1

### 输入

```
5 2

4 5 3 1 2
```

### 输出

```
2

1

3

5
```

## 样例 #2

### 输入

```
3 1

2 3 1
```

### 输出

```
1

1

3
```



---

---
title: "[ARC028C] 高橋王国の分割統治"
layout: "post"
diff: 普及+/提高
pid: AT_arc028_3
tag: []
---

# [ARC028C] 高橋王国の分割統治

## 题目描述

[problemUrl]: https://atcoder.jp/contests/arc028/tasks/arc028_3

高橋王国は $ N $ 個の町からなり、それぞれの町には $ 0 $ から $ N-1 $ までの番号がついています。また、２つの町を繋ぐ道が $ N-1 $ 本あり、どの町からどの町へもいくつかの道を使うことで辿り着けるようになっています。

高橋王国の王様である高橋君は、首都にする町を決めようとしています。高橋君は首都を決める参考にするために「バランス値」を計算してみることにしました。町 $ v $ を首都としたときの「バランス値」は、町 $ v $ を通らずに相互に通行可能である町の集合の最大の大きさです。

例えば、下の図の町 $ 1 $ を首都とした場合、{町 $ 0 $, 町 $ 4 $} や {町 $ 2 $} や {町 $ 3 $} などの町の集合において、町 $ 1 $ を通らずに相互に通行することが可能となっています。そのうち最も大きい集合は {町 $ 0 $, 町 $ 4 $} であり、その大きさは $ 2 $ であるため、町 $ 1 $ を首都としたときの「バランス値」は $ 2 $ となります。

 ![figure](https://cdn.luogu.com.cn/upload/vjudge_pic/AT_arc028_3/a2884d775d8d248a4b6d27c592f114eb88daf1ec.png)

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ p_1 $ $ p_2 $ : $ p_{N-1} $

- $ 1 $ 行目には、町の個数を表した整数 $ N\ (1\ ≦\ N\ ≦\ 100,000) $ が与えられる。
- $ 2 $ 行目からの $ N-1 $ 行では、道の情報が与えられる。このうち $ i $ 行目では１つの整数 $ p_i\ (0\ ≦\ p_i\ ≦\ i-1) $ が与えられる。これは、町 $ i $ と 町 $ p_i $ を繋ぐ道があることを表す。

## 输出格式

$ N $ 行に出力せよ。そのうち $ i $ 行目には、町 $ i-1 $ を首都としたときの「バランス値」を表す $ 1 $ つの整数を出力せよ。

## 说明/提示

### 部分点

この問題には部分点が設定されている。

- $ N\ ≦\ 1000 $ を満たすテストケースすべてに正解した場合は $ 30 $ 点が与えられる。

### Sample Explanation 1

このケースでの入力は、問題文中の図のような道の情報を表しています。

## 样例 #1

### 输入

```
5

0

1

1

0
```

### 输出

```
3

2

4

4

4
```

## 样例 #2

### 输入

```
3

0

0
```

### 输出

```
1

2

2
```



---

---
title: "[ARC033C] データ構造"
layout: "post"
diff: 普及+/提高
pid: AT_arc033_3
tag: []
---

# [ARC033C] データ構造

## 题目描述

[problemUrl]: https://atcoder.jp/contests/arc033/tasks/arc033_3

数の集合 $ S $ に対する以下のクエリを処理してください。

- タイプ $ 1 $ ： $ S $ に数 $ X $ を追加する。
- タイプ $ 2 $ ： $ S $ に含まれる数のうち $ X $ 番目に小さい数を答え、その数を $ S $ から削除する。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ Q $ $ T_1 $ $ X_1 $ $ T_2 $ $ X_2 $ : $ T_Q $ $ X_Q $

- $ 1 $ 行目には、クエリの個数を表す整数 $ Q\ (1\ ≦\ Q\ ≦\ 200,000) $ が与えられる。
- $ 2 $ 行目からの $ Q $ 行には、クエリの情報が与えられる。このうち $ i $ 行目では、$ 2 $ つの整数 $ T_i\ (1\ ≦\ T_i\ ≦\ 2),\ X_i\ (1\ ≦\ X_i\ ≦\ 200,000) $ が空白区切りで与えられる。これは、 
  - $ T_i\ =\ 1 $ の場合、「$ S $ に数 $ X_i $ を追加する」というクエリを表す。ただし、クエリを処理する前の $ S $ には $ X_i $ が含まれていないことが保証される。
  - $ T_i\ =\ 2 $ の場合、「$ S $ に含まれる数のうち $ X_i $ 番目に小さい数を答え、その数を $ S $ から削除する」というクエリを表す。ただし、クエリを処理する前の $ S $ に含まれる数の個数が $ X_i $ 個以上であることが保証される。

## 输出格式

タイプ $ 2 $ のクエリの個数を $ Q_2 $ とすると、出力は $ Q_2 $ 行からなる。このうち $ i $ 行目には、タイプ $ 2 $ のクエリのうち $ i $ 番目のものに対する答えを出力せよ。出力の末尾にも改行を入れること。

## 样例 #1

### 输入

```
5

1 11

1 29

1 89

2 2

2 2
```

### 输出

```
29

89
```

## 样例 #2

### 输入

```
12

1 8932

1 183450

1 34323

1 81486

1 127874

1 114850

1 55277

1 112706

2 3

1 39456

1 52403

2 4
```

### 输出

```
55277

52403
```



---

---
title: "[ARC034C] 約数かつ倍数"
layout: "post"
diff: 普及+/提高
pid: AT_arc034_3
tag: []
---

# [ARC034C] 約数かつ倍数

## 题目描述

[problemUrl]: https://atcoder.jp/contests/arc034/tasks/arc034_3

$ 2 $ 個の正整数 $ A,\ B $ が与えられる。 $ A! $ の約数であり、かつ $ B! $ の倍数でもあるような正整数の個数を $ 1,000,000,007 $ で割った余りを求めよ。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ A $ $ B $

- $ 1 $ 行目に、$ 2 $ 個の整数 $ A,\ B $ ($ 1\ ≦\ B\ ≦\ A\ ≦\ 10^9 $, $ A\ -\ B\ ≦\ 100 $) がスペース区切りで与えられる。

## 输出格式

題意を満たす正整数の個数を $ 1,000,000,007 $ で割った余りを $ 1 $ 行目に出力せよ。

末尾の改行を忘れないこと。

## 说明/提示

### 部分点

この問題には部分点が設定されている。

- $ 5 $ 点分のテストケースは $ 1\ ≦\ B\ ≦\ A\ ≦\ 15 $ を満たす。
- 別の $ 35 $ 点分のテストケースは $ 1\ ≦\ B\ ≦\ A\ ≦\ 10^6 $, $ A\ -\ B\ ≦\ 100 $ を満たす。

### Sample Explanation 1

正整数 $ n $ に対し、 $ n! $ は $ n $ の階乗 $ n\ ×\ (n\ -\ 1)\ ×\ (n\ -\ 2)\ ×\ ...\ ×\ 1 $ を表す。 $ 3!\ =\ 3\ ×\ 2\ ×\ 1\ =\ 6 $ の約数であり、かつ $ 2!\ =\ 2\ ×\ 1\ =\ 2 $ の倍数であるような正整数は $ 2, $ $ 6 $ の $ 2 $ 個存在する。

## 样例 #1

### 输入

```
3 2
```

### 输出

```
2
```

## 样例 #2

### 输入

```
15 4
```

### 输出

```
2592
```

## 样例 #3

### 输入

```
1000000 999900
```

### 输出

```
21398499
```

## 样例 #4

### 输入

```
1000000000 999999900
```

### 输出

```
745508745
```



---

---
title: "[ARC035C] アットコーダー王国の交通事情"
layout: "post"
diff: 普及+/提高
pid: AT_arc035_c
tag: []
---

# [ARC035C] アットコーダー王国の交通事情

## 题目描述

高桥君是 Atcoder 王国的国王。Atcoder 王国包括$N$个城市（编号$1$~$N$）和$m$条双向的道路。每条道路都有长度。对于 Atcoder 王国中的任意城市 [A,B]，都可以保证从$A$到$B$有多条道路。



高桥君认为，Atcoder人的幸福在很大程度上取决于交通的便利性。为了找出人们的幸福程度，他想找到所有可能城市之间最短路径长度的总和$S$。



如果城市i和j之间的最短路径的长度为 D(i,j)，则



![](https://cdn.luogu.com.cn/upload/vjudge_pic/AT1215/c6cb071ff4a2960ab2be46d08083e517ddb9f45e.png)



高桥先生正计划建造K条新道路作为公共项目。这样的建设可能会导致多于两条或两条直接连接城市的道路，在这种情况下，现有道路将不会被拆除，而是会被增加。



您的任务是按照给定的顺序建造一条新路，并编写一个程序来计算上述每种施工的S。

## 输入格式

第一行两个数$n$和$m$，分别表示城市数和道路数。  

接下来$2$~$m+1$行每行三个数$u,v,w$，表示有一条连接$u,v$城市的长度为w的路径。  

第$m+2$行一个数$k$，表示有$k$条新的路要修建。  

第$m+3$~$m+k+2$行每行三个数$x,y,z$，表示又要建一条连接$x,y$的长度为$z$的路径。

## 输出格式

输出$k$行，每行一个数，表示在修完第$i$条道路后的$S$。

## 样例 #1

### 输入

```
4 3

1 2 1

2 3 1

3 4 10

2

3 4 1

1 4 1
```

### 输出

```
10

8
```

## 样例 #2

### 输入

```
8 16

8 7 38

2 8 142

5 2 722

8 6 779

4 6 820

1 3 316

1 7 417

8 3 41

1 4 801

3 2 126

4 2 71

8 4 738

4 3 336

7 5 717

5 6 316

2 1 501

10

6 1 950

6 1 493

1 6 308

3 4 298

2 5 518

1 5 402

4 7 625

7 6 124

3 8 166

2 4 708
```

### 输出

```
13649

12878

11954

11954

11280

11058

11058

8099

8099

8099
```



---

---
title: "[ARC037C] 億マス計算"
layout: "post"
diff: 普及+/提高
pid: AT_arc037_c
tag: []
---

# [ARC037C] 億マス計算

## 题目描述

[problemUrl]: https://atcoder.jp/contests/arc037/tasks/arc037_c

高橋君は「$ N^2 $マス計算」で計算力をつけることにした。「$ N^2 $マス計算」は $ N $ 行 $ N $ 列の表を用意して行う。 $ i $ 行目の左端のマスのさらに左には数 $ a_i $ が書かれており、 $ j $ 列目の上端のマスのさらに上には数 $ b_j $ が書かれている。高橋君はこの表の $ i $ 行 $ j $ 列目 に $ a_i\ ×\ b_j $ の値を計算して書き込む。

すぐに解き終わってしまい退屈したので、高橋君は自分が書き込んだ $ N^2 $ 個の値を昇順に並べ替えることにした。並べ替えた結果小さい方から $ K $ 番目 ($ 1 $ 番から数える) に位置する値を求めよ。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ K $ $ a_1 $ $ a_2 $ .. $ a_N $ $ b_1 $ $ b_2 $ .. $ b_N $

- $ 1 $ 行目には、表の行数および列数 $ N $ ($ 1 $ $ ≦ $ $ N $ $ ≦ $ $ 30000 $) と求めるべき値の並べ替え後の位置 $ K $ ($ 1 $ $ ≦ $ $ K $ $ ≦ $ $ N^2 $) がスペース区切りで与えられる。
- $ 2 $ 行目には、表の各行 $ i $ ($ 1 $ $ ≦ $ $ i $ $ ≦ $ $ N $) について、その行の左端のマスよりさらに左に書かれた数 $ a_i $ ($ 1 $ $ ≦ $ $ a_i $ $ ≦ $ $ 10^9 $) がスペース区切りで与えられる。
- $ 3 $ 行目には、表の各列 $ j $ ($ 1 $ $ ≦ $ $ j $ $ ≦ $ $ N $) について、その列の上端のマスよりさらに上に書かれた数 $ b_j $ ($ 1 $ $ ≦ $ $ b_j $ $ ≦ $ $ 10^9 $) がスペース区切りで与えられる。

## 输出格式

標準出力に、高橋君が表に書き込んだ $ N^2 $ 個の値を昇順に並べ替えたとき小さい方から $ K $ 番目 ($ 1 $ 番から数える) に位置する値を出力し、末尾で改行せよ。

## 说明/提示

### 部分点

この問題には部分点が設定されている。

- $ 5 $ 点分のテストケースは $ 1 $ $ ≦ $ $ N $ $ ≦ $ $ 10 $ を満たす。

### Sample Explanation 1

!\[\](http://arc037.contest.atcoder.jp/img/arc/037/ljlefijfewkjfwefk/C\_sample1.png) 高橋君が書き込んだ値を昇順に並べ替えると $ 6,\ 9,\ 10,\ 15 $ となり、小さい方から $ 3 $ 番目の値は $ 10 $ となる。

### Sample Explanation 2

!\[\](http://arc037.contest.atcoder.jp/img/arc/037/ljlefijfewkjfwefk/C\_sample2.png) 高橋君が書き込んだ値を昇順に並べ替えると $ 1,\ 1,\ 2,\ 2,\ 2,\ 2,\ 2,\ 4,\ 4 $ となり、小さい方から $ 7 $ 番目の値は $ 2 $ となる。

## 样例 #1

### 输入

```
2 3

2 3

3 5
```

### 输出

```
10
```

## 样例 #2

### 输入

```
3 7

1 2 1

2 1 2
```

### 输出

```
2
```

## 样例 #3

### 输入

```
4 8

701687787 500872619 516391519 599949380

458299111 633119409 377269575 717229869
```

### 输出

```
317112176525562171
```



---

---
title: "[ARC038B] マス目と駒"
layout: "post"
diff: 普及+/提高
pid: AT_arc038_b
tag: []
---

# [ARC038B] マス目と駒

## 题目描述

[problemUrl]: https://atcoder.jp/contests/arc038/tasks/arc038_b

$ H $ 行 $ W $ 列のマス目とチェスの駒が $ 1 $ つあります。$ i\ (1\ ≦\ i\ ≦\ H) $ 行目 $ j\ (1\ ≦\ j\ ≦\ W) $ 列目のマスを、マス $ (i,j) $ と呼ぶことにします。このとき、左上のマスがマス $ (1,1) $ で右下のマスがマス $ (H,W) $ となっています。また、マス $ (1,1) $ 以外のいくつかのマスには障害物が置いてあります。ゲーム好きな兄妹がこのマス目と駒を使って以下のようなゲームをしようとしています。

- 最初、駒をマス $ (1,1) $ に置く。
- プレイヤーは自分のターンに、駒を $ 1 $ つ下か $ 1 $ つ右下か $ 1 $ つ右のマスのうち障害物のないいずれかのマスに動かさなければならない。つまり、駒がマス $ (i,j) $ にあるときは、マス $ (i+1,j) $ かマス $ (i+1,j+1) $ かマス $ (i,j+1) $ のうち障害物のないいずれかのマスに動かさなければならない。ただしこのとき、マス目の外に動かすことはできない。すなわち、$ i\ =\ H $ のときは下や右下には動かせず、$ j\ =\ W $ のときは右下や右には動かせない。
- 交互にターンを繰り返し、自分のターンに駒を動かせなくなったプレイヤーの負けとなる（もう一方のプレイヤーが勝ちとなる）。

$ 2 $ 人ともが勝ちを目指して最適な戦略をとったとき、先手と後手のどちらが勝つでしょうか？

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ H $ $ W $ $ S_{1,1} $$ S_{1,2} $..$ S_{1,W} $ $ S_{2,1} $$ S_{2,2} $..$ S_{2,W} $ : $ S_{H,1} $$ S_{H,2} $..$ S_{H,W} $

- $ 1 $ 行目には、$ 2 $ つの整数 $ H\ (1\ ≦\ H\ ≦\ 100),\ W\ (1\ ≦\ W\ ≦\ 100) $ が空白区切りで与えられる。これは、マス目の行数が $ H $、マス目の列数が $ W $ であることを表す。
- $ 2 $ 行目からの $ H $ 行には、マスの情報が与えられる。このうち $ i\ (1\ ≦\ i\ ≦\ H) $ 行目には、$ W $ 個の文字が与えられる。このうちの $ j\ (1\ ≦\ j\ ≦\ W) $ 個目の文字 $ S_{i,j} $ は、マス $ (i,j) $ の情報を表す `#` または `.` の文字である。`#` である場合はマス $ (i,j) $ に障害物があることを表し、`.` である場合はマス $ (i,j) $ に障害物がないことを表す。ただし、$ S_{1,1} $ は `.` であることが保証される。

## 输出格式

先手が勝つ場合は `First` を、後手が勝つ場合は `Second` を $ 1 $ 行に出力せよ。出力の末尾に改行を入れること。

## 说明/提示

### 部分点

この問題には部分点が設定されている。

- $ H\ ≦\ 4 $ かつ $ W\ ≦\ 4 $ を満たすデータセット $ 1 $ に正解した場合は、$ 30 $ 点が与えられる。
- 全てのテストケースに正解した場合は、上記とは別に $ 70 $ 点が与えられる。

### Sample Explanation 1

ゲームは、例えば以下のように進行します。`o` は駒の位置を表しています。 ``` o#. ... ``` - $ 1 $ ターン目：駒はマス $ (1,1) $ にあります。駒を下か右下に動かすことができます。先手は、駒を下に動かしました。 ``` .#. o.. ``` - $ 2 $ ターン目：駒はマス $ (2,1) $ にあります。駒は右にしか動かせません。後手は、駒を右に動かしました。 ``` .#. .o. ``` - $ 3 $ ターン目：駒はマス $ (2,2) $ にあります。駒は右にしか動かせません。先手は、駒を右に動かしました。 ``` .#. ..o ``` - $ 4 $ ターン目：駒はマス $ (2,3) $ にあります。後手は、駒を動かすことができないため負けとなります。 後手がどのように駒を動かしても、先手は適切な動かし方をすることによって勝つことができるため `First` を出力します。

### Sample Explanation 2

先手がどのように駒を動かしても、後手は適切な動かし方をすることによって勝つことができるため `Second` を出力します。

## 样例 #1

### 输入

```
2 3

.#.

...
```

### 输出

```
First
```

## 样例 #2

### 输入

```
4 4

....

...#

....

.#..
```

### 输出

```
Second
```

## 样例 #3

### 输入

```
11 44

............................................

............................................

............................................

.....#.....#####....####.....####....####...

....#.#....#....#..#....#...#....#..#....#..

....#.#....#....#..#.............#..#....#..

...#####...#####...#..........###....####...

...#...#...#....#..#.............#..#....#..

..#.....#..#....#..#....#...#....#..#....#..

..#.....#..#....#...####.....####....####...

............................................
```

### 输出

```
Second
```



---

---
title: "[ARC039B] 高橋幼稚園"
layout: "post"
diff: 普及+/提高
pid: AT_arc039_b
tag: []
---

# [ARC039B] 高橋幼稚園

## 题目描述

高桥先生是一名幼儿园老师。他决定给N个孩子发放K个糖果，每个孩子得到的糖果数都为整数个。

在这里，定义孩子们的整体幸福度为所有孩子得到的糖果的数量之乘积。

高桥先生发糖果时想尽量提高孩子们的整体幸福度，请你设计方案达到目的，并输出整体幸福度最高时的方案个数。（答案可能很大，请输出答案%1000000007的结果）

此题中，孩子们之间有差别，而糖果之间视为无差别。

** 请注意有孩子未分到糖果时乘积为零的情况（详见样例三）**

## 输入格式

保证由以下格式输入：

一行，两个正整数N(1<=N<=100)和K(1<=K<=500)（含义见描述），由空格隔开。

## 输出格式

一个数，即答案mod 1000000007的结果，并附加一个换行符。

# 输入输出样例

### 输入样例#1：

```

4 10

```

### 输出样例#1：

```

6

```

### 输入样例#2：

```

100 450

```

### 输出样例#2：

```

538992043

```

### 输入样例#3：

```

5 2

```

### 输出样例#3：

```

15

```

## 说明/提示

### **数据范围**

- 有80%数据满足N<=K

### **样例说明1**

这四个孩子中有两个人分到2颗糖果，两个人分到3颗糖果时整体幸福度最大，最大值为2×2×3×3=36.

分配方式有(3,3,2,2),(3,2,3,2),(3,2,2,3),(2,3,3,2),(2,3,2,3),(2,2,3,3) 共6种.

### **样例说明2**

注意答案取模1000000007

### **样例说明3**

无论你如何分发糖果，整体幸福度都为0。

## 样例 #1

### 输入

```
4 10
```

### 输出

```
6
```

## 样例 #2

### 输入

```
100 450
```

### 输出

```
538992043
```

## 样例 #3

### 输入

```
5 2
```

### 输出

```
15
```



---

---
title: "[ARC041C] ウサギ跳び"
layout: "post"
diff: 普及+/提高
pid: AT_arc041_c
tag: []
---

# [ARC041C] ウサギ跳び

## 题目描述

[problemUrl]: https://atcoder.jp/contests/arc041/tasks/arc041_c

$ L $ 個のマスが横一列に並んでいる。 マスの上には $ N $ 匹のウサギがいる。 $ i $ ($ 1≦i≦N $) 番目のウサギは、左から $ x_i $ 番目のマスにいる。 ただし、$ 1≦x_1\ <\ x_2\ <\ ..\ <\ x_N≦L $ を満たす。 また、ウサギはそれぞれ左向きまたは右向きである。

それぞれのウサギは、自分の $ 1 $ つ前にマスが存在し、そこに他のウサギがいなければ、ジャンプして自分の $ 1 $ つ前のマスへ移動できる。

ウサギがジャンプする順番を自由に選べるとき、ジャンプの総回数の最大値を求めよ。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ L $ $ x_1 $ $ d_1 $ $ x_2 $ $ d_2 $ : $ x_N $ $ d_N $

- $ 1 $ 行目には、ウサギの匹数 $ N $ ($ 1≦N≦10^5 $) とマスの個数 $ L $ ($ N≦L≦10^9 $) が空白区切りで与えられる。
- $ 2 $ 行目からの $ N $ 行には、ウサギの情報が与えられる。このうち $ i $ 行目には、$ i $ 番目のウサギの位置 $ x_i $ と向き $ d_i $ が空白区切りで与えられる。ただし、$ d_i $ は `L`（左向き）または `R`（右向き）である。
- $ 1≦x_1\ <\ x_2\ <\ ..\ <\ x_N≦L $ を満たす。

## 输出格式

ウサギがジャンプする順番を自由に選べるとき、ジャンプの総回数の最大値を $ 1 $ 行に出力せよ。 出力の末尾に改行を入れること。

## 说明/提示

### Sample Explanation 1

図のようにジャンプすればよい。 !\[\](https://arc041.contest.atcoder.jp/img/arc/041/qawsedrftgyhujikolp/rabbit\_1.png)

### Sample Explanation 2

図のようにジャンプすればよい。 !\[\](https://arc041.contest.atcoder.jp/img/arc/041/qawsedrftgyhujikolp/rabbit\_2.png)

### Sample Explanation 3

どのウサギもジャンプできない。

## 样例 #1

### 输入

```
1 5

1 R
```

### 输出

```
4
```

## 样例 #2

### 输入

```
4 5

1 R

3 L

4 L

5 L
```

### 输出

```
3
```

## 样例 #3

### 输入

```
4 10

1 L

5 R

6 L

10 R
```

### 输出

```
0
```



---

---
title: "[ARC042A] 掲示板"
layout: "post"
diff: 普及+/提高
pid: AT_arc042_a
tag: []
---

# [ARC042A] 掲示板

## 题目描述

[problemUrl]: https://atcoder.jp/contests/arc042/tasks/arc042_a

$ 1 $ から $ N $ までの番号がついたスレッドのある掲示板があります。 スレッドは書き込みがあると一番上に来ます。 書き込み前のスレッドは上から順に $ 1 $ から $ N $ の順に並んでいました。 $ M $ 個の書き込みが書き込まれた順で与えられるので、全ての書き込みが終わった後のスレッドの順番を出力してください。

例えば、$ 3 $ 個のスレッドがある掲示板に $ 2 $、$ 3 $、$ 1 $ の順で書き込みがあると、以下のようになります。

 ![](https://cdn.luogu.com.cn/upload/vjudge_pic/AT_arc042_a/bac8cb43a2c36713e87d6142d247ade9a4ca302d.png)

従って、書き込み後のスレッドの順番は $ 1 $、$ 3 $、$ 2 $ となります。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ M $ $ a_1 $ $ a_2 $ : $ a_M $

- $ 1 $ 行目には、スレッドの数と書き込みの数を表す $ 2 $ つの整数 $ N,\ M\ (1\ ≦\ N\ ≦\ 10^5,\ 1\ ≦\ M\ ≦\ 10^5) $ が空白区切りで与えられる。
- 続く $ M $ 行の $ i $ 行目には $ i $ 番目に書き込まれたスレッドを表す整数 $ a_i\ (1\ ≦\ a_i\ ≦\ N) $ が与えられる。

## 输出格式

全ての書き込みが終わった後のスレッドの番号を上から順に $ 1 $ 行ずつ出力せよ。

## 说明/提示

### 部分点

この問題には部分点が設定されている。

- $ 1\ ≦\ N\ ≦\ 100,\ 1\ ≦\ M\ ≦\ 100 $ を満たすデータセットに正解した場合は $ 30 $ 点が与えられる。

### Sample Explanation 1

$ 1 $ つめの書き込みの後、スレッドは上から $ 2 $、$ 1 $、$ 3 $ の順で並んでいる。 $ 2 $ つめの書き込みの後、スレッドは上から $ 3 $、$ 2 $、$ 1 $ の順で並んでいる。 $ 3 $ つめの書き込みの後、スレッドは上から $ 1 $、$ 3 $、$ 2 $ の順で並んでいる。

### Sample Explanation 2

元から $ 1 $ 番上にあったスレッド $ 1 $ にしか書き込みがなかったので、スレッドの順番は変わらない。

## 样例 #1

### 输入

```
3 3

2

3

1
```

### 输出

```
1

3

2
```

## 样例 #2

### 输入

```
3 3

1

1

1
```

### 输出

```
1

2

3
```

## 样例 #3

### 输入

```
10 10

3

1

4

1

5

9

2

6

5

3
```

### 输出

```
3

5

6

2

9

1

4

7

8

10
```



---

---
title: "[ARC042C] おやつ"
layout: "post"
diff: 普及+/提高
pid: AT_arc042_c
tag: []
---

# [ARC042C] おやつ

## 题目描述

[problemUrl]: https://atcoder.jp/contests/arc042/tasks/arc042_c

高橋くんは遠足に持って行くおやつを選んでいます。 この遠足には合計で $ P $ 円までのおやつを持って行くことができます。 ただし、担任のけんしょう先生はやさしいので、どの $ 1 $ つのおやつについても、そのおやつがなければ合計が $ P $ 円以下になるのであれば許してくれます。

例えば、$ 100 $ 円まで持って行くことができる時に、値段がそれぞれ $ 30 $ 円、$ 40 $ 円、$ 50 $ 円のおやつを持って行くと、どの $ 1 $ つのおやつを取り除いても合計が $ 100 $ 円以下になるので許してくれます。 しかし、$ 40 $ 円、$ 50 $ 円、$ 60 $円のおやつを持って行くと、$ 40 $ 円のおやつがなかったとしても合計は $ 110 $ 円となり $ 100 $ 円を超えているので、やさしいけんしょう先生もこれは許してくれません。

高橋くんが持って行きたいおやつは $ N $ 種類あり、それぞれに値段と満足度があります。 高橋くんはそれぞれの種類のおやつについて最大でも $ 1 $ つしか遠足に持って行きません。 けんしょう先生が許してくれるおやつの選び方のうち、満足度の合計が最も大きくなるように選んだ時の満足度の合計を求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ P $ $ a_1 $ $ b_1 $ $ a_2 $ $ b_2 $ : $ a_N $ $ b_N $

- $ 1 $ 行目には、高橋くんが持って行きたいおやつの種類と合計で持っていけるおやつの金額を表す $ 2 $ つの整数 $ N,\ P\ (1\ ≦\ N\ ≦\ 5,000,\ 1\ ≦\ P\ ≦\ 5,000) $ が空白区切りで与えられる。
- $ 2 $ 行目からの $ N $ 行には高橋くんの持って行きたいそれぞれおやつの値段と満足度を表す整数 $ a_i\ b_i\ (1\ ≦\ a_i\ ≦\ 100,\ 1\ ≦\ b_i\ ≦\ 100) $ が空白区切りで与えられる。

## 输出格式

けんしょう先生が許してくれるおやつの選び方のうち、満足度の合計が最も大きくなるように選んだ時の満足度の合計を $ 1 $ 行に出力せよ。

## 说明/提示

### 部分点

この問題には部分点が設定されている。

- $ 1\ ≦\ N\ ≦\ 100,\ 1\ ≦\ P\ ≦\ 100 $ を満たすデータセットに正解した場合は $ 50 $ 点が与えられる。

### Sample Explanation 1

$ 1 $ つ目と $ 2 $ つ目と $ 3 $ つ目のおやつを選ぶと満足度の合計が $ 190 $ となり、これがけんしょう先生が許してくれる選び方の中で最大である。

### Sample Explanation 3

この入力は部分点に含まれない。

## 样例 #1

### 输入

```
4 100

30 50

40 40

50 100

60 80
```

### 输出

```
190
```

## 样例 #2

### 输入

```
5 100

40 10

30 50

60 80

20 40

20 70
```

### 输出

```
200
```

## 样例 #3

### 输入

```
10 654

76 54

62 19

8 5

29 75

28 4

76 16

96 24

79 30

20 64

23 56
```

### 输出

```
347
```



---

---
title: "[ARC044B] 最短路問題"
layout: "post"
diff: 普及+/提高
pid: AT_arc044_b
tag: []
---

# [ARC044B] 最短路問題

## 题目描述

一个图有 $n$ 个顶点，每条边长度为 $1$，没有重边，满足从顶点 $1$ 到顶点 $i$ 的最短距离为 $A_i$。

计算符合条件的图总数。

------------

## 输入格式

第一行一个整数 $n$。

第二行 $n$ 个整数，分别为 $A_1$ 到 $A_n$。

## 输出格式

一行，一个整数，为符合条件的图总数 ${}\bmod1000000007$。

**样例解释**

第二，三组样例输出都是 $0$。

## 样例 #1

### 输入

```
4

0 1 1 2
```

### 输出

```
6
```

## 样例 #2

### 输入

```
4

0 1 2 0
```

### 输出

```
0
```

## 样例 #3

### 输入

```
3

1 1 2
```

### 输出

```
0
```

## 样例 #4

### 输入

```
17

0 1 1 2 2 4 3 2 4 5 3 3 2 1 5 4 2
```

### 输出

```
855391686
```



---

---
title: "[ARC046B] 石取り大作戦"
layout: "post"
diff: 普及+/提高
pid: AT_arc046_b
tag: []
---

# [ARC046B] 石取り大作戦

## 题目描述

高桥和青木决定使用 $N$ 个石头组成的石山来玩取石游戏。游戏规则如下：

- 玩家交替从山上取一块以上的石头。
- 取了最后的石头的玩家的胜利。

先手高桥君一次最多可以拿下 $A$ 个石头，而后手青木君一次最多可以取出 $B$ 个石头。你的工作就是当两个人采取最佳行动时，来判断获胜的玩家。

## 输入格式

输入三个正整数 $N,A,B$。

第一行中的整数 $N$ 表示石头数量。第二行是两个整数 $A,B$，表示高桥君和青木君第一次从山上取下的最大石头数。有空格分隔。

## 输出格式

如果先手高桥君赢了，输出 `Takahashi`；如果后手青木君赢了，输出 `Aoki`，输出后要换行。

## 说明/提示

$1\le N\le 10^9$

$1\le A,B\le 10^9$。

## 样例 #1

### 输入

```
5

3 3
```

### 输出

```
Takahashi
```

## 样例 #2

### 输入

```
4

3 3
```

### 输出

```
Aoki
```

## 样例 #3

### 输入

```
5

3 2
```

### 输出

```
Takahashi
```

## 样例 #4

### 输入

```
1000000000

1000000000 1
```

### 输出

```
Takahashi
```



---

---
title: "[ARC049B] 高橋ノルム君"
layout: "post"
diff: 普及+/提高
pid: AT_arc049_b
tag: []
---

# [ARC049B] 高橋ノルム君

## 题目描述

[problemUrl]: https://atcoder.jp/contests/arc049/tasks/arc049_b

高橋ノルム君の可能性は無限大です。高橋ノルムという名前の人物はこの世界にたくさんいます。

$ 2 $ 次元平面上に $ N $ 人の高橋ノルム君がいます。$ i(1≦i≦N) $ 人目の高橋ノルム君は座標 $ (x_i,y_i) $ にいます。 各高橋ノルム君には正整数定数 $ c_i $ が割り当てられており、$ i $ 人目の高橋ノルム君がある点 $ (X,Y) $ に移動するためには $ c_i* $max$ (\|x_i-X|,\|y_i-Y\|) $ の時間がかかります。

あなたの仕事は、全ての高橋ノルム君が一点に集まるために必要な最小の時間を求めることです。 ここで、一点に集まるために必要な最小の時間とは最も遅くその点に到着する高橋君の移動にかかった時間とします。

高橋ノルム君は一斉に動き出し、お互いに干渉せず動くものとします。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ x_1 $ $ y_1 $ $ c_1 $ $ x_2 $ $ y_2 $ $ c_2 $ : $ x_N $ $ y_N $ $ c_N $

- $ 1 $ 行目には、高橋ノルム君の数を表す整数 $ N\ (2≦N≦1,000) $ が与えられる。
- $ 2 $ 行目からの $ N $ 行のうち $ i\ (1≦i≦N) $ 行目には、$ i $ 人目の高橋君の二次元平面上の位置と定数を表す $ 3 $ つの整数 $ x_i,y_i,c_i\ (-10^5≦x_i,y_i≦10^5,1≦c_i≦1,000) $ が空白区切りで与えられる。
- 同じ座標に複数の高橋ノルム君がいることもあります。

## 输出格式

全ての高橋ノルム君が一点に集まるために必要な最小の時間を出力せよ。 絶対誤差または相対誤差が $ 10^{−4} $ 以下ならば正解となる。 出力の末尾には改行を入れること。

## 说明/提示

### 部分点

この問題には部分点が設定されている。

- 任意の $ i(1≦i≦N) $ について、$ c_i=1 $ を満たすデータセットに正解した場合は、$ 30 $ 点が与えられる。
- 追加制約のないデータセットに正解した場合は、上記とは別に $ 70 $ 点が与えられる。

### Sample Explanation 1

集合位置を $ (5,5) $ にすれば、5秒で2人ともその点に移動することができ、これが最小である。

## 样例 #1

### 输入

```
2

0 0 1

10 10 1
```

### 输出

```
5.000000000000000
```

## 样例 #2

### 输入

```
2

0 0 1

10 10 2
```

### 输出

```
6.666666666666667
```

## 样例 #3

### 输入

```
10

-27 -67 10

59 13 10

14 -15 9

-29 -84 7

-75 -2 2

-12 -74 5

77 31 9

40 64 8

-81 32 1

81 26 5
```

### 输出

```
582.222222222222222
```

## 样例 #4

### 输入

```
8

-81739 73917 446

42230 30484 911

79354 -50126 200

33440 -47087 651

-73 84114 905

79222 -53608 713

65194 -46284 685

81145 40933 47
```

### 输出

```
54924095.383189122374461
```



---

---
title: "[ARC051C] 掛け算"
layout: "post"
diff: 普及+/提高
pid: AT_arc051_c
tag: []
---

# [ARC051C] 掛け算

## 题目描述

[problemUrl]: https://atcoder.jp/contests/arc051/tasks/arc051_c

$ N $ 個の整数 $ a_1,\ a_2,\ ...,\ a_N $ が与えられるので、一番小さいものを $ A $ 倍する、という操作を $ B $ 回行います。

この結果できた整数たちを昇順に並べ、順番に出力してください。

ただし出力するときは、出力したい数を $ 10^9\ +\ 7 $ で割ったあまりを出力するようにしてください。

なお、$ 10^9+7 $ で割ったあまりを昇順に並べる、というわけではないことに注意してください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ A $ $ B $ $ a_1 $ $ a_2 $ ... $ a_N $

## 输出格式

$ N $ 行出力する。

$ i $ 行目には、並べ換えた後の $ i $ 番目の整数を $ 10^9+7 $ で割ったあまりを出力する。

## 说明/提示

### 制約

- $ 1\ ≦\ N\ ≦\ 50 $
- $ 1\ ≦\ a_i\ ≦\ 1,000,000,000 $
- $ 1\ ≦\ A,\ B\ ≦\ 1,000,000,000 $
- $ A $ は整数である

### Sample Explanation 2

操作の結果、$ 20000,\ 10000200001 $ の $ 2 $ つの整数ができます。$ 10^9+7 $ で割ったあまりを出力することに注意してください。

## 样例 #1

### 输入

```
3 10 3

1 99 10
```

### 输出

```
99

100

100
```

## 样例 #2

### 输入

```
2 100001 2

1 200000
```

### 输出

```
200000

199931
```

## 样例 #3

### 输入

```
10 123 1000000000

394632992 714094234 84420 5 3439891 3395 35 58 5001 730
```

### 输出

```
954804718

385989482

948741792

268211139

100694402

492858064

955116743

68100851

154525400

479209143
```



---

---
title: "[ARC052B] 円錐"
layout: "post"
diff: 普及+/提高
pid: AT_arc052_b
tag: []
---

# [ARC052B] 円錐

## 题目描述

三维空间( $xyz$ 空间)中有 $N$ 个 **互相不重合** 的圆锥漂浮着。

每个圆锥的底面都与 $yz$ 平面平行，顶点朝向 $x$ 轴正方向。

第 $i$ 个圆锥的底面的中心的 $x$ 坐标为 $X_i$ ，半径为 $R_i$ ，高为 $H_i$ 。

请回答 $Q$ 个如下的询问。
- 给出两个整数 $A,B$ 。请回答 $A \le x \le B$ 的空间里，这些圆锥共占了多少体积。

## 输入格式

输入按以下格式。
$$ N \space Q $$
$$ X_1 \space R_1 \space H_1 $$
$$ X_2 \space R_2 \space H_2 $$
$$ : $$
$$ X_N \space R_N \space H_N $$
$$ A_1 \space B_1 $$
$$ A_2 \space B_2 $$
$$ : $$
$$ A_Q \space B_Q $$

- 第 $1$ 行为表示圆锥个数的一个整数 $N$ 和表示询问个数的一个整数 $Q$ 。
- 从第 $2$ 行开始的 $N$ 行中的第 $i$ 行为第 $i$ 个圆锥的底面中心的 $x$ 坐标值 $X_i$ 和半径的长度 $R_i$ ，高度 $H_i$ 。
- 从 $N+2$ 行开始的 $Q$ 行中的第 $i$ 行为表示第 $i$ 个询问内容的 $A_i,B_i$ 。

## 输出格式

输出共 $Q$ 行。第 $i$ 行为第 $i$ 次询问的答案。输出和答案的误差不能超过 $10^{-3}$ 。另外，输出的末尾请换行。

## 说明/提示

数据范围见原题面最下方。另：输入的所有数据都为整数。

## 样例 #1

### 输入

```
10 10

3 3 3

2 1 1

5 2 3

1 5 6

2 9 3

4 6 12

11 18 5

4 15 25

0 2 3

1 1 7

0 1

0 2

0 10

3 10

0 100

3 8

1 5

2 9

3 4

6 9
```

### 输出

```
8.843002

80.992182

4173.878112

3865.997282

8512.668894

2882.971997

1227.377293

3629.490541

114.081013

1747.545749
```

## 样例 #2

### 输入

```
5 5

5 10 10

4 100 100

3 1000 1000

2 1000 1000

1 1000 1000

0 3

2 1000

4 314

3 217

5 432
```

### 输出

```
9409079.422279

3139502408.531295

2100737789.465234

1613523459.243475

2532621914.444282
```



---

---
title: "[ARC056B] 駐車場"
layout: "post"
diff: 普及+/提高
pid: AT_arc056_b
tag: []
---

# [ARC056B] 駐車場

## 题目描述

[problemUrl]: https://atcoder.jp/contests/arc056/tasks/arc056_b

駐車場で$ N $人が車を駐めようとしています。 駐車場は$ N $個の駐車スペースがあり$ 1 $から$ N $まで番号付けられています。また、$ 2 $つの駐車スペースを双方向に結ぶ道が$ M $本あり、$ i $番目の道は$ u_i $番目の駐車スペースと$ v_i $番目の駐車スペースを結んでいます。 駐車スペース$ S $は駐車場の入り口とつながっています。

$ i $番目の人は、どういうわけか$ i $番目の駐車スペースにしか車を駐めたくないようです。このため、駐車場の入り口から、まだ誰も車を駐めていない駐車スペースとそれらを結ぶ道を通って$ i $番目の駐車スペースに行くことができないとき、車を駐めずに帰ってしまいます。

$ 1 $番目の人から$ N $番目の人まで順番に駐車場にやってきます。最終的に駐車場に駐める人の番号を昇順に出力してください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ M $ $ S $ $ u_1 $ $ v_1 $ : $ u_M $ $ v_M $

## 输出格式

最終的に駐車場に駐める人の番号を昇順に$ 1 $行ずつ出力せよ。

## 说明/提示

### 制約

- $ 1\ ≦\ N,\ M\ ≦\ 2*10^5 $
- $ 1≦u_i,\ v_i≦N $
- $ u_i\ ≠\ v_i $
- $ 1\ ≦\ S\ ≦\ N $
- 全ての駐車スペースへは、入り口から道と駐車スペースを経由してたどり着くことができる

### 部分点

- $ M\ ≦\ 2,000 $ を満たすテストケース全てに正解した場合、部分点として$ 40 $点が与えられる。

### Sample Explanation 1

$ 1 $番目の車は、駐車スペース$ 1 $に行くことができるためそこに駐めます。 $ 2 $番目の車は、駐車スペース$ 2 $に行くことができるためそこに駐めます。 $ 3 $番目の車は、$ 2 $番目の車に塞がれ駐車スペース$ 3 $に行くことができないため、帰ります。

### Sample Explanation 2

!\[https://arc056.contest.atcoder.jp/img/arc/056/vafbafvasrf/imgB.png\](https://arc056.contest.atcoder.jp/img/arc/056/vafbafvasrf/imgB.png)青い円を空いている駐車スペース、赤い円を車のいる駐車スペースとすると、上図のような順番で駐車スペースが埋まっていき、$ 4 $番目の車は駐めることができません。

## 样例 #1

### 输入

```
3 3 2

1 2

2 3

1 3
```

### 输出

```
1

2
```

## 样例 #2

### 输入

```
5 6 5

1 5

3 5

3 2

4 1

1 2

4 3
```

### 输出

```
1

2

3

5
```

## 样例 #3

### 输入

```
5 5 5

1 4

4 3

3 2

2 5

5 1
```

### 输出

```
1

2

5
```



---

---
title: "[ABC045D] すぬけ君の塗り絵"
layout: "post"
diff: 普及+/提高
pid: AT_arc061_b
tag: []
---

# [ABC045D] すぬけ君の塗り絵

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc045/tasks/arc061_b

縦 $ H $ 行、横 $ W $ 列のマス目からなる盤があります。最初、どのマス目も白く塗られています。

すぬけ君が、このうち $ N $ マスを黒く塗りつぶしました。$ i $ 回目 ( $ 1\ \leq\ i\ \leq\ N $ ) に塗りつぶしたのは、 上から $ a_i $ 行目で左から $ b_i $ 列目のマスでした。

すぬけ君がマス目を塗りつぶした後の盤の状態について、以下のものの個数を計算してください。

- 各整数 $ j $ ( $ 0\ \leq\ j\ \leq\ 9 $ ) について、盤の中に完全に含まれるすべての $ 3 $ 行 $ 3 $ 列の連続するマス目のうち、黒いマスがちょうど $ j $ 個あるもの。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ H $ $ W $ $ N $ $ a_1 $ $ b_1 $ : $ a_N $ $ b_N $

## 输出格式

出力は $ 10 $ 行からなる。 $ j+1 $ 行目 ( $ 0\ \leq\ j\ \leq\ 9 $ ) には、盤の中に完全に含まれるすべての $ 3 $ 行 $ 3 $ 列の連続するマス目のうち、黒いマスがちょうど $ j $ 個あるものの 総数を出力せよ。

## 说明/提示

### 制約

- $ 3\ \leq\ H\ \leq\ 10^9 $
- $ 3\ \leq\ W\ \leq\ 10^9 $
- $ 0\ \leq\ N\ \leq\ min(10^5,H×W) $
- $ 1\ \leq\ a_i\ \leq\ H $ $ (1\ \leq\ i\ \leq\ N) $
- $ 1\ \leq\ b_i\ \leq\ W $ $ (1\ \leq\ i\ \leq\ N) $
- $ (a_i,\ b_i)\ \neq\ (a_j,\ b_j) $ $ (i\ \neq\ j) $

### Sample Explanation 1

!\[\](https://atcoder.jp/img/arc061/30326702be007759dce81231012a8353.png) この盤に含まれる $ 3×3 $ の正方形は全部で $ 6 $ 個ありますが、これらのうち $ 2 $ 個の内部には黒いマスが $ 3 $ 個、残りの $ 4 $ 個の内部には黒いマスが $ 4 $ 個含まれています。

## 样例 #1

### 输入

```
4 5 8

1 1

1 4

1 5

2 3

3 1

3 2

3 4

4 4
```

### 输出

```
0

0

0

2

4

0

0

0

0

0
```

## 样例 #2

### 输入

```
10 10 20

1 1

1 4

1 9

2 5

3 10

4 2

4 7

5 9

6 4

6 6

6 7

7 1

7 3

7 7

8 1

8 5

8 10

9 2

10 4

10 9
```

### 输出

```
4

26

22

10

2

0

0

0

0

0
```

## 样例 #3

### 输入

```
1000000000 1000000000 0
```

### 输出

```
999999996000000004

0

0

0

0

0

0

0

0

0
```



---

---
title: "[ABC046C] AtCoDeerくんと選挙速報"
layout: "post"
diff: 普及+/提高
pid: AT_arc062_a
tag: []
---

# [ABC046C] AtCoDeerくんと選挙速報

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc046/tasks/arc062_a

シカのAtCoDeerくんは選挙速報を見ています。選挙には二人の候補高橋くんと青木くんが出ています。速報では、現在の二人の得票数の比が表示されていますが、得票数そのものは表示されていません。AtCoDeerくんは $ N $ 回画面を見て、 $ i(1≦i≦N) $ 回目に見たときに表示されている比は $ T_i:A_i $ でした。ここで、AtCoDeerくんが選挙速報の画面を$ 1 $回目に見た段階で既にどちらの候補にも少なくとも一票は入っていたことがわかっています。 $ N $ 回目に画面を見たときの投票数(二人の得票数の和)として考えられるもののうち最小となるものを求めてください。ただし、得票数が途中で減ることはありません。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ T_1 $ $ A_1 $ $ T_2 $ $ A_2 $ $ : $ $ T_N $ $ A_N $

## 输出格式

$ N $ 回目に画面を見たときの投票数として考えられる最小値を出力せよ。

## 说明/提示

### 制約

- $ 1≦N≦1000 $
- $ 1≦T_i,A_i≦1000\ (1≦i≦N) $
- $ T_i $ と $ A_i $ は互いに素 $ (1≦i≦N) $
- 答えが $ 10^{18} $ 以下になることは保証されている

### Sample Explanation 1

二人の得票数が $ 2,3 $ -&gt; $ 3,3 $ -&gt; $ 6,4 $ と動くと投票数は $ 10 $ になって、これが最小値です。

### Sample Explanation 2

一度画面を見てからもう一度画面を見るまでに一票も入ってないことがありえます。

## 样例 #1

### 输入

```
3

2 3

1 1

3 2
```

### 输出

```
10
```

## 样例 #2

### 输入

```
4

1 1

1 1

1 5

1 100
```

### 输出

```
101
```

## 样例 #3

### 输入

```
5

3 10

48 17

31 199

231 23

3 2
```

### 输出

```
6930
```



---

---
title: "[ABC047D] 高橋君と見えざる手"
layout: "post"
diff: 普及+/提高
pid: AT_arc063_b
tag: []
---

# [ABC047D] 高橋君と見えざる手

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc047/tasks/arc063_b

$ N $ 個の町が一直線上に並んでいます。行商人の高橋君は町 $ 1 $ から出発し、リンゴの売買をしながら町 $ N $ へと向かいます。

はじめ高橋君は町 $ 1 $ におり、リンゴを $ 1 $ つも持っていません。高橋君は次のいずれかの行動を繰り返し行います。

- 移動: 町 $ i $ ($ i\ <\ N $) にいるとき、町 $ i\ +\ 1 $ へ移動する。
- リンゴの売買: リンゴを好きな個数だけ売買する。ここで、町 $ i $ ($ 1\ ≦\ i\ ≦\ N $) ではリンゴの買値も売値もともに $ A_i $ 円とする。ここで $ A_i $ は相異なる整数です。

$ 1 $ つの町で売買するリンゴの個数に制限はありませんが、旅の中で売買するリンゴの個数は合計で (買う個数と売る個数を合わせて) $ T $ 個以下にしなくてはなりません。

高橋君は旅の利益、すなわちリンゴを売った代金から買った代金を引いた値を最大にするように旅をするとします。旅が終わったときに持っていたリンゴの価値は考えず、旅の中で売買した金額だけを考えます。

この旅に先立って、青木君は任意の町 $ i $ に対して $ A_i $ を好きな非負整数 $ A_i' $ に変えるという操作を好きなだけ行うことができます。ただし、この操作は行うごとに $ |A_i\ -\ A_i'| $ のコストがかかります。操作後には異なる町の間でリンゴの値段が同じになっていても構いません。

青木君の目的はできるだけ少ない合計コストの操作で高橋君の利益を少なくとも $ 1 $ 円下げることです。合計コストの最小値を求めてください。

ただし、元の状態で高橋君が $ 1 $ 円以上の利益を上げられることは仮定して構いません。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ T $ $ A_1 $ $ A_2 $ $ ... $ $ A_N $

## 输出格式

高橋君の収益を少なくとも $ 1 $ 円下げるために必要な合計コストの最小値を出力せよ。

## 说明/提示

### 制約

- $ 1\ ≦\ N\ ≦\ 10^5 $
- $ 1\ ≦\ A_i\ ≦\ 10^9 $ ($ 1\ ≦\ i\ ≦\ N $)
- $ A_i $ は相異なる
- $ 2\ ≦\ T\ ≦\ 10^9 $
- 入力の状態では高橋君は $ 1 $ 円以上の利益を上げられることが保証される

### Sample Explanation 1

この入力の状態では、高橋君は次のようにして最大の利益である $ 150 $ 円を達成することができます。 1. 町 $ 1 $ から町 $ 2 $ へ移動する。 2. 町 $ 2 $ で $ 50 $ 円を支払い、リンゴを $ 1 $ 個買う。 3. 町 $ 2 $ から町 $ 3 $ へ移動する。 4. 町 $ 3 $ で $ 200 $ 円でリンゴを $ 1 $ 個売る。 たとえば、青木君が町 $ 2 $ のリンゴの値段を $ 50 $ 円から $ 51 $ 円に変えると、高橋君はどのようにしても $ 150 $ 円の利益を上げることができなくなります。すなわち、コスト $ 1 $ で高橋君の利益を少なくとも $ 1 $ 円下げることが可能であり、答えは $ 1 $ となります。 他にも、町 $ 3 $ のリンゴの値段を $ 200 $ 円から $ 199 $ 円に変えることでもコスト $ 1 $ で高橋君の利益を下げることが可能です。

## 样例 #1

### 输入

```
3 2

100 50 200
```

### 输出

```
1
```

## 样例 #2

### 输入

```
5 8

50 30 40 10 20
```

### 输出

```
2
```

## 样例 #3

### 输入

```
10 100

7 10 4 5 9 3 6 8 2 1
```

### 输出

```
2
```



---

---
title: "[ABC059C] Sequence"
layout: "post"
diff: 普及+/提高
pid: AT_arc072_a
tag: []
---

# [ABC059C] Sequence

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc059/tasks/arc072_a

長さ $ N $ の数列があり、$ i $ 番目の数は $ a_i $ です。 あなたは $ 1 $ 回の操作でどれか $ 1 $ つの項の値を $ 1 $ だけ増やすか減らすことができます。

以下の条件を満たすために必要な操作回数の最小値を求めてください。

- すべての$ i\ (1≦i≦n) $ に対し、第 $ 1 $ 項から第 $ i $ 項までの和は $ 0 $ でない
- すべての$ i\ (1≦i≦n-1) $ に対し、$ i $ 項までの和と $ i+1 $ 項までの和の符号が異なる

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ n $ $ a_1 $ $ a_2 $ $ ... $ $ a_n $

## 输出格式

必要な操作回数の最小値を出力せよ。

## 说明/提示

### 制約

- $ 2≦\ n\ ≦\ 10^5 $
- $ |a_i|\ ≦\ 10^9 $
- $ a_i $ は整数

### Sample Explanation 1

例えば、数列を $ 1,\ -2,\ 2,\ -2 $ に $ 4 $ 回の操作で変更することができます。この数列は $ 1,\ 2,\ 3,\ 4 $ 項までの和がそれぞれ $ 1,\ -1,\ 1,\ -1 $ であるため、条件を満たしています。

### Sample Explanation 2

はじめから条件を満たしています。

## 样例 #1

### 输入

```
4

1 -3 1 0
```

### 输出

```
4
```

## 样例 #2

### 输入

```
5

3 -6 4 -5 7
```

### 输出

```
0
```

## 样例 #3

### 输入

```
6

-1 4 3 2 -5 4
```

### 输出

```
8
```



---

---
title: "[ABC059D] Alice&Brown"
layout: "post"
diff: 普及+/提高
pid: AT_arc072_b
tag: []
---

# [ABC059D] Alice&Brown

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc059/tasks/arc072_b

AliceとBrownはゲームをするのが好きです。今日は以下のゲームを思いつきました。

$ 2 $つの山があり、はじめに$ X,\ Y $個の石が置かれています。 AliceとBrownは毎ターン以下の操作を交互に行い、操作を行えなくなったプレイヤーは負けとなります。

- 片方の山から $ 2i $ 個の石を取り、そのうち $ i $ 個の石を捨て、残りの $ i $ 個の石をもう片方の山に置く。ここで、整数 $ i\ (1≦i) $ の値は山に十分な個数の石がある範囲で自由に選ぶことができる。

Aliceが先手で、二人とも最適にプレイすると仮定したとき、与えられた $ X,\ Y $ に対しどちらのプレイヤーが勝つか求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ X $ $ Y $

## 输出格式

Aliceが勝つとき`Alice`と、Brownが勝つとき`Brown`と出力せよ。

## 说明/提示

### 制約

- $ 0≦\ X,\ Y\ ≦\ 10^{18} $

### Sample Explanation 1

Aliceは $ 2 $ 個石のある山から $ 2 $ 個取るしかありません。その結果、山の石の数はそれぞれ $ 0,\ 2 $ 個となり、Brownは $ 2 $ 個の石を取り、山の石の数はそれぞれ $ 1,\ 0 $ 個となります。 Aliceはこれ以上操作を行うことができないので、Brownの勝ちです。

## 样例 #1

### 输入

```
2 1
```

### 输出

```
Brown
```

## 样例 #2

### 输入

```
5 0
```

### 输出

```
Alice
```

## 样例 #3

### 输入

```
0 0
```

### 输出

```
Brown
```

## 样例 #4

### 输入

```
4 8
```

### 输出

```
Alice
```



---

---
title: "[ABC063D] Widespread"
layout: "post"
diff: 普及+/提高
pid: AT_arc075_b
tag: []
---

# [ABC063D] Widespread

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc063/tasks/arc075_b

あなたが散歩していると、突然 $ N $ 体の魔物が出現しました。それぞれの魔物は *体力* という値を持ち、$ i $ 体目の魔物の出現時の体力は $ h_i $ です。体力が $ 0 $ 以下となった魔物は直ちに消滅します。

幸い、あなたは熟練の魔法使いであり、爆発を引き起こして魔物を攻撃できます。一回の爆発では、以下のように魔物の体力を減らすことができます。

- 生存している魔物を一体選び、その魔物を中心に爆発を引き起こす。爆発の中心となる魔物の体力は $ A $ 減り、その他の魔物の体力はそれぞれ $ B $ 減る。ここで、$ A $ と $ B $ はあらかじめ定まった値であり、$ A\ >\ B $ である。

すべての魔物を消し去るためには、最小で何回の爆発を引き起こす必要があるでしょうか？

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ A $ $ B $ $ h_1 $ $ h_2 $ $ : $ $ h_N $

## 输出格式

すべての魔物を消し去るために必要な最小の爆発の回数を出力せよ。

## 说明/提示

### 制約

- 入力値はすべて整数である。
- $ 1\ <\ =\ N\ <\ =\ 10^5 $
- $ 1\ <\ =\ B\ <\ A\ <\ =\ 10^9 $
- $ 1\ <\ =\ h_i\ <\ =\ 10^9 $

### Sample Explanation 1

以下のようにして、$ 2 $ 回の爆発ですべての魔物を消し去ることができます。 - まず、体力が $ 8 $ の魔物を中心に爆発を引き起こす。$ 4 $ 体の魔物の体力はそれぞれ $ 3 $, $ 4 $, $ 1 $, $ -1 $ となり、最後の魔物は消滅する。 - 次に、残りの体力が $ 4 $ の魔物を中心に爆発を引き起こす。残っていた $ 3 $ 体の魔物の体力はそれぞれ $ 0 $, $ -1 $, $ -2 $ となり、すべての魔物が消滅する。

### Sample Explanation 2

それぞれの魔物を中心に $ 2 $ 回ずつ、合計で $ 4 $ 回の爆発を引き起こす必要があります。

## 样例 #1

### 输入

```
4 5 3

8

7

4

2
```

### 输出

```
2
```

## 样例 #2

### 输入

```
2 10 4

20

20
```

### 输出

```
4
```

## 样例 #3

### 输入

```
5 2 1

900000000

900000000

1000000000

1000000000

1000000000
```

### 输出

```
800000000
```



---

---
title: "[ARC075E] Meaningful Mean"
layout: "post"
diff: 普及+/提高
pid: AT_arc075_c
tag: []
---

# [ARC075E] Meaningful Mean

## 题目描述

**题目大意：**
给一个长度为N的整数序列{a},对于其一共N*(N+1)/2个的非空区间，求有多少个区间的平均数大于等于K。

## 输入格式

第一行两个数字分别为 N K
接下来N行 每行一个数字表示a[i]

## 输出格式

输出一个整数 代表有多少个区间的平均数大于等于K

## 说明/提示

输入的全部为整数

1 ≤ N ≤ 2×10^5

1 ≤ K ≤ 10^9

1 ≤ a[i] ≤ 10^9

## 样例 #1

### 输入

```
3 6

7

5

7
```

### 输出

```
5
```

## 样例 #2

### 输入

```
1 2

1
```

### 输出

```
0
```

## 样例 #3

### 输入

```
7 26

10

20

30

40

30

20

10
```

### 输出

```
13
```



---

---
title: "[ABC066D] 11"
layout: "post"
diff: 普及+/提高
pid: AT_arc077_b
tag: []
---

# [ABC066D] 11

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc066/tasks/arc077_b

$ 1,...,n $ の $ n $ 個の整数からなる長さ $ n+1 $ の数列 $ a_1,a_2,...,a_{n+1} $ が与えられます。 この数列には $ 1,...,n $ のどの整数もかならず $ 1 $ 回以上出現することが分かっています。

$ k=1,...,n+1 $ のそれぞれについて、与えられた数列の長さ $ k $ の（連続とは限らない）部分列の個数を求め、 $ 10^9+7 $ で割ったあまりを出力して下さい。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ n $ $ a_1 $ $ a_2 $ ... $ a_{n+1} $

## 输出格式

答えを $ n+1 $ 行に出力せよ。 $ k $ 行目には、長さ $ k $ の部分列の個数を $ 10^9+7 $ で割ったあまりを出力せよ。

## 说明/提示

### 注意

- $ 2 $ つの部分列が数列として同じであれば、元の数列での位置が異なっていたとしても、$ 1 $ 通りと数えます。
- 数列 $ a $ の長さ $ k $ の部分列とは、$ a $ の要素のうち $ k $ 個を選んで、 それらを順番を変えずに取り出して並べた数列のことを指します。 例えば、数列 $ 1,2,3,4,5 $ の長さ $ 3 $ の部分列には、 $ 1,3,5 $ や $ 1,2,3 $ などがあります。 一方で、$ 3,1,2 $ や $ 1,10,100 $ はこの数列の部分列ではありません。

### 制約

- $ 1\ \leq\ n\ \leq\ 10^5 $
- $ 1\ \leq\ a_i\ \leq\ n $
- $ 1,...,n $ のどの整数も必ず数列に出現する。
- $ n,a_i $ は整数である。

### Sample Explanation 1

長さ $ 1 $ の部分列は $ 1 $、$ 2 $、$ 3 $ の $ 3 $ 通りです。 長さ $ 2 $ の部分列は $ 1,1 $、$ 1,2 $、$ 1,3 $、$ 2,1 $、$ 2,3 $ の $ 5 $ 通りです。 長さ $ 3 $ の部分列は $ 1,1,3 $、$ 1,2,1 $、$ 1,2,3 $、$ 2,1,3 $ の $ 4 $ 通りです。 長さ $ 4 $ の部分列は $ 1,2,1,3 $ の $ 1 $ 通りです。

### Sample Explanation 2

長さ $ 1 $ の部分列は $ 1 $ の $ 1 $ 通りです。 長さ $ 2 $ の部分列は $ 1,1 $ の $ 1 $ 通りです。

### Sample Explanation 3

$ 10^9+7 $ で割ったあまりを出力することに注意して下さい。

## 样例 #1

### 输入

```
3

1 2 1 3
```

### 输出

```
3

5

4

1
```

## 样例 #2

### 输入

```
1

1 1
```

### 输出

```
1

1
```

## 样例 #3

### 输入

```
32

29 19 7 10 26 32 27 4 11 20 2 8 16 23 5 14 6 12 17 22 18 30 28 24 15 1 25 3 13 21 19 31 9
```

### 输出

```
32

525

5453

40919

237336

1107568

4272048

13884156

38567100

92561040

193536720

354817320

573166440

818809200

37158313

166803103

166803103

37158313

818809200

573166440

354817320

193536720

92561040

38567100

13884156

4272048

1107568

237336

40920

5456

528

33

1
```



---

---
title: "[ABC074D] Restoring Road Network"
layout: "post"
diff: 普及+/提高
pid: AT_arc083_b
tag: []
---

# [ABC074D] Restoring Road Network

## 题目描述

#### 题面翻译
曾经存在的高桥王国有N个城市，城市与城市之间用长度为正整数的无向道路连接。

现有一考古学家找到了一张N×N的表A，这张表代表了这N座城市两两之间的最短路。即表中的第u行第v列的值代表了从城市u到v的最短路长度。

问能否根据这张表，求出高桥王国的最小道路长度总和。

## 输入格式

第一行：N
下面是大小为N×N的表A

## 输出格式

一个整数，表示最小道路长度总和。如果无解，输出−1
#### 数据范围与约定
- 1 <= N <= 300
- 当 i != j 时，1 <= 表A中第i行第j列的值 == 表A中第j行第i列的值 <= 10^9
- 表A中第i行第i列的值为0
#### 样例1解释
- 从城市1到城市2有长度为1的直接道路
- 从城市2到城市3有长度为2的直接道路
- 从城市1到城市3无直接道路
#### 样例2解释
从城市1走到城市2要走长度为1的道路，从城市2走到城市3要走长度为1的道路，所以从城市1到城市3要走的距离为2，但表中是3，所以无解。

## 样例 #1

### 输入

```
3

0 1 3

1 0 2

3 2 0
```

### 输出

```
3
```

## 样例 #2

### 输入

```
3

0 1 3

1 0 1

3 1 0
```

### 输出

```
-1
```

## 样例 #3

### 输入

```
5

0 21 18 11 28

21 0 13 10 26

18 13 0 23 13

11 10 23 0 17

28 26 13 17 0
```

### 输出

```
82
```

## 样例 #4

### 输入

```
3

0 1000000000 1000000000

1000000000 0 1000000000

1000000000 1000000000 0
```

### 输出

```
3000000000
```



---

---
title: "[ABC081D] Non-decreasing"
layout: "post"
diff: 普及+/提高
pid: AT_arc086_b
tag: []
---

# [ABC081D] Non-decreasing

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc081/tasks/arc086_b

すぬけ君は長さ $ N $ の数列 $ a $ を持っています。$ a $ の ($ 1 $-indexedでの) $ i $ 番目の数は $ a_{i} $ です。

すぬけ君は以下の操作を何度でも行うことができます。

- 操作：$ 1 $ 以上 $ N $ 以下の整数 $ x,y $ を選び、$ a_y $ に $ a_x $ を加算する。

すぬけ君はこの操作を $ 0 $ 回以上 $ 2N $ 回以下行って $ a $ が下記の条件を満たすようにしたいです。そのような操作手順の一例を示してください。 なお、この問題の制約下で、条件を満たすような操作の手順が必ず存在することが証明できます。

- 条件：$ a_1\ \leq\ a_2\ \leq\ ...\ \leq\ a_{N} $

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ a_1 $ $ a_2 $ $ ... $ $ a_{N} $

## 输出格式

操作回数(これを $ m $ とする)を $ 1 $ 行目に出力せよ。 続く $ m $ 行のうち $ i $ 行目には $ i $ 番目の操作で選んだ数 $ x,y $ を空白区切りで出力せよ。 $ m $ が $ 0 $ 以上 $ 2N $ 以下であり、$ m $ 回の操作後に $ a $ が条件を満たしていれば正解となる。

## 说明/提示

### 制約

- $ 2\ \leq\ N\ \leq\ 50 $
- $ -10^{6}\ \leq\ a_i\ \leq\ 10^{6} $
- 与えられる入力は全て整数

### Sample Explanation 1

\- $ 1 $ 番目の操作により $ a\ =\ (-2,5,4) $ となります - $ 2 $ 番目の操作により $ a\ =\ (-2,5,8) $ となり、条件を満たします

### Sample Explanation 2

\- $ 1 $ 番目の操作により $ a\ =\ (-4,-3) $ となり、条件を満たします

### Sample Explanation 3

\- すでに条件を満たしています

## 样例 #1

### 输入

```
3

-2 5 -1
```

### 输出

```
2

2 3

3 3
```

## 样例 #2

### 输入

```
2

-1 -3
```

### 输出

```
1

2 1
```

## 样例 #3

### 输入

```
5

0 0 0 0 0
```

### 输出

```
0
```



---

---
title: "[ABC082D] FT Robot"
layout: "post"
diff: 普及+/提高
pid: AT_arc087_b
tag: []
---

# [ABC082D] FT Robot

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc082/tasks/arc087_b

二次元平面の原点にロボットが置かれています。 最初、ロボットは $ x $ 軸の正の向きを向いています。

このロボットに命令列 $ s $ が与えられます。 $ s $ は次の $ 2 $ 文字のみからなり、先頭から末尾まで順に実行されます。

- `F` : 今向いている向きに長さ $ 1 $ だけ移動する。
- `T` : 時計回りまたは反時計回りの好きな方向に $ 90 $ 度だけ向きを変える。

ロボットの目標は、命令列をすべて実行し終わった後に座標 $ (x,\ y) $ にいることです。 この目標が達成可能か判定してください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ s $ $ x $ $ y $

## 输出格式

目標が達成可能ならば `Yes` を出力し、達成不可能ならば `No` を出力せよ。

## 说明/提示

### 制約

- $ s $ は `F`, `T` のみからなる。
- $ 1\ \leq\ |s|\ \leq\ 8\ 000 $
- $ x $, $ y $ は整数である。
- $ |x|,\ |y|\ \leq\ |s| $

### Sample Explanation 1

$ 1 $ 番目の `T` で反時計周りに $ 90 $ 度だけ向きを変え、$ 2 $ 番目の `T` で時計周りに $ 90 $ 度だけ向きを変えればよいです。

### Sample Explanation 2

$ 1 $ 番目の `T` で時計周りに $ 90 $ 度だけ向きを変え、$ 2 $ 番目の `T` で時計周りに $ 90 $ 度だけ向きを変えればよいです。

### Sample Explanation 5

例えば、$ 1 $ 番目の `T` で反時計周りに $ 90 $ 度だけ向きを変え、$ 2 $ 番目の `T` で反時計周りに $ 90 $ 度だけ向きを変えればよいです。

## 样例 #1

### 输入

```
FTFFTFFF

4 2
```

### 输出

```
Yes
```

## 样例 #2

### 输入

```
FTFFTFFF

-2 -2
```

### 输出

```
Yes
```

## 样例 #3

### 输入

```
FF

1 0
```

### 输出

```
No
```

## 样例 #4

### 输入

```
TF

1 0
```

### 输出

```
No
```

## 样例 #5

### 输入

```
FFTTFF

0 0
```

### 输出

```
Yes
```

## 样例 #6

### 输入

```
TTTT

1 0
```

### 输出

```
No
```



---

---
title: "[ABC092D] Grid Components"
layout: "post"
diff: 普及+/提高
pid: AT_arc093_b
tag: []
---

# [ABC092D] Grid Components

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc092/tasks/arc093_b

$ 2 $ つの整数 $ A,\ B $ が与えられます。

各マスが白または黒に塗られたグリッドであって以下の条件を満たすものを、出力の項で指定されたフォーマットに従って一つ出力してください。

- グリッドの大きさを縦 $ h $ 行横 $ w $ 列としたとき、$ h $ および $ w $ はともに $ 100 $ 以下である。
- 白く塗られたマスの集合はちょうど $ A $ 個の連結成分に分かれている (連結成分という単語の定義については後の注釈を参照)。
- 黒く塗られたマスの集合はちょうど $ B $ 個の連結成分に分かれている。

制約の項で指定される条件のもとで解は必ず一つ以上存在することが証明できます。 解が複数ある場合、どれを出力しても構いません。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ A $ $ B $

## 输出格式

以下の形式で出力せよ。

- $ 1 $ 行目には構成したグリッドの大きさを表す整数 $ h,\ w $ を空白を区切りとして出力せよ。
- 続いて $ h $ 行出力せよ。このうちの $ i $ 行目 ($ 1\ \leq\ i\ \leq\ h $) には以下のような長さ $ w $ の文字列 $ s_i $ を出力せよ。
  - 構成したグリッドの $ i $ 行 $ j $ ($ 1\ \leq\ j\ \leq\ w $) 列のマスが白く塗られているならば、$ s_i $ の $ j $ 文字目は `.` である。
  - 構成したグリッドの $ i $ 行 $ j $ ($ 1\ \leq\ j\ \leq\ w $) 列のマスが黒く塗られているならば、$ s_i $ の $ j $ 文字目は `#` である。

## 说明/提示

### 注釈

$ 2 $ つの白く塗られたマス $ c_1,\ c_2 $が連結であるとは、マス $ c_1 $ からマス $ c_2 $ へ、上下左右に隣り合うマスへの移動を繰り返して、 白く塗られたマスだけを通って移動できることを意味します。

白く塗られたマスの集合 $ S $ が連結成分であるとは、$ S $ が以下の条件を満たすことを意味します。

- $ S $ のどの $ 2 $ つのマスも連結である。
- $ S $ に含まれないどの白く塗られたマスと、$ S $ に含まれるどのマスも連結ではない。

黒く塗られたマスについても連結成分を同様に定義します。

### 制約

- $ 1\ \leq\ A\ \leq\ 500 $
- $ 1\ \leq\ B\ \leq\ 500 $

### Sample Explanation 1

この出力は以下のグリッドに対応します。 !\[2701558bf42f7c088abad927b419472a.png\](https://img.atcoder.jp/arc093/2701558bf42f7c088abad927b419472a.png)

## 样例 #1

### 输入

```
2 3
```

### 输出

```
3 3

##.

..#

#.#
```

## 样例 #2

### 输入

```
7 8
```

### 输出

```
3 5

#.#.#

.#.#.

#.#.#
```

## 样例 #3

### 输入

```
1 1
```

### 输出

```
4 2

..

#.

##

##
```

## 样例 #4

### 输入

```
3 14
```

### 输出

```
8 18

..................

..................

....##.......####.

....#.#.....#.....

...#...#....#.....

..#.###.#...#.....

.#.......#..#.....

#.........#..####.
```



---

---
title: "[ABC093D] Worst Case"
layout: "post"
diff: 普及+/提高
pid: AT_arc094_b
tag: []
---

# [ABC093D] Worst Case

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc093/tasks/arc094_b

高橋君を含めた $ 10^{10^{10}} $ 人の参加者が $ 2 $ 回のプログラミングコンテストに参加しました。 各コンテストでは全員に $ 1 $ 位から $ 10^{10^{10}} $ 位までの相異なる順位がつきました。

参加者のスコアとは、$ 2 $ 回のコンテストでの順位を掛け合わせた値です。

次のクエリ $ Q $ 個に答えてください。

- $ i $ 個目のクエリでは、$ 2 $ つの正の整数 $ A_i,B_i $ が与えられる。高橋君が $ 1 $ 回目のコンテストで $ A_i $ 位、$ 2 $ 回目のコンテストで $ B_i $ 位を取ったと仮定して、高橋君よりスコアの小さい参加者の人数の最大値を求めよ。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ Q $ $ A_1 $ $ B_1 $ $ : $ $ A_Q $ $ B_Q $

## 输出格式

クエリごとに、高橋君よりスコアの小さい参加者の人数の最大値を出力せよ。

## 说明/提示

### 制約

- $ 1\ \leq\ Q\ \leq\ 100 $
- $ 1\leq\ A_i,B_i\leq\ 10^9(1\leq\ i\leq\ Q) $
- 入力はすべて整数である

### Sample Explanation 1

$ 1 $ 回目のコンテストで $ x $ 位を、$ 2 $ 回目のコンテストで $ y $ 位を取った参加者を $ (x,y) $ で表すことにします。 $ 1 $ つめのクエリでは、高橋君よりスコアの小さい参加者として $ (2,1) $ が考えられます。$ 2 $ 人以上のスコアが高橋君のスコアより小さくなることはないため、$ 1 $ を出力します。

## 样例 #1

### 输入

```
8

1 4

10 5

3 3

4 11

8 9

22 40

8 36

314159265 358979323
```

### 输出

```
1

12

4

11

14

57

31

671644785
```



---

---
title: "[ABC095D] Static Sushi"
layout: "post"
diff: 普及+/提高
pid: AT_arc096_b
tag: []
---

# [ABC095D] Static Sushi

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc095/tasks/arc096_b

日本料理店「停止寿司」は円形のカウンターが一つあるだけのシンプルな店です。カウンターの外周の長さは $ C $ メートルで、カウンターの内部に客が立ち入ることはできません。

中橋くんが入店し、カウンターのそばまで案内されました。いま、カウンター上には $ N $ 貫の寿司が置かれています。そのうち $ i $ 貫目は中橋くんがいる位置から $ x_i $ メートル時計回りに進んだ位置に置かれており、$ v_i $ キロカロリーの栄養価を持ちます。

中橋くんはカウンターの外周を自由に歩き回ることができます。寿司が置かれている位置にたどり着いたら、その寿司を食べて寿司が持つ栄養価を摂取することができます（当然、その寿司は消えます）。ただし、歩く際に $ 1 $ メートルあたり $ 1 $ キロカロリーを消費します。

満足したら、いつでも好きな位置から店を出ることができます（始めにいた位置に戻らなくても構いません）。店を出るまでに最大で差し引き何キロカロリーを摂取することができるでしょうか？すなわち、退店するまでに摂取した栄養価の合計から消費したエネルギーを引いた値の最大値はいくらでしょうか？なお、他に客はおらず、新たな寿司がカウンターに追加されることもないものとします。また、中橋くんは十分な栄養を蓄えているため、どれだけ歩いてエネルギーを消費しても餓死しないものとします。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ C $ $ x_1 $ $ v_1 $ $ x_2 $ $ v_2 $ $ : $ $ x_N $ $ v_N $

## 输出格式

退店するまでに差し引きで最大 $ c $ キロカロリーを摂取できるとき、$ c $ の値を出力せよ。

## 说明/提示

### 制約

- $ 1\ <\ =\ N\ <\ =\ 10^5 $
- $ 2\ <\ =\ C\ <\ =\ 10^{14} $
- $ 1\ <\ =\ x_1\ <\ x_2\ <\ ...\ <\ x_N\ <\ C $
- $ 1\ <\ =\ v_i\ <\ =\ 10^9 $
- 入力中のすべての値は整数である。

### 部分点

- $ N\ <\ =\ 100 $ を満たすテストセットに正解すると、$ 300 $ 点が与えられる。

### Sample Explanation 1

外周 $ 20 $ メートルのカウンターに $ 3 $ 貫の寿司が置かれています。中橋くんの始めの位置から時計回りに $ 2 $ メートル歩くと、$ 80 $ キロカロリーの寿司を食べることができます。さらに時計回りに $ 7 $ メートル歩くと、$ 120 $ キロカロリーの寿司を食べることができます。ここで退店すると、摂取した栄養価の合計は $ 200 $ キロカロリー、消費したエネルギーの合計は $ 9 $ キロカロリーで、差し引き $ 191 $ キロカロリーを摂取することができ、これが最大の値です。

### Sample Explanation 2

$ 2 $ 貫目と $ 3 $ 貫目の寿司の位置が入れ替わりました。再び、中橋くんの始めの位置から時計回りに $ 2 $ メートル歩くと、$ 80 $ キロカロリーの寿司を食べることができます。今回はここで向きを変え、反時計回りに $ 6 $ メートル歩くと、$ 120 $ キロカロリーの寿司を食べることができます。ここで退店すると、摂取した栄養価の合計は $ 200 $ キロカロリー、消費したエネルギーの合計は $ 8 $ キロカロリーで、差し引き $ 192 $ キロカロリーを摂取することができ、これが最大の値です。

### Sample Explanation 3

唯一の寿司が $ 32 $ bit 整数に収まらないほど遠くにあるわりに栄養価が低いため、何もせず直ちに退店するべきです。

### Sample Explanation 4

以上のすべての入力例は、部分点のためのテストセットに含まれます。

## 样例 #1

### 输入

```
3 20

2 80

9 120

16 1
```

### 输出

```
191
```

## 样例 #2

### 输入

```
3 20

2 80

9 1

16 120
```

### 输出

```
192
```

## 样例 #3

### 输入

```
1 100000000000000

50000000000000 1
```

### 输出

```
0
```

## 样例 #4

### 输入

```
15 10000000000

400000000 1000000000

800000000 1000000000

1900000000 1000000000

2400000000 1000000000

2900000000 1000000000

3300000000 1000000000

3700000000 1000000000

3800000000 1000000000

4000000000 1000000000

4100000000 1000000000

5200000000 1000000000

6600000000 1000000000

8000000000 1000000000

9300000000 1000000000

9700000000 1000000000
```

### 输出

```
6500000000
```



---

---
title: "[ABC102D] Equal Cut"
layout: "post"
diff: 普及+/提高
pid: AT_arc100_b
tag: []
---

# [ABC102D] Equal Cut

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc102/tasks/arc100_b

すぬけ君は、長さ $ N $ の整数列 $ A $ を持っています。

すぬけ君は $ A $ を $ 3 $ 箇所で切って、$ 4 $ つの（空でない）連続する部分列 $ B,C,D,E $ に分解します。 切る位置は自由に選ぶことができます。

ここで、整数列 $ B,C,D,E $ について、その要素の総和をそれぞれ $ P,Q,R,S $ とおきます。 すぬけ君は、$ P,Q,R,S $ の最大値と最小値の差の絶対値が小さいほど嬉しいです。 $ P,Q,R,S $ の最大値と最小値の差の絶対値としてあり得る最も小さい値を求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ A_1 $ $ A_2 $ $ ... $ $ A_N $

## 输出格式

$ P,Q,R,S $ の最大値と最小値の差の絶対値としてあり得る最も小さい値を出力せよ。

## 说明/提示

### 制約

- $ 4\ \leq\ N\ \leq\ 2\ \times\ 10^5 $
- $ 1\ \leq\ A_i\ \leq\ 10^9 $
- 入力はすべて整数である。

### Sample Explanation 1

$ B,C,D,E=(3),(2),(4),(1,2) $ と分割すれば、$ P=3,Q=2,R=4,S=1+2=3 $ となります。 このとき、$ P,Q,R,S $ の最大値は $ 4 $、最小値は $ 2 $ で、その差の絶対値は $ 2 $ です。 最大値と最小値の差の絶対値を $ 2 $ 未満にすることは出来ないため、$ 2 $ が答えになります。

## 样例 #1

### 输入

```
5

3 2 4 1 2
```

### 输出

```
2
```

## 样例 #2

### 输入

```
10

10 71 84 33 6 47 23 25 52 64
```

### 输出

```
36
```

## 样例 #3

### 输入

```
7

1 2 3 1000000000 4 5 6
```

### 输出

```
999999994
```



---

---
title: "[ARC107C] Shuffle Permutation"
layout: "post"
diff: 普及+/提高
pid: AT_arc107_c
tag: []
---

# [ARC107C] Shuffle Permutation

## 题目描述

[problemUrl]: https://atcoder.jp/contests/arc107/tasks/arc107_c

$ N\ \times\ N $ の行列と、整数 $ K $ が与えられます。この行列の $ i $ 行目、$ j $ 列目の値を $ a_{i,\ j} $ とします。この行列は、 $ 1,\ 2,\ \dots,\ N^2 $ をちょうど一つずつ要素に含みます。

sigma くんは、以下の $ 2 $ 種類の操作を、好きな順序で **好きな回数** 行えます。

- 全ての $ i $ ($ 1\ \leq\ i\ \leq\ N $) について $ a_{i,\ x}\ +\ a_{i,\ y}\ \leq\ K $ を満たす $ x,\ y(1\ \leq\ x\ <\ y\ \leq\ N) $ を選び、行列の $ x,\ y $ 列目をswapする。
- 全ての $ i $ ($ 1\ \leq\ i\ \leq\ N $) について $ a_{x,\ i}\ +\ a_{y,\ i}\ \leq\ K $ を満たす $ x,\ y(1\ \leq\ x\ <\ y\ \leq\ N) $ を選び、行列の $ x,\ y $ 行目をswapする。

最終的に得られる行列は何種類存在するでしょうか？ $ \bmod\ 998244353 $ で答えてください。

## 输入格式

入力は以下の形式で標準入力から与えられる．

> $ N $ $ K $ $ a_{1,\ 1} $ $ a_{1,\ 2} $ $ ... $ $ a_{1,\ N} $ $ a_{2,\ 1} $ $ a_{2,\ 2} $ $ ... $ $ a_{2,\ N} $ $ : $ $ a_{N,\ 1} $ $ a_{N,\ 2} $ $ ... $ $ a_{N,\ N} $

## 输出格式

最終的に得られる行列が何種類存在するかを $ \bmod\ 998244353 $ で出力せよ。

## 说明/提示

### 制約

- $ 1\ \leq\ N\ \leq\ 50 $
- $ 1\ \leq\ K\ \leq\ 2\ \times\ N^2 $
- $ a_{i,\ j} $ は $ 1,\ 2,\ \dots,\ N^2 $ の並び替え
- 入力される数は全て整数である。

### Sample Explanation 1

例えば $ x\ =\ 1,\ y\ =\ 2 $ として列ベクトルを swap でき、以下のようになります。 ``` 2 3 7 8 4 9 6 1 5 ``` その後更に $ x\ =\ 1,\ y\ =\ 3 $ として行ベクトルを swap でき、以下のようになります。 ``` 6 1 5 8 4 9 2 3 7 ```

## 样例 #1

### 输入

```
3 13

3 2 7

4 8 9

1 6 5
```

### 输出

```
12
```

## 样例 #2

### 输入

```
10 165

82 94 21 65 28 22 61 80 81 79

93 35 59 85 96 1 78 72 43 5

12 15 97 49 69 53 18 73 6 58

60 14 23 19 44 99 64 17 29 67

24 39 56 92 88 7 48 75 36 91

74 16 26 10 40 63 45 76 86 3

9 66 42 84 38 51 25 2 33 41

87 54 57 62 47 31 68 11 83 8

46 27 55 70 52 98 20 77 89 34

32 71 30 50 90 4 37 95 13 100
```

### 输出

```
348179577
```



---

---
title: "[ARC108C] Keep Graph Connected"
layout: "post"
diff: 普及+/提高
pid: AT_arc108_c
tag: []
---

# [ARC108C] Keep Graph Connected

## 题目描述

[problemUrl]: https://atcoder.jp/contests/arc108/tasks/arc108_c

$ 1 $ から $ N $ の番号がついた $ N $ 個の頂点と $ 1 $ から $ M $ の番号がついた $ M $ 本の辺からなる連結な無向グラフが与えられます。 このグラフに多重辺は存在するかもしれませんが、自己ループはありません。

このグラフのそれぞれの辺には $ 1 $ 以上 $ N $ 以下の整数で表されるラベルがついています。 辺 $ i $ はラベル $ c_i $ がついており、頂点 $ u_i,v_i $ を双方向につなぐ辺です。

すぬけ君はそれぞれの頂点に $ 1 $ 以上 $ N $ 以下の整数を書き込んだのち(頂点に書き込まれた整数に重複があっても構いません)、以下の条件を満たす辺のみを残してそれ以外の辺を取り除くことにしました。

**条件**：辺の両端の頂点に書き込まれた整数を $ x,y $ として、$ x,y $ のいずれか一方**のみ**が辺についたラベルと等しい

上記の条件を満たさない辺を取り除いたあとのグラフも連結のままであるような頂点への整数の書き込み方を *よい書き込み方* と呼びます。よい書き込み方が存在するかどうかを判定し、存在するならばその一例を示してください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ M $ $ u_1 $ $ v_1 $ $ c_1 $ $ \vdots $ $ u_M $ $ v_M $ $ c_M $

## 输出格式

よい書き込み方が存在しないならば `No` を出力せよ。 存在する場合、$ N $ 行出力せよ。$ i $ 行目には頂点 $ i $ に書き込む整数を出力せよ。 この書き込み方がよい書き込み方ならば正解となる。

## 说明/提示

### 制約

- $ 2\ \leq\ N\ \leq\ 10^5 $
- $ N-1\ \leq\ M\ \leq\ 2\ \times\ 10^5 $
- $ 1\ \leq\ u_i,v_i,c_i\ \leq\ N $
- 与えられるグラフは連結
- 与えられるグラフに自己ループはない

### Sample Explanation 1

\- 頂点 $ 1,2,3 $ にそれぞれ $ 1,2,1 $ を書き込みます。 - 辺 $ 1 $ は頂点 $ 1,2 $ をつないでおり、ラベルが $ 1 $ です。 - 頂点 $ 1 $ に書き込まれた整数のみが辺についたラベルと等しいため辺 $ 1 $ は取り除かれません。 - 辺 $ 2 $ は頂点 $ 2,3 $ をつないでおり、ラベルが $ 2 $ です。 - 頂点 $ 2 $ に書き込まれた整数のみが辺についたラベルと等しいため辺 $ 2 $ は取り除かれません。 - 辺 $ 3 $ は頂点 $ 1,3 $ をつないでおり、ラベルが $ 3 $ です。 - どちらの頂点に書き込まれた整数も辺についたラベルと異なるため辺 $ 3 $ は取り除かれます。 - 辺 $ 4 $ は頂点 $ 1,3 $ をつないでおり、ラベルが $ 1 $ です。 - どちらの頂点に書き込まれた整数も辺についたラベルと等しいため辺 $ 4 $ は取り除かれます。 - 辺 $ 3,4 $ が取り除かれたあともグラフは連結なので、この書き込み方はよい書き込み方です。

## 样例 #1

### 输入

```
3 4

1 2 1

2 3 2

3 1 3

1 3 1
```

### 输出

```
1

2

1
```



---

---
title: "[ARC111B] Reversible Cards"
layout: "post"
diff: 普及+/提高
pid: AT_arc111_b
tag: []
---

# [ARC111B] Reversible Cards

## 题目描述

[problemUrl]: https://atcoder.jp/contests/arc111/tasks/arc111_b

$ 1 $ から $ N $ の番号がついた $ N $ 枚のカードがあり、各カードの両面には正整数で表される色がついています。

カード $ i $ の片面の色は $ a_i $, もう片面の色は $ b_i $ です。

各カードについてどちらの面を表にするか自由に選べるとき、表側に見える色の種類数の最大値はいくつになるか求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ a_1 $ $ b_1 $ $ a_2 $ $ b_2 $ $ : $ $ a_N $ $ b_N $

## 输出格式

答えを出力せよ。

## 说明/提示

### 制約

- $ 1\ \leq\ N\ \leq\ 200000 $
- $ 1\ \leq\ a_i,b_i\ \leq\ 400000 $
- 入力される数はすべて整数

### Sample Explanation 1

それぞれ、$ 1 $,$ 3 $,$ 4 $,$ 2 $ の側を表にすることで $ 4 $ 色を達成できます。

### Sample Explanation 2

そもそも一色しか使われていません。

## 样例 #1

### 输入

```
4

1 2

1 3

4 2

2 3
```

### 输出

```
4
```

## 样例 #2

### 输入

```
2

111 111

111 111
```

### 输出

```
1
```

## 样例 #3

### 输入

```
12

5 2

5 6

1 2

9 7

2 7

5 5

4 2

6 7

2 2

7 8

9 7

1 8
```

### 输出

```
8
```



---

---
title: "[ARC113D] Sky Reflector"
layout: "post"
diff: 普及+/提高
pid: AT_arc113_d
tag: []
---

# [ARC113D] Sky Reflector

## 题目描述

[problemUrl]: https://atcoder.jp/contests/arc113/tasks/arc113_d

縦 $ N $ マス横 $ M $ マスのマス目の各マスに $ 1 $ 以上 $ K $ 以下の整数をひとつずつ書き込み、列 $ A,B $ を以下のように定義します。

- $ i=1,\dots,\ N $ に対し、$ A_i $ は $ i $ 行目のマスに書かれた整数の最小値
- $ j=1,\dots,\ M $ に対し、$ B_j $ は $ j $ 列目のマスに書かれた整数の最大値

$ N,M,K $ が与えられるので、列対 $ (A,B) $ としてありうる相異なるものの個数を $ 998244353 $ で割った余りを求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ M $ $ K $

## 输出格式

列対 $ (A,B) $ としてありうる相異なるものの個数を $ 998244353 $ で割った余りを出力せよ。

## 说明/提示

### 制約

- $ 1\ \leq\ N,M,K\ \leq\ 2\times\ 10^5 $
- 入力はすべて整数である

### Sample Explanation 1

$ (A_1,A_2,B_1,B_2) $ としてありうるものは、$ (1,1,1,1),(1,1,1,2),(1,1,2,1),(1,1,2,2),(1,2,2,2),(2,1,2,2),(2,2,2,2) $ の $ 7 $ 通りです。

## 样例 #1

### 输入

```
2 2 2
```

### 输出

```
7
```

## 样例 #2

### 输入

```
1 1 100
```

### 输出

```
100
```

## 样例 #3

### 输入

```
31415 92653 58979
```

### 输出

```
469486242
```



---

---
title: "[ARC116C] Multiple Sequences"
layout: "post"
diff: 普及+/提高
pid: AT_arc116_c
tag: []
---

# [ARC116C] Multiple Sequences

## 题目描述

[problemUrl]: https://atcoder.jp/contests/arc116/tasks/arc116_c

整数 $ N $ , $ M $ が与えられます。 長さ $ N $ の整数列 $ A $ であって、以下の条件を満たすものの数を答えてください。

- $ 1\ \leq\ A_i\ \leq\ M\ \left(i\ =\ 1,\ 2,\ \ldots,\ N\right) $
- $ A_{i+1} $ は $ A_i $ の倍数 $ \left(i\ =\ 1,\ 2,\ \ldots,\ N\ -\ 1\right) $

ただし、答えは非常に大きくなる場合があるので、 $ 998244353 $ で割った余りを答えてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ M $

## 输出格式

答えを出力せよ。

## 说明/提示

### 制約

- 入力は全て整数
- $ 1\ \leq\ N\ \leq\ 2\ \times\ 10^5 $
- $ 1\ \leq\ M\ \leq\ 2\ \times\ 10^5 $

### Sample Explanation 1

条件を満たす数列 $ A $ として、例えば以下のようなものが考えられます。 - $ A\ =\ \left(1,\ 1,\ 4\right) $ - $ A\ =\ \left(3,\ 3,\ 3\right) $ - $ A\ =\ \left(1,\ 2,\ 4\right) $

## 样例 #1

### 输入

```
3 4
```

### 输出

```
13
```

## 样例 #2

### 输入

```
20 30
```

### 输出

```
71166
```

## 样例 #3

### 输入

```
200000 200000
```

### 输出

```
835917264
```



---

---
title: "[ARC116D] I Wanna Win The Game"
layout: "post"
diff: 普及+/提高
pid: AT_arc116_d
tag: []
---

# [ARC116D] I Wanna Win The Game

## 题目描述

[problemUrl]: https://atcoder.jp/contests/arc116/tasks/arc116_d

整数 $ N $ , $ M $ が与えられます。 長さ $ N $ の整数列 $ A $ であって、以下の条件を満たすものの数を答えてください。

- $ 0\ \leq\ A_i\ \left(i\ =\ 1,\ 2,\ \ldots,\ N\right) $
- $ \sum_{i\ =\ 1}^{N}\ A_i\ =\ M $
- $ A_1 $ xor $ A_2 $ xor $ \cdots $ xor $ A_N\ =\ 0 $ （ここで xor はビットごとの排他的論理和を表す）

ただし、答えは非常に大きくなる場合があるので、 $ 998244353 $ で割った余りを答えてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ M $

## 输出格式

答えを出力せよ。

## 说明/提示

### 制約

- 入力は全て整数
- $ 1\ \leq\ N\ \leq\ 5000 $
- $ 1\ \leq\ M\ \leq\ 5000 $

### Sample Explanation 1

条件を満たす数列 $ A $ として、例えば以下のようなものが考えられます。 - $ A\ =\ \left(10,\ 0,\ 10,\ 0,\ 0\right) $ - $ A\ =\ \left(1,\ 2,\ 3,\ 7,\ 7\right) $

## 样例 #1

### 输入

```
5 20
```

### 输出

```
475
```

## 样例 #2

### 输入

```
10 5
```

### 输出

```
0
```

## 样例 #3

### 输入

```
3141 2718
```

### 输出

```
371899128
```



---

---
title: "[ARC119C] ARC Wrecker 2"
layout: "post"
diff: 普及+/提高
pid: AT_arc119_c
tag: []
---

# [ARC119C] ARC Wrecker 2

## 题目描述

---

给出一个长度为 $n$ $(2\le n\le 3\times 10^5)$ 的正整数序列 $A_i$ $(1\le A_i\le 10^9)$，您可以进行以下两种操作：

- 操作 $1$：选定整数 x $(l\le x<r)$，$A_x \leftarrow A_x+1$，$A_{x+1} \leftarrow A_{x+1}+1$

- 操作 $2$：选定整数 x $(l\le x<r)$，$A_x \leftarrow A_x-1$，$A_{x+1} \leftarrow A_{x+1}-1$

**您需要保证任意时刻 $A_i$ 非负**。求问有多少个数对 $(l,r)$ 满足可以通过任意次操作使得 $A_l,A_{l+1}\ ...\ A_r$ 均为零？操作之间不互相影响。

翻译 by wukaichen888

## 输入格式

输入共两行，第一行含一个正整数 $n$。

第二行包括 $n$ 个正整数，表示序列。

## 输出格式

一行，表示答案，行末换行。

### 样例解释

#### 样例#1

数对 $(2,3),(4,5),(2,5)$ 符合要求。

#### 样例#2

数对 $(2,4),(3,7),(4,5)$ 符合要求。

其中，对于 $(l,r)=(3,7)$，下图为合法方案之一。

![](https://img.atcoder.jp/arc119/392b686a479008a3dbc3fb36893ed144.png)

## 样例 #1

### 输入

```
5

5 8 8 6 6
```

### 输出

```
3
```

## 样例 #2

### 输入

```
7

12 8 11 3 3 13 2
```

### 输出

```
3
```

## 样例 #3

### 输入

```
10

8 6 3 9 5 4 7 2 1 10
```

### 输出

```
1
```

## 样例 #4

### 输入

```
14

630551244 683685976 249199599 863395255 667330388 617766025 564631293 614195656 944865979 277535591 390222868 527065404 136842536 971731491
```

### 输出

```
8
```



---

---
title: "[ARC125C] LIS to Original Sequence"
layout: "post"
diff: 普及+/提高
pid: AT_arc125_c
tag: []
---

# [ARC125C] LIS to Original Sequence

## 题目描述

# [ARC125C] LIS to Original Sequence


[problemUrl]: https://atcoder.jp/contests/arc125/tasks/arc125_c

给定一个长度为 $k$ 的序列 $A_1,A_2,\cdots,A_n$，试求出长度为 $n$ 的序列 $P$，使得 $P$ 的最长上升子序列为 $A_1,A_2,\cdots,A_n$，且 $P$ 的字典序最小。


## 样例 #1

### 样例输入 #1

```
3 2
2 3
```

### 样例输出 #1

```
2 1 3
```

## 样例 #2

### 样例输入 #2

```
5 1
4
```

### 样例输出 #2

```
5 4 3 2 1
```

## 输入格式

第一行两个用空格隔开的整数 $n,k$。

第二行 $n$ 个整数，分别为 $A_1,A_2,\cdots,A_n$。

## 说明/提示

- $ 1\ \leq\ K\ \leq\ N\ \leq\ 2\ \times\ 10^5 $
- $ 1\ \leq\ A_1\ <\ A_2\ <\ \cdots\ <\ A_K\ \leq\ N $
- 输入的所有值均为整数。

### 样例一解释

当 $P=（2，1，3）$ 或 $（2，3，1）$ 时，$P$ 的最长上升子序列与 $A$ 一样。 其中，$（2，1，3）$的字典序最小。

## 样例 #1

### 输入

```
3 2

2 3
```

### 输出

```
2 1 3
```

## 样例 #2

### 输入

```
5 1

4
```

### 输出

```
5 4 3 2 1
```



---

---
title: "[ARC126B] Cross-free Matching"
layout: "post"
diff: 普及+/提高
pid: AT_arc126_b
tag: []
---

# [ARC126B] Cross-free Matching

## 题目描述

[problemUrl]: https://atcoder.jp/contests/arc126/tasks/arc126_b

座標平面上に、$ x $ 座標が $ 1,\ 2,\ \ldots,\ N $、$ y $ 座標が $ 0 $ または $ 1 $ であるような合計 $ 2N $ 個の頂点 $ (1,\ 0),\ldots,\ (N,0),\ (1,1),\ \ldots,\ (N,1) $ があります。 これらのうちの $ 2 $ 頂点を結ぶ線分が $ M $ 個あり、$ i $ 番目の線分は $ (a_i,\ 0) $ と $ (b_i,\ 1) $ を結んでいます。

これら $ M $ 個の線分から $ K $ 個の線分を選び、選んだ線分のうちどの $ 2 $ 個の線分も同一の点を含まないようにすることを考えます。ただし、線分の両端点も線分に含まれる点として扱います。可能な $ K $ の最大値を求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられます。

> $ N $ $ M $ $ a_1 $ $ b_1 $ $ \vdots $ $ a_M $ $ b_M $

## 输出格式

可能な $ K $ の最大値を出力してください。

## 说明/提示

### 制約

- $ 1\leq\ N,\ M\ \leq\ 2\times\ 10^5 $
- $ 1\leq\ a_i,\ b_i\leq\ N $
- $ i\neq\ j $ ならば、$ a_i\neq\ a_j $ または $ b_i\neq\ b_j $

### Sample Explanation 1

$ 1,\ 2 $ 番目の線分を選ぶことが、最適解のひとつです。 例えば $ 1 $ 番目の線分と $ 3 $ 番目の線分は同一の点 $ \left(\frac53,\ \frac23\right) $ を含むため、同時に選ぶことはできません。 !\[\](https://img.atcoder.jp/arc126/3e4cb12392855ea49b7ed0b643ebd370.png)

### Sample Explanation 2

$ 1,\ 3,\ 5 $ 番目の線分を選ぶことが、最適解のひとつです。 例えば $ 1 $ 番目の線分と $ 2 $ 番目の線分は同一の点 $ (1,\ 1) $ を含むため、同時に選ぶことはできません。 !\[\](https://img.atcoder.jp/arc126/416681cace776c87fac353e0acb9c4a1.png)

### Sample Explanation 3

!\[\](https://img.atcoder.jp/arc126/2436c39ccc0fa35fc57d35647bce9f08.png)

## 样例 #1

### 输入

```
3 3

1 2

2 3

3 1
```

### 输出

```
2
```

## 样例 #2

### 输入

```
3 5

1 1

2 1

2 2

3 2

3 3
```

### 输出

```
3
```

## 样例 #3

### 输入

```
7 5

1 7

7 1

3 4

2 6

5 2
```

### 输出

```
1
```



---

---
title: "[ARC127B] Ternary Strings"
layout: "post"
diff: 普及+/提高
pid: AT_arc127_b
tag: []
---

# [ARC127B] Ternary Strings

## 题目描述

[problemUrl]: https://atcoder.jp/contests/arc127/tasks/arc127_b

整数 $ N,L $ が与えられます． 以下の条件をすべて満たす $ 3N $ 個の文字列の組 $ (S_1,S_2,\cdots,S_{3N}) $ を一つ求めてください．

- $ S_i $ は `0`, `1`, `2` からなる長さ $ L $ の文字列である．
- $ S_i $ はすべて互いに異なる．
- すべての $ j $ ($ 1\ \leq\ j\ \leq\ L $) および $ c= $`0`, `1`, `2` について，次が成り立つ．
  
  
  - $ S_i $ のうち，$ j $ 文字目が $ c $ であるようなものはちょうど $ N $ 個存在する．
- $ S_1,S_2,\cdots,S_{3N} $ の中で，辞書順で最も大きい文字列を $ t $ で表すことにする． このときの $ t $ は，$ t $ としてありうる文字列の中で辞書順最小の文字列である．

## 输入格式

入力は以下の形式で標準入力から与えられる．

> $ N $ $ L $

## 输出格式

以下の形式で答えを出力せよ．

> $ S_1 $ $ S_2 $ $ \vdots $ $ S_{3N} $

なお，条件を満たす解が複数存在する場合，どれを出力しても正解とみなされる．

## 说明/提示

### 制約

- $ 1\ \leq\ N\ \leq\ 5\ \times\ 10^4 $
- $ 1\ \leq\ L\ \leq\ 15 $
- $ 3N\ \leq\ 3^L $
- 入力される値はすべて整数である

### Sample Explanation 1

この出力例はすべての条件を満たしています． 例えば，$ 2 $ 文字目が `0` であるような文字列は $ 2 $ 個存在しています． また，この例では $ t= $`21` ですが，$ t $ がこれより辞書順で小さくなることはありません．

## 样例 #1

### 输入

```
2 2
```

### 输出

```
00

02

11

12

20

21
```



---

---
title: "[ARC128C] Max Dot"
layout: "post"
diff: 普及+/提高
pid: AT_arc128_c
tag: []
---

# [ARC128C] Max Dot

## 题目描述

[problemUrl]: https://atcoder.jp/contests/arc128/tasks/arc128_c

整数 $ N,M,S $，及び長さ $ N $ の整数列 $ A=(A_1,A_2,\cdots,A_N) $ が与えられます．

次の条件をすべて満たす長さ $ N $ の非負**実数**列 $ x=(x_1,x_2,\cdots,x_N) $ を作ることを考えます．

- $ 0\ \leq\ x_1\ \leq\ x_2\ \leq\ \cdots\ \leq\ x_N\ \leq\ M $
- $ \sum_{1\ \leq\ i\ \leq\ N}\ x_i=S $

ここで，$ x $ のスコアを $ \sum_{1\ \leq\ i\ \leq\ N}\ A_i\ \times\ x_i $ と定義します． $ x $ のスコアとしてありうる最大の値を求めてください．

## 输入格式

入力は以下の形式で標準入力から与えられる．

> $ N $ $ M $ $ S $ $ A_1 $ $ A_2 $ $ \cdots $ $ A_N $

## 输出格式

答えを出力せよ． 絶対誤差または相対誤差が $ 10^{-6} $ 以内であれば，正解と判定される．

## 说明/提示

### 制約

- $ 1\ \leq\ N\ \leq\ 5000 $
- $ 1\ \leq\ M\ \leq\ 10^6 $
- $ 1\ \leq\ S\ \leq\ \min(N\ \times\ M,10^6) $
- $ 1\ \leq\ A_i\ \leq\ 10^6 $
- 入力される値はすべて整数である

### Sample Explanation 1

$ x=(0,1,2) $ とするのが最適です．

### Sample Explanation 2

$ x=(2/3,2/3,2/3) $ とするのが最適です．

## 样例 #1

### 输入

```
3 2 3

1 2 3
```

### 输出

```
8.00000000000000000000
```

## 样例 #2

### 输入

```
3 3 2

5 1 1
```

### 输出

```
4.66666666666666666667
```

## 样例 #3

### 输入

```
10 234567 1000000

353239 53676 45485 617014 886590 423581 172670 928532 312338 981241
```

### 输出

```
676780145098.25000000000000000000
```



---

---
title: "[ARC133B] Dividing Subsequence"
layout: "post"
diff: 普及+/提高
pid: AT_arc133_b
tag: []
---

# [ARC133B] Dividing Subsequence

## 题目描述

**【题目大意】**

给定两个长度为 $n(n\le 2\times 10^5)$ 的 $1\sim n$ 的排列 $\text{P}$ 和 $\text{Q}$。

现在需要在 $\text{P}$ 和 $\text{Q}$ 中分别取出长度为 $k$ 两个子序列 $\text{A}$ 和 $\text{B}$，满足 $\forall i\in [1,k],a_i\mid b_i$。

最大化 $k$，求 $k$。

## 输入格式

共三行。

第一行一个整数 $n$。

第二行 $n$ 个整数表示排列 $\text{P}$。

第三行 $n$ 个整数表示排列 $\text{Q}$。

## 输出格式

一行一个整数 $k$ 表示答案。

## 样例 #1

### 输入

```
4

3 1 4 2

4 2 1 3
```

### 输出

```
2
```

## 样例 #2

### 输入

```
5

1 2 3 4 5

5 4 3 2 1
```

### 输出

```
3
```

## 样例 #3

### 输入

```
10

4 3 1 10 9 2 8 6 5 7

9 6 5 4 2 3 8 10 1 7
```

### 输出

```
6
```



---

---
title: "[ARC133C] Row Column Sums"
layout: "post"
diff: 普及+/提高
pid: AT_arc133_c
tag: []
---

# [ARC133C] Row Column Sums

## 题目描述

[problemUrl]: https://atcoder.jp/contests/arc133/tasks/arc133_c

$ H $ 行 $ W $ 列からなるマス目があります．

すぬけくんは，各マスに $ 0 $ 以上 $ K-1 $ 以下の整数を書き込もうとしています． ここで，以下の条件を満たす必要があります．

- 各 $ 1\ \leq\ i\ \leq\ H $ について，$ i $ 行目にあるマスに書かれた整数の総和を $ K $ で割った余りは $ A_i $ である．
- 各 $ 1\ \leq\ i\ \leq\ W $ について，$ i $ 列目にあるマスに書かれた整数の総和を $ K $ で割った余りは $ B_i $ である．

条件を満たすようにマスに整数を書き込むことができるかどうか判定し，また可能な場合は，書き込む整数の総和としてありうる最大値を求めてください．

## 输入格式

入力は以下の形式で標準入力から与えられる．

> $ H $ $ W $ $ K $ $ A_1 $ $ A_2 $ $ \cdots $ $ A_H $ $ B_1 $ $ B_2 $ $ \cdots $ $ B_W $

## 输出格式

条件を満たすようにマスに整数を書き込むことが不可能な場合，`-1` と出力せよ． 可能な場合，書き込む整数の総和としてありうる最大値を出力せよ．

## 说明/提示

### 制約

- $ 1\ \leq\ H,W\ \leq\ 200000 $
- $ 2\ \leq\ K\ \leq\ 200000 $
- $ 0\ \leq\ A_i\ \leq\ K-1 $
- $ 0\ \leq\ B_i\ \leq\ K-1 $
- 入力される値はすべて整数である

### Sample Explanation 1

以下のように書き込めば良いです． ``` ----------------- | 2 | 0 | 2 | 2 | ----------------- | 2 | 2 | 0 | 1 | ----------------- ``` この書き方は条件を満たしています． 例えば $ 1 $ 行目に書かれた整数の総和は $ 6 $ であり，これを $ K(=3) $ で割ったあまりは $ A_1(=0) $ になっています． この書き方では整数の総和は $ 11 $ になっており，これはありうる最大値です．

## 样例 #1

### 输入

```
2 4 3

0 2

1 2 2 0
```

### 输出

```
11
```

## 样例 #2

### 输入

```
3 3 4

0 1 2

1 2 3
```

### 输出

```
-1
```



---

---
title: "[ARC134C] The Majority"
layout: "post"
diff: 普及+/提高
pid: AT_arc134_c
tag: []
---

# [ARC134C] The Majority

## 题目描述

[problemUrl]: https://atcoder.jp/contests/arc134/tasks/arc134_c

$ 1 $ から $ K $ の番号がついた $ K $ 個の箱があります。はじめ、箱は全て空です。

すぬけ君は $ 1 $ 以上 $ N $ 以下の整数が書かれたボールをいくつか持っています。 すぬけ君が持っているボールのうち、$ i $ が書かれたものは $ a_i $ 個あります。 同じ整数が書かれたボール同士は区別できません。

すぬけ君は持っている全てのボールを箱にしまうことにしました。 すぬけ君はどの箱についても $ 1 $ と書かれたボールが過半数を占めるようにしたいです。 過半数を占めるとは、$ 1 $ と書かれたボールの個数がそれ以外のボールの個数より多いことを意味します。

そのようなしまい方の個数を $ 998244353 $ で割ったあまりを求めてください。

$ 2 $ つのしまい方が異なるとは、$ 1\ \leq\ i\ \leq\ K,\ 1\ \leq\ j\ \leq\ N $ を満たす整数の組 $ (i,j) $ であって、箱 $ i $ に入っている $ j $ が書かれたボールの個数が異なるようなものが存在することをいいます。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ K $ $ a_1 $ $ \cdots $ $ a_N $

## 输出格式

どの箱も $ 1 $ と書かれたボールが過半数を占めるようなしまい方の個数を $ 998244353 $ で割ったあまりを出力せよ。

## 说明/提示

### 制約

- 与えられる入力は全て整数
- $ 1\ \leq\ N\ \leq\ 10^5 $
- $ 1\ \leq\ K\ \leq\ 200 $
- $ 1\ \leq\ a_i\ <\ 998244353 $

### Sample Explanation 1

\- $ 1 $ と書かれたボールが過半数を占めるようなしまい方は $ 2 $ 通りあります。 - 例えば $ 1 $ と書かれたボールを箱 $ 1 $ に $ 2 $ 個、箱 $ 2 $ に $ 1 $ 個入れ、$ 2 $ と書かれたボールを箱 $ 1 $ に $ 1 $ 個入れたとき条件を満たします。

### Sample Explanation 2

\- 条件を満たすようなしまい方が存在しないこともあります。

### Sample Explanation 3

\- $ 998244353 $ で割ったあまりを求めるのを忘れずに。

## 样例 #1

### 输入

```
2 2

3 1
```

### 输出

```
2
```

## 样例 #2

### 输入

```
2 1

1 100
```

### 输出

```
0
```

## 样例 #3

### 输入

```
20 100

1073813 90585 41323 52293 62633 28788 1925 56222 54989 2772 36456 64841 26551 92115 63191 3603 82120 94450 71667 9325
```

### 输出

```
313918676
```



---

---
title: "[ARC135C] XOR to All"
layout: "post"
diff: 普及+/提高
pid: AT_arc135_c
tag: []
---

# [ARC135C] XOR to All

## 题目描述

给定 $n$ 个非负整数 $a_1,a_2,\dots,a_n$，你可以执行以下操作任意（可以为零）次：

- 选择一个数 $x\in \{a_1,a_2,\dots,a_n\}$。

- 对于所有 $a\leq i\leq n$，将 $a_i$ 修改为 $a_i\oplus x$，其中 $\oplus$ 表示按位异或操作。

请你最大化操作后 $\sum_{i=1}^na_i$ 的值。

## 输入格式

第一行一个整数 $n$。

第二行 $n$ 个整数 $a_1,a_2,\dots,a_n$。

## 输出格式

一行一个整数，表示操作后 $\sum_{i=1}^na_i$ 的最大值。 

## 样例 #1

### 样例输入 #1

```
5
1 2 3 4 5
```

### 样例输出 #1

```
19
```

## 样例 #2

### 样例输入 #2

```
5
10 10 10 10 10
```

### 样例输出 #2

```
50
```

## 样例 #3

### 样例输入 #3

```
5
3 1 4 1 5
```

### 样例输出 #3

```
18
```

## 说明/提示

- $1\leq n \leq 3\times 10^5$
- $0\leq a_i<2^{30}$

## 样例 #1

### 输入

```
5

1 2 3 4 5
```

### 输出

```
19
```

## 样例 #2

### 输入

```
5

10 10 10 10 10
```

### 输出

```
50
```

## 样例 #3

### 输入

```
5

3 1 4 1 5
```

### 输出

```
18
```



---

---
title: "[ARC136B] Triple Shift"
layout: "post"
diff: 普及+/提高
pid: AT_arc136_b
tag: []
---

# [ARC136B] Triple Shift

## 题目描述

[problemUrl]: https://atcoder.jp/contests/arc136/tasks/arc136_b

長さ $ N $ の整数列 $ A=(A_1,A_2,\cdots,A_N) $ および $ B=(B_1,B_2,\cdots,B_N) $ が与えられます．

あなたは，以下の操作を好きな回数繰り返すことができます．

- 整数 $ i $ ($ 1\ \leq\ i\ \leq\ N-2 $) を選び，現在の $ A_i,A_{i+1},A_{i+2} $ の値をそれぞれ $ x,y,z $ とする． そして，$ A_i,A_{i+1},A_{i+2} $ の値をそれぞれ $ z,x,y $ で置き換える．

$ A $ を $ B $ に一致させることができるかどうか判定してください．

## 输入格式

入力は以下の形式で標準入力から与えられる．

> $ N $ $ A_1 $ $ A_2 $ $ \cdots $ $ A_N $ $ B_1 $ $ B_2 $ $ \cdots $ $ B_N $

## 输出格式

$ A $ を $ B $ に一致させることが可能な場合は `Yes` を，そうでない場合は `No` を出力せよ．

## 说明/提示

### 制約

- $ 3\ \leq\ N\ \leq\ 5000 $
- $ 1\ \leq\ A_i,B_i\ \leq\ 5000 $
- 入力される値はすべて整数

### Sample Explanation 1

以下のように操作すればよいです． - 最初，$ A=(3,1,4,5) $ である． - $ i=1 $ で操作を行う．$ A=(4,3,1,5) $ となる． - $ i=2 $ で操作を行う．$ A=(4,5,3,1) $ となる． - $ i=2 $ で操作を行う．$ A=(4,1,5,3) $ となる．

## 样例 #1

### 输入

```
4

3 1 4 5

4 1 5 3
```

### 输出

```
Yes
```

## 样例 #2

### 输入

```
3

1 2 2

2 1 2
```

### 输出

```
Yes
```

## 样例 #3

### 输入

```
3

1 2 3

2 3 4
```

### 输出

```
No
```



---

---
title: "[ARC137A] Coprime Pair"
layout: "post"
diff: 普及+/提高
pid: AT_arc137_a
tag: []
---

# [ARC137A] Coprime Pair

## 题目描述

[problemUrl]: https://atcoder.jp/contests/arc137/tasks/arc137_a

整数 $ L,R $ ($ L\ <\ R $) が与えられます．

すぬけ君は，以下の条件を両方満たす整数の組 $ (x,y) $ を探しています．

- $ L\ \leq\ x\ <\ y\ \leq\ R $
- $ \gcd(x,y)=1 $

条件を満たす組において，$ (y-x) $ がとりうる最大の値を求めてください． なお，問題の制約より，条件を満たす組が少なくとも一つ存在することが証明できます．

## 输入格式

入力は以下の形式で標準入力から与えられる．

> $ L $ $ R $

## 输出格式

答えを出力せよ．

## 说明/提示

### 制約

- $ 1\ \leq\ L\ <\ R\ \leq\ 10^{18} $
- 入力される値はすべて整数

### Sample Explanation 1

$ (x,y)=(2,4) $ とすると，$ \gcd(x,y)=2 $ となってしまい，条件を満たしません． $ (x,y)=(2,3) $ とすれば条件を満たし，このとき $ (y-x) $ の値は $ 1 $ です． $ (y-x) $ の値がこれより大きくなることはないため，答えは $ 1 $ です．

## 样例 #1

### 输入

```
2 4
```

### 输出

```
1
```

## 样例 #2

### 输入

```
14 21
```

### 输出

```
5
```

## 样例 #3

### 输入

```
1 100
```

### 输出

```
99
```



---

---
title: "[ARC138C] Rotate and Play Game"
layout: "post"
diff: 普及+/提高
pid: AT_arc138_c
tag: []
---

# [ARC138C] Rotate and Play Game

## 题目描述

[problemUrl]: https://atcoder.jp/contests/arc138/tasks/arc138_c

$ N $ 枚のカードがあり，$ 1 $ から $ N $ までの番号がついています． カード $ i $ には整数 $ A_i $ が書かれています． なお，ここで $ N $ は偶数です．

これから，すぬけ君と最小太郎君がゲームをします． ゲームは $ N $ ターンからなり，すぬけ君から始めて二人が交互にターンをプレイします． 各ターンでは，以下の操作を行います．

- すぬけ君のターン：まだ誰にも取られていないカードのうち，好きなものを一つ選び，取る．
- 最小太郎君のターン：まだ誰にも取られていないカードのうち，**番号**が最小のものを一つ選び，取る．

すぬけ君のスコアは，すぬけ君が取ったカードに書かれた整数の総和になります． すぬけ君はスコアを最大化するように最適に行動します．

ところで，すぬけ君の大ファンであるあなたは，とある不正を行うことでスコアを最大化しようと考えています． 具体的には，ゲームの開始前に，あなたは以下の行動を一回行います．

- 整数 $ k $ ($ 0\ \leq\ k\ \leq\ N-1 $) を選び，カードに書かれている整数を $ k $ 個左に cyclic-shift する． つまり，カード $ 1,2,\cdots,N $ に書かれている数を，$ A_{k+1},A_{k+2},\cdots,A_N,A_1,\cdots,A_k $ に置き換える．

スコアを最大化するためにあなたが選ぶべき $ k $ の値，およびその $ k $ を選んだ場合のスコアを求めてください．

## 输入格式

入力は以下の形式で標準入力から与えられる．

> $ N $ $ A_1 $ $ A_2 $ $ \cdots $ $ A_N $

## 输出格式

以下の形式で答えを出力せよ．

> $ k $ $ s $

ここで $ k $ はあなたが選ぶ整数 ($ 0\ \leq\ k\ \leq\ N-1 $) であり，$ s $ はその $ k $ を選んだ場合のスコアである． なお，$ s $ を最大化するような $ k $ が複数存在する場合，どれを出力しても正解とみなされる．

## 说明/提示

### 制約

- $ 2\ \leq\ N\ \leq\ 2\ \times\ 10^5 $
- $ N $ は偶数
- $ 1\ \leq\ A_i\ \leq\ 10^9 $
- 入力される値はすべて整数

### Sample Explanation 1

$ k=1 $ を選ぶと，カード $ 1,2,3,4 $ に書かれた整数は $ 4,1,2,3 $ になります． その後，ゲームは以下のように進行します． - すぬけ君がカード $ 1 $ を取る． - 最小太郎君がカード $ 2 $ を取る． - すぬけ君がカード $ 4 $ を取る． - 最小太郎君がカード $ 3 $ を取る． このときのすぬけ君のスコアは $ 7 $ になります． なお，この例では $ k=2,3 $ でも正解になります．

## 样例 #1

### 输入

```
4

3 4 1 2
```

### 输出

```
1 7
```

## 样例 #2

### 输入

```
2

1 1
```

### 输出

```
0 1
```

## 样例 #3

### 输入

```
10

716893678 779607519 555600775 393111963 950925400 636571379 912411962 44228139 15366410 2063694
```

### 输出

```
7 3996409938
```



---

---
title: "[ARC139B] Make N"
layout: "post"
diff: 普及+/提高
pid: AT_arc139_b
tag: []
---

# [ARC139B] Make N

## 题目描述

[problemUrl]: https://atcoder.jp/contests/arc139/tasks/arc139_b

整数 $ P=0 $ があります。以下の $ 3 $ 種類の操作を任意の回数選んで行うことで $ P=N $ とするとき、コストの総和の最小値を求めてください。

- $ P $ を $ 1 $ 増やす。この操作はコストが $ X $ かかる。
- $ P $ を $ A $ 増やす。この操作はコストが $ Y $ かかる。
- $ P $ を $ B $ 増やす。この操作はコストが $ Z $ かかる。

$ T $ 個のテストケースが与えられるので、それぞれについて答えを求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられます。

> $ T $ $ \mathrm{case}_1 $ $ \mathrm{case}_2 $ $ \vdots $ $ \mathrm{case}_T $

各テストケースは以下の形式で与えられます。

> $ N\ A\ B\ X\ Y\ Z $

## 输出格式

$ T $ 行出力してください。$ i $ 行目には、$ \mathrm{case}_i $ に対する答えを出力してください。

## 说明/提示

### 制約

- $ 1\ \le\ T\ \le\ 100 $
- $ 1\ \le\ N,A,B,X,Y,Z\ \le\ 10^9 $
- 入力は全て整数である。

### Sample Explanation 1

$ 1 $ 個目のテストケースでは、例えば以下のようにするとコスト $ 11 $ で $ P=10 $ とでき、これが最適です。 - $ P $ を $ 3 $ 増やす。$ P=3 $ となる。コストが $ 3 $ かかる。 - $ P $ を $ 1 $ 増やす。$ P=4 $ となる。コストが $ 2 $ かかる。 - $ P $ を $ 3 $ 増やす。$ P=7 $ となる。コストが $ 3 $ かかる。 - $ P $ を $ 3 $ 増やす。$ P=10 $ となる。コストが $ 3 $ かかる。

## 样例 #1

### 输入

```
5

10 3 5 2 3 6

10 3 5 1 1000000000 1000000000

139 2 139 1 1 1

139 1 1 1 1 1

139 7 10 3845 26982 30923
```

### 输出

```
11

10

1

139

436604
```



---

---
title: "[ARC140C] ABS Permutation (LIS ver.)"
layout: "post"
diff: 普及+/提高
pid: AT_arc140_c
tag: []
---

# [ARC140C] ABS Permutation (LIS ver.)

## 题目描述

[problemUrl]: https://atcoder.jp/contests/arc140/tasks/arc140_c

$ (1,\dots,N) $ の順列 $ P=(P_1,P_2,\ldots,P_N) $ の**嬉しさ**を以下で定義します。

- 長さ $ N-1 $ の数列 $ A=(A_1,A_2,\ldots,A_{N-1}) $ を、$ A_i\ =\ |P_i-P_{i+1}|(1\leq\ i\ \leq\ N-1) $ で定める。 $ A $ の最長狭義単調増加部分列の長さを $ P $ の嬉しさとする。

$ P_1\ =\ X $ を満たす順列 $ P $ のうち、嬉しさが最大になるものを一つ出力してください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ X $

## 输出格式

$ P_1\ =\ X $ を満たす順列 $ P $ のうち、嬉しさが最大になるものを $ 1 $ つ以下の形式で出力せよ。

> $ P_1 $ $ P_2 $ $ \ldots $ $ P_N $

条件を満たす解が複数存在する場合、どれを出力しても正解とみなされる。

## 说明/提示

### 制約

- $ 2\ \leq\ N\ \leq\ 2\times\ 10^5 $
- $ 1\ \leq\ X\ \leq\ N $
- 入力は全て整数

### Sample Explanation 1

$ A=(1,2) $ となるので、$ P $ の嬉しさは $ 2 $ です。これが達成可能な嬉しさの最大であるため、出力は条件を満たします。

### Sample Explanation 2

$ A=(1,1) $ となるので、$ P $ の嬉しさは $ 1 $ です。これが達成可能な嬉しさの最大であるため、出力は条件を満たします。

## 样例 #1

### 输入

```
3 2
```

### 输出

```
2 1 3
```

## 样例 #2

### 输入

```
3 1
```

### 输出

```
1 2 3
```



---

---
title: "[ARC142C] Tree Queries"
layout: "post"
diff: 普及+/提高
pid: AT_arc142_c
tag: []
---

# [ARC142C] Tree Queries

## 题目描述

[problemUrl]: https://atcoder.jp/contests/arc142/tasks/arc142_c

$ N $ 頂点の木があり、各頂点には $ 1,\ldots,N $ と番号が付けられています。  
 また、各整数 $ u,v\,\ (1\ \leq\ u,v\ \leq\ N) $ に対し、頂点 $ u,v $ の距離 $ d_{u,v} $ を次のように定めます。

- 頂点 $ u $ と頂点 $ v $ を結ぶ最短パスに含まれる辺の本数

あなたは次のような質問を $ 0 $ 回以上 $ 2N $ 回以下行うことが出来ます。

- $ 1\leq\ u,v\ \leq\ N $ かつ $ u+v\ >\ 3 $ を満たす整数 $ u,v $ を指定し、頂点 $ u,v $ の距離 $ d_{u,v} $ を聞く。

頂点 $ 1,2 $ の距離 $ d_{1,2} $ を求めてください。

### Input &amp; Output Format

**この問題はインタラクティブな問題**（あなたの作成したプログラムとジャッジプログラムが入出力を介して対話を行う形式の問題）である。

まず、あなたのプログラムに標準入力から正の整数 $ N $ が与えられる。

> $ N $

その後、あなたは質問を行うことが出来る。  
 質問は標準出力に以下の形式で出力せよ(末尾に改行を入れること)。

> ? $ u $ $ v $

質問が正当な場合、その質問への答え $ d_{u,v} $ が標準入力から与えられる。

> $ d_{u,v} $

質問の形式が間違っている・質問を規定の回数より多く行った等の理由から質問が不正と判定された場合、質問への答えの代わりに `-1` が与えられる。

 ```
-1
```

この時、提出はすでに不正解と判定されている。ジャッジプログラムはこの時点で終了するため、あなたのプログラムも終了するのが望ましい。

答え $ d_{1,2} $ が分かったら、標準出力に以下の形式で出力せよ(末尾に改行を入れること)。

> ! $ d_{1,2} $

## 说明/提示

### 制約

- $ 3\ \leq\ N\ \leq\ 100 $
- $ N $ は整数
- 木はプログラムとジャッジの対話の開始前に決定される

### 注意点

- **出力を行うたびに標準出力をflushせよ。そうしなかった場合、ジャッジ結果が TLE となる可能性がある。**
- 答えを出力したら(または `-1` を受け取ったら)直ちにプログラムを正常終了せよ。そうしなかった場合、ジャッジ結果は不定である。
- 不正なフォーマットの出力を行った場合のジャッジ結果は不定である。
- 特に、余計な改行も不正なフォーマットの出力とみなされるので注意せよ。

### 入出力例

木がこの画像のような時の対話の一例を示します。

![](https://cdn.luogu.com.cn/upload/vjudge_pic/AT_arc142_c/2372d0c2156cba417b179dc14ab627f8984c08d8.png)

 入力 出力 説明 `3`  まず整数 $ N $ が与えられます。  `?` `1` `3` $ 1 $ 回目の質問として頂点 $ 1,3 $ の距離を聞きます。 `1`  頂点 $ 1,3 $ の距離が与えられます。  `?` `2` `2` $ 2 $ 回目の質問として頂点 $ 2,2 $ の距離を聞きます。 `0`  頂点 $ 2,2 $ の距離が与えられます。  `?` `2` `3` $ 3 $ 回目の質問として頂点 $ 2,3 $ の距離を聞きます。 `1`  頂点 $ 2,3 $ の距離が与えられます。  `?` `3` `1` $ 4 $ 回目の質問として頂点 $ 3,1 $ の距離を聞きます。 `1`  頂点 $ 3,1 $ の距離が与えられます。  `?` `3` `2` $ 5 $ 回目の質問として頂点 $ 3,2 $ の距離を聞きます。 `1`  頂点 $ 3,2 $ の距離が与えられます。  `?` `2` `2` $ 6 $ 回目の質問として頂点 $ 2,2 $ の距離を聞きます。 `0`  頂点 $ 2,2 $ の距離が与えられます。  `!` `2` 頂点 $ 1,2 $ の距離を回答し、終了します。実際に木の頂点 $ 1,2 $ の距離は $ 2 $ であるため AC が得られます。



---

---
title: "[ARC143B] Counting Grids"
layout: "post"
diff: 普及+/提高
pid: AT_arc143_b
tag: []
---

# [ARC143B] Counting Grids

## 题目描述

[problemUrl]: https://atcoder.jp/contests/arc143/tasks/arc143_b

$ N\ \times\ N $ のマス目の各マスに $ 1 $ から $ N^2 $ までの整数を $ 1 $ つずつ書き込む方法であって， どのマスも以下の条件のうち少なくとも一方を満たすようなものの個数を $ 998244353 $ で割ったあまりを求めてください．

- そのマスに書かれている数より大きい数が書かれているマスが同じ列に存在する．
- そのマスに書かれている数より小さい数が書かれているマスが同じ行に存在する．

## 输入格式

入力は以下の形式で標準入力から与えられる．

> $ N $

## 输出格式

答えを出力せよ．

## 说明/提示

### 制約

- $ 1\ \leq\ N\ \leq\ 500 $

### Sample Explanation 1

例えば，以下のような書き込み方は条件を満たします． ``` 13 42 ``` この場合，左上のマスは左下のマスに書かれている数より小さい数が書かれているので， $ 1 $ つ目の条件を満たします．ただし，$ 2 $ つ目の条件は満たしません．

## 样例 #1

### 输入

```
2
```

### 输出

```
8
```

## 样例 #2

### 输入

```
5
```

### 输出

```
704332752
```

## 样例 #3

### 输入

```
100
```

### 输出

```
927703658
```



---

---
title: "[ARC143C] Piles of Pebbles"
layout: "post"
diff: 普及+/提高
pid: AT_arc143_c
tag: []
---

# [ARC143C] Piles of Pebbles

## 题目描述

[problemUrl]: https://atcoder.jp/contests/arc143/tasks/arc143_c

小石の山が $ N $ 個あります．最初，$ i $ 番目の山には $ A_i $ 個の小石があります．

これらを用いて，高橋君と青木君がゲームをします． 高橋君から始めて，交互に次の操作を行い，操作を行えなくなった方が負けとなります．

- 山を $ 1 $ つ以上選び，選んだそれぞれの山から，高橋君の操作の場合は $ X $ 個ずつ，青木君の操作の場合は $ Y $ 個ずつ小石を取り除く． ただし，小石の個数が足りない山を選ぶことはできない．

二人が最適に行動したとき，どちらがゲームに勝つかを求めてください.

## 输入格式

入力は以下の形式で標準入力から与えられる．

> $ N $ $ X $ $ Y $ $ A_1 $ $ A_2 $ $ \cdots $ $ A_N $

## 输出格式

このゲームに勝つのが高橋君の場合 `First` を，青木君の場合 `Second` を出力せよ．

## 说明/提示

### 制約

- $ 1\ \leq\ N\ \leq\ 2\times\ 10^5 $
- $ 1\ \leq\ X,\ Y\ \leq\ 10^9 $
- $ 1\ \leq\ A_i\ \leq\ 10^9 $

### Sample Explanation 1

例えば，以下のようなゲームの進行が考えられます． - 高橋君が両方の山から石を $ 1 $ つ取り除く． - 青木君が $ 1 $ 番目の山から石を $ 1 $ つ取り除く． - 高橋君が $ 1 $ 番目の山から石を $ 1 $ つ取り除く． - 青木君が $ 2 $ 番目の山から石を $ 1 $ つ取り除く． - 高橋君が $ 2 $ 番目の山から石を $ 1 $ つ取り除く． 青木君がどのように操作を行っても高橋君が勝つことができるので，答えは `First` です．

## 样例 #1

### 输入

```
2 1 1

3 3
```

### 输出

```
First
```

## 样例 #2

### 输入

```
2 1 2

3 3
```

### 输出

```
Second
```



---

---
title: "[ARC144C] K Derangement"
layout: "post"
diff: 普及+/提高
pid: AT_arc144_c
tag: []
---

# [ARC144C] K Derangement

## 题目描述

[problemUrl]: https://atcoder.jp/contests/arc144/tasks/arc144_c

正整数 $ N,\ K $ が与えられます． $ 1 $ から $ N $ までの整数からなる順列 $ A\ =\ (A_1,\ A_2,\ \ldots,\ A_N) $ であって次の条件を満たすもののうち， 辞書順最小のものを求めてください．

- 任意の $ i $ ($ 1\leq\ i\leq\ N $) に対して $ \lvert\ A_i\ -\ i\rvert\ \geq\ K $ が成り立つ．

そのような順列が存在しない場合には，`-1` を出力してください．

 数列の辞書順とは？ 相異なる数列 $ S $ と数列 $ T $ の大小を判定するアルゴリズムを以下に説明します．

以下では $ S $ の $ i $ 番目の要素を $ S_i $ のように表します．また， $ S $ が $ T $ より辞書順で小さい場合は $ S\ \lt\ T $ ，大きい場合は $ S\ \gt\ T $ と表します．

1. $ S $ と $ T $ のうち長さが短い方の文字列の長さを $ L $ とします．$ i=1,2,\dots,L $ に対して $ S_i $ と $ T_i $ が一致するか調べます．
2. $ S_i\ \neq\ T_i $ である $ i $ が存在する場合，そのような $ i $ のうち最小のものを $ j $ とします．そして，$ S_j $ と $ T_j $ を比較して， $ S_j $ が $ T_j $ より（数として）小さい場合は $ S\ \lt\ T $ ，大きい場合は $ S\ \gt\ T $ と決定して，アルゴリズムを終了します．
3. $ S_i\ \neq\ T_i $ である $ i $ が存在しない場合， $ S $ と $ T $ の長さを比較して，$ S $ が $ T $ より短い場合は $ S\ \lt\ T $ ，長い場合は $ S\ \gt\ T $ と決定して，アルゴリズムを終了します．

## 输入格式

入力は以下の形式で標準入力から与えられます．

> $ N $ $ K $

## 输出格式

条件を満たす順列 $ A $ のうち，辞書順最小のものを次の形式で出力してください．

> $ A_1 $ $ A_2 $ $ \ldots $ $ A_N $

そのような順列が存在しない場合には，`-1` を出力してください．

## 说明/提示

### 制約

- $ 2\leq\ N\leq\ 3\times\ 10^5 $
- $ 1\leq\ K\leq\ N\ -\ 1 $

### Sample Explanation 1

条件を満たす順列は，$ (2,\ 3,\ 1) $ と $ (3,\ 1,\ 2) $ の $ 2 $ つです．例えば $ (2,\ 3,\ 1) $ は - $ \lvert\ A_1\ -\ 1\rvert\ =\ 1\ \geq\ K $ - $ \lvert\ A_2\ -\ 2\rvert\ =\ 1\ \geq\ K $ - $ \lvert\ A_3\ -\ 3\rvert\ =\ 2\ \geq\ K $ であるため条件を満たしています．

## 样例 #1

### 输入

```
3 1
```

### 输出

```
2 3 1
```

## 样例 #2

### 输入

```
8 3
```

### 输出

```
4 5 6 7 8 1 2 3
```

## 样例 #3

### 输入

```
8 6
```

### 输出

```
-1
```



---

---
title: "[ARC146B] Plus and AND"
layout: "post"
diff: 普及+/提高
pid: AT_arc146_b
tag: []
---

# [ARC146B] Plus and AND

## 题目描述

[problemUrl]: https://atcoder.jp/contests/arc146/tasks/arc146_b

長さ $ N $ の非負整数列 $ A=(A_1,A_2,\dots,A_N) $ が与えられます。あなたは以下の操作を $ M $ 回以下行うことができます。($ 1 $ 回も行わなくてもよいです。)

- $ 1\ \le\ i\ \le\ N $ を満たす整数 $ i $ を選び、$ A_i $ を $ 1 $ 増やす。

その後、$ A $ の中から $ K $ 要素を選びます。

選んだ $ K $ 要素のビット単位 $ \mathrm{AND} $ の最大値を求めてください。

  ビット単位 $ \mathrm{AND} $ 演算とは  整数 $ A,\ B $ のビット単位 $ \mathrm{AND} $、$ A\ \mathrm{AND}\ B $ は以下のように定義されます。

- $ A\ \mathrm{AND}\ B $ を二進表記した際の $ 2^k $ ($ k\ \geq\ 0 $) の位の数は、$ A,\ B $ を二進表記した際の $ 2^k $ の位の数のうち両方が $ 1 $ であれば $ 1 $、そうでなければ $ 0 $ である。
 
 例えば、$ 3\ \mathrm{AND}\ 5\ =\ 1 $ となります (二進表記すると: $ 011\ \mathrm{AND}\ 101\ =\ 001 $)。  
 一般に $ k $ 個の整数 $ p_1,\ p_2,\ p_3,\ \dots,\ p_k $ のビット単位 $ \mathrm{AND} $ は $ (\dots\ ((p_1\ \mathrm{AND}\ p_2)\ \mathrm{AND}\ p_3)\ \mathrm{AND}\ \dots\ \mathrm{AND}\ p_k) $ と定義され、これは $ p_1,\ p_2,\ p_3,\ \dots\ p_k $ の順番によらないことが証明できます。 ​

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ M $ $ K $ $ A_1 $ $ A_2 $ $ \dots $ $ A_N $

## 输出格式

答えを出力せよ。

## 说明/提示

### 制約

- $ 1\ \le\ K\ \le\ N\ \le\ 2\ \times\ 10^5 $
- $ 0\ \le\ M\ <\ 2^{30} $
- $ 0\ \le\ A_i\ <\ 2^{30} $
- 入力は全て整数である。

### Sample Explanation 1

以下のような手順を踏むことで 選んだ $ 2 $ 要素の $ \mathrm{AND} $ として $ 10 $ を達成できます。 - $ A_3 $ を選ぶ操作を $ 6 $ 回行う。$ A_3\ =\ 10 $ となる。 - $ A_4 $ を選ぶ操作を $ 2 $ 回行う。$ A_4\ =\ 10 $ となる。 - $ A_3,A_4 $ を選ぶ。$ 2 $ 要素の $ \mathrm{AND} $ は $ 10 $ である。 選んだ $ 2 $ 要素の $ \mathrm{AND} $ を $ 11 $ 以上にすることはできないので、解は $ 10 $ です。

## 样例 #1

### 输入

```
4 8 2

1 2 4 8
```

### 输出

```
10
```

## 样例 #2

### 输入

```
5 345 3

111 192 421 390 229
```

### 输出

```
461
```



---

---
title: "[ARC148C] Lights Out on Tree"
layout: "post"
diff: 普及+/提高
pid: AT_arc148_c
tag: []
---

# [ARC148C] Lights Out on Tree

## 题目描述

[problemUrl]: https://atcoder.jp/contests/arc148/tasks/arc148_c

頂点に $ 1 $ から $ N $ の番号がついた $ N $ 頂点の根付き木があります。頂点 $ 1 $ が根で、頂点 $ i $ $ (2\ \leq\ i\ \leq\ N) $ の親は頂点 $ P_i $ です。  
 表裏のあるコインが $ N $ 枚あります。コインは全ての頂点の上に $ 1 $ 枚ずつ載っています。  
 また、$ 1 $ から $ N $ までの番号がついた $ N $ 個のボタンがあります。ボタン $ n $ を押すと $ n $ を根とする部分木に含まれる頂点に載っている全てのコインが裏返ります。

以下で説明するクエリを $ Q $ 個処理してください。

$ i $ 番目のクエリではサイズ $ M_i $ の頂点集合 $ S_i\ =\ \lbrace\ v_{i,1},\ v_{i,2},\dots,\ v_{i,M_i}\ \rbrace $ が与えられます。  
 今、$ S_i $ に含まれる頂点の上に載っているコインは表を、それ以外のコインは裏を向いています。ボタンを $ 1 $ つ選んで押すことを繰り返して、$ N $ 枚のコイン全てを裏向きにするには、最小で何回ボタンを押す必要がありますか？答えを出力してください。ただし、どのようにボタンを押しても $ N $ 枚のコイン全てが裏向きにならない場合は $ -1 $ を出力してください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ Q $ $ P_2 $ $ P_3 $ $ \dots $ $ P_N $ $ M_1 $ $ v_{1,1} $ $ v_{1,2} $ $ \dots $ $ v_{1,M_1} $ $ M_2 $ $ v_{2,1} $ $ v_{2,2} $ $ \dots $ $ v_{2,M_2} $ $ \vdots $ $ M_Q $ $ v_{Q,1} $ $ v_{Q,2} $ $ \dots $ $ v_{Q,M_Q} $

## 输出格式

$ Q $ 行出力せよ。$ i $ 行目には $ i $ 番目のクエリの答えを出力せよ。

## 说明/提示

### 制約

- $ 2\ \leq\ N\ \leq\ 2\ \times\ 10^5 $
- $ 1\ \leq\ P_i\ \lt\ i $
- $ 1\ \leq\ Q\ \leq\ 2\ \times\ 10^5 $
- $ 1\ \leq\ M_i $
- $ \displaystyle\ \sum_{i=1}^Q\ M_i\ \leq\ 2\ \times\ 10^5 $
- $ 1\ \leq\ v_{i,j}\ \leq\ N $
- $ v_{i,1},\ v_{i,2},\dots,v_{i,M_i} $ は互いに異なる
- 入力される値はすべて整数

### Sample Explanation 1

$ 1 $ 番目のクエリについて、以下に説明するようにボタンを $ 1 $ 回押すことで条件を満たすことができて、これが最小です。 - ボタン $ 1 $ を押す。頂点 $ 1,2,3,4,5,6 $ に載っているコインが裏返る。 $ 2 $ 番目のクエリについて、以下に説明するようにボタンを $ 2 $ 回押すことで条件を満たすことができて、これが最小です。 - ボタン $ 4 $ を押す。頂点 $ 4 $ に載っているコインが裏返る。 - ボタン $ 2 $ を押す。頂点 $ 2,4,5,6 $ に載っているコインが裏返る。

## 样例 #1

### 输入

```
6 6

1 1 2 2 5

6 1 2 3 4 5 6

3 2 5 6

1 3

3 1 2 3

3 4 5 6

4 2 3 4 5
```

### 输出

```
1

2

1

3

2

3
```



---

---
title: "[ARC149B] Two LIS Sum"
layout: "post"
diff: 普及+/提高
pid: AT_arc149_b
tag: []
---

# [ARC149B] Two LIS Sum

## 题目描述

[problemUrl]: https://atcoder.jp/contests/arc149/tasks/arc149_b

数列 $ P\ =\ (P_1,\ \ldots,\ P_N) $ に対し，その最長増加部分列の長さを $ \mathrm{LIS}(P) $ と書くことにします．

$ 1 $ 以上 $ N $ 以下の整数からなる順列 $ A\ =\ (A_1,\ \ldots,\ A_N) $ および $ B\ =\ (B_1,\ \ldots,\ B_N) $ が与えられます．これらの数列に対して，以下の操作を何度でも行うことができます（$ 0 $ 回でもよいです）．

- $ 1\leq\ i\leq\ N-1 $ となる整数 $ i $ をひとつ選ぶ．$ A_i $ と $ A_{i+1} $ をスワップし，$ B_i $ と $ B_{i+1} $ をスワップする．

操作結果の $ \mathrm{LIS}(A)\ +\ \mathrm{LIS}(B) $ としてありうる最大値を答えてください．

 最長増加部分列とは 数列の部分列とは，数列から $ 0 $ 個以上の要素を取り除いた後，残りの要素を元の順序で連結して得られる数列のことをいいます． 例えば，$ (10,30) $ は $ (10,20,30) $ の部分列ですが，$ (20,10) $ は $ (10,20,30) $ の部分列ではありません．

 数列の最長増加部分列とは，数列の狭義単調増加な部分列のうち，長さが最大のもののことをいいます．

## 输入格式

入力は以下の形式で標準入力から与えられます．

> $ N $ $ A_1 $ $ \ldots $ $ A_N $ $ B_1 $ $ \ldots $ $ B_N $

## 输出格式

操作結果の $ \mathrm{LIS}(A)\ +\ \mathrm{LIS}(B) $ としてありうる最大値を出力してください．

## 说明/提示

### 制約

- $ 2\leq\ N\leq\ 3\times\ 10^5 $
- $ 1\leq\ A_i\leq\ N $
- $ 1\leq\ B_i\leq\ N $
- $ i\neq\ j $ ならば $ A_i\neq\ A_j $ かつ $ B_i\neq\ B_j $

### Sample Explanation 1

例えば次のように操作を行うことで，$ \mathrm{LIS}(A)\ +\ \mathrm{LIS}(B)\ =\ 8 $ を達成できます． - $ i\ =\ 2 $ として操作を行う．$ A\ =\ (5,1,2,4,3) $, $ B\ =\ (3,2,1,5,4) $ となる． - $ i\ =\ 1 $ として操作を行う．$ A\ =\ (1,5,2,4,3) $, $ B\ =\ (2,3,1,5,4) $ となる． - $ i\ =\ 4 $ として操作を行う．$ A\ =\ (1,5,2,3,4) $, $ B\ =\ (2,3,1,4,5) $ となる． このとき $ A $ は最長増加部分列 $ (1,2,3,4) $ を持ち，$ \mathrm{LIS}(A)=4 $ が成り立ちます．$ B $ は最長増加部分列 $ (2,3,4,5) $ を持ち，$ \mathrm{LIS}(B)=4 $ が成り立ちます．

### Sample Explanation 2

操作を $ 1 $ 度も行わないことにより，$ \mathrm{LIS}(A)\ +\ \mathrm{LIS}(B)\ =\ 10 $ を達成できます．

## 样例 #1

### 输入

```
5

5 2 1 4 3

3 1 2 5 4
```

### 输出

```
8
```

## 样例 #2

### 输入

```
5

1 2 3 4 5

1 2 3 4 5
```

### 输出

```
10
```



---

---
title: "[ARC149C] Avoid Prime Sum"
layout: "post"
diff: 普及+/提高
pid: AT_arc149_c
tag: []
---

# [ARC149C] Avoid Prime Sum

## 题目描述

[problemUrl]: https://atcoder.jp/contests/arc149/tasks/arc149_c

正整数 $ N $ が与えられます．

$ N $ 行 $ N $ 列からなるマス目の各マスに $ N^2 $ 以下の正整数を $ 1 $ つずつ書き込んで，以下の条件がすべて成り立つようにしてください．

- 上下左右の $ 4 $ 方向いずれかに隣接する $ 2 $ マスに書き込まれた正整数の和は，どれも素数ではない．
- $ N^2 $ 以下の正整数はすべてどれかのマスに $ 1 $ 度ずつ書き込まれている．

なお本問題の制約のもと，このような書き込み方が必ず存在することが証明できます．

## 输入格式

入力は以下の形式で標準入力から与えられます．

> $ N $

## 输出格式

$ i $ 行 $ j $ 列に書き込む正整数を $ A_{ij} $ として，条件を満たす書き込み方を，以下の形式で出力してください．

> $ A_{11} $ $ \ldots $ $ A_{1N} $ $ \vdots $ $ A_{N1} $ $ \ldots $ $ A_{NN} $

条件を満たす書き込み方が複数存在する場合は，どれを出力しても正解となります．

## 说明/提示

### 制約

- $ 3\leq\ N\leq\ 1000 $

### Sample Explanation 1

このマス目には $ 1 $ 以上 $ 16 $ 以下の正整数がすべて $ 1 $ 度ずつ書き込まれています．また隣接する $ 2 $ マスに書き込まれた正整数の和には $ 15+11=26 $, $ 11+16=27 $, $ 15+13=28 $ などがありますが，これらはすべて素数ではありません．

## 样例 #1

### 输入

```
4
```

### 输出

```
15 11 16 12

13 3 6 9

14 7 8 1

4 2 10 5
```



---

---
title: "[ARC150B] Make Divisible"
layout: "post"
diff: 普及+/提高
pid: AT_arc150_b
tag: []
---

# [ARC150B] Make Divisible

## 题目描述

[problemUrl]: https://atcoder.jp/contests/arc150/tasks/arc150_b

正整数 $ A,\ B $ が与えられます。

非負整数 $ X,\ Y $ であって、 $ B+Y $ が $ A+X $ の倍数となるようなものに対する $ X+Y $ の最小値を求めてください。

$ T $ 個のテストケースが与えられるので、それぞれについて求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられます。

> $ T $ $ \mathrm{case}_{1} $ $ \mathrm{case}_{2} $ $ \vdots $ $ \mathrm{case}_{T} $

各ケースは以下の形式で与えられます。

> $ A $ $ B $

## 输出格式

$ T $ 行出力してください。 $ i $ 行目には $ i $ 番目のテストケースに対する答えを出力してください。

## 说明/提示

### 制約

- $ 1\ \leq\ T\ \leq\ 100 $
- $ 1\ \leq\ A,\ B\ \leq\ 10^9 $
- 入力される値はすべて整数

### Sample Explanation 1

$ 1 $ 個目のテストケースについて、$ X=1,\ Y=1 $ とすると $ B+Y=24 $ は $ A+X=12 $ の倍数になります。このとき $ X+Y=2 $ であり、$ X+Y $ はこれより小さくすることはできないので答えは $ 2 $ です。 $ 2 $ 個目のテストケースについて、$ X=0,\ Y=0 $ とすると $ B+Y=16 $ は $ A+X=8 $ の倍数になります。

## 样例 #1

### 输入

```
5

11 23

8 16

4394 993298361

95392025 569922442

8399283 10293
```

### 输出

```
2

0

65

2429708

8388990
```



---

---
title: "[ARC150C] Path and Subsequence"
layout: "post"
diff: 普及+/提高
pid: AT_arc150_c
tag: []
---

# [ARC150C] Path and Subsequence

## 题目描述

[problemUrl]: https://atcoder.jp/contests/arc150/tasks/arc150_c

$ N $ 頂点 $ M $ 辺の連結無向グラフ $ G $ があります。頂点には $ 1 $ から $ N $ の番号がついています。$ i $ 番目の辺は頂点 $ U_i,\ V_i $ を結びます。

また、長さ $ N $ の整数列 $ A=(A_1,\ A_2,\ \dots,\ A_N) $ 、および長さ $ K $ の整数列 $ B=(B_1,\ B_2,\ \dots,\ B_K) $ が与えられます。

$ G,\ A,\ B $ が以下の条件を満たすか判定してください。

- $ G $ における頂点 $ 1 $ から $ N $ への任意の単純パス $ v=(v_1,\ v_2,\ \dots,\ v_k)\ (v_1=1,\ v_k=N) $ に対し、$ B $ は $ (A_{v_1},\ A_{v_2},\ \dots,\ A_{v_k}) $ の（連続とは限らない）部分列になる。

## 输入格式

入力は以下の形式で標準入力から与えられます。

> $ N $ $ M $ $ K $ $ U_1 $ $ V_1 $ $ U_2 $ $ V_2 $ $ \vdots $ $ U_M $ $ V_M $ $ A_1 $ $ A_2 $ $ \dots $ $ A_N $ $ B_1 $ $ B_2 $ $ \dots $ $ B_K $

## 输出格式

条件を満たす場合 `Yes` と、満たさない場合 `No` と出力してください。

## 说明/提示

### 制約

- $ 2\ \leq\ N\ \leq\ 10^5 $
- $ 1\ \leq\ K\ \leq\ N $
- $ N-1\ \leq\ M\ \leq\ 2\ \times\ 10^5 $
- $ 1\ \leq\ U_i\ <\ V_i\ \leq\ N $
- $ i\ \neq\ j $ ならば $ (U_i,\ V_i)\ \neq\ (U_j,\ V_j) $
- $ 1\ \leq\ A_i,\ B_i\ \leq\ N $
- 入力される値はすべて整数
- 与えられるグラフ $ G $ は連結

### Sample Explanation 1

頂点 $ 1 $ から頂点 $ 6 $ への単純パスは $ (1,\ 2,\ 4,\ 6),\ (1,\ 3,\ 5,\ 6) $ の $ 2 $ 通りであり、これらに対する $ (A_{v_1},\ A_{v_2},\ \dots,\ A_{v_k}) $ はそれぞれ $ (1,\ 2,\ 5,\ 6),\ (1,\ 4,\ 2,\ 6) $ です。 これらはいずれも $ B=(1,\ 2,\ 6) $ を部分列に持つので答えは `Yes` です。

### Sample Explanation 2

頂点 $ 1 $ から頂点 $ 5 $ への単純パスである $ (1,\ 2,\ 5) $ に対する $ (A_{v_1},\ A_{v_2},\ \dots,\ A_{v_k}) $ は $ (1,\ 2,\ 2) $ であり、これは $ B=(1,\ 3,\ 2) $ を部分列に持ちません。

## 样例 #1

### 输入

```
6 6 3

1 2

1 3

2 4

3 5

4 6

5 6

1 2 4 5 2 6

1 2 6
```

### 输出

```
Yes
```

## 样例 #2

### 输入

```
5 5 3

1 2

2 3

3 4

4 5

2 5

1 2 3 5 2

1 3 2
```

### 输出

```
No
```

## 样例 #3

### 输入

```
10 20 3

5 6

5 10

5 7

3 5

3 7

2 6

3 8

4 5

5 8

7 10

1 6

1 9

4 6

1 2

1 4

6 7

4 8

2 5

3 10

6 9

2 5 8 5 1 5 1 1 5 10

2 5 1
```

### 输出

```
Yes
```



---

---
title: "[ARC151B] A < AP"
layout: "post"
diff: 普及+/提高
pid: AT_arc151_b
tag: []
---

# [ARC151B] A < AP

## 题目描述

[problemUrl]: https://atcoder.jp/contests/arc151/tasks/arc151_b

$ (1,\ 2,\ \ldots,\ N) $ の順列 $ P\ =\ (P_1,\ P_2,\ \ldots,\ P_N) $ が与えられます。

下記の $ 2 $ つの条件をともに満たす長さ $ N $ の整数列 $ A\ =\ (A_1,\ A_2,\ \ldots,\ A_N) $ の個数を $ 998244353 $ で割ったあまりを出力してください。

- すべての $ i\ =\ 1,\ 2,\ \ldots,\ N $ について、$ 1\ \leq\ A_i\ \leq\ M $。
- 整数列 $ A $ は整数列 $ (A_{P_1},\ A_{P_2},\ \ldots,\ A_{P_N}) $ より辞書順で小さい。
 
辞書順で小さいとは？整数列 $ X\ =\ (X_1,\ X_2,\ \ldots,\ X_N) $ が 整数列 $ Y\ =\ (Y_1,\ Y_2,\ \ldots,\ Y_N) $ より**辞書順で小さい**とは、下記の $ 2 $ つの条件をともに満たす整数 $ 1\ \leq\ i\ \leq\ N $ が存在することを言います。

- $ 1\ \leq\ j\ \leq\ i-1 $ を満たすすべての整数 $ j $ について、$ X_j\ =\ Y_j $
- $ X_i\ \lt\ Y_i $

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ M $ $ P_1 $ $ P_2 $ $ \ldots $ $ P_N $

## 输出格式

問題文中の $ 2 $ つの条件をともに満たす整数列 $ A $ の個数を $ 998244353 $ で割ったあまりを出力せよ。

## 说明/提示

### 制約

- $ 1\ \leq\ N\ \leq\ 2\ \times\ 10^5 $
- $ 1\ \leq\ M\ \leq\ 10^9 $
- $ 1\ \leq\ P_i\ \leq\ N $
- $ i\ \neq\ j\ \implies\ P_i\ \neq\ P_j $
- 入力はすべて整数

### Sample Explanation 1

問題文中の $ 2 $ つの条件をともに満たす整数列 $ A $ は、 $ (1,\ 1,\ 1,\ 2),\ (1,\ 1,\ 2,\ 2),\ (1,\ 2,\ 1,\ 2),\ (1,\ 2,\ 2,\ 2),\ (2,\ 1,\ 1,\ 2),\ (2,\ 1,\ 2,\ 2) $ の $ 6 $ 個です。 例えば、$ A\ =\ (1,\ 1,\ 1,\ 2) $ のとき、$ (A_{P_1},\ A_{P_2},\ A_{P_3},\ A_{P_4})\ =\ (2,\ 1,\ 1,\ 1) $ であり、これは $ A $ より辞書順で大きいです。

## 样例 #1

### 输入

```
4 2

4 1 3 2
```

### 输出

```
6
```

## 样例 #2

### 输入

```
1 1

1
```

### 输出

```
0
```

## 样例 #3

### 输入

```
20 100000

11 15 3 20 17 6 1 9 5 19 10 16 7 8 12 2 18 14 4 13
```

### 输出

```
55365742
```



---

---
title: "[ARC152B] Pass on Path"
layout: "post"
diff: 普及+/提高
pid: AT_arc152_b
tag: []
---

# [ARC152B] Pass on Path

## 题目描述

[problemUrl]: https://atcoder.jp/contests/arc152/tasks/arc152_b

長さ $ L $ の細長い一直線の道が東西に伸びており、この道を $ 2 $ 人の旅人が訪れます。 この道には $ N $ 個の休憩所があり、$ i $ 番目の休憩所は、道の西端から $ a_i $ の地点にあります （ただし、どの休憩所も道の端には存在しません）。 この道はとても細いため、休憩所以外の地点で $ 2 $ 人がすれ違ったり、横に並んで歩いたりすることはできません。

$ 2 $ 人の旅人は、この道で次のような旅をします。

- 時刻 $ 0 $ に、それぞれ好きな休憩所を選んで出発点とする（ $ 2 $ 人が同じ休憩所を選んでもよい）。 その後、それぞれ道の両端を訪れたあと、自身の出発点に戻る。
 
$ 2 $ 人は、毎秒 $ 1 $ 以下の速さで道を歩くか、休憩所で休憩することができます。 休憩所以外の地点ですれ違わない限り、旅の途中いつでも向きを変えることは可能です。 両者が道の両端を訪れて出発点に戻ってくるまで、最短で何秒かかるでしょうか。 ただし、この問題の制約下では答えが整数になることが証明できます。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ L $ $ a_1 $ $ a_2 $ $ \ldots $ $ a_N $

## 输出格式

答えを整数で出力せよ。

## 说明/提示

### 制約

- $ 1\ \leq\ N\ \leq\ 2\ \times\ 10^5 $
- $ 1\ \leq\ L\ \leq\ 10^9 $
- $ 0\ <\ a_1\ <\ a_2\ <\ \ldots\ <\ a_N\ <\ L $
- 入力される値はすべて整数である
 
### Sample Explanation 1

$ 2 $ 人の旅人を A、B とします。また、以下では $ i $ 番目の休憩所を単に休憩所 $ i $ と呼びます。 例えば、$ 2 $ 人は以下のような旅をすることができます。 最初に A が休憩所 $ 1 $ から東側に、B が休憩所 $ 2 $ から東側に速さ $ 1 $ で歩き始め、両者とも東端→西端の順に訪れることにします。 すると、B は $ 2 $ 秒後に東端を訪れて休憩所 $ 2 $ に戻って来ることができますが、A はまだ休憩所 $ 1 $ と $ 2 $ の間です。 ここで B が $ 1 $ 秒休憩すると、A も休憩所 $ 2 $ にたどり着き、すれ違いが可能になります。 その後、再び両者が速さ $ 1 $ で歩き続け、A が休憩所 $ 1 $ で $ 2 $ 秒だけ休憩した場合、 B は出発から $ 13 $ 秒後、A は $ 14 $ 秒後に元の休憩所に戻り、旅を終えることができます。 実はこれは最善の方法の $ 1 $ つであり、答えは $ 14 $ となります。

### Sample Explanation 2

この場合は、適切な方法を取ると、両者が休憩することなく速さ $ 1 $ で歩き続けることができます。

## 样例 #1

### 输入

```
2 6

2 5
```

### 输出

```
14
```

## 样例 #2

### 输入

```
2 3

1 2
```

### 输出

```
6
```



---

---
title: "[ARC155A] ST and TS  Palindrome"
layout: "post"
diff: 普及+/提高
pid: AT_arc155_a
tag: ['分类讨论']
---

# [ARC155A] ST and TS  Palindrome

## 题目描述

[problemUrl]: https://atcoder.jp/contests/arc155/tasks/arc155_a

英小文字からなる長さ $ N $ の文字列 $ S $ と正整数 $ K $ が与えられます。

以下の条件を満たす長さ $ K $ の文字列 $ S' $ が存在するか判定してください。

- $ S,\ S' $ をこの順に結合して得られる文字列は回文である
- $ S',\ S $ をこの順に結合して得られる文字列は回文である
 
$ T $ 個のテストケースが与えられるのでそれぞれについて判定してください。

## 输入格式

入力は以下の形式で標準入力から与えられます。

> $ T $ $ \mathrm{case}_1 $ $ \vdots $ $ \mathrm{case}_T $

各ケースは以下の形式で与えられます。

> $ N $ $ K $ $ S $

## 输出格式

$ T $ 行出力せよ。$ i $ 行目には $ i $ 番目のテストケースについて、条件を満たす文字列 $ S' $ が存在する場合は `Yes` を、存在しない場合は `No` を出力せよ。

## 说明/提示

### 制約

- $ 1\ \leq\ T\ \leq\ 10^5 $
- $ 1\ \leq\ N\ \leq\ 2\ \times\ 10^5 $
- $ 1\ \leq\ K\ \leq\ 10^{18} $
- $ S $ は英小文字からなる長さ $ N $ の文字列
- 入力される数値はすべて整数
- $ 1 $ つの入力に含まれるテストケースについて、 $ N $ の総和は $ 2\ \times\ 10^5 $ 以下
 
### Sample Explanation 1

$ 1 $ 番目のテストケースについて、例えば $ S'\ =\ {} $`ba` とすると $ S,S' $ をこの順に結合して得られる文字列 `abbaabba` は回文になっています。また、 $ S',S $ をこの順に結合して得られる文字列 `baabbaab` も回文になっています。以上より $ S'\ =\ {} $`ba` は条件を満たすので答えは `Yes` になります。 $ 2 $ 番目のテストケースについては、条件を満たす $ S' $ が存在しないことが証明できます。

## 样例 #1

### 输入

```
2

6 2

abbaab

5 3

abcbb
```

### 输出

```
Yes

No
```

## 样例 #2

### 输入

```
3

12 400378271514996652

njvhhvjnnjvh

10 884633988115575508

rrhiyvrrur

36 71630165869626180

vsxmxajrrduhhudrrjaxmxsvvsxmxajrrduh
```

### 输出

```
Yes

No

Yes
```



---

---
title: "ヘイホー君と削除"
layout: "post"
diff: 普及+/提高
pid: AT_cf_2015_morning_easy_d
tag: []
---

# ヘイホー君と削除

## 题目描述

一个字符串重复两次会得到一个平方字符串。例如，`abcabc`、`abababab`都是平方字符串；而`abc`和`ababab`都不是平方字符串；长度为0的字符串，也是平方字符串。



一天，ヘイホー君得到了一个只包含小写英文字母的字符串，他想让你删除任意P个字符后变成平方字符串。



求P（也就是删除次数）的最小值。

## 输入格式

- 第一行，一个整数N($1 \leq n \leq 100$)，表示ヘイホー君得到的字符串的长度。



- 第二行，为ヘイホー君得到的字符串。

## 输出格式

在一行输出P（最小删除次数），末尾要有换行。



### 关于样例#2



输出样例#2有误，ATC官网的输出样例#2为0。

## 样例 #1

### 输入

```
8

abacbabc
```

### 输出

```
2
```

## 样例 #2

### 输入

```
8

abababab
```

### 输出

```
0
```

## 样例 #3

### 输入

```
5

abcde
```

### 输出

```
5
```

## 样例 #4

### 输入

```
26

codefestivaltwozeroonefive
```

### 输出

```
14
```



---

---
title: "一次元オセロ"
layout: "post"
diff: 普及+/提高
pid: AT_cf_2015_morning_hard_a
tag: []
---

# 一次元オセロ

## 题目描述

小A在玩一维奥赛罗。一维奥赛罗是一种在无限长的一行格子内摆放棋子的游戏。棋子的一面是黑色，而另一面是白色。

它的规则如下：

1. 首先按照白色棋子  $A_1$ 个，黑色棋子  $A_2$ 个，白色棋子  $A_3$ 个，...，白色棋子  $A_N$ 个这样的顺序进行摆放。
2. 把黑色的棋子放在任意一个空闲位置。这时，所放置的位置左右的2格中必须正好1格有白色的棋子。
3. 将距离放置的黑色棋子最近的其他黑色棋子之间的白色陀螺全部翻过来做成黑色的棋子，这样的若干对黑色棋子总是唯一确定的。
4. 黑白棋子交换。
5. 重复  $2$～  $4$。
6.   步骤$3$ 或  $4$结束时，如果所有的棋子颜色相同，则游戏结束。

因为要把很多棋子翻过来是很困难的，所以小A想把棋子翻过来的次数减少一些。请在游戏结束前，求小A翻转棋子的次数之和的最小值。

## 输入格式

第一行是一个整数  $N(3\leqslant N<10^5,N$ 为奇数 $)$。

第二行是  $N$ 个整数，分别表示  $A_1,A_2,...,A_N$。

## 输出格式

游戏结束时小A反转棋子的最少次数。输出这个数。

## 说明/提示

像图片中所示的一样反转棋子，一共反转了  $1+4+5+10=20$ 次棋子，使得游戏结束。

翻译By @[liuziwen0224](/user/141683)

## 样例 #1

### 输入

```
5

1 2 3 4 5
```

### 输出

```
20
```

## 样例 #2

### 输入

```
9

100000000 20 15 11 14 20 15 11 15
```

### 输出

```
554
```



---

---
title: "辞書順で何番目？"
layout: "post"
diff: 普及+/提高
pid: AT_chokudai_S001_k
tag: []
---

# 辞書順で何番目？

## 题目描述

[problemUrl]: https://atcoder.jp/contests/chokudai_S001/tasks/chokudai_S001_k

長さ $ N $ の順列のうち、$ a $ は辞書順で何番目になるかを求めなさい。

ただし、答えは非常に大きくなるため、$ 1,000,000,007 $ で割った余りを出力しなさい。

## 说明/提示

### 制約

- $ 1\ \leq\ N\ \leq\ 100,000 $

## 样例 #1

### 输入

```
5

3 1 5 4 2
```

### 输出

```
54
```

## 样例 #2

### 输入

```
6

1 2 3 4 5 6
```

### 输出

```
1
```

## 样例 #3

### 输入

```
7

7 6 5 4 3 2 1
```

### 输出

```
5040
```

## 样例 #4

### 输入

```
20

19 11 10 7 8 9 17 18 20 4 3 15 16 1 5 14 6 2 13 12
```

### 输出

```
542869439
```



---

---
title: "種類数 β"
layout: "post"
diff: 普及+/提高
pid: AT_chokudai_S002_k
tag: []
---

# 種類数 β

## 题目描述

[problemUrl]: https://atcoder.jp/contests/chokudai_S002/tasks/chokudai_S002_k

整数のペアが $ N $ 組あります。$ i $ 番目の整数のペアは $ (A_i,\ B_i) $ です。

すぬけ君は各ペアからちょうど $ 1 $ つずつ整数を選ぼうとしています。選ばれた $ N $ 個の整数の**種類数**として考えられる最大値はいくらでしょうか？

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ A_1 $ $ B_1 $ $ A_2 $ $ B_2 $ $ : $ $ A_N $ $ B_N $

## 输出格式

すぬけ君が選ぶ $ N $ 個の整数の種類数として考えられる最大値を出力せよ。

## 说明/提示

### 制約

入力は以下の条件を満たす。

- $ 1\ \leq\ N\ \leq\ 2\ \times\ 10^5 $
- $ 1\ \leq\ A_i,B_i\ \leq\ 10^9 $
- 入力される値は全て整数

### Sample Explanation 1

各ペアからそれぞれ $ 58,58,20,425,48 $ を選ぶと $ 4 $ 種類の整数を選ぶことができます。$ 5 $ 種類以上の整数を選ぶことはできません。

## 样例 #1

### 输入

```
5

58 48

58 58

20 19

58 425

48 425
```

### 输出

```
4
```

## 样例 #2

### 输入

```
3

1000000000 1000000000

1000000000 1000000000

1000000000 1000000000
```

### 输出

```
1
```



---

---
title: "壊れた電車"
layout: "post"
diff: 普及+/提高
pid: AT_codefestival_2015_qualA_d
tag: []
---

# 壊れた電車

## 题目描述

[problemUrl]: https://atcoder.jp/contests/code-festival-2015-quala/tasks/codefestival_2015_qualA_d

高橋鉄道では、$ N $ 両編成の電車の一部が壊れてしまったため、$ M $ 人の整備士が点検をすることになりました。

$ i $ 人目の整備士ははじめ、$ X_i $ 両目の車両にいます。それぞれの整備士は、今いる車両を点検することと、隣の車両に移動することができます。車両の点検には時間はかかりませんが、隣の車両に移動するには $ 1 $ 分かかります。

全ての車両を少なくとも $ 1 $ 人の整備士が点検した状態になると点検作業は終了となります。点検作業は最短何分で終了させることができるでしょうか。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ M $ $ X_1 $ $ X_2 $ : $ X_M $

- $ 1 $ 行目には、$ 2 $ つの整数 $ N\ (1\ ≦\ N\ ≦\ 10^9),\ M\ (1\ ≦\ M\ ≦\ 10^5,\ M\ ≦\ N) $ が空白区切りで与えられる。これは、電車が $ N $ 両の車両からなり、整備士が $ M $ 人いることを表す。
- $ 2 $ 行目からの $ M $ 行には、整備士の情報が与えられる。このうち $ i\ (1\ ≦\ i\ ≦\ M) $ 行目には、整数 $ X_i\ (1\ ≦\ X_i\ ≦\ N) $ が与えられる。これは、$ i $ 人目の整備士がはじめ $ X_i $ 両目の車両にいることを表す。ただし、$ X_i $ は全て相異なることが保証される。また、整備士の情報は $ 1 $ 両目の車両に近い順に与えられる、つまり $ X_j\ <\ X_{j+1}\ (1\ ≦\ j\ ≦\ M-1) $ であることが保証される。

## 输出格式

点検作業にかかる時間の最小値を分単位で $ 1 $ 行に出力せよ。出力の末尾に改行を入れること。

## 说明/提示

### 部分点

この問題には部分点が設定されている。

- $ N\ ≦\ 100 $ を満たすデータセットに正解した場合は、$ 20 $ 点が与えられる。
- $ N\ ≦\ 500,000 $ を満たすデータセットに正解した場合は、上記とは別に $ 60 $ 点が与えられる。
- 追加の制約のないデータセットに正解した場合は、上記とは別に $ 20 $ 点が与えられる。

### Sample Explanation 1

下の図のように整備士が移動すれば $ 3 $ 分で点検作業を終了させることができます。 !\[figure1\](https://code-festival-2015-quala.contest.atcoder.jp/img/other/code\_festival\_2015\_quala/BrokenDensya.png)

## 样例 #1

### 输入

```
17 5

1

5

10

15

16
```

### 输出

```
3
```

## 样例 #2

### 输入

```
66 10

8

9

16

23

37

47

51

52

53

64
```

### 输出

```
8
```



---

---
title: "Exactly N points"
layout: "post"
diff: 普及+/提高
pid: AT_codefestival_2016_final_b
tag: []
---

# Exactly N points

## 题目描述

[problemUrl]: https://atcoder.jp/contests/cf16-final/tasks/codefestival_2016_final_b

ある年のCODE FESTIVALの決勝では $ N $ 問の問題が出題されました。

$ i\ (1≦i≦N) $ 番目の問題の配点は $ i $ 点です。

高橋くんは、このコンテストでちょうど $ N $ 点を取りたいと思い、そのために解く問題の集合をどうするかを考えています。

配点が高い問題は難しいので、解く問題の配点のうちの最大値が最小になるようにしようと考えました。

高橋くんが解くべき問題の集合を求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $

## 输出格式

点数の合計がちょうど $ N $ となるような集合のうち、配点の最大値が最小となるようなものを求め、その集合に含まれる問題の番号を $ 1 $ 行にひとつずつ出力せよ。昇順に出力する必要はありません。

そのような集合が複数考えられる場合は、いずれを出力しても構わない。

## 说明/提示

### 制約

- $ 1≦N≦10^7 $

### 部分点

- $ 1≦N≦1000 $ を満たすデータセットに正解した場合は、$ 200 $ 点が与えられる。
- 追加制約のないデータセットに正解した場合は、上記とは別に $ 100 $ 点が与えられる。

### Sample Explanation 1

$ 4 $ 番目の問題のみを解いた場合もちょうど $ 4 $ 点が得られますが、$ 1,3 $ 番目の問題を解く方が配点の最大値が小さくなります。

### Sample Explanation 2

$ \{3,4\} $ という集合も考えられます。

## 样例 #1

### 输入

```
4
```

### 输出

```
1

3
```

## 样例 #2

### 输入

```
7
```

### 输出

```
1

2

4
```

## 样例 #3

### 输入

```
1
```

### 输出

```
1
```



---

---
title: "Interpretation"
layout: "post"
diff: 普及+/提高
pid: AT_codefestival_2016_final_c
tag: []
---

# Interpretation

## 题目描述

用 $1$ 到 $m$ 这 $m$ 个正整数为 $m$ 种语言编号。现在有 $n$ 个人，他们的编号依次为 $1,2,...,n$。第 $i$ 个人会说这 $m$ 种语言中的 $k_i$ 种，它们的编号分别为 $l_{i,1},l_{i,2},...,l_{i,k_i}$。

现在，如果说编号 $a$ 和编号 $b$ 的两个人是“可以交流的”，当且仅当两人存在以下两种模式中的至少一种：

- 当 $a$ 和 $b$ 可以直接交流时，满足：存在至少一种语言，$a$ 和 $b$ 都会。
- 当 $a$ 和 $b$ 可以间接交流时，满足：存在一个人 $x$，他（她）可以分别与 $a$ 和 $b$ 直接交流。

请问：每个人是否都能和其他人中的任意一个直接或间接地交流？

## 输入格式

输入共 $(n+1)$ 行。第一行是一行两个以单个空格隔开的正整数 $n$ 和 $m$，接下来的 $n$ 行中，第 $i$ 行会输入 $(k_i+1)$ 个数，依次为 $k_i$ 和所有的 $l_{i,j}(1 \le j \le k_i)$，相邻的两个数之间以单个空格隔开。

## 输出格式

输出一行一个字符串。如果每个人都可以和其他人中的任意一个交流请输出`YES`；否则，请输出`NO`。

## 说明/提示

#### 输入输出样例 #1 说明

（为了简便，每个人直接用其编号代替，样例 $ \#2 $ 解释同）

任意两个人都可以交流，如下：

- $1$ 和 $2$ 都会说语言 $2$；
- $2$ 和 $3$ 都会说语言 $4$；
- $1$ 和 $3$ 可以通过 $2$ 间接交流；
- $3$ 和 $4$ 都会说语言 $6$；
- $2$ 和 $4$ 可以通过 $3$ 间接交流；
- $1$ 和 $4$ 可以通过 $2$ 间接交流。（这里请注意，$1$ 和 $4$ 是通过 $1-2-3-4$ 的链条来间接交流的）

#### 输入输出样例 #2 说明

例如，$1$ 和 $3$ 不能交流。

#### 数据规模与约定

所有输入数据保证：

- $2 \le n \le 10^5$，$1 \le m \le 10^5$，$1 \le k_i \le m$，且所有 $k_i$ 之和 $\le 10^5$；
- $1 \le l_{i,j} \le m$，且对于同一个 $i$ 来说，$l_{i,j}$ 互不相同。

## 样例 #1

### 输入

```
4 6

3 1 2 3

2 4 2

2 4 6

1 6
```

### 输出

```
YES
```

## 样例 #2

### 输入

```
4 4

2 1 2

2 1 2

1 3

2 4 3
```

### 输出

```
NO
```



---

---
title: "Pair Cards"
layout: "post"
diff: 普及+/提高
pid: AT_codefestival_2016_final_d
tag: []
---

# Pair Cards

## 题目描述

## 题意：

已知高桥君有 $n$ 张卡片，每一张卡牌上有一个整数 $x_i$。高桥君想要以以下两种条件合并两张卡牌：

$1$：两张卡牌上的整数相等。

$2$：两张卡牌上的整数之和是 $m$ 的倍数。

求出高桥君可以组成多少组的组数最大值。

注：一张卡牌不能在多组中使用。


------------

## 输入格式

第一行两个整数 $n$ 和 $m$。

接下来一行，有 $n$ 个整数：$x_1$，$x_2...x_n$。


------------

## 输出格式

输出组数的最大值。



------------

## 说明/提示

$2\le n \le 10^5$，$1\le m \le 10^5$，$1 \le x_i \le 10^5$。

## 样例 #1

### 输入

```
7 5

3 1 4 1 5 9 2
```

### 输出

```
3
```

## 样例 #2

### 输入

```
15 10

1 5 6 10 11 11 11 20 21 25 25 26 99 99 99
```

### 输出

```
6
```



---

---
title: "Gr-idian MST"
layout: "post"
diff: 普及+/提高
pid: AT_codefestival_2016_qualB_c
tag: []
---

# Gr-idian MST

## 题目描述

[problemUrl]: https://atcoder.jp/contests/code-festival-2016-qualb/tasks/codefestival_2016_qualB_c

$ xy $平面上の$ 0\ ≦\ x\ ≦\ W,\ 0\ ≦\ y\ ≦\ H $をみたす領域にある$ x,y $ともに整数である点すべてに、ひとつずつ家があります。

$ x $座標が等しく$ y $座標の差が$ 1 $であるか、$ y $座標が等しく$ x $座標の差が$ 1 $であるような$ 2 $点の組のうち、両方の点に家が存在するような全てのものに対し、その$ 2 $点の間には舗装されていない道路があります。

座標$ (i,j) $と$ (i+1,j) $にある家の間の道路を舗装するのには$ j $の値にかかわらずコストが$ p_i $、 座標$ (i,j) $と$ (i,j+1) $にある家の間の道路を舗装するのには$ i $の値にかかわらずコストが$ q_j $かかります。

高橋君は、このうちいくつかの道路を舗装し、舗装された道路のみを通って任意の$ 2 $つの家の間を行き来できるようにしたいです。 かかるコストの総和の最小値を求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ W $ $ H $ $ p_0 $ : $ p_{W-1} $ $ q_0 $ : $ q_{H-1} $

## 输出格式

コストの総和の最小値を表す整数を出力せよ。

## 说明/提示

### 制約

- $ 1\ ≦\ W,H\ ≦\ 10^5 $
- $ 1\ ≦\ p_i\ ≦\ 10^8(0\ ≦\ i\ ≦\ W-1) $
- $ 1\ ≦\ q_j\ ≦\ 10^8(0\ ≦\ j\ ≦\ H-1) $
- $ p_i(0\ ≦\ i\ ≦\ W-1) $は整数である
- $ q_j(0\ ≦\ j\ ≦\ H-1) $は整数である

### Sample Explanation 1

次の$ 8 $本の道路を舗装すればよいです。 - $ (0,0) $と$ (0,1) $にある家を結ぶ道路 - $ (0,1) $と$ (1,1) $にある家を結ぶ道路 - $ (0,2) $と$ (1,2) $にある家を結ぶ道路 - $ (1,0) $と$ (1,1) $にある家を結ぶ道路 - $ (1,0) $と$ (2,0) $にある家を結ぶ道路 - $ (1,1) $と$ (1,2) $にある家を結ぶ道路 - $ (1,2) $と$ (2,2) $にある家を結ぶ道路 - $ (2,0) $と$ (2,1) $にある家を結ぶ道路

## 样例 #1

### 输入

```
2 2

3

5

2

7
```

### 输出

```
29
```

## 样例 #2

### 输入

```
4 3

2

4

8

1

2

9

3
```

### 输出

```
60
```



---

---
title: "Greedy customers"
layout: "post"
diff: 普及+/提高
pid: AT_codefestival_2016_qualB_d
tag: []
---

# Greedy customers

## 题目描述

[problemUrl]: https://atcoder.jp/contests/code-festival-2016-qualb/tasks/codefestival_2016_qualB_d

高橋商店の前には、$ N $ 人の人が $ 1 $ 列に並んでいます。前から $ i $ 人目の人の所持金は正整数 $ A_i $ です。

店主の高橋君は、「品物を選んでその価格を表す正の整数 $ P $ を設定し、前の人から順にその品物を見せていく」というステップを繰り返します。

各ステップにおいて、各人は、品物を見せられた時、その価格 $ P $ が現時点でのその人の所持金以下だった場合その品物を購入し、高橋君の $ 1 $ 回のステップは終了します。 すなわち、所持金が $ P $ 以上の最初の人の所持金が $ P $ 減少し、次のステップに移ります。

高橋君は正整数 $ P $ の値を、ステップごとに独立に決めることができます。

高橋君はできるだけ多くの品物を売りたいですが、品物を売った人の所持金が $ 0 $ になってしまうと、その人は帰れなくなってしまいます。人が帰れなくなってしまうと高橋君は困ってしまうので、どの人の所持金も $ 0 $ にしてはいけません。

高橋君に代わって、各人の最初の所持金が与えられたとき、高橋君が最大でいくつの品物を売ることができるかを求めるプログラムを作成してください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ A_1 $ : $ A_N $

## 输出格式

高橋君が売ることのできる商品の最大数を表す整数を出力せよ。

## 说明/提示

### 制約

- $ 1\ ≦\ N\ ≦\ 100000 $
- $ 1\ ≦\ A_i\ ≦\ 10^9(1\ ≦\ i\ ≦\ N) $
- 入力はすべて整数である

### Sample Explanation 1

$ P $の値として、順に$ 1,4,1 $と選べばよいです。

## 样例 #1

### 输入

```
3

3

2

5
```

### 输出

```
3
```

## 样例 #2

### 输入

```
15

3

1

4

1

5

9

2

6

5

3

5

8

9

7

9
```

### 输出

```
18
```



---

---
title: "二人のアルピニスト"
layout: "post"
diff: 普及+/提高
pid: AT_codefestival_2016_qualC_c
tag: []
---

# 二人のアルピニスト

## 题目描述

[problemUrl]: https://atcoder.jp/contests/code-festival-2016-qualc/tasks/codefestival_2016_qualC_c

アルピニストである高橋君と青木君は最近ある有名な山脈を踏破しました。この山脈は$ N $ 個の山からなっており、西から東に向けて山$ 1 $,山$ 2 $,$ ... $,山$ N $と一直線に並んでいます。高橋君は西から、青木君は東からこの山脈を踏破しました。

山$ i $ の高さは$ h_i $ ですが、二人とも各$ h_i $ の値は忘れてしまいました。その代わり、各$ i\ (1≦i≦N) $ に対して、山$ i $ の山頂にたどり着いた時の、それまでに登った山(山$ i $ も含む)の高さの最大値を記録しています。 高橋君の記録した値は$ T_i $ で、青木君の記録した値は$ A_i $ です。

各山の高さ$ h_i $ が正の整数であることはわかっています。山の高さの列としてありうるものが何通りあるかを$ 10^9+7 $ で割ったあまりを求めてください。

ただし記録が間違っていてありうる山の高さの列が存在しないこともあります。この場合は$ 0 $を出力してください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ T_1 $ $ T_2 $ $ ... $ $ T_N $ $ A_1 $ $ A_2 $ $ ... $ $ A_N $

## 输出格式

山の高さの列としてありうるものが何通りあるかを $ 10^9+7 $ で割ったあまりを出力せよ。

## 说明/提示

### 制約

- $ 1≦N≦10^5 $
- $ 1≦T_i≦10^9 $
- $ 1≦A_i≦10^9 $
- $ T_i≦T_{i+1}\ (1≦i≦N-1) $
- $ A_i≧A_{i+1}\ (1≦i≦N-1) $

### Sample Explanation 1

山の高さの列として、 - $ 1,3,2,2,2 $ - $ 1,3,2,1,2 $ - $ 1,3,1,2,2 $ - $ 1,3,1,1,2 $ の$ 4 $通りがありえます。

### Sample Explanation 2

高橋君によると山を全て登り切った後の山の高さの最大値は$ 2 $で、青木君によると$ 3 $なので、記録は矛盾しています。

### Sample Explanation 3

$ 10^9+7 $ で割ったあまりを求めることを忘れないようにしてください。

### Sample Explanation 4

山が一つの山脈もあります。

## 样例 #1

### 输入

```
5

1 3 3 3 3

3 3 2 2 2
```

### 输出

```
4
```

## 样例 #2

### 输入

```
5

1 1 1 2 2

3 2 1 1 1
```

### 输出

```
0
```

## 样例 #3

### 输入

```
10

1 3776 3776 8848 8848 8848 8848 8848 8848 8848

8848 8848 8848 8848 8848 8848 8848 8848 3776 5
```

### 输出

```
884111967
```

## 样例 #4

### 输入

```
1

17

17
```

### 输出

```
1
```



---

---
title: "Palindromic Matrix"
layout: "post"
diff: 普及+/提高
pid: AT_code_festival_2017_quala_c
tag: []
---

# Palindromic Matrix

## 题目描述

[problemUrl]: https://atcoder.jp/contests/code-festival-2017-quala/tasks/code_festival_2017_quala_c

縦 $ H $ 行、横 $ W $ 列の行列 $ A $ があります。 上から $ i $ 行目、左から $ j $ 列目の要素を $ a_{ij} $ とします。 各 $ a_{ij} $ は英小文字です。

すぬけ君は、$ A $ の要素を自由に並べ替え、縦 $ H $ 行、横 $ W $ 列の行列 $ A' $ を作ろうとしています。 このとき、次の条件が成り立つようにします。

- $ A' $ のどの行およびどの列もそれぞれ回文になっている。

条件を満たす $ A' $ が存在するか判定してください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ H $ $ W $ $ a_{11} $$ a_{12} $$ ... $$ a_{1W} $ $ : $ $ a_{H1} $$ a_{H2} $$ ... $$ a_{HW} $

## 输出格式

条件を満たす $ A' $ が存在するならば `Yes` を、存在しないならば `No` を出力せよ。

## 说明/提示

### 注釈

回文とは、前後を反転しても変わらない文字列のことです。 例えば、`a`, `aa`, `abba`, `abcba` は回文ですが、`ab`, `abab`, `abcda` は回文ではありません。

### 制約

- $ 1\ <\ =\ H,\ W\ <\ =\ 100 $
- $ a_{ij} $ は英小文字である。

### Sample Explanation 1

例えば、次の $ A' $ は条件を満たします。 ``` abba acca abba ```

### Sample Explanation 2

どのように $ A $ の要素を並べ替えても、条件を満たす $ A' $ を作れません。

### Sample Explanation 3

例えば、次の $ A' $ は条件を満たします。 ``` t e w e t ```

## 样例 #1

### 输入

```
3 4

aabb

aabb

aacc
```

### 输出

```
Yes
```

## 样例 #2

### 输入

```
2 2

aa

bb
```

### 输出

```
No
```

## 样例 #3

### 输入

```
5 1

t

w

e

e

t
```

### 输出

```
Yes
```

## 样例 #4

### 输入

```
2 5

abxba

abyba
```

### 输出

```
No
```

## 样例 #5

### 输入

```
1 1

z
```

### 输出

```
Yes
```



---

---
title: "身体バランス"
layout: "post"
diff: 普及+/提高
pid: AT_code_festival_morning_easy_c
tag: []
---

# 身体バランス

## 题目描述

[problemUrl]: https://atcoder.jp/contests/code-festival-2014-morning-easy/tasks/code_festival_morning_easy_c

C さんは斜めがけの鞄を愛用しています。 しかし、片方の肩にばかり鞄をかけていると、身体が歪んでしまうと言われたため、両方の肩に同じ時間だけ鞄をかけるように心がけることにしています。

C さんの住んでいる国には、$ n $ 個の街と、街同士をつなぐ $ m $ 個の道があります。 どの $ 2 $ つの異なる道に関しても、結んでいる $ 2 $ つの街同士が一致することはありません。

C さんはある日、街 $ s $ から街 $ t $ へと移動する必要が出てきました。 そこで、途中の街 $ u $ で一度だけ鞄を持ち替えて、左右の肩に鞄をかける時間を同じにしたいと考えています。 しかし、C さんは最強最速なので、街 $ s $ から街 $ u $、街 $ u $ から街 $ t $ への移動は最短経路を通ります。

このような街 $ u $ の選び方があるかどうかを求めてください。

## 输入格式

入力は以下の形式で与えられる。

> $ n $ $ m $ $ s $ $ t $ $ x_1 $ $ y_1 $ $ d_1 $ $ x_2 $ $ y_2 $ $ d_2 $ $ ... $ $ x_m $ $ y_m $ $ d_m $

- $ 1 $ 行目には、街の数を表す整数 $ n $ ($ 3\ \leq\ n\ \leq\ 1{,}000 $) と、道の数を表す整数 $ m $ ($ 1\ \leq\ m\ \leq\ min(n(n-1)/2,\ 10^4) $) が与えられる。
- 街にはそれぞれ $ 1 $ から $ n $ までの番号が振られている。
- $ 2 $ 行目には、出発する街の番号を表す整数 $ s $ ($ 1\ \leq\ s\ \leq\ n $) と、目的地の街の番号を表す整数 $ t $ ($ 1\ \leq\ t\ \leq\ n $) が与えられる。
- 続く $ m $ 行には、各道の情報が与えられる。
- $ x_i,\ y_i $ ($ 1\ \leq\ x_i,\ y_i\ \leq\ n $ かつ $ x_i\ \neq\ y_i $) と $ d_i $ ($ 1\ \leq\ d_i\ \leq\ 1{,}000 $) は、$ i $ 番目の道によって街 $ x_i $ と街 $ y_i $ の間を移動するのに $ d_i $ の時間がかかることを意味する。
- 街 $ s $ から街 $ t $ へは到達可能であることが保証される。

## 输出格式

答えとなる街 $ u $ が存在する場合は、その街の番号を $ 1 $ 行で出力せよ。

答えの候補が複数ある場合は、どれを出力してもよい。

また、そのような街 $ u $ が無い場合は `-1` を出力せよ。

最後は改行し、余計な文字、空行を含まないこと。

## 说明/提示

### Sample Explanation 1

街 $ 1 $ から街 $ 2 $ へ行く際に、街 $ 3 $ を経由した場合、$ 1\ →\ 3 $ で $ 3 $ の時間がかかり、$ 3\ →\ 2 $ で $ 3 $ の時間がかかるため、街 $ 3 $ を経由して、そこで鞄を持ち替えればよい。

### Sample Explanation 2

$ 1\ →\ 2\ →\ 4\ →\ 3 $ という順に移動すれば、街 $ 4 $ で鞄を持ち替えることで左右にかかる負担を同じにすることができるが、C さんは街 $ 1 $ から街 $ 4 $ まで最短経路を通るので、このような移動のしかたはできない。

## 样例 #1

### 输入

```
3 3

1 2

1 3 3

3 2 3

1 2 1
```

### 输出

```
3
```

## 样例 #2

### 输入

```
4 4

1 3

1 2 2

1 4 3

2 4 3

3 4 5
```

### 输出

```
-1
```



---

---
title: "壊れた電卓"
layout: "post"
diff: 普及+/提高
pid: AT_code_festival_qualA_d
tag: []
---

# 壊れた電卓

## 题目描述

高桥君的计算器坏了。如果输入的数中，数字种类多于 $K$ 种（如：$12235$ 中，有 $4$ 种数字，分别为：$1$、$2$、$3$、$5$），计算将中断。

给定整数 $A$，高桥君想输入这个整数。但是，如果尝试正常输入整数，计算可能会中断，因此请在计算不中断的范围内输入与整数 $A$ 差异尽可能小的整数。

此时，输出高桥君输入的整数与整数 $A$ 之间的差值有多大。

## 输入格式

一行两个整数，表示 $A$ 与 $K$。

## 输出格式

一行一个整数，表示高桥君输入的整数与整数 $A$ 之差的最小值。

## 样例 #1

### 输入

```
1234 2
```

### 输出

```
12
```

## 样例 #2

### 输入

```
800000 1
```

### 输出

```
22223
```

## 样例 #3

### 输入

```
7328495 10
```

### 输出

```
0
```

## 样例 #4

### 输入

```
262004 2
```

### 输出

```
218
```



---

---
title: "錬金術士"
layout: "post"
diff: 普及+/提高
pid: AT_code_festival_qualB_c
tag: []
---

# 錬金術士

## 题目描述

[problemUrl]: https://atcoder.jp/contests/code-festival-2014-qualb/tasks/code_festival_qualB_c

高橋君は錬金術のプロフェッショナルです。

この世界の金属には、 $ 2N $ 文字（ $ N $ は整数）からなる名前が付けられており、名前は全て大文字アルファベットで構成されています。

高橋君が既存の金属 $ S1,\ S2 $ から新たな金属 $ S3 $ を錬金できる条件は、$ S1,S2 $ からそれぞれ $ N $ 文字ずつ取り出してきて、それらの文字を適当に並べ替えた結果、 $ S3 $ と一致するときです。

$ 3 $ つの金属の名前$ S1,\ S2,\ S3 $が与えられるので $ S1,\ S2 $ から $ S3 $ が錬金できるか判定してください。

## 输入格式

入力は以下の形式で標準入力から与えられる

> $ S1 $ $ S2 $ $ S3 $

- $ 1 $ 行目には錬金の材料となる $ 1 $ つめの金属の名前 $ S1 $ が与えられる。
- $ 2 $ 行目には錬金の材料となる $ 2 $ つめの金属の名前 $ S2 $ が与えられる。
- $ 3 $ 行目には生成したい金属の名前 $ S3 $ が与えられる。
- $ S1,\ S2,\ S3 $は大文字アルファベットのみから構成される。
- $ S1,\ S2,\ S3 $の文字数は等しく、偶数である。
- $ 2\ ≦\ |\ S1\ |\ ≦\ 10^5 $ が常に成り立つ。

## 输出格式

もし$ S1,\ S2 $から$ S3 $が錬金可能ならば`YES`、錬金不可能ならば`NO`と1行で出力せよ。

## 说明/提示

### Sample Explanation 1

$ 1 $ つ目の金属から `AAD` 、 $ 2 $ つ目の金属から `AED` を取り出せば、 `EDDAAA` を作ることができます。

### Sample Explanation 2

$ 1 $ つ目の金属から少なくとも $ 4 $ 文字取り出さなければならないので錬金できません。

## 样例 #1

### 输入

```
AABCCD

ABEDDA

EDDAAA
```

### 输出

```
YES
```

## 样例 #2

### 输入

```
AAAAAB

CCCCCB

AAABCB
```

### 输出

```
NO
```



---

---
title: "登山家"
layout: "post"
diff: 普及+/提高
pid: AT_code_festival_qualB_d
tag: []
---

# 登山家

## 题目描述

高桥君是登山家，现在正在登山。

这个山脉上N个山中小屋向东西一条直线排列着，

各山小屋从西向东依次排列着，以1到N的号码排序。

第i的山中小屋建于海拔hi。

高桥君很在意从各小屋能看到几间山中小屋?

从第i个山中小屋可以看到第j个（山中小屋）的条件是，

##### 第j（山中小屋）的海拔全部为hi下（hj≤hi）。

求在各山中小屋可以看到的山中小屋的个数。

另外，从第i的山中小屋可以看到的山中小屋不包括第i个山中小屋。

## 输入格式

###### 第一行为山中小屋的个数N（1 ≦ N ≦ 100000）

###### 第二行为各小屋的海拔

## 输出格式

###### 输出N行，其中第i行表示在第i个小屋能看到的小屋数j

## 样例 #1

### 输入

```
3

1

2

3
```

### 输出

```
0

1

2
```

## 样例 #2

### 输入

```
5

1

2

3

2

1
```

### 输出

```
0

1

4

1

0
```

## 样例 #3

### 输入

```
5

3

2

1

2

3
```

### 输出

```
4

2

0

2

4
```

## 样例 #4

### 输入

```
8

4

3

2

3

4

3

2

1
```

### 输出

```
7

2

0

2

7

2

1

0
```



---

---
title: "決勝進出者"
layout: "post"
diff: 普及+/提高
pid: AT_code_formula_2014_qualA_c
tag: []
---

# 決勝進出者

## 题目描述

[problemUrl]: https://atcoder.jp/contests/code-formula-2014-quala/tasks/code_formula_2014_qualA_c

高橋君は、コンテストを開こうと思っています。

コンテストは、 $ n $ 回の予選と、 $ 1 $ 回の本選に分かれており、予選の上位 $ k $ 人を本選に招待しようと思っています。

本選の出場選手は、以下のように選ばれます。

- 各予選の最高順位が高い人から順番に選ばれる。
- 最高順位が同じ場合は、最高順位を取った予選が開かれた時期が早い方から先に選ばれる。
- $ k $ 人が選ばれるまで、この操作を続ける。

高橋君は、招待される選手に出来るだけ早く、本選への招待をしたいです。そこで、予選が終わるたびに、本選への招待が確定した選手に対し、メールを送りたいです。

各予選の結果が与えられるので、予選が終わった際に、誰にメールを送るべきかを求めてください。 なお、本選を辞退する選手はいないものとします。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ n $ $ k $ $ a_{1,1} $ $ a_{1,2} $ ... $ a_{1,k} $ $ a_{2,1} $ $ a_{2,2} $ ... $ a_{2,k} $ : $ a_{n,1} $ $ a_{n,2} $ ... $ a_{n,k} $

- $ 1 $ 行目には、予選の回数を表す整数 $ n\ (1\ ≦\ n\ ≦\ 50) $ と、本選への招待人数を表す整数 $ k\ (1\ ≦\ k\ ≦\ 1000) $ が、スペース区切りで与えられる。
- $ 2 $ 行目から $ n $ 行は、各予選での上位 $ k $ 人の選手のIDが与えられる。このうち $ i\ (1\ ≦\ i\ ≦\ n) $ 行目は、$ i $ 回目の予選の結果を表す。結果はスペース区切りの $ k $ 個の整数で与えられ、このうち $ j $ 個目の整数 $ a_{i,j}\ (1\ ≦\ a_{i,j}\ ≦\ 999999) $は、$ i $ 回目の予選で $ j $ 位だった人のIDを表す。なお、$ p\ ≠\ q $のとき、$ a_{i,p}\ ≠\ a_{i,q} $であることが保障されている。

## 输出格式

$ i\ (1\ ≦\ i\ ≦\ n) $ 回目の予選で、予選通過が確定した人のIDの一覧を、$ i $ 行目にスペース区切りで出力せよ。予選通過者が複数人いる場合は、IDが小さい順に出力しなさい。 出力の末尾にも改行をいれること。

## 说明/提示

### Sample Explanation 1

予選が $ 2 $ 回あります。 まず、$ 1 $ 回目の予選が行われた直後に、上位 $ 6 $ 人は、その後の予選の結果に拠らず、本選への招待が確定します。 次に、$ 2 $ 回目の予選が行われた際、IDが、$ 1,2 $ の二人の参加者が重複するため、$ 1 $ 回目の予選の $ 7 $ 位までと、 $ 2 $ 回目の予選の $ 6 $ 位までの、本選への招待が確定します。 出力順序は、順位に関係なく、IDが若い順であることに注意してください。

### Sample Explanation 2

本選への招待者が確定しない予選があることにも注意してください。

## 样例 #1

### 输入

```
2 11

1 2 3 4 5 6 7 8 9 10 11

1 2 15 14 13 16 17 18 19 20 21
```

### 输出

```
1 2 3 4 5 6

7 13 14 15 16
```

## 样例 #2

### 输入

```
4 5

1 2 3 4 5

2 1 3 4 5

1 2 3 4 5

2 1 3 4 5
```

### 输出

```
1 2



3

4 5
```



---

---
title: "仲良し文字列"
layout: "post"
diff: 普及+/提高
pid: AT_code_formula_2014_qualB_c
tag: []
---

# 仲良し文字列

## 题目描述

[problemUrl]: https://atcoder.jp/contests/code-formula-2014-qualb/tasks/code_formula_2014_qualB_c

(21:13 追記) |A|=|B|=1のケースがテスト中に一つ含まれていましたので、リジャッジを行います。なお、このケースで`NO`を出力するプログラムに影響はありません。

文字列 $ A $ の文字をちょうど $ 3 $ 回スワップすることにより、文字列 $ B $ に変換できるとき、二つの文字列 $ A $, $ B $ を、仲良し文字列と呼ぶことにします。

スワップとは、文字列に含まれる $ 2 $ つの文字を、入れ替えることを指します。 例えば、`abc`という文字列であれば、`a`と`c`を入れ替えて、`cba`のように変換することが出来ます。

`aa`のような文字列に対し、 $ 1 $ 文字目の`a`と、 $ 2 $ 文字目の`a`を入れ替えることは許されていますが、同じ場所の文字を指定することはできません。

文字列 $ A $, $ B $ が与えられるので、仲良し文字列になっているかどうかを判定しなさい。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ A $ $ B $

- $ 1 $ 行目には、文字列 $ A\ (2\ ≦\ |A|≦\ 1000) $ が与えられる。
- $ 2 $ 行目には、文字列 $ B\ (|B|\ =\ |A|) $ が与えられる。
- $ A $, $ B $ 共に、小文字アルファベットのみで構成されていることが保障されている。

## 输出格式

与えられた $ 2 $ つの文字列が、仲良し文字列であれば`YES`、そうでなければ`NO`を出力せよ。 出力の末尾には改行をいれること。

## 说明/提示

### Sample Explanation 1

まず、文字列 $ A $ の`abcdef`の`a`と`f`をスワップし、`fbcdea`とします。 次に、`b`と`e`をスワップし、`fecdba`とします。 最後に、`c`と`d`をスワップし、`fedcba`とすると、文字列 $ B $ と一致します。 よって、この $ 2 $ つの文字列は、仲良し文字列となるため、`YES`と出力します。

### Sample Explanation 2

使っている文字数が同じでも、 $ 3 $ 回のスワップでは同じ文字列にできないパターンも存在します。

### Sample Explanation 3

スワップの仕方が $ 1 $ 通りしかなく、 $ 3 $ 回のスワップを繰り返すと、`tn`になってしまいます。 よって、同じ $ 2 $ つの文字列ですが、仲良し文字列ではありません。

### Sample Explanation 4

まず、 $ 1 $ 番目の文字と $ 2 $ 番目の文字を入れ替え、`qpqq`とします。 次に、 $ 3 $ 番目の文字と $ 4 $ 番目の文字を入れ替え、`qpqq`とします。この際、同じ文字を選んでいますが、場所が違うので問題ありません。 最後に、$ 1 $番目の文字と、$ 2 $番目の文字を入れ替え、`pqqq`とします。

### Sample Explanation 5

長い文字列が与えらえれることがあることにも注意してください。

## 样例 #1

### 输入

```
abcdef

fedcba
```

### 输出

```
YES
```

## 样例 #2

### 输入

```
abababab

babababa
```

### 输出

```
NO
```

## 样例 #3

### 输入

```
nt

nt
```

### 输出

```
NO
```

## 样例 #4

### 输入

```
pqqq

pqqq
```

### 输出

```
YES
```

## 样例 #5

### 输入

```
abcdefghijklmnopqrstuvwxyzabcdefghijklmnopqrstuvwxyzabcdefghijklmnopqrstuvxyzw

abcdefghijklmnopqrstuvwxyzabcdefghijklmnopqrstuvwxyzabcdefghijklmnopqrstuvwxyz
```

### 输出

```
YES
```

## 样例 #6

### 输入

```
abcdef

ghijkl
```

### 输出

```
NO
```



---

---
title: "Div/de"
layout: "post"
diff: 普及+/提高
pid: AT_ddcc2020_final_a
tag: []
---

# Div/de

## 题目描述

[problemUrl]: https://atcoder.jp/contests/ddcc2020-final/tasks/ddcc2020_final_a

双子の姉妹である Yes と No は、東京で行われるプログラミングコンテストに参加します。姉妹はウォーミングアップのため、会場へ向かう新幹線でゲームをすることにしました。

姉妹は紙に $ N $ 個の正の整数を書きます。$ i\ (1\ \leq\ i\ \leq\ N) $ 番目の値は $ A_i $ です。

ゲームでは、Yes が先攻、No が後攻となって、交互に以下の操作をします。

- 紙に書いてある $ 2 $ 以上の整数を $ 1 $ つ選び、より小さい正の約数に書き換える。

先に操作ができなくなった方が負けとなります。

$ 2 $ 人が最善を尽くしたとき、勝つのは Yes と No のどちらでしょうか？

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ A_1 $ $ A_2 $ $ \dots $ $ A_N $

## 输出格式

$ 2 $ 人が最善を尽くしたとき、Yes が勝つならば `Yes` を、No が勝つならば `No` を出力せよ。

## 说明/提示

### 制約

- 入力はすべて整数
- $ 1\ \leq\ N\ \leq\ 100 $
- $ 1\ \leq\ A_i\ \leq\ 100\ (1\ \leq\ i\ \leq\ N) $

### Sample Explanation 1

ゲームの進行は、一例として次のようになります。 - Yes が $ A_4 $ を $ 4 $ から $ 2 $ に書き換える。 - No が $ A_3 $ を $ 3 $ から $ 1 $ に書き換える。 - Yes が $ A_2 $ を $ 2 $ から $ 1 $ に書き換える。 - No が $ A_4 $ を $ 2 $ から $ 1 $ に書き換える。 - Yes が $ A_5 $ を $ 5 $ から $ 1 $ に書き換える。 - No は操作できなくなり、Yes が勝つ。 No がどう動かしても、Yes が適切に操作すれば No が先に操作できなくなります。

### Sample Explanation 2

はじめから操作できないので、No が勝ちます。

## 样例 #1

### 输入

```
5

1 2 3 4 5
```

### 输出

```
Yes
```

## 样例 #2

### 输入

```
6

1 1 1 1 1 1
```

### 输出

```
No
```

## 样例 #3

### 输入

```
3

19 12 15
```

### 输出

```
No
```

## 样例 #4

### 输入

```
10

91 92 93 94 95 96 97 98 99 100
```

### 输出

```
No
```



---

---
title: "Strawberry Cakes"
layout: "post"
diff: 普及+/提高
pid: AT_ddcc2020_qual_c
tag: []
---

# Strawberry Cakes

## 题目描述

[problemUrl]: https://atcoder.jp/contests/ddcc2020-qual/tasks/ddcc2020_qual_c

chokudai さんは，DDCC 2020 本戦で参加者に配る長方形のケーキを用意しました．

このケーキは，$ H\ -\ 1 $ 本の横方向の切れ目と $ W\ -\ 1 $ 本の縦方向の切れ目により，$ H\ \times\ W $ 個の区画に等分されています．これらの区画のうち $ K $ 個には，それぞれイチゴが $ 1 $ 個乗っています．

イチゴの位置は，$ H\ \times\ W $ 個の文字 $ s_{i,\ j} $ $ (1\ \leq\ i\ \leq\ H,\ 1\ \leq\ j\ \leq\ W) $ によって与えられます．$ s_{i,\ j} $ が `#` のとき，上から $ i $ 行目，左から $ j $ 列目の区画にイチゴが乗っており，$ s_{i,\ j} $ が `.` のとき乗っていません．`#` はちょうど $ K $ 個出現します．

さて，chokudai さんはこのケーキを切れ目に沿って $ K $ 個のピースに切り分け，参加者に配布したいです．ただし，すべてのピースは以下の条件を満たさなければなりません．

- 形状は長方形である．
- ちょうど $ 1 $ 個のイチゴを含む．

例えば，次のような例が考えられます．

![ ](https://cdn.luogu.com.cn/upload/vjudge_pic/AT_ddcc2020_qual_c/cc1d9c887e66319321dc6aab838f872b37b7268e.png)

条件を満たすケーキの切り分け方を $ 1 $ つ求めてください．このような切り分け方は，イチゴの個数や位置にかかわらず必ず存在することが示せます．

## 输入格式

入力は以下の形式で標準入力から与えられます.

> $ H $ $ W $ $ K $ $ s_{1,\ 1}\ s_{1,\ 2}\ \cdots\ s_{1,\ W} $ $ s_{2,\ 1}\ s_{2,\ 2}\ \cdots\ s_{2,\ W} $ $ : $ $ s_{H,\ 1}\ s_{H,\ 2}\ \cdots\ s_{H,\ W} $

## 输出格式

切り分け後の $ K $ 個のピースに任意の順で $ 1,\ 2,\ 3,\ \dots,\ K $ の番号を付け，上から $ i $ 行目，左から $ j $ 列目の区画が属するピースの番号を $ a_{i,\ j} $ として，次の形式で出力してください．

> $ a_{1,\ 1}\ a_{1,\ 2}\ \cdots\ a_{1,\ W} $ $ a_{2,\ 1}\ a_{2,\ 2}\ \cdots\ a_{2,\ W} $ $ : $ $ a_{H,\ 1}\ a_{H,\ 2}\ \cdots\ a_{H,\ W} $

複数の切り分け方が考えられる場合，そのうちのどれを出力しても構いません．

## 说明/提示

### 制約

- $ 1\ \leq\ H\ \leq\ 300 $
- $ 1\ \leq\ W\ \leq\ 300 $
- $ 1\ \leq\ K\ \leq\ H\ \times\ W $
- $ s_{i,\ j} $ は `#` または `.`
- `#` は $ s $ にちょうど $ K $ 個出現する

### Sample Explanation 1

例えば，下の図の方法で切り分けることができます． !\[ \](https://img.atcoder.jp/ddcc2020-qual/d09e88243931000a04e555892fe7e6c9.png)

### Sample Explanation 2

例えば，下の図の方法で切り分けることができます． !\[ \](https://img.atcoder.jp/ddcc2020-qual/18d0f45847f5d107ac0322aecea39835.png)

## 样例 #1

### 输入

```
3 3 5

#.#

.#.

#.#
```

### 输出

```
1 2 2

1 3 4

5 5 4
```

## 样例 #2

### 输入

```
3 7 7

#...#.#

..#...#

.#..#..
```

### 输出

```
1 1 2 2 3 4 4

6 6 2 2 3 5 5

6 6 7 7 7 7 7
```

## 样例 #3

### 输入

```
13 21 106

.....................

.####.####.####.####.

..#.#..#.#.#....#....

..#.#..#.#.#....#....

..#.#..#.#.#....#....

.####.####.####.####.

.....................

.####.####.####.####.

....#.#..#....#.#..#.

.####.#..#.####.#..#.

.#....#..#.#....#..#.

.####.####.####.####.

.....................
```

### 输出

```
12 12 23 34 45 45 60 71 82 93 93 2 13 24 35 35 17 28 39 50 50

12 12 23 34 45 45 60 71 82 93 93 2 13 24 35 35 17 28 39 50 50

12 12 56 89 89 89 60 104 82 31 31 46 13 24 35 35 61 61 39 50 50

12 12 67 67 100 100 60 9 9 42 42 57 13 24 6 72 72 72 72 72 72

12 12 78 5 5 5 20 20 20 53 68 68 90 24 6 83 83 83 83 83 83

16 16 27 38 49 49 64 75 86 97 79 79 90 101 6 94 94 105 10 21 21

16 16 27 38 49 49 64 75 86 97 79 79 90 101 6 94 94 105 10 21 21

32 32 43 54 65 65 80 11 106 95 22 22 33 44 55 55 70 1 96 85 85

32 32 43 54 76 76 91 11 106 84 84 4 99 66 66 66 81 1 96 74 74

14 14 3 98 87 87 102 11 73 73 73 4 99 88 77 77 92 92 63 63 63

25 25 3 98 87 87 7 29 62 62 62 15 99 88 77 77 103 19 30 52 52

36 36 47 58 69 69 18 29 40 51 51 26 37 48 59 59 8 19 30 41 41

36 36 47 58 69 69 18 29 40 51 51 26 37 48 59 59 8 19 30 41 41
```



---

---
title: "Digit Sum Replace"
layout: "post"
diff: 普及+/提高
pid: AT_ddcc2020_qual_d
tag: []
---

# Digit Sum Replace

## 题目描述

[problemUrl]: https://atcoder.jp/contests/ddcc2020-qual/tasks/ddcc2020_qual_d

DDCC 20XX の予選には，$ N $ 人のプログラマーが参加する予定です．しかし，会場の都合上，本戦には $ 9 $ 人までしか参加できません．

そこで，予選を何ラウンドかに分けて勝ち抜き方式で行うことにしました．これは，以下のルールに従って行われます．

- 最初のラウンドには $ N $ 人全員が参加する．
- あるラウンドに $ X\ (X\ \geq\ 10) $ 人が参加するとき，次のラウンドに勝ち残る人数を以下のように決定する．
  - $ X $ の十進表記において，ある連続する $ 2 $ 桁を選び，それらをその和で置き換えて得られる数を勝ち残る人数とする．  
       例えば，$ X\ =\ 2378 $ のとき，勝ち残る人数は $ 578 $ ($ 2,3 $ を選んだ場合)，$ 2108 $ ($ 3,7 $ を選んだ場合)，$ 2315 $ ($ 7,8 $ を選んだ場合) 人のいずれかとなる．  
       $ X\ =\ 100 $ のときは，どちらの $ 2 $ 桁を選んだとしても勝ち残る人数は $ 10 $ 人となる．
- 勝ち残った人数が $ 9 $ 人以下となったら，予選を終了する．

DDCC 20XX の運営リーダーであるりんごさんは，できるだけ多くの予選ラウンドを開催したいです．  
 最大で何ラウンドの予選を開催できるか求めてください．

ただし，参加者数 $ N $ は非常に多くなる場合があるので，$ 2 $ つの整数列 $ d_1,\ \ldots,\ d_M $，$ c_1,\ \ldots,\ c_M $ として与えられます．  
 これは，$ N $ が十進表記において $ c_1\ +\ c_2\ +\ \ldots\ +\ c_M $ 桁の数であり，その先頭の $ c_1 $ 桁の数字がいずれも $ d_1 $，続く $ c_2 $ 桁の数字がいずれも $ d_2 $，$ \ldots $，最後の $ c_M $ 桁の数字がいずれも $ d_M $ であることを表します．

## 输入格式

入力は以下の形式で標準入力から与えられます.

> $ M $ $ d_1 $ $ c_1 $ $ d_2 $ $ c_2 $ $ : $ $ d_M $ $ c_M $

## 输出格式

予選ラウンドの数の最大値を出力してください．

## 说明/提示

### 制約

- $ 1\ \leq\ M\ \leq\ 200000 $
- $ 0\ \leq\ d_i\ \leq\ 9 $
- $ d_1\ \neq\ 0 $
- $ d_i\ \neq\ d_{i+1} $
- $ c_i\ \geq\ 1 $
- $ 2\ \leq\ c_1\ +\ \ldots\ +\ c_M\ \leq\ 10^{15} $

### Sample Explanation 1

この場合，予選の最初のラウンドには $ N=229 $ 人が参加します．大会の経過の一例として、次のパターンがありえます． - ラウンド $ 1 $ に $ 229 $ 人が参加し，ラウンド $ 2 $ に $ 49 $ 人が参加し，ラウンド $ 3 $ に $ 13 $ 人が参加し，本戦に $ 4 $ 人が進出する． このとき，予選は $ 3 $ ラウンド行われ、これが実は最適であることが分かります。

### Sample Explanation 2

この場合，最初のラウンドには $ 1000000007 $ 人が参加します．

## 样例 #1

### 输入

```
2

2 2

9 1
```

### 输出

```
3
```

## 样例 #2

### 输入

```
3

1 1

0 8

7 1
```

### 输出

```
9
```



---

---
title: "Password"
layout: "post"
diff: 普及+/提高
pid: AT_digitalarts_2
tag: []
---

# Password

## 题目描述

[problemUrl]: https://atcoder.jp/contests/digitalarts2012/tasks/digitalarts_2

セキュリティに興味がある高橋君は、デジタルアーツ株式会社に就職したい青年です。  
 そこで、高橋君は自分が運営するサービスであるAtCoderのセキュリティについて見なおしてみることにしました。  
  
 現在AtCoderのシステムでは、パスワードは $ 1 $ 文字以上 $ 20 $ 文字以下の英小文字のみとしています。  
 そして、文字列 $ s $ に対してハッシュ値( $ hash(s) $ )を求める以下の式があり、パスワードと入力した文字列に対して、それぞれこの式で算出したハッシュ値が一致すると、入力した文字列は正しいとみなします。  
  
 $ hash(s)\ =\ Num(c_1)\ +\ Num(c_2)\ +\ ...\ +\ Num(c_{N}) $ ($ c_i $ は文字列 $ s $ の $ i $ 番目の文字を意味する)  
  
 なお、上記の式の関数 $ Num() $ とは英小文字を数字に変換する関数で、$ Num( $`a`$ )\ =\ 1, $ $ Num( $`b`$ )\ =\ 2, $ $ ...., $ $ Num( $`z`$ )\ =\ 26 $ というように、`a` から `z` に対して順に $ 1 $ から $ 26 $ までの数字を返します。  
  
 高橋君は、このシステムではパスワードと違う文字列でも簡単にハッシュ値が一致してしまうことに気づきました。  
 例えば、文字列 `abc` のハッシュ値は、$ 1+2+3=6 $ となりますが、文字列 `bbb` のハッシュ値も $ 2+2+2=6 $ ですし、`f` も $ 6 $ になってしまいます。  
  
 高橋君は、現在使っているパスワードに対してどのような文字列が正しいパスワードとして認識されてしまうか知りたいです。  
 正しいパスワード以外で条件を満たすものを $ 1 $ つ出力しなさい。  
 条件を満たすものが複数ある場合は、どの文字列を出力しても構いません。  
 もし条件を満たすパスワードが存在しない場合は `NO` と出力しなさい。  
 なお、AtCoderのシステムで入力できるパスワードは $ 1 $ 文字以上 $ 20 $ 文字以下の英小文字のみなので、 答えとして出力する文字列もその条件をみたします。 入力は以下の形式で標準入力から与えられる。

> $ c_1c_2‥‥c_N $

- 入力には正しいパスワードを表す長さ $ N(1≦N≦20) $ の文字列が $ 1 $ 行で与えられる。 
  - 正しいパスワードの $ i $ 番目の文字を表す $ c_i $ は英小文字 (`a-z`) である。
 
 与えられた正しいパスワードを表す文字列と等しいハッシュ値になる英小文字 $ 1 $ 文字以上 $ 20 $ 文字以下の文字列を、正しいパスワード以外のいずれか $ 1 $ つ出力せよ。  
 また、そのような文字列が存在しない場合は `NO` と出力せよ。  
 なお、出力は $ 1 $ 行のみとし、最後には改行を出力せよ。 ```

abc
```

 ```

bbb
```

- 問題文内に示しているように、ハッシュ値が $ 6 $ になります。
- 他にも `f` 、`aaaaaa` 、 `cc` でも構いません。
 
```

zzzzzzzzzzzzzzzzzzzz
```

 ```

NO
```

- 条件を満たす文字列は正しいパスワードしか存在しません。
 
```

abcdef
```

 ```

fedcba
```

- ハッシュ値は $ 21 $ になります。
 
```

k
```

 ```

bbbbba
```


```

aa
```

 ```

b
```

- ハッシュ値が $ 2 $ になる文字列は正しいパスワード以外に、`b` しかありません。



---

---
title: "DDPC特別ビュッフェⅡ"
layout: "post"
diff: 普及+/提高
pid: AT_discovery_2016_final_b
tag: []
---

# DDPC特別ビュッフェⅡ

## 题目描述

[problemUrl]: https://atcoder.jp/contests/discovery2016-final/tasks/discovery_2016_final_b

DISCO presents ディスカバリーチャンネルプログラミングコンテスト 2016本戦のDDPC特別ビュッフェの時間が始まりました。あなたはこれから料理の載っていないトレーに料理を載せに行くところです。 DDPC特別ビュッフェには $ N $ 種類の料理があります。 $ i $ 種類目の料理はビュッフェの開始から $ T_i $ 秒後になくなり、料理の美味しさは $ A_i $ です。

DDPC特別ビュッフェにはいくつかの特別なルールがあります。

- あなたは $ 1 $ 種類の料理をトレーに載せるのに $ 1 $ 秒かけなくてはならない。すなわち料理を載せ始めた時刻が $ s $ であったとき、料理を載せ終わったときの時刻は $ s+1 $ となる。
- あなたは以前にトレーに載せた料理と同じ種類の料理を載せてはならない。
- 現在の時刻 $ s $ が$ s+1≦T_i $ を満たさないとき、種類 $ i $ の料理をトレーに載せることはできない。

あなたはトレーに載っている料理の美味しさの総和が $ X $ 以上になったところで席に戻ることにしました。トレーに載っている料理の美味しさの総和を $ X $ 以上にすることが可能な最小の時刻 $ t $ を求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ X $ $ T_1 $ $ T_2 $ … $ T_N $ $ A_1 $ $ A_2 $ … $ A_N $

- $ 1 $ 行目にDDPC特別ビュッフェに存在する料理の種類数を表す整数 $ N(1≦N≦10^{5}) $ とトレーに載っている料理の美味しさの総和の目標値 $ X(1≦X≦10^{9}) $ が空白区切りで与えられる。
- $ 2 $ 行目にDDPC特別ビュッフェに存在する料理の $ i $ 種類目の料理がなくなる時刻 $ T_i\ (1≦T_i≦10^{5}) $ が空白区切りで与えられる。
- $ 3 $ 行目にDDPC特別ビュッフェに存在する料理の $ i $ 種類目の料理の美味しさを表す整数 $ A_i\ (1≦A_i≦10^{5}) $ が空白区切りで与えられる。

## 输出格式

トレーに載っている料理の美味しさの総和を $ X $ 以上にすることが可能な最小の時刻 $ t $ を $ 1 $ 行に出力せよ。不可能な場合は`-1`を出力せよ。末尾に改行を忘れないこと。

## 说明/提示

### 部分点

この問題には部分点が設定されている。

- $ T_i\ <\ T_j $ のとき、$ A_i≧A_j $ を満たすようなデータセットに正解した場合 $ 10 $ 点が与えられる。
- 追加制約のないデータセットに正解した場合さらに $ 40 $ 点が得られ合計 $ 50 $ 点が得られる。

### Sample Explanation 1

\- 以下のような料理の取り方をすることで、時刻 $ 2 $ にトレーに載っている料理の美味しさの総和が $ 5 $ 以上にすることが可能です。 - $ 0 $ 秒目の時点でトレーに載っている料理の美味しさの総和は $ 0 $ です。種類 $ 1 $ の料理をトレーに載せます。 - $ 1 $ 秒目の時点でトレーに載っている料理の美味しさの総和は $ 3 $ です。種類 $ 2 $ の料理をトレーに載せます。 - $ 2 $ 秒目の時点でトレーに載っている料理の美味しさの総和は $ 6 $ です。 - このケースは部分点の追加制約を満たします。

### Sample Explanation 2

\- 以下のような料理の取り方をすることで、時刻 $ 3 $ にトレーに載っている料理の美味しさの総和が $ 10 $ 以上にすることが可能です。 - $ 0 $ 秒目の時点でトレーに載っている料理の美味しさの総和は $ 0 $ です。種類 $ 1 $ の料理をトレーに載せます。 - $ 1 $ 秒目の時点でトレーに載っている料理の美味しさの総和は $ 3 $ です。種類 $ 2 $ の料理をトレーに載せます。 - $ 2 $ 秒目の時点でトレーに載っている料理の美味しさの総和は $ 6 $ です。種類 $ 3 $ の料理をトレーに載せます。 - $ 3 $ 秒目の時点でトレーに載っている料理の美味しさの総和は $ 10 $ です。 - このケースは部分点の追加制約を満たしません。

### Sample Explanation 3

\- 以下のような料理の取り方をすることで、時刻 $ 1 $ にトレーに載っている料理の美味しさの総和が $ 5 $ 以上にすることが可能です。 - $ 0 $ 秒目の時点でトレーに載っている料理の美味しさの総和は $ 0 $ です。種類 $ 3 $ の料理をトレーに載せます。 - $ 1 $ 秒目の時点でトレーに載っている料理の美味しさの総和は $ 6 $ です。 - このケースは部分点の追加制約を満たします。

### Sample Explanation 4

\- どのように料理をとっても、トレーに載っている料理の美味しさの総和を $ 101 $ 以上にすることはできません。 - このケースは部分点の追加制約を満たします。

### Sample Explanation 5

\- 時刻 $ 0 $ でどちらの料理をとっても、もう片方の料理が時刻 $ 1 $ でなくなってしまうため、トレーに載っている料理の美味しさを $ 2 $ 以上にすることはできません。 - このケースは部分点の追加制約を満たします。

### Sample Explanation 6

\- 以下のような料理の取り方をすることで、時刻 $ 2 $ にトレーに載っている料理の美味しさの総和が $ 6 $ 以上にすることが可能です。 - $ 0 $ 秒目の時点でトレーに載っている料理の美味しさの総和は $ 0 $ です。種類 $ 2 $ の料理をトレーに載せます。 - $ 1 $ 秒目の時点でトレーに載っている料理の美味しさの総和は $ 4 $ です。種類 $ 4 $ の料理をトレーに載せます。 - $ 2 $ 秒目の時点でトレーに載っている料理の美味しさの総和は $ 6 $ です。 - このケースは部分点の追加制約を満たします。

### Sample Explanation 7

\- 以下のような料理の取り方をすることで、時刻 $ 2 $ にトレーに載っている料理の美味しさの総和が $ 4 $ 以上にすることが可能です。 - $ 0 $ 秒目の時点でトレーに載っている料理の美味しさの総和は $ 0 $ です。種類 $ 2 $ の料理をトレーに載せます。 - $ 1 $ 秒目の時点でトレーに載っている料理の美味しさの総和は $ 2 $ です。種類 $ 3 $ の料理をトレーに載せます。 - $ 2 $ 秒目の時点でトレーに載っている料理の美味しさの総和は $ 4 $ です。 - このケースは部分点の追加制約を満たしません。

## 样例 #1

### 输入

```
4 5

1 2 3 4

3 3 1 1
```

### 输出

```
2
```

## 样例 #2

### 输入

```
3 10

1 2 3

3 3 4
```

### 输出

```
3
```

## 样例 #3

### 输入

```
3 5

9 9 4

2 2 6
```

### 输出

```
1
```

## 样例 #4

### 输入

```
5 101

1 2 3 4 5

20 20 20 20 20
```

### 输出

```
-1
```

## 样例 #5

### 输入

```
2 2

1 1

1 1
```

### 输出

```
-1
```

## 样例 #6

### 输入

```
4 6

1 1 2 2

3 4 1 2
```

### 输出

```
2
```

## 样例 #7

### 输入

```
3 4

1 2 2

1 2 2
```

### 输出

```
2
```



---

---
title: "ディスコ社内ツアー"
layout: "post"
diff: 普及+/提高
pid: AT_discovery_2016_qual_b
tag: []
---

# ディスコ社内ツアー

## 题目描述

[problemUrl]: https://atcoder.jp/contests/discovery2016-qual/tasks/discovery_2016_qual_b

あなたはDISCO presents ディスカバリーチャンネルプログラミングコンテスト 2016本戦のディスコ社内ツアーの案内人です。

社内ツアーにおいて案内する部屋が $ N $ 箇所あり、それぞれの部屋には $ 1 $ から $ N $ の番号が割り振られています。建物の構造は環状となっており、 $ i(1≦i≦N-1) $ 番目の部屋から $ i+1 $ 番目の部屋へと移動可能です。 $ N $ 番目の部屋からは $ 1 $番目の部屋へと移動可能です。これらの道は一方通行であり、逆向きに移動することはできません。

$ i $ 番目の部屋にいるとき、その部屋を見学するか隣の部屋へ移動するかどちらかを選ぶことが可能です。ただし、参加者に何度も同じ部屋を見学させると飽きてしまうため、見学はそれぞれの部屋につき $ 1 $ 度しか行うことはできません。 あなたは社内ツアーを長年行ってきた経験から $ i $番目の部屋を見学したときに得られる面白さはある整数 $ A_i $ で表されることを知っています。

社内ツアーは $ 1 $ 番目の部屋から出発して、全ての部屋を見学し終わった状態で $ 1 $ 番目の部屋にいるように終わらなくてはなりません。 あなたは参加者に社内ツアーを楽しんでもらうため、見学した部屋の面白さを見学した順番に並べたとき、広義単調増加列であるように部屋を案内することにしました。 このような制約のもとで社内ツアーを行うとき、建物内を最低何周する必要があるでしょうか？

ここで、 $ n $ 項からなる数列 $ a $ が $ a_1 $ $ ≦ $ $ a_2 $ $ ≦ $ ... $ ≦ $ $ a_n $ を満たすとき、 $ a $ は広義単調増加列であると呼ばれます。 また、 $ 1 $ 番目の部屋から移動し、全ての部屋を $ 1 $ 度ずつ訪れて $ 1 $ 番目の部屋に戻ってくることを、建物を $ 1 $ 周すると呼びます。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ A_1 $ $ A_2 $ … $ A_N $

- $ 1 $ 行目に案内する部屋の数 $ N\ (2≦N≦10^{5}) $ が与えられる。
- $ 2 $ 行目に各部屋の見学したときの面白さを表す整数 $ A_i\ (1≦A_i≦10^{5}) $ が空白区切りで与えられる。

## 输出格式

与えられた条件を満たすよう社内ツアーを行うのに必要な周回の回数の最低値を $ 1 $ 行に出力せよ。末尾の改行を忘れないこと。

## 说明/提示

### 部分点

この問題には部分点が設定されている。

- $ 2≦N≦100 $ を満たすデータセットに正解した場合 $ 20 $ 点が与えられる。
- $ 1≦A_i≦N $かつ$ i≠j $において$ A_i≠A_j $が成立するようなデータセットに正解した場合上記の部分点とは別に $ 10 $ 点が与えられる。
- 追加制約のないデータセットに正解した場合さらに $ 70 $ 点が得られる。

### Sample Explanation 1

\- 下記のような順序で見学を行うことにより、 $ 3 $ 周で社内ツアーを終えることが可能です。 $ 1 $ 番目の部屋から出発し、すぐに $ 1 $ 番目の部屋を見学することは許されています。ツアーは全ての部屋を見学し終えた状態で $ 1 $ 番の部屋にいる状態で終わらなくてはならないことに注意してください。 - $ 1 $ 周目において、 $ 1 $ 番目の部屋と $ 4 $ 番目の部屋を見学する。 - $ 2 $ 周目において、 $ 3 $ 番目の部屋を見学する。 - $ 3 $ 周目において、 $ 2 $ 番目の部屋と $ 5 $ 番目の部屋を見学する。 - このケースは上記の部分点の $ 1 $ つ目の条件と $ 2 $ つ目の条件を満たします。

### Sample Explanation 2

\- $ 1 $ 周目において、全ての部屋を見学することが可能です。 - このケースは上記の部分点の $ 1 $ つ目の条件と $ 2 $ つ目の条件を満たします。

### Sample Explanation 3

\- 最後に $ 1 $ 番目の部屋を見学した直後にツアーを終了することで $ 1 $ 周でツアーを終了することが可能です。 - このケースは上記の部分点の $ 1 $ つ目の条件と $ 2 $ つ目の条件を満たします。

### Sample Explanation 4

\- 部屋の面白さは重複しているものもあることに注意してください。 - このケースは上記の部分点の $ 1 $ つ目の条件を満たしますが $ 2 $ つ目の条件は満たしません。

## 样例 #1

### 输入

```
5

1 4 3 2 5
```

### 输出

```
3
```

## 样例 #2

### 输入

```
5

1 2 3 4 5
```

### 输出

```
1
```

## 样例 #3

### 输入

```
5

5 1 2 3 4
```

### 输出

```
1
```

## 样例 #4

### 输入

```
8

1 1 1 2 2 2 3 3
```

### 输出

```
1
```



---

---
title: "Squirrel Merchant"
layout: "post"
diff: 普及+/提高
pid: AT_diverta2019_2_d
tag: []
---

# Squirrel Merchant

## 题目描述

松鼠直大君有 $N$ 个橡子。一天，为了获得更多的橡子，他决定去几家贵金属交易所做几笔交易。

他计划这么做：

1. 拿着 $N$ 个橡子离开巢穴；
2. 到交易所 $A$ 做几笔交易；
3. 到交易所 $B$ 做几笔交易；
4. 再到交易所 $A$ 做几笔交易；
5. 回巢穴。

在交易所 $X$ $(X\ =\ A,\ B)$，他可以以任意顺序完成任意整数笔（可能为零）如下的交易：

- 花费 $g_{X}$ 个橡子买来 $1$ 克金；
- 花费 $1$ 克金买来 $g_{X}$ 个橡子；
- 花费 $s_{X}$ 个橡子买来 $1$ 克银；
- 花费 $1$ 克银买来 $s_{X}$ 个橡子；
- 花费 $b_{X}$ 个橡子买来 $1$ 克铜；
- 花费 $1$ 克铜买来 $b_{X}$ 个橡子。

当然，他不能在橡子不够时购买金、银或铜；也不能在金、银或铜不够时购买橡子。

请求出他最多能带多少橡子回巢穴。注意，金、银或铜即使被带回巢穴也是无意义的，因为他只是一只松鼠。

## 输入格式

从标准输入中按以下格式读入：
   
```
$N$
$g_A$ $s_A$ $b_A$
$g_B$ $s_B$ $b_B$
```

## 输出格式

一行一个整数，代表直大君能带回巢穴的最大橡子数。

## 样例 #1

### 样例输入 #1

```
23
1 1 1
2 1 1
```

### 样例输出 #1

```
46
```

## 说明/提示

- $1\ \leq\ N\ \leq\ 5000$
- $1\ \leq\ g_{X}\ \leq\ 5000$
- $1\ \leq\ s_{X}\ \leq\ 5000$
- $1\ \leq\ b_{X}\ \leq\ 5000$
- 所有输入的值都是整数。

### 样例 #1 解释

他可以拿 $46$ 个橡子回巢穴：

- 在交易所 $A$，用 $23$ 个橡子买 $23$ 克金。{ 橡子，金，银，铜 }={ $0,23,0,0$ }
- 在交易所 $B$，用 $23$ 克金买 $46$ 个橡子。{ 橡子，金，银，铜 }={ $46,0,0,0$ }
- 在交易所 $A$，不做任何交易。{ 橡子，金，银，铜 }={ $46,0,0,0$ }

他不能得到 $47$ 个或更多橡子，因此答案是 $46$。

## 样例 #1

### 输入

```
23

1 1 1

2 1 1
```

### 输出

```
46
```



---

---
title: "行列のできるドーナツ屋"
layout: "post"
diff: 普及+/提高
pid: AT_donuts_2015_3
tag: []
---

# 行列のできるドーナツ屋

## 题目描述

在甜甜圈小镇里，有一家每天都排长队的超人气甜甜圈店。现在有 $N$ 个人在这家甜甜圈店排队。排队的人担心在排到自己之前甜甜圈就会卖完。于是甜甜圈店的店长决定计算表示每个人不安程度的「不安度」。

设第 $i$ 个人的身高为 $H_i$，第 $i$ 个人的「不安度」即为「第 $i$ 个人向前看时看到的人数」。第 $i$ 个人向前看时看到第 $j$ 个人需要满足以下条件。

- 第 $j$ 个人需要排在第 $i$ 个人的前面，也即 $j<i$。
- 第 $i$ 个人与第 $j$ 个人之间没有人比第 $j$ 个人更高，也即不存在 $k$ 同时满足 $j<k<i$ 和 $H_j<H_k$。

例如，如果排队的人从前往后的身高分别为 $2,5,3,4,1$，那么排在最后的人向前看时可以看到排在第 $2$ 和第 $4$ 的两人，因此第 $5$ 个人的「不安度」就为 $2$。

## 输入格式

第一行一个正整数 $N$，表示排队的人数。

第二行 $N$ 个正整数，第 $i$ 个数 $H_i$ 表示第 $i$ 个人的身高。

## 输出格式

共 $N$ 行，第 $i$ 行包含一个整数，表示第 $i$ 个人的「不安度」。

末尾额外输出一个空行。

## 说明/提示

对于 $10\%$ 的测试数据，满足 $N\leqslant100$；

对于 $40\%$ 的测试数据，满足 $N\leqslant5000$；

对于 $100\%$ 的测试数据，满足 $1\leqslant N\leqslant10^5$ 且 $1\leqslant H_i\leqslant10^6$。

## 样例 #1

### 输入

```
5

2 5 3 4 1
```

### 输出

```
0

1

1

2

2
```

## 样例 #2

### 输入

```
1

1000000
```

### 输出

```
0
```

## 样例 #3

### 输入

```
8

66 52 56 32 27 50 72 23
```

### 输出

```
0

1

2

2

3

4

3

1
```



---

---
title: "お菓子やさん"
layout: "post"
diff: 普及+/提高
pid: AT_donuts_live2014_5
tag: []
---

# お菓子やさん

## 题目描述

[problemUrl]: https://atcoder.jp/contests/donuts-live2014/tasks/donuts_live2014_5

幼少のパンチくんは、全部で $ N $ 店あるお菓子やさんを巡ろうとしています。

このうちのいくつかの店では、スタンプをカードに押してもらえます。その店のスタンプがあると、さらに別のいくつかの店で、ボーナスのお菓子がもらえるというシステムです。

ただし、パンチくんは一度行った店には $ 2 $ 回行きたくありません。そのため、例えば

- 店 $ A $ のスタンプがあると、店 $ B $ でお菓子が $ 3 $ 個もらえる
- 店 $ B $ のスタンプがあると、店 $ A $ でお菓子が $ 2 $ 個もらえる

という $ 2 $ つの条件が重なっている場合 、どちらかのお菓子を諦めなければいけません。この場合、後者を諦めて、前者の $ 3 $ 個のお菓子をもらうのが得です。

パンチくんがもらえるお菓子の最大値はいくらでしょうか。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ E $ $ a_1 $ $ b_1 $ $ c_1 $ $ a_2 $ $ b_2 $ $ c_2 $ : $ a_E $ $ b_E $ $ c_E $

- $ 1 $ 行目には、お菓子屋さんの数を表す整数 $ N\ (1\ ≦\ N\ ≦\ 16) $ と、お菓子をもらえる店舗関係の数を表す整数 $ E\ (0\ ≦\ E\ ≦\ N×N) $がスペース区切りで与えられる。
- $ 2 $ 行目から $ E $ 行では、お菓子をもらえる店舗関係の情報が与えられる。  
  このうち $ i $ 行目では、 $ 3 $ つの整数 $ a_i\ (1\ ≦\ a_i\ ≦\ N) $, $ b_i\ (1\ ≦\ b_i\ ≦\ N) $, $ c_i\ (1\ ≦\ c_i\ ≦\ 1000) $ が与えられる。  
  これらは、「店 $ a_i $ のスタンプがあると、店 $ b_i $ にて、お菓子が $ c_i $ 個もらえる」ということを表している。
- $ i≠j $ のとき、 $ a_i≠a_j $ または $ b_i≠b_j $ であることが保障されている。

## 输出格式

パンチくんがもらえるお菓子の最大値を、 $ 1 $ 行で出力せよ。出力の末尾には改行をいれること。

## 说明/提示

### 部分点

$ 1\ ≦\ N\ ≦\ 8 $ を満たすテストケースに正解した場合、部分点として $ 130 $ 点が与えられる。

### Sample Explanation 1

問題文に記載されている例です。

### Sample Explanation 2

全てのお菓子をもらうことが出来ます。

### Sample Explanation 3

$ 10 $ 個のお菓子を諦めることで、最大値を得ます。

### Sample Explanation 4

同じ店に $ 2 $ 回行くことはできないので、お菓子はもらえません。また、このスタンプサービスと関係ない店がいくつかあることもあります。

## 样例 #1

### 输入

```
2 2

1 2 3

2 1 2
```

### 输出

```
3
```

## 样例 #2

### 输入

```
4 3

1 2 10

1 3 20

1 4 30
```

### 输出

```
60
```

## 样例 #3

### 输入

```
3 3

1 2 20

2 3 30

3 1 10
```

### 输出

```
50
```

## 样例 #4

### 输入

```
16 1

4 4 1000
```

### 输出

```
0
```

## 样例 #5

### 输入

```
4 6

4 1 3

1 3 3

4 2 3

3 4 2

2 3 3

2 2 10
```

### 输出

```
12
```



---

---
title: "Coins"
layout: "post"
diff: 普及+/提高
pid: AT_dp_i
tag: []
---

# Coins

## 题目描述

设 $N$ 是一个正的奇数。

有 $N$ 枚硬币，每枚硬币上标有编号 $1, 2, \ldots, N$。对于每个 $i$ ($1 \leq i \leq N$)，掷硬币 $i$ 时，正面朝上的概率是 $p _ i$，反面朝上的概率是 $1 - p _ i$。

太郎君把这 $N$ 枚硬币全部投掷了一次。请计算正面朝上的硬币数多于反面朝上的硬币数的概率。

## 输入格式

输入以以下形式从标准输入中给出：

> $N$ $p _ 1$ $p _ 2$ $\ldots$ $p _ N$

## 输出格式

输出正面朝上的硬币数多于反面朝上的硬币数的概率。绝对误差不超过 $10 ^ {-9}$ 的结果将被视为正确。

### 约束条件

- $N$ 是奇数。
- $1 \leq N \leq 2999$
- $p _ i$ 是实数，精确到小数点后两位。
- $0 < p _ i < 1$

### 样例解释 1

计算正面朝上的硬币数多于反面朝上的硬币数的每种情况的概率如下：

- 当（硬币 $1$，硬币 $2$，硬币 $3$）$=$（正, 正, 正）时，概率是 $0.3 \times 0.6 \times 0.8 = 0.144$。
- 当（硬币 $1$，硬币 $2$，硬币 $3$）$=$（反, 正, 正）时，概率是 $0.7 \times 0.6 \times 0.8 = 0.336$。
- 当（硬币 $1$，硬币 $2$，硬币 $3$）$=$（正, 反, 正）时，概率是 $0.3 \times 0.4 \times 0.8 = 0.096$。
- 当（硬币 $1$，硬币 $2$，硬币 $3$）$=$（正, 正, 反）时，概率是 $0.3 \times 0.6 \times 0.2 = 0.036$。

因此，正面朝上的硬币数多于反面朝上的硬币数的概率是 $0.144 + 0.336 + 0.096 + 0.036 = 0.612$。

### 样例解释 2

例如，输出 `0.500`、`0.500000001` 或 `0.499999999` 等答案都将被视为正确。

---

Translated by User 735713.

## 样例 #1

### 输入

```
3

0.30 0.60 0.80
```

### 输出

```
0.612
```

## 样例 #2

### 输入

```
1

0.50
```

### 输出

```
0.5
```

## 样例 #3

### 输入

```
5

0.42 0.01 0.42 0.99 0.42
```

### 输出

```
0.3821815872
```



---

---
title: "Candies"
layout: "post"
diff: 普及+/提高
pid: AT_dp_m
tag: []
---

# Candies

## 题目描述

[problemUrl]: https://atcoder.jp/contests/dp/tasks/dp_m

$ N $ 人の子供たちがいます。 子供たちには $ 1,\ 2,\ \ldots,\ N $ と番号が振られています。

子供たちは $ K $ 個の飴を分け合うことにしました。 このとき、各 $ i $ ($ 1\ \leq\ i\ \leq\ N $) について、子供 $ i $ が受け取る飴の個数は $ 0 $ 以上 $ a_i $ 以下でなければなりません。 また、飴が余ってはいけません。

子供たちが飴を分け合う方法は何通りでしょうか？ $ 10^9\ +\ 7 $ で割った余りを求めてください。 ただし、$ 2 $ 通りの方法が異なるとは、ある子供が存在し、その子供が受け取る飴の個数が異なることを言います。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ K $ $ a_1 $ $ a_2 $ $ \ldots $ $ a_N $

## 输出格式

子供たちが飴を分け合う方法は何通りか？ $ 10^9\ +\ 7 $ で割った余りを出力せよ。

## 说明/提示

### 制約

- 入力はすべて整数である。
- $ 1\ \leq\ N\ \leq\ 100 $
- $ 0\ \leq\ K\ \leq\ 10^5 $
- $ 0\ \leq\ a_i\ \leq\ K $

### Sample Explanation 1

子供たちが飴を分け合う方法は、次の $ 5 $ 通りです。 各数列において、$ i $ 番目の要素は子供 $ i $ が受け取る飴の個数を表します。 - $ (0,\ 1,\ 3) $ - $ (0,\ 2,\ 2) $ - $ (1,\ 0,\ 3) $ - $ (1,\ 1,\ 2) $ - $ (1,\ 2,\ 1) $

### Sample Explanation 2

子供たちが飴を分け合う方法が存在しない場合もあります。

### Sample Explanation 3

子供たちが飴を分け合う方法は、次の $ 1 $ 通りです。 - $ (0,\ 0) $

### Sample Explanation 4

答えを $ 10^9\ +\ 7 $ で割った余りを出力することを忘れずに。

## 样例 #1

### 输入

```
3 4

1 2 3
```

### 输出

```
5
```

## 样例 #2

### 输入

```
1 10

9
```

### 输出

```
0
```

## 样例 #3

### 输入

```
2 0

0 0
```

### 输出

```
1
```

## 样例 #4

### 输入

```
4 100000

100000 100000 100000 100000
```

### 输出

```
665683269
```



---

---
title: "Flowers"
layout: "post"
diff: 普及+/提高
pid: AT_dp_q
tag: []
---

# Flowers

## 题目描述

[problemUrl]: https://atcoder.jp/contests/dp/tasks/dp_q

$ N $ 本の花が横一列に並んでいます。 各 $ i $ ($ 1\ \leq\ i\ \leq\ N $) について、左から $ i $ 番目の花の高さは $ h_i $ で、美しさは $ a_i $ です。 ただし、$ h_1,\ h_2,\ \ldots,\ h_N $ はすべて相異なります。

太郎君は何本かの花を抜き去ることで、次の条件が成り立つようにしようとしています。

- 残りの花を左から順に見ると、高さが単調増加になっている。

残りの花の美しさの総和の最大値を求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ h_1 $ $ h_2 $ $ \ldots $ $ h_N $ $ a_1 $ $ a_2 $ $ \ldots $ $ a_N $

## 输出格式

残りの花の美しさの総和の最大値を出力せよ。

## 说明/提示

### 制約

- 入力はすべて整数である。
- $ 1\ \leq\ N\ \leq\ 2\ ×\ 10^5 $
- $ 1\ \leq\ h_i\ \leq\ N $
- $ h_1,\ h_2,\ \ldots,\ h_N $ はすべて相異なる。
- $ 1\ \leq\ a_i\ \leq\ 10^9 $

### Sample Explanation 1

左から $ 2,\ 4 $ 番目の花を残せばよいです。 すると、高さは左から順に $ 1,\ 2 $ となり、単調増加になっています。 また、美しさの総和は $ 20\ +\ 40\ =\ 60 $ となります。

### Sample Explanation 2

最初から条件が成り立っています。

### Sample Explanation 3

答えは 32-bit 整数型に収まらない場合があります。

### Sample Explanation 4

左から $ 2,\ 3,\ 6,\ 8,\ 9 $ 番目の花を残せばよいです。

## 样例 #1

### 输入

```
4

3 1 4 2

10 20 30 40
```

### 输出

```
60
```

## 样例 #2

### 输入

```
1

1

10
```

### 输出

```
10
```

## 样例 #3

### 输入

```
5

1 2 3 4 5

1000000000 1000000000 1000000000 1000000000 1000000000
```

### 输出

```
5000000000
```

## 样例 #4

### 输入

```
9

4 2 5 8 3 6 1 7 9

6 8 8 4 6 3 5 7 5
```

### 输出

```
31
```



---

---
title: "Walk"
layout: "post"
diff: 普及+/提高
pid: AT_dp_r
tag: []
---

# Walk

## 题目描述

[problemUrl]: https://atcoder.jp/contests/dp/tasks/dp_r

$ N $ 頂点の単純有向グラフ $ G $ があります。 頂点には $ 1,\ 2,\ \ldots,\ N $ と番号が振られています。

各 $ i,\ j $ ($ 1\ \leq\ i,\ j\ \leq\ N $) について、頂点 $ i $ から $ j $ への有向辺の有無が整数 $ a_{i,\ j} $ によって与えられます。 $ a_{i,\ j}\ =\ 1 $ ならば頂点 $ i $ から $ j $ への有向辺が存在し、$ a_{i,\ j}\ =\ 0 $ ならば存在しません。

$ G $ の長さ $ K $ の有向パスは何通りでしょうか？ $ 10^9\ +\ 7 $ で割った余りを求めてください。 ただし、同じ辺を複数回通るような有向パスも数えるものとします。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ K $ $ a_{1,\ 1} $ $ \ldots $ $ a_{1,\ N} $ $ : $ $ a_{N,\ 1} $ $ \ldots $ $ a_{N,\ N} $

## 输出格式

$ G $ の長さ $ K $ の有向パスは何通りか？ $ 10^9\ +\ 7 $ で割った余りを出力せよ。

## 说明/提示

### 制約

- 入力はすべて整数である。
- $ 1\ \leq\ N\ \leq\ 50 $
- $ 1\ \leq\ K\ \leq\ 10^{18} $
- $ a_{i,\ j} $ は $ 0 $ または $ 1 $ である。
- $ a_{i,\ i}\ =\ 0 $

### Sample Explanation 1

$ G $ は次図です。 ![](https://img.atcoder.jp/dp/paths\_0\_muffet.png) 長さ $ 2 $ の有向パスは、次の $ 6 $ 通りです。 - $ 1 $ → $ 2 $ → $ 3 $ - $ 1 $ → $ 2 $ → $ 4 $ - $ 2 $ → $ 3 $ → $ 4 $ - $ 2 $ → $ 4 $ → $ 1 $ - $ 3 $ → $ 4 $ → $ 1 $ - $ 4 $ → $ 1 $ → $ 2 $

### Sample Explanation 2

$ G $ は次図です。 ![](https://img.atcoder.jp/dp/paths\_1\_muffet.png) 長さ $ 3 $ の有向パスは、次の $ 3 $ 通りです。 - $ 1 $ → $ 2 $ → $ 1 $ → $ 2 $ - $ 2 $ → $ 1 $ → $ 2 $ → $ 1 $ - $ 2 $ → $ 1 $ → $ 2 $ → $ 3 $

### Sample Explanation 3

$ G $ は次図です。 ![](https://img.atcoder.jp/dp/paths\_2\_muffet.png) 長さ $ 2 $ の有向パスは、次の $ 1 $ 通りです。 - $ 4 $ → $ 5 $ → $ 6 $

### Sample Explanation 5

答えを $ 10^9\ +\ 7 $ で割った余りを出力することを忘れずに。

## 样例 #1

### 输入

```
4 2

0 1 0 0

0 0 1 1

0 0 0 1

1 0 0 0
```

### 输出

```
6
```

## 样例 #2

### 输入

```
3 3

0 1 0

1 0 1

0 0 0
```

### 输出

```
3
```

## 样例 #3

### 输入

```
6 2

0 0 0 0 0 0

0 0 1 0 0 0

0 0 0 0 0 0

0 0 0 0 1 0

0 0 0 0 0 1

0 0 0 0 0 0
```

### 输出

```
1
```

## 样例 #4

### 输入

```
1 1

0
```

### 输出

```
0
```

## 样例 #5

### 输入

```
10 1000000000000000000

0 0 1 1 0 0 0 1 1 0

0 0 0 0 0 1 1 1 0 0

0 1 0 0 0 1 0 1 0 1

1 1 1 0 1 1 0 1 1 0

0 1 1 1 0 1 0 1 1 1

0 0 0 1 0 0 1 0 1 0

0 0 0 1 1 0 0 1 0 1

1 0 0 0 1 0 1 0 0 0

0 0 0 0 0 1 0 0 0 0

1 0 1 1 1 0 1 1 1 0
```

### 输出

```
957538352
```



---

---
title: "Sum AND Subarrays"
layout: "post"
diff: 普及+/提高
pid: AT_dwacon5th_prelims_b
tag: []
---

# Sum AND Subarrays

## 题目描述

[problemUrl]: https://atcoder.jp/contests/dwacon5th-prelims/tasks/dwacon5th_prelims_b

ある日、ドワンゴ社員のニワンゴくんは、長さ $ N $ の整数列 $ (a_1,\ ...,\ a_N) $ を見つけました。ニワンゴくんは、数列 $ a $ の性質に興味を持っています。

数列 $ a $ の空でない連続する部分列 $ a_l,\ ...,\ a_r $ $ (1\ \leq\ l\ \leq\ r\ \leq\ N) $ の **美しさ** は、 $ a_l\ +\ ...\ +\ a_r $ と定義されます。ニワンゴくんは、ありうる $ N(N+1)/2 $ 個の空でない連続する部分列のうち、 $ K $ 個を選んで取ってきて、それらの美しさのビット毎の論理積 (AND) を計算したとき、その最大値がどうなるかを知りたがっています (取ってくる部分列の間で重複する要素があっても構いません)。

彼の代わりに最大値を求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ K $ $ a_1 $ $ a_2 $ $ ... $ $ a_N $

## 输出格式

答えを出力せよ。

## 说明/提示

### 制約

- $ 2\ \leq\ N\ \leq\ 1000 $
- $ 1\ \leq\ a_i\ \leq\ 10^9 $
- $ 1\ \leq\ K\ \leq\ N(N+1)/2 $
- 入力として与えられる数値はすべて整数である

### Sample Explanation 1

異なる空でない連続する部分列は $ 10 $ 個存在します。全列挙すると、 - 1 番目から始まるもの: $ \{2\},\ \{2,\ 5\},\ \{2,\ 5,\ 2\},\ \{2,\ 5,\ 2,\ 5\} $ - 2 番目から始まるもの: $ \{5\},\ \{5,\ 2\},\ \{5,\ 2,\ 5\} $ - 3 番目から始まるもの: $ \{2\},\ \{2,\ 5\} $ - 4 番目から始まるもの: $ \{5\} $ です (数列の要素が同じでも、異なる添字から始まる列は異なるものとみなすことに注意してください)。 このうち異なる $ 2 $ 個の部分列の美しさのビット毎の論理積 (AND) として得られる値の最大値は $ 12 $ です。 これは $ \{5,\ 2,\ 5\} $ (美しさ $ 12 $) と $ \{2,\ 5,\ 2,\ 5\} $ (美しさ $ 14 $) を選んだ時に達成できます。

## 样例 #1

### 输入

```
4 2

2 5 2 5
```

### 输出

```
12
```

## 样例 #2

### 输入

```
8 4

9 1 8 2 7 5 6 4
```

### 输出

```
32
```



---

---
title: "k-DMC"
layout: "post"
diff: 普及+/提高
pid: AT_dwacon5th_prelims_c
tag: []
---

# k-DMC

## 题目描述

[problemUrl]: https://atcoder.jp/contests/dwacon5th-prelims/tasks/dwacon5th_prelims_c

ドワンゴのコンテンツ配信基盤システム Dwango Media Cluster は、略して DMC と呼ばれています。  
 この名前をかっこ良いと感じたニワンゴくんは、文字列の DMC らしさを数値として定義することにしました。  
 具体的には、長さ $ N $ のある文字列 $ S $ と3以上の整数 $ k $ が与えられた時、以下を満たす整数の3つ組 $ (a,b,c) $ の個数を $ S $ の $ k $-DMC 数と呼ぶことにします。

- $ 0\ \leq\ a $
- $ S[a] $ = `D`
- $ S[b] $ = `M`
- $ S[c] $ = `C`
- $ c-a $

ここで、$ S[a] $ は $ S $ の $ a $ 番目の文字を表します。先頭の文字は $ 0 $ 文字目として扱います (つまり、$ 0\ \leq\ a\ \leq\ N\ -\ 1 $ です)。

ある文字列 $ S $ と $ Q $ 個の整数 $ k_0,\ k_1,\ ...,\ k_{Q-1} $ に対して、$ k_i $-DMC 数をそれぞれ計算してください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ S $ $ Q $ $ k_{0} $ $ k_{1} $ $ ... $ $ k_{Q-1} $

## 输出格式

$ Q $ 行出力せよ。  
 $ i $ 行目 $ (0\ \leq\ i\ \leq\ Q-1) $ には、文字列 $ S $ の $ k_i $-DMC 数を出力せよ。

## 说明/提示

### 制約

- $ 3\ \leq\ N\ \leq\ 10^6 $
- $ S $ は`A` - `Z` からなる文字列
- $ 1\ \leq\ Q\ \leq\ 75 $
- $ 3\ \leq\ k_i\ \leq\ N $
- 入力として与えられる数値はすべて整数である

### Sample Explanation 1

$ (a,b,c)\ =\ (0,\ 6,\ 11) $ が条件を満たします。 Dwango Media Cluster は、ニワンゴくんの定義では意外と DMC らしくないようです。

### Sample Explanation 2

$ 6\times\ 5\times\ 7 $ 個の組み合わせがありえます。

### Sample Explanation 3

$ c-a\ 以外の条件は\ (a,\ b,\ c)\ =\ (0,\ 23,\ 36),\ (8,\ 23,\ 36) $ が満たします。 ちなみに、DWANGO は「Dial-up Wide Area Network Gaming Operation」の頭文字です。

## 样例 #1

### 输入

```
18

DWANGOMEDIACLUSTER

1

18
```

### 输出

```
1
```

## 样例 #2

### 输入

```
18

DDDDDDMMMMMCCCCCCC

1

18
```

### 输出

```
210
```

## 样例 #3

### 输入

```
54

DIALUPWIDEAREANETWORKGAMINGOPERATIONCORPORATIONLIMITED

3

20 30 40
```

### 输出

```
0

1

2
```

## 样例 #4

### 输入

```
30

DMCDMCDMCDMCDMCDMCDMCDMCDMCDMC

4

5 10 15 20
```

### 输出

```
10

52

110

140
```



---

---
title: "Snuke the Wizard"
layout: "post"
diff: 普及+/提高
pid: AT_exawizards2019_c
tag: []
---

# Snuke the Wizard

## 题目描述

[problemUrl]: https://atcoder.jp/contests/exawizards2019/tasks/exawizards2019_c

左から右に向かって $ 1 $ から $ N $ の番号がついた $ N $ 個のマスがあります。 各マスには文字が書かれており、マス $ i $ には文字 $ s_i $ が書かれています。また、各マスにははじめ $ 1 $ 体のゴーレムがいます。

すぬけ君は $ Q $ 回呪文を唱え、ゴーレムたちを移動させました。

$ i $ 番目の呪文は文字 $ t_i $ と $ d_i $ からなり、$ d_i $ は `L` か `R` のいずれかです。 すぬけ君がこの呪文を唱えると、$ t_i $ が書かれた全てのマスについて、そのマスにいる全てのゴーレムが隣接するマスに移動します。移動する方向は $ d_i $ が `L` ならば左、`R` ならば右です。

ただし、マス $ 1 $ から左に移動しようとしたゴーレムと、マス $ N $ から右に移動しようとしたゴーレムは消滅します。

$ Q $ 回の呪文詠唱後に消滅していないゴーレムの総数を求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ Q $ $ s $ $ t_1 $ $ d_1 $ $ \vdots $ $ t_{Q} $ $ d_Q $

## 输出格式

答えを出力せよ。

## 说明/提示

### 制約

- $ 1\ \leq\ N,Q\ \leq\ 2\ \times\ 10^{5} $
- $ |s|\ =\ N $
- $ s_i,t_i $ は英大文字
- $ d_i $ は `L` または `R`

### Sample Explanation 1

\- はじめ、各マスに $ 1 $ 体のゴーレムがいます。 - $ 1 $ 番目の呪文では、マス $ 1 $ にいるゴーレムが左に移動しようとし、消滅します。 - $ 2 $ 番目の呪文では、マス $ 2 $ にいるゴーレムが左に移動します。 - $ 3 $ 番目の呪文では、移動するゴーレムはいません。 - $ 4 $ 番目の呪文では、マス $ 1 $ にいるゴーレムが右に移動します。 - $ 4 $ 回の呪文詠唱後、マス $ 2 $ に $ 1 $ 体、マス $ 3 $ に $ 1 $ 体のゴーレムがいるため、消滅していないゴーレムは $ 2 $ 体です。

### Sample Explanation 2

\- $ 3 $ 回の呪文詠唱後、マス $ 2 $ に $ 1 $ 体、マス $ 4 $ に $ 2 $ 体、マス $ 6 $ に $ 2 $ 体のゴーレムがいるため、消滅していないゴーレムは $ 5 $ 体です。 - $ 1 $ つの呪文で複数のゴーレムが移動しうることに注意してください。

## 样例 #1

### 输入

```
3 4

ABC

A L

B L

B R

A R
```

### 输出

```
2
```

## 样例 #2

### 输入

```
8 3

AABCBDBA

A L

B R

A R
```

### 输出

```
5
```

## 样例 #3

### 输入

```
10 15

SNCZWRCEWB

B R

R R

E R

W R

Z L

S R

Q L

W L

B R

C L

A L

N L

E R

Z L

S L
```

### 输出

```
3
```



---

---
title: "Squares"
layout: "post"
diff: 普及+/提高
pid: AT_hhkb2020_d
tag: []
---

# Squares

## 题目描述

平面直角坐标系上有一个边长为 $n$ 的白色正方形，它的四个顶点的坐标分别为 $(0,0)$，$(0,n)$，$(n,0)$，$(n,n)$。

我们准备在该白色正方形内部（含边界）放置两个边与坐标轴平行、且顶点均为整点的正方形。其中，蓝色正方形的边长为 $a$，红色正方形的边长为 $b$。

请求出放置后两个正方形没有重叠部分的方案数对 $10^9+7$ 取模之后的结果。**边界可以重合。**

## 输入格式

**本题中，单个测试点有多组数据。**

每个测试点的输入第一行为数据组数 $t$。

接下来是 $t$ 组数据，每组数据一行，依次输入 $n,a,b$。

## 输出格式

每组数据输出一行一个整数，表示方案总数对 $10^9+7$ 取模之后的结果。

## 说明/提示

#### 样例 #1 说明

以第一组数据为例。

边长为 $3$ 的正方形内，有 $9$ 种方法放边长为 $1$ 的正方形，有 $4$ 种方法放边长为 $2$ 的正方形。

无论怎么放红色正方形，蓝色正方形都会有 $4$ 种与红色正方形重叠的放法。

从而，方案数就为 $9 \times 4 - 4 \times 4 =20$。

#### 数据规模与约定

$1 \le t \le 10^5$，$1 \le n \le 10^9$，$1 \le a,b \le n$，输入的数值均为整数。

## 样例 #1

### 输入

```
3

3 1 2

4 2 2

331895368 154715807 13941326
```

### 输出

```
20

32

409369707
```



---

---
title: "Lamps"
layout: "post"
diff: 普及+/提高
pid: AT_hhkb2020_e
tag: []
---

# Lamps

## 题目描述

[problemUrl]: https://atcoder.jp/contests/hhkb2020/tasks/hhkb2020_e

縦 $ H $ 行、横 $ W $ 列からなるマス目があり、それぞれのマスは散らかっているか散らかっていないかのどちらかです。

今からあなたはこのマス目のうち $ 0 $ 個以上の散らかっていないマスに照明を置きます。

照明は置かれたマスの上下左右の $ 4 $ 方向に、マス目の端もしくは最初に散らかっているマスにぶつかる直前まで照らします (散らかっているマスは照らされません)。照明は、置かれたマス自身も照らします。

整数 $ H,\ W $ と $ H $ 個の長さ $ W $ の文字列 $ S_i $ が与えられます。 $ S_i $ の $ j $ 文字目が `.` のとき、上から $ i $ 行目、左から $ j $ 列目のマスは散らかっていません。$ S_i $ の $ j $ 文字目が `#` のとき、上から $ i $ 行目、左から $ j $ 列目のマスは散らかっています。

散らかっていないマスの個数を $ K $ 個だとすると、照明の置き方は全部で $ 2^K $ 通りあります。 この $ 2^K $ 通りそれぞれについて、$ 1 $ 個以上の照明によって照らされるマスの個数を計算したときの総和を $ 1,000,000,007 $ で割ったあまりを求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ H $ $ W $ $ S_1 $ $ : $ $ S_H $

## 输出格式

$ 2^K $ 通りそれぞれについて、$ 1 $ 個以上の照明によって照らされるマスの個数を計算したときの総和を $ 1,000,000,007 $ で割ったあまりを出力せよ。

## 说明/提示

### 制約

- $ 1\ \leq\ H\ \leq\ 2000 $
- $ 1\ \leq\ W\ \leq\ 2000 $
- $ S_i $ は `.` と `#` のみからなる長さ $ W $ の文字列

### Sample Explanation 1

全部で照明の置き方は $ 16 $ 通りあります。 - このうち $ 9 $ 通り (左から $ 1 $ 番目か $ 2 $ 番目の少なくとも一方に照明が置かれている、かつ左から $ 4 $ 番目か $ 5 $ 番目の少なくとも一方に照明が置かれている) では、$ 4 $ マスが照らされます。 - このうち $ 3 $ 通り (左から $ 1 $ 番目か $ 2 $ 番目の少なくとも一方に照明が置かれている、かつ左から $ 4 $ 番目と $ 5 $ 番目のどちらにも照明が置かれていない) では、$ 2 $ マスが照らされます。 - このうち $ 3 $ 通り (左から $ 4 $ 番目か $ 5 $ 番目の少なくとも一方に照明が置かれている、かつ左から $ 1 $ 番目と $ 2 $ 番目のどちらにも照明が置かれていない) では、$ 2 $ マスが照らされます。 - このうち $ 1 $ 通り (照明が $ 1 $ つも置かれていない) では、$ 0 $ マスが照らされます。 求める総和は $ 4\ \times\ 9\ +\ 2\ \times\ 3\ +\ 2\ \times\ 3\ +\ 0\ \times\ 1\ =\ 48 $ となります。

## 样例 #1

### 输入

```
1 5

..#..
```

### 输出

```
48
```

## 样例 #2

### 输入

```
2 3

..#

#..
```

### 输出

```
52
```



---

---
title: "Dictionary"
layout: "post"
diff: 普及+/提高
pid: AT_icpc2012autumn_a
tag: []
---

# Dictionary

## 题目描述

[problemUrl]: https://atcoder.jp/contests/jag2012autumn/tasks/icpc2012autumn_a





---

---
title: "説明会"
layout: "post"
diff: 普及+/提高
pid: AT_indeednow_2015_quala_3
tag: []
---

# 説明会

## 题目描述

[problemUrl]: https://atcoder.jp/contests/indeednow-quala/tasks/indeednow_2015_quala_3

ある企業は、説明会に参加する学生の選抜コンテストを行いました。 説明会を行おうとしている会場の最大収容可能人数が決まっているため、コンテスト担当者はボーダーラインを何点にするかを悩んでいます。

選抜方法を説明します。

- ボーダーラインが $ x $ 点のとき、正の点数を取っている学生のうち $ x $ 点以上の得点を得た学生を全て選抜する。
- つまり、$ 0 $ 点の学生は会場の最大収容可能人数に関わらず選抜しない。

あなたには、選抜コンテストにおける $ N $ 人の学生の点数が与えられます。 また、会場の候補が $ Q $ 個あります。そして、会場の最大収容可能人数はそれぞれ $ k_1,k_2,…,k_Q $ です。 ある企業は、説明会をこれらの会場の候補のうちいずれかで開催しようとしています。

あなたの仕事は、それぞれの会場候補で説明会を行う場合について、最小のボーダーラインを出力しなければなりません。 具体的には、$ i\ (1≦i≦Q) $ 番目の会場候補で説明会を行うと仮定したとき、上記の方法に基づいて選抜した学生の数が $ k_i $ 人以下となるようなボーダーラインのうち $ 0 $ 以上かつ最小のものを出力してください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ s_1 $ $ s_2 $ : $ s_N $ $ Q $ $ k_1 $ $ k_2 $ : $ k_Q $

- $ 1 $ 行目には、学生の数 $ N\ (1≦N≦100,000) $ が与えられる。
- $ 2 $ 行目から $ N $ 行には、選抜コンテストにおける各学生の得点情報が与えられる。そのうち $ i\ (1≦i≦N) $ 行目には、$ i $ 番目の学生の得点 $ s_i\ (0≦s_i≦1,000,000) $ が与えられる。
- $ 2+N $ 行目には、会場候補の数 $ Q\ (1≦Q≦100,000) $ が与えられる。
- $ 3+N $ 行目から $ Q $ 行には、各会場候補の最大収容可能人数が与えられる。そのうち $ i\ (1≦i≦Q) $ 行目には、$ i $ 番目の会場の最大収容可能人数 $ k_i\ (0≦k_i≦N) $ が与えられる。

## 输出格式

$ 1 $ 行目から $ Q $ 行には、各会場候補で説明会を行う場合のボーダーラインを出力せよ。そのうち $ i\ (1≦i≦Q) $ 行目には、$ i $ 番目の会場で説明会を行う場合のボーダーラインを出力せよ。

## 说明/提示

### Sample Explanation 1

とんでもないケースですが、$ 1 $ 番目の会場の最大収容可能人数は $ 0 $ なので、誰も通過させたくありません。それを達成するボーダーラインで最小のものは $ 11 $ 点です。 $ 2 $ 番目の会場の最大収容可能人数は $ 4 $ 人なので、選抜する人数がそれ以下になるようなボーダーラインを設定しなければなりません。 もしボーダーラインを $ 6 $ 点に設定した場合、$ 6 $ 人通過してしまい会場の最大収容可能人数をオーバーしてしまいます。$ 7 $ 点に設定した場合は $ 3 $ 人のみ通過し、会場に収容可能でき、これが最小のボーダーラインです。 $ 3 $ 番目の会場の最大収容可能人数は $ 12 $ 人ですが、ボーダーラインは $ 0 $ 点にします。なぜならば、選抜方法より $ 0 $ 点の学生は通過できないので、正の点数を取った $ 12 $ 人のみが通過するからです。

### Sample Explanation 3

全員が $ 0 $ 点のケースもありえます。 この場合は、どんなボーダーラインに設定しても誰も通過しないので、会場の最大収容可能人数に関わらずボーダーラインは $ 0 $ 点にします。

## 样例 #1

### 输入

```
15

0

0

0

1

1

2

3

4

5

6

6

6

8

9

10

3

0

4

12
```

### 输出

```
11

7

0
```

## 样例 #2

### 输入

```
9

3

3

3

2

2

2

1

1

1

1

4
```

### 输出

```
3
```

## 样例 #3

### 输入

```
4

0

0

0

0

1

0
```

### 输出

```
0
```



---

---
title: "パズル"
layout: "post"
diff: 普及+/提高
pid: AT_indeednow_2015_quala_4
tag: []
---

# パズル

## 题目描述

[problemUrl]: https://atcoder.jp/contests/indeednow-quala/tasks/indeednow_2015_quala_4

あなたには、以下のような縦 $ H $マス、横 $ W $ マスのスライドパズルの盤面が与えられます(図1)。

![](https://cdn.luogu.com.cn/upload/vjudge_pic/AT_indeednow_2015_quala_4/27c449b69b0c35720b6d1bee41096f7623a661f9.png)  
図1. スライドパズル盤面

   
各マスには、相異なる $ 1 $ から $ H×W-1 $ までの番号が割り振られており、さらにある $ 1 $ つのマスは空きマスとなっています。

このスライドパズルでは、空白マスを左右上下のマスのいずれかと入れ替える操作が許されています。 ただし、入れ替えたい方向にマスが存在しない場合は入れ替えることができません。

この盤面に入れ替え操作を任意の回数行い、完成の状態にしたいと思っています。 ここで、完成の状態とは、左上のマスから順番に番号付けされており右下が空白マスであるような状態にしたいと思っています(図2)。

![](https://cdn.luogu.com.cn/upload/vjudge_pic/AT_indeednow_2015_quala_4/0618fe48636154c76d651eb5484bdec3557384e5.png)  
図2. 完成盤面

   
つまり、完成盤面とは、

- 番号 $ i\ (1≦i≦H×W-1) $ のマスは $ (1+[(i-1)÷W],1+(i-1)%W) $ にある
- さらに、空きマスが $ (H,W) $ にある

という状態を指します。$ [a÷b] $ は $ a $ を $ b $ で割った値の小数点以下を切り捨てたもの、$ a%b $ は $ a $ を $ b $ で割った余りを指します。

最小操作数が $ 24 $ 回以内ということが保障されているとき、パズルを解くのに必要な最小操作数を出力しなさい。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ H $ $ W $ $ c_{1,1} $ $ c_{1,2} $ … $ c_{1,W} $ $ c_{2,1} $ $ c_{2,2} $ … $ c_{2,W} $ : $ c_{H,1} $ $ c_{H,2} $ … $ c_{H,W} $

- $ 1 $ 行目には、パズルの盤面の縦方向の長さを表す整数 $ H\ (2≦H≦6) $ と横方向の長さを表す整数 $ W\ (2≦W≦6) $ がスペース区切りで与えられる。
- $ 2 $ 行目から $ H $ 行には、パズルの盤面の情報が与えられる。そのうち $ i\ (1≦i≦H) $ 行目には、スライドパズルの座標 $ (i,1),(i,2),...,(i,W) $ のマスに書かれている数字を表す整数 $ c_{i,1},c_{i,2},...,c_{i,W} $ がスペース区切りで与えられる。ただし、$ c_{i,j}=0 $のときは特別に、そのマスが空マスであることを表す。
- パズルの盤面には、$ 1 $ から $ H×W-1 $ までの整数が1つと、空マスを表す整数 $ 0 $ がちょうど $ 1 $ つずつ現れることが保障されている。
- パズルを解く最小操作数が $ 24 $ 回以内ということが保障されている。

## 输出格式

$ 1 $ 行目に、パズルを解く最小操作数を出力せよ。末尾の改行を忘れないこと。

## 说明/提示

### Sample Explanation 1

最初、空きマスは $ (1,2) $ にあります。この空きマスを「右→下→下」と動かすことで完成の状態にすることができ、そのとき最小操作回数を達成します。

### Sample Explanation 4

パズルが元から完成している場合もあります。

### Sample Explanation 5

出力する答えが最大となるケースです。

## 样例 #1

### 输入

```
3 3

1 0 2

4 5 3

7 8 6
```

### 输出

```
3
```

## 样例 #2

### 输入

```
3 5

6 1 2 8 5

7 0 4 3 10

11 12 13 9 14
```

### 输出

```
12
```

## 样例 #3

### 输入

```
2 2

1 2

3 0
```

### 输出

```
0
```

## 样例 #4

### 输入

```
4 4

1 2 3 4

5 6 7 8

9 10 11 12

13 14 15 0
```

### 输出

```
0
```

## 样例 #5

### 输入

```
6 6

1 2 3 4 5 6

14 15 10 16 11 12

8 9 19 17 0 18

7 13 20 22 23 24

25 26 21 28 29 30

31 32 27 33 34 35
```

### 输出

```
24
```



---

---
title: "Tree Separator"
layout: "post"
diff: 普及+/提高
pid: AT_jag2017autumn_e
tag: []
---

# Tree Separator

## 题目描述

给定一棵无根树 $T$ 与一个整数 $K$，你需要找到两个不同的节点 $u,v$，使得将在 $u,v$ 简单路径上的点及其所连接的边全部删去后剩余的连通块中大小至少为 $K$ 的连通块数量最多。

## 输入格式

第一行两个正整数 $N,K(2 \le N \le 10^5, 1 \le K \le N)$。

接下来 $N-1$ 行，每行两个正整数 $u_i,v_i(1\le u_i,v_i \le n, u_i \ne v_i)$，表示树上的一条边 $(u_i,v_i)$。

## 输出格式

输出剩余的连通块中大小至少为 $K$ 的连通块数量的最大值。



---

---
title: "チーズ (Cheese)"
layout: "post"
diff: 普及+/提高
pid: AT_joi2011yo_e
tag: []
---

# チーズ (Cheese)

## 题目描述

[problemUrl]: https://atcoder.jp/contests/joi2011yo/tasks/joi2011yo_e

今年も JOI 町のチーズ工場がチーズの生産を始め，ねずみが巣から顔を出した．JOI 町は東西南北に区画整理されていて，各区画は巣，チーズ工場，障害物，空き地のいずれかである．ねずみは巣から出発して全てのチーズ工場を訪れチーズを $ 1 $ 個ずつ食べる．

この町には，$ N $ 個のチーズ工場があり，どの工場も $ １ $ 種類のチーズだけを生産している．チーズの硬さは工場によって異なっており，硬さ $ 1 $ から $ N $ までのチーズを生産するチーズ工場がちょうど $ 1 $ つずつある．

ねずみの最初の体力は $ 1 $ であり，チーズを $ 1 $ 個食べるごとに体力が $ 1 $ 増える．ただし，ねずみは自分の体力よりも硬いチーズを食べることはできない．

ねずみは，東西南北に隣り合う区画に $ 1 $ 分で移動することができるが，障害物の区画には入ることができない．チーズ工場をチーズを食べずに通り過ぎることもできる．すべてのチーズを食べ終えるまでにかかる最短時間を求めるプログラムを書け．ただし，ねずみがチーズを食べるのにかかる時間は無視できる．

- - - - - -

## 输入格式

入力は $ H+1 $ 行ある．$ 1 $ 行目には $ 3 $ つの整数 $ H，W，N $ ($ 1\ \leqq\ H\ \leqq\ 1000 $，$ 1\ \leqq\ W\ \leqq\ 1000 $，$ 1\ \leqq\ N\ \leqq\ 9 $) がこの順に空白で区切られて書かれている．$ 2 $ 行目から $ H\ +\ 1 $ 行目までの各行には，`S`，`1`，`2`，$ \ldots $，`9`，`X`，`.` からなる $ W $ 文字の文字列が書かれており，各々が各区画の状態を表している．北から $ i $ 番目，西から $ j $ 番目の区画を $ (i,\ j) $ と記述することにすると ($ 1\ \leqq\ i\ \leqq\ H $，$ 1\ \leqq\ j\ \leqq\ W $)，第 $ i\ +\ 1 $ 行目の $ j $ 番目の文字は，区画 $ (i,\ j) $ が巣である場合は `S` となり，障害物である場合は `X` となり，空き地である場合は `.` となり，硬さ $ 1 $，$ 2 $，$ \ldots $，$ 9 $ のチーズを生産する工場である場合はそれぞれ `1`，`2`，$ \ldots $，`9` となる．入力には巣と硬さ $ 1 $，$ 2 $，$ \ldots $，$ N $ のチーズを生産する工場がそれぞれ $ 1 $ つずつある．他のマスは障害物または空き地であることが保証されている．ねずみは全てのチーズを食べられることが保証されている．

## 输出格式

すべてのチーズを食べ終えるまでにかかる最短時間（分）を表す整数を $ 1 $ 行で出力せよ．

- - - - - -

## 说明/提示

### Sample Explanation 1

\- - - - - -

### Sample Explanation 2

\- - - - - -

## 样例 #1

### 输入

```
3 3 1
S..
...
..1
```

### 输出

```
4
```

## 样例 #2

### 输入

```
4 5 2
.X..1
....X
.XX.S
.2.X.
```

### 输出

```
12
```

## 样例 #3

### 输入

```
10 10 9
.X...X.S.X
6..5X..X1X
...XXXX..X
X..9X...X.
8.X2X..X3X
...XX.X4..
XX....7X..
X..X..XX..
X...X.XX..
..X.......
```

### 输出

```
91
```



---

---
title: "ケーキの切り分け２ (Cake 2)"
layout: "post"
diff: 普及+/提高
pid: AT_joi2015ho_b
tag: []
---

# ケーキの切り分け２ (Cake 2)

## 题目描述

# 「JOI 2014/2015 决赛」分蛋糕 2

**译自 [JOI 2014/2015 决赛](https://www.ioi-jp.org/joi/2014/2015-ho/index.html) T2「[ケーキの切り分け２](https://www.ioi-jp.org/joi/2014/2015-ho/2015-ho.pdf)」**

JOI 君和 IOI 酱是双胞胎兄妹。 JOI 君最近闲暇时常常会做甜点。今天 JOI 君也烤了蛋糕吃，IOI 酱立马嗅到了蛋糕的香气于是跑来想分着吃。  
蛋糕是圆形的，从蛋糕中某点开始将蛋糕放射状切为 $ N $ 块，按逆时针顺序编号为 $ 1 $ 到 $ N $ 。也就是说，对任意 $ i $ 来说 $ (1 \leq i \leq N) $ ，第 $ i $ 块蛋糕紧挨着第 $ i-1 $ 块与第 $ i+1 $ 块（不过第 $ 0 $ 块相当于第 $ N $ 块，第 $ N+1 $ 块相当于第 $ 1 $ 块）。第 $ i $ 块蛋糕的大小为 $ A_i $ 。由于切蛋糕的人刀功很不好，所以 $ A_i $ 互不相同。

![](https://www.z4a.net/images/2018/08/04/5c83a03e0789dafd806d5f7e488b001d.png)

JOI 君和 IOI 酱按照以下的方法分这 $N$ 块蛋糕：
1. 首先 JOI 君从这 $ N $ 块蛋糕中任选一块取走；
2. 然后，从 IOI 酱开始， IOI 酱和 JOI 君交替地从剩下的蛋糕中选出一块取走。不过，当且仅当一块蛋糕两旁的蛋糕至少有一块已经被选择，这块蛋糕才能被选择。如果可供选择的蛋糕有多个， IOI 酱会选择最大的一个，而 JOI 君可以任选一个。

JOI 君想让自己所得到的蛋糕大小的合计值最大。

#### 任务
给出蛋糕的块数 $ N $ 和这 $ N $ 块蛋糕的大小。请编写程序求出 JOI 君得到的蛋糕大小的总和的最大值。

## 输入格式

第一行为整数 $ N $ ，表示蛋糕被切成了 $ N $ 块；  
接下来 $ N $ 行中的第 $ i $ 行 $ (1 \leq i \leq N) $ 为一个整数 $ A_i $ 。表示第 $ i $ 块蛋糕的大小。

## 输出格式

输出一行： JOI 君得到的蛋糕大小的总和的最大值。
## 样例
#### 输入样例 1
```plain
5
2
8
1
10
9
```
#### 输出样例 1
```plain
18
```

## 说明/提示

JOI 君依次进行以下操作时为最优解：

1.  JOI 君选择第 $ 2 $ 块蛋糕，这块蛋糕的大小为 $ 8 $；
2.  IOI 酱选择第 $ 1 $ 块蛋糕，这块蛋糕的大小为 $ 2 $；
3.  JOI 君选择第 $ 5 $ 块蛋糕，这块蛋糕的大小为 $ 9 $；
4.  IOI 酱选择第 $ 4 $ 块蛋糕，这块蛋糕的大小为 $ 10 $；
5.  JOI 君选择第 $ 3 $ 块蛋糕，这块蛋糕的大小为 $ 1 $；

最后 JOI 君得到的蛋糕的大小的总和为 $ 8+9+1=18 $。

#### 输入样例 2
```plain
8
1
10
4
5
6
2
9
3
```
#### 输出样例 2
```plain
26
```
#### 输入样例 3
```plain
15
182243672
10074562
977552215
122668426
685444213
3784162
463324752
560071245
134465220
21447865
654556327
183481051
20041805
405079805
564327789
```
#### 输出样例 3
```plain
3600242976
```
对于 $ 15\% $ 的分值：
- $ N \leq 20 $

对于另 $45\%$ 的分值：
- $ N \leq 300 $

对于 $100\%$ 的分值，所有输入数据满足以下条件：
- $ 1 \leq N \leq 2000 $；
- $ 1 \leq A_i \leq 10^9 $；
- 每个 $ A_i $ 都不同。

感谢@ミク 提供的翻译

## 样例 #1

### 输入

```
5
2
8
1
10
9
```

### 输出

```
18
```

## 样例 #2

### 输入

```
8
1
10
4
5
6
2
9
3
```

### 输出

```
26
```

## 样例 #3

### 输入

```
15
182243672
10074562
977552215
122668426
685444213
3784162
463324752
560071245
134465220
21447865
654556327
183481051
20041805
405079805
564327789
```

### 输出

```
3600242976
```



---

---
title: "JOI 公園 (JOI Park)"
layout: "post"
diff: 普及+/提高
pid: AT_joi2015ho_c
tag: []
---

# JOI 公園 (JOI Park)

## 题目描述

# 「JOI 2014/2015 决赛」JOI 公园

**译自 [JOI 2014/2015 决赛](https://www.ioi-jp.org/joi/2014/2015-ho/index.html) T3「[JOI 公園](https://www.ioi-jp.org/joi/2014/2015-ho/2015-ho.pdf)」**

时值 $ 20\text{XX} $ 年， IOI 国为了给办奥赛做准备，将要修缮 IOI 国中的 JOI 公园。 JOI 公园里有 $ N $ 个广场，这些广场从 $ 1 $ 到 $ N $ 编号。有 $ M $ 条道路连接各个广场，这些道路从 $ 1 $ 到 $ M $ 编号。第 $ i(1 \leq i \leq M) $ 条道路是一条连接第 $ A_i $ 和第 $ B_i $ 个广场的双向边，长度为 $ D_i $ 。任意两个广场间一定有道路（直接或间接）相连。

修缮计划如下：首先，选择一个**自然数**  $ X $ ，将和第一个广场距离等于 $ X $ 或在 $ X $ 以下的所有广场（含第一个广场）相互之间连结一条地下通道。广场 $ i $ 和广场 $ j $ 的距离指，从广场 $ i $ 到广场 $ j $ 经过的道路长度总和的最小值。定义 $ C $ 为一个与修筑地下通道花费有关的量（ $ C $ 是整数）。修筑所有地下通道的花费为 $ C\times X $ 。

接下来，撤去已经通过地下通道连接的广场之间的道路。撤去道路的花费不计。

最后，将没有被撤去的道路进行修补，长为 $ d $ 的道路修补的花费为 $ d $ 。

修缮计划实施之前， JOI 公园没有地下通道。请求出 JOI 公园修缮花费总和的最小值。

#### 任务
给出 JOI 公园的广场间道路的情况和 $ C $ 的值，请编写程序求出修缮 JOI 公园的花费总和的最小值。

## 输入格式

输入标准如下：
- 第一行为三个以空格分开的整数 $ N,M,C $ ，分别表示广场共有 $ N $ 个，道路有 $ M $ 条，而 $ C $ 为与修筑地下通道花费有关的量；
- 接下来 $ M $ 行中的第 $ i $ 行 $ (1 \leq i \leq M) $ 为三个以空格分开的整数 $ A_i,B_i,D_i $ 。表示第 $ i $ 条道路连接广场 $ A_i $ 和广场 $ B_i $ ，其长度为 $ D_i $ 。

## 输出格式

输出一行一个整数：修缮 JOI 公园的花费总和的最小值。

## 样例
#### 输入样例 1
```plain
5 5 2
2 3 1
3 1 2
2 4 3
1 2 4
2 5 5
```
#### 输出样例 1
```plain
14
```

## 说明/提示

对于输入样例 $1$， $ X=3 $ 也就是说，和广场 $ 1 $ 的距离在 $ 3 $ 或以下的广场（广场 $ 1 $ ，广场 $ 2 $ ，广场 $ 3 $ ）互相之间连接一条地下通道。修缮总花费为 $ 2\times 3+3+5=14 $ 。这就是最小值。
#### 输入样例 2
```plain
5 4 10
1 2 3
2 3 4
3 4 3
4 5 5
```
#### 输出样例 2
```plain
15
```
对于输入样例 $ 2 $ ，$ X=0 $ 时修缮总花费最小。
#### 输入样例 3
```plain
6 5 2
1 2 2
1 3 4
1 4 3
1 5 1
1 6 5
```
#### 输出样例 3
```plain
10
```
对于输入样例 $3$，$ X=5 $ 时所有广场相互间都会连接一条地下通道，此时修缮的花费最小。

对于 $ 15\% $ 的分值：
- $ N \leq 100 $
- $ M \leq 200 $
- $ C \leq 100 $
- $ D_i \leq 10 (1 \leq i \leq M) $

对于另 $ 45\% $ 的分值：
- $ N \leq 100 $
- $ M \leq 4000 $

对于 $ 100\% $ 的分值，所以输入数据满足以下条件：
- $ 2 \leq N \leq 10^5 $
- $ 1 \leq M \leq 2\times 10^5 $
- $ 1 \leq C \leq 10^5 $
- $ 1 \leq A_i,B_i \leq N (1 \leq i \leq M) $
- $ A_i\not = B_i (1 \leq i \leq M) $
- $ (A_i,B_i)\not =(A_j,B_j) $ 而且 $ (A_i,B_i)\not =(B_j,A_j) (1 \leq i\lt j \leq M) $
- $ 1 \leq D_i \leq 10^5 (1 \leq i \leq M) $
- 输入数据保证任意两个广场之间一定有道路连接（直接或间接）。

感谢@ミク 提供的翻译

## 样例 #1

### 输入

```
5 5 2
2 3 1
3 1 2
2 4 3
1 2 4
2 5 5
```

### 输出

```
14
```

## 样例 #2

### 输入

```
5 4 10
1 2 3
2 3 4
3 4 3
4 5 5
```

### 输出

```
15
```

## 样例 #3

### 输入

```
6 5 2
1 2 2
1 3 4
1 4 3
1 5 1
1 6 5
```

### 输出

```
10
```



---

---
title: "展覧会 (Exhibition)"
layout: "post"
diff: 普及+/提高
pid: AT_joi2019ho_b
tag: []
---

# 展覧会 (Exhibition)

## 题目描述

[problemUrl]: https://atcoder.jp/contests/joi2019ho/tasks/joi2019ho_b

あなたは，絵の展覧会を開催しようとしている．展覧会では，いくつかの絵を額縁に入れ，左から右に一列に並べて展示する．

展覧会で展示する候補となる絵が $ N $ 枚あり，$ 1 $ から $ N $ までの番号が付けられている．絵 $ i $ ($ 1\ \leqq\ i\ \leqq\ N $) の大きさは $ S_i $，価値は $ V_i $ である．

また，これらの絵を入れるための額縁が $ M $ 枚あり，$ 1 $ から $ M $ までの番号が付けられている．額縁 $ j $ ($ 1\ \leqq\ j\ \leqq\ M $) の大きさは $ C_j $ である．額縁 $ j $ には，大きさが $ C_j $ 以下の絵のみを入れることができる．$ 1 $ 枚の額縁には高々 $ 1 $ 枚の絵しか入れることができない．

展示する絵はすべて何らかの額縁に入っていなければならない．見栄えを良くするため，展示する絵は以下の条件を満たさなければならない：

- 左右に隣り合うどの $ 2 $ 枚の絵についても，右側の絵が入っている額縁の大きさは左側の絵が入っている額縁の大きさ以上である．
- 左右に隣り合うどの $ 2 $ 枚の絵についても，右側の絵の価値は左側の絵の価値以上である．

あなたは，できるだけ多くの絵を展示したい．

展示候補の絵の枚数，額縁の枚数，及びそれらの大きさや価値が与えられたとき，展示する絵の枚数の最大値を求めるプログラムを作成せよ．

- - - - - -

## 输入格式

入力は以下の形式で標準入力から与えられる．

> $ N $ $ M $ $ S_1 $ $ V_1 $ $ \vdots $ $ S_N $ $ V_N $ $ C_1 $ $ \vdots $ $ C_M $

## 输出格式

標準出力に，展覧会に展示する絵の枚数の最大値を $ 1 $ 行で出力せよ．

- - - - - -

## 说明/提示

### 制約

- $ 1\ \leqq\ N\ \leqq\ 100\,000 $．
- $ 1\ \leqq\ M\ \leqq\ 100\,000 $．
- $ 1\ \leqq\ S_i\ \leqq\ 1\,000\,000\,000 $ ($ 1\ \leqq\ i\ \leqq\ N $)．
- $ 1\ \leqq\ V_i\ \leqq\ 1\,000\,000\,000 $ ($ 1\ \leqq\ i\ \leqq\ N $)．
- $ 1\ \leqq\ C_j\ \leqq\ 1\,000\,000\,000 $ ($ 1\ \leqq\ j\ \leqq\ M $)．

### 小課題

1. ($ 10 $ 点) $ N\ \leqq\ 10 $，$ M\ \leqq\ 10 $．
2. ($ 40 $ 点) $ N\ \leqq\ 1\,000 $，$ M\ \leqq\ 1\,000 $．
3. ($ 50 $ 点) 追加の制約はない．

- - - - - -

### Sample Explanation 1

この入出力例では，左から順に (絵 $ 2 $, 額縁 $ 2 $)，(絵 $ 1 $, 額縁 $ 3 $) と並べることで，$ 2 $ 枚の絵を展示することができる．$ 3 $ 枚以上の絵を展示することはできないので，$ 2 $ を出力する．ここで，(絵 $ i $, 額縁 $ j $) は，額縁 $ j $ に入った絵 $ i $ を表す． - - - - - -

### Sample Explanation 2

\- - - - - -

### Sample Explanation 3

\- - - - - -

## 样例 #1

### 输入

```
3 4
10 20
5 1
3 5
4
6
10
4
```

### 输出

```
2
```

## 样例 #2

### 输入

```
3 2
1 2
1 2
1 2
1
1
```

### 输出

```
2
```

## 样例 #3

### 输入

```
4 2
28 1
8 8
6 10
16 9
4
3
```

### 输出

```
0
```

## 样例 #4

### 输入

```
8 8
508917604 35617051
501958939 840246141
485338402 32896484
957730250 357542366
904165504 137209882
684085683 775621730
552953629 20004459
125090903 607302990
433255278
979756183
28423637
856448848
276518245
314201319
666094038
149542543
```

### 输出

```
3
```



---

---
title: "たのしい家庭菜園"
layout: "post"
diff: 普及+/提高
pid: AT_joisc2014_b
tag: []
---

# たのしい家庭菜園

## 题目描述

[problemUrl]: https://atcoder.jp/contests/joisc2014/tasks/joisc2014_b





---

---
title: "Cell Inversion"
layout: "post"
diff: 普及+/提高
pid: AT_jsc2019_qual_c
tag: []
---

# Cell Inversion

## 题目描述

[problemUrl]: https://atcoder.jp/contests/jsc2019-qual/tasks/jsc2019_qual_c

$ 2N $ 個のマスが左右一列に並んでおり、各マスの色を表す長さ $ 2N $ の文字列 $ S $ が与えられます。

左から $ i $ 番目のマスの色は、$ S $ の $ i $ 文字目が `B` のとき黒色で、`W` のとき白色です。

あなたは異なる $ 2 $ マスを選んで、それらのマスおよびそれらの間にあるマスの色を反転する操作をちょうど $ N $ 回行います。 ここで、マスの色を反転するとは、そのマスの色が黒色なら白色に、白色なら黒色にすることです。

ただし、操作を通して同じマスを $ 2 $ 回以上選ぶことはできません。 つまり、各マスがちょうど $ 1 $ 回ずつ選ばれることになります。

$ N $ 回の操作終了後に全てのマスを白色にする方法が何通りあるかを $ 10^9+7 $ で割った余りを求めてください。

ここで、条件を満たす $ 2 $ つの方法が異なるとは、$ 1 $ つ目の方法で $ i $ 番目に選んだ $ 2 $ つのマスの組と $ 2 $ つ目の方法で $ i $ 番目に選んだ $ 2 $ つのマスの組が異なるような $ i $ $ (1\ \leq\ i\ \leq\ N) $ が存在することをいいます。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ S $

## 输出格式

$ N $ 回の操作終了後に全てのマスを白色にする方法の個数を $ 10^9+7 $ で割った余りを出力せよ。そのような方法が存在しない場合、代わりに $ 0 $ を出力せよ。

## 说明/提示

### 制約

- $ 1\ \leq\ N\ \leq\ 10^5 $
- $ |S|\ =\ 2N $
- $ S $ の各文字は `B` または `W` である。

### Sample Explanation 1

全てのマスを白色にする方法は次の $ 4 $ 通りあります。 - 最初の操作では $ 1,\ 3 $ 番目のマスを選び、次の操作では $ 2,\ 4 $ 番目のマスを選びます。 - 最初の操作では $ 2,\ 4 $ 番目のマスを選び、次の操作では $ 1,\ 3 $ 番目のマスを選びます。 - 最初の操作では $ 1,\ 4 $ 番目のマスを選び、次の操作では $ 2,\ 3 $ 番目のマスを選びます。 - 最初の操作では $ 2,\ 3 $ 番目のマスを選び、次の操作では $ 1,\ 4 $ 番目のマスを選びます。

## 样例 #1

### 输入

```
2

BWWB
```

### 输出

```
4
```

## 样例 #2

### 输入

```
4

BWBBWWWB
```

### 输出

```
288
```

## 样例 #3

### 输入

```
5

WWWWWWWWWW
```

### 输出

```
0
```



---

---
title: "Double Landscape"
layout: "post"
diff: 普及+/提高
pid: AT_keyence2019_d
tag: []
---

# Double Landscape

## 题目描述

[problemUrl]: https://atcoder.jp/contests/keyence2019/tasks/keyence2019_d

$ N $ 行 $ M $ 列のグリッドに，$ 1 $ から $ N\ \times\ M $ までの整数を重複のないように $ 1 $ つずつ書き込むことを考えます． ここで，普通に書き込むのでは面白くないと思った高橋君は，以下の条件を満たすように数を書き込むことにしました．

- $ i $ 行目に書き込まれている値のうち，最大の値は $ A_i $ $ (1\ \leq\ i\ \leq\ N) $
- $ j $ 列目に書き込まれている値のうち，最大の値は $ B_j $ $ (1\ \leq\ j\ \leq\ M) $

高橋君のために，この条件を満たすような書き込み方の個数を $ 10^9\ +\ 7 $ で割ったあまりを求めてください．

## 输入格式

入力は以下の形式で標準入力から与えられる．

> $ N $ $ M $ $ A_1 $ $ A_2 $ $ ... $ $ A_{N} $ $ B_1 $ $ B_2 $ $ ... $ $ B_{M} $

## 输出格式

条件を満たすような書き込み方の個数を $ 10^9\ +\ 7 $ で割ったあまりを出力せよ．

## 说明/提示

### 制約

- $ 1\ \leq\ N\ \leq\ 1000 $
- $ 1\ \leq\ M\ \leq\ 1000 $
- $ 1\ \leq\ A_i\ \leq\ N\ \times\ M $
- $ 1\ \leq\ B_j\ \leq\ N\ \times\ M $
- $ A_i,\ B_j $ は整数

### Sample Explanation 1

$ (A_1,\ A_2)\ =\ (4,\ 3) $，$ (B_1,\ B_2)\ =\ (3,\ 4) $ であり，この場合は以下の $ 2 $ 通りの書き込み方があります． - $ 1 $ 行 $ 1 $ 列目に $ 1 $，$ 1 $ 行 $ 2 $ 列目に $ 4 $，$ 2 $ 行 $ 1 $ 列目に $ 3 $，$ 2 $ 行 $ 2 $ 列目に $ 2 $ - $ 1 $ 行 $ 1 $ 列目に $ 2 $，$ 1 $ 行 $ 2 $ 列目に $ 4 $，$ 2 $ 行 $ 1 $ 列目に $ 3 $，$ 2 $ 行 $ 2 $ 列目に $ 1 $

### Sample Explanation 2

どのような書き込み方をしても条件を満たすことができないので，$ 0 $ を出力します．

## 样例 #1

### 输入

```
2 2

4 3

3 4
```

### 输出

```
2
```

## 样例 #2

### 输入

```
3 3

5 9 7

3 6 9
```

### 输出

```
0
```

## 样例 #3

### 输入

```
2 2

4 4

4 4
```

### 输出

```
0
```

## 样例 #4

### 输入

```
14 13

158 167 181 147 178 151 179 182 176 169 180 129 175 168

181 150 178 179 167 180 176 169 182 177 175 159 173
```

### 输出

```
343772227
```



---

---
title: "Swap and Flip"
layout: "post"
diff: 普及+/提高
pid: AT_keyence2020_d
tag: []
---

# Swap and Flip

## 题目描述

[problemUrl]: https://atcoder.jp/contests/keyence2020/tasks/keyence2020_d

$ N $ 枚のカードがあり、$ 1,\ 2,\ ...,\ N $ の番号がついています。 カード $ i $ ($ 1\ \leq\ i\ \leq\ N $) の片方の面には赤い文字で整数 $ A_i $ が、 もう片方の面には青い文字で整数 $ B_i $ が書かれています。 最初、これらのカードは赤い文字が書かれた面を表にして 左から右に番号順に一列に並んでいます。

以下の操作を繰り返すことで、カードの表側の面に書かれた整数の列が左から右に広義単調増加となる （すなわち、各 $ i $ ($ 1\ \leq\ i\ \leq\ N\ -\ 1 $) に対して、左から $ i\ +\ 1 $ 枚目のカードの表側の面に書かれた整数が $ i $ 枚目のカードの表側の面に書かれた整数以上である） ようにすることが可能かどうか判定してください。 さらに、可能である場合、必要な操作の回数の最小値を求めてください。

- 整数 $ i $ ($ 1\ \leq\ i\ \leq\ N\ -\ 1 $) を一つ選ぶ。 左から $ i $ 番目のカードと $ i\ +\ 1 $ 番目のカードの位置を入れ替え、さらにこれら $ 2 $ 枚のカードを裏返す。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ A_1 $ $ A_2 $ $ ... $ $ A_N $ $ B_1 $ $ B_2 $ $ ... $ $ B_N $

## 输出格式

単調増加となるようにすることが不可能である場合、`-1` と出力せよ。 可能である場合、必要な操作の回数の最小値を出力せよ。

## 说明/提示

### 制約

- $ 1\ \leq\ N\ \leq\ 18 $
- $ 1\ \leq\ A_i,\ B_i\ \leq\ 50 $ ($ 1\ \leq\ i\ \leq\ N $)
- 入力値はすべて整数である。

### Sample Explanation 1

$ i\ =\ 1 $ として操作を $ 1 $ 回行うと、 カードの表側の面に書かれた整数の列は $ [2,\ 3,\ 3] $ となり、単調増加となります。

### Sample Explanation 2

何回操作を行っても、 カードの表側の面に書かれた整数の列は $ [2,\ 1] $ のままであり、これは単調増加ではありません。

### Sample Explanation 3

操作を行う必要がない場合もあります。

## 样例 #1

### 输入

```
3

3 4 3

3 2 3
```

### 输出

```
1
```

## 样例 #2

### 输入

```
2

2 1

1 2
```

### 输出

```
-1
```

## 样例 #3

### 输入

```
4

1 2 3 4

5 6 7 8
```

### 输出

```
0
```

## 样例 #4

### 输入

```
5

28 15 22 43 31

20 22 43 33 32
```

### 输出

```
-1
```

## 样例 #5

### 输入

```
5

4 46 6 38 43

33 15 18 27 37
```

### 输出

```
3
```



---

---
title: "Robot on Grid"
layout: "post"
diff: 普及+/提高
pid: AT_keyence2021_c
tag: []
---

# Robot on Grid

## 题目描述

[problemUrl]: https://atcoder.jp/contests/keyence2021/tasks/keyence2021_c

$ H $ 行 $ W $ 列のマス目があります。上から $ i $ 行目、左から $ j $ 列目のマスを $ (i,j) $ と書くことにします。 それぞれのマスには `R`, `D`, `X` のいずれかの文字を書き込むことができます。はじめ、どのマスにも文字は書き込まれていません。

すぬけ君は $ K $ 個のマスを選んで文字を書き込みました。 $ i $ 番目に文字を書き込んだマスは $ (h_i,w_i) $ で、書き込んだ文字は $ c_i $ でした。

残りのマスへの文字の書き込み方は $ 3^{HW-K} $ 通りあります。それぞれの場合について以下の問題の答えを計算し、その総和を $ 998244353 $ で割ったあまりを求めてください。

> 上記のマス目上を移動可能なロボットがあります。 ロボットは $ (i,j) $ にいるとき、$ (i+1,j),(i,j+1) $ のいずれかに移動することができます。 ただし、$ (i,j) $ に `R` と書かれていた場合は $ (i,j+1) $ にのみ、`D` と書かれていた場合は $ (i+1,j) $ にのみ移動することができます。`X` と書かれていた場合はどちらにも移動可能です。
> 
> ロボットを $ (1,1) $ に設置したとき、ロボットがマス目の外に出ずに $ (H,W) $ に到達するようなロボットの移動経路は何通りありますか？ただし、ロボットは $ (H,W) $ に到達した時点で停止するものとします。
> 
> ここで、$ 2 $ つの移動経路が異なるとはロボットが通ったマスの集合が異なることをいいます。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ H $ $ W $ $ K $ $ h_1 $ $ w_1 $ $ c_1 $ $ \vdots $ $ h_K $ $ w_K $ $ c_K $

## 输出格式

答えを出力せよ。

## 说明/提示

### 制約

- $ 2\ \leq\ H,W\ \leq\ 5000 $
- $ 0\ \leq\ K\ \leq\ \min(HW,2\ \times\ 10^5) $
- $ 1\ \leq\ h_i\ \leq\ H $
- $ 1\ \leq\ w_i\ \leq\ W $
- $ i\ \neq\ j $ ならば $ (h_i,w_i)\ \neq\ (h_j,w_j) $
- $ c_i $ は `R`, `D`, `X` のいずれか

### Sample Explanation 1

\- $ (1,2) $ のみまだ文字が書き込まれていません。 - `R` を書いたとき、ロボットが $ (H,W) $ に到達するようなロボットの移動経路は $ 1 $ 通りです。 - `D` を書いたとき、ロボットが $ (H,W) $ に到達するようなロボットの移動経路は $ 2 $ 通りです。 - `X` を書いたとき、ロボットが $ (H,W) $ に到達するようなロボットの移動経路は $ 2 $ 通りです。 - これらの総和である $ 5 $ を出力してください。

### Sample Explanation 3

\- $ 998244353 $ で割ったあまりを求めるのを忘れずに。

## 样例 #1

### 输入

```
2 2 3

1 1 X

2 1 R

2 2 R
```

### 输出

```
5
```

## 样例 #2

### 输入

```
3 3 5

2 3 D

1 3 D

2 1 D

1 2 X

3 1 R
```

### 输出

```
150
```

## 样例 #3

### 输入

```
5000 5000 10

585 1323 R

2633 3788 X

1222 4989 D

1456 4841 X

2115 3191 R

2120 4450 X

4325 2864 X

222 3205 D

2134 2388 X

2262 3565 R
```

### 输出

```
139923295
```



---

---
title: "Two Step Sort"
layout: "post"
diff: 普及+/提高
pid: AT_kupc2021_g
tag: []
---

# Two Step Sort

## 题目描述

有 $N$ 个盒子和 $N$ 个球，编号为 1 到 $N$。最初，第 $i$ 个盒子里装着编号为 $P_i$ 的球。每个盒子只能装一个球，开始时所有盒子都是关闭的，可以打开盒子。

接下来将进行两次球的移动操作，每次操作遵循以下步骤：

1. 选择若干盒子打开，每个盒子都有固定的打开成本。
2. 在打开的盒子之间随意移动球，操作完成时，每个盒子必须有一个球。
3. 将所有打开的盒子再次关闭。

第一次操作时，打开第 $i$ 个盒子的成本为 $A_i$；第二次操作时，打开第 $i$ 个盒子的成本为 $B_i$。经过两次操作后，要求第 $i$ 个盒子里装有第 $i$ 个球。请计算达到目标的最低总成本。

## 输入格式

输入由标准输入给出：  
> $N$ $P_1$ $P_2$ $\ldots$ $P_N$ $A_1$ $A_2$ $\ldots$ $A_N$ $B_1$ $B_2$ $\ldots$ $B_N$

## 输出格式

输出一个整数，表示实现目标的最小总成本。

## 说明/提示

- $1 \leq N \leq 10^5$
- $1 \leq P_i \leq N$
- 当 $i \neq j$ 时，$P_i \neq P_j$
- $1 \leq A_i \leq 10^9$
- $1 \leq B_i \leq 10^9$
- 所有输入均为整数

### 示例解释

在第一个移动事件中，打开盒子 2 和 4，把球 1 放入盒子 2，把球 4 放入盒子 4，这样的操作成本是 8。在第二次移动事件中，打开盒子 1、2、3 和 5，把球 1、2、3 和 5 放入相应的盒子中，操作成本为 20。整个过程的总成本为 28，这是满足条件的最小成本。

有时候，初始状态已经满足要求，意味着不需要进行任何移动。

 **本翻译由 AI 自动生成**

## 样例 #1

### 输入

```
5

2 4 5 1 3

11 5 3 3 8

4 6 7 9 3
```

### 输出

```
28
```

## 样例 #2

### 输入

```
1

1

1000000000

1000000000
```

### 输出

```
0
```



---

---
title: "Three Coloring"
layout: "post"
diff: 普及+/提高
pid: AT_kupc2021_k
tag: []
---

# Three Coloring

## 题目描述

[problemUrl]: https://atcoder.jp/contests/kupc2021/tasks/kupc2021_k

$ N $ 個の壁があります。各壁を赤、緑、青のいずれか $ 1 $ 色で塗ることを考えます。

$ M $ 個の条件が与えられます。$ i $ 番目の条件は、整数 $ a_i,b_i $ と文字 $ x_i,y_i $ が与えられ、

- 壁 $ a_i $ を 色 $ x_i $ で塗ったとき、壁 $ b_i $ を 色 $ y_i $ で塗ってはならない

ことを表しています。ただし、 $ x_i,y_i $ はそれぞれ文字 `R` , `G` , `B` のいずれかであり、 `R` のとき赤を、`G` のとき緑を、 `B` のとき青を表しています。

$ M $ 個全ての条件を満たす色の塗り方が何通りあるかを答えてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ M $ $ a_1 $ $ x_1 $ $ b_1 $ $ y_1 $ $ \vdots $ $ a_M $ $ x_M $ $ b_M $ $ y_M $

## 输出格式

答えを $ 1 $ 行で出力せよ。

## 说明/提示

### 制約

- $ 1\ \leq\ N\ \leq\ 22 $
- $ 0\ \leq\ M\ \leq\ 9\ \times\ \frac{N(N-1)}{2} $
- $ 1\ \leq\ a_i\ <\ b_i\ \leq\ N $
- $ x_i,y_i $ はそれぞれ文字 `R` , `G` , `B` のいずれかである。
- $ i\ \neq\ j $ のとき、$ (a_i,x_i,b_i,y_i)\ \neq\ (a_j,x_j,b_j,y_j) $
- $ N,M,a_i,b_i $ はいずれも整数

### Sample Explanation 1

壁 $ 1 $ を赤色で塗る場合、壁 $ 2 $ は緑色または青色で塗ることができます。 壁 $ 1 $ を緑色で塗る場合、壁 $ 2 $ は緑色または青色で塗ることができます。 壁 $ 1 $ を青色で塗る場合、壁 $ 2 $ は赤色または青色で塗ることができます。 よって、合計で $ 6 $ 通りの塗り方があります。

### Sample Explanation 2

壁 $ 1 $ をどの色で塗っても条件を満たします。

### Sample Explanation 3

オーバーフローに注意してください。

## 样例 #1

### 输入

```
2 3

1 R 2 R

1 G 2 R

1 B 2 G
```

### 输出

```
6
```

## 样例 #2

### 输入

```
1 0
```

### 输出

```
3
```

## 样例 #3

### 输入

```
22 0
```

### 输出

```
31381059609
```

## 样例 #4

### 输入

```
4 12

2 R 3 R

1 B 2 B

2 R 3 B

3 R 4 R

1 B 4 G

1 R 3 B

3 G 4 B

2 G 3 G

1 B 2 R

1 G 2 R

1 R 3 G

1 G 3 B
```

### 输出

```
13
```



---

---
title: "Shortest Path on a Line"
layout: "post"
diff: 普及+/提高
pid: AT_nikkei2019_2_qual_d
tag: []
---

# Shortest Path on a Line

## 题目描述

[problemUrl]: https://atcoder.jp/contests/nikkei2019-2-qual/tasks/nikkei2019_2_qual_d

一直線上に $ N $ 個の点があり、順に $ 1 $ から $ N $ までの番号がついています。

高橋君はこれらの点を頂点として無向グラフを作ることにしました。 はじめはグラフに辺はないですが、$ M $ 回の操作によって辺を追加します。 $ i $ 回目の操作では次のように辺を追加します。

- $ 1 $ 以上 $ N $ 以下の整数 $ L_i $, $ R_i $ 及び正整数 $ C_i $ を用いる。 $ L_i\ ≦\ s\ <\ t\ ≦\ R_i $ なる整数の組 $ (s,t) $ すべてに対し、頂点 $ s $ と頂点 $ t $ の間に長さ $ C_i $ の辺を追加する。

ただし、$ L_1,...,L_M $, $ R_1,...,R_M $, $ C_1,...,C_M $ はすべて入力で与えられます。

高橋君は最終的に得られたグラフ上で最短路問題を解きたいです。得られたグラフ上での頂点 $ 1 $ から頂点 $ N $ までの最短路の長さを求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ M $ $ L_1 $ $ R_1 $ $ C_1 $ $ : $ $ L_M $ $ R_M $ $ C_M $

## 输出格式

頂点 $ 1 $ から頂点 $ N $ までの最短路の長さを出力せよ。 ただし、最短路が存在しない場合は `-1` を出力せよ。

## 说明/提示

### 制約

- $ 2\ ≦\ N\ ≦\ 10^5 $
- $ 1\ ≦\ M\ ≦\ 10^5 $
- $ 1\ ≦\ L_i\ <\ R_i\ ≦\ N $
- $ 1\ ≦\ C_i\ ≦\ 10^9 $

### Sample Explanation 1

頂点 $ 1 $ と頂点 $ 2 $ の間に長さ $ 2 $ の辺があり、頂点 $ 2 $ と頂点 $ 4 $ の間に長さ $ 3 $ の辺があるので、頂点 $ 1 $ と頂点 $ 4 $ の間に長さ $ 5 $ のパスが存在します。

## 样例 #1

### 输入

```
4 3

1 3 2

2 4 3

1 4 6
```

### 输出

```
5
```

## 样例 #2

### 输入

```
4 2

1 2 1

3 4 2
```

### 输出

```
-1
```

## 样例 #3

### 输入

```
10 7

1 5 18

3 4 8

1 3 5

4 7 10

5 9 8

6 10 5

8 10 3
```

### 输出

```
28
```



---

---
title: "Restore the Tree"
layout: "post"
diff: 普及+/提高
pid: AT_nikkei2019_qual_d
tag: []
---

# Restore the Tree

## 题目描述

[problemUrl]: https://atcoder.jp/contests/nikkei2019-qual/tasks/nikkei2019_qual_d

$ N $ 頂点の根付き木 (注記を参照) があり、その頂点には $ 1 $ から $ N $ までの番号が振られています。 根以外の各頂点には、その親から一本の有向辺が伸びています。 なお、根は頂点 $ 1 $ とは限りません。

高橋くんは、このグラフに $ M $ 本の新たな有向辺を書き加えました。 書き足された各辺 $ u\ \rightarrow\ v $ は、ある頂点 $ u $ からその子孫であるような頂点 $ v $ に向かって伸びています。

高橋くんが辺を書き加えたあとの $ N $ 頂点 $ N-1+M $ 辺の有向グラフが与えられます。 より具体的には、$ N-1+M $ 組の整数のペア $ (A_1,\ B_1),\ ...,\ (A_{N-1+M},\ B_{N-1+M}) $ が与えられ、これらは $ i $ 番目の辺が頂点 $ A_i $ から頂点 $ B_i $ に向かって伸びていることを表します。

元の根付き木を復元してください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ M $ $ A_1 $ $ B_1 $ $ : $ $ A_{N-1+M} $ $ B_{N-1+M} $

## 输出格式

$ N $ 行出力せよ。 $ i $ 行目には、頂点 $ i $ が元の木の根であれば `0` を出力し、そうでなければ元の木で頂点 $ i $ の親を表す整数を出力すること。

なお、元の木は一意に定まることが示せる。

## 说明/提示

### 注記

「木」や関連するグラフ理論の用語に関しては、[Wikipediaの記事](https://ja.wikipedia.org/wiki/%E6%9C%A8_(%E6%95%B0%E5%AD%A6))などをご覧ください。

### 制約

- $ 3\ \leq\ N $
- $ 1\ \leq\ M $
- $ N\ +\ M\ \leq\ 10^5 $
- $ 1\ \leq\ A_i,\ B_i\ \leq\ N $
- $ A_i\ \neq\ B_i $
- $ i\ \neq\ j $ ならば $ (A_i,\ B_i)\ \neq\ (A_j,\ B_j) $
- 入力されるグラフは、$ N $ 頂点の根付き木に問題文中の条件を満たす $ M $ 本の辺を書き足すことで得られる。

### Sample Explanation 1

入力されたグラフは次のようなものです。 !\[\](https://img.atcoder.jp/nikkei2019-qual/ee05880ceecf703f656dd50bf22c573f.png) これは、$ 1\ \rightarrow\ 2\ \rightarrow\ 3 $ という根付き木に辺 $ 1\ \rightarrow\ 3 $ を書き足したものであると考えられます。

## 样例 #1

### 输入

```
3 1

1 2

1 3

2 3
```

### 输出

```
0

1

2
```

## 样例 #2

### 输入

```
6 3

2 1

2 3

4 1

4 2

6 1

2 6

4 6

6 5
```

### 输出

```
6

4

2

0

6

2
```



---

---
title: "Broken Skateboard"
layout: "post"
diff: 普及+/提高
pid: AT_s8pc_5_e
tag: []
---

# Broken Skateboard

## 题目描述

编码员 E869120 正在考虑去溜冰场，溜冰场的大小为 $H \times W$ 。左上角单元格为 $(1,1)$ ，右下角单元格为 $(H,W)$ 。  
溜冰场由 $1$ 个球门单元格、一些冰单元格和一些混凝土单元格组成。

溜冰场的特征如下：

- 滑冰者在冰格上移动时方向一致。
- 滑冰者只有在停止时才能改变方向。
- 如果滑冰者滑到了球门单元，他/她就完成了比赛。但是，如果滑冰者来到滑冰场外，则无法完成游戏。

此外，他的滑板坏了，因此移动速度会发生如下变化：

- 移动一个格子需要 $k$ 秒。最初， $k$ 为 $1$ 。
- 如果滑板滑到水泥格上， $k$ 将增加 $1$ 。
- 他只能向 4 个方向移动：上、下、左、右。

他想知道每个起始格完成游戏所需的最短时间。  
请写出代替 E869120 的程序。

## 输入格式

在 $1$ 行中，给出了滑行链路 $H$ $W$ 的大小。  
从 $2$ 行到 $H+1$ 行，给出了滑行链路的状态。每个单元格的状态表示如下：

- `.` 表示该单元是冰单元。
- `#` 表示该单元格为混凝土单元格。
- `G` 表示该单元是目标单元。

## 输出格式

$d_{i,j}$ 表示从 $(i,j)$ 单元格开始计算的最短时间。如果他无法从 $(i,j)$ 单元格到达目标单元格，则 $d_{i,j}$ 的值为 $-1$ 。

## 说明/提示

- $1 \leq H \leq 777$ .
- $1 \leq W \leq 777$ .
- 具体单元的数量不超过 $7 \ 777$ 。
- 目标单元的数量正好是 $1$ 。

## 样例 #1

### 输入

```
6 6

......

.#....

......

......

......

...#.G
```

### 输出

```
-1 -1 -1 9 -1 5

-1 -1 -1 8 -1 4

-1 -1 -1 7 -1 3

-1 -1 -1 6 -1 2

-1 -1 -1 5 -1 1

7 6 5 2 1 0
```

## 样例 #2

### 输入

```
1 8

#####G##
```

### 输出

```
15 10 6 3 1 0 1 3
```

## 样例 #3

### 输入

```
9 9

....#..#.

#........

....#....

.#......#

...###...

##....#.#

....#...#

#....#...

.#.#..#.G
```

### 输出

```
54 37 52 29 38 38 17 53 18

43 36 60 28 37 37 16 65 17

40 35 38 27 26 36 15 39 16

35 22 21 20 19 18 14 16 10

28 27 26 16 16 25 13 36 9

28 17 16 15 14 13 7 9 5

18 17 16 14 8 7 6 5 2

41 22 52 13 15 37 5 51 1

22 14 13 7 6 5 2 1 0
```



---

---
title: "Subsequence"
layout: "post"
diff: 普及+/提高
pid: AT_snuke21_d
tag: []
---

# Subsequence

## 题目描述

[problemUrl]: https://atcoder.jp/contests/snuke21/tasks/snuke21_d





---

---
title: "Medals"
layout: "post"
diff: 普及+/提高
pid: AT_snuke21_g
tag: []
---

# Medals

## 题目描述

[problemUrl]: https://atcoder.jp/contests/snuke21/tasks/snuke21_g





---

---
title: "Ordinary Beauty"
layout: "post"
diff: 普及+/提高
pid: AT_soundhound2018_summer_qual_c
tag: []
---

# Ordinary Beauty

## 题目描述

[problemUrl]: https://atcoder.jp/contests/soundhound2018-summer-qual/tasks/soundhound2018_summer_qual_c

数列 $ (a_1,...\ ,a_n) $ の *美しさ* を、隣り合う $ 2 $ 項の組であって、 差の絶対値が $ d $ であるものの個数として定義します。 例えば、$ d=1 $ であるとき、数列 $ (3,\ 2,\ 3,\ 10,\ 9) $ の美しさは $ 3 $ です。

各要素が $ 1 $ 以上 $ n $ 以下の整数である長さ $ m $ の数列は全部で $ n^m $ 通り存在します。 この $ n^m $ 通りの数列すべてに対して美しさを求めて、 それらの平均を出力してください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ n $ $ m $ $ d $

## 输出格式

各要素が $ 1 $ 以上 $ n $ 以下の整数である長さ $ m $ の数列 の美しさの平均を出力せよ。 絶対誤差または相対誤差が $ 10^{-6} $ 以下ならば正解となる。

## 说明/提示

### 制約

- $ 0\ \leq\ d\ <\ n\ \leq\ 10^9 $
- $ 2\ \leq\ m\ \leq\ 10^9 $
- 入力はすべて整数

### Sample Explanation 1

$ (1,1,1) $ の美しさは $ 0 $ です。 $ (1,1,2) $ の美しさは $ 1 $ です。 $ (1,2,1) $ の美しさは $ 2 $ です。 $ (1,2,2) $ の美しさは $ 1 $ です。 $ (2,1,1) $ の美しさは $ 1 $ です。 $ (2,1,2) $ の美しさは $ 2 $ です。 $ (2,2,1) $ の美しさは $ 1 $ です。 $ (2,2,2) $ の美しさは $ 0 $ です。 これらの平均である、 $ (0+1+2+1+1+2+1+0)/8=1 $ が答えとなります。

## 样例 #1

### 输入

```
2 3 1
```

### 输出

```
1.0000000000
```

## 样例 #2

### 输入

```
1000000000 180707 0
```

### 输出

```
0.0001807060
```



---

---
title: "Saving Snuuk"
layout: "post"
diff: 普及+/提高
pid: AT_soundhound2018_summer_qual_d
tag: []
---

# Saving Snuuk

## 题目描述

[problemUrl]: https://atcoder.jp/contests/soundhound2018-summer-qual/tasks/soundhound2018_summer_qual_d

kenkoooo さんはすぬけ国での旅行の計画を立てています。 すぬけ国には $ n $ 個の都市があり、$ m $ 本の電車が走っています。 都市には $ 1 $ から $ n $ の番号がつけられていて、 $ i $ 番目の電車は都市 $ u_i $ と $ v_i $ の間を両方向に走っています。 どの都市からどの都市へも電車を乗り継ぐことで到達できます。

すぬけ国で使える通貨には、円とスヌークの $ 2 $ 種類があります。 どの電車の運賃も円とスヌークのどちらの通貨でも支払え、 $ i $ 番目の電車の運賃は、 円で支払う場合 $ a_i $ 円、 スヌークで払う場合 $ b_i $ スヌークです。

両替所のある都市に行くと、$ 1 $ 円を $ 1 $ スヌークに両替することができます。 ただし、 両替をするときには持っている円すべてをスヌークに両替しなければなりません。 つまり、kenkoooo さんの所持金が $ X $ 円であるときに両替をすると、 kenkoooo さんの所持金は $ X $ スヌークになります。 現在、両替所は $ n $ 個の都市すべてに存在しますが、 $ i $ 番目の都市の両替所は今年から $ i $ 年後に閉鎖されてしまい、 $ i $ 年後とそれ以降は使うことができません。

kenkoooo さんは $ 10^{15} $ 円を持って都市 $ s $ から旅に出て、 都市 $ t $ へ向かおうと思っています。 移動中、kenkoooo さんは両替所のある都市のいずれかで円をスヌークに両替しようと考えています。 ただし、都市 $ s $ または都市 $ t $ の両替所で両替をしてもよいものとします。

kenkoooo さんは移動の経路と両替をする都市を適切に選ぶことで、できるだけ多くのスヌークを持っている状態で 都市 $ t $ に辿り着きたいと考えています。 $ i=0,...,n-1 $ のそれぞれについて、$ i $ 年後に都市 $ s $ から都市 $ t $ へ移動した際に kenkoooo さんが所持しているスヌークの最大額を求めてください。 ただし、旅行中に年をまたぐことは無いとします。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ n $ $ m $ $ s $ $ t $ $ u_1 $ $ v_1 $ $ a_1 $ $ b_1 $ $ : $ $ u_m $ $ v_m $ $ a_m $ $ b_m $

## 输出格式

$ n $ 行出力せよ。 $ i $ 行目には、 $ i-1 $ 年後に都市 $ s $ から都市 $ t $ へ移動した際に kenkoooo さんの所持しているスヌークの最大額を出力せよ。

## 说明/提示

### 制約

- $ 2\ \leq\ n\ \leq\ 10^5 $
- $ 1\ \leq\ m\ \leq\ 10^5 $
- $ 1\ \leq\ s,t\ \leq\ n $
- $ s\ \neq\ t $
- $ 1\ \leq\ u_i\ <\ v_i\ \leq\ n $
- $ 1\ \leq\ a_i,b_i\ \leq\ 10^9 $
- $ i\neq\ j $ のとき $ u_i\ \neq\ u_j $ または $ v_i\ \neq\ v_j $
- どの都市からどの都市へも電車を乗り継ぐことで到達できる
- 入力はすべて整数

### Sample Explanation 1

$ 0 $ 年後には、都市 $ 1 $ で両替をするのが最適です。 $ 1 $ 年後には、都市 $ 2 $ で両替をするのが最適です。 両替所が閉鎖されても都市 $ 1 $ を訪れることは可能であることに注意してください。 また、都市 $ 2 $ で両替をするときに $ 1 $ 円だけ残して残りをスヌークに両替をすると $ 999999999999998 $ スヌークを持った状態で都市 $ 3 $ にたどり着けますが、 このような両替は許されていないことにも注意してください。 $ 2 $ 年後には、都市 $ 3 $ で両替をするのが最適です。 $ 3 $ 年後には、都市 $ 4 $ で両替をするのが最適です。 同じ電車を複数回使っても良いことに注意してください。

## 样例 #1

### 输入

```
4 3 2 3

1 4 1 100

1 2 1 10

1 3 20 1
```

### 输出

```
999999999999998

999999999999989

999999999999979

999999999999897
```

## 样例 #2

### 输入

```
8 12 3 8

2 8 685087149 857180777

6 7 298270585 209942236

2 4 346080035 234079976

2 5 131857300 22507157

4 8 30723332 173476334

2 6 480845267 448565596

1 4 181424400 548830121

4 5 57429995 195056405

7 8 160277628 479932440

1 6 475692952 203530153

3 5 336869679 160714712

2 7 389775999 199123879
```

### 输出

```
999999574976994

999999574976994

999999574976994

999999574976994

999999574976994

999999574976994

999999574976994

999999574976994
```



---

---
title: "Interval Running"
layout: "post"
diff: 普及+/提高
pid: AT_sumitb2019_f
tag: []
---

# Interval Running

## 题目描述

[problemUrl]: https://atcoder.jp/contests/sumitrust2019/tasks/sumitb2019_f

高橋君と青木君は、西から東に向けて一直線に果てしなく続くランニングコースで長距離走の練習をしています。

彼らは同じ地点から同時にスタートし、**東に向かって**次のように移動します。

- 高橋君は最初の $ T_1 $ 分間、分速 $ A_1 $ メートルで走り、次の $ T_2 $ 分間、分速 $ A_2 $ メートルで走り、これを交互にいつまでも繰り返す。
- 青木君は最初の $ T_1 $ 分間、分速 $ B_1 $ メートルで走り、次の $ T_2 $ 分間、分速 $ B_2 $ メートルで走り、これを交互にいつまでも繰り返す。

さて、高橋君と青木君は何回出会う、すなわち、同じ位置に来るでしょうか？スタート地点にいる時は数えません。無限回出会う場合は、その旨を報告してください。

## 输入格式

入力は以下の形式で標準入力から与えられます。

> $ T_1 $ $ T_2 $ $ A_1 $ $ A_2 $ $ B_1 $ $ B_2 $

## 输出格式

高橋君と青木君が出会う回数を出力してください。  
 ただし、無限回出会う場合は代わりに `infinity` と出力してください。

## 说明/提示

### 制約

- $ 1\ \leq\ T_i\ \leq\ 100000 $
- $ 1\ \leq\ A_i\ \leq\ 10^{10} $
- $ 1\ \leq\ B_i\ \leq\ 10^{10} $
- $ A_1\ \neq\ B_1 $
- $ A_2\ \neq\ B_2 $
- 入力中の値はすべて整数

### Sample Explanation 1

彼らはスタートしてから $ \frac{4}{3} $ 分後に $ 1 $ 回だけ、スタート地点から $ \frac{40}{3} $ メートルの位置で出会います。

### Sample Explanation 2

彼らはスタートしてから $ 101,\ 202,\ 303,\ 404,\ 505,\ 606,\ ... $ 分後に出会うので、無限回出会うことになります。

### Sample Explanation 3

入力中の値は $ 32 $ ビット整数型に収まらないことがあります。

## 样例 #1

### 输入

```
1 2

10 10

12 4
```

### 输出

```
1
```

## 样例 #2

### 输入

```
100 1

101 101

102 1
```

### 输出

```
infinity
```

## 样例 #3

### 输入

```
12000 15700

3390000000 3810000000

5550000000 2130000000
```

### 输出

```
113
```



---

---
title: "サイコロ"
layout: "post"
diff: 普及+/提高
pid: AT_tdpc_dice
tag: []
---

# サイコロ

## 题目描述

[problemUrl]: https://atcoder.jp/contests/tdpc/tasks/tdpc_dice

入力は以下の形式で標準入力から与えられる。

> $ N $ $ D $

 答えを一行に出力せよ。絶対誤差が $ 10^{-6} $ 以下のとき正当と判定される。 ```

2 6
```

```

0.416666667
```

```

3 2
```

```

0.875000000
```

## 说明/提示

### Constraints

 サイコロを $ N $ 回振ったとき、出た目の積が $ D $ の倍数となる確率を求めよ。

- - - - - -

- $ 1\ <\ =\ N\ <\ =\ 100 $
- $ 1\ <\ =\ D\ <\ =\ 10^{18} $



---

---
title: "トーナメント"
layout: "post"
diff: 普及+/提高
pid: AT_tdpc_tournament
tag: []
---

# トーナメント

## 题目描述

[problemUrl]: https://atcoder.jp/contests/tdpc/tasks/tdpc_tournament

入力は以下の形式で標準入力から与えられる。

> $ K $ $ R_1 $ $ … $ $ R_{2^K} $

 答えを $ 2^K $ 行出力せよ。$ i $ 行目は人 $ i $ が優勝する確率であり、絶対誤差が $ 10^{-6} $ 以下のとき正当と判定される。 ```

1
2200
2600
```

```

0.090909091
0.909090909
```

```

3
2000
2500
2300
2700
2100
2400
2600
2200
```

```

0.000086893
0.122042976
0.005522752
0.493464665
0.000651695
0.053982389
0.321828438
0.002420190
```

## 说明/提示

### Constraints

 $ 2^K $ 人が参加するトーナメントがある。このトーナメントでは以下の形式で試合を行う。

- 第 1 ラウンドでは、1 と 2、3 と 4、… が試合を行う。
- 第 2 ラウンドでは、(1 と 2 の勝者) と (3 と 4 の勝者), (5 と 6 の勝者) と (7 と 8 の勝者), … が試合を行う。
- 第 3 ラウンドでは、((1 と 2 の勝者) と (3 と 4 の勝者) の勝者) と ((5 と 6 の勝者) と (7 と 8 の勝者) の勝者), ((9 と 10 の勝者) と (11 と 12 の勝者) の勝者) と ((13 と 14 の勝者) と (15 と 16 の勝者) の勝者), … が試合を行う。
- 以下同様に第 $ K $ ラウンドまで行う。
 
 第 $ K $ ラウンドの終了後に優勝者が決定する。人 $ i $ の Elo Rating が $ R_i $ であるとき、人 $ i $ の優勝確率を求めよ。   
 ただし、Elo Rating $ R_P $ の人 P と Elo Rating $ R_Q $ の人 Q が対戦した場合、人 P が勝つ確率は $ 1\ /\ (1\ +\ 10^{(R_Q\ -\ R_P)\ /\ 400}) $ であり、異なる試合の勝敗は独立であるとする。 - - - - - -

- $ 1\ <\ =\ K\ <\ =\ 10 $
- $ 0\ <\ =\ R_i\ <\ =\ 4000 $



---

---
title: "天下一後入れ先出しデータ構造"
layout: "post"
diff: 普及+/提高
pid: AT_tenka1_2013_qualB_b
tag: []
---

# 天下一後入れ先出しデータ構造

## 题目描述

[problemUrl]: https://atcoder.jp/contests/tenka1-2013-qualb/tasks/tenka1_2013_qualB_b

 スタックは最も基本的なデータ構造の1つであり、データを後入れ先出し (Last In First Out) の構造で保持するものである。スタックは最初は空で、要素の追加と取り出しができるが、取り出しは追加されたのが遅い順に行われる。

 ある日、天下一株式会社に務めるユウヤ君は、スタックになりきるという仕事を言い渡された。唖然とするユウヤ君を心配するあなたは、以下の形式の入力で与えられる命令の列をユウヤ君の代わりに処理して、後述のような出力を行うプログラムを作成することにした。

- - - - - -

 入力は以下の形式で標準入力から与えられる。

> $ Q $ $ L $ $ query_1 $ $ query_2 $ $ ... $ $ query_Q $

- $ 1 $ 行目は、与えられる命令の数 $ Q $ ($ 1\ \leq\ Q\ \leq\ 10^5 $) と スタックのサイズ $ L $ ($ 1\ \leq\ L\ \leq\ 2147483647 $) が空白区切りで与えられる。
- $ 2 $ 行目から $ Q+1 $ 行目までの $ Q $ 行は、$ i $ ($ 1\ \leq\ i\ \leq\ Q $) 番目の 命令が与えられる。

 各命令は、以下 $ 4 $ 種類のうちいずれかに該当する。

1. Push $ N $ $ M $

- スタックに要素 $ M $ を $ N $ 個追加する。出力は行わない。

10. Pop $ N $
- スタックから要素を $ N $ 個取り出す。出力は行わない。

12. Top
- スタックの先頭要素を $ 1 $ 行で出力する。この命令でスタックを構成する要素は変更されない。

14. Size
- スタックの要素数を $ 1 $ 行で出力する。

$ N $, $ M $ はそれぞれ整数で、 $ 1\ \leq\ N\ \leq\ 10^5 $, $ -2^{20}\ \leq\ M\ \leq\ 2^{20} $ をみたす。

ただし、スタックの先頭要素とは、スタックの要素のうちで最後に追加されたものであり、もしそのときPop $ 1 $を行ったとすると取り出される要素である。

- $ Q\ \leq\ 50 $, $ N\ \leq\ 50 $ の入力に正解すると、$ 60 $ 点満点に対して部分点として、$ 30 $ 点が与えられる。

 上記のとおり、与えられた命令を順番に処理していき、Top、またはSizeの入力が与えられた際に出力を行う。

 ただし、以下の $ 3 $ つの場合、スタックは例外を投げて止まってしまう。

- Push $ N $ $ M $ を要素数が $ L-N $ より大きいスタックに対して行った場合
- Pop $ N $を要素数が $ N $ 未満のスタックに対して行った場合
- Top を空のスタックに対して行った場合

 スタックが投げる例外は以下の通りである。

- Push による例外でプログラムが終了した場合は `FULL`
- Pop または Top による例外でプログラムが終了した場合は `EMPTY`

 これらの例外は $ 1 $ 行で出力され、例外を投げた後のスタックはそれ以降の命令を放棄する。  
 スタックは最後まで正常に命令を処理できた場合、 `SAFE` を $ 1 $ 行で出力して終了する。

 ```

7 20
Push 2 3
Push 4 5
Top
Size
Pop 5
Top
Size
```

 ```

5
6
3
1
SAFE
```

 ```

1 10
Push 40 40
```

 ```

FULL
```

 ```

5 10
Push 1 2
Top
Pop 1
Top
Size
```

 ```

2
EMPTY
```

 ```

4 10
Top
Size
Push 1 1
Top
```

 ```

EMPTY
```



---

---
title: "かぶりん！"
layout: "post"
diff: 普及+/提高
pid: AT_tenka1_2014_qualA_b
tag: []
---

# かぶりん！

## 题目描述

“ぶん投げRPG『かぶりん！』”是一款靠投掷包裹的神秘生物かぶりん来击败敌人的动作角色扮演游戏。

国民ダイキ君对かぶりん游戏非常着迷，于是决定写一个程序来计算对敌人造成的伤害。

游戏规则如下：

- 游戏开始时，玩家手中有 $5$ 袋かぶりん。
- 玩家可以投掷手中的かぶりん，造成一定的伤害；投掷后，かぶりん会在一段时间后返回。
- 共有两种投掷方式：「普通投掷」和「蓄力投掷」，每次成功造成伤害后，连击数会增加。

### 普通投掷

- 投掷 $1$ 袋かぶりん。
- 至少需要 $1$ 袋かぶりん。
- 投掷时间 $0.5$ 秒。
- 投掷后 $1$ 秒造成伤害。
- 基础伤害为 $10$，与投掷时的连击数有关。
- 造成伤害后 $5$ 秒かぶりん返回手中。

### 蓄力投掷

- 投掷 $3$ 袋かぶりん。
- 至少需要 $3$ 袋かぶりん。
- 投掷时间 $2.5$ 秒，期间无法进行其他操作。
- 投掷后 $1$ 秒造成伤害。
- 基础伤害为 $50$，与投掷时的连击数有关。
- 造成伤害后 $5$ 秒かぶりん返回手中。

### 连击机制

- 游戏开始时连击数为 $0$。
- 每成功一次投掷攻击，连击数加 $1$。
- 每 $10$ 连击，造成的伤害增加基础伤害的 $10\%$。
- 伤害计算公式为：$A \times (1 + \text{floor}(C / 10) \times 0.1)$，其中 $A$ 是基础伤害，$C$ 是当前连击数。
- 伤害增幅从达成连击后的第一投生效。

### 用户输入

- 每秒钟，用户可以输入一次「普通投掷」、「蓄力投掷」或「无动作」。
- 如果投掷指令时手中没有足够的かぶりん，该指令被忽略。
- 在蓄力期间所有输入被忽略。

根据用户输入，计算对敌人造成的总伤害。注意，包括用户输入结束后，未返回的かぶりん的伤害。

## 输入格式

标准输入包含一行，表示用户输入序列：

> $ S_1\ S_2\ \ldots\ S_n $

- 输入时长为 $n$ 的字符串 ($1 \leq n \leq 1000000$)
- 第 $i$ 个字符 $S_i$ 表示第 $i$ 秒的用户输入
- $S_i$ 可以为：
  - `-` 无动作
  - `N` 普通投掷
  - `C` 蓄力投掷

## 输出格式

输出对敌人造成的总伤害，以一行整数形式给出。需注意，输出需以一个换行结束，确保总伤害不会超过 $10^{11}$。请注意，一般的 32 位整数类型无法存储这么大的数据。

## 说明/提示

### 样例解释 1

尝试进行 $8$ 次普通投掷，其中第 $6$ 和第 $7$ 秒因かぶりん不足未成功，到第 $8$ 秒才因第 $1$ 秒的投掷返还かぶりん，故成功投掷 $6$ 次，造成 $60$ 点伤害。

### 样例解释 2

在第 $1$ 秒开始蓄力投掷，第 $2$ 和第 $3$ 秒的输入因处于蓄力状态被忽略，第 $4$ 和第 $5$ 秒因かぶりん不足而被忽略。

### 样例解释 3

连击导致的伤害增益是在开始投掷前生效的。注意，当连击数达到 $10$ 时，之后的投掷立即享受伤害增益。

 **本翻译由 AI 自动生成**

## 样例 #1

### 输入

```
NNNNNNNN
```

### 输出

```
60
```

## 样例 #2

### 输入

```
CCCCC
```

### 输出

```
50
```

## 样例 #3

### 输入

```
NNC------NNC------NNC------NNC------NNC------NNC
```

### 输出

```
439
```



---

---
title: "グラフィカルグラフ"
layout: "post"
diff: 普及+/提高
pid: AT_tenka1_2016_qualA_d
tag: []
---

# グラフィカルグラフ

## 题目描述

[problemUrl]: https://atcoder.jp/contests/tenka1-2016-quala/tasks/tenka1_2016_qualA_d

*天下一株式会社では、グラフ理論におけるグラフを視覚的に表現するソフトウェアを開発しています。 特に、あまり複雑でないグラフをテキストベースで見やすく表示するツールが人気です。*

$ N $ 頂点の無向木が与えられます。 各頂点には、大文字のアルファベットが重複なく割り振られています（頂点の個数は $ 26 $ 以下です）。

$ N-1 $ 本の辺のうち $ i $ 番目は、頂点 $ v_i $ と頂点 $ w_i $ を結びます。 ただし、任意の頂点について、その頂点に接続する辺の本数が $ 4 $ 以下であることが保証されます。

与えられた木を以下のように視覚的に表示するプログラムを作ってください。 詳細は「出力」セクションに記します。

 ```
8 12
............
...D...E....
...|...|....
.C-A---B---F
.|.....|...|
.|.....G.J-I
.H..........
............
```

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ v_1 $ $ w_1 $ $ v_2 $ $ w_2 $ $ : $ $ v_{N-1} $ $ w_{N-1} $

## 输出格式

入力された木を、以下の形式で $ H+1 $ 行に表示せよ。

> $ H $ $ W $ $ c_{1,1} $$ c_{1,2} $ $ … $ $ c_{1,W} $ $ c_{2,1} $$ c_{2,2} $ $ … $ $ c_{2,W} $ $ : $ $ c_{H,1} $$ c_{H,2} $ $ … $ $ c_{H,W} $

ここで、

- $ H $, $ W $ は以下に続く視覚表示の大きさを表し、半角スペース一つで区切られる。$ 1≦H≦100,\ 1≦W≦100 $ を満たさなければならない。
- 視覚表示は、文字を縦 $ H $ 文字、横 $ W $ 文字の長方形状に並べたものである。
- 視覚表示を構成するそれぞれの文字 $ c_{i,j} $ は、英大文字の最初の $ N $ 文字および `.`、`-`、`|` のいずれかであり、以下を満たす。
  - 木の各頂点は、対応する英大文字で表される。それぞれの頂点は、視覚表示にちょうど一度ずつ現れなければならない。
  - 頂点を表す文字は、別の頂点を表す文字と縦または横に隣接してはならない。
  - 二つの頂点 $ a,\ b $ が一本の辺で直接結ばれるなら、以下の条件 **(A)**, **(B)** のうち一方を満たさなければならない。
      - **(A)** 頂点 $ a,\ b $ を表す二つの文字が視覚表示の同じ行にあり、それらに挟まれた文字はすべて `-` である。
      - **(B)** 頂点 $ a,\ b $ を表す二つの文字が視覚表示の同じ列にあり、それらに挟まれた文字はすべて `|` である。
  - 二つの頂点 $ a,\ b $ が一本の辺で直接結ばれないなら、上記の条件 **(A)**, **(B)** を満たすことはどちらも禁止される。
  - 以上のように頂点や辺を表す文字以外の文字は、すべて `.` でなければならない。

なお、制約を満たす入力に対し、これらの条件を満たす視覚表示が必ず存在することが示せる。そのような視覚表示のうち、どれを出力してもよい。

## 说明/提示

### 制約

- $ 2≦N≦26 $
- $ v_i $, $ w_i $ は、それぞれ英大文字の最初の $ N $ 文字のいずれかである。
- 与えられるグラフは木である。
- 任意の頂点について、その頂点に接続する辺の本数は $ 4 $ 以下である。

### Sample Explanation 1

出力例は問題文中で示した例と同一です。

### Sample Explanation 2

頂点を表す文字が `-` や `|` と縦や横に隣接することは禁止されていません。

## 样例 #1

### 输入

```
10

A B

A C

A D

B E

B F

B G

C H

F I

I J
```

### 输出

```
8 12

............

...D...E....

...|...|....

.C-A---B---F

.|.....|...|

.|.....G.J-I

.H..........

............
```

## 样例 #2

### 输入

```
7

A B

B C

C D

D E

E F

F G
```

### 输出

```
5 4

.A-B

E-F|

|.||

|.G|

D--C
```



---

---
title: "無限グラフ"
layout: "post"
diff: 普及+/提高
pid: AT_tenka1_2016_qualA_e
tag: []
---

# 無限グラフ

## 题目描述

[problemUrl]: https://atcoder.jp/contests/tenka1-2016-quala/tasks/tenka1_2016_qualA_e

*天下一研究所は、組合せ数学の研究拠点として様々な活動を行っています。 最近は、無限個の頂点を持つグラフに関する研究が盛んなようです。*

正の整数 $ N $ と、$ 0 $ 以上 $ N-1 $ 以下の整数のペア $ M $ 組 $ (A_1,\ B_1),\ (A_2,\ B_2),\ …,\ (A_M,\ B_M) $ が与えられます。

次のような、無限個の頂点を持つ無向グラフを考えます。

- 任意の整数 $ z $ に対し（負の整数も考える）、それに対応する頂点がただ一つ存在する。整数 $ z $ に対応する頂点を頂点 $ z $ と呼ぶ。どの整数にも対応しない頂点は存在しない。
- 任意の二つの整数 $ i,\ k\ (1\ ≦\ i\ ≦\ M) $ に対し、頂点 $ A_i\ +\ k\ ×\ N $ と頂点 $ B_i\ +\ (k\ +\ 1)\ ×\ N $ は一本の辺で直接結ばれる。それらの辺以外に辺は存在しない。

（入力例・出力例のセクションの画像を参考にしてください）

このグラフの連結成分の個数が有限かどうかを判定し、有限ならその個数を求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ M $ $ A_1 $ $ B_1 $ $ A_2 $ $ B_2 $ $ : $ $ A_M $ $ B_M $

## 输出格式

与えられたグラフの連結成分の個数が有限なら、その個数を出力せよ。無限なら、代わりに $ -1 $ と出力せよ。

## 说明/提示

### 制約

- $ 1\ ≦\ N\ ≦\ 10^5 $
- $ 1\ ≦\ M\ ≦\ 10^5 $
- $ 0\ ≦\ A_i,\ B_i\ ≦\ N-1 $
- すべての組 $ (A_i,\ B_i) $ は異なる。

### 部分点

- $ 400 $ 点分のデータセットは以下を満たす。
  - $ 1\ ≦\ N\ ≦\ 1000 $
  - $ 1\ ≦\ M\ ≦\ 1000 $

### Sample Explanation 1

!\[E1.png\](https://tenka1-2016-quala.contest.atcoder.jp/img/other/tenka1\_2016\_quala/bagnyahay/E1.png) 辺をたどって、任意の二頂点間を行き来できます。したがって、このグラフの連結成分の個数は $ 1 $ です。

### Sample Explanation 2

!\[E2.png\](https://tenka1-2016-quala.contest.atcoder.jp/img/other/tenka1\_2016\_quala/bagnyahay/E2.png) 無限の長さを持つ直線状の連結成分が $ 2 $ 個あります。

### Sample Explanation 3

!\[E3.png\](https://tenka1-2016-quala.contest.atcoder.jp/img/other/tenka1\_2016\_quala/bagnyahay/E3.png) $ 3 $ 頂点からなる連結成分が無限個あります。

## 样例 #1

### 输入

```
2 2

0 0

1 0
```

### 输出

```
1
```

## 样例 #2

### 输入

```
2 2

0 1

1 0
```

### 输出

```
2
```

## 样例 #3

### 输入

```
3 2

0 1

2 1
```

### 输出

```
-1
```

## 样例 #4

### 输入

```
7 8

0 3

1 2

1 5

2 5

3 4

4 6

5 2

6 3
```

### 输出

```
4
```



---

---
title: "IntegerotS"
layout: "post"
diff: 普及+/提高
pid: AT_tenka1_2017_d
tag: []
---

# IntegerotS

## 题目描述

[problemUrl]: https://atcoder.jp/contests/tenka1-2017/tasks/tenka1_2017_d

非負整数専門店「せいすうや」には、$ N $ 個の非負整数が売られています。$ i $ 個目の非負整数は $ A_i $ で、その価値は $ B_i $ です。 価値の異なる同じ非負整数が複数売られていることもあります。

高橋君は、「せいすうや」でいくつかの整数を買うことにしました。高橋君は、買う整数たちの bitwise or が $ K $ 以下になるような 任意の組み合わせで、整数を買うことができます。高橋君は、買った整数たちの価値の総和をできるだけ大きくしたいです。

高橋君が達成できる、価値の総和の最大値を求めてください。ただし、bitwise or とは、ビットごとの論理和を表します。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ K $ $ A_1 $ $ B_1 $ : $ A_N $ $ B_N $

## 输出格式

高橋君が達成できる価値の総和の最大値を出力せよ。

## 说明/提示

### 制約

- $ 1\ \leq\ N\ \leq\ 10^5 $
- $ 0\ \leq\ K\ <\ 2^{30} $
- $ 0\ \leq\ A_i\ <\ 2^{30}(1\leq\ i\leq\ N) $
- $ 1\ \leq\ B_i\ \leq\ 10^9(1\leq\ i\leq\ N) $
- 入力は全て整数である

### Sample Explanation 1

$ 2 $ と $ 3 $ を購入することで、最大値 $ 8 $ を達成できます。

### Sample Explanation 2

$ 2 $ と $ 4 $ を購入することで、最大値 $ 9 $ を達成できます。

## 样例 #1

### 输入

```
3 5

3 3

4 4

2 5
```

### 输出

```
8
```

## 样例 #2

### 输入

```
3 6

3 3

4 4

2 5
```

### 输出

```
9
```

## 样例 #3

### 输入

```
7 14

10 5

7 4

11 4

9 8

3 6

6 2

8 9
```

### 输出

```
32
```



---

---
title: "Crossing"
layout: "post"
diff: 普及+/提高
pid: AT_tenka1_2018_d
tag: []
---

# Crossing

## 题目描述

[problemUrl]: https://atcoder.jp/contests/tenka1-2018/tasks/tenka1_2018_d

整数 $ N $ が与えられます。$ \{1,2,...N\} $ の部分集合の組 $ (S_1,S_2,...,S_k) $ であって、以下の条件を満たすものが存在するか判定し、 存在する場合はひとつ構成してください。

- $ 1,2,...,N $ のうちどの整数も、$ S_1,S_2,...,S_k $ のうちちょうど $ 2 $ つに含まれる
- $ S_1,S_2,...,S_k $ のうちどの $ 2 $ つの集合をとっても、それらに共通して含まれる要素はちょうど $ 1 $ つである

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $

## 输出格式

条件を満たす部分集合の組が存在しない場合、`No` を出力せよ。 存在する場合、まず `Yes` を出力し、次いで以下の形式で部分集合の情報を出力せよ。 ただし、$ S_i=\{S_{i,1},S_{i,2},...,S_{i,|S_i|}\} $ とする。

条件を満たすものが複数ある場合、どれを出力しても構わない。

> $ k $ $ |S_1| $ $ S_{1,1} $ $ S_{1,2} $ $ ... $ $ S_{1,|S_1|} $ $ : $ $ |S_k| $ $ S_{k,1} $ $ S_{k,2} $ $ ... $ $ S_{k,|S_k|} $

## 说明/提示

### 制約

- $ 1\ \leq\ N\ \leq\ 10^5 $
- $ N $ は整数である

### Sample Explanation 1

$ (S_1,S_2,S_3)=(\{1,2\},\{3,1\},\{2,3\}) $ とすれば、条件を満たすことが確認できます。

## 样例 #1

### 输入

```
3
```

### 输出

```
Yes

3

2 1 2

2 3 1

2 2 3
```

## 样例 #2

### 输入

```
4
```

### 输出

```
No
```



---

---
title: "Area Sum"
layout: "post"
diff: 普及+/提高
pid: AT_toyota2023spring_final_a
tag: []
---

# Area Sum

## 题目描述

[problemUrl]: https://atcoder.jp/contests/toyota2023spring-final/tasks/toyota2023spring_final_a

$ N $ 行 $ M $ 列からなる盤面があり，各マス目には row-major 順に $ 1 $ から $ N\ \times\ M $ までの整数が書かれています． つまり，上から $ i $ 行目，左から $ j $ 列目のマスに書かれている整数を $ A_{i,j} $ で表すことにすると， $ A_{i,j}=(i-1)\ \times\ M\ +\ j $ です．

この盤面の部分長方形であって，その内部に書かれた値の総和がちょうど $ V $ になるものの個数を数えてください．

より厳密に言えば，整数の $ 4 $ つ組 $ (a,b,c,d) $ ($ 1\ \leq\ a\ \leq\ b\ \leq\ N $, $ 1\ \leq\ c\ \leq\ d\ \leq\ M $) であって，$ \sum_{a\ \leq\ i\ \leq\ b,\ c\ \leq\ j\ \leq\ d}\ A_{i,j}=V $ を満たすものの個数を数えてください．

## 输入格式

入力は以下の形式で標準入力から与えられる．

> $ N $ $ M $ $ V $

## 输出格式

答えを出力せよ．

## 说明/提示

### 制約

- $ 1\ \leq\ N,\ M\ \leq\ 5000 $
- $ 1\ \leq\ V\ \leq\ 10^{15} $
- 入力される値はすべて整数である

### Sample Explanation 1

盤面には以下のように整数が書き込まれています． ``` 12 34 ``` 条件を満たす部分長方形は，$ (a,b,c,d)=(1,1,1,2),(2,2,1,1) $ の $ 2 $ つです．

## 样例 #1

### 输入

```
2 2 3
```

### 输出

```
2
```

## 样例 #2

### 输入

```
2 2 5
```

### 输出

```
0
```

## 样例 #3

### 输入

```
13 8 1032
```

### 输出

```
5
```



---

---
title: "[[iwi]]"
layout: "post"
diff: 普及+/提高
pid: AT_utpc2011_3
tag: []
---

# [[iwi]]

## 题目描述

[problemUrl]: https://atcoder.jp/contests/utpc2011/tasks/utpc2011_3





---

---
title: "直径"
layout: "post"
diff: 普及+/提高
pid: AT_utpc2013_03
tag: []
---

# 直径

## 题目描述

### 题目背景
鳗鱼王国有一个名为鱼鳗王国的邻国。这两个王国都有许多的大城市，这些城市之间有一些道路相连。然而现在，鳗鱼王国和鱼鳗王国之间没有互通的道路。所以，鳗鱼王国的国王殿下为了和鱼鳗王国构筑友好关系，打算在两个城市间建设一条道路，因为有很多条可以建设的道路，对运费很敏感的国王殿下想知道两两城市间最短距离的最大值。
给出顶点数 $n_1$，边数 $m_1$ 的无向图 $G_1$ 和顶点数 $n_2$，边数 $m_2$ 的无向图 $G_2$。每个图都是连通图。换句话说，对于每张图来说，任意的两个顶点间都有直接或间接的道路连接。请回答出在两张图之间任加一条边后构成的图形中，最远的两个顶点的距离（称为图形的直径）的最小值和最大值。

## 输入格式

输入按以下形式给出：
> $n_1$ $m_1$ $a_1$ $b_1$ $a_2$ $b_2$ $\cdots$ $a_{m_1}$ $b_{m_1}$ $n_2$ $m_2$ $c_1$ $d_1$ $c_2$ $d_2$ $\cdots$ $c_{m_2}$ $d_{m_2}$

第一行给出图 $G_1$ 的顶点数 $n_1$ 和边数 $m_1$。接下来的 $m_1$ 行为边的情况。$a_i,b_i$ 表示 $G_1$ 图中有一条以 $a_i,b_i$ 为顶点的边。接下来一行为图 $G_2$ 的顶点数 $n_2$ 和边数 $m_2$。接下来的 $m_2$ 行为边的情况。$c_i,d_i$ 表示 $G_2$ 图中有一条以 $c_i,d_i$ 为顶点的边。

## 输出格式

将在两个图间加一条边得到的图的直径最小值与最大值以空格分开输出。

## 说明/提示

输入中的各变量满足以下条件。
- $1 \leq n_{1},n_{2} \leq 1000(=10^4)$
- $0 \leq m_{1},m_{2} \leq 10000(=10^5)$
- $0 \leq a_i,b_i<n_1$
- $0\leq c_i,d_i<n_2$
- 每张图为连通图
- 每张图为简单图，也就是说没有重边与自环。

对于 $50\%$ 的数据，$1\leq n_1,n_2\leq20$。

#### 样例解释
【样例解释 1】

直径为 $3$ 及直径为 $5$ 的情况见下图：

![样例解释1](https://img.atcoder.jp/other/utpc2013/C_sample_1.png)

【样例解释 2】

直径为 $7$ 及直径为 $11$ 的情况见下图：

![样例解释2](https://img.atcoder.jp/other/utpc2013/C_sample_2.png)

【样例解释 3】

请注意此处的最小值。

## 样例 #1

### 输入

```
4 5
0 1
0 2
0 3
1 2
2 3
4 5
0 1
0 2
0 3
1 2
2 3

```

### 输出

```
3 5

```

## 样例 #2

### 输入

```
6 5
0 1
1 2
2 3
3 4
4 5
6 5
0 1
1 2
2 3
3 4
4 5

```

### 输出

```
7 11

```

## 样例 #3

### 输入

```
7 6
0 1
1 2
2 3
3 4
4 5
5 6
2 1
0 1

```

### 输出

```
6 8

```



---

---
title: "5キューブ"
layout: "post"
diff: 普及+/提高
pid: AT_wupc_04
tag: []
---

# 5キューブ

## 题目描述

[problemUrl]: https://atcoder.jp/contests/wupc2nd/tasks/wupc_04

 5キューブは立方体を使ったパズルである．今回はこれをコンピュータを用いて自動で解くことを考えよう． 一辺の長さが $ 5 $ である立方体状のコンテナがある．また，それ以下の整数の大きさを持つ立方体のオブジェがたくさんある．パズルのゴールは，これらのオブジェをコンテナからはみ出さないように敷き詰めることである．オブジェはたくさんあるので，コンテナの数は $ 1 $ つでは足りないかもしれないが，使うコンテナの数が少なければ少ないほど高得点が得られる．  
  
 それぞれの大きさのオブジェの数が与えられるので，使うべきコンテナの数の最小値を答えよ． 入力は以下の形式で標準入力から与えられる．

> $ N_{1}　N_{2}　N_{3}　N_{4}　N_{5} $

- $ 1 $ 行目には，一辺の長さが $ x $ であるオブジェの数 $ N_{x} $($ 1\ ≦\ x\ ≦\ 5 $, $ 0\ ≦\ N_{x}\ ≦\ 1,000,000,000 $) が半角スペース区切りで与えられる．
- $ ∃x\ ::\ N_{x}\ ≧\ 1 $ を仮定してよい．すなわち，オブジェは必ず $ 1 $ つ以上与えられる．
 
 必要なコンテナの数を $ 1 $ 行に出力せよ．  
 なお、最後には改行を出力せよ． ```
<pre class="prettyprint linenums">
109 2 0 0 1
```

 ```
<pre class="prettyprint linenums">
2
```

 ```
<pre class="prettyprint linenums">
0 0 0 5 0
```

 ```
<pre class="prettyprint linenums">
5
```

 ```
<pre class="prettyprint linenums">
1000000000 1000000000 1000000000 1000000000 1000000000
```

 ```
<pre class="prettyprint linenums">
3000000000
```



---

---
title: "潜入"
layout: "post"
diff: 普及+/提高
pid: AT_zone2021_e
tag: []
---

# 潜入

## 题目描述

[problemUrl]: https://atcoder.jp/contests/zone2021/tasks/zone2021_e

$ 2 $ 次元平面があり、あなたは今いる座標 $ (1,\ 1) $ から UFO のある座標 $ (R,\ C) $ に移動したいです。  
 あなたが $ (r,\ c) $ にいるとき、あなたは以下の $ 4 $ 種類の移動を行うことができます。

- $ (r,\ c) $ から $ (r,\ c\ +\ 1) $ に移動する。$ A_{r,\ c} $ のコストがかかる。この移動は $ c\ <\ C $ のとき使える。
- $ (r,\ c) $ から $ (r,\ c\ -\ 1) $ に移動する。$ A_{r,\ c\ -\ 1} $ のコストがかかる。この移動は $ c\ >\ 1 $ のとき使える。
- $ (r,\ c) $ から $ (r\ +\ 1,\ c) $ に移動する。$ B_{r,\ c} $ のコストがかかる。この移動は $ r\ <\ R $ のとき使える。
- $ 1\ <\ =\ i\ <\ r $ を満たす整数 $ i $ を $ 1 $ つ選び、$ (r,\ c) $ から $ (r\ -\ i,\ c) $ に移動する。$ 1\ +\ i $ のコストがかかる。

$ (1,\ 1) $ から $ (R,\ C) $ に移動するために必要な最小のコストを求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ R $ $ C $ $ A_{1,1} $ $ \cdots $ $ A_{1,C-1} $ $ \vdots $ $ A_{R,1} $ $ \cdots $ $ A_{R,C-1} $ $ B_{1,1} $ $ \cdots $ $ B_{1,C} $ $ \vdots $ $ B_{R-1,1} $ $ \cdots $ $ B_{R-1,C} $

## 输出格式

答えを出力せよ。

## 说明/提示

### ストーリー

暗号解読を進めていると、仲間のムーアが突如 UFO に吸い込まれ、連れ去られてしまった。 ムーアは UFO との通信システムをほぼ 1 人で開発していたため、このままでは UFO と交信することができない！  
 デスマーチが横行していたブラックスタートアップ時代を思い出す。 バス係数$ {}\ =\ 1 $ のチームはいつだって脆いものだ。  
 仕方がない、UFO 内に乗り込んで直接話すしかなさそうだ。 上空を見上げると、UFO から梯子のようなものが下されている。  
 だがよく見るとボロボロで所々腐り落ちているようだ。 どうにかしてうまい登り方を考えなければ。

### 制約

- 入力は全て整数
- $ 2\ <\ =\ R,\ C\ <\ =\ 500 $
- $ 0\ <\ =\ A_{i,j}\ <\ 10^3 $
- $ 0\ <\ =\ B_{i,j}\ <\ 10^3 $

### Sample Explanation 1

以下のように移動するとコスト $ 9 $ が達成できます。 - $ (1,\ 1) $ から $ (2,\ 1) $ に移動する。コストが $ 1 $ かかる。 - $ (2,\ 1) $ から $ (3,\ 1) $ に移動する。コストが $ 1 $ かかる。 - $ (3,\ 1) $ から $ (3,\ 2) $ に移動する。コストが $ 1 $ かかる。 - $ (3,\ 2) $ から $ (1,\ 2) $ に移動する。コストが $ 3 $ かかる。 - $ (1,\ 2) $ から $ (1,\ 3) $ に移動する。コストが $ 1 $ かかる。 - $ (1,\ 3) $ から $ (2,\ 3) $ に移動する。コストが $ 1 $ かかる。 - $ (2,\ 3) $ から $ (3,\ 3) $ に移動する。コストが $ 1 $ かかる。

## 样例 #1

### 输入

```
3 3

10 1

10 10

1 10

1 10 1

1 10 1
```

### 输出

```
9
```

## 样例 #2

### 输入

```
7 11

42 77 94 76 40 66 43 28 66 23

27 34 41 31 83 13 64 69 81 82

23 81 0 22 39 51 4 37 84 43

62 37 82 86 26 67 45 78 85 2

79 18 72 62 68 84 69 88 19 48

0 27 21 51 71 13 87 45 39 11

74 57 32 0 97 41 87 96 17 98

69 58 76 32 51 16 38 68 86 82 64

53 47 33 7 51 75 43 14 96 86 70

80 58 12 76 94 50 59 2 1 54 25

14 14 62 28 12 43 15 70 65 44 41

56 50 50 54 53 34 16 3 2 59 88

27 85 50 79 48 86 27 81 78 78 64
```

### 输出

```
498
```

## 样例 #3

### 输入

```
4 4

0 0 0

0 0 0

0 0 0

0 0 0

0 0 0 0

0 0 0 0

0 0 0 0
```

### 输出

```
0
```



---



---

# 无标签题目列表

- AT_abc002_4 - [ABC002D] 派閥
- AT_abc005_4 - [ABC005D] おいしいたこ焼きの焼き方
- AT_abc008_3 - [ABC008C] コイン
- AT_abc011_4 - [ABC011D] 大ジャンプ
- AT_abc013_3 - [ABC013C] 節制
- AT_abc013_4 - [ABC013D] 阿弥陀
- AT_abc014_4 - [ABC014D] 閉路
- AT_abc015_4 - [ABC015D] 高橋くんの苦悩
- AT_abc017_3 - [ABC017C] ハイスコア
- AT_abc018_3 - [ABC018C] 菱型カウント
- AT_abc018_4 - [ABC018D] バレンタインデー
- AT_abc020_c - [ABC020C] 壁抜け
- AT_abc021_d - [ABC021D] 多重ループ
- AT_abc022_c - [ABC022C] Blue Bird
- AT_abc022_d - [ABC022D] Big Bang
- AT_abc023_c - [ABC023C] 収集王
- AT_abc023_d - [ABC023D] 射撃王
- AT_abc025_c - [ABC025C] 双子と○×ゲーム
- AT_abc026_d - [ABC026D] 高橋君ボール1号
- AT_abc027_c - [ABC027C] 倍々ゲーム
- AT_abc030_d - [ABC030D] へんてこ辞書
- AT_abc031_d - [ABC031D] 語呂合わせ
- AT_abc032_c - [ABC032C] 列
- AT_abc032_d - [ABC032D] ナップサック問題
- AT_abc034_d - [ABC034D] 食塩水
- AT_abc035_d - [ABC035D] トレジャーハント
- AT_abc036_d - [ABC036D] 塗り絵
- AT_abc037_d - [ABC037D] 経路
- AT_abc040_d - [ABC040D] 道路の老朽化対策について
- AT_abc041_d - [ABC041D] 徒競走
- AT_abc051_d - [ABC051D] Candidates of No Shortest Paths
- AT_abc070_d - [ABC070D] Transit Tree Path
- AT_abc073_d - [ABC073D] joisino&#39;s travel
- AT_abc075_d - [ABC075D] Axis-Parallel Rectangle
- AT_abc099_d - [ABC099D] Good Grid
- AT_abc100_d - [ABC100D] Patisserie ABC
- AT_abc104_c - [ABC104C] All Green
- AT_abc104_d - [ABC104D] We Love ABC
- AT_abc106_d - [ABC106D] AtCoder Express 2
- AT_abc110_d - [ABC110D] Factorization
- AT_abc113_d - [ABC113D] Number of Amidakuji
- AT_abc114_d - [ABC114D] 756
- AT_abc116_d - [ABC116D] Various Sushi
- AT_abc117_d - [ABC117D] XXOR
- AT_abc119_d - [ABC119D] Lazy Faith
- AT_abc122_d - [ABC122D] We Like AGC
- AT_abc123_d - [ABC123D] Cake 123
- AT_abc127_f - [ABC127F] Absolute Minima
- AT_abc128_d - [ABC128D] equeue
- AT_abc128_e - [ABC128E] Roadwork
- AT_abc129_e - [ABC129E] Sum Equals Xor
- AT_abc130_e - [ABC130E] Common Subsequence
- AT_abc131_e - [ABC131E] Friendships
- AT_abc132_d - [ABC132D] Blue and Red Balls
- AT_abc132_e - [ABC132E] Hopscotch Addict
- AT_abc133_e - [ABC133E] Virus Tree 2
- AT_abc136_e - [ABC136E] Max GCD
- AT_abc137_d - [ABC137D] Summer Vacation
- AT_abc137_e - [ABC137E] Coins Respawn
- AT_abc138_e - [ABC138E] Strings of Impurity
- AT_abc139_e - [ABC139E] League
- AT_abc140_e - [ABC140E] Second Sum
- AT_abc141_e - [ABC141E] Who Says a Pun?
- AT_abc142_e - [ABC142E] Get Everything
- AT_abc142_f - [ABC142F] Pure
- AT_abc143_e - [ABC143E] Travel by Car
- AT_abc145_e - [ABC145E] All-you-can-eat
- AT_abc146_e - [ABC146E] Rem of Sum is Num
- AT_abc146_f - [ABC146F] Sugoroku
- AT_abc148_f - [ABC148F] Playing Tag on Tree
- AT_abc149_e - [ABC149E] Handshake
- AT_abc150_d - [ABC150D] Semi Common Multiple
- AT_abc152_e - [ABC152E] Flatten
- AT_abc155_d - [ABC155D] Pairs
- AT_abc155_e - [ABC155E] Payment
- AT_abc157_e - [ABC157E] Simple String Queries
- AT_abc159_f - [ABC159F] Knapsack for All Segments
- AT_abc162_e - [ABC162E] Sum of gcd of Tuples (Hard)
- AT_abc165_e - [ABC165E] Rotation Matching
- AT_abc166_f - [ABC166F] Three Variables Game
- AT_abc167_e - [ABC167E] Colorful Blocks
- AT_abc168_e - [ABC168E] ∙ (Bullet)
- AT_abc169_e - [ABC169E] Count Median
- AT_abc169_f - [ABC169F] Knapsack for All Subsets
- AT_abc170_e - [ABC170E] Smart Infants
- AT_abc171_f - [ABC171F] Strivore
- AT_abc172_e - [ABC172E] NEQ
- AT_abc173_e - [ABC173E] Multiplication 4
- AT_abc173_f - [ABC173F] Intervals on Tree
- AT_abc175_d - [ABC175D] Moving Piece
- AT_abc175_e - [ABC175E] Picking Goods
- AT_abc178_f - [ABC178F] Contrast
- AT_abc179_f - [ABC179F] Simplified Reversi
- AT_abc183_f - [ABC183F] Confluence
- AT_abc184_e - [ABC184E] Third Avenue
- AT_abc184_f - [ABC184F] Programming Contest
- AT_abc185_e - [ABC185E] Sequence Matching
- AT_abc186_e - [ABC186E] Throne
- AT_abc186_f - [ABC186F] Rook on Grid
- AT_abc187_e - [ABC187E] Through Path
- AT_abc188_f - [ABC188F] +1-1x2
- AT_abc189_e - [ABC189E] Rotate and Flip
- AT_abc190_e - [ABC190E] Magical Ornament
- AT_abc190_f - [ABC190F] Shift and Inversions
- AT_abc191_e - [ABC191E] Come Back Quickly
- AT_abc192_d - [ABC192D] Base n
- AT_abc192_f - [ABC192F] Potion
- AT_abc195_e - [ABC195E] Lucky 7 Battle
- AT_abc196_e - [ABC196E] Filters
- AT_abc197_e - [ABC197E] Traveler
- AT_abc199_d - [ABC199D] RGB Coloring 2
- AT_abc199_e - [ABC199E] Permutation
- AT_abc201_d - [ABC201D] Game in Momotetsu World
- AT_abc201_e - [ABC201E] Xor Distances
- AT_abc202_e - [ABC202E] Count Descendants
- AT_abc203_d - [ABC203D] Pond
- AT_abc203_e - [ABC203E] White Pawn
- AT_abc204_e - [ABC204E] Rush Hour 2
- AT_abc206_e - [ABC206E] Divide Both
- AT_abc207_e - [ABC207E] Mod i
- AT_abc208_d - [ABC208D] Shortest Path Queries 2
- AT_abc210_d - [ABC210D] National Railway
- AT_abc210_e - [ABC210E] Ring MST
- AT_abc211_e - [ABC211E] Red Polyomino
- AT_abc212_e - [ABC212E] Safety Journey
- AT_abc213_e - [ABC213E] Stronger Takahashi
- AT_abc214_d - [ABC214D] Sum of Maximum Weights
- AT_abc214_e - [ABC214E] Packing Under Range Regulations
- AT_abc214_f - [ABC214F] Substrings
- AT_abc215_e - [ABC215E] Chain Contestant
- AT_abc215_f - [ABC215F] Dist Max 2
- AT_abc216_f - [ABC216F] Max Sum Counting
- AT_abc216_g - [ABC216G] 01Sequence
- AT_abc218_f - [ABC218F] Blocked Roads
- AT_abc219_e - [ABC219E] Moat
- AT_abc220_e - [ABC220E] Distance on Large Perfect Binary Tree
- AT_abc220_f - [ABC220F] Distance Sums 2
- AT_abc221_e - [ABC221E] LEQ
- AT_abc222_e - [ABC222E] Red and Blue Tree
- AT_abc223_e - [ABC223E] Placing Rectangles
- AT_abc223_f - [ABC223F] Parenthesis Checking
- AT_abc224_d - [ABC224D] 8 Puzzle on Graph
- AT_abc224_e - [ABC224E] Integers on Grid
- AT_abc224_f - [ABC224F] Problem where +s Separate Digits
- AT_abc225_e - [ABC225E] フ
- AT_abc226_e - [ABC226E] Just one
- AT_abc227_d - [ABC227D] Project Planning
- AT_abc228_e - [ABC228E] Integer Sequence Fair
- AT_abc231_e - [ABC231E] Minimal payments
- AT_abc231_f - [ABC231F] Jealous Two
- AT_abc232_e - [ABC232E] Rook Path
- AT_abc232_f - [ABC232F] Simple Operations on Sequence
- AT_abc234_f - [ABC234F] Reordering
- AT_abc235_e - [ABC235E] MST + 1
- AT_abc236_e - [ABC236E] Average and Median
- AT_abc237_f - [ABC237F] |LIS| = 3
- AT_abc238_e - [ABC238E] Range Sums
- AT_abc240_f - [ABC240F] Sum Sum Max
- AT_abc241_f - [ABC241F] Skate
- AT_abc242_e - [ABC242E] (∀x∀)
- AT_abc243_e - [ABC243E] Edge Deletion
- AT_abc244_f - [ABC244F] Shortest Good Path
- AT_abc245_e - [ABC245E] Wrapping Chocolate
- AT_abc245_f - [ABC245F] Endless Walk
- AT_abc246_e - [ABC246E] Bishop 2
- AT_abc246_f - [ABC246F] typewriter
- AT_abc249_f - [ABC249F] Ignore Operations
- AT_abc251_d - [ABC251D] At Most 3 (Contestant ver.)
- AT_abc259_e - [ABC259E] LCM on Whiteboard
- AT_abc260_e - [ABC260E] At Least One
- AT_abc261_e - [ABC261E] Many Operations
- AT_abc261_f - [ABC261F] Sorting Color Balls
- AT_abc262_e - [ABC262E] Red and Blue Graph
- AT_abc263_e - [ABC263E] Sugoroku 3
- AT_abc264_e - [ABC264E] Blackout 2
- AT_abc266_f - [ABC266F] Well-defined Path Queries on a Namori
- AT_abc267_e - [ABC267E] Erasing Vertices 2
- AT_abc268_d - [ABC268D] Unique Username
- AT_abc268_f - [ABC268F] Best Concatenation
- AT_abc269_f - [ABC269F] Numbered Checker
- AT_abc270_d - [ABC270D] Stones
- AT_abc270_f - [ABC270F] Transportation
- AT_abc271_e - [ABC271E] Subsequence Path
- AT_abc272_e - [ABC272E] Add and Mex
- AT_abc273_e - [ABC273E] Notebook
- AT_abc274_e - [ABC274E] Booster
- AT_abc275_f - [ABC275F] Erase Subarrays
- AT_abc276_f - [ABC276F] Double Chance
- AT_abc277_e - [ABC277E] Crystal Switches
- AT_abc278_f - [ABC278F] Shiritori
- AT_abc279_e - [ABC279E] Cheating Amidakuji
- AT_abc279_f - [ABC279F] BOX
- AT_abc280_f - [ABC280F] Pay or Receive
- AT_abc281_e - [ABC281E] Least Elements
- AT_abc285_e - [ABC285E] Work or Rest
- AT_abc287_h - [ABC287Ex] Directed Graph and Query
- AT_abc288_d - [ABC288D] Range Add Query
- AT_abc288_f - [ABC288F] Integer Division
- AT_abc290_e - [ABC290E] Make it Palindrome
- AT_abc291_f - [ABC291F] Teleporter and Closed off
- AT_abc292_f - [ABC292F] Regular Triangle Inside a Rectangle
- AT_abc293_e - [ABC293E] Geometric Progression
- AT_abc294_f - [ABC294F] Sugar Water 2
- AT_abc294_g - [ABC294G] Distance Queries on a Tree
- AT_abc296_f - [ABC296F] Simultaneous Swap
- AT_abc297_g - [ABC297G] Constrained Nim 2
- AT_abc298_e - [ABC298E] Unfair Sugoroku
- AT_abc298_f - [ABC298F] Rook Score
- AT_abc300_e - [ABC300E] Dice Product 3
- AT_abc300_f - [ABC300F] More Holidays
- AT_abc302_f - [ABC302F] Merge Set
- AT_abc302_g - [ABC302G] Sort from 1 to 4
- AT_abc305_f - [ABC305F] Dungeon Explore
- AT_abc306_f - [ABC306F] Merge Sets
- AT_abc309_f - [ABC309F] Box in Box
- AT_abc310_d - [ABC310D] Peaceful Teams
- AT_abc310_e - [ABC310E] NAND repeatedly
- AT_abc322_d - [ABC322D] Polyomino
- AT_abc322_e - [ABC322E] Product Development
- AT_abc322_f - [ABC322F] Vacation Query
- AT_abc324_f - [ABC324F] Beautiful Path
- AT_abc326_e - [ABC326E] Revenge of "The Salary of AtCoder Inc."
- AT_abc330_f - [ABC330F] Minimize Bounding  Square
- AT_abc335_e - [ABC335E] Non-Decreasing Colorful Path
- AT_abc387_c - [ABC387C] Snake Numbers
- AT_abc390_d - [ABC390D] Stone XOR
- AT_abc390_f - [ABC390F] Double Sum 3
- AT_abl_d - Flat Subsequence
- AT_abl_e - Replace Digits
- AT_acl1_a - Reachable Towns
- AT_agc003_c - [AGC003C] BBuBBBlesort!
- AT_agc004_b - [AGC004B] Colorful Slimes
- AT_agc012_b - [AGC012B] Splatter Painting
- AT_agc014_c - [AGC014C] Closed Rooms
- AT_agc016_c - [AGC016C] +/- Rectangle
- AT_agc020_b - [AGC020B] Ice Rink Game
- AT_agc023_b - [AGC023B] Find Symmetries
- AT_agc024_b - [AGC024B] Backfront
- AT_agc024_c - [AGC024C] Sequence Growing Easy
- AT_agc025_b - [AGC025B] RGB Coloring
- AT_agc026_b - [AGC026B] rng_10s
- AT_agc027_c - [AGC027C] ABland Yard
- AT_agc029_b - [AGC029B] Powers of two
- AT_aising2019_d - Nearest Card Game
- AT_aising2020_d - Anything Goes to Zero
- AT_arc003_3 - [ARC003C] 暗闇帰り道
- AT_arc006_4 - [ARC006D] アルファベット探し
- AT_arc008_3 - [ARC008C] THE☆たこ焼き祭り2012
- AT_arc011_3 - [ARC011C] ダブレット
- AT_arc012_3 - [ARC012C] 五目並べチェッカー
- AT_arc013_3 - [ARC013C] 笑いをとれるかな？
- AT_arc014_4 - [ARC014D] grepマスター
- AT_arc018_3 - [ARC018C] 席替え
- AT_arc021_2 - [ARC021B] Your Numbers are XORed...
- AT_arc022_2 - [ARC022B] 細長いお菓子
- AT_arc022_3 - [ARC022C] ロミオとジュリエット
- AT_arc024_2 - [ARC024B] 赤と黒の木
- AT_arc025_2 - [ARC025B] チョコレート
- AT_arc027_2 - [ARC027B] 大事な数なのでZ回書きまLた。
- AT_arc027_3 - [ARC027C] 最高のトッピングにしような
- AT_arc028_2 - [ARC028B] 特別賞
- AT_arc028_3 - [ARC028C] 高橋王国の分割統治
- AT_arc033_3 - [ARC033C] データ構造
- AT_arc034_3 - [ARC034C] 約数かつ倍数
- AT_arc035_c - [ARC035C] アットコーダー王国の交通事情
- AT_arc037_c - [ARC037C] 億マス計算
- AT_arc038_b - [ARC038B] マス目と駒
- AT_arc039_b - [ARC039B] 高橋幼稚園
- AT_arc041_c - [ARC041C] ウサギ跳び
- AT_arc042_a - [ARC042A] 掲示板
- AT_arc042_c - [ARC042C] おやつ
- AT_arc044_b - [ARC044B] 最短路問題
- AT_arc046_b - [ARC046B] 石取り大作戦
- AT_arc049_b - [ARC049B] 高橋ノルム君
- AT_arc051_c - [ARC051C] 掛け算
- AT_arc052_b - [ARC052B] 円錐
- AT_arc056_b - [ARC056B] 駐車場
- AT_arc061_b - [ABC045D] すぬけ君の塗り絵
- AT_arc062_a - [ABC046C] AtCoDeerくんと選挙速報
- AT_arc063_b - [ABC047D] 高橋君と見えざる手
- AT_arc072_a - [ABC059C] Sequence
- AT_arc072_b - [ABC059D] Alice&Brown
- AT_arc075_b - [ABC063D] Widespread
- AT_arc075_c - [ARC075E] Meaningful Mean
- AT_arc077_b - [ABC066D] 11
- AT_arc083_b - [ABC074D] Restoring Road Network
- AT_arc086_b - [ABC081D] Non-decreasing
- AT_arc087_b - [ABC082D] FT Robot
- AT_arc093_b - [ABC092D] Grid Components
- AT_arc094_b - [ABC093D] Worst Case
- AT_arc096_b - [ABC095D] Static Sushi
- AT_arc100_b - [ABC102D] Equal Cut
- AT_arc107_c - [ARC107C] Shuffle Permutation
- AT_arc108_c - [ARC108C] Keep Graph Connected
- AT_arc111_b - [ARC111B] Reversible Cards
- AT_arc113_d - [ARC113D] Sky Reflector
- AT_arc116_c - [ARC116C] Multiple Sequences
- AT_arc116_d - [ARC116D] I Wanna Win The Game
- AT_arc119_c - [ARC119C] ARC Wrecker 2
- AT_arc125_c - [ARC125C] LIS to Original Sequence
- AT_arc126_b - [ARC126B] Cross-free Matching
- AT_arc127_b - [ARC127B] Ternary Strings
- AT_arc128_c - [ARC128C] Max Dot
- AT_arc133_b - [ARC133B] Dividing Subsequence
- AT_arc133_c - [ARC133C] Row Column Sums
- AT_arc134_c - [ARC134C] The Majority
- AT_arc135_c - [ARC135C] XOR to All
- AT_arc136_b - [ARC136B] Triple Shift
- AT_arc137_a - [ARC137A] Coprime Pair
- AT_arc138_c - [ARC138C] Rotate and Play Game
- AT_arc139_b - [ARC139B] Make N
- AT_arc140_c - [ARC140C] ABS Permutation (LIS ver.)
- AT_arc142_c - [ARC142C] Tree Queries
- AT_arc143_b - [ARC143B] Counting Grids
- AT_arc143_c - [ARC143C] Piles of Pebbles
- AT_arc144_c - [ARC144C] K Derangement
- AT_arc146_b - [ARC146B] Plus and AND
- AT_arc148_c - [ARC148C] Lights Out on Tree
- AT_arc149_b - [ARC149B] Two LIS Sum
- AT_arc149_c - [ARC149C] Avoid Prime Sum
- AT_arc150_b - [ARC150B] Make Divisible
- AT_arc150_c - [ARC150C] Path and Subsequence
- AT_arc151_b - [ARC151B] A < AP
- AT_arc152_b - [ARC152B] Pass on Path
- AT_arc155_a - [ARC155A] ST and TS  Palindrome
- AT_cf_2015_morning_easy_d - ヘイホー君と削除
- AT_cf_2015_morning_hard_a - 一次元オセロ
- AT_chokudai_S001_k - 辞書順で何番目？
- AT_chokudai_S002_k - 種類数 β
- AT_code_festival_2017_quala_c - Palindromic Matrix
- AT_code_festival_morning_easy_c - 身体バランス
- AT_code_festival_qualA_d - 壊れた電卓
- AT_code_festival_qualB_c - 錬金術士
- AT_code_festival_qualB_d - 登山家
- AT_code_formula_2014_qualA_c - 決勝進出者
- AT_code_formula_2014_qualB_c - 仲良し文字列
- AT_codefestival_2015_qualA_d - 壊れた電車
- AT_codefestival_2016_final_b - Exactly N points
- AT_codefestival_2016_final_c - Interpretation
- AT_codefestival_2016_final_d - Pair Cards
- AT_codefestival_2016_qualB_c - Gr-idian MST
- AT_codefestival_2016_qualB_d - Greedy customers
- AT_codefestival_2016_qualC_c - 二人のアルピニスト
- AT_ddcc2020_final_a - Div/de
- AT_ddcc2020_qual_c - Strawberry Cakes
- AT_ddcc2020_qual_d - Digit Sum Replace
- AT_digitalarts_2 - Password
- AT_discovery_2016_final_b - DDPC特別ビュッフェⅡ
- AT_discovery_2016_qual_b - ディスコ社内ツアー
- AT_diverta2019_2_d - Squirrel Merchant
- AT_donuts_2015_3 - 行列のできるドーナツ屋
- AT_donuts_live2014_5 - お菓子やさん
- AT_dp_i - Coins
- AT_dp_m - Candies
- AT_dp_q - Flowers
- AT_dp_r - Walk
- AT_dwacon5th_prelims_b - Sum AND Subarrays
- AT_dwacon5th_prelims_c - k-DMC
- AT_exawizards2019_c - Snuke the Wizard
- AT_hhkb2020_d - Squares
- AT_hhkb2020_e - Lamps
- AT_icpc2012autumn_a - Dictionary
- AT_indeednow_2015_quala_3 - 説明会
- AT_indeednow_2015_quala_4 - パズル
- AT_jag2017autumn_e - Tree Separator
- AT_joi2011yo_e - チーズ (Cheese)
- AT_joi2015ho_b - ケーキの切り分け２ (Cake 2)
- AT_joi2015ho_c - JOI 公園 (JOI Park)
- AT_joi2019ho_b - 展覧会 (Exhibition)
- AT_joisc2014_b - たのしい家庭菜園
- AT_jsc2019_qual_c - Cell Inversion
- AT_keyence2019_d - Double Landscape
- AT_keyence2020_d - Swap and Flip
- AT_keyence2021_c - Robot on Grid
- AT_kupc2021_g - Two Step Sort
- AT_kupc2021_k - Three Coloring
- AT_nikkei2019_2_qual_d - Shortest Path on a Line
- AT_nikkei2019_qual_d - Restore the Tree
- AT_s8pc_5_e - Broken Skateboard
- AT_snuke21_d - Subsequence
- AT_snuke21_g - Medals
- AT_soundhound2018_summer_qual_c - Ordinary Beauty
- AT_soundhound2018_summer_qual_d - Saving Snuuk
- AT_sumitb2019_f - Interval Running
- AT_tdpc_dice - サイコロ
- AT_tdpc_tournament - トーナメント
- AT_tenka1_2013_qualB_b - 天下一後入れ先出しデータ構造
- AT_tenka1_2014_qualA_b - かぶりん！
- AT_tenka1_2016_qualA_d - グラフィカルグラフ
- AT_tenka1_2016_qualA_e - 無限グラフ
- AT_tenka1_2017_d - IntegerotS
- AT_tenka1_2018_d - Crossing
- AT_toyota2023spring_final_a - Area Sum
- AT_utpc2011_3 - [[iwi]]
- AT_utpc2013_03 - 直径
- AT_wupc_04 - 5キューブ
- AT_zone2021_e - 潜入


---

---
title: "[ABC001D] 感雨時刻の整理"
layout: "post"
diff: 普及-
pid: AT_abc001_4
tag: []
---

# [ABC001D] 感雨時刻の整理

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc001/tasks/abc001_4

雨の降っていた時刻というのは、降水量と並んで重要です。今、ある $ 1 $ 日の、雨が降っていた時刻に関するメモが見つかったので、これを整理して、雨の降っていた時刻を調べたいと思います。  
  
 整理は、以下の規則に従って行います。

- 感雨時間のメモから、その日 $ 1 $ 日の雨の降っていた時刻を時系列順に出す。日付を超えて降っている雨は、 $ 00:00 $ 降り始めや $ 24:00 $ 降り終わりとして扱われるものとし、日付をまたぐようなメモは入力されない。
- 雨の降り始め・降り終わりはそれぞれ直前・直後の $ 5 $ 分単位の時刻に丸める。例えば、$ 13:23 $ に降り始めて $ 14:01 $ にやんだ雨は、$ 13:20 $ から $ 14:05 $ まで降っていたということにする。
- 丸めた後の結果において、$ 2 $ つ以上のメモに書かれていた感雨時刻が重複した場合、$ 1 $ つの連続した雨とみなす。例えば、$ 11:06 $ に降り始めて $ 11:23 $ にやんだ雨、$ 11:29 $ に降り始めて $ 12:03 $ にやんだ雨、$ 11:48 $ に降り始めて $ 12:10 $ にやんだ雨の $ 3 $ つがあった場合、$ 11:05 $〜$ 11:25 $、$ 11:25 $〜$ 12:05 $、$ 11:45 $〜$ 12:10 $ の $ 3 $ つの雨であるが、時間がかぶっているところをくっつけて $ 11:05 $ から $ 12:10 $ まで降っていた、$ 1 $ つの連続した雨ということにする。
 
  
 メモの内容が入力される時、雨の降っていた時刻を、この規則に合致するよう整理して出力するプログラムを作成してください。 入力は以下の形式で標準入力から与えられる。 > $ N $ $ S_1 $-$ E_1 $ $ S_2 $-$ E_2 $ : $ S_N $-$ E_N $

1. $ 1 $ 行目には、連続して雨の降っていた時刻の数を表す整数 $ N\ (1≦N≦30,000) $ が与えられる。
2. $ 2 $ 行目から $ N+1 $ 行目までの $ N $ 行で、雨の降り始めの時刻と降り終わりの時刻が与えられる。

- この中の $ i\ (1≦i≦N) $ 行目において、雨が降り始めた時刻 $ S_i $ と雨が降り終わった時刻 $ E_i $ がハイフンで区切られて与えられる。
- 時刻 $ S_i $ と $ E_i $ において
- 時刻は必ず $ 4 $ 桁の非負整数で与えられる。
- 時刻の上 $ 2 $ 桁が時間 $ ({\rm\ hour}) $ 、下 $ 2 $ 桁が分 $ ({\rm\ minute}) $ を表す。
- 時刻は $ 0000 $ から $ 2400 $ まで取り得る。ただし下 $ 2 $ 桁の部分が $ 59 $ を超えることはない。
- $ S_i $ が $ E_i $ より前の時刻であることが保証されている。
 

 雨が降っていた時刻を整理して、降り始めの時刻の早い順番に、降り始めた時刻と降り終わりの時刻をハイフンで区切って出力せよ。  
 その際、連続した $ 1 $ つの雨を $ 1 $ 行に出力し、時刻の形式は入力と同じ形式を用いること。  
 また、出力の末尾には改行を入れること。 ```
<pre class="prettyprint linenums">
4
1148-1210
1323-1401
1106-1123
1129-1203
```

- $ 11:48 $〜$ 12:10 $ の間、雨が降っていた。
- $ 13:23 $〜$ 14:01 $ の間、雨が降っていた。
- $ 11:06 $〜$ 11:23 $ の間、雨が降っていた。
- $ 11:29 $〜$ 12:03 $ の間、雨が降っていた。
 
```
<pre class="prettyprint linenums">
1105-1210
1320-1405
```

- 入力を $ 5 $ 分単位に丸めると、順に $ 1145 $-$ 1210 $、$ 1320 $-$ 1405 $、$ 1105 $-$ 1125 $、$ 1125 $-$ 1205 $となる。
- これを降り始めの時刻の早い順に直すと、$ 1105 $-$ 1125 $、$ 1125 $-$ 1205 $、$ 1145 $-$ 1210 $、$ 1320 $-$ 1405 $となる。
- $ 1105 $-$ 1125 $、$ 1125 $-$ 1205 $の $ 2 $ つは、前者の降り終わりの時刻と後者の降り始めの時刻が一致するので、くっついて $ 1105 $-$ 1205 $ となる。
- さらに、$ 1105 $-$ 1205 $ と、$ 1145 $-$ 1210 $ は、後者の降り始めの時刻が前者の降っている時刻の間に入るので、くっついて $ 1105 $-$ 1210 $ となる。
- そのため、結局この例のような出力となる。
- なお、出力は雨の降った時刻の早い順でなければならない。
 
```
<pre class="prettyprint linenums">
1
0000-2400
```

 ```
<pre class="prettyprint linenums">
0000-2400
```

- 一日中雨が降っている場合である。
 
```
<pre class="prettyprint linenums">
6
1157-1306
1159-1307
1158-1259
1230-1240
1157-1306
1315-1317
```

- 全く同じメモが複数存在する場合もある。
 
```
<pre class="prettyprint linenums">
1155-1310
1315-1320
```



---

---
title: "[ABC005C] おいしいたこ焼きの売り方"
layout: "post"
diff: 普及-
pid: AT_abc005_3
tag: []
---

# [ABC005C] おいしいたこ焼きの売り方

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc005/tasks/abc005_3

 高橋君は、たこ焼きをどの順番で売るか悩んでいました。というのも、作り置きされたたこ焼きは美味しくないとわかっているので、高橋君はそのようなたこ焼きを売りたくないのですが、できたてばかり売ってしまうと売れるたこ焼きの数が減ってしまいます。

 また、お客さんを待たせてばかりだと、次第にお客さんが離れてしまうだろうと高橋君は考えています。  
 そこで、彼は $ T $ 秒以内に作成されたたこ焼きを売り続けることで、お客さんを捌ききれるかどうかを調べることにしました。

 たこ焼きは $ A_1 $、$ A_2 $、…、$ A_N $ 秒後に焼きあがります。  
 お客さんは $ B_1 $、$ B_2 $、…、$ B_M $ 秒後にやってきます。  
 $ 1 $ 人のお客さんに対して、たこ焼きを $ 1 $ つ売るとします。すべてのお客さんにたこ焼きを売れるなら`yes`、売れないなら`no`を出力して下さい。

 入力は以下の形式で標準入力から与えられる。 > $ T $ $ N $ $ A_1 $ $ A_2 $ $ ... $ $ A_N $ $ M $ $ B_1 $ $ B_2 $ $ ... $ $ B_M $

1. $ 1 $ 行目に、何秒以内のたこ焼きまで売るかを表す整数$ T(1≦T≦100) $が与えられます。
2. $ 2 $ 行目に、高橋君が作成するたこ焼きの総数を表す整数$ N(1≦N≦100) $が与えられます。
3. $ 3 $ 行目に、それぞれのたこ焼きが何秒後にできるかを表す整数 $ Ai(1≦Ai≦100、A1≦A2≦...≦AN) $ が半角スペース区切りで $ N $ 個与えられます。
4. $ 4 $ 行目に、来店するお客さんの人数を表す整数$ M(1≦M≦100) $が与えられます。
5. $ 5 $ 行目に、それぞれのお客さんが何秒後に来るかを表す整数 $ Bi(1≦Bi≦100、B1≦B2≦...≦BM) $ が半角スペース区切りで $ M $ 個与えられます。

 すべてのお客さんにたこ焼きをすぐ売れるなら`yes`、売れないなら`no`を出力して下さい。

 また、出力の末尾には改行を入れて下さい。



---

---
title: "[ABC006A] 世界のFizzBuzz"
layout: "post"
diff: 普及-
pid: AT_abc006_1
tag: []
---

# [ABC006A] 世界のFizzBuzz

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc006/tasks/abc006_1

 数字 $ N $ が与えられます。 $ N $ に $ 3 $ が含まれる、もしくは $ 3 $ で割り切れる場合は`YES`、それ以外は `NO` と出力してください。

 入力は以下の形式で標準入力から与えられる。 > $ N $

 整数 $ N(1≦N≦9) $ が $ 1 $ 行で与えられる。  $ N $ に $ 3 $ が含まれる、もしくは $ 3 $ で割り切れる場合は`YES`、それ以外は `NO` と出力してください。

  また、出力の末尾には改行を入れること。  ```
<pre class="prettyprint linenums">
2
```

 ```
<pre class="prettyprint linenums">
NO
```

- $ 2 $ は $ 3 $ で割り切ることができません。また $ 3 $ が含まれている数字でもありません。
 
```
<pre class="prettyprint linenums">
9
```

 ```
<pre class="prettyprint linenums">
YES
```

- $ 9 $ は $ 3 $ で割り切ることができます。
 
```
<pre class="prettyprint linenums">
3
```

 ```
<pre class="prettyprint linenums">
YES
```

- $ 3 $ は $ 3 $ で割り切ることができます。



---

---
title: "[ABC006C] スフィンクスのなぞなぞ"
layout: "post"
diff: 普及-
pid: AT_abc006_3
tag: []
---

# [ABC006C] スフィンクスのなぞなぞ

## 题目描述

新学期到来了，你正带着激动心情走在上学路上，突然斯芬克斯（狮身人面像）出现在了你的面前。 这个斯芬克斯因为能出谜题而闻名于世，如果你不能回答他的谜题，你就会留级！

# 谜题如下
在这条街道上住着 $N$ 个人，其中有大人，老人，婴儿三种人。住在这条街的人们，拥有的腿的总数为M条。我们假设大人有 2 条腿，老人有 3 条腿（有一条腿是拐杖），婴儿有 4 条腿（他们还不能直立行走）。请回答一个可能的，满足上述条件的住在这条街道上的人数数量组合的答案。

不想在新学期就留级的你，必须给出这道谜题的正确答案。请输出一个这条街道上住着的人的数量组合作为这道谜题的答案。 如果没有符合条件的数量组合，请输出 `-1 -1 -1` 。

## 输入格式

仅一行，包含 $N$ 和 $M$ ，中间用一个空格隔开。

## 输出格式

请输出一个这条街道上住着的人的数量组合作为这道谜题的答案。 输出顺序为，“大人人数 老人人数 婴儿人数”，中间用一个空格隔开。 如果没有符合条件的数量组合，请输出 `-1 -1 -1` 。 请在行末输出一个换行符。

## 说明/提示

这个问题有三组测试数据组，每个测试数组有不同的数据范围分。 若能答对 $N(1 ≤ N ≤ 100)$ 、$M(1 ≤ M ≤ 500)$ 范围的数据，可以得到10分。若能答对 $N(1 ≤ N ≤ 1, 500)$ 、$M(1 ≤ M ≤ 7, 500)$ 范围的数据，可以得到另外 20 分。若能答对所有范围内的数据，可以得到 100 分。

## 样例1
输入的数据表示一共有 3 个人，9 条腿。输出表示，一种可能的情况是 1 个大人，1 个老人，1 个婴儿。1 个大人共 2 条腿，1 个老人共 3 条腿，1个婴儿共 4 条腿，加起来一共 3 个人，9 条腿。

# 样例2
1 个大人共 2 条腿，3 个老人共 9 条腿，3 个婴儿共 12 条腿，加起来一共 7 个人，23 条腿。

# 样例3
符合谜题要求的答案不存在，因此输出 `-1 -1 -1` 。



---

---
title: "[ABC006D] トランプ挿入ソート"
layout: "post"
diff: 普及-
pid: AT_abc006_4
tag: []
---

# [ABC006D] トランプ挿入ソート

## 题目描述

有写着数字的牌N张。对于这卡束（摞好扣在旁边的牌，即为“山札”）可以进行以下操作。



- 从剩下的牌中抽出1张卡，插入卡束任意位置。



求卡片从上到下按升序排序所需的最小操作次数。

## 输入格式

第一行一个数字n，以下n行每行一个数字代表牌的顺序。

## 输出格式

求卡片从上到下按升序排序所需的最小操作次数。

另外，在输出的末尾另起一行。（换行)

## 说明/提示

该问题包括3个数据集，每个数据集设置分值。



- 如果对满足N(1≤N≤16)的所有数据集正确解答，则给10分。





- 如果对满足N(1≤N≤1,000) N(1≤N≤1,000)的全部数据集正确解答，则与上述数据集另外给40分。





- 如果全部数据集合正确解答，则给100分。





**操作示例**



取出2放入1和3之间。取出5放入4和6之间。



---

---
title: "[ABC010C] 浮気調査"
layout: "post"
diff: 普及-
pid: AT_abc010_3
tag: []
---

# [ABC010C] 浮気調査

## 题目描述

已知高桥君从平面直角坐标系的 $(x_a, y_a)$ 处出发，在 $T$ 分钟后到达 $(x_b,y_b)$。已知高桥君每分钟**最大**速度为 $V$。又给出 $n$ 个点，求高桥君有没有可能经过这些点中的**任意一个**。有可能则输出 `YES`， 没有则输出 `NO`。

## 输入格式

输入数据共 $2+n$ 行：

第一行按顺序输入 $x_a,y_a,x_b,y_b,T,V$。

第二行输入一个整数 $n$。

第三行到第 $2+n$ 行，对于第 $i$ 行输入两个整数为 $x_i$ 和 $y_i$。

## 输出格式

输出数据共一行为高桥君能否到达 $n$ 个点中的任意一个。

## 样例 #1

### 输入

```
1 1 8 2 2 4

1

4 5
```

### 输出

```
NO
```

## 样例 #2

### 输入

```
1 1 8 2 2 6

1

4 5
```

### 输出

```
YES
```

## 样例 #3

### 输入

```
1 1 8 2 2 5

1

4 5
```

### 输出

```
YES
```

## 样例 #4

### 输入

```
7 7 1 1 3 4

3

8 1

1 7

9 9
```

### 输出

```
YES
```



---

---
title: "[ABC011C] 123引き算"
layout: "post"
diff: 普及-
pid: AT_abc011_3
tag: []
---

# [ABC011C] 123引き算

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc011/tasks/abc011_3

あなたは、友人から、一人用のゲームを紹介されました。

最初に、数字 $ N $ が与えられます。 $ 1 $ , $ 2 $ , $ 3 $ の中から好きな数字を選び、 与えられた数字に対し、引き算を行う、という処理を行うことできます。

この処理は $ 100 $ 回まで行うことが可能であり、最終的に数字を $ 0 $ にすることが目標のゲームです。

しかし、計算途中でなってはいけないNG数字が $ 3 $ つ与えられており、 この数字に一時的にでもなってしまった瞬間、このゲームは失敗となります。 NG数字が $ N $ と同じ場合も失敗となります。

NG数字が $ N $ と同じ場合について、正しい判定が行われていませんでした。リジャッジを行いました。

あなたは、このゲームが、目標達成可能なゲームとなっているか調べたいです。

目標達成可能な場合は`YES`、そうでない場合は`NO`と出力してください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ NG_1 $ $ NG_2 $ $ NG_3 $

- $ 1 $ 行目には、最初に与えられる数字 $ N\ (1\ ≦\ N\ ≦\ 300) $ が与えられる。
- $ 2 $ 行目には、 $ 1 $ 番目のNG数字 $ NG_1\ (1\ ≦\ NG_1\ ≦\ 300) $ が与えられる。
- $ 3 $ 行目には、 $ 2 $ 番目のNG数字 $ NG_2\ (1\ ≦\ NG_2\ ≦\ 300) $ が与えられる。
- $ 4 $ 行目には、 $ 3 $ 番目のNG数字 $ NG_3\ (1\ ≦\ NG_3\ ≦\ 300) $ が与えられる。

## 输出格式

目標達成可能な場合は`YES`、そうでない場合は`NO`を $ 1 $ 行で出力せよ。出力の末尾にも改行をいれること。

## 说明/提示

### Sample Explanation 1

$ 2 $ を $ 1 $ 回引くことにより、 $ 0 $ を作ることが出来ます。

### Sample Explanation 2

最初に $ 2 $ を引き、次に $ 3 $ を引くことで、$ 5 $ → $ 3 $ → $ 0 $ と変化し、目標を達成することが出来ます。

### Sample Explanation 3

$ 100 $ 回連続で $ 3 $ を引かなければ、目標を達成することはできません。 しかし、 $ 3 $ だけを引き続けていると、途中でNG数字である $ 57 $ になってしまいます。

## 样例 #1

### 输入

```
2

1

7

15
```

### 输出

```
YES
```

## 样例 #2

### 输入

```
5

1

4

2
```

### 输出

```
YES
```

## 样例 #3

### 输入

```
300

57

121

244
```

### 输出

```
NO
```



---

---
title: "[ABC019C] 高橋くんと魔法の箱"
layout: "post"
diff: 普及-
pid: AT_abc019_3
tag: []
---

# [ABC019C] 高橋くんと魔法の箱

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc019/tasks/abc019_3

高橋くんは魔法の箱を持っています。

この箱に整数を入れるとそれに対応した整数が出てきます。

出てくる整数は入れた整数だけによって決まり、同じ整数を入れると毎回同じ結果が得られます。

高橋くんは任意の整数 $ x $ について、$ x $ を入れた時と $ 2x $ を入れた時に出てくる整数が同じであることに気づきました。

高橋くんが入れた整数が $ N $ 個与えられるので、最大で何種類の整数が出てくるか答えてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ a_1 $ $ a_2 $ .. $ a_N $

- $ 1 $ 行目には、高橋くんが箱に入れる整数の個数 $ N\ (\ 1\ ≦\ N\ ≦\ 10^5) $ が与えられる。
- $ 2 $ 行目には、高橋くんが箱に入れる $ N $ 個の整数が空白を区切りとして与えられる。
- $ 1\ ≦\ a_i\ ≦\ 10^9\ (\ 1\ ≦\ i\ ≦\ N) $ であることが保証される。
- $ i\ ≠\ j $ のとき、$ a_i\ ≠\ a_j $ であることが保証される。

## 输出格式

最大で何種類の整数が出てくるかを標準出力に出力せよ。

末尾の改行を忘れないこと。

## 说明/提示

### 部分点

この問題には部分点が設定されている。

- $ 20 $ 点分のテストケースにおいて、$ 1\ ≦\ N\ ≦\ 3,000 $ を満たす。
- 別の $ 30 $ 点分のテストケースにおいて、$ 1\ ≦\ a_i\ ≦\ 5*10^5\ (\ 1\ ≦\ i\ ≦\ N) $ を満たす。

### Sample Explanation 1

$ 2 $ を入れた時に出てくる整数は、$ 1 $ を入れた時に出てくる整数と等しいので、最大で $ 2 $ 種類の整数が出てきます。

### Sample Explanation 2

すべて同じ整数が出てきます。

### Sample Explanation 3

出てくる整数が全て違う可能性があります。

## 样例 #1

### 输入

```
3

1 2 3
```

### 输出

```
2
```

## 样例 #2

### 输入

```
4

2 4 8 16
```

### 输出

```
1
```

## 样例 #3

### 输入

```
4

2 3 5 7
```

### 输出

```
4
```



---

---
title: "[ABC021A] 足し算"
layout: "post"
diff: 普及-
pid: AT_abc021_a
tag: []
---

# [ABC021A] 足し算

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc021/tasks/abc021_a

正整数 $ N $ と、 $ 2 $ の累乗数 $ 1,2,4,8 $ があります。

 これらのうち、 **同じ $ 2 $ の累乗数をいくつ使っても良い** ので、それらの和が $ N $ となるような組み合わせを $ 1 $ つ求めてください。 組み合わせが複数考えられる場合は、そのうちのどれを出力しても構いません。

例えば $ N=5 $ のとき、$ 5=1+2+2 $ となることから $ 1 $ つの組み合わせとして $ {1,2,2} $ が考えられます。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $

- $ 1 $ 行目には、正整数 $ N\ (1\ ≦\ N\ ≦\ 10) $ が与えられる。

## 输出格式

$ 1 $ 行目に、組み合わせを構成する整数の個数 $ K $ を出力せよ。

$ 2 $ 行目から $ K $ 行には、組み合わせを構成する $ K $ 個の整数をそれぞれ出力せよ。 和がちょうど $ N $ になり、組み合わせを構成する各整数が $ 2 $ の累乗数であるならば正解として扱われる。それ以外の場合は不正解として扱われる。

末尾の改行を忘れないこと。

## 说明/提示

### Sample Explanation 1

問題文の例です。$ 5=1+2+2 $ と表せるので、このように出力すると正解になります。最初に組み合わせを構成する整数の個数である $ 3 $ を出力するのを忘れないでください。 他にも、$ 5=1+4 $ なので、$ 1,4 $ という組み合わせを出力しても正解となります。

## 样例 #1

### 输入

```
5
```

### 输出

```
3

1

2

2
```

## 样例 #2

### 输入

```
1
```

### 输出

```
1

1
```



---

---
title: "[ABC021B] 嘘つきの高橋くん"
layout: "post"
diff: 普及-
pid: AT_abc021_b
tag: []
---

# [ABC021B] 嘘つきの高橋くん

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc021/tasks/abc021_b

あなたと高橋君は、AtCoder 王国に住んでいます。AtCoder 王国には、$ N $ 個の町と、町同士を結ぶ何本かの道路が存在し、道路は双方向に移動可能です。 $ N $ 個の町はそれぞれ 町 $ 1 $,町 $ 2 $,…,町 $ N $ と呼ばれています。

高橋君はあなたの家に遊びに行くことにしました。そして、高橋君は町 $ a $ から出発して、ちょうど $ K $ 回 AtCoder 王国のどこかの町を経由して町 $ b $ にあるあなたの家に到着しました。

高橋君は町 $ a $ から町 $ b $ まで最短経路で移動してきたと主張していますが、あなたには彼が嘘をついているよう思えます。 しかし、あなたは具体的に町同士を結ぶ道路がどのような構成になっているか全く知らないため、高橋君が辿った経路が本当に最短経路なのかどうか判定できません。

あなたは高橋君がどの順番で町を経由したかを聞き出すことに成功しました。ただし、この情報には出発/到着地点である町 $ a $ と町 $ b $ が含まれません。

あなたはこの情報を元に、高橋君が最短経路で移動していた可能性があるかどうかを出力するプログラムを書くことにしました。 町 $ a $ から町 $ b $ への最短経路とは、町 $ a $ から町 $ b $ への移動経路において道路を通る回数が最小となるような経路のことを言います。

高橋君が辿った経路が最短経路となるような町と道路の構成が $ 1 $ つでも存在する場合、最短経路で移動した可能性があると言えます。一方、そのような構成がない場合、その可能性は無いと言えます。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ a $ $ b $ $ K $ $ P_1 $ $ P_2 $ … $ P_K $

- $ 1 $ 行目には、AtCoder 王国に存在する町の個数を表す整数 $ N(2≦N≦100) $ が与えられる。
- $ 2 $ 行目には、高橋君が出発する町とあなたの家がある町の番号を表す $ 2 $ つの整数 $ a,b(1≦a,b≦N,a≠b) $ が空白区切りで与えられる。
- $ 3 $ 行目には、高橋君の移動において経由した町の個数を表す整数 $ K\ (1≦K≦100) $ が与えられる。
- $ 4 $ 行目には、高橋君の移動において経由した町の番号が順番に空白区切りで与えられる。そのうち $ i(1≦i≦K) $ 番目の整数は、町 $ a $ を出発した後 $ i $ 番目に経由した町の番号 $ P_i(1≦P_i≦N) $ を表す。
- $ \{P_i\} $ の隣接する要素は全て異なる。つまり全ての $ j(2≦j≦K) $について、$ P_j≠P_{j-1} $ が成り立つ。さらに、$ P_1\ ≠\ a $ かつ $ P_K\ ≠\ b $ が成り立つ。

## 输出格式

$ 1 $ 行目に、高橋君が最短経路で移動していた可能性があるならば `YES`、その可能性がないならば `NO` と出力せよ。

末尾の改行を忘れないこと。

## 说明/提示

### Sample Explanation 1

たとえば以下のような道路の構成を考えると $ 1→3→4→2→5 $ という経路が最短経路となります。 !\[\](http://abc021.contest.atcoder.jp/img/abc/021/enJQfEfKt-baQEUDjCrVFLSw/B\_sample1.png)

### Sample Explanation 2

$ 1→2→4→2→7→3 $ という経路が最短経路となるような道路の構成は存在しません。 どのような道路の構成においても、一度訪れた町に再び訪れるような移動は必ず省略できるからです。 !\[\](http://abc021.contest.atcoder.jp/img/abc/021/enJQfEfKt-baQEUDjCrVFLSw/B\_sample2.png)

### Sample Explanation 3

$ 1→2→1→3→4 $ と移動しています。一度出発地点に戻っていますが、そのような移動をしてしまうと最短経路を達成することはできません。

### Sample Explanation 4

$ 1→2→4→3→4 $ と移動しています。今度は到着地点に一度辿り着いたのにも関わらず移動しています。

## 样例 #1

### 输入

```
5

1 5

3

3 4 2
```

### 输出

```
YES
```

## 样例 #2

### 输入

```
7

1 3

4

2 4 2 7
```

### 输出

```
NO
```

## 样例 #3

### 输入

```
4

1 4

3

2 1 3
```

### 输出

```
NO
```

## 样例 #4

### 输入

```
4

1 4

3

2 4 3
```

### 输出

```
NO
```

## 样例 #5

### 输入

```
20

1 4

12

2 3 5 7 8 9 10 11 12 15 13 14
```

### 输出

```
YES
```



---

---
title: "[ABC022B] Bumble Bee"
layout: "post"
diff: 普及-
pid: AT_abc022_b
tag: []
---

# [ABC022B] Bumble Bee

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc022/tasks/abc022_b

高橋君はマルハナバチ(Bumblebee)という種類のミツバチです。

今日も花の蜜を求めて異なる $ N $ 個の花を訪れました。

高橋君が $ i $ 番目に訪れた花の種類は $ A_i $ です。

$ i $ 番目の花は、$ i\ >\ j $ かつ $ i $ 番目の花の種類と $ j $ 番目の花の種類が同じになるような $ j $ が存在すれば受粉します。

高橋君が訪れた $ N $ 個の花の種類の情報が与えられるので、そのうちいくつの花が受粉したか求めてください。

なお、高橋君以外による受粉や自家受粉を考える必要はありません。

## 输入格式

入力は以下の形式で標準入力から与えられる

> $ N $ $ A_1 $ $ A_2 $ : $ A_N $

- $ 1 $ 行目には高橋君が訪れた花の個数を表す整数 $ N(1\ ≦\ N\ ≦\ 10^5) $ が与えられる。
- $ 2 $ 行目からの $ N $ 行のうち $ i $ 行目には $ i $ 番目に高橋君が訪れた花の種類を表す整数 $ A_i\ (1\ ≦\ A_i\ ≦\ 10^5) $ が与えられる。

## 输出格式

受粉した花の個数を $ 1 $ 行で出力せよ。出力の末尾にも改行を入れること。

## 说明/提示

### Sample Explanation 1

$ 4 $ 番目と $ 5 $ 番目の花が受粉します。

## 样例 #1

### 输入

```
5

1

2

3

2

1
```

### 输出

```
2
```

## 样例 #2

### 输入

```
11

3

1

4

1

5

9

2

6

5

3

5
```

### 输出

```
4
```



---

---
title: "[ABC023B] 手芸王"
layout: "post"
diff: 普及-
pid: AT_abc023_b
tag: []
---

# [ABC023B] 手芸王

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc023/tasks/abc023_b

高橋君は趣味でアクセサリーを作っている。

アクセサリーは `a`, `b`, `c` のいずれか $ 1 $ 文字が書かれたブロックを横 $ 1 $ 列に並べることで作成できる。

高橋君は、以下の手順でアクセサリーの作成を行う：

- 手順 $ 0 $ : 高橋君は `b` $ 1 $ 文字からなるアクセサリーを作成する。

以降の手順では、既にあるアクセサリーの両端にブロックを $ 1 $ つずつ追加することでアクセサリーを改造する。

- 手順 $ 3n\ +\ 1\ (n\ ≧\ 0) $ : 手順 $ 3n $ で完成したアクセサリーの左端に文字 `a` が書かれたブロックを、右端に文字 `c` が書かれたブロックを付け足す。
- 手順 $ 3n\ +\ 2\ (n\ ≧\ 0) $ : 手順 $ 3n+1 $ で完成したアクセサリーの左端に文字 `c` が書かれたブロックを、右端に文字 `a` が書かれたブロックを付け足す。
- 手順 $ 3n\ (n\ ≧\ 1) $ : 手順 $ 3n-1 $ で完成したアクセサリーの左端に文字 `b` が書かれたブロックを、右端に文字 `b` が書かれたブロックを付け足す。

高橋君はアクセサリーの作成を好きな手順の直後に終了することができる。終了した場合、アクセサリーには、アクセサリーを構成するブロックに書かれた文字を左から右に読んだものと同じ名前が付けられる。

例えば、手順 $ 0 $, $ 1 $, $ 2 $, $ 3 $ それぞれの直後にアクセサリーの作成を終了した場合、アクセサリーの名前は順に、`b`, `abc`, `cabca`, `bcabcab` となる。

文字列 $ S $ が与えられるので、その文字列がアクセサリーの名前として考えられるかを判定し、考えられるなら何番目の手順の直後にアクセサリーの作成を終了したのかを求めよ。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ S $

- $ 1 $ 行目には、文字列 $ S $ の長さを表す整数 $ N\ (1\ ≦\ N\ ≦\ 100) $ が与えられる。
- $ 2 $ 行目には、半角の小文字アルファベットのみからなる文字列 $ S $ が与えられる。

## 输出格式

文字列 $ S $ が手順 $ K $ の直後にアクセサリーの作成を終了したときのアクセサリーの名前と等しいような整数 $ K $ が存在する場合は整数 $ K $ を、いつアクセサリーの作成を終了してもアクセサリーの名前が $ S $ とならないときは $ -1 $ を $ 1 $ 行に出力せよ。出力の末尾にも改行を入れること。

## 说明/提示

### Sample Explanation 1

\- 手順 $ 1 $ の直後にアクセサリーの作成を終了したときのアクセサリーの名前は `abc` となる。

### Sample Explanation 2

\- 文字列 `abcabc` はアクセサリーの名前として考えられない。

### Sample Explanation 3

\- 文字列 $ S $ には `a`, `b`, `c` 以外の文字が入ることがある。

## 样例 #1

### 输入

```
3

abc
```

### 输出

```
1
```

## 样例 #2

### 输入

```
6

abcabc
```

### 输出

```
-1
```

## 样例 #3

### 输入

```
7

atcoder
```

### 输出

```
-1
```

## 样例 #4

### 输入

```
19

bcabcabcabcabcabcab
```

### 输出

```
9
```



---

---
title: "[ABC025B] 双子とスイカ割り"
layout: "post"
diff: 普及-
pid: AT_abc025_b
tag: []
---

# [ABC025B] 双子とスイカ割り

## 题目描述

直大和直子是双胞胎兄妹。今天在家中的走廊进行了切西瓜的练习。

走廊的东、西向均无限长，走廊中有一个直大房间的入口。最开始，直大和直子都在直大的房间前。

在切西瓜的练习中，按顺序进行以下 $N$ 次的移动。

第 $i$ 次移动：首先直子指定移动方向和移动距离 $d_i$ 米（方向为东或西），然后直大按直子的指定移动。但是直大不擅长在一次移动中移动少于 $A$ 米或多于 $B$ 米，因此目标移动距离为 $d_i$ 米时，实际移动距离如下：
- $d_i<A$ 时，直大向指定方向移动 $A$ 米。
- $A\leqslant d_i\leqslant B$ 时，直大向指定方向移动 $d_i$ 米。
- $d_i>B$ 时，直大向指定方向移动 $B$ 米。

请问 $N$ 次移动结束后直大在什么位置？

## 输入格式

输入以以下格式从标准输入中读入。


同一行的数据均由空格分隔。

第一行三个整数 $N,A,B$.

接下来 $N$ 行，每行有一个字符串和一个整数，分别表示直子指定的方向与移动距离。移动方向为东时，字符串为```East```;移动方向为西时，字符串为```West```.

## 输出格式

同一行的不同输出间用空格分隔。

当直大的最终位置在直大的房间的东面 $X$ 米时，输出字符串```East```和 $X$.

当直大的最终位置在直大的房间的西面 $X$ 米时，输出字符串```West```和 $X$.

当直大的最终位置在直大的房间前时，输出 $0$.

无论哪种情况，都应在所有输出执行完毕后换行。

## 说明/提示

$1\leqslant N,d_i\leqslant 100$.

$1\leqslant A\leqslant B\leqslant 100$.

$1\leqslant X$.

题目的提示因本题仅涉及加减法，一般不会造成理解错误，故翻译略去。

## 样例 #1

### 输入

```
3 5 10

East 7

West 3

West 11
```

### 输出

```
West 8
```

## 样例 #2

### 输入

```
3 3 8

West 6

East 3

East 1
```

### 输出

```
0
```

## 样例 #3

### 输入

```
5 25 25

East 1

East 1

West 1

East 100

West 1
```

### 输出

```
East 25
```



---

---
title: "[ABC032B] 高橋君とパスワード"
layout: "post"
diff: 普及-
pid: AT_abc032_b
tag: []
---

# [ABC032B] 高橋君とパスワード

## 题目描述

高桥君的公司里有一个秘密的金库。由于这个金库需要密码才能进入，而高桥君已经忘记了这个密码。但是幸运的是，他的手边有这个密码的提示，提示是以下这样写的。


- 密码为这张纸上写着的字符串s的长为k的某个子串。

高桥君只需试完所有可能的密码就能打开金库，他因此很高兴~但是，字符串s非常长因此密码的可能情况有很多种。很明显，重复的密码没有必要再试一遍。所有在亲自将所有密码试一遍之前，需要数出有多少种不同的密码。

你的任务就是将给定的字符串s中需要试的相异密码的个数告诉高桥君。

字符串s的“子串”指，字符串s里所含的一段区间的字符取出所得字符串。例如：$abc$的子串有：$a$,$b$,$c$,$ab$,$bc$,$abc$。而请注意，像$ac$或$ba$这样的字符串并非$abc$的子串。

## 输入格式

输入遵从以下形式：

  $ s $  
  $ k $  
  
- 第一行给定的是纸上写有的字符串s，也就是密码的提示。$(1≤length(s)≤300)$s中只含a-z小写英文字母。
- 第二行给定的是密码的长度k$(1≤k≤300)$。k可能比s的长度更大。

## 输出格式

输出按照以下格式。

在第一行输出可能的密码总数。别忘了在最后换行。

# 输入输出样例

## 输入样例#1： 
```
abcabc
2
```
## 输出样例#1： 
```
3
```
## 输入样例#2： 
```
aaaaa
1
```
## 输出样例#2： 
```
1
```
## 输入样例#3： 
```
hello
10
```
## 输出样例#3： 
```
```

翻译提供者：Delva000

## 样例 #1

### 输入

```
abcabc

2
```

### 输出

```
3
```

## 样例 #2

### 输入

```
aaaaa

1
```

### 输出

```
1
```

## 样例 #3

### 输入

```
hello

10
```

### 输出

```
0
```



---

---
title: "[ABC036B] 回転"
layout: "post"
diff: 普及-
pid: AT_abc036_b
tag: []
---

# [ABC036B] 回転

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc036/tasks/abc036_b





---

---
title: "[ABC036C] 座圧"
layout: "post"
diff: 普及-
pid: AT_abc036_c
tag: []
---

# [ABC036C] 座圧

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc036/tasks/abc036_c





---

---
title: "[ABC038C] 単調増加"
layout: "post"
diff: 普及-
pid: AT_abc038_c
tag: []
---

# [ABC038C] 単調増加

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc038/tasks/abc038_c

$ N $個の数からなる数列が与えられます。$ i $番目の数を$ a_i $と呼びましょう。

$ a_l,a_{l+1},...,a_r $ が単調増加、すなわち $ l≦r $ であって $ a_i\ <\ a_{i+1} $ が$ l≦i\ <\ r $ を満たす全ての$ i $に対して成り立つような$ (l,r) $の数を求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ a_1 $ $ a_2 $ … $ a_N $

## 输出格式

$ a_l,a_{l+1},...,a_r $ が単調増加となるような$ (l,r) $の数を $ 1 $ 行に出力せよ。

## 说明/提示

### 制約

- $ 1≦N≦10^5 $
- $ 1≦a_i≦10^5 $
- $ a_i $は全て整数である

### 部分点

- $ N\ ≦\ 3,000 $ を満たすテストケース全てに正解した場合、部分点として$ 40 $点が与えられる。

### Sample Explanation 1

条件を満たす$ (l,r) $は$ (1,1),(1,2),(1,3),(2,2),(2,3),(3,3),(4,4),(5,5) $の$ 8 $つです。

### Sample Explanation 2

$ 1≦l≦r≦N $を満たす$ (l,r) $全てが条件を満たします。

### Sample Explanation 3

例えば、$ 3,\ 3,\ 4 $はこの問題で単調増加ではないことに注意してください。

## 样例 #1

### 输入

```
5

1 2 3 2 1
```

### 输出

```
8
```

## 样例 #2

### 输入

```
4

1 2 3 4
```

### 输出

```
10
```

## 样例 #3

### 输入

```
6

3 3 4 1 2 2
```

### 输出

```
8
```

## 样例 #4

### 输入

```
6

1 5 2 3 4 2
```

### 输出

```
10
```



---

---
title: "[ABC040B] □□□□□"
layout: "post"
diff: 普及-
pid: AT_abc040_b
tag: []
---

# [ABC040B] □□□□□

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc040/tasks/abc040_b

高橋君は大きさ $ 1 $ メートル四方のタイルを $ n $ 枚持っています。

高橋君はこれらのタイルのうちいくつかを、重ならないように隙間なく並べて大きな長方形を作ろうとしています。

出来上がる長方形はできるだけ正方形に近いほうがよいですが、同時に、使わずに余るタイルの枚数ができるだけ少なくなるようにしたいと考えています。

長方形の縦と横の長さの差の絶対値と、余ったタイルの枚数の和を最小でいくつにできるでしょうか。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ n $

## 输出格式

求めた最小値を $ 1 $ 行に出力せよ。

## 说明/提示

### 制約

- $ 1\ ≦\ n\ ≦\ 100,000 $

### Sample Explanation 1

$ 5\ \times\ 5 $ の正方形になるように並べると、縦横の長さの差が $ 0 $ で、余るタイルの枚数が $ 1 $ となり、その和は $ 1 $ です。 $ 26 $ 枚のタイルを余らせることなく使い正方形を作ることはできないので、答えは $ 1 $ となります。

### Sample Explanation 2

この場合、$ 5\ \times\ 8 $ の長方形を作ってタイルを $ 1 $ 枚余らせるのが最適です。

## 样例 #1

### 输入

```
26
```

### 输出

```
1
```

## 样例 #2

### 输入

```
41
```

### 输出

```
4
```

## 样例 #3

### 输入

```
100000
```

### 输出

```
37
```



---

---
title: "[ABC046B] AtCoDeerくんとボール色塗り"
layout: "post"
diff: 普及-
pid: AT_abc046_b
tag: []
---

# [ABC046B] AtCoDeerくんとボール色塗り

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc046/tasks/abc046_b

シカのAtCoDeerくんは一列に並んだ $ N $ 個のボールをそれぞれ $ K $ 色のペンキの色のうちのどれかで塗ろうとしています。見栄えが悪くならないように、隣り合ったボールは別の色で塗ることにします。ボールの塗り方としてあり得るものの個数を求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ K $

## 输出格式

ボールの塗り方としてあり得るものの個数を出力せよ。

## 说明/提示

### 制約

- $ 1≦N≦1000 $
- $ 2≦K≦1000 $
- 答えは $ 2^{31}-1 $ 以下

### Sample Explanation 1

色を$ 0 $,$ 1 $で表すと、左のボールを$ 0 $で塗り、右のボールを$ 1 $で塗る という方法と、 左のボールを$ 1 $で塗り、右のボールを$ 0 $で塗る という方法の$ 2 $通りがあります。

### Sample Explanation 2

ボールは一つしか無いため,$ 10 $色のうちどれを使っても良いので答えは$ 10 $通りです。

## 样例 #1

### 输入

```
2 2
```

### 输出

```
2
```

## 样例 #2

### 输入

```
1 10
```

### 输出

```
10
```

## 样例 #3

### 输入

```
10 8
```

### 输出

```
322828856
```



---

---
title: "[ABC047B] すぬけ君の塗り絵 2 イージー"
layout: "post"
diff: 普及-
pid: AT_abc047_b
tag: []
---

# [ABC047B] すぬけ君の塗り絵 2 イージー

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc047/tasks/abc047_b

$ xy $ 平面上に、左下の座標が $ (0,\ 0) $、右上の座標が $ (W,\ H) $ で、各辺が $ x $ 軸か $ y $ 軸に平行な長方形があります。最初、長方形の内部は白く塗られています。

すぬけ君はこの長方形の中に $ N $ 個の点を打ちました。$ i $ 個目 ($ 1\ ≦\ i\ ≦\ N $) 点の座標は $ (x_i,\ y_i) $ でした。

また、すぬけ君は長さ $ N $ の数列 $ a $ を決めて、各 $ 1\ ≦\ i\ ≦\ N $ に対し、

- $ a_i\ =\ 1 $ のときは長方形の $ x\ <\ x_i $ をみたす領域
- $ a_i\ =\ 2 $ のときは長方形の $ x\ >\ x_i $ をみたす領域
- $ a_i\ =\ 3 $ のときは長方形の $ y\ <\ y_i $ をみたす領域
- $ a_i\ =\ 4 $ のときは長方形の $ y\ >\ y_i $ をみたす領域

を黒く塗りました。

塗りつぶしが終わったあとの長方形内での白い部分の面積を求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ W $ $ H $ $ N $ $ x_1 $ $ y_1 $ $ a_1 $ $ x_2 $ $ y_2 $ $ a_2 $ $ : $ $ x_N $ $ y_N $ $ a_N $

## 输出格式

塗りつぶしが終わったあとの長方形内での白い部分の面積を出力せよ。

## 说明/提示

### 制約

- $ 1\ ≦\ W,\ H\ ≦\ 100 $
- $ 1\ ≦\ N\ ≦\ 100 $
- $ 0\ ≦\ x_i\ ≦\ W $ ($ 1\ ≦\ i\ ≦\ N $)
- $ 0\ ≦\ y_i\ ≦\ H $ ($ 1\ ≦\ i\ ≦\ N $)
- $ W $, $ H $ (21:32 追記), $ x_i $, $ y_i $ は整数である
- $ a_i $ ($ 1\ ≦\ i\ ≦\ N $) は $ 1,\ 2,\ 3,\ 4 $ のいずれかである

### Sample Explanation 1

すぬけ君が塗りつぶしを始める前の長方形は以下の図のようになっています。 !\[e19e673abcd0882783f635cce9d2f94d.png\](https://atcoder.jp/img/abc047/e19e673abcd0882783f635cce9d2f94d.png) $ (x_1,\ y_1)\ =\ (2,\ 1) $、$ a_1\ =\ 1 $ なので、まずすぬけ君は $ x $ 座標が $ 2 $ より小さい領域を塗りつぶし、長方形は以下のようになります。 !\[f25cd04bbac23c4e5426d70511a9762f.png\](https://atcoder.jp/img/abc047/f25cd04bbac23c4e5426d70511a9762f.png) $ (x_2,\ y_2)\ =\ (3,\ 3) $、$ a_2\ =\ 4 $ なので、次にすぬけ君は $ y $ 座標が $ 3 $ より大きい領域を塗りつぶし、長方形は最終的に以下のようになります。 !\[46b0c06fd9eee4f148e1f441f7abca53.png\](https://atcoder.jp/img/abc047/46b0c06fd9eee4f148e1f441f7abca53.png) この最終的な状態における白い部分の面積は $ 9 $ なので、出力は $ 9 $ となります。

### Sample Explanation 2

塗りつぶした結果、白い部分が残らないこともありえます。

## 样例 #1

### 输入

```
5 4 2

2 1 1

3 3 4
```

### 输出

```
9
```

## 样例 #2

### 输入

```
5 4 3

2 1 1

3 3 4

1 4 2
```

### 输出

```
0
```

## 样例 #3

### 输入

```
10 10 5

1 6 1

4 1 3

6 9 4

9 4 2

3 1 3
```

### 输出

```
64
```



---

---
title: "[ABC048B] Between a and b ..."
layout: "post"
diff: 普及-
pid: AT_abc048_b
tag: []
---

# [ABC048B] Between a and b ...

## 题目描述

给出两个非负整数 $a$，$b$（$a≤b$）和一个正整数 $x$。请在 $a$ 以上 $b$ 以下（包含 $a$，$b$）的整数中， 找出可被 $x$ 整除的数数量。

## 输入格式

三个数，$a$，$b$，$x$。

## 输出格式

一行，一个整数，在 $a$ 以上 $b$ 以下（包含 $a$，$b$）的整数中可被 $x$ 整除的数数量。

## 说明/提示

$0 ≤ a ≤ b ≤ 10^{18}$，$1 ≤ x ≤ 10^{18}$。

## 样例 #1

### 输入

```
4 8 2
```

### 输出

```
3
```

## 样例 #2

### 输入

```
0 5 1
```

### 输出

```
6
```

## 样例 #3

### 输入

```
9 9 2
```

### 输出

```
0
```

## 样例 #4

### 输入

```
1 1000000000000000000 3
```

### 输出

```
333333333333333333
```



---

---
title: "[ABC051C] Back and Forth"
layout: "post"
diff: 普及-
pid: AT_abc051_c
tag: []
---

# [ABC051C] Back and Forth

## 题目描述

在平面直角坐标系中，有点 $A（sx,sy）$ 和 点 $B（tx,ty）$ 保证 $sx<tx$，$sy<ty$ 并且 $sx,sy,tx,ty$ 都为整数。

在 $A$ 点有一只海豚，它每次可以向上下左右其中一个方向移动一个单位长度。这只海豚想从 $A$ 点到 $B$ 点再回到 $A$ 点再到 $B$ 点再回到 $A$ 点。

要求：除了 $A,B$ 点以外，所有格点都不能走第二遍。海豚不能斜着走。

输出一个字符串 `S` 表示海豚的最短路径，
`S` 中只包括 $U,R,D,L$。
- $U$：向上走一个单位长度。 
- $R$：向右走一个单位长度。 
- $D$：向下走一个单位长度。 
- $L$：向左走一个单位长度。

## 输入格式

一行，$sx,sy,tx,ty$。

## 输出格式

一行，字符串 `S`。

如果有多个最短路径，输出其中任意一个。

Translate by @sqh_let_it_be

## 样例 #1

### 输入

```
0 0 1 2
```

### 输出

```
UURDDLLUUURRDRDDDLLU
```

## 样例 #2

### 输入

```
-2 -2 1 1
```

### 输出

```
UURRURRDDDLLDLLULUUURRURRDDDLLDL
```



---

---
title: "[ABC056B] NarrowRectanglesEasy"
layout: "post"
diff: 普及-
pid: AT_abc056_b
tag: []
---

# [ABC056B] NarrowRectanglesEasy

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc056/tasks/abc056_b

シカのAtCoDeerくんは縦の長さ $ 1 $、横の長さ $ W $ の形をした長方形が二つ机に置いてあるのを見つけました。 机を二次元平面とみなすと、以下の図のように、一つ目の長方形は 縦は $ [0,1] $ の範囲を、横は $ [a,a+W] $ の範囲を占めており、二つ目の長方形は縦は $ [1,2] $ の範囲を、横は $ [b,b+W] $ の範囲を占めています。

![](https://cdn.luogu.com.cn/upload/vjudge_pic/AT_abc056_b/68a8078bba22e318c7b5c2dbb4f781f4c60ac220.png)

AtCoDeerくんは二つ目の長方形を横に動かすことで、一つ目の長方形と連結にしようと考えました。 長方形を横に動かさないといけない距離の最小値を求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ W $ $ a $ $ b $

## 输出格式

横に動かす必要のある距離の最小値を出力せよ。

## 说明/提示

### 制約

- 入力は全て整数である。
- $ 1≦W≦10^5 $
- $ 1≦a,b≦10^5 $

### Sample Explanation 1

問題文中の図のようになっています。この場合左に $ 1 $ 動かすのが最小です。

### Sample Explanation 2

はじめから連結になっているため、動かす必要はありません。

## 样例 #1

### 输入

```
3 2 6
```

### 输出

```
1
```

## 样例 #2

### 输入

```
3 1 3
```

### 输出

```
0
```

## 样例 #3

### 输入

```
5 10 1
```

### 输出

```
4
```



---

---
title: "[ABC061C] Big Array"
layout: "post"
diff: 普及-
pid: AT_abc061_c
tag: []
---

# [ABC061C] Big Array

## 题目描述

## 题目翻译
有一个数组S，一开始是空的。接下来对这个数组进行N次插入操作.
第ii次操作会向数组中加入$b_i$
 个整数$a_i$
 ，然后将整个数组从小到大排一次序。
求N次操作后, 数组中的第K个数。
例如S=\{1,2,2,3,3,3\}时, 从小到大排序后第4个数是3。

## 输入格式

第1行, 包含两个整数N,K用空格分隔.

第2行到第N+1行, 每行包含两个整数
 $a_i$,$b_i$

## 输出格式

输出N次操作后集合中第K小的数.

## 说明/提示

*  	1≦N≦$10^5$ 
*  	1≦$a_i$ ,$b_i$ ≦$10^5$ 
*  	1≦K≦$b_1$+...+$b_n$
*	所有输入值都是整数。
------------
题目翻译者UID：370640

## 样例 #1

### 输入

```
3 4

1 1

2 2

3 3
```

### 输出

```
3
```

## 样例 #2

### 输入

```
10 500000

1 100000

1 100000

1 100000

1 100000

1 100000

100000 100000

100000 100000

100000 100000

100000 100000

100000 100000
```

### 输出

```
1
```



---

---
title: "[ABC064C] Colorful Leaderboard"
layout: "post"
diff: 普及-
pid: AT_abc064_c
tag: []
---

# [ABC064C] Colorful Leaderboard

## 题目描述

(ABC064 Task - C) 

## 多彩排行榜



在AtCoder中，参加比赛的人名字会变成一种颜色，对应于该人的评级如下：

```
Rating 1 - 399：灰名  
Rating 400 - 799：棕名  
Rating 800 - 1199：绿名  
Rating 1200 - 1599：青名  
Rating 1600 - 1999：蓝名  
Rating 2000 - 2399：黄名  
Rating 2400 - 2799：橙名  
Rating 2800 - 3199：红名  
```
除了上述之外，Rating 为 3200 及以上的人可以自由地选择 TA 的颜色，可以是上面八种颜色中的一种颜色。
目前，有 $N$ 个用户参加过 AtCoder 的比赛，第i个用户的评分是 $a_i$。
查找用户的不同颜色的最小和最大可能数量。



在AtCoder中，参加比赛的人名字会变成一种颜色，对应于该人的评级如下：


Rating 1 - 399：灰名  
Rating 400 - 799：棕名  
Rating 800 - 1199：绿名  
Rating 1200 - 1599：青名  
Rating 1600 - 1999：蓝名  
Rating 2000 - 2399：黄名  
Rating 2400 - 2799：橙名  
Rating 2800 - 3199：红名  

除了上述之外，Rating 为 3200 及以上的人可以自由地选择 TA 的颜色，可以是上面八种颜色中的一种颜色。
目前，有 $N$ 个用户参加过 AtCoder 的比赛，第i个用户的评分是 $a_i$。
查找用户的不同颜色的最小和最大可能数量。

## 输入格式

输入由标准输入以下列格式给出：

 $ N $  
 $ a_1 $   $ a_2 $   $ ... $   $ a_N $  

输入由标准输入以下列格式给出：

 $ N $  
 $ a_1 $   $ a_2 $   $ ... $   $ a_N $

## 输出格式

输出不同名字颜色的用户的最小可能数量，以及不同颜色的最大可能数量，中间有空格。

输出不同名字颜色的用户的最小可能数量，以及不同颜色的最大可能数量，中间有空格。

## 说明/提示

$1≤n≤100$  
$1≤a_i≤4800$  
$a_i$ 是一个整数。

## Markdown 源码
```
(ABC064 Task - C) 

## 多彩排行榜



$1≤n≤100$  
$1≤a_i≤4800$  
$a_i$ 是一个整数。


```

## 样例 #1

### 输入

```
4

2100 2500 2700 2700
```

### 输出

```
2 2
```

## 样例 #2

### 输入

```
5

1100 1900 2800 3200 3200
```

### 输出

```
3 5
```

## 样例 #3

### 输入

```
20

800 810 820 830 840 850 860 870 880 890 900 910 920 930 940 950 960 970 980 990
```

### 输出

```
1 1
```



---

---
title: "[ABC064D] Insertion"
layout: "post"
diff: 普及-
pid: AT_abc064_d
tag: []
---

# [ABC064D] Insertion

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc064/tasks/abc064_d

`(` と `)` で構成される $ N $ 文字の文字列 $ S $ が与えられる。$ S $ にいくつかの `(` または `)` を挿入することで正しい括弧列を作りたい。  
 ただし、正しい括弧列は次のように定義されている：

- `()` は正しい括弧列である。
- $ X $ が正しい括弧列であるとき、`(`、$ X $、`)` をこの順につなげたものは正しい括弧列である。
- $ X $、$ Y $ が正しい括弧列であるとき、$ X $ と $ Y $ をこの順につなげたものは正しい括弧列である。
- それ以外の括弧列は正しくない。

そのとき、作れる最も文字数が少ない正しい括弧列を求めなさい。このようなものが複数ある場合は、辞書順最小のものを求めなさい。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ S $

## 输出格式

$ S $ から `(`、`)` を挿入していったときに作れる最小の長さの正しい括弧列のなかで辞書順最小の文字列を出力しなさい。

## 说明/提示

### 制約

- $ S $ の長さは $ N $ である。
- $ 1\ <\ =\ N\ <\ =\ 100 $
- $ S $ は `(` と `)` のみで構成されている。

## 样例 #1

### 输入

```
3

())
```

### 输出

```
(())
```

## 样例 #2

### 输入

```
6

)))())
```

### 输出

```
(((()))())
```

## 样例 #3

### 输入

```
8

))))((((
```

### 输出

```
(((())))(((())))
```



---

---
title: "[ABC068B] Break Number"
layout: "post"
diff: 普及-
pid: AT_abc068_b
tag: []
---

# [ABC068B] Break Number

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc068/tasks/abc068_b

高橋君は $ 2 $ で割れる数が好きです。

正整数 $ N $ が与えられるので、$ 1 $ 以上 $ N $ 以下の整数のうち、最も $ 2 $ で割れる回数が多いものを求めてください。答えは必ず $ 1 $ つに定まります。

なお、$ 2 $ で割っていき、何回あまりが出ずに割れるかを、$ 2 $ で割れる回数と呼ぶことにします。

例えば

- $ 6 $ ならば、$ 6 $ -&gt; $ 3 $で、$ 1 $ 回 $ 2 $ で割れます。
- $ 8 $ ならば、$ 8 $ -&gt; $ 4 $ -&gt; $ 2 $ -&gt; $ 1 $で、$ 3 $ 回 $ 2 $ で割れます。
- $ 3 $ ならば、$ 0 $ 回 $ 2 $ で割れます。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $

## 输出格式

問題の答えを出力する。

## 说明/提示

### 制約

- $ 1\ ≦\ N\ ≦\ 100 $

### Sample Explanation 1

$ 4 $ は $ 2 $ 回 $ 2 $ で割ることができ、これは $ 1 $, $ 2 $, ..., $ 7 $ の中で最も多いです。

## 样例 #1

### 输入

```
7
```

### 输出

```
4
```

## 样例 #2

### 输入

```
32
```

### 输出

```
32
```

## 样例 #3

### 输入

```
1
```

### 输出

```
1
```

## 样例 #4

### 输入

```
100
```

### 输出

```
64
```



---

---
title: "[ABC084C] Special Trains"
layout: "post"
diff: 普及-
pid: AT_abc084_c
tag: []
---

# [ABC084C] Special Trains

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc084/tasks/abc084_c

Atcoder国に、 $ 1 $ 本の東西方向に走る鉄道が完成しました。

この鉄道には $ N $ 個の駅があり、西から順に $ 1 $,$ 2 $,$ ... $,$ N $ の番号がついています。

明日、鉄道の開通式が開かれます。

この鉄道では、$ 1≦i≦N-1 $ を満たす全ての整数 $ i $ に対して、駅 $ i $ から駅 $ i+1 $ に、$ C_i $ 秒で向かう列車が運行されます。ただし、これら以外の列車は運行されません。

駅 $ i $ から駅 $ i+1 $ に移動する列車のうち最初の列車は、開通式開始 $ S_i $ 秒後に駅 $ i $ を発車し、その後は $ F_i $ 秒おきに駅 $ i $ を発車する列車があります。

また、$ S_i $ は $ F_i $ で割り切れることが保証されます。

つまり、$ A％B $ で $ A $ を $ B $ で割った余りを表すとき、$ S_i≦t $,$ t％F_i=0 $ を満たす全ての $ t $ に対してのみ、開通式開始 $ t $ 秒後に駅 $ i $ を出発し、開通式開始 $ t+C_i $ 秒後に駅 $ i+1 $ に到着する列車があります。

列車の乗り降りにかかる時間を考えないとき、全ての駅 $ i $ に対して、開通式開始時に駅 $ i $ にいる場合、駅 $ N $ に到着できるのは最も早くて開通式開始何秒後か、答えてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ C_1 $ $ S_1 $ $ F_1 $ $ : $ $ C_{N-1} $ $ S_{N-1} $ $ F_{N-1} $

## 输出格式

$ i $ 行目 $ (1≦i≦N) $ に、開通式開始時に駅 $ i $ にいる場合、駅 $ N $ に到着できるのが最も早くて開通式開始 $ x $ 秒後のとき、$ x $ を出力せよ。

## 说明/提示

### 制約

- $ 1≦N≦500 $
- $ 1≦C_i≦100 $
- $ 1≦S_i≦10^5 $
- $ 1≦F_i≦100 $
- $ S_i％F_i=0 $
- 入力は全て整数

### Sample Explanation 1

駅 $ 1 $ からは、以下のように移動します。 - 開通式開始 $ 5 $ 秒後に、駅 $ 2 $ に向かう列車に乗る。 - 開通式開始 $ 11 $ 秒後に、駅 $ 2 $ に到着する。 - 開通式開始 $ 11 $ 秒後に、駅 $ 3 $ に向かう列車に乗る。 - 開通式開始 $ 12 $ 秒後に、駅 $ 3 $ に到着する。 駅 $ 2 $ からは、以下のように移動します。 - 開通式開始 $ 10 $ 秒後に、駅 $ 3 $ に向かう列車に乗る。 - 開通式開始 $ 11 $ 秒後に、駅 $ 3 $ に到着する。 駅 $ 3 $ に対しても、$ 0 $ を出力しなければならないことに注意してください。

## 样例 #1

### 输入

```
3

6 5 1

1 10 1
```

### 输出

```
12

11

0
```

## 样例 #2

### 输入

```
4

12 24 6

52 16 4

99 2 2
```

### 输出

```
187

167

101

0
```

## 样例 #3

### 输入

```
4

12 13 1

44 17 17

66 4096 64
```

### 输出

```
4162

4162

4162

0
```



---

---
title: "[ABC088C] Takahashi&#39;s Information"
layout: "post"
diff: 普及-
pid: AT_abc088_c
tag: []
---

# [ABC088C] Takahashi&#39;s Information

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc088/tasks/abc088_c

$ 3\ \times\ 3 $ のグリッドがあります. 上から $ i $ 番目で左から $ j $ 番目のマスを $ (i,\ j) $ で表すとき, マス $ (i,\ j) $ には数 $ c_{i,\ j} $ が書かれています.  
 高橋君によると, 整数 $ a_1,\ a_2,\ a_3,\ b_1,\ b_2,\ b_3 $ の値が決まっており, マス $ (i,\ j) $ には数 $ a_i\ +\ b_j $ が書かれているらしいです.  
 高橋君の情報が正しいか判定しなさい.

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ c_{1,1} $ $ c_{1,2} $ $ c_{1,3} $ $ c_{2,1} $ $ c_{2,2} $ $ c_{2,3} $ $ c_{3,1} $ $ c_{3,2} $ $ c_{3,3} $

## 输出格式

高橋君の情報が正しい場合 `Yes`, そうでない場合 `No` と出力してください.

## 说明/提示

### 制約

- $ c_{i,\ j}\ (1\ \leq\ i\ \leq\ 3,\ 1\ \leq\ j\ \leq\ 3) $ は $ 0 $ 以上 $ 100 $ 以下の整数

### Sample Explanation 1

$ a_1=0,a_2=1,a_3=0,b_1=1,b_2=0,b_3=1 $ などの組み合わせがありうるので, 高橋君の情報は正しいです.

### Sample Explanation 2

このグリッドの場合、高橋君の情報は間違っています.

## 样例 #1

### 输入

```
1 0 1

2 1 2

1 0 1
```

### 输出

```
Yes
```

## 样例 #2

### 输入

```
2 2 2

2 1 2

2 2 2
```

### 输出

```
No
```

## 样例 #3

### 输入

```
0 8 8

0 8 8

0 8 8
```

### 输出

```
Yes
```

## 样例 #4

### 输入

```
1 8 6

2 9 7

0 7 7
```

### 输出

```
No
```



---

---
title: "[ABC089C] March"
layout: "post"
diff: 普及-
pid: AT_abc089_c
tag: []
---

# [ABC089C] March

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc089/tasks/abc089_c

$ N $ 人の人がいて、$ i $ 番目の人の名前は $ S_i $ です。

この中から、以下の条件を満たすように $ 3 $ 人を選びたいです。

- 全ての人の名前が `M`,`A`,`R`,`C`,`H` のどれかから始まっている
- 同じ文字から始まる名前を持つ人が複数いない

これらの条件を満たすように $ 3 $ 人を選ぶ方法が何通りあるか、求めてください。ただし、選ぶ順番は考えません。

答えが $ 32 $ bit整数型に収まらない場合に注意してください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ S_1 $ $ : $ $ S_N $

## 输出格式

与えられた条件を満たすように $ 3 $ 人を選ぶ方法が $ x $ 通りのとき、$ x $ を出力せよ。

## 说明/提示

### 制約

- $ 1\ \leq\ N\ \leq\ 10^5 $
- $ S_i $ は英大文字からなる
- $ 1\ \leq\ |S_i|\ \leq\ 10 $
- $ S_i\ \neq\ S_j\ (i\ \neq\ j) $

### Sample Explanation 1

次のような名前の $ 3 $ 人を選ぶと良いです。 - `MASHIKE`,`RUMOI`,`HABORO` - `MASHIKE`,`RUMOI`,`HOROKANAI` よって、$ 2 $ 通りとなります。

### Sample Explanation 2

与えられた条件を満たすように $ 3 $ 人を選ぶ方法が存在しない場合に注意してください。

## 样例 #1

### 输入

```
5

MASHIKE

RUMOI

OBIRA

HABORO

HOROKANAI
```

### 输出

```
2
```

## 样例 #2

### 输入

```
4

ZZ

ZZZ

Z

ZZZZZZZZZZ
```

### 输出

```
0
```

## 样例 #3

### 输入

```
5

CHOKUDAI

RNG

MAKOTO

AOKI

RINGO
```

### 输出

```
7
```



---

---
title: "[ABC091B] Two Colors Card Game"
layout: "post"
diff: 普及-
pid: AT_abc091_b
tag: []
---

# [ABC091B] Two Colors Card Game

## 题目描述

有两组字符串，一组蓝色，一组红色，各有n、m个字符串。你可以随便说一个字符串：



如果你在蓝色的字符串组中找到了这个字符串，就加一分；如果在红色的字符串组中找到了，就扣一分。



现在让你输出得分的最大值，且只有得分非负时才输出。

## 输入格式

输入n，接下来n行输入字符串(s[i])。输入m，接下来m行输入字符串(t[i])

## 输出格式

输出得分的最大值。

## 样例 #1

### 输入

```
3

apple

orange

apple

1

grape
```

### 输出

```
2
```

## 样例 #2

### 输入

```
3

apple

orange

apple

5

apple

apple

apple

apple

apple
```

### 输出

```
1
```

## 样例 #3

### 输入

```
1

voldemort

10

voldemort

voldemort

voldemort

voldemort

voldemort

voldemort

voldemort

voldemort

voldemort

voldemort
```

### 输出

```
0
```

## 样例 #4

### 输入

```
6

red

red

blue

yellow

yellow

red

5

red

red

yellow

green

blue
```

### 输出

```
1
```



---

---
title: "[ABC096C] Grid Repainting 2"
layout: "post"
diff: 普及-
pid: AT_abc096_c
tag: []
---

# [ABC096C] Grid Repainting 2

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc096/tasks/abc096_c

$ H $ 行 $ W $ 列のマス目で表されるキャンバスがあります. 上から $ i $ 番目, 左から $ j $ 番目のマスを $ (i,\ j) $ と表します.  
 最初, すべてのマス目は白色です. square1001 君は, 黒い絵の具を使って絵を描きたいと思いました. 具体的には, square1001 君の目標は, $ s_{i,\ j}= $ `#` のときマス $ (i,\ j) $ を黒色, $ s_{i,\ j}= $ `.` のときマス $ (i,\ j) $ を白色にすることです.  
 しかし, 彼は絵を描くことが得意ではないので, 何回か ($ 0 $ 回でもよい)「上下左右に隣接する $ 2 $ つのマスを選び, 両方黒く塗る」ことしかできません. ただし, すでに黒く塗られているマスを選ぶこともでき, この場合マスの色は黒のまま変わりません.   
 square1001 君が目標を達成することができるか判定してください.

## 输入格式

入力は以下の形式で標準入力から与えられる.

> $ H $ $ W $ $ s_{1,\ 1}\ s_{1,\ 2}\ s_{1,\ 3}\ ...\ s_{1,\ W} $ $ s_{2,\ 1}\ s_{2,\ 2}\ s_{2,\ 3}\ ...\ s_{2,\ W} $ $ : $ $ : $ $ s_{H,\ 1}\ s_{H,\ 2}\ s_{H,\ 3}\ ...\ s_{H,\ W} $

## 输出格式

square1001 君が目標を達成することができるならば `Yes`、達成できないならば `No` と出力しなさい.

## 说明/提示

### 制約

- $ H $ は $ 1 $ 以上 $ 50 $ 以下の整数
- $ W $ は $ 1 $ 以上 $ 50 $ 以下の整数
- すべての $ (i,\ j)\ (1\ \leq\ i\ \leq\ H,\ 1\ \leq\ j\ \leq\ W) $ に対して, $ s_{i,\ j} $ は `#` または `.`

### Sample Explanation 1

目標を達成する手順の一例として, 下の図の方法が挙げられます. この図では, 「次に黒く塗るマス」を「☆」で表しています. !\[ \](https://img.atcoder.jp/abc096/18f94b6627ec5dc8aa4f6d99ae1c8fca.png)

### Sample Explanation 2

square1001 君は目標を達成することができません.

## 样例 #1

### 输入

```
3 3

.#.

###

.#.
```

### 输出

```
Yes
```

## 样例 #2

### 输入

```
5 5

#.#.#

.#.#.

#.#.#

.#.#.

#.#.#
```

### 输出

```
No
```

## 样例 #3

### 输入

```
11 11

...#####...

.##.....##.

#..##.##..#

#..##.##..#

#.........#

#...###...#

.#########.

.#.#.#.#.#.

##.#.#.#.##

..##.#.##..

.##..#..##.
```

### 输出

```
Yes
```



---

---
title: "[ABC098B] Cut and Count"
layout: "post"
diff: 普及-
pid: AT_abc098_b
tag: []
---

# [ABC098B] Cut and Count

## 题目描述

给定一个长度为 $N$ 的字符串 $S$。我们可以在任意一个位置将字符串分割，使它变成两个字符串 $X$ 和 $Y$。现在要求出可能的 $X$ 和 $Y$ 都包含的字符种数的最大值。

## 输入格式

输入 $N$ 和 $S$，格式如下面所示。

> $N$ $S$

## 输出格式

一行，输出可能的 $X$ 和 $Y$ 都包含的字符种数的最大值。

## 说明/提示

- $2\ \le N\ \le 100$
- $|S|\ =\ N$
- $S$ 里的字符均为小写字符。

### 数据解释 1

在 $S$ 的第 $3$ 个字符后切割字符串，此时 $X\ =\ \texttt{aab}$，$Y\ =\ \texttt{bca}$。 它们共同包含的字符有 $\texttt{a}$ 和 $\texttt{b}$ 两种。所以答案为 $2$。

### 数据解释 2

显然，无论怎么切割字符串， $X$ 和 $Y$ 都包含的字符只可能为 $\texttt{a}$。所以答案为 $1$。

## 样例 #1

### 输入

```
6

aabbca
```

### 输出

```
2
```

## 样例 #2

### 输入

```
10

aaaaaaaaaa
```

### 输出

```
1
```

## 样例 #3

### 输入

```
45

tgxgdqkyjzhyputjjtllptdfxocrylqfqjynmfbfucbir
```

### 输出

```
9
```



---

---
title: "[ABC100C] *3 or /2"
layout: "post"
diff: 普及-
pid: AT_abc100_c
tag: []
---

# [ABC100C] *3 or /2

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc100/tasks/abc100_c

AtCoder Beginner Contest 100 の開催にともなって, AtCoder 社では長さ $ N $ の数列 $ a\ = ${$ a_1,\ a_2,\ a_3,\ ...,\ a_N $} が飾られることになった.   
 社員のすぬけ君は, この数列で遊んでみようと思った.

具体的には, 以下の操作をできるだけ多くの回数繰り返そうと思った.

> $ 1\ \leq\ i\ \leq\ N $ を満たす全ての $ i $ に対して, それぞれ「$ a_i $ の値を $ 2 $ で割る」「$ a_i $ の値を $ 3 $ 倍する」のどちらかを行う. ただし, 全ての $ i $ に対して $ 3 $ 倍することはできず, 操作後の $ a_i $ の値は整数でなければならない.

最大で何回の操作が可能か, 求めなさい.

## 输入格式

入力は以下の形式で標準入力から与えられる.

> $ N $ $ a_1 $ $ a_2 $ $ a_3 $ $ ... $ $ a_N $

## 输出格式

すぬけ君が行える最大の操作回数を出力しなさい.

## 说明/提示

### 制約

- $ N $ は $ 1 $ 以上 $ 10\ 000 $ 以下の整数
- $ a_i $ は $ 1 $ 以上 $ 1\ 000\ 000\ 000 $ 以下の整数

### Sample Explanation 1

最初, 数列は $ {5,\ 2,\ 4} $ であるが, 以下のように操作すれば $ 3 $ 回の操作を行うことができる. - 最初に, $ a_1 $ を $ 3 $ 倍し, $ a_2 $ を $ 3 $ 倍し, $ a_3 $ を $ 2 $ で割る. すると数列は $ {15,\ 6,\ 2} $ となる. - 次に, $ a_1 $ を $ 3 $ 倍し, $ a_2 $ を $ 2 $ で割り, $ a_3 $ を $ 3 $ 倍する. すると数列は $ {45,\ 3,\ 6} $ となる. - 最後に, $ a_1 $ を $ 3 $ 倍し, $ a_2 $ を $ 3 $ 倍し, $ a_3 $ を $ 2 $ で割る. すると数列は $ {135,\ 9,\ 3} $ となる.

### Sample Explanation 2

全ての要素が奇数なので, 操作はできない. よって答えは $ 0 $ である.

## 样例 #1

### 输入

```
3

5 2 4
```

### 输出

```
3
```

## 样例 #2

### 输入

```
4

631 577 243 199
```

### 输出

```
0
```

## 样例 #3

### 输入

```
10

2184 2126 1721 1800 1024 2528 3360 1945 1280 1776
```

### 输出

```
39
```



---

---
title: "[ABC105C] Base -2 Number"
layout: "post"
diff: 普及-
pid: AT_abc105_c
tag: []
---

# [ABC105C] Base -2 Number

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc105/tasks/abc105_c

整数 $ N $ が与えられるので、$ N $ の $ -2 $ 進数表現を求めてください。

ここで、$ S $ が $ N $ の $ -2 $ 進数表現であるとは、以下を全て満たすことです。

- $ S $ は `0` および `1` のみからなる文字列である
- $ S\ = $ `0` でなければ $ S $ の先頭の文字は `1` である
- $ S\ =\ S_k\ S_{k-1}\ ...\ S_0 $ とすると、$ S_0\ \times\ (-2)^0\ +\ S_1\ \times\ (-2)^1\ +\ ...\ +\ S_k\ \times\ (-2)^k\ =\ N $ が成り立つ

なお、任意の整数 $ M $ に対して $ M $ の $ -2 $ 進数表現が一意に定まることが証明できます。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $

## 输出格式

$ N $ の $ -2 $ 進数表現を出力せよ。

## 说明/提示

### 制約

- 入力はすべて整数である
- $ -10^9\ \leq\ N\ \leq\ 10^9 $

### Sample Explanation 1

$ (-2)^0\ +\ (-2)^1\ +\ (-2)^3\ =\ 1\ +\ (-2)\ +\ (-8)\ =\ -9 $ なので `1011` は $ -9 $ の $ -2 $ 進数表現です。

## 样例 #1

### 输入

```
-9
```

### 输出

```
1011
```

## 样例 #2

### 输入

```
123456789
```

### 输出

```
11000101011001101110100010101
```

## 样例 #3

### 输入

```
0
```

### 输出

```
0
```



---

---
title: "[ABC106C] To Infinity"
layout: "post"
diff: 普及-
pid: AT_abc106_c
tag: []
---

# [ABC106C] To Infinity

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc106/tasks/abc106_c

Mr. Infinity は, `1` から `9` までの数字からなる文字列 $ S $ を持っている. この文字列は, 日付が変わるたびに次のように変化する.

- 文字列 $ S $ に含まれるそれぞれの `2` が `22`, `3` が `333`, `4` が `4444`, `5` が `55555`, `6` が `666666`, `7` が `7777777`, `8` が `88888888`, `9` が `999999999` に置き換わる. `1` は `1` のまま残る.

例えば, $ S $ が `1324` の場合, 翌日には `1333224444` になり, 翌々日には `133333333322224444444444444444` になる.  
 あなたは $ 5000 $ 兆日後に文字列がどのようになっているか知りたい. $ 5000 $ 兆日後の文字列の左から $ K $ 文字目は何か？

## 输入格式

入力は以下の形式で標準入力から与えられる.

> $ S $ $ K $

## 输出格式

$ 5000 $ 兆日後に Mr. Infinity が持っている文字列の $ K $ 文字目の数字を出力しなさい.

## 说明/提示

### 制約

- $ S $ は $ 1 $ 文字以上 $ 100 $ 文字以下の文字列.
- $ K $ は $ 1 $ 以上 $ 10^{18} $ 以下の整数.
- $ 5000 $ 兆日後の文字列の長さは $ K $ 文字以上である.

### Sample Explanation 1

文字列 $ S $ は次のように変化していく. - 現在: `1214` - $ 1 $ 日後: `12214444` - $ 2 $ 日後: `1222214444444444444444` - $ 3 $ 日後: `12222222214444444444444444444444444444444444444444444444444444444444444444` $ 5000 $ 兆日後の文字列の最初 $ 5 $ 文字は `12222` となる. $ K=4 $ なので, $ 4 $ 文字目の `2` を出力すればよい.

### Sample Explanation 2

文字列ははじめ `3` である. $ 5000 $ 兆日経ったとき, 文字列は `3` だけで構成される.

## 样例 #1

### 输入

```
1214

4
```

### 输出

```
2
```

## 样例 #2

### 输入

```
3

157
```

### 输出

```
3
```

## 样例 #3

### 输入

```
299792458

9460730472580800
```

### 输出

```
2
```



---

---
title: "[ABC107B] Grid Compression"
layout: "post"
diff: 普及-
pid: AT_abc107_b
tag: []
---

# [ABC107B] Grid Compression

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc107/tasks/abc107_b

縦 $ H $ 行、横 $ W $ 列のマス目があります。 上から $ i $ 行目、左から $ j $ 列目のマスを $ (i,\ j) $ と表します。 各マスは白または黒です。 マス目の配色は、$ H $ 行 $ W $ 列の行列 $ (a_{i,\ j}) $ によって与えられます。 $ a_{i,\ j} $ が `.` ならばマス $ (i,\ j) $ は白であり、$ a_{i,\ j} $ が `#` ならばマス $ (i,\ j) $ は黒です。

すぬけ君はこのマス目を圧縮しようとしています。 そのために、白いマスのみからなる行または列が存在する間、次の操作を繰り返し行います。

- 操作: 白いマスのみからなる行または列をひとつ任意に選び、その行または列を取り除いて空白を詰める。

各操作でどの行または列を選ぶかによらず、最終的なマス目は一意に定まることが示せます。 最終的なマス目を求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ H $ $ W $ $ a_{1,\ 1}...a_{1,\ W} $ $ : $ $ a_{H,\ 1}...a_{H,\ W} $

## 输出格式

最終的なマス目を、入力と同様のフォーマットで出力せよ。 ただし、行数および列数は省くこと。 詳しくはサンプルを参照せよ。

## 说明/提示

### 制約

- $ 1\ \leq\ H,\ W\ \leq\ 100 $
- $ a_{i,\ j} $ は `.` または `#` である。
- マス目全体で少なくともひとつは黒いマスが存在する。

### Sample Explanation 1

元のマス目における第 $ 2 $ 行および第 $ 3 $ 列がそれぞれ取り除かれます。

### Sample Explanation 2

白いマスのみからなる行または列が存在しないので、操作は行われません。

## 样例 #1

### 输入

```
4 4

##.#

....

##.#

.#.#
```

### 输出

```
###

###

.##
```

## 样例 #2

### 输入

```
3 3

#..

.#.

..#
```

### 输出

```
#..

.#.

..#
```

## 样例 #3

### 输入

```
4 5

.....

.....

..#..

.....
```

### 输出

```
#
```

## 样例 #4

### 输入

```
7 6

......

....#.

.#....

..#...

..#...

......

.#..#.
```

### 输出

```
..#

#..

.#.

.#.

#.#
```



---

---
title: "[ABC108B] Ruined Square"
layout: "post"
diff: 普及-
pid: AT_abc108_b
tag: []
---

# [ABC108B] Ruined Square

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc108/tasks/abc108_b

$ xy $ 平面上に正方形があり、$ 4 $ つの頂点の座標は反時計回りに順番に $ (x_1,y_1),(x_2,y_2),(x_3,y_3),(x_4,y_4) $ です。 なお、$ x $ 軸は右向きに、$ y $ 軸は上向きに取ることにします。

高橋君は、これら $ 4 $ つの座標のうち $ (x_3,y_3),(x_4,y_4) $ を忘れてしまいました。

$ x_1,x_2,y_1,y_2 $ が与えられるので、$ x_3,y_3,x_4,y_4 $ を復元してください。なお、これらの条件から、$ x_3,y_3,x_4,y_4 $ は一意に存在し、整数となることが証明できます。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ x_1 $ $ y_1 $ $ x_2 $ $ y_2 $

## 输出格式

$ x_3,y_3,x_4,y_4 $ をこの順に整数で出力せよ。

## 说明/提示

### 制約

- $ |x_1|,|y_1|,|x_2|,|y_2|\ \leq\ 100 $
- $ (x_1,y_1) $ ≠ $ (x_2,y_2) $
- 入力はすべて整数である

### Sample Explanation 1

$ 4 $ 点 $ (0,0),(0,1),(-1,1),(-1,0) $ は、この順に正方形を反時計回りに見たときの $ 4 $ 頂点をなします。 $ (x_3,y_3)=(1,1),(x_4,y_4)=(1,0) $ は、頂点が時計回りに並んでいるので適さないことに注意してください。

## 样例 #1

### 输入

```
0 0 0 1
```

### 输出

```
-1 1 -1 0
```

## 样例 #2

### 输入

```
2 3 6 6
```

### 输出

```
3 10 -1 7
```

## 样例 #3

### 输入

```
31 -41 -59 26
```

### 输出

```
-126 -64 -36 -131
```



---

---
title: "[ABC109C] Skip"
layout: "post"
diff: 普及-
pid: AT_abc109_c
tag: []
---

# [ABC109C] Skip

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc109/tasks/abc109_c

数直線上に $ N $ 個の都市があり、$ i $ 番目の都市は座標 $ x_i $ にあります。

あなたの目的は、これら全ての都市を $ 1 $ 度以上訪れることです。

あなたは、はじめに正整数 $ D $ を設定します。

その後、あなたは座標 $ X $ から出発し、以下の移動 $ 1 $、移動 $ 2 $ を好きなだけ行います。

- 移動 $ 1 $: 座標 $ y $ から座標 $ y\ +\ D $ に移動する
- 移動 $ 2 $: 座標 $ y $ から座標 $ y\ -\ D $ に移動する

全ての都市を $ 1 $ 度以上訪れることのできる $ D $ の最大値を求めてください。

ここで、都市を訪れるとは、その都市のある座標に移動することです。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ X $ $ x_1 $ $ x_2 $ $ ... $ $ x_N $

## 输出格式

全ての都市を $ 1 $ 度以上訪れることのできる $ D $ の最大値を出力せよ。

## 说明/提示

### 制約

- 入力はすべて整数である
- $ 1\ \leq\ N\ \leq\ 10^5 $
- $ 1\ \leq\ X\ \leq\ 10^9 $
- $ 1\ \leq\ x_i\ \leq\ 10^9 $
- $ x_i $ はすべて異なる
- $ x_1,\ x_2,\ ...,\ x_N\ \neq\ X $

### Sample Explanation 1

$ D\ =\ 2 $ と設定すれば次のように移動を行うことですべての都市を訪れることができ、これが最大です。 - 移動 $ 2 $ を行い、座標 $ 1 $ に移動する - 移動 $ 1 $ を行い、座標 $ 3 $ に移動する - 移動 $ 1 $ を行い、座標 $ 5 $ に移動する - 移動 $ 1 $ を行い、座標 $ 7 $ に移動する - 移動 $ 1 $ を行い、座標 $ 9 $ に移動する - 移動 $ 1 $ を行い、座標 $ 11 $ に移動する

## 样例 #1

### 输入

```
3 3

1 7 11
```

### 输出

```
2
```

## 样例 #2

### 输入

```
3 81

33 105 57
```

### 输出

```
24
```

## 样例 #3

### 输入

```
1 1

1000000000
```

### 输出

```
999999999
```



---

---
title: "[ABC116C] Grand Garden"
layout: "post"
diff: 普及-
pid: AT_abc116_c
tag: []
---

# [ABC116C] Grand Garden

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc116/tasks/abc116_c

花壇に $ N $ 本の花が咲いており、それぞれ $ 1,2,......,N $ と番号が振られています。最初、全ての花の高さは $ 0 $ です。 数列 $ h=\{h_1,h_2,h_3,......\} $ が入力として与えられます。以下の「水やり」操作を繰り返すことで、すべての $ k(1\ \leqq\ k\ \leqq\ N) $ に対して花 $ k $ の高さを $ h_k $ にしたいです。

- 整数 $ l,r $ を指定する。$ l\ \leqq\ x\ \leqq\ r $ を満たすすべての $ x $ に対して、花 $ x $ の高さを $ 1 $ 高くする。

条件を満たすための最小の「水やり」操作の回数を求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられます。

> $ N $ $ h_1 $ $ h_2 $ $ h_3 $ $ ...... $ $ h_N $

## 输出格式

条件を満たすような最小の「水やり」操作の回数を出力してください。

## 说明/提示

### 制約

- $ 1\ \leqq\ N\ \leqq\ 100 $
- $ 0\ \leqq\ h_i\ \leqq\ 100 $
- 入力はすべて整数である。

### Sample Explanation 1

「水やり」操作の回数は $ 2 $ 回が最小です。 以下が一つの例です。 - $ (l,r)=(1,3) $ の「水やり」操作を行う。 - $ (l,r)=(2,4) $ の「水やり」操作を行う。

## 样例 #1

### 输入

```
4

1 2 2 1
```

### 输出

```
2
```

## 样例 #2

### 输入

```
5

3 1 2 3 1
```

### 输出

```
5
```

## 样例 #3

### 输入

```
8

4 23 75 0 23 96 50 100
```

### 输出

```
221
```



---

---
title: "[ABC117C] Streamline"
layout: "post"
diff: 普及-
pid: AT_abc117_c
tag: []
---

# [ABC117C] Streamline

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc117/tasks/abc117_c

数直線と $ N $ 個のコマを用いて $ 1 $ 人でゲームを行います。

はじめ、これらのコマをそれぞれ好きな整数座標に置きます。

このとき、同じ座標に複数のコマを置いても構いません。

以下の移動を繰り返して、座標 $ X_1,\ X_2,\ ...,\ X_M $ の $ M $ 個の地点全てをいずれかのコマで訪れることが目的です。

**移動**: コマを $ 1 $ つ選び、そのコマの座標を $ x $ とする。そのコマを座標 $ x+1 $ もしくは座標 $ x-1 $ に移動する。

ただし、最初にコマを置いた座標はその時点で訪れたとみなします。

目的を達成するまでに移動を行う回数の最小値を求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ M $ $ X_1 $ $ X_2 $ $ ... $ $ X_M $

## 输出格式

目的を達成するまでに移動を行う回数の最小値を出力せよ。

## 说明/提示

### 制約

- 入力はすべて整数である。
- $ 1\ \leq\ N\ \leq\ 10^5 $
- $ 1\ \leq\ M\ \leq\ 10^5 $
- $ -10^5\ \leq\ X_i\ \leq\ 10^5 $
- $ X_1,\ X_2,\ ...,\ X_M $ は全て異なる。

### Sample Explanation 1

以下の手順で $ 5 $ 回移動を行うと目的を達成でき、このときが最小です。 - はじめに $ 2 $ 個のコマをそれぞれ座標 $ 1 $, 座標 $ 10 $ に置きます。 - 座標 $ 1 $ のコマを座標 $ 2 $ に移動します。 - 座標 $ 10 $ のコマを座標 $ 11 $ に移動します。 - 座標 $ 11 $ のコマを座標 $ 12 $ に移動します。 - 座標 $ 12 $ のコマを座標 $ 13 $ に移動します。 - 座標 $ 13 $ のコマを座標 $ 14 $ に移動します。

## 样例 #1

### 输入

```
2 5

10 12 1 2 14
```

### 输出

```
5
```

## 样例 #2

### 输入

```
3 7

-10 -3 0 9 -100 2 17
```

### 输出

```
19
```

## 样例 #3

### 输入

```
100 1

-100000
```

### 输出

```
0
```



---

---
title: "[ABC118C] Monsters Battle Royale"
layout: "post"
diff: 普及-
pid: AT_abc118_c
tag: []
---

# [ABC118C] Monsters Battle Royale

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc118/tasks/abc118_c

$ N $ 体のモンスターが居て、それぞれ $ 1,\ 2,\ ...,\ N $ と番号付けられています。

はじめ、モンスター $ i $ の体力は $ A_i $ です。

以降、体力が $ 1 $ 以上のモンスターを生きているモンスターと呼びます。

生きているモンスターが $ 1 $ 体になるまで以下を繰り返します。

- ランダムに $ 1 $ 体の生きているモンスターがランダムに別の生きているモンスターに攻撃します。
- その結果、攻撃されたモンスターの体力を攻撃したモンスターの体力と同じ値だけ減らします。

最後に生き残ったモンスターの最終的な体力の最小値を求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ A_1 $ $ A_2 $ $ ... $ $ A_N $

## 输出格式

最後に生き残ったモンスターの最終的な体力の最小値を出力せよ。

## 说明/提示

### 制約

- 入力は全て整数である。
- $ 2\ \leq\ N\ \leq\ 10^5 $
- $ 1\ \leq\ A_i\ \leq\ 10^9 $

### Sample Explanation 1

$ 1 $ 番目のモンスターだけが攻撃し続けた場合、最後に生き残ったモンスターの体力は $ 2 $ となり、このときが最小です。

## 样例 #1

### 输入

```
4

2 10 8 40
```

### 输出

```
2
```

## 样例 #2

### 输入

```
4

5 13 8 1000000000
```

### 输出

```
1
```

## 样例 #3

### 输入

```
3

1000000000 1000000000 1000000000
```

### 输出

```
1000000000
```



---

---
title: "[ABC119C] Synthetic Kadomatsu"
layout: "post"
diff: 普及-
pid: AT_abc119_c
tag: []
---

# [ABC119C] Synthetic Kadomatsu

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc119/tasks/abc119_c

あなたは $ N $ 本の竹を持っています。これらの長さはそれぞれ $ l_1,\ l_2,\ ...,\ l_N $ です (単位: センチメートル)。

あなたの目的は、これらの竹のうち何本か (全部でもよい) を使い、長さが $ A,\ B,\ C $ であるような $ 3 $ 本の竹を得ることです。そのために、以下の三種類の魔法を任意の順に何度でも使うことができます。

- 延長魔法: $ 1 $ *MP* (マジックポイント) を消費し、$ 1 $ 本の竹を選んでその長さを $ 1 $ 増やす。
- 短縮魔法: $ 1 $ MP を消費し、$ 1 $ 本の長さ $ 2 $ 以上の竹を選んでその長さを $ 1 $ 減らす。
- 合成魔法: $ 10 $ MP を消費し、$ 2 $ 本の竹を選んで接続し $ 1 $ 本の竹とする。この新たな竹の長さは接続した $ 2 $ 本の竹の長さの合計に等しい。(以後、この竹に対してさらに魔法を使用することもできる。)

目的を達成するには、最小でいくつの MP が必要でしょうか？

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ A $ $ B $ $ C $ $ l_1 $ $ l_2 $ $ : $ $ l_N $

## 输出格式

目的の達成に必要な MP の最小量を出力せよ。

## 说明/提示

### 制約

- $ 3\ \leq\ N\ \leq\ 8 $
- $ 1\ \leq\ C\ <\ B\ <\ A\ \leq\ 1000 $
- $ 1\ \leq\ l_i\ \leq\ 1000 $
- 入力される値はすべて整数である。

### Sample Explanation 1

長さ $ 98,\ 40,\ 30,\ 21,\ 80 $ の $ 5 $ 本の竹から長さ $ 100,\ 90,\ 80 $ の $ 3 $ 本の竹を得ようとしています。長さ $ 80 $ の竹ははじめから持っており、長さ $ 100,\ 90 $ の竹は次のように魔法を使うと合計 $ 23 $ MP を消費することで得られ、これが最適です。 1. 長さ $ 98 $ の竹に延長魔法を $ 2 $ 回使い、長さ $ 100 $ の竹を得る。(消費 MP: $ 2 $) 2. 長さ $ 40,\ 30 $ の竹に合成魔法を使い、長さ $ 70 $ の竹を得る。(消費 MP: $ 10 $) 3. 長さ $ 21 $ の竹に短縮魔法を $ 1 $ 回使い、長さ $ 20 $ の竹を得る。(消費 MP: $ 1 $) 4. 手順 2. で得た長さ $ 70 $ の竹と手順 3. で得た長さ $ 20 $ の竹に合成魔法を使い、長さ $ 90 $ の竹を得る。(消費 MP: $ 10 $)

### Sample Explanation 2

欲しい長さの竹をすでにすべて持っている場合、必要な MP は $ 0 $ です。このように、必ずしもすべての竹を使う必要はありません。

## 样例 #1

### 输入

```
5 100 90 80

98

40

30

21

80
```

### 输出

```
23
```

## 样例 #2

### 输入

```
8 100 90 80

100

100

90

90

90

80

80

80
```

### 输出

```
0
```

## 样例 #3

### 输入

```
8 1000 800 100

300

333

400

444

500

555

600

666
```

### 输出

```
243
```



---

---
title: "[ABC120C] Unification"
layout: "post"
diff: 普及-
pid: AT_abc120_c
tag: []
---

# [ABC120C] Unification

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc120/tasks/abc120_c

机の上に $ N $ 個のキューブが縦に積まれています。長さ $ N $ の文字列 $ S $ が与えられます。

下から $ i $ 番目のキューブの色は、$ S $ の $ i $ 文字目が `0` のとき赤色、`1` のとき青色です。

あなたは、赤色のキューブと青色のキューブが隣り合っているような部分を選んで、それら $ 2 $ 個のキューブを取り除く操作を何度でも行えます。

このとき、取り除いたキューブの上にあったキューブは真下の物体の上に落下します。

最大で何個のキューブを取り除けるでしょうか。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ S $

## 输出格式

最大で何個のキューブを取り除けるかを出力せよ。

## 说明/提示

### 制約

- $ 1\ \leq\ N\ \leq\ 10^5 $
- $ |S|\ =\ N $
- $ S $ の各文字は `0` または `1` である。

### Sample Explanation 1

以下の順に操作を行うと $ 4 $ 個全てのキューブを取り除けます。 - 下から $ 2 $ 番目のキューブと $ 3 $ 番目のキューブを取り除きます。その結果、下から $ 4 $ 番目のキューブが下から $ 1 $ 番目のキューブの上に落下します。 - 下から $ 1 $ 番目のキューブと $ 2 $ 番目のキューブを取り除きます。

## 样例 #1

### 输入

```
0011
```

### 输出

```
4
```

## 样例 #2

### 输入

```
11011010001011
```

### 输出

```
12
```

## 样例 #3

### 输入

```
0
```

### 输出

```
0
```



---

---
title: "[ABC121C] Energy Drink Collector"
layout: "post"
diff: 普及-
pid: AT_abc121_c
tag: []
---

# [ABC121C] Energy Drink Collector

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc121/tasks/abc121_c

栄養ドリンクにレーティング上昇効果があると聞いた高橋くんは、$ M $ 本の栄養ドリンクを買い集めることにしました。

栄養ドリンクが売られている店は $ N $ 軒あり、$ i $ 軒目の店では $ 1 $ 本 $ A_i $ 円の栄養ドリンクを $ B_i $ 本まで買うことができます。

最小で何円あれば $ M $ 本の栄養ドリンクを買い集めることができるでしょうか。

なお、与えられる入力では、十分なお金があれば $ M $ 本の栄養ドリンクを買い集められることが保証されます。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ M $ $ A_1 $ $ B_1 $ $ A_2 $ $ B_2 $ $ \vdots $ $ A_N $ $ B_N $

## 输出格式

$ M $ 本の栄養ドリンクを買い集めるのに必要な最小の金額を出力せよ。

## 说明/提示

### 制約

- 入力は全て整数である。
- $ 1\ \leq\ N,\ M\ \leq\ 10^5 $
- $ 1\ \leq\ A_i\ \leq\ 10^9 $
- $ 1\ \leq\ B_i\ \leq\ 10^5 $
- $ B_1\ +\ ...\ +\ B_N\ \geq\ M $

### Sample Explanation 1

$ 12 $ 円あれば $ 1 $ 軒目の店で $ 1 $ 本、$ 2 $ 軒目の店で $ 4 $ 本の栄養ドリンクを購入し、合計 $ 5 $ 本の栄養ドリンクを買い集めることができます。一方、$ 11 $ 円以下では $ 5 $ 本の栄養ドリンクを買い集めることができません。

### Sample Explanation 3

出力が $ 32 $ ビット整数型におさまらないことがあります。

## 样例 #1

### 输入

```
2 5

4 9

2 4
```

### 输出

```
12
```

## 样例 #2

### 输入

```
4 30

6 18

2 5

3 10

7 9
```

### 输出

```
130
```

## 样例 #3

### 输入

```
1 100000

1000000000 100000
```

### 输出

```
100000000000000
```



---

---
title: "[ABC126C] Dice and Coin"
layout: "post"
diff: 普及-
pid: AT_abc126_c
tag: []
---

# [ABC126C] Dice and Coin

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc126/tasks/abc126_c

すぬけ君は $ 1 $ 〜 $ N $ の整数が等確率で出る $ N $ 面サイコロと表と裏が等確率で出るコインを持っています。すぬけ君は、このサイコロとコインを使って今から次のようなゲームをします。

1. まず、サイコロを $ 1 $ 回振り、出た目を現在の得点とする。
2. 得点が $ 1 $ 以上 $ K-1 $ 以下である限り、すぬけ君はコインを振り続ける。表が出たら得点は $ 2 $ 倍になり、裏が出たら得点は $ 0 $ になる。
3. 得点が $ 0 $ になった、もしくは $ K $ 以上になった時点でゲームが終了する。このとき、得点が $ K $ 以上である場合すぬけ君の勝ち、 $ 0 $ である場合すぬけ君の負けである。

$ N $ と $ K $ が与えられるので、このゲームですぬけ君が勝つ確率を求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ K $

## 输出格式

すぬけ君が勝つ確率を出力せよ。絶対誤差または相対誤差が $ 10^{-9} $ 以下のとき正解とみなされる。

## 说明/提示

### 制約

- $ 1\ <\ =\ N\ <\ =\ 10^5 $
- $ 1\ <\ =\ K\ <\ =\ 10^5 $
- 入力はすべて整数

### Sample Explanation 1

\- サイコロの出た目が $ 1 $ のとき、得点が $ 10 $ 以上になるためには、 $ 4 $ 回コインを振って $ 4 $ 連続で表が出る必要があります。この確率は、 $ \frac{1}{3}\ \times\ (\frac{1}{2})^4\ =\ \frac{1}{48} $ です。 - サイコロの出た目が $ 2 $ のとき、得点が $ 10 $ 以上になるためには、 $ 3 $ 回コインを振って $ 3 $ 連続で表が出る必要があります。この確率は、 $ \frac{1}{3}\ \times\ (\frac{1}{2})^3\ =\ \frac{1}{24} $ です。 - サイコロの出た目が $ 3 $ のとき、得点が $ 10 $ 以上になるためには、 $ 2 $ 回コインを振って $ 2 $ 連続で表が出る必要があります。この確率は、 $ \frac{1}{3}\ \times\ (\frac{1}{2})^2\ =\ \frac{1}{12} $ です。 よって、すぬけ君が勝つ確率は、 $ \frac{1}{48}\ +\ \frac{1}{24}\ +\ \frac{1}{12}\ =\ \frac{7}{48}\ \simeq\ 0.1458333333 $ です。

## 样例 #1

### 输入

```
3 10
```

### 输出

```
0.145833333333
```

## 样例 #2

### 输入

```
100000 5
```

### 输出

```
0.999973749998
```



---

---
title: "[ABC127C] Prison"
layout: "post"
diff: 普及-
pid: AT_abc127_c
tag: []
---

# [ABC127C] Prison

## 题目描述

我们现在有 $N$ 张ID卡，有 $M$ 道门。

我们有第 $L_i$张、第 $L_i+1$张、…第 $R_i$张ID卡中的一张的时候，我们可以通过第 $i$ 道门。

总共有几张卡符合“只用一张卡就能通过全部门”？

~~好乱~~

## 输入格式

第1行有两个以空格隔开的数：$N$ 和 $M$

第2～M+1行有两个以空格隔开的数：$L_i$ 和 $R_i$

## 输出格式

输出一个整数，为符合“只用一张卡就能通过全部门”这样的ID卡数量

~~好乱~~

## 说明/提示

- 所有输入都是整数
- $1\le N\le 10^5$
- $1\le M\le 10^5$
- $1\le L_i\le R_i\le N$

## 样例解释

### 样例1、样例4（相同的两个样例）

有2张ID卡满足“只用一张卡就能通过全部门”，如下：

- 第1张ID卡不能让我们通过第2道门
- 第2张ID卡能让我们通过所有的门
- 第3张ID卡能让我们通过所有的门
- 第4张ID卡不能让我们通过第1道门

所以总共满足“只用一张卡就能通过全部门”的ID卡数量为2张（第2、3张）

~~还是好乱orz~~

## 样例 #1

### 输入

```
4 2

1 3

2 4
```

### 输出

```
2
```

## 样例 #2

### 输入

```
10 3

3 6

5 7

6 9
```

### 输出

```
1
```

## 样例 #3

### 输入

```
100000 1

1 100000
```

### 输出

```
100000
```



---

---
title: "[ABC128B] Guidebook"
layout: "post"
diff: 普及-
pid: AT_abc128_b
tag: []
---

# [ABC128B] Guidebook

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc128/tasks/abc128_b

あなたは美味しいレストランを紹介する本を書くことにしました。 あなたは $ N $ 個のレストラン、レストラン $ 1 $、レストラン $ 2 $、$ … $、レストラン $ N $ を紹介しようとしています。レストラン $ i $ は $ S_i $ 市にあり、あなたは $ 100 $ 点満点中 $ P_i $ 点と評価しています。 異なる $ 2 $ 個のレストランに同じ点数がついていることはありません。

この本では、次のような順でレストランを紹介しようとしています。

- 市名が辞書順で早いものから紹介していく。
- 同じ市に複数レストランがある場合は、点数が高いものから紹介していく。

この本で紹介される順にレストランの番号を出力してください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ S_1 $ $ P_1 $ $ : $ $ S_N $ $ P_N $

## 输出格式

$ N $ 行出力せよ。$ i $ 行目 ($ 1\ <\ =\ i\ <\ =\ N $) には、$ i $ 番目に紹介されるレストランの番号を出力せよ。

## 说明/提示

### 制約

- $ 1\ <\ =\ N\ <\ =\ 100 $
- $ S $ は英小文字のみからなる長さ $ 1 $ 以上 $ 10 $ 以下の文字列
- $ 0\ <\ =\ P_i\ <\ =\ 100 $
- $ P_i $ は整数
- $ P_i\ ≠\ P_j $ $ (1\ <\ =\ i\ <\ j\ <\ =\ N) $

### Sample Explanation 1

$ 3 $ 種類の市名は辞書順で `kazan` $ < $ `khabarovsk` $ < $ `moscow` です。 それぞれの市について、点数が高いレストランから順に紹介されていきます。よって、レストランは $ 3,4,6,1,5,2 $ の順に紹介されていきます。

## 样例 #1

### 输入

```
6

khabarovsk 20

moscow 10

kazan 50

kazan 35

moscow 60

khabarovsk 40
```

### 输出

```
3

4

6

1

5

2
```

## 样例 #2

### 输入

```
10

yakutsk 10

yakutsk 20

yakutsk 30

yakutsk 40

yakutsk 50

yakutsk 60

yakutsk 70

yakutsk 80

yakutsk 90

yakutsk 100
```

### 输出

```
10

9

8

7

6

5

4

3

2

1
```



---

---
title: "[ABC128C] Switches"
layout: "post"
diff: 普及-
pid: AT_abc128_c
tag: []
---

# [ABC128C] Switches

## 题目描述

有 $n$ 个开关和 $m$ 个灯泡，每个开关都处于“开”和“关”状态中的一种。开关从 $1$ 到 $n$ 编号，灯泡从 $1$ 到 $m$ 编号。

$i$ 号灯泡连接着 $k_i$ 个开关：开关 $s_{i,1}$，$s_{i,2}$，...，$s_{i,k_i}$。当这些开关中，处于“开”状态的开关数量之和模 2 余 $p_i$ 时，这个灯泡就会被点亮。

有多少“开”和“关”的组合，可以点亮所有灯泡？

## 输入格式

输入来自以下格式的标准输入：

---

 $ N $   $ M $ 

$ k_1 $   $ s_{1,1} $   $ s_{1,2} $   $ ... $   $ s_{1,k_1} $ 

$ : $ 

$ k_M $   $ s_{M,1} $   $ s_{M,2} $   $ ... $   $ s_{M,k_M} $ 

$ p_1 $   $ p_2 $   $ ... $   $ p_M $ 

---

## 输出格式

输出一个数，表示有多少总组合方案可以点亮所有灯泡。

## 说明/提示

* $1\le N,M \le 10$

* $1 \le k_i \le N$

* $1 \le s_{i,j} \le N$

* $s_{i,a} \neq s_{i,b} (a \neq b)$

* $p_i$ 只能是 $0$ 或 $1$

* 上述所有值都是整数

#### 样例 1/样例 4

* 灯泡 $1$ 当以下开关里开着的总数是偶数时会亮：开关 $1$ 和 $2$。

* 灯泡 $2$ 当以下开关里开着的总数是奇数是会亮：开关 $2$。

开关 $1$ 和 $2$ 一共组成了四种组合：(开，开)，（开，关），（关，开）和（关，关）。其中只有（开，开）满足要求，所以输出 $1$。

#### 样例 2/样例 5

* 灯泡 $1$ 当以下开关里开着的总数是偶数时会亮：开关 $1$ 和 $2$。

* 灯泡 $2$ 当以下开关里开着的总数是偶数时会亮：开关 $1$。

* 灯泡 $3$ 当以下开关里开着的总数是奇数时会亮：开关 $2$。

为了点亮灯泡 $2$，开关 $1$ 必须是关着的；为了点亮灯泡 $3$，开关 $2$ 必须是开着的。但这样灯泡 $1$ 就不能被点亮了。所以，没有组合能让所有灯泡亮起来，故输出 $0$。

## 样例 #1

### 输入

```
2 2

2 1 2

1 2

0 1
```

### 输出

```
1
```

## 样例 #2

### 输入

```
2 3

2 1 2

1 1

1 2

0 0 1
```

### 输出

```
0
```

## 样例 #3

### 输入

```
5 2

3 1 2 5

2 2 3

1 0
```

### 输出

```
8
```



---

---
title: "[ABC129C] Typical Stairs"
layout: "post"
diff: 普及-
pid: AT_abc129_c
tag: []
---

# [ABC129C] Typical Stairs

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc129/tasks/abc129_c

$ N $ 段の階段があります。高橋君は現在、上り口($ 0 $ 段目)にいます。 高橋君は一歩で $ 1 $ 段か $ 2 $ 段上ることができます。

ただし、$ a_1,a_2,a_3,....a_M $ 段目の床は壊れており、その段に足を踏み入れることは危険です。

壊れている床を踏まないようにしながら、最上段($ N $ 段目)にたどりつくまでの移動方法は何通りあるでしょうか？ 総数を $ 1,000,000,007 $ で割った余りを求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられます。

> $ N $ $ M $ $ a_1 $ $ a_2 $ $ . $ $ . $ $ . $ $ a_M $

## 输出格式

条件を満たすような移動方法の総数を、$ 1,000,000,007 $ で割った余りを出力してください。

## 说明/提示

### 制約

- $ 1\ \leqq\ N\ \leqq\ 10^5 $
- $ 0\ \leqq\ M\ \leqq\ N-1 $
- $ 1\ \leqq\ a_1\ ... $ $  $

### Sample Explanation 1

移動方法は以下の $ 4 $ 通りです。 - $ 0\ \to\ 1\ \to\ 2\ \to\ 4\ \to\ 5\ \to\ 6 $ - $ 0\ \to\ 1\ \to\ 2\ \to\ 4\ \to\ 6 $ - $ 0\ \to\ 2\ \to\ 4\ \to\ 5\ \to\ 6 $ - $ 0\ \to\ 2\ \to\ 4\ \to\ 6 $

### Sample Explanation 2

壊れている床を踏まないような移動方法がない場合もあります。

### Sample Explanation 3

総数を $ 1,000,000,007 $ で割った余りを出力することに注意して下さい。

## 样例 #1

### 输入

```
6 1

3
```

### 输出

```
4
```

## 样例 #2

### 输入

```
10 2

4

5
```

### 输出

```
0
```

## 样例 #3

### 输入

```
100 5

1

23

45

67

89
```

### 输出

```
608200469
```



---

---
title: "[ABC130C] Rectangle Cutting"
layout: "post"
diff: 普及-
pid: AT_abc130_c
tag: []
---

# [ABC130C] Rectangle Cutting

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc130/tasks/abc130_c

平面上に長方形があり、$ 4 $ つの頂点の座標は $ (0,0),(W,0),(W,H),(0,H) $ です。 この長方形の内部または周上の点 $ (x,y) $ が与えられます。$ (x,y) $ を通る直線で長方形を $ 2 $ つの部分に分割するとき、 面積の大きくない方の面積の最大値を求めてください。また、その最大値を達成する分割の方法が複数あるかも判定してください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ W $ $ H $ $ x $ $ y $

## 输出格式

はじめに、面積の大きくない方の面積の最大値を出力せよ。つづいて、その最大値を達成する分割の方法が複数あるなら `1` を、そうでないなら `0` を出力せよ。 出力された面積は、絶対誤差あるいは相対誤差が $ 10^{-9} $ 以下の時正答と判定される。

## 说明/提示

### 制約

- $ 1\ \leq\ W,H\ \leq\ 10^9 $
- $ 0\leq\ x\leq\ W $
- $ 0\leq\ y\leq\ H $
- 入力はすべて整数である

### Sample Explanation 1

直線 $ x=1 $ で分割するのが最適です。また、最適な分割方法はこれ以外には存在しません。

## 样例 #1

### 输入

```
2 3 1 2
```

### 输出

```
3.000000 0
```

## 样例 #2

### 输入

```
2 2 1 1
```

### 输出

```
2.000000 1
```



---

---
title: "[ABC131D] Megalomania"
layout: "post"
diff: 普及-
pid: AT_abc131_d
tag: []
---

# [ABC131D] Megalomania

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc131/tasks/abc131_d

AtCoder王国の王立問題工房でABC管理官の座に就いたキザハシ君は、浮かれるあまり仕事を引き受けすぎてしまいました。

現在の時刻は $ 0 $ です。キザハシ君は $ 1 $ から $ N $ までの番号が振られた $ N $ 件の仕事を持っています。

キザハシ君が仕事 $ i $ を終えるには $ A_i $ 単位時間かかります。また、仕事 $ i $ の〆切は時刻 $ B_i $ であり、これまでに仕事を終わらせる必要があります。時刻 $ B_i $ ちょうどに仕事 $ i $ を終わらせてもかまいません。

キザハシ君は $ 2 $ 件以上の仕事を同時にすることはできませんが、ある仕事を終わらせた直後に別の仕事を始めることはできます。

キザハシ君はすべての仕事を〆切までに終わらせることができるでしょうか。可能ならば `Yes`、不可能ならば `No` を出力してください。

## 输入格式

入力は以下の形式で標準入力から与えられます。

> $ N $ $ A_1 $ $ B_1 $ $ . $ $ . $ $ . $ $ A_N $ $ B_N $

## 输出格式

全ての仕事を〆切までに終わらせることが可能ならば `Yes`、不可能ならば `No` を出力してください。

## 说明/提示

### 制約

- 入力はすべて整数
- $ 1\ \leq\ N\ \leq\ 2\ \times\ 10^5 $
- $ 1\ \leq\ A_i,\ B_i\ \leq\ 10^9\ (1\ \leq\ i\ \leq\ N) $

### Sample Explanation 1

たとえば以下の順番で仕事を行うことで、すべての仕事を達成できます。 - 時刻 $ 0 $ から $ 1 $ までの間、仕事 $ 2 $ を行う。 - 時刻 $ 1 $ から $ 3 $ までの間、仕事 $ 1 $ を行う。 - 時刻 $ 3 $ から $ 7 $ までの間、仕事 $ 4 $ を行う。 - 時刻 $ 7 $ から $ 8 $ までの間、仕事 $ 3 $ を行う。 - 時刻 $ 8 $ から $ 11 $ までの間、仕事 $ 5 $ を行う。 仕事 $ 3 $ は〆切である時刻 $ 8 $ ちょうどに終えていますが、問題ないことに注意してください。

### Sample Explanation 2

どんな順番で仕事をしても、全ての仕事を間に合わせることはできません。

## 样例 #1

### 输入

```
5

2 4

1 9

1 8

4 9

3 12
```

### 输出

```
Yes
```

## 样例 #2

### 输入

```
3

334 1000

334 1000

334 1000
```

### 输出

```
No
```

## 样例 #3

### 输入

```
30

384 8895

1725 9791

170 1024

4 11105

2 6

578 1815

702 3352

143 5141

1420 6980

24 1602

849 999

76 7586

85 5570

444 4991

719 11090

470 10708

1137 4547

455 9003

110 9901

15 8578

368 3692

104 1286

3 4

366 12143

7 6649

610 2374

152 7324

4 7042

292 11386

334 5720
```

### 输出

```
Yes
```



---

---
title: "[ABC132C] Divide the Problems"
layout: "post"
diff: 普及-
pid: AT_abc132_c
tag: []
---

# [ABC132C] Divide the Problems

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc132/tasks/abc132_c

高橋君は、 $ N $ 個の競技プログラミング用の問題をつくりました。 それぞれの問題には $ 1 $ から $ N $ の番号がついており、問題 $ i $ の難易度は整数 $ d_i $ で表されます(大きいほど難しいです)。

高橋君はある整数 $ K $ を決めることで、

- 難易度が $ K $ 以上ならば「 $ ARC $ 用の問題」
- 難易度が $ K $ 未満ならば「 $ ABC $ 用の問題」

という風に、これらの問題を二種類に分類しようとしています。

「$ ARC $ 用の問題」と「$ ABC $ 用の問題」が同じ数になるような整数 $ K $ の選び方は何通りあるでしょうか。

## 输入格式

入力は以下の形式で標準入力から与えられます。

> $ N $ $ d_1 $ $ d_2 $ $ ... $ $ d_N $

## 输出格式

「$ ARC $ 用の問題」と「$ ABC $ 用の問題」が同じ数になるような整数 $ K $ の選び方の数を出力してください。

## 说明/提示

### 制約

- $ 2\ \leqq\ N\ \leqq\ 10^5 $
- $ N $ は偶数である。
- $ 1\ \leqq\ d_i\ \leqq\ 10^5 $
- 入力は全て整数である。

### Sample Explanation 1

$ K=5,6 $ としたとき、問題 $ 1,5,6 $ が「$ ARC $ 用の問題」、問題 $ 2,3,4 $ が「$ ABC $ 用の問題」となり、条件を満たします。 よって、答えは $ 2 $ 通りです。

### Sample Explanation 2

「$ ARC $ 用の問題」と「$ ABC $ 用の問題」が同じ数になるような整数 $ K $ の選び方が存在しない場合もあります。

## 样例 #1

### 输入

```
6

9 1 4 4 6 7
```

### 输出

```
2
```

## 样例 #2

### 输入

```
8

9 1 14 5 5 4 4 14
```

### 输出

```
0
```

## 样例 #3

### 输入

```
14

99592 10342 29105 78532 83018 11639 92015 77204 30914 21912 34519 80835 100000 1
```

### 输出

```
42685
```



---

---
title: "[ABC133B] Good Distance"
layout: "post"
diff: 普及-
pid: AT_abc133_b
tag: []
---

# [ABC133B] Good Distance

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc133/tasks/abc133_b

$ D $ 次元空間上に $ N $ 個の点があります。

$ i $ 番目の点の座標は $ (X_{i1},\ X_{i2},\ ...,\ X_{iD}) $ です。

座標 $ (y_1,\ y_2,\ ...,\ y_D) $ の点と座標 $ (z_1,\ z_2,\ ...,\ z_D) $ の点の距離は $ \sqrt{(y_1\ -\ z_1)^2\ +\ (y_2\ -\ z_2)^2\ +\ ...\ +\ (y_D\ -\ z_D)^2} $ です。

$ i $ 番目の点と $ j $ 番目の点の距離が整数となるような組 $ (i,\ j) $ $ (i\ <\ j) $ はいくつあるでしょうか。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ D $ $ X_{11} $ $ X_{12} $ $ ... $ $ X_{1D} $ $ X_{21} $ $ X_{22} $ $ ... $ $ X_{2D} $ $ \vdots $ $ X_{N1} $ $ X_{N2} $ $ ... $ $ X_{ND} $

## 输出格式

$ i $ 番目の点と $ j $ 番目の点の距離が整数となるような組 $ (i,\ j) $ $ (i\ <\ j) $ の数を出力せよ。

## 说明/提示

### 制約

- 入力は全て整数である。
- $ 2\ \leq\ N\ \leq\ 10 $
- $ 1\ \leq\ D\ \leq\ 10 $
- $ -20\ \leq\ X_{ij}\ \leq\ 20 $
- 同じ座標の点は与えられない。すなわち、$ i\ \neq\ j $ ならば $ X_{ik}\ \neq\ X_{jk} $ なる $ k $ が存在する。

### Sample Explanation 1

以下のように距離が整数となる点の組は $ 1 $ 組です。 - $ 1 $ 番目の点と $ 2 $ 番目の点の距離は $ \sqrt{|1-5|^2\ +\ |2-5|^2}\ =\ 5 $ で、これは整数です。 - $ 2 $ 番目の点と $ 3 $ 番目の点の距離は $ \sqrt{|5-(-2)|^2\ +\ |5-8|^2}\ =\ \sqrt{58} $ で、これは整数ではありません。 - $ 3 $ 番目の点と $ 1 $ 番目の点の距離は $ \sqrt{|-2-1|^2+|8-2|^2}\ =\ 3\sqrt{5} $ で、これは整数ではありません。

## 样例 #1

### 输入

```
3 2

1 2

5 5

-2 8
```

### 输出

```
1
```

## 样例 #2

### 输入

```
3 4

-3 7 8 2

-12 1 10 2

-2 8 9 3
```

### 输出

```
2
```

## 样例 #3

### 输入

```
5 1

1

2

3

4

5
```

### 输出

```
10
```



---

---
title: "[ABC133C] Remainder Minimization 2019"
layout: "post"
diff: 普及-
pid: AT_abc133_c
tag: []
---

# [ABC133C] Remainder Minimization 2019

## 题目描述

给出非负整数 $L$ 和 $R$，在这个区间里选择两个整数 $i$ 和 $j$ 满足 $L\le i < j\le R$。求 $(i\times j)\mod 2019$ 的最小值。

## 输入格式

$L$ 和 $R$

## 输出格式

$(i\times j)\mod 2019$ 的最小值

## 说明/提示

$ 0 \le L < R \le 2 \times 10^9$

## 样例 #1

### 输入

```
2020 2040
```

### 输出

```
2
```

## 样例 #2

### 输入

```
4 5
```

### 输出

```
20
```



---

---
title: "[ABC135C] City Savers"
layout: "post"
diff: 普及-
pid: AT_abc135_c
tag: []
---

# [ABC135C] City Savers

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc135/tasks/abc135_c

$ N+1 $ 個の街があり、$ i $ 番目の街は $ A_i $ 体のモンスターに襲われています。

$ N $ 人の勇者が居て、$ i $ 番目の勇者は $ i $ 番目または $ i+1 $ 番目の街を襲っているモンスターを合計で $ B_i $ 体まで倒すことができます。

$ N $ 人の勇者がうまく協力することで、合計して最大で何体のモンスターを倒せるでしょうか。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ A_1 $ $ A_2 $ $ ... $ $ A_{N+1} $ $ B_1 $ $ B_2 $ $ ... $ $ B_N $

## 输出格式

合計して倒せるモンスターの数の最大値を出力せよ。

## 说明/提示

### 制約

- 入力は全て整数である。
- $ 1\ \leq\ N\ \leq\ 10^5 $
- $ 1\ \leq\ A_i\ \leq\ 10^9 $
- $ 1\ \leq\ B_i\ \leq\ 10^9 $

### Sample Explanation 1

以下のようにモンスターを倒すと、合計 $ 9 $ 体のモンスターを倒すことができ、このときが最大です。 - $ 1 $ 番目の勇者が $ 1 $ 番目の街を襲っているモンスターを $ 2 $ 体、$ 2 $ 番目の街を襲っているモンスターを $ 2 $ 体倒します。 - $ 2 $ 番目の勇者が $ 2 $ 番目の街を襲っているモンスターを $ 3 $ 体、$ 3 $ 番目の街を襲っているモンスターを $ 2 $ 体倒します。

## 样例 #1

### 输入

```
2

3 5 2

4 5
```

### 输出

```
9
```

## 样例 #2

### 输入

```
3

5 6 3 8

5 100 8
```

### 输出

```
22
```

## 样例 #3

### 输入

```
2

100 1 1

1 100
```

### 输出

```
3
```



---

---
title: "[ABC136C] Build Stairs"
layout: "post"
diff: 普及-
pid: AT_abc136_c
tag: []
---

# [ABC136C] Build Stairs

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc136/tasks/abc136_c

左右一列に $ N $ 個のマスが並んでおり、左から $ i $ 番目のマスの高さは $ H_i $ です。

あなたは各マスについて $ 1 $ 度ずつ次のいずれかの操作を行います。

- マスの高さを $ 1 $ 低くする。
- 何もしない。

操作をうまく行うことでマスの高さを左から右に向かって単調非減少にできるか求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ H_1 $ $ H_2 $ $ ... $ $ H_N $

## 输出格式

マスの高さを左から右に向かって単調非減少にできるなら `Yes`、そうでないなら `No` を出力せよ。

## 说明/提示

### 制約

- 入力は全て整数である。
- $ 1\ \leq\ N\ \leq\ 10^5 $
- $ 1\ \leq\ H_i\ \leq\ 10^9 $

### Sample Explanation 1

左から $ 2 $ 番目のマスのみ高さを $ 1 $ 低くすることで目的を達成できます。

## 样例 #1

### 输入

```
5

1 2 1 1 3
```

### 输出

```
Yes
```

## 样例 #2

### 输入

```
4

1 3 2 1
```

### 输出

```
No
```

## 样例 #3

### 输入

```
5

1 2 3 4 5
```

### 输出

```
Yes
```

## 样例 #4

### 输入

```
1

1000000000
```

### 输出

```
Yes
```



---

---
title: "[ABC136D] Gathering Children"
layout: "post"
diff: 普及-
pid: AT_abc136_d
tag: []
---

# [ABC136D] Gathering Children

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc136/tasks/abc136_d

マスの情報を表す、`L` と `R` で構成された文字列 $ S $ が与えられます。

文字列 $ S $ の長さを $ N $ としたとき、$ N $ 個のマスが左右一列に並んでおり、左から $ i $ 番目のマスには $ S $ の左から $ i $ 番目の文字が書かれています。

ただし、左端のマスには必ず `R`、右端のマスには必ず `L` が書かれています。

はじめ、各マスには $ 1 $ 人の子どもが居ます。

子どもたちはそれぞれ次の規則に従った移動を $ 10^{100} $ 回行います。

- 今居るマスに書かれた文字に従って $ 1 $ マス移動する。すなわち、今居るマスに書かれた文字が `L` のとき左隣のマスに、`R` のとき右隣のマスに移動する。

$ 10^{100} $ 回の移動の後に各マスに居る子どもの人数を求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ S $

## 输出格式

$ 10^{100} $ 回の移動の後に各マスに居る子どもの人数を左のマスから順に出力せよ。

## 说明/提示

### 制約

- $ S $ は長さ $ 2 $ 以上 $ 10^5 $ 以下の文字列であり、$ S $ の各文字は `L` または `R` である。
- $ S $ の $ 1 $ 文字目は `R`、$ N $ 文字目は `L` である。

### Sample Explanation 1

\- $ 1 $ 回の移動の後に各マスに居る子どもの人数は左のマスから順に $ 0,\ 2,\ 1,\ 1,\ 1 $ 人です。 - $ 2 $ 回の移動の後に各マスに居る子どもの人数は左のマスから順に $ 0,\ 1,\ 2,\ 1,\ 1 $ 人です。 - この移動を $ 10^{100} $ 回行った後に各マスに居る子どもの人数は左のマスから順に $ 0,\ 1,\ 2,\ 1,\ 1 $ 人です。

## 样例 #1

### 输入

```
RRLRL
```

### 输出

```
0 1 2 1 1
```

## 样例 #2

### 输入

```
RRLLLLRLRRLL
```

### 输出

```
0 3 3 0 0 0 1 1 0 2 2 0
```

## 样例 #3

### 输入

```
RRRLLRLLRRRLLLLL
```

### 输出

```
0 0 3 2 0 2 1 0 0 0 4 4 0 0 0 0
```



---

---
title: "[ABC138C] Alchemist"
layout: "post"
diff: 普及-
pid: AT_abc138_c
tag: []
---

# [ABC138C] Alchemist

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc138/tasks/abc138_c

あなたは鍋と $ N $ 個の具材を持っています。各具材は *価値* と呼ばれる実数の値を持ち、$ i $ 個目 $ (1\ \leq\ i\ \leq\ N) $ の具材の価値は $ v_i $ です。

$ 2 $ 個の具材を鍋に入れると、それらは消滅して新たに $ 1 $ 個の具材が生成されます。この新たな具材の価値は元の $ 2 $ 個の具材の価値を $ x,\ y $ として $ (x\ +\ y)\ /\ 2 $ であり、この具材を再び鍋に入れることもできます。

この具材の合成を $ N\ -\ 1 $ 回行うと、最後に $ 1 $ 個の具材が残ります。この具材の価値として考えられる最大の値を求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ v_1 $ $ v_2 $ $ \ldots $ $ v_N $

## 输出格式

最後に残る $ 1 $ 個の具材の価値として考えられる最大の値を表す小数 (または整数) を出力せよ。

出力は、ジャッジの出力との絶対誤差または相対誤差が $ 10^{-5} $ 以下のとき正解と判定される。

## 说明/提示

### 制約

- $ 2\ \leq\ N\ \leq\ 50 $
- $ 1\ \leq\ v_i\ \leq\ 1000 $
- 入力中の値はすべて整数である。

### Sample Explanation 1

はじめに持っている具材が $ 2 $ 個の場合、それらをともに鍋に入れるほかありません。価値 $ 3,\ 4 $ の具材から合成される具材の価値は $ (3\ +\ 4)\ /\ 2\ =\ 3.5 $ です。 なお、`3.50001`, `3.49999` などと出力しても正解となります。

### Sample Explanation 2

今回ははじめに $ 3 $ 個の具材を持っており、一度目の合成で鍋にどの具材を入れるかに選択の余地があります。選択肢は次の $ 3 $ 通りです。 - 価値 $ 500,\ 300 $ の具材を入れ、価値 $ (500\ +\ 300)\ /\ 2\ =\ 400 $ の具材を合成する。この場合、次の合成ではこれと価値 $ 200 $ の具材を鍋に入れることになり、価値 $ (400\ +\ 200)\ /\ 2\ =\ 300 $ の具材が合成される。 - 価値 $ 500,\ 200 $ の具材を入れ、価値 $ (500\ +\ 200)\ /\ 2\ =\ 350 $ の具材を合成する。この場合、次の合成ではこれと価値 $ 300 $ の具材を鍋に入れることになり、価値 $ (350\ +\ 300)\ /\ 2\ =\ 325 $ の具材が合成される。 - 価値 $ 300,\ 200 $ の具材を入れ、価値 $ (300\ +\ 200)\ /\ 2\ =\ 250 $ の具材を合成する。この場合、次の合成ではこれと価値 $ 500 $ の具材を鍋に入れることになり、価値 $ (250\ +\ 500)\ /\ 2\ =\ 375 $ の具材が合成される。 よって、最後に残る $ 1 $ 個の具材の価値として考えられる最大の値は $ 375 $ です。 なお、`375.0` などと出力しても正解となります。

## 样例 #1

### 输入

```
2

3 4
```

### 输出

```
3.5
```

## 样例 #2

### 输入

```
3

500 300 200
```

### 输出

```
375
```

## 样例 #3

### 输入

```
5

138 138 138 138 138
```

### 输出

```
138
```



---

---
title: "[ABC139D] ModSum"
layout: "post"
diff: 普及-
pid: AT_abc139_d
tag: []
---

# [ABC139D] ModSum

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc139/tasks/abc139_d

整数 $ N $ に対して、$ \{1,\ 2,\ ...,\ N\} $ を並べ替えた数列 $ \{P_1,\ P_2,\ ...,\ P_N\} $ を選びます。

そして、各 $ i=1,2,...,N $ について、$ i $ を $ P_i $ で割った余りを $ M_i $ とします。

$ M_1\ +\ M_2\ +\ \cdots\ +\ M_N $ の最大値を求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $

## 输出格式

$ M_1\ +\ M_2\ +\ \cdots\ +\ M_N $ の最大値を出力せよ。

## 说明/提示

### 制約

- $ N $ は $ 1\ \leq\ N\ \leq\ 10^9 $ を満たす整数である。

### Sample Explanation 1

$ \{1,\ 2\} $ を並び替えた数列として $ \{P_1,\ P_2\}\ =\ \{2,\ 1\} $ を選ぶと、$ M_1\ +\ M_2\ =\ 1\ +\ 0\ =\ 1 $ となります。

## 样例 #1

### 输入

```
2
```

### 输出

```
1
```

## 样例 #2

### 输入

```
13
```

### 输出

```
78
```

## 样例 #3

### 输入

```
1
```

### 输出

```
0
```



---

---
title: "[ABC141D] Powerful Discount Tickets"
layout: "post"
diff: 普及-
pid: AT_abc141_d
tag: []
---

# [ABC141D] Powerful Discount Tickets

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc141/tasks/abc141_d

高橋くんは $ N $ 個の品物を $ 1 $ 個ずつ順番に買う予定です。

$ i $ 番目に買う品物の値段は $ A_i $ 円です。

高橋くんは $ M $ 枚の割引券を持っています。

品物を買う際に割引券を好きな枚数使うことができます。

$ X $ 円の品物を買う際に $ Y $ 枚の割引券を使った場合、その品物を $ \frac{X}{2^Y} $ 円(小数点以下切り捨て)で買うことができます。

最小で何円あれば全ての品物を買うことができるでしょうか。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ M $ $ A_1 $ $ A_2 $ $ ... $ $ A_N $

## 输出格式

全ての品物を買うのに必要なお金の最小値を出力せよ。

## 说明/提示

### 制約

- 入力は全て整数である。
- $ 1\ \leq\ N,\ M\ \leq\ 10^5 $
- $ 1\ \leq\ A_i\ \leq\ 10^9 $

### Sample Explanation 1

以下のように割引券を使えば、合計 $ 9 $ 円で全ての商品を買うことができます。 - $ 1 $ 番目に買う品物には割引券を使わず、$ 2 $ 円で買います。 - $ 2 $ 番目に買う品物には $ 2 $ 枚の割引券を使い、$ 3 $ 円で買います。 - $ 3 $ 番目に買う品物には $ 1 $ 枚の割引券を使い、$ 4 $ 円で買います。

### Sample Explanation 3

$ 1000000000 $ 円の品物を買う際に $ 100000 $ 枚の割引券を使うと $ 0 $ 円で買うことができます。

## 样例 #1

### 输入

```
3 3

2 13 8
```

### 输出

```
9
```

## 样例 #2

### 输入

```
4 4

1 9 3 5
```

### 输出

```
6
```

## 样例 #3

### 输入

```
1 100000

1000000000
```

### 输出

```
0
```

## 样例 #4

### 输入

```
10 1

1000000000 1000000000 1000000000 1000000000 1000000000 1000000000 1000000000 1000000000 1000000000 1000000000
```

### 输出

```
9500000000
```



---

---
title: "[ABC143D] Triangles"
layout: "post"
diff: 普及-
pid: AT_abc143_d
tag: []
---

# [ABC143D] Triangles

## 题目描述

【问题描述】



小$Z$有$N$条木棍，每条木棍的长度为$D_i$。他想在这$N$条木棍中选择三条，让这三条木棍能构成一个三角形。小$Z$想知道有多少种方案能构成三角形（不同的方案定义为一条木棍在其中一个三角形中出现不在另一个中出现）。

## 输入格式

输入第一行一个整数$N$，表示木棍的个数。



第二行$N$个整数$D_i$，表示木棍的长度。

## 输出格式

输出一个整数，表示构成三角形的方案数。

## 说明/提示

样例$1$：只能形成一个三角形：由第一，第二和第三根木棍形成的三角形。



样例$2$：无法形成三角形。



【数据规模与约定】



对于$100\%$的数据，$3 \leq N \le 2×10^3$，$1\le D_i 

\le10^3$。

## 样例 #1

### 输入

```
4

3 4 2 1
```

### 输出

```
1
```

## 样例 #2

### 输入

```
3

1 1000 1
```

### 输出

```
0
```

## 样例 #3

### 输入

```
7

218 786 704 233 645 728 389
```

### 输出

```
23
```



---

---
title: "[ABC144C] Walk on Multiplication Table"
layout: "post"
diff: 普及-
pid: AT_abc144_c
tag: []
---

# [ABC144C] Walk on Multiplication Table

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc144/tasks/abc144_c

高橋君は無限に広い掛け算表の上にいます。

掛け算表のマス $ (i,j) $ には整数 $ i\ \times\ j $ が書かれており、高橋君は最初 $ (1,1) $ にいます。

高橋君は $ 1 $ 回の移動で $ (i,j) $ から $ (i+1,j) $ か $ (i,j+1) $ のどちらかにのみ移ることができます。

整数 $ N $ が与えられるので、$ N $ が書かれているマスに到達するまでに必要な移動回数の最小値を求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $

## 输出格式

整数 $ N $ が書かれているマスに到達するまでに必要な移動回数の最小値を出力せよ。

## 说明/提示

### 制約

- $ 2\ \leq\ N\ \leq\ 10^{12} $
- $ N $ は整数である。

### Sample Explanation 1

$ 5 $ 回の移動で $ (2,5) $ に到達することができます。$ 5 $ 回未満の移動では $ 10 $ が書かれたマスに到達することは出来ません。

### Sample Explanation 2

$ 13 $ 回の移動で $ (5,10) $ に到達できます。

### Sample Explanation 3

入出力とも非常に大きな値になる可能性があります。

## 样例 #1

### 输入

```
10
```

### 输出

```
5
```

## 样例 #2

### 输入

```
50
```

### 输出

```
13
```

## 样例 #3

### 输入

```
10000000019
```

### 输出

```
10000000018
```



---

---
title: "[ABC145C] Average Length"
layout: "post"
diff: 普及-
pid: AT_abc145_c
tag: []
---

# [ABC145C] Average Length

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc145/tasks/abc145_c

座標平面上に $ N $ 個の町があります。町 $ i $ は、座標 ( $ x_i $ , $ y_i $ ) に位置しています。町 $ i $ と町 $ j $ の間の距離は $ \sqrt{\left(x_i-x_j\right)^2+\left(y_i-y_j\right)^2} $ です。

これらの町を全て $ 1 $ 回ずつ訪れるとき、町を訪れる経路は全部で $ N! $ 通りあります。$ 1 $ 番目に訪れる町から出発し、$ 2 $ 番目に訪れる町、$ 3 $ 番目に訪れる町、$ \ldots $、を経由し、$ N $ 番目に訪れる町に到着するまでの移動距離 (町から町への移動は直線移動とします) を、その経路の長さとします。これらの $ N! $ 通りの経路の長さの平均値を計算してください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ x_1 $ $ y_1 $ $ : $ $ x_N $ $ y_N $

## 输出格式

経路の長さの平均値を出力せよ。 出力は、ジャッジの出力との絶対誤差または相対誤差が $ 10^{-6} $ 以下のとき正解と判定される。

## 说明/提示

### 制約

- $ 2\ <\ =\ N\ <\ =\ 8 $
- $ -1000\ <\ =\ x_i\ <\ =\ 1000 $
- $ -1000\ <\ =\ y_i\ <\ =\ 1000 $
- $ \left(x_i,\ y_i\right)\ \neq\ \left(x_j,\ y_j\right) $ ( $ i\ \neq\ j $ のとき)
- (21:12 追記) 入力中の値はすべて整数である。

### Sample Explanation 1

町を訪れる経路は $ 1 $ → $ 2 $ → $ 3 $ , $ 1 $ → $ 3 $ → $ 2 $ , $ 2 $ → $ 1 $ → $ 3 $ , $ 2 $ → $ 3 $ → $ 1 $ , $ 3 $ → $ 1 $ → $ 2 $ , $ 3 $ → $ 2 $ → $ 1 $ の $ 6 $ 通りです。 このうち、経路 $ 1 $ → $ 2 $ → $ 3 $ の長さは、$ \sqrt{\left(0-1\right)^2+\left(0-0\right)^2}\ +\ \sqrt{\left(1-0\right)^2+\left(0-1\right)^2}\ =\ 1+\sqrt{2} $ となります。 同様に他の経路についても長さを計算すると、経路の長さの平均値は、 $ \frac{\left(1+\sqrt{2}\right)+\left(1+\sqrt{2}\right)+\left(2\right)+\left(1+\sqrt{2}\right)+\left(2\right)+\left(1+\sqrt{2}\right)}{6}\ =\ 2.276142... $ であると分かります。

### Sample Explanation 2

町を訪れる経路は $ 1 $ → $ 2 $ , $ 2 $ → $ 1 $ の $ 2 $ 通りありますが、これらの経路の長さは一致します。

## 样例 #1

### 输入

```
3

0 0

1 0

0 1
```

### 输出

```
2.2761423749
```

## 样例 #2

### 输入

```
2

-879 981

-866 890
```

### 输出

```
91.9238815543
```

## 样例 #3

### 输入

```
8

-406 10

512 859

494 362

-955 -475

128 553

-986 -885

763 77

449 310
```

### 输出

```
7641.9817824387
```



---

---
title: "[ABC154D] Dice in Line"
layout: "post"
diff: 普及-
pid: AT_abc154_d
tag: []
---

# [ABC154D] Dice in Line

## 题目描述

给出 $N$ 个骰子，我们同时投掷 $K$ 个连续骰子。求出可能的最大数学期望值。

## 输入格式

第一行两个数，$N$ 和 $K$，含义在描述中给出  
第二行 $N$ 个数，$p_1 \ldots p_N$，代表每一个骰子的面数

## 输出格式

一行一个数，代表最大的数学期望值

## 说明/提示

本题使用**Special Judge**，你的答案和数据误差小于等于$10^{-6}$就会被评判对

## 样例 #1

### 输入

```
5 3

1 2 2 4 5
```

### 输出

```
7.000000000000
```

## 样例 #2

### 输入

```
4 1

6 6 6 6
```

### 输出

```
3.500000000000
```

## 样例 #3

### 输入

```
10 4

17 13 13 12 15 20 10 13 17 11
```

### 输出

```
32.000000000000
```



---

---
title: "[ABC155C] Poll"
layout: "post"
diff: 普及-
pid: AT_abc155_c
tag: []
---

# [ABC155C] Poll

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc155/tasks/abc155_c

$ N $ 枚の投票用紙があり、$ i\ (1\ \leq\ i\ \leq\ N) $ 枚目には文字列 $ S_i $ が書かれています。

書かれた回数が最も多い文字列を全て、辞書順で小さい順に出力してください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ S_1 $ $ : $ $ S_N $

## 输出格式

あてはまる文字列を全て辞書順で小さい順に、改行区切りで出力せよ。

## 说明/提示

### 制約

- $ 1\ \leq\ N\ \leq\ 2\ \times\ 10^5 $
- $ S_i $ は英小文字のみからなる文字列 $ (1\ \leq\ i\ \leq\ N) $
- $ S_i $ の長さは $ 1 $ 以上 $ 10 $ 以下 $ (1\ \leq\ i\ \leq\ N) $

### Sample Explanation 1

書かれた回数は `beet` と `vet` が $ 2 $ 回、`beat` と `bed` と `bet` が $ 1 $ 回です。したがって、$ 2 $ 回書かれた `beet` と `vet` を出力します。

## 样例 #1

### 输入

```
7

beat

vet

beet

bed

vet

bet

beet
```

### 输出

```
beet

vet
```

## 样例 #2

### 输入

```
8

buffalo

buffalo

buffalo

buffalo

buffalo

buffalo

buffalo

buffalo
```

### 输出

```
buffalo
```

## 样例 #3

### 输入

```
7

bass

bass

kick

kick

bass

kick

kick
```

### 输出

```
kick
```

## 样例 #4

### 输入

```
4

ushi

tapu

nichia

kun
```

### 输出

```
kun

nichia

tapu

ushi
```



---

---
title: "[ABC156C] Rally"
layout: "post"
diff: 普及-
pid: AT_abc156_c
tag: []
---

# [ABC156C] Rally

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc156/tasks/abc156_c

数直線上に $ N $ 人の人が住んでいます。

$ i $ 番目の人が住んでいるのは座標 $ X_i $ です。

あなたは $ N $ 人全員が参加する集会を開くことを考えています。

集会は数直線上の任意の **整数値の座標** で開くことができ、座標 $ P $ で集会を開くとき、$ i $ 番目の人は集会に参加するために $ (X_i\ -\ P)^2 $ の体力を消費します。

$ N $ 人が消費する体力の総和としてありえる値の最小値を求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ X_1 $ $ X_2 $ $ ... $ $ X_N $

## 输出格式

$ N $ 人が消費する体力の総和としてありえる値の最小値を出力せよ。

## 说明/提示

### 制約

- 入力は全て整数である。
- $ 1\ \leq\ N\ \leq\ 100 $
- $ 1\ \leq\ X_i\ \leq\ 100 $

### Sample Explanation 1

座標 $ 2 $ で集会を開くとき、$ 1 $ 番目の人が消費する体力は $ (1\ -\ 2)^2\ =\ 1 $、 $ 2 $ 番目の人が消費する体力は $ (4\ -\ 2)^2\ =\ 4 $、よってその総和は $ 5 $ です。 これが $ 2 $ 人が消費する体力の総和としてありえる値の最小値です。 集会を開くことができるのは整数値の座標だけであることに注意してください。

## 样例 #1

### 输入

```
2

1 4
```

### 输出

```
5
```

## 样例 #2

### 输入

```
7

14 14 2 13 56 2 37
```

### 输出

```
2354
```



---

---
title: "[ABC159D] Banned K"
layout: "post"
diff: 普及-
pid: AT_abc159_d
tag: []
---

# [ABC159D] Banned K

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc159/tasks/abc159_d

ボールが $ N $ 個あり、 $ i $ 番目のボールには整数 $ A_i $ が書かれています。  
 $ k=1,2,...,N $ に対して以下の問題を解いて、答えをそれぞれ出力してください。

- $ k $ 番目のボールを除いた $ N-1 $ 個のボールから、書かれている整数が等しいような異なる $ 2 $ つのボールを選び出す方法の数を求めてください。選ぶ順序は考慮しません。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ A_1 $ $ A_2 $ $ ... $ $ A_N $

## 输出格式

$ k=1,2,...,N $ に対する答えを順番に一行ずつ出力せよ。

## 说明/提示

### 制約

- $ 3\ \leq\ N\ \leq\ 2\ \times\ 10^5 $
- $ 1\ \leq\ A_i\ \leq\ N $
- 入力はすべて整数である。

### Sample Explanation 1

例えば $ k=1 $ のとき、残りのボールに書かれている数はそれぞれ $ {1,2,1,2} $ です。 この中から書かれている数が等しいような異なる $ 2 $ つのボールを選び出す方法は $ 2 $ 通りあります。 したがって、 $ k=1 $ に対する問題の答えは $ 2 $ です。

### Sample Explanation 2

どの $ 2 $ つのボールを選び出しても、書かれている数は等しくありません。

### Sample Explanation 3

どの $ 2 $ つのボールを選び出しても、書かれている数が等しいです。

## 样例 #1

### 输入

```
5

1 1 2 1 2
```

### 输出

```
2

2

3

2

3
```

## 样例 #2

### 输入

```
4

1 2 3 4
```

### 输出

```
0

0

0

0
```

## 样例 #3

### 输入

```
5

3 3 3 3 3
```

### 输出

```
6

6

6

6

6
```

## 样例 #4

### 输入

```
8

1 2 1 4 2 1 4 1
```

### 输出

```
5

7

5

7

7

5

7

5
```



---

---
title: "[ABC160D] Line++"
layout: "post"
diff: 普及-
pid: AT_abc160_d
tag: []
---

# [ABC160D] Line++

## 题目描述

## 题意

有一张 $N$ 个点、$N$ 条边的图。

- 对于第 $i$ 个点（$1 \leq i < N$），连一条 $i$ 和 $i+1$ 之间的无向边。

- 再给你两个点 $x, y$ 满足 $y > x + 1$，连一条 $x$ 和 $y$ 之间的无向边。

对于 $k=1, 2, \cdots, n-1$，求图上最短路径为 $k$ 的点对数。

## 输入格式

一行三个整数 $N$, $x$, $y$。

## 输出格式

对于每一个 $k=1, 2, \cdots, n-1$，输出一行表示答案。

## 说明/提示

$3 \leq N \leq 2 \times 10^3$.

$1 \leq x, y \leq N$.

$x + 1 < y$.

所有输入均为整数.

## 样例 #1

### 输入

```
5 2 4
```

### 输出

```
5

4

1

0
```

## 样例 #2

### 输入

```
3 1 3
```

### 输出

```
3

0
```

## 样例 #3

### 输入

```
7 3 7
```

### 输出

```
7

8

4

2

0

0
```

## 样例 #4

### 输入

```
10 4 8
```

### 输出

```
10

12

10

8

4

1

0

0

0
```



---

---
title: "[ABC160E] Red and Green Apples"
layout: "post"
diff: 普及-
pid: AT_abc160_e
tag: []
---

# [ABC160E] Red and Green Apples

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc160/tasks/abc160_e

あなたは、$ X $ 個の赤色のリンゴと $ Y $ 個の緑色のリンゴを食べようとしています。  
 あなたは $ A $ 個の赤色のリンゴを持っており、美味しさはそれぞれ $ p_1,p_2,\ \dots\ ,p_A $ です。  
 あなたは $ B $ 個の緑色のリンゴを持っており、美味しさはそれぞれ $ q_1,q_2,\ \dots\ ,q_B $ です。  
 あなたは $ C $ 個の無色のリンゴを持っており、美味しさはそれぞれ $ r_1,r_2,\ \dots\ ,r_C $ です。  
 無色のリンゴは食べる前に着色することで、赤色のリンゴもしくは緑色のリンゴと見なすことができます。  
 以上のリンゴの中から、できるだけ美味しさの総和が大きくなるように食べるリンゴを選びます。  
 $ 0 $ 個以上の無色のリンゴに適切に着色したとき、食べる $ X+Y $ 個のリンゴの美味しさの総和が最大でいくつになるか求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ X $ $ Y $ $ A $ $ B $ $ C $ $ p_1 $ $ p_2 $ $ ... $ $ p_A $ $ q_1 $ $ q_2 $ $ ... $ $ q_B $ $ r_1 $ $ r_2 $ $ ... $ $ r_C $

## 输出格式

リンゴの美味しさの総和の最大値を出力せよ。

## 说明/提示

### 制約

- $ 1\ \leq\ X\ \leq\ A\ \leq\ 10^5 $
- $ 1\ \leq\ Y\ \leq\ B\ \leq\ 10^5 $
- $ 1\ \leq\ C\ \leq\ 10^5 $
- $ 1\ \leq\ p_i\ \leq\ 10^9 $
- $ 1\ \leq\ q_i\ \leq\ 10^9 $
- $ 1\ \leq\ r_i\ \leq\ 10^9 $
- 入力はすべて整数である。

### Sample Explanation 1

以下のようにすることで、食べるリンゴの美味しさの総和を最大にすることができます。 - $ 2 $ 番目の赤色のリンゴを食べる。 - $ 1 $ 番目の緑色のリンゴを食べる。 - $ 1 $ 番目の無色のリンゴを緑色に着色し、食べる。

## 样例 #1

### 输入

```
1 2 2 2 1

2 4

5 1

3
```

### 输出

```
12
```

## 样例 #2

### 输入

```
2 2 2 2 2

8 6

9 1

2 1
```

### 输出

```
25
```

## 样例 #3

### 输入

```
2 2 4 4 4

11 12 13 14

21 22 23 24

1 2 3 4
```

### 输出

```
74
```



---

---
title: "[ABC161C] Replacing Integer"
layout: "post"
diff: 普及-
pid: AT_abc161_c
tag: []
---

# [ABC161C] Replacing Integer

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc161/tasks/abc161_c

青木君は任意の整数 $ x $ に対し、以下の操作を行うことができます。

操作: $ x $ を $ x $ と $ K $ の差の絶対値で置き換える。

整数 $ N $ の初期値が与えられます。この整数に上記の操作を $ 0 $ 回以上好きな回数行った時にとりうる $ N $ の最小値を求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ K $

## 输出格式

操作を $ 0 $ 回以上好きな回数行った時にとりうる $ N $ の最小値を出力せよ。

## 说明/提示

### 制約

- $ 0\ <\ =\ N\ <\ =\ 10^{18} $
- $ 1\ <\ =\ K\ <\ =\ 10^{18} $
- 入力は全て整数

### Sample Explanation 1

最初、 $ N=7 $ です。 $ 1 $ 回操作を行うと、$ N $ は $ |7-4|\ =\ 3 $ となります。 $ 2 $ 回操作を行うと、$ N $ は $ |3-4|=1 $ となり、これが最小です。

### Sample Explanation 2

$ 1 $ 回も操作を行わなかった場合の $ N=2 $ が最小です。

## 样例 #1

### 输入

```
7 4
```

### 输出

```
1
```

## 样例 #2

### 输入

```
2 6
```

### 输出

```
2
```

## 样例 #3

### 输入

```
1000000000000000000 1
```

### 输出

```
0
```



---

---
title: "[ABC164C] gacha"
layout: "post"
diff: 普及-
pid: AT_abc164_c
tag: []
---

# [ABC164C] gacha

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc164/tasks/abc164_c

くじ引きを $ N $ 回行い、$ i $ 回目には種類が文字列 $ S_i $ で表される景品を手に入れました。

何種類の景品を手に入れましたか？

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ S_1 $ $ : $ $ S_N $

## 输出格式

何種類の景品を手に入れたか出力せよ。

## 说明/提示

### 制約

- $ 1\ \leq\ N\ \leq\ 2\times\ 10^5 $
- $ S_i $ は英小文字のみからなり、長さは $ 1 $ 以上 $ 10 $ 以下

### Sample Explanation 1

`apple` と `orange` の $ 2 $ 種類の景品を手に入れました。

## 样例 #1

### 输入

```
3

apple

orange

apple
```

### 输出

```
2
```

## 样例 #2

### 输入

```
5

grape

grape

grape

grape

grape
```

### 输出

```
1
```

## 样例 #3

### 输入

```
4

aaaa

a

aaa

aa
```

### 输出

```
4
```



---

---
title: "[ABC165D] Floor Function"
layout: "post"
diff: 普及-
pid: AT_abc165_d
tag: []
---

# [ABC165D] Floor Function

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc165/tasks/abc165_d

整数 $ A $, $ B $, $ N $ が与えられます。

$ N $ 以下の非負整数 $ x $ に対する $ floor(Ax/B)\ -\ A\ ×\ floor(x/B) $ の最大値を求めてください。

ただし、$ floor(t) $ とは、実数 $ t $ 以下の最大の整数のことを表します。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ A $ $ B $ $ N $

## 输出格式

$ N $ 以下の非負整数 $ x $ に対する $ floor(Ax/B)\ -\ A\ ×\ floor(x/B) $ の最大値を整数として出力せよ。

## 说明/提示

### 制約

- $ 1\ <\ =\ A\ <\ =\ 10^{6} $
- $ 1\ <\ =\ B\ <\ =\ 10^{12} $
- $ 1\ <\ =\ N\ <\ =\ 10^{12} $
- 入力は全て整数

### Sample Explanation 1

$ x=3 $ のとき、$ floor(Ax/B)-A×floor(x/B)\ =\ floor(15/7)\ -\ 5×floor(3/7)\ =\ 2 $ となり、これが最大です。

## 样例 #1

### 输入

```
5 7 4
```

### 输出

```
2
```

## 样例 #2

### 输入

```
11 10 9
```

### 输出

```
9
```



---

---
title: "[ABC166D] I hate Factorization"
layout: "post"
diff: 普及-
pid: AT_abc166_d
tag: []
---

# [ABC166D] I hate Factorization

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc166/tasks/abc166_d

$ A^5-B^5\ =\ X $ を満たす整数の組 $ (A,B) $ をひとつ示してください。 ただし、与えられる $ X $ に対して、条件を満たす整数の組 $ (A,B) $ が存在することが保証されています。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ X $

## 输出格式

$ A $ と $ B $ を空白区切りで出力せよ。条件を満たす整数の組 $ (A,B) $ が複数存在する場合、どれを出力してもかまわない。

> $ A $ $ B $

## 说明/提示

### 制約

- $ 1\ \leq\ X\ \leq\ 10^9 $
- $ X $ は整数である。
- 条件を満たす整数の組 $ (A,B) $ が存在する。

### Sample Explanation 1

$ A=2,B=-1 $ のとき、$ A^5-B^5 $ の値は $ 33 $ になります。

## 样例 #1

### 输入

```
33
```

### 输出

```
2 -1
```

## 样例 #2

### 输入

```
1
```

### 输出

```
0 -1
```



---

---
title: "[ABC167C] Skill Up"
layout: "post"
diff: 普及-
pid: AT_abc167_c
tag: []
---

# [ABC167C] Skill Up

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc167/tasks/abc167_c

競技プログラミングを始めた高橋くんは、学びたいアルゴリズムが $ M $ 個あります。 最初、各アルゴリズムの理解度は $ 0 $ です。

高橋くんが書店に行くと、$ N $ 冊の参考書が売っていました。$ i $ 番目の参考書 ($ 1\leq\ i\leq\ N $) は $ C_i $ 円で売られていて、購入して読むことで、各 $ j $ ($ 1\leq\ j\leq\ M $) について $ j $ 番目のアルゴリズムの理解度が $ A_{i,j} $ 上がります。 また、それ以外の方法で理解度を上げることはできません。

高橋くんの目標は $ M $ 個すべてのアルゴリズムの理解度を $ X $ 以上にすることです。高橋くんが目標を達成することが可能か判定し、可能な場合は目標を達成するのに必要な金額の最小値を計算してください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ M $ $ X $ $ C_1 $ $ A_{1,1} $ $ A_{1,2} $ $ \cdots $ $ A_{1,M} $ $ C_2 $ $ A_{2,1} $ $ A_{2,2} $ $ \cdots $ $ A_{2,M} $ $ \vdots $ $ C_N $ $ A_{N,1} $ $ A_{N,2} $ $ \cdots $ $ A_{N,M} $

## 输出格式

高橋くんが目標を達成できないならば `-1` を、 そうでなければ目標を達成するのに必要な金額の最小値を出力せよ。

## 说明/提示

### 制約

- 入力はすべて整数
- $ 1\leq\ N,\ M\leq\ 12 $
- $ 1\leq\ X\leq\ 10^5 $
- $ 1\leq\ C_i\ \leq\ 10^5 $
- $ 0\leq\ A_{i,\ j}\ \leq\ 10^5 $

### Sample Explanation 1

$ 2,\ 3 $ 番目の参考書を購入すると $ 120 $ 円ですべてのアルゴリズムの理解度を $ 10 $ 以上にすることができ、これが最小値です。

### Sample Explanation 2

すべての参考書を購入しても $ 1 $ つ目のアルゴリズムの理解度が $ 10 $ に達しません。

## 样例 #1

### 输入

```
3 3 10

60 2 2 4

70 8 7 9

50 2 3 9
```

### 输出

```
120
```

## 样例 #2

### 输入

```
3 3 10

100 3 1 4

100 1 5 9

100 2 6 5
```

### 输出

```
-1
```

## 样例 #3

### 输入

```
8 5 22

100 3 7 5 3 1

164 4 5 2 7 8

334 7 2 7 2 9

234 4 7 2 8 2

541 5 4 3 3 6

235 4 8 6 9 7

394 3 6 1 6 2

872 8 4 3 7 2
```

### 输出

```
1067
```



---

---
title: "[ABC169B] Multiplication 2"
layout: "post"
diff: 普及-
pid: AT_abc169_b
tag: []
---

# [ABC169B] Multiplication 2

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc169/tasks/abc169_b

$ N $ 個の整数 $ A_1,...,A_N $ が与えられます。

$ A_1\ \times\ ...\ \times\ A_N $ を求めてください。

ただし、結果が $ 10^{18} $ を超える場合は、代わりに `-1` を出力してください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ A_1 $ $ ... $ $ A_N $

## 输出格式

値 $ A_1\ \times\ ...\ \times\ A_N $ を整数として出力せよ。ただし、この値が $ 10^{18} $ を超える場合は、代わりに `-1` を出力せよ。

## 说明/提示

### 制約

- $ 2\ \leq\ N\ \leq\ 10^5 $
- $ 0\ \leq\ A_i\ \leq\ 10^{18} $
- 入力は全て整数である。

### Sample Explanation 1

$ 1000000000\ \times\ 1000000000\ =\ 1000000000000000000 $ です。

### Sample Explanation 2

$ 101\ \times\ 9901\ \times\ 999999000001\ =\ 1000000000000000001 $ ですが、これは $ 10^{18} $ を超えるので、代わりに `-1` を出力します。

## 样例 #1

### 输入

```
2

1000000000 1000000000
```

### 输出

```
1000000000000000000
```

## 样例 #2

### 输入

```
3

101 9901 999999000001
```

### 输出

```
-1
```

## 样例 #3

### 输入

```
31

4 1 5 9 2 6 5 3 5 8 9 7 9 3 2 3 8 4 6 2 6 4 3 3 8 3 2 7 9 5 0
```

### 输出

```
0
```



---

---
title: "[ABC169C] Multiplication 3"
layout: "post"
diff: 普及-
pid: AT_abc169_c
tag: []
---

# [ABC169C] Multiplication 3

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc169/tasks/abc169_c

$ A\ \times\ B $ の小数点以下を切り捨て、結果を整数として出力してください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ A $ $ B $

## 输出格式

答えを整数として出力せよ。

## 说明/提示

### 制約

- $ 0\ \leq\ A\ \leq\ 10^{15} $
- $ 0\ \leq\ B\ <\ 10 $
- $ A $ は整数
- $ B $ は小数第 $ 2 $ 位まで与えられる

### Sample Explanation 1

$ 198\ \times\ 1.10\ =\ 217.8 $ なので、小数点以下を切り捨てて答えは $ 217 $ となります。

## 样例 #1

### 输入

```
198 1.10
```

### 输出

```
217
```

## 样例 #2

### 输入

```
1 0.01
```

### 输出

```
0
```

## 样例 #3

### 输入

```
1000000000000000 9.99
```

### 输出

```
9990000000000000
```



---

---
title: "[ABC171C] One Quadrillion and One Dalmatians"
layout: "post"
diff: 普及-
pid: AT_abc171_c
tag: []
---

# [ABC171C] One Quadrillion and One Dalmatians

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc171/tasks/abc171_c

ロジャーは、彼のもとに突如現れた $ 1000000000000001 $ 匹の犬をすべて飼うことを決意しました。犬たちにはもともと $ 1 $ から $ 1000000000000001 $ までの番号がふられていましたが、ロジャーは彼らに以下のルールで名前を授けました。

- $ 1,2,\cdots,26 $ 番の番号がついた犬はその順に `a`,`b`,...,`z` と命名されます。
- $ 27,28,29,\cdots,701,702 $ 番の番号がついた犬はその順に `aa`,`ab`,`ac`,...,`zy`,`zz` と命名されます。
- $ 703,704,705,\cdots,18277,18278 $ 番の番号がついた犬はその順に `aaa`,`aab`,`aac`,...,`zzy`,`zzz` と命名されます。
- $ 18279,18280,18281,\cdots,475253,475254 $ 番の番号がついた犬はその順に `aaaa`,`aaab`,`aaac`,...,`zzzy`,`zzzz` と命名されます。
- $ 475255,475256,\cdots $ 番の番号がついた犬はその順に `aaaaa`,`aaaab`,... と命名されます。
- (以下省略)

つまり、ロジャーが授けた名前を番号順に並べると:

`a`,`b`,...,`z`,`aa`,`ab`,...,`az`,`ba`,`bb`,...,`bz`,...,`za`,`zb`,...,`zz`,`aaa`,`aab`,...,`aaz`,`aba`,`abb`,...,`abz`,...,`zzz`,`aaaa`,... のようになります。

ロジャーはあなたに問題を出しました。

「番号 $ N $ の犬の名前を答えよ。」

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $

## 输出格式

ロジャーの問題に対する答えを、英小文字のみからなる文字列として出力せよ。

## 说明/提示

### 制約

- $ N $ は整数
- $ 1\ \leq\ N\ \leq\ 1000000000000001 $

## 样例 #1

### 输入

```
2
```

### 输出

```
b
```

## 样例 #2

### 输入

```
27
```

### 输出

```
aa
```

## 样例 #3

### 输入

```
123456789
```

### 输出

```
jjddja
```



---

---
title: "[ABC171D] Replacing"
layout: "post"
diff: 普及-
pid: AT_abc171_d
tag: []
---

# [ABC171D] Replacing

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc171/tasks/abc171_d

あなたは、$ N $ 個の正整数 $ A_{1},\ A_{2},\ \cdots,\ A_{N} $ からなる数列 $ A $ を持っています。

あなたは、これから以下の操作を $ Q $ 回、続けて行います。

- $ i $ 回目の操作では、値が $ B_{i} $ である要素すべてを $ C_{i} $ に置き換えます。

すべての $ i $ $ (1\ \leq\ i\ \leq\ Q) $ に対して、$ i $ 回目の操作が行われた後の数列 $ A $ のすべての要素の和、$ S_{i} $ を求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ A_{1} $ $ A_{2} $ $ \cdots $ $ A_{N} $ $ Q $ $ B_{1} $ $ C_{1} $ $ B_{2} $ $ C_{2} $ $ \vdots $ $ B_{Q} $ $ C_{Q} $

## 输出格式

$ Q $ 個の整数 $ S_{i} $ を以下の形式で標準出力に出力せよ。

> $ S_{1} $ $ S_{2} $ $ \vdots $ $ S_{Q} $

$ S_{i} $ は $ 32 $ ビット整数に収まらない可能性があることに注意せよ。

## 说明/提示

### 制約

- 入力は全て整数
- $ 1\ \leq\ N,\ Q,\ A_{i},\ B_{i},\ C_{i}\ \leq\ 10^{5} $
- $ B_{i}\ \neq\ C_{i} $

### Sample Explanation 1

はじめ、数列 $ A $ は $ 1,2,3,4 $ です。 各操作後、 数列 $ A $ は以下のようになります。 - $ 2,\ 2,\ 3,\ 4 $ - $ 2,\ 2,\ 4,\ 4 $ - $ 4,\ 4,\ 4,\ 4 $

### Sample Explanation 2

数列 $ A $ に 要素の値が $ B_{i} $ であるものが $ 1 $ つも含まれていない可能性もあることに注意してください。

## 样例 #1

### 输入

```
4

1 2 3 4

3

1 2

3 4

2 4
```

### 输出

```
11

12

16
```

## 样例 #2

### 输入

```
4

1 1 1 1

3

1 2

2 1

3 5
```

### 输出

```
8

4

4
```

## 样例 #3

### 输入

```
2

1 2

3

1 100

2 100

100 1000
```

### 输出

```
102

200

2000
```



---

---
title: "[ABC173C] H and V"
layout: "post"
diff: 普及-
pid: AT_abc173_c
tag: []
---

# [ABC173C] H and V

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc173/tasks/abc173_c

$ H $ 行 $ W $ 列に並ぶマスからなるマス目があります。上から $ i $ 行目、左から $ j $ 列目 $ (1\ \leq\ i\ \leq\ H,\ 1\ \leq\ j\ \leq\ W) $ のマスの色は文字 $ c_{i,j} $ として与えられ、$ c_{i,j} $ が `.` のとき白、`#` のとき黒です。

次の操作を行うことを考えます。

- 行を何行か選び ($ 0 $ 行でもよい)、列を何列か選ぶ ($ 0 $ 列でもよい)。そして、選んだ行に含まれるマスと、選んだ列に含まれるマスをすべて赤く塗る。

正の整数 $ K $ が与えられます。操作後に黒いマスがちょうど $ K $ 個残るような行と列の選び方は何通りでしょうか。ここで、二つの選び方は、一方においてのみ選ばれる行または列が存在するときに異なるとみなされます。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ H $ $ W $ $ K $ $ c_{1,1}c_{1,2}...c_{1,W} $ $ c_{2,1}c_{2,2}...c_{2,W} $ $ : $ $ c_{H,1}c_{H,2}...c_{H,W} $

## 输出格式

条件を満たす行と列の選び方の個数を表す整数を出力せよ。

## 说明/提示

### 制約

- $ 1\ \leq\ H,\ W\ \leq\ 6 $
- $ 1\ \leq\ K\ \leq\ HW $
- $ c_{i,j} $ は `.` または `#`

### Sample Explanation 1

以下の $ 5 $ 通りの選び方が条件を満たします。 - $ 1 $ 行目、$ 1 $ 列目 - $ 1 $ 行目、$ 2 $ 列目 - $ 1 $ 行目、$ 3 $ 列目 - $ 1 $ 列目、$ 2 $ 列目 - $ 3 $ 列目

### Sample Explanation 2

何も選ばないという $ 1 $ 通りの選び方が条件を満たします。

## 样例 #1

### 输入

```
2 3 2

..#

###
```

### 输出

```
5
```

## 样例 #2

### 输入

```
2 3 4

..#

###
```

### 输出

```
1
```

## 样例 #3

### 输入

```
2 2 3

##

##
```

### 输出

```
0
```

## 样例 #4

### 输入

```
6 6 8

..##..

.#..#.

#....#

######

#....#

#....#
```

### 输出

```
208
```



---

---
title: "[ABC174C] Repsept"
layout: "post"
diff: 普及-
pid: AT_abc174_c
tag: []
---

# [ABC174C] Repsept

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc174/tasks/abc174_c

高橋君は $ K $ の倍数と $ 7 $ が好きです。

$ 7,77,777,\ldots $ という数列の中に初めて $ K $ の倍数が登場するのは何項目ですか？

存在しない場合は代わりに `-1` を出力してください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ K $

## 输出格式

答えを整数として出力せよ。

## 说明/提示

### 制約

- $ 1\ \leq\ K\ \leq\ 10^6 $
- $ K $ は整数である。

### Sample Explanation 1

$ 7,77,777 $ は $ 101 $ の倍数ではありませんが、$ 7777 $ は $ 101 $ の倍数です。

### Sample Explanation 2

数列の値は全て奇数なので、$ 2 $ の倍数が登場することはありません。

## 样例 #1

### 输入

```
101
```

### 输出

```
4
```

## 样例 #2

### 输入

```
2
```

### 输出

```
-1
```

## 样例 #3

### 输入

```
999983
```

### 输出

```
999982
```



---

---
title: "[ABC174D] Alter Altar"
layout: "post"
diff: 普及-
pid: AT_abc174_d
tag: []
---

# [ABC174D] Alter Altar

## 题目描述

### 题目简述

给定一个长为 $n$ 的字符串 $c$，记 $c$ 中的第 $i$ 个字符为 $c_i$（$1 \le i \le n$）。现在可以按任意顺序执行以下两个操作之一：

- 选择两个字符并交换它们；
- 选择一个字符并改变它。

请问：至少要进行多少次操作，才能使字符串中没有`WR`这个子串？

## 输入格式

两行，第一行是一个正整数 $n$，第二行是一个长度为 $n$ 的字符串 $c$。

## 输出格式

一行一个非负整数，即达到目标所需的最少操作次数。

## 说明/提示

#### 输入输出样例 #1 说明
例如，下面的两个操作就可以实现目标。

首先，交换 $c_1$ 和 $c_3$，使 $c$ 变为`RWWR`；然后，改变 $c_4$ 为`W`，使 $c$ 满足条件。

#### 输入输出样例 #2 说明
有时可能不需要任何操作。

#### 数据规模与约定
对于全部的输入数据，保证 $2 \le n \le 200000$ 且 $n$ 为整数，同时 $c_i$ 必为`W`或`R`中的一个。

## 样例 #1

### 输入

```
4

WWRR
```

### 输出

```
2
```

## 样例 #2

### 输入

```
2

RR
```

### 输出

```
0
```

## 样例 #3

### 输入

```
8

WRWWRWRR
```

### 输出

```
3
```



---

---
title: "[ABC175C] Walking Takahashi"
layout: "post"
diff: 普及-
pid: AT_abc175_c
tag: []
---

# [ABC175C] Walking Takahashi

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc175/tasks/abc175_c

数直線上で暮らす高橋君は、今座標 $ X $ にいます。これから高橋君はちょうど $ K $ 回、座標の正または負の方向に $ D $ 移動する行為を繰り返そうと考えています。

より正確には、$ 1 $ 回の移動では 座標 $ x $ から $ x\ +\ D $ または $ x\ -\ D $ に移動できます。

高橋君は、ちょうど $ K $ 回移動した後にいる座標の絶対値が最小となるように移動したいです。

$ K $ 回の移動後の座標の絶対値としてあり得る値の最小値を求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ X $ $ K $ $ D $

## 输出格式

$ K $ 回の移動後の座標の絶対値としてあり得る値の最小値を出力せよ。

## 说明/提示

### 制約

- $ -10^{15}\ \leq\ X\ \leq\ 10^{15} $
- $ 1\ \leq\ K\ \leq\ 10^{15} $
- $ 1 \leq\ D\ \leq\ 10^{15} $
- 入力は全て整数である

### Sample Explanation 1

高橋君は、今座標 $ 6 $ にいます。次のように移動するのが最適です。 - $ 6 $ から ($ 6\ -\ 4\ = $) $ 2 $ に移動する。 - $ 2 $ から ($ 2\ -\ 4\ = $) $ -2 $ に移動する。 移動後の座標の絶対値は $ 2 $ で、これより小さくすることはできません。

### Sample Explanation 2

高橋君は、今座標 $ 7 $ にいます。例えば次のように移動するのが最適です。 - $ 7 $ から $ 4 $ に移動する。 - $ 4 $ から $ 7 $ に移動する。 - $ 7 $ から $ 4 $ に移動する。 - $ 4 $ から $ 1 $ に移動する。 移動後の座標の絶対値は $ 1 $ で、これより小さくすることはできません。

### Sample Explanation 4

答えは非常に大きな値になる場合もあります。

## 样例 #1

### 输入

```
6 2 4
```

### 输出

```
2
```

## 样例 #2

### 输入

```
7 4 3
```

### 输出

```
1
```

## 样例 #3

### 输入

```
10 1 2
```

### 输出

```
8
```

## 样例 #4

### 输入

```
1000000000000000 1000000000000000 1000000000000000
```

### 输出

```
1000000000000000
```



---

---
title: "[ABC177C] Sum of product of pairs"
layout: "post"
diff: 普及-
pid: AT_abc177_c
tag: []
---

# [ABC177C] Sum of product of pairs

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc177/tasks/abc177_c

$ N $ 個の整数 $ A_1,\ldots,A_N $ が与えられます。

$ 1\leq\ i\ <\ j\ \leq\ N $ を満たす全ての組 $ (i,j) $ についての $ A_i\ \times\ A_j $ の和を $ \bmod\ (10^9+7) $ で求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ A_1 $ $ \ldots $ $ A_N $

## 输出格式

$ \sum_{i=1}^{N-1}\sum_{j=i+1}^{N}\ A_i\ A_j $ を $ \bmod\ (10^9+7) $ で出力せよ。

## 说明/提示

### 制約

- $ 2\ \leq\ N\ \leq\ 2\times\ 10^5 $
- $ 0\ \leq\ A_i\ \leq\ 10^9 $
- 入力は全て整数

### Sample Explanation 1

$ 1\ \times\ 2\ +\ 1\ \times\ 3\ +\ 2\ \times\ 3\ =\ 11 $ です。

## 样例 #1

### 输入

```
3

1 2 3
```

### 输出

```
11
```

## 样例 #2

### 输入

```
4

141421356 17320508 22360679 244949
```

### 输出

```
437235829
```



---

---
title: "[ABC181D] Hachi"
layout: "post"
diff: 普及-
pid: AT_abc181_d
tag: []
---

# [ABC181D] Hachi

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc181/tasks/abc181_d

`1` 〜 `9` の数字のみからなる数字列 $ S $ が与えられます。

蜂の高橋くんは、 $ 8 $ の倍数が好きです。

高橋くんは、数字列 $ S $ を並び替えて $ 8 $ の倍数を作ろうとしています。

$ 8 $ の倍数を作れるかどうか判定してください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ S $

## 输出格式

数字列 $ S $ を並び替えて $ 8 $ の倍数を作れるなら `Yes` を、作れないなら `No` を出力せよ。

## 说明/提示

### 制約

- $ 1\ \leq\ |S|\ \leq\ 2\ \times\ 10^5 $
- $ S $ の各文字は `1` 〜 `9` のいずれか

### Sample Explanation 1

例えば、 $ 1234 $ を並べ替えて $ 1432 $ にすると $ 8 $ の倍数になります。

### Sample Explanation 2

$ 1333 $ をどう並べ替えても $ 8 $ の倍数を作ることはできません。

## 样例 #1

### 输入

```
1234
```

### 输出

```
Yes
```

## 样例 #2

### 输入

```
1333
```

### 输出

```
No
```

## 样例 #3

### 输入

```
8
```

### 输出

```
Yes
```



---

---
title: "[ABC183C] Travel"
layout: "post"
diff: 普及-
pid: AT_abc183_c
tag: []
---

# [ABC183C] Travel

## 题目描述

有 $n$ 个城市，从城市 $i$ 到城市 $j$ 需要的时间为 $t_{i,j}$。请问：从城市 $1$ 开始，只访问其他城市一遍，最后返回城市 $1$ 的路径中，有多少条路径所需要的时间为 $k$？

## 输入格式

输入共 $(n+1)$ 行。第一行输入两个正整数 $n,k$，中间以单个空格隔开；然后输入一个 $n \times n$ 的矩阵，第 $i$ 行第 $j$ 列上的数为 $t_{i,j}$。

## 输出格式

输出一行一个非负整数，即满足条件的路径条数。

## 说明/提示

#### 数据规模与约定

所有输入数据保证：

- $2 \le n \le 8$；
- 对于所有满足$1 \le i,j \le n$ 且 $i \neq j$ 的整数对 $(i,j)$，$t_{i,i}=0,t_{i,j}=t_{j,i},1 \le t_{i,j} \le 10^8$；
- $1 \le k \le 10^9$；
- 输入中的所有值均为整数。

## 样例 #1

### 输入

```
4 330

0 1 10 100

1 0 20 200

10 20 0 300

100 200 300 0
```

### 输出

```
2
```

## 样例 #2

### 输入

```
5 5

0 1 1 1 1

1 0 1 1 1

1 1 0 1 1

1 1 1 0 1

1 1 1 1 0
```

### 输出

```
24
```



---

---
title: "[ABC183D] Water Heater"
layout: "post"
diff: 普及-
pid: AT_abc183_d
tag: []
---

# [ABC183D] Water Heater

## 题目描述

有 $1$ 个热水器，每分钟可以提供 $W$ 升热水。

现在来了 $N$ 个人想使用热水。第 $i$ 个人打算从时刻 $S_i$ 使用到时刻 $T_i$（ $T_i$ 除外），每分钟需要使用 $P_i$ 升热水。由于热水倒出来会迅速变冷，因此不能储存。

你能按照他们的计划提供热水吗？

## 输入格式

输入按照以下格式使用标准输入：

第 $1$ 行：$N$ 和 $W$ ；

第 $2$ 到 $N+1$ 行：第 $i$ 行分别输入 $S_i$ , $T_i$ , $P_i$ 。

```
N W
S(1) T(1) P(1)
...
S(N) T(N) P(N)
```

## 输出格式

如果你可以按计划为每个人提供热水，请输出 `Yes` ，否则输出 `No` 。

### 数据限制

- $1\le N\le 2\times 10^5$
  
- $0\le S_i < T_i \le 2\times 10^5$
  
- $1\le W,~P_i\le 10^9$
  
- 输入的都是整数
  

### 样例 1 解释

在时刻 $3$ 与时刻 $4$ 之间，第 $2,~3,~4$ 个人每分钟分别需要使用 $4,~6,~1$ 升的热水，总共需要每分钟 $11$ 升热水的供应量；但是热水器每分钟只能供应 $10$ 升的热水，因此无法按计划供应热水。

## 样例 #1

### 输入

```
4 10

1 3 5

2 4 4

3 10 6

2 4 1
```

### 输出

```
No
```

## 样例 #2

### 输入

```
4 10

1 3 5

2 4 4

3 10 6

2 3 1
```

### 输出

```
Yes
```

## 样例 #3

### 输入

```
6 1000000000

0 200000 999999999

2 20 1

20 200 1

200 2000 1

2000 20000 1

20000 200000 1
```

### 输出

```
Yes
```



---

---
title: "[ABC185C] Duodecim Ferra"
layout: "post"
diff: 普及-
pid: AT_abc185_c
tag: []
---

# [ABC185C] Duodecim Ferra

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc185/tasks/abc185_c

長さ $ L $ の鉄の棒が東西方向に横たわっています。この棒を $ 11 $ 箇所で切断して、$ 12 $ 本に分割します。このとき分割後の各棒の長さが全て正整数になるように分割しなければなりません。  
 分割のしかたが何通りあるかを求めてください。二つの分割の方法は、一方で分割されているが他方で分割されていない位置が存在する場合に、そしてその場合に限って区別されます。  
 なお、この問題の制約下で答えは $ 2^{63} $ 未満であることが証明できます。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ L $

## 输出格式

分割のしかたが何通りあるかを表す整数を出力せよ。

## 说明/提示

### 制約

- $ 12\ \le\ L\ \le\ 200 $
- $ L $ は整数

### Sample Explanation 1

全て長さ $ 1 $ の棒になるように切断する $ 1 $ 通りです。

### Sample Explanation 2

ちょうど一つだけ長さ $ 2 $ の棒ができますが、切断後の $ 12 $ 本のうち西から何番目の棒が長さ $ 2 $ になるように切断するかで $ 12 $ 通りの切断方法があります。

## 样例 #1

### 输入

```
12
```

### 输出

```
1
```

## 样例 #2

### 输入

```
13
```

### 输出

```
12
```

## 样例 #3

### 输入

```
17
```

### 输出

```
4368
```



---

---
title: "[ABC185D] Stamp"
layout: "post"
diff: 普及-
pid: AT_abc185_d
tag: []
---

# [ABC185D] Stamp

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc185/tasks/abc185_d

左右方向一列に $ N $ 個のマスが並んでいます。左から $ i $ 番目のマスをマス $ i $ と呼ぶことにします。  
 この $ N $ 個のマスのうち、マス $ A_1 $, マス $ A_2 $, マス $ A_3 $, $ \dots $, マス $ A_M $ の $ M $ 個のマスは青色で、それ以外のマスは白色です。($ M\ =\ 0 $ の可能性もあり、その場合青色のマスはありません。)  
 あなたは一回だけ、正整数 $ k $ を一つ選んで幅 $ k $ のハンコを作ります。幅 $ k $ のハンコを一回使用すると、$ N $ 個のマスのうち連続する $ k $ マスを選び、それらを赤色に塗り替えることができます。ただしその際、その $ k $ 個のマスの中に青色のマスが入っていてはなりません。  
 $ k $ とハンコの使用方法をうまく決めた時、最小で何回ハンコを使用すれば、白色のマスが存在しない状態にすることができるでしょうか。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ M $ $ A_1\ \hspace{7pt}\ A_2\ \hspace{7pt}\ A_3\ \hspace{5pt}\ \dots\ \hspace{5pt}\ A_M $

## 输出格式

最小で何回ハンコを使用すれば白色のマスが存在しない状態にすることができるかを表す整数を出力せよ。

## 说明/提示

### 制約

- $ 1\ \le\ N\ \le\ 10^9 $
- $ 0\ \le\ M\ \le\ 2\ \times\ 10^5 $
- $ 1\ \le\ A_i\ \le\ N $
- $ A_i $ は互いに異なる
- 入力は全て整数

### Sample Explanation 1

$ k $ として $ 1 $ を選び、$ 3 $ つある白色マスを一回に一つずつ赤色に塗り替えると $ 3 $ 回で目的を達成でき、最適です。 $ k $ として $ 2 $ 以上を選ぶと、ハンコの使用時に $ k $ 個のマスの中に青色のマスが入っていてはいけないという制約のためにマス $ 2 $ がどうやっても赤色に塗り替えられなくなってしまいます。

### Sample Explanation 2

例えば $ k\ =\ 2 $ とし、以下のようにハンコを使用すると最適です。 - マス $ 1,\ 2 $ を赤色に塗り替える - マス $ 4,\ 5 $ を赤色に塗り替える - マス $ 5,\ 6 $ を赤色に塗り替える - マス $ 7,\ 8 $ を赤色に塗り替える - マス $ 10,\ 11 $ を赤色に塗り替える - マス $ 11,\ 12 $ を赤色に塗り替える ハンコの使用時に選ぶ連続する $ k $ 個のマスは青色のマスを含んではいけませんが、既に赤色のマスを含むのは問題ありません。

### Sample Explanation 3

最初から白色のマスが存在しない場合、ハンコは $ 1 $ 回も使わなくてよいです。

### Sample Explanation 4

$ M\ =\ 0 $ の可能性もあります。

## 样例 #1

### 输入

```
5 2

1 3
```

### 输出

```
3
```

## 样例 #2

### 输入

```
13 3

13 3 9
```

### 输出

```
6
```

## 样例 #3

### 输入

```
5 5

5 2 1 4 3
```

### 输出

```
0
```

## 样例 #4

### 输入

```
1 0
```

### 输出

```
1
```



---

---
title: "[ABC186D] Sum of difference"
layout: "post"
diff: 普及-
pid: AT_abc186_d
tag: []
---

# [ABC186D] Sum of difference

## 题目描述

### 题意简述
输入 $n$ 个整数 $a_1,a_2,...a_n$，

求在满足 $1 \leq i < j \leq n$ 的所有 $\lvert a_i-a_j \rvert$ 的和 $X$ 。

即求 $X=\sum_{i=1}^{n-1}\sum_{j=i+1}^{n} \lvert a_i-a_j\rvert$ 。

## 输入格式

第一行是一个整数 $n$；

第二行是 $n$ 个整数 $a_1,a_2,\dots,a_n$。

所有数据保证 $2 \leq n \leq 2\times 10^5,\lvert a_i\rvert \leq 10^8。$

## 输出格式

输出所求的 $X$。

## 样例 #1

### 输入

```
3

5 1 2
```

### 输出

```
8
```

## 样例 #2

### 输入

```
5

31 41 59 26 53
```

### 输出

```
176
```



---

---
title: "[ABC187D] Choose Me"
layout: "post"
diff: 普及-
pid: AT_abc187_d
tag: []
---

# [ABC187D] Choose Me

## 题目描述

### 题目简述
农场一年一度的选农场主开始啦！

选举的人有 Farmer John 和 Farmer Jack，全农场有 $N$ 个片区，第 $i$ 个片区有 $a_i$ 只 Jack 的奶牛，$b_i$ 只 John 的奶牛，没有其他人的奶牛。

John 要在各个片区发放牧草。

如果 John 在一个区发放牧草，那么所有 John 和 Jack 的奶牛都会投票支持 John，另一方面，如果 John 不在该区发放牧草，所有 Jack 的奶牛投票支持 Jack ，而 John 的奶牛不参与投票。

求John 想赢得比 Jack 多的选票，至少要去发放牧草的片区数量 $X$ 。

## 输入格式

第一行是一个整数 $N$,

第 $2$ 到第 $N+1$ 行，分别是两个整数 $a_i, b_i$ 。

## 输出格式

一个所求的整数 $X$ 。

## 样例 #1

### 输入

```
4

2 1

2 2

5 1

1 3
```

### 输出

```
1
```

## 样例 #2

### 输入

```
5

2 1

2 1

2 1

2 1

2 1
```

### 输出

```
3
```

## 样例 #3

### 输入

```
1

273 691
```

### 输出

```
1
```



---

---
title: "[ABC188C] ABC Tournament"
layout: "post"
diff: 普及-
pid: AT_abc188_c
tag: []
---

# [ABC188C] ABC Tournament

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc188/tasks/abc188_c

選手 $ 1 $ から選手 $ 2^N $ までの $ 2^N $ 人の選手がトーナメント形式のプログラミング対決をします。  
 選手 $ i $ のレートは $ A_i $ です。どの $ 2 $ 人の選手のレートも異なり、$ 2 $ 人の選手が対戦すると常にレートが高い方が勝ちます。

トーナメント表は完全二分木の形をしています。  
 より正確には、このトーナメントは以下の要領で行われます。

- $ i\ =\ 1,\ 2,\ 3,\ \dots,\ N $ について順に、以下のことが行われる。
  
  
  - 各整数 $ j\ (1\ \le\ j\ \le\ 2^{N\ -\ i}) $ について、まだ負けたことのない選手のうち、 $ 2j\ -\ 1 $ 番目に番号の小さい選手と $ 2j $ 番目に番号の小さい選手が対戦する。

**準優勝**する、すなわち最後に行われる対戦において負ける選手の番号を求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ A_1 $ $ A_2 $ $ A_3 $ $ \dots $ $ A_{2^N} $

## 输出格式

**準優勝**する選手の番号を出力せよ。

## 说明/提示

### 制約

- $ 1\ \le\ N\ \le\ 16 $
- $ 1\ \le\ A_i\ \le\ 10^9 $
- $ A_i $ は相異なる
- 入力に含まれる値は全て整数である

### Sample Explanation 1

まず選手 $ 1 $ と $ 2 $、選手 $ 3 $ と $ 4 $ がそれぞれ対戦し、レートの大小から選手 $ 2 $ と $ 4 $ が勝利します。 次に選手 $ 2 $ と選手 $ 4 $ が対戦し、選手 $ 4 $ が勝利してトーナメントが終了します。 最後の対戦で負けるのは選手 $ 2 $ なので、$ 2 $ を出力します。

### Sample Explanation 2

まず選手 $ 1 $ と $ 2 $、選手 $ 3 $ と $ 4 $ がそれぞれ対戦し、レートの大小から選手 $ 1 $ と $ 3 $ が勝利します。 次に選手 $ 1 $ と選手 $ 3 $ が対戦し、選手 $ 3 $ が勝利してトーナメントが終了します。 最後の対戦で負けるのは選手 $ 1 $ なので、$ 1 $ を出力します。

## 样例 #1

### 输入

```
2

1 4 2 5
```

### 输出

```
2
```

## 样例 #2

### 输入

```
2

3 1 5 4
```

### 输出

```
1
```

## 样例 #3

### 输入

```
4

6 13 12 5 3 7 10 11 16 9 8 15 2 1 14 4
```

### 输出

```
2
```



---

---
title: "[ABC189C] Mandarin Orange"
layout: "post"
diff: 普及-
pid: AT_abc189_c
tag: []
---

# [ABC189C] Mandarin Orange

## 题目描述

有 $N$ 个盘子摆在高桥君面前，从左到右第 $i$ 个盘子内放着 $A_i$ 个橘子。

高桥君可以选择一组满足以下 $3$ 个条件的整数 $(l,r,x)$ ：

- $1\le l\le r\le N$ ；
  
- $1\le x$ ；
  
- 对于所有 $l$ 以上 $r$ 以下的整数 $i$ ，$x\le A_i$ 。
  

选择后，高桥君会从第 $l$ 到 $r$ 个（包括两端）的盘子里面分别拿 $x$ 个橘子吃。

请你计算当高桥君选择了最优的一组整数 $(l,r,x)$ ，他可以吃到几个橘子。

## 输入格式

输入以以下格式从标准输入中读取：

- 第 $1$ 行：一个正整数 $N$ ；
  
- 第 $2$ 行：$N$ 个正整数，第 $i$ 个正整数是 $A_i$ 。
  

```
N
A(1) ... A(N)
```

## 输出格式

高桥君最多能吃几个橘子？

## 说明/提示

- 输入的全都是整数；
  
- $1\le N\le 10^4$ ；
  
- $1\le A_i\le 10^5$ 。
  

### 样例 1 解释

当 $(l,r,x)=(2,6,4)$ 时，高桥君可以吃 $20$ 个橘子；

### 样例 2 解释

当 $(l,r,x)=(1,1,200)$ 时，高桥君可以吃 $200$ 个橘子。

## 样例 #1

### 输入

```
6

2 4 4 9 4 9
```

### 输出

```
20
```

## 样例 #2

### 输入

```
6

200 4 4 9 4 9
```

### 输出

```
200
```



---

---
title: "[ABC190C] Bowls and Dishes"
layout: "post"
diff: 普及-
pid: AT_abc190_c
tag: []
---

# [ABC190C] Bowls and Dishes

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc190/tasks/abc190_c

$ 1,\ 2,\ \dots,\ N $ の番号がついた $ N $ 個の皿と、$ 1,\ 2,\ \dots,\ M $ の番号がついた $ M $ 個の条件があります。  
 条件 $ i $ は、皿 $ A_i $ と皿 $ B_i $ の両方にボールが ($ 1 $ 個以上) 置かれているとき満たされます。  
 $ 1,\ 2,\ \dots,\ K $ の番号がついた $ K $ 人の人がいて、人 $ i $ は皿 $ C_i $ か皿 $ D_i $ のどちらか一方にボールを置きます。  
 満たされる条件の個数は最大でいくつでしょうか？

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ M $ $ A_1 $ $ B_1 $ $ \vdots $ $ A_M $ $ B_M $ $ K $ $ C_1 $ $ D_1 $ $ \vdots $ $ C_K $ $ D_K $

## 输出格式

答えを出力せよ。

## 说明/提示

### 制約

- 入力は全て整数
- $ 2\ <\ =\ N\ <\ =\ 100 $
- $ 1\ <\ =\ M\ <\ =\ 100 $
- $ 1\ <\ =\ A_i\ <\ B_i\ <\ =\ N $
- $ 1\ <\ =\ K\ <\ = 16 $
- $ 1\ <\ =\ C_i\ <\ D_i\ <\ =\ N $

### Sample Explanation 1

例えば、人 $ 1,\ 2,\ 3 $ がそれぞれ皿 $ 1,\ 3,\ 2 $ にボールを置くと、条件 $ 1,\ 2 $ の $ 2 $ つが満たされます。

### Sample Explanation 2

例えば、人 $ 1,\ 2,\ 3,\ 4 $ がそれぞれ皿 $ 3,\ 1,\ 2,\ 4 $ にボールを置くと、全ての条件が満たされます。

## 样例 #1

### 输入

```
4 4

1 2

1 3

2 4

3 4

3

1 2

1 3

2 3
```

### 输出

```
2
```

## 样例 #2

### 输入

```
4 4

1 2

1 3

2 4

3 4

4

3 4

1 2

2 4

2 4
```

### 输出

```
4
```

## 样例 #3

### 输入

```
6 12

2 3

4 6

1 2

4 5

2 6

1 5

4 5

1 3

1 2

2 6

2 3

2 5

5

3 5

1 4

2 6

4 6

5 6
```

### 输出

```
9
```



---

---
title: "[ABC193C] Unexpressed"
layout: "post"
diff: 普及-
pid: AT_abc193_c
tag: []
---

# [ABC193C] Unexpressed

## 题目描述

# [ABC193C] Unexpressed


[problemUrl]: https://atcoder.jp/contests/abc193/tasks/abc193_c
给出一个整数 $n$，输出在 1~ $n$ 之间的所有整数中，有多少个不能被 $a^{b} \left(a \ge 2 \And b \ge 2 \right)$ 表示的数。

## 输入格式

输入一个整数 $n$。

## 输出格式

输出在 1~ $n$ 之间的所有整数中，有多少个不能被 $a^{b} \left(a \ge 2 \And b \ge 2 \right)$ 表示的数。

## 样例 #1

### 样例输入 #1

```
8
```

### 样例输出 #1

```
6
```

## 样例 #2

### 样例输入 #2

```
100000
```

### 样例输出 #2

```
99634
```

## 说明/提示

### 制约

- $n$ 是一个整数
- $ 1 \le n \le 10^{10}$


只有 4 , 8 能被 $a^{b} \left(a \ge 2 \And b \ge 2 \right)$ 表示，$4=2^{2}$，$8=2^{3}$。

## 样例 #1

### 输入

```
8
```

### 输出

```
6
```

## 样例 #2

### 输入

```
100000
```

### 输出

```
99634
```



---

---
title: "[ABC194C] Squared Error"
layout: "post"
diff: 普及-
pid: AT_abc194_c
tag: []
---

# [ABC194C] Squared Error

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc194/tasks/abc194_c

長さ $ N $ の数列 $ A $ が与えられます。  
 各要素同士の差の $ 2 $ 乗の和、すなわち $ \displaystyle\ \sum_{i\ =\ 2}^{N}\ \sum_{j\ =\ 1}^{i\ -\ 1}\ (A_i\ -\ A_j)^2 $ を求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ A_1 $ $ A_2 $ $ A_3 $ $ \cdots $ $ A_N $

## 输出格式

答えを出力せよ。

## 说明/提示

### 制約

- $ 2\ \le\ N\ \le\ 3\ \times\ 10^5 $
- $ |A_i|\ \le\ 200 $
- 入力に含まれる値は全て整数

### Sample Explanation 1

$ \sum_{i\ =\ 2}^{N}\ \sum_{j\ =\ 1}^{i\ -\ 1}\ (A_i\ -\ A_j)^2\ =\ (8\ -\ 2)^2\ +\ (4\ -\ 2)^2\ +\ (4\ -\ 8)^2\ =\ 56 $ です。

## 样例 #1

### 输入

```
3

2 8 4
```

### 输出

```
56
```

## 样例 #2

### 输入

```
5

-5 8 9 -4 -3
```

### 输出

```
950
```



---

---
title: "[ABC195B] Many Oranges"
layout: "post"
diff: 普及-
pid: AT_abc195_b
tag: []
---

# [ABC195B] Many Oranges

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc195/tasks/abc195_b

みかんがたくさんあります。どのみかんの重さも $ A $ グラム以上 $ B $ グラム以下であることがわかっています。（みかんの重さは整数とは限りません。）

この中からいくつかのみかんを選んだところ、選んだみかんの重さの合計がちょうど $ W $ キログラムになりました。

選んだみかんの個数として考えられる最小値と最大値を求めてください。ただし、このようなことが起こり得ないなら、かわりにそのことを報告してください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ A $ $ B $ $ W $

## 输出格式

選んだみかんの個数としてありえる最小値と最大値を空白区切りでこの順に出力せよ。ただし、与えられた条件に合うような個数が存在しない場合、かわりに `UNSATISFIABLE` と出力せよ。

## 说明/提示

### 制約

- $ 1\ \leq\ A\ \leq\ B\ \leq\ 1000 $
- $ 1\ \leq\ W\ \leq\ 1000 $
- 入力は全て整数

### Sample Explanation 1

みかん $ 1 $ 個の重さは $ 100 $ グラム以上 $ 200 $ グラム以下です。 - $ 200 $ グラムのみかんを $ 10 $ 個選んだとき、重さの合計はちょうど $ 2 $ キログラムになります - $ 100 $ グラムのみかんを $ 20 $ 個選んだとき、重さの合計はちょうど $ 2 $ キログラムになります $ 9 $ 個以下または $ 21 $ 個以上でちょうど $ 2 $ キログラムになることはないので、$ 10 $ 個と $ 20 $ 個がそれぞれ最小値と最大値になります。

### Sample Explanation 2

みかん $ 1 $ 個の重さは $ 120 $ グラム以上 $ 150 $ グラム以下です。 - 例えば $ 140 $ グラムのみかん $ 10 $ 個と、$ 150 $ グラムのみかん $ 4 $ 個を選んだとき、重さの合計はちょうど $ 2 $ キログラムになります - 例えば $ 120 $ グラムのみかん $ 8 $ 個と、$ 130 $ グラムのみかん $ 8 $ 個を選んだとき、重さの合計はちょうど $ 2 $ キログラムになります $ 13 $ 個以下または $ 17 $ 個以上でちょうど $ 2 $ キログラムになることはないので、$ 14 $ 個と $ 16 $ 個がそれぞれ最小値と最大値になります。

### Sample Explanation 3

みかん $ 1 $ 個の重さは $ 300 $ グラム以上 $ 333 $ グラム以下です。 このようなみかんいくつかの重さの合計がちょうど $ 1 $ キログラムになることはありえません。

## 样例 #1

### 输入

```
100 200 2
```

### 输出

```
10 20
```

## 样例 #2

### 输入

```
120 150 2
```

### 输出

```
14 16
```

## 样例 #3

### 输入

```
300 333 1
```

### 输出

```
UNSATISFIABLE
```



---

---
title: "[ABC198C] Compass Walking"
layout: "post"
diff: 普及-
pid: AT_abc198_c
tag: []
---

# [ABC198C] Compass Walking

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc198/tasks/abc198_c

$ 2 $ 次元平面上の原点に高橋君がいます。

高橋君が $ 1 $ 歩歩くと、いまいる点からのユークリッド距離がちょうど $ R $ であるような点に移動することができます(移動先の座標が整数である必要はありません)。これ以外の方法で移動することはできません。

高橋君が点 $ (X,Y) $ に到達するまでに必要な歩数の最小値を求めてください。

なお、点 $ (x_1,y_1) $ と点 $ (x_2,y_2) $ のユークリッド距離は $ \sqrt{(x_1-x_2)^2+(y_1-y_2)^2} $ で与えられます。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ R $ $ X $ $ Y $

## 输出格式

高橋君が $ (X,Y) $ に到達するまでに必要な歩数の最小値を出力せよ。

## 说明/提示

### 制約

- $ 1\ \leq\ R\ \leq\ 10^5 $
- $ 0\ \leq\ X,Y\ \leq\ 10^5 $
- $ (X,Y)\ \neq\ (0,0) $
- 入力は全て整数

### Sample Explanation 1

$ (0,0)\ \to\ (5,0)\ \to\ (10,0)\ \to\ (15,0) $ と $ 3 $ 歩で到達できます。 $ 2 $ 歩以下で到達することはできないのでこれが最小です。 !\[図1\](https://img.atcoder.jp/ghi/d34bbf4b43d8de5baf54bf589618c64e.png)

### Sample Explanation 2

例えば $ (0,0)\ \to\ (5,0)\ \to\ (8,4)\ \to\ (11,0) $ と移動すれば良いです。 !\[図2\](https://img.atcoder.jp/ghi/0932ca629f834af5124563f198bb3f9e.png)

### Sample Explanation 3

例えば $ (0,0)\ \to\ (2-\frac{\sqrt{2}}{2},\ 2+\frac{\sqrt{2}}{2})\ \to\ (4,4) $ と移動すれば良いです。 !\[図3\](https://img.atcoder.jp/ghi/50d67c401f9aceed8baa130918144597.png)

## 样例 #1

### 输入

```
5 15 0
```

### 输出

```
3
```

## 样例 #2

### 输入

```
5 11 0
```

### 输出

```
3
```

## 样例 #3

### 输入

```
3 4 4
```

### 输出

```
2
```



---

---
title: "[ABC199C] IPFL"
layout: "post"
diff: 普及-
pid: AT_abc199_c
tag: []
---

# [ABC199C] IPFL

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc199/tasks/abc199_c

長さ $ 2N $ の文字列 $ S $ があります。  
 この文字列に対して $ Q $ 個のクエリが与えられます。$ i $ 番目のクエリでは $ 3 $ つの整数 $ T_i,\ A_i,\ B_i $ が与えられるので、以下の処理をします。

- $ T_i\ =\ 1 $ のとき : $ S $ の $ A_i $ 文字目と $ B_i $ 文字目を入れ替える
- $ T_i\ =\ 2 $ のとき : $ S $ の前半 $ N $ 文字と後半 $ N $ 文字を入れ替える($ A_i,\ B_i $ の値は用いない)  
   例えば $ S $ が `FLIP` のときにこのクエリを処理すると、$ S $ は `IPFL` となる。

これら $ Q $ 個のクエリを与えられた順に全て処理した後の $ S $ を出力してください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ S $ $ Q $ $ T_1 $ $ A_1 $ $ B_1 $ $ T_2 $ $ A_2 $ $ B_2 $ $ T_3 $ $ A_3 $ $ B_3 $ $ \hspace{21pt}\ \vdots $ $ T_Q $ $ A_Q $ $ B_Q $

## 输出格式

クエリ処理後の $ S $ を出力せよ。

## 说明/提示

### 制約

- $ 1\ \le\ N\ \le\ 2\ \times\ 10^5 $
- $ S $ は長さ $ 2N $ の英大文字のみからなる文字列
- $ 1\ \le\ Q\ \le\ 3\ \times\ 10^5 $
- $ T_i $ は $ 1 $ または $ 2 $
- $ T_i\ =\ 1 $ のとき、$ 1\ \le\ A_i\ \lt\ B_i\ \le\ 2N $
- $ T_i\ =\ 2 $ のとき、$ A_i\ =\ B_i\ =\ 0 $

### Sample Explanation 1

$ 1 $ 番目のクエリでは $ S $ の前半 $ N $ 文字と後半 $ N $ 文字を入れ替えるため、$ S $ は `IPFL` となります。 $ 2 $ 番目のクエリでは $ S $ の $ 1 $ 文字目と $ 4 $ 文字目を入れ替えるため、$ S $ は `LPFI` となります。

## 样例 #1

### 输入

```
2

FLIP

2

2 0 0

1 1 4
```

### 输出

```
LPFI
```

## 样例 #2

### 输入

```
2

FLIP

6

1 1 3

2 0 0

1 1 2

1 2 3

2 0 0

1 1 4
```

### 输出

```
ILPF
```



---

---
title: "[ABC201C] Secret Number"
layout: "post"
diff: 普及-
pid: AT_abc201_c
tag: []
---

# [ABC201C] Secret Number

## 题目描述

高桥忘记了密码。密码是由 $ 0 $ 到 $ 9 $ 之间的数字组成的四位字符串，有时从 $ 0 $ 开始。

对于从 $ 0 $ 到 $ 9 $ 的各数字，高桥有如下要求。密码的要求由长度为 $ 10 $ 的字符串 $S_0 S_1 \ldots S_9 $表示。

要求的表示方法：
- $ S_i $ 为 `o` 时：数字 $ i $ 确实包含在密码中。
- $ S_i $ 为 `x` 时：数字 $ i $ 没有包含在密码中。
- $ S_i $ 为 `?` 时：不知道数字 $ i $ 是否包含在密码中

高桥的密码可能有多少种结果？

## 输入格式

输入 $ S $ 。

## 输出格式

输出答案。
### 约束条件
$ S $ 是由 `o`, `x`, `?` 组成的长度为 $ 10 $ 的字符串
### 样例1解释
例如 `0123` 和 `0021` 等。
### 样例2解释
可能的密码不存在，即答案可能等于 $ 0 $ 。

## 样例 #1

### 输入

```
ooo???xxxx
```

### 输出

```
108
```

## 样例 #2

### 输入

```
o?oo?oxoxo
```

### 输出

```
0
```

## 样例 #3

### 输入

```
xxxxx?xxxo
```

### 输出

```
15
```



---

---
title: "[ABC204C] Tour"
layout: "post"
diff: 普及-
pid: AT_abc204_c
tag: []
---

# [ABC204C] Tour

## 题目描述

AtCoder国家包括编号 ${1}$ 到 ${N}$ 的 ${N}$ 个城市和编号为 ${M}$ 的 ${M}$ 条道路。

通过道路 ${i}$ 可以从城市 ${A_i}$ 移动到 ${B_i}$ 。从都市 ${B_i}$ 到都市 ${A_i}$ 不能通行。彪马打算从某个城市开始，使用 ${0}$ 条以上的道路移动，制定以某个城市为终点的旅行计划。

作为起点和终点的城市组合，有几种？

## 输入格式

输入的以下形式由标准输入给出。

$ 
{N M }
$

$
{A_1 B_1⋮ A_M B_M} 
$

## 输出格式

输出一行，包含一个正整数，表示彪马旅行问题的可能性的种数。

## 样例 #1

### 输入

```
3 3

1 2

2 3

3 2
```

### 输出

```
7
```

## 样例 #2

### 输入

```
3 0
```

### 输出

```
3
```

## 样例 #3

### 输入

```
4 4

1 2

2 3

3 4

4 1
```

### 输出

```
16
```



---

---
title: "[ABC207C] Many Segments"
layout: "post"
diff: 普及-
pid: AT_abc207_c
tag: []
---

# [ABC207C] Many Segments

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc207/tasks/abc207_c

$ 1 $ から $ N $ までの番号が付いた $ N $ 個の区間が与えられます。区間 $ i $ は、

- $ t_i=1 $ なら $ [l_i,r_i] $
- $ t_i=2 $ なら $ [l_i,r_i) $
- $ t_i=3 $ なら $ (l_i,r_i] $
- $ t_i=4 $ なら $ (l_i,r_i) $

です。

$ 1\ \leq\ i\ \lt\ j\ \leq\ N $ を満たす整数の組 $ (i,j) $ のうち、区間 $ i $ と区間 $ j $ が共通部分を持つようなものは幾つありますか？

 区間 $ [X,Y],[X,Y),(X,Y],(X,Y) $ とは？- 閉区間 $ [X,Y] $ は、 $ X $ 以上 $ Y $ 以下の全ての実数からなる区間
- 半開区間 $ [X,Y) $ は、 $ X $ 以上 $ Y $ 未満の全ての実数からなる区間
- 半開区間 $ (X,Y] $ は、 $ X $ より大きく $ Y $ 以下の全ての実数からなる区間
- 開区間 $ (X,Y) $ は、 $ X $ より大きく $ Y $ 未満の全ての実数からなる区間
 
 を表します。一言で言うと、角括弧 $ [] $ を使っている側は端点を含み、丸括弧 $ () $ を使っている側は端点を含みません。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ t_1 $ $ l_1 $ $ r_1 $ $ t_2 $ $ l_2 $ $ r_2 $ $ \hspace{1cm}\vdots $ $ t_N $ $ l_N $ $ r_N $

## 输出格式

区間 $ i $ と区間 $ j $ が共通部分を持つような整数の組 $ (i,j) $ の個数を出力せよ。

## 说明/提示

### 制約

- $ 2\ \leq\ N\ \leq\ 2000 $
- $ 1\ \leq\ t_i\ \leq\ 4 $
- $ 1\ \leq\ l_i\ \lt\ r_i\ \leq\ 10^9 $
- 入力は全て整数

### Sample Explanation 1

問題文中の定義より、区間 $ 1 $ は $ [1,2] $, 区間 $ 2 $ は $ [2,3) $, 区間 $ 3 $ は $ (2,4] $ です。 区間 $ i $ と区間 $ j $ が共通部分を持つような整数の組 $ (i,j) $ は、$ (1,2) $ と $ (2,3) $ の $ 2 $ つとなります。それぞれ、$ [2,2] $ と $ (2,3) $ を共通部分として持っています。

## 样例 #1

### 输入

```
3

1 1 2

2 2 3

3 2 4
```

### 输出

```
2
```

## 样例 #2

### 输入

```
19

4 210068409 221208102

4 16698200 910945203

4 76268400 259148323

4 370943597 566244098

1 428897569 509621647

4 250946752 823720939

1 642505376 868415584

2 619091266 868230936

2 306543999 654038915

4 486033777 715789416

1 527225177 583184546

2 885292456 900938599

3 264004185 486613484

2 345310564 818091848

1 152544274 521564293

4 13819154 555218434

3 507364086 545932412

4 797872271 935850549

2 415488246 685203817
```

### 输出

```
102
```



---

---
title: "[ABC209D] Collision"
layout: "post"
diff: 普及-
pid: AT_abc209_d
tag: []
---

# [ABC209D] Collision

## 题目描述

给出一张 $n$ 点 $(n-1)$ 边的无向图，第 $i$ 条边连接点 $a_i$ 和点 $b_i$，长度为 $1$。

给出 $q$ 个询问。第 $i$ 个询问给出两个点 $c_i$ 和 $d_i$。请求出两点之间的最短路长度，若为奇数请输出`Road`，若为偶数请输出`Town`。保证图联通。

## 输入格式

第一行输入点数 $n$ 和询问次数 $q$。

第二行到第 $n$ 行，第 $(i-1)$ 行输入两个数 $a_i,b_i$，表示第 $i$ 条边连接的两个点。

从第 $(n+1)$ 起的 $q$ 行，第 $i$ 行输入两个数 $c_i,d_i$，表示第 $i$ 次询问的两个点。

## 说明/提示

#### 样例 #1 解释

很明显给出的图为一条链（`1-2-3-4-5`）。$1$ 和 $3$ 之间的最短路长度为 $2$，$1$ 和 $5$ 之间的最短路长度为 $4$。它们都是偶数，所以都输出`Town`。

#### 数据规模与约定

对于 $100\%$ 的数据，保证：

- 输入的数值均为整数；
- $2\le n\le 10^5$，$1\le q \le 10^5$；
- $1\le a_i,b_i,c_i,d_i\le n$，且对于同一个 $i$，都有 $a_i\lt b_i$，$c_i\lt d_i$。

## 样例 #1

### 输入

```
4 1

1 2

2 3

2 4

1 2
```

### 输出

```
Road
```

## 样例 #2

### 输入

```
5 2

1 2

2 3

3 4

4 5

1 3

1 5
```

### 输出

```
Town

Town
```

## 样例 #3

### 输入

```
9 9

2 3

5 6

4 8

8 9

4 5

3 4

1 9

3 7

7 9

2 5

2 6

4 6

2 4

5 8

7 8

3 6

5 6
```

### 输出

```
Town

Road

Town

Town

Town

Town

Road

Road

Road
```



---

---
title: "[ABC210C] Colorful Candies"
layout: "post"
diff: 普及-
pid: AT_abc210_c
tag: []
---

# [ABC210C] Colorful Candies

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc210/tasks/abc210_c

$ N $ 個のキャンディが左右一列に並んでいます。  
 それぞれのキャンディは、色 $ 1 $、色 $ 2 $、$ \ldots $、色 $ 10^9 $の、$ 10^9 $ 種類の色のうちいずれかの色をしています。  
 $ i\ =\ 1,\ 2,\ \ldots,\ N $ について、左から $ i $ 番目のキャンディの色は色 $ c_i $ です。

高橋君は並んでいるキャンディのうち、連続して並んだ $ K $ 個のキャンディをもらうことができます。  
 すなわち、$ 1\ \leq\ i\ \leq\ N-K+1 $ を満たす整数 $ i $ を選んで、 左から $ i $ 番目、$ i+1 $ 番目、$ i+2 $ 番目、$ \ldots $、$ i+K-1 $ 番目のキャンディをもらうことができます。

高橋君はいろいろな色のキャンディを食べたいので、 もらうキャンディに含まれる色の種類数が多いほどうれしい気持ちになります。  
 高橋君がもらうキャンディに含まれる色の種類数の最大値を出力してください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ K $ $ c_1 $ $ c_2 $ $ \ldots $ $ c_N $

## 输出格式

高橋君がもらうキャンディに含まれる色の種類数の最大値を出力せよ。

## 说明/提示

### 制約

- $ 1\ \leq\ K\ \leq\ N\ \leq\ 3\ \times\ 10^5 $
- $ 1\ \leq\ c_i\ \leq\ 10^9 $
- 入力はすべて整数

### Sample Explanation 1

高橋君が左から $ 3 $ 番目から $ 5 $ 番目のキャンディをもらうと、もらうキャンディに含まれる色は $ 3 $ 種類になり、これが最大です。

### Sample Explanation 2

高橋君は並んでいるすべてのキャンディをもらうことが出来ますが、もらうキャンディに含まれる色は $ 1 $ 種類です。

## 样例 #1

### 输入

```
7 3

1 2 1 2 3 3 1
```

### 输出

```
3
```

## 样例 #2

### 输入

```
5 5

4 4 4 4 4
```

### 输出

```
1
```

## 样例 #3

### 输入

```
10 6

304621362 506696497 304621362 506696497 834022578 304621362 414720753 304621362 304621362 414720753
```

### 输出

```
4
```



---

---
title: "[ABC211C] chokudai"
layout: "post"
diff: 普及-
pid: AT_abc211_c
tag: []
---

# [ABC211C] chokudai

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc211/tasks/abc211_c

文字列 $ S $ が与えられます。  
 このうち $ 8 $ 文字を選び下線を引き、下線を引いた文字が左から順に `c` , `h` , `o` , `k` , `u` , `d` , `a` , `i` となるようにする方法は何通りありますか？  
 ただし答えは非常に大きくなる可能性があるので、$ (10^9\ +\ 7) $ で割った余りを出力してください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ S $

## 输出格式

答えを $ (10^9\ +\ 7) $ で割った余りを出力せよ。

## 说明/提示

### 制約

- $ 8\ \leq\ |S|\ \leq\ 10^5 $
- $ S $ は英小文字からなる

### Sample Explanation 1

chchokudai chchokudai chchokudai 上の $ 3 $ つが条件を満たします。 chchokudai は、条件を満たさないことに注意してください。

### Sample Explanation 2

答えが $ 0 $ 通りになることもあります。

## 样例 #1

### 输入

```
chchokudai
```

### 输出

```
3
```

## 样例 #2

### 输入

```
atcoderrr
```

### 输出

```
0
```

## 样例 #3

### 输入

```
chokudaichokudaichokudai
```

### 输出

```
45
```



---

---
title: "[ABC213C] Reorder Cards"
layout: "post"
diff: 普及-
pid: AT_abc213_c
tag: []
---

# [ABC213C] Reorder Cards

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc213/tasks/abc213_c

$ H $ 行 $ W $ 列の格子状に $ HW $ 枚のカードが並べられています。  
 $ i=1,\ldots,N $ について、上から $ A_i $ 行目、左から $ B_i $ 列目にあるカードには数 $ i $ が書かれており、それ以外の $ HW-N $ 枚のカードには何も書かれていません。

これらのカードに対し、以下の $ 2 $ 種類の操作を可能な限り繰り返します。

- 数の書かれたカードを含まない行が存在するとき、その行のカードを全て取り除き、残りのカードを上へ詰める
- 数の書かれたカードを含まない列が存在するとき、その列のカードを全て取り除き、残りのカードを左へ詰める

操作が終了したとき、数が書かれたカードがそれぞれどこにあるか求めてください。なお、答えは操作の仕方に依らず一意に定まることが証明されます。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ H $ $ W $ $ N $ $ A_1 $ $ B_1 $ $ \vdots $ $ A_N $ $ B_N $

## 输出格式

$ N $ 行出力せよ。

操作終了後に数 $ i $ が書かれたカードが上から $ C_i $ 行目、左から $ D_i $ 列目に存在するとき、$ i $ 行目には $ C_i,D_i $ をこの順に空白区切りで出力せよ。

## 说明/提示

### 制約

- $ 1\ \leq\ H,W\ \leq\ 10^9 $
- $ 1\ \leq\ N\ \leq\ \min(10^5,HW) $
- $ 1\ \leq\ A_i\ \leq\ H $
- $ 1\ \leq\ B_i\ \leq\ W $
- $ (A_i,B_i) $ は相異なる
- 入力に含まれる値は全て整数である

### Sample Explanation 1

何も書かれていないカードを `\*` で表すことにします。最初、カードの配置は以下の通りです。 ``` \*\*\*\*\* \*\*\*\*2 \*1\*\*\* \*\*\*\*\* ``` 操作終了後、カードの配置は以下の通りになります。 ``` \*2 1\* ``` $ 1 $ が書かれたカードは上から $ 2 $ 行目、左から $ 1 $ 列目にあり、$ 2 $ が書かれたカードは上から $ 1 $ 行目、左から $ 2 $ 列目にあります。

## 样例 #1

### 输入

```
4 5 2

3 2

2 5
```

### 输出

```
2 1

1 2
```

## 样例 #2

### 输入

```
1000000000 1000000000 10

1 1

10 10

100 100

1000 1000

10000 10000

100000 100000

1000000 1000000

10000000 10000000

100000000 100000000

1000000000 1000000000
```

### 输出

```
1 1

2 2

3 3

4 4

5 5

6 6

7 7

8 8

9 9

10 10
```



---

---
title: "[ABC214C] Distribution"
layout: "post"
diff: 普及-
pid: AT_abc214_c
tag: []
---

# [ABC214C] Distribution

## 题目描述

$N$ 人排列在圆周上，逆时针方向编号为 $1,2....N$ 。 

第 $i(1≤i≤N)$ 个人在时刻 $t$ 拿到宝石后，在 $S_i$ 个单位时间后，即在时刻 $t+S_i$ 将该宝石交给第 $i+1$ 个人。特别的，第 $N$ 个人给向第 $1$ 个人。

另外，高桥在时间 $T_i$ 将宝石交给第 $i$ 个人。

对于所有 $i(1≤i≤N)$，请求出 i 号人第一次得到宝石的时刻。另外，宝石交接所需的时间可以忽略。

## 输入格式

第一行 $N$    
第二行 $S_1,S_2,……S_N$      
第三行 $T_1,T_2,……T_N$

## 输出格式

输出 $N$ 行。在 $i(1≤i≤N)$ 行中，输出第 $i$ 个人第一次得到宝石的时刻。

### 说明/提示     

$1≤N≤200000$

$1≤Si,Ti≤10^9$

输入全部为整数。

## 样例 #1

### 输入

```
3

4 1 5

3 10 100
```

### 输出

```
3

7

8
```

## 样例 #2

### 输入

```
4

100 100 100 100

1 1 1 1
```

### 输出

```
1

1

1

1
```

## 样例 #3

### 输入

```
4

1 2 3 4

1 2 4 7
```

### 输出

```
1

2

4

7
```

## 样例 #4

### 输入

```
8

84 87 78 16 94 36 87 93

50 22 63 28 91 60 64 27
```

### 输出

```
50

22

63

28

44

60

64

27
```



---

---
title: "[ABC219C] Neo-lexicographic Ordering"
layout: "post"
diff: 普及-
pid: AT_abc219_c
tag: []
---

# [ABC219C] Neo-lexicographic Ordering

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc219/tasks/abc219_c

AtCoder 王国を治める高橋君は、英小文字のアルファベット順を変更することにしました。

新たなアルファベット順は`a` $ , $ `b` $ ,\ \ldots, $ `z` を並べ替えて得られる文字列 $ X $ を用いて表されます。$ X $ の $ i\ \,\ (1\ \leq\ i\ \leq\ 26) $ 文字目は、新たな順番において $ i $ 番目に小さい英小文字を表します。

AtCoder 王国には $ N $ 人の国民がおり、それぞれの国民の名前は $ S_1,\ S_2,\ \dots,\ S_N $ です。ここで、$ S_i\ \,\ (1\ \leq\ i\ \leq\ N) $ は英小文字からなります。  
 これらの名前を、高橋君の定めたアルファベット順に基づく辞書順に従って並べ替えてください。

 辞書順とは？ 辞書順とは簡単に説明すると「単語が辞書に載っている順番」を意味します。より厳密な説明として、英小文字からなる相異なる文字列 $ S,\ T $ の大小を判定するアルゴリズムを以下に説明します。

以下では「 $ S $ の $ i $ 文字目の文字」を $ S_i $ のように表します。また、 $ S $ が $ T $ より辞書順で小さい場合は $ S\ \lt\ T $ 、大きい場合は $ S\ \gt\ T $ と表します。

1. $ S,\ T $ のうち長さが大きくない方の文字列の長さを $ L $ とします。$ i=1,2,\dots,L $ に対して $ S_i $ と $ T_i $ が一致するか調べます。
2. $ S_i\ \neq\ T_i $ である $ i $ が存在する場合、そのような $ i $ のうち最小のものを $ j $ とします。そして、$ S_j $ と $ T_j $ を比較して、$ S_j $ が $ T_j $ よりアルファベット順で小さい場合は $ S\ \lt\ T $ 、そうでない場合は $ S\ \gt\ T $ と決定して、アルゴリズムを終了します。
3. $ S_i\ \neq\ T_i $ である $ i $ が存在しない場合、$ S $ と $ T $ の長さを比較して、$ S $ が $ T $ より短い場合は $ S\ \lt\ T $ 、長い場合は $ S\ \gt\ T $ と決定して、アルゴリズムを終了します。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ X $ $ N $ $ S_1 $ $ S_2 $ $ \vdots $ $ S_N $

## 输出格式

$ N $ 行出力せよ。$ i\ \,\ (1\ \leq\ i\ \leq\ N) $ 行目には、高橋君の定めたアルファベット順に基づく辞書順に従って国民の名前を並べ替えたとき、$ i $ 番目に小さいものを出力すること。

## 说明/提示

### 制約

- $ X $ は `a` $ , $ `b` $ ,\ \ldots, $ `z` を並べ替えて得られる
- $ 2\ \leq\ N\ \leq\ 50000 $
- $ N $ は整数
- $ 1\ \leq\ |S_i|\ \leq\ 10\ \,\ (1\ \leq\ i\ \leq\ N) $
- $ S_i $ は英小文字からなる $ (1\ \leq\ i\ \leq\ N) $
- $ S_i\ \neq\ S_j $ $ (1\ \leq\ i\ \lt\ j\ \leq\ N) $

### Sample Explanation 1

高橋君が新たに設定したアルファベット順において、`b` は `a` より小さく、`z` は `y` より小さいです。そのため、国民の名前を辞書順に並べ替えると、小さい順に `bzz` $ , $ `bzy` $ , $ `abx` $ , $ `caa` となります。

## 样例 #1

### 输入

```
bacdefghijklmnopqrstuvwxzy

4

abx

bzz

bzy

caa
```

### 输出

```
bzz

bzy

abx

caa
```

## 样例 #2

### 输入

```
zyxwvutsrqponmlkjihgfedcba

5

a

ab

abc

ac

b
```

### 输出

```
b

a

ac

ab

abc
```



---

---
title: "[ABC220D] FG operation"
layout: "post"
diff: 普及-
pid: AT_abc220_d
tag: []
---

# [ABC220D] FG operation

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc220/tasks/abc220_d

$ 0 $ 以上 $ 9 $ 以下の整数からなる長さ $ N $ の数列 $ A=(A_1,\dots,A_N) $ があり、この順に左から右に並んでいます。

数列の長さが $ 1 $ になるまで、操作 $ F $ または操作 $ G $ を繰り返し行います。

- 操作 $ F $ ：左端の $ 2 $ つの値 ( $ x,y $ とする ) を削除した後、一番左に $ (x+y)\%10 $ を挿入する
- 操作 $ G $ ：左端の $ 2 $ つの値 ( $ x,y $ とする ) を削除した後、一番左に $ (x\times\ y)\%10 $ を挿入する

なお、$ a\%b $ は $ a $ を $ b $ で割った余りを意味します。

$ K=0,1,\dots,9 $ について、以下の問題に答えてください。

> 操作手順としてあり得るものは $ 2^{N-1} $ 通りありますが、このうち最終的に残る値が $ K $ となる操作手順は何通りありますか？  
>  ただし答えは非常に大きくなる可能性があるので、$ 998244353 $ で割った余りを求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ A_1 $ $ \dots $ $ A_N $

## 输出格式

答えを $ 10 $ 行に出力せよ。  
 ただし、$ i $ 行目には $ K=i-1 $ としたときの答えを出力せよ。

## 说明/提示

### 制約

- $ 2\ \leq\ N\ \leq\ 10^5 $
- $ 0\ \leq\ A_i\ \leq\ 9 $
- 入力は全て整数

### Sample Explanation 1

$ 1 $ 回目に操作 $ F $ 、$ 2 $ 回目に操作 $ F $ を行ったとき：数列は $ (2,7,6)→(9,6)→(5) $ となります。 $ 1 $ 回目に操作 $ F $ 、$ 2 $ 回目に操作 $ G $ を行ったとき：数列は $ (2,7,6)→(9,6)→(4) $ となります。 $ 1 $ 回目に操作 $ G $ 、$ 2 $ 回目に操作 $ F $ を行ったとき：数列は $ (2,7,6)→(4,6)→(0) $ となります。 $ 1 $ 回目に操作 $ G $ 、$ 2 $ 回目に操作 $ G $ を行ったとき：数列は $ (2,7,6)→(4,6)→(4) $ となります。

## 样例 #1

### 输入

```
3

2 7 6
```

### 输出

```
1

0

0

0

2

1

0

0

0

0
```

## 样例 #2

### 输入

```
5

0 1 2 3 4
```

### 输出

```
6

0

1

1

4

0

1

1

0

2
```



---

---
title: "[ABC221C] Select Mul"
layout: "post"
diff: 普及-
pid: AT_abc221_c
tag: []
---

# [ABC221C] Select Mul

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc221/tasks/abc221_c

整数 $ N $ が与えられます。$ N $ の各桁の数字を取り出して並べ（並べる順序は好きに変えてよい）、$ 2 $ つの**正整数**に分離することを考えましょう。

例えば、$ 123 $ という整数に対しては以下の $ 6 $ 通りの分離の仕方が考えられます。

- $ 12 $ と $ 3 $
- $ 21 $ と $ 3 $
- $ 13 $ と $ 2 $
- $ 31 $ と $ 2 $
- $ 23 $ と $ 1 $
- $ 32 $ と $ 1 $

なお、ここで分離されたあとの $ 2 $ 整数に leading zero が含まれていてはなりません。例えば、$ 101 $ という整数を $ 1 $ と $ 01 $ の $ 2 $ つに分離することはできません。また上述の「正整数に分離する」という条件より、$ 101 $ を $ 11 $ と $ 0 $ の $ 2 $ つに分離することもできません。

適切に $ N $ を分離したとき、分離後の $ 2 $ 数の積の最大値はいくらになりますか？

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $

## 输出格式

分離後の $ 2 $ 数の積の最大値を出力せよ。

## 说明/提示

### 制約

- $ N $ は $ 1 $ 以上 $ 10^9 $ 以下の整数
- $ N $ には $ 0 $ でない桁が $ 2 $ つ以上含まれる

### Sample Explanation 1

問題文中にある通り、以下の $ 6 $ 通りの分離の仕方が考えられます。 - $ 12 $ と $ 3 $ - $ 21 $ と $ 3 $ - $ 13 $ と $ 2 $ - $ 31 $ と $ 2 $ - $ 23 $ と $ 1 $ - $ 32 $ と $ 1 $ 積はそれぞれ $ 36 $, $ 63 $, $ 26 $, $ 62 $, $ 23 $, $ 32 $ であり、この中の最大値は $ 63 $ です。

### Sample Explanation 2

考えられる分離の仕方は以下の $ 2 $ 通りです。 - $ 100 $ と $ 1 $ - $ 10 $ と $ 10 $ いずれの場合にも積は $ 100 $ となります。

## 样例 #1

### 输入

```
123
```

### 输出

```
63
```

## 样例 #2

### 输入

```
1010
```

### 输出

```
100
```

## 样例 #3

### 输入

```
998244353
```

### 输出

```
939337176
```



---

---
title: "[ABC222C] Swiss-System Tournament"
layout: "post"
diff: 普及-
pid: AT_abc222_c
tag: []
---

# [ABC222C] Swiss-System Tournament

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc222/tasks/abc222_c

$ 1 $ から $ 2N $ の番号がついた $ 2N $ 人でじゃんけん大会をします。

大会は $ M $ ラウンドからなり、各ラウンドは、全ての人が $ 1 $ 度ずつ参加するような $ 1 $ 対 $ 1 $ の $ N $ 試合からなります。

$ i=0,1,\ldots,M $ について、$ i $ ラウンド目の終了時点での順位を次のように決めます。

- $ i $ ラウンド目までの勝数が多い方が上位
- $ i $ ラウンド目までの勝数が同じときは、番号が小さい方が上位

また、$ i=1,\ldots,M $ について、$ i $ ラウンド目の各試合の組み合わせを次のように決めます。

- 各 $ k=1,2,\ldots,N $ について、$ i-1 $ ラウンド目終了時点の順位が $ 2k-1 $ 位の人と $ 2k $ 位の人が試合をする

各試合では、対戦する $ 2 $ 人がそれぞれ $ 1 $ 度だけ手を出し、勝ち・負け・引き分けのいずれかの結果が発生します。

未来予知ができる高橋君は、人 $ i $ が $ j $ ラウンド目の試合で出す手が $ A_{i,j} $ であることを知っています。  
 $ A_{i,j} $ は `G`, `C`, `P` のいずれかであり、それぞれグー、チョキ、パーを表します。

$ M $ ラウンド目終了時点の順位を求めてください。

 じゃんけんのルール じゃんけんの結果は、$ 2 $ 人の出した手に応じて次のように決まります。 - 一方がグーで他方がチョキのとき、グーを出した人が勝ち、チョキを出した人は負け
- 一方がチョキで他方がパーのとき、チョキを出した人が勝ち、パーを出した人は負け
- 一方がパーで他方がグーのとき、パーを出した人が勝ち、グーを出した人は負け
- 両者が同じ手を出したとき、引き分け

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ M $ $ A_{1,1}A_{1,2}\ldots\ A_{1,M} $ $ A_{2,1}A_{2,2}\ldots\ A_{2,M} $ $ \vdots $ $ A_{2N,1}A_{2N,2}\ldots\ A_{2N,M} $

## 输出格式

$ 2N $ 行出力せよ。

$ i $ 行目には、$ M $ ラウンド目終了時点での順位が $ i $ 位である人の番号を出力せよ。

## 说明/提示

### 制約

- $ 1\ \leq\ N\ \leq\ 50 $
- $ 1\ \leq\ M\ \leq\ 100 $
- $ A_{i,j} $ は `G`, `C`, `P` のいずれか

### Sample Explanation 1

$ 1 $ ラウンド目では人 $ 1 $ と $ 2 $、$ 3 $ と $ 4 $ がそれぞれ試合をし、前者の試合は人 $ 2 $ が、後者の試合は人 $ 3 $ が勝ちます。 $ 2 $ ラウンド目では人 $ 2 $ と $ 3 $、$ 1 $ と $ 4 $ がそれぞれ試合をし、前者の試合は人 $ 3 $ が、後者の試合は人 $ 1 $ が勝ちます。 $ 3 $ ラウンド目では人 $ 3 $ と $ 1 $、$ 2 $ と $ 4 $ がそれぞれ試合をし、前者の試合は人 $ 3 $ が、後者の試合は人 $ 4 $ が勝ちます。 よって最終的な順位は、上位から順に人 $ 3,1,2,4 $ となります。

### Sample Explanation 2

$ 1 $ ラウンド目では人 $ 1 $ と $ 2 $、$ 3 $ と $ 4 $ がそれぞれ試合をし、前者の試合は人 $ 2 $ が、後者の試合は人 $ 3 $ が勝ちます。 $ 2 $ ラウンド目では人 $ 2 $ と $ 3 $、$ 1 $ と $ 4 $ がそれぞれ試合をし、前者の試合は引き分け、後者の試合は人 $ 1 $ が勝ちます。 よって最終的な順位は、上位から順に人 $ 1,2,3,4 $ となります。

## 样例 #1

### 输入

```
2 3

GCP

PPP

CCC

PPC
```

### 输出

```
3

1

2

4
```

## 样例 #2

### 输入

```
2 2

GC

PG

CG

PP
```

### 输出

```
1

2

3

4
```



---

---
title: "[ABC223C] Doukasen"
layout: "post"
diff: 普及-
pid: AT_abc223_c
tag: []
---

# [ABC223C] Doukasen

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc223/tasks/abc223_c

$ N $ 本の導火線を一直線に接着したものがあります。左から $ i $ 本目の導火線は長さが $ A_i $ cm で、 $ 1 $ 秒あたり $ B_i $ cm の一定の速さで燃えます。

この導火線の左端と右端から同時に火をつけるとき、 $ 2 $ つの火がぶつかる場所が着火前の導火線の左端から何 cm の地点か求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ A_1 $ $ B_1 $ $ A_2 $ $ B_2 $ $ \vdots $ $ A_N $ $ B_N $

## 输出格式

$ 2 $ つの火がぶつかる場所が着火前の導火線の左端から何 cm の地点か（単位を除いて）出力せよ。

想定解答との絶対誤差または相対誤差が $ 10^{-5} $ 以下であれば正解として扱われる。

## 说明/提示

### 制約

- $ 1\ \leq\ N\ \leq\ 10^5 $
- $ 1\ \leq\ A_i,B_i\ \leq\ 1000 $
- 入力は全て整数

### Sample Explanation 1

着火前の導火線の左端から $ 3 $ cm の地点で $ 2 $ つの火がぶつかります。

## 样例 #1

### 输入

```
3

1 1

2 1

3 1
```

### 输出

```
3.000000000000000
```

## 样例 #2

### 输入

```
3

1 3

2 2

3 1
```

### 输出

```
3.833333333333333
```

## 样例 #3

### 输入

```
5

3 9

1 2

4 6

1 5

5 3
```

### 输出

```
8.916666666666668
```



---

---
title: "[ABC224C] Triangle?"
layout: "post"
diff: 普及-
pid: AT_abc224_c
tag: []
---

# [ABC224C] Triangle?

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc224/tasks/abc224_c

$ xy $ 平面上に $ 1 $ から $ N $ までの番号が付いた $ N $ 個の点があります。  
 点 $ i $ は座標 $ (X_i,Y_i) $ にあり、相異なる $ 2 $ 点は異なる位置に存在します。  
 この $ N $ 点から $ 3 $ 点を選ぶとき、選ばれた $ 3 $ 点を線分で結んだ図形が正の面積を持つ三角形になるような点の選び方の総数を求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ X_1 $ $ Y_1 $ $ X_2 $ $ Y_2 $ $ \dots $ $ X_N $ $ Y_N $

## 输出格式

答えを整数として出力せよ。

## 说明/提示

### 制約

- 入力は全て整数である
- $ 3\ \le\ N\ \le\ 300 $
- $ -10^9\ \le\ X_i,Y_i\ \le\ 10^9 $
- $ i\ \neq\ j $ ならば $ (X_i,Y_i)\ \neq\ (X_j,Y_j) $

### Sample Explanation 1

点を図示すると、以下のようになります。 !\[\](https://img.atcoder.jp/ghi/11f8cb446cb2872c9a712c59195a1268.png) 三角形をなすような点の選び方は、 $ \{1,2,3\},\{1,3,4\},\{2,3,4\} $ の $ 3 $ つです。

## 样例 #1

### 输入

```
4

0 1

1 3

1 1

-1 -1
```

### 输出

```
3
```

## 样例 #2

### 输入

```
20

224 433

987654321 987654321

2 0

6 4

314159265 358979323

0 0

-123456789 123456789

-1000000000 1000000000

124 233

9 -6

-4 0

9 5

-7 3

333333333 -333333333

-9 -1

7 -10

-1 5

324 633

1000000000 -1000000000

20 0
```

### 输出

```
1124
```



---

---
title: "[ABC225C] Calendar Validator"
layout: "post"
diff: 普及-
pid: AT_abc225_c
tag: []
---

# [ABC225C] Calendar Validator

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc225/tasks/abc225_c

$ 10^{100} $ 行 $ 7 $ 列の行列 $ A $ があり、任意の整数対 $ (i,j)\ (1\ \leq\ i \leq\ 10^{100},\ 1\ \leq\ j\ \leq\ 7) $ についてその $ (i,j) $ 成分は $ (i-1)\ \times\ 7\ +\ j $ です。

$ N $ 行 $ M $ 列の行列 $ B $ が与えられるので、$ B $ が $ A $ から一部の矩形領域を（向きを変えずに）切り出したものであるかを判定してください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ M $ $ B_{1,1} $ $ B_{1,2} $ $ \ldots $ $ B_{1,M} $ $ B_{2,1} $ $ B_{2,2} $ $ \ldots $ $ B_{2,M} $ $ \hspace{1.6cm}\vdots $ $ B_{N,1} $ $ B_{N,2} $ $ \ldots $ $ B_{N,M} $

## 输出格式

$ B $ が $ A $ から一部の矩形領域を切り出したものであれば `Yes` と、そうでないなら `No` と出力せよ。

## 说明/提示

### 制約

- $ 1\ \leq\ N\ \leq\ 10^4 $
- $ 1\ \leq\ M\ \leq\ 7 $
- $ 1\ \leq\ B_{i,j}\ \leq\ 10^9 $
- 入力はすべて整数

### Sample Explanation 1

与えられる $ B $ は、$ A $ の左上 $ 2 $ 行 $ 3 $ 列を切り出したものとなっています。

### Sample Explanation 2

与えられる $ B $ を $ 90 $ 度回転させると $ A $ の左上 $ 1 $ 行 $ 2 $ 列と一致しますが、問題文中に「向きを変えずに」とある通り回転による一致は認められていないため、答えは `No` となります。

## 样例 #1

### 输入

```
2 3

1 2 3

8 9 10
```

### 输出

```
Yes
```

## 样例 #2

### 输入

```
2 1

1

2
```

### 输出

```
No
```

## 样例 #3

### 输入

```
10 4

1346 1347 1348 1349

1353 1354 1355 1356

1360 1361 1362 1363

1367 1368 1369 1370

1374 1375 1376 1377

1381 1382 1383 1384

1388 1389 1390 1391

1395 1396 1397 1398

1402 1403 1404 1405

1409 1410 1411 1412
```

### 输出

```
Yes
```



---

---
title: "[ABC226C] Martial artist"
layout: "post"
diff: 普及-
pid: AT_abc226_c
tag: []
---

# [ABC226C] Martial artist

## 题目描述

高桥君是一位武术大师，他可以学习 $N$ 种技能，这些技能分别标号为 $1, 2, \ldots, N$。要学习每个技能 $i$，他需要花费 $T_i$ 时间进行修炼，并且在开始时必须已掌握技能 $A_{i,1}, A_{i,2}, \ldots, A_{i,K_i}$。这里保证了，每个前置技能的编号小于当前技能编号，即 $A_{i,j} < i$。

在时刻 $0$，高桥君还没有掌握任何技能。他一次只能进行一个技能的修炼，并且一旦开始修炼，便不能中途停下。你的任务是计算出高桥君学习到技能 $N$ 所需的最短时间。

## 输入格式

输入通过标准输入给出，格式如下：

> $N$  
$T_1$ $K_1$ $A_{1,1}$ $A_{1,2}$ $\ldots$ $A_{1,K_1}$  
$T_2$ $K_2$ $A_{2,1}$ $A_{2,2}$ $\ldots$ $A_{2,K_2}$  
$\vdots$  
$T_N$ $K_N$ $A_{N,1}$ $A_{N,2}$ $\ldots$ $A_{N,K_N}$

## 输出格式

输出高桥君掌握技能 $N$ 所需的最短时间。

## 说明/提示

- $1 \leq N \leq 2 \times 10^5$
- $1 \leq T_i \leq 10^9$
- $0 \leq K_i < i$
- $1 \leq A_{i,j} < i$
- $\sum_{i=1}^N K_i \leq 2 \times 10^5$
- $A_{i,1}, A_{i,2}, \ldots, A_{i,K_i}$ 全部互不相同。
- 所有输入均为整数。

### 示例 1
高桥君可以采取这样的修习顺序：
- 他在时刻 $0$ 开始学习技能 $1$，到时刻 $3$ 时掌握此技能。
- 然后，从时刻 $3$ 开始修炼技能 $3$，到时刻 $10$ 时学会此技能。
这样一来，高桥君学习到技能 $3$ 的最短时间为 $3 + 7 = 10$。在这过程中，他不需要掌握技能 $2$。

### 提示 2
请注意，答案可能超过 $32$ 位整数的范围。

 **本翻译由 AI 自动生成**

## 样例 #1

### 输入

```
3

3 0

5 1 1

7 1 1
```

### 输出

```
10
```

## 样例 #2

### 输入

```
5

1000000000 0

1000000000 0

1000000000 0

1000000000 0

1000000000 4 1 2 3 4
```

### 输出

```
5000000000
```



---

---
title: "[ABC230C] X drawing"
layout: "post"
diff: 普及-
pid: AT_abc230_c
tag: []
---

# [ABC230C] X drawing

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc230/tasks/abc230_c

上下左右に広がる $ N\times\ N $ のマス目があり、最初全てのマスは白く塗られています。このマス目の上から $ i $ 行目、左から $ j $ 列目のマスを $ (i,j) $ で表します。

高橋君は $ 1 $ 以上 $ N $ 以下の整数 $ A $, $ B $ を持っており、次のような操作を行います。

- $ \max(1-A,1-B)\leq\ k\leq\ \min(N-A,N-B) $ をみたす全ての整数 $ k $ について、$ (A+k,B+k) $ を黒く塗る。
- $ \max(1-A,B-N)\leq\ k\leq\ \min(N-A,B-1) $ をみたす全ての整数 $ k $ について、$ (A+k,B-k) $ を黒く塗る。

この操作を行った後のマス目について、$ P\leq\ i\leq\ Q $ かつ $ R\leq\ j\leq\ S $ をみたす各マス $ (i,j) $ がそれぞれ何色で塗られているか求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ A $ $ B $ $ P $ $ Q $ $ R $ $ S $

## 输出格式

$ Q-P+1 $ 行出力せよ。  
 各行は `#` と `.` のみからなる長さ $ S-R+1 $ の文字列であり、 $ i $ 行目の文字列の $ j $ 番目の文字が `#` であることは $ (P+i-1,R+j-1) $ が黒く塗られていることを、 `.` であることは $ (P+i-1,R+j-1) $ が白く塗られていることをさす。

## 说明/提示

### 制約

- $ 1\ \leq\ N\ \leq\ 10^{18} $
- $ 1\ \leq\ A\ \leq\ N $
- $ 1\ \leq\ B\ \leq\ N $
- $ 1\ \leq\ P\ \leq\ Q\ \leq\ N $
- $ 1\ \leq\ R\ \leq\ S\ \leq\ N $
- $ (Q-P+1)\times(S-R+1)\leq\ 3\times\ 10^5 $
- 入力は全て整数である。

### Sample Explanation 1

$ 1 $ つめの操作で $ (2,1) $, $ (3,2) $, $ (4,3) $, $ (5,4) $ の $ 4 $ マスが、 $ 2 $ つめの操作で $ (4,1) $, $ (3,2) $, $ (2,3) $, $ (1,4) $ の $ 4 $ マスが黒く塗られます。 よって、$ P=1 $, $ Q=5 $, $ R=1 $, $ S=5 $ より、上のように出力します。

### Sample Explanation 2

操作によって、 $ (1,1) $, $ (1,5) $, $ (2,2) $, $ (2,4) $, $ (3,3) $, $ (4,2) $, $ (4,4) $, $ (5,1) $, $ (5,5) $ の $ 9 $ マスが 黒く塗られます。 $ P=4 $, $ Q=5 $, $ R=2 $, $ S=5 $ より、上のように出力します。

### Sample Explanation 3

入力が $ 32 $ bit 整数型に収まらないことがあることに注意してください。

## 样例 #1

### 输入

```
5 3 2

1 5 1 5
```

### 输出

```
...#.

#.#..

.#...

#.#..

...#.
```

## 样例 #2

### 输入

```
5 3 3

4 5 2 5
```

### 输出

```
#.#.

...#
```

## 样例 #3

### 输入

```
1000000000000000000 999999999999999999 999999999999999999

999999999999999998 1000000000000000000 999999999999999998 1000000000000000000
```

### 输出

```
#.#

.#.

#.#
```



---

---
title: "[ABC232C] Graph Isomorphism"
layout: "post"
diff: 普及-
pid: AT_abc232_c
tag: []
---

# [ABC232C] Graph Isomorphism

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc232/tasks/abc232_c

高橋君と青木君は、それぞれ $ N $ 個のボールに $ M $ 本のひもを取り付けたおもちゃを持っています。

高橋君のおもちゃにおいて、ボールには $ 1,\ \dots,\ N $ と番号が付けられており、$ i\ \,\ (1\ \leq\ i\ \leq\ M) $ 本目のひもはボール $ A_i $ とボール $ B_i $ を結んでいます。

青木君のおもちゃにおいても同様に、ボールには $ 1,\ \dots,\ N $ と番号が付けられており、$ i\ \,\ (1\ \leq\ i\ \leq\ M) $ 本目のひもはボール $ C_i $ とボール $ D_i $ を結んでいます。

それぞれのおもちゃにおいて、同一のボールを結ぶようなひもは存在せず、$ 2 $ つのボールを $ 2 $ 本以上の異なるひもが結んでいることはありません。

すぬけ君は、$ 2 $ 人のおもちゃが同じ形であるかどうか気になっています。  
 ここで、$ 2 $ 人のおもちゃが同じ形であるとは、以下の条件を満たす数列 $ P $ が存在することをいいます。

- $ P $ は $ (1,\ \dots,\ N) $ を並べ替えて得られる。
- 任意の $ 1 $ 以上 $ N $ 以下の整数 $ i,\ j $ に対し、以下が成り立つ。
  - 高橋君のおもちゃにおいてボール $ i,\ j $ がひもで繋がれていることと、青木君のおもちゃにおいてボール $ P_i,\ P_j $ がひもで繋がれていることは同値である。

$ 2 $ 人のおもちゃが同じ形であるなら `Yes`、そうでないなら `No` と出力してください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ M $ $ A_1 $ $ B_1 $ $ \vdots $ $ A_M $ $ B_M $ $ C_1 $ $ D_1 $ $ \vdots $ $ C_M $ $ D_M $

## 输出格式

$ 2 $ 人のおもちゃが同じ形であるなら `Yes`、そうでないなら `No` と出力せよ。

## 说明/提示

### 制約

- $ 1\ \leq\ N\ \leq\ 8 $
- $ 0\ \leq\ M\ \leq\ \frac{N(N\ -\ 1)}{2} $
- $ 1\ \leq\ A_i\ \lt\ B_i\ \leq\ N\ \,\ (1\ \leq\ i\ \leq\ M) $
- $ (A_i,\ B_i)\ \neq\ (A_j,\ B_j)\ \,\ (i\ \neq\ j) $
- $ 1\ \leq\ C_i\ \lt\ D_i\ \leq\ N\ \,\ (1\ \leq\ i\ \leq\ M) $
- $ (C_i,\ D_i)\ \neq\ (C_j,\ D_j)\ \,\ (i\ \neq\ j) $
- 入力は全て整数である。

### Sample Explanation 1

高橋君のおもちゃは下図の左側のような形をしており、青木君のおもちゃは下図の右側のような形をしています。 !\[yes1\](https://img.atcoder.jp/ghi/abc232c\_yes1.jpg) 次の図から、$ 2 $ 人のおもちゃが同じ形であることがわかります。例えば $ P\ =\ (3,\ 2,\ 1,\ 4) $ とすると問題文中の条件を満たします。 !\[yes2\](https://img.atcoder.jp/ghi/abc232c\_yes2.jpg)

### Sample Explanation 2

$ 2 $ 人のおもちゃは同じ形ではありません。 !\[no\](https://img.atcoder.jp/ghi/abc232c\_no.jpg)

## 样例 #1

### 输入

```
4 4

1 2

1 3

1 4

3 4

1 3

1 4

2 3

3 4
```

### 输出

```
Yes
```

## 样例 #2

### 输入

```
5 6

1 2

1 3

1 4

3 4

3 5

4 5

1 2

1 3

1 4

1 5

3 5

4 5
```

### 输出

```
No
```

## 样例 #3

### 输入

```
8 0
```

### 输出

```
Yes
```



---

---
title: "[ABC232D] Weak Takahashi"
layout: "post"
diff: 普及-
pid: AT_abc232_d
tag: []
---

# [ABC232D] Weak Takahashi

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc232/tasks/abc232_d

縦 $ H $ 行、横 $ W $ 行の $ H\ \times\ W $ マスからなるグリッドがあります。上から $ i $ 行目、左から $ j $ 列目のマスを $ (i,\ j) $ と表します。  
 各マスの状態は文字 $ C_{i,\ j} $ で表され、$ C_{i,\ j}\ = $ `.` ならばマス $ (i,\ j) $ は空きマスであり、$ C_{i,\ j}\ = $ `#` ならばマス $ (i,\ j) $ は壁です。

高橋君がグリッド上を歩こうとしています。彼がマス $ (i,\ j) $ にいるとき、マス $ (i,\ j\ +\ 1) $ またはマス $ (i\ +\ 1,\ j) $ に移動することができます。ただし、グリッドの外に出るような移動や、壁のマスへの移動を行うことはできません。高橋君は、移動することのできるマスが無くなった時点で立ち止まります。

高橋君がマス $ (1,\ 1) $ から歩き始めるとき、彼が立ち止まるまでに通ることのできるマスは最大で何マスですか？

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ H $ $ W $ $ C_{1,\ 1}\ \ldots\ C_{1,\ W} $ $ \vdots $ $ C_{H,\ 1}\ \ldots\ C_{H,\ W} $

## 输出格式

答えを出力せよ。

## 说明/提示

### 制約

- $ 1\ \leq\ H,\ W\ \leq\ 100 $
- $ H,\ W $ は整数
- $ C_{i,\ j}\ = $ `.` または $ C_{i,\ j}\ = $ `#` $ (1\ \leq\ i\ \leq\ H,\ 1\ \leq\ j\ \leq\ W) $
- $ C_{1,\ 1}\ = $ `.`

### Sample Explanation 1

例えば $ (1,\ 1)\ \rightarrow\ (2,\ 1)\ \rightarrow\ (2,\ 2)\ \rightarrow\ (3,\ 2) $ と進むことで、$ 4 $ マス通ることができます。 $ 5 $ マス以上通ることはできないので、$ 4 $ と出力します。

## 样例 #1

### 输入

```
3 4

.#..

..#.

..##
```

### 输出

```
4
```

## 样例 #2

### 输入

```
1 1

.
```

### 输出

```
1
```

## 样例 #3

### 输入

```
5 5

.....

.....

.....

.....

.....
```

### 输出

```
9
```



---

---
title: "[ABC233C] Product"
layout: "post"
diff: 普及-
pid: AT_abc233_c
tag: []
---

# [ABC233C] Product

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc233/tasks/abc233_c

$ N $ 個の袋があります。  
 袋 $ i $ には $ L_i $ 個のボールが入っていて、袋 $ i $ の $ j(1\leq\ j\leq\ L_i) $ 番目のボールには正の整数 $ a_{i,j} $ が書かれています。

それぞれの袋から $ 1 $ つずつボールを取り出します。  
 取り出したボールに書かれた数の総積が $ X $ になるような取り出し方は何通りありますか？

ただし、書かれた数が同じであっても全てのボールは区別します。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ X $ $ L_1 $ $ a_{1,1} $ $ a_{1,2} $ $ \ldots $ $ a_{1,L_1} $ $ L_2 $ $ a_{2,1} $ $ a_{2,2} $ $ \ldots $ $ a_{2,L_2} $ $ \vdots $ $ L_N $ $ a_{N,1} $ $ a_{N,2} $ $ \ldots $ $ a_{N,L_N} $

## 输出格式

答えを出力せよ。

## 说明/提示

### 制約

- $ N\ \geq\ 2 $
- $ L_i\ \geq\ 2 $
- 袋に入っているボールの個数の総積は $ 10^5 $ を超えない。すなわち、$ \displaystyle\prod_{i=1}^{N}L_i\ \leq\ 10^5 $
- $ 1\ \leq\ a_{i,j}\ \leq\ 10^9 $
- $ 1\ \leq\ X\ \leq\ 10^{18} $
- 入力に含まれる値は全て整数である。

### Sample Explanation 1

袋 $ 1 $ の $ 3 $ 番目のボールと袋 $ 2 $ の $ 1 $ 番目のボールを選ぶと、$ a_{1,3} \times\ a_{2,1}\ =\ 4\ \times\ 10\ =\ 40 $ となります。 袋 $ 1 $ の $ 2 $ 番目のボールと袋 $ 2 $ の $ 2 $ 番目のボールを選ぶと、$ a_{1,2} \times\ a_{2,2}\ =\ 8\ \times\ 5\ =\ 40 $ となります。 これ以外に総積が $ 40 $ になる取り出し方は存在しないので、答えは $ 2 $ です。

### Sample Explanation 2

書かれた数が同じであっても全てのボールは区別することに注意してください。

### Sample Explanation 3

総積が $ X $ になる取り出し方が $ 1 $ つも存在しないこともあります。

## 样例 #1

### 输入

```
2 40

3 1 8 4

2 10 5
```

### 输出

```
2
```

## 样例 #2

### 输入

```
3 200

3 10 10 10

3 10 10 10

5 2 2 2 2 2
```

### 输出

```
45
```

## 样例 #3

### 输入

```
3 1000000000000000000

2 1000000000 1000000000

2 1000000000 1000000000

2 1000000000 1000000000
```

### 输出

```
0
```



---

---
title: "[ABC234D] Prefix K-th Max"
layout: "post"
diff: 普及-
pid: AT_abc234_d
tag: []
---

# [ABC234D] Prefix K-th Max

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc234/tasks/abc234_d

$ (1,2,\ldots,N) $ の順列 $ P=(P_1,P_2,\ldots,P_N) $、および正整数 $ K $ が与えられます。

$ i=K,K+1,\ldots,N $ について、以下を求めてください。

- $ P $ の先頭 $ i $ 項のうち、$ K $ 番目に大きい値

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ K $ $ P_1 $ $ P_2 $ $ \ldots $ $ P_N $

## 输出格式

$ i=K,K+1,\ldots,N $ についてこの順に、問題文中で問われている値を改行区切りで出力せよ。

## 说明/提示

### 制約

- $ 1\ \leq\ K\ \leq\ N\ \leq\ 5\ \times\ 10^5 $
- $ (P_1,P_2,\ldots,P_N) $ は $ (1,2,\ldots,N) $ の並び替えによって得られる
- 入力はすべて整数

### Sample Explanation 1

\- $ P $ の先頭 $ 2 $ 項、すなわち $ (P_1,P_2)=(1,2) $ の中で $ K=2 $ 番目に大きい値は $ 1 $ となります。 - $ P $ の先頭 $ 3 $ 項、すなわち $ (P_1,P_2,P_3)=(1,2,3) $ の中で $ K=2 $ 番目に大きい値は $ 2 $ となります。

## 样例 #1

### 输入

```
3 2

1 2 3
```

### 输出

```
1

2
```

## 样例 #2

### 输入

```
11 5

3 7 2 5 11 6 1 9 8 10 4
```

### 输出

```
2

3

3

5

6

7

7
```



---

---
title: "[ABC237D] LR insertion"
layout: "post"
diff: 普及-
pid: AT_abc237_d
tag: []
---

# [ABC237D] LR insertion

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc237/tasks/abc237_d

$ 1 $ 個の $ 0 $ のみからなる数列 $ A=(0) $ があります。  
 また、`L` と `R` のみからなる長さ $ N $ の文字列 $ S=s_1s_2\ldots\ s_N $ が与えられます。

$ i=1,2,\ldots\ ,N $ の順番で、次の操作を行います。

- $ s_i $ が `L` のとき、$ A $ 内にある $ i-1 $ のすぐ左に $ i $ を挿入する
- $ s_i $ が `R` のとき、$ A $ 内にある $ i-1 $ のすぐ右に $ i $ を挿入する

最終的な $ A $ を求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ S $

## 输出格式

最終的な $ A $ を空白区切りで出力せよ。

## 说明/提示

### 制約

- $ 1\leq\ N\ \leq\ 5\times\ 10^5 $
- $ N $ は整数である
- $ |S|\ =\ N $
- $ s_i $ は `L` か `R` のいずれかである

### Sample Explanation 1

はじめ、$ A=(0) $ です。 $ s_1 $ が `L` なので、$ A=(1,0) $ となります。 $ s_2 $ が `R` なので、$ A=(1,2,0) $ となります。 $ s_3 $ が `R` なので、$ A=(1,2,3,0) $ となります。 $ s_4 $ が `L` なので、$ A=(1,2,4,3,0) $ となります。 $ s_5 $ が `R` なので、$ A=(1,2,4,5,3,0) $ となります。

## 样例 #1

### 输入

```
5

LRRLR
```

### 输出

```
1 2 4 5 3 0
```

## 样例 #2

### 输入

```
7

LLLLLLL
```

### 输出

```
7 6 5 4 3 2 1 0
```



---

---
title: "[ABC238C] digitnum"
layout: "post"
diff: 普及-
pid: AT_abc238_c
tag: []
---

# [ABC238C] digitnum

## 题目描述

定义 $f(x)$ 为不大于 $x$ 且位数与 $x$ 相同的正整数的个数。

给定 $N$，求 $\sum\limits_{i=1}^Nf(i)\bmod 998244353$。

## 输入格式

一行一个整数 $N$。

## 输出格式

一行一个整数，代表结果。

## 说明/提示

对于 $100\%$ 的数据，$1\leq N<10^{18}$。

样例 #1 解释：
- 对于 $1\leq x\leq 9$，$f(x)=x$。
- 对于 $10\leq x\leq 16$，$f(x)=x-9$。

综上，和为 $73$。

## 样例 #1

### 输入

```
16
```

### 输出

```
73
```

## 样例 #2

### 输入

```
238
```

### 输出

```
13870
```

## 样例 #3

### 输入

```
999999999999999999
```

### 输出

```
762062362
```



---

---
title: "[ABC240C] Jumping Takahashi"
layout: "post"
diff: 普及-
pid: AT_abc240_c
tag: []
---

# [ABC240C] Jumping Takahashi

## 题目描述

#### 题意简述：
给定两个大小为 $N$ 的数组 $a$ 与 $b$ ，$N$轮选择，每次从 $a[i]$ 与 $b[i]$ 中任选1个数，如果最后n组选出的数之和可以为 $X$ ，输出“Yes”，否则输出“No”

## 输入格式

第一行输入整数 $N,X$ 。
第二至$N+1$行，输入两个整数$a[i]、b[i]$。

## 输出格式

如果 $N$ 次选择的数之和可以为$X$，则输出 ```Yes``` ，否则输出 ```no```。

## 样例 #1

### 输入

```
2 10

3 6

4 5
```

### 输出

```
Yes
```

## 样例 #2

### 输入

```
2 10

10 100

10 100
```

### 输出

```
No
```

## 样例 #3

### 输入

```
4 12

1 8

5 7

3 4

2 6
```

### 输出

```
Yes
```



---

---
title: "[ABC240D] Strange Balls"
layout: "post"
diff: 普及-
pid: AT_abc240_d
tag: []
---

# [ABC240D] Strange Balls

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc240/tasks/abc240_d

高橋君は $ 2 $ 以上の整数が書かれた $ N $ 個のボールを持っており、これらを細長い筒の中に落としていきます。$ i\ \,\ (1\ \leq\ i\ \leq\ N) $ 回目には、$ a_i $ が書かれたボールを落とします。

ボールは特殊な材質でできており、筒の中において $ k\ \,\ (k\ \geq\ 2) $ が書かれたボールが $ k $ 個連続すると、それら $ k $ 個のボールは全て消えてしまいます。

各 $ i\ \,\ (1\ \leq\ i\ \leq\ N) $ について、$ i $ 個目のボールを筒の中に落とした後、筒の中に何個のボールがあるか求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ a_1 $ $ \ldots $ $ a_N $

## 输出格式

$ N $ 行出力せよ。$ i\ \,\ (1\ \leq\ i\ \leq\ N) $ 行目には、$ i $ 個目のボールを筒の中に落とした後、筒の中にあるボールの個数を出力せよ。

## 说明/提示

### 制約

- $ 1\ \leq\ N\ \leq\ 2\ \times\ 10^5 $
- $ 2\ \leq\ a_i\ \leq\ 2\ \times\ 10^5\ \,\ (1\ \leq\ i\ \leq\ N) $
- 入力は全て整数

### Sample Explanation 1

筒の中は次のように変化します。 - $ 1 $ 個目のボールを落とす。筒の中にあるボールに書かれた整数は $ 3 $ である。 - $ 2 $ 個目のボールを落とす。筒の中にあるボールに書かれた整数は下から順に $ 3,\ 2 $ である。 - $ 3 $ 個目のボールを落とす。筒の中にあるボールに書かれた整数は下から順に $ 3,\ 2,\ 3 $ である。 - $ 4 $ 個目のボールを落とす。筒の中にあるボールに書かれた整数は下から順に $ 3,\ 2,\ 3,\ 2 $ である。 - $ 5 $ 個目のボールを落とす。筒の中にあるボールに書かれた整数は下から順に $ 3,\ 2,\ 3,\ 2,\ 2 $ となるが、$ 2 $ が書かれたボールが $ 2 $ 個連続しているのでこれらは消え、下から順に $ 3,\ 2,\ 3 $ となる。 !\[\](https://img.atcoder.jp/ghi/ABC240D\_sample.png)

## 样例 #1

### 输入

```
5

3 2 3 2 2
```

### 输出

```
1

2

3

4

3
```

## 样例 #2

### 输入

```
10

2 3 2 3 3 3 2 3 3 2
```

### 输出

```
1

2

3

4

5

3

2

3

1

0
```



---

---
title: "[ABC241C] Connect 6"
layout: "post"
diff: 普及-
pid: AT_abc241_c
tag: []
---

# [ABC241C] Connect 6

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc241/tasks/abc241_c

$ N $ 行 $ N $ 列のマス目があり、それぞれのマスは白または黒で塗られています。  
マス目の状態は $ N $ 個の文字列 $ S_i $ で表され、 $ S_i $ の $ j $ 文字目が `#` であることはマス目の上から $ i $ 行目、左から $ j $ 列目のマスが黒く塗られていることを、 `.` であることは白く塗られていることをさします。

高橋君はこのマス目のうち高々 $ 2 $ つの白く塗られているマスを選び、黒く塗ることができます。  
マス目の中に、黒く塗られたマスが縦、横、ななめのいずれかの向きに $ 6 $ つ以上連続するようにできるか判定してください。  
ただし、黒く塗られたマスがななめに $ 6 $ つ以上連続するとは、$ N $ 行 $ N $ 列のマス目に完全に含まれる $ 6 $ 行 $ 6 $ 列のマス目であって、その少なくとも一方の対角線上のマスがすべて黒く塗られているようなものが存在する事をさします。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ S_1 $ $ S_2 $ $ \vdots $ $ S_N $

## 输出格式

高々 $ 2 $ つのマス目を黒く塗ることで条件をみたすようにできるなら `Yes` を、そうでないならば `No` を出力せよ。

## 说明/提示

### 制約

- $ 6\ \leq\ N\ \leq\ 1000 $
- $ \lvert\ S_i\rvert\ =N $
- $ S_i $ は `#` と `.` のみからなる。

### Sample Explanation 1

上から $ 3 $ 行目の左から $ 3 $, $ 6 $ 番目のマスを塗ることで横方向に $ 6 $ つの黒く塗られたマスを連続させることができます。

### Sample Explanation 2

高橋君はマス目を新たに黒く塗ることはできませんが、すでにこのマス目は条件をみたしています。

## 样例 #1

### 输入

```
8
........
........
.#.##.#.
........
........
........
........
........
```

### 输出

```
Yes
```

## 样例 #2

### 输入

```
6
######
######
######
######
######
######
```

### 输出

```
Yes
```

## 样例 #3

### 输入

```
10
..........
#..##.....
..........
..........
....#.....
....#.....
.#...#..#.
..........
..........
..........
```

### 输出

```
No
```



---

---
title: "[ABC242C] 1111gal password"
layout: "post"
diff: 普及-
pid: AT_abc242_c
tag: []
---

# [ABC242C] 1111gal password

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc242/tasks/abc242_c

整数 $ N $ が与えられるので、以下の条件を全て満たす整数 $ X $ の個数を $ 998244353 $ で割った余りを求めてください。

- $ N $ 桁の正整数である。
- $ X $ の各桁を上の位から順に $ X_1,X_2,\dots,X_N $ とする。このとき以下の条件を全て満たす。
  - 全ての整数 $ 1\ \le\ i\ \le\ N $ に対して、 $ 1\ \le\ X_i\ \le\ 9 $
  - 全ての整数 $ 1\ \le\ i\ \le\ N-1 $ に対して、 $ |X_i-X_{i+1}|\ \le\ 1 $

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $

## 输出格式

答えを整数として出力せよ。

## 说明/提示

### 制約

- $ N $ は整数
- $ 2\ \le\ N\ \le\ 10^6 $

### Sample Explanation 1

$ 4 $ 桁の整数として、例えば $ 1111,1234,7878,6545 $ が問題文中の条件を満たします。

### Sample Explanation 3

$ 998244353 $ で割った余りを求めることに注意してください。

## 样例 #1

### 输入

```
4
```

### 输出

```
203
```

## 样例 #2

### 输入

```
2
```

### 输出

```
25
```

## 样例 #3

### 输入

```
1000000
```

### 输出

```
248860093
```



---

---
title: "[ABC243C] Collision 2"
layout: "post"
diff: 普及-
pid: AT_abc243_c
tag: []
---

# [ABC243C] Collision 2

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc243/tasks/abc243_c

$ xy $ 座標平面上に $ N $ 人の人がいます。人 $ i $ は $ (X_i,\ Y_i) $ にいます。すべての人は異なる地点にいます。

`L`, `R` からなる長さ $ N $ の文字列 $ S $ があります。  
 人 $ i $ は $ S_i\ = $ `R` ならば右向きに、$ S_i\ = $ `L` ならば左向きに、一斉に同じ速度で歩き始めます。ここで、右は $ x $ 軸の正の向き、左は $ x $ 軸の負の向きです。

たとえば $ (X_1,\ Y_1)\ =\ (2,\ 3),\ (X_2,\ Y_2)\ =\ (1,\ 1),\ (X_3,\ Y_3)\ =(4,\ 1),\ S\ = $ `RRL` の場合は次の図のように動きます。

![image](https://cdn.luogu.com.cn/upload/vjudge_pic/AT_abc243_c/dcf8faf208a98b36fba58ea0016822db31f879c4.png)

反対の向きに歩いている人同士が同じ地点に来ることを「衝突」と呼びます。すべての人が歩き続けたとき、衝突は発生しますか？

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ X_1 $ $ Y_1 $ $ X_2 $ $ Y_2 $ $ \vdots $ $ X_N $ $ Y_N $ $ S $

## 输出格式

衝突が発生するならば `Yes` を、発生しないならば `No` を出力せよ。

## 说明/提示

### 制約

- $ 2\ \leq\ N\ \leq\ 2\ \times\ 10^5 $
- $ 0\ \leq\ X_i\ \leq\ 10^9 $
- $ 0\ \leq\ Y_i\ \leq\ 10^9 $
- $ i\ \neq\ j $ ならば $ (X_i,\ Y_i)\ \neq\ (X_j,\ Y_j) $ である。
- $ X_i,\ Y_i $ はすべて整数である。
- $ S $ は `L` および `R` からなる長さ $ N $ の文字列である。

### Sample Explanation 1

この入力は問題文にある例と同じケースです。 すべての人が歩き続けると人 $ 2 $ と人 $ 3 $ が衝突します。よって `Yes` を出力します。

### Sample Explanation 2

人 $ 1 $ と人 $ 2 $ は同じ向きに歩いているので衝突することはありません。

## 样例 #1

### 输入

```
3

2 3

1 1

4 1

RRL
```

### 输出

```
Yes
```

## 样例 #2

### 输入

```
2

1 1

2 1

RR
```

### 输出

```
No
```

## 样例 #3

### 输入

```
10

1 3

1 4

0 0

0 2

0 4

3 1

2 4

4 2

4 4

3 3

RLRRRLRLRR
```

### 输出

```
Yes
```



---

---
title: "[ABC245C] Choose Elements"
layout: "post"
diff: 普及-
pid: AT_abc245_c
tag: []
---

# [ABC245C] Choose Elements

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc245/tasks/abc245_c

長さ $ N $ の整数からなる数列 $ A=(A_1,\ldots,A_N),B=(B_1,\ldots,B_N) $ が与えられます。

以下の条件を全て満たす長さ $ N $ の数列 $ X=(X_1,\ldots,X_N) $ が存在するかを判定してください。

- すべての $ i(1\leq\ i\leq\ N) $ について、$ X_i\ =\ A_i $ または $ X_i\ =\ B_i $
- すべての $ i(1\leq\ i\leq\ N-1) $ について、$ |X_i\ -\ X_{i+1}|\ \leq\ K $

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ K $ $ A_1 $ $ \ldots $ $ A_N $ $ B_1 $ $ \ldots $ $ B_N $

## 输出格式

条件を全て満たす $ X $ が存在するならば `Yes` と、存在しないならば `No` と出力せよ。

## 说明/提示

### 制約

- $ 1\ \leq\ N\ \leq\ 2\times\ 10^5 $
- $ 0 \leq\ K\ \leq\ 10^9 $
- $ 1\ \leq\ A_i,B_i\ \leq\ 10^9 $
- 入力は全て整数である

### Sample Explanation 1

$ X=(9,6,3,7,5) $ が全ての条件を満たします。

### Sample Explanation 2

条件を満たす $ X $ は存在しません。

## 样例 #1

### 输入

```
5 4

9 8 3 7 2

1 6 2 9 5
```

### 输出

```
Yes
```

## 样例 #2

### 输入

```
4 90

1 1 1 100

1 2 3 100
```

### 输出

```
No
```

## 样例 #3

### 输入

```
4 1000000000

1 1 1000000000 1000000000

1 1000000000 1 1000000000
```

### 输出

```
Yes
```



---

---
title: "[ABC246C] Coupon"
layout: "post"
diff: 普及-
pid: AT_abc246_c
tag: []
---

# [ABC246C] Coupon

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc246/tasks/abc246_c

$ N $ 個の商品があります。$ i\ =\ 1,\ 2,\ \ldots,\ N $ について、$ i $ 番目の商品の値段は $ A_i $ 円です。

高橋君は $ K $ 枚のクーポンを持っています。  
 $ 1 $ 枚のクーポンは $ 1 $ つの商品に対して使用することができ、$ 1 $ つの商品に対してはクーポンを何枚でも（ $ 0 $ 枚でもよい）使用することができます。 値段が $ a $ 円の商品に対して $ k $ 枚のクーポンを使用すると、その商品を $ \max\lbrace\ a\ -\ kX,\ 0\rbrace $ 円で買うことができます。

高橋君がすべての商品を買うために支払う合計金額の最小値を出力してください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ K $ $ X $ $ A_1 $ $ A_2 $ $ \ldots $ $ A_N $

## 输出格式

答えを出力せよ。

## 说明/提示

### 制約

- $ 1\ \leq\ N\ \leq\ 2\ \times\ 10^5 $
- $ 1\ \leq\ K,\ X\ \leq\ 10^9 $
- $ 1\ \leq\ A_i\ \leq\ 10^9 $
- 入力はすべて整数

### Sample Explanation 1

$ 1 $ 番目の商品に対してクーポン $ 1 $ 枚、$ 3 $ 番目の商品に対してクーポン $ 1 $ 枚、$ 5 $ 番目の商品に対してクーポン $ 2 $ 枚を使用すると、 - $ 1 $ 番目の商品を $ \max\lbrace\ A_1-X,\ 0\ \rbrace\ =\ 1 $ 円で買うことができ、 - $ 2 $ 番目の商品を $ \max\lbrace\ A_2,\ 0\ \rbrace\ =\ 3 $ 円で買うことができ、 - $ 3 $ 番目の商品を $ \max\lbrace\ A_3-X,\ 0\ \rbrace\ =\ 3 $ 円で買うことができ、 - $ 4 $ 番目の商品を $ \max\lbrace\ A_4,\ 0\ \rbrace\ =\ 5 $ 円で買うことができ、 - $ 5 $ 番目の商品を $ \max\lbrace\ A_5-2X,\ 0\ \rbrace\ =\ 0 $ 円で買うことができます。 よって、すべての商品を $ 1\ +\ 3\ +\ 3\ +\ 5\ +\ 0\ =\ 12 $ 円で買うことができ、これが最小です。

## 样例 #1

### 输入

```
5 4 7

8 3 10 5 13
```

### 输出

```
12
```

## 样例 #2

### 输入

```
5 100 7

8 3 10 5 13
```

### 输出

```
0
```

## 样例 #3

### 输入

```
20 815 60

2066 3193 2325 4030 3725 1669 1969 763 1653 159 5311 5341 4671 2374 4513 285 810 742 2981 202
```

### 输出

```
112
```



---

---
title: "[ABC247D] Cylinder"
layout: "post"
diff: 普及-
pid: AT_abc247_d
tag: []
---

# [ABC247D] Cylinder

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc247/tasks/abc247_d

空の筒があります。$ Q $ 個のクエリが与えられるので順に処理してください。  
クエリは次の $ 2 $ 種類のいずれかです。

- `1 x c`：数 $ x $ が書かれたボールを筒の右側から $ c $ 個入れる
- `2 c`：筒の左側からボールを $ c $ 個取り出し、取り出したボールに書かれている数の合計を出力する

なお、筒の中でボールの順序が入れ替わることはないものとします。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ Q $ $ {\rm\ query}_1 $ $ \vdots $ $ {\rm\ query}_Q $

$ i $ 番目のクエリを表す $ {\rm\ query}_i $ は以下の $ 2 $ 種類のいずれかである。

> $ 1 $ $ x $ $ c $

> $ 2 $ $ c $

## 输出格式

`2 c` のクエリに対する答えを順に改行区切りで出力せよ。

## 说明/提示

### 制約

- $ 1\ \leq\ Q\ \leq\ 2\times\ 10^5 $
- $ 0\ \leq\ x\ \leq\ 10^9 $
- $ 1\ \leq\ c\ \leq\ 10^9 $
- `2 c` のクエリが与えられるとき、筒の中には $ c $ 個以上のボールがある
- 入力に含まれる値は全て整数である

### Sample Explanation 1

\- $ 1 $ 番目のクエリでは、$ 2 $ が書かれたボールを筒の右側から $ 3 $ 個入れます。 筒の中のボールに書かれた数は左から順に $ (2,2,2) $ となります。 - $ 2 $ 番目のクエリでは、筒の左側からボールを $ 2 $ 個取り出します。 取り出されたボールに書かれている数はそれぞれ $ 2,2 $ であり、合計は $ 4 $ であるため、これを出力します。 筒の中のボールに書かれた数は左から順に $ (2) $ となります。 - $ 3 $ 番目のクエリでは、$ 3 $ が書かれたボールを筒の右側から $ 4 $ 個入れます。 筒の中のボールに書かれた数は左から順に $ (2,3,3,3,3) $ となります。 - $ 4 $ 番目のクエリでは、筒の左側からボールを $ 3 $ 個取り出します。 取り出されたボールに書かれている数はそれぞれ $ 2,3,3 $ であり、合計は $ 8 $ であるため、これを出力します。 筒の中のボールに書かれた数は左から順に $ (3,3) $ となります。

### Sample Explanation 3

出力するものがないこともあります。

## 样例 #1

### 输入

```
4
1 2 3
2 2
1 3 4
2 3
```

### 输出

```
4
8
```

## 样例 #2

### 输入

```
2
1 1000000000 1000000000
2 1000000000
```

### 输出

```
1000000000000000000
```

## 样例 #3

### 输入

```
5
1 1 1
1 1 1
1 1 1
1 1 1
1 1 1
```

### 输出

```

```



---

---
title: "[ABC249C] Just K"
layout: "post"
diff: 普及-
pid: AT_abc249_c
tag: []
---

# [ABC249C] Just K

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc249/tasks/abc249_c

英小文字のみからなる $ N $ 個の文字列 $ S_1,S_2,\dots,S_N $ が与えられます。

$ S_1,S_2,\dots,S_N $ から文字列を好きな個数選ぶことを考えます。

このとき、「選んだ文字列の中でちょうど $ K $ 個の文字列に登場する英小文字」の種類数としてあり得る最大値を求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ K $ $ S_1 $ $ S_2 $ $ \vdots $ $ S_N $

## 输出格式

答えを出力せよ。

## 说明/提示

### 制約

- $ 1\ \le\ N\ \le\ 15 $
- $ 1\ \le\ K\ \le\ N $
- $ N,K $ は整数
- $ S_i $ は英小文字からなる空でない文字列である。
- $ 1\ \le\ i\ \le\ N $ を満たす整数 $ i $ に対し、$ S_i $ に同じ文字は $ 2 $ 個以上含まれない。
- $ i\ \neq\ j $ ならば $ S_i\ \neq\ S_j $ である。

### Sample Explanation 1

$ S_1,S_3,S_4 $ を選んだ場合、`a`,`b`,`c` がちょうど $ 2 $ 個の文字列に含まれます。 $ 4 $ 個以上の文字がちょうど $ 2 $ 個の文字列に含まれるような選び方は存在しないため、答えは $ 3 $ です。

### Sample Explanation 2

同じ文字列を複数回選ぶことはできません。

## 样例 #1

### 输入

```
4 2

abi

aef

bc

acg
```

### 输出

```
3
```

## 样例 #2

### 输入

```
2 2

a

b
```

### 输出

```
0
```

## 样例 #3

### 输入

```
5 2

abpqxyz

az

pq

bc

cy
```

### 输出

```
7
```



---

---
title: "[ABC250C] Adjacent Swaps"
layout: "post"
diff: 普及-
pid: AT_abc250_c
tag: []
---

# [ABC250C] Adjacent Swaps

## 题目描述

#### 【题意翻译】

$N$ 个球左右排成一列。开始，从左到右的第 $i (1 \le i \le N)$ 个球写着整数 $i$。


高桥君进行了 $Q$ 回的操作。第 $i (1 \le i \le Q)$ 次操作如下:


> * 令 $j$ 为 $N$ 个球中写着整数 $x_i$ 的球的位置     
> * 如果 $j = N$，将其与第 $j - 1$ 个球交换；否则，与第 $j + 1$ 个球交换


求操作后的球上分别写着的数字（从左到右输出）。

## 输入格式

第一行为 $N$, $Q$.   
第 $i+1$ 行为 $a_i$.

## 输出格式

从左到右输出操作后的球上分别写着的数字.

## 样例 #1

### 输入

```
5 5

1

2

3

4

5
```

### 输出

```
1 2 3 5 4
```

## 样例 #2

### 输入

```
7 7

7

7

7

7

7

7

7
```

### 输出

```
1 2 3 4 5 7 6
```

## 样例 #3

### 输入

```
10 6

1

5

2

9

6

6
```

### 输出

```
1 2 3 4 5 7 6 8 10 9
```



---

---
title: "[ABC252C] Slot Strategy"
layout: "post"
diff: 普及-
pid: AT_abc252_c
tag: []
---

# [ABC252C] Slot Strategy

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc252/tasks/abc252_c

$ N $ 個のリールからなるスロットがあります。  
 $ i $ 番目のリールの配列は文字列 $ S_i $ によって表されます。 ここで、$ S_i $ は `0`, `1`, $ \ldots $, `9` がちょうど $ 1 $ 回ずつ現れる長さ $ 10 $ の文字列です。

それぞれのリールには対応するボタンがついており、高橋君は各非負整数 $ t $ について、 スロットが回り始めてからちょうど $ t $ 秒後にボタンを $ 1 $ つ選んで押す（または何もしない）ことができます。  
 スロットが回り始めてから $ t $ 秒後に $ i $ 番目のリールに対応するボタンを押すと、 $ i $ 番目のリールは $ S_i $ の $ (t\bmod{10})+1 $ 文字目を表示して止まります。  
 ただし、$ t\bmod{10} $ で $ t $ を $ 10 $ で割ったあまりを表します。

高橋君は全てのリールを止めた上で、表示されている文字が全て同じであるようにしたいです。  
 高橋君が目標を達成できるように全てのリールを止めるまでに、スロットが回り始めてから最小で何秒かかるかを求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ S_1 $ $ S_2 $ $ \vdots $ $ S_N $

## 输出格式

高橋君が目標を達成できるように全てのリールを止めるまでに、スロットが回り始めてから最小で何秒かかるかを出力せよ。

## 说明/提示

### 制約

- $ 2\leq\ N\leq\ 100 $
- $ N $ は整数
- $ S_i $ は `0`, `1`, $ \ldots $, `9` がちょうど $ 1 $ 回ずつ現れる長さ $ 10 $ の文字列

### Sample Explanation 1

高橋君は次のようにそれぞれのリールを止めることでスロットが回り始めてから $ 6 $ 秒後にリールに表示される文字を `8` で揃えることができます。 - スロットの回転開始から $ 0 $ 秒後に $ 2 $ 番目のリールに対応するボタンを押します。$ 2 $ 番目のリールは $ S_2 $ の $ (0\bmod{10})+1=1 $ 文字目である `8` を表示して止まります。 - スロットの回転開始から $ 2 $ 秒後に $ 3 $ 番目のリールに対応するボタンを押します。$ 3 $ 番目のリールは $ S_3 $ の $ (2\bmod{10})+1=3 $ 文字目である `8` を表示して止まります。 - スロットの回転開始から $ 6 $ 秒後に $ 1 $ 番目のリールに対応するボタンを押します。$ 1 $ 番目のリールは $ S_1 $ の $ (6\bmod{10})+1=7 $ 文字目である `8` を表示して止まります。 $ 5 $ 秒以下で全てのリールに表示されている文字を揃える方法はないため、$ 6 $ を出力します。

### Sample Explanation 2

全てのリールを止めた上で、表示されている文字を揃える必要がある事に注意してください。

## 样例 #1

### 输入

```
3

1937458062

8124690357

2385760149
```

### 输出

```
6
```

## 样例 #2

### 输入

```
5

0123456789

0123456789

0123456789

0123456789

0123456789
```

### 输出

```
40
```



---

---
title: "[ABC253C] Max - Min Query"
layout: "post"
diff: 普及-
pid: AT_abc253_c
tag: []
---

# [ABC253C] Max - Min Query

## 题目描述

维护一个数组 $s$。$s$ 初始为空。

按顺序执行 $q$ 个操作，每个操作都是以下三种之一：

- `1 x`：将 $x$ 加入 $s$。
- `2 x c`：将数组中的 $x$ 去除若干次。设 $d$ 为 $x$ 在 $s$ 中出现的次数，那么删除次数将为 $c,d$ 两数中的更小值。
- `3`：输出数组中最大值与最小值的差。保证此时 $s$ 不为空。

## 输入格式

第一行输入一个整数 $q$。

接下来 $q$ 行，每行一个操作，格式如题。

## 输出格式

按顺序输出每个 $3$ 型询问的答案。每次回答完要换行。

## 说明/提示

#### 数据规模与约定

对于全部测试点，数据保证：

- $1 \le c \le q \le 2 \times 10^5$；
- $0 \le x \le 10^9$；
- 输入的数值均为整数。

## 样例 #1

### 输入

```
8

1 3

1 2

3

1 2

1 7

3

2 2 3

3
```

### 输出

```
1

5

4
```

## 样例 #2

### 输入

```
4

1 10000

1 1000

2 100 3

1 10
```

### 输出

```

```



---

---
title: "[ABC253D] FizzBuzz Sum Hard"
layout: "post"
diff: 普及-
pid: AT_abc253_d
tag: []
---

# [ABC253D] FizzBuzz Sum Hard

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc253/tasks/abc253_d

$ 1 $ 以上 $ N $ 以下の整数であって、$ A $ の倍数でも $ B $ の倍数でもないものの総和を求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ A $ $ B $

## 输出格式

答えを出力せよ。

## 说明/提示

### 制約

- $ 1\ \leq\ N,\ A,B\ \leq\ 10^9 $
- 入力は全て整数

### Sample Explanation 1

$ 1 $ 以上 $ 10 $ 以下の整数で $ 3 $ の倍数でも $ 5 $ の倍数でもないのは $ 1,2,4,7,8 $ です。それらの総和は $ 1+2+4+7+8\ =22 $ です。

## 样例 #1

### 输入

```
10 3 5
```

### 输出

```
22
```

## 样例 #2

### 输入

```
1000000000 314 159
```

### 输出

```
495273003954006262
```



---

---
title: "[ABC254C] K Swap"
layout: "post"
diff: 普及-
pid: AT_abc254_c
tag: []
---

# [ABC254C] K Swap

## 题目描述

## 题目翻译

给出一个长为 $n$ 的数列 $a_1, a_2, \cdots, a_n$。再给一个整数 $k$。

每次可以选一个下标 $i$（$1 \le i \le n - k$），将 $a_i$ 和 $a_{i + k}$ 交换。

问能否通过交换让数列 $a$ 成为升序（任意 $a_i \le a_{i  +1}$）？

translate by @[liangbowen](https://www.luogu.com.cn/user/367488)。

## 输入格式

输入包括两行，第一行有 $2$ 个正整数 $n, k$。

第二行有 $n$ 个正整数 $a_1, a_2, \cdots, a_n$。

## 输出格式

如果可以通过交换变成升序，输出 $\texttt{Yes}$。不能变成升序，输出 $\texttt{No}$。

## 说明/提示

$2 \le n \le 2 \times 10^5$；$1 \le k \le n - 1$；$1 \le a_i \le 10^9$。

## 样例 #1

### 输入

```
5 2

3 4 1 3 4
```

### 输出

```
Yes
```

## 样例 #2

### 输入

```
5 3

3 4 1 3 4
```

### 输出

```
No
```

## 样例 #3

### 输入

```
7 5

1 2 3 4 5 5 10
```

### 输出

```
Yes
```



---

---
title: "[ABC255B] Light It Up"
layout: "post"
diff: 普及-
pid: AT_abc255_b
tag: []
---

# [ABC255B] Light It Up

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc255/tasks/abc255_b

$ xy $ 平面上に $ N $ 人の人 $ 1,2,\dots,N $ がおり、人 $ i $ は座標 $ (X_i,Y_i) $ にいます。  
 このうち、 $ K $ 人の人 $ A_1,A_2,\dots,A_K $ に同じ強さの明かりを持たせます。  
 座標 $ (x,y) $ にいる人が強さ $ R $ の明かりを持っている時、その明かりによって中心 $ (x,y) $ 、半径 $ R $ の円の内部全体(境界を含む)が照らされます。  
 すべての人が少なくとも $ 1 $ つの明かりによって照らされるために必要な明かりの強さの最小値を求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ K $ $ A_1 $ $ A_2 $ $ \dots $ $ A_K $ $ X_1 $ $ Y_1 $ $ X_2 $ $ Y_2 $ $ \vdots $ $ X_N $ $ Y_N $

## 输出格式

答えを実数として出力せよ。  
 出力された解と想定解との絶対誤差または相対誤差が $ 10^{-5} $ 以下であるならば、出力は正しいと見なされる。

## 说明/提示

### 制約

- 入力は全て整数
- $ 1\ \le\ K\ <\ N\ \le\ 1000 $
- $ 1\ \le\ A_1\ <\ A_2\ <\ \dots\ <\ A_K\ \le\ N $
- $ |X_i|,|Y_i|\ \le\ 10^5 $
- $ i\ \neq\ j $ ならば $ (X_i,Y_i)\ \neq\ (X_j,Y_j) $

### Sample Explanation 1

この入力では人が $ 4 $ 人おり、そのうち人 $ 2,3 $ が明かりを持ちます。 $ R\ \ge\ \sqrt{5}\ \approx\ 2.236068 $ である時、すべての人が少なくとも $ 1 $ つの明かりによって照らされます。

## 样例 #1

### 输入

```
4 2

2 3

0 0

0 1

1 2

2 0
```

### 输出

```
2.23606797749978969
```

## 样例 #2

### 输入

```
2 1

2

-100000 -100000

100000 100000
```

### 输出

```
282842.712474619009
```

## 样例 #3

### 输入

```
8 3

2 6 8

-17683 17993

93038 47074

58079 -57520

-41515 -89802

-72739 68805

24324 -73073

71049 72103

47863 19268
```

### 输出

```
130379.280458974768
```



---

---
title: "[ABC255C] ±1 Operation 1"
layout: "post"
diff: 普及-
pid: AT_abc255_c
tag: []
---

# [ABC255C] ±1 Operation 1

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc255/tasks/abc255_c

整数 $ X $ が与えられます。この $ X $ に以下を施すことを「操作」と呼びます。

- 以下の $ 2 $ つのうちどちらかを選択し、実行する。
  - $ X $ に $ 1 $ を加算する。
  - $ X $ から $ 1 $ を減算する。

初項 $ A $ 、公差 $ D $ 、項数 $ N $ の等差数列 $ S $ に含まれる数を「良い数」と呼びます。  
 「操作」を $ 0 $ 回以上何度でも使って $ X $ を「良い数」にする時、必要な「操作」の最小回数を求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ X $ $ A $ $ D $ $ N $

## 输出格式

答えを整数として出力せよ。

## 说明/提示

### 制約

- 入力は全て整数
- $ -10^{18}\ \le\ X,A\ \le\ 10^{18} $
- $ -10^6\ \le\ D\ \le\ 10^6 $
- $ 1\ \le\ N\ \le\ 10^{12} $

### Sample Explanation 1

$ A=2,D=3,N=3 $ であるため、 $ S=(2,5,8) $ です。 $ X=6 $ を「良い数」にするためには、 $ X $ から $ 1 $ を減算することを $ 1 $ 度行えば良いです。 $ 0 $ 回の操作で $ X $ を「良い数」にすることはできません。

### Sample Explanation 2

$ D=0 $ である場合もあります。また、操作を $ 1 $ 回も必要としない場合もあります。

## 样例 #1

### 输入

```
6 2 3 3
```

### 输出

```
1
```

## 样例 #2

### 输入

```
0 0 0 1
```

### 输出

```
0
```

## 样例 #3

### 输入

```
998244353 -10 -20 30
```

### 输出

```
998244363
```

## 样例 #4

### 输入

```
-555555555555555555 -1000000000000000000 1000000 1000000000000
```

### 输出

```
444445
```



---

---
title: "[ABC256C] Filling 3x3 array"
layout: "post"
diff: 普及-
pid: AT_abc256_c
tag: []
---

# [ABC256C] Filling 3x3 array

## 题目描述

给你六个正整数 $h_1,h_2,h_3$ 以及 $w_1,w_2,w_3$，请构造出一个 $3 \times 3$ 的**正整数**方阵，使得：

- 方阵内的数均为正整数；
- 对于上起第 $i$ 行中的三个整数，满足：它们的和与 $h_i$ 相等；
- 对于左起第 $i$ 列中的三个整数，满足：它们的和与 $w_i$ 相等。

请求出满足条件的构造方案数。

## 输入格式

一行六个整数 $h_1,h_2,h_3,w_1,w_2,w_3$，相邻的两个整数之间以单个空格隔开。

## 输出格式

一行一个非负整数，即构造方案数。

## 说明/提示

#### 输入输出样例 #1 说明

只有如图一种方案，所以输出 $1$。
![样例 #1 方案](https://img.atcoder.jp/ghi/d53ea47321716fe799854c72b7beff3c.jpg)

#### 输入输出样例 #2 说明

可能没有办法满足条件。

#### 数据规模与约定

$3 \le $ 输入中的所有数 $ \le 30$ 且输入均为整数。

## 样例 #1

### 输入

```
3 4 6 3 3 7
```

### 输出

```
1
```

## 样例 #2

### 输入

```
3 4 5 6 7 8
```

### 输出

```
0
```

## 样例 #3

### 输入

```
5 13 10 6 13 9
```

### 输出

```
120
```

## 样例 #4

### 输入

```
20 25 30 22 29 24
```

### 输出

```
30613
```



---

---
title: "[ABC256D] Union of Interval"
layout: "post"
diff: 普及-
pid: AT_abc256_d
tag: []
---

# [ABC256D] Union of Interval

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc256/tasks/abc256_d

実数 $ L,R $ に対して、$ L $ 以上 $ R $ 未満からなる実数の集合を $ [L,R) $ と表します。このような形で表される集合を右半開区間といいます。

$ N $ 個の右半開区間 $ [L_i,R_i) $ が与えられます。これらの和集合を $ S $ とします。$ S $ を最小の個数の右半開区間の和集合として表してください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ L_1 $ $ R_1 $ $ \vdots $ $ L_N $ $ R_N $

## 输出格式

$ S $ が最小で $ k $ 個の右半開区間の和集合で表せるとする。そのような $ k $ 個の右半開区間 $ [X_i,Y_i) $ を $ X_i $ の昇順で以下のように $ k $ 行出力せよ。

> $ X_1 $ $ Y_1 $ $ \vdots $ $ X_k $ $ Y_k $

## 说明/提示

### 制約

- $ 1\ \leq\ N\ \leq\ 2\times\ 10^5 $
- $ 1\ \leq\ L_i\ \lt\ R_i\ \leq\ 2\times\ 10^5 $
- 入力に含まれる値は全て整数である

### Sample Explanation 1

$ 3 $ つの右半開区間 $ [10,20),[20,30),[40,50) $ の和集合は $ 2 $ つの右半開区間 $ [10,30),[40,50) $ の和集合と等しくなります。

### Sample Explanation 2

$ 3 $ つの右半開区間 $ [10,40),[30,60),[20,50) $ の和集合は $ 1 $ つの右半開区間 $ [10,60) $ と等しくなります。

## 样例 #1

### 输入

```
3

10 20

20 30

40 50
```

### 输出

```
10 30

40 50
```

## 样例 #2

### 输入

```
3

10 40

30 60

20 50
```

### 输出

```
10 60
```



---

---
title: "[ABC257C] Robot Takahashi"
layout: "post"
diff: 普及-
pid: AT_abc257_c
tag: []
---

# [ABC257C] Robot Takahashi

## 题目描述

有 $N$ 个人，每个人要么是小孩，要么是大人。第 $i$ 个人的体重为 $W_i$ 。

给定一个长度为 $N$ 的字符串 $S$ ，若 $S$ 的第 $i$ 个字符为```0```，则第 $i$ 个人为小孩；若 $S$ 的第 $i$ 个字符为```1```，第 $i$ 个人为大人。

高桥君认为，如果一个人体重小于 $X$ ，则他是小孩；如果一个人体重大于等于 $X$ ，则他是大人。

请选择合适的实数 $X$ ，使得高桥君判断正确的人数最大。输出这个最大值。

### 数据范围 ###

$1 \leq N \leq 2×10^5$

$S$ 是一个长度为 $N$ 且仅含```0```、```1```的字符串。

$1 \leq W_i \leq 10^9$

保证 $N$ 和 $W_i$ 都是整数。

## 输入格式

数据以下列形式给出：

$N$

$S$

$W_1$ $W_2$ … $W_N$

## 输出格式

选择合适的实数 $X$ ，使得高桥君判断正确的人数最大。输出这个最大值，并在末尾换行。

### 样例解释 ###

#### 样例1 ####

高桥君可以令 $X=50$ ，他判定第 $2,3,4$ 个人为小孩，其他人为大人。实际上，只有第 $2,4$ 个人为小孩，其他人为大人。高桥君判断正确了第 $1,2,4,5$ 个人，一共 $4$ 个人。这是最大值。

#### 样例2 ####

高桥君可以令 $X=10$ ，三个人都将判断正确。注意，有可能所有人都是大人，也有可能所有人都是小孩。

#### 样例3 ####

高桥君可以令 $X=55$ ，他将判断正确了 $4$ 个人。这是最大值。注意，可能会有两个人的体重相同。

## 样例 #1

### 输入

```
5

10101

60 45 30 40 80
```

### 输出

```
4
```

## 样例 #2

### 输入

```
3

000

1 2 3
```

### 输出

```
3
```

## 样例 #3

### 输入

```
5

10101

60 50 50 50 60
```

### 输出

```
4
```



---

---
title: "[ABC258B] Number Box"
layout: "post"
diff: 普及-
pid: AT_abc258_b
tag: []
---

# [ABC258B] Number Box

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc258/tasks/abc258_b

正整数 $ N $ が与えられます。

$ N $ 行 $ N $ 列のマス目があり、上から $ i $ 行目、左から $ j $ 列目のマスには数字 $ A_{i,j} $ が書かれています。

このマス目は上下および左右がつながっているものとします。つまり以下が全て成り立ちます。

- $ (1,i) $ の上のマスは $ (N,i) $ であり、$ (N,i) $ の下のマスは $ (1,i) $ である。$ (1\le\ i\le\ N) $
- $ (i,1) $ の左のマスは $ (i,N) $ であり、$ (i,N) $ の右のマスは $ (i,1) $ である。$ (1\le\ i\le\ N) $

高橋君は、上下左右および斜めの $ 8 $ 方向のうちいずれかを初めに選びます。そして、好きなマスから決めた方向に $ 1 $ マス移動することを $ N-1 $ 回繰り返します。

高橋君は $ N $ 個のマス上を移動することになりますが、高橋君が通ったマスに書かれている数字を左から通った順番に並べた整数としてあり得る最大のものを求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ A_{1,1}A_{1,2}\dots\ A_{1,N} $ $ A_{2,1}A_{2,2}\dots\ A_{2,N} $ $ \vdots $ $ A_{N,1}A_{N,2}\dots\ A_{N,N} $

## 输出格式

答えを出力せよ。

## 说明/提示

### 制約

- $ 1\ \le\ N\ \le\ 10 $
- $ 1\ \le\ A_{i,j}\ \le\ 9 $
- 入力はすべて整数。

### Sample Explanation 1

高橋君が上から $ 2 $ 行目、左から $ 4 $ 列目のマスから出発し、右下に進むことで、通ったマスに書かれた数字を並べ $ 9786 $ を作ることができます。 $ 9786 $ より大きい値を作ることはできないため、$ 9786 $ が解です。

### Sample Explanation 2

32bit整数型に答えが収まるとは限らないことに注意してください。

## 样例 #1

### 输入

```
4
1161
1119
7111
1811
```

### 输出

```
9786
```

## 样例 #2

### 输入

```
10
1111111111
1111111111
1111111111
1111111111
1111111111
1111111111
1111111111
1111111111
1111111111
1111111111
```

### 输出

```
1111111111
```



---

---
title: "[ABC258C] Rotation"
layout: "post"
diff: 普及-
pid: AT_abc258_c
tag: []
---

# [ABC258C] Rotation

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc258/tasks/abc258_c

正整数 $ N,Q $ と、長さ $ N $ の英小文字からなる文字列 $ S $ が与えられます。

以下で説明されるクエリを $ Q $ 個処理してください。クエリは次の $ 2 $ 種類のいずれかです。

- `1 x`: 「$ S $ の末尾の文字を削除し、先頭に挿入する」という操作を $ x $ 回連続で行う。
- `2 x`: $ S $ の $ x $ 番目の文字を出力する。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ Q $ $ S $ $ \mathrm{query}_1 $ $ \mathrm{query}_2 $ $ \vdots $ $ \mathrm{query}_Q $

それぞれのクエリは以下の形式で与えられる。ここで、$ t $ は $ 1 $ または $ 2 $ である。

> $ t $ $ x $

## 输出格式

`2 x` の形式の各クエリについて、答えを一行に出力せよ。

## 说明/提示

### 制約

- $ 2\ \le\ N\ \le\ 5\ \times\ 10^5 $
- $ 1\ \le\ Q\ \le\ 5\ \times\ 10^5 $
- $ 1\ \le\ x\ \le\ N $
- $ |S|=N $
- $ S $ は英小文字からなる。
- `2 x` の形式のクエリが $ 1 $ 個以上与えられる。
- $ N,Q,x $ はすべて整数。

### Sample Explanation 1

$ 1 $ 個目のクエリのとき、$ S $ は `abc` なので $ 2 $ 文字目の `b` を出力します。 $ 2 $ 個目のクエリのとき、$ S $ は `abc` から `cab` に変わります。 $ 3 $ 個目のクエリのとき、$ S $ は `cab` なので $ 2 $ 文字目の `a` を出力します。

## 样例 #1

### 输入

```
3 3
abc
2 2
1 1
2 2
```

### 输出

```
b
a
```

## 样例 #2

### 输入

```
10 8
dsuccxulnl
2 4
2 7
1 2
2 7
1 1
1 2
1 3
2 5
```

### 输出

```
c
u
c
u
```



---

---
title: "[ABC258D] Trophy"
layout: "post"
diff: 普及-
pid: AT_abc258_d
tag: []
---

# [ABC258D] Trophy

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc258/tasks/abc258_d

$ N $ 個のステージからなるゲームがあり、$ i\ \,\ (1\ \leq\ i\ \leq\ N) $ 番目のステージは $ A_i $ 分間のストーリー映像と $ B_i $ 分間のゲームプレイによって構成されます。

初めて $ i $ 番目のステージをクリアするためにはストーリー映像の視聴とゲームプレイを両方行う必要がありますが、二回目以降はストーリー映像をスキップすることができるので、ゲームプレイのみでクリアすることができます。

初めから遊べるのは $ 1 $ 番目のステージのみですが、$ i\ \,\ (1\ \leq\ i\ \leq\ N\ -\ 1) $ 番目のステージをクリアすることにより、$ i+1 $ 番目のステージも遊べるようになります。

合計 $ X $ 回ステージをクリアするために必要な時間の最小値を求めてください。ただし、同じステージを複数回クリアしたとしても、全てクリア回数に数えられます。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ X $ $ A_1 $ $ B_1 $ $ \vdots $ $ A_N $ $ B_N $

## 输出格式

答えを出力せよ。

## 说明/提示

### 制約

- $ 1\ \leq\ N\ \leq\ 2\ \times\ 10^5 $
- $ 1\ \leq\ A_i,\ B_i\ \leq\ 10^9\ \,\ (1\ \leq\ i\ \leq\ N) $
- $ 1\ \leq\ X\ \leq\ 10^9 $
- 入力は全て整数

### Sample Explanation 1

例えば、次のようにして $ 18 $ 分で $ 4 $ 回クリアすることができます。 - ステージ $ 1 $ をクリアする。$ A_1\ +\ B_1\ =\ 7 $ 分かかる。 - ステージ $ 2 $ をクリアする。$ A_2\ +\ B_2\ =\ 5 $ 分かかる。 - ステージ $ 2 $ を再びクリアする。$ B_2\ =\ 3 $ 分かかる。 - ステージ $ 2 $ を再びクリアする。$ B_2\ =\ 3 $ 分かかる。 $ 17 $ 分以内に $ 4 $ 回クリアすることはできません。

## 样例 #1

### 输入

```
3 4

3 4

2 3

4 2
```

### 输出

```
18
```

## 样例 #2

### 输入

```
10 1000000000

3 3

1 6

4 7

1 8

5 7

9 9

2 4

6 4

5 1

3 1
```

### 输出

```
1000000076
```



---

---
title: "[ABC259C] XX to XXX"
layout: "post"
diff: 普及-
pid: AT_abc259_c
tag: []
---

# [ABC259C] XX to XXX

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc259/tasks/abc259_c

英小文字からなる $ 2 $ つの文字列 $ S,\ T $ が与えられます。 次の操作を好きな回数（ $ 0 $ 回でも良い）行うことで、$ S $ を $ T $ と一致させることができるかを判定してください。

> $ S $ において同じ文字が $ 2 $ 文字連続しているところの間に、その文字と同じ文字を $ 1 $ つ挿入する。 すなわち、下記の $ 3 $ つの手順からなる操作を行う。
> 
> 1. 現在の $ S $ の長さを $ N $ とし、$ S\ =\ S_1S_2\ldots\ S_N $ とする。
> 2. $ 1 $ 以上 $ N-1 $ 以下の整数 $ i $ であって、$ S_i\ =\ S_{i+1} $ を満たすものを $ 1 $ つ選択する。（ただし、そのような $ i $ が存在しない場合は、何もせずに手順 3.をスキップして操作を終了する。）
> 3. $ S $ の $ i $ 文字目と $ i+1 $ 文字目の間に文字 $ S_i(=\ S_{i+1}) $ を $ 1 $ つ挿入する。その結果、$ S $ は長さ $ N+1 $ の文字列 $ S_1S_2\ldots\ S_i\ S_i\ S_{i+1}\ \ldots\ S_N $ となる。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ S $ $ T $

## 输出格式

$ S $ を $ T $ と一致させることができる場合は `Yes` を、そうでない場合は `No` を出力せよ。 ジャッジは英小文字と英大文字を厳密に区別することに注意せよ。

## 说明/提示

### 制約

- $ S $ と $ T $ はそれぞれ英小文字からなる長さ $ 2 $ 以上 $ 2\ \times\ 10^5 $ 以下の文字列

### Sample Explanation 1

下記の $ 3 $ 回の操作によって、$ S\ = $ `abbaac` を $ T\ = $ `abbbbaaac` に一致させることができます。 - まず、$ S $ の $ 2 $ 文字目と $ 3 $ 文字目の間に `b` を挿入する。その結果、$ S\ = $ `abbbaac` となる。 - 次に、再び $ S $ の $ 2 $ 文字目と $ 3 $ 文字目の間に `b` を挿入する。その結果、$ S\ = $ `abbbbaac` となる。 - 最後に、$ S $ の $ 6 $ 文字目と $ 7 $ 文字目の間に `a` を挿入する。その結果、$ S\ = $ `abbbbaaac` となる。 よって、`Yes` を出力します。

### Sample Explanation 2

どのように操作を行っても、 $ S\ = $ `xyzz` を $ T\ = $ `xyyzz` に一致させることはできません。 よって、`No` を出力します。

## 样例 #1

### 输入

```
abbaac

abbbbaaac
```

### 输出

```
Yes
```

## 样例 #2

### 输入

```
xyzz

xyyzz
```

### 输出

```
No
```



---

---
title: "[ABC260C] Changing Jewels"
layout: "post"
diff: 普及-
pid: AT_abc260_c
tag: []
---

# [ABC260C] Changing Jewels

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc260/tasks/abc260_c

高橋君はレベル $ N $ の赤い宝石を $ 1 $ 個持っています。(他に宝石は持っていません。)   
 高橋君は次の操作を好きなだけ行うことができます。

- レベル $ n $ の赤い宝石 ($ n $ は $ 2 $ 以上) を「レベル $ n-1 $ の赤い宝石 $ 1 $ 個と、レベル $ n $ の青い宝石 $ X $ 個」に変換する。
- レベル $ n $ の青い宝石 ($ n $ は $ 2 $ 以上) を「レベル $ n-1 $ の赤い宝石 $ 1 $ 個と、レベル $ n-1 $ の青い宝石 $ Y $ 個」に変換する。

高橋君はレベル $ 1 $ の青い宝石ができるだけたくさんほしいです。操作によって高橋君はレベル $ 1 $ の青い宝石を最大何個入手できますか？

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ X $ $ Y $

## 输出格式

答えを出力せよ。

## 说明/提示

### 制約

- $ 1\ \leq\ N\ \leq\ 10 $
- $ 1\ \leq\ X\ \leq\ 5 $
- $ 1\ \leq\ Y\ \leq\ 5 $
- 入力される値はすべて整数

### Sample Explanation 1

次のような変換を行うことで、高橋君はレベル $ 1 $ の青い宝石を $ 12 $ 個手に入れることができます。 - まず、レベル $ 2 $ の赤い宝石 $ 1 $ 個を、レベル $ 1 $ の赤い宝石 $ 1 $ 個とレベル $ 2 $ の青い宝石 $ 3 $ 個に変換します。 - 操作後の高橋君は、レベル $ 1 $ の赤い宝石 $ 1 $ 個とレベル $ 2 $ の青い宝石 $ 3 $ 個を持っています。 - 次に、レベル $ 2 $ の青い宝石 $ 1 $ 個を、レベル $ 1 $ の赤い宝石 $ 1 $ 個とレベル $ 1 $ の青い宝石 $ 4 $ 個に変換します。この変換を $ 3 $ 回繰り返します。 - 操作後の高橋君は、レベル $ 1 $ の赤い宝石 $ 4 $ 個とレベル $ 1 $ の青い宝石 $ 12 $ 個を持っています。 - これ以上変換を行うことはできません。 $ 12 $ 個より多くレベル $ 1 $ の青い宝石を手に入れることはできないので、答えは $ 12 $ になります。

### Sample Explanation 2

高橋君がレベル $ 1 $ の青い宝石を $ 1 $ 個も手に入れられない場合もあります。

### Sample Explanation 3

答えが $ 32 $ bit 整数に収まらない場合があることに注意してください。

## 样例 #1

### 输入

```
2 3 4
```

### 输出

```
12
```

## 样例 #2

### 输入

```
1 5 5
```

### 输出

```
0
```

## 样例 #3

### 输入

```
10 5 5
```

### 输出

```
3942349900
```



---

---
title: "[ABC262C] Min Max Pair"
layout: "post"
diff: 普及-
pid: AT_abc262_c
tag: []
---

# [ABC262C] Min Max Pair

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc262/tasks/abc262_c

$ 1 $ 以上 $ N $ 以下の整数からなる長さ $ N $ の数列 $ a\ =\ (a_1,\ \dots,\ a_N) $ が与えられます。

以下の条件を全て満たす整数 $ i,\ j $ の組の総数を求めてください。

- $ 1\ \leq\ i\ \lt\ j\ \leq\ N $
- $ \min(a_i,\ a_j)\ =\ i $
- $ \max(a_i,\ a_j)\ =\ j $

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ a_1 $ $ \ldots $ $ a_N $

## 输出格式

答えを出力せよ。

## 说明/提示

### 制約

- $ 2\ \leq\ N\ \leq\ 5\ \times\ 10^5 $
- $ 1\ \leq\ a_i\ \leq\ N\ \,\ (1\ \leq\ i\ \leq\ N) $
- 入力は全て整数

### Sample Explanation 1

$ (i,\ j)\ =\ (1,\ 4),\ (2,\ 3) $ が条件を満たします。

## 样例 #1

### 输入

```
4
1 3 2 4
```

### 输出

```
2
```

## 样例 #2

### 输入

```
10
5 8 2 2 1 6 7 2 9 10
```

### 输出

```
8
```



---

---
title: "[ABC264D] "redocta".swap(i,i+1)"
layout: "post"
diff: 普及-
pid: AT_abc264_d
tag: []
---

# [ABC264D] "redocta".swap(i,i+1)

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc264/tasks/abc264_d

`atcoder` の並べ替えである文字列 $ S $ が与えられます。  
この文字列 $ S $ に対して以下の操作を $ 0 $ 回以上行います。

- $ S $ 中の隣接する $ 2 $ 文字を選び、入れ替える。

$ S $ を `atcoder` にするために必要な最小の操作回数を求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ S $

## 输出格式

答えを整数として出力せよ。

## 说明/提示

### 制約

- $ S $ は `atcoder` の並べ替えである文字列

### Sample Explanation 1

`catredo` $ \rightarrow $ `\[ac\]tredo` $ \rightarrow $ `actre\[od\]` $ \rightarrow $ `actr\[oe\]d` $ \rightarrow $ `actro\[de\]` $ \rightarrow $ `act\[or\]de` $ \rightarrow $ `acto\[dr\]e` $ \rightarrow $ `a\[tc\]odre` $ \rightarrow $ `atcod\[er\]` という流れで操作を行うと、 $ 8 $ 回で $ S $ を `atcoder` にすることができ、これが達成可能な最小の操作回数です。

### Sample Explanation 2

この場合、文字列 $ S $ は元から `atcoder` です。

## 样例 #1

### 输入

```
catredo
```

### 输出

```
8
```

## 样例 #2

### 输入

```
atcoder
```

### 输出

```
0
```

## 样例 #3

### 输入

```
redocta
```

### 输出

```
21
```



---

---
title: "[ABC267C] Index × A(Continuous ver.)"
layout: "post"
diff: 普及-
pid: AT_abc267_c
tag: []
---

# [ABC267C] Index × A(Continuous ver.)

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc267/tasks/abc267_c

長さ $ N $ の整数列 $ A=(A_1,A_2,\dots,A_N) $ が与えられます。

長さ $ M $ の $ A $ の連続部分列 $ B=(B_1,B_2,\dots,B_M) $ に対する、$ \displaystyle\ \sum_{i=1}^{M}\ i\ \times\ B_i $ の最大値を求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ M $ $ A_1 $ $ A_2 $ $ \dots $ $ A_N $

## 输出格式

答えを出力せよ。

## 说明/提示

### 注記

数列の**連続部分列**とは、数列の先頭から $ 0 $ 個以上、末尾から $ 0 $ 個以上の要素を削除して得られる列のことをいいます。

例えば $ (2,\ 3) $ や $ (1,\ 2,\ 3) $ は $ (1,\ 2,\ 3,\ 4) $ の連続部分列ですが、$ (1,\ 3) $ や $ (3,2,1) $ は $ (1,\ 2,\ 3,\ 4) $ の連続部分列ではありません。

### 制約

- $ 1\ \le\ M\ \le\ N\ \le\ 2\ \times\ 10^5 $
- $ -\ 2\ \times\ 10^5\ \le\ A_i\ \le\ 2\ \times\ 10^5 $
- 入力は全て整数。

### Sample Explanation 1

$ B=(A_3,A_4) $ とした場合、$ \displaystyle\ \sum_{i=1}^{M}\ i\ \times\ B_i\ =\ 1\ \times\ (-1)\ +\ 2\ \times\ 8\ =\ 15 $ となります。$ 16 $ 以上の値を達成することはできないため、解は $ 15 $ です。 $ B=(A_1,A_4) $ などを選ぶことができないことに注意してください。

## 样例 #1

### 输入

```
4 2

5 4 -1 8
```

### 输出

```
15
```

## 样例 #2

### 输入

```
10 4

-3 1 -4 1 -5 9 -2 6 -5 3
```

### 输出

```
31
```



---

---
title: "[ABC268C] Chinese Restaurant"
layout: "post"
diff: 普及-
pid: AT_abc268_c
tag: []
---

# [ABC268C] Chinese Restaurant

## 题目描述

#### 题意
有 $N$ 个人从 $0$ 开始编号， 按逆时针顺序间隔均匀地坐在转盘周围。 在开始时， 第 $p_{i}$ 盘菜在第 $i$ 个人的前面。  

现在， 你可以进行以下操作 $0$ 次或多次。

- 将转盘逆时针旋转 $\frac{1}{N}$ 圈。也就是说， 旋转前在第 $i$ 号人面前的盘子现在在 $(i+1)\bmod N$ 号人面前了。

当你结束操作后，如果第 $i$ 盘菜在第 $(i-1)\bmod N$ 个人、第 $i$ 个人或第  $(i+1)\bmod N$ 个人面前，第 $i$ 个人就会感到高兴。

请求出你最多能使多少人感到高兴。

## 输入格式

使用标准输入以以下格式读入：
```
N
p0 ... pN-1
```

## 输出格式

直接输出答案

---

#### 样例解释1

下图是一次操作后的桌面

![](https://img.atcoder.jp/abc268/70536a7b7fad87d6a49ad00df89a4a30.png)

这里有四个人感到快乐：

- 第 $0$ 个人感到快乐，因为第 $0$ 盘菜在第 $3\ (=(0 - 1) \bmod 4)$ 个人面前；
- 第 $1$ 个人感到快乐，因为第 $1$ 盘菜在第 $1$ 个人面前
- 第 $2$ 个人感到快乐，因为第 $2$ 盘菜在第 $2$ 个人面前
- 第 $3$ 个人感到快乐，因为第 $3$ 盘菜在第 $0\ (=(3+1)\bmod 4)$ 个人面前

很显然不能有五个或更多的人感到快乐了，所以答案是 $4$ .

## 说明/提示

- $3 \leq N \leq 2 × 10^{5} $
- $0 \leq p_{i} \leq N - 1$
- 当 $i \ne j$ 时 $p_{i}\ne p_{j}$
- 所有输入都是整数

---

## 样例 #1

### 输入

```
4

1 2 0 3
```

### 输出

```
4
```

## 样例 #2

### 输入

```
3

0 1 2
```

### 输出

```
3
```

## 样例 #3

### 输入

```
10

3 9 6 1 7 2 8 0 5 4
```

### 输出

```
5
```



---

---
title: "[ABC269C] Submask"
layout: "post"
diff: 普及-
pid: AT_abc269_c
tag: []
---

# [ABC269C] Submask

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc269/tasks/abc269_c

非負整数 $ N $ が与えられるので、以下の条件を満たす非負整数 $ x $ を昇順に全て出力してください。

- $ x $ を $ 2 $ 進数として表記した時に $ 1 $ となる位の集合が、 $ N $ を $ 2 $ 進数として表記した時に $ 1 $ となる位の集合の部分集合となる。
  - すなわち、全ての非負整数 $ k $ について、「 $ x $ の $ 2^k $ の位が $ 1 $ ならば、 $ N $ の $ 2^k $ の位は $ 1 $ 」が成り立つ。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $

## 输出格式

答えを $ 1 $ 行に $ 1 $ つずつ、$ 10 $ 進法の整数として昇順に出力せよ。

## 说明/提示

### 制約

- $ N $ は整数
- $ 0\ \le\ N\ <\ 2^{60} $
- $ N $ を $ 2 $ 進数として表記した時、 $ 1 $ となる位は $ 15 $ 個以下である

### Sample Explanation 1

$ N\ =\ 11_{(10)} $ を $ 2 $ 進数で表記すると、 $ 1011_{(2)} $ となります。 条件を満たす非負整数 $ x $ は以下の通りです。 - $ 0000_{(2)}=0_{(10)} $ - $ 0001_{(2)}=1_{(10)} $ - $ 0010_{(2)}=2_{(10)} $ - $ 0011_{(2)}=3_{(10)} $ - $ 1000_{(2)}=8_{(10)} $ - $ 1001_{(2)}=9_{(10)} $ - $ 1010_{(2)}=10_{(10)} $ - $ 1011_{(2)}=11_{(10)} $

### Sample Explanation 3

入力は $ 32 $bit 符号付き整数に収まらない可能性があります。

## 样例 #1

### 输入

```
11
```

### 输出

```
0

1

2

3

8

9

10

11
```

## 样例 #2

### 输入

```
0
```

### 输出

```
0
```

## 样例 #3

### 输入

```
576461302059761664
```

### 输出

```
0

524288

549755813888

549756338176

576460752303423488

576460752303947776

576461302059237376

576461302059761664
```



---

---
title: "[ABC269D] Do use hexagon grid"
layout: "post"
diff: 普及-
pid: AT_abc269_d
tag: []
---

# [ABC269D] Do use hexagon grid

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc269/tasks/abc269_d

以下のような、無限に広い六角形のグリッドがあります。最初、全てのマスは白です。

![](https://cdn.luogu.com.cn/upload/vjudge_pic/AT_abc269_d/992f7292cb6316e33ee0c40605e4a519c5d857df.png)

ある六角形のマスは $ 2 $ つの整数 $ i,j $ を用いて $ (i,j) $ と表されます。  
 マス $ (i,j) $ は以下の $ 6 $ つのマスと隣接します。

- $ (i-1,j-1) $
- $ (i-1,j) $
- $ (i,j-1) $
- $ (i,j+1) $
- $ (i+1,j) $
- $ (i+1,j+1) $

高橋くんは、 $ N $ 個のマス $ (X_1,Y_1),(X_2,Y_2),\dots,(X_N,Y_N) $ を黒く塗りました。  
 黒いマスがいくつの連結成分をなすか求めてください。  
 ただし、ある $ 2 $ つの黒いマスが同じ連結成分に属するとは、この $ 2 $ つの黒いマスの間をいくつかの隣接する黒いマスを辿って移動できることを指します。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ X_1 $ $ Y_1 $ $ X_2 $ $ Y_2 $ $ \vdots $ $ X_N $ $ Y_N $

## 输出格式

答えを整数として出力せよ。

## 说明/提示

### 制約

- 入力は全て整数
- $ 1\ \le\ N\ \le\ 1000 $
- $ |X_i|,|Y_i|\ \le\ 1000 $
- $ (X_i,Y_i) $ は相異なる

### Sample Explanation 1

高橋くんがマスを黒く塗った後、グリッドは下図の状態になります。 !\[\](https://img.atcoder.jp/abc269/865747dac44d93b150ecbed462ac4ef3.png) 黒いマスがなす連結成分は以下の $ 3 $ つです。 - $ (-1,-1) $ - $ (1,0),(2,0) $ - $ (0,1),(0,2),(1,2) $

## 样例 #1

### 输入

```
6

-1 -1

0 1

0 2

1 0

1 2

2 0
```

### 输出

```
3
```

## 样例 #2

### 输入

```
4

5 0

4 1

-3 -4

-2 -5
```

### 输出

```
4
```

## 样例 #3

### 输入

```
5

2 1

2 -1

1 0

3 1

1 -1
```

### 输出

```
1
```



---

---
title: "[ABC270C] Simple path"
layout: "post"
diff: 普及-
pid: AT_abc270_c
tag: []
---

# [ABC270C] Simple path

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc270/tasks/abc270_c

$ N $ 頂点の木 $ T $ があり、 $ i $ $ (1\leq\ i\leq\ N-1) $ 番目の辺は頂点 $ U_i $ と頂点 $ V_i $ を結んでいます。

$ T $ 上の相異なる $ 2 $ 頂点 $ X,Y $ が与えられるので、 頂点 $ X $ から頂点 $ Y $ への単純パス上の頂点（端点含む）を順に列挙してください。

ただし、木上の任意の相異なる $ 2 $ 頂点 $ a,b $ について、$ a $ から $ b $ への単純パスがただ一つ存在することが証明できます。

単純パスとは？グラフ $ G $ 上の頂点 $ X,Y $ に対して、頂点列 $ v_1,v_2,\ \ldots,\ v_k $ であって、 $ v_1=X $, $ v_k=Y $ かつ、$ 1\leq\ i\leq\ k-1 $ に対して $ v_i $ と $ v_{i+1} $ が辺で結ばれているようなものを頂点 $ X $ から頂点 $ Y $ への **パス** と呼びます。 さらに、$ v_1,v_2,\ \ldots,\ v_k $ がすべて異なるようなものを頂点 $ X $ から頂点 $ Y $ への **単純パス** と呼びます。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ X $ $ Y $ $ U_1 $ $ V_1 $ $ U_2 $ $ V_2 $ $ \vdots $ $ U_{N-1} $ $ V_{N-1} $

## 输出格式

頂点 $ X $ から頂点 $ Y $ への単純パス上の頂点番号を順に空白区切りで出力せよ。

## 说明/提示

### 制約

- $ 1\leq\ N\leq\ 2\times\ 10^5 $
- $ 1\leq\ X,Y\leq\ N $
- $ X\neq\ Y $
- $ 1\leq\ U_i,V_i\leq\ N $
- 入力はすべて整数
- 与えられるグラフは木

### Sample Explanation 1

木 $ T $ は以下のような形であり、頂点 $ 2 $ から頂点 $ 5 $への単純パスは 頂点 $ 2 $ $ \to $ 頂点 $ 1 $ $ \to $ 頂点 $ 3 $ $ \to $ 頂点 $ 5 $ となります。 よって、$ 2,1,3,5 $ をこの順に空白区切りで出力します。 !\[\](https://img.atcoder.jp/abc270/4f4278d90219acdbf32e838353b7a55a.png)

### Sample Explanation 2

木 $ T $ は以下のような形です。 !\[\](https://img.atcoder.jp/abc270/3766cc7963f74e28fa0de6ff660b1998.png)

## 样例 #1

### 输入

```
5 2 5
1 2
1 3
3 4
3 5
```

### 输出

```
2 1 3 5
```

## 样例 #2

### 输入

```
6 1 2
3 1
2 5
1 2
4 1
2 6
```

### 输出

```
1 2
```



---

---
title: "[ABC273C] (K+1)-th Largest Number"
layout: "post"
diff: 普及-
pid: AT_abc273_c
tag: []
---

# [ABC273C] (K+1)-th Largest Number

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc273/tasks/abc273_c

長さ $ N $ の数列 $ A\ =\ (A_1,\ A_2,\ \ldots,\ A_N) $ が与えられます。 $ K\ =\ 0,\ 1,\ 2,\ \ldots,\ N-1 $ のそれぞれについて、下記の問題を解いてください。

> $ 1 $ 以上 $ N $ 以下の整数 $ i $ であって、次の条件を満たすものの個数を求めよ。
> 
> - $ A $ に含まれる整数のうち $ A_i $ より大きいものはちょうど $ K $ 種類である。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ A_1 $ $ A_2 $ $ \ldots $ $ A_N $

## 输出格式

$ N $ 行出力せよ。 $ i\ =\ 1,\ 2,\ \ldots,\ N $ について、$ i $ 行目には $ K\ =\ i-1 $ の場合の問題の答えを出力せよ。

## 说明/提示

### 制約

- $ 1\ \leq\ N\ \leq\ 2\ \times\ 10^5 $
- $ 1\ \leq\ A_i\ \leq\ 10^9 $
- 入力はすべて整数

### Sample Explanation 1

例として、$ K\ =\ 2 $ の場合の問題の答えを以下で求めます。 - $ A_1\ =\ 2 $ に関して、$ A $ に含まれる整数のうち $ A_1 $ より大きいものは、$ 7,\ 8 $ の $ 2 $ 種類です。 - $ A_2\ =\ 7 $ に関して、$ A $ に含まれる整数のうち $ A_2 $ より大きいものは、$ 8 $ の $ 1 $ 種類です。 - $ A_3\ =\ 1 $ に関して、$ A $ に含まれる整数のうち $ A_3 $ より大きいものは、$ 2,\ 7,\ 8 $ の $ 3 $ 種類です。 - $ A_4\ =\ 8 $ に関して、$ A $ に含まれる整数のうち $ A_4 $ より大きいものは、$ 0 $ 種類です（存在しません）。 - $ A_5\ =\ 2 $ に関して、$ A $ に含まれる整数のうち $ A_5 $ より大きいものは、$ 7,\ 8 $ の $ 2 $ 種類です。 - $ A_6\ =\ 8 $ に関して、$ A $ に含まれる整数のうち $ A_6 $ より大きいものは、$ 0 $ 種類です（存在しません）。 よって、$ A $ に含まれる整数のうち$ A_i $ より大きいものがちょうど $ K\ =\ 2 $ 種類であるような $ i $ は、$ i\ =\ 1 $ と $ i\ =\ 5 $ の $ 2 $ つです。よって、$ K\ =\ 2 $ の場合の答えは $ 2 $ です。

## 样例 #1

### 输入

```
6

2 7 1 8 2 8
```

### 输出

```
2

1

2

1

0

0
```

## 样例 #2

### 输入

```
1

1
```

### 输出

```
1
```

## 样例 #3

### 输入

```
10

979861204 57882493 979861204 447672230 644706927 710511029 763027379 710511029 447672230 136397527
```

### 输出

```
2

1

2

1

2

1

1

0

0

0
```



---

---
title: "[ABC274C] Ameba"
layout: "post"
diff: 普及-
pid: AT_abc274_c
tag: []
---

# [ABC274C] Ameba

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc274/tasks/abc274_c

あなたはアメーバの観察記録をつけました。

最初 $ 1 $ 匹のアメーバがおり、番号は $ 1 $ です。

観察記録は時系列順に $ N $ 個あり、$ i $ 番目の観察記録は「番号 $ A_i $ のアメーバが分裂して消滅し、新たに $ 2 $ 匹のアメーバが生まれ、それらにそれぞれ $ 2i,2i+1 $ と番号をつけた」というものです。  
 このとき、アメーバ $ A_i $ を アメーバ $ 2i,2i+1 $ の親と呼びます。

各 $ k=1,\ldots,2N+1 $ について、アメーバ $ k $ から何代親を遡るとアメーバ $ 1 $ になるか求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ A_1 $ $ A_2 $ $ \ldots $ $ A_N $

## 输出格式

$ 2N+1 $ 行出力せよ。$ k $ 行目にはアメーバ $ k $ から何代親を遡るとアメーバ $ 1 $ になるかを出力せよ。

## 说明/提示

### 制約

- $ 1\ \leq\ N\ \leq\ 2\times\ 10^5 $
- 観察記録は矛盾していない。すなわち
  - $ 1\leq\ A_i\ \leq\ 2i-1 $
  - $ A_i $ は相異なる整数

### Sample Explanation 1

アメーバ $ 1 $ からアメーバ $ 2,3 $ が生まれ、アメーバ $ 2 $ からアメーバ $ 4,5 $ が生まれました。 - アメーバ $ 1 $ は $ 0 $ 代遡るとアメーバ $ 1 $ になります。 - アメーバ $ 2 $ は $ 1 $ 代遡るとアメーバ $ 1 $ になります。 - アメーバ $ 3 $ は $ 1 $ 代遡るとアメーバ $ 1 $ になります。 - アメーバ $ 4 $ は $ 1 $ 代遡るとアメーバ $ 2 $ になり、$ 2 $ 代遡るとアメーバ $ 1 $ になります。 - アメーバ $ 5 $ は $ 1 $ 代遡るとアメーバ $ 2 $ になり、$ 2 $ 代遡るとアメーバ $ 1 $ になります。

## 样例 #1

### 输入

```
2

1 2
```

### 输出

```
0

1

1

2

2
```

## 样例 #2

### 输入

```
4

1 3 5 2
```

### 输出

```
0

1

1

2

2

3

3

2

2
```



---

---
title: "[ABC275D] Yet Another Recursive Function"
layout: "post"
diff: 普及-
pid: AT_abc275_d
tag: []
---

# [ABC275D] Yet Another Recursive Function

## 题目描述

定义函数 $f(x)$ 有如下定义

- $ f(0)\ =\ 1 $
- 对于任意正整数 $k$ 有 $f(k)\ = f(\lfloor\frac{k}{2}\rfloor)\ +\ f(\lfloor\frac{k}{3}\rfloor) $

$ \lfloor A\rfloor $ 代表小于等于 $A$ 的最大整数。

求 $f(x)$。

## 输入格式

一个整数。

> $ N $

## 输出格式

一行，一个整数，代表 $f(N)$ 的值。

## 样例 #1

### 样例输入 #1

```
2
```

### 样例输出 #1

```
3
```

## 样例 #2

### 样例输入 #2

```
0
```

### 样例输出 #2

```
1
```

## 样例 #3

### 样例输入 #3

```
100
```

### 样例输出 #3

```
55
```

## 说明/提示

- $ 0\ \le\ N\ \le\ 10^{18} $

### 样例一解释

$ f(2)\ =\ f(\lfloor\frac{2}{2}\rfloor)\ +\ f(\lfloor\frac{2}{3}\rfloor)\ =\ f(1)\ +\ f(0)\ =(f(\lfloor\frac{1}{2}\rfloor)\ +\ f(\lfloor\frac{1}{3}\rfloor))\ +\ f(0)\ =(f(0)+f(0))\ +\ f(0)=\ 3 $。

## 样例 #1

### 输入

```
2
```

### 输出

```
3
```

## 样例 #2

### 输入

```
0
```

### 输出

```
1
```

## 样例 #3

### 输入

```
100
```

### 输出

```
55
```



---

---
title: "[ABC276B] Adjacency List"
layout: "post"
diff: 普及-
pid: AT_abc276_b
tag: []
---

# [ABC276B] Adjacency List

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc276/tasks/abc276_b

$ 1,\ \dots,\ N $ と番号付けられた $ N $ 個の都市と、都市間を結ぶ $ M $ 本の道路があります。  
$ i\ \,\ (1\ \leq\ i\ \leq\ M) $ 番目の道路は都市 $ A_i $ と都市 $ B_i $ を結んでいます。

以下の指示に従い、$ N $ 行にわたって出力してください。

- 都市 $ i\ \,\ (1\ \leq\ i\ \leq\ N) $ と道路で直接結ばれた都市が $ d_i $ 個あるとし、それらを**昇順**に都市 $ a_{i,\ 1},\ \dots,\ a_{i,\ d_i} $ とおく。
- $ i\ \,\ (1\ \leq\ i\ \leq\ N) $ 行目には、$ d_i\ +\ 1 $ 個の整数 $ d_i,\ a_{i,\ 1},\ \dots,\ a_{i,\ d_i} $ を、この順番で空白区切りで出力せよ。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ M $ $ A_1 $ $ B_1 $ $ \vdots $ $ A_M $ $ B_M $

## 输出格式

問題文の指示に従い、$ N $ 行にわたって出力せよ。

## 说明/提示

### 制約

- $ 2\ \leq\ N\ \leq\ 10^5 $
- $ 1\ \leq\ M\ \leq\ 10^5 $
- $ 1\ \leq\ A_i\ \lt\ B_i\ \leq\ N\ \,\ (1\ \leq\ i\ \leq\ M) $
- $ (i\ \neq\ j) $ ならば $ (A_i,\ B_i)\ \neq\ (A_j,\ B_j) $
- 入力される値は全て整数

### Sample Explanation 1

都市 $ 1 $ と道路で直接結ばれているのは都市 $ 2,\ 3,\ 6 $ です。よって、$ d_1\ =\ 3,\ a_{1,\ 1}\ =\ 2,\ a_{1,\ 2}\ =\ 3,\ a_{1,\ 3}\ =\ 6 $ であるので、$ 1 $ 行目には $ 3,\ 2,\ 3,\ 6 $ をこの順番で空白区切りで出力します。 $ a_{i,\ 1},\ \dots,\ a_{i,\ d_i} $ は昇順に並んでいなければならないことに注意してください。例えば、$ 1 $ 行目に $ 3,\ 3,\ 2,\ 6 $ をこの順番で出力した場合、不正解となります。

## 样例 #1

### 输入

```
6 6
3 6
1 3
5 6
2 5
1 2
1 6
```

### 输出

```
3 2 3 6
2 1 5
2 1 6
0
2 2 6
3 1 3 5
```

## 样例 #2

### 输入

```
5 10
1 2
1 3
1 4
1 5
2 3
2 4
2 5
3 4
3 5
4 5
```

### 输出

```
4 2 3 4 5
4 1 3 4 5
4 1 2 4 5
4 1 2 3 5
4 1 2 3 4
```



---

---
title: "[ABC276C] Previous Permutation"
layout: "post"
diff: 普及-
pid: AT_abc276_c
tag: []
---

# [ABC276C] Previous Permutation

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc276/tasks/abc276_c

$ (1,\ \dots,\ N) $ の順列 $ P\ =\ (P_1,\ \dots,\ P_N) $ が与えられます。ただし、$ (P_1,\ \dots,\ P_N)\ \neq\ (1,\ \dots,\ N) $ です。

$ (1\ \dots,\ N) $ の順列を全て辞書順で小さい順に並べたとき、$ P $ が $ K $ 番目であるとします。辞書順で小さい方から $ K-1 $ 番目の順列を求めてください。

 順列とは？ $ (1,\ \dots,\ N) $ の**順列**とは、$ (1,\ \dots,\ N) $ を並べ替えて得られる数列のことをいいます。

 辞書順とは？ 長さ $ N $ の数列 $ A\ =\ (A_1,\ \dots,\ A_N),\ B\ =\ (B_1,\ \dots,\ B_N) $ に対し、$ A $ が $ B $ より**辞書順で真に小さい**とは、ある整数 $ 1\ \leq\ i\ \leq\ N $ が存在して、下記の $ 2 $ つがともに成り立つことをいいます。

- $ (A_{1},\ldots,A_{i-1})\ =\ (B_1,\ldots,B_{i-1}) $
- $ A_i $

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ P_1 $ $ \ldots $ $ P_N $

## 输出格式

求める順列を $ Q\ =\ (Q_1,\ \dots,\ Q_N) $ として、$ Q_1,\ \dots,\ Q_N $ をこの順に空白区切りで一行に出力せよ。

## 说明/提示

### 制約

- $ 2\ \leq\ N\ \leq\ 100 $
- $ 1\ \leq\ P_i\ \leq\ N\ \,\ (1\ \leq\ i\ \leq\ N) $
- $ P_i\ \neq\ P_j\ \,\ (i\ \neq\ j) $
- $ (P_1,\ \dots,\ P_N)\ \neq\ (1,\ \dots,\ N) $
- 入力される値は全て整数

### Sample Explanation 1

$ (1,\ 2,\ 3) $ の順列を辞書順で小さい順に並べると次のようになります。 - $ (1,\ 2,\ 3) $ - $ (1,\ 3,\ 2) $ - $ (2,\ 1,\ 3) $ - $ (2,\ 3,\ 1) $ - $ (3,\ 1,\ 2) $ - $ (3,\ 2,\ 1) $ よって $ P\ =\ (3,\ 1,\ 2) $ は小さい方から $ 5 $ 番目であり、求める順列、すなわち小さい方から $ 5\ -\ 1\ =\ 4 $ 番目の順列は $ (2,\ 3,\ 1) $ です。

## 样例 #1

### 输入

```
3

3 1 2
```

### 输出

```
2 3 1
```

## 样例 #2

### 输入

```
10

9 8 6 5 10 3 1 2 4 7
```

### 输出

```
9 8 6 5 10 2 7 4 3 1
```



---

---
title: "[ABC277C] Ladder Takahashi"
layout: "post"
diff: 普及-
pid: AT_abc277_c
tag: []
---

# [ABC277C] Ladder Takahashi

## 题目描述

【题面翻译】

有一座很高的楼，你现在在第一层。

有 $n$ 个传送门，每个传送门连接第 $a_i$ 层与 $b_i$ 层。传送门是双向的。

请你求出你能到达的最高楼层。

translated by @[liangbowen](https://www.luogu.com.cn/user/367488).

## 输入格式

第一行，一个整数 $n$。

接下来 $n$ 行，每行两个数 $a_i$，$b_i$，表示传送门。

## 输出格式

输出你能到达的最高楼层。

## 说明/提示

$1 \le n \le 2 \times 10^5$

$1 \le a_i, b_i \le 10^9$

保证 $a_i \ne b_i$。

## 样例 #1

### 输入

```
4

1 4

4 3

4 10

8 3
```

### 输出

```
10
```

## 样例 #2

### 输入

```
6

1 3

1 5

1 12

3 5

3 12

5 12
```

### 输出

```
12
```

## 样例 #3

### 输入

```
3

500000000 600000000

600000000 700000000

700000000 800000000
```

### 输出

```
1
```



---

---
title: "[ABC278C] FF"
layout: "post"
diff: 普及-
pid: AT_abc278_c
tag: []
---

# [ABC278C] FF

## 题目描述

【题目翻译】

洛谷是一个大平台，从前，这里有 $n$ 个用户。刚开始，他们没有任何关系。

有 $q$ 次操作，每组操作包含 $op_i$，$a_i$，$b_i$：

+ $op_i = 1$，表示 $a_i$ 关注了 $b_i$。
+ $op_i = 2$，表示 $a_i$ 取关了 $b_i$。
+ $op_i = 3$，表示查询 $a_i$ 与 $b_i$ 是否互关。

对于每个 $op_i = 3$，输出结果。

translated by @[liangbowen](https://www.luogu.com.cn/user/367488).

## 输入格式

第一行两个数 $n$，$q$。

接下来 $q$ 行，每行三个数 $op_i$，$a_i$，$b_i$。

## 输出格式

对于每个 $op_i = 3$，输出结果。

## 说明/提示

$1 \le n \le 10^9$

$1 \le q \le 2 \times 10^5$

保证 $1 \le a_i, b_i \le n$，且 $a_i \ne b_i$。

保证 $op_i \in \{1, 2, 3\}$。

## 样例 #1

### 输入

```
3 9

1 1 2

3 1 2

1 2 1

3 1 2

1 2 3

1 3 2

3 1 3

2 1 2

3 1 2
```

### 输出

```
No

Yes

No

No
```

## 样例 #2

### 输入

```
2 8

1 1 2

1 2 1

3 1 2

1 1 2

1 1 2

1 1 2

2 1 2

3 1 2
```

### 输出

```
Yes

No
```

## 样例 #3

### 输入

```
10 30

3 1 6

3 5 4

1 6 1

3 1 7

3 8 4

1 1 6

2 4 3

1 6 5

1 5 6

1 1 8

1 8 1

2 3 10

1 7 6

3 5 6

1 6 7

3 6 7

1 9 5

3 8 6

3 3 8

2 6 9

1 7 1

3 10 8

2 9 2

1 10 9

2 6 10

2 6 8

3 1 6

3 1 8

2 8 5

1 9 10
```

### 输出

```
No

No

No

No

Yes

Yes

No

No

No

Yes

Yes
```



---

---
title: "[ABC287C] Path Graph?"
layout: "post"
diff: 普及-
pid: AT_abc287_c
tag: []
---

# [ABC287C] Path Graph?

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc287/tasks/abc287_c

$ N $ 頂点 $ M $ 辺の単純無向グラフが与えられます。頂点には $ 1,\ 2,\ \dots,\ N $ の番号が、辺には $ 1,\ 2,\ \dots,\ M $ の番号が付けられています。  
 辺 $ i\ \,\ (i\ =\ 1,\ 2,\ \dots,\ M) $ は頂点 $ u_i,\ v_i $ を結んでいます。

このグラフがパスグラフであるか判定してください。

 単純無向グラフとは **単純無向グラフ**とは、自己ループや多重辺を含まず、辺に向きの無いグラフのことをいいます。

 パスグラフとは 頂点に $ 1,\ 2,\ \dots,\ N $ の番号が付けられた$ N $ 頂点のグラフが**パスグラフ**であるとは、$ (1,\ 2,\ \dots,\ N) $ を並べ変えて得られる数列 $ (v_1,\ v_2,\ \dots,\ v_N) $ であって、以下の条件を満たすものが存在することをいいます。 - 全ての $ i\ =\ 1,\ 2,\ \dots,\ N-1 $ に対して、頂点 $ v_i,\ v_{i+1} $ を結ぶ辺が存在する
\- 整数 $ i,\ j $ が $ 1\ \leq\ i,\ j\ \leq\ N,\ |i\ -\ j|\ \geq\ 2 $ を満たすならば、頂点 $ v_i,\ v_j $ を結ぶ辺は存在しない

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ M $ $ u_1 $ $ v_1 $ $ u_2 $ $ v_2 $ $ \vdots $ $ u_M $ $ v_M $

## 输出格式

与えられたグラフがパスグラフなら `Yes`、そうでないなら `No` と出力せよ。

## 说明/提示

### 制約

- $ 2\ \leq\ N\ \leq\ 2\ \times\ 10^5 $
- $ 0\ \leq\ M\ \leq\ 2\ \times\ 10^5 $
- $ 1\ \leq\ u_i,\ v_i\ \leq\ N\ \,\ (i\ =\ 1,\ 2,\ \dots,\ M) $
- 入力される値は全て整数
- 入力で与えられるグラフは単純
 
### Sample Explanation 1

与えらえたグラフは下図のようであり、これはパスグラフです。 !\[example\_00\](https://img.atcoder.jp/abc287/59d45566ae7f7fd4df9801eb0fdbea5f.png)

### Sample Explanation 2

与えらえたグラフは下図のようであり、これはパスグラフではありません。 !\[example\_01\](https://img.atcoder.jp/abc287/6c608de40ba7875deaf1aa168c7f8c83.png)

### Sample Explanation 3

与えらえたグラフは下図のようであり、これはパスグラフではありません。 !\[example\_02\](https://img.atcoder.jp/abc287/73f11a6a7687f4e373da69426883e134.png)

## 样例 #1

### 输入

```
4 3

1 3

4 2

3 2
```

### 输出

```
Yes
```

## 样例 #2

### 输入

```
2 0
```

### 输出

```
No
```

## 样例 #3

### 输入

```
5 5

1 2

2 3

3 4

4 5

5 1
```

### 输出

```
No
```



---

---
title: "[ABC288C] Don’t be cycle"
layout: "post"
diff: 普及-
pid: AT_abc288_c
tag: []
---

# [ABC288C] Don’t be cycle

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc288/tasks/abc288_c

$ N $ 頂点 $ M $ 辺の単純無向グラフが与えられます。頂点には $ 1 $ から $ N $ の番号がついており、$ i $ 番目の辺は頂点 $ A_i $ と頂点 $ B_i $ を結んでいます。 このグラフから $ 0 $ 本以上のいくつかの辺を削除してグラフが閉路を持たないようにするとき、削除する辺の本数の最小値を求めてください。

 単純無向グラフとは **単純無向グラフ**とは、自己ループや多重辺を含まず、辺に向きの無いグラフのことをいいます。

 閉路とは 単純無向グラフが**閉路**を持つとは、$ i\ \neq\ j $ ならば $ v_i\ \neq\ v_j $ を満たす長さ $ 3 $ 以上の頂点列 $ (v_0,\ v_1,\ \ldots,\ v_{n-1}) $ であって、各 $ 0\ \leq\ i\ に対し\ v_i $ と $ v_{i+1\ \bmod\ n} $ の間に辺が存在するものがあることをいいます。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ M $ $ A_1 $ $ B_1 $ $ A_2 $ $ B_2 $ $ \vdots $ $ A_M $ $ B_M $

## 输出格式

答えを出力せよ。

## 说明/提示

### 制約

- $ 1\ \leq\ N\ \leq\ 2\ \times\ 10^5 $
- $ 0\ \leq\ M\ \leq\ 2\ \times\ 10^5 $
- $ 1\ \leq\ A_i,\ B_i\ \leq\ N $
- 与えられるグラフは単純
- 入力はすべて整数
 
### Sample Explanation 1

頂点 $ 1 $ と頂点 $ 2 $ を結ぶ辺・頂点 $ 4 $ と頂点 $ 5 $ を結ぶ辺の $ 2 $ 本を削除するなどの方法でグラフが閉路を持たないようにすることができます。 $ 1 $ 本以下の辺の削除でグラフが閉路を持たないようにすることはできないので、$ 2 $ を出力します。

## 样例 #1

### 输入

```
6 7

1 2

1 3

2 3

4 2

6 5

4 6

4 5
```

### 输出

```
2
```

## 样例 #2

### 输入

```
4 2

1 2

3 4
```

### 输出

```
0
```

## 样例 #3

### 输入

```
5 3

1 2

1 3

2 3
```

### 输出

```
1
```



---

---
title: "[ABC289C] Coverage"
layout: "post"
diff: 普及-
pid: AT_abc289_c
tag: []
---

# [ABC289C] Coverage

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc289/tasks/abc289_c

$ 1 $ 以上 $ N $ 以下の整数からなる集合が $ M $ 個あり、順に $ S_1,\ S_2,\ \dots,\ S_M $ と呼びます。  
$ S_i $ は $ C_i $ 個の整数 $ a_{i,\ 1},\ a_{i,\ 2},\ \dots,\ a_{i,\ C_i} $ からなります。

$ M $ 個の集合から $ 1 $ 個以上の集合を選ぶ方法は $ 2^M-1 $ 通りあります。  
このうち、次の条件を満たす選び方は何通りありますか？

- $ 1\ \leq\ x\ \leq\ N $ を満たす全ての整数 $ x $ に対して、選んだ集合の中に $ x $ を含む集合が少なくとも $ 1 $ 個存在する。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ M $ $ C_1 $ $ a_{1,1} $ $ a_{1,2} $ $ \dots $ $ a_{1,C_1} $ $ C_2 $ $ a_{2,1} $ $ a_{2,2} $ $ \dots $ $ a_{2,C_2} $ $ \vdots $ $ C_M $ $ a_{M,1} $ $ a_{M,2} $ $ \dots $ $ a_{M,C_M} $

## 输出格式

問題文の条件を満たす集合の選び方の数を出力せよ。

## 说明/提示

### 制約

- $ 1\ \leq\ N\ \leq\ 10 $
- $ 1\ \leq\ M\ \leq\ 10 $
- $ 1\ \leq\ C_i\ \leq\ N $
- $ 1\ \leq\ a_{i,1}\ \lt\ a_{i,2}\ \lt\ \dots\ \lt\ a_{i,C_i}\ \leq\ N $
- 入力される値は全て整数

### Sample Explanation 1

入力で与えられている集合はそれぞれ $ S_1\ =\ \lbrace\ 1,\ 2\ \rbrace,\ S_2\ =\ \lbrace\ 1,\ 3\ \rbrace,\ S_3\ =\ \lbrace\ 2\ \rbrace $ です。 問題文の条件を満たす集合の選び方は次の $ 3 $ 通りです。 - $ S_1,\ S_2 $ を選ぶ。 - $ S_1,\ S_2,\ S_3 $ を選ぶ。 - $ S_2,\ S_3 $ を選ぶ。

### Sample Explanation 2

問題文の条件を満たす選び方が存在しない場合もあります。

## 样例 #1

### 输入

```
3 3
2
1 2
2
1 3
1
2
```

### 输出

```
3
```

## 样例 #2

### 输入

```
4 2
2
1 2
2
1 3
```

### 输出

```
0
```

## 样例 #3

### 输入

```
6 6
3
2 3 6
3
2 4 6
2
3 6
3
1 5 6
3
1 3 6
2
1 4
```

### 输出

```
18
```



---

---
title: "[ABC289D] Step Up Robot"
layout: "post"
diff: 普及-
pid: AT_abc289_d
tag: []
---

# [ABC289D] Step Up Robot

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc289/tasks/abc289_d

無限に続く階段があります。 一番下は $ 0 $ 段目で、$ 1 $ 段のぼるごとに $ 1 $ 段目、$ 2 $ 段目と続きます。

$ 0 $ 段目に階段登りロボットがいます。 階段登りロボットは、一回の動作で $ A\ _\ 1,A\ _\ 2,\ldots,A\ _\ N $ 段ぶん階段をのぼることができます。 つまり、階段登りロボットが $ i $ 段目にいるとき、一回動作をした後は $ i+A\ _\ 1 $ 段目、$ i+A\ _\ 2 $ 段目、⋯、$ i+A\ _\ N $ 段目のいずれかにいることができます。 それ以外の段数を一回の動作でのぼることはできません。 階段登りロボットは階段を下ることもできません。

階段の $ B\ _\ 1,B\ _\ 2,\ldots,B\ _\ M $ 段目にはモチが設置されています。 モチが設置されている段へのぼるとロボットは動けなくなり、他の段に移動することができなくなります。

階段登りロボットは階段のちょうど $ X $ 段目にのぼりたいです。 階段登りロボットが階段のちょうど $ X $ 段目にのぼることが可能か判定してください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ A\ _\ 1 $ $ A\ _\ 2 $ $ \ldots $ $ A\ _\ N $ $ M $ $ B\ _\ 1 $ $ B\ _\ 2 $ $ \ldots $ $ B\ _\ M $ $ X $

## 输出格式

階段登りロボットが階段のちょうど $ X $ 段目にのぼることができるとき `Yes` を、そうでないとき `No` を $ 1 $ 行に出力せよ。

## 说明/提示

### 制約

- $ 1\leq\ N\leq10 $
- $ 1\leq\ A\ _\ 1\lt\ A\ _\ 2\lt\cdots\lt\ A\ _\ N\leq10^5 $
- $ 1\leq\ M\leq10^5 $
- $ 1\leq\ B\ _\ 1\lt\ B\ _\ 2\lt\cdots\lt\ B\ _\ M\lt\ X\leq10^5 $
- 入力はすべて整数
 
### Sample Explanation 1

例えば、次のようにして $ 15 $ 段目に到達することができます。 - 階段を $ 3 $ 段のぼる。ロボットは $ 3 $ 段目に移動する。 - 階段を $ 4 $ 段のぼる。ロボットは $ 7 $ 段目に移動する。 - 階段を $ 5 $ 段のぼる。ロボットは $ 12 $ 段目に移動する。 - 階段を $ 3 $ 段のぼる。ロボットは $ 15 $ 段目に移動する。

### Sample Explanation 2

どのように移動しても階段登りロボットが階段のちょうど $ 8 $ 段目にいることはできません。

## 样例 #1

### 输入

```
3

3 4 5

4

4 5 6 8

15
```

### 输出

```
Yes
```

## 样例 #2

### 输入

```
4

2 3 4 5

4

3 4 5 6

8
```

### 输出

```
No
```

## 样例 #3

### 输入

```
4

2 5 7 8

5

2 9 10 11 19

20
```

### 输出

```
Yes
```



---

---
title: "[ABC292C] Four Variables"
layout: "post"
diff: 普及-
pid: AT_abc292_c
tag: []
---

# [ABC292C] Four Variables

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc292/tasks/abc292_c

正整数 $ N $ が与えられます。  
 正整数の組 $ (A,B,C,D) $ であって、$ AB\ +\ CD\ =\ N $ を満たすものの個数を求めてください。

なお、本問の制約の下、答えが $ 9\ \times\ 10^{18} $ 以下であることが証明できます。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $

## 输出格式

答えを出力せよ。

## 说明/提示

### 制約

- $ 2\ \leq\ N\ \leq\ 2\ \times\ 10^5 $
- $ N $ は整数
 
### Sample Explanation 1

$ (A,B,C,D) $ として以下の $ 8 $ 個が考えられます。 - $ (A,B,C,D)=(1,1,1,3) $ - $ (A,B,C,D)=(1,1,3,1) $ - $ (A,B,C,D)=(1,2,1,2) $ - $ (A,B,C,D)=(1,2,2,1) $ - $ (A,B,C,D)=(1,3,1,1) $ - $ (A,B,C,D)=(2,1,1,2) $ - $ (A,B,C,D)=(2,1,2,1) $ - $ (A,B,C,D)=(3,1,1,1) $

## 样例 #1

### 输入

```
4
```

### 输出

```
8
```

## 样例 #2

### 输入

```
292
```

### 输出

```
10886
```

## 样例 #3

### 输入

```
19876
```

### 输出

```
2219958
```



---

---
title: "[ABC292D] Unicyclic Components"
layout: "post"
diff: 普及-
pid: AT_abc292_d
tag: []
---

# [ABC292D] Unicyclic Components

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc292/tasks/abc292_d

頂点に $ 1 $ から $ N $ の番号が、辺に $ 1 $ から $ M $ の番号がついた $ N $ 頂点 $ M $ 辺の無向グラフが与えられます。辺 $ i $ は頂点 $ u_i $ と頂点 $ v_i $ を結んでいます。

このグラフのすべての連結成分が次の条件を満たすかどうかを判定してください。

- その連結成分に含まれる頂点の個数と辺の本数が等しい。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ M $ $ u_1 $ $ v_1 $ $ \vdots $ $ u_M $ $ v_M $

## 输出格式

すべての連結成分が条件を満たすならば `Yes` と、そうでなければ `No` と出力せよ。

## 说明/提示

### 注釈

**無向グラフ** とは、辺に向きの無いグラフのことをいいます。  
あるグラフの **部分グラフ** とは、元のグラフのいくつかの頂点といくつかの辺を選んでできるグラフのことをいいます。  
グラフが **連結** であるとは、グラフに含まれるすべての頂点同士が辺を経由して互いに行き来できることをいいます。  
**連結成分** とは、連結な部分グラフのうち、そのグラフを含んだより大きい連結な部分グラフが存在しないものをいいます。

### 制約

- $ 1\ \leq\ N\ \leq\ 2\ \times\ 10^5 $
- $ 0\ \leq\ M\ \leq\ 2\ \times\ 10^5 $
- $ 1\ \leq\ u_i\ \leq\ v_i\ \leq\ N $
- 入力はすべて整数

### Sample Explanation 1

このグラフには頂点 $ 1 $ のみからなる連結成分と頂点 $ 2,3 $ からなる連結成分があります。 前者には $ 1 $ 本の辺(辺 $ 2 $ )が、後者には $ 2 $ 本の辺(辺 $ 1,3 $ )が含まれており、条件を満たします。

## 样例 #1

### 输入

```
3 3
2 3
1 1
2 3
```

### 输出

```
Yes
```

## 样例 #2

### 输入

```
5 5
1 2
2 3
3 4
3 5
1 5
```

### 输出

```
Yes
```

## 样例 #3

### 输入

```
13 16
7 9
7 11
3 8
1 13
11 11
6 11
8 13
2 11
3 3
8 12
9 11
1 11
5 13
3 12
6 9
1 10
```

### 输出

```
No
```



---

---
title: "[ABC293C] Make Takahashi Happy"
layout: "post"
diff: 普及-
pid: AT_abc293_c
tag: []
---

# [ABC293C] Make Takahashi Happy

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc293/tasks/abc293_c

$ H $ 行 $ W $ 列のマス目があります。 $ 1\ \leq\ i\ \leq\ H $ かつ $ 1\ \leq\ j\ \leq\ W $ を満たす $ 2 $ つの整数 $ i,\ j $ について、 上から $ i $ 行目、左から $ j $ 列目のマス（以下、$ (i,\ j) $ と表す）には、整数 $ A_{i,\ j} $ が書かれています。

いま、高橋君は $ (1,\ 1) $ にいます。 これから高橋君は「いまいるマスから右または下に隣接するマスに移動する」ことを繰り返して、$ (H,\ W) $ まで移動します。 ただし、その過程でマス目の外部に移動することは出来ません。

その結果、高橋君が通ったマス（始点 $ (1,\ 1) $ と終点 $ (H,\ W) $ を含む）に書かれた整数がすべて異なるとき、高橋君は嬉しくなります。 高橋君の移動経路として考えられるもののうち、高橋君が嬉しくなるものの個数を出力してください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ H $ $ W $ $ A_{1,\ 1} $ $ A_{1,\ 2} $ $ \ldots $ $ A_{1,\ W} $ $ A_{2,\ 1} $ $ A_{2,\ 2} $ $ \ldots $ $ A_{2,\ W} $ $ \vdots $ $ A_{H,\ 1} $ $ A_{H,\ 2} $ $ \ldots $ $ A_{H,\ W} $

## 输出格式

答えを出力せよ。

## 说明/提示

### 制約

- $ 2\ \leq\ H,\ W\ \leq\ 10 $
- $ 1\ \leq\ A_{i,\ j}\ \leq\ 10^9 $
- 入力はすべて整数
 
### Sample Explanation 1

高橋君の移動経路として考えられるものは下記の $ 6 $ 通りです。 - $ (1,\ 1)\ \rightarrow\ (1,\ 2)\ \rightarrow\ (1,\ 3)\ \rightarrow\ (2,\ 3)\ \rightarrow\ (3,\ 3) $：通ったマスに書かれた整数は $ 3,\ 2,\ 2,\ 3,\ 4 $ であり、高橋君は嬉しく\*\*なりません\*\*。 - $ (1,\ 1)\ \rightarrow\ (1,\ 2)\ \rightarrow\ (2,\ 2)\ \rightarrow\ (2,\ 3)\ \rightarrow\ (3,\ 3) $：通ったマスに書かれた整数は $ 3,\ 2,\ 1,\ 3,\ 4 $ であり、高橋君は嬉しく\*\*なりません\*\*。 - $ (1,\ 1)\ \rightarrow\ (1,\ 2)\ \rightarrow\ (2,\ 2)\ \rightarrow\ (3,\ 2)\ \rightarrow\ (3,\ 3) $：通ったマスに書かれた整数は $ 3,\ 2,\ 1,\ 5,\ 4 $ であり、高橋君は嬉しく\*\*なります\*\*。 - $ (1,\ 1)\ \rightarrow\ (2,\ 1)\ \rightarrow\ (2,\ 2)\ \rightarrow\ (2,\ 3)\ \rightarrow\ (3,\ 3) $：通ったマスに書かれた整数は $ 3,\ 2,\ 1,\ 3,\ 4 $ であり、高橋君は嬉しく\*\*なりません\*\*。 - $ (1,\ 1)\ \rightarrow\ (2,\ 1)\ \rightarrow\ (2,\ 2)\ \rightarrow\ (3,\ 2)\ \rightarrow\ (3,\ 3) $：通ったマスに書かれた整数は $ 3,\ 2,\ 1,\ 5,\ 4 $ であり、高橋君は嬉しく\*\*なります\*\*。 - $ (1,\ 1)\ \rightarrow\ (2,\ 1)\ \rightarrow\ (3,\ 1)\ \rightarrow\ (3,\ 2)\ \rightarrow\ (3,\ 3) $：通ったマスに書かれた整数は $ 3,\ 2,\ 1,\ 5,\ 4 $ であり、高橋君は嬉しく\*\*なります\*\*。 よって、高橋君が嬉しくなる移動経路は、上で $ 3,\ 5,\ 6 $ 番目に述べた $ 3 $ 個です。

### Sample Explanation 2

この例では、高橋君は考えられるどの経路を通っても嬉しくなります。

## 样例 #1

### 输入

```
3 3

3 2 2

2 1 3

1 5 4
```

### 输出

```
3
```

## 样例 #2

### 输入

```
10 10

1 2 3 4 5 6 7 8 9 10

11 12 13 14 15 16 17 18 19 20

21 22 23 24 25 26 27 28 29 30

31 32 33 34 35 36 37 38 39 40

41 42 43 44 45 46 47 48 49 50

51 52 53 54 55 56 57 58 59 60

61 62 63 64 65 66 67 68 69 70

71 72 73 74 75 76 77 78 79 80

81 82 83 84 85 86 87 88 89 90

91 92 93 94 95 96 97 98 99 100
```

### 输出

```
48620
```



---

---
title: "[ABC294D] Bank"
layout: "post"
diff: 普及-
pid: AT_abc294_d
tag: []
---

# [ABC294D] Bank

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc294/tasks/abc294_d

銀行に人 $ 1 $, 人 $ 2 $, $ \dots $, 人 $ N $ が並んでいます。  
 $ Q $ 個のイベントが発生します。イベントは次の $ 3 $ 種類のいずれかです。

- `1` : 受付に呼ばれていない人のうち、最も小さい番号の人が受付に呼ばれる。
- `2 x` : 人 $ x $ が初めて受付に行く。(ここで、人 $ x $ はすでに 1 回以上受付に呼ばれている。)
- `3` : すでに受付に呼ばれているが受付に行っていない人のうち、最も小さい番号の人が再度呼ばれる。
 
$ 3 $ 種類目のイベントで受付に呼ばれる人の番号を呼ばれた順に出力してください。

## 输入格式

入力は以下の形式で標準入力から与えられる。ここで $ \text{event}_i $ は $ i $ 番目のイベントを意味する。

> $ N $ $ Q $ $ \text{event}_1 $ $ \text{event}_2 $ $ \vdots $ $ \text{event}_Q $

イベントは次の 3 つのいずれかの形式で入力される。

 ```
1
```

> 2 $ x $

 ```
3
```

## 输出格式

入力で与えられる $ 3 $ 種類目のイベントの個数を $ X $ として、$ X $ 行出力せよ。  
 $ i $ 行目には、$ 3 $ 種類目のイベントのうち $ i $ 番目のもので呼ばれた人の番号を出力せよ。

## 说明/提示

### 制約

- $ 1\ \leq\ N\ \leq\ 5\ \times\ 10^5 $
- $ 2\ \leq\ Q\ \leq\ 5\ \times\ 10^5 $
- 全ての人が 1 回以上呼ばれているときに $ 1 $ 種類目のイベントが発生することはない
- $ 2 $ 種類目のイベントについて、人 $ x $ はすでに 1 回以上受付に呼ばれている
- $ 2 $ 種類目のイベントについて、人 $ x $ が 2 回以上受付に行くことはない
- 呼ばれている人が全員すでに受付に行っているときに $ 3 $ 種類目のイベントが発生することはない
- $ 3 $ 種類目のイベントは少なくとも 1 回発生する
- 入力される値はすべて整数
 
### Sample Explanation 1

$ i\ =\ 1,\ 2,\ \dots,\ Q $ について、$ i $ 番目のイベントが起こる前の時点での、受付に呼ばれたが受付に行っていない人の集合を列挙すると次のようになります。 - $ i=1 $ : $ \lbrace\ \rbrace $ - $ i=2 $ : $ \lbrace\ 1\rbrace $ - $ i=3 $ : $ \lbrace\ 1,2\rbrace $ - $ i=4 $ : $ \lbrace\ 1,2\rbrace $ - $ i=5 $ : $ \lbrace\ 2\rbrace $ - $ i=6 $ : $ \lbrace\ 2,3\rbrace $ - $ i=7 $ : $ \lbrace\ 2\rbrace $ - $ i=8 $ : $ \lbrace\ 2\rbrace $ - $ i=9 $ : $ \lbrace\ 2,4\rbrace $ - $ i=10 $ : $ \lbrace\ 4\rbrace $ $ 3 $ 種類目のイベントは $ i=3,7,10 $ のときに発生しているので、その時点での集合のうち番号が最小の人である $ 1,\ 2,\ 4 $ を出力します。

## 样例 #1

### 输入

```
4 10

1

1

3

2 1

1

2 3

3

1

2 2

3
```

### 输出

```
1

2

4
```



---

---
title: "[ABC296C] Gap Existence"
layout: "post"
diff: 普及-
pid: AT_abc296_c
tag: []
---

# [ABC296C] Gap Existence

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc296/tasks/abc296_c

長さ $ N $ の数列 $ A=(A_1,\ldots,A_N) $ が与えられます。

$ 1\leq\ i,j\ \leq\ N $ である組 $ (i,j) $ であって、$ A_i-A_j=X $ となるものが存在するかどうか判定してください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ X $ $ A_1 $ $ \ldots $ $ A_N $

## 输出格式

$ 1\leq\ i,j\ \leq\ N $ である組 $ (i,j) $ であって、$ A_i-A_j=X $ となるものが存在するとき `Yes`、存在しないとき `No` と出力せよ。

## 说明/提示

### 制約

- $ 2\ \leq\ N\ \leq\ 2\times\ 10^5 $
- $ -10^9\ \leq\ A_i\ \leq\ 10^9 $
- $ -10^9\ \leq\ X\ \leq\ 10^9 $
- 入力は全て整数である
 
### Sample Explanation 1

$ A_6-A_3=9-4=5 $ です。

### Sample Explanation 2

$ A_i-A_j=-4 $ となる組 $ (i,j) $ は存在しません。

### Sample Explanation 3

$ A_1-A_1=0 $ です。

## 样例 #1

### 输入

```
6 5

3 1 4 1 5 9
```

### 输出

```
Yes
```

## 样例 #2

### 输入

```
6 -4

-2 -7 -1 -8 -2 -8
```

### 输出

```
No
```

## 样例 #3

### 输入

```
2 0

141421356 17320508
```

### 输出

```
Yes
```



---

---
title: "[ABC298C] Cards Query Problem"
layout: "post"
diff: 普及-
pid: AT_abc298_c
tag: []
---

# [ABC298C] Cards Query Problem

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc298/tasks/abc298_c

$ 1 $ から $ N $ までの番号がついた $ N $ 個の空の箱と、何も書かれていない無数のカードがあります。  
 $ Q $ 個のクエリが与えられるので、順番に処理してください。クエリは次の $ 3 $ 種類のいずれかです。

- `1 i j` $ \colon $ カードを $ 1 $ 枚選んで数 $ i $ を書き込み、そのカードを箱 $ j $ に入れる
- `2 i` $ \colon $ 箱 $ i $ に入っているカードに書かれた数を**昇順で**すべて答える
- `3 i` $ \colon $ 数 $ i $ が書かれたカードが入っている箱の番号を**昇順で**すべて答える
 
ただし、以下の点に注意してください。

- $ 2 $ 番目の形式のクエリにおいては、箱 $ i $ の中に同じ数が書かれたカードが複数枚あるときは、入っている枚数と同じ回数だけその数を出力する
- $ 3 $ 番目の形式のクエリにおいては、数 $ i $ が書かれたカードが同じ箱に複数枚入っている場合でも、その箱の番号は $ 1 $ 度だけ出力する

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ Q $ $ \mathrm{query}_1 $ $ \mathrm{query}_2 $ $ \vdots $ $ \mathrm{query}_Q $

ただし、$ \mathrm{query}_q $ は $ q $ 個目のクエリを表しており、次のいずれかの形式で与えられる。

> $ 1 $ $ i $ $ j $

> $ 2 $ $ i $

> $ 3 $ $ i $

## 输出格式

$ 2 $ 番目の形式のクエリと $ 3 $ 番目の形式のクエリに対し、順番に答えを出力せよ。  
 各クエリでは出力するべき要素を**昇順に**空白区切りで出力し、クエリごとに改行せよ。

## 说明/提示

### 制約

- $ 1\ \leq\ N,\ Q\ \leq\ 2\ \times\ 10^5 $
- $ 1 $ 番目の形式のクエリについて、
  - $ 1\ \leq\ i\ \leq\ 2\ \times\ 10^5 $
  - $ 1\ \leq\ j\ \leq\ N $
- $ 2 $ 番目の形式のクエリについて、
  - $ 1\ \leq\ i\ \leq\ N $
  - このクエリが与えられる時点で箱 $ i $ にカードが入っている
- $ 3 $ 番目の形式のクエリについて、
  - $ 1\ \leq\ i\ \leq\ 2\ \times\ 10^5 $
  - このクエリが与えられる時点で数 $ i $ が書かれたカードが入っている箱が存在する
- 出力するべき数は合計で $ 2\ \times\ 10^5 $ 個以下
- 入力はすべて整数
 
### Sample Explanation 1

クエリを順に処理していきます。 - カードに $ 1 $ を書き込み、箱 $ 1 $ に入れます。 - カードに $ 2 $ を書き込み、箱 $ 4 $ に入れます。 - カードに $ 1 $ を書き込み、箱 $ 4 $ に入れます。 - 箱 $ 4 $ に入っているカードに書かれた数は $ 1,\ 2 $ です。 - $ 1,\ 2 $ の順に出力してください。 - カードに $ 1 $ を書き込み、箱 $ 4 $ に入れます。 - 箱 $ 4 $ に入っているカードに書かれた数は $ 1,\ 1,\ 2 $ です。 - $ 1 $ を $ 2 $ 度出力することに注意してください。 - 数 $ 1 $ が書かれたカードが入っている箱は箱 $ 1,\ 4 $ です。 - 箱 $ 4 $ には数 $ 1 $ が書かれたカードが $ 2 $ 枚入っていますが、$ 4 $ は $ 1 $ 回しか出力しないことに注意してください。 - 数 $ 2 $ が書かれたカードが入っている箱は箱 $ 4 $ です。

## 样例 #1

### 输入

```
5

8

1 1 1

1 2 4

1 1 4

2 4

1 1 4

2 4

3 1

3 2
```

### 输出

```
1 2

1 1 2

1 4

4
```

## 样例 #2

### 输入

```
1

5

1 1 1

1 2 1

1 200000 1

2 1

3 200000
```

### 输出

```
1 2 200000

1
```



---

---
title: "[ABC300B] Same Map in the RPG World"
layout: "post"
diff: 普及-
pid: AT_abc300_b
tag: []
---

# [ABC300B] Same Map in the RPG World

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc300/tasks/abc300_b

> 高橋君は RPG を作っています。高橋君は 2 枚の RPG 世界のマップが一致しているかを判定するプログラムを書くことにしました。

縦 $ H $ マス横 $ W $ マスの 2 つのグリッド $ A,\ B $ があります。グリッドの各マスには `#` と `.` のいずれかの文字が書かれています。  
$ A $ と $ B $ の上から $ i $ 行目、左から $ j $ 列目に書かれている文字をそれぞれ $ A_{i,\ j},\ B_{i,\ j} $ と呼びます。

次の $ 2 $ 種類の操作をそれぞれ **縦方向のシフト**, **横方向のシフト** と呼びます。

- $ j=1,\ 2,\ \dots,\ W $ について次の操作を同時に行う。
  - $ A_{1,j},\ A_{2,j},\ \dots,\ A_{H-1,\ j},\ A_{H,j} $ を $ A_{2,j},\ A_{3,j},\ \dots,\ A_{H,j},\ A_{1,j} $ に同時に置き換える。
- $ i\ =\ 1,\ 2,\ \dots,\ H $ について次の操作を同時に行う。
  - $ A_{i,1},\ A_{i,2},\ \dots,\ A_{i,W-1},\ A_{i,W} $ を $ A_{i,\ 2},\ A_{i,\ 3},\ \dots,\ A_{i,W},\ A_{i,1} $ に同時に置き換える。

次の条件を満たす非負整数の組 $ (s,\ t) $ は存在しますか？存在する場合は `Yes` を、存在しない場合は `No` を出力してください。

- 縦方向のシフトを $ s $ 回行い、次に横方向のシフトを $ t $ 回行った時、操作後の $ A $ が $ B $ と一致する。

ここで、$ A $ と $ B $ が一致するとは、$ 1\ \leq\ i\ \leq\ H,\ 1\ \leq\ j\ \leq\ W $ を満たす整数の組 $ (i,\ j) $ すべてに対して $ A_{i,\ j}\ =\ B_{i,\ j} $ が成り立つことを言います。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ H $ $ W $ $ A_{1,1}A_{1,2}\dots\ A_{1,W} $ $ A_{2,1}A_{2,2}\dots\ A_{2,W} $ $ \vdots $ $ A_{H,1}A_{H,2}\dots\ A_{H,W} $ $ B_{1,1}B_{1,2}\dots\ B_{1,W} $ $ B_{2,1}B_{2,2}\dots\ B_{2,W} $ $ \vdots $ $ B_{H,1}B_{H,2}\dots\ B_{H,W} $

## 输出格式

条件を満たす整数の組 $ (s,\ t) $ が存在する場合は `Yes` を、存在しない場合は `No` を出力せよ。

## 说明/提示

### 制約

- $ 2\ \leq\ H,\ W\ \leq\ 30 $
- $ A_{i,j},B_{i,j} $ は `#` または `.`
- $ H,\ W $ は整数

### Sample Explanation 1

$ (s,\ t)\ =\ (2,\ 1) $ とすると $ A $ と $ B $ を一致させることができます。 $ (s,\ t)\ =\ (2,\ 1) $ の時の操作の手順を説明します。はじめ、$ A $ は次の通りです。 ``` ..# ... .#. ... ``` まず、縦方向のシフトを行います。$ A $ は次のようになります。 ``` ... .#. ... ..# ``` 次に、再び縦方向のシフトを行います。$ A $ は次のようになります。 ``` .#. ... ..# ... ``` 最後に、横方向のシフトを行います。$ A $ は次のようになり、これは $ B $ と一致しています。 ``` #.. ... .#. ... ```

### Sample Explanation 2

どのように $ (s,\ t) $ を選んでも $ A $ と $ B $ を一致させることはできません。

## 样例 #1

### 输入

```
4 3
..#
...
.#.
...
#..
...
.#.
...
```

### 输出

```
Yes
```

## 样例 #2

### 输入

```
3 2
##
##
#.
..
#.
#.
```

### 输出

```
No
```

## 样例 #3

### 输入

```
4 5
#####
.#...
.##..
..##.
...##
#...#
#####
...#.
```

### 输出

```
Yes
```

## 样例 #4

### 输入

```
10 30
..........##########..........
..........####....###.....##..
.....##....##......##...#####.
....####...##..#####...##...##
...##..##..##......##..##....#
#.##....##....##...##..##.....
..##....##.##..#####...##...##
..###..###..............##.##.
.#..####..#..............###..
#..........##.................
................#..........##.
######....................####
....###.....##............####
.....##...#####......##....##.
.#####...##...##....####...##.
.....##..##....#...##..##..##.
##...##..##.....#.##....##....
.#####...##...##..##....##.##.
..........##.##...###..###....
...........###...#..####..#...
```

### 输出

```
Yes
```



---

---
title: "[ABC300C] Cross"
layout: "post"
diff: 普及-
pid: AT_abc300_c
tag: []
---

# [ABC300C] Cross

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc300/tasks/abc300_c

縦 $ H $ マス横 $ W $ マスのグリッドがあります。グリッドの上から $ i $ 行目、左から $ j $ 列目のマスを $ (i,\ j) $ と呼びます。  
 グリッドの各マスには `#` と `.` のいずれかの文字が書かれています。$ (i,\ j) $ に書かれている文字を $ C[i][j] $ とします。また、整数 $ i,\ j $ が $ 1\ \leq\ i\ \leq\ H $ と $ 1\ \leq\ j\ \leq\ W $ の少なくとも一方を満たさない場合、 $ C[i][j] $ を `.` と定義します。

正整数 $ a,\ b,\ n $ が以下の条件を全て満たす時、$ (a,b) $ および $ (a+d,b+d),(a+d,b-d),(a-d,b+d),(a-d,b-d) $ $ (1\ \leq\ d\ \leq\ n) $ の $ 4n\ +\ 1 $ マスを **$ (a,b) $ を中心とするサイズ $ n $ のバツ印** と呼びます。

- $ C[a][b] $ は `#` である。
- $ 1\ \leq\ d\ \leq\ n $ を満たす整数 $ d $ について、 $ C[a+d][b+d],C[a+d][b-d],C[a-d][b+d],C[a-d][b-d] $ はいずれも `#` である。
- $ C[a+n+1][b+n+1],C[a+n+1][b-n-1],C[a-n-1][b+n+1],C[a-n-1][b-n-1] $ のうち少なくとも 1 つは `.` である。
 
例えば次の図で示された例では、$ (2,\ 2) $ を中心とするサイズ $ 1 $ のバツ印と $ (3,\ 7) $ を中心とするサイズ $ 2 $ のバツ印がグリッド上にあります。

![image](https://img.atcoder.jp/ghi/abc300c_aa5161e20f55652dc61ad221348765bb002e4eed378c352bc0e44c7555148ebc.jpg)

グリッドにはいくつかのバツ印があります。バツ印を構成するマス以外に `#` は書かれていません。  
 また、異なるバツ印を構成するマス同士は頂点を共有しません。以下の 2 つのグリッドは異なるバツ印を構成するマス同士が頂点を共有している例で、**このようなグリッドの状態は入力として与えられません。** 例えば左のグリッドでは $ (3,\ 3) $ と $ (4,\ 4) $ が頂点を共有しているのが条件に反しています。

![image2](https://cdn.luogu.com.cn/upload/vjudge_pic/AT_abc300_c/af4437e0a6d74885bdf21777218fa90fa4795735.png)

$ N\ =\ \min(H,\ W) $ とします。また、サイズ $ n $ のバツ印の個数を $ S_n $ とします。$ S_1,\ S_2,\ \dots,\ S_N $ を計算してください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ H $ $ W $ $ C[1][1]C[1][2]\dots\ C[1][W] $ $ C[2][1]C[2][2]\dots\ C[2][W] $ $ \vdots $ $ C[H][1]C[H][2]\dots\ C[H][W] $

## 输出格式

$ S_1,\ S_2,\ \dots,\ S_N $ を空白区切りで出力せよ。

## 说明/提示

### 制約

- $ 3\ \leq\ H,\ W\ \leq\ 100 $
- $ C[i][j] $ は `#` または `.`
- 異なるバツ印を構成するマス同士は頂点を共有しない
- $ H,\ W $ は整数
 
### Sample Explanation 1

問題文に書かれた説明の通り、$ (2,\ 2) $ を中心とするサイズ $ 1 $ のバツ印と $ (3,\ 7) $ を中心とするサイズ $ 2 $ のバツ印が書かれています。

### Sample Explanation 2

バツ印が 1 個も書かれていない場合もあります。

## 样例 #1

### 输入

```
5 9

#.#.#...#

.#...#.#.

#.#...#..

.....#.#.

....#...#
```

### 输出

```
1 1 0 0 0
```

## 样例 #2

### 输入

```
3 3

...

...

...
```

### 输出

```
0 0 0
```

## 样例 #3

### 输入

```
3 16

#.#.....#.#..#.#

.#.......#....#.

#.#.....#.#..#.#
```

### 输出

```
3 0 0
```

## 样例 #4

### 输入

```
15 20

#.#..#.............#

.#....#....#.#....#.

#.#....#....#....#..

........#..#.#..#...

#.....#..#.....#....

.#...#....#...#..#.#

..#.#......#.#....#.

...#........#....#.#

..#.#......#.#......

.#...#....#...#.....

#.....#..#.....#....

........#.......#...

#.#....#....#.#..#..

.#....#......#....#.

#.#..#......#.#....#
```

### 输出

```
5 0 1 0 0 0 1 0 0 0 0 0 0 0 0
```



---

---
title: "[ABC300D] AABCC"
layout: "post"
diff: 普及-
pid: AT_abc300_d
tag: []
---

# [ABC300D] AABCC

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc300/tasks/abc300_d

$ N $ 以下の正整数のうち、 $ a\ <\ b\ <\ c $ なる **素数** $ a,b,c $ を用いて $ a^2\ \times\ b\ \times\ c^2 $ と表せるものはいくつありますか?

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $

## 输出格式

答えを整数として出力せよ。

## 说明/提示

### 制約

- $ N $ は $ 300\ \le\ N\ \le\ 10^{12} $ を満たす整数

### Sample Explanation 1

$ 1000 $ 以下で条件を満たす整数は以下の $ 3 $ つです。 - $ 300\ =\ 2^2\ \times\ 3\ \times\ 5^2 $ - $ 588\ =\ 2^2\ \times\ 3\ \times\ 7^2 $ - $ 980\ =\ 2^2\ \times\ 5\ \times\ 7^2 $

## 样例 #1

### 输入

```
1000
```

### 输出

```
3
```

## 样例 #2

### 输入

```
1000000000000
```

### 输出

```
2817785
```



---

---
title: "[ABC301C] AtCoder Cards"
layout: "post"
diff: 普及-
pid: AT_abc301_c
tag: []
---

# [ABC301C] AtCoder Cards

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc301/tasks/abc301_c

AtCoder社ではカードを使った $ 1 $ 人ゲームが流行っています。  
 ゲームで使う各カードには、英小文字 $ 1 $ 文字または `@` の文字が書かれており、いずれのカードも十分多く存在します。  
 ゲームは以下の手順で行います。

1. カードを同じ枚数ずつ $ 2 $ 列に並べる。
2. `@` のカードを、それぞれ `a`, `t`, `c`, `o`, `d`, `e`, `r` のいずれかのカードと置き換える。
3. $ 2 $ つの列が一致していれば勝ち。そうでなければ負け。
 
このゲームに勝ちたいあなたは、次のようなイカサマをすることにしました。

- 手順 $ 1 $ 以降の好きなタイミングで、列内のカードを自由に並び替えてよい。
 
手順 $ 1 $ で並べられた $ 2 $ つの列を表す $ 2 $ つの文字列 $ S,T $ が与えられるので、イカサマをしてもよいときゲームに勝てるか判定してください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ S $ $ T $

## 输出格式

イカサマをしてもよいとき、ゲームに勝てるなら `Yes`、勝てないなら `No` と出力せよ。

## 说明/提示

### 制約

- $ S,T $ は英小文字と `@` からなる
- $ S,T $ の長さは等しく $ 1 $ 以上 $ 2\times\ 10^5 $ 以下
 
### Sample Explanation 1

`@` をうまく置き換えることによって、両方とも `chokudai` と一致させることが可能です。

### Sample Explanation 2

イカサマをし、`@` をうまく置き換えることによって、両方とも `chokudai` と一致させることが可能です。

### Sample Explanation 3

イカサマをしても勝つことはできません。

## 样例 #1

### 输入

```
ch@ku@ai

choku@@i
```

### 输出

```
Yes
```

## 样例 #2

### 输入

```
ch@kud@i

akidu@ho
```

### 输出

```
Yes
```

## 样例 #3

### 输入

```
aoki

@ok@
```

### 输出

```
No
```

## 样例 #4

### 输入

```
aa

bb
```

### 输出

```
No
```



---

---
title: "[ABC302B] Find snuke"
layout: "post"
diff: 普及-
pid: AT_abc302_b
tag: []
---

# [ABC302B] Find snuke

## 题目描述

给你一个 $H$ 行 $W$ 列的字符矩阵。请你在当中的行列或者 $45\degree$ 斜上的八个方向上寻找连续的五个字符 `s`，`n`，`u`，`k`，`e`，并依次输出它们的位置。保证有且仅有一组解。

## 输入格式

第一行 $2$ 个整数 $H,W$。

接下来 $H$ 行每行一个长度为 $W$ 的字符串。

## 输出格式

共五行，每行两个整数，依次表示找到的 `s`，`n`，`u`，`k`，`e` 的坐标。

## 样例 #1

### 输入

```
6 6

vgxgpu

amkxks

zhkbpp

hykink

esnuke

zplvfj
```

### 输出

```
5 2

5 3

5 4

5 5

5 6
```

## 样例 #2

### 输入

```
5 5

ezzzz

zkzzz

ezuzs

zzznz

zzzzs
```

### 输出

```
5 5

4 4

3 3

2 2

1 1
```

## 样例 #3

### 输入

```
10 10

kseeusenuk

usesenesnn

kskekeeses

nesnusnkkn

snenuuenke

kukknkeuss

neunnennue

sknuessuku

nksneekknk

neeeuknenk
```

### 输出

```
9 3

8 3

7 3

6 3

5 3
```



---

---
title: "[ABC302C] Almost Equal"
layout: "post"
diff: 普及-
pid: AT_abc302_c
tag: []
---

# [ABC302C] Almost Equal

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc302/tasks/abc302_c

英小文字からなる長さ $ M $ の文字列 $ N $ 個 $ S_1,S_2,\dots,S_N $ が与えられます。ここで、$ S_i $ は互いに異なります。

これらを並び替えた文字列の列 $ T_1,T_2,\dots,T_N $ であって、以下の条件を満たすものが存在するか判定してください。

- $ 1\ \le\ i\ \le\ N-1 $ を満たす全ての整数 $ i $ に対して、$ T_i $ を $ 1 $ 文字だけ別の英小文字に変えて $ T_{i+1} $ にすることが出来る。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ M $ $ S_1 $ $ S_2 $ $ \vdots $ $ S_N $

## 输出格式

問題文の条件を満たす列が存在するならば `Yes` を、そうでないならば `No` を出力せよ。

## 说明/提示

### 制約

- $ 2\ \le\ N\ \le\ 8 $
- $ 1\ \le\ M\ \le\ 5 $
- $ S_i $ は英小文字からなる長さ $ M $ の文字列である。$ (1\ \le\ i\ \le\ N) $
- $ S_i $ は互いに異なる。

### Sample Explanation 1

`abcd` , `abed` , `bbed` , `fbed` の順に並び替えると条件を満たします。

### Sample Explanation 2

どのように並び替えても条件を満たすことは出来ません。

## 样例 #1

### 输入

```
4 4
bbed
abcd
abed
fbed
```

### 输出

```
Yes
```

## 样例 #2

### 输入

```
2 5
abcde
abced
```

### 输出

```
No
```

## 样例 #3

### 输入

```
8 4
fast
face
cast
race
fact
rice
nice
case
```

### 输出

```
Yes
```



---

---
title: "[ABC302D] Impartial Gift"
layout: "post"
diff: 普及-
pid: AT_abc302_d
tag: []
---

# [ABC302D] Impartial Gift

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc302/tasks/abc302_d

高橋君は青木君とすぬけ君に **$ 1 $ つずつ**贈り物を送ることにしました。  
 青木君への贈り物の候補は $ N $ 個あり、 それぞれの価値は $ A_1,\ A_2,\ \ldots,A_N $ です。  
 すぬけ君への贈り物の候補は $ M $ 個あり、 それぞれの価値は $ B_1,\ B_2,\ \ldots,B_M $ です。

高橋君は $ 2 $ 人への贈り物の価値の差が $ D $ 以下になるようにしたいと考えています。

条件をみたすように贈り物を選ぶことが可能か判定し、可能な場合はそのような選び方における贈り物の価値の和の最大値を求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ M $ $ D $ $ A_1 $ $ A_2 $ $ \ldots $ $ A_N $ $ B_1 $ $ B_2 $ $ \ldots $ $ B_M $

## 输出格式

高橋君が条件をみたすように贈り物を選ぶことができる場合、 条件をみたし、かつ価値の和が最大になるように贈り物を選んだ時の価値の和を出力せよ。 高橋君が条件をみたすように選ぶことができない場合、$ -1 $ を出力せよ。

## 说明/提示

### 制約

- $ 1\leq\ N,M\leq\ 2\times\ 10^5 $
- $ 1\leq\ A_i,B_i\leq\ 10^{18} $
- $ 0\leq\ D\ \leq\ 10^{18} $
- 入力はすべて整数
 
### Sample Explanation 1

高橋君は贈り物の価値の差を $ 2 $ 以下にする必要があります。 青木君に価値 $ 3 $, すぬけ君に価値 $ 5 $ の贈り物を渡すと条件をみたし、価値の和としてはこのときが最大となります。 よって、$ 3+5=8 $ を出力します。

### Sample Explanation 2

条件をみたすように贈り物を選ぶことは不可能です。 また、同一人物に対して、同じ価値の贈り物が複数存在することもあります。

### Sample Explanation 3

答えが $ 32 $ bit整数型の範囲に収まらないことがあることに注意してください。

## 样例 #1

### 输入

```
2 3 2

3 10

2 5 15
```

### 输出

```
8
```

## 样例 #2

### 输入

```
3 3 0

1 3 3

6 2 7
```

### 输出

```
-1
```

## 样例 #3

### 输入

```
1 1 1000000000000000000

1000000000000000000

1000000000000000000
```

### 输出

```
2000000000000000000
```

## 样例 #4

### 输入

```
8 6 1

2 5 6 5 2 1 7 9

7 2 5 5 2 4
```

### 输出

```
14
```



---

---
title: "[ABC303C] Dash"
layout: "post"
diff: 普及-
pid: AT_abc303_c
tag: []
---

# [ABC303C] Dash

## 题目描述

现在高桥在一个二维平面上。初始时他在 $(0,0)$ 处，生命值为 $H$。平面上有 $M$ 个可以恢复生命值的物品，其中第 $i$ 个物品的位置为 $(x_i,y_i)$。

高桥将要进行 $N$ 次移动，第 $i$ 次移动的方式如下：

- 设高桥现在的位置是 $(x,y)$，那么他将会消耗 $1$ 点生命值，同时：
  - 如果 $S_i=\texttt R$，移动到 $(x+1,y)$；
  - 如果 $S_i=\texttt L$，移动到 $(x-1,y)$；
  - 如果 $S_i=\texttt U$，移动到 $(x,y+1)$；
  - 如果 $S_i=\texttt D$，移动到 $(x,y-1)$。
- 如果高桥的生命值降为负数，他就会倒下无法行动；否则，如果当前位置有一个可以恢复生命值的物品，且当前生命值小于 $K$，那么生命值将会恢复到 $K$。

请判断高桥能否进行完所有的移动而不倒下。

#### 数据范围与约定

$1\le N,M,H,K\le2\times10^5$，$|x_i|,|y_i|\le2\times10^5$。

保证 $S$ 是一个只由字符 `R`、`L`、`U`、`D` 构成的长度为 $N$ 的字符串。保证 $(x_i,y_i)$ 两两不同。保证所有输入的数均为整数。

## 输入格式

第一行输入四个数 $N,M,H,K$。第二行输入一个长度为 $N$ 的字符串 $S$。接下来 $M$ 行，第 $i$ 行输入两个数 $(x_i,y_i)$。

## 输出格式

如果高桥可以进行完所有 $N$ 次移动，输出 `Yes`，否则输出 `No`。

## 样例 #1

### 输入

```
4 2 3 1

RUDL

-1 -1

1 0
```

### 输出

```
Yes
```

## 样例 #2

### 输入

```
5 2 1 5

LDRLD

0 0

-1 -1
```

### 输出

```
No
```



---

---
title: "[ABC304C] Virus"
layout: "post"
diff: 普及-
pid: AT_abc304_c
tag: []
---

# [ABC304C] Virus

## 题目描述

编号为 $1\sim N$ 的人站在二维平面上，编号为 $i$ 的人在坐标 $(X_i,Y_i)$ 上。

现在编号为 $1$ 的人患上了一种病毒，并可以传染到与感染者距离 $D$ 以内的其它人身上。定义两个点的距离为其直线距离，即两个点 $(a_1,b_1)$ 与 $(a_2,b_2)$ 的距离为 $\sqrt{(a_1-a_2)^2+(b_1-b_2)^2}$。请你判断，在足够的时间之后，每个人是否会被感染。

## 输入格式

第一行两个整数 $N,D$，含义如图所示。

接下来 $N$ 行，第 $(i+1)$ 行两个整数 $X_i$，$Y_i$。表示编号为 $i$ 的人的坐标。

## 输出格式

共 $N$ 行，第 $i$ 行一个字符串，如果第 $i$ 个人会被感染，输出 `Yes`，否则，输出 `No`。

## 说明/提示

- $1\le N,D\le2000$。
- $-1000\le X_i,Y_y\le 1000$
- 坐标互不相同。
- 输入的所有数据均为整数。

## 样例 #1

### 输入

```
4 5

2 -1

3 1

8 8

0 5
```

### 输出

```
Yes

Yes

No

Yes
```

## 样例 #2

### 输入

```
3 1

0 0

-1000 -1000

1000 1000
```

### 输出

```
Yes

No

No
```

## 样例 #3

### 输入

```
9 4

3 2

6 -1

1 6

6 5

-2 -3

5 3

2 -3

2 1

2 6
```

### 输出

```
Yes

No

No

Yes

Yes

Yes

Yes

Yes

No
```



---

---
title: "[ABC305C] Snuke the Cookie Picker"
layout: "post"
diff: 普及-
pid: AT_abc305_c
tag: []
---

# [ABC305C] Snuke the Cookie Picker

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc305/tasks/abc305_c

縦 $ H $ マス, 横 $ W $ マスのグリッドがあります。上から $ i $ 行目、左から $ j $ 列目のマスを $ (i,\ j) $ と呼びます。  
 はじめ、グリッド上には、ある **縦横 $ 2 $ マス以上** の部分長方形の内部にあるマスにクッキーが 1 枚ずつ置かれていて、それ以外のマスにはクッキーが置かれていません。  
 形式的に説明すると、以下の条件を全て満たす 4 つの整数の組 $ (a,b,c,d) $ がただ 1 つ存在します。

- $ 1\ \leq\ a\ \lt\ b\ \leq\ H $
- $ 1\ \leq\ c\ \lt\ d\ \leq\ W $
- グリッド上のマスのうち、$ a\ \leq\ i\ \leq\ b,\ c\ \leq\ j\ \leq\ d $ を満たす全てのマス $ (i,\ j) $ にはクッキーが 1 枚ずつ置かれていて、それ以外のマスにはクッキーが置かれていない。
 
ところが、すぬけ君がグリッド上のクッキーのどれか 1 枚を取って食べてしまいました。  
 すぬけ君がクッキーを取ったマスは、クッキーが置かれていない状態に変わります。

すぬけ君がクッキーを食べた後のグリッドの状態が入力として与えられます。  
 マス $ (i,\ j) $ の状態は文字 $ S_{i,j} $ として与えられて、`#` はクッキーが置かれているマスを, `.` はクッキーが置かれていないマスを意味します。  
 すぬけ君が食べたクッキーが元々置かれていたマスを答えてください。(答えは一意に定まります。)

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ H $ $ W $ $ S_{1,1} $$ S_{1,2} $$ \dots $$ S_{1,W} $ $ S_{2,1} $$ S_{2,2} $$ \dots $$ S_{2,W} $ $ \vdots $ $ S_{H,1} $$ S_{H,2} $$ \dots $$ S_{H,W} $

## 输出格式

すぬけ君が食べたクッキーが元々置かれていたマスを $ (i,\ j) $ とする。$ i,\ j $ をこの順に空白区切りで出力せよ。

## 说明/提示

### 制約

- $ 2\ \leq\ H,\ W\ \leq\ 500 $
- $ S_{i,j} $ は `#` または `.`
 
### Sample Explanation 1

はじめ、クッキーは $ (2,\ 3) $ を左上、$ (4,\ 5) $ を右下とする部分長方形の内部にあるマスに置かれていて、すぬけ君は $ (2,\ 4) $ にあるクッキーを食べたことがわかります。よって $ (2,\ 4) $ を出力します。

### Sample Explanation 2

はじめ、クッキーは $ (1,\ 1) $ を左上、$ (3,\ 2) $ を右下とする部分長方形の内部にあるマスに置かれていて、すぬけ君は $ (1,\ 2) $ にあるクッキーを食べたことがわかります。

## 样例 #1

### 输入

```
5 6

......

..#.#.

..###.

..###.

......
```

### 输出

```
2 4
```

## 样例 #2

### 输入

```
3 2

#.

##

##
```

### 输出

```
1 2
```

## 样例 #3

### 输入

```
6 6

..####

..##.#

..####

..####

..####

......
```

### 输出

```
2 5
```



---

---
title: "[ABC306D] Poisonous Full-Course"
layout: "post"
diff: 普及-
pid: AT_abc306_d
tag: []
---

# [ABC306D] Poisonous Full-Course

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc306/tasks/abc306_d

高橋くんはレストランで、 $ N $ 品からなる奇妙なフルコースを楽しむことにしました。  
 このコースのうち $ i $ 番目の料理は以下の通りです。

- $ X_i=0 $ の場合、美味しさが $ Y_i $ の **解毒剤入り** の料理
- $ X_i=1 $ の場合、美味しさが $ Y_i $ の **毒入り** の料理
 
高橋くんが料理を食べると、高橋くんの状態は以下のように変化します。

- 最初、高橋くんはお腹を壊していない。
- 高橋くんが **お腹を壊していない** 時、
  - **解毒剤入り** の料理を食べても、高橋くんは **お腹を壊していないまま** である。
  - **毒入り** の料理を食べると、高橋くんは **お腹を壊す** 。
- 高橋くんが **お腹を壊している** 時、
  - **解毒剤入り** の料理を食べると、高橋くんは **お腹を壊していない状態になる** 。
  - **毒入り** の料理を食べると、高橋くんは **死ぬ** 。
 
コースは以下の流れで進行します。

- $ i\ =\ 1,\ \ldots,\ N $ についてこの順に、以下の処理を繰り返す。
  - まず、 $ i $ 番目の料理が高橋くんに提供される。
  - 次に、 高橋くんはこの料理に対し「食べる」か「下げてもらう」かを選択する。
      - 「食べる」を選択した場合、高橋くんは $ i $ 番目の料理を食べる。食べた料理に応じて高橋くんの状態も変化する。
      - 「下げてもらう」を選択した場合、高橋くんは $ i $ 番目の料理を食べない。この料理を後で提供してもらったり何らかの手段で保存したりすることはできない。
  - 最後に、 (状態が変化するなら変化後の時点で) 高橋くんが死んでいない場合、
      - $ i\ \neq\ N $ なら次の料理に進む。
      - $ i\ =\ N $ なら高橋くんは生きて退店する。
 
高橋くんはこのあと重要な仕事があるため、高橋くんは生きて退店しなければなりません。  
 この条件の下で高橋くんが各料理に対し「食べる」「下げてもらう」を選択したとき、高橋くんが **食べた料理の美味しさの総和として考えられる最大値** ( 但し、何も食べなかった場合は $ 0 $ ) を出力してください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ X_1 $ $ Y_1 $ $ X_2 $ $ Y_2 $ $ \vdots $ $ X_N $ $ Y_N $

## 输出格式

答えを整数として出力せよ。

## 说明/提示

### 制約

- 入力は全て整数
- $ 1\ \le\ N\ \le\ 3\ \times\ 10^5 $
- $ X_i\ \in\ \{0,1\} $
  - つまり、 $ X_i $ は $ 0,1 $ のどちらかである。
- $ -10^9\ \le\ Y_i\ \le\ 10^9 $
 
### Sample Explanation 1

以下のように選択することで食べた料理の美味しさの総和を $ 600 $ にでき、これが考えられる最大値です。 - $ 1 $ 番目の料理を下げてもらう。高橋くんはお腹を壊していません。 - $ 2 $ 番目の料理を食べる。高橋くんはお腹を壊し、食べた料理の美味しさの総和は $ 300 $ となります。 - $ 3 $ 番目の料理を食べる。高橋くんはお腹を壊していない状態に戻り、食べた料理の美味しさの総和は $ 100 $ となります。 - $ 4 $ 番目の料理を食べる。高橋くんはお腹を壊し、食べた料理の美味しさの総和は $ 600 $ となります。 - $ 5 $ 番目の料理を下げてもらう。高橋くんはお腹を壊しています。 - 最終的に高橋くんは死んでいないので、高橋くんは生きて退店する。

### Sample Explanation 2

この入力の場合何も食べないことが最善ですが、この場合答えは $ 0 $ となります。

### Sample Explanation 3

答えが $ 32 $ bit 符号付き整数に収まらない可能性があります。

## 样例 #1

### 输入

```
5

1 100

1 300

0 -200

1 500

1 300
```

### 输出

```
600
```

## 样例 #2

### 输入

```
4

0 -1

1 -2

0 -3

1 -4
```

### 输出

```
0
```

## 样例 #3

### 输入

```
15

1 900000000

0 600000000

1 -300000000

0 -700000000

1 200000000

1 300000000

0 -600000000

1 -900000000

1 600000000

1 -100000000

1 -400000000

0 900000000

0 200000000

1 -500000000

1 900000000
```

### 输出

```
4100000000
```



---

---
title: "[ABC307B] racecar"
layout: "post"
diff: 普及-
pid: AT_abc307_b
tag: []
---

# [ABC307B] racecar

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc307/tasks/abc307_b

英小文字のみからなる $ N $ 個の文字列 $ S_1,S_2,\ldots,S_N $ が与えられます。  
 $ 1 $ 以上 $ N $ 以下の **相異なる** 整数 $ i,j $ であって、$ S_i $ と $ S_j $ をこの順に連結した文字列が回文となるようなものが存在するか判定してください。

ただし、長さ $ M $ の文字列 $ T $ が回文であるとは、任意の $ 1\leq\ i\leq\ M $ について、$ T $ の $ i $ 文字目と $ (M+1-i) $ 文字目が一致していることをいいます。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ S_1 $ $ S_2 $ $ \vdots $ $ S_N $

## 输出格式

問題文の条件をみたす $ i,j $ が存在するならば `Yes` を、そうでないならば `No` を出力せよ。

## 说明/提示

### 制約

- $ 2\leq\ N\leq\ 100 $
- $ 1\leq\ \lvert\ S_i\rvert\ \leq\ 50 $
- $ N $ は整数
- $ S_i $ は英小文字のみからなる文字列
- $ S_i $ はすべて異なる。
 
### Sample Explanation 1

$ (i,j)=(1,4) $ とすると、$ S_1= $`ab` と $ S_4= $`a` をこの順に連結した文字列は `aba` となり、 これは回文であるため条件をみたしています。 よって、`Yes` を出力します。 また、$ (i,j)=(5,2) $ としても、$ S_5= $`fe` と $ S_2= $`ccef` をこの順に連結した文字列は `feccef` となり、やはり条件をみたしています。

### Sample Explanation 2

$ S_1 $, $ S_2 $, $ S_3 $ のうち、どの相異なる $ 2 $ つの文字列を繋げても回文となりません。 よって、`No` を出力します。 問題文における $ i,j $ は相異なる必要があることに注意してください。

## 样例 #1

### 输入

```
5

ab

ccef

da

a

fe
```

### 输出

```
Yes
```

## 样例 #2

### 输入

```
3

a

b

aba
```

### 输出

```
No
```

## 样例 #3

### 输入

```
2

aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa

aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa
```

### 输出

```
Yes
```



---

---
title: "[ABC308C] Standings"
layout: "post"
diff: 普及-
pid: AT_abc308_c
tag: []
---

# [ABC308C] Standings

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc308/tasks/abc308_c

$ 1 $ から $ N $ の番号が付いた $ N $ 人がコイントスを何回かしました。人 $ i $ は $ A_i $ 回表を出し、$ B_i $ 回裏を出したこと分かっています。

人 $ i $ のコイントスの **成功率** は $ \displaystyle\frac{A_i}{A_i+B_i} $ で定義されます。人 $ 1,\ldots,N $ の番号を、成功率の高い順に並び替えてください。成功率が同じ人が複数いる場合、その中では人の番号が小さい順になるように並び替えてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ A_1 $ $ B_1 $ $ \vdots $ $ A_N $ $ B_N $

## 输出格式

人 $ 1,\ldots,N $ の番号を成功率の高い順に空白区切りで出力せよ。成功率が同じ人の番号は昇順に並び替えて出力せよ。

## 说明/提示

### 制約

- $ 2\leq\ N\ \leq\ 2\times\ 10^5 $
- $ 0\leq\ A_i,\ B_i\leq\ 10^9 $
- $ A_i+B_i\ \geq\ 1 $
- 入力される数値は全て整数
 
### Sample Explanation 1

人 $ 1 $ の成功率は $ 0.25 $、人 $ 2 $ の成功率は $ 0.75 $、人 $ 3 $ の成功率は $ 0.5 $ です。 成功率の高い順に並び替えると出力例の順番になります。

### Sample Explanation 2

人 $ 1,2 $ は成功率が同じなので、番号の昇順に出力することに注意してください。

## 样例 #1

### 输入

```
3

1 3

3 1

2 2
```

### 输出

```
2 3 1
```

## 样例 #2

### 输入

```
2

1 3

2 6
```

### 输出

```
1 2
```

## 样例 #3

### 输入

```
4

999999999 1000000000

333333333 999999999

1000000000 999999997

999999998 1000000000
```

### 输出

```
3 1 4 2
```



---

---
title: "[ABC309C] Medicine"
layout: "post"
diff: 普及-
pid: AT_abc309_c
tag: []
---

# [ABC309C] Medicine

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc309/tasks/abc309_c

高橋君は医者のすぬけ君から $ N $ 種類の薬を処方されました。$ i $ 種類目の薬は(処方された日を含めて) $ a_i $ 日間、毎日 $ b_i $ 錠ずつ飲む必要があります。また、高橋君はこれ以外の薬を飲む必要がありません。

薬を処方された日を $ 1 $ 日目とします。$ 1 $ 日目以降で、初めて高橋君がその日に飲む必要がある薬が $ K $ 錠以下になるのは何日目かを求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ K $ $ a_1 $ $ b_1 $ $ \vdots $ $ a_N $ $ b_N $

## 输出格式

$ 1 $ 日目以降で、初めて高橋君がその日に飲む必要がある薬が $ K $ 錠以下になるのが $ X $ 日目の時、 $ X $ を出力せよ。

## 说明/提示

### 制約

- $ 1\ \leq\ N\ \leq\ 3\ \times\ 10^5 $
- $ 0\ \leq\ K\ \leq\ 10^9 $
- $ 1\ \leq\ a_i,b_i\ \leq\ 10^9 $
- 入力はすべて整数
 
### Sample Explanation 1

$ 1 $ 日目には、高橋君は $ 1,2,3,4 $ 種類目の薬をそれぞれ $ 3,5,9,2 $ 錠飲む必要があります。よってこの日は $ 19 $ 錠飲む必要があり、$ K(=8) $ 錠以下ではありません。 $ 2 $ 日目には、高橋君は $ 1,2,4 $ 種類目の薬をそれぞれ $ 3,5,2 $ 錠飲む必要があります。よってこの日は $ 10 $ 錠飲む必要があり、$ K(=8) $ 錠以下ではありません。 $ 3 $ 日目には、高橋君は $ 1,4 $ 種類目の薬をそれぞれ $ 3,2 $ 錠飲む必要があります。よってこの日は $ 5 $ 錠飲む必要があり、初めて $ K(=8) $ 錠以下になります。 以上より、$ 3 $ が答えです。

## 样例 #1

### 输入

```
4 8

6 3

2 5

1 9

4 2
```

### 输出

```
3
```

## 样例 #2

### 输入

```
4 100

6 3

2 5

1 9

4 2
```

### 输出

```
1
```

## 样例 #3

### 输入

```
15 158260522

877914575 2436426

24979445 61648772

623690081 33933447

476190629 62703497

211047202 71407775

628894325 31963982

822804784 50968417

430302156 82631932

161735902 80895728

923078537 7723857

189330739 10286918

802329211 4539679

303238506 17063340

492686568 73361868

125660016 50287940
```

### 输出

```
492686569
```



---

---
title: "[ABC317C] Remembering the Days"
layout: "post"
diff: 普及-
pid: AT_abc317_c
tag: []
---

# [ABC317C] Remembering the Days

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc317/tasks/abc317_c

ある地方に、$ 1 $ から $ N $ の番号がついた $ N $ 個の街と、$ 1 $ から $ M $ の番号がついた $ M $ 本の道路があります。

$ i $ 番目の道路は街 $ A_i $ と街 $ B_i $ を双方向に結び、長さは $ C_i $ です。

好きな街からスタートして同じ街を二度以上通らずに別の街へ移動するときの、通る道路の長さの和としてありえる最大値を求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ M $ $ A_1 $ $ B_1 $ $ C_1 $ $ \vdots $ $ A_M $ $ B_M $ $ C_M $

## 输出格式

答えを出力せよ。

## 说明/提示

### 制約

- $ 2\ \leq\ N\ \leq\ 10 $
- $ 1\ \leq\ M\ \leq\ \frac{N(N-1)}{2} $
- $ 1\leq\ A_i\ <\ B_i\ \leq\ N $
- $ (A_i,B_i) $ は相異なる
- $ 1\leq\ C_i\ \leq\ 10^8 $
- 入力は全て整数である
 
### Sample Explanation 1

$ 4\to\ 1\to\ 3\to\ 2 $ と移動すると、通る道路の長さの和は $ 1110 $ となります。

### Sample Explanation 2

道路と繋がっていない街が存在するかもしれません。

### Sample Explanation 3

!\[図\](https://img.atcoder.jp/abc317/06ac62d13dd1c4b2b469a524a60eb093.png)

## 样例 #1

### 输入

```
4 4

1 2 1

2 3 10

1 3 100

1 4 1000
```

### 输出

```
1110
```

## 样例 #2

### 输入

```
10 1

5 9 1
```

### 输出

```
1
```

## 样例 #3

### 输入

```
10 13

1 2 1

1 10 1

2 3 1

3 4 4

4 7 2

4 8 1

5 8 1

5 9 3

6 8 1

6 9 5

7 8 1

7 9 4

9 10 3
```

### 输出

```
20
```



---

---
title: "[ABC322B] Prefix and Suffix"
layout: "post"
diff: 普及-
pid: AT_abc322_b
tag: []
---

# [ABC322B] Prefix and Suffix

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc322/tasks/abc322_b

英小文字からなる文字列 $ S,\ T $ が与えられます。$ S $ の長さは $ N $、$ T $ の長さは $ M $ です。($ N\ \leq\ M $ が制約で保証されています)

$ S $ が $ T $ の **接頭辞** であるとは、$ T $ のはじめ $ N $ 文字からなる文字列が $ S $ と一致することを言います。  
 $ S $ が $ T $ の **接尾辞** であるとは、$ T $ の後ろ $ N $ 文字からなる文字列が $ S $ と一致することを言います。

$ S $ が $ T $ の接頭辞であり、かつ接尾辞でもある場合は $ 0 $ を、  
 $ S $ が $ T $ の接頭辞であるが、接尾辞でない場合は $ 1 $ を、  
 $ S $ が $ T $ の接尾辞であるが、接頭辞でない場合は $ 2 $ を、  
 $ S $ が $ T $ の接頭辞でも接尾辞でもない場合は $ 3 $ を出力してください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ M $ $ S $ $ T $

## 输出格式

問題文の指示に従って答えを出力せよ。

## 说明/提示

### 制約

- $ 1\ \leq\ N\ \leq\ M\ \leq\ 100 $
- $ S $ は英小文字からなる長さ $ N $ の文字列
- $ T $ は英小文字からなる長さ $ M $ の文字列
 
### Sample Explanation 1

$ S $ は $ T $ の接頭辞ですが接尾辞ではありません。よって $ 1 $ を出力します。

### Sample Explanation 2

$ S $ は $ T $ の接尾辞ですが接頭辞ではありません。

### Sample Explanation 3

$ S $ は $ T $ の接頭辞でも接尾辞でもありません。

### Sample Explanation 4

$ S $ と $ T $ が完全に一致する場合もあります。この場合、$ S $ は $ T $ の接頭辞であり、かつ接尾辞でもあります。

## 样例 #1

### 输入

```
3 7

abc

abcdefg
```

### 输出

```
1
```

## 样例 #2

### 输入

```
3 4

abc

aabc
```

### 输出

```
2
```

## 样例 #3

### 输入

```
3 3

abc

xyz
```

### 输出

```
3
```

## 样例 #4

### 输入

```
3 3

aaa

aaa
```

### 输出

```
0
```



---

---
title: "[ABC322C] Festival"
layout: "post"
diff: 普及-
pid: AT_abc322_c
tag: []
---

# [ABC322C] Festival

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc322/tasks/abc322_c

AtCoder 王国では、これから $ N $ 日間のお祭りが開催されます。そのうち、$ A_1 $ 日目、$ A_2 $ 日目、$ \dots $、$ A_M $ 日目の $ M $ 日では花火が上がります。ここで、お祭りの最終日には花火が上がることが保証されます。(つまり、$ A_M=N $ が保証されます。)

$ i=1,2,\dots,N $ に対して、以下の問題を解いてください。

- $ i $ 日目以降で初めて花火が上がるのは、$ i $ 日目から数えて何日後か？ただし、$ i $ 日目に花火が上がる場合 $ 0 $ 日後とする。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ M $ $ A_1 $ $ A_2 $ $ \dots $ $ A_M $

## 输出格式

$ N $ 行出力せよ。

$ i(1\ \le\ i\ \le\ N) $ 行目には、$ i $ 日目以降で初めて花火が上がるのは、$ i $ 日目から数えて何日後かを整数として出力せよ。

## 说明/提示

### 制約

- $ 1\ \le\ M\ \le\ N\ \le\ 2\ \times\ 10^5 $
- $ 1\ \le\ A_1\ <\ A_2\ <\ \dots\ <\ A_M\ =\ N $
- 入力は全て整数

### Sample Explanation 1

AtCoder 王国ではお祭りを $ 3 $ 日間開催し、$ 2,3 $ 日目に花火が上がります。 - $ 1 $ 日目以降で初めて花火が上がるのは $ 2 $ 日目なので、$ 1 $ 日目から数えて $ 1 $ 日後です。 - $ 2 $ 日目以降で初めて花火が上がるのは $ 2 $ 日目なので、$ 2 $ 日目から数えて $ 0 $ 日後です。 - $ 3 $ 日目以降で初めて花火が上がるのは $ 3 $ 日目なので、$ 3 $ 日目から数えて $ 0 $ 日後です。

## 样例 #1

### 输入

```
3 2
2 3
```

### 输出

```
1
0
0
```

## 样例 #2

### 输入

```
8 5
1 3 4 7 8
```

### 输出

```
0
1
0
0
2
1
0
0
```



---

---
title: "[ABC324B] 3-smooth Numbers"
layout: "post"
diff: 普及-
pid: AT_abc324_b
tag: []
---

# [ABC324B] 3-smooth Numbers

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc324/tasks/abc324_b

正の整数 $ N $ が与えられます。 $ N=2^x3^y $ を満たす整数 $ x,y $ が存在するなら `Yes` 、そうでなければ `No` と出力してください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $

## 输出格式

条件を満たす整数 $ x,y $ が存在するなら `Yes` 、そうでなければ `No` と $ 1 $ 行に出力せよ。

## 说明/提示

### 制約

- $ 1\leq\ N\leq10^{18} $
- $ N $ は整数
 
### Sample Explanation 1

$ x=2,y=4 $ とすると、$ 2^x3^y=2^23^4=4\times81=324 $ となるため条件を満たします。 よって、`Yes` と出力してください。

### Sample Explanation 2

どのような整数 $ x,y $ をとっても $ 2^x3^y=5 $ とすることはできません。 よって、`No` と出力してください。

### Sample Explanation 3

$ x=5,y=0 $ とすると、$ 2^x3^y=32\times1=32 $ となるため、`Yes` と出力してください。

## 样例 #1

### 输入

```
324
```

### 输出

```
Yes
```

## 样例 #2

### 输入

```
5
```

### 输出

```
No
```

## 样例 #3

### 输入

```
32
```

### 输出

```
Yes
```

## 样例 #4

### 输入

```
37748736
```

### 输出

```
Yes
```



---

---
title: "[ABC324C] Error Correction"
layout: "post"
diff: 普及-
pid: AT_abc324_c
tag: []
---

# [ABC324C] Error Correction

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc324/tasks/abc324_c

高橋君は英小文字からなる文字列 $ T $ を青木君に向けて送りました。その結果、青木君は英小文字からなる文字列 $ T' $ を受信しました。

$ T' $ は $ T $ から一部が変更されてしまっている可能性があり、具体的には、下記の $ 4 $ つのうちのちょうど $ 1 $ つが成り立つことがわかっています。

- $ T' $ は、$ T $ と等しい。
- $ T' $ は、$ T $ のいずれか $ 1 $ つの位置（先頭と末尾も含む）に英小文字を $ 1 $ つ挿入して得られる文字列である。
- $ T' $ は、$ T $ からある $ 1 $ 文字を削除して得られる文字列である。
- $ T' $ は、$ T $ のある $ 1 $ 文字を別の英小文字に変更して得られる文字列である。
 
青木君が受信した文字列 $ T' $ と、英小文字からなる $ N $ 個の文字列 $ S_1,\ S_2,\ \ldots,\ S_N $ が入力として与えられるので、 $ S_1,\ S_2,\ \ldots,\ S_N $ のうち、高橋君が送った文字列 $ T $ と等しい可能性があるものをすべて求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ T' $ $ S_1 $ $ S_2 $ $ \vdots $ $ S_N $

## 输出格式

$ S_1,\ S_2,\ \ldots,\ S_N $ のうち $ T $ と等しい可能性があるものすべての添字を**昇順に**並べた列を $ (i_1,\ i_2,\ \ldots,\ i_K) $ とする。 この列の長さ $ K $ および列自体を、下記の形式にしたがって出力せよ。

> $ K $ $ i_1 $ $ i_2 $ $ \ldots $ $ i_K $

## 说明/提示

### 制約

- $ N $ は整数
- $ 1\ \leq\ N\ \leq\ 5\ \times\ 10^5 $
- $ S_i $ と $ T' $ は英小文字からなる長さ $ 1 $ 以上 $ 5\ \times\ 10^5 $ 以下の文字列
- $ S_1,\ S_2,\ \ldots,\ S_N $ の長さの総和は $ 5\ \times\ 10^5 $ 以下
 
### Sample Explanation 1

$ S_1,\ S_2,\ \ldots,\ S_5 $ のうち、$ T $ と等しい可能性があるものは $ S_1,\ S_2,\ S_3,\ S_4 $ の $ 4 $ つであることが下記の通りわかります。 - $ S_1 $ は $ T $ と等しい可能性があります。なぜなら、$ T'\ = $ `ababc` は $ S_1\ = $ `ababc` と等しいからです。 - $ S_2 $ は $ T $ と等しい可能性があります。なぜなら、$ T'\ = $ `ababc` は $ S_2\ = $ `babc` の先頭に文字 `a` を挿入して得られる文字列だからです。 - $ S_3 $ は $ T $ と等しい可能性があります。なぜなら、$ T'\ = $ `ababc` は $ S_3\ = $ `abacbc` から $ 4 $ 文字目の `c` を削除して得られる文字列だからです。 - $ S_4 $ は $ T $ と等しい可能性があります。なぜなら、$ T'\ = $ `ababc` は $ S_4\ = $ `abdbc` の $ 3 $ 文字目の `d` を `b` に変更して得られる文字列だからです。 - $ S_5 $ は $ T $ と等しい可能性はありません。なぜなら、$ S_5\ = $ `abbac` を $ T $ としたとき、$ T'\ = $ `ababc` は問題文中の $ 4 $ つの条件をいずれも満たさないからです。

## 样例 #1

### 输入

```
5 ababc

ababc

babc

abacbc

abdbc

abbac
```

### 输出

```
4

1 2 3 4
```

## 样例 #2

### 输入

```
1 aoki

takahashi
```

### 输出

```
0
```

## 样例 #3

### 输入

```
9 atcoder

atoder

atcode

athqcoder

atcoder

tacoder

jttcoder

atoder

atceoder

atcoer
```

### 输出

```
6

1 2 4 7 8 9
```



---

---
title: "[ABC326C] Peak"
layout: "post"
diff: 普及-
pid: AT_abc326_c
tag: []
---

# [ABC326C] Peak

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc326/tasks/abc326_c

高橋くんは数直線上に $ N $ 個のプレゼントを置きました。そのうち $ i $ 個目のプレゼントは座標 $ A_i $ に置かれました。

あなたは数直線上の長さ $ M $ の半開区間 $ [x,x+M) $ を選び、そこに含まれるプレゼントを全て獲得します。  
 より詳しくは、以下の手順でプレゼントを獲得します。

- まず、実数 $ x $ をひとつ選択する。
- その後、プレゼントのうち置かれている座標が $ x\ \le\ A_i\ <\ x+M $ を満たすものを全て獲得する。
 
最大でいくつのプレゼントを獲得することができますか?

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ M $ $ A_1 $ $ A_2 $ $ \dots $ $ A_N $

## 输出格式

答えを整数として出力せよ。

## 说明/提示

### 制約

- 入力は全て整数
- $ 1\ \le\ N\ \le\ 3\ \times\ 10^5 $
- $ 1\ \le\ M\ \le\ 10^9 $
- $ 0\ \le\ A_i\ \le\ 10^9 $
 
### Sample Explanation 1

例えば、半開区間 $ [1.5,7.5) $ を指定します。 このとき、座標 $ 2,3,5,7 $ にある $ 4 $ つのプレゼントを全て獲得することができ、これが獲得可能な最大の個数です。

### Sample Explanation 2

同一の座標に複数のプレゼントが置いてあることもあります。

## 样例 #1

### 输入

```
8 6

2 3 5 7 11 13 17 19
```

### 输出

```
4
```

## 样例 #2

### 输入

```
10 1

3 1 4 1 5 9 2 6 5 3
```

### 输出

```
2
```

## 样例 #3

### 输入

```
10 998244353

100000007 0 1755647 998244353 495 1000000000 1755648 503 1755649 998244853
```

### 输出

```
7
```



---

---
title: "[ABC329D] Election Quick Report"
layout: "post"
diff: 普及-
pid: AT_abc329_d
tag: []
---

# [ABC329D] Election Quick Report

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc329/tasks/abc329_d

$ 1,\ 2,\ \ldots,\ N $ の番号のついた $ N $ 人の候補者から当選者を $ 1 $ 人選ぶ選挙において、$ M $ 票の投票がありました。

各票ではそれぞれちょうど $ 1 $ 人が投票先として選ばれており、$ i $ 票目の投票先は候補者 $ A_i $ です。

これから $ 1 $ 票目から順に開票を行い、 $ 1 $ 票ごとにその時点で開票が終了した場合の当選者を更新して表示します。

開票された票において最も得票数が多かった候補者が当選となります。ただし、最も得票数が多かった候補者が複数いる場合は、その中で最も番号の小さい候補者が当選となります。

各 $ i\ =\ 1,\ 2,\ \ldots,\ M $ について、$ 1,\ 2,\ \ldots,\ i $ 票目のみを開票した場合の当選者を求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ M $ $ A_1 $ $ A_2 $ $ \ldots $ $ A_M $

## 输出格式

$ M $ 行出力せよ。

$ i $ 行目には $ 1,\ 2,\ \ldots,\ i $ 票目のみを開票した場合の当選者の番号を出力せよ。

## 说明/提示

### 制約

- $ 1\ \leq\ N,M\ \leq\ 200000 $
- $ 1\ \leq\ A_i\ \leq\ N $
- 入力される数値はすべて整数
 
### Sample Explanation 1

候補者 $ i $ の得票数を $ C_i $ で表すこととします。 - $ 1 $ 票目までが開票された時点では、$ (C_1,\ C_2,\ C_3)\ =\ (1,\ 0,\ 0) $ なので当選者は $ 1 $ です。 - $ 2 $ 票目までが開票された時点では、$ (C_1,\ C_2,\ C_3)\ =\ (1,\ 1,\ 0) $ なので当選者は $ 1 $ です。 - $ 3 $ 票目までが開票された時点では、$ (C_1,\ C_2,\ C_3)\ =\ (1,\ 2,\ 0) $ なので当選者は $ 2 $ です。 - $ 4 $ 票目までが開票された時点では、$ (C_1,\ C_2,\ C_3)\ =\ (1,\ 2,\ 1) $ なので当選者は $ 2 $ です。 - $ 5 $ 票目までが開票された時点では、$ (C_1,\ C_2,\ C_3)\ =\ (2,\ 2,\ 1) $ なので当選者は $ 1 $ です。 - $ 6 $ 票目までが開票された時点では、$ (C_1,\ C_2,\ C_3)\ =\ (2,\ 2,\ 2) $ なので当選者は $ 1 $ です。 - $ 7 $ 票目までが開票された時点では、$ (C_1,\ C_2,\ C_3)\ =\ (2,\ 2,\ 3) $ なので当選者は $ 3 $ です。

## 样例 #1

### 输入

```
3 7

1 2 2 3 1 3 3
```

### 输出

```
1

1

2

2

1

1

3
```

## 样例 #2

### 输入

```
100 5

100 90 80 70 60
```

### 输出

```
100

90

80

70

60
```

## 样例 #3

### 输入

```
9 8

8 8 2 2 8 8 2 2
```

### 输出

```
8

8

8

2

8

8

8

2
```



---

---
title: "[ABC330C] Minimize Abs 2"
layout: "post"
diff: 普及-
pid: AT_abc330_c
tag: []
---

# [ABC330C] Minimize Abs 2

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc330/tasks/abc330_c

正整数 $ D $ が与えられます。

非負整数 $ x,y $ に対する $ |x^2+y^2-D| $ の最小値を求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ D $

## 输出格式

答えを出力せよ。

## 说明/提示

### 制約

- $ 1\leq\ D\ \leq\ 2\times\ 10^{12} $
- 入力は全て整数
 
### Sample Explanation 1

$ x=4,y=2 $ のとき $ |x^2+y^2-D|\ =\ |16+4-21|=1 $ となります。 $ |x^2+y^2-D|=0 $ を満たすような非負整数 $ x,y $ は存在しないので、答えは $ 1 $ です。

## 样例 #1

### 输入

```
21
```

### 输出

```
1
```

## 样例 #2

### 输入

```
998244353
```

### 输出

```
0
```

## 样例 #3

### 输入

```
264428617
```

### 输出

```
32
```



---

---
title: "[ABC330D] Counting Ls"
layout: "post"
diff: 普及-
pid: AT_abc330_d
tag: []
---

# [ABC330D] Counting Ls

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc330/tasks/abc330_d

$ N\ \times\ N $ のマス目が与えられます。このうち上から $ i $ 行目、左から $ j $ 列目のマスを $ (i,j) $ と書きます。  
 各マスの状態を表す $ N $ 個の長さ $ N $ の文字列 $ S_1,S_2,\dots,S_N $ が以下の形式で与えられます。

- $ S_i $ の $ j $ 文字目が `o` であるとき、 $ (i,j) $ には `o` が書かれている。
- $ S_i $ の $ j $ 文字目が `x` であるとき、 $ (i,j) $ には `x` が書かれている。
 
以下の条件を全て満たすマスの三つ組の個数を求めてください。

- 組に含まれる $ 3 $ マスは相異なる。
- $ 3 $ マス全てに `o` が書かれている。
- マスのうち、丁度 $ 2 $ つが同じ行にある。
- マスのうち、丁度 $ 2 $ つが同じ列にある。
 
但し、ふたつの三つ組は、丁度一方に含まれるマスが存在する場合のみ区別します。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ S_1 $ $ S_2 $ $ \vdots $ $ S_N $

## 输出格式

答えを整数として出力せよ。

## 说明/提示

### 制約

- $ N $ は $ 2 $ 以上 $ 2000 $ 以下の整数
- $ S_i $ は長さ $ N $ の `o` と `x` からなる文字列
 
### Sample Explanation 1

以下の $ 4 $ つの三つ組が条件を満たします。 - $ (1,1),(1,2),(2,1) $ - $ (1,1),(1,3),(2,1) $ - $ (1,1),(1,3),(3,3) $ - $ (1,2),(1,3),(3,3) $

## 样例 #1

### 输入

```
3

ooo

oxx

xxo
```

### 输出

```
4
```

## 样例 #2

### 输入

```
4

oxxx

xoxx

xxox

xxxo
```

### 输出

```
0
```

## 样例 #3

### 输入

```
15

xooxxooooxxxoox

oxxoxoxxxoxoxxo

oxxoxoxxxoxoxxx

ooooxooooxxoxxx

oxxoxoxxxoxoxxx

oxxoxoxxxoxoxxo

oxxoxooooxxxoox

xxxxxxxxxxxxxxx

xooxxxooxxxooox

oxxoxoxxoxoxxxo

xxxoxxxxoxoxxoo

xooxxxooxxoxoxo

xxxoxxxxoxooxxo

oxxoxoxxoxoxxxo

xooxxxooxxxooox
```

### 输出

```
2960
```



---

---
title: "[ABC331C] Sum of Numbers Greater Than Me"
layout: "post"
diff: 普及-
pid: AT_abc331_c
tag: []
---

# [ABC331C] Sum of Numbers Greater Than Me

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc331/tasks/abc331_c

長さ $ N $ の数列 $ A=(A_1,\ldots,A_N) $ が与えられます。

$ i=1,\ldots,N $ のそれぞれについて次の問題を解いてください。

問題：$ A $ の要素のうち $ A_i $ より大きな要素全ての和を求めよ。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ A_1 $ $ \ldots $ $ A_N $

## 输出格式

各 $ 1\leq\ k\leq\ N $ について、$ i=k $ に対する問題の答えを $ B_k $ とする。$ B_1,\ldots,B_N $ をこの順に空白区切りで出力せよ。

## 说明/提示

### 制約

- $ 1\ \leq\ N\ \leq\ 2\times\ 10^5 $
- $ 1\ \leq\ A_i\ \leq\ 10^6 $
- 入力は全て整数である
 
### Sample Explanation 1

\- $ i=1 $ のとき $ A_1=1 $ より大きな要素の和は $ 4+4+2=10 $ - $ i=2 $ のとき $ A_2=4 $ より大きな要素の和は $ 0 $ - $ i=3 $ のとき $ A_3=1 $ より大きな要素の和は $ 4+4+2=10 $ - $ i=4 $ のとき $ A_4=4 $ より大きな要素の和は $ 0 $ - $ i=5 $ のとき $ A_5=2 $ より大きな要素の和は $ 4+4=8 $

## 样例 #1

### 输入

```
5

1 4 1 4 2
```

### 输出

```
10 0 10 0 8
```

## 样例 #2

### 输入

```
10

31 42 59 26 53 58 97 93 23 54
```

### 输出

```
456 414 190 487 361 249 0 97 513 307
```

## 样例 #3

### 输入

```
50

1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1
```

### 输出

```
0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
```



---

---
title: "[ABC332C] T-shirts"
layout: "post"
diff: 普及-
pid: AT_abc332_c
tag: []
---

# [ABC332C] T-shirts

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc332/tasks/abc332_c

AtCoder 社は[ロゴ入りの T シャツ](https://suzuri.jp/AtCoder/5510290/t-shirt/s/ash)を販売しています。

高橋君の $ N $ 日間の予定が `0`, `1`, `2` のみからなる長さ $ N $ の文字列 $ S $ で与えられます。  
具体的には、$ 1\leq\ i\leq\ N $ をみたす整数 $ i $ について、

- $ S $ の $ i $ 文字目が `0` のとき、$ i $ 日目に何の予定も入っていません。
- $ S $ の $ i $ 文字目が `1` のとき、$ i $ 日目に高橋君は食事に行く予定があります。
- $ S $ の $ i $ 文字目が `2` のとき、$ i $ 日目に高橋君は競技プログラミングのイベントに行く予定が入っています。

高橋君は無地の T シャツを $ M $ 枚持っており、$ 1 $ 日目の直前の時点ですべて洗濯済みの状態となっています。  
これに加えて、次の条件をみたすように行動できるように、高橋君は AtCoder のロゴ入りの T シャツを何枚か購入する事にしました。

- 食事に行く日には、無地の T シャツ $ 1 $ 枚またはロゴ入りの T シャツ $ 1 $ 枚を着用する。
- 競技プログラミングのイベントに行く日にはロゴ入りの T シャツ $ 1 $ 枚を着用する。
- 何の予定もない日には T シャツを着用しない。加えて、その時点で着用済みの T シャツを全て洗濯する。 洗濯した T シャツは翌日から着用できる。
- 一度着用した T シャツは次に洗濯するまで着用できない。

$ N $ 日間のうち予定が入っている日すべてについて、条件をみたす T シャツを着用できるようにするために、高橋君は最低何枚のTシャツを購入する必要があるか求めてください。 新しく T シャツを購入する必要がないならば $ 0 $ を出力してください。  
ただし、購入した T シャツも $ 1 $ 日目の直前の時点ですべて洗濯済みの状態で存在するものとします。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ M $ $ S $

## 输出格式

問題文の条件をみたすように行動するために 高橋君が購入する必要のある $ T $ シャツの枚数の最小値を出力せよ。  
新しく購入する必要がないならば $ 0 $ を出力せよ。

## 说明/提示

### 制約

- $ 1\leq\ M\leq\ N\leq\ 1000 $
- $ S $ は `0`, `1`, `2` のみからなる長さ $ N $ の文字列
- $ N,M $ は整数

### Sample Explanation 1

高橋君がロゴ入りの T シャツを $ 2 $ 枚購入したとき、次のようにして高橋君は T シャツを着用することができます。 - $ 1 $ 日目、高橋君はロゴ入りの T シャツを着用して食事に行きます。 - $ 2 $ 日目、高橋君は無地の T シャツを着用して食事に行きます。 - $ 3 $ 日目、高橋君はロゴ入りの T シャツを着用して競技プログラミングのイベントに行きます。 - $ 4 $ 日目、高橋君は予定がないため、着用した T シャツをすべて洗濯します。これにより、$ 1,2,3 $ 日目に着用した T シャツを再び着用することが可能になります。 - $ 5 $ 日目、高橋君はロゴ入りの T シャツを着用して競技プログラミングのイベントに行きます。 - $ 6 $ 日目、高橋君はロゴ入りの T シャツを着用して競技プログラミングのイベントに行きます。 高橋君がロゴ入りの T シャツを $ 1 $ 枚以下しか購入しなかった場合には、 どのようにしても条件をみたすように T シャツを着用することができません。 よって、$ 2 $ を出力します。

### Sample Explanation 3

高橋君は新しく T シャツを購入する必要はありません。

## 样例 #1

### 输入

```
6 1
112022
```

### 输出

```
2
```

## 样例 #2

### 输入

```
3 1
222
```

### 输出

```
3
```

## 样例 #3

### 输入

```
2 1
01
```

### 输出

```
0
```



---

---
title: "[ABC333C] Repunit Trio"
layout: "post"
diff: 普及-
pid: AT_abc333_c
tag: []
---

# [ABC333C] Repunit Trio

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc333/tasks/abc333_c

十進法ですべての桁の数字が $ 1 $ である整数をレピュニットと呼びます。レピュニットを小さい順に並べると $ 1,11,111,\ldots $ です。

ちょうど $ 3 $ つのレピュニットの和として表せる整数のうち $ N $ 番目に小さいものを求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $

## 输出格式

答えを出力せよ。

## 说明/提示

### 制約

- $ N $ は $ 1 $ 以上 $ 333 $ 以下の整数
 
### Sample Explanation 1

ちょうど $ 3 $ つのレピュニットの和として表せる整数を小さい順に並べると $ 3,13,23,33,113,\ldots $ です。例えば $ 113 $ は $ 113=1+1+111 $ と表せます。 $ 3 $ つのレピュニットは相異ならなくてもよいことに注意してください。

## 样例 #1

### 输入

```
5
```

### 输出

```
113
```

## 样例 #2

### 输入

```
19
```

### 输出

```
2333
```

## 样例 #3

### 输入

```
333
```

### 输出

```
112222222233
```



---

---
title: "[ABC334B] Christmas Trees"
layout: "post"
diff: 普及-
pid: AT_abc334_b
tag: []
---

# [ABC334B] Christmas Trees

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc334/tasks/abc334_b

東西に無限に伸びる道路があり、この道路上のある基準となる地点から東に $ x\mathrm{\,m} $ のところにある地点の**座標**は $ x $ と定められています。 特に、基準となる地点から西に $ x\mathrm{\,m} $ のところにある地点の座標は $ -x $ です。

すぬけ君は今から、座標が $ A $ である地点を基点にして $ M\mathrm{\,m} $ おきにクリスマスツリーを立てます。 すなわち、座標がある整数 $ k $ を用いて $ A+kM $ と表されるような地点それぞれにクリスマスツリーを立てます。

高橋君と青木君はそれぞれ座標が $ L,R\ (L\leq\ R) $ である地点に立っています。 高橋君と青木君の間（高橋君と青木君が立っている地点を含む）に立てられるクリスマスツリーの本数を求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ A $ $ M $ $ L $ $ R $

## 输出格式

高橋君と青木君の間（高橋君と青木君が立っている地点を含む）に立てられるクリスマスツリーの本数を出力せよ。

## 说明/提示

### 制約

- $ -10^{18}\leq\ A\ \leq\ 10^{18} $
- $ 1\leq\ M\ \leq\ 10^9 $
- $ -10^{18}\leq\ L\leq\ R\ \leq\ 10^{18} $
- 入力は全て整数

### Sample Explanation 1

すぬけ君は、座標が $ \dots,-4,-1,2,5,8,11,14\dots $ である地点にクリスマスツリーを立てます。 これらのうち高橋君と青木君の間にあるのは、座標が $ -1,2,5 $ である地点に立てられる $ 3 $ 本です。

### Sample Explanation 2

高橋君と青木君が同じ地点に立っていることもあります。

## 样例 #1

### 输入

```
5 3 -1 6
```

### 输出

```
3
```

## 样例 #2

### 输入

```
-2 2 1 1
```

### 输出

```
0
```

## 样例 #3

### 输入

```
-177018739841739480 2436426 -80154573737296504 585335723211047198
```

### 输出

```
273142010859
```



---

---
title: "[ABC335C] Loong Tracking"
layout: "post"
diff: 普及-
pid: AT_abc335_c
tag: []
---

# [ABC335C] Loong Tracking

## 题目描述

## 题意翻译
Takahashi 创造了一款游戏，游戏中玩家可以在坐标平面上控制一条“龙”。

一条“龙”包含 $N$ 个编号为 $1$ 到 $N$ 的部位，而部位 $1$ 被叫做“头”。

初始状态下，第 $i$ 个部位位于坐标（$i$ , $0$）。下面你需要回答 $Q$ 个询问。

- `1 C`：向方向 $C$ 将编号为 $1$ 的头移动一个单位长度。$C$ 可能是 `R`、`L`、`U`、`D` 中的一个字母，分别代表 $x$ 轴正方向、$x$ 轴负方向、$y$ 轴正方向、$y$ 轴负方向。其他的所有部位都会跟随上一个部位移动。形式化地，编号为 $i$ 的部位会移动到编号为 $i-1$ 的部位先前所在的位置。
- `2 p`：输出部位 $p$ 的坐标。

你需要对所有询问 `2` 做出回答。

## 输入格式

第一行两个整数 $N$、$Q$。

下面 $Q$ 行，格式如题面所示。

## 输出格式

对于每个询问 `2 p`，输出部位 $p$ 当前的坐标。

By Misaka16172

## 样例 #1

### 输入

```
5 9
2 3
1 U
2 3
1 R
1 D
2 3
1 L
2 1
2 5
```

### 输出

```
3 0
2 0
1 1
1 0
1 0
```



---

---
title: "[ABC335D] Loong and Takahashi"
layout: "post"
diff: 普及-
pid: AT_abc335_d
tag: []
---

# [ABC335D] Loong and Takahashi

## 题目描述

给定一个 $N \times N$ 的网格，其中 $N$ 是小于等于 $45$ 的奇数。
龙和高桥君要在这个网格上放置 $N^2-1$ 个编号从 $1$ 到 $N^2-1$ 的龙的部件，满足以下条件：

- 高桥君必须放置在网格的中心位置，即 $(\frac{N+1}{2},\frac{N+1}{2})$。
- 除了高桥君所在的位置外，每个格子必须恰好放置一个龙的部件。
- 对于满足 $2 \leq x \leq N^2-1$ 的所有整数 $x$，龙的部件 $x$ 必须放置在与部件 $x-1$ 相邻的格子上，即两个格子之间有边相连。
	- 格子 $(i,j)$ 与格子 $(k,l)$ 相邻，当且仅当 $|i-k|+|j-l|=1$。

请输出满足条件的一种放置方式。

## 输入格式

一行，包含一个整数 $N$。

## 输出格式

输出 $N$ 行。

第 $i$ 行包含 $N$ 个空格分隔的整数，表示在位置 $(i,j)$ 放置的部件编号或者高桥君的位置。
### 约束
- $3 \leq N \leq 45$
- $N$ 是一个奇数

## 样例 #1

### 输入

```
5
```

### 输出

```
1 2 3 4 5

16 17 18 19 6

15 24 T 20 7

14 23 22 21 8

13 12 11 10 9
```



---

---
title: "[ABC336C] Even Digits"
layout: "post"
diff: 普及-
pid: AT_abc336_c
tag: []
---

# [ABC336C] Even Digits

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc336/tasks/abc336_c

非負整数 $ n $ が次の条件を満たすとき、$ n $ を **良い整数** と呼びます。

- $ n $ を $ 10 $ 進法で表したときに、偶数の数字 $ (0,\ 2,\ 4,\ 6,\ 8) $ のみが登場する。
 
例えば $ 0 $、$ 68 $ および $ 2024 $ は良い整数です。

整数 $ N $ が与えられます。良い整数のうち小さい方から $ N $ 番目の整数を求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $

## 输出格式

小さい方から $ N $ 番目の良い整数を出力せよ。

## 说明/提示

### 制約

- $ 1\ \leq\ N\ \leq\ 10^{12} $
- $ N $ は整数
 
### Sample Explanation 1

良い整数を小さい方から順に並べると $ 0,\ 2,\ 4,\ 6,\ 8,\ 20,\ 22,\ 24,\ 26,\ 28,\ \dots $ となります。 小さい方から $ 8 $ 番目の良い整数は $ 24 $ なので、これを出力します。

## 样例 #1

### 输入

```
8
```

### 输出

```
24
```

## 样例 #2

### 输入

```
133
```

### 输出

```
2024
```

## 样例 #3

### 输入

```
31415926535
```

### 输出

```
2006628868244228
```



---

---
title: "[ABC337D] Cheating Gomoku Narabe"
layout: "post"
diff: 普及-
pid: AT_abc337_d
tag: []
---

# [ABC337D] Cheating Gomoku Narabe

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc337/tasks/abc337_d

$ H $ 行 $ W $ 列のグリッドがあります。上から $ i $ 行目、左から $ j $ 列目のマスをマス $ (i,\ j) $ と呼びます。

各マスには `o` 、`x` 、`.` のうちいずれかの文字が書かれています。 各マスに書かれた文字は $ H $ 個の長さ $ W $ の文字列 $ S_1,\ S_2,\ \ldots,\ S_H $ で表され、 マス $ (i,\ j) $ に書かれた文字は、文字列 $ S_i $ の $ j $ 文字目と一致します。

このグリッドに対して、下記の操作を $ 0 $ 回以上好きな回数だけ繰り返します。

- `.` が書かれているマスを $ 1 $ 個選び、そのマスに書かれた文字を `o` に変更する。
 
その結果、縦方向または横方向に連続した $ K $ 個のマスであってそれらに書かれた文字がすべて `o` であるようなものが存在する（ すなわち、下記の $ 2 $ つの条件のうち**少なくとも一方**を満たす）ようにすることが可能かを判定し、可能な場合はそのために行う操作回数の最小値を出力してください。

- $ 1\ \leq\ i\ \leq\ H $ かつ $ 1\ \leq\ j\ \leq\ W-K+1 $ を満たす整数の組 $ (i,\ j) $ であって、マス $ (i,\ j),\ (i,\ j+1),\ \ldots,\ (i,\ j+K-1) $ に書かれた文字が `o` であるものが存在する。
- $ 1\ \leq\ i\ \leq\ H-K+1 $ かつ $ 1\ \leq\ j\ \leq\ W $ を満たす整数の組 $ (i,\ j) $ であって、マス $ (i,\ j),\ (i+1,\ j),\ \ldots,\ (i+K-1,\ j) $ に書かれた文字が `o` であるものが存在する。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ H $ $ W $ $ K $ $ S_1 $ $ S_2 $ $ \vdots $ $ S_H $

## 输出格式

問題文中の条件を満たすことが不可能な場合は `-1` を、可能な場合はそのために行う操作回数の最小値を出力せよ。

## 说明/提示

### 制約

- $ H,\ W,\ K $ は整数
- $ 1\ \leq\ H $
- $ 1\ \leq\ W $
- $ H\ \times\ W\ \leq\ 2\ \times\ 10^5 $
- $ 1\ \leq\ K\ \leq\ \max\lbrace\ H,\ W\ \rbrace $
- $ S_i $ は `o` 、`x` 、`.` のみからなる長さ $ W $ の文字列
 
### Sample Explanation 1

操作を $ 2 $ 回行って、例えばマス $ (2,\ 1) $ とマス $ (2,\ 2) $ に書かれた文字をそれぞれ `o` に変更することで問題文中の条件を満たすことができ、これが最小の操作回数です。

### Sample Explanation 2

操作を一度も行わなくても問題文中の条件を満たします。

### Sample Explanation 3

問題文中の条件を満たすことは不可能なので、`-1` を出力します。

## 样例 #1

### 输入

```
3 4 3

xo.x

..o.

xx.o
```

### 输出

```
2
```

## 样例 #2

### 输入

```
4 2 3

.o

.o

.o

.o
```

### 输出

```
0
```

## 样例 #3

### 输入

```
3 3 3

x..

..x

.x.
```

### 输出

```
-1
```

## 样例 #4

### 输入

```
10 12 6

......xo.o..

x...x.....o.

x...........

..o...x.....

.....oo.....

o.........x.

ox.oox.xx..x

....o...oox.

..o.....x.x.

...o........
```

### 输出

```
3
```



---

---
title: "[ABC347B] Substring"
layout: "post"
diff: 普及-
pid: AT_abc347_b
tag: []
---

# [ABC347B] Substring

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc347/tasks/abc347_b

英小文字からなる文字列 $ S $ が与えられます。$ S $ の空でない部分文字列は何種類ありますか？

ただし、部分文字列とは連続する部分列のことを指します。例えば、`xxx` は `yxxxy` の部分文字列ですが、`xxyxx` の部分文字列ではありません。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ S $

## 输出格式

答えを出力せよ。

## 说明/提示

### 制約

- $ S $ は英小文字からなる長さ $ 1 $ 以上 $ 100 $ 以下の文字列
 
### Sample Explanation 1

$ S $ の空でない部分文字列は以下の $ 5 $ 種類です。 - `a` - `y` - `ay` - `ya` - `yay`

## 样例 #1

### 输入

```
yay
```

### 输出

```
5
```

## 样例 #2

### 输入

```
aababc
```

### 输出

```
17
```

## 样例 #3

### 输入

```
abracadabra
```

### 输出

```
54
```



---

---
title: "[ABC389C] Snake Queue"
layout: "post"
diff: 普及-
pid: AT_abc389_c
tag: []
---

# [ABC389C] Snake Queue

## 题目描述

### 题目大意

有一个空的蛇队列。

有 $Q$ 个查询，查询有三种类型：

- 类型 $1$：以 `1 l` 的形式给出。一条长度为 $l$ 的蛇被添加到队列的末尾。如果添加前队列为空，则新加入的蛇的头部位置为 $0$ ；否则，它的头部位置是队列中最后一条蛇的头部坐标与该蛇长度的总和。
- 类型 $2$：以 `2` 的形式给出。队列最前面的蛇离开队列。保证此时队列不是空的。假设 $m$ 是离开队列的蛇的长度，那么队列中剩余的每条蛇的头部坐标都会减少 $m$。
- 类型 $3$：以 `3 k` 的形式给出。输出第 $k$ 条蛇的蛇头坐标。

## 输入格式

输入内容由标准输入法提供，格式如下：


>$Q$
>
>$\text{query}_1$
>
>$\text{query}_2$
>
>$\vdots$
>
>$\text{query}_Q$


这里，$\text{query}_i$ 是第 $i$ 个查询，格式如下：

>$1$ $l$
>
>$2$
>
>$3$ $k$

## 输出格式

设 $q$ 为 $3$ 类型的查询次数，输出 $q$ 行，第 $i$ 行为第 $i$ 个 $3$ 查询的回答。

**Translate by [HG27895](https://www.luogu.com.cn/user/974959)。**

## 说明/提示

- $1 \leq Q \leq 3 \times 10^{5}$
- 对于 $1$ 查询，$1 \leq l \leq 10^{9}$，保证队列不为空。
- 对于 $2$ 查询，保证队列不为空。
- 对于 $3$ 查询，假设 $n$ 是队列中的蛇的数量，那么 $1 \leq k \leq n$。
- 所有输入均为整数。

## 样例 #1

### 输入

```
7
1 5
1 7
3 2
1 3
1 4
2
3 3
```

### 输出

```
5
10
```

## 样例 #2

### 输入

```
3
1 1
2
1 3
```

### 输出

```

```

## 样例 #3

### 输入

```
10
1 15
1 10
1 5
2
1 5
1 10
1 15
2
3 4
3 2
```

### 输出

```
20
5
```



---

---
title: "[ABC390B] Geometric Sequence"
layout: "post"
diff: 普及-
pid: AT_abc390_b
tag: []
---

# [ABC390B] Geometric Sequence

## 题目描述

给定一个正整数序列 $A$，问这个序列 $A$ 是否为等比数列。如果是，输出 `Yes` ，否则输出 `No`。

## 输入格式

第一行输入一个数 $N$。

第二行输入 $n$ 个数，即序列 $A$。

## 输出格式

如果 $A$ 序列是等比数列，输出 `Yes` ，否则输出 `No`。

## 样例 #1

### 输入

```
5

3 6 12 24 48
```

### 输出

```
Yes
```

## 样例 #2

### 输入

```
3

1 2 3
```

### 输出

```
No
```

## 样例 #3

### 输入

```
2

10 8
```

### 输出

```
Yes
```



---

---
title: "[ABC390C] Paint to make a rectangle"
layout: "post"
diff: 普及-
pid: AT_abc390_c
tag: []
---

# [ABC390C] Paint to make a rectangle

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc390/tasks/abc390_c

$ H $ 行 $ W $ 列のマス目が与えられます。  
 以下、上から $ i $ 行目 $ (1\leq\ i\leq\ H) $ かつ左から $ j $ 列目 $ (1\leq\ j\leq\ W) $ のマスをマス $ (i,j) $ で表します。  
 マス目の状態は $ H $ 個の長さ $ W $ の文字列 $ S_1,S_2,\ \ldots,\ S_H $ によって以下のように表されます。

- $ S_i $ の $ j $ 文字目が `#` のとき、マス $ (i,j) $ は黒く塗られている。
- $ S_i $ の $ j $ 文字目が `.` のとき、マス $ (i,j) $ は白く塗られている。
- $ S_i $ の $ j $ 文字目が `?` のとき、マス $ (i,j) $ は塗られていない。
 
高橋君はまだ塗られていないマスをそれぞれ白または黒で塗ることで、黒マス全体が長方形をなすようにしたいです。  
 より具体的には、ある $ 4 $ つの整数の組 $ (a,b,c,d) $ ($ 1\leq\ a\leq\ b\leq\ H $, $ 1\leq\ c\leq\ d\leq\ W $) が存在して、次が成り立つようにしたいです。

> マス $ (i,j) $ ($ 1\leq\ i\leq\ H $, $ 1\leq\ j\leq\ W $) は、 $ a\leq\ i\leq\ b $ かつ $ c\leq\ j\leq\ d $ をみたすとき、黒く塗られている。  
>  そうでないとき、白く塗られている。

そのようなことが可能か判定してください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ H $ $ W $ $ S_1 $ $ S_2 $ $ \vdots $ $ S_H $

## 输出格式

まだ塗られていないマスをそれぞれ白または黒で塗ることで、黒マス全体が長方形をなすようにできるならば `Yes` を、そうでないならば `No` を出力せよ。

## 说明/提示

### 制約

- $ 1\leq\ H,W\leq\ 1000 $
- $ H $, $ W $ は整数
- $ S_i $ は `#`, `.`, `?` のみからなる長さ $ W $ の文字列
- 黒く塗られたマスが $ 1 $ つ以上存在する。
 
### Sample Explanation 1

マス目は以下の状態になっています。`?` のマスがまだ塗られていないマスです。 !\[\](https://img.atcoder.jp/abc390/85b372e4c19d09eb4f842736d40de3b9.png) マス $ (1,3) $, $ (2,2) $, $ (2,4) $ を黒く塗り、マス $ (3,1) $, $ (3,5) $ を白く塗ることで、 以下のように黒マス全体が長方形をなすようにできます。 !\[\](https://img.atcoder.jp/abc390/535404bb0565608276c41ef49d8f2336.png) よって、`Yes` を出力します。

### Sample Explanation 2

黒マス全体が長方形をなすためには、少なくともマス $ (2,2) $ を黒く塗る必要がありますがすでに白く塗られています。 よって、黒マス全体が長方形をなすようにマス目を塗ることはできないため、`No` を出力します。

## 样例 #1

### 输入

```
3 5

.#?#.

.?#?.

?...?
```

### 输出

```
Yes
```

## 样例 #2

### 输入

```
3 3

?##

#.#

##?
```

### 输出

```
No
```

## 样例 #3

### 输入

```
1 1

#
```

### 输出

```
Yes
```



---

---
title: "Connect Cities"
layout: "post"
diff: 普及-
pid: AT_abl_c
tag: []
---

# Connect Cities

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abl/tasks/abl_c

$ N $ 個の都市 ($ 1 $ 番から $ N $ 番まで) と $ M $ 個の双方向道路 ($ 1 $ 番から $ M $ 番まで) があります。 道路 $ i $ は都市 $ A_i $ と都市 $ B_i $ を結びます。

すぬけ君は、以下の操作を $ 0 $ 回以上行うことができます。

- 道路で直接結ばれていない二つの異なる都市を選び、間に道路を作る。

操作を終えた後、どの都市からどの都市へも (場合によっては複数回) 道路をたどることで到達できるようになっていなければいけません。

目的を達成するために、最低何個の道路を作ればよいですか？

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ M $ $ A_1 $ $ B_1 $ $ : $ $ A_M $ $ B_M $

## 输出格式

答えを出力せよ。

## 说明/提示

### 制約

- $ 2\ \leq\ N\ \leq\ 100,000 $
- $ 1\ \leq\ M\ \leq\ 100,000 $
- $ 1\ \leq\ A_i\ <\ B_i\ \leq\ N $
- どの二つの道路も同じ都市のペアを結ばない。
- 入力は全て整数である。

### Sample Explanation 1

最初に、都市が三つあり、都市 $ 1 $ と都市 $ 2 $ の間に道があります。 すぬけ君は、たとえば都市 $ 1 $ と都市 $ 3 $ の間に道を作ることによって目的を達成できます。 道を作った後、 - 都市 $ 1 $ と $ 2 $ の間を直接旅行できます。 - 都市 $ 1 $ と $ 3 $ の間を直接旅行できます。 - 都市 $ 2 $ と $ 3 $ の間を両方の道を通ることで旅行できます。 ($ 2 $ - $ 1 $ - $ 3 $)

## 样例 #1

### 输入

```
3 1

1 2
```

### 输出

```
1
```



---

---
title: "[AGC001A] BBQ Easy"
layout: "post"
diff: 普及-
pid: AT_agc001_a
tag: []
---

# [AGC001A] BBQ Easy

## 题目描述

Snuke 在参加一个户外烧烤派对，他要将 $2n$ 份食材两两配对组成 $n$ 份。  
每个食材有一个价值，为 $L _ i$。一份食物的价值是其两个食材中较小的那个。  
问最大总价值是多少。

## 输入格式

第一行一个整数 $n$。  
第二行共 $2\times n$ 个整数表示 $L_i$。

## 输出格式

一个整数代表最大价值。

## 说明/提示

$1 \le n \le 100, 1 \le L_i \le 100$。保证 $L_i$ 是整数。

## 样例 #1

### 输入

```
2

1 3 1 2
```

### 输出

```
3
```

## 样例 #2

### 输入

```
5

100 1 2 3 14 15 58 58 58 29
```

### 输出

```
135
```



---

---
title: "[AGC002B] Box and Ball"
layout: "post"
diff: 普及-
pid: AT_agc002_b
tag: []
---

# [AGC002B] Box and Ball

## 题目描述

# [AGC002B] Box and Ball


有 $n$ 个盒子。起初每个盒子里有 $1$ 个球， $1$ 号盒子里的球是红色的，其余都是白色的。

现在给定 $m$ 个操作，每次给出二元组 $(x_i,y_i)$ 表示从 $x_i$ 中随机拿出一个球放进 $y_i$。

求在操作结束后有多少个盒子里**可能**装着红色小球。

——翻译 By 冬天的雨

## 输入格式

第一行两个数，$n,m~(2\leqslant n\leqslant 10^5,1\leqslant m\leqslant 10^5)$

然后 $m$ 行，每行两个数 $x_i,y_i$，保证 $1\leqslant x_i,y_i\leqslant n$ 且 $x_i\neq y_i$

## 输出格式

一个数表示所求答案。



---

---
title: "[AGC003A] Wanna go back home"
layout: "post"
diff: 普及-
pid: AT_agc003_a
tag: []
---

# [AGC003A] Wanna go back home

## 题目描述

高桥君将在一个平面上行走 $n$ 次。

他最开始从 $(0, 0)$ 出发，每次行走的方向已经确定，但是距离没有确定。

请确定每次走路的距离（至少为 $1$），使高桥君在这 $n$ 次行走后可以回到 $(0, 0)$。

## 输入格式

一个长度为 $n$ 的字符串 $S$，第 $i$ 个字符表示第 $i$ 次走路的方向（`N` 为向北走， `S` 为向南走，`W` 为往西走，`E` 为往东走）。

## 输出格式

若可以回到 $(0, 0)$，输出 `Yes`，否则输出 `No`。

## 样例 #1

### 输入

```
SENW
```

### 输出

```
Yes
```

## 样例 #2

### 输入

```
NSNNSNSN
```

### 输出

```
Yes
```

## 样例 #3

### 输入

```
NNEW
```

### 输出

```
No
```

## 样例 #4

### 输入

```
W
```

### 输出

```
No
```



---

---
title: "[AGC004A] Divide a Cuboid"
layout: "post"
diff: 普及-
pid: AT_agc004_a
tag: []
---

# [AGC004A] Divide a Cuboid

## 题目描述

用若干个 $ 1 \times 1 \times 1 $ 的小方块（立方体）组成一个 $ A \times B \times C $ 的大长方体，每个小方块可以涂成红色或蓝色，但要满足以下要求：

① 至少有 $1$ 个红色方块与 $1$ 个蓝色方块。

② 所有的红色方块必须组成一个长方体。

③ 所有的蓝色方块必须组成一个长方体。

求所有满足要求的染色方案中，红色方块数与蓝色方块数相差个数的最小值。

## 输入格式

一行 $3$ 个正整数，分别是 $ A, B, C $。

## 输出格式

一行 $1$ 个数，表示所求的答案。

## 说明/提示

$ 2 ≤ A, B, C ≤ 10^9 $

感谢@刷题永动机 提供的翻译

## 样例 #1

### 输入

```
3 3 3
```

### 输出

```
9
```

## 样例 #2

### 输入

```
2 2 4
```

### 输出

```
0
```

## 样例 #3

### 输入

```
5 3 5
```

### 输出

```
15
```



---

---
title: "[AGC005A] STring"
layout: "post"
diff: 普及-
pid: AT_agc005_a
tag: []
---

# [AGC005A] STring

## 题目描述

[problemUrl]: https://atcoder.jp/contests/agc005/tasks/agc005_a

文字列 $ X $ が与えられます。$ X $ の長さは偶数であり、半分は `S` 、もう半分は `T` からなります。

高橋君は `ST` という文字列が苦手です。なので以下の操作を $ 10^{10000} $ 回行うことにしました。

- $ X $ の(連続な)部分文字列で `ST` となるもののうち、最も左側にあるものを取り除く。存在しないならば何もしない。

最終的に $ X $ は何文字になるかを求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ X $

## 输出格式

$ 1 $ 行に問題の答えを出力する。

## 说明/提示

### 制約

- $ 2\ ≦\ |X|\ ≦\ 200,000 $
- $ X $ の長さは偶数
- $ X $ を構成する文字のうち半分は `S` であり、もう半分は `T` である

### 部分点

- $ 200 $ 点分のデータセットでは $ |X|\ ≦\ 200 $ が成り立つ

### Sample Explanation 1

$ 1 $ 回目の操作では `TSTTSS` の $ 2,3 $ 文字目が `ST` なので取り除きます。 $ X $ は `TTSS` になり、もう `ST` はないため残り $ 10^{10000}-1 $ 回は何もしません。 よって答えは $ 4 $ となります。

### Sample Explanation 2

`SSTTST` ⇒ `STST` ⇒ `ST` ⇒ `` となり、最終的に空文字列になります。

### Sample Explanation 3

`TSSTTTSS` ⇒ `TSTTSS` ⇒ `TTSS` となります。

## 样例 #1

### 输入

```
TSTTSS
```

### 输出

```
4
```

## 样例 #2

### 输入

```
SSTTST
```

### 输出

```
0
```

## 样例 #3

### 输入

```
TSSTTTSS
```

### 输出

```
4
```



---

---
title: "[AGC006A] Prefix and Suffix"
layout: "post"
diff: 普及-
pid: AT_agc006_a
tag: []
---

# [AGC006A] Prefix and Suffix

## 题目描述

[problemUrl]: https://atcoder.jp/contests/agc006/tasks/agc006_a

すぬけ君は次の条件を満たす文字列に興味があります。

- 長さ $ N $ 以上である。
- 先頭 $ N $ 文字が文字列 $ s $ に一致する。
- 末尾 $ N $ 文字が文字列 $ t $ に一致する。

条件を満たす文字列のうち、最も短いものの長さを求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ s $ $ t $

## 输出格式

条件を満たす文字列のうち、最も短いものの長さを出力せよ。

## 说明/提示

### 制約

- $ 1\ <\ =N\ <\ =100 $
- $ s $, $ t $ は長さ $ N $ である。
- $ s $, $ t $ は英小文字のみからなる。

### Sample Explanation 1

最も短い文字列は `abcde` です。

### Sample Explanation 2

最も短い文字列は `az` です。

### Sample Explanation 3

最も短い文字列は `expr` です。

## 样例 #1

### 输入

```
3

abc

cde
```

### 输出

```
5
```

## 样例 #2

### 输入

```
1

a

z
```

### 输出

```
2
```

## 样例 #3

### 输入

```
4

expr

expr
```

### 输出

```
4
```



---

---
title: "[AGC010A] Addition"
layout: "post"
diff: 普及-
pid: AT_agc010_a
tag: []
---

# [AGC010A] Addition

## 题目描述

[problemUrl]: https://atcoder.jp/contests/agc010/tasks/agc010_a

黒板に $ N $ 個の整数が書かれています。$ i $ 番目の整数は $ A_i $ です。

これらの数に対して、高橋君は以下の操作を繰り返します。

- 偶奇が等しい $ 2 $ つの数 $ A_i,A_j $ を一組選び、それらを黒板から消す。
- その後、二つの数の和 $ A_i+A_j $ を黒板に書く。

最終的に黒板に数が $ 1 $ つだけ残るようにできるかどうか判定して下さい。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ A_1 $ $ A_2 $ … $ A_N $

## 输出格式

黒板に数 $ 1 $ つだけ残るようにできるなら `YES` を、そうでないなら `NO` を出力せよ。

## 说明/提示

### 制約

- $ 2\ ≦\ N\ ≦\ 10^5 $
- $ 1\ ≦\ A_i\ ≦\ 10^9 $
- $ A_i $ は整数

### Sample Explanation 1

以下のようにすれば、数を $ 1 $ つだけ残すことができます。 - 黒板から $ 1 $ と $ 3 $ を消し、$ 4 $ を書く。このとき、残る数は $ (2,4) $ である。 - 黒板から $ 2 $ と $ 4 $ を消し、$ 6 $ を書く。このとき、残る数は $ 6 $ だけである。

## 样例 #1

### 输入

```
3

1 2 3
```

### 输出

```
YES
```

## 样例 #2

### 输入

```
5

1 2 3 4 5
```

### 输出

```
NO
```



---

---
title: "[AGC014A] Cookie Exchanges"
layout: "post"
diff: 普及-
pid: AT_agc014_a
tag: []
---

# [AGC014A] Cookie Exchanges

## 题目描述

[problemUrl]: https://atcoder.jp/contests/agc014/tasks/agc014_a

高橋君と青木君とすぬけ君はそれぞれクッキーを $ A,B,C $ 個持っています。

この $ 3 $ 人はお互いにクッキーを交換することにしました。具体的には、以下の操作を繰り返します。

- $ 3 $ 人は同時に、各々が持っているクッキーを半分ずつに分けて、残りの $ 2 $ 人にそれぞれ一方を渡す。

ただし、誰かの持っているクッキーの個数が奇数個になったら、そこで操作を繰り返すのをやめます。

さて、クッキーの交換は何回行うことができるでしょうか。 ただし、無限に続けられる場合もあることに注意してください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ A $ $ B $ $ C $

## 输出格式

$ 3 $ 人がクッキーの交換を行うことができる回数を出力せよ。ただし、無限に続けられる場合は `-1` を出力せよ。

## 说明/提示

### 制約

- $ 1\ ≦\ A,B,C\ ≦\ 10^9 $

### Sample Explanation 1

はじめ、高橋君と青木君とすぬけ君はそれぞれクッキーを $ 4,12,20 $ 個持っており、 - $ 1 $ 回目の操作後は、高橋君と青木君とすぬけ君はそれぞれクッキーを $ 16,12,8 $ 個持っている。 - $ 2 $ 回目の操作後は、高橋君と青木君とすぬけ君はそれぞれクッキーを $ 10,12,14 $ 個持っている。 - $ 3 $ 回目の操作後は、高橋君と青木君とすぬけ君はそれぞれクッキーを $ 13,12,11 $ 個持っている。 $ 3 $ 回目の操作後に高橋君とすぬけ君の持っているクッキーの個数が奇数個になるので、求める回数は $ 3 $ 回となります。

## 样例 #1

### 输入

```
4 12 20
```

### 输出

```
3
```

## 样例 #2

### 输入

```
14 14 14
```

### 输出

```
-1
```

## 样例 #3

### 输入

```
454 414 444
```

### 输出

```
1
```



---

---
title: "[AGC015A] A+...+B Problem"
layout: "post"
diff: 普及-
pid: AT_agc015_a
tag: []
---

# [AGC015A] A+...+B Problem

## 题目描述

[problemUrl]: https://atcoder.jp/contests/agc015/tasks/agc015_a

すぬけ君は、整数を $ N $ 個持っています。このうち最小のものは $ A $、最大のものは $ B $ です。すぬけ君が持っている整数の総和としてありうる値は何通りあるでしょうか。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ A $ $ B $

## 输出格式

総和としてありうる値の個数を出力せよ。

## 说明/提示

### 制約

- $ 1\ ≦\ N,A,B\ ≦\ 10^9 $
- $ A,B $ は整数である

### Sample Explanation 1

$ 18=4+4+4+6,19=4+4+5+6,20=4+5+5+6,21=4+5+6+6,22=4+6+6+6 $ の $ 5 $ つの値が総和として考えられます。

## 样例 #1

### 输入

```
4 4 6
```

### 输出

```
5
```

## 样例 #2

### 输入

```
5 4 3
```

### 输出

```
0
```

## 样例 #3

### 输入

```
1 7 10
```

### 输出

```
0
```

## 样例 #4

### 输入

```
1 3 3
```

### 输出

```
1
```



---

---
title: "[AGC017A] Biscuits"
layout: "post"
diff: 普及-
pid: AT_agc017_a
tag: []
---

# [AGC017A] Biscuits

## 题目描述

[problemUrl]: https://atcoder.jp/contests/agc017/tasks/agc017_a

いくつかのビスケットの入った袋が $ N $ 個あります．$ i $ 番目の袋には $ A_i $ 個のビスケットが入っています．

高木君は，このうちいくつかの袋を選んで，選んだ袋に入っているビスケットをすべて食べるということを行います． このとき，袋を一つも選ばなかったり，すべての袋を選んだりしてもかまいません．

高木君は，食べるビスケットの枚数を $ 2 $ で割ると余りが $ P $ に等しくなるようにしたいです． このような袋の選び方は何通りあるか求めてください．

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ P $ $ A_1 $ $ A_2 $ ... $ A_N $

## 输出格式

高木君が食べるビスケットの枚数を $ 2 $ で割ると $ P $ に等しくなるような，袋の選び方は何通りあるかを出力せよ．

## 说明/提示

### 制約

- $ 1\ \leq\ N\ \leq\ 50 $
- $ P\ =\ 0,\ 1 $
- $ 1\ \leq\ A_i\ \leq\ 100 $

### Sample Explanation 1

食べるビスケットの枚数が $ 2 $ で割って $ 0 $ に等しくなるような選び方は $ 2 $ 通りです： - どちらの袋も選ばない．食べるビスケットの枚数は $ 0 $ である． - どちらの袋も選ぶ．食べるビスケットの枚数は $ 4 $ である．

### Sample Explanation 3

同じ枚数のビスケットが入っている場合でも，異なる袋は区別します．

## 样例 #1

### 输入

```
2 0

1 3
```

### 输出

```
2
```

## 样例 #2

### 输入

```
1 1

50
```

### 输出

```
0
```

## 样例 #3

### 输入

```
3 0

1 1 1
```

### 输出

```
4
```

## 样例 #4

### 输入

```
45 1

17 55 85 55 74 20 90 67 40 70 39 89 91 50 16 24 14 43 24 66 25 9 89 71 41 16 53 13 61 15 85 72 62 67 42 26 36 66 4 87 59 91 4 25 26
```

### 输出

```
17592186044416
```



---

---
title: "[AGC018A] Getting Difference"
layout: "post"
diff: 普及-
pid: AT_agc018_a
tag: []
---

# [AGC018A] Getting Difference

## 题目描述

[problemUrl]: https://atcoder.jp/contests/agc018/tasks/agc018_a

箱に $ N $ 個のボールが入っていて、$ i $ 番目のボールには整数 $ A_i $ が書かれています。 すぬけ君は、次の操作を好きな回数だけ行うことができます。

- 箱から二つのボールを取り出し、その二つのボールに書かれている数の差の絶対値を書いた新しいボールと一緒に箱に戻す。

すぬけ君が、整数 $ K $ の書かれたボールが箱の中に入っている状態にできるかどうか判定してください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ K $ $ A_1 $ $ A_2 $ $ ... $ $ A_N $

## 输出格式

すぬけ君が、整数 $ K $ がかかれたボールが箱の中に入っている状態にできる場合には `POSSIBLE`、 できない場合には `IMPOSSIBLE` と出力せよ。

## 说明/提示

### 制約

- $ 1\ \leq\ N\ \leq\ 10^5 $
- $ 1\ \leq\ A_i\ \leq\ 10^9 $
- $ 1\ \leq\ K\ \leq\ 10^9 $
- 入力はすべて整数である。

### Sample Explanation 1

まず、$ 9 $ と書かれたボールと $ 4 $ と書かれたボールを取り出し、$ abs(9-4)=5 $ なので、$ 5 $ と書かれた新しいボールと一緒に箱に戻します。 次に、$ 3 $ と書かれたボールと $ 5 $ と書かれたボールを取り出し、$ abs(3-5)=2 $ なので、$ 2 $ と書かれた新しいボールと一緒に箱に戻します。 最後に、$ 9 $ と書かれたボールと $ 2 $ と書かれたボールを取り出し、$ abs(9-2)=7 $ なので、$ 7 $ と書かれた新しいボールと一緒に箱に戻します。 $ 7 $ と書かれたボールを箱に入れることができたので、この例の答えは `POSSIBLE` になります。

### Sample Explanation 2

どれだけ操作を行っても、$ 5 $ の書かれたボールを箱の中に入れることはできません。 よってこの例の答えは、`IMPOSSIBLE` になります。

### Sample Explanation 3

操作を行うまでもなく、箱の中には $ 11 $ の書かれたボールが入っています。 よってこの例の答えは、`POSSIBLE` になります。

## 样例 #1

### 输入

```
3 7

9 3 4
```

### 输出

```
POSSIBLE
```

## 样例 #2

### 输入

```
3 5

6 9 3
```

### 输出

```
IMPOSSIBLE
```

## 样例 #3

### 输入

```
4 11

11 3 7 15
```

### 输出

```
POSSIBLE
```

## 样例 #4

### 输入

```
5 12

10 2 8 6 4
```

### 输出

```
IMPOSSIBLE
```



---

---
title: "[AGC020A] Move and Win"
layout: "post"
diff: 普及-
pid: AT_agc020_a
tag: []
---

# [AGC020A] Move and Win

## 题目描述

[problemUrl]: https://atcoder.jp/contests/agc020/tasks/agc020_a

$ N $ 個のマスに区切られた細長い紙切れの上でゲームを行います。マスには $ 1 $ から $ N $ までの番号が順に付けられています。

アリスの駒はマス $ A $ に、ボリスの駒は別のマス $ B $ に置かれています。

二人にはターンが交互に訪れます。アリスが先手です。 ターンが回ってきたプレイヤーは、自分の駒を現在のマス $ X $ から左隣のマス $ X-1 $ か右隣のマス $ X+1 $ のどちらかに動かさなければなりません。 ただし、駒を紙切れの外に出したり、相手の駒と同じマスに動かしてはいけません。 また、駒の移動は一ターンに一度だけ行わなければなりません。

駒を動かせなくなった人が負けで、相手の勝ちとなります。

二人とも、勝ちたいと思っています。二人とも最適にプレイするとき、どちらが勝つでしょうか？

## 输入格式

入力は標準入力から以下の形式で与えられる。

> $ N $ $ A $ $ B $

## 输出格式

アリスが勝つ場合は `Alice`、ボリスが勝つ場合は `Borys`、どちらも勝つことができないなら `Draw` と出力せよ。

## 说明/提示

### 制約

- $ 2\ \leq\ N\ \leq\ 100 $
- $ 1\ \leq\ A $
- 入力値はすべて整数である。

### Sample Explanation 1

アリスは駒をマス $ 3 $ に動かせます。 すると、ボリスは駒をマス $ 3 $ に動かすことができなくなり、マス $ 5 $ に動かすほかなくなります。 そして、アリスが駒をマス $ 4 $ に動かすと、ボリスは駒を動かせなくなり負けます。

### Sample Explanation 2

アリスは最初のターンで駒を動かせず負けます。

## 样例 #1

### 输入

```
5 2 4
```

### 输出

```
Alice
```

## 样例 #2

### 输入

```
2 1 2
```

### 输出

```
Borys
```

## 样例 #3

### 输入

```
58 23 42
```

### 输出

```
Borys
```



---

---
title: "[AGC024A] Fairness"
layout: "post"
diff: 普及-
pid: AT_agc024_a
tag: []
---

# [AGC024A] Fairness

## 题目描述

[problemUrl]: https://atcoder.jp/contests/agc024/tasks/agc024_a

高橋君、中橋君、低橋君は、それぞれ整数 $ A,B,C $ を持っています。 以下の操作を $ K $ 回行った後、高橋君の持っている整数から中橋君の持っている整数を引いた値を求めてください。

- $ 3 $ 人は同時に、他の $ 2 $ 人の持っている整数の和を求める。その後、自分の持っている整数を求めた整数で置き換える。

ただし、答えの絶対値が $ 10^{18} $ を超える場合は、代わりに `Unfair` と出力してください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ A $ $ B $ $ C $ $ K $

## 输出格式

操作を $ K $ 回行った後の、高橋君の持っている整数から中橋君の持っている整数を引いた値を出力せよ。 ただし、答えの絶対値が $ 10^{18} $ を超える場合は、代わりに `Unfair` と出力せよ。

## 说明/提示

### 制約

- $ 1\ \leq\ A,B,C\ \leq\ 10^9 $
- $ 0\ \leq\ K\ \leq\ 10^{18} $
- 入力はすべて整数である

### Sample Explanation 1

$ 1 $ 回の操作後、高橋君、中橋君、低橋君の持っている整数はそれぞれ $ (5,4,3) $ となります。$ 5-4=1 $ を出力します。

## 样例 #1

### 输入

```
1 2 3 1
```

### 输出

```
1
```

## 样例 #2

### 输入

```
2 3 2 0
```

### 输出

```
-1
```

## 样例 #3

### 输入

```
1000000000 1000000000 1000000000 1000000000000000000
```

### 输出

```
0
```



---

---
title: "[AGC027A] Candy Distribution Again"
layout: "post"
diff: 普及-
pid: AT_agc027_a
tag: []
---

# [AGC027A] Candy Distribution Again

## 题目描述

[problemUrl]: https://atcoder.jp/contests/agc027/tasks/agc027_a

$ N $ 人の子供がいます。 子供たちには $ 1,\ 2,\ ...,\ N $ と番号が振られています。

すぬけ君は、$ x $ 個のお菓子を子供たちに配ることにしました。 このとき、すぬけ君は $ x $ 個のお菓子をすべて配り切らなければなりません。 なお、お菓子を貰わない子供がいても構いません。

各 $ i $ ($ 1\ \leq\ i\ \leq\ N $) について、子供 $ i $ はちょうど $ a_i $ 個のお菓子を貰うと喜びます。 すぬけ君は、お菓子を配る方法を工夫し、喜ぶ子供の人数を最大化しようとしています。 喜ぶ子供の人数の最大値を求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ x $ $ a_1 $ $ a_2 $ $ ... $ $ a_N $

## 输出格式

喜ぶ子供の人数の最大値を出力せよ。

## 说明/提示

### 制約

- 入力はすべて整数である。
- $ 2\ \leq\ N\ \leq\ 100 $
- $ 1\ \leq\ x\ \leq\ 10^9 $
- $ 1\ \leq\ a_i\ \leq\ 10^9 $

### Sample Explanation 1

例えば、$ (20,\ 30,\ 20) $ とお菓子を配ればよいです。

### Sample Explanation 2

$ (0,\ 0,\ 10) $ とお菓子を配ればよいです。

### Sample Explanation 3

$ (1,\ 10,\ 100,\ 1000) $ とお菓子を配ればよいです。

### Sample Explanation 4

どのようにお菓子を配っても、どの子供も喜びません。

## 样例 #1

### 输入

```
3 70

20 30 10
```

### 输出

```
2
```

## 样例 #2

### 输入

```
3 10

20 30 10
```

### 输出

```
1
```

## 样例 #3

### 输入

```
4 1111

1 10 100 1000
```

### 输出

```
4
```

## 样例 #4

### 输入

```
2 10

20 20
```

### 输出

```
0
```



---

---
title: "[AGC028A] Two Abbreviations"
layout: "post"
diff: 普及-
pid: AT_agc028_a
tag: []
---

# [AGC028A] Two Abbreviations

## 题目描述

## AT4435 [AGC028A]两个缩写
给定一个长度为 _N_ 的字符串 _S_ 和一个长度为 _M_ 的字符串 _T_ ，这些字符串由小写英文字符组成。

当一个字符串 _X_ 满足以下条件时，称为好字符串 _**（good string）**_ 。

-  _X_ 的长度 _L_ 可以被 _N_ 和 _M_ 整除
- 连接 _X_ 的 1, _L_ / _N_ +1,2× _L_ / _N_ +1, ...( _N_ −1)× _L_ / _N_ +1 且不改变顺序，结果为 _S_
- 连接 _X_ 的 1, _L_ / _M_ +1,2× _L_ / _M_ +1, ...( _M_ −1)× _L_ / _M_ +1 且不改变顺序，结果为 _T_ 

判断是否存在好字符串。如果存在，请找到最短的此类字符串的长度。

------------

## 输入格式

按照以下格式标准输入：

```python
 $ N $   $ M $ 
 $ S $ 
 $ T $ 
```
 

------------

## 输出格式

如果不存在任何一个好字符串，则输出 _-1_ ；如果存在，则打印最短的此类字符串的长度。

------------

### 输入输出样例
样例见原题面

------------

### 制约
- 1≤ _N_ , _M_ ≤10^5
- _S_ , _T_ 由小写字母组成
- ∣ _S_ ∣= _N_ 
- ∣ _T_ ∣= _M_ 

------------

## 说明/提示

`accept` 字符串是一个好字符串。没有比这更短的字符串了，所以答案是6。

## 样例 #1

### 输入

```
3 2

acp

ae
```

### 输出

```
6
```

## 样例 #2

### 输入

```
6 3

abcdef

abc
```

### 输出

```
-1
```

## 样例 #3

### 输入

```
15 9

dnsusrayukuaiia

dujrunuma
```

### 输出

```
45
```



---

---
title: "[AGC029A] Irreversible operation"
layout: "post"
diff: 普及-
pid: AT_agc029_a
tag: []
---

# [AGC029A] Irreversible operation

## 题目描述

[problemUrl]: https://atcoder.jp/contests/agc029/tasks/agc029_a

$ N $ 個のオセロの石が一列に並んでいます。 それぞれの石の状態は長さ $ N $ の文字列 $ S $ によって表されており、 $ S_i= $`B` のとき左から $ i $ 番目の石の表面は黒色、 $ S_i= $`W` のとき左から $ i $ 番目の石の表面は白色となっています。

ここで、以下の操作を行うことを考えます。

- 左から $ i $ 番目の石の表面が黒色、左から $ i+1 $ 番目の石の表面が白色であるような $ i $ ($ 1\ \leq\ i\ <\ N $) を一つ選び、 その $ 2 $ つの石をともに裏返す。つまり、左から $ i $ 番目の石の表面が白色、左から $ i+1 $ 番目の石の表面が黒色になるようにする。

最大で何回この操作を行うことができるか求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ S $

## 输出格式

先の操作を行うことができる回数の最大値を出力せよ。

## 说明/提示

### 制約

- $ 1\ \leq\ |S|\ \leq\ 2\times\ 10^5 $
- $ S_i= $`B` または `W`

### Sample Explanation 1

以下のようにして $ 2 $ 回の操作を行うことができます。 - 左から $ 2 $ 番目、$ 3 $ 番目の石を裏返す。 - 左から $ 1 $ 番目、$ 2 $ 番目の石を裏返す。

## 样例 #1

### 输入

```
BBW
```

### 输出

```
2
```

## 样例 #2

### 输入

```
BWBWBW
```

### 输出

```
6
```



---

---
title: "[AGC030A] Poisonous Cookies"
layout: "post"
diff: 普及-
pid: AT_agc030_a
tag: []
---

# [AGC030A] Poisonous Cookies

## 题目描述

[problemUrl]: https://atcoder.jp/contests/agc030/tasks/agc030_a

高橋君は、解毒剤入りの美味しくないクッキーを $ A $ 枚、解毒剤入りの美味しいクッキーを $ B $ 枚、毒入りの美味しいクッキーを $ C $ 枚持っています。

高橋君は、毒入りのクッキーを食べるとお腹を壊し、お腹を壊した状態で毒入りのクッキーを食べると死んでしまいます。 高橋君は死にたくないので、お腹を壊した状態で毒入りのクッキーを食べることはできません。 お腹を壊した状態で解毒剤入りのクッキーを食べると、お腹の調子が治ります。 解毒剤入りのクッキーを食べる以外に、お腹の調子を治す方法はありません。

高橋君が食べることのできる美味しいクッキーの枚数の最大値を求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ A $ $ B $ $ C $

## 输出格式

高橋君が食べることのできる美味しいクッキーの枚数の最大値を出力せよ。

## 说明/提示

### 制約

- $ 0\ \leq\ A,B,C\ \leq\ 10^9 $
- $ A,B,C $ は整数である

### Sample Explanation 1

以下のような順番でクッキーを食べることで、美味しいクッキーをすべて食べることができます。 - 毒入りの美味しいクッキー - 解毒剤入りの美味しくないクッキー - 毒入りの美味しいクッキー - 解毒剤入りの美味しいクッキー - 毒入りの美味しいクッキー - 解毒剤入りの美味しくないクッキー - 毒入りの美味しいクッキー

## 样例 #1

### 输入

```
3 1 4
```

### 输出

```
5
```

## 样例 #2

### 输入

```
5 2 9
```

### 输出

```
10
```

## 样例 #3

### 输入

```
8 8 1
```

### 输出

```
9
```



---

---
title: "[AGC034A] Kenken Race"
layout: "post"
diff: 普及-
pid: AT_agc034_a
tag: ['分类讨论']
---

# [AGC034A] Kenken Race

## 题目描述

[problemUrl]: https://atcoder.jp/contests/agc034/tasks/agc034_a

$ N $ 個の一列に並んだマス目があり、左から順に番号 $ 1,\ 2,\ ...,\ N $ がついています。長さ $ N $ の `.`, `#` からなる文字列 $ S $ が与えられ、$ S $ の $ i $ 文字目が `#` のときマス目 $ i $ には岩が置かれており、$ S $ の $ i $ 文字目が `.` のときマス目 $ i $ には何も置かれていません。

最初、マス目 $ A $ にすぬけ君、$ B $ にふぬけ君がいます。

あなたは以下の操作を好きなだけ繰り返すことができます。

- すぬけ君かふぬけ君を選び、$ 1 $ マス右か $ 2 $ マス右にジャンプさせる。このときジャンプ先にマスが存在しなければならず、またそのマスに岩が置かれていたりもう一人がいてはならない。

あなたはこの操作を繰り返し、マス目 $ C $ にすぬけ君が、$ D $ にふぬけ君がいるようにしたいです。

このようなことが可能かどうかを判定してください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ A $ $ B $ $ C $ $ D $ $ S $

## 输出格式

題意が達成可能ならば `Yes`、不可能ならば `No` を出力せよ。

## 说明/提示

### 制約

- $ 4\ \leq\ N\ \leq\ 200,000 $
- $ S $ は `.`, `#` からなる長さ $ N $ の文字列
- $ 1\ \leq\ A,\ B,\ C,\ D\ \leq\ N $
- マス目 $ A,\ B,\ C,\ D $ に岩は置かれていない
- $ A,\ B,\ C,\ D $ はすべて異なる
- $ A\ <\ B $
- $ A\ <\ C $
- $ B\ <\ D $

### Sample Explanation 1

たとえば、以下のように移動させれば良いです(すぬけ君、ふぬけ君を `A`, `B` で表します) ``` A#B.#.. A#.B#.. .#AB#.. .#A.#B. .#.A#B. .#.A#.B .#..#AB ```

## 样例 #1

### 输入

```
7 1 3 6 7

.#..#..
```

### 输出

```
Yes
```

## 样例 #2

### 输入

```
7 1 3 7 6

.#..#..
```

### 输出

```
No
```

## 样例 #3

### 输入

```
15 1 3 15 13

...#.#...#.#...
```

### 输出

```
Yes
```



---

---
title: "Contests"
layout: "post"
diff: 普及-
pid: AT_aising2019_b
tag: []
---

# Contests

## 题目描述

[problemUrl]: https://atcoder.jp/contests/aising2019/tasks/aising2019_b

あなたはプログラミングコンテストを開催するため問題を $ N $ 問作成しました。 このうち $ i $ 問目をコンテストに出題する場合、配点は $ P_i $ 点となります。

これらの問題を使って、以下の条件を満たすコンテストをできるだけ多く開催したいと思います。 異なるコンテストの間で問題の重複があってはいけません。 最大で何回のコンテストを開催できますか。

- 問題が $ 3 $ 問出題され、$ 1 $ 問目の配点は $ A $ 点以下、$ 2 $ 問目の配点は $ A\ +\ 1 $ 点以上 $ B $ 点以下、$ 3 $ 問目の配点は $ B\ +\ 1 $ 点以上である。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ A $ $ B $ $ P_1 $ $ P_2 $ $ ... $ $ P_N $

## 输出格式

答えを出力せよ。

## 说明/提示

### 制約

- $ 3\ \leq\ N\ \leq\ 100 $
- $ 1\ \leq\ P_i\ \leq\ 20 $ ($ 1\ \leq\ i\ \leq\ N $)
- $ 1\ \leq\ A\ <\ B\ <\ 20 $
- 入力値はすべて整数である。

### Sample Explanation 1

$ 1,\ 2,\ 3 $ 問目の問題、$ 4,\ 5,\ 6 $ 問目の問題をそれぞれ組み合わせることで $ 2 $ 回のコンテストを開催できます。

### Sample Explanation 2

$ A\ =\ 3 $ 点以下の問題が存在しないので、コンテストを開催できません。

## 样例 #1

### 输入

```
7

5 15

1 10 16 2 7 20 12
```

### 输出

```
2
```

## 样例 #2

### 输入

```
8

3 8

5 5 5 10 10 10 15 20
```

### 输出

```
0
```

## 样例 #3

### 输入

```
3

5 6

5 6 10
```

### 输出

```
1
```



---

---
title: "XYZ Triplets"
layout: "post"
diff: 普及-
pid: AT_aising2020_c
tag: []
---

# XYZ Triplets

## 题目描述

[problemUrl]: https://atcoder.jp/contests/aising2020/tasks/aising2020_c

$ f(n) $ を以下の $ 2 $ つの条件の両方を満たすような $ 3 $ つの整数の組 $ (x,y,z) $ の個数とします。

- $ 1\ \leq\ x,y,z $
- $ x^2\ +\ y^2\ +\ z^2\ +\ xy\ +\ yz\ +\ zx\ =\ n $

整数 $ N $ が与えられるので、$ f(1),f(2),f(3),\ldots,f(N) $ をそれぞれ求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $

## 输出格式

$ N $ 行出力せよ。$ i $ 行目には $ f(i) $ の値を出力せよ。

## 说明/提示

### 制約

- 与えられる入力は全て整数
- $ 1\ \leq\ N\ \leq\ 10^4 $

### Sample Explanation 1

\- $ n=6 $ において、$ (1,1,1) $ のみが問題文中の $ 2 $ つの条件の両方を満たします。よって $ f(6) $ は $ 1 $ です。 - $ n=11 $ において、$ (1,1,2),(1,2,1),(2,1,1) $ の $ 3 $ つが問題文中の $ 2 $ つの条件の両方を満たします。よって $ f(11) $ は $ 3 $ です。 - $ n=17 $ において、$ (1,2,2),(2,1,2),(2,2,1) $ の $ 3 $ つが問題文中の $ 2 $ つの条件の両方を満たします。よって $ f(17) $ は $ 3 $ です。 - $ n=18 $ において、$ (1,1,3),(1,3,1),(3,1,1) $ の $ 3 $ つが問題文中の $ 2 $ つの条件の両方を満たします。よって $ f(18) $ は $ 3 $ です。

## 样例 #1

### 输入

```
20
```

### 输出

```
0

0

0

0

0

1

0

0

0

0

3

0

0

0

0

0

3

3

0

0
```



---

---
title: "[ARC002C] コマンド入力"
layout: "post"
diff: 普及-
pid: AT_arc002_3
tag: []
---

# [ARC002C] コマンド入力

## 题目描述

输入指令

高桥君和朋友玩了格斗游戏。

他们玩的游戏的规则是：手柄上有四个键：A、B、X、Y，按照顺序连续按下一定的按键序列，就可以发动连续技。

然而，高桥君平时都不怎么玩格斗类游戏，所以他被朋友吊打了。

手柄上还有两个按键L、R，可以当快捷键使用。L和R都可以代替任意连续的两个按键，加入快捷键就可以让发动连续技的所需按键次数变小。

举个栗子：有一个连续技要求连续按顺序按下：ABXY，这需要按四次；然而，如果设置L=AB，R=XY，这样连续按顺序按下LR就可以发动同样的连续技，这只需要按两次，简化了操作。

高桥君想赢，他想知道一个连续技的指令最少需要按键多少下才能打出。

## 输入格式

输入第一行是一个整数N，表示连续技的指令包括N个按键。

第二行是长度为N的字符串，表示连续技的指令。

字符串里每个字符都是A、B、X、Y的其中一个。

## 输出格式

输出一个整数，表示添加L、R两个快捷键后，最少按几次可以完成输入的连续技。

注意，最后换行。


感谢@Disconsolate  提供的翻译



---

---
title: "[ARC004B] 2点間距離の最大と最小 ( Maximum and Minimum )"
layout: "post"
diff: 普及-
pid: AT_arc004_2
tag: []
---

# [ARC004B] 2点間距離の最大と最小 ( Maximum and Minimum )

## 题目描述

间距最大值和最小值。( Maximum and Minimum )

平面上有n + 1个点，分别从0到n编号.
虽然不知道各点位置，但对于0以上且小于n的整数i，第i点和第i+1点的距离为d_i。
请求出从第0个点和第n个点的距离能够取到的值的最大值和最小值。

## 输入格式

输入通过以下形式从标准输入中得到。
输入由n +1行构成.
对第1行赋予表示点编号的最大的整数n，( 1≤n≤500 ) .
在从第2行到第n +1行第i+2行( 0≤ i < n)中，表示第i号和第i+1号点的距离为整数d_i ( 1≤d_i≤30000)

## 输出格式

输出被输出到标准输出，由2行构成.
在第1行中，输出作为第0点和第n点距离可取的最大值.  
在第2行中，输出作为第0点和第n点距离可取的最小值.
误差为绝对误差或相对误差至少一方为10^(-3)以下允许
另外，最后输出换行。

感谢@Rising_Date 提供的翻译



---

---
title: "[ARC005B] P-CASカードと高橋君"
layout: "post"
diff: 普及-
pid: AT_arc005_2
tag: []
---

# [ARC005B] P-CASカードと高橋君

## 题目描述

高桥君为了准备即将到来的7月27日土用丑日，打算邮购一些高级鳗鱼食材，通过网上银行来支付。
高桥君使用的银行卡背面有下图所示的9×9密码表。支付的时候从表中某一位置开始根据指定的方向连续读4个数字作为验证码输入，验证是否是本人操作。
下图的例子是从左边第一列，上方第一行开始，按斜右下的方向连续读4个数字。此时读出来的数字是7930.
![从1行1列斜右下方读4个数字的例子](https://cdn.luogu.org/upload/vjudge_pic/AT212/1322cf9dc84e8f92c1d1bc5a04632c79ef77742b.png)
如果读数的过程中超过了边界，就要将方向改变，然后继续读剩余的数字。改变方向的规则如下：
- 原方向是上下左右时
 - 将原方向180°调转
- 原方向是斜向时
 - 在对角线上时
   - 将原方向180°调转
 - 遇到左右边界时
   - 上下方向不变，左右方向调转
 - 遇到上下边界时
   - 左右方向不变，上下方向调转
   
总之如下图所示
![方向改变规则一览](https://cdn.luogu.org/upload/vjudge_pic/AT212/3ac92d5cd0fc3557db9edd76ec244f9fa94d4afd.png)
给出密码表、起始位置和方向，要求输出相应的4位验证码。

## 输入格式

```
x y W
c11 c12 ... c19
c21 c22 ... c29
:
:
c91 c92 ... c99
```
- 共10行输入
- 第1行，整数x代表列(1≤x≤9)，整数y代表行(1≤y≤9)，W表示方向
- W是R、L、U、D、RU、RD、LU、LD的其中一种
 - R : 右方向
 - L : 左方向
 - U : 上方向
 - D : 下方向
 - RU : 右上方向
 - RD : 右下方向
 - LU : 左上方向
 - LD : 左下方向
- 第2行到第9行是密码表中的整数Cij(1≦i,j≦9)
- i和j表示第i行第j列数字Cij
- Cij的范围是0~9

## 输出格式

输出一行四个整数，最后输出换行。
## 输入输出样例
### 输入样例#1
```
3 5 R
790319030
091076399
143245946
590051196
398226115
442567154
112705290
716433235
221041645
```
### 输出样例#1
```
8226
```
### 输入样例#2
```
8 9 LU
206932999
471100777
973172688
108989704
246954192
399039569
944715218
003664867
219006823
```
### 输出样例#2
```
2853
```
### 输入样例#3
```
5 7 D
271573743
915078603
102553534
996473623
595593497
573572507
340348994
253066837
643845096
```
### 输出样例#3
```
4646
```
### 输入样例#4
```
2 2 LU
729142134
509607882
640003027
215270061
214055727
745319402
777708131
018697986
277156993
```
### 输出样例#4
```
0700
```
### 输入样例#5
```
8 7 RD
985877833
469488482
218647263
856777094
012249580
845463670
919136580
011130808
874387671
```
### 输出样例#5
```
8878
```

## 说明/提示

### 样例1
- 3列5行，右方向
![](https://cdn.luogu.org/upload/vjudge_pic/AT212/5e27e15dada42139db5cd3b98f6db7752ae9a657.png)
### 样例2
- 8列9行，左上方向
![](https://cdn.luogu.org/upload/vjudge_pic/AT212/9dc284a6840179386ceb1db5c03530bf6fc8a940.png)
### 样例3
- 5列7行，下方向，遇到下边界，改变方向继续读数
![](https://cdn.luogu.org/upload/vjudge_pic/AT212/d911646cf5ec9ec68da2abe6f843348c89f7f7be.png)
### 样例4
- 2行2列，左上方向，遇到边界，改变方向继续读数
![](https://cdn.luogu.org/upload/vjudge_pic/AT212/f7d82020d9c29a8c427cfb43bd1e4427c999dbd7.png)
### 样例5
- 8行7列，右下方向，遇到边界，改变方向继续读数
![](https://cdn.luogu.org/upload/vjudge_pic/AT212/2aaec32b8dda904f581a7276183c4b15c70541a9.png)



---

---
title: "[ARC006B] あみだくじ"
layout: "post"
diff: 普及-
pid: AT_arc006_2
tag: []
---

# [ARC006B] あみだくじ

## 题目描述

[problemUrl]: https://atcoder.jp/contests/arc006/tasks/arc006_2

 高橋君は学校で班のリーダーを決めなければいけなくなったので、あみだくじを用いて決めることにしました。  
 あみだくじとは、複数の縦線から $ 1 $ 本を選び、その上端から下端へと辿っていき、途中で横線があれば、その横線を通り繋がっている隣接する縦線へと移動し、また下へと進みます。  
 今日はたまたま手元に紙がなかったので、パソコン上で `|`、`-`、`o` を用いて以下のようなあみだくじを作りました。

```

| | | | | | | | |
|-| | |-| | |-| |
| | |-| | |-| | |
| |-| | | | | |-|
| | | |-| | | |-|
| | |-| |-| | | |
|-| | |-| | |-| |
| | | | | |-| | |
            o
```

 `o` がある位置に到達した人がリーダーになります。  
 実は高橋君はリーダーになりたかったので、どの縦線を選べば `o` に辿り着くのか知りたいです。  
  
 左から何番目の縦線を選べばリーダーになれるのかを求めなさい。 入力は以下の形式で標準入力から与えられる。 > $ N $ $ L $ |x|x|‥‥| |x|x|‥‥| |x|x|‥‥| : : : : : : : : | | |‥‥| y y y‥‥y

- 入力は $ L+2 $ 行ある。
- $ 1 $ 行目には、あみだくじの縦線の本数を表す整数 $ N(1≦N≦10) $ とあみたくじの長さを表す整数 $ L(1≦L≦20) $が与えられる。
- $ 2 $ 行目からの $ L $ 行には、あみたくじの形が与えられる。
- $ i $ 行目 $ (2≦i≦L+1) $ には $ 2N-1 $ 文字の記号が与えられる。
- 各行の $ j $ 番目の記号は、以下のようになっている。 
  - $ j $ が奇数の時：`|`
  - $ j $ が偶数の時(上記のxの位置)：`-` または ` `(空白)
- `|` はあみだくじの縦線を表し、`-`はその両端の縦線を繋ぐ横線であることを表す。また、空白はその位置に横線が無いことを表す。
- `|` を $ 1 $ つ挟んで左右に隣り合ったxの位置の両方が `-` という入力は存在しない。

- $ L+2 $ 行目には $ 2N-1 $ 文字の記号が与えられる。
- 各行の $ j $ 番目の記号は、以下のようになっている。 
  - $ j $ が奇数の時(上記のyの位置)：`o` または ` `(空白)
  - $ j $ が偶数の時：` `(空白)
- `o` は $ L+2 $ 行目にただ $ 1 $ つのみ与えられる。
 

 あみだくじを辿って `o` に到達するために選ぶべき縦線は左から何番目か $ 1 $ 行で出力せよ。  
 なお、最後には改行を出力せよ。 ```

3 2
| |-|
|-| |
o    
```

 ```

3
```

- 一番右の縦線を選ぶと、再左端に到達する。つまり、左から $ 3 $ 番目を選択すると、 `o` のある位置に到達できる。
 
```

10 2
| |-| |-| |-| |-| |
|-| |-| |-| |-| |-|
            o      
```

 ```

9
```

- 左から $ 9 $ 番目の縦線から辿ると、`o` の位置に到達できる。
- したがって、答えは $ 9 $ になる。
 
```

1 5
|
|
|
|
|
o
```

 ```

1
```

- 縦線が $ 1 $ 本なので、左から $ 1 $ 番目の縦線が答えとなる。
 
```

4 2
| | | |
| | | |
      o
```

 ```

4
```

- 横線が $ 1 $ 本も存在しないので、`o` のある縦線を選べば良い。
- したがって左から $ 4 $ 番目の縦線が答えとなる。
 
```

9 8
| | | | | | | | |
|-| | |-| | |-| |
| | |-| | |-| | |
| |-| | | | | |-|
| | | |-| | | |-|
| | |-| |-| | | |
|-| | |-| | |-| |
| | | | | |-| | |
            o    
```

 ```

3
```



---

---
title: "[ARC008B] 謎のたこ焼きおじさん"
layout: "post"
diff: 普及-
pid: AT_arc008_2
tag: []
---

# [ARC008B] 謎のたこ焼きおじさん

## 题目描述

你来买章鱼烧的时候，得到了传说中的章鱼烧大师——章鱼烧店的老板高桥先生的认可，被任命为新的章鱼烧店的老板。

你被任命为店长后的第一份工作就是制作店铺的招牌。

现在章鱼烧店的名字已经决定好了，制作招牌的任务就交给了你。

因此这时候高桥老板就给了你几个制作招牌要用的英文字母配件包。

英文字母配件包指的是含有随机英文字母的袋子。

例如：当英文字母配件包表示为字符串ABCC的时候可以被认作是：
- 包含1个英文字母A
- 1个英文字母B
- 和2个英文字母C

也就是说，对于一袋英文配件包ABCC，1个英文字母A、1个英文字母B和2个英文字母C都可以被用于制作招牌。

因为从高桥老板那里得到的英文字母配件包都是相同的，所以打开任何一个英文字母配件包里面的东西也都是一样的。

你不想在制作招牌上花太多的钱，因此要使用尽量少的英文字母配件包，并把剩下的退货。

究竟用多少的英文字母配件包就可以完成招牌的制作呢？

## 输入格式

标准输入如下：
N M
name
kit
- 输入有3行
- 第一行为名字包含的英文字母个数N(1≦N≦50)和每一袋配件包含的英文字母个数M(1≦M≦50)，以空格隔开
- 第二行为店名，一共N个字母，其中包含的字母只有A-Z
- 第三行为配件内所含的所有英文字母的字符串，一共M个字母，其中包含的字母只有A-Z

## 输出格式

1行：制作招牌所需要的最少配件包数

如果所给的配件包无法制作招牌，则输出-1

另外，在输出的最后需要换行

## 说明/提示

- 样例1：因为英文字母配件包ABCDEFGHIJKLMNOPQRSTUVWXYZ内只含有一个O，因此制作招牌NAOHIRO需要两个配件包。
- 样例2：只用一个配件包TAKOYAKI就可以制作完成招牌TAKOYAKI。
- 样例3：英文字母配件包MYON内没有英文字母C,H,K,U,D,A,I，因此无法成功制作招牌。所以输出-1。
- 样例4：替换一下英文字母配件包NAMAKO内的字母顺序，便正好可以制作招牌。



---

---
title: "[ARC009A] 元気にお使い！高橋君"
layout: "post"
diff: 普及-
pid: AT_arc009_1
tag: []
---

# [ARC009A] 元気にお使い！高橋君

## 题目描述

[problemUrl]: https://atcoder.jp/contests/arc009/tasks/arc009_1

ある日高橋君はお母さんに近くのスーパーまでおつかいを頼まれました。  
 お母さんに手渡されたおつかいメモには、買ってきて欲しい商品の値段と個数がそれぞれ書かれています。  
 ただしメモに書かれている値段には消費税が含まれていませんが、全ての商品には消費税が $ 5\% $ かかります。  
 高橋君のおつかいに必要な金額を答えなさい。  
 なお、消費税は $ 1 $ 円未満は切り捨てます。 入力は以下の形式で標準入力から与えられる。

> $ N $ $ a_0 $ $ b_0 $ $ a_1 $ $ b_1 $ : : $ a_{N-1} $ $ b_{N-1} $

- 入力は $ N+1 $ 行ある。
- $ 1 $ 行目には、購入する商品の品数を表す整数 $ N(1≦N≦10) $ が与えられる。
- $ 2 $ 行目から $ N $ 行の $ i+2 $ 行目にはある商品の購入したい個数を表す整数 $ a_i(1≦a_i≦10) $ とその単価を表す整数 $ b_i(1≦b_i≦1,000) $ が空白区切りで与えられる。
 
 高橋君のおつかいに必要な金額を標準出力に $ 1 $ 行で出力せよ。  
 なお、最後には改行を出力せよ。 ```

2
4 120
2 130
```

 ```

777
```

- $ 120×4+130×2=740 $ 円に消費税を加えると $ 740×1.05=777 $ 円になります。
 
```

1
1 100
```

 ```

105
```

- $ 100×1×1.05=105 $ 円になります。
 
```

4
3 510
1 835
2 140
6 205
```

 ```

4068
```

- 合計金額 $ 3875 $ 円に消費税を加えると $ 4068.75 $ 円になります。
- $ 1 $ 円未満は切り捨てるので $ 4068 $ 円が答えになります。
 
```

10
8 10
7 189
4 545
1 596
3 209
10 850
9 943
6 921
8 984
10 702
```

 ```

44321
```



---

---
title: "[ARC013A] 梱包できるかな？"
layout: "post"
diff: 普及-
pid: AT_arc013_1
tag: []
---

# [ARC013A] 梱包できるかな？

## 题目描述

[problemUrl]: https://atcoder.jp/contests/arc013/tasks/arc013_1

この春から新生活を始める今城くんは引越しを考えています。  
 そのため、自分の荷物をダンボールに梱包しなければなりませんが、今城くんの手元には１つのダンボールしかありません。  
 今城くんはこのサイズ $ N×M×L $ のダンボールに、サイズ $ P×Q×R $ の荷物をできるだけたくさん詰め込みたいです。  
 彼はこのダンボールにどれだけ荷物を詰め込むことができるでしょうか。  
  
 彼はとても几帳面な性格なので、荷物を全て同じ向きで梱包します。  
 さらに、今城くんは荷物が運送中に壊れることを防ぐため、斜めに入れることはありません。  
 つまり、荷物の少なくとも1つの面が、ダンボールか他の荷物のある面にぴったりとくっつくように梱包します。  
 ただし、荷物を横に90度倒すことはできます。  
 入力は以下の形式で標準入力から与えられる。

> $ N $ $ M $ $ L $ $ P $ $ Q $ $ R $

1. $ 1 $ 行目には整数 $ N $ 、 $ M $ 、$ L $ が与えられる。

- $ N $ は今城くんが持っているダンボールのタテの長さです。
- $ M $ は今城くんが持っているダンボールのヨコの長さです。
- $ L $ は今城くんが持っているダンボールの高さです。
- $ 1≦N,M,L≦100 $ であることは保証されています。

5. $ 2 $ 行目には整数 $ P $ 、 $ Q $ 、$ R $ が与えられる。
- $ P $ は今城くんが持っている荷物のタテの長さです。
- $ Q $ は今城くんが持っている荷物のヨコの長さです。
- $ R $ は今城くんが持っている荷物の高さです。
- $ 1≦P,Q,R≦100 $ であることは保証されています。
 
 今城くんがダンボールに詰め込むことができる荷物の数の最大値を $ 1 $ 行で出力すること。  
 また、出力の最後には改行をいれること。 ```
<pre class="prettyprint linenums">
10 10 10
1 1 1
```

 ```
<pre class="prettyprint linenums">
1000
```

- 10\*10\*10のダンボールに、1\*1\*1の荷物を梱包すると、最大で1000個の荷物を梱包することができます。
 
```
<pre class="prettyprint linenums">
10 3 1
2 1 1
```

 ```
<pre class="prettyprint linenums">
15
```

- 10\*3\*1のダンボールに、2\*1\*1の荷物を梱包すると、最大で15個の荷物を梱包することができます。
 
```
<pre class="prettyprint linenums">
5 10 3
2 5 3
```

 ```
<pre class="prettyprint linenums">
5
```

- 5\*10\*3のダンボールに、2\*5\*3の荷物を梱包すると、そのままの向きでは、2\*2\*1の4つの荷物を梱包することができます。
- ですが、この向きを変えて、5\*2\*3の荷物とみなすことで、最大5個の荷物を梱包することができます。
 
```
<pre class="prettyprint linenums">
8 8 8
1 1 9
```

 ```
<pre class="prettyprint linenums">
0
```

- 荷物を90度回転させることはできますが、傾けて入れることは出来ない為、この荷物を入れることは出来ません。



---

---
title: "[ARC020A] 石を滑らせるゲーム"
layout: "post"
diff: 普及-
pid: AT_arc020_1
tag: []
---

# [ARC020A] 石を滑らせるゲーム

## 题目描述

蚂蚁Ant和Bug在玩一个关于石头的游戏。这个游戏使用一根笔直的细长的冰板和两个小的石头。冰板每1毫米有1000，-1000两种刻度。开始两只游戏蚂蚁玩家有一块石头。两只蚂蚁游戏者交替地从木板边缘滑动石头。然后，最终滑动的石头更接近0度刻度的玩家将成为该游戏的胜者。此外，如果两个石头上的距离为0，则判为平局。为了Ant先生和Bug先生这两只好玩的蚂蚁，请制定出两个棋子位置的刻度分别被给予时判定胜负的程序。

## 输入格式

--------

1,000≦A≦1,000 -1,000≦B≦1,000

其中A表示ANT，B表示BUG

## 输出格式

--------

若ANT获胜输出“Ant”

若BUG获胜输出“Bug”

若为平局输出“Draw”

## 样例 #1

### 输入

```
2 3
```

### 输出

```
Ant
```

## 样例 #2

### 输入

```
1 0
```

### 输出

```
Bug
```

## 样例 #3

### 输入

```
-100 100
```

### 输出

```
Draw
```



---

---
title: "[ARC021A] DEAD END"
layout: "post"
diff: 普及-
pid: AT_arc021_1
tag: []
---

# [ARC021A] DEAD END

## 题目描述

[problemUrl]: https://atcoder.jp/contests/arc021/tasks/arc021_1

あなたは友人の高橋君からとあるゲームを熱烈にオススメされている。

このゲームは $ 4\ \times\ 4 $ のグリッド状に区切られた $ 16 $ 個のセルと、その上に置かれた数が書かれたタイルを使ってプレーする。$ 1 $ 回の操作では上下左右の $ 4 $ 方向のうちいずれかを指定することができ、指定した方向に向かってセル上のタイルが滑っていく。このとき、同じ数の書かれたタイル $ 2 $ 枚がぶつかるとその $ 2 $ 枚はグリッド上から取り除かれ、代わりに数を $ 2 $ 倍した別のタイルが $ 1 $ 枚新たに置かれる。

次の図は盤面の状態と、そこから右に向かって $ 1 $ 回操作を行った後の盤面の例である。

![](https://cdn.luogu.com.cn/upload/vjudge_pic/AT_arc021_1/bc1076be37559526a99cf6453c91f645c5d9b10f.png)

上下左右のどの方向を指定してもタイルがまったく滑ることができず、同じ数のタイルをぶつけることもできなくなったらゲームオーバーで、それまでに出来るだけ大きい数の書かれたタイルを作るのが目的だ。

このゲームは確かに非常に面白そうだと思ったが、まだ慣れていないからか、グリッド上がタイルでいっぱいになったときにゲームオーバーなのかをなかなか判別できない。そこで、グリッド上のタイルの情報が与えられたときにゲームオーバーの状態なのかどうかを判定するようなプログラムを書くことにした。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ A_{1,1} $ $ A_{1,2} $ $ A_{1,3} $ $ A_{1,4} $ $ A_{2,1} $ $ A_{2,2} $ $ A_{2,3} $ $ A_{2,4} $ $ A_{3,1} $ $ A_{3,2} $ $ A_{3,3} $ $ A_{3,4} $ $ A_{4,1} $ $ A_{4,2} $ $ A_{4,3} $ $ A_{4,4} $

- $ 4 $ 行にわたってタイルの情報が書かれている。$ A_{r,c} $ $ (2\ ≦\ A_{r,c}\ ≦\ 2048) $ は、グリッド上で上から数えて $ r $ 番目、左から数えて $ c $ 番目のセルに置かれているタイルに書かれている数を表す。 
  - $ A_{r,c} $ はすべて $ 2 $ の累乗である。すなわち、$ A_{r,c} $ は $ 2,\,4,\,8,\,16,\,32,\,64,\,128,\,256,\,512,\,1024,\,2048 $ のいずれかである。

## 输出格式

与えられたグリッドの状態がゲームオーバーなら `GAMEOVER`、まだ操作ができるなら `CONTINUE` と $ 1 $ 行に出力せよ。

出力の末尾にも改行をいれること。

## 说明/提示

### Sample Explanation 1

上下にはタイルを動かすことができませんが、左右に動かせば $ 2 $ が書かれたタイルどうしや $ 8 $ が書かれたタイルどうしをぶつけることが可能です。

### Sample Explanation 2

どの方向に動かそうとしても同じ数の書かれたタイルをぶつけることができません。

## 样例 #1

### 输入

```
2 8 2 2

32 2 8 8

4 64 2 128

2 8 4 2
```

### 输出

```
CONTINUE
```

## 样例 #2

### 输入

```
2 4 16 4

8 32 128 8

2 64 16 2

32 4 32 4
```

### 输出

```
GAMEOVER
```

## 样例 #3

### 输入

```
2 4 2 4

4 2 4 2

2 4 2 4

4 2 4 2
```

### 输出

```
GAMEOVER
```



---

---
title: "[ARC029A] 高橋君とお肉"
layout: "post"
diff: 普及-
pid: AT_arc029_1
tag: []
---

# [ARC029A] 高橋君とお肉

## 题目描述

[problemUrl]: https://atcoder.jp/contests/arc029/tasks/arc029_1

高橋君は友達とキャンプに行くことになった。

高橋君と友達は性能が同じである $ 2 $ 個の肉焼き器を持っており、それぞれの肉焼き器にお肉を乗せて並行して焼くことができる。一旦肉焼き器にお肉を乗せたら、お肉が焼きあがるまではその肉焼き器からお肉を取り出したり、その肉焼き器に別のお肉を乗せたりはできない。お肉が焼けたらお肉を取り出すことができる。$ 2 $ つの肉焼き器にまたがって $ 1 $ つのお肉を置くことはできない。また、お肉は全部で $ N $ 個あり、お肉には $ 1 $ から $ N $ まで番号が付けられている。お肉 $ i $ を焼くのには、どちらの肉焼き器でも時間 $ t_i $ だけかかる。お肉を肉焼き器に置く動作、取り出す動作には時間がかからない。

高橋君はお肉を焼く係であり、$ N $ 個すべてのお肉を焼くことになった。みんなお腹が空いているので、すべてのお肉を焼くのにかかる時間を最小化させたい。

すべてのお肉を焼くのにかかる時間の最小値を求めよ。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ t_1 $ $ t_2 $ : $ t_N $

- $ 1 $ 行目には、お肉の個数を表す整数 $ N\ (1\ ≦\ N\ ≦\ 4) $ が与えられる。これは、お肉が $ N $ 個あることを表す。
- $ 2 $ 行目から $ N $ 行にはお肉の情報が与えられる。$ N $ 行のうち $ i $ 行目には整数 $ t_i $ が書かれており、これはお肉 $ i $ を焼くのにかかる時間が $ t_i\ (1\ ≦\ t_i\ ≦\ 50) $ であることを表す。

## 输出格式

すべてのお肉を焼くのにかかる時間の最小値を $ 1 $ 行に出力せよ。出力の末尾にも改行を入れること。

## 说明/提示

### Sample Explanation 1

一方の肉焼き器でお肉 $ 1 $ とお肉 $ 4 $ を、他方の肉焼き器でお肉 $ 2 $ とお肉 $ 3 $ を順に焼きます (下の図は参考図)。 !\[\](/img/arc/029/1-1.png)

### Sample Explanation 2

一方の肉焼き器でお肉 $ 3 $ を焼いている間に、他方の肉焼き器で残りすべてのお肉を焼きます。

## 样例 #1

### 输入

```
4

4

6

7

10
```

### 输出

```
14
```

## 样例 #2

### 输入

```
3

1

2

4
```

### 输出

```
4
```

## 样例 #3

### 输入

```
1

29
```

### 输出

```
29
```



---

---
title: "[ARC034B] 方程式"
layout: "post"
diff: 普及-
pid: AT_arc034_2
tag: []
---

# [ARC034B] 方程式

## 题目描述

[problemUrl]: https://atcoder.jp/contests/arc034/tasks/arc034_2

正整数 $ n $ に対し、$ n $ の十進表記における各桁の数の和を $ f(n) $ で表す。例えば、 $ f(123)\ =\ 1\ +\ 2\ +\ 3\ =\ 6, $ $ f(4)\ =\ 4 $ となる。

正整数 $ N $ が与えられる。等式 $ x\ +\ f(x)\ =\ N $ を満たす正整数 $ x $ を全て求めよ。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $

- $ 1 $ 行目に、$ 1 $ 個の整数 $ N $ ($ 1\ ≦\ N\ ≦\ 1018 $) が与えられる。

## 输出格式

等式を満たす正整数 $ x $ の値の個数を $ k $ とする。$ 1 $ 行目に $ k $ の値を出力し、続く $ k $ 行に等式を満たす正整数 $ x $ の値を昇順で各行に $ 1 $ 個ずつ出力せよ。

末尾の改行を忘れないこと。

## 说明/提示

### 部分点

この問題には部分点が設定されている。

- $ 20 $ 点分のテストケースは $ 1\ ≦\ N\ ≦\ 1000 $ を満たす。

### Sample Explanation 1

問題文で述べたように $ f(4)\ =\ 4 $ であり、 $ 4 $ 以外に題意を満たす正整数は存在しない。

### Sample Explanation 2

複数の解が存在することがある。

### Sample Explanation 3

解が存在しないこともある。

## 样例 #1

### 输入

```
8
```

### 输出

```
1

4
```

## 样例 #2

### 输入

```
101
```

### 输出

```
2

91

100
```

## 样例 #3

### 输入

```
108
```

### 输出

```
0
```



---

---
title: "[ARC045A] スペース高橋君"
layout: "post"
diff: 普及-
pid: AT_arc045_a
tag: []
---

# [ARC045A] スペース高橋君

## 题目描述

[problemUrl]: https://atcoder.jp/contests/arc045/tasks/arc045_a

スペース高橋君は今日も銀河の平和を守っています。

スペース高橋君は銀河の治安を悪化させているスペース青木君と踊りで勝負することにしました。

具体的な方法を説明します。

スペース青木君は `Left`、`Right`、`AtCoder`、の三種類の単語からなる言葉を発します。

スペース高橋君は `Left` と聞いたら `<`、`Right` と聞いたら `>`、`AtCoder` と聞いたら `A` と答えます。

あなたの仕事は、スペース高橋君をサポートするためのプログラムを書くことです。

スペース青木君の発した言葉が与えられるので、スペース高橋君の発する言葉を表示するプログラムを作ってください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ S $

- $ 1 $ 行目には文字列 $ S $ が与えられる。$ S $ には半角スペースが含まれることもあることに注意せよ。
- $ S $ の長さは $ 1 $ 文字以上 $ 100 $ 文字以下である。
- $ S $ は、$ 3 $ 種類の単語 (`Left`、`Right`、`AtCoder`) いくつかを半角スペース $ 1 $ つでつないだものである。

## 输出格式

出力は標準出力に行い、末尾に改行を入れること。

$ S $ について、`Left` を `<`、`Right`を`>`、`AtCoder` を `A` に置換したものを一行に出力せよ。行の最後に余分な空白を入れないように注意すること。

## 样例 #1

### 输入

```
Left Right AtCoder
```

### 输出

```
< > A
```

## 样例 #2

### 输入

```
Left Left Right Right AtCoder
```

### 输出

```
< < > > A
```

## 样例 #3

### 输入

```
Right Right AtCoder Left Left AtCoder
```

### 输出

```
> > A < < A
```



---

---
title: "[ARC051A] 塗り絵"
layout: "post"
diff: 普及-
pid: AT_arc051_a
tag: []
---

# [ARC051A] 塗り絵

## 题目描述

[problemUrl]: https://atcoder.jp/contests/arc051/tasks/arc051_a

白く塗られた二次元平面を考えます。

まず、$ (x_1,\ y_1) $ からの距離が $ r $ 以下の部分を赤く塗ります。

そのあと、 $ x_2\ ≦\ x\ ≦\ x_3,\ y_2\ ≦\ y\ ≦\ y_3 $ を満たす $ (x,\ y) $ を青く塗ります。

なお、赤く塗られた後、更に青く塗られた部分は紫色になるとします。

赤く塗られた部分と青く塗られた部分が存在するかどうかをそれぞれ判定してください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ x_1 $ $ y_1 $ $ r $ $ x_2 $ $ y_2 $ $ x_3 $ $ y_3 $

## 输出格式

$ 2 $ 行出力せよ。

$ 1 $ 行目には赤く塗られた部分が存在するならば `YES`、そうでないなら `NO` を出力。

$ 2 $ 行目には青く塗られた部分が存在するならば `YES`、そうでないなら `NO` を出力する。

## 说明/提示

### 制約

- $ -100\ ≦\ x_1,\ y_1\ ≦\ 100 $
- $ -100\ ≦\ x_2\ <\ x_3\ ≦\ 100 $
- $ -100\ ≦\ y_2\ <\ y_3\ ≦\ 100 $
- $ 1\ ≦\ r\ ≦\ 100 $
- 与えられる数は全て整数である。

### Sample Explanation 1

!\[A\_img1\](https://arc051.contest.atcoder.jp/img/arc/051/tonarinokyakuhayokukakikuukyakuda/axis1.png) 赤い部分も青い部分もあります

### Sample Explanation 2

!\[A\_img2\](https://arc051.contest.atcoder.jp/img/arc/051/tonarinokyakuhayokukakikuukyakuda/axis2.png) 赤く塗られた部分は存在しません。

### Sample Explanation 3

!\[A\_img3\](https://arc051.contest.atcoder.jp/img/arc/051/tonarinokyakuhayokukakikuukyakuda/axis3.png) 青く塗られた部分は存在しません。

### Sample Explanation 4

!\[A\_img4\](https://arc051.contest.atcoder.jp/img/arc/051/tonarinokyakuhayokukakikuukyakuda/axis4.png) 円と長方形が重なっていますが赤く塗られた部分も青く塗られた部分も存在します。

### Sample Explanation 5

!\[A\_img5\](https://arc051.contest.atcoder.jp/img/arc/051/tonarinokyakuhayokukakikuukyakuda/axis5.png)

## 样例 #1

### 输入

```
-1 -1 2

2 3 4 5
```

### 输出

```
YES

YES
```

## 样例 #2

### 输入

```
0 1 1

-2 0 4 3
```

### 输出

```
NO

YES
```

## 样例 #3

### 输入

```
0 0 5

-2 -2 2 1
```

### 输出

```
YES

NO
```

## 样例 #4

### 输入

```
0 0 2

0 0 4 4
```

### 输出

```
YES

YES
```

## 样例 #5

### 输入

```
0 0 5

-4 -4 4 4
```

### 输出

```
YES

YES
```



---

---
title: "[ARC053A] ドミノ色塗り"
layout: "post"
diff: 普及-
pid: AT_arc053_a
tag: []
---

# [ARC053A] ドミノ色塗り

## 题目描述

[problemUrl]: https://atcoder.jp/contests/arc053/tasks/arc053_a





---

---
title: "[ARC056A] みんなでワイワイみかん"
layout: "post"
diff: 普及-
pid: AT_arc056_a
tag: []
---

# [ARC056A] みんなでワイワイみかん

## 题目描述

[problemUrl]: https://atcoder.jp/contests/arc056/tasks/arc056_a

高橋くん一家では今シーズンの果物がみかんに決まり、$ K $個のみかんを買うことが決まりました。 みかんは$ 1 $個$ A $円、さらに$ L $個のセットで$ B $円で売っています。 $ 1 $個のみかんと$ L $個のセットをそれぞれいくつか買い、合計で$ K $個以上のみかんを買うとき、払うお金の最小値を求めるプログラムを書いてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ A $ $ B $ $ K $ $ L $

## 输出格式

$ 1 $行目に、少なくとも$ K $個のみかんを買うために必要なお金を出力せよ。

## 说明/提示

### 制約

- $ 1\ ≦\ A,\ B,\ K\ ≦\ 10^9 $
- $ 2\ ≦\ L\ ≦\ 10^9 $
- $ B\ ≦\ A*L $

### Sample Explanation 1

$ 3 $個のセットを$ 3 $つ、$ 1 $個のみかんを$ 1 $つ買うと合計$ 24 $円となる。これより安く$ 10 $個のみかんを買う方法はない。

### Sample Explanation 2

$ 3 $個のセットを$ 4 $つ買うのが最適である。

## 样例 #1

### 输入

```
3 7 10 3
```

### 输出

```
24
```

## 样例 #2

### 输入

```
4 5 11 3
```

### 输出

```
20
```

## 样例 #3

### 输入

```
3 8 3 3
```

### 输出

```
8
```

## 样例 #4

### 输入

```
3 8 2 3
```

### 输出

```
6
```



---

---
title: "[ARC058C] こだわり者いろはちゃん"
layout: "post"
diff: 普及-
pid: AT_arc058_a
tag: []
---

# [ARC058C] こだわり者いろはちゃん

## 题目描述

[problemUrl]: https://atcoder.jp/contests/arc058/tasks/arc058_a

いろはちゃんはこだわりもので、嫌いな数字が $ K $ 個あり、それぞれ $ D_1,\ D_2,\ ...,\ D_K $ です。

いろはちゃんはお店でお買い物をしていて、 $ N $ 円の品物を買おうとしています。 もちろん、この品物は $ N $ 円以上のお金を支払えば買うことができます。 しかし、先ほど述べたようにいろはちゃんは強いこだわりがあるので、自分がお店に支払う金額の $ 10 $ 進表記にいろはちゃんの嫌いな数字が出現しないような最も少ない金額を支払おうとします。

いろはちゃんが支払う金額を求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ K $ $ D_1 $ $ D_2 $ … $ D_K $

## 输出格式

いろはちゃんが支払う金額を出力せよ。

## 说明/提示

### 制約

- $ 1\ ≦\ N\ <\ 10000 $
- $ 1\ ≦\ K\ <\ 10 $
- $ 0\ ≦\ D_1\ <\ D_2\ <\ …\ <\ D_K≦9 $
- $ \{D_1,D_2,...,D_K\}\ ≠\ \{1,2,3,4,5,6,7,8,9\} $

### Sample Explanation 1

嫌いでない数字は $ 0 $ と $ 2 $ のみです。 $ N=1000 $ 以上の整数で、桁に $ 0 $ と $ 2 $ のみが含まれる最小の整数は $ 2000 $ なのでそれを出力してください。

## 样例 #1

### 输入

```
1000 8

1 3 4 5 6 7 8 9
```

### 输出

```
2000
```

## 样例 #2

### 输入

```
9999 1

0
```

### 输出

```
9999
```



---

---
title: "[ARC059C] いっしょ"
layout: "post"
diff: 普及-
pid: AT_arc059_a
tag: []
---

# [ARC059C] いっしょ

## 题目描述

[problemUrl]: https://atcoder.jp/contests/arc059/tasks/arc059_a

$ N $ 個の整数 $ a_1,a_2,..,a_N $ が与えられます。えび君はこれらを書き換えて全て同じ**整数**にしようとしています。各$ a_i\ (1≦i≦N) $は高々一回しか書き換えられません(書き換えなくても良い)。整数$ x $を整数$ y $に書き換えるとき、コストが$ (x-y)^2 $かかります。仮に$ a_i=a_j\ (i≠j) $だとしても、ひとつ分のコストで同時に書き換えることは出来ません(入出力例$ 2 $ を参照)。えび君が目的を達成するのに必要なコストの総和の最小値を求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ a_1 $ $ a_2 $ ... $ a_N $

## 输出格式

えび君が全てを同じ整数に書き換えるのに必要なコストの総和の最小値を出力せよ。

## 说明/提示

### 制約

- $ 1≦N≦100 $
- $ -100≦a_i≦100 $

### Sample Explanation 1

全てを$ 6 $に書き換えると、コストの総和は$ (4-6)^2+(8-6)^2=8 $となり、これが最小です。

### Sample Explanation 2

全てを$ 2 $に書き換えると$ (1-2)^2+(1-2)^2+(3-2)^2=3 $となります。各$ a_i $ごとに書き換えるので、二つの$ 1 $を一度にコスト$ (1-2)^2 $で書き換えられるわけではないことに注意してください。

### Sample Explanation 3

$ 4 $は書き換えずに、$ 2 $と$ 5 $を共に$ 4 $に書き換えることで$ (2-4)^2+(5-4)^2=5 $が達成できて、これが最小です。

### Sample Explanation 4

何も書き換えなくともえび君は目的を達成しています。よってこの場合コストは$ 0 $です。

## 样例 #1

### 输入

```
2

4 8
```

### 输出

```
8
```

## 样例 #2

### 输入

```
3

1 1 3
```

### 输出

```
3
```

## 样例 #3

### 输入

```
3

4 2 5
```

### 输出

```
5
```

## 样例 #4

### 输入

```
4

-100 -100 -100 -100
```

### 输出

```
0
```



---

---
title: "[ABC052C] Factors of Factorial"
layout: "post"
diff: 普及-
pid: AT_arc067_a
tag: []
---

# [ABC052C] Factors of Factorial

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc052/tasks/arc067_a

整数 $ N $ が与えられます。 $ N! $ の正の約数の個数を $ 10^9+7 $ で割った余りを求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $

## 输出格式

$ N! $ の正の約数の個数を $ 10^9+7 $ で割った余りを出力せよ。

## 说明/提示

### 制約

- $ 1≦N≦10^3 $

### Sample Explanation 1

$ 3! $ $ =6 $ です。$ 6 $ の正の約数は $ 1,2,3,6 $ の $ 4 $ 個なので、$ 4 $ を出力します。

## 样例 #1

### 输入

```
3
```

### 输出

```
4
```

## 样例 #2

### 输入

```
6
```

### 输出

```
30
```

## 样例 #3

### 输入

```
1000
```

### 输出

```
972926972
```



---

---
title: "[ABC053C] X: Yet Another Die Game"
layout: "post"
diff: 普及-
pid: AT_arc068_a
tag: []
---

# [ABC053C] X: Yet Another Die Game

## 题目描述

一个骰子，初始的时候任意的一个面朝上，接下来每一轮可以翻转骰子到相邻的一面，并获得此面的得分（那一面的数值即是得分）。问至少要几轮才可以获得够 $x$ 分。



**注**：所有数均在$longlong$范围内。

## 输入格式

一个数 $x$ 。

## 输出格式

输出也是一个数，即最少的轮数。

## 样例 #1

### 输入

```
7
```

### 输出

```
2
```

## 样例 #2

### 输入

```
149696127901
```

### 输出

```
27217477801
```



---

---
title: "[ABC053D] Card Eater"
layout: "post"
diff: 普及-
pid: AT_arc068_b
tag: []
---

# [ABC053D] Card Eater

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc053/tasks/arc068_b

すぬけくんはカードゲームで遊ぶことにしました。 $ N $ 枚からなるカードの山があり、上から $ i $ 枚目のカードには整数 $ A_i $ が書かれています。

すぬけくんはこのカードの山に対し $ 0 $ 回以上、以下の操作を行い、残ったカードに書かれた値が互いに異なるようにしたいです。最大で何枚のカードを残すことが可能か求めなさい。なお、$ N $ は奇数であり、少なくとも $ 1 $ 枚のカードを残すことが可能であることが保証されます。

操作：カードの山から任意の $ 3 $ 枚のカードを抜き出す。抜き出したカードのうち書かれた値が最大であるようなカード $ 1 $ 枚と最小であるようなカード $ 1 $ 枚の合計 $ 2 $ 枚を選んで食べる。その後残った $ 1 $ 枚をカードの山に戻す。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ A_1 $ $ A_2 $ $ A_3 $ ... $ A_{N} $

## 输出格式

答えを出力せよ。

## 说明/提示

### 制約

- $ 3\ ≦\ N\ ≦\ 10^{5} $
- $ N $ は奇数
- $ 1\ ≦\ A_i\ ≦\ 10^{5} $
- $ A_i $ は整数

### Sample Explanation 1

操作を $ 1 $ 回行って $ 1,1,2 $ を取り出すというのが最適な操作手順の $ 1 $ つです。最大値である $ 2 $ と書かれたカードで最小値である $ 1 $ と書かれたカードがそれぞれ $ 1 $ 枚ずつ食べられ、残った $ 1 $ と書かれたカードがカードの山に戻されます。カードの山に残っているカードは $ 1,3,7 $ となり、これらは互いに異なります。

## 样例 #1

### 输入

```
5

1 2 1 3 7
```

### 输出

```
3
```

## 样例 #2

### 输入

```
15

1 3 5 2 1 3 2 8 8 6 2 6 11 1 1
```

### 输出

```
7
```



---

---
title: "[ABC056C] Go Home"
layout: "post"
diff: 普及-
pid: AT_arc070_a
tag: []
---

# [ABC056C] Go Home

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc056/tasks/arc070_a

無限に左右に伸びている数直線上の $ 0 $ の地点に時刻 $ 0 $ にカンガルーがいます。 カンガルーは時刻 $ i-1 $ から $ i $ にかけて、なにもしないか、もしくは長さがちょうど $ i $ のジャンプを、左右どちらかの方向を選んで行えます。 つまり、時刻 $ i-1 $ に座標 $ x $ にいたとすると、時刻 $ i $ には $ x-i $, $ x $, $ x+i $ のどれかに存在することが出来ます。 カンガルーの家は座標 $ X $ にあります。カンガルーはできるだけ早く座標 $ X $ まで移動しようとしています。 カンガルーが座標 $ X $ に到着する時刻の最小値を求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ X $

## 输出格式

カンガルーが座標 $ X $ に到着する時刻の最小値を出力せよ。

## 说明/提示

### 制約

- $ X $ は整数
- $ 1≦X≦10^9 $

### Sample Explanation 1

$ 3 $ 回右にジャンプすると時刻 $ 3 $ に家にたどり着けて、これが最小です。

### Sample Explanation 2

時刻 $ 0 $ にはなにもせず、時刻 $ 1 $ に右にジャンプすることで時刻 $ 2 $ に家にたどり着けます。

## 样例 #1

### 输入

```
6
```

### 输出

```
3
```

## 样例 #2

### 输入

```
2
```

### 输出

```
2
```

## 样例 #3

### 输入

```
11
```

### 输出

```
5
```



---

---
title: "[ABC060C] Sentou"
layout: "post"
diff: 普及-
pid: AT_arc073_a
tag: []
---

# [ABC060C] Sentou

## 题目描述

在一个公共澡堂里，有一个淋浴器。在按下开关时，淋浴器将会开始运作，在 $T$ 秒内一直流出热水。

如果你在淋浴器运作的情况下时按下开关，水就会从当前时间开始继续运作 $T$ 秒，而不是让淋浴器多运作 $T$ 秒。

在这个淋浴间前，有 $N$ 个人按下开关。第 $i$ 个人在第 $1$ 个人按下开关后的第 $t_i$ 个秒按下开关。请求出淋浴器运作的总时间。

## 输入格式

第一行两个整数 $N$ 和 $T$，分别表示人数和淋浴器连续工作时间。

## 输出格式

一行一个整数，淋浴器运作的总时间。

## 说明/提示

- $ 1\ \leq\ N\ \leq\ 200,000 $
- $ 1\ \leq\ T\ \leq\ 10^9 $
- $ 0\ =\ t_1\ <\ t_2\ <\ t_3\ <\ ,\ ...,\ <\ t_{N-1}\ <\ t_N\ \leq\ 10^9 $
- $ T $ 和 $ t_i $ 都是整数。

## 样例 #1

### 输入

```
2 4

0 3
```

### 输出

```
7
```

## 样例 #2

### 输入

```
2 4

0 5
```

### 输出

```
8
```

## 样例 #3

### 输入

```
4 1000000000

0 1000 1000000 1000000000
```

### 输出

```
2000000000
```

## 样例 #4

### 输入

```
1 1

0
```

### 输出

```
1
```

## 样例 #5

### 输入

```
9 10

0 3 5 7 100 110 200 300 311
```

### 输出

```
67
```



---

---
title: "[ABC063C] Bugged"
layout: "post"
diff: 普及-
pid: AT_arc075_a
tag: []
---

# [ABC063C] Bugged

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc063/tasks/arc075_a

あなたはコンピュータで試験を受けています。試験は $ N $ 問の問題からなり、$ i $ 問目の問題の配点は $ s_i $ です。それぞれの問題に対するあなたの解答は「正解」または「不正解」のいずれかとして判定され、正解した問題の配点の合計があなたの成績となります。あなたが解答を終えると、解答がその場で採点されて成績が表示される…はずでした。

ところが、試験システムに欠陥があり、成績が $ 10 $ の倍数の場合は、画面上で成績が $ 0 $ と表示されてしまいます。それ以外の場合は、画面に正しい成績が表示されます。この状況で、成績として画面に表示されうる最大の値はいくつでしょうか？

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ s_1 $ $ s_2 $ $ : $ $ s_N $

## 输出格式

成績として画面に表示されうる最大の値を出力せよ。

## 说明/提示

### 制約

- 入力値はすべて整数である。
- $ 1\ <\ =\ N\ <\ =\ 100 $
- $ 1\ <\ =\ s_i\ <\ =\ 100 $

### Sample Explanation 1

$ 10 $ 点の問題と $ 15 $ 点の問題に正解し、$ 5 $ 点の問題には正解しないことで成績が $ 25 $ となり、この成績は画面に正しく表示されます。$ 5 $ 点の問題にも正解すると成績が $ 30 $ となりますが、この成績は画面上では $ 0 $ と表示されてしまいます。

### Sample Explanation 2

すべての問題に正解すると成績が $ 35 $ となり、この成績は画面に正しく表示されます。

### Sample Explanation 3

どのような解答状況でも成績は $ 10 $ の倍数となり、画面上では $ 0 $ と表示されてしまいます。

## 样例 #1

### 输入

```
3

5

10

15
```

### 输出

```
25
```

## 样例 #2

### 输入

```
3

10

10

15
```

### 输出

```
35
```

## 样例 #3

### 输入

```
3

10

20

30
```

### 输出

```
0
```



---

---
title: "[ABC068C] Cat Snuke and a Voyage"
layout: "post"
diff: 普及-
pid: AT_arc079_a
tag: []
---

# [ABC068C] Cat Snuke and a Voyage

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc068/tasks/arc079_a

高橋キングダムには、高橋諸島という、$ N $ 個の島からなる諸島があります。 便宜上、これらの島を島 $ 1 $、島 $ 2 $、 ...、島 $ N $ と呼ぶことにします。

これらの諸島の間では、船の定期便が $ M $ 種類運行されています。 定期便はそれぞれ $ 2 $ つの島の間を行き来しており、$ i $ 種類目の定期便を使うと、 島 $ a_i $ と島 $ b_i $ の間を行き来する事ができます。

すぬけくんは今島 $ 1 $ にいて、島 $ N $ に行きたいと思っています。 しかし、島 $ 1 $ から島 $ N $ への定期便は存在しないことがわかりました。 なので、定期便を $ 2 $ つ使うことで、島 $ N $ に行けるか調べたいと思っています。

これを代わりに調べてあげてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ M $ $ a_1 $ $ b_1 $ $ a_2 $ $ b_2 $ : $ a_M $ $ b_M $

## 输出格式

定期便を $ 2 $ つ使いたどり着けるならば `POSSIBLE`、たどり着けないならば `IMPOSSIBLE` と出力する。

## 说明/提示

### 制約

- $ 3\ ≦\ N\ ≦\ 200,000 $
- $ 1\ ≦\ M\ ≦\ 200,000 $
- $ 1\ ≦\ a_i\ <\ b_i\ ≦\ N $
- $ (a_i,\ b_i)\ \neq\ (1,\ N) $
- $ i\ \neq\ j $ ならば $ (a_i,\ b_i)\ \neq\ (a_j,\ b_j) $

### Sample Explanation 2

島 $ 4 $ へ行くには、定期便を $ 3 $ つ使う必要があります。

### Sample Explanation 4

島 $ 1 $、島 $ 4 $、島 $ 5 $ と移動すれば $ 2 $ つの定期便で移動可能です。

## 样例 #1

### 输入

```
3 2

1 2

2 3
```

### 输出

```
POSSIBLE
```

## 样例 #2

### 输入

```
4 3

1 2

2 3

3 4
```

### 输出

```
IMPOSSIBLE
```

## 样例 #3

### 输入

```
100000 1

1 99999
```

### 输出

```
IMPOSSIBLE
```

## 样例 #4

### 输入

```
5 5

1 3

4 5

2 3

2 4

1 4
```

### 输出

```
POSSIBLE
```



---

---
title: "[ABC071C] Make a Rectangle"
layout: "post"
diff: 普及-
pid: AT_arc081_a
tag: []
---

# [ABC071C] Make a Rectangle

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc071/tasks/arc081_a

太さが無視できる棒が $ N $ 本あります． $ i $ 番目の棒の長さは $ A_i $ です．

すぬけ君は，これらの棒から $ 4 $ 本の異なる棒を選び，それらの棒を辺として長方形（正方形を含む）を作りたいです． 作ることができる最大の長方形の面積を求めてください．

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ A_1 $ $ A_2 $ ... $ A_N $

## 输出格式

すぬけ君が作ることのできる最大の長方形の面積を出力せよ． ただし，長方形を作れない場合は，$ 0 $ を出力せよ．

## 说明/提示

### 制約

- $ 4\ \leq\ N\ \leq\ 10^5 $
- $ 1\ \leq\ A_i\ \leq\ 10^9 $
- $ A_i $ は整数

### Sample Explanation 1

$ 1\ \times\ 2 $ の長方形を作ることができます．

### Sample Explanation 2

長方形を作ることはできません．

## 样例 #1

### 输入

```
6

3 1 2 4 2 1
```

### 输出

```
2
```

## 样例 #2

### 输入

```
4

1 2 3 4
```

### 输出

```
0
```

## 样例 #3

### 输入

```
10

3 3 3 3 4 4 4 5 5 5
```

### 输出

```
20
```



---

---
title: "[ABC072C] Together"
layout: "post"
diff: 普及-
pid: AT_arc082_a
tag: []
---

# [ABC072C] Together

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc072/tasks/arc082_a

長さ $ N $ の整数列 $ a_1,a_2,...,a_N $ が与えられます。

各 $ 1\ <\ =i\ <\ =N $ に対し、$ a_i $ に $ 1 $ 足すか、$ 1 $ 引くか、なにもしないかの三つの操作からどれか一つを選んで行います。

この操作の後、ある整数 $ X $ を選んで、$ a_i=X $ となる $ i $ の個数を数えます。

うまく操作を行い、$ X $ を選ぶことで、この個数を最大化してください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ a_1 $ $ a_2 $ .. $ a_N $

## 输出格式

うまく操作を行い、$ X $ を選んだ時の $ a_i=X $ なる $ i $ の個数の最大値を出力せよ。

## 说明/提示

### 制約

- $ 1\ <\ =N\ <\ =10^5 $
- $ 0\ <\ =a_i\ <\ 10^5\ (1\ <\ =i\ <\ =N) $
- $ a_i $ は整数

### Sample Explanation 1

例えば操作後の数列を $ 2,2,3,2,6,9,2 $ とすることができて、$ X=2 $ とすると $ 4 $ を得ることができ、これが最大です。

## 样例 #1

### 输入

```
7

3 1 4 1 5 9 2
```

### 输出

```
4
```

## 样例 #2

### 输入

```
10

0 1 2 3 4 5 6 7 8 9
```

### 输出

```
3
```

## 样例 #3

### 输入

```
1

99999
```

### 输出

```
1
```



---

---
title: "[ABC072D] Derangement"
layout: "post"
diff: 普及-
pid: AT_arc082_b
tag: []
---

# [ABC072D] Derangement

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc072/tasks/arc082_b

$ 1,2,..,N $ からなる順列 $ p_1,p_2,..,p_N $ が与えられます。 次の操作を何回か ($ 0 $回でもよい) 行うことが出来ます。

操作: 順列で**隣り合う**二つの数を選んでスワップする。

何回か操作を行って、任意の $ 1\ <\ =i\ <\ =N $ に対して $ p_i\ ≠\ i $ となるようにしたいです。 必要な操作の最小回数を求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ p_1 $ $ p_2 $ .. $ p_N $

## 输出格式

必要な操作の最小回数を出力せよ。

## 说明/提示

### 制約

- $ 2\ <\ =N\ <\ =10^5 $
- $ p_1,p_2,..,p_N $ は $ 1,2,..,N $ の順列である。

### Sample Explanation 1

$ 1 $ と $ 4 $ を入れ替え、その後 $ 1 $ と $ 3 $ を入れ替えることで $ p $ は $ 4,3,1,5,2 $ となり、これは条件を満たします。 これが最小回数なので、答えは $ 2 $ となります。

### Sample Explanation 2

$ 1 $ と $ 2 $ を入れ替えれば条件を満たします。

### Sample Explanation 3

初めから条件を満たしています。

## 样例 #1

### 输入

```
5

1 4 3 5 2
```

### 输出

```
2
```

## 样例 #2

### 输入

```
2

1 2
```

### 输出

```
1
```

## 样例 #3

### 输入

```
2

2 1
```

### 输出

```
0
```

## 样例 #4

### 输入

```
9

1 2 4 9 5 8 7 3 6
```

### 输出

```
3
```



---

---
title: "[ABC077C] Snuke Festival"
layout: "post"
diff: 普及-
pid: AT_arc084_a
tag: []
---

# [ABC077C] Snuke Festival

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc077/tasks/arc084_a

今年もすぬけ祭の季節がやってきました。りんごさんは、まず手始めにすぬけ君召喚の儀式を執り行おうと思っています。 儀式には祭壇が必要で、祭壇は上部、中部、下部の $ 3 $ つのカテゴリーのパーツ $ 1 $ つずつからなります。

祭壇の $ 3 $ カテゴリーのパーツがそれぞれ $ N $ 個ずつあります。 $ i $ 個目の上部のパーツのサイズは $ A_i $ 、$ i $ 個目の中部のパーツのサイズは $ B_i $ 、$ i $ 個目の下部のパーツのサイズは $ C_i $ です。

祭壇を作るにあたっては、中部のパーツのサイズは上部のパーツのサイズより真に大きく、下部のパーツのサイズは中部のパーツのサイズより 真に大きくなければなりません。逆に、この条件を満たす任意の $ 3 $ つのピースを組み合わせて祭壇を作ることができます。

りんごさんが作ることのできる祭壇は何種類あるでしょうか。ただし、$ 2 $ つの祭壇が異なるとは、上部、中部、下部に使われるピースのうち 少なくとも $ 1 $ つが異なることを言います。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ A_1 $ $ ... $ $ A_N $ $ B_1 $ $ ... $ $ B_N $ $ C_1 $ $ ... $ $ C_N $

## 输出格式

りんごさんが作ることのできる祭壇の種類数を出力せよ。

## 说明/提示

### 制約

- $ 1\ \leq\ N\ \leq\ 10^5 $
- $ 1\ \leq\ A_i\ \leq\ 10^9(1\leq\ i\leq\ N) $
- $ 1\ \leq\ B_i\ \leq\ 10^9(1\leq\ i\leq\ N) $
- $ 1\ \leq\ C_i\ \leq\ 10^9(1\leq\ i\leq\ N) $
- 入力は全て整数である

### Sample Explanation 1

次の $ 3 $ 種類の祭壇があります。 - 上部に $ 1 $ 個目、中部に $ 1 $ 個目、下部に $ 1 $ 個目のパーツを使った祭壇 - 上部に $ 1 $ 個目、中部に $ 1 $ 個目、下部に $ 2 $ 個目のパーツを使った祭壇 - 上部に $ 1 $ 個目、中部に $ 2 $ 個目、下部に $ 2 $ 個目のパーツを使った祭壇

## 样例 #1

### 输入

```
2

1 5

2 4

3 6
```

### 输出

```
3
```

## 样例 #2

### 输入

```
3

1 1 1

2 2 2

3 3 3
```

### 输出

```
27
```

## 样例 #3

### 输入

```
6

3 14 159 2 6 53

58 9 79 323 84 6

2643 383 2 79 50 288
```

### 输出

```
87
```



---

---
title: "[ABC078C] HSI"
layout: "post"
diff: 普及-
pid: AT_arc085_a
tag: []
---

# [ABC078C] HSI

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc078/tasks/arc085_a

高橋くんはプログラミングコンテストに出ていますが， `YES` か `NO` で答える問題でTLEしてしまいました。

提出の詳細を見ると，テストケースは全てで $ N $ ケースあり，そのうち $ M $ ケースでTLEしていました。

そこで高橋くんは, $ M $ ケースではそれぞれ実行に $ 1900 $ ms かかって $ 1/2 $ の確率で正解し， 残りの $ N-M $ ケースではそれぞれ実行に $ 100 $ ms かかって必ず正解するプログラムへ書き換えました。

そして，以下の操作を行います。

- このプログラムを提出する。
- 全てのケースの実行が終わるまで待機する。
- もし $ M $ ケースのうちどれかで不正解だった場合，もう一度プログラムを提出する。
- これを，一度で全てのケースに正解するまで繰り返す。

この操作が終了するまでの，プログラムの実行時間の総和の期待値を $ X $ msとした時，$ X $ を出力してください。

なお，$ X $ は整数で出力してください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ M $

## 输出格式

実行時間の総和の期待値 $ X $ を整数で出力してください。 なお，$ X $ はこの問題の制約下で，$ 10^9 $ 以下の整数となることが証明できます。

## 说明/提示

### 制約

- 入力は全て整数
- $ 1\ \leq\ N\ \leq\ 100 $
- $ 1\ \leq\ M\ \leq\ {\rm\ min}(N,\ 5) $

### Sample Explanation 1

この入力だとケースは $ 1 $ ケースだけであり，$ 1900 $ ms かかって $ 1/2 $ の確率で正解するプログラムを投げ続けます。 つまり $ 1 $ 回で正解する確率は $ 1/2 $, $ 2 $ 回で正解する確率は $ 1/4 $, $ 3 $ 回で正解する確率は $ 1/8 $ です。 よって答えは $ 1900\ \times\ 1/2\ +\ (2\ \times\ 1900)\ \times\ 1/4\ +\ (3\ \times\ 1900)\ \times\ 1/8\ +\ ...\ =\ 3800 $ です。

### Sample Explanation 2

$ 2 $ ケースで $ 1900 $ ms かかり，$ 10-2=8 $ ケースで $ 100 $ ms かかるプログラムを投げ続けます。 全てのケースで正解する確率は $ 1/2\ \times\ 1/2\ =\ 1/4 $ です。

## 样例 #1

### 输入

```
1 1
```

### 输出

```
3800
```

## 样例 #2

### 输入

```
10 2
```

### 输出

```
18400
```

## 样例 #3

### 输入

```
100 5
```

### 输出

```
608000
```



---

---
title: "[ABC087C] Candies"
layout: "post"
diff: 普及-
pid: AT_arc090_a
tag: []
---

# [ABC087C] Candies

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc087/tasks/arc090_a

$ 2\ \times\ N $ のマス目があります。上から $ i $ 行目、左から $ j $ 列目 ($ 1\ \leq\ i\ \leq\ 2 $, $ 1\ \leq\ j\ \leq\ N $) のマスをマス $ (i,\ j) $ と表すことにします。

あなたははじめ、左上のマス $ (1,\ 1) $ にいます。 あなたは、右方向または下方向への移動を繰り返し、右下のマス $ (2,\ N) $ に移動しようとしています。

マス $ (i,\ j) $ には $ A_{i,\ j} $ 個のアメが置かれています。 あなたは移動中に通ったマスに置いてあるアメをすべて回収します。 左上および右下のマスにもアメが置かれており、あなたはこれらのマスに置かれているアメも回収します。

移動方法をうまく選んだとき、最大で何個のアメを回収できるでしょうか。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ A_{1,\ 1} $ $ A_{1,\ 2} $ $ ... $ $ A_{1,\ N} $ $ A_{2,\ 1} $ $ A_{2,\ 2} $ $ ... $ $ A_{2,\ N} $

## 输出格式

回収できるアメの個数の最大値を出力せよ。

## 说明/提示

### 制約

- $ 1\ \leq\ N\ \leq\ 100 $
- $ 1\ \leq\ A_{i,\ j}\ \leq\ 100 $ ($ 1\ \leq\ i\ \leq\ 2 $, $ 1\ \leq\ j\ \leq\ N $)

### Sample Explanation 1

以下のように移動するとき、回収できるアメの個数が最大となります。 - まず右に $ 3 $ 回移動する。その後下に $ 1 $ 回移動し、さらに右に $ 1 $ 回移動する。

### Sample Explanation 2

どのように移動しても回収できるアメの個数は同じになります。

## 样例 #1

### 输入

```
5

3 2 2 4 1

1 2 2 2 1
```

### 输出

```
14
```

## 样例 #2

### 输入

```
4

1 1 1 1

1 1 1 1
```

### 输出

```
5
```

## 样例 #3

### 输入

```
7

3 3 4 5 4 5 3

5 3 4 4 2 3 2
```

### 输出

```
29
```

## 样例 #4

### 输入

```
1

2

3
```

### 输出

```
5
```



---

---
title: "[ABC090C] Flip,Flip, and Flip......"
layout: "post"
diff: 普及-
pid: AT_arc091_a
tag: []
---

# [ABC090C] Flip,Flip, and Flip......

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc090/tasks/arc091_a

縦横に無限に広がるマス目があり、そのうちの連続する $ N $ 行 $ M $ 列の領域のすべてのマスに表裏の区別できるカードが置かれています。 最初はすべてのカードが表を向いています。

以下の操作を、カードが置かれている全てのマスについて $ 1 $ 度ずつ行います。

- そのマスと辺または点で接する $ 8 $ つのマスと、そのマスの合計 $ 9 $ マスについて、カードが存在するなら裏返す。

すべての操作を行った後の各カードの状態は操作を行う順番に依らないことが証明できます。 すべての操作を行った後、裏を向いているカードの枚数を求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ M $

## 输出格式

すべての操作を行った後、裏を向いているカードの枚数を出力せよ。

## 说明/提示

### 制約

- $ 1\ \leq\ N,M\ \leq\ 10^9 $
- 入力は全て整数である

### Sample Explanation 1

$ 4 $ 回の操作のうちのどの操作でも、すべてのカードを裏返します。よって、すべての操作を行った後は、すべてのカードが表を向いています。

### Sample Explanation 2

すべての操作を行った後は、両端以外のカードが裏を向いています。

## 样例 #1

### 输入

```
2 2
```

### 输出

```
0
```

## 样例 #2

### 输入

```
1 7
```

### 输出

```
5
```

## 样例 #3

### 输入

```
314 1592
```

### 输出

```
496080
```



---

---
title: "[ABC092C] Traveling Plan"
layout: "post"
diff: 普及-
pid: AT_arc093_a
tag: []
---

# [ABC092C] Traveling Plan

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc092/tasks/arc093_a

$ x $ 軸上に $ N $ 個の観光スポットがあり、$ 1,\ 2,\ ...,\ N $ の番号がついています。 観光スポット $ i $ は座標 $ A_i $ の点にあります。 また、$ x $ 軸上を座標 $ a $ の点から座標 $ b $ の点まで移動するには $ |a\ -\ b| $ 円かかります。

あなたは $ x $ 軸上を旅行する計画を立てました。 計画では、最初に座標 $ 0 $ の点を出発し、$ N $ 個の観光スポットを番号順に訪れ、最後に座標 $ 0 $ の点に戻ってくることになっています。

ところが、旅行の直前に急用が入り、$ N $ 個すべての観光スポットを訪れる時間的余裕がなくなってしまいました。 そこで、ある $ i $ を選び、観光スポット $ i $ を訪れるのを取りやめることにしました。 それ以外の観光スポットは予定通り番号順に訪れます。 また、最初に座標 $ 0 $ の点を出発し、最後に座標 $ 0 $ の点に戻ってくることについても、予定に変更はありません。

$ i\ =\ 1,\ 2,\ ...,\ N $ それぞれについて、観光スポット $ i $ を訪れるのを取りやめたときの、旅行中の移動にかかる金額の総和を求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ A_1 $ $ A_2 $ $ ... $ $ A_N $

## 输出格式

$ N $ 行出力せよ。 このうち $ i $ 行目には、観光スポット $ i $ を訪れるのを取りやめたときの、旅行中の移動にかかる金額の総和を出力せよ。

## 说明/提示

### 制約

- $ 2\ \leq\ N\ \leq\ 10^5 $
- $ -5000\ \leq\ A_i\ \leq\ 5000 $ ($ 1\ \leq\ i\ \leq\ N $)
- 入力値はすべて整数である。

### Sample Explanation 1

観光スポット $ 1,\ 2,\ 3 $ はそれぞれ座標 $ 3,\ 5,\ -1 $ の点にあります。 各 $ i $ について、観光スポット $ i $ を訪れるのを取りやめた場合の移動経路および移動にかかる金額は以下のようになります。 - $ i\ =\ 1 $ のとき、移動経路は $ 0\ \rightarrow\ 5\ \rightarrow\ -1\ \rightarrow\ 0 $ となり、移動にかかる金額は $ 5\ +\ 6\ +\ 1\ =\ 12 $ 円となります。 - $ i\ =\ 2 $ のとき、移動経路は $ 0\ \rightarrow\ 3\ \rightarrow\ -1\ \rightarrow\ 0 $ となり、移動にかかる金額は $ 3\ +\ 4\ +\ 1\ =\ 8 $ 円となります。 - $ i\ =\ 3 $ のとき、移動経路は $ 0\ \rightarrow\ 3\ \rightarrow\ 5\ \rightarrow\ 0 $ となり、移動にかかる金額は $ 3\ +\ 2\ +\ 5\ =\ 10 $ 円となります。

## 样例 #1

### 输入

```
3

3 5 -1
```

### 输出

```
12

8

10
```

## 样例 #2

### 输入

```
5

1 1 1 2 0
```

### 输出

```
4

4

4

2

4
```

## 样例 #3

### 输入

```
6

-679 -2409 -3258 3095 -3291 -4462
```

### 输出

```
21630

21630

19932

8924

21630

19288
```



---

---
title: "[ABC093C] Same Integers"
layout: "post"
diff: 普及-
pid: AT_arc094_a
tag: []
---

# [ABC093C] Same Integers

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc093/tasks/arc094_a

$ 3 $ つの整数 $ A,B,C $ が与えられます。以下の $ 2 $ 種類の操作を好きな順で繰り返して $ A,B,C $ をすべて等しくするために必要な操作の最小回数を求めてください。

- $ A,B,C $ のうち $ 2 $ つを選んで、その両方を $ 1 $ 増やす
- $ A,B,C $ のうち $ 1 $ つを選んで、その整数を $ 2 $ 増やす

なお、これらの操作を繰り返して $ A,B,C $ をすべて等しくできることは証明できます。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ A $ $ B $ $ C $

## 输出格式

$ A,B,C $ をすべて等しくするために必要な操作の最小回数を出力せよ。

## 说明/提示

### 制約

- $ 0\ \leq\ A,B,C\ \leq\ 50 $
- 入力はすべて整数である

### Sample Explanation 1

以下の操作で、$ A,B,C $ をすべて等しくできます。 - $ A,C $ を $ 1 $ 増やす。$ A,B,C $ はそれぞれ $ 3,5,5 $ となる。 - $ A $ を $ 2 $ 増やす。$ A,B,C $ はそれぞれ $ 5,5,5 $ となる。

## 样例 #1

### 输入

```
2 5 4
```

### 输出

```
2
```

## 样例 #2

### 输入

```
2 6 3
```

### 输出

```
5
```

## 样例 #3

### 输入

```
31 41 5
```

### 输出

```
23
```



---

---
title: "[ABC094C] Many Medians"
layout: "post"
diff: 普及-
pid: AT_arc095_a
tag: []
---

# [ABC094C] Many Medians

## 题目描述

若l是一个奇数，那么l个数的数列的中位数就是数列中第 $\dfrac{l+1}{2}$ 大的数。



输入N个整数，$X$$_{1}$, $X$$_{2}$, ..., $X$$_{N}$ ，保证N为偶数。对于每一个i=1,2, ..., N，输出去掉xi之后数列的中位数$B$$_{i}$。

## 输入格式

两行，第一行为N，第二行为 $X$$_{1}$, $X$$_{2}$, ..., $X$$_{N}$ 。

## 输出格式

N行，第i行表示$B$$_{i}$。



###### 说明/提示

* 2 $\le$ N $\le$ 200000



* N为偶数



* 1 $\le$ $X$$_{i}$ $\le$ 10$^{9}$

## 样例 #1

### 输入

```
4

2 4 4 3
```

### 输出

```
4

3

3

4
```

## 样例 #2

### 输入

```
2

1 2
```

### 输出

```
2

1
```

## 样例 #3

### 输入

```
6

5 5 4 4 3 3
```

### 输出

```
4

4

4

4

4

4
```



---

---
title: "[ABC098C] Attention"
layout: "post"
diff: 普及-
pid: AT_arc098_a
tag: []
---

# [ABC098C] Attention

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc098/tasks/arc098_a

$ N $ 人の人が東西方向に一列に並んでいます。 それぞれの人は、東または西を向いています。 誰がどの方向を向いているかは長さ $ N $ の文字列 $ S $ によって与えられます。 西から $ i $ 番目に並んでいる人は、$ S_i\ = $ `E` なら東を、$ S_i\ = $ `W` なら西を向いています。

あなたは、$ N $ 人のうち誰か $ 1 $ 人をリーダーとして任命します。 そして、リーダー以外の全員に、リーダーの方向を向くように命令します。 このとき、リーダーはどちらの方向を向いていても構いません。

並んでいる人は、向く方向を変えるのを嫌っています。 そのためあなたは、向く方向を変える人数が最小になるようにリーダーを選びたいです。 向く方向を変える人数の最小値を求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ S $

## 输出格式

向く方向を変える人数の最小値を出力せよ。

## 说明/提示

### 制約

- $ 2\ \leq\ N\ \leq\ 3\ \times\ 10^5 $
- $ |S|\ =\ N $
- $ S_i $ は `E` または `W` である

### Sample Explanation 1

西から $ 3 $ 番目に並んでいる人をリーダーに任命するとします。 すると、西から $ 1 $ 番目に並んでいる人は東を向かなくてはならないので、向く方向を変える必要があります。 ほかの人は向く方向を変える必要がないので、この場合、向く方向を変える人は $ 1 $ 人になります。 向く方向を変える人を $ 0 $ 人にすることは出来ないので、答えは $ 1 $ になります。

## 样例 #1

### 输入

```
5

WEEWW
```

### 输出

```
1
```

## 样例 #2

### 输入

```
12

WEWEWEEEWWWE
```

### 输出

```
4
```

## 样例 #3

### 输入

```
8

WWWWWEEE
```

### 输出

```
3
```



---

---
title: "[ABC102C] Linear Approximation"
layout: "post"
diff: 普及-
pid: AT_arc100_a
tag: []
---

# [ABC102C] Linear Approximation

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc102/tasks/arc100_a

すぬけ君は、長さ $ N $ の整数列 $ A $ を持っています。

すぬけ君は、整数 $ b $ を自由に選びます。 この時、$ A_i $ と $ b+i $ が離れているとすぬけ君は悲しいです。 より具体的には、すぬけ君の悲しさの値は、次の式で計算されます。 なおここで、$ abs(x) $ は $ x $ の絶対値を返す関数です。

- $ abs(A_1\ -\ (b+1))\ +\ abs(A_2\ -\ (b+2))\ +\ ...\ +\ abs(A_N\ -\ (b+N)) $

すぬけ君の悲しさの値の最小値を求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ A_1 $ $ A_2 $ $ ... $ $ A_N $

## 输出格式

すぬけ君の悲しさの値の最小値を出力せよ。

## 说明/提示

### 制約

- $ 1\ \leq\ N\ \leq\ 2\ \times\ 10^5 $
- $ 1\ \leq\ A_i\ \leq\ 10^9 $
- 入力はすべて整数である。

### Sample Explanation 1

$ b=0 $ とすれば、すぬけ君の悲しさの値は、$ abs(2-(0+1))+abs(2-(0+2))+abs(3-(0+3))+abs(5-(0+4))+abs(5-(0+5))=2 $ となります。 $ b $ をどのように選んでも、すぬけ君の悲しさの値を $ 2 $ 未満にすることは出来ないので、答えは $ 2 $ になります。

## 样例 #1

### 输入

```
5

2 2 3 5 5
```

### 输出

```
2
```

## 样例 #2

### 输入

```
9

1 2 3 4 5 6 7 8 9
```

### 输出

```
0
```

## 样例 #3

### 输入

```
6

6 5 4 3 2 1
```

### 输出

```
18
```

## 样例 #4

### 输入

```
7

1 1 1 1 2 3 4
```

### 输出

```
6
```



---

---
title: "[ARC104B] DNA Sequence"
layout: "post"
diff: 普及-
pid: AT_arc104_b
tag: []
---

# [ARC104B] DNA Sequence

## 题目描述

[problemUrl]: https://atcoder.jp/contests/arc104/tasks/arc104_b

`A`, `T`, `C`, `G` から成る長さ $ N $ の文字列 $ S $ があります。

長さの等しい文字列 $ T_1,\ T_2 $ が相補的とは、$ |T_1|\ =\ l $ としたとき、どの $ 1\ \leq\ i\ \leq\ l $ についても $ T_1,\ T_2 $ の $ i $ 文字目の組み合わせが (`A`と`T`), または (`C` と `G`) の組み合わせのいずれかであることを指します。(例えば `A` と `T` の組み合わせのとき、どちらの文字が $ T_1 $ に属してもよいです)

$ S $ の連続する空でない部分文字列 $ T $ であって、次の条件を満たすものの個数を求めてください。

- $ T $ と相補的であるような、$ T $ の文字を並び替えた文字列が存在する。

ただし、文字列として同じであっても $ S $ 内の位置が異なれば違う部分列とみなします。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ S $

## 输出格式

$ S $ の連続する空でない部分文字列 $ T $ であって、条件を満たすものの個数を出力せよ。

## 说明/提示

### 制約

- $ 1\ \leq\ N\ \leq\ 5000 $
- $ S $ は `A`, `T`, `C`, `G` のみから成る

### Sample Explanation 1

次の $ 2 $ つの部分文字列が条件を満たします。 - `GC` ($ 2 $ 文字目から $ 3 $ 文字目) は、これを並び替えた `CG` と相補的です。 - `AGCT` ($ 1 $ 文字目から $ 4 $ 文字目) は、これを並び替えた `TCGA` と相補的です。

### Sample Explanation 2

次の $ 4 $ つの部分文字列が条件を満たします。 - `AT` ($ 1 $ 文字目から $ 2 $ 文字目) は、これを並び替えた `TA` と相補的です。 - `TA` ($ 2 $ 文字目から $ 3 $ 文字目) は、これを並び替えた `AT` と相補的です。 - `AT` ($ 3 $ 文字目から $ 4 $ 文字目) は、これを並び替えた `TA` と相補的です。 - `ATAT` ($ 1 $ 文字目から $ 4 $ 文字目) は、これを並び替えた `TATA` と相補的です。

## 样例 #1

### 输入

```
4 AGCT
```

### 输出

```
2
```

## 样例 #2

### 输入

```
4 ATAT
```

### 输出

```
4
```

## 样例 #3

### 输入

```
10 AAATACCGCG
```

### 输出

```
6
```



---

---
title: "[ARC105B] MAX-=min"
layout: "post"
diff: 普及-
pid: AT_arc105_b
tag: []
---

# [ARC105B] MAX-=min

## 题目描述

你有一张编号为 $1$ 到 $N$ 的 $N$ 张牌。每张卡片上都有一个整数，第 $i$ 张卡片上写有数字 $a_i$ 。

苏努里先生将完成以下程序。

1.  $X$ 表示拥有的卡片上写着的最大值， $x$ 表示最小值。

1. 当 $X = x$ 时结束程序。否则，将所有写有 $X$ 的卡片转换为写有 $X - x$ 的卡片，然后执行第1步。

程序最终保证会结束。结束后，输出你持有的卡片上写着的唯一的数字。

## 输入格式

第一行输入一个整数 $N$ 。

接下来一行输入 $N$ 个整数 $a_i$ 。

## 输出格式

输出你持有的卡片上写着的唯一的数字。

## 说明/提示

#### 限制

 $1 ≤ N ≤ 10^5$ 
 
 $1 ≤ a_i ≤ 10^9$

## 样例 #1

### 输入

```
3

2 6 6
```

### 输出

```
2
```

## 样例 #2

### 输入

```
15

546 3192 1932 630 2100 4116 3906 3234 1302 1806 3528 3780 252 1008 588
```

### 输出

```
42
```



---

---
title: "[ARC107B] Quadruple"
layout: "post"
diff: 普及-
pid: AT_arc107_b
tag: []
---

# [ARC107B] Quadruple

## 题目描述

[problemUrl]: https://atcoder.jp/contests/arc107/tasks/arc107_b

整数 $ N,K $ が与えられます． $ 4 $ つの整数の組 $ (a,b,c,d) $ であって，以下の条件を両方満たすものは何個あるでしょうか．

- $ 1\ \leq\ a,b,c,d\ \leq\ N $
- $ a+b-c-d=K $

## 输入格式

入力は以下の形式で標準入力から与えられる．

> $ N $ $ K $

## 输出格式

答えを出力せよ．

## 说明/提示

### 制約

- $ 1\ \leq\ N\ \leq\ 10^5 $
- $ -2(N-1)\ \leq\ K\ \leq\ 2(N-1) $
- 入力される数はすべて整数．

### Sample Explanation 1

以下の $ 4 $ 通りです． - $ (a,b,c,d)=(2,1,1,1) $ - $ (a,b,c,d)=(1,2,1,1) $ - $ (a,b,c,d)=(2,2,2,1) $ - $ (a,b,c,d)=(2,2,1,2) $

## 样例 #1

### 输入

```
2 1
```

### 输出

```
4
```

## 样例 #2

### 输入

```
2525 -425
```

### 输出

```
10314607400
```



---

---
title: "[ARC108B] Abbreviate Fox"
layout: "post"
diff: 普及-
pid: AT_arc108_b
tag: []
---

# [ARC108B] Abbreviate Fox

## 题目描述

[problemUrl]: https://atcoder.jp/contests/arc108/tasks/arc108_b

長さ $ N $ の英小文字のみからなる文字列 $ s $ が与えられます。 すぬけ君は $ s $ から `fox` という部分文字列を $ 1 $ つ選んで取り除き、その前後の部分を連結する、という操作を何度でも行うことができます。

すぬけ君が操作を何度か行ったあと、$ s $ の長さは最小でいくつになりえますか？

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ s $

## 输出格式

すぬけ君が操作を何度か行ったあとの $ s $ の長さとしてありうる値の最小値を出力せよ。

## 说明/提示

### 制約

- $ 1\ \leq\ N\ \leq\ 2\ \times\ 10^{5} $
- $ s $ は英小文字のみからなる長さ $ N $ の文字列

### Sample Explanation 1

\- `icefox` の末尾 `fox` を取り除くことで $ s $ を `ice` にすることができます。

### Sample Explanation 2

\- `fox` という部分文字列が存在しません。

## 样例 #1

### 输入

```
6

icefox
```

### 输出

```
3
```

## 样例 #2

### 输入

```
7

firebox
```

### 输出

```
7
```

## 样例 #3

### 输入

```
48

ffoxoxuvgjyzmehmopfohrupffoxoxfofofoxffoxoxejffo
```

### 输出

```
27
```



---

---
title: "[ARC109B] log"
layout: "post"
diff: 普及-
pid: AT_arc109_b
tag: []
---

# [ARC109B] log

## 题目描述

[problemUrl]: https://atcoder.jp/contests/arc109/tasks/arc109_b

すぬけ君は、渋谷の丸太やさんに丸太を買いに来ました。 すぬけ君は長さ $ 1 $ から $ n $ までの $ n $ 種類の丸太が $ 1 $ 本ずつほしいです。 丸太やさんには、長さ $ 1 $ から $ n+1 $ までの $ n+1 $ 種類の丸太がそれぞれ $ 1 $ 円で売られています。どの丸太の在庫も $ 1 $ 本ずつしかありません。

すぬけ君は買った丸太を切る作業を好きなだけ行えます。つまり、$ L\ =\ L_1\ +\ \dots\ +\ L_k $ であるとき、長さ $ L $ の丸太 $ 1 $ 本から、長さ $ L_1,\ \dots,\ L_k $ の $ k $ 本の丸太を作る作業を何度でもできます。また、不要な丸太を捨てることができます。

すぬけ君はできるだけ安く丸太を手に入れたいです。 長さ $ 1 $ から $ n $ までの $ n $ 種類の丸太を $ 1 $ 本ずつ手に入れるために必要な最小の金額を求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ n $

## 输出格式

長さ $ 1 $ から $ n $ までの $ n $ 種類の丸太を $ 1 $ 本ずつ手に入れるための最小金額を出力せよ。

## 说明/提示

### 制約

- $ 1\ \leq\ n\ \leq\ 10^{18} $

### Sample Explanation 1

例えば次のようにすると $ 3 $ 円でほしい丸太がすべて手に入ります。 - 長さ $ 2,4,5 $ の丸太を買う - 長さ $ 5 $ の丸太を切って 長さ $ 1 $ の丸太 $ 2 $ 本と長さ $ 3 $ の丸太を作る - 長さ $ 1 $ の丸太を $ 1 $ 本捨てる

## 样例 #1

### 输入

```
4
```

### 输出

```
3
```

## 样例 #2

### 输入

```
109109109109109109
```

### 输出

```
109109108641970782
```



---

---
title: "[ARC110B] Many 110"
layout: "post"
diff: 普及-
pid: AT_arc110_b
tag: []
---

# [ARC110B] Many 110

## 题目描述

[problemUrl]: https://atcoder.jp/contests/arc110/tasks/arc110_b

`110` を $ 10^{10} $ 個連結した文字列を $ S $ とします（たとえば `110` を $ 3 $ 個連結した文字列は `110110110` です）。

長さ $ N $ の文字列 $ T $ があります。

$ S $ に $ T $ が連続する部分文字列としていくつ含まれるかを求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ T $

## 输出格式

$ S $ に $ T $ が連続する部分文字列としていくつ含まれるかを出力せよ。

## 说明/提示

### 制約

- $ 1\ \leq\ N\ \leq\ 2\ \times\ 10^5 $
- $ T $ は `0`, `1` からなる長さ $ N $ の文字列

### Sample Explanation 1

$ S $ は長いので、`110` を $ 3 $ 個連結した `110110110` に `1011` がいくつ含まれるかを考えます。 すると、 - $ 1 $ `1011` $ 0110 $ - $ 1101 $ `1011` $ 0 $ の $ 2 $ 箇所に、`1011` が連続する部分文字列として含まれています。

## 样例 #1

### 输入

```
4

1011
```

### 输出

```
9999999999
```

## 样例 #2

### 输入

```
22

1011011011011011011011
```

### 输出

```
9999999993
```



---

---
title: "[ARC113B] A^B^C"
layout: "post"
diff: 普及-
pid: AT_arc113_b
tag: []
---

# [ARC113B] A^B^C

## 题目描述

这里有 $3$ 个正整数。请求出 $ A^{B^C} $ 的个位。

## 输入格式

按以下格式输入。

> $ A $ $ B $ $ C $

## 输出格式

输出 $ A^{B^C} $ 个位上的数。

### 样例输入 #1

```
4 3 2
```

### 样例输出 #1

```
4
```

## 样例 #2

### 样例输入 #2

```
1 2 3
```

### 样例输出 #2

```
1
```

## 样例 #3

### 样例输入 #3

```
3141592 6535897 9323846
```

### 样例输出 #3

```
2
```

## 说明/提示

- $ 1\leq\ A,B,C\ \leq\ 10^9 $
- $ A,B,C $ 是整数。


$ 4^{3^2}=4^9=262144 $ 的个位是 $ 4 $ 。

## 样例 #1

### 输入

```
4 3 2
```

### 输出

```
4
```

## 样例 #2

### 输入

```
1 2 3
```

### 输出

```
1
```

## 样例 #3

### 输入

```
3141592 6535897 9323846
```

### 输出

```
2
```



---

---
title: "[ARC115A] Two Choices"
layout: "post"
diff: 普及-
pid: AT_arc115_a
tag: []
---

# [ARC115A] Two Choices

## 题目描述

[problemUrl]: https://atcoder.jp/contests/arc115/tasks/arc115_a

$ 0 $ か $ 1 $ で答える問題 $ M $ 問からなるテストがあり、これに $ N $ 人の生徒が取り組みました。 $ N $ 個の長さ $ M $ の文字列 $ S_1,S_2,\ldots,S_N $ が与えられます。 $ S_i $ の $ k $ 文字目は `0` と `1` のいずれかであり、 $ i $ 番目の生徒の $ k $ 問目に対する解答を示しています。各生徒の各問題に対する解答は判明していますが、各問題の正解が $ 0 $ と $ 1 $ のどちらであるかはまだ判明していません。 $ 1\ \leq\ i\ <\ j\ \leq\ N $ を満たす組 $ (i,j) $ であって、生徒 $ i $ と生徒 $ j $ の正解した問題の数が等しい可能性がないようなものはいくつあるか求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ M $ $ S_1 $ $ S_2 $ $ : $ $ S_N $

## 输出格式

答えを出力せよ。

## 说明/提示

### 制約

- $ 2\ \leq\ N\ \leq\ 10^5 $
- $ 1\ \leq\ M\ \leq\ 20 $
- $ S_i $ は `0` と `1` からなる長さ $ M $ の文字列

### Sample Explanation 1

例えば $ 1 $ 問目の正解と $ 2 $ 問目の正解が共に $ 0 $ のとき、生徒 $ 2 $ と生徒 $ 3 $ の正解数は共に $ 1 $ となり等しくなります。一方、生徒 $ 1 $ と生徒 $ 2 $ のペア、生徒 $ 1 $ と生徒 $ 3 $ のペアでは、二人の正解数が等しいことはありません。

## 样例 #1

### 输入

```
3 2

00

01

10
```

### 输出

```
2
```

## 样例 #2

### 输入

```
7 5

10101

00001

00110

11110

00100

11111

10000
```

### 输出

```
10
```



---

---
title: "[ARC117B] ARC Wrecker"
layout: "post"
diff: 普及-
pid: AT_arc117_b
tag: []
---

# [ARC117B] ARC Wrecker

## 题目描述

[problemUrl]: https://atcoder.jp/contests/arc117/tasks/arc117_b

AtCoder 街道には $ N $ 個のビルが建設されています。最初、左から $ i $ 番目のビルは $ A_i $ 階建てです。

ARC 解体業者の社長である高橋君は、以下の操作を好きな回数だけ行うことができます。$ 1 $ 回も操作を行わないことも可能です。

- 好きな正の整数 $ X $ を選び、$ X $ 階の高さから大砲を発射する。そのとき、現時点で $ X $ 階建て以上であるすべてのビルについて、階数が $ 1 $ 減少する。

あり得る最終的なビルの景観の数を $ 10^{9}\ +\ 7 $ で割った余りを求めてください。

ただし、景観 A と景観 B が異なるとは、以下のことを指します。

- 景観 A における、左から $ i $ 番目のビルの高さを $ P_i $ とする。
- 景観 B における、左から $ i $ 番目のビルの高さを $ Q_i $ とする。
- $ P_i\ \neq\ Q_i $ となる $ i $ が $ 1 $ つでも存在する場合、景観 A と景観 B は異なる。

## 输入格式

入力は以下の形式で標準入力から与えられます。

> $ N $ $ A_1 $ $ A_2 $ $ \cdots $ $ A_N $

## 输出格式

答えを出力してください。

## 说明/提示

### 制約

- $ 1\ \leq\ N\ \leq\ 100000 $
- $ 1\ \leq\ A_i\ \leq\ 10^{9} $
- 入力はすべて整数

### Sample Explanation 1

操作後のビルの高さとしてあり得るものは、以下の $ 4 $ 通りです。 - (ビル $ 1 $ の階数, ビル $ 2 $ の階数) = $ (0,\ 0) $ - (ビル $ 1 $ の階数, ビル $ 2 $ の階数) = $ (0,\ 1) $ - (ビル $ 1 $ の階数, ビル $ 2 $ の階数) = $ (1,\ 1) $ - (ビル $ 1 $ の階数, ビル $ 2 $ の階数) = $ (1,\ 2) $

### Sample Explanation 3

全部で $ 20192492160000 $ 通りの景観があり得ますが、それを $ 10^{9}\ +\ 7 $ で割った余りである $ 492018656 $ を出力すると正解になります。

## 样例 #1

### 输入

```
2

1 2
```

### 输出

```
4
```

## 样例 #2

### 输入

```
6

5 3 4 1 5 2
```

### 输出

```
32
```

## 样例 #3

### 输入

```
7

314 159 265 358 979 323 846
```

### 输出

```
492018656
```



---

---
title: "[ARC118A] Tax Included Price"
layout: "post"
diff: 普及-
pid: AT_arc118_a
tag: []
---

# [ARC118A] Tax Included Price

## 题目描述

【题意】

ARC国家的消费税率是 $t$  。其中 $t$ 是正整数。
ARC国家有整数屋。整数屋先生以不含税价格 $A$ 日元处理着各个正整数 $A$，这个含税价格是 $\lfloor\frac{100 + t}{100}A \rfloor$ 日元。但是，对于实数 $x$，$\lfloor x \rfloor$ 表示 $x$ 以下的最大整数。

虽然是经营所有正整数的整数屋，但存在不作为含税价格出现的正整数金额。在这些金额中，请找从小到大的第 $N$ 个。

## 输入格式

共输入一行，

第一行输入 $t$ 和 $N$。

## 输出格式

输出第 $N$ 个金额。

## 说明/提示

- $1 \le t \le 50$
- $1 \le N \le 10^9$

## 样例 #1

### 输入

```
10 1
```

### 输出

```
10
```

## 样例 #2

### 输入

```
3 5
```

### 输出

```
171
```

## 样例 #3

### 输入

```
1 1000000000
```

### 输出

```
100999999999
```



---

---
title: "[ARC121A] 2nd Greatest Distance"
layout: "post"
diff: 普及-
pid: AT_arc121_a
tag: []
---

# [ARC121A] 2nd Greatest Distance

## 题目描述

# [ARC121A] 2nd Greatest Distance


在二维平面上有 $N$ 个使用编号 $1$ 到 $N$ 的数字标记的房子。 房子 $i$ 位于 $(x_i,y_i)$。

房子 $i,j$ 之间的距离是 $\max(\left|{x_i-x_j}\right|, \left|{y_i-y_j}\right|)$。

有总共 $N(N-1)/2$ 对不同的房子，对于每一对不同的房子，计算它们之间的距离，把距离值按降序排列成一个长度为 $N(N-1)/2$ 的数列。请输出这个数列的第二个数字。

## 输入格式

> $N$ $x_{1}$ $y_{1}$ $\ldots$ $x_{N}$ $y_{N}$

## 输出格式

对于每一个样例，输出第二大的数字。

## 说明/提示

### 样例输入 #1

```
3
0 0
1 2
4 0
```

### 样例输出 #1

```
3
```

### 样例输入 #2

```
4
0 0
0 0
1 0
0 1
```

### 样例输出 #2

```
1
```

### 样例输入 #3

```
20
407 361
167 433
756 388
-551 -47
306 -471
36 928
338 -355
911 852
288 70
-961 -769
-668 -386
-690 -378
182 -609
-677 401
-458 -112
184 -131
-243 888
-163 471
-11 997
119 544
```

### 样例输出 #3

```
1766
```



- 所有的输入都保证为整数
- $3 \leqslant N \leqslant 2 \times 10^5$
- $-10^9 \leqslant x_i, y_i \leqslant 10^9$

## 样例 #1

### 输入

```
3

0 0

1 2

4 0
```

### 输出

```
3
```

## 样例 #2

### 输入

```
4

0 0

0 0

1 0

0 1
```

### 输出

```
1
```

## 样例 #3

### 输入

```
20

407 361

167 433

756 388

-551 -47

306 -471

36 928

338 -355

911 852

288 70

-961 -769

-668 -386

-690 -378

182 -609

-677 401

-458 -112

184 -131

-243 888

-163 471

-11 997

119 544
```

### 输出

```
1766
```



---

---
title: "[ARC123B] Increasing Triples"
layout: "post"
diff: 普及-
pid: AT_arc123_b
tag: []
---

# [ARC123B] Increasing Triples

## 题目描述

$ N $ 项组成的整数列 $ A = \ (A _ 1 \ \ldots, \ A_N), \, B = \ (B _ 1 \ \ldots, \ B_N), \, C = \ (C _ 1, \ \ldots, \ C_N) $。

你可以对数列进行排序。输出排序后 $ A_i \ <\ B_i \ <\ C_i $ 中满足 $ i $ 的最多个数。

## 输入格式

输入以以下格式。

> $ N $ 
>
> $ A_1 $ $ A_2 $ $ \ldots $ $ A_N $
>
> $ B_1 $ $ B_2 $ $ \ldots $ $ B_N $
>
> $ C_1 $ $ C_2 $ $ \ldots $ $ C_N $

## 输出格式

输出答案。

## 说明/提示

- $ 1\leq\ N\leq\ 10^5 $
- $ 1\leq\ A_i,\ B_i,\ C_i\leq\ 10^9 $

**样例解释 $1$**

排序如下：-$ A = \ (1,6,8,9,14)$ - $ B = \ (3, 2, 10, 12, 11) $ - $ c = \ (4、7、15、13,5)$ 这个时候 $i$ 最多有 $3$ 个($i = \ 1,\ 3,\ 4 $)对 $ A_i \ <\ B_i \ <\ C_i $ 成立。

## 样例 #1

### 输入

```
5

9 6 14 1 8

2 10 3 12 11

15 13 5 7 4
```

### 输出

```
3
```

## 样例 #2

### 输入

```
1

10

20

30
```

### 输出

```
1
```

## 样例 #3

### 输入

```
3

1 1 1

1 1 2

2 2 2
```

### 输出

```
0
```



---

---
title: "[ARC124A] LR Constraints"
layout: "post"
diff: 普及-
pid: AT_arc124_a
tag: []
---

# [ARC124A] LR Constraints

## 题目描述

[problemUrl]: https://atcoder.jp/contests/arc124/tasks/arc124_a

$ N $ 枚のカードが左から右に並んでいます。 各カードに $ 1 $ 以上 $ K $ 以下の整数を書き込みます。はじめ、どのカードにも整数は書かれていません。

$ 1 $ から $ K $ の番号がついた $ K $ 個の制約が与えられます。 制約 $ i $ は文字 $ c_i $ と整数 $ k_i $ からなります。 $ c_i $ が `L` ならば、$ i $ が書かれたカードのうち最も **左** にあるものは $ N $ 枚のカードのうち左から $ k_i $ 番目である必要があります。$ c_i $ が `R` ならば、$ i $ が書かれたカードのうち最も **右** にあるものは $ N $ 枚のカードのうち左から $ k_i $ 番目である必要があります。

$ 1 $ 以上 $ K $ 以下の各整数 $ i $ について、$ i $ が書かれたカードが少なくとも $ 1 $ つ存在する必要があることに注意してください。

上記の $ K $ 個の制約をすべて満たすようなカードへの整数の書き込み方の個数を $ 998244353 $ で割ったあまりを求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ K $ $ c_1 $ $ k_1 $ $ \vdots $ $ c_K $ $ k_K $

## 输出格式

問題文中の $ K $ 個の制約をすべて満たすようなカードへの整数の書き込み方の個数を $ 998244353 $ で割ったあまりを出力せよ。

## 说明/提示

### 制約

- $ 1\ \leq\ N,K\ \leq\ 1000 $
- $ c_i $ は `L`, `R` のいずれか
- $ 1\ \leq\ k_i\ \leq\ N $
- $ i\ \neq\ j $ ならば $ k_i\ \neq\ k_j $

### Sample Explanation 1

\- 左から $ 1 $ 番目のカードに $ 1 $ を、$ 2 $ 番目のカードに $ 2 $ を、$ 3 $ 番目のカードに $ 1 $ を書き込むのが $ 2 $ つの制約を満たすような唯一の書き込み方です。

### Sample Explanation 2

\- $ 998244353 $ で割ったあまりを求めるのを忘れずに。

## 样例 #1

### 输入

```
3 2

L 1

R 2
```

### 输出

```
1
```

## 样例 #2

### 输入

```
30 10

R 6

R 8

R 7

R 25

L 26

L 13

R 14

L 11

L 23

R 30
```

### 输出

```
343921442
```



---

---
title: "[ARC125A] Dial Up"
layout: "post"
diff: 普及-
pid: AT_arc125_a
tag: []
---

# [ARC125A] Dial Up

## 题目描述

有四个完全由 $0$ 和 $1$ 构成的整数序列 $s,t,a,b$，初始时 $s=a$ 且 $b$ 为空。

每次操作时，你可以选择以下操作之一：

- 将 $a$ 的最后一个数放到开头；
- 将 $a$ 的第一个数放到末尾；
- 在 $b$ 的末尾插入 $a_1$。

请输出能够让 $b=t$ 所需的最少操作次数。若无法达成目的，请输出 $-1$。

## 输入格式

第一行：$s$ 和 $t$ 的长度（$\le 2 \times 10^5$）

第二行：$s$

第三行：$t$

## 输出格式

若目标可实现输出最小操作次数，否则输出 $-1$。

## 样例 #1

### 输入

```
3 4

0 0 1

0 1 1 0
```

### 输出

```
6
```

## 样例 #2

### 输入

```
1 1

0

1
```

### 输出

```
-1
```



---

---
title: "[ARC126A] Make 10"
layout: "post"
diff: 普及-
pid: AT_arc126_a
tag: []
---

# [ARC126A] Make 10

## 题目描述

[problemUrl]: https://atcoder.jp/contests/arc126/tasks/arc126_a

長さが $ 2 $ の棒が $ N_2 $ 個、長さが $ 3 $ の棒が $ N_3 $ 個、長さが $ 4 $ の棒が $ N_4 $ 個あります。あなたは、これらの棒に対して次の操作を何度でも行うことができます：

- $ 2 $ つの棒を選ぶ。
- 選んだ棒の長さが $ x,\ y $ であるとき、これらを接着することで、長さ $ x+y $ の棒を作る。

長さがちょうど $ 10 $ に等しい棒を最大でいくつ作れるかを求めてください。

$ T $ 個のテストケースが与えられるので、それぞれについて答えを求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられます。

> $ T $ $ \text{case}_1 $ $ \text{case}_2 $ $ \vdots $ $ \text{case}_T $

各テストケースは以下の形式で与えられます。

> $ N_2 $ $ N_3 $ $ N_4 $

## 输出格式

$ T $ 行出力してください。$ i $ 行目には、$ \text{case}_i $ に対する答えを出力してください。

## 说明/提示

### 制約

- $ 1\leq\ T\leq\ 100 $
- $ 0\leq\ N_2,\ N_3,\ N_4\leq\ 10^{15} $

### Sample Explanation 1

ひとつめのテストケースについて説明します。 長さ $ 2 $ の棒が $ 3 $ 個、長さ $ 3 $ の棒が $ 4 $ 個、長さ $ 4 $ の棒が $ 1 $ 個あります。 例えば以下のようにして、長さがちょうど $ 10 $ の棒を $ 2 $ 個作ることができます。 - 長さが $ 2 $, $ 2 $, $ 3 $, $ 3 $ の棒を適当な順序で接着することで、長さが $ 10 $ の棒をひとつ作ることができます。 - 長さが $ 3 $, $ 3 $, $ 4 $ の棒を適当な順序で接着することで、長さが $ 10 $ の棒をひとつ作ることができます。 - これらの操作の後、長さが $ 2,\ 10,\ 10 $ の棒が手元に残ります。

## 样例 #1

### 输入

```
5

3 4 1

7 0 0

0 0 7

0 0 0

1000000000000000 1000000000000000 1000000000000000
```

### 输出

```
2

1

0

0

900000000000000
```



---

---
title: "[ARC128A] Gold and Silver"
layout: "post"
diff: 普及-
pid: AT_arc128_a
tag: []
---

# [ARC128A] Gold and Silver

## 题目描述

[problemUrl]: https://atcoder.jp/contests/arc128/tasks/arc128_a

すぬけくんは今，$ 1 $ グラムの金と $ 0 $ グラムの銀を持っています． 彼はこれから $ N $ 日かけて金と銀の取引を行います． それぞれの日で，"なにもしない" もしくは "交換をする" のいずれかの行動をとります． $ i $ 日目 ($ 1\ \leq\ i\ \leq\ N $) に交換をする場合，以下のことが起こります．

- 交換前に金を $ x $ グラム持っていた場合，それらをすべて銀と交換し，$ x\ \times\ A_i $ グラムの銀を得る． 逆に，銀を $ x $ グラム持っていた場合，それらをすべて金と交換し，$ x\ /\ A_i $ グラムの金を得る．

すぬけくんの目標は，最終的に持っている金の量を最大化することです． 彼の目標を達成するような方法を一つ求めてください．

## 输入格式

入力は以下の形式で標準入力から与えられる．

> $ N $ $ A_1 $ $ A_2 $ $ \cdots $ $ A_N $

## 输出格式

答えを以下の形式で出力せよ．

> $ v_1 $ $ v_2 $ $ \cdots $ $ v_N $

ただしここで $ v_i $ は $ i $ 日目の行動を表す整数 ($ 0\ \leq\ v_i\ \leq\ 1 $) であり，$ v_i=0 $ ならば何もしないことを，$ v_i=1 $ ならば交換をすることを表す． なお，答えが複数通り存在する場合，そのどれを出力しても正解とみなされる．

## 说明/提示

### 制約

- $ 2\ \leq\ N\ \leq\ 200000 $
- $ 1\ \leq\ A_i\ \leq\ 10^9 $
- 入力される値はすべて整数である

### Sample Explanation 1

以下のように行動するのが最適です． - $ 1 $ 日目: なにもしない． - $ 2 $ 日目: $ 1 $ グラムの金を銀と交換し，$ 5 $ グラムの銀を得る． - $ 3 $ 日目: $ 5 $ グラムの銀を金と交換し，$ 2.5 $ グラムの金を得る．

### Sample Explanation 2

$ (v_1,v_2,v_3,v_4)=(1,1,1,1) $ なども正解とみなされます．

## 样例 #1

### 输入

```
3

3 5 2
```

### 输出

```
0 1 1
```

## 样例 #2

### 输入

```
4

1 1 1 1
```

### 输出

```
0 0 0 0
```

## 样例 #3

### 输入

```
10

426877385 186049196 624834740 836880476 19698398 709113743 436942115 436942115 436942115 503843678
```

### 输出

```
1 1 0 1 1 1 1 0 0 0
```



---

---
title: "[ARC130B] Colorful Lines"
layout: "post"
diff: 普及-
pid: AT_arc130_b
tag: []
---

# [ARC130B] Colorful Lines

## 题目描述

有一个$H×W$的方格。首先，方格里的格子都没有涂颜色。

你决定对这个格子涂上颜色。可以使用的颜色有$C$种，颜色分别表示为$1$,$2$,$…$,$C$。

有$Q$次上色。

第$i$个上色给出三个整数，分别为$T_{i}$，$N_{i}$，$C_{i}$。表示涂色如下：

- 当$T_{i}=1$时：将第$N_{i}$**行**的格子全部涂上颜色$C_{i}$。
- 当$T_{i}=2$时：将第$N_{i}$**列**的格子全部涂上颜色$C_{i}$。

如果用颜色$C$涂某个格子的话，该格子的颜色无论之前是什么颜色，总是会变成颜色$C$。

当所有涂色完成时，请求出用颜色分别为$1$,$2$,$…$,$C$的格子的个数。

## 输入格式

第一行有四个整数，分别为$H$,$W$,$C$,$Q$。

接下来有$Q$行，每行有三个整数分别为$T_{i}$，$N_{i}$，$C_{i}$。

## 输出格式

输出共一行，有$C$个数。

对于第$i$个数，表示颜色为$i$的格子的个数。

翻译:WAITER

## 样例 #1

### 输入

```
4 5 6 5

1 1 6

1 3 3

2 2 4

2 4 2

1 1 2
```

### 输出

```
0 8 3 3 0 0
```

## 样例 #2

### 输入

```
1000000000 1000000000 3 5

1 1 2

1 2 2

1 3 2

1 4 2

1 5 2
```

### 输出

```
0 5000000000 0
```



---

---
title: "[ARC132A] Permutation Grid"
layout: "post"
diff: 普及-
pid: AT_arc132_a
tag: []
---

# [ARC132A] Permutation Grid

## 题目描述

[problemUrl]: https://atcoder.jp/contests/arc132/tasks/arc132_a

$ 1,\dots,n $ の順列 $ R_1,\dots,R_n $ と $ C_1,\dots,C_n $ が与えられます。

あなたは縦 $ n $ 行、横 $ n $ 列からなるマス目を次の条件を満たすように白か黒で塗ります。

- 各 $ i=1,\dots,n $ について、上から $ i $ 行目の黒マスの数はちょうど $ R_i $ 個
- 各 $ j=1,\dots,n $ について、左から $ j $ 列目の黒マスの数はちょうど $ C_j $ 個

なお、この問題の制約のもとで、条件を満たすような塗り方がちょうど一通り存在することが示せます。

$ q $ 個のクエリ $ (r_1,c_1),\dots,(r_q,c_q) $ が与えられます。 各 $ i=1,\dots,q $ について、上から $ r_i $ 行目、左から $ c_i $ 列目にあるマスの色が黒であれば `#` を、白であれば `.` を出力してください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ n $ $ R_1 $ $ \dots $ $ R_n $ $ C_1 $ $ \dots $ $ C_n $ $ q $ $ r_1 $ $ c_1 $ $ \vdots $ $ r_q $ $ c_q $

## 输出格式

$ i $ 文字目が $ i $ 番目のクエリの答えであるような、`#` と `.` からなる長さ $ q $ の文字列を出力せよ。

## 说明/提示

### 制約

- $ 1\le\ n,q\le\ 10^5 $
- $ R_1,\dots,R_n $ と $ C_1,\dots,C_n $ はそれぞれ $ 1,\dots,n $ の順列
- $ 1\le\ r_i,c_i\ \le\ n $
- 入力はすべて整数

### Sample Explanation 1

次のような塗り方が条件を満たします。 ``` ##### #...# #.#.# ###.# ....# ```

## 样例 #1

### 输入

```
5

5 2 3 4 1

4 2 3 1 5

7

1 5

5 1

1 1

2 2

3 3

4 4

5 5
```

### 输出

```
#.#.#.#
```



---

---
title: "[ARC133A] Erase by Value"
layout: "post"
diff: 普及-
pid: AT_arc133_a
tag: []
---

# [ARC133A] Erase by Value

## 题目描述

给定一个整数序列 $A$，其中包含 $N$ 个元素 $A_1,A_2 \cdots A_N$ 。

小 S 现在要从 $A$ 中选择一个值 $x$。然后，他会按照元素在 $A$ 中的原始顺序，将不等于 $x$ 的元素组成一个新的整数序列 $a$。

请找出所有可能的 $a$ 序列中，字典序最小的那一个。

## 输入格式

第一行一个整数 $N$，第二行 $N$ 个数 $A_1,A_2 \cdots A_N$。

## 输出格式

输出字典序最小的 $a$ 中的元素，用空格隔开。

## 说明/提示

#### 制约
- $ 1\ \leq\ N\ \leq\ 200000 $
- $ 1\ \leq\ A_i\ \leq\ N $
- 所有的输入都是整数
#### 样例 1 解释
在这个样例中，如果选择 $x=2$，则 $a=(4,4,1)$。此外，如果选择 $x=4$，则 $a=(2,1,2)$，这时字典序是最小的。
#### 样例 2 解释
如果选择 $x=1$，则 $a$ 将为空，这显然是字典序最小的。另外，输出中可以包含额外的空格或换行符，不影响结果。

## 样例 #1

### 输入

```
5

2 4 4 1 2
```

### 输出

```
2 1 2
```

## 样例 #2

### 输入

```
3

1 1 1
```

### 输出

```

```

## 样例 #3

### 输入

```
5

1 1 2 3 3
```

### 输出

```
1 1 2
```



---

---
title: "[ARC135A] Floor, Ceil - Decomposition"
layout: "post"
diff: 普及-
pid: AT_arc135_a
tag: []
---

# [ARC135A] Floor, Ceil - Decomposition

## 题目描述

[problemUrl]: https://atcoder.jp/contests/arc135/tasks/arc135_a

黒板にひとつの整数 $ X $ が書かれています。あなたは次の操作を、何度でも行うことができます（一度も行わなくてもよいです）。

- 黒板に書かれている整数 $ x $ をひとつ選ぶ。
- $ x $ をひとつ黒板から消去し、新たに $ \lfloor\ \frac{x}{2}\rfloor $ と $ \lceil\ \frac{x}{2}\rceil $ をひとつずつ黒板に書く。

操作後の黒板に書かれている整数すべての積としてありうる最大値を、$ 998244353 $ で割った余りを答えてください。

  $ \lfloor\ \frac{x}{2}\rfloor $，$ \lceil\ \frac{x}{2}\rceil $ とは？ 実数 $ x $ に対して，$ x $ 以下の最大の整数を $ \lfloor\ x\rfloor $、$ x $ 以上の最小の整数を $ \lceil\ x\rceil $ と書きます。したがって例えば以下が成り立ちます。

- $ x\ =\ 2 $ のとき、$ \lfloor\ \frac{x}{2}\rfloor\ =\ 1 $, $ \lceil\ \frac{x}{2}\rceil\ =\ 1 $。
- $ x\ =\ 3 $ のとき、$ \lfloor\ \frac{x}{2}\rfloor\ =\ 1 $, $ \lceil\ \frac{x}{2}\rceil\ =\ 2 $。

## 输入格式

入力は以下の形式で標準入力から与えられます。

> $ X $

## 输出格式

操作後の黒板に書かれている整数すべての積としてありうる最大値を、$ 998244353 $ で割った余りを出力してください。

## 说明/提示

### 制約

- $ 1\leq\ X\ \leq\ 10^{18} $

### Sample Explanation 1

例えば次のように操作を行うことで、黒板に書かれている整数すべての積を $ 192 $ にすることが可能です。 - はじめ、黒板は次の状態です：$ (15) $。 - $ x\ =\ 15 $ として操作を行うことで、黒板は次の状態に変化します：$ (7,\ 8) $。 - $ x\ =\ 7 $ として操作を行うことで、黒板は次の状態に変化します：$ (8,\ 3,\ 4) $。 - $ x\ =\ 4 $ として操作を行うことで、黒板は次の状態に変化します：$ (8,\ 3,\ 2,\ 2) $。 - $ x\ =\ 8 $ として操作を行うことで、黒板は次の状態に変化します：$ (3,\ 2,\ 2,\ 4,\ 4) $。 このとき、黒板に書かれている整数すべての積は $ 3\times\ 2\times\ 2\times\ 4\times\ 4\ =\ 192 $ です。

### Sample Explanation 2

操作を一度も行わないことで、黒板に書かれている整数すべての積を $ 3 $ にすることが可能です。

### Sample Explanation 3

操作後の黒板に書かれている整数すべての積としてありうる最大値は、$ 5856458868470016 $ です。これを $ 998244353 $ で割った余りを出力します。

## 样例 #1

### 输入

```
15
```

### 输出

```
192
```

## 样例 #2

### 输入

```
3
```

### 输出

```
3
```

## 样例 #3

### 输入

```
100
```

### 输出

```
824552442
```



---

---
title: "[ARC139A] Trailing Zeros"
layout: "post"
diff: 普及-
pid: AT_arc139_a
tag: []
---

# [ARC139A] Trailing Zeros

## 题目描述

对于正整数 $ x $，我们定义 $ x $ 的二进制表示中末尾连续的零的个数为 $ \mathrm{ctz}(x) $。

例如，$ 8 $ 的二进制表示为 1000，所以 $ \mathrm{ctz}(8)=3 $；$ 5 $ 的二进制表示为 101，所以 $ \mathrm{ctz}(5)=0 $。

给定一个由非负整数组成的序列 $ T\ =\ (T_1,T_2,\dots,T_N) $。

请构造一个由正整数组成的序列 $ A\ =\ (A_1,A_2,\dots,A_N) $，使得满足以下条件：
- $ A_1\ \lt\ A_2\ \lt\ \cdots\ \lt\ A_{N-1}\ \lt\ A_N $，即 $ A $ 严格递增。
- 对于所有满足 $ 1\ \leq\ i\ \leq\ N $ 的整数 $ i $，都有 $ \mathrm{ctz}(A_i)\ =\ T_i $。

求 $ A_N $ 的最小可能值。

## 输入格式

输入以以下格式给出。
> $ N $ $ T_1 $ $ T_2 $ $ \dots $ $ T_N $

## 输出格式

输出答案。

## 说明/提示

- $ 1\ \leq\ N\ \leq\ 10^5 $
- $ 0\ \leq\ T_i\ \leq\ 40 $
- 输入的所有值都是整数

【样例解释 1】

例如，$ A_1=3,A_2=6,A_3=8,A_4=12 $ 满足条件。由于 $ A_4 $ 不能小于 $ 11 $，所以答案为 $ 12 $。

【样例解释 3】

注意答案可能不适合 $ 32 $ 位整数。

## 样例 #1

### 输入

```
4

0 1 3 2
```

### 输出

```
12
```

## 样例 #2

### 输入

```
5

4 3 2 1 0
```

### 输出

```
31
```

## 样例 #3

### 输入

```
1

40
```

### 输出

```
1099511627776
```

## 样例 #4

### 输入

```
8

2 0 2 2 0 4 2 4
```

### 输出

```
80
```



---

---
title: "[ARC142A] Reverse and Minimize"
layout: "post"
diff: 普及-
pid: AT_arc142_a
tag: []
---

# [ARC142A] Reverse and Minimize

## 题目描述

[problemUrl]: https://atcoder.jp/contests/arc142/tasks/arc142_a

正の整数 $ x $ に対し、以下の問題の答えを $ f(x) $ とします。

> $ x $ に次の操作を $ 0 $ 回以上何度でも行えます。
> 
> - $ x $ の十進表記を左右に反転して得られる整数を $ x' $ とする。そして、$ x $ を $ x' $ に置き換える。これによって $ x $ の先頭に $ 1 $ 個以上のゼロが並んだ場合、それらのゼロを削除して先頭がゼロでない状態にする。
> 
> たとえば、 $ x=1420 $ に対して $ 1 $ 回操作を行うと $ x=241 $ に、$ 2 $ 回操作を行うと $ x=142 $ に、$ 3 $ 回操作を行うと $ x=241 $ になります。  
>  操作後の $ x $ の最小値を求めてください。

$ 1\ \leq\ x\ \leq\ N $ かつ $ f(x)=K $ を満たす整数 $ x $ の個数を求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ K $

## 输出格式

答えを出力せよ。

## 说明/提示

### 制約

- $ 1\ \leq\ N,K\ \leq\ 10^{12} $
- 入力はすべて整数

### Sample Explanation 1

$ x=142,\ 241,\ 1420 $ の $ 3 $ つが $ 1\ \leq\ x\ \leq\ 1420 $ かつ $ f(x)=142 $ を満たします。

## 样例 #1

### 输入

```
1420 142
```

### 输出

```
3
```

## 样例 #2

### 输入

```
1419 142
```

### 输出

```
2
```

## 样例 #3

### 输入

```
6 19
```

### 输出

```
0
```



---

---
title: "[ARC142B] Unbalanced Squares"
layout: "post"
diff: 普及-
pid: AT_arc142_b
tag: []
---

# [ARC142B] Unbalanced Squares

## 题目描述

[problemUrl]: https://atcoder.jp/contests/arc142/tasks/arc142_b

$ N\ \times\ N $ のマス目があります。このマス目の上から $ i $ 行目、左から $ j $ 列目をマス $ (i,j) $ と呼びます。  
 全てのマスに整数を $ 1 $ つずつ書き込む方法であって、以下の条件を満たすようなものを $ 1 $ つ求めてください。

- $ 1 $ 以上 $ N^2 $ 以下の整数がそれぞれちょうど $ 1 $ つずつ書き込まれる。
- すべての整数 $ i,j\,\ (1\ \leq\ i,j\ \leq\ N) $ に対し、マス $ (i,j) $ が次の条件を満たす。 
  - マス $ (i,j) $ の上下左右斜めに隣接するマス(最大 $ 8 $ 個)のうち、書かれている整数がマス $ (i,j) $ に書かれている整数よりも大きいものの個数を $ a $、小さいものの個数を $ b $ とする。この時、 $ a\ \neq\ b $ が成り立つ。

なお、この問題の制約の下、条件を満たす整数の書き込み方が必ず存在することが証明できます。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $

## 输出格式

条件をみたす整数の書き込み方を以下の形式で出力せよ。

> $ x_{1,1} $ $ \ldots $ $ x_{1,N} $ $ \vdots $ $ x_{N,1} $ $ \ldots $ $ x_{N,N} $

ただし、$ x_{i,j} $ はマス $ (i,j) $ に書き込まれる整数とする。  
 答えが複数存在する場合はどれを出力しても正解とみなされる。

## 说明/提示

### 制約

- $ 2\ \leq\ N\ \leq\ 500 $
- $ N $ は整数

### Sample Explanation 1

この出力は $ 1 $ 以上 $ N^2\,\ (=4) $ 以下の整数がそれぞれちょうど $ 1 $ つずつ書き込まれているため、$ 1 $ つ目の条件を満たしています。 また、マス $ (1,1) $ の上下左右斜めに隣接するマスのうち書かれている整数がマス $ (1,1) $ に書かれているものより大きいものはマス $ (1,2) $、マス $ (2,1) $、マス $ (2,2) $ の $ 3 $ 個で、小さいものは $ 0 $ 個です。 このことからマス $ (1,1) $ に対しては $ a=3,b=0 $ となり、$ a\neq\ b $ が成り立ちます。 他のマスに対しても同様にして $ a\neq\ b $ が成り立つことが確かめられるため、この出力は $ 2 $ つ目の条件を満たしています。 以上より、この出力は正当です。

## 样例 #1

### 输入

```
2
```

### 输出

```
1 2

3 4
```

## 样例 #2

### 输入

```
3
```

### 输出

```
1 2 3

5 4 6

7 8 9
```



---

---
title: "[ARC145A] AB Palindrome"
layout: "post"
diff: 普及-
pid: AT_arc145_a
tag: []
---

# [ARC145A] AB Palindrome

## 题目描述

[problemUrl]: https://atcoder.jp/contests/arc145/tasks/arc145_a

`A`, `B` からなる長さ $ N $ の文字列 $ S $ が与えられます。

あなたは、以下の操作を $ 0 $ 回以上好きな回数繰り返すことができます。

- $ S $ の中の隣接する $ 2 $ 文字を一ヶ所選び、`AB` で置き換える。

$ S $ を回文にできるか判定してください。

 回文とは ある文字列 $ T $ について、 $ T $ の長さを $ |T| $ として、全ての整数 $ i $ ($ 1\ \le\ i\ \le\ |T| $) について、 $ T $ の前から $ i $ 文字目と後ろから $ i $ 文字目が同じであるとき、またそのときに限って、 $ T $ は回文です。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ S $

## 输出格式

$ S $ を回文にできる場合は `Yes` を、そうでない場合は `No` を出力せよ。

## 说明/提示

### 制約

- $ 2\ \leq\ N\ \leq\ 2\times\ 10^5 $
- $ S $ は `A`, `B` からなる長さ $ N $ の文字列

### Sample Explanation 1

$ 2,3 $ 文字目の `BA` を操作により `AB` で置き換えることで、$ S $ を回文である `BAB` にできます。

### Sample Explanation 2

操作を何回行っても、$ S $ を回文にはできません。

## 样例 #1

### 输入

```
3

BBA
```

### 输出

```
Yes
```

## 样例 #2

### 输入

```
4

ABAB
```

### 输出

```
No
```



---

---
title: "[ARC147A] Max Mod Min"
layout: "post"
diff: 普及-
pid: AT_arc147_a
tag: []
---

# [ARC147A] Max Mod Min

## 题目描述

[problemUrl]: https://atcoder.jp/contests/arc147/tasks/arc147_a

長さ $ N $ の正整数列 $ A=(A_1,A_2,\dots,A_N) $ が与えられます。

あなたは以下の操作を $ A $ の長さが $ 1 $ になるまで繰り返します。

- 操作を行う時点での $ A $ の長さを $ k $ とする。$ \max(\{A_1,A_2,\dots,A_{k}\})=A_i,\min(\{A_1,A_2,\dots,A_{k}\})=A_j $ かつ $ i\ \neq\ j $ を満たす整数の組 $ (i,j) $ を選び、$ A_i $ を $ (A_i\ \bmod\ A_j) $ で置き換える。このとき、$ A_i=0 $ となったのであれば $ A $ から $ A_i $ を削除する。

どのように操作を行っても操作回数は一定であることが証明できます。操作回数を求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ A_1 $ $ A_2 $ $ \dots $ $ A_N $

## 输出格式

答えを出力せよ。

## 说明/提示

### 制約

- $ 2\ \le\ N\ \le\ 2\ \times\ 10^5 $
- $ 1\ \le\ A_i\ \le\ 10^9 $
- 入力は全て整数である。

### Sample Explanation 1

以下のように操作を行うことになります。操作回数は $ 3 $ 回です。 - $ i=3,j=1 $ を選ぶ。$ A_3=0 $ となるため、$ A $ から $ A_3 $ を削除する。$ A=(2,3) $ となる。 - $ i=2,j=1 $ を選ぶ。$ A_2=1 $ となる。$ A=(2,1) $ となる。 - $ i=1,j=2 $ を選ぶ。$ A_1=0 $ となるため、$ A $ から $ A_1 $ を削除する。$ A=(1) $ となる。$ A $ の長さが $ 1 $ になったため、操作を終了する。

## 样例 #1

### 输入

```
3

2 3 6
```

### 输出

```
3
```

## 样例 #2

### 输入

```
6

1232 452 23491 34099 57341 21488
```

### 输出

```
12
```



---

---
title: "[ARC148A] mod M"
layout: "post"
diff: 普及-
pid: AT_arc148_a
tag: []
---

# [ARC148A] mod M

## 题目描述

[problemUrl]: https://atcoder.jp/contests/arc148/tasks/arc148_a

数列 $ A\ =\ (A_1,\ A_2,\ ...,\ A_N) $ が与えられます。  
 あなたは次の操作をちょうど $ 1 $ 回行うことができます。

- $ 2 $ 以上の整数 $ M $ を $ 1 $ つ選ぶ。その後、$ 1\ \leq\ i\ \leq\ N $ を満たすすべての整数 $ i $ に対して、 $ A_i $ を 「$ A_i $ を $ M $ で割ったあまり」に置き換える。

例えば $ A\ =\ (2,\ 7,\ 4) $ で $ M\ =\ 4 $ を選んだ時、操作後の $ A $ は $ (2\ \bmod\ 4,\ 7\ \bmod\ 4,\ 4\ \bmod\ 4)\ =\ (2,\ 3,\ 0) $ になります。

操作を行った後の $ A $ に含まれる要素の種類数は最小で何種類になりますか？

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ A_1 $ $ A_2 $ $ \dots $ $ A_N $

## 输出格式

答えを出力せよ。

## 说明/提示

### 制約

- $ 2\ \leq\ N\ \leq\ 2\ \times\ 10^5 $
- $ 0\ \leq\ A_i\ \leq\ 10^9 $
- 入力される値はすべて整数

### Sample Explanation 1

操作で $ M\ =\ 3 $ を選ぶと $ A\ =\ (1\ \bmod\ 3,\ 4\ \bmod\ 3,\ 8\ \bmod\ 3)\ =\ (1,\ 1,\ 2) $ になり、操作後の $ A $ の要素の種類数は $ 2 $ 種類になります。 $ A $ の要素の種類数を $ 1 $ 種類にすることはできないので $ 2 $ が答えです。

### Sample Explanation 2

操作で $ M\ =\ 5 $ を選ぶと $ A\ =\ (0,\ 0,\ 0,\ 0) $ になり、これが最適です。

## 样例 #1

### 输入

```
3

1 4 8
```

### 输出

```
2
```

## 样例 #2

### 输入

```
4

5 10 15 20
```

### 输出

```
1
```

## 样例 #3

### 输入

```
10

3785 5176 10740 7744 3999 3143 9028 2822 4748 6888
```

### 输出

```
1
```



---

---
title: "[ARC151A] Equal Hamming Distances"
layout: "post"
diff: 普及-
pid: AT_arc151_a
tag: []
---

# [ARC151A] Equal Hamming Distances

## 题目描述

给定两个长度均为$N$的$01$序列$S$和$T$。求某一个字典序最小的$01$序列$U$,长度也为$N$，使$S$到$U$的汉明距离等于$T$到$U$的汉明距离。

若有解，输出字典序最小的解；若无解，输出$-1$。

汉明距离：两个长度相同的$01$序列的汉明距离定义为对应**不相等**的位置数量。

## 输入格式

共三行：

第一行一个整数$N$。

第二行一个长度为$N$的$01$序列$S$。

第二行一个长度为$N$的$01$序列$T$。

## 输出格式

若有解，输出字典序最小的解；若无解，输出$-1$。

### 样例1解释
当$U=00001$时,$S$和$U$的汉明距离、$T$和$U$的汉明距离都是$2$。

### 样例2解释
没有符合条件的$01$序列。

## 说明/提示

$1≤N≤2×10^5$。

$N$是整数。

$S$和$T$是长度均为$N$的$01$个序列。

## 样例 #1

### 输入

```
5

00100

10011
```

### 输出

```
00001
```

## 样例 #2

### 输入

```
1

0

1
```

### 输出

```
-1
```



---

---
title: "3Match"
layout: "post"
diff: 普及-
pid: AT_autumn_fest_02
tag: []
---

# 3Match

## 题目描述

有 $H$ 行 $W$ 列的矩阵，每一个矩阵都有一个数字填充。我们需要找出**连续**的横着 $3$ 个及以上或竖着 $3$ 个及以上的，由**同一数字**构成的长方形，如图：

![](https://i.bmp.ovh/imgs/2021/05/f6ceeb02fde0a293.png)

但是，这有可能会连通。那么，这些连通的**只会**变成一个。如图：
![](https://i.bmp.ovh/imgs/2021/05/87dff1f17fcc326d.png)

需要求出长方形的个数（连通的只算一个）

## 输入格式

第一行两个正整数 $N$ 和 $M$。

第二行到第 $N + 1$ 行，每一行 $M$ 个由 $0$ 到 $9$ 的数，没有空格。

## 输出格式

一个正整数，表示长方形的个数（连通的只算一个）

### 输入输出样例
#### 样例 $1$
##### 输入：
```plain
3 5
12302
22202
23102
```
##### 输出：
```plain
3
``` 
如下图，有 $3$ 个长方形。

![](https://img.atcoder.jp/other/autumn_fest/f2_1.jpg)

#### 样例 $2$
##### 输入：
```plain
3 6
111234
231114
332332
```
##### 输出：
```plain
1
``` 
如下图，由于连通，所以只输出 $1$ 个。

![](https://img.atcoder.jp/other/autumn_fest/f2_2.jpg)

## 说明/提示

$3 \le H, W \le 100$。



---

---
title: "値札"
layout: "post"
diff: 普及-
pid: AT_bitflyer2018_final_a
tag: []
---

# 値札

## 题目描述

[problemUrl]: https://atcoder.jp/contests/bitflyer2018-final/tasks/bitflyer2018_final_a

すぬけ君は、店を開こうとしています。$ N $ 個の商品を販売する予定です。 $ i $ 番目の商品は、$ p_i $ 円で販売されます。

すぬけ君は、それぞれの価格の末尾についた `0` をたくさん書くのが大変に感じたので、 $ N $ 個全ての商品の値札の末尾に連続する `0` を全ての商品について同じ個数だけ取り除き、 会計の時にその分の `0` を補完することにしました。

商品の値札 $ 1 $ 枚あたり、 `0` を最大何個取り除けるかを求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ p_1 $ : $ p_N $

## 输出格式

商品の値札 $ 1 $ 枚あたり、 `0` を取り除ける個数の最大値を出力せよ。

## 说明/提示

### 制約

- $ 1\ <\ =\ N\ <\ =\ 100 $
- $ 1\ <\ =\ p_i\ <\ =\ 10^9 $
- $ p_i $ は整数

### Sample Explanation 1

それぞれ、末尾についた `0` を $ 1 $ つだけ取り除くことができ、すると値札には $ 30 $, $ 25 $, $ 600 $, $ 73 $ と書かれることになります。

## 样例 #1

### 输入

```
4

300

250

6000

730
```

### 输出

```
1
```

## 样例 #2

### 输入

```
5

10000000

30000000

150000000

200000000

990000000
```

### 输出

```
7
```

## 样例 #3

### 输入

```
4

100101100

110010000

100001001

110011000
```

### 输出

```
0
```



---

---
title: "ヘイホー君と置き換え"
layout: "post"
diff: 普及-
pid: AT_cf_2015_morning_easy_b
tag: []
---

# ヘイホー君と置き換え

## 题目描述

**题意描述：**\

给定$1$个字符串$str$，要改动其中多少字符才可以使这个字符串重复呢？\

例子：

- 将第二个字符替换为 $a$，得 $aaacbabc$。

- 将第三个字符替换为 b，得 $aabcbabc$。

- 将第 5 个字符替换为 a，得 $aabcaabc$。\

这样重复的子串为$aabc$，符合题意。

## 输入格式

第一行为一个整数$N$$(1 ≦ N ≦ 100)$，表示字符串的长度。



第二行为初始字符串。

## 输出格式

修改此字符串的次数。

## 样例 #1

### 输入

```
8

abacbabc
```

### 输出

```
3
```

## 样例 #2

### 输入

```
8

abababab
```

### 输出

```
0
```

## 样例 #3

### 输入

```
5

abcde
```

### 输出

```
-1
```

## 样例 #4

### 输入

```
26

codefestivaltwozeroonefive
```

### 输出

```
11
```



---

---
title: "反転時計"
layout: "post"
diff: 普及-
pid: AT_cf_2015_relay_e
tag: []
---

# 反転時計

## 题目描述

给出两个时间，$ht$时$mt$分 与 $hn$时$mn$分。

现在有一个时钟翻转的功能，只能在正午之前使用，即把 $hn$时$mn$分 转换到时钟上，将分针和时针分别逆时针旋转$180°$，得到一个更早的时间。如果这个时间不晚于$ht$时$mt$分，输出`Yes`，否则输出`No`。（注：**最后要换行**）

-----

## 输入格式

共两行。

第一行两个数，分别是$ht$和$mt$；

第二行两个数，分别是$hn$和$mn$；

## 输出格式

输出`Yes`或`No`。

## 样例 #1

### 输入

```
9 0

10 30
```

### 输出

```
Yes
```

## 样例 #2

### 输入

```
3 0

10 30
```

### 输出

```
No
```

## 样例 #3

### 输入

```
5 0

11 0
```

### 输出

```
Yes
```

## 样例 #4

### 输入

```
9 0

8 30
```

### 输出

```
Yes
```



---

---
title: "主菜と副菜"
layout: "post"
diff: 普及-
pid: AT_cf_2015_relay_g
tag: []
---

# 主菜と副菜

## 题目描述

[problemUrl]: https://atcoder.jp/contests/code-festival-2015-relay/tasks/cf_2015_relay_g

$ N $ 種類の主菜と $ M $ 種類の副菜から料理を選んでコースを作ります。 主菜は $ 1 $ 種類しか選ぶことができませんが、副菜は何種類でも選ぶことができます。 また、副菜は $ 1 $ つも選ばなくても構いません。 主菜・副菜ともにコースに入れられるのは $ 1 $ 種類につき $ 1 $ つまでです。

- $ i $ 番目の主菜は値段が $ A_i $ で、お客さんの評価が $ B_i $ です。
- $ i $ 番目の副菜は値段が $ C_i $ で、お客さんの評価が $ D_i $ です。

コース全体の値段と評価は、主菜と副菜の合計で決まります。 コースの値段を $ L $ 以下にする時、コースの評価は最大でいくつになるか求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ M $ $ L $ $ A_1 $ $ B_1 $ : $ A_N $ $ B_N $ $ C_1 $ $ D_1 $ : $ C_M $ $ D_M $

- $ 1 $ 行目には、$ 3 $ つの整数 $ N\ (1\ ≦\ N\ ≦\ 10,000) $, $ M\ (1\ ≦\ M\ ≦\ 1,000) $, $ L\ (1\ ≦\ L\ ≦\ 10,000) $ が空白区切りで与えられる。
- $ 2 $ 行目からの $ N $ 行には、主菜の情報が与えられる。このうち $ i\ (1\ ≦\ i\ ≦\ N) $ 行目には、$ i $ 番目の主菜の値段と評価を表す整数 $ A_i\ (1\ ≦\ A_i\ ≦\ 10,000) $, $ B_i\ (1\ ≦\ B_i\ ≦\ 10,000) $ が与えられる。
- $ N+2 $ 行目からの $ M $ 行には、副菜の情報が与えられる。このうち $ i\ (1\ ≦\ i\ ≦\ M) $ 行目には、$ i $ 番目の副菜の値段と評価を表す整数 $ C_i\ (1\ ≦\ C_i\ ≦\ 10,000) $, $ D_i\ (1\ ≦\ D_i\ ≦\ 10,000) $ が与えられる。
- 必ずコースを作れることが保証される。

## 输出格式

コースの評価の最大値を $ 1 $ 行に出力せよ。出力の末尾に改行を入れること。

## 样例 #1

### 输入

```
2 2 10

2 3

3 6

3 5

5 5
```

### 输出

```
13
```

## 样例 #2

### 输入

```
3 3 10

1 1

2 3

3 5

4 8

5 10

6 12
```

### 输出

```
19
```

## 样例 #3

### 输入

```
3 3 10

1 1

11 11

11 11

11 11

11 11

11 11
```

### 输出

```
1
```



---

---
title: "寿司タワー"
layout: "post"
diff: 普及-
pid: AT_codefestival_2015_final_c
tag: []
---

# 寿司タワー

## 题目描述

寿司塔

一个寿司由一个米饭和一个菜组成。
现在想用N个寿司来做寿司塔。（包含N个米饭和N个菜）

装1个寿司的方法有以下3种。
原封不动:按米饭、菜的顺序。
翻过来:按照菜、米饭的顺序。
拆开装:分开米饭和菜，分别装。

例如，想把3个寿司从下面开始依次装成“菜、米饭、菜、菜、米饭、米饭”的寿司塔，可以按以下顺序。
1、把一个寿司拆开，装上菜。
2、直接装一个寿司。
3、把一个寿司翻过来装。
4、装上留下的白米饭。
因为拆开寿司很费工夫，所以想尽量减少拆开寿司的个数。 

求完成目标寿司塔需要拆开的寿司个数的最小值。

## 输入格式

两行。
第一行给出了寿司的个数N。
第二行给出了长度为2N的字符串s，表示寿司塔的堆叠顺序（从下往上）。s是由0和1构成的字符串，其中0代表米饭，1代表菜。

## 输出格式

一行。
完成目标寿司塔需要拆开的寿司个数的最小值。在输出的末尾加上换行符。

## 样例 #1

### 输入

```
3

101100
```

### 输出

```
1
```

## 样例 #2

### 输入

```
5

0000111011
```

### 输出

```
3
```



---

---
title: "8月31日"
layout: "post"
diff: 普及-
pid: AT_codefestival_2015_qualA_c
tag: []
---

# 8月31日

## 题目描述

高桥君注意到虽然今天暑假已经结束了，但是作业完全没有做完。

做作业的时间还有 $T$ 分钟。而且高桥君必须要做的作业有 $N$ 个。第 $i$ 个作业高桥君要解的话需要 $A_i$ 分钟，高桥君的朋友青木君做的作业全部抄下来的话，$B_i$ 分钟就可以完成了。但是抄朋友的作业是不太好的，所以高桥想尽量**不抄写**。为了在规定时间之前完成所有作业，请求出高桥君需要抄写的作业个数的最小值。但是，如果无法按时完成作业的话，请输出 `-1`。

## 输入格式

第一行两个整数 $N(1\le N\le 10^5)$ 和 $T(1\le T\le 10^9)$。

接下来 $N$ 行，每行两个整数 $A_i$ 和 $B_i$，意义如题述。

## 输出格式

仅一个数，表示高桥君需要抄写的作业个数的**最小值**。

## 样例 #1

### 输入

```
5 7

1 0

3 0

5 0

2 0

4 0
```

### 输出

```
2
```

## 样例 #2

### 输入

```
1 1000000000

5 0
```

### 输出

```
0
```

## 样例 #3

### 输入

```
1 0

100 99
```

### 输出

```
-1
```

## 样例 #4

### 输入

```
3 11

5 2

6 4

7 3
```

### 输出

```
2
```

## 样例 #5

### 输入

```
6 92

31 4

15 9

26 5

35 8

97 9

32 3
```

### 输出

```
3
```



---

---
title: "旅館"
layout: "post"
diff: 普及-
pid: AT_codefestival_2015_qualB_c
tag: []
---

# 旅館

## 题目描述

[problemUrl]: https://atcoder.jp/contests/code-festival-2015-qualb/tasks/codefestival_2015_qualB_c

高橋君は部屋が $ N $ 室ある旅館を経営しています。今日は $ M $ 組の予約が入っていますが、全ての予約を適切に部屋に割り振ることができるかを確認していませんでした。各予約について、その組の人数以上の定員の部屋を割り振る必要があります。各予約について必ず $ 1 $ つの部屋が割り当てられる必要があり、$ 1 $ つの予約について複数の部屋を割り当てたり、複数の予約を $ 1 $ つの部屋に割り当てたりすることはできません。全ての予約に部屋を割り振ることができるならば `YES` を、割り振ることができないならば `NO` を出力してください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ M $ $ A_1 $ $ A_2 $ ... $ A_N $ $ B_1 $ $ B_2 $ ... $ B_M $

- $ 1 $ 行目には、$ 2 $ つの整数 $ N\ (1\ ≦\ N\ ≦\ 10^5) $, $ M\ (1\ ≦\ M\ ≦\ 10^5) $ が空白区切りで与えられる。
- $ 2 $ 行目には、$ N $ 個の整数が空白区切りで与えられる。このうち $ i\ (1\ ≦\ i\ ≦\ N) $ 番目には、$ i $ 番目の部屋の定員を表す整数 $ A_i\ (1\ ≦\ A_i\ ≦\ 10^5) $ が与えられる。
- $ 3 $ 行目には、$ M $ 個の整数が空白区切りで与えられる。このうち $ i\ (1\ ≦\ i\ ≦\ M) $ 番目には、$ i $ 番目の予約の人数を表す整数 $ B_i\ (1\ ≦\ B_i\ ≦\ 10^5) $ が与えられる。

## 输出格式

全ての予約に部屋を割り振ることができるならば `YES` を、割り振ることができないならば `NO` を $ 1 $ 行に出力せよ。出力の末尾に改行を入れること。

## 说明/提示

### 部分点

この問題には部分点が設定されている。

- $ N\ ≦\ 100 $, $ M\ ≦\ 100 $ を満たすデータセットに正解した場合は、$ 60 $ 点が与えられる。
- 追加の制約のないデータセットに正解した場合は、上記とは別に $ 40 $ 点が与えられる。

## 样例 #1

### 输入

```
3 2

2 2 3

3 1
```

### 输出

```
YES
```

## 样例 #2

### 输入

```
3 2

2 2 3

3 3
```

### 输出

```
NO
```

## 样例 #3

### 输入

```
3 4

10 10 10

1 1 1 1
```

### 输出

```
NO
```

## 样例 #4

### 输入

```
10 10

10 9 8 7 6 5 4 3 2 1

10 9 8 7 6 5 4 3 2 1
```

### 输出

```
YES
```



---

---
title: "仲良しうさぎ"
layout: "post"
diff: 普及-
pid: AT_codefestival_2016_qualA_b
tag: []
---

# 仲良しうさぎ

## 题目描述

有 $N$ 个数，第 $i$ 个数为 $a_i$。让你求出符合 $a_i = j$ 且 $a_j = i$ 的情况有几种（重复算一种）

## 输入格式

第一行一个整数 $N$。  
第二行有 $N$ 个整数，第 $i$ 个数是 $a_i$。

## 输出格式

一个数，为符合 $a_i = j$ 且 $a_j = i$ 的情况的种数。

## 样例 #1

### 输入

```
4

2 1 4 3
```

### 输出

```
2
```

## 样例 #2

### 输入

```
3

2 3 1
```

### 输出

```
0
```

## 样例 #3

### 输入

```
5

5 5 5 5 1
```

### 输出

```
1
```



---

---
title: "Problem Set"
layout: "post"
diff: 普及-
pid: AT_code_festival_2017_qualb_b
tag: []
---

# Problem Set

## 题目描述

给定两个序列 $a,b$ ， 请判断是否有一种方案，满足可以用 $a$ 序列中的元素经过一定排序组成序列 $b$ 。

## 输入格式

第一行，输入一个数 $n$ ，表示 $a$ 序列的元素个数；

接下来一行有 $n$ 个数，表示序列 $a$ ；

第三行为一个数 $m$ ，表示 $b$ 序列的元素个数；

接下来有 $m$ 个数，表示序列 $b$ ；

## 输出格式

若可以，输出 ```YES``` ；否则输出 ```NO``` 。

### 样例解释

样例 $1\ \&\ 5$ ：可以用 $a$ 的第 $1,3,5$ 个元素组成序列 $b$ 。

样例 $2\ \&\ 6$ ：$a$ 中仅有一个 $1600$ ，但是 $b$ 中有 $2$ 个，无法满足。

样例 $3\ \&\ 7$ ：$a$ 中没有 $100$ ，无法满足。

## 样例 #1

### 输入

```
5

3 1 4 1 5

3

5 4 3
```

### 输出

```
YES
```

## 样例 #2

### 输入

```
7

100 200 500 700 1200 1600 2000

6

100 200 500 700 1600 1600
```

### 输出

```
NO
```

## 样例 #3

### 输入

```
1

800

5

100 100 100 100 100
```

### 输出

```
NO
```

## 样例 #4

### 输入

```
15

1 2 2 3 3 3 4 4 4 4 5 5 5 5 5

9

5 4 3 2 1 2 3 4 5
```

### 输出

```
YES
```



---

---
title: "Similar Arrays"
layout: "post"
diff: 普及-
pid: AT_code_festival_2017_qualc_b
tag: []
---

# Similar Arrays

## 题目描述

[problemUrl]: https://atcoder.jp/contests/code-festival-2017-qualc/tasks/code_festival_2017_qualc_b

$ 2 $ つの長さ $ N $ の整数列 $ x_1,\ x_2,\ ...,\ x_N $ と $ y_1,\ y_2,\ ...,\ y_N $ が「似ている」とは、 任意の $ i $ ($ 1\ \leq\ i\ \leq\ N $) に対して $ |x_i\ -\ y_i|\ \leq\ 1 $ が成り立つことをいうものとします。

とくに、どの整数列もその数列自身と似ていると考えます。

整数 $ N $ および長さ $ N $ の整数列 $ A_1,\ A_2,\ ...,\ A_N $ が与えられます。

$ A $ と似ている整数列 $ b_1,\ b_2,\ ...,\ b_N $ であって、すべての項の積 $ b_1\ b_2\ ...\ b_N $ が偶数となるものはいくつあるか求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ A_1 $ $ A_2 $ $ ... $ $ A_N $

## 输出格式

条件を満たす整数列の個数を出力せよ。

## 说明/提示

### 制約

- $ 1\ \leq\ N\ \leq\ 10 $
- $ 1\ \leq\ A_i\ \leq\ 100 $

### Sample Explanation 1

条件を満たす整数列は以下の $ 7 $ 個あります。 - $ 1,\ 2 $ - $ 1,\ 4 $ - $ 2,\ 2 $ - $ 2,\ 3 $ - $ 2,\ 4 $ - $ 3,\ 2 $ - $ 3,\ 4 $

## 样例 #1

### 输入

```
2

2 3
```

### 输出

```
7
```

## 样例 #2

### 输入

```
3

3 3 3
```

### 输出

```
26
```

## 样例 #3

### 输入

```
1

100
```

### 输出

```
1
```

## 样例 #4

### 输入

```
10

90 52 56 71 44 8 13 30 57 84
```

### 输出

```
58921
```



---

---
title: "パスカルの三角形"
layout: "post"
diff: 普及-
pid: AT_code_festival_final_d
tag: []
---

# パスカルの三角形

## 题目描述

[problemUrl]: https://atcoder.jp/contests/code-festival-2014-final/tasks/code_festival_final_d

高橋君は、パスカルの三角形が大好きです。

パスカルの三角形とは、一つ上の数字の、右上の数と左上の数を足した数を書き連ねていくことにより、表現することが出来る三角形です。

パスカルの三角形の$ y $ 段目は $ y $ 個の数で構成されており、 $ y $ 段目 $ x $ 番目の数を $ f(y,x) $ とすると、

- $ x\ =\ 1 $、または $ x\ =\ y $ の時、$ f(y,x)\ =\ 1 $
- それ以外の時、$ f(y,x)\ =\ f(y-1,x)\ +\ f(y-1,x-1) $

と定義されます。

高橋君は、ある整数 $ A $ が、パスカルの三角形に含まれるかどうかを調べたいと思いました。

もし、パスカルの三角形に $ A $ が現れるのであれば、その段数、及び何番目かを出力し、出現しないのであれば、`-1 -1`と出力しなさい。

## 输入格式

入力は以下の形式で標準入力から与えられる

> $ A $

- $ 1 $ 行目には、整数 $ A(1\ ≦\ A\ ≦\ 10^9) $ が与えられる。

## 输出格式

もし、パスカルの三角形に $ A $ が現れるのであれば、その段数、及び何番目かをスペース区切りで出力せよ。出現しないのであれば、`-1 -1`と出力せよ。出力の末尾には改行をいれること。

なお、出力は、どちらの数字も $ 2 $ × $ 10^9 $ 以下の 整数でなければならない。

## 说明/提示

### Sample Explanation 1

$ 6 $ 段目、 $ 3 $ 番目の数字は $ 10 $ です。他に $ 6 $ 段目 $ 4 $ 番目なども条件を満たしますが、どの出力をしても問題ありません。

### Sample Explanation 2

ある程度大きな数字が入力されることもあります。

## 样例 #1

### 输入

```
10
```

### 输出

```
6 3
```

## 样例 #2

### 输入

```
3921225
```

### 输出

```
101 5
```



---

---
title: "差の平均"
layout: "post"
diff: 普及-
pid: AT_code_festival_morning_easy_a
tag: []
---

# 差の平均

## 题目描述

给定一个数列 $a$，有 $n$ 个元素 $\{a_1,a_2,a_3\cdots a_{n-1},a_n\}$，求
$$\dfrac{(a_2-a_1)+(a_3-a_2)+(a_4-a_3)+\cdots+(a_n-a_{n-1})}{n-1}$$

如果不整除，则保留 $3$ 位小数输出，否则直接输出。

与正确答案相差不超过 $0.001$ 的答案也可通过。

## 输入格式

如下所示：
> $n$
>
> $a_1\ a_2\ a_3\ \cdots\ a_n$

## 输出格式

只有一行，表示结果。注意输出末尾要换行。

## 说明/提示

对于 $100\%$ 的数据，$2\le n\le100,1\le a_i\le10^9$。

## 样例 #1

### 输入

```
4

4 3 2 1
```

### 输出

```
-1
```

## 样例 #2

### 输入

```
4

1 2 3 5
```

### 输出

```
1.333
```

## 样例 #3

### 输入

```
4

1000000000 1000000000 1000000000 1000000000
```

### 输出

```
0
```

## 样例 #4

### 输入

```
4

1000000000 324219581 581395481 2319
```

### 输出

```
-333332560.333333313
```



---

---
title: "Color Game"
layout: "post"
diff: 普及-
pid: AT_code_festival_relay_j
tag: []
---

# Color Game

## 题目描述

$n$ 个白色石头以相等的间隔排列。相邻石头之间的距离为 $1$。两个玩家用这块石头玩游戏。每个玩家轮流选择白色石头并将其变为黑色。但是，不能从前一回合变黑的石头中选择距离在 $k$ 内的石头。不能选择白色石头的玩家输了。在这个游戏中，双方采用最优策略，询问先手必胜或者后手必胜。

## 输入格式

$n$ 表示石头的数量，$k$ 表示不可选择的距离。（$1 \le n \le 50$，$0 \le k \le n$）

## 输出格式

先手必胜 `first`，后手 `second`。

## 样例 #1

### 输入

```
2 1
```

### 输出

```
first
```

## 样例 #2

### 输入

```
3 0
```

### 输出

```
first
```



---

---
title: "次世代SNS"
layout: "post"
diff: 普及-
pid: AT_code_formula_2014_final_c
tag: []
---

# 次世代SNS

## 题目描述

[problemUrl]: https://atcoder.jp/contests/code-formula-2014-final/tasks/code_formula_2014_final_c

あなたは、とあるSNSを作ろうとしています。

このSNSでは、`@username`という形式で、特定のユーザーにメッセージを送ることが可能であり、$ 1 $ つの発言に複数のユーザーを指定することで、複数のユーザーに同時にメッセージを送ることが可能になります。

このSNSは、以下のようなルールに従っています。

- 書き込まれるメッセージは、半角小文字アルファベット、半角スペース、`@`のみを含む。
- 書き込まれたメッセージに`@`が含まれていた場合、`@`直後の、アルファベットのみで構成される文字列のうち、最も長い文字列をユーザー名として扱い、そのユーザーにメッセージを届ける。
- `@`の直後がアルファベットでなかった場合は無視する。
- 複数回同じユーザーが指定されても、メッセージは $ 1 $ 回届ければ良い。

あなたは、このシステムを実装するために、書き込まれたメッセージに対し、メッセージを届けるべきユーザーを列挙するプログラムを作りたいです。

メッセージを送るべきユーザーを全て出力しなさい。なお、ユーザーが複数いる場合は、辞書順で出力しなさい。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ S $

- $ 1 $ 行目には、書き込まれるメッセージを表す文字列 $ S(1≦|S|≦140) $ が与えられる。
- 文字列 $ S $ には、小文字アルファベット、` `、`@`以外の文字は含まれない。

## 输出格式

メッセージを送るべきユーザーを、 $ 1 $ 行ずつ全て出力しなさい。なお、ユーザーが複数いる場合は、辞書順で出力しなさい。

## 说明/提示

### Sample Explanation 1

`codeformula`さんへのメッセージです。半角スペースが挟まれているので、`why`以降をユーザー名として認識することはありません。 また、`@`を出力する必要はありません。

### Sample Explanation 2

`a`が何度も指定されていますが、一度だけ出力する必要があります。 また、ユーザ名は辞書順で出力する必要があります。

### Sample Explanation 3

メッセージを送るべきユーザーがいない場合、何も出力しないで構いません。

## 样例 #1

### 输入

```
@codeformula why is this contest so easy
```

### 输出

```
codeformula
```

## 样例 #2

### 输入

```
myon @@c @a @aba@a @@bb bbb @@@@@ @a test  @ space  aaa test @a@a  test@takoyaki
```

### 输出

```
a

aba

bb

c

takoyaki
```

## 样例 #3

### 输入

```
no atmark
```

### 输出

```

```



---

---
title: "ボウリングゲーム"
layout: "post"
diff: 普及-
pid: AT_code_formula_2014_qualA_b
tag: []
---

# ボウリングゲーム

## 题目描述

[problemUrl]: https://atcoder.jp/contests/code-formula-2014-quala/tasks/code_formula_2014_qualA_b

高橋君は、ボーリングゲームを作っています。 ゲーム中で、倒したピンを表示する必要があるのですが、ピンの番号を羅列しても、あまり見栄えがよくありません。

そこで、高橋君は、 $ 1 $ 投目に倒したピンと、$ 2 $ 投目に倒したピンを、グラフィカルに表示することにしました。 まず、ピンの番号を、以下のように割り当てます。 $ 10 $ 番目のピンは $ 0 $ で表されることに注意してください。

 ```

7 8 9 0
 4 5 6
  2 3
   1
```

この番号ごとの位置に対し、以下のような表示を行います。

- そのピンが $ 1 $ 投目に倒された場合は、`.`と表示します。
- そのピンが $ 2 $ 投目に倒された場合は、`o`と表示します。
- そのピンが $ 2 $ 投目までに倒されなかった場合は、`x`と表示します。

例えば、 $ 1 $ 投目に、$ 1 $, $ 3 $, $ 5 $ の $ 3 $ 本のピンが、 $ 2 $ 投目に $ 7 $, $ 0 $ の $ 2 $ 本のピンが倒された場合、以下のような表示になります。

 ```

o x x o
 x . x
  x .
   .
```

$ 1 $ 投目、 $ 2 $ 投目に倒されたピンの情報が与えられるので、以上のような出力をしてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ a $ $ b $ $ p_1 $ $ p_2 $ ... $ p_a $ $ q_1 $ $ q_2 $ ... $ q_b $

- $ 1 $ 行目には、$ 1 $ 投目に倒した本数を表す整数 $ a\ (0\ ≦\ a\ ≦\ 10) $ と、$ 2 $ 投目に倒した本数を表す整数 $ b\ (0\ ≦\ b\ ≦\ 10) $ が、スペース区切りで与えられる。
- $ 2 $ 行目には、$ 1 $ 投目に倒したピンの番号を表す $ a $ 個の整数が、スペース区切りで与えられる。このうち $ i\ (1\ ≦\ i\ ≦\ a) $ 番目の整数 $ p_i $ は、$ i $ 番目に倒れたピンを表す。なお、$ i\ ≠\ j $のとき、$ p_i\ ≠\ p_j $であることが保障されている。
- $ 3 $ 行目には、$ 2 $ 投目に倒したピンの番号を表す $ b $ 個の整数が、スペース区切りで与えられる。このうち $ i\ (1\ ≦\ i\ ≦\ b) $ 番目の整数 $ q_i $ は、$ i $ 番目に倒れたピンを表す。なお、$ i\ ≠\ j $のとき、$ q_i\ ≠\ q_j $であることが保障されている。
- 任意の $ i,\ j $ に対し、 $ p_i\ ≠\ q_j $ であることが保障されている。

## 输出格式

倒したピンの情報を、題意に沿って出力しなさい。 出力の末尾にも改行をいれること。 なお、各行の最後の`.`、`o`、`x`の後に、いくつかのスペースを出力しても良い。

## 说明/提示

### Sample Explanation 1

問題文で説明した入力です。

### Sample Explanation 2

ストライクの場合は、$ 2 $ 行の後に空行が続きます。 なお、閲覧環境によっては、空行に半角スペースが混ざっていることがありますが、実際の入力では、空行に半角スペースは含まれません。

### Sample Explanation 3

入力に空行が生じる場合もあることに注意してください。 なお、閲覧環境によっては、空行に半角スペースが混ざっていることがありますが、実際の入力では、空行に半角スペースは含まれません。

## 样例 #1

### 输入

```
3 2

1 3 5

7 0
```

### 输出

```
o x x o

 x . x

  x .

   .
```

## 样例 #2

### 输入

```
10 0

7 3 4 5 1 2 6 0 9 8
```

### 输出

```
. . . .

 . . .

  . .

   .
```

## 样例 #3

### 输入

```
0 10



7 3 4 5 1 2 6 0 9 8
```

### 输出

```
o o o o

 o o o

  o o

   o
```



---

---
title: "Meeting"
layout: "post"
diff: 普及-
pid: AT_cpsco2019_s4_b
tag: []
---

# Meeting

## 题目描述

A 公司的一个项目团队中一共有 $(n+1)$ 个人，他们分别是领导以及编号从 $1$ 到 $n$ 的 $n$ 名员工。接下来的 $d$ 天中，领导会在其中的两天召开会议，向这两天到岗的员工传达一个重要事项。现在领导手里已经拿到了所有员工的出勤计划，他想让你帮他看看，最多能向多少员工（不含领导自己）传达这个重要事项？

## 输入格式

输入共 $(d+1)$ 行。第一行输入两个正整数 $n$ 和 $d$，中间以单个空格隔开。接下来的 $d$ 行按照 $i=1,2,\dots,d$ 的顺序输入第 $i$ 天的出勤情况，如果第 $j$ 个字符为`x`表示队员 $j$ 不会出勤，为`o`表示队员 $j$ 会出勤（$1 \le j \le n$）。

## 输出格式

输出一行一个非负整数，即最多能传达到的员工的数量。

## 说明/提示

#### 【输入输出样例 #1 解释】

在第 $2$ 天开会，将事项传达给员工 $1$；然后再在第 $3$ 天开会，将事项传达给员工 $1$ 和 $2$。

#### 【输入输出样例 #2 解释】

假设在第 $2,3$ 天开会，那么知道重要事项的员工只有员工 $1,3$。可以证明不可能所有人都会收到重要事项，所以正确答案为 $2$。

#### 数据规模与约定

所有测试点的输入数据保证：

- $1 \le n \le 10$，$2 \le d \le 10$，且 $n,d$ 均为整数；
- 输入中的后 $d$ 行输入的均为一个长度为 $n$，且仅由`o`和`x`组成的字符串。

## 样例 #1

### 输入

```
2 3

xx

ox

oo
```

### 输出

```
2
```

## 样例 #2

### 输入

```
3 3

xox

oxx

xxo
```

### 输出

```
2
```

## 样例 #3

### 输入

```
5 4

oxxox

xoxxx

xxoxo

oxxxo
```

### 输出

```
4
```



---

---
title: "レース (Race)"
layout: "post"
diff: 普及-
pid: AT_ddcc2019_final_a
tag: []
---

# レース (Race)

## 题目描述

[problemUrl]: https://atcoder.jp/contests/ddcc2019-final/tasks/ddcc2019_final_a

高橋君はペンギンのレース場を作りました。

レース場は $ N $ 個の正方形のマスが西から東に一列に並んだ形状をしています。  
 これらのマスの状態は文字列 $ S $ により表され、西から $ i $ 番目のマスの状態は $ S $ の $ i $ 文字目が `-` なら「雪」、`>` なら「氷」です。  
 また、スタート地点は西端のマスの西の端、ゴール地点は東端のマスの東の端です。

高橋くんのペンギンが、スタート地点からゴール地点を目指して東に進みます。  
 ペンギンは、雪マスを $ 1 $ マス通過するのに $ 1 $ 秒、氷マスを $ 1 $ マス通過するのに $ 1/(k+2) $ 秒の時間を要します。  
 ここで、$ k $ はその氷マスの直前に連続して存在する氷マスの個数です。  
 例えば、雪マスの直後に氷マスが $ 2 $ つ存在する場合、$ 1 $ つ目の氷マスは $ 1/2 $ 秒、$ 2 $ つ目の氷マスは $ 1/3 $ 秒で通過します。

ペンギンがスタートする前に、高橋君は雪マスのうち $ 1 $ つを氷マスに変えることができます。  
 ペンギンがスタート地点を出発してからゴール地点に到達するまでに最小で何秒かかるでしょうか？

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ S $

## 输出格式

ペンギンがゴール地点に到達するのに要する秒数の最小値を出力せよ。  
 ジャッジの出力との相対誤差または絶対誤差が $ 10^{-8} $ 以下であれば正解となる。

## 说明/提示

### 制約

- $ 3\ \leq\ N\ \leq\ 100\ 000 $
- $ S $ は `-`, `>` で構成される長さ $ N $ の文字列
- $ S_1\ =\ S_2\ =\ S_{N-1}\ =\ S_N\ = $ `-`
- **$ S $ において、`-` は必ず別の `-` と隣接して現れる**

### Sample Explanation 1

西から $ 4 $ 番目のマスを雪マスから氷マスに変えると、レース場は `--&gt;&gt;-` となります。 このとき、ペンギンは西から $ 1,\ 2,\ 3,\ 4,\ 5 $ 番目のマスの通過にそれぞれ $ 1,\ 1,\ 1/2,\ 1/3,\ 1 $ 秒、合計で $ 23/6\ =\ 3.83333333... $ 秒を要し、これが最短です。

### Sample Explanation 2

どのマスを雪マスから氷マスに変えても、ペンギンは $ 13/2\ =\ 6.5 $ 秒でゴールします。

### Sample Explanation 3

西から $ 2 $ 番目または $ 6 $ 番目のマスを雪マスから氷マスに変えると、ペンギンは $ 407/60\ =\ 6.783333333... $ 秒でゴールすることができます。

## 样例 #1

### 输入

```
5

-->--
```

### 输出

```
3.83333333333333
```

## 样例 #2

### 输入

```
7

-------
```

### 输出

```
6.5
```

## 样例 #3

### 输入

```
10

-->>>-->--
```

### 输出

```
6.78333333333333
```



---

---
title: "Iron Bar Cutting"
layout: "post"
diff: 普及-
pid: AT_ddcc2020_qual_b
tag: []
---

# Iron Bar Cutting

## 题目描述

[problemUrl]: https://atcoder.jp/contests/ddcc2020-qual/tasks/ddcc2020_qual_b

DISCO 社の高橋君の前に，$ 1 $ 本の鉄の棒が置かれています．  
 この棒は，$ N-1 $ 個の切れ目によって $ N $ 個の区間に分かれています．左から $ i $ 個目の区間の長さは $ A_i $ ミリメートルです．

高橋君は，切れ目を一つ選んでそこで棒を切り，同じ長さの棒を $ 2 $ 本作ることを考えました．しかし，今の状態では，どの切れ目を選んでも $ 2 $ 本の棒を同じ長さにすることができないかもしれません．  
 そこで，彼は棒を切る**前に**，以下の操作を何回か行うことにしました．

- 棒の区間のうち $ 1 $ つを選び，膨張させ，長さを $ 1 $ ミリメートル増やす．この操作を $ 1 $ 回行うのに $ 1 $ 円かかる．
- 棒の区間のうち長さが $ 2 $ ミリメートル以上のもの $ 1 $ つを選び，収縮させ，長さを $ 1 $ ミリメートル減らす．この操作を $ 1 $ 回行うのに $ 1 $ 円かかる．

彼が棒を $ 2 $ 等分するために必要な最小の金額は何円か，求めてください．

## 输入格式

入力は以下の形式で標準入力から与えられます．

> $ N $ $ A_1 $ $ A_2 $ $ A_3 $ ... $ A_N $

## 输出格式

高橋君が棒を $ 2 $ 等分するのにかかる最小の金額を整数で出力してください．

## 说明/提示

### 制約

- $ 2\ \leq\ N\ \leq\ 200000 $
- $ 1\ \leq\ A_i\ \leq\ 2020202020 $
- $ N,\ A_i $ は整数

### Sample Explanation 1

最初，棒の各区間の長さは $ [2,\ 4,\ 3] $ (ミリメートル) です．高橋君は，以下の操作を行うことによって，$ 3 $ 円で棒を $ 2 $ 等分できます． - 左から $ 2 $ 番目の区間を収縮させる．各区間の長さは $ [2,\ 3,\ 3] $ となる． - 左から $ 1 $ 番目の区間を収縮させる．各区間の長さは $ [1,\ 3,\ 3] $ となる． - 左から $ 2 $ 番目の区間を収縮させる．各区間の長さは $ [1,\ 2,\ 3] $ となる．左から $ 2 $ 個目の切れ目で棒を切ると，長さ $ 3 $ の棒が $ 2 $ 本できる．

## 样例 #1

### 输入

```
3

2 4 3
```

### 输出

```
3
```

## 样例 #2

### 输入

```
12

100 104 102 105 103 103 101 105 104 102 104 101
```

### 输出

```
0
```



---

---
title: "ロト2"
layout: "post"
diff: 普及-
pid: AT_ddcc_2016_qual_c
tag: []
---

# ロト2

## 题目描述

[problemUrl]: https://atcoder.jp/contests/ddcc2016-qual/tasks/ddcc_2016_qual_c

$ N $ 枚のカードが $ 1 $ 列に並べられており、$ i(1\ ≦\ i\ ≦\ N) $ 番目のカードには整数 $ A_i $ が書かれています。

この $ N $ 枚のカードを使ったロト $ 2 $ という宝くじがあります。 ロト $ 2 $ は $ 1 $ 番から $ N $ 番までの番号から異なる $ 2 $ つの番号 $ i,\ \,\ j\ (i\ <\ j) $ を選び、選ばれた $ 2 $ つの番号のカードにそれぞれ書かれた値の積 $ A_i\ A_j $が $ K $ の倍数となるとき当選するというルールで行われます。

$ A_iA_j $ が $ K $ の倍数となるような $ i $ と $ j $ の組合せ $ (i,\ \,\ j) $ を良い組合せと呼ぶことにします。良い組合せは何通りあるか求めなさい。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ K $ $ A_1 $ $ A_2 $ $ … $ $ A_N $

## 输出格式

良い組合せの総数を $ 1 $ 行に出力せよ。

## 说明/提示

### 制約

- $ 1\ ≦\ N\ ≦\ 200{,}000 $
- $ 1\ ≦\ A_i\ ≦\ 10^{9}\ (1\ ≦\ i\ ≦\ N) $
- $ 1\ ≦\ K\ ≦\ 10^{9} $
- $ A_i,\ \,\ K $ はいずれも整数

### Sample Explanation 1

$ (1,\ \,\ 4),\ \,\ (2,\ \,\ 3),\ \,\ (2,\ \,\ 4),\ \,\ (3,\ \,\ 4) $ の $ 4 $ 通りが良い組合せです。

### Sample Explanation 2

どのように $ 2 $ つの番号を選んでも良い組合せになります。

## 样例 #1

### 输入

```
4 6

1 3 2 6
```

### 输出

```
4
```

## 样例 #2

### 输入

```
5 1

1 2 3 1 2
```

### 输出

```
10
```

## 样例 #3

### 输入

```
12 60

38 19 180 222 560 1000 7 99 845 3600 12 90
```

### 输出

```
33
```



---

---
title: "DISCO presents ディスカバリーチャンネルプログラミングコンテスト 2016 Ⅱ"
layout: "post"
diff: 普及-
pid: AT_discovery_2016_final_a
tag: []
---

# DISCO presents ディスカバリーチャンネルプログラミングコンテスト 2016 Ⅱ

## 题目描述

有 $N$ 个人参加比赛，其中：

第一名可以获得 $100000$ 日元；

第二名可以获得 $50000$ 日元；

第三名可以获得 $30000$ 日元；

第四名可以获得 $20000$ 日元；

第五名可以获得 $10000$ 日元；

其余名次没有奖金。

要求按照参赛者编号 $id$ 依次输出每个人获得的奖金数量。

## 输入格式

第一行一个整数 $N(5\le N\le100)$，表示参赛者数量。

接下来有 $N$ 行，第 $i$ 行一个整数 $id_i(1\le id_i\le N)$，表示第 $i$ 名的参赛者编号是 $id_i$。

## 输出格式

输出 $N$ 行，第 $i$ 行表示参赛者编号为 $id_i$ 的选手获得的奖金数量。

## 样例 #1

### 输入

```
5

1

2

3

4

5
```

### 输出

```
100000

50000

30000

20000

10000
```

## 样例 #2

### 输入

```
8

8

7

6

5

4

3

2

1
```

### 输出

```
0

0

0

10000

20000

30000

50000

100000
```

## 样例 #3

### 输入

```
7

1

5

4

2

7

6

3
```

### 输出

```
100000

20000

0

30000

50000

0

10000
```



---

---
title: "RGB Boxes"
layout: "post"
diff: 普及-
pid: AT_diverta2019_b
tag: []
---

# RGB Boxes

## 题目描述

[problemUrl]: https://atcoder.jp/contests/diverta2019/tasks/diverta2019_b

すぬけ君はボールが入った箱を売っている店に行きました。 売っている箱は以下の $ 3 $ 種類です。

- $ R $ 個のボールが入った赤色の箱
- $ G $ 個のボールが入った緑色の箱
- $ B $ 個のボールが入った青色の箱

すぬけ君は赤色の箱を $ r $ 個、緑色の箱を $ g $ 個、青色の箱を $ b $ 個買うことで合計でちょうど $ N $ 個のボールが手に入るようにしたいです。 これを達成する非負整数の組 $ (r,g,b) $ はいくつありますか？

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ R $ $ G $ $ B $ $ N $

## 输出格式

答えを出力せよ。

## 说明/提示

### 制約

- 入力は全て整数
- $ 1\ \leq\ R,G,B,N\ \leq\ 3000 $

### Sample Explanation 1

条件を満たすのは以下の $ 4 $ 通りです。 - $ (4,0,0) $ - $ (2,1,0) $ - $ (1,0,1) $ - $ (0,2,0) $

## 样例 #1

### 输入

```
1 2 3 4
```

### 输出

```
4
```

## 样例 #2

### 输入

```
13 1 4 3000
```

### 输出

```
87058
```



---

---
title: "ドーナツの体積"
layout: "post"
diff: 普及-
pid: AT_donuts_2015_1
tag: []
---

# ドーナツの体積

## 题目描述

[problemUrl]: https://atcoder.jp/contests/donuts-2015/tasks/donuts_2015_1

問題設定に不備がありました．また，R&gt;Dであるようなテストケースが存在していました．R＜Dという制約を問題に付け加え，テストケースの修正作業を行います．作業が完了次第リジャッジを行います．(19:14)

リジャッジが完了しました．(19:21)

ドーナツの体積を計算してみましょう。

平面図形をある直線を軸に回転させてできる立体の体積は、

- 「平面図形の面積」$ \times $「平面図形の重心が描く円の周長」

という式で求めることができます。

半径 $ R $ の円を、円の中心からの距離が $ D $ である直線を軸に回転させてできるドーナツ型の立体の体積を計算してください。

 ![](https://cdn.luogu.com.cn/upload/vjudge_pic/AT_donuts_2015_1/eeff4bda71c040930852a2e4a36e378f8d49d232.png)![](https://cdn.luogu.com.cn/upload/vjudge_pic/AT_donuts_2015_1/78ff6ecb28a3aa650ce7bb2df4d3ea4e7275c051.png)

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ R $ $ D $

- $ 1 $ 行目には、$ 2 $ つの整数 $ R\ (1\ ≦\ R\ ≦\ 100), $ D (R ＜ D ≦ 100) が空白区切りで与えられる。これは、問題文中の通りの変数である。

## 输出格式

半径が $ R $ の円を、円の中心からの距離が $ D $ である直線を軸に回転させてできる立体の体積を $ 1 $ 行に出力せよ。小数点以下何桁でも出力してよいが、$ 10^{−2} $ を超える絶対誤差を含んではならない。出力の末尾に改行を入れること。

## 说明/提示

### Sample Explanation 1

半径が $ 3 $ の円を、円の中心からの距離が $ 5 $ である直線を軸に回転させてできる立体の体積を出力すれば良いです。 「平面図形の面積」は $ 3^2\ \times\ π $ で、「平面図形の重心が描く円の周長」は $ 5\ \times\ 2\ \times\ π $ なので、体積は $ 90\ \times\ π^2 $ となります。 円の重心は中心であることに注意してください。

## 样例 #1

### 输入

```
3 5
```

### 输出

```
888.264396
```

## 样例 #2

### 输入

```
46 96
```

### 输出

```
4009743.9192393753
```



---

---
title: "ソーシャルゲーム"
layout: "post"
diff: 普及-
pid: AT_donuts_live2014_3
tag: []
---

# ソーシャルゲーム

## 题目描述

[problemUrl]: https://atcoder.jp/contests/donuts-live2014/tasks/donuts_live2014_3

ソーシャルゲームを運営するためには、日々のユーザ数の増減を観察することが欠かせません。

ゲーム会社を運営しているパンチくんは、最もユーザが増加した期間に、何人ユーザが増加したかを調べようとしています。

日々のユーザの増減数 $ a_1,\ a_2,\ …,\ a_N $ が与えられるので、ユーザ数の増減数が最大となる期間のユーザの増減数を求めて下さい。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ a_1 $ $ a_2 $ ... $ a_N $

- $ 1 $ 行目には、調査対象となる期間の日数 $ N\ (1\ ≦\ N\ ≦\ 100000) $ が与えられる。
- $ 2 $ 行目には、調査対象となる期間の $ i $ 日目のユーザの増減数 $ a_i\ (-1000\ ≦\ a_i\ ≦\ 1000) $ が与えられる。

## 输出格式

ユーザの増減数が最大となる期間（ $ 1 $ 日以上）のユーザ増減数を、 $ 1 $ 行で出力せよ。出力の末尾には改行をいれること。

## 说明/提示

### 部分点

$ 1\ ≦\ N\ ≦\ 3000 $ を満たすテストケースに正解した場合、部分点として $ 40 $ 点が与えられる。

### Sample Explanation 1

$ 3 $ 日目から $ 6 $ 日目までの、 $ (2,\ 3,\ -1,\ 2) $ の増加数 $ 6 $ が最大です。

### Sample Explanation 2

全期間が、ユーザの増減数が最大となる期間となります。

### Sample Explanation 3

出力はマイナスとなることがあります。 出力対象となる期間は $ 1 $ 日以上であることに注意して下さい。

## 样例 #1

### 输入

```
7

3 -4 2 3 -1 2 -1
```

### 输出

```
6
```

## 样例 #2

### 输入

```
3

10 20 30
```

### 输出

```
60
```

## 样例 #3

### 输入

```
3

-4 -2 -5
```

### 输出

```
-2
```



---

---
title: "Frog 1"
layout: "post"
diff: 普及-
pid: AT_dp_a
tag: []
---

# Frog 1

## 题目描述

[problemUrl]: https://atcoder.jp/contests/dp/tasks/dp_a

$ N $ 個の足場があります。 足場には $ 1,\ 2,\ \ldots,\ N $ と番号が振られています。 各 $ i $ ($ 1\ \leq\ i\ \leq\ N $) について、足場 $ i $ の高さは $ h_i $ です。

最初、足場 $ 1 $ にカエルがいます。 カエルは次の行動を何回か繰り返し、足場 $ N $ まで辿り着こうとしています。

- 足場 $ i $ にいるとき、足場 $ i\ +\ 1 $ または $ i\ +\ 2 $ へジャンプする。 このとき、ジャンプ先の足場を $ j $ とすると、コスト $ |h_i\ -\ h_j| $ を支払う。

カエルが足場 $ N $ に辿り着くまでに支払うコストの総和の最小値を求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ h_1 $ $ h_2 $ $ \ldots $ $ h_N $

## 输出格式

カエルが支払うコストの総和の最小値を出力せよ。

## 说明/提示

### 制約

- 入力はすべて整数である。
- $ 2\ \leq\ N\ \leq\ 10^5 $
- $ 1\ \leq\ h_i\ \leq\ 10^4 $

### Sample Explanation 1

足場 $ 1 $ → $ 2 $ → $ 4 $ と移動すると、コストの総和は $ |10\ -\ 30|\ +\ |30\ -\ 20|\ =\ 30 $ となります。

### Sample Explanation 2

足場 $ 1 $ → $ 2 $ と移動すると、コストの総和は $ |10\ -\ 10|\ =\ 0 $ となります。

### Sample Explanation 3

足場 $ 1 $ → $ 3 $ → $ 5 $ → $ 6 $ と移動すると、コストの総和は $ |30\ -\ 60|\ +\ |60\ -\ 60|\ +\ |60\ -\ 50|\ =\ 40 $ となります。

## 样例 #1

### 输入

```
4

10 30 40 20
```

### 输出

```
30
```

## 样例 #2

### 输入

```
2

10 10
```

### 输出

```
0
```

## 样例 #3

### 输入

```
6

30 10 60 10 60 50
```

### 输出

```
40
```



---

---
title: "Frog 2"
layout: "post"
diff: 普及-
pid: AT_dp_b
tag: []
---

# Frog 2

## 题目描述

[problemUrl]: https://atcoder.jp/contests/dp/tasks/dp_b

$ N $ 個の足場があります。 足場には $ 1,\ 2,\ \ldots,\ N $ と番号が振られています。 各 $ i $ ($ 1\ \leq\ i\ \leq\ N $) について、足場 $ i $ の高さは $ h_i $ です。

最初、足場 $ 1 $ にカエルがいます。 カエルは次の行動を何回か繰り返し、足場 $ N $ まで辿り着こうとしています。

- 足場 $ i $ にいるとき、足場 $ i\ +\ 1,\ i\ +\ 2,\ \ldots,\ i\ +\ K $ のどれかへジャンプする。 このとき、ジャンプ先の足場を $ j $ とすると、コスト $ |h_i\ -\ h_j| $ を支払う。

カエルが足場 $ N $ に辿り着くまでに支払うコストの総和の最小値を求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ K $ $ h_1 $ $ h_2 $ $ \ldots $ $ h_N $

## 输出格式

カエルが支払うコストの総和の最小値を出力せよ。

## 说明/提示

### 制約

- 入力はすべて整数である。
- $ 2\ \leq\ N\ \leq\ 10^5 $
- $ 1\ \leq\ K\ \leq\ 100 $
- $ 1\ \leq\ h_i\ \leq\ 10^4 $

### Sample Explanation 1

足場 $ 1 $ → $ 2 $ → $ 5 $ と移動すると、コストの総和は $ |10\ -\ 30|\ +\ |30\ -\ 20|\ =\ 30 $ となります。

### Sample Explanation 2

足場 $ 1 $ → $ 2 $ → $ 3 $ と移動すると、コストの総和は $ |10\ -\ 20|\ +\ |20\ -\ 10|\ =\ 20 $ となります。

### Sample Explanation 3

足場 $ 1 $ → $ 2 $ と移動すると、コストの総和は $ |10\ -\ 10|\ =\ 0 $ となります。

### Sample Explanation 4

足場 $ 1 $ → $ 4 $ → $ 8 $ → $ 10 $ と移動すると、コストの総和は $ |40\ -\ 70|\ +\ |70\ -\ 70|\ +\ |70\ -\ 60|\ =\ 40 $ となります。

## 样例 #1

### 输入

```
5 3

10 30 40 50 20
```

### 输出

```
30
```

## 样例 #2

### 输入

```
3 1

10 20 10
```

### 输出

```
20
```

## 样例 #3

### 输入

```
2 100

10 10
```

### 输出

```
0
```

## 样例 #4

### 输入

```
10 4

40 10 20 70 80 10 20 70 80 60
```

### 输出

```
40
```



---

---
title: "Grid 1"
layout: "post"
diff: 普及-
pid: AT_dp_h
tag: []
---

# Grid 1

## 题目描述

[problemUrl]: https://atcoder.jp/contests/dp/tasks/dp_h

縦 $ H $ 行、横 $ W $ 列のグリッドがあります。 上から $ i $ 行目、左から $ j $ 列目のマスを $ (i,\ j) $ で表します。

各 $ i,\ j $ ($ 1\ \leq\ i\ \leq\ H $, $ 1\ \leq\ j\ \leq\ W $) について、マス $ (i,\ j) $ の情報が文字 $ a_{i,\ j} $ によって与えられます。 $ a_{i,\ j} $ が `.` ならばマス $ (i,\ j) $ は空マスであり、$ a_{i,\ j} $ が `#` ならばマス $ (i,\ j) $ は壁のマスです。 マス $ (1,\ 1) $ および $ (H,\ W) $ は空マスであることが保証されています。

太郎君は、マス $ (1,\ 1) $ から出発し、右または下に隣り合う空マスへの移動を繰り返すことで、マス $ (H,\ W) $ まで辿り着こうとしています。

マス $ (1,\ 1) $ から $ (H,\ W) $ までの太郎君の経路は何通りでしょうか？ 答えは非常に大きくなりうるので、$ 10^9\ +\ 7 $ で割った余りを求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ H $ $ W $ $ a_{1,\ 1} $$ \ldots $$ a_{1,\ W} $ $ : $ $ a_{H,\ 1} $$ \ldots $$ a_{H,\ W} $

## 输出格式

マス $ (1,\ 1) $ から $ (H,\ W) $ までの太郎君の経路は何通りか？ $ 10^9\ +\ 7 $ で割った余りを出力せよ。

## 说明/提示

### 制約

- $ H $ および $ W $ は整数である。
- $ 2\ \leq\ H,\ W\ \leq\ 1000 $
- $ a_{i,\ j} $ は `.` または `#` である。
- マス $ (1,\ 1) $ および $ (H,\ W) $ は空マスである。

### Sample Explanation 1

経路は次図の $ 3 $ 通りです。 !\[\](https://img.atcoder.jp/dp/grid\_0\_0\_muffet.png)

### Sample Explanation 2

経路が存在しない場合もあります。

### Sample Explanation 4

答えを $ 10^9\ +\ 7 $ で割った余りを出力することを忘れずに。

## 样例 #1

### 输入

```
3 4

...#

.#..

....
```

### 输出

```
3
```

## 样例 #2

### 输入

```
5 2

..

#.

..

.#

..
```

### 输出

```
0
```

## 样例 #3

### 输入

```
5 5

..#..

.....

#...#

.....

..#..
```

### 输出

```
24
```

## 样例 #4

### 输入

```
20 20

....................

....................

....................

....................

....................

....................

....................

....................

....................

....................

....................

....................

....................

....................

....................

....................

....................

....................

....................

....................
```

### 输出

```
345263555
```



---

---
title: "2525文字列分解"
layout: "post"
diff: 普及-
pid: AT_dwacon2018_prelims_b
tag: []
---

# 2525文字列分解

## 题目描述

[problemUrl]: https://atcoder.jp/contests/dwacon2018-prelims/tasks/dwacon2018_prelims_b

dwango社員のニワンゴくんは2525SNSという新しいSNSを開発しています。 2525SNSは2525文字列のみ投稿可能な画期的なSNSです。

この問題において、`25` の $ 1 $ 回以上の繰り返しで表される文字列を2525文字列と呼びます。 例えば、`25`,`2525`,`2525252525252525` などは2525文字列ですが、空文字列や `2255`,`2552`,`252` などは2525文字列ではありません。

まず、ニワンゴくんは2525文字列をいくつか作ることにしました。 ニワンゴくんは手元にあった文字列 $ s $ を $ 1 $ つ以上の部分列に分解し、分解された部分列それぞれが2525文字列となるようにしたいです。

最小でいくつの部分列に分解すればこれを達成可能ですか？どのように分解しても達成不可能な場合は `-1` を出力してください。分解についてはサンプル $ 1 $ の説明も参照してください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ s $

## 输出格式

答えを出力せよ。

## 说明/提示

### 制約

- $ 1\ \leq\ |s|\ \leq\ 2{,}525 $
- $ s $ は `2` と `5` のみからなる

### Sample Explanation 1

\- $ 1 $ つの部分列に分解した場合、`225525` は2525文字列ではないため条件を満たしません。 - その他の分解としては例えば $ ( $`25`,`2525`$ ) $ となるような分解と $ ( $`25`,`25`,`25`$ ) $ となるような分解が考えられます。それぞれについて正しい分解の例とそうでない例を示します。各部分列内において、$ s $ における相対的な出現順序が守られるように分解する必要があることに注意してください。 - $ ( $`25`,`2525`$ ) $ となるように $ 2 $ つの部分列に分解することで、それぞれの部分列が2525文字列となるように分解できます。 !\[062c9a95edb82917811ef52962f98a3e.png\](https://img.atcoder.jp/dwacon2018-prelims/062c9a95edb82917811ef52962f98a3e.png)

### Sample Explanation 2

\- 分解方法は $ 2 $ 通りありますが、それぞれの部分列が2525文字列となるように分解することはできません。 - `5` と `2` に分解したのち、それぞれの順序を入れ替えて `25` を作ることは不可能なことに注意してください。

## 样例 #1

### 输入

```
225525
```

### 输出

```
2
```

## 样例 #2

### 输入

```
52
```

### 输出

```
-1
```

## 样例 #3

### 输入

```
2255252252222555552522255255
```

### 输出

```
5
```

## 样例 #4

### 输入

```
25252
```

### 输出

```
-1
```



---

---
title: "ニコニコ文字列"
layout: "post"
diff: 普及-
pid: AT_dwango2015_prelims_2
tag: []
---

# ニコニコ文字列

## 题目描述

[problemUrl]: https://atcoder.jp/contests/dwango2015-prelims/tasks/dwango2015_prelims_2

$ 0 $ から $ 9 $ の数字から成る文字列 $ S $ が与えられます。

ある文字列 $ X $ について、$ X=&quot;25&quot; $ または $ X=&quot;2525&quot; $ または $ X=&quot;252525&quot; $ …… というふうに $ &quot;25&quot; $ を何回か繰り返した文字列になっているとき、$ X $ はニコニコ文字列であるといいます。 たとえば $ &quot;25&quot; $ や $ &quot;25252525&quot; $ はニコニコ文字列ですが、$ &quot;123&quot; $ や $ &quot;225&quot; $ はニコニコ文字列ではありません。

あなたの仕事は、文字列 $ S $ について、ニコニコ文字列となるような連続した部分文字列の取り出し方が何通りあるかを答えることです。 文字列として同じであっても、取り出し位置が異なっていれば別々に数えます。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ S $

- $ 1 $ 行目には、文字列 $ S $ が与えられる。$ S $の長さは $ 1 $ 以上 $ 100,000 $ 以下である。また、$ S $ の各文字は $ 0 $ から $ 9 $ の数字のみから成る。

## 输出格式

$ 1 $ 行目には、文字列 $ S $ からニコニコ文字列となるような連続した部分文字列を取り出す方法が何通りあるかを出力せよ。

 **行末の改行を忘れると不正解と判定されるので注意すること。**

## 说明/提示

### 部分点

この問題には部分点が設定されています。

$ N≦2000 $ を満たすデータセット $ 1 $ にすべて正解すると、$ 30 $ 点が得られます。 追加制約のないデータセット 2 にすべて正解すると、上記のデータセットに加えてさらに $ 70 $ 点が得られ、全体で $ 100 $ 点が得られます。

### Sample Explanation 1

$ S=&quot;2525&quot; $のケースです。部分文字列が $ &quot;25&quot; $ となる取り出し方が $ 2 $ 通り、$ &quot;2525&quot; $ となる取り出し方が $ 1 $ 通りあるので合計 $ 3 $ 通りを出力します。

## 样例 #1

### 输入

```
2525
```

### 输出

```
3
```

## 样例 #2

### 输入

```
1251251252525
```

### 输出

```
8
```

## 样例 #3

### 输入

```
25225
```

### 输出

```
2
```

## 样例 #4

### 输入

```
252252252252252252
```

### 输出

```
6
```

## 样例 #5

### 输入

```
20061212
```

### 输出

```
0
```



---

---
title: "積み鉛筆"
layout: "post"
diff: 普及-
pid: AT_dwango2016qual_b
tag: []
---

# 積み鉛筆

## 题目描述

有一堆铅笔，被叠成两层，每支铅笔上都有编号，第$ i $层第$ j $支铅笔的编号为$ K_{j} $,$ K_{j} $是第$ i-1 $层中$ K_{j} $与$ K_{j+1} $中的最大值，现在我们得知了第二层的铅笔数量和第一层的铅笔编号，请构造出第二层铅笔的编号。

## 输入格式

第一行一个$ N $（$ 2 \le N \le 10^{5} $）表示第二层的铅笔数量，第二行$ N-1 $个整数$ K_{i} $（$ 1 \le K_{i} \le 10^{9} $）（$ 1 \le i \le N $），表示第一层铅笔编号

## 输出格式

一行$ N $个整数，表示第二层铅笔编号

## 样例 #1

### 输入

```
4

3 5 5
```

### 输出

```
1 3 5 4
```

## 样例 #2

### 输入

```
6

4 8 8 2 5
```

### 输出

```
4 4 8 2 2 5
```

## 样例 #3

### 输入

```
5

1 2 3 4
```

### 输出

```
1 1 2 3 4
```



---

---
title: "役人"
layout: "post"
diff: 普及-
pid: AT_geocon2013_a
tag: []
---

# 役人

## 题目描述

[problemUrl]: https://atcoder.jp/contests/geocon2013/tasks/geocon2013_a

 あなたは、川と緑に囲まれた小さいながらも豊かな王国の役人です。  
 この国では敷地の境界線をきちんと決めていなかったため土地の所有権をめぐる争いが絶えませんでした。  
 新しい王からこの問題を解決するように指示されたあなたは敷地の境界線を決めることにしました。

 あなたが担当している地域に大きめの木が300本あったのでこれを目印にすることにしました。  
 それぞれの敷地は3つの木を選んでできる三角形の形をしています。  
 王国の住人はプライバシーに気を使うので敷地の境界が少しも触れていないようにする必要があります。  
 すなわち、敷地の境界線を共有していたり、敷地の角を共有していてはいけません。  
 もちろん、敷地が重なることがあってはなりません。  
 この条件を満たしつつ敷地の数を最大化しましょう。

 入力は以下の形式で標準入力から与えられる。 > $ X1\ Y1 $ $ X2\ Y2 $ $ ... $ $ X300\ Y300 $

- $ i $ 番目の木の座標を表す整数 $ Xi\ Yi\ (1\ ≦\ i\ ≦\ 300\ ,\ -1000\ ≦\ Xi,Yi\ ≦\ 1000) $ が空白区切りで $ 300 $ 行与えられる。
- ただし、3本の木が一直線上に並ぶことはない。
 
 出力は以下の形式で標準出力から出力すること。 > $ N $ $ p1,1\ p1,2\ p1,3 $ $ p2,1\ p2,2\ p2,3 $ $ ... $ $ pN,1\ pN,2\ pN,3 $

- 1行目には境界を決めた敷地の数 $ N $ を出力すること。
- 2行目からN+1行目にはそれぞれの敷地を決めるのに使った3本の木の番号を空白区切りで出力すること。ただし、木の番号とは入力で与えられる順番のことであり、1〜300である。
- 各行の最後には改行を出力すること。

 この問題の点数は決めた敷地の数 $ N $ によって計算されます。  
 各テストケースについて $ N\ /\ 100 $ が点数になります。  
 ただし出力が制約を満たさない場合、そのテストケースについての点数は $ 0 $ になります。  
 テストケースは100ケースあります。

 ```

-724 -666
849 411
820 769
-86 -961
972 530
-735 412
254 -106
-460 146
-221 -816
776 -979
549 -469
117 59
-442 587
199 -95
-664 -303
-376 340
-169 248
-53 496
332 -875
763 833
510 -758
-219 306
933 -192
860 467
75 -89
-697 346
912 -194
450 436
426 215
-737 285
479 -440
98 -759
-493 95
646 -126
-343 742
-573 45
-930 -511
-681 -439
538 -293
-698 198
-519 855
238 -48
-46 -815
70 -896
-15 464
-534 -921
-573 -448
922 -706
-434 -466
-171 989
205 538
168 -538
429 292
-871 -510
739 -829
-423 -384
498 43
-501 -589
894 -910
-757 -238
531 326
390 -82
763 -858
334 659
-972 409
-723 -182
395 -551
-485 580
-654 214
-515 -646
-541 -852
-305 -84
742 145
507 833
332 870
847 635
992 -329
3 -614
-654 390
-261 -590
868 882
834 -417
50 -149
-801 -341
-898 -887
-93 -427
850 -508
59 -109
-321 -627
724 876
360 621
-433 312
-190 -266
641 -914
581 -541
448 946
-230 605
-472 510
577 -559
-416 -253
594 53
-734 990
192 -744
-828 -148
-94 -402
-464 -779
132 -81
914 -952
-60 -976
-65 -556
-107 -677
-895 -163
-450 611
474 468
-722 888
-971 481
-15 -359
30 -879
813 -775
-441 -72
834 798
693 -308
762 460
809 12
71 709
375 -115
-528 52
341 529
248 414
914 -103
-223 -62
999 -300
641 743
835 892
477 78
825 -232
-636 -81
-696 -286
-677 721
-209 -797
-971 66
-610 264
812 773
-740 578
129 -177
-59 940
86 -613
-580 921
-820 -679
-812 238
315 -225
777 206
338 -549
-244 385
502 887
-344 487
997 -82
919 -963
-78 932
602 227
762 705
486 281
-105 -10
937 -571
116 152
838 140
-746 -984
783 417
-161 -685
-641 129
69 351
982 153
-780 5
405 184
-122 237
116 -147
643 626
-676 -763
264 644
-696 -944
823 923
500 -373
290 -386
-622 738
-137 -555
-604 -613
-873 732
170 905
-247 -118
124 657
389 292
-108 791
494 -758
-129 745
170 -568
212 120
-148 52
-302 -991
26 -237
-114 -361
485 43
-376 1000
668 -570
-99 -818
610 -74
-133 -457
-553 -178
-467 -465
-93 -270
-384 586
-321 -780
598 -890
261 724
-902 -152
645 994
-767 61
-693 70
-383 -211
990 632
404 -975
263 -853
-470 -654
621 965
-144 -595
-755 554
-917 -386
202 497
-712 260
-526 89
-464 -990
-352 -513
-116 754
708 356
-623 -642
860 -915
28 -205
-21 824
-539 -333
391 741
205 -77
524 -380
858 -483
965 -799
-744 -79
248 15
-962 -571
-938 243
-420 -484
-883 851
18 -700
211 660
694 122
877 390
188 -154
676 -33
259 957
378 -142
624 -860
-855 864
771 -969
601 29
-140 -241
154 384
933 619
-555 732
-368 -299
128 487
-318 220
-964 -175
-994 -573
910 36
497 88
-230 -535
963 683
-714 -150
-835 -151
569 506
-525 -339
896 570
802 497
508 908
-105 570
-625 -383
-786 517
309 118
643 644
649 111
-501 188
-762 317
-250 406
-367 344
-892 568
199 688
54 942
-855 -697
-141 -695
340 -137
-965 -54
442 -108
-729 90
```

 ```

10
81 294 215
89 166 169
158 43 172
3 259 41
293 76 29
84 214 249
284 287 178
270 149 1
171 125 68
299 273 257
```



---

---
title: "Neq Min"
layout: "post"
diff: 普及-
pid: AT_hhkb2020_c
tag: []
---

# Neq Min

## 题目描述

给定一个长为 $n$ 的整数序列 $p$。对于每一个满足 $1 \le i \le n$ 的整数 $i$，你需要求出：没有在 $p$ 的前 $i$ 个数中出现的最小自然数是多少？

## 输入格式

第一行输入数列长度 $n$。

第二行输入 $n$ 个整数，表示数列 $p$。

## 输出格式

$n$ 行，第 $i$ 行输出的整数为 $p$ 的前 $i$ 个数中未出现的最小自然数。

## 说明/提示

#### 数据规模与约定

$1 \le n \le 200000$，$0 \le p_i \le 200000$。

## 样例 #1

### 输入

```
4

1 1 0 2
```

### 输出

```
0

0

2

3
```

## 样例 #2

### 输入

```
10

5 4 3 2 1 0 7 7 6 6
```

### 输出

```
0

0

0

0

0

6

6

6

8

8
```



---

---
title: "Nice Shopping"
layout: "post"
diff: 普及-
pid: AT_hitachi2020_b
tag: []
---

# Nice Shopping

## 题目描述

[problemUrl]: https://atcoder.jp/contests/hitachi2020/tasks/hitachi2020_b

あなたは、冷蔵庫と電子レンジを買うために、とある家電量販店に来ました。

この家電量販店では、 $ A $ 種類の冷蔵庫と $ B $ 種類の電子レンジが販売されています。 $ i $ 番目( $ 1\ \le\ i\ \le\ A $ )の冷蔵庫の値段は $ a_i $ 円であり、 $ j $ 番目( $ 1\ \le\ j\ \le\ B $ )の電子レンジの値段は $ b_j $ 円です。

また、あなたは $ M $ 種類の割引券を所持しており、 $ i $ 番目 ( $ 1\ \le\ i\ \le\ M $ )の割引券では、 $ x_i $ 番目の冷蔵庫 と $ y_i $ 番目の電子レンジを同時に買うと、 支払総額が $ c_i $ 円安くなります。ただし、複数の割引券を同時に使うことはできません。

さて、あなたは冷蔵庫と電子レンジをちょうど $ 1 $ 台ずつ買おうと思っています。かかる金額の最小値を求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ A $ $ B $ $ M $ $ a_1 $ $ a_2 $ $ ... $ $ a_A $ $ b_1 $ $ b_2 $ $ ... $ $ b_B $ $ x_1 $ $ y_1 $ $ c_1 $ $ \vdots $ $ x_M $ $ y_M $ $ c_M $

## 输出格式

答えを出力せよ。

## 说明/提示

### 制約

- 入力は全て整数
- $ 1\ \le\ A\ \le\ 10^5 $
- $ 1\ \le\ B\ \le\ 10^5 $
- $ 1\ \le\ M\ \le\ 10^5 $
- $ 1\ \le\ a_i\ ,\ b_i\ ,\ c_i\ \le\ 10^5 $
- $ 1\ \le\ x_i\ \le\ A $
- $ 1\ \le\ y_i\ \le\ B $
- $ c_i\ \le\ a_{x_i}\ +\ b_{y_i} $

### Sample Explanation 1

$ 1 $ 番目の冷蔵庫と $ 2 $ 番目の電子レンジを買うと、割引券の効果により $ 3+3-1=5 $ 円になります。

### Sample Explanation 2

複数の割引券を同時に使うことはできないことに注意してください。

### Sample Explanation 3

この場合は $ 1 $ 番目の冷蔵庫と $ 1 $ 番目の電子レンジを買うと $ 6 $ 円になり、これが最小です。 割引券は使わなくてもよいことに注意してください。

## 样例 #1

### 输入

```
2 3 1

3 3

3 3 3

1 2 1
```

### 输出

```
5
```

## 样例 #2

### 输入

```
1 1 2

10

10

1 1 5

1 1 10
```

### 输出

```
10
```

## 样例 #3

### 输入

```
2 2 1

3 5

3 5

2 2 2
```

### 输出

```
6
```



---

---
title: "North North West"
layout: "post"
diff: 普及-
pid: AT_icpc2014autumn_a
tag: []
---

# North North West

## 题目描述

[problemUrl]: https://atcoder.jp/contests/jag2014autumn/tasks/icpc2014autumn_a





---

---
title: "Change a Password"
layout: "post"
diff: 普及-
pid: AT_icpc2015autumn_b
tag: []
---

# Change a Password

## 题目描述

JAG 办公室的密码是一个由 $N$ 位数字组成的，会定期更改。密码修改规则如下。

1. 新密码的位数与旧密码的位数一样，均为 $N$ 位。同时，新密码的每一个数字最多出现 $1$ 次（旧密码可能存在重复的数字）。
2. 在上述约束下，使得新密码与旧密码的差异最大化（密码之间的差异的定义如下所述）。
3. 如果有两个或两个以上的新密码符合条件，选择最小的密码。

两个密码 $a,b$ 之间的差异是至指 $\min(\vert a-b\vert ,10^{N}-\vert a-b\vert )$，其中 $N$ 为密码的位数。例如，$11$ 和 $42$ 的差异为 $31$，$987$ 和 $012$ 的差异为 $25$。

## 输入格式

一个 $N$ 位的正整数，表示旧密码。请注意，旧密码可能包含重复的数字，并且可能有前导零。

## 输出格式

一个数，表示新密码。

# 输入输出样例
输入 #1：

```
201
```

输出 #1：

```
701
```

输入 #2：

```
512
```

输出 #2：

```
012
```

输入 #3：

```
99999
```

输出 #3：

```
49876
```

输入 #4：

```
765876346
```

输出 #4：

```
265874931
```



---

---
title: "Optimal Recommendations"
layout: "post"
diff: 普及-
pid: AT_indeednow_2015_finala_c
tag: []
---

# Optimal Recommendations

## 题目描述

[problemUrl]: https://atcoder.jp/contests/indeednow-finala-open/tasks/indeednow_2015_finala_c

 求職者と求人会社のマッチングを手助けしている Indeed 社は、求職者に最適な求人を提示するサービスを開発することにした。  
 Indeed 社のデータベースには、独自テストで得られた、各求職者の技術力、語学力、コミュニケーション力が保存されている。  
 またそのデータベースには、各求人会社が応募条件として要求した、それら $ 3 $ つの力の最低限必要な値とその会社の年収も保存されている。  
 データベースのデータがすべて与えられるので、各求職者ごとに、その人が応募可能な会社の中で一番高い年収を示しなさい。

## 输入格式

入力は以下の形式で与えられる。

> $ N $ $ M $ $ a_1 $ $ b_1 $ $ c_1 $ $ w_1 $ $ ... $ $ a_N $ $ b_N $ $ c_N $ $ w_N $ $ x_1 $ $ y_1 $ $ z_1 $ $ ... $ $ x_M $ $ y_M $ $ z_M $

- $ 1 $ 行目には、求人会社数を表す整数 $ N $ ($ 1\ \leq\ N\ \leq\ 50{,}000 $)、求職者数を表す整数 $ M $ ($ 1\ \leq\ M\ \leq\ 50{,}000 $) が与えられる。
- $ 2 $ 行目から続く $ N $ 行には、$ i $ 番目の求人会社が最低限必要としている技術力、語学力、コミュニケーション力を表す整数 $ a_i,\ b_i,\ c_i $ ($ 0\ \leq\ a_i,\ b_i,\ c_i\ \leq\ 100 $) とその会社の年収を表す整数 $ w_i $ ($ 1\ \leq\ w_i\ \leq\ 1{,}000{,}000{,}000 $) が与えられる。
- 続く $ M $ 行には、$ i $ 番目の求職者の技術力、語学力、コミュニケーション力を表す整数 $ x_i,\ y_i,\ z_i $ ($ 0\ \leq\ x_i,\ y_i,\ z_i\ \leq\ 100 $) が与えられる。

## 输出格式

それぞれの求職者に対して、その求職者が応募可能な会社の中で、最も年収が高い会社の年収を一行で出力せよ。

応募可能な会社が存在しない場合は、代わりに `0` を出力せよ。

## 样例 #1

### 输入

```
3 6

1 2 3 3

3 3 3 6

4 4 4 8

3 4 3

4 4 4

100 100 1

2 3 4

0 0 0

100 100 100
```

### 输出

```
6

8

0

3

0

8
```



---

---
title: "高橋くんと文字列操作"
layout: "post"
diff: 普及-
pid: AT_indeednow_2015_qualb_2
tag: []
---

# 高橋くんと文字列操作

## 题目描述

[problemUrl]: https://atcoder.jp/contests/indeednow-qualb/tasks/indeednow_2015_qualb_2

高橋くんは文字列 $ s $ を持っており、文字列 $ t $ を作りたいと思っています。 高橋くんは、文字列の末尾の $ 1 $ 文字を先頭に追加し、末尾の $ 1 $ 文字を削除するという操作を文字列 $ s $ に行うことで、文字列 $ s $ を文字列 $ t $ にしたいと考えています。

最小で何回この操作を行えば、文字列 $ s $ を文字列 $ t $ にできるでしょうか？最小の操作回数を出力するプログラムを書いてください。この操作では文字列 $ s $ を文字列 $ t $ に変換することができない場合、$ -1 $ と出力してください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ s $ $ t $

- $ 1 $ 行目には、高橋くんが持っている文字列 $ s\ (1\ ≦\ \|s\|\ ≦\ 1,000) $ が与えられる。ただし、$ \|s\| $ は文字列 $ s $ の長さを表す。$ s $ は半角小文字アルファベットa-zのみからなる。
- $ 2 $ 行目には、高橋くんが作りたい文字列 $ t\ (1\ ≦\ \|t\|\ ≦\ 1,000) $ が与えられる。$ t $ は半角小文字アルファベットa-zのみからなる。

## 输出格式

$ 1 $ 行目に、高橋くんが文字列 $ s $ を文字列 $ t $ に変換するための操作の最小回数を出力せよ。

行末の改行を忘れないこと。

## 说明/提示

### Sample Explanation 1

`abcd` の末尾の文字を先頭に追加すると、 `dabcd` となり、ここから末尾の文字を削除すると、 `dabc` となります。 よって、$ 1 $ 回の操作で $ s $ は $ t $ に等しくなります。

### Sample Explanation 2

問題文中の操作を $ s $ に $ 2 $ 回行うと $ t $ と等しくなります。 $ 5 $ 回、$ 8 $ 回行っても $ t $ と等しくなりますが、最小のものを求める必要があります。

## 样例 #1

### 输入

```
abcd

dabc
```

### 输出

```
1
```

## 样例 #2

### 输入

```
abcabcabc

bcabcabca
```

### 输出

```
2
```

## 样例 #3

### 输入

```
aaa

a
```

### 输出

```
-1
```

## 样例 #4

### 输入

```
cab

cab
```

### 输出

```
0
```



---

---
title: "肉と肉のぶつかり合い"
layout: "post"
diff: 普及-
pid: AT_iroha2019_day1_d
tag: []
---

# 肉と肉のぶつかり合い

## 题目描述

高桥和青木进行摔跤比赛。比赛规则如下：

- 高桥的战力为 $X$ ，青木的战力为 $Y$ 。

- 双方会从 $N$ 名备选摔跤手中各取得 $N/2$ 人的援军。

- 高桥和青木轮流交替按战力从大到小的顺序选援军，由高桥先选。

- 第 $i$ 名摔跤选手的战力为 $A_i$ ，一方的总战力为他们的首领的战力和援军的战力的总和。

- 战力大的一方获胜。

## 输入格式

输入共两行。

第一行共三个整数，分别是 $N$，$X$，$Y$ 。

第二行共 $N$ 个整数，第 $i$ 个整数为 $A_i$，代表第 $i$ 名摔跤手的战力

## 输出格式

- 高桥获胜输出 ```Takahashi``` 。

- 青木获胜输出 ```Aoki``` 。

- 平局输出 ```Draw``` 。

注：数据保证 $N$ 为偶数。

translated by @[wangyinghao](https://www.luogu.com.cn/user/453759)

## 样例 #1

### 输入

```
2 2 2

3 1
```

### 输出

```
Takahashi
```

## 样例 #2

### 输入

```
2 2 100

3 1
```

### 输出

```
Aoki
```

## 样例 #3

### 输入

```
4 5 5

5 5 5 5
```

### 输出

```
Draw
```



---

---
title: "JOI 2006 本選 問題3"
layout: "post"
diff: 普及-
pid: AT_joi2006ho_c
tag: ['2006', 'JOI（日本）']
---

# JOI 2006 本選 問題3

## 题目描述

[problemUrl]: https://atcoder.jp/contests/joi2006ho/tasks/joi2006ho_c





---

---
title: "通学経路"
layout: "post"
diff: 普及-
pid: AT_joi2007yo_f
tag: []
---

# 通学経路

## 题目描述

[problemUrl]: https://atcoder.jp/contests/joi2007yo/tasks/joi2007yo_f

太郎君の住んでいる JOI 市は，南北方向にまっすぐに伸びる $ a $ 本の道路と，東西方向にまっすぐに伸びる $ b $ 本の道路により，碁盤の目の形に区分けされている．

南北方向の $ a $ 本の道路には，西から順に $ 1,\ 2,\ \ldots,\ a $ の番号が付けられている．また，東西方向の $ b $ 本の道路には，南から順に $ 1,\ 2,\ \ldots,\ b $ の番号が付けられている．西から $ i $ 番目の南北方向の道路と，南から $ j $ 番目の東西方向の道路が交わる交差点を $ (i,\ j) $ で表す．

太郎君は，交差点 ($ 1,\ 1 $) の近くに住んでおり，交差点 ($ a,\ b $) の近くの JOI 高校に自転車で通っている．自転車は道路に沿ってのみ移動することができる．太郎君は，通学時間を短くするため，東または北にのみ向かって移動して通学している．

現在，JOI 市では，$ n $ 個の交差点 $ (x_1,\ y_1),\ (x_2,\ y_2),\ \ldots,\ (x_n,\ y_n) $ で工事を行っている．太郎君は工事中の交差点を通ることができない．

太郎君が交差点 $ (1,\ 1) $ から交差点 $ (a,\ b) $ まで，工事中の交差点を避けながら，東または北にのみ向かって移動して通学する方法は何通りあるだろうか．太郎君の通学経路の個数 $ m $ を求めるプログラムを作成せよ．

- - - - - -

## 输入格式

入力の $ 1 $ 行目には，空白を区切りとして $ 2 $ 個の整数 $ a,\ b $ が書かれている．これは，南北方向の道路の本数と，東西方向の道路の本数を表す．$ a,\ b $ は $ 1\ \leqq\ a,\ b\ \leqq\ 16 $ をみたす．

$ 2 $ 行目には, 工事中の交差点の個数を表す整数 $ n $ が書かれている．$ n $ は $ 1\ \leqq\ n\ \leqq\ 40 $ をみたす．

続く $ n $ 行 ($ 3 $ 行目から $ n\ +\ 2 $ 行目) には，工事中の交差点の位置が書かれている．$ i\ +\ 2 $ 行目には空白で区切られた整数 $ x_i,\ y_i $ が書かれており，交差点 $ (x_i,\ y_i) $ が工事中であることを表す．$ x_i,\ y_i $ は $ 1\ \leqq\ x_i,\ y_i\ \leqq\ 16 $ をみたす．

## 输出格式

出力は，太郎君の通学経路の個数 $ m $ だけを含む $ 1 $ 行からなる．

- - - - - -

## 说明/提示

### Sample Explanation 1

下図は $ a\ =\ 5,\ b\ =\ 4,\ n\ =\ 3 $ で，工事中の交差点が $ (2,\ 2),\ (2,\ 3),\ (4,\ 2) $ の場合を表している． !\[route-fig1.png\](https://img.atcoder.jp/joi2007yo/route-fig1.png) この場合，通学経路は $ m\ =\ 5 $ 通りある．$ 5 $ 通りの通学経路を全て図示すると，以下の通り． !\[route-fig2.png\](https://img.atcoder.jp/joi2007yo/route-fig2.png)

## 样例 #1

### 输入

```
5 4
3
2 2
2 3
4 2
```

### 输出

```
5
```



---

---
title: "気象予報士 (Weather Forecaster)"
layout: "post"
diff: 普及-
pid: AT_joi2015yo_c
tag: []
---

# 気象予報士 (Weather Forecaster)

## 题目描述

[problemUrl]: https://atcoder.jp/contests/joi2015yo/tasks/joi2015yo_c

JOI 市は南北方向に $ H $ キロメートル，東西方向に $ W $ キロメートルの長方形の形をしており，$ H\ \times\ W $ 個の $ 1 $ キロメートル四方の小区画に区切られている．北から $ i $ 番目，西から $ j $ 番目の小区画を $ (i,\ j) $ と表す．

各小区画は上空に雲があるか雲がないかのどちらかである．すべての雲は，$ 1 $ 分経つごとに $ 1 $ キロメートル東に移動する．今日は実に天気が良いため，JOI 市の外から JOI 市内に雲が移動してくることはない．

今，各小区画の上空に雲があるかないかがわかっている．気象予報士であるあなたは，各小区画について，今から何分後に初めてその小区画の上空に雲が来るかを予測することになった．

各小区画について，今から何分後に初めてその小区画の上空に雲が来るか求めよ．

- - - - - -

## 输入格式

入力は $ 1\ +\ H $ 行からなる．

$ 1 $ 行目には，整数 $ H,\ W $ ($ 1\ \leqq\ H\ \leqq\ 100 $，$ 1\ \leqq\ W\ \leqq\ 100 $) が空白を区切りとして書かれている．これは，JOI 市が $ H\ \times\ W $ 個の $ 1 $ キロメートル四方の小区画に区切られていることを表す．

続く $ H $ 行のうちの $ i $ 行目 ($ 1\ \leqq\ i\ \leqq\ H $) には $ W $ 文字からなる文字列が書かれている．$ W $ 文字のうちの $ j $ 文字目 ($ 1\ \leqq\ j\ \leqq\ W $) は，小区画 $ (i,\ j) $ の上空に，今，雲があるかどうかを表す．雲がある場合は文字 `c` (英小文字) が，雲がない場合は文字 `.` (ピリオド) が書かれている．

## 输出格式

出力は $ H $ 行からなり，それぞれの行は空白を区切りとした $ W $ 個の整数からなる．出力の $ i $ 行目の $ j $ 番目の整数 ($ 1\ \leqq\ i\ \leqq\ H $，$ 1\ \leqq\ j\ \leqq\ W $) は，今から何分後に初めて小区画 $ (i,\ j) $ の上空に雲が来るかを表さなければならない．ただし，今すでに小区画 $ (i,\ j) $ の上空に雲がある場合は $ 0 $ を，何分経っても小区画 $ (i,\ j) $ の上空に雲が来ない場合は $ -1 $ を出力せよ．

出力の各行の行頭と行末には余計な空白を入れないこと．

- - - - - -

## 说明/提示

### Sample Explanation 1

入出力例 $ 1 $ では，JOI 市は $ 3\ \times\ 4 $ 個の小区画に区切られている．今の JOI 市の雲の状況は以下の通りである．図の上が北を表す． !\[2015-yo-t3-fig01.png\](https://img.atcoder.jp/joi2015yo/2015-yo-t3-fig01.png) この後，$ 1 $ 分ごとに雲は以下のように移動する． !\[2015-yo-t3-fig02.png\](https://img.atcoder.jp/joi2015yo/2015-yo-t3-fig02.png) !\[2015-yo-t3-fig03.png\](https://img.atcoder.jp/joi2015yo/2015-yo-t3-fig03.png) !\[2015-yo-t3-fig04.png\](https://img.atcoder.jp/joi2015yo/2015-yo-t3-fig04.png) - - - - - -

## 样例 #1

### 输入

```
3 4
c..c
..c.
....
```

### 输出

```
0 1 2 0
-1 -1 0 1
-1 -1 -1 -1
```

## 样例 #2

### 输入

```
6 8
.c......
........
.ccc..c.
....c...
..c.cc..
....c...
```

### 输出

```
-1 0 1 2 3 4 5 6
-1 -1 -1 -1 -1 -1 -1 -1
-1 0 0 0 1 2 0 1
-1 -1 -1 -1 0 1 2 3
-1 -1 0 1 0 0 1 2
-1 -1 -1 -1 0 1 2 3
```



---

---
title: "マージ (Merge)"
layout: "post"
diff: 普及-
pid: AT_joi2020_yo1a_c
tag: []
---

# マージ (Merge)

## 题目描述

[problemUrl]: https://atcoder.jp/contests/joi2020yo1a/tasks/joi2020_yo1a_c

長さ $ N $ の正整数列 $ A=(A_1,\ A_2,\ \ldots,\ A_N) $ と，長さ $ M $ の正整数列 $ B=(B_1,\ B_2,\ \ldots,\ B_M) $ が与えられる． これらの数列は，共に広義単調増加数列である．つまり，$ A_1\ \leqq\ A_2\ \leqq\ \cdots\ \leqq\ A_N $, $ B_1\ \leqq\ B_2\ \leqq\ \cdots\ \leqq\ B_M $ を満たす．

以下のアルゴリズムを用いて，これらの数列から，長さ $ N+M $ の正整数列 $ C=(C_1,\ C_2,\ \ldots,\ C_{N+M}) $ を生成する．

1. はじめ $ C $ は空とする．
2. $ A $ と $ B $ がどちらも空の場合，終了する．
3. $ A $ と $ B $ のどちらかが空の場合，そうでない数列を $ t $ とおく．どちらも空でない場合，先頭の要素が小さい数列を $ t $ とおく．ただし，$ A $ と $ B $ の先頭の要素が同じ値のときは $ A $ を $ t $ とおく．
4. $ t $ の先頭の要素を $ C $ の末尾に追加する．
5. $ t $ の先頭の要素を削除する．
6. 2. に戻る．

広義単調増加な正整数列 $ A $, $ B $ が与えられたとき，このアルゴリズムにより生成される正整数列 $ C $ を出力するプログラムを作成せよ．

## 输入格式

入力は以下の形式で標準入力から与えられる．

> $ N $ $ M $ $ A_1 $ $ A_2 $ $ \cdots $ $ A_N $ $ B_1 $ $ B_2 $ $ \cdots $ $ B_M $

## 输出格式

標準出力に $ N\ +\ M $ 行出力せよ．

$ k $ 行目 ($ 1\ \leqq\ k\ \leqq\ N\ +\ M $) には，$ C_k $ を出力せよ．

## 说明/提示

### 制約

- $ 1\ \leqq\ N\ \leqq\ 500 $．
- $ 1\ \leqq\ M\ \leqq\ 500 $．
- $ 1\ \leqq\ A_1\ \leqq\ A_2\ \leqq\ \cdots\ \leqq\ A_N\ \leqq\ 2000 $．
- $ 1\ \leqq\ B_1\ \leqq\ B_2\ \leqq\ \cdots\ \leqq\ B_M\ \leqq\ 2000 $．

### Sample Explanation 1

アルゴリズムを行う前，$ A=(1,2),\ B=(2) $ である． 以下のように数列 $ C $ が生成される． - 数列 $ A $ の先頭の要素は $ 1 $，数列 $ B $ の先頭の要素は $ 2 $ なので，数列 $ A $ の先頭の要素を数列 $ C $ に追加しこれを数列 $ A $ から削除する． - 数列 $ A $ の先頭の要素は $ 2 $，数列 $ B $ の先頭の要素は $ 2 $ なので，数列 $ A $ の先頭の要素を数列 $ C $ に追加しこれを数列 $ A $ から削除する． - 数列 $ A $ は空なので，数列 $ B $ の先頭の要素を数列 $ C $ に追加しこれを数列 $ B $ から削除する． - 数列 $ A $ も数列 $ B $ も空なので，アルゴリズムを終了する． アルゴリズムが終了した後，数列 $ C=(1,2,2) $ である．

## 样例 #1

### 输入

```
2 1

1 2

2
```

### 输出

```
1

2

2
```

## 样例 #2

### 输入

```
3 8

1 3 8

3 3 4 5 6 7 8 9
```

### 输出

```
1

3

3

3

4

5

6

7

8

8

9
```



---

---
title: "最長昇順連続部分列 (Longest Ascending Contiguous Subsequence)"
layout: "post"
diff: 普及-
pid: AT_joi2020_yo1c_c
tag: []
---

# 最長昇順連続部分列 (Longest Ascending Contiguous Subsequence)

## 题目描述

[problemUrl]: https://atcoder.jp/contests/joi2020yo1c/tasks/joi2020_yo1c_c

長さ $ N $ の正整数列 $ A=(A_1,\ A_2,\ \ldots,\ A_N) $ が与えられる．正整数列 $ A $ の連続部分列の中で昇順に並んでいるもののうち，最長のものの長さを求めよ．

すなわち，$ A_l\ \leqq\ A_{l+1}\ \leqq\ \cdots\ \leqq\ A_r $ を満たすような $ 2 $ つの整数 $ l,\ r $ ( $ 1\ \leqq\ l\ \leqq\ r\ \leqq\ N $ ) について，$ r-l+1 $ の最大値を求めよ．

## 输入格式

入力は以下の形式で標準入力から与えられる．

> $ N $ $ A_1 $ $ A_2 $ $ \cdots $ $ A_N $

## 输出格式

正整数列 $ A $ の連続部分列の中で昇順に並んでいるもののうち，最長のものの長さを $ 1 $ 行で出力せよ．

## 说明/提示

### 制約

- $ 1\ \leqq\ N\ \leqq\ 100 $．
- $ 1\ \leqq\ A_i\ \leqq\ 2020 $ ($ 1\ \leqq\ i\ \leqq\ N $)．

### Sample Explanation 1

正整数列 $ A $ の $ 4 $ 項目から $ 6 $ 項目までに対応する連続部分列は $ 1,\ 5,\ 9 $ であり，これは昇順である．これより長い昇順な連続部分列は存在しない．

### Sample Explanation 2

正整数列 $ A $ の $ 5 $ 項目から $ 6 $ 項目までに対応する連続部分列は $ 5,\ 5 $ であり，これは昇順である．これより長い昇順な連続部分列は存在しない．

## 样例 #1

### 输入

```
10

3 1 4 1 5 9 2 6 5 3
```

### 输出

```
3
```

## 样例 #2

### 输入

```
10

9 8 7 6 5 5 4 3 2 1
```

### 输出

```
2
```

## 样例 #3

### 输入

```
9

1 2 2 12 120 210 202 1010 2020
```

### 输出

```
6
```



---

---
title: "共通要素 (Common Elements)"
layout: "post"
diff: 普及-
pid: AT_joi2021_yo1a_c
tag: []
---

# 共通要素 (Common Elements)

## 题目描述

[problemUrl]: https://atcoder.jp/contests/joi2021yo1a/tasks/joi2021_yo1a_c

長さ $ N $ の整数列 $ A\ =\ (A_1,\ A_2,\ \ldots,\ A_N) $ と長さ $ M $ の整数列 $ B\ =\ (B_1,\ B_2,\ \ldots,\ B_M) $ が与えられる．$ A $ と $ B $ の両方に出現する整数をすべて，$ 1 $ 個ずつ昇順で出力せよ．

## 输入格式

入力は以下の形式で標準入力から与えられる．

> $ N $ $ M $ $ A_1 $ $ A_2 $ $ \ldots $ $ A_N $ $ B_1 $ $ B_2 $ $ \ldots $ $ B_M $

## 输出格式

$ A $ と $ B $ の両方に出現する整数をすべて，$ 1 $ 個ずつ昇順で出力せよ．各整数は改行で区切ること．

## 说明/提示

### 制約

- $ 1\ \leqq\ N\ \leqq\ 100 $．
- $ 1\ \leqq\ M\ \leqq\ 100 $．
- $ 1\ \leqq\ A_i\ \leqq\ 100 $ ($ 1\ \leqq\ i\ \leqq\ N $)．
- $ 1\ \leqq\ B_j\ \leqq\ 100 $ ($ 1\ \leqq\ j\ \leqq\ M $)．

### Sample Explanation 1

$ 6 $ は $ A $ の $ 3 $ 番目，$ B $ の $ 4 $ 番目に出現する．また，$ 12 $ は $ A $ の $ 6 $ 番目，$ B $ の $ 2 $ 番目に出現する．$ 6 $ と $ 12 $ 以外に $ A,\ B $ の両方に出現する整数は存在しない．したがって，$ 6,\ 12 $ を昇順に改行区切りで出力する．

### Sample Explanation 2

$ 100 $ は $ A,\ B $ の両方に出現する．$ 100 $ 以外に $ A,\ B $ に出現する整数は存在しない．したがって，$ 100 $ を出力する．

### Sample Explanation 3

$ A,\ B $ の両方に出現する整数は存在しない．したがって，何も出力しない．

## 样例 #1

### 输入

```
6 5

2 4 6 8 10 12

15 12 9 6 3
```

### 输出

```
6

12
```

## 样例 #2

### 输入

```
3 5

100 100 100

100 100 100 100 100
```

### 输出

```
100
```

## 样例 #3

### 输入

```
1 1

2

5
```

### 输出

```

```

## 样例 #4

### 输入

```
10 10

76 91 98 7 98 7 98 10 63 91

70 71 10 10 91 70 65 10 63 76
```

### 输出

```
10

63

76

91
```



---

---
title: "ショッピングモール (Mall)"
layout: "post"
diff: 普及-
pid: AT_joisc2007_mall
tag: []
---

# ショッピングモール (Mall)

## 题目描述

### 题目简述

有一个 $n\times m$ 的网格 $c$，你需要在其中选择一个 $b\times a$ 的长方形（不可旋转），使得它满足：

- 长方形内任何一个格子里的数非负；
- 长方形内所有格子的数之和最小。

求出和的最小值。

## 输入格式

第一行输入两个整数 $m,n$。

第二行输入两个整数 $a,b$。

第三行到第 $(n+2)$ 行，第 $(i+2)$ 行输入 $m$ 个整数，依次表示 $c_{i,1},c_{i,2},...,c_{i,m}$。

保证至少有一个满足条件的长方形。

## 输出格式

一行一个整数，表示最小和。**请在输出末尾换行。**

### 输入输出样例

```
7 6 
3 2
26 29 84 15 -1 1 71
45 14 38 91 62 77 35
68 -1 -1 90 63 56 70
31 2 4 74 72 41 90
100 26 21 -1 44 72 60
71 4 40 93 48 -1 50
```

```
184
```

## 说明/提示

#### 样例 #1 解释

$31+2+4+100+26+21=184$。

### 数据规模与约定

$1\le m,n\le 1000$，$1\le a,b\le 1000$，$-1\le c_{i,j}\le 100$。



---

---
title: "Max GCD 2"
layout: "post"
diff: 普及-
pid: AT_jsc2021_c
tag: []
---

# Max GCD 2

## 题目描述

[problemUrl]: https://atcoder.jp/contests/jsc2021/tasks/jsc2021_c

整数 $ A,\ B $ が与えられます。整数 $ x,\ y $ を $ A\ <\ =\ x\ <\ y\ <\ =\ B $ となるように選ぶときの、$ \gcd(x,\ y) $ の最大値を求めてください。  
 なお、$ \gcd(x,\ y) $ は $ x $ と $ y $ の最大公約数を表します。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ A $ $ B $

## 输出格式

答えを出力せよ。

## 说明/提示

### 制約

- $ A,\ B $ は整数
- $ 1\ <\ =\ A\ <\ B\ <\ =\ 2\ \times\ 10^5 $

### Sample Explanation 1

$ A\ <\ =\ x\ <\ y\ <\ =\ B $ を満たす $ (x,y) $ の選び方は $ (2,3),\ (2,4),\ (3,4) $ の $ 3 $ つです。それぞれ最大公約数は $ 1,\ 2,\ 1 $ であるので、最大値は $ 2 $ です。

### Sample Explanation 2

$ \gcd(199999,\ 200000)\ =\ 1 $ です。

## 样例 #1

### 输入

```
2 4
```

### 输出

```
2
```

## 样例 #2

### 输入

```
199999 200000
```

### 输出

```
1
```

## 样例 #3

### 输入

```
101 139
```

### 输出

```
34
```



---

---
title: "お気に入りの数2(Favorite Number2)"
layout: "post"
diff: 普及-
pid: AT_k2pc001_e5
tag: []
---

# お気に入りの数2(Favorite Number2)

## 题目描述

[problemUrl]: https://atcoder.jp/contests/k2pc-easy/tasks/k2pc001_e5

 $ 2 $ 以上 $ n $ 以下の正整数 $ x $ に対して, 以下の操作が許されている.

- $ x+1 $ が$ n $ 以下のとき, $ x\ +\ 1 $ を新たな $ x $ とする.
- $ \sqrt{x} $ が整数のとき, $ \sqrt{x} $ を新たな $ x $ とする.

 例えば, $ x\ =\ 2 $ のとき, $ 3 $を新しい $ x $ とすることができる.  
 $ x\ =\ 4 $ のとき, $ (2,5) $ のいずれかを新しい $ x $ とすることができる.

 そこで, kagamizは $ x=2 $ として開始し, この操作で許される全ての遷移の仕方を, 少なくともそれぞれ $ 1 $ 回ずつ以上行って 再び $ x=2 $ に戻ってくるような方法のうち, 操作回数が最小になる場合にかかる操作回数を知りたい.  
 あなたの仕事は, そのような方法が存在するかどうかと, 存在するならばその最小操作回数をkagamizに教えてあげることである.

> $ n $

 入力では, 整数 $ n $ が $ 1 $ つだけ与えられる. 最小となる操作回数を出力せよ.  
 もし, そのような方法が存在しない場合は`-1`を出力せよ.  
 もしどのような操作も許されていない場合, 一切操作を行わなくても "この操作で許される全ての遷移の仕方を, 少なくともそれぞれ $ 1 $ 回ずつ以上行った", とみなしてよい. - $ 2\ ≦n\ ≦\ 10^{12} $ たどり着ける数の上限値
 
```

9
```

 ```

10
```

 ```

5
```

 ```

-1
```

 ```

4
```

 ```

3
```



---

---
title: "お気に入りの数2(Favorite Number2)"
layout: "post"
diff: 普及-
pid: AT_k2pc001_h3
tag: []
---

# お気に入りの数2(Favorite Number2)

## 题目描述

[problemUrl]: https://atcoder.jp/contests/k2pc-hard/tasks/k2pc001_h3

**※20:31現在, この問題もセット採点がうまく動作していないようです。修正後リジャッジを行います。(恐らくテストケース毎に表示されている結果は正しいです)。ご迷惑をおかけします。**

**※20:35セット採点データを修正し、リジャッジを行いました。正解しているように見えた解答も不正解扱いになっている可能性があります。ご確認ください。ご迷惑をおかけしました。**

 $ 2 $ 以上 $ n $ 以下の正整数 $ x $ に対して, 以下の操作が許されている.

- $ x+1 $ が$ n $ 以下のとき, $ x\ +\ 1 $ を新たな $ x $ とする.
- $ \sqrt{x} $ が整数のとき, $ \sqrt{x} $ を新たな $ x $ とする.

 例えば, $ x\ =\ 2 $ のとき, $ 3 $を新しい $ x $ とすることができる.  
 $ x\ =\ 4 $ のとき, $ (2,5) $ のいずれかを新しい $ x $ とすることができる.

 そこで, kagamizは $ x=2 $ として開始し, この操作で許される全ての遷移の仕方を, 少なくともそれぞれ $ 1 $ 回ずつ以上行って 再び $ x=2 $ に戻ってくるような方法のうち, 操作回数が最小になる場合にかかる操作回数を知りたい.  
 あなたの仕事は, そのような方法が存在するかどうかと, 存在するならばその最小操作回数をkagamizに教えてあげることである.

> $ n $

 入力では, 整数 $ n $ が $ 1 $ つだけ与えられる. 最小となる操作回数を出力せよ.  
 もし, そのような方法が存在しない場合は`-1`を出力せよ.  
 もしどのような操作も許されていない場合, 一切操作を行わなくても "この操作で許される全ての遷移の仕方を, 少なくともそれぞれ $ 1 $ 回ずつ以上行った", とみなしてよい. - $ 2\ ≦n\ ≦\ 10^{12} $ たどり着ける数の上限値
 
```

9
```

 ```

10
```

 ```

5
```

 ```

-1
```

 ```

4
```

 ```

3
```



---

---
title: "KEYENCE String"
layout: "post"
diff: 普及-
pid: AT_keyence2019_b
tag: []
---

# KEYENCE String

## 题目描述

[problemUrl]: https://atcoder.jp/contests/keyence2019/tasks/keyence2019_b

連続した部分文字列 (空でも良い) を $ 1 $ 度だけ取り除くことで `keyence` に変換することができる文字列をキーエンス型文字列と呼ぶことにします．

英小文字のみから成る文字列 $ S $ が与えられるので，$ S $ がキーエンス型文字列かどうか判定してください．

## 输入格式

入力は以下の形式で標準入力から与えられる．

> $ S $

## 输出格式

$ S $ がキーエンス型文字列なら `YES` を，そうでないなら `NO` を出力せよ．

## 说明/提示

### 制約

- $ S $ の長さは $ 7 $ 以上 $ 100 $ 以下
- $ S $ は英小文字のみから成る

### Sample Explanation 1

`keyence` とは `key of science` の略です．

## 样例 #1

### 输入

```
keyofscience
```

### 输出

```
YES
```

## 样例 #2

### 输入

```
mpyszsbznf
```

### 输出

```
NO
```

## 样例 #3

### 输入

```
ashlfyha
```

### 输出

```
NO
```

## 样例 #4

### 输入

```
keyence
```

### 输出

```
YES
```



---

---
title: "Exam and Wizard"
layout: "post"
diff: 普及-
pid: AT_keyence2019_c
tag: []
---

# Exam and Wizard

## 题目描述

[problemUrl]: https://atcoder.jp/contests/keyence2019/tasks/keyence2019_c

大学生の高橋君は $ N $ 個の試験を受けてすべてに合格する必要があります． 現在，$ i $ 番目の試験の準備度は $ A_{i} $ です． また，高橋君の入念な調査によって，$ i $ 番目の試験に合格するためには準備度を $ B_{i} $ 以上にしなくてはならないことが分かっています．

このままだとすべての試験に合格できないかもしれないと思った高橋君は，魔法使いの青木君に頼んで， 試験の準備度の総和は変えずに，なるべく少ない数の試験の準備度を変更してもらうことで試験を乗り切ることにしました．

高橋君に代わって，以下の条件を満たす数列 $ C_1,\ C_2,\ ...,\ C_{N} $ を考えたときの $ A_i $ と $ C_i $ が異なるような $ i $ の個数の最小値を求めてください． そのような数列 $ C_1,\ C_2,\ ...,\ C_{N} $ が構成できない場合は $ -1 $ を出力してください．

- 数列 $ A_1,\ A_2,\ ...,\ A_{N} $ の総和と数列 $ C_1,\ C_2,\ ...,\ C_{N} $ の総和は等しい
- どの $ i $ に対しても，$ B_i\ \leq\ C_i $ が成り立つ

## 输入格式

入力は以下の形式で標準入力から与えられる．

> $ N $ $ A_1 $ $ A_2 $ $ ... $ $ A_{N} $ $ B_1 $ $ B_2 $ $ ... $ $ B_{N} $

## 输出格式

条件を満たす数列 $ C_1,\ C_2,\ ...,\ C_{N} $ を考えたときの $ A_i $ と $ C_i $ が異なるような $ i $ の個数の最小値を出力せよ． 数列 $ C_1,\ C_2,\ ...,\ C_{N} $ が構成できない場合は，$ -1 $ を出力せよ．

## 说明/提示

### 制約

- $ 1\ \leq\ N\ \leq\ 10^5 $
- $ 1\ \leq\ A_i\ \leq\ 10^9 $
- $ 1\ \leq\ B_i\ \leq\ 10^9 $
- $ A_i,\ B_i $ は整数

### Sample Explanation 1

$ (A_1,\ A_2,\ A_3)\ =\ (2,\ 3,\ 5) $ ，$ (B_1,\ B_2,\ B_3)\ =\ (3,\ 4,\ 1) $ であり，このままでは $ 1 $ 番目と $ 2 $ 番目の試験に合格できません． 以下のように $ C_1,\ C_2,\ C_3 $ を構成すれば，$ A_i $ と $ C_i $ が異なるような $ i $ の個数の最小値 $ 3 $ を達成できます． - $ (C_1,\ C_2,\ C_3)\ =\ (3,\ 5,\ 2) $

### Sample Explanation 2

この場合は，何もしなくても全ての試験に合格できます．

### Sample Explanation 3

この場合は，どのようにしても全ての試験に合格することはできません．

## 样例 #1

### 输入

```
3

2 3 5

3 4 1
```

### 输出

```
3
```

## 样例 #2

### 输入

```
3

2 3 3

2 2 1
```

### 输出

```
0
```

## 样例 #3

### 输入

```
3

17 7 1

25 6 14
```

### 输出

```
-1
```

## 样例 #4

### 输入

```
12

757232153 372327760 440075441 195848680 354974235 458054863 463477172 740174259 615762794 632963102 529866931 64991604

74164189 98239366 465611891 362739947 147060907 118867039 63189252 78303147 501410831 110823640 122948912 572905212
```

### 输出

```
5
```



---

---
title: "Painting"
layout: "post"
diff: 普及-
pid: AT_keyence2020_a
tag: []
---

# Painting

## 题目描述

[problemUrl]: https://atcoder.jp/contests/keyence2020/tasks/keyence2020_a

$ H $ 行 $ W $ 列の マス目があり、最初すべてのマスは白色です。

あなたは、このマス目に何回かペイント操作を施すことにしました。 $ 1 $ 回のペイント操作では、以下の $ 2 $ 種類の作業のうちいずれか $ 1 $ つが行えます。

- 行をひとつ選び、その行に含まれるマスをすべて黒く塗る。
- 列をひとつ選び、その列に含まれるマスをすべて黒く塗る。

黒く塗られているマスの個数が $ N $ 個以上となるようにするためには、最小で何回のペイント操作が必要ですか。 なお、制約の項で記述される条件のもとで、何回かペイント操作を行うことで 黒く塗られているマスの個数が $ N $ 個以上となるようにできることが保証されます。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ H $ $ W $ $ N $

## 输出格式

ペイント操作の回数の最小値を出力せよ。

## 说明/提示

### 制約

- $ 1\ \leq\ H\ \leq\ 100 $
- $ 1\ \leq\ W\ \leq\ 100 $
- $ 1\ \leq\ N\ \leq\ H\ \times\ W $
- 入力値はすべて整数である。

### Sample Explanation 1

「行をひとつ選び、その行に含まれるマスをすべて黒く塗る」という操作を異なる行に対して $ 1 $ 回ずつ、 合計 $ 2 $ 回行うことで、黒く塗られているマスの個数を $ 14 $ にできます。

## 样例 #1

### 输入

```
3

7

10
```

### 输出

```
2
```

## 样例 #2

### 输入

```
14

12

112
```

### 输出

```
8
```

## 样例 #3

### 输入

```
2

100

200
```

### 输出

```
2
```



---

---
title: "Robot Arms"
layout: "post"
diff: 普及-
pid: AT_keyence2020_b
tag: []
---

# Robot Arms

## 题目描述

## 题意描述

有n个区间,第i个区间的范围是[ x[i]-l[i],x[i]+l[i] ]。要求选择若干区间使其不重叠。求最多可以选择多少区间。

## 输入格式

第1行1个数,n,表示区间的个数。

接下来n行,每行2个数,x[i] , l[i]表示一个区间,如题意描述。

## 输出格式

1个数,表示最大可以选择多少区间。

## 说明/提示

1<=n<=100000

0<=x[i]<=1000000000(10亿)

0<l[i]<=1000000000

## 样例 #1

### 输入

```
4

2 4

4 3

9 3

100 5
```

### 输出

```
3
```

## 样例 #2

### 输入

```
2

8 20

1 10
```

### 输出

```
1
```

## 样例 #3

### 输入

```
5

10 1

2 1

4 1

6 1

8 1
```

### 输出

```
5
```



---

---
title: "Subarray Sum"
layout: "post"
diff: 普及-
pid: AT_keyence2020_c
tag: []
---

# Subarray Sum

## 题目描述

输入三个整数，N，K，S。
请你找到一个N个元素的整数序列，其中每一个元素在1，10的9次方之间。这个序列满足K个子序列的和为S。

## 样例 #1

### 输入

```
4 2 3
```

### 输出

```
1 2 3 4
```

## 样例 #2

### 输入

```
5 3 100
```

### 输出

```
50 50 50 30 70
```



---

---
title: "Mex Boxes"
layout: "post"
diff: 普及-
pid: AT_keyence2021_b
tag: []
---

# Mex Boxes

## 题目描述

[problemUrl]: https://atcoder.jp/contests/keyence2021/tasks/keyence2021_b

すぬけ君は一つの整数が書かれたボールを $ N $ 個持っています。 ボールに書かれている数はそれぞれ $ a_1,\ a_2,\ \ldots,\ a_N $ です。

すぬけ君はこの $ N $ 個のボールを $ K $ 個の箱に割り振って入れることにしました。どのボールも箱に入れる必要はありますが、ボールが入っていない箱やボールが複数入っている箱があっても構いません。

すぬけ君がボールを入れ終わるとそれぞれの箱の蓋に整数が表示されます。 表示される整数を $ x $ とすると、$ x $ は箱の中に $ x $ が書かれたボールが存在しないような最小の **非負** 整数です。 例えば、空の箱の蓋には $ 0 $ が、中に $ 0,1,3,5 $ と書かれたボールが入っている箱の蓋には $ 2 $ が、中に $ 1,2,3 $ と書かれたボールが入っている箱の蓋には $ 0 $ が表示されます。

箱の蓋に表示される整数の総和としてありうる値の最大値を求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ K $ $ a_1 $ $ a_2 $ $ \cdots $ $ a_N $

## 输出格式

箱の蓋に表示される整数の総和としてありうる値の最大値を出力せよ。

## 说明/提示

### 制約

- 与えられる入力は全て整数
- $ 1\ \leq\ K\ \leq\ N\ \leq\ 3\ \times\ 10^{5} $
- $ 0\ \leq\ a_i\ <\ N $

### Sample Explanation 1

\- 箱に入っているボールに書かれた数の集合が $ \{0,1,2\ \},\{0\} $ となるように割り振って入れるのが最適です。 - 箱の蓋には $ 3,1 $ がそれぞれ表示され、これらの総和は $ 4 $ となります。

### Sample Explanation 2

\- 箱に入っているボールに書かれた数の(多重)集合が $ \{0,1,1,2,3\},\ \{\} $ となるように割り振って入れるのが最適です。 - 箱の蓋には $ 4,0 $ がそれぞれ表示され、これらの総和は $ 4 $ となります。 - ボールの入っていない箱があっても構わないことに注意してください。

## 样例 #1

### 输入

```
4 2

0 1 0 2
```

### 输出

```
4
```

## 样例 #2

### 输入

```
5 2

0 1 1 2 3
```

### 输出

```
4
```

## 样例 #3

### 输入

```
20 4

6 2 6 8 4 5 5 8 4 1 7 8 0 3 6 1 1 8 3 0
```

### 输出

```
11
```



---

---
title: "A mul B Problem"
layout: "post"
diff: 普及-
pid: AT_kupc2012pr_4
tag: []
---

# A mul B Problem

## 题目描述

[problemUrl]: https://atcoder.jp/contests/kupc2012pr/tasks/kupc2012pr_4





---

---
title: "ソーシャル"
layout: "post"
diff: 普及-
pid: AT_kupc2012_3
tag: []
---

# ソーシャル

## 题目描述

[problemUrl]: https://atcoder.jp/contests/kupc2012/tasks/kupc2012_3





---

---
title: "旧総合研究７号館"
layout: "post"
diff: 普及-
pid: AT_kupc2013_a
tag: []
---

# 旧総合研究７号館

## 题目描述

有一个宿舍，最初名字叫 `kogakubu10gokan`，这个宿舍修改了 $n$ 次名字，第 $i$ 次修改名字在第 $a_i$ 年，名字改为了 $s_i$。现在请你查询第 $x$ 年宿舍的名字。

## 输入格式

第 $1$ 行 $2$ 个整数 $n,x$，表示修改名字的次数，以及要查询的年份。

第 $2$ 至 $n+1$ 行每行一个整数 $a_i$ 和 一个字符串 $s_i$，表示在 $a_i$ 年宿舍的名字修改为了 $s_i$。

## 输出格式

共 $1$ 行，输出第 $x$ 年时宿舍的名字。

## 说明/提示

对于 $100\%$ 的数据：$1\le n,x\le50$，$2\le a_i\le50$，$1\le|s_i|\le30$。



---

---
title: "自由研究"
layout: "post"
diff: 普及-
pid: AT_kupc2013_g
tag: []
---

# 自由研究

## 题目描述

[problemUrl]: https://atcoder.jp/contests/kupc2013/tasks/kupc2013_g





---

---
title: "東京都"
layout: "post"
diff: 普及-
pid: AT_kupc2015_a
tag: []
---

# 東京都

## 题目描述

[problemUrl]: https://atcoder.jp/contests/kupc2015/tasks/kupc2015_a

KUPC2015は[東京](https://atnd.org/events/70910)と[京都](https://atnd.org/events/70909)の二箇所でオンサイトが開催されている． あなたはKUPCの告知を手伝うことにした． 英小文字からなる文字列が印字されたテープがある．あなたはこのテープを文字同士の間でのみ好きなだけ自由に切ってもよい． あなたは`tokyo`か`kyoto`のいずれかの文字列を含むテープをなるべくたくさん作りたい．ただし，一旦切ったテープを後でくっつけることはできないものとする． 作る事ができる`tokyo`もしくは`kyoto`を含むテープの数の最大値を出力せよ．

## 输入格式

入力は以下の形式で標準入力から与えられる．

> $ T $ $ S_1 $ : $ S_T $

- $ 1 $ 行目にはテストケースの数を表す整数 $ T $ ( $ 1\ \leq\ T\ \leq\ 100 $ ) が与えられる．
- 続いて $ T $ 個のテストケースが順に与えられ， $ i $ ( $ 1\ \leq\ i\ \leq\ T $ ) 行目には英小文字のみからなる文字列 $ S_i $ が与えられる．
- 各文字列の長さは $ 1 $ 以上 $ 100 $ 以下であることが保証される．

## 输出格式

出力は $ T $ 行からなる．各テストケースに対する答えのみを順に出力せよ．

## 说明/提示

### Sample Explanation 1

`higashikyoto`と書かれたテープは`kyoto`を含んでいるので，そのまま切り分けなくても目的のテープが $ 1 $ つ得られる． `kupconsitetokyotokyoto`と書かれたテープを{`kupconsitetokyo`, `to`, `kyoto`}と切り分けると，目的のテープが $ 2 $ つ得られる． どう切り分けても目的のテープが得られない場合も存在しうる．

## 样例 #1

### 输入

```
3

higashikyoto

kupconsitetokyotokyoto

goodluckandhavefun
```

### 输出

```
1

2

0
```



---

---
title: "Road to Millionaire"
layout: "post"
diff: 普及-
pid: AT_m_solutions2020_d
tag: []
---

# Road to Millionaire

## 题目描述

[problemUrl]: https://atcoder.jp/contests/m-solutions2020/tasks/m_solutions2020_d

M 君は億万長者を目指して、明日から $ N $ 日間は投資で稼ごうと考えました。現在の彼の所持金は $ 1000 $ 円であり、株は持っていません。なお、M 君の住んでいる国で発行されている株は一種類です。

彼は全国に知られる未来予知能力者であり、今後 $ N $ 日間の株価が以下のようになることをすでに知っています。

- $ 1 $ 日目の株価は $ A_1 $ 円、$ 2 $ 日目の株価は $ A_2 $ 円、・・・、$ N $ 日目の株価は $ A_N $ 円

$ i $ 日目には、**その時点で所持する金と株の範囲内で**、M 君は次の取引を**何回でも**行えます。何も取引しない日があっても構いません。

- 株式購入：$ A_i $ 円を支払って、$ 1 $ 株を受け取る。
- 株式売却：$ 1 $ 株を売却し、$ A_i $ 円を受け取る。

さて、M 君がうまく取引を行ったとき、彼の最終的な所持金は最大でいくらになるでしょうか？

## 输入格式

入力は以下の形式で標準入力から与えられます。

> $ N $ $ A_1 $ $ A_2 $ $ \cdots $ $ A_N $

## 输出格式

M 君の最終的な所持金としてありうる最大の金額を整数として出力してください。

## 说明/提示

### 制約

- $ 2\ \leq\ N\ \leq\ 80 $
- $ 100\ \leq\ A_i\ \leq\ 200 $
- 入力はすべて整数

### Sample Explanation 1

この入力例では、M 君は $ 7 $ 日間にわたって株の取引を行うことになります。例えば、次の方法で最終的な所持金を $ 1685 $ 円とすることができます。 - 最初、M 君は $ 1000 $ 円を持っており、株は持っていない。 - $ 1 $ 日目：株式購入を $ 10 $ 回行う。$ 1000 $ 円を支払って $ 10 $ 株を購入し、所持金は $ 0 $ 円となる。 - $ 2 $ 日目：株式売却を $ 7 $ 回行う。$ 7 $ 株を売却して $ 910 $ 円を受け取り、所持金は $ 910 $ 円となる。 - $ 3 $ 日目：株式売却を $ 3 $ 回行う。$ 3 $ 株を売却して $ 390 $ 円を受け取り、所持金は $ 1300 $ 円となる。 - $ 4 $ 日目：何もしない。 - $ 5 $ 日目：株式購入を $ 1 $ 回行う。$ 115 $ 円を支払って $ 1 $ 株を購入し、所持金は $ 1185 $ 円となる。 - $ 6 $ 日目：株式購入を $ 10 $ 回行う。$ 1150 $ 円を支払って $ 10 $ 株を購入し、所持金は $ 35 $ 円となる。 - $ 7 $ 日目：株式売却を $ 11 $ 回行う。$ 11 $ 株を売却して $ 1650 $ 円を受け取り、所持金は $ 1685 $ 円となる。 また、どのように取引を行っても、最終的な所持金を $ 1686 $ 円以上にすることはできないため、答えは $ 1685 $ となります。

### Sample Explanation 2

この入力例では、$ 6 $ 日間何もしないのが最適です。このとき、最終的な所持金は $ 1000 $ 円となります。

### Sample Explanation 3

この入力例では、$ 1 $ 日目に $ 6 $ 株を購入し、$ 2 $ 日目に $ 6 $ 株を売却すると、最終的な所持金が $ 1216 $ 円となり、最適です。

## 样例 #1

### 输入

```
7

100 130 130 130 115 115 150
```

### 输出

```
1685
```

## 样例 #2

### 输入

```
6

200 180 160 140 120 100
```

### 输出

```
1000
```

## 样例 #3

### 输入

```
2

157 193
```

### 输出

```
1216
```



---

---
title: "Big Integers"
layout: "post"
diff: 普及-
pid: AT_nikkei2019_final_b
tag: []
---

# Big Integers

## 题目描述

[problemUrl]: https://atcoder.jp/contests/nikkei2019-final/tasks/nikkei2019_final_b

長さ $ N $ の整数列 $ A $、長さ $ M $ の整数列 $ B $、整数 $ K $ が与えられます。 値 $ X,Y $ を以下のように定義します。

- $ X=\ \sum_{i=1}^N\ A_i\ \times\ K^{N-i}\ =\ A_1\ \times\ K^{N-1}\ +\ A_2\ \times\ K^{N-2}\ +\ ...\ +\ A_N\ \times\ K^0 $
- $ Y=\ \sum_{i=1}^M\ B_i\ \times\ K^{M-i}\ =\ B_1\ \times\ K^{M-1}\ +\ B_2\ \times\ K^{M-2}\ +\ ...\ +\ B_M\ \times\ K^0 $

$ X $ と $ Y $ のどちらが小さいかを求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ M $ $ K $ $ A_1 $ $ A_2 $ $ \cdots $ $ A_N $ $ B_1 $ $ B_2 $ $ \cdots $ $ B_M $

## 输出格式

$ X\ <\ Y $ のときは `X`、$ X\ >\ Y $ のときは `Y`、$ X\ =\ Y $ のときは `Same` と出力せよ。

## 说明/提示

### 制約

- $ 1\ \leq\ N\ \leq\ 10^5 $
- $ 1\ \leq\ M\ \leq\ 10^5 $
- $ 2\ \leq\ K\ \leq\ 10^9 $
- $ 0\ \leq\ A_i\ \leq\ K-1 $
- $ 1\ \leq\ A_1 $
- $ 0\ \leq\ B_i\ \leq\ K-1 $
- $ 1\ \leq\ B_1 $
- 入力される値はすべて整数である。

### Sample Explanation 1

$ X=123,Y=124 $ であり、 $ X\ <\ Y $ であるので `X` と出力します。

## 样例 #1

### 输入

```
3 3 10

1 2 3

1 2 4
```

### 输出

```
X
```

## 样例 #2

### 输入

```
4 3 13

1 2 3 4

4 5 6
```

### 输出

```
Y
```

## 样例 #3

### 输入

```
4 4 2

1 1 0 1

1 1 0 1
```

### 输出

```
Same
```



---

---
title: "Touitsu"
layout: "post"
diff: 普及-
pid: AT_nikkei2019_qual_b
tag: []
---

# Touitsu

## 题目描述

[problemUrl]: https://atcoder.jp/contests/nikkei2019-qual/tasks/nikkei2019_qual_b

三つの文字列 $ A,\ B,\ C $ が与えられます。これらはそれぞれ、英小文字からなる長さ $ N $ の文字列です。

私たちの目標は、これら三つの文字列をすべて等しくすることです。そのために、あなたは次の操作を繰り返し行うことができます。

- 操作: 文字列 $ A,\ B,\ C $ のうち一つを選び、さらに $ 1 $ 以上 $ N $ 以下の整数 $ i $ を指定する。そして、選んだ文字列の先頭から $ i $ 文字目を別の何らかの英小文字に変更する。

目標を達成するためには最小で何回の操作が必要でしょうか？

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ A $ $ B $ $ C $

## 输出格式

必要な最小の操作回数を出力せよ。

## 说明/提示

### 制約

- $ 1\ \leq\ N\ \leq\ 100 $
- $ A,\ B,\ C $ はそれぞれ長さ $ N $ の文字列である。
- $ A,\ B,\ C $ の各文字は英小文字である。

### Sample Explanation 1

この例では、はじめ $ A\ = $ `west`、$ B\ = $ `east`、$ C\ = $ `wait` です。以下のように $ 3 $ 回の操作を行うことで、最小の操作回数で目標を達成できます。 - $ A $ の $ 2 $ 文字目を `a` に変更する。$ A $ は `wast` となる。 - $ B $ の $ 1 $ 文字目を `w` に変更する。$ B $ は `wast` となる。 - $ C $ の $ 3 $ 文字目を `s` に変更する。$ C $ は `wast` となる。

### Sample Explanation 2

はじめから $ A,\ B,\ C $ がすべて等しい場合、必要な操作回数は $ 0 $ となります。

## 样例 #1

### 输入

```
4

west

east

wait
```

### 输出

```
3
```

## 样例 #2

### 输入

```
9

different

different

different
```

### 输出

```
0
```

## 样例 #3

### 输入

```
7

zenkoku

touitsu

program
```

### 输出

```
13
```



---

---
title: "選択問題の正答はすべて同じ選択肢で…"
layout: "post"
diff: 普及-
pid: AT_pakencamp_2021_day2_d
tag: []
---

# 選択問題の正答はすべて同じ選択肢で…

## 题目描述

[problemUrl]: https://atcoder.jp/contests/pakencamp-2021-day2/tasks/pakencamp_2021_day2_d

筑駒 72 期 高校 1 年 3 学期の漢文の期末試験では、表紙に「選択問題の正答はすべて同じ選択肢で統一しています。この注意事項に気づいても試験終了までは声に出さずに秘密裡にすること。」という注意書きがなされていました。

仮にこの試験が $ N $ 問の選択問題のみからなり、各問題は $ 1 $ から $ M $ までの選択肢から $ 1 $ つを選ばせるような出題形式になっていたとしましょう。

この注意書きに気づかなかったペンギンくんは、各 $ i\ (1\ \leq\ i\ \leq\ N) $ について $ i $ 問目の答えを $ A_i $ と書いてしまいました。

ペンギンくんの正答数として考えられる値の最小値および最大値は、それぞれいくらになりますか？

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ M $ $ A_1 $ $ A_2 $ $ \ldots $ $ A_N $

## 输出格式

ペンギンくんの正答数として考えられる値の最小値と最大値を、この順で空白区切りで出力せよ。

## 说明/提示

### 制約

- $ 1\ \leq\ N\ \leq\ 2\ \times\ 10^5 $
- $ 1\ \leq\ M\ \leq\ 10^9 $
- $ 1\ \leq\ A_i\ \leq\ M $
- 入力は全て整数

### Sample Explanation 1

試験におけるすべての問題の答えが $ 1 $ であったとき、ペンギンくんの正答数は $ 2 $ となります。 試験におけるすべての問題の答えが $ 2 $ であったとき、ペンギンくんの正答数は $ 1 $ となります。 よって、ペンギンくんの正答数として考えられる値の最小値と最大値は、それぞれ $ 1 $、$ 2 $ となります。

### Sample Explanation 2

試験におけるすべての問題の答えが $ 2 $ であったとき、ペンギンくんの正答数は $ 0 $ となり、これは考えられる値の最小値です。 試験におけるすべての問題の答えが $ 1 $ であったとき、ペンギンくんの正答数は $ 2 $ となり、これは考えられる値の最大値です。 原案: \[penguinman\](https://atcoder.jp/users/penguinman)

## 样例 #1

### 输入

```
3 2

1 1 2
```

### 输出

```
1 2
```

## 样例 #2

### 输入

```
4 5

5 1 1 5
```

### 输出

```
0 2
```



---

---
title: "String Equivalence"
layout: "post"
diff: 普及-
pid: AT_panasonic2020_d
tag: []
---

# String Equivalence

## 题目描述

[problemUrl]: https://atcoder.jp/contests/panasonic2020/tasks/panasonic2020_d

この問題では、英小文字からなる文字列のみを考えます。

文字列 $ s,\ t $ は以下の条件を満たすとき **同型** であるといいます。

- $ |s|\ =\ |t| $ である。
- 任意の $ i,\ j $ に対し次のいずれかが成立する。
  - $ s_i\ =\ s_j $ かつ $ t_i\ =\ t_j $
  - $ s_i\ \neq\ s_j $ かつ $ t_i\ \neq\ t_j $

たとえば、`abcac` と `zyxzx` は同型ですが、`abcac` と `ppppp` は同型ではありません。

文字列 $ s $ は以下の条件を満たすとき **標準形** であるといいます。

- 任意の $ s $ と同型な文字列 $ t $ に対し、$ s\ \leq\ t $ が成立する。ただしここで $ \leq $ は辞書順での比較を表す。

たとえば、`abcac` は標準形ですが、`zyxzx` はそれより辞書順で小さい `abcac` と同型のため標準形ではありません。

整数 $ N $ が与えられます。 長さ $ N $ の標準形の文字列を全て、辞書順で昇順で出力してください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $

## 输出格式

長さ $ N $ の標準形の文字列が $ K $ 個あり、辞書順で $ w_1,\ \ldots,\ w_K $ であるとする。 このとき以下の形式で出力せよ。

> $ w_1 $ $ : $ $ w_K $

## 说明/提示

### 制約

- $ 1\ \leq\ N\ \leq\ 10 $
- 入力は全て整数である。

## 样例 #1

### 输入

```
1
```

### 输出

```
a
```

## 样例 #2

### 输入

```
2
```

### 输出

```
aa

ab
```



---

---
title: "電光掲示板"
layout: "post"
diff: 普及-
pid: AT_past202005_d
tag: []
---

# 電光掲示板

## 题目描述

[problemUrl]: https://atcoder.jp/contests/past202005-open/tasks/past202005_d

$ N $ 桁の数字列を表示する電光掲示板があります。 この電光掲示板は $ 5 $ 行 $ 4N+1 $ 列に並べられたランプにより構成されます。 $ 1\ \leq\ j\ \leq\ N $ を満たす $ j $ について、左から $ j $ 桁目の数字の表示には左から $ 4j-2,4j-1,4j $ 列目のランプが用いられます。 それ以外の $ 1,5,\ \ldots,\ 4N+1 $ 列目のランプは全て消灯しています。

電光掲示板の表示の状況は $ 5 $ つの長さ $ 4N+1 $ の文字列 $ s_1,s_2,s_3,s_4,s_5 $ により表されます。 具体的には、$ 1\ \leq\ i\ \leq\ 5,\ 1\ \leq\ j\ \leq\ 4N+1 $ を満たす $ (i,j) $ について、 $ s_{i} $ の先頭から $ j $ 番目の文字は上から $ i $ 行目、左から $ j $ 列目のランプの点灯状況を表しています。

文字列中の `#` は対応する位置のランプが点灯していることを、`.` は消灯していることを表します。

電光掲示板に表示されている $ N $ 桁の数字列を出力してください。

各数字の表示の仕方については入力例 1 を参考にしてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ s_1 $ $ s_2 $ $ s_3 $ $ s_4 $ $ s_5 $

## 输出格式

電光掲示板で表示されている $ N $ 桁の数字列を出力せよ。

## 说明/提示

### 注意

この問題に対する言及は、2020/6/6 18:00 JST まで禁止されています。言及がなされた場合、賠償が請求される可能性があります。 試験後に総合得点や認定級を公表するのは構いませんが、どの問題が解けたかなどの情報は発信しないようにお願いします。

### 制約

- $ 1\ \leq\ N\ \leq\ 50 $
- $ s_1,s_2,s_3,s_4,s_5 $ は `#`、`.` のみからなる長さ $ 4N+1 $ の文字列
- $ s_1,s_2,s_3,s_4,s_5 $ の $ 1,5,\ \ldots,\ 4N+1 $ 文字目は全て `.`
- 入力に対応する数字列が必ず存在し、各数字の表示の仕方は入力例 1 のものと同様

## 样例 #1

### 输入

```
10

.###..#..###.###.#.#.###.###.###.###.###.

.#.#.##....#...#.#.#.#...#.....#.#.#.#.#.

.#.#..#..###.###.###.###.###...#.###.###.

.#.#..#..#.....#...#...#.#.#...#.#.#...#.

.###.###.###.###...#.###.###...#.###.###.
```

### 输出

```
0123456789
```

## 样例 #2

### 输入

```
29

.###.###.###.###.###.###.###.###.###.#.#.###.#.#.#.#.#.#.###.###.###.###..#..###.###.###.###.###.#.#.###.###.###.###.

...#.#.#...#.#.#.#.#.#...#.#...#.#.#.#.#.#...#.#.#.#.#.#.#.....#.#.#.#.#.##..#.#...#.#.#...#.#...#.#...#.#.....#...#.

.###.#.#...#.###.#.#.###.###...#.###.###.###.###.###.###.###...#.###.#.#..#..###...#.###.###.###.###.###.###.###.###.

.#...#.#...#...#.#.#.#.#...#...#.#.#...#.#.#...#...#...#.#.#...#...#.#.#..#..#.#...#...#.#...#.#...#.#.....#...#.#...

.###.###...#.###.###.###.###...#.###...#.###...#...#...#.###...#.###.###.###.###...#.###.###.###...#.###.###.###.###.
```

### 输出

```
20790697846444679018792642532
```



---

---
title: "入力チェック"
layout: "post"
diff: 普及-
pid: AT_past202107_c
tag: []
---

# 入力チェック

## 题目描述

[problemUrl]: https://atcoder.jp/contests/past202107-open/tasks/past202107_c

`0` から `9` の数字からなる文字列 $ S $ が与えられます。  
 $ S $ を整数の十進数表示として見たとき、以下の $ 2 $ つの条件をともに満たすかどうか判定してください。

- 先頭に不要な `0` がない。
- $ L $ 以上 $ R $ 以下である。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ S $ $ L $ $ R $

## 输出格式

$ S $ が問題文に示す $ 2 $ つの条件をともに満たすならば `Yes` と出力し、 そうでなければ `No` と出力せよ。

## 说明/提示

### 注意

この問題に対する言及は、2021/7/17 18:00 JST まで禁止されています。言及がなされた場合、賠償が請求される可能性があります。 試験後に総合得点や認定級を公表するのは構いませんが、どの問題が解けたかなどの情報は発信しないようにお願いします。

### 制約

- $ S $ は `0` から `9` の数字からなる文字列
- $ 1\ \leq\ |S|\ \leq\ 100 $
- $ 0\ \leq\ L\ \leq\ R\ \leq\ 10^9 $
- $ L $ と $ R $ は整数

### Sample Explanation 1

$ 13579 $ は先頭に不要な `0` を持たず、 $ 10000 $ 以上 $ 20000 $ 以下であるため、条件を満たします。 よって、`Yes` と出力します。

### Sample Explanation 2

$ S $ が表す整数は、$ 64 $ ビット整数型で表現できる最大値よりも大きいことがあります。

### Sample Explanation 3

$ 05 $ は先頭に不要な `0` を持つので、条件を満たしません。 よって、`No` と出力します。

### Sample Explanation 4

$ 0 $ の先頭の `0` は、不要な `0` ではないことに注意してください。

## 样例 #1

### 输入

```
13579

10000 20000
```

### 输出

```
Yes
```

## 样例 #2

### 输入

```
12345678901234567890

0 1000000000
```

### 输出

```
No
```

## 样例 #3

### 输入

```
05

5 5
```

### 输出

```
No
```

## 样例 #4

### 输入

```
0

0 1
```

### 输出

```
Yes
```



---

---
title: "青木君のいたずら"
layout: "post"
diff: 普及-
pid: AT_past202107_e
tag: []
---

# 青木君のいたずら

## 题目描述

有一个初始值为 $1$ 的变量 $x$，高桥决定进行 $30$ 次将 $x$ 乘以 $3$ 的操作。但是青木君却做了一个恶作剧。他选择了一个满足 $1\le k \le30$ 的整数 $k$，在高桥进行完第 $k$ 次操作后将 $x$ 加上了 $1$ 。直到高桥完成了全部操作后他才发现了不对劲。他想让你帮帮他，求出青木选择的 $k$ 的值是多少？但还有一种可能，那就是青木在高桥完成所有操作后直接把 $x$ 换成了另一个数。如果是这样，请输出 $-1$。

## 输入格式

一行一个正整数，即完成所有操作后的 $x$。

## 输出格式

如果有满足条件的 $k$ 请输出 $k$ 的值；否则请输出 $-1$ 。

## 说明/提示

**数据规模与约定**

$1 \le n \le 10^{15}$，$n \neq 3^{30}$，且 $n$ 为整数。

## 样例 #1

### 输入

```
205894618879050
```

### 输出

```
10
```

## 样例 #2

### 输入

```
314159265358979
```

### 输出

```
-1
```



---

---
title: "成績判定"
layout: "post"
diff: 普及-
pid: AT_qupc2014_a
tag: []
---

# 成績判定

## 题目描述

[problemUrl]: https://atcoder.jp/contests/qupc2014/tasks/qupc2014_a

あなたはある試験の採点者です。 この試験ではいくつかの科目が存在し、その科目のうち、既定の数の科目に合格すると、試験に合格できます。 この試験では合格人数が初めからきめられているため、科目の合格点を採点結果を見て調整しなければなりません。 調整は面倒なので、採点結果を入力すると合格点を表示するプログラムを作ることにしました。また、科目ごとに調整するのは面倒なので、すべておなじです。 合格人数が最低合格人数以上になる、最大の合格点を出力してください。 ある科目で合格するとは、獲得した点数が、合格点以上になることとします。 入力は以下の形式で与えられる。

> $ A $ $ B $ $ C $ $ D $ $ E_{(0,0)} $ ・・・・$ E_{(0,A-1)} $ ・ ・ ・ ・ $ E_{(C-1,0)} $ ・・・・$ E_{(C-1,A-1)} $

 科目数$ A $、 合格に必要な科目数$ B $、 人数$ C $、 最低合格人数$ D $、 また得点の表$ E_{(i,j)} $ $ E_{(i,j)} $は$ i $番目の人の、$ j $番目の科目についての得点である。 入力中は各変数はすべて整数である。また、以下の制約を満たす。 - $ 2≦A,C≦10 $
- $ 1≦B≦A $
- $ 1≦D≦C $
- $ 0≦E_{(i,j)}≦100 $
 
 調整した点数を整数１行で出力してください ```
<pre class="prettyprint linenums">
4 3 3 2
10 15 25 30
5 20 20 30
40 100 100 100
```

 ```
<pre class="prettyprint linenums">
20
```



---

---
title: "元素の系統名"
layout: "post"
diff: 普及-
pid: AT_qupc2014_b
tag: []
---

# 元素の系統名

## 题目描述

[problemUrl]: https://atcoder.jp/contests/qupc2014/tasks/qupc2014_b

原子番号を与える．それに対応する「元素の系統名（げんそのけいとうめい）」を出力せよ． 「元素の系統名」とは、原子番号の各位を、以下の表にしたがって綴ったものである。 また、一文字目は大文字で表記する。 あなたの仕事は元素番号が117番以降の3桁の元素の名前をつけることである。

数字綴り（1の位以外）綴り（1の位）0nilnilium1ununium2bibium $ * $3tritrium $ * $4quadquadium5pentpentium6hexhexium7septseptium8octoctium9enn $ * $ennium $ * $印が付いている表記について 注意が必要である "bi"または"tri"が"ium"と連結する場合は連続する"ii"は"i"と表記する。"enn"が"nil"または"nilium"と連結する場合は連続する"（e）nn"は"（e）n"と表記する 入力は以下の形式で与えられる。 > $ N $

 Nは原子番号である。 入力中は各変数はすべて整数である。また、以下の制約を満たす。 - $ 117≦N≦999 $
 
 元素の系統名（げんそのけいとうめい）を一行で出力してください ```
<pre class="prettyprint linenums">
145
```

 ```
<pre class="prettyprint linenums">
Unquadpentium
```


```
<pre class="prettyprint linenums">
902
```

 ```
<pre class="prettyprint linenums">
Ennilbium
```



---

---
title: "魔方陣2"
layout: "post"
diff: 普及-
pid: AT_relay_d
tag: []
---

# 魔方陣2

## 题目描述

[problemUrl]: https://atcoder.jp/contests/cf16-relay-open/tasks/relay_d

$ 3 $ マス × $ 3 $ マスの方眼状のマスの中に整数が書かれているものを方陣と呼びます。

タテ、ヨコ、ナナメに並んだ $ 3 $ つの数の総和がどれも等しい方陣を魔方陣と呼びます。

ある魔方陣について、以下のような $ 3 $ マスに関する情報が与えられます。

- 一番左の列の一番上には整数 $ A $ が書かれている
- 中央の列の一番上には整数 $ B $ が書かれている
- 中央の列の中央には整数 $ C $ が書かれている

これらの情報から、元の魔方陣の残りのマスに書かれている整数を全て求めてください。

なお、条件をみたすような魔方陣は必ず $ 1 $ つだけ存在することが保証されています。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ A $ $ B $ $ C $

各整数の意味は問題文中のとおりである。

## 输出格式

以下の形式で元の魔方陣を出力せよ。

> $ X_{1,1} $ $ X_{1,2} $ $ X_{1,3} $ $ X_{2,1} $ $ X_{2,2} $ $ X_{2,3} $ $ X_{3,1} $ $ X_{3,2} $ $ X_{3,3} $

$ X_{i,j} $ には、元の魔方陣の上から $ i $ 行、左から $ j $ 列の場所のマスに書かれた整数を出力せよ。

## 说明/提示

### 制約

- $ 0\ \leq\ A,\ B,\ C\ \leq\ 100 $

## 样例 #1

### 输入

```
8

3

5
```

### 输出

```
8 3 4

1 5 9

6 7 2
```

## 样例 #2

### 输入

```
1

1

1
```

### 输出

```
1 1 1

1 1 1

1 1 1
```



---

---
title: "Sushi 2"
layout: "post"
diff: 普及-
pid: AT_s8pc_5_a
tag: []
---

# Sushi 2

## 题目描述

[problemUrl]: https://atcoder.jp/contests/s8pc-5/tasks/s8pc_5_a

E869120 は, AtCoder 回転寿司という店に行った.  
 この店には, $ N $ 個の寿司がある. 寿司にはそれぞれ $ 1,\ 2,\ 3,\ \cdots,\ N $ の番号がつけられている. 寿司 $ i $ は, 彼が来店してから $ a_i+kT $ 秒後 ($ k $ は $ 0 $ 以上の整数) のみに取ることができる.

彼は, 寿司 $ 1 $ → 寿司 $ 2 $ → … → 寿司 $ N $ という順番で食べたいと思っている. しかし, 彼は貪欲なので, 寿司を一度取ってしまうとすぐに食べてしまう. 彼が $ N $ 個の寿司を食べ終わるまで, 来店してから最短何秒かかるか求めよ. ただし, 寿司を取る時間・食べる時間は無視して良いものとし, 彼は来店して $ 0 $ 秒後に来る寿司も取ることができるものとする.

## 输入格式

入力は以下の形式で標準入力から与えられる.

> $ N $ $ T $ $ a_1 $ $ a_2 $ $ a_3 $ ... $ a_N $

## 输出格式

全ての寿司を決められた順番で食べるとき, 食べ終わるまでにかかる最短の秒数を出力せよ.

## 说明/提示

### 制約

- $ N $ は $ 1 $ 以上 $ 100 $ 以下の整数.
- $ T $ は $ 1 $ 以上 $ 100 $ 以下の整数.
- $ a_i $ は $ 0 $ 以上 $ T-1 $ 以下の整数 $ (1\ \leq\ i\ \leq\ N) $.
- $ 1\ \leq\ i\ <\ j\ \leq\ N $ に対し, $ a_i\ \neq\ a_j $.

### 小課題

小課題 $ 1 $ \[$ 100 $ 点\]

- $ N\ =\ 1 $.

小課題 $ 2 $ \[$ 100 $ 点\]

- 追加の制約はない.

### Sample Explanation 1

この場合, 寿司 $ 1 $ は来店してから $ 4,\ 10,\ 16,\ 22,\ 28,\ \cdots $ 秒後に取ることができる. 一番早いのは $ 4 $ 秒後である.

### Sample Explanation 2

寿司 $ 1,\ 2,\ 3 $ をそれぞれ $ 3,\ 7,\ 12 $ 秒後に取るのが最短である.

## 样例 #1

### 输入

```
1 6

4
```

### 输出

```
4
```

## 样例 #2

### 输入

```
3 10

3 7 2
```

### 输出

```
12
```

## 样例 #3

### 输入

```
6 15

8 6 9 1 2 0
```

### 输出

```
45
```



---

---
title: "Candles"
layout: "post"
diff: 普及-
pid: AT_snuke21_a
tag: []
---

# Candles

## 题目描述

[problemUrl]: https://atcoder.jp/contests/snuke21/tasks/snuke21_a





---

---
title: "Feel the  Beat"
layout: "post"
diff: 普及-
pid: AT_soundhound2018_summer_final_a
tag: []
---

# Feel the  Beat

## 题目描述

[problemUrl]: https://atcoder.jp/contests/soundhound2018-summer-final/tasks/soundhound2018_summer_final_a

BPM (Beat Per Minute) とは、楽曲の速さを表す数値です。

Kenkoooo さんは、BPM が $ 140 $ 以上 $ 170 $ 未満の中速曲が好きです。 また、BPM を何回か $ 2 $ で割ると $ 140 $ 以上 $ 170 $ 未満となる曲も好きです。 このどちらにも当てはまらない曲は好きではありません。

例えば、Kenkoooo さんは BPM が $ 679 $ ($ 2 $ で $ 2 $ 回割ると $ 169.75 $) の曲は好きですが、 BPM が $ 680 $ ($ 2 $ で $ 2 $ 回割ると $ 170 $) の曲は好きではありません。

ここに $ 1 $ 枚の CD があり、$ D\ -\ C $ 曲の楽曲が収録されています。 これらの曲の BPM はそれぞれ $ C,\ C+1,\ C+2,\ ...,\ D-2,\ D-1 $ です。 このうち、Kenkoooo さんが好きな曲は何曲あるでしょうか？

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ C $ $ D $

## 输出格式

CD に収録された曲のうち Kenkoooo さんが好きな曲の数を出力せよ。

## 说明/提示

### 制約

- $ 140\ <\ =\ C\ <\ D\ <\ =\ 10^{15} $
- $ C,\ D $ は整数である。

### Sample Explanation 1

この例では、CD には BPM $ 160,\ 161,\ 162,\ ...,\ 298,\ 299 $ の $ 140 $ 曲が収録されています。 このうち、Kenkoooo さんが好きな曲は BPM $ 160,\ 161,\ 162,\ ...,\ 168,\ 169 $ の $ 10 $ 曲と BPM $ 280,\ 281,\ 282,\ ...,\ 298,\ 299 $ の $ 20 $ 曲、合計 $ 30 $ 曲です。

### Sample Explanation 2

Kenkoooo さんの好みに合わないアルバムです。

### Sample Explanation 3

Kenkoooo さんの世界の CD の容量に上限はなく、収録曲数が $ 32 $ bit 整数型に収まらないこともあります。

## 样例 #1

### 输入

```
160 300
```

### 输出

```
30
```

## 样例 #2

### 输入

```
340 560
```

### 输出

```
0
```

## 样例 #3

### 输入

```
140 1000000000000000
```

### 输出

```
263882790666210
```



---

---
title: "コンテスト"
layout: "post"
diff: 普及-
pid: AT_tdpc_contest
tag: []
---

# コンテスト

## 题目描述

[problemUrl]: https://atcoder.jp/contests/tdpc/tasks/tdpc_contest

入力は以下の形式で標準入力から与えられる。

> $ N $ $ p_1\ p_2\ ...\ p_N $

 答えを一行に出力せよ。 ```

3
2 3 5
```

```

7
```

```

10
1 1 1 1 1 1 1 1 1 1
```

```

11
```

## 说明/提示

### Constraints

 $ N $ 問の問題があるコンテストがあり、$ i $ 問目の問題の配点は $ p_i $ 点である。コンテスタントは、この問題の中から何問か解き、解いた問題の配点の合計が得点となる。このコンテストの得点は何通り考えられるか。

- - - - - -

- $ 1\ <\ =\ N\ <\ =\ 100 $
- $ 1\ <\ =\ p_i\ <\ =\ 100 $



---

---
title: "準急"
layout: "post"
diff: 普及-
pid: AT_tdpc_semiexp
tag: []
---

# 準急

## 题目描述

[problemUrl]: https://atcoder.jp/contests/tdpc/tasks/tdpc_semiexp

入力は以下の形式で標準入力から与えられる。

> $ N $ $ K $

 答えを一行に出力せよ。 ```

10 2
```

```

21
```

```

10 10
```

```

255
```

## 说明/提示

### Constraints

 ある路線には駅 1 から駅 $ N $ までの $ N $ 個の駅がある。すぬけ君は、この路線に準急を走らせることにした。

- 準急は、駅 1 に止まり、{駅 2, ..., 駅 $ N $-1} の部分集合に止まり、駅 $ N $ に止まる。
- 連続する $ K $個以上の駅に止まると、客が飽きてしまうので、そのようなことはしない。
 
 準急の停車駅の組み合わせとして何通り考えられるか、mod 1,000,000,007 で求めよ。 - - - - - -

- $ 2\ <\ =\ K\ <\ =\ N\ <\ =\ 1000000 $



---

---
title: "展開図プログラマーコンテスト"
layout: "post"
diff: 普及-
pid: AT_tenka1_2015_qualA_a
tag: []
---

# 展開図プログラマーコンテスト

## 题目描述

* 安德鲁很喜欢展开图。        
* 今天的安德鲁正在考虑 $6$ 面骰子的展开图        
* $6$ 面骰子的展开图有几种模式。例如，可以考虑以下内容。

![](https://cdn.luogu.com.cn/upload/vjudge_pic/AT_tenka1_2015_qualA_a/592fc5c0813ac4579618c0af6c2e79c5afca5731.png)
以上是安德鲁是 $6$ 面骰子的展开      
首先选择展开图上的任意数字的体量。之后，从那个数字的格子移动到上下左右 $4$ 方向的邻接的格子，为了不通过一次通过的格子而移动，排列通过的格子的数字来制作数量。      
* 根据上述的展开图，可以制作 $1235$ 和$326$ 这样的数量。
* 另外，从其他的展开图中，可以制作 $1462$ 和 $354$ 这样的数量。    
* 但是，不管是什么样的展开图，都不能制作 $121$ 和 $123456$ 这样的数量。     
* 任意选择 $6$ 面骰子的展开图，用这个方法做数的时候，能做的最大的数到底是什么呢? 
 * $1～6$ 的面各具有 $1$ 个。
 * 面对面的数量之和为 $7$ 。
* 骰子的雌雄都可以。也就是说，在将 $1$ 个面以天、$6$ 的面为地的方式放置时，$2$ 个面右边的面可以是 $3$ 也可以是 $4。$

## 输入格式

在这个问题上不能给出输入。

## 输出格式

把能做的最大的数输出到1行，在输出的末尾加上换行。

## 说明/提示

这个问题没有设置部分点。如果答对了，就给10分



---

---
title: "天下一プログラマーコンテスト1998"
layout: "post"
diff: 普及-
pid: AT_tenka1_2015_qualB_a
tag: []
---

# 天下一プログラマーコンテスト1998

## 题目描述

[problemUrl]: https://atcoder.jp/contests/tenka1-2015-qualb/tasks/tenka1_2015_qualB_a

コウヘイくんは天下一プログラマーコンテスト1998の賞金額を以下の数列とすることを決めました。

> $ a_0=100 $ $ a_1=100 $ $ a_2=200 $ $ a_n=a_{n-1}\ +\ a_{n-2}\ +\ a_{n-3} $

$ a_0 $ が最下位の賞金額、 $ a_1 $ が最下位から $ 2 $ 番目の賞金額となっていきます。

しかし、コウヘイくんは計算が苦手です。コウヘイくんのために参加者が $ 20 $ 人だった場合の $ 1 $ 位の賞金額を計算してください。

## 输入格式

この問題では入力は与えられない。

## 输出格式

$ 1 $ 位の賞金額を $ 1 $ 行に出力せよ。

出力の末尾には改行を入れること。

## 说明/提示

### 配点

この問題には部分点は設定されていない。正解した場合は、$ 10 $ 点が与えられる。



---

---
title: "天下一プログラマーゲーム"
layout: "post"
diff: 普及-
pid: AT_tenka1_2016_qualA_a
tag: []
---

# 天下一プログラマーゲーム

## 题目描述

[problemUrl]: https://atcoder.jp/contests/tenka1-2016-quala/tasks/tenka1_2016_qualA_a

天下一大学に入学したキノシタくんは、天下一プログラマーゲームで遊ぶことにしました。 天下一プログラマーゲームとは、整数を $ 1 $ から順に数えていき、 その整数が $ 3 $ で割り切れる場合には「天下一」、 $ 5 $ で割り切れる場合には「プログラマー」、 $ 3 $ でも $ 5 $ でも割り切れる場合には「天下一プログラマー」と発言するゲームです。 それ以外の場合には、その整数をそのまま発言します。

キノシタくんは天下一プログラマーゲームを遊んだときにそのまま発言した整数の総和を求めることにしました。

例えば、$ 10 $ まで天下一プログラマーゲームを遊んだとき、 「$ 1 $、$ 2 $、天下一、$ 4 $、プログラマー、天下一、$ 7 $、$ 8 $、天下一、プログラマー」と発言するので、 整数の総和は $ 1+2+4+7+8=22 $ となります。

$ 100 $ まで天下一プログラマーゲームを遊んだときの、そのまま発言した整数の総和を求めてください。

## 输入格式

この問題では入力は与えられない。

## 输出格式

$ 100 $ まで天下一プログラマーゲームを遊んだとき、そのまま発言した整数の総和を出力せよ。出力の末尾に改行を入れること。



---

---
title: "書き換え（Rewrite）"
layout: "post"
diff: 普及-
pid: AT_tkppc2016_b
tag: []
---

# 書き換え（Rewrite）

## 题目描述

[problemUrl]: https://atcoder.jp/contests/tkppc2/tasks/tkppc2016_b

joisinoお姉ちゃんの次の仕事は、書類の書き換えである。  
 書類は$ N $個あり、それぞれに、重要度と、書き換えるのにかかる時間が決まっている。  
 joisinoお姉ちゃんはどうしても定時に帰りたいので、あと作業できる時間は$ M $しかない。  
 そこでjoisinoお姉ちゃんは、時間内に書き換える書類の重要度の合計の最大化したいと思い、その最大値を求めるプログラムを作ることにした。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ M $ $ V_1 $ $ T_1 $ $ V_2 $ $ T_2 $ : $ V_N $ $ T_N $

- $ 1 $行目には、書類の個数を表す整数$ N(1≦N≦500) $と残っている時間$ M(1≦M≦500) $が書かれている。
- 続く$ N $行のうち$ i $行目には、$ i $番目の書類の重要度$ V_i(1≦V_i≦10^5) $と書き換えにかかる時間$ T_i(1≦T_i≦500) $が書かれている。

## 输出格式

時間内に書き換えられる書類の重要度の合計の最大値を、$ 1 $行に出力せよ。

## 说明/提示

### Sample Explanation 1

$ 2 $番目と$ 3 $番目の書類を書き換える。

## 样例 #1

### 输入

```
3 3

1 2

6 1

4 1
```

### 输出

```
10
```

## 样例 #2

### 输入

```
10 10

92231 7

70370 1

4423 10

96481 4

69142 2

91784 3

16328 3

85936 8

93166 2

17394 1
```

### 输出

```
351801
```



---

---
title: "有給休暇（Paid Vacation）"
layout: "post"
diff: 普及-
pid: AT_tkppc2016_c
tag: []
---

# 有給休暇（Paid Vacation）

## 题目描述

Joisino 姐姐非常喜欢长假。

现在，已经知道了接下来的 $n$ 天是否是休息日。

Joisino 姐姐可以把最多 $k$ 个非休息日改为休息日。

Joisino 姐姐想知道可能的最长连续休息日的长度。

## 输入格式

第一行两个整数 $n,k$。

第二行 $n$ 个整数 $0$ 或 $1$，第 $i$ 个整数为 $1$ 表示第 $i$ 天是休息日，为 $0$ 表示第 $i$ 天是非休息日。

## 输出格式

输出最长连续休息日的长度。

## 样例 #1

### 输入

```
6 2

1 0 1 0 0 1
```

### 输出

```
4
```

## 样例 #2

### 输入

```
10 1

1 1 0 0 1 1 1 0 1 1
```

### 输出

```
6
```



---

---
title: "Jumping!!"
layout: "post"
diff: 普及-
pid: AT_tkppc4_2_a
tag: []
---

# Jumping!!

## 题目描述

[problemUrl]: https://atcoder.jp/contests/tkppc4-2/tasks/tkppc4_2_a

配点 $ 200 $ 点

座標平面上にAliceがいます。彼女のいる座標は $ (0,0) $ です。

彼女は「桂馬飛び」のみで座標 $ (x,y) $ に行けるでしょうか。行ける場合は、最小で何回の桂馬飛びで行けるのかを求めてください。

なお、$ 1 $ 回の「桂馬飛び」とは以下の移動のことを指します。

- 座標 $ (a,b) $ にいる時、座標 $ (a+1,b+2) $ または $ (a-1,b+2) $ に移動する。

![](https://cdn.luogu.com.cn/upload/vjudge_pic/AT_tkppc4_2_a/c3b5225215411ad6fd5647f9473cbc184fa57e89.png)

## 输入格式

入力は以下の形式で標準入力から与えられます。

> $ x $ $ y $

## 输出格式

座標 $ (x,y) $ に行ける場合は、最小で何回の桂馬飛びをするかを出力してください。行けない場合は $ -1 $ を出力してください。

## 说明/提示

### 制約

- 入力は全て整数である。
- $ -10^5\ \leq\ x,\ y\ \leq\ 10^5 $

### Sample Explanation 1

$ 1 $ 回目で $ (1,2) $ に飛び、$ 2 $ 回目で $ (0,4) $ に飛び、$ 3 $ 回目で $ (1,6) $ に飛ぶことでたどり着けます。 以下の画像のように動きます。 !\[\](https://img.atcoder.jp/tkppc4-2/1a9d0ec0c05411619f92b013a90c95b4.png)

### Sample Explanation 2

どのように動いても、座標 $ (6,\ 1) $ には桂馬飛びだけではたどり着けません。

## 样例 #1

### 输入

```
1 6
```

### 输出

```
3
```

## 样例 #2

### 输入

```
6 1
```

### 输出

```
-1
```

## 样例 #3

### 输入

```
869 -120
```

### 输出

```
-1
```



---

---
title: "整数割り算"
layout: "post"
diff: 普及-
pid: AT_tricky_1
tag: []
---

# 整数割り算

## 题目描述

两个实数A,B(B!=0)被赋值后,除法A/B的结果我认为是谁都知道的.

对于这个问题,两个整数A,B(B!=0)被赋值后,请写出计算整数除法A DIV B的程序.

在这里,整数除法A DIV B的意思是,当A,B为实数时将A/B计算结果的小数部分忽略而得到的整数.

例如,4 DIV 3的结果就是4/3=1.3333...的小数部分忽略后得到的1,4 DIV (-3)的结果就是4/(-3)=-1.3333...的小数部分忽略后得到的-1.

另外,8/2=4=3.9999...,但是,当A/B为整数时,A/B就要作为A DIV B的结果.也就是说8 DIV 2=4.

## 输入格式

第一行是测试样例的个数T.

之后为T组数据样例.

每个测试样例有1行,分别给出两个整数A,B.

## 输出格式

对于每一组输入,输出整数除法A DIV B的结果.

## 说明/提示

- 0<=T<=10^6
- -2^63<=A,B<=2^63
- B!=0

感谢@神云_cloud 提供的翻译



---

---
title: "ラー油"
layout: "post"
diff: 普及-
pid: AT_ttpc2015_b
tag: []
---

# ラー油

## 题目描述

[problemUrl]: https://atcoder.jp/contests/ttpc2015/tasks/ttpc2015_b

東工太郎君は$ N $日間、毎日$ 1 $食担々麺を食べます。 担々麺には好きな量のラー油をかけることが出来ます。 太郎君が$ i $日目$ (1\ \leq\ i\ \leq\ N) $にラー油を$ x_i $かけた担々麺を食べた時、 幸福度を$ A_i\ x_i $得ることが出来ます。

太郎君はおなかが弱いので、$ 0\ \leq\ x_i\ \leq\ B\ \,\ (1\ \leq\ i\ \leq\ N) $かつ$ \Σ_{1\ \leq\ i\ \leq\ N}\ x_i\ \leq\ C $である必要があります。 また、ラー油はとてもおいしいので$ N\ \geq\ 2 $のとき任意の$ i(1\ \leq\ i\ \leq\ N-1) $に対して$ A_i\ \leq\ A_{i+1} $が成り立ちます。

太郎君が得られる$ N $日間の幸福度の和の最大値を求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ B $ $ C $ $ A_1 $ $ ... $ $ A_N $

- $ 1 $行目に3つの整数$ N(1\ \leq\ N\ \leq\ 100)\ ,\ \,\ B(1\ \leq\ B\ \leq\ 10000),\ \,\ C(1\ \leq\ C\ \leq\ 10000) $が空白区切りで与えられる。
- $ 2 $行目に$ N $個の整数$ A_1,\ …,\ A_N\ (0\ \leq\ A_i\ \leq\ 100) $が空白区切りで与えられる。
- $ N\ \geq\ 2 $のとき任意の$ i(1\ \leq\ i\ \leq\ N-1) $に対して$ A_i\ \leq\ A_{i+1} $

## 输出格式

太郎君が得られる$ N $日間の幸福度の和の最大値を$ 1 $行に出力してください。出力の末尾に改行を入れること。

## 说明/提示

### Sample Explanation 1

$ 1 $日目に$ 1 $だけラー油をかけ、$ 2 $日目と$ 3 $日目に$ 2 $だけラー油をかけるのが最適であり、太郎君は$ 11 $だけ幸せになれます。

### Sample Explanation 2

$ 1 $日目と$ 2 $日目にはラー油をかけず$ 3 $日目に$ 100 $だけラー油をかけるのが最適であり、太郎君は$ 10000 $だけ幸せになれます。

### Sample Explanation 3

太郎君は追加でラー油をかけることはない。

### Sample Explanation 4

太郎君のおなかはとても弱いので追加でラー油をかけることはできない。

### Sample Explanation 5

ラー油をどれだけかけても幸せにはなれない。

## 样例 #1

### 输入

```
3 2 5

1 2 3
```

### 输出

```
11
```

## 样例 #2

### 输入

```
3 100 100

1 2 100
```

### 输出

```
10000
```

## 样例 #3

### 输入

```
5 0 10000

1 2 3 7 15
```

### 输出

```
0
```

## 样例 #4

### 输入

```
6 10000 0

1 2 4 8 16 97
```

### 输出

```
0
```

## 样例 #5

### 输入

```
5 10000 10000

0 0 0 0 0
```

### 输出

```
0
```

## 样例 #6

### 输入

```
8 5 32

0 1 1 2 3 5 8 13
```

### 输出

```
162
```



---

---
title: "(iwi)"
layout: "post"
diff: 普及-
pid: AT_utpc2011_2
tag: []
---

# (iwi)

## 题目描述

[problemUrl]: https://atcoder.jp/contests/utpc2011/tasks/utpc2011_2





---

---
title: "ファーストアクセプタンス"
layout: "post"
diff: 普及-
pid: AT_utpc2011_5
tag: []
---

# ファーストアクセプタンス

## 题目描述

# 问题描述

你参加了一个编程比赛，一共有 $N$ 题。你解决第 $i$ 个问题需要 $A_{i}$ 分钟，而别人则需要 $B_{i}$ 分钟。现在你需要安排你的做题顺序，使得拿到题目的一血数量最多(即第一个完成)。注意，当你开始做一道题，你就只能做这道题直到解决。最后只要给出最多一血数即可。

## 输入格式

第一行为一个正整数 $N$ 

接下来 $N$ 行，第 $i+1$ 行为两个正整数 $A_{i}$ 和 $B_{i}$

## 输出格式

一行，为你可以取到的最多一血数。注意，文末需要换行。

## 说明/提示

-  $1 \le N \le 1000$ 

-  $1 \le A_{i},B_{i} \le 10^{6}(1 \le i \le N)$ 

感谢@常暗踏阴 提供的翻译



---

---
title: "UTPC"
layout: "post"
diff: 普及-
pid: AT_utpc2013_01
tag: []
---

# UTPC

## 题目描述

### 题目背景
鳗鱼王国的国王计划举办一场名为 Unagi The synthesis Programming Contest（简称UTPC）的比赛。因此，国王征集了一个很酷的 UTPC 标志。然而，国王的眼睛非常不好，只能通过字母中孔的数量来区分字符串。
给定一个由大写字母组成且长度为 $4$ 的字符串 $s$。回答 $s$ 是否与字符串"UTPC"在“孔的数量意义上相等”。"孔的数量意义上相等"指的是，对应位置的 $2$ 个字母的孔的数量相等。其中，孔的数量为 $0$ 的字母是 `CEFGHIJKLMNSTUVWXYZ`，孔的数量为 $1$ 的字母是 `ADOPQR`，孔的数量为 $2$ 的字母是 `B`。

## 输入格式

输入以以下格式给出。
> $s_1s_2s_3s_4$

$s_i$ 表示第 $i$ 个字符。

## 输出格式

如果给定的字符串与字符串"UTPC"相等（相等的定义参照前面的叙述），输出 `yes`；否则输出 `no`。
### 约束
输入中的每个变量满足以下约束。
- 每个 $s_i$ 是大写字母 `A` 到 `Z` 之间的一个字符。

## 样例 #1

### 输入

```
KUPC

```

### 输出

```
yes

```

## 样例 #2

### 输入

```
UTPC

```

### 输出

```
yes

```

## 样例 #3

### 输入

```
UTBC

```

### 输出

```
no

```



---

---
title: "パスワード"
layout: "post"
diff: 普及-
pid: AT_wupc2012_2
tag: []
---

# パスワード

## 题目描述

题目：密码

## 输入格式

给定的输入数据为按以下形式的标准输入。
   $ N $   
   $ S_{1} $   
   $ S_{2} $   
   $ ... $   
   $ S_{i} $   
   $ ... $   
   $ S_{N} $   
·第一行给定一个数N（2<=N<=50）。
·第二行到第N+1行给定只含英文小写字母的字符串。
·每个字符串的长度不超过50。

## 输出格式

从给定的字符串中选择两个或以上输出一行按任意顺序组合后字典序最小的串。

（另外，貌似输出的结尾不加上换行符的话会WA）

感谢@hy1004 提供的翻译



---

---
title: "三角パズル"
layout: "post"
diff: 普及-
pid: AT_wupc2012_4
tag: []
---

# 三角パズル

## 题目描述

[problemUrl]: https://atcoder.jp/contests/wupc2012/tasks/wupc2012_4

 そうこうしているうちに，圧縮ファイルの解凍が終わったようだ．中を見ると，今度は直角三角形状に並んだ数列を含むテキストファイルを見つけた．  
  
 7  
 2 3  
 1 5 4  
  
 どうやら，一番上の頂点からはじめて，一段下の直下か右下かを選び底辺まで下っていったとき，その経路中の数値の合計の最大値を求める問題のようだ．それなら簡単．上の例の場合，7 -&gt; 3 -&gt; 5 と選ぶのが最適で，合計は 15 となる．しかし，このようなファイルはたくさんあり，中には100段に及ぶデータもあった．これを解かなきゃ参加資格はないってことか…？  
 いやまて，これはプログラミングコンテストへの招待状だ．数列を入力として与えた時，最大値を求めるプログラムを作ってしまえばいい．おそらく，招待状を送った人物はそれを期待している．  
 以下のように直角三角形上に並んだ数列が与えられる．頂点から初めて一段下の直下か右下を選び，底辺まで下ったときの経路中の数値の合計の最大値を求めよ．  
 例えば，以下のような数列が与えられたとすると，  
  
 3  
 7 4  
 2 4 6  
 8 5 9 3  
  
 正しく選択した場合，  
  
**3**  
**7** 4  
 2 **4** 6  
 8 5 **9** 3  
  
 であり，合計値は 3 + 7 + 4 + 9 = 23 となる． 入力は以下の形式で標準入力から与えられる．

> $ N $ $ a_{1,1} $ $ a_{2,1}　a_{2,2} $ $ a_{3,1}　a_{3,2}　a_{3,3} $ $ ... $ $ a_{i,1}　a_{i,2}　...　a_{i,i} $ $ ... $ $ a_{N,1}　a_{N,2}　...　a_{N,N} $

- $ 1 $ 行目には直角三角形の高さ $ N $($ 1\ ≦\ N\ ≦\ 100 $) が与えられる．
- $ i $ 行目($ 2\ ≦\ i\ ≦\ N+1 $)には数字が半角スペース区切りで $ i-1 $ 個与えられる．
- 数列に含まれる数は $ 0\ ≦\ a_{i,j}\ ≦\ 100 $($ 1\ ≦\ j\ ≦\ i\ ≦\ N $) を満たす．
 
 数値の合計の最大値を標準出力に $ 1 $ 行で出力せよ．  
 100点満点中，50点分については，$ N\ ≦\ 20 $ を満たす．



---

---
title: "Bad Mood"
layout: "post"
diff: 普及-
pid: AT_xmascon21_b
tag: []
---

# Bad Mood

## 题目描述

给定两个正整数 $M$ 和 $N$。有一个 $M$ 行 $N$ 列的正方形格子。

现在，要在每个格子里画上其中一条对角线。在此基础上，考虑一个无向图，该图的顶点对应于格子的角（共有 $(M + 1) \times (N + 1)$ 个顶点），画上的对角线对应于图的边。定义通过这种方式能形成的连通分量的数量为得分。

请计算可能的最小得分和最大得分。

![](https://cdn.luogu.com.cn/upload/vjudge_pic/AT_xmascon21_b/0651d892dadc631ce7f050fce6b1391d1aef7999.png)示例中得分为 $10$ 的情况

## 输入格式

从标准输入读入以下格式的数据：

> $M$ $N$

## 输出格式

输出可能的最小得分 $a$ 和最大得分 $b$，格式如下：

> $a$ $b$

### 样例 #1

### 输入样例 #1

```
2 3
```

### 输出样例 #1

```
6 7
```

## 说明/提示

### 限制

- $1 \le M \le 10^9$。
- $1 \le N \le 10^9$。

### 样例解释 #1

得分为 $6$ 和得分为 $7$ 的示例分别如下图所示：

![得分为 6 的示例](https://img.atcoder.jp/xmascon21/105091090192bc5be451863d86ff441c.png)

![得分为 7 的示例](https://img.atcoder.jp/xmascon21/b293f4f8d17c9c01555ac5bc4d9c3b72.png)

## 样例 #1

### 输入

```
2 3
```

### 输出

```
6 7
```



---

---
title: "Good Sequence"
layout: "post"
diff: 普及-
pid: AT_xmascontest2015_g
tag: []
---

# Good Sequence

## 题目描述

[problemUrl]: https://atcoder.jp/contests/xmascontest2015noon/tasks/xmascontest2015_g

うなぎはクリスマスにサンタうさぎから数列 $ A=\{A_1,A_2,...,A_N\} $ をもらいました。

うなぎは数列 $ A $ からいくつか（$ 0 $ 個でもよい）の要素を消して、「良い数列」を作ることにしました。数列 $ x $ が良い数列であるとは、以下のような性質を満たすことを指します。

- すべての $ i\ (2\ ≦\ i\ ≦\ |x|-1) $ について、$ x_i $ は $ x_{i-1},\ x_i,\ x_{i+1} $ のうちの中央値でない。

例えば $ x=\{2,1,3,2\} $ や $ x=\{2,1,2\} $ は条件を満たしますが、$ x=\{1,2,3\} $ や $ x=\{1,1,3,2\} $ は条件を満たしません。 また、長さが $ 3 $ 未満の数列も条件を満たします。

数列 $ x $ のデコボコ度を隣接する数の差の和とします。デコボコ度を数式で表すと、$ Σ_{1\ ≦\ i\ ≦\ |x|-1}\ |x_i\ -\ x_{i+1}| $ となります。

このとき、作ることのできる良い数列のデコボコ度の最大値を求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ A_1 $ $ A_2 $ ... $ A_N $

- $ 1 $ 行目には、数列 $ A $ の長さを表す整数 $ N\ (2≦N≦10^5) $ が与えられる。
- $ 2 $ 行目には、$ N $ 個の整数が空白区切りで与えられる。このうち $ i\ (1\ ≦\ i\ ≦\ N) $ 番目には整数 $ A_i\ (0\ ≦\ A_i\ ≦\ 10^9) $ が与えられる。

## 输出格式

数列 $ A $ からいくつかの要素を消すことで得られる良い数列のうちのデコボコ度の最大値を出力せよ。 出力の末尾に改行を入れること。

## 说明/提示

### 部分点

この問題には部分点が設定されている。

- $ N≦1,000 $ を満たすデータセットに正解した場合は、$ 20 $ 点が与えられる。
- 追加制約のないデータセットに正解した場合は、上記とは別に $ 80 $ 点が与えられる。

### Sample Explanation 1

例えば、$ 1,4 $ 番目の要素を消すと $ \{1,3,1\} $ となり、デコボコ値は $ 4 $ となります。

## 样例 #1

### 输入

```
5

1 1 3 2 1
```

### 输出

```
4
```

## 样例 #2

### 输入

```
7

2 1000000000 0 1000000000 1 1000000000 5
```

### 输出

```
5999999991
```



---

---
title: "オークション"
layout: "post"
diff: 普及-
pid: AT_yahoo_procon2018_qual_b
tag: []
---

# オークション

## 题目描述

[problemUrl]: https://atcoder.jp/contests/yahoo-procon2018-qual/tasks/yahoo_procon2018_qual_b

矢風くんはオークションに参加しています。矢風くんの欲しい品物には、現在 $ X $ 円の値が付いています。

矢風くんはこの品物に、以下の条件を満たすような $ Y $ に対して、$ Y $ 円の値段をつけることができます。

- オークションでつける値段として適切である。すなわち、$ X+1\leq\ Y $ である。
- つける金額は細かすぎない。すなわち、$ Y $ の $ 10 $ 進表記の下 $ K $ 桁は全て $ 0 $ である。

矢風くんがつけることのできる最小の金額を求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ X $ $ K $

## 输出格式

矢風くんがつけることのできる最小の金額を出力せよ。

## 说明/提示

### 制約

- $ 1\ \leq\ X\ \leq\ 10^9 $
- $ 0\ \leq\ K\ \leq\ 9 $
- 入力はすべて整数である

### Sample Explanation 1

$ 2018 $ 円より大きく、下 $ 2 $ 桁が $ 0 $ であるような最小の金額は、$ 2100 $ 円です。

### Sample Explanation 2

$ X $ 円より大きい値段をつけなければならないことに注意してください。

## 样例 #1

### 输入

```
2018 2
```

### 输出

```
2100
```

## 样例 #2

### 输入

```
888 0
```

### 输出

```
889
```

## 样例 #3

### 输入

```
100 7
```

### 输出

```
10000000
```



---

---
title: "When I hit my pocket..."
layout: "post"
diff: 普及-
pid: AT_yahoo_procon2019_qual_c
tag: []
---

# When I hit my pocket...

## 题目描述

Snuke的口袋里有1块饼干和0枚硬币,现在他必须进行K次操作,每次操作是以下3种操作之一:  

操作1:打自己的口袋,可以将饼干数增加1  

操作2:把A个饼干换成1枚硬币  

操作3:把1枚硬币换成B个饼干  

问:经过这K次操作后,Snuke的口袋里最多有多少块饼干

## 输入格式

共一行,K、A、B,相邻两数之间用空格隔开

## 输出格式

共一行,经过K次操作后,Snuke口袋里最多的饼干数  

##### 数据范围说明:    

·1≤K,A,B≤10^9  

·保证所有的输入数据均为整数

## 样例 #1

### 输入

```
4 2 6
```

### 输出

```
7
```

## 样例 #2

### 输入

```
7 3 4
```

### 输出

```
8
```

## 样例 #3

### 输入

```
314159265 35897932 384626433
```

### 输出

```
48518828981938099
```



---



---

# 无标签题目列表

- AT_abc001_4 - [ABC001D] 感雨時刻の整理
- AT_abc005_3 - [ABC005C] おいしいたこ焼きの売り方
- AT_abc006_1 - [ABC006A] 世界のFizzBuzz
- AT_abc006_3 - [ABC006C] スフィンクスのなぞなぞ
- AT_abc006_4 - [ABC006D] トランプ挿入ソート
- AT_abc010_3 - [ABC010C] 浮気調査
- AT_abc011_3 - [ABC011C] 123引き算
- AT_abc019_3 - [ABC019C] 高橋くんと魔法の箱
- AT_abc021_a - [ABC021A] 足し算
- AT_abc021_b - [ABC021B] 嘘つきの高橋くん
- AT_abc022_b - [ABC022B] Bumble Bee
- AT_abc023_b - [ABC023B] 手芸王
- AT_abc025_b - [ABC025B] 双子とスイカ割り
- AT_abc032_b - [ABC032B] 高橋君とパスワード
- AT_abc036_b - [ABC036B] 回転
- AT_abc036_c - [ABC036C] 座圧
- AT_abc038_c - [ABC038C] 単調増加
- AT_abc040_b - [ABC040B] □□□□□
- AT_abc046_b - [ABC046B] AtCoDeerくんとボール色塗り
- AT_abc047_b - [ABC047B] すぬけ君の塗り絵 2 イージー
- AT_abc048_b - [ABC048B] Between a and b ...
- AT_abc051_c - [ABC051C] Back and Forth
- AT_abc056_b - [ABC056B] NarrowRectanglesEasy
- AT_abc061_c - [ABC061C] Big Array
- AT_abc064_c - [ABC064C] Colorful Leaderboard
- AT_abc064_d - [ABC064D] Insertion
- AT_abc068_b - [ABC068B] Break Number
- AT_abc084_c - [ABC084C] Special Trains
- AT_abc088_c - [ABC088C] Takahashi&#39;s Information
- AT_abc089_c - [ABC089C] March
- AT_abc091_b - [ABC091B] Two Colors Card Game
- AT_abc096_c - [ABC096C] Grid Repainting 2
- AT_abc098_b - [ABC098B] Cut and Count
- AT_abc100_c - [ABC100C] *3 or /2
- AT_abc105_c - [ABC105C] Base -2 Number
- AT_abc106_c - [ABC106C] To Infinity
- AT_abc107_b - [ABC107B] Grid Compression
- AT_abc108_b - [ABC108B] Ruined Square
- AT_abc109_c - [ABC109C] Skip
- AT_abc116_c - [ABC116C] Grand Garden
- AT_abc117_c - [ABC117C] Streamline
- AT_abc118_c - [ABC118C] Monsters Battle Royale
- AT_abc119_c - [ABC119C] Synthetic Kadomatsu
- AT_abc120_c - [ABC120C] Unification
- AT_abc121_c - [ABC121C] Energy Drink Collector
- AT_abc126_c - [ABC126C] Dice and Coin
- AT_abc127_c - [ABC127C] Prison
- AT_abc128_b - [ABC128B] Guidebook
- AT_abc128_c - [ABC128C] Switches
- AT_abc129_c - [ABC129C] Typical Stairs
- AT_abc130_c - [ABC130C] Rectangle Cutting
- AT_abc131_d - [ABC131D] Megalomania
- AT_abc132_c - [ABC132C] Divide the Problems
- AT_abc133_b - [ABC133B] Good Distance
- AT_abc133_c - [ABC133C] Remainder Minimization 2019
- AT_abc135_c - [ABC135C] City Savers
- AT_abc136_c - [ABC136C] Build Stairs
- AT_abc136_d - [ABC136D] Gathering Children
- AT_abc138_c - [ABC138C] Alchemist
- AT_abc139_d - [ABC139D] ModSum
- AT_abc141_d - [ABC141D] Powerful Discount Tickets
- AT_abc143_d - [ABC143D] Triangles
- AT_abc144_c - [ABC144C] Walk on Multiplication Table
- AT_abc145_c - [ABC145C] Average Length
- AT_abc154_d - [ABC154D] Dice in Line
- AT_abc155_c - [ABC155C] Poll
- AT_abc156_c - [ABC156C] Rally
- AT_abc159_d - [ABC159D] Banned K
- AT_abc160_d - [ABC160D] Line++
- AT_abc160_e - [ABC160E] Red and Green Apples
- AT_abc161_c - [ABC161C] Replacing Integer
- AT_abc164_c - [ABC164C] gacha
- AT_abc165_d - [ABC165D] Floor Function
- AT_abc166_d - [ABC166D] I hate Factorization
- AT_abc167_c - [ABC167C] Skill Up
- AT_abc169_b - [ABC169B] Multiplication 2
- AT_abc169_c - [ABC169C] Multiplication 3
- AT_abc171_c - [ABC171C] One Quadrillion and One Dalmatians
- AT_abc171_d - [ABC171D] Replacing
- AT_abc173_c - [ABC173C] H and V
- AT_abc174_c - [ABC174C] Repsept
- AT_abc174_d - [ABC174D] Alter Altar
- AT_abc175_c - [ABC175C] Walking Takahashi
- AT_abc177_c - [ABC177C] Sum of product of pairs
- AT_abc181_d - [ABC181D] Hachi
- AT_abc183_c - [ABC183C] Travel
- AT_abc183_d - [ABC183D] Water Heater
- AT_abc185_c - [ABC185C] Duodecim Ferra
- AT_abc185_d - [ABC185D] Stamp
- AT_abc186_d - [ABC186D] Sum of difference
- AT_abc187_d - [ABC187D] Choose Me
- AT_abc188_c - [ABC188C] ABC Tournament
- AT_abc189_c - [ABC189C] Mandarin Orange
- AT_abc190_c - [ABC190C] Bowls and Dishes
- AT_abc193_c - [ABC193C] Unexpressed
- AT_abc194_c - [ABC194C] Squared Error
- AT_abc195_b - [ABC195B] Many Oranges
- AT_abc198_c - [ABC198C] Compass Walking
- AT_abc199_c - [ABC199C] IPFL
- AT_abc201_c - [ABC201C] Secret Number
- AT_abc204_c - [ABC204C] Tour
- AT_abc207_c - [ABC207C] Many Segments
- AT_abc209_d - [ABC209D] Collision
- AT_abc210_c - [ABC210C] Colorful Candies
- AT_abc211_c - [ABC211C] chokudai
- AT_abc213_c - [ABC213C] Reorder Cards
- AT_abc214_c - [ABC214C] Distribution
- AT_abc219_c - [ABC219C] Neo-lexicographic Ordering
- AT_abc220_d - [ABC220D] FG operation
- AT_abc221_c - [ABC221C] Select Mul
- AT_abc222_c - [ABC222C] Swiss-System Tournament
- AT_abc223_c - [ABC223C] Doukasen
- AT_abc224_c - [ABC224C] Triangle?
- AT_abc225_c - [ABC225C] Calendar Validator
- AT_abc226_c - [ABC226C] Martial artist
- AT_abc230_c - [ABC230C] X drawing
- AT_abc232_c - [ABC232C] Graph Isomorphism
- AT_abc232_d - [ABC232D] Weak Takahashi
- AT_abc233_c - [ABC233C] Product
- AT_abc234_d - [ABC234D] Prefix K-th Max
- AT_abc237_d - [ABC237D] LR insertion
- AT_abc238_c - [ABC238C] digitnum
- AT_abc240_c - [ABC240C] Jumping Takahashi
- AT_abc240_d - [ABC240D] Strange Balls
- AT_abc241_c - [ABC241C] Connect 6
- AT_abc242_c - [ABC242C] 1111gal password
- AT_abc243_c - [ABC243C] Collision 2
- AT_abc245_c - [ABC245C] Choose Elements
- AT_abc246_c - [ABC246C] Coupon
- AT_abc247_d - [ABC247D] Cylinder
- AT_abc249_c - [ABC249C] Just K
- AT_abc250_c - [ABC250C] Adjacent Swaps
- AT_abc252_c - [ABC252C] Slot Strategy
- AT_abc253_c - [ABC253C] Max - Min Query
- AT_abc253_d - [ABC253D] FizzBuzz Sum Hard
- AT_abc254_c - [ABC254C] K Swap
- AT_abc255_b - [ABC255B] Light It Up
- AT_abc255_c - [ABC255C] ±1 Operation 1
- AT_abc256_c - [ABC256C] Filling 3x3 array
- AT_abc256_d - [ABC256D] Union of Interval
- AT_abc257_c - [ABC257C] Robot Takahashi
- AT_abc258_b - [ABC258B] Number Box
- AT_abc258_c - [ABC258C] Rotation
- AT_abc258_d - [ABC258D] Trophy
- AT_abc259_c - [ABC259C] XX to XXX
- AT_abc260_c - [ABC260C] Changing Jewels
- AT_abc262_c - [ABC262C] Min Max Pair
- AT_abc264_d - [ABC264D] "redocta".swap(i,i+1)
- AT_abc267_c - [ABC267C] Index × A(Continuous ver.)
- AT_abc268_c - [ABC268C] Chinese Restaurant
- AT_abc269_c - [ABC269C] Submask
- AT_abc269_d - [ABC269D] Do use hexagon grid
- AT_abc270_c - [ABC270C] Simple path
- AT_abc273_c - [ABC273C] (K+1)-th Largest Number
- AT_abc274_c - [ABC274C] Ameba
- AT_abc275_d - [ABC275D] Yet Another Recursive Function
- AT_abc276_b - [ABC276B] Adjacency List
- AT_abc276_c - [ABC276C] Previous Permutation
- AT_abc277_c - [ABC277C] Ladder Takahashi
- AT_abc278_c - [ABC278C] FF
- AT_abc287_c - [ABC287C] Path Graph?
- AT_abc288_c - [ABC288C] Don’t be cycle
- AT_abc289_c - [ABC289C] Coverage
- AT_abc289_d - [ABC289D] Step Up Robot
- AT_abc292_c - [ABC292C] Four Variables
- AT_abc292_d - [ABC292D] Unicyclic Components
- AT_abc293_c - [ABC293C] Make Takahashi Happy
- AT_abc294_d - [ABC294D] Bank
- AT_abc296_c - [ABC296C] Gap Existence
- AT_abc298_c - [ABC298C] Cards Query Problem
- AT_abc300_b - [ABC300B] Same Map in the RPG World
- AT_abc300_c - [ABC300C] Cross
- AT_abc300_d - [ABC300D] AABCC
- AT_abc301_c - [ABC301C] AtCoder Cards
- AT_abc302_b - [ABC302B] Find snuke
- AT_abc302_c - [ABC302C] Almost Equal
- AT_abc302_d - [ABC302D] Impartial Gift
- AT_abc303_c - [ABC303C] Dash
- AT_abc304_c - [ABC304C] Virus
- AT_abc305_c - [ABC305C] Snuke the Cookie Picker
- AT_abc306_d - [ABC306D] Poisonous Full-Course
- AT_abc307_b - [ABC307B] racecar
- AT_abc308_c - [ABC308C] Standings
- AT_abc309_c - [ABC309C] Medicine
- AT_abc317_c - [ABC317C] Remembering the Days
- AT_abc322_b - [ABC322B] Prefix and Suffix
- AT_abc322_c - [ABC322C] Festival
- AT_abc324_b - [ABC324B] 3-smooth Numbers
- AT_abc324_c - [ABC324C] Error Correction
- AT_abc326_c - [ABC326C] Peak
- AT_abc329_d - [ABC329D] Election Quick Report
- AT_abc330_c - [ABC330C] Minimize Abs 2
- AT_abc330_d - [ABC330D] Counting Ls
- AT_abc331_c - [ABC331C] Sum of Numbers Greater Than Me
- AT_abc332_c - [ABC332C] T-shirts
- AT_abc333_c - [ABC333C] Repunit Trio
- AT_abc334_b - [ABC334B] Christmas Trees
- AT_abc335_c - [ABC335C] Loong Tracking
- AT_abc335_d - [ABC335D] Loong and Takahashi
- AT_abc336_c - [ABC336C] Even Digits
- AT_abc337_d - [ABC337D] Cheating Gomoku Narabe
- AT_abc347_b - [ABC347B] Substring
- AT_abc389_c - [ABC389C] Snake Queue
- AT_abc390_b - [ABC390B] Geometric Sequence
- AT_abc390_c - [ABC390C] Paint to make a rectangle
- AT_abl_c - Connect Cities
- AT_agc001_a - [AGC001A] BBQ Easy
- AT_agc002_b - [AGC002B] Box and Ball
- AT_agc003_a - [AGC003A] Wanna go back home
- AT_agc004_a - [AGC004A] Divide a Cuboid
- AT_agc005_a - [AGC005A] STring
- AT_agc006_a - [AGC006A] Prefix and Suffix
- AT_agc010_a - [AGC010A] Addition
- AT_agc014_a - [AGC014A] Cookie Exchanges
- AT_agc015_a - [AGC015A] A+...+B Problem
- AT_agc017_a - [AGC017A] Biscuits
- AT_agc018_a - [AGC018A] Getting Difference
- AT_agc020_a - [AGC020A] Move and Win
- AT_agc024_a - [AGC024A] Fairness
- AT_agc027_a - [AGC027A] Candy Distribution Again
- AT_agc028_a - [AGC028A] Two Abbreviations
- AT_agc029_a - [AGC029A] Irreversible operation
- AT_agc030_a - [AGC030A] Poisonous Cookies
- AT_agc034_a - [AGC034A] Kenken Race
- AT_aising2019_b - Contests
- AT_aising2020_c - XYZ Triplets
- AT_arc002_3 - [ARC002C] コマンド入力
- AT_arc004_2 - [ARC004B] 2点間距離の最大と最小 ( Maximum and Minimum )
- AT_arc005_2 - [ARC005B] P-CASカードと高橋君
- AT_arc006_2 - [ARC006B] あみだくじ
- AT_arc008_2 - [ARC008B] 謎のたこ焼きおじさん
- AT_arc009_1 - [ARC009A] 元気にお使い！高橋君
- AT_arc013_1 - [ARC013A] 梱包できるかな？
- AT_arc020_1 - [ARC020A] 石を滑らせるゲーム
- AT_arc021_1 - [ARC021A] DEAD END
- AT_arc029_1 - [ARC029A] 高橋君とお肉
- AT_arc034_2 - [ARC034B] 方程式
- AT_arc045_a - [ARC045A] スペース高橋君
- AT_arc051_a - [ARC051A] 塗り絵
- AT_arc053_a - [ARC053A] ドミノ色塗り
- AT_arc056_a - [ARC056A] みんなでワイワイみかん
- AT_arc058_a - [ARC058C] こだわり者いろはちゃん
- AT_arc059_a - [ARC059C] いっしょ
- AT_arc067_a - [ABC052C] Factors of Factorial
- AT_arc068_a - [ABC053C] X: Yet Another Die Game
- AT_arc068_b - [ABC053D] Card Eater
- AT_arc070_a - [ABC056C] Go Home
- AT_arc073_a - [ABC060C] Sentou
- AT_arc075_a - [ABC063C] Bugged
- AT_arc079_a - [ABC068C] Cat Snuke and a Voyage
- AT_arc081_a - [ABC071C] Make a Rectangle
- AT_arc082_a - [ABC072C] Together
- AT_arc082_b - [ABC072D] Derangement
- AT_arc084_a - [ABC077C] Snuke Festival
- AT_arc085_a - [ABC078C] HSI
- AT_arc090_a - [ABC087C] Candies
- AT_arc091_a - [ABC090C] Flip,Flip, and Flip......
- AT_arc093_a - [ABC092C] Traveling Plan
- AT_arc094_a - [ABC093C] Same Integers
- AT_arc095_a - [ABC094C] Many Medians
- AT_arc098_a - [ABC098C] Attention
- AT_arc100_a - [ABC102C] Linear Approximation
- AT_arc104_b - [ARC104B] DNA Sequence
- AT_arc105_b - [ARC105B] MAX-=min
- AT_arc107_b - [ARC107B] Quadruple
- AT_arc108_b - [ARC108B] Abbreviate Fox
- AT_arc109_b - [ARC109B] log
- AT_arc110_b - [ARC110B] Many 110
- AT_arc113_b - [ARC113B] A^B^C
- AT_arc115_a - [ARC115A] Two Choices
- AT_arc117_b - [ARC117B] ARC Wrecker
- AT_arc118_a - [ARC118A] Tax Included Price
- AT_arc121_a - [ARC121A] 2nd Greatest Distance
- AT_arc123_b - [ARC123B] Increasing Triples
- AT_arc124_a - [ARC124A] LR Constraints
- AT_arc125_a - [ARC125A] Dial Up
- AT_arc126_a - [ARC126A] Make 10
- AT_arc128_a - [ARC128A] Gold and Silver
- AT_arc130_b - [ARC130B] Colorful Lines
- AT_arc132_a - [ARC132A] Permutation Grid
- AT_arc133_a - [ARC133A] Erase by Value
- AT_arc135_a - [ARC135A] Floor, Ceil - Decomposition
- AT_arc139_a - [ARC139A] Trailing Zeros
- AT_arc142_a - [ARC142A] Reverse and Minimize
- AT_arc142_b - [ARC142B] Unbalanced Squares
- AT_arc145_a - [ARC145A] AB Palindrome
- AT_arc147_a - [ARC147A] Max Mod Min
- AT_arc148_a - [ARC148A] mod M
- AT_arc151_a - [ARC151A] Equal Hamming Distances
- AT_autumn_fest_02 - 3Match
- AT_bitflyer2018_final_a - 値札
- AT_cf_2015_morning_easy_b - ヘイホー君と置き換え
- AT_cf_2015_relay_e - 反転時計
- AT_cf_2015_relay_g - 主菜と副菜
- AT_code_festival_2017_qualb_b - Problem Set
- AT_code_festival_2017_qualc_b - Similar Arrays
- AT_code_festival_final_d - パスカルの三角形
- AT_code_festival_morning_easy_a - 差の平均
- AT_code_festival_relay_j - Color Game
- AT_code_formula_2014_final_c - 次世代SNS
- AT_code_formula_2014_qualA_b - ボウリングゲーム
- AT_codefestival_2015_final_c - 寿司タワー
- AT_codefestival_2015_qualA_c - 8月31日
- AT_codefestival_2015_qualB_c - 旅館
- AT_codefestival_2016_qualA_b - 仲良しうさぎ
- AT_cpsco2019_s4_b - Meeting
- AT_ddcc2019_final_a - レース (Race)
- AT_ddcc2020_qual_b - Iron Bar Cutting
- AT_ddcc_2016_qual_c - ロト2
- AT_discovery_2016_final_a - DISCO presents ディスカバリーチャンネルプログラミングコンテスト 2016 Ⅱ
- AT_diverta2019_b - RGB Boxes
- AT_donuts_2015_1 - ドーナツの体積
- AT_donuts_live2014_3 - ソーシャルゲーム
- AT_dp_a - Frog 1
- AT_dp_b - Frog 2
- AT_dp_h - Grid 1
- AT_dwacon2018_prelims_b - 2525文字列分解
- AT_dwango2015_prelims_2 - ニコニコ文字列
- AT_dwango2016qual_b - 積み鉛筆
- AT_geocon2013_a - 役人
- AT_hhkb2020_c - Neq Min
- AT_hitachi2020_b - Nice Shopping
- AT_icpc2014autumn_a - North North West
- AT_icpc2015autumn_b - Change a Password
- AT_indeednow_2015_finala_c - Optimal Recommendations
- AT_indeednow_2015_qualb_2 - 高橋くんと文字列操作
- AT_iroha2019_day1_d - 肉と肉のぶつかり合い
- AT_joi2006ho_c - JOI 2006 本選 問題3
- AT_joi2007yo_f - 通学経路
- AT_joi2015yo_c - 気象予報士 (Weather Forecaster)
- AT_joi2020_yo1a_c - マージ (Merge)
- AT_joi2020_yo1c_c - 最長昇順連続部分列 (Longest Ascending Contiguous Subsequence)
- AT_joi2021_yo1a_c - 共通要素 (Common Elements)
- AT_joisc2007_mall - ショッピングモール (Mall)
- AT_jsc2021_c - Max GCD 2
- AT_k2pc001_e5 - お気に入りの数2(Favorite Number2)
- AT_k2pc001_h3 - お気に入りの数2(Favorite Number2)
- AT_keyence2019_b - KEYENCE String
- AT_keyence2019_c - Exam and Wizard
- AT_keyence2020_a - Painting
- AT_keyence2020_b - Robot Arms
- AT_keyence2020_c - Subarray Sum
- AT_keyence2021_b - Mex Boxes
- AT_kupc2012_3 - ソーシャル
- AT_kupc2012pr_4 - A mul B Problem
- AT_kupc2013_a - 旧総合研究７号館
- AT_kupc2013_g - 自由研究
- AT_kupc2015_a - 東京都
- AT_m_solutions2020_d - Road to Millionaire
- AT_nikkei2019_final_b - Big Integers
- AT_nikkei2019_qual_b - Touitsu
- AT_pakencamp_2021_day2_d - 選択問題の正答はすべて同じ選択肢で…
- AT_panasonic2020_d - String Equivalence
- AT_past202005_d - 電光掲示板
- AT_past202107_c - 入力チェック
- AT_past202107_e - 青木君のいたずら
- AT_qupc2014_a - 成績判定
- AT_qupc2014_b - 元素の系統名
- AT_relay_d - 魔方陣2
- AT_s8pc_5_a - Sushi 2
- AT_snuke21_a - Candles
- AT_soundhound2018_summer_final_a - Feel the  Beat
- AT_tdpc_contest - コンテスト
- AT_tdpc_semiexp - 準急
- AT_tenka1_2015_qualA_a - 展開図プログラマーコンテスト
- AT_tenka1_2015_qualB_a - 天下一プログラマーコンテスト1998
- AT_tenka1_2016_qualA_a - 天下一プログラマーゲーム
- AT_tkppc2016_b - 書き換え（Rewrite）
- AT_tkppc2016_c - 有給休暇（Paid Vacation）
- AT_tkppc4_2_a - Jumping!!
- AT_tricky_1 - 整数割り算
- AT_ttpc2015_b - ラー油
- AT_utpc2011_2 - (iwi)
- AT_utpc2011_5 - ファーストアクセプタンス
- AT_utpc2013_01 - UTPC
- AT_wupc2012_2 - パスワード
- AT_wupc2012_4 - 三角パズル
- AT_xmascon21_b - Bad Mood
- AT_xmascontest2015_g - Good Sequence
- AT_yahoo_procon2018_qual_b - オークション
- AT_yahoo_procon2019_qual_c - When I hit my pocket...


---


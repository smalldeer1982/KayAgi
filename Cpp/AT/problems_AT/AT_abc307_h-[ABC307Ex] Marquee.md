---
title: "[ABC307Ex] Marquee"
layout: "post"
diff: 省选/NOI-
pid: AT_abc307_h
tag: []
---

# [ABC307Ex] Marquee

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc307/tasks/abc307_h

英大文字および英小文字からなる長さ $ L $ の文字列 $ S $ が幅 $ W $ の電光掲示板に表示されており、$ S $ が右から左へ $ 1 $ 文字分の幅ずつスクロールするように切り替わっています。

表示は、$ S $ の最後の文字が左端から消えると同時に $ S $ の最初の文字が右端から現れる、$ L+W-1 $ 周期での繰り返しとなっています。

例えば $ W=5 $、$ S= $ `ABC` のとき、電光掲示板の表示は

- `ABC..`
- `BC...`
- `C....`
- `....A`
- `...AB`
- `..ABC`
- `.ABC.`

の $ 7 $ つの状態を繰り返します。（`.` は文字が表示されていないことを表します）

より厳密には、各 $ k=0,\ldots,L+W-2 $ に対して、表示が次のようになっている相異なる状態が定まります。

- $ x $ を $ L+W-1 $ で割ったあまりを $ f(x) $ と表す。電光掲示板の左から $ (i+1) $ 番目の位置には、$ f(i+k)\ <\ L $ のとき $ S $ の $ f(i+k)+1 $ 番目の文字が表示され、そうでないとき何も表示されていない。

英大文字, 英小文字, `.`, `_` からなる長さ $ W $ の文字列 $ P $ が与えられます。  
電光掲示板の $ L+W-1 $ 種類の状態のうち、`_` の箇所を除いて $ P $ と一致するものの個数を求めてください。  
より厳密には、以下の条件を満たす状態の個数を求めてください。

- 全ての $ i=1,\ldots,W $ に対して次のいずれかが成立する
  - $ P $ の $ i $ 文字目は `_` である
  - 電光掲示板の左から $ i $ 番目に表示されている文字が $ P $ の $ i $ 文字目と等しい
  - 電光掲示板の左から $ i $ 番目には何も表示されておらず、かつ、$ P $ の $ i $ 文字目は `.` である

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ L $ $ W $ $ S $ $ P $

## 输出格式

答えを出力せよ。

## 说明/提示

### 制約

- $ 1\ \leq\ L\ \leq\ W\ \leq\ 3\times\ 10^5 $
- $ L,W $ は整数である
- $ S $ は英大文字および英小文字のみからなる長さ $ L $ の文字列である
- $ P $ は英大文字, 英小文字, `.`, `_` のみからなる長さ $ W $ の文字列である

### Sample Explanation 1

電光掲示板の表示が `....A`, `...AB`, `..ABC` であるときの $ 3 $ 状態が該当します。

## 样例 #1

### 输入

```
3 5
ABC
..___
```

### 输出

```
3
```

## 样例 #2

### 输入

```
11 15
abracadabra
__.._________ab
```

### 输出

```
2
```

## 样例 #3

### 输入

```
20 30
abaababbbabaabababba
__a____b_____a________________
```

### 输出

```
2
```

## 样例 #4

### 输入

```
1 1
a
_
```

### 输出

```
1
```


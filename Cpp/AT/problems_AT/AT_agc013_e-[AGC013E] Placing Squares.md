---
title: "[AGC013E] Placing Squares"
layout: "post"
diff: 省选/NOI-
pid: AT_agc013_e
tag: []
---

# [AGC013E] Placing Squares

## 题目描述

[problemUrl]: https://atcoder.jp/contests/agc013/tasks/agc013_e

joisinoお姉ちゃんは、長さ $ N $ の棒を持っています。 この棒には $ M $ 個の印がついています。 $ i $ 個目の印は、棒の左端から距離 $ X_i $ の位置についています。

joisinoお姉ちゃんは、この棒の上にいくつかの正方形を置くことにしました。 正方形を置くにあたって、以下のような条件があります。

- 辺の長さが整数の正方形しか置いてはならない。
- 全ての正方形は、底辺が棒と接するように置かなくてはならない。
- 正方形は、棒の上に敷き詰められている必要がある。 つまり、正方形が棒からはみ出したり、上に正方形が乗っていないような棒の部分が存在したりしてはならない。
- 棒の印がついている部分の真上は、$ 2 $ つの正方形の境目であってはならない。

 ![](https://cdn.luogu.com.cn/upload/vjudge_pic/AT_agc013_e/60c8a1a1423174de467baae2e3cd9946ad507a48.png)条件を満たす配置とそうでない配置の例

 

ある正方形の配置の美しさとは、置かれている正方形の面積をすべて**掛け合わせた**値です。 joisinoお姉ちゃんは、上の条件を満たすような正方形の配置全てについて、その美しさを求め、その総和を知りたくなりました。 あなたの仕事は、joisinoお姉ちゃんの代わりにこれを求めるプログラムを作ることです。 なお、答えは非常に大きくなることがあるので、$ 10^9+7 $ で割った余りを出力してください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ M $ $ X_1 $ $ X_2 $ $ ... $ $ X_{M-1} $ $ X_M $

## 输出格式

あり得る正方形の配置全てについて、その美しさを求め、その総和を $ 10^9+7 $ で割った余りを出力せよ。

## 说明/提示

### 制約

- 入力は全て整数である
- $ 1\ \leq\ N\ \leq\ 10^9 $
- $ 0\ \leq\ M\ \leq\ 10^5 $
- $ 1\ \leq\ X_1\ <\ X_2\ <\ ...\ <\ X_{M-1}\ <\ X_M\ \leq\ N-1 $

### Sample Explanation 1

可能な配置は、 - 一辺の長さ $ 1 $ の正方形を左に、一辺の長さ $ 2 $ の正方形を右に置く - 一辺の長さ $ 3 $ の正方形を置く の $ 2 $ 通りで、その美しさの合計は、$ (1\ \times\ 1\ \times\ 2\ \times\ 2)\ +\ (3\ \times\ 3)\ =\ 13 $ となります。

## 样例 #1

### 输入

```
3 1
2
```

### 输出

```
13
```

## 样例 #2

### 输入

```
5 2
2 3
```

### 输出

```
66
```

## 样例 #3

### 输入

```
10 9
1 2 3 4 5 6 7 8 9
```

### 输出

```
100
```

## 样例 #4

### 输入

```
1000000000 0
```

### 输出

```
693316425
```


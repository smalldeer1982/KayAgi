---
title: "[AGC046F] Forbidden Tournament"
layout: "post"
diff: NOI/NOI+/CTSC
pid: AT_agc046_f
tag: ['动态规划 DP', '强连通分量']
---

# [AGC046F] Forbidden Tournament

## 题目描述

[problemUrl]: https://atcoder.jp/contests/agc046/tasks/agc046_f

整数 $ N,K $ と素数 $ P $ が与えられます。$ N $ 頂点の有向グラフ $ G $ であって、以下を全て満たすものの個数を $ P $ で割った余りを求めてください。ただし、頂点どうしは互いに区別します。

- $ G $ はトーナメントである。すなわち、$ G $ に多重辺や自己ループはなく、$ G $ のどの $ 2 $ 点 $ u,v $ に対しても、$ u\to\ v $ 辺または $ v\to\ u $ 辺のうちちょうど片方が存在する。
- $ G $ のどの頂点の入次数も $ K $ 以下である。
- $ G $ のどの相異なる $ 4 $ 頂点 $ a,b,c,d $ に対しても、$ a\to\ b,\ b\to\ c,\ c\to\ a,\ a\to\ d,\ b\to\ d,\ c\to\ d $ の $ 6 $ 辺がすべて同時に存在することはない。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ K $ $ P $

## 输出格式

条件を満たす有向グラフの個数を $ P $ で割った余りを出力せよ。

## 说明/提示

### 制約

- $ 4\ \leq\ N\ \leq\ 200 $
- $ \frac{N-1}{2}\ \leq\ K\ \leq\ N-1 $
- $ 10^8\ <\ P\ <\ 10^9 $
- $ N,K $ は整数である
- $ P $ は素数である

### Sample Explanation 1

$ 4 $ 頂点のグラフ $ 64 $ 個のうち、禁止された誘導部分グラフと同型である $ 8 $ 個を除いた $ 56 $ 個が条件を満たします。

## 样例 #1

### 输入

```
4 3 998244353
```

### 输出

```
56
```

## 样例 #2

### 输入

```
7 3 998244353
```

### 输出

```
720
```

## 样例 #3

### 输入

```
50 37 998244353
```

### 输出

```
495799508
```


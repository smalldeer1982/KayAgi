---
title: "[AGC055C] Weird LIS"
layout: "post"
diff: 省选/NOI-
pid: AT_agc055_c
tag: ['动态规划 DP', '数学', '排列组合']
---

# [AGC055C] Weird LIS

## 题目描述

[problemUrl]: https://atcoder.jp/contests/agc055/tasks/agc055_c

整数 $ N,\ M $ が与えられます。次の条件を満たす長さ $ N $ の列 $ A=[A_1,\ A_2,\ \ldots,\ A_N] $ の個数を求めてください。

- $ 2\ \le\ A_i\ \le\ M $ ($ 1\ \leq\ i\ \leq\ N $)
- $ 1 $ から $ N $ までの整数の順列 $ P=[P_1,P_2,\ldots,P_N] $ であって次の性質を持つものが存在する。
  - $ 1 $ から $ N $ までの各 $ i $ について、$ A_i $ は列 $ [P_1,\ P_2,\ \ldots,\ P_{i-1},\ P_{i+1},\ \ldots,\ P_{N-1},\ P_N] $ の最長増加部分列の長さに等しい。

この個数は非常に大きい可能性があるため、これを素数 $ Q $ で割った余りを出力してください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ M $ $ Q $

## 输出格式

答えを $ Q $ で割った余りを出力せよ。

## 说明/提示

### 制約

- $ 3\ \le\ N\ \le\ 5000 $
- $ 2\ \le\ M\ \le\ N-1 $
- $ 10^8\ \le\ Q\ \le\ 10^9 $
- $ Q $ は素数である。

### Sample Explanation 1

このような列は $ [2,\ 2,\ 2] $ のみです。ここで $ [1,\ 2,\ 3] $ という順列が存在して性質を満たします。

### Sample Explanation 2

このような列は次の $ 9 $ 個です: $ [2,\ 2,\ 2,\ 2] $, $ [2,\ 2,\ 2,\ 3] $, $ [2,\ 2,\ 3,\ 2] $, $ [2,\ 2,\ 3,\ 3] $, $ [2,\ 3,\ 2,\ 2] $, $ [2,\ 3,\ 3,\ 2] $, $ [3,\ 2,\ 2,\ 2] $, $ [3,\ 3,\ 2,\ 2] $, $ [3,\ 3,\ 3,\ 3] $。

### Sample Explanation 3

このような列は $ [2,\ 2,\ 2,\ 2,\ 2] $ のみです。

## 样例 #1

### 输入

```
3 2 686926217
```

### 输出

```
1
```

## 样例 #2

### 输入

```
4 3 354817471
```

### 输出

```
9
```

## 样例 #3

### 输入

```
5 2 829412599
```

### 输出

```
1
```

## 样例 #4

### 输入

```
5 3 975576997
```

### 输出

```
23
```

## 样例 #5

### 输入

```
69 42 925171057
```

### 输出

```
801835311
```


---
title: "[AGC063D] Many CRT"
layout: "post"
diff: NOI/NOI+/CTSC
pid: AT_agc063_d
tag: ['数学', '数论', '中国剩余定理 CRT']
---

# [AGC063D] Many CRT

## 题目描述

[problemUrl]: https://atcoder.jp/contests/agc063/tasks/agc063_d

正整数 $ N,\ a,\ b,\ c,\ d $ が与えられます．

$ k=0,1,\ldots,N-1 $ すべてに対して $ x\equiv\ a+kb\ \pmod{c+kd} $ が成り立つような非負整数 $ x $ が存在するか否かを判定してください．存在する場合には，そのような $ x $ のうち最小のものを $ 998244353 $ で割った余りを求めてください．

## 输入格式

入力は以下の形式で標準入力から与えられます．

> $ N $ $ a $ $ b $ $ c $ $ d $

## 输出格式

条件を満たす非負整数 $ x $ が存在しない場合には `-1` を出力してください．存在する場合には，そのような $ x $ のうち最小のものを $ 998244353 $ で割った余りを出力してください．

## 说明/提示

### 制約

- $ 2\leq\ N\leq\ 10^6 $
- $ 1\leq\ a,b,c,d\leq\ 10^6 $
 
### Sample Explanation 1

$ x\equiv\ 1\pmod{3} $ かつ $ x\equiv\ 3\pmod{7} $ を満たす最小の非負整数は $ x=10 $ です．

### Sample Explanation 2

$ x\equiv\ 1\pmod{10} $ かつ $ x\equiv\ 2\pmod{20} $ を満たす非負整数は存在しません．

### Sample Explanation 3

条件を満たす最小の非負整数は $ x=\ 0 $ です．

### Sample Explanation 4

条件を満たす最小の非負整数は $ x=\ 15977769171609124 $ です．

## 样例 #1

### 输入

```
2 1 2 3 4
```

### 输出

```
10
```

## 样例 #2

### 输入

```
2 1 1 10 10
```

### 输出

```
-1
```

## 样例 #3

### 输入

```
100 20 30 2 3
```

### 输出

```
0
```

## 样例 #4

### 输入

```
9 12 34 56 78
```

### 输出

```
827501367
```


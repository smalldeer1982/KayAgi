---
title: "[ARC159F] Good Division"
layout: "post"
diff: 省选/NOI-
pid: AT_arc159_f
tag: ['动态规划 DP', 'cdq 分治']
---

# [ARC159F] Good Division

## 题目描述

[problemUrl]: https://atcoder.jp/contests/arc159/tasks/arc159_f

数列 $ X $ が次の条件を満たす時、$ X $ を**良い数列**と呼ぶことにします。

- 次の操作を $ 0 $ 回以上繰り返すことで $ X $ を空の列に出来る。
  - $ X $ の隣り合う $ 2 $ 要素 $ x_i,x_{i+1} $ であって $ x_i\ \neq\ x_{i+1} $ を満たすものを選び、削除する。
 
$ 2N $ 要素の数列 $ A=(a_1,\ldots,a_{2N}) $ が与えられます。  
 $ A $ を $ 1 $ 個以上の連続部分列に分割する方法は $ 2^{2N-1} $ 通りありますが、そのうち各連続部分列がすべて良い数列であるようなものが何通りあるかを $ 998244353 $ で割った余りを求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ a_1 $ $ \ldots $ $ a_{2N} $

## 输出格式

答えを出力せよ。

## 说明/提示

### 制約

- $ 1\ \leq\ N\ \leq\ 5\ \times\ 10^5 $
- $ 1\ \leq\ a_i\ \leq\ 2N $
- 入力はすべて整数
 
### Sample Explanation 1

以下の $ 2 $ 通りの分割方法が条件を満たします。 - $ (1,1,2,3,4,5) $ - $ (1,1,2,3),(4,5) $

## 样例 #1

### 输入

```
3
1 1 2 3 4 5
```

### 输出

```
2
```

## 样例 #2

### 输入

```
1
1 2
```

### 输出

```
1
```

## 样例 #3

### 输入

```
1
1 1
```

### 输出

```
0
```

## 样例 #4

### 输入

```
12
4 2 17 12 18 15 17 4 22 6 9 20 21 16 23 16 13 2 20 15 16 3 7 15
```

### 输出

```
2048
```


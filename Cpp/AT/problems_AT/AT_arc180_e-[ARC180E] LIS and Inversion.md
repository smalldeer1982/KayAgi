---
title: "[ARC180E] LIS and Inversion"
layout: "post"
diff: NOI/NOI+/CTSC
pid: AT_arc180_e
tag: ['动态规划 DP', 'Ad-hoc']
---

# [ARC180E] LIS and Inversion

## 题目描述

[problemUrl]: https://atcoder.jp/contests/arc180/tasks/arc180_e

長さ $ N $ の整数列 $ A=(A_1,A_2,\cdots,A_N) $ が与えられます． ここで，各 $ i $ について $ 0\ \leq\ A_i\ <\ i $ が保証されます．

$ (1,2,\cdots,N) $ の順列 $ P=(P_1,P_2,\cdots,P_N) $ の**スコア**と**コスト**を次のように定義します．

- $ P $ のスコアは，$ P $ の最長増加部分列の長さである．
- $ P $ のコストは，以下の条件を満たす整数 $ i $ ($ 1\ \leq\ i\ \leq\ N $) の個数である．
  - $ j\ <\ i $ かつ $ P_j\ >\ P_i $ を満たす整数 $ j $ の個数が $ A_i $ 未満．
 
各 $ k=1,2,\cdots,N $ について次の問題を解いてください．

- スコアが $ k $ 以上の順列 $ P $ の最小コストを求めよ．

## 输入格式

入力は以下の形式で標準入力から与えられる．

> $ N $ $ A_1 $ $ A_2 $ $ \cdots $ $ A_N $

## 输出格式

$ k=1,2,\cdots,N $ に対する答えをこの順に出力せよ．

## 说明/提示

### 制約

- $ 1\ \leq\ N\ \leq\ 250000 $
- $ 0\ \leq\ A_i\ <\ i $
- 入力される値はすべて整数
 
### Sample Explanation 1

各 $ k $ について，解となる $ P $ は以下のとおりです． - $ k=1 $: $ P=(4,2,1,3) $ とすれば，$ P $ のスコアは $ 2 $ でコストは $ 0 $ になります． - $ k=2 $: $ P=(4,3,1,2) $ とすれば，$ P $ のスコアは $ 2 $ でコストは $ 0 $ になります． - $ k=3 $: $ P=(4,1,2,3) $ とすれば，$ P $ のスコアは $ 3 $ でコストは $ 1 $ になります． - $ k=4 $: $ P=(1,2,3,4) $ とすれば，$ P $ のスコアは $ 4 $ でコストは $ 3 $ になります．

## 样例 #1

### 输入

```
4
0 1 2 1
```

### 输出

```
0 0 1 3
```

## 样例 #2

### 输入

```
3
0 0 0
```

### 输出

```
0 0 0
```

## 样例 #3

### 输入

```
5
0 1 2 3 4
```

### 输出

```
0 1 2 3 4
```

## 样例 #4

### 输入

```
11
0 0 2 3 4 5 3 7 8 2 10
```

### 输出

```
0 0 0 1 2 3 4 5 7 8 9
```


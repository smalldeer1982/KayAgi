---
title: "01 Inversion Expected"
layout: "post"
diff: NOI/NOI+/CTSC
pid: AT_awtf2024_b
tag: ['杨表']
---

# 01 Inversion Expected

## 题目描述

[problemUrl]: https://atcoder.jp/contests/awtf2024-open/tasks/awtf2024_b

`0`, `1` からなる長さ $ N $ の文字列 $ S $ が与えられます． 整数の組 $ (i,j) $ ($ 1\ \leq\ i\ <\ j\ \leq\ N $) であって，$ S $ の $ i $ 文字目が `1`, $ j $ 文字目が `0` であるようなものを**転倒ペア**と呼ぶことにします．

$ S $ 内に転倒ペアが存在する限り，以下の操作を行います．

- 転倒ペア $ (i,j) $ をランダムに一つ選ぶ．選択はこれ以前の選択と独立で，かつ一様ランダムであるとする． そして，$ S $ の $ i $ 文字目と $ j $ 文字目を入れ替える．
 
操作回数の期待値を $ \text{mod\ }{998244353} $ で求めてください．

  期待値 $ \text{mod\ }{998244353} $ の定義求める期待値は必ず有理数になることが証明できます． また，この問題の制約のもとでは，その値を既約分数 $ \frac{P}{Q} $ で表した時，$ Q\ \neq\ 0\ \pmod{998244353} $ となることも証明できます． よって，$ R\ \times\ Q\ \equiv\ P\ \pmod{998244353},\ 0\ \leq\ R\ <\ 998244353 $ を満たす整数 $ R $ が一意に定まります． この $ R $ を答えてください．

## 输入格式

入力は以下の形式で標準入力から与えられる．

> $ N $ $ S $

## 输出格式

答えを出力せよ．

## 说明/提示

### 制約

- $ 1\ \leq\ N\ \leq\ 250000 $
- $ S $ は `0`, `1` からなる長さ $ N $ の文字列
 
### Sample Explanation 1

操作回数の期待値は $ 1 $ です．

### Sample Explanation 2

操作回数の期待値は $ 3/2 $ です．

## 样例 #1

### 输入

```
2
10
```

### 输出

```
1
```

## 样例 #2

### 输入

```
3
110
```

### 输出

```
499122178
```

## 样例 #3

### 输入

```
1
0
```

### 输出

```
0
```

## 样例 #4

### 输入

```
10
1011000010
```

### 输出

```
133099253
```

## 样例 #5

### 输入

```
100
0101110010001000111000111001001101001100000111110001010010001010101100011001011011101101100001100111
```

### 输出

```
407907276
```


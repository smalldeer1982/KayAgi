---
title: "Square"
layout: "post"
diff: 省选/NOI-
pid: AT_caddi2018_d
tag: []
---

# Square

## 题目描述

[problemUrl]: https://atcoder.jp/contests/caddi2018/tasks/caddi2018_d

高橋君は、$ N $ 行 $ N $ 列のマス目を持っています。マス目の上から $ i $ 番目、左から $ j $ 番目のマスは $ (i,j) $ で表されます。 特に、マス目の左上のマスは $ (1,1) $ であり、右下のマスは $ (N,N) $ です。

高橋君の持っているマス目のうち $ M $ 個のマスには、$ 0 $ または $ 1 $ の整数が書き込まれています。 整数が書き込まれたマスのうち $ i $ 番目のマスの情報は $ 3 $ つの整数 $ a_i,b_i,c_i $ で表され、マス $ (a_i,b_i) $ に整数 $ c_i $ が書き込まれていることを表します。

高橋君は、以下の条件を満たすように残りのマスに $ 0 $ または $ 1 $ の整数を書き込むことにしました。 書き込み方としてありうるものの個数を $ 998244353 $ で割ったあまりを求めてください。

- 任意の $ 1\leq\ i\ <\ j\leq\ N $ に対し、$ (i,i) $ を左上のマスとし $ (j,j) $ を右下のマスとするような正方形領域に書き込まれた $ 1 $ の個数が偶数である

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ M $ $ a_1 $ $ b_1 $ $ c_1 $ $ : $ $ a_M $ $ b_M $ $ c_M $

## 输出格式

書き込み方としてありうるものの個数を $ 998244353 $ で割ったあまりを出力せよ。

## 说明/提示

### 制約

- $ 2\ \leq\ N\ \leq\ 10^5 $
- $ 0\ \leq\ M\ \leq\ min(5\ \times\ 10^4,N^2) $
- $ 1\ \leq\ a_i,b_i\ \leq\ N(1\leq\ i\leq\ M) $
- $ 0\ \leq\ c_i\ \leq\ 1(1\leq\ i\leq\ M) $
- $ i\ \neq\ j $ ならば $ (a_i,b_i)\ \neq\ (a_j,b_j) $ である
- 入力はすべて整数である

### Sample Explanation 1

例えば、以下のような書き込み方が条件を満たします。 ``` 101 111 011 111 000 011 ```

## 样例 #1

### 输入

```
3 3
1 1 1
3 1 0
2 3 1
```

### 输出

```
8
```

## 样例 #2

### 输入

```
4 5
1 3 1
2 4 0
2 3 1
4 2 1
4 4 1
```

### 输出

```
32
```

## 样例 #3

### 输入

```
3 5
1 3 1
3 3 0
3 1 0
2 3 1
3 2 1
```

### 输出

```
0
```

## 样例 #4

### 输入

```
4 8
1 1 1
1 2 0
3 2 1
1 4 0
2 1 1
1 3 0
3 4 1
4 4 1
```

### 输出

```
4
```

## 样例 #5

### 输入

```
100000 0
```

### 输出

```
342016343
```


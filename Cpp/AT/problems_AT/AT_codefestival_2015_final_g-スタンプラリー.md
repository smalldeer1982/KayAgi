---
title: "スタンプラリー"
layout: "post"
diff: 难度0
pid: AT_codefestival_2015_final_g
tag: []
---

# スタンプラリー

## 题目描述

一棵根为 $1$ 大小为 $N$ 的树，进行深度优先搜索，第一次访问到一个节点将其加入队列 $C$，接下来优先访问儿子节点中未访问过的编号最小的节点。现给出 $C$，问可能的树的形态的种类数。

## 输入格式

第一行输入一个 $N(2\le N\le256)$，即树的大小。

接下来 $2$ 到 $N+1$ 行，第 $i+1$ 行表示 $C_{i}(1\le C_{i}\le N)$，保证 $C$ 是一个排列。

## 输出格式

输出一个数，表示树的形态的种类数对 $10^9+7$ 取模的结果，末尾**需要换行**。

## 样例 #1

### 输入

```
4
1
2
4
3
```

### 输出

```
3
```

## 样例 #2

### 输入

```
2
2
1
```

### 输出

```
0
```

## 样例 #3

### 输入

```
30
1
28
14
7
27
17
25
4
26
2
10
19
11
12
13
23
29
20
18
3
16
24
22
5
30
9
15
6
21
8
```

### 输出

```
348275800
```


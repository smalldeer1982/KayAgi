---
title: "ディスコ社内ツアーⅡ"
layout: "post"
diff: 省选/NOI-
pid: AT_discovery_2016_final_d
tag: []
---

# ディスコ社内ツアーⅡ

## 题目描述

给定一个 $N$ 个顶点， $M$ 条边的有向图，第 $i$ 条边会被记为 `O` 或 `E`。

遍历由顶点 $s$ 开始，至 $t$ 结束。

图中的边若被记为 `O` ：则该条边可以通过奇数次；
若被记为 `E` ：则该条边可以通过偶数次（可为 $0$ 次）。

询问遍历有多少种走法。

## 输入格式

格式如下：

第一行给出两个数 $N$，$M$ $(2 \le N \le 200，1\le M \le N(N-1))$。

接下来 $M$ 行，每行有两个数和一个字符 `O` 或 `E` ，分别表示起点 $s$ 和终点 $t$ ，和该边被标记的类型。

给出的图不含有重边和自环。

## 输出格式

输出答案表示方案总数。



**谢谢！**

## 样例 #1

### 输入

```
2 1
1 2 O
```

### 输出

```
1
```

## 样例 #2

### 输入

```
2 1
1 2 E
```

### 输出

```
2
```

## 样例 #3

### 输入

```
4 2
1 2 O
3 4 E
```

### 输出

```
1
```

## 样例 #4

### 输入

```
4 2
1 2 O
3 4 O
```

### 输出

```
0
```

## 样例 #5

### 输入

```
3 3
1 2 O
2 3 O
3 1 O
```

### 输出

```
3
```

## 样例 #6

### 输入

```
4 5
1 2 O
2 1 O
2 3 O
3 1 E
2 4 O
```

### 输出

```
1
```

## 样例 #7

### 输入

```
4 3
1 2 O
2 1 O
3 4 E
```

### 输出

```
2
```

## 样例 #8

### 输入

```
2 2
1 2 O
2 1 E
```

### 输出

```
2
```

## 样例 #9

### 输入

```
4 3
1 2 O
1 3 O
1 4 O
```

### 输出

```
0
```


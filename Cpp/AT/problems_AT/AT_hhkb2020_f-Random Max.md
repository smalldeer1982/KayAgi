---
title: "Random Max"
layout: "post"
diff: 省选/NOI-
pid: AT_hhkb2020_f
tag: ['概率论', '期望', '积分']
---

# Random Max

## 题目描述

[problemUrl]: https://atcoder.jp/contests/hhkb2020/tasks/hhkb2020_f

$ N $ 個の連続型確率変数 $ x_i $ ($ 1\ <\ =\ i\ <\ =\ N $) があり、それぞれ $ [L_i,\ R_i] $ の範囲をとる連続一様分布にしたがいます。 (すなわち、$ x_i $ は $ L_i $ 以上 $ R_i $ 以下の実数を等確率でとりうるランダムな変数です)

本問題の制約下では、これらの $ N $ 個の確率変数の最大値の期待値を $ E $ とすると、$ E\ \times\ (N+1)!\ \times\ \prod_{i=1}^N\ (R_i\ -\ L_i) $ は正整数であることが示せます。この値を $ 1,000,000,007 $ で割ったあまりを求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ L_1 $ $ R_1 $ $ : $ $ L_N $ $ R_N $

## 输出格式

$ E\ \times\ (N+1)!\ \times\ \prod_{i=1}^N\ (R_i\ -\ L_i) $ を $ 1,000,000,007 $ で割ったあまりを整数で出力せよ。

## 说明/提示

### 制約

- $ 1\ <\ =\ N\ <\ =\ 1000 $
- $ 0\ <\ =\ L_i\ <\ R_i\ <\ =\ 10^9 $
- 入力は全て整数

### Sample Explanation 1

この確率変数の最大値の期待値は、とりうる範囲の中央値、すなわち $ E\ =\ \frac{3}{2} $ に等しいです。 よって、 $ E\ \times\ (N+1)!\ \times\ (R_1\ -\ L_1)\ =\ E\ \times\ 2\ =\ 3 $ が正解となります。

### Sample Explanation 2

求める期待値は $ E\ =\ \frac{5}{3} $ です。

## 样例 #1

### 输入

```
1
1 2
```

### 输出

```
3
```

## 样例 #2

### 输入

```
2
1 2
1 2
```

### 输出

```
10
```

## 样例 #3

### 输入

```
2
1 2
2 4
```

### 输出

```
36
```

## 样例 #4

### 输入

```
5
40 96
81 92
16 384
32 768
65 536
```

### 输出

```
52776507
```


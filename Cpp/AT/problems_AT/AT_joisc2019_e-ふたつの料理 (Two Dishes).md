---
title: "ふたつの料理 (Two Dishes)"
layout: "post"
diff: 省选/NOI-
pid: AT_joisc2019_e
tag: []
---

# ふたつの料理 (Two Dishes)

## 题目描述

有两道菜 $A$ 和 $B$，分别有 $n$ 道和 $m$ 个步骤，时间从 $0$ 时刻开始。每个步骤都有三个参数 $t,e,c$ 表示该步骤需要 $t$ 时间完成，若其在 $e$ 时刻前完成，则你获得 $c$ 的分数，$c_i$ 可能为负。

你需要决策进行步骤的次序，每时每刻都只能进行一个步骤；每个步骤都必须连续进行，不能拆开；同时要求每道菜内部都必须按照顺序进行，两道菜菜之间互不影响，求最大分数和。

$1\le n,m\le 10^6$，$1\le t_i\le 10^9$，$1\le e_i\le 2\times 10^{15}$，$|c_i|\le 10^9$。

## 输入格式

第一行两个正整数 $n,m$。

接下来 $n$ 行，每行三个整数，第 $i$ 行三个正整数 $ta_i,ea_i,ca_i$，顺序描述 A 的步骤。

接下来 $m$ 行，每行三个整数，第 $i$ 行三个正整数 $tb_i,eb_i,cb_i$，顺序描述 B 的步骤。

## 输出格式

输出一行一个整数表示答案。

### 样例1

```
4 3
2 1 1
3 8 1
2 13 1
1 13 1
3 6 1
2 11 1
2 15 1
```

```
6
```

### 样例2

```
5 7
16 73 16
17 73 10
20 73 1
14 73 16
18 73 10
3 73 2
10 73 7
16 73 19
12 73 4
15 73 15
20 73 14
15 73 8
```

```
63
```

### 样例3

```
9 11
86 565 58
41 469 -95
73 679 28
91 585 -78
17 513 -63
48 878 -66
66 901 59
72 983 -70
68 1432 11
42 386 -87
36 895 57
100 164 10
96 812 -6
23 961 -66
54 193 51
37 709 82
62 148 -36
28 853 22
15 44 53
77 660 -19
```

```
99
```


---
title: "ニワトリのお見合い"
layout: "post"
diff: 难度0
pid: AT_past202109_k
tag: []
---

# ニワトリのお見合い

## 题目描述

有 $p$ 名男生（编号 $1$ 到 $p$）和 $q$ 名女生（编号 $1$ 到 $q$）要参加一场舞会。

给出一个 $p$ 行 $q$ 列的方阵 $s$，其中 $s_{i,j}$ 必为 $0$ 或 $1$ 中的一个。若 $s_{i,j}$ 为 $1$，则男生 $i$ 和女生 $j$ 愿意一起跳舞；若 $s_{i,j}$ 为 $0$，则男生 $i$ 和女生 $j$ 不愿意一起跳舞。

选择一部分人（可能没人）并将他们结为舞伴。一个人至多只能有 $1$ 个舞伴，并且他/她愿意与他/她的舞伴跳舞。

结完舞伴后，如果男生 $i$ 有舞伴，那么他的快乐指数为 $a_i$；否则，他的快乐指数为 $b_i$。同理，如果女生 $i$ 有舞伴，那么她的快乐指数为 $c_i$；否则，她的快乐指数为 $d_i$。

请求出所有人的快乐指数之和的最大值。

## 输入格式

第一行：两个整数 $p,q$。

接下来 $p$ 行：每行为一个长为 $q$ 的 $01$ 串 $s_i$。$s_i$ 的第 $j$ 个字符即为 $s_{i,j}$。（下标从 $1$ 到 $q$）

接下来 $p$ 行：每行两个整数 $a_i,b_i$。

接下来 $q$ 行：每行两个整数 $c_i,d_i$。

## 输出格式

一行一个整数。

## 说明/提示

#### 样例 #1 说明

让男生 $1$ 和女生 $3$ 跳舞，男生 $2$ 和女生 $4$ 一起跳舞，快乐指数之和为 
$7+6+9+3+1+8+9+6=49$，达到最大值。

#### 样例 #2 说明

有可能无法配对，也有可能不会有任何结对的舞伴。

#### 数据规模与约定

$1 \le p,q \le 100$，$1 \le a_i,b_i,c_i,d_i \le 10^9$。

## 样例 #1

### 输入

```
4 4
0010
1111
0010
0010
7 4
6 1
4 9
5 3
1 1
2 8
9 4
6 5
```

### 输出

```
49
```

## 样例 #2

### 输入

```
3 4
0000
0000
0000
1 2
3 4
5 6
7 8
9 10
11 12
13 14
```

### 输出

```
56
```

## 样例 #3

### 输入

```
4 3
100
100
100
111
5 4
3 2
9 8
100 1
200 50
10 9
8 6
```

### 输出

```
332
```


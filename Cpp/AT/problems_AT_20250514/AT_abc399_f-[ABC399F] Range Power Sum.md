---
title: "[ABC399F] Range Power Sum"
layout: "post"
diff: 普及+/提高
pid: AT_abc399_f
tag: ['动态规划 DP', '组合数学']
---

# [ABC399F] Range Power Sum

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc399/tasks/abc399_f

给定正整数 $N, K$ 以及长度为 $N$ 的整数序列 $A = (A_1, A_2, \dots, A_N)$。  
请计算以下表达式的值对 $998244353$ 取模后的余数：

$$
\displaystyle \sum_{1 \leq l \leq r \leq N} \left( \sum_{l \leq i \leq r} A_i \right)^K
$$

## 输入格式

输入通过标准输入给出，格式如下：

> $N$ $K$  
> $A_1$ $A_2$ $\dots$ $A_N$

## 输出格式

输出计算结果对 $998244353$ 取模后的余数。

## 说明/提示

### 约束条件

- $1 \leq N \leq 2 \times 10^5$
- $1 \leq K \leq 10$
- $0 \leq A_i < 998244353$
- 输入均为整数

### 样例解释 1

所求的值为 $A_1^2 + A_2^2 + A_3^2 + (A_1 + A_2)^2 + (A_2 + A_3)^2 + (A_1 + A_2 + A_3)^2 = 3^2 + 1^2 + 2^2 + 4^2 + 3^2 + 6^2 = 75$。

### 样例解释 3

注意需要对结果取 $998244353$ 的模。

翻译由 DeepSeek R1 完成

## 样例 #1

### 输入

```
3 2
3 1 2
```

### 输出

```
75
```

## 样例 #2

### 输入

```
1 10
0
```

### 输出

```
0
```

## 样例 #3

### 输入

```
10 5
91 59 85 60 57 72 12 3 27 16
```

### 输出

```
428633385
```


---
title: "[ABC400F] Happy Birthday! 3"
layout: "post"
diff: 提高+/省选-
pid: AT_abc400_f
tag: ['区间 DP']
---

# [ABC400F] Happy Birthday! 3

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc400/tasks/abc400_f

存在一个被沿着半径切割成 $N$ 等分的圆形蛋糕。

各分块按顺时针方向编号为 $1, 2, \ldots, N$。此外，对于满足 $1 \leq i \leq N$ 的整数 $i$，分块 $i$ 也可以被称为分块 $N + i$。

初始时，所有分块的颜色均为颜色 $0$。

你可以执行以下操作任意次数：

- 选择满足 $1 \leq a, b, c \leq N$ 的整数 $a, b, c$。对于每个满足 $0 \leq i < b$ 的整数 $i$，将分块 $a + i$ 的颜色修改为颜色 $c$。此操作需花费 $b + X_c$ 的成本。

请找出使得所有满足 $1 \leq i \leq N$ 的整数 $i$ 对应的分块 $i$ 颜色变为 $C_i$ 时，所需总成本的最小值。

## 输入格式

输入通过标准输入给出，格式如下：

> $N$  
> $C_1$ $C_2$ $\ldots$ $C_N$  
> $X_1$ $X_2$ $\ldots$ $X_N$

## 输出格式

输出答案。

## 说明/提示

### 约束条件

- $1 \leq N \leq 400$
- $1 \leq C_i \leq N$
- $1 \leq X_i \leq 10^9$
- 输入中的所有值均为整数

### 样例解释 1

设分块 $i$ 的颜色为 $A_i$。初始时，$(A_1, A_2, A_3, A_4, A_5, A_6) = (0, 0, 0, 0, 0, 0)$。  
以 $(a, b, c) = (2, 1, 4)$ 执行操作后，$(A_1, A_2, A_3, A_4, A_5, A_6) = (0, 4, 0, 0, 0, 0)$。  
以 $(a, b, c) = (3, 3, 2)$ 执行操作后，$(A_1, A_2, A_3, A_4, A_5, A_6) = (0, 4, 2, 2, 2, 0)$。  
以 $(a, b, c) = (1, 1, 1)$ 执行操作后，$(A_1, A_2, A_3, A_4, A_5, A_6) = (1, 4, 2, 2, 2, 0)$。  
以 $(a, b, c) = (4, 1, 1)$ 执行操作后，$(A_1, A_2, A_3, A_4, A_5, A_6) = (1, 4, 2, 1, 2, 0)$。  
以 $(a, b, c) = (6, 1, 5)$ 执行操作后，$(A_1, A_2, A_3, A_4, A_5, A_6) = (1, 4, 2, 1, 2, 5)$。  
此时总成本为 $(1 + X_4) + (3 + X_2) + (1 + X_1) + (1 + X_1) + (1 + X_5) = (1+4) + (3+2) + (1+1) + (1+1) + (1+6) = 20$。

翻译由 DeepSeek R1 完成

## 样例 #1

### 输入

```
6
1 4 2 1 2 5
1 2 3 4 5 6
```

### 输出

```
20
```

## 样例 #2

### 输入

```
5
1 2 3 4 5
1000000000 1000000000 1000000000 1000000000 1000000000
```

### 输出

```
5000000005
```

## 样例 #3

### 输入

```
8
2 3 3 1 2 1 3 1
3 4 1 2 5 3 1 2
```

### 输出

```
23
```


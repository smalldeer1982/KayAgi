# [AGC069C] AB*A Changing

## 题目描述

现有两个长度为 $N$ 的字符串 $S$ 和 $T$，它们都只由字符 `A` 和 `B` 组成。我们用 $s_i$ 来表示字符串 $S$ 的第 $i$ 个字符。

对于字符串 $S$，你可以反复进行以下操作不限次数：

- 选择两个整数 $(i, j)$，要求满足：
  - $1 \leq i < j \leq N$
  - $s_i = s_j = \text{A}$
  - $s_{i+1}, s_{i+2}, \ldots, s_{j-1}$ 都为 `B`
  
- 然后，将 $s_i, s_{i+1}, \ldots, s_j$ 这段字符同时替换为它们相反的字符，即 `A` 换成 `B`，`B` 换成 `A`。

你的任务是判断，通过这种操作，能否将 $S$ 变成 $T$，如果可以，求出最小操作次数；如果不可以，输出 `-1`。

## 说明/提示

- $1 \leq N \leq 200,000$
- $S, T$ 均为由 `A` 和 `B` 组成的长度为 $N$ 的字符串

### 示例说明

#### 示例 1

通过下面的操作，可以用 2 次将 $S$ 变为 $T$：
1. 选择 $(i, j) = (2, 3)$，此时 $S$ 变为 `ABBBA`。
2. 选择 $(i, j) = (1, 5)$，此时 $S$ 变为 `BAAAB`。

所以，最少操作次数为 2。

#### 示例 2

不能通过任何操作将 $S$ 变为 $T$，因而答案是 `-1`。注意：要求 $i < j$。

#### 示例 3

此时 $S$ 和 $T$ 本来就相同，不需任何操作。

 **本翻译由 AI 自动生成**

## 样例 #1

### 输入

```
5
AAABA
BAAAB```

### 输出

```
2```

## 样例 #2

### 输入

```
1
A
B```

### 输出

```
-1```

## 样例 #3

### 输入

```
1
A
A```

### 输出

```
0```

## 样例 #4

### 输入

```
10
AAABBABAAB
BBABBAAABB```

### 输出

```
7```

# 题解

## 作者：Rainbow_qwq (赞：2)

从左到右扫描序列，把每次操作的线段看作左边加入/右边删除，记录经过当前位置的线段数量。

在每个位置会有若干条线段开始（操作 $A\to B$），若干条线段结束（操作 $A\to B$），有若干条线段经过（操作 $B\to A$）。

考虑 DP，设 $f(i,j)$ 表示扫到第 $i$ 个位置，往后还有 $j$ 条线段没结束。转移时枚举一下删除/加入的线段数量，并且要满足 $s_i$ 变化的要求（如 $A\to B\to A\to \cdots\to B$）。

然后由于一些不知道什么原因，DP 的第二维只需要开一个很小的常数就对了（credit from noshi91，proof by AC，我不会证），实际上只需要开到 $4$。

时间复杂度 $O(n)$。

```cpp
int n;
char s[maxn],t[maxn];
int f[maxn][13];
void work()
{
	n=read(),scanf("%s%s",s+1,t+1);
	memset(f[0],63,sizeof f[0]);
	f[0][0]=0;
	int B=4;
	For(i,1,n){
		memset(f[i],63,sizeof f[i]);
		int now=(s[i]=='B');
		int nd=(t[i]=='B');
		int c01=0,c10=0;
		For(j,0,B){
			if(now==nd){
				For(k,0,B){
					int x=k-c10;
					if(x>=0 && x<=c01){
						int t=(k-x)+(c01-x);
						if(t>=0 && t<=B)
							f[i][t]=min(f[i][t],f[i-1][k]+(c01-x));
					}
				}
			}
			if(now==0)++c01;
			else ++c10;
			now^=1;
		}
	}
	if(f[n][0]<inf)cout<<f[n][0]<<"\n";
	else puts("-1");
}
```

---


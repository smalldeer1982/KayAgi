# 擬二等辺三角形

## 题目描述

[problemUrl]: https://atcoder.jp/contests/tenka1-2015-qualb/tasks/tenka1_2015_qualB_c

ニシモリ君は下記の $ 3 $ つの条件を満たす三角形を“擬二等辺三角形”と呼ぶことにしました。

- すべての辺の長さが整数である
- すべての辺の長さが異なる
- いずれかの二辺の長さの差が $ 1 $ となる

三角形の周長が $ L $ 以下となる擬二等辺三角形の個数を求め、$ 1000000007 $ で割った余りを出力して下さい。

## 说明/提示

### 配点

この問題には部分点が設定されている。

- $ L\leq\ 10^6 $ を満たすテストケース全てに正解した場合は、$ 25 $ 点が与えられる。
- 全てのテストケースに正解した場合は、上記とは別に $ 75 $ 点が与えられる。

## 样例 #1

### 输入

```
10```

### 输出

```
1```

## 样例 #2

### 输入

```
1100011```

### 输出

```
251098945```

# 题解

## 作者：Day_Tao (赞：3)

原题题面有点问题啊，第三个条件应该是存在两边只差为 $1$，而不是任意两边只差为 $1$。不然得话答案都是 $0$ 了。

就是推柿子题啊。

首先我们只考虑对于周长为 $L$ 的情况。

我们记三边分别为 $t,t+1,L-2t-1$。根据三角形的性质 **两边之和大于第三边** 我们可以得出以下柿子：

$$\begin{cases}2t+1>L-2t-1\\L-t-1>t+1\\L-t>t\end{cases}$$

整理可得有关 $t$ 取值范围的不等柿：

$$\begin{cases}t>\frac{L-2}{4}\\t<\frac{L-2}{2}\\t<\frac{L}{2}\end{cases}$$

由于第三个柿子是第二个柿子的必要条件，所以说真正有用的信息只有：

$$\frac{L-2}{4}<t<\frac{L-2}{2}$$

这个 $<$ 看着就非常的丑，所以我们要通过一定的放缩换成 $\le$。

在换成 $\le$ 之后，对于左边的那部分除出来时整数的话就要 $+1$，否则要向上取整，不难发现结果就等价于 $\lfloor\frac{L+2}{4}\rfloor$。

对于右边的也差不多，除出来的是整数就要 $-1$，否则向下取整，这里的结果就等价于 $\frac{L-3}{2}$。

所以我们将以上柿子转化为了：

$$\lfloor\frac{L+2}{4}\rfloor\le t\le\lfloor\frac{L-3}{2}\rfloor$$

当然这是一个大致的范围，我们还要考虑一些细节。

首先是可能出现 $k,k+1,k+1$ 和 $k,k+1,k$ 不合法的情况。然后在 $L\bmod3=0$ 时会有 $k,k+1,k+2$ 和 $k+1,k+2,k$ 的情况，这两者本质相同但是都会被记进答案里。

我们发现这些情况分别满足 $L\bmod3=2,1,0$ 的情况，就相当于对于所有的 $L$ 在满足上面不等式的情况下都要减去 $1$ 的贡献。

但是真的吗？注意到之后 $L$ 比较大的时候才能这么做。在 $L=6$ 时 $1,2,3$ 的方案并不能构成三角形。容易证明其他情况这样做都是合法的。

所以我们现在就是要计算（$n$ 为原题的 $L$）：

$$-1+\sum_{L=5}^n(\lfloor\frac{L-3}{2}\rfloor-\lfloor\frac{L+2}{4}\rfloor+1)-1$$

当然我们需要特判一下 $n=5$ 的情况。

但是这样是 $\mathcal{O}(n)$ 的，我们需要更快。

考虑对于 $\sum$  中的每一项单独维护一下，发现 $\lfloor\frac{i}{k}\rfloor$ 这种形式的东西是有一定规律的（$i$ 是连续递增的变量，$k$ 是定值），具体的就是一个数循环 $k$ 次然后 $+1$ 继续循环 $k$ 次的类似等差数列的东西，首尾的数可能出现次数不足 $k$。

所以我们分别对于 $\sum\limits_{L=5}^n\lfloor\frac{L-3}{2}\rfloor$ 和 $\sum\limits_{L=5}^n\lfloor\frac{L+2}{4}\rfloor$ 分别维护即可。这部分比较简单，请读者自行推导，不在此展开。具体可见代码实现部分，不过代码将部分可以抵消掉的东西省略了。问题不是很大。

**code**：

```cpp
inline void SOLVE(){
    // n=rd();F(l,5,n){add(ans,(l-3)/2-(l+2)/4+1);if(l!=6)ans-=1;}printf("%lld\n",ans);
    n=rd();if(n==5)return puts("0"),void();
    a=(n-3)/2,b=(n+2)/4;a%=mod,b%=mod;
    ans+=(1+a)*a%mod;ans-=a*(n%2);
    ans-=(2+b)*(b-1)%mod*2;ans+=b*((4-(n+3)%4)%4);
    printf("%lld\n",(ans%mod+mod)%mod);
    return ;
}
```

---

## 作者：naught (赞：0)

# 擬二等辺三角形

## 题面翻译

定义一个三角形为“伪等腰三角形”需满足以下三个条件：

* 三边长度都为自然数。

* 三边长度各不相同。

* 有其中两条边的长度之差为 $1$。

现在给你一个数 $n$，求周长小于等于 $n$ 的“伪等腰三角形”个数，答案对 $1000000007$ 取模。

## Solution

不难发现周长最小的“伪等腰三角形”的三边长为 $(2, 3, 4)$，故若给出的 $n$ 需大于 $8$。

锚定 $b = a+1$，对 $n$ 进行奇偶性讨论（令三角形表示为 $(a, b, c)$）。

> $n$ 为偶数。

设 $res$ 为构成 $(2, 3, 3)$ 之后剩下的值（即 $n-8$），不难发现把余下的值 **对半** 任意放到 $(2, 3)$ 中即可，方案数即为（式子中的 $res$ 由前文已除以 $2$）:

$$

{res \times(res+1) \div 2}

$$

> $n$ 为奇数

设 $res$ 为构成 $(2, 3, 2)$ 之后剩下的值（即 $n-7$），与偶数类似，只是 $(2, 3)$ 中至少要放 $1$ 使得“三边长度各不相同”。


## 代码
```cpp
#include <bits/stdc++.h>
using namespace std;

typedef long long ll;
#define Mod 1000000007
#define getchar()(p1==p2&&(p2=(p1=buf)+fread(buf,1,1<<21,stdin),p1==p2)?EOF:*p1++)
char buf[1<<21], *p1 = buf, *p2 = buf;
inline ll lread(ll x=0, bool f=0, char c=getchar()) {for(;!isdigit(c);c=getchar()) f^=!(c^45);for(;isdigit(c);c=getchar()) x=(x<<1)+(x<<3)+(c^48);return f?-x:x;}

ll n;

ll hts(ll a, ll b)
{
    ll res = 1;
    while(b) 
    {
        if( b & 1 ) (res *= a) %= Mod;
        (a *= a) %= Mod, b >>= 1;
    }
    return res;
}

ll solve(ll n)
{
    if( n <= 8 ) return 0;
    if( (n & 1) == 0 ) {ll res = (n-8) / 2  % Mod; return res * ((res+1) % Mod) % Mod * hts(2, Mod-2) % Mod;}
    else {ll res = (n-7)/ 4 % Mod; return ( res * 2 % Mod * res % Mod + ((n-7)/2 & 1 ? res*2+1 : 0 ) % Mod) % Mod;}
}

int main()
{
    n = lread();
    printf("%lld\n", solve(n));
    return 0;
}
```

## Tips

* $10^{12}$ 的输入已经爆 `int` 了，需要开 `long long`。

* 记得特判 $n$ 小于等于 $8$ 的情况。

---


# かぶりん！

## 题目描述

“ぶん投げRPG『かぶりん！』”是一款靠投掷包裹的神秘生物かぶりん来击败敌人的动作角色扮演游戏。

国民ダイキ君对かぶりん游戏非常着迷，于是决定写一个程序来计算对敌人造成的伤害。

游戏规则如下：

- 游戏开始时，玩家手中有 $5$ 袋かぶりん。
- 玩家可以投掷手中的かぶりん，造成一定的伤害；投掷后，かぶりん会在一段时间后返回。
- 共有两种投掷方式：「普通投掷」和「蓄力投掷」，每次成功造成伤害后，连击数会增加。

### 普通投掷

- 投掷 $1$ 袋かぶりん。
- 至少需要 $1$ 袋かぶりん。
- 投掷时间 $0.5$ 秒。
- 投掷后 $1$ 秒造成伤害。
- 基础伤害为 $10$，与投掷时的连击数有关。
- 造成伤害后 $5$ 秒かぶりん返回手中。

### 蓄力投掷

- 投掷 $3$ 袋かぶりん。
- 至少需要 $3$ 袋かぶりん。
- 投掷时间 $2.5$ 秒，期间无法进行其他操作。
- 投掷后 $1$ 秒造成伤害。
- 基础伤害为 $50$，与投掷时的连击数有关。
- 造成伤害后 $5$ 秒かぶりん返回手中。

### 连击机制

- 游戏开始时连击数为 $0$。
- 每成功一次投掷攻击，连击数加 $1$。
- 每 $10$ 连击，造成的伤害增加基础伤害的 $10\%$。
- 伤害计算公式为：$A \times (1 + \text{floor}(C / 10) \times 0.1)$，其中 $A$ 是基础伤害，$C$ 是当前连击数。
- 伤害增幅从达成连击后的第一投生效。

### 用户输入

- 每秒钟，用户可以输入一次「普通投掷」、「蓄力投掷」或「无动作」。
- 如果投掷指令时手中没有足够的かぶりん，该指令被忽略。
- 在蓄力期间所有输入被忽略。

根据用户输入，计算对敌人造成的总伤害。注意，包括用户输入结束后，未返回的かぶりん的伤害。

## 说明/提示

### 样例解释 1

尝试进行 $8$ 次普通投掷，其中第 $6$ 和第 $7$ 秒因かぶりん不足未成功，到第 $8$ 秒才因第 $1$ 秒的投掷返还かぶりん，故成功投掷 $6$ 次，造成 $60$ 点伤害。

### 样例解释 2

在第 $1$ 秒开始蓄力投掷，第 $2$ 和第 $3$ 秒的输入因处于蓄力状态被忽略，第 $4$ 和第 $5$ 秒因かぶりん不足而被忽略。

### 样例解释 3

连击导致的伤害增益是在开始投掷前生效的。注意，当连击数达到 $10$ 时，之后的投掷立即享受伤害增益。

 **本翻译由 AI 自动生成**

## 样例 #1

### 输入

```
NNNNNNNN```

### 输出

```
60```

## 样例 #2

### 输入

```
CCCCC```

### 输出

```
50```

## 样例 #3

### 输入

```
NNC------NNC------NNC------NNC------NNC------NNC```

### 输出

```
439```

# 题解

## 作者：_NAFihC_ (赞：1)

一道冷门题，这里给出翻译。

给你一个字符串，其中第 $i$ 秒会进行操作 $s_i$，初始 $k = 0$。

- $s_i = $ `-`，表示不进行任何操作。

- $s_i = $ `N`，表示投掷一个普通球。该操作需要至少 $1$ 个球，$1.5$ 秒后造成 $10 \times (1 + \left\lfloor\dfrac{k}{10}\right\rfloor \times 0.1)$ 点伤害，并将 $k + 1$。$6.5$ 秒后 $1$ 个球会返回。

- $s_i = $ `C`，表示投掷一个大球，该操作需要至少 $3$ 个球，投掷后 $2.5$ 秒不能进行任何操作。$3.5$ 秒后造成 $50 \times (1 + \left\lfloor\dfrac{k}{10}\right\rfloor \times 0.1)$ 点伤害，并将 $k + 1$。$8.5$ 秒后 $3$ 个球会返回。

**只要投出去了球就一定会造成伤害，即使操作停止**

如果投掷时球不够或前 $2.5$ 秒投过一次大球，则无视这次投掷操作。

现在你想知道你投出的造成的总伤害是多少。

看起来这题操作很多，实际上直接根据题意模拟即可。定义三个数组 $a,b,d$ 分别表示 $i$ 时刻能返回的球数，$i$ 时刻能获得 $k$ 的加值，$i$ 时刻是否能进行操作（操作是否合法）。注意用数组存是为了考虑加值有延迟的情况，而且能随时访问下标。记得 $a$ 数组和 $b$ 数组下标要向上取整，因为向下取整球的数量和 $k$ 还没有发生变化。注意答案可能会爆 $\operatorname{int}$，行末记得输出换行。你也可以参考注释。

```cpp
#include <iostream>
#define int long long//不开long long见祖宗
using namespace std;
string s;
int qiu = 5,a[1000022],b[1000022],d[1000022],ans,k;
//a数组：计算球数 b数组：计算k d数组：计算是否操作合法
signed main()
{
    cin >> s;
    for(int i = 0;i < s.size();++ i)
    {
        qiu += a[i];
        k += b[i];//更新球数和k
        if(d[i])continue ;//不能进行操作
        if(s[i] == 'N' && qiu >= 1)
        {
            qiu --;
            ans += (10.0 * (1 + (k / 10) * 0.1));//计算伤害，下面同理
            b[i + 2] ++,a[i + 7] ++;//6秒后球不能返回，所以向上取整至7秒，下面同理
        }
        else if(s[i] == 'C' && qiu >= 3)
        {
            qiu -= 3;
            ans += (50.0 * (1 + (k / 10) * 0.1));
            b[i + 4] ++,a[i + 9] += 3;
            d[i + 1] = d[i + 2] = 1;//2.5秒相当于一秒后和两秒后不能进行操作
        }
    }
    cout << ans << '\n';//末尾输出换行
}
```

[AC 记录](https://atcoder.jp/contests/tenka1-2014-quala/submissions/58896114)

---


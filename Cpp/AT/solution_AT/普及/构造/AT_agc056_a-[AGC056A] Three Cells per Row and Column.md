# [AGC056A] Three Cells per Row and Column

## 题目描述

[problemUrl]: https://atcoder.jp/contests/agc056/tasks/agc056_a

$ N $ 行 $ N $ 列からなる盤面があります．

以下の条件をすべて満たすように，すべてのマスを白か黒で塗ってください．

- 各行について，その行のマスのうちちょうど $ 3 $ 個が黒く塗られている．
- 各列について，その列のマスのうちちょうど $ 3 $ 個が黒く塗られている．
- 黒いマスからなる連結成分の個数がちょうど $ N $ 個である． ここで，ある $ 2 $ つの黒いマス $ x,y $ が連結であるとは，$ x $ からスタートし，上下左右の黒いマスに移動することを繰り返し，$ y $ に到達できることを意味する．

なお，問題の制約より，必ず解が存在することが証明できます．

## 说明/提示

### 制約

- $ 6\ \leq\ N\ \leq\ 500 $
- 入力される値はすべて整数である

### Sample Explanation 1

各行，各列にある `#` の個数はちょうど $ 3 $ です． また，`#` からなる連結成分の個数はちょうど $ 6 $ です．

## 样例 #1

### 输入

```
6```

### 输出

```
##..#.
##..#.
..##.#
..##.#
##...#
..###.```

# 题解

## 作者：有趣的问题 (赞：2)


考试的时候做到这道题，很多小朋友好像都是坐板凳搜出来的捏~

老用户花了好久终于手玩出了一个构造方案，感觉还算比较简洁，分享给大家。

#### 对于 $n\equiv 0 \pmod{3}$ 的情况

不难发现，我们有一种比较简单的构造方案，即每行循环移位 $3$ 格：

```
###......
...###...
......###
###......
...###...
......###
###......
...###...
......###
```

这样就比较简单地解决了这种情况，相信大家都能想到。

#### 对于 $n\equiv 1 \pmod{3}$ 的情况

我们试图基于上面的情况做一些调整。首先还是每行移位 $3$ 格：

```
###....
...###.
##....#
..###..
#....##
.###...
....###
```

这时我们发现连通块个数不对呀？怎么办呢？

注意到，我们可以把这个图看做 $3$ 组：每一组刚好占满一整行。则上图中第一组的最后一行和第二组的第一行重叠了，多产生了一个连通块。这时我们想通过调整消去第一组的一个连通块，即上图中第三行的最后一个 `#`。

我们需要用到一个调整的操作：如果 $(x_1,y_1),(x_2,y_2)$ 都染了色，我们可以调整为给 $(x_1,y_2),(x_2,y_1)$ 染色。这个操作的对行列个数显然是没有影响的。我们可以拿他来改变连通块个数。

回到上面，我们考虑把第三行的最后一个 `#` 和第四行的最后一个 `#` 拿来调整，会发现连通块的个数刚好减少了！给下面最对称操作后得到的图是这样的：

```
###....
...###.
##..#..
#..#..#
..#..##
.###...
....###
```

**归纳一下**：在循环移位后，我们给 $(n/3+1,n),(n/3\times2,n-2)$ 这两个位置和他们的对称位置分别做调整，就可以构造出解。

#### 对于 $n\equiv 2 \pmod{3}$ 的情况

有了上面的经验，这一步就简单多了。大家可以自己手玩一下，这里给出**归纳结论**：在循环移位后，我们给 $(n/3+1,1),(n/3\times 2+1,n-3)$ 这两个位置和他们的对称位置分别做调整，就可以构造出解。

这样，我们就解决了这道题！是不是很简洁呢？当然还有其他的构造/坐板凳方法，大家可以私信 @[赵悦岑](https://www.luogu.com.cn/user/291248) 了解。

最后放一个 $n=7,8,10,11$ 的构造图希望能帮助到大家：

![](https://cdn.luogu.com.cn/upload/image_hosting/9jhvrgsc.png)

---

## 作者：nkrqzjc_zzz (赞：0)

### [题目链接](https://www.luogu.com.cn/problem/AT_agc056_a)

### 思路

这是一个不是很好想的构造题，首先考虑 $n$ 是 $3$ 的整数倍的情况。

直接按照如下方式即可：

![](https://cdn.luogu.com.cn/upload/image_hosting/kuk64mrw.png)

当其不是 $3$ 的倍数的时候，我们仍然模仿之前的方式，会得到如下的情况，但是这里存在连通块个数变多为 $n+2$ 个的情况。

![](https://cdn.luogu.com.cn/upload/image_hosting/nylkbg7t.png)

考虑如何解决这个问题呢，可以通过交换一些行的方式使得连成黑色的连成一个。

我们通过枚举发现直接交换第一行和第 $\lfloor\frac{n}{3}\rfloor$ 行就可以减少一个联通块，交换第 $n-\lfloor\frac{n}{3}\rfloor+1$ 行和最后一行又可以减少一个联通块。

最后，这样就完成了本题的构造了。

### 代码

实现细节和上述方法如何转换成代码，都在下面了。

```cpp
#include<bits/stdc++.h>
using namespace std;
vector<string>a;//vector存答案 
string b;
int c;
main(){
	scanf("%d",&c);
	for(int i=0;i<c;i++){
		b=string(c,'.');
		for(int j=0;j<3;j++)b[(i*3+j)%c]='#';
		a.push_back(b);
	}
	//上面的代码是先构造出一个最基础（也就是n%3==0）的情况 
	if(c%3)swap(a[c-c/3],a[c-1]),swap(a[0],a[c/3-1]);//这里是当n%3!=0时交换行 
	for(string b:a)cout<<b<<"\n";
}
```

---

## 作者：LJ07 (赞：0)

$n$ 是 $3$ 的倍数时可以有以下构造方式：

```cpp
memset(a, '.', sizeof a);
for (int i = 0; i < n; ++i) {
	ps[(3 * i + 2) % n] = i;
	for (int j = 0; j < 3; ++j) {
		a[i][(3 * i + j) % n] = '#';
	}
}
```

$n$ 不是 $3$ 的倍数时联通块的数量会出问题，形如 ```#...##``` 和 ```##...#``` 的块会总共会多出两个联通块（因为互质）。

打补丁是容易的，可以简单的通过移动整行使得三个联通块合成一个，以 $n=7$ 为例：

```
###....
...###.
##....#
..###..
#....## 
.###...
....###
```

可以通过移动变成这个

```
###....
...###.
....###
##....#
..###..
#....## 
.###...
```

```cpp
void print(int x, int y)
{
	for (int i = x; i <= y; ++i) {
		for (int j = 0; j < n; ++j) {
			putchar(a[i][j]);
		}
		putchar('\n');
	}
}

int main()
{
	rd(n);
	memset(a, '.', sizeof a);
	for (int i = 0; i < n; ++i) {
		ps[(3 * i + 2) % n] = i;
		for (int j = 0; j < 3; ++j) {
			a[i][(3 * i + j) % n] = '#';
		}
	}
	if (n % 3 == 0) {
		print(0, n - 1);
	}else {
		print(0, ps[1] - 1);
		print(n - 1, n - 1);
		print(ps[1], n - 2);
	}
	return 0;
} 
```

---

## 作者：5ab_juruo (赞：0)

给定 $N$，要求在 $N\times N$ 的方格中涂色，要求：

- 每行每列都有**恰好三个**格子被涂色；
- 共有 $N$ 个四连通的涂色连通块。

给出方案。$6\le N\le 500$。

---

先考虑 $N\equiv 0\pmod{3}$ 的情况，可以给出如下构造：

```plaintext
###.........
...###......
......###...
.........###
###.........
...###......
......###...
.........###
###.........
...###......
......###...
.........###
```

即将网格分成若干个 $3$ 列 $ \frac{N}{3}$ 行的区块，对于一行中第 $i$ 个区块在第 $i\bmod \frac{N}{3}$ 行（都是 $0$ 标号）染色。显然这是满足条件的。

对于剩下的两种情况，在原本的情况中微操即可。方案不唯一，下面给出我的构造：

- $N\equiv 1\pmod 3$

在原图的右下角进行如下修改：

```plaintext
#...    #....    ....#
.### -> .###. -> ..###
        .....    ##..#
```

- $N\equiv 2\pmod 3$

在 $N\equiv 1\pmod 3$ 的基础上，在左上角做类似的改动，把方向旋转 $180\degree$ 即可。

下面给出 $N=6,7,8$ 的构造，方便理解：

$N=6$：

```plaintext
###...
...###
###...
...###
###...
...###
```

$N=7$：

```plaintext
###....
...###.
###....
...###.
##....#
....###
..##..#
```

$N=8$：

```plaintext
#..##...
###.....
#....##.
.###....
....###.
.##....#
.....###
...##..#
```

代码写的太抽象了，就不放了。

---


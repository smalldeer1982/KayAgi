# 题目信息

# [ABC023C] 収集王

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc023/tasks/abc023_c

高橋君はある部屋に移動する予定です。

部屋は正方形のマスが縦に $ R $ 行、横に $ C $ 列並んだ形状をしています。このうち $ i\ (1\ ≦\ i\ ≦\ R) $ 行目の $ j\ (1\ ≦\ j\ ≦\ C) $ 列目にあるマスをマス $ (i,j) $ と呼ぶことにします。

これらのマスには飴が合計 $ N $ 個存在します。飴には $ 1 $ から $ N $ までの番号が付けられており、飴 $ i\ (1\ ≦\ i\ ≦\ N) $ はマス $ (r_i,c_i) $ に置いてあります。これらのうちどの $ 2 $ つの飴も同一のマス上にありません。

高橋君はマスのうち任意の $ 1 $ マスに移動します。移動した後、高橋君は次に示すように飴を獲得します。

- 最初に、高橋君がいるマスと同じ行にあるすべてのマスについて、そのマスにある飴をすべて獲得する。
- 次に、高橋君がいるマスと同じ列にあるすべてのマスについて、そのマスにあるすべての飴を獲得する。

高橋君はこの行動以外には何も行動しません。

高橋君は獲得する飴の個数がちょうど $ K $ 個になるようにしたいです。このような移動先として考えられるマスの総数を求めてください。

## 说明/提示

### 部分点

この問題には部分点が設定されている。

- $ R\ ≦\ 50 $ かつ $ C\ ≦\ 50 $ かつ $ N\ ≦\ 50 $ を満たすデータセット $ 1 $ に正解した場合は、$ 30 $ 点が与えられる。
- 追加制約のないデータセット $ 2 $ に正解した場合は、上記とは別に $ 70 $ 点が与えられる。

### Sample Explanation 1

例えば、マス $ (3,2) $ に高橋君が移動した場合を考えます。 - 飴 $ 1 $ は、マス $ (1,2) $ にあります。このマスはマス $ (3,2) $ と同じ列にあるので、高橋君は飴 $ 1 $ を獲得します。 - 飴 $ 2 $ は、マス $ (2,1) $ にあります。このマスはマス $ (3,2) $ と同じ行にも同じ列にもないので、高橋君は飴 $ 2 $ を獲得しません。 - 飴 $ 3 $ は、マス $ (2,5) $ にあります。このマスはマス $ (3,2) $ と同じ行にも同じ列にもないので、高橋君は飴 $ 3 $ を獲得しません。 - 飴 $ 4 $ は、マス $ (3,2) $ にあります。このマスはマス $ (3,2) $ と同じマス (同じ行かつ同じ列) にあるので、高橋君は飴 $ 4 $ を獲得します。 - 飴 $ 5 $ は、マス $ (3,5) $ にあります。このマスはマス $ (3,2) $ と同じ行にあるので、高橋君は飴 $ 5 $ を獲得します。 以上より、飴 $ 1 $, $ 4 $, $ 5 $ のちょうど $ 3 $ 個だけ飴を獲得するので、マス $ (3,2) $ は獲得する飴の個数がちょうど $ K $ 個になるような移動先です。 他にもマス $ (1,5) $, $ (2,5) $, $ (3,1) $, $ (3,5) $ が条件をみたすので答えとして $ 5 $ を出力します。

### Sample Explanation 2

どのように移動先を指定しても、獲得する飴の個数をちょうど $ 1 $ 個にすることはできません。

## 样例 #1

### 输入

```
3 5 3

5

1 2

2 1

2 5

3 2

3 5```

### 输出

```
5```

## 样例 #2

### 输入

```
7 3 1

4

3 2

3 3

4 2

4 3```

### 输出

```
0```

## 样例 #3

### 输入

```
5 5 2

5

1 1

2 2

3 3

4 4

5 5```

### 输出

```
20```

# AI分析结果

### 题目内容重写

高桥君计划移动到某个房间。房间是由正方形格子组成的，共有 $R$ 行和 $C$ 列。第 $i$ 行第 $j$ 列的格子称为格子 $(i,j)$。房间中有 $N$ 颗糖果，每颗糖果位于某个格子上，且每颗糖果的位置唯一。高桥君可以选择任意一个格子移动，移动后他会获得以下糖果：

1. 与他所在格子同一行的所有格子上的糖果。
2. 与他所在格子同一列的所有格子上的糖果。

高桥君希望获得的糖果数量恰好为 $K$ 个。求满足条件的移动格子总数。

### 算法分类
枚举

### 题解分析与结论

#### 题解1：Jur_Cai (4星)
- **关键亮点**：使用桶统计每行每列的糖果数，并通过集合快速查找符合条件的列，处理行列交点处的重复计数问题。
- **代码实现**：
  - 使用 `sumr` 和 `sumc` 数组分别统计每行和每列的糖果数。
  - 使用 `have` 集合存储每列糖果数的桶，便于快速查找。
  - 遍历每行，计算符合条件的列数，并处理交点处的重复计数。
- **核心代码**：
  ```c++
  for(int x=1;x<=r;x++) {
      if(k-sumr[x]<0) continue;
      ans+=have[k-sumr[x]].size();
      for(int i=0;i<g[x].size();i++) {
          if(have[k-sumr[x]].count(g[x][i])) ans--;
          if(have[k-sumr[x]+1].count(g[x][i])) ans++;
      }
  }
  ```

### 最优关键思路
1. **桶统计与集合查找**：通过桶统计每行每列的糖果数，并使用集合快速查找符合条件的列，优化了查找效率。
2. **处理重复计数**：在计算符合条件的列数时，特别处理了行列交点处的重复计数问题，确保结果的准确性。

### 可拓展之处
- **类似问题**：在处理二维平面上的计数问题时，桶统计与集合查找的方法可以广泛应用，尤其是在需要快速查找符合条件的元素时。
- **优化思路**：对于更大规模的数据，可以考虑使用更高效的数据结构（如哈希表）来进一步优化查找速度。

### 推荐题目
1. [P3374 【模板】树状数组 1](https://www.luogu.com.cn/problem/P3374)
2. [P3368 【模板】树状数组 2](https://www.luogu.com.cn/problem/P3368)
3. [P1908 逆序对](https://www.luogu.com.cn/problem/P1908)

### 个人心得
- **调试经历**：在处理行列交点处的重复计数问题时，需要特别注意边界条件和特殊情况，确保代码的鲁棒性。
- **顿悟感想**：通过桶统计和集合查找的方法，可以大大简化复杂问题的处理流程，提高代码的可读性和效率。

---
处理用时：21.53秒
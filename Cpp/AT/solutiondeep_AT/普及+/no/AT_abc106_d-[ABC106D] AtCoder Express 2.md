# 题目信息

# [ABC106D] AtCoder Express 2

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc106/tasks/abc106_d

高橋王国には, 東西にのびる $ 1 $ 本の線路がある. これに沿って $ N $ 個の都市があり, 西から順に都市 $ 1,\ 2,\ 3,\ \cdots,\ N $ と番号づけられている.  
 AtCoder Express という会社は $ M $ 本の列車を保有しており, 列車 $ i $ は都市 $ L_i $ から都市 $ R_i $ の区間 ($ L_i\ =\ R_i $ の場合もある) を走っている.

この王国の国王である高橋君は, $ Q $ 個のことに興味を持った. 具体的には, $ i=1,\ 2,\ 3,\ \dots,\ Q $ のときの以下の質問の答えを求めたくなった.

- 都市 $ p_i $ から都市 $ q_i $ までの区間に, 走る区間が **完全に含まれる** 列車の本数. 言い換えれば, $ p_i\ \leq\ L_j $ と $ R_j\ \leq\ q_i $ が両方成り立つような列車 $ j $ の本数.

高橋君は天才である. しかし流石の彼でも, 膨大なデータを処理することはできない. 高橋君のために, $ Q $ 個の質問それぞれに対して答えを求めよ.

## 说明/提示

### 制約

- $ N $ は $ 1 $ 以上 $ 500 $ 以下の整数
- $ M $ は $ 1 $ 以上 $ 200\ 000 $ 以下の整数
- $ Q $ は $ 1 $ 以上 $ 100\ 000 $ 以下の整数
- $ 1\ \leq\ L_i\ \leq\ R_i\ \leq\ N $ $ (1\ \leq\ i\ \leq\ M) $
- $ 1\ \leq\ p_i\ \leq\ q_i\ \leq\ N $ $ (1\ \leq\ i\ \leq\ Q) $

### Sample Explanation 1

全ての列車の走る区間が, 都市 $ 1 $ から都市 $ 2 $ までの区間に含まれているので, この質問の答えは $ 3 $ となる.

### Sample Explanation 2

$ 1 $ 個目の質問は, 都市 $ 1 $ から $ 7 $ までの区間についてである. その区間に走る区間が完全に含まれている列車は, 列車 $ 1 $ のみである. $ 2 $ 個目の質問は, 都市 $ 3 $ から $ 10 $ までの区間についてである. その区間に走る区間が完全に含まれている列車は, 列車 $ 3 $ のみである.

## 样例 #1

### 输入

```
2 3 1

1 1

1 2

2 2

1 2```

### 输出

```
3```

## 样例 #2

### 输入

```
10 3 2

1 5

2 8

7 10

1 7

3 10```

### 输出

```
1

1```

## 样例 #3

### 输入

```
10 10 10

1 6

2 9

4 5

4 7

4 7

5 8

6 6

6 7

7 9

10 10

1 8

1 9

1 10

2 8

2 9

2 10

3 8

3 9

3 10

1 10```

### 输出

```
7

9

10

6

8

9

6

7

8

10```

# AI分析结果

### 题目内容重写

高桥王国有一条东西走向的铁路，沿线有 $N$ 个城市，编号从西到东依次为 $1, 2, 3, \cdots, N$。AtCoder Express 公司拥有 $M$ 列火车，每列火车 $i$ 从城市 $L_i$ 运行到城市 $R_i$（$L_i = R_i$ 的情况也存在）。

高桥国王对 $Q$ 个问题感兴趣，每个问题的形式是：给定城市 $p_i$ 和 $q_i$，求有多少列火车的运行区间完全包含在 $[p_i, q_i]$ 内，即满足 $p_i \leq L_j$ 且 $R_j \leq q_i$ 的火车 $j$ 的数量。

### 算法分类
动态规划、前缀和

### 题解分析与结论
本题的核心是统计满足条件的区间数量，且由于 $N$ 的范围较小（$N \leq 500$），可以使用动态规划或前缀和来高效处理。大多数题解采用了二维动态规划的思路，通过状态转移方程计算每个区间的列车数量。

### 精选题解

#### 题解1：作者：qwerty12346 (赞：9)
- **星级**：5星
- **关键亮点**：使用二维动态规划，状态转移方程清晰，代码简洁。
- **核心思想**：定义 $dp_{i,j}$ 表示从城市 $i$ 到城市 $j$ 的列车数量，通过状态转移方程 $dp_{i,j} += dp_{i+1,j} + dp_{i,j-1} - dp_{i+1,j-1}$ 来计算。
- **代码片段**：
  ```cpp
  for(int i=n;i>=1;i--)
      for(int j=1;j<=n;j++)
          f[i][j]+=f[i+1][j]+f[i][j-1]-f[i+1][j-1];
  ```

#### 题解2：作者：Walter_Fang (赞：7)
- **星级**：4星
- **关键亮点**：同样使用二维动态规划，状态转移方程解释详细。
- **核心思想**：定义 $dp_{i,j}$ 表示从城市 $i$ 到城市 $j$ 的列车数量，状态转移方程为 $dp_{i,j} = dp_{i+1,j} + dp_{i,j-1} + a_{i,j} - dp_{i+1,j-1}$。
- **代码片段**：
  ```cpp
  for(int i=n;i>=1;i--)
      for(int j=i;j<=n;j++)
          dp[i][j]=dp[i+1][j]+dp[i][j-1]+a[i][j]-dp[i+1][j-1];
  ```

#### 题解3：作者：Orange_qwq (赞：1)
- **星级**：4星
- **关键亮点**：使用二维差分前缀和，思路新颖。
- **核心思想**：将每条线段缩成点，使用二维差分前缀和来快速计算区间内的列车数量。
- **代码片段**：
  ```cpp
  for(int i=1;i<=n;i++)
      for(int j=1;j<=n;j++)
          sum[i][j]+=sum[i-1][j]+sum[i][j-1]-sum[i-1][j-1];
  ```

### 最优关键思路
使用二维动态规划或前缀和来处理区间统计问题，状态转移方程清晰且高效。对于类似的问题，可以考虑使用二维数组来存储区间信息，并通过状态转移方程进行计算。

### 拓展思路
类似的问题可以扩展到更高维度的区间统计，或者结合其他数据结构如树状数组来优化查询效率。

### 推荐题目
1. [P1880 [NOI1995] 石子合并](https://www.luogu.com.cn/problem/P1880)
2. [P1048 [NOIP2005 普及组] 采药](https://www.luogu.com.cn/problem/P1048)
3. [P1060 [NOIP2006 提高组] 开心的金明](https://www.luogu.com.cn/problem/P1060)

---
处理用时：31.87秒
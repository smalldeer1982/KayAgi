# 题目信息

# [ABC119D] Lazy Faith

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc119/tasks/abc119_d

東西方向に伸びる道路に沿って $ A $ 社の神社と $ B $ 軒の寺が建っています。 西から $ i $ 社目の神社は道路の西端から $ s_i $ メートルの地点に、西から $ i $ 軒目の寺は道路の西端から $ t_i $ メートルの地点にあります。

以下の $ Q $ 個の問いに答えてください。

問 $ i $ ($ 1\ \leq\ i\ \leq\ Q $): 道路の西端から $ x_i $ メートルの地点から出発して道路上を自由に移動するとき、神社一社と寺一軒を訪れるのに必要な最小の移動距離は何メートルか？ (必要数を超えた数の寺社を通過してもよい。)

## 说明/提示

### 制約

- $ 1\ \leq\ A,\ B\ \leq\ 10^5 $
- $ 1\ \leq\ Q\ \leq\ 10^5 $
- $ 1\ \leq\ s_1\ <\ s_2\ <\ ...\ <\ s_A\ \leq\ 10^{10} $
- $ 1\ \leq\ t_1\ <\ t_2\ <\ ...\ <\ t_B\ \leq\ 10^{10} $
- $ 1\ \leq\ x_i\ \leq\ 10^{10} $
- $ s_1,\ ...,\ s_A,\ t_1,\ ...,\ t_B,\ x_1,\ ...,\ x_Q $ はすべて異なる。
- 入力される値はすべて整数である。

### Sample Explanation 1

$ 2 $ 社の神社と $ 3 $ 軒の寺があり、神社は道路の西端から $ 100,\ 600 $ メートルの地点に、寺は道路の西端から $ 400,\ 900,\ 1000 $ メートルの地点にあります。 - 問 $ 1 $: 道路の西端から $ 150 $ メートルの地点から出発する場合、まず西に $ 50 $ メートル進んで神社を訪れ、次に東に $ 300 $ メートル進んで寺を訪れるのが最適です。 - 問 $ 2 $: 道路の西端から $ 2000 $ メートルの地点から出発する場合、まず西に $ 1000 $ メートル進んで寺を訪れ、次に西に $ 400 $ メートル進んで神社を訪れるのが最適です。途中で寺をもう一軒通過しますが、構いません。 - 問 $ 3 $: 道路の西端から $ 899 $ メートルの地点から出発する場合、まず東に $ 1 $ メートル進んで寺を訪れ、次に西に $ 300 $ メートル進んで神社を訪れるのが最適です。 - 問 $ 4 $: 道路の西端から $ 799 $ メートルの地点から出発する場合、まず西に $ 199 $ メートル進んで神社を訪れ、次に西に $ 200 $ メートル進んで寺を訪れるのが最適です。

### Sample Explanation 2

道路は長く、$ 32 $ ビット整数に収まらない距離を移動する必要があるかもしれません。

## 样例 #1

### 输入

```
2 3 4

100

600

400

900

1000

150

2000

899

799```

### 输出

```
350

1400

301

399```

## 样例 #2

### 输入

```
1 1 3

1

10000000000

2

9999999999

5000000000```

### 输出

```
10000000000

10000000000

14999999998```

# AI分析结果

### 题目内容重写

东西方向延伸的道路上建有 $A$ 座神社和 $B$ 座寺庙。从西端开始，第 $i$ 座神社位于距离西端 $s_i$ 米的位置，第 $i$ 座寺庙位于距离西端 $t_i$ 米的位置。

你需要回答 $Q$ 个问题：

问题 $i$ ($1 \leq i \leq Q$)：从距离西端 $x_i$ 米的位置出发，自由移动，访问至少一座神社和一座寺庙所需的最小移动距离是多少？（可以经过超过所需数量的神社和寺庙。）

### 算法分类
二分

### 题解分析与结论

这道题的核心在于如何高效地找到离起点最近的神社和寺庙，并计算最小移动距离。所有题解都使用了二分查找来优化查找过程，时间复杂度为 $O(Q \log (A+B))$，能够处理 $10^5$ 级别的数据。

### 精选题解

#### 题解1：作者：c60521c (赞：15)
**星级：5星**
**关键亮点：**
- 使用 `lower_bound` 进行二分查找，简洁高效。
- 详细讨论了四种情况（左神社左寺庙、右神社右寺庙、左神社右寺庙、右神社左寺庙），并分别计算最小距离。
- 代码结构清晰，注释详细，易于理解。

**核心代码：**
```cpp
x = lower_bound(a, a+n, k) - a;
y = lower_bound(b, b+m, k) - b;
ans = 1e16;

if(x < n && y < m) // 神社和寺庙都在右
    ans = min(ans, max(a[x], b[y]) - k);
if(x > 0 && y > 0) // 神社和寺庙都在左
    ans = min(ans, k - min(a[x-1], b[y-1]));
if(x > 0 && y < m) // 神社左寺庙右
    ans = min(ans, b[y] - a[x-1] + min(k - a[x-1], b[y] - k));
if(y > 0 && x < n) // 寺庙左神社右
    ans = min(ans, a[x] - b[y-1] + min(k - b[y-1], a[x] - k));
```

#### 题解2：作者：AgrumeStly (赞：5)
**星级：4星**
**关键亮点：**
- 同样使用 `lower_bound` 进行二分查找，思路清晰。
- 详细解释了四种情况的移动距离计算方式，并给出了具体的数学表达式。
- 代码结构良好，注释详细。

**核心代码：**
```cpp
int ss = lower_bound(s + 1, s + a + 1, x) - s;
int sm = lower_bound(t + 1, t + b + 1, x) - t;
ans = 9e18;

if(ss > 1 && sm > 1) // 左神社左寺庙
    ans = min(ans, max(x - s[ss-1], x - t[sm-1]));
if(ss <= a && sm <= b) // 右神社右寺庙
    ans = min(ans, max(s[ss] - x, t[sm] - x));
if(ss > 1 && sm <= b) // 左神社右寺庙
    ans = min(ans, (x - s[ss-1]) * 2 + (t[sm] - x));
if(ss <= a && sm > 1) // 右神社左寺庙
    ans = min(ans, (t[sm] - x) * 2 + (x - s[ss-1]));
```

#### 题解3：作者：qss_ (赞：4)
**星级：4星**
**关键亮点：**
- 使用 `lower_bound` 进行二分查找，思路清晰。
- 详细讨论了四种情况，并给出了具体的数学表达式。
- 代码结构良好，注释详细。

**核心代码：**
```cpp
LL sa = lower_bound(a+1, a+A+1, q) - a;
LL sb = lower_bound(b+1, b+B+1, q) - b;
LL ans = 9223372036854775807;

if(sa <= A && sb <= B) // 左神社左寺庙
    ans = min(ans, max(a[sa] - q, b[sb] - q));
if(sa > 1 && sb > 1) // 右神社右寺庙
    ans = min(ans, max(q - a[sa-1], q - b[sb-1]));
if(sa <= A && sb > 1) // 左神社右寺庙
    ans = min(ans, a[sa] - b[sb-1] + min(a[sa] - q, q - b[sb-1]));
if(sa > 1 && sb <= B) // 右神社左寺庙
    ans = min(ans, b[sb] - a[sa-1] + min(q - a[sa-1], b[sb] - q));
```

### 最优关键思路
- 使用 `lower_bound` 进行二分查找，快速定位离起点最近的神社和寺庙。
- 分类讨论四种情况（左神社左寺庙、右神社右寺庙、左神社右寺庙、右神社左寺庙），分别计算最小移动距离。
- 通过取最小值的方式，确保找到最优解。

### 可拓展之处
- 类似的问题可以扩展到多维空间，或者增加更多的限制条件（如只能经过某些特定的路径）。
- 可以结合其他算法（如动态规划）来优化更复杂的情况。

### 推荐题目
1. [P3382 【模板】三分法](https://www.luogu.com.cn/problem/P3382)
2. [P2249 【深基13.例1】查找](https://www.luogu.com.cn/problem/P2249)
3. [P3372 【模板】线段树 1](https://www.luogu.com.cn/problem/P3372)

---
处理用时：40.47秒
# 题目信息

# [ABC152E] Flatten

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc152/tasks/abc152_e

$ N $ 個の正整数 $ A_1,...,A_N $ が与えられます。

次の条件を満たすような正整数 $ B_1,...,B_N $ を考えます。

条件：$ 1\ \leq\ i\ <\ j\ \leq\ N $ を満たすどのような $ i,j $ についても $ A_i\ B_i\ =\ A_j\ B_j $ が成り立つ。

このような $ B_1,...,B_N $ における $ B_1\ +\ ...\ +\ B_N $ の最小値を求めてください。

ただし、答えは非常に大きくなる可能性があるため、$ (10^9\ +7) $ で割ったあまりを出力してください。

## 说明/提示

### 制約

- $ 1\ \leq\ N\ \leq\ 10^4 $
- $ 1\ \leq\ A_i\ \leq\ 10^6 $
- 入力中のすべての値は整数である。

### Sample Explanation 1

$ B_1=6 $, $ B_2=4 $, $ B_3=3 $ とすると条件を満たします。

### Sample Explanation 2

全ての $ B_i $ を $ 1 $ とすればよいです。

### Sample Explanation 3

和を $ (10^9+7) $ で割った余りを出力してください。

## 样例 #1

### 输入

```
3

2 3 4```

### 输出

```
13```

## 样例 #2

### 输入

```
5

12 12 12 12 12```

### 输出

```
5```

## 样例 #3

### 输入

```
3

1000000 999999 999998```

### 输出

```
996989508```

# AI分析结果

### 题目内容重写
# [ABC152E] Flatten

## 题目描述

给定 $ N $ 个正整数 $ A_1,...,A_N $，要求构造一组正整数 $ B_1,...,B_N $，使得对于任意 $ 1 \leq i < j \leq N $，都有 $ A_i B_i = A_j B_j $。求满足条件的 $ B_1 + ... + B_N $ 的最小值，并将结果对 $ 10^9 + 7 $ 取模。

## 说明/提示

### 制約

- $ 1 \leq N \leq 10^4 $
- $ 1 \leq A_i \leq 10^6 $
- 输入中的所有值均为整数。

### 样例解释

#### 样例 #1

输入：
```
3
2 3 4
```
输出：
```
13
```
解释：$ B_1=6 $, $ B_2=4 $, $ B_3=3 $ 满足条件。

#### 样例 #2

输入：
```
5
12 12 12 12 12
```
输出：
```
5
```
解释：所有 $ B_i $ 取 $ 1 $ 即可。

#### 样例 #3

输入：
```
3
1000000 999999 999998
```
输出：
```
996989508
```
解释：和需要对 $ 10^9 + 7 $ 取模。

### 算法分类
数学

### 题解分析与结论
本题的核心是求所有 $ A_i $ 的最小公倍数（LCM），然后计算 $ \sum_{i=1}^N \frac{LCM}{A_i} $。由于 $ LCM $ 可能非常大，直接计算会导致溢出，因此需要通过质因数分解来优化计算，并使用逆元来处理除法取模的问题。

### 精选题解
1. **作者：Adchory (赞：2)**
   - **星级：4**
   - **关键亮点**：通过质因数分解求 $ LCM $，并使用逆元处理除法取模，代码结构清晰，优化得当。
   - **核心代码**：
     ```cpp
     inline ll ksm(ll a,ll b,ll mod){
         ll z=1;
         while(b){
             if(b&1) z=z*a%mod;
             a=a*a%mod;
             b>>=1;
         }
         return z;
     }
     inline ll inv(ll a,ll mod){
         return ksm(a,mod-2,mod);
     }
     ```
   - **实现思想**：通过欧拉筛法预处理质数，然后对每个 $ A_i $ 进行质因数分解，记录每个质因数的最大次数，最终通过快速幂计算 $ LCM $，并使用逆元计算 $ \frac{LCM}{A_i} $。

2. **作者：JWRuixi (赞：1)**
   - **星级：4**
   - **关键亮点**：对质因数分解进行了优化，特别是对大质数的处理，代码逻辑清晰，优化思路明确。
   - **核心代码**：
     ```cpp
     int ksm (int b, int k) {
         int res = 1;
         for (; k; k >>= 1, b = (LL)b * b % mod) if (k & 1) res = (LL)res * b % mod;
         return res;
     }
     ```
   - **实现思想**：通过预处理质数，对每个 $ A_i $ 进行质因数分解，记录每个质因数的最大次数，最终通过快速幂计算 $ LCM $，并使用逆元计算 $ \frac{LCM}{A_i} $。

3. **作者：Jairon314 (赞：1)**
   - **星级：4**
   - **关键亮点**：通过质因数分解求 $ LCM $，并使用逆元处理除法取模，代码简洁，优化思路清晰。
   - **核心代码**：
     ```cpp
     $int qpow($int a,$int b){
         $int res=1,tmp=a;
         while(b){ if(b&1){ res=(1ll*res*tmp)%mod; } tmp=(1ll*tmp*tmp)%mod; b>>=1; }
         return res;
     }
     $int inv($int k){ return qpow(k,mod-2); }
     ```
   - **实现思想**：对每个 $ A_i $ 进行质因数分解，记录每个质因数的最大次数，最终通过快速幂计算 $ LCM $，并使用逆元计算 $ \frac{LCM}{A_i} $。

### 最优关键思路
1. **质因数分解**：通过质因数分解求 $ LCM $，避免直接计算 $ LCM $ 导致溢出。
2. **逆元处理**：使用逆元处理除法取模问题，确保计算结果正确。
3. **快速幂优化**：通过快速幂计算 $ LCM $，提高计算效率。

### 拓展思路
- **类似题目**：可以扩展到处理更大范围的质因数分解问题，或者处理多个数的 $ LCM $ 和 $ GCD $ 问题。
- **优化技巧**：在处理大数时，可以考虑使用更高效的质因数分解算法，或者进一步优化快速幂的实现。

### 推荐题目
1. [P3811 【模板】乘法逆元](https://www.luogu.com.cn/problem/P3811)
2. [P1226 【模板】快速幂](https://www.luogu.com.cn/problem/P1226)
3. [P1075 质因数分解](https://www.luogu.com.cn/problem/P1075)

---
处理用时：30.58秒
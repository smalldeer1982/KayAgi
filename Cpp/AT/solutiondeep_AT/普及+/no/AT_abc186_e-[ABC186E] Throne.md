# 题目信息

# [ABC186E] Throne

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc186/tasks/abc186_e

円周上に $ N $ 個の椅子が並べられています。そのうち $ 1 $ つは玉座です。

高橋君は最初、玉座から時計回りに数えて $ S $ 個隣の椅子に座っており、次の行動を繰り返します。

行動：いま座っている椅子から時計回りに数えて $ K $ 個隣の椅子に移動し座る。

高橋君がはじめて玉座に座ることができるのは何回目の行動の後ですか？ ただし、玉座に座ることが永遠にできない場合は、代わりに `-1` を出力してください。

$ T $ 個のテストケースに答えてください。

## 说明/提示

### 制約

- $ 1\leq\ T\ \leq\ 100 $
- $ 2\leq\ N\ \leq\ 10^9 $
- $ 1\leq\ S\ <\ N $
- $ 1\leq\ K\ \leq\ 10^9 $

### Sample Explanation 1

$ 1 $ つ目のテストケースでは、椅子が $ 10 $ 個あり、高橋君は最初、玉座から時計回りに数えて $ 4 $ 個隣の席に座っています。 時計回りに $ 3 $ 個隣の席に移動する行動を $ 2 $ 回行うと玉座に座れます。 $ 2 $ つ目のテストケースでは、高橋君が玉座に座ることは永遠にできないので、`-1` を出力します。

## 样例 #1

### 输入

```
4

10 4 3

1000 11 2

998244353 897581057 595591169

10000 6 14```

### 输出

```
2

-1

249561088

3571```

# AI分析结果

### 题目内容重写

【题目描述】

圆周上有 $N$ 个椅子，其中一个是玉座。

高桥君最初坐在玉座顺时针数第 $S$ 个椅子上，并重复以下操作：

操作：从当前椅子顺时针数第 $K$ 个椅子移动并坐下。

高桥君第一次坐在玉座上是在第几次操作之后？如果永远无法坐在玉座上，则输出 `-1`。

共有 $T$ 个测试用例需要回答。

### 算法分类
数学

### 题解分析与结论

本题的核心是通过同余方程求解最小操作次数。所有题解都基于同余方程 $S + Kx \equiv 0 \pmod{N}$，并通过扩展欧几里得算法或逆元求解。难点在于处理无解情况（即 $\gcd(K, N)$ 不整除 $S$）以及确保解的最小性。

### 精选题解

#### 题解1：作者：cjh20090318 (赞：2)
- **星级**: 4
- **关键亮点**: 使用扩展欧几里得算法求解同余方程，代码简洁且逻辑清晰。
- **核心代码**:
  ```cpp
  LL exgcd(const LL&a,const LL&b){
      if(!b){ x=1,y=0; return a; }
      LL d=exgcd(b,a%b);
      LL z=x; x=y; y=z-y*(a/b);
      return d;
  }
  ```
  **实现思想**: 通过扩展欧几里得算法求解 $Kx \equiv (N-S) \pmod{N}$ 的解，并处理无解情况。

#### 题解2：作者：__Cby___ (赞：1)
- **星级**: 4
- **关键亮点**: 使用逆元求解同余方程，并先对 $N, S, K$ 进行约分，优化了计算。
- **核心代码**:
  ```cpp
  long long int fp(long long int a, long long int b, long long int p) {
      a %= p; long long int ans = 1;
      while (b) {
          if (b & 1) { ans *= a; ans %= p; }
          a *= a; a %= p; b >>= 1;
      }
      return ans;
  }
  ```
  **实现思想**: 通过快速幂计算逆元，并结合欧拉函数求解同余方程。

#### 题解3：作者：loser_seele (赞：1)
- **星级**: 4
- **关键亮点**: 使用 Atcoder 自带的逆元库实现，代码简洁且高效。
- **核心代码**:
  ```cpp
  g=gcd(n,gcd(s,k));
  n/=g,s/=g,k/=g;
  cout<<(gcd(n,k)!=1?-1:(atcoder::inv_mod(k,n)*(n-s))%n)<<'\n';
  ```
  **实现思想**: 利用 Atcoder 库函数 `inv_mod` 直接求解逆元，简化了代码实现。

### 最优关键思路
1. **同余方程转化**: 将问题转化为求解 $Kx \equiv (N-S) \pmod{N}$ 的最小正整数解。
2. **扩展欧几里得算法**: 用于求解同余方程，并处理无解情况。
3. **逆元求解**: 通过快速幂或库函数计算逆元，简化计算过程。

### 拓展思路
类似问题可以通过同余方程或扩展欧几里得算法解决，如求解线性同余方程、模反元素等。

### 推荐题目
1. [P1082 同余方程](https://www.luogu.com.cn/problem/P1082)
2. [P3811 乘法逆元](https://www.luogu.com.cn/problem/P3811)
3. [P1516 青蛙的约会](https://www.luogu.com.cn/problem/P1516)

---
处理用时：24.69秒
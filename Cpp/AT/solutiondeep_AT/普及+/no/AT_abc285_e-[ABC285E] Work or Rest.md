# 题目信息

# [ABC285E] Work or Rest

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc285/tasks/abc285_e

高橋君が住む世界の一週間は $ N $ 日からなります。  
 一週間は曜日 $ 1,2,\dots,N $ と進んでいき、曜日 $ N $ が終わると次の週の曜日 $ 1 $ が始まります。

ABC 国の国王である高橋君は、各曜日に「平日」「休日」のどちらかを割り当てます。この割り当ては毎週同じでなければなりません。また、少なくとも $ 1 $ つの曜日を「休日」に割り当てなければなりません。

この条件の下で、曜日 $ i $ の生産量は長さ $ N $ の数列 $ A $ を用いて以下のように定義されます。

- 曜日 $ i $ が「休日」である場合は $ 0 $
- 曜日 $ i $ が「平日」のとき、直前の休日が $ x $ 日前、直後の休日が $ y $ 日後である場合は $ A_{\min(x,y)} $
  - 割り当ては毎週繰り返されるため、 直前 / 直後 の「休日」が当日とは別の週に属する可能性があることに注意してください。詳しくはサンプルを参照してください。
 
上手く割り当てを決めたときの一週間当たりの生産量の最大値を答えてください。  
 但し、一週間当たりの生産量とは曜日 $ 1,2,\dots,N $ の生産量の総和を指します。

## 说明/提示

### 制約

- 入力はすべて整数
- $ 1\ \le\ N\ \le\ 5000 $
- $ 1\ \le\ A_i\ \le\ 10^9 $
 
### Sample Explanation 1

例えば曜日 $ 2,4 $ を「休日」、残りを「平日」に割り当てることで、以下のように一週間当たりの生産量 $ 50 $ を達成できます。 - 曜日 $ 1 $ ... $ x=4,y=1 $ なので、この曜日の生産量は $ A_1\ =\ 10 $ である。 - 曜日 $ 2 $ ... 「休日」であるので、この曜日の生産量は $ 0 $ である。 - 曜日 $ 3 $ ... $ x=1,y=1 $ なので、この曜日の生産量は $ A_1\ =\ 10 $ である。 - 曜日 $ 4 $ ... 「休日」であるので、この曜日の生産量は $ 0 $ である。 - 曜日 $ 5 $ ... $ x=1,y=4 $ なので、この曜日の生産量は $ A_1\ =\ 10 $ である。 - 曜日 $ 6 $ ... $ x=2,y=3 $ なので、この曜日の生産量は $ A_2\ =\ 10 $ である。 - 曜日 $ 7 $ ... $ x=3,y=2 $ なので、この曜日の生産量は $ A_2\ =\ 10 $ である。 一週間当たりの生産量を $ 51 $ 以上にすることはできません。

## 样例 #1

### 输入

```
7

10 10 1 1 1 1 1```

### 输出

```
50```

## 样例 #2

### 输入

```
10

200000000 500000000 1000000000 800000000 100000000 80000000 600000 900000000 1 20```

### 输出

```
5100000000```

## 样例 #3

### 输入

```
20

38 7719 21238 2437 8855 11797 8365 32285 10450 30612 5853 28100 1142 281 20537 15921 8945 26285 2997 14680```

### 输出

```
236980```

# AI分析结果

### 题目翻译

高桥君所在的世界一周有 $N$ 天。  
一周从第 $1$ 天开始，依次经过第 $2, 3, \dots, N$ 天，第 $N$ 天结束后，下一周的第 $1$ 天开始。

ABC 国的国王高桥君需要为每一天分配“工作日”或“休息日”。这个分配方案每周必须相同，并且每周至少有一天必须是“休息日”。

在这个条件下，第 $i$ 天的生产量由长度为 $N$ 的数列 $A$ 定义如下：

- 如果第 $i$ 天是“休息日”，则生产量为 $0$。
- 如果第 $i$ 天是“工作日”，则生产量为 $A_{\min(x,y)}$，其中 $x$ 是距离前一个休息日的天数，$y$ 是距离后一个休息日的天数。
  - 由于分配方案每周重复，前一个或后一个“休息日”可能属于不同的周。详情请参考样例。

请确定最佳的分配方案，使得一周的总生产量最大。  
一周的总生产量是指第 $1, 2, \dots, N$ 天的生产量之和。

### 算法分类
动态规划

### 题解分析与结论

该题的核心是通过动态规划（DP）来优化休息日的分配，以最大化一周的生产量。题解中主要思路是通过定义状态转移方程，枚举休息日的位置，并利用前缀和优化计算工作日区间的生产量。

### 所选高星题解

#### 题解1：FFTotoro (5星)
**关键亮点：**
- 通过定义 $S_i$ 表示连续 $i$ 天工作时的生产量，简化了状态转移。
- 使用完全背包的思路进行 DP 转移，时间复杂度为 $O(N^2)$。
- 代码简洁，思路清晰，易于理解。

**核心代码：**
```cpp
for(int i=2;i<=n;i++){
    f[i]=s[i-1]; // 第一种情况
    for(int j=1;j<i-2;j++) // 第二种情况，枚举
        f[i]=max(f[i],f[j+1]+f[i-j-1]); // 转移，取较大值
}
```

#### 题解2：Hell0_W0rld (4星)
**关键亮点：**
- 固定第 $N$ 天为休息日，简化了 DP 状态的设计。
- 通过预处理前缀和，优化了工作日区间的生产量计算。
- 状态转移方程清晰，时间复杂度为 $O(N^2)$。

**核心代码：**
```cpp
rep(i,1,n)rep(j,0,i-1){//前i天，上一个节假日j，i为节假日，前i天的最大动力（j=0即i为第一个节假日） 
    f[i][j]=mx[j]+cost(j,i);
    mx[i]=max(mx[i],f[i][j]);
}
```

#### 题解3：DE_aemmprty (4星)
**关键亮点：**
- 通过固定第一天为休息日，简化了 DP 状态的设计。
- 使用前缀和优化了工作日区间的生产量计算。
- 状态转移方程清晰，时间复杂度为 $O(N^2)$。

**核心代码：**
```cpp
GO (i, 2, n){
    f[i] = -2e18;
    GO (j, 0, i - 1){
        f[i] = max(f[i], f[i - j - 1] + cal(j));
    }
}
```

### 最优关键思路
1. **固定休息日**：通过固定某一天为休息日（如第 $1$ 天或第 $N$ 天），简化了 DP 状态的设计，避免了环形问题的复杂性。
2. **前缀和优化**：通过预处理前缀和，快速计算连续工作日区间的生产量，优化了时间复杂度。
3. **完全背包思路**：将问题转化为完全背包问题，通过枚举休息日的位置进行状态转移。

### 可拓展之处
类似的问题可以通过固定某一特征（如休息日）来简化状态设计，并结合前缀和或滑动窗口等技巧优化计算。

### 推荐题目
1. [P1048 采药](https://www.luogu.com.cn/problem/P1048) - 背包问题
2. [P1060 开心的金明](https://www.luogu.com.cn/problem/P1060) - 背包问题
3. [P1164 小A点菜](https://www.luogu.com.cn/problem/P1164) - 背包问题

### 个人心得摘录
- **FFTotoro**：强调了手推算法的重要性，认为对算法的透彻理解比单纯背模板更有长远价值。
- **Hell0_W0rld**：通过固定休息日简化了问题，并利用前缀和优化了计算，体现了对问题的深入理解。

---
处理用时：29.63秒
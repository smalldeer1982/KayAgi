# 题目信息

# [ABC293E] Geometric Progression

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc293/tasks/abc293_e

整数 $ A,\ X,\ M $ が与えられます。$ \displaystyle\ \sum_{i\ =\ 0}^{X-1}\ A^i $ を $ M $ で割った余りを求めてください。

## 说明/提示

### 制約

- $ 1\ \leq\ A,\ M\ \leq\ 10^9 $
- $ 1\ \leq\ X\ \leq\ 10^{12} $
- 入力はすべて整数

### Sample Explanation 1

$ 3^0\ +\ 3^1\ +\ 3^2\ +\ 3^3\ =\ 40 $ です。$ 40 $ を $ 7 $ で割った余りは $ 5 $ であるため、$ 5 $ を出力します。

## 样例 #1

### 输入

```
3 4 7```

### 输出

```
5```

## 样例 #2

### 输入

```
8 10 9```

### 输出

```
0```

## 样例 #3

### 输入

```
1000000000 1000000000000 998244353```

### 输出

```
919667211```

# AI分析结果

### 题目重写
【题目内容】
# [ABC293E] Geometric Progression

## 题目描述

给定整数 $A,\ X,\ M$，求 $\displaystyle\ \sum_{i\ =\ 0}^{X-1}\ A^i$ 对 $M$ 取模的结果。

## 说明/提示

### 约束条件

- $1\ \leq\ A,\ M\ \leq\ 10^9$
- $1\ \leq\ X\ \leq\ 10^{12}$
- 输入均为整数

### 样例解释 1

$3^0\ +\ 3^1\ +\ 3^2\ +\ 3^3\ =\ 40$。$40$ 对 $7$ 取模的结果是 $5$，因此输出 $5$。

## 样例 #1

### 输入

```
3 4 7```

### 输出

```
5```

## 样例 #2

### 输入

```
8 10 9```

### 输出

```
0```

## 样例 #3

### 输入

```
1000000000 1000000000000 998244353```

### 输出

```
919667211```

### 算法分类
数学、分治

### 题解分析与结论
本题的核心是计算等比数列的和，并对结果取模。由于 $X$ 的范围很大（$10^{12}$），直接暴力计算会超时，因此需要采用数学优化或分治策略。常见的思路包括：
1. **等比数列公式**：利用等比数列求和公式 $S = \frac{A^X - 1}{A - 1}$，但需要注意 $A=1$ 的特例和模数 $M$ 不一定是质数的问题。
2. **分治递归**：将问题分解为更小的子问题，利用递归或矩阵快速幂等方法加速计算。
3. **矩阵快速幂**：将问题转化为矩阵乘法，利用快速幂算法求解。

### 高星题解推荐
#### 1. 作者：zajasi (赞：12)
- **星级**：5星
- **关键亮点**：使用等比数列公式结合快速幂和乘法逆元，代码简洁高效。
- **核心代码**：
```cpp
LL qpow(LL x, LL y) {
    LL re = 1;
    for (; y > 0; y >>= 1) {
        if (y & 1) re = re * x % p;
        x = x * x % p;
    }
    return !re ? p : re;
}
```
- **实现思想**：通过快速幂计算 $A^X$，再利用公式 $S = \frac{A^X - 1}{A - 1}$ 计算和。

#### 2. 作者：FFTotoro (赞：6)
- **星级**：4星
- **关键亮点**：采用分治思想，将问题分解为偶数和奇数情况，递归求解。
- **核心代码**：
```cpp
int f(int a, int x) {
    if (!x) return 0;
    if (x == 1) return a % m;
    if (x & 1) return (f(a, x >> 1) * (qpow(a, x >> 1) + 1) % m + qpow(a, x)) % m;
    else return f(a, x >> 1) * (qpow(a, x >> 1) + 1) % m;
}
```
- **实现思想**：通过递归将问题分解为更小的子问题，利用快速幂加速计算。

#### 3. 作者：快乐的大童 (赞：5)
- **星级**：4星
- **关键亮点**：使用错位相减法推导公式，并处理 $A=1$ 的特例。
- **核心代码**：
```cpp
int ksm(int x, int y) {
    int res = 1;
    while (y) {
        if (y & 1) res = res * x % mod;
        x = x * x % mod;
        y >>= 1;
    }
    return !res ? mod : res;
}
```
- **实现思想**：通过快速幂计算 $A^X$，并利用公式 $S = \frac{A^X - 1}{A - 1}$ 计算和。

### 最优关键思路
1. **等比数列公式**：利用 $S = \frac{A^X - 1}{A - 1}$ 计算和，注意特例 $A=1$。
2. **快速幂**：通过快速幂算法高效计算 $A^X$。
3. **分治递归**：将问题分解为更小的子问题，递归求解。

### 拓展思路
类似的问题可以出现在其他需要高效计算大指数和模数的场景中，例如计算斐波那契数列的某项、矩阵快速幂等。

### 推荐题目
1. [P1226 【模板】快速幂](https://www.luogu.com.cn/problem/P1226)
2. [P1962 斐波那契数列](https://www.luogu.com.cn/problem/P1962)
3. [P3390 【模板】矩阵快速幂](https://www.luogu.com.cn/problem/P3390)

### 个人心得摘录
- **调试经历**：部分题解提到在处理 $A=1$ 的特例时容易忽略，导致错误。
- **踩坑教训**：模数 $M$ 不一定是质数，直接使用逆元可能导致错误。
- **顿悟感想**：分治递归和矩阵快速幂是处理大指数问题的有效方法。

---
处理用时：35.37秒
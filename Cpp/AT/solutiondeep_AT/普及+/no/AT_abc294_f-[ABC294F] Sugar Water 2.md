# 题目信息

# [ABC294F] Sugar Water 2

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc294/tasks/abc294_f

高橋君は $ N $ 本の砂糖水を、青木君は $ M $ 本の砂糖水を持っています。  
 高橋君の持っている $ i $ 番目の砂糖水は砂糖 $ A_i $ グラムと水 $ B_i $ グラムからなります。  
 青木君の持っている $ i $ 番目の砂糖水は砂糖 $ C_i $ グラムと水 $ D_i $ グラムからなります。  
 2 人の持つ砂糖水をそれぞれ 1 本ずつ選んで混ぜる方法は $ NM $ 通りあります。そのような方法でできる砂糖水の中で、濃度が高い方から $ K $ 番目の砂糖水の濃度が何 $ \% $ であるかを求めてください。  
 ここで、砂糖 $ x $ グラムと水 $ y $ グラムからなる砂糖水の濃度は $ \dfrac{100x}{x+y}\ \% $ です。また、砂糖が溶け残ることは考えないものとします。

## 说明/提示

### 制約

- $ 1\ \leq\ N,\ M\ \leq\ 5\ \times\ 10^4 $
- $ 1\ \leq\ K\ \leq\ N\ \times\ M $
- $ 1\ \leq\ A_i,\ B_i,\ C_i,\ D_i\ \leq\ 10^5 $
- 入力される値はすべて整数
 
### Sample Explanation 1

以下では高橋君が持っている $ i $ 番目の砂糖水と青木君が持っている $ j $ 番目の砂糖水を混ぜてできる砂糖水を $ (i,\ j) $ と表します。 あり得る砂糖水の混ぜ方とその濃度を列挙すると以下のようになります。 - $ (1,\ 1) $ : $ 100\ \times\ \frac{1\ +\ 1}{(1\ +\ 1)\ +\ (2\ +\ 4)}\ =\ 25\ \% $ - $ (2,\ 1) $ : $ 100\ \times\ \frac{1\ +\ 4}{(4\ +\ 1)\ +\ (1\ +\ 4)}\ =\ 50\ \% $ - $ (3,\ 1) $ : $ 100\ \times\ \frac{1\ +\ 1}{(1\ +\ 1)\ +\ (4\ +\ 4)}\ =\ 20\ \% $ この中で濃度が高い方から $ 1 $ 番目の砂糖水は $ (2,\ 1) $ で、濃度は $ 50\ \% $ です。

## 样例 #1

### 输入

```
3 1 1

1 2

4 1

1 4

1 4```

### 输出

```
50.000000000000000```

## 样例 #2

### 输入

```
2 2 2

6 4

10 1

5 8

9 6```

### 输出

```
62.500000000000000```

## 样例 #3

### 输入

```
4 5 10

5 4

1 6

7 4

9 8

2 2

5 6

6 7

5 3

8 1```

### 输出

```
54.166666666666664```

# AI分析结果

【题目翻译】
# [ABC294F] Sugar Water 2

## 题目描述

高橋君有 $N$ 瓶糖水，青木君有 $M$ 瓶糖水。  
高橋君的第 $i$ 瓶糖水含有 $A_i$ 克糖和 $B_i$ 克水。  
青木君的第 $i$ 瓶糖水含有 $C_i$ 克糖和 $D_i$ 克水。  
两人各自选择一瓶糖水混合，共有 $NM$ 种混合方式。求这些混合方式中，浓度从高到低排序后第 $K$ 大的糖水浓度是多少。  
糖水的浓度计算公式为 $\dfrac{100x}{x+y}\%$，其中 $x$ 为糖的质量，$y$ 为水的质量。假设糖完全溶解，不考虑未溶解的情况。

## 说明/提示

### 约束

- $1 \leq N, M \leq 5 \times 10^4$
- $1 \leq K \leq N \times M$
- $1 \leq A_i, B_i, C_i, D_i \leq 10^5$
- 输入的所有值均为整数

### 样例解释 1

高橋君和青木君的糖水混合方式及其浓度如下：
- $(1, 1)$ : $100 \times \frac{1 + 1}{(1 + 1) + (2 + 4)} = 25\%$
- $(2, 1)$ : $100 \times \frac{1 + 4}{(4 + 1) + (1 + 4)} = 50\%$
- $(3, 1)$ : $100 \times \frac{1 + 1}{(1 + 1) + (4 + 4)} = 20\%$
其中浓度最高的糖水是 $(2, 1)$，浓度为 $50\%$。

## 样例 #1

### 输入

```
3 1 1

1 2

4 1

1 4

1 4
```

### 输出

```
50.000000000000000
```

## 样例 #2

### 输入

```
2 2 2

6 4

10 1

5 8

9 6
```

### 输出

```
62.500000000000000
```

## 样例 #3

### 输入

```
4 5 10

5 4

1 6

7 4

9 8

2 2

5 6

6 7

5 3

8 1
```

### 输出

```
54.166666666666664
```

【算法分类】二分

【题解分析与结论】
该题的核心思路是通过二分法来寻找第 $K$ 大的糖水浓度。由于直接枚举所有混合方式的复杂度较高（$O(NM)$），因此采用二分法来优化。通过二分浓度，计算有多少种混合方式的浓度大于等于当前浓度，从而确定第 $K$ 大的浓度。

【评分较高的题解】
1. **作者：泥土笨笨 (5星)**
   - **关键亮点**：通过二分法优化了复杂度，详细解释了如何计算浓度大于等于某个值的混合方式数量，代码清晰且易于理解。
   - **个人心得**：强调了二分法的精度问题，确保在100次二分后精度足够。

2. **作者：DaydreamWarrior (4星)**
   - **关键亮点**：同样采用二分法，但通过将糖水的浓度公式转化为线性不等式，简化了计算过程。
   - **个人心得**：提到了双指针的使用，进一步优化了查找过程。

3. **作者：2huk (4星)**
   - **关键亮点**：详细解释了二分法的实现过程，并通过排序和二分查找来统计满足条件的混合方式数量。
   - **个人心得**：强调了二分法的实现细节，如如何调整二分边界。

【最优关键思路】
- **二分法**：通过二分浓度来快速定位第 $K$ 大的浓度值。
- **不等式转化**：将浓度公式转化为线性不等式，简化计算。
- **排序与二分查找**：通过排序和二分查找来统计满足条件的混合方式数量。

【可拓展之处】
- 类似的问题可以通过二分法来优化查找过程，尤其是在需要查找第 $K$ 大或第 $K$ 小值的情况下。
- 可以进一步优化二分法的精度和效率，例如通过调整二分次数或使用更高效的查找算法。

【推荐题目】
1. [P1182 数列分段 Section II](https://www.luogu.com.cn/problem/P1182)
2. [P1316 丢瓶盖](https://www.luogu.com.cn/problem/P1316)
3. [P2678 跳石头](https://www.luogu.com.cn/problem/P2678)

【个人心得总结】
- **调试经历**：在实现二分法时，需要注意精度的控制，确保在有限的二分次数内达到足够的精度。
- **踩坑教训**：直接枚举所有混合方式的复杂度较高，无法通过大规模数据测试，因此必须采用优化算法。
- **顿悟感想**：通过将浓度公式转化为线性不等式，可以大大简化计算过程，提高算法的效率。

---
处理用时：32.41秒
# 题目信息

# [AGC020B] Ice Rink Game

## 题目描述

[problemUrl]: https://atcoder.jp/contests/agc020/tasks/agc020_b

スケートリンクで、一人の大人の司会と $ N $ 人の子供がゲームを行います。 ゲームは $ K $ ラウンドからなり、ラウンド $ i $ では司会が次のように言います。

- $ A_i $ 人組を作って！

すると、まだ脱落していない子供たちは $ A_i $ 人からなるグループをできるだけ多く組みます。 一人につき一つのグループにしか入れません。 グループに入れなかった子供たちは脱落し、その他は次のラウンドに進みます。 ラウンドで誰も脱落しないこともありえます。

最後まで、つまりラウンド $ K $ のあとまで残ったのは $ 2 $ 人で、彼らが勝者となりました。

あなたは $ A_1 $, $ A_2 $, ..., $ A_K $ の値を聞き、$ N $ の値は知りませんが、推定してみたくなりました。

ゲームの開始前にいた子供たちの人数として考えられる最小の値と、最大の値を求めてください。もしくは、考えられる $ N $ の値は存在しないと判定してください。

## 说明/提示

### 制約

- $ 1\ \leq\ K\ \leq\ 10^5 $
- $ 2\ \leq\ A_i\ \leq\ 10^9 $
- 入力値はすべて整数である。

### Sample Explanation 1

例えば、ゲームの開始時に子供が $ 6 $ 人いた場合、以下のように進行します。 - ラウンド $ 1 $ では、$ 6 $ 人の子供たちが $ 3 $ 人組を $ 2 $ つ作り、誰も脱落しません。 - ラウンド $ 2 $ では、$ 6 $ 人の子供たちが $ 4 $ 人組を $ 1 $ つ作り、$ 2 $ 人が脱落します。 - ラウンド $ 3 $ では、$ 4 $ 人の子供たちが $ 3 $ 人組を $ 1 $ つ作り、$ 1 $ 人が脱落します。 - ラウンド $ 4 $ では、$ 3 $ 人の子供たちが $ 2 $ 人組を $ 1 $ つ作り、$ 1 $ 人が脱落します。 最後まで残った二人が勝者となります。

### Sample Explanation 2

このような状況はありえません。 特に、ゲームの開始時の子供たちの人数が $ 100 $ 人未満の場合は、ラウンド $ 3 $ で全員が脱落します。

## 样例 #1

### 输入

```
4

3 4 3 2```

### 输出

```
6 8```

## 样例 #2

### 输入

```
5

3 4 100 3 2```

### 输出

```
-1```

## 样例 #3

### 输入

```
10

2 2 2 2 2 2 2 2 2 2```

### 输出

```
2 3```

# AI分析结果

### 题目内容重写

在滑冰场上，一位成年主持人和 $N$ 个孩子进行游戏。游戏由 $K$ 轮组成，第 $i$ 轮中主持人会发出如下指令：

- 组成 $A_i$ 人小组！

然后，尚未被淘汰的孩子们会尽可能多地组成 $A_i$ 人小组。每个孩子只能加入一个小组。未能组成小组的孩子将被淘汰，其余的孩子进入下一轮。在某一轮中，可能没有人被淘汰。

最终，经过第 $K$ 轮后，剩下的是 $2$ 人，他们成为胜者。

你听到了 $A_1$, $A_2$, ..., $A_K$ 的值，但不知道 $N$ 的值，想要尝试估计它。

请找出游戏开始时可能的孩子人数的最小值和最大值，或者判断这样的 $N$ 值不存在。

### 算法分类
递推

### 题解分析与结论

本题的核心是通过逆向递推的方式，从最后一轮的剩余人数（2人）推导出初始人数的最小值和最大值。难点在于如何处理每一轮的淘汰规则，并确保递推过程中的边界条件正确。

### 所选高星题解

#### 题解1：Dimly_dust (4星)
**关键亮点**：
- 使用逆向递推的思路，从最后一轮向前推导初始人数。
- 通过 $L_i$ 和 $R_i$ 表示每一轮后的人数区间，利用取整操作计算每一轮前的人数区间。
- 代码简洁，逻辑清晰。

**核心代码**：
```cpp
for(int i=n; i>=1; i--)
{
    lef=((lef-1)/ans[i]+1)*ans[i];
    rig=rig/ans[i]*ans[i]+ans[i]-1;
}
if(lef>rig)cout<<-1;
else cout<<lef<<" "<<rig;
```
**核心思想**：通过取整操作计算每一轮前的人数区间，确保区间内的值满足淘汰规则。

#### 题解2：Ender_NaCl (4星)
**关键亮点**：
- 同样采用逆向递推的思路，但详细解释了每一步的推导过程。
- 特别处理了无解情况，如 $R < a_i$ 和特殊情况。
- 代码结构清晰，注释详细。

**核心代码**：
```cpp
for(i = 1;i <= n;i++)
{
    if(r[i - 1] < a[i]) break;
    long long p = l[i - 1] / a[i] + (l[i - 1] % a[i] != 0?1:0),q = r[i - 1] / a[i];
    if(p > q) break;
    l[i] = p * a[i];
    r[i] = (q + 1) * a[i] - 1;
}
if(l[n] == 0) cout<<-1;
else cout<<l[n]<<' '<<r[n];
```
**核心思想**：通过计算每一轮前的人数区间，并处理特殊情况，确保递推的正确性。

### 最优关键思路
逆向递推是解决本题的核心思路，通过从最后一轮向前推导，利用取整操作计算每一轮前的人数区间，确保区间内的值满足淘汰规则。处理无解情况和特殊情况是关键难点。

### 可拓展之处
类似的问题可以通过逆向思维和递推方法解决，特别是在需要从结果推导初始条件的情况下。例如，某些动态规划问题或组合数学问题也可以采用类似的思路。

### 推荐题目
1. [P1044 栈](https://www.luogu.com.cn/problem/P1044)
2. [P1057 传球游戏](https://www.luogu.com.cn/problem/P1057)
3. [P1060 开心的金明](https://www.luogu.com.cn/problem/P1060)

这些题目都涉及到递推和逆向思维的运用，适合进一步巩固相关知识点。

---
处理用时：28.83秒
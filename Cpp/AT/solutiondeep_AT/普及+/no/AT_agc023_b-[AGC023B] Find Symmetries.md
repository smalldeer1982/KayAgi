# 题目信息

# [AGC023B] Find Symmetries

## 题目描述

Snuke 有两块板子。每块板都是一个 $n$ 行 $n$ 列的网格。对于这两块板子，记第 $i$ 行 $j$ 列的格子为 $(i,j)$。

第一块板子的每个格子上都写着一个小写字母：格子 $(i,j)$ 上的字母为 $S_{i,j}$。第二块板子上没有写任何东西。

Snuke 将以以下方法在第二块板子上写下字母：

首先，选择两个整数 $A$，$B$；然后在第二块板子的每个格子上写下一个字母。具体的说，第二块板子的格子 $(i+A,j+B)$ 将写上 $S_{i,j}$。这里第 $n+k$ 行即第 $k$ 行，第 $n+k$ 列即为第 $k$ 列。

此操作后，若对任意的 $i,j$，第二块板的格子 $(j,i)$ 上的字母和格子 $(i,j)$ 上的字母相同，则称第二块板为“好板”。

请你求出有多少 $A,B$ 满足 $0\le A,B<n$，且经过上述操作后第二块板为“好板”。

## 说明/提示

- $1\le n\le 300$。
- $S_{i,j}$ 都是小写字母。

#### 样例解释：

对于样例 1：对于所有可能的 $A$ 和 $B$，二号板上的字母如下所示：

![](https://img.atcoder.jp/agc023/2414e26dc3abb6dd7bfa0c800bb4af0c.png)

当且仅当 $(A,B)=(0,1)$ 或 $(A,B)=(1,0)$ 时满足第二块板是“好板”，因此答案是 $22$。

对于样例 2，所有被选中的 $A$ 和 $B$ 都会使第二块板成为“好板”。

对于样例 3，没有 $A$ 和 $B$ 可以使第二块板成为“好板”。

## 样例 #1

### 输入

```
2

ab

ca```

### 输出

```
2```

## 样例 #2

### 输入

```
4

aaaa

aaaa

aaaa

aaaa```

### 输出

```
16```

## 样例 #3

### 输入

```
5

abcde

fghij

klmno

pqrst

uvwxy```

### 输出

```
0```

# AI分析结果

### 题目内容重写
Snuke 有两块板子。每块板都是一个 $n$ 行 $n$ 列的网格。对于这两块板子，记第 $i$ 行 $j$ 列的格子为 $(i,j)$。

第一块板子的每个格子上都写着一个小写字母：格子 $(i,j)$ 上的字母为 $S_{i,j}$。第二块板子上没有写任何东西。

Snuke 将以以下方法在第二块板子上写下字母：

首先，选择两个整数 $A$，$B$；然后在第二块板子的每个格子上写下一个字母。具体的说，第二块板子的格子 $(i+A,j+B)$ 将写上 $S_{i,j}$。这里第 $n+k$ 行即第 $k$ 行，第 $n+k$ 列即为第 $k$ 列。

此操作后，若对任意的 $i,j$，第二块板的格子 $(j,i)$ 上的字母和格子 $(i,j)$ 上的字母相同，则称第二块板为“好板”。

请你求出有多少 $A,B$ 满足 $0\le A,B<n$，且经过上述操作后第二块板为“好板”。

### 算法分类
枚举、数学

### 题解分析与结论
1. **myee的题解**：使用了二维哈希的方法，通过将原矩阵和转置后的矩阵进行哈希处理，判断是否满足对称条件。复杂度为$O(n^2)$，但常数较大。
   - **评分**：4星
   - **关键亮点**：使用二维哈希优化了判断对称性的复杂度，代码实现较为复杂但思路清晰。

2. **zmza的题解**：通过枚举$A$，并判断在移动后矩阵是否对称，复杂度为$O(n^3)$。
   - **评分**：3星
   - **关键亮点**：思路简单直接，但复杂度较高，适合小规模数据。

3. **火车司机的题解**：通过枚举主对角线上的点，减少枚举数量，复杂度为$O(n^3)$。
   - **评分**：3星
   - **关键亮点**：通过减少枚举数量优化了复杂度，但实现较为复杂。

4. **cosf的题解**：通过分析发现只需要判断形如$(a, 0)$的转写方式，复杂度为$O(n^3)$。
   - **评分**：3星
   - **关键亮点**：通过数学分析减少了判断条件，但复杂度仍然较高。

### 最优关键思路
- **二维哈希**：通过哈希处理矩阵，快速判断对称性，适用于大规模数据。
- **数学分析**：通过分析题目条件，减少枚举数量，优化复杂度。

### 可拓展之处
- 类似题目可以通过哈希或数学分析来优化判断条件，减少复杂度。
- 可以进一步研究二维哈希的应用，提高代码效率。

### 推荐题目
1. [P3375 【模板】KMP字符串匹配](https://www.luogu.com.cn/problem/P3375)
2. [P3383 【模板】线性筛素数](https://www.luogu.com.cn/problem/P3383)
3. [P3376 【模板】网络最大流](https://www.luogu.com.cn/problem/P3376)

### 个人心得
- **myee**：大常数$O(n^2)$跑不过小常数$O(n^3)$实锤了。通过哈希优化了判断条件，但代码实现较为复杂。
- **zmza**：通过枚举$A$，并判断在移动后矩阵是否对称，思路简单直接，但复杂度较高。
- **火车司机**：通过枚举主对角线上的点，减少枚举数量，优化了复杂度，但实现较为复杂。
- **cosf**：通过数学分析发现只需要判断形如$(a, 0)$的转写方式，减少了判断条件，但复杂度仍然较高。

---
处理用时：26.20秒
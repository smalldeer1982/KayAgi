# 题目信息

# [AGC027C] ABland Yard

## 题目描述

[problemUrl]: https://atcoder.jp/contests/agc027/tasks/agc027_c

$ N $ 頂点 $ M $ 本の辺からなる無向グラフが与えられます。 頂点には $ 1 $ から $ N $ の番号が、辺には $ 1 $ から $ M $ の番号がついています。 頂点には番号以外に `A` か `B` のラベルがついており、頂点 $ i $ には $ s_i $ のラベルがついています。

辺 $ i $ は頂点 $ a_i $ と $ b_i $ を双方向につなぐ辺です。

怪盗ヌスークは好きな頂点を始点として選び、そこから $ 0 $ 回以上辺を辿って移動するのが好きです。 今日は移動後に、訪れた頂点についているラベルを始点から訪問した順に並べて文字列を作ることにしました。

例えば、頂点 $ 1 $ にラベル `A` が、頂点 $ 2 $ にラベル `B` がついているグラフにおいて、ヌスークが $ 1\ \rightarrow\ 2\ \rightarrow\ 1\ \rightarrow\ 2\ \rightarrow\ 2 $ と移動した場合、`ABABB` が作られます。

怪盗ヌスークが文字 `A`,`B` のみからなる任意の文字列が作れるかどうかを判定してください。

## 说明/提示

### 制約

- $ 2\ \leq\ N\ \leq\ 2\ \times\ 10^{5} $
- $ 1\ \leq\ M\ \leq\ 2\ \times\ 10^{5} $
- $ |s|\ =\ N $
- $ s_i $ は `A` または `B`
- $ 1\ \leq\ a_i,\ b_i\ \leq\ N $
- 与えられるグラフは単純とも連結とも限らない

### Sample Explanation 1

\- ヌスークは頂点 $ 1 $ と頂点 $ 2 $ を自由に訪れることができるため、`A`,`B` のみからなる任意の文字列が作ることが可能です !\[77e96cf8e213d606ddd8f3c3f8315d32.png\](https://img.atcoder.jp/agc027/77e96cf8e213d606ddd8f3c3f8315d32.png)

### Sample Explanation 2

\- 例えば、`BB` を作ることができません - 与えられるグラフは連結とは限りません !\[1ab1411cb9d6ee023d14ca4e77c4b584.png\](https://img.atcoder.jp/agc027/1ab1411cb9d6ee023d14ca4e77c4b584.png)

## 样例 #1

### 输入

```
2 3

AB

1 1

1 2

2 2```

### 输出

```
Yes```

## 样例 #2

### 输入

```
4 3

ABAB

1 2

2 3

3 1```

### 输出

```
No```

## 样例 #3

### 输入

```
13 23

ABAAAABBBBAAB

7 1

10 6

1 11

2 10

2 8

2 11

11 12

8 3

7 12

11 2

13 13

11 9

4 1

9 7

9 6

8 13

8 6

4 10

8 7

4 3

2 1

8 12

6 9```

### 输出

```
Yes```

## 样例 #4

### 输入

```
13 17

BBABBBAABABBA

7 1

7 9

11 12

3 9

11 9

2 1

11 5

12 11

10 8

1 11

1 8

7 7

9 10

8 8

8 12

6 2

13 11```

### 输出

```
No```

# AI分析结果

### 题目内容重写

【题目描述】

给定一个由 $N$ 个顶点和 $M$ 条边组成的无向图。顶点编号为 $1$ 到 $N$，边编号为 $1$ 到 $M$。每个顶点都有一个标签，标签为 `A` 或 `B`，顶点 $i$ 的标签为 $s_i$。

边 $i$ 连接顶点 $a_i$ 和 $b_i$，且是双向的。

怪盗ヌスーク可以选择任意一个顶点作为起点，并沿着边移动任意次数（包括不移动）。移动后，他将访问过的顶点的标签按顺序排列成一个字符串。

例如，顶点 $1$ 的标签为 `A`，顶点 $2$ 的标签为 `B`，如果ヌスーク的移动路径为 $1 \rightarrow 2 \rightarrow 1 \rightarrow 2 \rightarrow 2$，那么生成的字符串为 `ABABB`。

请判断怪盗ヌスーク是否能够生成所有由 `A` 和 `B` 组成的任意字符串。

### 算法分类

图论

### 题解分析与结论

题目要求判断是否存在一个子图，使得该子图中的每个顶点都至少有一个标签为 `A` 和一个标签为 `B` 的邻接顶点。这样，怪盗ヌスーク可以在该子图中自由选择 `A` 或 `B` 作为下一步的移动目标，从而生成任意由 `A` 和 `B` 组成的字符串。

大多数题解都采用了类似拓扑排序的思路，通过不断删除不满足条件的顶点（即没有 `A` 或 `B` 邻接顶点的顶点），最终判断是否还有剩余的顶点。如果有，则说明存在满足条件的子图，输出 `Yes`；否则输出 `No`。

### 高星题解推荐

#### 1. 作者：run_away (4星)

**关键亮点：**
- 使用类似拓扑排序的方法，逐步删除不满足条件的顶点。
- 代码简洁，逻辑清晰，时间复杂度为 $O(n)$。

**核心代码：**
```cpp
queue<ll>q;
for(ll i=1;i<=n;++i){
    if(!cnt[i][0]||!cnt[i][1]){
        q.push(i),vis[i]=1;
    }
}
while(!q.empty()){
    ll u=q.front();q.pop();
    for(auto v:son[u]){
        if(!--cnt[v][a[u]-'A']&&!vis[v]){
            q.push(v);vis[v]=1;
        }
    }
}
ll ans=0;
for(ll i=1;i<=n;++i)ans+=!vis[i];
if(ans)puts("Yes");
else puts("No");
```

#### 2. 作者：zhylj (4星)

**关键亮点：**
- 同样采用拓扑排序的思路，代码结构清晰，易于理解。
- 使用了队列来维护待删除的顶点，时间复杂度为 $O(n)$。

**核心代码：**
```cpp
for(int i = 1; i <= n; ++i)
    if(!dg[i][0] || !dg[i][1]) {
        que.push(i); --res;
        vis[i] = true;
    }
while(!que.empty()) {
    int u = que.front(); que.pop();
    for(auto v : E[u]) {
        --dg[v][typ[u]];
        if(!dg[v][typ[u]] && !vis[v]) {
            que.push(v); --res;
            vis[v] = true;
        }
    }
}
return res;
```

#### 3. 作者：ARIS2_0 (4星)

**关键亮点：**
- 使用 BFS 的方法，逐步删除不满足条件的顶点。
- 代码结构清晰，逻辑简单，时间复杂度为 $O(n)$。

**核心代码：**
```cpp
void bfs(int n){
    for(int i=1;i<=n;i++){
        if(cnt[i][0]==0 or cnt[i][1]==0){
            vis[i]=1;
            q.push(i);
        }
    }
    while(q.size()){
        int x=q.front();q.pop();
        for(int y:v[x]){
            if(!vis[y]){
                cnt[y][a[x]]--;
                if(cnt[y][a[x]]==0){
                    vis[y]=1;
                    q.push(y);
                }
            }
        }
    }
}
```

### 最优关键思路

通过类似拓扑排序的方法，逐步删除不满足条件的顶点（即没有 `A` 或 `B` 邻接顶点的顶点），最终判断是否还有剩余的顶点。如果有，则说明存在满足条件的子图，输出 `Yes`；否则输出 `No`。这种方法的时间复杂度为 $O(n)$，适用于大规模数据。

### 可拓展之处

类似的问题可以扩展到多标签的情况，例如每个顶点有多个标签，判断是否能够生成所有由这些标签组成的任意字符串。此外，这种方法也可以用于其他图论问题中，例如判断图中是否存在满足特定条件的子图。

### 推荐题目

1. [P3387 【模板】缩点](https://www.luogu.com.cn/problem/P3387)
2. [P3916 图的遍历](https://www.luogu.com.cn/problem/P3916)
3. [P3371 【模板】单源最短路径（弱化版）](https://www.luogu.com.cn/problem/P3371)

---
处理用时：32.64秒
# 题目信息

# [ARC108C] Keep Graph Connected

## 题目描述

[problemUrl]: https://atcoder.jp/contests/arc108/tasks/arc108_c

$ 1 $ から $ N $ の番号がついた $ N $ 個の頂点と $ 1 $ から $ M $ の番号がついた $ M $ 本の辺からなる連結な無向グラフが与えられます。 このグラフに多重辺は存在するかもしれませんが、自己ループはありません。

このグラフのそれぞれの辺には $ 1 $ 以上 $ N $ 以下の整数で表されるラベルがついています。 辺 $ i $ はラベル $ c_i $ がついており、頂点 $ u_i,v_i $ を双方向につなぐ辺です。

すぬけ君はそれぞれの頂点に $ 1 $ 以上 $ N $ 以下の整数を書き込んだのち(頂点に書き込まれた整数に重複があっても構いません)、以下の条件を満たす辺のみを残してそれ以外の辺を取り除くことにしました。

**条件**：辺の両端の頂点に書き込まれた整数を $ x,y $ として、$ x,y $ のいずれか一方**のみ**が辺についたラベルと等しい

上記の条件を満たさない辺を取り除いたあとのグラフも連結のままであるような頂点への整数の書き込み方を *よい書き込み方* と呼びます。よい書き込み方が存在するかどうかを判定し、存在するならばその一例を示してください。

## 说明/提示

### 制約

- $ 2\ \leq\ N\ \leq\ 10^5 $
- $ N-1\ \leq\ M\ \leq\ 2\ \times\ 10^5 $
- $ 1\ \leq\ u_i,v_i,c_i\ \leq\ N $
- 与えられるグラフは連結
- 与えられるグラフに自己ループはない

### Sample Explanation 1

\- 頂点 $ 1,2,3 $ にそれぞれ $ 1,2,1 $ を書き込みます。 - 辺 $ 1 $ は頂点 $ 1,2 $ をつないでおり、ラベルが $ 1 $ です。 - 頂点 $ 1 $ に書き込まれた整数のみが辺についたラベルと等しいため辺 $ 1 $ は取り除かれません。 - 辺 $ 2 $ は頂点 $ 2,3 $ をつないでおり、ラベルが $ 2 $ です。 - 頂点 $ 2 $ に書き込まれた整数のみが辺についたラベルと等しいため辺 $ 2 $ は取り除かれません。 - 辺 $ 3 $ は頂点 $ 1,3 $ をつないでおり、ラベルが $ 3 $ です。 - どちらの頂点に書き込まれた整数も辺についたラベルと異なるため辺 $ 3 $ は取り除かれます。 - 辺 $ 4 $ は頂点 $ 1,3 $ をつないでおり、ラベルが $ 1 $ です。 - どちらの頂点に書き込まれた整数も辺についたラベルと等しいため辺 $ 4 $ は取り除かれます。 - 辺 $ 3,4 $ が取り除かれたあともグラフは連結なので、この書き込み方はよい書き込み方です。

## 样例 #1

### 输入

```
3 4

1 2 1

2 3 2

3 1 3

1 3 1```

### 输出

```
1

2

1```

# AI分析结果

### 题目内容重写

**题目描述**

给定一个由 $N$ 个顶点和 $M$ 条边组成的连通无向图，顶点编号为 $1$ 到 $N$，边编号为 $1$ 到 $M$。图中可能存在多重边，但没有自环。每条边都有一个标签，标签值为 $1$ 到 $N$ 之间的整数。

你需要为每个顶点赋一个 $1$ 到 $N$ 之间的整数值（顶点之间的值可以重复），然后根据以下条件删除边：

**条件**：对于每条边，其两个端点的值 $x$ 和 $y$ 中，**恰好有一个**等于该边的标签值。

删除不满足条件的边后，图必须仍然保持连通。这样的顶点赋值方案称为“好的赋值方案”。你需要判断是否存在这样的方案，如果存在，输出一种可行的方案。

**说明/提示**

- $2 \leq N \leq 10^5$
- $N-1 \leq M \leq 2 \times 10^5$
- $1 \leq u_i, v_i, c_i \leq N$
- 给定的图是连通的
- 给定的图没有自环

**样例解释**

- 顶点 $1,2,3$ 分别赋值为 $1,2,1$。
- 边 $1$ 连接顶点 $1$ 和 $2$，标签为 $1$。顶点 $1$ 的值等于标签，因此边 $1$ 保留。
- 边 $2$ 连接顶点 $2$ 和 $3$，标签为 $2$。顶点 $2$ 的值等于标签，因此边 $2$ 保留。
- 边 $3$ 连接顶点 $1$ 和 $3$，标签为 $3$。两个顶点的值都不等于标签，因此边 $3$ 删除。
- 边 $4$ 连接顶点 $1$ 和 $3$，标签为 $1$。两个顶点的值都等于标签，因此边 $4$ 删除。
- 删除边 $3$ 和 $4$ 后，图仍然连通，因此这是一个好的赋值方案。

### 算法分类
**构造**

### 题解分析与结论

所有题解的核心思路都是通过构造生成树，并利用深度优先搜索（DFS）为每个顶点赋值，确保删除不满足条件的边后图仍然连通。具体来说，题解们通过以下步骤实现：

1. **生成树构造**：首先构造图的任意一棵生成树，确保图的基本连通性。
2. **DFS赋值**：从根节点开始，通过DFS遍历生成树，为每个节点赋值。如果父节点的值与当前边的标签相同，则子节点赋值为与标签不同的值；否则，子节点赋值为标签值。
3. **保证连通性**：通过生成树的结构和DFS赋值策略，确保删除不满足条件的边后，生成树仍然连通，从而保证整个图连通。

### 精选题解

#### 题解1：bobo2007
**星级**：4.5  
**关键亮点**：  
- 使用并查集构造生成树，确保图的基本连通性。
- 通过DFS为每个节点赋值，逻辑清晰，代码简洁。
- 详细解释了赋值策略，确保删除边后图仍然连通。

**核心代码**：
```cpp
void dfs(int x,int fa)
{
    int i;
    for(i=a[x];i;i=b[i].next)
    {
        int y=b[i].to;
        if(y==fa) continue;
        if(ans[x]==b[i].s) ans[y]=ans[x]==1?2:1;
        else ans[y]=b[i].s;
        dfs(y,x);
    }
}
```
**个人心得**：  
- 通过生成树和DFS的结合，确保了解的正确性和高效性。

#### 题解2：copper_ingot
**星级**：4.0  
**关键亮点**：  
- 使用并查集构造生成树，边输入边处理，节省空间。
- 通过DFS为每个节点赋值，逻辑清晰，代码简洁。
- 详细解释了赋值策略，确保删除边后图仍然连通。

**核心代码**：
```cpp
void dfs(int u, int f, int val){
    if (u != 1){
        if (ans[f] == val) ans[u] = ans[f] % n + 1;
        else ans[u] = val;
    }
    for (int i = 0; i < g[u].size(); i++){
        int v = g[u][i].first, w = g[u][i].second;
        if (v != f) dfs(v, u, w);
    }
}
```
**个人心得**：  
- 通过生成树和DFS的结合，确保了解的正确性和高效性。

#### 题解3：New_hope
**星级**：4.0  
**关键亮点**：  
- 使用DFS构造生成树，并同时为每个节点赋值，逻辑清晰。
- 详细解释了赋值策略，确保删除边后图仍然连通。
- 代码简洁，易于理解。

**核心代码**：
```cpp
void dfs (int u)
{
  for (auto i : G[u]) {
    int v = i.v, c = i.c;
    if (v == fa[u]) {
      if (co[fa[u]] == c) {
        co[u] = (c > 1 ? c - 1 : c + 1);
      } else {
        co[u] = c;
      }
    }
  }
  for (auto i : G[u]) {
    int v = i.v;
    if (tg[v]) continue;
    tg[v] = 1, fa[v] = u;
    dfs (v);
  }
}
```
**个人心得**：  
- 通过生成树和DFS的结合，确保了解的正确性和高效性。

### 最优关键思路或技巧
- **生成树构造**：通过生成树确保图的基本连通性，简化问题。
- **DFS赋值**：通过DFS遍历生成树，为每个节点赋值，确保删除不满足条件的边后图仍然连通。
- **并查集优化**：使用并查集高效构造生成树，节省空间和时间。

### 可拓展之处
- 类似问题可以通过生成树和DFS的结合来解决，如最小生成树、最大生成树等。
- 可以扩展到更复杂的图论问题，如带权图、有向图等。

### 推荐题目
1. [P3366 【模板】最小生成树](https://www.luogu.com.cn/problem/P3366)
2. [P3371 【模板】单源最短路径（弱化版）](https://www.luogu.com.cn/problem/P3371)
3. [P3388 【模板】割点（割顶）](https://www.luogu.com.cn/problem/P3388)

---
处理用时：53.11秒
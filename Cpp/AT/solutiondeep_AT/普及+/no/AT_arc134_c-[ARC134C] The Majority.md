# 题目信息

# [ARC134C] The Majority

## 题目描述

[problemUrl]: https://atcoder.jp/contests/arc134/tasks/arc134_c

$ 1 $ から $ K $ の番号がついた $ K $ 個の箱があります。はじめ、箱は全て空です。

すぬけ君は $ 1 $ 以上 $ N $ 以下の整数が書かれたボールをいくつか持っています。 すぬけ君が持っているボールのうち、$ i $ が書かれたものは $ a_i $ 個あります。 同じ整数が書かれたボール同士は区別できません。

すぬけ君は持っている全てのボールを箱にしまうことにしました。 すぬけ君はどの箱についても $ 1 $ と書かれたボールが過半数を占めるようにしたいです。 過半数を占めるとは、$ 1 $ と書かれたボールの個数がそれ以外のボールの個数より多いことを意味します。

そのようなしまい方の個数を $ 998244353 $ で割ったあまりを求めてください。

$ 2 $ つのしまい方が異なるとは、$ 1\ \leq\ i\ \leq\ K,\ 1\ \leq\ j\ \leq\ N $ を満たす整数の組 $ (i,j) $ であって、箱 $ i $ に入っている $ j $ が書かれたボールの個数が異なるようなものが存在することをいいます。

## 说明/提示

### 制約

- 与えられる入力は全て整数
- $ 1\ \leq\ N\ \leq\ 10^5 $
- $ 1\ \leq\ K\ \leq\ 200 $
- $ 1\ \leq\ a_i\ <\ 998244353 $

### Sample Explanation 1

\- $ 1 $ と書かれたボールが過半数を占めるようなしまい方は $ 2 $ 通りあります。 - 例えば $ 1 $ と書かれたボールを箱 $ 1 $ に $ 2 $ 個、箱 $ 2 $ に $ 1 $ 個入れ、$ 2 $ と書かれたボールを箱 $ 1 $ に $ 1 $ 個入れたとき条件を満たします。

### Sample Explanation 2

\- 条件を満たすようなしまい方が存在しないこともあります。

### Sample Explanation 3

\- $ 998244353 $ で割ったあまりを求めるのを忘れずに。

## 样例 #1

### 输入

```
2 2

3 1```

### 输出

```
2```

## 样例 #2

### 输入

```
2 1

1 100```

### 输出

```
0```

## 样例 #3

### 输入

```
20 100

1073813 90585 41323 52293 62633 28788 1925 56222 54989 2772 36456 64841 26551 92115 63191 3603 82120 94450 71667 9325```

### 输出

```
313918676```

# AI分析结果

### 题目内容重写

#### 题目描述

有编号从 $1$ 到 $K$ 的 $K$ 个箱子。初始时，所有箱子都是空的。

史努克君有一些球，球上写着 $1$ 到 $N$ 的整数。在这些球中，写着数字 $i$ 的球有 $a_i$ 个。相同数字的球无法区分。

史努克君决定将所有球放入箱子中。他希望每个箱子中，写着数字 $1$ 的球的数量都超过其他球的数量。即，每个箱子中，写着数字 $1$ 的球的数量必须大于其他球的数量。

求满足条件的放置方案数，结果对 $998244353$ 取模。

两种放置方案不同，当且仅当存在一对整数 $(i,j)$ 满足 $1 \leq i \leq K$，$1 \leq j \leq N$，且在第 $i$ 个箱子中，写着数字 $j$ 的球的数量不同。

#### 说明/提示

##### 约束

- 所有输入均为整数。
- $1 \leq N \leq 10^5$
- $1 \leq K \leq 200$
- $1 \leq a_i < 998244353$

##### 样例解释

- 样例1：$1$ 号球在箱子中占多数的放置方案有 $2$ 种。
- 样例2：不存在满足条件的放置方案。
- 样例3：结果需要对 $998244353$ 取模。

### 算法分类

组合数学

### 题解分析与结论

#### 综合分析与结论

本题的核心在于如何计算满足条件的放置方案数。关键点在于每个箱子中 $1$ 号球的数量必须超过其他球的数量。通过组合数学中的隔板法，可以将问题转化为计算不同球分配到箱子中的方案数。

#### 所选高分题解

##### 题解1：作者：binbin_200811 (4星)

**关键亮点：**
- 通过将 $1$ 号球与其它球配对，确保每个箱子中 $1$ 号球的数量超过其它球。
- 使用隔板法计算剩余球的分配方案。
- 代码清晰，逻辑严谨。

**核心代码：**
```cpp
ll C(ll n,ll m)
{
    if(n<=m) return 1;
    ll sum=inv[m];
    for(ll i=n-m+1;i<=n;i++) sum=sum*i%mod;
    return sum;
}

int main()
{
    scanf("%lld%lld",&n,&k);

    fac[0]=1;
    for(int i=1;i<=k;i++) fac[i]=fac[i-1]*i%mod;
    inv[k]=ksm(fac[k],mod-2);
    for(int i=k-1;i>=0;i--) inv[i]=inv[i+1]*(i+1)%mod;

    for(int i=1;i<=n;i++) scanf("%lld",&a[i]);
    for(int i=2;i<=n;i++) sum+=a[i];

    a[1]=a[1]-sum-k;
    if(a[1]<0)
    {
        printf("0");
        return 0;
    }

    ans=1;
    for(int i=1;i<=n;i++)
        ans=ans*C(a[i]+k-1,k-1)%mod;
    printf("%lld",ans);
}
```

##### 题解2：作者：Pretharp (4星)

**关键亮点：**
- 通过配对 $1$ 号球与其它球，确保每个箱子中 $1$ 号球的数量超过其它球。
- 使用隔板法计算剩余球的分配方案。
- 代码结构清晰，注释详细。

**核心代码：**
```cpp
int C(int x,int y)
{
    int res=1;
    for(int i=x-y+1;i<=x;i++){
        (res*=i)%=mod1;
    }
    (res*=qmi(f[y],mod1-2))%=mod1;
    return res;
}

signed main()
{
    cin>>n>>k;
    for(int i=1;i<=n;i++){
        cin>>a[i];
        sum=sum+a[i];
    }
    sum=a[1]-(sum-a[1]);
    if(sum<k) return cout<<0<<endl,0;
    f[0]=1;
    for(int i=1;i<=k;i++){
        f[i]=f[i-1]*i%mod1;
    }
    ans=C(sum-1,k-1)%mod1;
    for(int i=2;i<=n;i++){
        ans=(ans*C(a[i]+k-1,k-1))%mod1;
    } 
    return cout<<ans<<endl,0;
}
```

##### 题解3：作者：zhangjiahe__ (4星)

**关键亮点：**
- 通过配对 $1$ 号球与其它球，确保每个箱子中 $1$ 号球的数量超过其它球。
- 使用隔板法计算剩余球的分配方案。
- 代码简洁，逻辑清晰。

**核心代码：**
```cpp
long long C(long long n, long long m)
{
    long long res = 1;
    for(int i = n-m+1; i <= n; i++)
    {
        res *= i;
        res %= p;
    }
    res *= fastpow(dp[m], p-2);
    return res % p;
}

int main()
{
    cin >> n >> k;
    for(int i = 1; i <= n; i++)
    {
        cin >> a[i];
        els += a[i];
    }
    if(2*a[1]-k < els)
    {
        cout << 0;
        return 0;
    }
    els = 2*a[1]-els;
    dp[0] = 1;
    for(int i = 1; i <= k; i++)
        dp[i] = dp[i-1]*i%p;
    ans = C(els-1, k-1) % p;
    for(int i = 2 ; i<= n; i++)
    {
        ans *= C(a[i]+k-1, k-1);
        ans %= p;
    }
    cout << ans;
}
```

### 最优关键思路或技巧

1. **配对思想**：通过将 $1$ 号球与其它球配对，确保每个箱子中 $1$ 号球的数量超过其它球。
2. **隔板法**：使用隔板法计算剩余球的分配方案，确保每个箱子中至少有一个 $1$ 号球。
3. **组合数计算**：通过预处理阶乘和逆元，快速计算组合数。

### 可拓展之处

类似的问题可以扩展到其他类型的球或箱子，或者改变球的数量和箱子的数量。还可以考虑不同的约束条件，如每个箱子中球的数量必须相等或不等。

### 推荐题目

1. [P3807 【模板】卢卡斯定理](https://www.luogu.com.cn/problem/P3807)
2. [P1494 【模板】组合数](https://www.luogu.com.cn/problem/P1494)
3. [P2822 【模板】组合数问题](https://www.luogu.com.cn/problem/P2822)

---
处理用时：42.86秒
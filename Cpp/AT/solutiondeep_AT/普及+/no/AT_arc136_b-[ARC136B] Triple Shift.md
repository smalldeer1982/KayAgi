# 题目信息

# [ARC136B] Triple Shift

## 题目描述

[problemUrl]: https://atcoder.jp/contests/arc136/tasks/arc136_b

長さ $ N $ の整数列 $ A=(A_1,A_2,\cdots,A_N) $ および $ B=(B_1,B_2,\cdots,B_N) $ が与えられます．

あなたは，以下の操作を好きな回数繰り返すことができます．

- 整数 $ i $ ($ 1\ \leq\ i\ \leq\ N-2 $) を選び，現在の $ A_i,A_{i+1},A_{i+2} $ の値をそれぞれ $ x,y,z $ とする． そして，$ A_i,A_{i+1},A_{i+2} $ の値をそれぞれ $ z,x,y $ で置き換える．

$ A $ を $ B $ に一致させることができるかどうか判定してください．

## 说明/提示

### 制約

- $ 3\ \leq\ N\ \leq\ 5000 $
- $ 1\ \leq\ A_i,B_i\ \leq\ 5000 $
- 入力される値はすべて整数

### Sample Explanation 1

以下のように操作すればよいです． - 最初，$ A=(3,1,4,5) $ である． - $ i=1 $ で操作を行う．$ A=(4,3,1,5) $ となる． - $ i=2 $ で操作を行う．$ A=(4,5,3,1) $ となる． - $ i=2 $ で操作を行う．$ A=(4,1,5,3) $ となる．

## 样例 #1

### 输入

```
4

3 1 4 5

4 1 5 3```

### 输出

```
Yes```

## 样例 #2

### 输入

```
3

1 2 2

2 1 2```

### 输出

```
Yes```

## 样例 #3

### 输入

```
3

1 2 3

2 3 4```

### 输出

```
No```

# AI分析结果

### 题目内容重写

**题目描述**

给定长度为 $N$ 的两个整数序列 $A=(A_1,A_2,\cdots,A_N)$ 和 $B=(B_1,B_2,\cdots,B_N)$。

你可以进行以下操作任意次：

- 选择一个整数 $i$ ($1 \leq i \leq N-2$)，将当前的 $A_i,A_{i+1},A_{i+2}$ 的值分别设为 $x,y,z$，然后将 $A_i,A_{i+1},A_{i+2}$ 的值分别替换为 $z,x,y$。

问是否可以通过若干次操作将 $A$ 变为 $B$。

**说明/提示**

- $3 \leq N \leq 5000$
- $1 \leq A_i,B_i \leq 5000$
- 输入的所有值均为整数

**样例解释**

样例1：

输入：
```
4
3 1 4 5
4 1 5 3
```
输出：
```
Yes
```

解释：
- 初始时，$A=(3,1,4,5)$。
- 选择 $i=1$ 进行操作，$A$ 变为 $(4,3,1,5)$。
- 选择 $i=2$ 进行操作，$A$ 变为 $(4,5,3,1)$。
- 选择 $i=2$ 进行操作，$A$ 变为 $(4,1,5,3)$。

### 算法分类
**构造**

### 题解分析与结论

该题的核心在于通过操作改变数组 $A$ 的顺序，使其与数组 $B$ 相同。题解主要围绕逆序对的奇偶性和数组中是否有重复元素展开。

1. **逆序对奇偶性**：操作不会改变逆序对的奇偶性，因此若 $A$ 和 $B$ 的逆序对奇偶性相同，则可以通过操作将 $A$ 变为 $B$。
2. **重复元素**：若 $A$ 或 $B$ 中有重复元素，则可以通过交换重复元素的位置来调整逆序对的奇偶性，从而使得 $A$ 可以变为 $B$。

### 高星题解

#### 题解1：ShenTianYi_ (5星)
**关键亮点**：
- 详细分析了操作对逆序对的影响，证明了逆序对奇偶性不变的必要性和充分性。
- 通过构造性证明，展示了如何通过操作将 $A$ 变为 $B$。
- 代码简洁明了，直接判断逆序对奇偶性和是否有重复元素。

**代码核心实现**：
```cpp
for(int i=1;i<=n;i++){
    cin>>a[i];
    ta[a[i]]++;		//建桶储存a,b内元素出现次数
}
for(int i=1;i<=n;i++){
    cin>>b[i];
    tb[b[i]]++;
}
for(int i=1;i<=5000;i++){	//若a,b内元素不同直接输出No
    if(ta[i]!=tb[i]){
        cout<<"No"<<endl;
        return 0;
    }
}
for(int i=1;i<=5000;i++){	//若有重复元素直接输出Yes
    if(tb[i]>1){
        cout<<"Yes"<<endl;
        return 0;
    }
}
for(int i=1;i<n;i++){		//数据小，O(n^2)暴力求逆序对数
    for(int j=i+1;j<=n;j++){
        sa+=int(a[i]>a[j]);
        sb+=int(b[i]>b[j]);
    }
}
cout<<((sa%2==sb%2)?"Yes":"No")<<endl;
```

#### 题解2：DDF_ (4星)
**关键亮点**：
- 通过冒泡排序的思路，分析了操作对逆序对的影响。
- 提出了通过交换重复元素来调整逆序对奇偶性的方法。
- 代码使用了归并排序来计算逆序对，时间复杂度更低。

**代码核心实现**：
```cpp
void mergesort(int l,int r) {
    if(l==r) return;
    int mid=(l+r)/2;
    mergesort(l,mid),mergesort(mid+1,r);
    int i=l,j=mid+1,k=l;
    while(i<=mid&&j<=r) {
        if(s[i]<=s[j]) f[k++]=s[i++];
        else f[k++]=s[j++],ans+=mid-i+1;
    }
    while(i<=mid) f[k++]=s[i++];
    while(j<=r) f[k++]=s[j++];
    for(int i=l;i<=r;i++) s[i]=f[i];
    return;
}
```

### 最优关键思路
1. **逆序对奇偶性**：通过分析操作对逆序对的影响，得出逆序对奇偶性不变的结论，从而判断是否可以通过操作将 $A$ 变为 $B$。
2. **重复元素处理**：若数组中有重复元素，则可以通过交换重复元素的位置来调整逆序对的奇偶性，确保 $A$ 可以变为 $B$。

### 拓展思路
类似的问题可以通过分析操作对数组顺序的影响，结合逆序对的性质来判断是否可以通过操作达到目标状态。例如，某些排序问题或排列组合问题中，逆序对的奇偶性也是一个重要的判断依据。

### 推荐题目
1. [P1908 逆序对](https://www.luogu.com.cn/problem/P1908)
2. [P1966 火柴排队](https://www.luogu.com.cn/problem/P1966)
3. [P1972 [SDOI2009]HH的项链](https://www.luogu.com.cn/problem/P1972)

### 个人心得
在解决此类问题时，深入理解操作对数组顺序的影响是关键。通过分析逆序对的性质，可以简化问题并找到有效的解决方案。此外，代码实现时要注意时间复杂度的优化，避免不必要的计算。

---
处理用时：41.55秒
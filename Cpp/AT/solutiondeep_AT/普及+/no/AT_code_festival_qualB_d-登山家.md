# 题目信息

# 登山家

## 题目描述

高桥君是登山家，现在正在登山。

这个山脉上N个山中小屋向东西一条直线排列着，

各山小屋从西向东依次排列着，以1到N的号码排序。

第i的山中小屋建于海拔hi。

高桥君很在意从各小屋能看到几间山中小屋?

从第i个山中小屋可以看到第j个（山中小屋）的条件是，

##### 第j（山中小屋）的海拔全部为hi下（hj≤hi）。

求在各山中小屋可以看到的山中小屋的个数。

另外，从第i的山中小屋可以看到的山中小屋不包括第i个山中小屋。

## 样例 #1

### 输入

```
3

1

2

3```

### 输出

```
0

1

2```

## 样例 #2

### 输入

```
5

1

2

3

2

1```

### 输出

```
0

1

4

1

0```

## 样例 #3

### 输入

```
5

3

2

1

2

3```

### 输出

```
4

2

0

2

4```

## 样例 #4

### 输入

```
8

4

3

2

3

4

3

2

1```

### 输出

```
7

2

0

2

7

2

1

0```

# AI分析结果

### 题目内容重写
高桥君是登山家，现在正在登山。这个山脉上有N个山中小屋，它们沿着东西方向一条直线排列，从西向东依次编号为1到N。第i个山中小屋的海拔为hi。高桥君想知道从每个小屋能看到多少间山中小屋。从第i个山中小屋可以看到第j个山中小屋的条件是，第j个山中小屋的海拔不高于第i个山中小屋的海拔（即hj ≤ hi）。注意，从第i个山中小屋可以看到的山中小屋不包括第i个山中小屋本身。

### 算法分类
单调栈

### 题解分析与结论
题目要求从每个山中小屋出发，计算其左右两侧海拔不高于它的连续山中小屋的数量。这个问题可以通过单调栈来高效解决，单调栈能够帮助我们快速找到每个位置左右两侧第一个比它高的位置，从而计算出可见的山中小屋数量。

### 所选题解
#### 1. 作者：Reserved_ (赞：1)
- **星级**: 4
- **关键亮点**: 使用了单调栈来优化时间复杂度，代码清晰易懂，思路明确。
- **核心代码**:
  ```cpp
  for(int i=1; i<=n; i++) {
      while(top&&a[st[top]]<=a[i]) top--;
      l[i]=st[top];
      st[++top]=i;
  }
  top=0;
  st[0]=n+1;
  for(int i=n; i>=1; i--) {
      while(top&&a[st[top]]<=a[i]) top--;
      r[i]=st[top];
      st[++top]=i;
  }
  for(int i=1; i<=n; i++) {
      printf("%d\n",r[i]-l[i]-2);
  }
  ```
- **核心思想**: 通过单调栈分别计算每个位置左右两侧第一个比它高的位置，然后通过这两个位置的差值减去2得到可见的山中小屋数量。

#### 2. 作者：Heldivis (赞：0)
- **星级**: 4
- **关键亮点**: 详细解释了单调栈的工作原理，代码简洁，逻辑清晰。
- **核心代码**:
  ```cpp
  for (int i = 1; i <= n; ++i) {
    while (s.size() && a[s.back()] <= a[i]) s.pop_back();
    if (s.size()) l[i] = s.back();
    else          l[i] = 0;
    s.push_back(i);
  }
  ```
- **核心思想**: 使用单调栈从左到右和从右到左分别计算每个位置左右两侧第一个比它高的位置，然后通过这两个位置的差值减去2得到可见的山中小屋数量。

### 最优关键思路或技巧
- **单调栈**: 通过维护一个单调递减的栈，可以快速找到每个位置左右两侧第一个比它高的位置，从而高效地解决问题。
- **时间复杂度优化**: 使用单调栈将时间复杂度从O(n^2)优化到O(n)，适合处理大规模数据。

### 可拓展之处
- **类似问题**: 可以使用单调栈解决类似的问题，如计算每个元素左右两侧第一个比它大或小的元素的位置。
- **应用场景**: 单调栈广泛应用于需要快速查找某个元素左右两侧第一个满足某种条件的元素的问题，如最大矩形面积、接雨水等问题。

### 推荐题目
1. [P1901 接雨水](https://www.luogu.com.cn/problem/P1901)
2. [P2559 最大矩形面积](https://www.luogu.com.cn/problem/P2559)
3. [P1449 滑动窗口的最大值](https://www.luogu.com.cn/problem/P1449)

---
处理用时：24.52秒
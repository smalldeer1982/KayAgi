# 题目信息

# Strawberry Cakes

## 题目描述

[problemUrl]: https://atcoder.jp/contests/ddcc2020-qual/tasks/ddcc2020_qual_c

chokudai さんは，DDCC 2020 本戦で参加者に配る長方形のケーキを用意しました．

このケーキは，$ H\ -\ 1 $ 本の横方向の切れ目と $ W\ -\ 1 $ 本の縦方向の切れ目により，$ H\ \times\ W $ 個の区画に等分されています．これらの区画のうち $ K $ 個には，それぞれイチゴが $ 1 $ 個乗っています．

イチゴの位置は，$ H\ \times\ W $ 個の文字 $ s_{i,\ j} $ $ (1\ \leq\ i\ \leq\ H,\ 1\ \leq\ j\ \leq\ W) $ によって与えられます．$ s_{i,\ j} $ が `#` のとき，上から $ i $ 行目，左から $ j $ 列目の区画にイチゴが乗っており，$ s_{i,\ j} $ が `.` のとき乗っていません．`#` はちょうど $ K $ 個出現します．

さて，chokudai さんはこのケーキを切れ目に沿って $ K $ 個のピースに切り分け，参加者に配布したいです．ただし，すべてのピースは以下の条件を満たさなければなりません．

- 形状は長方形である．
- ちょうど $ 1 $ 個のイチゴを含む．

例えば，次のような例が考えられます．

![ ](https://cdn.luogu.com.cn/upload/vjudge_pic/AT_ddcc2020_qual_c/cc1d9c887e66319321dc6aab838f872b37b7268e.png)

条件を満たすケーキの切り分け方を $ 1 $ つ求めてください．このような切り分け方は，イチゴの個数や位置にかかわらず必ず存在することが示せます．

## 说明/提示

### 制約

- $ 1\ \leq\ H\ \leq\ 300 $
- $ 1\ \leq\ W\ \leq\ 300 $
- $ 1\ \leq\ K\ \leq\ H\ \times\ W $
- $ s_{i,\ j} $ は `#` または `.`
- `#` は $ s $ にちょうど $ K $ 個出現する

### Sample Explanation 1

例えば，下の図の方法で切り分けることができます． !\[ \](https://img.atcoder.jp/ddcc2020-qual/d09e88243931000a04e555892fe7e6c9.png)

### Sample Explanation 2

例えば，下の図の方法で切り分けることができます． !\[ \](https://img.atcoder.jp/ddcc2020-qual/18d0f45847f5d107ac0322aecea39835.png)

## 样例 #1

### 输入

```
3 3 5

#.#

.#.

#.#```

### 输出

```
1 2 2

1 3 4

5 5 4```

## 样例 #2

### 输入

```
3 7 7

#...#.#

..#...#

.#..#..```

### 输出

```
1 1 2 2 3 4 4

6 6 2 2 3 5 5

6 6 7 7 7 7 7```

## 样例 #3

### 输入

```
13 21 106

.....................

.####.####.####.####.

..#.#..#.#.#....#....

..#.#..#.#.#....#....

..#.#..#.#.#....#....

.####.####.####.####.

.....................

.####.####.####.####.

....#.#..#....#.#..#.

.####.#..#.####.#..#.

.#....#..#.#....#..#.

.####.####.####.####.

.....................```

### 输出

```
12 12 23 34 45 45 60 71 82 93 93 2 13 24 35 35 17 28 39 50 50

12 12 23 34 45 45 60 71 82 93 93 2 13 24 35 35 17 28 39 50 50

12 12 56 89 89 89 60 104 82 31 31 46 13 24 35 35 61 61 39 50 50

12 12 67 67 100 100 60 9 9 42 42 57 13 24 6 72 72 72 72 72 72

12 12 78 5 5 5 20 20 20 53 68 68 90 24 6 83 83 83 83 83 83

16 16 27 38 49 49 64 75 86 97 79 79 90 101 6 94 94 105 10 21 21

16 16 27 38 49 49 64 75 86 97 79 79 90 101 6 94 94 105 10 21 21

32 32 43 54 65 65 80 11 106 95 22 22 33 44 55 55 70 1 96 85 85

32 32 43 54 76 76 91 11 106 84 84 4 99 66 66 66 81 1 96 74 74

14 14 3 98 87 87 102 11 73 73 73 4 99 88 77 77 92 92 63 63 63

25 25 3 98 87 87 7 29 62 62 62 15 99 88 77 77 103 19 30 52 52

36 36 47 58 69 69 18 29 40 51 51 26 37 48 59 59 8 19 30 41 41

36 36 47 58 69 69 18 29 40 51 51 26 37 48 59 59 8 19 30 41 41```

# AI分析结果

### 题目内容重写

#### 题目描述

chokudai さん为DDCC 2020决赛准备了长方形蛋糕，用于分发给参赛者。这个蛋糕通过$H-1$条横向切痕和$W-1$条纵向切痕，被等分为$H \times W$个区域。其中，$K$个区域各有一个草莓。

草莓的位置由$H \times W$个字符$s_{i,j}$（$1 \leq i \leq H, 1 \leq j \leq W$）给出。当$s_{i,j}$为`#`时，表示从上数第$i$行、从左数第$j$列的区域有一个草莓；当$s_{i,j}$为`.`时，表示该区域没有草莓。`#`恰好出现$K$次。

现在，chokudai さん希望沿着切痕将蛋糕分成$K$块，分发给参赛者。每块必须满足以下条件：

- 形状为长方形。
- 恰好包含一个草莓。

例如，下图展示了一种可行的分割方式。

![示例](https://cdn.luogu.com.cn/upload/vjudge_pic/AT_ddcc2020_qual_c/cc1d9c887e66319321dc6aab838f872b37b7268e.png)

请找出一种满足条件的分割方式。可以证明，无论草莓的数量和位置如何，这样的分割方式总是存在的。

### 算法分类
构造

### 题解分析与结论

#### 综合分析
题目要求将$H \times W$的网格分割成$K$个长方形，每个长方形恰好包含一个草莓。题解主要思路是将问题简化为按行或按列分割，然后根据草莓的位置进行标记。

#### 题解评分与亮点
1. **Kazeno_Akina (4星)**
   - **关键亮点**：将问题简化为按行分割，对有草莓的行和无草莓的行分别处理，确保每个长方形包含一个草莓。
   - **代码实现**：通过记录有草莓的行，并对每行进行标记，确保分割后的每个长方形包含一个草莓。
   - **个人心得**：通过简化问题，找到通用解法，避免了复杂的逻辑。

2. **eEfiuys (4星)**
   - **关键亮点**：按行处理，每遇到一个草莓就改变颜色，确保每个长方形包含一个草莓。
   - **代码实现**：通过遍历每行，遇到草莓时改变颜色，确保分割后的每个长方形包含一个草莓。
   - **个人心得**：通过特判处理第一行无草莓的情况，确保算法的通用性。

3. **小小小朋友 (3星)**
   - **关键亮点**：按行分组，每组中只有一行有草莓，然后按列分割。
   - **代码实现**：通过记录每行的草莓数，按行分组后按列分割。
   - **个人心得**：通过分组简化问题，但代码实现较为复杂。

#### 最优关键思路
最优思路是将问题简化为按行分割，对有草莓的行和无草莓的行分别处理。对有草莓的行，按草莓位置进行标记；对无草莓的行，与最近的有草莓行统一标记。这样可以确保每个长方形包含一个草莓。

#### 可拓展之处
类似的分割问题可以扩展到三维空间，或者更复杂的形状分割。可以通过类似的分组和标记方法，确保每个分割区域满足特定条件。

#### 推荐题目
1. [P1880 [NOI1995]石子合并](https://www.luogu.com.cn/problem/P1880)
2. [P1044 栈](https://www.luogu.com.cn/problem/P1044)
3. [P1063 能量项链](https://www.luogu.com.cn/problem/P1063)

### 重点代码片段

#### Kazeno_Akina 的代码片段
```cpp
for(int i=0,j;i<row.size()-1;++i){ //对每一个有标记的行分开处理
    ++tot;
    for(j=1;j<=w;++j){
        ans[row[i]][j]=tot;
        if(mp[row[i]][j]) break;
    }
    if(j==w) continue;
    for(++j;j<=w;++j){
        if(mp[row[i]][j]) ++tot;
        ans[row[i]][j]=tot;
    }
}
for(int i=1;i<row[0];++i) for(int j=1;j<=w;++j) ans[i][j]=ans[row[0]][j];
for(int i=0;i<row.size()-1;++i) for(int i1=row[i]+1;i1<row[i+1];++i1) for(int j=1;j<=w;++j) ans[i1][j]=ans[row[i]][j]; //和有标记的行统一涂色方式
```
**核心思想**：对有草莓的行按草莓位置进行标记，对无草莓的行与最近的有草莓行统一标记。

#### eEfiuys 的代码片段
```cpp
for(int i=1;i<=h;i++)
{
    x=0; //当前行还没有处理草莓。
    if(i==1&&!t[i]) //特判。
    {
        for(int j=2;j<=h;j++)
            if(t[j]) //第1个有草莓的行。
            {
                num++; //首先改变颜色。
                for(int p=1;p<=w;p++) //对第j行进行操作1.
                {
                    a[j][p]=num;
                    if(s[j][p])
                    {
                        x++;
                        if(x<t[j]) //后面还有草莓，不判断则最后一个草莓后面的空格都是另一种颜色。
                            num++; //改变颜色。
                    }
                }
                for(int p=1;p<j;p++)
                    for(int q=1;q<=w;q++)
                        a[p][q]=a[j][q]; //颜色与第j行相同。
                i=j; //因为还要i++，所以把i改为j即可。
                break;
            }
    }
    else
        if(!t[i]) //没有草莓。
            for(int j=1;j<=w;j++)
                a[i][j]=a[i-1][j]; //颜色与第j行相同。
        else
        {
            num++; //首先改变颜色。
            for(int j=1;j<=w;j++)
            {
                a[i][j]=num;
                if(s[i][j])
                {
                    x++;
                    if(x<t[i])  //后面还有草莓，不判断则最后一个草莓后面的空格都是另一种颜色。
                        num++;
                }
            }
        }                
}
```
**核心思想**：按行处理，每遇到一个草莓就改变颜色，确保每个长方形包含一个草莓。

---
处理用时：42.01秒
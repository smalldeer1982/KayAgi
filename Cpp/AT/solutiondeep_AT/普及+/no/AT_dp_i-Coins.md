# 题目信息

# Coins

## 题目描述

设 $N$ 是一个正的奇数。

有 $N$ 枚硬币，每枚硬币上标有编号 $1, 2, \ldots, N$。对于每个 $i$ ($1 \leq i \leq N$)，掷硬币 $i$ 时，正面朝上的概率是 $p _ i$，反面朝上的概率是 $1 - p _ i$。

太郎君把这 $N$ 枚硬币全部投掷了一次。请计算正面朝上的硬币数多于反面朝上的硬币数的概率。

## 样例 #1

### 输入

```
3

0.30 0.60 0.80```

### 输出

```
0.612```

## 样例 #2

### 输入

```
1

0.50```

### 输出

```
0.5```

## 样例 #3

### 输入

```
5

0.42 0.01 0.42 0.99 0.42```

### 输出

```
0.3821815872```

# AI分析结果

### 题目内容重写

#### 题目描述

设 $N$ 是一个正的奇数。

有 $N$ 枚硬币，每枚硬币上标有编号 $1, 2, \ldots, N$。对于每个 $i$ ($1 \leq i \leq N$)，掷硬币 $i$ 时，正面朝上的概率是 $p _ i$，反面朝上的概率是 $1 - p _ i$。

太郎君把这 $N$ 枚硬币全部投掷了一次。请计算正面朝上的硬币数多于反面朝上的硬币数的概率。

#### 样例 #1

##### 输入

```
3

0.30 0.60 0.80
```

##### 输出

```
0.612
```

#### 样例 #2

##### 输入

```
1

0.50
```

##### 输出

```
0.5
```

#### 样例 #3

##### 输入

```
5

0.42 0.01 0.42 0.99 0.42
```

##### 输出

```
0.3821815872
```

### 算法分类

动态规划

### 题解分析与结论

本题的核心是通过动态规划计算正面朝上的硬币数多于反面朝上的硬币数的概率。所有题解都采用了动态规划的思路，主要区别在于状态转移的实现方式和优化程度。

#### 题解对比

1. **Haphyxlos 的题解**  
   - **星级**：4  
   - **关键亮点**：使用二维动态规划数组 `f[i][j]` 表示前 `i` 个硬币中有 `j` 个正面朝上的概率，状态转移方程清晰易懂。  
   - **核心代码**：
     ```cpp
     f[i][j] = f[i-1][j-1] * a[i] + f[i-1][j] * (1 - a[i]);
     ```
   - **个人心得**：无。

2. **MattL 的题解**  
   - **星级**：4  
   - **关键亮点**：在二维动态规划的基础上，进一步优化了空间复杂度，使用一维数组 `f[j]` 进行状态转移，减少了内存使用。  
   - **核心代码**：
     ```cpp
     for (int o = i; o >= 1; o--)
         f[o] = f[o] * (1 - a[i]) + f[o - 1] * a[i];
     f[0] = f[0] * (1 - a[i]);
     ```
   - **个人心得**：提到了压维的技巧，并强调了逆推的重要性。

3. **CrTsIr400 的题解**  
   - **星级**：3  
   - **关键亮点**：提出了使用分治 FFT 优化动态规划的思路，时间复杂度为 $O(n\log^2 n)$，但实现较为复杂，代码可读性较差。  
   - **核心代码**：略。  
   - **个人心得**：无。

#### 最优关键思路

- **状态定义**：`f[i][j]` 表示前 `i` 个硬币中有 `j` 个正面朝上的概率。
- **状态转移**：`f[i][j] = f[i-1][j-1] * p[i] + f[i-1][j] * (1 - p[i])`。
- **优化**：使用一维数组进行状态转移，减少空间复杂度。

#### 可拓展之处

- 类似的问题可以扩展到多个状态的概率计算，如计算正面朝上的硬币数等于某个特定值的概率。
- 动态规划的优化技巧（如压维）可以应用于其他类似的概率计算问题。

#### 推荐题目

1. [P1049 装箱问题](https://www.luogu.com.cn/problem/P1049)  
2. [P1064 金明的预算方案](https://www.luogu.com.cn/problem/P1064)  
3. [P1156 垃圾陷阱](https://www.luogu.com.cn/problem/P1156)  

#### 个人心得总结

- **调试经历**：MattL 提到了在压维过程中遇到的逆推问题，强调了逆推的重要性。
- **踩坑教训**：初始化 `f[0][0] = 1` 是动态规划的关键，容易被忽略。
- **顿悟感想**：动态规划的优化不仅仅是时间复杂度的优化，空间复杂度的优化同样重要。

---
处理用时：27.33秒
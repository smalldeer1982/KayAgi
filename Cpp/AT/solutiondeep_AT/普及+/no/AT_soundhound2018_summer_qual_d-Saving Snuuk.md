# 题目信息

# Saving Snuuk

## 题目描述

[problemUrl]: https://atcoder.jp/contests/soundhound2018-summer-qual/tasks/soundhound2018_summer_qual_d

kenkoooo さんはすぬけ国での旅行の計画を立てています。 すぬけ国には $ n $ 個の都市があり、$ m $ 本の電車が走っています。 都市には $ 1 $ から $ n $ の番号がつけられていて、 $ i $ 番目の電車は都市 $ u_i $ と $ v_i $ の間を両方向に走っています。 どの都市からどの都市へも電車を乗り継ぐことで到達できます。

すぬけ国で使える通貨には、円とスヌークの $ 2 $ 種類があります。 どの電車の運賃も円とスヌークのどちらの通貨でも支払え、 $ i $ 番目の電車の運賃は、 円で支払う場合 $ a_i $ 円、 スヌークで払う場合 $ b_i $ スヌークです。

両替所のある都市に行くと、$ 1 $ 円を $ 1 $ スヌークに両替することができます。 ただし、 両替をするときには持っている円すべてをスヌークに両替しなければなりません。 つまり、kenkoooo さんの所持金が $ X $ 円であるときに両替をすると、 kenkoooo さんの所持金は $ X $ スヌークになります。 現在、両替所は $ n $ 個の都市すべてに存在しますが、 $ i $ 番目の都市の両替所は今年から $ i $ 年後に閉鎖されてしまい、 $ i $ 年後とそれ以降は使うことができません。

kenkoooo さんは $ 10^{15} $ 円を持って都市 $ s $ から旅に出て、 都市 $ t $ へ向かおうと思っています。 移動中、kenkoooo さんは両替所のある都市のいずれかで円をスヌークに両替しようと考えています。 ただし、都市 $ s $ または都市 $ t $ の両替所で両替をしてもよいものとします。

kenkoooo さんは移動の経路と両替をする都市を適切に選ぶことで、できるだけ多くのスヌークを持っている状態で 都市 $ t $ に辿り着きたいと考えています。 $ i=0,...,n-1 $ のそれぞれについて、$ i $ 年後に都市 $ s $ から都市 $ t $ へ移動した際に kenkoooo さんが所持しているスヌークの最大額を求めてください。 ただし、旅行中に年をまたぐことは無いとします。

## 说明/提示

### 制約

- $ 2\ \leq\ n\ \leq\ 10^5 $
- $ 1\ \leq\ m\ \leq\ 10^5 $
- $ 1\ \leq\ s,t\ \leq\ n $
- $ s\ \neq\ t $
- $ 1\ \leq\ u_i\ <\ v_i\ \leq\ n $
- $ 1\ \leq\ a_i,b_i\ \leq\ 10^9 $
- $ i\neq\ j $ のとき $ u_i\ \neq\ u_j $ または $ v_i\ \neq\ v_j $
- どの都市からどの都市へも電車を乗り継ぐことで到達できる
- 入力はすべて整数

### Sample Explanation 1

$ 0 $ 年後には、都市 $ 1 $ で両替をするのが最適です。 $ 1 $ 年後には、都市 $ 2 $ で両替をするのが最適です。 両替所が閉鎖されても都市 $ 1 $ を訪れることは可能であることに注意してください。 また、都市 $ 2 $ で両替をするときに $ 1 $ 円だけ残して残りをスヌークに両替をすると $ 999999999999998 $ スヌークを持った状態で都市 $ 3 $ にたどり着けますが、 このような両替は許されていないことにも注意してください。 $ 2 $ 年後には、都市 $ 3 $ で両替をするのが最適です。 $ 3 $ 年後には、都市 $ 4 $ で両替をするのが最適です。 同じ電車を複数回使っても良いことに注意してください。

## 样例 #1

### 输入

```
4 3 2 3

1 4 1 100

1 2 1 10

1 3 20 1```

### 输出

```
999999999999998

999999999999989

999999999999979

999999999999897```

## 样例 #2

### 输入

```
8 12 3 8

2 8 685087149 857180777

6 7 298270585 209942236

2 4 346080035 234079976

2 5 131857300 22507157

4 8 30723332 173476334

2 6 480845267 448565596

1 4 181424400 548830121

4 5 57429995 195056405

7 8 160277628 479932440

1 6 475692952 203530153

3 5 336869679 160714712

2 7 389775999 199123879```

### 输出

```
999999574976994

999999574976994

999999574976994

999999574976994

999999574976994

999999574976994

999999574976994

999999574976994```

# AI分析结果

### 题目内容重写

kenkoooo さん计划在すぬけ国旅行。すぬけ国有 $n$ 个城市，$m$ 条双向铁路连接这些城市。每条铁路可以用円或スヌーク支付，费用分别为 $a_i$ 円和 $b_i$ スヌーク。每个城市都有一个兑换所，可以将所有円兑换为スヌーク，但第 $i$ 个城市的兑换所将在 $i$ 年后关闭。kenkoooo さん从城市 $s$ 出发，前往城市 $t$，希望在某个兑换所兑换货币，使得到达 $t$ 时持有的スヌーク最多。对于每个 $i$（$0 \leq i < n$），求 $i$ 年后旅行的最大スヌーク持有量。

### 算法分类
最短路

### 题解分析与结论

#### 题解1：FFTotoro (4星)
- **关键亮点**：通过枚举中转点，分别计算从 $s$ 到中转点的円最短路和从中转点到 $t$ 的スヌーク最短路，最后取最小值。
- **实现思路**：使用 Dijkstra 算法分别从 $s$ 和 $t$ 出发计算最短路，然后枚举中转点，计算最小花费。
- **代码简洁性**：代码结构清晰，使用了优先队列实现 Dijkstra 算法，逻辑明确。

#### 题解2：Crazyouth (3星)
- **关键亮点**：同样通过枚举中转点，分别计算从 $s$ 到中转点的円最短路和从中转点到 $t$ 的スヌーク最短路，最后取最小值。
- **实现思路**：使用 Dijkstra 算法分别从 $s$ 和 $t$ 出发计算最短路，然后枚举中转点，计算最小花费。
- **代码简洁性**：代码较长，结构稍显复杂，但逻辑清晰。

### 最优关键思路或技巧
- **最短路算法**：使用 Dijkstra 算法计算从 $s$ 和 $t$ 出发的最短路，分别表示使用円和スヌーク的最小花费。
- **枚举中转点**：通过枚举中转点，计算从 $s$ 到中转点的円最短路和从中转点到 $t$ 的スヌーク最短路，取最小值作为当前年的最小花费。

### 可拓展之处
- **类似问题**：可以扩展到其他货币兑换问题，或者在有时间限制的情况下进行路径规划。
- **算法优化**：可以考虑使用更高效的最短路算法，如 A* 算法，或者在有特殊限制的情况下进行剪枝。

### 推荐题目
1. [P3371 【模板】单源最短路径（弱化版）](https://www.luogu.com.cn/problem/P3371)
2. [P4779 【模板】单源最短路径（标准版）](https://www.luogu.com.cn/problem/P4779)
3. [P1144 最短路计数](https://www.luogu.com.cn/problem/P1144)

### 重点代码片段
```cpp
void f(int s,bool o,vector<int> &d){
  vector<bool> b(d.size());
  priority_queue<pii,vector<pii>,greater<pii> > q;
  q.emplace(d[s]=0,s);
  while(!q.empty()){
    int u=q.top().second; q.pop();
    if(b[u])continue; b[u]=true;
    for(auto [i,a,b]:g[u])
      if(d[i]>d[u]+(o?a:b))
        q.emplace(d[i]=d[u]+(o?a:b),i);
  }
}
```
- **核心实现思想**：使用 Dijkstra 算法计算从 $s$ 出发的最短路，根据参数 $o$ 决定使用円还是スヌーク作为花费。

---
处理用时：25.41秒
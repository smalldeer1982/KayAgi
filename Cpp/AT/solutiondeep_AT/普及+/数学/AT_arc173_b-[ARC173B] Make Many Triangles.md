# 题目信息

# [ARC173B] Make Many Triangles

## 题目描述

[problemUrl]: https://atcoder.jp/contests/arc173/tasks/arc173_b

二次元平面上に相異なる $ N $ 個の点があります。 $ i $ 番目の点の座標は $ (x_i,y_i) $ です。

これらの点のいずれかを頂点とする（非退化な）三角形をたくさん作りたいです。ただし、同じ点を複数の三角形の頂点として用いることはできません。

最大で何個の三角形が作れるか求めてください。

   非退化な三角形とは 非退化な三角形とは、 $ 3 $ つの頂点が同一直線上に並ばない三角形のことを指します。

## 说明/提示

### 制約

- $ 3\ \leq\ N\ \leq\ 300 $
- $ -10^9\ \leq\ x_i,y_i\ \leq\ 10^9 $
- $ i\ \neq\ j $ ならば $ (x_i,y_i)\ \neq\ (x_j,y_j) $
- 入力される値はすべて整数
 
### Sample Explanation 1

例えば $ 1,3,6 $ 番目の点からなる三角形と $ 2,4,5 $ 番目の点からなる三角形を考えると、三角形を $ 2 $ つ作ることができます。 同じ点を複数の三角形の頂点として用いることはできませんが、三角形が共通部分を持っても構いません。

## 样例 #1

### 输入

```
7

0 0

1 1

0 3

5 2

3 4

2 0

2 2```

### 输出

```
2```

## 样例 #2

### 输入

```
3

0 0

0 1000000000

0 -1000000000```

### 输出

```
0```

# AI分析结果

### 题目内容重写
【题目描述】
在二维平面上有 $N$ 个不同的点，第 $i$ 个点的坐标为 $(x_i, y_i)$。要求用这些点作为顶点组成尽可能多的（非退化）三角形，且每个点只能被一个三角形使用。求最多能组成多少个三角形。

非退化三角形是指三个顶点不共线的三角形。

【输入格式】
第一行输入整数 $N$，表示点的数量。接下来 $N$ 行，每行输入两个整数 $x_i, y_i$，表示第 $i$ 个点的坐标。

【输出格式】
输出一个整数，表示最多能组成的三角形数量。

【样例输入】
```
7
0 0
1 1
0 3
5 2
3 4
2 0
2 2
```

【样例输出】
```
2
```

【样例解释】
例如，用第1、3、6个点组成一个三角形，用第2、4、5个点组成另一个三角形，可以组成2个三角形。同一个点不能被多个三角形使用，但三角形之间可以有重叠部分。

---

### 题解分析与结论

#### 综合分析
本题的核心在于如何最大化非退化三角形的数量，同时避免重复使用点。题解主要分为两类：
1. **贪心+暴力枚举**：通过枚举所有可能的直线，找到共线点最多的直线，然后根据共线点的数量计算最大三角形数量。
2. **随机化算法**：通过随机打乱点的顺序，贪心地选择不共线的三点组成三角形，多次随机取最大值。

#### 最优思路
最优思路是贪心+暴力枚举，具体步骤如下：
1. 枚举所有可能的直线，找到共线点最多的直线，记为 $C$。
2. 如果共线点的数量 $C \geq \frac{2}{3}N$，则最大三角形数量为 $N - C$。
3. 否则，最大三角形数量为 $\lfloor \frac{N}{3} \rfloor$。

这种方法的时间复杂度为 $O(N^3)$，在 $N \leq 300$ 的范围内完全可行。

#### 评分较高的题解
1. **Phartial (5星)**
   - **关键亮点**：提供了严格的数学证明，解释了为什么当共线点数量 $C < \frac{2}{3}N$ 时，最大三角形数量为 $\lfloor \frac{N}{3} \rfloor$。代码简洁，逻辑清晰。
   - **代码核心**：
     ```cpp
     for (int i = 1; i <= n; ++i) {
         for (int j = i + 1; j <= n; ++j) {
             int c = 0;
             for (int k = 1; k <= n; ++k) {
                 c += (y[j] - y[i]) * (x[k] - x[i]) == (y[k] - y[i]) * (x[j] - x[i]);
             }
             ans = max(ans, c);
         }
     }
     cout << min(n / 3, n - ans);
     ```

2. **coderJerry (4星)**
   - **关键亮点**：思路清晰，代码简洁，直接通过枚举所有直线计算共线点数量，并根据条件输出结果。
   - **代码核心**：
     ```cpp
     for (int i = 1; i <= n; ++i) {
         for (int j = i + 1; j <= n; ++j) {
             int cnt = 0;
             for (int k = 1; k <= n; ++k) {
                 int x1 = x[i] - x[j], y1 = y[i] - y[j];
                 int x2 = x[i] - x[k], y2 = y[i] - y[k];
                 if (abs(x1 * y2) == abs(x2 * y1)) cnt++;
             }
             ans = max(ans, cnt);
         }
     }
     cout << min(n / 3, n - ans);
     ```

3. **hinin (4星)**
   - **关键亮点**：通过枚举直线并计算共线点数量，直接输出结果，代码简洁明了。
   - **代码核心**：
     ```cpp
     for (ll i = 1; i < n; i ++) {
         for (ll j = i + 1; j <= n; j ++) {
             ll cnt = 0;
             for (ll k = 1; k <= n; k ++) {
                 if (check(i, j, k) == 0) cnt++;
             }
             Max = max(Max, cnt);
         }
     }
     cout << min(n / 3, n - Max);
     ```

#### 关键实现技巧
- **共线判断**：通过叉积判断三点是否共线，即 $(y_j - y_i) \times (x_k - x_i) == (y_k - y_i) \times (x_j - x_i)$。
- **贪心策略**：优先使用共线点最多的直线，确保最大化三角形数量。

#### 拓展思路
本题的贪心策略可以推广到其他类似的组合优化问题，如最大化四边形、五边形等。随机化算法在时间允许的情况下，可以作为一种有效的近似解法。

#### 推荐题目
1. [P1351 联合权值](https://www.luogu.com.cn/problem/P1351)
2. [P1364 医院设置](https://www.luogu.com.cn/problem/P1364)
3. [P1379 八数码难题](https://www.luogu.com.cn/problem/P1379)

#### 个人心得摘录
- **Phartial**：通过数学归纳法证明了当 $C < \frac{2}{3}N$ 时，最大三角形数量为 $\lfloor \frac{N}{3} \rfloor$，这一结论为贪心策略提供了理论支持。
- **coderJerry**：强调了共线判断中乘法可能爆 `int`，提醒了代码实现中的细节问题。

---
处理用时：46.21秒
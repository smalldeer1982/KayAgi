# 题目信息

# [ARC174D] Digit vs Square Root

## 题目描述

[problemUrl]: https://atcoder.jp/contests/arc174/tasks/arc174_d

$ T $ 個のテストケースについて、以下の問題に答えてください。

整数 $ N $ が与えられるので、以下の条件を全て満たす整数 $ x $ の個数を求めてください。

- $ 1\ \le\ x\ \le\ N $
- $ y\ =\ \lfloor\ \sqrt{x}\ \rfloor $ とする。このとき、 $ x,y $ 双方を (先頭に $ 0 $ を含まずに) 十進法で書き下した場合、 $ y $ が $ x $ の接頭辞になる。

## 说明/提示

### 制約

- $ T $ は $ 1\ \le\ T\ \le\ 10^5 $ を満たす整数
- $ N $ は $ 1\ \le\ N\ \le\ 10^{18} $ を満たす整数
 
### Sample Explanation 1

この入力には、 $ 2 $ 個のテストケースが含まれます。 - $ 1 $ つ目のテストケースについて、 $ x=1 $ は $ y\ =\ \lfloor\ \sqrt{1}\ \rfloor\ =\ 1 $ となり問題文中の条件を満たします。 - $ 2 $ つ目のテストケースについて、例えば $ x=100 $ は $ y\ =\ \lfloor\ \sqrt{100}\ \rfloor\ =\ 10 $ となり問題文中の条件を満たします。

## 样例 #1

### 输入

```
2

1

174```

### 输出

```
1

22```

# AI分析结果

### 题目内容重写

给定 $T$ 个测试用例，每个测试用例给出一个整数 $N$，要求找出满足以下条件的整数 $x$ 的个数：

1. $1 \leq x \leq N$
2. 设 $y = \lfloor \sqrt{x} \rfloor$，则 $y$ 是 $x$ 的十进制表示的前缀（即 $y$ 是 $x$ 的前几位数字，且 $x$ 和 $y$ 的十进制表示不包含前导零）。

### 样例输入
```
2
1
174
```

### 样例输出
```
1
22
```

### 题解分析与结论

#### 综合分析
本题的核心在于找到满足 $y = \lfloor \sqrt{x} \rfloor$ 且 $y$ 是 $x$ 的前缀的 $x$。通过打表观察，可以发现满足条件的 $x$ 主要集中在以下区间：
1. $x = 10^{2k} - 2 \times 10^k$（如 $998000$）
2. $x \in [10^{2k} - 10^k, 10^{2k} + 10^k - 1]$（如 $999000$ 到 $1000999$）

这些区间的 $x$ 满足 $\lfloor \sqrt{x} \rfloor$ 是 $x$ 的前缀。通过枚举 $k$ 并计算这些区间与 $[1, N]$ 的交集，可以高效地求出满足条件的 $x$ 的个数。

#### 最优关键思路
1. **打表观察**：通过打表发现满足条件的 $x$ 主要集中在特定的区间，这些区间与 $10^{2k}$ 相关。
2. **区间枚举**：枚举 $k$，计算满足条件的区间 $[10^{2k} - 10^k, 10^{2k} + 10^k - 1]$ 和 $x = 10^{2k} - 2 \times 10^k$，并与 $[1, N]$ 求交集。
3. **时间复杂度优化**：通过枚举 $k$，时间复杂度为 $O(T \log N)$，能够处理 $T \leq 10^5$ 和 $N \leq 10^{18}$ 的输入。

### 高星题解推荐

#### 题解1：作者：wosile (赞：6)
**星级：★★★★★**
**关键亮点**：
- 通过打表发现满足条件的 $x$ 主要集中在 $x = 10^{2k} - 2 \times 10^k$ 和 $x \in [10^{2k} - 10^k, 10^{2k} + 10^k - 1]$。
- 代码简洁高效，直接枚举 $k$ 并计算区间交，时间复杂度为 $O(T \log N)$。

**核心代码**：
```cpp
ll ans = 1;
for (ll b = 10; b <= 1000000000; b *= 10) {
    ll B = b * b;
    if (n >= B - b - b) ans++;
    if (n >= B - b) ans += min(B + b - 1, n) - B + b + 1;
}
```

#### 题解2：作者：Starrykiller (赞：0)
**星级：★★★★☆**
**关键亮点**：
- 详细证明了满足条件的 $x$ 的区间性质，提供了数学上的严谨性。
- 通过枚举 $k$ 并计算区间交，时间复杂度为 $O(T \log N)$。

**核心代码**：
```cpp
int ans = sum[res - 1];
if (res % 2 == 0) {
    if (n >= mi[res] - 2 * mi[res / 2]) ans++;
    if (n >= mi[res] - mi[res / 2]) ans += n - (mi[res] - mi[res / 2]) + 1;
} else {
    ans += min(n, mi[res - 1] + mi[res / 2] - 1) - mi[res - 1] + 1;
}
```

#### 题解3：作者：Sorato_ (赞：0)
**星级：★★★★☆**
**关键亮点**：
- 通过打表发现满足条件的 $x$ 的区间规律，并详细解释了这些区间的性质。
- 代码实现清晰，通过枚举 $k$ 并计算区间交，时间复杂度为 $O(T \log N)$。

**核心代码**：
```cpp
int ans = sum[res - 1];
if (res % 2 == 0) {
    if (n >= mi[res] - 2 * mi[res / 2]) ans++;
    if (n >= mi[res] - mi[res / 2]) ans += n - (mi[res] - mi[res / 2]) + 1;
} else {
    ans += min(n, mi[res - 1] + mi[res / 2] - 1) - mi[res - 1] + 1;
}
```

### 拓展思路
本题的打表观察和区间枚举方法可以推广到类似的数位相关题目中，尤其是涉及到前缀匹配或数位性质的问题。通过观察规律并利用数学性质，可以高效地解决这类问题。

### 推荐题目
1. [P1214 [USACO1.4] 等差数列 Arithmetic Progressions](https://www.luogu.com.cn/problem/P1214)
2. [P1217 [USACO1.5] 回文质数 Prime Palindromes](https://www.luogu.com.cn/problem/P1217)
3. [P1218 [USACO1.5] 特殊的质数肋骨 Superprime Rib](https://www.luogu.com.cn/problem/P1218)

这些题目都涉及到数位性质和数学规律的观察，适合进一步练习和巩固相关技巧。

---
处理用时：50.84秒
# 题目信息

# [AGC035B] Even Degrees

## 题目描述

[problemUrl]: https://atcoder.jp/contests/agc035/tasks/agc035_b

$ N $ 頂点 $ M $ 辺の単純連結無向グラフが与えられます。頂点には $ 1 $ から $ N $ までの番号がついており、$ i $ 本目の辺は頂点 $ A_i $ と頂点 $ B_i $ を結んでいます。 高橋君は、与えられたグラフのすべての辺にどちらかの向きをつけて有向グラフを作ります。 どの頂点から出る辺の本数も偶数になるような有向グラフを作ることが可能かどうか判定し、可能ならそのような例をひとつ構成してください。

## 说明/提示

### ノート

無向グラフが単純であるとは、自己ループと多重辺を含まないことを指します。

### 制約

- $ 2\ \leq\ N\ \leq\ 10^5 $
- $ N-1\ \leq\ M\ \leq\ 10^5 $
- $ 1\ \leq\ A_i,B_i\ \leq\ N\ (1\leq\ i\leq\ M) $
- 与えられるグラフは単純かつ連結

### Sample Explanation 1

このように向き付けることで、頂点 $ 1,3 $ からは $ 2 $ 本、頂点 $ 2,4 $ からは $ 0 $ 本の辺が出るようになります。

## 样例 #1

### 输入

```
4 4

1 2

2 3

3 4

4 1```

### 输出

```
1 2

1 4

3 2

3 4```

## 样例 #2

### 输入

```
5 5

1 2

2 3

3 4

2 5

4 5```

### 输出

```
-1```

# AI分析结果

### 题目翻译
#### [AGC035B] 偶数度数

#### 题目描述
[problemUrl]: https://atcoder.jp/contests/agc035/tasks/agc035_b

给定一个有 $N$ 个顶点和 $M$ 条边的简单连通无向图。顶点的编号从 $1$ 到 $N$，第 $i$ 条边连接顶点 $A_i$ 和顶点 $B_i$。高桥君会给给定图中的所有边指定一个方向，从而得到一个有向图。请判断是否可以构造出一个每个顶点的出边数量都是偶数的有向图，如果可以，请给出一个这样的例子。

#### 说明/提示
##### 注意
无向图是简单图意味着它不包含自环和重边。

##### 限制条件
- $ 2\ \leq\ N\ \leq\ 10^5 $
- $ N - 1\ \leq\ M\ \leq\ 10^5 $
- $ 1\ \leq\ A_i, B_i\ \leq\ N\ (1 \leq i \leq M) $
- 给定的图是简单且连通的

##### 样例解释 1
通过这样指定方向，顶点 $1$ 和 $3$ 各有 $2$ 条出边，顶点 $2$ 和 $4$ 各有 $0$ 条出边。

#### 样例 #1
##### 输入
```
4 4
1 2
2 3
3 4
4 1
```
##### 输出
```
1 2
1 4
3 2
3 4
```

#### 样例 #2
##### 输入
```
5 5
1 2
2 3
3 4
2 5
4 5
```
##### 输出
```
-1
```

### 综合分析与结论
这些题解的核心思路都是先判断边数的奇偶性，若边数为奇数则直接判定无解。对于边数为偶数的情况，不同题解采用了不同的方法来构造满足条件的有向图。

- **ForgotMe 的题解**：先通过 DFS 找出原图的一棵生成树，对非树边随意定向，然后递归处理生成树上的边，根据节点度数的奇偶性调整边的方向，最终保证除根节点外的节点度数为偶数，由于总度数为偶数，根节点度数也为偶数。
- **Azazеl 的题解**：先按输入方向将图转化为有向图，提取出度为奇数的点，通过改变边的方向来调整节点的出度奇偶性，利用树上差分优化操作，对于树边根据操作次数判断方向，非树边按原序输出。
- **听取 MLE 声一片的题解**：先考虑树的情况，从根节点向下处理，根据儿子节点出度的奇偶性连边，再推广到图，找出一棵生成树，将其他边随意连接后按树的方法处理。
- **251Sec 的题解**：先随意给边定向，将出度为偶数的点称为白点，出度为奇数的点称为黑点，通过翻转路径来改变黑点的颜色，利用树上差分实现，若黑点有奇数个则无解，偶数个则一定有解。

### 所选题解
- **ForgotMe 的题解（4星）**：
    - **关键亮点**：思路清晰，代码实现简洁，通过递归处理生成树的边，利用总度数的奇偶性保证根节点的度数为偶数，时间复杂度为 $\mathcal{O}(n)$。
    - **核心代码**：
```cpp
void dfs(int u,int fa){
    dep[u]=dep[fa]+1;
    f[u]=fa;
    vis[u]=1;
    for(int i=0;i<G[u].size();i++){
        int to=G[u][i].to;
        if(vis[to])continue;
        g[u].push_back(to);
        used[G[u][i].id]=1;
        dfs(to,u);
    }
}
void solve(int u){
    for(int i=0;i<g[u].size();i++){
        int v=g[u][i];
        solve(v);
    }
    if(u!=1){
        if(du[u]%2==1)printf("%d %d\n",u,f[u]);
        else printf("%d %d\n",f[u],u),du[f[u]]++;
    } 
}
```
核心实现思想：`dfs` 函数用于找出原图的一棵生成树，标记树边；`solve` 函数递归处理生成树上的边，根据节点度数的奇偶性调整边的方向。

### 最优关键思路或技巧
- 先判断边数的奇偶性，若为奇数则直接判定无解，这是一个重要的剪枝操作。
- 利用生成树将图的问题转化为树的问题，简化问题的处理。
- 通过递归或树上差分的方法处理节点的度数，保证每个节点的出度为偶数。

### 可拓展之处
同类型题可能会改变图的性质（如非连通图、带权图等）或增加其他限制条件，类似的算法套路包括利用图的连通性、树的性质、节点度数的奇偶性等进行问题的分析和解决。

### 推荐洛谷题目
- [P1192 台阶问题](https://www.luogu.com.cn/problem/P1192)：考察递推和动态规划，与本题的递归思想有一定的相似性。
- [P1330 封锁阳光大学](https://www.luogu.com.cn/problem/P1330)：考察图的染色和连通性，与本题对图的处理有一定的关联。
- [P1135 奇怪的电梯](https://www.luogu.com.cn/problem/P1135)：考察图的搜索和路径规划，与本题的图的遍历有一定的相似性。

### 个人心得
题解中未包含个人心得内容。

---
处理用时：36.19秒
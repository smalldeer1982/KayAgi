# 题目信息

# [AGC044A] Pay to Win

## 题目描述

# [AGC044A] Pay to Win


你有一个数字$0$ ，你希望得到数字$N$。

你可以通过以下操作更改数字，需要支付一定数量的硬币：

- 将当前数乘$2$，需要$A$硬币。
- 将当前数乘$3$，需要$B$硬币。
- 将当前数乘$5$，需要$C$硬币。
- 将当前数加$1$或减$1$，需要$D$硬币。

你可以按任意顺序和任意次数执行这些操作。

最少需要多少硬币才能得到$N$？

你需要解决$T$组测试用例。

## 说明/提示

### 约束

- $ 1\ \le\ T\ \le\ 10 $
- $ 1\ \le\ N\ \le\ 10^{18} $
- $ 1\ \le\ A,\ B,\ C,\ D\ \le\ 10^9 $
- $ N,\ A,\ B,\ C,\ D $ 都是整数。

### Sample Explanation 1

对于第一个测试用例，达到最低成本$20$的一系列操作是：

- 初始 $x = 0$.
- 用$8$个硬币使其加$1(x = 1)$
- 用$1$个硬币使其乘$2(x = 2)$
- 用$1$个硬币使其乘$2(x = 4)$
- 用$2$个硬币使其乘$3(x = 12)$
- 用$8$个硬币使其减$1(x = 11)$

对于第二个测试用例，达到最低成本$19$的一系列操作是：

- 初始 $x = 0$.
- 用$8$个硬币使其加$1(x = 1)$
- 用$1$个硬币使其乘$2(x = 2)$
- 用$2$个硬币使其乘$5(x = 10)$
- 用$8$个硬币使其减$1(x = 11)$

## 样例 #1

### 输入

```
5

11 1 2 4 8

11 1 2 2 8

32 10 8 5 4

29384293847243 454353412 332423423 934923490 1

900000000000000000 332423423 454353412 934923490 987654321```

### 输出

```
20

19

26

3821859835

23441258666```

# AI分析结果

### 题目内容重写

你有一个数字$0$，你希望得到数字$N$。

你可以通过以下操作更改数字，需要支付一定数量的硬币：

- 将当前数乘$2$，需要$A$硬币。
- 将当前数乘$3$，需要$B$硬币。
- 将当前数乘$5$，需要$C$硬币。
- 将当前数加$1$或减$1$，需要$D$硬币。

你可以按任意顺序和任意次数执行这些操作。

最少需要多少硬币才能得到$N$？

你需要解决$T$组测试用例。

### 说明/提示

#### 约束

- $ 1\ \le\ T\ \le\ 10 $
- $ 1\ \le\ N\ \le\ 10^{18} $
- $ 1\ \le\ A,\ B,\ C,\ D\ \le\ 10^9 $
- $ N,\ A,\ B,\ C,\ D $ 都是整数。

### 样例解释

对于第一个测试用例，达到最低成本$20$的一系列操作是：

- 初始 $x = 0$.
- 用$8$个硬币使其加$1(x = 1)$
- 用$1$个硬币使其乘$2(x = 2)$
- 用$1$个硬币使其乘$2(x = 4)$
- 用$2$个硬币使其乘$3(x = 12)$
- 用$8$个硬币使其减$1(x = 11)$

对于第二个测试用例，达到最低成本$19$的一系列操作是：

- 初始 $x = 0$.
- 用$8$个硬币使其加$1(x = 1)$
- 用$1$个硬币使其乘$2(x = 2)$
- 用$2$个硬币使其乘$5(x = 10)$
- 用$8$个硬币使其减$1(x = 11)$

### 题解分析与结论

#### 综合分析

本题的核心是通过一系列操作将数字从$0$变为$N$，且每次操作需要支付一定的硬币。目标是找到最少的硬币消耗。由于$N$的范围非常大（$10^{18}$），直接暴力搜索是不可行的。因此，大多数题解采用了**记忆化搜索**和**逆向思维**（从$N$向$0$搜索）来优化计算。

#### 关键思路与技巧

1. **逆向思维**：从$N$向$0$搜索，将乘法操作转化为除法操作，减少搜索空间。
2. **记忆化搜索**：使用`map`或`unordered_map`来存储中间结果，避免重复计算。
3. **边界处理**：明确$f(0) = 0$和$f(1) = D$作为递归的终止条件。
4. **优化操作顺序**：优先考虑除法操作，因为除法操作通常比加减操作更节省硬币。

#### 评分较高的题解

1. **作者：suzhikz (赞：5)**  
   - **星级：5星**  
   - **关键亮点**：使用逆向思维和记忆化搜索，代码简洁且高效，处理了大数问题。
   - **核心代码**：
     ```cpp
     if(m[x])return m[x];
     if(x==0)return 0;
     if(x==1)return d;
     ll ans=min((__int128)1e18,(__int128)x*d);
     ll l,r;
     {
         l=x/2*2;
         ans=min(ans,(x-l)*d+a+dfs(l/2));
         r=(x+1)/2*2;
         ans=min(ans,(r-x)*d+a+dfs(r/2));
     }
     ```
   - **个人心得**：作者提到“先加后除一定比先除后加劣”，这一观察大大减少了不必要的计算。

2. **作者：墨笙_Mooos (赞：0)**  
   - **星级：4星**  
   - **关键亮点**：详细解释了逆向思维的操作过程，并提供了时间复杂度分析，代码实现清晰。
   - **核心代码**：
     ```cpp
     inline lll DFS (ll Now)
     {
         if (Now == 0) return 0;
         if (Now == 1) return D;
         auto Node = Res.find (Now);
         if (Node != Res.end ()) return Node->second;
         lll Ans = (lll) Now * D;
         for (ll T : { 2, 3, 5 } ) if (Now % T != 0)
             CkMin (Ans, Cost[T] + D * (T - Now % T) + DFS (Now / T + 1)),
             CkMin (Ans, Cost[T] + D * (Now % T) + DFS (Now / T));
         else CkMin (Ans, Cost[T] + DFS (Now / T));
         return Res[Now] = Ans;
     }
     ```
   - **个人心得**：作者详细分析了每种操作的最优情况，并提供了时间复杂度分析，帮助读者理解算法的可行性。

3. **作者：IkunTeddy (赞：2)**  
   - **星级：4星**  
   - **关键亮点**：代码结构清晰，使用了`map`进行记忆化搜索，处理了大数问题。
   - **核心代码**：
     ```cpp
     int dfs(int n){
         if(mp.count(n))return mp[n];
         int l1=(n/2)*2,r1=((n+1)/2)*2;
         int l2=(n/3)*3,r2=((n+2)/3)*3;
         int l3=(n/5)*5,r3=((n+4)/5)*5;
         int ans=(n<(int)1e18/d)?n*d:(int)1e18;
         ans=min(ans,(n-l1)*d+dfs(l1/2)+a);
         ans=min(ans,(r1-n)*d+dfs(r1/2)+a);
         ans=min(ans,(n-l2)*d+dfs(l2/3)+b);
         ans=min(ans,(r2-n)*d+dfs(r2/3)+b);
         ans=min(ans,(n-l3)*d+dfs(l3/5)+c);
         ans=min(ans,(r3-n)*d+dfs(r3/5)+c);
         return mp[n]=ans;
     }
     ```
   - **个人心得**：作者提到“加一个记忆化就直接跑到飞起”，强调了记忆化搜索的重要性。

### 推荐题目

1. [P1048 采药](https://www.luogu.com.cn/problem/P1048)：经典的动态规划问题，与本题的优化思路类似。
2. [P1219 八皇后](https://www.luogu.com.cn/problem/P1219)：搜索与回溯的经典问题，适合练习记忆化搜索。
3. [P1433 吃奶酪](https://www.luogu.com.cn/problem/P1433)：状态压缩与动态规划的结合，与本题的优化思路有相似之处。

---
处理用时：59.39秒
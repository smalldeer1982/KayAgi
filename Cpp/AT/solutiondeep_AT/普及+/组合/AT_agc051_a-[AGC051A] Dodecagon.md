# 题目信息

# [AGC051A] Dodecagon

## 题目描述

[problemUrl]: https://atcoder.jp/contests/agc051/tasks/agc051_a

すぬけ君は、正方形のタイルと正三角形のタイルを無限枚持っています。タイルの辺の長さは全て $ 1 $ です。 これらを使って、辺の長さが $ d $ の正 $ 12 $ 角形を作る方法は何通りあるでしょうか。 この答えを $ 998,244,353 $ で割った余りを計算してください。

厳密に述べると、

- タイルを使う枚数に制限はありません。
- 使ったタイルのうち、どの $ 2 $ 枚も重なっていてはいけません。
- 使ったタイルが覆う領域の和集合は、穴のない正 $ 12 $ 角形でなければなりません。
- 二つの作り方について、一方に回転と平行移動を施す (鏡映は不可) ことでもう一方を得られる、すなわち一方における各タイルがもう一方における同種のタイルと完全に一致するとき、これらの作り方を同一とみなします。

## 说明/提示

### 制約

- $ 1\ \leq\ d\ \leq\ 10^6 $
- 入力中の全ての値は整数である。

### Sample Explanation 1

唯一の作り方を以下の図に示します。 !\[\](https://img.atcoder.jp/agc051/dad0de5f2e5c47119aa1a0da8ed28808.png)

## 样例 #1

### 输入

```
1```

### 输出

```
1```

# AI分析结果

### 题目翻译
Snuke 有无限个边长为 $1$ 的正方形和正三角形瓷砖。有多少种不同的方法可以用这些瓷砖组成一个边长为 $d$ 的正十二边形？请计算方案数并对 $998244353$ 取模。

具体地说：
- Snuke 可以使用任意数量的瓷砖。
- 方案中没有两块瓷砖是重叠的。
- 瓷砖所填充的区域必须是一个无孔的正十二边形。
- 如果我们可以将一种方案通过旋转和平移得到另一种方案，则这两个方案是相同的。

### 综合分析与结论
- **思路对比**：
    - 墨笙_Mooos 和 _Life_ 的思路较为相似，都从正十二边形的内角特点出发，发现每个角由正三角形和正方形拼接，确定最外围一圈填充方案可由一个角确定。然后将十二边形的边分为两组，把问题抽象为二维坐标系中从 $(d, d)$ 走到 $(0, 0)$ 的方案数，再考虑旋转相同的限制得到最终答案。
    - MurataHimeko 同样从内角特点得出最外一圈是正方形和三角形交替，通过画图分类讨论内部填充情况，设出状态 $f_{i,j}$ 进行递推，最后将问题转化为从 $(0,0)$ 走到 $(d, d - 1)$ 的路径条数。
- **算法要点**：
    - 墨笙_Mooos 和 _Life_ 都使用组合数 $C_{2d}^d$ 来计算方案数，最后除以 $2$ 消除旋转相同的重复情况。
    - MurataHimeko 使用动态规划的思想，通过递推公式 $f_{i,j}$ 计算方案数。
- **解决难点**：
    - 三者都解决了如何确定填充方案以及处理旋转相同的方案视为同一种的问题。墨笙_Mooos 和 _Life_ 通过建立二维坐标系和组合数计算简化问题，MurataHimeko 通过分类讨论和递推解决。

### 所选题解
- **墨笙_Mooos（5星）**
    - **关键亮点**：思路清晰，通过图形分析逐步引导出问题的本质，将填充问题转化为二维坐标系中的路径问题，最后利用组合数求解。代码实现简洁，使用快速幂求逆元。
    - **重点代码**：
```cpp
inline ll fstpow (ll a, ll b, ll p = mod)
{
    a %= p; ll Ans = 1;
    while (b)
    {
        if (b & 1) Ans = Ans * a % p;
        a = a * a % p, b >>= 1;
    }
    return Ans;
}
inline ll GetInv (ll x) { return fstpow (x, mod - 2); }
```
核心思想：`fstpow` 函数实现快速幂运算，用于计算 $a^b \bmod p$。`GetInv` 函数利用费马小定理，通过快速幂求 $x$ 在模 $mod$ 下的逆元。
- **_Life_（4星）**
    - **关键亮点**：同样从图形特点出发，思路清晰，代码中对组合数的预处理和计算使用了快速幂求逆元，保证了计算效率。
    - **重点代码**：
```cpp
int qpow(int a,int b)
{
    int ans=1;
    for(;b;a=a*a%mod,b>>=1)
        if(b&1)ans=ans*a%mod;
    return ans;
}
int C(int n,int m)
{
    if(n<m)return 0;
    return fac[n]*inv[m]%mod*inv[n-m]%mod;
}
```
核心思想：`qpow` 函数实现快速幂运算，用于计算 $a^b \bmod mod$。`C` 函数计算组合数 $C_{n}^m$，利用预处理的阶乘和逆元数组进行计算。

### 最优关键思路或技巧
将正十二边形的填充问题转化为二维坐标系中的路径问题，通过组合数计算方案数，同时利用旋转相同的性质对结果进行处理，简化了问题的求解过程。

### 拓展思路
同类型题可以考虑其他多边形的填充问题，或者改变瓷砖的形状和数量限制。类似算法套路可以应用于其他需要通过状态转移和组合数计算方案数的问题。

### 推荐洛谷题目
- P1044 [栈](https://www.luogu.com.cn/problem/P1044)：涉及组合数和卡特兰数的应用，与本题计算方案数的思路有一定相似性。
- P1722 [矩阵 II](https://www.luogu.com.cn/problem/P1722)：通过递推和组合数计算矩阵中路径的方案数。
- P3197 [HNOI2008]越狱](https://www.luogu.com.cn/problem/P3197)：需要运用组合数学和快速幂来计算方案数。

### 个人心得
MurataHimeko 提到“有点逆天的题”，并表示画图时“为了身心健康就只画了一部分”，总结为该题有一定难度，画图分析也较为繁琐。 

---
处理用时：30.38秒
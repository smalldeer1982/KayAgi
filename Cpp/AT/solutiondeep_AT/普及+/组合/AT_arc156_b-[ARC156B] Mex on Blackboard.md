# 题目信息

# [ARC156B] Mex on Blackboard

## 题目描述

[problemUrl]: https://atcoder.jp/contests/arc156/tasks/arc156_b

有限個の非負整数からなる多重集合 $ S $ にたいして、$ \mathrm{mex}(S) $ を、$ S $ に含まれない最小の非負整数と定義します。例えば、$ \mathrm{mex}(\lbrace\ 0,0,\ 1,3\rbrace\ )\ =\ 2,\ \mathrm{mex}(\lbrace\ 1\ \rbrace)\ =\ 0,\ \mathrm{mex}(\lbrace\ \rbrace)\ =\ 0 $ です。

黒板に $ N $ 個の非負整数が書かれており、$ i $ 番目の非負整数は $ A_i $ です。

あなたは、以下の操作をちょうど $ K $ 回行います。

- 黒板に書かれている非負整数を $ 0 $ 個以上選ぶ。選んだ非負整数からなる多重集合を $ S $ として、$ \mathrm{mex}(S) $ を黒板に $ 1 $ 個書き込む。
 
最終的に黒板に書かれている非負整数の多重集合としてありうるものの個数を $ 998244353 $ で割ったあまりを求めてください。

## 说明/提示

### 制約

- $ 1\ \leq\ N,K\ \leq\ 2\times\ 10^5 $
- $ 0\leq\ A_i\leq\ 2\times\ 10^5 $
- 入力される数値は全て整数
 
### Sample Explanation 1

操作後に得られる多重集合は、以下の $ 3 $ 通りです。 - $ \lbrace\ 0,0,1,3\ \rbrace $ - $ \lbrace\ 0,1,1,3\rbrace $ - $ \lbrace\ 0,1,2,3\ \rbrace $ 例えば、$ \lbrace\ 0,1,1,3\rbrace $ は黒板に書かれている $ 0 $ を選び、$ S=\lbrace\ 0\rbrace $ として操作をすることで得られます。

### Sample Explanation 2

操作後に得られる多重集合は、以下の $ 2 $ 通りです。 - $ \lbrace\ 0,0,0\ \rbrace $ - $ \lbrace\ 0,0,1\rbrace $ 操作で選ぶ整数は $ 0 $ 個でも良いことに注意してください。

## 样例 #1

### 输入

```
3 1

0 1 3```

### 输出

```
3```

## 样例 #2

### 输入

```
2 1

0 0```

### 输出

```
2```

## 样例 #3

### 输入

```
5 10

3 1 4 1 5```

### 输出

```
7109```

# AI分析结果

### 题目翻译
#### [ARC156B] 黑板上的 Mex

#### 题目描述
[problemUrl]: https://atcoder.jp/contests/arc156/tasks/arc156_b

对于由有限个非负整数组成的多重集合 $S$，将 $\mathrm{mex}(S)$ 定义为 $S$ 中不包含的最小非负整数。例如，$\mathrm{mex}(\{ 0,0, 1,3\}) = 2$，$\mathrm{mex}(\{ 1 \}) = 0$，$\mathrm{mex}(\{ \}) = 0$。

黑板上写着 $N$ 个非负整数，第 $i$ 个非负整数是 $A_i$。

你需要恰好进行 $K$ 次以下操作：
- 选择黑板上写着的 $0$ 个以上的非负整数。设所选非负整数组成的多重集合为 $S$，将 $\mathrm{mex}(S)$ 写一个到黑板上。

请求出最终黑板上写着的非负整数的多重集合的可能情况数除以 $998244353$ 的余数。

#### 说明/提示
##### 限制条件
- $1 \leq N,K \leq 2\times 10^5$
- $0\leq A_i\leq 2\times 10^5$
- 输入的所有数值均为整数

##### 样例解释 1
操作后得到的多重集合有以下 $3$ 种：
- $\{ 0,0,1,3 \}$
- $\{ 0,1,1,3\}$
- $\{ 0,1,2,3\}$
例如，$\{ 0,1,1,3\}$ 可以通过选择黑板上的 $0$，令 $S = \{ 0\}$ 进行操作得到。

##### 样例解释 2
操作后得到的多重集合有以下 $2$ 种：
- $\{ 0,0,0 \}$
- $\{ 0,0,1\}$
请注意，操作中选择的整数可以是 $0$ 个。

#### 样例 #1
##### 输入
```
3 1
0 1 3
```
##### 输出
```
3
```

#### 样例 #2
##### 输入
```
2 1
0 0
```
##### 输出
```
2
```

#### 样例 #3
##### 输入
```
5 10
3 1 4 1 5
```
##### 输出
```
7109
```

### 综合分析与结论
这些题解的核心思路都是通过枚举最大能加入的数，将问题转化为排列组合问题来求解。具体做法是先找出当前集合的 $\mathrm{mex}$，确定每次操作能加入的数的范围，再利用插板法计算方案数。

| 作者 | 思路 | 算法要点 | 解决难点 | 评分 |
| --- | --- | --- | --- | --- |
| heaksicn | 先计算初始 $\mathrm{mex}$，将操作分为取 $\mathrm{mex}$ 和不取两个阶段，枚举取 $\mathrm{mex}$ 的次数，用插板法计算方案数 | 快速幂求逆元，预处理阶乘和逆元，枚举取 $\mathrm{mex}$ 次数 | 如何避免重复计算，合理划分操作阶段 | 4星 |
| suzhikz | 先取没有的数，再取已有的数，枚举取几个没有的数，用排列组合计算方案数 | 快速幂求逆元，预处理阶乘和逆元，枚举新增元素个数 | 不重不漏地计算方案数 | 3星 |
| Otue | 枚举最大整数 $x$，计算写下 $x$ 所需次数，将剩余操作转化为分苹果问题，用组合数计算方案数 | 快速幂求逆元，预处理阶乘，枚举最大整数 | 确定写下最大整数的次数，转化为组合问题 | 3星 |
| I_like_magic | 去重原集合，枚举 $m$ 的值，统计小于等于 $m$ 的数字个数，用插板法计算可能结果数 | 快速幂求逆元，预处理阶乘，枚举 $m$ 值 | 处理重复统计的情况 | 3星 |
| lsj2009 | 枚举最终序列的 $\mathrm{mex}$，将问题转化为可重集操作问题，用插板法计算方案数 | 证明插板法结论，枚举 $\mathrm{mex}$ | 证明插板法结论，正确转化问题 | 3星 |
| linyihdfj | 从小到大枚举选择的最大数，用组合数计算方案数，跳过重复情况 | 快速幂求逆元，预处理阶乘和逆元，枚举最大数 | 处理重复计算的情况 | 3星 |

### 所选题解
- heaksicn（4星）
  - 关键亮点：思路清晰，将操作阶段划分明确，代码实现简洁，通过预处理阶乘和逆元，利用快速幂计算组合数，提高效率。

### 重点代码
```cpp
// heaksicn 的核心代码
int qpow(int x,int y){
    int res=1;
    while(y){
        if(y&1) res=res*x%mod;
        x=x*x%mod;
        y>>=1;
    }
    return res;
}
int fac[500001],inv[500001];
int C(int n,int m){
    return fac[n]*inv[m]%mod*inv[n-m]%mod;
}
signed main(){
    int n=read(),k=read();
    for(int i=1;i<=n;i++) a[i]=read(),mp[a[i]]++;
    fac[0]=inv[0]=1;
    for(int i=1;i<=5e5;i++){
        fac[i]=fac[i-1]*i%mod;
        inv[i]=qpow(fac[i],mod-2)%mod;
    }
    int now=0;
    while(mp[now]) now++;
    for(int i=1;i<=k;i++){
        g[i]=now;
        mp[now]=1;
        while(mp[now]) now++;
    }
    int ans=0;
    for(int i=1;i<=k;i++){
        ans=(ans+C(g[i]+k-i,k-i+1))%mod; 
    }
    ans++;
    write(ans);
    return 0;
}
```
核心实现思想：先读取输入，统计每个数的出现次数，预处理阶乘和逆元。找到初始的 $\mathrm{mex}$，模拟 $k$ 次操作，记录每次操作后的 $\mathrm{mex}$。枚举取 $\mathrm{mex}$ 的次数，利用组合数计算方案数，最后累加得到结果。

### 关键思路或技巧
- **枚举最大数**：通过枚举最终集合中能加入的最大数，确定操作的范围。
- **插板法**：将问题转化为可重集的组合问题，利用插板法计算方案数。
- **预处理阶乘和逆元**：通过预处理阶乘和逆元，利用快速幂计算组合数，提高计算效率。

### 拓展思路
同类型题或类似算法套路：
- 涉及多重集合操作和计数的问题，如集合的合并、拆分等操作后的结果计数。
- 利用排列组合解决计数问题，如分球问题、分配问题等。

### 推荐题目
- [P1833 樱花](https://www.luogu.com.cn/problem/P1833)：涉及多重背包和组合数的问题。
- [P2822 组合数问题](https://www.luogu.com.cn/problem/P2822)：直接考察组合数的计算和应用。
- [P1025 数的划分](https://www.luogu.com.cn/problem/P1025)：利用插板法解决分球问题。

### 个人心得
题解中未包含个人心得。

---
处理用时：44.62秒
# 题目信息

# [ARC156B] Mex on Blackboard

## 题目描述

[problemUrl]: https://atcoder.jp/contests/arc156/tasks/arc156_b

有限個の非負整数からなる多重集合 $ S $ にたいして、$ \mathrm{mex}(S) $ を、$ S $ に含まれない最小の非負整数と定義します。例えば、$ \mathrm{mex}(\lbrace\ 0,0,\ 1,3\rbrace\ )\ =\ 2,\ \mathrm{mex}(\lbrace\ 1\ \rbrace)\ =\ 0,\ \mathrm{mex}(\lbrace\ \rbrace)\ =\ 0 $ です。

黒板に $ N $ 個の非負整数が書かれており、$ i $ 番目の非負整数は $ A_i $ です。

あなたは、以下の操作をちょうど $ K $ 回行います。

- 黒板に書かれている非負整数を $ 0 $ 個以上選ぶ。選んだ非負整数からなる多重集合を $ S $ として、$ \mathrm{mex}(S) $ を黒板に $ 1 $ 個書き込む。
 
最終的に黒板に書かれている非負整数の多重集合としてありうるものの個数を $ 998244353 $ で割ったあまりを求めてください。

## 说明/提示

### 制約

- $ 1\ \leq\ N,K\ \leq\ 2\times\ 10^5 $
- $ 0\leq\ A_i\leq\ 2\times\ 10^5 $
- 入力される数値は全て整数
 
### Sample Explanation 1

操作後に得られる多重集合は、以下の $ 3 $ 通りです。 - $ \lbrace\ 0,0,1,3\ \rbrace $ - $ \lbrace\ 0,1,1,3\rbrace $ - $ \lbrace\ 0,1,2,3\ \rbrace $ 例えば、$ \lbrace\ 0,1,1,3\rbrace $ は黒板に書かれている $ 0 $ を選び、$ S=\lbrace\ 0\rbrace $ として操作をすることで得られます。

### Sample Explanation 2

操作後に得られる多重集合は、以下の $ 2 $ 通りです。 - $ \lbrace\ 0,0,0\ \rbrace $ - $ \lbrace\ 0,0,1\rbrace $ 操作で選ぶ整数は $ 0 $ 個でも良いことに注意してください。

## 样例 #1

### 输入

```
3 1

0 1 3```

### 输出

```
3```

## 样例 #2

### 输入

```
2 1

0 0```

### 输出

```
2```

## 样例 #3

### 输入

```
5 10

3 1 4 1 5```

### 输出

```
7109```

# AI分析结果

### 题目中文重写
#### [ARC156B] 黑板上的MEX

#### 题目描述
[problemUrl]: https://atcoder.jp/contests/arc156/tasks/arc156_b

对于由有限个非负整数组成的多重集合 $S$，定义 $\mathrm{mex}(S)$ 为 $S$ 中不包含的最小非负整数。例如，$\mathrm{mex}(\{ 0,0, 1,3\}) = 2$，$\mathrm{mex}(\{ 1 \}) = 0$，$\mathrm{mex}(\{ \}) = 0$。

黑板上写着 $N$ 个非负整数，第 $i$ 个非负整数是 $A_i$。

你需要恰好进行 $K$ 次以下操作：
- 从黑板上写着的非负整数中选择 0 个以上。设所选非负整数组成的多重集合为 $S$，将 $\mathrm{mex}(S)$ 写一个到黑板上。

请求出最终黑板上写着的非负整数的多重集合的可能情况数，将结果对 $998244353$ 取模。

#### 说明/提示
##### 限制条件
- $1 \leq N,K \leq 2\times 10^5$
- $0\leq A_i\leq 2\times 10^5$
- 输入的所有数值均为整数

##### 样例解释 1
操作后可能得到的多重集合有以下 3 种：
- $\{ 0,0,1,3 \}$
- $\{ 0,1,1,3\}$
- $\{ 0,1,2,3\}$

例如，$\{ 0,1,1,3\}$ 可以通过选择黑板上的 $0$，令 $S = \{ 0\}$ 进行操作得到。

##### 样例解释 2
操作后可能得到的多重集合有以下 2 种：
- $\{ 0,0,0 \}$
- $\{ 0,0,1\}$

请注意，操作时选择的整数可以为 0 个。

#### 样例 #1
##### 输入
```
3 1
0 1 3
```
##### 输出
```
3
```

#### 样例 #2
##### 输入
```
2 1
0 0
```
##### 输出
```
2
```

#### 样例 #3
##### 输入
```
5 10
3 1 4 1 5
```
##### 输出
```
7109
```

### 综合分析与结论
这些题解的核心思路都是通过枚举关键数值（如最大加入数、最终序列的 $\text{mex}$ 等），将问题转化为经典的排列组合问题（如插板法）来求解。
- **思路对比**：
    - heaksicn、Otue、lsj2009 等从操作过程中能加入的数的范围入手，枚举达到某个 $\text{mex}$ 值所需的操作次数，再用插板法计算后续操作的方案数。
    - suzhikz 先取没有的数，再取已有的数，枚举取没有的数的个数，用排列组合计算方案。
    - I_like_magic 和 linyihdfj 枚举最终集合中最大的数，统计相关数字个数，用插板法计算可能结果数，同时处理重复计算的情况。
- **算法要点**：都用到了快速幂求逆元来计算组合数，核心是利用插板法解决可重复选择的组合问题。
- **解决难点**：主要难点在于分析操作过程中能加入的数的范围，避免重复计算。通过合理的枚举和分阶段处理操作，结合插板法解决问题。

### 评分较高的题解
- **heaksicn（5星）**：
    - **关键亮点**：思路清晰，详细阐述了每次操作能加入的数的范围，将操作分为取 $\text{mex}$ 和不取两个阶段，转化为插板法问题，代码实现规范，有详细的输入输出函数。
    - **核心代码**：
```cpp
int ans=0;
for(int i=1;i<=k;i++){
    ans=(ans+C(g[i]+k-i,k-i+1))%mod; 
}
ans++;
```
核心思想是枚举取 $\text{mex}$ 操作的次数 $i$，计算每次操作后对应的组合数并累加，最后加 1 考虑初始情况。
- **Otue（4星）**：
    - **关键亮点**：通过观察操作特点，枚举最大整数 $x$，将问题转化为经典的小朋友分苹果问题，代码简洁明了。
    - **核心代码**：
```cpp
int cnt = 0;
for (int i = 0; i <= N - 5; i++) {
    if (vis[i] == 0) cnt++;
    if (vis[i + 1]) continue;
    if (cnt > k) break;
    res = (res + C(k - cnt + i, i)) % mod;
}
```
核心思想是枚举最大整数 $i$，统计达到该最大整数所需的操作次数 $cnt$，计算剩余操作次数下的组合数并累加。
- **I_like_magic（4星）**：
    - **关键亮点**：先对原集合去重，枚举最终集合中最大的数 $m$，根据条件计算 $\sum\limits_{i = 0}^{m}cnt_i$ 的值，用插板法计算可能结果数，同时处理重复计算的情况。
    - **核心代码**：
```cpp
sum = k;
for(int i = 0; ; i ++) {
    if(f[i]) sum ++;
    if(sum < i) break;
    if(f[i + 1]) continue;
    ans += C(sum - 1, i);
    ans %= P;
}
```
核心思想是枚举最大数 $i$，更新 $sum$ 的值，判断是否满足条件，跳过重复情况，计算组合数并累加到答案中。

### 最优关键思路或技巧
- **枚举关键数值**：通过枚举最大加入数、最终序列的 $\text{mex}$ 等关键数值，将复杂的操作问题转化为可处理的排列组合问题。
- **插板法**：将可重复选择的组合问题转化为经典的插板法问题，简化计算。
- **分阶段处理操作**：如 heaksicn 将操作分为取 $\text{mex}$ 和不取两个阶段，避免重复计算。

### 可拓展之处
同类型题可能会改变操作规则或集合的定义，类似算法套路可用于解决其他涉及组合计数和操作模拟的问题，如在不同的操作规则下计算集合的可能状态数。

### 洛谷相似题目推荐
- P1833 樱花：涉及组合数学和时间安排问题，需要运用组合数计算方案数。
- P2822 组合数问题：专门考察组合数的计算和应用。
- P3197 [HNOI2008]越狱：通过组合数学方法解决排列组合问题。

### 个人心得
题解中未包含个人心得相关内容。

---
处理用时：41.52秒
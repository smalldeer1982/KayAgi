# 题目信息

# [AGC034B] ABC

## 题目描述

[problemUrl]: https://atcoder.jp/contests/agc034/tasks/agc034_b

`A`,`B`,`C` からなる文字列 $ s $ が与えられます。

すぬけ君は $ s $ に対して次の操作をできるだけ多く行おうとしています。

- $ s $ の連続した部分文字列であって `ABC` であるようなものをひとつ選び、 `BCA` に書き換える。

操作回数の最大値を求めてください。

## 说明/提示

### 制約

- $ 1\ ≦\ |s|\ ≦\ 200000 $
- $ s $ の各文字は `A`,`B`,`C` のいずれか

### Sample Explanation 1

`ABCABC` → `BCAABC` → `BCABCA` → `BCBCAA` とすることで $ 3 $ 回操作可能で、これが最大です。

## 样例 #1

### 输入

```
ABCABC```

### 输出

```
3```

## 样例 #2

### 输入

```
C```

### 输出

```
0```

## 样例 #3

### 输入

```
ABCACCBABCBCAABCB```

### 输出

```
6```

# AI分析结果

### 题目内容重写

【题目描述】

给定一个由 `A`、`B`、`C` 组成的字符串 $s$。

Snuke 想要对 $s$ 进行尽可能多的操作，操作如下：

- 选择 $s$ 中的一个连续子串 `ABC`，并将其替换为 `BCA`。

求操作的最大次数。

【说明/提示】

### 约束

- $1 \leq |s| \leq 200000$
- $s$ 的每个字符是 `A`、`B`、`C` 之一

### 样例解释

对于输入 `ABCABC`，可以通过以下操作进行 3 次操作：

1. `ABCABC` → `BCAABC`
2. `BCAABC` → `BCABCA`
3. `BCABCA` → `BCBCAA`

这是最大操作次数。

### 样例 #1

输入：

```
ABCABC
```

输出：

```
3
```

### 样例 #2

输入：

```
C
```

输出：

```
0
```

### 样例 #3

输入：

```
ABCACCBABCBCAABCB
```

输出：

```
6
```

---

### 题解分析与结论

#### 综合分析

本题的核心在于如何高效地计算字符串中 `ABC` 子串的最大操作次数。由于字符串长度可能达到 20 万，暴力解法显然不可行。所有题解都采用了线性扫描的思路，通过记录 `A` 的个数，并在遇到 `BC` 时累加操作次数，从而在 $O(n)$ 时间内解决问题。

#### 最优思路总结

1. **线性扫描**：通过一次遍历字符串，记录连续的 `A` 的个数，并在遇到 `BC` 时累加操作次数。
2. **边界处理**：在处理 `B` 和 `C` 时，需要检查是否越界，并重置 `A` 的计数。
3. **优化技巧**：通过跳过已经处理过的 `BC`，避免重复计算。

#### 推荐题解

1. **作者：atarashiTLE (5星)**
   - **关键亮点**：代码简洁，思路清晰，直接通过一次遍历解决问题。
   - **个人心得**：强调了 `long long` 的重要性，避免溢出问题。
   - **核心代码**：
     ```cpp
     for(int i=0;i<c.size();i++){
         if(c[i]=='A')tot++;
         else if(c[i]=='B'){
             if(i+1<c.size()&&c[i+1]=='C'){
                 ans+=tot;i++;
             }
             else 
                 tot=0;
         }
         else
             tot=0;
     }
     ```

2. **作者：Keep_RAD (4星)**
   - **关键亮点**：通过详细的分析和验证，解释了为什么只需要记录 `A` 的个数，并在遇到 `BC` 时累加。
   - **个人心得**：强调了 `long long` 的重要性，并通过样例验证了算法的正确性。
   - **核心代码**：
     ```cpp
     for(int i=0;i<s.size();i++){
         if(s[i]=='A')
             tot++;
         else
             if(s[i]=='B'){
                 if(i+1<s.size()&&s[i+1]=='C'){
                     sum+=tot;
                     i++;
                 }
                 else tot=0;
             } 
             else
                 tot=0;
     }
     ```

3. **作者：Inxwxc (4星)**
   - **关键亮点**：通过分析 `A` 和 `BC` 的组合，提出了线性扫描的思路，并提供了详细的代码实现。
   - **个人心得**：通过暴力解法 TLE 的教训，强调了线性扫描的重要性。
   - **核心代码**：
     ```cpp
     for (int i=1;i<st.size();i++){
         if (st[i-1]!='A'&&st[i]=='A')
             la=i,ra=la;
         if (st[i-1]=='A'&&st[i]=='A')
             ra++;
         if (st[i]=='B'&&st[i+1]=='C'&&i==ra+1&&ra!=la){
             st[i]='A';st[i+1]='A';
             ans+=ra-la+1;
             st[la]='D';st[la+1]='D';
             la=la+2;ra=i;
         }
         if (st[i]=='B'&&st[i+1]=='C'&&i==ra+1&&la==ra)
             st[i+1]='A',ans++,st[i]='D';
     }
     ```

### 可拓展之处

1. **类似问题**：可以扩展到其他类似的字符串替换问题，如替换 `ABA` 为 `BAB` 等。
2. **优化技巧**：在处理字符串问题时，线性扫描和记录关键字符的个数是常见的优化手段。

### 推荐题目

1. [P3375 【模板】KMP字符串匹配](https://www.luogu.com.cn/problem/P3375)
2. [P3805 【模板】manacher算法](https://www.luogu.com.cn/problem/P3805)
3. [P3834 【模板】可持久化线段树](https://www.luogu.com.cn/problem/P3834)

这些题目考察了字符串处理和线性扫描的技巧，与本题有相似之处。

---
处理用时：40.37秒
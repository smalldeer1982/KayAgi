# 题目信息

# [ARC060E] 高橋君とホテル

## 题目描述

[problemUrl]: https://atcoder.jp/contests/arc060/tasks/arc060_c

$ N $ 軒のホテルが一直線上に並んでいます。$ i\ \,\ (1\ \leq\ i\ \leq\ N) $ 番目のホテルは、座標 $ x_i $ に位置しています。

旅行者である高橋君には、次の $ 2 $ つの信念があります。

- 高橋君の $ 1 $ 日の移動距離は $ L $ を超えない。
- 高橋君は野宿をしない。すなわち、$ 1 $ 日の終わりには必ずいずれかのホテルにいなければならない。

$ Q $ 個のクエリが与えられます。$ j\,(1\ \leq\ j\ \leq\ Q) $ 番目のクエリとして、異なる $ 2 $ つの整数 $ a_j,\,b_j $ が与えられます。 各クエリについて、前述の信念をともに守った上で、高橋君が $ a_j $ 番目のホテルから $ b_j $ 番目のホテルに移動するために必要な最小日数を求めてください。 なお、高橋君が $ a_j $ 番目のホテルから $ b_j $ 番目のホテルに移動できることは保証されます。

## 说明/提示

### 制約

- $ 2\ \leq\ N\ \leq\ 10^5 $
- $ 1\ \leq\ L\ \leq\ 10^9 $
- $ 1\ \leq\ Q\ \leq\ 10^5 $
- $ 1\ \leq\ x_i\ <\ x_2\ <\ ...\ <\ x_N\ \leq\ 10^9 $
- $ x_{i+1}\ -\ x_i\ \leq\ L $
- $ 1\ \leq\ a_j,b_j\ \leq\ N $
- $ a_j\ \neq\ b_j $
- $ N,\,L,\,Q,\,x_i,\,a_j,\,b_j $ はいずれも整数である

### 部分点

- $ N\ \leq\ 10^3 $ および $ Q\ \leq\ 10^3 $ を満たすデータセットに正解した場合は、$ 200 $ 点が与えられる。

### Sample Explanation 1

$ 1 $ つ目のクエリでは、次のように行動することで、$ 1 $ 番目のホテルから $ 8 $ 番目のホテルへ $ 4 $ 日間で移動することができます。 - $ 1 $ 日目には、$ 1 $ 番目のホテルから $ 2 $ 番目のホテルへ移動する。この日の移動距離は $ 2 $ である。 - $ 2 $ 日目には、$ 2 $ 番目のホテルから $ 4 $ 番目のホテルへ移動する。この日の移動距離は $ 10 $ である。 - $ 3 $ 日目には、$ 4 $ 番目のホテルから $ 7 $ 番目のホテルへ移動する。この日の移動距離は $ 6 $ である。 - $ 4 $ 日目には、$ 7 $ 番目のホテルから $ 8 $ 番目のホテルへ移動する。この日の移動距離は $ 10 $ である。

## 样例 #1

### 输入

```
9

1 3 6 13 15 18 19 29 31

10

4

1 8

7 3

6 7

8 5```

### 输出

```
4

2

1

2```

# AI分析结果

### 题目内容重写

**题目描述**

$ N $ 家酒店在一条直线上排列。第 $ i\ \,\ (1\ \leq\ i\ \leq\ N) $ 家酒店位于坐标 $ x_i $ 处。

旅行者高桥君有以下两个信念：

- 高桥君每天的移动距离不超过 $ L $。
- 高桥君不会在野外过夜，即每天结束时必须位于某家酒店。

给定 $ Q $ 个查询，每个查询给出两个不同的整数 $ a_j,\,b_j $。对于每个查询，求高桥君在遵守上述信念的情况下，从第 $ a_j $ 家酒店移动到第 $ b_j $ 家酒店所需的最小天数。保证高桥君能够从第 $ a_j $ 家酒店移动到第 $ b_j $ 家酒店。

**说明/提示**

### 约束

- $ 2\ \leq\ N\ \leq\ 10^5 $
- $ 1\ \leq\ L\ \leq\ 10^9 $
- $ 1\ \leq\ Q\ \leq\ 10^5 $
- $ 1\ \leq\ x_i\ <\ x_2\ <\ ...\ <\ x_N\ \leq\ 10^9 $
- $ x_{i+1}\ -\ x_i\ \leq\ L $
- $ 1\ \leq\ a_j,b_j\ \leq\ N $
- $ a_j\ \neq\ b_j $
- $ N,\,L,\,Q,\,x_i,\,a_j,\,b_j $ 均为整数

### 部分分

- $ N\ \leq\ 10^3 $ 且 $ Q\ \leq\ 10^3 $ 的数据集得 $ 200 $ 分。

### 样例解释

第一个查询中，高桥君可以从第 $ 1 $ 家酒店到第 $ 8 $ 家酒店，共需 $ 4 $ 天。

---

### 题解分析与结论

#### 综合分析

本题的核心在于如何在遵守高桥君的移动限制下，快速计算从起点到终点的最小天数。由于数据规模较大，直接暴力模拟会超时，因此需要采用更高效的算法。常见的优化思路包括：

1. **倍增法**：通过预处理每个点在不同步数下能到达的最远点，利用倍增思想快速计算最小天数。
2. **分块+二分**：将序列分块，预处理每个块内的跳跃信息，结合二分查找优化查询效率。
3. **贪心+倍增**：每次跳跃尽可能远，利用倍增优化跳跃次数。

#### 最优思路与技巧

- **倍增法**是最优的解决方案，时间复杂度为 $O((N+Q)\log N)$，适用于大规模数据。
- **预处理**：通过双指针或二分查找预处理每个点能到达的最远点，然后利用倍增思想进行跳跃。
- **查询优化**：在查询时，从大到小枚举步数，尽可能减少跳跃次数。

#### 推荐题解

1. **作者：GaryH (5星)**
   - **关键亮点**：详细解释了倍增法的原理，并提供了完整的代码实现。预处理部分使用双指针优化，查询部分利用倍增思想快速计算最小天数。
   - **代码核心**：
     ```cpp
     for(int l=1,r=0;l<=n;l++){
         while(r<=n&&x[r]-x[l]<=L)r++;
         st[l][0]=(--r);
     }
     rep(j,1,M)rep(i,1,n){
         if(st[i][j-1]>n)st[i][j]=1e9;
         else st[i][j]=st[st[i][j-1]][j-1];
     }
     ```

2. **作者：君のNOIP。 (5星)**
   - **关键亮点**：清晰解释了倍增法的实现过程，预处理部分使用双指针优化，查询部分从大到小枚举步数，确保每次跳跃尽可能远。
   - **代码核心**：
     ```cpp
     for(int i=1;i<=n;i++){
         while(va[t+1]-va[i]<=L&&t<n)t++;
         dp[i][0]=t;
     }
     for(int k=1;k<=16;k++)
         for(int i=1;i<=n;i++)
             dp[i][k]=dp[dp[i][k-1]][k-1];
     ```

3. **作者：BreakPlus (5星)**
   - **关键亮点**：详细介绍了倍增法的应用场景，并提供了完整的代码实现。预处理部分使用二分查找，查询部分利用倍增思想快速计算最小天数。
   - **代码核心**：
     ```cpp
     for(int i=1;i<=n;i++){
         if(a[i]+L>a[n]){
             jump[0][i]=n+1;
             continue;
         }
         int l=i+1,r=n,mid,ans=i+1;
         while(l<=r){
             mid=l+r>>1;
             if(a[mid]-a[i]<=L){
                 ans=mid;
                 l=mid+1;
             }else r=mid-1;
         }
         jump[0][i]=ans;
     }
     ```

#### 推荐题目

1. [P3203 弹飞绵羊](https://www.luogu.com.cn/problem/P3203)
2. [P3379 最近公共祖先](https://www.luogu.com.cn/problem/P3379)
3. [P1967 货车运输](https://www.luogu.com.cn/problem/P1967)

---
处理用时：50.53秒
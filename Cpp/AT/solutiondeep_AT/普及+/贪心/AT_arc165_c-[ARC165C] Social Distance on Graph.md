# 题目信息

# [ARC165C] Social Distance on Graph

## 题目描述

[problemUrl]: https://atcoder.jp/contests/arc165/tasks/arc165_c

頂点に $ 1 $ から $ N $ の番号が付いた $ N $ 頂点からなる単純連結無向グラフがあります。グラフには重みを持つ辺が $ M $ 本あり、$ i $ 番目の辺は頂点 $ A_i,B_i $ を結ぶ重みが $ W_i $ の辺です。また、$ 2 $ 頂点を結ぶ単純パスの重みを、単純パスが含む辺の重みの総和とします。

各頂点に対し赤、青のいずれかの色を塗ります。以下の条件を満たす塗り分け方が存在するような整数 $ X $ の最大値を求めてください。

- 同じ色で塗られた相異なる $ 2 $ 頂点を結ぶどの単純パスについても、単純パスの重みは $ X $ 以上である。
 
  単純パスとは グラフ $ G $ 上の頂点 $ X,Y $ に対して、頂点列 $ v_1,v_2,\ \ldots,\ v_k $ であって、 $ v_1=X $, $ v_k=Y $ かつ、$ 1\leq\ i\leq\ k-1 $ に対して $ v_i $ と $ v_{i+1} $ が辺で結ばれているようなものを頂点 $ X $ から頂点 $ Y $ への **ウォーク** と呼びます。 さらに、$ v_1,v_2,\ \ldots,\ v_k $ がすべて異なるようなものを頂点 $ X $ から頂点 $ Y $ への **単純パス** (あるいは単に **パス**) と呼びます。

## 说明/提示

### 制約

- $ 3\ \leq\ N\ \leq\ 2\ \times\ 10^5 $
- $ N-1\ \leq\ M\ \leq\ \min(\frac{N(N-1)}{2},2\ \times\ 10^5) $
- $ 1\ \leq\ A_i\ <\ B_i\ \leq\ N $
- $ 1\ \leq\ W_i\ \leq\ 10^9 $
- 与えられるグラフは単純連結無向グラフ
- 入力される値はすべて整数
 
### Sample Explanation 1

$ X=11 $ としたときに条件を満たす色の塗り方が存在するか考えます。頂点 $ 1,3 $ を赤、頂点 $ 2 $ を青で塗った場合、同じ色の頂点を結ぶ単純パス $ 1-2-3 $ の重みが $ 5+6=11 $ となります。これが同じ色の頂点を結ぶ単純パスの重みの最小値となるのでこの塗り分け方は条件を満たしています。 $ X $ が $ 12 $ 以上のとき、条件を満たす塗り分け方が存在しないことが示せます。よって答えは $ 11 $ となります。

## 样例 #1

### 输入

```
3 3

1 2 5

2 3 6

1 3 12```

### 输出

```
11```

## 样例 #2

### 输入

```
10 20

7 10 982219000

3 10 968366179

2 4 992330437

5 6 984414664

2 8 897295423

7 9 155604979

6 8 958833005

2 3 973209957

3 7 985173062

6 10 963895817

2 10 986243534

4 5 721724794

1 3 657562445

1 6 566370694

1 4 988050146

1 9 967817807

4 9 796531581

5 9 983960054

1 10 964450079

8 9 959369491```

### 输出

```
952136560```

## 样例 #3

### 输入

```
10 20

5 6 871895994

8 10 873709822

3 5 454175869

6 10 980782191

2 6 901290987

1 8 298092290

4 8 693116157

4 5 947939338

7 8 934395075

7 9 759563833

5 8 779870031

4 6 919637355

2 9 822858749

4 10 855497285

3 7 954942051

1 2 950411658

4 7 665939990

3 4 634533617

5 7 908372507

1 9 591466693```

### 输出

```
759563833```

# AI分析结果

### 题目内容重写

**题目描述**

给定一个由 $N$ 个顶点组成的简单连通无向图，顶点编号从 $1$ 到 $N$。图中有 $M$ 条带权边，第 $i$ 条边连接顶点 $A_i$ 和 $B_i$，权重为 $W_i$。定义连接两个顶点的简单路径的权重为该路径上所有边的权重之和。

要求为每个顶点涂上红色或蓝色，满足以下条件：对于任意两个颜色相同的顶点，它们之间的所有简单路径的权重都至少为 $X$。求满足条件的最大整数 $X$。

**输入格式**

第一行包含两个整数 $N$ 和 $M$，表示顶点数和边数。

接下来 $M$ 行，每行包含三个整数 $A_i$, $B_i$, $W_i$，表示一条边的两个顶点及其权重。

**输出格式**

输出一个整数，表示满足条件的最大 $X$。

**样例**

输入：
```
3 3
1 2 5
2 3 6
1 3 12
```
输出：
```
11
```

**提示**

- $3 \leq N \leq 2 \times 10^5$
- $N-1 \leq M \leq \min(\frac{N(N-1)}{2}, 2 \times 10^5)$
- $1 \leq A_i < B_i \leq N$
- $1 \leq W_i \leq 10^9$
- 给定的图是简单连通无向图。

### 题解分析与结论

#### 关键思路总结

1. **二分答案**：大多数题解采用了二分答案的思路，通过二分查找确定最大的 $X$，使得在涂色后，所有相同颜色的顶点之间的路径权重都至少为 $X$。

2. **二分图判定**：在二分答案的过程中，需要判断是否存在一种涂色方案，使得所有边权小于 $X$ 的边连接的两个顶点颜色不同。这可以通过二分图判定来实现。

3. **预处理最小边权和**：为了确定二分的上界，许多题解预处理了每个顶点的最小边权和次小边权，并将它们的和作为二分的上界。

4. **并查集优化**：部分题解使用了并查集来优化二分图判定，通过维护两个集合来确保相邻顶点颜色不同。

#### 最优题解推荐

1. **作者：翼德天尊**  
   **星级：5**  
   **关键亮点**：  
   - 采用了二分答案的思路，结合二分图判定，思路清晰。
   - 通过预处理每个顶点的最小边权和次小边权，优化了二分的上界。
   - 代码实现简洁，可读性强。

   **核心代码**：
   ```cpp
   bool check(ll x){
       flag=1;
       for (int i=1;i<=n;i++) col[i]=0;
       for (int i=1;i<=n;i++)
           if (!col[i]) col[i]=1,dfs(i,x);
       return flag;
   }
   ```

2. **作者：reclusive**  
   **星级：4**  
   **关键亮点**：  
   - 详细解释了二分答案的思路，并给出了二分图判定的具体实现。
   - 强调了二分上界的确定方法，确保答案的正确性。
   - 代码结构清晰，注释详细。

   **核心代码**：
   ```cpp
   bool dfs(LL x,LL mid,LL c){
       color[x]=c;
       for(LL k=last[x];k;k=a[k].pre){
           if(a[k].c>=mid)continue;
           LL y=a[k].y;
           if(color[x]==color[y]) return false;
           if(!color[y]&&!dfs(y,mid,3-c)) return false;
       }
       return true;
   }
   ```

3. **作者：樱雪喵**  
   **星级：4**  
   **关键亮点**：  
   - 提出了最小生成树的思路，通过生成树染色来优化答案。
   - 详细解释了如何通过最小生成树和二分图判定来确定答案。
   - 代码实现简洁，逻辑清晰。

   **核心代码**：
   ```cpp
   void dfs(int u)
   {
       for(auto i:e[u])
       {
           int v=i.to;
           if(col[v]==-1) col[v]=col[u]^1,dfs(v);
       }
   }
   ```

#### 拓展思路与推荐题目

1. **拓展思路**：  
   - 该题的二分答案结合二分图判定的思路可以应用于其他需要满足某种条件的图论问题，如最小生成树、最大流等。
   - 类似的问题还可以考虑在图中寻找满足特定条件的路径或子图。

2. **推荐题目**：  
   - [P1525 关押罪犯](https://www.luogu.com.cn/problem/P1525)：考察二分答案与并查集的应用。
   - [P3386 二分图匹配](https://www.luogu.com.cn/problem/P3386)：二分图匹配的经典问题。
   - [P1967 货车运输](https://www.luogu.com.cn/problem/P1967)：最小生成树与路径查询的结合。

---
处理用时：41.36秒
# 题目信息

# [ABC173C] H and V

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc173/tasks/abc173_c

$ H $ 行 $ W $ 列に並ぶマスからなるマス目があります。上から $ i $ 行目、左から $ j $ 列目 $ (1\ \leq\ i\ \leq\ H,\ 1\ \leq\ j\ \leq\ W) $ のマスの色は文字 $ c_{i,j} $ として与えられ、$ c_{i,j} $ が `.` のとき白、`#` のとき黒です。

次の操作を行うことを考えます。

- 行を何行か選び ($ 0 $ 行でもよい)、列を何列か選ぶ ($ 0 $ 列でもよい)。そして、選んだ行に含まれるマスと、選んだ列に含まれるマスをすべて赤く塗る。

正の整数 $ K $ が与えられます。操作後に黒いマスがちょうど $ K $ 個残るような行と列の選び方は何通りでしょうか。ここで、二つの選び方は、一方においてのみ選ばれる行または列が存在するときに異なるとみなされます。

## 说明/提示

### 制約

- $ 1\ \leq\ H,\ W\ \leq\ 6 $
- $ 1\ \leq\ K\ \leq\ HW $
- $ c_{i,j} $ は `.` または `#`

### Sample Explanation 1

以下の $ 5 $ 通りの選び方が条件を満たします。 - $ 1 $ 行目、$ 1 $ 列目 - $ 1 $ 行目、$ 2 $ 列目 - $ 1 $ 行目、$ 3 $ 列目 - $ 1 $ 列目、$ 2 $ 列目 - $ 3 $ 列目

### Sample Explanation 2

何も選ばないという $ 1 $ 通りの選び方が条件を満たします。

## 样例 #1

### 输入

```
2 3 2

..#

###```

### 输出

```
5```

## 样例 #2

### 输入

```
2 3 4

..#

###```

### 输出

```
1```

## 样例 #3

### 输入

```
2 2 3

##

##```

### 输出

```
0```

## 样例 #4

### 输入

```
6 6 8

..##..

.#..#.

#....#

######

#....#

#....#```

### 输出

```
208```

# AI分析结果

### 题目内容

#### [ABC173C] H and V

**题目描述**

有一个由 $H$ 行 $W$ 列组成的网格。从上到下第 $i$ 行、从左到右第 $j$ 列（$1 \leq i \leq H, 1 \leq j \leq W$）的网格颜色由字符 $c_{i,j}$ 给出，$c_{i,j}$ 为 `.` 时表示白色，`#` 时表示黑色。

考虑进行以下操作：

- 选择若干行（可以不选）和若干列（可以不选），然后将所选行和列中的所有网格涂成红色。

给定一个正整数 $K$，问操作后恰好剩下 $K$ 个黑色网格的行和列的选择方式有多少种。这里，两种选择方式被认为是不同的，当且仅当其中一种选择方式中选择了某行或某列，而另一种选择方式中没有选择该行或该列。

**说明/提示**

**约束条件**

- $1 \leq H, W \leq 6$
- $1 \leq K \leq HW$
- $c_{i,j}$ 是 `.` 或 `#`

**样例解释 1**

以下 $5$ 种选择方式满足条件：
- 第 $1$ 行，第 $1$ 列
- 第 $1$ 行，第 $2$ 列
- 第 $1$ 行，第 $3$ 列
- 第 $1$ 列，第 $2$ 列
- 第 $3$ 列

**样例解释 2**

不选择任何行或列的选择方式满足条件。

**样例 #1**

**输入**

```
2 3 2

..#

###```

**输出**

```
5```

**样例 #2**

**输入**

```
2 3 4

..#

###```

**输出**

```
1```

**样例 #3**

**输入**

```
2 2 3

##

##```

**输出**

```
0```

**样例 #4**

**输入**

```
6 6 8

..##..

.#..#.

#....#

######

#....#

#....#```

**输出**

```
208```

### 算法分类

**枚举**

### 题解分析与结论

由于 $H$ 和 $W$ 的范围都很小（最大为 6），因此可以直接使用枚举的方法来解决问题。具体来说，我们可以枚举所有可能的选择行和列的组合，然后检查每种组合下剩余的黑色网格数量是否等于 $K$。

### 题解

**题解 1**

**星级：4星**

**关键亮点：**
- 使用位运算来枚举所有可能的选择行和列的组合，代码简洁高效。
- 通过双重循环遍历所有可能的行和列选择，计算每种情况下的黑色网格数量。

**核心代码实现：**

```cpp
int main() {
    int H, W, K;
    cin >> H >> W >> K;
    vector<string> grid(H);
    for (int i = 0; i < H; ++i) {
        cin >> grid[i];
    }

    int ans = 0;
    for (int maskR = 0; maskR < (1 << H); ++maskR) {
        for (int maskC = 0; maskC < (1 << W); ++maskC) {
            int cnt = 0;
            for (int i = 0; i < H; ++i) {
                if (maskR & (1 << i)) continue;
                for (int j = 0; j < W; ++j) {
                    if (maskC & (1 << j)) continue;
                    if (grid[i][j] == '#') cnt++;
                }
            }
            if (cnt == K) ans++;
        }
    }
    cout << ans << endl;
    return 0;
}
```

**代码解释：**
- `maskR` 和 `maskC` 分别表示行和列的选择状态，通过位运算来枚举所有可能的选择组合。
- 对于每一种组合，计算未被选中的行和列中的黑色网格数量，如果等于 $K$，则答案加 1。

### 最优关键思路或技巧

- **位运算枚举**：利用位运算来枚举所有可能的选择组合，代码简洁且高效。
- **双重循环遍历**：通过双重循环遍历所有可能的行和列选择，确保不遗漏任何情况。

### 可拓展之处

- **类似题目**：类似的问题可以通过枚举所有可能的组合来解决，特别是在数据范围较小的情况下。
- **优化思路**：如果数据范围较大，可以考虑使用动态规划或其他优化方法来减少计算量。

### 推荐题目

1. [P1036 选数](https://www.luogu.com.cn/problem/P1036)
2. [P1219 八皇后](https://www.luogu.com.cn/problem/P1219)
3. [P1443 马的遍历](https://www.luogu.com.cn/problem/P1443)

---
处理用时：28.52秒
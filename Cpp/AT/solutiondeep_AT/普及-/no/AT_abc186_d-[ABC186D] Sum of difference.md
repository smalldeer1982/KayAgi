# 题目信息

# [ABC186D] Sum of difference

## 题目描述

### 题意简述
输入 $n$ 个整数 $a_1,a_2,...a_n$，

求在满足 $1 \leq i < j \leq n$ 的所有 $\lvert a_i-a_j \rvert$ 的和 $X$ 。

即求 $X=\sum_{i=1}^{n-1}\sum_{j=i+1}^{n} \lvert a_i-a_j\rvert$ 。

## 样例 #1

### 输入

```
3

5 1 2```

### 输出

```
8```

## 样例 #2

### 输入

```
5

31 41 59 26 53```

### 输出

```
176```

# AI分析结果

### 题目内容重写
#### 题目描述
输入 $n$ 个整数 $a_1,a_2,...a_n$，求在满足 $1 \leq i < j \leq n$ 的所有 $\lvert a_i-a_j \rvert$ 的和 $X$。即求 $X=\sum_{i=1}^{n-1}\sum_{j=i+1}^{n} \lvert a_i-a_j\rvert$。

#### 样例 #1
##### 输入
```
3
5 1 2
```
##### 输出
```
8
```

#### 样例 #2
##### 输入
```
5
31 41 59 26 53
```
##### 输出
```
176
```

### 算法分类
排序、前缀和

### 综合分析与结论
该题的核心在于如何高效计算所有数对之间的绝对差之和。直接暴力枚举所有数对的时间复杂度为 $O(n^2)$，无法通过较大规模的数据。通过排序和前缀和的优化，可以将时间复杂度降低到 $O(n\log n)$，从而高效解决问题。

### 所选题解
#### 题解作者：loser_seele (赞：2)
##### 星级：4星
##### 关键亮点：
1. **排序优化**：通过将数组排序，去掉了绝对值符号，简化了计算。
2. **前缀和优化**：利用前缀和快速计算区间和，进一步优化了时间复杂度。
3. **清晰思路**：详细解释了如何通过排序和前缀和将问题转化为更易计算的形式。

##### 核心代码：
```cpp
#include <bits/stdc++.h>
using namespace std;
const int maxn=2e6+10;
#define int long long
int a[maxn],sum[maxn];
signed main()
{
    int t=1;
    while(t--)
    {
        int n;
        cin>>n;
        for(int i=1;i<=n;i++)
            cin>>a[i];
        sort(a+1,a+n+1);
        for(int i=1;i<=n;i++)
            sum[i]=sum[i-1]+a[i];
        int ans=0;
        for(int i=1;i<=n;i++)
            ans+=sum[n]-sum[i]-(n-i)*a[i];
        cout<<ans<<'\n';
    }
}
```

##### 核心实现思想：
1. 首先对数组进行排序，使得绝对值差的计算简化为直接差。
2. 使用前缀和数组 `sum` 来快速计算任意区间的和。
3. 通过遍历数组，利用前缀和和当前元素的值，计算每个元素对最终答案的贡献。

### 最优关键思路或技巧
1. **排序去绝对值**：通过排序将绝对值差转化为直接差，简化计算。
2. **前缀和优化**：利用前缀和快速计算区间和，避免重复计算。
3. **数学转化**：将问题转化为更易计算的形式，通过数学推导减少计算量。

### 可拓展之处
1. **类似问题**：可以拓展到其他需要计算数对之间某种关系的问题，如数对之和、数对之积等。
2. **优化思路**：在需要计算大量数对关系的问题中，排序和前缀和是常见的优化手段。

### 推荐题目
1. [P1102 A-B数对](https://www.luogu.com.cn/problem/P1102)
2. [P1631 序列合并](https://www.luogu.com.cn/problem/P1631)
3. [P1886 滑动窗口](https://www.luogu.com.cn/problem/P1886)

### 个人心得
在解决需要计算大量数对关系的问题时，排序和前缀和是非常有效的优化手段。通过将问题转化为更易计算的形式，可以显著降低时间复杂度，提高算法的效率。

---
处理用时：23.25秒
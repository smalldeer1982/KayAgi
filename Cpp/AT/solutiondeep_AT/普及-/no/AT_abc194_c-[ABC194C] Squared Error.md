# 题目信息

# [ABC194C] Squared Error

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc194/tasks/abc194_c

長さ $ N $ の数列 $ A $ が与えられます。  
 各要素同士の差の $ 2 $ 乗の和、すなわち $ \displaystyle\ \sum_{i\ =\ 2}^{N}\ \sum_{j\ =\ 1}^{i\ -\ 1}\ (A_i\ -\ A_j)^2 $ を求めてください。

## 说明/提示

### 制約

- $ 2\ \le\ N\ \le\ 3\ \times\ 10^5 $
- $ |A_i|\ \le\ 200 $
- 入力に含まれる値は全て整数

### Sample Explanation 1

$ \sum_{i\ =\ 2}^{N}\ \sum_{j\ =\ 1}^{i\ -\ 1}\ (A_i\ -\ A_j)^2\ =\ (8\ -\ 2)^2\ +\ (4\ -\ 2)^2\ +\ (4\ -\ 8)^2\ =\ 56 $ です。

## 样例 #1

### 输入

```
3

2 8 4```

### 输出

```
56```

## 样例 #2

### 输入

```
5

-5 8 9 -4 -3```

### 输出

```
950```

# AI分析结果

### 题目内容重写

#### [ABC194C] Squared Error

**题目描述**

给定一个长度为 $ N $ 的数列 $ A $。  
求各元素之间差的平方和，即 $ \displaystyle\ \sum_{i\ =\ 2}^{N}\ \sum_{j\ =\ 1}^{i\ -\ 1}\ (A_i\ -\ A_j)^2 $。

**说明/提示**

**约束条件**

- $ 2\ \le\ N\ \le\ 3\ \times\ 10^5 $
- $ |A_i|\ \le\ 200 $
- 输入中的所有值均为整数

**样例解释 1**

$ \sum_{i\ =\ 2}^{N}\ \sum_{j\ =\ 1}^{i\ -\ 1}\ (A_i\ -\ A_j)^2\ =\ (8\ -\ 2)^2\ +\ (4\ -\ 2)^2\ +\ (4\ -\ 8)^2\ =\ 56 $。

**样例 #1**

**输入**

```
3

2 8 4
```

**输出**

```
56
```

**样例 #2**

**输入**

```
5

-5 8 9 -4 -3
```

**输出**

```
950
```

### 算法分类

**数学**

### 题解分析与结论

由于题目要求计算所有元素对的差的平方和，直接使用双重循环会导致时间复杂度过高（$O(N^2)$），无法在给定的约束条件下通过。因此，需要利用数学公式进行优化。

通过数学推导，可以将差的平方和公式转化为：

$$
\sum_{i=2}^{N} \sum_{j=1}^{i-1} (A_i - A_j)^2 = \sum_{i=1}^{N} \sum_{j=1}^{N} (A_i - A_j)^2 - \sum_{i=1}^{N} (A_i - A_i)^2
$$

进一步简化，可以得到：

$$
\sum_{i=1}^{N} \sum_{j=1}^{N} (A_i - A_j)^2 = N \sum_{i=1}^{N} A_i^2 - 2 \sum_{i=1}^{N} A_i \sum_{j=1}^{N} A_j + N \sum_{j=1}^{N} A_j^2
$$

由于 $\sum_{i=1}^{N} (A_i - A_i)^2 = 0$，所以最终公式为：

$$
\sum_{i=2}^{N} \sum_{j=1}^{i-1} (A_i - A_j)^2 = N \sum_{i=1}^{N} A_i^2 - \left( \sum_{i=1}^{N} A_i \right)^2
$$

通过这个公式，可以将时间复杂度降低到 $O(N)$，从而在给定的约束条件下高效地解决问题。

### 关键思路与技巧

1. **数学公式优化**：通过数学推导，将双重循环的平方和问题转化为单重循环的计算问题，极大地降低了时间复杂度。
2. **前缀和与平方和**：利用前缀和和平方和的概念，快速计算总和和平方和，避免重复计算。

### 推荐题目

1. [P3374 【模板】树状数组 1](https://www.luogu.com.cn/problem/P3374)
2. [P3368 【模板】树状数组 2](https://www.luogu.com.cn/problem/P3368)
3. [P3372 【模板】线段树 1](https://www.luogu.com.cn/problem/P3372)

这些题目都涉及到前缀和和区间查询的问题，与本题的数学优化思路有相似之处，可以帮助进一步巩固相关知识点。

---
处理用时：20.10秒
# 题目信息

# [ABC220D] FG operation

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc220/tasks/abc220_d

$ 0 $ 以上 $ 9 $ 以下の整数からなる長さ $ N $ の数列 $ A=(A_1,\dots,A_N) $ があり、この順に左から右に並んでいます。

数列の長さが $ 1 $ になるまで、操作 $ F $ または操作 $ G $ を繰り返し行います。

- 操作 $ F $ ：左端の $ 2 $ つの値 ( $ x,y $ とする ) を削除した後、一番左に $ (x+y)\%10 $ を挿入する
- 操作 $ G $ ：左端の $ 2 $ つの値 ( $ x,y $ とする ) を削除した後、一番左に $ (x\times\ y)\%10 $ を挿入する

なお、$ a\%b $ は $ a $ を $ b $ で割った余りを意味します。

$ K=0,1,\dots,9 $ について、以下の問題に答えてください。

> 操作手順としてあり得るものは $ 2^{N-1} $ 通りありますが、このうち最終的に残る値が $ K $ となる操作手順は何通りありますか？  
>  ただし答えは非常に大きくなる可能性があるので、$ 998244353 $ で割った余りを求めてください。

## 说明/提示

### 制約

- $ 2\ \leq\ N\ \leq\ 10^5 $
- $ 0\ \leq\ A_i\ \leq\ 9 $
- 入力は全て整数

### Sample Explanation 1

$ 1 $ 回目に操作 $ F $ 、$ 2 $ 回目に操作 $ F $ を行ったとき：数列は $ (2,7,6)→(9,6)→(5) $ となります。 $ 1 $ 回目に操作 $ F $ 、$ 2 $ 回目に操作 $ G $ を行ったとき：数列は $ (2,7,6)→(9,6)→(4) $ となります。 $ 1 $ 回目に操作 $ G $ 、$ 2 $ 回目に操作 $ F $ を行ったとき：数列は $ (2,7,6)→(4,6)→(0) $ となります。 $ 1 $ 回目に操作 $ G $ 、$ 2 $ 回目に操作 $ G $ を行ったとき：数列は $ (2,7,6)→(4,6)→(4) $ となります。

## 样例 #1

### 输入

```
3

2 7 6```

### 输出

```
1

0

0

0

2

1

0

0

0

0```

## 样例 #2

### 输入

```
5

0 1 2 3 4```

### 输出

```
6

0

1

1

4

0

1

1

0

2```

# AI分析结果

### 题目重写

#### 题目描述

给定一个长度为 $N$ 的数列 $A=(A_1,\dots,A_N)$，其中每个元素都是 $0$ 到 $9$ 之间的整数。数列中的元素从左到右依次排列。

你需要重复执行操作 $F$ 或操作 $G$，直到数列的长度变为 $1$。

- 操作 $F$：删除最左边的两个元素 $x$ 和 $y$，然后在最左边插入 $(x+y)\%10$。
- 操作 $G$：删除最左边的两个元素 $x$ 和 $y$，然后在最左边插入 $(x \times y)\%10$。

其中，$a\%b$ 表示 $a$ 除以 $b$ 的余数。

对于 $K=0,1,\dots,9$，回答以下问题：

> 在所有可能的 $2^{N-1}$ 种操作序列中，最终剩下的值为 $K$ 的操作序列有多少种？  
> 由于答案可能非常大，请输出其对 $998244353$ 取模的结果。

#### 说明/提示

##### 约束条件

- $2 \leq N \leq 10^5$
- $0 \leq A_i \leq 9$
- 输入均为整数

##### 样例解释 1

- 第一次操作 $F$，第二次操作 $F$：数列 $(2,7,6)→(9,6)→(5)$。
- 第一次操作 $F$，第二次操作 $G$：数列 $(2,7,6)→(9,6)→(4)$。
- 第一次操作 $G$，第二次操作 $F$：数列 $(2,7,6)→(4,6)→(0)$。
- 第一次操作 $G$，第二次操作 $G$：数列 $(2,7,6)→(4,6)→(4)$。

#### 样例 #1

##### 输入

```
3
2 7 6
```

##### 输出

```
1
0
0
0
2
1
0
0
0
0
```

#### 样例 #2

##### 输入

```
5
0 1 2 3 4
```

##### 输出

```
6
0
1
1
4
0
1
1
0
2
```

### 算法分类

动态规划

### 题解分析与结论

由于题目要求计算所有可能的操作序列中最终结果为 $K$ 的数量，且 $N$ 的最大值为 $10^5$，直接枚举所有可能的操作序列是不可行的。因此，我们需要使用动态规划来优化计算过程。

#### 关键思路

1. **状态定义**：设 $dp[i][j]$ 表示处理到第 $i$ 个元素时，当前结果为 $j$ 的方案数。
2. **状态转移**：对于每个元素 $A_i$，我们可以选择执行操作 $F$ 或操作 $G$，并更新当前结果 $j$。
3. **初始状态**：$dp[1][A_1] = 1$，表示初始时只有第一个元素 $A_1$，且结果为 $A_1$ 的方案数为 $1$。
4. **最终结果**：$dp[N][K]$ 即为最终结果为 $K$ 的方案数。

#### 难点

- **状态转移的优化**：由于 $N$ 很大，直接使用二维数组存储 $dp$ 会超出内存限制。因此，我们需要使用滚动数组或其他优化技巧来减少空间复杂度。
- **模运算的处理**：由于结果需要对 $998244353$ 取模，需要在每一步计算中都进行模运算，避免溢出。

### 通用建议与扩展思路

1. **滚动数组优化**：由于 $dp[i][j]$ 只依赖于 $dp[i-1][k]$，可以使用滚动数组来减少空间复杂度。
2. **预处理操作结果**：可以预先计算所有可能的 $x$ 和 $y$ 的操作结果，避免重复计算。
3. **并行计算**：对于不同的 $K$，可以并行计算，提高效率。

### 推荐题目

1. [P1048 采药](https://www.luogu.com.cn/problem/P1048) - 动态规划经典问题，类似于背包问题。
2. [P1060 开心的金明](https://www.luogu.com.cn/problem/P1060) - 动态规划问题，涉及状态转移和优化。
3. [P1091 合唱队形](https://www.luogu.com.cn/problem/P1091) - 动态规划问题，涉及状态转移和优化。

### 个人心得

在处理动态规划问题时，状态定义和状态转移是关键。对于大规模数据，优化空间复杂度和时间复杂度是必不可少的。通过滚动数组和预处理操作结果，可以有效地减少计算量，提高程序效率。

---
处理用时：30.66秒
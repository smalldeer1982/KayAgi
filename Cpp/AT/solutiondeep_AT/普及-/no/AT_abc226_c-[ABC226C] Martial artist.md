# 题目信息

# [ABC226C] Martial artist

## 题目描述

高桥君是一位武术大师，他可以学习 $N$ 种技能，这些技能分别标号为 $1, 2, \ldots, N$。要学习每个技能 $i$，他需要花费 $T_i$ 时间进行修炼，并且在开始时必须已掌握技能 $A_{i,1}, A_{i,2}, \ldots, A_{i,K_i}$。这里保证了，每个前置技能的编号小于当前技能编号，即 $A_{i,j} < i$。

在时刻 $0$，高桥君还没有掌握任何技能。他一次只能进行一个技能的修炼，并且一旦开始修炼，便不能中途停下。你的任务是计算出高桥君学习到技能 $N$ 所需的最短时间。

## 说明/提示

- $1 \leq N \leq 2 \times 10^5$
- $1 \leq T_i \leq 10^9$
- $0 \leq K_i < i$
- $1 \leq A_{i,j} < i$
- $\sum_{i=1}^N K_i \leq 2 \times 10^5$
- $A_{i,1}, A_{i,2}, \ldots, A_{i,K_i}$ 全部互不相同。
- 所有输入均为整数。

### 示例 1
高桥君可以采取这样的修习顺序：
- 他在时刻 $0$ 开始学习技能 $1$，到时刻 $3$ 时掌握此技能。
- 然后，从时刻 $3$ 开始修炼技能 $3$，到时刻 $10$ 时学会此技能。
这样一来，高桥君学习到技能 $3$ 的最短时间为 $3 + 7 = 10$。在这过程中，他不需要掌握技能 $2$。

### 提示 2
请注意，答案可能超过 $32$ 位整数的范围。

 **本翻译由 AI 自动生成**

## 样例 #1

### 输入

```
3

3 0

5 1 1

7 1 1```

### 输出

```
10```

## 样例 #2

### 输入

```
5

1000000000 0

1000000000 0

1000000000 0

1000000000 0

1000000000 4 1 2 3 4```

### 输出

```
5000000000```

# AI分析结果

### 题目重写
高桥君是一位武术大师，他可以学习 $N$ 种技能，这些技能分别标号为 $1, 2, \ldots, N$。要学习每个技能 $i$，他需要花费 $T_i$ 时间进行修炼，并且在开始时必须已掌握技能 $A_{i,1}, A_{i,2}, \ldots, A_{i,K_i}$。这里保证了，每个前置技能的编号小于当前技能编号，即 $A_{i,j} < i$。

在时刻 $0$，高桥君还没有掌握任何技能。他一次只能进行一个技能的修炼，并且一旦开始修炼，便不能中途停下。你的任务是计算出高桥君学习到技能 $N$ 所需的最短时间。

### 算法分类
深度优先搜索 DFS

### 题解分析与结论
题目要求计算学习到技能 $N$ 所需的最短时间，且每个技能的前置技能编号都小于当前技能编号。这意味着我们可以从技能 $N$ 开始，递归地学习所有前置技能，并累加所需时间。

### 所选题解
#### 题解作者：loser_seele
**星级：4星**
**关键亮点：**
1. **反向建图与DFS**：通过反向建图，从技能 $N$ 开始进行DFS，确保所有前置技能都被学习。
2. **时间复杂度优化**：时间复杂度为 $O(m)$，其中 $m$ 是总边数，适合大规模数据。
3. **代码简洁**：代码结构清晰，易于理解。

**核心代码：**
```cpp
void dfs(int n) {
    for(int i=0; i<fa[n].size(); i++) {
        if(!learn[fa[n][i]]) {
            ans += va[fa[n][i]];
            learn[fa[n][i]] = 1;
            dfs(fa[n][i]);
        }
    }
}
```
**代码思想：**
从技能 $n$ 开始，递归地学习所有前置技能，并累加所需时间。使用 `learn` 数组记录已学习的技能，避免重复计算。

### 最优关键思路
1. **反向建图**：从目标技能 $N$ 开始，递归地学习所有前置技能，确保所有依赖关系被满足。
2. **DFS遍历**：通过DFS遍历所有前置技能，确保每个技能只被学习一次，避免重复计算。

### 拓展思路
类似的问题可以出现在任务调度、依赖关系解析等场景中。通过反向建图和DFS，可以有效地解决这类问题。

### 推荐题目
1. [P3379 【模板】最近公共祖先（LCA）](https://www.luogu.com.cn/problem/P3379)
2. [P3388 【模板】割点（割顶）](https://www.luogu.com.cn/problem/P3388)
3. [P3387 【模板】缩点](https://www.luogu.com.cn/problem/P3387)

---
处理用时：19.19秒
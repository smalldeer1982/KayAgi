# 题目信息

# [ABC240D] Strange Balls

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc240/tasks/abc240_d

高橋君は $ 2 $ 以上の整数が書かれた $ N $ 個のボールを持っており、これらを細長い筒の中に落としていきます。$ i\ \,\ (1\ \leq\ i\ \leq\ N) $ 回目には、$ a_i $ が書かれたボールを落とします。

ボールは特殊な材質でできており、筒の中において $ k\ \,\ (k\ \geq\ 2) $ が書かれたボールが $ k $ 個連続すると、それら $ k $ 個のボールは全て消えてしまいます。

各 $ i\ \,\ (1\ \leq\ i\ \leq\ N) $ について、$ i $ 個目のボールを筒の中に落とした後、筒の中に何個のボールがあるか求めてください。

## 说明/提示

### 制約

- $ 1\ \leq\ N\ \leq\ 2\ \times\ 10^5 $
- $ 2\ \leq\ a_i\ \leq\ 2\ \times\ 10^5\ \,\ (1\ \leq\ i\ \leq\ N) $
- 入力は全て整数

### Sample Explanation 1

筒の中は次のように変化します。 - $ 1 $ 個目のボールを落とす。筒の中にあるボールに書かれた整数は $ 3 $ である。 - $ 2 $ 個目のボールを落とす。筒の中にあるボールに書かれた整数は下から順に $ 3,\ 2 $ である。 - $ 3 $ 個目のボールを落とす。筒の中にあるボールに書かれた整数は下から順に $ 3,\ 2,\ 3 $ である。 - $ 4 $ 個目のボールを落とす。筒の中にあるボールに書かれた整数は下から順に $ 3,\ 2,\ 3,\ 2 $ である。 - $ 5 $ 個目のボールを落とす。筒の中にあるボールに書かれた整数は下から順に $ 3,\ 2,\ 3,\ 2,\ 2 $ となるが、$ 2 $ が書かれたボールが $ 2 $ 個連続しているのでこれらは消え、下から順に $ 3,\ 2,\ 3 $ となる。 !\[\](https://img.atcoder.jp/ghi/ABC240D\_sample.png)

## 样例 #1

### 输入

```
5

3 2 3 2 2```

### 输出

```
1

2

3

4

3```

## 样例 #2

### 输入

```
10

2 3 2 3 3 3 2 3 3 2```

### 输出

```
1

2

3

4

5

3

2

3

1

0```

# AI分析结果

### 题目翻译

高橋君有 $N$ 个标有 $2$ 以上整数的球，他将这些球逐个放入一个细长的筒中。第 $i$ 次（$1 \leq i \leq N$）放入的球上标有数字 $a_i$。

这些球由特殊材料制成，当筒中连续出现 $k$ 个标有数字 $k$ 的球时，这些 $k$ 个球会全部消失。

对于每个 $i$（$1 \leq i \leq N$），请输出在第 $i$ 个球放入筒中后，筒中剩余的球的数量。

### 算法分类
模拟

### 综合分析与结论
本题的核心在于模拟球的放入和消失过程。由于球的消失条件是连续出现 $k$ 个标有数字 $k$ 的球，因此我们需要维护一个栈来记录当前筒中的球及其连续出现的次数。每次放入一个新球时，检查是否满足消失条件，如果满足则从栈中移除相应的球，并更新筒中球的数量。

### 关键思路与技巧
1. **栈的使用**：使用栈来模拟球的放入和消失过程，栈中存储的是球的数字及其连续出现的次数。
2. **消失条件的检查**：每次放入新球后，检查栈顶的球是否与新球相同，如果相同则增加连续计数，否则将新球及其计数压入栈中。如果连续计数等于球的数字，则移除这些球。
3. **时间复杂度**：由于每个球最多被压入和弹出栈一次，时间复杂度为 $O(N)$，满足题目要求。

### 推荐题目
1. [P1449 后缀表达式](https://www.luogu.com.cn/problem/P1449) - 考察栈的使用
2. [P1739 表达式括号匹配](https://www.luogu.com.cn/problem/P1739) - 考察栈的应用
3. [P1981 表达式求值](https://www.luogu.com.cn/problem/P1981) - 考察栈的使用和表达式计算

### 核心代码实现
```cpp
#include <iostream>
#include <stack>
using namespace std;

int main() {
    int N;
    cin >> N;
    stack<pair<int, int>> st; // {球的数字, 连续出现的次数}
    int total = 0; // 筒中球的总数

    for (int i = 0; i < N; ++i) {
        int a;
        cin >> a;
        if (!st.empty() && st.top().first == a) {
            st.top().second++;
        } else {
            st.push({a, 1});
        }
        total++;
        if (st.top().second == a) {
            total -= a;
            st.pop();
        }
        cout << total << endl;
    }

    return 0;
}
```

### 代码解释
1. **栈的初始化**：使用 `stack<pair<int, int>>` 来存储球的数字及其连续出现的次数。
2. **球的放入**：每次放入一个新球，检查栈顶的球是否与新球相同，如果相同则增加连续计数，否则将新球及其计数压入栈中。
3. **消失条件的检查**：如果栈顶的球的连续计数等于其数字，则移除这些球，并更新筒中球的总数。
4. **输出结果**：每次操作后输出筒中球的总数。

通过这种模拟方法，可以高效地处理球的放入和消失过程，确保时间复杂度在可接受范围内。

---
处理用时：19.54秒
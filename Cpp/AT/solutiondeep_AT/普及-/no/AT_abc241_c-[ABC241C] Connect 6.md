# 题目信息

# [ABC241C] Connect 6

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc241/tasks/abc241_c

$ N $ 行 $ N $ 列のマス目があり、それぞれのマスは白または黒で塗られています。  
マス目の状態は $ N $ 個の文字列 $ S_i $ で表され、 $ S_i $ の $ j $ 文字目が `#` であることはマス目の上から $ i $ 行目、左から $ j $ 列目のマスが黒く塗られていることを、 `.` であることは白く塗られていることをさします。

高橋君はこのマス目のうち高々 $ 2 $ つの白く塗られているマスを選び、黒く塗ることができます。  
マス目の中に、黒く塗られたマスが縦、横、ななめのいずれかの向きに $ 6 $ つ以上連続するようにできるか判定してください。  
ただし、黒く塗られたマスがななめに $ 6 $ つ以上連続するとは、$ N $ 行 $ N $ 列のマス目に完全に含まれる $ 6 $ 行 $ 6 $ 列のマス目であって、その少なくとも一方の対角線上のマスがすべて黒く塗られているようなものが存在する事をさします。

## 说明/提示

### 制約

- $ 6\ \leq\ N\ \leq\ 1000 $
- $ \lvert\ S_i\rvert\ =N $
- $ S_i $ は `#` と `.` のみからなる。

### Sample Explanation 1

上から $ 3 $ 行目の左から $ 3 $, $ 6 $ 番目のマスを塗ることで横方向に $ 6 $ つの黒く塗られたマスを連続させることができます。

### Sample Explanation 2

高橋君はマス目を新たに黒く塗ることはできませんが、すでにこのマス目は条件をみたしています。

## 样例 #1

### 输入

```
8
........
........
.#.##.#.
........
........
........
........
........```

### 输出

```
Yes```

## 样例 #2

### 输入

```
6
######
######
######
######
######
######```

### 输出

```
Yes```

## 样例 #3

### 输入

```
10
..........
#..##.....
..........
..........
....#.....
....#.....
.#...#..#.
..........
..........
..........```

### 输出

```
No```

# AI分析结果

【题目内容】
# [ABC241C] Connect 6

## 题目描述

$ N $ 行 $ N $ 列的网格，每个格子被涂成白色或黑色。  
网格的状态由 $ N $ 个字符串 $ S_i $ 表示，$ S_i $ 的第 $ j $ 个字符为 `#` 表示网格的第 $ i $ 行第 $ j $ 列的格子被涂成黑色，`.` 表示被涂成白色。

高桥君可以选择最多两个白色格子涂成黑色。  
判断是否可以通过这种方式使得网格中存在至少一个方向（横向、纵向或对角线）上有连续六个或更多的黑色格子。  
其中，对角线方向上连续六个或更多的黑色格子指的是在 $ N \times N $ 的网格中存在一个完全包含的 $ 6 \times 6 $ 子网格，且该子网格的至少一条对角线上的所有格子都被涂成黑色。

## 说明/提示

### 制約

- $ 6\ \leq\ N\ \leq\ 1000 $
- $ \lvert\ S_i\rvert\ =N $
- $ S_i $ 仅包含 `#` 和 `.`。

### 样例解释 1

将第 3 行的第 3 和第 6 列的格子涂成黑色，可以在横向方向上形成连续六个黑色格子。

### 样例解释 2

高桥君不需要涂任何格子，因为网格已经满足条件。

## 样例 #1

### 输入

```
8
........
........
.#.##.#.
........
........
........
........
........```

### 输出

```
Yes```

## 样例 #2

### 输入

```
6
######
######
######
######
######
######```

### 输出

```
Yes```

## 样例 #3

### 输入

```
10
..........
#..##.....
..........
..........
....#.....
....#.....
.#...#..#.
..........
..........
..........```

### 输出

```
No```

【算法分类】
枚举

【综合分析】
本题的核心在于枚举所有可能的涂色方案，并检查是否存在满足条件的连续六个黑色格子。由于网格大小为 $ N \times N $，且 $ N $ 最大为 1000，直接枚举所有可能的涂色方案会超出时间限制。因此，需要优化枚举策略，减少不必要的计算。

【通用建议与扩展思路】
1. **优化枚举策略**：可以通过预处理网格，记录每个方向上可能形成连续六个黑色格子的位置，然后在这些位置中枚举涂色方案。
2. **剪枝**：在枚举过程中，如果发现某个方向已经无法形成连续六个黑色格子，可以提前终止该方向的枚举。
3. **并行计算**：对于大规模网格，可以考虑使用并行计算来加速枚举过程。

【推荐题目】
1. [P1219 八皇后](https://www.luogu.com.cn/problem/P1219)
2. [P1036 选数](https://www.luogu.com.cn/problem/P1036)
3. [P1141 01迷宫](https://www.luogu.com.cn/problem/P1141)

---
处理用时：16.59秒
# 题目信息

# [ABC258C] Rotation

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc258/tasks/abc258_c

正整数 $ N,Q $ と、長さ $ N $ の英小文字からなる文字列 $ S $ が与えられます。

以下で説明されるクエリを $ Q $ 個処理してください。クエリは次の $ 2 $ 種類のいずれかです。

- `1 x`: 「$ S $ の末尾の文字を削除し、先頭に挿入する」という操作を $ x $ 回連続で行う。
- `2 x`: $ S $ の $ x $ 番目の文字を出力する。

## 说明/提示

### 制約

- $ 2\ \le\ N\ \le\ 5\ \times\ 10^5 $
- $ 1\ \le\ Q\ \le\ 5\ \times\ 10^5 $
- $ 1\ \le\ x\ \le\ N $
- $ |S|=N $
- $ S $ は英小文字からなる。
- `2 x` の形式のクエリが $ 1 $ 個以上与えられる。
- $ N,Q,x $ はすべて整数。

### Sample Explanation 1

$ 1 $ 個目のクエリのとき、$ S $ は `abc` なので $ 2 $ 文字目の `b` を出力します。 $ 2 $ 個目のクエリのとき、$ S $ は `abc` から `cab` に変わります。 $ 3 $ 個目のクエリのとき、$ S $ は `cab` なので $ 2 $ 文字目の `a` を出力します。

## 样例 #1

### 输入

```
3 3
abc
2 2
1 1
2 2```

### 输出

```
b
a```

## 样例 #2

### 输入

```
10 8
dsuccxulnl
2 4
2 7
1 2
2 7
1 1
1 2
1 3
2 5```

### 输出

```
c
u
c
u```

# AI分析结果

### 题目内容重写

【题目描述】

给定正整数 $ N,Q $ 和一个长度为 $ N $ 的由小写字母组成的字符串 $ S $。

你需要处理 $ Q $ 个查询，查询分为以下两种类型：

- `1 x`：将 $ S $ 的末尾字符删除，并将其插入到字符串的开头，重复此操作 $ x $ 次。
- `2 x`：输出 $ S $ 的第 $ x $ 个字符。

### 算法分类
模拟、字符串

### 综合分析与结论
本题的核心在于如何处理大量的查询操作，特别是类型1的旋转操作。由于 $ N $ 和 $ Q $ 都可能达到 $ 5 \times 10^5 $，直接模拟旋转操作会导致时间复杂度过高。因此，优化思路是避免实际旋转字符串，而是通过记录旋转的次数来间接计算字符的位置。

### 通用建议与扩展思路
1. **优化思路**：通过记录旋转的总次数，可以在查询时直接计算字符的位置，而不需要实际旋转字符串。这种方法将时间复杂度从 $ O(Q \times N) $ 降低到 $ O(Q) $。
2. **数据结构**：可以使用一个变量来记录旋转的总次数，然后在查询时通过模运算来确定字符的位置。
3. **扩展应用**：类似的问题可以出现在需要频繁修改字符串的场景中，如循环队列、环形缓冲区等。

### 推荐题目
1. [P3375 【模板】KMP字符串匹配](https://www.luogu.com.cn/problem/P3375)
2. [P3805 【模板】Manacher算法](https://www.luogu.com.cn/problem/P3805)
3. [P3369 【模板】普通平衡树](https://www.luogu.com.cn/problem/P3369)

### 关键代码实现
```cpp
#include <bits/stdc++.h>
using namespace std;

int main() {
    int N, Q;
    string S;
    cin >> N >> Q >> S;
    
    int shift = 0; // 记录旋转的总次数
    
    while (Q--) {
        int t, x;
        cin >> t >> x;
        if (t == 1) {
            shift = (shift + x) % N;
        } else {
            int pos = (N - shift + x - 1) % N;
            cout << S[pos] << endl;
        }
    }
    
    return 0;
}
```

### 核心实现思想
1. **shift变量**：用于记录字符串旋转的总次数。
2. **模运算**：在查询时，通过模运算计算字符的实际位置，避免实际旋转字符串。
3. **时间复杂度**：通过这种方法，每个查询操作的时间复杂度为 $ O(1) $，整体时间复杂度为 $ O(Q) $。

### 个人心得
在处理大规模数据时，避免直接模拟操作是关键。通过数学方法（如模运算）来间接计算结果，可以显著提高程序的效率。这种思路在字符串处理、数组旋转等问题中非常有用。

---
处理用时：18.27秒
# 题目信息

# [ABC268C] Chinese Restaurant

## 题目描述

#### 题意
有 $N$ 个人从 $0$ 开始编号， 按逆时针顺序间隔均匀地坐在转盘周围。 在开始时， 第 $p_{i}$ 盘菜在第 $i$ 个人的前面。  

现在， 你可以进行以下操作 $0$ 次或多次。

- 将转盘逆时针旋转 $\frac{1}{N}$ 圈。也就是说， 旋转前在第 $i$ 号人面前的盘子现在在 $(i+1)\bmod N$ 号人面前了。

当你结束操作后，如果第 $i$ 盘菜在第 $(i-1)\bmod N$ 个人、第 $i$ 个人或第  $(i+1)\bmod N$ 个人面前，第 $i$ 个人就会感到高兴。

请求出你最多能使多少人感到高兴。

## 说明/提示

- $3 \leq N \leq 2 × 10^{5} $
- $0 \leq p_{i} \leq N - 1$
- 当 $i \ne j$ 时 $p_{i}\ne p_{j}$
- 所有输入都是整数

---

## 样例 #1

### 输入

```
4

1 2 0 3```

### 输出

```
4```

## 样例 #2

### 输入

```
3

0 1 2```

### 输出

```
3```

## 样例 #3

### 输入

```
10

3 9 6 1 7 2 8 0 5 4```

### 输出

```
5```

# AI分析结果

### 题目内容
有 $N$ 个人从 $0$ 开始编号，按逆时针顺序间隔均匀地坐在转盘周围。在开始时，第 $p_{i}$ 盘菜在第 $i$ 个人的前面。  

现在，你可以进行以下操作 $0$ 次或多次。

- 将转盘逆时针旋转 $\frac{1}{N}$ 圈。也就是说，旋转前在第 $i$ 号人面前的盘子现在在 $(i+1)\bmod N$ 号人面前了。

当你结束操作后，如果第 $i$ 盘菜在第 $(i-1)\bmod N$ 个人、第 $i$ 个人或第 $(i+1)\bmod N$ 个人面前，第 $i$ 个人就会感到高兴。

请求出你最多能使多少人感到高兴。

### 算法分类
模拟、数学

### 分析与结论
本题的核心在于通过模拟转盘的旋转，计算每个旋转位置下能够使多少人感到高兴，并找出最大值。由于转盘的旋转是周期性的，我们可以通过计算每个旋转位置下的满意度来避免重复计算。

### 关键思路
1. **旋转模拟**：通过计算每个旋转位置下，每个盘子与对应人的位置关系，统计满足条件的人数。
2. **周期性优化**：由于旋转 $N$ 次后会回到初始状态，因此只需要计算 $N$ 个旋转位置即可。
3. **位置关系计算**：对于每个旋转位置 $k$，计算每个盘子 $p_i$ 的位置 $(p_i + k) \bmod N$，判断是否在 $i-1$、$i$ 或 $i+1$ 的位置。

### 代码实现
```cpp
#include <bits/stdc++.h>
using namespace std;

int main() {
    int N;
    cin >> N;
    vector<int> p(N);
    for (int i = 0; i < N; ++i) {
        cin >> p[i];
    }
    
    vector<int> cnt(N, 0);
    for (int i = 0; i < N; ++i) {
        int pos = (p[i] - i + N) % N;
        cnt[pos]++;
        cnt[(pos + 1) % N]++;
        cnt[(pos - 1 + N) % N]++;
    }
    
    int max_happy = 0;
    for (int i = 0; i < N; ++i) {
        max_happy = max(max_happy, cnt[i]);
    }
    
    cout << max_happy << endl;
    return 0;
}
```

### 代码说明
1. **输入处理**：读取 $N$ 和 $p$ 数组。
2. **统计满意度**：对于每个盘子 $p_i$，计算其在每个旋转位置下的满意度，并累加到 `cnt` 数组中。
3. **找出最大值**：遍历 `cnt` 数组，找出最大值即为最多能使多少人感到高兴。

### 推荐题目
1. [P1003 铺地毯](https://www.luogu.com.cn/problem/P1003) - 模拟题，考察如何通过模拟操作解决问题。
2. [P1047 校门外的树](https://www.luogu.com.cn/problem/P1047) - 模拟题，考察如何通过模拟操作统计结果。
3. [P1056 排座椅](https://www.luogu.com.cn/problem/P1056) - 模拟题，考察如何通过模拟操作优化结果。

### 总结
本题通过模拟转盘的旋转，结合周期性优化，能够高效地计算出最多能使多少人感到高兴。关键点在于理解旋转的周期性以及如何通过位置关系计算满意度。

---
处理用时：18.86秒
# 题目信息

# [ABC300D] AABCC

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc300/tasks/abc300_d

$ N $ 以下の正整数のうち、 $ a\ <\ b\ <\ c $ なる **素数** $ a,b,c $ を用いて $ a^2\ \times\ b\ \times\ c^2 $ と表せるものはいくつありますか?

## 说明/提示

### 制約

- $ N $ は $ 300\ \le\ N\ \le\ 10^{12} $ を満たす整数

### Sample Explanation 1

$ 1000 $ 以下で条件を満たす整数は以下の $ 3 $ つです。 - $ 300\ =\ 2^2\ \times\ 3\ \times\ 5^2 $ - $ 588\ =\ 2^2\ \times\ 3\ \times\ 7^2 $ - $ 980\ =\ 2^2\ \times\ 5\ \times\ 7^2 $

## 样例 #1

### 输入

```
1000```

### 输出

```
3```

## 样例 #2

### 输入

```
1000000000000```

### 输出

```
2817785```

# AI分析结果

【题目内容】
# [ABC300D] AABCC

## 题目描述

给定一个正整数 $N$，求有多少个不超过 $N$ 的正整数可以表示为 $a^2 \times b \times c^2$，其中 $a, b, c$ 是满足 $a < b < c$ 的素数。

## 说明/提示

### 制約

- $300 \le N \le 10^{12}$

### 样例解释 1

$1000$ 以下满足条件的整数有 $3$ 个：
- $300 = 2^2 \times 3 \times 5^2$
- $588 = 2^2 \times 3 \times 7^2$
- $980 = 2^2 \times 5 \times 7^2$

## 样例 #1

### 输入

```
1000
```

### 输出

```
3
```

## 样例 #2

### 输入

```
1000000000000
```

### 输出

```
2817785
```

【算法分类】  
质数、枚举

【题解分析与结论】  
该题目要求枚举满足条件的素数三元组 $(a, b, c)$，并计算满足 $a^2 \times b \times c^2 \le N$ 的个数。由于 $N$ 的范围较大（$10^{12}$），直接暴力枚举会超时，因此需要优化枚举策略。

大多数题解采用了以下优化思路：
1. **预处理素数**：先筛出一定范围内的素数（如 $10^6$ 以内的素数），减少枚举范围。
2. **剪枝优化**：在枚举过程中，通过判断当前乘积是否超过 $N$ 来提前终止循环，减少不必要的计算。
3. **二分查找**：部分题解通过二分查找来快速确定 $b$ 的取值范围，进一步优化时间复杂度。

【评分较高的题解】

1. **作者：lzyqwq (赞：6)**  
   **星级：★★★★★**  
   **关键亮点**：通过枚举 $a \times c$，并利用线性筛预处理质数，结合二分查找优化 $b$ 的枚举范围，时间复杂度为 $O(\sqrt{N})$，效率较高。  
   **核心代码**：
   ```cpp
   for(int i=sqrt(n);i>=10;--i){
       if(num[i]!=2||tot[i]!=2) continue;
       int k=n/(i*i);
       if(k<=L[i]) continue;
       if(R[i]-L[i]<=1) continue;
       ans+=s[min(k,R[i]-1)]-s[L[i]];
   }
   ```
   **个人心得**：通过将问题转化为枚举 $a \times c$，大大减少了枚举量，同时利用线性筛预处理质数，提高了代码效率。

2. **作者：DengDuck (赞：4)**  
   **星级：★★★★☆**  
   **关键亮点**：通过筛出 $10^6$ 以内的质数，并利用二分查找优化 $c$ 的枚举范围，时间复杂度为 $O(\sqrt{n} \log n)$，代码清晰易读。  
   **核心代码**：
   ```cpp
   for(int i=1;i<=tot[0]&&pd(i);i++){
       for(int j=i+1;j<=tot[0]&&pd2(i,j);j++){
           LL l=j+1,r=tot[0],ans=0;
           while(l<=r){
               LL mid=(l+r)/2;
               if(pd3(i,j,mid)) ans=mid,l=mid+1;
               else r=mid-1;
           }
           if(ans>=j+1) cnt+=ans-j;
       }
   }
   ```
   **个人心得**：通过二分查找优化 $c$ 的枚举范围，减少了不必要的计算，代码实现简洁。

3. **作者：lfxxx (赞：1)**  
   **星级：★★★★☆**  
   **关键亮点**：通过枚举 $a, c$，并利用预处理质数表快速计算 $b$ 的取值范围，时间复杂度为 $O(\sqrt{n})$，代码简洁高效。  
   **核心代码**：
   ```cpp
   for(int i=1;a[i]*a[i]*a[i+1]*a[i+2]*a[i+2]<=n;i++){
       for(int j=i+2;a[i]*a[i]*a[i+1]*a[j]*a[j]<=n;j++){
           ans+=max(0ll,s[min(a[j]-1,n/a[i]/a[i]/a[j]/a[j])]-s[a[i]]);
       }
   }
   ```
   **个人心得**：通过预处理质数表，快速计算 $b$ 的取值范围，代码实现简洁高效。

【最优关键思路或技巧】  
1. **预处理质数**：通过筛法预处理质数表，减少枚举范围。
2. **剪枝优化**：在枚举过程中，通过判断当前乘积是否超过 $N$ 来提前终止循环，减少不必要的计算。
3. **二分查找**：通过二分查找优化 $b$ 或 $c$ 的枚举范围，进一步减少时间复杂度。

【可拓展之处】  
类似的问题可以通过预处理质数表、剪枝优化和二分查找等技巧来提高效率。例如，求解满足特定条件的素数组合问题，都可以采用类似的优化策略。

【推荐题目】  
1. [P3383 【模板】线性筛素数](https://www.luogu.com.cn/problem/P3383)  
2. [P1217 [USACO1.5]回文质数 Prime Palindromes](https://www.luogu.com.cn/problem/P1217)  
3. [P1075 [NOIP2012 普及组] 质因数分解](https://www.luogu.com.cn/problem/P1075)

---
处理用时：29.76秒
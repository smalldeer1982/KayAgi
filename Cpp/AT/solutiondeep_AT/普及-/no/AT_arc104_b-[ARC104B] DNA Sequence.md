# 题目信息

# [ARC104B] DNA Sequence

## 题目描述

[problemUrl]: https://atcoder.jp/contests/arc104/tasks/arc104_b

`A`, `T`, `C`, `G` から成る長さ $ N $ の文字列 $ S $ があります。

長さの等しい文字列 $ T_1,\ T_2 $ が相補的とは、$ |T_1|\ =\ l $ としたとき、どの $ 1\ \leq\ i\ \leq\ l $ についても $ T_1,\ T_2 $ の $ i $ 文字目の組み合わせが (`A`と`T`), または (`C` と `G`) の組み合わせのいずれかであることを指します。(例えば `A` と `T` の組み合わせのとき、どちらの文字が $ T_1 $ に属してもよいです)

$ S $ の連続する空でない部分文字列 $ T $ であって、次の条件を満たすものの個数を求めてください。

- $ T $ と相補的であるような、$ T $ の文字を並び替えた文字列が存在する。

ただし、文字列として同じであっても $ S $ 内の位置が異なれば違う部分列とみなします。

## 说明/提示

### 制約

- $ 1\ \leq\ N\ \leq\ 5000 $
- $ S $ は `A`, `T`, `C`, `G` のみから成る

### Sample Explanation 1

次の $ 2 $ つの部分文字列が条件を満たします。 - `GC` ($ 2 $ 文字目から $ 3 $ 文字目) は、これを並び替えた `CG` と相補的です。 - `AGCT` ($ 1 $ 文字目から $ 4 $ 文字目) は、これを並び替えた `TCGA` と相補的です。

### Sample Explanation 2

次の $ 4 $ つの部分文字列が条件を満たします。 - `AT` ($ 1 $ 文字目から $ 2 $ 文字目) は、これを並び替えた `TA` と相補的です。 - `TA` ($ 2 $ 文字目から $ 3 $ 文字目) は、これを並び替えた `AT` と相補的です。 - `AT` ($ 3 $ 文字目から $ 4 $ 文字目) は、これを並び替えた `TA` と相補的です。 - `ATAT` ($ 1 $ 文字目から $ 4 $ 文字目) は、これを並び替えた `TATA` と相補的です。

## 样例 #1

### 输入

```
4 AGCT```

### 输出

```
2```

## 样例 #2

### 输入

```
4 ATAT```

### 输出

```
4```

## 样例 #3

### 输入

```
10 AAATACCGCG```

### 输出

```
6```

# AI分析结果

【题目内容】
# [ARC104B] DNA Sequence

## 题目描述

`A`, `T`, `C`, `G` 组成的长度为 $ N $ 的字符串 $ S $。

长度相等的字符串 $ T_1,\ T_2 $ 被称为相补的，当且仅当对于所有 $ 1\ \leq\ i\ \leq\ l $，$ T_1,\ T_2 $ 的第 $ i $ 个字符的组合是 (`A` 和 `T`) 或 (`C` 和 `G`) 中的一种。（例如，`A` 和 `T` 的组合中，哪个字符属于 $ T_1 $ 都可以）

求 $ S $ 中满足以下条件的非空连续子串 $ T $ 的个数：

- 存在一个 $ T $ 的字符重新排列后的字符串，与 $ T $ 相补。

注意，即使字符串相同，只要在 $ S $ 中的位置不同，就视为不同的子串。

## 说明/提示

### 制約

- $ 1\ \leq\ N\ \leq\ 5000 $
- $ S $ 仅由 `A`, `T`, `C`, `G` 组成

### 样例解释 1

以下 $ 2 $ 个子串满足条件：
- `GC`（第 $ 2 $ 到 $ 3 $ 个字符）可以重新排列为 `CG`，与 `GC` 相补。
- `AGCT`（第 $ 1 $ 到 $ 4 $ 个字符）可以重新排列为 `TCGA`，与 `AGCT` 相补。

### 样例解释 2

以下 $ 4 $ 个子串满足条件：
- `AT`（第 $ 1 $ 到 $ 2 $ 个字符）可以重新排列为 `TA`，与 `AT` 相补。
- `TA`（第 $ 2 $ 到 $ 3 $ 个字符）可以重新排列为 `AT`，与 `TA` 相补。
- `AT`（第 $ 3 $ 到 $ 4 $ 个字符）可以重新排列为 `TA`，与 `AT` 相补。
- `ATAT`（第 $ 1 $ 到 $ 4 $ 个字符）可以重新排列为 `TATA`，与 `ATAT` 相补。

## 样例 #1

### 输入

```
4 AGCT```

### 输出

```
2```

## 样例 #2

### 输入

```
4 ATAT```

### 输出

```
4```

## 样例 #3

### 输入

```
10 AAATACCGCG```

### 输出

```
6```

【算法分类】
字符串

【题解分析与结论】
该题的核心在于判断一个子串是否可以通过重新排列得到一个与其相补的字符串。由于相补的条件是字符对 `A-T` 和 `C-G`，因此我们可以通过统计子串中 `A` 和 `T` 的数量是否相等，以及 `C` 和 `G` 的数量是否相等来判断。

由于题目要求子串必须是连续的，且 $ N $ 的最大值为 $ 5000 $，因此我们可以使用双重循环枚举所有可能的子串，并在内层循环中统计字符数量。这种方法的时间复杂度为 $ O(N^2) $，在 $ N = 5000 $ 时仍然可以接受。

【通用建议与扩展思路】
1. **优化思路**：可以通过前缀和优化字符统计的过程，减少内层循环的计算量。
2. **类似题目**：类似的问题可以扩展到其他字符匹配问题，例如判断子串是否可以通过重新排列得到回文串等。
3. **数据结构**：可以使用哈希表来存储字符的统计结果，进一步优化查询效率。

【推荐题目】
1. [P3375 【模板】KMP字符串匹配](https://www.luogu.com.cn/problem/P3375)
2. [P3805 【模板】Manacher算法](https://www.luogu.com.cn/problem/P3805)
3. [P3369 【模板】普通平衡树](https://www.luogu.com.cn/problem/P3369)

【个人心得】
在处理字符串问题时，统计字符数量是一个常见的操作。通过合理的数据结构（如哈希表）和算法优化（如前缀和），可以显著提高代码的效率。此外，理解问题的核心条件（如字符对 `A-T` 和 `C-G`）是解决问题的关键。

---
处理用时：28.15秒
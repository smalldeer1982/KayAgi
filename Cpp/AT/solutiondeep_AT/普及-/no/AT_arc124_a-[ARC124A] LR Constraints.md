# 题目信息

# [ARC124A] LR Constraints

## 题目描述

[problemUrl]: https://atcoder.jp/contests/arc124/tasks/arc124_a

$ N $ 枚のカードが左から右に並んでいます。 各カードに $ 1 $ 以上 $ K $ 以下の整数を書き込みます。はじめ、どのカードにも整数は書かれていません。

$ 1 $ から $ K $ の番号がついた $ K $ 個の制約が与えられます。 制約 $ i $ は文字 $ c_i $ と整数 $ k_i $ からなります。 $ c_i $ が `L` ならば、$ i $ が書かれたカードのうち最も **左** にあるものは $ N $ 枚のカードのうち左から $ k_i $ 番目である必要があります。$ c_i $ が `R` ならば、$ i $ が書かれたカードのうち最も **右** にあるものは $ N $ 枚のカードのうち左から $ k_i $ 番目である必要があります。

$ 1 $ 以上 $ K $ 以下の各整数 $ i $ について、$ i $ が書かれたカードが少なくとも $ 1 $ つ存在する必要があることに注意してください。

上記の $ K $ 個の制約をすべて満たすようなカードへの整数の書き込み方の個数を $ 998244353 $ で割ったあまりを求めてください。

## 说明/提示

### 制約

- $ 1\ \leq\ N,K\ \leq\ 1000 $
- $ c_i $ は `L`, `R` のいずれか
- $ 1\ \leq\ k_i\ \leq\ N $
- $ i\ \neq\ j $ ならば $ k_i\ \neq\ k_j $

### Sample Explanation 1

\- 左から $ 1 $ 番目のカードに $ 1 $ を、$ 2 $ 番目のカードに $ 2 $ を、$ 3 $ 番目のカードに $ 1 $ を書き込むのが $ 2 $ つの制約を満たすような唯一の書き込み方です。

### Sample Explanation 2

\- $ 998244353 $ で割ったあまりを求めるのを忘れずに。

## 样例 #1

### 输入

```
3 2

L 1

R 2```

### 输出

```
1```

## 样例 #2

### 输入

```
30 10

R 6

R 8

R 7

R 25

L 26

L 13

R 14

L 11

L 23

R 30```

### 输出

```
343921442```

# AI分析结果

### 题目内容重写

$ N $ 张卡片从左到右排列。每张卡片上需要写入 $ 1 $ 到 $ K $ 之间的整数。初始时，所有卡片上都没有数字。

有 $ K $ 个约束条件，编号为 $ 1 $ 到 $ K $。每个约束条件由字符 $ c_i $ 和整数 $ k_i $ 组成。如果 $ c_i $ 是 `L`，则编号为 $ i $ 的卡片中最左边的卡片必须是第 $ k_i $ 张卡片。如果 $ c_i $ 是 `R`，则编号为 $ i $ 的卡片中最右边的卡片必须是第 $ k_i $ 张卡片。

需要注意的是，对于每个 $ 1 $ 到 $ K $ 的整数 $ i $，至少有一张卡片上必须写有 $ i $。

求满足所有约束条件的卡片写入方式的数量，结果对 $ 998244353 $ 取模。

### 算法分类
组合数学

### 分析与结论

该题目要求计算满足多个约束条件的卡片写入方式的数量。由于每个约束条件限制了某个数字的最左或最右出现位置，因此我们需要通过组合数学的方法来计算可能的排列方式。

### 通用建议与扩展思路

1. **组合数学**：本题的核心在于如何利用组合数学的方法计算满足约束条件的排列数。可以通过确定每个数字的出现位置，然后计算剩余位置的自由选择数。
2. **模拟与枚举**：可以通过模拟每个约束条件，逐步缩小可能的排列范围，最终计算满足所有条件的排列数。
3. **优化与剪枝**：在处理大规模数据时，可以通过剪枝和优化技术减少计算量，提高算法效率。

### 推荐题目
1. [P1351 组合数问题](https://www.luogu.com.cn/problem/P1351)
2. [P2822 组合数问题](https://www.luogu.com.cn/problem/P2822)
3. [P3807 卢卡斯定理](https://www.luogu.com.cn/problem/P3807)

### 关键思路与技巧
1. **确定约束条件的影响范围**：对于每个约束条件，确定其影响的卡片范围，并计算该范围内的自由选择数。
2. **组合数的计算**：利用组合数公式计算满足条件的排列数，注意处理大数取模的问题。
3. **逐步缩小范围**：通过逐步处理每个约束条件，缩小可能的排列范围，最终得到满足所有条件的排列数。

### 代码实现
```cpp
#include <bits/stdc++.h>
using namespace std;
const int MOD = 998244353;

int main() {
    int N, K;
    cin >> N >> K;
    vector<pair<char, int>> constraints(K);
    for (int i = 0; i < K; ++i) {
        cin >> constraints[i].first >> constraints[i].second;
    }

    // 处理约束条件，计算满足条件的排列数
    // 此处省略具体实现细节

    cout << result << endl;
    return 0;
}
```

### 总结
本题的关键在于利用组合数学的方法计算满足多个约束条件的排列数。通过确定每个约束条件的影响范围，并逐步缩小可能的排列范围，可以有效地解决问题。在处理大规模数据时，需要注意优化和剪枝技术的应用，以提高算法效率。

---
处理用时：18.86秒
# 题目信息

# Feel the  Beat

## 题目描述

[problemUrl]: https://atcoder.jp/contests/soundhound2018-summer-final/tasks/soundhound2018_summer_final_a

BPM (Beat Per Minute) とは、楽曲の速さを表す数値です。

Kenkoooo さんは、BPM が $ 140 $ 以上 $ 170 $ 未満の中速曲が好きです。 また、BPM を何回か $ 2 $ で割ると $ 140 $ 以上 $ 170 $ 未満となる曲も好きです。 このどちらにも当てはまらない曲は好きではありません。

例えば、Kenkoooo さんは BPM が $ 679 $ ($ 2 $ で $ 2 $ 回割ると $ 169.75 $) の曲は好きですが、 BPM が $ 680 $ ($ 2 $ で $ 2 $ 回割ると $ 170 $) の曲は好きではありません。

ここに $ 1 $ 枚の CD があり、$ D\ -\ C $ 曲の楽曲が収録されています。 これらの曲の BPM はそれぞれ $ C,\ C+1,\ C+2,\ ...,\ D-2,\ D-1 $ です。 このうち、Kenkoooo さんが好きな曲は何曲あるでしょうか？

## 说明/提示

### 制約

- $ 140\ <\ =\ C\ <\ D\ <\ =\ 10^{15} $
- $ C,\ D $ は整数である。

### Sample Explanation 1

この例では、CD には BPM $ 160,\ 161,\ 162,\ ...,\ 298,\ 299 $ の $ 140 $ 曲が収録されています。 このうち、Kenkoooo さんが好きな曲は BPM $ 160,\ 161,\ 162,\ ...,\ 168,\ 169 $ の $ 10 $ 曲と BPM $ 280,\ 281,\ 282,\ ...,\ 298,\ 299 $ の $ 20 $ 曲、合計 $ 30 $ 曲です。

### Sample Explanation 2

Kenkoooo さんの好みに合わないアルバムです。

### Sample Explanation 3

Kenkoooo さんの世界の CD の容量に上限はなく、収録曲数が $ 32 $ bit 整数型に収まらないこともあります。

## 样例 #1

### 输入

```
160 300```

### 输出

```
30```

## 样例 #2

### 输入

```
340 560```

### 输出

```
0```

## 样例 #3

### 输入

```
140 1000000000000000```

### 输出

```
263882790666210```

# AI分析结果

### 题目内容重写

**Feel the Beat**

**题目描述**

BPM（Beat Per Minute）是表示乐曲速度的数值。

Kenkoooo 喜欢 BPM 在 140 以上 170 以下的中速曲。此外，Kenkoooo 也喜欢那些通过多次除以 2 后 BPM 落在 140 以上 170 以下的曲子。不符合这两种情况的曲子，Kenkoooo 不喜欢。

例如，Kenkoooo 喜欢 BPM 为 679 的曲子（因为 679 除以 2 两次后得到 169.75），但不喜欢 BPM 为 680 的曲子（因为 680 除以 2 两次后得到 170）。

现在有一张 CD，收录了从 BPM 为 C 到 D-1 的 D-C 首曲子。请问其中有多少首曲子是 Kenkoooo 喜欢的？

**说明/提示**

**约束**

- 140 ≤ C < D ≤ 10^15
- C 和 D 是整数。

**样例解释**

**样例 1**

输入：
```
160 300
```
输出：
```
30
```
解释：CD 中收录了 BPM 从 160 到 299 的 140 首曲子。其中，Kenkoooo 喜欢的曲子有 BPM 从 160 到 169 的 10 首和 BPM 从 280 到 299 的 20 首，总共 30 首。

**样例 2**

输入：
```
340 560
```
输出：
```
0
```
解释：Kenkoooo 不喜欢这张 CD 中的任何曲子。

**样例 3**

输入：
```
140 1000000000000000
```
输出：
```
263882790666210
```
解释：Kenkoooo 的世界中，CD 的容量没有上限，收录的曲子数量可能超过 32 位整数的范围。

### 算法分类

**数学**

### 题解分析与结论

所有题解的核心思路都是通过逆向思维，从 140 到 170 的范围出发，不断乘以 2，计算这些范围与给定区间 [C, D] 的交集大小。这种方法避免了直接枚举 [C, D] 区间内的每个数，从而将时间复杂度从 O(D-C) 降低到 O(log D)。

### 高星题解推荐

#### 题解 1：York佑佑

**星级：4.5**

**关键亮点：**
- 思路清晰，代码简洁。
- 通过 while 循环不断扩展 [l, r] 区间，并计算与 [C, D] 的交集。
- 最后再做一次交集计算，确保不遗漏。

**核心代码：**
```cpp
while (r <= d) {
    ans += max(min(r, d) - max(c, l), 0ll);
    r *= 2, l *= 2;
}
ans += max(min(r, d) - max(c, l), 0ll);
```

#### 题解 2：lihongqian__int128

**星级：4.5**

**关键亮点：**
- 代码简洁，逻辑清晰。
- 使用 `i` 和 `j` 分别表示 [140, 170] 的左右边界，通过不断乘以 2 来扩展范围。
- 时间复杂度为 O(log D)，效率高。

**核心代码：**
```cpp
while(i < d) {
    ans += max(0ll , min(d , j) - max(c , i)) ;
    i <<= 1 , j <<= 1 ;
}
```

#### 题解 3：chl090410

**星级：4**

**关键亮点：**
- 代码简洁，逻辑清晰。
- 通过 while 循环不断扩展 [ll, rr] 区间，并计算与 [l, r] 的交集。
- 时间复杂度为 O(log D)，效率高。

**核心代码：**
```cpp
while(ll < r){
    ans += max(min(r, rr) - max(l, ll), 0ll);
    ll *= 2; rr *= 2;
}
```

### 最优关键思路

通过逆向思维，从 140 到 170 的范围出发，不断乘以 2，计算这些范围与给定区间 [C, D] 的交集大小。这种方法避免了直接枚举 [C, D] 区间内的每个数，从而将时间复杂度从 O(D-C) 降低到 O(log D)。

### 可拓展之处

这种逆向思维的方法可以应用于类似的问题，例如给定一个区间和某种变换规则，求满足条件的数的个数。类似的问题可以出现在数论、组合数学等领域。

### 推荐题目

1. [P1045 数论题](https://www.luogu.com.cn/problem/P1045)
2. [P1072 区间交](https://www.luogu.com.cn/problem/P1072)
3. [P1082 数的变换](https://www.luogu.com.cn/problem/P1082)

---
处理用时：28.88秒
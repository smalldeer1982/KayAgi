# 题目信息

# [ABC368C] Triple Attack

## 题目描述

你正在玩一款游戏。

游戏中有 $N$ 个敌人排成一排，第 $i$ 个敌人有 $h_i$ 的血量,当敌人血量降至 0 或以下时该敌人被消灭。  

从第 1 只敌人开始打，时间 $T$ 从 0 开始，重复执行如下操作:

- $T$ 增加 1，若此时 $T$ 为 3 的倍数，当前敌人掉 3 滴血，否则掉 1 滴血。

 求消灭全部敌人所需时间 $T$。

---

## 说明/提示

采取的行动如下:

- $T=1$，攻击第 $1$ 个敌人，第一个敌人的血量为 $6-1=5$；
- $T=2$，攻击第 $1$ 个敌人，第一个敌人的血量为 $5-1=4$；
- $T=3$，攻击第 $1$ 个敌人，第一个敌人的血量为 $4-3=1$；
- $T=4$，攻击第 $1$ 个敌人，第一个敌人的血量为 $1-1=0$；
- $T=5$，攻击第 $2$ 个敌人，第二个敌人的血量为 $2-1=1$；
- $T=6$，攻击第 $2$ 个敌人，第二个敌人的血量为 $1-3=-2$；
- $T=7$，攻击第 $3$ 个敌人，第三个敌人的血量为 $2-1=1$；
- $T=8$，攻击第 $3$ 个敌人，第三个敌人的血量为 $1-1=0$；


## 样例 #2

### 样例输入 #2

```
9
1 12 123 1234 12345 123456 1234567 12345678 123456789
```

### 样例输出 #2

```
82304529
```

## 样例 #3

### 样例输入 #3

```
5
1000000000 1000000000 1000000000 1000000000 1000000000
```

### 样例输出 #3

```
3000000000
```


注意数据溢出。


---

- $ 1 \leq\ N \leq\ 2\times 10^5 $
- $ 1 \leq\ H_i \leq 10^9 $
- 所有输入均为整数

## 样例 #1

### 输入

```
3

6 2 2```

### 输出

```
8```

## 样例 #2

### 输入

```
9

1 12 123 1234 12345 123456 1234567 12345678 123456789```

### 输出

```
82304529```

## 样例 #3

### 输入

```
5

1000000000 1000000000 1000000000 1000000000 1000000000```

### 输出

```
3000000000```

# AI分析结果

### 题目内容重写
你正在玩一款游戏。

游戏中有 $N$ 个敌人排成一排，第 $i$ 个敌人有 $h_i$ 的血量，当敌人血量降至 0 或以下时该敌人被消灭。  

从第 1 只敌人开始打，时间 $T$ 从 0 开始，重复执行如下操作:

- $T$ 增加 1，若此时 $T$ 为 3 的倍数，当前敌人掉 3 滴血，否则掉 1 滴血。

求消灭全部敌人所需时间 $T$。

---

### 题解分析与结论

本题的核心在于如何高效计算消灭所有敌人所需的时间 $T$。由于直接模拟会导致时间复杂度过高（$O(\sum h_i)$），因此需要找到规律并进行优化。大多数题解都采用了将每 3 次攻击视为一个周期，每次周期造成 5 点伤害的思路，从而将时间复杂度降低到 $O(n)$。

### 精选题解

#### 1. 作者：_Gabriel_ (4星)
**关键亮点**：
- 思路清晰，直接将每 3 次攻击视为一个周期，每次周期造成 5 点伤害。
- 代码简洁，逻辑明确，时间复杂度为 $O(n)$。

**核心代码**：
```cpp
for (int i = 1; i <= n; i++) {
    int q = a[i] / 5;
    now += q * 3;
    a[i] -= q * 5;
    while (a[i] > 0) {
        now++;
        if (now % 3 == 0) {
            a[i] -= 3;
        } else {
            a[i]--;
        }
    }
}
```
**实现思想**：先计算每个敌人可以被多少个完整的 5 点伤害周期消灭，然后对剩余的血量进行模拟攻击。

#### 2. 作者：huangrenheluogu (4星)
**关键亮点**：
- 通过调整 $T$ 的值，确保每次周期从 $T$ 为 3 的倍数开始，简化了计算。
- 代码结构清晰，逻辑严谨。

**核心代码**：
```cpp
while(ans % 3 && x > 0){
    ans++;
    if(ans % 3 == 0) x -= 3;
    else x--;
}
tmp = x / 5;
ans += tmp * 3;
x -= tmp * 5;
while(x > 0){
    ans++;
    if(ans % 3 == 0) x -= 3;
    else x--;
}
```
**实现思想**：先调整 $T$ 的值，确保每次周期从 $T$ 为 3 的倍数开始，然后计算完整的 5 点伤害周期，最后处理剩余的血量。

#### 3. 作者：__O_v_O__ (4星)
**关键亮点**：
- 通过维护当前攻击和上一次攻击的伤害，简化了剩余血量的处理。
- 代码简洁，逻辑清晰。

**核心代码**：
```cpp
an += a[i] / 5 * 3;
a[i] %= 5;
while(a[i] > 0){
    a[i] -= no, an++;
    if(no == 1 && pr == 1) no = 3, pr = 1;
    else if(no == 3 && pr == 1) pr = 3, no = 1;
    else pr = 1;
}
```
**实现思想**：先计算完整的 5 点伤害周期，然后通过维护当前攻击和上一次攻击的伤害，处理剩余的血量。

### 最优关键思路
将每 3 次攻击视为一个周期，每次周期造成 5 点伤害，从而将时间复杂度从 $O(\sum h_i)$ 降低到 $O(n)$。通过这种方式，可以高效地计算消灭所有敌人所需的时间 $T$。

### 可拓展之处
类似的问题可以通过寻找攻击或操作的周期性规律，将问题转化为更高效的计算方式。例如，某些游戏中的技能冷却时间、资源生成周期等，都可以通过类似的思路进行优化。

### 推荐题目
1. [P1003 铺地毯](https://www.luogu.com.cn/problem/P1003)
2. [P1047 校门外的树](https://www.luogu.com.cn/problem/P1047)
3. [P1056 排座椅](https://www.luogu.com.cn/problem/P1056)

### 个人心得
在解决类似问题时，寻找周期性规律是优化时间复杂度的关键。通过将多次操作合并为一个周期，可以显著减少计算量，提高算法效率。

---
处理用时：38.51秒
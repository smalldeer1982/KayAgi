# 题目信息

# [ARC162A] Ekiden Race

## 题目描述

[problemUrl]: https://atcoder.jp/contests/arc162/tasks/arc162_a

$ 1 $ から $ N $ までの番号がつけられた $ N $ 人の人がある地点間を往復するレースを行いました。このレースについて、以下の情報が残されています。

- **往路**のタイムの早い順に順位をつけると、どの $ 2 $ 人のタイムも異なっており、人 $ i\ (1\ \leq\ i\ \leq\ N) $ は $ i $ 位であった。
- **往復**のタイム（往路のタイムと復路のタイムの合計）の早い順に順位をつけると、どの $ 2 $ 人のタイムも異なっており、人 $ i\ (1\ \leq\ i\ \leq\ N) $ は $ P_i $ 位であった。
- **復路**のタイムが最も早かった人（複数人いる場合はその全員）に**復路の区間賞**が与えられた。
 
ここで、$ P_1,\ P_2,\ \dots,\ P_N $ は $ 1,\ 2,\ \dots,\ N $ の並べ替えです。

このとき、**復路の区間賞**を与えられた可能性のある人は何人いるでしょうか？

$ T $ 個のテストケースが与えられるので、それぞれについて答えてください。

## 说明/提示

### 制約

- $ 1\ \leq\ T\ \leq\ 500 $
- $ 2\ \leq\ N\ \leq\ 10^3 $
- $ P_1,\ P_2,\ \dots,\ P_N $ は $ 1,\ 2,\ \dots,\ N $ の並べ替えである
- 入力される数値は全て整数
- $ 1 $ つの入力に含まれるテストケースについて、$ N $ の総和は $ 10^3 $ 以下
 
### Sample Explanation 1

\- $ 1 $ つ目のテストケースでは、$ 2 $ 人でレースを行い、復路において人 $ 2 $ が人 $ 1 $ を抜かしています。この場合、復路の区間賞は人 $ 2 $ に与えられます。 - $ 2 $ つ目のテストケースでは、復路で順位が変動しておらず、どの人も復路の区間賞が与えられた可能性があります。

## 样例 #1

### 输入

```
3

2

2 1

4

1 2 3 4

20

13 2 7 1 5 9 3 4 12 10 15 6 8 14 20 16 19 18 11 17```

### 输出

```
1

4

7```

# AI分析结果

### 题目中文重写
有编号从 $1$ 到 $N$ 的 $N$ 个人进行了一场在两点间往返的比赛。关于这场比赛，留下了以下信息：
- **去程**：按时间从快到慢排名，任意两人的时间都不同，第 $i$ 个人（$1 \leq i \leq N$）排名第 $i$ 位。
- **往返**：按总时间（去程时间与回程时间之和）从快到慢排名，任意两人的时间都不同，第 $i$ 个人（$1 \leq i \leq N$）排名第 $P_i$ 位。
- **回程**：回程时间最快的人（若有多人则包含所有人）会获得**回程区间奖**。

这里，$P_1, P_2, \dots, P_N$ 是 $1, 2, \dots, N$ 的一个排列。

此时，有多少人有可能获得**回程区间奖**呢？

会给出 $T$ 个测试用例，请分别给出答案。

### 综合分析与结论
这些题解整体围绕找出可能获得回程区间奖的人数展开。大部分题解采用暴力枚举的思路，即对于每个人，检查其后面是否有比他总排名更优的人，若没有则该人可能获得回程奖；而 Sammy_prime 的题解通过求 $P$ 的后缀最小元素个数来快速得出答案，复杂度更低。

### 各题解思路、算法要点及难点对比
| 作者 | 思路 | 算法要点 | 解决难点 | 复杂度 |
| --- | --- | --- | --- | --- |
| Sammy_prime | 若存在 $i < j$ 使得 $P_i > P_j$，则 $i$ 不能获奖，答案是 $P$ 的后缀最小元素个数 | 从后往前遍历数组，记录最小元素，若当前元素小于最小元素则计数加一 | 理解后缀最小元素与获奖可能性的关系 | $O(N)$ |
| linch | 反向思考，若跑在一个人后面的人名次比前面好，则该人不能获奖，直接模拟 | 双重循环，外层遍历每个人，内层检查后面的人是否名次更优 | 正确判断不能获奖的条件 | $O(T\times N)$ |
| zhicheng | 先将名次换为最终顺序，再比较一个人的前面是否有编号比自己大的 | 先转换名次顺序，再遍历比较 | 名次转换和编号比较的逻辑 | $O(T\times N)$ |
| 其他作者 | 直接暴力枚举，检查每个人后面是否有比他速度更快的人 | 双重循环，外层遍历每个人，内层检查后面的人是否速度更快 | 正确判断获奖条件 | $O(T\times N)$ |

### 评分
| 作者 | 评分 | 理由 |
| --- | --- | --- |
| Sammy_prime | 4星 | 思路清晰，算法复杂度低，代码简洁 |
| linch | 3星 | 思路较清晰，采用 Python 实现，适合不同需求 |
| zhicheng | 3星 | 思路有一定创新性，但代码复杂度与暴力法相当 |
| 其他作者 | 2 - 3星 | 思路类似，多为暴力枚举，复杂度较高 |

### 所选题解
- **Sammy_prime（4星）**
    - 关键亮点：通过求后缀最小元素个数，将时间复杂度优化到 $O(N)$，思路独特且高效。
    - 核心代码：
```cpp
#include<bits/stdc++.h>
using namespace std;
const int N=1e5+5;
int t,n,p[N]; 
int main(){
    scanf("%d",&t);
    while(t--){
        int ans=0,mn=N;
        scanf("%d",&n);
        for(int i=1;i<=n;++i) scanf("%d",p+i);
        for(int i=n;i>0;--i)
            if(p[i]<mn) ans++,mn=p[i];
        printf("%d\n",ans);
    }
    return 0;
}
```
核心实现思想：从数组末尾开始遍历，维护一个当前最小元素 `mn`，若当前元素小于 `mn`，则说明该元素可能获得回程奖，计数 `ans` 加一，并更新 `mn`。

### 最优关键思路或技巧
- **思维方式**：反向思考，通过判断不能获奖的条件来确定可能获奖的人数。
- **算法优化**：利用后缀最小元素的性质，将时间复杂度从 $O(T\times N)$ 优化到 $O(N)$。

### 拓展思路
同类型题可能涉及更多维度的排名信息，或者比赛规则更加复杂，但核心思路依然是通过已知信息判断每个元素是否满足特定条件。类似算法套路可应用于各种排名、比较类问题，如体育比赛排名分析、成绩排名筛选等。

### 推荐洛谷题目
1. [P1093 奖学金](https://www.luogu.com.cn/problem/P1093)
2. [P1781 宇宙总统](https://www.luogu.com.cn/problem/P1781)
3. [P2676 [USACO07DEC]Bookshelf B](https://www.luogu.com.cn/problem/P2676)

### 个人心得
题解中未包含个人心得。 

---
处理用时：32.27秒
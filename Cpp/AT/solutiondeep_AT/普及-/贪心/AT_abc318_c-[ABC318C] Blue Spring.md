# 题目信息

# [ABC318C] Blue Spring

## 题目描述

**题意简述**

高桥君要进行 $N$ 天的旅行，第 $i$ 天的费用为 $A_i$ 。他还可以使用优惠券，可以免除 $D$ 天的费用，价格为 $P$。如果剩余 $2$ 天，优惠券的作用是 $3$ 天，那么依然可以使用。

求这 $N$ 天旅行的最小费用。

## 说明/提示

- $1 \le N \le 2 \times 10^5$
- $1 \le D \le 2 \times 10^5$
- $1 \le P \le 10^9$
- $1 \le F_i \le 10^9$

**样例一解释**

使用一张优惠券免除 $1,3$ 天的费用，总费用为 $1+3+6+10=20$。

**样例三解释**

使用 $3$ 张优惠券，费用为 $3 \times 1000000000=3000000000$

## 样例 #1

### 输入

```
5 2 10
7 1 6 3 6```

### 输出

```
20```

## 样例 #2

### 输入

```
3 1 10
1 2 3```

### 输出

```
6```

## 样例 #3

### 输入

```
8 3 1000000000
1000000000 1000000000 1000000000 1000000000 1000000000 1000000000 1000000000 1000000000```

### 输出

```
3000000000```

# AI分析结果

### 题目内容
高桥君要进行 $N$ 天的旅行，第 $i$ 天的费用为 $A_i$ 。他还可以使用优惠券，可以免除 $D$ 天的费用，价格为 $P$。如果剩余 $2$ 天，优惠券的作用是 $3$ 天，那么依然可以使用。

求这 $N$ 天旅行的最小费用。

### 说明/提示
- $1 \le N \le 2 \times 10^5$
- $1 \le D \le 2 \times 10^5$
- $1 \le P \le 10^9$
- $1 \le F_i \le 10^9$

### 样例解释
**样例一解释**
使用一张优惠券免除 $1,3$ 天的费用，总费用为 $1+3+6+10=20$。

**样例三解释**
使用 $3$ 张优惠券，费用为 $3 \times 1000000000=3000000000$

### 样例输入输出
**样例一**
输入：
```
5 2 10
7 1 6 3 6
```
输出：
```
20
```

**样例二**
输入：
```
3 1 10
1 2 3
```
输出：
```
6
```

**样例三**
输入：
```
8 3 1000000000
1000000000 1000000000 1000000000 1000000000 1000000000 1000000000 1000000000 1000000000
```
输出：
```
3000000000
```

### 题解分析与结论
本题的核心思路是贪心算法，通过将每天的旅行费用从大到小排序，然后每次选择费用最高的 $D$ 天来判断是否使用优惠券。如果这 $D$ 天的总费用大于 $P$，则使用优惠券，否则不使用。这样可以保证每次使用优惠券都能最大化地减少总费用。

### 所选高星题解
#### 题解1：作者：robertuu (赞：4)
**星级：★★★★★**
**关键亮点：**
- 思路清晰，代码简洁。
- 使用排序和贪心算法，确保每次使用优惠券都能最大化减少费用。
- 处理了最后不满 $D$ 天的情况，保证了算法的完整性。

**核心代码：**
```cpp
sort(a+1,a+1+n,greater<int>()); // 给金额排序
long long ans = 0,cnt = 0;
for(int i = 1;i <= n;i++)
{
    cnt += a[i]; // 统计连续d天的金额和
    if(i % d == 0)
    {
        ans += min(cnt,p); // 券和单买取较小值
        cnt = 0;
    }
}
ans += min(cnt,p); // 最后不满d天的也要统计！！
```

#### 题解2：作者：Submerge_TA (赞：4)
**星级：★★★★★**
**关键亮点：**
- 代码结构清晰，逻辑严谨。
- 使用排序和分段处理，确保每次选择最优的 $D$ 天。
- 处理了边界情况，保证了算法的正确性。

**核心代码：**
```cpp
sort(a,a+n,cmp);
int i=0;
while(i<n) {
    st=0;
    for(int j=i;j<i+d&&j<n;j++) st+=a[j];
    i+=d;
    if(st<=p) s+=st;
    else s+=p; 
}
```

#### 题解3：作者：lrx___ (赞：3)
**星级：★★★★**
**关键亮点：**
- 使用前缀和优化，减少了计算量。
- 处理了最后不满 $D$ 天的情况，保证了算法的完整性。
- 代码逻辑清晰，易于理解。

**核心代码：**
```cpp
sort(a+1,a+n+1,cmp);
for(i=1;i<=n+d;i++){
    a[i]+=a[i-1];
}
for(i=d;i-d<=n;i+=d){
    s+=min(a[i]-a[i-d],p);
}
```

### 最优关键思路与技巧
1. **贪心算法**：通过排序和选择最优的 $D$ 天来最大化减少总费用。
2. **前缀和优化**：使用前缀和来快速计算任意区间的费用和，减少时间复杂度。
3. **边界处理**：处理最后不满 $D$ 天的情况，确保算法的完整性。

### 可拓展之处
- 类似的问题可以扩展到其他优惠券使用场景，如购物、餐饮等。
- 可以使用动态规划来解决更复杂的优惠券使用问题。

### 推荐题目
1. [P1223 排队接水](https://www.luogu.com.cn/problem/P1223)
2. [P1090 合并果子](https://www.luogu.com.cn/problem/P1090)
3. [P1801 黑匣子](https://www.luogu.com.cn/problem/P1801)

### 个人心得总结
- **调试经历**：在处理边界情况时，容易忽略最后不满 $D$ 天的情况，导致算法不完整。
- **踩坑教训**：在计算前缀和时，要注意数组的边界，避免越界。
- **顿悟感想**：贪心算法在处理优化问题时非常有效，但需要仔细考虑每一步的选择是否最优。

---
处理用时：40.64秒
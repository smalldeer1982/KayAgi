# 题目信息

# [ABC054D] Mixing Experiment

## 题目描述

------------

有 $N$ 个物体，第 $i$ 个物体含有 $a_i$ 质量的 A 元素 和 $b_i$ 质量的 B 元素，代价为 $c_i$ 。

问能否取若干个物体，使 A 元素与 B 元素质量之比为 $M_a : M_b$ ，并使代价最小。

------------

## 说明/提示

- $1\le N\le 40$

- $1\le a_i,b_i\le 10$

- $1\le c_i\le 100$

- $1\le M_a,M_b\le 10$

-  $gcd(M_a,M_b)=1$

- 输入都为整数。

------------

translated by @君のNOIP。

## 样例 #1

### 输入

```
3 1 1

1 2 1

2 1 2

3 3 10```

### 输出

```
3```

## 样例 #2

### 输入

```
1 1 10

10 10 10```

### 输出

```
-1```

# AI分析结果



# [ABC054D] Mixing Experiment

## 题目描述

有 $N$ 个物体，第 $i$ 个物体含有 $a_i$ 质量的 A 元素和 $b_i$ 质量的 B 元素，代价为 $c_i$。要求选取若干物体，使得 A 元素与 B 元素的质量之比为 $M_a : M_b$，并使总代价最小。若无法满足条件，输出 -1。

**算法分类**：动态规划

---

### 综合题解分析

本题核心为**二维费用的0/1背包问题**，需同时维护A、B元素的总质量。各题解均采用相似思路，通过动态规划维护最小代价，差异主要体现在状态转移的优化方式与枚举范围的限制。

#### 最优思路提炼
1. **状态设计**：$dp[i][j]$ 表示获得i单位A元素和j单位B元素的最小代价
2. **转移方程**：$dp[i][j] = \min(dp[i][j],\ dp[i-a][j-b] + c)$
3. **比例处理**：通过 $i \times mb = j \times ma$ 避免浮点运算
4. **枚举优化**：根据物品总质量限制枚举范围（如suma/sumb或固定400）

---

### 精选题解

#### 1. 作者：君のNOIP。 (⭐⭐⭐⭐⭐)
**核心亮点**：
- 动态计算物品总质量上限减少无效枚举
- 通过预处理suma/sumb优化循环终止条件
- 代码简洁高效（AC代码跑出Rank1）

**代码核心**：
```cpp
for(int k=1;k<=n;k++)
    for(int i=suma[k];i>=a[k];i--) // 动态调整上限
        for(int j=sumb[k];j>=b[k];j--) 
            dp[i][j] = min(dp[i][j], dp[i-a[k]][j-b[k]]+c[k]);

for(int i=1;i<=suma[n];i++)
    for(int j=1;j<=sumb[n];j++)
        if(i*Mb==j*Ma) // 乘法判断比例
            ans = min(ans, dp[i][j]);
```

#### 2. 作者：龙潜月十五 (⭐⭐⭐⭐)
**核心亮点**：
- 详细的状态初始化说明
- 显式处理无解情况
- 完整注释增强可读性

**关键实现**：
```cpp
// 初始化INF
for(int i=0; i<=suma; i++) 
    for(int j=0; j<=sumb; j++)
        f[i][j] = INF;

// 背包转移
for(int i=1; i<=n; i++)
    for(int j=suma; j>=s[i].a; j--)
        for(int k=sumb; k>=s[i].b; k--)
            f[j][k] = min(f[j][k], f[j-s[i].a][k-s[i].b]+s[i].c);
```

---

### 拓展与应用

**同类问题套路**：
1. 二维约束的最优化问题（如P1507 NASA食物计划）
2. 比例约束的组合问题（如P2340 Cow Exhibition）

**推荐练习**：
1. [P2340] Cow Exhibition（二维费用+最大值）
2. [P1507] NASA食物计划（双重量限制背包）
3. [P6771] Space Elevator（多维约束+贪心优化）

---

### 调试经验摘录

> "我一开始每次从400开始算，提交发现是Rank2，加了优化减少不必要运算后跃居Rank1" —— 君のNOIP  
**启示**：动态调整枚举范围对性能提升显著，避免固定上限的冗余计算。

---
处理用时：48.86秒
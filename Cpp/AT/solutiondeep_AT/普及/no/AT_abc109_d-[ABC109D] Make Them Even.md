# 题目信息

# [ABC109D] Make Them Even

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc109/tasks/abc109_d

縦 $ H $ 行横 $ W $ 列に区切られたマス目があり、上から $ i $ 番目、左から $ j $ 列目のマスをマス $ (i,\ j) $ と呼びます。

マス $ (i,\ j) $ には $ a_{ij} $ 枚のコインが置かれています。

あなたは以下の操作を何度でも行うことができます。

操作: まだ選んだことのないマスのうち $ 1 $ 枚以上のコインが置かれているマスを $ 1 $ つ選び、そのマスに置かれているコインのうち $ 1 $ 枚を上下左右に隣接するいずれかのマスに移動する

偶数枚のコインが置かれたマスの数を最大化してください。

## 说明/提示

### 制約

- 入力はすべて整数である
- $ 1\ \leq\ H,\ W\ \leq\ 500 $
- $ 0\ \leq\ a_{ij}\ \leq\ 9 $

### Sample Explanation 1

次のように操作を行えば、全てのマスに置かれたコインの数を偶数にできます。 - マス $ (2,\ 2) $ に置かれているコインのうち $ 1 $ 枚をマス $ (2,\ 3) $ に移動します - マス $ (1,\ 1) $ に置かれているコインのうち $ 1 $ 枚をマス $ (1,\ 2) $ に移動します - マス $ (1,\ 3) $ に置かれているコインのうち $ 1 $ 枚をマス $ (1,\ 2) $ に移動します

## 样例 #1

### 输入

```
2 3

1 2 3

0 1 1```

### 输出

```
3

2 2 2 3

1 1 1 2

1 3 1 2```

## 样例 #2

### 输入

```
3 2

1 0

2 1

1 0```

### 输出

```
3

1 1 1 2

1 2 2 2

3 1 3 2```

## 样例 #3

### 输入

```
1 5

9 9 9 9 9```

### 输出

```
2

1 1 1 2

1 3 1 4```

# AI分析结果



# [ABC109D] Make Them Even 的中文翻译

## 题目描述

有一个由 $H$ 行 $W$ 列组成的网格，从上往下第 $i$ 行、从左往右第 $j$ 列的格子称为格子 $(i, j)$。每个格子 $(i, j)$ 中放有 $a_{ij}$ 枚硬币。

你可以进行任意次以下操作：

**操作**：选择一个未被选择过的、至少有一枚硬币的格子，将其中的一枚硬币移动到上下左右相邻的格子中。

请通过操作最大化含有偶数枚硬币的格子数量。

---

**算法分类**：构造、贪心

---

## 题解对比与结论

### 关键思路总结
1. **奇数传递**：通过蛇形遍历或逐行遍历，将奇数的硬币依次传递到后续格子，最终将奇数集中到网格末尾。
2. **奇偶性决定上限**：总硬币数的奇偶性决定最终结果：
   - 总硬币数为奇数时，最多有 $H \times W - 1$ 个偶数格。
   - 总硬币数为偶数时，所有格子均可为偶数。
3. **遍历顺序**：采用蛇形遍历（奇数行从左到右，偶数行从右到左）确保每个格子仅处理一次，避免重复操作。

---

### 高分题解推荐

#### 1. 作者：Him_shu（⭐️⭐️⭐️⭐️⭐️）
- **亮点**：蛇形遍历实现清晰，代码简洁，直接通过哈希值计算行列坐标，巧妙处理奇偶行遍历方向。
- **核心代码**：
  ```cpp
  for (int hash = 0; hash < h * w; hash++) {
      int cy = hash / w;
      int cx = (cy % 2 == 0 ? hash % w : w - 1 - hash % w);
      // 处理当前格子并记录移动操作
  }
  ```

#### 2. 作者：Nightingale_OI（⭐️⭐️⭐️⭐️）
- **亮点**：显式处理行遍历方向，分奇数行和偶数行分别处理，逻辑直观。
- **核心代码**：
  ```cpp
  for(int i=1;i<=n;i++){
      if(i%2) for(j=1 to m) 右移处理;
      else    for(j=m downto 1) 左移处理;
  }
  ```

#### 3. 作者：125125A（⭐️⭐️⭐️⭐️）
- **亮点**：先处理所有行的非最后一列，再处理最后一列，逻辑分层明确。
- **核心代码**：
  ```cpp
  for(每行非最后一列) 右移奇数硬币;
  for(最后一列非最后一行) 下移奇数硬币;
  ```

---

### 最优代码实现（Him_shu 版本）
```cpp
#include <bits/stdc++.h>
using namespace std;
#define N 510
int h, w, a[N][N];
struct info { int u, v, x, y; };

int main() {
    cin >> h >> w;
    int sum_odd = 0;
    for (int i = 0; i < h; i++)
        for (int j = 0; j < w; j++)
            cin >> a[i][j], sum_odd += a[i][j] % 2;

    vector<info> res;
    int cnt_odd = 0;
    for (int hash = 0; hash < h * w; hash++) {
        int cy = hash / w;
        int cx = (cy % 2 ? w - 1 - hash % w : hash % w);
        
        if (a[cy][cx] % 2) cnt_odd++;
        if (cnt_odd % 2 && cnt_odd < sum_odd) {
            int nxt = hash + 1;
            int ny = nxt / w, nx = (ny % 2 ? w - 1 - nxt % w : nxt % w);
            res.push_back({cy, cx, ny, nx});
        }
    }

    cout << res.size() << "\n";
    for (auto [u, v, x, y] : res) 
        cout << u+1 << ' ' << v+1 << ' ' << x+1 << ' ' << y+1 << "\n";
}
```

---

### 拓展与总结
- **同类问题**：涉及奇偶性调整、网格遍历策略的题目（如洛谷 P1003、P1056）。
- **调试技巧**：可通过打印中间状态的硬币分布验证传递逻辑。
- **思维启示**：构造类问题常通过设计特定操作顺序来简化问题，贪心策略需结合数学分析。

---

### 推荐练习题
1. [P1003 铺地毯](https://www.luogu.com.cn/problem/P1003) - 网格覆盖问题
2. [P1056 排座椅](https://www.luogu.com.cn/problem/P1056) - 贪心选择最优分隔线
3. [P1328 生活大爆炸版石头剪刀布](https://www.luogu.com.cn/problem/P1328) - 构造性模拟

---
处理用时：58.24秒
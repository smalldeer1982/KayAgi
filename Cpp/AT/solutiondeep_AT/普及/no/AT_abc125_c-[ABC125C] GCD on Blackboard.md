# 题目信息

# [ABC125C] GCD on Blackboard

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc125/tasks/abc125_c

$ N $ 個の整数 $ A_1,\ A_2,\ ...,\ A_N $ が黒板に書かれています。

あなたはこの中から整数を $ 1 $ つ選んで、$ 1 $ 以上 $ 10^9 $ 以下の好きな整数に書き換えます。

元の整数と同じ整数に書き換えても構いません。

書き換えた後の $ N $ 個の整数の最大公約数の最大値を求めてください。

## 说明/提示

### 制約

- 入力は全て整数である。
- $ 2\ \leq\ N\ \leq\ 10^5 $
- $ 1\ \leq\ A_i\ \leq\ 10^9 $

### Sample Explanation 1

$ 7 $ を $ 4 $ に書き換えると $ 3 $ つの整数の最大公約数は $ 2 $ となり、これが最大です。

### Sample Explanation 3

元の整数と同じ整数に書き換えることも可能です。

## 样例 #1

### 输入

```
3

7 6 8```

### 输出

```
2```

## 样例 #2

### 输入

```
3

12 15 18```

### 输出

```
6```

## 样例 #3

### 输入

```
2

1000000000 1000000000```

### 输出

```
1000000000```

# AI分析结果



# [ABC125C] GCD on Blackboard

## 题目描述

$ N $ 个整数 $ A_1,\ A_2,\ ...,\ A_N $ 写在黑板上。你可以选择其中一个整数，将其替换为 $ 1 $ 到 $ 10^9 $ 之间的任意整数。求替换后所有整数的最大公约数的最大值。

### 样例解释
- 样例1：将7替换为4后，三个数的最大公约数为2
- 样例3：允许替换为原数值

## 算法分类
数学

---

## 题解综合分析

### 核心思路
利用前后缀GCD预处理，将时间复杂度优化至O(n)。预处理左前缀GCD数组和右后缀GCD数组，枚举每个位置被替换时的情况，通过前后缀GCD的合并计算最大公约数。

### 关键技巧
1. **前后缀GCD预处理**：构建l[i]表示前i个数的GCD前缀，r[i]表示后i个数的GCD后缀
2. **合并计算**：对于每个被替换的位置i，其最大公约数为gcd(l[i], r[i])
3. **边界处理**：利用gcd(0, x) = x的特性处理数组首尾的边界情况

---

## 优质题解推荐

### 题解作者：SpeedStar（⭐⭐⭐⭐⭐）
**关键亮点**：
- 线性时间复杂度预处理前后缀GCD数组
- 代码简洁高效，利用STL的gcd函数
- 正确性经过数学验证，完美处理所有边界情况

**核心代码**：
```cpp
vector<int> l(n), r(n);
// 前缀预处理
for (int i = 0; i < n-1; ++i) 
    l[i+1] = gcd(l[i], a[i]);
// 后缀预处理
for (int i = n-1; i >= 1; --i) 
    r[i-1] = gcd(r[i], a[i]);
// 枚举求最大值
int ans = 1;
for (int i = 0; i < n; ++i) 
    ans = max(ans, gcd(l[i], r[i]));
```

**实现思想**：
- l[i]存储前i个元素的GCD累计结果
- r[i]存储后i个元素的GCD累计结果
- 通过合并左右区间的GCD，得到替换任意元素后的全局GCD

---

## 拓展应用
该技巧可应用于需要快速计算移除某个元素后的聚合值的场景，例如：
- 移除元素后的最大值/最小值
- 前后缀和的快速合并计算
- 滑动窗口中的统计量维护

## 相似题目推荐
1. [P1891 疯狂的馒头](https://www.luogu.com.cn/problem/P1891)（并查集区间染色）
2. [P2448 无尽的生命](https://www.luogu.com.cn/problem/P2448)（离散化+逆序对）
3. [P3916 图的遍历](https://www.luogu.com.cn/problem/P3916)（反向建图+DFS）

---
处理用时：113.95秒
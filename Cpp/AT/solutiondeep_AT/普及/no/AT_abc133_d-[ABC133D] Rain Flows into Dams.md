# 题目信息

# [ABC133D] Rain Flows into Dams

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc133/tasks/abc133_d

円形に $ N $ 個の山が連なっており、時計回りに山 $ 1 $, 山 $ 2 $, $ … $, 山 $ N $ と呼ばれます。$ N $ は**奇数**です。

これらの山の間に $ N $ 個のダムがあり、ダム $ 1 $, ダム $ 2 $, $ … $, ダム $ N $ と呼ばれます。ダム $ i $ ($ 1\ \leq\ i\ \leq\ N $) は山 $ i $ と山 $ i+1 $ の間にあります (山 $ N+1 $ は山 $ 1 $ のことを指します)。

山 $ i $ ($ 1\ \leq\ i\ \leq\ N $) に $ 2x $ リットルの雨が降ると、ダム $ i-1 $ とダム $ i $ にそれぞれ $ x $ リットルずつ水が溜まります (ダム $ 0 $ はダム $ N $ のことを指します)。

ある日、各山に非負の**偶数**リットルの雨が降りました。

その結果、ダム $ i $ ($ 1\ \leq\ i\ \leq\ N $) には合計で $ A_i $ リットルの水が溜まりました。

各山に降った雨の量を求めてください。この問題の制約下では解が一意に定まることが証明できます。

## 说明/提示

### 制約

- 入力は全て整数である。
- $ 3\ \leq\ N\ \leq\ 10^5-1 $
- $ N $ は奇数である。
- $ 0\ \leq\ A_i\ \leq\ 10^9 $
- 入力が表す状況は、各山に非負の偶数リットルの雨が降った際に発生しうる。

### Sample Explanation 1

山 $ 1,\ 2,\ 3 $ に降った雨の量をそれぞれ $ 4 $ リットル, $ 0 $ リットル, $ 4 $ リットルとすると以下のように辻褄が合います。 - ダム $ 1 $ には $ \frac{4}{2}\ +\ \frac{0}{2}\ =\ 2 $ リットルの水が溜まります。 - ダム $ 2 $ には $ \frac{0}{2}\ +\ \frac{4}{2}\ =\ 2 $ リットルの水が溜まります。 - ダム $ 3 $ には $ \frac{4}{2}\ +\ \frac{4}{2}\ =\ 4 $ リットルの水が溜まります。

## 样例 #1

### 输入

```
3

2 2 4```

### 输出

```
4 0 4```

## 样例 #2

### 输入

```
5

3 8 7 5 5```

### 输出

```
2 4 12 2 8```

## 样例 #3

### 输入

```
3

1000000000 1000000000 0```

### 输出

```
0 2000000000 0```

# AI分析结果



# 中文题目重写

## 题目描述

圆形排列着 $N$ 座山（$N$ 为奇数），顺时针编号为山 1 至山 N。山间有 $N$ 个水坝，水坝 $i$ 位于山 $i$ 和山 $i+1$ 之间（山 $N+1$ 视为山 1）。

当山 $i$ 降下 $2x$ 升雨水时，相邻的两个水坝各增加 $x$ 升水。现已知所有水坝的最终水量 $A_1,A_2,...,A_N$，求各山的降雨量（保证解唯一）。

## 输入格式
第一行为奇数 $N$，第二行为 $N$ 个整数表示水坝水量。

## 输出格式
输出 $N$ 个偶数，表示各山降雨量。

## 样例
输入：
3
2 2 4
输出：
4 0 4

---

# 算法分类
数学（递推方程）

---

# 题解分析与结论

## 核心思路
1. **建立环形方程组**：设山 $i$ 降雨量为 $b_i$，则有 $b_i + b_{i+1} = 2A_i$（环形处理）
2. **奇偶性消元**：利用 $N$ 为奇数的特性，通过交替加减方程消元，最终求得 $b_1$ 的表达式
3. **递推求解**：由 $b_1$ 出发，利用 $b_{i} = 2A_{i-1} - b_{i-1}$ 递推所有值

## 最优题解（评分：⭐⭐⭐⭐⭐）

### 作者：b6e0_
**亮点**：利用奇偶交替求和直接求 $b_1$，时间复杂度 $O(n)$，代码简洁优雅
```cpp
int main() {
    cin >> n;
    long long sum = 0;
    for(int i=1; i<=n; i++) {
        cin >> a[i];
        if(i&1) sum += a[i];
        else sum -= a[i];
    }
    for(int i=1; i<=n; i++) {
        cout << sum << ' ';
        sum = 2*a[i] - sum;
    }
}
```

### 作者：_Extroversion_
**亮点**：数学推导清晰，代码实现与理论推导高度对应
```cpp
for(int i=1; i<=n; i++){
    if(i&1) ans += a[i];
    else ans -= a[i]; 
}
for(int i=1; i<=n; i++){
    printf("%lld ",ans);
    ans = 2*a[i] - ans;
}
```

### 作者：cppcppcpp3
**亮点**：通过总和与奇数次项的关系求首项，代码可读性极佳
```cpp
for(int i=1; i<=n; ++i) s += (x[i]=wrd());
for(int i=1; i<=n-2; i+=2) t += 2*x[i];
a[n] = s - t;
for(int i=n-1; i>=1; --i) a[i] = 2*x[i] - a[i+1];
```

---

# 关键思路
1. **首项表达式**：$b_1 = \sum_{k=1}^N (-1)^{k+1}A_k$
2. **递推关系**：$b_{i+1} = 2A_i - b_i$（环形结构保证递推可行性）
3. **奇偶性利用**：当 $N$ 为奇数时，方程组具有唯一解的特性

---

# 拓展训练
1. **环形递推**：[P1036 选数](https://www.luogu.com.cn/problem/P1036)
2. **方程组构建**：[P1990 覆盖墙壁](https://www.luogu.com.cn/problem/P1990)
3. **奇偶性应用**：[P1984 烧水问题](https://www.luogu.com.cn/problem/P1984)

---

# 心得体会摘录
> "当发现方程组具有环形结构时，要立即想到首尾相接处的特殊处理" —— b6e0_

> "将每个变量用前一个变量表示，最终会神奇地出现首项的闭合解，这需要大胆假设和严谨验证" —— _Extroversion_

> "预处理时将A数组全体乘以2可以避免浮点运算，这个trick在类似问题中很实用" —— Yashajin_Ai

---
处理用时：57.18秒
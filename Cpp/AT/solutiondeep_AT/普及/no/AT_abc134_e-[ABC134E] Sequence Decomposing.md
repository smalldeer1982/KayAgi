# 题目信息

# [ABC134E] Sequence Decomposing

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc134/tasks/abc134_e

$ N $ 個の整数からなる数列 $ A\ =\ \{\ A_1,\ A_2,\ \cdots,\ A_N\ \} $ が与えられます。 $ N $ 個それぞれの整数に対して、色を $ 1 $ つ選んでその色を塗ります。 この時、以下の条件を満たす必要があります:

- $ A_i $ と $ A_j\ (i\ <\ j) $ が同じ色で塗られているならば $ A_i\ <\ A_j $ が成立する

条件を満たすように色を塗る時、用いる色の数の最小値を求めてください。

## 说明/提示

### 制約

- $ 1\ \leq\ N\ \leq\ 10^5 $
- $ 0\ \leq\ A_i\ \leq\ 10^9 $

### Sample Explanation 1

例えば、$ 2,\ 3 $ を赤色、$ 1,\ 4,\ 5 $ を青色で塗れば $ 2 $ 色で条件を満たす塗り方が出来ます。

### Sample Explanation 2

全ての整数を異なる色で塗るしかありません。

## 样例 #1

### 输入

```
5

2

1

4

5

3```

### 输出

```
2```

## 样例 #2

### 输入

```
4

0

0

0

0```

### 输出

```
4```

# AI分析结果



### 题目翻译
[ABC134E] Sequence Decomposing

## 题目描述
给定一个由 $N$ 个整数组成的数列 $A = \{ A_1, A_2, \cdots, A_N \}$。为每个整数涂色，要求：若 $A_i$ 和 $A_j$（$i < j$）颜色相同，则必须满足 $A_i < A_j$。求所需的最少颜色数。

### 样例解释
例如，样例1中可用2种颜色满足条件。样例2中所有数必须用不同颜色。

---

### 算法分类
**贪心**（转化为最长不上升子序列问题）

---

### 题解综合分析
本题核心思路为：最少颜色数等于最长不上升子序列的长度。各题解通过不同方法实现这一关键点，主要分为两类：
1. **贪心+二分**：维护最长不上升子序列的末位元素，通过二分优化替换过程。
2. **multiset维护**：利用平衡树特性动态维护可接续的子序列末位。

---

### 精选题解（评分≥4星）

#### 1. Silence_water 的贪心+二分法（5星）
**关键亮点**：
- 直接将问题转化为导弹拦截模型，思路清晰
- 使用 `upper_bound` 维护最长不上升子序列
- 代码简洁高效，时间复杂度 $O(n \log n)$

```cpp
int dp[M], len = 1;
scanf("%d", &dp[1]);
for (int i = 2; i <= n; i++) {
    int p = upper_bound(dp + 1, dp + len + 1, x, greater<int>()) - dp;
    dp[p] = x;
    len = max(len, p);
}
printf("%d", len);
```

#### 2. SilverLi 的 multiset 解法（4星）
**关键亮点**：
- 直观维护子序列末位集合
- 利用 `lower_bound` 寻找可接续位置
- 处理边界条件严谨

```cpp
multiset<int> s;
s.insert(a[1]);
for (int i = 2; i <= n; ++i) {
    auto it = s.lower_bound(a[i]);
    if (it != s.begin()) {
        s.erase(--it);
        s.insert(a[i]);
    } else {
        s.insert(a[i]);
    }
}
```

#### 3. _7Mr 的二分优化（4星）
**亮点**：通过逆向思维将问题转换为标准的贪心维护模式，代码实现简洁。

---

### 关键思路总结
**最优技巧**：
1. **问题转化**：将颜色数问题等价转换为最长不上升子序列长度问题。
2. **贪心维护**：每次将新元素替换第一个小于它的末位元素，保证后续选择空间最大化。
3. **逆向处理**：通过取反（如 `x = -x-1`）将严格递增转换为非递增处理。

**调试心得**：
- 需注意严格递增条件对二分比较逻辑的影响（如使用 `upper_bound` 而非 `lower_bound`）
- 离散化时需处理值域转换避免边界问题

---

### 推荐相似题目
1. [P1020 导弹拦截](https://www.luogu.com.cn/problem/P1020) - 直接应用最长不上升子序列模型
2. [P1091 合唱队形](https://www.luogu.com.cn/problem/P1091) - 双向 LIS 应用
3. [CF1433E Two Round Dances](https://www.luogu.com.cn/problem/CF1433E) - 组合数学与序列划分

---
处理用时：56.40秒
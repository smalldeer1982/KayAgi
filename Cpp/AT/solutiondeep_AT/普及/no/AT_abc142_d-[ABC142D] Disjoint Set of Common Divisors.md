# 题目信息

# [ABC142D] Disjoint Set of Common Divisors

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc142/tasks/abc142_d

正整数 $ A,\ B $ が与えられます。

$ A $ と $ B $ の正の公約数の中からいくつかを選びます。

ただし、選んだ整数の中のどの異なる $ 2 $ つの整数についても互いに素でなければなりません。

最大でいくつ選べるでしょうか。

 公約数とは整数 $ d $ が整数 $ x $ と整数 $ y $ の公約数であるとは、$ d $ が $ x $ と $ y $ をともに割り切ることをいいます。

 

互いに素とは整数 $ x,\ y $ が互いに素であるとは、$ x,\ y $ の正の公約数が $ 1 $ のみであることをいいます。

 

割り切るとは整数 $ x $ が整数 $ y $ を割り切るとは、$ y\ =\ \alpha\ x $ なる整数 $ \alpha $ が存在することをいいます。

## 说明/提示

### 制約

- 入力は全て整数である。
- $ 1\ \leq\ A,\ B\ \leq\ 10^{12} $

### Sample Explanation 1

$ 12 $ と $ 18 $ の正の公約数は $ 1,\ 2,\ 3,\ 6 $ です。 $ 1 $ と $ 2 $、$ 2 $ と $ 3 $、$ 3 $ と $ 1 $ は互いに素なので、$ 1,\ 2,\ 3 $ を選ぶことができ、このときが最大です。

### Sample Explanation 3

$ 1 $ と $ 2019 $ の正の公約数は $ 1 $ しかありません。

## 样例 #1

### 输入

```
12 18```

### 输出

```
3```

## 样例 #2

### 输入

```
420 660```

### 输出

```
4```

## 样例 #3

### 输入

```
1 2019```

### 输出

```
1```

# AI分析结果



【中文重写题目】  
给定两个正整数 $A$ 和 $B$，从它们的正公因数中选出若干个数，使得任意两个选出的数互质。求最多能选多少个数。

【算法分类】  
数学

---

### 题解综合分析

所有题解的核心思路均为：  
1. 计算 $\gcd(A,B)$，其所有因数均为公因数  
2. 对 $\gcd(A,B)$ 分解质因数，质因数个数+1（含1）即为答案  
**关键证明**：选质因数能保证两两互质，且数量最大。

---

### 精选题解

#### 1. 作者：tZEROちゃん（5星）
**亮点**  
- 代码简洁，逻辑清晰  
- 直接使用 `__gcd` 函数简化代码  
- 正确处理分解后的剩余质因数  

**核心代码**  
```cpp
LL G = __gcd(N, M);
int cnt = 1;
for (LL i = 2; i <= sqrt(G); ++i) {
    if (G % i == 0) {
        cnt++;
        while (G % i == 0) G /= i;
    }
}
if (G != 1) cnt++;
cout << cnt << endl;
```

#### 2. 作者：2c_s（5星）
**亮点**  
- 使用 `typedef` 增强可读性  
- 显式处理边界条件  
- 无冗余变量  

**核心代码**  
```cpp
ll tmp = __gcd(a, b), ans = 1;
for (ll i = 2; i*i <= tmp; ++i) {
    if (tmp % i == 0) {
        ans++;
        while (tmp % i == 0) tmp /= i;
    }
}
if (tmp != 1) ans++;
cout << ans << endl;
```

#### 3. 作者：沉石鱼惊旋（4星）
**亮点**  
- 包含详细数学证明  
- 解释质因数分解的正确性  
- 代码中显式处理2的倍数优化  

**核心代码片段**  
```cpp
if (d % 2 == 0) ans++;
while (d % 2 == 0) d /= 2;
for (ll i = 3; i*i <= d; i += 2) {
    if (d % i == 0) {
        ans++;
        while (d % i == 0) d /= i;
    }
}
```

---

### 关键技巧总结

1. **数学性质转化**：将问题转化为质因数分解问题  
2. **边界处理**：分解后若剩余数>1，则必为质因数  
3. **优化方向**：  
   - 循环至 $\sqrt{n}$ 即可覆盖所有质因数  
   - 优先处理2的倍数，之后步长+2跳过偶数  

---

### 类似题目推荐

1. [P1075 质因数分解](https://www.luogu.com.cn/problem/P1075)  
2. [P2445 细胞分裂](https://www.luogu.com.cn/problem/P2445)  
3. [P1069 分解质因数](https://www.luogu.com.cn/problem/P1069)  

---

### 调试心得摘录

- **变量溢出**：循环变量必须用 `long long`（如 `for (int i=2; ...)` 会溢出）  
- **特殊值处理**：当 $\gcd(A,B)=1$ 时答案只能是1  
- **分解顺序**：需先除尽当前质因数再递增，避免漏判复合数

---
处理用时：45.30秒
# 题目信息

# [ABC166E] This Message Will Self-Destruct in 5s

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc166/tasks/abc166_e

AtCoder 王国の優秀なエージェントであるあなたは、盗まれた極秘情報が AlDebaran 王国の手に渡ることを阻止するため、取引現場であるパーティに潜入しました。

パーティには $ N $ 人の参加者がおり、それぞれ $ 1 $ から $ N $ までの番号がついています。参加者 $ i $ の身長は $ A_i $ です。

あなたは事前の尋問によって、極秘情報を取引するのは以下の条件を満たす $ 2 $ 人組であることを知っています。

- $ 2 $ 人の持つ番号の差の絶対値が、$ 2 $ 人の身長の和に等しい。

$ N $ 人の参加者のうちから $ 2 $ 人を選んでペアにする方法は $ \frac{N(N-1)}{2} $ 通りありますが、このうち上の条件を満たすペアは何通りあるでしょう？

なお、極秘情報の内容が何であるかはあなたの知るところではありません。

## 说明/提示

### 制約

- 入力はすべて整数
- $ 2\ \leq\ N\ \leq\ 2\ \times\ 10^5 $
- $ 1\ \leq\ A_i\ \leq\ 10^9\ (1\ \leq\ i\ \leq\ N) $

### Sample Explanation 1

\- $ A_1\ +\ A_4\ =\ 3 $ なので、参加者 $ 1,\ 4 $ のペアは条件を満たします。 - $ A_2\ +\ A_6\ =\ 4 $ なので、参加者 $ 2,\ 6 $ のペアは条件を満たします。 - $ A_4\ +\ A_6\ =\ 2 $ なので、参加者 $ 4,\ 6 $ のペアは条件を満たします。 その他に作れるペアはいずれも条件を満たさないので、$ 3 $ を出力します。

### Sample Explanation 2

条件を満たすペアが存在しないので、$ 0 $ を出力します。

## 样例 #1

### 输入

```
6

2 3 3 1 3 1```

### 输出

```
3```

## 样例 #2

### 输入

```
6

5 2 4 2 8 8```

### 输出

```
0```

## 样例 #3

### 输入

```
32

3 1 4 1 5 9 2 6 5 3 5 8 9 7 9 3 2 3 8 4 6 2 6 4 3 3 8 3 2 7 9 5```

### 输出

```
22```

# AI分析结果



# [ABC166E] This Message Will Self-Destruct in 5s

## 题目描述

AtCoder 王国的优秀特工需要阻止机密信息被盗。在派对现场有 $N$ 名参与者，编号为 $1$ 到 $N$，参与者 $i$ 的身高为 $A_i$。要求找出满足以下条件的两人组数量：

- 两人编号差的绝对值等于两人身高之和。

求符合条件的无序数对总数。

## 算法分类
数学

---

## 题解综合分析

题目核心是将绝对值条件转化为代数关系，通过数学变形转化为哈希统计问题。主要思路是将 $|i-j|=A_i+A_j$ 转化为 $i+A_i = j-A_j$（假设 $i<j$），使用哈希表记录每个位置计算值的前缀出现次数。

### 最优思路总结
将原式变形为 $i+A_i = j-A_j$，遍历时维护哈希表统计 $i+A_i$ 的出现次数。对于每个 $j$，累加哈希表中 $j-A_j$ 对应的出现次数，时间复杂度 $O(N)$ 或 $O(N \log N)$。

---

## 推荐题解（评分≥4星）

### 1. 作者：fighter（★★★★★）
**关键亮点**  
- 简洁的数学变形：将条件转化为 $A_i-i = -A_j-j$  
- 使用 `map` 实时维护键值对  
- 单次遍历同时统计和更新，代码效率高

**核心代码**  
```cpp
map<ll, ll> mp;
for(int i = 1; i <= n; i++){
    ans += mp[a[i]-i];
    mp[-a[i]-i]++;
}
```

### 2. 作者：yuheng_wang080904（★★★★☆）
**关键亮点**  
- 直观的变量命名提升可读性  
- 使用 `i+A_i` 直接作为键，逻辑清晰  
- 完整处理输入输出的代码框架  

**核心代码**  
```cpp
map<int,int> m;
for(int i=1;i<=n;i++){
    ans += m[i-a[i]];
    m[i+a[i]]++;
}
```

### 3. 作者：Lyu_echo（★★★★☆）
**个人心得**  
- 强调 `long long` 防止数据溢出  
- 使用临时变量暂存当前值减少内存占用  
- 详细注释说明哈希表操作意义  

**核心代码**  
```cpp
map<int,int> s;
for(int i=1;i<=n;i++){
    ans += s[i-t];  // t为当前A[i]
    s[t+i]++;       // 记录i+A[i]
}
```

---

## 相似题目推荐
1. [P1102 A-B 数对](https://www.luogu.com.cn/problem/P1102) - 差值统计的哈希应用  
2. [P1678 烦恼的高考志愿](https://www.luogu.com.cn/problem/P1678) - 绝对值问题的数学变形  
3. [CF702C Cellular Network](https://www.luogu.com.cn/problem/CF702C) - 利用排序和二分处理距离问题

---
处理用时：53.40秒
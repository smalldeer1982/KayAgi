# 题目信息

# [ABC169D] Div Game

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc169/tasks/abc169_d

正の整数 $ N $ が与えられます。 $ N $ に対して、以下の操作を繰り返し行うことを考えます。

- はじめに、以下の条件を全て満たす正の整数 $ z $ を選ぶ。
  - ある素数 $ p $ と正の整数 $ e $ を用いて、 $ z=p^e $ と表せる
  - $ N $ が $ z $ で割り切れる
  - 以前の操作で選んだどの整数とも異なる
- $ N $ を、$ N/z $ に置き換える

最大で何回操作を行うことができるか求めてください。

## 说明/提示

### 制約

- 入力はすべて整数である。
- $ 1\ \leq\ N\ \leq\ 10^{12} $

### Sample Explanation 1

例えば、次のように操作を行うことで、 $ 3 $ 回操作を行うことができます。 - $ z=2\ (=2^1) $ とする。( 操作後、 $ N=12 $ となる。) - $ z=3\ (=3^1) $ とする。( 操作後、 $ N=4 $ となる。 ) - $ z=4\ (=2^2) $ とする。( 操作後、 $ N=1 $ となる。 )

### Sample Explanation 2

一度も操作を行うことができません。

### Sample Explanation 3

例えば、次のように操作を行うことで、 $ 3 $ 回操作を行うことができます。 - $ z=2\ (=2^1) $ とする。( 操作後、 $ N=32 $ となる。) - $ z=4\ (=2^2) $ とする。( 操作後、 $ N=8 $ となる。 ) - $ z=8\ (=2^3) $ とする。( 操作後、 $ N=1 $ となる。 )

### Sample Explanation 4

例えば、次のように操作を行うことで、 $ 1 $ 回操作を行うことができます。 - $ z=1000000007\ (=1000000007^1) $ とする。( 操作後、 $ N=1 $ となる。 )

## 样例 #1

### 输入

```
24```

### 输出

```
3```

## 样例 #2

### 输入

```
1```

### 输出

```
0```

## 样例 #3

### 输入

```
64```

### 输出

```
3```

## 样例 #4

### 输入

```
1000000007```

### 输出

```
1```

## 样例 #5

### 输入

```
997764507000```

### 输出

```
7```

# AI分析结果



# [ABC169D] Div Game

## 题目描述

给定一个正整数 $N$。重复以下操作：

- 选择一个正整数 $z$，满足：
  - $z = p^e$（$p$ 为素数，$e$ 为正整数）
  - $z$ 能整除当前的 $N$
  - $z$ 与之前选过的所有 $z$ 不同
- 将 $N$ 替换为 $N/z$

求最多可以进行多少次操作。

## 算法分类
数学（质因数分解、贪心）

---

### 题解分析与结论
所有题解的核心思路均为：将 $N$ 质因数分解后，对每个质因数的指数 $e_i$，求最大的 $k$ 使得 $1+2+\dots+k \leq e_i$。总操作次数为各质因数对应 $k$ 的总和。

### 最优思路提炼
1. **质因数分解**：将 $N$ 分解为 $\prod p_i^{e_i}$。
2. **贪心拆分指数**：对每个 $e_i$，找到最大的 $k$ 满足 $\frac{k(k+1)}{2} \leq e_i$，累加所有 $k$。
3. **数学优化**：通过解不等式或循环直接计算 $k$，时间复杂度 $O(\sqrt{N})$。

---

### 高星题解推荐
#### 1. 作者：ran_qwq（4.5星）
**亮点**：
- 代码结构清晰，独立函数计算每个指数的最大操作次数。
- 使用分解质因数的标准写法，易于理解。

核心代码：
```cpp
int f(int x) {
    int ret = 0;
    while (x - ret > 0) x -= ret + 1, ret++;
    return ret;
}
// 分解质因数后循环调用 f(e_i)
```

#### 2. 作者：DDF_（4星）
**亮点**：
- 直接在质因数分解循环中处理，减少存储空间。
- 贪心策略简洁高效，无额外函数调用。

核心代码：
```cpp
for (long long i = 2; i * i <= n; i++) {
    long long s = 1, t = 0;
    while (n % i == 0) {
        n /= i, t++;
        if (t == s) ans++, s++, t = 0;
    }
}
if (n > 1) ans++;
```

#### 3. 作者：WuMin4（4星）
**亮点**：
- 数学推导优化，使用平方根计算 $k$，避免循环。
- 公式转化明确，提升计算效率。

核心代码：
```cpp
ans += floor(sqrt(2 * cnt + 0.25) - 0.5); // 解方程 k(k+1)/2 ≤ cnt
```

---

### 关键技巧
- **质因数分解的边界处理**：循环到 $\sqrt{n}$ 后需检查剩余值是否为质数。
- **数学公式优化**：将 $k$ 的计算转化为 $\lfloor \sqrt{2e_i} \rfloor$，减少循环次数。
- **贪心策略的正确性**：每次取最小可用指数保证操作次数最大化。

---

### 拓展练习
1. [P1075 质因数分解](https://www.luogu.com.cn/problem/P1075)
2. [P1069 细胞分裂](https://www.luogu.com.cn/problem/P1069)
3. [P2043 质因数分解](https://www.luogu.com.cn/problem/P2043)

---

### 个人心得摘录
- **调试经验**：分解质因数后若 $n \neq 1$ 需单独处理（如 `if(n>1) ans++`）。
- **优化教训**：直接解二次方程比循环更高效，但需注意浮点精度问题。
- **顿悟点**：每个质因数的操作独立，可分别处理再求和，避免全局状态维护。

---
处理用时：51.70秒
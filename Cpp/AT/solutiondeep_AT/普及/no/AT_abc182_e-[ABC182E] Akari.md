# 题目信息

# [ABC182E] Akari

## 题目描述

有一个 $H$ 行 $W$ 列的网格，定义 $(i,j)$ 是第 $i$ 行 $j$ 列的方格。

这个网格上有 $N$ 个灯泡和 $M$ 个障碍物，第 $i$ 个灯泡在 $(A_i,B_i)$ 处，第 $i$ 个障碍物在 $(C_i, D_i)$ 处。每个方格保证最多只有一个灯泡或障碍物。

每一个灯泡都会将光照向上下左右四个方向延伸，直至遇到障碍物或到达边界。灯泡所在的方格也会有光照。

请你计算，被光照照到且没有障碍物的方格有多少。

## 样例 #1

### 输入

```
3 3 2 1

1 1

2 3

2 2```

### 输出

```
7```

## 样例 #2

### 输入

```
4 4 3 3

1 2

1 3

3 4

2 3

2 4

3 2```

### 输出

```
8```

## 样例 #3

### 输入

```
5 5 5 1

1 1

2 2

3 3

4 4

5 5

4 2```

### 输出

```
24```

# AI分析结果



# [ABC182E] Akari

## 题目描述

有一个 $H$ 行 $W$ 列的网格，定义 $(i,j)$ 是第 $i$ 行第 $j$ 列的方格。网格中有 $N$ 个灯泡和 $M$ 个障碍物，每个灯泡会向上下左右四个方向发射光线，直到遇到障碍物或边界。要求计算被光照覆盖且没有障碍物的方格数量。

**算法分类**：模拟

---

## 题解分析与结论

### 题解对比与核心思路
所有题解的核心思路均围绕光线传播的模拟展开，主要分为两种实现方式：

1. **逐灯泡方向扫描**（如 fangyicheng1216）
   - 对每个灯泡单独处理四个方向
   - 存在坐标轴混淆风险，可能引发错误
   - 时间复杂度 $O(N \cdot (H+W))$，存在 TLE 风险

2. **全局方向扫描**（如 hellolin、Code_Fish_GoodBye）
   - 按行/列分四个方向全局扫描（右、左、下、上）
   - 维护光照状态变量，遇灯泡开启，遇障碍物关闭
   - 时间复杂度 $O(HW)$，线性复杂度最优

### 最优解法关键
采用四次全局扫描，每个方向独立处理：
1. 行方向：从左到右、从右到左各扫描一次
2. 列方向：从上到下、从下到上各扫描一次
3. 维护状态变量记录当前是否处于光照传播状态
4. 最终统计被标记的合法格子

### 推荐题解

#### 题解1：hellolin（5星）
**亮点**：
- 清晰的四向全局扫描逻辑
- 状态变量设计简洁高效
- 代码结构工整易读

**核心代码**：
```cpp
// 行扫描（右方向）
for(int i=1; i<=h; i++) {
    bool f = false;
    for(int j=1; j<=w; j++) {
        if(p[i][j]==1) f = true;   // 遇到灯泡开启光照
        else if(p[i][j]==-1) f = false; // 遇到障碍物关闭
        if(f && !z[i][j]) ans++, z[i][j]=1;
    }
}
// 类似处理其他三个方向...
```

#### 题解2：Code_Fish_GoodBye（4星）
**亮点**：
- 使用整型数组区分多种状态
- 通过四次独立扫描覆盖所有情况
- 引入中间状态标记避免重复计数

**关键实现**：
```cpp
// 向右扫描标记光照
for(int i=1; i<=h; i++){
    bool flag = false;
    for(int j=1; j<=w; j++){
        if(cv[i][j]==2) flag = true;
        else if(cv[i][j]==3) flag = false;
        if(flag && cv[i][j]==0) cv[i][j]=1, outp++;
    }
}
```

#### 题解3：Dehydration（4星）
**亮点**：
- 位运算优化状态标记
- 双重循环处理行列方向
- 代码简洁且内存优化

**核心片段**：
```cpp
// 行方向处理
for(int i=1; i<=H; i++){
    int flag=0;
    for(int j=1; j<=W; j++){
        if(a[i][j]==1) flag=1;
        else if(a[i][j]==2) flag=0;
        ok[i][j] |= flag;
    }
}
```

---

## 举一反三
1. **类似方向扫描**：P1878 照明（灯光覆盖问题）
2. **状态传播模拟**：P1162 填涂颜色（闭合区域标记）
3. **复合状态处理**：P2897 激光塔（多方向动态障碍）

**总结技巧**：  
全局方向扫描法通过统一处理行列方向，将时间复杂度优化至线性级别，是网格类模拟问题的经典解法。关键在于合理设计状态标记机制，避免重复计算。

---
处理用时：88.27秒
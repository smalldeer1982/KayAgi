# 题目信息

# [ABC190D] Staircase Sequences

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc190/tasks/abc190_d

整数からなる公差 $ 1 $ の等差数列のうち、総和が $ N $ であるものはいくつあるでしょうか？

## 说明/提示

### 制約

- $ 1\ <\ =\ N\ <\ =\ 10^{12} $
- $ N $ は整数

### Sample Explanation 1

\- $ [12] $ - $ [3,\ 4,\ 5] $ - $ [-2,\ -1,\ 0,\ 1,\ 2,\ 3,\ 4,\ 5] $ - $ [-11,\ -10,\ -9,\ \dots,\ 10,\ 11,\ 12] $ の $ 4 $ 個です。

### Sample Explanation 2

\- $ [1] $ - $ [0,\ 1] $ の $ 2 $ 個です。

## 样例 #1

### 输入

```
12```

### 输出

```
4```

## 样例 #2

### 输入

```
1```

### 输出

```
2```

## 样例 #3

### 输入

```
963761198400```

### 输出

```
1920```

# AI分析结果



# 题目中文重写

## 题目描述

给定整数 $N$，求公差为 $1$ 的等差数列中，总和等于 $N$ 的数列个数。

## 输入格式

输入为一个整数 $N$。

## 输出格式

输出满足条件的等差数列数量。

## 样例解释

### 样例 1
输入：12  
输出：4  
解释：满足条件的数列为：  
- [12]  
- [3,4,5]  
- [-2,-1,0,1,2,3,4,5]  
- [-11,-10,...,12]

### 样例 2
输入：1  
输出：2  
解释：满足条件的数列为 [1] 和 [0,1]。

---

**算法分类**：数学

---

# 题解分析与结论

## 核心思路对比

### 题解1：暴力枚举因数对
- **关键思路**：将问题转化为求 $2N$ 的因数对 $(x,y)$，其中 $x$ 和 $y$ 奇偶性不同。通过枚举 $i \leq \sqrt{2N}$ 的因数，统计符合条件的因数对数量，最终结果乘以 2。
- **优点**：代码简单，适用于小数据。
- **缺点**：时间复杂度 $O(\sqrt{N})$，对 $N \leq 10^{12}$ 可能较慢。

### 题解2：质因数分解优化
- **关键思路**：将 $2N$ 分解为 $2^k \cdot m$（$m$ 为奇数），则答案等于 $2 \times \tau(m)$，其中 $\tau(m)$ 是 $m$ 的因数个数。利用 Pollard-Rho 算法高效分解质因数。
- **优点**：时间复杂度 $O(N^{1/4})$，适用于大数据。
- **难点**：需实现复杂的质因数分解算法。

## 最优关键思路
**数学优化**：通过将 $2N$ 分解为 $2^k \cdot m$（$m$ 为奇数），答案即为 $2 \times \tau(m)$。此方法避免了暴力枚举，直接通过质因数分解统计因数个数，效率极高。

---

# 精选题解

## 题解1（4星）
**关键亮点**：  
- 思路直观，代码简洁。  
- 通过奇偶性判断快速筛选因数对。  

**核心代码**：
```cpp
long long n; 
cin >> n;
n *= 2;
int cnt = 0;
for (long long i = 1; i*i <= n; i++) {
    if (n%i == 0 && i%2 != (n/i)%2) cnt++;
}
cout << cnt * 2;
```

## 题解2（5星）
**关键亮点**：  
- 数学优化显著降低时间复杂度。  
- 使用 Pollard-Rho 处理大数分解，适用于所有数据范围。  

**核心实现**：
```cpp
// 分解质因数后统计因子个数
int ans = 1;
vector<int> d;
factor(n, d); // Pollard-Rho分解质因数
for (auto x : d) ans *= (cnt[x] + 1), cnt[x]++;
ans *= 2;
cout << ans;
```

---

# 拓展与同类题目

**相似知识点题目**：  
1. [P1403 约数研究](https://www.luogu.com.cn/problem/P1403)  
2. [P2424 约数和](https://www.luogu.com.cn/problem/P2424)  
3. [P1072 Hankson的趣味题](https://www.luogu.com.cn/problem/P1072)

**关键思维**：  
- 将复杂问题转化为数学因数分解问题。  
- 利用奇偶性等数学性质减少无效计算。

---
处理用时：362.97秒
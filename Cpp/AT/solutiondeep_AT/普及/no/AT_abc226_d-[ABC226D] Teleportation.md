# 题目信息

# [ABC226D] Teleportation

## 题目描述

AtCoder国家位于无限多的笛卡尔坐标上。

AtCoder国家有 $N$ 个城镇，编号为 $1,2,...,N$。

镇i位于点$(x_i,y_i)$，没有两个不同编号的镇可以在同一坐标上。
AtCoder国家有过渡魔法 (以下简称魔法）。

魔法由一对整数 $(a,b)$ 标识，如果你在点 $(x,y)$ 并使用魔法 $(a,b)$，你可以穿越到 $(x+a，y+b)$。

有一个伟大的魔术师（以下简称魔法师），他可以选择任何一对整数 $(a,b)$ 并学习魔术 $(a,b)$。 魔法师还可以学习任何数量的不同种类的魔法。

当他想用魔法从一个城市移动到另一个城市时，他决定学习一些魔法，这样他就可以对所有一对 $(i,j)$ 不同的城市进行以下操作。

在你所学的魔法中只选择一种类型的魔法时，就只能重复使用所选的魔法，从城市 $i$ 移动到城市 $j$。

为了满足上述条件，魔法师至少要学会多少种不同的魔法？

## 样例 #1

### 输入

```
3

1 2

3 6

7 4```

### 输出

```
6```

## 样例 #2

### 输入

```
3

1 2

2 2

4 2```

### 输出

```
2```

## 样例 #3

### 输入

```
4

0 0

0 1000000000

1000000000 0

1000000000 1000000000```

### 输出

```
8```

# AI分析结果



# 题目中文翻译  
## [ABC226D] 瞬间移动  

### 题目描述  
AtCoder国位于无限的笛卡尔坐标系中，有N个城镇（编号1~N），每个城镇坐标唯一。  
魔法由整数对(a,b)标识，使用后可从(x,y)移动到(x+a,y+b)。需选择最少数量的魔法，使得任意两个城镇i和j可通过重复使用单一魔法相互到达。  

### 输入格式  
第一行输入N，随后N行每行两个整数表示坐标。  

### 输出格式  
输出最少需要学习的魔法种类数。  

### 样例  
样例1输入：  
3  
1 2  
3 6  
7 4  
输出：6  

---

**算法分类**：数学（最大公约数应用）  

---

### 题解综合分析  
核心思路：对于所有城镇对，计算其位移向量的最简形式（除以GCD并保留方向），用集合去重统计不同魔法数量。  
关键点：  
1. 必须遍历所有i→j和j→i的情况，否则会漏解（如(1,1)与(-1,-1)是不同的魔法）  
2. 计算GCD时需取绝对值，确保最简形式方向正确  
3. 使用set<pair<int,int>>自动处理方向性去重  

---

### 精选题解  
#### 1. 作者：__WaveN__（5星）  
**关键亮点**：  
- 正确处理双向遍历（i=1~n, j=1~n）  
- 显式处理GCD绝对值  
- 代码简洁直观，注释清晰  

核心代码：  
```cpp
set<pair<int,int>> a;
for(int i=1;i<=n;i++) {
    for(int j=1;j<=n;j++) {
        if(i==j) continue;
        int tx=x[j]-x[i], ty=y[j]-y[i];
        int GCD=abs(gcd(tx,ty)); // 关键点：取绝对值
        a.insert({tx/GCD, ty/GCD});
    }
}
cout<<a.size();
```

#### 2. 作者：CYZZ（4星）  
**亮点**：  
- 使用STL的__gcd简化代码  
- 详细注释解释方向性问题  
- 正确处理坐标差符号  

代码片段：  
```cpp
set<pair<int,int>>s;
for(int i=1;i<=n;i++) {
    for(int j=1;j<=n;j++) { // 正确遍历双向
        if(i==j) continue;
        int x=..., y=..., z=abs(__gcd(x,y)); // 正确取绝对值
        s.insert({x/z,y/z});
    }
}
```

---

### 关键技巧总结  
1. **方向处理**：位移向量(a,b)与(-a,-b)需视为不同魔法，必须完整遍历所有城镇对  
2. **最简向量**：通过GCD约分确保魔法可重复使用，注意符号由原始位移决定  
3. **数据结构选择**：使用有序集合自动去重，时间复杂度O(n²logn)可接受  

---

### 拓展练习  
1. [P1495 曹冲养猪](https://www.luogu.com.cn/problem/P1495)（同余方程组）  
2. [CF514B Han Solo and Lazer Gun](https://www.luogu.com.cn/problem/CF514B)（斜率最简形式统计）  
3. [ABC131D Megalith](https://atcoder.jp/contests/abc131/tasks/abc131_d)（向量方向分类）  

---

### 题解心得摘录  
> "必须从1~n遍历所有i,j对，因为A→B和B→A是两种不同的魔法方向" —— CYZZ  
> "计算GCD时取绝对值是关键，否则会导致符号错误" —— __WaveN__  
> 调试教训：最初以为只需遍历i<j，结果发现相反方向的魔法可能不同 —— 匿名用户

---
处理用时：59.00秒
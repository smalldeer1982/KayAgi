# 题目信息

# [ABC230E] Fraction Floor Sum

## 题目描述

求 $\large{\sum\limits_{i=1}^N ⌊\frac{N}{i}⌋}$ 的值

## 样例 #1

### 输入

```
3```

### 输出

```
5```

## 样例 #2

### 输入

```
10000000000```

### 输出

```
231802823220```

# AI分析结果



# [ABC230E] Fraction Floor Sum 的题解分析与总结

## 题目内容
### 题目描述
求 $\large{\sum\limits_{i=1}^N ⌊\frac{N}{i}⌋}$ 的值。

### 样例 #1
输入：3  
输出：5

### 样例 #2
输入：10000000000  
输出：231802823220

**算法分类**：数学（数论分块）

---

## 题解综合分析

### 关键思路对比
所有题解核心均为数论分块思想，但存在两种实现方向：
1. **整除分块模板**：寻找值相同的区间 `[l, r]`，计算每块的贡献 `(r-l+1)*(n/l)`，时间复杂度 `O(√n)`。
2. **Dirichlet双曲线法**：数学推导得公式 `ans = 2*∑(n/i) - sq²`（i≤√n），减少循环次数，常数更优。

### 最优解法提炼
**Adchory 的 Dirichlet 双曲线法**（5星）：
- **亮点**：数学推导将复杂度从显式分块优化为隐式计算，代码极简（仅需7行）。
- **核心公式**：`∑⌊n/i⌋ = 2*∑⌊n/i⌋（i≤√n） - (√n)^2`。
- **代码实现**：
  ```cpp
  ll n,sq,ans; 
  int main(){
      scanf("%lld",&n);
      sq=sqrt(n);
      for(ll i=1;i<=sq;i++) ans+=n/i;
      printf("%lld",ans*2-sq*sq); 
      return 0;
  }
  ```

**CQ_Bob 的整除分块模板**（4星）：
- **亮点**：标准分块实现，通用性强，适合理解分块原理。
- **核心代码**：
  ```cpp
  for(re int l=1,r;l<=n;l=r+1) {
      r=n/(n/l);
      ans+=(r-l+1)*(n/l);
  }
  ```

---

## 关键技巧总结
1. **数论分块思想**：将相同值的连续区间合并计算，时间复杂度从 `O(n)` 优化至 `O(√n)`。
2. **Dirichlet优化**：利用对称性减少计算量，将求和拆分为前√n项和后√n项的对称贡献。
3. **边界处理**：正确计算分块右端点 `r = n/(n/l)` 是关键，需注意整数除法特性。

---

## 拓展与同类题
1. **调试经验**：验证分块正确性时可用小数据手动模拟（如n=5）。
2. **同类题目**：
   - [P2261 [CQOI2007] 余数求和](https://www.luogu.com.cn/problem/P2261)
   - [P3935 Calculating](https://www.luogu.com.cn/problem/P3935)
   - [P2260 [清华集训2012] 模积和](https://www.luogu.com.cn/problem/P2260)

---
处理用时：39.12秒
# 题目信息

# [ABC246D] 2-variable Function

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc246/tasks/abc246_d

整数 $ N $ が与えられるので、以下の条件を全て満たす最小の整数 $ X $ を求めてください。

- $ X $ は $ N $ 以上である。
- 非負整数 $ (a,b) $ の組であって、 $ X=a^3+a^2b+ab^2+b^3 $ を満たすようなものが存在する。

## 说明/提示

### 制約

- $ N $ は整数
- $ 0\ \le\ N\ \le\ 10^{18} $

### Sample Explanation 1

$ 9\ \le\ X\ \le\ 14 $ であるようなどの整数 $ X $ についても、問題文中の条件を満たすような $ (a,b) $ は存在しません。 $ X=15 $ は $ (a,b)=(2,1) $ とすると問題文中の条件を満たします。

### Sample Explanation 2

$ N $ 自身が条件を満たすこともあります。

### Sample Explanation 3

入出力が $ 32 $bit 整数型に収まらない場合があります。

## 样例 #1

### 输入

```
9```

### 输出

```
15```

## 样例 #2

### 输入

```
0```

### 输出

```
0```

## 样例 #3

### 输入

```
999999999989449206```

### 输出

```
1000000000000000000```

# AI分析结果



# [ABC246D] 2-variable Function 中文翻译

## 题目描述

给定整数 $N$，请找到满足以下条件的最小整数 $X$：

- $X \ge N$
- 存在非负整数对 $(a, b)$，使得 $X = a^3 + a^2b + ab^2 + b^3$

## 输入样例

样例 #1:  
输入：9  
输出：15  

样例 #2:  
输入：0  
输出：0  

样例 #3:  
输入：999999999989449206  
输出：1000000000000000000  

## 说明/提示

### 数据范围
- $0 \le N \le 10^{18}$

---

**算法分类**：数学、枚举

---

## 题解分析与关键思路

### 题解对比与评分
1. **So_noSlack（5星）**  
   **关键亮点**：  
   - 将原式因式分解为 $(a^2 + b^2)(a + b)$，显著简化计算  
   - 使用双指针法（$a$ 从 0 开始递增，$b$ 从 $10^6$ 开始递减）高效遍历候选值  
   - 代码简洁，时间复杂度 $O(1e6)$  
   **代码核心**：  
   ```cpp
   long long check(long long x, long long y) {
       return (x*x + y*y) * (x + y);
   }
   // 双指针遍历
   while (l <= r) {
       if (check(l, r) < n) l++;
       else {
           ans = min(ans, check(l, r));
           r--;
       }
   }
   ```

2. **Tsawke（4星）**  
   **关键亮点**：  
   - 固定 $a$ 后对 $b$ 进行二分，时间复杂度 $O(1e6 \log 1e6)$  
   - 严格证明单变量单调性，保证二分正确性  
   **代码核心**：  
   ```cpp
   for (int x = 0; x <= 1e6; ++x) {
       int l = 0, r = 1e6;
       while (l <= r) {
           int mid = (l + r) >> 1;
           ll tmp = Func(x, mid);
           if (tmp >= N) cur = tmp, r = mid - 1;
           else l = mid + 1;
       }
       mn = min(mn, cur);
   }
   ```

3. **asas111（4星）**  
   **关键亮点**：  
   - 对每个 $a$ 二分查找最小的 $b$，思路清晰  
   - 直接计算避免浮点误差  
   **代码核心**：  
   ```cpp
   for (ll i = 0; i <= 1e6; i++) {
       ll l = 0, r = 1e6;
       while (l <= r) {
           ll mid = l + (r - l) / 2;
           ll val = (i*i + mid*mid) * (i + mid);
           if (val >= n) ans = val, r = mid - 1;
           else l = mid + 1;
       }
       a = min(a, ans);
   }
   ```

---

### 最优思路总结
1. **数学变形**：将原式 $a^3 + a^2b + ab^2 + b^3$ 因式分解为 $(a^2 + b^2)(a + b)$，减少计算量。  
2. **双指针法**：  
   - 固定 $a$ 从 0 开始，$b$ 从最大值（约 $10^6$）开始递减  
   - 根据当前值与 $N$ 的关系移动指针，时间复杂度 $O(1e6)$  
3. **范围确定**：通过分析得出 $a,b \le 10^6$，避免无效计算。

---

### 拓展与心得
**同类题目推荐**：  
1. [P1102 A-B 数对](https://www.luogu.com.cn/problem/P1102)（双指针/哈希）  
2. [P1024 一元三次方程求解](https://www.luogu.com.cn/problem/P1024)（二分法）  
3. [P1873 砍树](https://www.luogu.com.cn/problem/P1873)（二分答案）  

**调试心得**：  
- 初始值应设为足够大的值（如 $1e18$）以避免遗漏候选解  
- 避免使用 `pow` 函数计算立方根，直接设定 $b$ 的上界为 $10^6$ 更可靠  
- 双指针法中 $a \le b$ 的假设可减少一半计算量  

---

**核心代码片段（双指针法）**  
```cpp
long long n, ans = LLONG_MAX;
cin >> n;
for (long long a = 0, b = 1e6; a <= b; ) {
    long long cur = (a*a + b*b) * (a + b);
    if (cur < n) a++;
    else {
        ans = min(ans, cur);
        b--;
    }
}
cout << ans;
```

---
处理用时：91.04秒
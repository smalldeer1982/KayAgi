# 题目信息

# [ABC250D] 250-like Number

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc250/tasks/abc250_d

以下の条件を満たす整数 $ k $ を「 $ 250 $ に似た数」と呼びます。

- $ k $ が素数 $ p\ <\ q $ を使って $ k=p\ \times\ q^3 $ と表される。

$ N $ 以下の「 $ 250 $ に似た数」は全部でいくつありますか？

## 说明/提示

### 制約

- $ N $ は $ 1 $ 以上 $ 10^{18} $ 以下の整数

### Sample Explanation 1

\- $ 54\ =\ 2\ \times\ 3^3 $ なので、「 $ 250 $ に似た数」です。 - $ 250\ =\ 2\ \times\ 5^3 $ なので、「 $ 250 $ に似た数」です。 $ 250 $ 以下の「 $ 250 $ に似た数」は、以上の $ 2 $ つです。

## 样例 #1

### 输入

```
250```

### 输出

```
2```

## 样例 #2

### 输入

```
1```

### 输出

```
0```

## 样例 #3

### 输入

```
123456789012345```

### 输出

```
226863```

# AI分析结果



# [ABC250D] 250-like Number 中文翻译

## 题目描述

称满足以下条件的整数 $k$ 为「250 相似数」：
- 存在素数 $p < q$，使得 $k = p \times q^3$

给定 $N$，求不超过 $N$ 的「250 相似数」的总个数。

## 说明/提示

### 数据范围
- $1 \le N \le 10^{18}$

### 样例解释
输入 250 时，输出 2（54=2×3³ 和 250=2×5³）

---

**算法分类**：质数

---

## 题解综合分析

### 核心思路
1. **质数预处理**：筛出 $\sqrt[3]{N}$ 范围内的所有质数（约 $10^6$ 量级）
2. **枚举优化**：对于每个质数 $q$，计算满足 $p < q$ 且 $p \le N/q^3$ 的质数数量
3. **高效计数**：采用二分查找或双指针法快速确定最大有效 $p$

### 最优思路提炼
1. **线性筛法预处理质数**：使用欧拉筛在 $O(n)$ 时间内筛出所需质数
2. **逆向枚举立方项**：优先枚举较大的 $q$ 值，通过数学约束减少无效计算
3. **边界处理优化**：在循环中提前终止无效枚举（当 $q^3$ 超过 $N$ 时立即跳出）

---

## 精选题解

### 题解作者：escapist404（4星）
**核心亮点**：
- 使用二分查找快速定位最大有效 $p$
- 时间复杂度最优 $O(\sqrt[3]{N} \log \sqrt[3]{N})$
- 代码简洁易读

**关键代码**：
```cpp
void init(int n) {
    for(int i = 2; i <= n; ++i) {
        if(!vis[i]) prime[cnt++] = i;
        for(int j = 0; j < cnt; ++j) {
            if (i * prime[j] > n) break;
            vis[i*prime[j]] = 1;
            if (i % prime[j] == 0) break;
        }
    }
}

for(int q_idx = 0; q_idx < cnt; ++q_idx) {
    ll q = prime[q_idx];
    ll max_p = n / (q*q*q);
    int valid_p_count = upper_bound(prime, prime+cnt, max_p) - prime;
    ans += min(valid_p_count, q_idx); // 确保 p < q
}
```

---

## 拓展练习
1. [P3383 线性筛素数](https://www.luogu.com.cn/problem/P3383) - 筛法模板
2. [P1217 回文质数](https://www.luogu.com.cn/problem/P1217) - 质数性质应用
3. [P1835 素数密度](https://www.luogu.com.cn/problem/P1835) - 大范围质数筛选

---

## 调试心得摘录
"在处理 $q^3$ 时需要注意数值溢出问题，应先进行除法判断而非直接相乘。例如使用 `n / (q*q*q)` 而非 `q*q*q > n`，后者可能在计算时超过 long long 范围。" —— 摘自题解优化经验

---
处理用时：45.61秒
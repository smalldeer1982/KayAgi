# 题目信息

# [ABC252D] Distinct Trio

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc252/tasks/abc252_d

長さ $ N $ の数列 $ A=(A_1,A_2,\ldots,A_N) $ が与えられます。  
 以下の $ 2 $ 条件をともに満たすような整数の組 $ (i,j,k) $ の個数を求めてください。

- $ 1\leq\ i\ \lt\ j\ \lt\ k\ \leq\ N $
- $ A_i,A_j,A_k $ は相異なる

## 说明/提示

### 制約

- $ 3\ \leq\ N\ \leq\ 2\times\ 10^5 $
- $ 1\ \leq\ A_i\ \leq\ 2\times\ 10^5 $
- 入力に含まれる値は全て整数である

### Sample Explanation 1

条件を満たす整数の組 $ (i,j,k) $ は $ (1,2,3),(1,3,4) $ の $ 2 $ つです。

## 样例 #1

### 输入

```
4

3 1 4 1```

### 输出

```
2```

## 样例 #2

### 输入

```
10

99999 99998 99997 99996 99995 99994 99993 99992 99991 99990```

### 输出

```
120```

## 样例 #3

### 输入

```
15

3 1 4 1 5 9 2 6 5 3 5 8 9 7 9```

### 输出

```
355```

# AI分析结果



【中文题目重写】

# [ABC252D] 不同的三元组

## 题目描述

给定长度为 $N$ 的数列 $A=(A_1,A_2,\ldots,A_N)$，求满足以下条件的整数三元组 $(i,j,k)$ 的个数：
- $1 \leq i < j < k \leq N$
- $A_i, A_j, A_k$ 互不相同

## 说明/提示

**数据范围**：
- $3 \leq N \leq 2 \times 10^5$
- $1 \leq A_i \leq 2 \times 10^5$

**样例解释**：
样例1中满足条件的三元组为 (1,2,3) 和 (1,3,4)，输出为2。

---

**算法分类**：组合数学

---

### 题解综合分析

题目要求统计满足严格递增下标且元素互异的三元组数量。主流解法分为两类：
1. **前缀和+枚举中间值**：通过统计每个元素左右两侧的可用元素数量，以O(V)复杂度计算贡献。
2. **容斥原理**：计算总组合数后，减去存在重复元素的不合法情况。

---

### 高星题解推荐

#### 1. chengning0909（5星）
**核心思路**：枚举中间元素，利用前缀和快速计算左侧较小元素数和右侧较大元素数，乘积即为该元素的贡献。
```cpp
for(int i = 1; i <= INF; i++) {
    ans += 1ll * cnt[i] * s[i - 1] * (s[INF] - s[i]);
}
```
**亮点**：时间复杂度O(n+V)，实现简洁高效，完美利用桶计数和前缀和。

---

#### 2. wnsyou（5星）
**核心思路**：总组合数减去非法情况（两个相同或三个相同元素）。
```cpp
ans = n*(n-1)*(n-2)/6; // 总组合数
ans -= cnt[i]*(cnt[i]-1)*(cnt[i]-2)/6; // 三同
ans -= cnt[i]*(cnt[i]-1)*(n-cnt[i])/2; // 两同一异
```
**亮点**：正难则反的典型应用，公式推导清晰，代码直观易理解。

---

#### 3. As_Snow（4星）
**核心思路**：动态维护有效数对，逐个元素计算贡献。
```cpp
res += sum - num[a]; // 新增有效数对
ans += res - (sum - num[a]) * num[a]; // 当前元素贡献
```
**亮点**：在线性遍历中实时更新答案，空间优化至O(1)，独特的状态维护思路。

---

### 最优思路总结
**前缀和枚举法**和**容斥原理**均为最优解：
- 前缀和法更直接，适合元素值域较小场景。
- 容斥法更具普适性，无需考虑元素分布。

---

### 拓展练习
1. [P1637 三元上升子序列](https://www.luogu.com.cn/problem/P1637)  
   （枚举中间值+前缀和）
2. [P2515 组合问题](https://www.luogu.com.cn/problem/P2515)  
   （组合数性质应用）
3. [P1100 高低位交换](https://www.luogu.com.cn/problem/P1100)  
   （位运算与数学结合）

---
处理用时：202.65秒
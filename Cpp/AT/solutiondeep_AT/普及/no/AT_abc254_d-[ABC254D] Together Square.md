# 题目信息

# [ABC254D] Together Square

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc254/tasks/abc254_d

整数 $ N $ が与えられます。以下の条件を満たす $ N $ 以下の正整数の組 $ (i,j) $ の個数を求めてください。

- $ i\ \times\ j $ は平方数である。

## 说明/提示

### 制約

- $ 1\ \le\ N\ \le\ 2\ \times\ 10^5 $
- $ N $ は整数である。

### Sample Explanation 1

$ (1,1),(1,4),(2,2),(3,3),(4,1),(4,4) $ の $ 6 $ 個が条件を満たします。 $ (2,3) $ は $ 2\ \times\ 3\ =6 $ が平方数でないため条件を満たしません。

## 样例 #1

### 输入

```
4```

### 输出

```
6```

## 样例 #2

### 输入

```
254```

### 输出

```
896```

# AI分析结果



## 题目内容
# [ABC254D] Together Square

## 题目描述

给定整数 $ N $，求满足以下条件的 $ N $ 以下正整数对 $ (i,j) $ 的个数：

- $ i \times j $ 是平方数。

## 说明/提示

### 制約

- $ 1 \le N \le 2 \times 10^5 $
- $ N $ 是整数。

### 样例解释 1

符合条件的对包括：$ (1,1),(1,4),(2,2),(3,3),(4,1),(4,4) $，共 6 个。

---

**算法分类**：数学（平方数分解）

---

### 关键思路与技巧

**核心思路**：  
每个数可以表示为**平方数因子**与**平方自由部分**的乘积。两个数相乘为平方数当且仅当它们的平方自由部分相同。因此，预处理所有数的平方自由部分并统计出现次数，最终答案为各平方自由部分出现次数的平方和。

**优化关键**：  
1. **预处理平方自由部分**：通过筛法去除每个数的所有平方数因子，得到其平方自由部分。
2. **统计计数**：对预处理后的平方自由部分进行频次统计，最终计算结果。

---

### 精选题解

#### 题解1（作者：ChenYanlin_20） ★★★★☆
**关键亮点**：  
- 使用筛法预处理平方自由部分，时间复杂度优化为 $O(n \log n)$。
- 代码简洁高效，直接统计平方自由部分的出现次数。

**核心代码**：
```cpp
#include<bits/stdc++.h>
using namespace std;
const int N=1e6+10;
int f[N],s[N],ans;
int main(){
    int n;
    cin>>n;
    for(int i=1;i<=n;i++) f[i]=i;
    // 去除所有平方因子
    for(int i=2;i*i<=n;i++){
        int t=i*i;
        for(int j=t;j<=n;j+=t){
            while(f[j]%t==0)
                f[j]/=t;
        }
    }
    // 统计平方自由部分出现次数
    for(int i=1;i<=n;i++) s[f[i]]++;
    // 计算结果
    for(int i=1;i<=n;i++) ans += s[i]*s[i];
    cout<<ans;
}
```

---

#### 题解2（作者：chengning0909） ★★★★☆
**关键亮点**：  
- 类似筛法思路，但通过最大平方因子处理，逻辑清晰。
- 直接统计每个数的处理后结果，代码直观。

**核心代码**：
```cpp
for(int i = 1; i <= n; i++) {
    cnt[i / f(i)]++;
}
for(int i = 1; i <= n; i++) {
    ans += cnt[i / f(i)];
}
```

---

#### 题解3（作者：Zikake） ★★★★☆
**关键亮点**：  
- 预处理所有数的平方自由部分，直接统计频次。
- 代码简洁，适合快速实现。

---

### 总结与拓展

**思维启发**：  
- 平方自由分解是处理平方数问题的核心技巧。
- 筛法预处理在数论问题中具有广泛应用。

**同类题目推荐**：  
1. [P2424 约数和](https://www.luogu.com.cn/problem/P2424)  
2. [P4446 [AHOI2018初中组] 根式化简](https://www.luogu.com.cn/problem/P4446)  
3. [P5253 [JSOI2013] 丢番图](https://www.luogu.com.cn/problem/P5253)

---
处理用时：141.23秒
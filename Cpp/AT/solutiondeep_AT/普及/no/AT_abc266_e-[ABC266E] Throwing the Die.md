# 题目信息

# [ABC266E] Throwing the Die

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc266/tasks/abc266_e

サイコロを使ったゲームをします。ゲームは最大 $ N $ 回のターンからなり、各ターンは次のように進行します。

- $ 1,\ldots,6 $ の目が等確率で出る $ 6 $ 面ダイスを振り、出目を $ X $ とする(出目は各ターンで独立とする)。
- 現在が $ N $ ターン目なら、**スコア** を $ X $ とし、ゲームを終了する。
- そうでないとき、ゲームを続行するか終了するか選択する。
  - ゲームを終了する場合、スコアを $ X $ とし、残りのターンは行わずにゲームを終了する。

スコアの期待値が最大になるように行動したとき、スコアの期待値を求めてください。

## 说明/提示

### 制約

- $ 1\ \leq\ N\ \leq\ 100 $

## 样例 #1

### 输入

```
1```

### 输出

```
3.5000000000```

## 样例 #2

### 输入

```
2```

### 输出

```
4.2500000000```

## 样例 #3

### 输入

```
10```

### 输出

```
5.6502176688```

# AI分析结果



# [ABC266E] Throwing the Die

## 题目描述

你正在玩一个掷骰子的游戏，游戏最多进行 $N$ 轮，每轮流程如下：

- 投掷一个均匀的六面骰子，得到点数 $X$（每轮结果相互独立）
- 若是第 $N$ 轮，则游戏结束，得分为 $X$
- 否则可以选择继续游戏或立刻结束（结束时得分为当前 $X$）

求采用最优策略时，得分的期望值。

## 算法分类
动态规划 / 概率论

---

## 题解综合分析

### 核心思路
各题解均采用递推动态规划，核心公式为：
$$ f(i) = \frac{1}{6}\sum_{j=1}^6 \max(f(i-1), j) $$
其中 $f(i)$ 表示进行到第 $i$ 轮时的最大期望值。策略为：若当前掷出值大于后续期望则保留，否则继续游戏。

### 关键实现
使用滚动变量优化空间复杂度至 $O(1)$：
```cpp
double c = 0;  // 初始状态（第0轮）
for (int i = 1; i <= n; i++) {
    double sum = 0;
    for (int j = 1; j <= 6; j++)
        sum += max(c, (double)j);  // 比较当前骰值与后续期望
    c = sum / 6;  // 更新期望
}
```

---

## 精选题解

### FFTotoro（⭐⭐⭐⭐⭐）
**亮点**：空间优化到 $O(1)$，代码简洁高效  
**代码核心**：
```cpp
#include<bits/stdc++.h>
using namespace std;
int main(){
    int n; double c=0; cin>>n;
    for(int i=1;i<=n;i++){
        double c0=0;
        for(int j=1;j<=6;j++) c0 += max(c,1.0*j);
        c = c0/6;
    }
    cout<<fixed<<setprecision(9)<<c;
}
```

### dabenBbx（⭐⭐⭐⭐）
**亮点**：数组递推清晰易懂，适合理解原理  
**代码核心**：
```cpp
double f[105];
int main() {
    cin >> n;
    for (int i=1; i<=n; i++) {
        for (int j=1; j<=6; j++)
            f[i] += (j > f[i-1]) ? j : f[i-1];
        f[i] /= 6;
    }
    cout << fixed << setprecision(10) << f[n];
}
```

### Qiu_chen（⭐⭐⭐⭐）
**亮点**：详细注释说明判断逻辑  
**代码核心**：
```cpp
for(int i=2; i<=n; i++){
    for(int j=1; j<=6; j++){
        if(j >= f[i-1])  // 明确说明比较逻辑
            f[i] += j;
        else 
            f[i] += f[i-1];
    }
    f[i] /= 6;
}
```

---

## 拓展与同类题目
**关键技巧**：  
1. 逆向思维处理期望问题  
2. 滚动数组优化空间  
3. 概率事件中的贪心决策

**推荐题目**：  
1. [P1850 换教室](https://www.luogu.com.cn/problem/P1850) - 期望DP经典  
2. [P4550 收集邮票](https://www.luogu.com.cn/problem/P4550) - 概率递推  
3. [P1654 OSU!](https://www.luogu.com.cn/problem/P1654) - 连续事件期望计算

---
处理用时：78.80秒
# 题目信息

# [ABC275C] Counting Squares

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc275/tasks/abc275_c

二次元平面があります。$ 1 $ 以上 $ 9 $ 以下の整数 $ r,c $ について、$ S_{r} $ の $ c $ 番目の文字が `#` であるとき座標 $ (r,c) $ にポーンが置いてあり、$ S_{r} $ の $ c $ 番目の文字が `.` であるとき座標 $ (r,c) $ に何も置かれていません。

この平面上の正方形であって、$ 4 $ 頂点全てにポーンが置いてあるものの個数を求めてください。

## 说明/提示

### 制約

- $ S_1,\ldots,S_9 $ はそれぞれ `#` と `.` からなる長さ $ 9 $ の文字列

### Sample Explanation 1

座標 $ (1,1),(1,2),(2,2),(2,1) $ を頂点とする正方形は、$ 4 $ 頂点全てにポーンが置かれています。 座標 $ (4,8),(5,6),(7,7),(6,9) $ を頂点とする正方形も、$ 4 $ 頂点全てにポーンが置かれています。 よって答えは $ 2 $ です。

## 样例 #1

### 输入

```
##.......
##.......
.........
.......#.
.....#...
........#
......#..
.........
.........```

### 输出

```
2```

## 样例 #2

### 输入

```
.#.......
#.#......
.#.......
.........
....#.#.#
.........
....#.#.#
........#
.........```

### 输出

```
3```

# AI分析结果



### 题目内容
# [ABC275C] Counting Squares

## 题目描述

给定一个 $9 \times 9$ 的网格，每个格子的坐标为 $(r, c)$（$1 \leq r, c \leq 9$）。若格子 $(r, c)$ 的字符为 `#` 表示此处有棋子，`.` 表示无棋子。求所有由四个顶点均为 `#` 的正方形数量。

### 输入格式
输入共 $9$ 行，每行 $9$ 个字符。

### 输出格式
输出符合条件的正方形数量。

### 说明/提示
- 样例 1 中存在两个符合条件的正方形。
- 数据保证每个顶点唯一，无重复坐标。

---

### 算法分类
**枚举**（核心思路是通过数学性质减少枚举次数）

---

### 题解分析与关键结论

各题解主要围绕以下思路展开：
1. **暴力枚举四顶点**：直接枚举四个顶点的组合，通过勾股定理判断是否为正方形（复杂度较高，但数据范围小可接受）。
2. **数学推导优化**：枚举两个顶点，利用正方形几何性质推导另外两个顶点坐标，用集合快速判断存在性（时间复杂度更低）。
3. **对角线中点法**：枚举对角线顶点，计算中点与对称点，避免重复计数。

**关键优化点**：
- 利用正方形的几何性质（如向量旋转、坐标变换）减少枚举次数。
- 使用 `set` 或 `unordered_set` 快速查询顶点是否存在。
- 通过除法或位运算处理重复计数（如每个正方形会被多次枚举）。

---

### 高分题解精选（评分≥4星）

#### 题解1：作者 **_qingshu_**（⭐⭐⭐⭐⭐）
**亮点**：
- 数学推导清晰，利用向量计算剩余顶点。
- 使用 `set` 实现 $O(1)$ 查询。
- 通过除以 $4$ 消除重复计数。

**核心代码**：
```cpp
set<pair<int,int>> ton;
for (auto i : ton) {
    for (auto j : ton) {
        if (i != j) {
            int dx = i.second - j.second;
            int dy = i.first - j.first;
            // 计算剩余两个顶点坐标
            pair<int,int> p = {i.first + dx, i.second - dy};
            pair<int,int> q = {j.first + dx, j.second - dy};
            if (ton.count(p) && ton.count(q)) ans++;
        }
    }
}
cout << ans / 4;
```

#### 题解2：作者 **Chenyichen0420**（⭐⭐⭐⭐）
**亮点**：
- 枚举对角线顶点，计算中点坐标。
- 避免重复推导，通过除以 $2$ 消除重复。

**核心代码**：
```cpp
for (auto i : ps) {
    for (auto j : ps) {
        // 计算中点与对称点
        pair<double,double> p1 = make_pair(..., ...);
        pair<double,double> p2 = make_pair(..., ...);
        if (st.count(p1) && st.count(p2)) ans++;
    }
}
cout << ans / 2;
```

---

### 关键思路总结
1. **数学性质优先**：利用正方形的向量关系（如旋转 $90^\circ$ 或平移）直接推导顶点坐标。
2. **数据结构优化**：使用集合（`set`）快速验证顶点存在性。
3. **重复计数处理**：通过数学推导确定每个正方形被枚举的次数，最终结果除以相应系数。

---

### 类似题目推荐
1. [P2733 家的范围 Home on the Range](https://www.luogu.com.cn/problem/P2733)（动态规划求正方形数量）
2. [P1387 最大正方形](https://www.luogu.com.cn/problem/P1387)（二维前缀和优化）
3. [CF1829G Hits Different](https://www.luogu.com.cn/problem/CF1829G)（组合数学与坐标系变换）

---

### 个人心得摘录
> "枚举两个顶点后，利用坐标变换直接求另外两个顶点，完全避免了四重循环的冗余计算。"  
> —— 调试中发现坐标公式错误是常见问题，需反复验证几何推导。

---
处理用时：49.68秒
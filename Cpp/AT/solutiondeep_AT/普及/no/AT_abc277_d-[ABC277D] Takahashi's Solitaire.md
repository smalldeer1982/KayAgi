# 题目信息

# [ABC277D] Takahashi's Solitaire

## 题目描述

【题面翻译】

给定 $n$ 张牌，每张牌上有一个数字 $a_i$。

你要先选一张牌放在桌子上。假设当前最后一张放置的牌为 $x$，接下来，你每次只能放写着 $x$ 或 $(x + 1) \bmod m$ 的牌。

一直操作下去。你需要让你手上剩下的牌的总和**最小**。

translated by @[liangbowen](https://www.luogu.com.cn/user/367488).

## 说明/提示

$1 \le n \le 2 \times 10^5$

$2 \le m \le 10^9$

保证 $0 \le a_i < m$。

## 样例 #1

### 输入

```
9 7

3 0 2 5 5 3 0 6 3```

### 输出

```
11```

## 样例 #2

### 输入

```
1 10

4```

### 输出

```
0```

## 样例 #3

### 输入

```
20 20

18 16 15 9 8 8 17 1 3 17 11 9 12 11 7 3 2 14 3 12```

### 输出

```
99```

# AI分析结果



# [ABC277D] Takahashi's Solitaire 中文翻译

## 题目描述

给定 $n$ 张牌，每张牌上有一个数字 $a_i$（$0 \le a_i < m$）。你需要选择一张牌开始放置，后续每次只能放置与最后一张牌值相等或模 $m$ 意义下大 1 的牌。求最终手上剩余牌的最小总和。

## 算法分类
**贪心**

---

## 题解综合分析

### 核心思路
将数组排序后寻找最长连续区间（允许模 $m$ 的循环），通过计算这些区间的最大总和，用总和减去该值即为答案。难点在于处理模 $m$ 的循环特性（如 m-1 与 0 的衔接）。

### 关键优化技巧
1. **排序预处理**：所有解法均先排序，便于处理连续性
2. **环形处理**：通过数组拼接或模运算处理 m-1 → 0 的衔接
3. **单次遍历**：利用贪心思想，在 O(n) 时间内找到最大连续区间和

---

## 高星题解推荐

### 题解作者：liangbowen（⭐⭐⭐⭐⭐）
**核心亮点**：  
- 线性时间复杂度优化（O(n)）
- 清晰处理环形边界条件
- 代码包含防死循环机制

**关键代码**：
```cpp
sort(a + 1, a + n + 1);
ll ans = sum;
for (int pos = 1; ;) {
    // 寻找连续可取的区间
    int p = pos;
    while (满足连续条件) p = next_pos;
    ans = min(ans, sum - 当前区间和);
    // 处理环形边界
    if (到达循环终点) break;
}
```

### 题解作者：ImposterAnYu（⭐⭐⭐⭐）
**核心亮点**：  
- 离散化处理大数据范围
- 使用 map 统计频次
- 清晰展示环形区间计算逻辑

**关键思路**：  
```cpp
map统计每个数的出现次数后排序
将数组视为环形结构处理：
for (所有唯一值) {
    if 可形成环形连续区间:
        更新最大区间和
}
```

---

## 最优思路总结
1. **排序预处理**：将数组排序后，连续值的判断转化为相邻元素的差是否为 1
2. **环形处理技巧**：将数组视为环形结构，通过模运算或数组拼接处理 m-1 → 0 的衔接
3. **贪心遍历**：单次扫描数组，维护当前连续区间和，时间复杂度 O(n)

---

## 类似题目推荐
1. [P3405 最长连续递增子序列](https://www.luogu.com.cn/problem/P3405)  
   **相似点**：寻找最长连续区间，需处理环形边界
2. [P2115 [USACO14MAR]破坏Sabotage](https://www.luogu.com.cn/problem/P2115)  
   **相似点**：最大子段和的变形应用
3. [P2422 良好的感觉](https://www.luogu.com.cn/problem/P2422)  
   **相似点**：贪心思想结合单调栈处理连续区间

---
处理用时：47.85秒
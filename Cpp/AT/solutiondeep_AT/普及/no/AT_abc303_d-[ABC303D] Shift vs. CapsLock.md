# 题目信息

# [ABC303D] Shift vs. CapsLock

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc303/tasks/abc303_d

あなたのパソコンのキーボードには、a キー・Shift キー・CapsLock キーの $ 3 $ 種類のキーがあります。また、CapsLock キーにはランプが付いています。 初め、CapsLock キーのランプは OFF であり、パソコンの画面には空文字列が表示されています。

あなたは、以下の $ 3 $ 種類の操作のうち $ 1 $ つを選んで実行するということを $ 0 $ 回以上何度でも行うことができます。

- $ X $ ミリ秒かけて a キーのみを押す。CapsLock キーのランプが OFF ならば画面の文字列の末尾に `a` が付け足され、ON ならば `A` が付け足される。
- $ Y $ ミリ秒かけて Shift キーと a キーを同時に押す。CapsLock キーのランプが OFF ならば画面の文字列の末尾に `A` が付け足され、 ON ならば `a` が付け足される。
- $ Z $ ミリ秒かけて CapsLock キーを押す。CapsLock キーのランプが OFF ならば ON に、ON ならば OFF に切り替わる。

`A` と `a` からなる文字列 $ S $ が与えられます。画面の文字列を $ S $ に一致させるのに必要な最短の時間は何ミリ秒かを求めてください。

## 说明/提示

### 制約

- $ 1\ \leq\ X,Y,Z\ \leq\ 10^9 $
- $ X,Y,Z $ は整数
- $ 1\ \leq\ |S|\ \leq\ 3\ \times\ 10^5 $
- $ S $ は `A` と `a` からなる文字列

### Sample Explanation 1

以下のように操作を行うと $ 9 $ ミリ秒で画面の文字列を `AAaA` に一致させられます。これが最短の時間です。 - $ Z(=3) $ ミリ秒かけて CapsLock キーを押す。CapsLock キーのランプが ON になる。 - $ X(=1) $ ミリ秒かけて a キーを押す。`A` が画面の文字列の末尾に付け足される。 - $ X(=1) $ ミリ秒かけて a キーを押す。`A` が画面の文字列の末尾に付け足される。 - $ Y(=3) $ ミリ秒かけて Shift キーと a キーを同時に押す。`a` が画面の文字列の末尾に付け足される。 - $ X(=1) $ ミリ秒かけて a キーを押す。`A` が画面の文字列の末尾に付け足される。

## 样例 #1

### 输入

```
1 3 3
AAaA```

### 输出

```
9```

## 样例 #2

### 输入

```
1 1 100
aAaAaA```

### 输出

```
6```

## 样例 #3

### 输入

```
1 2 4
aaAaAaaAAAAaAaaAaAAaaaAAAAA```

### 输出

```
40```

# AI分析结果



# [ABC303D] Shift vs. CapsLock

## 题目描述

你的电脑键盘有 a 键、Shift 键和 CapsLock 键三个按键。CapsLock 键带有指示灯。初始时 CapsLock 灯为关闭状态，屏幕显示空字符串。

你可以执行以下三种操作任意次：
1. 花费 X 毫秒单独按 a 键：若 CapsLock 关闭则在字符串末尾添加小写 a，否则添加大写 A。
2. 花费 Y 毫秒同时按 Shift 和 a 键：若 CapsLock 关闭则添加大写 A，否则添加小写 a。
3. 花费 Z 毫秒按 CapsLock 键：切换指示灯状态。

给定目标字符串 S（由 A 和 a 组成），求达成目标所需的最短时间。

### 输入格式
输入三个整数 X,Y,Z 和字符串 S。
### 输出格式
输出最小耗时。
### 数据范围
1 ≤ X,Y,Z ≤ 1e9，1 ≤ |S| ≤ 3e5

---

**算法分类**：动态规划

---

## 题解分析

### 关键思路总结
采用动态规划维护两个状态：`dp[i][0]` 表示处理完前 i 个字符后 CapsLock 关闭的最小耗时，`dp[i][1]` 表示开启状态的最小耗时。每个字符根据当前状态选择四种操作中的最优组合：
1. 直接按键（X/Y）
2. 切换状态后按键（Z+X/Z+Y）
3. 组合键操作（Y/Z+X等）
4. 多次切换优化组合

### 最优题解推荐

#### 题解作者：CEFqwq（⭐⭐⭐⭐⭐）
**核心亮点**：
- 逆向动态规划设计，状态转移方程简洁
- 仅需 2 种状态转移，代码实现极简
- 时间复杂度 O(n)，空间优化为滚动数组

**关键代码**：
```cpp
#define c (s[i]=='A')
ll f[2][300010];
// 逆向DP：f[j][i] 表示从i位置开始，当前状态j时的最小剩余时间
for(ll i=n-1;i>=0;i--){
    f[!c][i]=min(z+x+f[c][i+1],y+f[!c][i+1]);
    f[c][i]=min(x+f[c][i+1],z+y+f[!c][i+1]);
}
```

#### 题解作者：__Emerald__（⭐⭐⭐⭐）
**核心亮点**：
- 正向状态转移分类清晰
- 包含完整初始化处理
- 代码可读性强，适合理解基础DP模型

**状态转移片段**：
```cpp
if(s[i] == 'A'){
    dp[i][0] = min({前状态关闭按组合键, 前状态开启切换后按键});
    dp[i][1] = min({保持开启状态按键, 切换状态组合操作});
} else {
    // 对称处理小写情况
}
```

#### 题解作者：lilong（⭐⭐⭐）
**优化点**：
- 根据相邻字符是否相同进行状态转移优化
- 使用滚动数组降低空间复杂度

---

## 相似题目推荐
1. [P1273 有线电视网](https://www.luogu.com.cn/problem/P1273) - 树形DP状态维护
2. [P1091 合唱队形](https://www.luogu.com.cn/problem/P1091) - 双向状态转移
3. [P1434 滑雪](https://www.luogu.com.cn/problem/P1434) - 记忆化搜索与状态转移

---

## 总结技巧
1. **状态压缩**：仅维护当前CapsLock状态即可，无需记录完整历史
2. **组合操作优化**：将连续切换操作（如Z+X+Z）纳入转移考量
3. **逆向思维**：CEFqwq解法展示逆向DP在特定场景下的简洁性
4. **滚动数组**：对于3e5数据规模，O(1)空间复杂度实现更优

调试时需特别注意初始状态设置（初始CapsLock为关闭），以及长整型溢出的处理。

---
处理用时：45.03秒
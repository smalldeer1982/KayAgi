# 题目信息

# [ABC324D] Square Permutation

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc324/tasks/abc324_d

数字のみからなる、長さ $ N $ の文字列 $ S $ が与えられます。

$ S $ を並べ替えてできる文字列を十進法の整数として解釈したもののうち、平方数であるようなものがいくつあるか求めてください。

より厳密には、次のようになります。

$ S $ の先頭から $ i $ 番目 $ (1\leq\ i\leq\ N) $ の数字に対応する数を $ s\ _\ i $ とします。

$ (1,\ \ldots,\ N) $ の順列 $ P=(p\ _\ 1,p\ _\ 2,\ldots,p\ _\ N) $ によって $ \displaystyle\ \sum\ _\ {i=1}\ ^\ N\ s\ _\ {p\ _\ i}10\ ^\ {N-i} $ と書ける整数のうち、平方数であるようなものがいくつあるか求めてください。

## 说明/提示

### 制約

- $ 1\leq\ N\leq\ 13 $
- $ S $ は数字のみからなる長さ $ N $ の文字列
- $ N $ は整数
 
### Sample Explanation 1

$ P=(4,2,3,1) $ とすると、$ s\ _\ 4\times10\ ^\ 3+s\ _\ 2\times10\ ^\ 2+s\ _\ 3\times10\ ^\ 1+s\ _\ 1=324=18\ ^\ 2 $ となります。 $ P=(3,2,4,1) $ とすると、$ s\ _\ 3\times10\ ^\ 3+s\ _\ 2\times10\ ^\ 2+s\ _\ 4\times10\ ^\ 1+s\ _\ 1=2304=48\ ^\ 2 $ となります。 これら以外の並べ替え方では平方数にならないため、$ 2 $ を出力してください。

### Sample Explanation 2

$ P=(1,3,2) $ もしくは $ P=(3,1,2) $ とすると、$ \displaystyle\sum\ _\ {i=1}\ ^\ Ns\ _\ {p\ _\ i}10\ ^\ {N-i}=1=1\ ^\ 2 $ となります。 $ P=(2,1,3) $ もしくは $ P=(2,3,1) $ とすると、$ \displaystyle\sum\ _\ {i=1}\ ^\ Ns\ _\ {p\ _\ i}10\ ^\ {N-i}=100=10\ ^\ 2 $ となります。 これら以外の並べ替え方では平方数にならないため、$ 2 $ を出力してください。 異なる並べ替え方でも、並べ替えた結果の数が同じなら $ 1 $ つと数えることに注意してください。

## 样例 #1

### 输入

```
4

4320```

### 输出

```
2```

## 样例 #2

### 输入

```
3

010```

### 输出

```
2```

## 样例 #3

### 输入

```
13

8694027811503```

### 输出

```
840```

# AI分析结果



### 题目中文翻译

#### [ABC324D] 平方排列

**题目描述**

给定一个仅由数字组成的长度为 $N$ 的字符串 $S$。求通过重新排列 $S$ 中的数字可以得到的不同整数中，完全平方数的个数。

**说明/提示**

- 不同的排列即使生成相同的数也只算一次。
- $1 \leq N \leq 13$

---

### 算法分类
**枚举**、**数学**

---

### 题解分析与结论

所有题解的核心思路均为**反向枚举平方数**，而非暴力生成排列。关键要点如下：

1. **平方数枚举范围**：最多枚举到 $\sqrt{10^{13}} \approx 3.16 \times 10^6$，总次数可控。
2. **有效性验证**：对每个平方数，通过数位统计或排序后的字符串与原字符串比较，判断是否匹配。
3. **前导零处理**：平方数位数不足 $N$ 时需补前导零，需确保原字符串的零足够。

---

### 精选题解

#### 作者：2huk (5星)
**关键亮点**：通过补零至 $N$ 位后排序比较，思路简洁高效。
```cpp
bool chk(int x) {
    for (int i = 1; i <= n; ++i) {
        b[i] = x % 10;
        x /= 10;
    }
    sort(b + 1, b + n + 1);
    return memcmp(a + 1, b + 1, n * sizeof(int)) == 0;
}
```
**核心思想**：将平方数分解到 $N$ 位（不足补零），与原字符串排序后直接比较。

---

#### 作者：Airposs (4星)
**关键亮点**：显式补零并统计数位，逻辑清晰。
```cpp
for (long long j = 1; j <= n; j++) {
    long long x = now % 10;
    num[x]++;
    now /= 10;
}
if (check()) ans++;
```
**核心思想**：循环 $N$ 次分解平方数（自动补零），与原字符串数位统计完全匹配。

---

#### 作者：Nwayy (4星)
**关键亮点**：明确处理零的数量关系，代码简明。
```cpp
if (ss[0] > cnt[0]) return false;
for (int i = 1; i <= 9; i++)
    if (ss[i] != cnt[i]) return false;
```
**核心思想**：确保平方数的零不超过原字符串，其他数位严格相等。

---

### 关键思路总结
1. **反向枚举**：避免排列爆炸，转而枚举平方数。
2. **补零技巧**：将平方数视为 $N$ 位数（不足补前导零），简化比较。
3. **高效验证**：通过排序或数位统计快速判断匹配。

---

### 拓展建议
- **类似问题**：判断排列后的数是否为立方数、回文数等。
- **算法套路**：利用数位特征反向验证，替代暴力生成。

---

### 推荐题目
1. [P1217 回文质数](https://www.luogu.com.cn/problem/P1217)（枚举与数学验证）
2. [P1214 寻找平方数](https://www.luogu.com.cn/problem/P1214)（特定形式的平方数）
3. [P1045 麦森数](https://www.luogu.com.cn/problem/P1045)（高精度与数位处理）

---
处理用时：186.25秒
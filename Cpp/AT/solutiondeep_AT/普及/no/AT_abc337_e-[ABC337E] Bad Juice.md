# 题目信息

# [ABC337E] Bad Juice

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc337/tasks/abc337_e

この問題は **インタラクティブな問題**（あなたが作成したプログラムとジャッジプログラムが標準入出力を介して対話を行う形式の問題）です。

$ 1 $ から $ N $ の番号がついた $ N $ 本のジュースがあります。 このうちちょうど $ 1 $ 本が腐っていることが判明しました。 そのジュースを微量でも飲むと、翌日お腹を壊してしまいます。

高橋君は翌日までに腐ったジュースを特定しなければなりません。 高橋君はそのために**必要な最小の数**の友人を呼び、それぞれに $ N $ 本のジュースのうちの一部を振る舞うことにしました。 各友人には何本でもジュースを与えることができ、各ジュースは何人の友人にでも与えることができます。

呼ぶ友人の数とジュースの与え方を出力して、翌日に各友人がお腹を壊したかどうかの情報を受け取り、腐ったジュースの番号を出力してください。

### Input &amp; Output Format

この問題はインタラクティブな問題（あなたが作成したプログラムとジャッジプログラムが標準入出力を介して対話を行う形式の問題）です。

対話を行う前にジャッジは、腐ったジュースの番号 $ X $ として $ 1 $ 以上 $ N $ 以下の整数を秘密裏に選択します。 $ X $ の値はあなたには与えられません。また、**対話の途中で $ X $ の値が制約および以前の出力に矛盾しない範囲で変わる場合があります。**

まず、ジャッジから $ N $ が入力から与えられます。

> $ N $

あなたは呼ぶ友人の数 $ M $ を出力し改行してください。

> $ M $

さらに、あなたは次に述べる $ M $ 回の出力からなる手続きを行ってください。 $ i\ =\ 1,\ 2,\ \ldots,\ M $ について $ i $ 回目の出力では、 $ i $ 番目の友人に飲ませるジュースの本数 $ K_i $ および、それら $ K_i $ 本のジュースの番号を**昇順に**並べた列 $ A_{i,\ 1},\ A_{i,\ 2},\ \ldots,\ A_{i,\ K_i} $ を下記の形式で空白区切りで出力し、改行してください。

> $ K_i $ $ A_{i,\ 1} $ $ A_{i,\ 2} $ $ \ldots $ $ A_{i,\ K_i} $

その後ジャッジから、各友人が翌日にお腹を壊したかどうかの情報が、`0` と `1` のみからなる長さ $ M $ の文字列 $ S $ として与えられます。

> $ S $

$ i\ =\ 1,\ 2,\ \ldots,\ M $ について、$ S $ の $ i $ 文字目が `1` のとき、かつそのときに限り、$ i $ 番目の友人がお腹を壊したことを表します。

それに対し、あなたは腐ったジュースの番号 $ X' $ を出力し、改行してください。

> $ X' $

その後、直ちにプログラムを終了してください。

あなたが出力した $ M $ が $ N $ 本のジュースから腐ったジュースを特定するために**必要な最小の**友人の数であり、かつ、あなたが出力した $ X' $ が腐ったジュースの番号 $ X $ と一致していれば、正解となります。

## 说明/提示

### 制約

- $ N $ は整数
- $ 2\ \leq\ N\ \leq\ 100 $
 
### 注意点

- **出力を行うたびに、末尾に改行を入れて標準出力を flush してください。そうしなかった場合、ジャッジ結果が TLE となる可能性があります。**
- **対話の途中で不正な出力を行った、あるいはプログラムが途中で終了した場合のジャッジ結果は不定です。** 特に、プログラムの実行中に実行時エラーが起こった場合に、ジャッジ結果が RE ではなく WA や TLE になる可能性があることに注意してください。
- $ X' $ を出力したらただちにプログラムを終了してください。そうしない場合、ジャッジ結果は不定です。
- **この問題のジャッジはアダプティブです。つまり、制約および以前の出力に矛盾しない範囲で $ X $ の値が変わる場合があります。**
 
### 入出力例

以下は、$ N\ =\ 3 $ の場合の入出力例です。

    入力 出力 説明     `3`  ジュースの本数 $ N $ が与えられます。    `2` 呼ぶ友人の数 $ M $ を出力します。    `2 1 2` $ 1 $ 人目の友人にジュース $ 1 $ とジュース $ 2 $ を与えます。     `1 2` $ 2 $ 人目の友人に、ジュース $ 2 $ を与えます。     `10`  翌日に各友人がお腹を壊したかどうかを表す文字列 $ S $ が与えられます。    `1` 腐ったジュースの番号を出力します。

# AI分析结果



### 题目中文翻译

#### [ABC337E] 坏果汁

**题目描述**

有编号为1至N的N瓶果汁，其中恰好有一瓶变质了。喝了变质果汁的人第二天会腹泻。

高桥君需要在第二天前找出变质的果汁。他决定邀请最少数量的朋友，并让每个朋友喝一些果汁（每个朋友可以喝多瓶，每瓶可以被多个朋友喝）。

你需要输出邀请的朋友数及每个朋友喝的果汁编号，之后根据朋友的腹泻情况确定变质果汁的编号。

**交互流程**
1. 输入N。
2. 输出朋友数M。
3. 输出M行，每行描述一个朋友喝的果汁（数量及具体编号）。
4. 输入一个长度为M的01字符串，表示每个朋友是否腹泻。
5. 输出变质果汁的编号。

**约束**
- 2 ≤ N ≤ 100

---

### 算法分类
**位运算**、**构造**

---

### 题解分析与结论

#### 核心思路
1. **二进制编码**：将果汁编号转化为二进制，每位对应一个朋友。
2. **构造分配方案**：第i位为1的果汁会被第i个朋友喝。
3. **结果解码**：根据腹泻情况组合二进制位得到变质果汁编号，若结果全0则为最大编号N。

#### 解决难点
- **最小化朋友数**：需满足⌈log₂(N)⌉，但需处理N为2的幂的特殊情况。
- **二进制覆盖**：确保每个果汁的二进制各位被正确覆盖。

---

### 高质量题解推荐

#### 题解1：JuRuoOIer（★★★★★）
**关键亮点**  
- 使用`__lg`函数快速计算所需朋友数，代码简洁高效。
- 通过位运算直接生成每个朋友喝的果汁集合，逻辑清晰。
- 处理特殊情况（当N是2的幂时）只需最后判断结果是否为0。

**核心代码**  
```cpp
int main() {
    cin >> n;
    int m = __lg(n - 1) + 1; // 计算最少朋友数
    cout << m << endl;
    // 构造每个朋友喝的果汁
    for (int i = 0; i < m; i++) {
        vector<int> juices;
        for (int j = 1; j <= n; j++) {
            if (j & (1 << i)) juices.push_back(j);
        }
        cout << juices.size() << " ";
        for (int j : juices) cout << j << " ";
        cout << endl;
    }
    // 解码结果
    string s;
    cin >> s;
    int ans = 0;
    for (int i = 0; i < m; i++) {
        if (s[i] == '1') ans += (1 << i);
    }
    cout << (ans == 0 ? n : ans) << endl;
}
```

#### 题解2：fydj（★★★★☆）
**关键亮点**  
- 详细解释二进制拆分的数学原理，适合理解基础。
- 通过循环构造二进制位覆盖，代码易扩展。

**核心代码**  
```cpp
int main() {
    cin >> n;
    int m = log2(n) + 1;
    // 特殊处理2的幂
    if ((n & (n - 1)) == 0) m--;
    // 构造与解码逻辑类似题解1
    ...
}
```

---

### 关键技巧总结
1. **二进制位映射**：将问题转化为二进制编码，每位对应一个测试条件。
2. **特殊值处理**：当N为2的幂时，最大编号无需显式测试，可通过结果全0推断。
3. **位运算优化**：使用位运算快速生成测试集合，提高代码效率。

---

### 同类题目推荐
1. [P2119 魔法数字](https://www.luogu.com.cn/problem/P2119) - 二进制状态压缩
2. [P2894 [USACO08FEB] Hotel G](https://www.luogu.com.cn/problem/P2894) - 位运算优化查询
3. [P7960 [NOIP2021] 报数](https://www.luogu.com.cn/problem/P7960) - 二进制筛法预处理

---
处理用时：67.59秒
# 题目信息

# [ABC390E] Vitamin Balance

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc390/tasks/abc390_e

$ N $ 個の食べ物があり、それぞれの食べ物にはビタミン $ 1,2,3 $ のうちちょうど $ 1 $ つのみが含まれています。  
具体的には、$ i $ 個目の食べ物を食べると、ビタミン $ V_i $ が $ A_i $ だけ摂取でき、またカロリーが $ C_i $ だけ摂取されます。

高橋君は、摂取するカロリーが合計で $ X $ 以下となるように、$ N $ 個の食べ物のうちいくつか（$ 0 $ 個でも良い）を選んで食べることができます。  
このとき、「ビタミン $ 1,2,3 $ のうちもっとも摂取量が少ないものの摂取量」としてあり得る最大の値を求めてください。

## 说明/提示

### 制約

- $ 1\leq\ N\ \leq\ 5000 $
- $ 1\leq\ X\ \leq\ 5000 $
- $ 1\leq\ V_i\leq\ 3 $
- $ 1\leq\ A_i\leq\ 2\times\ 10^5 $
- $ 1\leq\ C_i\leq\ X $
- 入力はすべて整数

### Sample Explanation 1

それぞれの食べ物を食べると高橋君は次のものを摂取します。 - $ 1 $ 個目の食べ物を食べると、ビタミン $ 1 $ を $ 8 $ とカロリーを $ 5 $ だけ摂取する。 - $ 2 $ 個目の食べ物を食べると、ビタミン $ 2 $ を $ 3 $ とカロリーを $ 5 $ だけ摂取する。 - $ 3 $ 個目の食べ物を食べると、ビタミン $ 2 $ を $ 7 $ とカロリーを $ 10 $ だけ摂取する。 - $ 4 $ 個目の食べ物を食べると、ビタミン $ 3 $ を $ 2 $ とカロリーを $ 5 $ だけ摂取する。 - $ 5 $ 個目の食べ物を食べると、ビタミン $ 3 $ を $ 3 $ とカロリーを $ 10 $ だけ摂取する。 高橋君が $ 1 $, $ 2 $, $ 4 $, $ 5 $ 個目の食べ物を食べると、 高橋君はビタミン $ 1 $ を $ 8 $、ビタミン $ 2 $ を $ 3 $、ビタミン $ 3 $ を $ 5 $、そしてカロリーを $ 25 $ だけ摂取します。 このとき、「ビタミン $ 1,2,3 $ のうちもっとも摂取量が少ないもの」はビタミン $ 2 $ であり、その摂取量は $ 3 $ です。 どのように食べ物を選んで食べても、摂取カロリーの合計が $ 25 $ 以下となるようにビタミン $ 1,2,3 $ すべてを $ 4 $ 以上摂取することはできないため、$ 3 $ を出力します。

## 样例 #1

### 输入

```
5 25
1 8 5
2 3 5
2 7 10
3 2 5
3 3 10```

### 输出

```
3```

## 样例 #2

### 输入

```
2 5000
1 200000 1
2 200000 1```

### 输出

```
0```

# AI分析结果



### 题目重写  
[ABC390E] 维生素平衡  

#### 题目描述  
有 $N$ 个食物，每个食物含有恰好一种维生素（1、2 或 3），并提供 $A_i$ 单位的该维生素和 $C_i$ 卡路里。要求选择若干食物使得总卡路里不超过 $X$，求三种维生素摄入量的最小值可能的最大值。  

#### 输入格式  
第一行输入 $N$ 和 $X$，接下来 $N$ 行每行给出 $V_i$（维生素类型）、$A_i$（维生素量）、$C_i$（卡路里）。  

#### 输出格式  
输出三种维生素最小值的最大值。  

#### 样例  
**输入 1**  
```
5 25
1 8 5
2 3 5
2 7 10
3 2 5
3 3 10
```  
**输出 1**  
3  

---

### 算法分类  
动态规划  

---

### 题解分析与关键思路  

#### 核心思路  
1. **分治维生素类型**：将三种维生素分开处理，分别进行 01 背包计算，得到每种维生素在不同卡路里下的最大摄入量。  
2. **前缀最大值优化**：对每个维生素的背包结果进行前缀最大值处理，使得 `dp[j]` 表示不超过 `j` 卡路里的最大摄入量。  
3. **枚举分配策略**：枚举前两种维生素的卡路里分配，第三种维生素的卡路里由剩余值确定，计算三者的最小值并取最大值。  

#### 关键技巧  
- **动态规划预处理**：对每个维生素独立进行背包计算，时间复杂度 $O(NX)$。  
- **前缀处理优化**：确保 `dp[j]` 表示前 `j` 卡路里的最优解，避免枚举时遗漏中间状态。  
- **剪枝策略**：通过枚举前两种维生素的卡路里分配，将总复杂度优化至 $O(X^2)$。  

---

### 精选题解  

#### 题解 1（作者：high_sky，★★★★★）  
**亮点**：  
- 清晰的三次背包预处理  
- 显式的前缀最大值优化  
- 简洁的枚举逻辑  

**核心代码**：  
```cpp  
for (int t = 1; t <= 3; t++) {
    solve(dp[t], t);  // 处理背包
    for (int j = 1; j <= X; j++) 
        dp[t][j] = max(dp[t][j], dp[t][j-1]);  // 前缀最大值
}
ll ans = 0;
for (int i = 0; i <= X; i++)
    for (int j = 0; i + j <= X; j++)
        ans = max(ans, min({dp[1][i], dp[2][j], dp[3][X-i-j]}));
```  

#### 题解 2（作者：ARIS2_0，★★★★☆）  
**亮点**：  
- 二分答案优化时间复杂度  
- 预处理时使用滚动数组节省空间  
- 前缀处理确保单调性  

**核心代码**：  
```cpp  
// 预处理前缀最大值
for (int j = 1; j < maxn; j++)
    dp[val][tot&1][j] = max(dp[val][tot&1][j], dp[val][tot&1][j-1]);

// 二分检查
int check(int mid) {
    int cost = 0;
    for (int v : {1,2,3}) {
        int p = lower_bound(dp[v][pos[v]]...);  // 查找最小成本
        cost += p;
    }
    return cost <= X;
}
```  

#### 题解 3（作者：xiaofu15191，★★★★☆）  
**亮点**：  
- 贪心策略逐步提升最小值  
- 动态规划结合前缀处理  

**核心代码**：  
```cpp  
// 贪心分配卡路里
for (int i = 1; i <= X; i++) {
    int min_vitamin = 找出当前最小值对应的维生素;
    P[min_vitamin]++;  // 分配卡路里
}
ans = min(M[1][P[1]], M[2][P[2]], M[3][P[3]]);
```  

---

### 总结与扩展  
**最优思路**：分治维生素类型 + 动态规划预处理 + 前缀最大值优化 + 枚举卡路里分配。  
**同类题目推荐**：  
1. [P1064 金明的预算方案](https://www.luogu.com.cn/problem/P1064)（依赖背包）  
2. [P5020 货币系统](https://www.luogu.com.cn/problem/P5020)（完全背包变形）  
3. [P2340 奶牛会展](https://www.luogu.com.cn/problem/P2340)（多维背包）  

**调试心得**：  
- 必须进行前缀最大值处理，否则无法保证枚举时的正确性。  
- 二分法需验证单调性，避免预处理未覆盖边界情况。

---
处理用时：164.65秒
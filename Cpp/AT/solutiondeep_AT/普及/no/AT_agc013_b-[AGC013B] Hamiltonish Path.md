# 题目信息

# [AGC013B] Hamiltonish Path

## 题目描述

[problemUrl]: https://atcoder.jp/contests/agc013/tasks/agc013_b

$ N $ 頂点 $ M $ 辺の、連結な単純無向グラフが与えられます。 頂点には $ 1 $ から $ N $ までの番号がついており、辺には $ 1 $ から $ M $ までの番号がついています。 辺 $ i $ は、頂点 $ A_i $ と頂点 $ B_i $ を結んでいます。 次の条件を満たすパスを $ 1 $ つ見つけて、出力してください。

- $ 2 $ 個以上の頂点を通る
- 同じ頂点を $ 2 $ 度以上通らない
- パスの少なくとも一方の端点と直接辺で結ばれている頂点は、必ずパスに含まれる

ただし、この問題の制約の下で、このようなパスが必ず存在することが証明できます。 また、あり得る答えのうちどれを出力しても構いません。

## 说明/提示

### 制約

- $ 2\ \leq\ N\ \leq\ 10^5 $
- $ 1\ \leq\ M\ \leq\ 10^5 $
- $ 1\ \leq\ A_i\ <\ B_i\ \leq\ N $
- 与えられるグラフは連結かつ単純（どの $ 2 $ 頂点を直接結ぶ辺も高々 $ 1 $ つ）である

### Sample Explanation 1

頂点 $ 2 $ と直接辺で結ばれている頂点は、頂点 $ 3 $ と $ 4 $ です。 頂点 $ 4 $ と直接辺で結ばれている頂点は、頂点 $ 1 $ と $ 2 $ です。 なので、$ 2 $ → $ 3 $ → $ 1 $ → $ 4 $ というパスは条件を満たします。

## 样例 #1

### 输入

```
5 6

1 3

1 4

2 3

1 5

3 5

2 4```

### 输出

```
4

2 3 1 4```

## 样例 #2

### 输入

```
7 8

1 2

2 3

3 4

4 5

5 6

6 7

3 5

2 6```

### 输出

```
7

1 2 3 4 5 6 7```

## 样例 #3

### 输入

```
12 18

3 5

4 12

9 11

1 10

2 5

6 10

8 11

1 3

4 10

2 4

3 7

2 10

3 12

3 9

1 7

2 3

2 11

10 11```

### 输出

```
8

12 4 2 5 3 9 11 8```

# AI分析结果



# [AGC013B] Hamiltonish Path（中文翻译）

## 题目描述

给定一个包含 $N$ 个顶点和 $M$ 条边的连通简单无向图。顶点编号为 $1$ 至 $N$，边编号为 $1$ 至 $M$。边 $i$ 连接顶点 $A_i$ 和 $B_i$。要求找到满足以下条件的路径并输出：

- 经过至少 2 个顶点
- 不重复经过同一顶点
- 路径任一端点的相邻顶点必须全部包含在路径中

保证存在解，输出任意合法解即可。

## 算法分类
构造

## 题解分析与结论

该题核心在于构造满足端点邻域约束的路径。通过分析题解发现，有效解法应基于**路径扩展**策略：从任意起点出发，通过双向扩展路径端点，确保每次扩展后端点邻域的完整性。最终路径的端点自然满足题目条件。

---

### 精选题解（评分≥4星）

#### 题解作者：小粉兔（★★★★★）
**关键亮点**：  
- 使用双端队列维护双向扩展路径，时间复杂度 O(N+M)
- 通过两次贪心扩展（先右后左）确保端点邻域条件
- 无需复杂数据结构，代码简洁高效

**核心代码思想**：  
```cpp
// 初始化路径起点
A[C=1] = B[D=1] = 1;
vis[1] = 1;

// 向右扩展路径
while (找到当前右端点未访问的邻点w) 
    A[++C] = w, vis[w]=1;

// 向左扩展路径
while (找到当前左端点未访问的邻点w) 
    B[++D] = w, vis[w]=1;

// 合并两段路径输出
printf("%d\n", C+D-1);
for (从右到左输出A) → 从左到右输出B
```

---

### 关键思路总结
1. **双向扩展策略**：从任意起点开始，分别向左右两个方向贪心地扩展路径，直到无法添加新顶点。
2. **邻域完整性保证**：每次扩展只添加未访问的邻点，最终端点邻域必然全部在路径中。
3. **合并输出技巧**：使用双数组分别记录左右扩展结果，最后合并输出。

---

### 拓展思考
类似构造型图论问题常采用**逐步扩展**和**端点维护**策略，例如：
1. 构造欧拉路径时维护当前路径端点
2. 哈密顿回路问题中的回溯剪枝技巧

---

### 推荐练习题
1. [P1137 旅行计划](https://www.luogu.com.cn/problem/P1137) - 拓扑排序与路径构造
2. [P3629 巡逻](https://www.luogu.com.cn/problem/P3629) - 树形结构的最优路径构造
3. [P4381 岛屿](https://www.luogu.com.cn/problem/P4381) - 基环树上的路径构造

---

### 题解心得摘录
feecle6418在错误解法中提到：  
> "这是一个假做法，但是能过（数据水了）... 希望有神仙找到反例"  
→ **教训**：构造题需严格证明正确性，贪心策略需考虑边界情况。数据强度不足可能导致错误解法通过，应通过数学证明或极端样例验证。

---
处理用时：41.25秒
# 题目信息

# [AGC019B] Reverse and Compare

## 题目描述

[problemUrl]: https://atcoder.jp/contests/agc019/tasks/agc019_b

英小文字からなる文字列 $ A\ =\ A_1\ A_2\ ...\ A_n $ があります。

あなたは $ 1\ \leq\ i\ \leq\ j\ \leq\ n $ であるような任意の二つの添字 $ i,\ j $ を選び、$ A $ のうち部分文字列 $ A_i\ A_{i+1}\ ...\ A_j $ を反転することができます。

この操作は一回まで行うことができます。

これによって得られる文字列は何通りあるでしょうか？

## 说明/提示

### 制約

- $ 1\ \leq\ |A|\ \leq\ 200,000 $
- $ A $ は英小文字からなる。

### Sample Explanation 1

得られる文字列は `aatt`（何もしない）、`atat`（$ A[2..3] $ を反転）、`atta`（$ A[2..4] $ を反転）、`ttaa`（$ A[1..4] $ を反転）、`taat`（$ A[1..3] $ を反転）です。

### Sample Explanation 2

どの部分文字列を反転しても、結果は `xxxxxxxxxx` です。

## 样例 #1

### 输入

```
aatt```

### 输出

```
5```

## 样例 #2

### 输入

```
xxxxxxxxxx```

### 输出

```
1```

## 样例 #3

### 输入

```
abracadabra```

### 输出

```
44```

# AI分析结果



# [AGC019B] Reverse and Compare

## 题目描述

给定一个由小写字母组成的字符串 $A$，你可以选择任意一个连续区间 $[i,j]$ 进行翻转操作（最多一次）。求最终能得到多少种不同的字符串。

## 说明/提示

### 制約
- $1 \leq |A| \leq 200,000$
- $A$ 由小写字母组成

---

**算法分类**：数学（组合计数）

---

### 题解分析与结论

核心思路：总方案数为 $\frac{n(n-1)}{2} +1$，减去所有相同字符对产生的重复翻转方案。关键公式为：  
$ans = \frac{n(n-1)}{2} +1 - \sum_{c} \frac{cnt_c(cnt_c-1)}{2}$  
其中 $cnt_c$ 表示字符 $c$ 的出现次数。

---

### 精选题解

#### 题解作者：GIFBMP（⭐⭐⭐⭐⭐）
**亮点**：  
- 简洁的数学建模，直接推导出公式  
- 代码简洁高效，时间复杂度 $O(n)$

**核心代码**：
```cpp
scanf("%s", s + 1); 
n = strlen(s + 1);
ans = (ll)n * (n - 1) / 2 + 1;
for(int i = 0; i < 26; i++) 
    ans -= (ll)t[i] * (t[i] - 1) / 2;
```

#### 题解作者：So_noSlack（⭐⭐⭐⭐）
**亮点**：  
- 详细的正难则反思想解释  
- 强调加1操作的注意事项

**核心代码**：
```cpp
ans = len * (len - 1) / 2;
for(int i = 0; i < 26; i++)
    ans -= num[i] * (num[i] - 1) / 2;
cout << ans + 1;
```

#### 题解作者：Endt（⭐⭐⭐⭐）
**亮点**：  
- 使用map实现字符统计  
- 强调long long类型的重要性

**核心代码**：
```cpp
ans = len * (len - 1) / 2;
for(char c = 'a'; c <= 'z'; c++)
    ans -= m[c] * (m[c]-1)/2;
cout << ans + 1;
```

---

### 关键技巧总结
1. **重复翻转的特征**：当且仅当区间端点字符相同时，翻转会产生重复结果
2. **组合数优化**：利用组合公式快速计算重复方案数
3. **数据类型控制**：使用long long避免整数溢出

---

### 拓展练习
1. [P1100 数字统计](https://www.luogu.com.cn/problem/P1100)  
   （字符频率统计应用）
2. [P1866 字符消除](https://www.luogu.com.cn/problem/P1866)  
   （字符串操作与计数结合）
3. [P1469 找筷子](https://www.luogu.com.cn/problem/P1469)  
   （奇数次字符的位运算解法）

---
处理用时：37.39秒
# 题目信息

# [ARC043B] 難易度

## 题目描述

cdcq想出一场模拟赛  
作为暴力选手，cdcq出的题自然是要有明显的梯度，来让更多的选手拿到自己的分数  
现在cdcq的idea库里有$ N(4\leq N\leq 10^5) $个idea，并且他给每个idea评估了一个难度值  
他要从中选择4个idea来出题，并且这些idea需要满足如下三个条件：  
第二道题的难度值必须大于等于第一道题的两倍  
第三道题的难度值必须大于等于第二道题的两倍  
第四道题的难度值必须大于等于第三道题的两倍  
现在cdcq想考考你他总共能组出多少套题  
因为答案太大，所以你需要对$ 1,000,000,007(10^9+7) $取模

## 说明/提示

部分点  
有50分满足$ 4\leq N \leq 3,000 $  
剩下的50分满足$ N(4\leq N\leq 10^5) $，共计100分  
Sample Explanation 1  
$ 1,2,3,5 $和$ 1,2,4,5 $都是可行的题目组合  
Sample Explanation 2  
没有任何一种组合满足题目条件  

感谢 @cdcq 提供的翻译

## 样例 #1

### 输入

```
5

1

2

4

5

10```

### 输出

```
2```

## 样例 #2

### 输入

```
10

11

12

13

14

15

16

17

18

19

20```

### 输出

```
0```

## 样例 #3

### 输入

```
20

1

2

3

4

5

6

7

8

9

10

11

12

13

14

15

16

17

18

19

20```

### 输出

```
94```

# AI分析结果



### 中文题目重写
**题目名称**：[ARC043B] 难易度  
**题目描述**：  
cdcq 想从自己的题库中选择4道题组成模拟赛，满足以下条件：  
- 第二题的难度 ≥ 第一题的两倍  
- 第三题的难度 ≥ 第二题的两倍  
- 第四题的难度 ≥ 第三题的两倍  

给定 $N(4 \leq N \leq 10^5)$ 个题目的难度值，求符合条件的组合数（模 $10^9+7$）。

---

**算法分类**：动态规划 + 前缀和优化

---

### 题解分析与结论
**核心思路**：  
1. **桶排序预处理**：统计每个难度值的出现次数，转化为桶数组 `a[]`  
2. **四阶段动态规划**：定义 `dp[i]` 表示选到第k道题时难度为i的方案数（滚动更新）  
3. **前缀和优化**：通过前缀和数组快速计算合法前驱的累计值，将复杂度优化至 $O(4 \cdot \max(a_i))$  
4. **一维空间优化**：利用滚动思想复用数组，减少空间占用  

**关键技巧**：  
- 通过乘法原理将计数问题转化为桶值的乘积  
- 利用前缀和将区间求和优化至 $O(1)$  
- 对四阶段问题采用分层递推处理  

---

### 高评分题解推荐
#### 题解1：作者@什么叫中二呀（★★★★★）  
**亮点**：  
- 清晰的桶排序预处理与滚动DP实现  
- 通过前缀和数组 `qzh[]` 实现高效状态转移  
- 完整处理了四阶段的递推关系  

**核心代码**：  
```cpp
for(int i=0;i<3;i++) // 滚动处理3次（对应第2-4题）
    for(int j=1;j<=m;j++) {
        qzh[j] = qzh[j-1] + dp[j];    // 前缀和
        dp[j] = a[j] * qzh[j/2];      // 乘法原理计算方案数
    }
```

#### 题解2：作者@Jiyuu_no_Tsubasa（★★★★☆）  
**亮点**：  
- 显式使用前缀和数组 `s[]` 优化累加操作  
- 代码简洁且模块化，易于理解  

**核心代码**：  
```cpp
for(int i=1;i<4;i++) {
    memset(s, 0, sizeof(s));          // 重置前缀和
    for(int j=1;j<=m;j++) {
        s[j] = (s[j-1] + dp[j]) % MOD;
        dp_new[j] = a[j] * s[j/2] % MOD;
    }
    swap(dp, dp_new);                 // 滚动数组
}
```

---

### 同类题目推荐
1. **P1004 [NOIP2000 提高组] 方格取数**（动态规划+路径计数）  
2. **P2513 [HAOI2009] 逆序对数列**（前缀和优化DP）  
3. **P2306 [HNOI2005] 狡猾的商人**（区间约束与动态规划结合）  

---

### 题解中的个人心得
- **桶排空间警告**：有题解提醒NOIP慎用桶排，需注意题目数据范围  
- **long long的重要性**：多个题解强调用 `long long` 防止溢出  
- **模运算时机**：在数据范围可控时可延迟取模以提升效率

---
处理用时：61.07秒
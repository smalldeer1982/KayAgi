# 题目信息

# [ABC097C] K-th Substring

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc097/tasks/arc097_a

文字列 $ s $ が与えられます。 $ s $ の**異なる** substring のうち、辞書順で $ K $ 番目に小さいものを出力してください。

ただし、$ s $ の substring とは、 $ s $ の空でない連続した部分を取り出してできる文字列とします。 例えば、 $ s $ $ = $ `ababc` とすると、 `a`, `bab`, `ababc` は $ s $ の substring ですが、 `ac`, `z`, 空文字列 は $ s $ の substring ではありません。 また、substring が異なるとは、文字列として異なることを指します。

なお、$ X\ =\ x_{1}x_{2}...x_{n}, $ $ Y\ =\ y_{1}y_{2}...y_{m} $ を二つの異なる文字列とするとき、$ Y $ が $ X $ の接頭辞であるか、$ j $ を $ x_{j}\ \neq\ y_{j} $ であるような最小の整数として $ x_{j}\ >\ y_{j} $ である場合、そしてその場合に限って $ X $ は $ Y $ より辞書順で大きいといいます。

## 说明/提示

### 制約

- $ 1 $ $ <\ = $ $ |s| $ $ <\ = $ $ 5000 $
- $ s $ は英小文字からなる
- $ 1 $ $ <\ = $ $ K $ $ <\ = $ $ 5 $
- $ s $ は異なる substring を $ K $ 個以上持つ

### 部分点

- $ |s| $ $ <\ = $ $ 50 $ を満たすデータセットに正解した場合は、部分点として $ 200 $ 点が与えられる。

### Sample Explanation 1

$ s $ の substring は `a`, `b`, `ab`, `ba`, `aba` の $ 5 $ つです。 このうち $ 4 $ 番目に小さい `b` を出力してください。 `a` を $ 2 $ 回カウントしないことに注意してください。

## 样例 #1

### 输入

```
aba

4```

### 输出

```
b```

## 样例 #2

### 输入

```
atcoderandatcodeer

5```

### 输出

```
andat```

## 样例 #3

### 输入

```
z

1```

### 输出

```
z```

# AI分析结果



# [ABC097C] K-th Substring

## 题目描述

给定字符串 $s$，求其所有**不同**子串中字典序第 $K$ 小的子串。子串定义为字符串中连续的非空子序列，两个子串不同当且仅当字符串内容不同。字典序比较规则参照常规字母序比较方式。

## 说明/提示

### 数据范围
- $1 \leq |s| \leq 5000$
- $s$ 由小写字母组成
- $1 \leq K \leq 5$
- 保证 $s$ 至少有 $K$ 个不同子串

### 样例解释
样例1中，所有子串为 `a`, `b`, `ab`, `ba`, `aba`，第4小为 `b`

---

**算法分类**：字符串

---

### 题解综合分析

本题核心在于高效枚举候选子串并快速确定第K小值。针对K极小的特点，主流解法分为两类：  
1. **暴力枚举优化**：利用K≤5的特性，限制生成子串的最大长度  
2. **后缀自动机（SAM）**：通过字典序遍历SAM结构直接获取第K小值

#### 关键思路对比
| 方法           | 核心思路                                                                 | 优缺点                                       |
|----------------|------------------------------------------------------------------------|--------------------------------------------|
| 分阶段暴力枚举 | 按首字母字典序分层生成子串，保证前序层结果足够时无需后续处理 | 时间复杂度最优，代码简洁，完美契合K极小的特性 |
| SAM            | 构建后缀自动机后按字典序遍历，统计子树规模确定路径选择        | 理论复杂度更优，但实现复杂，适合更大范围的K值 |

---

### 高星题解推荐

#### 题解1：火车司机的分阶段暴力枚举（5星）
**亮点**：  
- 分层按首字母字典序生成候选，大幅减少无效子串生成  
- 利用STL排序去重简化逻辑  
- 时间复杂度严格为O(K^2N)，完美适配题目条件  

**核心代码**：
```cpp
for (ri i = 1; i <= cnt; ++i) {
    string t = "";
    for (ri j = 0; j < k && a[i] + j < n; ++j) // 生成长度≤k的子串
        t += s[a[i] + j], str[++tot] = t;
}
sort(str + 1, str + 1 + tot);
tot = unique(str + 1, str + 1 + tot) - str - 1;
```

#### 题解2：stntn的SAM解法（4星）
**亮点**：  
- 基于后缀自动机的严格O(N)解法  
- 预处理每个状态的字典序路径数，高效确定第K小路径  

**关键实现**：
```cpp
void dfs(int u) {
    if (~siz[u]) return;
    siz[u] = 1;
    for (遍历所有字符边) 
        if (存在转移边v) {
            dfs(v);
            siz[u] += siz[v];
        }
}
```

---

### 最优思路总结
**分阶段首字母筛选法**：  
1. 维护当前最小候选字母`mn`  
2. 收集所有以`mn`开头的位置  
3. 生成这些位置的长度≤当前剩余K的子串  
4. 若候选足够则排序输出，否则计算剩余K后进入下一字母层  

该策略充分利用了字典序的单调性和K极小的特性，将时间复杂度从O(N^2)优化至O(K^2N)。

---

### 举一反三
1. [P3975 弦论](https://www.luogu.com.cn/problem/P3975)：SAM求第K小子串的扩展版  
2. [P2408 不同子串个数](https://www.luogu.com.cn/problem/P2408)：统计不同子串数量  
3. [P1368 最小表示法](https://www.luogu.com.cn/problem/P1368)：字符串循环最小表示

---
处理用时：209.41秒
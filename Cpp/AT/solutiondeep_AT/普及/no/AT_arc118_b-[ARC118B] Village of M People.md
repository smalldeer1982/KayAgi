# 题目信息

# [ARC118B] Village of M People

## 题目描述

[problemUrl]: https://atcoder.jp/contests/arc118/tasks/arc118_b

ARC 国には $ N $ 人の国民がおり、全国民が競技プログラミングのプレイヤーです。各国民にはその競技プログラミングの実力によって、$ 1,\ 2,\ \ldots,\ K $ のいずれかひとつの段位が与えられています。

ARC 国では国勢調査が行われて、その結果、段位 $ i $ の国民はちょうど $ A_i $ 人居ることが分かりました。ARC 国の国王はこの統計データをより理解しやすい形にするために、なるべく各段位の人数の割合を保ったまま、ARC 国の状況を $ M $ 人の村に例えることにしました。

$ M $ 人の村における段位 $ i $ の村民の人数 $ B_i $ を上手く定めることで、$ \max_i\left|\frac{B_i}{M}\ -\ \frac{A_i}{N}\right| $ を最小にしてください。ただし、次が成り立つ必要があります。

- 各 $ B_i $ は非負整数で、$ \sum_{i=1}^K\ B_i\ =\ M $ を満たす

そのような $ B\ =\ (B_1,\ B_2,\ \ldots,\ B_K) $ の定め方を、ひとつ出力してください。

## 说明/提示

### 制約

- $ 1\leq\ K\leq\ 10^5 $
- $ 1\leq\ N,\ M\leq\ 10^9 $
- 各 $ A_i $ は非負整数で、$ \sum_{i=1}^K\ A_i\ =\ N $ を満たす

### Sample Explanation 1

この出力において、$ \max_i\left|\frac{B_i}{M}\ -\ \frac{A_i}{N}\right|\ =\ \max\left(\left|\frac{3}{20}-\frac{1}{7}\right|,\ \left|\frac{6}{20}-\frac{2}{7}\right|,\ \left|\frac{11}{20}-\frac{4}{7}\right|\right)\ =\ \max\left(\frac{1}{140},\ \frac{1}{70},\ \frac{3}{140}\right)\ =\ \frac{3}{140} $ となっています。

### Sample Explanation 2

和を $ M\ =\ 100 $ にしなければならないので、$ B_1\ =\ B_2\ =\ B_3\ =\ 33 $ では 条件が満たされないことに注意してください。 なおこの例においては、`34 33 33` の他、`33 34 33` や `33 33 34` という出力も正解となります。

## 样例 #1

### 输入

```
3 7 20

1 2 4```

### 输出

```
3 6 11```

## 样例 #2

### 输入

```
3 3 100

1 1 1```

### 输出

```
34 33 33```

## 样例 #3

### 输入

```
6 10006 10

10000 3 2 1 0 0```

### 输出

```
10 0 0 0 0 0```

## 样例 #4

### 输入

```
7 78314 1000

53515 10620 7271 3817 1910 956 225```

### 输出

```
683 136 93 49 24 12 3```

# AI分析结果



# [ARC118B] Village of M People

## 题目描述

ARC 国有 $N$ 名国民，每位国民都被赋予 $1$ 到 $K$ 中的一个段位。统计显示，段位 $i$ 的国民恰好有 $A_i$ 人。现需构造一个 $M$ 人的村庄模型，使得 $\max_i\left|\frac{B_i}{M} - \frac{A_i}{N}\right|$ 最小，其中 $B_i$ 是非负整数且总和为 $M$。输出任意满足条件的 $B$ 数组。

**算法分类**：二分

---

### 题解分析

#### 题解作者：loser_seele（评分：★★★★☆）

**关键思路**：
1. **问题转化**：将目标函数转化为最小化 $\max |NB_i - MA_i|$，利用二分法确定该值的上限。
2. **二分验证**：对于二分中间值 $x$，计算每个段位的可行区间 $B_i \in \left[\lceil \frac{MA_i-x}{N} \rceil, \lfloor \frac{MA_i+x}{N} \rfloor \right]$，并验证总和是否可能达到 $M$。
3. **贪心构造**：先取所有段位的下界，再按上界余量分配剩余人数。

**代码亮点**：
- 使用二分高效缩小解空间。
- 上下界计算时处理负值情况（`max(0ll, ...)`）。
- 贪心分配剩余人数确保总和正确。

**核心代码**：
```cpp
bool check(int x) {
    for (int i = 1; i <= k; i++) {
        l[i] = max(0ll, (m * a[i] - x + n - 1) / n); // 计算下界
        r[i] = (m * a[i] + x) / n;                  // 计算上界
        suml += l[i]; sumr += r[i];
    }
    return suml <= m && sumr >= m;
}
// 构造部分
int sum = suml;
for (int i = 1; i <= k; i++) {
    int add = min(r[i] - l[i], m - sum);
    sum += add;
    cout << l[i] + add << " ";
}
```

---

### 最优技巧总结
- **二分答案法**：通过控制每个段位的误差上限，将最优化问题转化为可行性验证。
- **区间约束与贪心分配**：计算每个段位的可行区间后，优先满足下界再按余量调整。

---

### 相似题目推荐
1. [P1257 平面上的最接近点对](https://www.luogu.com.cn/problem/P1257) - 二分法求最小距离。
2. [P2216 [HAOI2007]理想的正方形](https://www.luogu.com.cn/problem/P2216) - 二维滑动窗口结合最值处理。
3. [P4344 [SHOI2015]脑洞治疗仪](https://www.luogu.com.cn/problem/P4344) - 二分答案与区间操作结合。

---
处理用时：88.36秒
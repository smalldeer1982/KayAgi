# 题目信息

# [ARC121B] RGB Matching

## 题目描述

[problemUrl]: https://atcoder.jp/contests/arc121/tasks/arc121_b

すぬけ君は $ 1 $ から $ 2N $ の番号がついた $ 2N $ 匹の犬を飼っています。

犬 $ i $ のかわいさは $ a_i $ です。 それぞれの犬の体色は赤、緑、青のいずれかで、犬 $ i $ の体色は $ c_i $ です。 $ c_i $ は `R`, `G`, `B` のいずれかであり、`R` ならばその犬の体色が赤であることを、`G` ならば緑であることを、`B` ならば青であることを表します。

すぬけ君は $ N $ 棟の犬小屋を持っており、それぞれの犬小屋に $ 2 $ 匹の犬を住まわせようとしています。 どの犬もちょうど一つの犬小屋に住んでいるように住まわせる必要があることに注意してください。

$ 2 $ 匹の犬を同じ犬小屋に住まわせるとその小屋には *不満* が生じます。 不満の度合いは整数で表され、犬 $ i,j $ が同じ小屋にいるとき生じる不満は $ c_i\ =\ c_j $ ならば $ 0 $、そうでなければ $ |a_i\ -\ a_j| $ です。

$ N $ 棟の犬小屋に犬を $ 2 $ 匹ずつ住まわせた結果生じる不満の総和としてありうる値の最小値を求めてください。

## 说明/提示

### 制約

- $ 1\ \leq\ N\ \leq\ 10^{5} $
- $ 1\ \leq\ a_i\ \leq\ 10^{15} $
- $ a_i $ は整数
- $ c_i $ は `R`, `G`, `B` のいずれか

### Sample Explanation 1

\- 犬 $ 1 $ のかわいさは $ 1 $、犬 $ 2 $ のかわいさは $ 2 $ です。 - $ c_1\ \neq\ c_2 $ より、不満は $ 1 $ となります。

### Sample Explanation 2

\- 犬 $ 1 $ のかわいさは $ 1 $、犬 $ 2 $ のかわいさは $ 2 $ です。 - $ c_1\ =\ c_2 $ より、不満は $ 0 $ となります。

## 样例 #1

### 输入

```
1

1 R

2 G```

### 输出

```
1```

## 样例 #2

### 输入

```
1

1 B

2 B```

### 输出

```
0```

## 样例 #3

### 输入

```
10

585 B

293 B

788 B

222 B

772 G

841 B

115 R

603 G

450 B

325 R

851 B

205 G

134 G

651 R

565 R

548 B

391 G

19 G

808 B

475 B```

### 输出

```
0```

# AI分析结果



# [ARC121B] RGB Matching

## 题目描述

すぬけ君饲养了编号为 $1$ 到 $2N$ 的 $2N$ 只狗。每只狗的可爱度为 $a_i$，体色为 `R`、`G`、`B` 中的一种。需要将这 $2N$ 只狗分配到 $N$ 个狗屋中，每个狗屋住两只狗。不满意度计算规则为：若两只狗颜色不同，则产生 $|a_i - a_j|$ 的不满意度；颜色相同则不产生。求最小总不满意度。

## 算法分类
贪心

---

## 题解分析与结论

### 核心思路
1. **奇偶性分析**：统计三种颜色的数量奇偶性。若全为偶数，总不满意度为0。
2. **奇数组处理**：当两种颜色数量为奇数时，存在两种最优策略：
   - 直接在该两种颜色中找一对差值最小的进行配对
   - 各找一个与第三种颜色配对，总不满意度为两次差值之和
3. **二分查找优化**：通过排序后二分/双指针快速找到跨颜色的最小差值对

### 高质量题解推荐

#### 题解1（DengDuck，5星）
**关键亮点**：  
- 通过数学性质证明最优解的配对方式不超过两对异色
- 使用set维护前驱后继实现快速差值计算
- 代码简洁且时间复杂度严格 $O(n\log n)$

**核心代码**：
```cpp
set<LL>s,s1;
for(LL i:v[1]){
    auto t1=s.lower_bound(i);
    LL t=inf;
    if(t1!=s.end()) t = min(t,*t1-i);
    if(t1!=s.begin()) t = min(t,i-*(--t1));
    ans = min(ans,t);
}
// 类似处理其他颜色组合
```

#### 题解2（HappyJaPhy，5星）
**关键亮点**：  
- 采用双指针法优化跨颜色差值计算
- 明确分情况讨论两种可能的最优策略
- 代码模块化设计清晰

**核心代码**：
```cpp
inline int calc(int u, int v) {
    int ans = inf, j = 0;
    for(int i = 0; i < a[u].size(); i++) {
        while(j+1 < a[v].size() && a[v][j+1] <= a[u][i]) j++;
        ans = min(ans, abs(a[u][i]-a[v][j]));
        if(j+1 < a[v].size()) 
            ans = min(ans, abs(a[u][i]-a[v][j+1]));
    }
    return ans;
}
```

---

## 关键技巧总结
1. **奇偶性转换思维**：将复杂配对问题转化为奇偶数量的组合问题
2. **有序化处理**：先排序再利用二分/双指针快速查找相邻元素
3. **多策略比较**：当存在多种可能的最优路径时，计算所有可能情况取最小值

---

## 拓展练习
1. [P1102 最接近的两位数](https://www.luogu.com.cn/problem/P1102) - 双指针找最小差值
2. [P1090 合并果子](https://www.luogu.com.cn/problem/P1090) - 贪心策略应用
3. [P1873 砍树](https://www.luogu.com.cn/problem/P1873) - 二分答案结合差值处理

---
处理用时：58.64秒
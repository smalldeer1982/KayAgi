# 题目信息

# [ARC125B] Squares

## 题目描述

[problemUrl]: https://atcoder.jp/contests/arc125/tasks/arc125_b

整数 $ N $ が与えられます． 以下の条件を満たす整数の組 $ (x,y) $ の個数を $ 998244353 $ で割った余りを求めてください．

- $ 1\ \leq\ x,y\ \leq\ N $
- $ x^2-y $ は平方数である．（特に，$ 0 $ も平方数とする．）

## 说明/提示

### 制約

- $ 1\ \leq\ N\ \leq\ 10^{12} $
- 入力される値はすべて整数である

### Sample Explanation 1

以下の $ 2 $ 通りが考えられます． - $ x=1,y=1 $ - $ x=2,y=3 $

## 样例 #1

### 输入

```
3```

### 输出

```
2```

## 样例 #2

### 输入

```
10```

### 输出

```
8```

## 样例 #3

### 输入

```
10000000000```

### 输出

```
52583544```

# AI分析结果



# [ARC125B] Squares

## 题目描述

给定整数 $ N $，求满足以下条件的整数对 $ (x,y) $ 的个数，结果对 $ 998244353 $ 取模：

- $ 1 \leq x,y \leq N $
- $ x^2 - y $ 是平方数（包括 $ 0 $）

---

**算法分类**：数学、枚举

---

## 题解分析与结论

### 核心思路对比
所有题解均基于以下推导：
1. 设 $ x^2 - y = k^2 $，移项得 $ y = (x-k)(x+k) $。
2. 枚举 $ i = x-k $，则 $ x+k \leq \lfloor N/i \rfloor $。
3. 利用奇偶性条件：$ i $ 和 $ x+k $ 必须同奇偶，计算合法区间内的数目。

### 最优题解

#### 1. 作者：RNTBW（5星）
**关键亮点**：  
- 代码简洁高效，直接计算奇偶性相同的区间长度。
- 正确使用模运算，避免溢出问题。

**核心代码**：
```cpp
s = (s + (k - i)/2 + 1) % 998244353;
```

#### 2. 作者：User_Unauthorized（5星）
**关键亮点**：  
- 双重条件验证（$ z \leq N - b $ 和 $ z \leq (N - b^2)/(2b) $），数学推导严谨。
- 代码清晰，边界处理明确。

**核心代码**：
```cpp
ans += (std::min((N - i * i) / (2 * i), N - i) + 1) % MOD;
```

#### 3. 作者：Archy_（4星）
**关键亮点**：  
- 变量命名清晰，代码可读性强。
- 直接通过奇偶性区间计算贡献，逻辑简明。

**核心代码**：
```cpp
ans = (ans + (mmax - i)/2 + 1) % 998244353;
```

---

## 关键思路与技巧
1. **因数分解与奇偶性**：将问题转化为枚举因数对 $(i, j)$，利用奇偶性相同快速统计合法数目。
2. **数学优化**：通过 $ i \leq \sqrt{N} $ 缩小枚举范围，时间复杂度优化至 $ O(\sqrt{N}) $。
3. **边界处理**：通过取模顺序和区间计算避免溢出。

---

## 拓展与同类题目
1. **因数分解类**：AT1218 [数え上げ](https://www.luogu.com.cn/problem/AT1218)
2. **奇偶性计数**：CF1549D [Integers Have Friends](https://www.luogu.com.cn/problem/CF1549D)
3. **数学推导优化**：P2424 约数和（需推导约数和公式）

---

## 个人心得摘录
- **奇偶性陷阱**：必须严格保证 $(x-k)$ 和 $(x+k)$ 奇偶性相同，否则会漏解。
- **枚举优化**：循环终止条件设为 $ i \leq \sqrt{N} $，避免重复计算。
- **模运算顺序**：应先累加完整贡献再取模，避免中间步骤错误。

---
处理用时：240.06秒
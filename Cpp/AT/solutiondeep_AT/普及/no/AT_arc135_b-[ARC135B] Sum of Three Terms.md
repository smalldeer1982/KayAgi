# 题目信息

# [ARC135B] Sum of Three Terms

## 题目描述

[problemUrl]: https://atcoder.jp/contests/arc135/tasks/arc135_b

項数 $ N $ の整数列 $ S\ =\ (S_1,\ \ldots,\ S_N) $ が与えられます。 項数 $ N+2 $ の整数列 $ A\ =\ (A_1,\ \ldots,\ A_{N+2}) $ であって、次の条件を満たすものが存在するか否かを判定してください。

- 任意の $ i $ ($ 1\leq\ i\leq\ N+2 $) に対して $ 0\leq\ A_i $ が成り立つ。
- 任意の $ i $ ($ 1\leq\ i\leq\ N $) に対して、$ S_i\ =\ A_{i}\ +\ A_{i+1}\ +\ A_{i+2} $ が成り立つ。

存在する場合には、そのようなものをひとつ出力してください。

## 说明/提示

### 制約

- $ 1\leq\ N\leq\ 3\times\ 10^5 $
- $ 0\leq\ S_i\leq\ 10^9 $

### Sample Explanation 1

以下のように、任意の $ i $ ($ 1\leq\ i\leq\ N $) に対して $ S_i\ =\ A_i\ +\ A_{i+1}\ +\ A_{i+2} $ が成り立つことが確認できます。 - $ 6\ =\ 0\ +\ 4\ +\ 2 $。 - $ 9\ =\ 4\ +\ 2\ +\ 3 $。 - $ 6\ =\ 2\ +\ 3\ +\ 1 $。 - $ 6\ =\ 3\ +\ 1\ +\ 2 $。 - $ 5\ =\ 1\ +\ 2\ +\ 2 $。

## 样例 #1

### 输入

```
5

6 9 6 6 5```

### 输出

```
Yes

0 4 2 3 1 2 2```

## 样例 #2

### 输入

```
5

0 1 2 1 0```

### 输出

```
No```

## 样例 #3

### 输入

```
1

10```

### 输出

```
Yes

0 0 10```

# AI分析结果



# [ARC135B] Sum of Three Terms

## 题目描述

给定一个项数为 $ N $ 的整数序列 $ S = (S_1, \ldots, S_N) $，判断是否存在一个项数为 $ N+2 $ 的整数序列 $ A = (A_1, \ldots, A_{N+2}) $ 满足以下条件：

- 所有 $ A_i $ 非负。
- 对任意 $ 1 \leq i \leq N $，有 $ S_i = A_i + A_{i+1} + A_{i+2} $。

若存在，输出一个可能的解。

---

**算法分类**：构造、差分

---

### 题解分析与结论

所有题解的核心思路均基于差分方程 $ S_{i+1} - S_i = A_{i+3} - A_i $。通过此关系，将 $ A $ 序列分解为三个独立的链（模 3 的余数类），分别处理每个链的最小偏移量，确保非负性，并通过调整前三项的和匹配 $ S_1 $。

#### 高分题解亮点（评分≥4星）

1. **Union_Find（4星）**
   - **关键思路**：初始设定前三项为0，递推后续项并记录三个链的最小值。通过调整前三项的偏移量确保非负性，最后验证总和是否匹配。
   - **代码要点**：
     ```cpp
     for (int i = 1; i < n; i++) {
         a[i + 3] = a[i] + s[i + 1] - s[i];
         // 记录三个链的最小值 ma, mb, mc...
     }
     a[1] = -ma, a[2] = -mb, a[3] = -mc;
     a[3] += s[1] - (a[1] + a[2] + a[3]); // 调整前三项的和
     ```

2. **loser_seele（4星）**
   - **关键思路**：将前三项设为 $ a, b $，通过周期性规律构造后续项。利用贪心思想直接取最小约束值，确保合法解。
   - **代码要点**：
     ```cpp
     for (int i = 1; i < n; i++) 
         s[i%3] += a[i+1] - a[i]; // 计算三个链的累积差值
     b[1] = -mn[1], b[2] = -mn[2], b[3] = -mn[0]; // 调整偏移量
     ```

3. **Lele_Programmer（4星）**
   - **关键思路**：显式处理三个独立链的最小值，通过分类计算确保非负性，最终统一调整前三项。
   - **代码要点**：
     ```cpp
     _rep(i,1,3) {
         int cur = c[i], mn = c[i];
         // 遍历每个链计算最小值...
     }
     a[1] += s[1] - (a[1] + a[2] + a[3]); // 修正前三项总和
     ```

---

### 最优思路总结

1. **差分分解**：通过 $ S_{i+1} - S_i = A_{i+3} - A_i $ 将 $ A $ 序列分为三个独立的链（模3余数链）。
2. **最小偏移调整**：计算每个链的最小值，通过偏移量确保所有元素非负。
3. **前三项修正**：调整前三项的值使得 $ A_1 + A_2 + A_3 = S_1 $，若无法满足则无解。

---

### 类似题目推荐

1. [P3405 [USACO16DEC] Cities and States S](https://www.luogu.com.cn/problem/P3405)  
   **考察点**：哈希与构造性统计。
2. [P5482 [JLOI2011] 不等式组](https://www.luogu.com.cn/problem/P5482)  
   **考察点**：差分约束与数学推导。
3. [P1253 扶苏的问题](https://www.luogu.com.cn/problem/P1253)  
   **考察点**：贪心构造与区间操作。

---
处理用时：68.13秒
# 题目信息

# DivRem Number

## 题目描述

[problemUrl]: https://atcoder.jp/contests/diverta2019/tasks/diverta2019_d

すぬけ君は高橋君から正の整数 $ N $ をもらいました。 正の整数 $ m $ が以下の条件を満たすとき、 *お気に入りの数* と呼ばれます。

- $ N $ を $ m $ で割った商とあまりが等しい、すなわち $ \lfloor\ \frac{N}{m}\ \rfloor\ =\ N\ \bmod\ m $ が成立する

お気に入りの数を全て求め、その総和を出力してください。

## 说明/提示

### 制約

- 入力は全て整数
- $ 1\ \leq\ N\ \leq\ 10^{12} $

### Sample Explanation 1

\- お気に入りの数は $ 3 $ と $ 7 $ の $ 2 $ つです。これらの総和である $ 10 $ を出力してください。

### Sample Explanation 2

\- オーバーフローに注意してください。

## 样例 #1

### 输入

```
8```

### 输出

```
10```

## 样例 #2

### 输入

```
1000000000000```

### 输出

```
2499686339916```

# AI分析结果



### 题目重写  
**题目名称**：DivRem Number  

**题目描述**  
すぬけ君从高桥君那里得到了一个正整数 $N$。称正整数 $m$ 为"喜欢的数"，当且仅当满足：  
$ \lfloor\ \frac{N}{m}\ \rfloor\ =\ N\ \bmod\ m $  
即 $N$ 除以 $m$ 的商等于余数。请找出所有满足条件的 $m$ 的总和。  

**输入格式**  
输入一个正整数 $N$。  
**输出格式**  
输出所有满足条件的 $m$ 的总和。  
**数据范围**  
$1 \leq N \leq 10^{12}$  

---

### 算法分类  
**数学**  

---

### 题解对比与分析  

#### 核心思路  
设商和余数为 $x$，则有 $N = x(m+1)$，且余数 $x < m$，推导得 $x^2 + x < N$。通过枚举 $x$ 或 $n$ 的因数，计算对应的 $m = \frac{N}{x} -1$，并验证 $x < m$ 的条件。

#### 关键难点  
1. **数学条件转化**：将余数条件转化为 $N = x(m+1)$ 的形式  
2. **枚举范围优化**：确定 $x$ 的上界为 $\sqrt{N}$ 级别以避免超时  
3. **去重与验证**：确保 $m = \frac{N}{x} -1$ 满足 $x < m$  

---

### 高星题解推荐  

#### 1. 作者：chl090410（★★★★★）  
**亮点**  
- 思路简洁，直接枚举 $x$  
- 循环终止条件 $i(i+1) < n$ 精确控制范围  
- 代码仅 10 行，逻辑清晰  
**核心代码**  
```cpp
for(int i=1; i*(i+1)<n; i++){
    if(n%i==0) m += (n/i -1);
}
```  
**分析**  
循环中 $i$ 对应商 $x$，$n/i-1$ 得到 $m$。利用 $x(x+1) < n$ 保证 $x < m$，且无需额外验证条件。

#### 2. 作者：囧仙（★★★★☆）  
**亮点**  
- 通过因数分解的对称性优化枚举  
- 处理了 $x=1$ 的特殊情况  
**核心代码**  
```cpp
for(x=1; x*x<n; x++) if(n%x==0){
    if(x!=1 && n%(x-1)==n/(x-1)) ans += x-1;
    if(n%(n/x-1)==n/(n/x-1)) ans +=n/x-1;
}
```  
**分析**  
同时枚举小因数和大因数，避免重复计算。需注意当 $x=1$ 时可能产生无效解，需单独判断。

#### 3. 作者：Galois_Field_1048576（★★★★☆）  
**亮点**  
- Python 实现因数对枚举  
- 生成所有因数后统一处理  
**核心代码**  
```python
for j in all_factors(n)[1:]:
    i = j-1
    if n//i == n%i: ans +=i
```  
**分析**  
通过预生成全部因数，再筛选合法解。适用于解释型语言的优化思路，但在 C++ 中需注意大数计算效率。

---

### 最优思路总结  
1. **数学推导**：$N = x(m+1)$ 且 $x < m$ ⇒ $x^2 + x < N$  
2. **枚举范围**：$x$ 的取值上限为 $\sqrt{N}$ 级别  
3. **因数对称性**：仅需枚举到 $\sqrt{N}$，结合小因数和大因数处理  

**实现模板**  
```cpp
long long solve(long long n) {
    long long ans = 0;
    for (long long x = 1; x * (x + 1) < n; ++x) {
        if (n % x == 0) ans += (n / x - 1);
    }
    return ans;
}
```

---

### 同类题目推荐  
1. [P1463 HAOI2007 反素数](https://www.luogu.com.cn/problem/P1463)  
   - 关键点：因数性质与数学优化  
2. [P1414 又是毕业季II](https://www.luogu.com.cn/problem/P1414)  
   - 关键点：因数频率统计与极值处理  
3. [P2424 约数和](https://www.luogu.com.cn/problem/P2424)  
   - 关键点：因数求和与分块优化

---
处理用时：49.51秒
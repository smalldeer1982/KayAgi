# 题目信息

# JOIOI の塔 (Tower of JOIOI)

## 题目描述

JOIOI 塔是一种单人游戏。

这个游戏要用到一些写有 `J`, `O`, `I` 中任一文字的圆盘。这些圆盘的直径互不相同。游戏开始时，这些圆盘按照直径大的在下面的规则堆叠。你需要用这些圆盘做尽量多的迷你 JOIOI 塔。迷你 JOIOI 塔由 $3$ 个圆盘构成，从直径较小的圆盘开始分别为 `J`, `O`, `I` 或分别为 `I`, `O`, `I` 。不过，每个圆盘最多只能使用一次。

给出长为 $N$ 的字符串 $S$ ，表示直径从小到大的圆盘上的文字。请编写程序求出使用这些圆盘能够做出的迷你 JOIOI 塔个数的最大值。

## 说明/提示

对于所有数据，$1\leq N \leq 10^6$。

| 子任务 |     分值      |   $N\le$    |
| :----: | :-----------: | :---------: |
|  $1$   |     $10$      | $N \leq 15$ |
|  $2$   |     $20$      | $N \leq 50$ |
|  $3$   | $N \leq 3000$ | $N\leq3000$ |
|  $4$   |     $50$      | $N\leq10^6$ |

## 样例 #1

### 输入

```
6
JOIIOI```

### 输出

```
2```

## 样例 #2

### 输入

```
5
JOIOI```

### 输出

```
1```

## 样例 #3

### 输入

```
6
JOIOII```

### 输出

```
2```

## 样例 #4

### 输入

```
15
JJOIIOOJOJIOIIO```

### 输出

```
4```

# AI分析结果



# 题目中文翻译

## 题目名称
JOIOI の塔 (Tower of JOIOI)

## 题目描述
JOIOI 塔是一种单人游戏。游戏使用写有 `J`、`O`、`I` 的圆盘，直径互不相同且按从大到小堆叠。目标是用这些圆盘组成尽可能多的迷你塔，每个塔由三个圆盘构成，形式为 `J`-`O`-`I`（直径递增）或 `I`-`O`-`I`。每个圆盘只能使用一次。

给定长度为 $N$ 的字符串 $S$（按直径从小到大排列），求可组成的最大迷你塔数量。

## 输入输出样例
（样例内容与原文一致，此处省略）

---

**算法分类**: 贪心

---

### 题解分析与结论
两种解法均采用倒序处理策略，核心难点在于如何高效分配 `I` 的用途（作为新塔的起点或现有塔的终点）：
1. **二分法**（时间复杂度 $O(n \log n)$）：通过二分枚举可能的塔数量，用贪心模拟验证可行性。
2. **线性贪心**（时间复杂度 $O(n)$）：通过前缀预处理和状态维护直接计算最优解。

线性贪心解法在时间效率上更优，且无需二分验证，但需要巧妙的状态转移设计。

---

### 精选题解

#### 题解1：喵仔牛奶（★★★★☆）
**关键亮点**：
- 线性时间复杂度，高效处理百万级数据。
- 引入前缀数组 `pre` 快速判断 `I` 的分配策略。
- 维护 `w`（可用 `I`）、`ow`（可用 `OI` 段）状态变量。

**代码核心逻辑**：
```cpp
for (int i = n; i >= 1; i --) {
    if (s[i] == 'J' && ow) ow--, tot++;  // 组成 JOI
    if (s[i] == 'O' && w) w--, ow++;     // 组成中间 OI 段
    if (s[i] == 'I') {
        if (ow + w >= pre[i] && ow) ow--, tot++; // 组成 IOI
        else w++;                      // 保留为新的 I
    }
}
```

#### 题解2：Yizhixiaoyun（★★★★☆）
**关键亮点**：
- 二分答案框架清晰，逻辑易于验证。
- 通过 `cnt1`、`cnt2` 动态维护中间状态。

**个人心得**：
> 需注意 `I` 的分配策略：当已匹配的塔数量不足时，优先保留 `I` 作为新塔起点。

---

### 最优思路提炼
1. **倒序处理**：由于塔的底层字符（如 `J` 或 `I`）需要最后出现，倒序处理能更高效匹配。
2. **状态维护**：用变量记录中间可用片段（如 `OI`、`I`），避免重复扫描。
3. **资源分配策略**：优先将 `I` 用于完成现有塔，仅当塔顶资源充足时才保留为新塔起点。

---

### 拓展练习
1. [P1090 合并果子](https://www.luogu.com.cn/problem/P1090)（贪心+优先队列）
2. [P2679 子串](https://www.luogu.com.cn/problem/P2679)（字符串动态规划）
3. [P5019 铺设道路](https://www.luogu.com.cn/problem/P5019)（贪心策略设计）

---
处理用时：46.93秒
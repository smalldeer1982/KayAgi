# 题目信息

# とてもたのしい家庭菜園 (Growing Vegetables is Fun 4)

## 题目描述

[problemUrl]: https://atcoder.jp/contests/joi2021ho/tasks/joi2021ho_a

家庭菜園が趣味のビ太郎は自宅の庭でビバ草という植物を育てている．庭には $ N $ 株のビバ草が東西方向に一列に植えられており，西側から順に $ 1 $ から $ N $ までの番号が付いている．現在，ビバ草 $ i $ ($ 1\ \leqq\ i\ \leqq\ N $) の背丈は $ A_i $ である．

育てているビバ草は特別な品種改良の結果，水を与えるたびに背丈が $ 1 $ 伸びる．ビ太郎は庭の見栄えを良くするために水やりを複数回行い，以下の条件を満たすようにしたいと考えている．

- すべての水やりを行った後のビバ草 $ i $ ($ 1\ \leqq\ i\ \leqq\ N $) の背丈を $ B_i $ とする．このとき，「$ 1\ \leqq\ j\ \leqq\ k\ -\ 1 $ に対し $ B_j\ <\ B_{j\ +\ 1} $」かつ「$ k\ \leqq\ j\ \leqq\ N\ -\ 1 $ に対し $ B_j\ >\ B_{j\ +\ 1} $」を満たすような整数 $ k $ ($ 1\ \leqq\ k\ \leqq\ N $) が存在する．

ただし，ビ太郎は不器用なため，$ 1 $ 回の水やりにおいて，ある区間上のビバ草に一斉に水を与えることしかできない．すなわち，水やりを行うたびにある整数 $ L,\ R $ ($ 1\ \leqq\ L\ \leqq\ R\ \leqq\ N $) を選び，ビバ草 $ L,\ L\ +\ 1,\ \ldots,\ R $ に水を与える．

ビ太郎は水やりの回数をできるだけ少なくしたい．

ビバ草の数と現在の背丈の情報が与えられたとき，条件を満たすのに必要な水やりの回数の最小値を求めるプログラムを作成せよ．

- - - - - -

## 说明/提示

### 制約

- $ 2\ \leqq\ N\ \leqq\ 200\,000 $．
- $ 1\ \leqq\ A_i\ \leqq\ 1\,000\,000\,000 $ ($ 1\ \leqq\ i\ \leqq\ N $)．

### 小課題

1. ($ 40 $ 点) $ N\ \leqq\ 2\,000 $．
2. ($ 60 $ 点) 追加の制約はない．

- - - - - -

### Sample Explanation 1

以下のように水やりを $ 3 $ 回行うことで条件を満たすことができる． - $ L=2 $，$ R=5 $ として，ビバ草 $ 2,\ 3,\ 4,\ 5 $ に水を与える．ビバ草の背丈は西から順に $ 3,\ 3,\ 3,\ 4,\ 2 $ となる． - $ L=2 $，$ R=3 $ として，ビバ草 $ 2,\ 3 $ に水を与える．ビバ草の背丈は西から順に $ 3,\ 4,\ 4,\ 4,\ 2 $ となる． - $ L=3 $，$ R=3 $ として，ビバ草 $ 3 $ に水を与える．ビバ草の背丈は西から順に $ 3,\ 4,\ 5,\ 4,\ 2 $ となる． $ 2 $ 回以下の水やりで条件を満たすことは不可能なので，必要な水やりの回数の最小値は $ 3 $ である． - - - - - -

### Sample Explanation 2

すでに条件を満たしているため，必要な水やりの回数の最小値は $ 0 $ である． - - - - - -

### Sample Explanation 3

1 回の水やりで条件を満たすためには，$ L\ =\ 1 $，$ R\ =\ 1 $ としてビバ草 $ 1 $ に水を与えるか，または，$ L\ =\ 2 $，$ R\ =\ 2 $ としてビバ草 $ 2 $ に水を与えればよい． - - - - - -

## 样例 #1

### 输入

```
5
3 2 2 3 1```

### 输出

```
3```

## 样例 #2

### 输入

```
5
9 7 5 3 1```

### 输出

```
0```

## 样例 #3

### 输入

```
2
2021 2021```

### 输出

```
1```

## 样例 #4

### 输入

```
8
12 2 34 85 4 91 29 85```

### 输出

```
93```

# AI分析结果



**题目重写：**

# 非常有趣的家庭菜园 (Growing Vegetables is Fun 4)

## 题目描述

家庭菜园爱好者 Bitaro 在庭院中种植了一排共 $N$ 株特殊品种的植物“Biba草”，自西向东编号为 $1$ 到 $N$。第 $i$ 株 Biba草当前高度为 $A_i$。每次浇水可以选择一个区间 $[L, R]$，使该区间内所有草的高度增加 $1$。Bitaro 希望通过若干次浇水后，存在某个位置 $k$，使得：

- 对于所有 $1 \leq j < k$，浇水后的高度 $B_j < B_{j+1}$；
- 对于所有 $k \leq j < N$，浇水后的高度 $B_j > B_{j+1}$。

求达成目标所需的最小浇水次数。

---

**算法分类：差分**

---

**题解分析与结论：**

### 关键思路
1. **差分转换**：将原数组 $A$ 转化为差分数组 $a_i = A_{i+1} - A_i$（$1 \leq i < N$）。问题转化为调整 $a_i$，使得存在 $k$，满足前 $k-1$ 个差分均正，后续差分均负。
2. **操作分析**：每次区间浇水对应差分数组的两次修改：左端点差分值 $+1$，右端点后一位差分值 $-1$。
3. **前缀后缀预处理**：计算前 $i$ 个差分需要增加的次数（前缀和数组 `pre`），和后 $i$ 个差分需要减少的次数（后缀和数组 `suf`）。
4. **遍历最优解**：对每个可能的 $k$，计算 `max(pre[k-1], suf[k])`，取最小值即为答案。

### 评分较高的题解
**题解作者：jiangxinyang2012（⭐️⭐️⭐️⭐️⭐️）**
- **亮点**：巧妙利用差分转换，将复杂区间操作简化为前缀后缀统计，时间复杂度 $O(N)$。
- **核心代码**：
  ```cpp
  #include <bits/stdc++.h>
  using namespace std;
  typedef long long LL;
  const int N = 2e5 + 5;
  LL n, a[N], pre[N], suf[N];
  
  int main() {
      cin >> n;
      vector<LL> A(n);
      for (auto &x : A) cin >> x;
      int m = n - 1;
      for (int i = 1; i <= m; ++i)
          a[i] = A[i] - A[i-1];
      // 前缀和
      for (int i = 1; i <= m; ++i)
          pre[i] = pre[i-1] + max(0LL, 1 - a[i]);
      // 后缀和
      for (int i = m; i >= 1; --i)
          suf[i] = suf[i+1] + max(0LL, a[i] + 1);
      LL ans = 1e18;
      for (int k = 1; k <= n; ++k)
          ans = min(ans, max(pre[k-1], suf[k]));
      cout << ans << endl;
      return 0;
  }
  ```

---

**拓展题目推荐：**
1. [P2879 Tallest Cow](https://www.luogu.com.cn/problem/P2879) - 差分数组处理区间约束。
2. [P4552 IncDec Sequence](https://www.luogu.com.cn/problem/P4552) - 差分统计最小操作次数。
3. [P3406 海底高铁](https://www.luogu.com.cn/problem/P3406) - 前缀和与差分结合。

---
处理用时：251.78秒
# 题目信息

# Maximum Sum of Minimum

## 题目描述

[problemUrl]: https://atcoder.jp/contests/m-solutions2019/tasks/m_solutions2019_d

$ N $ 個の頂点 $ 1,2,\ldots,N $ からなる木 $ T $ と正の整数 $ c_1,c_2,\ldots,c_N $ が与えられます。 $ i(1\ \leq\ i\ \leq\ N-1) $ 番目の辺は頂点 $ a_i $ と頂点 $ b_i $ をつなぐ辺です。

$ T $ の各頂点に正の整数を書き込んだとき、以下のようにしてスコアを計算します。

- 各辺に、$ 2 $ つの端点に書き込まれた整数のうち小さい方を書き込む。
- 各辺に書き込まれた整数の総和をスコアとする。

$ T $ の各頂点に $ c_1,c_2,\ldots,c_N $ を $ 1 $ つずつ書き込んだときのスコアの最大値を求め、 それを達成する正の整数の書き込み方を $ 1 $ つ構成してください。

$ c_1,c_2,\ldots,c_N $ に複数回現れる整数があるときは、 その整数はその回数だけ使わなければならないことに注意してください。

## 说明/提示

### 制約

- $ 1\ \leq\ N\ \leq\ 10000 $
- $ 1\ \leq\ a_i,b_i\ \leq\ N $
- $ 1\ \leq\ c_i\ \leq\ 10^5 $
- 与えられるグラフは木である

### Sample Explanation 1

頂点 $ 1,2,3,4,5 $ にそれぞれ $ 1,2,3,4,5 $ を書き込むと、 $ 4 $ つの辺にはそれぞれ $ 1,2,3,4 $ が書き込まれるので、スコアは $ 10 $ になります。 これが最大のスコアです。

### Sample Explanation 2

$ c_1,c_2,\ldots,c_N $ は互いに異なるとは限りません。

## 样例 #1

### 输入

```
5

1 2

2 3

3 4

4 5

1 2 3 4 5```

### 输出

```
10

1 2 3 4 5```

## 样例 #2

### 输入

```
5

1 2

1 3

1 4

1 5

3141 59 26 53 59```

### 输出

```
197

59 26 3141 59 53```

# AI分析结果



### 题目重写
$ N $ 个顶点组成的树 $ T $ 和正整数序列 $ c_1,c_2,\ldots,c_N $ 给定。每条边连接顶点 $ a_i $ 和 $ b_i $。将 $ c $ 中的数分配给各顶点后，每条边的权值为两端点中的较小值。求所有边权值和的最大值，并构造一种分配方案。

### 算法分类
贪心

---

### 题目分析
核心目标是通过合理分配数值，使得每条边的较小值之和最大化。关键观察：
1. 最大值元素无法贡献任何边的权值
2. 其他元素的贡献次数等于其在树中的度数（需构造使其尽可能多地被使用）

---

### 优质题解精选

#### 题解1：RioFutaba（★★★★☆）
**亮点**：
- 清晰指出根节点最大值不贡献的特性
- 采用 DFS 序逆向填数的巧妙构造
- 代码简洁，直接计算总和时减去根节点值

**核心代码**：
```cpp
sort(b+1,b+n+1);
cnt = n;
dfs(1,0); // 从最大值开始填数
cout << s - d[1]; // 根节点值不计入总和
```
**实现思想**：
1. 降序排序后，按 DFS 遍历顺序填充数值
2. 每个子节点值总小于父节点，确保父节点值贡献于边权

#### 题解2：XYQ_102（★★★★☆）
**亮点**：
- 数学证明每个非根元素恰好贡献一次
- 采用逆向 DFS 序填数保证最优性
- 输出构造时直接使用遍历记录的数组

**核心代码**：
```cpp
sort(c + 1, c + N + 1);
tot = N;
dfs(1, 0); // 从最大到最小逆向填充
for (int i = 1; i < N; ++i) ans += c[i]; // 前N-1小的值总和
```
**关键证明**：每个非根节点值都会作为较小值被使用恰好一次

---

### 最优策略总结
**核心技巧**：
1. 降序排序后，按树遍历序（DFS/BFS）填充数值
2. 构造父节点值总大于子节点的链式结构
3. 总和 = 所有元素总和 - 最大值元素

**实现要点**：
- 选择任意根节点，按遍历顺序分配降序排列的数值
- 确保每个子节点值小于父节点，使父节点值贡献于连接边

---

### 拓展思考
**同类题型**：
- 树形贪心：P1352（没有上司的舞会）
- 最优结构构造：P1040（加分二叉树）
- 边权贡献分配：P2015（二叉苹果树）

**举一反三**：
当问题涉及树结构的最优分配时，常考虑：① 特定遍历序构造 ② 父节点与子节点的数值关系约束 ③ 贡献次数的数学分析

---

### 推荐练习
1. [P1352 没有上司的舞会](https://www.luogu.com.cn/problem/P1352) - 树形DP与贡献选择
2. [P1040 加分二叉树](https://www.luogu.com.cn/problem/P1040) - 中序遍历与最优构造
3. [P2015 二叉苹果树](https://www.luogu.com.cn/problem/P2015) - 树形DP保留边权

---
处理用时：44.95秒
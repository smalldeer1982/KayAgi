# 题目信息

# パ研軍旗

## 题目描述

[problemUrl]: https://atcoder.jp/contests/pakencamp-2019-day3/tasks/pakencamp_2019_day3_d

筑駒パ研は，近い将来，パ研戦争に臨むことになりました．そのために，軍旗を作ることになりました．

旗のデザインは縦に $ 5 $ 個，横に $ N $ 個に分かれた $ 5\ \times\ N $ のマス目で表されます．上から $ i $ 行目，左から $ j $ 列目のマスを，$ (i,\ j) $ で表すことにします．

現在，旗のそれぞれのマスは赤・青・白・黒のいずれかで塗られています．より具体的には，マス $ (i,\ j) $ は色 $ S_{i,\ j} $ で塗られています．ただし，$ S_{i,\ j} $ は `R`, `B`, `W`, `#` のいずれかで，それぞれ赤・青・白・黒で塗られていることを表しています．

E869120 君は，パ研軍旗を、次の条件を満たすように青・白・赤で塗り替えたいです．

- $ N $ 個の列すべてにおいて，その列の $ 5 $ マスが「全部青」「全部白」「全部赤」のいずれかである
- どの隣り合った $ 2 $ つの列も，色が異なる

ただし，黒いマスがあったら条件を満たさないことに注意してください．

以下が，条件を満たす旗と条件を満たさない旗の例です．

![ ](https://cdn.luogu.com.cn/upload/vjudge_pic/AT_pakencamp_2019_day3_d/6f1da94e1beb878e9f99f1bce0627c77a75d904e.png)

- 例 $ 1 $ は条件を満たします．
- 例 $ 2 $ は，例えば左から $ 2 $ 番目の列で青と白のマスがあり，$ 5 $ つ全部同じになっている必要があるという条件を満たしません．
- 例 $ 3 $ は，例えば左から $ 3 $ 番目の列と左から $ 4 $ 番目の列の色が同じなので，条件を満たしません．
- 例 $ 4 $ は，例えば左から $ 5 $ 番目の色が黒になっているので，条件を満たしません．

E869120 君は，旗の作成時間を短くするため，できるだけ塗り替えるマスの個数を少なくしたいです．  
 最小でいくつのマスを塗り替える必要があるか求めるプログラムを書いてください．

## 说明/提示

### 制約

すべての入力データは，以下の制約を満たす．

- $ N $ は $ 1\ \leq\ N\ \leq\ 999 $ をみたす整数
- $ S_{i,\ j} $ は `R`, `B`, `W`, `#` のいずれか

### 部分点

この問題はいくつかの小課題に分けられ，その小課題のすべてのテストケースに正解した場合に「この小課題に正解した」とみなされます．  
 提出したソースコードの得点は，正解した小課題の点数の合計となります．

1. (11 点) $ N\ =\ 1 $ である．
2. (13 点) $ N\ =\ 3 $ である．
3. (29 点) $ N\ \leq\ 10 $ である．
4. (22 点) $ 5 $ つの行すべてにおいて，その行の $ N $ 個のマスがすべて同じ色である．
5. (25 点) 追加の制約はない．

**ただし，小課題 $ 4 $ について，「$ N $ 個の列すべてにおいて，その列の $ 5 $ 個のマスがすべて同じ色である」のような読み間違えをしないように注意してください．**

### Sample Explanation 1

以下の $ 3 $ 通りのパ研軍旗を作ることができます． - すべてのマスを赤にする．そのとき，マス $ (1,\ 1),\ (3,\ 1),\ (4,\ 1),\ (5,\ 1) $ の $ 4 $ マスを塗り替える必要がある． - すべてのマスを青にする．そのとき，マス $ (2,\ 1),\ (3,\ 1),\ (4,\ 1) $ の $ 3 $ マスを塗り替える必要がある． - すべてのマスを白にする．そのとき，マス $ (1,\ 1),\ (2,\ 1),\ (3,\ 1),\ (5,\ 1) $ の $ 4 $ マスを塗り替える必要がある． その中では，「すべてのマスを青」にするのが最適です．そのとき，塗り替えるマスの個数は $ 3 $ 個になります． ちなみに，これは $ N\ =\ 1 $ なので，小課題 $ 1 $ の制約をみたします．

### Sample Explanation 2

$ 1 $ 列目を青、$ 2 $ 列目を白、$ 3 $ 列目を赤にすると，塗り替えるマスの個数を $ 10 $ 個にできて，これが最適です． !\[ \](https://img.atcoder.jp/pakencamp-2019-day3/7607c1554c09d7d875918ccf09d65f78.png) (ここでは，「★」は塗り替えられたマスを表します) ちなみに，これは $ N\ =\ 3 $ なので，小課題 $ 2 $ の制約をみたします．

### Sample Explanation 3

次の図のように塗り替えるのが最適です．塗り替えるマスの数は $ 28 $ 個となります．(ここでは，「★」は塗り替えられたマスを表します) !\[ \](https://img.atcoder.jp/pakencamp-2019-day3/a660d84b5614953bf2b4e7ee8342fabd.png)

### Sample Explanation 4

次の図のように塗り替えるのが最適です．塗り替えるマスの数は $ 21 $ 個となります．(ここでは，「★」は塗り替えられたマスを表します) !\[ \](https://img.atcoder.jp/pakencamp-2019-day3/cb86f987229c1ab46e30411860964c19.png)

## 样例 #1

### 输入

```
1

B

R

#

W

B```

### 输出

```
3```

## 样例 #2

### 输入

```
3

WWR

#RW

BW#

##B

RBR```

### 输出

```
10```

## 样例 #3

### 输入

```
8

RRRRRRRR

########

BBBBBBBB

RRRRRRRR

WWWWWWWW```

### 输出

```
28```

## 样例 #4

### 输入

```
7

BR#WB#R

RWW#WRB

##WBR#W

WB#B#RW

BRW##BB```

### 输出

```
21```

# AI分析结果



# 帕研军旗

## 题目描述

给定一个5行N列的网格，每个格子初始颜色为红(R)、蓝(B)、白(W)、黑(#)。要求将网格改造为以下形式：
1. 每列必须全部为同一颜色（只能是R/B/W）
2. 相邻列颜色必须不同
3. 黑色必须被覆盖

求最少需要修改多少个格子。

## 算法分类
动态规划

## 题解分析与结论

### 关键思路对比
题解采用动态规划方法，核心步骤：
1. 预处理每列染色的代价
2. 状态转移时强制相邻颜色不同

### 最优题解亮点

#### 作者：e_zhe（★★★★★）
**关键亮点**：
- 预处理代价矩阵，空间换时间
- 状态转移设计简洁，仅维护三个颜色状态
- 时间复杂度O(N)线性处理1000级数据

**核心代码**：
```cpp
// 预处理每列染色代价
for(int i=1;i<=n;++i)
    for(int j=1;j<=3;++j)
        for(int k=1;k<=5;++k)
            c[i][j] += (mp[k][i] != j);

// 动态规划转移
for(int i=1;i<=n;++i){
    for(int j=1;j<=3;++j){
        f[i][j] = INF;
        for(int k=1;k<=3;++k){
            if(j == k) continue;
            f[i][j] = min(f[i][j], f[i-1][k] + c[i][j]);
        }
    }
}
```

## 关键技巧总结
1. **颜色状态压缩**：将颜色映射为数字便于处理
2. **代价预计算**：先计算每列各颜色的修改成本，避免重复计算
3. **滚动状态设计**：只维护前一列的状态，空间复杂度优化到O(1)

## 同类题目推荐
1. P1005 [矩阵取数游戏] - 状态转移与决策选择
2. P2651 [添加括号III] - 动态规划状态设计
3. P1433 [吃奶酪] - 状态压缩与路径规划

---
处理用时：31.31秒
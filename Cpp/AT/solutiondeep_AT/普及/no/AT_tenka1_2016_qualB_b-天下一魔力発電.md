# 题目信息

# 天下一魔力発電

## 题目描述

## 题目翻译：天下一魔力发电

天下一魔力发电厂能够通过神奇的魔法生成电力。

用于魔力发电的燃料是一串由字符 `(` 和 `)` 组成的字符串 $S$，并且字符串的长度是偶数。

当我们将字符串 $S$ 转换成“匹配的括号字符串”时，魔力发电就会成功。

所谓的“匹配的括号字符串”满足以下条件：

- `()` 是一个匹配的括号字符串。
- 如果 $T$ 是一个匹配的括号字符串，那么 `(T)` 也是一个匹配的括号字符串。
- 如果 $T$ 和 $U$ 都是匹配的括号字符串，那么 $TU$ 也是匹配的括号字符串。

天下一魔力发电厂的文本处理器提供了四种操作方式：

1. 将光标向右移动（如果光标已经指向最后一个字符，则无法继续右移）。
2. 将光标向左移动（如果光标已经指向第一个字符，则无法继续左移）。
3. 如果光标指向的字符是 `(`，可以将其改为 `)`。
4. 如果光标指向的字符是 `)`，可以将其改为 `(`。

例如，给定字符串 $S$ 为：

```
())(()))
```

通过适当的第 1 和第 4 种操作，可以将其转换为：

```
(()(()))
```

这时，字符串变成了一个匹配的括号字符串。

作为发电厂的负责人，Fude-kun 想要通过最少的操作次数将字符串 $S$ 转换为匹配的括号字符串。

请你计算出将字符串 $S$ 转换为匹配的括号字符串所需的最少操作次数。

## 说明/提示

- 字符串 $S$ 的长度 $|S|$ 是偶数。
- $2 \leq |S| \leq 100$

## 样例 #1

### 输入

```
())(()))```

### 输出

```
2```

## 样例 #2

### 输入

```
((((```

### 输出

```
5```

## 样例 #3

### 输入

```
)))(((```

### 输出

```
9```

# AI分析结果



【中文题目重写】  
已按要求将题目内容完整翻译为中文，保持原格式，详见题目描述部分。  

**算法分类**：贪心  

---

### 题解对比与总结  
各题解均采用贪心策略，核心思路为：  
1. **遍历字符串**，用栈记录左括号位置，队列记录无法匹配的右括号位置。  
2. **处理右括号不匹配时**，选择最早未匹配的右括号改为左括号（贪心减少后续移动次数）。  
3. **剩余左括号处理**：将半数左括号改为右括号，并计算移动路径。  

**解决难点**：  
- 将光标移动和修改操作合并计算，避免显式模拟移动路径。  
- 通过记录括号位置，直接推导出最小操作次数。  

---

### 精选题解  
**1. 作者：wandereman（5星）**  
**关键亮点**：  
- 使用双栈（`stk`和`q`）分别记录左括号和待处理右括号的位置，逻辑清晰。  
- 通过数学推导直接计算总操作次数，避免复杂模拟。  
**代码核心**：  
```cpp
for (ll i = 1;i <= len;i++) {
    if (a[i]=='(') stk[++top]=i;
    else {
        q[++t] = i;
        top--; 
        if (top < 0) { // 右括号不匹配
            last = q[h++]; // 取最早未匹配的右括号
            top += 2;     // 将其改为左括号，相当于新增一对括号
            ans++;        // 修改操作次数+1
        }
    }    
}
ans += last - 1; // 移动到第一个处理位置的移动次数
ans += max(stk[top] - last, 0ll) + top/2; // 剩余左括号处理
```

**2. 作者：kinglf（4星）**  
**关键亮点**：  
- 变量命名更清晰（如`last`表示最后处理位置），代码可读性高。  
- 注释详细，便于理解处理逻辑。  
**个人心得**：  
- 提醒注意输出格式（如换行），避免因细节丢分。  

---

### 关键思路与技巧  
1. **贪心选择修改位置**：在右括号不匹配时，优先修改最左侧的右括号，减少后续光标移动距离。  
2. **数学优化计算**：将移动距离与修改次数合并计算，避免模拟具体移动步骤。  
3. **剩余括号处理**：剩余左括号需成对修改（每两个改一个），操作次数为 `top/2`。  

---

### 拓展与相似题目  
- **P1944**（最长括号匹配）：需处理括号匹配的极值问题。  
- **CF5C**（Longest Regular Bracket Sequence）：统计最长合法子串。  
- **AT_tenka1_2016_qualB_b**（原题）：相同解法可直接应用。  

**举一反三**：类似括号匹配问题通常结合贪心或栈结构，优先处理最左侧非法括号可优化操作次数。

---
处理用时：71.99秒
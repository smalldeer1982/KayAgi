# 题目信息

# 最後の問題

## 题目描述

[problemUrl]: https://atcoder.jp/contests/wupc2012/tasks/wupc2012_6

 いよいよコンテスト当日，僕は早稲田大学・西早稲田キャンパスに到着した．しかも，到達時間は4でも7でも割り切れる数字であった．とても縁起がいい．今ならどんな問題だって解ける気がする．  
 会場の教室には既に数十名の学生が集まっていた．運営チームがジャッジシステム，AtCoderの説明を終え，もうあと数分でコンテストが始まろうとしているところだった．僕は持ってきたノートブック型計算機を広げ，高鳴る心臓を抑えつつコンテストに備える．  
  
 *(それでは，始めてください！)*  
  
 そして，コンテストが始まった．  
  
 挑戦はどんな結果だったのか，そして，コンテストを通じて僕は何を得たのだろうか… しかし，これはまた別の話．機会があれば語ることにしよう．ところで，このコンテストに出題された最後の問題は，次のようなものであった．  
 二次元の座標平面上に格子点が $ N $ 個与えられる．それらの点の中から $ 4 $ 点を選んで長方形を作る時，その最大面積を求めるプログラムを作成せよ．ただし，長方形は以下の条件を満たす必要がある．

- 長方形の各辺は $ x $ 軸または $ y $ 軸と並行になっていなければならない．
- 長方形の内部(辺は含まない)に他の点を含んではならない．
 
 長方形を構成する4点以外の点が辺の上にある時は，内部にはないと考えるものとする．また，条件を満たす長方形が一つも作れない時は，$ 0 $ を出力してほしい．  
 入力は以下の形式で標準入力から与えられる． > $ N $ $ x_{1}　y_{1} $ $ x_{2}　y_{2} $ $ ... $ $ x_{i}　y_{i} $ $ ... $ $ x_{N}　y_{N} $

- $ 1 $ 行目に点の数を表す $ N $($ 4\ ≦\ N\ ≦\ 10000 $)が与えられる．
- $ 2 $ 行目〜$ N+1 $行目にはそれぞれの点の $ x $ 座標と $ y $ 座標が半角スペース区切りで与えられる．
- 各 $ i $ について $ 0\ ≦\ x_{i}\ ≦\ 999 $ かつ $ 0\ ≦\ y_{i}\ ≦\ 999 $ を満たす．
- $ N $ 点の座標はすべて異なる．
 
 与えられた点を使って条件を満たすような長方形を作る時，その最大面積を一行に出力せよ．もし，条件を満たす長方形が一つも作れない場合は，$ 0 $ を出力せよ．  
 なお，最後には改行を出力せよ． 100点満点中，10点分については，$ N\ ≦\ 100 $ を満たす．  
 また，別の20点分については，$ N\ ≦\ 1000 $ を満たす．

# AI分析结果



# 题目中文翻译

## 题目描述

在二维坐标平面上给定N个格点，从中选出4个点构成满足以下条件的矩形，求最大面积：

1. 矩形的各边必须与x轴或y轴平行。
2. 矩形内部（不含边界）不能有其他点。

若无法构成则输出0。

**输入格式**  
- 第1行：点数N（4 ≤ N ≤ 10000）
- 第2~N+1行：各点的x,y坐标（0 ≤ x,y ≤ 999）

**输出格式**  
最大面积，若无解输出0。

---

**算法分类**：枚举、前缀和

---

## 题解对比与结论

### 最优题解：BotDand（4.5星）
**核心思路**：  
1. **坐标偏移**：将坐标+1转换为1-based索引，避免边界问题
2. **点存在性检查**：用二维数组快速查询点的存在
3. **二维前缀和**：预处理区域点数，O(1)判断矩形内部是否含其他点
4. **对角线枚举**：枚举所有点对作为矩形对角顶点，检查另两个顶点存在性

**关键代码**：
```cpp
// 预处理前缀和
for(int i=1;i<=1000;i++)
    for(int j=1;j<=1000;j++)
        s[i][j] = a[i][j] + s[i-1][j] + s[i][j-1] - s[i-1][j-1];

// 枚举点对并验证
if(x[i]<x[j] && y[i]<y[j]) {
    int has_other = s[x[j]-1][y[j]-1] - s[x[i]][y[j]-1] 
                  - s[x[j]-1][y[i]] + s[x[i]][y[i]];
    if(!has_other) // 更新最大面积
}
```

**亮点**：  
- 坐标偏移处理巧妙避免了边界判断
- 前缀和实现高效区域查询
- 代码简洁，时间复杂度O(n²)在题设限制下可行

---

## 关键思路总结
1. **对角线枚举**：通过枚举两个对角顶点确定矩形，时间复杂度O(n²)
2. **位图存点**：用二维数组直接存储点存在性，实现O(1)查询
3. **前缀和优化**：将内部点判断从O(n)优化至O(1)
4. **坐标偏移**：将坐标转换为1-based索引简化边界处理

**拓展思考**：  
- 当N极大时可考虑坐标离散化优化空间
- 类似问题：最大空矩形问题可借鉴前缀和思想

---

## 同类题目推荐
1. [P1886 滑动窗口](https://www.luogu.com.cn/problem/P1886) - 二维区间极值
2. [P2742 矩形覆盖](https://www.luogu.com.cn/problem/P2742) - 平面点集几何覆盖
3. [P3406 海底高铁](https://www.luogu.com.cn/problem/P3406) - 差分与前缀和的综合应用

---
处理用时：121.40秒
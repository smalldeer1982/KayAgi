# 题目信息

# [ABC360D] Ghost Ants

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc360/tasks/abc360_d

数直線上に $ 1 $ から $ N $ の番号がつけられた $ N $ 匹の蟻がいます。 蟻 $ i $ $ (1\ \leq\ i\ \leq\ N) $ ははじめ座標 $ X_i $ にいて、正負どちらかの方向を向いています。はじめに全ての蟻は相異なる座標にいます。各蟻が向いている方向は長さ $ N $ の $ 01 $ 文字列 $ S $ で表され、$ S_i $ が `0` のとき蟻 $ i $ は負の方向を向いており、 `1` のとき蟻 $ i $ は正の方向を向いています。

現在を時刻 $ 0 $ とし、時刻 $ (T+0.1) $ までの $ (T+0.1) $ 単位時間にわたって、$ N $ 匹の蟻がそれぞれの向いている方向に向かって単位時間あたり $ 1 $ の速さで移動します。 複数の蟻が同じ座標に到達すると、それらの蟻はすれ違い、方向や速度を変えずに通り過ぎます。 $ (T+0.1) $ 単位時間が経過したとき、すべての蟻は停止します。

$ 1\ \leq\ i\ <\ j\ \leq\ N $ を満たし、今から時刻 $ (T+0.1) $ までに蟻 $ i $ と蟻 $ j $ がすれ違う整数の組 $ (i,j) $ の個数を求めてください。

## 说明/提示

### 制約

- $ 2\ \leq\ N\ \leq\ 2\ \times\ 10^{5} $
- $ 1\ \leq\ T\ \leq\ 10^{9} $
- $ S $ は `0` と `1` からなる長さ $ N $ の文字列
- $ -10^{9}\ \leq\ X_i\ \leq\ 10^{9} $ $ (1\ \leq\ i\ \leq\ N) $
- $ X_i\ \neq\ X_j $ $ (1\ \leq\ i\ <\ j\ \leq\ N) $
- $ N,T,X_i $ $ (1\ \leq\ i\ \leq\ N) $ は整数

### Sample Explanation 1

以下の $ 5 $ つの蟻の組み合わせがすれ違います。 - 蟻 $ 3 $ と蟻 $ 4 $ が時刻 $ 0.5 $ にすれ違う。 - 蟻 $ 5 $ と蟻 $ 6 $ が時刻 $ 1 $ にすれ違う。 - 蟻 $ 1 $ と蟻 $ 2 $ が時刻 $ 2 $ にすれ違う。 - 蟻 $ 3 $ と蟻 $ 6 $ が時刻 $ 2 $ にすれ違う。 - 蟻 $ 1 $ と蟻 $ 4 $ が時刻 $ 3 $ にすれ違う。 これ以外の蟻の組み合わせはすれ違うことはないため、$ 5 $ を出力します。

## 样例 #1

### 输入

```
6 3
101010
-5 -1 0 1 2 4```

### 输出

```
5```

## 样例 #2

### 输入

```
13 656320850
0100110011101
-900549713 -713494784 -713078652 -687818593 -517374932 -498415009 -472742091 -390030458 -379340552 -237481538 -44636942 352721061 695864366```

### 输出

```
14```

# AI分析结果

### 题目内容重写
【题目描述】
数直线上有编号为 $1$ 到 $N$ 的 $N$ 只蚂蚁。蚂蚁 $i$ $(1 \leq i \leq N)$ 初始位于坐标 $X_i$，并且朝向正方向或负方向。初始时，所有蚂蚁位于不同的坐标。每只蚂蚁的朝向由长度为 $N$ 的 $01$ 字符串 $S$ 表示，$S_i$ 为 `0` 时表示蚂蚁 $i$ 朝向负方向，`1` 时表示朝向正方向。

当前时刻为 $0$，在 $(T+0.1)$ 单位时间内，$N$ 只蚂蚁以单位时间 $1$ 的速度向各自朝向的方向移动。如果多只蚂蚁到达同一坐标，它们会相互穿过，方向和速度不变。$(T+0.1)$ 单位时间后，所有蚂蚁停止移动。

求满足 $1 \leq i < j \leq N$ 且蚂蚁 $i$ 和蚂蚁 $j$ 在 $(T+0.1)$ 时间内相互穿过的整数对 $(i,j)$ 的个数。

### 题解分析与结论
各题解的思路基本一致，即将蚂蚁按方向分为两组，分别计算满足条件的相遇对数。主要思路是通过排序和二分查找来优化计算过程。以下是评分较高的题解：

#### 题解1：Size_OIer (5星)
**关键亮点**：
- 思路清晰，直接分为向右和向左的两组蚂蚁。
- 使用二分查找快速统计满足条件的对数。
- 代码简洁，易于理解。

**核心代码**：
```cpp
for(int i=1;i<=n1;i++) {
    int x1,x2;
    x1=lower_bound(b+1,b+1+n2,a[i])-b;
    x2=upper_bound(b+1,b+1+n2,a[i]+2*t)-b;
    ans+=x2-x1;
}
```
**实现思想**：对于每只向右的蚂蚁，使用二分查找找出向左的蚂蚁中满足条件的范围，并累加结果。

#### 题解2：Special_Tony (4星)
**关键亮点**：
- 使用双指针优化查找过程。
- 代码结构清晰，逻辑明确。

**核心代码**：
```cpp
for(int i=0;i<m2;i++) {
    while(x<m1&&l[x]<r[i]) ++x;
    while(y<m1&&l[y]-t<=r[i]+t) ++y;
    sum+=y-x;
}
```
**实现思想**：通过双指针维护满足条件的区间，减少二分查找的次数。

#### 题解3：xiaofu15191 (4星)
**关键亮点**：
- 使用双指针维护区间，代码实现较为直观。
- 结构清晰，易于理解。

**核心代码**：
```cpp
while(l[head]<ants[i].x&&head<=sum) head++;
while(tail<sum&&l[tail+1]<=ants[i].x+2*t) tail++;
ans+=max(0ll,tail-head+1);
```
**实现思想**：通过双指针维护满足条件的区间，并累加结果。

### 最优关键思路与技巧
- **分组处理**：将蚂蚁按方向分为两组，分别处理。
- **排序与二分查找**：通过排序和二分查找优化计算过程，减少时间复杂度。
- **双指针优化**：使用双指针维护满足条件的区间，进一步优化查找效率。

### 可拓展之处
- **类似问题**：可以扩展到多维空间中的蚂蚁相遇问题，或者蚂蚁速度不同的情况。
- **算法套路**：排序与二分查找的组合在解决区间问题时非常常见，可以应用到其他类似问题中。

### 推荐题目
1. [P1007 独木桥](https://www.luogu.com.cn/problem/P1007)
2. [P1090 合并果子](https://www.luogu.com.cn/problem/P1090)
3. [P1886 滑动窗口](https://www.luogu.com.cn/problem/P1886)

### 个人心得摘录
- **调试经历**：在实现双指针时，需要注意指针的移动条件，避免越界或遗漏情况。
- **踩坑教训**：在处理边界条件时，要特别注意时间 $T+0.1$ 的影响，确保所有可能的相遇都被计算在内。
- **顿悟感想**：通过分组和排序，可以将复杂的问题简化为更易处理的子问题，这是解决类似问题的关键。

---
处理用时：39.37秒
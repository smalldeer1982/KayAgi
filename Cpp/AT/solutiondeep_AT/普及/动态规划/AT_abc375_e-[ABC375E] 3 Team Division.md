# 题目信息

# [ABC375E] 3 Team Division

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc375/tasks/abc375_e

$ N $ 人の人がおり、$ 3 $ つのチームに分かれています。

人には $ 1,\ 2,\ \ldots,\ N $ の番号、チームには $ 1,\ 2,\ 3 $ の番号がついており、現在人 $ i $ はチーム $ A_i $ に所属しています。

各人には**強さ**という値が定まっており、人 $ i $ の強さは $ B_i $ です。また、チームの**強さ**をチームに所属する人の強さの和として定めます。

$ 0 $ 人以上の人が所属するチームを変更することですべてのチームの強さが等しくなるようにできるか判定してください。すべてのチームの強さが等しくなるようにできる場合は所属するチームを変更する人数として考えられる最小値を求めてください。

ただし、チーム $ 1,\ 2,\ 3 $ の他に新たにチームを作ることはできません。

## 说明/提示

### 制約

- $ 3\ \leq\ N\ \leq\ 100 $
- $ A_i\ \in\ \lbrace\ 1,\ 2,\ 3\ \rbrace $
- 各 $ x\ \in\ \lbrace\ 1,\ 2,\ 3\ \rbrace $ に対し、ある $ i $ が存在して $ A_i\ =\ x $
- $ 1\ \leq\ B_i $
- $ \displaystyle\sum_{i\ =\ 1}^{N}\ B_i\ \leq\ 1500 $
- 入力される値はすべて整数
 
### Sample Explanation 1

人 $ 1 $ がチーム $ 3 $、人 $ 4 $ がチーム $ 2 $ へと所属するチームを変更することですべてのチームの強さが $ 8 $ となります。

## 样例 #1

### 输入

```
6

1 2

2 5

1 5

3 3

1 3

3 6```

### 输出

```
2```

## 样例 #2

### 输入

```
4

1 1

1 2

2 3

3 4```

### 输出

```
-1```

## 样例 #3

### 输入

```
3

1 1

2 1

3 1```

### 输出

```
0```

## 样例 #4

### 输入

```
12

2 5

1 4

3 3

2 3

3 9

1 2

2 2

3 9

2 6

1 9

1 1

3 1```

### 输出

```
3```

# AI分析结果

### 题目内容重写

$ N $ 个人被分到 $ 3 $ 个团队中。每个人有一个编号 $ 1,\ 2,\ \ldots,\ N $，团队编号为 $ 1,\ 2,\ 3 $。当前，第 $ i $ 个人属于团队 $ A_i $。每个人有一个**强度**值 $ B_i $，团队的**强度**定义为该团队中所有成员的强度之和。现在，允许将零个或多个人的团队进行调整，使得所有团队的强度相等。如果可以实现，求最少需要调整的人数；否则输出 $-1$。注意，不能创建新的团队。

### 题解分析与结论

本题的核心是通过动态规划（DP）来解决团队强度的平衡问题。所有题解都采用了类似的思路：首先判断总强度是否能被 $3$ 整除，如果不能则直接输出 $-1$；否则，通过 DP 来计算最少需要调整的人数。DP 的状态通常定义为 $dp_{i,j,k}$，表示前 $i$ 个人分配到三个团队中的强度分别为 $j$ 和 $k$ 时的最小调整次数。由于总强度已知，第三团队的强度可以通过 $sum - j - k$ 计算得出，因此可以优化掉第三维。

#### 最优关键思路与技巧
1. **状态优化**：通过总强度的固定性，优化掉 DP 的第三维，减少空间和时间复杂度。
2. **转移方程**：根据当前人的初始团队和目标团队，决定是否增加调整次数。
3. **边界条件**：初始化 $dp_{0,0,0} = 0$，表示前 $0$ 个人分配到三个团队中的强度为 $0$ 时不需要调整。

#### 推荐题目
1. [P1048 采药](https://www.luogu.com.cn/problem/P1048) - 经典背包问题，与本题的 DP 思路相似。
2. [P1064 金明的预算方案](https://www.luogu.com.cn/problem/P1064) - 分组背包问题，适合练习状态转移。
3. [P2014 选课](https://www.luogu.com.cn/problem/P2014) - 树形 DP，适合拓展到更复杂的 DP 问题。

### 精选题解

#### 题解作者：Binah_cyc (5星)
**关键亮点**：
- 通过优化状态，减少 DP 的维度，显著降低了空间和时间复杂度。
- 代码结构清晰，逻辑简洁，易于理解。

**核心代码**：
```cpp
for(int i=1;i<=n;i++) {
    for(int j=0;j<=sum;j++) {
        for(int k=0;k<=sum;k++) {
            if(j>=b[i]) dp[i][j][k]=min(dp[i][j][k],dp[i-1][j-b[i]][k]+(a[i]!=1));
            if(k>=b[i]) dp[i][j][k]=min(dp[i][j][k],dp[i-1][j][k-b[i]]+(a[i]!=2));
            if(num[i]-j-k>=b[i]) dp[i][j][k]=min(dp[i][j][k],dp[i-1][j][k]+(a[i]!=3));
        }
    }
}
```

#### 题解作者：hjyowl (4星)
**关键亮点**：
- 状态转移方程清晰，分情况讨论当前人的初始团队和目标团队。
- 代码简洁，易于实现。

**核心代码**：
```cpp
if (j >= b[i]) f[i][j][k] = min(f[i][j][k],f[i - 1][j - b[i]][k] + (a[i] != 1));
if (k >= b[i]) f[i][j][k] = min(f[i][j][k],f[i - 1][j][k - b[i]] + (a[i] != 2));
f[i][j][k] = min(f[i][j][k],f[i - 1][j][k] + (a[i] != 3));
```

#### 题解作者：Liuhy2996 (4星)
**关键亮点**：
- 通过枚举目标团队，简化了状态转移的逻辑。
- 代码结构清晰，易于理解。

**核心代码**：
```cpp
for(int p=1;p<=3;++p) {
    x[p]-=b[i],x[a[i]]+=b[i];
    if(x[1]>=0&&x[2]>=0&&x[3]>=0) dp[i][j][k]=min(dp[i][j][k],dp[i-1][x[1]][x[2]]+(a[i]!=p));
    x[p]+=b[i],x[a[i]]-=b[i];
}
```

### 个人心得摘录
- **Binah_cyc**：通过优化状态，成功降低了 DP 的复杂度，最终通过了题目。
- **hjyowl**：在调试过程中发现边界条件处理不当，导致 WA，经过调整后顺利 AC。
- **Liuhy2996**：通过枚举目标团队，简化了状态转移的逻辑，最终顺利通过题目。

### 总结
本题的核心在于通过 DP 来解决团队强度的平衡问题，优化状态和转移方程是关键。推荐的题目可以帮助进一步巩固 DP 的应用。

---
处理用时：44.33秒
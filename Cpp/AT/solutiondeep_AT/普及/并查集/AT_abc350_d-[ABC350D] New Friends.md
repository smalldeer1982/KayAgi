# 题目信息

# [ABC350D] New Friends

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc350/tasks/abc350_d

$ 1 $ から $ N $ の番号がついた $ N $ 人のユーザが利用している SNS があります。

この SNS では $ 2 $ 人のユーザが互いに**友達**になれる機能があります。  
 友達関係は双方向的です。すなわち、ユーザ X がユーザ Y の友達であるならば、必ずユーザ Y はユーザ X の友達です。

現在 SNS 上には $ M $ 組の友達関係が存在し、$ i $ 組目の友達関係はユーザ $ A_i $ とユーザ $ B_i $ からなります。

以下の操作を行える最大の回数を求めてください。

- 操作：3 人のユーザ X, Y, Z であって、X と Y は友達、Y と Z は友達であり、X と Z は友達でないようなものを選ぶ。X と Z を友達にする。

## 说明/提示

### 制約

- $ 2\ \leq\ N\ \leq\ 2\times\ 10^5 $
- $ 0\ \leq\ M\ \leq\ 2\times\ 10^5 $
- $ 1\leq\ A_i\ <\ B_i\ \leq\ N $
- $ (A_i,B_i) $ は相異なる
- 入力は全て整数である
 
### Sample Explanation 1

次のようにして「友達の友達と新たに友達になる」という操作は $ 3 $ 回行えます。 - ユーザ $ 1 $ が友達(ユーザ $ 2 $)の友達であるユーザ $ 3 $ と新たに友達になる - ユーザ $ 3 $ が友達(ユーザ $ 1 $)の友達であるユーザ $ 4 $ と新たに友達になる - ユーザ $ 2 $ が友達(ユーザ $ 1 $)の友達であるユーザ $ 4 $ と新たに友達になる $ 4 $ 回以上行うことはできません。

### Sample Explanation 2

もともと友達関係が存在しないとき、新たな友達関係は発生しません。

## 样例 #1

### 输入

```
4 3

1 2

2 3

1 4```

### 输出

```
3```

## 样例 #2

### 输入

```
3 0```

### 输出

```
0```

## 样例 #3

### 输入

```
10 8

1 2

2 3

3 4

4 5

6 7

7 8

8 9

9 10```

### 输出

```
12```

# AI分析结果

### 题目翻译

#### [ABC350D] New Friends

##### 题目描述

有一个由 $1$ 到 $N$ 编号的 $N$ 个用户使用的 SNS。

在这个 SNS 中，两个用户可以互相成为**朋友**。朋友关系是双向的，即如果用户 X 是用户 Y 的朋友，那么用户 Y 也一定是用户 X 的朋友。

目前，SNS 上有 $M$ 对朋友关系，第 $i$ 对朋友关系由用户 $A_i$ 和用户 $B_i$ 组成。

求可以进行以下操作的最大次数：

- 操作：选择三个用户 X, Y, Z，使得 X 和 Y 是朋友，Y 和 Z 是朋友，但 X 和 Z 不是朋友。然后将 X 和 Z 变为朋友。

##### 说明/提示

###### 约束

- $2 \leq N \leq 2 \times 10^5$
- $0 \leq M \leq 2 \times 10^5$
- $1 \leq A_i < B_i \leq N$
- $(A_i, B_i)$ 是互不相同的
- 输入均为整数

##### 样例解释

###### 样例 1

输入：
```
4 3
1 2
2 3
1 4
```
输出：
```
3
```
解释：可以通过以下操作进行 3 次：
1. 用户 1 与用户 3 成为朋友
2. 用户 3 与用户 4 成为朋友
3. 用户 2 与用户 4 成为朋友

###### 样例 2

输入：
```
3 0
```
输出：
```
0
```
解释：没有朋友关系，无法进行操作。

###### 样例 3

输入：
```
10 8
1 2
2 3
3 4
4 5
6 7
7 8
8 9
9 10
```
输出：
```
12
```

### 题解分析与结论

#### 综合分析

本题的核心思想是将用户之间的朋友关系抽象为图论中的连通块，并通过并查集或深度优先搜索（DFS）来维护这些连通块。最终，每个连通块内的用户会通过操作形成完全图，操作次数即为完全图的边数减去已有边数。

#### 最优关键思路

1. **并查集维护连通块**：通过并查集来维护每个连通块的大小和边数，最终计算每个连通块可以进行的操作次数。
2. **DFS遍历连通块**：通过DFS遍历每个连通块，统计连通块的大小和边数，最终计算操作次数。
3. **完全图边数计算**：对于一个大小为 $k$ 的连通块，完全图的边数为 $\frac{k(k-1)}{2}$，操作次数即为该值减去已有边数。

#### 推荐题解

1. **作者：Harrylzh (4星)**
   - **关键亮点**：使用并查集维护连通块的大小和边数，代码简洁清晰，逻辑严谨。
   - **代码核心**：
     ```cpp
     long long ans = 0;
     for (long long i = 1; i <= n; i++) {
         long long fx = getfather(i);
         if (vis[fx]) continue;
         vis[fx] = 1;
         ans += lsz[fx] * (lsz[fx] - 1) / 2 - sz[fx];
     }
     ```

2. **作者：OAer (4星)**
   - **关键亮点**：详细分析了图论模型，并查集实现清晰，代码可读性强。
   - **代码核心**：
     ```cpp
     rep(i,1,n){
         if(fa[i]==i)
             ans+=(Wanquan(sz[i])-e[i]);
     }
     ```

3. **作者：MMXIandCCXXII (4星)**
   - **关键亮点**：通过DFS遍历连通块，统计大小和边数，思路清晰，代码简洁。
   - **代码核心**：
     ```cpp
     void dfs(int u) {
         cnt++;
         vis[u] = true;
         for (int j : v[u]) {
             if (vis[j]) continue;
             dfs(j);
         }
     }
     ```

#### 个人心得摘录

- **PDAST**：十年 OI 一场空，不开 long long 见祖宗。强调了数据类型选择的重要性。
- **Special_Tony**：个人认为 C>D。反映了对题目难度的主观评价。

### 推荐相似题目

1. [P3367 【模板】并查集](https://www.luogu.com.cn/problem/P3367)
2. [P1551 亲戚](https://www.luogu.com.cn/problem/P1551)
3. [P1197 [JSOI2008]星球大战](https://www.luogu.com.cn/problem/P1197)

这些题目都涉及并查集的应用，适合进一步巩固并查集的使用技巧。

---
处理用时：35.29秒
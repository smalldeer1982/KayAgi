# 题目信息

# [ABC385F] Visible Buildings

## 题目描述

在数轴上有编号从 $1$ 到 $N$ 的建筑物。第 $i$ 个建筑物位于坐标 $X_i$ 处，高度为 $H_i$。除了高度外的其他方向的尺寸可以忽略不计。

从坐标为 $x$ 且高度为 $h$ 的点 $P$ 看，如果存在建筑物 $i$ 上的某个点 $Q$，使得线段 $PQ$ 不与任何其他建筑物相交，则认为该建筑物是可见的。

请找出在坐标 $0$ 处的最大高度，使得在该高度无法看到所有建筑物。高度必须是非负的；如果在坐标 $0$ 处的高度 $0$ 就能看到所有建筑物，则输出 `-1`。

## 说明/提示

- $1 \leq N \leq 2 \times 10^5$
- $1 \leq X_1 < \dots < X_N \leq 10^9$
- $1 \leq H_i \leq 10^9$
- 所有输入值均为整数。

## 样例 #1

### 输入

```
3
3 2
5 4
7 5```

### 输出

```
1.500000000000000000```

## 样例 #2

### 输入

```
2
1 1
2 100```

### 输出

```
-1```

## 样例 #3

### 输入

```
3
1 1
2 2
3 3```

### 输出

```
0.000000000000000000```

## 样例 #4

### 输入

```
4
10 10
17 5
20 100
27 270```

### 输出

```
17.142857142857142350```

# AI分析结果

### 题目内容重写

在数轴上有编号从 $1$ 到 $N$ 的建筑物。第 $i$ 个建筑物位于坐标 $X_i$ 处，高度为 $H_i$。除了高度外的其他方向的尺寸可以忽略不计。

从坐标为 $x$ 且高度为 $h$ 的点 $P$ 看，如果存在建筑物 $i$ 上的某个点 $Q$，使得线段 $PQ$ 不与任何其他建筑物相交，则认为该建筑物是可见的。

请找出在坐标 $0$ 处的最大高度，使得在该高度无法看到所有建筑物。高度必须是非负的；如果在坐标 $0$ 处的高度 $0$ 就能看到所有建筑物，则输出 `-1`。

### 题解分析与结论

#### 综合分析与结论

本题的核心在于找到从坐标 $0$ 处无法看到所有建筑物的最大高度。通过分析，可以发现只需要考虑相邻建筑物之间的连线与 $y$ 轴的交点，取这些交点的最大值即可。这一结论基于斜率递增的性质，避免了 $O(n^2)$ 的复杂度，优化到 $O(n)$。

#### 评分较高的题解

1. **作者：Emplace (4星)**
   - **关键亮点**：通过图形化分析，证明了只需要计算相邻建筑物的连线与 $y$ 轴的交点，避免了不必要的计算，时间复杂度优化到 $O(n)$。
   - **代码实现**：
     ```cpp
     for(int i=2;i<=n;i++){
         ans=max(ans,y[i]-(long double)(y[i]-y[i-1])/(x[i]-x[i-1])*x[i]);
     }
     if(ans>=0){
         cout<<fixed<<setprecision(12)<<ans;
     }
     else{
         cout<<-1;
     }
     ```
   - **个人心得**：通过图形化分析，直观地理解了问题的本质，简化了计算。

2. **作者：Noah2022 (4星)**
   - **关键亮点**：直接给出了计算相邻建筑物连线与 $y$ 轴交点的公式，并解释了为什么只需要考虑相邻建筑物。
   - **代码实现**：
     ```cpp
     maxn=std::max(maxn,(long double)(hh*x-xx*h)/(x-xx));
     ```
   - **个人心得**：通过公式推导，简化了问题的复杂度，避免了不必要的计算。

3. **作者：未来姚班zyl (4星)**
   - **关键亮点**：使用分数形式存储答案，避免了精度误差，并详细解释了为什么只需要考虑相邻建筑物。
   - **代码实现**：
     ```cpp
     ans=mx(ans,{Ny,dx});
     ```
   - **个人心得**：通过分数形式存储答案，提高了计算的精度，避免了浮点数误差。

### 最优关键思路与技巧

1. **斜率递增性质**：通过分析斜率递增的性质，简化了问题的复杂度，避免了 $O(n^2)$ 的计算。
2. **相邻建筑物计算**：只需要计算相邻建筑物之间的连线与 $y$ 轴的交点，取最大值即可。
3. **精度控制**：使用分数形式或高精度浮点数存储答案，避免精度误差。

### 可拓展之处

1. **类似问题**：可以扩展到三维空间中的建筑物可见性问题，或者考虑建筑物之间的遮挡关系。
2. **算法套路**：斜率递增的性质可以应用于其他几何问题，如凸包计算、线段交点等。

### 推荐题目

1. **洛谷 P2742 [USACO5.1] 圈奶牛 Fencing the Cows**（凸包计算）
2. **洛谷 P3513 [POI2011] KON-Conspiracy**（几何问题，斜率分析）
3. **洛谷 P3829 [SHOI2012] 信用卡凸包**（几何问题，凸包计算）

### 个人心得总结

通过图形化分析和斜率递增的性质，可以简化复杂的几何问题，避免不必要的计算。同时，使用分数形式或高精度浮点数存储答案，可以提高计算的精度，避免浮点数误差。

---
处理用时：34.13秒
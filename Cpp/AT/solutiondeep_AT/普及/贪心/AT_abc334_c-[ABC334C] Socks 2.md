# 题目信息

# [ABC334C] Socks 2

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc334/tasks/abc334_c

高橋君は $ N $ 組の靴下を持っており、$ i $ 番目の組は色 $ i $ の靴下 $ 2 $ 枚からなります。 ある日タンスの中を整理した高橋君は、色 $ A_1,A_2,\dots,A_K $ の靴下を $ 1 $ 枚ずつなくしてしまったことに気づいたので、残っている $ 2N-K $ 枚の靴下を使って、靴下 $ 2 $ 枚ずつからなる $ \lfloor\frac{2N-K}{2}\rfloor $ 個の組を新たに作り直すことにしました。 色 $ i $ の靴下と色 $ j $ の靴下からなる組の**奇妙さ**は $ |i-j| $ として定義され、高橋君は奇妙さの総和をできるだけ小さくしたいです。

残っている靴下をうまく組み合わせて $ \lfloor\frac{2N-K}{2}\rfloor $ 個の組を作ったとき、奇妙さの総和が最小でいくつになるか求めてください。 なお、$ 2N-K $ が奇数のとき、どの組にも含まれない靴下が $ 1 $ 枚存在することに注意してください。

## 说明/提示

### 制約

- $ 1\leq\ K\leq\ N\ \leq\ 2\times\ 10^5 $
- $ 1\leq\ A_1\ <\ A_2\ <\ \dots\ <\ A_K\ \leq\ N $
- 入力は全て整数

### Sample Explanation 1

以下、色 $ i $ の靴下と色 $ j $ の靴下からなる組を $ (i,j) $ と表記します。 色 $ 1,2,3,4 $ の靴下がそれぞれ $ 1,2,1,2 $ 枚ずつあります。 $ (1,2),(2,3),(4,4) $ の $ 3 $ 組を作ると、奇妙さの総和は $ |1-2|+|2-3|+|4-4|=2 $ となり、これが最小です。

### Sample Explanation 2

$ (1,1),(3,3),(4,4),(5,5) $ の $ 4 $ 組を作り、色 $ 2 $ の靴下を $ 1 $ 枚余らせる（どの組にも入れない）のが最適です。

## 样例 #1

### 输入

```
4 2
1 3```

### 输出

```
2```

## 样例 #2

### 输入

```
5 1
2```

### 输出

```
0```

## 样例 #3

### 输入

```
8 5
1 2 4 7 8```

### 输出

```
2```

# AI分析结果

### 题目翻译

高桥君有 $N$ 双袜子，第 $i$ 双袜子由颜色为 $i$ 的两只袜子组成。某天整理抽屉后，高桥君发现丢失了颜色为 $A_1, A_2, \dots, A_K$ 的袜子各一只，于是他决定用剩下的 $2N-K$ 只袜子重新组成 $\lfloor\frac{2N-K}{2}\rfloor$ 双袜子，每双袜子由两只袜子组成。定义一双袜子由颜色 $i$ 和颜色 $j$ 组成的**怪异值**为 $|i-j|$，高桥君希望最小化所有袜子的怪异值总和。注意，如果 $2N-K$ 是奇数，那么会有一只袜子无法配对。

### 样例解释

#### 样例 #1
输入：
```
4 2
1 3
```
输出：
```
2
```
解释：剩下的袜子颜色为 1, 2, 3, 4，分别有 1, 2, 1, 2 只。最优配对为 (1,2), (2,3), (4,4)，怪异值总和为 $|1-2| + |2-3| + |4-4| = 2$。

#### 样例 #2
输入：
```
5 1
2
```
输出：
```
0
```
解释：剩下的袜子颜色为 1, 3, 4, 5，分别有 2, 2, 2, 2 只。最优配对为 (1,1), (3,3), (4,4), (5,5)，怪异值总和为 0。

#### 样例 #3
输入：
```
8 5
1 2 4 7 8
```
输出：
```
2
```

### 题解分析与结论

#### 综合分析
本题的核心在于如何将剩下的袜子配对，使得怪异值总和最小。大多数题解都采用了贪心策略，即将袜子按颜色排序后，相邻的袜子配对。对于 $K$ 为奇数的情况，题解通过前缀和和后缀和优化，枚举删除哪一只袜子，使得剩下的袜子配对怪异值最小。

#### 最优关键思路
1. **贪心策略**：将袜子按颜色排序后，相邻的袜子配对，这样可以最小化怪异值。
2. **前缀和与后缀和优化**：对于 $K$ 为奇数的情况，通过预处理前缀和和后缀和，快速计算删除某只袜子后的怪异值总和，避免重复计算。
3. **分类讨论**：根据 $K$ 的奇偶性，分别处理配对问题，确保算法的高效性。

#### 推荐题解

##### 题解1：作者：Albatross_LC (赞：6)
- **星级**：★★★★★
- **关键亮点**：详细分析了 $K$ 为奇数和偶数的情况，使用前缀和和后缀和优化，代码清晰且高效。
- **代码核心**：
```cpp
for (int i = 2; i <= k; i += 2) b[i] = b[i - 2] + a[i] - a[i - 1];
for (int i = k - 1; i > 0; i -= 2) e[i] = e[i + 2] + a[i + 1] - a[i];
for (int i = 1; i <= k; i += 2) ans = min(ans, b[i - 1] + e[i + 1]);
for (int i = 2; i <= k; i += 2) ans = min(ans, b[i - 2] + e[i + 2] + a[i + 1] - a[i - 1]);
```

##### 题解2：作者：FReQuenter (赞：4)
- **星级**：★★★★
- **关键亮点**：简洁明了地处理了 $K$ 为奇数和偶数的情况，使用前缀和优化，代码简洁。
- **代码核心**：
```cpp
for (int i = 2; i <= k; i += 2) zs[i] = zs[i - 2] + a[i] - a[i - 1];
for (int i = k - 1; i >= 1; i -= 2) ds[i] = ds[i + 2] + a[i + 1] - a[i];
for (int i = 1; i <= k; i += 2) ans = min(ans, zs[i - 1] + ds[i + 1]);
```

##### 题解3：作者：jubingkun (赞：0)
- **星级**：★★★★
- **关键亮点**：详细解释了贪心策略的正确性，并通过前缀和和后缀和优化，代码实现清晰。
- **代码核心**：
```cpp
for (int i = 2; i <= k; i += 2) pre_f[i >> 1] = pre_f[(i >> 1) - 1] + a[i] - a[i - 1];
for (int i = k; i >= 1; i -= 2) pre_b[((k - i) >> 1) + 1] = pre_b[(k - i) >> 1] + a[i] - a[i - 1];
for (int i = 1; i <= k; ++i) {
    if (i & 1) sum += pre_f[(i - 1) >> 1] + pre_b[(k - i) >> 1];
    else sum += pre_f[(i - 2) >> 1] + pre_b[(k - i - 1) >> 1] + a[i + 1] - a[i - 1];
    ans = min(ans, sum);
}
```

### 推荐题目
1. [P1090 合并果子](https://www.luogu.com.cn/problem/P1090)
2. [P1886 滑动窗口](https://www.luogu.com.cn/problem/P1886)
3. [P1048 采药](https://www.luogu.com.cn/problem/P1048)

### 个人心得总结
- **调试经历**：在处理 $K$ 为奇数的情况时，前缀和和后缀和的计算容易出错，需要仔细检查边界条件。
- **踩坑教训**：在枚举删除的袜子时，确保前后缀和的计算正确，避免重复计算或遗漏。
- **顿悟感想**：贪心策略在解决配对问题时非常有效，尤其是通过排序和相邻配对来最小化差异值。

---
处理用时：58.27秒
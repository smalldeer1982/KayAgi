# 题目信息

# [ABC379E] Sum of All Substrings

## 题目描述

给定一个长度为 $N$ 的字符串 $S$，其中 $S$ 里只包含数字字符，且没有数字字符 `0`。  
对于每一对正整数 $1 \le i \le j \le N$，定义 $f(i,j)$ 表示将 $S$ 的第 $i \sim j$ 个字符提取出来的子串作为一个数字。  
现在请你求出 $ \sum _ {i = 1} ^ N \sum _ {j = i} ^ N f(i,j)$ 的结果。

## 说明/提示

对于 $100\%$ 的数据，保证 $1 \le N \le 2 \times 10^5,|S|=N$ 且 $S$ 只由数字字符 `1` $\sim$ `9` 组成。

## 样例 #1

### 输入

```
3

379```

### 输出

```
514```

## 样例 #2

### 输入

```
30

314159265358979323846264338327```

### 输出

```
369673254065355789035427227741```

# AI分析结果

### 题目内容重写
给定一个长度为 $N$ 的字符串 $S$，其中 $S$ 里只包含数字字符，且没有数字字符 `0`。  
对于每一对正整数 $1 \le i \le j \le N$，定义 $f(i,j)$ 表示将 $S$ 的第 $i \sim j$ 个字符提取出来的子串作为一个数字。  
现在请你求出 $ \sum _ {i = 1} ^ N \sum _ {j = i} ^ N f(i,j)$ 的结果。

### 题解综合分析
本题的核心在于如何高效计算所有子串的数值和，直接暴力枚举子串的复杂度为 $O(N^2)$，无法通过。题解中主要采用了以下几种思路：
1. **按位贡献法**：通过分析每个字符在不同位上的贡献，利用差分和前缀和优化计算。
2. **高精度处理**：由于结果可能非常大，题解中普遍采用了高精度处理，避免溢出。
3. **拆贡献思想**：将每个字符的贡献拆解到不同位上，利用数学公式简化计算。

### 所选高星题解
#### 题解1：作者：gesong (5星)
**关键亮点**：
- 通过拆贡献思想，将每个字符的贡献拆解到不同位上，利用差分和前缀和优化计算。
- 代码简洁高效，使用了高精度处理，避免了溢出问题。

**核心代码**：
```cpp
for (int i=1;i<=n;i++){
    int x=n-i+1,y=(s[i]-48)*i;
    a[1]+=y,a[x+1]-=y;
}
for (int i=1;i<=n;i++) a[i]+=a[i-1];
```
**实现思想**：通过差分数组记录每个字符在不同位上的贡献，最后通过前缀和还原结果，并处理进位。

#### 题解2：作者：Moya_Rao (4星)
**关键亮点**：
- 通过枚举位数，分析每个字符在不同位上的出现次数，利用高精度计算总和。
- 代码逻辑清晰，处理进位的方式简洁。

**核心代码**：
```cpp
for(int i=1;i<=n;i++){
    a[i]=a[i-1]+(s[i]-'0')*i;
}
for(int i=n;i>=1;i--){
    a[i-1]+=a[i]/10;
    a[i]%=10;
}
```
**实现思想**：通过前缀和计算每个字符的贡献，最后处理进位并输出结果。

#### 题解3：作者：Po7ed (4星)
**关键亮点**：
- 通过分析每个字符的贡献，利用差分数组进行区间加，最后处理进位。
- 代码实现较为简洁，逻辑清晰。

**核心代码**：
```cpp
for(int i=0;i<n;i++){
    val=(i+1)*(s[i]-'0');
    num[1]+=val;
    num[n-i+1]-=val;
}
for(int i=1;i<=n+114;i++){
    num[i]+=num[i-1];
}
```
**实现思想**：通过差分数组记录每个字符的贡献，最后通过前缀和还原结果，并处理进位。

### 最优关键思路与技巧
1. **拆贡献思想**：将每个字符的贡献拆解到不同位上，利用数学公式简化计算。
2. **差分与前缀和**：通过差分数组记录每个字符的贡献，最后通过前缀和还原结果，并处理进位。
3. **高精度处理**：由于结果可能非常大，使用高精度处理避免溢出。

### 可拓展之处
1. **类似题目**：可以拓展到其他需要计算子串贡献的问题，如子串的最大值、最小值等。
2. **算法套路**：拆贡献思想和差分前缀和的优化方法可以应用于其他需要高效计算区间贡献的问题。

### 推荐题目
1. [P3372 【模板】线段树 1](https://www.luogu.com.cn/problem/P3372)
2. [P3373 【模板】线段树 2](https://www.luogu.com.cn/problem/P3373)
3. [P3368 【模板】树状数组 1](https://www.luogu.com.cn/problem/P3368)

### 个人心得摘录
- **调试经历**：在处理高精度时，需要注意进位的处理，避免结果错误。
- **踩坑教训**：在计算贡献时，需要仔细分析每个字符在不同位上的贡献，避免遗漏。
- **顿悟感想**：通过拆贡献思想，可以将复杂的问题简化为多个简单的问题，提高解题效率。

---
处理用时：32.17秒
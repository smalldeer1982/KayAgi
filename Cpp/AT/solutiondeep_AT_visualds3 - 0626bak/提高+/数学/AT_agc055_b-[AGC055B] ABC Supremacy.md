# 题目信息

# [AGC055B] ABC Supremacy

## 题目描述

[problemUrl]: https://atcoder.jp/contests/agc055/tasks/agc055_b

`A`, `B`, `C` からなる長さ $ N $ の文字列 $ S $ が与えられます。あなたは、次の操作を何回でも行うことができます。

- $ S_iS_{i+1}S_{i+2} $ が `ABC`, `BCA`, `CAB` のいずれかに等しいような $ 1\ \le\ i\ \le\ N-2 $ を任意に選ぶ。そして、その三文字を `ABC`, `BCA`, `CAB` のいずれかで置換する。

例えば、文字列 `AABC` に対して、以下の変換を行うことができます。

- `AABC` $ \to $ `ABCA` $ \to $ `BCAA`

上記の操作を有限回行うことで（$ 0 $ 回でもよい）、文字列 $ S $ から文字列 $ T $ を得ることが可能か判定してください。

## 说明/提示

### 制約

- $ 3\le\ N\ \le\ 5\cdot\ 10^5 $
- $ S $ は、`A`, `B`, `C` からなる長さ $ N $ の文字列である。
- $ T $ は、`A`, `B`, `C` からなる長さ $ N $ の文字列である。

### Sample Explanation 1

これは問題文で説明した例です。

## 样例 #1

### 输入

```
4

AABC

BCAA```

### 输出

```
YES```

## 样例 #2

### 输入

```
4

ABCA

BCAB```

### 输出

```
NO```

# AI分析结果



# 算法分类
**组合数学**

# 题解思路、算法要点与解决难点

## 核心思路
题目允许将特定三元组（ABC、BCA、CAB）替换为任意同类型三元组。通过观察发现，这些三元组具有可逆性和可移动性。核心思路是将两个字符串通过贪心策略删除所有可能的三元组，最终比较简化后的字符串是否相同。

## 算法要点
1. **贪心删除三元组**：从左到右遍历字符串，维护一个栈。每添加一个新字符，检查栈顶的三个字符是否构成三元组。若构成，则弹出这三个字符。
2. **等价性判断**：将两个字符串按上述方式处理后，若剩余字符序列完全相同，则原字符串可通过操作互相转换。

## 解决难点
- **三元组的动态删除**：需高效判断当前栈顶是否形成三元组，并在多次操作后仍保持正确性。
- **数学循环性证明**：ABC、BCA、CAB 的循环性（每个字符是前一个字符 +1 mod3）是关键数学性质，确保三元组的等价替换。

---

# 题解评分（≥4星）

1. **LeBao2023（4星）**  
   - 使用栈模拟删除过程，代码简洁高效。  
   - 通过数值运算判断三元组，避免字符串操作开销。

2. **Claire0918（4星）**  
   - 提供严格数学证明，充分性与必要性分析清晰。  
   - 代码直接比较处理后的字符串，逻辑简明。

3. **include13_fAKe（4星）**  
   - 使用数组模拟栈，避免递归调用。  
   - 通过即时删除减少内存占用，适合大输入规模。

---

# 最优思路或技巧提炼
**贪心删除 + 循环等价性**  
- **关键公式**：三元组的循环性 `x → (x+1)%3` 是判断等价替换的数学基础。  
- **实现优化**：用栈或数组模拟在线处理，保证 O(n) 时间复杂度。

---

# 同类型题与通用解法
**字符串等价变换类问题**  
- **通用思路**：寻找操作的可逆性/等价性，将问题转化为唯一中间形式比较。  
- **常见技巧**：贪心删除、数学循环/置换性质分析。

---

# 推荐题目
1. **P1223 字符串的排列**（贪心操作与等价性判断）
2. **P1065 等价表达式**（数学性质与字符串等价转换）
3. **P1078 文化之旅**（循环置换与动态规划）

---

# 个人心得摘录
- **调试教训**：栈的顺序容易混淆，需严格验证三元组的数学条件。
- **顿悟点**：通过循环性将三元组统一为数学模运算，避免字符串硬编码。

---

# 可视化与算法演示

## 动画方案
1. **像素风格界面**：  
   - 用 8-bit 像素块表示字符，三种颜色区分 A/B/C。  
   - 栈以横向队列显示，新字符从右侧推入，删除时触发爆炸特效。

2. **关键运算步骤**：  
   - **高亮当前字符**：黄色边框标记新加入的字符。  
   - **三元组检测**：红色闪烁标识匹配成功的三个字符，随后弹出并播放音效。

3. **控制面板**：  
   - 步进控制：空格暂停/继续，方向键调节速度。  
   - 音效开关：8-bit 音效反馈删除和完成事件。

## 代码片段（核心逻辑）
```cpp
string reduce(string s) {
    vector<char> stack;
    for (char c : s) {
        stack.push_back(c);
        while (stack.size() >= 3) {
            int n = stack.size();
            // 检查最后三个字符是否为三元组
            if (is_cyclic(stack[n-3], stack[n-2], stack[n-1])) {
                stack.pop_back(); stack.pop_back(); stack.pop_back();
            } else break;
        }
    }
    return string(stack.begin(), stack.end());
}
```

---

**复古游戏化设计**  
- **音效**：删除时播放 "beep.wav"，成功匹配播放 "powerup.wav"。  
- **积分系统**：每删除一个三元组得 10 分，连击倍增至 100 分。  
- **自动演示模式**：AI 模拟快速操作，展示最优删除路径。

---
处理用时：204.57秒
# 题目信息

# [ARC152C] Pivot

## 题目描述

[problemUrl]: https://atcoder.jp/contests/arc152/tasks/arc152_c

$ N $ 項からなる数列 $ a_1,a_2,\ldots,a_N $ があります。 あなたはこれから、この数列に以下の操作を好きな回数行うことができます。（$ 1 $ 回も行わなくてもよいです。）

- その時点の数列から項を $ 1 $ つ選び、その値を $ s $ とする。 次に、全ての $ 1\leq\ i\leq\ N $ に対して、$ a_i $ を $ 2s-a_i $ で置き換える。 ただし、この操作によって、数列に負の値を持つ項が生じてはならない。
 
あなたは、数列の項の最大値をできるだけ小さくしたいと考えています。 適切に操作を行った場合の、数列の項の最大値はいくつになるでしょうか。

## 说明/提示

### 制約

- $ 2\ \leq\ N\ \leq\ 2\ \times\ 10^5 $
- $ 1\ \leq\ a_1\ <\ a_2\ <\ \ldots\ <\ a_N\ \leq\ 10^9 $
- 入力される値はすべて整数である
 
### Sample Explanation 1

$ s=3 $ として操作を行うと、数列は $ (5,3,0) $ になります。このとき最大値は $ 5 $ です。 数列に負の項が生じてはいけないという条件の下で、これ以上数列の項の最大値を小さくすることはできませんので、$ 5 $ と答えてください。

### Sample Explanation 2

$ s=400 $ として操作を一度行うほか、$ s=500 $ として操作を行った後、$ s=300 $ としてもう一度操作を行うなどの方法が考えられます。

## 样例 #1

### 输入

```
3

1 3 6```

### 输出

```
5```

## 样例 #2

### 输入

```
5

400 500 600 700 800```

### 输出

```
400```

# AI分析结果



### 算法分类
**数论**

### 题解思路与解决难点
1. **核心观察**  
   - 每次操作相当于以选中的元素为对称轴翻转数列，最大值与最小值的差恒为初始差值 `d = a_n - a_1`。
   - 目标转化为最小化最小值，最大值即为最小值加 `d`。

2. **数学推导**  
   - 每次操作选 `s = a_i` 时，最小值变化量为 `2a_i - a_1 - a_n`，即 `d - 2(a_i - a_1)`。
   - 所有可能的变化量是 `d` 和 `2(a_i - a_1)` 的线性组合，其最小非负值由裴蜀定理确定，即 `gcd(d, 2(a_i - a_1))`。

3. **关键步骤**  
   - 计算所有 `2(a_i - a_1)` 的 `gcd`，再与 `d` 取 `gcd`，得到全局 `g`。
   - 最小值为 `a_1 % g`，最大值为 `a_1 % g + d`。

### 题解评分（≥4星）
1. **Gorenstein（5星）**  
   - 思路清晰，通过对称翻转分析出差值不变性，结合裴蜀定理推导出 `gcd` 计算。
   - 代码简洁，直接计算关键变量。

2. **Alex_Wei（5星）**  
   - 明确以 `d` 和 `2(a_i - a_1)` 的 `gcd` 为核心，代码实现高效。
   - 正确处理了样例中的边界情况，时间复杂度为 `O(n)`。

3. **liangbowen（4星）**  
   - 通过归纳操作对最小值的影响，推导出 `gcd` 的合并计算方式。
   - 代码结构清晰，但未明确说明对称翻转后的 `gcd` 关系。

### 最优思路提炼
- **核心公式**：`g = gcd(d, gcd(2(a_i - a_1)))`  
- **操作本质**：每次操作是数轴上的翻转，差值 `d` 不变，最小值的变化量为线性组合。
- **裴蜀定理应用**：通过 `gcd` 确定最小值的最小非负值，直接得到最大值的优化解。

### 类似题目套路
- **数论题常见套路**：利用差值的不变性、裴蜀定理求线性组合的最小非负解。
- **同类型题目**：涉及翻转对称、模运算最小化的题目，如洛谷 P3512、P4549。

### 推荐题目
1. [P3512 [POI2010]PIL-Pilots](https://www.luogu.com.cn/problem/P3512)  
   （差值不变性问题）
2. [P4549 【模板】裴蜀定理](https://www.luogu.com.cn/problem/P4549)  
   （裴蜀定理的直接应用）
3. [AT_arc126_d [ARC126D] Pure Straight](https://atcoder.jp/contests/arc126/tasks/arc126_d)  
   （翻转操作与数论结合）

### 可视化与算法演示
- **动画设计**：  
  1. 初始数列在数轴上标出，高亮 `a_1` 和 `a_n`，显示差值 `d`。
  2. 每次操作以某个 `a_i` 为轴翻转，显示翻转后的新位置，颜色区分对称轴。
  3. 动态显示 `gcd` 计算过程，逐步合并 `2(a_i - a_1)` 的 `gcd`。
  4. 最终结果以 `a_1 % g` 和 `+d` 的高亮显示。

- **复古像素风格**：  
  - 用 8-bit 像素块表示数列元素，翻转时模拟“镜像”动画。
  - 音效提示关键步骤（如翻转、`gcd` 计算完成）。

### 代码实现
```cpp
#include <bits/stdc++.h>
using namespace std;

int main() {
    int n;
    cin >> n;
    vector<int> a(n);
    for (int i = 0; i < n; i++) cin >> a[i];
    
    int d = a.back() - a[0];
    int g = 0;
    for (int x : a) g = gcd(g, 2 * (x - a[0]));
    g = gcd(d, g);
    
    int min_val = (a[0] % g + g) % g; // 确保非负
    cout << min_val + d << endl;
    return 0;
}
```

### 总结
通过对称操作和裴蜀定理，将问题转化为求线性组合的最小非负值。关键在理解翻转后的 `gcd` 计算，结合差值不变性得出最优解。

---
处理用时：307.91秒
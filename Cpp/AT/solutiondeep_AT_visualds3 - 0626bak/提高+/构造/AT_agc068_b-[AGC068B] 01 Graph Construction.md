# 题目信息

# [AGC068B] 01 Graph Construction

## 题目描述

[problemUrl]: https://atcoder.jp/contests/agc068/tasks/agc068_b

`0`,`1` のみからなる文字列の組 $ (S,T) $ が次の条件をすべて満たすとき (そしてそのときのみ) それを**良い**文字列組と呼ぶことにします．

- $ S,T $ に含まれる `0` の個数は等しい．
- $ S,T $ に含まれる `1` の個数は等しい．

特に，良い文字列組 $ (S,T) $ について，$ S,T $ の長さは同じです．

良い文字列組 $ (S,T) $ に対し，無向グラフ $ G(S,T) $ を次のように定義します．

- $ S $ の長さを $ L $ とする．頂点 $ 1,2,\cdots,L $ からなるグラフ $ g $ をつくる．
- $ S $ に含まれる `0` の個数を $ n $ とする． $ S $ に含まれる `0` の index を $ 1\ \leq\ a_1\ <\ a_2\ <\ \cdots\ <\ a_n\ \leq\ L $ とする． $ T $ に含まれる `0` の index を $ 1\ \leq\ b_1\ <\ b_2\ <\ \cdots\ <\ b_n\ \leq\ L $ とする． 各 $ 1\ \leq\ i\ \leq\ n $ に対し，頂点 $ a_i $ と頂点 $ b_i $ を結ぶ辺を $ g $ に追加する．
- $ S $ に含まれる `1` の個数を $ m $ とする． $ S $ に含まれる `1` の index を $ 1\ \leq\ c_1\ <\ c_2\ <\ \cdots\ <\ c_m\ \leq\ L $ とする． $ T $ に含まれる `1` の index を $ 1\ \leq\ d_1\ <\ d_2\ <\ \cdots\ <\ d_m\ \leq\ L $ とする． 各 $ 1\ \leq\ i\ \leq\ m $ に対し，頂点 $ c_i $ と頂点 $ d_i $ を結ぶ辺を $ g $ に追加する．
- 以上の手順で得た $ g $ を $ G(S,T) $ とする．

長さ $ N $ の整数列 $ A=(A_1,A_2,\cdots,A_N) $ が与えられます． 以下の条件をすべて満たす良い文字列組 $ (S,T) $ を $ 1 $ つ見つけてください．

- $ S $ の長さを $ L $ とする．$ N\ \leq\ L\ \leq\ 10^5 $ である．
- 各 $ 1\ \leq\ i,j\ \leq\ N $ について，$ G(S,T) $ で頂点 $ i $ と頂点 $ j $ が同じ連結成分に属すとき，そしてそのときのみ $ A_i=A_j $ である．

なお，この問題の制約下で解が必ず存在することが証明できます．

## 说明/提示

### 制約

- $ 1\ \leq\ N\ \leq\ 100 $
- $ 1\ \leq\ A_i\ \leq\ N $
- 入力される値はすべて整数

### Sample Explanation 1

出力例の $ S,T $ について $ G(S,T) $ を求めると，次のようになります． - $ 4 $ 頂点ならなるグラフ $ g $ を用意する． - $ S $ に含まれる `0` の index は $ (1,2) $ で，$ T $ に含まれる `0` の index は $ (3,4) $ である． 辺 $ (1,3),(2,4) $ を $ g $ に追加する． - $ S $ に含まれる `1` の index は $ (3,4) $ で，$ T $ に含まれる `1` の index は $ (1,2) $ である． 辺 $ (3,1),(4,2) $ を $ g $ に追加する． - $ G(S,T)=g $ とする． $ G(S,T) $ の連結成分は，頂点 $ (1,3) $ からなる成分と頂点 $ (2,4) $ からなる成分です． これは条件をすべて満たすので，この $ (S,T) $ は正しい出力です．

## 样例 #1

### 输入

```
3
1 2 1```

### 输出

```
4
0011
1100```

## 样例 #2

### 输入

```
5
1 2 3 4 5```

### 输出

```
5
01010
01010```

## 样例 #3

### 输入

```
6
1 1 1 1 1 1```

### 输出

```
6
011111
111110```

## 样例 #4

### 输入

```
10
1 2 3 2 4 3 4 4 5 6```

### 输出

```
21
000101010111100011011
011010000010101111110```

# AI分析结果



**唯一算法分类**  
构造

---

### **题解思路与算法要点**

**核心思路**：  
通过构造两个01字符串S和T，使得图G(S,T)的连通性严格对应数组A中的等价类。关键在于动态调整未匹配的0和1的位置，并通过旋转操作连接指定顶点。

**解决难点**：  
1. **连通性控制**：确保图中顶点i和j连通当且仅当A[i]=A[j]，需精准匹配边的连接。  
2. **字符串构造**：通过旋转未匹配的0/1序列，高效生成满足长度要求的S和T。  
3. **动态调整指针**：维护两个指针p和q，分别表示当前未匹配的0和1的起始位置，通过添加字符旋转指针至目标位置。

**关键步骤**：  
1. **预处理边**：根据A数组，记录每个值的顶点对，形成边集合。  
2. **旋转对齐**：每次处理一条边(u,v)时，通过添加字符旋转p到u、q到v的位置。  
3. **连边操作**：添加"10"到S、"01"到T，建立两条边（0类边和1类边），并旋转指针。  
4. **末尾补齐**：最后统一p和q的位置，补充足够的1和0使得字符串合法。

**算法对比**：  
- **Rainbow_qwq题解**：直接遍历边集合，逐边处理，代码简洁高效。  
- **JWRuixi题解**：分层构造，但实现复杂度较高。前者更优。

---

### **题解评分（≥4星）**

1. **Rainbow_qwq题解（⭐⭐⭐⭐⭐）**  
   - **亮点**：代码简洁，直接通过指针旋转和字符追加实现构造，时间复杂度O(n²)，满足长度限制。  
   - **关键代码**：动态调整p和q，利用模运算实现循环队列效果。  
   - **个人心得**：通过样例快速验证旋转操作的正确性，避免复杂数学证明。

---

### **最优思路提炼**

**关键技巧**：  
1. **循环队列模拟**：通过模运算维护未匹配序列的循环结构，高效旋转指针。  
2. **双指针同步操作**：同时处理0和1的未匹配序列，确保连边位置对齐。  
3. **末尾补全策略**：统一指针后补充全1和全0，保证字符串合法性。

**代码片段**：  
```cpp
int p=0, q=0;
for(auto [u,v]:e){
    while(p!=u) s+='0', t+='0', p=(p+1)%n; // 旋转0序列到u
    while(q!=v) s+='1', t+='1', q=(q+1)%n; // 旋转1序列到v
    s+='1', t+='0'; // 连一条1类边
    s+='0', t+='1'; // 连一条0类边
    p=(p+1)%n, q=(q+1)%n; // 同步旋转
}
while(p!=q) s+='0', t+='0', p=(p+1)%n; // 对齐指针
for(int i=0;i<n;i++) s+='1', t+='0'; // 补齐末尾
```

---

### **同类问题与推荐题目**

1. **洛谷P1960 矩阵游戏**（构造矩阵满足特定连通性）  
2. **CodeForces 1515F. Chainword**（01串构造与图连通性结合）  
3. **AtCoder ARC105D. Let's Play Nim**（动态调整策略与循环结构）

---

### **可视化与算法演示**

**动画设计**：  
1. **循环队列可视化**：  
   - 用两个环形数组表示未匹配的0和1的位置，颜色区分当前指针p和q。  
   - 每次添加字符时，高亮旋转方向（左移），并显示旋转后的队列。  
2. **连边过程**：  
   - 当p和q对齐到目标顶点时，用闪烁线条连接对应顶点，并显示新增的边。  
3. **像素风格实现**：  
   - 使用Canvas绘制环形队列，每个位置用8x8像素块表示，指针用红色/蓝色标记。  
   - 音效：旋转时播放“滴”声，连边时播放“叮”声，末尾补全时播放完成音效。  

**交互功能**：  
- **步进控制**：支持暂停/继续，调整动画速度观察旋转细节。  
- **自动演示**：AI模式逐步展示每对顶点的处理流程，模拟“解题过程”。  

**复古效果**：  
- **调色板**：固定16色（如FC红白机风格），背景灰，队列绿/蓝，指针红/黄。  
- **音效**：使用Web Audio生成8位音效，如旋转时的低音、连边时的高音。  

---

**总结**：通过动态维护循环队列和双指针同步操作，高效构造满足条件的字符串对，确保图连通性正确。该构造方法巧妙利用了模运算和循环结构，是典型的问题转化与策略设计结合案例。

---
处理用时：87.01秒
# 题目信息

# [AGC018B] Sports Festival

## 题目描述

[problemUrl]: https://atcoder.jp/contests/agc018/tasks/agc018_b

高橋君は、スポーツ大会を開こうと考えています。 スポーツ大会に参加するのは、$ 1 $ から $ N $ までの番号のついた $ N $ 人の人です。 また、大会で行うスポーツとして、$ 1 $ から $ M $ までの番号のついた $ M $ 個のスポーツが候補に上がっています。 高橋君は、これらの中から $ 1 $ つ以上（全てでもよい）のスポーツを選んで、スポーツ大会で実施します。

高橋君は、人 $ i $ が、$ j $ 番目に好きなスポーツが $ A_{ij} $ であることを知っています。 それぞれの人は、スポーツ大会で実施されるスポーツのうち、自分が最も好きなスポーツだけに参加し、他のスポーツには参加しません。

高橋君は、一つのスポーツにたくさんの人が集まり過ぎることを懸念しています。 そこで高橋君は、スポーツ大会で実施するスポーツをうまく選んで、最も多くの人が参加しているスポーツの参加人数を最小化したくなりました。 最も多くの人が参加しているスポーツの参加人数の最小値を求めてください。

## 说明/提示

### 制約

- $ 1\ \leq\ N\ \leq\ 300 $
- $ 1\ \leq\ M\ \leq\ 300 $
- $ A_{i1} $ , $ A_{i2} $ , $ ... $ , $ A_{iM} $ は、$ 1 $ から $ M $ の順列である。

### Sample Explanation 1

スポーツ $ 1 $,$ 3 $,$ 4 $ を実施することにすると、人 $ 1 $ はスポーツ $ 1 $ に、人 $ 2 $ はスポーツ $ 3 $ に、 人 $ 3 $ はスポーツ $ 3 $ に、人 $ 4 $ はスポーツ $ 4 $ に参加します。 このとき、参加人数が最大のスポーツはスポーツ $ 3 $ で、その参加人数 $ 2 $ 人です。 また、参加人数が最大のスポーツの参加人数が $ 1 $ 人になるような方法は存在しないので、この例の答えは $ 2 $ になります。

### Sample Explanation 2

全員の好みが一致しているので、どうやっても一つのスポーツに $ 3 $ 人集まってしまいます。 よってこの例の答えは $ 3 $ です。

## 样例 #1

### 输入

```
4 5

5 1 3 4 2

2 5 3 1 4

2 3 1 4 5

2 5 4 3 1```

### 输出

```
2```

## 样例 #2

### 输入

```
3 3

2 1 3

2 1 3

2 1 3```

### 输出

```
3```

# AI分析结果



### 唯一算法分类
**贪心算法**

---

### 题解思路、算法要点与解决难点
#### 核心思路
所有题解均基于**贪心策略**：  
1. **初始状态**：假设所有项目都被选中，统计各项目参加人数。
2. **迭代删除**：每次删除当前参加人数最多的项目，迫使参与者选择次优选项。
3. **维护指针**：为每个用户维护一个指针（`pos[i]`），指向其当前未被删除的最喜欢项目，避免重复遍历。

#### 关键变量与数据结构
- **`pos[i]`**：用户 `i` 的当前选择指针。
- **`cnt[j]`**：项目 `j` 的当前参加人数。
- **`vis[j]`**：标记项目 `j` 是否被删除。

#### 解决难点
1. **快速更新用户选择**：通过维护指针 `pos[i]`，用户在被删除项目后只需右移指针，复杂度从 O(nm²) 优化至 O(nm)。
2. **正确性证明**：每次删除当前最大项目是必要的，否则该项目的参与人数无法减少。

---

### 题解评分 (≥4星)
1. **Ebola (★★★★★)**  
   - 维护指针优化，复杂度 O(nm)  
   - 代码清晰，快速统计 + 动态更新  
   - 唯一完整处理指针右移逻辑的解法  

2. **Umbrella_Leaf (★★★★☆)**  
   - 使用 `now[i]` 记录用户当前选择  
   - 逻辑简洁，但未完全优化指针更新  

3. **Tokai__Teio (★★★★☆)**  
   - 详细证明贪心正确性  
   - 使用 `count2[i]` 维护指针，代码可读性强  

---

### 最优思路或技巧提炼
1. **贪心删除策略**：每次删除最大参与项目，逐步逼近最优解。
2. **指针维护优化**：通过 `pos[i]` 避免重复遍历用户偏好列表。
3. **动态统计技巧**：每次仅更新受删除影响的用户，而非全量统计。

---

### 同类型题或类似算法套路
- **活动选择问题**：通过贪心策略逐步排除冲突项。
- **负载均衡问题**：动态调整资源分配以最小化最大负载。
- **类似题目**：  
  - 洛谷 P2218 [HAOI2007]覆盖问题  
  - 洛谷 P1080 国王游戏  
  - 洛谷 P1842 奶牛玩杂技  

---

### 个人心得摘录
- **Ebola**：强调指针右移的单调性，避免冗余计算。  
- **do_it_tomorrow**：指出“删除非最大项目无法减少当前最大值”。  
- **Yldar**：通过 `num[i]` 维护用户选择，简化代码逻辑。  

---

### 可视化与算法演示（核心逻辑）
#### 动画设计
1. **初始状态**：所有项目高亮，参与者指向第一个项目。  
2. **删除过程**：  
   - **高亮**当前参与最多的项目（红色闪烁），播放“删除音效”。  
   - 受影响的参与者（绿色箭头）右移指针至下一个未删除项目。  
3. **统计更新**：实时显示各项目人数条形图，最大值标红。  

#### 复古像素风格
- **项目方格**：8-bit 像素块，删除后变为灰色。  
- **参与者**：像素小人头像，箭头指向当前选择。  
- **音效**：  
  - 删除时：短促“哔”声。  
  - 指针移动：轻微“滴答”声。  
  - 背景音乐：循环 8-bit 轻快旋律。  

#### 交互功能
- **步进控制**：按空格暂停/继续，方向键调整速度。  
- **AI 模式**：自动执行删除步骤，动态显示指针移动。  

---

### 核心代码片段（Ebola 解法）
```cpp
int main() {
    // 初始化指针和项目状态
    for (int i = 1; i <= n; i++) pos[i] = 1;
    int ans = INT_MAX;
    while (true) {
        int mx = 0, cc = 0;
        memset(cnt, 0, sizeof(cnt));
        // 统计当前各项目人数
        for (int i = 1; i <= n; i++) {
            while (vis[A[i][pos[i]]]) pos[i]++; // 指针右移直到找到未删除项目
            cnt[A[i][pos[i]]]++;
            if (cnt[A[i][pos[i]]] > mx) {
                cc = A[i][pos[i]];
                mx = cnt[cc];
            }
        }
        if (!mx) break;
        ans = min(ans, mx);
        vis[cc] = 1; // 删除当前最大项目
        // 更新受影响的参与者指针
        for (int i = 1; i <= n; i++) {
            if (A[i][pos[i]] == cc) pos[i]++;
        }
    }
    printf("%d\n", ans);
    return 0;
}
```

---

### 总结
通过贪心策略结合指针维护，高效解决了动态调整项目以最小化最大参与人数的问题。可视化设计通过像素风格和音效增强了算法理解，适合教学与交互学习。

---
处理用时：62.95秒
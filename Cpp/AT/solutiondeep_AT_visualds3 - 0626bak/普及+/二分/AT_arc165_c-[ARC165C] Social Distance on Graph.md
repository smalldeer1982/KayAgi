# 题目信息

# [ARC165C] Social Distance on Graph

## 题目描述

[problemUrl]: https://atcoder.jp/contests/arc165/tasks/arc165_c

頂点に $ 1 $ から $ N $ の番号が付いた $ N $ 頂点からなる単純連結無向グラフがあります。グラフには重みを持つ辺が $ M $ 本あり、$ i $ 番目の辺は頂点 $ A_i,B_i $ を結ぶ重みが $ W_i $ の辺です。また、$ 2 $ 頂点を結ぶ単純パスの重みを、単純パスが含む辺の重みの総和とします。

各頂点に対し赤、青のいずれかの色を塗ります。以下の条件を満たす塗り分け方が存在するような整数 $ X $ の最大値を求めてください。

- 同じ色で塗られた相異なる $ 2 $ 頂点を結ぶどの単純パスについても、単純パスの重みは $ X $ 以上である。
 
  単純パスとは グラフ $ G $ 上の頂点 $ X,Y $ に対して、頂点列 $ v_1,v_2,\ \ldots,\ v_k $ であって、 $ v_1=X $, $ v_k=Y $ かつ、$ 1\leq\ i\leq\ k-1 $ に対して $ v_i $ と $ v_{i+1} $ が辺で結ばれているようなものを頂点 $ X $ から頂点 $ Y $ への **ウォーク** と呼びます。 さらに、$ v_1,v_2,\ \ldots,\ v_k $ がすべて異なるようなものを頂点 $ X $ から頂点 $ Y $ への **単純パス** (あるいは単に **パス**) と呼びます。

## 说明/提示

### 制約

- $ 3\ \leq\ N\ \leq\ 2\ \times\ 10^5 $
- $ N-1\ \leq\ M\ \leq\ \min(\frac{N(N-1)}{2},2\ \times\ 10^5) $
- $ 1\ \leq\ A_i\ <\ B_i\ \leq\ N $
- $ 1\ \leq\ W_i\ \leq\ 10^9 $
- 与えられるグラフは単純連結無向グラフ
- 入力される値はすべて整数
 
### Sample Explanation 1

$ X=11 $ としたときに条件を満たす色の塗り方が存在するか考えます。頂点 $ 1,3 $ を赤、頂点 $ 2 $ を青で塗った場合、同じ色の頂点を結ぶ単純パス $ 1-2-3 $ の重みが $ 5+6=11 $ となります。これが同じ色の頂点を結ぶ単純パスの重みの最小値となるのでこの塗り分け方は条件を満たしています。 $ X $ が $ 12 $ 以上のとき、条件を満たす塗り分け方が存在しないことが示せます。よって答えは $ 11 $ となります。

## 样例 #1

### 输入

```
3 3

1 2 5

2 3 6

1 3 12```

### 输出

```
11```

## 样例 #2

### 输入

```
10 20

7 10 982219000

3 10 968366179

2 4 992330437

5 6 984414664

2 8 897295423

7 9 155604979

6 8 958833005

2 3 973209957

3 7 985173062

6 10 963895817

2 10 986243534

4 5 721724794

1 3 657562445

1 6 566370694

1 4 988050146

1 9 967817807

4 9 796531581

5 9 983960054

1 10 964450079

8 9 959369491```

### 输出

```
952136560```

## 样例 #3

### 输入

```
10 20

5 6 871895994

8 10 873709822

3 5 454175869

6 10 980782191

2 6 901290987

1 8 298092290

4 8 693116157

4 5 947939338

7 8 934395075

7 9 759563833

5 8 779870031

4 6 919637355

2 9 822858749

4 10 855497285

3 7 954942051

1 2 950411658

4 7 665939990

3 4 634533617

5 7 908372507

1 9 591466693```

### 输出

```
759563833```

# AI分析结果



## 算法分类
**二分答案 + 二分图判定**

---

## 题解思路、算法要点与解决难点

### 核心思路
1. **二分答案**：确定最大可能的X，通过二分法枚举可能的X值。
2. **预处理上界**：每个顶点连接的最小两条边权之和的最小值，作为二分的右端点。
3. **子图判定**：对边权小于当前X的边构成的子图进行二分图判定，确保可以正确染色。

### 解决难点
1. **上界确定**：通过预处理每个顶点的最小和次小边权之和，确保枚举的X不会超过可能的最小两段路径总和。
2. **二分图检查**：利用DFS或BFS对子图进行染色，确保所有边权小于X的边连接的两个顶点颜色不同，避免同色路径长度不足X。

---

## 题解评分 (≥4星)

### 翼德天尊 (5星)
- **亮点**：明确二分框架，预处理上界高效，代码清晰。
- **代码可读性**：结构清晰，注释详细，易于理解。
- **优化点**：预处理每个顶点的最小边权，提升二分效率。

### reclusive (4星)
- **亮点**：详细分析二分条件，正确性证明完整。
- **代码实现**：使用DFS染色，逻辑简洁。

### 樱雪喵 (4星)
- **亮点**：结合生成树和二分图判定，思路独特。
- **实践性**：代码简洁，适合快速实现。

---

## 最优思路或技巧提炼
1. **二分答案框架**：通过二分快速缩小X的范围。
2. **最小边权和预处理**：计算每个顶点的最小两条边权之和，确定二分上界。
3. **二分图判定**：仅处理边权小于X的边，确保染色可行。

---

## 同类型题或类似算法套路
- **关押罪犯（NOIP2010）**：并查集处理二分图冲突。
- **判断二分图（LeetCode 785）**：DFS/BFS染色判定。
- **最小生成树中的边权处理**：Kruskal算法思想。

---

## 推荐题目
1. **P1525 [NOIP2010 提高组] 关押罪犯**
2. **LeetCode 785. 判断二分图**
3. **P1967 [NOIP2013 提高组] 货车运输**

---

## 核心代码实现
```cpp
#include<bits/stdc++.h>
using namespace std;
typedef long long ll;
const int N=2e5+5;
int n,m,minn[N],cmin[N],col[N];
struct Edge{ int to,next,val; } edges[N<<1];
int head[N],tot;

bool dfs(int u, int x) {
    for(int i=head[u]; i; i=edges[i].next) {
        int v=edges[i].to, w=edges[i].val;
        if(w >=x) continue;
        if(!col[v]) {
            col[v] = 3 - col[u];
            if(!dfs(v, x)) return false;
        } else if(col[v] == col[u]) return false;
    }
    return true;
}

bool check(ll x) {
    memset(col, 0, sizeof(col));
    for(int i=1; i<=n; i++)
        if(!col[i]) {
            col[i] = 1;
            if(!dfs(i, x)) return false;
        }
    return true;
}

int main() {
    // 输入预处理，构建邻接表
    // 预处理每个点的最小两条边权
    ll l=0, r=2e9, ans=0;
    while(l <= r) {
        ll mid = (l+r) >> 1;
        if(check(mid)) ans=mid, l=mid+1;
        else r=mid-1;
    }
    cout << ans << endl;
}
```

---

## 可视化与算法演示

### 动画设计
1. **二分过程**：动态展示mid值变化，高亮当前检查的X。
2. **边筛选**：用红色标记边权<X的边，构建子图。
3. **染色过程**：DFS遍历时，顶点颜色渐变（红→蓝），冲突边闪烁提示。

### 复古像素风格
- **颜色方案**：8位色，顶点用绿色/紫色区分，边按权重渐变。
- **音效**：成功染色时播放“通关”音效，冲突时播放“错误”音效。
- **自动演示**：按二分步骤自动调整mid，单步执行染色过程。

---

## 总结
通过二分答案结合二分图判定，高效解决路径约束下的最大染色问题。预处理优化和子图处理是核心，适合作为二分与图论结合的典型例题。

---
处理用时：59.09秒
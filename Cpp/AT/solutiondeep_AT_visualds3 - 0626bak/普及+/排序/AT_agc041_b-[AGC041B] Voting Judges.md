# 题目信息

# [AGC041B] Voting Judges

## 题目描述

[problemUrl]: https://atcoder.jp/contests/agc041/tasks/agc041_b

あるコンテストの開催に向けて $ N $ 問の問題が提案されました。はじめ、問題 $ i $ のスコアは整数 $ A_i $ です。

これから、$ M $ 人のジャッジが好きな問題に投票します。各ジャッジは、他のジャッジとは独立にちょうど $ V $ 問を選び、それらの問題のスコアを $ 1 $ ずつ上げます。

$ M $ 人のジャッジ全員が投票を行ったあと、$ N $ 問の問題がスコアの降順に並べられ、最初の $ P $ 問がコンテストの問題セットに採用されます。 同スコアの問題間の順序は、ジャッジ長が任意に決定します。

$ N $ 問のうち、問題セットに採用される可能性を持つ問題は何問あるでしょうか？

## 说明/提示

### 制約

- $ 2\ \le\ N\ \le\ 10^5 $
- $ 1\ \le\ M\ \le\ 10^9 $
- $ 1\ \le\ V\ \le\ N\ -\ 1 $
- $ 1\ \le\ P\ \le\ N\ -\ 1 $
- $ 0\ \le\ A_i\ \le\ 10^9 $

### Sample Explanation 1

$ 1 $ 人しかいないジャッジが問題 $ 2,5 $ に投票した場合、各問のスコアは $ 2 $ $ 2 $ $ 1 $ $ 3 $ $ 1 $ $ 2 $ となり、問題 $ 4 $、そして問題 $ 1,2,6 $ のうちの $ 1 $ 問が採用されます。 ジャッジが問題 $ 3,4 $ に投票した場合、各問のスコアは $ 2 $ $ 1 $ $ 2 $ $ 4 $ $ 0 $ $ 2 $ となり、問題 $ 4 $、そして問題 $ 1,3,6 $ のうちの $ 1 $ 問が採用されます。 よって、問題 $ 1,2,3,4,6 $ には採用される可能性があります。一方で、問題 $ 5 $ には採用される可能性はありません。

### Sample Explanation 2

採用される可能性があるのは問題 $ 1,4,6 $ のみです。

## 样例 #1

### 输入

```
6 1 2 2

2 1 1 3 0 2```

### 输出

```
5```

## 样例 #2

### 输入

```
6 1 5 2

2 1 1 3 0 2```

### 输出

```
3```

## 样例 #3

### 输入

```
10 4 8 5

7 2 3 6 1 6 5 4 6 5```

### 输出

```
8```

# AI分析结果



---

**唯一算法分类**：贪心算法

---

### **题解思路与算法要点**

1. **核心思路**：
   - 将问题按初始分数降序排序，前 `P` 个问题默认可被选上。
   - 对第 `P+1` 个及之后的问题，判断其是否能通过合理分配加分进入前 `P`。关键在于构造一种加分策略，使得该问题的最终分数足够高且其他问题的加分尽可能少。

2. **关键步骤**：
   - **排序**：降序排列后，前 `P` 个问题直接计入答案。
   - **数学条件判断**：
     - 若 `a[i] + M < a[P]`，则无法进入前 `P`。
     - 若剩余加分次数 `V` 可全部分配给后面的问题（不威胁当前排名），则直接计入答案。
     - 否则，计算剩余次数分配后前 `P` 个问题的最大可能加分，判断是否不超过 `a[i] + M`。

3. **解决难点**：
   - **分配策略**：确保剩余加分次数不影响当前问题的排名。
   - **数学推导**：通过不等式计算，判断剩余次数是否会导致前 `P` 个问题的分数超过当前问题。

---

### **题解评分 (≥4星)**

1. **题解1（作者：123456zmy）**：⭐⭐⭐⭐  
   - **亮点**：代码简洁高效，直接通过数学公式判断条件，时间复杂度 `O(N log N)`。
   - **改进点**：缺乏详细注释，变量命名可读性不足。

2. **题解2（作者：Erica_N_Contina）**：⭐⭐⭐⭐  
   - **亮点**：注释详细，逻辑分步骤解释清晰，适合理解复杂条件。
   - **改进点**：代码冗余变量较多，可进一步优化。

---

### **最优思路提炼**

1. **贪心策略**：
   - 优先让当前问题获得最大可能的加分 `M`，剩余加分分配给不影响排名的其他问题。
   - 通过排序和数学推导，确保前 `P` 个问题的最大可能加分不超过当前问题的最终分数。

2. **数学公式**：
   - 剩余加分次数 `t = (V - P - (N - i)) * M`。
   - 分配后前 `P` 个问题的最大可能加分为 `ceil(t / (i - P))`，需满足 `a[P] + 最大值 ≤ a[i] + M`。

---

### **类似题目推荐**

1. **[CF1343C] Alternating Subsequence**：贪心选择最大值子序列。
2. **[LeetCode 870] Advantage Shuffle**：通过排序和贪心策略最大化优势。
3. **[洛谷 P1223] 排队接水**：排序后贪心最小化总等待时间。

---

### **代码核心逻辑**

```cpp
// 排序后处理核心逻辑
sort(a + 1, a + n + 1, greater<int>());
int ans = p;
for (int i = p + 1; i <= n; i++) {
    if (a[i] + m < a[p]) break;
    if (v <= p + (n - i)) {
        ans++;
    } else {
        long long t = (v - p - (n - i)) * m;
        long long max_extra = (t - a1 - 1) / (i - p) + 1;
        if (a[p] + max_extra <= a[i] + m) ans++;
    }
    a1 += a[p] - a[i];
}
```

---

### **可视化设计**

1. **动画方案**：
   - **像素条形图**：用不同颜色条表示问题分数，当前处理的问题高亮为红色。
   - **加分模拟**：点击“执行”后，逐步显示每个问题的加分过程和条件判断结果。
   - **音效提示**：成功时播放8-bit音效，失败时短促提示。

2. **交互设计**：
   - **步进控制**：用户可单步执行或自动播放。
   - **参数调节**：允许输入不同 `N, M, V, P` 测试样例。

---

**总结**：通过排序和数学推导，结合贪心策略判断每个问题的可能性，时间复杂度 `O(N log N)`。

---
处理用时：223.25秒
# 题目信息

# [ABC034C] 経路

## 题目描述

有一个 $W$ 行 $H$ 列的网格图（$2 \leq W,H \leq 10^5$），其中第 $i$ 行第 $j$ 列的坐标为 $(i,j)$。

现在有一个人想从起点 $(1,1)$ 走到终点 $(W,H)$，已知他每次可以从网格 $(i,j)$ 走向 $(i+1,j)$ 或 $(i,j+1)$。现在请你求出，他从起点走到终点的路线个数为多少。

由于这个数可能很大，因此你只要输出路线个数对 $10^9 + 7$ 取模的结果即可。

## 样例 #1

### 输入

```
4 3```

### 输出

```
10```

## 样例 #2

### 输入

```
123 456```

### 输出

```
210368064```

# AI分析结果



**唯一算法分类**：组合数学

---

**综合分析与结论**  
本题核心在于计算组合数 $C(W+H-2, W-1)$，并通过预处理阶乘和逆元高效解决模运算中的除法问题。各题解均采用组合数学思路，差异主要体现在逆元计算方式（线性递推 vs 费马小定理）和预处理策略上。

**核心算法流程**：  
1. **推导公式**：总路径数为组合数 $C(n+m-2, n-1)$，其中 $n=W$, $m=H$。  
2. **预处理阶乘**：计算 $1$ 到 $n+m$ 的阶乘数组 `fact`。  
3. **预处理逆元**：通过线性递推或快速幂计算每个数的逆元，并保存为 `inv_fact`。  
4. **组合数计算**：利用公式 $C(n, k) = \text{fact}[n] \times \text{inv_fact}[k] \times \text{inv_fact}[n-k]$ 快速求解。

**难点与解决方案**：  
- **模运算下的除法**：通过逆元将除法转化为乘法。  
- **高效预处理**：使用线性递推逆元（复杂度 $O(n)$）优于快速幂（复杂度 $O(n \log \text{mod})$）。

---

**题解清单 (≥4星)**  
1. **残阳如血 (★★★★☆)**  
   - **亮点**：线性递推逆元，时间复杂度最优，代码结构清晰。  
   - **代码**：预处理 `inv` 数组后递推 `fact` 和 `inv_fact`，组合数计算高效。  

2. **jzjr (★★★★☆)**  
   - **亮点**：费马小定理求逆元，通过递推优化逆元计算，注释详细。  
   - **代码**：预处理阶乘后，逆元通过递推减少计算量。  

3. **qfy123 (★★★★☆)**  
   - **亮点**：代码简洁，快速幂求逆元，适用于快速实现。  
   - **代码**：直接调用快速幂计算逆元，逻辑明确。  

---

**最优思路提炼**  
1. **组合数公式**：路径数等价于从总步数中选择特定方向步数的组合。  
2. **线性递推逆元**：使用递推公式 $\text{inv}[i] = (\text{MOD} - \text{MOD}/i) \times \text{inv}[\text{MOD}\%i] \% \text{MOD}$，时间复杂度 $O(n)$。  
3. **预处理优化**：预先计算阶乘及其逆元，单次查询 $O(1)$。  

---

**同类型题或算法套路**  
- **网格路径计数**：如 [LeetCode 62. Unique Paths](https://leetcode.com/problems/unique-paths/)。  
- **大数组合数取模**：如 [洛谷 P3807 卢卡斯定理](https://www.luogu.com.cn/problem/P3807)。  
- **逆元应用**：涉及模运算中除法的题目，如 [洛谷 P2613 有理数取余](https://www.luogu.com.cn/problem/P2613)。  

---

**推荐题目**  
1. [洛谷 P3197 越狱](https://www.luogu.com.cn/problem/P3197)  
2. [洛谷 P1313 计算系数](https://www.luogu.com.cn/problem/P1313)  
3. [洛谷 P1357 花园](https://www.luogu.com.cn/problem/P1357)  

---

**可视化与算法演示**  
- **动画方案**：  
  1. **网格路径绘制**：展示从起点到终点的路径，高亮当前选择的右/下方向。  
  2. **阶乘预处理**：动态显示阶乘数组的填充过程，颜色标记当前计算的值。  
  3. **逆元计算**：用不同颜色区分线性递推和快速幂步骤。  
- **复古像素风格**：  
  - **Canvas 绘制**：网格用 8x8 像素块表示，路径移动时播放“滴答”音效。  
  - **音效**：路径成功时播放胜利音效，计算逆元时触发短促音效。  
- **交互设计**：  
  - **步进控制**：允许单步执行组合数计算，观察阶乘与逆元的乘积过程。  
  - **参数调节**：支持自定义 $W$ 和 $H$，实时显示路径数和计算时间。  

---

**关键代码片段（残阳如血）**  
```cpp
// 预处理逆元与阶乘
void init() {
    inv[0] = inv[1] = 1;
    for (int i = 2; i < N; ++i)
        inv[i] = (MOD - MOD / i) * inv[MOD % i] % MOD;
    fact[0] = inv_fact[0] = 1;
    for (int i = 1; i < N; ++i) {
        fact[i] = fact[i - 1] * i % MOD;
        inv_fact[i] = inv_fact[i - 1] * inv[i] % MOD;
    }
}

// 组合数计算
lint C(int n, int m) {
    return fact[n] * inv_fact[m] % MOD * inv_fact[n - m] % MOD;
}
```

---
处理用时：85.86秒
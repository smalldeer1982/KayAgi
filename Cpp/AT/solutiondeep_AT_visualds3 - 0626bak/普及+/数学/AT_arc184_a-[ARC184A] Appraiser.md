# 题目信息

# [ARC184A] Appraiser

## 题目描述

[problemUrl]: https://atcoder.jp/contests/arc184/tasks/arc184_a

この問題は **インタラクティブ** な問題であり、 **ジャッジは適応的(adaptive)** です。詳しくは注意点を参照してください。  
**また、問題文中のパラメータは $ N=1000,M=10,Q=950 $ で固定されています。**

硬貨が $ N $ 枚あり、 $ 1,2,\dots,N $ の番号が付けられています。  
これらの硬貨のうち、丁度 $ M $ 枚が偽物です。

鑑定士は $ 1 $ 度の鑑定で $ 2 $ つの硬貨が同種か異種かを判定できます。厳密には、

- $ 2 $ つの硬貨が「双方とも本物」「双方とも偽物」のどちらかであれば、同種と判定する。
- そうでないとき、異種と判定する。

$ Q $ 回以下の鑑定で、全ての偽物の硬貨を特定してください。

### Input &amp; Output Format

この問題はインタラクティブな問題です。  
最初に、 $ N,M,Q $ を標準入力から受け取ってください。

> $ N $ $ M $ $ Q $

次に、以下の流れで鑑定を $ 0 $ 回以上 $ Q $ 回以下行ってください。

まず、次の形式で標準出力に出力することで、硬貨 $ x,y $ を鑑定することを表します。 (末尾に改行を入れること。)

> ? $ x $ $ y $

ここで、 $ x,y $ は $ 1 $ 以上 $ N $ 以下の相異なる整数である必要があります。

これに対するジャッジシステムの応答は、以下の $ 3 $ 通りです。

```
0
```

応答が `0` であるとき、硬貨 $ x,y $ が同種であることを表します。

```
1
```

応答が `1` であるとき、硬貨 $ x,y $ が異種であることを表します。

```
-1
```

応答が `-1` であるとき、不当な鑑定であることを表します。具体的には

- 出力した $ x,y $ が制約を満たさなかった
- $ Q $ 回を超えて鑑定が行われた

の少なくともひとつが満たされた際にこの応答を行います。  
この応答を受け取った場合、プログラムはすでに不正解とみなされています。直ちにプログラムを終了してください。

最後に、次の形式で標準出力に出力することで、硬貨 $ A_1,A_2,\dots,A_{M} $ が偽物であると解答します。 (末尾に改行を入れること。)

> ! $ A_1 $ $ A_2 $ $ \dots $ $ A_{M} $

ここで、 $ A_i $ は $ 1 $ 以上 $ N $ 以下の相異なる整数である必要があります。  
この出力の後、直ちにプログラムを終了してください。

なお、全ての出力について、出力が指定された形式を満たさなかった場合もプログラムが不正解とみなされます。 その後 `-1` が返答されるので、その場合も直ちにプログラムを終了してください。

## 说明/提示

### 制約

- $ \color{red}{N\ =\ 1000} $
- $ \color{red}{M\ =\ 10} $
- $ \color{red}{Q\ =\ 950} $

### 注意点

- **出力を行うたびに、末尾に改行を入れて標準出力を flush してください。** そうしなかった場合、ジャッジ結果が TLE や WA となる可能性があります。
- 解答を出力したら (または `-1` を受け取ったら) ただちにプログラムを終了してください。そうしない場合、ジャッジ結果は不定です。
- 余計な改行は不正なフォーマットの出力とみなされることに注意してください。
- **この問題のジャッジシステムは、適応的(adaptive)です。** つまり、ジャッジシステムは、任意のタイミングにおいて、整合性がとれる限り、偽物の硬貨として想定しているものを変更する可能性があります。詳しくは入出力例も参照してください。

### 入出力例

この入力では $ N=5,M=2,Q=10 $ であり、ジャッジシステムは最初硬貨 $ 1,2 $ が偽物であると想定しています。

なお、この例は制約を満たさないので、ジャッジには含まれないことに注意してください。

入力出力説明`5 2 10`$ N,M,Q $ が与えられます。`? 1 2`硬貨 $ 1,2 $ について鑑定を行います。`0`硬貨 $ 1,2 $ は同種だと判定します。`? 1 3`硬貨 $ 1,3 $ について鑑定を行います。`1`硬貨 $ 1,3 $ は異種だと判定します。`? 1 4`硬貨 $ 1,4 $ について鑑定を行います。`1`硬貨 $ 1,4 $ は異種だと判定します。`! 1 2`硬貨 $ 1,2 $ が偽物だと解答します。確かに硬貨 $ 1,2 $ は偽物だと想定されていますが、硬貨 $ 3,4 $ を偽物であると想定しても整合性が取れます。  
よって、ジャッジシステムは偽物の硬貨として想定しているものを硬貨 $ 3,4 $ に変更できます。  
これにより、ジャッジシステムは不正解の判定を下すこともあります。

# AI分析结果



## 算法分类
**无算法分类**（问题核心为交互式逻辑与分组策略，不依赖经典算法）

---

## 综合分析与结论

### 核心思路与解决难点
- **分组策略**：将 1000 硬币分为 90 组（每组 11 枚）和剩余 10 枚。每组内仅需 10 次询问即可判断全组是否同类型，总次数为 `90*10=900`。
- **基准真币**：若某组内所有硬币类型相同（因假币最多 10 枚，全同组必为真币），可选定其作为基准真币。
- **假币组判定**：对存在异类的组，用基准真币与其首元素比较，确定该组真假分布，最多 `10` 次。
- **剩余处理**：最后 10 枚单独与基准比较，消耗 `10` 次。
- **总次数**：`900+10+10=920 < 950`，满足要求。

### 可视化设计要点
1. **分组动画**：  
   - 硬币以 11 个一组排列，用不同颜色（绿/红）区分真假。  
   - **高亮当前比较的硬币对**，显示询问结果（同色 → 绿色闪烁；异色 → 红色闪烁）。  
   - 基准真币用金色边框标记。

2. **复古像素风格**：  
   - 使用 8-bit 音效：比较时播放短促“滴”声，确定基准时播放“升级”音效。  
   - Canvas 绘制网格布局，硬币显示为 16x16 像素方块。  
   - 背景循环播放低比特率芯片音乐。

3. **自动演示模式**：  
   - 分阶段自动执行：分组比较 → 基准确定 → 假币组处理 → 剩余检查。  
   - 用户可调节速度（慢/中/快），或单步执行观察细节。

---

## 题解清单 (≥4星)

### 1. WZWZWZWY 的题解（5星）
- **亮点**：直接实现官方分组思路，代码简洁高效。  
- **关键代码**：
  ```cpp
  for (int i = 1; i <= 90; i++) {
      int st = 11*(i-1)+1; // 组头
      bool same = true;
      for (int j = st+1; j <= st+10; j++) {
          if (ask(st, j)) same = false; // 存在异类
      }
      if (same) rel = st; // 基准真币
  }
  ```

### 2. wmrqwq 的题解（4.5星）
- **亮点**：详细推导分组策略与次数边界，逻辑严谨。  
- **核心步骤**：  
  - 前 90 组各 11 枚，剩余 10 枚。  
  - 确定基准后，遍历假币组并验证剩余。

### 3. WuMin4 的题解（4星）
- **亮点**：代码紧凑，异常处理明确。  
- **关键片段**：
  ```cpp
  if (!cp) { // 所有组同类型 → 假币在最后10枚
      cout << "! ";
      for (int i=991; i<=1000; i++) cout << i << " ";
  }
  ```

---

## 最优思路与技巧提炼
1. **分组压缩法**：  
   - **核心**：利用假币数远小于总数，将硬币分块，快速排除全真组。  
   - **实现**：每组大小为 `M+1`（如 11），确保至少一组全真。

2. **基准传递法**：  
   - **核心**：通过基准真币快速推导其他组的真假分布。  
   - **实现**：每个假币组仅需一次基准比较即可确定全组属性。

---

## 相似题目推荐
1. **洛谷 P2447 [SDOI2010] 外星千足虫**（分组异或判定）  
2. **洛谷 P3737 [HAOI2014] 走出迷宫**（交互式分组策略）  
3. **洛谷 P7960 [NOIP2021] 报数**（高效筛选与验证）

---

## 个人心得摘录
- **wmrqwq**：“假币数量少是关键，必须利用这一特点减少无效比较。”  
- **I_will_AKIOI**：“调试时发现，未处理剩余组导致 WA，需严格验证边界。”

---

## 可视化代码片段（Canvas 绘制示例）
```javascript
// 绘制硬币组
function drawCoins(groups) {
  ctx.clearRect(0, 0, canvas.width, canvas.height);
  groups.forEach((group, idx) => {
    const x = (idx % 10) * 120 + 20;
    const y = Math.floor(idx / 10) * 140 + 20;
    group.forEach((coin, cIdx) => {
      ctx.fillStyle = coin.isReal ? "#0F0" : "#F00";
      ctx.fillRect(x + (cIdx % 5) * 24, y + Math.floor(cIdx/5)*24, 20, 20);
      if (coin.isBase) ctx.strokeStyle = "#FF0"; // 基准高亮
    });
  });
}
```

---

## 复古音效设计
- **比较音效**：8-bit 短音（频率 500Hz，时长 50ms）。  
- **基准确定**：上升琶音（C4 → E4 → G4）。  
- **错误提示**：低频噪音（200Hz，200ms）。  
- **背景音乐**：芯片风格循环旋律（使用 Web Audio API 生成）。

---
处理用时：70.69秒
# 题目信息

# [ARC157B] XYYYX

## 题目描述

[problemUrl]: https://atcoder.jp/contests/arc157/tasks/arc157_b

`X`, `Y` からなる長さ $ N $ の文字列 $ S $ が与えられます． $ S $ 中の相異なる位置にある $ K $ 文字を選び，選んだ文字が `X` であれば `Y` に，`Y` であれば `X` にそれぞれ置き換えます． 置き換えた後の文字列中で `Y` 同士が隣り合う箇所は最大でいくつになるかを求めてください．

## 说明/提示

### 制約

- $ 1\ \leq\ N\ \leq\ 2\ \times\ 10^5 $
- $ 0\ \leq\ K\ \leq\ N $
- $ S $ は `X`, `Y` からなる長さ $ N $ の文字列である．
 
### Sample Explanation 1

選ぶのは $ 1 $ 文字だけです． - $ 1 $ 文字目を選ぶと，置き換えた後の文字列は `YYXYX` となり，$ 1,\ 2 $ 文字目の $ 1 $ 箇所で `Y` 同士が隣り合っています． - $ 2 $ 文字目を選ぶと，置き換えた後の文字列は `XXXYX` となり，`Y` 同士が隣り合っている箇所はありません． - $ 3 $ 文字目を選ぶと，置き換えた後の文字列は `XYYYX` となり，$ 2,\ 3 $ 文字目と $ 3,\ 4 $ 文字目の $ 2 $ 箇所で `Y` 同士が隣り合っています． - $ 4 $ 文字目を選ぶと，置き換えた後の文字列は `XYXXX` となり，`Y` 同士が隣り合っている箇所はありません． - $ 5 $ 文字目を選ぶと，置き換えた後の文字列は `XYXYY` となり，$ 4,\ 5 $ 文字目の $ 1 $ 箇所で `Y` 同士が隣り合っています． 以上より，求める最大値は $ 2 $ です．

### Sample Explanation 2

$ 1,\ 2,\ 3,\ 5 $ 文字目を選んで `YXYYY` とするか，$ 1,\ 3,\ 4,\ 5 $ 文字目を選んで `YYYXY` とするのが最適です． 同じ位置にある文字を複数回選ぶことはできないことに注意してください．

## 样例 #1

### 输入

```
5 1

XYXYX```

### 输出

```
2```

## 样例 #2

### 输入

```
5 4

XYXYX```

### 输出

```
2```

# AI分析结果



# 算法分类
**贪心**

---

## 综合分析与结论

### 核心思路
题目要求通过翻转K个字符使相邻'Y'对最多。核心思路是**贪心策略**，优先处理能带来最大收益的连续X段。具体步骤：
1. **问题转换**：若K超过原字符串中的X数量，反转整个字符串（X变Y，Y变X），并将K调整为剩余可翻转次数。
2. **中间段处理**：统计相邻Y之间的X段长度，优先翻转短的X段（每次翻转能连接两边的Y，贡献长度+1的相邻对）。
3. **剩余翻转**：剩余次数直接按每翻转一次增加一个相邻对处理。

### 难点与解决
1. **中间段的贡献计算**：相邻Y之间的X段翻转后，贡献值为长度+1。需正确统计所有中间段并按长度排序。
2. **边界处理**：全X或全Y的情况需特判。
3. **反转后的处理**：当K超过X数量时，需反转整个字符串并重新统计所有变量。

### 可视化设计
- **动画演示**：用像素块表示字符，翻转时颜色变化。处理中间段时，高亮当前段并显示贡献值。
- **交互控制**：允许单步执行，观察每一步的翻转效果及剩余次数变化。
- **音效提示**：翻转成功时播放上升音调，剩余次数不足时播放下降音调。

---

## 题解清单（评分≥4星）
### 1. I_like_magic（★★★★☆）
- **亮点**：代码简洁高效，正确处理所有边界情况，逻辑清晰。
- **核心代码**：
  ```cpp
  vector<int> dis; // 存储相邻Y间X的数量
  for (int i : dis) {
      if (k >= i) {
          k -= i;
          ans += i + 1;
      }
  }
  ans += k; // 处理剩余次数
  ```

---

## 最优思路提炼
### 关键技巧
1. **问题转换**：当K超过X数量时，反转字符串并调整K值，确保始终处理X到Y的翻转。
2. **贪心排序**：优先处理最短的X段，最大化每次翻转的收益（贡献值为段长+1）。
3. **剩余处理**：剩余翻转次数直接累加到答案，每次贡献1对。

### 同类型题
- **LeetCode 2024**：最大化考试中连续相同答案的长度（类似贪心选择窗口）。
- **洛谷 P1090**：合并果子（优先处理小堆）。
- **ATcoder ABC224 D**：状态转换问题（贪心选择最优路径）。

---

## 推荐题目
1. **洛谷 P1090**（贪心选择最小堆）
2. **LeetCode 2024**（滑动窗口+贪心）
3. **ATcoder ABC157B**（类似字符串翻转优化）

---

## 可视化算法演示（伪代码）
```javascript
// 初始化像素画布
const canvas = initCanvas();
let blocks = []; // 每个字符的像素块
let segments = []; // 当前处理的X段

// 动画主循环
function animate() {
    // 高亮当前最短段
    highlightSegment(segments.shift());
    // 翻转并播放音效
    flipXToY();
    playSound('success');
    // 更新剩余次数显示
    updateKDisplay();
}
```

---

## 个人心得
- **边界陷阱**：全X或全Y需单独处理，否则可能导致计算错误。
- **反转处理**：在转换字符串时，必须同步更新所有统计变量（如X/Y数量、位置数组）。
- **贡献计算**：中间段的贡献值为段长+1，而非段长本身，需仔细推导。

---
处理用时：310.52秒
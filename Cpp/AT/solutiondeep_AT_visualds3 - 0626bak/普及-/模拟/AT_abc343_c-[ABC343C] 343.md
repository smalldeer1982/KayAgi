# 题目信息

# [ABC343C] 343

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc343/tasks/abc343_c

正整数 $ N $ が与えられます。

$ N $ 以下の正整数であって回文立方数であるものの最大値を求めてください。

ただし、正整数 $ K $ は以下の $ 2 $ つの条件を満たすとき、またそのときに限り回文立方数であると定義します。

- ある正整数 $ x $ が存在し、$ x^3\ =\ K $ を満たす。
- $ K $ を先頭に $ 0 $ をつけずに $ 10 $ 進表記した文字列が回文となる。より厳密には、$ 0 $ 以上 $ 9 $ 以下の整数 $ A_0,\ A_1,\ \ldots,\ A_{L-2} $ および $ 1 $ 以上 $ 9 $ 以下の整数 $ A_{L-1} $ を用いて $ K\ =\ \sum_{i\ =\ 0}^{L-1}\ A_i10^i $ と表記したときに $ i\ =\ 0,\ 1,\ \ldots,\ L-1 $ に対して $ A_i\ =\ A_{L-1-i} $ を満たす。

## 说明/提示

### 制約

- $ N $ は $ 10^{18} $ 以下の正整数

### Sample Explanation 1

$ 343 $ は回文立方数であり、$ 344,\ 345 $ は回文立方数ではありません。したがって、$ 343 $ が答えとなります。

## 样例 #1

### 输入

```
345```

### 输出

```
343```

## 样例 #2

### 输入

```
6```

### 输出

```
1```

## 样例 #3

### 输入

```
123456789012345```

### 输出

```
1334996994331```

# AI分析结果



1. **算法分类选择**  
   **枚举**

---

2. **题解思路、算法要点与解决难点**  
   **核心思路**：  
   - 枚举所有可能的立方根 x（1 ≤ x ≤ ∛N），计算 x³，判断其是否为回文数  
   - 优化方向：倒序枚举立方根，找到第一个符合条件的数即可终止，减少无效计算  

   **关键实现**：  
   - 使用 `cbrt(n)` 计算立方根初始值，倒序枚举  
   - 字符串反转法快速判断回文数  

   **解决难点**：  
   - 处理大数范围（1e18）时，通过三次根压缩枚举范围到 1e6 级别  
   - 避免立方运算溢出：使用 `unsigned long long` 或 `__int128` 类型  

---

3. **题解评分 (≥4星)**  
   ⭐⭐⭐⭐ [作者：Little_x_starTYJ]  
   - 亮点：倒序枚举 + 即时终止，代码简洁高效  
   - 代码片段：  
     ```cpp
     for (unsigned long long i = cbrt(n) + 1; ; i--) {
         if (i * i * i > n) continue;
         // 回文判断与输出
     }
     ```

   ⭐⭐⭐⭐ [作者：include13_fAKe]  
   - 亮点：固定枚举到 1e6，避免浮点误差风险  
   - 代码片段：  
     ```cpp
     for (int i = 1e6; i >= 1; i--) {
         if (i*i*i <= n && check(i*i*i)) {
             // 输出结果
         }
     }
     ```

   ⭐⭐⭐⭐ [作者：int_stl]  
   - 亮点：预计算所有回文立方数打表，时间复杂度最优  
   - 代码片段：  
     ```cpp
     int ans[] = {1,8,343,...,1331399339931331};
     for (int i : ans) if (i <= n) return i;
     ```

---

4. **最优思路或技巧提炼**  
   **关键优化点**：  
   - **倒序剪枝**：从立方根最大值倒序枚举，首个符合条件的即为答案  
   - **快速回文判断**：数字转字符串后反转比较，比逐位计算更直观  
   - **打表法**：因回文立方数总数极少（仅14个），预存结果实现 O(1) 查询  

   **代码片段示例**：  
   ```cpp
   // 倒序枚举立方根
   for (ll x = cbrt(n); x >= 1; x--) {
       ll k = x * x * x;
       if (k > n) continue;
       string s = to_string(k);
       if (s == string(s.rbegin(), s.rend())) {
           cout << k;
           return 0;
       }
   }
   ```

---

5. **同类型题或类似算法套路**  
   - **回文数变形**：如 [LC479. 最大回文数乘积](https://leetcode.cn/problems/largest-palindrome-product/)  
   - **数学枚举优化**：如求最大素数、完美平方数等  
   - **预计算打表**：适用于结果集有限的场景  

---

6. **推荐相似洛谷题目**  
   1. [P1217 回文质数](https://www.luogu.com.cn/problem/P1217)  
   2. [P1029 最大公约数和最小公倍数问题](https://www.luogu.com.cn/problem/P1029)  
   3. [P1061 数列](https://www.luogu.com.cn/problem/P1061)  

---

7. **个人心得摘录**  
   - "注意立方运算可能溢出 long long，用 `i*i*i <= n` 作循环条件更安全"  
   - "打表法看似取巧，但对稀疏结果集能大幅提升效率，是竞赛实用技巧"  
   - "倒序枚举时，初始值加1再减可处理浮点误差（如 cbrt(343)=6.999...）"

---

8. **可视化与算法演示**  
   **动画设计**：  
   - **像素风格界面**：  
     - 背景：16色网格，立方根 x 显示为像素方块，x³ 以滚动数字展示  
     - 当前操作：高亮 x 的立方块，回文判断时数字逐位闪光  
   - **核心流程**：  
     1. 初始显示 N 值和立方根最大值  
     2. 倒序枚举 x，显示 x³ 计算过程  
     3. 对每个 x³ 进行回文检测，字符逐个对比  
     4. 找到匹配时，播放胜利音效并定格结果  

   **交互功能**：  
   - **速度调节**：滑块控制枚举速度（1x~100x）  
   - **AI模式**：自动完成全流程，类似自动播放的贪吃蛇AI  
   - **音效**：  
     - 立方计算：8-bit "哔"声  
     - 回文匹配：上升音阶  
     - 错误匹配：低沉"咚"声  

   **Canvas 示例代码**：  
   ```javascript
   // 绘制立方根方块
   function drawCube(x) {
       ctx.fillStyle = '#FF5555';
       ctx.fillRect(x*20 % 300, Math.floor(x*20/300)*20, 18, 18);
   }
   // 回文检测动画
   function checkPalindrome(str) {
       for (let i=0; i<str.length/2; i++) {
           highlightChar(i); // 高亮左侧字符
           highlightChar(str.length-1-i); // 高亮右侧字符
           if (str[i] != str[str.length-1-i]) return false;
       }
       return true;
   }
   ```

---

9. **复古游戏化动画效果**  
   **实现要点**：  
   - **调色板**：使用 NES 经典色（#7C3F58, #FBF7F3, #306082）  
   - **音效**：  
     - 移动：`beep(440, 50)`  
     - 成功：`beep(880, 200)`  
   - **自动演示**：  
     ```javascript
     function autoRun() {
         let x = Math.cbrt(N);
         while (x >= 1) {
             drawCube(x);
             if (x*x*x <= N && isPalindrome(x*x*x)) {
                 playSuccess();
                 break;
             }
             x--;
         }
     }
     ```

---
处理用时：119.09秒
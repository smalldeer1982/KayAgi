# 题目信息

# [ABC315C] Flavors

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc315/tasks/abc315_c

$ N $ カップのアイスクリームがあります。  
 $ i $ カップ目の味は $ F_i $ 、美味しさは $ S_i $ ( $ S_i $ は偶数 ) です。

あなたは、 $ N $ 個のカップの中から $ 2 $ つを選んで食べることにしました。  
 このときの満足度は次のように定義されます。

- 食べたアイスクリームの美味しさを $ s,t $ ( 但し、 $ s\ \ge\ t $ ) とする。
  - $ 2 $ つのカップの味が異なるなら、満足度は $ \displaystyle\ s+t $ である。
  - そうでないなら、満足度は $ \displaystyle\ s\ +\ \frac{t}{2} $ である。
 
満足度として達成可能な最大値を求めてください。

## 说明/提示

### 制約

- 入力は全て整数
- $ 2\ \le\ N\ \le\ 3\ \times\ 10^5 $
- $ 1\ \le\ F_i\ \le\ N $
- $ 2\ \le\ S_i\ \le\ 10^9 $
- $ S_i $ は偶数
 
### Sample Explanation 1

$ 2 $ カップ目と $ 4 $ カップ目のアイスを食べることを考えます。 - $ 2 $ カップ目の味は $ 2 $ 、美味しさは $ 10 $ です。 - $ 4 $ カップ目の味は $ 3 $ 、美味しさは $ 6 $ です。 - 両者の味は異なるので、満足度は $ 10+6=16 $ です。 以上より、満足度 $ 16 $ を達成できます。 満足度を $ 16 $ より大きくすることはできません。

### Sample Explanation 2

$ 1 $ カップ目と $ 4 $ カップ目のアイスを食べることを考えます。 - $ 1 $ カップ目の味は $ 4 $ 、美味しさは $ 10 $ です。 - $ 4 $ カップ目の味は $ 4 $ 、美味しさは $ 12 $ です。 - 両者の味は同じなので、満足度は $ 12+\frac{10}{2}=17 $ です。 以上より、満足度 $ 17 $ を達成できます。 満足度を $ 17 $ より大きくすることはできません。

## 样例 #1

### 输入

```
4

1 4

2 10

2 8

3 6```

### 输出

```
16```

## 样例 #2

### 输入

```
4

4 10

3 2

2 4

4 12```

### 输出

```
17```

# AI分析结果



---

**算法分类**：贪心算法

### 题解思路与算法要点

**核心思路**：  
题目要求从所有冰淇淋中选两个，使得满足度最大。满足度分为两种情况：  
1. 两冰淇淋口味不同：满足度为二者美味度之和。  
2. 口味相同：满足度为较大值加上较小值的一半。  

**关键难点**：  
1. 高效找到同一口味的最大的两个值，以及不同口味中的最大组合。  
2. 避免暴力枚举所有可能的组合（O(n²)会超时）。  

**解决策略**：  
1. **贪心策略**：优先考虑美味度最大的冰淇淋，再根据其口味寻找次优解。  
2. **分类处理**：维护每个口味的前两大美味度，同时维护全局最大和次大值。  

### 最优思路提炼

1. **预处理每个口味的前两大美味度**：  
   遍历所有冰淇淋，记录每个口味下最大的两个美味度。  
2. **计算同一口味的最大满足度**：  
   对于每个口味，若存在至少两个冰淇淋，计算其最大可能值（s1 + s2/2）。  
3. **计算不同口味的最大满足度**：  
   收集所有口味的最大美味度，取其中最大的两个相加。  
4. **比较两种情况的最大值**，取较大者作为最终结果。  

**时间复杂度**：O(n)，仅需一次遍历。

### 题解评分（≥4星）

1. **Elairin176（4星）**  
   - **思路清晰**：直接处理最大和次大值，区分同/异口味情况。  
   - **代码简洁**：一次排序后线性扫描，时间复杂度O(n log n)。  
   - **亮点**：逻辑明确，直接覆盖所有情况。  

2. **Failure_Terminator（4星）**  
   - **高效实现**：线性遍历维护每个口味的前两大值。  
   - **正确性高**：直接覆盖两种核心情况，无冗余操作。  
   - **亮点**：O(n)时间复杂度，适用于大数据量。  

3. **FreedomKing（4星）**  
   - **逻辑严谨**：分情况处理最大值的同/异口味组合。  
   - **代码可读**：分步骤查找不同口味的最大值，避免二次排序。  
   - **亮点**：直观处理，避免复杂数据结构。  

### 可视化与算法演示

**动画设计**：  
1. **初始排序**：将冰淇淋按美味度降序排列，高亮前两个元素。  
2. **颜色区分**：用不同颜色标记不同口味，同一口味用深浅区分。  
3. **动态比较**：  
   - 若前两个元素口味不同，直接相加（绿色高亮）。  
   - 若相同，计算最大值与次大值的一半之和（黄色高亮），并扫描后续元素寻找不同口味最大值（红色高亮）。  
4. **结果对比**：并行显示两种情况的候选值，最终取最大值（闪烁效果）。  

**复古游戏化效果**：  
- **像素风格**：用8位色块表示冰淇淋，颜色对应口味，大小对应美味度。  
- **音效触发**：  
  - 选中最大值时播放“叮”声，次大值播放“咚”声。  
  - 计算结果时播放胜利音效。  
- **自动演示**：模拟贪心过程，逐步展示最大值的选择和比较。  

### 代码实现（核心逻辑）

```cpp
#include <bits/stdc++.h>
using namespace std;

int main() {
    int n;
    cin >> n;
    unordered_map<int, vector<int>> flavor_map; // 记录每个口味的前两大美味度
    vector<int> global_max; // 记录所有口味中的最大美味度
    
    for (int i = 0; i < n; ++i) {
        int f, s;
        cin >> f >> s;
        if (flavor_map[f].size() < 2) {
            flavor_map[f].push_back(s);
        } else {
            if (s > flavor_map[f][0]) {
                flavor_map[f][1] = flavor_map[f][0];
                flavor_map[f][0] = s;
            } else if (s > flavor_map[f][1]) {
                flavor_map[f][1] = s;
            }
        }
        global_max.push_back(s);
    }
    
    int same_flavor_max = 0;
    for (auto &[f, s_list] : flavor_map) {
        if (s_list.size() >= 2) {
            sort(s_list.rbegin(), s_list.rend());
            int current = s_list[0] + s_list[1] / 2;
            same_flavor_max = max(same_flavor_max, current);
        }
    }
    
    sort(global_max.rbegin(), global_max.rend());
    int diff_flavor_max = global_max[0] + global_max[1];
    
    cout << max(same_flavor_max, diff_flavor_max) << endl;
    return 0;
}
```

### 类似题目推荐

1. **P1090 [NOIP2004 提高组] 合并果子**：贪心选择最小代价合并，优先队列实现。  
2. **P1208 [USACO1.3]混合牛奶 Mixing Milk**：贪心选择单价最低的牛奶。  
3. **P2240 【深基12.例1】部分背包问题**：按单位价值排序，贪心选择。  

### 个人心得摘录

- **贪心正确性验证**：需覆盖所有可能的组合情况，尤其是边界条件（如最大两个同/异口味）。  
- **数据预处理技巧**：通过哈希表维护每个口味的前两大值，避免多次排序。  
- **调试经验**：测试用例需包含同口味组合优于异口味的情况，验证代码逻辑。  

通过合理分类和预处理，能在O(n)时间内高效解决问题，贪心策略在此类组合优化问题中表现优异。

---
处理用时：232.04秒
# 题目信息

# [ABC359C] Tile Distance 2

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc359/tasks/abc359_c

座標平面上に $ 2\times1 $ の大きさのタイルが敷き詰められています。 タイルは、次の規則に従って敷き詰められています。

- 整数の組 $ (i,j) $ に対し、正方形 $ A\ _\ {i,j}=\lbrace(x,y)\mid\ i\leq\ x\leq\ i+1\wedge\ j\leq\ y\leq\ j+1\rbrace $ は $ 1 $ つのタイルに含まれる。
- $ i+j $ が偶数のとき、$ A\ _\ {i,j} $ と $ A\ _\ {i\ +\ 1,j} $ は同じタイルに含まれる。
 
ただし、タイルは境界を含むものとし、共通部分が正の面積をもつような $ 2 $ つの異なるタイルは存在しないとします。

原点の近くでは、タイルは以下のように敷き詰められています。

![](https://cdn.luogu.com.cn/upload/vjudge_pic/AT_abc359_c/85986a05648888be0c6d0706034a45ff07ff8b7a.png)

高橋君は、はじめ座標平面上の点 $ (S\ _\ x+0.5,S\ _\ y+0.5) $ にいます。

高橋君は、次の移動を好きなだけ繰り返します。

- 上下左右の方向と正の整数 $ n $ を選ぶ。その方向に $ n $ だけ進む。
 
高橋君が異なるタイルを通るたび、高橋君は通行料を $ 1 $ だけ支払います。

高橋君が点 $ (T\ _\ x+0.5,T\ _\ y+0.5) $ にたどり着くために支払わなければならない通行料の最小値を求めてください。

## 说明/提示

### 制約

- $ 0\leq\ S\ _\ x\leq2\times10\ ^\ {16} $
- $ 0\leq\ S\ _\ y\leq2\times10\ ^\ {16} $
- $ 0\leq\ T\ _\ x\leq2\times10\ ^\ {16} $
- $ 0\leq\ T\ _\ y\leq2\times10\ ^\ {16} $
- 入力はすべて整数
 
### Sample Explanation 1

例えば、以下のように移動することで支払う通行料を $ 5 $ にすることができます。 !\[\](https://img.atcoder.jp/abc359/187d19c48a9a0fcedb2602063689ee77.png) - 左に $ 1 $ 進む。通行料を $ 0 $ 支払う。 - 上に $ 1 $ 進む。通行料を $ 1 $ 支払う。 - 左に $ 1 $ 進む。通行料を $ 0 $ 支払う。 - 上に $ 3 $ 進む。通行料を $ 3 $ 支払う。 - 左に $ 1 $ 進む。通行料を $ 0 $ 支払う。 - 上に $ 1 $ 進む。通行料を $ 1 $ 支払う。 支払う通行料を $ 4 $ 以下にすることはできないので、`5` を出力してください。

### Sample Explanation 2

通行料を支払わなくてよい場合もあります。

### Sample Explanation 3

出力すべき値が $ 32\operatorname{bit} $ 整数の範囲に収まらない場合があることに注意してください。

## 样例 #1

### 输入

```
5 0

2 5```

### 输出

```
5```

## 样例 #2

### 输入

```
3 1

4 1```

### 输出

```
0```

## 样例 #3

### 输入

```
2552608206527595 5411232866732612

771856005518028 7206210729152763```

### 输出

```
1794977862420151```

# AI分析结果



**唯一算法分类**：数学（坐标变换与奇偶性分析）

---

### **题解思路与算法要点**

1. **核心思路**  
   - 纵向移动必定产生费用，横向移动费用可通过砖块排列特性优化。
   - **调整坐标**：确保起点和终点在砖块的左半部分，使后续计算统一。
   - **奇偶性对齐**：若调整后的横向差 `x` 和纵向差 `y` 奇偶性不同，需通过调整坐标对齐。
   - **公式推导**：若 `x ≤ y`，费用为 `y`；否则费用为 `(x + y) / 2`。

2. **解决难点**  
   - **坐标调整**：根据砖块排列规则，将起点/终点坐标左移对齐奇偶性。
   - **奇偶性对齐**：通过调整 `sx` 或 `ex` 确保 `x` 和 `y` 的奇偶性一致，使公式成立。

---

### **题解评分（≥4星）**

1. **Redamancy_Lydic（★★★★★）**  
   - **亮点**：简洁的坐标调整与公式推导，代码直接体现核心逻辑。
   - **关键代码**：通过奇偶性判断调整坐标，直接应用公式。

2. **tzzl3035（★★★★★）**  
   - **亮点**：极简实现，直接调整坐标后应用公式，代码易读。
   - **关键代码**：仅需判断奇偶性并调整坐标，逻辑清晰。

3. **I_Love_DS（★★★★☆）**  
   - **亮点**：明确纵向费用优先，剩余横向费用通过差值计算。
   - **关键代码**：调整坐标后计算 `k = |ex-sx| - |ey-sy|`，处理剩余横向费用。

---

### **最优思路与技巧**

1. **坐标调整**  
   - 将起点和终点调整为砖块的左半部分，确保奇偶性一致。
   - 代码片段：
     ```cpp
     if ((sx + sy) % 2) sx--;
     if ((tx + ty) % 2) tx--;
     ```

2. **奇偶性对齐公式**  
   - 若调整后的 `x` 和 `y` 奇偶性不同，需额外调整：
     ```cpp
     if (x%2 != y%2) {
         if ((sx+sy)%2 == 1) sx--; 
         else ex--;
     }
     ```

3. **费用公式**  
   - 核心逻辑：
     ```cpp
     if (x <= y) ans = y;
     else ans = (x + y) / 2;
     ```

---

### **同类型题与算法套路**

- **类似题目**：AT353 F（坐标奇偶性分析）、洛谷 P1219（棋盘覆盖问题）。
- **通用思路**：通过坐标变换将问题转化为数学公式，利用奇偶性减少状态分析。

---

### **推荐洛谷题目**

1. **P1219** 八皇后问题（棋盘覆盖与坐标分析）
2. **P3958** NOIP2017 奶酪（三维坐标距离与连通性）
3. **P1036** 选数（组合数与奇偶性结合）

---

### **可视化与算法演示**

1. **动画设计**  
   - **坐标调整**：高亮起点/终点坐标，左移对齐砖块左半部分。
   - **移动路径**：展示斜向移动（减少费用）与纯纵向/横向移动对比。
   - **费用标记**：每次穿过砖块边界时显示费用增加。

2. **复古像素风格**  
   - **颜色方案**：砖块用交替的8位颜色（蓝/绿），移动路径用黄色高亮。
   - **音效**：穿过边界时播放“哔”声，调整坐标时播放“咔嗒”声。
   - **自动演示**：按最优路径自动移动，步进速度可调。

---

### **核心代码实现**

```cpp
#include <bits/stdc++.h>
using namespace std;
using i64 = long long;

int main() {
    i64 sx, sy, tx, ty;
    cin >> sx >> sy >> tx >> ty;
    
    // 调整到左半砖
    if ((sx + sy) % 2) sx--;
    if ((tx + ty) % 2) tx--;
    
    i64 x = abs(tx - sx), y = abs(ty - sy);
    
    // 奇偶性对齐
    if ((x % 2) != (y % 2)) {
        if ((sx + sy) % 2) sx--;
        else tx--;
        x = abs(tx - sx);
    }
    
    if (x <= y) cout << y;
    else cout << (x + y) / 2;
    
    return 0;
}
```

---
处理用时：124.63秒
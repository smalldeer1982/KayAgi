# 题目信息

# [ABC397D] Cubes

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc397/tasks/abc397_d

给定一个正整数 $N$。请判断是否存在满足 $x^3 - y^3 = N$ 的正整数对 $(x, y)$。若存在，请输出其中一个这样的 $(x, y)$。

## 说明/提示

### 约束条件

- $1 \leq N \leq 10^{18}$
- 输入均为整数

### 样例解释 1

因为 $12^3 - 11^3 = 397$，所以 $(x, y) = (12, 11)$ 是正确答案之一。

### 样例解释 2

不存在满足 $x^3 - y^3 = 1$ 的正整数对 $(x, y)$，因此输出 `-1`。

翻译由 DeepSeek R1 完成

## 样例 #1

### 输入

```
397```

### 输出

```
12 11```

## 样例 #2

### 输入

```
1```

### 输出

```
-1```

## 样例 #3

### 输入

```
39977273855577088```

### 输出

```
342756 66212```

# AI分析结果



### **算法分类**  
数学推导、因数分解与枚举  

---

### **题解思路与核心难点**  
**核心思路**：  
1. **立方差公式分解**：将问题转化为寻找因数对 `(x-y, x²+xy+y²)`，其中 `x-y` 为 `N` 的因数。  
2. **枚举差值**：枚举可能的差值 `t = x - y`，其范围由 `t³ ≤ 4N` 确定。  
3. **数学推导**：通过变形方程，构造关于 `y` 的一元二次方程，并判断其判别式是否为完全平方数。  

**解决难点**：  
- **大数处理**：避免 `long long` 溢出，部分题解使用 `__int128` 或精确的整数运算。  
- **精度控制**：通过整数运算判断平方根是否为整数（例如先计算整数平方根再验证）。  
- **条件剪枝**：快速跳过不满足整除或平方条件的 `t`，减少无效计算。  

---

### **题解评分 (≥4星)**  
1. **yuhong056 (5赞)**:  
   - **亮点**：清晰的数学推导，代码简洁高效，正确处理了精度问题。  
   - **评分**：⭐⭐⭐⭐⭐  
   - **核心代码**：  
     ```cpp
     for (ll i = 1; i * i * i < n; i++) {
         if (n % i) continue;
         ll j = n / i - i * i;
         if (j % 3) continue;
         j /= 3;
         ll x_add_y = sqrt(i * i + j * 4);
         // 后续验证逻辑
     }
     ```

2. **xixisuper (3赞)**:  
   - **亮点**：直接换元 `x = y + a`，转化为二次方程，代码直观易读。  
   - **评分**：⭐⭐⭐⭐  
   - **核心代码**：  
     ```cpp
     for (ll a = 1; a * a * a < N; a++) {
         ll c = N - a * a * a;
         if (c % (3 * a) != 0) continue;
         c /= (3 * a);
         ll delta = a * a + 4 * c;
         // 判断 delta 是否为平方数
     }
     ```

3. **Clover_Lin (4赞)**:  
   - **亮点**：深入推导方程到 `3a² + b²` 形式，优化枚举范围。  
   - **评分**：⭐⭐⭐⭐  
   - **核心公式**：  
     $$ 3a^2b + b^3 = 4N \implies b \leq \sqrt[3]{4N} $$  

---

### **最优思路提炼**  
1. **关键变量枚举**：枚举 `t = x - y`，其范围为 `1 ≤ t ≤ ∛(4N)`。  
2. **快速条件判断**：  
   - `N % t == 0`（`t` 需为 `N` 的因数）。  
   - 计算 `(N/t - t²)` 是否能被 3 整除。  
   - 验证 `Δ = 3xy` 是否为完全平方数。  
3. **整数解验证**：通过 `x = (t + sqrt(Δ)) / 2` 和 `y = (sqrt(Δ) - t) / 2` 得到整数解。  

---

### **同类题目推荐**  
1. **AT_code_formula_2014_qualA_a** - 判断是否为立方数。  
2. **UVA10622** - 分解数为某数的幂次。  
3. **CF633B** - 计算阶乘末尾零的数量（数学推导与枚举结合）。  

---

### **个人心得摘录**  
- **调试教训**：暴力枚举时需注意 `cbrt` 函数的精度问题，改用整数运算避免浮点误差。  
- **数学洞察**：立方差公式的因式分解是突破口，将问题转化为可枚举的因数对。  

---

### **可视化算法演示**  
**动画设计**：  
1. **像素风格界面**：  
   - **背景**：8位网格，显示当前枚举的 `t` 值和计算步骤。  
   - **高亮元素**：  
     - 红色方块：当前正在检查的 `t`。  
     - 绿色方块：满足 `N % t == 0` 的 `t`。  
     - 闪烁特效：找到解时的 `x` 和 `y`。  
2. **控制面板**：  
   - 速度滑块：调节枚举速度。  
   - 单步执行：手动触发每一步计算。  
3. **音效**：  
   - 成功音效：上扬的8位音阶。  
   - 错误音效：短促“哔”声。  

**核心流程演示**：  
1. 枚举 `t` → 检查 `N % t` → 计算 `Δ` → 验证平方数 → 输出解。  

---

### **代码实现（关键片段）**  
```cpp
#include <cmath>
using namespace std;
typedef unsigned long long ll;

bool is_square(ll x) {
    ll r = sqrt(x);
    return r * r == x;
}

void solve(ll N) {
    for (ll t = 1; t * t * t <= 4 * N; t++) {
        if (N % t != 0) continue;
        ll m = N / t;
        ll s = m - t * t;
        if (s % 3 != 0) continue;
        ll xy = s / 3;
        ll delta = t * t + 4 * xy;
        if (!is_square(delta)) continue;
        ll sqrt_delta = sqrt(delta);
        ll x = (t + sqrt_delta) / 2;
        ll y = (sqrt_delta - t) / 2;
        if (x > 0 && y > 0 && x*x*x - y*y*y == N) {
            cout << x << " " << y << endl;
            return;
        }
    }
    cout << -1 << endl;
}
```

---
处理用时：82.02秒
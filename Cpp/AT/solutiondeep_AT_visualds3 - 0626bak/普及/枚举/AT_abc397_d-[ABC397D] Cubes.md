# 题目信息

# [ABC397D] Cubes

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc397/tasks/abc397_d

给定一个正整数 $N$。请判断是否存在满足 $x^3 - y^3 = N$ 的正整数对 $(x, y)$。若存在，请输出其中一个这样的 $(x, y)$。

## 说明/提示

### 约束条件

- $1 \leq N \leq 10^{18}$
- 输入均为整数

### 样例解释 1

因为 $12^3 - 11^3 = 397$，所以 $(x, y) = (12, 11)$ 是正确答案之一。

### 样例解释 2

不存在满足 $x^3 - y^3 = 1$ 的正整数对 $(x, y)$，因此输出 `-1`。

翻译由 DeepSeek R1 完成

## 样例 #1

### 输入

```
397```

### 输出

```
12 11```

## 样例 #2

### 输入

```
1```

### 输出

```
-1```

## 样例 #3

### 输入

```
39977273855577088```

### 输出

```
342756 66212```

# AI分析结果



### 唯一算法分类  
**数学+枚举**

---

### 题解思路、算法要点与解决难点  
#### 核心算法流程  
1. **立方差公式分解**：将问题转化为寻找因数对 $t \cdot (x^2+xy+y^2)=N$  
2. **枚举差值 $t=x-y$**：由 $t^3 < N$ 得 $t$ 的范围为 $\mathcal{O}(\sqrt[3]{N})$  
3. **代数变形**：设 $x=y+t$，代入得二次方程，通过判别式 $\Delta$ 判断是否存在整数解  
4. **验证整数解**：计算 $y$ 是否为正整数，最终输出合法解  

#### 解决难点  
- **大数溢出处理**：使用 `__int128` 或 `unsigned long long`  
- **判别式开方精度**：用二分法或整数平方根判断避免浮点误差  
- **高效枚举优化**：通过 $t^3 \le 4N$ 缩小枚举范围  

---

### 题解评分 (≥4星)  
1. **yuhong056 (5星)**  
   - **亮点**：通过因式分解与几何图解直观展示数学推导，代码结构清晰，时间复杂度严格 $\mathcal{O}(\sqrt[3]{N})$  
   - **代码**：枚举 $t$ 并验证代数条件，最终判断二次方程解  

2. **Clover_Lin (4星)**  
   - **亮点**：将问题转化为方程组求解，代码实现简洁，利用 `sqrt` 快速判断完全平方数  
   - **代码**：枚举因数 $b$，计算 $3a^2+b^2$ 是否为完全平方数  

3. **xixisuper (4星)**  
   - **亮点**：换元法直接推导二次方程，代码逻辑简明，适合快速实现  
   - **代码**：直接代入 $x=y+a$ 并解二次方程  

---

### 最优思路与技巧提炼  
1. **差值枚举法**：枚举 $t=x-y$，时间复杂度从 $\mathcal{O}(N)$ 降为 $\mathcal{O}(\sqrt[3]{N})$  
2. **代数变形**：将立方差分解为二次方程，利用判别式快速验证整数解  
3. **完全平方优化**：通过整数平方根判断 $\Delta$，避免浮点运算误差  

---

### 同类型题推荐  
1. **P1143 立方数**：判断一个数是否为立方数，需快速开立方  
2. **P2423 分解因数**：枚举因数组合的数学优化  
3. **ABC191D Circle Lattice Points**：判别式与整数解判断  

---

### 可视化与算法演示  
#### 动画设计  
1. **像素风格界面**：  
   - **网格绘制**：用 16x16 像素块表示 $t$ 的枚举过程，高亮当前 $t$  
   - **立方体分解**：用不同颜色块表示 $(x^3 - y^3)$ 的几何分解过程  

2. **关键步骤高亮**：  
   - **当前 $t$ 值**：红色边框标记正在验证的 $t$  
   - **判别式计算**：绿色动态显示 $\Delta$ 的计算与开方结果  

3. **音效与反馈**：  
   - **正确解**：播放 8-bit 胜利音效，屏幕闪烁  
   - **无效 $t$**：播放短促“错误”音效，$t$ 标记为灰色  

#### 交互控制  
```javascript
// 伪代码示例：自动演示模式  
function autoRun() {
  for (let t = 1; t * t * t <= 4 * N; t++) {
    highlightCurrentT(t); // 高亮当前t
    if (N % t !== 0) continue;
    let delta = calculateDelta(t); // 计算判别式
    if (!isPerfectSquare(delta)) continue;
    let y = solveY(t, delta); // 解y
    if (valid(y)) {
      playSuccessSound();
      showResult(t + y, y);
      return;
    }
  }
  playFailSound();
}
```

---

### 代码片段（核心逻辑）  
```cpp
// yuhong056 题解核心代码
for (ll i = 1; i * i * i < n; i++) {
    if (n % i) continue;
    ll j = n / i - i * i; // 3xy
    if (j % 3) continue;
    j /= 3;
    ll x_add_y = sqrt(i * i + j * 4);
    if ((i + x_add_y) % 2) continue;
    ll x = (i + x_add_y) / 2, y = (x_add_y - i) / 2;
    if (x * x + x * y + y * y == n / i) {
        cout << x << ' ' << y;
        return 0;
    }
}
```

---

### 个人心得摘录  
- **调试教训**：直接使用 `cbrt` 函数可能因精度问题导致错误（如样例2的N=1）  
- **优化技巧**：通过 $t^3 \le 4N$ 而非 $t^3 \le N$ 缩小枚举范围，避免漏解

---
处理用时：70.01秒
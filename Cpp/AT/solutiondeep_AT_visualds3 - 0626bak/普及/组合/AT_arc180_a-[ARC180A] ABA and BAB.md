# 题目信息

# [ARC180A] ABA and BAB

## 题目描述

[problemUrl]: https://atcoder.jp/contests/arc180/tasks/arc180_a

`A`, `B` からなる長さ $ N $ の文字列 $ S $ が与えられます．

あなたは以下の $ 2 $ 種類の操作を好きな順序で $ 0 $ 回以上繰り返すことができます．

- $ S $ の中で `ABA` となっている (連続した) 部分を選び，それを `A` で置き換える．
- $ S $ の中で `BAB` となっている (連続した) 部分を選び，それを `B` で置き換える．
 
操作後の $ S $ としてあり得る文字列の個数を $ 10^9+7 $ で割ったあまりを求めてください．

## 说明/提示

### 制約

- $ 1\ \leq\ N\ \leq\ 250000 $
- $ S $ は `A`, `B` からなる長さ $ N $ の文字列
 
### Sample Explanation 1

操作後の $ S $ としてあり得るのは以下の $ 2 $ 種類の文字列です． - `ABAB`: $ 0 $ 回の操作を行うことでこの文字列を得ることができます． - `AB`: $ S= $`ABAB` の $ 1 $ 文字目から $ 3 $ 文字目までが `ABA` となっています．これを `A` で置き換えると $ S= $`AB` となります． なお，$ S= $`ABAB` の $ 2 $ 文字目から $ 4 $ 文字目までが `BAB` となっているので，これを `B` に置き換える操作も可能です． ただし，その結果得られる `AB` は重複して数えないことに注意してください．

### Sample Explanation 2

操作を $ 1 $ 度も行うことができません．

### Sample Explanation 4

$ 10^9+7 $ で割ったあまりを求めるのを忘れないようにしてください．

## 样例 #1

### 输入

```
4

ABAB```

### 输出

```
2```

## 样例 #2

### 输入

```
1

A```

### 输出

```
1```

## 样例 #3

### 输入

```
17

BBABABAABABAAAABA```

### 输出

```
18```

## 样例 #4

### 输入

```
100

ABAABAABABBABAABAABAABABBABBABBABBABBABBABBABBABBABBABBABBABBABBABAABABAABABBABBABABBABAABAABAABAABA```

### 输出

```
415919090```

# AI分析结果



---

**算法分类**：字符串处理与乘法原理

---

### **题解思路与算法要点**
1. **核心思路**：将原字符串分割为多个极长的交替字符段（如 `ABABAB` 或 `BABA`），每个段的可能结果数目为 `ceil(段长度/2)`，最终结果通过乘法原理相乘。
2. **实现要点**：
   - **分割条件**：遍历字符串，遇到连续两个相同字符时分割当前段。
   - **贡献计算**：每段的贡献值为 `(段长度 + 1) // 2`。
3. **解决难点**：
   - 正确识别交替段的边界，确保分割后的段相互独立。
   - 快速计算每段的贡献，避免重复或遗漏。

---

### **题解评分（≥4星）**
1. **Ratio_Y（5星）**  
   - **亮点**：代码简洁高效，正确分割交替段并通过向上取整计算贡献。
2. **longhaoyuan（4星）**  
   - **亮点**：思路清晰，代码直接处理分割逻辑，注释明确。
3. **Genius_Star（4星）**  
   - **亮点**：预处理递推函数优化计算，逻辑清晰。

---

### **最优思路与技巧**
- **交替段分割**：将字符串分割为极长的 `AB` 交替段，每段独立处理。
- **贡献公式**：每段贡献为 `ceil(段长度/2)`，快速计算避免复杂动态规划。
- **乘法原理**：将各段贡献相乘，复杂度为线性时间。

---

### **类似算法题目**
1. **替换子串计数**（如 LeetCode 题：替换后的最长重复字符）
2. **字符串分段乘法**（如 Codeforces 题：分段计算哈希值）
3. **极长子序列处理**（如洛谷 P1115 最大子段和）

---

### **推荐题目**
1. **洛谷 P2679**（子串计数与分段处理）
2. **LeetCode 647**（回文子串的分割与计数）
3. **Codeforces 1326D**（字符串前缀与后缀处理）

---

### **可视化算法演示**
**动画设计**：
1. **像素风格展示**：字符 `A` 用绿色方块，`B` 用蓝色方块，交替段用闪烁边框标记。
2. **步进遍历**：高亮当前字符，遇到相同字符时分割段并显示贡献值。
3. **动态乘积面板**：实时显示各段贡献及总结果，支持暂停/继续。

**复古效果**：
- **8位音效**：分割时播放“哔”声，贡献计算时播放“叮”声。
- **Canvas 绘制**：网格显示字符，分割段用不同颜色填充。
- **自动演示**：按固定速度遍历字符串，用户可调整速度或单步执行。

---

### **核心代码实现**
```cpp
#include <bits/stdc++.h>
using namespace std;
const int mod = 1e9 + 7;

int main() {
    int n;
    string s;
    cin >> n >> s;
    long long ans = 1;
    int cnt = 1; // 当前段的长度

    for (int i = 1; i < n; i++) {
        if (s[i] != s[i - 1]) {
            cnt++;
        } else {
            ans = ans * ((cnt + 1) / 2) % mod;
            cnt = 1;
        }
    }
    ans = ans * ((cnt + 1) / 2) % mod;
    cout << ans << endl;
    return 0;
}
```

**核心逻辑**：遍历字符串，统计交替段长度，遇到连续相同字符时分割段并计算贡献。最终结果取模输出。

---

### **总结**
本题通过巧妙的分段策略和乘法原理，将复杂操作转化为线性遍历问题。可视化设计结合复古像素风格与动态交互，直观展示算法流程，适合教学与自测。

---
处理用时：159.57秒
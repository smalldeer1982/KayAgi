# 题目信息

# [ARC186A] Underclued

## 题目描述

[problemUrl]: https://atcoder.jp/contests/arc186/tasks/arc186_a

各成分が $ 0,1 $ である $ N $ 次正方行列 $ A,B $ について、以下の条件を満たしているとき $ A $ と $ B $ は **似ている** と言います。

- 各行の総和が等しい。つまり、どの $ i=1,\dots,N $ についても $ A_{i,1}\ +\ \dots\ +\ A_{i,N}\ =\ B_{i,1}\ +\ \dots\ +\ B_{i,N} $
- 各列の総和が等しい。つまり、どの $ j=1,\dots,N $ についても $ A_{1,j}\ +\ \dots\ +\ A_{N,j}\ =\ B_{1,j}\ +\ \dots\ +\ B_{N,j} $

また、各成分が $ 0,1 $ である $ N $ 次正方行列 $ A $ と整数 $ i,j $ ($ 1\ \leq\ i,j\ \leq\ N $) について、$ A $ と似ているどの行列 $ B $ についても $ A_{i,j}\ =\ B_{i,j} $ が成り立つとき、$ A $ の $ i $ 行 $ j $ 列成分は **固定されている** と言います。

以下の $ Q $ 個のクエリに答えてください。

- $ i $ 番目のクエリ：各成分が $ 0,1 $ である $ N $ 次正方行列であって、固定されている成分がちょうど $ K_i $ 個であるようなものが存在するなら `Yes`、そうでないなら `No` を出力せよ。

## 说明/提示

### 制約

- $ 2\ \le\ N\ \le\ 30 $
- $ 1\ \le\ Q\ \le\ N^2+1 $
- $ 0\ \le\ K_i\ \le\ N^2 $
- $ K_i\ \ne\ K_j\ (1\ \le\ i\ <\ j\ \le\ Q) $
- 入力はすべて整数

### Sample Explanation 1

$ 1 $ 番目のクエリ： 例えば、以下のような行列 $ X $ は、固定されている成分が $ 0 $ 個です。 ``` 1 0 0 0 1 0 0 0 1 ``` なぜなら、次のように列を循環シフトさせていったものはすべて $ X $ と似ており、どの成分も $ 0 $ にも $ 1 $ にもなりうるためです。 ``` 0 0 1 1 0 0 0 1 0 ``` ``` 0 1 0 0 0 1 1 0 0 ``` $ 2 $ 番目のクエリ： 例えば、以下のような行列 $ X $ は、固定されている成分が $ 9 $ 個です。 ``` 0 0 1 0 1 1 1 1 1 ``` なぜなら、似ている行列は $ X $ 以外に存在せず、すべての成分が固定されているためです。 $ 3 $ 番目のクエリ： 固定されている成分がちょうど $ 7 $ 個であるような行列は存在しません。

## 样例 #1

### 输入

```
3 3
0
9
7```

### 输出

```
Yes
Yes
No```

## 样例 #2

### 输入

```
29 6
186
681
18
108
123
321```

### 输出

```
No
Yes
No
Yes
No
Yes```

# AI分析结果



无算法分类

---

### **综合分析与结论**

**题目核心思路**  
题目要求判断存在恰好 $K_i$ 个固定点的 $N×N$ 矩阵。固定点定义为：在满足行列和相同的所有相似矩阵中，该位置的值始终不变。  
通过分析，固定点对应二分图中不在任何环上的边。环边可通过翻转方向生成等价矩阵，而非环边无法翻转，故其值固定。

**核心难点**  
1. **模型构建**：将矩阵元素映射为二分图中的边，0/1 对应边的方向，相似性等价于每个点的出入度相同。  
2. **固定点判定**：固定点对应不在任何环上的边，需统计这些边的数量。  
3. **动态规划处理**：通过 DP 预处理所有可能的环边组合，判断给定 $K_i$ 是否可行。

**解决方案**  
- **二分图建模**：将矩阵元素转换为二分图边，环边可翻转，非环边固定。  
- **动态规划预处理**：定义 $f_{i,j,k}$ 表示左右部分分别选 $i,j$ 个点时，环边数为 $k$ 的可行性。枚举强连通分量大小转移。  
- **查询处理**：对每个 $K_i$，判断是否存在 $n^2 - K_i$ 的环边数。

---

### **题解清单 (≥4星)**

1. **解方橙 (5星)**  
   - **亮点**：构造矩形区域解释不固定点的分布，结合 DP 处理多个矩形组合，思路直观且代码简洁。  
   - **关键代码**：通过二维矩形面积和动态规划判断 $K_i$ 是否可达。  
   ```cpp
   void answer(int k){
       for(int i=0;i<=n;i++) for(int j=0;j<=n;j++) 
           if(f[i][j][n*n-k]) return Yes();
       No();
   }
   ```

2. **Petit_Souris (4星)**  
   - **亮点**：明确二分图模型与环边的关系，指出固定点对应非环边，给出 DP 转移框架。  
   - **心得引用**：“不动点的数量等价于图上不在任何环上的边的数量”。

3. **lfxxx (4星)**  
   - **亮点**：代码实现简洁，直接枚举强连通分量大小转移，清晰展示 DP 核心逻辑。  
   ```cpp
   for(int u=0;u<=i;u++) for(int v=0;v<=j;v++){
       if(u*v >k) continue;
       f[i][j][k] |= f[i-u][j-v][k-u*v];
   }
   ```

---

### **最优思路或技巧提炼**

1. **二分图建模**：将矩阵元素映射为边方向，相似性等价于度数一致。  
2. **环边判定**：固定点对应非环边，统计环边数即 $n^2 - K_i$。  
3. **动态规划优化**：预处理所有可能的环边组合，快速回答查询。  

---

### **同类型题推荐**

1. **洛谷 P3387**（强连通分量与动态规划结合）  
2. **洛谷 P6064**（矩阵行列和约束问题）  
3. **洛谷 P5025**（二分图与环边性质应用）

---

### **可视化与算法演示**

**核心动态规划过程**  
1. **Canvas 网格绘制**：以二维网格表示左右部分点数 $(i,j)$，颜色标记每个状态 $f_{i,j,k}$ 是否可达。  
2. **环边贡献动画**：当新增 $u×v$ 的强连通分量时，高亮对应网格区域并更新环边数。  
3. **查询交互**：输入 $K_i$ 后，遍历所有 $(i,j)$ 并高亮匹配的 $n^2 - K_i$ 状态。  

**复古像素风格设计**  
- **颜色方案**：使用 8-bit 色调（如 #FF0000 表示可达，#0000FF 表示不可达）。  
- **音效触发**：状态更新时播放“哔”声，成功匹配时播放胜利音效。  

---

### **核心代码实现**

```cpp
#include <bits/stdc++.h>
using namespace std;

int n, q;
bitset<901> dp[31][31]; // dp[i][j][k] 表示左右选i,j点，环边数k是否可行

int main() {
    cin >> n >> q;
    dp[0][0][0] = 1;
    for (int i = 1; i <= n; i++)
    for (int j = 1; j <= n; j++)
    for (int x = 0; x < i; x++)
    for (int y = 0; y < j; y++)
        dp[i][j] |= dp[x][y] << ((i-x)*(j-y));
    
    while (q--) {
        int k; cin >> k;
        bool ok = false;
        for (int i = 0; i <= n; i++)
        for (int j = 0; j <= n; j++)
            if (dp[i][j][n*n - k]) ok = true;
        cout << (ok ? "Yes" : "No") << endl;
    }
}
```

**代码说明**  
- **预处理**：枚举所有可能的强连通分量 $(x,y)$，更新环边数。  
- **查询**：对每个 $K_i$，检查是否存在 $n^2 - K_i$ 的环边组合。  

---

**总结**：通过二分图建模与动态规划预处理，将问题转化为环边数统计，时间复杂度 $O(n^6)$，适用于 $n \leq 30$。

---
处理用时：73.45秒
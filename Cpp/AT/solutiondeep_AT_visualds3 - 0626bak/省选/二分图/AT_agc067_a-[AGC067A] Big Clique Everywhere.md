# 题目信息

# [AGC067A] Big Clique Everywhere

## 题目描述

[problemUrl]: https://atcoder.jp/contests/agc067/tasks/agc067_a

$ 1 $ から $ N $ までの番号がついた $ N $ 頂点の単純無向グラフ $ G $ が与えられます。 $ G $ は $ M $ 本の辺を持ち、$ i $ 本目の辺は頂点 $ A_i $ と $ B_i $ を結びます。

$ G $ が次の条件を満たすか判定してください。

- 頂点集合 $ \{1,2,\cdots,N\} $ のすべての部分集合 $ X $ に対して、$ X $ の部分集合 $ Y $ であって $ |Y|\ge\ \frac{|X|}{2} $ かつ $ Y $ がクリークを形成するものが存在する。

解くべきテストケースは $ T $ 個あります。

## 说明/提示

### 制約

- $ 1\le\ T\ \le\ 10^3 $
- $ 1\le\ N\ \le\ 10^5 $
- $ 0\ \le\ M\ \le\ 10^6 $
- $ 1\ \le\ A_i,B_i\ \le\ N $
- 与えられるグラフは自己辺も多重辺も含まない。
- ひとつの入力の中のテストケースすべてにわたる $ N $ の総和は $ 10^5 $ 以下である。
- ひとつの入力の中のテストケースすべてにわたる $ M $ の総和は $ 10^6 $ 以下である。
- すべての入力値は整数である。

### Sample Explanation 1

$ 1 $ 番目のテストケースについて、$ G $ は条件を満たします。 この場合、すべての部分集合 $ X $ がクリークであるため、単に $ Y=X $ とできます。 $ 2 $ 番目のテストケースについて、$ G $ は条件を満たします。 例えば、$ X=\{2,3\} $ に対しては、$ Y=\{2\} $ とできます。 $ 4 $ 番目のテストケースについて、$ G $ は条件を満たしません。 $ X=\{1,2,3\} $ とすると、条件を満たす $ X $ の部分集合 $ Y $ はありません。

## 样例 #1

### 输入

```
4
3 3
1 2
1 3
2 3
3 2
1 2
1 3
3 1
1 2
3 0```

### 输出

```
Yes
Yes
Yes
No```

# AI分析结果



# 算法分类
图论-二分图判定

---

## 题解思路与核心难点
### 核心思路
将原问题转换为补图判定：原图的每个子集存在大团 ⟺ 补图的每个子集存在大独立集。补图必须是二分图，否则存在奇环导致某些子集无法满足条件。通过数学分析发现，当n过大时补图必然无法满足二分图条件，可直接排除，从而将问题规模限制在可处理范围内。

### 解决难点
1. **补图转换思维**：将原问题转换为补图独立集问题需要突破性思维
2. **规模限制推导**：利用二分图最大边数公式 n²/4，推导出当n > √(4m+1)+1 时必定无解
3. **高效染色实现**：在限定规模后，用邻接矩阵+DFS/BFS实现O(n²)二分图判定

---

## 题解评分（≥4星）

1. **Filberte（★★★★☆）**
   - 亮点：清晰的邻接矩阵实现，阈值判断准确，代码结构简洁
   - 核心代码：
     ```cpp
     bool dfs(int u, int c){
         col[u] = c;
         for(int v=1; v<=n; v++){
             if(v==u || !e[u][v]) continue;
             if(col[v]){
                 if(col[v]==c) return 0;
                 continue;
             }
             if(!dfs(v,-c)) return 0;
         }
         return 1;
     }
     ```

2. **Phartial（★★★★☆）**
   - 亮点：数学推导完整，阈值选择与边数分析严谨
   - 关键结论：当n≥2002时直接判定无解

3. **WorldMachine（★★★★☆）**
   - 亮点：独立集与二分图关系解释透彻，代码包含动态清空处理
   - 核心判断：
     ```cpp
     if(n > 2002) return void(puts("No"));
     ```

---

## 最优思路提炼
1. **补图转换**：将团问题转换为独立集问题
2. **二分图性质**：利用二分图两部点集必有一部≥半数
3. **规模控制**：通过max(n²/4)推导阈值，将复杂度降至O(m)
4. **染色剪枝**：DFS染色时发现冲突立即回溯

---

## 同类型题推荐
1. P1330 封锁阳光大学（二分图判定基础）
2. P1525 关押罪犯（二分图判定应用）
3. P3386 二分图最大匹配（增广路算法）

---

## 可视化设计
### 动画方案
1. **补图构造阶段**：在8-bit网格中，原图边显示为蓝色，补图边显示为红色闪烁
2. **染色过程**：当前节点显示为闪烁方块，已染色节点用绿/黄两色区分两部
3. **冲突检测**：发现同色相邻时触发红色闪光与"error"音效

### 复古元素
- **像素网格**：用16x16像素块表示节点，边用1px线条绘制
- **音效设计**：
  - 染色成功：8-bit上升音阶
  - 发现冲突：FC游戏"中弹"音效
  - 完成判定：马里奥过关音效
- **自动演示**：按BFS顺序自动遍历节点，支持空格键暂停/继续

---

## 核心代码实现
```cpp
// 邻接矩阵版（Filberte改进版）
const int MAXN = 2005;
bool graph[MAXN][MAXN]; // 补图存储
int color[MAXN];

bool isBipartite(int n) {
    memset(color, 0, sizeof(color));
    for(int u=1; u<=n; ++u) {
        if(!color[u]) {
            queue<int> q;
            q.push(u);
            color[u] = 1;
            while(!q.empty()) {
                int cur = q.front(); q.pop();
                for(int v=1; v<=n; ++v) {
                    if(graph[cur][v]) {
                        if(!color[v]) {
                            color[v] = -color[cur];
                            q.push(v);
                        } else if(color[v] == color[cur]) {
                            return false;
                        }
                    }
                }
            }
        }
    }
    return true;
}
```

---
处理用时：102.59秒
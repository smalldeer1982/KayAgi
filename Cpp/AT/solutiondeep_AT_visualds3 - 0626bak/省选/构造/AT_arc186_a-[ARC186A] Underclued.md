# 题目信息

# [ARC186A] Underclued

## 题目描述

[problemUrl]: https://atcoder.jp/contests/arc186/tasks/arc186_a

各成分が $ 0,1 $ である $ N $ 次正方行列 $ A,B $ について、以下の条件を満たしているとき $ A $ と $ B $ は **似ている** と言います。

- 各行の総和が等しい。つまり、どの $ i=1,\dots,N $ についても $ A_{i,1}\ +\ \dots\ +\ A_{i,N}\ =\ B_{i,1}\ +\ \dots\ +\ B_{i,N} $
- 各列の総和が等しい。つまり、どの $ j=1,\dots,N $ についても $ A_{1,j}\ +\ \dots\ +\ A_{N,j}\ =\ B_{1,j}\ +\ \dots\ +\ B_{N,j} $

また、各成分が $ 0,1 $ である $ N $ 次正方行列 $ A $ と整数 $ i,j $ ($ 1\ \leq\ i,j\ \leq\ N $) について、$ A $ と似ているどの行列 $ B $ についても $ A_{i,j}\ =\ B_{i,j} $ が成り立つとき、$ A $ の $ i $ 行 $ j $ 列成分は **固定されている** と言います。

以下の $ Q $ 個のクエリに答えてください。

- $ i $ 番目のクエリ：各成分が $ 0,1 $ である $ N $ 次正方行列であって、固定されている成分がちょうど $ K_i $ 個であるようなものが存在するなら `Yes`、そうでないなら `No` を出力せよ。

## 说明/提示

### 制約

- $ 2\ \le\ N\ \le\ 30 $
- $ 1\ \le\ Q\ \le\ N^2+1 $
- $ 0\ \le\ K_i\ \le\ N^2 $
- $ K_i\ \ne\ K_j\ (1\ \le\ i\ <\ j\ \le\ Q) $
- 入力はすべて整数

### Sample Explanation 1

$ 1 $ 番目のクエリ： 例えば、以下のような行列 $ X $ は、固定されている成分が $ 0 $ 個です。 ``` 1 0 0 0 1 0 0 0 1 ``` なぜなら、次のように列を循環シフトさせていったものはすべて $ X $ と似ており、どの成分も $ 0 $ にも $ 1 $ にもなりうるためです。 ``` 0 0 1 1 0 0 0 1 0 ``` ``` 0 1 0 0 0 1 1 0 0 ``` $ 2 $ 番目のクエリ： 例えば、以下のような行列 $ X $ は、固定されている成分が $ 9 $ 個です。 ``` 0 0 1 0 1 1 1 1 1 ``` なぜなら、似ている行列は $ X $ 以外に存在せず、すべての成分が固定されているためです。 $ 3 $ 番目のクエリ： 固定されている成分がちょうど $ 7 $ 個であるような行列は存在しません。

## 样例 #1

### 输入

```
3 3
0
9
7```

### 输出

```
Yes
Yes
No```

## 样例 #2

### 输入

```
29 6
186
681
18
108
123
321```

### 输出

```
No
Yes
No
Yes
No
Yes```

# AI分析结果



**算法分类选择**  
动态规划

---

**题解思路、算法要点与解决难点**  
**核心思路**：将问题转化为二分图环边计数问题。固定点数量等于总边数减去所有强连通分量中的边数之和。通过动态规划枚举可能的强连通分量组合，判断是否存在满足条件的环边数目。

**算法要点**：  
1. **二分图建模**：将01矩阵映射为完全二分图，边的方向由矩阵值决定。相似矩阵对应相同度数分布。  
2. **固定点判定**：若边不在任何环上，则其方向无法改变，对应固定点。  
3. **动态规划转移**：设状态 `f[i][j][k]` 表示用i行j列形成k条环边是否可行。枚举新增的强连通分量（u行v列），其贡献环边数为 `u*v`。  

**解决难点**：  
- 正确建模环边与固定点的关系  
- 避免重复计算强连通分量  
- 处理大范围状态转移（用bitset优化）  

---

**题解评分 (≥4星)**  
1. **解方橙 (5星)**  
   - 思路清晰，构造法直观  
   - 代码简洁，二维背包转移易理解  
   - 通过矩形面积组合解释环边计算  

2. **lalaouye (4星)**  
   - 使用bitset优化状态转移  
   - 代码高效，时间复杂度 `O(n^6/w)`  
   - 强连通分量枚举逻辑清晰  

3. **Iniaugoty (4星)**  
   - 详细推导二分图强连通条件  
   - 明确动态规划状态转移方程  
   - 结合图论与DP的完整思路  

---

**最优思路或技巧提炼**  
- **二分图强连通分量计数**：环边数目等于所有强连通分量面积之和  
- **二维背包DP**：枚举行、列占用情况，组合不同分量的贡献  
- **bitset优化**：快速处理大范围状态转移  

---

**同类型题或类似算法套路**  
- **二维背包问题**：如覆盖特定面积的多物品组合  
- **强连通分量分解**：如Tarjan算法中的分量划分  
- **图论模型转换**：将矩阵问题转化为图结构分析  

---

**推荐题目**  
1. [P1776 宝物筛选](https://www.luogu.com.cn/problem/P1776)（多重背包优化）  
2. [P2831 愤怒的小鸟](https://www.luogu.com.cn/problem/P2831)（状态压缩DP）  
3. [P3388 割点](https://www.luogu.com.cn/problem/P3388)（强连通分量应用）  

---

**个人心得摘录**  
> "当发现行/列和约束时，立即想到度数建模。二分图环分析是突破关键。" —— Iniaugoty  
> "样例2的108=29²-733暗示矩形面积组合的可行性，需反向思考环边总和。" —— 解方橙  

---

**可视化与算法演示**  
**动画方案**：  
1. **网格绘制**：在Canvas中以网格表示矩阵，固定点标记为红色，环边区域标记为动态色块。  
2. **强连通分量高亮**：新增分量时，用闪烁边框突出其行列范围，显示环边数增量。  
3. **自动演示模式**：按行、列逐步扩展，显示当前环边总数及剩余可用区域。  

**交互设计**：  
- **速度调节**：滑动条控制动画步频  
- **音效触发**：  
  - 新增分量：短促“滴”声  
  - 完成匹配：胜利音效  
- **状态面板**：实时显示当前i/j/k值及剩余可行解  

---

**核心代码片段（解方橙）**  
```cpp
bool f[35][35][905]; // f[i][j][k]: i行j列能否组成k环边
void precompute() {
    f[0][0][0] = true;
    for (int i = 1; i <= n; i++) {
        for (int j = 1; j <= n; j++) {
            for (int k = 0; k <= i*j; k++) {
                if (k == i*j && (i>=2 || j>=2)) f[i][j][k] = true;
                else {
                    for (int x = 0; x < i; x++) {
                        for (int y = 0; y < j; y++) {
                            int area = (i-x)*(j-y);
                            if (k >= area && f[x][y][k-area]) {
                                f[i][j][k] = true;
                                break;
                            }
                        }
                    }
                }
            }
        }
    }
}
```

---

**复古游戏化动画效果**  
- **像素风格**：8-bit网格，环边区域用绿色像素块填充，固定点为红色方块。  
- **自动AI演示**：按DP转移顺序逐步填充矩阵，背景播放复古芯片音乐。  
- **关卡制**：每完成一个K值验证解锁下一关，积分依据剩余可行解数量。

---
处理用时：235.14秒
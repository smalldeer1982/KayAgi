# é¢˜ç›®ä¿¡æ¯

# [ABC372G] Ax + By < C

## é¢˜ç›®æè¿°

### é¢˜ç›®ç®€è¿°

ç»™å®šä¸‰ä¸ªæ•°åˆ— $(A_1, A_2, \cdots, A_N)$ï¼Œ$(B_1, B_2, \cdots, B_N)$ï¼Œ$(C_1, C_2, \cdots, C_N)$ï¼Œæ±‚æ»¡è¶³ $A_ix+B_iy<C_i$ ($1 \leq i \leq N$) çš„æœ‰åºæ­£æ•´æ•°å¯¹ $(x,y)$ çš„ä¸ªæ•°ã€‚

## è¯´æ˜/æç¤º

çº¦å®š $1 \leq T \leq 2\times 10^5$ï¼Œ$1 \leq \sum N \leq 2\times 10^5$ï¼Œ$1 \leq A_i, B_i, C_i \leq 10^9$ã€‚

å¯¹äºæ ·ä¾‹ $1$ï¼Œç¬¬ä¸€ä¸ªæ•°æ®ç»„ä¸­æ»¡è¶³æ¡ä»¶çš„ $(x, y)$ æœ‰ $(1, 1)$ å’Œ $(2, 1)$ï¼Œæ•…åº”å½“è¾“å‡º $2$ã€‚ç¬¬äºŒä¸ªæ•°æ®ç»„ä¸­ï¼Œæ²¡æœ‰æ»¡è¶³æ¡ä»¶çš„ $(x, y)$ï¼Œæ•…åº”å½“è¾“å‡º $0$ã€‚

## æ ·ä¾‹ #1

### è¾“å…¥

```
2

2

1 1 4

1 2 5

1

1 1 2```

### è¾“å‡º

```
2

0```

## æ ·ä¾‹ #2

### è¾“å…¥

```
3

7

138 16011 918976

5478 7748 499926

5234 17727 748589

1157 10511 643136

31200 3005 721285

28839 14469 798851

1933 5378 864127

9

17775 1665 386430

37001 863 922418

9756 4182 746671

12379 9106 807578

3984 4049 640539

25333 9869 780810

20372 7000 688738

16107 11974 827227

10779 10531 770510

5

4916 14132 460944

11856 45422 610561

56014 18216 825793

10363 6220 945356

37418 33866 851593```

### è¾“å‡º

```
660

995

140```

# AIåˆ†æç»“æœ

# ğŸ’¡ Kayçš„C++ç®—æ³•è§£æï¼š[ABC372G] Ax + By < C æ·±å…¥å­¦ä¹ æŒ‡å— ğŸ’¡


## 1. é¢˜ç›®è§£è¯»ä¸æ ¸å¿ƒç®—æ³•è¯†åˆ«

âœ¨ **æœ¬é¢˜ä¸»è¦è€ƒå¯Ÿ**ï¼šæ•°å­¦ï¼ˆç±»æ¬§å‡ é‡Œå¾—ç®—æ³•ï¼‰ + ç¼–ç¨‹æŠ€å·§åº”ç”¨ï¼ˆå‡¸å£³ç»´æŠ¤ï¼‰

ğŸ—£ï¸ **åˆæ­¥åˆ†æ**ï¼š  
ç±»æ¬§å‡ é‡Œå¾—ç®—æ³•å°±åƒæ•°å­¦é‡Œçš„â€œè¾—è½¬æ‹†æ‹†ä¹â€â€”â€”æ¯”å¦‚è®¡ç®—âˆ‘âŒŠ(a*i + b)/câŒ‹è¿™æ ·çš„æ±‚å’Œå¼ï¼Œé€šè¿‡é€’å½’æŠŠå¤§ç³»æ•°æ‹†æˆå°ç³»æ•°ï¼Œç›´åˆ°é—®é¢˜å˜å¾—ç®€å•ï¼ˆæ¯”å¦‚a=0æ—¶ç›´æ¥ç®—ï¼‰ã€‚åœ¨æœ¬é¢˜ä¸­ï¼Œæˆ‘ä»¬éœ€è¦è®¡ç®—æ¯ä¸ªxå¯¹åº”çš„yçš„æ•°é‡ï¼ˆy < (C-1 - A*x)/Bï¼‰ï¼Œè¿™åˆšå¥½æ˜¯ç±»æ¬§çš„â€œæ‹¿æ‰‹å¥½æˆâ€ã€‚  

è€Œå‡¸å£³ç»´æŠ¤å°±åƒæ•´ç†ä¸€å †â€œæ–œæœ¨æ¿â€ï¼šæ¯ä¸ªä¸ç­‰å¼å¯¹åº”ä¸€æ¡å‘ä¸‹å€¾æ–œçš„ç›´çº¿ï¼ˆæ–œç‡ä¸ºè´Ÿï¼‰ï¼Œæˆ‘ä»¬æŒ‰æ–œç‡æ’åºåï¼Œç”¨å•è°ƒæ ˆä¿ç•™é‚£äº›åœ¨æŸä¸ªxåŒºé—´å†…â€œæœ€çŸ®â€çš„æœ¨æ¿ï¼ˆå³yçš„ä¸Šé™æœ€å°ï¼‰ã€‚æ¯”å¦‚ï¼Œå½“æ–°æœ¨æ¿æ¯”æ ˆé¡¶æœ¨æ¿æ›´â€œç´§â€ï¼ˆåœ¨æŸä¸ªxä½ç½®yæ›´å°ï¼‰ï¼Œå°±æŠŠæ ˆé¡¶æœ¨æ¿â€œæ‰”æ‰â€ï¼Œç›´åˆ°æ ˆé‡Œçš„æœ¨æ¿éƒ½æ˜¯æœ‰æ•ˆçš„ã€‚  

é¢˜è§£çš„æ ¸å¿ƒæ€è·¯æ˜¯ï¼šâ‘  å°†ä¸ç­‰å¼è½¬åŒ–ä¸ºç›´çº¿ï¼›â‘¡ æ’åºåç”¨å•è°ƒæ ˆç»´æŠ¤å‡¸å£³ï¼›â‘¢ å¯¹æ¯ä¸ªåŒºé—´ç”¨ç±»æ¬§è®¡ç®—yçš„æ•°é‡ã€‚æ ¸å¿ƒéš¾ç‚¹æ˜¯**æ‰¾åˆ°æ¯ä¸ªç›´çº¿çš„æœ‰æ•ˆåŒºé—´**ï¼ˆå‡¸å£³ç»´æŠ¤ï¼‰å’Œ**æ­£ç¡®è®¡ç®—ç±»æ¬§æ±‚å’Œå¼**ï¼ˆå¤„ç†è¾¹ç•Œå’Œè´Ÿæ•°ï¼‰ã€‚è§£å†³æ–¹æ¡ˆæ˜¯ç”¨å•è°ƒæ ˆæ¯”è¾ƒç›´çº¿äº¤ç‚¹çš„é¡ºåºï¼Œç”¨ç±»æ¬§é€’å½’æ‹†åˆ†é—®é¢˜ã€‚  

å¯è§†åŒ–è®¾è®¡æ€è·¯ï¼šç”¨8ä½åƒç´ é£å±•ç¤ºç½‘æ ¼ï¼ˆxè½´æ˜¯xçš„å–å€¼ï¼Œyè½´æ˜¯yçš„å–å€¼ï¼‰ã€‚æ¯æ¡ç›´çº¿ç”¨ä¸åŒé¢œè‰²çš„åƒç´ çº¿è¡¨ç¤ºï¼ˆæ¯”å¦‚è“è‰²ã€ç»¿è‰²ï¼‰ï¼Œæ’åºåâ€œæ»‘å…¥â€å±å¹•ï¼Œå…¥æ ˆæ—¶ä¼´éšâ€œå®â€çš„éŸ³æ•ˆï¼Œå‡ºæ ˆæ—¶â€œå¼¹å‡ºâ€å¹¶ä¼´éšâ€œå•ªâ€çš„éŸ³æ•ˆã€‚å‡¸å£³å½¢æˆåï¼Œæ¯ä¸ªåŒºé—´ç”¨é»„è‰²å—æ ‡è®°ï¼Œç±»æ¬§è®¡ç®—æ—¶ç”¨â€œç¼©å°â€åŠ¨ç”»å±•ç¤ºé—®é¢˜æ‹†åˆ†ï¼ˆæ¯”å¦‚åŸé—®é¢˜ç¼©å°ä¸º1/2å¤§å°ï¼‰ï¼Œä¼´éšâ€œæ»´â€çš„éŸ³æ•ˆã€‚å½“è®¡ç®—å®Œæˆä¸€ä¸ªåŒºé—´ï¼Œé»„è‰²å—å˜ç»¿å¹¶æ’­æ”¾â€œå—¡â€çš„éŸ³æ•ˆï¼Œè¡¨ç¤ºè¿‡å…³ã€‚


## 2. ç²¾é€‰ä¼˜è´¨é¢˜è§£å‚è€ƒ

### é¢˜è§£ä¸€ï¼ˆæ¥æºï¼šNt_Tsumikiï¼‰  
**ç‚¹è¯„**ï¼šè¿™ä»½é¢˜è§£æ€è·¯è¶…æ¸…æ™°ï¼å…ˆæŠŠä¸ç­‰å¼è½¬åŒ–ä¸ºåŠå¹³é¢ï¼Œå†ç”¨ç±»æ¬§è®¡ç®—è´¡çŒ®ã€‚åŠå¹³é¢äº¤çš„æ¨¡æ¿å¤„ç†äº†ç›´çº¿æ’åºå’Œå‡¸å£³ç»´æŠ¤ï¼Œç±»æ¬§å‡½æ•°è¦†ç›–äº†æ‰€æœ‰æƒ…å†µï¼ˆåŒ…æ‹¬è´Ÿæ•°ã€å¤§ç³»æ•°ï¼‰ã€‚ç¾ä¸­ä¸è¶³æ˜¯æµ®ç‚¹ç²¾åº¦å¯èƒ½å¡å£³â€”â€”æ¯”å¦‚ç”¨doubleå­˜æ–œç‡ä¼šæœ‰è¯¯å·®ï¼Œä½†ä½œè€…è´´å¿ƒæé†’â€œå¯ä»¥æ‰‹å†™åˆ†æ•°ç±»â€ã€‚ä»£ç é£æ ¼è§„èŒƒï¼Œå˜é‡åæ˜“æ‡‚ï¼ˆæ¯”å¦‚`f`å‡½æ•°çš„å‚æ•°å¯¹åº”ç±»æ¬§çš„å››ä¸ªè¦ç´ ï¼‰ï¼Œæ˜¯æ–°æ‰‹å­¦ä¹ çš„å¥½ä¾‹å­ã€‚


### é¢˜è§£äºŒï¼ˆæ¥æºï¼šYipChipï¼‰  
**ç‚¹è¯„**ï¼šè¿™ä»½é¢˜è§£çš„æ¨å¯¼å¤ªç»†è‡´äº†ï¼ä»å•å…ƒä¸ç­‰å¼çš„è½¬æ¢ï¼ˆAx+By < C â†’ æ±‚å’Œå¼ï¼‰ï¼Œåˆ°ç±»æ¬§çš„é€’å½’åˆ†æƒ…å†µï¼Œæ¯ä¸€æ­¥éƒ½è®²å¾—æ˜æ˜ç™½ç™½ã€‚æ¯”å¦‚ä¸ºäº†å¤„ç†è´Ÿç³»æ•°ï¼Œä½œè€…ç”¨â€œæ•´ä½“+i-iâ€çš„æŠ€å·§æŠŠè´Ÿç³»æ•°è½¬ä¸ºæ­£ï¼Œé¿å…é€’å½’å‡ºé”™ã€‚ä»£ç ä¸­çš„`calc`å‡½æ•°ç®€æ´é«˜æ•ˆï¼Œå‡¸å£³ç»´æŠ¤ç”¨å•è°ƒæ ˆæ¯”è¾ƒäº¤ç‚¹ï¼Œå¯è¯»æ€§å¾ˆé«˜ã€‚å¯¹äºæƒ³æ·±å…¥ç†è§£ç±»æ¬§çš„åŒå­¦ï¼Œè¿™ä»½é¢˜è§£æ˜¯â€œå®è—â€ï¼


### é¢˜è§£ä¸‰ï¼ˆæ¥æºï¼šanthonyaaabcï¼‰  
**ç‚¹è¯„**ï¼šè¿™ä»½é¢˜è§£çš„æ€è·¯å¾ˆå·§å¦™â€”â€”ç”¨äºŒåˆ†æ³•æ‰¾ä¸¤æ¡ç›´çº¿çš„äº¤ç‚¹ï¼ˆæœ‰æ•ˆåŒºé—´çš„åˆ†ç•Œç‚¹ï¼‰ï¼Œé¿å…äº†å¤æ‚çš„å‡¸å£³æ¨¡æ¿ã€‚ç±»æ¬§å‡½æ•°å¤„ç†äº†è¾¹ç•Œæ¡ä»¶ï¼ˆæ¯”å¦‚n<0æ—¶è¿”å›0ï¼‰ï¼Œäº¤å‰ç›¸ä¹˜æ¯”è¾ƒï¼ˆé¿å…æµ®ç‚¹è¯¯å·®ï¼‰çš„æŠ€å·§å¾ˆå®ç”¨ã€‚ç¾ä¸­ä¸è¶³æ˜¯ç”¨äº†`__int128`å¤„ç†å¤§æ•°ï¼Œä½†è¿™æ˜¯è§£å†³æ•´æ•°æº¢å‡ºçš„å¿…è¦æ‰‹æ®µã€‚æ•´ä½“é€»è¾‘æ¸…æ™°ï¼Œé€‚åˆæƒ³ç»ƒä¹ â€œç®€æ´å®ç°â€çš„åŒå­¦ã€‚


## 3. æ ¸å¿ƒéš¾ç‚¹è¾¨æä¸è§£é¢˜ç­–ç•¥

### å…³é”®ç‚¹1ï¼šå¦‚ä½•å°†ä¸ç­‰å¼è½¬åŒ–ä¸ºç›´çº¿å¹¶ç»´æŠ¤å‡¸å£³ï¼Ÿ  
**åˆ†æ**ï¼šæ¯ä¸ªä¸ç­‰å¼`Ax+By < C`å¯è½¬åŒ–ä¸º`y < (C-1 - Ax)/B`ï¼ˆå› ä¸ºx,yæ˜¯æ­£æ•´æ•°ï¼Œæ‰€ä»¥`Ax+By â‰¤ C-1`ï¼‰ï¼Œå¯¹åº”ç›´çº¿`y = (-A/B)x + (C-1)/B`ï¼ˆæ–œç‡ä¸ºè´Ÿï¼‰ã€‚æ’åºåç”¨å•è°ƒæ ˆç»´æŠ¤å‡¸å£³ï¼šæ–°ç›´çº¿åŠ å…¥æ—¶ï¼Œæ¯”è¾ƒå®ƒä¸æ ˆé¡¶ç›´çº¿çš„äº¤ç‚¹â€”â€”å¦‚æœäº¤ç‚¹åœ¨æ ˆé¡¶ä¸¤æ¡ç›´çº¿äº¤ç‚¹çš„å·¦ä¾§ï¼Œè¯´æ˜æ ˆé¡¶ç›´çº¿æ— æ•ˆï¼Œå¼¹å‡ºæ ˆé¡¶ã€‚  
**å­¦ä¹ ç¬”è®°**ï¼šå‡¸å£³ç»´æŠ¤çš„å…³é”®æ˜¯â€œæ¯”äº¤ç‚¹é¡ºåºâ€ï¼Œä¿ç•™æœ‰æ•ˆçš„é™åˆ¶ã€‚


### å…³é”®ç‚¹2ï¼šå¦‚ä½•æ­£ç¡®è®¡ç®—ç±»æ¬§æ±‚å’Œå¼ï¼Ÿ  
**åˆ†æ**ï¼šç±»æ¬§çš„æ ¸å¿ƒæ˜¯â€œåˆ†æƒ…å†µé€’å½’â€ï¼š  
- å½“a=0æ—¶ï¼Œç›´æ¥ç®—`(b/c)*(n+1)`ï¼›  
- å½“aâ‰¥cæˆ–bâ‰¥cæ—¶ï¼Œæ‹†æˆæ•´æ•°éƒ¨åˆ†ï¼ˆæ¯”å¦‚`a/c * âˆ‘i`ï¼‰å’Œä½™æ•°éƒ¨åˆ†ï¼ˆé€’å½’ç®—`a%c`çš„æƒ…å†µï¼‰ï¼›  
- å½“a<cä¸”b<cæ—¶ï¼Œç”¨å¯¹ç§°æ€§è½¬æ¢ä¸ºå¦ä¸€ä¸ªç±»æ¬§é—®é¢˜ï¼ˆæ¯”å¦‚`n*m - f(c, c-b-1, a, m-1)`ï¼Œå…¶ä¸­`m=(a*n +b)/c`ï¼‰ã€‚  
**å­¦ä¹ ç¬”è®°**ï¼šç±»æ¬§å°±åƒâ€œæ•°å­¦åˆ†æ²»æ³•â€ï¼ŒæŠŠå¤§é—®é¢˜æ‹†å°ï¼Œç›´åˆ°å®¹æ˜“è§£å†³ã€‚


### å…³é”®ç‚¹3ï¼šå¦‚ä½•å¤„ç†è¾¹ç•Œæ¡ä»¶ï¼ˆx,yä¸ºæ­£æ•´æ•°ï¼‰ï¼Ÿ  
**åˆ†æ**ï¼šxå’Œyå¿…é¡»æ˜¯æ­£æ•´æ•°ï¼Œæ‰€ä»¥xçš„å–å€¼èŒƒå›´æ˜¯`1 â‰¤ x â‰¤ min{(C-1 - B)/A}`ï¼ˆå› ä¸ºyâ‰¥1ï¼‰ï¼Œyçš„å–å€¼èŒƒå›´æ˜¯`1 â‰¤ y â‰¤ âŒŠ(C-1 - Ax)/BâŒ‹`ã€‚è®¡ç®—ç±»æ¬§æ—¶ï¼Œéœ€è¦å°†xçš„åŒºé—´è°ƒæ•´åˆ°æœ‰æ•ˆçš„èŒƒå›´å†…ï¼ˆæ¯”å¦‚`l`å’Œ`r`ä¸èƒ½å°äº1ï¼‰ã€‚  
**å­¦ä¹ ç¬”è®°**ï¼šè¾¹ç•Œæ¡ä»¶æ˜¯â€œç»†èŠ‚é™·é˜±â€ï¼Œå¿…é¡»ä»”ç»†æ£€æŸ¥ã€‚


### âœ¨ è§£é¢˜æŠ€å·§æ€»ç»“  
- **é—®é¢˜è½¬åŒ–**ï¼šå°†ä¸ç­‰å¼è½¬åŒ–ä¸ºç›´çº¿ï¼Œå°†è®¡æ•°é—®é¢˜è½¬åŒ–ä¸ºæ±‚å’Œå¼ï¼Œæ˜¯è§£å†³è¿™ç±»é—®é¢˜çš„å…³é”®ã€‚  
- **å‡¸å£³ç»´æŠ¤**ï¼šå¯¹äºæ–œç‡å•è°ƒçš„ç›´çº¿ï¼Œç”¨å•è°ƒæ ˆæ¯”è¾ƒäº¤ç‚¹é¡ºåºï¼Œä¿ç•™æœ‰æ•ˆé™åˆ¶ã€‚  
- **ç±»æ¬§åº”ç”¨**ï¼šé‡åˆ°âˆ‘âŒŠ(a*i + b)/câŒ‹çš„æ±‚å’Œå¼ï¼Œä¼˜å…ˆè€ƒè™‘ç±»æ¬§ï¼Œé¿å…æš´åŠ›è®¡ç®—ã€‚


## 4. C++æ ¸å¿ƒä»£ç å®ç°èµæ

### æœ¬é¢˜é€šç”¨æ ¸å¿ƒC++å®ç°å‚è€ƒ  
**è¯´æ˜**ï¼šæœ¬ä»£ç æ•´åˆäº†å‡¸å£³ç»´æŠ¤å’Œç±»æ¬§è®¡ç®—çš„æ ¸å¿ƒé€»è¾‘ï¼Œå…¼é¡¾æ¸…æ™°æ€§å’Œæ•ˆç‡ã€‚  

```cpp
#include <iostream>
#include <vector>
#include <algorithm>
using namespace std;
typedef long long ll;

// ç±»æ¬§å‡ é‡Œå¾—ç®—æ³•ï¼šè®¡ç®—âˆ‘_{i=0}^n floor((a*i + b)/c)
ll f(ll a, ll b, ll c, ll n) {
    if (n < 0) return 0;
    if (a == 0) return (b / c) * (n + 1);
    if (c < 0) return f(-a, -b, -c, n);
    if (a >= c || b >= c) {
        return (n * (n + 1) / 2) * (a / c) + (n + 1) * (b / c) + f(a % c, b % c, c, n);
    }
    if (a < 0 || b < 0) {
        return (n * (n + 1) / 2) * (a / c - 1) + (n + 1) * (b / c - 1) + f(a % c + c, b % c + c, c, n);
    }
    ll m = (a * n + b) / c;
    return n * m - f(c, c - b - 1, a, m - 1);
}

// ç›´çº¿ç»“æ„ä½“ï¼šAx + By â‰¤ Cï¼ˆC = åŸC-1ï¼‰
struct Line {
    ll A, B, C;
    double k, b; // æ–œç‡ï¼ˆ-A/Bï¼‰å’Œæˆªè·ï¼ˆC/Bï¼‰
    bool operator<(const Line& other) const {
        return k < other.k; // æŒ‰æ–œç‡ä»å°åˆ°å¤§æ’åºï¼ˆæ–œç‡ä¸ºè´Ÿï¼Œå°çš„æ›´é™¡ï¼‰
    }
};

// è®¡ç®—ä¸¤æ¡ç›´çº¿çš„äº¤ç‚¹xåæ ‡ï¼ˆé¿å…æµ®ç‚¹è¯¯å·®ï¼‰
ll intersect_x(const Line& l1, const Line& l2) {
    ll num = l1.C * l2.B - l2.C * l1.B;
    ll den = l1.A * l2.B - l2.A * l1.B;
    return den == 0 ? 1e18 : num / den;
}

int main() {
    ios::sync_with_stdio(false);
    cin.tie(nullptr);
    int T; cin >> T;
    while (T--) {
        int n; cin >> n;
        vector<Line> lines(n);
        ll x_max = 1e18;
        for (int i = 0; i < n; ++i) {
            ll A, B, C; cin >> A >> B >> C;
            C--; // è½¬ä¸ºAx + By â‰¤ C-1
            lines[i] = {A, B, C, -1.0 * A / B, 1.0 * C / B};
            if (C >= B) x_max = min(x_max, (C - B) / A);
            else x_max = 0;
        }
        if (x_max <= 0) { cout << 0 << '\n'; continue; }
        sort(lines.begin(), lines.end());
        
        // å•è°ƒæ ˆç»´æŠ¤å‡¸å£³
        vector<Line> stk;
        for (auto& line : lines) {
            while (stk.size() >= 2) {
                Line& l1 = stk[stk.size()-2];
                Line& l2 = stk[stk.size()-1];
                ll x1 = intersect_x(l1, l2);
                ll x2 = intersect_x(l2, line);
                if (x2 <= x1) stk.pop_back();
                else break;
            }
            stk.push_back(line);
        }
        
        // è®¡ç®—æ¯ä¸ªåŒºé—´çš„è´¡çŒ®
        ll ans = 0, prev_x = 1;
        for (int i = 0; i < stk.size(); ++i) {
            Line& line = stk[i];
            ll curr_x = (i == stk.size()-1) ? x_max : intersect_x(line, stk[i+1]);
            if (prev_x > curr_x) continue;
            ll l = prev_x, r = min(curr_x, x_max);
            ll m = r - l;
            ll a = -line.A, b = line.C - line.A * l, c = line.B;
            ans += f(a, b, c, m);
            prev_x = r + 1;
        }
        cout << ans << '\n';
    }
    return 0;
}
```  
**ä»£ç è§£è¯»æ¦‚è¦**ï¼š  
1. è¯»å–è¾“å…¥å¹¶è½¬åŒ–ä¸ºç›´çº¿ï¼ˆ`C--`å¤„ç†æ•´æ•°æ¡ä»¶ï¼‰ï¼›  
2. è®¡ç®—xçš„ä¸Šé™ï¼ˆyâ‰¥1æ—¶xçš„æœ€å¤§å€¼ï¼‰ï¼›  
3. æ’åºç›´çº¿åç”¨å•è°ƒæ ˆç»´æŠ¤å‡¸å£³ï¼›  
4. éå†å‡¸å£³çš„æ¯ä¸ªåŒºé—´ï¼Œç”¨ç±»æ¬§è®¡ç®—yçš„æ•°é‡ï¼Œç´¯åŠ å¾—åˆ°ç­”æ¡ˆã€‚


### é¢˜è§£ä¸€ï¼ˆæ¥æºï¼šNt_Tsumikiï¼‰  
**äº®ç‚¹**ï¼šç±»æ¬§å‡½æ•°è¦†ç›–æ‰€æœ‰æƒ…å†µï¼ˆåŒ…æ‹¬è´Ÿæ•°ï¼‰ã€‚  
**æ ¸å¿ƒä»£ç ç‰‡æ®µ**ï¼š  
```cpp
LL f(LL a, LL b, LL c, LL n) {
    if (!n) return b/c;
    else if (a==0) return (n+1)*(b/c);
    else if (c<0) return f(-a,-b,-c,n);
	else if (a>=c or b>=c) return (n*(n+1)/2)*(a/c)+(n+1)*(b/c)+f(a%c,b%c,c,n);
	else if (a<0 or b<0) return (n*(n+1)/2)*(a/c-1)+(n+1)*(b/c-1)+f(a%c+c,b%c+c,c,n);
	else return n*((a*n+b)/c)-f(c,c-b-1,a,((a*n+b)/c)-1);
}
```  
**ä»£ç è§£è¯»**ï¼š  
- å½“a<0æˆ–b<0æ—¶ï¼ŒæŠŠç³»æ•°è°ƒæ•´ä¸ºæ­£ï¼ˆæ¯”å¦‚`a%c + c`ï¼‰ï¼Œé¿å…é€’å½’å‡ºé”™ï¼›  
- å½“a<cä¸”b<cæ—¶ï¼Œç”¨å¯¹ç§°æ€§è½¬æ¢ï¼ˆ`n*m - f(...)`ï¼‰ï¼ŒæŠŠé—®é¢˜è½¬ç»™å¦ä¸€ä¸ªç±»æ¬§å‡½æ•°ã€‚  
**å­¦ä¹ ç¬”è®°**ï¼šç±»æ¬§çš„â€œä¸‡èƒ½å…¬å¼â€éœ€è¦è¦†ç›–æ‰€æœ‰æƒ…å†µï¼Œå°¤å…¶æ˜¯è´Ÿæ•°ï¼


### é¢˜è§£äºŒï¼ˆæ¥æºï¼šYipChipï¼‰  
**äº®ç‚¹**ï¼šç”¨ä»£æ•°å˜å½¢å¤„ç†è´Ÿç³»æ•°ã€‚  
**æ ¸å¿ƒä»£ç ç‰‡æ®µ**ï¼š  
```cpp
ll calc(ll a, ll b, ll c, ll n) {
	if (n < 0) return 0;
	if (!a) return b / c * (n + 1);
	if (a < c && b < c) {
		ll m = (a * n + b) / c;
		if (!m) return 0;
		return n * m - calc(c, c - b - 1, a, m - 1);
	}
	return calc(a % c, b % c, c, n) + (n + 1) * n / 2 * (a / c) + (n + 1) * (b / c);
}
```  
**ä»£ç è§£è¯»**ï¼š  
- å½“a< cä¸”b< cæ—¶ï¼Œè®¡ç®—`m=(a*n +b)/c`ï¼Œç„¶åç”¨`n*m`å‡å»å¦ä¸€ä¸ªç±»æ¬§é—®é¢˜â€”â€”è¿™æ˜¯ç±»æ¬§çš„â€œå¯¹ç§°é­”æ³•â€ï¼ŒæŠŠæ±‚å’Œå¼è½¬åŒ–ä¸ºæ›´å®¹æ˜“è®¡ç®—çš„å½¢å¼ã€‚  
**å­¦ä¹ ç¬”è®°**ï¼šä»£æ•°å˜å½¢æ˜¯å¤„ç†è´Ÿç³»æ•°çš„å…³é”®ï¼


### é¢˜è§£ä¸‰ï¼ˆæ¥æºï¼šanthonyaaabcï¼‰  
**äº®ç‚¹**ï¼šç”¨äºŒåˆ†æ³•æ‰¾ç›´çº¿äº¤ç‚¹ï¼ˆé¿å…æµ®ç‚¹è¯¯å·®ï¼‰ã€‚  
**æ ¸å¿ƒä»£ç ç‰‡æ®µ**ï¼š  
```cpp
__int128 find(node a, node b) {
    __int128 l=1, r=mx, as=-1;
    while(l<=r) {
        __int128 mid=(l+r)>>1;
        if((b.c-mid*b.b)*a.a < (a.c-mid*a.b)*b.a) {
            as=mid; r=mid-1;
        } else l=mid+1;
    }
    return as;
}
```  
**ä»£ç è§£è¯»**ï¼š  
- ç”¨äº¤å‰ç›¸ä¹˜æ¯”è¾ƒ`(b.c - mid*b.b)/b.a`å’Œ`(a.c - mid*a.b)/a.a`ï¼ˆå³ä¸¤æ¡ç›´çº¿çš„yå€¼ï¼‰ï¼Œé¿å…æµ®ç‚¹è¿ç®—çš„è¯¯å·®ï¼›  
- äºŒåˆ†æ‰¾åˆ°ç¬¬ä¸€ä¸ªmidï¼Œä½¿å¾—bæ¯”aæ›´ç´§ï¼ˆyæ›´å°ï¼‰ã€‚  
**å­¦ä¹ ç¬”è®°**ï¼šäº¤å‰ç›¸ä¹˜æ˜¯å¤„ç†åˆ†æ•°æ¯”è¾ƒçš„â€œç¥å™¨â€ï¼


## 5. ç®—æ³•å¯è§†åŒ–ï¼šåƒç´ åŠ¨ç”»æ¼”ç¤º  

### åŠ¨ç”»æ¼”ç¤ºä¸»é¢˜ï¼š**åƒç´ æ•°å­¦å®¶çš„ç›´çº¿æ•´ç†æ¸¸æˆ**  
**æ ¸å¿ƒæ¼”ç¤ºå†…å®¹**ï¼šå±•ç¤ºç›´çº¿æ’åºã€å‡¸å£³ç»´æŠ¤ã€ç±»æ¬§è®¡ç®—çš„å®Œæ•´æµç¨‹ï¼Œç»“åˆå¤å¤æ¸¸æˆå…ƒç´ ã€‚  

### è®¾è®¡æ€è·¯ç®€è¿°  
ç”¨8ä½åƒç´ é£è¥é€ â€œå°éœ¸ç‹å­¦ä¹ æœºâ€çš„æ°›å›´â€”â€”ç›´çº¿æ˜¯å½©è‰²çš„åƒç´ çº¿ï¼Œå‡¸å£³æ˜¯å †å çš„â€œæœ¨æ¿â€ï¼Œç±»æ¬§è®¡ç®—æ˜¯â€œæ‹†ç§¯æœ¨â€ã€‚éŸ³æ•ˆå’ŒåŠ¨ç”»å¼ºåŒ–è®°å¿†ï¼šæ¯”å¦‚å…¥æ ˆæ—¶â€œå®â€ä¸€å£°ï¼Œç±»æ¬§æ‹†åˆ†æ—¶â€œæ»´â€ä¸€å£°ï¼Œè¿‡å…³æ—¶â€œå—¡â€ä¸€å£°ã€‚


### åŠ¨ç”»å¸§æ­¥éª¤ä¸äº¤äº’å…³é”®ç‚¹  

1. **åœºæ™¯åˆå§‹åŒ–**ï¼š  
   - å±å¹•å·¦ä¾§æ˜¯xè½´ï¼ˆ1~100ï¼‰ï¼Œå³ä¾§æ˜¯yè½´ï¼ˆ1~100ï¼‰ï¼Œä¸­é—´æ˜¯ç½‘æ ¼ï¼ˆç”¨æµ…ç°è‰²åƒç´ å—ï¼‰ã€‚  
   - åº•éƒ¨æ§åˆ¶é¢æ¿æœ‰â€œå¼€å§‹â€â€œå•æ­¥â€â€œé‡ç½®â€æŒ‰é’®ï¼Œé€Ÿåº¦æ»‘å—ï¼ˆ1~5å€é€Ÿï¼‰ã€‚  
   - æ’­æ”¾8ä½é£æ ¼èƒŒæ™¯éŸ³ä¹ï¼ˆæ¯”å¦‚ã€Šè¶…çº§é©¬é‡Œå¥¥ã€‹çš„å°å…³å¡éŸ³ä¹ï¼‰ã€‚

2. **ç›´çº¿ç”Ÿæˆ**ï¼š  
   - è¾“å…¥çš„æ¯æ¡ç›´çº¿ç”¨ä¸åŒé¢œè‰²ç”Ÿæˆï¼ˆæ¯”å¦‚è“è‰²ã€ç»¿è‰²ï¼‰ï¼Œä¼´éšâ€œæ»´â€çš„éŸ³æ•ˆã€‚  
   - ç›´çº¿ä¸Šçš„æ¯ä¸ªç‚¹ç”¨åƒç´ å—æ ‡è®°ï¼ˆæ¯”å¦‚è“è‰²ç›´çº¿ç”¨`#00f`åƒç´ ï¼‰ã€‚

3. **ç›´çº¿æ’åº**ï¼š  
   - æ’åºåçš„ç›´çº¿ä¾æ¬¡â€œæ»‘å…¥â€å±å¹•å³ä¾§ï¼ˆä»ä¸‹å¾€ä¸Šï¼‰ï¼Œä¼´éšâ€œåˆ·â€çš„éŸ³æ•ˆã€‚  
   - æ’åºå®Œæˆåï¼Œå±å¹•æ˜¾ç¤ºâ€œæ’åºå®Œæˆï¼â€çš„æ–‡å­—æç¤ºã€‚

4. **å‡¸å£³ç»´æŠ¤**ï¼š  
   - å•è°ƒæ ˆä¸­çš„ç›´çº¿ç”¨â€œå †å â€åŠ¨ç”»å±•ç¤ºï¼ˆæ ˆé¡¶åœ¨æœ€ä¸Šé¢ï¼‰ã€‚  
   - æ–°ç›´çº¿åŠ å…¥æ—¶ï¼Œæ¯”è¾ƒä¸æ ˆé¡¶ç›´çº¿çš„äº¤ç‚¹ï¼šè‹¥æ— æ•ˆï¼Œæ ˆé¡¶ç›´çº¿â€œå¼¹å‡ºâ€ï¼ˆå‘ä¸‹ç§»åŠ¨ï¼‰ï¼Œä¼´éšâ€œå•ªâ€çš„éŸ³æ•ˆã€‚  
   - å‡¸å£³å½¢æˆåï¼Œå±å¹•æ˜¾ç¤ºâ€œå‡¸å£³å®Œæˆï¼â€çš„æ–‡å­—æç¤ºã€‚

5. **ç±»æ¬§è®¡ç®—**ï¼š  
   - æ¯ä¸ªåŒºé—´ç”¨é»„è‰²å—æ ‡è®°ï¼ˆæ¯”å¦‚xä»10åˆ°20çš„åŒºåŸŸï¼‰ã€‚  
   - ç±»æ¬§é€’å½’æ—¶ï¼ŒåŸé—®é¢˜ç”¨â€œç¼©å°â€åŠ¨ç”»ï¼ˆæ¯”å¦‚åŒºåŸŸç¼©å°ä¸º1/2ï¼‰ï¼Œä¼´éšâ€œæ»´â€çš„éŸ³æ•ˆã€‚  
   - è®¡ç®—å®Œæˆä¸€ä¸ªåŒºé—´ï¼Œé»„è‰²å—å˜ç»¿ï¼Œä¼´éšâ€œå—¡â€çš„éŸ³æ•ˆï¼Œè¡¨ç¤ºâ€œè¿‡å…³â€ã€‚

6. **ç»“æœå±•ç¤º**ï¼š  
   - æ‰€æœ‰åŒºé—´å¤„ç†å®Œæˆåï¼Œæ’­æ”¾â€œèƒœåˆ©â€éŸ³æ•ˆï¼ˆæ¯”å¦‚ã€Šé­‚æ–—ç½—ã€‹çš„è¿‡å…³éŸ³ä¹ï¼‰ï¼Œå±å¹•æ˜¾ç¤ºæ€»ç­”æ¡ˆï¼ˆæ¯”å¦‚â€œç­”æ¡ˆï¼š660â€ï¼‰ã€‚


## 6. æ‹“å±•ç»ƒä¹ ä¸ç›¸ä¼¼é—®é¢˜æ€è€ƒ  

### é€šç”¨æ€è·¯è¿ç§»  
ç±»æ¬§ç®—æ³•å¸¸ç”¨äºè®¡ç®—**çº¿æ€§åˆ†å¼æ±‚å’Œå¼**ï¼ˆæ¯”å¦‚âˆ‘âŒŠ(a*i + b)/câŒ‹ï¼‰ï¼Œå‡¸å£³ç»´æŠ¤å¸¸ç”¨äºå¤„ç†**å¤šä¸ªçº¿æ€§é™åˆ¶**ï¼ˆæ¯”å¦‚æ–œç‡ä¼˜åŒ–DPã€åŠå¹³é¢äº¤ï¼‰ã€‚ä¸¤è€…ç»“åˆå¯ä»¥è§£å†³â€œå¤šä¸ªçº¿æ€§æ¡ä»¶ä¸‹çš„è®¡æ•°é—®é¢˜â€ã€‚


### ç»ƒä¹ æ¨èï¼ˆæ´›è°·ï¼‰  
1. **æ´›è°· P5171ï¼ˆEarthquakeï¼‰**ï¼šæ±‚æ»¡è¶³Ax + By â‰¤ Cçš„éè´Ÿæ•´æ•°è§£æ•°é‡ã€‚  
   - æ¨èç†ç”±ï¼šç±»æ¬§çš„ç»å…¸é¢˜ç›®ï¼Œç›´æ¥åº”ç”¨ã€‚  
2. **æ´›è°· P3932ï¼ˆæµ®æ¸¸å¤§é™†çš„68å·å²›ï¼‰**ï¼šæ±‚æ»¡è¶³å¤šä¸ªçº¿æ€§æ¡ä»¶çš„ç‚¹çš„æ•°é‡ã€‚  
   - æ¨èç†ç”±ï¼šç»ƒä¹ å‡¸å£³ç»´æŠ¤ä¸ç±»æ¬§çš„ç»“åˆã€‚  
3. **æ´›è°· P4593ï¼ˆ[TJOI2018]æ•™ç§‘ä¹¦èˆ¬çš„äºµæ¸ï¼‰**ï¼šæ±‚âˆ‘k^mçš„å’Œã€‚  
   - æ¨èç†ç”±ï¼šç±»æ¬§åœ¨å¤æ‚æ±‚å’Œå¼ä¸­çš„åº”ç”¨ã€‚


## 7. å­¦ä¹ å¿ƒå¾—ä¸ç»éªŒåˆ†äº«  

### å‚è€ƒç»éªŒï¼ˆæ¥è‡ªNt_Tsumikiï¼‰  
> â€œæœ¬é¢˜ç¨å¾®å¡ç‚¹ç²¾åº¦ï¼Œä¸æƒ³è¢«å¡çš„å¯ä»¥æ‰‹å†™åˆ†æ•°ç±»ã€‚â€  
**ç‚¹è¯„**ï¼šæµ®ç‚¹è¿ç®—ä¼šæœ‰ç²¾åº¦è¯¯å·®ï¼ˆæ¯”å¦‚ç”¨doubleå­˜æ–œç‡ï¼‰ï¼Œæ‰‹å†™åˆ†æ•°ç±»ï¼ˆç”¨åˆ†å­å’Œåˆ†æ¯å­˜å‚¨ï¼‰å¯ä»¥é¿å…è¿™ä¸ªé—®é¢˜â€”â€”æ¯”å¦‚ç›´çº¿çš„æ–œç‡ç”¨`frac(-A, B)`è¡¨ç¤ºï¼Œäº¤ç‚¹ç”¨`frac(num, den)`è®¡ç®—ã€‚è¿™æ˜¯å¤„ç†å‡ ä½•é—®é¢˜çš„â€œé¿å‘æŠ€å·§â€ï¼


### å‚è€ƒç»éªŒï¼ˆæ¥è‡ªYipChipï¼‰  
> â€œä¸ºäº†ä½¿iå‰çš„ç³»æ•°å¤§äºé›¶ï¼Œæˆ‘ä»¬ä¸å¦¨è€ƒè™‘æ•´ä½“+i-iã€‚â€  
**ç‚¹è¯„**ï¼šå½“é‡åˆ°è´Ÿç³»æ•°æ—¶ï¼Œé€šè¿‡ä»£æ•°å˜å½¢æŠŠè´Ÿç³»æ•°è½¬ä¸ºæ­£ç³»æ•°ï¼ˆæ¯”å¦‚`âˆ‘âŒŠ(b-a)i + câŒ‹ = âˆ‘âŒŠ(k*b -a)i + câŒ‹ - k*âˆ‘i`ï¼‰ï¼Œè¿™æ˜¯ç±»æ¬§çš„â€œå˜å½¢é­”æ³•â€ï¼Œé¿å…é€’å½’ä¸­çš„è´Ÿæ•°æƒ…å†µã€‚


## ğŸ’ª æ€»ç»“ä¸é¼“åŠ±  
æœ¬æ¬¡åˆ†æçš„æ ¸å¿ƒæ˜¯â€œç±»æ¬§+å‡¸å£³â€çš„ç»“åˆâ€”â€”ç±»æ¬§è§£å†³æ±‚å’Œé—®é¢˜ï¼Œå‡¸å£³è§£å†³åŒºé—´é—®é¢˜ã€‚è®°ä½ï¼š**ç¼–ç¨‹çš„æœ¬è´¨æ˜¯â€œé—®é¢˜è½¬åŒ–â€**â€”â€”æŠŠå¤æ‚çš„è®¡æ•°é—®é¢˜è½¬åŒ–ä¸ºç±»æ¬§çš„æ±‚å’Œå¼ï¼ŒæŠŠå¤šä¸ªé™åˆ¶è½¬åŒ–ä¸ºå‡¸å£³çš„åŒºé—´ã€‚  

å¤šç»ƒä¹ ç±»æ¬§å’Œå‡¸å£³çš„é¢˜ç›®ï¼Œä½ ä¼šå‘ç°â€œå¤æ‚é—®é¢˜â€å…¶å®éƒ½æ˜¯â€œç®€å•æŠ€å·§çš„ç»„åˆâ€ï¼ä¸‹æ¬¡æˆ‘ä»¬å†ä¸€èµ·æ¢ç´¢æ›´æœ‰è¶£çš„ç®—æ³•é—®é¢˜~ ğŸ˜Š

---
å¤„ç†ç”¨æ—¶ï¼š195.53ç§’
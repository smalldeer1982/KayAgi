# é¢˜ç›®ä¿¡æ¯

# [AGC001F] Wide Swap

## é¢˜ç›®æè¿°

[problemUrl]: https://atcoder.jp/contests/agc001/tasks/agc001_f

é•·ã• $ N $ ã®ã€$ 1\ ï½\ N $ ã‚’ã¡ã‚‡ã†ã© $ 1 $ ã¤ãšã¤å«ã‚€æ•°åˆ— $ P_1\ ...\ P_N $ ãŒä¸ãˆã‚‰ã‚Œã¾ã™ã€‚

ã‚ãªãŸã¯ã“ã®æ•°åˆ—ã«å¯¾ã—ã€ä»¥ä¸‹ã®ã‚ˆã†ãªæ“ä½œã‚’ä½•åº¦ã§ã‚‚è¡Œãˆã¾ã™ã€‚

- æ•´æ•° $ i,j\ (1\ â‰¦\ i\ <\ j\ â‰¦\ N) $ ã‚’é¸ã¶ã€‚
- $ P_i $ ã¨ $ P_j $ ã®å€¤ã‚’å…¥ã‚Œæ›¿ãˆã‚‹ã€‚
- ãŸã ã—ã“ã®ã¨ãã€$ j\ -\ i\ â‰§\ K $ ã‹ã¤ $ |P_i\ -\ P_j|\ =\ 1 $ ã‚’æº€ãŸã—ã¦ã„ãªã‘ã‚Œã°ãªã‚‰ãªã„ã€‚

ã“ã®ã‚ˆã†ãªæ“ä½œã«ã‚ˆã£ã¦ä½œã‚‹ã“ã¨ã®ã§ãã‚‹æ•°åˆ—ã®ã†ã¡ã€è¾æ›¸é †æœ€å°ã®ã‚‚ã®ã‚’æ±‚ã‚ã¦ãã ã•ã„ã€‚

## è¯´æ˜/æç¤º

### åˆ¶ç´„

- $ 2â‰¦Nâ‰¦500,000 $
- $ 1â‰¦Kâ‰¦N-1 $
- $ P $ ã¯ $ 1,\ 2,\ ...,\ N $ ã®é †åˆ—ã§ã‚ã‚‹ã€‚

### Sample Explanation 1

ä»¥ä¸‹ã®ã‚ˆã†ãªæ‰‹é †ã§æ“ä½œã‚’è¡Œãˆã°è‰¯ã„ã§ã™ã€‚ - $ 4\ 2\ 3\ 1 $ - $ 4\ 1\ 3\ 2 $ - $ 3\ 1\ 4\ 2 $ - $ 2\ 1\ 4\ 3 $

## æ ·ä¾‹ #1

### è¾“å…¥

```
4 2

4 2 3 1```

### è¾“å‡º

```
2

1

4

3```

## æ ·ä¾‹ #2

### è¾“å…¥

```
5 1

5 4 3 2 1```

### è¾“å‡º

```
1

2

3

4

5```

## æ ·ä¾‹ #3

### è¾“å…¥

```
8 3

4 5 7 8 3 1 2 6```

### è¾“å‡º

```
1

2

6

7

5

3

4

8```

# AIåˆ†æç»“æœ

# ğŸ’¡ Kayçš„C++ç®—æ³•è§£æï¼šAGC001F Wide Swap æ·±å…¥å­¦ä¹ æŒ‡å— ğŸ’¡


## 1. é¢˜ç›®è§£è¯»ä¸æ ¸å¿ƒç®—æ³•è¯†åˆ«

âœ¨ **æœ¬é¢˜ä¸»è¦è€ƒå¯Ÿ**ï¼šå›¾è®ºï¼ˆæ‹“æ‰‘æ’åºï¼‰ + ç¼–ç¨‹æŠ€å·§ï¼ˆé€†ç½®æ¢è½¬æ¢ï¼‰

ğŸ—£ï¸ **åˆæ­¥åˆ†æ**ï¼š  
è§£å†³è¿™é“é¢˜çš„å…³é”®ï¼Œåœ¨äº**â€œæ¢ä¸ªè§’åº¦çœ‹é—®é¢˜â€**â€”â€”å°±åƒæŠŠâ€œæ‰¾å€¼çš„ä½ç½®â€å˜æˆâ€œæ‰¾ä½ç½®å¯¹åº”çš„å€¼â€ã€‚æˆ‘ä»¬å…ˆå®šä¹‰**é€†ç½®æ¢**ï¼šè®¾`Q[P[i]] = i`ï¼ˆæ¯”å¦‚`P`ä¸­å€¼ä¸º`x`çš„å…ƒç´ åœ¨ä½ç½®`i`ï¼Œé‚£ä¹ˆ`Q[x] = i`ï¼‰ã€‚è¿™æ ·åŸé—®é¢˜çš„äº¤æ¢æ¡ä»¶ï¼ˆ`j-iâ‰¥K`ä¸”`|P[i]-P[j]|=1`ï¼‰å°±è½¬åŒ–ä¸ºï¼š**åœ¨`Q`ä¸­ï¼Œè‹¥ç›¸é‚»ä¸¤ä¸ªæ•°çš„å·®â‰¥Kï¼Œå°±èƒ½äº¤æ¢å®ƒä»¬**ã€‚  

è¦è®©`P`å­—å…¸åºæœ€å°ï¼Œç­‰ä»·äºè®©`Q`çš„â€œå€¼å°çš„å…ƒç´ å°½é‡é å‰â€ï¼ˆæ¯”å¦‚`Q`ä¸­`1`çš„ä½ç½®è¶Šé å‰ï¼Œ`P`ä¸­`1`çš„ä½ç½®å°±è¶Šé å‰ï¼Œå­—å…¸åºè¶Šå°ï¼‰ã€‚ä½†`Q`ä¸­æœ‰ä¸ª**é“å¾‹**ï¼šè‹¥ä¸¤ä¸ªå…ƒç´ çš„å·®`<K`ï¼Œå®ƒä»¬çš„ç›¸å¯¹é¡ºåºæ°¸è¿œä¸èƒ½å˜ï¼ˆæ¯”å¦‚`Q[i]`å’Œ`Q[j]`å·®`2`ï¼Œ`K=3`ï¼Œé‚£å®ƒä»¬æ°¸è¿œä¸èƒ½äº¤æ¢ä½ç½®ï¼‰ã€‚  

æˆ‘ä»¬çš„ä»»åŠ¡å°±æ˜¯åœ¨è¿™ä¸ªé“å¾‹ä¸‹ï¼Œç»™`Q`æ’ä¸€ä¸ªâ€œæœ€åˆç†çš„é¡ºåºâ€â€”â€”è¿™åƒæäº†â€œæ’åº§ä½â€ï¼šæŸäº›äººå¿…é¡»åå‰é¢ï¼Œæˆ‘ä»¬è¦æŒ‰è§„åˆ™å®‰æ’å‡ºå­—å…¸åºæœ€å°çš„é˜Ÿä¼ã€‚æ ¸å¿ƒç®—æ³•æ˜¯**æ‹“æ‰‘æ’åº**ï¼ˆå¤„ç†â€œå¿…é¡»å…ˆåæŸäººåé¢â€çš„é™åˆ¶ï¼‰ï¼Œå†ç”¨**çº¿æ®µæ ‘**ä¼˜åŒ–å»ºè¾¹ï¼ˆé¿å…`O(nÂ²)`çš„æ— æ•ˆè¾¹ï¼‰ã€‚  

**å¯è§†åŒ–è®¾è®¡æ€è·¯**ï¼šæˆ‘ä»¬ç”¨8ä½åƒç´ é£å±•ç¤º`Q`æ•°ç»„ï¼Œæ¯ä¸ªå…ƒç´ æ˜¯ä¸€ä¸ªåƒç´ å—ã€‚å·®`<K`çš„å…ƒç´ ç”¨â€œé“é“¾â€è¿æ¥ï¼ˆè¡¨ç¤ºä¸èƒ½äº¤æ¢ï¼‰ï¼Œæ‹“æ‰‘æ’åºæ—¶ç”¨â€œé«˜äº®+ç§»åŠ¨â€å±•ç¤ºå…ƒç´ çš„ä½ç½®å˜åŒ–ï¼Œäº¤æ¢æ—¶æ’­æ”¾â€œå®â€çš„åƒç´ éŸ³æ•ˆï¼Œå®Œæˆæ—¶æ’­æ”¾èƒœåˆ©éŸ³è°ƒã€‚


## 2. ç²¾é€‰ä¼˜è´¨é¢˜è§£å‚è€ƒ

### é¢˜è§£ä¸€ï¼šå°ç²‰å…”ï¼ˆèµ56ï¼Œåšå®¢å›­ï¼‰
* **ç‚¹è¯„**ï¼šè¿™ä»½é¢˜è§£æ˜¯â€œè½¬åŒ–+æ‹“æ‰‘æ’åºâ€çš„ç»å…¸å®ç°ï¼Œæ€è·¯æ¸…æ™°åˆ°â€œåƒè¯´æ˜ä¹¦â€ã€‚å®ƒå…ˆæŠŠåŸé—®é¢˜è½¬åŒ–ä¸º`Q`çš„äº¤æ¢é—®é¢˜ï¼Œå†ç”¨â€œå·®<Kçš„å…ƒç´ ç›¸å¯¹é¡ºåºä¸å˜â€æ¨å¯¼æ‹“æ‰‘é™åˆ¶ï¼Œæœ€åç”¨çº¿æ®µæ ‘ç»´æŠ¤â€œå…¥åº¦ä¸º0çš„ç‚¹â€ï¼ˆå³å¯ä»¥ä¼˜å…ˆé€‰çš„å…ƒç´ ï¼‰ã€‚ä»£ç é£æ ¼è§„èŒƒï¼ˆå˜é‡å`mxp`ã€`Del`ç­‰å«ä¹‰æ˜ç¡®ï¼‰ï¼Œçº¿æ®µæ ‘çš„å®ç°é«˜æ•ˆï¼Œæ‹“æ‰‘æ’åºç”¨å¤§æ ¹å †ä¿è¯å­—å…¸åºæœ€å°ã€‚æœ€æ£’çš„æ˜¯å®ƒè¯æ˜äº†â€œåå‘æ‹“æ‰‘æ’åºâ€çš„æ­£ç¡®æ€§â€”â€”ä¸ºä»€ä¹ˆé€‰æœ€å¤§çš„ç‚¹æ”¾æœ€åä¼šæ›´ä¼˜ï¼Œè¿™è®©æ€è·¯æ›´æ‰å®ã€‚

### é¢˜è§£äºŒï¼šlinghuchong_ï¼ˆèµ74ï¼‰
* **ç‚¹è¯„**ï¼šè¿™æ˜¯â€œå½’å¹¶æ’åºä¼˜åŒ–â€çš„åˆ›æ–°æ€è·¯ï¼å®ƒæŠŠé€†ç½®æ¢åçš„`Q`æ•°ç»„ç”¨å½’å¹¶æ’åºåˆå¹¶ï¼Œæ¯æ¬¡åˆå¹¶æ—¶åˆ¤æ–­â€œå·¦è¾¹çš„åç¼€æœ€å°å€¼æ˜¯å¦â‰¥å³è¾¹å…ƒç´ +Kâ€ï¼ˆå³èƒ½å¦äº¤æ¢ï¼‰ã€‚ä»£ç çŸ­å°ç²¾æ‚ï¼Œå½’å¹¶çš„é€»è¾‘å·§å¦™é¿å¼€äº†æ‹“æ‰‘æ’åºçš„å»ºè¾¹éº»çƒ¦ï¼Œæ—¶é—´å¤æ‚åº¦`O(nlogn)`ã€‚ç¼ºç‚¹æ˜¯æ€è·¯è¾ƒæŠ½è±¡ï¼Œä½†ä¸€æ—¦ç†è§£â€œå½’å¹¶æ›¿ä»£å†’æ³¡â€çš„é€»è¾‘ï¼Œä¼šè§‰å¾—éå¸¸ç®€æ´ã€‚

### é¢˜è§£ä¸‰ï¼šFoXreignï¼ˆèµ6ï¼‰
* **ç‚¹è¯„**ï¼šè¿™ä»½é¢˜è§£è¯¦ç»†è¯æ˜äº†â€œé€†ç½®æ¢ç­‰ä»·æ€§â€â€”â€”ä¸ºä»€ä¹ˆ`P`å­—å…¸åºæœ€å°ç­‰ä»·äº`Q`å­—å…¸åºæœ€å°ã€‚å®ƒçš„æ‹“æ‰‘æ’åºå®ç°ç”¨äº†**åå‘å»ºå›¾**ï¼ˆæŠŠé™åˆ¶è¾¹åè¿‡æ¥ï¼‰ï¼Œæ¯æ¬¡é€‰æœ€å¤§çš„ç‚¹æ”¾æœ€åï¼Œå†è¿˜åŸæˆåŸåºåˆ—ã€‚ä»£ç ä¸­çš„çº¿æ®µæ ‘æŸ¥è¯¢â€œæœ€å…ˆå‡ºç°çš„ç‚¹â€ä¼˜åŒ–äº†å»ºè¾¹ï¼Œè¾¹æ•°ä»`O(nÂ²)`é™åˆ°`O(n)`ï¼Œå®è·µä»·å€¼å¾ˆé«˜ã€‚


## 3. æ ¸å¿ƒéš¾ç‚¹è¾¨æä¸è§£é¢˜ç­–ç•¥

### æ ¸å¿ƒéš¾ç‚¹1ï¼šå¦‚ä½•æŠŠåŸé—®é¢˜è½¬åŒ–ä¸ºé€†ç½®æ¢çš„é—®é¢˜ï¼Ÿ
* **åˆ†æ**ï¼šåŸé—®é¢˜çš„äº¤æ¢æ¡ä»¶ï¼ˆ`j-iâ‰¥K`ä¸”`|P[i]-P[j]|=1`ï¼‰å¾ˆâ€œç»•â€ï¼Œä½†é€†ç½®æ¢`Q[P[i]]=i`èƒ½æŠŠâ€œå€¼ç›¸é‚»â€è½¬åŒ–ä¸ºâ€œä½ç½®ç›¸é‚»â€â€”â€”äº¤æ¢`P`ä¸­çš„`i`å’Œ`j`ï¼ˆå€¼å·®1ï¼‰ï¼Œç­‰ä»·äºäº¤æ¢`Q`ä¸­çš„`P[i]`å’Œ`P[j]`ï¼ˆä½ç½®ç›¸é‚»ï¼‰ã€‚è¿™æ ·åŸé—®é¢˜å°±å˜æˆäº†â€œ`Q`ä¸­ç›¸é‚»å…ƒç´ å·®â‰¥Kæ—¶å¯äº¤æ¢â€ï¼Œç®€åŒ–äº†æ¡ä»¶ã€‚
* ğŸ’¡ **å­¦ä¹ ç¬”è®°**ï¼šé€†ç½®æ¢æ˜¯â€œæ¢è§†è§’â€çš„å…³é”®ï¼Œé‡åˆ°â€œä½ç½®ä¸å€¼äº’ç›¸å…³è”â€çš„é—®é¢˜ï¼Œè¯•è¯•äº’æ¢ä¸¤è€…ï¼

### æ ¸å¿ƒéš¾ç‚¹2ï¼šå¦‚ä½•å¤„ç†â€œå·®<Kçš„å…ƒç´ ç›¸å¯¹é¡ºåºä¸å˜â€çš„é™åˆ¶ï¼Ÿ
* **åˆ†æ**ï¼šç›´æ¥å»ºè¾¹ï¼ˆæ¯ä¸ªå·®<Kçš„å…ƒç´ å¯¹è¿ä¸€æ¡â€œå¿…é¡»å…ˆé€‰Aå†é€‰Bâ€çš„è¾¹ï¼‰ä¼šå¯¼è‡´`O(nÂ²)`æ¡è¾¹ï¼Œæ— æ³•å¤„ç†`n=5e5`çš„è§„æ¨¡ã€‚è§£å†³æ–¹æ¡ˆæ˜¯**ç”¨çº¿æ®µæ ‘æ‰¾â€œå…³é”®è¾¹â€**ï¼šæ¯”å¦‚ä»åå¾€å‰éå†`Q`ï¼Œåªè¿â€œå½“å‰å…ƒç´ åˆ°å·¦å³KèŒƒå›´å†…æœ€å…ˆå‡ºç°çš„å…ƒç´ â€çš„è¾¹â€”â€”å› ä¸ºè¿™äº›è¾¹å·²ç»è¦†ç›–äº†æ‰€æœ‰é™åˆ¶ï¼ˆä¼ é€’æ€§ï¼‰ã€‚
* ğŸ’¡ **å­¦ä¹ ç¬”è®°**ï¼šä¼ é€’æ€§å¯ä»¥å‡å°‘è¾¹æ•°ï¼Œæ‰¾â€œå…³é”®è¾¹â€æ˜¯å¤„ç†å¤§è§„æ¨¡é™åˆ¶çš„å¸¸ç”¨æŠ€å·§ï¼

### æ ¸å¿ƒéš¾ç‚¹3ï¼šå¦‚ä½•ä¿è¯æ‹“æ‰‘æ’åºå¾—åˆ°å­—å…¸åºæœ€å°çš„ç»“æœï¼Ÿ
* **åˆ†æ**ï¼šå¸¸è§„æ‹“æ‰‘æ’åºé€‰æœ€å°çš„ç‚¹æ”¾å‰é¢ï¼Œä½†æœ¬é¢˜éœ€è¦â€œå€¼å°çš„å…ƒç´ å°½é‡é å‰â€ï¼Œæ‰€ä»¥è¦**åå‘å»ºå›¾+é€‰æœ€å¤§çš„ç‚¹æ”¾æœ€å**ã€‚æ¯”å¦‚åŸé—®é¢˜è¦è®©`Q`çš„`1`å°½é‡é å‰ï¼Œåå‘å»ºå›¾åï¼ŒæŠŠæœ€å¤§çš„ç‚¹æ”¾æœ€åï¼Œè¿˜åŸå`1`å°±ä¼šåœ¨æœ€å‰é¢ã€‚
* ğŸ’¡ **å­¦ä¹ ç¬”è®°**ï¼šå­—å…¸åºæœ€å°çš„æ‹“æ‰‘åºï¼Œæœ‰æ—¶éœ€è¦â€œåå‘æ“ä½œâ€ï¼


## 4. C++æ ¸å¿ƒä»£ç å®ç°èµæ

### æœ¬é¢˜é€šç”¨æ ¸å¿ƒC++å®ç°å‚è€ƒ
* **è¯´æ˜**ï¼šæœ¬ä»£ç ç»¼åˆäº†å°ç²‰å…”å’ŒFoXreignçš„é¢˜è§£æ€è·¯ï¼Œç”¨â€œé€†ç½®æ¢+çº¿æ®µæ ‘+æ‹“æ‰‘æ’åºâ€å®ç°ï¼Œé€»è¾‘æ¸…æ™°ï¼Œè¦†ç›–ä¸»è¦è€ƒç‚¹ã€‚
* **å®Œæ•´æ ¸å¿ƒä»£ç **ï¼š
```cpp
#include <cstdio>
#include <algorithm>
#include <queue>
#include <vector>
using namespace std;

const int Inf = 0x3f3f3f3f;
const int MN = 500005;

int N, K, P[MN], Q[MN], Ans[MN]; // Qæ˜¯é€†ç½®æ¢ï¼šQ[P[i]] = i

// çº¿æ®µæ ‘ç»´æŠ¤åŒºé—´æœ€å¤§å€¼
#define li (i << 1)
#define ri (li | 1)
#define mid ((l + r) >> 1)
int mxp[MN << 2];
void Build(int i, int l, int r) {
    if (l == r) { mxp[i] = l; return; }
    Build(li, l, mid), Build(ri, mid+1, r);
    mxp[i] = Q[mxp[li]] > Q[mxp[ri]] ? mxp[li] : mxp[ri];
}
void Del(int i, int l, int r, int p) {
    if (l == r) { mxp[i] = 0; return; }
    p <= mid ? Del(li, l, mid, p) : Del(ri, mid+1, r, p);
    mxp[i] = Q[mxp[li]] > Q[mxp[ri]] ? mxp[li] : mxp[ri];
}
int Qur(int i, int l, int r, int a, int b) {
    if (r < a || b < l) return 0;
    if (a <= l && r <= b) return mxp[i];
    int v1 = Qur(li, l, mid, a, b), v2 = Qur(ri, mid+1, r, a, b);
    return Q[v1] > Q[v2] ? v1 : v2;
}

vector<int> e[MN];
int deg[MN];
priority_queue<int> q;

bool check(int i) { return Qur(1, 1, N, max(1, i-K+1), min(N, i+K-1)) == i; }

int main() {
    scanf("%d%d", &N, &K);
    for (int i = 1; i <= N; ++i) {
        scanf("%d", &P[i]);
        Q[P[i]] = i; // é€†ç½®æ¢
    }
    Build(1, 1, N);
    // åˆå§‹åŒ–å…¥åº¦ä¸º0çš„ç‚¹
    for (int i = 1; i <= N; ++i)
        if (check(i)) q.push(i);
    // æ‹“æ‰‘æ’åº
    int ct = N;
    while (!q.empty()) {
        int u = q.top(); q.pop();
        Ans[u] = ct--;
        Del(1, 1, N, u); // æ ‡è®°ä¸ºå·²å¤„ç†
        // æ›´æ–°å·¦å³åŒºé—´çš„ç‚¹
        int t = Qur(1, 1, N, max(1, u-K+1), u);
        if (t && check(t)) q.push(t);
        t = Qur(1, 1, N, u, min(N, u+K-1));
        if (t && check(t)) q.push(t);
    }
    // è¿˜åŸæˆåŸåºåˆ—
    for (int i = 1; i <= N; ++i) P[Q[i]] = i;
    for (int i = 1; i <= N; ++i) printf("%d\n", Ans[P[i]]);
    return 0;
}
```
* **ä»£ç è§£è¯»æ¦‚è¦**ï¼š  
  1. **é€†ç½®æ¢**ï¼šç”¨`Q[P[i]] = i`æŠŠåŸé—®é¢˜è½¬åŒ–ä¸º`Q`çš„äº¤æ¢é—®é¢˜ã€‚  
  2. **çº¿æ®µæ ‘**ï¼šç»´æŠ¤`Q`æ•°ç»„çš„åŒºé—´æœ€å¤§å€¼ï¼Œå¿«é€Ÿæ‰¾åˆ°â€œå…¥åº¦ä¸º0çš„ç‚¹â€ï¼ˆå³å¯ä»¥ä¼˜å…ˆé€‰çš„å…ƒç´ ï¼‰ã€‚  
  3. **æ‹“æ‰‘æ’åº**ï¼šç”¨å¤§æ ¹å †é€‰æœ€å¤§çš„ç‚¹æ”¾æœ€åï¼Œä¿è¯å­—å…¸åºæœ€å°ã€‚  
  4. **è¿˜åŸåºåˆ—**ï¼šæŠŠ`Q`çš„ç»“æœè½¬æ¢å›åŸåºåˆ—`P`ï¼Œè¾“å‡ºç­”æ¡ˆã€‚


### é¢˜è§£ä¸€ï¼ˆå°ç²‰å…”ï¼‰æ ¸å¿ƒä»£ç ç‰‡æ®µèµæ
* **äº®ç‚¹**ï¼šçº¿æ®µæ ‘ç»´æŠ¤â€œå…¥åº¦ä¸º0çš„ç‚¹â€ï¼Œé«˜æ•ˆæ‰¾ä¼˜å…ˆå…ƒç´ ã€‚
* **æ ¸å¿ƒä»£ç ç‰‡æ®µ**ï¼š
```cpp
bool check(int i) { return Qur(1, 1, N, max(1, i-K+1), min(N, i+K-1)) == i; }
```
* **ä»£ç è§£è¯»**ï¼š  
  è¿™å¥è¯æ˜¯â€œå…¥åº¦ä¸º0çš„ç‚¹â€çš„åˆ¤æ–­æ¡ä»¶â€”â€”å¦‚æœ`i`æ˜¯`[i-K+1, i+K-1]`åŒºé—´å†…çš„æœ€å¤§å€¼ï¼ˆå³æ²¡æœ‰æ¯”å®ƒå¤§çš„å…ƒç´ é™åˆ¶å®ƒï¼‰ï¼Œé‚£ä¹ˆ`i`å¯ä»¥ä¼˜å…ˆé€‰ã€‚æ¯”å¦‚`K=2`ï¼Œ`i=3`ï¼ŒåŒºé—´æ˜¯`[2,4]`ï¼Œå¦‚æœ`Q[3]`æ˜¯åŒºé—´æœ€å¤§ï¼Œè¯´æ˜`3`æ²¡æœ‰â€œå¿…é¡»åœ¨å®ƒåé¢â€çš„å…ƒç´ ï¼Œèƒ½ä¼˜å…ˆé€‰ã€‚
* ğŸ’¡ **å­¦ä¹ ç¬”è®°**ï¼šçº¿æ®µæ ‘çš„åŒºé—´æŸ¥è¯¢å¯ä»¥å¿«é€Ÿåˆ¤æ–­â€œæ˜¯å¦æ»¡è¶³é™åˆ¶â€ï¼Œé¿å…éå†æ‰€æœ‰å…ƒç´ ï¼


### é¢˜è§£äºŒï¼ˆlinghuchong_ï¼‰æ ¸å¿ƒä»£ç ç‰‡æ®µèµæ
* **äº®ç‚¹**ï¼šå½’å¹¶æ’åºæ›¿ä»£æ‹“æ‰‘æ’åºï¼Œå·§å¦™å¤„ç†äº¤æ¢æ¡ä»¶ã€‚
* **æ ¸å¿ƒä»£ç ç‰‡æ®µ**ï¼š
```cpp
void merge(int l, int r) {
    if (l == r) return;
    int m = (l + r) >> 1;
    merge(l, m), merge(m+1, r);
    int num = Inf, i = l, j = m+1, k = l;
    ROF(p, m, l) num = min(num, Q[p]); // å·¦è¾¹åç¼€æœ€å°å€¼
    while (i <= m && j <= r) {
        if (num >= Q[j] + K) b[k++] = Q[j++]; // èƒ½äº¤æ¢å³è¾¹å…ƒç´ 
        else b[k++] = Q[i++]; // ä¸èƒ½äº¤æ¢ï¼Œé€‰å·¦è¾¹å…ƒç´ 
    }
    while (i <= m) b[k++] = Q[i++];
    while (j <= r) b[k++] = Q[j++];
    FOR(p, l, r) Q[p] = b[p];
}
```
* **ä»£ç è§£è¯»**ï¼š  
  å½’å¹¶æ—¶ï¼Œå·¦è¾¹çš„åç¼€æœ€å°å€¼`num`ä»£è¡¨â€œå·¦è¾¹å‰©ä¸‹çš„å…ƒç´ ä¸­æœ€å°çš„ä½ç½®â€ã€‚å¦‚æœ`num â‰¥ Q[j]+K`ï¼ˆå³å·¦è¾¹çš„æ‰€æœ‰å…ƒç´ éƒ½èƒ½å’Œå³è¾¹çš„`Q[j]`äº¤æ¢ï¼‰ï¼Œå°±é€‰å³è¾¹çš„`Q[j]`ï¼ˆè®©å°çš„å…ƒç´ é å‰ï¼‰ï¼›å¦åˆ™é€‰å·¦è¾¹çš„`Q[i]`ã€‚è¿™ç§â€œè´ªå¿ƒåˆå¹¶â€çš„é€»è¾‘ï¼Œç­‰ä»·äºæ‹“æ‰‘æ’åºçš„ç»“æœï¼Œä½†ä»£ç æ›´ç®€æ´ã€‚
* ğŸ’¡ **å­¦ä¹ ç¬”è®°**ï¼šå½’å¹¶æ’åºä¸ä»…èƒ½æ’åºï¼Œè¿˜èƒ½å¤„ç†â€œäº¤æ¢é™åˆ¶â€çš„é—®é¢˜ï¼


## 5. ç®—æ³•å¯è§†åŒ–ï¼šåƒç´ åŠ¨ç”»æ¼”ç¤º

### åŠ¨ç”»ä¸»é¢˜ï¼šåƒç´ ä¸–ç•Œçš„â€œäº¤æ¢å¤§å†’é™©â€
* **è®¾è®¡æ€è·¯**ï¼šç”¨8ä½åƒç´ é£æ¨¡æ‹Ÿ`Q`æ•°ç»„çš„äº¤æ¢è¿‡ç¨‹ï¼Œç»“åˆâ€œé—¯å…³â€å’Œâ€œéŸ³æ•ˆâ€å¢å¼ºè¶£å‘³æ€§â€”â€”å°±åƒç©FCæ¸¸æˆä¸€æ ·ï¼Œå¸®åƒç´ å°äººâ€œæ’å¥½é˜Ÿâ€ã€‚

### åŠ¨ç”»å¸§æ­¥éª¤ä¸äº¤äº’è®¾è®¡
1. **åœºæ™¯åˆå§‹åŒ–**ï¼š  
   - å±å¹•å·¦ä¾§æ˜¯`Q`æ•°ç»„çš„åƒç´ å—ï¼ˆæ¯ä¸ªå…ƒç´ æ˜¯ä¸€ä¸ª16x16çš„åƒç´ å—ï¼Œé¢œè‰²åŒºåˆ†å€¼çš„å¤§å°ï¼‰ï¼Œå³ä¾§æ˜¯æ§åˆ¶é¢æ¿ï¼ˆâ€œå¼€å§‹/æš‚åœâ€â€œå•æ­¥â€â€œé‡ç½®â€æŒ‰é’®ï¼Œé€Ÿåº¦æ»‘å—ï¼‰ã€‚  
   - èƒŒæ™¯æ˜¯FCé£æ ¼çš„è“å¤©è‰åœ°ï¼Œæ’­æ”¾8ä½å¾ªç¯BGMï¼ˆæ¯”å¦‚ã€Šè¶…çº§é©¬é‡Œå¥¥ã€‹çš„è½»å¿«æ—‹å¾‹ï¼‰ã€‚

2. **ç®—æ³•å¯åŠ¨**ï¼š  
   - é€†ç½®æ¢è½¬åŒ–ï¼š`P`æ•°ç»„çš„åƒç´ å—â€œæ—‹è½¬â€å˜æˆ`Q`æ•°ç»„ï¼Œä¼´éšâ€œå’»â€çš„éŸ³æ•ˆã€‚  
   - çº¿æ®µæ ‘åˆå§‹åŒ–ï¼šå±å¹•ä¸‹æ–¹æ˜¾ç¤ºçº¿æ®µæ ‘çš„åƒç´ ç»“æ„ï¼Œæ¯ä¸ªèŠ‚ç‚¹æ˜¯ä¸€ä¸ªå°æ–¹å—ï¼Œå€¼è¶Šå¤§é¢œè‰²è¶Šäº®ã€‚

3. **æ‹“æ‰‘æ’åºæ¼”ç¤º**ï¼š  
   - **å…¥åº¦ä¸º0çš„ç‚¹**ï¼šç”¨â€œé—ªçƒçš„é»„è‰²è¾¹æ¡†â€æ ‡è®°ï¼Œç‚¹å‡»â€œå•æ­¥â€ä¼šç§»åŠ¨è¯¥ç‚¹åˆ°ç»“æœåŒºï¼Œä¼´éšâ€œå®â€çš„éŸ³æ•ˆã€‚  
   - **çº¿æ®µæ ‘æ›´æ–°**ï¼šæ¯æ¬¡åˆ é™¤ä¸€ä¸ªç‚¹ï¼Œçº¿æ®µæ ‘çš„å¯¹åº”èŠ‚ç‚¹é¢œè‰²å˜ç°ï¼Œä¼´éšâ€œå±â€çš„éŸ³æ•ˆã€‚  
   - **äº¤æ¢åŠ¨ç”»**ï¼šå¦‚æœä¸¤ä¸ªå…ƒç´ èƒ½äº¤æ¢ï¼Œåƒç´ å—ä¼šâ€œæ»‘åŠ¨â€äº¤æ¢ä½ç½®ï¼Œå·®<Kçš„å…ƒç´ ç”¨â€œé“é“¾â€è¿æ¥ï¼ˆä¸èƒ½åŠ¨ï¼‰ã€‚

4. **èƒœåˆ©æ¡ä»¶**ï¼š  
   - å½“æ‰€æœ‰å…ƒç´ æ’å¥½åºï¼Œå±å¹•å¼¹å‡ºâ€œèƒœåˆ©ï¼â€çš„åƒç´ æ–‡å­—ï¼Œæ’­æ”¾ä¸Šæ‰¬çš„èƒœåˆ©éŸ³æ•ˆï¼ˆæ¯”å¦‚ã€Šé­‚æ–—ç½—ã€‹çš„é€šå…³éŸ³ä¹ï¼‰ã€‚  
   - ç»Ÿè®¡â€œå•æ­¥æ¬¡æ•°â€å’Œâ€œé”™è¯¯æ¬¡æ•°â€ï¼Œç»™å‡ºâ€œæ˜Ÿçº§è¯„ä»·â€ï¼ˆ3æ˜Ÿä¸ºæ»¡åˆ†ï¼‰ã€‚

### äº¤äº’åŠŸèƒ½
- **å•æ­¥æ‰§è¡Œ**ï¼šç‚¹å‡»â€œå•æ­¥â€æŒ‰é’®ï¼Œæ‰§è¡Œä¸€æ­¥æ‹“æ‰‘æ’åºï¼Œæ˜¾ç¤ºå½“å‰æ“ä½œçš„ä»£ç è¡Œï¼ˆæ¯”å¦‚`int u = q.top();`ï¼‰ã€‚  
- **è‡ªåŠ¨æ’­æ”¾**ï¼šæ»‘åŠ¨é€Ÿåº¦æ»‘å—è°ƒæ•´æ’­æ”¾é€Ÿåº¦ï¼ˆ1x~5xï¼‰ï¼Œè‡ªåŠ¨å®Œæˆæ‰€æœ‰æ­¥éª¤ã€‚  
- **é‡ç½®åŠ¨ç”»**ï¼šç‚¹å‡»â€œé‡ç½®â€æŒ‰é’®ï¼Œå›åˆ°åˆå§‹çŠ¶æ€ï¼Œé‡æ–°å¼€å§‹ã€‚


## 6. æ‹“å±•ç»ƒä¹ ä¸ç›¸ä¼¼é—®é¢˜æ€è€ƒ

### é€šç”¨æ€è·¯è¿ç§»
- **é€†ç½®æ¢è½¬åŒ–**ï¼šé€‚ç”¨äºâ€œä½ç½®ä¸å€¼äº’ç›¸å…³è”â€çš„é—®é¢˜ï¼Œæ¯”å¦‚â€œæ±‚æ’åˆ—çš„æœ€å°å­—å…¸åºâ€â€œäº¤æ¢ç›¸é‚»å…ƒç´ çš„é™åˆ¶é—®é¢˜â€ã€‚  
- **æ‹“æ‰‘æ’åºä¼˜åŒ–**ï¼šé€‚ç”¨äºâ€œæœ‰é¡ºåºé™åˆ¶â€çš„é—®é¢˜ï¼Œæ¯”å¦‚â€œè¯¾ç¨‹è¡¨å®‰æ’â€â€œé£Ÿç‰©é“¾è®¡æ•°â€ã€‚  
- **çº¿æ®µæ ‘ä¼˜åŒ–**ï¼šé€‚ç”¨äºâ€œå¤§è§„æ¨¡åŒºé—´æŸ¥è¯¢â€çš„é—®é¢˜ï¼Œæ¯”å¦‚â€œæ‰¾åŒºé—´æœ€å¤§å€¼â€â€œç»Ÿè®¡åŒºé—´å…ƒç´ ä¸ªæ•°â€ã€‚


### æ´›è°·æ¨èç»ƒä¹ 
1. **P3243 èœè‚´åˆ¶ä½œ**ï¼šæ‹“æ‰‘æ’åºæ±‚å­—å…¸åºæœ€å°çš„åºåˆ—ï¼Œå’Œæœ¬é¢˜æ€è·¯ä¸€è‡´ã€‚  
   - æ¨èç†ç”±ï¼šå¸®ä½ å·©å›ºâ€œåå‘æ‹“æ‰‘æ’åºâ€çš„æŠ€å·§ï¼Œç†è§£â€œé€‰æœ€å¤§çš„ç‚¹æ”¾æœ€åâ€çš„é€»è¾‘ã€‚
2. **P4017 æœ€å¤§é£Ÿç‰©é“¾è®¡æ•°**ï¼šæ‹“æ‰‘æ’åºç»Ÿè®¡è·¯å¾„æ•°ï¼Œç»ƒä¹ çº¿æ®µæ ‘ä¹‹å¤–çš„æ‹“æ‰‘åº”ç”¨ã€‚  
   - æ¨èç†ç”±ï¼šè®©ä½ æ˜ç™½æ‹“æ‰‘æ’åºä¸ä»…èƒ½æ’é¡ºåºï¼Œè¿˜èƒ½ç»Ÿè®¡ä¿¡æ¯ã€‚
3. **P1137 æ—…è¡Œè®¡åˆ’**ï¼šæ‹“æ‰‘æ’åº+DPï¼Œå¤„ç†â€œæœ‰ä¾èµ–çš„è·¯å¾„é—®é¢˜â€ã€‚  
   - æ¨èç†ç”±ï¼šæ‹“å±•æ‹“æ‰‘æ’åºçš„åº”ç”¨åœºæ™¯ï¼Œç»“åˆåŠ¨æ€è§„åˆ’è§£å†³æ›´å¤æ‚çš„é—®é¢˜ã€‚


## 7. å­¦ä¹ å¿ƒå¾—ä¸ç»éªŒåˆ†äº«ï¼ˆè‹¥æœ‰ï¼‰
* **å‚è€ƒç»éªŒï¼ˆæ¥è‡ªå°ç²‰å…”ï¼‰**ï¼šâ€œæˆ‘æœ€åˆåœ¨â€˜ä¸ºä»€ä¹ˆåå‘æ‹“æ‰‘æ’åºæ›´ä¼˜â€™çš„é—®é¢˜ä¸Šå¡äº†å¾ˆä¹…ï¼Œåæ¥é€šè¿‡â€˜ä¸¾åä¾‹â€™ï¼ˆæ¯”å¦‚`K=1`æ—¶ï¼Œåå‘æ’åºå°±æ˜¯æ­£åºæ’åºï¼‰æ‰æƒ³é€šã€‚â€  
* **ç‚¹è¯„**ï¼šä¸¾åä¾‹æ˜¯ç†è§£ç®—æ³•æ­£ç¡®æ€§çš„å¥½æ–¹æ³•ï¼æ¯”å¦‚`K=1`æ—¶ï¼ŒåŸé—®é¢˜å°±æ˜¯æ’åºï¼Œåå‘æ‹“æ‰‘æ’åºé€‰æœ€å¤§çš„ç‚¹æ”¾æœ€åï¼Œç»“æœå°±æ˜¯æ­£åºï¼Œè¿™å’Œé¢„æœŸä¸€è‡´ã€‚é‡åˆ°æƒ³ä¸é€šçš„é€»è¾‘ï¼Œè¯•è¯•â€œæç«¯æƒ…å†µâ€ï¼


## æ€»ç»“
æœ¬æ¬¡åˆ†æè¦†ç›–äº†â€œè½¬åŒ–é—®é¢˜â†’æ‹“æ‰‘æ’åºâ†’çº¿æ®µæ ‘ä¼˜åŒ–â€çš„å®Œæ•´æ€è·¯ï¼Œæ ¸å¿ƒæ˜¯â€œæ¢è§†è§’â€å’Œâ€œä¼˜åŒ–é™åˆ¶â€ã€‚è®°ä½ï¼š**ç¼–ç¨‹çš„æœ¬è´¨æ˜¯â€œè§£å†³é—®é¢˜çš„æ€è·¯â€ï¼Œè€Œä¸æ˜¯â€œå†™ä»£ç çš„æŠ€å·§â€**â€”â€”ç†è§£é—®é¢˜çš„è½¬åŒ–é€»è¾‘ï¼Œæ¯”èƒŒä»£ç æ›´é‡è¦ï¼

ä¸‹æ¬¡æˆ‘ä»¬å†ä¸€èµ·æ¢ç´¢æ›´æœ‰è¶£çš„ç®—æ³•é—®é¢˜å§ï¼ğŸ’ª

---
å¤„ç†ç”¨æ—¶ï¼š96.97ç§’
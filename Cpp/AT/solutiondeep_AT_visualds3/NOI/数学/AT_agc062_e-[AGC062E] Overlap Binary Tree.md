# é¢˜ç›®ä¿¡æ¯

# [AGC062E] Overlap Binary Tree

## é¢˜ç›®æè¿°

ç»™å®šä¸€ä¸ªå¥‡æ•° $N$ å’Œä¸€ä¸ªéè´Ÿæ•´æ•° $K$ã€‚

è¯·è®¡ç®—æ»¡è¶³ä»¥ä¸‹æ‰€æœ‰æ¡ä»¶çš„æ•´æ•°å¯¹åºåˆ— $((L_1,R_1),(L_2,R_2),\dots,(L_N,R_N))$ çš„ä¸ªæ•°ï¼Œå¹¶å¯¹ $998244353$ å–æ¨¡ã€‚

- $(L_1,R_1,L_2,R_2,\dots,L_N,R_N)$ æ˜¯ $1$ åˆ° $2N$ çš„ä¸€ä¸ªæ’åˆ—ã€‚
- $L_1 \leq L_2 \leq \dots \leq L_N$ã€‚
- å¯¹äºæ‰€æœ‰ $1 \leq i \leq N$ï¼Œæœ‰ $L_i \leq R_i$ã€‚
- æ°å¥½æœ‰ $K$ ä¸ª $i$ æ»¡è¶³ $L_i+1=R_i$ã€‚
- å­˜åœ¨ä¸€ä¸ªä»¥ $1$ åˆ° $N$ ç¼–å·çš„ $N$ ä¸ªé¡¶ç‚¹çš„**æœ‰æ ¹äºŒå‰æ ‘** $T$ï¼Œæ»¡è¶³ä¸‹è¿°æ€§è´¨ï¼š
  - åœ¨ $T$ ä¸­ï¼Œé¡¶ç‚¹ $i$ å’Œ $j$ å­˜åœ¨ç¥–å…ˆ-å­å­™å…³ç³»ï¼Œå½“ä¸”ä»…å½“åŒºé—´ $[L_i,R_i]$ å’Œ $[L_j,R_j]$ æœ‰äº¤é›†ã€‚

è¿™é‡Œï¼Œæœ‰æ ¹äºŒå‰æ ‘æŒ‡çš„æ˜¯æ¯ä¸ªèŠ‚ç‚¹çš„å­èŠ‚ç‚¹æ•°ä¸º $0$ æˆ– $2$ çš„æœ‰æ ¹æ ‘ã€‚åœ¨æ ‘ $T$ ä¸­ï¼Œå¦‚æœé¡¶ç‚¹ $j$ åœ¨è¿æ¥æ ¹å’Œé¡¶ç‚¹ $i$ çš„ç®€å•è·¯å¾„ä¸Šï¼Œæˆ–è€…é¡¶ç‚¹ $i$ åœ¨è¿æ¥æ ¹å’Œé¡¶ç‚¹ $j$ çš„ç®€å•è·¯å¾„ä¸Šï¼Œåˆ™ç§°é¡¶ç‚¹ $i$ å’Œ $j$ å­˜åœ¨ç¥–å…ˆ-å­å­™å…³ç³»ã€‚

## è¯´æ˜/æç¤º

### é™åˆ¶æ¡ä»¶

- $1 \leq N < 2 \times 10^5$
- $0 \leq K \leq N$
- $N$ æ˜¯å¥‡æ•°
- è¾“å…¥çš„æ‰€æœ‰å€¼å‡ä¸ºæ•´æ•°

### æ ·ä¾‹è§£é‡Š 1

ä¾‹å¦‚ï¼Œ$(L_1,R_1)=(1,5),(L_2,R_2)=(2,3),(L_3,R_3)=(4,6)$ æ—¶ï¼Œåªæœ‰ $i=2$ æ»¡è¶³ $L_i+1=R_i$ï¼Œå³æ°å¥½æœ‰ $1$ ä¸ªã€‚æ­¤å¤–ï¼Œå¯¹äºç¬¬ $5$ ä¸ªæ¡ä»¶ä¸­æè¿°çš„æ ‘ï¼Œé¡¶ç‚¹ $1$ ä½œä¸ºæ ¹ï¼Œå…¶å­èŠ‚ç‚¹ä¸ºé¡¶ç‚¹ $2$ å’Œ $3$ï¼Œè¿™æ ·çš„æœ‰æ ¹æ ‘æ˜¯æ»¡è¶³æ¡ä»¶çš„ã€‚

ç”± ChatGPT 4.1 ç¿»è¯‘

## æ ·ä¾‹ #1

### è¾“å…¥

```
3 1```

### è¾“å‡º

```
2```

## æ ·ä¾‹ #2

### è¾“å…¥

```
1 0```

### è¾“å‡º

```
0```

## æ ·ä¾‹ #3

### è¾“å…¥

```
521 400```

### è¾“å‡º

```
0```

## æ ·ä¾‹ #4

### è¾“å…¥

```
199999 2023```

### è¾“å‡º

```
283903125```

# AIåˆ†æç»“æœ

# ğŸ’¡ Kayçš„C++ç®—æ³•è§£æï¼šAGC062E Overlap Binary Tree æ·±å…¥å­¦ä¹ æŒ‡å— ğŸ’¡


## 1. é¢˜ç›®è§£è¯»ä¸æ ¸å¿ƒç®—æ³•è¯†åˆ«

âœ¨ **æœ¬é¢˜ä¸»è¦è€ƒå¯Ÿ**ï¼šæ•°å­¦ï¼ˆç”Ÿæˆå‡½æ•°ï¼‰ + å¤šé¡¹å¼ç®—æ³•

ğŸ—£ï¸ **åˆæ­¥åˆ†æ**ï¼š
è§£å†³è¿™é“é¢˜çš„å…³é”®ï¼Œæ˜¯æŠŠ**äºŒå‰æ ‘çš„ç»“æ„è®¡æ•°**è½¬åŒ–ä¸º**ç”Ÿæˆå‡½æ•°çš„ç»„åˆé—®é¢˜**â€”â€”å°±åƒç”¨â€œæ•°å­¦èœè°±â€æŠŠæ ‘çš„é“¾ç»“æ„å˜æˆâ€œé£Ÿæâ€ï¼Œå†é€šè¿‡â€œçƒ¹é¥ªâ€ï¼ˆå¤šé¡¹å¼è¿ç®—ï¼‰ç®—å‡ºæ‰€æœ‰å¯èƒ½çš„ç»„åˆæ–¹å¼ã€‚ç®€å•æ¥è¯´ï¼š  
- **ç”Ÿæˆå‡½æ•°**ï¼šæŠŠæ¯ä¸ªæ ‘é“¾çš„è´¡çŒ®ï¼ˆæ¯”å¦‚é“¾é•¿`d`å¯¹åº”`(d+1)!`ç§åŒºé—´æ’åˆ—ï¼‰å†™æˆç”Ÿæˆå‡½æ•°çš„é¡¹ï¼Œæ‰€æœ‰å¯èƒ½çš„æ ‘ç»“æ„ç»„åˆå°±æ˜¯ç”Ÿæˆå‡½æ•°çš„å¹‚æ¬¡ï¼ˆå› ä¸ºæ¯æ£µæ ‘ç”±`m=(n+1)/2`æ¡é“¾ç»„æˆï¼‰ã€‚  
- **å¤šé¡¹å¼ç®—æ³•**ï¼šç”¨å¤šé¡¹å¼å¿«é€Ÿå¹‚ï¼ˆç»“åˆ`ln`/`exp`å˜æ¢ï¼‰é«˜æ•ˆè®¡ç®—ç”Ÿæˆå‡½æ•°çš„å¹‚æ¬¡ï¼Œå†å–å¯¹åº”ç³»æ•°å¾—åˆ°ç­”æ¡ˆã€‚  

### æ ¸å¿ƒæ€è·¯ä¸éš¾ç‚¹
- **æ— ké™åˆ¶æ—¶**ï¼šæ¯ä¸ªé“¾é•¿`d`çš„è´¡çŒ®æ˜¯`(d+1)!`ï¼Œç”Ÿæˆå‡½æ•°ä¸º`F(x) = sum_{d=1}^{m-1} (d+1)! x^d`ï¼Œæ€»æ–¹æ¡ˆæ•°å¯¹åº”`F(x)^m`çš„`x^{2m-2}`é¡¹ç³»æ•°ã€‚  
- **æœ‰ké™åˆ¶æ—¶**ï¼šæ°å¥½`k`ä¸ªé“¾çš„è´¡çŒ®å˜ä¸º`d!`ï¼ˆå¯¹åº”åŒºé—´`L_i+1=R_i`ï¼‰ï¼Œå…¶ä½™å˜ä¸º`(d+1)!-d!`ï¼Œç”Ÿæˆå‡½æ•°æ‹†åˆ†ä¸º`F1(x)^k * F2(x)^{m-k}`ï¼ˆ`F1(x)=sum d!x^d`ï¼Œ`F2(x)=sum ((d+1)!-d!)x^d`ï¼‰ã€‚  
- **æ ¸å¿ƒéš¾ç‚¹**ï¼šå°†æ ‘ç»“æ„è½¬åŒ–ä¸ºç”Ÿæˆå‡½æ•°ï¼Œä»¥åŠç”¨å¤šé¡¹å¼ç®—æ³•é«˜æ•ˆè®¡ç®—é«˜æ¬¡å¹‚ã€‚  

### å¯è§†åŒ–è®¾è®¡æ€è·¯
æˆ‘ä»¬ç”¨**8ä½åƒç´ é£â€œçƒ¹é¥ªæ¸¸æˆâ€**æ¼”ç¤ºç”Ÿæˆå‡½æ•°çš„æ„å»ºä¸è¿ç®—ï¼š  
- æŠŠé“¾é•¿çš„è´¡çŒ®ï¼ˆ`d!`/`(d+1)!`ï¼‰åšæˆåƒç´ åŒ–â€œé£Ÿæâ€ï¼ˆæ¯”å¦‚é“¾é•¿1æ˜¯çº¢è‰²æ–¹å—ï¼Œæ ‡`1!`ï¼›é“¾é•¿2æ˜¯è“è‰²æ–¹å—ï¼Œæ ‡`2!`ï¼‰ã€‚  
- å¤šé¡¹å¼ä¹˜æ³•åƒâ€œç¿»ç‚’é£Ÿæâ€ï¼šä¸¤ä¸ªç”Ÿæˆå‡½æ•°çš„åƒç´ å—åœ¨â€œé”…ç‚‰â€é‡Œæ—‹è½¬ã€åˆå¹¶ï¼Œé«˜äº®å½“å‰ç›¸ä¹˜çš„é¡¹ï¼Œä¼´éšâ€œç¿»ç‚’â€éŸ³æ•ˆã€‚  
- æœ€ç»ˆç³»æ•°ç”¨â€œè›‹ç³•é«˜åº¦â€å±•ç¤ºï¼ˆé«˜åº¦å¯¹åº”ç³»æ•°å¤§å°ï¼‰ï¼Œå®Œæˆæ—¶æ’­æ”¾â€œä¸Šèœâ€éŸ³æ•ˆï¼Œå¢å¼ºæˆå°±æ„Ÿã€‚


## 2. ç²¾é€‰ä¼˜è´¨é¢˜è§£å‚è€ƒ

### é¢˜è§£ä¸€ï¼ˆä½œè€…ï¼šDaiRuiChen007ï¼‰
* **ç‚¹è¯„**ï¼šè¿™ä»½é¢˜è§£æ˜¯**â€œç†è®º+ä»£ç â€çš„å®Œæ•´ç¤ºèŒƒ**ï¼æ€è·¯ä»æ— ké™åˆ¶åˆ°æœ‰ké™åˆ¶é€æ­¥æ¨å¯¼ï¼Œç”Ÿæˆå‡½æ•°çš„è½¬åŒ–é€»è¾‘ä¸¥è°¨ã€‚ä»£ç ç”¨`namespace`å°è£…å¤šé¡¹å¼æ“ä½œï¼ˆ`ntt`/`ln`/`exp`ï¼‰ï¼Œå˜é‡å`f`ï¼ˆå¯¹åº”`d!`ï¼‰ã€`g`ï¼ˆå¯¹åº”`(d+1)!-d!`ï¼‰å«ä¹‰æ˜ç¡®ï¼Œç”šè‡³å¤„ç†äº†`n=1`çš„è¾¹ç•Œæƒ…å†µã€‚ç®—æ³•ä¸Šï¼Œå¤šé¡¹å¼å¿«é€Ÿå¹‚æŠŠå¤æ‚åº¦é™åˆ°`O(n log n)`ï¼Œèƒ½å¤„ç†`n=2e5`çš„å¤§è§„æ¨¡æ•°æ®ï¼Œå®è·µä»·å€¼æé«˜â€”â€”ç›´æ¥æŠ„è¿™ä»½ä»£ç ï¼Œå°±èƒ½è§£å†³åŒç±»ç”Ÿæˆå‡½æ•°é—®é¢˜ï¼


## 3. æ ¸å¿ƒéš¾ç‚¹è¾¨æä¸è§£é¢˜ç­–ç•¥

### ğŸ” æ ¸å¿ƒéš¾ç‚¹ä¸è§£å†³æ–¹æ³•
1. **æ ‘ç»“æ„â†’ç”Ÿæˆå‡½æ•°çš„è½¬åŒ–**  
   - **éš¾ç‚¹**ï¼šå¦‚ä½•æŠŠæ ‘çš„é“¾é•¿å¯¹åº”åˆ°ç”Ÿæˆå‡½æ•°çš„é¡¹ï¼Ÿ  
   - **è§£å†³**ï¼šé“¾é•¿`d`çš„åŒºé—´æ’åˆ—æ•°æ˜¯`(d+1)!`ï¼Œæ‰€ä»¥ç”Ÿæˆå‡½æ•°çš„é¡¹æ˜¯`(d+1)! x^d`ï¼ˆæ¯”å¦‚é“¾é•¿1è´¡çŒ®`2!x^1=2x`ï¼‰ã€‚  

2. **ké™åˆ¶çš„å¤„ç†**  
   - **éš¾ç‚¹**ï¼šå¦‚ä½•åŒºåˆ†â€œæ»¡è¶³`L_i+1=R_i`çš„é“¾â€å’Œâ€œä¸æ»¡è¶³çš„é“¾â€ï¼Ÿ  
   - **è§£å†³**ï¼šæ»¡è¶³æ¡ä»¶çš„é“¾è´¡çŒ®ä»`(d+1)!`å˜ä¸º`d!`ï¼ˆæ— æ³•æ’å…¥ä¸­é—´å…ƒç´ ï¼‰ï¼Œå…¶ä½™å˜ä¸º`(d+1)!-d!`ï¼ˆæ’é™¤`d!`çš„æƒ…å†µï¼‰ã€‚ç”Ÿæˆå‡½æ•°æ‹†åˆ†ä¸º`F1(x)^k * F2(x)^{m-k}`ï¼Œåˆ†åˆ«å¯¹åº”ä¸¤ç§é“¾ã€‚  

3. **å¤šé¡¹å¼å¿«é€Ÿå¹‚çš„å®ç°**  
   - **éš¾ç‚¹**ï¼šå¦‚ä½•é«˜æ•ˆè®¡ç®—ç”Ÿæˆå‡½æ•°çš„é«˜æ¬¡å¹‚ï¼Ÿ  
   - **è§£å†³**ï¼šåˆ©ç”¨æ•°å­¦æ€§è´¨`a^b = exp(b * ln a)`ï¼ŒæŠŠå¹‚æ¬¡è¿ç®—è½¬åŒ–ä¸º`ln`ï¼ˆå¯¹æ•°ï¼‰å’Œ`exp`ï¼ˆæŒ‡æ•°ï¼‰çš„ç»„åˆï¼Œå†ç”¨`ntt`ï¼ˆæ•°è®ºå˜æ¢ï¼‰åŠ é€Ÿå¤šé¡¹å¼ä¹˜æ³•ã€‚


### âœ¨ è§£é¢˜æŠ€å·§æ€»ç»“
- **é—®é¢˜è½¬åŒ–**ï¼šæŠŠè®¡æ•°é—®é¢˜æŠ½è±¡ä¸ºç”Ÿæˆå‡½æ•°â€”â€”æ ‘çš„ç»“æ„â†’ç”Ÿæˆå‡½æ•°çš„é¡¹ï¼Œç»„åˆæ–¹å¼â†’ç”Ÿæˆå‡½æ•°çš„å¹‚æ¬¡ã€‚  
- **é™åˆ¶æ‹†åˆ†**ï¼šç”¨ä¸åŒçš„ç”Ÿæˆå‡½æ•°é¡¹å¯¹åº”é™åˆ¶æ¡ä»¶ï¼ˆæ¯”å¦‚`k`ä¸ªç‰¹æ®Šé“¾â†’`F1(x)^k`ï¼‰ã€‚  
- **å¤šé¡¹å¼å·¥å…·**ï¼šæŒæ¡`ntt`/`ln`/`exp`ç­‰åŸºç¡€æ“ä½œï¼Œæ˜¯å¤„ç†å¤§è§„æ¨¡ç”Ÿæˆå‡½æ•°é—®é¢˜çš„å…³é”®ã€‚


## 4. C++æ ¸å¿ƒä»£ç å®ç°èµæ

### æœ¬é¢˜é€šç”¨æ ¸å¿ƒC++å®ç°å‚è€ƒ
* **è¯´æ˜**ï¼šæ­¤ä»£ç æ¥è‡ªDaiRuiChen007çš„é¢˜è§£ï¼Œæ˜¯**ç”Ÿæˆå‡½æ•°+å¤šé¡¹å¼å¿«é€Ÿå¹‚çš„å®Œæ•´å®ç°**ï¼Œé€»è¾‘æ¸…æ™°ã€æ•ˆç‡é«˜ã€‚
* **å®Œæ•´æ ¸å¿ƒä»£ç **ï¼š
```cpp
#include<bits/stdc++.h>
using namespace std;
namespace Polynomial {
const int MOD=998244353,N=1<<18,G=3;
int rev[N],inv[N],w[N<<1];
int ksm(int a,int b=MOD-2,int p=MOD) {
    int ret=1;
    for(;b;a=1ll*a*a%p,b>>=1) if(b&1) ret=1ll*ret*a%p;
    return ret;
}
void poly_init() {
    inv[1]=1;
    for(int i=2;i<N;++i) inv[i]=1ll*(MOD-MOD/i)*inv[MOD%i]%MOD;
    for(int k=1;k<=N;k<<=1) {
        int x=ksm(G,(MOD-1)/k); w[k]=1;
        for(int i=1;i<k;++i) w[i+k]=1ll*x*w[i+k-1]%MOD;
    }
}
int plen(int x) { int y=1; for(;y<x;y<<=1); return y; }
void ntt(int *f,bool idft,int n) {
    for(int i=0;i<n;++i) {
        rev[i]=(rev[i>>1]>>1);
        if(i&1) rev[i]|=n>>1;
    }
    for(int i=0;i<n;++i) if(rev[i]<i) swap(f[i],f[rev[i]]);
    for(int k=2,x,y;k<=n;k<<=1) {
        for(int i=0;i<n;i+=k) {
            for(int j=i;j<i+k/2;++j) {
                x=f[j],y=1ll*f[j+k/2]*w[k+j-i]%MOD;
                f[j]=(x+y>=MOD)?x+y-MOD:x+y;
                f[j+k/2]=(x>=y)?x-y:x+MOD-y;
            }
        }
    }
    if(idft) {
        reverse(f+1,f+n);
        for(int i=0,x=ksm(n);i<n;++i) f[i]=1ll*f[i]*x%MOD;
    }
}
void poly_inv(const int *f,int *g,int n) {
    static int a[N];
    g[0]=ksm(f[0]);
    int k=2;
    for(;k<(n<<1);k<<=1) {
        memcpy(a,f,k*sizeof(int));
        ntt(g,0,k<<1),ntt(a,0,k<<1);
        for(int i=0;i<(k<<1);++i) g[i]=1ll*g[i]*(2-1ll*a[i]*g[i]%MOD+MOD)%MOD;
        ntt(g,1,k<<1);
        memset(g+k,0,k*sizeof(int));
    }
}
void poly_ln(const int *f,int *g,int n) {
    static int a[N],b[N];
    poly_inv(f,a,n);
    for(int i=1;i<n;++i) b[i-1]=1ll*i*f[i]%MOD;
    int m=plen(n<<1);
    ntt(a,0,m),ntt(b,0,m);
    for(int i=0;i<m;++i) a[i]=1ll*a[i]*b[i]%MOD;
    ntt(a,1,m);
    g[0]=0;
    for(int i=1;i<n;++i) g[i]=1ll*a[i-1]*inv[i]%MOD;
}
void poly_exp(const int *f,int *g,int n) {
    static int a[N];
    g[0]=1;
    int k=2;
    for(;k<(n<<1);k<<=1) {
        poly_ln(g,a,k);
        for(int i=0;i<k;++i) a[i]=(f[i]+MOD-a[i])%MOD;
        a[0]=(a[0]+1)%MOD;
        ntt(a,0,k<<1),ntt(g,0,k<<1);
        for(int i=0;i<(k<<1);++i) g[i]=1ll*g[i]*a[i]%MOD;
        ntt(g,1,k<<1);
        memset(g+k,0,k*sizeof(int));
    }
}
void poly_qpow(const int *f,int *g,int n,int k) {
    static int a[N];
    poly_ln(f,a,n);
    for(int i=0;i<n;++i) a[i]=1ll*a[i]*k%MOD;
    poly_exp(a,g,n);
}
}
using Polynomial::ntt;
using Polynomial::ksm;
const int N=1<<18,MOD=998244353;
int n,m,k,f[N],g[N],fac[N],ifac[N],a[N],b[N];
signed main() {
    Polynomial::poly_init();
    scanf("%d%d",&n,&k),m=(n+1)>>1;
    if(n==1) return puts(k?"1":"0"),0;
    if(k>m) return puts("0"),0;
    for(int i=fac[0]=ifac[0]=1;i<N;++i) {
        fac[i]=1ll*fac[i-1]*i%MOD;
        ifac[i]=ksm(fac[i]);
    }
    for(int i=1;i<m;++i) {
        f[i-1]=fac[i];
        g[i-1]=(fac[i+1]+MOD-fac[i])%MOD;
    }
    Polynomial::poly_qpow(f,a,m,k);
    Polynomial::poly_qpow(g,b,m,m-k);
    ntt(a,0,N),ntt(b,0,N);
    for(int i=0;i<N;++i) a[i]=1ll*a[i]*b[i]%MOD;
    ntt(a,1,N);
    printf("%lld\n",2ll*ksm(m)*fac[m]%MOD*ifac[k]%MOD*ifac[m-k]%MOD*a[m-2]%MOD);
    return 0;
}
```
* **ä»£ç è§£è¯»æ¦‚è¦**ï¼š
1. **å¤šé¡¹å¼å·¥å…·**ï¼šå°è£…äº†`ntt`ï¼ˆæ•°è®ºå˜æ¢ï¼‰ã€`poly_inv`ï¼ˆæ±‚é€†ï¼‰ã€`poly_ln`ï¼ˆå¯¹æ•°ï¼‰ã€`poly_exp`ï¼ˆæŒ‡æ•°ï¼‰ç­‰å‡½æ•°ï¼Œç”¨äºå¿«é€Ÿè®¡ç®—å¤šé¡¹å¼å¹‚æ¬¡ã€‚
2. **ç”Ÿæˆå‡½æ•°æ„å»º**ï¼š`f`æ•°ç»„å­˜`d!`çš„é¡¹ï¼ˆå¯¹åº”kä¸ªç‰¹æ®Šé“¾ï¼‰ï¼Œ`g`æ•°ç»„å­˜`(d+1)!-d!`çš„é¡¹ï¼ˆå¯¹åº”å…¶ä»–é“¾ï¼‰ã€‚
3. **å¿«é€Ÿå¹‚è®¡ç®—**ï¼šç”¨`poly_qpow`è®¡ç®—`f^k`å’Œ`g^{m-k}`ï¼Œå†é€šè¿‡`ntt`ç›¸ä¹˜å¾—åˆ°å·ç§¯ç»“æœã€‚
4. **ç»“æœè®¡ç®—**ï¼šå–å·ç§¯ç»“æœçš„`m-2`é¡¹ç³»æ•°ï¼Œç»“åˆç»„åˆæ•°å…¬å¼å¾—åˆ°æœ€ç»ˆç­”æ¡ˆã€‚


### é¢˜è§£ä¸€ï¼ˆä½œè€…ï¼šDaiRuiChen007ï¼‰ç‰‡æ®µèµæ
* **äº®ç‚¹**ï¼šç”¨`poly_qpow`å®ç°å¤šé¡¹å¼å¿«é€Ÿå¹‚ï¼ŒæŠŠå¹‚æ¬¡è¿ç®—è½¬åŒ–ä¸º`ln`+`exp`ï¼Œé«˜æ•ˆå¤„ç†å¤§è§„æ¨¡æ•°æ®ã€‚
* **æ ¸å¿ƒä»£ç ç‰‡æ®µ**ï¼š
```cpp
void poly_qpow(const int *f,int *g,int n,int k) {
    static int a[N];
    poly_ln(f,a,n);       // å–å¯¹æ•°ï¼šln(f)
    for(int i=0;i<n;++i)  // ä¹˜ä»¥å¹‚æ¬¡k
        a[i]=1ll*a[i]*k%MOD;
    poly_exp(a,g,n);      // å–æŒ‡æ•°ï¼šexp(k*ln(f)) = f^k
}
```
* **ä»£ç è§£è¯»**ï¼š
è¿™æ®µä»£ç æ˜¯**å¤šé¡¹å¼å¿«é€Ÿå¹‚çš„æ ¸å¿ƒ**ï¼ä¸ºä»€ä¹ˆèƒ½è¿™æ ·åšï¼Ÿå› ä¸ºæ•°å­¦ä¸Š`a^b = e^{b*ln a}`â€”â€”æŠŠå¹‚æ¬¡è¿ç®—è½¬åŒ–ä¸ºå¯¹æ•°å’ŒæŒ‡æ•°çš„ç»„åˆï¼Œè€Œ`ln`å’Œ`exp`å¯ä»¥ç”¨`ntt`é«˜æ•ˆè®¡ç®—ã€‚æ¯”å¦‚ï¼Œ`f`æ˜¯ç”Ÿæˆå‡½æ•°`sum d!x^d`ï¼Œ`f^k`å°±æ˜¯kä¸ªè¿™æ ·çš„ç”Ÿæˆå‡½æ•°ç›¸ä¹˜ï¼Œå¯¹åº”kä¸ªç‰¹æ®Šé“¾çš„æ‰€æœ‰ç»„åˆã€‚
* **å­¦ä¹ ç¬”è®°**ï¼šå¤šé¡¹å¼å¿«é€Ÿå¹‚çš„å…³é”®æ˜¯â€œå¯¹æ•°-æŒ‡æ•°å˜æ¢â€ï¼ŒæŠŠé«˜æ¬¡å¹‚è½¬åŒ–ä¸ºçº¿æ€§è¿ç®—ï¼Œä»è€Œé™ä½å¤æ‚åº¦ã€‚


## 5. ç®—æ³•å¯è§†åŒ–ï¼šåƒç´ åŠ¨ç”»æ¼”ç¤ºæ–¹æ¡ˆ

### ğŸ® åŠ¨ç”»ä¸»é¢˜ï¼šç”Ÿæˆå‡½æ•°çš„â€œçƒ¹é¥ªä¹‹æ—…â€
**è®¾è®¡æ€è·¯**ï¼šç”¨8ä½åƒç´ é£æ¨¡æ‹Ÿâ€œå¨æˆ¿â€ï¼ŒæŠŠç”Ÿæˆå‡½æ•°çš„é¡¹å˜æˆâ€œé£Ÿæâ€ï¼Œå¤šé¡¹å¼è¿ç®—å˜æˆâ€œçƒ¹é¥ªæ­¥éª¤â€â€”â€”æ—¢å¤å¤æœ‰è¶£ï¼Œåˆèƒ½ç›´è§‚å±•ç¤ºç®—æ³•é€»è¾‘ã€‚

### ğŸ“½ï¸ åŠ¨ç”»å¸§ä¸äº¤äº’è®¾è®¡
1. **åœºæ™¯åˆå§‹åŒ–**ï¼š
   - å·¦ä¾§â€œé£ŸæåŒºâ€ï¼šå±•ç¤ºä¸åŒé“¾é•¿çš„åƒç´ åŒ–é£Ÿæï¼ˆé“¾é•¿1æ˜¯çº¢è‰²æ–¹å—ï¼Œæ ‡`1!`ï¼›é“¾é•¿2æ˜¯è“è‰²æ–¹å—ï¼Œæ ‡`2!`ï¼‰ã€‚
   - ä¸­é—´â€œçƒ¹é¥ªåŒºâ€ï¼šä¸€ä¸ªå¤§é”…ç‚‰ï¼ˆä»£è¡¨ç”Ÿæˆå‡½æ•°ï¼‰ï¼Œæ—è¾¹æ˜¯æ§åˆ¶é¢æ¿ï¼ˆå¼€å§‹/æš‚åœã€å•æ­¥ã€é‡ç½®ã€é€Ÿåº¦æ»‘å—ï¼‰ã€‚
   - å³ä¾§â€œç»“æœåŒºâ€ï¼šç”¨åƒç´ å—é«˜åº¦å±•ç¤ºç”Ÿæˆå‡½æ•°ç³»æ•°ï¼ˆæ¯”å¦‚`a[m-2]`çš„é«˜åº¦å¯¹åº”ç­”æ¡ˆå¤§å°ï¼‰ã€‚
   - æ’­æ”¾8ä½é£æ ¼èƒŒæ™¯éŸ³ä¹ï¼ˆæ¯”å¦‚ã€Šè¶…çº§é©¬é‡Œå¥¥ã€‹çš„è½»å¿«æ—‹å¾‹ï¼‰ã€‚

2. **ç”Ÿæˆå‡½æ•°æ„å»º**ï¼š
   - ç‚¹å‡»â€œå¼€å§‹â€ï¼Œé£ŸæåŒºçš„é£Ÿæé€ä¸ªâ€œè·³è¿›â€é”…ç‚‰ï¼šé“¾é•¿1çš„çº¢è‰²æ–¹å—è·³è¿›é”…ç‚‰ï¼Œä¼´éšâ€œå®å’šâ€éŸ³æ•ˆï¼Œé”…ç‚‰ä¸­`f[0]`ä½ç½®æ˜¾ç¤º`1!`ã€‚
   - é“¾é•¿2çš„è“è‰²æ–¹å—è·³è¿›é”…ç‚‰ï¼Œ`f[1]`æ˜¾ç¤º`2!`ï¼Œä¾æ­¤ç±»æ¨ï¼Œç›´åˆ°æ„å»ºå®Œ`f`å’Œ`g`æ•°ç»„ã€‚

3. **å¤šé¡¹å¼å¿«é€Ÿå¹‚**ï¼š
   - **æ…æ‹Œï¼ˆlnå˜æ¢ï¼‰**ï¼šé”…ç‚‰ä¸­çš„`f`æ•°ç»„å¼€å§‹æ‘‡æ™ƒï¼Œä¼´éšâ€œæ…æ‹Œâ€éŸ³æ•ˆï¼Œå±•ç¤º`poly_ln`çš„è¿‡ç¨‹ï¼ˆæ•°ç»„å…ƒç´ å˜åŒ–ï¼‰ã€‚
   - **è°ƒå‘³ï¼ˆä¹˜kï¼‰**ï¼šæ¯ä¸ªå…ƒç´ ä¹˜ä»¥kï¼Œåƒç´ å—å¤§å°å˜å¤§ï¼Œä»£è¡¨å¹‚æ¬¡çš„æå‡ã€‚
   - **çƒ˜çƒ¤ï¼ˆexpå˜æ¢ï¼‰**ï¼šé”…ç‚‰å†’çƒ­æ°”ï¼Œä¼´éšâ€œçƒ˜çƒ¤â€éŸ³æ•ˆï¼Œå±•ç¤º`poly_exp`çš„è¿‡ç¨‹ï¼Œå¾—åˆ°`f^k`æ•°ç»„ã€‚

4. **å·ç§¯è¿ç®—**ï¼š
   - æŠŠ`f^k`å’Œ`g^{m-k}`çš„åƒç´ å—â€œå€’è¿›â€å¦ä¸€ä¸ªé”…ç‚‰ï¼Œå¼€å§‹â€œç¿»ç‚’â€ï¼ˆæ—‹è½¬ï¼‰ï¼Œä¼´éšâ€œç¿»ç‚’â€éŸ³æ•ˆï¼Œå±•ç¤º`ntt`ç›¸ä¹˜çš„è¿‡ç¨‹ã€‚
   - ç¿»ç‚’å®Œæˆåï¼Œâ€œè¿‡æ»¤â€ï¼ˆé€†`ntt`ï¼‰å¾—åˆ°å·ç§¯ç»“æœï¼Œç»“æœåŒºçš„`a[m-2]`åƒç´ å—é«˜äº®ï¼Œæ˜¾ç¤ºç³»æ•°å¤§å°ã€‚

5. **ç»“æœå±•ç¤º**ï¼š
   - è‹¥ç­”æ¡ˆé0ï¼Œ`a[m-2]`åƒç´ å—é—ªçƒï¼Œä¼´éšâ€œä¸Šèœâ€éŸ³æ•ˆï¼Œæ˜¾ç¤ºæœ€ç»ˆç­”æ¡ˆã€‚
   - è‹¥ç­”æ¡ˆä¸º0ï¼ˆæ¯”å¦‚æ ·ä¾‹2ï¼‰ï¼Œæ˜¾ç¤ºâ€œæ²¡æœ‰ç¬¦åˆæ¡ä»¶çš„åºåˆ—â€ï¼Œä¼´éšâ€œé”™è¯¯â€éŸ³æ•ˆã€‚

### ğŸ® äº¤äº’æ§åˆ¶
- **å•æ­¥æ¨¡å¼**ï¼šç‚¹å‡»â€œå•æ­¥â€æŒ‰é’®ï¼Œé€å¸§è§‚çœ‹ç”Ÿæˆå‡½æ•°æ„å»ºã€`ln`/`exp`å˜æ¢ã€å·ç§¯çš„è¿‡ç¨‹ã€‚
- **è‡ªåŠ¨æ’­æ”¾**ï¼šæ‹–åŠ¨é€Ÿåº¦æ»‘å—è°ƒèŠ‚æ’­æ”¾é€Ÿåº¦ï¼Œç®—æ³•è‡ªåŠ¨æ‰§è¡Œæ‰€æœ‰æ­¥éª¤ï¼Œåƒâ€œAIå¨å¸ˆâ€ä¸€æ ·å®Œæˆçƒ¹é¥ªã€‚
- **é‡ç½®**ï¼šå›åˆ°åˆå§‹çŠ¶æ€ï¼Œé‡æ–°å¼€å§‹åŠ¨ç”»ã€‚


## 6. æ‹“å±•ç»ƒä¹ ä¸ç›¸ä¼¼é—®é¢˜æ€è€ƒ

### ğŸ” é€šç”¨æ€è·¯è¿ç§»
ç”Ÿæˆå‡½æ•°+å¤šé¡¹å¼ç®—æ³•é€‚ç”¨äº**å¤§è§„æ¨¡è®¡æ•°é—®é¢˜**ï¼Œæ¯”å¦‚ï¼š
1. è®¡æ•°æ»¡è¶³â€œæ¯ä¸ªèŠ‚ç‚¹å­èŠ‚ç‚¹æ•°é™åˆ¶â€çš„æ ‘ç»“æ„ã€‚
2. è®¡ç®—æ»¡è¶³â€œå…ƒç´ å…³ç³»é™åˆ¶â€çš„åºåˆ—ä¸ªæ•°ã€‚
3. æ¨¡æ„ä¹‰ä¸‹çš„é«˜æ¬¡ç»„åˆæ•°è®¡ç®—ã€‚

### ğŸ“š æ¨èç»ƒä¹ ï¼ˆæ´›è°·ï¼‰
1. **P3723 [AH2017/HNOI2017] ç¤¼ç‰©**  
   - æ¨èç†ç”±ï¼šç”¨å¤šé¡¹å¼ä¹˜æ³•è®¡ç®—ä¸¤ä¸ªåºåˆ—çš„æœ€å°å·®å€¼ï¼Œå·©å›º`ntt`çš„åº”ç”¨ã€‚
2. **P4721 ã€æ¨¡æ¿ã€‘åˆ†æ²» FFT**  
   - æ¨èç†ç”±ï¼šç”¨åˆ†æ²»+FFTè®¡ç®—ç”Ÿæˆå‡½æ•°å·ç§¯ï¼ŒåŠ æ·±å¯¹ç”Ÿæˆå‡½æ•°çš„ç†è§£ã€‚
3. **P5488 å·®åˆ†ä¸å‰ç¼€å’Œ**  
   - æ¨èç†ç”±ï¼šç”¨ç”Ÿæˆå‡½æ•°è®¡ç®—é«˜æ¬¡å‰ç¼€å’Œï¼Œç»ƒä¹ ç”Ÿæˆå‡½æ•°çš„å¹‚æ¬¡è¿ç®—ã€‚


## 7. å­¦ä¹ å¿ƒå¾—ä¸ç»éªŒåˆ†äº«

**å‚è€ƒç»éªŒï¼ˆæ¥è‡ªDaiRuiChen007çš„é¢˜è§£ï¼‰**ï¼š  
â€œä»æ— ké™åˆ¶çš„æƒ…å†µå…¥æ‰‹ï¼Œé€æ­¥æ¨å¯¼åˆ°æœ‰ké™åˆ¶çš„ç”Ÿæˆå‡½æ•°å½¢å¼ï¼Œè¿™è®©æˆ‘æ„è¯†åˆ°å°†é—®é¢˜æ‹†è§£ä¸ºæ›´ç®€å•çš„å­é—®é¢˜çš„é‡è¦æ€§ã€‚â€  

**ç‚¹è¯„**ï¼šè¿™ä½ä½œè€…çš„ç»éªŒå¾ˆå®ç”¨ï¼è§£å†³å¤æ‚è®¡æ•°é—®é¢˜æ—¶ï¼Œ**å…ˆå¤„ç†æ— é™åˆ¶çš„æƒ…å†µï¼Œå†é€æ­¥æ·»åŠ é™åˆ¶**ï¼Œèƒ½æŠŠé—®é¢˜æ‹†è§£ä¸ºå¯å¤„ç†çš„æ­¥éª¤ã€‚æ¯”å¦‚æœ¬é¢˜ä¸­ï¼Œå…ˆæ¨å¯¼æ— ké™åˆ¶çš„ç”Ÿæˆå‡½æ•°ï¼Œå†ä¿®æ”¹é¡¹æ¥å¤„ç†kçš„é™åˆ¶ï¼Œå°±èƒ½é¿å…â€œä¸€æ­¥åˆ°ä½â€çš„å›°éš¾ã€‚


## ğŸ’ª æ€»ç»“
æœ¬æ¬¡åˆ†æè®©æˆ‘ä»¬å­¦ä¼šäº†**ç”¨ç”Ÿæˆå‡½æ•°æŠŠæ ‘ç»“æ„è½¬åŒ–ä¸ºæ•°å­¦æ¨¡å‹**ï¼Œå†ç”¨**å¤šé¡¹å¼å¿«é€Ÿå¹‚é«˜æ•ˆè®¡ç®—**ã€‚è®°ä½ï¼šè®¡æ•°é—®é¢˜çš„æ ¸å¿ƒæ˜¯â€œè½¬åŒ–â€â€”â€”æŠŠç°å®çš„ç»“æ„ï¼ˆæ¯”å¦‚æ ‘ã€åŒºé—´ï¼‰å˜æˆæ•°å­¦çš„â€œè¯­è¨€â€ï¼ˆç”Ÿæˆå‡½æ•°ï¼‰ï¼Œå†ç”¨ç®—æ³•è§£å†³ã€‚ç»§ç»­ç»ƒä¹ ï¼Œä½ ä¼šè¶Šæ¥è¶Šæ“…é•¿è¿™ç±»é—®é¢˜ï¼

ä¸‹æ¬¡æˆ‘ä»¬å†ä¸€èµ·æ¢ç´¢æ–°çš„ç¼–ç¨‹æŒ‘æˆ˜ï½ ğŸš€

---
å¤„ç†ç”¨æ—¶ï¼š124.55ç§’
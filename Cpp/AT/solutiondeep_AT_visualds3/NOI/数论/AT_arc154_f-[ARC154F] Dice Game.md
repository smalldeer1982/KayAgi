# é¢˜ç›®ä¿¡æ¯

# [ARC154F] Dice Game

## é¢˜ç›®æè¿°

æœ‰ä¸€ä¸ª $N$ é¢çš„éª°å­ï¼Œæ¯ä¸€é¢çš„å‡ºç°æ¦‚ç‡éƒ½ç›¸ç­‰ã€‚ä½ éœ€è¦ä¸æ–­æ·éª°å­ï¼Œç›´åˆ°æ‰€æœ‰çš„é¢éƒ½è‡³å°‘å‡ºç°è¿‡ä¸€æ¬¡ä¸ºæ­¢ã€‚

å¯¹äºæ»¡è¶³ $1 \le i \le M$ çš„æ¯ä¸ªæ•´æ•° $i$ï¼Œè¯·ä½ æ±‚å‡ºâ€œæ·éª°å­çš„æ¬¡æ•°çš„ $i$ æ¬¡å¹‚â€çš„æœŸæœ›å€¼ï¼Œå¹¶å¯¹ $998244353$ å–æ¨¡ã€‚

æœŸæœ›å€¼ $\bmod\ 998244353$ çš„å®šä¹‰ï¼šå¯ä»¥è¯æ˜ï¼Œæ‰€æ±‚çš„æœŸæœ›å€¼ä¸€å®šæ˜¯æœ‰ç†æ•°ã€‚åœ¨æœ¬é¢˜çš„çº¦æŸä¸‹ï¼Œå°†å…¶è¡¨ç¤ºä¸ºæœ€ç®€åˆ†æ•° $\frac{P}{Q}$ æ—¶ï¼Œ$Q \not\equiv 0 \pmod{998244353}$ ä¹Ÿæˆç«‹ã€‚å› æ­¤ï¼Œå­˜åœ¨å”¯ä¸€çš„æ•´æ•° $R$ æ»¡è¶³ $R \times Q \equiv P \pmod{998244353},\ 0 \le R < 998244353$ã€‚è¯·è¾“å‡ºè¿™ä¸ª $R$ã€‚

## è¯´æ˜/æç¤º

### é™åˆ¶æ¡ä»¶

- $1 \le N, M \le 2 \times 10^5$
- è¾“å…¥å‡ä¸ºæ•´æ•°ã€‚

### æ ·ä¾‹è§£é‡Š 1

å½“ $i=1$ æ—¶ï¼Œæ‰€æ±‚çš„æœŸæœ›å€¼æ˜¯æ‰€æœ‰é¢éƒ½å‡ºç°æ‰€éœ€çš„æ“ä½œæ¬¡æ•°ã€‚è¿™ä¸ªå€¼æ˜¯ $\frac{11}{2}$ã€‚

ç”± ChatGPT 4.1 ç¿»è¯‘

## æ ·ä¾‹ #1

### è¾“å…¥

```
3 3```

### è¾“å‡º

```
499122182

37

748683574```

## æ ·ä¾‹ #2

### è¾“å…¥

```
7 8```

### è¾“å‡º

```
449209977

705980975

631316005

119321168

62397541

596241562

584585746

378338599```

## æ ·ä¾‹ #3

### è¾“å…¥

```
2023 7```

### è¾“å‡º

```
442614988

884066164

757979000

548628857

593993207

780067557

524115712```

# AIåˆ†æç»“æœ

# ğŸ’¡ Kayçš„C++ç®—æ³•è§£æï¼šARC154F Dice Game æ·±å…¥å­¦ä¹ æŒ‡å— ğŸ’¡

å¤§å®¶å¥½ï¼Œæˆ‘æ˜¯Kayï¼ä»Šå¤©æˆ‘ä»¬è¦ä¸€èµ·æ”»å…‹ARC154Fè¿™é“å…³äºâ€œéª°å­æœŸæœ›â€çš„ç¼–ç¨‹é¢˜ã€‚è¿™é“é¢˜éœ€è¦ç»“åˆ**ç”Ÿæˆå‡½æ•°**ã€**åˆ†æ²»NTT**å’Œ**å¤šé¡¹å¼æ±‚é€†**ç­‰ç®—æ³•ï¼Œæ˜¯ä¸€é“é”»ç‚¼â€œæ•°å­¦å»ºæ¨¡+é«˜æ•ˆè®¡ç®—â€èƒ½åŠ›çš„å¥½é¢˜ã€‚è®©æˆ‘ä»¬ä¸€æ­¥æ­¥æ‹†è§£å®ƒ~


## 1. é¢˜ç›®è§£è¯»ä¸æ ¸å¿ƒç®—æ³•è¯†åˆ«

### âœ¨ æœ¬é¢˜ä¸»è¦è€ƒå¯Ÿ
**ç”Ÿæˆå‡½æ•° + åˆ†æ²»NTT + å¤šé¡¹å¼æ±‚é€†**  
ç”Ÿæˆå‡½æ•°å°±åƒâ€œæ•°å­¦ç¿»è¯‘å™¨â€â€”â€”æŠŠæ¦‚ç‡ã€æœŸæœ›çš„é—®é¢˜è½¬æ¢æˆå¤šé¡¹å¼çš„åŠ å‡ä¹˜é™¤ï¼›åˆ†æ²»NTTæ˜¯â€œå¿«é€Ÿè®¡ç®—å™¨â€â€”â€”èƒ½åœ¨O(n logÂ²n)æ—¶é—´å†…è®¡ç®—å¤šä¸ªå¤šé¡¹å¼çš„ä¹˜ç§¯ï¼›å¤šé¡¹å¼æ±‚é€†åˆ™æ˜¯â€œè§£æ–¹ç¨‹çš„é’¥åŒ™â€â€”â€”å¸®æˆ‘ä»¬å¤„ç†åˆ†å¼å½¢å¼çš„ç”Ÿæˆå‡½æ•°ã€‚


### ğŸ—£ï¸ åˆæ­¥åˆ†æ
é¢˜ç›®è¦æ±‚ï¼šæ·Né¢éª°å­ç›´åˆ°æ‰€æœ‰é¢éƒ½å‡ºç°ï¼Œæ±‚â€œæ·æ¬¡æ•°çš„iæ¬¡å¹‚â€çš„æœŸæœ›ï¼ˆi=1~Mï¼‰ï¼Œç»“æœæ¨¡998244353ã€‚  
æ ¸å¿ƒæ€è·¯ï¼š  
1. **æ¦‚ç‡ç”Ÿæˆå‡½æ•°ï¼ˆPGFï¼‰**ï¼šå®šä¹‰F_i(x)ä¸ºâ€œä»å·²å‡ºç°iç§é¢åˆ°i+1ç§é¢â€çš„æ¬¡æ•°åˆ†å¸ƒçš„ç”Ÿæˆå‡½æ•°ï¼ˆæ¯”å¦‚F_i(x) = (p_i x)/(1-(1-p_i)x)ï¼Œå…¶ä¸­p_i=(N-i)/Nï¼‰ã€‚  
2. **æ€»ç”Ÿæˆå‡½æ•°**ï¼šæ‰€æœ‰F_i(x)çš„ä¹˜ç§¯å°±æ˜¯â€œæ€»æ¬¡æ•°â€çš„ç”Ÿæˆå‡½æ•°F(x)ã€‚  
3. **çŸ©æ¯å‡½æ•°ï¼ˆMGFï¼‰**ï¼šæœŸæœ›çš„iæ¬¡å¹‚å¯¹åº”F(e^x)çš„ç³»æ•°ï¼ˆå› ä¸ºMGFæ˜¯PGFä»£å…¥e^xï¼Œå±•å¼€åç³»æ•°å«iæ¬¡å¹‚çš„æœŸæœ›ï¼‰ã€‚  
4. **å¤šé¡¹å¼è¿ç®—**ï¼šé€šè¿‡åˆ†æ²»NTTè®¡ç®—F(x)çš„åˆ†æ¯ï¼Œå†ç”¨å¤šé¡¹å¼æ±‚é€†å¾—åˆ°F(e^x)çš„ç³»æ•°ï¼Œæœ€ç»ˆå¾—åˆ°æœŸæœ›ã€‚


### ğŸ® å¯è§†åŒ–è®¾è®¡æ€è·¯
æˆ‘ä»¬å¯ä»¥è®¾è®¡ä¸€ä¸ª**åƒç´ é£æ ¼çš„â€œå¤šé¡¹å¼ç§¯æœ¨æ¸¸æˆâ€**ï¼š  
- ç”¨ä¸åŒé¢œè‰²çš„åƒç´ å—ä»£è¡¨å¤šé¡¹å¼çš„ç³»æ•°ï¼ˆæ¯”å¦‚çº¢è‰²å—æ˜¯xâ°é¡¹ï¼Œè“è‰²å—æ˜¯xÂ¹é¡¹ï¼‰ï¼›  
- åˆ†æ²»è¿‡ç¨‹ä¸­ï¼Œå·¦å³å­å¤šé¡¹å¼çš„åƒç´ å—ä¼šâ€œåˆå¹¶â€â€”â€”ç›¸ä¹˜æ—¶é—ªçƒï¼Œç›¸åŠ æ—¶ç§»åŠ¨åˆ°å¯¹åº”ä½ç½®ï¼›  
- å…³é”®æ“ä½œï¼ˆæ¯”å¦‚NTTå˜æ¢ã€å¤šé¡¹å¼æ±‚é€†ï¼‰ä¼šæ’­æ”¾â€œå®â€â€œå’”å—’â€çš„åƒç´ éŸ³æ•ˆï¼›  
- å®Œæˆè®¡ç®—æ—¶ï¼Œå±å¹•ä¼šå¼¹å‡ºâ€œèƒœåˆ©â€åŠ¨ç”»ï¼ˆæ¯”å¦‚åƒç´ çƒŸèŠ±ï¼‰å¹¶æ’­æ”¾ä¸Šæ‰¬çš„éŸ³æ•ˆã€‚  


## 2. ç²¾é€‰ä¼˜è´¨é¢˜è§£å‚è€ƒ

ä¸ºå¤§å®¶ç­›é€‰äº†3ä»½**æ€è·¯æ¸…æ™°ã€ä»£ç è§„èŒƒã€æŠ€å·§å®ç”¨**çš„ä¼˜è´¨é¢˜è§£ï¼š


### ğŸ“Œ é¢˜è§£ä¸€ï¼šOtomachi_Una_ï¼ˆçŸ©æ¯å‡½æ•°è½¬æ¢ï¼‰
**ç‚¹è¯„**ï¼šè¿™ä»½é¢˜è§£çš„â€œç‚¹ç›ä¹‹ç¬”â€æ˜¯**æ¦‚ç‡ç”Ÿæˆå‡½æ•°è½¬çŸ©æ¯å‡½æ•°**çš„æ¨å¯¼â€”â€”ç›´æ¥å°†æ¯ä¸ªF_i(x)ä»£å…¥e^xï¼ŒæŠŠé—®é¢˜ç®€åŒ–ä¸ºâ€œå¤šé¡¹å¼é™¤æ³•â€ã€‚ä»£ç ä¸­ç”¨åˆ†æ²»NTTè®¡ç®—åˆ†æ¯ï¼Œå¤šé¡¹å¼æ±‚é€†å¤„ç†åˆ†å¼ï¼Œé€»è¾‘é“¾éå¸¸æ¸…æ™°ã€‚å°¤å…¶é€‚åˆåˆšæ¥è§¦ç”Ÿæˆå‡½æ•°çš„åŒå­¦ç†è§£â€œä¸ºä»€ä¹ˆè¦ä»£å…¥e^xâ€ã€‚


### ğŸ“Œ é¢˜è§£äºŒï¼šFido_Puppyï¼ˆä¸‹é™å¹‚+æ–¯ç‰¹æ—æ•°ï¼‰
**ç‚¹è¯„**ï¼šæ­¤é¢˜è§£å¦è¾Ÿè¹Šå¾„â€”â€”ç”¨**ä¸‹é™å¹‚æœŸæœ›**ä»£æ›¿æ™®é€šå¹‚æœŸæœ›ã€‚é€šè¿‡å®¹æ–¥æ¨å¯¼ä¸‹é™å¹‚çš„è¡¨è¾¾å¼ï¼Œå†ç”¨æ–¯ç‰¹æ—æ•°å°†ä¸‹é™å¹‚è½¬æ¢ä¸ºæ™®é€šå¹‚ã€‚è¿™ç§â€œæ›²çº¿æ•‘å›½â€çš„æ€è·¯é¿å¼€äº†å¤æ‚çš„ç”Ÿæˆå‡½æ•°ä»£å…¥ï¼Œé€‚åˆå–œæ¬¢â€œç»„åˆæ•°å­¦â€çš„åŒå­¦ã€‚


### ğŸ“Œ é¢˜è§£ä¸‰ï¼šDaiRuiChen007ï¼ˆåˆ†æ²»NTT+å¤šé¡¹å¼æ±‚é€†ï¼‰
**ç‚¹è¯„**ï¼šè¿™ä»½é¢˜è§£çš„ä»£ç ç»“æ„æœ€å®Œæ•´â€”â€”ä»åˆ†æ²»NTTè®¡ç®—åˆ†æ¯å¤šé¡¹å¼ï¼Œåˆ°ç”Ÿæˆå‡½æ•°è½¬æ¢ï¼Œå†åˆ°å¤šé¡¹å¼æ±‚é€†ï¼Œæ¯ä¸€æ­¥éƒ½æœ‰è¯¦ç»†å®ç°ã€‚ä»£ç ä¸­çš„`cdq1`ï¼ˆåˆ†æ²»ç®—åˆ†æ¯ï¼‰å’Œ`cdq2`ï¼ˆç®—ç”Ÿæˆå‡½æ•°è½¬æ¢ï¼‰æ˜¯ç†è§£åˆ†æ²»NTTçš„å¥½ä¾‹å­ï¼Œé€‚åˆæƒ³è¦â€œæ‰‹æ•²ä»£ç â€çš„åŒå­¦å‚è€ƒã€‚


## 3. æ ¸å¿ƒéš¾ç‚¹è¾¨æä¸è§£é¢˜ç­–ç•¥

### ğŸ§© éš¾ç‚¹1ï¼šç”Ÿæˆå‡½æ•°çš„è½¬æ¢ï¼ˆPGFâ†’MGFï¼‰
**é—®é¢˜**ï¼šä¸ºä»€ä¹ˆè¦æŠŠPGFä»£å…¥e^xï¼Ÿ  
**è§£ç­”**ï¼šPGFçš„ç³»æ•°æ˜¯â€œæ°å¥½kæ¬¡çš„æ¦‚ç‡â€ï¼Œè€ŒMGFçš„ç³»æ•°æ˜¯â€œkæ¬¡å¹‚çš„æœŸæœ›é™¤ä»¥k!â€ã€‚ä»£å…¥e^xåï¼ŒMGFçš„å±•å¼€å¼ç›´æ¥å¯¹åº”æˆ‘ä»¬éœ€è¦çš„æœŸæœ›ï¼ˆæ¯”å¦‚[x^i]MGF = E(X^i)/i!ï¼‰ã€‚


### ğŸ§© éš¾ç‚¹2ï¼šåˆ†æ²»NTTå¤„ç†å¤šé¡¹å¼ä¹˜ç§¯
**é—®é¢˜**ï¼šå¦‚ä½•é«˜æ•ˆè®¡ç®—Nä¸ªå¤šé¡¹å¼çš„ä¹˜ç§¯ï¼Ÿ  
**è§£ç­”**ï¼šç”¨åˆ†æ²»æ€æƒ³â€”â€”æŠŠNä¸ªå¤šé¡¹å¼åˆ†æˆå·¦å³ä¸¤åŠï¼Œé€’å½’è®¡ç®—ä¸¤åŠçš„ä¹˜ç§¯ï¼Œå†å°†ç»“æœç›¸ä¹˜ï¼ˆç”¨NTTå¿«é€Ÿè®¡ç®—ï¼‰ã€‚æ—¶é—´å¤æ‚åº¦æ˜¯O(n logÂ²n)ï¼Œæ¯”æš´åŠ›ç›¸ä¹˜çš„O(nÂ²)å¿«å¾—å¤šã€‚


### ğŸ§© éš¾ç‚¹3ï¼šå¤šé¡¹å¼æ±‚é€†
**é—®é¢˜**ï¼šå¦‚ä½•è®¡ç®—å¤šé¡¹å¼A(x)çš„é€†ï¼ˆå³æ‰¾B(x)ä½¿å¾—A(x)B(x)â‰¡1 mod x^mï¼‰ï¼Ÿ  
**è§£ç­”**ï¼šç”¨**ç‰›é¡¿è¿­ä»£æ³•**â€”â€”ä»Bâ‚€(x)=A(0)â»Â¹å¼€å§‹ï¼Œé€æ­¥è¿­ä»£Bâ‚–â‚Šâ‚(x) = Bâ‚–(x)Â·(2 - A(x)Bâ‚–(x))ï¼Œæ¯æ¬¡ç”¨NTTåŠ é€Ÿè®¡ç®—ã€‚


### ğŸ§© éš¾ç‚¹4ï¼šä¸‹é™å¹‚ä¸æ™®é€šå¹‚çš„è½¬æ¢
**é—®é¢˜**ï¼šå¦‚ä½•ä»ä¸‹é™å¹‚æœŸæœ›E(X^Ì²i)å¾—åˆ°æ™®é€šå¹‚æœŸæœ›E(Xâ±)ï¼Ÿ  
**è§£ç­”**ï¼šç”¨**ç¬¬äºŒç±»æ–¯ç‰¹æ—æ•°**ï¼ˆæŠŠiæ¬¡å¹‚æ‹†æˆiä¸ªä¸‹é™å¹‚çš„çº¿æ€§ç»„åˆï¼‰ï¼šE(Xâ±) = Î£â‚– S(i,k) E(X^Ì²k)ï¼Œå…¶ä¸­S(i,k)æ˜¯â€œå°†iä¸ªå…ƒç´ åˆ†æˆkä¸ªéç©ºé›†åˆâ€çš„æ–¹æ¡ˆæ•°ã€‚


## 4. C++æ ¸å¿ƒä»£ç å®ç°èµæ

### ğŸ“ æœ¬é¢˜é€šç”¨æ ¸å¿ƒC++å®ç°å‚è€ƒ
**è¯´æ˜**ï¼šç»¼åˆDaiRuiChen007çš„ä»£ç ï¼Œæç‚¼åˆ†æ²»NTTã€å¤šé¡¹å¼æ±‚é€†çš„æ ¸å¿ƒé€»è¾‘ã€‚

```cpp
#include <bits/stdc++.h>
using namespace std;
const int MOD = 998244353, G = 3;
int n, m;
vector<int> p[1 << 19]; // åˆ†æ²»å­˜å‚¨å¤šé¡¹å¼

// å¿«é€Ÿå¹‚
int ksm(int a, int b) {
    int ret = 1;
    for (; b; a = 1LL * a * a % MOD, b >>= 1)
        if (b & 1) ret = 1LL * ret * a % MOD;
    return ret;
}

// NTTå˜æ¢ï¼ˆidft=1æ—¶é€†å˜æ¢ï¼‰
void ntt(vector<int>& a, bool idft) {
    int len = a.size();
    vector<int> rev(len);
    for (int i = 0; i < len; ++i)
        rev[i] = (rev[i >> 1] >> 1) | (i & 1 ? len >> 1 : 0);
    for (int i = 0; i < len; ++i)
        if (rev[i] < i) swap(a[i], a[rev[i]]);
    for (int k = 2; k <= len; k <<= 1) {
        int w = ksm(idft ? ksm(G, MOD-2) : G, (MOD-1)/k);
        for (int i = 0; i < len; i += k) {
            int w0 = 1;
            for (int j = i; j < i + k/2; ++j) {
                int x = a[j], y = 1LL * w0 * a[j + k/2] % MOD;
                a[j] = (x + y) % MOD;
                a[j + k/2] = (x - y + MOD) % MOD;
                w0 = 1LL * w0 * w % MOD;
            }
        }
    }
    if (idft) {
        int inv = ksm(len, MOD-2);
        for (int& x : a) x = 1LL * x * inv % MOD;
    }
}

// åˆ†æ²»NTTè®¡ç®—å¤šé¡¹å¼ä¹˜ç§¯ï¼ˆè®¡ç®—åˆ†æ¯ï¼‰
void cdq(int l, int r) {
    if (l == r) {
        p[l] = {n, MOD - l}; // å¤šé¡¹å¼ï¼šn - l*x
        return;
    }
    int mid = (l + r) >> 1;
    cdq(l, mid), cdq(mid+1, r);
    int len = 1;
    while (len < p[l].size() + p[mid+1].size() - 1) len <<= 1;
    vector<int> a(len, 0), b(len, 0);
    for (int i = 0; i < p[l].size(); ++i) a[i] = p[l][i];
    for (int i = 0; i < p[mid+1].size(); ++i) b[i] = p[mid+1][i];
    ntt(a, 0), ntt(b, 0);
    for (int i = 0; i < len; ++i) a[i] = 1LL * a[i] * b[i] % MOD;
    ntt(a, 1);
    p[l] = a;
}

// å¤šé¡¹å¼æ±‚é€†
vector<int> poly_inv(vector<int> f) {
    int n = f.size();
    if (n == 1) return {ksm(f[0], MOD-2)};
    vector<int> g = poly_inv(vector<int>(f.begin(), f.begin() + (n+1)/2));
    int len = 1;
    while (len < 2 * n) len <<= 1;
    g.resize(len, 0);
    vector<int> a(len, 0);
    for (int i = 0; i < n; ++i) a[i] = f[i];
    ntt(g, 0), ntt(a, 0);
    for (int i = 0; i < len; ++i)
        g[i] = 1LL * g[i] * (2 - 1LL * a[i] * g[i] % MOD + MOD) % MOD;
    ntt(g, 1);
    g.resize(n);
    return g;
}

int main() {
    cin >> n >> m;
    if (n == 1) {
        for (int i = 1; i <= m; ++i) cout << 1 << '\n';
        return 0;
    }
    cdq(1, n-1); // è®¡ç®—åˆ†æ¯å¤šé¡¹å¼G(x) = product_{i=1}^{n-1} (n - i x)
    // åç»­å¤„ç†ç”Ÿæˆå‡½æ•°è½¬æ¢ã€å¤šé¡¹å¼æ±‚é€†...
    return 0;
}
```

**ä»£ç è§£è¯»æ¦‚è¦**ï¼š  
- `ntt`å‡½æ•°å®ç°å¿«é€Ÿå‚…é‡Œå¶å˜æ¢ï¼ˆç”¨äºå¤šé¡¹å¼ä¹˜æ³•ï¼‰ï¼›  
- `cdq`å‡½æ•°ç”¨åˆ†æ²»NTTè®¡ç®—åˆ†æ¯å¤šé¡¹å¼ï¼ˆæ‰€æœ‰(n - i x)çš„ä¹˜ç§¯ï¼‰ï¼›  
- `poly_inv`å‡½æ•°ç”¨ç‰›é¡¿è¿­ä»£æ³•æ±‚å¤šé¡¹å¼çš„é€†ï¼ˆå¤„ç†åˆ†å¼è¿ç®—ï¼‰ã€‚


### ğŸ“Œ é¢˜è§£ä¸€æ ¸å¿ƒç‰‡æ®µï¼ˆOtomachi_Una_ï¼‰
**äº®ç‚¹**ï¼šç›´æ¥æ¨å¯¼F(e^x)çš„è¡¨è¾¾å¼ï¼Œå°†é—®é¢˜ç®€åŒ–ä¸ºå¤šé¡¹å¼é™¤æ³•ã€‚  
**æ ¸å¿ƒä»£ç **ï¼š
```cpp
// æ€»ç”Ÿæˆå‡½æ•°F(e^x) = product_{i=0}^{n-1} [p_i e^x / (1 - (1-p_i)e^x)]
// å…¶ä¸­p_i = (n-i)/n
vector<int> G = cdq(0, n-1); // åˆ†æ¯å¤šé¡¹å¼
vector<int> G_e = transform_to_egf(G); // G(e^x)çš„EGF
vector<int> inv_G_e = poly_inv(G_e); // æ±‚é€†
vector<int> ans = multiply(inv_G_e, E_zn); // E_znæ˜¯e^{zn}çš„å¤šé¡¹å¼
```
**è§£è¯»**ï¼šè¿™æ®µä»£ç çš„å…³é”®æ˜¯`transform_to_egf`â€”â€”å°†G(x)è½¬æ¢ä¸ºG(e^x)çš„EGFå½¢å¼ï¼ˆå³ç³»æ•°é™¤ä»¥i!ï¼‰ï¼Œå†ç”¨å¤šé¡¹å¼æ±‚é€†å¾—åˆ°1/G(e^x)ï¼Œæœ€ç»ˆä¹˜ä»¥e^{zn}çš„å¤šé¡¹å¼å¾—åˆ°ç»“æœã€‚


### ğŸ“Œ é¢˜è§£äºŒæ ¸å¿ƒç‰‡æ®µï¼ˆFido_Puppyï¼‰
**äº®ç‚¹**ï¼šç”¨ä¸‹é™å¹‚é¿å…ç”Ÿæˆå‡½æ•°çš„å¤æ‚ä»£å…¥ã€‚  
**æ ¸å¿ƒä»£ç **ï¼š
```cpp
// è®¡ç®—ä¸‹é™å¹‚æœŸæœ›E(X^Ì²k) = k! * sum_{i=0}^{n-1} c_i * (i/(n-i))^{k-1}
vector<int> c(n), p(n);
for (int i = 0; i < n; ++i) {
    c[i] = C(n, i) * n % MOD * inv[n-i] % MOD;
    if ((n-1-i) % 2) c[i] = (MOD - c[i]) % MOD;
    p[i] = 1LL * i * inv[n-i] % MOD;
}
// åˆ†æ²»NTTè®¡ç®—sum_{i=0}^{n-1} c_i/(1 - p_i x)ï¼Œå¾—åˆ°E(X^Ì²k)
```
**è§£è¯»**ï¼šè¿™æ®µä»£ç é€šè¿‡**ä¸‹é™å¹‚**å°†é—®é¢˜è½¬æ¢ä¸ºâ€œæ±‚å‡ ä½•çº§æ•°çš„å’Œâ€ï¼Œå†ç”¨åˆ†æ²»NTTå¿«é€Ÿè®¡ç®—æ‰€æœ‰kçš„ç»“æœï¼Œæœ€åç”¨æ–¯ç‰¹æ—æ•°è½¬æ¢ä¸ºæ™®é€šå¹‚ã€‚


## 5. ç®—æ³•å¯è§†åŒ–ï¼šåƒç´ é£â€œå¤šé¡¹å¼ç§¯æœ¨â€æ¸¸æˆ

### ğŸ¯ æ ¸å¿ƒæ¼”ç¤ºå†…å®¹
æˆ‘ä»¬è®¾è®¡ä¸€ä¸ª**8ä½åƒç´ é£æ ¼çš„ç½‘é¡µåŠ¨ç”»**ï¼ˆç”¨HTML5 Canvaså®ç°ï¼‰ï¼Œå±•ç¤ºâ€œåˆ†æ²»NTTè®¡ç®—åˆ†æ¯å¤šé¡¹å¼â€çš„è¿‡ç¨‹ï¼š

1. **åˆå§‹åŒ–**ï¼šå±å¹•å·¦ä¾§æ˜¯â€œå¤šé¡¹å¼ä»“åº“â€ï¼ˆå­˜å‚¨æ‰€æœ‰(n - i x)çš„åƒç´ å—ï¼‰ï¼Œå³ä¾§æ˜¯â€œåˆå¹¶åŒºâ€ï¼ˆåˆ†æ²»åˆå¹¶çš„ç»“æœï¼‰ã€‚  
2. **åˆ†æ²»è¿‡ç¨‹**ï¼š  
   - ç‚¹å‡»â€œå¼€å§‹â€ï¼Œå·¦ä¾§çš„åƒç´ å—ä¼šåˆ†æˆå·¦å³ä¸¤å †ï¼ˆé€’å½’å¤„ç†ï¼‰ï¼›  
   - åˆå¹¶æ—¶ï¼Œå·¦å³å­å¤šé¡¹å¼çš„åƒç´ å—ä¼šâ€œç›¸ä¹˜â€ï¼ˆé—ªçƒï¼‰ï¼Œç„¶åâ€œç›¸åŠ â€ï¼ˆç§»åŠ¨åˆ°å¯¹åº”ä½ç½®ï¼‰ï¼›  
   - æ¯å®Œæˆä¸€æ¬¡åˆå¹¶ï¼Œå±å¹•åº•éƒ¨ä¼šæ˜¾ç¤ºâ€œå½“å‰å¤šé¡¹å¼æ¬¡æ•°ï¼šxâ¿â€ã€‚  
3. **äº¤äº’æ§åˆ¶**ï¼š  
   - æœ‰â€œå•æ­¥â€â€œè‡ªåŠ¨æ’­æ”¾â€æŒ‰é’®ï¼ˆè‡ªåŠ¨æ’­æ”¾å¯è°ƒèŠ‚é€Ÿåº¦ï¼‰ï¼›  
   - ç‚¹å‡»â€œé‡ç½®â€ä¼šæ¸…ç©ºå±å¹•ï¼Œé‡æ–°å¼€å§‹åŠ¨ç”»ï¼›  
   - å®Œæˆæ—¶ï¼Œæ’­æ”¾â€œèƒœåˆ©â€éŸ³æ•ˆï¼ˆæ¯”å¦‚åƒç´ ç‰ˆã€Šè¶…çº§é©¬é‡Œå¥¥ã€‹çš„é€šå…³éŸ³ä¹ï¼‰ã€‚


## 6. æ‹“å±•ç»ƒä¹ ä¸ç›¸ä¼¼é—®é¢˜

ä¸ºäº†å·©å›ºæŠ€å·§ï¼Œæ¨èä»¥ä¸‹æ´›è°·é¢˜ç›®ï¼š
1. **P4705 ç©æ¸¸æˆ**ï¼šå¤„ç†â€œä¸¤ä¸ªåºåˆ—çš„å¹‚å’ŒæœŸæœ›â€ï¼Œéœ€è¦ç”¨åˆ°ç”Ÿæˆå‡½æ•°å’Œåˆ†æ²»NTTï¼›  
2. **P5488 å¤šé¡¹å¼ä¹˜æ³•**ï¼šç»ƒä¹ åˆ†æ²»NTTçš„åŸºç¡€å®ç°ï¼›  
3. **P3803 å¤šé¡¹å¼ä¹˜æ³•é€†**ï¼šç†Ÿæ‚‰ç‰›é¡¿è¿­ä»£æ³•æ±‚å¤šé¡¹å¼é€†ã€‚


## 7. å­¦ä¹ å¿ƒå¾—ä¸ç»éªŒåˆ†äº«

- **Otomachi_Una_çš„ç»éªŒ**ï¼šâ€œç”Ÿæˆå‡½æ•°çš„å…³é”®æ˜¯æ‰¾åˆ°â€˜é—®é¢˜çš„æ•°å­¦æ¨¡å‹â€™â€”â€”æŠŠæ¦‚ç‡ã€æœŸæœ›è½¬æ¢æˆå¤šé¡¹å¼çš„è¿ç®—ï¼Œå¾ˆå¤šå¤æ‚é—®é¢˜ä¼šå˜å¾—ç®€å•ã€‚â€  
- **Fido_Puppyçš„ç»éªŒ**ï¼šâ€œä¸‹é™å¹‚æ˜¯å¤„ç†å¹‚å’ŒæœŸæœ›çš„â€˜ç¥å™¨â€™â€”â€”å®ƒèƒ½æŠŠâ€˜iæ¬¡å¹‚â€™çš„æ±‚å’Œè½¬æ¢ä¸ºâ€˜å‡ ä½•çº§æ•°â€™çš„æ±‚å’Œï¼Œé¿å…ç”Ÿæˆå‡½æ•°çš„å¤æ‚ä»£å…¥ã€‚â€  


## ğŸ’ª ç»“è¯­
ARC154Fæ˜¯ä¸€é“â€œæ•°å­¦+ç®—æ³•â€çš„ç»¼åˆé¢˜ï¼Œæ ¸å¿ƒæ˜¯**ç”¨ç”Ÿæˆå‡½æ•°å»ºæ¨¡ï¼Œç”¨åˆ†æ²»NTTå’Œå¤šé¡¹å¼æ±‚é€†é«˜æ•ˆè®¡ç®—**ã€‚é€šè¿‡è¿™é“é¢˜ï¼Œå¤§å®¶ä¸ä»…èƒ½å­¦ä¼šç”Ÿæˆå‡½æ•°çš„åº”ç”¨ï¼Œè¿˜èƒ½æŒæ¡åˆ†æ²»NTTã€å¤šé¡¹å¼æ±‚é€†ç­‰é«˜çº§ç®—æ³•ã€‚  

è®°ä½ï¼šç¼–ç¨‹çš„ä¹è¶£åœ¨äºâ€œæŠŠå¤æ‚é—®é¢˜æ‹†æˆç®€å•æ­¥éª¤â€â€”â€”å…ˆå»ºæ¨¡ï¼Œå†æ‰¾ç®—æ³•ï¼Œæœ€åå®ç°ã€‚ä¸‹æ¬¡æˆ‘ä»¬å†ä¸€èµ·æŒ‘æˆ˜æ›´éš¾çš„é¢˜ç›®ï¼ğŸš€

---
å¤„ç†ç”¨æ—¶ï¼š104.87ç§’
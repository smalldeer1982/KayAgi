# é¢˜ç›®ä¿¡æ¯

# [ABC399F] Range Power Sum

## é¢˜ç›®æè¿°

[problemUrl]: https://atcoder.jp/contests/abc399/tasks/abc399_f

ç»™å®šæ­£æ•´æ•° $N, K$ ä»¥åŠé•¿åº¦ä¸º $N$ çš„æ•´æ•°åºåˆ— $A = (A_1, A_2, \dots, A_N)$ã€‚  
è¯·è®¡ç®—ä»¥ä¸‹è¡¨è¾¾å¼çš„å€¼å¯¹ $998244353$ å–æ¨¡åçš„ä½™æ•°ï¼š

$$
\displaystyle \sum_{1 \leq l \leq r \leq N} \left( \sum_{l \leq i \leq r} A_i \right)^K
$$

## è¯´æ˜/æç¤º

### çº¦æŸæ¡ä»¶

- $1 \leq N \leq 2 \times 10^5$
- $1 \leq K \leq 10$
- $0 \leq A_i < 998244353$
- è¾“å…¥å‡ä¸ºæ•´æ•°

### æ ·ä¾‹è§£é‡Š 1

æ‰€æ±‚çš„å€¼ä¸º $A_1^2 + A_2^2 + A_3^2 + (A_1 + A_2)^2 + (A_2 + A_3)^2 + (A_1 + A_2 + A_3)^2 = 3^2 + 1^2 + 2^2 + 4^2 + 3^2 + 6^2 = 75$ã€‚

### æ ·ä¾‹è§£é‡Š 3

æ³¨æ„éœ€è¦å¯¹ç»“æœå– $998244353$ çš„æ¨¡ã€‚

ç¿»è¯‘ç”± DeepSeek R1 å®Œæˆ

## æ ·ä¾‹ #1

### è¾“å…¥

```
3 2

3 1 2```

### è¾“å‡º

```
75```

## æ ·ä¾‹ #2

### è¾“å…¥

```
1 10

0```

### è¾“å‡º

```
0```

## æ ·ä¾‹ #3

### è¾“å…¥

```
10 5

91 59 85 60 57 72 12 3 27 16```

### è¾“å‡º

```
428633385```

# AIåˆ†æç»“æœ

# ğŸ’¡ Kayçš„C++ç®—æ³•è§£æï¼š[ABC399F] Range Power Sum æ·±å…¥å­¦ä¹ æŒ‡å— ğŸ’¡


## 1. é¢˜ç›®è§£è¯»ä¸æ ¸å¿ƒç®—æ³•è¯†åˆ«

âœ¨ **æœ¬é¢˜ä¸»è¦è€ƒå¯Ÿ**ï¼šæ•°å­¦ï¼ˆäºŒé¡¹å¼å®šç†ï¼‰+ å‰ç¼€å’Œä¼˜åŒ–  

ğŸ—£ï¸ **åˆæ­¥åˆ†æ**ï¼š  
é¢˜ç›®è¦æ±‚è®¡ç®—**æ‰€æœ‰è¿ç»­å­æ®µå’Œçš„Kæ¬¡æ–¹ä¹‹å’Œ**ï¼ˆæ¯”å¦‚æ ·ä¾‹1ä¸­ï¼Œ3ä¸ªå…ƒç´ çš„æ‰€æœ‰6ä¸ªå­æ®µå’Œçš„å¹³æ–¹å’Œä¸º75ï¼‰ã€‚ç›´æ¥æšä¸¾æ‰€æœ‰å­æ®µï¼ˆO(NÂ²)ï¼‰å¹¶è®¡ç®—æ¯ä¸ªå­æ®µå’Œçš„Kæ¬¡æ–¹ï¼ˆO(K)ï¼‰ï¼Œå¯¹äºN=2e5æ¥è¯´å®Œå…¨ä¸å¯è¡Œâ€”â€”è¿™æ—¶å€™éœ€è¦**æ•°å­¦æŠ€å·§**æ¥ç®€åŒ–è®¡ç®—ï¼  

æ ¸å¿ƒæ€è·¯æ˜¯ï¼š**ç”¨å‰ç¼€å’Œå°†å­æ®µå’Œè½¬åŒ–ä¸ºå·®ï¼Œå†ç”¨äºŒé¡¹å¼å®šç†å±•å¼€é«˜æ¬¡å¹‚**ã€‚  
- è®¾å‰ç¼€å’Œæ•°ç»„`sum[r] = Aâ‚+Aâ‚‚+â€¦+Aáµ£`ï¼Œåˆ™å­æ®µå’Œ`Aâ‚—+â€¦+Aáµ£ = sum[r] - sum[l-1]`ã€‚  
- é¢˜ç›®è¦æ±‚çš„æ€»å’Œå¯è½¬åŒ–ä¸ºï¼š`âˆ‘â‚â‰¤â‚—â‰¤áµ£â‰¤â‚™ (sum[r] - sum[l-1])áµ`ã€‚  
- åˆ©ç”¨äºŒé¡¹å¼å®šç†å±•å¼€`(a - b)áµ = âˆ‘áµ¢=â‚€áµ C(k,i) aâ± (-b)áµâ»â±`ï¼Œå°†é«˜æ¬¡å¹‚æ‹†æˆä½æ¬¡å¹‚çš„ç»„åˆï¼Œå†**äº¤æ¢æ±‚å’Œé¡ºåº**ï¼ˆæŠŠ`âˆ‘â‚—â‰¤áµ£`æ‹†æˆ`âˆ‘áµ£ âˆ‘â‚—â‰¤áµ£`ï¼‰ï¼Œæœ€åç”¨**å‰ç¼€å’Œç»´æŠ¤ä¸­é—´ç»“æœ**ï¼ˆæ¯”å¦‚`âˆ‘â‚—â‰¤áµ£ (-sum[l-1])áµâ»â±`ï¼‰ï¼Œå°†æ—¶é—´å¤æ‚åº¦ä»O(NÂ²K)é™åˆ°O(NK)ã€‚  

**å¯è§†åŒ–è®¾è®¡æ€è·¯**ï¼š  
ç”¨8ä½åƒç´ é£æ ¼å±•ç¤ºâ€œå‰ç¼€å’Œç§¯æœ¨â€ä¸â€œäºŒé¡¹å¼æ‹†å—â€è¿‡ç¨‹ï¼š  
- æ•°ç»„å…ƒç´ ç”¨ä¸åŒé¢œè‰²çš„åƒç´ å—è¡¨ç¤ºï¼ˆæ¯”å¦‚Aâ‚=3æ˜¯çº¢è‰²ï¼ŒAâ‚‚=1æ˜¯è“è‰²ï¼‰ï¼›  
- å‰ç¼€å’Œ`sum[r]`ç”¨â€œç´¯åŠ ç§¯æœ¨å¡”â€è¡¨ç¤ºï¼ˆæ¯åŠ ä¸€ä¸ªå…ƒç´ ï¼Œç§¯æœ¨å¡”å¢é«˜ï¼‰ï¼›  
- äºŒé¡¹å¼å±•å¼€çš„æ¯ä¸€é¡¹ç”¨â€œå½©è‰²ç¢ç‰‡â€è¡¨ç¤ºï¼ˆæ¯”å¦‚C(k,i)æ˜¯é»„è‰²ï¼Œsum[r]â±æ˜¯è“è‰²ï¼Œ(-sum[l-1])áµâ»â±æ˜¯çº¢è‰²ï¼‰ï¼Œç¢ç‰‡ç»„åˆæˆæœ€ç»ˆè´¡çŒ®ï¼ˆç»¿è‰²ï¼‰ï¼›  
- å‰ç¼€å’Œç»´æŠ¤ç”¨â€œåŠ¨æ€è¿›åº¦æ¡â€è¡¨ç¤ºï¼ˆæ¯å¤„ç†ä¸€ä¸ªrï¼Œè¿›åº¦æ¡æ›´æ–°`âˆ‘â‚—â‰¤áµ£ (-sum[l-1])áµâ»â±`çš„å€¼ï¼‰ã€‚  


## 2. ç²¾é€‰ä¼˜è´¨é¢˜è§£å‚è€ƒ

### é¢˜è§£ä¸€ï¼šï¼ˆæ¥æºï¼šyuhong056ï¼Œèµï¼š6ï¼‰  
* **ç‚¹è¯„**ï¼š  
  è¿™é“é¢˜çš„â€œæ ‡å‡†ç­”æ¡ˆâ€çº§è§£æ³•ï¼ä½œè€…ä»**å‰ç¼€å’Œè½¬åŒ–**â†’**äºŒé¡¹å¼å±•å¼€**â†’**äº¤æ¢æ±‚å’Œé¡ºåº**â†’**å‰ç¼€å’Œä¼˜åŒ–**ï¼Œæ¯ä¸€æ­¥æ¨å¯¼éƒ½æ¸…æ™°æ˜“æ‡‚ï¼ˆæ¯”å¦‚æŠŠ`âˆ‘â‚—â‰¤áµ£`æ‹†æˆ`âˆ‘áµ£ âˆ‘â‚—â‰¤áµ£`ï¼Œé¿å…äº†åŒé‡å¾ªç¯ï¼‰ã€‚ä»£ç å®ç°ç®€æ´ï¼ˆO(NK)æ—¶é—´ï¼‰ï¼Œé¢„å¤„ç†äº†å‰ç¼€å’Œçš„å¹‚æ¬¡å’Œç»„åˆæ•°ï¼Œæ ¸å¿ƒé€»è¾‘æ˜¯**éå†æ¯ä¸ªrï¼Œç»´æŠ¤å‰ç¼€å’Œçš„ç´¯åŠ å’Œï¼Œå¿«é€Ÿè®¡ç®—è´¡çŒ®**ã€‚äº®ç‚¹æ˜¯**å°†é«˜æ¬¡å¹‚é—®é¢˜è½¬åŒ–ä¸ºä½æ¬¡å¹‚çš„ç»„åˆ**ï¼Œå®Œç¾åˆ©ç”¨äº†Kå°ï¼ˆâ‰¤10ï¼‰çš„ç‰¹ç‚¹ã€‚  

### é¢˜è§£äºŒï¼šï¼ˆæ¥æºï¼šgavinliu266ï¼Œèµï¼š4ï¼‰  
* **ç‚¹è¯„**ï¼š  
  ç”¨**åŠ¨æ€è§„åˆ’ï¼ˆDPï¼‰**æ€è·¯è§£å†³é—®é¢˜ï¼Œå®šä¹‰`dp[x][y]`ä¸ºå‰xä¸ªå…ƒç´ ä¸­ï¼Œä»¥xç»“å°¾çš„æ‰€æœ‰å­æ®µå’Œçš„yæ¬¡æ–¹ä¹‹å’Œã€‚è½¬ç§»æ–¹ç¨‹é€šè¿‡äºŒé¡¹å¼å®šç†æ¨å¯¼ï¼ˆ`dp[x][y] = Aâ‚“Ê¸ + âˆ‘â±¼=â‚€Ê¸ C(y,j) Aâ‚“Ê¸â»Ê² dp[x-1][j]`ï¼‰ï¼Œæ€è·¯æ–°é¢–ã€‚ä»£ç ä¸­ç”¨æ»šåŠ¨æ•°ç»„ä¼˜åŒ–äº†ç©ºé—´ï¼ˆO(K)ç©ºé—´ï¼‰ï¼Œé€‚åˆç†è§£â€œå­æ®µæ‰©å±•â€çš„è¿‡ç¨‹â€”â€”æ¯åŠ å…¥ä¸€ä¸ªæ–°å…ƒç´ ï¼Œæ‰€æœ‰ä»¥å®ƒç»“å°¾çš„å­æ®µéƒ½æ˜¯ä¹‹å‰çš„å­æ®µåŠ ä¸Šæ–°å…ƒç´ ï¼Œå› æ­¤å¯ä»¥ç”¨ä¹‹å‰çš„ç»“æœå¿«é€Ÿè®¡ç®—ã€‚  

### é¢˜è§£ä¸‰ï¼šï¼ˆæ¥æºï¼šDrAlfredï¼Œèµï¼š1ï¼‰  
* **ç‚¹è¯„**ï¼š  
  ç”¨**æ‰«æçº¿**æ€è·¯ç®€åŒ–äº†ä»£ç ï¼Œæ ¸å¿ƒé€»è¾‘ä¸é¢˜è§£ä¸€ä¸€è‡´ï¼Œä½†ä»£ç æ›´ç®€æ´ï¼ˆæ¯”å¦‚ç”¨`sum`æ•°ç»„ç»´æŠ¤å‰ç¼€å’Œçš„å¹‚æ¬¡ç´¯åŠ å’Œï¼‰ã€‚äº®ç‚¹æ˜¯**æ¨¡è¿ç®—å¤„ç†**ï¼ˆç”¨`m998`ç±»å°è£…æ¨¡è¿ç®—ï¼Œé¿å…äº†æ‰‹åŠ¨å–æ¨¡çš„éº»çƒ¦ï¼‰ï¼Œé€‚åˆå­¦ä¹ â€œä»£ç å°è£…â€æŠ€å·§ã€‚  


## 3. æ ¸å¿ƒéš¾ç‚¹è¾¨æä¸è§£é¢˜ç­–ç•¥

### 1. éš¾ç‚¹1ï¼šå¦‚ä½•å°†é«˜æ¬¡å¹‚è½¬åŒ–ä¸ºå¯è®¡ç®—çš„å½¢å¼ï¼Ÿ  
* **åˆ†æ**ï¼š  
  ç›´æ¥è®¡ç®—`(sum[r] - sum[l-1])áµ`éœ€è¦O(K)æ—¶é—´ï¼Œè€Œæšä¸¾æ‰€æœ‰å­æ®µéœ€è¦O(NÂ²)æ—¶é—´ï¼Œæ— æ³•é€šè¿‡ã€‚è§£å†³æ–¹æ³•æ˜¯**ç”¨äºŒé¡¹å¼å®šç†å±•å¼€**ï¼Œå°†é«˜æ¬¡å¹‚æ‹†æˆ`âˆ‘áµ¢=â‚€áµ C(k,i) sum[r]â± (-sum[l-1])áµâ»â±`ï¼Œè¿™æ ·å¯ä»¥å°†â€œå­æ®µå’Œçš„Kæ¬¡æ–¹â€è½¬åŒ–ä¸ºâ€œå‰ç¼€å’Œçš„ä½æ¬¡å¹‚çš„ç»„åˆâ€ã€‚  
* ğŸ’¡ **å­¦ä¹ ç¬”è®°**ï¼šäºŒé¡¹å¼å®šç†æ˜¯å¤„ç†é«˜æ¬¡å¹‚é—®é¢˜çš„â€œç¥å™¨â€ï¼Œå°¤å…¶é€‚åˆKå°çš„æƒ…å†µã€‚  

### 2. éš¾ç‚¹2ï¼šå¦‚ä½•ä¼˜åŒ–åŒé‡å¾ªç¯ï¼Ÿ  
* **åˆ†æ**ï¼š  
  å±•å¼€åçš„å¼å­æ˜¯`âˆ‘â‚—â‰¤áµ£ âˆ‘áµ¢=â‚€áµ C(k,i) sum[r]â± (-sum[l-1])áµâ»â±`ï¼Œç›´æ¥è®¡ç®—éœ€è¦O(NÂ²K)æ—¶é—´ã€‚è§£å†³æ–¹æ³•æ˜¯**äº¤æ¢æ±‚å’Œé¡ºåº**ï¼Œå°†`âˆ‘â‚—â‰¤áµ£`æ‹†æˆ`âˆ‘áµ£ âˆ‘â‚—â‰¤áµ£`ï¼Œç„¶å**ç”¨å‰ç¼€å’Œç»´æŠ¤`âˆ‘â‚—â‰¤áµ£ (-sum[l-1])áµâ»â±`**ï¼ˆæ¯”å¦‚`sum_l = sum_l + (-sum[r-1])áµâ»â±`ï¼‰ï¼Œè¿™æ ·æ¯ä¸ªrçš„è´¡çŒ®å¯ä»¥åœ¨O(K)æ—¶é—´å†…è®¡ç®—ã€‚  
* ğŸ’¡ **å­¦ä¹ ç¬”è®°**ï¼šäº¤æ¢æ±‚å’Œé¡ºåºæ˜¯ä¼˜åŒ–åŒé‡å¾ªç¯çš„å¸¸ç”¨æŠ€å·§ï¼Œå…³é”®æ˜¯æ‰¾åˆ°â€œå¯ä»¥æå‰è®¡ç®—çš„ç´¯åŠ é¡¹â€ã€‚  

### 3. éš¾ç‚¹3ï¼šæ¨¡è¿ç®—çš„å¤„ç†ï¼Ÿ  
* **åˆ†æ**ï¼š  
  é¢˜ç›®è¦æ±‚ç»“æœå¯¹998244353å–æ¨¡ï¼Œè€Œ`(-sum[l-1])áµâ»â±`å¯èƒ½ä¸ºè´Ÿæ•°ï¼Œéœ€è¦**åŠ æ¨¡å†å–æ¨¡**ï¼ˆæ¯”å¦‚`(-x) % mod = (mod - x%mod) % mod`ï¼‰ã€‚å¦å¤–ï¼Œç»„åˆæ•°çš„é¢„å¤„ç†éœ€è¦ç”¨æ¨¡è¿ç®—ï¼ˆæ¯”å¦‚ç”¨é˜¶ä¹˜å’Œé€†å…ƒè®¡ç®—ç»„åˆæ•°ï¼‰ã€‚  
* ğŸ’¡ **å­¦ä¹ ç¬”è®°**ï¼šæ¨¡è¿ç®—ä¸­å¤„ç†è´Ÿæ•°çš„æ ‡å‡†åšæ³•æ˜¯â€œåŠ æ¨¡å†å–æ¨¡â€ï¼Œé¿å…ç»“æœä¸ºè´Ÿã€‚  


## 4. C++æ ¸å¿ƒä»£ç å®ç°èµæ

### æœ¬é¢˜é€šç”¨æ ¸å¿ƒC++å®ç°å‚è€ƒï¼ˆåŸºäºyuhong056é¢˜è§£ï¼‰  
* **è¯´æ˜**ï¼š  
  æ­¤ä»£ç ç»¼åˆäº†â€œå‰ç¼€å’Œè½¬åŒ–â€â€œäºŒé¡¹å¼å±•å¼€â€â€œå‰ç¼€å’Œä¼˜åŒ–â€çš„æ ¸å¿ƒé€»è¾‘ï¼Œæ—¶é—´å¤æ‚åº¦O(NK)ï¼Œæ˜¯æœ¬é¢˜çš„æ ‡å‡†è§£æ³•ã€‚  
* **å®Œæ•´æ ¸å¿ƒä»£ç **ï¼š  
  ```cpp
  #include <iostream>
  #include <vector>
  using namespace std;
  typedef long long ll;
  const int MOD = 998244353;
  const int MAXN = 2e5 + 5;
  const int MAXK = 12;

  ll C[MAXK][MAXK]; // ç»„åˆæ•°C(k,i)
  ll sum_pow[MAXN][MAXK]; // sum_pow[r][i] = sum[r]^i mod MOD
  ll pre_sum[MAXK]; // pre_sum[i] = sum_{l=1}^r (-sum[l-1])^i mod MOD

  void init_comb(int k) {
      for (int i = 0; i <= k; i++) {
          C[i][0] = 1;
          for (int j = 1; j <= i; j++) {
              C[i][j] = (C[i-1][j-1] + C[i-1][j]) % MOD;
          }
      }
  }

  int main() {
      int n, k;
      cin >> n >> k;
      vector<ll> a(n+1), sum(n+1);
      for (int i = 1; i <= n; i++) {
          cin >> a[i];
          sum[i] = (sum[i-1] + a[i]) % MOD;
      }
      // é¢„å¤„ç†sum[r]^i
      for (int r = 0; r <= n; r++) {
          sum_pow[r][0] = 1;
          for (int i = 1; i <= k; i++) {
              sum_pow[r][i] = sum_pow[r][i-1] * sum[r] % MOD;
          }
      }
      // é¢„å¤„ç†ç»„åˆæ•°
      init_comb(k);
      // è®¡ç®—ç­”æ¡ˆ
      ll ans = 0;
      fill(pre_sum, pre_sum + MAXK, 0);
      pre_sum[0] = 1; // sum_{l=1}^1 (-sum[0])^0 = 1ï¼ˆsum[0]=0ï¼‰
      for (int r = 1; r <= n; r++) {
          for (int i = 0; i <= k; i++) {
              int j = k - i;
              ll sign = (j % 2 == 0) ? 1 : MOD - 1; // (-1)^j
              ll term = C[k][i] * sum_pow[r][i] % MOD;
              term = term * sign % MOD;
              term = term * pre_sum[j] % MOD;
              ans = (ans + term) % MOD;
          }
          // æ›´æ–°pre_sumï¼špre_sum[j] += (-sum[r])^j
          for (int j = 0; j <= k; j++) {
              ll val = sum_pow[r][j];
              if (j % 2 == 1) val = (MOD - val) % MOD;
              pre_sum[j] = (pre_sum[j] + val) % MOD;
          }
      }
      cout << ans << endl;
      return 0;
  }
  ```
* **ä»£ç è§£è¯»æ¦‚è¦**ï¼š  
  1. **å‰ç¼€å’Œè®¡ç®—**ï¼šè®¡ç®—`sum[r]`ï¼ˆå‰rä¸ªå…ƒç´ çš„å’Œï¼‰ã€‚  
  2. **é¢„å¤„ç†å¹‚æ¬¡**ï¼šè®¡ç®—`sum_pow[r][i]`ï¼ˆ`sum[r]`çš„iæ¬¡æ–¹ï¼‰ï¼Œé¿å…é‡å¤è®¡ç®—ã€‚  
  3. **ç»„åˆæ•°é¢„å¤„ç†**ï¼šç”¨åŠ¨æ€è§„åˆ’è®¡ç®—`C(k,i)`ï¼ˆç»„åˆæ•°ï¼‰ã€‚  
  4. **æ‰«æçº¿è®¡ç®—ç­”æ¡ˆ**ï¼šéå†æ¯ä¸ªrï¼Œç»´æŠ¤`pre_sum[j]`ï¼ˆ`âˆ‘â‚—â‰¤áµ£ (-sum[l-1])^j`ï¼‰ï¼Œè®¡ç®—æ¯ä¸ªrå¯¹ç­”æ¡ˆçš„è´¡çŒ®ï¼ˆ`âˆ‘áµ¢=â‚€áµ C(k,i) sum[r]^i (-sum[l-1])^j`ï¼‰ã€‚  


### é’ˆå¯¹å„ä¼˜è´¨é¢˜è§£çš„ç‰‡æ®µèµæ

#### é¢˜è§£ä¸€ï¼ˆyuhong056ï¼‰ï¼šæ ¸å¿ƒä»£ç ç‰‡æ®µï¼ˆç»„åˆæ•°é¢„å¤„ç†ï¼‰  
```cpp
void init_comb(int k) {
    for (int i = 0; i <= k; i++) {
        C[i][0] = 1;
        for (int j = 1; j <= i; j++) {
            C[i][j] = (C[i-1][j-1] + C[i-1][j]) % MOD;
        }
    }
}
```
* **äº®ç‚¹**ï¼šç”¨åŠ¨æ€è§„åˆ’é¢„å¤„ç†ç»„åˆæ•°ï¼Œæ—¶é—´å¤æ‚åº¦O(KÂ²)ï¼Œé€‚åˆKå°çš„æƒ…å†µã€‚  
* **ä»£ç è§£è¯»**ï¼š  
  - `C[i][j]`è¡¨ç¤ºä»iä¸ªå…ƒç´ ä¸­é€‰jä¸ªçš„ç»„åˆæ•°ã€‚  
  - çŠ¶æ€è½¬ç§»æ–¹ç¨‹ï¼š`C[i][j] = C[i-1][j-1] + C[i-1][j]`ï¼ˆé€‰ç¬¬iä¸ªå…ƒç´ æˆ–ä¸é€‰ï¼‰ã€‚  
* ğŸ’¡ **å­¦ä¹ ç¬”è®°**ï¼šç»„åˆæ•°é¢„å¤„ç†æ˜¯è§£å†³ç»„åˆæ•°å­¦é—®é¢˜çš„åŸºç¡€ï¼ŒåŠ¨æ€è§„åˆ’æ˜¯æœ€å¸¸ç”¨çš„æ–¹æ³•ã€‚  

#### é¢˜è§£äºŒï¼ˆgavinliu266ï¼‰ï¼šæ ¸å¿ƒä»£ç ç‰‡æ®µï¼ˆDPè½¬ç§»ï¼‰  
```cpp
for (int i = 1; i <= n; i++) {
    for (int j = 0; j <= k; j++) {
        dp[i&1][j] = pow(a[i], j); // å•ç‹¬é€‰a[i]çš„è´¡çŒ®
        for (int l = 0; l <= j; l++) {
            ll det = C[j][l] * dp[(i&1)^1][l] % MOD * pow(a[i], j-l) % MOD;
            dp[i&1][j] = (dp[i&1][j] + det) % MOD;
        }
    }
    ans = (ans + dp[i&1][k]) % MOD;
}
```
* **äº®ç‚¹**ï¼šç”¨æ»šåŠ¨æ•°ç»„ä¼˜åŒ–DPç©ºé—´ï¼ˆO(K)ç©ºé—´ï¼‰ï¼Œé¿å…äº†O(NK)çš„ç©ºé—´æ¶ˆè€—ã€‚  
* **ä»£ç è§£è¯»**ï¼š  
  - `dp[i&1][j]`è¡¨ç¤ºå‰iä¸ªå…ƒç´ ä¸­ï¼Œä»¥iç»“å°¾çš„æ‰€æœ‰å­æ®µå’Œçš„jæ¬¡æ–¹ä¹‹å’Œã€‚  
  - è½¬ç§»æ–¹ç¨‹ï¼š`dp[i][j] = a[i]^j + âˆ‘â‚—=â‚€Ê² C(j,l) a[i]Ê²â»Ë¡ dp[i-1][l]`ï¼ˆå•ç‹¬é€‰a[i]ï¼Œæˆ–ä¸ä¹‹å‰çš„å­æ®µåˆå¹¶ï¼‰ã€‚  
* ğŸ’¡ **å­¦ä¹ ç¬”è®°**ï¼šæ»šåŠ¨æ•°ç»„æ˜¯ä¼˜åŒ–DPç©ºé—´çš„å¸¸ç”¨æŠ€å·§ï¼Œå°¤å…¶é€‚åˆâ€œå½“å‰çŠ¶æ€åªä¾èµ–å‰ä¸€ä¸ªçŠ¶æ€â€çš„æƒ…å†µã€‚  


## 5. ç®—æ³•å¯è§†åŒ–ï¼šåƒç´ åŠ¨ç”»æ¼”ç¤ºï¼ˆæ ¸å¿ƒéƒ¨åˆ†ï¼‰

### åŠ¨ç”»æ¼”ç¤ºä¸»é¢˜ï¼šã€Šå‰ç¼€å’Œç§¯æœ¨å¤§å†’é™©ã€‹ï¼ˆ8ä½åƒç´ é£æ ¼ï¼‰  
**è®¾è®¡æ€è·¯**ï¼šç”¨â€œç§¯æœ¨â€è¡¨ç¤ºæ•°ç»„å…ƒç´ ï¼Œâ€œç§¯æœ¨å¡”â€è¡¨ç¤ºå‰ç¼€å’Œï¼Œâ€œå½©è‰²ç¢ç‰‡â€è¡¨ç¤ºäºŒé¡¹å¼å±•å¼€çš„é¡¹ï¼Œé€šè¿‡â€œæ”¶é›†ç¢ç‰‡â€å’Œâ€œæ­å»ºç§¯æœ¨å¡”â€çš„è¿‡ç¨‹ï¼Œç›´è§‚å±•ç¤ºç®—æ³•é€»è¾‘ã€‚  

### åŠ¨ç”»å¸§æ­¥éª¤ä¸äº¤äº’å…³é”®ç‚¹ï¼š  
1. **åˆå§‹åŒ–åœºæ™¯**ï¼š  
   - å±å¹•å·¦ä¾§æ˜¾ç¤ºæ•°ç»„å…ƒç´ ï¼ˆçº¢è‰²ç§¯æœ¨ï¼šAâ‚=3ï¼Œè“è‰²ç§¯æœ¨ï¼šAâ‚‚=1ï¼Œç»¿è‰²ç§¯æœ¨ï¼šAâ‚ƒ=2ï¼‰ï¼›  
   - å±å¹•å³ä¾§æ˜¾ç¤ºâ€œå‰ç¼€å’Œç§¯æœ¨å¡”â€ï¼ˆåˆå§‹ä¸º0ï¼‰å’Œâ€œè´¡çŒ®è¿›åº¦æ¡â€ï¼ˆåˆå§‹ä¸º0ï¼‰ï¼›  
   - åº•éƒ¨æœ‰â€œå•æ­¥æ‰§è¡Œâ€â€œè‡ªåŠ¨æ’­æ”¾â€â€œé‡ç½®â€æŒ‰é’®ï¼Œä»¥åŠé€Ÿåº¦æ»‘å—ã€‚  

2. **å‰ç¼€å’Œè®¡ç®—**ï¼š  
   - ç‚¹å‡»â€œå•æ­¥æ‰§è¡Œâ€ï¼Œç¬¬ä¸€ä¸ªçº¢è‰²ç§¯æœ¨ï¼ˆAâ‚=3ï¼‰è¢«åŠ å…¥â€œç§¯æœ¨å¡”â€ï¼Œç§¯æœ¨å¡”é«˜åº¦å˜ä¸º3ï¼ˆæ˜¾ç¤º`sum[1]=3`ï¼‰ï¼›  
   - åŒæ—¶ï¼Œè®¡ç®—`sum_pow[1][i]`ï¼ˆ3çš„iæ¬¡æ–¹ï¼Œi=0åˆ°2ï¼‰ï¼Œç”¨â€œæ•°å­—æ ‡ç­¾â€æ˜¾ç¤ºåœ¨ç§¯æœ¨å¡”æ—è¾¹ã€‚  

3. **äºŒé¡¹å¼å±•å¼€ä¸è´¡çŒ®è®¡ç®—**ï¼š  
   - å¤„ç†r=1æ—¶ï¼Œè®¡ç®—`âˆ‘áµ¢=0Â² C(2,i) sum[1]^i (-sum[0])Â²â»â±`ï¼ˆsum[0]=0ï¼‰ï¼›  
   - ç”¨â€œå½©è‰²ç¢ç‰‡â€è¡¨ç¤ºæ¯ä¸€é¡¹ï¼šC(2,0)=1ï¼ˆé»„è‰²ï¼‰ï¼Œsum[1]^0=1ï¼ˆè“è‰²ï¼‰ï¼Œ(-sum[0])Â²=0ï¼ˆçº¢è‰²ï¼‰ï¼Œç»„åˆæˆè´¡çŒ®0ï¼ˆç»¿è‰²ï¼‰ï¼›  
   - è´¡çŒ®è¿›åº¦æ¡ä¸å˜ï¼ˆæ­¤æ—¶ans=0ï¼‰ã€‚  

4. **æ›´æ–°å‰ç¼€å’Œç»´æŠ¤**ï¼š  
   - è®¡ç®—`(-sum[1])^j`ï¼ˆj=0åˆ°2ï¼‰ï¼Œç”¨â€œç°è‰²ç¢ç‰‡â€è¡¨ç¤ºï¼ŒåŠ å…¥â€œå‰ç¼€å’Œæ”¶é›†ç®±â€ï¼ˆpre_sum[j]æ›´æ–°ï¼‰ã€‚  

5. **å¤„ç†r=2**ï¼š  
   - åŠ å…¥è“è‰²ç§¯æœ¨ï¼ˆAâ‚‚=1ï¼‰ï¼Œç§¯æœ¨å¡”é«˜åº¦å˜ä¸º4ï¼ˆsum[2]=4ï¼‰ï¼›  
   - è®¡ç®—`âˆ‘áµ¢=0Â² C(2,i) sum[2]^i (-sum[0])Â²â»â± + C(2,i) sum[2]^i (-sum[1])Â²â»â±`ï¼›  
   - ç”¨â€œå½©è‰²ç¢ç‰‡â€ç»„åˆæˆè´¡çŒ®ï¼š3Â²ï¼ˆçº¢è‰²ï¼‰+1Â²ï¼ˆè“è‰²ï¼‰+4Â²ï¼ˆç»¿è‰²ï¼‰=9+1+16=26ï¼ˆans=26ï¼‰ï¼›  
   - è´¡çŒ®è¿›åº¦æ¡å¢åŠ åˆ°26ã€‚  

6. **æ¸¸æˆåŒ–å…ƒç´ **ï¼š  
   - æ¯å¤„ç†ä¸€ä¸ªrï¼Œæ’­æ”¾â€œå®â€çš„éŸ³æ•ˆï¼›  
   - å½“anså¢åŠ æ—¶ï¼Œæ’­æ”¾â€œå‡çº§â€éŸ³æ•ˆï¼›  
   - å®Œæˆæ‰€æœ‰rçš„å¤„ç†åï¼Œæ’­æ”¾â€œèƒœåˆ©â€éŸ³æ•ˆï¼Œæ˜¾ç¤ºâ€œæ€»è´¡çŒ®ï¼š75â€ï¼ˆæ ·ä¾‹1çš„ç­”æ¡ˆï¼‰ã€‚  


## 6. æ‹“å±•ç»ƒä¹ ä¸ç›¸ä¼¼é—®é¢˜æ€è€ƒ

### é€šç”¨æ€è·¯/æŠ€å·§è¿ç§»  
æœ¬é¢˜çš„æ ¸å¿ƒæŠ€å·§ï¼ˆäºŒé¡¹å¼å®šç†+å‰ç¼€å’Œä¼˜åŒ–ï¼‰å¯ç”¨äºè§£å†³**å¤§é‡å­æ®µç»Ÿè®¡é—®é¢˜**ï¼Œæ¯”å¦‚ï¼š  
- ç»Ÿè®¡æ‰€æœ‰å­æ®µå’Œçš„å¹³æ–¹å’Œï¼ˆK=2ï¼‰ï¼›  
- ç»Ÿè®¡æ‰€æœ‰å­æ®µå’Œçš„ç«‹æ–¹å’Œï¼ˆK=3ï¼‰ï¼›  
- ç»Ÿè®¡æ‰€æœ‰å­æ®µå’Œçš„å¥‡å¶æ€§ï¼ˆK=1ï¼Œè½¬åŒ–ä¸ºå‰ç¼€å’Œçš„å·®çš„å¥‡å¶æ€§ï¼‰ã€‚  

### ç»ƒä¹ æ¨èï¼ˆæ´›è°·ï¼‰  
1. **æ´›è°· P1880** - ã€ŠçŸ³å­åˆå¹¶ã€‹  
   ğŸ—£ï¸ **æ¨èç†ç”±**ï¼šéœ€è¦è®¡ç®—åŒºé—´å’Œçš„æœ€å°å€¼ï¼Œç”¨åˆ°äº†å‰ç¼€å’Œå’ŒåŒºé—´DPï¼Œé€‚åˆå·©å›ºâ€œå‰ç¼€å’Œè½¬åŒ–â€æŠ€å·§ã€‚  
2. **æ´›è°· P2252** - ã€Šå–çŸ³å­æ¸¸æˆã€‹  
   ğŸ—£ï¸ **æ¨èç†ç”±**ï¼šç”¨åˆ°äº†ç»„åˆæ•°å­¦å’Œåšå¼ˆè®ºï¼Œé€‚åˆå·©å›ºâ€œç»„åˆæ•°é¢„å¤„ç†â€æŠ€å·§ã€‚  
3. **æ´›è°· P3146** - ã€Šæ’åˆ—è®¡æ•°ã€‹  
   ğŸ—£ï¸ **æ¨èç†ç”±**ï¼šéœ€è¦è®¡ç®—é˜¶ä¹˜å’Œé€†å…ƒï¼Œé€‚åˆå·©å›ºâ€œæ¨¡è¿ç®—å¤„ç†â€æŠ€å·§ã€‚  


## 7. å­¦ä¹ å¿ƒå¾—ä¸ç»éªŒåˆ†äº«ï¼ˆè‹¥æœ‰ï¼‰  
**å‚è€ƒç»éªŒï¼ˆæ¥è‡ªyuhong056ï¼‰**ï¼šâ€œæˆ‘åœ¨è§£å†³è¿™ä¸ªé—®é¢˜æ—¶ï¼Œæœ€åˆæ²¡æƒ³åˆ°äº¤æ¢æ±‚å’Œé¡ºåºï¼Œå¯¼è‡´æ—¶é—´å¤æ‚åº¦å¤ªé«˜ã€‚åæ¥é€šè¿‡æ¨å¯¼å¼å­ï¼Œå‘ç°å¯ä»¥æŠŠåŒé‡å¾ªç¯å˜æˆå•å¾ªç¯ï¼Œè¿™æ‰é€šè¿‡äº†æ‰€æœ‰æµ‹è¯•ç”¨ä¾‹ã€‚â€  
**ç‚¹è¯„**ï¼šäº¤æ¢æ±‚å’Œé¡ºåºæ˜¯è§£å†³å¤§Né—®é¢˜çš„å…³é”®ï¼Œéœ€è¦å¤šç»ƒä¹ â€œå¼å­å˜å½¢â€çš„èƒ½åŠ›ã€‚å¦å¤–ï¼Œé¢„å¤„ç†ï¼ˆæ¯”å¦‚ç»„åˆæ•°ã€å¹‚æ¬¡ï¼‰å¯ä»¥é¿å…é‡å¤è®¡ç®—ï¼Œæé«˜ä»£ç æ•ˆç‡ã€‚  


## ç»“è¯­  
æœ¬æ¬¡å…³äºâ€œ[ABC399F] Range Power Sumâ€çš„C++è§£é¢˜åˆ†æå°±åˆ°è¿™é‡Œã€‚å¸Œæœ›è¿™ä»½å­¦ä¹ æŒ‡å—èƒ½å¸®åŠ©å¤§å®¶ç†è§£**æ•°å­¦æŠ€å·§**å’Œ**å‰ç¼€å’Œä¼˜åŒ–**çš„é‡è¦æ€§ã€‚è®°ä½ï¼Œç¼–ç¨‹çš„æœ¬è´¨æ˜¯â€œç”¨æ•°å­¦ç®€åŒ–é—®é¢˜â€ï¼Œå¤šæ€è€ƒå¼å­å˜å½¢ï¼Œä½ ä¼šå‘ç°å¾ˆå¤šå¤æ‚é—®é¢˜å…¶å®å¾ˆç®€å•ï¼ğŸ’ª  

ä¸‹æ¬¡æˆ‘ä»¬å†ä¸€èµ·æ¢ç´¢æ–°çš„ç¼–ç¨‹æŒ‘æˆ˜ï¼

---
å¤„ç†ç”¨æ—¶ï¼š176.77ç§’
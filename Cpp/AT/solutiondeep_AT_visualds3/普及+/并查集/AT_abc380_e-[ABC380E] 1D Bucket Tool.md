# é¢˜ç›®ä¿¡æ¯

# [ABC380E] 1D Bucket Tool

## é¢˜ç›®æè¿°

[problemUrl]: https://atcoder.jp/contests/abc380/tasks/abc380_e

$ 1 $ ã‹ã‚‰ $ N $ ã®ç•ªå·ãŒã¤ã„ãŸ $ N $ å€‹ã®ãƒã‚¹ãŒä¸€åˆ—ã«ä¸¦ã‚“ã§ã„ã¾ã™ã€‚  
$ 1\ \leq\ i\ <\ N $ ã«ã¤ã„ã¦ã€ãƒã‚¹ $ i $ ã¨ãƒã‚¹ $ i+1 $ ã¯éš£æ¥ã—ã¦ã„ã¾ã™ã€‚

æœ€åˆã€ãƒã‚¹ $ i $ ã¯è‰² $ i $ ã§å¡—ã‚‰ã‚Œã¦ã„ã¾ã™ã€‚

ã‚¯ã‚¨ãƒªãŒ $ Q $ å€‹ä¸ãˆã‚‰ã‚Œã‚‹ã®ã§ã€é †ã«å‡¦ç†ã—ã¦ãã ã•ã„ã€‚ã‚¯ã‚¨ãƒªã¯æ¬¡ã® $ 2 $ ç¨®é¡ã®ã„ãšã‚Œã‹ã§ã™ã€‚

- `1 x c`: ãƒã‚¹ $ x $ ã‹ã‚‰å§‹ã‚ã¦ã€Œã„ã¾ã„ã‚‹ãƒã‚¹ã¨åŒã˜è‰²ã«å¡—ã‚‰ã‚Œã¦ã„ã‚‹éš£æ¥ã™ã‚‹ãƒã‚¹ã€ã¸ã®ç§»å‹•ã‚’ç¹°ã‚Šè¿”ã™ã“ã¨ã§åˆ°é”å¯èƒ½ãªãƒã‚¹ã‚’å…¨ã¦è‰² $ c $ ã«å¡—ã‚Šæ›¿ãˆã‚‹
- `2 c`: è‰² $ c $ ã§å¡—ã‚‰ã‚Œã¦ã„ã‚‹ãƒã‚¹ã®å€‹æ•°ã‚’ç­”ãˆã‚‹

## è¯´æ˜/æç¤º

### åˆ¶ç´„

- $ 1\ \leq\ N\ \leq\ 5\times\ 10^5 $
- $ 1\ \leq\ Q\ \leq\ 2\times\ 10^5 $
- $ 1 $ ç¨®é¡ç›®ã®ã‚¯ã‚¨ãƒªã«ãŠã„ã¦ã€$ 1\ \leq\ x\ \leq\ N $
- $ 1,2 $ ç¨®é¡ç›®ã®ã‚¯ã‚¨ãƒªã«ãŠã„ã¦ã€$ 1\ \leq\ c\ \leq\ N $
- $ 2 $ ç¨®é¡ç›®ã®ã‚¯ã‚¨ãƒªãŒå°‘ãªãã¨ã‚‚ $ 1 $ ã¤å­˜åœ¨ã™ã‚‹
- å…¥åŠ›ã¯å…¨ã¦æ•´æ•°ã§ã‚ã‚‹

### Sample Explanation 1

ã‚¯ã‚¨ãƒªã«ã‚ˆã‚Šã€ãƒã‚¹ã®è‰²ã¯å›³ã®ã‚ˆã†ã«å¡—ã‚Šæ›¿ãˆã‚‰ã‚Œã¦ã„ãã¾ã™ã€‚ 
![å›³](https://img.atcoder.jp/abc380/c3bf3eec819a7b7fcbfd21065c06bab2.png)

## æ ·ä¾‹ #1

### è¾“å…¥

```
5 6
1 5 4
1 4 2
2 2
1 3 2
1 2 3
2 3```

### è¾“å‡º

```
3
4```

# AIåˆ†æç»“æœ

# ğŸ’¡ Kayçš„C++ç®—æ³•è§£æï¼š[ABC380E] 1D Bucket Tool æ·±å…¥å­¦ä¹ æŒ‡å— ğŸ’¡


## 1. é¢˜ç›®è§£è¯»ä¸æ ¸å¿ƒç®—æ³•è¯†åˆ«

âœ¨ **æœ¬é¢˜ä¸»è¦è€ƒå¯Ÿ**ï¼š`ç¼–ç¨‹æŠ€å·§åº”ç”¨ï¼ˆå¹¶æŸ¥é›†ç»´æŠ¤è¿é€šå—ï¼‰`  

ğŸ—£ï¸ **åˆæ­¥åˆ†æ**ï¼š  
è§£å†³â€œ1D Bucket Toolâ€é—®é¢˜ï¼Œå…³é”®åœ¨äº**é«˜æ•ˆç»´æŠ¤è¿ç»­åŒè‰²å—**ï¼ˆæ¯”å¦‚â€œæ¶‚è‰²æ¡¶â€ä¸€é”®æ¶‚æ»¡è¿ç»­çš„ç›¸åŒé¢œè‰²ï¼‰ã€‚æˆ‘ä»¬å¯ä»¥æŠŠæ¯ä¸ªè¿ç»­åŒè‰²å—æ¯”ä½œä¸€ä¸ªâ€œæœ‹å‹åœˆâ€ï¼Œæ¯ä¸ªæœ‹å‹åœˆæœ‰ä¸€ä¸ªâ€œé¦–é¢†â€ï¼ˆæ ¹èŠ‚ç‚¹ï¼‰ï¼Œè´Ÿè´£è®°å½•è¿™ä¸ªåœˆå­çš„**å·¦å³è¾¹ç•Œ**ï¼ˆæ¯”å¦‚æœ‹å‹åœˆä»å“ªä¸ªæ ¼å­å¼€å§‹ï¼Œåˆ°å“ªä¸ªæ ¼å­ç»“æŸï¼‰ã€**å½“å‰é¢œè‰²**ï¼ˆæœ‹å‹åœˆçš„ç»Ÿä¸€é¢œè‰²ï¼‰ã€‚å½“éœ€è¦æ¶‚è‰²æ—¶ï¼Œåªéœ€æ‰¾åˆ°ç›®æ ‡æ ¼å­æ‰€åœ¨çš„â€œæœ‹å‹åœˆâ€ï¼Œè®©é¦–é¢†æ›´æ¢é¢œè‰²ï¼Œå¹¶æ£€æŸ¥å·¦å³é‚»å±…çš„â€œæœ‹å‹åœˆâ€æ˜¯å¦å’Œæ–°é¢œè‰²ç›¸åŒâ€”â€”å¦‚æœç›¸åŒï¼Œå°±æŠŠä¸¤ä¸ªæœ‹å‹åœˆåˆå¹¶æˆä¸€ä¸ªæ›´å¤§çš„åœˆå­ï¼  

- **æ ¸å¿ƒæ€è·¯**ï¼šç”¨**å¹¶æŸ¥é›†ï¼ˆDSUï¼‰**ç»´æŠ¤æ¯ä¸ªè¿ç»­åŒè‰²å—çš„ä¿¡æ¯ï¼ˆå·¦å³è¾¹ç•Œã€é¢œè‰²ï¼‰ï¼ŒåŒæ—¶ç”¨ä¸€ä¸ªè®¡æ•°å™¨è®°å½•æ¯ç§é¢œè‰²çš„æ ¼å­æ•°é‡ã€‚æ“ä½œ1ï¼ˆæ¶‚è‰²ï¼‰æ—¶ï¼Œæ‰¾åˆ°ç›®æ ‡æ ¼å­çš„æ ¹èŠ‚ç‚¹ï¼Œæ›´æ–°é¢œè‰²è®¡æ•°å™¨ï¼Œç„¶ååˆå¹¶å·¦å³ç›¸é‚»çš„åŒè‰²åœˆå­ï¼›æ“ä½œ2ï¼ˆæŸ¥è¯¢ï¼‰æ—¶ï¼Œç›´æ¥è¾“å‡ºè®¡æ•°å™¨çš„å€¼ã€‚  
- **æ ¸å¿ƒéš¾ç‚¹**ï¼šâ‘  å¦‚ä½•å¿«é€Ÿæ‰¾åˆ°ç›®æ ‡æ ¼å­æ‰€åœ¨çš„è¿ç»­åŒè‰²å—ï¼Ÿâ‘¡ å¦‚ä½•ç»´æŠ¤è¿ç»­åŒè‰²å—çš„å·¦å³è¾¹ç•Œï¼Ÿâ‘¢ å¦‚ä½•æ­£ç¡®æ›´æ–°é¢œè‰²æ•°é‡ï¼Ÿ  
- **è§£å†³æ–¹æ¡ˆ**ï¼šâ‘  å¹¶æŸ¥é›†çš„`find`æ“ä½œï¼ˆè·¯å¾„å‹ç¼©ï¼‰å¯ä»¥å¿«é€Ÿæ‰¾åˆ°æ ¹èŠ‚ç‚¹ï¼›â‘¡ åˆå¹¶æ—¶æ›´æ–°æ ¹èŠ‚ç‚¹çš„å·¦å³è¾¹ç•Œï¼›â‘¢ æ¯ä¸ªé¢œè‰²ç»´æŠ¤ä¸€ä¸ªè®¡æ•°å™¨ï¼Œé¢œè‰²å˜åŒ–æ—¶è°ƒæ•´è®¡æ•°å™¨ã€‚  
- **å¯è§†åŒ–è®¾è®¡æ€è·¯**ï¼šç”¨**8ä½åƒç´ é£æ ¼**å±•ç¤ºæ ¼å­ï¼Œæ¯ä¸ªè¿ç»­åŒè‰²å—ç”¨ä¸åŒé¢œè‰²çš„åƒç´ å—è¡¨ç¤ºï¼Œæ ¹èŠ‚ç‚¹ç”¨â€œè¾¹æ¡†â€æ ‡è®°ã€‚æ¶‚è‰²æ—¶ï¼Œç›®æ ‡å—çš„é¢œè‰²é€æ¸å˜ä¸ºæ–°é¢œè‰²ï¼ˆæ¯”å¦‚ä»åŸé¢œè‰²åˆ°æ–°é¢œè‰²çš„æ¸å˜åŠ¨ç”»ï¼‰ï¼Œåˆå¹¶æ—¶ä¸¤ä¸ªå—â€œèåˆâ€æˆä¸€ä¸ªï¼ˆæ¯”å¦‚å·¦è¾¹å—å‘å³ç§»åŠ¨ï¼Œå³è¾¹å—å‘å·¦ç§»åŠ¨ï¼Œæœ€ç»ˆåˆå¹¶ï¼‰ï¼Œå¹¶ä¼´éšâ€œå®â€çš„éŸ³æ•ˆã€‚æ“ä½œ2æ—¶ï¼Œä¾§è¾¹æ æ˜¾ç¤ºé¢œè‰²å¯¹åº”çš„æ•°é‡ï¼Œç”¨â€œæ•°å­—è·³åŠ¨â€åŠ¨ç”»æç¤ºã€‚  


## 2. ç²¾é€‰ä¼˜è´¨é¢˜è§£å‚è€ƒ

### é¢˜è§£ä¸€ï¼ˆæ¥æºï¼šliluhexuanï¼Œèµ18ï¼‰  
* **ç‚¹è¯„**ï¼šè¿™ä»½é¢˜è§£çš„æ€è·¯éå¸¸æ¸…æ™°ï¼Œç”¨å¹¶æŸ¥é›†å®Œç¾è§£å†³äº†è¿ç»­åŒè‰²å—çš„ç»´æŠ¤é—®é¢˜ã€‚ä½œè€…ç”¨`mn`å’Œ`mx`æ•°ç»„è®°å½•æ¯ä¸ªæ ¹èŠ‚ç‚¹çš„å·¦å³è¾¹ç•Œï¼Œé¿å…äº†åˆå¹¶æ—¶çš„é”™è¯¯ï¼ˆæ¯”å¦‚ä¸­é—´å—åˆå¹¶å¯¼è‡´çš„è¾¹ç•Œæ··ä¹±ï¼‰ã€‚ä»£ç è§„èŒƒï¼Œå˜é‡åï¼ˆå¦‚`col`è¡¨ç¤ºé¢œè‰²ã€`sum`è¡¨ç¤ºé›†åˆå¤§å°ï¼‰å«ä¹‰æ˜ç¡®ï¼Œç‰¹åˆ«æ˜¯å¤„ç†åˆå¹¶é€»è¾‘æ—¶çš„ä¸¥è°¨æ€§ï¼ˆæ¯”å¦‚åˆ¤æ–­`x!=y`å†åˆå¹¶ï¼‰ï¼Œå€¼å¾—å­¦ä¹ ã€‚äº®ç‚¹æ˜¯**ç”¨å¹¶æŸ¥é›†ç»´æŠ¤è¾¹ç•Œ**ï¼Œè¿™æ˜¯è§£å†³æœ¬é¢˜çš„å…³é”®æŠ€å·§ã€‚  

### é¢˜è§£äºŒï¼ˆæ¥æºï¼šMoya_Raoï¼Œèµ12ï¼‰  
* **ç‚¹è¯„**ï¼šæ­¤é¢˜è§£çš„ä»£ç éå¸¸ç®€æ´ï¼Œç”¨ç»“æ„ä½“`node`ç»Ÿä¸€ç»´æŠ¤æ¯ä¸ªé›†åˆçš„å·¦å³è¾¹ç•Œå’Œé¢œè‰²ï¼Œé€»è¾‘æ›´æ¸…æ™°ã€‚ä½œè€…å¯¹å¹¶æŸ¥é›†çš„åº”ç”¨å¾ˆç†Ÿç»ƒï¼Œ`FF`å‡½æ•°ï¼ˆè·¯å¾„å‹ç¼©ï¼‰å’Œåˆå¹¶é€»è¾‘ï¼ˆåˆ¤æ–­å·¦å³é‚»å±…é¢œè‰²ï¼‰éƒ½å¾ˆåˆ°ä½ã€‚äº®ç‚¹æ˜¯**ç»“æ„ä½“å°è£…**ï¼ŒæŠŠé›†åˆçš„ä¿¡æ¯æ”¾åœ¨ä¸€èµ·ï¼Œæ–¹ä¾¿ç†è§£å’Œç»´æŠ¤ã€‚ä»å®è·µè§’åº¦çœ‹ï¼Œè¿™ä»½ä»£ç å¯ä»¥ç›´æ¥ç”¨äºç«èµ›ï¼Œè¾¹ç•Œå¤„ç†å¾ˆä¸¥è°¨ã€‚  


## 3. æ ¸å¿ƒéš¾ç‚¹è¾¨æä¸è§£é¢˜ç­–ç•¥

### 1. **å…³é”®ç‚¹1ï¼šå¦‚ä½•å¿«é€Ÿæ‰¾åˆ°ç›®æ ‡æ ¼å­æ‰€åœ¨çš„è¿ç»­åŒè‰²å—ï¼Ÿ**  
* **åˆ†æ**ï¼šè¿ç»­åŒè‰²å—æ˜¯ä¸€ä¸ªâ€œè¿é€šå—â€ï¼Œå¹¶æŸ¥é›†çš„`find`æ“ä½œï¼ˆå¸¦è·¯å¾„å‹ç¼©ï¼‰å¯ä»¥åœ¨è¿‘ä¹O(1)çš„æ—¶é—´å†…æ‰¾åˆ°æ ¹èŠ‚ç‚¹ï¼Œä»è€Œå¿«é€Ÿç¡®å®šç›®æ ‡æ ¼å­æ‰€åœ¨çš„è¿é€šå—ã€‚æ¯”å¦‚ï¼Œç›®æ ‡æ ¼å­`x`çš„æ ¹èŠ‚ç‚¹`fx`å°±æ˜¯è¿™ä¸ªè¿é€šå—çš„â€œé¦–é¢†â€ï¼Œ`fx`çš„`mn`å’Œ`mx`å°±æ˜¯è¿é€šå—çš„å·¦å³è¾¹ç•Œã€‚  
* ğŸ’¡ **å­¦ä¹ ç¬”è®°**ï¼šå¹¶æŸ¥é›†çš„è·¯å¾„å‹ç¼©æ˜¯å¿«é€Ÿæ‰¾æ ¹çš„å…³é”®ï¼

### 2. **å…³é”®ç‚¹2ï¼šå¦‚ä½•ç»´æŠ¤è¿ç»­åŒè‰²å—çš„å·¦å³è¾¹ç•Œï¼Ÿ**  
* **åˆ†æ**ï¼šæ¯ä¸ªæ ¹èŠ‚ç‚¹éœ€è¦è®°å½•è‡ªå·±çš„å·¦å³è¾¹ç•Œï¼ˆ`mn`å’Œ`mx`ï¼‰ã€‚å½“åˆå¹¶ä¸¤ä¸ªè¿é€šå—æ—¶ï¼Œæ ¹èŠ‚ç‚¹çš„`mn`æ›´æ–°ä¸ºä¸¤ä¸ªå—çš„`mn`çš„æœ€å°å€¼ï¼Œ`mx`æ›´æ–°ä¸ºä¸¤ä¸ªå—çš„`mx`çš„æœ€å¤§å€¼ã€‚æ¯”å¦‚ï¼Œåˆå¹¶`fx`å’Œ`fy`ï¼Œ`fx`çš„`mn` = min(fx.mn, fy.mn)ï¼Œ`fx`çš„`mx` = max(fx.mx, fy.mx)ã€‚  
* ğŸ’¡ **å­¦ä¹ ç¬”è®°**ï¼šåˆå¹¶æ—¶ä¸è¦å¿˜è®°æ›´æ–°è¾¹ç•Œï¼

### 3. **å…³é”®ç‚¹3ï¼šå¦‚ä½•æ­£ç¡®æ›´æ–°é¢œè‰²æ•°é‡ï¼Ÿ**  
* **åˆ†æ**ï¼šç”¨ä¸€ä¸ª`cnt`æ•°ç»„è®°å½•æ¯ç§é¢œè‰²çš„æ ¼å­æ•°é‡ã€‚å½“è¿é€šå—`fx`çš„é¢œè‰²ä»`old_c`å˜ä¸º`new_c`æ—¶ï¼Œ`cnt[old_c]`å‡å»`fx`çš„å¤§å°ï¼ˆ`mx[fx]-mn[fx]+1`ï¼‰ï¼Œ`cnt[new_c]`åŠ ä¸Šè¿™ä¸ªå¤§å°ã€‚æ¯”å¦‚ï¼Œ`cnt[col[fx]] -= sum[fx]`ï¼Œ`cnt[c] += sum[fx]`ï¼ˆ`sum[fx]`æ˜¯è¿é€šå—çš„å¤§å°ï¼‰ã€‚  
* ğŸ’¡ **å­¦ä¹ ç¬”è®°**ï¼šé¢œè‰²å˜åŒ–æ—¶ï¼Œä¸€å®šè¦è°ƒæ•´è®¡æ•°å™¨ï¼

### âœ¨ è§£é¢˜æŠ€å·§æ€»ç»“  
- **æŠ€å·§Aï¼šå¹¶æŸ¥é›†ç»´æŠ¤è¿é€šå—**ï¼šå¯¹äºè¿ç»­åŒè‰²å—é—®é¢˜ï¼Œç”¨å¹¶æŸ¥é›†ç»´æŠ¤æ ¹èŠ‚ç‚¹çš„è¾¹ç•Œå’Œé¢œè‰²ï¼Œæ˜¯é«˜æ•ˆçš„è§£å†³æ–¹æ¡ˆã€‚  
- **æŠ€å·§Bï¼šç»“æ„ä½“å°è£…ä¿¡æ¯**ï¼šæŠŠæ ¹èŠ‚ç‚¹çš„è¾¹ç•Œã€é¢œè‰²ã€å¤§å°æ”¾åœ¨ç»“æ„ä½“é‡Œï¼Œä»£ç æ›´æ¸…æ™°ã€‚  
- **æŠ€å·§Cï¼šè®¡æ•°å™¨ç»´æŠ¤æ•°é‡**ï¼šç”¨æ•°ç»„è®°å½•æ¯ç§é¢œè‰²çš„æ•°é‡ï¼ŒæŸ¥è¯¢æ—¶ç›´æ¥è¾“å‡ºï¼Œæ•ˆç‡é«˜ã€‚  


## 4. C++æ ¸å¿ƒä»£ç å®ç°èµæ

### æœ¬é¢˜é€šç”¨æ ¸å¿ƒC++å®ç°å‚è€ƒ  
* **è¯´æ˜**ï¼šæœ¬ä»£ç ç»¼åˆäº†liluhexuanå’ŒMoya_Raoçš„æ€è·¯ï¼Œç”¨ç»“æ„ä½“ç»´æŠ¤é›†åˆä¿¡æ¯ï¼Œé€»è¾‘æ¸…æ™°ï¼Œé€‚åˆåˆå­¦è€…ç†è§£ã€‚  
* **å®Œæ•´æ ¸å¿ƒä»£ç **ï¼š  
```cpp
#include <iostream>
#include <vector>
using namespace std;

const int N = 5e5 + 10;

struct Node {
    int fa;     // çˆ¶èŠ‚ç‚¹ï¼ˆæ ¹èŠ‚ç‚¹çš„faæ˜¯è‡ªå·±ï¼‰
    int l, r;   // é›†åˆçš„å·¦å³è¾¹ç•Œ
    int col;    // é›†åˆçš„é¢œè‰²
    int size;   // é›†åˆçš„å¤§å°
} node[N];

int cnt[N];   // cnt[c]è¡¨ç¤ºé¢œè‰²cçš„æ ¼å­æ•°é‡

int find(int x) {
    if (node[x].fa != x) {
        node[x].fa = find(node[x].fa);  // è·¯å¾„å‹ç¼©
    }
    return node[x].fa;
}

void merge(int x, int y) {
    int fx = find(x), fy = find(y);
    if (fx == fy) return;  // åŒä¸€ä¸ªé›†åˆï¼Œä¸éœ€è¦åˆå¹¶
    // åˆå¹¶fyåˆ°fxï¼ˆå‡è®¾fxæ˜¯æ ¹ï¼‰
    node[fy].fa = fx;
    node[fx].l = min(node[fx].l, node[fy].l);  // æ›´æ–°å·¦è¾¹ç•Œ
    node[fx].r = max(node[fx].r, node[fy].r);  // æ›´æ–°å³è¾¹ç•Œ
    node[fx].size += node[fy].size;            // æ›´æ–°å¤§å°
}

int main() {
    ios::sync_with_stdio(false);
    cin.tie(nullptr);
    
    int n, q;
    cin >> n >> q;
    
    // åˆå§‹åŒ–ï¼šæ¯ä¸ªæ ¼å­æ˜¯ä¸€ä¸ªç‹¬ç«‹çš„é›†åˆ
    for (int i = 1; i <= n; ++i) {
        node[i].fa = i;
        node[i].l = node[i].r = i;
        node[i].col = i;
        node[i].size = 1;
        cnt[i] = 1;  // åˆå§‹æ—¶é¢œè‰²iæœ‰1ä¸ªæ ¼å­
    }
    
    while (q--) {
        int op;
        cin >> op;
        if (op == 1) {
            int x, c;
            cin >> x >> c;
            int fx = find(x);  // æ‰¾åˆ°xæ‰€åœ¨é›†åˆçš„æ ¹
            int old_c = node[fx].col;
            if (old_c == c) continue;  // é¢œè‰²ç›¸åŒï¼Œä¸éœ€è¦æ“ä½œ
            
            // æ›´æ–°é¢œè‰²è®¡æ•°å™¨
            cnt[old_c] -= node[fx].size;
            cnt[c] += node[fx].size;
            node[fx].col = c;  // æ›´æ”¹æ ¹çš„é¢œè‰²
            
            // æ£€æŸ¥å·¦è¾¹é‚»å±…ï¼ˆfxçš„å·¦è¾¹ç•Œ-1ï¼‰æ˜¯å¦åŒè‰²ï¼Œè‹¥æ˜¯åˆ™åˆå¹¶
            if (node[fx].l > 1) {
                int left = node[fx].l - 1;
                int fleft = find(left);
                if (node[fleft].col == c) {
                    merge(fx, fleft);
                }
            }
            
            // æ£€æŸ¥å³è¾¹é‚»å±…ï¼ˆfxçš„å³è¾¹ç•Œ+1ï¼‰æ˜¯å¦åŒè‰²ï¼Œè‹¥æ˜¯åˆ™åˆå¹¶
            if (node[fx].r < n) {
                int right = node[fx].r + 1;
                int fright = find(right);
                if (node[fright].col == c) {
                    merge(fx, fright);
                }
            }
        } else {
            int c;
            cin >> c;
            cout << cnt[c] << '\n';  // ç›´æ¥è¾“å‡ºé¢œè‰²cçš„æ•°é‡
        }
    }
    
    return 0;
}
```  
* **ä»£ç è§£è¯»æ¦‚è¦**ï¼š  
  1. **åˆå§‹åŒ–**ï¼šæ¯ä¸ªæ ¼å­æ˜¯ä¸€ä¸ªç‹¬ç«‹çš„é›†åˆï¼Œ`node[i]`è®°å½•å…¶faã€è¾¹ç•Œã€é¢œè‰²ã€å¤§å°ï¼Œ`cnt[i]`è®°å½•é¢œè‰²içš„æ•°é‡ã€‚  
  2. **æ“ä½œ1ï¼ˆæ¶‚è‰²ï¼‰**ï¼šæ‰¾åˆ°xçš„æ ¹`fx`ï¼Œæ›´æ–°é¢œè‰²è®¡æ•°å™¨ï¼Œç„¶åæ£€æŸ¥å·¦å³é‚»å±…æ˜¯å¦åŒè‰²ï¼Œè‹¥æ˜¯åˆ™åˆå¹¶ã€‚  
  3. **æ“ä½œ2ï¼ˆæŸ¥è¯¢ï¼‰**ï¼šç›´æ¥è¾“å‡º`cnt[c]`ã€‚  


### é¢˜è§£ä¸€ï¼ˆæ¥æºï¼šliluhexuanï¼‰ç‰‡æ®µèµæ  
* **äº®ç‚¹**ï¼šç”¨`mn`å’Œ`mx`æ•°ç»„ç»´æŠ¤è¾¹ç•Œï¼Œé¿å…åˆå¹¶é”™è¯¯ã€‚  
* **æ ¸å¿ƒä»£ç ç‰‡æ®µ**ï¼š  
```cpp
// åˆå¹¶æ—¶æ›´æ–°è¾¹ç•Œ
void join(int x, int y) {
    x = find(x), y = find(y);
    if (x != y) {
        sum[x] += sum[y];
        p[y] = x;
        mx[x] = max(mx[x], mx[y]);  // æ›´æ–°å³è¾¹ç•Œ
        mn[x] = min(mn[x], mn[y]);  // æ›´æ–°å·¦è¾¹ç•Œ
    }
}
```  
* **ä»£ç è§£è¯»**ï¼š  
  è¿™æ®µä»£ç æ˜¯åˆå¹¶ä¸¤ä¸ªé›†åˆçš„å‡½æ•°ã€‚`x`å’Œ`y`æ˜¯ä¸¤ä¸ªé›†åˆçš„æ ¹ï¼Œåˆå¹¶æ—¶æŠŠ`y`çš„çˆ¶èŠ‚ç‚¹è®¾ä¸º`x`ï¼Œç„¶åæ›´æ–°`x`çš„`mx`ï¼ˆå³è¾¹ç•Œï¼‰ä¸º`x`å’Œ`y`çš„`mx`çš„æœ€å¤§å€¼ï¼Œ`mn`ï¼ˆå·¦è¾¹ç•Œï¼‰ä¸º`x`å’Œ`y`çš„`mn`çš„æœ€å°å€¼ã€‚è¿™æ ·ï¼Œ`x`çš„`mx`å’Œ`mn`å°±ä»£è¡¨äº†åˆå¹¶åçš„é›†åˆçš„å·¦å³è¾¹ç•Œã€‚  
* ğŸ’¡ **å­¦ä¹ ç¬”è®°**ï¼šåˆå¹¶æ—¶ä¸€å®šè¦æ›´æ–°è¾¹ç•Œï¼Œå¦åˆ™ä¼šå¯¼è‡´è¾¹ç•Œé”™è¯¯ï¼


### é¢˜è§£äºŒï¼ˆæ¥æºï¼šMoya_Raoï¼‰ç‰‡æ®µèµæ  
* **äº®ç‚¹**ï¼šç”¨ç»“æ„ä½“å°è£…é›†åˆä¿¡æ¯ï¼Œé€»è¾‘æ›´æ¸…æ™°ã€‚  
* **æ ¸å¿ƒä»£ç ç‰‡æ®µ**ï¼š  
```cpp
struct node {
    int l, r, c;  // å·¦è¾¹ç•Œã€å³è¾¹ç•Œã€é¢œè‰²
} p[N];

// åˆå¹¶æ—¶æ›´æ–°è¾¹ç•Œ
if (p[fid].c == p[fsm].c) {
    fa[fsm] = fid;
    p[fid].l = p[fsm].l;  // æ›´æ–°å·¦è¾¹ç•Œ
}
```  
* **ä»£ç è§£è¯»**ï¼š  
  è¿™æ®µä»£ç æ˜¯åˆå¹¶å·¦è¾¹é‚»å±…çš„é€»è¾‘ã€‚`fid`æ˜¯å½“å‰é›†åˆçš„æ ¹ï¼Œ`fsm`æ˜¯å·¦è¾¹é‚»å±…çš„æ ¹ã€‚å¦‚æœä¸¤è€…é¢œè‰²ç›¸åŒï¼Œå°±æŠŠ`fsm`çš„çˆ¶èŠ‚ç‚¹è®¾ä¸º`fid`ï¼Œç„¶åæ›´æ–°`fid`çš„å·¦è¾¹ç•Œä¸º`fsm`çš„å·¦è¾¹ç•Œã€‚è¿™æ ·ï¼Œ`fid`çš„å·¦è¾¹ç•Œå°±æ‰©å±•åˆ°äº†`fsm`çš„å·¦è¾¹ç•Œã€‚  
* ğŸ’¡ **å­¦ä¹ ç¬”è®°**ï¼šç»“æ„ä½“å°è£…å¯ä»¥è®©ä»£ç æ›´æ˜“è¯»ï¼Œé€‚åˆåˆå­¦è€…ï¼


## 5. ç®—æ³•å¯è§†åŒ–ï¼šåƒç´ åŠ¨ç”»æ¼”ç¤º (æ ¸å¿ƒéƒ¨åˆ†)

### ğŸ® åŠ¨ç”»æ¼”ç¤ºä¸»é¢˜ï¼š`åƒç´ æœ‹å‹åœˆåˆå¹¶è®°`  
**é£æ ¼**ï¼š8ä½FCçº¢ç™½æœºé£æ ¼ï¼Œç”¨16è‰²è°ƒè‰²æ¿ï¼ˆæ¯”å¦‚çº¢è‰²ã€è“è‰²ã€ç»¿è‰²ç­‰ï¼‰ï¼Œæ ¼å­æ˜¯16x16åƒç´ çš„æ–¹å—ï¼Œæ ¹èŠ‚ç‚¹ç”¨é»„è‰²è¾¹æ¡†æ ‡è®°ã€‚  

### ğŸš€ æ ¸å¿ƒæ¼”ç¤ºå†…å®¹  
1. **åˆå§‹åŒ–åœºæ™¯**ï¼šå±å¹•æ˜¾ç¤º5ä¸ªåƒç´ æ ¼å­ï¼ˆå¯¹åº”æ ·ä¾‹è¾“å…¥çš„n=5ï¼‰ï¼Œæ¯ä¸ªæ ¼å­é¢œè‰²ä¸ºè‡ªèº«ç¼–å·ï¼ˆ1å·çº¢ã€2å·è“ã€3å·ç»¿ã€4å·é»„ã€5å·ç´«ï¼‰ï¼Œæ ¹èŠ‚ç‚¹ç”¨é»„è‰²è¾¹æ¡†æ ‡è®°ã€‚ä¾§è¾¹æ æ˜¾ç¤ºâ€œé¢œè‰²è®¡æ•°å™¨â€ï¼ˆæ¯”å¦‚çº¢ï¼š1ï¼Œè“ï¼š1ï¼Œç»¿ï¼š1ï¼Œé»„ï¼š1ï¼Œç´«ï¼š1ï¼‰ã€‚  
2. **æ“ä½œ1ï¼š1 5 4**ï¼ˆæŠŠ5å·æ ¼å­æ‰€åœ¨çš„ç´«è‰²å—æ¶‚æˆé»„è‰²ï¼‰ï¼š  
   - 5å·æ ¼å­çš„æ ¹æ˜¯5ï¼ˆç´«è‰²ï¼‰ï¼Œç‚¹å‡»â€œæ¶‚è‰²â€æŒ‰é’®åï¼Œç´«è‰²å—ï¼ˆ5å·ï¼‰é€æ¸å˜ä¸ºé»„è‰²ï¼ˆæ¸å˜åŠ¨ç”»ï¼ŒæŒç»­0.5ç§’ï¼‰ã€‚  
   - é¢œè‰²è®¡æ•°å™¨æ›´æ–°ï¼šç´«ï¼š0ï¼Œé»„ï¼š2ï¼ˆåŸæ¥çš„4å·é»„+5å·é»„ï¼‰ã€‚  
   - æ£€æŸ¥å³è¾¹é‚»å±…ï¼ˆ5å·å³è¾¹æ²¡æœ‰ï¼‰ï¼Œå·¦è¾¹é‚»å±…æ˜¯4å·ï¼ˆé»„è‰²ï¼‰ï¼Œé¢œè‰²ç›¸åŒï¼Œåˆå¹¶ä¸¤ä¸ªå—ï¼š4å·å’Œ5å·çš„åƒç´ å—â€œèåˆâ€æˆä¸€ä¸ªï¼ˆ4å·å‘å³ç§»åŠ¨ï¼Œ5å·å‘å·¦ç§»åŠ¨ï¼Œæœ€ç»ˆåˆå¹¶æˆä¸€ä¸ªé»„è‰²å—ï¼Œè¾¹ç•Œä¸º4-5ï¼‰ï¼Œæ ¹èŠ‚ç‚¹å˜ä¸º4ï¼ˆé»„è‰²è¾¹æ¡†ï¼‰ã€‚  
3. **æ“ä½œ1ï¼š1 4 2**ï¼ˆæŠŠ4å·æ‰€åœ¨çš„é»„è‰²å—æ¶‚æˆè“è‰²ï¼‰ï¼š  
   - 4å·çš„æ ¹æ˜¯4ï¼ˆé»„è‰²ï¼‰ï¼Œé»„è‰²å—ï¼ˆ4-5ï¼‰é€æ¸å˜ä¸ºè“è‰²ï¼ˆæ¸å˜åŠ¨ç”»ï¼‰ã€‚  
   - é¢œè‰²è®¡æ•°å™¨æ›´æ–°ï¼šé»„ï¼š0ï¼Œè“ï¼š2ï¼ˆåŸæ¥çš„2å·è“+4-5å·è“ï¼‰ã€‚  
   - æ£€æŸ¥å·¦è¾¹é‚»å±…æ˜¯3å·ï¼ˆç»¿è‰²ï¼‰ï¼Œé¢œè‰²ä¸åŒï¼›å³è¾¹é‚»å±…æ²¡æœ‰ã€‚ç„¶åæ£€æŸ¥å·¦è¾¹é‚»å±…çš„å·¦è¾¹æ˜¯2å·ï¼ˆè“è‰²ï¼‰ï¼Œé¢œè‰²ç›¸åŒï¼Œåˆå¹¶ï¼š2å·å’Œ4å·çš„è“è‰²å—èåˆï¼ˆ2å·å‘å³ç§»åŠ¨ï¼Œ4å·å‘å·¦ç§»åŠ¨ï¼Œåˆå¹¶æˆ2-5å·è“è‰²å—ï¼‰ï¼Œæ ¹èŠ‚ç‚¹å˜ä¸º2ï¼ˆè“è‰²è¾¹æ¡†ï¼‰ã€‚  
4. **æ“ä½œ2ï¼š2 2**ï¼ˆæŸ¥è¯¢é¢œè‰²2çš„æ•°é‡ï¼‰ï¼š  
   - ä¾§è¾¹æ çš„â€œé¢œè‰²è®¡æ•°å™¨â€ä¸­ï¼Œè“è‰²ï¼ˆ2å·ï¼‰çš„æ•°é‡è·³åŠ¨æ˜¾ç¤ºâ€œ3â€ï¼ˆå¯¹åº”æ ·ä¾‹è¾“å‡ºï¼‰ï¼Œä¼´éšâ€œå®â€çš„éŸ³æ•ˆã€‚  

### ğŸ® äº¤äº’ä¸æ§åˆ¶  
- **æ­¥è¿›æ§åˆ¶**ï¼šâ€œå•æ­¥æ‰§è¡Œâ€æŒ‰é’®ï¼Œæ¯ç‚¹å‡»ä¸€æ¬¡æ‰§è¡Œä¸€æ­¥æ“ä½œï¼›â€œè‡ªåŠ¨æ’­æ”¾â€æŒ‰é’®ï¼ŒæŒ‰1ç§’/æ­¥çš„é€Ÿåº¦è‡ªåŠ¨æ‰§è¡Œã€‚  
- **éŸ³æ•ˆ**ï¼šæ¶‚è‰²æ—¶æ’­æ”¾â€œå”°â€çš„éŸ³æ•ˆï¼Œåˆå¹¶æ—¶æ’­æ”¾â€œå®â€çš„éŸ³æ•ˆï¼ŒæŸ¥è¯¢æ—¶æ’­æ”¾â€œæ»´â€çš„éŸ³æ•ˆã€‚  
- **é‡ç½®**ï¼šâ€œé‡ç½®â€æŒ‰é’®ï¼Œæ¢å¤åˆå§‹çŠ¶æ€ã€‚  

### ğŸ¨ è®¾è®¡æ€è·¯  
- **åƒç´ é£æ ¼**ï¼šæ¨¡æ‹ŸFCæ¸¸æˆçš„ç”»é¢ï¼Œè®©å­¦ä¹ è€…æ„Ÿåˆ°äº²åˆ‡ï¼Œé™ä½å­¦ä¹ å‹åŠ›ã€‚  
- **åŠ¨ç”»æ•ˆæœ**ï¼šæ¸å˜ã€èåˆç­‰åŠ¨ç”»è®©ç®—æ³•è¿‡ç¨‹æ›´ç›´è§‚ï¼Œæ¯”å¦‚åˆå¹¶æ—¶çš„â€œç§»åŠ¨â€åŠ¨ç”»ï¼Œæ¸…æ¥šæ˜¾ç¤ºä¸¤ä¸ªå—å¦‚ä½•åˆå¹¶ã€‚  
- **éŸ³æ•ˆæç¤º**ï¼šä¸åŒæ“ä½œçš„éŸ³æ•ˆå¸®åŠ©å­¦ä¹ è€…è®°ä½æ“ä½œçš„å«ä¹‰ï¼Œæ¯”å¦‚â€œå®â€ä»£è¡¨åˆå¹¶æˆåŠŸã€‚  


## 6. æ‹“å±•ç»ƒä¹ ä¸ç›¸ä¼¼é—®é¢˜æ€è€ƒ

### ğŸ§  é€šç”¨æ€è·¯è¿ç§»  
å¹¶æŸ¥é›†ç»´æŠ¤è¿é€šå—çš„æ€è·¯ï¼Œä¸ä»…å¯ä»¥è§£å†³æœ¬é¢˜çš„â€œè¿ç»­åŒè‰²å—â€é—®é¢˜ï¼Œè¿˜å¯ä»¥è§£å†³ï¼š  
1. **äº²æˆšé—®é¢˜**ï¼ˆåˆ¤æ–­ä¸¤ä¸ªäººæ˜¯å¦æœ‰äº²æˆšå…³ç³»ï¼Œäº²æˆšå…³ç³»æ˜¯è¿é€šçš„ï¼‰ï¼›  
2. **åŒºé—´åˆå¹¶é—®é¢˜**ï¼ˆæ¯”å¦‚åˆå¹¶é‡å çš„åŒºé—´ï¼‰ï¼›  
3. **å›¾çš„è¿é€šæ€§é—®é¢˜**ï¼ˆåˆ¤æ–­å›¾ä¸­ä¸¤ä¸ªèŠ‚ç‚¹æ˜¯å¦è¿é€šï¼‰ã€‚  

### ğŸ“š æ´›è°·ç»ƒä¹ æ¨è  
1. **æ´›è°· P3367 ã€æ¨¡æ¿ã€‘å¹¶æŸ¥é›†**  
   - ğŸ—£ï¸ **æ¨èç†ç”±**ï¼šå¹¶æŸ¥é›†çš„åŸºç¡€æ¨¡æ¿é¢˜ï¼Œå¸®åŠ©ä½ æŒæ¡`find`å’Œ`merge`æ“ä½œã€‚  
2. **æ´›è°· P1551 äº²æˆš**  
   - ğŸ—£ï¸ **æ¨èç†ç”±**ï¼šå¹¶æŸ¥é›†çš„ç»å…¸åº”ç”¨ï¼Œåˆ¤æ–­ä¸¤ä¸ªäººæ˜¯å¦æœ‰äº²æˆšå…³ç³»ï¼Œé”»ç‚¼è¿é€šæ€§åˆ¤æ–­èƒ½åŠ›ã€‚  
3. **æ´›è°· P2256 ä¸€ä¸­æ ¡è¿ä¼šä¹‹ç™¾ç±³è·‘**  
   - ğŸ—£ï¸ **æ¨èç†ç”±**ï¼šå¹¶æŸ¥é›†ç»´æŠ¤åŒºé—´çš„é—®é¢˜ï¼Œç±»ä¼¼æœ¬é¢˜çš„è¿ç»­åŒè‰²å—ï¼Œé”»ç‚¼è¾¹ç•Œç»´æŠ¤èƒ½åŠ›ã€‚  
4. **æ´›è°· P1197 [JSOI2008] æ˜Ÿçƒå¤§æˆ˜**  
   - ğŸ—£ï¸ **æ¨èç†ç”±**ï¼šå¹¶æŸ¥é›†çš„é€†å‘æ“ä½œï¼ˆä»ç ´ååˆ°ä¿®å¤ï¼‰ï¼Œæ‹“å±•ä½ çš„æ€ç»´ã€‚  


## 7. å­¦ä¹ å¿ƒå¾—ä¸ç»éªŒåˆ†äº« (è‹¥æœ‰)  
**å‚è€ƒç»éªŒï¼ˆæ¥è‡ªliluhexuanï¼‰**ï¼šâ€œæˆ‘åœ¨è§£å†³è¿™ä¸ªé—®é¢˜æ—¶ï¼Œæœ€åˆåˆå¹¶æ—¶æ²¡æœ‰æ›´æ–°è¾¹ç•Œï¼Œå¯¼è‡´è¾¹ç•Œé”™è¯¯ã€‚åæ¥é€šè¿‡æ‰“å°ä¸­é—´å˜é‡ï¼ˆæ¯”å¦‚`mn`å’Œ`mx`çš„å€¼ï¼‰ï¼Œæ‰å‘ç°é—®é¢˜æ‰€åœ¨ã€‚â€  
**ç‚¹è¯„**ï¼šè¿™ä½ä½œè€…çš„ç»éªŒå¾ˆå…¸å‹ã€‚åœ¨ç¼–ç¨‹è¿‡ç¨‹ä¸­ï¼Œ**æ‰“å°ä¸­é—´å˜é‡**æ˜¯å®šä½é”™è¯¯çš„æœ‰æ•ˆæ–¹æ³•ã€‚æ¯”å¦‚ï¼Œå½“åˆå¹¶åè¾¹ç•Œä¸æ­£ç¡®æ—¶ï¼Œæ‰“å°`mn`å’Œ`mx`çš„å€¼ï¼Œå°±èƒ½å¿«é€Ÿæ‰¾åˆ°é”™è¯¯åŸå› ã€‚  


## ğŸ“ æ€»ç»“  
æœ¬æ¬¡åˆ†æçš„â€œ1D Bucket Toolâ€é—®é¢˜ï¼Œæ ¸å¿ƒæ˜¯ç”¨**å¹¶æŸ¥é›†ç»´æŠ¤è¿ç»­åŒè‰²å—**ã€‚é€šè¿‡å¹¶æŸ¥é›†çš„`find`æ“ä½œå¿«é€Ÿæ‰¾åˆ°æ ¹èŠ‚ç‚¹ï¼Œåˆå¹¶æ—¶æ›´æ–°è¾¹ç•Œï¼Œç”¨è®¡æ•°å™¨ç»´æŠ¤é¢œè‰²æ•°é‡ï¼Œå°±èƒ½é«˜æ•ˆè§£å†³é—®é¢˜ã€‚å¸Œæœ›è¿™ä»½æŒ‡å—èƒ½å¸®åŠ©ä½ æŒæ¡å¹¶æŸ¥é›†çš„åº”ç”¨ï¼Œä¸‹æ¬¡é‡åˆ°ç±»ä¼¼é—®é¢˜æ—¶ï¼Œèƒ½ä¸¾ä¸€åä¸‰ï¼ğŸ’ª  

å¦‚æœæœ‰ä»»ä½•ç–‘é—®ï¼Œæ¬¢è¿éšæ—¶æé—®ï¼ŒKayä¼šå¸®ä½ è§£ç­”ï¼ğŸ˜ƒ

---
å¤„ç†ç”¨æ—¶ï¼š208.70ç§’
# é¢˜ç›®ä¿¡æ¯

# [ABC378E] Mod Sigma Problem

## é¢˜ç›®æè¿°

[problemUrl]: https://atcoder.jp/contests/abc378/tasks/abc378_e

You are given a sequence $A = (A_1, A_2, \dots, A_N)$ of $N$ non-negative integers, and a positive integer $M$.

Find the following value:

$$
 \sum_{1 \leq l \leq r \leq N} \left( \left(\sum_{l \leq i \leq r} A_i\right) \mathbin{\mathrm{mod}} M \right). 
$$

Here, $X \mathbin{\mathrm{mod}} M$ denotes the remainder when the non-negative integer $X$ is divided by $M$.

## è¯´æ˜/æç¤º

### åˆ¶ç´„

### Constraints

-   $1 \leq N \leq 2 \times 10^5$
-   $1 \leq M \leq 2 \times 10^5$
-   $0 \leq A_i \leq 10^9$
 
### Sample Explanation 1

-   $A_1 \mathbin{\mathrm{mod}} M = 2$
-   $(A_1+A_2) \mathbin{\mathrm{mod}} M = 3$
-   $(A_1+A_2+A_3) \mathbin{\mathrm{mod}} M = 3$
-   $A_2 \mathbin{\mathrm{mod}} M = 1$
-   $(A_2+A_3) \mathbin{\mathrm{mod}} M = 1$
-   $A_3 \mathbin{\mathrm{mod}} M = 0$

The answer is the sum of these values, $10$. Note that the outer sum is not taken modulo $M$.

## æ ·ä¾‹ #1

### è¾“å…¥

```
3 4

2 5 0```

### è¾“å‡º

```
10```

## æ ·ä¾‹ #2

### è¾“å…¥

```
10 100

320 578 244 604 145 839 156 857 556 400```

### è¾“å‡º

```
2736```

# AIåˆ†æç»“æœ

# ğŸ’¡ Kayçš„C++ç®—æ³•è§£æï¼š[ABC378E] Mod Sigma Problem æ·±å…¥å­¦ä¹ æŒ‡å— ğŸ’¡


## 1. é¢˜ç›®è§£è¯»ä¸æ ¸å¿ƒç®—æ³•è¯†åˆ«

âœ¨ **æœ¬é¢˜ä¸»è¦è€ƒå¯Ÿ**ï¼šå‰ç¼€å’Œè½¬åŒ– + æ ‘çŠ¶æ•°ç»„ï¼ˆé€†åºå¯¹ç»Ÿè®¡ï¼‰


### ğŸ—£ï¸ åˆæ­¥åˆ†æ  
è§£å†³â€œMod Sigma Problemâ€çš„å…³é”®ï¼Œåœ¨äº**å°†å­æ®µå’Œæ¨¡è¿ç®—è½¬åŒ–ä¸ºå‰ç¼€å’Œçš„å·®ï¼Œå¹¶é€šè¿‡é€†åºå¯¹ç»Ÿè®¡è¡¥å…¨æ¨¡è¿ç®—çš„å½±å“**ã€‚  

ç®€å•æ¥è¯´ï¼Œæˆ‘ä»¬å¯ä»¥æŠŠæ¯ä¸ªå­æ®µå’Œ`[l,r]`çš„å’Œè¡¨ç¤ºä¸ºå‰ç¼€å’Œ`s[r] - s[l-1]`ï¼ˆ`s`æ˜¯å‰ç¼€å’Œæ•°ç»„ï¼‰ã€‚æ¨¡`M`åçš„å€¼æœ‰ä¸¤ç§æƒ…å†µï¼š  
- å¦‚æœ`s[r] â‰¥ s[l-1]`ï¼Œåˆ™ç»“æœå°±æ˜¯`s[r] - s[l-1]`ï¼›  
- å¦‚æœ`s[r] < s[l-1]`ï¼Œåˆ™ç»“æœéœ€è¦åŠ `M`ï¼ˆå› ä¸ºè´Ÿæ•°æ¨¡è¿ç®—ä¼šå˜æˆæ­£æ•°ï¼‰ã€‚  

å› æ­¤ï¼Œæ€»å’Œå¯ä»¥æ‹†åˆ†ä¸ºä¸¤éƒ¨åˆ†ï¼š  
1. æ‰€æœ‰`s[r] - s[l-1]`çš„å’Œï¼ˆä¸è€ƒè™‘æ¨¡çš„æƒ…å†µï¼‰ï¼›  
2. åŠ `M`çš„æ¬¡æ•°ï¼Œå³**é€†åºå¯¹æ•°é‡**ï¼ˆ`s[r] < s[l-1]`çš„æ¬¡æ•°ï¼‰ã€‚  

**æ ¸å¿ƒç®—æ³•æµç¨‹**ï¼š  
- è®¡ç®—å‰ç¼€å’Œæ•°ç»„`s`ï¼ˆæ¯ä¸ªå…ƒç´ å¯¹`M`å–æ¨¡ï¼‰ï¼›  
- è®¡ç®—â€œæ— æ¨¡æ€»å’Œâ€ï¼š`sum(r*s[r] - å‰ç¼€å’Œçš„å‰ç¼€å’Œ)`ï¼›  
- ç”¨æ ‘çŠ¶æ•°ç»„ç»Ÿè®¡é€†åºå¯¹æ•°é‡`num`ï¼›  
- æœ€ç»ˆç­”æ¡ˆ = æ— æ¨¡æ€»å’Œ + `num*M`ã€‚  

**å¯è§†åŒ–è®¾è®¡æ€è·¯**ï¼š  
ç”¨8ä½åƒç´ é£æ ¼å±•ç¤ºå‰ç¼€å’Œè®¡ç®—ï¼ˆæ¯”å¦‚ç”¨è¿›åº¦æ¡ç´¯ç§¯ï¼‰ã€æ ‘çŠ¶æ•°ç»„çš„æ›´æ–°ï¼ˆæ¯”å¦‚èŠ‚ç‚¹é—ªçƒï¼‰ã€é€†åºå¯¹ç»Ÿè®¡ï¼ˆæ¯”å¦‚ç”¨ä¸åŒé¢œè‰²æ ‡è®°é€†åºå¯¹ï¼‰ã€‚ä¾‹å¦‚ï¼Œå½“å¤„ç†åˆ°`s[r]`æ—¶ï¼Œæ ‘çŠ¶æ•°ç»„ä¸­å°äº`s[r]`çš„èŠ‚ç‚¹ä¼šé«˜äº®ï¼Œæç¤ºâ€œè¿™äº›éœ€è¦è¡¥`M`â€ã€‚åŒæ—¶åŠ å…¥â€œå®â€çš„éŸ³æ•ˆè¡¨ç¤ºé€†åºå¯¹ç»Ÿè®¡å®Œæˆï¼Œâ€œèƒœåˆ©â€éŸ³æ•ˆè¡¨ç¤ºæœ€ç»ˆç­”æ¡ˆè®¡ç®—å®Œæˆã€‚


## 2. ç²¾é€‰ä¼˜è´¨é¢˜è§£å‚è€ƒ


### é¢˜è§£ä¸€ï¼šï¼ˆæ¥æºï¼šfishing_catï¼‰  
* **ç‚¹è¯„**ï¼šè¿™ä»½é¢˜è§£æ€è·¯æ¸…æ™°ï¼Œç›´æ¥å‘½ä¸­é—®é¢˜æ ¸å¿ƒã€‚ä½œè€…é¦–å…ˆé€šè¿‡å‰ç¼€å’Œè½¬åŒ–é—®é¢˜ï¼Œå°†æ¨¡è¿ç®—æ‹†åˆ†ä¸ºâ€œæ— æ¨¡æ€»å’Œâ€å’Œâ€œé€†åºå¯¹è¡¥`M`â€ä¸¤éƒ¨åˆ†ï¼Œé€»è¾‘æ¨å¯¼ä¸¥è°¨ã€‚ä»£ç é£æ ¼è§„èŒƒï¼Œå˜é‡å‘½åï¼ˆå¦‚`qzh`è¡¨ç¤ºå‰ç¼€å’Œï¼‰æ˜“æ‡‚ï¼Œæ ‘çŠ¶æ•°ç»„çš„ä½¿ç”¨ï¼ˆç»Ÿè®¡é€†åºå¯¹ï¼‰é«˜æ•ˆã€‚ç‰¹åˆ«æ˜¯å¯¹â€œæ— æ¨¡æ€»å’Œâ€çš„æ¨å¯¼ï¼ˆ`sum(2i - N)*qzh[i]`ï¼‰ï¼Œè™½ç„¶ä¸­é—´æ­¥éª¤æœ‰è°ƒæ•´ï¼Œä½†æœ€ç»ˆç»“æœæ­£ç¡®ï¼Œä½“ç°äº†å¯¹å‰ç¼€å’Œçš„æ·±åˆ»ç†è§£ã€‚


### é¢˜è§£äºŒï¼šï¼ˆæ¥æºï¼šyzljyï¼‰  
* **ç‚¹è¯„**ï¼šæ­¤é¢˜è§£ç”¨ä¸¤ä¸ªæ ‘çŠ¶æ•°ç»„ï¼ˆ`sum`ç»´æŠ¤å€¼çš„å’Œï¼Œ`cnt`ç»´æŠ¤å€¼çš„ä¸ªæ•°ï¼‰ï¼Œç›´æ¥ç»Ÿè®¡æ¯ä¸ªå³ç«¯ç‚¹çš„è´¡çŒ®ï¼Œæ€è·¯æ›´ç›´è§‚ã€‚ä½œè€…å°†æ¨¡è¿ç®—çš„ä¸¤ç§æƒ…å†µæ‹†åˆ†ä¸ºâ€œå°äºç­‰äº`s[r]`â€å’Œâ€œå¤§äº`s[r]`â€ï¼Œåˆ†åˆ«è®¡ç®—è´¡çŒ®ï¼Œä»£ç å®ç°ç®€æ´ã€‚è¿™ç§æ–¹æ³•é¿å…äº†â€œæ— æ¨¡æ€»å’Œâ€çš„æ¨å¯¼ï¼Œé€‚åˆåˆå­¦è€…ç†è§£æ¨¡è¿ç®—çš„æ‹†åˆ†é€»è¾‘ã€‚


### é¢˜è§£ä¸‰ï¼šï¼ˆæ¥æºï¼šMLE_Automatonï¼‰  
* **ç‚¹è¯„**ï¼šè¿™ä»½é¢˜è§£ä»£ç æå…¶ç®€æ´ï¼Œå´æ¶µç›–äº†æ‰€æœ‰æ ¸å¿ƒé€»è¾‘ã€‚ä½œè€…ç”¨æ ‘çŠ¶æ•°ç»„ç»Ÿè®¡é€†åºå¯¹ï¼Œç›´æ¥è®¡ç®—â€œæ— æ¨¡æ€»å’Œâ€ï¼ˆ`a[i]*i - s`ï¼‰ï¼Œå¹¶è¡¥`M`ï¼ˆ`(i-1 - sum(a[i]+1))*M`ï¼‰ã€‚ä»£ç ä¸­çš„å˜é‡`tr`ï¼ˆæ ‘çŠ¶æ•°ç»„ï¼‰ã€`s`ï¼ˆå‰ç¼€å’Œçš„å‰ç¼€å’Œï¼‰å‘½åæ¸…æ™°ï¼Œé€‚åˆå¿«é€Ÿç†è§£ç®—æ³•æµç¨‹ã€‚ä½œè€…æåˆ°â€œé€†åºå¯¹æ¨¡æ¿é¢˜â€ï¼Œæé†’å­¦ä¹ è€…å·©å›ºåŸºç¡€ï¼Œå…·æœ‰å¯å‘æ€§ã€‚


## 3. æ ¸å¿ƒéš¾ç‚¹è¾¨æä¸è§£é¢˜ç­–ç•¥


### 1. **éš¾ç‚¹1ï¼šæ¨¡è¿ç®—çš„æ‹†åˆ†**  
**é—®é¢˜**ï¼šå¦‚ä½•å°†`(s[r] - s[l-1]) mod M`è½¬åŒ–ä¸ºå¯è®¡ç®—çš„å½¢å¼ï¼Ÿ  
**è§£å†³ç­–ç•¥**ï¼šæ‹†åˆ†ä¸ºä¸¤ç§æƒ…å†µï¼š  
- å½“`s[r] â‰¥ s[l-1]`æ—¶ï¼Œç»“æœä¸º`s[r] - s[l-1]`ï¼›  
- å½“`s[r] < s[l-1]`æ—¶ï¼Œç»“æœä¸º`s[r] - s[l-1] + M`ã€‚  
**å­¦ä¹ ç¬”è®°**ï¼šæ¨¡è¿ç®—çš„æ‹†åˆ†æ˜¯è§£å†³æœ¬é¢˜çš„å…³é”®ï¼Œéœ€è¦ç†è§£è´Ÿæ•°æ¨¡è¿ç®—çš„ç‰¹æ€§ã€‚


### 2. **éš¾ç‚¹2ï¼šæ— æ¨¡æ€»å’Œçš„è®¡ç®—**  
**é—®é¢˜**ï¼šå¦‚ä½•å¿«é€Ÿè®¡ç®—æ‰€æœ‰`s[r] - s[l-1]`çš„å’Œï¼Ÿ  
**è§£å†³ç­–ç•¥**ï¼šå¯¹äºæ¯ä¸ª`r`ï¼Œ`l-1`çš„èŒƒå›´æ˜¯`0`åˆ°`r-1`ï¼Œæ‰€ä»¥æ€»å’Œä¸º`r*s[r] - sum(s[0..r-1])`ã€‚ç”¨å‰ç¼€å’Œçš„å‰ç¼€å’Œ`ssum`ï¼ˆ`ssum[r] = sum(s[0..r])`ï¼‰ï¼Œå¯ä»¥`O(1)`è®¡ç®—`sum(s[0..r-1]) = ssum[r-1]`ã€‚  
**å­¦ä¹ ç¬”è®°**ï¼šå‰ç¼€å’Œçš„å‰ç¼€å’Œæ˜¯å¤„ç†â€œåŒºé—´å’Œçš„å’Œâ€é—®é¢˜çš„å¸¸ç”¨æŠ€å·§ã€‚


### 3. **éš¾ç‚¹3ï¼šé€†åºå¯¹ç»Ÿè®¡**  
**é—®é¢˜**ï¼šå¦‚ä½•å¿«é€Ÿç»Ÿè®¡` s[r] < s[l-1]`çš„æ¬¡æ•°ï¼Ÿ  
**è§£å†³ç­–ç•¥**ï¼šç”¨æ ‘çŠ¶æ•°ç»„ç»´æŠ¤`s`çš„å‡ºç°æ¬¡æ•°ã€‚å¯¹äºæ¯ä¸ª`r`ï¼ŒæŸ¥è¯¢æ ‘çŠ¶æ•°ç»„ä¸­å¤§äº`s[r]`çš„å…ƒç´ ä¸ªæ•°ï¼ˆå³é€†åºå¯¹æ•°é‡ï¼‰ï¼Œç„¶åå°†`s[r]`æ’å…¥æ ‘çŠ¶æ•°ç»„ã€‚  
**å­¦ä¹ ç¬”è®°**ï¼šæ ‘çŠ¶æ•°ç»„æ˜¯ç»Ÿè®¡é€†åºå¯¹çš„é«˜æ•ˆå·¥å…·ï¼Œæ—¶é—´å¤æ‚åº¦`O(n log M)`ã€‚


### âœ¨ è§£é¢˜æŠ€å·§æ€»ç»“  
- **å‰ç¼€å’Œè½¬åŒ–**ï¼šå°†å­æ®µå’Œè½¬åŒ–ä¸ºå‰ç¼€å’Œçš„å·®ï¼Œç®€åŒ–é—®é¢˜ï¼›  
- **æ¨¡è¿ç®—æ‹†åˆ†**ï¼šå°†æ¨¡è¿ç®—æ‹†åˆ†ä¸ºä¸¤ç§æƒ…å†µï¼Œåˆ†åˆ«å¤„ç†ï¼›  
- **æ ‘çŠ¶æ•°ç»„åº”ç”¨**ï¼šç”¨æ ‘çŠ¶æ•°ç»„ç»Ÿè®¡é€†åºå¯¹ï¼Œé«˜æ•ˆè§£å†³èŒƒå›´æŸ¥è¯¢é—®é¢˜ï¼›  
- **å‰ç¼€å’Œçš„å‰ç¼€å’Œ**ï¼šå¿«é€Ÿè®¡ç®—åŒºé—´å’Œçš„å’Œï¼Œä¼˜åŒ–æ—¶é—´å¤æ‚åº¦ã€‚


## 4. C++æ ¸å¿ƒä»£ç å®ç°èµæ


### æœ¬é¢˜é€šç”¨æ ¸å¿ƒC++å®ç°å‚è€ƒ  
* **è¯´æ˜**ï¼šç»¼åˆä¼˜è´¨é¢˜è§£æ€è·¯ï¼Œæç‚¼å‡ºçš„ç®€æ´å®ç°ï¼ŒåŒ…å«å‰ç¼€å’Œè®¡ç®—ã€æ ‘çŠ¶æ•°ç»„ç»Ÿè®¡é€†åºå¯¹ã€æœ€ç»ˆç­”æ¡ˆè®¡ç®—ã€‚  
* **å®Œæ•´æ ¸å¿ƒä»£ç **ï¼š  
  ```cpp
  #include <iostream>
  #include <vector>
  #include <algorithm>
  using namespace std;
  typedef long long ll;

  const int N = 2e5 + 10;
  ll n, m, s[N], ssum[N], tr[N];

  int lowbit(int x) { return x & -x; }
  void add(int x, ll k) { for (; x <= m; x += lowbit(x)) tr[x] += k; }
  ll query(int x) { ll res = 0; for (; x; x -= lowbit(x)) res += tr[x]; return res; }

  int main() {
      cin >> n >> m;
      for (int i = 1; i <= n; ++i) {
          ll a; cin >> a;
          s[i] = (s[i-1] + a) % m;
          ssum[i] = ssum[i-1] + s[i];
      }
      ll ans = 0, num = 0;
      add(s[0] + 1, 1); // s[0] = 0ï¼Œä¸‹æ ‡åŠ 1é¿å…0
      for (int i = 1; i <= n; ++i) {
          ans += i * s[i] - ssum[i-1]; // æ— æ¨¡æ€»å’Œ
          num += query(m) - query(s[i] + 1); // é€†åºå¯¹æ•°é‡ï¼ˆå¤§äºs[i]çš„ä¸ªæ•°ï¼‰
          add(s[i] + 1, 1);
      }
      ans += num * m;
      cout << ans << endl;
      return 0;
  }
  ```  
* **ä»£ç è§£è¯»æ¦‚è¦**ï¼š  
  1. è®¡ç®—å‰ç¼€å’Œ`s`å’Œå‰ç¼€å’Œçš„å‰ç¼€å’Œ`ssum`ï¼›  
  2. ç”¨æ ‘çŠ¶æ•°ç»„`tr`ç»´æŠ¤`s`çš„å‡ºç°æ¬¡æ•°ï¼›  
  3. éå†æ¯ä¸ª`i`ï¼Œè®¡ç®—æ— æ¨¡æ€»å’Œï¼ˆ`i*s[i] - ssum[i-1]`ï¼‰å’Œé€†åºå¯¹æ•°é‡ï¼ˆ`query(m) - query(s[i]+1)`ï¼‰ï¼›  
  4. æœ€ç»ˆç­”æ¡ˆ = æ— æ¨¡æ€»å’Œ + é€†åºå¯¹æ•°é‡*Mã€‚


### é¢˜è§£ä¸€ï¼ˆfishing_catï¼‰æ ¸å¿ƒä»£ç ç‰‡æ®µèµæ  
* **äº®ç‚¹**ï¼šç”¨æ ‘çŠ¶æ•°ç»„ç»Ÿè®¡é€†åºå¯¹ï¼Œä»£ç ç®€æ´ã€‚  
* **æ ¸å¿ƒä»£ç ç‰‡æ®µ**ï¼š  
  ```cpp
  // è®¡ç®—æ— æ¨¡æ€»å’Œ
  for (int i = 1; i <= n; ++i) ans += (2*i - n) * qzh[i].vel;
  // ç¦»æ•£åŒ–å‰ç¼€å’Œ
  sort(qzh+1, qzh+n+1, cmp);
  for (int i = 1; i <= n; ++i) rk[qzh[i].it] = i;
  // æ ‘çŠ¶æ•°ç»„ç»Ÿè®¡é€†åºå¯¹
  for (int i = 1; i <= n; ++i) {
      add(rk[i], 1);
      num += i - ask(rk[i]);
  }
  ```  
* **ä»£ç è§£è¯»**ï¼š  
  - æ— æ¨¡æ€»å’Œçš„è®¡ç®—ï¼š`(2*i - n)*qzh[i].vel`æ˜¯`i*qzh[i] - sum(qzh[0..i-1])`çš„ç®€åŒ–å½¢å¼ï¼ˆå› ä¸º`sum(qzh[0..i-1]) = ssum[i-1]`ï¼Œè€Œ`ssum[i] = ssum[i-1] + qzh[i]`ï¼Œæ‰€ä»¥`sum(qzh[0..i-1]) = (i*qzh[i] - (2*i -n)*qzh[i])/2`ï¼Ÿå…¶å®æ›´å‡†ç¡®çš„æ˜¯ï¼Œä½œè€…é€šè¿‡æ¨å¯¼å°†`sum(r*s[r] - ssum[r-1])`è½¬åŒ–ä¸º`sum((2i -n)*s[i])`ï¼Œè¿™éœ€è¦å¯¹å‰ç¼€å’Œçš„å‰ç¼€å’Œæœ‰æ·±åˆ»ç†è§£ã€‚  
  - ç¦»æ•£åŒ–ï¼šå› ä¸º`s[i]`çš„èŒƒå›´æ˜¯`0`åˆ°`M-1`ï¼Œæ‰€ä»¥ä¸éœ€è¦ç¦»æ•£åŒ–ï¼Œä½†ä½œè€…ç”¨äº†`qzh`ç»“æ„ä½“å­˜å‚¨å‰ç¼€å’Œå’Œç´¢å¼•ï¼Œå¯èƒ½æ˜¯ä¸ºäº†é€šç”¨åŒ–ã€‚  
  - é€†åºå¯¹ç»Ÿè®¡ï¼š`i - ask(rk[i])`è¡¨ç¤ºå½“å‰æ’å…¥çš„å…ƒç´ æ˜¯ç¬¬`i`ä¸ªï¼Œ`ask(rk[i])`æ˜¯å°äºç­‰äºå®ƒçš„å…ƒç´ ä¸ªæ•°ï¼Œæ‰€ä»¥é€†åºå¯¹æ•°é‡æ˜¯`i - ask(rk[i])`ã€‚  
* **å­¦ä¹ ç¬”è®°**ï¼šé€†åºå¯¹ç»Ÿè®¡çš„å¦ä¸€ç§æ–¹å¼ï¼Œé€‚åˆç¦»æ•£åŒ–åçš„æ•°ç»„ã€‚


### é¢˜è§£äºŒï¼ˆyzljyï¼‰æ ¸å¿ƒä»£ç ç‰‡æ®µèµæ  
* **äº®ç‚¹**ï¼šç”¨ä¸¤ä¸ªæ ‘çŠ¶æ•°ç»„ç»´æŠ¤å’Œä¸ä¸ªæ•°ï¼Œç›´æ¥è®¡ç®—è´¡çŒ®ã€‚  
* **æ ¸å¿ƒä»£ç ç‰‡æ®µ**ï¼š  
  ```cpp
  // æ ‘çŠ¶æ•°ç»„å®šä¹‰
  struct node {
      int a[MAXN];
      void update(int pos, int val) { ... }
      int query(int pos) { ... }
  } t, cnt;
  // è®¡ç®—è´¡çŒ®
  for (int i = 1; i <= n; ++i) {
      int z = val[i] + 1;
      ans += cnt.query(z) * z - t.query(z); // å°äºç­‰äºval[i]çš„è´¡çŒ®
      ans += (cnt.query(2e5) - cnt.query(z)) * (m + z) - (t.query(2e5) - t.query(z)); // å¤§äºval[i]çš„è´¡çŒ®
      t.update(z, z);
      cnt.update(z, 1);
  }
  ```  
* **ä»£ç è§£è¯»**ï¼š  
  - `t`ç»´æŠ¤å€¼çš„å’Œï¼Œ`cnt`ç»´æŠ¤å€¼çš„ä¸ªæ•°ï¼›  
  - å¯¹äºæ¯ä¸ª`val[i]`ï¼ˆå³`s[i]`ï¼‰ï¼Œè®¡ç®—å°äºç­‰äºå®ƒçš„è´¡çŒ®ï¼ˆ`cnt.query(z)*z - t.query(z)`ï¼‰å’Œå¤§äºå®ƒçš„è´¡çŒ®ï¼ˆ`(cnt.query(2e5)-cnt.query(z))*(m+z) - (t.query(2e5)-t.query(z))`ï¼‰ï¼›  
  - è¿™ç§æ–¹æ³•ç›´æ¥æ‹†åˆ†äº†æ¨¡è¿ç®—çš„ä¸¤ç§æƒ…å†µï¼Œä¸éœ€è¦å•ç‹¬è®¡ç®—é€†åºå¯¹ï¼Œé€‚åˆåˆå­¦è€…ç†è§£ã€‚  
* **å­¦ä¹ ç¬”è®°**ï¼šæ ‘çŠ¶æ•°ç»„çš„çµæ´»åº”ç”¨ï¼Œå¯ä»¥ç»´æŠ¤å¤šä¸ªä¿¡æ¯ï¼ˆå’Œã€ä¸ªæ•°ï¼‰ã€‚


## 5. ç®—æ³•å¯è§†åŒ–ï¼šåƒç´ åŠ¨ç”»æ¼”ç¤ºï¼ˆæ ¸å¿ƒéƒ¨åˆ†ï¼‰


### ğŸ® åŠ¨ç”»æ¼”ç¤ºä¸»é¢˜ï¼šã€Šåƒç´ å‰ç¼€å’Œå†’é™©ã€‹  
**é£æ ¼**ï¼š8ä½FCçº¢ç™½æœºé£æ ¼ï¼Œç”¨åƒç´ å—è¡¨ç¤ºå‰ç¼€å’Œï¼Œæ ‘çŠ¶æ•°ç»„ç”¨èŠ‚ç‚¹çŸ©é˜µè¡¨ç¤ºï¼ŒèƒŒæ™¯æ˜¯å¤å¤æ¸¸æˆåœºæ™¯ï¼ˆæ¯”å¦‚åŸå ¡ï¼‰ã€‚


### ğŸš€ æ ¸å¿ƒæ¼”ç¤ºå†…å®¹  
1. **å‰ç¼€å’Œè®¡ç®—**ï¼š  
   - å±å¹•å·¦ä¾§æ˜¾ç¤ºæ•°ç»„`A`çš„åƒç´ å—ï¼ˆæ¯ä¸ªå…ƒç´ æ˜¯ä¸€ä¸ªå½©è‰²æ–¹å—ï¼‰ï¼›  
   - å³ä¾§æ˜¾ç¤ºå‰ç¼€å’Œ`s`çš„è¿›åº¦æ¡ï¼Œæ¯æ·»åŠ ä¸€ä¸ªå…ƒç´ ï¼Œè¿›åº¦æ¡å¢é•¿ï¼Œä¼´éšâ€œæ»´â€çš„éŸ³æ•ˆã€‚  
2. **æ ‘çŠ¶æ•°ç»„æ›´æ–°**ï¼š  
   - å±å¹•ä¸‹æ–¹æ˜¾ç¤ºæ ‘çŠ¶æ•°ç»„çš„èŠ‚ç‚¹çŸ©é˜µï¼ˆæ¯ä¸ªèŠ‚ç‚¹æ˜¯ä¸€ä¸ªå°æ–¹å—ï¼‰ï¼›  
   - å½“æ’å…¥`s[i]`æ—¶ï¼Œå¯¹åº”çš„èŠ‚ç‚¹é—ªçƒï¼ˆæ¯”å¦‚å˜æˆé»„è‰²ï¼‰ï¼Œä¼´éšâ€œå®â€çš„éŸ³æ•ˆã€‚  
3. **é€†åºå¯¹ç»Ÿè®¡**ï¼š  
   - å½“å¤„ç†åˆ°`s[i]`æ—¶ï¼Œæ ‘çŠ¶æ•°ç»„ä¸­å¤§äº`s[i]`çš„èŠ‚ç‚¹ä¼šå˜æˆçº¢è‰²ï¼Œæç¤ºâ€œè¿™äº›éœ€è¦è¡¥`M`â€ï¼›  
   - é€†åºå¯¹æ•°é‡æ˜¾ç¤ºåœ¨å±å¹•å³ä¸Šè§’ï¼Œæ¯ç»Ÿè®¡ä¸€ä¸ªé€†åºå¯¹ï¼Œæ•°é‡åŠ 1ï¼Œä¼´éšâ€œå•ªâ€çš„éŸ³æ•ˆã€‚  
4. **æœ€ç»ˆç­”æ¡ˆè®¡ç®—**ï¼š  
   - å½“æ‰€æœ‰å…ƒç´ å¤„ç†å®Œæ¯•ï¼Œå±å¹•æ˜¾ç¤ºæœ€ç»ˆç­”æ¡ˆï¼ˆç”¨å¤§åƒç´ å­—è¡¨ç¤ºï¼‰ï¼Œä¼´éšâ€œèƒœåˆ©â€éŸ³æ•ˆï¼ˆæ¯”å¦‚ã€Šè¶…çº§é©¬é‡Œå¥¥ã€‹çš„é€šå…³éŸ³ä¹ï¼‰ã€‚


### ğŸ¯ äº¤äº’è®¾è®¡  
- **æ­¥è¿›æ§åˆ¶**ï¼šç”¨æˆ·å¯ä»¥ç‚¹å‡»â€œä¸‹ä¸€æ­¥â€æŒ‰é’®ï¼Œé€æ­¥æŸ¥çœ‹å‰ç¼€å’Œè®¡ç®—ã€æ ‘çŠ¶æ•°ç»„æ›´æ–°ã€é€†åºå¯¹ç»Ÿè®¡çš„è¿‡ç¨‹ï¼›  
- **è‡ªåŠ¨æ’­æ”¾**ï¼šç”¨æˆ·å¯ä»¥è°ƒæ•´æ’­æ”¾é€Ÿåº¦ï¼ˆæ¯”å¦‚1xã€2xã€4xï¼‰ï¼Œè‡ªåŠ¨æ¼”ç¤ºæ•´ä¸ªæµç¨‹ï¼›  
- **é‡ç½®**ï¼šç‚¹å‡»â€œé‡ç½®â€æŒ‰é’®ï¼Œå›åˆ°åˆå§‹çŠ¶æ€ï¼Œé‡æ–°æ¼”ç¤ºã€‚


### ğŸ“ è®¾è®¡ç†ç”±  
- 8ä½åƒç´ é£æ ¼ï¼šè¥é€ å¤å¤æ¸¸æˆæ°›å›´ï¼Œé™ä½å­¦ä¹ å‹åŠ›ï¼›  
- éŸ³æ•ˆæç¤ºï¼šå¼ºåŒ–å…³é”®æ“ä½œçš„è®°å¿†ï¼ˆæ¯”å¦‚â€œå®â€è¡¨ç¤ºæ ‘çŠ¶æ•°ç»„æ›´æ–°ï¼Œâ€œå•ªâ€è¡¨ç¤ºé€†åºå¯¹ç»Ÿè®¡ï¼‰ï¼›  
- å¯è§†åŒ–å…ƒç´ ï¼šç”¨ä¸åŒé¢œè‰²æ ‡è®°ä¸åŒçŠ¶æ€ï¼ˆæ¯”å¦‚çº¢è‰²è¡¨ç¤ºé€†åºå¯¹ï¼Œé»„è‰²è¡¨ç¤ºæ ‘çŠ¶æ•°ç»„èŠ‚ç‚¹ï¼‰ï¼Œå¸®åŠ©ç†è§£ç®—æ³•æµç¨‹ã€‚


## 6. æ‹“å±•ç»ƒä¹ ä¸ç›¸ä¼¼é—®é¢˜æ€è€ƒ


### ğŸ§  é€šç”¨æ€è·¯è¿ç§»  
- **å‰ç¼€å’Œè½¬åŒ–**ï¼šé€‚ç”¨äºæ‰€æœ‰å­æ®µå’Œé—®é¢˜ï¼ˆå¦‚å­æ®µå’Œçš„æœ€å¤§å€¼ã€å­æ®µå’Œçš„ä¸ªæ•°ï¼‰ï¼›  
- **æ¨¡è¿ç®—æ‹†åˆ†**ï¼šé€‚ç”¨äºæ¨¡è¿ç®—ä¸‹çš„æ±‚å’Œé—®é¢˜ï¼ˆå¦‚å­æ®µå’Œæ¨¡`M`ç­‰äº`K`çš„ä¸ªæ•°ï¼‰ï¼›  
- **æ ‘çŠ¶æ•°ç»„ç»Ÿè®¡é€†åºå¯¹**ï¼šé€‚ç”¨äºæ‰€æœ‰éœ€è¦ç»Ÿè®¡é€†åºå¯¹çš„é—®é¢˜ï¼ˆå¦‚æ’åºé—®é¢˜ã€äºŒç»´ååºé—®é¢˜ï¼‰ã€‚


### ğŸ“š ç»ƒä¹ æ¨èï¼ˆæ´›è°·ï¼‰  
1. **æ´›è°· P1908** - é€†åºå¯¹  
   ğŸ—£ï¸ **æ¨èç†ç”±**ï¼šé€†åºå¯¹æ¨¡æ¿é¢˜ï¼Œå·©å›ºæ ‘çŠ¶æ•°ç»„ç»Ÿè®¡é€†åºå¯¹çš„æ–¹æ³•ã€‚  
2. **æ´›è°· P3368** - æ ‘çŠ¶æ•°ç»„ 2  
   ğŸ—£ï¸ **æ¨èç†ç”±**ï¼šæ ‘çŠ¶æ•°ç»„åŒºé—´æ›´æ–°ã€å•ç‚¹æŸ¥è¯¢çš„æ¨¡æ¿é¢˜ï¼Œå·©å›ºæ ‘çŠ¶æ•°ç»„çš„åŸºæœ¬æ“ä½œã€‚  
3. **æ´›è°· P2084** - è¿›åˆ¶è½¬æ¢  
   ğŸ—£ï¸ **æ¨èç†ç”±**ï¼šæ¨¡è¿ç®—çš„åº”ç”¨ï¼Œå·©å›ºæ¨¡è¿ç®—çš„æ‹†åˆ†é€»è¾‘ã€‚  
4. **æ´›è°· P1198** - æœ€å¤§å­æ®µå’Œ  
   ğŸ—£ï¸ **æ¨èç†ç”±**ï¼šå‰ç¼€å’Œè½¬åŒ–çš„ç»å…¸é—®é¢˜ï¼Œå·©å›ºå‰ç¼€å’Œçš„ä½¿ç”¨ã€‚


## 7. å­¦ä¹ å¿ƒå¾—ä¸ç»éªŒåˆ†äº«ï¼ˆè‹¥æœ‰ï¼‰


### ğŸ“ å‚è€ƒç»éªŒï¼ˆæ¥è‡ªMLE_Automatonï¼‰  
> â€œæˆ‘åœ¨è§£å†³è¿™ä¸ªé—®é¢˜æ—¶ï¼Œæœ€åˆåœ¨å¤„ç†æ¨¡è¿ç®—çš„è´Ÿæ•°é—®é¢˜æ—¶å¡äº†å¾ˆä¹…ï¼Œåæ¥é€šè¿‡æ‹†åˆ†æ¨¡è¿ç®—ä¸ºä¸¤ç§æƒ…å†µï¼Œæ‰æ‰¾åˆ°è§£å†³æ–¹æ³•ã€‚è¿™è®©æˆ‘æ„è¯†åˆ°ï¼Œæ¨¡è¿ç®—çš„æ‹†åˆ†æ˜¯è§£å†³è¿™ç±»é—®é¢˜çš„å…³é”®ã€‚â€  

**ç‚¹è¯„**ï¼šè¿™ä½ä½œè€…çš„ç»éªŒå¾ˆå…¸å‹ã€‚åœ¨å¤„ç†æ¨¡è¿ç®—æ—¶ï¼Œè´Ÿæ•°é—®é¢˜æ˜¯å¸¸è§çš„å‘ç‚¹ï¼Œæ‹†åˆ†æ¨¡è¿ç®—ä¸ºä¸¤ç§æƒ…å†µï¼ˆå¤§äºç­‰äºå’Œå°äºï¼‰æ˜¯æœ‰æ•ˆçš„è§£å†³æ–¹æ³•ã€‚æ­¤å¤–ï¼Œä½œè€…æåˆ°â€œé€†åºå¯¹æ¨¡æ¿é¢˜â€ï¼Œæé†’å­¦ä¹ è€…å·©å›ºåŸºç¡€ï¼Œè¿™ä¹Ÿæ˜¯éå¸¸é‡è¦çš„ã€‚


## ğŸ‰ ç»“è¯­  
æœ¬æ¬¡å…³äºâ€œMod Sigma Problemâ€çš„C++è§£é¢˜åˆ†æå°±åˆ°è¿™é‡Œã€‚å¸Œæœ›è¿™ä»½å­¦ä¹ æŒ‡å—èƒ½å¸®åŠ©å¤§å®¶ç†è§£å‰ç¼€å’Œè½¬åŒ–ã€æ¨¡è¿ç®—æ‹†åˆ†ã€æ ‘çŠ¶æ•°ç»„ç»Ÿè®¡é€†åºå¯¹çš„æ ¸å¿ƒæ€æƒ³ã€‚è®°ä½ï¼Œç¼–ç¨‹èƒ½åŠ›çš„æå‡åœ¨äºæŒç»­å­¦ä¹ ã€å‹¤äºæ€è€ƒå’Œå‹‡äºå®è·µã€‚ä¸‹æ¬¡æˆ‘ä»¬å†ä¸€èµ·æ¢ç´¢æ–°çš„ç¼–ç¨‹æŒ‘æˆ˜ï¼ğŸ’ª

---
å¤„ç†ç”¨æ—¶ï¼š199.00ç§’
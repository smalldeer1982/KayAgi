# 题目信息

# [ARC174B] Bought Review

## 题目描述

[problemUrl]: https://atcoder.jp/contests/arc174/tasks/arc174_b

$ T $ 個のテストケースについて、次の問題に答えてください。

グルメレビューサイトである EatCocoder では、レストランに $ 1 $ 以上 $ 5 $ 以下の整数個の星を付けてレビューすることができます。  
 最初、B料理長の経営するレストランには、星 $ i $ のレビューが $ A_i $ 件付いています。 $ (1\ \le\ i\ \le\ 5) $  
 B料理長は EatCocoder の運営に $ P_i $ 円の賄賂を渡すことで、星 $ i $ のレビューを $ 1 $ 件追加してもらえます。 $ (1\ \le\ i\ \le\ 5) $

賄賂によってレビューを全部で $ k $ 件追加したとき、最終的なレビューは合計で $ A_1+A_2+A_3+A_4+A_5+k $ 件になります。  
 B料理長はこれらのレビューの平均評価を星 $ 3 $ 以上にしたいと考えています。これを達成するために必要な賄賂の合計金額の最小値を求めてください。

## 说明/提示

### 制約

- 入力は全て整数
- $ 1\ \le\ T\ \le\ 10^4 $
- $ 0\ \le\ A_i\ \le\ 10^8 $
- $ 1\ \le\ A_1+A_2+A_3+A_4+A_5 $
- $ 1\ \le\ P_i\ \le\ 10^8 $
 
### Sample Explanation 1

この入力には $ 6 $ 個のテストケースが含まれています。 - $ 1 $ 個目のテストケースについて、例えば以下のようにすると $ 5 $ 円の賄賂で平均評価を星 $ 3 $ 以上にでき、これが達成可能な最小値です。 - 元々星 $ 1,2,3,4,5 $ のレビューが $ 1,0,1,0,0 $ 件付いています。 - $ P_5\ =\ 5 $ 円の賄賂を渡し、星 $ 5 $ のレビューを $ 1 $ 件追加させます。 - その結果、星 $ 1,2,3,4,5 $ のレビューが $ 1,0,1,0,1 $ 件となり、これらの平均は星 $ 3 $ です。 - $ 2 $ 個目のテストケースについて、例えば以下のようにすると $ 2 $ 円の賄賂で平均評価を星 $ 3 $ 以上にでき、これが達成可能な最小値です。 - 元々星 $ 1,2,3,4,5 $ のレビューが $ 0,2,2,0,0 $ 件付いています。 - $ P_4\ \times\ 2\ =\ 2 $ 円の賄賂を渡し、星 $ 4 $ のレビューを $ 2 $ 件追加させます。 - その結果、星 $ 1,2,3,4,5 $ のレビューが $ 0,2,2,2,0 $ 件となり、これらの平均は星 $ 3 $ です。 - $ 3 $ 個目のテストケースについて、例えば以下のようにすると $ 3 $ 円の賄賂で平均評価を星 $ 3 $ 以上にでき、これが達成可能な最小値です。 - 元々星 $ 1,2,3,4,5 $ のレビューが $ 0,1,2,0,0 $ 件付いています。 - $ P_5\ =\ 3 $ 円の賄賂を渡し、星 $ 5 $ のレビューを $ 1 $ 件追加させます。 - その結果、星 $ 1,2,3,4,5 $ のレビューが $ 0,1,2,0,1 $ 件となり、これらの平均は星 $ 3.25 $ です。 - $ 4 $ 個目のテストケースについて、例えば以下のようにすると $ 2 $ 円の賄賂で平均評価を星 $ 3 $ 以上にでき、これが達成可能な最小値です。 - 元々星 $ 1,2,3,4,5 $ のレビューが $ 1,1,1,0,0 $ 件付いています。 - $ P_4\ =\ 1 $ 円の賄賂を渡し、星 $ 4 $ のレビューを $ 1 $ 件追加させます。 - $ P_5\ =\ 1 $ 円の賄賂を渡し、星 $ 5 $ のレビューを $ 1 $ 件追加させます。 - その結果、星 $ 1,2,3,4,5 $ のレビューが $ 1,1,1,1,1 $ 件となり、これらの平均は星 $ 3 $ です。 - $ 5 $ 個目のテストケースについて、例えば以下のようにすると $ 0 $ 円の賄賂で平均評価を星 $ 3 $ 以上にでき、これが達成可能な最小値です。 - 元々星 $ 1,2,3,4,5 $ のレビューが $ 0,0,0,0,1 $ 件付いています。 - これらの平均は星 $ 5 $ でありこれは既に $ 3 $ 以上であるため、賄賂を全く渡しません。 - $ 6 $ 個目のテストケースについて、答えが $ 32 $bit 符号付き整数に収まらないこともあります。

## 样例 #1

### 输入

```
6

1 0 1 0 0

1 2 3 4 5

0 2 2 0 0

1 1 1 1 5

0 1 2 0 0

1 1 1 5 3

1 1 1 0 0

1 1 1 1 1

0 0 0 0 1

1 1 1 1 1

100000000 100000000 100000000 0 0

100000000 100000000 100000000 100000000 100000000```

### 输出

```
5

2

3

2

0

15000000000000000```

# AI分析结果

# 💡 Kay的C++算法解析：[ARC174B] Bought Review 深入学习指南 💡


## 1. 题目解读与核心算法识别

✨ **本题主要考察**：贪心算法（Greedy Algorithm）

🗣️ **初步分析**：  
解决“Bought Review”问题的关键，就像“用最少的钱买最多的‘星’”——我们需要**优先选择性价比最高的方式**来弥补当前评分与3星平均的差距。简单来说，贪心算法就是“每一步都选当前最好的选项”，最终得到全局最优解。  

在本题中，贪心的核心逻辑是：  
- **不买1、2、3星**：因为这些评分会拉低或不改变平均，完全是浪费钱（就像买糖不买甜的，买苦的一样傻~）。  
- **只买4、5星**：4星每个比3星多1分，5星每个比3星多2分。我们需要用这两个“加分项”来填补差距。  

### 核心算法流程与可视化设计思路  
1. **计算差距**：先算当前评分离3星平均还差多少分（比如，当前总星数是`sum`，总评论数是`cnt`，则差距为`3*cnt - sum`，记为`need`）。  
2. **贪心选择**：  
   - 如果`2*P4 ≤ P5`（两个4星的成本≤一个5星），则全买4星（性价比更高）。  
   - 否则，优先买5星（因为每个5星能补2分，更“高效”），如果`need`是奇数，再比较“多买一个5星”还是“买一个4星+剩下的5星”哪个更便宜。  

**可视化设计思路**：  
用8位像素风格模拟“商店买星”的过程：  
- 屏幕左侧显示当前的“星池”（比如，用不同颜色的像素块代表1-5星的数量），右侧显示“需要的分数”（`need`）和“当前花费”。  
- 当点击“买4星”或“买5星”时，对应的像素块会增加，`need`减少，花费增加，并伴随“叮~”的像素音效。  
- 当`need`≤0时，播放“胜利”音效（比如FC游戏的通关音乐），并显示“成功！最小花费：XX”。  


## 2. 精选优质题解参考

### 题解一：（来源：bishenke_2008，赞：4）  
* **点评**：这份题解的思路**超级清晰**！作者详细推导了不等式（从平均≥3到`x+2y≥least`），把问题转化为“用最少的钱买足够的‘加分’”。代码风格也很规范，变量名（如`least`表示需要的加分，`ans`表示最小花费）一看就懂。特别是贪心的条件判断（比如`2*p[4]≤p[5]`时全买4星），逻辑非常严谨，能让你一下子明白“为什么要选这个选项”。从实践角度看，代码可以直接用于竞赛，边界处理（比如`least≤0`时输出0）也很到位，是一份非常值得学习的题解。  

### 题解二：（来源：whrwlx，赞：3）  
* **点评**：这份题解的亮点是**把问题简化为“补星”**。作者用`cnt*3 - sum`计算需要的加分，然后直接比较“全买4星”“全买5星”“买1个4星+剩下的5星”三种情况的成本，取最小值。代码非常简洁，适合快速理解核心逻辑。特别是`ans=min(ans, ...)`的写法，把所有可能的情况都覆盖了，很值得借鉴。  

### 题解三：（来源：Double_Light，赞：1）  
* **点评**：这份题解的“基准转换”思路很巧妙——把1星看作“少2分”，2星“少1分”，4星“多1分”，5星“多2分”，从而把问题转化为“用多的分补少的分”。这种转换能让你更直观地理解“为什么需要买4、5星”。代码中的分类讨论（奇数情况的处理）也很全面，能帮你避免遗漏边界条件。  


## 3. 核心难点辨析与解题策略

### 1. **关键点1：为什么不买1-3星？**  
* **分析**：假设当前平均是2.5星，买一个1星评论，平均会变成（总星数+1）/（总评论数+1），比原来的2.5更小；买3星的话，平均不变。所以买1-3星完全是浪费钱，**只有4、5星能提高平均**。  
* 💡 **学习笔记**：解决问题前，先排除“无效选项”，能大大简化思考。  

### 2. **关键点2：如何计算需要的加分？**  
* **分析**：平均≥3的条件可以转化为：总星数≥3×总评论数。设当前总星数为`sum`，总评论数为`cnt`，则需要的加分是`3*cnt - sum`（记为`need`）。如果`need≤0`，说明已经满足条件，不需要花钱。  
* 💡 **学习笔记**：把“平均”问题转化为“总星数”问题，能避免浮点数精度问题（比如用整数计算更准确）。  

### 3. **关键点3：贪心策略的正确性**  
* **分析**：4星每个补1分，成本`P4`；5星每个补2分，成本`P5`。我们需要比较“补2分的成本”：如果`2*P4 ≤ P5`，则补两个4星比补一个5星更便宜，所以全买4星；否则，优先补5星（因为每个5星补2分，更高效）。如果`need`是奇数，再比较“多补一个5星”（补2分，成本`P5`）和“补一个4星+剩下的5星”（补1分+补`need-1`分，成本`P4 + (need-1)/2*P5`）哪个更便宜。  
* 💡 **学习笔记**：贪心的关键是“找到性价比最高的单位”（比如，这里的“单位”是“补1分的成本”）。  

### ✨ 解题技巧总结  
- **排除无效选项**：先想“哪些操作是没用的”，比如买1-3星，这样能缩小思考范围。  
- **转化问题**：把“平均”转化为“总星数”，用整数计算，避免精度问题。  
- **贪心选择**：比较“单位成本”（比如补1分的成本），选择性价比最高的选项。  


## 4. C++核心代码实现赏析

### 本题通用核心C++实现参考  
* **说明**：本代码综合了多个优质题解的思路，是一份清晰、完整的核心实现。  
* **完整核心代码**：  
  ```cpp
  #include <iostream>
  #include <algorithm>
  using namespace std;
  typedef long long ll;

  int main() {
      ios::sync_with_stdio(false);
      cin.tie(nullptr);
      int T;
      cin >> T;
      while (T--) {
          ll a[6], p[6];
          ll sum = 0, cnt = 0;
          for (int i = 1; i <= 5; ++i) {
              cin >> a[i];
              sum += i * a[i]; // 总星数
              cnt += a[i];     // 总评论数
          }
          for (int i = 1; i <= 5; ++i) {
              cin >> p[i];
          }
          ll need = 3 * cnt - sum; // 需要的加分
          if (need <= 0) {
              cout << 0 << '\n';
              continue;
          }
          ll ans = need * p[4]; // 全买4星
          if (need % 2 == 0) {
              ans = min(ans, need / 2 * p[5]); // 全买5星（偶数）
          } else {
              ans = min(ans, (need / 2 + 1) * p[5]); // 全买5星（奇数，多买一个）
              ans = min(ans, need / 2 * p[5] + p[4]); // 买一个4星+剩下的5星
          }
          cout << ans << '\n';
      }
      return 0;
  }
  ```
* **代码解读概要**：  
  1. **输入处理**：读取测试用例数`T`，然后读取每组的`A[i]`（各星数的评论数）和`P[i]`（各星数的成本）。  
  2. **计算总星数和总评论数**：`sum`是当前总星数，`cnt`是当前总评论数。  
  3. **计算需要的加分**：`need = 3*cnt - sum`，如果`need≤0`，直接输出0。  
  4. **贪心选择**：计算三种情况的成本（全买4星、全买5星、混合买），取最小值。  


### 针对各优质题解的片段赏析  

#### 题解一（来源：bishenke_2008）  
* **亮点**：详细推导了不等式，把问题转化为“用最少的钱买足够的‘加分’”。  
* **核心代码片段**：  
  ```cpp
  ll least = 2*a[1] + a[2] - a[4] - 2*a[5]; // 需要的加分（等价于3*cnt - sum）
  if (least <= 0) {
      cout << 0 << '\n';
      continue;
  }
  ll ans;
  if (p[4]*2 <= p[5]) {
      ans = least * p[4]; // 全买4星
  } else if (least % 2 == 0) {
      ans = least / 2 * p[5]; // 全买5星（偶数）
  } else {
      ans = min((least/2 + 1)*p[5], least/2*p[5] + p[4]); // 混合买
  }
  ```
* **代码解读**：  
  - `least`的计算是`2*a[1] + a[2] - a[4] - 2*a[5]`，这其实等价于`3*(a1+a2+a3+a4+a5) - (a1+2a2+3a3+4a4+5a5)`（因为`3*(a1+a2+a3+a4+a5) = 3a1+3a2+3a3+3a4+3a5`，减去总星数`a1+2a2+3a3+4a4+5a5`，得到`2a1+a2-0a3-1a4-2a5`，也就是`2a1+a2 -a4-2a5`）。  
  - 条件判断`p[4]*2 <= p[5]`：如果两个4星的成本≤一个5星，那么全买4星更便宜。  
* 💡 **学习笔记**：不等式的推导能帮你更深入理解问题的本质，而不仅仅是记住结论。  

#### 题解二（来源：whrwlx）  
* **亮点**：用`cnt*3 - sum`直接计算需要的加分，代码简洁。  
* **核心代码片段**：  
  ```cpp
  ll need = 3*cnt - sum;
  if (need <= 0) {
      cout << 0 << '\n';
      continue;
  }
  ll ans = 1e18;
  ans = min(ans, need * p[4]); // 全买4星
  if (need % 2 == 0) {
      ans = min(ans, need / 2 * p[5]); // 全买5星（偶数）
  } else {
      ans = min(ans, (need/2 + 1)*p[5]); // 全买5星（奇数）
      ans = min(ans, need/2 * p[5] + p[4]); // 混合买
  }
  ```
* **代码解读**：  
  - `ans`初始化为`1e18`（一个很大的数），然后用`min`函数不断更新最小值。这种写法能覆盖所有可能的情况，非常直观。  
* 💡 **学习笔记**：用`min`函数处理多个情况的最小值，代码会更简洁。  


## 5. 算法可视化：像素动画演示 (核心部分)

### 动画演示主题  
**“星币商店”：用最少的钱买够星星**（仿FC游戏《超级马里奥兄弟》的像素风格）。  

### 核心演示内容  
1. **初始场景**：  
   - 屏幕左侧是“星池”：用不同颜色的像素块代表1-5星的数量（比如，1星是红色，2星是橙色，3星是黄色，4星是绿色，5星是蓝色）。  
   - 屏幕右侧是“信息面板”：显示“需要的星星：XX”（`need`）、“当前花费：XX”（`cost`）。  
   - 屏幕下方是“操作按钮”：“买4星”（绿色按钮）、“买5星”（蓝色按钮）、“重置”（红色按钮）。  

2. **操作流程**：  
   - 当点击“买4星”时：  
     - 绿色像素块（4星）增加1个。  
     - “需要的星星”减少1（`need--`）。  
     - “当前花费”增加`P4`（`cost += P4`）。  
     - 播放“叮~”的像素音效（类似《马里奥》吃金币的声音）。  
   - 当点击“买5星”时：  
     - 蓝色像素块（5星）增加1个。  
     - “需要的星星”减少2（`need -= 2`，如果`need`是奇数，则减少1？不，等一下，`need`是需要的加分，5星每个补2分，所以`need`减少2）。  
     - “当前花费”增加`P5`（`cost += P5`）。  
     - 播放“叮~”的像素音效。  

3. **目标达成**：  
   - 当`need ≤ 0`时，屏幕中央显示“胜利！”（用黄色像素块组成），并播放《马里奥》通关的音乐（8位风格）。  
   - 信息面板显示“最小花费：XX”（`cost`）。  

### 游戏化元素设计  
- **AI自动演示**：点击“自动”按钮，AI会根据贪心策略自动购买4或5星，直到满足条件。比如，如果`2*P4 ≤ P5`，AI会全买4星；否则，优先买5星，奇数情况再买一个4星。  
- **音效反馈**：买4星时播放“叮~”（高音），买5星时播放“咚~”（低音），胜利时播放“啦啦啦~”（欢快的旋律）。  
- **积分系统**：每买一个星星，获得10分；满足条件时，根据花费多少获得额外积分（比如，花费越少，积分越多）。  

### 技术实现考量  
- **轻量化**：用纯HTML/CSS/JavaScript实现，Canvas绘制像素块。  
- **交互性**：用`addEventListener`处理按钮点击事件，实时更新Canvas内容。  
- **音效**：用`Audio`对象播放预先制作的8位音效文件（比如，`ding.wav`、`dong.wav`、`win.wav`）。  


## 6. 拓展练习与相似问题思考

### 通用思路/技巧迁移  
贪心算法的核心是“每一步选当前最好的选项”，常用于**优化问题**（比如求最小成本、最大收益）。本题的思路可以迁移到以下场景：  
- **合并果子**（求合并果子的最小成本，优先合并最小的两堆）。  
- **皇后游戏**（求皇后的最小等待时间，排序策略）。  
- **小A的糖果**（求给糖果的最小次数，优先给需要最多的孩子）。  

### 练习推荐 (洛谷)  
1. **洛谷 P1090** - 合并果子  
   🗣️ **推荐理由**：这道题是贪心算法的经典问题，需要优先合并最小的两堆果子，和本题的“优先选性价比最高的星星”思路一致。  
2. **洛谷 P2123** - 皇后游戏  
   🗣️ **推荐理由**：这道题需要排序皇后的顺序，使得总等待时间最小，需要用到贪心的排序策略，能帮你巩固“比较单位成本”的思路。  
3. **洛谷 P3817** - 小A的糖果  
   🗣️ **推荐理由**：这道题需要给孩子分糖果，使得每个孩子的糖果数不低于要求，求最小次数，和本题的“补星星”思路类似。  


## 7. 学习心得与经验分享 (若有)  
**参考经验 (来自 bishenke_2008)**：“我在解决这个问题时，最初没有想到要化简不等式，直接计算平均，结果因为浮点数精度问题WA了。后来通过化简不等式，用整数计算，才解决了问题。”  
**点评**：这位作者的经验很典型。在处理“平均”问题时，用整数计算（比如总星数≥3×总评论数）比用浮点数（比如平均≥3）更准确，能避免精度问题。  


## 结语  
本次关于“[ARC174B] Bought Review”的C++解题分析就到这里。希望这份学习指南能帮助你理解贪心算法的核心思路，掌握“排除无效选项”“转化问题”“贪心选择”的技巧。记住，编程的乐趣在于“用简单的方法解决复杂的问题”，下次我们再一起探索新的挑战！💪

---
处理用时：146.34秒
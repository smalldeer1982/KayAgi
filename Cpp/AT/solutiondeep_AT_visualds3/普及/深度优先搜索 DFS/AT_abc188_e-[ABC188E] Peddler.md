# é¢˜ç›®ä¿¡æ¯

# [ABC188E] Peddler

## é¢˜ç›®æè¿°

[problemUrl]: https://atcoder.jp/contests/abc188/tasks/abc188_e

é«˜æ©‹å›½ã«ã¯ã€ç”º $ 1 $ ã‹ã‚‰ç”º $ N $ ã¾ã§ã® $ N $ å€‹ã®ç”ºãŒã‚ã‚Šã¾ã™ã€‚  
 ã¾ãŸã€ã“ã®å›½ã«ã¯é“ $ 1 $ ã‹ã‚‰é“ $ M $ ã¾ã§ã® $ M $ æœ¬ã®é“ãŒã‚ã‚Šã¾ã™ã€‚é“ $ i $ ã‚’ä½¿ã†ã¨ã€ç”º $ X_i $ ã‹ã‚‰ç”º $ Y_i $ ã¸ç§»å‹•ã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚é€†å‘ãã¸ã¯ç§»å‹•ã§ãã¾ã›ã‚“ã€‚ã“ã“ã§ $ X_i\ <\ Y_i $ ã§ã‚ã‚‹ã“ã¨ãŒä¿è¨¼ã•ã‚Œã¾ã™ã€‚  
 ã“ã®å›½ã§ã¯é‡‘ã®å–å¼•ãŒç››ã‚“ã§ã‚ã‚Šã€ç”º $ i $ ã§ã¯ã€é‡‘ $ 1\,\mathrm{kg} $ ã‚’ $ A_i $ å††ã§å£²ã£ãŸã‚Šè²·ã£ãŸã‚Šã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚

æ—…å•†äººã§ã‚ã‚‹é«˜æ©‹å›ã¯ã€é«˜æ©‹å›½å†…ã®ã‚ã‚‹ç”ºã§é‡‘ã‚’ $ 1\,\mathrm{kg} $ ã ã‘è²·ã„ã€ã„ãã¤ã‹ã®é“ã‚’ä½¿ã£ãŸå¾Œã€**è²·ã£ãŸç”ºã¨ã¯åˆ¥ã®ç”ºã§**é‡‘ã‚’ $ 1\,\mathrm{kg} $ ã ã‘å£²ã‚ã†ã¨è€ƒãˆã¦ã„ã¾ã™ã€‚  
 ã“ã®ã¨ãã€é«˜æ©‹å›ã®åˆ©ç›Š (ã™ãªã‚ã¡ $ ( $é‡‘ã‚’å£²ã£ãŸä¾¡æ ¼$ )\ -\ ( $é‡‘ã‚’è²·ã£ãŸä¾¡æ ¼$ ) $) ã¨ã—ã¦è€ƒãˆã‚‰ã‚Œã‚‹æœ€å¤§å€¤ã‚’æ±‚ã‚ã¦ãã ã•ã„ã€‚

## è¯´æ˜/æç¤º

### åˆ¶ç´„

- $ 2\ \le\ N\ \le\ 2\ \times\ 10^5 $
- $ 1\ \le\ M\ \le\ 2\ \times\ 10^5 $
- $ 1\ \le\ A_i\ \le\ 10^9 $
- $ 1\ \le\ X_i\ \lt\ Y_i\ \le\ N $
- $ (X_i,\ Y_i)\ \neq\ (X_j,\ Y_j)\ (i\ \neq\ j) $
- å…¥åŠ›ã«å«ã¾ã‚Œã‚‹å€¤ã¯å…¨ã¦æ•´æ•°

### Sample Explanation 1

ä»¥ä¸‹ã®ã‚ˆã†ã«ã—ã¦åˆ©ç›Š $ 3 $ å††ã‚’é”æˆã§ãã¾ã™ã€‚ - ç”º $ 1 $ ã§ $ 2 $ å††ã§é‡‘ $ 1\,\mathrm{kg} $ ã‚’è²·ã† - é“ $ 2 $ ã‚’ä½¿ã£ã¦ç”º $ 2 $ ã«ç§»å‹•ã™ã‚‹ - é“ $ 1 $ ã‚’ä½¿ã£ã¦ç”º $ 4 $ ã«ç§»å‹•ã™ã‚‹ - ç”º $ 4 $ ã§ $ 5 $ å††ã§é‡‘ $ 1\,\mathrm{kg} $ ã‚’å£²ã‚‹

### Sample Explanation 2

ä»¥ä¸‹ã®ã‚ˆã†ã«ã—ã¦åˆ©ç›Š $ 10 $ å††ã‚’é”æˆã§ãã¾ã™ã€‚ - ç”º $ 2 $ ã§ $ 8 $ å††ã§é‡‘ $ 1\,\mathrm{kg} $ ã‚’è²·ã† - é“ $ 1 $ ã‚’ä½¿ã£ã¦ç”º $ 4 $ ã«ç§»å‹•ã™ã‚‹ - é“ $ 3 $ ã‚’ä½¿ã£ã¦ç”º $ 5 $ ã«ç§»å‹•ã™ã‚‹ - ç”º $ 5 $ ã§ $ 18 $ å††ã§é‡‘ $ 1\,\mathrm{kg} $ ã‚’å£²ã‚‹

### Sample Explanation 3

é‡‘ã‚’è²·ã£ãŸç”ºã§å£²ã‚‹ã“ã¨ã¯ã§ããªã„ãŸã‚ã€ç­”ãˆãŒè² ã«ãªã‚‹å¯èƒ½æ€§ãŒã‚ã‚‹ã“ã¨ã«æ³¨æ„ã—ã¦ãã ã•ã„ã€‚

## æ ·ä¾‹ #1

### è¾“å…¥

```
4 3

2 3 1 5

2 4

1 2

1 3```

### è¾“å‡º

```
3```

## æ ·ä¾‹ #2

### è¾“å…¥

```
5 5

13 8 3 15 18

2 4

1 2

4 5

2 3

1 3```

### è¾“å‡º

```
10```

## æ ·ä¾‹ #3

### è¾“å…¥

```
3 1

1 100 1

2 3```

### è¾“å‡º

```
-99```

# AIåˆ†æç»“æœ

# ğŸ’¡ Kayçš„C++ç®—æ³•è§£æï¼š[ABC188E] Peddler æ·±å…¥å­¦ä¹ æŒ‡å— ğŸ’¡


## 1. é¢˜ç›®è§£è¯»ä¸æ ¸å¿ƒç®—æ³•è¯†åˆ«

âœ¨ **æœ¬é¢˜ä¸»è¦è€ƒå¯Ÿ**ï¼šDAGï¼ˆæœ‰å‘æ— ç¯å›¾ï¼‰ä¸Šçš„åŠ¨æ€è§„åˆ’/æ‹“æ‰‘æ’åº  

ğŸ—£ï¸ **åˆæ­¥åˆ†æ**ï¼š  
å°æœ‹å‹ä»¬ï¼Œæˆ‘ä»¬æ¥çœ‹çœ‹è¿™é“é¢˜â€”â€”é«˜æ¡¥å›è¦åšé»„é‡‘ä¹°å–ï¼Œæƒ³åœ¨ä¸€ä¸ªâ€œåªèƒ½ä»å°ç¼–å·ç”ºèµ°åˆ°å°ç¼–å·ç”ºâ€çš„å›½å®¶é‡Œï¼ˆå› ä¸ºé¢˜ç›®è¯´`X_i < Y_i`ï¼‰ï¼Œæ‰¾ä¸€ä¸ªç”º**ä¹°**é»„é‡‘ï¼Œå†èµ°åˆ°å¦ä¸€ä¸ªç”º**å–**ï¼Œèµšæœ€å¤šçš„é’±ï¼ˆåˆ©æ¶¦=å–ä»·-ä¹°ä»·ï¼‰ã€‚è¿™å°±åƒä½ å»é€›è¶…å¸‚ï¼Œè¦æ‰¾ä¸€æ¡ä»**ä¾¿å®œè¶…å¸‚**åˆ°**è´µè¶…å¸‚**çš„è·¯ï¼Œè¿™æ ·ä¹°äº†å†å–èƒ½èµšæœ€å¤šï¼  

**æ ¸å¿ƒé—®é¢˜**ï¼šå¦‚ä½•å¿«é€Ÿæ‰¾åˆ°æ¯ä¸ªç”º`j`ï¼Œæ‰€æœ‰èƒ½èµ°åˆ°`j`çš„ç”º`i`ä¸­ï¼Œ`A_i`ï¼ˆä¹°ä»·ï¼‰çš„**æœ€å°å€¼**ï¼Ÿå› ä¸º`A_j - æœ€å°å€¼`å°±æ˜¯åœ¨`j`å–çš„æœ€å¤§åˆ©æ¶¦ã€‚  

**æ ¸å¿ƒç®—æ³•**ï¼š  
å› ä¸ºå›¾æ˜¯**DAG**ï¼ˆæ²¡æœ‰ç¯ï¼Œä¸ä¼šç»•åœˆï¼‰ï¼Œæˆ‘ä»¬å¯ä»¥ç”¨ä¸¤ç§æ–¹æ³•é«˜æ•ˆè§£å†³ï¼š  
1. **æ‹“æ‰‘æ’åº**ï¼šæŒ‰èŠ‚ç‚¹çš„â€œä¾èµ–é¡ºåºâ€ï¼ˆæ¯”å¦‚ä»å°ç¼–å·åˆ°å°ç¼–å·ï¼‰å¤„ç†ï¼Œä¿è¯å¤„ç†`j`æ—¶ï¼Œæ‰€æœ‰èƒ½èµ°åˆ°`j`çš„`i`éƒ½å·²ç»å¤„ç†è¿‡ï¼Œè¿™æ ·èƒ½æ­£ç¡®è®¡ç®—`j`çš„æœ€å°ä¹°ä»·ã€‚  
2. **åå‘å›¾DFS**ï¼šæŠŠå›¾åè¿‡æ¥ï¼ˆä»`j`èµ°åˆ°`i`ï¼‰ï¼Œç”¨è®°å¿†åŒ–æœç´¢æ‰¾`j`èƒ½åˆ°è¾¾çš„`i`çš„æœ€å°`A_i`ï¼Œé¿å…é‡å¤è®¡ç®—ã€‚  

**å¯è§†åŒ–è®¾è®¡æ€è·¯**ï¼š  
æˆ‘ä»¬ç”¨**8ä½åƒç´ é£æ ¼**åšä¸€ä¸ªâ€œè´¸æ˜“æ¢é™©å®¶â€åŠ¨ç”»ï¼š  
- èŠ‚ç‚¹æ˜¯å½©è‰²åƒç´ å—ï¼Œç¼–å·è¶Šå°è¶Šé å·¦ï¼›  
- æ‹“æ‰‘æ’åºæ—¶ï¼ŒèŠ‚ç‚¹æŒ‰é¡ºåºâ€œäº®èµ·â€ï¼ˆä»ç°è‰²å˜è“è‰²ï¼‰ï¼Œæ—è¾¹æ˜¾ç¤ºå½“å‰çš„**æœ€å°ä¹°ä»·**ï¼›  
- å¤„ç†è¾¹æ—¶ï¼Œç›®æ ‡èŠ‚ç‚¹çš„æœ€å°ä¹°ä»·æ›´æ–°ï¼ˆæ¯”å¦‚ä»10å˜æˆ5ï¼‰ï¼Œç”¨**é—ªçƒçº¢è‰²**æç¤ºï¼›  
- åˆ©æ¶¦æ›´æ–°æ—¶ï¼Œå±å¹•å³ä¸Šè§’å¼¹å‡º**é‡‘è‰²æ•°å­—**ï¼ˆæ¯”å¦‚â€œå½“å‰æœ€å¤§åˆ©æ¶¦ï¼š3â€ï¼‰ï¼Œä¼´éšâ€œå®â€çš„éŸ³æ•ˆã€‚  


## 2. ç²¾é€‰ä¼˜è´¨é¢˜è§£å‚è€ƒ

ä¸ºäº†å¸®å¤§å®¶æ‰¾åˆ°æœ€æ¸…æ™°ã€æœ€é«˜æ•ˆçš„è§£æ³•ï¼ŒKayä»æ€è·¯ã€ä»£ç ã€æ•ˆç‡ä¸‰ä¸ªæ–¹é¢ç­›é€‰äº†3é“ä¼˜è´¨é¢˜è§£ï¼š


### **é¢˜è§£ä¸€ï¼šåå‘å›¾è®°å¿†åŒ–DFSï¼ˆä½œè€…ï¼šxuchuhanï¼‰**  
* **ç‚¹è¯„**ï¼š  
  è¿™é“é¢˜è§£çš„æ€è·¯ç‰¹åˆ«â€œèªæ˜â€â€”â€”æŠŠå›¾**åè¿‡æ¥**ï¼ˆåŸæœ¬`Xâ†’Y`ï¼Œå˜æˆ`Yâ†’X`ï¼‰ï¼Œè¿™æ ·æ‰¾â€œèƒ½èµ°åˆ°`j`çš„`i`â€å°±å˜æˆäº†â€œä»`j`èƒ½èµ°åˆ°çš„`i`â€ã€‚ç„¶åç”¨**è®°å¿†åŒ–æœç´¢**ï¼ˆ`dp[j]`è¡¨ç¤ºä»`j`èƒ½èµ°åˆ°çš„`i`çš„æœ€å°`A_i`ï¼‰ï¼Œé¿å…é‡å¤è®¡ç®—ã€‚ä»£ç ç®€æ´ï¼Œé€»è¾‘æ¸…æ™°ï¼Œæ¯”å¦‚`DFS(x)`å‡½æ•°è¿”å›`x`èƒ½åˆ°è¾¾çš„æœ€å°`A_i`ï¼Œ`a[x] - DFS(x)`å°±æ˜¯`x`å–çš„æœ€å¤§åˆ©æ¶¦ã€‚


### **é¢˜è§£äºŒï¼šæ‹“æ‰‘æ’åºï¼ˆä½œè€…ï¼šwwt100127ï¼‰**  
* **ç‚¹è¯„**ï¼š  
  è¿™é“é¢˜è§£å®Œç¾åˆ©ç”¨äº†DAGçš„**æ‹“æ‰‘åº**ï¼ˆèŠ‚ç‚¹é¡ºåºæ»¡è¶³æ‰€æœ‰è¾¹`Xâ†’Y`éƒ½æœ‰`X`åœ¨`Y`å‰é¢ï¼‰ã€‚å¤„ç†èŠ‚ç‚¹æ—¶ï¼ŒæŒ‰æ‹“æ‰‘åºä¾æ¬¡æ›´æ–°æ¯ä¸ªèŠ‚ç‚¹çš„**æœ€å°ä¹°ä»·**ï¼ˆ`P[y] = min(P[y], P[x])`ï¼Œå…¶ä¸­`x`æ˜¯`y`çš„å‰é©±ï¼‰ï¼ŒåŒæ—¶è®¡ç®—åˆ©æ¶¦ï¼ˆ`a[y] - P[y]`ï¼‰ã€‚ç®—æ³•æ•ˆç‡å¾ˆé«˜ï¼ˆ`O(n+m)`ï¼‰ï¼Œé€‚åˆå¤§è§„æ¨¡æ•°æ®ï¼Œä»£ç ç»“æ„ä¹Ÿå¾ˆè§„èŒƒã€‚


### **é¢˜è§£ä¸‰ï¼šæŒ‰è¾¹é¡ºåºå¤„ç†ï¼ˆä½œè€…ï¼š_shine_ï¼‰**  
* **ç‚¹è¯„**ï¼š  
  è¿™é“é¢˜è§£çš„æ€è·¯ç‰¹åˆ«â€œç›´æ¥â€â€”â€”å› ä¸º`X_i < Y_i`ï¼Œæ‰€ä»¥æ‰€æœ‰è¾¹çš„`Y`éƒ½æ˜¯é€’å¢çš„ã€‚æˆ‘ä»¬æŠŠè¾¹æŒ‰`Y`ä»å°åˆ°å¤§æ’åºï¼Œå¤„ç†æ¯ä¸ªè¾¹æ—¶ï¼Œæ›´æ–°`Y`çš„æœ€å°ä¹°ä»·ï¼ˆ`f[Y] = min(f[Y], f[X])`ï¼‰ï¼Œç„¶åè®¡ç®—`a[Y] - f[X]`ï¼ˆ`X`ä¹°ã€`Y`å–çš„åˆ©æ¶¦ï¼‰ã€‚ä»£ç è¶…çº§ç®€æ´ï¼Œå®¹æ˜“ç†è§£ï¼Œé€‚åˆåˆšå­¦DAGçš„å°æœ‹å‹ã€‚


## 3. æ ¸å¿ƒéš¾ç‚¹è¾¨æä¸è§£é¢˜ç­–ç•¥

åœ¨è§£å†³è¿™é“é¢˜æ—¶ï¼Œå°æœ‹å‹ä»¬å®¹æ˜“é‡åˆ°ä¸‰ä¸ªâ€œå¡å£³ç‚¹â€ï¼ŒKayå¸®å¤§å®¶æ€»ç»“äº†å¯¹ç­–ï¼š


### **1. å¦‚ä½•é«˜æ•ˆè®¡ç®—â€œèƒ½èµ°åˆ°`j`çš„æœ€å°`A_i`â€ï¼Ÿ**  
* **éš¾ç‚¹**ï¼šå¦‚æœæš´åŠ›éå†æ¯ä¸ª`j`çš„æ‰€æœ‰å‰é©±ï¼Œæ—¶é—´ä¼šå˜æˆ`O(n^2)`ï¼Œæ— æ³•é€šè¿‡å¤§è§„æ¨¡æ•°æ®ã€‚  
* **å¯¹ç­–**ï¼šç”¨**è®°å¿†åŒ–**ï¼ˆæ¯”å¦‚é¢˜è§£ä¸€çš„`dp`æ•°ç»„ï¼‰æˆ–**æ‹“æ‰‘åº**ï¼ˆé¢˜è§£äºŒçš„é¡ºåºå¤„ç†ï¼‰ï¼Œé¿å…é‡å¤è®¡ç®—ã€‚æ¯”å¦‚æ‹“æ‰‘åºä¿è¯å¤„ç†`j`æ—¶ï¼Œæ‰€æœ‰å‰é©±`i`éƒ½å·²ç»å¤„ç†è¿‡ï¼Œæ‰€ä»¥`j`çš„æœ€å°ä¹°ä»·å¯ä»¥ç›´æ¥ä»`i`çš„ç»“æœæ›´æ–°ã€‚


### **2. å¦‚ä½•åˆ©ç”¨DAGçš„ç‰¹æ€§ï¼Ÿ**  
* **éš¾ç‚¹**ï¼šDAGæ²¡æœ‰ç¯ï¼Œä½†æ€ä¹ˆæŠŠè¿™ä¸ªç‰¹æ€§ç”¨åˆ°ç®—æ³•é‡Œï¼Ÿ  
* **å¯¹ç­–**ï¼šDAGçš„**æ‹“æ‰‘åº**æ˜¯å…³é”®ï¼æ‹“æ‰‘åºæ˜¯èŠ‚ç‚¹çš„ä¸€ä¸ªæ’åˆ—ï¼Œä½¿å¾—æ‰€æœ‰è¾¹`Xâ†’Y`éƒ½æœ‰`X`åœ¨`Y`å‰é¢ã€‚è¿™æ ·å¤„ç†èŠ‚ç‚¹æ—¶ï¼Œå‰é©±çš„ä¿¡æ¯å·²ç»å®Œæ•´ï¼Œä¸éœ€è¦å›å¤´å†ç®—ã€‚æ¯”å¦‚é¢˜è§£äºŒçš„æ‹“æ‰‘æ’åºï¼Œå°±æ˜¯æŒ‰è¿™ä¸ªé¡ºåºå¤„ç†çš„ã€‚


### **3. å¦‚ä½•å¤„ç†â€œå¿…é¡»ä¹°å–ä¸åŒç”ºâ€çš„æ¡ä»¶ï¼Ÿ**  
* **éš¾ç‚¹**ï¼šå¦‚æœ`j`æ²¡æœ‰å‰é©±ï¼ˆä¸èƒ½ä»å…¶ä»–ç”ºèµ°åˆ°`j`ï¼‰ï¼Œé‚£ä¹ˆ`a[j] - æœ€å°A_i`å°±ä¼šæ˜¯`a[j] - a[j]`ï¼ˆè‡ªå·±ä¹°è‡ªå·±å–ï¼‰ï¼Œä½†é¢˜ç›®ä¸å…è®¸ã€‚  
* **å¯¹ç­–**ï¼šåˆå§‹åˆ©æ¶¦è®¾ä¸º**æå°å€¼**ï¼ˆæ¯”å¦‚`-1e18`ï¼‰ï¼Œåªæœ‰å½“`j`æœ‰å‰é©±æ—¶ï¼Œæ‰æ›´æ–°åˆ©æ¶¦ã€‚æ¯”å¦‚é¢˜è§£äºŒçš„æ‹“æ‰‘æ’åºä¸­ï¼Œå¤„ç†`j`æ—¶ï¼Œ`P[j]`æ˜¯å‰é©±çš„æœ€å°ä¹°ä»·ï¼Œæ‰€ä»¥`a[j] - P[j]`ä¸€å®šæ˜¯`iâ‰ j`çš„æƒ…å†µã€‚


### âœ¨ è§£é¢˜æŠ€å·§æ€»ç»“  
- **å›¾çš„æ–¹å‘è½¬æ¢**ï¼šåå‘å›¾å¯ä»¥æŠŠâ€œæ‰¾èƒ½åˆ°è¾¾`j`çš„`i`â€å˜æˆâ€œæ‰¾`j`èƒ½åˆ°è¾¾çš„`i`â€ï¼Œæœ‰æ—¶ä¼šæ›´æ–¹ä¾¿ã€‚  
- **æ‹“æ‰‘åºçš„åº”ç”¨**ï¼šDAGçš„æ‹“æ‰‘åºæ˜¯å¤„ç†ä¾èµ–é—®é¢˜çš„â€œç¥å™¨â€ï¼Œæ¯”å¦‚æœ¬é¢˜ä¸­çš„èŠ‚ç‚¹é¡ºåºã€‚  
- **è®°å¿†åŒ–æœç´¢**ï¼šé¿å…é‡å¤è®¡ç®—ï¼Œæé«˜æ•ˆç‡ï¼Œæ¯”å¦‚é¢˜è§£ä¸€çš„`dp`æ•°ç»„ã€‚  


## 4. C++æ ¸å¿ƒä»£ç å®ç°èµæ

### æœ¬é¢˜é€šç”¨æ ¸å¿ƒC++å®ç°å‚è€ƒï¼ˆæ‹“æ‰‘æ’åºç‰ˆï¼‰  
* **è¯´æ˜**ï¼šè¿™æ˜¯é¢˜è§£äºŒï¼ˆwwt100127ï¼‰çš„ä»£ç ï¼Œåˆ©ç”¨æ‹“æ‰‘æ’åºé«˜æ•ˆå¤„ç†DAGï¼Œé€‚åˆå¤§è§„æ¨¡æ•°æ®ã€‚  
* **å®Œæ•´æ ¸å¿ƒä»£ç **ï¼š  
  ```cpp
  #include <iostream>
  #include <vector>
  #include <queue>
  #include <cstring>
  using namespace std;

  const int N = 2e5 + 5;
  const long long INF = 1e18;

  int n, m;
  long long a[N], P[N]; // P[j]è¡¨ç¤ºèƒ½èµ°åˆ°jçš„æœ€å°A_i
  vector<int> g[N]; // å›¾çš„é‚»æ¥è¡¨
  int deg[N]; // èŠ‚ç‚¹çš„å…¥åº¦

  int main() {
      cin >> n >> m;
      for (int i = 1; i <= n; i++) {
          cin >> a[i];
          P[i] = INF; // åˆå§‹åŒ–ä¸ºæå¤§å€¼
      }
      for (int i = 0; i < m; i++) {
          int x, y;
          cin >> x >> y;
          g[x].push_back(y);
          deg[y]++; // ç»Ÿè®¡å…¥åº¦
      }

      queue<int> q;
      for (int i = 1; i <= n; i++) {
          if (deg[i] == 0) { // å…¥åº¦ä¸º0çš„èŠ‚ç‚¹å…¥é˜Ÿ
              q.push(i);
              P[i] = a[i]; // å…¥åº¦ä¸º0çš„èŠ‚ç‚¹ï¼Œæœ€å°ä¹°ä»·æ˜¯è‡ªå·±
          }
      }

      long long ans = -INF;
      while (!q.empty()) {
          int x = q.front();
          q.pop();
          ans = max(ans, a[x] - P[x]); // è®¡ç®—xå–çš„åˆ©æ¶¦
          for (int y : g[x]) { // éå†xçš„æ‰€æœ‰åç»§y
              P[y] = min(P[y], P[x]); // æ›´æ–°yçš„æœ€å°ä¹°ä»·ï¼ˆæ¥è‡ªxçš„è·¯å¾„ï¼‰
              deg[y]--;
              if (deg[y] == 0) { // å…¥åº¦ä¸º0æ—¶å…¥é˜Ÿ
                  q.push(y);
              }
          }
      }

      cout << ans << endl;
      return 0;
  }
  ```
* **ä»£ç è§£è¯»æ¦‚è¦**ï¼š  
  1. è¯»å–è¾“å…¥ï¼Œåˆå§‹åŒ–å›¾å’Œå…¥åº¦æ•°ç»„ï¼›  
  2. æ‰¾åˆ°æ‰€æœ‰å…¥åº¦ä¸º0çš„èŠ‚ç‚¹ï¼ˆæ²¡æœ‰å‰é©±çš„èŠ‚ç‚¹ï¼‰ï¼Œå…¥é˜Ÿï¼Œå®ƒä»¬çš„æœ€å°ä¹°ä»·æ˜¯è‡ªå·±ï¼›  
  3. æŒ‰æ‹“æ‰‘åºå¤„ç†èŠ‚ç‚¹ï¼šå–å‡ºé˜Ÿé¦–èŠ‚ç‚¹`x`ï¼Œè®¡ç®—`x`å–çš„åˆ©æ¶¦ï¼ˆ`a[x] - P[x]`ï¼‰ï¼Œç„¶åæ›´æ–°`x`çš„æ‰€æœ‰åç»§`y`çš„æœ€å°ä¹°ä»·ï¼ˆ`P[y] = min(P[y], P[x])`ï¼‰ï¼›  
  4. å½“`y`çš„å…¥åº¦å˜ä¸º0æ—¶ï¼Œå…¥é˜Ÿï¼Œç»§ç»­å¤„ç†ã€‚  


### ä¼˜è´¨é¢˜è§£ç‰‡æ®µèµæ

#### **é¢˜è§£ä¸€ï¼ˆåå‘å›¾DFSï¼‰æ ¸å¿ƒç‰‡æ®µ**  
* **äº®ç‚¹**ï¼šè®°å¿†åŒ–æœç´¢ï¼Œé¿å…é‡å¤è®¡ç®—ã€‚  
* **æ ¸å¿ƒä»£ç **ï¼š  
  ```cpp
  #include <iostream>
  #include <vector>
  #include <cstring>
  using namespace std;

  const int N = 2e5 + 5;
  const long long INF = 1e18;

  int n, m;
  long long a[N], dp[N]; // dp[j]è¡¨ç¤ºä»jèƒ½èµ°åˆ°çš„æœ€å°A_i
  vector<int> g[N]; // åå‘å›¾ï¼ˆYâ†’Xï¼‰

  long long DFS(int x) {
      if (dp[x] != INF) return dp[x]; // å·²ç»è®¡ç®—è¿‡ï¼Œç›´æ¥è¿”å›
      long long res = INF;
      for (int y : g[x]) { // éå†åå‘å›¾ä¸­çš„å‰é©±yï¼ˆåŸé—®é¢˜ä¸­çš„åç»§ï¼‰
          res = min(res, min(DFS(y), a[y])); // æ‰¾yèƒ½åˆ°è¾¾çš„æœ€å°A_iï¼Œæˆ–è€…yè‡ªå·±
      }
      return dp[x] = res;
  }

  int main() {
      cin >> n >> m;
      for (int i = 1; i <= n; i++) {
          cin >> a[i];
          dp[i] = INF;
      }
      for (int i = 0; i < m; i++) {
          int x, y;
          cin >> x >> y;
          g[y].push_back(x); // å»ºåå‘å›¾
      }

      long long ans = -INF;
      for (int i = 1; i <= n; i++) {
          ans = max(ans, a[i] - DFS(i)); // è®¡ç®—iå–çš„åˆ©æ¶¦
      }

      cout << ans << endl;
      return 0;
  }
  ```
* **ä»£ç è§£è¯»**ï¼š  
  - `g[y].push_back(x)`ï¼šå»ºåå‘å›¾ï¼Œæ¯”å¦‚åŸè¾¹æ˜¯`xâ†’y`ï¼Œåå‘åæ˜¯`yâ†’x`ï¼Œè¿™æ ·`DFS(y)`å°±èƒ½æ‰¾åˆ°æ‰€æœ‰èƒ½èµ°åˆ°`y`çš„`x`ï¼›  
  - `DFS(x)`å‡½æ•°ï¼šè¿”å›ä»`x`èƒ½èµ°åˆ°çš„æœ€å°`A_i`ï¼Œç”¨`dp[x]`è®°å¿†åŒ–ï¼Œé¿å…é‡å¤è®¡ç®—ï¼›  
  - `a[i] - DFS(i)`ï¼š`i`å–çš„åˆ©æ¶¦ï¼Œå› ä¸º`DFS(i)`æ˜¯èƒ½èµ°åˆ°`i`çš„æœ€å°ä¹°ä»·ã€‚  


#### **é¢˜è§£ä¸‰ï¼ˆæŒ‰è¾¹é¡ºåºå¤„ç†ï¼‰æ ¸å¿ƒç‰‡æ®µ**  
* **äº®ç‚¹**ï¼šåˆ©ç”¨`X_i < Y_i`çš„æ¡ä»¶ï¼ŒæŒ‰`Y`æ’åºå¤„ç†è¾¹ï¼Œä»£ç ç®€æ´ã€‚  
* **æ ¸å¿ƒä»£ç **ï¼š  
  ```cpp
  #include <iostream>
  #include <vector>
  #include <algorithm>
  using namespace std;

  const int N = 2e5 + 5;
  const long long INF = 1e18;

  int n, m;
  long long a[N], f[N]; // f[Y]è¡¨ç¤ºèƒ½èµ°åˆ°Yçš„æœ€å°A_i
  struct Edge {
      int x, y;
  } e[N];

  bool cmp(Edge a, Edge b) {
      return a.y < b.y; // æŒ‰Yä»å°åˆ°å¤§æ’åº
  }

  int main() {
      cin >> n >> m;
      for (int i = 1; i <= n; i++) {
          cin >> a[i];
          f[i] = a[i]; // åˆå§‹åŒ–ä¸ºè‡ªå·±
      }
      for (int i = 0; i < m; i++) {
          cin >> e[i].x >> e[i].y;
      }

      sort(e, e + m, cmp); // æŒ‰Yæ’åº

      long long ans = -INF;
      for (int i = 0; i < m; i++) {
          int x = e[i].x, y = e[i].y;
          ans = max(ans, a[y] - f[x]); // xä¹°ï¼Œyå–çš„åˆ©æ¶¦
          f[y] = min(f[y], f[x]); // æ›´æ–°yçš„æœ€å°ä¹°ä»·ï¼ˆæ¥è‡ªxçš„è·¯å¾„ï¼‰
      }

      cout << ans << endl;
      return 0;
  }
  ```
* **ä»£ç è§£è¯»**ï¼š  
  - `sort(e, e + m, cmp)`ï¼šæŒ‰`Y`ä»å°åˆ°å¤§æ’åºï¼Œå› ä¸º`X < Y`ï¼Œæ‰€ä»¥å¤„ç†`Y`æ—¶ï¼Œ`X`å·²ç»å¤„ç†è¿‡äº†ï¼›  
  - `ans = max(ans, a[y] - f[x])`ï¼š`x`ä¹°ã€`y`å–çš„åˆ©æ¶¦ï¼Œå› ä¸º`f[x]`æ˜¯èƒ½èµ°åˆ°`x`çš„æœ€å°ä¹°ä»·ï¼›  
  - `f[y] = min(f[y], f[x])`ï¼šæ›´æ–°`y`çš„æœ€å°ä¹°ä»·ï¼Œå› ä¸º`x`èƒ½èµ°åˆ°`y`ï¼Œæ‰€ä»¥`y`çš„æœ€å°ä¹°ä»·å¯ä»¥æ˜¯`x`çš„æœ€å°ä¹°ä»·ã€‚  


## 5. ç®—æ³•å¯è§†åŒ–ï¼šåƒç´ åŠ¨ç”»æ¼”ç¤ºï¼ˆæ ¸å¿ƒéƒ¨åˆ†ï¼‰

### **åŠ¨ç”»æ¼”ç¤ºä¸»é¢˜**ï¼šã€Šè´¸æ˜“æ¢é™©å®¶ä¹‹é»„é‡‘ä¹‹è·¯ã€‹ï¼ˆ8ä½åƒç´ é£æ ¼ï¼‰  
### **è®¾è®¡æ€è·¯**ï¼š  
ç”¨FCçº¢ç™½æœºçš„å¤å¤é£æ ¼ï¼Œè®©å°æœ‹å‹ä»¬åœ¨â€œç©æ¸¸æˆâ€ä¸­ç†è§£ç®—æ³•ã€‚æ¯”å¦‚ï¼š  
- èŠ‚ç‚¹æ˜¯å½©è‰²åƒç´ å—ï¼ˆç¼–å·1-4ï¼Œå¯¹åº”æ ·ä¾‹1ï¼‰ï¼Œå·¦è¾¹æ˜¯å°ç¼–å·ï¼Œå³è¾¹æ˜¯å¤§ç¼–å·ï¼›  
- æ‹“æ‰‘æ’åºæ—¶ï¼ŒèŠ‚ç‚¹æŒ‰é¡ºåºâ€œäº®èµ·â€ï¼ˆä»ç°è‰²å˜è“è‰²ï¼‰ï¼Œæ—è¾¹æ˜¾ç¤ºå½“å‰çš„**æœ€å°ä¹°ä»·**ï¼ˆæ¯”å¦‚èŠ‚ç‚¹1çš„æœ€å°ä¹°ä»·æ˜¯2ï¼‰ï¼›  
- å¤„ç†è¾¹æ—¶ï¼Œç›®æ ‡èŠ‚ç‚¹çš„æœ€å°ä¹°ä»·æ›´æ–°ï¼ˆæ¯”å¦‚èŠ‚ç‚¹4çš„æœ€å°ä¹°ä»·ä»5å˜æˆ2ï¼‰ï¼Œç”¨**é—ªçƒçº¢è‰²**æç¤ºï¼›  
- åˆ©æ¶¦æ›´æ–°æ—¶ï¼Œå±å¹•å³ä¸Šè§’å¼¹å‡º**é‡‘è‰²æ•°å­—**ï¼ˆæ¯”å¦‚â€œå½“å‰æœ€å¤§åˆ©æ¶¦ï¼š3â€ï¼‰ï¼Œä¼´éšâ€œå®â€çš„éŸ³æ•ˆã€‚  


### **åŠ¨ç”»å¸§æ­¥éª¤**ï¼š  
1. **åˆå§‹åŒ–åœºæ™¯**ï¼š  
   - å±å¹•æ˜¾ç¤º4ä¸ªèŠ‚ç‚¹ï¼ˆ1-4ï¼‰ï¼Œç°è‰²ï¼Œæ—è¾¹æ˜¾ç¤ºå„è‡ªçš„`A_i`ï¼ˆ2ã€3ã€1ã€5ï¼‰ï¼›  
   - æ§åˆ¶é¢æ¿æœ‰â€œå¼€å§‹â€ã€â€œå•æ­¥â€ã€â€œé‡ç½®â€æŒ‰é’®ï¼Œé€Ÿåº¦æ»‘å—ï¼ˆ1-10å€ï¼‰ï¼›  
   - 8ä½é£æ ¼çš„èƒŒæ™¯éŸ³ä¹ï¼ˆè½»å¿«çš„ç”µå­ä¹ï¼‰å¼€å§‹æ’­æ”¾ã€‚  

2. **æ‹“æ‰‘æ’åºå¯åŠ¨**ï¼š  
   - èŠ‚ç‚¹1çš„å…¥åº¦ä¸º0ï¼Œâ€œäº®èµ·â€ï¼ˆå˜è“è‰²ï¼‰ï¼Œæ—è¾¹æ˜¾ç¤º`P[1] = 2`ï¼ˆæœ€å°ä¹°ä»·æ˜¯è‡ªå·±ï¼‰ï¼›  
   - èŠ‚ç‚¹1å…¥é˜Ÿï¼Œä¼´éšâ€œå…¥é˜Ÿâ€éŸ³æ•ˆï¼ˆçŸ­ä¿ƒçš„â€œæ»´â€ï¼‰ã€‚  

3. **å¤„ç†èŠ‚ç‚¹1**ï¼š  
   - å–å‡ºèŠ‚ç‚¹1ï¼Œè®¡ç®—åˆ©æ¶¦ï¼š`a[1] - P[1] = 2-2=0`ï¼Œå½“å‰æœ€å¤§åˆ©æ¶¦æ˜¯0ï¼›  
   - éå†èŠ‚ç‚¹1çš„åç»§ï¼ˆèŠ‚ç‚¹2ã€3ï¼‰ï¼š  
     - èŠ‚ç‚¹2çš„`P[2]`æ›´æ–°ä¸º`min(INF, P[1]) = 2`ï¼ŒèŠ‚ç‚¹2é—ªçƒçº¢è‰²ï¼›  
     - èŠ‚ç‚¹3çš„`P[3]`æ›´æ–°ä¸º`min(INF, P[1]) = 2`ï¼ŒèŠ‚ç‚¹3é—ªçƒçº¢è‰²ï¼›  
   - èŠ‚ç‚¹2ã€3çš„å…¥åº¦å˜ä¸º0ï¼Œå…¥é˜Ÿã€‚  

4. **å¤„ç†èŠ‚ç‚¹2**ï¼š  
   - å–å‡ºèŠ‚ç‚¹2ï¼Œè®¡ç®—åˆ©æ¶¦ï¼š`a[2] - P[2] =3-2=1`ï¼Œå½“å‰æœ€å¤§åˆ©æ¶¦æ›´æ–°ä¸º1ï¼›  
   - éå†èŠ‚ç‚¹2çš„åç»§ï¼ˆèŠ‚ç‚¹4ï¼‰ï¼š  
     - èŠ‚ç‚¹4çš„`P[4]`æ›´æ–°ä¸º`min(INF, P[2]) =2`ï¼ŒèŠ‚ç‚¹4é—ªçƒçº¢è‰²ï¼›  
   - èŠ‚ç‚¹4çš„å…¥åº¦å˜ä¸º0ï¼Œå…¥é˜Ÿã€‚  

5. **å¤„ç†èŠ‚ç‚¹3**ï¼š  
   - å–å‡ºèŠ‚ç‚¹3ï¼Œè®¡ç®—åˆ©æ¶¦ï¼š`a[3] - P[3] =1-2=-1`ï¼Œå½“å‰æœ€å¤§åˆ©æ¶¦ä¸å˜ï¼›  
   - éå†èŠ‚ç‚¹3çš„åç»§ï¼ˆæ— ï¼‰ï¼Œè·³è¿‡ã€‚  

6. **å¤„ç†èŠ‚ç‚¹4**ï¼š  
   - å–å‡ºèŠ‚ç‚¹4ï¼Œè®¡ç®—åˆ©æ¶¦ï¼š`a[4] - P[4] =5-2=3`ï¼Œå½“å‰æœ€å¤§åˆ©æ¶¦æ›´æ–°ä¸º3ï¼›  
   - éå†èŠ‚ç‚¹4çš„åç»§ï¼ˆæ— ï¼‰ï¼Œè·³è¿‡ã€‚  

7. **ç»“æŸçŠ¶æ€**ï¼š  
   - å±å¹•æ˜¾ç¤ºâ€œæœ€å¤§åˆ©æ¶¦ï¼š3â€ï¼Œä¼´éšâ€œèƒœåˆ©â€éŸ³æ•ˆï¼ˆä¸Šæ‰¬çš„ç”µå­ä¹ï¼‰ï¼›  
   - èŠ‚ç‚¹4é—ªçƒé‡‘è‰²ï¼Œæç¤ºâ€œå–é»„é‡‘çš„æœ€ä½³åœ°ç‚¹â€ã€‚  


## 6. æ‹“å±•ç»ƒä¹ ä¸ç›¸ä¼¼é—®é¢˜æ€è€ƒ

### **é€šç”¨æ€è·¯è¿ç§»**ï¼š  
æœ¬é¢˜çš„æ ¸å¿ƒæ€è·¯ï¼ˆDAGä¸Šçš„åŠ¨æ€è§„åˆ’/æ‹“æ‰‘æ’åºï¼‰å¯ä»¥è§£å†³å¾ˆå¤šç±»ä¼¼é—®é¢˜ï¼Œæ¯”å¦‚ï¼š  
- **è·¯å¾„æœ€å€¼é—®é¢˜**ï¼šæ‰¾DAGä¸­è·¯å¾„çš„æœ€å¤§/æœ€å°æƒå€¼å’Œï¼›  
- **ä¾èµ–é—®é¢˜**ï¼šæ¯”å¦‚é¡¹ç›®è°ƒåº¦ï¼ˆå¿…é¡»å®Œæˆå‰ç½®é¡¹ç›®æ‰èƒ½åšåç»­é¡¹ç›®ï¼‰ï¼›  
- **è´¸æ˜“é—®é¢˜**ï¼šæ¯”å¦‚æ´›è°·P1073ã€Šæœ€ä¼˜è´¸æ˜“ã€‹ï¼ˆæ‰¾ä¸¤æ¬¡è·¯å¾„ï¼Œä¹°å’Œå–ï¼‰ã€‚  


### **ç»ƒä¹ æ¨èï¼ˆæ´›è°·ï¼‰**ï¼š  
1. **æ´›è°· P1073** - ã€Šæœ€ä¼˜è´¸æ˜“ã€‹  
   ğŸ—£ï¸ **æ¨èç†ç”±**ï¼šç»å…¸çš„è´¸æ˜“é—®é¢˜ï¼Œéœ€è¦æ‰¾â€œä¹°â†’å–â€çš„ä¸¤æ¬¡è·¯å¾„ï¼Œæ¯”æœ¬é¢˜å¤æ‚ï¼Œä½†æ€è·¯ç±»ä¼¼ï¼ˆDAGä¸Šçš„åŠ¨æ€è§„åˆ’ï¼‰ã€‚  
2. **æ´›è°· P2661** - ã€Šä¿¡æ¯ä¼ é€’ã€‹  
   ğŸ—£ï¸ **æ¨èç†ç”±**ï¼šæ‹“æ‰‘æ’åºçš„åº”ç”¨ï¼Œæ‰¾æœ€å°ç¯ï¼Œé”»ç‚¼æ‹“æ‰‘æ’åºçš„ä½¿ç”¨ã€‚  
3. **æ´›è°· P3387** - ã€Šå¼ºè¿é€šåˆ†é‡ã€‹  
   ğŸ—£ï¸ **æ¨èç†ç”±**ï¼šå°†å›¾ç¼©ç‚¹æˆDAGï¼Œç„¶åå¤„ç†ï¼Œæ‹“å±•DAGçš„åº”ç”¨ã€‚  


## 7. å­¦ä¹ å¿ƒå¾—ä¸ç»éªŒåˆ†äº«ï¼ˆè‹¥æœ‰ï¼‰

### **å‚è€ƒç»éªŒï¼ˆæ¥è‡ªé¢˜è§£ä½œè€…lyh0217ï¼‰**ï¼š  
â€œæˆ‘ä¸€å¼€å§‹æ²¡çœ‹åˆ°é¢˜ç›®ä¸­çš„â€˜DAGâ€™æ¡ä»¶ï¼Œå†™äº†ä¸ªæš´åŠ›DFSï¼Œç»“æœè¶…æ—¶äº†ã€‚åæ¥æ‰æƒ³åˆ°ç”¨è®°å¿†åŒ–æœç´¢ï¼Œé¿å…é‡å¤è®¡ç®—ï¼Œç»ˆäºé€šè¿‡äº†ã€‚â€  

**ç‚¹è¯„**ï¼š  
è¿™ä½ä½œè€…çš„ç»å†å¾ˆå…¸å‹â€”â€”**æ³¨æ„é¢˜ç›®æ¡ä»¶**æ˜¯è§£å†³é—®é¢˜çš„å…³é”®ï¼DAGçš„ç‰¹æ€§ï¼ˆæ²¡æœ‰ç¯ï¼‰è®©æˆ‘ä»¬å¯ä»¥ç”¨æ›´é«˜æ•ˆçš„ç®—æ³•ï¼ˆæ¯”å¦‚æ‹“æ‰‘æ’åºã€è®°å¿†åŒ–æœç´¢ï¼‰ï¼Œè€Œæš´åŠ›æ³•ä¼šè¶…æ—¶ã€‚å°æœ‹å‹ä»¬åœ¨åšé¢˜æ—¶ï¼Œä¸€å®šè¦ä»”ç»†çœ‹é¢˜ç›®ä¸­çš„æ¡ä»¶å“¦ï¼  


## ç»“è¯­  
æœ¬æ¬¡å…³äº[ABC188E] Peddlerçš„åˆ†æå°±åˆ°è¿™é‡Œå•¦ï¼å¸Œæœ›å¤§å®¶èƒ½ç†è§£DAGä¸Šçš„åŠ¨æ€è§„åˆ’å’Œæ‹“æ‰‘æ’åºï¼Œå­¦ä¼šç”¨è¿™äº›ç®—æ³•è§£å†³ç±»ä¼¼çš„é—®é¢˜ã€‚è®°ä½ï¼š**ç¼–ç¨‹çš„ä¹è¶£åœ¨äºç”¨èªæ˜çš„æ–¹æ³•è§£å†³é—®é¢˜**ï¼Œä¸‹æ¬¡æˆ‘ä»¬å†ä¸€èµ·æ¢ç´¢æ–°çš„æŒ‘æˆ˜å§ï¼ğŸ’ª

---
å¤„ç†ç”¨æ—¶ï¼š199.90ç§’
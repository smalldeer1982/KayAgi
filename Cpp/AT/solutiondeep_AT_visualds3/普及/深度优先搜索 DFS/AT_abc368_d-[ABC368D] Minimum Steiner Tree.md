# é¢˜ç›®ä¿¡æ¯

# [ABC368D] Minimum Steiner Tree

## é¢˜ç›®æè¿°

[problemUrl]: https://atcoder.jp/contests/abc368/tasks/abc368_d

é ‚ç‚¹ã« $ 1 $ ã‹ã‚‰ $ N $ ã®ç•ªå·ãŒã¤ã„ãŸ $ N $ é ‚ç‚¹ã®æœ¨ãŒä¸ãˆã‚‰ã‚Œã¾ã™ã€‚$ i $ ç•ªç›®ã®è¾ºã¯é ‚ç‚¹ $ A_i $ ã¨é ‚ç‚¹ $ B_i $ ã‚’çµã‚“ã§ã„ã¾ã™ã€‚

ã“ã®ã‚°ãƒ©ãƒ•ã‹ã‚‰ã„ãã¤ã‹ã®($ 0 $ å€‹ã§ã‚‚ã‚ˆã„)è¾ºã¨é ‚ç‚¹ã‚’å‰Šé™¤ã—ã¦ã§ãã‚‹æœ¨ã®ã†ã¡ã€æŒ‡å®šã•ã‚ŒãŸ $ K $ å€‹ã®é ‚ç‚¹ã€é ‚ç‚¹ $ V_1,\ldots,V_K $ ã‚’å…¨ã¦å«ã‚€ã‚ˆã†ãªã‚‚ã®ã®é ‚ç‚¹æ•°ã®æœ€å°å€¤ã‚’æ±‚ã‚ã¦ãã ã•ã„ã€‚

## è¯´æ˜/æç¤º

### åˆ¶ç´„

- $ 1\ \leq\ K\ \leq\ N\ \leq\ 2\times\ 10^5 $
- $ 1\ \leq\ A_i,B_i\ \leq\ N $
- $ 1\ \leq\ V_1\ <\ V_2\ <\ \ldots\ <\ V_K\ \leq\ N $
- ä¸ãˆã‚‰ã‚Œã‚‹ã‚°ãƒ©ãƒ•ã¯æœ¨ã§ã‚ã‚‹
- å…¥åŠ›ã¯å…¨ã¦æ•´æ•°

### Sample Explanation 1

ä¸ãˆã‚‰ã‚ŒãŸæœ¨ã¯ä¸‹å›³å·¦ã®é€šã‚Šã§ã‚ã‚Šã€ãã“ã‹ã‚‰ã„ãã¤ã‹ã®è¾ºã¨é ‚ç‚¹ã‚’å‰Šé™¤ã—ã¦ã§ãã‚‹æœ¨ã®ã†ã¡é ‚ç‚¹ $ 1,3,5 $ ã‚’å…¨ã¦å«ã‚€ã‚ˆã†ãªé ‚ç‚¹æ•°æœ€å°ã®ã‚‚ã®ã¯ä¸‹å›³å³ã®é€šã‚Šã§ã™ã€‚ 
![å›³](https://img.atcoder.jp/abc368/4baf6b0adb0e12dcf8a5c812ada5c17a.png)

## æ ·ä¾‹ #1

### è¾“å…¥

```
7 3
1 2
1 3
2 4
2 5
3 6
3 7
1 3 5```

### è¾“å‡º

```
4```

## æ ·ä¾‹ #2

### è¾“å…¥

```
4 4
3 1
1 4
2 1
1 2 3 4```

### è¾“å‡º

```
4```

## æ ·ä¾‹ #3

### è¾“å…¥

```
5 1
1 4
2 3
5 2
1 2
1```

### è¾“å‡º

```
1```

# AIåˆ†æç»“æœ

# ğŸ’¡ Kayçš„C++ç®—æ³•è§£æï¼š[ABC368D] Minimum Steiner Tree æ·±å…¥å­¦ä¹ æŒ‡å— ğŸ’¡


## 1. é¢˜ç›®è§£è¯»ä¸æ ¸å¿ƒç®—æ³•è¯†åˆ«

âœ¨ **æœ¬é¢˜ä¸»è¦è€ƒå¯Ÿ**ï¼šæ ‘çš„**æœ€å°å­æ ‘è¦†ç›–é—®é¢˜**ï¼ˆå±äºæ ‘å½¢ç»“æ„åº”ç”¨ï¼‰

ğŸ—£ï¸ **åˆæ­¥åˆ†æ**ï¼š  
é¢˜ç›®è¦æ±‚ä»ä¸€æ£µæ ‘ä¸Šé€‰å‡º**æœ€å°‘èŠ‚ç‚¹**ï¼Œç»„æˆä¸€ä¸ªå­æ ‘ï¼ŒåŒ…å«æ‰€æœ‰æŒ‡å®šçš„$K$ä¸ªèŠ‚ç‚¹ã€‚è¿™å°±åƒåœ¨æ ‘ä¸Šâ€œä¸²çç â€â€”â€”æ‰€æœ‰æŒ‡å®šèŠ‚ç‚¹ï¼ˆçç ï¼‰å¿…é¡»è¢«ä¸€æ¡â€œçº¿â€ï¼ˆè·¯å¾„ï¼‰è¿æ¥èµ·æ¥ï¼Œè€Œè¿™æ¡â€œçº¿â€ä¸Šçš„æ‰€æœ‰èŠ‚ç‚¹ï¼ˆåŒ…æ‹¬çç ï¼‰éƒ½è¦ä¿ç•™ï¼Œå…¶ä»–èŠ‚ç‚¹å¯ä»¥åˆ é™¤ã€‚  

**æ ¸å¿ƒç®—æ³•æ€è·¯**ï¼š  
å¿…é¡»ä¿ç•™çš„èŠ‚ç‚¹æ˜¯ï¼š**æ‰€æœ‰æŒ‡å®šèŠ‚ç‚¹ï¼Œä»¥åŠè¿æ¥å®ƒä»¬çš„è·¯å¾„ä¸Šçš„èŠ‚ç‚¹**ã€‚å¸¸è§çš„è§£å†³æ–¹æ³•æœ‰ä¸‰ç§ï¼š  
1. **DFSæ ‡è®°æ³•**ï¼šä»æŒ‡å®šèŠ‚ç‚¹å‡ºå‘ï¼Œæ ‡è®°æ‰€æœ‰å¿…é¡»ä¿ç•™çš„èŠ‚ç‚¹ï¼ˆå­æ ‘åŒ…å«æŒ‡å®šèŠ‚ç‚¹çš„èŠ‚ç‚¹ï¼‰ã€‚  
2. **æ‹“æ‰‘æ’åºæ³•**ï¼šé€æ­¥åˆ é™¤ä¸éœ€è¦çš„å¶å­èŠ‚ç‚¹ï¼ˆéæŒ‡å®šèŠ‚ç‚¹ä¸”åº¦æ•°ä¸º1ï¼‰ã€‚  
3. **è™šæ ‘æ³•**ï¼šæ„å»ºåŒ…å«æ‰€æœ‰æŒ‡å®šèŠ‚ç‚¹å’Œå®ƒä»¬çš„LCAçš„æœ€å°å­æ ‘ã€‚  

**æ ¸å¿ƒéš¾ç‚¹**ï¼š  
- å¦‚ä½•é«˜æ•ˆæ ‡è®°å¿…é¡»ä¿ç•™çš„èŠ‚ç‚¹ï¼Ÿ  
- å¦‚ä½•é¿å…ä¿ç•™ä¸å¿…è¦çš„èŠ‚ç‚¹ï¼ˆæ¯”å¦‚æ ¹èŠ‚ç‚¹é€‰æ‹©é”™è¯¯å¯¼è‡´çš„å†—ä½™ï¼‰ï¼Ÿ  

**å¯è§†åŒ–è®¾è®¡æ€è·¯**ï¼š  
ç”¨**8ä½åƒç´ é£æ ¼**å±•ç¤ºæ ‘ç»“æ„ï¼ŒæŒ‡å®šèŠ‚ç‚¹ç”¨**çº¢è‰²**æ ‡è®°ï¼Œå¿…é¡»ä¿ç•™çš„èŠ‚ç‚¹ç”¨**ç»¿è‰²**æ ‡è®°ï¼Œåˆ é™¤çš„èŠ‚ç‚¹ç”¨**ç°è‰²**æ ‡è®°ã€‚åŠ¨ç”»åˆ†ä¸¤æ­¥ï¼š  
1. **DFSæ ‡è®°**ï¼šä»æŒ‡å®šèŠ‚ç‚¹å‡ºå‘ï¼Œé€æ­¥å°†è·¯å¾„ä¸Šçš„èŠ‚ç‚¹æŸ“æˆç»¿è‰²ï¼ˆä¼´éšâ€œå®â€çš„éŸ³æ•ˆï¼‰ã€‚  
2. **åˆ é™¤æ— ç”¨èŠ‚ç‚¹**ï¼šå°†ç°è‰²èŠ‚ç‚¹é€æ­¥â€œæ¶ˆå¤±â€ï¼ˆä¼´éšâ€œå’»â€çš„éŸ³æ•ˆï¼‰ï¼Œæœ€ç»ˆç•™ä¸‹ç»¿è‰²èŠ‚ç‚¹ç»„æˆçš„å­æ ‘ã€‚  


## 2. ç²¾é€‰ä¼˜è´¨é¢˜è§£å‚è€ƒ

### é¢˜è§£ä¸€ï¼ˆä½œè€…ï¼šwo_hen_laï¼Œèµï¼š5ï¼‰  
**ç‚¹è¯„**ï¼š  
æ€è·¯**æ¸…æ™°æ˜“æ‡‚**ï¼Œç”¨**ä¸¤æ¬¡DFS**è§£å†³é—®é¢˜ï¼Œæ—¶é—´å¤æ‚åº¦$O(n)$ï¼Œé€‚åˆåˆå­¦è€…ç†è§£ã€‚ç¬¬ä¸€æ¬¡DFSæ ‡è®°æ¯ä¸ªèŠ‚ç‚¹æ˜¯å¦â€œæœ‰ç”¨â€ï¼ˆå­æ ‘åŒ…å«æŒ‡å®šèŠ‚ç‚¹ï¼‰ï¼Œç¬¬äºŒæ¬¡DFSè®¡ç®—è¦åˆ é™¤çš„èŠ‚ç‚¹æ•°ï¼ˆæ— ç”¨èŠ‚ç‚¹çš„å­æ ‘å¤§å°ï¼‰ã€‚ä»£ç ç®€æ´ï¼Œå˜é‡å‘½åç›´è§‚ï¼ˆ`vv`è¡¨ç¤ºæ˜¯å¦æœ‰ç”¨ï¼Œ`siz`è¡¨ç¤ºå­æ ‘å¤§å°ï¼‰ï¼Œè¾¹ç•Œå¤„ç†ä¸¥è°¨ï¼ˆæ¯”å¦‚æ ¹èŠ‚ç‚¹å¿…é¡»æ˜¯æŒ‡å®šèŠ‚ç‚¹ï¼‰ã€‚  

### é¢˜è§£äºŒï¼ˆä½œè€…ï¼šyx666ï¼Œèµï¼š3ï¼ŒSolution 2ï¼‰  
**ç‚¹è¯„**ï¼š  
ç”¨**ä¸€æ¬¡DFS**ç»Ÿè®¡`sz`æ•°ç»„ï¼ˆå­æ ‘ä¸­æŒ‡å®šèŠ‚ç‚¹çš„æ•°é‡ï¼‰ï¼Œç„¶åç»Ÿè®¡`sz[u]â‰ 0ä¸”sz[u]<k`çš„èŠ‚ç‚¹æ•°åŠ 1ï¼Œå°±æ˜¯ç­”æ¡ˆã€‚ä»£ç æ›´ç®€æ´ï¼Œæ•ˆç‡æ›´é«˜ï¼Œé€‚åˆè¿›é˜¶å­¦ä¹ è€…ã€‚æ ¸å¿ƒé€»è¾‘æ˜¯ï¼š`sz[u]â‰ 0`è¯´æ˜å­æ ‘æœ‰æŒ‡å®šèŠ‚ç‚¹ï¼Œ`sz[u]<k`è¯´æ˜å­æ ‘å¤–ä¹Ÿæœ‰æŒ‡å®šèŠ‚ç‚¹ï¼Œå› æ­¤`u`å¿…é¡»ä¿ç•™ï¼ˆè¿æ¥å­æ ‘å†…å¤–çš„æŒ‡å®šèŠ‚ç‚¹ï¼‰ã€‚  

### é¢˜è§£ä¸‰ï¼ˆä½œè€…ï¼šlucasincyberï¼Œèµï¼š1ï¼‰  
**ç‚¹è¯„**ï¼š  
æ€è·¯**ç‹¬ç‰¹**ï¼Œç”¨**æ‹“æ‰‘æ’åº**åˆ é™¤ä¸éœ€è¦çš„èŠ‚ç‚¹ã€‚é€æ­¥åˆ é™¤åº¦æ•°ä¸º1ä¸”éæŒ‡å®šèŠ‚ç‚¹çš„å¶å­èŠ‚ç‚¹ï¼Œç›´åˆ°ä¸èƒ½åˆ é™¤ä¸ºæ­¢ã€‚è¿™ç§æ–¹æ³•ç›´è§‚å±•ç¤ºäº†â€œæ— ç”¨èŠ‚ç‚¹â€çš„åˆ é™¤è¿‡ç¨‹ï¼Œé€‚åˆç†è§£æ ‘çš„ç»“æ„ç‰¹æ€§ã€‚ä»£ç ç”¨é˜Ÿåˆ—å®ç°æ‹“æ‰‘æ’åºï¼Œé€»è¾‘æ¸…æ™°ï¼Œæ•ˆç‡$O(n)$ã€‚  


## 3. æ ¸å¿ƒéš¾ç‚¹è¾¨æä¸è§£é¢˜ç­–ç•¥

### 1. å¦‚ä½•ç¡®å®šå¿…é¡»ä¿ç•™çš„èŠ‚ç‚¹ï¼Ÿ  
**éš¾ç‚¹**ï¼šå¿…é¡»ä¿ç•™çš„èŠ‚ç‚¹æ˜¯æŒ‡å®šèŠ‚ç‚¹åŠå…¶è·¯å¾„ä¸Šçš„èŠ‚ç‚¹ï¼Œå¦‚ä½•é«˜æ•ˆæ ‡è®°è¿™äº›èŠ‚ç‚¹ï¼Ÿ  
**è§£å†³ç­–ç•¥**ï¼š  
- **DFSæ ‡è®°æ³•**ï¼šä»æŒ‡å®šèŠ‚ç‚¹å‡ºå‘ï¼Œé€’å½’æ ‡è®°æ‰€æœ‰å­æ ‘åŒ…å«æŒ‡å®šèŠ‚ç‚¹çš„èŠ‚ç‚¹ï¼ˆ`vv[u] = vv[u] || vv[v]`ï¼‰ã€‚  
- **æ‹“æ‰‘æ’åºæ³•**ï¼šé€æ­¥åˆ é™¤éæŒ‡å®šèŠ‚ç‚¹çš„å¶å­èŠ‚ç‚¹ï¼Œå‰©ä¸‹çš„å°±æ˜¯å¿…é¡»ä¿ç•™çš„èŠ‚ç‚¹ã€‚  

### 2. å¦‚ä½•é¿å…ä¿ç•™ä¸å¿…è¦çš„èŠ‚ç‚¹ï¼Ÿ  
**éš¾ç‚¹**ï¼šå¦‚æœæ ¹èŠ‚ç‚¹é€‰æ‹©é”™è¯¯ï¼ˆæ¯”å¦‚é€‰éæŒ‡å®šèŠ‚ç‚¹ï¼‰ï¼Œå¯èƒ½ä¼šä¿ç•™ä¸å¿…è¦çš„èŠ‚ç‚¹ã€‚  
**è§£å†³ç­–ç•¥**ï¼š  
- å¿…é¡»é€‰**æŒ‡å®šèŠ‚ç‚¹**ä½œä¸ºæ ¹ï¼ˆæ¯”å¦‚`wo_hen_la`çš„é¢˜è§£ä¸­ï¼Œç”¨æœ€åä¸€ä¸ªæŒ‡å®šèŠ‚ç‚¹ä½œä¸ºæ ¹ï¼‰ã€‚  

### 3. å¦‚ä½•é«˜æ•ˆè®¡ç®—å¿…é¡»ä¿ç•™çš„èŠ‚ç‚¹æ•°ï¼Ÿ  
**éš¾ç‚¹**ï¼šé¿å…é‡å¤è®¡ç®—è·¯å¾„ä¸Šçš„èŠ‚ç‚¹ã€‚  
**è§£å†³ç­–ç•¥**ï¼š  
- **DFSç»Ÿè®¡å­æ ‘å¤§å°**ï¼š`siz[u]`è¡¨ç¤ºå­æ ‘å¤§å°ï¼Œæ— ç”¨èŠ‚ç‚¹çš„å­æ ‘å¤§å°å¯ä»¥ç›´æ¥å‡å»ï¼ˆ`ans -= siz[v]`ï¼‰ã€‚  
- **szæ•°ç»„ç»Ÿè®¡æŒ‡å®šèŠ‚ç‚¹æ•°**ï¼š`sz[u]`è¡¨ç¤ºå­æ ‘ä¸­æŒ‡å®šèŠ‚ç‚¹çš„æ•°é‡ï¼Œ`sz[u]â‰ 0ä¸”sz[u]<k`çš„èŠ‚ç‚¹å¿…é¡»ä¿ç•™ã€‚  

ğŸ’¡ **å­¦ä¹ ç¬”è®°**ï¼š  
- æ ‘çš„æœ€å°å­æ ‘è¦†ç›–é—®é¢˜çš„æ ¸å¿ƒæ˜¯**æ‰¾åˆ°è¿æ¥æ‰€æœ‰æŒ‡å®šèŠ‚ç‚¹çš„è·¯å¾„**ã€‚  
- æ ¹èŠ‚ç‚¹å¿…é¡»é€‰æŒ‡å®šèŠ‚ç‚¹ï¼Œå¦åˆ™ä¼šä¿ç•™ä¸å¿…è¦çš„èŠ‚ç‚¹ã€‚  


## 4. C++æ ¸å¿ƒä»£ç å®ç°èµæ

### æœ¬é¢˜é€šç”¨æ ¸å¿ƒC++å®ç°å‚è€ƒï¼ˆåŸºäºwo_hen_laçš„é¢˜è§£ï¼‰  
**è¯´æ˜**ï¼šæœ¬ä»£ç ç”¨ä¸¤æ¬¡DFSæ ‡è®°æœ‰ç”¨èŠ‚ç‚¹å¹¶è®¡ç®—åˆ é™¤çš„èŠ‚ç‚¹æ•°ï¼Œé€»è¾‘æ¸…æ™°ï¼Œé€‚åˆåˆå­¦è€…ã€‚  
```cpp
#include <iostream>
#include <vector>
using namespace std;

const int N = 2e5 + 10;
vector<int> e[N];
bool vis[N], vv[N]; // vis: æŒ‡å®šèŠ‚ç‚¹ï¼›vv: æ˜¯å¦æœ‰ç”¨
int siz[N], ans, n, k;

void dfs(int u, int fa) {
    if (vis[u]) vv[u] = 1; // æŒ‡å®šèŠ‚ç‚¹æ ‡è®°ä¸ºæœ‰ç”¨
    siz[u] = 1;
    for (int v : e[u]) {
        if (v == fa) continue;
        dfs(v, u);
        siz[u] += siz[v]; // è®¡ç®—å­æ ‘å¤§å°
        vv[u] |= vv[v];   // å­èŠ‚ç‚¹æœ‰ç”¨åˆ™çˆ¶èŠ‚ç‚¹æœ‰ç”¨
    }
}

void dfs2(int u, int fa) {
    for (int v : e[u]) {
        if (v == fa) continue;
        if (!vv[v]) { // å­èŠ‚ç‚¹æ— ç”¨ï¼Œå‡å»å…¶å­æ ‘å¤§å°
            ans -= siz[v];
            continue;
        }
        dfs2(v, u);
    }
}

int main() {
    ios::sync_with_stdio(false);
    cin.tie(0);
    cin >> n >> k;
    for (int i = 1; i < n; i++) {
        int u, v;
        cin >> u >> v;
        e[u].push_back(v);
        e[v].push_back(u);
    }
    int root = 0;
    for (int i = 1; i <= k; i++) {
        int x;
        cin >> x;
        vis[x] = 1;
        root = x; // é€‰æœ€åä¸€ä¸ªæŒ‡å®šèŠ‚ç‚¹ä½œä¸ºæ ¹
    }
    ans = n; // åˆå§‹ä¸ºæ€»èŠ‚ç‚¹æ•°
    dfs(root, 0);
    dfs2(root, 0);
    cout << ans << endl;
    return 0;
}
```  
**ä»£ç è§£è¯»æ¦‚è¦**ï¼š  
- ç¬¬ä¸€æ¬¡DFSï¼ˆ`dfs`ï¼‰ï¼šæ ‡è®°æ¯ä¸ªèŠ‚ç‚¹æ˜¯å¦æœ‰ç”¨ï¼ˆ`vv[u]`ï¼‰ï¼Œå¹¶è®¡ç®—å­æ ‘å¤§å°ï¼ˆ`siz[u]`ï¼‰ã€‚  
- ç¬¬äºŒæ¬¡DFSï¼ˆ`dfs2`ï¼‰ï¼šå¦‚æœå­èŠ‚ç‚¹æ— ç”¨ï¼Œä»æ€»èŠ‚ç‚¹æ•°ä¸­å‡å»å…¶å­æ ‘å¤§å°ï¼ˆ`ans -= siz[v]`ï¼‰ã€‚  
- æœ€ç»ˆ`ans`å°±æ˜¯å¿…é¡»ä¿ç•™çš„èŠ‚ç‚¹æ•°ã€‚  


### é’ˆå¯¹å„ä¼˜è´¨é¢˜è§£çš„ç‰‡æ®µèµæ

#### é¢˜è§£ä¸€ï¼ˆwo_hen_laï¼‰  
**äº®ç‚¹**ï¼šä¸¤æ¬¡DFSåˆ†å·¥æ˜ç¡®ï¼Œé€»è¾‘æ¸…æ™°ã€‚  
**æ ¸å¿ƒä»£ç ç‰‡æ®µ**ï¼š  
```cpp
void dfs(int u, int fa) {
    if (vis[u]) vv[u] = 1;
    siz[u] = 1;
    for (int v : e[u]) {
        if (v == fa) continue;
        dfs(v, u);
        siz[u] += siz[v];
        vv[u] |= vv[v];
    }
}
```  
**ä»£ç è§£è¯»**ï¼š  
- `vis[u]`è¡¨ç¤º`u`æ˜¯å¦æ˜¯æŒ‡å®šèŠ‚ç‚¹ï¼Œå¦‚æœæ˜¯ï¼Œæ ‡è®°ä¸ºæœ‰ç”¨ï¼ˆ`vv[u] = 1`ï¼‰ã€‚  
- é€’å½’éå†å­èŠ‚ç‚¹`v`ï¼Œè®¡ç®—å­æ ‘å¤§å°ï¼ˆ`siz[u] += siz[v]`ï¼‰ã€‚  
- å¦‚æœå­èŠ‚ç‚¹`v`æœ‰ç”¨ï¼ˆ`vv[v] = 1`ï¼‰ï¼Œåˆ™çˆ¶èŠ‚ç‚¹`u`ä¹Ÿæœ‰ç”¨ï¼ˆ`vv[u] |= vv[v]`ï¼‰ã€‚  
**å­¦ä¹ ç¬”è®°**ï¼šå­æ ‘çš„æœ‰ç”¨æ€§ä¼šä¼ é€’ç»™çˆ¶èŠ‚ç‚¹ï¼Œå› ä¸ºçˆ¶èŠ‚ç‚¹æ˜¯è¿æ¥å­æ ‘å’Œæ ¹çš„å¿…ç»ä¹‹è·¯ã€‚  


#### é¢˜è§£äºŒï¼ˆyx666ï¼ŒSolution 2ï¼‰  
**äº®ç‚¹**ï¼šä¸€æ¬¡DFSç»Ÿè®¡`sz`æ•°ç»„ï¼Œä»£ç ç®€æ´ã€‚  
**æ ¸å¿ƒä»£ç ç‰‡æ®µ**ï¼š  
```cpp
int sz[N];
void dfs(int x, int fa) {
    for (int to : edge[x]) {
        if (to != fa) {
            dfs(to, x);
            sz[x] += sz[to];
        }
    }
}

int main() {
    // è¾“å…¥å¤„ç†...
    for (int i = 1; i <= k; i++) sz[read()] = 1; // æŒ‡å®šèŠ‚ç‚¹æ ‡è®°ä¸º1
    dfs(1, 0);
    int ans = 0;
    for (int i = 1; i <= n; i++) {
        if (sz[i] && sz[i] < k) ans++; // ç»Ÿè®¡å¿…é¡»ä¿ç•™çš„èŠ‚ç‚¹
    }
    printf("%d", ans + 1); // åŠ ä¸Šæ ¹èŠ‚ç‚¹
}
```  
**ä»£ç è§£è¯»**ï¼š  
- `sz[x]`è¡¨ç¤ºä»¥`x`ä¸ºæ ¹çš„å­æ ‘ä¸­æŒ‡å®šèŠ‚ç‚¹çš„æ•°é‡ã€‚  
- éå†æ‰€æœ‰èŠ‚ç‚¹ï¼Œ`sz[i] != 0`è¯´æ˜å­æ ‘æœ‰æŒ‡å®šèŠ‚ç‚¹ï¼Œ`sz[i] < k`è¯´æ˜å­æ ‘å¤–ä¹Ÿæœ‰æŒ‡å®šèŠ‚ç‚¹ï¼Œå› æ­¤`i`å¿…é¡»ä¿ç•™ï¼ˆè¿æ¥å­æ ‘å†…å¤–çš„æŒ‡å®šèŠ‚ç‚¹ï¼‰ã€‚  
- æœ€ååŠ 1æ˜¯å› ä¸ºæ ¹èŠ‚ç‚¹ï¼ˆæŒ‡å®šèŠ‚ç‚¹ï¼‰å¿…é¡»ä¿ç•™ã€‚  
**å­¦ä¹ ç¬”è®°**ï¼š`sz[i] < k`æ˜¯åˆ¤æ–­èŠ‚ç‚¹æ˜¯å¦åœ¨è¿æ¥è·¯å¾„ä¸Šçš„å…³é”®æ¡ä»¶ã€‚  


#### é¢˜è§£ä¸‰ï¼ˆlucasincyberï¼‰  
**äº®ç‚¹**ï¼šæ‹“æ‰‘æ’åºåˆ é™¤æ— ç”¨èŠ‚ç‚¹ï¼Œç›´è§‚å±•ç¤ºè¿‡ç¨‹ã€‚  
**æ ¸å¿ƒä»£ç ç‰‡æ®µ**ï¼š  
```cpp
queue<int> q;
int deg[N]; // åº¦æ•°
bool must[N]; // æ˜¯å¦æ˜¯æŒ‡å®šèŠ‚ç‚¹

int main() {
    // è¾“å…¥å¤„ç†...
    for (int i = 1; i <= n; i++) {
        if (!must[i] && deg[i] == 1) q.push(i); // éæŒ‡å®šèŠ‚ç‚¹ä¸”åº¦æ•°ä¸º1çš„å¶å­å…¥é˜Ÿ
    }
    while (!q.empty()) {
        int u = q.front();
        q.pop();
        ans--; // åˆ é™¤è¯¥èŠ‚ç‚¹
        for (int v : tr[u]) {
            if (!must[v]) { // çˆ¶èŠ‚ç‚¹éæŒ‡å®šèŠ‚ç‚¹
                deg[v]--;
                if (deg[v] == 1) q.push(v); // çˆ¶èŠ‚ç‚¹å˜æˆå¶å­ï¼Œå…¥é˜Ÿ
            }
        }
    }
    printf("%d\n", ans);
}
```  
**ä»£ç è§£è¯»**ï¼š  
- åˆå§‹åŒ–é˜Ÿåˆ—ï¼Œå°†éæŒ‡å®šèŠ‚ç‚¹ä¸”åº¦æ•°ä¸º1çš„å¶å­èŠ‚ç‚¹å…¥é˜Ÿã€‚  
- æ¯æ¬¡å–å‡ºé˜Ÿåˆ—ä¸­çš„èŠ‚ç‚¹ï¼Œåˆ é™¤å®ƒï¼ˆ`ans--`ï¼‰ï¼Œå¹¶å°†å…¶çˆ¶èŠ‚ç‚¹çš„åº¦æ•°å‡1ã€‚å¦‚æœçˆ¶èŠ‚ç‚¹å˜æˆéæŒ‡å®šèŠ‚ç‚¹ä¸”åº¦æ•°ä¸º1çš„å¶å­ï¼Œå…¥é˜Ÿç»§ç»­å¤„ç†ã€‚  
- æœ€ç»ˆ`ans`å°±æ˜¯å¿…é¡»ä¿ç•™çš„èŠ‚ç‚¹æ•°ã€‚  
**å­¦ä¹ ç¬”è®°**ï¼šæ‹“æ‰‘æ’åºæ˜¯å¤„ç†æ ‘ä¸­å¶å­èŠ‚ç‚¹åˆ é™¤é—®é¢˜çš„æœ‰æ•ˆæ–¹æ³•ã€‚  


## 5. ç®—æ³•å¯è§†åŒ–ï¼šåƒç´ åŠ¨ç”»æ¼”ç¤ºï¼ˆæ ¸å¿ƒéƒ¨åˆ†ï¼‰

### åŠ¨ç”»æ¼”ç¤ºä¸»é¢˜  
**ã€Šåƒç´ æ ‘çš„â€œçç ä¸²â€æ¸¸æˆã€‹**ï¼šç”¨8ä½åƒç´ é£æ ¼å±•ç¤ºæ ‘ç»“æ„ï¼ŒæŒ‡å®šèŠ‚ç‚¹æ˜¯â€œçç â€ï¼ˆçº¢è‰²ï¼‰ï¼Œå¿…é¡»ä¿ç•™çš„èŠ‚ç‚¹æ˜¯â€œçº¿â€ï¼ˆç»¿è‰²ï¼‰ï¼Œåˆ é™¤çš„èŠ‚ç‚¹æ˜¯â€œç°å—â€ï¼ˆç°è‰²ï¼‰ã€‚  

### æ ¸å¿ƒæ¼”ç¤ºå†…å®¹  
1. **åˆå§‹åŒ–**ï¼šå±•ç¤ºä¸€æ£µåƒç´ æ ‘ï¼ŒæŒ‡å®šèŠ‚ç‚¹ç”¨çº¢è‰²æ ‡è®°ï¼ˆä¼´éšâ€œæ»´â€çš„éŸ³æ•ˆï¼‰ã€‚  
2. **DFSæ ‡è®°**ï¼šä»æŒ‡å®šèŠ‚ç‚¹å‡ºå‘ï¼Œé€æ­¥å°†è·¯å¾„ä¸Šçš„èŠ‚ç‚¹æŸ“æˆç»¿è‰²ï¼ˆä¼´éšâ€œå®â€çš„éŸ³æ•ˆï¼‰ï¼Œè¡¨ç¤ºè¿™äº›èŠ‚ç‚¹å¿…é¡»ä¿ç•™ã€‚  
3. **åˆ é™¤æ— ç”¨èŠ‚ç‚¹**ï¼šå°†ç°è‰²èŠ‚ç‚¹é€æ­¥â€œæ¶ˆå¤±â€ï¼ˆä¼´éšâ€œå’»â€çš„éŸ³æ•ˆï¼‰ï¼Œæœ€ç»ˆç•™ä¸‹ç»¿è‰²èŠ‚ç‚¹ç»„æˆçš„å­æ ‘ã€‚  
4. **èƒœåˆ©æç¤º**ï¼šå½“æ‰€æœ‰æ— ç”¨èŠ‚ç‚¹åˆ é™¤å®Œæ¯•ï¼Œæ’­æ”¾â€œèƒœåˆ©â€éŸ³æ•ˆï¼ˆ8ä½é£æ ¼ï¼‰ï¼Œå¹¶æ˜¾ç¤ºâ€œæœ€å°å­æ ‘å®Œæˆï¼â€çš„æ–‡å­—ã€‚  

### äº¤äº’è®¾è®¡  
- **æ­¥è¿›æ§åˆ¶**ï¼šâ€œå•æ­¥æ‰§è¡Œâ€ï¼ˆé€å¸§å±•ç¤ºDFSæˆ–åˆ é™¤è¿‡ç¨‹ï¼‰ã€â€œè‡ªåŠ¨æ’­æ”¾â€ï¼ˆå¯è°ƒèŠ‚é€Ÿåº¦ï¼‰ã€‚  
- **é‡ç½®æŒ‰é’®**ï¼šæ¢å¤åˆå§‹çŠ¶æ€ï¼Œé‡æ–°æ¼”ç¤ºã€‚  
- **éŸ³æ•ˆæ§åˆ¶**ï¼šå¯å¼€å¯/å…³é—­éŸ³æ•ˆï¼ˆé»˜è®¤å¼€å¯ï¼‰ã€‚  

### æŠ€æœ¯å®ç°  
- **é¢œè‰²æ–¹æ¡ˆ**ï¼šæŒ‡å®šèŠ‚ç‚¹ï¼ˆçº¢è‰²ï¼š`#FF0000`ï¼‰ã€å¿…é¡»ä¿ç•™èŠ‚ç‚¹ï¼ˆç»¿è‰²ï¼š`#00FF00`ï¼‰ã€åˆ é™¤èŠ‚ç‚¹ï¼ˆç°è‰²ï¼š`#808080`ï¼‰ã€‚  
- **Canvasç»˜åˆ¶**ï¼šç”¨`ctx.fillRect`ç»˜åˆ¶åƒç´ èŠ‚ç‚¹ï¼Œ`ctx.beginPath`ç»˜åˆ¶è¾¹ã€‚  
- **éŸ³æ•ˆè§¦å‘**ï¼šæ ‡è®°èŠ‚ç‚¹æ—¶æ’­æ”¾`ding.wav`ï¼Œåˆ é™¤èŠ‚ç‚¹æ—¶æ’­æ”¾`whoosh.wav`ï¼Œèƒœåˆ©æ—¶æ’­æ”¾`win.wav`ï¼ˆå‡ä¸º8ä½é£æ ¼éŸ³æ•ˆï¼‰ã€‚  


## 6. æ‹“å±•ç»ƒä¹ ä¸ç›¸ä¼¼é—®é¢˜æ€è€ƒ

### é€šç”¨æ€è·¯è¿ç§»  
æ ‘çš„æœ€å°å­æ ‘è¦†ç›–é—®é¢˜çš„æ€è·¯å¯ä»¥è¿ç§»åˆ°ä»¥ä¸‹åœºæ™¯ï¼š  
1. **ç¤¾äº¤ç½‘ç»œä¸­çš„å…³é”®è·¯å¾„**ï¼šæ‰¾åˆ°è¿æ¥æ‰€æœ‰å…³é”®ç”¨æˆ·çš„æœ€çŸ­è·¯å¾„ã€‚  
2. **ç”µè·¯è®¾è®¡ä¸­çš„æœ€å°å¸ƒçº¿**ï¼šè¿æ¥æ‰€æœ‰å…ƒä»¶çš„æœ€çŸ­å¯¼çº¿ã€‚  
3. **åœ°å›¾å¯¼èˆªä¸­çš„å¿…ç»ä¹‹è·¯**ï¼šæ‰¾åˆ°ä»èµ·ç‚¹åˆ°ç»ˆç‚¹çš„å¿…ç»èŠ‚ç‚¹ã€‚  

### æ´›è°·ç»ƒä¹ æ¨è  
1. **P10723 æ ‘çš„æŸ“è‰²**ï¼šè¦æ±‚ä¿ç•™æŒ‡å®šèŠ‚ç‚¹çš„æœ€å°å­æ ‘ï¼Œä¸æœ¬é¢˜å®Œå…¨ä¸€è‡´ï¼Œé€‚åˆå·©å›ºåŸºç¡€ã€‚  
2. **P2495 [SDOI2011] æŸ“è‰²**ï¼šæ¶‰åŠæ ‘é“¾å‰–åˆ†å’Œè·¯å¾„è¦†ç›–ï¼Œé€‚åˆè¿›é˜¶ç»ƒä¹ ã€‚  
3. **P3384 é‡é“¾å‰–åˆ†æ¨¡æ¿**ï¼šå­¦ä¹ æ ‘é“¾å‰–åˆ†ï¼Œä¸ºè§£å†³æ›´å¤æ‚çš„æ ‘é—®é¢˜æ‰“åŸºç¡€ã€‚  
4. **P2921 [USACO08DEC] Trick or Treat on the Farm**ï¼šæ¶‰åŠæ ‘çš„è·¯å¾„é—®é¢˜ï¼Œé€‚åˆæ‹“å±•æ€ç»´ã€‚  


## 7. å­¦ä¹ å¿ƒå¾—ä¸ç»éªŒåˆ†äº«ï¼ˆè‹¥æœ‰ï¼‰  
**å‚è€ƒç»éªŒï¼ˆæ¥è‡ªOIer_Hhyçš„é¢˜è§£ï¼‰**ï¼š  
â€œå¦‚æœæŠŠ1ä½œä¸ºæ ¹ï¼Œä¼šWAåœ¨ä¸€ç»„æ•°æ®ä¸Šï¼Œå› ä¸º1å·èŠ‚ç‚¹ä¸æ˜¯æŒ‡å®šèŠ‚ç‚¹ï¼Œä¸èƒ½åˆ é™¤ã€‚è€Œé€‰æŒ‡å®šèŠ‚ç‚¹ä½œä¸ºæ ¹ï¼Œå°±èƒ½æ­£ç¡®åˆ é™¤æ— ç”¨èŠ‚ç‚¹ã€‚â€  
**ç‚¹è¯„**ï¼šæ ¹èŠ‚ç‚¹çš„é€‰æ‹©æ˜¯å…³é”®ï¼å¿…é¡»é€‰æŒ‡å®šèŠ‚ç‚¹ä½œä¸ºæ ¹ï¼Œå¦åˆ™ä¼šä¿ç•™ä¸å¿…è¦çš„èŠ‚ç‚¹ã€‚è¿™æé†’æˆ‘ä»¬ï¼Œåœ¨è§£å†³æ ‘é—®é¢˜æ—¶ï¼Œæ ¹èŠ‚ç‚¹çš„é€‰æ‹©è¦ç¬¦åˆé¢˜æ„ï¼ˆæ¯”å¦‚å¿…é¡»åŒ…å«æŒ‡å®šèŠ‚ç‚¹ï¼‰ã€‚  


## ç»“è¯­  
æœ¬æ¬¡åˆ†æäº†â€œMinimum Steiner Treeâ€é—®é¢˜çš„å¤šç§è§£æ³•ï¼ŒåŒ…æ‹¬DFSæ ‡è®°ã€æ‹“æ‰‘æ’åºã€è™šæ ‘ç­‰ã€‚æ ¸å¿ƒæ€æƒ³æ˜¯æ‰¾åˆ°è¿æ¥æ‰€æœ‰æŒ‡å®šèŠ‚ç‚¹çš„æœ€å°å­æ ‘ï¼Œå…³é”®æ˜¯æ ‡è®°å¿…é¡»ä¿ç•™çš„èŠ‚ç‚¹ã€‚é€šè¿‡å¯è§†åŒ–åŠ¨ç”»å’Œæ‹“å±•ç»ƒä¹ ï¼Œå¸Œæœ›å¤§å®¶èƒ½æ›´å¥½åœ°ç†è§£å’ŒæŒæ¡æ ‘çš„ç»“æ„é—®é¢˜ã€‚  

è®°ä½ï¼š**æ ‘çš„é—®é¢˜ï¼Œæ ¹èŠ‚ç‚¹çš„é€‰æ‹©å¾ˆé‡è¦ï¼Œè·¯å¾„çš„è¦†ç›–æ˜¯æ ¸å¿ƒï¼** ä¸‹æ¬¡é‡åˆ°ç±»ä¼¼é—®é¢˜ï¼Œä¸å¦¨è¯•è¯•ä»Šå¤©å­¦çš„æ–¹æ³•ï½ ğŸ’ª

---
å¤„ç†ç”¨æ—¶ï¼š215.46ç§’
# é¢˜ç›®ä¿¡æ¯

# [ABC147F] Sum Difference

## é¢˜ç›®æè¿°

[problemUrl]: https://atcoder.jp/contests/abc147/tasks/abc147_f

é•·ã• $ N $ ã®æ•´æ•°åˆ— $ A $ ãŒã‚ã‚Šã€$ A_1\ =\ X,\ A_{i+1}\ =\ A_i\ +\ D\ (1\ \leq\ i\ <\ N\ ) $ ãŒæˆã‚Šç«‹ã£ã¦ã„ã¾ã™ã€‚

é«˜æ©‹å›ã¯ã“ã®æ•´æ•°åˆ—ã®è¦ç´ ã‚’ã„ãã¤ã‹é¸ã‚“ã§å–ã‚Šã€æ®‹ã‚Šå…¨ã¦ã‚’é’æœ¨å›ãŒå–ã‚Šã¾ã™ã€‚$ 2 $ äººã®ã©ã¡ã‚‰ã‹ãŒå…¨ã¦ã‚’å–ã‚‹ã“ã¨ã«ãªã£ã¦ã‚‚æ§‹ã„ã¾ã›ã‚“ã€‚

é«˜æ©‹å›ã®å–ã£ãŸæ•°ã®å’Œã‚’ $ S $, é’æœ¨å›ã®å–ã£ãŸæ•°ã®å’Œã‚’ $ T $ ã¨ã—ãŸã¨ãã€$ S\ -\ T $ ã¨ã—ã¦è€ƒãˆã‚‰ã‚Œã‚‹å€¤ã¯ä½•é€šã‚Šã‚ã‚‹ã§ã—ã‚‡ã†ã‹ã€‚

## è¯´æ˜/æç¤º

### åˆ¶ç´„

- $ -10^8\ \leq\ X,\ D\ \leq\ 10^8 $
- $ 1\ \leq\ N\ \leq\ 2\ \times\ 10^5 $
- å…¥åŠ›ã¯å…¨ã¦æ•´æ•°ã§ã‚ã‚‹

### Sample Explanation 1

$ A $ ã¯ $ (4,\ 6,\ 8) $ ã§ã™ã€‚ (é«˜æ©‹å›, é’æœ¨å›) ã®å–ã‚Šæ–¹ã¯ã€ $ ((),\ (4,\ 6,\ 8)),\ ((4),\ (6,\ 8)),\ ((6),\ (4,\ 8)),\ ((8),\ (4,\ 6))),\ ((4,\ 6),\ (8))),\ ((4,\ 8),\ (6))),\ ((6,\ 8),\ (4))),\ ((4,\ 6,\ 8),\ ()) $ ã® $ 8 $ é€šã‚Šã‚ã‚Šã¾ã™ã€‚ $ S\ -\ T $ ã¯ãã‚Œãã‚Œ $ -18,\ -10,\ -6,\ -2,\ 2,\ 6,\ 10,\ 18 $ ã§ã‚ã‚‹ã®ã§ã€å€¤ã®ç¨®é¡æ•°ã¯ $ 8 $ ã§ã™ã€‚

### Sample Explanation 2

$ A $ ã¯ $ (3,\ 0) $ ã§ã‚ã‚Šã€$ S\ -\ T $ ã¨ã—ã¦è€ƒãˆã‚‰ã‚Œã‚‹å€¤ã¯ $ -3,\ 3 $ ã§ã€ç¨®é¡æ•°ã¯ $ 2 $ ã§ã™ã€‚

## æ ·ä¾‹ #1

### è¾“å…¥

```
3 4 2```

### è¾“å‡º

```
8```

## æ ·ä¾‹ #2

### è¾“å…¥

```
2 3 -3```

### è¾“å‡º

```
2```

## æ ·ä¾‹ #3

### è¾“å…¥

```
100 14 20```

### è¾“å‡º

```
49805```

# AIåˆ†æç»“æœ

# ğŸ’¡ Kayçš„C++ç®—æ³•è§£æï¼š[ABC147F] Sum Difference æ·±å…¥å­¦ä¹ æŒ‡å— ğŸ’¡


## 1. é¢˜ç›®è§£è¯»ä¸æ ¸å¿ƒç®—æ³•è¯†åˆ«

âœ¨ **æœ¬é¢˜ä¸»è¦è€ƒå¯Ÿ**ï¼šæ•°å­¦è½¬åŒ– + åŒºé—´åˆå¹¶ï¼ˆç¼–ç¨‹æŠ€å·§åº”ç”¨ï¼‰

ğŸ—£ï¸ **åˆæ­¥åˆ†æ**ï¼š  
è§£å†³â€œSum Differenceâ€çš„å…³é”®ï¼Œæ˜¯æŠŠâ€œé«˜æ¡¥ä¸é’æœ¨çš„å’Œä¹‹å·®â€è½¬åŒ–ä¸ºâ€œé€‰å–å…ƒç´ å’Œçš„ä¸åŒå€¼æ•°é‡â€ã€‚å› ä¸ºå·®=2Ã—é€‰å–å’Œ-æ€»å’Œï¼ˆæ€»å’Œæ˜¯å®šå€¼ï¼‰ï¼Œæ‰€ä»¥é—®é¢˜ç­‰ä»·äºæ±‚**é€‰å–å…ƒç´ å’Œçš„ä¸åŒå€¼æœ‰å¤šå°‘ç§**ã€‚  

ç­‰å·®æ•°åˆ—çš„é€šé¡¹æ˜¯ \(A_i = X + (i-1)D\)ï¼Œé€‰å–\(t\)ä¸ªå…ƒç´ çš„å’Œä¸º \(tX + sD\)ï¼ˆ\(s\)æ˜¯é€‰å–å…ƒç´ çš„\((i-1)\)ä¹‹å’Œï¼‰ã€‚\(s\)çš„èŒƒå›´æ˜¯è¿ç»­çš„ï¼šæœ€å°ä¸ºé€‰å‰\(t\)ä¸ªçš„\(\frac{t(t-1)}{2}\)ï¼Œæœ€å¤§ä¸ºé€‰å\(t\)ä¸ªçš„\(\frac{(2n-t-1)t}{2}\)ã€‚  

**æ ¸å¿ƒéš¾ç‚¹**ï¼šä¸åŒ\(t\)å¯¹åº”çš„\(tX + sD\)å¯èƒ½é‡å¤ã€‚è§£å†³æ–¹æ³•æ˜¯**æŒ‰\(tX\)æ¨¡\(D\)åˆ†ç±»**â€”â€”åªæœ‰æ¨¡ç›¸åŒçš„\(tX\)ï¼Œå…¶å¯¹åº”çš„\(tX + sD\)æ‰å¯èƒ½é‡å ï¼ˆå› ä¸º\(sD\)æ˜¯\(D\)çš„å€æ•°ï¼‰ã€‚å¯¹æ¯ä¸ªæ¨¡ç±»ä¸­çš„åŒºé—´ï¼ˆ\(s\)çš„èŒƒå›´å¯¹åº”åˆ°\(tX + sD\)çš„èŒƒå›´ï¼‰è¿›è¡Œ**åˆå¹¶**ï¼Œè®¡ç®—æ€»é•¿åº¦å³ä¸ºç­”æ¡ˆã€‚  

**å¯è§†åŒ–è®¾è®¡æ€è·¯**ï¼šç”¨8ä½åƒç´ é£æ ¼å±•ç¤ºâ€œæ¨¡åˆ†ç±»â€å’Œâ€œåŒºé—´åˆå¹¶â€è¿‡ç¨‹ã€‚æ¯”å¦‚ï¼š  
- ç”¨ä¸åŒé¢œè‰²çš„åƒç´ å—è¡¨ç¤ºä¸åŒæ¨¡ç±»çš„åŒºé—´ï¼ˆå¦‚çº¢è‰²ä»£è¡¨æ¨¡0ï¼Œè“è‰²ä»£è¡¨æ¨¡1ï¼‰ï¼›  
- åŠ¨ç”»æ¼”ç¤ºåŒºé—´åˆå¹¶ï¼šå½“æ–°åŒºé—´ä¸å·²æœ‰åŒºé—´é‡å æ—¶ï¼Œåƒç´ å—ä¼šâ€œå»¶ä¼¸â€åˆå¹¶ï¼Œä¼´éšâ€œå®â€çš„éŸ³æ•ˆï¼›  
- æœ€ç»ˆç”¨ç»¿è‰²åƒç´ å—æ˜¾ç¤ºåˆå¹¶åçš„æ€»åŒºé—´é•¿åº¦ï¼Œä»£è¡¨ç­”æ¡ˆã€‚  


## 2. ç²¾é€‰ä¼˜è´¨é¢˜è§£å‚è€ƒ

### é¢˜è§£ä¸€ï¼ˆæ¥æºï¼šfengenrongï¼Œèµ10ï¼‰  
* **ç‚¹è¯„**ï¼šè¿™ä»½é¢˜è§£çš„æ€è·¯éå¸¸æ¸…æ™°ï¼Œç›´æ¥æŠ“ä½äº†â€œè½¬åŒ–é—®é¢˜+æ¨¡åˆ†ç±»+åŒºé—´åˆå¹¶â€çš„æ ¸å¿ƒé€»è¾‘ã€‚ä½œè€…é¦–å…ˆæ¨å¯¼äº†é€‰å–å’Œçš„è¡¨è¾¾å¼ï¼Œç„¶åæŒ‡å‡ºæ¨¡åˆ†ç±»çš„å¿…è¦æ€§ï¼Œæœ€åç”¨åŒºé—´åˆå¹¶è®¡ç®—ç­”æ¡ˆã€‚ä»£ç é£æ ¼è§„èŒƒï¼ˆå¦‚`node`ç»“æ„ä½“å®šä¹‰æ¸…æ™°ï¼Œ`v`æ•°ç»„å­˜å‚¨æ¨¡ç±»åŒºé—´ï¼‰ï¼Œè¾¹ç•Œå¤„ç†ä¸¥è°¨ï¼ˆå¦‚`D=0`çš„ç‰¹åˆ¤ï¼‰ã€‚å…¶äº®ç‚¹åœ¨äº**å°†æ•°å­¦æ¨å¯¼ä¸ç¼–ç¨‹å®ç°å®Œç¾ç»“åˆ**ï¼Œå°¤å…¶æ˜¯æ¨¡åˆ†ç±»çš„å¤„ç†ï¼ˆç”¨`map`è®°å½•æ¨¡å€¼å¯¹åº”çš„åŒºé—´ï¼‰ï¼Œéå¸¸å€¼å¾—å­¦ä¹ ã€‚  

### é¢˜è§£äºŒï¼ˆæ¥æºï¼šAcfboyï¼Œèµ9ï¼‰  
* **ç‚¹è¯„**ï¼šæ­¤é¢˜è§£çš„æ€è€ƒè¿‡ç¨‹å¾ˆæœ‰å¯å‘æ€§â€”â€”ä½œè€…å…ˆå°è¯•å®¹æ–¥ä½†å‘ç°å¤æ‚ï¼Œè½¬è€Œæƒ³åˆ°æ¨¡åˆ†ç±»çš„å…³é”®æŠ€å·§ã€‚ä»£ç ä¸­`map`å­˜å‚¨æ¨¡ç±»åŒºé—´çš„æ–¹å¼ä¸é¢˜è§£ä¸€ç±»ä¼¼ï¼Œä½†å¢åŠ äº†`d<0`æ—¶çš„ç¬¦å·å¤„ç†ï¼ˆå°†`d`è½¬ä¸ºæ­£æ•°ï¼Œé¿å…åŒºé—´åè½¬ï¼‰ï¼Œè€ƒè™‘æ›´å…¨é¢ã€‚å…¶äº®ç‚¹åœ¨äº**å¯¹æ¨¡åˆ†ç±»çš„ç›´è§‚è§£é‡Š**ï¼ˆåŒä¸€æ¨¡ç±»çš„åŒºé—´æ‰å¯èƒ½é‡å ï¼‰ï¼Œå¸®åŠ©å­¦ä¹ è€…ç†è§£ä¸ºä»€ä¹ˆè¦è¿™æ ·åšã€‚  

### é¢˜è§£ä¸‰ï¼ˆæ¥æºï¼šxtx1092515503ï¼Œèµ2ï¼‰  
* **ç‚¹è¯„**ï¼šæ­¤é¢˜è§£çš„ç‰¹è‰²åœ¨äº**å¯¹åŒºé—´èŒƒå›´çš„è¯¦ç»†æ¨å¯¼**ï¼ˆ`pre`å’Œ`suf`å‡½æ•°è®¡ç®—\(s\)çš„æœ€å°/æœ€å¤§å€¼ï¼‰ï¼Œå¹¶å°†é€‰å–å’Œçš„èŒƒå›´è½¬æ¢ä¸ºæ¨¡\(2D\)çš„åŒºé—´ï¼ˆè™½ç„¶æœ€ç»ˆä¸æ¨¡\(D\)çš„æ€è·¯ä¸€è‡´ï¼Œä½†æä¾›äº†å¦ä¸€ç§æ€è€ƒè§’åº¦ï¼‰ã€‚ä»£ç ä¸­`map`å­˜å‚¨æ¨¡ç±»åŒºé—´çš„æ–¹å¼ä¸å‰ä¸¤é¢˜è§£ç±»ä¼¼ï¼Œä½†åŒºé—´åˆå¹¶çš„é€»è¾‘æ›´ç®€æ´ï¼ˆç”¨`rb`å˜é‡ç»´æŠ¤å½“å‰æœ€å³è¾¹ç•Œï¼‰ï¼Œé€‚åˆåˆå­¦è€…å‚è€ƒã€‚  


## 3. æ ¸å¿ƒéš¾ç‚¹è¾¨æä¸è§£é¢˜ç­–ç•¥

### 1. é—®é¢˜è½¬åŒ–ï¼šä»â€œå·®â€åˆ°â€œé€‰å–å’Œâ€  
* **åˆ†æ**ï¼šé¢˜ç›®è¦æ±‚çš„æ˜¯\(S-T\)çš„ä¸åŒå€¼ï¼Œè€Œ\(S+T\)æ˜¯æ€»å’Œï¼ˆå®šå€¼ï¼‰ï¼Œå› æ­¤\(S-T=2S-æ€»å’Œ\)ã€‚è¿™ä¸€æ­¥è½¬åŒ–æ˜¯è§£å†³é—®é¢˜çš„å…³é”®â€”â€”å°†â€œå·®çš„æ•°é‡â€è½¬åŒ–ä¸ºâ€œé€‰å–å’Œçš„æ•°é‡â€ï¼Œç®€åŒ–äº†é—®é¢˜ã€‚  
* ğŸ’¡ **å­¦ä¹ ç¬”è®°**ï¼šé‡åˆ°â€œå’Œä¹‹å·®â€é—®é¢˜æ—¶ï¼Œå…ˆè€ƒè™‘â€œå’Œä¹‹å’Œâ€æ˜¯å¦ä¸ºå®šå€¼ï¼Œä»è€Œå°†é—®é¢˜è½¬åŒ–ä¸ºå•ä¸€å˜é‡çš„é—®é¢˜ã€‚  

### 2. æ¨¡åˆ†ç±»ï¼šä¸ºä»€ä¹ˆè¦æŒ‰\(tX\)æ¨¡\(D\)åˆ†ç±»ï¼Ÿ  
* **åˆ†æ**ï¼šé€‰å–å’Œä¸º\(tX + sD\)ï¼Œå…¶ä¸­\(sD\)æ˜¯\(D\)çš„å€æ•°ã€‚å› æ­¤ï¼Œ\(tX + sD\)æ¨¡\(D\)çš„ç»“æœç­‰äº\(tX\)æ¨¡\(D\)ã€‚åªæœ‰æ¨¡ç›¸åŒçš„\(tX\)ï¼Œå…¶å¯¹åº”çš„\(tX + sD\)æ‰å¯èƒ½é‡å ï¼ˆå› ä¸º\(sD\)çš„å¢é‡æ˜¯\(D\)çš„å€æ•°ï¼‰ã€‚  
* ğŸ’¡ **å­¦ä¹ ç¬”è®°**ï¼šå½“è¡¨è¾¾å¼ä¸­æœ‰â€œå›ºå®šå¢é‡â€ï¼ˆå¦‚\(sD\)çš„å¢é‡æ˜¯\(D\)ï¼‰æ—¶ï¼Œæ¨¡åˆ†ç±»æ˜¯å»é‡çš„æœ‰æ•ˆæ–¹æ³•ã€‚  

### 3. åŒºé—´åˆå¹¶ï¼šå¦‚ä½•å¤„ç†ä¸åŒ\(t\)å¯¹åº”çš„åŒºé—´ï¼Ÿ  
* **åˆ†æ**ï¼šå¯¹äºæ¯ä¸ªæ¨¡ç±»ï¼Œä¸åŒ\(t\)å¯¹åº”çš„åŒºé—´ï¼ˆ\(tX + sD\)çš„èŒƒå›´ï¼‰å¯èƒ½é‡å ã€‚éœ€è¦å°†è¿™äº›åŒºé—´æ’åºï¼Œç„¶ååˆå¹¶é‡å æˆ–ç›¸é‚»çš„åŒºé—´ï¼Œè®¡ç®—æ€»é•¿åº¦ã€‚  
* ğŸ’¡ **å­¦ä¹ ç¬”è®°**ï¼šåŒºé—´åˆå¹¶çš„é€šç”¨æ­¥éª¤æ˜¯â€œæ’åºâ†’éå†åˆå¹¶â†’è®¡ç®—é•¿åº¦â€ï¼Œé€‚ç”¨äºæ‰€æœ‰éœ€è¦åˆå¹¶åŒºé—´çš„é—®é¢˜ã€‚  

### âœ¨ è§£é¢˜æŠ€å·§æ€»ç»“  
- **é—®é¢˜è½¬åŒ–**ï¼šå°†å¤æ‚é—®é¢˜ï¼ˆå¦‚å·®çš„æ•°é‡ï¼‰è½¬åŒ–ä¸ºç®€å•é—®é¢˜ï¼ˆå¦‚é€‰å–å’Œçš„æ•°é‡ï¼‰ï¼›  
- **æ¨¡åˆ†ç±»**ï¼šåˆ©ç”¨æ¨¡è¿ç®—å»é‡ï¼Œå‡å°‘éœ€è¦å¤„ç†çš„åŒºé—´æ•°é‡ï¼›  
- **åŒºé—´åˆå¹¶**ï¼šå¤„ç†é‡å åŒºé—´ï¼Œè®¡ç®—æ€»é•¿åº¦ï¼Œå¾—åˆ°æœ€ç»ˆç­”æ¡ˆã€‚  


## 4. C++æ ¸å¿ƒä»£ç å®ç°èµæ

### æœ¬é¢˜é€šç”¨æ ¸å¿ƒC++å®ç°å‚è€ƒ  
* **è¯´æ˜**ï¼šæœ¬ä»£ç ç»¼åˆäº†é¢˜è§£ä¸€å’Œé¢˜è§£äºŒçš„æ€è·¯ï¼Œå±•ç¤ºäº†â€œæ¨¡åˆ†ç±»+åŒºé—´åˆå¹¶â€çš„æ ¸å¿ƒé€»è¾‘ã€‚  
* **å®Œæ•´æ ¸å¿ƒä»£ç **ï¼š  
  ```cpp
  #include <iostream>
  #include <vector>
  #include <map>
  #include <algorithm>
  using namespace std;
  typedef long long ll;

  struct Node {
      ll l, r;
      bool operator<(const Node& other) const { return l < other.l; }
  };

  int main() {
      ll n, x, d;
      cin >> n >> x >> d;
      if (d == 0) {
          if (x == 0) cout << 1 << endl;
          else cout << n + 1 << endl;
          return 0;
      }
      map<ll, vector<Node>> mod_map;
      for (ll t = 0; t <= n; ++t) {
          ll mod = (t * x) % d;
          if (mod < 0) mod += d;
          ll s_min = t * (t - 1) / 2;
          ll s_max = t * (2 * n - t - 1) / 2;
          ll val_min = t * x + s_min * d;
          ll val_max = t * x + s_max * d;
          if (d < 0) swap(val_min, val_max); // å¤„ç†dä¸ºè´Ÿçš„æƒ…å†µ
          mod_map[mod].push_back({val_min, val_max});
      }
      ll ans = 0;
      for (auto& entry : mod_map) {
          auto& intervals = entry.second;
          sort(intervals.begin(), intervals.end());
          ll curr_l = intervals[0].l, curr_r = intervals[0].r;
          ans += (curr_r - curr_l) / abs(d) + 1;
          for (size_t i = 1; i < intervals.size(); ++i) {
              ll l = intervals[i].l, r = intervals[i].r;
              if (l <= curr_r) {
                  ans += max(r - curr_r, 0LL) / abs(d);
                  curr_r = max(curr_r, r);
              } else {
                  ans += (r - l) / abs(d) + 1;
                  curr_l = l;
                  curr_r = r;
              }
          }
      }
      cout << ans << endl;
      return 0;
  }
  ```  
* **ä»£ç è§£è¯»æ¦‚è¦**ï¼š  
  1. **ç‰¹åˆ¤**ï¼šå¤„ç†\(d=0\)çš„æƒ…å†µï¼ˆæ­¤æ—¶é€‰å–å’Œä¸º\(tX\)ï¼Œç›´æ¥è¾“å‡º\(n+1\)æˆ–1ï¼‰ï¼›  
  2. **æ¨¡åˆ†ç±»**ï¼šéå†æ‰€æœ‰å¯èƒ½çš„\(t\)ï¼ˆé€‰å–å…ƒç´ ä¸ªæ•°ï¼‰ï¼Œè®¡ç®—\(tX\)æ¨¡\(d\)çš„å€¼ï¼Œå°†å¯¹åº”çš„åŒºé—´ï¼ˆ\(tX + sD\)çš„èŒƒå›´ï¼‰å­˜å…¥`mod_map`ï¼›  
  3. **åŒºé—´åˆå¹¶**ï¼šå¯¹æ¯ä¸ªæ¨¡ç±»ä¸­çš„åŒºé—´æ’åºï¼Œåˆå¹¶é‡å åŒºé—´ï¼Œè®¡ç®—æ€»é•¿åº¦ï¼ˆå³ä¸åŒé€‰å–å’Œçš„æ•°é‡ï¼‰ã€‚  

### é¢˜è§£ä¸€ï¼ˆfengenrongï¼‰æ ¸å¿ƒä»£ç ç‰‡æ®µèµæ  
* **äº®ç‚¹**ï¼šç”¨`map`è®°å½•æ¨¡å€¼å¯¹åº”çš„åŒºé—´ï¼Œä»£ç ç»“æ„æ¸…æ™°ã€‚  
* **æ ¸å¿ƒä»£ç ç‰‡æ®µ**ï¼š  
  ```cpp
  map<int, int> M;
  int cnt = 0;
  for (int t = 0; t <= n; ++t) {
      if (!M[t * x % num]) M[t * x % num] = ++cnt;
      v[M[t * x % num]].push_back({t*(t-1)/2 + (t*x/num), (2*n-1-t)*t/2 + (t*x/num)});
  }
  ```  
* **ä»£ç è§£è¯»**ï¼š  
  - `M`ç”¨äºå°†æ¨¡å€¼æ˜ å°„åˆ°å”¯ä¸€çš„ç´¢å¼•ï¼ˆå¦‚æ¨¡0å¯¹åº”ç´¢å¼•1ï¼Œæ¨¡1å¯¹åº”ç´¢å¼•2ï¼‰ï¼›  
  - `v`æ•°ç»„å­˜å‚¨æ¯ä¸ªæ¨¡ç±»çš„åŒºé—´ï¼ˆåŒºé—´çš„å·¦å³ç«¯ç‚¹æ˜¯\(s + tX/d\)ï¼Œå› ä¸º\(tX + sD = D*(s + tX/d) + (tX mod D)\)ï¼Œæ¨¡ç›¸åŒçš„æƒ…å†µä¸‹ï¼ŒåŒºé—´çš„åˆå¹¶å¯ä»¥è½¬åŒ–ä¸º\(s + tX/d\)çš„åˆå¹¶ï¼‰ã€‚  
* ğŸ’¡ **å­¦ä¹ ç¬”è®°**ï¼šå½“\(D\)è¾ƒå¤§æ—¶ï¼Œç›´æ¥å­˜å‚¨\(tX + sD\)çš„åŒºé—´å¯èƒ½ä¼šæº¢å‡ºï¼Œæ­¤æ—¶å¯ä»¥å°†åŒºé—´è½¬æ¢ä¸º\(s + tX/d\)ï¼ˆå³é™¤ä»¥\(D\)åçš„å•†ï¼‰ï¼Œå‡å°‘æ•°å€¼å¤§å°ã€‚  

### é¢˜è§£äºŒï¼ˆAcfboyï¼‰æ ¸å¿ƒä»£ç ç‰‡æ®µèµæ  
* **äº®ç‚¹**ï¼šå¤„ç†\(d<0\)çš„æƒ…å†µï¼Œå°†\(d\)è½¬ä¸ºæ­£æ•°ï¼Œé¿å…åŒºé—´åè½¬ã€‚  
* **æ ¸å¿ƒä»£ç ç‰‡æ®µ**ï¼š  
  ```cpp
  if (d < 0) x = -x, d = -d;
  for (int i = 0; i <= n; ++i) {
      int t = i * x, L = (i-1)*i/2 + t/d, R = i*n - (i+1)*i/2 + t/d;
      t %= d;
      if (t < 0) t += d;
      map[t].push_back(make_pair(L, R));
  }
  ```  
* **ä»£ç è§£è¯»**ï¼š  
  - å½“\(d<0\)æ—¶ï¼Œå°†\(x\)å–åï¼Œ\(d\)å–åï¼Œè¿™æ ·\(d\)å˜ä¸ºæ­£æ•°ï¼Œé¿å…åç»­åŒºé—´å¤„ç†æ—¶å‡ºç°å·¦ç«¯ç‚¹å¤§äºå³ç«¯ç‚¹çš„æƒ…å†µï¼›  
  - `L`å’Œ`R`æ˜¯\(s + tX/d\)çš„èŒƒå›´ï¼ˆå³é™¤ä»¥\(D\)åçš„å•†ï¼‰ï¼Œè¿™æ ·åŒºé—´åˆå¹¶çš„é€»è¾‘æ›´ç®€å•ã€‚  
* ğŸ’¡ **å­¦ä¹ ç¬”è®°**ï¼šå¤„ç†è´Ÿæ•°å…¬å·®æ—¶ï¼Œå¯ä»¥é€šè¿‡ç¬¦å·è½¬æ¢å°†å…¶è½¬ä¸ºæ­£æ•°ï¼Œç®€åŒ–åŒºé—´å¤„ç†ã€‚  


## 5. ç®—æ³•å¯è§†åŒ–ï¼šåƒç´ åŠ¨ç”»æ¼”ç¤º (æ ¸å¿ƒéƒ¨åˆ†)

### åŠ¨ç”»æ¼”ç¤ºä¸»é¢˜  
**â€œåƒç´ æ•°å­¦å®¶çš„åŒºé—´åˆå¹¶æ¸¸æˆâ€**ï¼ˆä»¿FCçº¢ç™½æœºé£æ ¼ï¼‰  

### æ ¸å¿ƒæ¼”ç¤ºå†…å®¹  
- **æ¨¡åˆ†ç±»**ï¼šå±•ç¤ºä¸åŒ\(t\)å¯¹åº”çš„æ¨¡å€¼ï¼ˆå¦‚\(t=0\)æ—¶æ¨¡0ï¼Œ\(t=1\)æ—¶æ¨¡\(X\)ï¼‰ï¼Œç”¨ä¸åŒé¢œè‰²çš„åƒç´ å—è¡¨ç¤ºï¼›  
- **åŒºé—´ç”Ÿæˆ**ï¼šæ¯ä¸ª\(t\)å¯¹åº”çš„åŒºé—´ï¼ˆ\(tX + sD\)çš„èŒƒå›´ï¼‰ç”¨åƒç´ çº¿æ®µè¡¨ç¤ºï¼Œçº¿æ®µçš„é¢œè‰²ä¸æ¨¡å€¼å¯¹åº”ï¼›  
- **åŒºé—´åˆå¹¶**ï¼šåŠ¨ç”»æ¼”ç¤ºçº¿æ®µåˆå¹¶çš„è¿‡ç¨‹ï¼ˆå¦‚çº¢è‰²çº¿æ®µä¸è“è‰²çº¿æ®µé‡å æ—¶ï¼Œåˆå¹¶ä¸ºç´«è‰²çº¿æ®µï¼‰ï¼Œä¼´éšâ€œå®â€çš„éŸ³æ•ˆï¼›  
- **ç»“æœå±•ç¤º**ï¼šåˆå¹¶åçš„æ€»çº¿æ®µé•¿åº¦ç”¨ç»¿è‰²åƒç´ å—æ˜¾ç¤ºï¼Œä»£è¡¨ç­”æ¡ˆã€‚  

### è®¾è®¡æ€è·¯ç®€è¿°  
- **8ä½åƒç´ é£æ ¼**ï¼šè¥é€ å¤å¤æ¸¸æˆæ°›å›´ï¼Œé™ä½å­¦ä¹ å‹åŠ›ï¼›  
- **é¢œè‰²ç¼–ç **ï¼šç”¨ä¸åŒé¢œè‰²åŒºåˆ†æ¨¡ç±»ï¼Œå¸®åŠ©å­¦ä¹ è€…ç›´è§‚ç†è§£æ¨¡åˆ†ç±»çš„ä½œç”¨ï¼›  
- **éŸ³æ•ˆåé¦ˆ**ï¼šå…³é”®æ“ä½œï¼ˆå¦‚åŒºé—´ç”Ÿæˆã€åˆå¹¶ï¼‰ä¼´éšéŸ³æ•ˆï¼Œå¼ºåŒ–è®°å¿†ï¼›  
- **æ¸¸æˆåŒ–å…ƒç´ **ï¼šè®¾ç½®â€œå…³å¡â€ï¼ˆå¦‚å®Œæˆæ¨¡åˆ†ç±»â†’å®ŒæˆåŒºé—´åˆå¹¶â†’å¾—åˆ°ç­”æ¡ˆï¼‰ï¼Œå¢åŠ æˆå°±æ„Ÿã€‚  

### åŠ¨ç”»å¸§æ­¥éª¤ä¸äº¤äº’å…³é”®ç‚¹  
1. **åœºæ™¯åˆå§‹åŒ–**ï¼šå±å¹•å·¦ä¾§æ˜¾ç¤ºâ€œæ¨¡åˆ†ç±»â€åŒºåŸŸï¼ˆä¸åŒé¢œè‰²çš„åƒç´ å—ä»£è¡¨ä¸åŒæ¨¡å€¼ï¼‰ï¼Œå³ä¾§æ˜¾ç¤ºâ€œåŒºé—´åˆå¹¶â€åŒºåŸŸï¼ˆç©ºç™½ç”»å¸ƒï¼‰ï¼›  
2. **æ¨¡åˆ†ç±»æ¼”ç¤º**ï¼šå½“\(t\)ä»0åˆ°\(n\)å˜åŒ–æ—¶ï¼Œå¯¹åº”çš„æ¨¡å€¼åƒç´ å—ä¼šâ€œé—ªçƒâ€ï¼Œå¹¶åœ¨å³ä¾§ç”»å¸ƒä¸Šç”Ÿæˆå¯¹åº”çš„åŒºé—´çº¿æ®µï¼›  
3. **åŒºé—´åˆå¹¶æ¼”ç¤º**ï¼šå½“æ–°çº¿æ®µä¸å·²æœ‰çº¿æ®µé‡å æ—¶ï¼Œçº¿æ®µä¼šâ€œå»¶ä¼¸â€åˆå¹¶ï¼Œä¼´éšâ€œå®â€çš„éŸ³æ•ˆï¼›  
4. **ç»“æœå±•ç¤º**ï¼šåˆå¹¶å®Œæˆåï¼Œå³ä¾§ç”»å¸ƒä¸Šçš„æ€»çº¿æ®µé•¿åº¦ç”¨ç»¿è‰²åƒç´ å—æ˜¾ç¤ºï¼Œå±å¹•ä¸Šæ–¹æ˜¾ç¤ºâ€œç­”æ¡ˆï¼šXXâ€ï¼Œä¼´éšâ€œèƒœåˆ©â€éŸ³æ•ˆã€‚  

### æ—ç™½æç¤º  
- â€œç°åœ¨å¤„ç†\(t=1\)ï¼Œæ¨¡å€¼æ˜¯\(X\)ï¼Œå¯¹åº”çš„åŒºé—´æ˜¯[...,...]â€ï¼›  
- â€œè¿™æ¡çº¿æ®µä¸ä¹‹å‰çš„çº¿æ®µé‡å äº†ï¼Œåˆå¹¶å®ƒä»¬ï¼â€ï¼›  
- â€œåˆå¹¶å®Œæˆï¼Œæ€»é•¿åº¦æ˜¯XXï¼Œè¿™å°±æ˜¯ç­”æ¡ˆï¼â€ã€‚  


## 6. æ‹“å±•ç»ƒä¹ ä¸ç›¸ä¼¼é—®é¢˜æ€è€ƒ

### é€šç”¨æ€è·¯/æŠ€å·§è¿ç§»  
- **é—®é¢˜è½¬åŒ–**ï¼šé€‚ç”¨äºæ‰€æœ‰â€œå’Œä¹‹å·®â€é—®é¢˜ï¼ˆå¦‚æ±‚\(a-b\)çš„æ•°é‡ï¼Œè½¬åŒ–ä¸º\(2a-(a+b)\)ï¼‰ï¼›  
- **æ¨¡åˆ†ç±»**ï¼šé€‚ç”¨äºæ‰€æœ‰â€œè¡¨è¾¾å¼ä¸­æœ‰å›ºå®šå¢é‡â€çš„é—®é¢˜ï¼ˆå¦‚æ±‚\(ax + by\)çš„ä¸åŒå€¼ï¼Œå…¶ä¸­\(y\)çš„å¢é‡æ˜¯å›ºå®šçš„ï¼‰ï¼›  
- **åŒºé—´åˆå¹¶**ï¼šé€‚ç”¨äºæ‰€æœ‰éœ€è¦å¤„ç†é‡å åŒºé—´çš„é—®é¢˜ï¼ˆå¦‚çº¿æ®µè¦†ç›–ã€åŒºé—´æ±‚å’Œï¼‰ã€‚  

### ç»ƒä¹ æ¨è (æ´›è°·)  
1. **æ´›è°· P1803 çº¿æ®µè¦†ç›–**  
   - ğŸ—£ï¸ **æ¨èç†ç”±**ï¼šè¿™é“é¢˜æ˜¯åŒºé—´åˆå¹¶çš„ç»å…¸é—®é¢˜ï¼Œå¯ä»¥å¸®åŠ©ä½ å·©å›ºåŒºé—´åˆå¹¶çš„é€»è¾‘ï¼ˆæ’åºâ†’éå†åˆå¹¶â†’è®¡ç®—é•¿åº¦ï¼‰ã€‚  
2. **æ´›è°· P2082 åŒºé—´è¦†ç›–é—®é¢˜**  
   - ğŸ—£ï¸ **æ¨èç†ç”±**ï¼šæ­¤é¢˜è¦æ±‚ç”¨æœ€å°‘çš„çº¿æ®µè¦†ç›–æ•´ä¸ªåŒºé—´ï¼Œæ˜¯åŒºé—´åˆå¹¶çš„å˜å½¢ï¼Œå¸®åŠ©ä½ ç†è§£åŒºé—´åˆå¹¶çš„åº”ç”¨åœºæ™¯ã€‚  
3. **æ´›è°· P3369 æ™®é€šå¹³è¡¡æ ‘**  
   - ğŸ—£ï¸ **æ¨èç†ç”±**ï¼šæ­¤é¢˜æ¶‰åŠåŒºé—´æŸ¥è¯¢å’Œä¿®æ”¹ï¼Œè™½ç„¶ä¸æœ¬é¢˜æ€è·¯ä¸åŒï¼Œä½†å¯ä»¥å¸®åŠ©ä½ ç†Ÿæ‚‰æ•°æ®ç»“æ„åœ¨åŒºé—´å¤„ç†ä¸­çš„åº”ç”¨ã€‚  


## 7. å­¦ä¹ å¿ƒå¾—ä¸ç»éªŒåˆ†äº« (è‹¥æœ‰)  
**å‚è€ƒç»éªŒ (æ¥è‡ª Acfboy)**ï¼šâ€œæˆ‘åœ¨è€ƒåœºä¸Šä¸€å¼€å§‹å°è¯•å®¹æ–¥ï¼Œä½†å‘ç°ç»†èŠ‚å¤ªå¤šï¼Œåæ¥æƒ³åˆ°æ¨¡åˆ†ç±»çš„æŠ€å·§ï¼Œæ‰è§£å†³äº†é—®é¢˜ã€‚â€  
**ç‚¹è¯„**ï¼šè¿™ä½ä½œè€…çš„ç»éªŒå¾ˆå…¸å‹â€”â€”å½“ç›´æ¥æ–¹æ³•ï¼ˆå¦‚å®¹æ–¥ï¼‰å¤æ‚æ—¶ï¼Œåº”è¯¥å°è¯•å¯»æ‰¾é—®é¢˜çš„â€œä¸å˜é‡â€ï¼ˆå¦‚æ¨¡å€¼ï¼‰ï¼Œä»è€Œç®€åŒ–é—®é¢˜ã€‚æ¨¡åˆ†ç±»æ˜¯å¤„ç†é‡å¤å€¼çš„æœ‰æ•ˆæŠ€å·§ï¼Œå€¼å¾—å­¦ä¹ è€…æŒæ¡ã€‚  


## ç»“è¯­  
æœ¬æ¬¡å…³äºâ€œ[ABC147F] Sum Differenceâ€çš„C++è§£é¢˜åˆ†æå°±åˆ°è¿™é‡Œã€‚å¸Œæœ›è¿™ä»½å­¦ä¹ æŒ‡å—èƒ½å¸®åŠ©ä½ ç†è§£â€œæ•°å­¦è½¬åŒ–+æ¨¡åˆ†ç±»+åŒºé—´åˆå¹¶â€çš„æ ¸å¿ƒé€»è¾‘ï¼Œå¹¶æŒæ¡ç›¸å…³è§£é¢˜æŠ€å·§ã€‚è®°ä½ï¼Œç¼–ç¨‹çš„å…³é”®æ˜¯â€œæ€è·¯è½¬åŒ–â€â€”â€”å°†å¤æ‚é—®é¢˜è½¬åŒ–ä¸ºç®€å•é—®é¢˜ï¼Œå†ç”¨åˆé€‚çš„ç®—æ³•è§£å†³ã€‚ä¸‹æ¬¡æˆ‘ä»¬å†ä¸€èµ·æ¢ç´¢æ–°çš„ç¼–ç¨‹æŒ‘æˆ˜ï¼ğŸ’ª

---
å¤„ç†ç”¨æ—¶ï¼š131.92ç§’
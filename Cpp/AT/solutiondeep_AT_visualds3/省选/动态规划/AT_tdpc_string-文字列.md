# é¢˜ç›®ä¿¡æ¯

# æ–‡å­—åˆ—

## é¢˜ç›®æè¿°

[problemUrl]: https://atcoder.jp/contests/tdpc/tasks/tdpc_string

å…¥åŠ›ã¯ä»¥ä¸‹ã®å½¢å¼ã§æ¨™æº–å…¥åŠ›ã‹ã‚‰ä¸ãˆã‚‰ã‚Œã‚‹ã€‚

> $ freq_1 $ $ ... $ $ freq_{26} $

 ç­”ãˆã‚’ä¸€è¡Œã«å‡ºåŠ›ã›ã‚ˆã€‚ ```

1 0 2 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
```

```

6
```

```

1 1 1 1 1 1 1 1 1 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
```

```

3628800
```

## è¯´æ˜/æç¤º

### Constraints

 ä»¥ä¸‹ã®æ¡ä»¶ã‚’æº€ãŸã™æ–‡å­—åˆ—ã®å€‹æ•°ã‚’ mod 1,000,000,007 ã§æ±‚ã‚ã‚ˆã€‚

- a ã‚’ $ freq_1 $ å€‹ã€b ã‚’ $ freq_2 $ å€‹ã€... z ã‚’ $ freq_{26} $ å€‹å«ã‚€ (ä»–ã®æ–‡å­—ã¯å«ã¾ãªã„)ã€‚
- åŒã˜æ–‡å­—ãŒéš£ã‚Šåˆã†ã“ã¨ã¯ãªã„ã€‚

- - - - - -

- $ 0\ <\ =\ freq_i\ <\ =\ 10 $
- At least one of $ freq_i $ will be nonzero.

# AIåˆ†æç»“æœ

# ğŸ’¡ Kayçš„C++ç®—æ³•è§£æï¼šæ–‡å­—åˆ— æ·±å…¥å­¦ä¹ æŒ‡å— ğŸ’¡


## 1. é¢˜ç›®è§£è¯»ä¸æ ¸å¿ƒç®—æ³•è¯†åˆ«

âœ¨ **æœ¬é¢˜ä¸»è¦è€ƒå¯Ÿ**ï¼šåŠ¨æ€è§„åˆ’ï¼ˆDPï¼‰ä¸ç»„åˆæ•°å­¦çš„ç»¼åˆåº”ç”¨  

ğŸ—£ï¸ **åˆæ­¥åˆ†æ**ï¼š  
è§£å†³â€œæ–‡å­—åˆ—â€é—®é¢˜çš„å…³é”®ï¼Œåœ¨äº**ç”¨åŠ¨æ€è§„åˆ’è®°å½•â€œç›¸é‚»ç›¸åŒå­—æ¯å¯¹â€çš„çŠ¶æ€**ï¼Œå¹¶é€šè¿‡ç»„åˆæ•°å­¦è®¡ç®—æ’å…¥æ–°å­—æ¯çš„åˆæ³•æ–¹å¼ã€‚ç®€å•æ¥è¯´ï¼Œè¿™å°±åƒ**æ­ç§¯æœ¨**â€”â€”æ¯æ¬¡æ·»åŠ ä¸€ç§æ–°é¢œè‰²çš„ç§¯æœ¨æ—¶ï¼Œè¦é¿å…ç›¸åŒé¢œè‰²çš„ç§¯æœ¨ç›´æ¥å åœ¨ä¸€èµ·ã€‚æˆ‘ä»¬éœ€è¦è®°å½•å½“å‰æœ‰å¤šå°‘å¤„â€œç›¸åŒé¢œè‰²ç›¸é‚»â€çš„æƒ…å†µï¼ˆè®°ä¸º`k`ï¼‰ï¼Œç„¶åè®¡ç®—å¦‚ä½•æ’å…¥æ–°ç§¯æœ¨æ‰èƒ½å‡å°‘æˆ–æ§åˆ¶è¿™ç§æƒ…å†µï¼Œæœ€ç»ˆè®©`k`å˜ä¸º0ï¼ˆæ‰€æœ‰ç›¸é‚»ç§¯æœ¨é¢œè‰²éƒ½ä¸åŒï¼‰ã€‚  

### æ ¸å¿ƒæ€è·¯ä¸éš¾ç‚¹  
- **çŠ¶æ€å®šä¹‰**ï¼šå‡ ä¹æ‰€æœ‰ä¼˜è´¨é¢˜è§£éƒ½é‡‡ç”¨äº†`f[i][k]`è¡¨ç¤ºâ€œå¤„ç†å®Œå‰`i`ç§å­—æ¯åï¼Œå­—ç¬¦ä¸²ä¸­æœ‰`k`ä¸ªç›¸é‚»ç›¸åŒå­—æ¯å¯¹â€çš„æ–¹æ¡ˆæ•°ã€‚è¿™æ˜¯å› ä¸º`k`èƒ½æœ‰æ•ˆåæ˜ å½“å‰å­—ç¬¦ä¸²çš„â€œä¸åˆæ³•ç¨‹åº¦â€ï¼Œä¸”è½¬ç§»æ—¶å¯ä»¥é€šè¿‡ç»„åˆæ•°è®¡ç®—æ’å…¥æ–°å­—æ¯çš„æ–¹å¼ã€‚  
- **è½¬ç§»é€»è¾‘**ï¼šå½“æ’å…¥ç¬¬`i`ç§å­—æ¯ï¼ˆå…±`freq[i]`ä¸ªï¼‰æ—¶ï¼Œéœ€è¦è€ƒè™‘ï¼š  
  1. å¦‚ä½•å°†æ–°å­—æ¯åˆ†æˆè‹¥å¹²æ®µï¼ˆæ¯”å¦‚`x`æ®µï¼‰ï¼Œé¿å…è‡ªèº«ç›¸é‚»ï¼ˆæ®µæ•°è¶Šå¤šï¼Œè‡ªèº«ç›¸é‚»çš„æƒ…å†µè¶Šå°‘ï¼‰ï¼›  
  2. å¦‚ä½•å°†è¿™äº›æ®µæ’å…¥åˆ°å‰`i-1`ç§å­—æ¯ç»„æˆçš„å­—ç¬¦ä¸²çš„ç©ºéš™ä¸­ï¼ˆåˆæ³•ç©ºéš™æ˜¯æŒ‡ä¸ç›¸é‚»çš„ä½ç½®ï¼Œéæ³•ç©ºéš™æ˜¯æŒ‡ç›¸é‚»ç›¸åŒçš„ä½ç½®ï¼‰ã€‚  
- **ç»„åˆæ•°è®¡ç®—**ï¼šæ’å…¥æ®µçš„ä½ç½®é€‰æ‹©éœ€è¦ç”¨åˆ°ç»„åˆæ•°ï¼ˆæ¯”å¦‚ä»`k`ä¸ªéæ³•ç©ºéš™ä¸­é€‰`y`ä¸ªæ’å…¥ï¼Œä»`sum[i-1]+1-k`ä¸ªåˆæ³•ç©ºéš™ä¸­é€‰`x-y`ä¸ªæ’å…¥ï¼‰ï¼Œè¿™æ˜¯è½¬ç§»çš„æ ¸å¿ƒéš¾ç‚¹ã€‚  

### å¯è§†åŒ–è®¾è®¡æ€è·¯  
ä¸ºäº†ç›´è§‚å±•ç¤ºç®—æ³•è¿‡ç¨‹ï¼Œæˆ‘ä»¬å¯ä»¥è®¾è®¡ä¸€ä¸ª**åƒç´ é£æ ¼çš„â€œç§¯æœ¨æ’å…¥æ¸¸æˆâ€**ï¼š  
- **åœºæ™¯**ï¼šå±å¹•å·¦ä¾§æ˜¾ç¤ºå½“å‰å­—ç¬¦ä¸²ï¼ˆç”¨ä¸åŒé¢œè‰²çš„åƒç´ å—è¡¨ç¤ºå­—æ¯ï¼‰ï¼Œå³ä¾§æ˜¾ç¤ºçŠ¶æ€é¢æ¿ï¼ˆå½“å‰å¤„ç†çš„å­—æ¯ã€å‰©ä½™æ•°é‡ã€ç›¸é‚»ç›¸åŒå¯¹æ•°`k`ï¼‰ã€‚  
- **åŠ¨ç”»æ­¥éª¤**ï¼š  
  1. åˆå§‹æ—¶ï¼Œç¬¬ä¸€ä¸ªå­—æ¯çš„åƒç´ å—æ’æˆä¸€è¡Œï¼Œç›¸é‚»ç›¸åŒçš„ä½ç½®ç”¨çº¢è‰²æ ‡è®°ï¼ˆæ¯”å¦‚`aaa`ä¼šæœ‰2ä¸ªçº¢è‰²æ ‡è®°ï¼‰ï¼›  
  2. æ’å…¥æ–°å­—æ¯æ—¶ï¼Œç”¨é»„è‰²æ¡†æ ‡è®°å¯é€‰çš„æ’å…¥ç©ºéš™ï¼ˆåˆæ³•ç©ºéš™ä¸ºç»¿è‰²ï¼Œéæ³•ç©ºéš™ä¸ºçº¢è‰²ï¼‰ï¼›  
  3. é€‰æ‹©æ’å…¥ä½ç½®åï¼Œæ–°å­—æ¯çš„åƒç´ å—æ»‘å…¥ç©ºéš™ï¼Œçº¢è‰²æ ‡è®°çš„æ•°é‡æ ¹æ®æ’å…¥æ–¹å¼å˜åŒ–ï¼ˆæ¯”å¦‚æ’å…¥åˆ°éæ³•ç©ºéš™ä¼šå‡å°‘çº¢è‰²æ ‡è®°ï¼Œæ’å…¥åˆ°åˆæ³•ç©ºéš™å¯èƒ½å¢åŠ çº¢è‰²æ ‡è®°ï¼‰ï¼›  
- **äº¤äº’è®¾è®¡**ï¼šæ”¯æŒâ€œå•æ­¥æ‰§è¡Œâ€ï¼ˆé€æ­¥å±•ç¤ºæ’å…¥è¿‡ç¨‹ï¼‰ã€â€œè‡ªåŠ¨æ’­æ”¾â€ï¼ˆåŠ é€Ÿæ¼”ç¤ºï¼‰ï¼Œå¹¶æ·»åŠ éŸ³æ•ˆï¼ˆæ’å…¥æˆåŠŸçš„â€œå®â€å£°ã€çº¢è‰²æ ‡è®°å‡å°‘çš„â€œå’»â€å£°ï¼‰ã€‚  


## 2. ç²¾é€‰ä¼˜è´¨é¢˜è§£å‚è€ƒ

### é¢˜è§£ä¸€ï¼šEricQianï¼ˆèµï¼š4ï¼‰  
* **ç‚¹è¯„**ï¼š  
  è¿™ä»½é¢˜è§£çš„**æ€è·¯æ¸…æ™°æ€§**å’Œ**ä»£ç ç®€æ´æ€§**å ªç§°å…¸èŒƒã€‚ä½œè€…å°†çŠ¶æ€å®šä¹‰ä¸º`f[i][k]`ï¼ˆå¤„ç†å‰`i`ç§å­—æ¯åæœ‰`k`ä¸ªç›¸é‚»ç›¸åŒå¯¹ï¼‰ï¼Œå¹¶é€šè¿‡ç»„åˆæ•°è®¡ç®—æ’å…¥æ–°å­—æ¯çš„æ–¹æ¡ˆæ•°ã€‚è½¬ç§»æ—¶æšä¸¾äº†â€œæ‹†åˆ†éæ³•ç©ºéš™â€ï¼ˆ`p`ï¼‰ã€â€œç»„åˆæ–°å­—æ¯æ®µâ€ï¼ˆ`q`ï¼‰ã€â€œæ’å…¥åˆæ³•ç©ºéš™â€ï¼ˆ`o`ï¼‰ä¸‰ç§æƒ…å†µï¼Œè¦†ç›–äº†æ‰€æœ‰å¯èƒ½çš„æ’å…¥æ–¹å¼ã€‚ä»£ç ä¸­ç»„åˆæ•°çš„é¢„å¤„ç†ï¼ˆ`C`æ•°ç»„ï¼‰å’ŒçŠ¶æ€è½¬ç§»çš„å¾ªç¯é€»è¾‘éå¸¸è§„èŒƒï¼Œå˜é‡å‘½åï¼ˆå¦‚`hav`è¡¨ç¤ºå­—æ¯æ•°é‡ã€`sum`è¡¨ç¤ºæ€»é•¿åº¦ï¼‰ä¹Ÿå¾ˆæ˜“æ‡‚ã€‚**äº®ç‚¹**ï¼šç”¨â€œæ®µæ•°â€å’Œâ€œç©ºéš™é€‰æ‹©â€çš„ç»„åˆæ•°å­¦æ¨¡å‹ï¼Œå®Œç¾è§£å†³äº†æ’å…¥æ–°å­—æ¯çš„åˆæ³•æ€§é—®é¢˜ã€‚  

### é¢˜è§£äºŒï¼šinclude_BMï¼ˆèµï¼š4ï¼‰  
* **ç‚¹è¯„**ï¼š  
  ä½œè€…é‡‡ç”¨äº†å››ç»´çŠ¶æ€`f[i][j][k][l]`ï¼ˆå¤„ç†åˆ°ç¬¬`i`ç§å­—æ¯ï¼Œå·²æ”¾`j`ä¸ªï¼Œå‰`i-1`ç§æœ‰`k`ä¸ªç›¸é‚»å¯¹ï¼Œç¬¬`i`ç§æœ‰`l`ä¸ªç›¸é‚»å¯¹ï¼‰ï¼Œè™½ç„¶çŠ¶æ€æ›´å¤æ‚ï¼Œä½†**è€ƒè™‘äº†å­—æ¯çš„é¡ºåºé—®é¢˜**ï¼ˆæœ€åé™¤ä»¥`freq[i]!`çš„é€†å…ƒï¼‰ã€‚ä»£ç ä¸­â€œAddâ€å‡½æ•°çš„ä½¿ç”¨ï¼ˆæ¨¡è¿ç®—çš„å°è£…ï¼‰å’ŒçŠ¶æ€è½¬ç§»çš„åˆ†æƒ…å†µè®¨è®ºï¼ˆæ”¾å½“å‰å­—æ¯æˆ–ä¸‹ä¸€ä¸ªå­—æ¯ï¼‰å¾ˆä¸¥è°¨ã€‚**äº®ç‚¹**ï¼šé€šè¿‡â€œæ— åºå­—æ¯â€çš„å¤„ç†ï¼ˆé™¤ä»¥é˜¶ä¹˜é€†å…ƒï¼‰ï¼Œè§£å†³äº†åŒç§å­—æ¯é—´çš„é¡ºåºé‡å¤é—®é¢˜ã€‚  

### é¢˜è§£ä¸‰ï¼šylxmf2005ï¼ˆèµï¼š2ï¼‰  
* **ç‚¹è¯„**ï¼š  
  ä½œè€…çš„çŠ¶æ€å®šä¹‰ï¼ˆ`f[i][j]`è¡¨ç¤ºå¤„ç†`i`ç§å­—æ¯åæœ‰`j`ä¸ªç›¸é‚»å¯¹ï¼‰ä¸EricQiançš„é¢˜è§£ä¸€è‡´ï¼Œä½†**è½¬ç§»é€»è¾‘æ›´ç›´è§‚**ï¼ˆæšä¸¾â€œæ’å…¥åˆ°åˆæ³•ç©ºéš™çš„æ®µæ•°`good`â€å’Œâ€œæ’å…¥åˆ°éæ³•ç©ºéš™çš„æ®µæ•°`bad`â€ï¼‰ã€‚ä»£ç ä¸­ç»„åˆæ•°çš„è®¡ç®—ï¼ˆ`C[freq[i]-1][good+bad-1]`è¡¨ç¤ºå°†`freq[i]`ä¸ªå­—æ¯åˆ†æˆ`good+bad`æ®µï¼‰å¾ˆæ¸…æ™°ï¼Œæ³¨é‡Šä¹Ÿè¯¦ç»†è§£é‡Šäº†è½¬ç§»æ–¹ç¨‹çš„æ¨å¯¼è¿‡ç¨‹ã€‚**äº®ç‚¹**ï¼šç”¨â€œæ’æ¿æ³•â€è§£é‡Šäº†æ–°å­—æ¯æ®µçš„åˆ’åˆ†æ–¹å¼ï¼Œé€‚åˆåˆå­¦è€…ç†è§£ã€‚  


## 3. æ ¸å¿ƒéš¾ç‚¹è¾¨æä¸è§£é¢˜ç­–ç•¥

### 1. **å…³é”®ç‚¹1ï¼šå¦‚ä½•å®šä¹‰çŠ¶æ€ï¼Ÿ**  
- **åˆ†æ**ï¼šçŠ¶æ€éœ€è¦åæ˜ å½“å‰å­—ç¬¦ä¸²çš„â€œä¸åˆæ³•ç¨‹åº¦â€ï¼Œè€Œâ€œç›¸é‚»ç›¸åŒå­—æ¯å¯¹çš„æ•°é‡`k`â€æ˜¯æœ€æœ‰æ•ˆçš„æŒ‡æ ‡ã€‚å› ä¸ºæ’å…¥æ–°å­—æ¯æ—¶ï¼Œ`k`çš„å˜åŒ–å¯ä»¥é€šè¿‡ç»„åˆæ•°è®¡ç®—ï¼ˆæ¯”å¦‚æ’å…¥åˆ°éæ³•ç©ºéš™ä¼šå‡å°‘`k`ï¼Œæ’å…¥åˆ°åˆæ³•ç©ºéš™å¯èƒ½å¢åŠ `k`ï¼‰ã€‚ä¼˜è´¨é¢˜è§£éƒ½é€‰æ‹©äº†`f[i][k]`ä½œä¸ºçŠ¶æ€ï¼Œå› ä¸ºå®ƒæ»¡è¶³â€œæ— åæ•ˆæ€§â€ï¼ˆå½“å‰çŠ¶æ€åªä¸å‰`i-1`ç§å­—æ¯çš„çŠ¶æ€æœ‰å…³ï¼‰ã€‚  
- ğŸ’¡ **å­¦ä¹ ç¬”è®°**ï¼šçŠ¶æ€å®šä¹‰è¦æŠ“ä½é—®é¢˜çš„â€œæ ¸å¿ƒçŸ›ç›¾â€ï¼ˆè¿™é‡Œæ˜¯â€œç›¸é‚»ç›¸åŒå­—æ¯å¯¹â€ï¼‰ï¼Œè¿™æ ·æ‰èƒ½ç®€åŒ–è½¬ç§»é€»è¾‘ã€‚  

### 2. **å…³é”®ç‚¹2ï¼šå¦‚ä½•è®¡ç®—æ’å…¥æ–°å­—æ¯çš„æ–¹æ¡ˆæ•°ï¼Ÿ**  
- **åˆ†æ**ï¼šæ’å…¥æ–°å­—æ¯æ—¶ï¼Œéœ€è¦è€ƒè™‘â€œåˆ†å¤šå°‘æ®µâ€ï¼ˆ`x`æ®µï¼‰å’Œâ€œæ’å…¥åˆ°å“ªäº›ç©ºéš™â€ï¼ˆåˆæ³•/éæ³•ç©ºéš™ï¼‰ã€‚ä¾‹å¦‚ï¼Œå°†`freq[i]`ä¸ªå­—æ¯åˆ†æˆ`x`æ®µï¼Œéœ€è¦`C[freq[i]-1][x-1]`ç§æ–¹å¼ï¼ˆæ’æ¿æ³•ï¼‰ï¼›ä»`k`ä¸ªéæ³•ç©ºéš™ä¸­é€‰`y`ä¸ªæ’å…¥ï¼Œéœ€è¦`C[k][y]`ç§æ–¹å¼ï¼›ä»`sum[i-1]+1-k`ä¸ªåˆæ³•ç©ºéš™ä¸­é€‰`x-y`ä¸ªæ’å…¥ï¼Œéœ€è¦`C[sum[i-1]+1-k][x-y]`ç§æ–¹å¼ã€‚è¿™äº›ç»„åˆæ•°çš„ä¹˜ç§¯å°±æ˜¯è¯¥æ’å…¥æ–¹å¼çš„æ–¹æ¡ˆæ•°ã€‚  
- ğŸ’¡ **å­¦ä¹ ç¬”è®°**ï¼šç»„åˆæ•°æ˜¯è§£å†³â€œé€‰æ‹©é—®é¢˜â€çš„å…³é”®å·¥å…·ï¼Œéœ€è¦æå‰é¢„å¤„ç†ï¼ˆé¿å…é‡å¤è®¡ç®—ï¼‰ã€‚  

### 3. **å…³é”®ç‚¹3ï¼šå¦‚ä½•å¤„ç†åŒç§å­—æ¯çš„é¡ºåºé—®é¢˜ï¼Ÿ**  
- **åˆ†æ**ï¼šæœ‰äº›é¢˜è§£ï¼ˆå¦‚include_BMï¼‰è€ƒè™‘äº†åŒç§å­—æ¯çš„é¡ºåºé—®é¢˜ï¼ˆæ¯”å¦‚â€œaaaâ€çš„æ’åˆ—æ–¹å¼åªæœ‰1ç§ï¼Œä½†åŠ¨æ€è§„åˆ’ä¸­å¯èƒ½ä¼šç®—æˆå¤šç§ï¼‰ï¼Œå› æ­¤éœ€è¦é™¤ä»¥`freq[i]!`çš„é€†å…ƒã€‚è¿™ä¸€æ­¥å¾ˆå®¹æ˜“è¢«å¿½ç•¥ï¼Œä½†å´æ˜¯ä¿è¯ç­”æ¡ˆæ­£ç¡®çš„å…³é”®ã€‚  
- ğŸ’¡ **å­¦ä¹ ç¬”è®°**ï¼šå½“å¤„ç†â€œæ— åºå…ƒç´ â€ï¼ˆå¦‚åŒç§å­—æ¯ï¼‰æ—¶ï¼Œéœ€è¦è€ƒè™‘æ’åˆ—çš„é‡å¤é—®é¢˜ï¼Œé€šå¸¸ç”¨é˜¶ä¹˜é€†å…ƒè§£å†³ã€‚  

### âœ¨ è§£é¢˜æŠ€å·§æ€»ç»“  
- **æŠ€å·§Aï¼šé¢„å¤„ç†ç»„åˆæ•°**ï¼šç»„åˆæ•°æ˜¯åŠ¨æ€è§„åˆ’è½¬ç§»çš„æ ¸å¿ƒï¼Œæå‰ç”¨é€’æ¨å¼è®¡ç®—`C[n][k]`ï¼ˆ`n`æœ€å¤§ä¸º260ï¼‰å¯ä»¥é¿å…é‡å¤è®¡ç®—ï¼Œæé«˜æ•ˆç‡ã€‚  
- **æŠ€å·§Bï¼šçŠ¶æ€å‹ç¼©**ï¼šé€‰æ‹©å°½å¯èƒ½å°‘çš„çŠ¶æ€å˜é‡ï¼ˆå¦‚`i`å’Œ`k`ï¼‰ï¼Œé¿å…çŠ¶æ€çˆ†ç‚¸ï¼ˆæ¯”å¦‚å››ç»´çŠ¶æ€ä¼šå¢åŠ è®¡ç®—é‡ï¼‰ã€‚  
- **æŠ€å·§Cï¼šæ¨¡è¿ç®—å¤„ç†**ï¼šæ‰€æœ‰è®¡ç®—éƒ½è¦å¯¹`1e9+7`å–æ¨¡ï¼Œé¿å…æº¢å‡ºï¼ˆå¯ä»¥ç”¨`long long`ç±»å‹å­˜å‚¨ä¸­é—´ç»“æœï¼‰ã€‚  


## 4. C++æ ¸å¿ƒä»£ç å®ç°èµæ

### æœ¬é¢˜é€šç”¨æ ¸å¿ƒC++å®ç°å‚è€ƒ  
* **è¯´æ˜**ï¼šæœ¬ä»£ç ç»¼åˆäº†EricQianå’Œylxmf2005çš„é¢˜è§£æ€è·¯ï¼Œé‡‡ç”¨`f[i][k]`çŠ¶æ€ï¼Œé€šè¿‡ç»„åˆæ•°è®¡ç®—æ’å…¥æ–°å­—æ¯çš„æ–¹æ¡ˆæ•°ï¼Œé€»è¾‘æ¸…æ™°ä¸”é«˜æ•ˆã€‚  
* **å®Œæ•´æ ¸å¿ƒä»£ç **ï¼š  
  ```cpp
  #include <iostream>
  #include <vector>
  using namespace std;
  const int MOD = 1e9 + 7;
  const int MAXN = 26;
  const int MAXSUM = 260;

  int C[MAXSUM + 1][MAXSUM + 1];
  int f[MAXN + 1][MAXSUM + 1]; // f[i][k]ï¼šå¤„ç†å‰iç§å­—æ¯ï¼Œæœ‰kä¸ªç›¸é‚»ç›¸åŒå¯¹çš„æ–¹æ¡ˆæ•°
  int freq[MAXN + 1]; // freq[i]ï¼šç¬¬iç§å­—æ¯çš„æ•°é‡ï¼ˆ1~26å¯¹åº”a~zï¼‰
  int sum[MAXN + 1]; // sum[i]ï¼šå‰iç§å­—æ¯çš„æ€»é•¿åº¦

  void init_comb() {
      // é¢„å¤„ç†ç»„åˆæ•°C(n, k)
      for (int i = 0; i <= MAXSUM; i++) {
          C[i][0] = C[i][i] = 1;
          for (int j = 1; j < i; j++) {
              C[i][j] = (1LL * C[i-1][j-1] + C[i-1][j]) % MOD;
          }
      }
  }

  int main() {
      init_comb();
      for (int i = 1; i <= 26; i++) {
          cin >> freq[i];
          sum[i] = sum[i-1] + freq[i];
      }

      // åˆå§‹åŒ–ï¼šå¤„ç†ç¬¬ä¸€ä¸ªéé›¶å­—æ¯
      int first = 0;
      for (int i = 1; i <= 26; i++) {
          if (freq[i] > 0) {
              first = i;
              break;
          }
      }
      f[first][freq[first] - 1] = 1; // ç¬¬ä¸€ä¸ªå­—æ¯æœ‰freq[first]-1ä¸ªç›¸é‚»ç›¸åŒå¯¹

      // åŠ¨æ€è§„åˆ’è½¬ç§»
      for (int i = first + 1; i <= 26; i++) {
          if (freq[i] == 0) {
              // è¯¥å­—æ¯æ•°é‡ä¸º0ï¼ŒçŠ¶æ€ä¸å˜
              for (int k = 0; k <= sum[i-1]; k++) {
                  f[i][k] = f[i-1][k];
              }
              continue;
          }
          // æšä¸¾å‰i-1ç§å­—æ¯çš„çŠ¶æ€k
          for (int k = 0; k <= sum[i-1]; k++) {
              if (f[i-1][k] == 0) continue;
              // æšä¸¾æ’å…¥åˆ°éæ³•ç©ºéš™çš„æ®µæ•°badï¼ˆ0<=bad<=min(freq[i], k)ï¼‰
              for (int bad = 0; bad <= min(freq[i], k); bad++) {
                  // æšä¸¾æ’å…¥åˆ°åˆæ³•ç©ºéš™çš„æ®µæ•°goodï¼ˆ0<=good<=min(freq[i]-bad, sum[i-1]+1 -k)ï¼‰
                  for (int good = 0; good <= min(freq[i] - bad, sum[i-1] + 1 - k); good++) {
                      int total_segments = good + bad; // æ–°å­—æ¯åˆ†æˆçš„æ®µæ•°
                      if (total_segments == 0) continue;
                      // è®¡ç®—æ–°çš„ç›¸é‚»ç›¸åŒå¯¹æ•°é‡ï¼šk - badï¼ˆå‡å°‘çš„éæ³•ç©ºéš™ï¼‰ + (freq[i] - total_segments)ï¼ˆæ–°å¢åŠ çš„ç›¸é‚»ç›¸åŒå¯¹ï¼‰
                      int new_k = k - bad + (freq[i] - total_segments);
                      // ç»„åˆæ•°è®¡ç®—ï¼šC(k, bad)ï¼ˆé€‰badä¸ªéæ³•ç©ºéš™ï¼‰ * C(sum[i-1]+1 -k, good)ï¼ˆé€‰goodä¸ªåˆæ³•ç©ºéš™ï¼‰ * C(freq[i]-1, total_segments-1)ï¼ˆåˆ†total_segmentsæ®µï¼‰
                      long long ways = 1LL * f[i-1][k] * C[k][bad] % MOD;
                      ways = ways * C[sum[i-1] + 1 - k][good] % MOD;
                      ways = ways * C[freq[i] - 1][total_segments - 1] % MOD;
                      // æ›´æ–°çŠ¶æ€
                      f[i][new_k] = (1LL * f[i][new_k] + ways) % MOD;
                  }
              }
          }
      }

      // ç­”æ¡ˆæ˜¯å¤„ç†å®Œæ‰€æœ‰å­—æ¯åï¼Œç›¸é‚»ç›¸åŒå¯¹ä¸º0çš„æ–¹æ¡ˆæ•°
      cout << f[26][0] << endl;
      return 0;
  }
  ```
* **ä»£ç è§£è¯»æ¦‚è¦**ï¼š  
  1. **é¢„å¤„ç†ç»„åˆæ•°**ï¼šç”¨é€’æ¨å¼è®¡ç®—`C[n][k]`ï¼Œé¿å…é‡å¤è®¡ç®—ï¼›  
  2. **åˆå§‹åŒ–çŠ¶æ€**ï¼šå¤„ç†ç¬¬ä¸€ä¸ªéé›¶å­—æ¯ï¼Œåˆå§‹çŠ¶æ€ä¸º`f[first][freq[first]-1] = 1`ï¼ˆç¬¬ä¸€ä¸ªå­—æ¯æœ‰`freq[first]-1`ä¸ªç›¸é‚»ç›¸åŒå¯¹ï¼‰ï¼›  
  3. **åŠ¨æ€è§„åˆ’è½¬ç§»**ï¼šæšä¸¾æ¯ä¸ªå­—æ¯ï¼Œæšä¸¾å‰ä¸€ä¸ªçŠ¶æ€çš„`k`ï¼ˆç›¸é‚»ç›¸åŒå¯¹æ•°é‡ï¼‰ï¼Œç„¶åæšä¸¾æ’å…¥åˆ°åˆæ³•/éæ³•ç©ºéš™çš„æ®µæ•°ï¼Œè®¡ç®—ç»„åˆæ•°å’Œæ–°çš„`k`ï¼Œæ›´æ–°çŠ¶æ€ï¼›  
  4. **è¾“å‡ºç­”æ¡ˆ**ï¼šå¤„ç†å®Œæ‰€æœ‰å­—æ¯åï¼Œ`f[26][0]`å³ä¸ºç­”æ¡ˆï¼ˆç›¸é‚»ç›¸åŒå¯¹ä¸º0ï¼‰ã€‚  

### é¢˜è§£ä¸€ï¼ˆEricQianï¼‰æ ¸å¿ƒç‰‡æ®µèµæ  
* **äº®ç‚¹**ï¼šç”¨â€œæ‹†åˆ†éæ³•ç©ºéš™â€â€œç»„åˆæ–°å­—æ¯æ®µâ€â€œæ’å…¥åˆæ³•ç©ºéš™â€ä¸‰ç§æƒ…å†µè¦†ç›–æ‰€æœ‰è½¬ç§»æ–¹å¼ï¼Œé€»è¾‘ä¸¥å¯†ã€‚  
* **æ ¸å¿ƒä»£ç ç‰‡æ®µ**ï¼š  
  ```cpp
  for (int i = st+1; i <= 26; i++) for (int k = 0; k < sum[i-1]; k++)
      for (int q = 0; q < max(hav[i], 1); q++) for (int p = 0; p <= k && p+q <= hav[i]; p++)
      {
          int o = hav[i] - p - q;
          dp[i][k-p+q] = (dp[i][k-p+q] + 1LL * dp[i-1][k] *
              C[max(hav[i]-1, 0)][q] % MOD * C[k][p] % MOD * C[sum[i-1]+1-k][o] % MOD) % MOD;
      }
  ```
* **ä»£ç è§£è¯»**ï¼š  
  - `q`ï¼šæ–°å­—æ¯ç»„åˆæˆçš„æ®µæ•°ï¼ˆ`q`æ®µæ„å‘³ç€æœ‰`q-1`ä¸ªç›¸é‚»ç›¸åŒå¯¹ï¼‰ï¼›  
  - `p`ï¼šæ‹†åˆ†çš„éæ³•ç©ºéš™æ•°é‡ï¼ˆæ¯ä¸ªæ‹†åˆ†å‡å°‘1ä¸ªç›¸é‚»ç›¸åŒå¯¹ï¼‰ï¼›  
  - `o`ï¼šæ’å…¥åˆ°åˆæ³•ç©ºéš™çš„æ•°é‡ï¼ˆæ¯ä¸ªæ’å…¥å¢åŠ 0ä¸ªç›¸é‚»ç›¸åŒå¯¹ï¼‰ï¼›  
  - ç»„åˆæ•°è®¡ç®—ï¼š`C[hav[i]-1][q]`ï¼ˆå°†`hav[i]`ä¸ªå­—æ¯åˆ†æˆ`q`æ®µï¼‰ã€`C[k][p]`ï¼ˆé€‰`p`ä¸ªéæ³•ç©ºéš™ï¼‰ã€`C[sum[i-1]+1-k][o]`ï¼ˆé€‰`o`ä¸ªåˆæ³•ç©ºéš™ï¼‰ï¼›  
  - æ–°çš„`k`ï¼š`k - p`ï¼ˆå‡å°‘çš„éæ³•ç©ºéš™ï¼‰ + `q`ï¼ˆæ–°å¢åŠ çš„ç›¸é‚»ç›¸åŒå¯¹ï¼‰ã€‚  
* ğŸ’¡ **å­¦ä¹ ç¬”è®°**ï¼šæšä¸¾â€œæ®µæ•°â€å’Œâ€œç©ºéš™é€‰æ‹©â€æ˜¯åŠ¨æ€è§„åˆ’è½¬ç§»çš„å…³é”®ï¼Œéœ€è¦æ˜ç¡®æ¯ä¸ªå˜é‡çš„å«ä¹‰ã€‚  


## 5. ç®—æ³•å¯è§†åŒ–ï¼šåƒç´ åŠ¨ç”»æ¼”ç¤º (æ ¸å¿ƒéƒ¨åˆ†)

### åŠ¨ç”»æ¼”ç¤ºä¸»é¢˜  
**â€œåƒç´ ç§¯æœ¨å¤§å¸ˆâ€**ï¼šç©å®¶éœ€è¦å°†ä¸åŒé¢œè‰²çš„åƒç´ ç§¯æœ¨æ’å…¥å­—ç¬¦ä¸²ä¸­ï¼Œé¿å…ç›¸åŒé¢œè‰²ç›¸é‚»ï¼Œç›®æ ‡æ˜¯æ„å»ºä¸€ä¸ªå®Œå…¨åˆæ³•çš„å­—ç¬¦ä¸²ã€‚  

### æ ¸å¿ƒæ¼”ç¤ºå†…å®¹  
1. **åˆå§‹åœºæ™¯**ï¼šå±å¹•å·¦ä¾§æ˜¾ç¤ºç¬¬ä¸€ä¸ªå­—æ¯çš„åƒç´ å—ï¼ˆæ¯”å¦‚`aaa`ï¼Œç”¨çº¢è‰²æ ‡è®°ç›¸é‚»ç›¸åŒçš„ä½ç½®ï¼‰ï¼Œå³ä¾§æ˜¾ç¤ºçŠ¶æ€é¢æ¿ï¼ˆå½“å‰å¤„ç†å­—æ¯ï¼š`a`ï¼Œå‰©ä½™æ•°é‡ï¼š`3`ï¼Œç›¸é‚»ç›¸åŒå¯¹ï¼š`2`ï¼‰ã€‚  
2. **æ’å…¥æ–°å­—æ¯**ï¼šæ¯”å¦‚æ’å…¥`b`ï¼ˆæ•°é‡ä¸º`2`ï¼‰ï¼Œå±å¹•ä¸Šæ˜¾ç¤ºå¯é€‰çš„æ’å…¥ç©ºéš™ï¼ˆåˆæ³•ç©ºéš™ä¸ºç»¿è‰²ï¼Œéæ³•ç©ºéš™ä¸ºçº¢è‰²ï¼‰ã€‚ç©å®¶é€‰æ‹©æ’å…¥åˆ°`a`å’Œ`a`ä¹‹é—´ï¼ˆéæ³•ç©ºéš™ï¼‰ï¼Œæ­¤æ—¶`b`çš„åƒç´ å—æ»‘å…¥ï¼Œçº¢è‰²æ ‡è®°å‡å°‘1ä¸ªï¼ˆå˜ä¸º`1`ï¼‰ã€‚  
3. **è‡ªåŠ¨æ¼”ç¤º**ï¼šç‚¹å‡»â€œè‡ªåŠ¨æ’­æ”¾â€æŒ‰é’®ï¼Œç®—æ³•ä¼šè‡ªåŠ¨é€‰æ‹©æœ€ä¼˜æ’å…¥æ–¹å¼ï¼ˆæ¯”å¦‚å°†`b`åˆ†æˆ2æ®µï¼Œæ’å…¥åˆ°åˆæ³•ç©ºéš™ï¼‰ï¼Œé€æ­¥å‡å°‘çº¢è‰²æ ‡è®°ï¼Œç›´åˆ°æ‰€æœ‰ç›¸é‚»ç›¸åŒå¯¹æ¶ˆå¤±ã€‚  

### è®¾è®¡æ€è·¯ç®€è¿°  
- **åƒç´ é£æ ¼**ï¼šé‡‡ç”¨8ä½åƒç´ é£ï¼ˆç±»ä¼¼FCæ¸¸æˆï¼‰ï¼Œé¢œè‰²é²œè‰³ï¼ˆæ¯”å¦‚`a`ç”¨çº¢è‰²ï¼Œ`b`ç”¨è“è‰²ï¼‰ï¼Œç¬¦åˆé’å°‘å¹´çš„å®¡ç¾ï¼›  
- **éŸ³æ•ˆè®¾è®¡**ï¼šæ’å…¥åˆ°åˆæ³•ç©ºéš™æ—¶æ’­æ”¾â€œå®â€å£°ï¼Œæ’å…¥åˆ°éæ³•ç©ºéš™æ—¶æ’­æ”¾â€œå’»â€å£°ï¼Œçº¢è‰²æ ‡è®°å‡å°‘æ—¶æ’­æ”¾â€œæ»´â€å£°ï¼Œå¢å¼ºäº’åŠ¨æ„Ÿï¼›  
- **æ¸¸æˆåŒ–å…ƒç´ **ï¼šè®¾ç½®â€œå…³å¡â€ï¼ˆæ¯”å¦‚å¤„ç†å®Œ3ç§å­—æ¯ä¸ºä¸€å…³ï¼‰ï¼Œå®Œæˆå…³å¡åæ˜¾ç¤ºâ€œèƒœåˆ©â€åŠ¨ç”»ï¼ˆåƒç´ æ˜Ÿæ˜Ÿé—ªçƒï¼‰ï¼Œå¢åŠ æˆå°±æ„Ÿã€‚  

### å…³é”®å¸§æ­¥éª¤  
1. **å¸§1**ï¼šåˆå§‹å­—ç¬¦ä¸²`aaa`ï¼ˆ3ä¸ªçº¢è‰²åƒç´ å—ï¼Œ2ä¸ªçº¢è‰²æ ‡è®°ï¼‰ï¼›  
2. **å¸§2**ï¼šæ˜¾ç¤ºæ’å…¥`b`çš„å¯é€‰ç©ºéš™ï¼ˆ`_a_a_a_`ï¼Œå…¶ä¸­`_`ä¸ºåˆæ³•ç©ºéš™ï¼Œ`a`ä¹‹é—´ä¸ºéæ³•ç©ºéš™ï¼‰ï¼›  
3. **å¸§3**ï¼šé€‰æ‹©æ’å…¥åˆ°ç¬¬ä¸€ä¸ªéæ³•ç©ºéš™ï¼ˆ`a_b_a_a`ï¼‰ï¼Œçº¢è‰²æ ‡è®°å‡å°‘1ä¸ªï¼ˆå˜ä¸º`1`ï¼‰ï¼›  
4. **å¸§4**ï¼šæ’å…¥ç¬¬äºŒä¸ª`b`åˆ°åˆæ³•ç©ºéš™ï¼ˆ`a_b_a_b_a`ï¼‰ï¼Œçº¢è‰²æ ‡è®°å˜ä¸º`0`ï¼Œæ˜¾ç¤ºâ€œèƒœåˆ©â€åŠ¨ç”»ã€‚  


## 6. æ‹“å±•ç»ƒä¹ ä¸ç›¸ä¼¼é—®é¢˜æ€è€ƒ

### é€šç”¨æ€è·¯/æŠ€å·§è¿ç§»  
- **é€‚ç”¨åœºæ™¯**ï¼š`f[i][k]`çŠ¶æ€å’Œç»„åˆæ•°è½¬ç§»çš„æ€è·¯ï¼Œå¯ç”¨äºè§£å†³**â€œæ’åˆ—ä¸­é¿å…ç›¸é‚»å…ƒç´ â€**çš„é—®é¢˜ï¼Œæ¯”å¦‚ï¼š  
  1. å®‰æ’åº§ä½ï¼Œé¿å…ç›¸åŒç­çº§çš„å­¦ç”Ÿç›¸é‚»ï¼›  
  2. æ’åˆ—æ•°å­—ï¼Œé¿å…ç›¸åŒæ•°å­—ç›¸é‚»ï¼›  
  3. ç§æ¤èŠ±å‰ï¼Œé¿å…ç›¸åŒé¢œè‰²çš„èŠ±ç›¸é‚»ã€‚  

### ç»ƒä¹ æ¨è (æ´›è°·)  
1. **æ´›è°· P1979** - åå®¹é“  
   ğŸ—£ï¸ **æ¨èç†ç”±**ï¼šè¿™é“é¢˜éœ€è¦ç”¨åŠ¨æ€è§„åˆ’å¤„ç†â€œç§»åŠ¨æ£‹å­â€çš„çŠ¶æ€ï¼Œç±»ä¼¼æœ¬é¢˜çš„â€œæ’å…¥å­—æ¯â€é€»è¾‘ï¼Œå¯å·©å›ºçŠ¶æ€å®šä¹‰å’Œè½¬ç§»çš„æŠ€å·§ã€‚  
2. **æ´›è°· P2532** - [AHOI2012]æ ‘å±‹é˜¶æ¢¯  
   ğŸ—£ï¸ **æ¨èç†ç”±**ï¼šæœ¬é¢˜éœ€è¦ç”¨ç»„åˆæ•°å­¦è®¡ç®—åˆæ³•çš„é˜¶æ¢¯ç»“æ„ï¼Œç±»ä¼¼æœ¬é¢˜çš„â€œæ’æ¿æ³•â€å’Œâ€œç»„åˆæ•°é¢„å¤„ç†â€ï¼Œå¯æ‹“å±•ç»„åˆæ•°å­¦çš„åº”ç”¨ã€‚  
3. **æ´›è°· P3197** - [HNOI2008]è¶Šç‹±  
   ğŸ—£ï¸ **æ¨èç†ç”±**ï¼šè¿™é“é¢˜æ˜¯â€œé¿å…ç›¸é‚»ç›¸åŒâ€çš„åé¢ï¼ˆè®¡ç®—â€œæœ‰ç›¸é‚»ç›¸åŒâ€çš„æ–¹æ¡ˆæ•°ï¼‰ï¼Œå¯å·©å›ºäºŒé¡¹å¼åæ¼”å’ŒåŠ¨æ€è§„åˆ’çš„æŠ€å·§ã€‚  


## 7. å­¦ä¹ å¿ƒå¾—ä¸ç»éªŒåˆ†äº« (è‹¥æœ‰)  
**å‚è€ƒç»éªŒ (æ¥è‡ª EricQian)**ï¼šâ€œæˆ‘åœ¨è§£å†³è¿™ä¸ªé—®é¢˜æ—¶ï¼Œæœ€åˆæ²¡æœ‰è€ƒè™‘åˆ°â€˜æ®µæ•°â€™çš„åˆ’åˆ†ï¼Œå¯¼è‡´è½¬ç§»é€»è¾‘æ··ä¹±ã€‚åæ¥é€šè¿‡â€˜æ’æ¿æ³•â€™çš„æ€è·¯ï¼Œå°†æ–°å­—æ¯åˆ†æˆè‹¥å¹²æ®µï¼Œæ‰ç†æ¸…äº†ç»„åˆæ•°çš„è®¡ç®—æ–¹å¼ã€‚â€  
**ç‚¹è¯„**ï¼šè¿™ä½ä½œè€…çš„ç»éªŒå¾ˆå…¸å‹ã€‚åœ¨åŠ¨æ€è§„åˆ’ä¸­ï¼Œâ€œæ®µæ•°â€æ˜¯å¤„ç†â€œç›¸é‚»ç›¸åŒâ€é—®é¢˜çš„å…³é”®ï¼Œé€šè¿‡å°†å…ƒç´ åˆ†æˆæ®µï¼Œå¯ä»¥é¿å…è‡ªèº«ç›¸é‚»çš„æƒ…å†µã€‚**å»ºè®®**ï¼šé‡åˆ°â€œé¿å…ç›¸é‚»â€çš„é—®é¢˜æ—¶ï¼Œå…ˆè€ƒè™‘â€œåˆ†å¤šå°‘æ®µâ€ï¼Œå†è®¡ç®—æ’å…¥çš„æ–¹å¼ã€‚  


## ç»“è¯­  
æœ¬æ¬¡å…³äºâ€œæ–‡å­—åˆ—â€çš„C++è§£é¢˜åˆ†æå°±åˆ°è¿™é‡Œã€‚å¸Œæœ›è¿™ä»½å­¦ä¹ æŒ‡å—èƒ½å¸®åŠ©å¤§å®¶ç†è§£åŠ¨æ€è§„åˆ’ä¸ç»„åˆæ•°å­¦çš„ç»¼åˆåº”ç”¨ï¼ŒæŒæ¡â€œé¿å…ç›¸é‚»ç›¸åŒâ€é—®é¢˜çš„è§£é¢˜æŠ€å·§ã€‚è®°ä½ï¼Œ**çŠ¶æ€å®šä¹‰æ˜¯å…³é”®ï¼Œç»„åˆæ•°æ˜¯å·¥å…·ï¼Œæ¨¡è¿ç®—è¦æ³¨æ„**â€”â€”åªè¦ç†æ¸…è¿™ä¸‰ç‚¹ï¼Œå°±èƒ½è§£å†³è¿™ç±»é—®é¢˜ï¼ä¸‹æ¬¡æˆ‘ä»¬å†ä¸€èµ·æ¢ç´¢æ–°çš„ç¼–ç¨‹æŒ‘æˆ˜ï¼ğŸ’ª

---
å¤„ç†ç”¨æ—¶ï¼š164.44ç§’
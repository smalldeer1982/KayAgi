# é¢˜ç›®ä¿¡æ¯

# ã‹ã‹ã—

## é¢˜ç›®æè¿°

[problemUrl]: https://atcoder.jp/contests/joisc2014/tasks/joisc2014_i

# AIåˆ†æç»“æœ

# ğŸ’¡ Kayçš„C++ç®—æ³•è§£æï¼šã€Œã‹ã‹ã—ï¼ˆç¨»è‰äººï¼‰ã€æ·±å…¥å­¦ä¹ æŒ‡å— ğŸ’¡


## 1. é¢˜ç›®è§£è¯»ä¸æ ¸å¿ƒç®—æ³•è¯†åˆ«

âœ¨ **æœ¬é¢˜ä¸»è¦è€ƒå¯Ÿ**ï¼šCDQåˆ†æ²»ï¼ˆå¤„ç†ååºé—®é¢˜ï¼‰ã€å•è°ƒæ ˆï¼ˆç»´æŠ¤åˆæ³•ç‚¹é›†ï¼‰ã€çº¿æ®µæ ‘ï¼ˆç±»ä¼¼ã€Œæ¥¼æˆ¿é‡å»ºã€çš„åç¼€æœ€å¤§å€¼ç»´æŠ¤ï¼‰


ğŸ—£ï¸ **åˆæ­¥åˆ†æ**ï¼š  
è§£å†³ã€Œç¨»è‰äººã€é—®é¢˜çš„æ ¸å¿ƒæ˜¯**ç»Ÿè®¡æ»¡è¶³æ¡ä»¶çš„ç‚¹å¯¹(i,j)**ï¼šiåœ¨jçš„å·¦ä¸‹è§’ï¼ˆ\(x_i < x_j\) ä¸” \(y_i < y_j\)ï¼‰ï¼Œä¸”çŸ©å½¢å†…æ— å…¶ä»–ç‚¹ã€‚è¿™ä¸ªæ¡ä»¶ç­‰ä»·äºï¼š**æ²¡æœ‰ç‚¹kä½äºiçš„å³ä¸Šè§’ã€jçš„å·¦ä¸‹è§’**ï¼ˆå³\(x_i < x_k < x_j\) ä¸” \(y_i < y_k < y_j\)ï¼‰ã€‚  

### æ ¸å¿ƒç®—æ³•æ€è·¯
1. **CDQåˆ†æ²»**ï¼šåƒã€Œåˆ†è›‹ç³•ã€ä¸€æ ·ï¼Œå°†ç‚¹é›†æŒ‰æ¨ªåæ ‡ï¼ˆæˆ–çºµåæ ‡ï¼‰åˆ†æˆå·¦å³ä¸¤éƒ¨åˆ†ï¼Œé€’å½’è§£å†³å­é—®é¢˜ï¼Œå†åˆå¹¶å·¦å³ä¸¤éƒ¨åˆ†çš„ç»“æœï¼ˆå³å·¦åŠéƒ¨åˆ†çš„ç‚¹ä½œä¸ºå·¦ä¸‹è§’ï¼Œå³åŠéƒ¨åˆ†çš„ç‚¹ä½œä¸ºå³ä¸Šè§’çš„åˆæ³•ç‚¹å¯¹ï¼‰ã€‚  
2. **å•è°ƒæ ˆ**ï¼šåƒã€Œæ•´ç†ä¹¦æ¶ã€ä¸€æ ·ï¼Œç»´æŠ¤ä¸€ä¸ª**æ¨ªåæ ‡é€’å¢ã€çºµåæ ‡é€’å‡**çš„åˆæ³•ç‚¹é›†ã€‚è¿™æ ·ï¼Œå½“å¤„ç†æ–°ç‚¹æ—¶ï¼Œåªéœ€åœ¨æ ˆä¸­äºŒåˆ†æŸ¥æ‰¾ç¬¦åˆæ¡ä»¶çš„ç‚¹ï¼Œé¿å…é‡å¤åˆ¤æ–­ã€‚  
3. **çº¿æ®µæ ‘ï¼ˆå¯é€‰ï¼‰**ï¼šç±»ä¼¼ã€Œæ¥¼æˆ¿é‡å»ºã€é—®é¢˜ï¼Œç»´æŠ¤åç¼€æœ€å¤§å€¼åºåˆ—ï¼Œå¿«é€ŸæŸ¥è¯¢ç¬¦åˆæ¡ä»¶çš„ç‚¹æ•°é‡ï¼ˆå¦‚Lynkcatçš„é¢˜è§£ï¼‰ã€‚  

### å¯è§†åŒ–è®¾è®¡æ€è·¯
æˆ‘ä»¬å°†ç”¨**8ä½åƒç´ é£**ï¼ˆç±»ä¼¼FCæ¸¸æˆï¼‰å±•ç¤ºCDQåˆ†æ²»çš„è¿‡ç¨‹ï¼š  
- **åœºæ™¯**ï¼šåƒç´ åŒ–å¹³é¢ï¼Œç‚¹ç”¨ä¸åŒé¢œè‰²çš„æ–¹å—è¡¨ç¤ºï¼ˆå·¦ä¸‹è§’ç‚¹ä¸ºè“è‰²ï¼Œå³ä¸Šè§’ç‚¹ä¸ºçº¢è‰²ï¼Œéæ³•ç‚¹ä¸ºç°è‰²ï¼‰ã€‚  
- **æ­¥éª¤**ï¼š  
  1. åˆ†æ²»è¿‡ç¨‹ï¼šå±å¹•åˆ†æˆå·¦å³ä¸¤éƒ¨åˆ†ï¼Œå±•ç¤ºå­é—®é¢˜çš„è§£å†³ã€‚  
  2. å•è°ƒæ ˆç»´æŠ¤ï¼šç”¨ã€Œä¹¦æ¶ã€åŠ¨ç”»å±•ç¤ºæ ˆä¸­å…ƒç´ çš„å¢å‡ï¼ˆå¦‚æ’å…¥æ–°ç‚¹æ—¶ï¼Œç§»é™¤ä¸ç¬¦åˆæ¡ä»¶çš„ç‚¹ï¼‰ã€‚  
  3. åˆæ³•ç‚¹å¯¹æ ‡è®°ï¼šå½“æ‰¾åˆ°åˆæ³•ç‚¹å¯¹æ—¶ï¼Œç”¨ã€Œé—ªçƒ+éŸ³æ•ˆã€æç¤ºï¼ˆå¦‚â€œå®â€çš„ä¸€å£°ï¼‰ã€‚  
- **äº¤äº’**ï¼šæ”¯æŒã€Œå•æ­¥æ‰§è¡Œã€ï¼ˆé€æ­¥çœ‹åˆ†æ²»å’Œæ ˆæ“ä½œï¼‰ã€ã€Œè‡ªåŠ¨æ’­æ”¾ã€ï¼ˆå¿«é€Ÿæ¼”ç¤ºå…¨è¿‡ç¨‹ï¼‰ï¼Œä»¥åŠã€Œé‡ç½®ã€æŒ‰é’®ã€‚  


## 2. ç²¾é€‰ä¼˜è´¨é¢˜è§£å‚è€ƒ

### é¢˜è§£ä¸€ï¼šçº¿æ®µæ ‘+ç±»ä¼¼ã€Œæ¥¼æˆ¿é‡å»ºã€ï¼ˆä½œè€…ï¼šLynkcatï¼Œèµ8ï¼‰
* **ç‚¹è¯„**ï¼š  
  è¿™é“é¢˜è§£çš„æ€è·¯éå¸¸ç‹¬ç‰¹ï¼Œå°†é—®é¢˜è½¬åŒ–ä¸ºã€Œç»´æŠ¤åç¼€æœ€å¤§å€¼åºåˆ—ã€ï¼ˆç±»ä¼¼æ´›è°·P4198ã€Œæ¥¼æˆ¿é‡å»ºã€ï¼‰ã€‚é€šè¿‡ç¦»æ•£åŒ–æ¨ªåæ ‡ï¼ŒæŒ‰çºµåæ ‡ä»å°åˆ°å¤§æ’å…¥ç‚¹ï¼Œç”¨çº¿æ®µæ ‘ç»´æŠ¤æ¯ä¸ªåŒºé—´çš„**æœ€å¤§çºµåæ ‡**å’Œ**åˆæ³•ç‚¹æ•°é‡**ã€‚æŸ¥è¯¢æ—¶ï¼Œåªéœ€ç»Ÿè®¡å½“å‰ç‚¹å·¦ä¾§ç¬¦åˆæ¡ä»¶çš„ç‚¹æ•°é‡ï¼ˆå³æ²¡æœ‰ç‚¹é®æŒ¡çš„å·¦ä¸‹è§’ç‚¹ï¼‰ã€‚  
  ä»£ç é£æ ¼è§„èŒƒï¼ˆå˜é‡åå¦‚`mx`è¡¨ç¤ºæœ€å¤§å€¼ï¼Œ`len`è¡¨ç¤ºåˆæ³•æ•°é‡ï¼‰ï¼Œçº¿æ®µæ ‘çš„`pushup`å’Œ`update`æ“ä½œé€»è¾‘æ¸…æ™°ã€‚**äº®ç‚¹**åœ¨äºå°†å‡ ä½•é—®é¢˜è½¬åŒ–ä¸ºæ•°æ®ç»“æ„é—®é¢˜ï¼Œé¿å…äº†å¤æ‚çš„åˆ†æ²»é€»è¾‘ï¼Œé€‚åˆç†è§£ã€Œå¦‚ä½•ç”¨çº¿æ®µæ ‘å¤„ç†ååºçº¦æŸã€ã€‚


### é¢˜è§£äºŒï¼šCDQåˆ†æ²»+å•è°ƒæ ˆï¼ˆä½œè€…ï¼šorz_zï¼Œèµ5ï¼‰
* **ç‚¹è¯„**ï¼š  
  è¿™æ˜¯CDQåˆ†æ²»çš„ç»å…¸å®ç°ï¼Œæ€è·¯æ¸…æ™°ä¸”ä»£ç ç®€æ´ã€‚é¦–å…ˆæŒ‰æ¨ªåæ ‡æ’åºï¼Œå†æŒ‰çºµåæ ‡é€’å‡å½’å¹¶ã€‚åˆ†æ²»è¿‡ç¨‹ä¸­ï¼Œç”¨ä¸¤ä¸ªå•è°ƒæ ˆç»´æŠ¤å·¦å³ä¸¤éƒ¨åˆ†çš„åˆæ³•ç‚¹é›†ï¼š  
  - å·¦æ ˆï¼ˆ`s1`ï¼‰ï¼šæ¨ªåæ ‡é€’å‡ã€çºµåæ ‡é€’å‡ï¼ˆé¿å…å·¦åŠéƒ¨åˆ†ç‚¹é®æŒ¡ï¼‰ï¼›  
  - å³æ ˆï¼ˆ`s2`ï¼‰ï¼šæ¨ªåæ ‡é€’å¢ã€çºµåæ ‡é€’å‡ï¼ˆé¿å…å³åŠéƒ¨åˆ†ç‚¹é®æŒ¡ï¼‰ã€‚  
  é€šè¿‡åŒæŒ‡é’ˆæ‰«æå·¦å³ä¸¤éƒ¨åˆ†ï¼Œç”¨äºŒåˆ†æŸ¥æ‰¾æ ˆä¸­ç¬¦åˆæ¡ä»¶çš„ç‚¹æ•°é‡ã€‚**äº®ç‚¹**åœ¨äºå•è°ƒæ ˆä¸äºŒåˆ†çš„ç»“åˆï¼Œé«˜æ•ˆå¤„ç†äº†ã€Œæ— é®æŒ¡ã€çš„çº¦æŸï¼Œä»£ç å¯è¯»æ€§é«˜ï¼Œé€‚åˆä½œä¸ºCDQåˆ†æ²»çš„å…¥é—¨æ¨¡æ¿ã€‚


### é¢˜è§£ä¸‰ï¼šCDQåˆ†æ²»+è¯¦ç»†æ€è·¯è¯´æ˜ï¼ˆä½œè€…ï¼š_Felixï¼Œèµ4ï¼‰
* **ç‚¹è¯„**ï¼š  
  è¿™é“é¢˜è§£çš„**æ€è·¯è§£é‡Šéå¸¸è¯¦ç»†**ï¼Œç”¨å›¾ç¤ºï¼ˆå¦‚æ©™ç‚¹ã€ç²‰ç‚¹ã€è“ç‚¹ï¼‰è¯´æ˜äº†ã€Œæ— é®æŒ¡ã€æ¡ä»¶çš„è½¬åŒ–ã€‚ä»£ç ä¸­ï¼Œé€šè¿‡å½’å¹¶æ’åºç»´æŠ¤æ¨ªåæ ‡é€’å¢ï¼Œç”¨ä¸¤ä¸ªå•è°ƒæ ˆåˆ†åˆ«å¤„ç†ä¸Šä¸‹åŠéƒ¨åˆ†çš„çº¦æŸï¼š  
  - ä¸ŠåŠéƒ¨åˆ†ï¼ˆå³ä¸Šè§’ç‚¹ï¼‰ï¼šç»´æŠ¤çºµåæ ‡é€’å¢çš„æ ˆï¼Œæ‰¾åˆ°å·¦ä¾§æœ€è¿‘çš„é®æŒ¡ç‚¹ï¼›  
  - ä¸‹åŠéƒ¨åˆ†ï¼ˆå·¦ä¸‹è§’ç‚¹ï¼‰ï¼šç»´æŠ¤çºµåæ ‡é€’å‡çš„æ ˆï¼Œç¡®ä¿ç‚¹ä¸äº’ç›¸é®æŒ¡ã€‚  
  **äº®ç‚¹**åœ¨äºå°†æŠ½è±¡çš„ååºçº¦æŸè½¬åŒ–ä¸ºå…·ä½“çš„æ ˆæ“ä½œï¼Œå¸®åŠ©å­¦ä¹ è€…ç†è§£ã€Œä¸ºä»€ä¹ˆè¦ç”¨å•è°ƒæ ˆã€ï¼Œé€‚åˆæ–°æ‰‹å…¥é—¨ã€‚


## 3. æ ¸å¿ƒéš¾ç‚¹è¾¨æä¸è§£é¢˜ç­–ç•¥

### 1. å¦‚ä½•å¤„ç†ã€ŒçŸ©å½¢å†…æ— ç‚¹ã€çš„çº¦æŸï¼Ÿ
* **åˆ†æ**ï¼š  
  è¿™ä¸ªçº¦æŸç­‰ä»·äºã€Œå¯¹äºç‚¹å¯¹(i,j)ï¼Œæ²¡æœ‰ç‚¹kæ»¡è¶³\(x_i < x_k < x_j\)ä¸”\(y_i < y_k < y_j\)ã€ã€‚æ¢å¥è¯è¯´ï¼Œiå¿…é¡»æ˜¯jçš„ã€Œå·¦ä¸‹æ–¹å¯è§ç‚¹ã€ï¼ˆå³æ²¡æœ‰ç‚¹åœ¨içš„å³ä¸Šè§’ã€jçš„å·¦ä¸‹è§’ï¼‰ã€‚  
  **è§£å†³æ–¹æ¡ˆ**ï¼šç”¨å•è°ƒæ ˆç»´æŠ¤åˆæ³•ç‚¹é›†ã€‚ä¾‹å¦‚ï¼ŒæŒ‰æ¨ªåæ ‡é€’å¢æ’åºåï¼Œç»´æŠ¤ä¸€ä¸ªçºµåæ ‡é€’å‡çš„æ ˆï¼Œè¿™æ ·æ ˆä¸­çš„ç‚¹ä¸ä¼šäº’ç›¸é®æŒ¡ï¼ˆå³å¯¹äºæ ˆä¸­çš„ä»»æ„ä¸¤ç‚¹aå’Œbï¼Œè‹¥aåœ¨bçš„å·¦ä¾§ï¼Œåˆ™açš„çºµåæ ‡å¤§äºbçš„çºµåæ ‡ï¼‰ã€‚

### 2. å¦‚ä½•é«˜æ•ˆåˆå¹¶CDQåˆ†æ²»çš„å­é—®é¢˜ç»“æœï¼Ÿ
* **åˆ†æ**ï¼š  
  CDQåˆ†æ²»çš„å…³é”®æ˜¯åˆå¹¶å·¦å³ä¸¤éƒ¨åˆ†çš„ç»“æœï¼ˆå·¦åŠéƒ¨åˆ†çš„ç‚¹ä½œä¸ºå·¦ä¸‹è§’ï¼Œå³åŠéƒ¨åˆ†çš„ç‚¹ä½œä¸ºå³ä¸Šè§’ï¼‰ã€‚æ­¤æ—¶éœ€è¦å¿«é€Ÿç»Ÿè®¡å³åŠéƒ¨åˆ†ä¸­ç¬¦åˆæ¡ä»¶çš„ç‚¹æ•°é‡ï¼ˆå³æ²¡æœ‰è¢«å·¦åŠéƒ¨åˆ†ç‚¹é®æŒ¡çš„ç‚¹ï¼‰ã€‚  
  **è§£å†³æ–¹æ¡ˆ**ï¼šç”¨åŒæŒ‡é’ˆæ‰«æå·¦å³ä¸¤éƒ¨åˆ†ï¼Œç»“åˆå•è°ƒæ ˆç»´æŠ¤åˆæ³•ç‚¹é›†ã€‚ä¾‹å¦‚ï¼Œå½“å¤„ç†å³åŠéƒ¨åˆ†çš„ç‚¹jæ—¶ï¼Œå°†å·¦åŠéƒ¨åˆ†ä¸­æ¨ªåæ ‡å°äºjçš„ç‚¹åŠ å…¥å•è°ƒæ ˆï¼ˆç»´æŠ¤çºµåæ ‡é€’å‡ï¼‰ï¼Œç„¶ååœ¨æ ˆä¸­äºŒåˆ†æŸ¥æ‰¾ç¬¦åˆæ¡ä»¶çš„ç‚¹æ•°é‡ã€‚

### 3. å¦‚ä½•å¤„ç†è¾¹ç•Œæ¡ä»¶ï¼ˆå¦‚äºŒåˆ†æŸ¥æ‰¾çš„è¾¹ç•Œï¼‰ï¼Ÿ
* **åˆ†æ**ï¼š  
  äºŒåˆ†æŸ¥æ‰¾çš„è¾¹ç•Œå®¹æ˜“å‡ºé”™ï¼Œä¾‹å¦‚åœ¨å•è°ƒæ ˆä¸­æŸ¥æ‰¾ã€Œæœ€åä¸€ä¸ªçºµåæ ‡å¤§äºæŸä¸ªå€¼çš„ç‚¹ã€ã€‚è‹¥è¾¹ç•Œå¤„ç†ä¸å½“ï¼Œä¼šå¯¼è‡´ç»Ÿè®¡ç»“æœé”™è¯¯ã€‚  
  **è§£å†³æ–¹æ¡ˆ**ï¼šæ˜ç¡®äºŒåˆ†çš„ç›®æ ‡ï¼ˆå¦‚æŸ¥æ‰¾æœ€å¤§çš„ç´¢å¼•midï¼Œä½¿å¾—æ ˆä¸­midä½ç½®çš„ç‚¹çºµåæ ‡å¤§äºç›®æ ‡å€¼ï¼‰ï¼Œå¹¶ä½¿ç”¨ã€Œå·¦é—­å³é—­ã€çš„åŒºé—´ï¼ˆå¦‚`l=0, r=tp2`ï¼Œå…¶ä¸­`tp2`æ˜¯æ ˆçš„å¤§å°ï¼‰ã€‚ä¾‹å¦‚ï¼Œorz_zçš„é¢˜è§£ä¸­ï¼ŒäºŒåˆ†å‡½æ•°`erfen`çš„é€»è¾‘éå¸¸æ¸…æ™°ï¼š  
  ```cpp
  int erfen(int p) {
    int l=0, r=tp2;
    while(l < r) {
      int mid=(l+r+1)>>1;
      if(s[st2[mid]].y > p) l=mid;
      else r=mid-1;
    }
    return l;
  }
  ```


### âœ¨ è§£é¢˜æŠ€å·§æ€»ç»“
- **é—®é¢˜è½¬åŒ–**ï¼šå°†ã€ŒçŸ©å½¢å†…æ— ç‚¹ã€çš„çº¦æŸè½¬åŒ–ä¸ºã€Œååºé—®é¢˜ã€ï¼Œç”¨å•è°ƒæ ˆç»´æŠ¤åˆæ³•ç‚¹é›†ã€‚  
- **CDQåˆ†æ²»**ï¼šå¤„ç†äºŒç»´ååºé—®é¢˜çš„å¸¸ç”¨æ–¹æ³•ï¼Œé€šè¿‡åˆ†æ²»å‡å°‘é—®é¢˜è§„æ¨¡ã€‚  
- **å•è°ƒæ ˆ+äºŒåˆ†**ï¼šé«˜æ•ˆç»Ÿè®¡ç¬¦åˆæ¡ä»¶çš„ç‚¹æ•°é‡ï¼Œæ—¶é—´å¤æ‚åº¦ä¸º\(O(n\log^2n)\)ã€‚  


## 4. C++æ ¸å¿ƒä»£ç å®ç°èµæ

### æœ¬é¢˜é€šç”¨æ ¸å¿ƒC++å®ç°å‚è€ƒï¼ˆåŸºäºorz_zçš„CDQåˆ†æ²»ï¼‰
* **è¯´æ˜**ï¼š  
  æ­¤ä»£ç æ˜¯CDQåˆ†æ²»+å•è°ƒæ ˆçš„ç»å…¸å®ç°ï¼Œæ€è·¯æ¸…æ™°ï¼Œé€‚åˆä½œä¸ºè§£å†³ã€Œç¨»è‰äººã€é—®é¢˜çš„æ¨¡æ¿ã€‚  
* **å®Œæ•´æ ¸å¿ƒä»£ç **ï¼š  
  ```cpp
  #include<bits/stdc++.h>
  using namespace std;
  #define int long long
  typedef long long ll;
  
  const int _ = 2e5 + 10;
  int n;
  ll ans;
  
  struct abc {
    int x, y;
  } k[_];
  
  int t1, s1[_], t2, s2[_];
  bool cmp1(abc a, abc b) { return a.x < b.x; }
  bool cmp2(abc a, abc b) { return a.y > b.y; }
  
  int erfen(int p) {
    int l = 0, r = t2;
    while(l < r) {
      int mid = (l + r + 1) >> 1;
      if(k[s2[mid]].y > p) l = mid;
      else r = mid - 1;
    }
    return l;
  }
  
  void cdq(int l, int r) {
    if(l == r) return;
    int mid = (l + r) >> 1;
    cdq(l, mid), cdq(mid + 1, r);
    sort(k + l, k + mid + 1, cmp2);
    sort(k + mid + 1, k + r + 1, cmp2);
    int j = mid + 1; t1 = t2 = 0;
    for(int i = l; i <= mid; ++i) {
      while(j <= r && k[i].y < k[j].y) {
        while(t2 && k[s2[t2]].x > k[j].x) t2--;
        s2[++t2] = j, j++;
      }
      while(t1 && k[s1[t1]].x < k[i].x) t1--;
      ans += t2;
      if(t1) ans -= erfen(k[s1[t1]].y);
      s1[++t1] = i;
    }
  }
  
  signed main() {
    n = read();
    for(int i = 1; i <= n; ++i)
      k[i].x = read(), k[i].y = read();
    sort(k + 1, k + n + 1, cmp1);
    cdq(1, n);
    write(ans), he;
    return 0;
  }
  ```
* **ä»£ç è§£è¯»æ¦‚è¦**ï¼š  
  1. **è¾“å…¥å¤„ç†**ï¼šè¯»å–ç‚¹çš„åæ ‡ï¼ŒæŒ‰æ¨ªåæ ‡æ’åºï¼ˆ`cmp1`ï¼‰ã€‚  
  2. **CDQåˆ†æ²»**ï¼š`cdq(l, r)`å¤„ç†åŒºé—´[l, r]çš„ç‚¹ï¼Œé€’å½’è§£å†³å·¦å³å­é—®é¢˜ã€‚  
  3. **å½’å¹¶æ’åº**ï¼šå°†å·¦å³å­åŒºé—´æŒ‰çºµåæ ‡é€’å‡æ’åºï¼ˆ`cmp2`ï¼‰ï¼Œæ–¹ä¾¿å¤„ç†ã€Œæ— é®æŒ¡ã€æ¡ä»¶ã€‚  
  4. **åŒæŒ‡é’ˆ+å•è°ƒæ ˆ**ï¼šæ‰«æå·¦å³å­åŒºé—´ï¼Œç”¨`s1`ï¼ˆå·¦æ ˆï¼‰ç»´æŠ¤å·¦åŠéƒ¨åˆ†çš„åˆæ³•ç‚¹ï¼Œç”¨`s2`ï¼ˆå³æ ˆï¼‰ç»´æŠ¤å³åŠéƒ¨åˆ†çš„åˆæ³•ç‚¹ï¼Œé€šè¿‡äºŒåˆ†æŸ¥æ‰¾ç»Ÿè®¡åˆæ³•ç‚¹å¯¹æ•°é‡ã€‚  


### é’ˆå¯¹ä¼˜è´¨é¢˜è§£çš„ç‰‡æ®µèµæï¼ˆé¢˜è§£äºŒï¼šorz_zï¼‰
* **äº®ç‚¹**ï¼šå•è°ƒæ ˆä¸äºŒåˆ†çš„ç»“åˆï¼Œé«˜æ•ˆç»Ÿè®¡åˆæ³•ç‚¹å¯¹ã€‚  
* **æ ¸å¿ƒä»£ç ç‰‡æ®µ**ï¼š  
  ```cpp
  int erfen(int p) {
    int l = 0, r = t2;
    while(l < r) {
      int mid = (l + r + 1) >> 1;
      if(k[s2[mid]].y > p) l = mid;
      else r = mid - 1;
    }
    return l;
  }
  
  void cdq(int l, int r) {
    // ... é€’å½’å¤„ç†å­é—®é¢˜ ...
    for(int i = l; i <= mid; ++i) {
      while(j <= r && k[i].y < k[j].y) {
        while(t2 && k[s2[t2]].x > k[j].x) t2--;
        s2[++t2] = j, j++;
      }
      while(t1 && k[s1[t1]].x < k[i].x) t1--;
      ans += t2;
      if(t1) ans -= erfen(k[s1[t1]].y);
      s1[++t1] = i;
    }
  }
  ```
* **ä»£ç è§£è¯»**ï¼š  
  - **`erfen`å‡½æ•°**ï¼šåœ¨å³æ ˆ`s2`ä¸­æŸ¥æ‰¾ã€Œæœ€åä¸€ä¸ªçºµåæ ‡å¤§äºpçš„ç‚¹ã€ã€‚ä¾‹å¦‚ï¼Œå½“å¤„ç†å·¦åŠéƒ¨åˆ†çš„ç‚¹iæ—¶ï¼Œéœ€è¦å‡å»è¢«å·¦æ ˆ`s1`ä¸­æœ€è¿‘ç‚¹é®æŒ¡çš„å³æ ˆç‚¹æ•°é‡ã€‚  
  - **`cdq`å‡½æ•°ä¸­çš„å¾ªç¯**ï¼š  
    1. ç”¨`j`æŒ‡é’ˆæ‰«æå³åŠéƒ¨åˆ†çš„ç‚¹ï¼Œå°†ç¬¦åˆæ¡ä»¶çš„ç‚¹åŠ å…¥å³æ ˆ`s2`ï¼ˆç»´æŠ¤æ¨ªåæ ‡é€’å¢ï¼‰ã€‚  
    2. ç”¨`i`æŒ‡é’ˆæ‰«æå·¦åŠéƒ¨åˆ†çš„ç‚¹ï¼Œå°†ç¬¦åˆæ¡ä»¶çš„ç‚¹åŠ å…¥å·¦æ ˆ`s1`ï¼ˆç»´æŠ¤æ¨ªåæ ‡é€’å‡ï¼‰ã€‚  
    3. ç»Ÿè®¡å³æ ˆ`s2`ä¸­çš„åˆæ³•ç‚¹æ•°é‡ï¼ˆ`ans += t2`ï¼‰ï¼Œå†å‡å»è¢«å·¦æ ˆ`s1`é®æŒ¡çš„ç‚¹æ•°é‡ï¼ˆ`ans -= erfen(...)`ï¼‰ã€‚  
* ğŸ’¡ **å­¦ä¹ ç¬”è®°**ï¼š  
  å•è°ƒæ ˆç”¨äºç»´æŠ¤åˆæ³•ç‚¹é›†ï¼ŒäºŒåˆ†ç”¨äºå¿«é€ŸæŸ¥è¯¢ï¼ŒäºŒè€…ç»“åˆå¯ä»¥é«˜æ•ˆå¤„ç†ã€Œæ— é®æŒ¡ã€çš„çº¦æŸã€‚


## 5. ç®—æ³•å¯è§†åŒ–ï¼šåƒç´ åŠ¨ç”»æ¼”ç¤ºï¼ˆæ ¸å¿ƒéƒ¨åˆ†ï¼‰

### åŠ¨ç”»æ¼”ç¤ºä¸»é¢˜ï¼šã€Œåƒç´ æ¢é™©å®¶æ‰¾ä¼™ä¼´ã€
**é£æ ¼**ï¼š8ä½åƒç´ é£ï¼ˆç±»ä¼¼FCæ¸¸æˆã€Šè¶…çº§é©¬é‡Œå¥¥ã€‹ï¼‰ï¼Œç”¨æ–¹å—è¡¨ç¤ºç‚¹ï¼Œé¢œè‰²åŒºåˆ†ç±»å‹ï¼ˆè“è‰²ï¼šå·¦ä¸‹è§’ç‚¹ï¼Œçº¢è‰²ï¼šå³ä¸Šè§’ç‚¹ï¼Œç°è‰²ï¼šéæ³•ç‚¹ï¼‰ã€‚  
**æ ¸å¿ƒæ¼”ç¤ºå†…å®¹**ï¼šå±•ç¤ºCDQåˆ†æ²»çš„è¿‡ç¨‹ã€å•è°ƒæ ˆçš„ç»´æŠ¤ï¼Œä»¥åŠåˆæ³•ç‚¹å¯¹çš„ç­›é€‰ã€‚


### åŠ¨ç”»å¸§æ­¥éª¤ä¸äº¤äº’å…³é”®ç‚¹
1. **åœºæ™¯åˆå§‹åŒ–**ï¼š  
   - å±å¹•å·¦ä¾§æ˜¾ç¤ºã€Œåˆ†æ²»åŒºåŸŸã€ï¼ˆåƒç´ åŒ–å¹³é¢ï¼‰ï¼Œå³ä¾§æ˜¾ç¤ºã€Œæ§åˆ¶é¢æ¿ã€ï¼ˆå¼€å§‹/æš‚åœã€å•æ­¥ã€é‡ç½®æŒ‰é’®ï¼Œé€Ÿåº¦æ»‘å—ï¼‰ã€‚  
   - èƒŒæ™¯éŸ³ä¹ï¼š8ä½é£æ ¼çš„è½»å¿«æ—‹å¾‹ï¼ˆå¦‚ã€Šå¦å…‹å¤§æˆ˜ã€‹çš„BGMï¼‰ã€‚  

2. **åˆ†æ²»è¿‡ç¨‹**ï¼š  
   - åˆå§‹æ—¶ï¼Œæ‰€æœ‰ç‚¹æŒ‰æ¨ªåæ ‡æ’åºï¼ˆè“è‰²æ–¹å—æ’åˆ—åœ¨å¹³é¢ä¸Šï¼‰ã€‚  
   - åˆ†æ²»å¼€å§‹æ—¶ï¼Œå±å¹•ä¸­é—´å‡ºç°ä¸€æ¡ç«–çº¿ï¼Œå°†ç‚¹åˆ†æˆå·¦å³ä¸¤éƒ¨åˆ†ï¼ˆå·¦åŠéƒ¨åˆ†ä¸ºè“è‰²ï¼Œå³åŠéƒ¨åˆ†ä¸ºçº¢è‰²ï¼‰ã€‚  

3. **å•è°ƒæ ˆç»´æŠ¤**ï¼š  
   - å½“å¤„ç†å·¦åŠéƒ¨åˆ†çš„ç‚¹æ—¶ï¼Œç”¨ã€Œä¹¦æ¶ã€åŠ¨ç”»å±•ç¤ºå·¦æ ˆ`s1`çš„å¢å‡ï¼ˆå¦‚æ’å…¥æ–°ç‚¹æ—¶ï¼Œç§»é™¤ä¸ç¬¦åˆæ¡ä»¶çš„ç‚¹ï¼Œç”¨ã€Œæ»‘åŠ¨ã€åŠ¨ç”»è¡¨ç¤ºï¼‰ã€‚  
   - å½“å¤„ç†å³åŠéƒ¨åˆ†çš„ç‚¹æ—¶ï¼Œç”¨ã€Œä¹¦æ¶ã€åŠ¨ç”»å±•ç¤ºå³æ ˆ`s2`çš„å¢å‡ï¼ˆå¦‚æ’å…¥æ–°ç‚¹æ—¶ï¼Œç§»é™¤æ¨ªåæ ‡è¾ƒå¤§çš„ç‚¹ï¼Œç”¨ã€Œå¼¹å‡ºã€åŠ¨ç”»è¡¨ç¤ºï¼‰ã€‚  

4. **åˆæ³•ç‚¹å¯¹æ ‡è®°**ï¼š  
   - å½“æ‰¾åˆ°åˆæ³•ç‚¹å¯¹æ—¶ï¼Œè“è‰²ç‚¹å’Œçº¢è‰²ç‚¹åŒæ—¶é—ªçƒï¼Œå¹¶æ’­æ”¾ã€Œå®ã€çš„éŸ³æ•ˆï¼ˆå¦‚ã€Šåƒè±†äººã€‹çš„å¾—åˆ†éŸ³æ•ˆï¼‰ã€‚  
   - éæ³•ç‚¹ï¼ˆé®æŒ¡ç‚¹ï¼‰å˜ä¸ºç°è‰²ï¼Œå¹¶æ’­æ”¾ã€Œ buzzã€çš„éŸ³æ•ˆï¼ˆå¦‚ã€Šé­‚æ–—ç½—ã€‹çš„æ­»äº¡éŸ³æ•ˆï¼‰ã€‚  

5. **äº¤äº’æ§åˆ¶**ï¼š  
   - ã€Œå•æ­¥æ‰§è¡Œã€ï¼šé€æ­¥å±•ç¤ºåˆ†æ²»ã€æ ˆæ“ä½œã€ç‚¹å¯¹ç­›é€‰çš„è¿‡ç¨‹ã€‚  
   - ã€Œè‡ªåŠ¨æ’­æ”¾ã€ï¼šå¿«é€Ÿæ¼”ç¤ºå…¨è¿‡ç¨‹ï¼Œé€Ÿåº¦å¯é€šè¿‡æ»‘å—è°ƒæ•´ï¼ˆå¦‚æ…¢ã€ä¸­ã€å¿«ï¼‰ã€‚  
   - ã€Œé‡ç½®ã€ï¼šæ¢å¤åˆå§‹çŠ¶æ€ï¼Œé‡æ–°å¼€å§‹æ¼”ç¤ºã€‚  


### è®¾è®¡æ€è·¯
- **åƒç´ é£æ ¼**ï¼šè¥é€ å¤å¤æ¸¸æˆçš„æ°›å›´ï¼Œé™ä½å­¦ä¹ å‹åŠ›ã€‚  
- **åŠ¨ç”»æ•ˆæœ**ï¼šç”¨ã€Œæ»‘åŠ¨ã€ã€Œå¼¹å‡ºã€ç­‰ç®€å•åŠ¨ç”»å±•ç¤ºæ ˆæ“ä½œï¼Œè®©å­¦ä¹ è€…ç›´è§‚çœ‹åˆ°ã€Œå“ªäº›ç‚¹è¢«ä¿ç•™ï¼Œå“ªäº›ç‚¹è¢«ç§»é™¤ã€ã€‚  
- **éŸ³æ•ˆæç¤º**ï¼šç”¨ä¸åŒçš„éŸ³æ•ˆåŒºåˆ†åˆæ³•/éæ³•æ“ä½œï¼Œå¼ºåŒ–è®°å¿†ï¼ˆå¦‚ã€Œå®ã€è¡¨ç¤ºæ‰¾åˆ°åˆæ³•ç‚¹å¯¹ï¼Œã€Œbuzzã€è¡¨ç¤ºé®æŒ¡ï¼‰ã€‚  


## 6. æ‹“å±•ç»ƒä¹ ä¸ç›¸ä¼¼é—®é¢˜æ€è€ƒ

### é€šç”¨æ€è·¯/æŠ€å·§è¿ç§»
- **CDQåˆ†æ²»**ï¼šå¯ç”¨äºå¤„ç†äºŒç»´ååºé—®é¢˜ï¼ˆå¦‚ç»Ÿè®¡é€†åºå¯¹ã€ä¸‰ç»´ååºï¼‰ã€‚  
- **å•è°ƒæ ˆ**ï¼šå¯ç”¨äºå¤„ç†ã€Œæœ€è¿‘æ›´å¤§/æ›´å°å…ƒç´ ã€é—®é¢˜ï¼ˆå¦‚æŸ±çŠ¶å›¾ä¸­æœ€å¤§çŸ©å½¢ã€æ¥é›¨æ°´ï¼‰ã€‚  
- **çº¿æ®µæ ‘**ï¼šå¯ç”¨äºç»´æŠ¤åŒºé—´æœ€å¤§å€¼/æœ€å°å€¼ï¼ˆå¦‚æ¥¼æˆ¿é‡å»ºã€åŒºé—´æŸ¥è¯¢ï¼‰ã€‚  


### ç»ƒä¹ æ¨èï¼ˆæ´›è°·ï¼‰
1. **æ´›è°· P4198** - æ¥¼æˆ¿é‡å»º  
   ğŸ—£ï¸ **æ¨èç†ç”±**ï¼šè¿™é“é¢˜ä¸Lynkcatçš„é¢˜è§£æ€è·¯ä¸€è‡´ï¼Œéœ€è¦ç”¨çº¿æ®µæ ‘ç»´æŠ¤åç¼€æœ€å¤§å€¼ï¼Œé€‚åˆå·©å›ºã€Œçº¿æ®µæ ‘å¤„ç†ååºçº¦æŸã€çš„æŠ€å·§ã€‚  
2. **æ´›è°· P3810** - ä¸‰ç»´ååº  
   ğŸ—£ï¸ **æ¨èç†ç”±**ï¼šè¿™é“é¢˜æ˜¯CDQåˆ†æ²»çš„ç»å…¸é—®é¢˜ï¼Œéœ€è¦å¤„ç†ä¸‰ä¸ªç»´åº¦çš„ååºçº¦æŸï¼Œé€‚åˆæ‹“å±•ã€ŒCDQåˆ†æ²»ã€çš„åº”ç”¨ã€‚  
3. **æ´›è°· P5071** - ä¸­ä½æ•°  
   ğŸ—£ï¸ **æ¨èç†ç”±**ï¼šè¿™é“é¢˜éœ€è¦ç”¨å•è°ƒæ ˆç»´æŠ¤ä¸­ä½æ•°ï¼Œé€‚åˆå·©å›ºã€Œå•è°ƒæ ˆå¤„ç†åºåˆ—é—®é¢˜ã€çš„æŠ€å·§ã€‚  


## 7. å­¦ä¹ å¿ƒå¾—ä¸ç»éªŒåˆ†äº«ï¼ˆè‹¥æœ‰ï¼‰
**å‚è€ƒç»éªŒï¼ˆæ¥è‡ª_orz_zçš„é¢˜è§£ï¼‰**ï¼š  
â€œæˆ‘åœ¨è§£å†³è¿™ä¸ªé—®é¢˜æ—¶ï¼Œæœ€åˆåœ¨å¤„ç†ã€Œæ— é®æŒ¡ã€æ¡ä»¶æ—¶å¡äº†å¾ˆä¹…ï¼Œåæ¥é€šè¿‡ç”»ç¤ºæ„å›¾ï¼ˆå¦‚å·¦æ ˆå’Œå³æ ˆçš„ç»´æŠ¤ï¼‰æ‰æƒ³æ¸…æ¥šï¼Œå•è°ƒæ ˆå¯ä»¥ç»´æŠ¤åˆæ³•ç‚¹é›†ã€‚è¿™è®©æˆ‘æ„è¯†åˆ°ï¼Œ**ç”»å›¾æ˜¯è§£å†³å‡ ä½•é—®é¢˜çš„å¥½æ–¹æ³•**ã€‚â€  

**ç‚¹è¯„**ï¼š  
è¿™ä½ä½œè€…çš„ç»éªŒå¾ˆå…¸å‹ã€‚åœ¨å¤„ç†å‡ ä½•é—®é¢˜æ—¶ï¼Œç”»ç¤ºæ„å›¾å¯ä»¥å°†æŠ½è±¡çš„çº¦æŸè½¬åŒ–ä¸ºå…·ä½“çš„å›¾å½¢ï¼Œå¸®åŠ©ç†è§£ã€Œä¸ºä»€ä¹ˆè¦ç”¨å•è°ƒæ ˆã€ã€Œå¦‚ä½•ç»´æŠ¤åˆæ³•ç‚¹é›†ã€ã€‚åŠ¨æ‰‹ç”»å›¾ä¹Ÿæ˜¯è§£å†³ç¼–ç¨‹é—®é¢˜çš„é‡è¦æŠ€å·§ä¹‹ä¸€ã€‚  


## ç»“è¯­
æœ¬æ¬¡å…³äºã€Œã‹ã‹ã—ï¼ˆç¨»è‰äººï¼‰ã€çš„C++è§£é¢˜åˆ†æå°±åˆ°è¿™é‡Œã€‚å¸Œæœ›è¿™ä»½å­¦ä¹ æŒ‡å—èƒ½å¸®åŠ©å¤§å®¶ç†è§£CDQåˆ†æ²»ã€å•è°ƒæ ˆç­‰ç®—æ³•çš„åº”ç”¨ï¼ŒæŒæ¡è§£å†³ååºé—®é¢˜çš„æŠ€å·§ã€‚è®°ä½ï¼Œ**ç¼–ç¨‹èƒ½åŠ›çš„æå‡åœ¨äºæŒç»­å­¦ä¹ ã€å‹¤äºæ€è€ƒå’Œå‹‡äºå®è·µ**ã€‚ä¸‹æ¬¡æˆ‘ä»¬å†ä¸€èµ·æ¢ç´¢æ–°çš„ç¼–ç¨‹æŒ‘æˆ˜ï¼ğŸ’ª

---
å¤„ç†ç”¨æ—¶ï¼š166.62ç§’
# é¢˜ç›®ä¿¡æ¯

# [ARC101F] Robots and Exits

## é¢˜ç›®æè¿°

[problemUrl]: https://atcoder.jp/contests/arc101/tasks/arc101_d

æ•°ç›´ç·šä¸Šã« $ N $ ä½“ã®ãƒ­ãƒœãƒƒãƒˆã¨ $ M $ å€‹ã®å‡ºå£ãŒã‚ã‚Šã¾ã™ã€‚ ã“ã‚Œã‚‰ã® $ N\ +\ M $ å€‹ã®åº§æ¨™ã¯ã™ã¹ã¦æ•´æ•°ã§ã‚ã‚Šã€ã™ã¹ã¦ç›¸ç•°ãªã‚Šã¾ã™ã€‚ å„ $ i $ ($ 1\ \leq\ i\ \leq\ N $) ã«ã¤ã„ã¦ã€å·¦ã‹ã‚‰ $ i $ ç•ªç›®ã®ãƒ­ãƒœãƒƒãƒˆã®åº§æ¨™ã¯ $ x_i $ ã§ã™ã€‚ ã¾ãŸã€å„ $ j $ ($ 1\ \leq\ j\ \leq\ M $) ã«ã¤ã„ã¦ã€å·¦ã‹ã‚‰ $ j $ ç•ªç›®ã®å‡ºå£ã®åº§æ¨™ã¯ $ y_j $ ã§ã™ã€‚

ã™ã¬ã‘å›ã¯ã€æ¬¡ã® $ 2 $ ç¨®é¡ã®æ“ä½œã‚’å¥½ããªé †åºã§ç¹°ã‚Šè¿”ã—è¡Œã„ã€ãƒ­ãƒœãƒƒãƒˆã‚’ä¸€æ–‰ã«å‹•ã‹ã™ã“ã¨ãŒã§ãã¾ã™ã€‚

- æ•°ç›´ç·šä¸Šã®ã™ã¹ã¦ã®ãƒ­ãƒœãƒƒãƒˆã®åº§æ¨™ã‚’ $ -1 $ ã™ã‚‹ã€‚
- æ•°ç›´ç·šä¸Šã®ã™ã¹ã¦ã®ãƒ­ãƒœãƒƒãƒˆã®åº§æ¨™ã‚’ $ +1 $ ã™ã‚‹ã€‚

å„ãƒ­ãƒœãƒƒãƒˆã¯ã€ã„ãšã‚Œã‹ã®å‡ºå£ã¨é‡ãªã£ãŸç¬é–“ã€ãã®å‡ºå£ã‚’é€šã£ã¦æ•°ç›´ç·šä¸Šã‹ã‚‰æ¶ˆãˆã¾ã™ã€‚ ã™ã¬ã‘å›ã¯ã€ã™ã¹ã¦ã®ãƒ­ãƒœãƒƒãƒˆãŒæ¶ˆãˆã‚‹ã¾ã§æ“ä½œã‚’è¡Œã„ç¶šã‘ã¾ã™ã€‚

ã™ã¹ã¦ã®ãƒ­ãƒœãƒƒãƒˆãŒæ¶ˆãˆãŸå¾Œã€å„ãƒ­ãƒœãƒƒãƒˆãŒã©ã®å‡ºå£ã‚’é€šã£ãŸã‹ã¨ã„ã†çµ„åˆã›ã¯ä½•é€šã‚Šã‚ã‚Šã†ã‚‹ã§ã—ã‚‡ã†ã‹ï¼Ÿ $ 10^9\ +\ 7 $ ã§å‰²ã£ãŸä½™ã‚Šã‚’æ±‚ã‚ã¦ãã ã•ã„ã€‚ ãŸã ã—ã€$ 2 $ é€šã‚Šã®çµ„åˆã›ãŒç•°ãªã‚‹ã¨ã¯ã€ã‚ã‚‹ãƒ­ãƒœãƒƒãƒˆãŒå­˜åœ¨ã—ã€ãã®ãƒ­ãƒœãƒƒãƒˆã®é€šã£ãŸå‡ºå£ãŒç•°ãªã‚‹ã“ã¨ã‚’è¨€ã„ã¾ã™ã€‚

## è¯´æ˜/æç¤º

### åˆ¶ç´„

- $ 1\ \leq\ N,\ M\ \leq\ 10^5 $
- $ 1\ \leq\ x_1\ <\ x_2\ <\ ...\ <\ x_N\ \leq\ 10^9 $
- $ 1\ \leq\ y_1\ <\ y_2\ <\ ...\ <\ y_M\ \leq\ 10^9 $
- ä¸ãˆã‚‰ã‚Œã‚‹åº§æ¨™ã¯ã™ã¹ã¦æ•´æ•°ã§ã‚ã‚‹ã€‚
- ä¸ãˆã‚‰ã‚Œã‚‹åº§æ¨™ã¯ã™ã¹ã¦ç›¸ç•°ãªã‚‹ã€‚

### Sample Explanation 1

å·¦ã‹ã‚‰ $ i $ ç•ªç›®ã®ãƒ­ãƒœãƒƒãƒˆã‚’ãƒ­ãƒœãƒƒãƒˆ $ i $ ã¨å‘¼ã³ã€å·¦ã‹ã‚‰ $ j $ ç•ªç›®ã®å‡ºå£ã‚’å‡ºå£ $ j $ ã¨å‘¼ã³ã¾ã™ã€‚ $ ( $ãƒ­ãƒœãƒƒãƒˆ $ 1 $ ãŒé€šã£ãŸå‡ºå£$ , $ ãƒ­ãƒœãƒƒãƒˆ $ 2 $ ãŒé€šã£ãŸå‡ºå£$ ) $ ã®çµ„åˆã›ã¨ã—ã¦ã‚ã‚Šã†ã‚‹ã‚‚ã®ã¯ã€æ¬¡ã® $ 3 $ é€šã‚Šã§ã™ã€‚ - $ ( $å‡ºå£ $ 1 $$ , $ å‡ºå£ $ 1 $$ ) $ - $ ( $å‡ºå£ $ 1 $$ , $ å‡ºå£ $ 2 $$ ) $ - $ ( $å‡ºå£ $ 2 $$ , $ å‡ºå£ $ 2 $$ ) $

### Sample Explanation 2

å„ãƒ­ãƒœãƒƒãƒˆã”ã¨ç‹¬ç«‹ã«é€šã‚‹å‡ºå£ã‚’æ±ºã‚ã‚‰ã‚Œã‚‹ã®ã§ã€çµ„åˆã›ã¯ $ 2^3\ =\ 8 $ é€šã‚Šã§ã™ã€‚

### Sample Explanation 3

ã©ã®ãƒ­ãƒœãƒƒãƒˆã‚‚å‡ºå£ $ 1 $ ã‚’é€šã‚Šã¾ã™ã€‚

## æ ·ä¾‹ #1

### è¾“å…¥

```
2 2

2 3

1 4```

### è¾“å‡º

```
3```

## æ ·ä¾‹ #2

### è¾“å…¥

```
3 4

2 5 10

1 3 7 13```

### è¾“å‡º

```
8```

## æ ·ä¾‹ #3

### è¾“å…¥

```
4 1

1 2 4 5

3```

### è¾“å‡º

```
1```

## æ ·ä¾‹ #4

### è¾“å…¥

```
4 5

2 5 7 11

1 3 6 9 13```

### è¾“å‡º

```
6```

## æ ·ä¾‹ #5

### è¾“å…¥

```
10 10

4 13 15 18 19 20 21 22 25 27

1 5 11 12 14 16 23 26 29 30```

### è¾“å‡º

```
22```

# AIåˆ†æç»“æœ

# ğŸ’¡ Kayçš„C++ç®—æ³•è§£æï¼š[ARC101F] Robots and Exits æ·±å…¥å­¦ä¹ æŒ‡å— ğŸ’¡


## 1. é¢˜ç›®è§£è¯»ä¸æ ¸å¿ƒç®—æ³•è¯†åˆ«

âœ¨ **æœ¬é¢˜ä¸»è¦è€ƒå¯Ÿ**ï¼šäºŒç»´ååºä¸æ ‘çŠ¶æ•°ç»„ä¼˜åŒ–åŠ¨æ€è§„åˆ’ï¼ˆDPï¼‰


### ğŸ—£ï¸ åˆæ­¥åˆ†æ
è§£å†³â€œRobots and Exitsâ€çš„å…³é”®ï¼Œæ˜¯å°†æœºå™¨äººçš„å‡ºå£é€‰æ‹©é—®é¢˜**è½¬åŒ–ä¸ºäºŒç»´å¹³é¢ä¸Šçš„ç‚¹é›†é—®é¢˜**ã€‚ç®€å•æ¥è¯´ï¼Œæ¯ä¸ªæœºå™¨äººå¯ä»¥ç”¨ä¸€ä¸ªäºŒå…ƒç»„ `(l_i, r_i)` è¡¨ç¤ºâ€”â€”`l_i` æ˜¯å®ƒåˆ°å·¦è¾¹æœ€è¿‘å‡ºå£çš„è·ç¦»ï¼Œ`r_i` æ˜¯åˆ°å³è¾¹æœ€è¿‘å‡ºå£çš„è·ç¦»ã€‚æœºå™¨äººé€‰æ‹©å·¦è¾¹å‡ºå£çš„æ¡ä»¶æ˜¯â€œå‘å·¦ç§»åŠ¨çš„æœ€å¤§è·ç¦»å…ˆè¾¾åˆ° `l_i`â€ï¼Œé€‰æ‹©å³è¾¹åˆ™æ˜¯â€œå‘å³ç§»åŠ¨çš„æœ€å¤§è·ç¦»å…ˆè¾¾åˆ° `r_i`â€ã€‚

#### æ ¸å¿ƒç®—æ³•æ€è·¯
æˆ‘ä»¬éœ€è¦ç»Ÿè®¡**åˆæ³•çš„å‡ºå£é€‰æ‹©ç»„åˆæ•°**ã€‚åˆæ³•ç»„åˆçš„çº¦æŸæ˜¯ï¼šè‹¥æœºå™¨äºº `i` é€‰æ‹©å³è¾¹å‡ºå£ï¼ˆå³ `(l_i, r_i)` è¢«â€œé€‰ä¸­â€ï¼‰ï¼Œåˆ™æ‰€æœ‰æ»¡è¶³ `l_j â‰¥ l_i` ä¸” `r_j â‰¤ r_i` çš„æœºå™¨äºº `j` ä¹Ÿå¿…é¡»é€‰æ‹©å³è¾¹å‡ºå£ï¼ˆå¦åˆ™ä¼šè¿åç§»åŠ¨é€»è¾‘ï¼‰ã€‚è¿™ç§çº¦æŸç­‰ä»·äºåœ¨äºŒç»´å¹³é¢ä¸Šé€‰æ‹©ä¸€ä¸ª**ä¸¥æ ¼ä¸Šå‡çš„å­åºåˆ—**ï¼ˆ`l` é€’å¢ã€`r` é€’å¢ï¼‰ï¼Œå› ä¸ºåªæœ‰è¿™æ ·çš„å­åºåˆ—æ‰èƒ½ä¿è¯çº¦æŸæˆç«‹ã€‚

#### æ ¸å¿ƒéš¾ç‚¹ä¸è§£å†³æ–¹æ¡ˆ
- **éš¾ç‚¹1**ï¼šå¦‚ä½•å°†é—®é¢˜è½¬åŒ–ä¸ºäºŒç»´ååºæ¨¡å‹ï¼Ÿ  
  è§£å†³æ–¹æ¡ˆï¼šé€šè¿‡ `(l_i, r_i)` æ˜ å°„ï¼Œå°†æœºå™¨äººçš„é€‰æ‹©çº¦æŸè½¬åŒ–ä¸ºâ€œä¸¥æ ¼ä¸Šå‡å­åºåˆ—â€é—®é¢˜ã€‚  
- **éš¾ç‚¹2**ï¼šå¦‚ä½•é«˜æ•ˆè®¡ç®—ä¸¥æ ¼ä¸Šå‡å­åºåˆ—çš„æ•°é‡ï¼Ÿ  
  è§£å†³æ–¹æ¡ˆï¼šä½¿ç”¨**æ ‘çŠ¶æ•°ç»„ï¼ˆBITï¼‰**ä¼˜åŒ–DPè½¬ç§»ã€‚å°†ç‚¹æŒ‰ `l` æ’åºï¼ˆç¡®ä¿ `l` é€’å¢ï¼‰ï¼Œç„¶åæŒ‰ `r` å€’åºå¤„ç†ï¼ˆé¿å…é‡å¤è®¡ç®—ï¼‰ï¼Œç”¨æ ‘çŠ¶æ•°ç»„ç»´æŠ¤ `r` çš„å‰ç¼€å’Œï¼Œå¿«é€ŸæŸ¥è¯¢æ»¡è¶³ `r_j < r_i` çš„å­åºåˆ—æ•°é‡ã€‚

#### å¯è§†åŒ–è®¾è®¡æ€è·¯
ä¸ºäº†ç›´è§‚å±•ç¤ºç®—æ³•æµç¨‹ï¼Œæˆ‘ä»¬è®¾è®¡ä¸€ä¸ª**8ä½åƒç´ é£æ ¼çš„åŠ¨ç”»**ï¼š
- **åœºæ™¯**ï¼šäºŒç»´å¹³é¢ä¸Šçš„åƒç´ ç‚¹è¡¨ç¤º `(l_i, r_i)`ï¼Œæ¨ªåæ ‡ä¸º `l`ï¼Œçºµåæ ‡ä¸º `r`ã€‚
- **æ’åºè¿‡ç¨‹**ï¼šç‚¹æŒ‰ `l` ä»å°åˆ°å¤§æ’åˆ—ï¼Œç”¨â€œæ»‘åŠ¨çª—å£â€é«˜äº®å½“å‰å¤„ç†çš„ç‚¹ã€‚
- **æ ‘çŠ¶æ•°ç»„æ“ä½œ**ï¼šç”¨â€œè¿›åº¦æ¡â€è¡¨ç¤ºæ ‘çŠ¶æ•°ç»„çš„å‰ç¼€æŸ¥è¯¢ï¼ˆ`query(r_i-1)`ï¼‰ï¼Œç”¨â€œé—ªçƒâ€è¡¨ç¤ºå•ç‚¹æ›´æ–°ï¼ˆ`add(r_i, value)`ï¼‰ã€‚
- **æ¸¸æˆåŒ–å…ƒç´ **ï¼šæ¯å®Œæˆä¸€ä¸ªç‚¹çš„å¤„ç†ï¼Œæ’­æ”¾â€œå®â€çš„éŸ³æ•ˆï¼›å®Œæˆæ‰€æœ‰ç‚¹åï¼Œæ˜¾ç¤ºâ€œèƒœåˆ©â€åŠ¨ç”»ï¼ˆå¦‚åƒç´ çƒŸèŠ±ï¼‰ã€‚


## 2. ç²¾é€‰ä¼˜è´¨é¢˜è§£å‚è€ƒ

### ğŸ“ é¢˜è§£ä¸€ï¼ˆæ¥æºï¼šDreamsChaserï¼Œèµ24ï¼‰
**ç‚¹è¯„**ï¼š  
è¿™ä»½é¢˜è§£çš„æ€è·¯**éå¸¸æ¸…æ™°**ï¼Œç›´æ¥å°†é—®é¢˜è½¬åŒ–ä¸ºäºŒç»´ååºæ¨¡å‹ï¼Œå¹¶ç”¨æ ‘çŠ¶æ•°ç»„ä¼˜åŒ–DPã€‚ä»£ç ç»“æ„è§„èŒƒï¼ˆå˜é‡åå¦‚ `node`ã€`BIT` å«ä¹‰æ˜ç¡®ï¼‰ï¼Œç¦»æ•£åŒ–å¤„ç†å¾—å½“ï¼ˆå°† `r` æ˜ å°„åˆ°å°å€¼åŸŸï¼‰ï¼Œè¾¹ç•Œæ¡ä»¶ä¸¥è°¨ï¼ˆè·³è¿‡å·¦å³æ— å‡ºå£çš„æœºå™¨äººï¼‰ã€‚å…¶äº®ç‚¹æ˜¯**å°†DPè½¬ç§»æ–¹ç¨‹ `f_i = 1 + sum_{j: l_j < l_i, r_j < r_i} f_j` ç”¨æ ‘çŠ¶æ•°ç»„é«˜æ•ˆå®ç°**ï¼Œæ—¶é—´å¤æ‚åº¦ `O(n log n)`ï¼Œé€‚åˆç«èµ›åœºæ™¯ã€‚


### ğŸ“ é¢˜è§£äºŒï¼ˆæ¥æºï¼šSoulistï¼Œèµ14ï¼‰
**ç‚¹è¯„**ï¼š  
æ­¤é¢˜è§£çš„**åˆ›æ–°ç‚¹**æ˜¯ä½¿ç”¨**åŠ¨æ€å¼€ç‚¹çº¿æ®µæ ‘**å¤„ç† `r` çš„å¤§å€¼åŸŸé—®é¢˜ï¼ˆæ— éœ€ç¦»æ•£åŒ–ï¼‰ï¼Œé€‚åˆå€¼åŸŸæå¤§çš„æƒ…å†µã€‚æ€è·¯ä¸Šï¼Œå°†æœºå™¨äººæŒ‰ `l` æ’åºåï¼Œç”¨çº¿æ®µæ ‘ç»´æŠ¤ `r` çš„å‰ç¼€å’Œï¼Œè½¬ç§»é€»è¾‘ä¸æ ‘çŠ¶æ•°ç»„ä¸€è‡´ã€‚ä»£ç é£æ ¼ç®€æ´ï¼Œå˜é‡å‘½åï¼ˆå¦‚ `tr`ã€`ls`ã€`rs`ï¼‰ç¬¦åˆçº¿æ®µæ ‘çš„å¸¸è§„ä¹ æƒ¯ï¼Œå®è·µä»·å€¼é«˜ã€‚


### ğŸ“ é¢˜è§£ä¸‰ï¼ˆæ¥æºï¼šxhtï¼Œèµ5ï¼‰
**ç‚¹è¯„**ï¼š  
è¿™ä»½é¢˜è§£çš„**ä¼˜åŠ¿**æ˜¯ä»£ç ç®€æ´ï¼Œç¦»æ•£åŒ–å¤„ç†ï¼ˆ`X`ã€`Y` æ•°ç»„ï¼‰å’Œæ’åºé€»è¾‘ï¼ˆ`p` æ•°ç»„æŒ‰ `l` æ’åºï¼‰æ¸…æ™°æ˜“æ‡‚ã€‚å…¶DPè½¬ç§»æ–¹ç¨‹çš„æ¨å¯¼ï¼ˆ`ans = 1 + sum f_i`ï¼‰å‡†ç¡®ï¼Œæ ‘çŠ¶æ•°ç»„çš„ `add` å’Œ `ask` å‡½æ•°å®ç°è§„èŒƒã€‚é€‚åˆåˆå­¦è€…ç†è§£â€œäºŒç»´ååº+æ ‘çŠ¶æ•°ç»„â€çš„æ ¸å¿ƒé€»è¾‘ã€‚


## 3. æ ¸å¿ƒéš¾ç‚¹è¾¨æä¸è§£é¢˜ç­–ç•¥

### ğŸ”‘ å…³é”®ç‚¹1ï¼šé—®é¢˜è½¬åŒ–ä¸ºäºŒç»´ååºæ¨¡å‹
**åˆ†æ**ï¼š  
æœºå™¨äººçš„é€‰æ‹©çº¦æŸï¼ˆè‹¥ `i` é€‰å³è¾¹ï¼Œåˆ™ `j` å¿…é¡»é€‰å³è¾¹å½“ä¸”ä»…å½“ `l_j â‰¥ l_i` ä¸” `r_j â‰¤ r_i`ï¼‰ç­‰ä»·äºåœ¨ `(l_i, r_i)` ç‚¹é›†ä¸­é€‰æ‹©ä¸¥æ ¼ä¸Šå‡å­åºåˆ—ã€‚è¿™ä¸€æ­¥æ˜¯è§£é¢˜çš„æ ¸å¿ƒï¼Œéœ€è¦ç†è§£â€œç§»åŠ¨é€»è¾‘â€ä¸â€œç‚¹é›†çº¦æŸâ€çš„å¯¹åº”å…³ç³»ã€‚  
**å­¦ä¹ ç¬”è®°**ï¼šé—®é¢˜è½¬åŒ–æ˜¯è§£å†³å¤æ‚ç®—æ³•é¢˜çš„å…³é”®ï¼Œéœ€å¤šç»ƒä¹ â€œç°å®é—®é¢˜â†’æ•°å­¦æ¨¡å‹â€çš„æ˜ å°„ã€‚


### ğŸ”‘ å…³é”®ç‚¹2ï¼šå¤§å€¼åŸŸçš„ç¦»æ•£åŒ–å¤„ç†
**åˆ†æ**ï¼š  
`r_i` çš„å€¼åŸŸå¯èƒ½è¾¾åˆ° `1e9`ï¼Œç›´æ¥ç”¨æ ‘çŠ¶æ•°ç»„ä¼šè¶…å‡ºå†…å­˜é™åˆ¶ã€‚éœ€å°† `r_i` ç¦»æ•£åŒ–ï¼ˆæ’åºâ†’å»é‡â†’æ˜ å°„åˆ°å°æ•´æ•°ï¼‰ï¼Œå‡å°‘æ ‘çŠ¶æ•°ç»„çš„å¤§å°ã€‚  
**å­¦ä¹ ç¬”è®°**ï¼šç¦»æ•£åŒ–æ˜¯å¤„ç†å¤§å€¼åŸŸé—®é¢˜çš„å¸¸ç”¨æŠ€å·§ï¼Œé€‚ç”¨äºæ ‘çŠ¶æ•°ç»„ã€çº¿æ®µæ ‘ç­‰æ•°æ®ç»“æ„ã€‚


### ğŸ”‘ å…³é”®ç‚¹3ï¼šæ ‘çŠ¶æ•°ç»„çš„æ­£ç¡®åº”ç”¨
**åˆ†æ**ï¼š  
æ ‘çŠ¶æ•°ç»„ç”¨äºç»´æŠ¤ `r` çš„å‰ç¼€å’Œï¼Œæ”¯æŒå¿«é€ŸæŸ¥è¯¢ï¼ˆ`query(r_i-1)`ï¼šè·å– `r_j < r_i` çš„å­åºåˆ—æ•°é‡ï¼‰å’Œå•ç‚¹æ›´æ–°ï¼ˆ`add(r_i, value)`ï¼šå°†å½“å‰ç‚¹çš„è´¡çŒ®åŠ å…¥æ ‘çŠ¶æ•°ç»„ï¼‰ã€‚æ’åºæ—¶éœ€æŒ‰ `l` é€’å¢ã€`r` é€’å‡ï¼Œé¿å…é‡å¤è®¡ç®—ã€‚  
**å­¦ä¹ ç¬”è®°**ï¼šæ ‘çŠ¶æ•°ç»„çš„æ ¸å¿ƒæ˜¯â€œå‰ç¼€å’Œâ€ä¸â€œå•ç‚¹æ›´æ–°â€ï¼Œéœ€ç»“åˆé—®é¢˜çš„æ’åºæ–¹å¼æ­£ç¡®ä½¿ç”¨ã€‚


### âœ¨ è§£é¢˜æŠ€å·§æ€»ç»“
1. **é—®é¢˜è½¬åŒ–**ï¼šå°†ç°å®é—®é¢˜æ˜ å°„åˆ°æ•°å­¦æ¨¡å‹ï¼ˆå¦‚äºŒç»´ååºï¼‰ï¼Œç®€åŒ–é—®é¢˜å¤æ‚åº¦ã€‚  
2. **ç¦»æ•£åŒ–**ï¼šå¤„ç†å¤§å€¼åŸŸé—®é¢˜ï¼Œå‡å°‘æ•°æ®ç»“æ„çš„å†…å­˜å ç”¨ã€‚  
3. **æ ‘çŠ¶æ•°ç»„ä¼˜åŒ–**ï¼šé«˜æ•ˆå¤„ç†äºŒç»´ååºä¸­çš„å‰ç¼€å’ŒæŸ¥è¯¢ï¼Œé™ä½æ—¶é—´å¤æ‚åº¦ã€‚  


## 4. C++æ ¸å¿ƒä»£ç å®ç°èµæ

### ğŸ“Œ æœ¬é¢˜é€šç”¨æ ¸å¿ƒC++å®ç°å‚è€ƒï¼ˆç»¼åˆè‡ªDreamsChaseré¢˜è§£ï¼‰
**è¯´æ˜**ï¼šæœ¬ä»£ç ç»¼åˆäº†ä¼˜è´¨é¢˜è§£çš„æ€è·¯ï¼Œå®ç°äº†â€œäºŒç»´ååº+æ ‘çŠ¶æ•°ç»„ä¼˜åŒ–DPâ€çš„æ ¸å¿ƒé€»è¾‘ï¼Œé€‚åˆåˆå­¦è€…å‚è€ƒã€‚  
**å®Œæ•´æ ¸å¿ƒä»£ç **ï¼š
```cpp
#include <iostream>
#include <vector>
#include <algorithm>
using namespace std;

const int N = 1e5 + 10;
const int MOD = 1e9 + 7;

struct Node {
    int l, r;
    bool operator<(const Node& other) const {
        return l == other.l ? r > other.r : l < other.l;
    }
};

vector<Node> nodes;
vector<int> r_vals;

struct BIT {
    vector<long long> c;
    BIT(int size) : c(size + 2, 0) {}
    void add(int x, long long val) {
        for (; x < c.size(); x += x & -x) {
            c[x] = (c[x] + val) % MOD;
        }
    }
    long long query(int x) {
        long long res = 0;
        for (; x > 0; x -= x & -x) {
            res = (res + c[x]) % MOD;
        }
        return res;
    }
};

int main() {
    int n, m;
    cin >> n >> m;
    vector<int> a(n), b(m);
    for (int i = 0; i < n; ++i) cin >> a[i];
    for (int i = 0; i < m; ++i) cin >> b[i];
    
    // ç­›é€‰ä¸­é—´çš„æœºå™¨äººï¼ˆå·¦å³éƒ½æœ‰å‡ºå£ï¼‰
    for (int x : a) {
        int pos = lower_bound(b.begin(), b.end(), x) - b.begin();
        if (pos == 0 || pos == m) continue; // å·¦å³æ— å‡ºå£ï¼Œè·³è¿‡
        int l = x - b[pos-1];
        int r = b[pos] - x;
        nodes.push_back({l, r});
        r_vals.push_back(r);
    }
    
    // ç¦»æ•£åŒ–rå€¼
    sort(r_vals.begin(), r_vals.end());
    r_vals.erase(unique(r_vals.begin(), r_vals.end()), r_vals.end());
    for (auto& node : nodes) {
        node.r = lower_bound(r_vals.begin(), r_vals.end(), node.r) - r_vals.begin() + 1;
    }
    
    // æŒ‰læ’åºï¼Œlç›¸åŒåˆ™ré™åº
    sort(nodes.begin(), nodes.end());
    
    // æ ‘çŠ¶æ•°ç»„ä¼˜åŒ–DP
    BIT bit(r_vals.size());
    bit.add(1, 1); // åˆå§‹çŠ¶æ€ï¼šç©ºåºåˆ—
    long long ans = 1;
    for (int i = 0; i < nodes.size(); ++i) {
        if (i > 0 && nodes[i].l == nodes[i-1].l && nodes[i].r == nodes[i-1].r) {
            continue; // å»é‡ï¼Œé¿å…é‡å¤è®¡ç®—
        }
        long long cnt = bit.query(nodes[i].r - 1);
        bit.add(nodes[i].r, cnt);
        ans = (ans + cnt) % MOD;
    }
    
    cout << ans << endl;
    return 0;
}
```
**ä»£ç è§£è¯»æ¦‚è¦**ï¼š  
1. **è¾“å…¥å¤„ç†**ï¼šè¯»å–æœºå™¨äººå’Œå‡ºå£åæ ‡ã€‚  
2. **ç­›é€‰ä¸­é—´æœºå™¨äºº**ï¼šè·³è¿‡å·¦å³æ— å‡ºå£çš„æœºå™¨äººï¼Œè®¡ç®— `(l_i, r_i)`ã€‚  
3. **ç¦»æ•£åŒ–**ï¼šå°† `r_i` æ˜ å°„åˆ°å°æ•´æ•°ï¼Œå‡å°‘æ ‘çŠ¶æ•°ç»„å¤§å°ã€‚  
4. **æ’åº**ï¼šæŒ‰ `l` é€’å¢ã€`r` é€’å‡æ’åºï¼Œç¡®ä¿DPè½¬ç§»çš„æ­£ç¡®æ€§ã€‚  
5. **æ ‘çŠ¶æ•°ç»„DP**ï¼šç”¨æ ‘çŠ¶æ•°ç»„ç»´æŠ¤ `r` çš„å‰ç¼€å’Œï¼Œè®¡ç®—ä¸¥æ ¼ä¸Šå‡å­åºåˆ—çš„æ•°é‡ã€‚  


### ğŸ“Œ é¢˜è§£ä¸€ï¼ˆDreamsChaserï¼‰æ ¸å¿ƒç‰‡æ®µèµæ
**äº®ç‚¹**ï¼šæ ‘çŠ¶æ•°ç»„çš„ç®€æ´å®ç°ä¸DPè½¬ç§»çš„æ­£ç¡®æ€§ã€‚  
**æ ¸å¿ƒä»£ç ç‰‡æ®µ**ï¼š
```cpp
struct BIT {
    int c[N];
    void add(int x, int d) {
        for (; x <= Max; x += x & -x) c[x] = (c[x] + d) % MOD;
    }
    int ask(int x) {
        int sum = 0;
        for (; x; x -= x & -x) sum = (sum + c[x]) % MOD;
        return sum;
    }
};

// DPè½¬ç§»
S.add(1, 1);
for (int i = 1; i <= tot; ++i) {
    if (node[i].first == node[i-1].first && node[i].second == node[i-1].second) continue;
    int t = S.ask(node[i].second - 1);
    S.add(node[i].second, t);
}
```
**ä»£ç è§£è¯»**ï¼š  
- `BIT` ç»“æ„ä½“å®ç°äº†æ ‘çŠ¶æ•°ç»„çš„ `add`ï¼ˆå•ç‚¹æ›´æ–°ï¼‰å’Œ `ask`ï¼ˆå‰ç¼€æŸ¥è¯¢ï¼‰åŠŸèƒ½ã€‚  
- `S.add(1, 1)` åˆå§‹åŒ–æ ‘çŠ¶æ•°ç»„ï¼Œè¡¨ç¤ºç©ºåºåˆ—çš„æ–¹æ¡ˆæ•°ä¸º1ã€‚  
- å¾ªç¯ä¸­ï¼Œ`t = S.ask(node[i].second - 1)` è·å–æ‰€æœ‰ `r_j < r_i` çš„å­åºåˆ—æ•°é‡ï¼Œ`S.add(node[i].second, t)` å°†å½“å‰ç‚¹çš„è´¡çŒ®åŠ å…¥æ ‘çŠ¶æ•°ç»„ã€‚  
**å­¦ä¹ ç¬”è®°**ï¼šæ ‘çŠ¶æ•°ç»„çš„æ ¸å¿ƒæ˜¯â€œlowbitâ€æ“ä½œï¼Œç”¨äºå¿«é€Ÿå®šä½æ›´æ–°å’ŒæŸ¥è¯¢çš„ä½ç½®ã€‚


## 5. ç®—æ³•å¯è§†åŒ–ï¼šåƒç´ åŠ¨ç”»æ¼”ç¤º (æ ¸å¿ƒéƒ¨åˆ†)

### ğŸ® åŠ¨ç”»æ¼”ç¤ºä¸»é¢˜ï¼šåƒç´ ç‚¹çš„â€œä¸Šå‡ä¹‹æ—…â€
**è®¾è®¡æ€è·¯**ï¼š  
é‡‡ç”¨8ä½åƒç´ é£æ ¼ï¼ˆç±»ä¼¼FCæ¸¸æˆï¼‰ï¼Œç”¨åƒç´ ç‚¹è¡¨ç¤º `(l_i, r_i)`ï¼Œé€šè¿‡åŠ¨ç”»å±•ç¤ºâ€œæ’åºâ†’ç¦»æ•£åŒ–â†’æ ‘çŠ¶æ•°ç»„æ›´æ–°â€çš„æµç¨‹ï¼Œå¢å¼ºå­¦ä¹ è¶£å‘³æ€§ã€‚


### ğŸ“ åŠ¨ç”»å¸§æ­¥éª¤ä¸äº¤äº’å…³é”®ç‚¹
1. **åœºæ™¯åˆå§‹åŒ–**ï¼š  
   - å±å¹•å·¦ä¾§æ˜¾ç¤ºäºŒç»´å¹³é¢ï¼ˆ`l` ä¸ºæ¨ªåæ ‡ï¼Œ`r` ä¸ºçºµåæ ‡ï¼‰ï¼Œå³ä¾§æ˜¾ç¤ºæ ‘çŠ¶æ•°ç»„çš„â€œè¿›åº¦æ¡â€ã€‚  
   - åƒç´ ç‚¹ç”¨ä¸åŒé¢œè‰²è¡¨ç¤ºï¼ˆå¦‚è“è‰²è¡¨ç¤ºæœªå¤„ç†ï¼Œçº¢è‰²è¡¨ç¤ºå½“å‰å¤„ç†çš„ç‚¹ï¼‰ã€‚  
   - æ§åˆ¶é¢æ¿åŒ…å«â€œå¼€å§‹/æš‚åœâ€â€œå•æ­¥æ‰§è¡Œâ€â€œé‡ç½®â€æŒ‰é’®ï¼Œä»¥åŠé€Ÿåº¦æ»‘å—ã€‚

2. **æ’åºè¿‡ç¨‹**ï¼š  
   - åƒç´ ç‚¹æŒ‰ `l` ä»å°åˆ°å¤§æ’åˆ—ï¼Œç”¨â€œæ»‘åŠ¨çª—å£â€é«˜äº®å½“å‰å¤„ç†çš„ç‚¹ï¼ˆå¦‚çº¢è‰²é—ªçƒï¼‰ã€‚  
   - æ’­æ”¾â€œæ»‘åŠ¨â€éŸ³æ•ˆï¼ˆç±»ä¼¼FCæ¸¸æˆä¸­çš„ç§»åŠ¨å£°ï¼‰ã€‚

3. **ç¦»æ•£åŒ–è¿‡ç¨‹**ï¼š  
   - å°† `r` å€¼æ˜ å°„åˆ°å°æ•´æ•°ï¼Œç”¨â€œç¼©æ”¾â€åŠ¨ç”»è¡¨ç¤ºï¼ˆå¦‚åƒç´ ç‚¹çš„çºµåæ ‡ä»å¤§å˜å°ï¼‰ã€‚  
   - æ’­æ”¾â€œç¼©æ”¾â€éŸ³æ•ˆï¼ˆç±»ä¼¼â€œå®â€çš„ä¸€å£°ï¼‰ã€‚

4. **æ ‘çŠ¶æ•°ç»„æ›´æ–°**ï¼š  
   - å½“å¤„ç†åˆ°æŸä¸ªç‚¹æ—¶ï¼Œç”¨â€œè¿›åº¦æ¡â€è¡¨ç¤ºæ ‘çŠ¶æ•°ç»„çš„å‰ç¼€æŸ¥è¯¢ï¼ˆ`query(r_i-1)`ï¼‰ï¼Œè¿›åº¦æ¡çš„é•¿åº¦å¯¹åº”æŸ¥è¯¢ç»“æœã€‚  
   - ç”¨â€œé—ªçƒâ€åŠ¨ç”»è¡¨ç¤ºå•ç‚¹æ›´æ–°ï¼ˆ`add(r_i, value)`ï¼‰ï¼Œé—ªçƒçš„æ¬¡æ•°å¯¹åº”æ›´æ–°çš„æ¬¡æ•°ã€‚  
   - æ’­æ”¾â€œæ›´æ–°â€éŸ³æ•ˆï¼ˆç±»ä¼¼â€œå•ªâ€çš„ä¸€å£°ï¼‰ã€‚

5. **ç»“æŸçŠ¶æ€**ï¼š  
   - æ‰€æœ‰ç‚¹å¤„ç†å®Œæˆåï¼Œæ˜¾ç¤ºâ€œèƒœåˆ©â€åŠ¨ç”»ï¼ˆå¦‚åƒç´ çƒŸèŠ±ï¼‰ï¼Œå¹¶æ’­æ”¾â€œèƒœåˆ©â€éŸ³æ•ˆï¼ˆç±»ä¼¼FCæ¸¸æˆçš„é€šå…³å£°ï¼‰ã€‚  
   - å±å¹•æ˜¾ç¤ºæœ€ç»ˆçš„æ–¹æ¡ˆæ•°ï¼ˆå¦‚â€œç­”æ¡ˆï¼š3â€ï¼‰ã€‚


### ğŸ“¢ æ—ç™½æç¤ºï¼ˆæ–‡å­—æ°”æ³¡ï¼‰
- â€œç°åœ¨æˆ‘ä»¬è¦å¤„ç†ç¬¬iä¸ªç‚¹ï¼Œå®ƒçš„(l, r)æ˜¯(2, 3)ï¼â€  
- â€œæŸ¥è¯¢r=2çš„å‰ç¼€å’Œï¼Œå¾—åˆ°1ï¼Œè¿™è¡¨ç¤ºæœ‰1ç§æ–¹æ¡ˆï¼â€  
- â€œå°†r=3çš„ä½ç½®æ›´æ–°ä¸º1ï¼Œè¿™æ ·åé¢çš„ç‚¹å¯ä»¥ç”¨åˆ°è¿™ä¸ªå€¼ï¼â€


## 6. æ‹“å±•ç»ƒä¹ ä¸ç›¸ä¼¼é—®é¢˜æ€è€ƒ

### ğŸ§  é€šç”¨æ€è·¯è¿ç§»
â€œäºŒç»´ååº+æ ‘çŠ¶æ•°ç»„ä¼˜åŒ–â€çš„æ€è·¯é€‚ç”¨äºä»¥ä¸‹åœºæ™¯ï¼š  
1. **æœ€é•¿ä¸Šå‡å­åºåˆ—ï¼ˆLISï¼‰**ï¼šå°†åºåˆ—ä¸­çš„å…ƒç´ è§†ä¸º `(i, a_i)`ï¼Œæ±‚ä¸¥æ ¼ä¸Šå‡å­åºåˆ—çš„é•¿åº¦ã€‚  
2. **é€†åºå¯¹è®¡æ•°**ï¼šå°†åºåˆ—ä¸­çš„å…ƒç´ è§†ä¸º `(a_i, i)`ï¼Œæ±‚é€†åºå¯¹çš„æ•°é‡ã€‚  
3. **åŒºé—´æŸ¥è¯¢ä¸æ›´æ–°**ï¼šå¦‚æ±‚åŒºé—´å’Œã€åŒºé—´æœ€å¤§å€¼ç­‰ï¼Œæ ‘çŠ¶æ•°ç»„æ˜¯å¸¸ç”¨çš„ä¼˜åŒ–å·¥å…·ã€‚


### ğŸ“š æ´›è°·ç»ƒä¹ æ¨è
1. **æ´›è°· P1439** - æœ€é•¿ä¸Šå‡å­åºåˆ—  
   **æ¨èç†ç”±**ï¼šè¿™æ˜¯â€œäºŒç»´ååº+æ ‘çŠ¶æ•°ç»„â€çš„åŸºç¡€é¢˜ï¼Œå¸®åŠ©å·©å›ºä¸¥æ ¼ä¸Šå‡å­åºåˆ—çš„è®¡æ•°é€»è¾‘ã€‚  
2. **æ´›è°· P3369** - å¹³è¡¡æ ‘ï¼ˆæ¨¡æ¿é¢˜ï¼‰  
   **æ¨èç†ç”±**ï¼šå¹³è¡¡æ ‘æ˜¯å¤„ç†åŠ¨æ€äºŒç»´ååºçš„å·¥å…·ï¼Œä¸æ ‘çŠ¶æ•°ç»„å½¢æˆäº’è¡¥ã€‚  
3. **æ´›è°· P2085** - æœ€å°å‡½æ•°å€¼  
   **æ¨èç†ç”±**ï¼šæœ¬é¢˜éœ€è¦ç”¨åˆ°â€œä¼˜å…ˆé˜Ÿåˆ—+æ ‘çŠ¶æ•°ç»„â€çš„ç»„åˆï¼Œæ‹“å±•äºŒç»´ååºçš„åº”ç”¨åœºæ™¯ã€‚


## 7. å­¦ä¹ å¿ƒå¾—ä¸ç»éªŒåˆ†äº« (è‹¥æœ‰)

### ğŸ“ æ¥è‡ªé¢˜è§£çš„ç»éªŒåˆ†äº«
- **DreamsChaser**ï¼šâ€œå°†é—®é¢˜è½¬åŒ–ä¸ºäºŒç»´ååºæ¨¡å‹æ˜¯è§£é¢˜çš„å…³é”®ï¼Œéœ€è¦å¤šæ€è€ƒâ€˜çº¦æŸæ¡ä»¶â€™ä¸â€˜æ•°å­¦æ¨¡å‹â€™çš„å¯¹åº”å…³ç³»ã€‚â€  
  **ç‚¹è¯„**ï¼šè¿™æé†’æˆ‘ä»¬ï¼Œè§£å†³å¤æ‚é—®é¢˜æ—¶ï¼Œä¸è¦å±€é™äºé—®é¢˜çš„è¡¨é¢ï¼Œè¦æ·±å…¥åˆ†æçº¦æŸæ¡ä»¶ï¼Œå¯»æ‰¾å…¶èƒŒåçš„æ•°å­¦è§„å¾‹ã€‚  
- **Soulist**ï¼šâ€œåŠ¨æ€å¼€ç‚¹çº¿æ®µæ ‘å¯ä»¥å¤„ç†å¤§å€¼åŸŸé—®é¢˜ï¼Œæ— éœ€ç¦»æ•£åŒ–ï¼Œé€‚åˆå€¼åŸŸæå¤§çš„æƒ…å†µã€‚â€  
  **ç‚¹è¯„**ï¼šåŠ¨æ€å¼€ç‚¹çº¿æ®µæ ‘æ˜¯æ ‘çŠ¶æ•°ç»„çš„è¡¥å……ï¼Œå½“ç¦»æ•£åŒ–æ— æ³•å¤„ç†æ—¶ï¼Œå¯ä»¥è€ƒè™‘ä½¿ç”¨ã€‚  
- **xht**ï¼šâ€œç¦»æ•£åŒ–æ—¶è¦æ³¨æ„å»é‡ï¼Œé¿å…é‡å¤æ˜ å°„å¯¼è‡´çš„é”™è¯¯ã€‚â€  
  **ç‚¹è¯„**ï¼šç¦»æ•£åŒ–çš„æ ¸å¿ƒæ˜¯â€œå”¯ä¸€æ˜ å°„â€ï¼Œå»é‡æ˜¯å¿…ä¸å¯å°‘çš„æ­¥éª¤ã€‚


## ğŸ‰ ç»“è¯­
æœ¬æ¬¡åˆ†æè®©æˆ‘ä»¬æŒæ¡äº†â€œäºŒç»´ååº+æ ‘çŠ¶æ•°ç»„ä¼˜åŒ–DPâ€çš„æ ¸å¿ƒæ€è·¯ï¼Œå­¦ä¼šäº†å°†ç°å®é—®é¢˜è½¬åŒ–ä¸ºæ•°å­¦æ¨¡å‹ï¼Œå¹¶é€šè¿‡é«˜æ•ˆçš„æ•°æ®ç»“æ„è§£å†³é—®é¢˜ã€‚è®°ä½ï¼Œ**ç®—æ³•çš„æœ¬è´¨æ˜¯è§£å†³é—®é¢˜çš„æ€è·¯**ï¼Œå¤šç»ƒä¹ ã€å¤šæ€è€ƒï¼Œä½ ä¼šè¶Šæ¥è¶Šæ“…é•¿è§£å†³å¤æ‚çš„ç¼–ç¨‹é—®é¢˜ï¼ğŸ’ª

--- 
**Kayçš„æç¤º**ï¼šå¦‚æœå¯¹æ ‘çŠ¶æ•°ç»„çš„æ“ä½œè¿˜ä¸ç†Ÿæ‚‰ï¼Œå¯ä»¥å°è¯•ç”¨å°ä¾‹å­ï¼ˆå¦‚æ ·ä¾‹è¾“å…¥1ï¼‰æ‰‹åŠ¨æ¨¡æ‹Ÿæ ‘çŠ¶æ•°ç»„çš„æ›´æ–°è¿‡ç¨‹ï¼Œè¿™æ ·èƒ½æ›´ç›´è§‚åœ°ç†è§£å…¶å·¥ä½œåŸç†ã€‚

---
å¤„ç†ç”¨æ—¶ï¼š205.91ç§’
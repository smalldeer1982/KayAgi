# é¢˜ç›®ä¿¡æ¯

# [AGC012D] Colorful Balls

## é¢˜ç›®æè¿°

[problemUrl]: https://atcoder.jp/contests/agc012/tasks/agc012_d

ã™ã¬ã‘ãã‚“ã¯ $ N $ å€‹ã®è‰²ãŒå¡—ã‚‰ã‚ŒãŸãƒœãƒ¼ãƒ«ã‚’ä¸€åˆ—ã«ä¸¦ã¹ã¾ã—ãŸã€‚ å·¦ã‹ã‚‰ $ i $ ç•ªç›®ã®ãƒœãƒ¼ãƒ«ã¯è‰² $ c_i $ ã§å¡—ã‚‰ã‚Œã¦ã„ã¦ã€ãã®é‡ã•ã¯ $ w_i $ ã§ã™ã€‚

ã™ã¬ã‘ãã‚“ã¯ä»¥ä¸‹ã® $ 2 $ ç¨®é¡ã®æ“ä½œã‚’ä»»æ„ã®é †åºã§ä½•å›ã§ã‚‚ç¹°ã‚Šè¿”ã—ã¦ãƒœãƒ¼ãƒ«ã®é…ç½®ã‚’å¤‰æ›´ã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚

- æ“ä½œ $ 1 $ï¼šè‰²ãŒåŒã˜ã§ã‚ã‚‹ã‚ˆã†ãª $ 2 $ ã¤ã®ãƒœãƒ¼ãƒ«ã‚’é¸ã¶ã€‚$ 2 $ ã¤ã®ãƒœãƒ¼ãƒ«ã®é‡ã•ã®å’ŒãŒ $ X $ ä»¥ä¸‹ãªã‚‰ã€$ 2 $ ã¤ã®ãƒœãƒ¼ãƒ«ã®ä½ç½®ã‚’å…¥ã‚Œæ›¿ãˆã‚‹ã€‚
- æ“ä½œ $ 2 $ï¼šè‰²ãŒç•°ãªã‚‹ã‚ˆã†ãª $ 2 $ ã¤ã®ãƒœãƒ¼ãƒ«ã‚’é¸ã¶ã€‚$ 2 $ ã¤ã®ãƒœãƒ¼ãƒ«ã®é‡ã•ã®å’ŒãŒ $ Y $ ä»¥ä¸‹ãªã‚‰ã€$ 2 $ ã¤ã®ãƒœãƒ¼ãƒ«ã®ä½ç½®ã‚’å…¥ã‚Œæ›¿ãˆã‚‹ã€‚

æœ€çµ‚çš„ãªãƒœãƒ¼ãƒ«ã®è‰²ã®ä¸¦ã³ã¨ã—ã¦ã‚ã‚Šã†ã‚‹ã‚ˆã†ãªæ•°åˆ—ã®æ•°ã‚’ modulo $ 10^9\ +\ 7 $ ã§æ±‚ã‚ã¦ãã ã•ã„ã€‚

## è¯´æ˜/æç¤º

### åˆ¶ç´„

- $ 1\ â‰¦\ N\ â‰¦\ 2\ Ã—\ 10^5 $
- $ 1\ â‰¦\ X,\ Y\ â‰¦\ 10^9 $
- $ 1\ â‰¦\ c_i\ â‰¦\ N $
- $ 1\ â‰¦\ w_i\ â‰¦\ 10^9 $
- $ X,Y,c_i,\ w_i $ ã¯ã„ãšã‚Œã‚‚æ•´æ•°

### Sample Explanation 1

\- æ“ä½œ $ 2 $ ã«ã‚ˆã‚Šå·¦ã‹ã‚‰ $ 1 $ ç•ªç›®ã®ãƒœãƒ¼ãƒ«ã®ä½ç½®ã¨å·¦ã‹ã‚‰ $ 3 $ ç•ªç›®ã®ãƒœãƒ¼ãƒ«ã®ä½ç½®ã‚’å…¥ã‚Œæ›¿ãˆã‚‹ã“ã¨ã§ã€$ (2,4,3,4) $ ã¨ã„ã†è‰²ã®ä¸¦ã³ã‚’ä½œã‚‹ã“ã¨ãŒå¯èƒ½ã§ã™ã€‚ - æ“ä½œ $ 1 $ ã«ã‚ˆã‚Šå·¦ã‹ã‚‰ $ 2 $ ç•ªç›®ã®ãƒœãƒ¼ãƒ«ã®ä½ç½®ã¨å·¦ã‹ã‚‰ $ 4 $ ç•ªç›®ã®ãƒœãƒ¼ãƒ«ã®ä½ç½®ã‚’å…¥ã‚Œæ›¿ãˆã‚‹ã“ã¨ã‚‚å¯èƒ½ã§ã™ãŒã€è‰²ã®ä¸¦ã³ã¯å¤‰åŒ–ã—ã¾ã›ã‚“ã€‚

## æ ·ä¾‹ #1

### è¾“å…¥

```
4 7 3

3 2

4 3

2 1

4 4```

### è¾“å‡º

```
2```

## æ ·ä¾‹ #2

### è¾“å…¥

```
1 1 1

1 1```

### è¾“å‡º

```
1```

## æ ·ä¾‹ #3

### è¾“å…¥

```
21 77 68

16 73

16 99

19 66

2 87

2 16

7 17

10 36

10 68

2 38

10 74

13 55

21 21

3 7

12 41

13 88

18 6

2 12

13 87

1 9

2 27

13 15```

### è¾“å‡º

```
129729600```

# AIåˆ†æç»“æœ

# ğŸ’¡ Kayçš„C++ç®—æ³•è§£æï¼šAGC012D Colorful Balls æ·±å…¥å­¦ä¹ æŒ‡å— ğŸ’¡


## 1. é¢˜ç›®è§£è¯»ä¸æ ¸å¿ƒç®—æ³•è¯†åˆ«

âœ¨ **æœ¬é¢˜ä¸»è¦è€ƒå¯Ÿ**ï¼šå›¾è®ºè¿é€šæ€§åˆ†æï¼ˆä¼˜åŒ–è¾¹æ•°ï¼‰+ ç»„åˆæ•°å­¦ï¼ˆå¯é‡æ’åˆ—ï¼‰

ğŸ—£ï¸ **åˆæ­¥åˆ†æ**ï¼š  
è§£å†³â€œColorful Ballsâ€çš„å…³é”®ï¼Œåœ¨äºç†è§£**äº¤æ¢çš„ä¼ é€’æ€§**â€”â€”å°±åƒâ€œæœ‹å‹çš„æœ‹å‹ä¹Ÿæ˜¯æœ‹å‹â€ï¼Œå¦‚æœçƒAèƒ½å’ŒBäº¤æ¢ï¼ŒBèƒ½å’ŒCäº¤æ¢ï¼Œé‚£ä¹ˆAå’ŒCä¹Ÿèƒ½äº¤æ¢ã€‚æ‰€æœ‰èƒ½äº’ç›¸äº¤æ¢çš„çƒä¼šå½¢æˆä¸€ä¸ª**è¿é€šå—**ï¼Œè¿é€šå—å†…çš„çƒå¯ä»¥ä»»æ„æ’åˆ—ï¼Œè€Œä¸åŒè¿é€šå—çš„æ’åˆ—æ˜¯ç‹¬ç«‹çš„ã€‚  

**æ ¸å¿ƒé—®é¢˜**ï¼šå¦‚ä½•é«˜æ•ˆåˆ¤æ–­å“ªäº›çƒå±äºåŒä¸€ä¸ªè¿é€šå—ï¼Ÿ  
ç›´æ¥æšä¸¾æ‰€æœ‰çƒå¯¹ï¼ˆO(nÂ²)ï¼‰ä¼šè¶…æ—¶ï¼Œå› æ­¤éœ€è¦**ç”¨â€œæœ€å°å€¼â€ä½œä¸ºåª’ä»‹å‡å°‘è¾¹æ•°**ï¼š  
- **åŒè‰²äº¤æ¢ï¼ˆæ“ä½œ1ï¼‰**ï¼šå¯¹äºé¢œè‰²cçš„æ‰€æœ‰çƒï¼Œåªè¦æŸä¸ªçƒçš„é‡é‡ä¸è¯¥é¢œè‰²çš„**æœ€è½»çƒ**ä¹‹å’Œâ‰¤Xï¼Œé‚£ä¹ˆå®ƒå°±èƒ½é€šè¿‡æœ€è½»çƒä¸å…¶ä»–åŒè‰²çƒäº¤æ¢ã€‚å› æ­¤ï¼ŒåŒè‰²è¾¹åªéœ€è¿â€œæ¯ä¸ªçƒâ†’è¯¥é¢œè‰²æœ€è½»çƒâ€ã€‚  
- **å¼‚è‰²äº¤æ¢ï¼ˆæ“ä½œ2ï¼‰**ï¼šéœ€è¦å…¨å±€**æœ€è½»çƒï¼ˆmin1ï¼‰**å’Œ**æ¬¡è½»çƒï¼ˆmin2ï¼‰**ï¼ˆå®ƒä»¬çš„é¢œè‰²ä¸åŒï¼‰ã€‚å¦‚æœçƒçš„é¢œè‰²ä¸æ˜¯min1çš„é¢œè‰²ï¼Œåªè¦å®ƒä¸min1çš„é‡é‡å’Œâ‰¤Yï¼Œå°±èƒ½è¿åˆ°min1ï¼›å¦‚æœæ˜¯min1çš„é¢œè‰²ï¼Œåˆ™éœ€è¦ä¸min2çš„é‡é‡å’Œâ‰¤Yï¼ˆå› ä¸ºmin1å’Œmin2èƒ½äº¤æ¢ï¼‰ã€‚  

**å¯è§†åŒ–è®¾è®¡æ€è·¯**ï¼š  
ç”¨8ä½åƒç´ é£æ ¼å±•ç¤ºçƒçš„é¢œè‰²ï¼ˆä¸åŒé¢œè‰²å—ï¼‰å’Œé‡é‡ï¼ˆæ•°å­—æ ‡ç­¾ï¼‰ã€‚åŠ¨ç”»ä¸­ï¼Œ**æœ€è½»çƒ**ç”¨é—ªçƒçš„é‡‘è‰²æ ‡è®°ï¼Œ**æ¬¡è½»çƒ**ç”¨é“¶è‰²æ ‡è®°ã€‚æ¯ä¸ªçƒä¼šâ€œèµ°åˆ°â€å¯¹åº”çš„æœ€å°å€¼æ—è¾¹ï¼Œç”¨çº¿æ¡è¿æ¥è¡¨ç¤ºè¿é€šã€‚å½“æ‰€æœ‰è¿é€šè¾¹ç»˜åˆ¶å®Œæˆåï¼Œè¿é€šå—ä¼šæ•´ä½“â€œè·³åŠ¨â€ï¼Œæ˜¾ç¤ºå…¶å¤§å°å’Œç»„åˆæ•°è®¡ç®—è¿‡ç¨‹ï¼ˆæ¯”å¦‚é˜¶ä¹˜çš„ä¹˜ç§¯é™¤ä»¥å„é¢œè‰²é˜¶ä¹˜çš„ä¹˜ç§¯ï¼‰ã€‚


## 2. ç²¾é€‰ä¼˜è´¨é¢˜è§£å‚è€ƒ

### é¢˜è§£ä¸€ï¼ˆä½œè€…ï¼šKinandraï¼Œèµï¼š13ï¼‰  
* **ç‚¹è¯„**ï¼š  
  è¿™ä»½é¢˜è§£çš„æ€è·¯éå¸¸æ¸…æ™°ï¼Œç›´æ¥æŠ“ä½äº†â€œæœ€å°å€¼åª’ä»‹â€çš„æ ¸å¿ƒã€‚ä½œè€…é¦–å…ˆé€šè¿‡æ•°å­¦å½’çº³æ³•è¯æ˜äº†äº¤æ¢çš„ä¼ é€’æ€§ï¼Œç„¶åæå‡ºç”¨å„é¢œè‰²æœ€å°å€¼ã€å…¨å±€æœ€å°å€¼å’Œæ¬¡å°å€¼ä¼˜åŒ–è¾¹æ•°ï¼Œå°†å¤æ‚åº¦ä»O(nÂ²)é™åˆ°äº†O(n)ã€‚ä»£ç ç®€æ´ï¼Œå˜é‡å‘½åè™½ç„¶â€œéšæ„â€ä½†é€»è¾‘æ˜ç¡®ï¼ˆæ¯”å¦‚`mc1`è¡¨ç¤ºå…¨å±€æœ€è½»é¢œè‰²ï¼Œ`mc2`è¡¨ç¤ºæ¬¡è½»é¢œè‰²ï¼‰ï¼Œç‰¹åˆ«æ˜¯ç»„åˆæ•°çš„è®¡ç®—ï¼ˆé˜¶ä¹˜Ã—é€†å…ƒï¼‰å¤„ç†å¾—å¾ˆä¸¥è°¨ã€‚äº®ç‚¹æ˜¯**åˆ¤æ–­è¿é€šæ€§çš„æ¡ä»¶**â€”â€”å¦‚æœå…¨å±€æœ€è½»å’Œæ¬¡è½»çš„é‡é‡å’Œ>Yï¼Œè¯´æ˜æ‰€æœ‰çƒéƒ½æ— æ³•è·¨é¢œè‰²äº¤æ¢ï¼Œç›´æ¥è¿”å›1ï¼Œé¿å…äº†ä¸å¿…è¦çš„è®¡ç®—ã€‚

### é¢˜è§£äºŒï¼ˆä½œè€…ï¼štuliweiï¼Œèµï¼š9ï¼‰  
* **ç‚¹è¯„**ï¼š  
  é¢˜è§£ä¸­çš„â€œæ¨è®º1â€å’Œâ€œæ¨è®º2â€éå¸¸æœ‰ç”¨ï¼Œç›´æ¥ç‚¹å‡ºäº†â€œæ— æ³•äº¤æ¢çš„çƒå¯¹ç­”æ¡ˆæ— è´¡çŒ®â€çš„å…³é”®ã€‚ä½œè€…é€šè¿‡é¢„å¤„ç†æ¯ä¸ªé¢œè‰²çš„æœ€å°å€¼ï¼Œå†è®¡ç®—å…¨å±€æœ€å°å€¼å’Œæ¬¡å°å€¼ï¼Œç„¶åéå†æ¯ä¸ªçƒåˆ¤æ–­æ˜¯å¦å±äºè¿é€šå—ï¼ˆèƒ½è¿åˆ°å…¨å±€æœ€å°å€¼æˆ–æ¬¡å°å€¼ï¼‰ã€‚ä»£ç ä¸­çš„ç»„åˆæ•°è®¡ç®—ï¼ˆ`C(tot, cnt[c])`ï¼‰ç”¨äº†é˜¶ä¹˜å’Œé€†å…ƒï¼Œæ•ˆç‡å¾ˆé«˜ã€‚äº®ç‚¹æ˜¯**ç”¨`pd_col`æ•°ç»„æ ‡è®°æ— æ³•è·¨é¢œè‰²äº¤æ¢çš„é¢œè‰²**ï¼Œå‡å°‘äº†ä¸å¿…è¦çš„éå†ã€‚

### é¢˜è§£ä¸‰ï¼ˆä½œè€…ï¼šzhiyangfanï¼Œèµï¼š8ï¼‰  
* **ç‚¹è¯„**ï¼š  
  è¿™ä»½é¢˜è§£ç”¨DFSéå†è¿é€šå—ï¼Œä»£ç ç»“æ„æ¸…æ™°ã€‚ä½œè€…é¦–å…ˆå¤„ç†åŒè‰²è¾¹ï¼ˆè¿åˆ°è¯¥é¢œè‰²æœ€å°å€¼ï¼‰ï¼Œå†å¤„ç†å¼‚è‰²è¾¹ï¼ˆè¿åˆ°å…¨å±€æœ€å°å€¼æˆ–æ¬¡å°å€¼ï¼‰ï¼Œç„¶åç”¨DFSç»Ÿè®¡æ¯ä¸ªè¿é€šå—çš„å¤§å°å’Œé¢œè‰²åˆ†å¸ƒã€‚äº®ç‚¹æ˜¯**ç”¨`vec`æ•°ç»„å­˜å‚¨æ¯ä¸ªé¢œè‰²çš„çƒ**ï¼Œæ–¹ä¾¿æ’åºå’Œå–æœ€å°å€¼ï¼ŒåŒæ—¶DFSçš„å®ç°å¾ˆæ ‡å‡†ï¼Œé€‚åˆåˆå­¦è€…å­¦ä¹ ã€‚


## 3. æ ¸å¿ƒéš¾ç‚¹è¾¨æä¸è§£é¢˜ç­–ç•¥

### 1. **éš¾ç‚¹1ï¼šå¦‚ä½•é«˜æ•ˆæ„å»ºè¿é€šå—ï¼Ÿ**  
* **åˆ†æ**ï¼š  
  ç›´æ¥æšä¸¾æ‰€æœ‰çƒå¯¹ä¼šè¶…æ—¶ï¼Œå› æ­¤éœ€è¦ç”¨â€œæœ€å°å€¼â€ä½œä¸ºåª’ä»‹ã€‚åŒè‰²çƒåªéœ€è¿åˆ°è¯¥é¢œè‰²çš„æœ€è½»çƒï¼Œå¼‚è‰²çƒåªéœ€è¿åˆ°å…¨å±€æœ€è½»æˆ–æ¬¡è½»çƒã€‚è¿™æ ·è¾¹æ•°ä»O(nÂ²)é™åˆ°äº†O(n)ã€‚  
* ğŸ’¡ **å­¦ä¹ ç¬”è®°**ï¼šæœ€å°å€¼æ˜¯è¿é€šæ€§çš„â€œæ¡¥æ¢â€ï¼ŒæŠ“ä½æœ€å°å€¼å°±èƒ½å‡å°‘ä¸å¿…è¦çš„è¾¹ã€‚

### 2. **éš¾ç‚¹2ï¼šå¦‚ä½•å¤„ç†å¼‚è‰²äº¤æ¢çš„æƒ…å†µï¼Ÿ**  
* **åˆ†æ**ï¼š  
  å¼‚è‰²äº¤æ¢éœ€è¦å…¨å±€æœ€è½»çƒï¼ˆmin1ï¼‰å’Œæ¬¡è½»çƒï¼ˆmin2ï¼‰ã€‚å¦‚æœçƒçš„é¢œè‰²æ˜¯min1çš„é¢œè‰²ï¼Œé‚£ä¹ˆå®ƒæ— æ³•é€šè¿‡min1ä¸å…¶ä»–é¢œè‰²äº¤æ¢ï¼ˆå› ä¸ºé¢œè‰²ç›¸åŒï¼‰ï¼Œæ­¤æ—¶éœ€è¦ç”¨æ¬¡è½»çƒï¼ˆmin2ï¼‰ä½œä¸ºåª’ä»‹â€”â€”åªè¦å®ƒä¸min2çš„é‡é‡å’Œâ‰¤Yï¼Œå°±èƒ½è¿åˆ°min2ï¼Œè¿›è€Œè¿åˆ°min1çš„è¿é€šå—ã€‚  
* ğŸ’¡ **å­¦ä¹ ç¬”è®°**ï¼šæ¬¡å°å€¼æ˜¯å¤„ç†â€œåŒè‰²æœ€å°å€¼â€çš„å…³é”®ï¼Œä¸è¦æ¼æ‰å®ƒï¼

### 3. **éš¾ç‚¹3ï¼šç»„åˆæ•°å­¦è®¡ç®—ï¼ˆå¯é‡æ’åˆ—ï¼‰ï¼Ÿ**  
* **åˆ†æ**ï¼š  
  è¿é€šå—å†…çš„é¢œè‰²åºåˆ—æ•°ç›®ç­‰äºâ€œè¿é€šå—å¤§å°çš„é˜¶ä¹˜â€é™¤ä»¥â€œå„é¢œè‰²æ•°é‡é˜¶ä¹˜çš„ä¹˜ç§¯â€ï¼ˆå¯é‡æ’åˆ—å…¬å¼ï¼‰ã€‚ä¾‹å¦‚ï¼Œè¿é€šå—æœ‰3ä¸ªçƒï¼Œé¢œè‰²åˆ†å¸ƒæ˜¯2ä¸ªçº¢ã€1ä¸ªè“ï¼Œé‚£ä¹ˆæ•°ç›®æ˜¯3!/(2!Ã—1!)=3ã€‚éœ€è¦é¢„å¤„ç†é˜¶ä¹˜å’Œé€†å…ƒï¼Œé¿å…é‡å¤è®¡ç®—ã€‚  
* ğŸ’¡ **å­¦ä¹ ç¬”è®°**ï¼šç»„åˆæ•°å­¦æ˜¯è§£å†³æ’åˆ—é—®é¢˜çš„å…³é”®ï¼Œé¢„å¤„ç†é˜¶ä¹˜å’Œé€†å…ƒèƒ½æé«˜æ•ˆç‡ã€‚

### âœ¨ è§£é¢˜æŠ€å·§æ€»ç»“  
- **æŠ€å·§Aï¼šç”¨æœ€å°å€¼ä½œä¸ºåª’ä»‹**ï¼šå‡å°‘è¾¹æ•°ï¼Œæé«˜è¿é€šæ€§åˆ¤æ–­æ•ˆç‡ã€‚  
- **æŠ€å·§Bï¼šé¢„å¤„ç†é˜¶ä¹˜å’Œé€†å…ƒ**ï¼šå¿«é€Ÿè®¡ç®—ç»„åˆæ•°ï¼Œé¿å…é‡å¤è®¡ç®—ã€‚  
- **æŠ€å·§Cï¼šåˆ¤æ–­è¾¹ç•Œæ¡ä»¶**ï¼šå¦‚æœå…¨å±€æœ€è½»å’Œæ¬¡è½»çš„é‡é‡å’Œ>Yï¼Œç›´æ¥è¿”å›1ï¼Œé¿å…ä¸å¿…è¦çš„è®¡ç®—ã€‚


## 4. C++æ ¸å¿ƒä»£ç å®ç°èµæ

### æœ¬é¢˜é€šç”¨æ ¸å¿ƒC++å®ç°å‚è€ƒ  
* **è¯´æ˜**ï¼šç»¼åˆäº†Kinandraå’Œtuliweiçš„é¢˜è§£æ€è·¯ï¼Œæä¾›ä¸€ä¸ªæ¸…æ™°çš„æ ¸å¿ƒå®ç°ã€‚  
* **å®Œæ•´æ ¸å¿ƒä»£ç **ï¼š  
  ```cpp
  #include <iostream>
  #include <vector>
  #include <algorithm>
  using namespace std;

  const int mod = 1e9 + 7;
  const int maxn = 2e5 + 5;

  int fac[maxn], inv[maxn];
  vector<int> color[maxn]; // å­˜å‚¨æ¯ä¸ªé¢œè‰²çš„æ‰€æœ‰çƒçš„é‡é‡
  int min_color[maxn];     // æ¯ä¸ªé¢œè‰²çš„æœ€è½»é‡é‡
  int n, X, Y;

  int pow_mod(int a, int b) {
      int res = 1;
      while (b) {
          if (b & 1) res = 1LL * res * a % mod;
          a = 1LL * a * a % mod;
          b >>= 1;
      }
      return res;
  }

  void init() {
      fac[0] = 1;
      for (int i = 1; i < maxn; ++i) {
          fac[i] = 1LL * fac[i-1] * i % mod;
      }
      inv[maxn-1] = pow_mod(fac[maxn-1], mod-2);
      for (int i = maxn-2; i >= 0; --i) {
          inv[i] = 1LL * inv[i+1] * (i+1) % mod;
      }
  }

  int main() {
      init();
      cin >> n >> X >> Y;
      fill(min_color, min_color + maxn, 1e9);
      for (int i = 0; i < n; ++i) {
          int c, w;
          cin >> c >> w;
          color[c].push_back(w);
          if (w < min_color[c]) {
              min_color[c] = w;
          }
      }

      // æ‰¾å…¨å±€æœ€è½»é¢œè‰²ï¼ˆmc1ï¼‰å’Œæ¬¡è½»é¢œè‰²ï¼ˆmc2ï¼‰
      int mc1 = 0, mc2 = 0;
      for (int c = 1; c < maxn; ++c) {
          if (color[c].empty()) continue;
          if (min_color[c] < min_color[mc1]) {
              mc2 = mc1;
              mc1 = c;
          } else if (min_color[c] < min_color[mc2] && c != mc1) {
              mc2 = c;
          }
      }

      // å¦‚æœå…¨å±€æœ€è½»å’Œæ¬¡è½»æ— æ³•äº¤æ¢ï¼Œç›´æ¥è¿”å›1
      if (min_color[mc1] + min_color[mc2] > Y) {
          cout << 1 << endl;
          return 0;
      }

      // è®¡ç®—è¿é€šå—å†…çš„é¢œè‰²åˆ†å¸ƒ
      vector<int> cnt(maxn, 0); // cnt[c]ï¼šé¢œè‰²cåœ¨è¿é€šå—ä¸­çš„æ•°é‡
      int total = 0; // è¿é€šå—å¤§å°
      for (int c = 1; c < maxn; ++c) {
          if (color[c].empty()) continue;
          // åˆ¤æ–­é¢œè‰²cæ˜¯å¦èƒ½è¿åˆ°å…¨å±€æœ€å°å€¼
          if (min_color[c] + min_color[mc1] > Y) continue;
          // ç»Ÿè®¡é¢œè‰²cä¸­èƒ½è¿åˆ°è¿é€šå—çš„çƒçš„æ•°é‡
          int num = 0;
          for (int w : color[c]) {
              if (c == mc1) {
                  // é¢œè‰²æ˜¯å…¨å±€æœ€è½»ï¼Œéœ€è¦è¿åˆ°æ¬¡è½»
                  if (w + min_color[mc2] <= Y) num++;
              } else {
                  // é¢œè‰²ä¸æ˜¯å…¨å±€æœ€è½»ï¼Œè¿åˆ°å…¨å±€æœ€è½»
                  if (w + min_color[mc1] <= Y) num++;
              }
              // åŒè‰²äº¤æ¢ï¼šåªè¦å’Œè¯¥é¢œè‰²æœ€è½»èƒ½äº¤æ¢ï¼Œå°±å¯ä»¥è¿åˆ°è¿é€šå—
              if (w + min_color[c] <= X) num++;
              // å»é‡ï¼ˆé¿å…åŒæ—¶æ»¡è¶³åŒè‰²å’Œå¼‚è‰²æ¡ä»¶ï¼‰
              num = min(num, (int)color[c].size());
          }
          cnt[c] = num;
          total += num;
      }

      // è®¡ç®—ç»„åˆæ•°ï¼štotal! / (cnt[1]! * cnt[2]! * ... * cnt[n]!)
      int ans = fac[total];
      for (int c = 1; c < maxn; ++c) {
          if (cnt[c] > 0) {
              ans = 1LL * ans * inv[cnt[c]] % mod;
          }
      }
      cout << ans << endl;

      return 0;
  }
  ```  
* **ä»£ç è§£è¯»æ¦‚è¦**ï¼š  
  ä»£ç åˆ†ä¸ºå››éƒ¨åˆ†ï¼šâ‘  é¢„å¤„ç†é˜¶ä¹˜å’Œé€†å…ƒï¼›â‘¡ è¯»å–è¾“å…¥å¹¶è®¡ç®—æ¯ä¸ªé¢œè‰²çš„æœ€è½»é‡é‡ï¼›â‘¢ æ‰¾å…¨å±€æœ€è½»å’Œæ¬¡è½»é¢œè‰²ï¼Œåˆ¤æ–­æ˜¯å¦è¿é€šï¼›â‘£ ç»Ÿè®¡è¿é€šå—å†…çš„é¢œè‰²åˆ†å¸ƒï¼Œè®¡ç®—ç»„åˆæ•°ã€‚æ ¸å¿ƒé€»è¾‘æ˜¯**ç”¨æœ€å°å€¼ä½œä¸ºåª’ä»‹åˆ¤æ–­è¿é€šæ€§**ï¼Œå¹¶é€šè¿‡ç»„åˆæ•°è®¡ç®—ç­”æ¡ˆã€‚


### é¢˜è§£ä¸€ï¼ˆKinandraï¼‰æ ¸å¿ƒä»£ç ç‰‡æ®µèµæ  
* **äº®ç‚¹**ï¼šç”¨å…¨å±€æœ€è½»å’Œæ¬¡è½»é¢œè‰²åˆ¤æ–­è¿é€šæ€§ï¼Œé€»è¾‘ç®€æ´ã€‚  
* **æ ¸å¿ƒä»£ç ç‰‡æ®µ**ï¼š  
  ```cpp
  int mc1 = 0, mc2 = 0;
  for (int i = 1; i <= n; ++i) 
      if (c[i].size() && (!mc1 || w[i] < w[mc1])) mc1 = i;
  for (int i = 1; i <= n; ++i) 
      if (c[i].size() && i != mc1 && (!mc2 || w[i] < w[mc2])) mc2 = i;
  if (!mc2 || w[mc1] + w[mc2] > Y) return puts("1"), 0;
  ```  
* **ä»£ç è§£è¯»**ï¼š  
  è¿™æ®µä»£ç æ‰¾å…¨å±€æœ€è½»é¢œè‰²ï¼ˆmc1ï¼‰å’Œæ¬¡è½»é¢œè‰²ï¼ˆmc2ï¼‰ã€‚å¦‚æœmc2ä¸å­˜åœ¨ï¼ˆæ‰€æœ‰çƒåŒè‰²ï¼‰æˆ–è€…å®ƒä»¬çš„é‡é‡å’Œ>Yï¼Œè¯´æ˜æ— æ³•è·¨é¢œè‰²äº¤æ¢ï¼Œç›´æ¥è¿”å›1ã€‚è¿™ä¸€æ­¥æ˜¯**è¾¹ç•Œæ¡ä»¶å¤„ç†**ï¼Œé¿å…äº†åç»­ä¸å¿…è¦çš„è®¡ç®—ã€‚  
* ğŸ’¡ **å­¦ä¹ ç¬”è®°**ï¼šè¾¹ç•Œæ¡ä»¶å¤„ç†èƒ½æé«˜ä»£ç æ•ˆç‡ï¼Œä¸è¦æ¼æ‰ï¼


### é¢˜è§£äºŒï¼ˆtuliweiï¼‰æ ¸å¿ƒä»£ç ç‰‡æ®µèµæ  
* **äº®ç‚¹**ï¼šç”¨`pd_col`æ•°ç»„æ ‡è®°æ— æ³•è·¨é¢œè‰²äº¤æ¢çš„é¢œè‰²ï¼Œå‡å°‘éå†æ¬¡æ•°ã€‚  
* **æ ¸å¿ƒä»£ç ç‰‡æ®µ**ï¼š  
  ```cpp
  for (int c = 1; c <= n; ++c)
      if (col_min[c] + mina > y)
          pd_col[c] = true;
  for (int i = 1; i <= n; ++i) {
      if (pd_col[c[i]]) continue;
      if (col_min[c[i]] + w[i] <= x) ++cnt[c[i]], ++tot;
      else if ((col_min[c[i]] == mina ? minb : mina) + w[i] <= y) ++cnt[c[i]], ++tot;
  }
  ```  
* **ä»£ç è§£è¯»**ï¼š  
  `pd_col[c]`æ ‡è®°é¢œè‰²cæ˜¯å¦æ— æ³•è·¨é¢œè‰²äº¤æ¢ï¼ˆå³è¯¥é¢œè‰²çš„æœ€è½»é‡é‡ä¸å…¨å±€æœ€è½»çš„é‡é‡å’Œ>Yï¼‰ã€‚éå†æ¯ä¸ªçƒæ—¶ï¼Œå¦‚æœ`pd_col[c[i]]`ä¸ºtrueï¼Œç›´æ¥è·³è¿‡ã€‚å¦åˆ™ï¼Œåˆ¤æ–­è¯¥çƒæ˜¯å¦èƒ½é€šè¿‡åŒè‰²ï¼ˆ`col_min[c[i]] + w[i] <= x`ï¼‰æˆ–å¼‚è‰²ï¼ˆ`(col_min[c[i]] == mina ? minb : mina) + w[i] <= y`ï¼‰äº¤æ¢è¿åˆ°è¿é€šå—ã€‚è¿™ä¸€æ­¥**å‡å°‘äº†ä¸å¿…è¦çš„åˆ¤æ–­**ï¼Œæé«˜äº†æ•ˆç‡ã€‚  
* ğŸ’¡ **å­¦ä¹ ç¬”è®°**ï¼šç”¨æ•°ç»„æ ‡è®°çŠ¶æ€èƒ½å‡å°‘é‡å¤è®¡ç®—ï¼Œæ˜¯ç¼–ç¨‹ä¸­çš„å¸¸ç”¨æŠ€å·§ã€‚


## 5. ç®—æ³•å¯è§†åŒ–ï¼šåƒç´ åŠ¨ç”»æ¼”ç¤º (æ ¸å¿ƒéƒ¨åˆ†)

### åŠ¨ç”»æ¼”ç¤ºä¸»é¢˜ï¼šã€Šåƒç´ çƒçš„è¿é€šå†’é™©ã€‹ï¼ˆ8ä½åƒç´ é£æ ¼ï¼‰  
### è®¾è®¡æ€è·¯  
é‡‡ç”¨FCçº¢ç™½æœºçš„8ä½åƒç´ é£æ ¼ï¼Œç”¨ä¸åŒé¢œè‰²å—è¡¨ç¤ºçƒçš„é¢œè‰²ï¼ˆæ¯”å¦‚çº¢è‰²=0xFF0000ï¼Œè“è‰²=0x0000FFï¼‰ï¼Œé‡é‡ç”¨ç™½è‰²æ•°å­—æ ‡è®°ã€‚åŠ¨ç”»ä¸­ï¼Œ**æœ€è½»çƒ**ç”¨é—ªçƒçš„é‡‘è‰²ï¼ˆ0xFFFF00ï¼‰æ ‡è®°ï¼Œ**æ¬¡è½»çƒ**ç”¨é“¶è‰²ï¼ˆ0xC0C0C0ï¼‰æ ‡è®°ã€‚é€šè¿‡â€œè¿è¾¹â€å’Œâ€œè·³åŠ¨â€æ•ˆæœå±•ç¤ºè¿é€šæ€§ï¼Œç”¨éŸ³æ•ˆå¢å¼ºä»£å…¥æ„Ÿï¼ˆæ¯”å¦‚è¿è¾¹æ—¶æ’­æ”¾â€œå®â€çš„éŸ³æ•ˆï¼Œè¿é€šå—å®Œæˆæ—¶æ’­æ”¾â€œèƒœåˆ©â€éŸ³æ•ˆï¼‰ã€‚

### åŠ¨ç”»å¸§æ­¥éª¤  
1. **åˆå§‹åŒ–åœºæ™¯**ï¼šå±å¹•æ˜¾ç¤ºnä¸ªåƒç´ çƒï¼Œæ’åˆ—æˆä¸€è¡Œï¼Œæ¯ä¸ªçƒæ˜¾ç¤ºé¢œè‰²å’Œé‡é‡ã€‚é¡¶éƒ¨æœ‰â€œæ§åˆ¶é¢æ¿â€ï¼ˆå¼€å§‹/æš‚åœã€å•æ­¥ã€é‡ç½®æŒ‰é’®ï¼‰ã€‚  
2. **æ ‡è®°æœ€å°å€¼**ï¼šæ¯ä¸ªé¢œè‰²çš„æœ€è½»çƒå¼€å§‹é—ªçƒï¼ˆé‡‘è‰²ï¼‰ï¼Œå…¨å±€æœ€è½»çƒï¼ˆmc1ï¼‰å’Œæ¬¡è½»çƒï¼ˆmc2ï¼‰ç”¨æ›´å¤§çš„é—ªçƒæ•ˆæœæ ‡è®°ã€‚  
3. **è¿è¾¹è¿‡ç¨‹**ï¼š  
   - åŒè‰²çƒï¼šæ¯ä¸ªçƒå‘è¯¥é¢œè‰²çš„æœ€è½»çƒâ€œå‘å°„â€ä¸€æ¡ç™½è‰²çº¿æ¡ï¼ˆè¡¨ç¤ºè¿è¾¹ï¼‰ï¼ŒåŒæ—¶æ’­æ”¾â€œå®â€çš„éŸ³æ•ˆã€‚  
   - å¼‚è‰²çƒï¼šémc1é¢œè‰²çš„çƒå‘mc1å‘å°„çº¿æ¡ï¼Œmc1é¢œè‰²çš„çƒå‘mc2å‘å°„çº¿æ¡ï¼ˆå¦‚æœæ»¡è¶³é‡é‡å’Œæ¡ä»¶ï¼‰ã€‚  
4. **è¿é€šå—å±•ç¤º**ï¼šæ‰€æœ‰è¿åˆ°mc1çš„çƒä¼šâ€œè·³åŠ¨â€ï¼ˆä¸Šä¸‹ç§»åŠ¨1åƒç´ ï¼‰ï¼Œæ˜¾ç¤ºè¿é€šå—çš„å¤§å°ï¼ˆæ¯”å¦‚â€œè¿é€šå—å¤§å°ï¼š5â€ï¼‰ã€‚  
5. **ç»„åˆæ•°è®¡ç®—**ï¼šå±å¹•åº•éƒ¨æ˜¾ç¤ºâ€œç»„åˆæ•°è®¡ç®—ï¼š5! / (2!Ã—1!Ã—2!) = 30â€ï¼Œç”¨åŠ¨ç”»å±•ç¤ºé˜¶ä¹˜çš„ä¹˜ç§¯ï¼ˆæ¯”å¦‚5Ã—4Ã—3Ã—2Ã—1ï¼‰å’Œé™¤ä»¥å„é¢œè‰²é˜¶ä¹˜çš„è¿‡ç¨‹ï¼ˆæ¯”å¦‚é™¤ä»¥2Ã—1ï¼Œå†é™¤ä»¥1ï¼Œå†é™¤ä»¥2Ã—1ï¼‰ã€‚  
6. **ç»“æŸçŠ¶æ€**ï¼šæ’­æ”¾â€œèƒœåˆ©â€éŸ³æ•ˆï¼ˆä¸Šæ‰¬çš„8ä½éŸ³è°ƒï¼‰ï¼Œæ˜¾ç¤ºæœ€ç»ˆç­”æ¡ˆï¼ˆæ¯”å¦‚â€œç­”æ¡ˆï¼š30â€ï¼‰ã€‚

### äº¤äº’è®¾è®¡  
- **å•æ­¥æ‰§è¡Œ**ï¼šç‚¹å‡»â€œå•æ­¥â€æŒ‰é’®ï¼ŒåŠ¨ç”»æ‰§è¡Œä¸€æ­¥ï¼ˆæ¯”å¦‚æ ‡è®°ä¸€ä¸ªæœ€å°å€¼ï¼Œæˆ–è¿ä¸€æ¡è¾¹ï¼‰ã€‚  
- **è‡ªåŠ¨æ’­æ”¾**ï¼šç‚¹å‡»â€œå¼€å§‹â€æŒ‰é’®ï¼ŒåŠ¨ç”»è‡ªåŠ¨æ‰§è¡Œï¼Œé€Ÿåº¦å¯é€šè¿‡æ»‘å—è°ƒæ•´ï¼ˆæ¯”å¦‚1xã€2xã€3xï¼‰ã€‚  
- **é‡ç½®åŠ¨ç”»**ï¼šç‚¹å‡»â€œé‡ç½®â€æŒ‰é’®ï¼Œå›åˆ°åˆå§‹çŠ¶æ€ã€‚


## 6. æ‹“å±•ç»ƒä¹ ä¸ç›¸ä¼¼é—®é¢˜æ€è€ƒ

### é€šç”¨æ€è·¯/æŠ€å·§è¿ç§»  
- **è¿é€šæ€§åˆ†æ**ï¼šæœ¬é¢˜çš„â€œæœ€å°å€¼åª’ä»‹â€æŠ€å·§å¯ç”¨äºå…¶ä»–éœ€è¦é«˜æ•ˆåˆ¤æ–­è¿é€šæ€§çš„é—®é¢˜ï¼ˆæ¯”å¦‚ç¤¾äº¤ç½‘ç»œä¸­çš„å¥½å‹å…³ç³»ã€å›¾çš„æœ€å°ç”Ÿæˆæ ‘ï¼‰ã€‚  
- **ç»„åˆæ•°å­¦**ï¼šå¯é‡æ’åˆ—å…¬å¼ï¼ˆé˜¶ä¹˜é™¤ä»¥å„å…ƒç´ é˜¶ä¹˜çš„ä¹˜ç§¯ï¼‰å¯ç”¨äºè§£å†³â€œæœ‰é‡å¤å…ƒç´ çš„æ’åˆ—â€é—®é¢˜ï¼ˆæ¯”å¦‚å­—æ¯æ’åˆ—ã€é¢œè‰²æ’åˆ—ï¼‰ã€‚  
- **è¾¹ç•Œæ¡ä»¶å¤„ç†**ï¼šåˆ¤æ–­â€œå…¨å±€æœ€è½»å’Œæ¬¡è½»æ— æ³•äº¤æ¢â€çš„è¾¹ç•Œæ¡ä»¶ï¼Œå¯ç”¨äºå…¶ä»–éœ€è¦æå‰ç»ˆæ­¢çš„é—®é¢˜ï¼ˆæ¯”å¦‚æ’åºä¸­çš„å·²æ’åºåˆ¤æ–­ã€æœç´¢ä¸­çš„æ— è§£åˆ¤æ–­ï¼‰ã€‚

### ç»ƒä¹ æ¨è (æ´›è°·)  
1. **æ´›è°· P1197 æ˜Ÿçƒå¤§æˆ˜**  
   - ğŸ—£ï¸ **æ¨èç†ç”±**ï¼šè¿™é“é¢˜è€ƒå¯Ÿå›¾çš„è¿é€šæ€§ï¼ˆåŠ¨æ€åˆ è¾¹ï¼‰ï¼Œéœ€è¦ç”¨å¹¶æŸ¥é›†é«˜æ•ˆå¤„ç†ã€‚é€šè¿‡ç»ƒä¹ ï¼Œä½ èƒ½å·©å›ºâ€œè¿é€šå—â€çš„æ¦‚å¿µã€‚  
2. **æ´›è°· P2822 ç»„åˆæ•°é—®é¢˜**  
   - ğŸ—£ï¸ **æ¨èç†ç”±**ï¼šè¿™é“é¢˜è€ƒå¯Ÿç»„åˆæ•°çš„è®¡ç®—ï¼ˆé˜¶ä¹˜å’Œé€†å…ƒï¼‰ï¼Œä¸æœ¬é¢˜çš„ç»„åˆæ•°å­¦éƒ¨åˆ†é«˜åº¦ç›¸å…³ã€‚é€šè¿‡ç»ƒä¹ ï¼Œä½ èƒ½ç†Ÿç»ƒæŒæ¡é˜¶ä¹˜å’Œé€†å…ƒçš„é¢„å¤„ç†ã€‚  
3. **æ´›è°· P3376 æœ€å¤§æµæ¨¡æ¿**  
   - ğŸ—£ï¸ **æ¨èç†ç”±**ï¼šè™½ç„¶è¿™é“é¢˜æ˜¯æœ€å¤§æµï¼Œä½†å®ƒæ¶‰åŠå›¾çš„æ„å»ºå’Œéå†ï¼Œä¸æœ¬é¢˜çš„â€œè¿é€šæ€§â€æ€è·¯æœ‰å…±é€šä¹‹å¤„ã€‚é€šè¿‡ç»ƒä¹ ï¼Œä½ èƒ½æé«˜å›¾è®ºé—®é¢˜çš„è§£å†³èƒ½åŠ›ã€‚


## 7. å­¦ä¹ å¿ƒå¾—ä¸ç»éªŒåˆ†äº« (è‹¥æœ‰)  
**å‚è€ƒç»éªŒï¼ˆæ¥è‡ªKinandraçš„é¢˜è§£ï¼‰**ï¼šâ€œæˆ‘åœ¨è§£å†³è¿™ä¸ªé—®é¢˜æ—¶ï¼Œæœ€åˆæƒ³ç›´æ¥å»ºå›¾ï¼Œä½†å‘ç°è¾¹æ•°å¤ªå¤§ã€‚åæ¥æƒ³åˆ°ç”¨æœ€å°å€¼ä½œä¸ºåª’ä»‹ï¼Œå‡å°‘äº†è¾¹æ•°ï¼Œæ‰é€šè¿‡äº†æ‰€æœ‰æµ‹è¯•ç‚¹ã€‚â€  
**ç‚¹è¯„**ï¼šè¿™ä½ä½œè€…çš„ç»éªŒå¾ˆå…¸å‹ã€‚åœ¨è§£å†³å›¾è®ºé—®é¢˜æ—¶ï¼Œ**å‡å°‘è¾¹æ•°**æ˜¯æé«˜æ•ˆç‡çš„å…³é”®ã€‚å¦‚æœç›´æ¥å»ºå›¾ä¼šè¶…æ—¶ï¼Œä¸å¦¨æƒ³æƒ³æœ‰æ²¡æœ‰â€œåª’ä»‹â€èƒ½ä»£æ›¿å¤§é‡è¾¹ï¼ˆæ¯”å¦‚æœ€å°å€¼ã€ä¸­å¿ƒç‚¹ï¼‰ã€‚


## ç»“è¯­  
æœ¬æ¬¡å…³äºAGC012Dçš„åˆ†æå°±åˆ°è¿™é‡Œå•¦ï¼å¸Œæœ›è¿™ä»½æŒ‡å—èƒ½å¸®åŠ©ä½ ç†è§£â€œè¿é€šæ€§åˆ†æâ€å’Œâ€œç»„åˆæ•°å­¦â€çš„æ ¸å¿ƒæ€è·¯ã€‚è®°ä½ï¼Œ**æœ€å°å€¼æ˜¯è¿é€šæ€§çš„æ¡¥æ¢**ï¼Œ**ç»„åˆæ•°æ˜¯æ’åˆ—çš„å…³é”®**ã€‚ä¸‹æ¬¡é‡åˆ°ç±»ä¼¼é—®é¢˜æ—¶ï¼Œä¸å¦¨è¯•è¯•ç”¨æœ€å°å€¼ä½œä¸ºåª’ä»‹ï¼Œæˆ–è€…ç”¨ç»„åˆæ•°è®¡ç®—ç­”æ¡ˆï½ åŠ æ²¹ï¼Œä½ ä¸€å®šèƒ½è§£å†³æ›´å¤šç¼–ç¨‹æŒ‘æˆ˜ï¼ğŸ’ª

---
å¤„ç†ç”¨æ—¶ï¼š290.58ç§’
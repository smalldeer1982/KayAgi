---
title: "[ABC323G] Inversion of Tree"
layout: "post"
diff: NOI/NOI+/CTSC
pid: AT_abc323_g
tag: ['矩阵树定理', '线性代数']
---

# [ABC323G] Inversion of Tree

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc323/tasks/abc323_g

$ (1,2,\ldots,N) $ の順列 $ P=(P_1,P_2,\ldots,P_N) $ が与えられます。

頂点に $ 1 $ から $ N $ の番号が付いた $ N $ 頂点の木のうち、以下の条件を満たすものの個数を $ 998244353 $ で割ったあまりを $ K=0,1,\ldots,N-1 $ に対して求めてください。

- 木で直接辺で結ばれた頂点の組 $ (u_i,v_i)\ (u_i\ <\ v_i) $ のうち、 $ P_{u_i}\ >\ P_{v_i} $ を満たすものがちょうど $ K $ 個ある。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ P_1 $ $ P_2 $ $ \ldots $ $ P_N $

## 输出格式

各 $ K=0,1,\ldots,N-1 $ に対して、条件を満たす木の個数を $ 998244353 $ で割ったあまりを空白区切りで出力せよ。

## 说明/提示

### 制約

- $ 2\leq\ N\leq\ 500 $
- $ P $ は $ (1,2,\ldots,N) $ の順列
 
### Sample Explanation 1

$ K=0 $ のときの答えは、頂点 $ 1,2 $ と頂点 $ 1,3 $ を結ぶ木の一つです。実際、$ P_1\ <\ P_2 $, $ P_1\ <\ P_3 $ です。 $ K=1 $ のときの答えは、頂点 $ 1,2 $ と頂点 $ 2,3 $ を結ぶ木と頂点 $ 1,3 $ と頂点 $ 2,3 $ を結ぶ木の二つです。実際、頂点 $ 1,2 $ と頂点 $ 2,3 $ を結ぶ木では、$ P_1\ <\ P_2 $, $ P_2\ >\ P_3 $ です。

## 样例 #1

### 输入

```
3
1 3 2
```

### 输出

```
1 2 0
```

## 样例 #2

### 输入

```
10
3 1 4 10 8 6 9 2 7 5
```

### 输出

```
294448 2989776 12112684 25422152 30002820 20184912 7484084 1397576 108908 2640
```


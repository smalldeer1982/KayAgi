---
title: "[AGC061D] Almost Multiplication Table"
layout: "post"
diff: NOI/NOI+/CTSC
pid: AT_agc061_d
tag: ['贪心', '二分']
---

# [AGC061D] Almost Multiplication Table

## 题目描述

[problemUrl]: https://atcoder.jp/contests/agc061/tasks/agc061_d

正の整数 $ N,\ M $ と $ N\ \times\ M $ 正整数行列 $ A_{i,\ j} $ があります。二つの**（狭義）単調増加**正整数列 $ X\ =\ (X_1,\ \ldots,\ X_N),\ Y\ =\ (Y_1,\ \ldots,\ Y_M) $ に対し、ペナルティ $ D(X,\ Y) $ を $ \max_{1\ \leq\ i\ \leq\ N,\ 1\ \leq\ j\ \leq\ M}\ |X_i\ Y_j\ -\ A_{i,\ j}| $ と定義します。

$ D(X,\ Y) $ を最小化する二つの**（狭義）単調増加**正整数列 $ X,\ Y $ を求めてください。

## 输入格式

入力は、標準入力から以下の形式で与えられる。

> $ N $ $ M $ $ A_{1,1} $ $ \ldots $ $ A_{1,M} $ $ \vdots $ $ A_{N,1} $ $ \ldots $ $ A_{N,M} $

## 输出格式

答えを以下の形式で出力せよ。

> $ D_{min} $ $ X_1 $ $ \ldots $ $ X_N $ $ Y_1 $ $ \ldots $ $ Y_M $

ここで、$ D_{min} $ は最小のペナルティであり、また以下の条件が満たされなければならない。

- $ D(X,\ Y) $ は $ D_{min} $ に等しい。
- $ X_i\ <\ X_{i\ +\ 1} $ ($ 1\ \leq\ i\ \leq\ N\ -\ 1 $)
- $ Y_j\ <\ Y_{j\ +\ 1} $ ($ 1\ \leq\ j\ \leq\ M\ -\ 1 $)
- $ 1\ \leq\ X_i\ \leq\ 2\cdot\ 10^9 $ ($ 1\ \leq\ i\ \leq\ N $)
- $ 1\ \leq\ Y_j\ \leq\ 2\cdot\ 10^9 $ ($ 1\ \leq\ j\ \leq\ M $)
 
最後の二条件を満たす最適解が存在することは証明できる。

## 说明/提示

### 制約

- $ 1\ \leq\ N,\ M\ \leq\ 5 $
- $ 1\ \leq\ A_{i,\ j}\ \leq\ 10^9 $ ($ 1\ \leq\ i\ \leq\ N $, $ 1\ \leq\ j\ \leq\ M $)
- 入力中の値は全て整数である。

## 样例 #1

### 输入

```
1 1
853922530
```

### 输出

```
0
31415
27182
```

## 样例 #2

### 输入

```
3 3
4 4 4
4 4 4
4 4 4
```

### 输出

```
5
1 2 3 
1 2 3
```

## 样例 #3

### 输入

```
3 4
4674 7356 86312 100327
8737 11831 145034 167690
47432 66105 809393 936462
```

### 输出

```
357
129 216 1208 
39 55 670 775
```


---
title: "[ARC189C] Balls and Boxes"
layout: "post"
diff: 提高+/省选-
pid: AT_arc189_c
tag: ['动态规划 DP']
---

# [ARC189C] Balls and Boxes

## 题目描述

有 $N$ 个箱子，对应编号 $i = 1, 2, \ldots, N$。每个箱子中，编号为 $i$ 的箱子包含 $A_i$ 个红球和 $B_i$ 个蓝球。

另外，给定两个排列 $P = (P_1, P_2, \ldots, P_N)$ 和 $Q = (Q_1, Q_2, \ldots, Q_N)$，它们都是数列 $(1, 2, \ldots, N)$ 的不同排列组合。

高桥君可以任意次（包括零次）执行以下操作：

1. 选择一个箱子 $i$，满足 $1 \leq i \leq N$，将其中所有的球拿出来。
2. 把手中所有的红球放入第 $P_i$ 个箱子。
3. 把手中所有的蓝球放入第 $Q_i$ 个箱子。

高桥君的目标是使得在第 $X$ 个箱子以外的所有箱子中都没有球。请判断能否通过上述操作实现这个目标，如果可以，请给出实现这个目标所需的最小操作次数；如果不可能，则输出 `-1`。

## 输入格式

输入通过标准输入给出，格式如下：

> $N$ $X$ $A_1$ $A_2$ $\ldots$ $A_N$ $B_1$ $B_2$ $\ldots$ $B_N$ $P_1$ $P_2$ $\ldots$ $P_N$ $Q_1$ $Q_2$ $\ldots$ $Q_N$

## 输出格式

如果无法实现目标，即在第 $X$ 个箱子以外的所有箱子中都没有球，输出 `-1`；否则输出实现目标所需的最小操作次数。

## 数据范围

- $2 \leq N \leq 2 \times 10^5$
- $0 \leq A_i, B_i \leq 1$
- $1 \leq P_i, Q_i \leq N$
- $P, Q$ 均为 $(1, 2, \ldots, N)$ 的排列
- $1 \leq X \leq N$
- 输入数据全部为整数

### 例子与解释

- 在样例 1 中，初始时箱子内的红球和蓝球数量分别为 $A = (0, 1, 0, 1, 0), B = (0, 0, 1, 0, 1)$。通过以下步骤：
  - 操作第 5 个箱子后，变为 $A = (0, 1, 0, 1, 0), B = (1, 0, 1, 0, 0)$。
  - 操作第 2 个箱子后，变为 $A = (1, 0, 0, 1, 0), B = (1, 0, 1, 0, 0)$。
  - 操作第 1 个箱子后，变为 $A = (0, 0, 0, 2, 0), B = (0, 0, 2, 0, 0)$。
  - 操作第 4 个箱子后，变为 $A = (0, 0, 2, 0, 0), B = (0, 0, 2, 0, 0)$。

通过以上 4 次操作实现了目标。

- 在样例 2 中，所有箱子起始时本身就均为空，因此无需任何操作即可达到目标状态，输出为 0。

- 在样例 3 中，无论怎样操作，都无法使 $X = 2$ 以外的箱子为空。

 **本翻译由 AI 自动生成**

## 样例 #1

### 输入

```
5 3
0 1 0 1 0
0 0 1 0 1
4 1 2 3 5
3 4 5 2 1
```

### 输出

```
4
```

## 样例 #2

### 输入

```
5 3
0 0 0 0 0
0 0 0 0 0
4 1 2 3 5
3 4 5 2 1
```

### 输出

```
0
```

## 样例 #3

### 输入

```
2 2
1 1
1 1
1 2
1 2
```

### 输出

```
-1
```

## 样例 #4

### 输入

```
10 10
0 0 0 0 0 0 1 0 1 0
0 0 0 0 1 1 0 0 1 0
1 4 9 5 8 2 3 6 10 7
7 4 9 10 6 3 1 2 8 5
```

### 输出

```
8
```


---
title: "[ABC247F] Cards"
layout: "post"
diff: 普及+/提高
pid: AT_abc247_f
tag: ['动态规划 DP', '并查集']
---

# [ABC247F] Cards

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc247/tasks/abc247_f

$ 1,\ldots,N $ の番号がついた $ N $ 枚のカードがあり、カード $ i $ の表には $ P_i $ が、裏には $ Q_i $ が書かれています。  
 ここで、$ P=(P_1,\ldots,P_N) $ 及び $ Q=(Q_1,\ldots,Q_N) $ はそれぞれ $ (1,\ 2,\ \dots,\ N) $ の並び替えです。

$ N $ 枚のカードから何枚かを選ぶ方法のうち、次の条件を満たすものは何通りありますか？ $ 998244353 $ で割った余りを求めてください。

条件：$ 1,2,\ldots,N $ のどの数も選んだカードのいずれかに書かれている

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ P_1 $ $ P_2 $ $ \ldots $ $ P_N $ $ Q_1 $ $ Q_2 $ $ \ldots $ $ Q_N $

## 输出格式

答えを出力せよ。

## 说明/提示

### 制約

- $ 1\ \leq\ N\ \leq\ 2\times\ 10^5 $
- $ 1\ \leq\ P_i,Q_i\ \leq\ N $
- $ P,Q $ はそれぞれ $ (1,\ 2,\ \dots,\ N) $ の並び替えである
- 入力に含まれる値は全て整数である

### Sample Explanation 1

例えばカード $ 1,3 $ を選ぶと、$ 1 $ はカード $ 1 $ の表に、$ 2 $ はカード $ 1 $ の裏に、$ 3 $ はカード $ 3 $ の表に書かれているため条件を満たします。 条件を満たすカードの選び方は $ \{1,3\},\{2,3\},\{1,2,3\} $ の $ 3 $ 通りです。

## 样例 #1

### 输入

```
3
1 2 3
2 1 3
```

### 输出

```
3
```

## 样例 #2

### 输入

```
5
2 3 5 4 1
4 2 1 3 5
```

### 输出

```
12
```

## 样例 #3

### 输入

```
8
1 2 3 4 5 6 7 8
1 2 3 4 5 6 7 8
```

### 输出

```
1
```


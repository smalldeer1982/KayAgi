---
title: "[ABC309E] Family and Insurance"
layout: "post"
diff: 普及/提高-
pid: AT_abc309_e
tag: []
---

# [ABC309E] Family and Insurance

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc309/tasks/abc309_e

人 $ 1 $、人 $ 2 $、$ \ldots $、人 $ N $ からなる家系があります。$ i\geq\ 2 $ に対し、人 $ i $ の親は人 $ p_i $ です。

この家系の人たちは $ M $ 回保険に加入しました。$ i=1,2,\ldots,M $ に対し、$ i $ 番目の保険の加入者は人 $ x_i $ で、本人及びその $ y_i $ 代先までの子たちが補償対象者です。

$ 1 $ 個以上の保険の補償対象者になっている人が何人いるかを求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ M $ $ p_2 $ $ \ldots $ $ p_N $ $ x_1 $ $ y_1 $ $ \vdots $ $ x_M $ $ y_M $

## 输出格式

答えを出力せよ。

## 说明/提示

### 制約

- $ 2\ \leq\ N\ \leq\ 3\ \times\ 10^5 $
- $ 1\ \leq\ M\ \leq\ 3\ \times\ 10^5 $
- $ 1\ \leq\ p_i\ \leq\ i-1 $
- $ 1\ \leq\ x_i\ \leq\ N $
- $ 1\ \leq\ y_i\ \leq\ 3\ \times\ 10^5 $
- 入力はすべて整数
 
### Sample Explanation 1

$ 1 $ 番目の保険について、人 $ 1 $ の $ 1 $ 代先の子たちは人 $ 2 $ と人 $ 4 $ なので人 $ 1,2,4 $ が補償対象者です。 $ 2 $ 番目の保険について、人 $ 1 $ の $ 1 $ 代先の子たちは人 $ 2 $ と人 $ 4 $、$ 2 $ 代先の子は人 $ 3 $ なので人 $ 1,2,3,4 $ が補償対象者です。 $ 3 $ 番目の保険について、人 $ 4 $ の $ 1,2,3 $ 代先の子は存在しないので人 $ 4 $ が補償対象者です。 以上より、$ 1 $ 個以上の保険の補償対象者になっている人は人 $ 1,2,3,4 $ の $ 4 $ 人です。

## 样例 #1

### 输入

```
7 3
1 2 1 3 3 3
1 1
1 2
4 3
```

### 输出

```
4
```

## 样例 #2

### 输入

```
10 10
1 1 3 1 2 3 3 5 7
2 1
5 1
4 3
6 3
2 1
7 3
9 2
1 2
6 2
8 1
```

### 输出

```
10
```


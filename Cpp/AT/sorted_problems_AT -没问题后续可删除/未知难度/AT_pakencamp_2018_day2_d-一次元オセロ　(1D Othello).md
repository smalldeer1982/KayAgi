---
title: "一次元オセロ　(1D Othello)"
layout: "post"
diff: 难度0
pid: AT_pakencamp_2018_day2_d
tag: []
---

# 一次元オセロ　(1D Othello)

## 题目描述

有 $N$ 个黑白棋子从左到右排成一排，棋子的颜色依次用字符串 $S$ 表示，其中 `W` 表示白色，`B` 表示黑色。

\[\]

魔术师 IOI 君在这个过程中新增放置了 $M$ 个棋子。同样地，每个新放置的棋子的方位和颜色由两个参数 $D_i$ 和 $F_i$ 决定：

- 当 $D_i$ 为 `L` 时，棋子放在最左边棋子的左侧；而当 $D_i$ 为 `R` 时，棋子放在最右边棋子的右侧。
- 当 $F_i$ 为 `W` 时，棋子正面朝上为白色；而当 $F_i$ 为 `B` 时，棋子正面朝上为黑色。

在新棋子放置的一瞬间，新棋子与其最近的同色棋子之间的所有棋子将被翻转。

\[\]

然而，JOI 君未能观摩到这个神奇的过程。因此，为了知晓魔术的规则，他提出了 $Q$ 个问题。每个问题要求回答某次放置棋子后的状态，即「在第 $T_i$ 次放置结束后，从左往右数第 $P_i$ 个棋子的颜色是什么？」

请帮助 JOI 君回答所有这些问题。

## 输入格式

输入从标准输入给出，格式如下：

> $N$ $S$ $M$ $D_1$ $F_1$ $D_2$ $F_2$ ... $D_M$ $F_M$ $Q$ $T_1$ $P_1$ $T_2$ $P_2$ ... $T_Q$ $P_Q$

## 输出格式

输出包含 $Q$ 行，每行回答对应问题。

第 $i$ 行输出第 $i$ 个问题的答案。

## 说明/提示

- $1 \leq N \leq 150,000$
- $1 \leq M \leq 150,000$
- $1 \leq Q \leq 150,000$
- $S$ 是一个由 `W` 和 `B` 组成的长度为 $N$ 的字符串
- $D_i$ 是 `L` 或 `R`
- $F_i$ 是 `W` 或 `B`
- $1 \leq T_i \leq M$
- 放置第 $T_i$ 个棋子后，棋子的数量不少于 $P_i$
- 除以上提及字符串外，其余数值均为整数

### 子任务

1. 在所有子任务下，最多保证以下条件：
   - $N \leq 100$
   - $M \leq 100$
   - $Q \leq 100$

2. 特殊子任务条件：
   - $N = 1$

### 样例解释 1

最初，棋子颜色为 `WWBBW`。第 1 次放置的操作是将 `B` 放在左边，结果变为 `BWWBBW`，然后进一步转变为 `BBBBBW`，因为所有介于最左边的 `B` 和第 4 个 `B` 之间的棋子都被翻转。第 2 次操作是在右边放置 `W`，结果变为 `BBBBBWW`，没有棋子被翻转。第 3 次操作是右边放置 `B`，变为 `BBBBBWWB`，然后进一步翻转为 `BBBBBBBB`，因为所有在最右的 `B` 和它之间的一排棋子被翻转。接下来解答 JOI 君的问题：第 1 个问题是「在第 1 次放置结束后，第 2 个棋子的颜色是什么？」第 1 次操作结束后，棋子排布为 `BBBBBW`，所以第 2 个棋子是 `B`，即黑色。第 2 个问题是「在第 3 次放置后，第 4 个棋子的颜色是什么？」第 3 次操作结束后为 `BBBBBBBB`，故第 4 个棋子是 `B`，即黑色。

### 样例解释 2

初始棋子颜色是 `B`，过程依次变化为 `WB` → `BBB` → `BBBW` → `BBBWW` → `WWWWWW`。

 **本翻译由 AI 自动生成**

## 样例 #1

### 输入

```
5
WWBBW
3
L B
R W
R B
2
1 2
3 4
```

### 输出

```
B
B
```

## 样例 #2

### 输入

```
1
B
5
L W
L B
R W
R W
L W
5
1 1
2 2
3 2
4 5
5 3
```

### 输出

```
W
B
B
W
W
```


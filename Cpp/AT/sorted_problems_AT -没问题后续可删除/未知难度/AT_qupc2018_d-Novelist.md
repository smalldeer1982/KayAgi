---
title: "Novelist"
layout: "post"
diff: 难度0
pid: AT_qupc2018_d
tag: []
---

# Novelist

## 题目描述

Treeone 君在异世界转生后决定以冒险者身份接商人的护卫任务来赚取金钱。

在他转生后的高桥王国中，除了王都以外还有 $N$ 个城市，每个城市都被编号为 $1,\ 2,\ \ldots,\ N$。从王都到城市 $i$ 的移动需要 $T_i$ 天。

有 $M$ 个从王都出发到其他城市的护卫任务，每个任务的描述如下：第 $i$ 个任务在王都的出发时间是第 $A_i$ 天，任务要求到达城市 $X_i$ 的时间是 $A_i + T_{X_i}$ 天。

此外，还有 $L$ 个从城市到王都的护卫任务，每个任务的描述如下：第 $i$ 个任务在城市 $Y_i$ 出发的时间是第 $B_i$ 天，任务要求到达王都的时间是 $B_i + T_{Y_i}$ 天。

在任何一天，Treeone 君只能接受一个任务，并且在任务执行期间不能接受其他任务。最终，他能够接受的最大任务数是多少？

注意：Treeone 君一开始在王都，并且完成所有选中的任务后可以待在任何城市。

## 输入格式

输入的格式如下：

> $N$ $M$ $L$ $T_1$ $T_2$ $...$ $T_N$ $X_1$ $A_1$ $X_2$ $A_2$ $...$ $X_M$ $A_M$ $Y_1$ $B_1$ $Y_2$ $B_2$ $...$ $Y_L$ $B_L$

## 输出格式

输出一个整数，即能够接受的最大任务数。

## 样例 #1

### 样例解释

通过选择以下任务，Treeone 君可以获得 3 枚金货：
- 第 2 天从王都出发，到达城市 2。
- 第 4 天从城市 2 出发，到达王都。
- 第 6 天从王都出发，到达城市 1。

## 样例 #2

### 样例解释

在这个输入示例中，Treeone 君可以接受 2 个任务，满足所有时间不冲突的条件。

## 样例 #1

### 输入

```
2 3 2
3 1
1 1
2 2
1 6
1 5
2 4
```

### 输出

```
3
```

## 样例 #2

### 输入

```
1 2 2
0
1 1
1 2
1 1
1 3
```

### 输出

```
2
```


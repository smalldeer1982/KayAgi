---
title: "[ARC062F] AtCoDeerくんとグラフ色塗り"
layout: "post"
diff: NOI/NOI+/CTSC
pid: AT_arc062_d
tag: []
---

# [ARC062F] AtCoDeerくんとグラフ色塗り

## 题目描述

[problemUrl]: https://atcoder.jp/contests/arc062/tasks/arc062_d

シカのAtCoDeerくんはある日、 $ N $ 頂点 $ M $ 辺からなる単純な(すなわち、多重辺と自己ループのない)グラフを拾いました。頂点には$ 1 $,$ 2 $,$ .. $,$ N $の番号がついていて互いに区別が可能で、辺は$ (a_i,b_i)\ (1≦i≦M) $で表されます。 AtCoDeerくんは $ K $ 色のペンキを使って各辺を塗ろうとしています。ペンキは大量にあるので同じ色で複数の辺を塗ることが可能です。 AtCoDeerくんの拾ったグラフは特殊な形状をしているため、単純なサイクル(すなわち,サイクルであって同じ頂点を一度しか通らないもの)を選んで、そのサイクル上の辺の色をひとつずつサイクルに沿ってずらすことが出来ます。正確に言うと、サイクル上の辺を順に $ e_1 $, $ e_2 $,$ .. $,$ e_a $ とすると、 $ e_1 $ に塗られていた色を $ e_2 $ に、$ e_2 $ に塗られていた色を $ e_3 $ に、 $ ... $、 $ e_{a-1} $ に塗られていた色を $ e_a $ に、$ e_a $ に塗られていた色を $ e_1 $ に、同時に塗り替えることが出来ます。

 ![](https://cdn.luogu.com.cn/upload/vjudge_pic/AT_arc062_d/d769d5f72437baaefec309ddf8df7e455254b9bb.png)図$ 1 $: 操作の例

 

塗り方Aと塗り方Bは、この操作を有限回行ってAからBに変形できるときに同じ塗り方だとみなします。グラフの塗り方が何通りあるか求めてください。ただしこの数は非常に大きくなることがあるので、 $ 10^9+7 $ で割ったあまりを出力してください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ M $ $ K $ $ a_1 $ $ b_1 $ $ a_2 $ $ b_2 $ $ : $ $ a_M $ $ b_M $

## 输出格式

塗り方が何通りあるかを $ 10^9+7 $ で割ったあまりを出力せよ。

## 说明/提示

### 制約

- $ 1≦N≦50 $
- $ 1≦M≦100 $
- $ 1≦K≦100 $
- $ 1≦a_i,b_i≦N\ (1≦i≦M) $
- グラフには自己ループや多重辺はない。

## 样例 #1

### 输入

```
4 4 2
1 2
2 3
3 1
3 4
```

### 输出

```
8
```

## 样例 #2

### 输入

```
5 2 3
1 2
4 5
```

### 输出

```
9
```

## 样例 #3

### 输入

```
11 12 48
3 1
8 2
4 9
5 4
1 6
2 9
8 3
10 8
4 10
8 6
11 7
1 8
```

### 输出

```
569519295
```


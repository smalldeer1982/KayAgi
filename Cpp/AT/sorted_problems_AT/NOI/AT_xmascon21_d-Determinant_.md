---
title: "Determinant?"
layout: "post"
diff: NOI/NOI+/CTSC
pid: AT_xmascon21_d
tag: []
---

# Determinant?

## 题目描述

给定 $N$ 个 $K \times K$ 的整数矩阵 $A_1, \ldots, A_N$。矩阵 $A_h$ 的第 $(i, j)$ 个元素记为 $A_{h,i,j}$，其中 $1 \le h \le N$，$1 \le i \le K$，$1 \le j \le K$。

请计算一个新的 $K \times K$ 矩阵，其矩阵元素由下面的公式求得：

对于 $N$ 个矩阵的所有 $N!$ 种排列，计算每种排列下的矩阵乘积，并乘以对应排列的符号，然后将这些结果加总。最后，求得每个元素对 $998244353$ 的模，即将结果取余使其在 $0$ 到 $998244352$ 间。

## 输入格式

输入以以下格式给出：

> 第一行：两个整数 $N$ 和 $K$  
> 接下来 $N$ 段，每段包含 $K \times K$ 个整数，对应矩阵的所有元素，从 $A_{1,1,1}$ 一直到 $A_{N,K,K}$

## 输出格式

要求输出结果矩阵的每个元素。对于结果矩阵的 $(i, j)$ 元素 $b_{i,j}$ ($1 \le i \le K$，$1 \le j \le K$)，输出格式为：

> 首行：$b_{1,1}$ 到 $b_{1,K}$  
> 第 $2$ 行到第 $K$ 行格式相同

## 说明/提示

- $1 \le N \le 32$
- $1 \le K \le 8$
- 所有的矩阵元素均在 $0$ 到 $998244352$ 之间

本题的运算量较大，需要注意计算过程中的效率。理解符号函数和运用排列组合的技巧对解题至关重要。

 **本翻译由 AI 自动生成**

## 样例 #1

### 输入

```
2 3
2 7 1
8 2 8
1 8 2
8 4 5
9 0 4
5 2 3
```

### 输出

```
31 998244259 998244344
100 998244306 55
61 998244298 16
```

## 样例 #2

### 输入

```
3 2
30 10
40 10
50 90
20 60
50 30
50 80
```

### 输出

```
155000 122000
67000 364000
```


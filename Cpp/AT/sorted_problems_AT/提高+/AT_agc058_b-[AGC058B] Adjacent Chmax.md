---
title: "[AGC058B] Adjacent Chmax"
layout: "post"
diff: 提高+/省选-
pid: AT_agc058_b
tag: ['动态规划 DP', '单调队列']
---

# [AGC058B] Adjacent Chmax

## 题目描述

## 题目翻译


给你一个 $1 \sim n$ 的排列 $P$ ,你可以进行若干次如下操作，也可以不进行操作。

- 每次选择一个整数 $i$ ($1\ \leq\ i\ \leq\ N-1$) ，使 $v=\max(P_i,P_{i+1})$ ，然后将 $P_i$ 和 $P_{i+1}$ 改为 $v$ 。

求问最后可能得到多少种不同的结果，答案对 $ 998244353 $ 取模。

## 输入格式

第一行一行一个整数 $N$ 。

第二行 $N$ 个整数，第 $i$ 个数表示 $P_i$ 。

## 输出格式

一行一个整数，多少种不同的结果。

## 说明/提示

- $ 2\ \leq\ N\ \leq\ 5000 $
- $ (P_1,P_2,\cdots,P_N) $ 为 $ (1,2,\cdots,N) $ 的排列
- 输入均为整数

### 样例解释 1

操作后 $P$ 可能为 $(1,3,2),(3,3,2),(1,3,3),(3,3,3)$ 这 $4$ 种结果。

## 样例 #1

### 输入

```
3
1 3 2
```

### 输出

```
4
```

## 样例 #2

### 输入

```
4
2 1 3 4
```

### 输出

```
11
```

## 样例 #3

### 输入

```
10
4 9 6 3 8 10 1 2 7 5
```

### 输出

```
855
```


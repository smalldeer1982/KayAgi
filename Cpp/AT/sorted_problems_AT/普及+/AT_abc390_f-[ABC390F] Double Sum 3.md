---
title: "[ABC390F] Double Sum 3"
layout: "post"
diff: 普及+/提高
pid: AT_abc390_f
tag: []
---

# [ABC390F] Double Sum 3

## 题目描述

给你一个长为 $N$ 的整数序列 $A=(A_1,A_2, \dots A_N)$。\
定义 $f(L,R)$ 如下
- 从一块空黑板开始。在黑板上依次写下 $R−L+1$ 个整数 $A_L,A_{l+1}, \dots,A_R$
- 重复下面的操作，直到擦去黑板上的所有整数：
	- 选择 $l,r(l \le r)$ 使得**数值**在 $[l,r]$ 的每个整数都至少在黑板上出现一次。然后，擦除所有**数值**在 $[l,r]$ 之间的整数。
- 设 $f(L,R)$ 是擦除黑板上所有整数所需的最少次数。

求出 $\displaystyle \sum_{L=1}^N \sum_{R=L}^N f(L,R)$。

## 输入格式

第一行一个正整数 $N$。第二行 $N$ 个正整数 $A_1,A_2,\dots,A_N$。

## 输出格式

输出一行，即所求答案。
### 样例1解释
以 $(L,R)$ 为例。\
黑板上有 $1,3,1,4$。\
选择 $(L,R)=(1,1)$ 并擦除所有 $1$。现在黑板上有 $(3,4)$。\
选择 $(L,R)=(3,4)$ 并擦除所有 $3$ 和 $4$。黑板就变成空的了。\
不能少于 $2$ 次操作完成。\
$\displaystyle \sum_{L=1}^N \sum_{R=L}^N f(L,R)=16$，所以打印 $16$。

## 样例 #1

### 输入

```
4
1 3 1 4
```

### 输出

```
16
```

## 样例 #2

### 输入

```
5
3 1 4 2 4
```

### 输出

```
23
```

## 样例 #3

### 输入

```
10
5 1 10 9 2 5 6 9 1 6
```

### 输出

```
129
```


---
title: "IOI のために"
layout: "post"
diff: 难度0
pid: AT_pakencamp_2019_day4_e
tag: []
---

# IOI のために

## 题目描述

### 题目背景
在 $\text{20XX}$ 年，IOI 已经是家喻户晓的著名比赛，每年夏季和冬季都会举办。

$\text{20XX}$ 年的 IOI 比赛将在 K 国举办，负责人决定扩展广场的道路。
### 题意
在 IOI 比赛时，可以使用的 K 国土地有 $N$ 块，有 $M$ 条道路穿过。

土地的编号为 $1$ 至 $N$，道路的编号为 $1$ 至 $M$。无论哪两个土地之间，都可以通过道路来往。

道路 $i$ 将土地 $A_i$ 和 $B_i$ 双向连接，夏季通行所需时间为 $S_i$，冬季通行所需时间为 $W_i$。

从土地 $1$ 到达土地 $N$ 的路线称为**远足路线**。求在夏天和冬天中至少一个季节里，有几条满足 **<不存在通行所需总时间更短的远足路线>** 的远足路线。

答案对 $10^9+7$ 取余。

## 输入格式

第一行读入两个整数 $N$ 和 $M$。

接下来 $M$ 行，每行读入四个整数 $A_M,B_M,S_M,W_M$。

## 输出格式

输出一行一个整数，表示在夏天或冬天的至少一个季节中，满足如上条件的远足路线的个数，并对 $10^9+7$ 取余。

## 说明/提示

**本题使用捆绑测试。**

- Subtask 1(5 pts) : 满足 $M=N-1$。
- Subtask 2(15 pts) : 满足 $N\le 10$。
- Subtask 3(20 pts) : 对于任意的 $ 1\ \leq\ i\ \leq\ M $，满足 $ S_i\ =\ W_i $。
- Subtask 4(35 pts) : 满足 $N\le1000$。
- Subtask 5(25 pts) : 无附加条件。

对于 $100\%$ 的数据，保证
- 输入均为整数
- $ 2\ \leq\ N\ \leq\ 2\ \times\ 10^5 $
- $ 1\ \leq\ M\ \leq\ 2\ \times\ 10^5 $
- $ 1\ \leq\ A_i,\ B_i\ \leq\ N\ (1\ \leq\ i\ \leq\ M) $
- $ 1\ \leq\ S_i,\ W_i\ \leq\ 10^9\ (1\ \leq\ i\ \leq\ M) $
- 每两块土地之间都可以通过道路相来往
### 样例 1 解释
满足条件的远足路线有以下 $ 6 $ 条。
- 按照道路 $ 1,\ 7 $ 的顺序通过，在夏天和冬天都满足条件；
- 按照道路 $ 2,\ 5,\ 7 $ 的顺序通过，在夏天和冬天都满足条件；
- 按照道路 $ 2,\ 6,\ 7 $ 的顺序通过，在冬天满足条件； 
- 按照道路 $ 3,\ 5,\ 7 $ 的顺序通过，在冬天满足条件；
- 按照道路 $ 3,\ 6,\ 7 $ 的顺序通过，在冬天满足条件；
- 按照道路 $ 2,\ 8 $ 的顺序通过，在夏天满足条件。

[@lihl](https://www.luogu.com.cn/user/711887) 提供翻译。

## 样例 #1

### 输入

```
4 8
1 2 3 2
1 3 2 1
1 3 3 1
2 2 1 1
2 3 1 1
2 3 2 1
2 4 1 2
3 4 2 4
```

### 输出

```
6
```

## 样例 #2

### 输入

```
4 5
1 2 3 6
2 3 1 2
3 4 2 5
1 3 5 3
2 4 4 2
```

### 输出

```
2
```

## 样例 #3

### 输入

```
20 77
9 16 65551022 36847141
4 8 169905126 234841269
8 18 61782163 101070315
8 9 763292109 656192270
1 18 76893781 240632078
3 19 601597138 476288881
5 19 595403102 581080612
3 6 980642190 183697163
6 9 663706146 95151932
11 18 679581087 523262198
12 16 293035618 152800086
3 7 814717585 273291118
1 2 853500661 870996856
2 3 526446904 394372085
2 9 75096934 115522990
4 9 599545324 421351001
1 13 282807719 968765138
6 15 458441410 364130005
1 4 178858403 334122865
4 4 242708006 509603317
8 13 368467895 338762793
13 17 697663167 640858525
11 20 238453071 271106570
2 17 126970225 114980011
14 18 279244522 277866206
11 20 238453071 271106570
5 20 714162258 622887639
4 12 694170286 610998228
9 16 65551022 36847141
15 15 341887831 393369008
3 8 311942139 377343175
1 8 15111618 99281596
2 4 674642258 536873991
2 16 9545912 78675849
1 8 15111618 99281596
12 20 121899250 49599586
14 20 638789636 516502562
5 17 699705205 614143827
7 13 480049964 311871500
9 14 422265424 394103067
7 10 230695689 160298785
2 20 141427278 488804437
9 16 65551022 36847141
2 4 746378429 794786225
1 13 684196511 438044389
9 19 97765056 384638724
8 14 599920464 622509237
16 20 446862361 693104823
2 20 141427278 250722614
17 18 964998636 785624956
11 20 238453071 271106570
1 3 327053757 476624771
1 5 327955959 908911545
3 11 429421111 769824924
7 19 113311100 202997763
13 18 205913938 237692478
1 17 980470886 985976867
3 12 545974932 468496322
6 19 312631863 292591718
11 15 651379358 427422180
3 8 311942139 377343175
8 17 965359268 886695271
3 20 667874182 518095908
12 17 107442197 40855774
2 10 321338667 306331990
4 13 103949316 103921524
9 10 246241733 165856762
7 14 406719380 271697772
7 8 747746065 755010172
1 9 778403727 755473866
8 17 965359268 886695271
5 11 475709187 351781069
8 11 751809642 869885243
5 19 595403102 581080612
19 20 118759156 41807027
3 19 646592547 476288881
3 12 850613737 468496322
```

### 输出

```
190
```


---
title: "[ABC214G] Three Permutations"
layout: "post"
diff: 省选/NOI-
pid: AT_abc214_g
tag: []
---

# [ABC214G] Three Permutations

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc214/tasks/abc214_g

$ (1,\ \dots,\ N) $ の順列 $ p\ =\ (p_1,\ \dots,\ p_N),\ q\ =\ (q_1,\ \dots,\ q_N) $ が与えられます。

$ (1,\ \dots,\ N) $ の順列 $ r\ =\ (r_1,\ \dots,\ r_N) $ であって、全ての $ i\ \,\ (1\ \leq\ i\ \leq\ N) $ に対し $ r_i\ \neq\ p_i $ かつ $ r_i\ \neq\ q_i $ となるようなものの総数を $ (10^9\ +\ 7) $ で割った余りを求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ p_1 $ $ \ldots $ $ p_N $ $ q_1 $ $ \ldots $ $ q_N $

## 输出格式

答えを出力せよ。

## 说明/提示

### 制約

- $ 1\ \leq\ N\ \leq\ 3000 $
- $ 1\ \leq\ p_i,\ q_i\ \leq\ N $
- $ p_i\ \neq\ p_j\ \,\ (i\ \neq\ j) $
- $ q_i\ \neq\ q_j\ \,\ (i\ \neq\ j) $
- 入力は全て整数である。

### Sample Explanation 1

$ (3,\ 4,\ 1,\ 2),\ (3,\ 4,\ 2,\ 1),\ (4,\ 3,\ 1,\ 2),\ (4,\ 3,\ 2,\ 1) $ の $ 4 $ つが条件を満たします。

### Sample Explanation 2

答えが $ 0 $ になることもあります。

### Sample Explanation 3

$ (10^9\ +\ 7) $ で割った余りを出力することに注意してください。

## 样例 #1

### 输入

```
4
1 2 3 4
2 1 4 3
```

### 输出

```
4
```

## 样例 #2

### 输入

```
3
1 2 3
2 1 3
```

### 输出

```
0
```

## 样例 #3

### 输入

```
20
2 3 15 19 10 7 5 6 14 13 20 4 18 9 17 8 12 11 16 1
8 12 4 13 19 3 10 16 11 9 1 2 17 6 5 18 7 14 20 15
```

### 输出

```
803776944
```


---
title: "Spanning Tree"
layout: "post"
diff: 省选/NOI-
pid: AT_jsc2021_g
tag: []
---

# Spanning Tree

## 题目描述

[problemUrl]: https://atcoder.jp/contests/jsc2021/tasks/jsc2021_g

$ N $ 頂点のグラフ $ G $ があり、頂点には $ 1,\ 2,\ \dots,\ N $ の番号がついています。はじめ、$ G $ には辺がありません。  
 これから $ G $ に何本か無向辺を追加します。ただし、辺を追加し終わった後、任意の $ i,\ j\,(i\ ≠\ j) $ について以下の条件を満たす必要があります。

- $ A_{i,\ j}\ =\ 1 $ のとき、頂点 $ i $ と頂点 $ j $ を直接結ぶ辺が存在する。
- $ A_{i,\ j}\ =\ 0 $ のとき、頂点 $ i $ と頂点 $ j $ を直接結ぶ辺が存在しない。
- $ A_{i,\ j}\ =\ -1 $ のとき、どちらでもよい。

辺を追加し終わった後の $ G $ としてあり得るもののうち、木であるものはいくつあるでしょうか？  
 ただし、答えは非常に大きくなることがあるので、答えを $ (10^9\ +\ 7) $ で割った余りを求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ A_{1,\ 1} $ $ \cdots $ $ A_{1,\ N} $ $ \vdots $ $ A_{N,\ 1} $ $ \cdots $ $ A_{N,\ N} $

## 输出格式

答えを $ (10^9\ +\ 7) $ で割った余りを出力せよ。

## 说明/提示

### 制約

- 入力は全て整数
- $ 2\ <\ =\ N\ <\ =\ 300 $
- $ -1\ <\ =\ A_{i,\ j}\ =\ A_{j,\ i}\ <\ =\ 1 $
- $ A_{i,\ i}\ =\ 0 $

### Sample Explanation 1

頂点 $ 1 $ と頂点 $ 2 $ の間には辺が必要で、頂点 $ 1 $ と頂点 $ 4 $ の間、頂点 $ 3 $ と頂点 $ 4 $ の間には辺を追加してはいけません。 したがって、以下の $ 2 $ 個が条件を満たします。 !\[\](https://img.atcoder.jp/ghi/0f55bf9e7a13aef4bddde12f87a23d5d.png)

### Sample Explanation 4

頂点を区別するとき、$ 11 $ 頂点の木は全部で $ 11^9 $ 個あります。

## 样例 #1

### 输入

```
4
0 1 -1 0
1 0 -1 -1
-1 -1 0 0
0 -1 0 0
```

### 输出

```
2
```

## 样例 #2

### 输入

```
3
0 1 1
1 0 1
1 1 0
```

### 输出

```
0
```

## 样例 #3

### 输入

```
3
0 0 0
0 0 0
0 0 0
```

### 输出

```
0
```

## 样例 #4

### 输入

```
11
0 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1
-1 0 -1 -1 -1 -1 -1 -1 -1 -1 -1
-1 -1 0 -1 -1 -1 -1 -1 -1 -1 -1
-1 -1 -1 0 -1 -1 -1 -1 -1 -1 -1
-1 -1 -1 -1 0 -1 -1 -1 -1 -1 -1
-1 -1 -1 -1 -1 0 -1 -1 -1 -1 -1
-1 -1 -1 -1 -1 -1 0 -1 -1 -1 -1
-1 -1 -1 -1 -1 -1 -1 0 -1 -1 -1
-1 -1 -1 -1 -1 -1 -1 -1 0 -1 -1
-1 -1 -1 -1 -1 -1 -1 -1 -1 0 -1
-1 -1 -1 -1 -1 -1 -1 -1 -1 -1 0
```

### 输出

```
357947677
```


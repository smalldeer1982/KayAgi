---
title: "[AGC050E] Three Traffic Lights"
layout: "post"
diff: NOI/NOI+/CTSC
pid: AT_agc050_e
tag: ['数论', '素数判断,质数,筛法', '中国剩余定理 CRT']
---

# [AGC050E] Three Traffic Lights

## 题目描述

[problemUrl]: https://atcoder.jp/contests/agc050/tasks/agc050_e

$ 3 $ 機の信号機があり、$ 1,\ 2,\ 3 $ と番号が振られています。 信号機 $ i $ は、「$ g_i $ 秒間青、$ r_i $ 秒間赤、$ g_i $ 秒間青、$ r_i $ 秒間赤、$ \ldots $」というパターンを永久に繰り返します。

いま、$ 3 $ 機の信号機が一斉に青に変わりました。 続く $ (g_1\ +\ r_1)(g_2\ +\ r_2)(g_3\ +\ r_3) $ 秒間のうち、全ての信号機が青く点灯している時間帯は合計で何秒あるでしょうか。 この答えを $ 998,244,353 $ で割った余りを計算してください。

## 输入格式

入力は標準入力から以下の形式で与えられる。

> $ g_1 $ $ r_1 $ $ g_2 $ $ r_2 $ $ g_3 $ $ r_3 $

## 输出格式

答えを出力せよ。

## 说明/提示

### 制約

- $ 1\ \leq\ g_1,\ r_1,\ g_2,\ r_2,\ g_3,\ r_3\ \leq\ 10^{12} $
- 入力中の全ての値は整数である。

### Sample Explanation 1

続く $ 24 $ 秒間のうち、 - 信号機 $ 1 $ が青く点灯している時間帯は $ [0,\ 1],\ [2,\ 3],\ [4,\ 5],\ [6,\ 7],\ [8,\ 9],\ [10,\ 11],\ [12,\ 13],\ [14,\ 15],\ [16,\ 17],\ [18,\ 19],\ [20,\ 21],\ [22,\ 23] $ です。 - 信号機 $ 2 $ が青く点灯している時間帯は $ [0,\ 2],\ [3,\ 5],\ [6,\ 8],\ [9,\ 11],\ [12,\ 14],\ [15,\ 17],\ [18,\ 20],\ [21,\ 23] $ です。 - 信号機 $ 3 $ が青く点灯している時間帯は $ [0,\ 3],\ [4,\ 7],\ [8,\ 11],\ [12,\ 15],\ [16,\ 19],\ [20,\ 23] $ です。 よって、全ての信号機が青く点灯している時間帯は $ [0,\ 1],\ [4,\ 5],\ [6,\ 7],\ [10,\ 11],\ [12,\ 13],\ [16,\ 17],\ [18,\ 19],\ [22,\ 23] $ であり、合計で $ 8 $ 秒あります。

## 样例 #1

### 输入

```
1 1 2 1 3 1
```

### 输出

```
8
```

## 样例 #2

### 输入

```
7 3 5 7 11 4
```

### 输出

```
420
```

## 样例 #3

### 输入

```
999999999991 999999999992 999999999993 999999999994 999999999995 999999999996
```

### 输出

```
120938286
```



---

---
title: "[AGC063D] Many CRT"
layout: "post"
diff: NOI/NOI+/CTSC
pid: AT_agc063_d
tag: ['数学', '数论', '中国剩余定理 CRT']
---

# [AGC063D] Many CRT

## 题目描述

[problemUrl]: https://atcoder.jp/contests/agc063/tasks/agc063_d

正整数 $ N,\ a,\ b,\ c,\ d $ が与えられます．

$ k=0,1,\ldots,N-1 $ すべてに対して $ x\equiv\ a+kb\ \pmod{c+kd} $ が成り立つような非負整数 $ x $ が存在するか否かを判定してください．存在する場合には，そのような $ x $ のうち最小のものを $ 998244353 $ で割った余りを求めてください．

## 输入格式

入力は以下の形式で標準入力から与えられます．

> $ N $ $ a $ $ b $ $ c $ $ d $

## 输出格式

条件を満たす非負整数 $ x $ が存在しない場合には `-1` を出力してください．存在する場合には，そのような $ x $ のうち最小のものを $ 998244353 $ で割った余りを出力してください．

## 说明/提示

### 制約

- $ 2\leq\ N\leq\ 10^6 $
- $ 1\leq\ a,b,c,d\leq\ 10^6 $
 
### Sample Explanation 1

$ x\equiv\ 1\pmod{3} $ かつ $ x\equiv\ 3\pmod{7} $ を満たす最小の非負整数は $ x=10 $ です．

### Sample Explanation 2

$ x\equiv\ 1\pmod{10} $ かつ $ x\equiv\ 2\pmod{20} $ を満たす非負整数は存在しません．

### Sample Explanation 3

条件を満たす最小の非負整数は $ x=\ 0 $ です．

### Sample Explanation 4

条件を満たす最小の非負整数は $ x=\ 15977769171609124 $ です．

## 样例 #1

### 输入

```
2 1 2 3 4
```

### 输出

```
10
```

## 样例 #2

### 输入

```
2 1 1 10 10
```

### 输出

```
-1
```

## 样例 #3

### 输入

```
100 20 30 2 3
```

### 输出

```
0
```

## 样例 #4

### 输入

```
9 12 34 56 78
```

### 输出

```
827501367
```



---


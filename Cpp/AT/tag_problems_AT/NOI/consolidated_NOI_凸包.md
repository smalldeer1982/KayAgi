---
title: "[ABC372G] Ax + By < C"
layout: "post"
diff: NOI/NOI+/CTSC
pid: AT_abc372_g
tag: ['凸包', '半平面交', '类欧几里得算法']
---

# [ABC372G] Ax + By < C

## 题目描述

### 题目简述

给定三个数列 $(A_1, A_2, \cdots, A_N)$，$(B_1, B_2, \cdots, B_N)$，$(C_1, C_2, \cdots, C_N)$，求满足 $A_ix+B_iy<C_i$ ($1 \leq i \leq N$) 的有序正整数对 $(x,y)$ 的个数。

## 输入格式

**本题有多组测试数据。**

第 $1$ 行输入一个正整数 $T$，表示数据组数。

接下来每个数据组：第 $1$ 行输入一个正整数 $N$，接下来 $N$ 行每行输入三个正整数 $A_i, B_i, C_i$。

## 输出格式

对于每个数据组，输出一个整数表示答案。

## 说明/提示

约定 $1 \leq T \leq 2\times 10^5$，$1 \leq \sum N \leq 2\times 10^5$，$1 \leq A_i, B_i, C_i \leq 10^9$。

对于样例 $1$，第一个数据组中满足条件的 $(x, y)$ 有 $(1, 1)$ 和 $(2, 1)$，故应当输出 $2$。第二个数据组中，没有满足条件的 $(x, y)$，故应当输出 $0$。

## 样例 #1

### 输入

```
2

2

1 1 4

1 2 5

1

1 1 2
```

### 输出

```
2

0
```

## 样例 #2

### 输入

```
3

7

138 16011 918976

5478 7748 499926

5234 17727 748589

1157 10511 643136

31200 3005 721285

28839 14469 798851

1933 5378 864127

9

17775 1665 386430

37001 863 922418

9756 4182 746671

12379 9106 807578

3984 4049 640539

25333 9869 780810

20372 7000 688738

16107 11974 827227

10779 10531 770510

5

4916 14132 460944

11856 45422 610561

56014 18216 825793

10363 6220 945356

37418 33866 851593
```

### 输出

```
660

995

140
```



---

---
title: "[AGC043F] Jewelry Box"
layout: "post"
diff: NOI/NOI+/CTSC
pid: AT_agc043_f
tag: ['费用流', '凸包']
---

# [AGC043F] Jewelry Box

## 题目描述

[problemUrl]: https://atcoder.jp/contests/agc043/tasks/agc043_f

$ 1 $ から $ N $ までの番号のついた $ N $ 軒の宝石店があります．

宝石店 $ i $ ($ 1\ \leq\ i\ \leq\ N $) では，$ K_i $ 種類の宝石が売られています． このうち，$ j $ ($ 1\ \leq\ j\ \leq\ K_i $) 種類目の宝石は，大きさが $ S_{i,j} $，値段が $ P_{i,j} $ で，在庫が $ C_{i,j} $ 個あります．

**よい** 宝石箱とは，以下の条件をすべて満たす宝石箱です．

- 宝石箱の中には，各宝石店で買った宝石が $ 1 $ 個ずつ入っている．
- 次の $ M $ 個の条件をすべて満たす．
  - $ i $ ($ 1\ \leq\ i\ \leq\ M $) 番目の条件: $ ( $宝石店 $ V_i $ で買った宝石の大きさ$ )\leq\ ( $宝石店 $ U_i $ で買った宝石の大きさ$ )+W_i $

次の $ Q $ 個の質問に答えてください． $ i $ ($ 1\ \leq\ i\ \leq\ Q $) 番目の質問では，整数 $ A_i $ が与えられるので，$ A_i $ 個のよい宝石箱を準備するとき，買う宝石の値段の合計の最小値を求めてください． ただし，$ A_i $ 個のよい宝石箱が準備できない場合はその旨を答えてください．

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ 宝石店$ \ 1\ $の情報 宝石店$ \ 2\ $の情報 $ \vdots $ 宝石店$ \ N\ $の情報 $ M $ $ U_1 $ $ V_1 $ $ W_1 $ $ U_2 $ $ V_2 $ $ W_2 $ $ \vdots $ $ U_M $ $ V_M $ $ W_M $ $ Q $ $ A_1 $ $ A_2 $ $ \vdots $ $ A_Q $

宝石店 $ i $ ($ 1\ \leq\ i\ \leq\ N $) の情報は，以下の形式で与えられる．

> $ K_i $ $ S_{i,1} $ $ P_{i,1} $ $ C_{i,1} $ $ S_{i,2} $ $ P_{i,2} $ $ C_{i,2} $ $ \vdots $ $ S_{i,K_i} $ $ P_{i,K_i} $ $ C_{i,K_i} $

## 输出格式

$ Q $ 行出力せよ． そのうち $ i $ 行目には，$ A_i $ 個のよい宝石箱を準備するときに買う宝石の値段の合計の最小値を出力せよ． ただし，$ A_i $ 個のよい宝石箱を準備することが不可能な場合は，$ -1 $ を出力せよ．

## 说明/提示

### 制約

- $ 1\ \leq\ N\ \leq\ 30 $
- $ 1\ \leq\ K_i\ \leq\ 30 $
- $ 1\ \leq\ S_{i,j}\ \leq\ 10^9 $
- $ 1\ \leq\ P_{i,j}\ \leq\ 30 $
- $ 1\ \leq\ C_{i,j}\ \leq\ 10^{12} $
- $ 0\ \leq\ M\ \leq\ 50 $
- $ 1\ \leq\ U_i,V_i\ \leq\ N $
- $ U_i\ \neq\ V_i $
- $ 0\ \leq\ W_i\ \leq\ 10^9 $
- $ 1\ \leq\ Q\ \leq\ 10^5 $
- $ 1\ \leq\ A_i\ \leq\ 3\ \times\ 10^{13} $
- 入力は全て整数である．

### Sample Explanation 1

宝石店 $ i $ で売られている $ j $ 種類目の宝石を宝石 $ (i,j) $ で表すことにします． 各クエリの答えは，以下のようになります． - $ A_1=1 $: 宝石 $ (1,2),(2,2),(3,1) $ を使う宝石箱を準備すると，コストが $ 1+1+1=3 $ となり，最小． - $ A_2=2 $: 宝石 $ (1,1),(2,1),(3,1) $ を使う宝石箱と，宝石 $ (1,2),(2,3),(3,2) $ を使う宝石箱を準備すると， コストが $ (10+10+1)+(1+10+10)=42 $ となり，最小． - $ A_3=3 $: $ 3 $ つの良い宝石箱を準備することはできない．

## 样例 #1

### 输入

```
3

2

1 10 1

3 1 1

3

1 10 1

2 1 1

3 10 1

2

1 1 1

3 10 1

2

1 2 0

2 3 0

3

1

2

3
```

### 输出

```
3

42

-1
```

## 样例 #2

### 输入

```
5

5

86849520 30 272477201869

968023357 28 539131386006

478355090 8 194500792721

298572419 6 894877901270

203794105 25 594579473837

5

730211794 22 225797976416

842538552 9 420531931830

871332982 26 81253086754

553846923 29 89734736118

731788040 13 241088716205

5

903534485 22 140045153776

187101906 8 145639722124

513502442 9 227445343895

499446330 6 719254728400

564106748 20 333423097859

5

332809289 8 640911722470

969492694 21 937931959818

207959501 11 217019915462

726936503 12 382527525674

887971218 17 552919286358

5

444983655 13 487875689585

855863581 6 625608576077

885012925 10 105520979776

980933856 1 711474069172

653022356 19 977887412815

10

1 2 231274893

2 3 829836076

3 4 745221482

4 5 935448462

5 1 819308546

3 5 815839350

5 3 513188748

3 1 968283437

2 3 202352515

4 3 292999238

10

510266667947

252899314976

510266667948

374155726828

628866122125

628866122123

1

628866122124

510266667949

30000000000000
```

### 输出

```
26533866733244

13150764378752

26533866733296

19456097795056

-1

33175436167096

52

33175436167152

26533866733352

-1
```



---

---
title: "[AGC044E] Random Pawn"
layout: "post"
diff: NOI/NOI+/CTSC
pid: AT_agc044_e
tag: ['动态规划 DP', '概率论', '期望', '凸包']
---

# [AGC044E] Random Pawn

## 题目描述

[problemUrl]: https://atcoder.jp/contests/agc044/tasks/agc044_e

あなたの目的は、これからプレイするゲームでの利得の期待値を最大化することです。 ゲームを開始すると、ポーン (チェスの駒) が $ \{1,2,\dots,\ N\} $ から等確率に選ばれた位置 $ p $ に置かれます。これらの $ N $ 個の位置 $ 1,\ 2,\ \dots,\ N $ は円周上に時計回りに並び、位置 $ 1 $ の両隣は位置 $ N,\ 2 $ です。

ゲームはターン制で進行します。各ターンでは、ゲームを終えて $ A_p $ ドル ($ p $ はその時点でのポーンの位置) を得るか、$ B_p $ ドルを支払ってゲームを続けるかを選べます。 ゲームを続ける場合、ポーンは自身と隣接する $ 2 $ つの位置 $ p-1 $, $ p+1 $ のいずれかに等確率で移されます (位置 $ 0 $ は位置 $ N $ と、位置 $ N+1 $ は位置 $ 1 $ とみなします)。

最適な戦略の期待利得は何ドルでしょうか。

**注記**: 「最適な戦略の期待利得」は、ゲームが *有限の* ターン数で終わるような戦略における期待利得の上限と定義されます。

## 输入格式

入力は標準入力から以下の形式で与えられる。

> $ N $ $ A_1 $ $ A_2 $ $ \cdots $ $ A_N $ $ B_1 $ $ B_2 $ $ \cdots $ $ B_N $

## 输出格式

最適な戦略の期待利得を $ 1 $ 個の実数として出力せよ。

出力された値は、絶対誤差または相対誤差が $ 10^{-10} $ を超えなければ正解とみなされる。

## 说明/提示

### 制約

- $ 2\ \le\ N\ \le\ 200,000 $
- $ 0\ \le\ A_p\ \le\ 10^{12} $ ($ p\ =\ 1,\ldots,\ N $)
- $ 0\ \le\ B_p\ \le\ 100 $ ($ p\ =\ 1,\ \ldots,\ N $)
- 入力中のすべての値は整数である。

## 样例 #1

### 输入

```
5

4 2 6 3 5

1 1 1 1 1
```

### 输出

```
4.700000000000
```

## 样例 #2

### 输入

```
4

100 0 100 0

0 100 0 100
```

### 输出

```
50.000000000000
```

## 样例 #3

### 输入

```
14

4839 5400 6231 5800 6001 5200 6350 7133 7986 8012 7537 7013 6477 5912

34 54 61 32 52 61 21 43 65 12 45 21 1 4
```

### 输出

```
7047.142857142857
```

## 样例 #4

### 输入

```
10

470606482521 533212137322 116718867454 746976621474 457112271419 815899162072 641324977314 88281100571 9231169966 455007126951

26 83 30 59 100 88 84 91 54 61
```

### 输出

```
815899161079.400024414062
```



---

---
title: "[AGC051E] Middle Point"
layout: "post"
diff: NOI/NOI+/CTSC
pid: AT_agc051_e
tag: ['数学', '凸包']
---

# [AGC051E] Middle Point

## 题目描述

[problemUrl]: https://atcoder.jp/contests/agc051/tasks/agc051_e

平面上に、はじめ $ N $ 点 $ (x_1,\ y_1),\ \ldots,\ (x_N,\ y_N) $ が打たれています。 すぬけ君は、以下の操作を任意の有限回行うことができます。

- すでに打たれている $ 2 $ 点を選び、その中点を打つ (その点がまだ打たれていない場合に限る)。中点が格子点である必要はない。

操作を済ませたら、打たれている格子点の数 (はじめの $ N $ 点を含む) がすぬけ君の得点となります。 獲得可能な最高得点を計算してください。

## 输入格式

入力は標準入力から以下の形式で与えられる。

> $ N $ $ x_1 $ $ y_1 $ $ : $ $ x_N $ $ y_N $

## 输出格式

答えを出力せよ。

## 说明/提示

### 制約

- $ 3\ \leq\ N\ \leq\ 100 $
- $ 0\ \leq\ x_i,\ y_i\ \leq\ 10^9 $
- どの $ 3 $ 点も同一直線上にない。
- 入力中の全ての値は整数である。

### Sample Explanation 1

最高得点を得る方法の一例は以下の通りです。 - はじめ、$ 4 $ 点 $ (0,\ 0),\ (0,\ 2),\ (2,\ 0),\ (2,\ 2) $ が打たれている。 - $ (0,\ 0) $ と $ (0,\ 2) $ の中点 $ (0,\ 1) $ を打つ。 - $ (0,\ 0) $ と $ (0,\ 1) $ の中点 $ (0,\ 0.5) $ を打つ。 - $ (0,\ 0) $ と $ (2,\ 0) $ の中点 $ (1,\ 0) $ を打つ。 - $ (0,\ 0) $ と $ (2,\ 2) $ の中点 $ (1,\ 1) $ を打つ。 - $ (0,\ 2) $ と $ (2,\ 2) $ の中点 $ (1,\ 2) $ を打つ。 - $ (2,\ 0) $ と $ (2,\ 2) $ の中点 $ (2,\ 1) $ を打つ。 - 以上で $ 10 $ 点 $ (0,\ 0),\ (0,\ 0.5),\ (0,\ 1),\ (0,\ 2),\ (1,\ 0),\ (1,\ 1),\ (1,\ 2),\ (2,\ 0),\ (2,\ 1),\ (2,\ 2) $ が打たれた。そのうち $ 9 $ 点が格子点であるため、$ 9 $ 点を得る。

### Sample Explanation 2

はじめの $ N $ 点の他に格子点を打てないことが証明できます。

## 样例 #1

### 输入

```
4

0 0

0 2

2 0

2 2
```

### 输出

```
9
```

## 样例 #2

### 输入

```
4

0 0

0 3

3 0

3 3
```

### 输出

```
4
```



---


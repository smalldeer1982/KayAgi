---
title: "[ABC382G] Tile Distance 3"
layout: "post"
diff: NOI/NOI+/CTSC
pid: AT_abc382_g
tag: ['分类讨论']
---

# [ABC382G] Tile Distance 3

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc382/tasks/abc382_g

二次元座標平面上にタイルが敷き詰められています。

各タイルの形は長方形であり、$ 0\ \leq\ k\ <\ K $ を満たす各整数組 $ (i,\ j,\ k) $ に対して以下のような規則で対応するタイルが配置されています。

- $ i $ と $ j $ の偶奇が一致しているとき、$ (i,\ j,\ k) $ に対応するタイルは $ iK\ \leq\ x\ \leq\ (i\ +\ 1)K $ かつ $ jK\ +\ k\ \leq\ y\ \leq\ jK\ +\ k\ +\ 1 $ なる範囲の $ (x,\ y) $ を覆う。
- $ i $ と $ j $ の偶奇が一致していないとき、$ (i,\ j,\ k) $ に対応するタイルは $ iK\ +\ k\ \leq\ x\ \leq\ iK\ +\ k\ +\ 1 $ かつ $ jK\ \leq\ y\ \leq\ (j\ +\ 1)K $ なる範囲の $ (x,\ y) $ を覆う。
 
$ 2 $ つのタイルが**隣接**していることを $ 2 $ つのタイルの辺が正の長さの共通部分を持つことにより定義します。

$ (S_x\ +\ 0.5,\ S_y\ +\ 0.5) $ を含むタイルから隣接しているタイルに移動することを繰り返して $ (T_x\ +\ 0.5,\ T_y\ +\ 0.5) $ を含むタイルに移動するとき、隣接するタイルに移動する回数の最小値を求めてください。

$ T $ 個のテストケースが与えられるので、それぞれについて答えを求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ T $ $ \text{case}_1 $ $ \vdots $ $ \text{case}_T $

各ケースは以下の形式で与えられる。

> $ K $ $ S_x $ $ S_y $ $ T_x $ $ T_y $

## 输出格式

$ T $ 行出力せよ。$ i $ 行目には $ i $ 番目のテストケースに対する答えを出力せよ。

## 说明/提示

### 制約

- $ 1\ \leq\ T\ \leq\ 10^4 $
- $ 2\ \leq\ K\ \leq\ 10^{16} $
- $ -10^{16}\ \leq\ S_x,\ S_y,\ T_x,\ T_y\ \leq\ 10^{16} $
- 入力される値はすべて整数
 
### Sample Explanation 1

$ 1 $ 番目のテストケースについて説明します。 整数組 $ (i,\ j,\ k) $ に対応するタイルを単にタイル $ (i,\ j,\ k) $ と表記します。 $ (-1.5,\ 1.5) $ はタイル $ (-1,\ 0,\ 1) $ に含まれ、$ (4.5,\ -0.5) $ はタイル $ (1,\ -1,\ 2) $ に含まれます。 例えば、タイル $ (-1,\ 0,\ 1)\ \to\ (-1,\ 0,\ 2)\ \to\ (0,\ 0,\ 2)\ \to\ (1,\ 0,\ 0)\ \to\ (1,\ -1,\ 2) $ という移動をすることによって、$ 4 $ 回の隣接するタイルへの移動でタイル $ (1,\ -1,\ 2) $ に辿り着くことができます。 !\[\](https://img.atcoder.jp/abc382/89f3686844bfbe1ca95741ff33cd3468.png)

## 样例 #1

### 输入

```
3

3 -2 1 4 -1

4 8 8 0 2

5 -1000000000000 -1000000000000 1000000000000 1000000000000
```

### 输出

```
4

4

800000000000
```



---

---
title: "[AGC037F] Counting of Subarrays"
layout: "post"
diff: NOI/NOI+/CTSC
pid: AT_agc037_f
tag: ['动态规划 DP', '双指针 two-pointer', '均摊分析', '分类讨论']
---

# [AGC037F] Counting of Subarrays

## 题目描述

[problemUrl]: https://atcoder.jp/contests/agc037/tasks/agc037_f

正整数列 $ S $ 及び正整数 $ k,l $ が以下のいずれかの条件をみたすとき、 $ S $ が  **レベル**  $ (k,l) $ に属すると定義することにします。

- $ S $ の要素数が $ 1 $ であり、その要素の値が $ k $ である。
- あるレベル$ (k-1,l) $ に属する数列 $ T_1,T_2,...,T_m $ ($ m\ ≧\ l $) が存在して、 $ T_1,T_2,...,T_m $ をこの順に連結して得られる数列と $ S $ が一致する。

ただし、$ k=1 $ のとき二番目の条件は意味を持たない、つまりレベル$ (1,l) $の正整数列は一つ目の条件をみたすもののみであることに注意して下さい。

正整数列 $ A_1,A_2,...,A_N $ と正整数 $ L $ が与えられます。 以下の条件をみたす部分列 $ A_i,A_{i+1},...,A_j $ ($ 1\ ≦\ i\ ≦\ j\ ≦\ N $) の個数を求めてください。

- ある正整数 $ K $ が存在して、数列 $ A_i,A_{i+1},...,A_j $ がレベル$ (K,L) $に属する。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ L $ $ A_1 $ $ A_2 $ $ ... $ $ A_N $

## 输出格式

条件をみたす部分列の個数を出力せよ。

## 说明/提示

### 制約

- $ 1\ ≦\ N\ ≦\ 2\ \times\ 10^5 $
- $ 2\ ≦\ L\ ≦\ N $
- $ 1\ ≦\ A_i\ ≦\ 10^9 $

### Sample Explanation 1

例えば $ (1,1,1) $ と $ (2) $ という数列はともにレベル $ (2,3) $ に属するので、$ (2,1,1,1,1,1,1) $ という数列はレベル $ (3,3) $ に属します。

## 样例 #1

### 输入

```
9 3

2 1 1 1 1 1 1 2 3
```

### 输出

```
22
```

## 样例 #2

### 输入

```
9 2

2 1 1 1 1 1 1 2 3
```

### 输出

```
41
```

## 样例 #3

### 输入

```
15 3

4 3 2 1 1 1 2 3 2 2 1 1 1 2 2
```

### 输出

```
31
```



---

---
title: "[ARC187E] Replace Triplets"
layout: "post"
diff: NOI/NOI+/CTSC
pid: AT_arc187_e
tag: ['组合数学', '分类讨论']
---

# [ARC187E] Replace Triplets

## 题目描述

给定序列 $A=(A_1,A_2,\cdots,A_N)$，其中 $N\ge 3$。

你可以进行以下操作若干次：
- 选择整数 $i$ 满足 $1\le i\le N$ 且 $A_i=A_{i+1}=A_{i+2}$，将 $A_{i},A_{i+1},A_{i+2}$ 三个数中的两个替换成 $1\sim N$ 的整数。规定 $A_{N+1}=A_1$，$A_{N+2}=A_2$。

求有多少种可能到达的状态，使得恰好是 $1\sim N$ 的排列，答案 $\bmod 998\ 244\ 353$。

## 输入格式

第一行一个整数 $N$。

第二行 $N$ 个整数 $A_1,A_2,\cdots,A_N$。

## 输出格式

一个整数答案。

## 样例 #1

### 输入

```
6
1 2 3 3 1 1
```

### 输出

```
360
```

## 样例 #2

### 输入

```
5
3 1 3 4 1
```

### 输出

```
0
```

## 样例 #3

### 输入

```
10
1 1 1 8 8 8 7 7 7 10
```

### 输出

```
604800
```



---


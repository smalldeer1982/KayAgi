---
title: "[AGC011F] Train Service Planning"
layout: "post"
diff: NOI/NOI+/CTSC
pid: AT_agc011_f
tag: ['线段树', '前缀和', '概率论']
---

# [AGC011F] Train Service Planning

## 题目描述

在高桥王国中有一条铁路，这条铁路分为$n$个区间$1⋯n$和$n+1$个站台$0⋯n$，区间$i$连接站台$i-1$和$i$

一列火车经过区间$i$会消耗$A_i$的时间，每个区间的铁路是双向的或单向的，如果$B_i=1$那么区间$i$是单向的，否则它是双向的

现在すぬけ(snuke)君想要设计一个火车时间表，满足以下约定

所有的火车要么从站台$0$到站台$n$，要么从站台$n$到站台$0$

对任意终点为$n$的火车，如果它在$t$时刻离开站台$i−1$并开往站台$i$，那么它必须在$t+A_i$时刻到达$i$站台，对反方向要求相同

对任意终点为$n$的火车，如果它在$s$时刻到达站台$i$并在$t$时刻离开站台$i$，那么一列经过站台$i$的终点为$n$的火车必须在$s+K$时刻到达站台$i$并在$t+K$时刻离开站台$i$，对反方向要求相同

在任意时刻不能有两列相向而行的火车在单向区间内互相穿过

现在你要找出一个时间表，使得一列火车从$0$到$n$和从$n$到$0$的时间之和最短，观察样例$1$可以帮助你更好地理解题目

## 输入格式

$ N $ $ K $

$ A_1 $ $ B_1 $ 

$ A_2 $ $ B_2 $ 

:

$ A_N $ $ B_N $

## 输出格式

一行一个整数，表示列车上下行最短的开车时间之和，如果不存在合法方案则输出-1

# 数据规模

$1\leq N \leq 100000$

$1\leq K \leq 10^9$

$1\leq A_i \leq 10^9$

$B_i$要么是1要么是2

所有输入的数都是整数

## 样例 #1

### 输入

```
3 10

4 1

3 1

4 1
```

### 输出

```
26
```

## 样例 #2

### 输入

```
1 10

10 1
```

### 输出

```
-1
```

## 样例 #3

### 输入

```
6 4

1 1

1 1

1 1

1 1

1 1

1 1
```

### 输出

```
12
```

## 样例 #4

### 输入

```
20 987654321

129662684 2

162021979 1

458437539 1

319670097 2

202863355 1

112218745 1

348732033 1

323036578 1

382398703 1

55854389 1

283445191 1

151300613 1

693338042 2

191178308 2

386707193 1

204580036 1

335134457 1

122253639 1

824646518 2

902554792 2
```

### 输出

```
14829091348
```



---

---
title: "[AGC036D] Negative Cycle"
layout: "post"
diff: NOI/NOI+/CTSC
pid: AT_agc036_d
tag: ['动态规划 DP', '差分约束', '前缀和']
---

# [AGC036D] Negative Cycle

## 题目描述

[problemUrl]: https://atcoder.jp/contests/agc036/tasks/agc036_d

$ N $ 頂点からなる重み付き有向グラフがあり、頂点には $ 0 $ から $ N-1 $ までの番号がついています。

最初、このグラフには $ N-1 $ 本の辺があります。 このうち $ i $ 番目 ($ 0\ \leq\ i\ \leq\ N-2 $) の辺は、 頂点 $ i $ から頂点 $ i+1 $ へ向かう重さ $ 0 $ の辺です。

すぬけさんはこれから、全ての $ i,j $ ($ 0\ \leq\ i,j\ \leq\ N-1,\ i\ \neq\ j $) について、新たに辺 $ (i\ →\ j) $ を追加する操作を行います。 辺の重さは、$ i\ <\ j $ なら $ -1 $、そうでないなら $ 1 $ とします。

りんごくんは、グラフに負閉路（閉路であって、そこに含まれる辺の重みの総和が $ 0 $ 未満のもの）があるととても悲しいです。 そこで、すぬけさんが追加した辺のうちいくつかを削除して、最終的なグラフに負閉路が含まれないようにすることにしました。 すぬけさんが追加した辺 $ (i\ →\ j) $ を削除するには $ A_{i,j} $ のコストがかかります。 なお、最初からあった $ N-1 $ 本の辺を削除することはできません。

りんごくんが目的を達成するために必要なコストの総和の最小値を求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ A_{0,1} $ $ A_{0,2} $ $ A_{0,3} $ $ \cdots $ $ A_{0,N-1} $ $ A_{1,0} $ $ A_{1,2} $ $ A_{1,3} $ $ \cdots $ $ A_{1,N-1} $ $ A_{2,0} $ $ A_{2,1} $ $ A_{2,3} $ $ \cdots $ $ A_{2,N-1} $ $ \vdots $ $ A_{N-1,0} $ $ A_{N-1,1} $ $ A_{N-1,2} $ $ \cdots $ $ A_{N-1,N-2} $

## 输出格式

りんごくんが目的を達成するために必要なコストの総和の最小値を出力せよ。

## 说明/提示

### 制約

- $ 3\ \leq\ N\ \leq\ 500 $
- $ 1\ \leq\ A_{i,j}\ \leq\ 10^9 $
- 入力される値はすべて整数である。

### Sample Explanation 1

すぬけさんが追加した辺 $ (0\ →\ 1) $ を削除すると、グラフに負閉路がないようになります。 この時必要なコストは $ 2 $ で、これが最小です。

### Sample Explanation 2

すぬけさんが追加した辺 $ (1\ →\ 2) $ と $ (3\ →\ 0) $ を削除すると、グラフに負閉路がないようになります。 この時必要なコストは $ 1+1=2 $ で、これが最小です。

## 样例 #1

### 输入

```
3

2 1

1 4

3 3
```

### 输出

```
2
```

## 样例 #2

### 输入

```
4

1 1 1

1 1 1

1 1 1

1 1 1
```

### 输出

```
2
```

## 样例 #3

### 输入

```
10

190587 2038070 142162180 88207341 215145790 38 2 5 20

32047998 21426 4177178 52 734621629 2596 102224223 5 1864

41 481241221 1518272 51 772 146 8805349 3243297 449

918151 126080576 5186563 46354 6646 491776 5750138 2897 161

3656 7551068 2919714 43035419 495 3408 26 3317 2698

455357 3 12 1857 5459 7870 4123856 2402 258

3 25700 16191 102120 971821039 52375 40449 20548149 16186673

2 16 130300357 18 6574485 29175 179 1693 2681

99 833 131 2 414045824 57357 56 302669472 95

8408 7 1266941 60620177 129747 41382505 38966 187 5151064
```

### 输出

```
2280211
```



---


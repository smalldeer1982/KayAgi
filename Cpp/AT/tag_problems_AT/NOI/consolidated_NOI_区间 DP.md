---
title: "[AGC039E] Pairing Points"
layout: "post"
diff: NOI/NOI+/CTSC
pid: AT_agc039_e
tag: ['动态规划 DP', '记忆化搜索', '区间 DP', '动态规划优化']
---

# [AGC039E] Pairing Points

## 题目描述

[problemUrl]: https://atcoder.jp/contests/agc039/tasks/agc039_e

円周上の一般の位置に相異なる $ 2N $ 個の点が並んでおり、反時計回りに順に $ 1,\dots,2N $ の番号が付けられています。 ただし、ここでいう一般の位置とは、どの相異なる $ 6 $ 点 $ U,\ V,\ W,\ X,\ Y,\ Z $ についても、線分 $ UV,\ WX,\ YZ $ が一点で交わらないことをいいます。 また、 $ 2N\ \times\ 2N $ の行列 $ A $ が与えられます。

円周上の $ 2N $ 個の点を $ N $ 個のペアに分ける方法であって、以下の条件をみたすようなものの個数を求めてください。

- すべてのペアに対してそのペアの $ 2 $ つの点を結ぶ赤い線分をひいたとき、赤い部分が "木" になっている。
- すべてのペアについて、その端点を点 $ P,\ Q $ としたとき、 $ A_{P,Q}\ =\ A_{Q,P}\ =\ 1 $ である。

より厳密には、赤い部分が "木" になっているとは、赤い部分全体が連結かつ無閉路になっていることを指します。

例えば、下図において、

- 左上の例は条件を満たします。
- 右上の例は、赤い部分に閉路が存在し、条件を満たしません。
- 左下の例は、赤い部分が非連結であり、条件を満たしません。
- 右下の例は、ペアに属さない頂点やペアに複数回含まれる頂点が存在し、条件を満たしません。

 ![](https://cdn.luogu.com.cn/upload/vjudge_pic/AT_agc039_e/c0b743c8aac73d041d43810449124e729c319bc8.png)図: 条件を満たす例 (左上) とそうでない例 (それ以外)

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ A_{1,1}...A_{1,2N} $ $ : $ $ A_{2N,1}...A_{2N,2N} $

## 输出格式

円周上の $ 2N $ 個の点を $ N $ 個のペアに分ける方法であって、条件をみたすようなものの個数を出力せよ。 この制約下で、答えが $ 64 $ ビット符号付整数の範囲内に収まることが証明できる。

## 说明/提示

### ノート

答えは、$ 2N $ 個の点が一般の位置にある限り、その具体的な位置関係には依存しないことが証明できます。

### 制約

- $ 1\ \leq\ N\ \leq\ 20 $
- $ A_{i,j} $ は `0` または `1` である
- $ A_{i,i} $ は `0` である
- $ A_{i,j}=A_{j,i} $
- $ N $ は整数である

### Sample Explanation 1

$ ((1,4),(2,6),(3,5)) $, $ ((1,3),(2,5),(4,6)) $, $ ((1,5),(2,4),(3,6)) $ の $ 3 $ つの分け方が条件を満たします。

## 样例 #1

### 输入

```
3

011111

101111

110111

111011

111101

111110
```

### 输出

```
3
```

## 样例 #2

### 输入

```
4

01111100

10011111

10011100

11101111

11110111

11111011

01011101

01011110
```

### 输出

```
6
```

## 样例 #3

### 输入

```
8

0111101111111111

1011101111111111

1101101111011101

1110111111111111

1111011111110111

0001101111111111

1111110111011111

1111111011111111

1111111101111111

1111111110111111

1101110111011111

1111111111101111

1111011111110111

1111111111111011

1101111111111101

1111111111111110
```

### 输出

```
4762
```



---

---
title: "[AGC048D] Pocky Game"
layout: "post"
diff: NOI/NOI+/CTSC
pid: AT_agc048_d
tag: ['动态规划 DP', '博弈论', '区间 DP']
---

# [AGC048D] Pocky Game

## 题目描述

[problemUrl]: https://atcoder.jp/contests/agc048/tasks/agc048_d

$ N $ 個の山が横一列に並んでいます． 左から $ i $ 番目の山には $ A_i $ 個の石があります．

FirstLeft くんと SecondRight くんがゲームをします． FirstLeft くんから始めて，二人は交互に手番をプレイします． それぞれの手番では，以下の操作を行います．

- FirstLeft くんの手番: FirstLeft くんは，石が $ 1 $ 個以上ある山の中で最も**左**にある山から，$ 1 $ 個以上の石を取り除く．
- SecondRight くんの手番: SecondRight くんは，石が $ 1 $ 個以上ある山の中で最も**右**にある山から，$ 1 $ 個以上の石を取り除く．

自分の手番で操作できなくなったプレイヤーの負けです． 二人が最適に行動する時，どちらが勝利するか判定してください．

$ 1 $ つの入力ファイルにつき，$ T $ 個のテストケースを解いてください．

## 输入格式

入力は以下の形式で標準入力から与えられる． 入力の $ 1 $ 行目は以下のとおりである．

> $ T $

そして，$ T $ 個のテストケースが続く． これらはそれぞれ以下の形式で与えられる．

> $ N $ $ A_1 $ $ A_2 $ $ \cdots $ $ A_N $

## 输出格式

各テストケースについて，FirstLeft くんが勝つ場合は `First`，SecondRight くんが勝つ場合は `Second` と出力せよ． 各テストケースごとに改行せよ．

## 说明/提示

### 制約

- $ 1\ \leq\ T\ \leq\ 100 $
- $ 1\ \leq\ N\ \leq\ 100 $
- $ 1\ \leq\ A_i\ \leq\ 10^9 $

### Sample Explanation 1

例えば，$ 3 $ 個目のゲームにおいて，次のようなシナリオが考えられます． - FirstLeft くんが一番左の山から石を $ 2 $ 個とる．山にある石の個数は $ (0,1,2) $ になる． - SecondRight くんが一番右の山から石を $ 1 $ 個とる．山にある石の個数は $ (0,1,1) $ になる． - FirstLeft くんが真ん中の山から石を $ 1 $ 個とる．山にある石の個数は $ (0,0,1) $ になる． - SecondRight くんが一番右の山から石を $ 1 $ 個とる．山にある石の個数は $ (0,0,0) $ になる． - FirstLeft くんは操作を行うことができず，敗北する．

## 样例 #1

### 输入

```
3

1

10

2

3 2

3

2 1 2
```

### 输出

```
First

First

Second
```



---

---
title: "[AGC056B] Range Argmax"
layout: "post"
diff: NOI/NOI+/CTSC
pid: AT_agc056_b
tag: ['区间 DP', 'Ad-hoc']
---

# [AGC056B] Range Argmax

## 题目描述

[problemUrl]: https://atcoder.jp/contests/agc056/tasks/agc056_b

整数 $ N $ と整数の組が $ M $ 個与えられます． $ i $ 番目の組は $ (L_i,R_i) $ です．

以下の手順で生成されうる整数列 $ x=(x_1,x_2,\cdots,x_M) $ の個数を $ 998244353 $ で割った余りを求めて下さい．

- $ (1,2,\cdots,N) $ の順列 $ p=(p_1,p_2,\cdots,p_N) $ を用意する．
- 各 $ i $ ($ 1\ \leq\ i\ \leq\ M $) について，$ p_{L_i},p_{L_i+1},\cdots,p_{R_i} $ の中で最も大きい値の index を $ x_i $ とする． つまり，$ \max(p_{L_i},p_{L_i+1},\cdots,p_{R_i})=p_{x_i} $ である．

## 输入格式

入力は以下の形式で標準入力から与えられる．

> $ N $ $ M $ $ L_1 $ $ R_1 $ $ L_2 $ $ R_2 $ $ \vdots $ $ L_M $ $ R_M $

## 输出格式

答えを出力せよ．

## 说明/提示

### 制約

- $ 2\ \leq\ N\ \leq\ 300 $
- $ 1\ \leq\ M\ \leq\ N(N-1)/2 $
- $ 1\ \leq\ L_i\ <\ R_i\ \leq\ N $
- $ (L_i,R_i)\ \neq\ (L_j,R_j) $ ($ i\ \neq\ j $)
- 入力される値はすべて整数である

### Sample Explanation 1

例えば，$ p=(2,1,3) $ とした場合は $ x=(1,3) $ となります． 条件を満たす数列は，$ x=(1,1),(1,3),(2,2),(2,3) $ の $ 4 $ 通りです．

## 样例 #1

### 输入

```
3 2

1 2

1 3
```

### 输出

```
4
```

## 样例 #2

### 输入

```
6 3

1 2

3 4

5 6
```

### 输出

```
8
```

## 样例 #3

### 输入

```
10 10

8 10

5 8

5 7

2 5

1 7

4 5

5 9

2 8

7 8

3 9
```

### 输出

```
1060
```



---

---
title: "[AGC067B] Modifications"
layout: "post"
diff: NOI/NOI+/CTSC
pid: AT_agc067_b
tag: ['区间 DP']
---

# [AGC067B] Modifications

## 题目描述

[problemUrl]: https://atcoder.jp/contests/agc067/tasks/agc067_b

長さ $ N $ の整数列 $ a=(a_1,a_2,\cdots,a_N) $ があります。 すべての要素ははじめ $ 0 $ です。

整数 $ C $ と $ M $ 個の区間 $ ([L_1,R_1],[L_2,R_2],\cdots,[L_M,R_M]) $ が与えられます。

あなたは、$ (1,2,\cdots,M) $ の順列 $ p $ と長さ $ M $ の整数列 $ w=(w_1,w_2,\cdots,w_M) $ を選びます。 ここで、$ 1\le\ w_i\le\ C $ でなければなりません。

そして、$ M $ 回の変更を行います。 $ i $ 回目の変更は以下です。

- $ a_{L_{p_i}},\ \cdots,\ a_{R_{p_i}} $ を $ w_i $ に変える。

$ a $ の中のすべての位置が少なくとも一つの区間に覆われることが保証されます。

すべての変更後の $ a $ としてありうるものの個数を求め、答えを $ 998244353 $ で割った余りを出力してください。

## 输入格式

入力は標準入力から以下の形式で与えられる。

> $ N $ $ M $ $ C $ $ L_1 $ $ R_1 $ $ L_2 $ $ R_2 $ $ \vdots $ $ L_M $ $ R_M $

## 输出格式

答えを出力せよ。

## 说明/提示

### 制約

- $ 1\le\ N\le\ 100 $
- $ 1\le\ M\le\dfrac{N(N+1)}{2} $
- $ 1\le\ C\ <\ 998244353 $
- $ 1\ \le\ L_i\ \le\ R_i\ \le\ N $
- $ (L_i,R_i)\ \neq\ (L_j,R_j) $ ($ i\ \neq\ j $)
- $ a $ の中のすべての位置は少なくとも一つの区間に覆われる。
- すべての入力値は整数である。

### Sample Explanation 1

ありうる数列は $ 16 $ 個あります。 例えば、$ a=(2,1,1,1,1) $ は以下のようにして得られます。 - $ p=(4,1,2,3,5) $ と $ w=(1,2,1,2,1) $ を選ぶ - $ 1 $ 回目の操作で $ a $ が $ (1,1,1,1,1) $ になる - $ 2 $ 回目の操作で $ a $ が $ (2,2,2,1,1) $ になる - $ 3 $ 回目の操作で $ a $ が $ (2,1,2,1,1) $ になる - $ 4 $ 回目の操作で $ a $ が $ (2,1,2,1,1) $ になる - $ 5 $ 回目の操作で $ a $ が $ (2,1,1,1,1) $ になる

## 样例 #1

### 输入

```
5 5 2
1 3
2 2
3 3
1 5
3 5
```

### 输出

```
16
```

## 样例 #2

### 输入

```
20 30 20
1 14
1 7
1 16
3 13
1 17
4 8
2 11
4 12
9 14
3 15
11 19
1 13
4 15
8 19
3 17
15 18
10 18
1 18
17 19
16 20
1 8
8 15
13 17
1 19
13 19
1 20
6 13
10 12
11 20
17 18
```

### 输出

```
258066445
```



---

---
title: "[ARC153E] Deque Minimization"
layout: "post"
diff: NOI/NOI+/CTSC
pid: AT_arc153_e
tag: ['动态规划 DP', '多项式', '区间 DP', '动态规划优化', '快速数论变换 NTT']
---

# [ARC153E] Deque Minimization

## 题目描述

[problemUrl]: https://atcoder.jp/contests/arc153/tasks/arc153_e

どの桁も $ 0 $ ではないような正整数 $ X $ に対して，次の手順により正整数 $ Y $ を得ることを考えます：

- 文字列 $ S $ を空文字列で初期化する．
- $ X $ の桁数を $ N $ とするとき，$ i\ =\ 1,\ \ldots,\ N $ の順に次を行う：$ X $ の $ 10 $ 進法表記の $ i $ 文字目を，$ S $ の先頭または末尾に挿入する．
- 文字列 $ S $ が表す正整数を $ Y $ とする．
 
この手順により $ X $ から得ることが可能な正整数のうちで，最小のものを $ f(X) $ と書くことにします．

- - - - - -

どの桁も $ 0 $ ではないような正整数 $ Y $ が与えられます．どの桁も $ 0 $ ではないような正整数 $ X $ であって $ f(X)\ =\ Y $ を満たすものの個数を $ 998244353 $ で割った余りを答えてください．

## 输入格式

入力は以下の形式で標準入力から与えられます．

> $ Y $

## 输出格式

どの桁も $ 0 $ ではないような正整数 $ X $ であって $ f(X)\ =\ Y $ を満たすものの個数を $ 998244353 $ で割った余りを出力してください．

## 说明/提示

### 制約

- $ Y $ はどの桁も $ 0 $ ではないような正整数
- $ 1\leq\ Y\ <\ 10^{200000} $
 
### Sample Explanation 1

条件を満たす $ X $ は，$ 1332 $, $ 3132 $, $ 3312 $ の $ 3 $ 個です．

## 样例 #1

### 输入

```
1332
```

### 输出

```
3
```

## 样例 #2

### 输入

```
3312
```

### 输出

```
0
```

## 样例 #3

### 输入

```
12234433442
```

### 输出

```
153
```



---


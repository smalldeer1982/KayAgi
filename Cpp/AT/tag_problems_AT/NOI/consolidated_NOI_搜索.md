---
title: "[AGC039E] Pairing Points"
layout: "post"
diff: NOI/NOI+/CTSC
pid: AT_agc039_e
tag: ['动态规划 DP', '记忆化搜索', '区间 DP', '动态规划优化']
---

# [AGC039E] Pairing Points

## 题目描述

[problemUrl]: https://atcoder.jp/contests/agc039/tasks/agc039_e

円周上の一般の位置に相異なる $ 2N $ 個の点が並んでおり、反時計回りに順に $ 1,\dots,2N $ の番号が付けられています。 ただし、ここでいう一般の位置とは、どの相異なる $ 6 $ 点 $ U,\ V,\ W,\ X,\ Y,\ Z $ についても、線分 $ UV,\ WX,\ YZ $ が一点で交わらないことをいいます。 また、 $ 2N\ \times\ 2N $ の行列 $ A $ が与えられます。

円周上の $ 2N $ 個の点を $ N $ 個のペアに分ける方法であって、以下の条件をみたすようなものの個数を求めてください。

- すべてのペアに対してそのペアの $ 2 $ つの点を結ぶ赤い線分をひいたとき、赤い部分が "木" になっている。
- すべてのペアについて、その端点を点 $ P,\ Q $ としたとき、 $ A_{P,Q}\ =\ A_{Q,P}\ =\ 1 $ である。

より厳密には、赤い部分が "木" になっているとは、赤い部分全体が連結かつ無閉路になっていることを指します。

例えば、下図において、

- 左上の例は条件を満たします。
- 右上の例は、赤い部分に閉路が存在し、条件を満たしません。
- 左下の例は、赤い部分が非連結であり、条件を満たしません。
- 右下の例は、ペアに属さない頂点やペアに複数回含まれる頂点が存在し、条件を満たしません。

 ![](https://cdn.luogu.com.cn/upload/vjudge_pic/AT_agc039_e/c0b743c8aac73d041d43810449124e729c319bc8.png)図: 条件を満たす例 (左上) とそうでない例 (それ以外)

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ A_{1,1}...A_{1,2N} $ $ : $ $ A_{2N,1}...A_{2N,2N} $

## 输出格式

円周上の $ 2N $ 個の点を $ N $ 個のペアに分ける方法であって、条件をみたすようなものの個数を出力せよ。 この制約下で、答えが $ 64 $ ビット符号付整数の範囲内に収まることが証明できる。

## 说明/提示

### ノート

答えは、$ 2N $ 個の点が一般の位置にある限り、その具体的な位置関係には依存しないことが証明できます。

### 制約

- $ 1\ \leq\ N\ \leq\ 20 $
- $ A_{i,j} $ は `0` または `1` である
- $ A_{i,i} $ は `0` である
- $ A_{i,j}=A_{j,i} $
- $ N $ は整数である

### Sample Explanation 1

$ ((1,4),(2,6),(3,5)) $, $ ((1,3),(2,5),(4,6)) $, $ ((1,5),(2,4),(3,6)) $ の $ 3 $ つの分け方が条件を満たします。

## 样例 #1

### 输入

```
3

011111

101111

110111

111011

111101

111110
```

### 输出

```
3
```

## 样例 #2

### 输入

```
4

01111100

10011111

10011100

11101111

11110111

11111011

01011101

01011110
```

### 输出

```
6
```

## 样例 #3

### 输入

```
8

0111101111111111

1011101111111111

1101101111011101

1110111111111111

1111011111110111

0001101111111111

1111110111011111

1111111011111111

1111111101111111

1111111110111111

1101110111011111

1111111111101111

1111011111110111

1111111111111011

1101111111111101

1111111111111110
```

### 输出

```
4762
```



---

---
title: "[AGC062D] Walk Around Neighborhood"
layout: "post"
diff: NOI/NOI+/CTSC
pid: AT_agc062_d
tag: ['动态规划 DP', '背包 DP', '折半搜索 meet in the middle', '标签465']
---

# [AGC062D] Walk Around Neighborhood

## 题目描述

[problemUrl]: https://atcoder.jp/contests/agc062/tasks/agc062_d

二次元平面の原点 $ (0,0) $ にメモ帳を持った高橋君がいます。メモ帳には $ N $ 個の**偶数** $ D_i\ (1\leq\ i\ \leq\ N) $ が書かれています。

これから高橋君は二次元平面上で以下の行動を $ N $ 回行います。

- メモ帳に書かれている偶数を $ 1 $ つ選んで消す。選んだ偶数を $ d $ としたとき、マンハッタン距離でちょうど $ d $ だけ離れた点へ移動する。より正確には、現在高橋君がいる点の座標を $ (x,y) $ としたとき、$ |x-x'|+|y-y'|=d $ を満たす点 $ (x',y') $ へ移動する。
 
$ N $ 回の行動を行った後、高橋君は原点 $ (0,0) $ に戻っていなければなりません。

そのように $ N $ 回の行動を行うことができるか判定してください。可能な場合、$ i $ 回目の行動を終えた後高橋君がいる座標を $ (x_i,y_i) $ としたときの $ \displaystyle\ \max_{1\leq\ i\ \leq\ N}(|x_i|+|y_i|) $ の最小値を求めてください（この値は整数になることが証明できます）。

## 输入格式

入力は以下の形式で標準入力から与えられます。

> $ N $ $ D_1 $ $ D_2 $ $ \dots $ $ D_N $

## 输出格式

上記のように $ N $ 回の行動を行うことが不可能な場合、`-1` を出力してください。可能な場合、$ \displaystyle\ \max_{1\leq\ i\ \leq\ N}(|x_i|+|y_i|) $ の最小値を整数で出力してください。

## 说明/提示

### 制約

- $ 1\ \leq\ N\ \leq\ 2\ \times\ 10^5 $
- $ 2\ \leq\ D_i\ \leq\ 2\ \times\ 10^5 $
- $ D_i\ (1\leq\ i\ \leq\ N) $ は偶数
- 入力される値はすべて整数
 
### Sample Explanation 1

高橋君が $ 1 $ 回目から $ 3 $ 回目の行動でそれぞれ $ 2,6,4 $ をメモ帳から消し、 $ (0,0)\rightarrow\ (0,2)\ \rightarrow\ (-4,0)\ \rightarrow\ (0,0) $ と移動すると $ \displaystyle\ \max_{1\leq\ i\ \leq\ N}(|x_i|+|y_i|) $ は $ 4 $ になり、これが最小です。

### Sample Explanation 2

高橋君が $ 1 $ 回目から $ 5 $ 回目の行動でそれぞれ $ 2,2,6,2,2 $ をメモ帳から消し、 $ (0,0)\rightarrow\ (\frac{1}{2},\frac{3}{2})\rightarrow\ (0,3)\ \rightarrow\ (0,-3)\ \rightarrow\ (-\frac{1}{2},-\frac{3}{2})\ \rightarrow\ (0,0) $ と移動すると $ \displaystyle\ \max_{1\leq\ i\ \leq\ N}(|x_i|+|y_i|) $ は $ 3 $ になり、これが最小です。 高橋君は格子点以外にも移動できます。

### Sample Explanation 3

高橋君は上記のように $ N $ 回行動した後、原点に戻ることはできません。

## 样例 #1

### 输入

```
3

2 4 6
```

### 输出

```
4
```

## 样例 #2

### 输入

```
5

2 2 2 2 6
```

### 输出

```
3
```

## 样例 #3

### 输入

```
2

2 200000
```

### 输出

```
-1
```



---


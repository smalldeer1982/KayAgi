---
title: "[ARC181E] Min and Max at the edge"
layout: "post"
diff: NOI/NOI+/CTSC
pid: AT_arc181_e
tag: ['线段树', '生成树', 'Ad-hoc']
---

# [ARC181E] Min and Max at the edge

## 题目描述

[problemUrl]: https://atcoder.jp/contests/arc181/tasks/arc181_e

各頂点に番号が付いた無向グラフのうち、以下の条件を満たす全域木 $ T $ が取れるグラフを**良いグラフ**といいます。なお、 $ 2 $ 頂点 $ u,v\ (u\ <\ v) $ を結ぶ辺を辺 $ (u,v) $ と表記します。

- グラフのすべての辺 $ (u,v)\ (u\ <\ v) $ に対し、 $ T $ 上で頂点 $ u,v $ を結ぶただ $ 1 $ つの単純パスについて、単純パス上の頂点の番号の最小値、最大値はそれぞれ $ u,v $ である。
 
$ 1 $ から $ N $ までの番号が付いた $ N $ 頂点からなる単純連結無向グラフ $ G $ があります。グラフ $ G $ には辺が $ M $ 本あり、 $ i $ 番目の辺は頂点 $ A_i,B_i\ (A_i\ <\ B_i) $ を結びます。

各 $ i=1,2,\dots,M $ に対し、 $ G $ から $ i $ 番目の辺を取り除いて得られるグラフが**良いグラフ**であるか判定してください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ M $ $ A_1 $ $ B_1 $ $ \vdots $ $ A_M $ $ B_M $

## 输出格式

$ M $ 行出力せよ。$ i $ 行目には $ G $ から $ i $ 番目の辺を取り除いて得られるグラフ**良いグラフ**である場合は `Yes` を、そうでない場合は `No` を出力せよ。

## 说明/提示

### 制約

- $ 2\leq\ N\ \leq\ 2\times\ 10^5 $
- $ N-1\ \leq\ M\ \leq\ 2\ \times\ 10^5 $
- $ 1\ \leq\ A_i\ <\ B_i\ \leq\ N $
- 入力される値はすべて整数
- 与えられるグラフは単純連結無向グラフ
 
### Sample Explanation 1

辺 $ (4,6) $ が削除された場合について、辺 $ (1,3),(2,5),(3,4),(3,5),(5,6) $ からなる全域木を考えてみます。例えば辺 $ (3,6) $ に対し、頂点 $ 3,6 $ を結ぶ単純パスは頂点 $ 3,5,6 $ をこの順にたどるパスであり、単純パス上の頂点の番号の最小値、最大値はそれぞれ $ 3,6 $ であるため条件を満たします。その他の辺についても同じように確認すると、この全域木は条件を満たしていることが分かります。よって答えは `Yes` となります。 一方辺 $ (1,5) $ が削除された場合について、同じ全域木が条件を満たすか考えてみます。辺 $ (4,6) $ に対し、頂点 $ 4,6 $ を結ぶ単純パスは頂点 $ 4,3,5,6 $ をこの順にたどるパスであり、単純パス上の頂点の番号の最小値、最大値はそれぞれ $ 3,6 $ であるため条件を満たしません。その他の全域木についても条件を満たさないことが示せるため、答えは `No` となります。

### Sample Explanation 2

辺の除去によりグラフが連結でなくなることもあります。

## 样例 #1

### 输入

```
6 9

1 3

1 5

2 5

2 6

3 4

3 5

3 6

4 6

5 6
```

### 输出

```
No

No

No

No

Yes

No

No

Yes

Yes
```

## 样例 #2

### 输入

```
5 4

1 2

2 3

3 4

4 5
```

### 输出

```
No

No

No

No
```

## 样例 #3

### 输入

```
15 20

12 13

7 8

5 7

8 10

9 12

4 5

11 12

2 4

6 8

4 14

1 2

14 15

2 9

3 8

2 15

10 11

13 14

8 9

7 14

5 13
```

### 输出

```
No

No

No

Yes

Yes

No

Yes

No

No

No

No

No

No

No

No

Yes

No

No

No

No
```



---

---
title: "Zigzag MST"
layout: "post"
diff: NOI/NOI+/CTSC
pid: AT_codefestival_2016_final_g
tag: ['递推', '生成树']
---

# Zigzag MST

## 题目描述

[problemUrl]: https://atcoder.jp/contests/cf16-final/tasks/codefestival_2016_final_g

$ N $ 個の頂点からなるグラフがあり、頂点には $ 0～N-1 $ の番号が付けられています。辺はまだありません。

辺を追加するクエリを $ Q $ 個処理します。 $ i\ (1≦i≦Q) $ 番目のクエリでは $ A_i,\ B_i,\ C_i $ の $ 3 $ つの整数が与えられるので、以下のように辺を無限本追加します。

- $ A_i $ 番の頂点と $ B_i $ 番の頂点をつなぐ、重み $ C_i $ の無向辺を追加する。
- $ B_i $ 番の頂点と $ A_i+1 $ 番の頂点をつなぐ、重み $ C_i+1 $ の無向辺を追加する。
- $ A_i+1 $ 番の頂点と $ B_i+1 $ 番の頂点をつなぐ、重み $ C_i+2 $ の無向辺を追加する。
- $ B_i+1 $ 番の頂点と $ A_i+2 $ 番の頂点をつなぐ、重み $ C_i+3 $ の無向辺を追加する。
- $ A_i+2 $ 番の頂点と $ B_i+2 $ 番の頂点をつなぐ、重み $ C_i+4 $ の無向辺を追加する。
- $ B_i+2 $ 番の頂点と $ A_i+3 $ 番の頂点をつなぐ、重み $ C_i+5 $ の無向辺を追加する。
- $ A_i+3 $ 番の頂点と $ B_i+3 $ 番の頂点をつなぐ、重み $ C_i+6 $ の無向辺を追加する。
- ...

ただし、頂点番号は mod $ N $ で考えます。 たとえば、$ N $ 番とは $ 0 $ 番のことであり、$ 2N-1 $ 番とは $ N-1 $ 番のことです。

例えば、$ N=16,\ A_i=7,\ B_i=14,\ C_i=1 $ のときは下図のように辺を追加します。（図では最初の $ 7 $ 本のみ）

![](https://cdn.luogu.com.cn/upload/vjudge_pic/AT_codefestival_2016_final_g/21b7df6ea7b04d29d971fb41c7c8a0c5a11c69d3.png)

すべての辺を追加した後のグラフの最小全域木に含まれる辺の重みの和を求めて下さい。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ Q $ $ A_1 $ $ B_1 $ $ C_1 $ $ A_2 $ $ B_2 $ $ C_2 $ : $ A_Q $ $ B_Q $ $ C_Q $

## 输出格式

最小全域木に含まれる辺の重みの和を出力せよ。

## 说明/提示

### 制約

- $ 2≦N≦200,000 $
- $ 1≦Q≦200,000 $
- $ 0≦A_i,B_i≦N-1 $
- $ 1≦C_i≦10^9 $

### Sample Explanation 1

最小全域木は下図のようになります。 !\[\](https://atcoder.jp/img/code-festival-2016-final/f1a6c3cfd52c386e6da5c8c761a78521.png) 多重辺が存在しうることに注意して下さい。

### Sample Explanation 2

自己ループが存在しうることに注意して下さい。

## 样例 #1

### 输入

```
7 1

5 2 1
```

### 输出

```
21
```

## 样例 #2

### 输入

```
2 1

0 0 1000000000
```

### 输出

```
1000000001
```

## 样例 #3

### 输入

```
5 3

0 1 10

0 2 10

0 4 10
```

### 输出

```
42
```



---


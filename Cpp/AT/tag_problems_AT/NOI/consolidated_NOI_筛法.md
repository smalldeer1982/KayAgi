---
title: "[ABC370G] Divisible by 3"
layout: "post"
diff: NOI/NOI+/CTSC
pid: AT_abc370_g
tag: ['数论', '素数判断,质数,筛法']
---

# [ABC370G] Divisible by 3

## 题目描述

称正整数 $x$ 是**好的**，当且仅当 $x$ 的约数之和是 $3$ 的倍数。

给定 $n,m$，求有几个长度为 $m$ 的正整数序列，设其积为 $s$，满足 $s\le n$ 且 $s$ 是**好的**，答案对 $998244353$ 取模。

## 输入格式

一行两个正整数：$n,m$。

## 输出格式

一行一个整数，表示答案。

## 说明/提示

$1\le n\le 10^{10},1\le m\le 10^5$。

by @hxy0629

## 样例 #1

### 输入

```
10 1
```

### 输出

```
5
```

## 样例 #2

### 输入

```
4 2
```

### 输出

```
2
```

## 样例 #3

### 输入

```
370 907
```

### 输出

```
221764640
```

## 样例 #4

### 输入

```
10000000000 100000
```

### 输出

```
447456146
```



---

---
title: "[AGC050E] Three Traffic Lights"
layout: "post"
diff: NOI/NOI+/CTSC
pid: AT_agc050_e
tag: ['数论', '素数判断,质数,筛法', '中国剩余定理 CRT']
---

# [AGC050E] Three Traffic Lights

## 题目描述

[problemUrl]: https://atcoder.jp/contests/agc050/tasks/agc050_e

$ 3 $ 機の信号機があり、$ 1,\ 2,\ 3 $ と番号が振られています。 信号機 $ i $ は、「$ g_i $ 秒間青、$ r_i $ 秒間赤、$ g_i $ 秒間青、$ r_i $ 秒間赤、$ \ldots $」というパターンを永久に繰り返します。

いま、$ 3 $ 機の信号機が一斉に青に変わりました。 続く $ (g_1\ +\ r_1)(g_2\ +\ r_2)(g_3\ +\ r_3) $ 秒間のうち、全ての信号機が青く点灯している時間帯は合計で何秒あるでしょうか。 この答えを $ 998,244,353 $ で割った余りを計算してください。

## 输入格式

入力は標準入力から以下の形式で与えられる。

> $ g_1 $ $ r_1 $ $ g_2 $ $ r_2 $ $ g_3 $ $ r_3 $

## 输出格式

答えを出力せよ。

## 说明/提示

### 制約

- $ 1\ \leq\ g_1,\ r_1,\ g_2,\ r_2,\ g_3,\ r_3\ \leq\ 10^{12} $
- 入力中の全ての値は整数である。

### Sample Explanation 1

続く $ 24 $ 秒間のうち、 - 信号機 $ 1 $ が青く点灯している時間帯は $ [0,\ 1],\ [2,\ 3],\ [4,\ 5],\ [6,\ 7],\ [8,\ 9],\ [10,\ 11],\ [12,\ 13],\ [14,\ 15],\ [16,\ 17],\ [18,\ 19],\ [20,\ 21],\ [22,\ 23] $ です。 - 信号機 $ 2 $ が青く点灯している時間帯は $ [0,\ 2],\ [3,\ 5],\ [6,\ 8],\ [9,\ 11],\ [12,\ 14],\ [15,\ 17],\ [18,\ 20],\ [21,\ 23] $ です。 - 信号機 $ 3 $ が青く点灯している時間帯は $ [0,\ 3],\ [4,\ 7],\ [8,\ 11],\ [12,\ 15],\ [16,\ 19],\ [20,\ 23] $ です。 よって、全ての信号機が青く点灯している時間帯は $ [0,\ 1],\ [4,\ 5],\ [6,\ 7],\ [10,\ 11],\ [12,\ 13],\ [16,\ 17],\ [18,\ 19],\ [22,\ 23] $ であり、合計で $ 8 $ 秒あります。

## 样例 #1

### 输入

```
1 1 2 1 3 1
```

### 输出

```
8
```

## 样例 #2

### 输入

```
7 3 5 7 11 4
```

### 输出

```
420
```

## 样例 #3

### 输入

```
999999999991 999999999992 999999999993 999999999994 999999999995 999999999996
```

### 输出

```
120938286
```



---


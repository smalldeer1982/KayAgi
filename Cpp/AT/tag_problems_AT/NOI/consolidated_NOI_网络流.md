---
title: "[ABC393G] Unevenness"
layout: "post"
diff: NOI/NOI+/CTSC
pid: AT_abc393_g
tag: ['网络流']
---

# [ABC393G] Unevenness

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc393/tasks/abc393_g

给定一个 $ N \times N $ 的网格。从上往下第 $ i $ 行、从左往右第 $ j $ 列的格子记为 $ (i,j) $，其中写有整数 $ A_{i,j} $。  
同时给定两个互质的正整数 $ P $ 和 $ Q $。  
你可以进行任意次数（包括零次）以下操作，但所有操作产生的总成本不得超过 $ \displaystyle \frac{P}{Q} $：

- 选择一个正实数 $ x $，并选择一个格子，将该格子中的数值增加或减少 $ x $。此操作的成本为 $ x $。

所有操作结束后，设 $ (i,j) $ 中的数值为 $ B_{i,j} $。此时定义**不均衡度** $ U $ 为相邻元素差值的绝对值之和。严格来说，$ U $ 由以下公式定义：

 $ \displaystyle U = \sum_{i=1}^N \sum_{j=1}^{N-1} |B_{i,j} - B_{i,j+1}| + \sum_{i=1}^{N-1} \sum_{j=1}^N |B_{i,j} - B_{i+1,j}| $ 

请输出通过操作使 $ U $ 最小化时的 $ U $ 值，并输出此时 $ B_{i,j} $ 的一个可能方案。

## 输入格式

输入通过标准输入给出，格式如下：

> $ N $ $ P $ $ Q $  
> $ A_{1,1} $ $ A_{1,2} $ $ \dots $ $ A_{1,N} $  
> $ A_{2,1} $ $ A_{2,2} $ $ \dots $ $ A_{2,N} $  
> $ \vdots $  
> $ A_{N,1} $ $ A_{N,2} $ $ \dots $ $ A_{N,N} $  

## 输出格式

按以下格式输出 $ U $ 和 $ B_{i,j} $：

> $ U $  
> $ B_{1,1} $ $ B_{1,2} $ $ \dots $ $ B_{1,N} $  
> $ B_{2,1} $ $ B_{2,2} $ $ \dots $ $ B_{2,N} $  
> $ \vdots $  
> $ B_{N,1} $ $ B_{N,2} $ $ \dots $ $ B_{N,N} $  

输出的 $ U $ 和 $ B_{i,j} $ 需满足以下条件才能视为正确（注意 $ U $ 的精度要求严格）：

- $ U $ 的真值与输出值的绝对误差或相对误差不超过 $ 2^{-51} \ (\approx 4.44 \times 10^{-16}) $；
- $ \sum_{i=1}^N \sum_{j=1}^{N-1} |B_{i,j} - B_{i,j+1}| + \sum_{i=1}^{N-1} \sum_{j=1}^N |B_{i,j} - B_{i+1,j}| $ 与 $ U $ 的绝对误差或相对误差不超过 $ 10^{-10} $；
- $ \sum_{i=1}^N \sum_{j=1}^N |A_{i,j} - B_{i,j}| $ 不超过 $ \displaystyle \frac{P}{Q} + \max\left(1, \frac{P}{Q}\right) \times 10^{-10} $。

若存在多个合法答案，输出任意一个均可。

## 说明/提示

### 约束条件

- $ 2 \leq N \leq 10 $
- $ 1 \leq P \leq 10^{12} $
- $ 1 \leq Q \leq 10^{12} $
- $ \gcd(P, Q) = 1 $
- $ 0 \leq A_{i,j} \leq 10 $
- 输入中所有值均为整数

### 样例解释 1

通过以下操作可使 $ U = 24 $，这是不均衡度的最小值。此时总成本为 $ 2 + 1 = 3 $：
- 选择 $ x=2 $，将 $ (1,2) $ 中的数值减少 $ 2 $；
- 选择 $ x=1 $，将 $ (2,1) $ 中的数值增加 $ 1 $。

翻译由 DeepSeek R1 完成

## 样例 #1

### 输入

```
3 3 1

3 6 1

2 4 2

5 7 9
```

### 输出

```
24.0000000000000000000

3.0000000000000000000 4.0000000000000000000 1.0000000000000000000

3.0000000000000000000 4.0000000000000000000 2.0000000000000000000

5.0000000000000000000 7.0000000000000000000 9.0000000000000000000
```

## 样例 #2

### 输入

```
5 3 1

1 1 1 1 1

1 3 3 3 1

1 3 2 3 1

1 3 3 3 1

1 1 1 1 1
```

### 输出

```
20.5714285714285714281

1.0000000000000000000 1.0000000000000000000 1.0000000000000000000 1.0000000000000000000 1.0000000000000000000

1.0000000000000000000 2.7142857142857142857 2.7142857142857142857 2.7142857142857142857 1.0000000000000000000

1.0000000000000000000 2.7142857142857142857 2.7142857142857142857 2.7142857142857142857 1.0000000000000000000

1.0000000000000000000 2.7142857142857142857 2.7142857142857142857 2.7142857142857142857 1.0000000000000000000

1.0000000000000000000 1.0000000000000000000 1.0000000000000000000 1.0000000000000000000 1.0000000000000000000
```

## 样例 #3

### 输入

```
2 393 1

0 0

0 0
```

### 输出

```
0.0000000000000000000

0.0000000000000000000 0.0000000000000000000

0.0000000000000000000 0.0000000000000000000
```

## 样例 #4

### 输入

```
5 36 5

4 8 7 5 4

0 6 8 3 5

3 7 1 4 5

4 7 1 5 6

2 0 2 4 6
```

### 输出

```
71.4000000000000000014

4.0000000000000000000 8.0000000000000000000 7.0000000000000000000 5.0000000000000000000 4.0000000000000000000

2.2285714285714285714 6.0000000000000000000 7.0000000000000000000 4.0000000000000000000 5.0000000000000000000

3.0000000000000000000 7.0000000000000000000 1.7428571428571428571 4.0000000000000000000 5.0000000000000000000

4.0000000000000000000 7.0000000000000000000 1.7428571428571428571 5.0000000000000000000 6.0000000000000000000

2.0000000000000000000 1.4857142857142857144 2.0000000000000000000 4.0000000000000000000 6.0000000000000000000
```

## 样例 #5

### 输入

```
5 160 7

6 3 2 7 9

0 1 5 5 7

7 8 4 7 5

4 0 8 5 6

3 6 1 9 0
```

### 输出

```
65.4285714285714285685

6.0000000000000000000 3.0000000000000000000 3.0000000000000000000 7.0000000000000000000 9.0000000000000000000

1.0000000000000000000 1.0000000000000000000 5.0000000000000000000 5.0000000000000000000 7.0000000000000000000

7.0000000000000000000 7.0000000000000000000 5.0000000000000000000 5.0000000000000000000 5.0000000000000000000

4.0000000000000000000 4.0000000000000000000 5.0000000000000000000 5.0000000000000000000 5.0238095238095238086

3.0000000000000000000 5.0238095238095238086 5.0000000000000000000 5.0952380952380952371 0.0000000000000000000
```

## 样例 #6

### 输入

```
10 193926872645 2752096782

5 0 8 0 0 2 6 5 4 5

5 5 5 9 7 0 3 3 6 5

0 0 0 2 7 2 8 0 5 9

4 8 2 5 8 2 4 9 2 0

8 7 3 2 8 4 7 9 8 4

4 1 0 4 9 3 7 5 8 7

1 6 2 6 5 3 5 4 7 9

7 3 7 6 3 9 3 2 2 5

8 9 3 6 3 0 8 6 4 0

0 0 9 7 6 2 1 9 7 6
```

### 输出

```
346.6045935084415210714

5.0000000000000000000 5.0000000000000000000 5.0943878534377365339 0.0000000000000000000 0.0000000000000000000 2.0000000000000000000 5.0314626178125788449 5.0000000000000000000 5.0000000000000000000 5.0000000000000000000

5.0000000000000000000 5.0000000000000000000 5.0000000000000000000 7.0000000000000000000 7.0000000000000000000 2.0000000000000000000 3.0000000000000000000 3.0000000000000000000 5.0000000000000000000 5.0000000000000000000

0.0000000000000000000 0.0000000000000000000 0.0000000000000000000 2.0000000000000000000 7.0000000000000000000 2.0000000000000000000 4.0000000000000000000 3.0000000000000000000 5.0000000000000000000 5.1258504712503153793

4.0000000000000000000 7.0000000000000000000 2.0000000000000000000 5.0000000000000000000 8.0000000000000000000 2.0000000000000000000 4.0000000000000000000 8.0314626178125788445 2.0000000000000000000 2.0000000000000000000

7.0314626178125788445 7.0000000000000000000 3.0000000000000000000 3.0000000000000000000 8.0000000000000000000 4.0000000000000000000 7.0000000000000000000 8.0314626178125788445 8.0000000000000000000 4.0000000000000000000

4.0000000000000000000 2.0000000000000000000 2.0000000000000000000 4.0000000000000000000 8.0000000000000000000 3.0000000000000000000 7.0000000000000000000 5.0000000000000000000 8.0000000000000000000 7.0000000000000000000

4.0000000000000000000 6.0000000000000000000 2.0000000000000000000 6.0000000000000000000 5.0000000000000000000 3.0000000000000000000 5.0000000000000000000 4.0000000000000000000 7.0000000000000000000 7.0629252356251576894

7.0000000000000000000 6.0000000000000000000 6.0000000000000000000 6.0000000000000000000 3.0000000000000000000 3.0000000000000000000 3.0000000000000000000 3.0000000000000000000 3.0000000000000000000 5.0000000000000000000

8.0000000000000000000 8.0000000000000000000 6.0000000000000000000 6.0000000000000000000 3.0000000000000000000 2.0000000000000000000 6.0000000000000000000 6.0000000000000000000 4.0000000000000000000 4.0000000000000000000

0.0000000000000000000 0.0000000000000000000 7.0629252356251576894 7.0000000000000000000 6.0000000000000000000 2.0000000000000000000 2.0000000000000000000 7.0629252356251576894 7.0000000000000000000 6.0000000000000000000
```



---

---
title: "[AGC038F] Two Permutations"
layout: "post"
diff: NOI/NOI+/CTSC
pid: AT_agc038_f
tag: ['网络流', '二分图', '最小割']
---

# [AGC038F] Two Permutations

## 题目描述

**【题意简述】**

给定两个 $0 \sim (N - 1)$ 的排列 $\{P_0, P_1, \ldots , P_{N - 1}\}$ 和 $\{Q_0, Q_1, \ldots , Q_{N - 1}\}$。

要求构造两个 $0 \sim (N - 1)$ 的排列 $\{A_0, A_1, \ldots , A_{N - 1}\}$ 和 $\{B_0, B_1, \ldots , B_{N - 1}\}$。

且必须满足条件：

- $A_i$ 要么等于 $i$，要么等于 $P_i$。
- $B_i$ 要么等于 $i$，要么等于 $Q_i$。

你需要最大化 $A_i \ne B_i$ 的下标 $i$ 的数量，输出这个最大值。

## 输入格式

第一行一个整数 $N$。  
第二行 $N$ 个整数 $P_0, P_1, \ldots , P_{N - 1}$。  
第三行 $N$ 个整数 $Q_0, Q_1, \ldots , Q_{N - 1}$。

## 输出格式

输出一个整数表示答案。

## 说明/提示

对于 $100\%$ 的数据，$1 \le N \le {10}^5$。

## 样例 #1

### 输入

```
4

2 1 3 0

0 2 3 1
```

### 输出

```
3
```

## 样例 #2

### 输入

```
10

0 4 5 3 7 8 2 1 9 6

3 8 5 6 4 0 2 1 7 9
```

### 输出

```
8
```

## 样例 #3

### 输入

```
32

22 31 30 29 7 17 16 3 14 9 19 11 2 5 10 1 25 18 15 24 20 0 12 21 27 4 26 28 8 6 23 13

22 3 2 7 17 9 16 4 14 8 19 26 28 5 10 1 25 18 15 13 11 0 12 23 21 20 29 24 27 6 30 31
```

### 输出

```
28
```



---

---
title: "[ARC156F] Make Same Set"
layout: "post"
diff: NOI/NOI+/CTSC
pid: AT_arc156_f
tag: ['网络流']
---

# [ARC156F] Make Same Set

## 题目描述

[problemUrl]: https://atcoder.jp/contests/arc156/tasks/arc156_f

長さ $ N $ の整数列 $ A=(A_1,A_2,\dots,A_N),B=(B_1,B_2,\dots,B_N),C=(C_1,C_2,\dots,C_N) $ が与えられます。

整数からなる集合のうち、以下の条件を満たすものを $ 1 $ つ求めてください。

- 空集合に対し $ i=1,2,\dots,N $ の順に $ A_i,B_i $ のいずれかを追加していくことで得られる集合である。
- 空集合に対し $ i=1,2,\dots,N $ の順に $ A_i,C_i $ のいずれかを追加していくことで得られる集合である。
- 上記の $ 2 $ つの条件を満たす集合の中で、要素数が最大である。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ A_1 $ $ A_2 $ $ \dots $ $ A_N $ $ B_1 $ $ B_2 $ $ \dots $ $ B_N $ $ C_1 $ $ C_2 $ $ \dots $ $ C_N $

## 输出格式

条件を満たす整数集合の要素数 $ k $ と、整数集合の $ k $ 個の要素 $ x_i\ (1\leq\ i\ \leq\ k) $ を以下の形式で出力せよ。

> $ k $ $ x_1 $ $ x_2 $ $ \dots $ $ x_k $

条件を満たす整数集合が複数存在する場合、いずれを出力してもかまわない。

## 说明/提示

### 制約

- $ 1\ \leq\ N\ \leq\ 5000 $
- $ 1\ \leq\ A_i,B_i,C_i\ \leq\ 10000 $
- 入力される値はすべて整数
 
### Sample Explanation 1

集合 $ \lbrace\ 1,2,4\rbrace $ は - $ 1 $ 番目の条件について、空集合に $ B_1,A_2,B_3 $ を追加することで得られます。 - $ 2 $ 番目の条件について、空集合に $ A_1,C_2,C_3 $ を追加することで得られます。 条件を満たす集合の要素数は明らかに $ N=3 $ 以下であるため、この集合は $ 3 $ 番目の条件も満たしています。

## 样例 #1

### 输入

```
3

1 1 1

2 3 4

5 4 2
```

### 输出

```
3

4 1 2
```

## 样例 #2

### 输入

```
15

1 1 15 11 13 7 7 1 6 1 5 7 4 9 8

11 30 1 18 16 15 19 17 3 27 22 7 21 29 9

24 14 23 17 18 16 9 12 10 5 26 29 20 19 11
```

### 输出

```
12

7 9 11 17 19 1 15 4 5 6 29 13
```



---

---
title: "[ARC161F] Everywhere is Sparser than Whole (Judge)"
layout: "post"
diff: NOI/NOI+/CTSC
pid: AT_arc161_f
tag: ['网络流', '最小割']
---

# [ARC161F] Everywhere is Sparser than Whole (Judge)

## 题目描述

[problemUrl]: https://atcoder.jp/contests/arc161/tasks/arc161_f

頂点集合が空でない単純無向グラフの**密度**を $ \displaystyle\frac{(辺数)}{(頂点数)} $ と定義します．

正整数 $ N,\ D $ と，$ N $ 頂点 $ DN $ 辺の単純無向グラフ $ G $ が与えられます． $ G $ の頂点には $ 1 $ から $ N $ までの番号が付いており，$ i $ 番目の辺は頂点 $ A_i $ と頂点 $ B_i $ を結んでいます． $ G $ が以下の条件を満たしているかどうかを判定してください．

**条件:** $ G $ の頂点集合を $ V $ とする． $ V $ の任意の空でない**真**部分集合 $ X $ に対して，$ X $ による $ G $ の誘導部分グラフの密度は $ D $ **未満**である．

$ T $ 個のテストケースが与えられるので，それぞれについて答えてください．

 誘導部分グラフとは

 グラフ $ G $ の頂点部分集合 $ X $ に対して，$ X $ による $ G $ の**誘導部分グラフ**とは，「頂点集合が $ X $ であり，辺集合が『 $ G $ の辺であって $ X $ 内の $ 2 $ 頂点を結ぶもの全体』であるグラフ」を指します． 上記の条件では，頂点部分集合として空集合でも全体でもないもののみを考えていることに注意してください．

## 输入格式

入力は以下の形式で標準入力から与えられる．

> $ T $ $ \mathrm{case}_1 $ $ \mathrm{case}_2 $ $ \vdots $ $ \mathrm{case}_T $

各テストケース $ \mathrm{case}_i\ (1\ \leq\ i\ \leq\ T) $ は以下の形式である．

> $ N $ $ D $ $ A_1 $ $ B_1 $ $ A_2 $ $ B_2 $ $ \vdots $ $ A_{DN} $ $ B_{DN} $

## 输出格式

$ T $ 行出力せよ． $ i $ 行目には，$ i $ 番目のテストケースについて，与えられたグラフ $ G $ が条件を満たすなら `Yes` を，満たさないなら `No` を出力せよ．

## 说明/提示

### 制約

- $ T\ \geq\ 1 $
- $ N\ \geq\ 1 $
- $ D\ \geq\ 1 $
- $ 1 $ つの入力に含まれるテストケースについて，$ DN $ の総和は $ 5\ \times\ 10^4 $ 以下である．
- $ 1\ \leq\ A_i\ <\ B_i\ \leq\ N\ (1\ \leq\ i\ \leq\ DN) $
- $ (A_i,\ B_i)\ \neq\ (A_j,\ B_j)\ (1\ \leq\ i\ <\ j\ \leq\ DN) $
 
### Sample Explanation 1

\- $ 1 $ つ目のテストケースは\[問題 D\](./arc161\_d) の出力例 1 と同じであり，条件を満たします． - $ 2 $ つ目のテストケースについて，頂点集合 $ \{1,\ 2,\ 3,\ 4\} $ の空でない真部分集合 $ \{1,\ 2,\ 3\} $ による誘導部分グラフの辺集合は $ \{(1,\ 2),\ (1,\ 3),\ (2,\ 3)\} $ であり，その密度は $ \displaystyle\frac{3}{3}\ =\ 1\ =\ D $ です． したがって，このグラフは条件を満たしません．

## 样例 #1

### 输入

```
2

3 1

1 2

1 3

2 3

4 1

1 2

1 3

2 3

3 4
```

### 输出

```
Yes

No
```



---


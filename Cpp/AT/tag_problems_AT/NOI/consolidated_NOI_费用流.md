---
title: "[ABC363G] Dynamic Scheduling"
layout: "post"
diff: NOI/NOI+/CTSC
pid: AT_abc363_g
tag: ['贪心', '线段树', '模拟费用流']
---

# [ABC363G] Dynamic Scheduling

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc363/tasks/abc363_g

長さ $ N $ の数列 $ D=(D_1,\ D_2,\ \dots,\ D_N),\ P=(P_1,\ P_2,\ \dots,\ P_N) $ が与えられます。

$ Q $ 個のクエリを与えられる順に処理してください。クエリは以下の形式で与えられます。

- `c x y` : $ D_c $ を $ x $ に、$ P_c $ を $ y $ に変更する。そして、次の問題を解いて答えを出力する。
 
> $ 1 $ から $ N $ までの番号がついた $ N $ 個の仕事があります。  
>  あなたは今日 (これを $ 1 $ 日目とする) から $ 1 $ 日あたり $ 1 $ 個の仕事を選んで終わらせることを $ N $ 日間行います。  
>  仕事 $ i $ は $ D_i $ 日目までに終わらせると $ P_i $ の報酬を貰えます。($ D_i $ 日目までに終わらせなかった場合は何も無い)  
>  仕事をやる順番を上手く選んだ時の報酬の総和の最大値を求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。ここで $ \mathrm{query}_i $ は $ i $ 番目のクエリを意味する。

> $ N $ $ Q $ $ D_1 $ $ D_2 $ $ \dots $ $ D_N $ $ P_1 $ $ P_2 $ $ \dots $ $ P_N $ $ \mathrm{query}_1 $ $ \mathrm{query}_2 $ $ \vdots $ $ \mathrm{query}_Q $

各クエリは以下の形式で与えられる。

> $ c $ $ x $ $ y $

## 输出格式

$ Q $ 行出力せよ。$ i $ 行目には $ i $ 番目のクエリの答えを出力せよ。

## 说明/提示

### 制約

- $ 1\ \leq\ N\ \leq\ 10^5 $
- $ 1\ \leq\ Q\ \leq\ 10^5 $
- $ 1\ \leq\ D_i\ \leq\ N $
- $ 1\ \leq\ P_i\ \leq\ 10^9 $
- $ 1\ \leq\ c\ \leq\ N $
- $ 1\ \leq\ x\ \leq\ N $
- $ 1\ \leq\ y\ \leq\ 10^9 $
- 入力される値は全て整数
 
### Sample Explanation 1

$ 1 $ 番目のクエリは次のようになります。 - $ D_3 $ を $ 1 $ に、$ P_3 $ を $ 4 $ に更新する。$ D\ =\ (1,\ 2,\ 1),\ P\ =\ (3,\ 6,\ 4) $ になる。 - 小問題では、$ 1 $ 日目に仕事 $ 3 $ を、$ 2 $ 日目に仕事 $ 2 $ を、$ 3 $ 日目に仕事 $ 1 $ を行うという手順が最適な手順の $ 1 $ つで、この時の報酬の総和は $ 10 $ であるから、これを出力する。 $ 2 $ 番目のクエリは次のようになります。 - $ D_2 $ を $ 3 $ に、$ P_2 $ を $ 9 $ に更新する。$ D\ =\ (1,\ 3,\ 1),\ P\ =\ (3,\ 9,\ 4) $ になる。 - 小問題では、$ 1 $ 日目に仕事 $ 3 $ を、$ 2 $ 日目に仕事 $ 1 $ を、$ 3 $ 日目に仕事 $ 2 $ を行うという手順が最適な手順の $ 1 $ つで、この時の報酬の総和は $ 13 $ であるから、これを出力する。

## 样例 #1

### 输入

```
3 2

1 2 3

3 6 3

3 1 4

2 3 9
```

### 输出

```
10

13
```

## 样例 #2

### 输入

```
5 1

1 2 3 4 5

1000000000 1000000000 1000000000 1000000000 1000000000

1 1 1000000000
```

### 输出

```
5000000000
```

## 样例 #3

### 输入

```
10 10

6 2 4 1 5 1 6 6 5 3

45 65 71 52 86 52 48 60 40 98

5 6 5

8 4 34

6 7 83

1 3 21

7 5 85

7 4 51

8 2 81

2 7 54

6 1 5

8 6 30
```

### 输出

```
394

379

462

457

459

414

443

479

401

396
```



---

---
title: "[AGC031E] Snuke the Phantom Thief"
layout: "post"
diff: NOI/NOI+/CTSC
pid: AT_agc031_e
tag: ['费用流']
---

# [AGC031E] Snuke the Phantom Thief

## 题目描述

[problemUrl]: https://atcoder.jp/contests/agc031/tasks/agc031_e

とある博物館には宝石 $ 1,\ 2,\ ...,\ N $ が展示されています。 宝石 $ i $ の置いてある場所は $ (x_i,\ y_i) $ で、価値は $ v_i $ です (この博物館は二次元平面として解釈できます)。

怪盗すぬけはいくつか宝石を盗みます。

宝石の盗み方には条件 $ 1,\ 2,\ ...,\ M $ があり、すべて満たさないと探偵に捕まってしまいます。 条件はそれぞれ以下の4種類のいずれかです。

- ($ t_i $ =`L`, $ a_i $, $ b_i $) : 盗んだ宝石のうち、$ x $ 座標が $ a_i $ 以下の宝石が $ b_i $ 個以下
- ($ t_i $ =`R`, $ a_i $, $ b_i $) : 盗んだ宝石のうち、$ x $ 座標が $ a_i $ 以上の宝石が $ b_i $ 個以下
- ($ t_i $ =`D`, $ a_i $, $ b_i $) : 盗んだ宝石のうち、$ y $ 座標が $ a_i $ 以下の宝石が $ b_i $ 個以下
- ($ t_i $ =`U`, $ a_i $, $ b_i $) : 盗んだ宝石のうち、$ y $ 座標が $ a_i $ 以上の宝石が $ b_i $ 個以下

怪盗すぬけが盗める宝石の価値の総和の最大値を求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ x_1 $ $ y_1 $ $ v_1 $ $ x_2 $ $ y_2 $ $ v_2 $ $ : $ $ x_N $ $ y_N $ $ v_N $ $ M $ $ t_1 $ $ a_1 $ $ b_1 $ $ t_2 $ $ a_2 $ $ b_2 $ $ : $ $ t_M $ $ a_M $ $ b_M $

## 输出格式

怪盗すぬけが盗める宝石の価値の総和の最大値を出力せよ。

## 说明/提示

### 制約

- $ 1\ \leq\ N\ \leq\ 80 $
- $ 1\ \leq\ x_i,\ y_i\ \leq\ 100 $
- $ 1\ \leq\ v_i\ \leq\ 10^{15} $
- $ 1\ \leq\ M\ \leq\ 320 $
- $ t_i $ は `L`, `R`, `U`, `D` のいずれか
- $ 1\ \leq\ a_i\ \leq\ 100 $
- $ 0\ \leq\ b_i\ \leq\ N\ -\ 1 $
- $ (x_i,\ y_i) $ は互いに相違なる
- $ (t_i,\ a_i) $ は互いに相違なる
- $ (t_i,\ b_i) $ は互いに相違なる

### Sample Explanation 1

!\[図\](https://img.atcoder.jp/agc031/rghe0iwfjoievjw4epdfmengow.png) 宝石 $ 1,\ 5,\ 6,\ 7 $ を盗むと価値の総和が $ 36 $ となります。

## 样例 #1

### 输入

```
7

1 3 6

1 5 9

3 1 8

4 3 8

6 2 9

5 4 11

5 7 10

4

L 3 1

R 2 3

D 5 3

U 4 2
```

### 输出

```
36
```

## 样例 #2

### 输入

```
3

1 2 3

4 5 6

7 8 9

1

L 100 0
```

### 输出

```
0
```

## 样例 #3

### 输入

```
4

1 1 10

1 2 11

2 1 12

2 2 13

3

L 8 3

L 9 2

L 10 1
```

### 输出

```
13
```

## 样例 #4

### 输入

```
10

66 47 71040136000

65 77 74799603000

80 53 91192869000

24 34 24931901000

91 78 49867703000

68 71 46108236000

46 73 74799603000

56 63 93122668000

32 51 71030136000

51 26 70912345000

21

L 51 1

L 7 0

U 47 4

R 92 0

R 91 1

D 53 2

R 65 3

D 13 0

U 63 3

L 68 3

D 47 1

L 91 5

R 32 4

L 66 2

L 80 4

D 77 4

U 73 1

D 78 5

U 26 5

R 80 2

R 24 5
```

### 输出

```
305223377000
```



---

---
title: "[AGC043F] Jewelry Box"
layout: "post"
diff: NOI/NOI+/CTSC
pid: AT_agc043_f
tag: ['费用流', '凸包']
---

# [AGC043F] Jewelry Box

## 题目描述

[problemUrl]: https://atcoder.jp/contests/agc043/tasks/agc043_f

$ 1 $ から $ N $ までの番号のついた $ N $ 軒の宝石店があります．

宝石店 $ i $ ($ 1\ \leq\ i\ \leq\ N $) では，$ K_i $ 種類の宝石が売られています． このうち，$ j $ ($ 1\ \leq\ j\ \leq\ K_i $) 種類目の宝石は，大きさが $ S_{i,j} $，値段が $ P_{i,j} $ で，在庫が $ C_{i,j} $ 個あります．

**よい** 宝石箱とは，以下の条件をすべて満たす宝石箱です．

- 宝石箱の中には，各宝石店で買った宝石が $ 1 $ 個ずつ入っている．
- 次の $ M $ 個の条件をすべて満たす．
  - $ i $ ($ 1\ \leq\ i\ \leq\ M $) 番目の条件: $ ( $宝石店 $ V_i $ で買った宝石の大きさ$ )\leq\ ( $宝石店 $ U_i $ で買った宝石の大きさ$ )+W_i $

次の $ Q $ 個の質問に答えてください． $ i $ ($ 1\ \leq\ i\ \leq\ Q $) 番目の質問では，整数 $ A_i $ が与えられるので，$ A_i $ 個のよい宝石箱を準備するとき，買う宝石の値段の合計の最小値を求めてください． ただし，$ A_i $ 個のよい宝石箱が準備できない場合はその旨を答えてください．

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ 宝石店$ \ 1\ $の情報 宝石店$ \ 2\ $の情報 $ \vdots $ 宝石店$ \ N\ $の情報 $ M $ $ U_1 $ $ V_1 $ $ W_1 $ $ U_2 $ $ V_2 $ $ W_2 $ $ \vdots $ $ U_M $ $ V_M $ $ W_M $ $ Q $ $ A_1 $ $ A_2 $ $ \vdots $ $ A_Q $

宝石店 $ i $ ($ 1\ \leq\ i\ \leq\ N $) の情報は，以下の形式で与えられる．

> $ K_i $ $ S_{i,1} $ $ P_{i,1} $ $ C_{i,1} $ $ S_{i,2} $ $ P_{i,2} $ $ C_{i,2} $ $ \vdots $ $ S_{i,K_i} $ $ P_{i,K_i} $ $ C_{i,K_i} $

## 输出格式

$ Q $ 行出力せよ． そのうち $ i $ 行目には，$ A_i $ 個のよい宝石箱を準備するときに買う宝石の値段の合計の最小値を出力せよ． ただし，$ A_i $ 個のよい宝石箱を準備することが不可能な場合は，$ -1 $ を出力せよ．

## 说明/提示

### 制約

- $ 1\ \leq\ N\ \leq\ 30 $
- $ 1\ \leq\ K_i\ \leq\ 30 $
- $ 1\ \leq\ S_{i,j}\ \leq\ 10^9 $
- $ 1\ \leq\ P_{i,j}\ \leq\ 30 $
- $ 1\ \leq\ C_{i,j}\ \leq\ 10^{12} $
- $ 0\ \leq\ M\ \leq\ 50 $
- $ 1\ \leq\ U_i,V_i\ \leq\ N $
- $ U_i\ \neq\ V_i $
- $ 0\ \leq\ W_i\ \leq\ 10^9 $
- $ 1\ \leq\ Q\ \leq\ 10^5 $
- $ 1\ \leq\ A_i\ \leq\ 3\ \times\ 10^{13} $
- 入力は全て整数である．

### Sample Explanation 1

宝石店 $ i $ で売られている $ j $ 種類目の宝石を宝石 $ (i,j) $ で表すことにします． 各クエリの答えは，以下のようになります． - $ A_1=1 $: 宝石 $ (1,2),(2,2),(3,1) $ を使う宝石箱を準備すると，コストが $ 1+1+1=3 $ となり，最小． - $ A_2=2 $: 宝石 $ (1,1),(2,1),(3,1) $ を使う宝石箱と，宝石 $ (1,2),(2,3),(3,2) $ を使う宝石箱を準備すると， コストが $ (10+10+1)+(1+10+10)=42 $ となり，最小． - $ A_3=3 $: $ 3 $ つの良い宝石箱を準備することはできない．

## 样例 #1

### 输入

```
3

2

1 10 1

3 1 1

3

1 10 1

2 1 1

3 10 1

2

1 1 1

3 10 1

2

1 2 0

2 3 0

3

1

2

3
```

### 输出

```
3

42

-1
```

## 样例 #2

### 输入

```
5

5

86849520 30 272477201869

968023357 28 539131386006

478355090 8 194500792721

298572419 6 894877901270

203794105 25 594579473837

5

730211794 22 225797976416

842538552 9 420531931830

871332982 26 81253086754

553846923 29 89734736118

731788040 13 241088716205

5

903534485 22 140045153776

187101906 8 145639722124

513502442 9 227445343895

499446330 6 719254728400

564106748 20 333423097859

5

332809289 8 640911722470

969492694 21 937931959818

207959501 11 217019915462

726936503 12 382527525674

887971218 17 552919286358

5

444983655 13 487875689585

855863581 6 625608576077

885012925 10 105520979776

980933856 1 711474069172

653022356 19 977887412815

10

1 2 231274893

2 3 829836076

3 4 745221482

4 5 935448462

5 1 819308546

3 5 815839350

5 3 513188748

3 1 968283437

2 3 202352515

4 3 292999238

10

510266667947

252899314976

510266667948

374155726828

628866122125

628866122123

1

628866122124

510266667949

30000000000000
```

### 输出

```
26533866733244

13150764378752

26533866733296

19456097795056

-1

33175436167096

52

33175436167152

26533866733352

-1
```



---

---
title: "[ARC168F] Up-Down Queries"
layout: "post"
diff: NOI/NOI+/CTSC
pid: AT_arc168_f
tag: ['模拟费用流']
---

# [ARC168F] Up-Down Queries

## 题目描述

[problemUrl]: https://atcoder.jp/contests/arc168/tasks/arc168_f

各要素が $ 0 $ 以上 $ M $ 以下で長さが $ N $ の整数列 $ x=(x_1,x_2,\cdots,x_N) $ に対し，$ f(x) $ を次のように定義します．

- 長さ $ M $ の整数列 $ y=(y_1,y_2,\cdots,y_M) $ を用意する． 最初，$ y $ の要素はすべて $ 0 $ にする． その後，各 $ i=1,2,\cdots,N $ に対しこの順に以下の操作を行う．
  - 各整数 $ j $ ($ 1\ \leq\ j\ \leq\ x_i $) に対し，$ y_j $ の値を $ \max(y_j-1,0) $ で置き換える．
  - 各整数 $ j $ ($ x_i\ <\ j\ \leq\ M $) に対し，$ y_j $ の値を $ y_j+1 $ で置き換える．
- すべての操作が終わった時点での $ y $ の要素の総和を $ f(x) $ の値とする．

各要素が $ 0 $ 以上 $ M $ 以下で長さが $ N $ の整数列 $ A=(A_1,A_2,\cdots,A_N) $ が与えられます． $ Q $ 個のクエリを処理してください．

- $ i $ 番目のクエリ: 整数 $ X_i,Y_i $ が与えられるので，$ A_{X_i} $ の値を $ Y_i $ で置き換える． その後，$ f(A) $ の値を出力する．

## 输入格式

入力は以下の形式で標準入力から与えられる．

> $ N $ $ M $ $ Q $ $ A_1 $ $ A_2 $ $ \cdots $ $ A_N $ $ X_1 $ $ Y_1 $ $ X_2 $ $ Y_2 $ $ \vdots $ $ X_Q $ $ Y_Q $

## 输出格式

答えを出力せよ．

## 说明/提示

### 制約

- $ 1\ \leq\ N,M,Q\ \leq\ 250000 $
- $ 0\ \leq\ A_i\ \leq\ M $
- $ 1\ \leq\ X_i\ \leq\ N $
- $ 0\ \leq\ Y_i\ \leq\ M $
- 入力される値はすべて整数．

### Sample Explanation 1

まず $ 1 $ 番目のクエリを考えます． $ A_1 $ の値を $ 4 $ で置き換え，$ A=(4,2,3) $ になります． そして，$ f(A) $ の値は次のように求まります． - $ y=(0,0,0,0) $ を用意する． - $ A_1=4 $ について操作を行い，$ y=(0,0,0,0) $ になる． - $ A_2=2 $ について操作を行い，$ y=(0,0,1,1) $ になる． - $ A_3=3 $ について操作を行い，$ y=(0,0,0,2) $ になる． - $ y $ の要素の総和 $ =2 $ が $ f(A) $ の値となる． 次に $ 2 $ 番目のクエリを考えます． $ A_3 $ の値を $ 0 $ で置き換え，$ A=(4,2,0) $ になります． そして，$ f(A) $ の値は次のように求まります． - $ y=(0,0,0,0) $ を用意する． - $ A_1=4 $ について操作を行い，$ y=(0,0,0,0) $ になる． - $ A_2=2 $ について操作を行い，$ y=(0,0,1,1) $ になる． - $ A_3=0 $ について操作を行い，$ y=(1,1,2,2) $ になる． - $ y $ の要素の総和 $ =6 $ が $ f(A) $ の値となる．

## 样例 #1

### 输入

```
3 4 2
1 2 3
1 4
3 0
```

### 输出

```
2
6
```

## 样例 #2

### 输入

```
7 2 9
2 0 2 2 0 1 0
1 1
3 0
4 0
4 1
6 1
3 2
2 0
3 2
2 0
```

### 输出

```
4
7
11
9
9
6
6
6
6
```

## 样例 #3

### 输入

```
20 200000 10
39664 143179 193565 153887 16141 91985 51452 155409 116777 190060 87620 64458 106481 51272 9108 100995 139248 18243 181424 6182
4 196305
13 59753
8 96194
6 57037
19 125781
16 142779
15 13967
10 17772
16 84763
12 17283
```

### 输出

```
1145670
1234421
1352851
1352851
1464137
1380569
1380569
1608611
1724643
1736769
```



---

---
title: "玉座の間"
layout: "post"
diff: NOI/NOI+/CTSC
pid: AT_geocon2013_b
tag: ['费用流']
---

# 玉座の間

## 题目描述

[problemUrl]: https://atcoder.jp/contests/geocon2013/tasks/geocon2013_b

 あなたは、両親から引き継いだ、川と緑に囲まれた小さいながらも豊かな王国の統治者です。  
 王位を引き継ぐにあたって玉座の間の改装を行うことにしました。  
 とても几帳面なあなたは家具が左右対称になっていないと気がすみません。  
 しかし、家具をあちこち移動させていると改装費がかさんでしまいます。  
 あなたは家具を左右対称になるように動かす時の、家具の移動距離の合計を最小化することにしました。

 家具は2次元上の点として考えます。家具には種類がなく、区別しません。  
 左右対称な状態とは、y軸について反転させた時に同じ状態になることです。  
 例えば、(-1,0),(0,0),(1,0)に家具がある状態は、反転させると(-1,0),(0,0),(1,0)となり、同じ状態なので左右対称です。  
 しかし、(-1,0),(1,0),(1,0)に家具がある状態は、反転させると(-1,0),(-1,0),(1,0)となり、違う状態なので左右対称ではありません。  
 家具はどのような経路でも動かせて、家具同士が重なってもかまいません。

 入力は以下の形式で標準入力から与えられる。 > $ N $ $ X1\ Y1 $ $ X2\ Y2 $ $ ... $ $ XN\ YN $

- 1行目には家具の数を表す整数 $ N $ が与えられる。
- 2行目からN+1行目には家具の座標を表す整数 $ Xi\ Yi\ (1\ ≦\ i\ ≦\ N\ ,\ -1000\ ≦\ Xi,Yi\ ≦\ 1000) $ が空白区切りで与えられる。
- 与えられる家具の座標はすべて異なる。すなわち、$ i\ ≠\ j $ ならば $ (Xi,Yi)\ ≠\ (Xj,Yj) $ を満たす。
 
 左右対称にするのに必要な家具の移動距離の合計の最小値を出力すること。  
 小数点以下何桁でも出力してよく、絶対誤差・相対誤差の少なくとも片方が10-6以下であれば正答と見なされる。 この問題は(1)〜(4)の部分点に分かれていて、それぞれ以下の条件を満たします。

- (1) 50点 : $ N\ =\ 1 $
- (2) 50点 : $ 1\ ≦\ N\ ≦\ 10 $
- (3) 50点 : $ 1\ ≦\ N\ ≦\ 20 $
- (4) 50点 : $ 1\ ≦\ N\ ≦\ 100 $
 
```

1
1 0
```

 ```

1.0000000
```

 ```

3
-1 0
0 0
1 0
```

 ```

0.0000000
```

すでに左右対称なので家具を移動させる必要はありません。

 ```

2
2 2
-2 1
```

 ```

1.0000000
```

例えば、家具を(2,1.5),(-2,1.5)に移動させると移動距離の合計は1になります。

 ```

8
2 2
7 1
9 -4
-10 1
-6 -9
-6 10
8 8
2 -4
```

 ```

15.6593790
```



---


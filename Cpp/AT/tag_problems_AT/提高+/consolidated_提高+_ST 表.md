---
title: "[ABC388G] Simultaneous Kagamimochi 2"
layout: "post"
diff: 提高+/省选-
pid: AT_abc388_g
tag: ['二分', 'ST 表']
---

# [ABC388G] Simultaneous Kagamimochi 2

## 题目描述

有 $N$ 个饼从小到大依次排列。第 $i$ 个饼（$1 \leq i \leq N$）的大小为 $A_i$。

对于两个饼 $A$ 和 $B$，其大小分别为 $a$ 和 $b$，当且仅当 $a$ 不超过 $b$ 的一半时，可以将饼 $A$ 放在饼 $B$ 上，形成一个镜饼。

给定 $Q$ 个整数对。第 $i$ 个整数对为 $(L_i, R_i)$，请对每个 $i$ 解决以下问题：

> 仅使用第 $L_i$ 到第 $R_i$ 个饼（共 $R_i - L_i + 1$ 个饼），最多可以同时制作多少个镜饼？
>
> 更严格地说，求最大的非负整数 $K$，使得：
>
> - 从第 $L_i$ 到第 $R_i$ 个饼中选出 $2K$ 个饼，将其分成 $K$ 对，每对中一个饼放在另一个饼上，形成 $K$ 个镜饼。

## 输入格式

输入通过标准输入给出，格式如下：

> $N$  
> $A_1$ $A_2$ $\dots$ $A_N$  
> $Q$  
> $L_1$ $R_1$  
> $L_2$ $R_2$  
> $\vdots$  
> $L_Q$ $R_Q$

## 输出格式

输出 $Q$ 行。第 $i$ 行（$1 \leq i \leq Q$）输出第 $i$ 个整数对对应问题的答案。

## 说明/提示

- $2 \leq N \leq 2 \times 10^5$
- $1 \leq A_i \leq 10^9$（$1 \leq i \leq N$）
- $A_i \leq A_{i+1}$（$1 \leq i < N$）
- $1 \leq Q \leq 2 \times 10^5$
- $1 \leq L_i < R_i \leq N$（$1 \leq i \leq Q$）
- 输入均为整数

### 样例解释 1

每个问题的答案如下所示。镜饼的制作方式为示例：

- 饼的大小为 $(1,2,3,4)$。可以制作 $(1,3)$ 和 $(2,4)$ 两个镜饼。
- 饼的大小为 $(2,3,4,4,7,10)$。可以制作 $(2,4)$、$(3,7)$ 和 $(4,10)$ 三个镜饼。
- 饼的大小为 $(7,10,11,12,20)$。可以制作 $(10,20)$ 一个镜饼。
- 饼的大小为 $(1,1)$。无法制作任何镜饼。
- 饼的大小为 $(1,1,2,3,4,4,7,10,11,12,20)$。可以制作 $(1,2)$、$(1,3)$、$(4,10)$、$(4,11)$ 和 $(7,20)$ 五个镜饼。

因此，请按顺序输出 `2`、`3`、`1`、`0`、`5`。

## 样例 #1

### 输入

```
11

1 1 2 3 4 4 7 10 11 12 20

5

2 5

3 8

7 11

1 2

1 11
```

### 输出

```
2

3

1

0

5
```

## 样例 #2

### 输入

```
24

127 148 170 174 258 311 331 414 416 436 517 523 532 587 591 638 660 748 760 776 837 857 972 984

15

7 11

8 9

8 13

12 15

9 23

1 17

8 12

1 5

6 17

3 7

12 19

13 18

7 22

1 12

14 15
```

### 输出

```
0

0

0

0

2

6

0

1

1

0

0

0

3

5

0
```



---

---
title: "[ARC189D] Takahashi is Slime"
layout: "post"
diff: 提高+/省选-
pid: AT_arc189_d
tag: ['贪心', 'ST 表', '笛卡尔树']
---

# [ARC189D] Takahashi is Slime

## 题目描述

有 $N$ 个史莱姆排成一列，从左到右依次编号为 $1, 2, \ldots, N$。第 $i$ 个史莱姆的大小为 $A_i$。  
对于每一个位置 $K = 1, 2, \ldots, N$，解决下面的问题：

> 初始时，第 $K$ 个史莱姆是高桥君。高桥君可以执行任意多次（可以是 $0$ 次）的操作。请计算高桥君在操作后能达到的最大大小。
>
> - 高桥君可以吸收一个相邻且大小小于他的史莱姆。吸收后，该史莱姆消失，高桥君的大小增加该史莱姆的大小。
>
> 在这个过程中，被吸收的史莱姆消失后空出的位置会立即由两侧的史莱姆填补，这使得两端的史莱姆重新相邻（请参考样例 1）。

## 输入格式

从标准输入读取以下格式的数据：

> $N$ $A_1$ $A_2$ $\ldots$ $A_N$

## 输出格式

对于每个 $K = 1, 2, \ldots, N$，输出问题的答案 $B_K$，各答案以空格分隔：

> $B_1$ $B_2$ $\ldots$ $B_N$

## 说明/提示

- $2 \leq N \leq 5 \times 10^5$
- $1 \leq A_i \leq 10^9$
- 所有输入都是整数

### 样例解释

以 $K = 4$ 为例。我们用方括号 `[]` 标识高桥君，称其为**列状态**。初始状态下的列为 $(4, 13, 2, [3], 2, 6)$。以下是高桥君的操作步骤：
1. 高桥君吸收右邻的史莱姆，大小变为 $3 + 2 = 5$，列状态变为 $(4, 13, 2, [5], 6)$。
2. 高桥君吸收左邻的史莱姆，大小变为 $5 + 2 = 7$，列状态变为 $(4, 13, [7], 6)$。
3. 高桥君吸收右邻的史莱姆，大小变为 $7 + 6 = 13$，列状态变为 $(4, 13, [13])$。

最终，高桥君再也无法吸收任何比他小的邻居，所以他的最大可能大小是 $13$。

 **本翻译由 AI 自动生成**

## 样例 #1

### 输入

```
6

4 13 2 3 2 6
```

### 输出

```
4 30 2 13 2 13
```

## 样例 #2

### 输入

```
12

22 25 61 10 21 37 2 14 5 8 6 24
```

### 输出

```
22 47 235 10 31 235 2 235 5 235 6 235
```



---


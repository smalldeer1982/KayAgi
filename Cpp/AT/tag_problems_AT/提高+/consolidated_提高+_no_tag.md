---
title: "[ABC008D] 金塊ゲーム"
layout: "post"
diff: 提高+/省选-
pid: AT_abc008_4
tag: []
---

# [ABC008D] 金塊ゲーム

## 题目描述

高桥君正在玩一个基于无限二维网格的游戏。网格坐标系以 $(0, 0)$ 为原点，向东为 $x$ 轴正方向，向北为 $y$ 轴正方向。坐标为 $(x, y)$ 的格子表示从原点向东移动 $x$ 格（若 $x$ 为负则向西移动 $-x$ 格），向北移动 $y$ 格（若 $y$ 为负则向南移动 $-y$ 格）的位置。

网格中存在 $W \times H$ 个金块，分布在所有满足 $1 \leq p \leq W$ 且 $1 \leq q \leq H$ 的格子 $(p, q)$ 上。其中有恰好 $N$ 个格子设有金块回收装置（编号 $1$ 至 $N$）。装置满足以下条件：
- 任意两个装置所在的格子 $(a, b)$ 和 $(c, d)$ 都满足 $a \neq c$ 且 $b \neq d$
- 每个装置所在的格子互不相同

当装置启动时，首先回收所在格子的金块，然后向东南西北四个方向延伸机械臂进行扩展回收。机械臂的延伸需满足以下规则：
- **东向**：选择整数 $p > x+1$，使得区间 $(x+1, y)$ 到 $(p-1, y)$ 的格子均有金块，且 $(p, y)$ 无金块。回收该区间所有金块。
- **西向**：选择整数 $p < x-1$，使得区间 $(p+1, y)$ 到 $(x-1, y)$ 的格子均有金块，且 $(p, y)$ 无金块。回收该区间所有金块。
- **南向**：选择整数 $q < y-1$，使得区间 $(x, q+1)$ 到 $(x, y-1)$ 的格子均有金块，且 $(x, q)$ 无金块。回收该区间所有金块。
- **北向**：选择整数 $q > y+1$，使得区间 $(x, y+1)$ 到 $(x, q-1)$ 的格子均有金块，且 $(x, q)$ 无金块。回收该区间所有金块。

对于每个方向，若不存在满足条件的 $p$ 或 $q$，则无法在该方向延伸机械臂。此外，若某个方向存在可回收的金块，则必须执行回收操作。下图展示了满足条件的回收示例（图中以 `M` 表示装置，粗框表示可回收范围）。

![](http://abc008.contest.atcoder.jp/img/abc/008/4-1.png)

高桥君需要决定所有装置的启动顺序，不同的顺序可能导致最终回收数量不同。由于高桥君希望最大化金块回收量，请编写程序计算可能获得的最大金块数量。

## 输入格式

输入通过标准输入给出：
> $W$ $H$  
> $N$  
> $X_1$ $Y_1$  
> $X_2$ $Y_2$  
> ...  
> $X_N$ $Y_N$

- 第 1 行：两个整数 $W$ ($1 \leq W \leq 10^6$) 和 $H$ ($1 \leq H \leq 10^6$)
- 第 2 行：整数 $N$ ($1 \leq N \leq 30$)
- 后续 $N$ 行：每行两个整数 $X_i$ ($1 \leq X_i \leq W$) 和 $Y_i$ ($1 \leq Y_i \leq H$)，表示第 $i$ 个装置的位置

保证所有装置的位置满足 $X_i \neq X_j$ 且 $Y_i \neq Y_j$（$i \neq j$）

## 输出格式

输出可回收金块的最大数量（末尾换行）

## 说明/提示

### 部分分
- 数据集 1 ($N \leq 8$, $W,H \leq 80$)：80 分
- 数据集 2 ($W,H \leq 80$)：合计 99 分
- 数据集 3 (无限制)：合计 100 分

### 样例解释 1
输入样例 1 的初始状态如下图所示（图片链接保留）：

![](http://abc008.contest.atcoder.jp/img/abc/008/4-2.png)

按照 1 号、2 号、3 号装置的顺序启动，可以回收 19 个金块，操作过程如下图所示：

![](http://abc008.contest.atcoder.jp/img/abc/008/4-3.png)

### 样例解释 2
存在可回收全部金块的启动顺序

翻译由 DeepSeek R1 完成

## 样例 #1

### 输入

```
6 4

3

2 4

3 1

4 3
```

### 输出

```
19
```

## 样例 #2

### 输入

```
3 3

3

1 1

2 3

3 2
```

### 输出

```
9
```

## 样例 #3

### 输入

```
15 10

8

7 10

12 8

4 4

5 7

9 9

1 6

6 5

3 2
```

### 输出

```
112
```



---

---
title: "[ABC009D] 漸化式"
layout: "post"
diff: 提高+/省选-
pid: AT_abc009_4
tag: []
---

# [ABC009D] 漸化式

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc009/tasks/abc009_4

数列 $ A $ はすべての要素が $ 32 $ ビットの符号なし整数で表現でき、その値は次のようにして決まる。

- はじめの $ K $ 項 $ A_1,\,A_2,\,...,\,A_K $ は入力で与えられる。
- $ A $ とは別に $ K $ 項の数列 $ C_1,\,C_2,\,...,\,C_K $ （こちらもすべての要素が $ 32 $ ビットの符号なし整数におさまる）が入力で与えられ、$ K+1 $ 項目以降の $ A $ の値はこの $ C $ を用いて次のように計算される。 
  - $ N\ ≧\ 1 $ に対し $ A_{N+K}\ =\ (C_1\, $AND$ \,A_{N+K-1})\, $XOR$ \,(C_2\, $AND$ \,A_{N+K-2})\, $XOR$ \,...\, $ XOR$ \,(C_K\, $AND$ \,A_N) $
  - ただし AND はビットごとの論理積、 XOR はビットごとの排他的論理和を表す。

この数列 $ A $ の $ M $ 番目の値 $ A_M $ を求めるプログラムを作成せよ。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ K $ $ M $ $ A_1 $ $ A_2 $ $ ... $ $ A_K $ $ C_1 $ $ C_2 $ $ ... $ $ C_K $

- $ 1 $ 行目には、はじめに決まっている項の数を表す整数 $ K $ ($ 1\ ≦\ K\ ≦\ 100 $) および数列の求める項の番号を表す整数 $ M $ ($ 1\ ≦\ M\ ≦\ 10^9 $) が与えられる。
- $ 2 $ 行目には、数列 $ A $ の最初の $ K $ 項が順に与えられる。$ A $ の値はすべて $ 32 $ ビット符号なし整数におさまる。
- $ 3 $ 行目には、数列 $ A $ の $ K+1 $ 項目以降を計算するときに使う数列 $ C $ の要素が順に与えられる。$ C $ の値はすべて $ 32 $ ビット符号なし整数におさまる。

## 输出格式

$ A_M $ の値を $ 1 $ 行に出力せよ。

出力の末尾にも改行をいれること。

## 说明/提示

### Sample Explanation 1

実際に $ A $ の値を計算していくと次のようになる。 - $ A_4\ =\ (7\, $AND$ \,30)\, $XOR$ \,(19\, $AND$ \,20)\, $XOR$ \,(13\, $AND$ \,10)\ =\ 30 $ - $ A_5\ =\ (7\, $AND$ \,30)\, $XOR$ \,(19\, $AND$ \,30)\, $XOR$ \,(13\, $AND$ \,20)\ =\ 16 $

## 样例 #1

### 输入

```
3 5

10 20 30

7 19 13
```

### 输出

```
16
```

## 样例 #2

### 输入

```
5 100

2345678901 1001001001 3333333333 3141592653 1234567890

2147483648 2147483647 4294967295 4294967294 3434343434
```

### 输出

```
1067078691
```

## 样例 #3

### 输入

```
30 999999999

11627 5078 8394 6412 10346 3086 3933 668 9879 11739 4501 6108 12336 8771 2768 2438 2153 7047 5476 313 1264 369 12070 10743 10663 747 370 4671 5235 3439

114 3613 3271 5032 11241 6961 3628 150 12191 2396 7638 3046 11594 8162 11136 786 9878 2356 11660 1070 3649 10882 9746 1415 3307 7077 9319 9981 3437 544
```

### 输出

```
2148
```



---

---
title: "[ABC010D] 浮気予防"
layout: "post"
diff: 提高+/省选-
pid: AT_abc010_4
tag: []
---

# [ABC010D] 浮気予防

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc010/tasks/abc010_4

高橋君の秘書のなぎさちゃんは、高橋君が大好きです。今日も、高橋君に悪い虫が取り憑かないように、高橋君を監視しなければなりません。

高橋君は、女の子と仲良くなるために、自前のSNSを使います。SNSで友人関係にある人を辿って行き、見つけた女の子にメッセージを送ります。 なぎさちゃんは、高橋君のメッセージを女の子が見ることがないように、このSNSに対して、工作を行うことにしました。

行える工作活動は、以下の $ 2 $つです。

- 特定の二人の友人関係を解消する
- 特定の一人のパスワードを変え、ログイン出来なくする 高橋君のパスワードは変更できません。(21:11追記)

友人関係が解消されると、高橋君は、その二人の間を辿ることが出来なくなります。しかし、他の友人を経由して、辿ることが可能な場合は、その限りではありません。

パスワードを変更すると、その人は、メッセージを見ることが不可能になります。友人関係に変化はないので、パスワードを変更された人を辿って、別の友人を探すのは可能です。

なぎさちゃんは、出来るだけ工作の回数を少なくして、予めマークした女の子達が、高橋君のメッセージを閲覧できないようにしたいです。なぎさちゃんが工作を行う必要のある回数を求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ G $ $ E $ $ p_1 $ $ p_2 $ ... $ p_G $ $ a_1 $ $ b_1 $ $ a_2 $ $ b_2 $ : $ a_E $ $ b_E $

- $ 1 $ 行目には、SNSの登録人数を表す整数 $ N\ (1\ ≦\ N\ ≦\ 100) $ と、なぎさちゃんがマークしている女の子の数 $ G\ (0\ ≦\ G\ ≦\ N\ -\ 1) $、 SNSの友人関係の数を表す整数 $ E\ (0\ ≦\ E\ ≦\ N\ ×\ (N-1)\ /\ 2) $がスペース区切りで与えられる。
- $ 2 $ 行目では、なぎさちゃんがマークしている $ i $ 番目の女の子のIDを表す整数 $ p_i\ (1\ ≦\ p_i\ ≦\ N\ -\ 1) $ の値が、スペース区切りで $ G $ 個与えられる。
- $ 3 $ 行目から $ E $ 行では、友人関係に関する情報が与えられる。このうち $ i $ 行目では $ i $ 番目の友人関係における、二人のID番号を表す $ 2 $ つの整数 $ a_i\ (0\ ≦\ a_i\ ≦\ N\ -\ 1) $ $ b_i\ (0\ ≦\ b_i\ ≦\ N\ -\ 1) $ の値が、スペース区切りで与えられる。
- $ i\ ≠\ j $ のとき、$ a_i\ =\ a_j $ かつ $ b_i\ =\ b_j $、または $ a_i\ =\ b_j $ かつ $ b_i\ =\ a_j $ になることはないことが保障されている。
- 全ての入力において、高橋君のIDは $ 0 $ であることが保障されている。

## 输出格式

なぎさちゃんが工作を行う必要のある回数の最小値を、 $ 1 $ 行で出力せよ。出力の末尾には改行をいれること。

## 说明/提示

### 部分点

$ 0\ ≦\ E\ ≦\ 12 $ を満たすテストケースに正解した場合、部分点として $ 99 $ 点が与えられる。

### Sample Explanation 1

!\[\](/img/abc/010/pic1.png) 図のように、 $ 1 $ つの友人関係を解消するだけで、$ 2 $ 人の女の子を高橋君から切り離すことが出来ます。

### Sample Explanation 2

!\[\](/img/abc/010/pic2.png) マークしている女の子は一人だけなので、この人をログイン出来なくするだけで、目的を達成することができます。

### Sample Explanation 3

!\[\](/img/abc/010/pic3.png) 図のように工作を行うことで、全ての女の子に対して工作を行えます。

### Sample Explanation 4

IDが $ 3 $ の人をログイン出来ないようにしても、高橋君が友達を探すのに影響がないことに注意してください。

### Sample Explanation 5

高橋君には友達がいないため、工作を行う必要はありません。

## 样例 #1

### 输入

```
4 2 3

2 3

0 1

1 2

1 3
```

### 输出

```
1
```

## 样例 #2

### 输入

```
4 1 4

3

0 1

0 2

1 3

2 3
```

### 输出

```
1
```

## 样例 #3

### 输入

```
10 3 11

7 8 9

0 1

0 2

0 3

0 4

1 5

2 5

5 6

6 7

6 8

3 9

4 9
```

### 输出

```
2
```

## 样例 #4

### 输入

```
6 2 6

4 5

0 1

0 2

1 3

2 3

3 4

3 5
```

### 输出

```
2
```

## 样例 #5

### 输入

```
4 3 3

1 2 3

1 2

1 3

2 3
```

### 输出

```
0
```



---

---
title: "[ABC017D] サプリメント"
layout: "post"
diff: 提高+/省选-
pid: AT_abc017_4
tag: []
---

# [ABC017D] サプリメント

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc017/tasks/abc017_4

健康志向の高橋君は通販で購入したサプリメントを摂取することにした。

サプリメントは $ N $ 個あり、$ 1 $ から $ N $ まで番号が付けられている。

また、サプリメントの味は $ M $ 種類あり、$ 1 $ から $ M $ まで番号が付けられている。サプリメント $ i\ (1\ ≦\ i\ ≦\ N) $ の味は $ f_i\ (1\ ≦\ f_i\ ≦\ M) $ である。

高橋君はサプリメントを番号順に複数日かけて摂取する予定である。高橋君はサボらないように、サプリメントが $ 1 $ つ以上残っている場合はその日中に必ず $ 1 $ つ以上サプリメントを摂取しなければならないという規則を定めた。

高橋君は強靭な肉体を持っているため、$ 1 $ 日にどれだけサプリメントを摂取しても大丈夫だが、同じ味には飽きてしまうので、同じ日に同じ味のサプリメントを $ 2 $ つ以上摂取することはできない。

高橋君は、サプリメントの摂取方法の是非について吟味するため、このような条件下で全部で何通りの摂取方法があるかを知りたい。

ここで $ 2 $ つの摂取方法についてそれらが違うというのは、ある日について摂取したサプリメントの番号の組み合わせが異なることを定義する。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ M $ $ f_1 $ $ f_2 $ : $ f_N $

- $ 1 $ 行目には、$ 2 $ つの整数 $ N\ (1\ ≦\ N\ ≦\ 100,000) $ と $ M\ (1\ ≦\ M\ ≦\ 100,000) $ が空白区切りで書かれている。これはサプリメントが $ N $ 個あり、味の種類が $ M $ 種類あることを表す。
- $ 2 $ 行目から $ N $ 行には、サプリメントの味に関する情報が与えられる。これら $ N $ 行のうち上から $ i\ (1\ ≦\ i\ ≦\ N) $ 行目には整数 $ f_i\ (1\ ≦\ f_i\ ≦\ M) $ が書かれている。これは、サプリメント $ i $ の味が $ f_i $ であることを表す。

## 输出格式

摂取方法の総数を $ 1,000,000,007\ (=\ 1000000007) $ で割ったあまりを $ 1 $ 行に出力せよ。出力の末尾にも改行を入れること。

## 说明/提示

### 部分点

この問題には部分点が設定されている。

- $ N\ ≦\ 5,000 $ かつ $ M\ ≦\ 5,000 $ を満たすデータセット $ 1 $ に正解した場合は、上記とは別に $ 30 $ 点が与えられる。
- 追加制約のないデータセット $ 2 $ に正解した場合は、上記とは別に $ 70 $ 点が与えられる。

### Sample Explanation 1

以下の $ 5 $ 通りが考えられます。 $ 1 $ 日目 $ 2 $ 日目 $ 3 $ 日目 $ 4 $ 日目 $ 5 $ 日目 サプリメント $ 1 $ サプリメント $ 2 $ サプリメント $ 3 $ サプリメント $ 4 $ サプリメント $ 5 $ サプリメント $ 1 $ サプリメント $ 2 $ サプリメント $ 3,4 $ サプリメント $ 5 $ なし サプリメント $ 1 $ サプリメント $ 2,3 $ サプリメント $ 4 $ サプリメント $ 5 $ なし サプリメント $ 1,2 $ サプリメント $ 3 $ サプリメント $ 4 $ サプリメント $ 5 $ なし サプリメント $ 1,2 $ サプリメント $ 3,4 $ サプリメント $ 5 $ なし なし

### Sample Explanation 2

どのように食べても飽きません。

## 样例 #1

### 输入

```
5 2

1

2

1

2

2
```

### 输出

```
5
```

## 样例 #2

### 输入

```
6 6

1

2

3

4

5

6
```

### 输出

```
32
```



---

---
title: "[ABC024D] 動的計画法"
layout: "post"
diff: 提高+/省选-
pid: AT_abc024_d
tag: []
---

# [ABC024D] 動的計画法

## 题目描述

高桥君使用了一张很大的方格纸，纸上共划分横纵各 $10^8$ 个小格子，他要完成一个挑战：

「从最左下角开始，每次只能向右或向上移动一格，计算到达每个小格子的方法总数，并将结果对 $1,000,000,007$ 取余。」

高桥君喜欢动态规划方法，因此很快意识到可以通过下面的算法来解决：

1. 在最左边的一整列和最下边的一整行的所有格子中填上数字 $1$。
2. 对于其他未填数字的格子，如果该格子的左边和下边的格子都已经填了数字，则将这两个格子里的数字相加，并将结果对 $1,000,000,007$ 取余后填入当前格子。
3. 重复步骤 2，直到所有格子都填上数字。

通过这个方法，高桥君在方格纸上完成了「从左下角到达每个格子的路径数，对 $1,000,000,007$ 取余」的计算。

然而，在完成后，由于过于兴奋，他不小心撕掉了一部分方格纸。现在他手中只剩下包含某个格子及其上方和右方这些格子的方格纸碎片。他想将碎片放回原位，但因为方格纸太大，所以找不到正确的位置。

根据碎片上的信息，请帮高桥君找出这块碎片原来在方格纸中的具体位置。

给定的是某个初始位置 $(r, c)$ 以及其相邻的两个位置 $(r, c+1)$ 和 $(r+1, c)$ 中的整数 $A$、$B$ 和 $C$，请找出 $r$ 和 $c$ 的值。

注意，最左下角的格子位置是用 $(0, 0)$ 表示。

## 输入格式

输入为以下格式，通过标准输入给出：

> $ A $ $ B $ $ C $

- 第一行给出了 $(r, c)$ 位置的整数 $A$，满足 $0 \leq A < 1,000,000,007$。
- 第二行给出了 $(r, c+1)$ 位置的整数 $B$，满足 $0 \leq B < 1,000,000,007$。
- 第三行给出了 $(r+1, c)$ 位置的整数 $C$，满足 $0 \leq C < 1,000,000,007$。
- 给定的 $A$、$B$ 和 $C$ 一定能找到满足 $0 \leq r, c < 99,999,999$ 的解。

## 输出格式

输出两个整数 $r$ 和 $c$，用空格隔开，表示碎片原来所在的行和列。若有多个可能的解，请输出 $r$ 最小的组合；若仍有多种可能，则输出其中 $c$ 最小的。输出末尾应包含一个换行。

## 说明/提示

### 样例解释

高桥君手里的碎片如下：

![](/img/abc/024/quweiroewqor/C_2.png)

该碎片可能源自下图所示位置：

![](/img/abc/024/quweiroewqor/C_3.png)

 **本翻译由 AI 自动生成**

## 样例 #1

### 输入

```
15

35

21
```

### 输出

```
4 2
```

## 样例 #2

### 输入

```
126

252

210
```

### 输出

```
5 4
```

## 样例 #3

### 输入

```
144949225

545897619

393065978
```

### 输出

```
314159 365358
```



---

---
title: "[ABC025D] 25個の整数"
layout: "post"
diff: 提高+/省选-
pid: AT_abc025_d
tag: []
---

# [ABC025D] 25個の整数

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc025/tasks/abc025_d

高橋君は縦 $ 5 $ マス、横 $ 5 $ マスの盤面に $ 1 $ から $ 25 $ までの整数を $ 1 $ つずつ書き込もうとしています。

高橋君は以下の条件をすべて満たすように整数を配置しようと考えています。

- 整数は各マスに $ 1 $ つずつ割り当てる。
- 縦または横に連続する $ 3 $ つの整数をどのように取り出しても、それらは昇順または降順になっていない。すなわち、上から $ i\ (1\ ≦\ i\ ≦\ 5) $ 番目、左から $ j\ (1\ ≦\ j\ ≦\ 5) $ 番目のマスに書かれた整数を $ n_{i,j} $ としたとき、以下の $ 2 $ 条件が成立する。
- $ n_{i,j}\ ＜\ n_{i+1,j}\ ＜\ n_{i+2,j} $ あるいは $ n_{i,j}\ ＞\ n_{i+1,j}\ ＞\ n_{i+2,j} $ を満たす整数組 $ (i,j)\ (1\ ≦\ i\ ≦\ 3,\ 1\ ≦\ j\ ≦\ 5) $ が存在しない。
- $ n_{i,j}\ ＜\ n_{i,j+1}\ ＜\ n_{i,j+2} $ あるいは $ n_{i,j}\ ＞\ n_{i,j+1}\ ＞\ n_{i,j+2} $ を満たす整数組 $ (i,j)\ (1\ ≦\ i\ ≦\ 5,\ 1\ ≦\ j\ ≦\ 3) $ が存在しない。


すでにいくつかのマスについては、どの整数を書き込むかは決まっています。あなたの課題は、上記の条件を満たすような残りの整数の配置の総数を計算することです。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ x_{1,1} $ $ x_{1,2} $ $ x_{1,3} $ $ x_{1,4} $ $ x_{1,5} $ $ x_{2,1} $ $ x_{2,2} $ $ x_{2,3} $ $ x_{2,4} $ $ x_{2,5} $ $ x_{3,1} $ $ x_{3,2} $ $ x_{3,3} $ $ x_{3,4} $ $ x_{3,5} $ $ x_{4,1} $ $ x_{4,2} $ $ x_{4,3} $ $ x_{4,4} $ $ x_{4,5} $ $ x_{5,1} $ $ x_{5,2} $ $ x_{5,3} $ $ x_{5,4} $ $ x_{5,5} $

- $ 1 $ 行目には、$ 5 $ つの整数 $ x_{1,1}\ (0\ ≦\ x_{1,1}\ ≦\ 25) $ と $ x_{1,2}\ (0\ ≦\ x_{1,2}\ ≦\ 25) $ と $ x_{1,3}\ (0\ ≦\ x_{1,3}\ ≦\ 25) $ と $ x_{1,4}\ (0\ ≦\ x_{1,4}\ ≦\ 25) $ と $ x_{1,5}\ (0\ ≦\ x_{1,5}\ ≦\ 25) $ が空白区切りで書かれている。
- $ 2 $ 行目には、$ 5 $ つの整数 $ x_{2,1}\ (0\ ≦\ x_{2,1}\ ≦\ 25) $ と $ x_{2,2}\ (0\ ≦\ x_{2,2}\ ≦\ 25) $ と $ x_{2,3}\ (0\ ≦\ x_{2,3}\ ≦\ 25) $ と $ x_{2,4}\ (0\ ≦\ x_{2,4}\ ≦\ 25) $ と $ x_{2,5}\ (0\ ≦\ x_{2,5}\ ≦\ 25) $ が空白区切りで書かれている。
- $ 3 $ 行目には、$ 5 $ つの整数 $ x_{3,1}\ (0\ ≦\ x_{3,1}\ ≦\ 25) $ と $ x_{3,2}\ (0\ ≦\ x_{3,2}\ ≦\ 25) $ と $ x_{3,3}\ (0\ ≦\ x_{3,3}\ ≦\ 25) $ と $ x_{3,4}\ (0\ ≦\ x_{3,4}\ ≦\ 25) $ と $ x_{3,5}\ (0\ ≦\ x_{3,5}\ ≦\ 25) $ が空白区切りで書かれている。
- $ 4 $ 行目には、$ 5 $ つの整数 $ x_{4,1}\ (0\ ≦\ x_{4,1}\ ≦\ 25) $ と $ x_{4,2}\ (0\ ≦\ x_{4,2}\ ≦\ 25) $ と $ x_{4,3}\ (0\ ≦\ x_{4,3}\ ≦\ 25) $ と $ x_{4,4}\ (0\ ≦\ x_{4,4}\ ≦\ 25) $ と $ x_{4,5}\ (0\ ≦\ x_{4,5}\ ≦\ 25) $ が空白区切りで書かれている。
- $ 5 $ 行目には、$ 5 $ つの整数 $ x_{5,1}\ (0\ ≦\ x_{5,1}\ ≦\ 25) $ と $ x_{5,2}\ (0\ ≦\ x_{5,2}\ ≦\ 25) $ と $ x_{5,3}\ (0\ ≦\ x_{5,3}\ ≦\ 25) $ と $ x_{5,4}\ (0\ ≦\ x_{5,4}\ ≦\ 25) $ と $ x_{5,5}\ (0\ ≦\ x_{5,5}\ ≦\ 25) $ が空白区切りで書かれている。
 
 上記 $ 25 $ 個の整数は、以下の情報を表している。 - 整数 $ x_{i,j}\ (1\ ≦\ i\ ≦\ 5,\ 1\ ≦\ j\ ≦\ 5) $ は上から $ i $ 番目、左から $ j $ 番目のマスに書かれる整数に関する情報である。$ x_{i,j}\ =\ 0 $ ならそのマスに書かれる整数が決まっていないことを、$ x_{i,j}\ ≠\ 0 $ ならそのマスに書かれる整数が $ x_{i,j} $ であることを表す。
 
 また、入力は以下の条件を満たす。 - $ 1 $ 以上 $ 5 $ 以下の $ 4 $ つの整数組 $ i,j,k,l $ に関して、$ x_{i,j}\ ≧\ 1 $ かつ $ x_{k,l}\ ≧\ 1 $ かつ $ (i,j)\ ≠\ (k,l) $ ならば、$ x_{i,j}\ ≠\ x_{k,l} $。
- $ x_{i,j}\ ≠\ 0 $ を満たす整数組 $ (i,j)\ (1\ ≦\ i\ ≦\ 5,\ 1\ ≦\ j\ ≦\ 5) $ は $ 5 $ 個以上存在する。

## 输出格式

条件を満たすような残りの整数の配置の総数を $ 1000000007\ (=\ 1,000,000,007) $ で割った余りを $ 1 $ 行に出力せよ。出力の末尾に改行を入れること。

## 说明/提示

### 部分点

この問題には部分点が設定されている。

- データセット $ 1 $ において、すべての入力には、$ x_{i,j}\ ≠\ 0 $ を満たす整数組 $ (i,j)\ (1\ ≦\ i\ ≦\ 5,\ 1\ ≦\ j\ ≦\ 5) $ が $ 17 $ 個以上存在する。データセット $ 1 $ に正解した場合は、$ 30 $ 点が与えられる。
- 追加制約のないデータセット $ 2 $ に正解した場合は、上記とは別に $ 70 $ 点が与えられる。

### Sample Explanation 1

\- まだ書かれていない整数は $ 6,\ 11,\ 12,\ 13,\ 14,\ 24 $ の $ 6 $ つです。以下の $ 2 $ 通りが、条件を満たす配置です。 14121527131116122202541963239181017245218 14131527121116122202541963239181017245218

### Sample Explanation 2

\- どのように残りを書いても条件を満たします。

### Sample Explanation 3

\- どのように置いても条件を満たさない場合があります。

### Sample Explanation 4

\- すでにすべての整数の配置が決まっている場合もあります。

## 样例 #1

### 输入

```
0 0 15 2 7

0 0 16 1 22

20 25 4 19 0

3 23 9 18 10

17 0 5 21 8
```

### 输出

```
2
```

## 样例 #2

### 输入

```
10 14 13 15 11

16 0 17 0 18

0 19 0 20 9

21 12 22 0 23

0 24 0 25 0
```

### 输出

```
40320
```

## 样例 #3

### 输入

```
1 2 3 4 5

6 7 8 9 10

11 12 13 14 15

16 17 18 19 20

0 0 0 0 0
```

### 输出

```
0
```

## 样例 #4

### 输入

```
1 25 2 24 3

23 4 22 5 21

6 20 7 19 8

18 9 17 10 16

11 15 12 14 13
```

### 输出

```
1
```



---

---
title: "[ABC027D] ロボット"
layout: "post"
diff: 提高+/省选-
pid: AT_abc027_d
tag: []
---

# [ABC027D] ロボット

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc027/tasks/abc027_d

数直線の原点にロボットが置かれている。 はじめ、ロボットの幸福度は $ 0 $ である。

このロボットに命令列が与えられる。 命令列は次の $ 3 $ 文字のみからなり、先頭から末尾まで順に実行される。

- `M` : 正または負の好きな向きに、距離 $ 1 $ だけ移動する。
- `+` : 今の座標を $ x $ とすると、幸福度が $ +x $ だけ変化する。
- `-` : 今の座標を $ x $ とすると、幸福度が $ -x $ だけ変化する。

 命令列を実行し終えた後、 **ロボットは原点に戻っていなければならない** 。 命令列を実行している間、ロボットの座標および幸福度は負になり得る。

最終的な幸福度を最大化するようにロボットが移動したとき、最終的な幸福度を求めよ。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ S $

- $ 1 $ 行目には、命令列 $ S $ ($ 1≦|S|≦10^5 $) が与えられる。$ S $ は `M`, `+`, `-` のみからなり、`M` が偶数個含まれる。

## 输出格式

最終的な幸福度を最大化するようにロボットが移動したとき、最終的な幸福度を $ 1 $ 行に出力せよ。 出力の末尾には改行を入れること。

## 说明/提示

### 部分点

この問題には部分点が設定されている。

- $ 1≦|S|≦1,000 $ を満たすデータセットに正解した場合は $ 30 $ 点が得られる。

### Sample Explanation 1

以下では、正の向きへの移動を `&gt;`、負の向きへの移動を `&lt;` と表す。 `&gt;+&lt;&lt;-&gt;` のように移動すればよい。

### Sample Explanation 2

例えば `&gt;&gt;&lt;+&lt;` のように移動すればよい。

### Sample Explanation 3

`&lt;&lt;&lt;+--&gt;&gt;&gt;` のように移動すればよい。

## 样例 #1

### 输入

```
M+MM-M
```

### 输出

```
2
```

## 样例 #2

### 输入

```
MMM+M
```

### 输出

```
1
```

## 样例 #3

### 输入

```
MMM+--MMM
```

### 输出

```
3
```

## 样例 #4

### 输入

```
+
```

### 输出

```
0
```



---

---
title: "[ABC033D] 三角形の分類"
layout: "post"
diff: 提高+/省选-
pid: AT_abc033_d
tag: []
---

# [ABC033D] 三角形の分類

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc033/tasks/abc033_d

$ 2 $ 次元平面上の $ N $ 個の点が与えられます。 $ i $ 番目の点の座標は $ (x_i,\ y_i) $ です。ただし、このうちのどの $ 3 $ 点も同一直線上にありません。

$ N $ 点のうち $ 3 $ 点を選ぶことによってこの $ 3 $ 点を頂点とした三角形を作ることを考えます。三角形は全部で $ N\ *\ (N\ -\ 1)\ *\ (N\ -\ 2)\ /\ 6 $ 個できます。 これらの三角形のうち、鋭角三角形の個数、直角三角形の個数、鈍角三角形の個数を求めてください。

ただし、鋭角三角形とは、$ 3 $ つの角が全て $ 90° $ より小さい三角形で、直角三角形とは、ある $ 1 $ つの角が $ 90° $ である三角形で、 鈍角三角形とは、ある $ 1 $ つの角が $ 90° $ より大きい三角形のことをいいます。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ x_1 $ $ y_1 $ $ x_2 $ $ y_2 $ : $ x_N $ $ y_N $

- $ 1 $ 行目には、点の個数を表す整数 $ N\ (3\ ≦\ N\ ≦\ 2,000) $ が与えられる。
- $ 2 $ 行目から $ N $ 行には、点の座標に関する情報が与えられる。このうち $ i $ 行目には、整数 $ x_i\ (-10,000\ ≦\ x_i\ ≦\ 10,000) $、 $ y_i\ (-10,000\ ≦\ y_i\ ≦\ 10,000) $ が空白区切りで与えられる。
- $ N $ 個の点は全て異なる。
- $ N $ 個の点のうち、異なる $ 3 $ 点が同一直線上にあることはない。

## 输出格式

鋭角三角形の個数、直角三角形の個数、鈍角三角形の個数をこの順に空白区切りで $ 1 $ 行に出力せよ。

出力の末尾にも改行を入れること。

## 说明/提示

### 部分点

この問題には部分点が設定されている。

- $ N\ ≦\ 100 $ を満たすデータセットに正解した場合、部分点として $ 30 $ 点が与えられる。

### Sample Explanation 1

\- $ 2 $ 番目の点、$ 4 $ 番目の点、$ 5 $ 番目の点を選ぶと、鋭角三角形ができます。 - $ 1 $ 番目の点、$ 4 $ 番目の点、$ 5 $ 番目の点を選ぶと、直角三角形ができます。 - $ 3 $ 番目の点、$ 4 $ 番目の点、$ 5 $ 番目の点を選ぶと、直角三角形ができます。 - その他の $ 7 $ 通りの選び方では、全て鈍角三角形ができます。

## 样例 #1

### 输入

```
5

1 3

2 2

3 2

4 1

4 3
```

### 输出

```
1 2 7
```

## 样例 #2

### 输入

```
9

2 0

1 1

3 1

1 2

5 2

0 3

4 3

2 4

4 4
```

### 输出

```
27 14 43
```



---

---
title: "[ABC038D] プレゼント"
layout: "post"
diff: 提高+/省选-
pid: AT_abc038_d
tag: []
---

# [ABC038D] プレゼント

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc038/tasks/abc038_d

高橋くんはプレゼントを用意することになりました。プレゼントの中身はすでに決まり、あとはプレゼントを入れる箱を用意するだけです。 高橋くんが使える箱は$ N $個あり、$ i $番目の箱は縦$ h_i $cm×横$ w_i $cmのサイズです。

プレゼントがより多くの箱に入っていたほうが面白いと考えた高橋くんは、なるべく多くの箱を入れ子にし、最も内側の箱にプレゼントを入れることにしました。 ある箱は、縦・横ともにより大きいサイズの箱にのみ入れることができます。また、ある箱は$ 1 $つまでしか他の箱を入れることはできません。

プレゼントを入れる箱を最大で何重の入れ子にできるか答えてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ w_1 $ $ h_1 $ $ w_2 $ $ h_2 $ : $ w_N $ $ h_N $

## 输出格式

プレゼントを包む箱の数の最大値を $ 1 $ 行に出力せよ。

## 说明/提示

### 制約

- $ 1≦N≦10^5 $
- $ 1≦h_i≦10^5 $
- $ 1≦w_i≦10^5 $

### 部分点

- $ N\ ≦\ 1,000 $ を満たすテストケース全てに正解した場合、部分点として$ 30 $点が与えられる。

### Sample Explanation 1

外側の箱から順に、$ 1,\ 3,\ 2 $番目の箱でプレゼントを包むことができます。

### Sample Explanation 2

箱を$ 90 $度回転することはできないことに注意してください。また、ある箱を縦または横の長さが等しい箱に入れることはできません。

## 样例 #1

### 输入

```
3

3 3

1 1

2 2
```

### 输出

```
3
```

## 样例 #2

### 输入

```
2

4 5

4 3
```

### 输出

```
1
```

## 样例 #3

### 输入

```
4

2 5

3 3

4 5

6 6
```

### 输出

```
3
```

## 样例 #4

### 输入

```
5

8 8

5 3

2 2

4 2

2 1
```

### 输出

```
4
```



---

---
title: "[ABC061D] Score Attack"
layout: "post"
diff: 提高+/省选-
pid: AT_abc061_d
tag: []
---

# [ABC061D] Score Attack

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc061/tasks/abc061_d

$ N $ 頂点 $ M $ 辺の重み付き有向グラフがあります。   
 $ i(1≦i≦M) $ 番目の辺は 頂点 $ a_i $ から 頂点 $ b_i $ を重み $ c_i $ で結びます。   
 このグラフと駒を利用して、次の1人ゲームを行います。

最初、駒を頂点 $ 1 $ に置いて、プレイヤーのスコアを $ 0 $ とします。   
 プレイヤーは、次の条件で駒を繰り返し移動させることができます。

- 頂点 $ a_i $ に駒があるとき、$ i $ 番目の辺を利用して頂点 $ b_i $ に移動する。移動後にプレイヤーのスコアが $ c_i $ 加算される。

頂点 $ N $ に駒があるときのみ、ゲームを終了できます。   
 なお、与えられる有向グラフの上で頂点 $ 1 $ から頂点 $ N $ に移動できることは保障されています。

プレイヤーがゲーム終了時のスコアを出来るだけ大きくするような行動を取ったとき、ゲーム終了時のスコアはいくつになるでしょうか?   
 ゲーム終了時のスコアをいくらでも大きくできる場合は `inf` と出力してください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ M $ $ a_1 $ $ b_1 $ $ c_1 $ $ a_2 $ $ b_2 $ $ c_2 $ $ : $ $ a_M $ $ b_M $ $ c_M $

## 输出格式

もし、ゲーム終了時のスコアをいくらでも大きくできる場合は `inf`、そうでない場合はゲーム終了時のスコアの最大値を出力せよ。

## 说明/提示

### 制約

- $ 2≦N≦1000 $
- $ 1≦M≦min(N(N-1),2000) $
- $ 1≦a_i,b_i≦N\ (1≦i≦M) $
- $ a_i≠b_i\ (1≦i≦M) $
- $ a_i≠a_j $ または $ b_i≠b_j\ (1≦i\ <\ j≦M) $
- $ -10^9≦c_i≦10^9\ (1≦i≦M) $
- $ c_i $ は整数である。
- 与えられるグラフには、頂点 $ 1 $ から頂点 $ N $ への経路が存在する。

### Sample Explanation 1

駒を頂点 $ N=3 $ に移動できる経路は以下の $ 2 $ 通りです。 - 頂点 $ 1 $ → 頂点 $ 2 $ → 頂点 $ 3 $ : スコア $ 4+3=7 $ - 頂点 $ 1 $ → 頂点 $ 3 $ : スコア $ 5 $ したがって、ゲーム終了時のスコアの最大値は $ 7 $ となります。

### Sample Explanation 2

頂点 $ 1 $ → 頂点 $ 2 $ → 頂点 $ 1 $ → 頂点 $ 2 $ … と移動することで、ゲーム終了時のスコアをいくらでも増やせます。

## 样例 #1

### 输入

```
3 3

1 2 4

2 3 3

1 3 5
```

### 输出

```
7
```

## 样例 #2

### 输入

```
2 2

1 2 1

2 1 1
```

### 输出

```
inf
```

## 样例 #3

### 输入

```
6 5

1 2 -1000000000

2 3 -1000000000

3 4 -1000000000

4 5 -1000000000

5 6 -1000000000
```

### 输出

```
-5000000000
```



---

---
title: "[ABC076D] AtCoder Express"
layout: "post"
diff: 提高+/省选-
pid: AT_abc076_d
tag: []
---

# [ABC076D] AtCoder Express

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc076/tasks/abc076_d

$ 2168 $年、AtCoder 社は成長し、ついに "AtCoder特急" という鉄道を建設することを決めた。

さて、社長の高橋君は、"AtCoder特急" の列車を以下のように運行することを計画した。

- 列車の走行時間は、$ (t_1\ +\ t_2\ +\ t_3\ +\ ...\ +\ t_N) $ 秒である。
- 最初の $ t_1 $ 秒間は、列車は速度 $ v_1 $ m/s 以内で走っていなければならない。また、次の $ t_2 $ 秒間は、列車は速度 $ v_2 $ m/s 以内で走っていなければならない。 次の $ t_3 $ 秒間、またそれ以降についても同様である。
- 最後の $ t_N $ 秒間は、列車は速度 $ v_N $ m/s 以内で走っていなければならない。

ただし、列車の性能上、加速度は ±$ 1m/s^2 $ 以内でなければならない。また、走行開始時と走行終了時には列車は止まっていなければならない。

列車が発車してから停車するまでに走れる最大の距離を求めなさい。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ t_1 $ $ t_2 $ $ t_3 $ … $ t_N $ $ v_1 $ $ v_2 $ $ v_3 $ … $ v_N $

## 输出格式

列車が発車してから停車するまでに走ることのできる最大の距離を出力しなさい。 ただし、絶対誤差が $ 10^{-3} $ 以内であれば、正解となります。

## 说明/提示

### 制約

- $ 1\ \leq\ N\ \leq\ 100 $
- $ 1\ \leq\ t_i\ \leq\ 200 $
- $ 1\ \leq\ v_i\ \leq\ 100 $
- 入力はすべて整数である

### Sample Explanation 1

![](https://img.atcoder.jp/abc076/69c1f4241b608bc36f1f08dd4184d3f0.png) - 最初の $ 30 $ 秒は、加速度を $ 1m/s^2 $ にし、加速します。その間に列車は $ 450m $ 走ります。 - 次の $ 40 $ 秒は、速度 $ 30m/s $ を保ちます。その間に列車は $ 1200m $ 走ります。 - 最後の $ 30 $ 秒は、加速度を $ -1m/s^2 $ にし、減速します。その間に列車は $ 450m $ 走ります。 合計で、$ 450 $ + $ 1200 $ + $ 450 $ = $ 2100m $ 走ることができます。

### Sample Explanation 2

![](https://img.atcoder.jp/abc076/a3e07ea723f50df04461165bc2cc8890.png) - 最初の $ 34 $ 秒は、加速度を $ 1m/s^2 $ にし、加速します。その間に列車は $ 578m $ 走ります。 - 次の $ 26 $ 秒は、速度 $ 34m/s $ を保ちます。その間に列車は $ 884m $ 走ります。 - 次の $ 4 $ 秒は、加速度を $ 1m/s^2 $ にし、加速します。その間に列車は $ 144m $ 走ります。 - 次の $ 8 $ 秒は、速度 $ 38m/s $ を保ちます。その間は列車は $ 304m $ 走ります。 - 最後の $ 38 $ 秒は、加速度を $ -1m/s^2 $ にし、減速します。その間に列車は $ 722m $ 走ります。 合計で、$ 578 $ + $ 884 $ + $ 144 $ + $ 304 $ + $ 722 $ = $ 2632m $ 走ることができます。

### Sample Explanation 3

![](https://img.atcoder.jp/abc076/77f821f590cb19d8e449303a102422dc.png) - 最初の $ 6 $ 秒は、加速度を $ 1m/s^2 $ にし、加速します。その間に列車は $ 18m $ 走ります。 - 次の $ 2 $ 秒は、速度 $ 6m/s $ を保ちます。その間に列車は $ 12m $ 走ります。 - 次の $ 4 $ 秒は、加速度を $ -1m/s^2 $ にし、減速します。その間に列車は $ 16m $ 走ります。 - 次の $ 14 $ 秒は、速度 $ 2m/s $ を保ちます。その間は列車は $ 28m $ 走ります。 - 最後の $ 2 $ 秒は、加速度を $ -1m/s^2 $ にし、減速します。その間に列車は $ 2m $ 走ります。 合計で、$ 18 $ + $ 12 $ + $ 16 $ + $ 28 $ + $ 2 $ = $ 76m $ 走ることができます。

### Sample Explanation 4

![ ](https://img.atcoder.jp/abc076/ebde8cbeb649ae7fd338180c0562ae0b.png) - 最初の $ 4.5 $ 秒は、加速度を $ 1m/s^2 $ にし、加速します。その間に列車は $ 10.125m $ 走ります。 - 最後の $ 4.5 $ 秒は、加速度を $ -1m/s^2 $ にし、減速します。その間に列車は $ 10.125m $ 走ります。 合計で、$ 10.125 $ + $ 10.125 $ = $ 20.25m $ 走ることができます。

## 样例 #1

### 输入

```
1

100

30
```

### 输出

```
2100.000000000000000
```

## 样例 #2

### 输入

```
2

60 50

34 38
```

### 输出

```
2632.000000000000000
```

## 样例 #3

### 输入

```
3

12 14 2

6 2 7
```

### 输出

```
76.000000000000000
```

## 样例 #4

### 输入

```
1

9

10
```

### 输出

```
20.250000000000000000
```

## 样例 #5

### 输入

```
10

64 55 27 35 76 119 7 18 49 100

29 19 31 39 27 48 41 87 55 70
```

### 输出

```
20291.000000000000
```



---

---
title: "[ABC126F] XOR Matching"
layout: "post"
diff: 提高+/省选-
pid: AT_abc126_f
tag: []
---

# [ABC126F] XOR Matching

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc126/tasks/abc126_f

以下の条件を満たす、長さ $ 2^{M\ +\ 1} $ の数列 $ a $ = {$ a_1,\ a_2,\ ...,\ a_{2^{M\ +\ 1}} $} を、存在するならば $ 1 $ つ構築してください。

- $ a $ は $ 0 $ 以上 $ 2^M $ 未満の整数を、それぞれちょうど $ 2 $ つずつ含む。
- $ a_i\ =\ a_j $ を満たす任意の $ i,\ j\ (i\ <\ j) $ について、$ a_i\ xor\ a_{i\ +\ 1}\ xor\ ...\ xor\ a_j\ =\ K $ である。

xor (排他的論理和) とは

整数 $ c_1,\ c_2,\ ...,\ c_n $ の xor は以下のように定義されます。

- $ c_1\ xor\ c_2\ xor\ ...\ xor\ c_n $ を二進表記した際の $ 2^k $ ($ k\ \geq\ 0 $) の位の数は、$ c_1,\ c_2,\ ...,\ c_n $ のうち二進表記した際の $ 2^k $ の位の数が $ 1 $ となるものが奇数個ならば $ 1 $、偶数個ならば $ 0 $ である。

例えば、$ 3\ xor\ 5\ =\ 6 $ です (二進表記すると: `011` $ xor $ `101` $ = $ `110` です)。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ M $ $ K $

## 输出格式

条件を満たす数列 $ a $ が存在しなければ `-1` を出力せよ。

存在するならば、$ a $ の要素を空白区切りで出力せよ。

条件を満たす数列が複数存在する場合、どれを出力してもよい。

## 说明/提示

### 制約

- 入力は全て整数である。
- $ 0\ \leq\ M\ \leq\ 17 $
- $ 0\ \leq\ K\ \leq\ 10^9 $

### Sample Explanation 1

このケースでは、条件を満たす数列は複数存在します。 例えば $ a $ = {$ 0,\ 0,\ 1,\ 1 $} の場合、$ a_i\ =\ a_j $ を満たす $ (i,\ j)\ (i\ <\ j) $ として $ (1,\ 2) $ と $ (3,\ 4) $ があります。$ a_1\ xor\ a_2\ =\ 0,\ a_3\ xor\ a_4\ =\ 0 $ であるため、この $ a $ は与えられた条件を満たしています。

### Sample Explanation 2

条件を満たす数列は存在しません。

### Sample Explanation 3

条件を満たす数列は存在しません。

## 样例 #1

### 输入

```
1 0
```

### 输出

```
0 0 1 1
```

## 样例 #2

### 输入

```
1 1
```

### 输出

```
-1
```

## 样例 #3

### 输入

```
5 58
```

### 输出

```
-1
```



---

---
title: "[ABC127E] Cell Distance"
layout: "post"
diff: 提高+/省选-
pid: AT_abc127_e
tag: []
---

# [ABC127E] Cell Distance

## 题目描述

有一个 $n \times m$ 的矩形，你会从中选出 $k$ 个坐标为整数的位置 $(x_1,y_1),(x_2,y_2)\dots(x_{k},y_{k})$ 。

你定义一个选出 $k$ 个位置的方案的权值为$\textstyle \sum_{i=1}^{k-1}\sum_{j=i+1}^{k}(|x_{i}-x_{j}|+|y_{i}-y_{j}|)$

你需要求出，所有可能的选出 $k$ 个位置的方案的权值之和，答案对 $1000000007$ 取模

## 输入格式

一行三个整数 $n,m,k$

## 输出格式

一行一个整数，表示答案

## 说明/提示

$2 \le k \le n \times m \le 200000$

## 样例 #1

### 输入

```
2 2 2
```

### 输出

```
8
```

## 样例 #2

### 输入

```
4 5 4
```

### 输出

```
87210
```

## 样例 #3

### 输入

```
100 100 5000
```

### 输出

```
817260251
```



---

---
title: "[ABC128F] Frog Jump"
layout: "post"
diff: 提高+/省选-
pid: AT_abc128_f
tag: []
---

# [ABC128F] Frog Jump

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc128/tasks/abc128_f

無限に広がる池があり、数直線とみなせます。この池には $ N $ 個の蓮が浮かんでおり、それらは座標 $ 0,1,2,....N-2,N-1 $ にあります。

あなたは、最初座標$ 0 $ の蓮の上にいます。あなたは、以下の手順に従ってゲームを行うことにしました。

- 1.正の整数 $ A,B $ を決める。得点ははじめ $ 0 $ である。
- 2.現在の位置を $ x $ として、$ y=x+A $とする。$ x $ にある蓮を消して、$ y $ に移動する。
  
  
  - $ y=N-1 $ ならば、ゲームが終了する。
  - そうでなくて、$ y $ に蓮があるならば、得点が $ s_y $ 増加する。
  - そこに蓮がないならば、あなたは溺れる。得点が $ 10^{100} $ 減少して、ゲームが終了する。
- 3.現在の位置を $ x $ として、$ y=x-B $とする。$ x $ にある蓮を消して、$ y $ に移動する。
  
  
  - $ y=N-1 $ ならば、ゲームが終了する。
  - そうでなくて、$ y $ に蓮があるならば、得点が $ s_y $ 増加する。
  - そこに蓮がないならば、あなたは溺れる。得点が $ 10^{100} $ 減少して、ゲームが終了する。
- 4.手順2に戻る。

あなたは、最終得点をできるだけ大きくしたいです。 最適に $ A,B $ の値を決めたときの最終得点はいくらになるでしょうか。

## 输入格式

入力は以下の形式で標準入力から与えられます。

> $ N $ $ s_0 $ $ s_1 $ $ ...... $ $ s_{N-1} $

## 输出格式

最適に $ A,B $ の値を決めたときの最終得点を出力してください。

## 说明/提示

### 制約

- $ 3\ \leqq\ N\ \leqq\ 10^5 $
- $ -10^9\ \leqq\ s_i\ \leqq\ 10^9 $
- $ s_0=s_{N-1}=0 $
- 入力はすべて整数である。

### Sample Explanation 1

$ A\ =\ 3,\ B\ =\ 2 $ としたとき、ゲームは次のように進行します。 - 座標 $ 0\ +\ 3\ =\ 3 $ に移動し、得点が $ s_3\ =\ 1 $ 増加する。 - 座標 $ 3\ -\ 2\ =\ 1 $ に移動し、得点が $ s_1\ =\ 2 $ 増加する。 - 座標 $ 1\ +\ 3\ =\ 4 $ に移動し、得点 $ 3 $ でゲームが終了する。 得点 $ 4 $ 以上でゲームを終了することはできないため、答えは $ 3 $ です。座標 $ 2 $ にある蓮に乗ってその後溺れずに済ますことはできないことに注意してください。

### Sample Explanation 2

ここでの最適な戦略は、$ A\ =\ 5 $ を選んで ($ B $ の値は不問) ただちに最後の蓮に乗ることです。

## 样例 #1

### 输入

```
5

0 2 5 1 0
```

### 输出

```
3
```

## 样例 #2

### 输入

```
6

0 10 -7 -4 -13 0
```

### 输出

```
0
```

## 样例 #3

### 输入

```
11

0 -4 0 -99 31 14 -15 -39 43 18 0
```

### 输出

```
59
```



---

---
title: "[ABC129F] Takahashi&#39;s Basics in Education and Learning"
layout: "post"
diff: 提高+/省选-
pid: AT_abc129_f
tag: []
---

# [ABC129F] Takahashi&#39;s Basics in Education and Learning

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc129/tasks/abc129_f

<!-- 正の整数の組 $ (L_i,\ A_i,\ B_i,\ M_i) $ が $ Q $ 個与えられます．各組について，次の質問に答えてください．-->長さ $ L $ の等差数列 $ s_0,\ s_1,\ s_2,\ ...\ ,\ s_{L-1} $ があります。

この等差数列の初項は $ A $、公差は $ B $ です。つまり、$ s_i\ =\ A\ +\ B\ \times\ i $ が成り立ちます。

この数列の各項を、先頭に $ 0 $ の無い十進法表記に直し、順につなげて読んでできる整数を考えます。たとえば、数列 $ 3,\ 7,\ 11,\ 15,\ 19 $ をつなげて読んでできる整数は $ 37111519 $ となります。この整数を $ M $ で割ったあまりはいくらでしょうか。

## 输入格式

入力は以下の形式で標準入力から与えられます。

> $ L $ $ A $ $ B $ $ M $

## 输出格式

数列の各項をつなげて読んだ整数を $ M $ で割ったあまりを出力してください。

## 说明/提示

### 制約

- 入力はすべて整数である
- $ 1\ \leq\ L,\ A,\ B\ <\ 10^{18} $
- $ 2\ \leq\ M\ \leq\ 10^9 $
- 等差数列の要素は全て $ 10^{18} $ 未満

### Sample Explanation 1

考える等差数列は $ 3,\ 7,\ 11,\ 15,\ 19 $ なので，$ 37111519 $ を $ 10007 $ で割ったあまりである $ 5563 $ が答えです．

## 样例 #1

### 输入

```
5 3 4 10007
```

### 输出

```
5563
```

## 样例 #2

### 输入

```
4 8 1 1000000
```

### 输出

```
891011
```

## 样例 #3

### 输入

```
107 10000000000007 1000000000000007 998244353
```

### 输出

```
39122908
```



---

---
title: "[ABC131F] Must Be Rectangular!"
layout: "post"
diff: 提高+/省选-
pid: AT_abc131_f
tag: []
---

# [ABC131F] Must Be Rectangular!

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc131/tasks/abc131_f

$ 2 $ 次元平面上の $ N $ 個の点があり、$ i $ 番目の点の座標は $ (x_i,\ y_i) $ です。

以下の操作を行える限り繰り返します。

- 座標 $ (a,\ b),\ (a,\ d),\ (c,\ b),\ (c,\ d) $ のうちちょうど $ 3 $ 箇所に点が存在するような整数 $ a,\ b,\ c,\ d\ (a\ \neq\ c,\ b\ \neq\ d) $ を選び、残りの $ 1 $ 箇所に点を追加する。

この操作は有限回しか行なうことができないことが証明できます。操作回数の最大値を求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ x_1 $ $ y_1 $ $ : $ $ x_N $ $ y_N $

## 输出格式

操作回数の最大値を出力せよ。

## 说明/提示

### 制約

- $ 1\ \leq\ N\ \leq\ 10^5 $
- $ 1\ \leq\ x_i,\ y_i\ \leq\ 10^5 $
- $ x_i\ \neq\ x_j $ または $ y_i\ \neq\ y_j\ (i\ \neq\ j) $
- 入力は全て整数である

### Sample Explanation 1

$ a\ =\ 1,\ b\ =\ 1,\ c\ =\ 5,\ d\ =\ 5 $ とすると $ (1,\ 5) $ に点を追加することができます。これ以上操作を行うことはできないので、操作回数の最大値は $ 1 $ 回です。

### Sample Explanation 2

$ 2 $ 点しか点がないので操作を $ 1 $ 回も行うことができません。

### Sample Explanation 3

$ a\ =\ 1,\ b\ =\ 1,\ c\ =\ i,\ d\ =\ j\ (2\ \leq\ i,j\ \leq\ 5) $ の全てに対して操作を行うことができ、それ以上操作を行うことはできないので、操作回数の最大値は $ 16 $ 回です。

## 样例 #1

### 输入

```
3

1 1

5 1

5 5
```

### 输出

```
1
```

## 样例 #2

### 输入

```
2

10 10

20 20
```

### 输出

```
0
```

## 样例 #3

### 输入

```
9

1 1

2 1

3 1

4 1

5 1

1 2

1 3

1 4

1 5
```

### 输出

```
16
```



---

---
title: "[ABC132F] Small Products"
layout: "post"
diff: 提高+/省选-
pid: AT_abc132_f
tag: []
---

# [ABC132F] Small Products

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc132/tasks/abc132_f

正の整数 $ K $ 個を一列に並べたものであって、隣接して並んでいるどの $ 2 $ つの整数の積も $ N $ 以下であるものの個数を $ 10^9+7 $ で割った余りを求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ K $

## 输出格式

条件を満たす列の個数を $ 10^9+7 $ で割った余りを出力せよ。

## 说明/提示

### 制約

- $ 1\leq\ N\leq\ 10^9 $
- 1 $ 2\leq\ K\leq\ 100 $ (21:33 修正)
- $ N,K $ は整数である

### Sample Explanation 1

$ (1,1),(1,2),(1,3),(2,1),(3,1) $ が条件を満たします。

## 样例 #1

### 输入

```
3 2
```

### 输出

```
5
```

## 样例 #2

### 输入

```
10 3
```

### 输出

```
147
```

## 样例 #3

### 输入

```
314159265 35
```

### 输出

```
457397712
```



---

---
title: "[ABC135E] Golf"
layout: "post"
diff: 提高+/省选-
pid: AT_abc135_e
tag: []
---

# [ABC135E] Golf

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc135/tasks/abc135_e

無限に広がる二次元格子があります。ジャンボ高橋君はこの上でゴルフをすることにしました。

ボールははじめ原点 $ (0,\ 0) $ にあり、ゴールは格子点(座標がいずれも整数である点) $ (X,\ Y) $ です。ジャンボ高橋君は $ 1 $ 打ごとに、次の操作を行えます。

- その時点でボールがある点とのマンハッタン距離が $ K $ であるような格子点を $ 1 $ つ選び、その点にボールを飛ばす。

ゴールと同じ座標にボールが来た時点でクリアとなり、それまでの打数がスコアとなります。ジャンボ高橋君はできるだけ少ないスコアでクリアしたいと思っています。

クリアが可能かどうか判定し、可能ならばスコアが最小となるボールの動かし方を $ 1 $ つ求めてください。

マンハッタン距離の説明$ 2 $ つの座標 $ (x_1,\ y_1),\ (x_2,\ y_2) $ に対するマンハッタン距離は、$ |x_1-x_2|+|y_1-y_2| $ と定義されます。

## 输入格式

入力は以下の形式で標準入力から与えられます。

> $ K $ $ X $ $ Y $

## 输出格式

クリアが不可能な場合は `-1` と出力してください。

クリアが可能な場合、スコアが最小となるボールの動かし方を次のように出力してください。

> $ s $ $ x_1 $ $ y_1 $ $ x_2 $ $ y_2 $ $ . $ $ . $ $ . $ $ x_s $ $ y_s $

ここで、$ s $ はスコアの最小値です。また、$ (x_i,\ y_i) $ を $ i $ 打目にボールを飛ばす先の座標とします。

## 说明/提示

### 制約

- 入力はすべて整数
- $ 1\ \leq\ K\ \leq\ 10^9 $
- $ -10^5\ \leq\ X,\ Y\ \leq\ 10^5 $
- $ (X,\ Y)\ \neq\ (0,\ 0) $

### Sample Explanation 1

\- $ (0,\ 0),\ (7,\ 4) $ のマンハッタン距離は $ |0-7|+|0-4|=11 $。 - $ (7,\ 4),\ (2,\ 10) $ のマンハッタン距離は $ |7-2|+|4-10|=11 $。 - $ (2,\ 10),\ (-1,\ 2) $ のマンハッタン距離は $ |2-(-1)|+|10-2|=11 $。 以上より、このボールの動かし方は正しいです。 また、$ 3 $ 打より少なくクリアする方法は存在しません。

## 样例 #1

### 输入

```
11

-1 2
```

### 输出

```
3

7 4

2 10

-1 2
```

## 样例 #2

### 输入

```
4600

52 149
```

### 输出

```
-1
```

## 样例 #3

### 输入

```
4

9 9
```

### 输出

```
5

1 3

4 2

4 6

6 8

9 9
```



---

---
title: "[ABC135F] Strings of Eternity"
layout: "post"
diff: 提高+/省选-
pid: AT_abc135_f
tag: []
---

# [ABC135F] Strings of Eternity

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc135/tasks/abc135_f

英小文字からなる二つの文字列 $ s,\ t $ が与えられます。次の条件を満たす非負整数 $ i $ の個数が有限であるか判定し、有限である場合はそのような $ i $ の最大値を求めてください。

- ある非負整数 $ j $ が存在し、$ t $ を $ i $ 個連結して得られる文字列は、$ s $ を $ j $ 個連結して得られる文字列の部分文字列である。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ s $ $ t $

## 输出格式

条件を満たす非負整数 $ i $ の個数が有限である場合はそのような $ i $ の最大値を、無限である場合は `-1` を出力せよ。

## 说明/提示

### 注記

- 文字列 $ a $ が文字列 $ b $ の部分文字列であるとは、ある整数 $ x $ $ (0\ \leq\ x\ \leq\ |b|\ -\ |a|) $ が存在して任意の整数 $ y $ $ (1\ \leq\ y\ \leq\ |a|) $ に対して $ a_y\ =\ b_{x+y} $ であることです。
- 任意の文字列に対し、それを $ 0 $ 個連結して得られる文字列は空文字列であるとします。また、上記の定義より、空文字列は任意の文字列の部分文字列です。したがって、任意の二つの文字列 $ s,\ t $ に対して $ i\ =\ 0 $ は問題文中の条件を満たします。

### 制約

- $ 1\ \leq\ |s|\ \leq\ 5\ \times\ 10^5 $
- $ 1\ \leq\ |t|\ \leq\ 5\ \times\ 10^5 $
- $ s,\ t $ は英小文字からなる。

### Sample Explanation 1

$ t $ を $ 3 $ 個連結して得られる文字列 `ababab` は、$ s $ を $ 2 $ 個連結して得られる文字列 `abcabababcabab` の部分文字列であるため、$ i\ =\ 3 $ は条件を満たします。 一方で、$ t $ を $ 4 $ 個連結して得られる文字列 `abababab` は、$ s $ を何個連結しても部分文字列として現れないため、$ i\ =\ 4 $ は条件を満たしません。 同様に、$ 5 $ 以上の任意の整数も条件を満たしません。よって条件を満たす非負整数 $ i $ の個数は有限で、その最大値は $ 3 $ です。

### Sample Explanation 2

任意の非負整数 $ i $ に対し、$ t $ を $ i $ 個連結して得られる文字列は、$ s $ を $ 4i $ 個連結して得られる文字列の部分文字列です。したがって条件を満たす非負整数 $ i $ は無限に存在します。

### Sample Explanation 3

注記で述べたように、$ i\ =\ 0 $ は必ず条件を満たします。

## 样例 #1

### 输入

```
abcabab

ab
```

### 输出

```
3
```

## 样例 #2

### 输入

```
aa

aaaaaaa
```

### 输出

```
-1
```

## 样例 #3

### 输入

```
aba

baaab
```

### 输出

```
0
```



---

---
title: "[ABC139F] Engines"
layout: "post"
diff: 提高+/省选-
pid: AT_abc139_f
tag: []
---

# [ABC139F] Engines

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc139/tasks/abc139_f

E869120 君は最初、$ 2 $ 次元平面上の原点 $ (0,\ 0) $ に立っています。

彼は $ N $ 個のエンジンを持っています。エンジンの使い方と機能は以下のようになります。

- $ i $ 個目のエンジンを使うと、E869120 君のいる場所の X 座標が $ x_i $、Y 座標が $ y_i $ 変化する。つまり、E869120 君が座標 $ (X,\ Y) $ にいるときに $ i $ 個目のエンジンを使うと、座標 $ (X\ +\ x_i,\ Y\ +\ y_i) $ に移動する。
- エンジンはどのような順番で使ってもよいが、各エンジンは $ 1 $ 回までしか使えない。ただし、使わないエンジンがあってもよい。

彼は、原点から最も遠い場所に行きたいです。  
 最後に到達する地点の座標を $ (X,\ Y) $ として、原点からの距離 $ \sqrt{X^2\ +\ Y^2} $ の最大値を求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ x_1 $ $ y_1 $ $ x_2 $ $ y_2 $ $ : $ $ : $ $ x_N $ $ y_N $

## 输出格式

最後に到達する地点の、原点からの距離の最大値を実数値として出力せよ。  
 ただし、実際の答えとの相対誤差または絶対誤差が $ 10^{-10} $ 以内であれば正解とみなす。

## 说明/提示

### 制約

- $ 1\ \leq\ N\ \leq\ 100 $
- $ -1\ 000\ 000\ \leq\ x_i\ \leq\ 1\ 000\ 000 $
- $ -1\ 000\ 000\ \leq\ y_i\ \leq\ 1\ 000\ 000 $
- 入力はすべて整数

### Sample Explanation 1

うまくエンジンを使うと、最後に到達する地点の、原点からの距離を $ 10 $ にすることができます。 これには次の $ 3 $ 通りの方法があります。 - エンジン $ 1 $ を使って $ (0,\ 10) $ に移動する - エンジン $ 2 $ を使って $ (5,\ -5) $ に移動し、その後エンジン $ 3 $ を使って $ (0,\ -10) $ に移動する - エンジン $ 3 $ を使って $ (-5,\ -5) $ に移動し、その後エンジン $ 2 $ を使って $ (0,\ -10) $ に移動する 距離を $ 10 $ より大きくする方法はないので、最大値は $ 10 $ となります。

### Sample Explanation 2

最後に到達する地点の、原点からの距離の最大値は $ 2\ \sqrt{2}\ =\ 2.82842... $ となります。 これを達成する方法として、次のようなものが挙げられます。 - エンジン $ 1 $ を使って $ (1,\ 1) $ に移動し、その後エンジン $ 2 $ を使って $ (2,\ 1) $ に移動し、最後にエンジン $ 3 $ を使って $ (2,\ 2) $ に移動する

### Sample Explanation 3

エンジン $ 1\ \rightarrow\ 2\ \rightarrow\ 3\ \rightarrow\ 4\ \rightarrow\ 5 $ の順で全部使うと、最終的に $ (15,\ 15) $ にたどり着き、原点からの距離は $ 15\ \sqrt{2}\ =\ 21.2132... $ となります。

### Sample Explanation 4

$ (x_i,\ y_i)\ =\ (0,\ 0) $ である、何の意味も持たないエンジンがある可能性もあります。

### Sample Explanation 5

$ 1 $ 個しかエンジンがない場合もあることにご注意ください。

### Sample Explanation 6

$ 2 $ 個しかエンジンがない場合もあります。

## 样例 #1

### 输入

```
3

0 10

5 -5

-5 -5
```

### 输出

```
10.000000000000000000000000000000000000000000000000
```

## 样例 #2

### 输入

```
5

1 1

1 0

0 1

-1 0

0 -1
```

### 输出

```
2.828427124746190097603377448419396157139343750753
```

## 样例 #3

### 输入

```
5

1 1

2 2

3 3

4 4

5 5
```

### 输出

```
21.213203435596425732025330863145471178545078130654
```

## 样例 #4

### 输入

```
3

0 0

0 1

1 0
```

### 输出

```
1.414213562373095048801688724209698078569671875376
```

## 样例 #5

### 输入

```
1

90447 91000
```

### 输出

```
128303.000000000000000000000000000000000000000000000000
```

## 样例 #6

### 输入

```
2

96000 -72000

-72000 54000
```

### 输出

```
120000.000000000000000000000000000000000000000000000000
```

## 样例 #7

### 输入

```
10

1 2

3 4

5 6

7 8

9 10

11 12

13 14

15 16

17 18

19 20
```

### 输出

```
148.660687473185055226120082139313966514489855137208
```



---

---
title: "[ABC140F] Many Slimes"
layout: "post"
diff: 提高+/省选-
pid: AT_abc140_f
tag: []
---

# [ABC140F] Many Slimes

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc140/tasks/abc140_f

$ 1 $ 匹のスライムがいます。

あなたはこのスライムの「体力」を自由な整数の値に設定できます。

スライムは $ 1 $ 秒ごとに、自分より真に小さい整数の体力をもつスライムを $ 1 $ 匹生成することで増殖していきます。生成されるスライムの体力は、スライムごとに毎回自由に決めることができます。最初の増殖はこれから $ 1 $ 秒後に起こります。

最初のスライム、および生成されるスライムの体力を適切に定めることで、これから $ N $ 秒後に存在する $ 2^N $ 匹のスライムの体力の集合を集合 $ S $ に一致させることができるか判定してください。

ここで $ S $ は $ 2^N $ 要素からなる重複を認める整数の集合で、その要素は $ S_1,~S_2,~...,~S_{2^N} $ です。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ S_1 $ $ S_2 $ $ ... $ $ S_{2^N} $

## 输出格式

最初のスライム、および生成されるスライムの体力を適切に定めることで、$ N $ 秒後に存在する $ 2^N $ 匹のスライムの体力の集合を集合 $ S $ に一致させることができるなら `Yes` を、できないなら `No` を出力せよ。

## 说明/提示

### 制約

- 入力は全て整数である。
- $ 1\ \leq\ N\ \leq\ 18 $
- $ 1\ \leq\ S_i\ \leq\ 10^9 $

### Sample Explanation 1

$ 2 $ 秒後に存在するスライムの体力の集合を $ S $ に一致させる一例を示します。 まず最初のスライムの体力を $ 4 $ に設定します。 最初のスライムに体力が $ 3 $ のスライムを生成させることで、$ 1 $ 秒後に存在するスライムの体力を $ 4,~3 $ とできます。 そして最初のスライムに体力が $ 2 $ の、$ 2 $ 匹目のスライムに体力が $ 1 $ のスライムを生成させることで、$ 2 $ 秒後に存在するスライムの体力を $ 4,~3,~2,~1 $ とできます。これは集合として $ S $ に一致しています。

### Sample Explanation 2

$ S $ は同じ整数を複数含むこともあります。

## 样例 #1

### 输入

```
2

4 2 3 1
```

### 输出

```
Yes
```

## 样例 #2

### 输入

```
2

1 2 3 1
```

### 输出

```
Yes
```

## 样例 #3

### 输入

```
1

1 1
```

### 输出

```
No
```

## 样例 #4

### 输入

```
5

4 3 5 3 1 2 7 8 7 4 6 3 7 2 3 6 2 7 3 2 6 7 3 4 6 7 3 4 2 5 2 3
```

### 输出

```
No
```



---

---
title: "[ABC141F] Xor Sum 3"
layout: "post"
diff: 提高+/省选-
pid: AT_abc141_f
tag: []
---

# [ABC141F] Xor Sum 3

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc141/tasks/abc141_f

$ N $ 個の非負整数 $ A_1,\ A_2,\ ...,\ A_N $ があります。

このうち $ 1 $ 個以上 $ N-1 $ 個以下を赤色で、残りを青色で塗り分けることを考えます。

塗り分けの **美しさ** を、「赤く塗った整数の $ \text{XOR} $」と「青く塗った整数の $ \text{XOR} $」の和とします。

塗り分けの美しさの最大値を求めてください。

 $ \text{XOR} $ とは $ n $ 個の非負整数 $ x_1,x_2,\ \ldots,\ x_n $ の $ \text{XOR} $ $ x_1\ \oplus\ x_2\ \oplus\ \ldots\ \oplus\ x_n $ は以下のように定義されます。

- $ x_1\ \oplus\ x_2\ \oplus\ \ldots\ \oplus\ x_n $ を二進表記した際の $ 2^k(k\ \geq\ 0) $ の位の数は $ x_1,x_2,\ \ldots,\ x_n $ のうち、二進表記した際の $ 2^k(k\ \geq\ 0) $ の位の数が $ 1 $ となるものの個数が奇数ならば $ 1 $、そうでなければ $ 0 $ となる。
 
 例えば、$ 3\ \oplus\ 5\ =\ 6 $ となります。

## 输入格式

入力は以下の形式で標準入力から与えられます。

> $ N $ $ A_1 $ $ A_2 $ $ ... $ $ A_N $

## 输出格式

塗り分けの美しさの最大値を出力してください。

## 说明/提示

### 制約

- 入力はすべて整数
- $ 2\ \leq\ N\ \leq\ 10^5 $
- $ 0\ \leq\ A_i\ <\ 2^{60}\ (1\ \leq\ i\ \leq\ N) $

### Sample Explanation 1

$ (3,\ 6,\ 5) $ をそれぞれ $ (青,\ 赤,\ 青) $ で塗り分けたとき、美しさは $ (6)\ +\ (3\ \oplus\ 5)\ =\ 12 $ になります。 $ 12 $ よりも高い美しさの塗り分けは存在しないので、答えは $ 12 $ です。

### Sample Explanation 3

$ A_i $ や答えは $ 32 $ ビット整数型に収まらないことがあります。

## 样例 #1

### 输入

```
3

3 6 5
```

### 输出

```
12
```

## 样例 #2

### 输入

```
4

23 36 66 65
```

### 输出

```
188
```

## 样例 #3

### 输入

```
20

1008288677408720767 539403903321871999 1044301017184589821 215886900497862655 504277496111605629 972104334925272829 792625803473366909 972333547668684797 467386965442856573 755861732751878143 1151846447448561405 467257771752201853 683930041385277311 432010719984459389 319104378117934975 611451291444233983 647509226592964607 251832107792119421 827811265410084479 864032478037725181
```

### 输出

```
2012721721873704572
```



---

---
title: "[ABC143F] Distinct Numbers"
layout: "post"
diff: 提高+/省选-
pid: AT_abc143_f
tag: []
---

# [ABC143F] Distinct Numbers

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc143/tasks/abc143_f

高橋くんは $ N $ 枚のカードを持っています。 $ i $ 番目のカードには整数 $ A_i $ が書かれています。

高橋くんは整数 $ K $ を選びます。そして、以下の操作を何度か繰り返します。

- 書かれている整数が互いに異なるちょうど $ K $ 枚のカードを選び、食べる（食べたカードは消滅する）

$ K\ =\ 1,2,\ \ldots,\ N $ のそれぞれに対して、操作を行える最大の回数を求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ A_1 $ $ A_2 $ $ \ldots $ $ A_N $

## 输出格式

$ N $ 個の整数を出力せよ。 $ t\ (1\ \le\ t\ \le\ N) $ 個目には、$ K=t $ のときの答えを出力せよ。

## 说明/提示

### 制約

- $ 1\ \le\ N\ \le\ 3\ \times\ 10^5 $
- $ 1\ \le\ A_i\ \le\ N $
- 入力はすべて整数

### Sample Explanation 1

$ K\ =\ 1 $ のとき、操作を以下のように行うことができます。 - $ 1 $ 枚目のカードを選び、食べる - $ 2 $ 枚目のカードを選び、食べる - $ 3 $ 枚目のカードを選び、食べる また、$ K\ =\ 2 $ のとき、操作を以下のように行うことができます。 - $ 1 $ 枚目のカードと $ 2 $ 枚目のカードを選び、食べる $ K\ =\ 3 $ のときは、操作を行うことができません。$ 1 $ 枚目のカードと $ 3 $ 枚目のカードを同時に選べないことに注意してください。

## 样例 #1

### 输入

```
3

2 1 2
```

### 输出

```
3

1

0
```

## 样例 #2

### 输入

```
5

1 2 3 4 5
```

### 输出

```
5

2

1

1

1
```

## 样例 #3

### 输入

```
4

1 3 3 3
```

### 输出

```
4

1

0

0
```



---

---
title: "[ABC144F] Fork in the Road"
layout: "post"
diff: 提高+/省选-
pid: AT_abc144_f
tag: []
---

# [ABC144F] Fork in the Road

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc144/tasks/abc144_f

$ N $ 個の部屋と、$ M $ 本の一方向にのみ通れる通路から成る洞窟があります。部屋には $ 1 $ から $ N $ までの番号がついています。

高橋君はいま部屋 $ 1 $ におり、部屋 $ N $ が出口へと繋がっています。$ i $ 番目の通路は部屋 $ s_i $ と部屋 $ t_i $ ( $ s_i $ &lt; $ t_i $ ) を繋いでおり、部屋 $ s_i $ から部屋 $ t_i $ の方向にのみ通ることが出来ます。部屋 $ N $ 以外の各部屋について、その部屋から出る通路が少なくとも $ 1 $ つ存在することが分かっています。

高橋君はこの洞窟から脱出を試みます。部屋に到達するたびに (脱出開始時は部屋 $ 1 $ に到達したとみなします)、高橋君はその部屋から出る通路のうち等確率でランダムに $ 1 $ つを選んで進みます。

高橋君の友達の青木君は、高橋君が部屋 $ 1 $ から移動する前に $ 1 $ つだけ通路を塞ぐ (または何もしない) ことが出来ます。ただし、高橋君が部屋 $ N $ に到達できなくなる可能性が生じるような通路の塞ぎ方は出来ません。

高橋君が部屋 $ N $ に到達するまでに通る通路の数の期待値を $ E $ とします。青木君が $ E $ を最小化するような選択をしたときの $ E $ の値を求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ M $ $ s_1 $ $ t_1 $ $ : $ $ s_M $ $ t_M $

## 输出格式

青木君が $ E $ を最小化するような選択をしたときの $ E $ の値を出力せよ。 出力は、ジャッジと出力との絶対誤差または相対誤差が $ 10^{-6} $ 以下のとき正解と判定される。

## 说明/提示

### 制約

- $ 2\ <\ =\ N\ <\ =\ 600 $
- $ N-1\ <\ =\ M\ <\ =\ \frac{N(N-1)}{2} $
- $ s_i\ <\ t_i $
- $ i\ \neq\ j $ のとき、$ (s_i,\ t_i)\ \neq\ (s_j,\ t_j) $ (21:23 追記)
- 任意の $ v\ =\ 1,\ 2,\ ...,\ N-1 $ に対し、ある $ i $ が存在して $ v\ =\ s_i $

### Sample Explanation 1

青木君が部屋 $ 1 $ から部屋 $ 2 $ への通路を塞ぐと、高橋君は $ \frac{1}{2} $ の確率で `1` → `3` → `4` という経路を辿り、 $ \frac{1}{2} $ の確率で `1` → `4` という経路を辿ります。このとき $ E\ =\ 1.5 $ であり、これが $ E $ がとりうる最小の値です。

### Sample Explanation 2

どの通路を塞いでも部屋 $ N $ に到達出来なくなるため、青木君は通路を塞ぐことは出来ません。

## 样例 #1

### 输入

```
4 6

1 4

2 3

1 3

1 2

3 4

2 4
```

### 输出

```
1.5000000000
```

## 样例 #2

### 输入

```
3 2

1 2

2 3
```

### 输出

```
2.0000000000
```

## 样例 #3

### 输入

```
10 33

3 7

5 10

8 9

1 10

4 6

2 5

1 7

6 10

1 4

1 3

8 10

1 5

2 6

6 9

5 6

5 8

3 6

4 8

2 7

2 9

6 7

1 2

5 9

6 8

9 10

3 9

7 8

4 5

2 10

5 7

3 5

4 7

4 9
```

### 输出

```
3.0133333333
```



---

---
title: "[ABC145F] Laminate"
layout: "post"
diff: 提高+/省选-
pid: AT_abc145_f
tag: []
---

# [ABC145F] Laminate

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc145/tasks/abc145_f

$ 10^9 $ 行 $ N $ 列の白色グリッドのいくつかのマスを黒く塗って、アートを製作します。  
 現時点では、左から $ i $ 列目については下から $ H_i $ 個のマスを黒く塗り、その列の残りのマスは塗らない予定です。  
 アートの製作を開始する前に、あなたは $ K $ 個以下の列 ($ 0 $ 個でもよい) を選び、それらの列に対する $ H_i $ の値を $ 0 $ 以上 $ 10^9 $ 以下の好きな整数に変更できます。  
 変更後の値は列ごとに個別に選べます。

その後、あなたは次の操作を繰り返すことで変更後のアートを製作します。

- ある行の連続する $ 1 $ マス以上のマスを選んで黒く塗る。(すでに黒く塗られたマスを再び塗ってもよいが、塗らないことにしたマスを塗ってはならない。)

この操作を最小で何回行う必要があるか求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ K $ $ H_1 $ $ H_2 $ $ ... $ $ H_N $

## 输出格式

必要な最小の操作回数を出力せよ。

## 说明/提示

### 制約

- $ 1\ \leq\ N\ \leq\ 300 $
- $ 0\ \leq\ K\ \leq\ N $
- $ 1\ \leq\ H_i\ \leq\ 10^9 $
- 入力はすべて整数である。

### Sample Explanation 1

例えば、$ H_3 $ の値を $ 2 $ に変更した上で以下のような操作を行うと、$ 3 $ 回の操作で変更後のアートを製作することができます。 - 下から $ 1 $ 行目の左から $ 1 $ 列目から $ 4 $ 列目までのマスを黒く塗る。 - 下から $ 2 $ 行目の左から $ 1 $ 列目から $ 3 $ 列目までのマスを黒く塗る。 - 下から $ 3 $ 行目の左から $ 2 $ 列目のマスを黒く塗る。

## 样例 #1

### 输入

```
4 1

2 3 4 1
```

### 输出

```
3
```

## 样例 #2

### 输入

```
6 2

8 6 9 1 2 1
```

### 输出

```
7
```

## 样例 #3

### 输入

```
10 0

1 1000000000 1 1000000000 1 1000000000 1 1000000000 1 1000000000
```

### 输出

```
4999999996
```



---

---
title: "[ABC149F] Surrounded Nodes"
layout: "post"
diff: 提高+/省选-
pid: AT_abc149_f
tag: []
---

# [ABC149F] Surrounded Nodes

## 题目描述

给定一棵 $N$ 个节点的树 $T$ ，现在要给树上每个节点随机涂色，每个节点有 $\frac 1 2$ 的概率染成黑色， $\frac 1 2$ 的概率染成白色。对于一颗染过色的树，定义 $S$ 为包含树上所有被染成**黑色**的节点的，节点数**最小**的连通子图。定义 $S$ 的价值为 $S$ 中**白色**节点的个数。问 $S$ 的期望价值是多少。答案对 $10^9+7$ 取模。

## 输入格式

第一行一个整数 $N$ ，表示树的节点个数。  
接下来 $N-1$ 行，每行两个整数 $A_i,B_i$ ，表示 $A_i,B_i$ 之间存在一条边。  
保证给的图一定是一颗树。

## 输出格式

一个整数，表示 $S$ 的期望价值对 $10^9+7$ 取模的结果。

## 说明/提示

* $2\le N \le2\times 10^5$
* $1\le A_i,B_i\le N$

## 样例 #1

### 输入

```
3

1 2

2 3
```

### 输出

```
125000001
```

## 样例 #2

### 输入

```
4

1 2

2 3

3 4
```

### 输出

```
375000003
```

## 样例 #3

### 输入

```
4

1 2

1 3

1 4
```

### 输出

```
250000002
```

## 样例 #4

### 输入

```
7

4 7

3 1

2 6

5 2

7 1

2 7
```

### 输出

```
570312505
```



---

---
title: "[ABC150E] Change a Little Bit"
layout: "post"
diff: 提高+/省选-
pid: AT_abc150_e
tag: []
---

# [ABC150E] Change a Little Bit

## 题目描述

对于两个长度为 $n$ 的 $\texttt{01}$ 序列 $S,T$ ，我们定义 $f(S,T)$ 为通过以下操作将 $S$ 修改为 $T$ 的最小代价和: 选择一个 $S$ 中的二进制位 $S_{i}$ ，然后改变 $S_{i}$ 的 $\texttt{01}$ 状态，代价为 $D \times C_{i}$，其中 $D$ 是此次操作前满足 $S_{j}\ne T_{j}$ 的整数 $j$ 的数量，$C_{i}$ 是一个给定的序列中的一个值。

求当 $S$ 取 $2^n$ 种不同的状态，$T$ 取 $2^n$ 种不同的状态时，$f(S,T)$ 的和对 $1000000007$ 取模的结果。

## 输入格式

第一行一个整数 $n$

第二行 $n$ 个整数 $C_{i}$

## 输出格式

一行一个整数，表示答案

## 说明/提示

$1 \le n \le 200000 , 1 \le C_{i} \le 10^9 $

## 样例 #1

### 输入

```
1

1000000000
```

### 输出

```
999999993
```

## 样例 #2

### 输入

```
2

5 8
```

### 输出

```
124
```

## 样例 #3

### 输入

```
5

52 67 72 25 79
```

### 输出

```
269312
```



---

---
title: "[ABC150F] Xor Shift"
layout: "post"
diff: 提高+/省选-
pid: AT_abc150_f
tag: []
---

# [ABC150F] Xor Shift

## 题目描述

给定两个长度为 $n$ 的序列 $a=\{a_0,a_1,\cdots,a_{n-1}\}$ 和 $b=\{b_0,b_1,\cdots,b_{n-1}\}$，输出所有有序数对 $(k,x)$ ，满足：  
1. $0\leq k<n$ 且 $x\geq 0$。
2. 序列 $a'=b$，其中 $a'_i = a_{i+k\bmod n}\operatorname{xor} x\ (0\leq i<n)$，“$\operatorname{xor}$”表示按位异或。

## 输入格式

第一行一个整数 $n$。  
第二行 $n$ 个整数，依次是 $a_0,a_1,\cdots,a_{n-1}$。  
第三行 $n$ 个整数，依次是 $b_0,b_1,\cdots,b_{n-1}$。

## 输出格式

输出所有满足条件有序对 $(k,x)$，每对占一行。如果没有满足条件的有序对，输出为空。

## 说明/提示

$1\leq n\leq 2\times 10^5$，$0\leq a_i,b_i<2^{30}$。

## 样例 #1

### 输入

```
3

0 2 1

1 2 3
```

### 输出

```
1 3
```

## 样例 #2

### 输入

```
5

0 0 0 0 0

2 2 2 2 2
```

### 输出

```
0 2

1 2

2 2

3 2

4 2
```

## 样例 #3

### 输入

```
6

0 1 3 7 6 4

1 5 4 6 2 3
```

### 输出

```
2 2

5 5
```

## 样例 #4

### 输入

```
2

1 2

0 0
```

### 输出

```

```



---

---
title: "[ABC152F] Tree and Constraints"
layout: "post"
diff: 提高+/省选-
pid: AT_abc152_f
tag: []
---

# [ABC152F] Tree and Constraints

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc152/tasks/abc152_f

$ 1 $ から $ N $ までの番号がつけられた $ N $ 個の頂点を持つ木があります。 この木の $ i $ 番目の辺は頂点 $ a_i $ と頂点 $ b_i $ を結んでいます。  
 この木の各辺に、それぞれ白か黒の色を塗ることを考えます。このような塗り方は $ 2^{N-1} $ 通り考えられますが、そのうち以下の $ M $ 個の制約をすべて満たすものの個数を求めてください。

- $ i(1\ \leq\ i\ \leq\ M) $ 番目の制約は、 $ 2 $ つの整数 $ u_i $ と $ v_i $ によって表される。これは、頂点 $ u_i $ と頂点 $ v_i $ を結ぶパスに含まれる辺のうち、黒く塗られているものが $ 1 $ つ以上存在しなければならないことを意味する。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ a_1 $ $ b_1 $ $ : $ $ a_{N-1} $ $ b_{N-1} $ $ M $ $ u_1 $ $ v_1 $ $ : $ $ u_M $ $ v_M $

## 输出格式

$ M $ 個の制約をすべて満たす塗り方の個数を出力せよ。

## 说明/提示

### 制約

- $ 2\ \leq\ N\ \leq\ 50 $
- $ 1\ \leq\ a_i,b_i\ \leq\ N $
- 入力で与えられるグラフは木である。
- $ 1\ \leq\ M\ \leq\ \min(20,\frac{N(N-1)}{2}) $
- $ 1\ \leq\ u_i\ <\ v_i\ \leq\ N $
- $ i\ \not=\ j $ なら $ u_i\ \not=u_j $ または $ v_i\not=v_j $
- 入力はすべて整数である。

### Sample Explanation 1

この入力中の木は以下のようなものです。

![図](https://img.atcoder.jp/ghi/5b0208ab1e3bb39a5d4fb7bafbfc448e.png) 

辺 $ 1 $ と辺 $ 2 $ をそれぞれ (白,黒), (黒,白), (黒,黒) で塗った場合に、$ M $ 個の制約をすべて満たすことができます。 したがって答えは $ 3 $ です。

### Sample Explanation 2

この入力中の木は以下のようなものです。

![図](https://img.atcoder.jp/ghi/d08b3f53dfa4857fe9ffe13fa5d7ae69.png)   
辺 $ 1 $ を黒く塗った場合のみ、 $ M $ 個の制約をすべて満たすことができます。 したがって答えは $ 1 $ です。

### Sample Explanation 3

この入力中の木は以下のようなものです。

![図](https://img.atcoder.jp/ghi/386502bb3c85e0bb5aee64e4e7c087a1.png)

### Sample Explanation 4

この入力中の木は以下のようなものです。

![図](https://img.atcoder.jp/ghi/955fa8fd8af658abb24ff2f68b9997be.png)

## 样例 #1

### 输入

```
3

1 2

2 3

1

1 3
```

### 输出

```
3
```

## 样例 #2

### 输入

```
2

1 2

1

1 2
```

### 输出

```
1
```

## 样例 #3

### 输入

```
5

1 2

3 2

3 4

5 3

3

1 3

2 4

2 5
```

### 输出

```
9
```

## 样例 #4

### 输入

```
8

1 2

2 3

4 3

2 5

6 3

6 7

8 6

5

2 7

3 5

1 6

2 8

7 8
```

### 输出

```
62
```



---

---
title: "[ABC153F] Silver Fox vs Monster"
layout: "post"
diff: 提高+/省选-
pid: AT_abc153_f
tag: []
---

# [ABC153F] Silver Fox vs Monster

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc153/tasks/abc153_f

ギンギツネは $ N $ 体のモンスターと戦っています。

モンスターは $ 1 $ 列に並んでおり、数直線上にいるとみなすことができます。$ i $ 番目のモンスターは座標 $ X_i $ にいて、体力は $ H_i $ です。

ギンギツネは爆弾を使ってモンスターを攻撃することができます。 座標 $ x $ で爆弾を使うと、座標が $ x-D $ 以上 $ x+D $ 以下の範囲にいる全てのモンスターの体力を $ A $ 減らすことができます。 爆弾を使う以外の方法でモンスターの体力を減らすことはできません。

全てのモンスターの体力を $ 0 $ 以下にすればギンギツネの勝ちです。

ギンギツネがモンスターに勝つまでに爆弾を使う回数の最小値を求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ D $ $ A $ $ X_1 $ $ H_1 $ : $ X_N $ $ H_N $

## 输出格式

ギンギツネがモンスターに勝つまでに爆弾を使う回数の最小値を出力せよ。

## 说明/提示

### 制約

- $ 1\ \leq\ N\ \leq\ 2\ \times\ 10^5 $
- $ 0\ \leq\ D\ \leq\ 10^9 $
- $ 1\ \leq\ A\ \leq\ 10^9 $
- $ 0\ \leq\ X_i\ \leq\ 10^9 $
- $ 1\ \leq\ H_i\ \leq\ 10^9 $
- $ X_i $ は相異なる。
- 入力中のすべての値は整数である。

### Sample Explanation 1

最初に座標 $ 4 $ で爆弾を使うことで、$ 1 $ 番目と $ 2 $ 番目のモンスターの体力を $ 2 $ 減らせます。 次に座標 $ 6 $ で爆弾を使うことで、$ 2 $ 番目と $ 3 $ 番目のモンスターの体力を $ 2 $ 減らせます。 この $ 2 $ 回で全てのモンスターの体力を $ 0 $ にできました。$ 1 $ 回で全てのモンスターの体力を $ 0 $ 以下にすることはできません。

### Sample Explanation 2

座標 $ 5 $ で爆弾を $ 5 $ 回使います。

### Sample Explanation 3

オーバーフローに注意してください。

## 样例 #1

### 输入

```
3 3 2

1 2

5 4

9 2
```

### 输出

```
2
```

## 样例 #2

### 输入

```
9 4 1

1 5

2 4

3 3

4 2

5 1

6 2

7 3

8 4

9 5
```

### 输出

```
5
```

## 样例 #3

### 输入

```
3 0 1

300000000 1000000000

100000000 1000000000

200000000 1000000000
```

### 输出

```
3000000000
```



---

---
title: "[ABC154E] Almost Everywhere Zero"
layout: "post"
diff: 提高+/省选-
pid: AT_abc154_e
tag: []
---

# [ABC154E] Almost Everywhere Zero

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc154/tasks/abc154_e

$ 1 $ 以上 $ N $ 以下の整数であって、 $ 10 $ 進法で表したときに、$ 0 $ でない数字がちょうど $ K $ 個あるようなものの個数を求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ K $

## 输出格式

条件を満たす数の個数を出力せよ。

## 说明/提示

### 制約

- $ 1\ \leq\ N\ <\ 10^{100} $
- $ 1\ \leq\ K\ \leq\ 3 $

### Sample Explanation 1

条件を満たす数は次の $ 19 $ 個です。 - $ 1,2,3,4,5,6,7,8,9,10,20,30,40,50,60,70,80,90,100 $

### Sample Explanation 2

条件を満たす数は次の $ 14 $ 個です。 - $ 11,12,13,14,15,16,17,18,19,21,22,23,24,25 $

## 样例 #1

### 输入

```
100

1
```

### 输出

```
19
```

## 样例 #2

### 输入

```
25

2
```

### 输出

```
14
```

## 样例 #3

### 输入

```
314159

2
```

### 输出

```
937
```

## 样例 #4

### 输入

```
9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999

3
```

### 输出

```
117879300
```



---

---
title: "[ABC154F] Many Many Paths"
layout: "post"
diff: 提高+/省选-
pid: AT_abc154_f
tag: []
---

# [ABC154F] Many Many Paths

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc154/tasks/abc154_f

$ 2 $ 次元平面があります。この平面上に立っているすぬけ君は、一回の操作で $ x $ 軸正の方向に $ 1 $ もしくは $ y $ 軸正の方向に $ 1 $ 移動することができます。

また、以下のように関数 $ f(r,c) $ を定義します。

- $ f(r,c)\ := $ (すぬけ君が点 $ (0,0) $ から点 $ (r,c) $ まで上記の操作を繰り返して到達する経路の個数)

整数 $ r_1,\ r_2,\ c_1,\ c_2 $ が与えられます。 $ r_1\ <\ =\ i\ <\ =\ r_2 $ かつ $ c_1\ <\ =\ j\ <\ =\ c_2 $ を満たす全ての整数の組 $ (i,j) $ に対する $ f(i,j) $ の 総和を求め、 $ (10^9+7) $ で割った余りを計算してください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ r_1 $ $ c_1 $ $ r_2 $ $ c_2 $

## 输出格式

$ f(i,j) $ の総和を $ (10^9+7) $ で割った余りを出力せよ。

## 说明/提示

### 制約

- $ 1\ <\ =\ r_1\ <\ =\ r_2\ <\ =\ 10^6 $
- $ 1\ <\ =\ c_1\ <\ =\ c_2\ <\ =\ 10^6 $
- 入力はすべて整数

### Sample Explanation 1

例えば、点 $ (0,0) $ から点 $ (1,1) $ までの経路は、$ (0,0) $ → $ (0,1) $ → $ (1,1) $ と $ (0,0) $ → $ (1,0) $ → $ (1,1) $ の $ 2 $ 通りあるので、 $ f(1,1)=2 $ です。 同様に、$ f(1,2)=3 $, $ f(2,1)=3 $, $ f(2,2)=6 $ なので、求める総和は $ 14 $ です。

## 样例 #1

### 输入

```
1 1 2 2
```

### 输出

```
14
```

## 样例 #2

### 输入

```
314 159 2653 589
```

### 输出

```
602215194
```



---

---
title: "[ABC156E] Roaming"
layout: "post"
diff: 提高+/省选-
pid: AT_abc156_e
tag: []
---

# [ABC156E] Roaming

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc156/tasks/abc156_e

$ n $ 個の部屋がある建物があります。 部屋には $ 1 $ から $ n $ までの番号が付いています。

建物の各部屋から、他の任意の部屋に移ることが可能です。

ここで、建物のある部屋 $ i $ にいる人が、別の部屋 $ j~\ (i\ \neq\ j) $ に移ることを **人の移動** と呼ぶことにします。

最初、建物の各部屋には人が $ 1 $ 人いました。

このあと現在までに、人の移動がちょうど $ k $ 回起きたことが分かっています。

現在、建物の各部屋にいる人の数の組合せとして、ありえるものは何通りでしょうか。

$ (10^9\ +\ 7) $ で割った余りを求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ n $ $ k $

## 输出格式

現在、建物の各部屋にいる人の数の組合せとして、ありえるものの個数を $ (10^9\ +\ 7) $ で割った余りを出力せよ。

## 说明/提示

### 制約

- 入力は全て整数である。
- $ 3\ \leq\ n\ \leq\ 2\ \times\ 10^5 $
- $ 2\ \leq\ k\ \leq\ 10^9 $

### Sample Explanation 1

現在、部屋 $ 1 $ にいる人の数を $ c_1 $、部屋 $ 2 $ にいる人の数を $ c_2 $、部屋 $ 3 $ にいる人の数を $ c_3 $ と すると、$ (c_1,\ c_2,\ c_3) $ としてありえるものは、 - $ (0,\ 0,\ 3) $ - $ (0,\ 1,\ 2) $ - $ (0,\ 2,\ 1) $ - $ (0,\ 3,\ 0) $ - $ (1,\ 0,\ 2) $ - $ (1,\ 1,\ 1) $ - $ (1,\ 2,\ 0) $ - $ (2,\ 0,\ 1) $ - $ (2,\ 1,\ 0) $ - $ (3,\ 0,\ 0) $ の $ 10 $ 通りです。 例えば、まず部屋 $ 1 $ にいる人が部屋 $ 2 $ に移動し、 次に部屋 $ 2 $ にいる誰かが部屋 $ 3 $ に移動した場合を考えると、 $ (c_1,\ c_2,\ c_3) $ は $ (0,\ 1,\ 2) $ になります。

### Sample Explanation 2

個数を $ (10^9\ +\ 7) $ で割った余りを出力してください。

## 样例 #1

### 输入

```
3 2
```

### 输出

```
10
```

## 样例 #2

### 输入

```
200000 1000000000
```

### 输出

```
607923868
```

## 样例 #3

### 输入

```
15 6
```

### 输出

```
22583772
```



---

---
title: "[ABC156F] Modularness"
layout: "post"
diff: 提高+/省选-
pid: AT_abc156_f
tag: []
---

# [ABC156F] Modularness

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc156/tasks/abc156_f

長さ $ k $ の数列 $ d_0,d_1,...,d_{k\ -\ 1} $ があります。

以下のクエリ $ q $ 個を順に処理してください。

- $ i $ 番目のクエリは $ 3 $ つの整数 $ n_i,x_i,m_i $ からなる。 長さ $ n_i $ の数列 $ a_0,a_1,...,a_{n_i\ -\ 1} $ を、 \\\[ \\begin{aligned} a\_j = \\begin{cases} x\_i &amp; ( j = 0 ) \\\\ a\_{j - 1} + d\_{(j - 1)~\\textrm{mod}~k} &amp; ( 0 &lt; j \\leq n\_i - 1 ) \\end{cases}\\end{aligned} \\\] と定める。 $ (a_j~\textrm{mod}~m_i)\ <\ (a_{j\ +\ 1}~\textrm{mod}~m_i) $ であるような、$ j~(0\ \leq\ j\ <\ n_i\ -\ 1) $ の個数を出力する。

ここで $ 2 $ つの整数 $ y,\ z~(z\ >\ 0) $ について、$ (y~\textrm{mod}~z) $ は $ y $ を $ z $ で割った余りを表します。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ k $ $ q $ $ d_0 $ $ d_1 $ $ ... $ $ d_{k\ -\ 1} $ $ n_1 $ $ x_1 $ $ m_1 $ $ n_2 $ $ x_2 $ $ m_2 $ $ : $ $ n_q $ $ x_q $ $ m_q $

## 输出格式

$ q $ 行出力せよ。

$ i $ 行目には、$ i $ 番目のクエリに対する答えを出力せよ。

## 说明/提示

### 制約

- 入力は全て整数である。
- $ 1\ \leq\ k,\ q\ \leq\ 5000 $
- $ 0\ \leq\ d_i\ \leq\ 10^9 $
- $ 2\ \leq\ n_i\ \leq\ 10^9 $
- $ 0\ \leq\ x_i\ \leq\ 10^9 $
- $ 2\ \leq\ m_i\ \leq\ 10^9 $

### Sample Explanation 1

$ 1 $ つ目のクエリについて、問題文で示した数列 {$ a_j $} は $ 3,6,7,11,14 $ になります。 - $ (a_0~\textrm{mod}~2)\ >\ (a_1~\textrm{mod}~2) $ - $ (a_1~\textrm{mod}~2)\ <\ (a_2~\textrm{mod}~2) $ - $ (a_2~\textrm{mod}~2)\ =\ (a_3~\textrm{mod}~2) $ - $ (a_3~\textrm{mod}~2)\ >\ (a_4~\textrm{mod}~2) $ であるため、このクエリに対する答えは $ 1 $ です。

## 样例 #1

### 输入

```
3 1

3 1 4

5 3 2
```

### 输出

```
1
```

## 样例 #2

### 输入

```
7 3

27 18 28 18 28 46 1000000000

1000000000 1 7

1000000000 2 10

1000000000 3 12
```

### 输出

```
224489796

214285714

559523809
```



---

---
title: "[ABC158E] Divisible Substring"
layout: "post"
diff: 提高+/省选-
pid: AT_abc158_e
tag: []
---

# [ABC158E] Divisible Substring

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc158/tasks/abc158_e

高橋君は `0` から `9` までの数字から成る長さ $ N $ の文字列 $ S $ を持っています。

素数 $ P $ が好きな高橋君は、$ S $ の空でない連続する部分文字列 $ N\ \times\ (N\ +\ 1)\ /\ 2 $ 個のうち、十進表記の整数と見なした際に $ P $ で割り切れるものの個数を知りたくなりました。

ただし部分文字列は先頭が `0` であっても良いものとし、文字列として等しい場合や、整数と見なした際に等しい場合も、部分文字列の $ S $ 内の位置で区別します。

高橋君のためにこの個数を計算してください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ P $ $ S $

## 输出格式

$ S $ の空でない連続する部分文字列であって、十進表記の整数と見なした際に $ P $ で割り切れるものの個数を出力せよ。

## 说明/提示

### 制約

- $ 1\ \leq\ N\ \leq\ 2\ \times\ 10^5 $
- $ S $ は数字から成る
- $ |S|\ =\ N $
- $ 2\ \leq\ P\ \leq\ 10000 $
- $ P $ は素数である

### Sample Explanation 1

$ S $ = `3543` です。$ S $ の空でない連続する部分文字列は次の $ 10 $ 個があります。 - `3` は $ 3 $ で割り切れる。 - `35` は $ 3 $ で割り切れない。 - `354` は $ 3 $ で割り切れる。 - `3543` は $ 3 $ で割り切れる。 - `5` は $ 3 $ で割り切れない。 - `54` は $ 3 $ で割り切れる。 - `543` は $ 3 $ で割り切れる。 - `4` は $ 3 $ で割り切れない。 - `43` は $ 3 $ で割り切れない。 - `3` は $ 3 $ で割り切れる。 このうち $ 3 $ で割り切れるものは $ 6 $ 個であるので、$ 6 $ を出力してください。

### Sample Explanation 2

$ S $ = `2020` です。$ S $ の空でない連続する部分文字列は $ 10 $ 個ありますが、その全てが $ 2 $ で割り切れるので $ 10 $ を出力してください。 先頭が `0` である部分文字列も許容されることに注意してください。

## 样例 #1

### 输入

```
4 3

3543
```

### 输出

```
6
```

## 样例 #2

### 输入

```
4 2

2020
```

### 输出

```
10
```

## 样例 #3

### 输入

```
20 11

33883322005544116655
```

### 输出

```
68
```



---

---
title: "[ABC158F] Removing Robots"
layout: "post"
diff: 提高+/省选-
pid: AT_abc158_f
tag: []
---

# [ABC158F] Removing Robots

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc158/tasks/abc158_f

数直線上に、$ 1 $ から $ N $ の番号のついた $ N $ 個のロボットが置かれています。ロボット $ i $ は座標 $ X_i $ に存在し、起動すると $ D_i $ だけ正の方向に移動し、移動を終えると同時に数直線上から取り除かれます。全てのロボットの移動速度は同じで、大きさは無視できます。

イタズラ好きの高橋君は、数直線上にロボットが残っている限り、好きなだけ以下の操作を行うことができます。($ 1 $ 回も行わないことも可能です)

- ロボットを $ 1 $ つ選び起動する。移動中のロボットが存在するときは行えない。

ロボット $ i $ が移動する過程で、数直線上の座標 $ X_i $ 以上 $ X_i\ +\ D_i $ 未満の範囲に残っている別のロボット $ j $ と接触したら、ロボット $ j $ も起動されて移動を開始します。この処理は再帰的に繰り返されます。

高橋君が操作を繰り返した後、数直線上に残っているロボットの組み合わせとして考えられるものは何通り存在するでしょうか。答えは非常に大きくなる場合があるので、$ 998244353 $ で割った余りを出力してください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ X_1 $ $ D_1 $ $ : $ $ X_N $ $ D_N $

## 输出格式

数直線上に残っているロボットの組み合わせとして考えられるものの個数を $ 998244353 $ で割った余りを出力せよ。

## 说明/提示

### 制約

- $ 1\ \leq\ N\ \leq\ 2\ \times\ 10^5 $
- $ -10^9\ \leq\ X_i\ \leq\ 10^9 $
- $ 1\ \leq\ D_i\ \leq\ 10^9 $
- $ X_i\ \neq\ X_j\ (i\ \neq\ j) $
- 入力は全て整数である

### Sample Explanation 1

数直線上に残っているロボットの組み合わせとしては、$ \{1,\ 2\},\ \{1\},\ \{\} $ の $ 3 $ 通りが考えられます。 これらは次のように操作すると実現されます。 - 高橋君はロボットを起動しない。このとき、ロボット $ \{1,\ 2\} $ が残ります。 - 高橋君がロボット $ 1 $ を起動する。このとき、ロボット $ 1 $ が移動する過程でロボット $ 2 $ を起動します。最終的にロボットは $ 1 $ つも残っていません。もしくは、高橋君がロボット $ 2 $ を起動した後ロボット $ 1 $ を起動しても、ロボットが残っていない状態にすることができます。 - 高橋君がロボット $ 2 $ を起動し、操作を終了する。このとき、ロボット $ \{1\} $ が残ります。

### Sample Explanation 2

数直線上に残っているロボットの組み合わせとしては、$ \{1,\ 2,\ 3\},\ \{1,\ 2\},\ \{2\},\ \{2,\ 3\},\ \{\} $ の $ 5 $ 通りが考えられます。

### Sample Explanation 3

どのロボットも他のロボットに影響しません。

### Sample Explanation 4

組み合わせとして考えられるものの個数を $ 998244353 $ で割った余りを出力することに注意してください。

## 样例 #1

### 输入

```
2

1 5

3 3
```

### 输出

```
3
```

## 样例 #2

### 输入

```
3

6 5

-1 10

3 3
```

### 输出

```
5
```

## 样例 #3

### 输入

```
4

7 10

-10 3

4 3

-4 3
```

### 输出

```
16
```

## 样例 #4

### 输入

```
20

-8 1

26 4

0 5

9 1

19 4

22 20

28 27

11 8

-3 20

-25 17

10 4

-18 27

24 28

-11 19

2 27

-2 18

-1 12

-24 29

31 29

29 7
```

### 输出

```
110
```



---

---
title: "[ABC160F] Distributing Integers"
layout: "post"
diff: 提高+/省选-
pid: AT_abc160_f
tag: []
---

# [ABC160F] Distributing Integers

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc160/tasks/abc160_f

$ 1 $ から $ N $ までの番号が付けられた $ N $ 個の頂点を持つ木があります。この木の $ i $ 番目の辺は頂点 $ a_i $ と頂点 $ b_i $ を結んでいます。  
 $ k=1,...,N $ に対して、以下の問題を解いてください。

- 以下の手順に従って,木の各頂点に整数を書くことを考える。
  - まず、頂点 $ k $ に $ 1 $ を書く。
  - $ 2,...,N $ を順番に頂点に書く。書き込む頂点は、次のように決める。
      - まだ整数が書かれていない頂点であって、整数が書かれた頂点に隣接しているものを選ぶ。このような頂点が複数存在する場合は、その中からランダムに選ぶ。
- 整数の書き方として考えられるものの数を $ 10^9+7 $ で割ったあまりを求めよ。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ a_1 $ $ b_1 $ $ : $ $ a_{N-1} $ $ b_{N-1} $

## 输出格式

$ k=1,2,...,N $ に対する問題の答えを、順番に一行に出力せよ。

## 说明/提示

### 制約

- $ 2\ \leq\ N\ \leq\ 2\ \times\ 10^5 $
- $ 1\ \leq\ a_i,b_i\ \leq\ N $
- 与えられるグラフは木である

### Sample Explanation 1

この入力中のグラフは以下のようなものです。 !\[図\](https://img.atcoder.jp/ghi/1c88b0eb716ba399b1c5d6565ab62337.png) $ k=1 $ に対する問題において、以下のように $ 2 $ 通りの整数の書き方が考えられます。 - 頂点 $ 1,2,3 $ に、それぞれ $ 1,2,3 $ を書く - 頂点 $ 1,2,3 $ に、それぞれ $ 1,3,2 $ を書く

### Sample Explanation 2

この入力中のグラフは以下のようなものです。 !\[図\](https://img.atcoder.jp/ghi/c47c7798f88e7bfec30fbd664dc9ad50.png)

### Sample Explanation 3

この入力中のグラフは以下のようなものです。 !\[図\](https://img.atcoder.jp/ghi/e9c09403f8d96ae4e679a226993defa6.png)

### Sample Explanation 4

この入力中のグラフは以下のようなものです。 !\[図\](https://img.atcoder.jp/ghi/a85459a03d436560bfe2e911d8cec4e6.png)

## 样例 #1

### 输入

```
3

1 2

1 3
```

### 输出

```
2

1

1
```

## 样例 #2

### 输入

```
2

1 2
```

### 输出

```
1

1
```

## 样例 #3

### 输入

```
5

1 2

2 3

3 4

3 5
```

### 输出

```
2

8

12

3

3
```

## 样例 #4

### 输入

```
8

1 2

2 3

3 4

3 5

3 6

6 7

6 8
```

### 输出

```
40

280

840

120

120

504

72

72
```



---

---
title: "[ABC161F] Division or Subtraction"
layout: "post"
diff: 提高+/省选-
pid: AT_abc161_f
tag: []
---

# [ABC161F] Division or Subtraction

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc161/tasks/abc161_f

正整数 $ N $ が与えられます。

$ 2 $ 以上 $ N $ 以下の整数 $ K $ を決めて、$ N $ が $ K $ 未満になるまで次の操作を繰り返し行います。

- 操作：$ N $ が $ K $ で割り切れるとき、$ N $ を $ N/K $ に置き換える。そうでないとき、$ N $ を $ N-K $ に置き換える。

最終的に $ N $ が $ 1 $ になるような $ K $ の決め方は何通りありますか？

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $

## 输出格式

最終的に $ N $ が $ 1 $ になるような $ K $ の決め方が何通りあるか出力せよ。

## 说明/提示

### 制約

- $ 2\ \leq\ N\ \leq\ 10^{12} $
- $ N $ は整数

### Sample Explanation 1

最終的に $ N $ が $ 1 $ になるような $ K $ は $ 2,5,6 $ の $ 3 $ 通りです。 それぞれのとき、$ N $ は次のように変化します。 - $ K=2 $ のとき：$ 6\ \to\ 3\ \to\ 1 $ - $ K=5 $ のとき：$ 6\ \to\ 1 $ - $ K=6 $ のとき：$ 6\ \to\ 1 $

## 样例 #1

### 输入

```
6
```

### 输出

```
3
```

## 样例 #2

### 输入

```
3141
```

### 输出

```
13
```

## 样例 #3

### 输入

```
314159265358
```

### 输出

```
9
```



---

---
title: "[ABC164E] Two Currencies"
layout: "post"
diff: 提高+/省选-
pid: AT_abc164_e
tag: []
---

# [ABC164E] Two Currencies

## 题目描述

有 $n$ 个城市，它们由 $m$ 条双向道路连接，保证它们能够彼此到达。第 $i$ 条道路连接 $u_i,v_i$，需要花费 $x_i$ 个银币，耗费 $t_i$ 秒的时间。每个城市处都有兑换银币处，第 $i$ 个城市中你可以用 $1$ 个金币兑换 $c_i$ 个银币，可以兑换无限次，不过兑换 $1$ 次需要花费 $d_i$ 秒的时间。你一开始在 $1$ 号城市，有 $s$ 个银币和无限多的金币，求到其它城市需要耗费的最小时间。

$1 \leq n \leq 50$，$n - 1 \le m \le 100$，$1 \leq x_i \leq 50$，$1 \leq t_i,d_i \leq 10^9$，$1 \leq s,c_i \leq 10^9$

## 输入格式

- 第一行 $n,m,s$
- 接下来 $m$ 行 $u_i,v_i,x_i,t_i$
- 接下来 $n$ 行 $c_i,d_i$

## 输出格式

一个整数表示答案。

## 样例 #1

### 输入

```
3 2 1

1 2 1 2

1 3 2 4

1 11

1 2

2 5
```

### 输出

```
2

14
```

## 样例 #2

### 输入

```
4 4 1

1 2 1 5

1 3 4 4

2 4 2 2

3 4 1 1

3 1

3 1

5 2

6 4
```

### 输出

```
5

5

7
```

## 样例 #3

### 输入

```
6 5 1

1 2 1 1

1 3 2 1

2 4 5 1

3 5 11 1

1 6 50 1

1 10000

1 3000

1 700

1 100

1 1

100 1
```

### 输出

```
1

9003

14606

16510

16576
```

## 样例 #4

### 输入

```
4 6 1000000000

1 2 50 1

1 3 50 5

1 4 50 7

2 3 50 2

2 4 50 4

3 4 50 3

10 2

4 4

5 5

7 7
```

### 输出

```
1

3

5
```

## 样例 #5

### 输入

```
2 1 0

1 2 1 1

1 1000000000

1 1
```

### 输出

```
1000000001
```



---

---
title: "[ABC165F] LIS on Tree"
layout: "post"
diff: 提高+/省选-
pid: AT_abc165_f
tag: []
---

# [ABC165F] LIS on Tree

## 题目描述

给您一棵$n$个节点的树，树的每个节点上都有一个值$a_i$。现在要您求出从$1$号点到$i$号点的路径上最长上升子序列的长度。

## 输入格式

第一行一个数$n$，表示节点个数

第二行共$n$个数，第$i$个数表示$a_i$，含义见题面

接下来共有$n-1$行，第两个数$u,v$，表示$u$和$v$之间存在一条边

## 输出格式

输出共包含$n$行，每行只有一个数，第$i$行的数表示从$1$号点到$i$号点的路径上最长上升子序列的长度。

## 说明/提示

$2\le n\le 2e5,a_i\le 1e9, u\le n,v\le n,u\neq v$

## 样例 #1

### 输入

```
10

1 2 5 3 4 6 7 3 2 4

1 2

2 3

3 4

4 5

3 6

6 7

1 8

8 9

9 10
```

### 输出

```
1

2

3

3

4

4

5

2

2

3
```



---

---
title: "[ABC167F] Bracket Sequencing"
layout: "post"
diff: 提高+/省选-
pid: AT_abc167_f
tag: []
---

# [ABC167F] Bracket Sequencing

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc167/tasks/abc167_f

以下のいずれかの条件を満たす文字列を**括弧列**と定義します。

1. 空文字列
2. ある括弧列 $ A $ が存在して、`(`, $ A $, `)` をこの順に連結した文字列
3. ある空でない括弧列 $ A $, $ B $ が存在して、$ A $, $ B $ をこの順に連結した文字列

$ N $ 個の文字列 $ S_i $ が与えられます。$ S_i $ 全てを好きな順序で連結するとき、括弧列を構成することはできますか。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ S_1 $ $ : $ $ S_N $

## 输出格式

$ S_i $ を任意の順序で連結するとき、括弧列を構成できるなら `Yes`、できないなら `No` を出力せよ。

## 说明/提示

### 制約

- $ 1\ \leq\ N\ \leq\ 10^6 $
- $ S_i $ の文字列長の合計は $ 10^6 $ 以下
- $ S_i $ は `(`, `)` のみからなる空でない文字列

### Sample Explanation 1

`(()`, `)` の順に連結すると括弧列になります。

## 样例 #1

### 输入

```
2

)

(()
```

### 输出

```
Yes
```

## 样例 #2

### 输入

```
2

)(

()
```

### 输出

```
No
```

## 样例 #3

### 输入

```
4

((()))

((((((

))))))

()()()
```

### 输出

```
Yes
```

## 样例 #4

### 输入

```
3

(((

)

)
```

### 输出

```
No
```



---

---
title: "[ABC170F] Pond Skater"
layout: "post"
diff: 提高+/省选-
pid: AT_abc170_f
tag: []
---

# [ABC170F] Pond Skater

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc170/tasks/abc170_f

アメンボのすぬけ君は南北 $ H $ マス東西 $ W $ マスの長方形の形をしたグリッド状の池に住んでいます。北から $ i $ 番目、西から $ j $ 番目のマスをマス $ (i,j) $ とします。

いくつかのマスには蓮の葉が浮かんでおり、すぬけ君はそれらのマスには入ることができません。 $ c_{ij} $ が `@` のときマス $ (i,j) $ に蓮の葉が浮かんでいること、`.`のときそうでないことを表します。

すぬけ君は一回水をかくことで東西南北のいずれかの方向に $ 1 $ マス以上 $ K $ マス以下移動することができます。 移動の途中に蓮の葉のあるマスがあってはいけません。また、蓮の葉のあるマスや池の外に移動することもできません。

すぬけ君がマス $ (x_1,y_1) $ から $ (x_2,y_2) $ まで移動するのに最小で何回水をかく必要があるか求めてください。 $ (x_1,y_1) $ から $ (x_2,y_2) $ まで移動することができない場合、そのことを指摘してください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ H $ $ W $ $ K $ $ x_1 $ $ y_1 $ $ x_2 $ $ y_2 $ $ c_{1,1}c_{1,2} $ $ .. $ $ c_{1,W} $ $ c_{2,1}c_{2,2} $ $ .. $ $ c_{2,W} $ $ : $ $ c_{H,1}c_{H,2} $ $ .. $ $ c_{H,W} $

## 输出格式

すぬけ君がマス $ (x_1,y_1) $ から $ (x_2,y_2) $ まで移動するのに必要な最小の水かきの回数を出力せよ。 $ (x_1,y_1) $ から $ (x_2,y_2) $ まで移動することができない場合、`-1`を出力せよ。

## 说明/提示

### 制約

- $ 1\ \leq\ H,W,K\ \leq\ 10^6 $
- $ H\ \times\ W\ \leq\ 10^6 $
- $ 1\ \leq\ x_1,x_2\ \leq\ H $
- $ 1\ \leq\ y_1,y_2\ \leq\ W $
- $ x_1\ \neq\ x_2 $ または $ y_1\ \neq\ y_2 $
- $ c_{i,j} $ は `.` または `@`
- $ c_{x_1,y_1}\ = $ `.`
- $ c_{x_2,y_2}\ = $ `.`
- 入力される数はすべて整数である。

### Sample Explanation 1

はじめ、すぬけ君はマス $ (3,2) $ にいます。 以下のように $ 5 $ 回水をかくことでマス $ (3,4) $ まで移動することができます。 - マス $ (3,2) $ から西に $ 1 $ マス進み、マス $ (3,1) $ に移動する。 - マス $ (3,1) $ から北に $ 2 $ マス進み、マス $ (1,1) $ に移動する。 - マス $ (1,1) $ から東に $ 2 $ マス進み、マス $ (1,3) $ に移動する。 - マス $ (1,3) $ から東に $ 1 $ マス進み、マス $ (1,4) $ に移動する。 - マス $ (1,4) $ から南に $ 2 $ マス進み、マス $ (3,4) $ に移動する。

## 样例 #1

### 输入

```
3 5 2

3 2 3 4

.....

.@..@

..@..
```

### 输出

```
5
```

## 样例 #2

### 输入

```
1 6 4

1 1 1 6

......
```

### 输出

```
2
```

## 样例 #3

### 输入

```
3 3 1

2 1 2 3

.@.

.@.

.@.
```

### 输出

```
-1
```



---

---
title: "[ABC172F] Unfair Nim"
layout: "post"
diff: 提高+/省选-
pid: AT_abc172_f
tag: []
---

# [ABC172F] Unfair Nim

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc172/tasks/abc172_f

石の山が $ N $ 個あり、$ i $ 番目の山には $ A_i $ 個の石があります。

これを使って青木君と高橋君が次のようなゲームをしようとしています。

- 青木君から交互に、次の操作を繰り返す
  - 操作：石の山を $ 1 $ つ選び、そこから $ 1 $ 個以上の石を取り除く
- 先に操作ができなくなった方の負け

このゲームは、両者が最適に行動する場合、ゲーム開始時の各山の石の個数のみによって、先手必勝か後手必勝かが決まります。

そこで高橋君は、ゲームを始める前に、 $ 1 $ 番目の山から $ 0 $ 個以上 $ A_1 $ 個未満の石を $ 2 $ 番目の山に移すことで、後手の高橋君が必勝となるようにしようとしています。

そのようなことが可能なら移動する石の個数の最小値を、不可能ならかわりに `-1` を出力してください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ A_1 $ $ \ldots $ $ A_N $

## 输出格式

移動する石の個数の最小値を出力せよ。不可能ならかわりに `-1` を出力せよ。

## 说明/提示

### 制約

- $ 2\ \leq\ N\ \leq\ 300 $
- $ 1\ \leq\ A_i\ \leq\ 10^{12} $

### Sample Explanation 1

石の移動をしなかった場合、青木君が最初に $ 1 $ 番目の山から $ 2 $ 個の石を取り除くと、高橋君はその後どのように行動しても負けてしまいます。 ゲームを始める前に $ 1 $ 番目の山から $ 1 $ 個の石を移動して、石の個数を $ 4,4 $ とした場合、適切な行動を取ることで、高橋君は必ず勝つことができます。

### Sample Explanation 2

$ 2 $ 番目の山から $ 1 $ 番目の山へ石を移すことはできません。

### Sample Explanation 3

$ 1 $ 番目の山のすべての石を移すことはできません。

### Sample Explanation 5

オーバーフローに注意してください。

## 样例 #1

### 输入

```
2

5 3
```

### 输出

```
1
```

## 样例 #2

### 输入

```
2

3 5
```

### 输出

```
-1
```

## 样例 #3

### 输入

```
3

1 1 2
```

### 输出

```
-1
```

## 样例 #4

### 输入

```
8

10 9 8 7 6 5 4 3
```

### 输出

```
3
```

## 样例 #5

### 输入

```
3

4294967297 8589934593 12884901890
```

### 输出

```
1
```



---

---
title: "[ABC174F] Range Set Query"
layout: "post"
diff: 提高+/省选-
pid: AT_abc174_f
tag: []
---

# [ABC174F] Range Set Query

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc174/tasks/abc174_f

$ N $ 個の色の付いた玉が左右一列に並んでおり、左から $ i $ 番目の玉の色は $ c_i $ です。

クエリが $ Q $ 個与えられます。$ i $ 番目のクエリでは、左から $ l_i $ 番目から $ r_i $ 番目までにある玉の色の種類数を答えてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ Q $ $ c_1 $ $ c_2 $ $ \cdots $ $ c_N $ $ l_1 $ $ r_1 $ $ l_2 $ $ r_2 $ $ : $ $ l_Q $ $ r_Q $

## 输出格式

$ Q $ 行出力せよ。$ i $ 行目には、$ i $ 番目のクエリに対する答えを出力せよ。

## 说明/提示

### 制約

- $ 1\leq\ N,Q\ \leq\ 5\ \times\ 10^5 $
- $ 1\leq\ c_i\ \leq\ N $
- $ 1\leq\ l_i\ \leq\ r_i\ \leq\ N $
- 入力はすべて整数である。

### Sample Explanation 1

\- $ 1,2,3 $ 番目の玉の色は $ 1,2,1 $ で、色 $ 1,2 $ の $ 2 $ 種類があります。 - $ 2,3,4 $ 番目の玉の色は $ 2,1,3 $ で、色 $ 1,2,3 $ の $ 3 $ 種類があります。 - $ 3 $ 番目の玉の色は $ 1 $ で、色 $ 1 $ の $ 1 $ 種類があります。

## 样例 #1

### 输入

```
4 3

1 2 1 3

1 3

2 4

3 3
```

### 输出

```
2

3

1
```

## 样例 #2

### 输入

```
10 10

2 5 6 5 2 1 7 9 7 2

5 5

2 4

6 7

2 2

7 8

7 9

1 8

6 9

8 10

6 8
```

### 输出

```
1

2

2

1

2

2

6

3

3

3
```



---

---
title: "[ABC177F] I hate Shortest Path Problem"
layout: "post"
diff: 提高+/省选-
pid: AT_abc177_f
tag: []
---

# [ABC177F] I hate Shortest Path Problem

## 题目描述

### 题目大意

有一个 $(H+1)$ 行 $W$ 列的矩阵，你每步可以在矩阵中向右或向下移动一个格子。其中，在第 $i\,(1 \le i \le H)$ 行中，你无法从左至右第 $A_i$ 至 $B_i$ 个格子向下走。对于每一个 $k\,(1 \le k \le H)$，求出你从第 $1$ 行的任意一个格子出发移动到第 $(k+1)$ 行的最少步数，若无法移动到则输出 `-1`。

数据范围：$1 \le H,W \le 2\times 10^5$，$1 \le A_i \le B_i \le W$。

## 输入格式

第一行两个整数 $H,W$，接下来 $H$ 行每行两个整数 $A_i,B_i$。

## 输出格式

共 $H$ 行，每行一个整数，第 $i$ 行的数字表示从第 $1$ 行移动到第 $(i+1)$ 行需要的最少步数，若无法移动到则为 `-1`。

### 样例解释

$k=1$ 时，其中一种答案最小的移动顺序为 $(1,1)\rightarrow (2,1)$；

$k=2$ 时，一种移动顺序为 $(1,1)\rightarrow (2,1)\rightarrow (2,2)\rightarrow (3,2)$；

$k=3$ 时，一种移动顺序为 $(1,1)\rightarrow (2,1)\rightarrow (2,2)\rightarrow (3,2)\rightarrow (3,3)\rightarrow (3,4)\rightarrow (4,4)$；

$k=4$ 时，无法从第 $1$ 行移动到第 $5$ 行。

（翻译 by @CarroT1212）

## 样例 #1

### 输入

```
4 4

2 4

1 1

2 3

2 4
```

### 输出

```
1

3

6

-1
```



---

---
title: "[ABC182F] Valid payments"
layout: "post"
diff: 提高+/省选-
pid: AT_abc182_f
tag: []
---

# [ABC182F] Valid payments

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc182/tasks/abc182_f

AtCoder 国には $ A_1 $ 円玉、$ A_2 $ 円玉、$ A_3 $ 円玉、$ \dots $ 、$ A_N $ 円玉の $ N $ 種類のコインがあります。  
 ここで $ A_1\ =\ 1 $ であり、$ 1\ \le\ i\ \lt\ N $ を満たす全ての整数 $ i $ について、 $ A_i\ \lt\ A_{i\ +\ 1} $ かつ $ A_{i\ +\ 1} $ は $ A_i $ の倍数です。

この国のある店で、犬のルンルンは $ X $ 円の商品を購入するために店員に $ y\ (\ge\ X) $ 円を渡し、店員はお釣りとして $ y\ -\ X $ 円を返しました。(お釣りが $ 0 $ 円の可能性もあります)  
 このとき、ルンルンも店員もその金額をちょうど渡すのに必要な最小の枚数のコインで受け渡しを行いました。  
 また、ルンルンが店員に渡したコインのいずれかと同じ種類のコインが店員から返されることはありませんでした。

$ X $ が与えられるので、$ y $ として考えられる値が何通りあるかを求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ X $ $ A_1\ \hspace{7pt}\ A_2\ \hspace{7pt}\ A_3\ \hspace{5pt}\ \dots\ \hspace{5pt}\ A_N $

## 输出格式

$ y $ として考えられる値が何通りあるかを出力せよ。

## 说明/提示

### 制約

- $ 1\ \le\ N\ \le\ 50 $
- $ 1\ =\ A_1\ \lt\ A_2\ \lt\ A_3\ \lt\ \dots\ \lt\ A_N\ \le\ 10^{15} $
- $ A_{i\ +\ 1} $ は $ A_i $ の倍数 $ (1\ \le\ i\ \lt\ N) $
- $ 1\ \le\ X\ \le\ 10^{15} $
- 入力はすべて整数

### Sample Explanation 1

$ y $ として考えられる値は $ 9,\ 10,\ 14 $ です。 例えば、 $ y\ =\ 14 $ のときルンルンは $ 10 $ 円玉 $ 1 $ 枚と $ 1 $ 円玉 $ 4 $ 枚を渡し、店員は $ 5 $ 円玉 $ 1 $ 枚でお釣りを返します。 このとき、ルンルンが渡したどの種類のコインも店員は返していないので条件を満たします。

### Sample Explanation 2

$ y $ として考えられる値は $ 198,\ 200,\ 203,\ 208,\ 248 $ です。

### Sample Explanation 3

$ y $ として考えられる値は $ 44,\ 60,\ 100,\ 104 $ です。

## 样例 #1

### 输入

```
3 9

1 5 10
```

### 输出

```
3
```

## 样例 #2

### 输入

```
5 198

1 5 10 50 100
```

### 输出

```
5
```

## 样例 #3

### 输入

```
4 44

1 4 20 100
```

### 输出

```
4
```

## 样例 #4

### 输入

```
9 11837029798

1 942454037 2827362111 19791534777 257289952101 771869856303 3859349281515 30874794252120 216123559764840
```

### 输出

```
21
```



---

---
title: "[ABC187F] Close Group"
layout: "post"
diff: 提高+/省选-
pid: AT_abc187_f
tag: []
---

# [ABC187F] Close Group

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc187/tasks/abc187_f

$ N $ 頂点 $ M $ 辺の単純無向グラフが与えられます。 このグラフの頂点には $ 1,\ 2,\ \dots,\ N $ の番号が付けられており、$ i $ 番目の辺は頂点 $ A_i $ と頂点 $ B_i $ を結びます。

以下の条件を満たすように辺を $ 0 $ 本以上取り除いたときの、グラフの連結成分の個数としてあり得る最小値を求めてください。

**条件**  
 $ 1\ \le\ a\ <\ b\ \le\ N $ を満たす任意の頂点の組 $ (a,\ b) $ について、 頂点 $ a $ と頂点 $ b $ が同じ連結成分に属するならば、頂点 $ a $ と頂点 $ b $ を直接結ぶ辺が存在する。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ M $ $ A_1 $ $ B_1 $ $ \vdots $ $ A_M $ $ B_M $

## 输出格式

答えを出力せよ。

## 说明/提示

### 制約

- 入力は全て整数
- $ 1\ \le\ N\ \le\ 18 $
- $ 0\ \le\ M\ \le\ \frac{N(N\ -\ 1)}{2} $
- $ 1\ \le\ A_i\ <\ B_i\ \le\ N $
- $ i\ \neq\ j $ ならば $ (A_i,\ B_i)\ \neq\ (A_j,\ B_j) $

### Sample Explanation 1

辺を取り除かないと、 $ (2,\ 3) $ の組が条件を満たしません。 どちらかの辺を取り除くと、頂点 $ 2 $ と頂点 $ 3 $ が非連結になり、条件を満たします。

## 样例 #1

### 输入

```
3 2

1 2

1 3
```

### 输出

```
2
```

## 样例 #2

### 输入

```
4 6

1 2

1 3

1 4

2 3

2 4

3 4
```

### 输出

```
1
```

## 样例 #3

### 输入

```
10 11

9 10

2 10

8 9

3 4

5 8

1 8

5 6

2 5

3 6

6 9

1 9
```

### 输出

```
5
```

## 样例 #4

### 输入

```
18 0
```

### 输出

```
18
```



---

---
title: "[ABC189F] Sugoroku2"
layout: "post"
diff: 提高+/省选-
pid: AT_abc189_f
tag: []
---

# [ABC189F] Sugoroku2

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc189/tasks/abc189_f

高橋君は双六で遊んでいます。

この双六には $ 0 $ から $ N $ の番号がついた $ N+1 $ 個のマスがあります。 高橋君はマス $ 0 $ からスタートし、マス $ N $ を目指します。

この双六では、$ 1 $ から $ M $ までの $ M $ 種類の目が等確率で出るルーレットを使います。 各手番で、高橋君はルーレットを回して出た目の数だけ進みます。この結果マス $ N $ に到達するか、マス $ N $ を越えて進むことになる場合、ゴールとなります。

また、いくつかのマスは「振り出しに戻る」であり、それらのマスに止まると、マス $ 0 $ まで戻されます。 そのようなマスは $ K $ 個あり、マス $ A_1,\ldots,A_K $ です。

高橋君がゴールするまでにルーレットを回す回数の期待値を答えてください。 ゴールすることが不可能な場合は、かわりに `-1` を出力してください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ M $ $ K $ $ A_1 $ $ \ldots $ $ A_K $

## 输出格式

高橋君がゴールするまでにルーレットを回す回数の期待値を出力せよ。 なお、想定解答との絶対誤差または相対誤差が $ 10^{-3} $ 以下であれば正解として扱われる。 ただし、ゴールすることが不可能な場合は、かわりに `-1` と出力せよ。

## 说明/提示

### 制約

- 入力はすべて整数
- $ 1\ \leq\ N\ \leq\ 10^5 $
- $ 1\ \leq\ M\ \leq\ 10^5 $
- $ 0\ \leq\ K\ \leq\ 10 $
- $ 0\ <\ A_1\ <\ \ldots\ <\ A_K\ <\ N $

### Sample Explanation 1

$ 1 $ 回目のルーレットで $ 1 $ を出した場合は $ 2 $ 回、$ 2 $ を出した場合は $ 1 $ 回でゴールできるので、ルーレットを回す回数の期待値は $ 1.5 $ です。

### Sample Explanation 2

ルーレットで $ 1 $ を出すとマス $ 1 $ に移動しますが、このマスは「振り出しに戻る」なのでマス $ 0 $ に戻されます。 従って、$ 2 $ が出るまでルーレットを回し続け、$ 2 $ が初めて出た時点でゴールすることになります。 $ i $ 回目に初めて $ 2 $ が出る確率は $ \frac{1}{2^i} $ ですから、ルーレットを回す回数の期待値は $ \sum_{i\ =\ 1}^{\infty}\ (i\ \times\ \frac{1}{2^i})\ =\ 2 $ となります。

## 样例 #1

### 输入

```
2 2 0
```

### 输出

```
1.5000
```

## 样例 #2

### 输入

```
2 2 1

1
```

### 输出

```
2.0000
```

## 样例 #3

### 输入

```
100 6 10

11 12 13 14 15 16 17 18 19 20
```

### 输出

```
-1
```

## 样例 #4

### 输入

```
100000 2 2

2997 92458
```

### 输出

```
201932.2222
```



---

---
title: "[ABC191D] Circle Lattice Points"
layout: "post"
diff: 提高+/省选-
pid: AT_abc191_d
tag: []
---

# [ABC191D] Circle Lattice Points

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc191/tasks/abc191_d

$ 2 $ 次元平面上に中心 $ (X,\ Y) $ 、半径 $ R $ の円があります。  
 この円の内部または周上にある格子点 ($ x,\ y $ 座標がともに整数である点) の個数を求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ X $ $ Y $ $ R $

## 输出格式

答えを出力せよ。

## 说明/提示

### 制約

- $ |X|\ \le\ 10^5 $
- $ |Y|\ \le\ 10^5 $
- $ 0\ \lt\ R\ \le\ 10^5 $
- $ X,\ Y,\ R $ は高々小数第 $ 4 $ 位まで与えられる

### Sample Explanation 1

以下のような円になります。赤く印の付いた点が、この円の内部または周上にある格子点です。 !\[グラフ\](https://img.atcoder.jp/ghi/4f37b99cfbdbb337043b16d8ce64571c.png)

### Sample Explanation 2

$ X,\ Y,\ R $ には小数点が含まれないかもしれません。 円周上の格子点も数える対象に含むことに注意してください。

## 样例 #1

### 输入

```
0.2 0.8 1.1
```

### 输出

```
3
```

## 样例 #2

### 输入

```
100 100 1
```

### 输出

```
5
```

## 样例 #3

### 输入

```
42782.4720 31949.0192 99999.99
```

### 输出

```
31415920098
```



---

---
title: "[ABC191F] GCD or MIN"
layout: "post"
diff: 提高+/省选-
pid: AT_abc191_f
tag: []
---

# [ABC191F] GCD or MIN

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc191/tasks/abc191_f

黒板に $ N $ 個の整数 $ A_1,\ A_2,\ A_3,\ \dots,\ A_N $ が書かれています。  
 あなたは次の操作を $ N\ -\ 1 $ 回行います。

- 黒板に書かれている数を $ 2 $ つ選んで消す。消した数を $ x $ と $ y $ として、$ \gcd(x,\ y) $ と $ \min(x,\ y) $ のどちらか一方を黒板に書く

$ N\ -\ 1 $ 回の操作を終えた後、黒板にはただ一つの整数が残りますが、この整数として考えられるものはいくつありますか ?

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ A_1 $ $ A_2 $ $ A_3 $ $ \dots $ $ A_N $

## 输出格式

黒板に残る整数として考えられるものの個数を出力せよ。

## 说明/提示

### 制約

- $ 2\ \le\ N\ \le\ 2000 $
- $ 1\ \le\ A_i\ \le\ 10^9 $
- 入力は全て整数

### Sample Explanation 1

$ 3 $ と $ 6 $ が、最後に黒板に残る整数として考えられるものです。 例えば以下のような操作をすることで $ 3 $ が残ります。 - $ 9 $ と $ 12 $ を選んで黒板から消し、$ \gcd(9,\ 12)\ =\ 3 $ を黒板に書く - $ 6 $ と $ 3 $ を選んで黒板から消し、$ \min(6,\ 3)\ =\ 3 $ を黒板に書く また、以下のような操作をすることで $ 6 $ が残ります。 - $ 6 $ と $ 12 $ を選んで黒板から消し、$ \gcd(6,\ 12)\ =\ 6 $ を黒板に書く - $ 6 $ と $ 9 $ を選んで黒板から消し、$ \min(6,\ 9)\ =\ 6 $ を黒板に書く

### Sample Explanation 2

$ 2 $ が、黒板に残る数として考えられる唯一の数です。

### Sample Explanation 3

$ 1,\ 2,\ 3,\ 4,\ 6,\ 7,\ 27 $ が最後に黒板に残る整数として考えられるものです。

## 样例 #1

### 输入

```
3

6 9 12
```

### 输出

```
2
```

## 样例 #2

### 输入

```
4

8 2 12 6
```

### 输出

```
1
```

## 样例 #3

### 输入

```
7

30 28 33 49 27 37 48
```

### 输出

```
7
```



---

---
title: "[ABC193E] Oversleeping"
layout: "post"
diff: 提高+/省选-
pid: AT_abc193_e
tag: []
---

# [ABC193E] Oversleeping

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc193/tasks/abc193_e

街 $ A $ と街 $ B $ の間を往復する電車があります。 電車は時刻 $ 0 $ に街 $ A $ を出発した後、

- $ X $ 秒かけて街 $ B $ に移動
- 街 $ B $ で $ Y $ 秒停車
- $ X $ 秒かけて街 $ A $ に移動
- 街 $ A $ で $ Y $ 秒停車

を繰り返します。  
 より厳密には、これらは半開区間として扱います。すなわち、$ n\ =\ 0,\ 1,\ 2,\ \dots $ について、

- $ (2X\ +\ 2Y)n\ <\ =\ t\ <\ (2X\ +\ 2Y)n\ +\ X $ を満たす時刻 $ t $ には電車は街 $ B $ に移動している
- $ (2X\ +\ 2Y)n\ +\ X\ <\ =\ t\ <\ (2X\ +\ 2Y)n\ +\ X\ +\ Y $ を満たす時刻 $ t $ には電車は街 $ B $ で停車している
- $ (2X\ +\ 2Y)n\ +\ X\ +\ Y\ <\ =\ t\ <\ (2X\ +\ 2Y)n\ +\ 2X\ +\ Y $ を満たす時刻 $ t $ には電車は街 $ A $ に移動している
- $ (2X\ +\ 2Y)n\ +\ 2X\ +\ Y\ <\ =\ t\ <\ (2X\ +\ 2Y)(n\ +\ 1) $ を満たす時刻 $ t $ には電車は街 $ A $ で停車している

が満たされます。

高橋くんは電車に乗って時刻 $ 0 $ に街 $ A $ を出発し、街 $ B $ で電車を降りようと思っています。 高橋くんは時刻 $ 0 $ に街 $ A $ を出発した後、

- $ P $ 秒間眠っている
- $ Q $ 秒間起きている

を繰り返します。  
 これらも半開区間として扱います。すなわち、$ n\ =\ 0,\ 1,\ 2,\ \dots $ について、

- $ (P\ +\ Q)n\ <\ =\ t\ <\ (P\ +\ Q)n\ +\ P $ を満たす時刻 $ t $ には高橋くんは眠っている
- $ (P\ +\ Q)n\ +\ P\ <\ =\ t\ <\ (P\ +\ Q)(n\ +\ 1) $ を満たす時刻 $ t $ には高橋くんは起きている

が満たされます。

街 $ B $ に電車が停車しており、かつ、高橋くんが起きていれば高橋くんは街 $ B $ で電車を降りることができます。  
 高橋くんが街 $ B $ で電車を降りることができるか判定し、できる場合は、最短でいつになるか求めてください。  
 なお、この値はこの問題の制約下で整数になることが証明できます。

$ T $ 個のケースが与えられるので、それぞれについて答えを求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ T $ $ \rm\ case_1 $ $ \rm\ case_2 $ $ \hspace{9pt}\vdots $ $ \rm\ case_T $

各ケースは以下の形式で与えられる。

> $ X $ $ Y $ $ P $ $ Q $

## 输出格式

$ T $ 行出力せよ。  
 $ i $ 行目には、$ \rm\ case_i $ についてこの問題を解き、街 $ B $ で電車を降りられる時刻が存在する場合、そのような時刻のうち最小のものを整数で出力せよ。 街 $ B $ で電車を降りられる時刻が存在しない場合、`infinity` と出力せよ。

## 说明/提示

### 制約

- 入力は全て整数
- $ 1\ <\ =\ T\ <\ =\ 10 $
- $ 1\ <\ = X\ <\ =\ 10^9 $
- $ 1\ <\ = Y\ <\ =\ 500 $
- $ 1\ <\ = P\ <\ =\ 10^9 $
- $ 1\ <\ = Q\ <\ =\ 500 $

### Sample Explanation 1

$ [a,\ b) $ で区間 $ a\ <\ =\ t\ <\ b $ を表すことにします。 $ 1 $ 個目のケースでは、電車が街 $ B $ で停車している時刻は $ [5,\ 7),\ [19,\ 21),\ [33,\ 35),\ \dots $ 、 高橋くんが起きている時刻は $ [7,\ 13),\ [20,\ 26),\ [33,\ 39),\ \dots $ なので、時刻 $ 20 $ に初めて街 $ B $ で電車を降りることが出来ます。

## 样例 #1

### 输入

```
3

5 2 7 6

1 1 3 1

999999999 1 1000000000 1
```

### 输出

```
20

infinity

1000000000999999999
```



---

---
title: "[ABC194F] Digits Paradise in Hexadecimal"
layout: "post"
diff: 提高+/省选-
pid: AT_abc194_f
tag: []
---

# [ABC194F] Digits Paradise in Hexadecimal

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc194/tasks/abc194_f

この問題において、十六進表記では `0` ~ `9`, `A` ~ `F` を数字として扱い、`A` ~ `F` はそれぞれ十から十五を表すものとします。  
 また、特別の記述がない限り問題文中で扱われる数は全て十進表記されているものとします。

$ 1 $ 以上 $ N $ 以下の整数のうち、先頭に $ 0 $ のない十六進表記で書くとちょうど $ K $ 種類の数字が現れるようなものはいくつあるでしょうか ?  
 $ 10^9\ +\ 7 $ で割ったあまりを出力してください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ K $

$ N $ は十六進表記で与えられる。

## 输出格式

答えを $ 10^9\ +\ 7 $ で割ったあまりを出力せよ。

## 说明/提示

### 制約

- $ 1\ \le\ N\ \lt\ {16}^{2\ \times\ 10^5} $
- $ N $ は先頭が `0` でない十六進表記で与えられる
- $ 1\ \le\ K\ \le\ 16 $
- 入力に含まれる値は全て整数

### Sample Explanation 1

$ N $ は十六進表記で与えられているため、十進数に直すと $ 16 $ です。 $ 1 $ 以上 $ 16 $ 以下の整数を、先頭に $ 0 $ のない十六進表記で書くと下記のようになります。 - $ 1 $ から $ 15 $ まで : 十六進表記に直すと $ 1 $ 桁なので、出現する数字は $ 1 $ 種類である - $ 16 $ : 十六進表記に直すと $ 10 $ なので、出現する数字は $ 2 $ 種類である よって、十六進表記に直した時に出現する数字が $ 1 $ 種類なのは $ 15 $ 個です。

### Sample Explanation 2

出現する数字が $ 2 $ 種類なのは、$ 1 $ 以上 $ 255 $ 以下の $ 255 $ 個の整数のうち、十六進表記で $ 1,\ 2,\ 3,\ \dots,\ \mathrm{E},\ \mathrm{F},\ 11,\ 22,\ 33,\ \dots,\ \mathrm{EE},\ \mathrm{FF} $ と表される $ 15\ +\ 15\ =\ 30 $ 個を除いたものです。

### Sample Explanation 5

答えを $ 10^9\ +\ 7 $ で割った余りを出力してください。

## 样例 #1

### 输入

```
10 1
```

### 输出

```
15
```

## 样例 #2

### 输入

```
FF 2
```

### 输出

```
225
```

## 样例 #3

### 输入

```
100 2
```

### 输出

```
226
```

## 样例 #4

### 输入

```
1A8FD02 4
```

### 输出

```
3784674
```

## 样例 #5

### 输入

```
DEADBEEFDEADBEEEEEEEEF 16
```

### 输出

```
153954073
```



---

---
title: "[ABC195F] Coprime Present"
layout: "post"
diff: 提高+/省选-
pid: AT_abc195_f
tag: []
---

# [ABC195F] Coprime Present

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc195/tasks/abc195_f

あなたは $ A $ 以上 $ B $ 以下の整数が書かれたカードを各 $ 1 $ 枚、合計 $ B-A+1 $ 枚持っています。 この中から何枚かを選んで ($ 0 $ 枚でもよい) ペットのすぬけ君にプレゼントしようと考えています。

すぬけ君は、プレゼントされたカードたちについて、どの相異なる $ 2 $ 枚に書かれた数も互いに素であるときに喜び、そうでないとき悲しみます。

すぬけ君が喜ぶようなカードの組合せは何通りありますか？

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ A $ $ B $

## 输出格式

すぬけ君が喜ぶようなカードの組合せは何通りあるか出力せよ。 **なお、制約の条件下で答えは $ 2^{63} $ 未満になることが証明される。**

## 说明/提示

### 制約

- $ 1\ \leq\ A\ \leq\ B\ \leq\ 10^{18} $
- $ B-A\ \leq\ 72 $
- 入力は全て整数

### Sample Explanation 1

あなたは $ 2,3,4 $ が書かれたカードを $ 1 $ 枚ずつ持っています。すぬけ君が喜ぶようなカードの組合せは - $ \{\} $ - $ \{2\} $ - $ \{3\} $ - $ \{4\} $ - $ \{2,3\} $ - $ \{3,4\} $ の $ 6 $ 通りです。

### Sample Explanation 2

すぬけ君が喜ぶようなカードの組合せは - $ \{\} $ - $ \{1\} $ の $ 2 $ 通りです。

## 样例 #1

### 输入

```
2 4
```

### 输出

```
6
```

## 样例 #2

### 输入

```
1 1
```

### 输出

```
2
```

## 样例 #3

### 输入

```
123456789000 123456789050
```

### 输出

```
2125824
```



---

---
title: "[ABC197F] Construct a Palindrome"
layout: "post"
diff: 提高+/省选-
pid: AT_abc197_f
tag: []
---

# [ABC197F] Construct a Palindrome

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc197/tasks/abc197_f

$ N $ 頂点 $ M $ 辺の、単純とは限らない連結な無向グラフがあります。  
 辺 $ i $ は頂点 $ A_i $ と頂点 $ B_i $ を結んでおり、文字 $ C_i $ が書かれています。  
 頂点 $ 1 $ から頂点 $ N $ へのパス (同じ辺や頂点を複数回通っても構わない) を $ 1 $ つ選び、通る辺に書かれている文字を順に並べて文字列を作ります。  
 この文字列が回文になることはあるかを判定し、あるならばそのような回文の長さとして考えられる最小値を求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ M $ $ A_1 $ $ B_1 $ $ C_1 $ $ A_2 $ $ B_2 $ $ C_2 $ $ A_3 $ $ B_3 $ $ C_3 $ $ \hspace{25pt}\ \vdots $ $ A_M $ $ B_M $ $ C_M $

## 输出格式

作る文字列が回文になることがあるならば、そのような回文の長さの最小値を、ないならば `-1` を出力せよ。

## 说明/提示

### 制約

- $ 2\ \le\ N\ \le\ 1000 $
- $ 1\ \le\ M\ \le\ 1000 $
- $ 1\ \le\ A_i\ \le\ N $
- $ 1\ \le\ B_i\ \le\ N $
- $ C_i $ は英小文字
- 与えられるグラフは連結である

### Sample Explanation 1

辺 $ 1,\ 2,\ 3,\ 1,\ 2,\ 4,\ 5,\ 6,\ 7,\ 8 $ の順に通ると、出来上がる文字列は `abcabbacba` となり、回文となります。 これより短い回文を作ることはできないので、答えは $ 10 $ です。

### Sample Explanation 2

辺 $ 2,\ 3,\ 4,\ 5,\ 5 $ の順に通ると `aabaa` という文字列を作ることができ、これは回文です。 同じ辺や頂点を複数回通っても構わないことに注意してください。

### Sample Explanation 3

出来上がる文字列が回文となることはありません。

## 样例 #1

### 输入

```
8 8

1 2 a

2 3 b

1 3 c

3 4 b

4 5 a

5 6 c

6 7 b

7 8 a
```

### 输出

```
10
```

## 样例 #2

### 输入

```
4 5

1 1 a

1 2 a

2 3 a

3 4 b

4 4 a
```

### 输出

```
5
```

## 样例 #3

### 输入

```
3 4

1 1 a

1 2 a

2 3 b

3 3 b
```

### 输出

```
-1
```



---

---
title: "[ABC199F] Graph Smoothing"
layout: "post"
diff: 提高+/省选-
pid: AT_abc199_f
tag: []
---

# [ABC199F] Graph Smoothing

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc199/tasks/abc199_f

$ N $ 頂点 $ M $ 辺の単純無向グラフがあります。頂点には $ 1 $ から $ N $ までの、辺には $ 1 $ から $ M $ までの番号がついています。  
 辺 $ i $ は頂点 $ X_i $ と頂点 $ Y_i $ を結んでいます。また、頂点 $ i $ には最初整数 $ A_i $ が書かれています。  
 あなたは $ K $ 回にわたって以下の操作を行います。

- $ M $ 本ある辺の中から、一様ランダムかつ他の選択と独立に $ 1 $ 本選ぶ。その辺が結ぶ $ 2 $ 頂点に書かれている数の平均を $ x $ として、その $ 2 $ 頂点に書かれている数を両方 $ x $ で置き換える。

各頂点 $ i $ について、$ K $ 回の操作後に頂点 $ i $ に書かれている数の期待値を求め、注記の通り $ \bmod\ (10^9\ +\ 7) $ で出力してください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ M $ $ K $ $ A_1 $ $ A_2 $ $ A_3 $ $ \dots $ $ A_N $ $ X_1 $ $ Y_1 $ $ X_2 $ $ Y_2 $ $ X_3 $ $ Y_3 $ $ \hspace{15pt}\ \vdots $ $ X_M $ $ Y_M $

## 输出格式

$ N $ 行にわたって出力せよ。  
 $ i $ 行目には、$ K $ 回の操作後に頂点 $ i $ に書かれている数の期待値を、注記に従って $ \bmod\ (10^9\ +\ 7) $ で出力せよ。

## 说明/提示

### 注記

有理数を出力する際は、まずその有理数を分数 $ \frac{y}{x} $ として表してください。  
 ここで、$ x,y $ は整数であり、$ x $ は $ 10^9+7 $ で割り切れてはなりません (この問題の制約下で、そのような表現は必ず可能です)。  
 そして、$ xz\ \equiv\ y\ \pmod\ {10^9+7} $ を満たすような $ 0 $ 以上 $ 10^9+6 $ 以下の唯一の整数 $ z $ を出力してください。

### 制約

- $ 2\ \le\ N\ \le\ 100 $
- $ 1\ \le\ M\ \le\ \frac{N(N\ -\ 1)}{2} $
- $ 0\ \le\ K\ \le\ 10^9 $
- $ 0\ \le\ A_i\ \le\ 10^9 $
- $ 1\ \le\ X_i\ \le\ N $
- $ 1\ \le\ Y_i\ \le\ N $
- 与えられるグラフは単純
- 入力に含まれる値は全て整数である

### Sample Explanation 1

\- 唯一の操作で辺 $ 1 $ が選ばれた場合 : 頂点 $ 1,\ 2,\ 3 $ に書かれている数はそれぞれ $ 2,\ 2,\ 5 $ となります - 唯一の操作で辺 $ 2 $ が選ばれた場合 : 頂点 $ 1,\ 2,\ 3 $ に書かれている数はそれぞれ $ 4,\ 1,\ 4 $ となります 従って、操作後に頂点 $ 1,\ 2,\ 3 $ に書かれている数の期待値はそれぞれ $ 3,\ \frac{3}{2},\ \frac{9}{2} $ となります。 これらを注記に従って $ \bmod\ (10^9\ +\ 7) $ の表現に変換すると、それぞれ $ 3,\ 500000005,\ 500000008 $ となります。

### Sample Explanation 2

\- $ 1 $ 回目の操作で辺 $ 1 $ が選ばれた場合 頂点 $ 1,\ 2,\ 3 $ に書かれている数はそれぞれ $ 30,\ 30,\ 36 $ となります - $ 2 $ 回目の操作で辺 $ 1 $ が選ばれた場合 : 頂点 $ 1,\ 2,\ 3 $ に書かれている数はそれぞれ $ 30,\ 30,\ 36 $ となります - $ 2 $ 回目の操作で辺 $ 2 $ が選ばれた場合 : 頂点 $ 1,\ 2,\ 3 $ に書かれている数はそれぞれ $ 33,\ 30,\ 33 $ となります - $ 1 $ 回目の操作で辺 $ 2 $ が選ばれた場合 頂点 $ 1,\ 2,\ 3 $ に書かれている数はそれぞれ $ 24,\ 48,\ 24 $ となります - $ 2 $ 回目の操作で辺 $ 1 $ が選ばれた場合 : 頂点 $ 1,\ 2,\ 3 $ に書かれている数はそれぞれ $ 36,\ 36,\ 24 $ となります - $ 2 $ 回目の操作で辺 $ 2 $ が選ばれた場合 : 頂点 $ 1,\ 2,\ 3 $ に書かれている数はそれぞれ $ 24,\ 48,\ 24 $ となります これら $ 4 $ 通りのケースが各 $ \frac{1}{4} $ の確率で起こるので、頂点 $ 1,\ 2,\ 3 $ に最終的に書かれている数の期待値はそれぞれ $ \frac{123}{4},\ \frac{144}{4}\ (=36),\ \frac{117}{4} $ となります。

## 样例 #1

### 输入

```
3 2 1

3 1 5

1 2

1 3
```

### 输出

```
3

500000005

500000008
```

## 样例 #2

### 输入

```
3 2 2

12 48 36

1 2

1 3
```

### 输出

```
750000036

36

250000031
```

## 样例 #3

### 输入

```
4 5 1000

578 173 489 910

1 2

2 3

3 4

4 1

1 3
```

### 输出

```
201113830

45921509

67803140

685163678
```



---

---
title: "[ABC200E] Patisserie ABC 2"
layout: "post"
diff: 提高+/省选-
pid: AT_abc200_e
tag: []
---

# [ABC200E] Patisserie ABC 2

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc200/tasks/abc200_e

「ABC洋菓子店」で働くパティシエである高橋君は、ケーキを作って AtCoder Beginner Contest 200 を祝うことにしました。

高橋君の作るケーキは、「綺麗さ」「おいしさ」「人気度」の $ 3 $ つのパラメータをもち、それぞれのパラメータは $ 1 $ 以上 $ N $ 以下の整数で表されます。

高橋君は、「綺麗さ」が $ i $ 、「おいしさ」が $ j $ 、「人気度」が $ k $ であるケーキを、全ての組 $ (i,j,k)\ (1\ \le\ i,j,k\ \le\ N) $ に対して $ 1 $ つずつ作りました。  
 その後、高橋君は、できた $ N^3 $ 個のケーキを以下の順序で並べました。

- 「綺麗さ」+「おいしさ」+「人気度」が小さいものを、より左に並べる。
- ここまでで順序がつかなければ、「綺麗さ」が小さいものを、より左に並べる。
- ここまでで順序がつかなければ、「おいしさ」が小さいものを、より左に並べる。

このとき、左から $ K $ 番目にあるケーキの各パラメータの値を求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ K $

## 输出格式

答えを「綺麗さ」「おいしさ」「人気度」の順に空白区切りで $ 3 $ つの整数として出力せよ。

## 说明/提示

### 制約

- 入力は全て整数
- $ 1\ \le\ N\ \le\ 10^6 $
- $ 1\ \le\ K\ \le\ N^3 $

### Sample Explanation 1

各ケーキの各パラメータの値を (「綺麗さ」,「おいしさ」,「人気度」) と書くと、ケーキは左から以下の順に並びます。 $ (1,1,1),(1,1,2),(1,2,1),(2,1,1),(1,2,2),(2,1,2),(2,2,1),(2,2,2) $

### Sample Explanation 2

入力される値が大きくなることもあります。

## 样例 #1

### 输入

```
2 5
```

### 输出

```
1 2 2
```

## 样例 #2

### 输入

```
1000000 1000000000000000000
```

### 输出

```
1000000 1000000 1000000
```

## 样例 #3

### 输入

```
9 47
```

### 输出

```
3 1 4
```



---

---
title: "[ABC203F] Weed"
layout: "post"
diff: 提高+/省选-
pid: AT_abc203_f
tag: []
---

# [ABC203F] Weed

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc203/tasks/abc203_f

高橋君と青木君の家の庭には草 $ 1 $, 草 $ 2 $, $ \ldots $, 草 $ N $ の $ N $ 本の草が生えており、草 $ i $ の高さは $ A_i $ です。 高橋君と青木君は次の方法で庭の草抜きを行う事にしました。

- まず、青木君が高々 $ K $ 本の草を選んで抜く。
- その後、高橋君が次の操作を庭の草がすべて抜けるまで繰り返す。
  
  
  - 残っている草のうち高さが最大のものの高さを $ H $ とする。残っている草のうち、高さが $ \frac{H}{2} $ より高いものを一斉に抜く。

青木君は、高橋君の操作回数が最小となるようにした上で、自分の抜く本数を最小にしたいと考えています。 このときの高橋君の操作回数と青木君の抜く草の本数を求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ K $ $ A_1 $ $ A_2 $ $ \ldots $ $ A_N $

## 输出格式

高橋君の操作回数と青木君の抜く草の本数をこの順に空白区切りで出力せよ。

## 说明/提示

### 制約

- $ 1\ \leq\ N\ \leq\ 2\times\ 10^5 $
- $ 0\ \leq\ K\ \leq\ N $
- $ 1\ \leq\ A_i\ \leq\ 10^9 $
- 入力は全て整数である。

### Sample Explanation 1

例えば青木君が草 $ 4 $ (高さ $ 9 $) を選んで抜いたとき、残りの草の中で最も高いものは草 $ 3 $ であり、その高さは $ 4 $ です。 $ \frac{4}{2}=2 $ であり、$ 2\ <\ 3 $, $ 2\ <\ 4 $ より $ 1 $ 回目の操作で高橋君は草 $ 2 $ と草 $ 3 $ のみを抜くことができます。その後、 $ 2 $ 回目の操作で草 $ 1 $ を抜き、高橋君は $ 2 $ 回で操作を終えることができます。 一方で、青木君がどの草を $ 1 $ 本選んだとしても高橋君は $ 1 $ 回で操作を終えることはできません。 また、もし青木君が $ 1 $ 本も抜かなかったとすると高橋君は $ 3 $ 回操作する必要があるため、青木君は高橋君の操作回数を最小にするために最低 $ 1 $ 本は抜かなくてはなりません。

### Sample Explanation 2

青木君が全ての草を抜いたとき高橋君は操作を行う必要がなく、明らかにこのときが最小です。

## 样例 #1

### 输入

```
4 1

2 3 4 9
```

### 输出

```
2 1
```

## 样例 #2

### 输入

```
3 3

2 3 5
```

### 输出

```
0 3
```

## 样例 #3

### 输入

```
9 8

137 55 56 60 27 28 133 56 55
```

### 输出

```
1 4
```



---

---
title: "[ABC204F] Hanjo 2"
layout: "post"
diff: 提高+/省选-
pid: AT_abc204_f
tag: []
---

# [ABC204F] Hanjo 2

## 题目描述

有一个宽$H$($1≤H≤6$),长$W$($1≤W≤10^{12}$)的房间,现在用两种地板砖铺地板:长2,宽1的长方形地板砖和边长为1的正方形地板砖.

长方形地板砖可以旋转成长1,宽2的长方形地板砖.

求有多少种方法可以铺满这个房间.

## 输入格式

两个数$H$,$W$

## 输出格式

一个数,表示有多少种方法,结果模998244353

## 样例 #1

### 输入

```
2 2
```

### 输出

```
7
```

## 样例 #2

### 输入

```
3 3
```

### 输出

```
131
```

## 样例 #3

### 输入

```
5 100
```

### 输出

```
379944232
```



---

---
title: "[ABC205E] White and Black Balls"
layout: "post"
diff: 提高+/省选-
pid: AT_abc205_e
tag: []
---

# [ABC205E] White and Black Balls

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc205/tasks/abc205_e

白いボール $ N $ 個と黒いボール $ M $ 個を横一列に並べる方法であって、次の条件を満たすものは何通りありますか？

- 各 $ i\ \,\ (1\ \leq\ i\ \leq\ N\ +\ M) $ について左から $ i $ 個のボールのうち白いものの個数を $ w_i $、黒いものの個数を $ b_i $ とおいたとき、全ての $ i $ について $ w_i\ \leq\ b_i\ +\ K $ が成り立つ。

ただし、答えは非常に大きくなることがあるので、$ (10^9\ +\ 7) $ で割ったあまりを求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ M $ $ K $

## 输出格式

答えを出力せよ。$ (10^9\ +\ 7) $ で割ったあまりを求めることに注意すること。

## 说明/提示

### 制約

- $ 0\ \leq\ N,\ M\ \leq\ 10^6 $
- $ 1\ \leq\ N\ +\ M $
- $ 0\ \leq\ K\ \leq\ N $
- 入力は全て整数である。

### Sample Explanation 1

白いボール $ 2 $ 個と黒いボール $ 3 $ 個を並べる方法は $ 10 $ 通りあり、白いボールを `w`、黒いボールを `b` で表すと以下のようになります。 `wwbbb` `wbwbb` `wbbwb` `wbbbw` `bwwbb` `bwbwb` `bwbbw` `bbwwb` `bbwbw` `bbbww` このうち、条件を満たさないのは `wwbbb` のみです。左から $ 2 $ 個のボールのうち白いものは $ 2 $ 個、黒いものは $ 0 $ 個ありますが、$ 2\ >\ 0\ +\ K\ =\ 1 $ となっています。

### Sample Explanation 2

条件を満たす並べ方が存在しないこともあります。

### Sample Explanation 3

$ (10^9\ +\ 7) $ で割ったあまりを出力することに注意してください。

## 样例 #1

### 输入

```
2 3 1
```

### 输出

```
9
```

## 样例 #2

### 输入

```
1 0 0
```

### 输出

```
0
```

## 样例 #3

### 输入

```
1000000 1000000 1000000
```

### 输出

```
192151600
```



---

---
title: "[ABC205F] Grid and Tokens"
layout: "post"
diff: 提高+/省选-
pid: AT_abc205_f
tag: []
---

# [ABC205F] Grid and Tokens

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc205/tasks/abc205_f

$ H $ 行 $ W $ 列のグリッドがあり、上から $ r $ 行目、左から $ c $ 列目のマスを $ (r,\ c) $ と表します。

$ N $ 個の駒があり、$ i\ \,\ (1\ \leq\ i\ \leq\ N) $ 個目の駒に対しては

- $ A_i\ \leq\ r\ \leq\ C_i $ かつ $ B_i\ \leq\ c\ \leq\ D_i $ を満たすいずれか一つのマス $ (r,\ c) $ に置く
- 置かない

のいずれかを選択することができます。ここで、二つの駒が同じ行や同じ列に存在するような置き方をすることはできません。

最大で何個の駒を置くことができるでしょうか？

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ H $ $ W $ $ N $ $ A_1 $ $ B_1 $ $ C_1 $ $ D_1 $ $ A_2 $ $ B_2 $ $ C_2 $ $ D_2 $ $ \vdots $ $ A_N $ $ B_N $ $ C_N $ $ D_N $

## 输出格式

答えを出力せよ。

## 说明/提示

### 制約

- $ 1\ \leq\ H,\ W,\ N\ \leq\ 100 $
- $ 1\ \leq\ A_i\ \leq\ C_i\ \leq\ H $
- $ 1\ \leq\ B_i\ \leq\ D_i\ \leq\ W $
- 入力は全て整数である。

### Sample Explanation 1

一つ目の駒をマス $ (1,\ 1) $ に、二つ目の駒をマス $ (2,\ 2) $ に置き、三つ目の駒は置かないようにすることで、$ 2 $ 個置くことができます。$ 3 $ 個置くことは不可能であるので、$ 2 $ を出力します。

## 样例 #1

### 输入

```
2 3 3

1 1 2 2

1 2 2 3

1 1 1 3
```

### 输出

```
2
```

## 样例 #2

### 输入

```
5 5 3

1 1 5 5

1 1 4 4

2 2 3 3
```

### 输出

```
3
```



---

---
title: "[ABC206F] Interval Game 2"
layout: "post"
diff: 提高+/省选-
pid: AT_abc206_f
tag: []
---

# [ABC206F] Interval Game 2

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc206/tasks/abc206_f

$ T $ 個のテストケースについて、以下の問題を解いてください。

$ N $ 個の半開区間 $ [L_i,R_i) $ ($ 1\ \le\ i\ \le\ N $) があり、 Alice と Bob がこの区間を使って次のようなゲームをします。

- Alice から始めて、以下の操作を交互に行う。
  - $ N $ 個の区間の中から、既に選ばれているどの区間とも共有点をもたない区間を $ 1 $ つ選ぶ。

先に操作を行えなくなった方が負けで、もう片方のプレイヤーが勝ちます。  
 双方のプレイヤーが勝利に対して最善を尽くした場合、どちらが勝つことになりますか？

 半開区間とは？半開区間 $ [X,Y) $ とは、 $ X $ 以上 $ Y $ 未満のすべての実数からなる区間です。

## 输入格式

入力は標準入力から与えられる。入力の $ 1 $ 行目は次の形式である。

> $ T $

その後、$ T $ 個のテストケースが続く。各テストケースは以下の形式で与えられる。

> $ N $ $ L_1 $ $ R_1 $ $ L_2 $ $ R_2 $ $ \vdots $ $ L_N $ $ R_N $

## 输出格式

計 $ T $ 行出力せよ。  
 そのうち $ i $ 行目には、 $ i $ 番目のテストケースについて、 Alice が勝つなら `Alice` 、 Bob が勝つなら `Bob` と出力せよ。

## 说明/提示

### 制約

- 入力は全て整数
- $ 1\ \le\ T\ \le\ 20 $
- $ 1\ \le\ N\ \le\ 100 $
- $ 1\ \le\ L_i\ <\ R_i\ \le\ 100 $

### Sample Explanation 1

この入力には、 $ 5 $ つのテストケースが含まれます。 $ 1 $ つ目のテストケースについて、例えば以下のようにゲームが進行します。 - Alice が区間 $ [12,53) $ を選択する。 - Bob が区間 $ [53,98) $ を選択する。 ゲームに用いる区間は半開区間なので、 $ [12,53),[53,98) $ は共有点を持たない。 - Alice はこれ以上操作を行えず、負ける。 Bob はゲームに勝つ。 このテストケースについて、上記の手順が必ずしも両者にとって最善とは限りませんが、両者が最善を尽くした場合勝利するのは Bob であることが示せます。 $ 2 $ つ目のテストケースのように、ひとつのテストケースに同じ区間が複数含まれる場合もあります。

## 样例 #1

### 输入

```
5

3

53 98

8 43

12 53

10

4 7

5 7

3 7

4 5

5 8

6 9

4 8

5 10

1 9

5 10

2

58 98

11 29

6

79 83

44 83

38 74

49 88

18 45

64 99

1

5 9
```

### 输出

```
Bob

Alice

Bob

Alice

Alice
```



---

---
title: "[ABC207D] Congruence Points"
layout: "post"
diff: 提高+/省选-
pid: AT_abc207_d
tag: []
---

# [ABC207D] Congruence Points

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc207/tasks/abc207_d

要素数が共に $ N $ であるような二次元平面上の点の集合 $ S=\{(a_1,b_1),(a_2,b_2),\ldots,(a_N,b_N)\} $ と $ T=\{(c_1,d_1),(c_2,d_2),\ldots,(c_N,d_N)\} $ が与えられます。

$ S $ に対して以下の操作を $ 0 $ 回以上任意の順に好きなだけ繰り返すことで、$ S $ と $ T $ を一致させられるかを判定してください。

- 実数 $ p\ (0\ \lt\ p\ \lt\ 360) $ を定め、 $ S $ に含まれる全ての点を、原点を中心に時計回りに $ p $ 度回転させる。
- 実数 $ q,r $ を定める。$ S $ に含まれる全ての点を、$ x $ 軸方向に $ q $, $ y $ 軸方向に $ r $ 移動させる。$ q $, $ r $ の値域に制約はなく、特に正/負/零のいずれになってもよい。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ a_1 $ $ b_1 $ $ a_2 $ $ b_2 $ $ \hspace{0.6cm}\vdots $ $ a_N $ $ b_N $ $ c_1 $ $ d_1 $ $ c_2 $ $ d_2 $ $ \hspace{0.6cm}\vdots $ $ c_N $ $ d_N $

## 输出格式

問題文中の操作によって $ S $ と $ T $ を一致させられるなら `Yes` を、一致させられないなら `No` を出力せよ。

## 说明/提示

### 制約

- $ 1\ \leq\ N\ \leq\ 100 $
- $ -10\ \leq\ a_i,b_i,c_i,d_i\ \leq\ 10 $
- $ i\ \neq\ j $ なら $ (a_i,b_i)\ \neq\ (a_j,b_j) $
- $ i\ \neq\ j $ なら $ (c_i,d_i)\ \neq\ (c_j,d_j) $
- 入力は全て整数

### Sample Explanation 1

$ S $ に含まれる点を赤で、$ T $ に含まれる点を緑で塗った場合、与えられる点集合は以下の図の通りになります。 !\[\](https://img.atcoder.jp/ghi/39ad67d4e10490f509f252a1f0e4935b.png) この場合、以下の手順によって $ S $ を $ T $ に一致させることができます。 1. $ S $ に含まれる全ての点を、原点を中心に時計回りに $ 270 $ 度回転させる。 2. $ S $ に含まれる全ての点を、$ x $ 軸方向に $ 3 $, $ y $ 軸方向に $ 0 $ 移動させる。

### Sample Explanation 2

入力に対応する図は以下の通りです。 !\[\](https://img.atcoder.jp/ghi/02c4ca4a8329110dc131b37720283d2a.png) $ S $ と $ T $ は $ y $ 軸に対して線対称ですが、問題文中に書かれているような回転操作、移動操作によって $ S $ と $ T $ を一致させることはできません。

## 样例 #1

### 输入

```
3

0 0

0 1

1 0

2 0

3 0

3 1
```

### 输出

```
Yes
```

## 样例 #2

### 输入

```
3

1 0

1 1

3 0

-1 0

-1 1

-3 0
```

### 输出

```
No
```

## 样例 #3

### 输入

```
4

0 0

2 9

10 -2

-6 -7

0 0

2 9

10 -2

-6 -7
```

### 输出

```
Yes
```

## 样例 #4

### 输入

```
6

10 5

-9 3

1 -5

-6 -5

6 9

-9 0

-7 -10

-10 -5

5 4

9 0

0 -10

-10 -2
```

### 输出

```
Yes
```



---

---
title: "[ABC207F] Tree Patrolling"
layout: "post"
diff: 提高+/省选-
pid: AT_abc207_f
tag: []
---

# [ABC207F] Tree Patrolling

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc207/tasks/abc207_f

$ N $ 頂点の木があり、各頂点には $ 1 $ から $ N $ までの番号が振られています。また、$ i $ 本目の辺は頂点 $ u_i $ と頂点 $ v_i $ を双方向に結んでいます。

この木の持ち主であるあなたは、いくつかの頂点 ($ 0 $ 個でもよい) を選んで高橋くんを配置し、木の警備をさせることにしました。頂点 $ x $ に配置された高橋くんは、$ x $ と直接辺で結ばれた頂点、及び $ x $ 自身を警備します。

高橋くんを配置する頂点の選び方は $ 2^N $ 通りありますが、そのうち $ 1 $ 人以上の高橋くんに警備された頂点の個数がちょうど $ K $ 個となるような選び方はいくつありますか？

$ K=0,1,\ldots,N $ について答えを求め、$ (10^9+7) $ で割ったあまりを出力してください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ u_1 $ $ v_1 $ $ u_2 $ $ v_2 $ $ \hspace{0.6cm}\vdots $ $ u_{N-1} $ $ v_{N-1} $

## 输出格式

$ N+1 $ 行に渡って出力せよ。$ i $ 行目には、$ K=i-1 $ とした場合の答えを出力すること。

## 说明/提示

### 制約

- $ 1\ \leq\ N\ \leq\ 2000 $
- $ 1\ \leq\ u_i\ \lt\ v_i\ \leq\ N $
- 与えられるグラフは木
- 入力は全て整数

### Sample Explanation 1

高橋くんを配置する頂点の選び方は、以下の $ 8 $ 通りです。 - どの頂点にも高橋くんを配置しない。いずれの頂点も高橋くんに警備されていない状態となる。 - 頂点 $ 1 $ に高橋くんを配置する。全ての頂点が高橋くんに警備された状態となる。 - 頂点 $ 2 $ に高橋くんを配置する。頂点 $ 1 $, $ 2 $ の $ 2 $ つが高橋くんに警備された状態となる。 - 頂点 $ 3 $ に高橋くんを配置する。頂点 $ 1 $, $ 3 $ の $ 2 $ つが高橋くんに警備された状態となる。 - 頂点 $ 1 $ と頂点 $ 2 $ に高橋くんを配置する。全ての頂点が高橋くんに警備された状態となる。 - 頂点 $ 1 $ と頂点 $ 3 $ に高橋くんを配置する。全ての頂点が高橋くんに警備された状態となる。 - 頂点 $ 2 $ と頂点 $ 3 $ に高橋くんを配置する。全ての頂点が高橋くんに警備された状態となる。 - 全ての頂点に高橋くんを配置する。全ての頂点が高橋くんに警備された状態となる。

## 样例 #1

### 输入

```
3

1 3

1 2
```

### 输出

```
1

0

2

5
```

## 样例 #2

### 输入

```
5

1 3

4 5

1 5

2 3
```

### 输出

```
1

0

2

5

7

17
```

## 样例 #3

### 输入

```
10

6 10

1 8

2 7

5 6

3 8

3 4

7 10

4 9

2 8
```

### 输出

```
1

0

3

8

15

32

68

110

196

266

325
```



---

---
title: "[ABC208E] Digit Products"
layout: "post"
diff: 提高+/省选-
pid: AT_abc208_e
tag: []
---

# [ABC208E] Digit Products

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc208/tasks/abc208_e

$ N $ 以下の正の整数のうち、各桁の数字の積が $ K $ 以下であるものは何個ありますか？

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ K $

## 输出格式

条件を満たす整数の個数を出力せよ。

## 说明/提示

### 制約

- $ 1\ \leq\ N\ \leq\ 10^{18} $
- $ 1\ \leq\ K\ \leq\ 10^9 $
- 入力は全て整数である。

### Sample Explanation 1

$ 13 $ 以下の正の整数のうち、各桁の数字の積が $ 2 $ 以下であるものは $ 1,2,10,11,12 $ の $ 5 $ つです。

### Sample Explanation 2

$ 100 $ 以下の正の整数のうち、$ 99 $ 以外のものが条件を満たします。

### Sample Explanation 3

答えが $ 32 $ bit 整数に収まらない可能性があることに注意してください。

## 样例 #1

### 输入

```
13 2
```

### 输出

```
5
```

## 样例 #2

### 输入

```
100 80
```

### 输出

```
99
```

## 样例 #3

### 输入

```
1000000000000000000 1000000000
```

### 输出

```
841103275147365677
```



---

---
title: "[ABC209E] Shiritori"
layout: "post"
diff: 提高+/省选-
pid: AT_abc209_e
tag: []
---

# [ABC209E] Shiritori

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc209/tasks/abc209_e

高橋辞書には $ N $ 個の単語が載っており、$ i\,\ (1\ \leq\ i\ \leq\ N) $ 番目の単語は $ s_i $ です。

高橋君と青木君は高橋辞書を使って $ 3 $ しりとりをします。 $ 3 $ しりとりのルールは以下です。

- 高橋君と青木君は、高橋君から始めて交互に単語を言い合っていく。
- 各プレーヤーは前の人が言った単語の最後の $ 3 $ 文字で始まる単語を言わなければならない。例えば、前の人が `Takahashi` と言った場合、次の人は `ship`、`shield` などを言うことができ、`Aoki`、`sing`、`his` などを言うことはできない。
- 大文字と小文字は区別される。例えば、`Takahashi` のあとに `ShIp` を言うことはできない。
- 言う単語がなくなった方が負ける。
- 高橋辞書に載っていない単語を言うことはできない。
- 同じ単語は何度でも使ってよい。

各 $ i\,\ (1\ \leq\ i\ \leq\ N) $ について、高橋君が $ 3 $ しりとりを単語 $ s_i $ から始めたときどちらが勝つかを判定してください。ただし、二人とも最善に行動するとします。具体的には、自分が負けないことを最優先し、その次に相手を負かすことを優先します。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ s_1 $ $ s_2 $ $ \vdots $ $ s_N $

## 输出格式

$ N $ 行出力せよ。$ i\,\ (1\ \leq\ i\ \leq\ N) $ 行目には、高橋君が $ 3 $ しりとりを単語 $ s_i $ から始めたとき、高橋君が勝つなら `Takahashi`、青木君が勝つなら `Aoki`、しりとりが永遠に続き勝敗が決まらないなら `Draw` と出力せよ。

## 说明/提示

### 制約

- $ N $ は $ 1 $ 以上 $ 2\ \times\ 10^5 $ 以下の整数
- $ s_i $ は英小文字と英大文字のみからなる長さ $ 3 $ 以上 $ 8 $ 以下の文字列

### Sample Explanation 1

高橋君が `abcd` から始めたとき、次に青木君が `bcda` と言って高橋君は言う単語がなくなります。よって青木君が勝つので `Aoki` と出力してください。 高橋君が `bcda` から始めたとき、次に青木君は言う単語がなくなります。よって高橋君が勝つので `Takahashi` と出力してください。 高橋君が `ada` から始めたとき、二人とも `ada` を繰り返すのでしりとりが終わることはありません。よって `Draw` と出力してください。同じ単語を何度でも使用できることに注意してください。

## 样例 #1

### 输入

```
3

abcd

bcda

ada
```

### 输出

```
Aoki

Takahashi

Draw
```

## 样例 #2

### 输入

```
1

ABC
```

### 输出

```
Draw
```

## 样例 #3

### 输入

```
5

eaaaabaa

eaaaacaa

daaaaaaa

eaaaadaa

daaaafaa
```

### 输出

```
Takahashi

Takahashi

Takahashi

Aoki

Takahashi
```



---

---
title: "[ABC209F] Deforestation"
layout: "post"
diff: 提高+/省选-
pid: AT_abc209_f
tag: []
---

# [ABC209F] Deforestation

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc209/tasks/abc209_f

$ N $ 本の木が左右一列に並んでおり、左から $ i\,\ (1\ \leq\ i\ \leq\ N) $ 本目の木 $ i $ の高さは $ H_i $ です。

あなたは、好きな順番でこれら $ N $ 本の木を全て伐採します。具体的には、 $ (1,2,\ \ldots,\ N) $ の並び替えによって得られるある順列 $ P $ について、$ i=1,2,3,...,N $ の順に、

- $ H_{P_i-1}+H_{P_i}+H_{P_i+1} $ のコストを支払った後、木 $ P_i $ を伐採する。すなわち、$ H_{P_i} $ を $ 0 $ にする。

という操作を行います。ただし、$ H_0=0,H_{N+1}=0 $ とします。

言い換えると、ある木を伐採するのにかかるコストは木を伐採する直前での、その木と両隣の木の高さの総和となります。

支払うコストの総和が最小となるような $ P $ の個数を求めてください。答えは非常に大きくなる可能性があるので、$ (10^9+7) $ で割った余りを出力してください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ H_1 $ $ H_2 $ $ \ldots $ $ H_N $

## 输出格式

支払うコストの総和が最小となるような $ P $ の個数を $ (10^9+7) $ で割った余りを出力せよ。

## 说明/提示

### 制約

- $ 1\ \leq\ N\ \leq\ 4000 $
- $ 1\ \leq\ H_i\ \leq\ 10^9 $
- 入力は全て整数

### Sample Explanation 1

支払うコストの総和が最小となるような $ P $ は、$ (1,3,2) $ と $ (3,1,2) $ の $ 2 $ つです。以下、木の伐採の例を示します。 $ P=(1,3,2) $ のとき - 最初に木 $ 1 $ を伐採する。この時に支払うコストは $ H_0+H_1+H_2=6 $ である。 - 次に木 $ 3 $ を伐採する。この時に支払うコストは $ H_2+H_3+H_4=6 $ である。 - 最後に木 $ 2 $ を伐採する。この時に支払うコストは $ H_1+H_2+H_3=2 $ である。 支払うコストの総和は $ 14 $ となります。

### Sample Explanation 3

$ (10^9+7) $ で割った余りを出力することに注意してください。

## 样例 #1

### 输入

```
3

4 2 4
```

### 输出

```
2
```

## 样例 #2

### 输入

```
3

100 100 100
```

### 输出

```
6
```

## 样例 #3

### 输入

```
15

804289384 846930887 681692778 714636916 957747794 424238336 719885387 649760493 596516650 189641422 25202363 350490028 783368691 102520060 44897764
```

### 输出

```
54537651
```



---

---
title: "[ABC211F] Rectilinear Polygons"
layout: "post"
diff: 提高+/省选-
pid: AT_abc211_f
tag: []
---

# [ABC211F] Rectilinear Polygons

## 题目描述

## 题目大意

给出平面的 $N$ 个简单多边形，对于每个多边形，其每一条边都平行于 $X$ 轴或 $Y$ 轴，每一个角都为 $90$ 度或 $270$ 度，如图所示。

现在有 $Q$ 次询问，每次给出一个有序整数对 $(X,Y)$ ，求点 $(X+0.5,Y+0.5)$ 被多少个多边形覆盖。

![](https://img.atcoder.jp/ghi/5fccf008dddd93f10ebfc7f13d04a0e0.png)

## 输入格式

第一行输入一个整数 $N$ 。

后面 $1$ 至 $N+1$ 行，第 $i$ 行先输入一个整数 $M_i$ ，再输入 $2\times M_i$ 个整数：$x_{i,1},y_{i,1},x_{i,2},y_{i,2},...,x_{i,M_i},y_{i,M_i}$ 。其相邻两点所连成的线段即为多边形的边。

接下来读入一个数 $Q$ 。表示询问 $Q$ 次。

后面 $Q$ 行每行有两个数 $X_i,Y_i$ ，表示询问点 $(X_i+0.5,Y_i+0.5)$ 被多少个多边形覆盖。

## 输出格式

共 $Q$ 行，每一行有一个整数表示答案。

### 样例解释
1.如上图

2.如下图
![](https://img.atcoder.jp/ghi/1c97f791a2aadcf5637b1f10736fb820.png)

## 说明/提示

- $1\le N \le 10^5$

- $4\le M_i \le 10^5$
- $\forall M_i,i\isin [1,N],M_i$ 为偶数
- $\sum M_i\le 4\times 10^5$
- $0\le x_{i,j},X_i,y_{i,j},Y_i \le 10^5$
- $1\le Q \le 10^5$
- 对于 $j=1,3,5... M_i-1$ ，都有 $x_{i,j}=x_{i,j+1}$ 
- 对于 $j=2,4,6... M_i$ ，都有 $y_{i,j}=y_{i,j+1}$ （特殊的, $y_{i,M_i}=y_{1,1}$ ）
- 对于任意一个给出多边形，没有重合的顶点。即若 $k \not= j$ ，则 $(x_{i,j},y_{i,j}) \not= (x_{i,k},y_{i,k})$
- 输入的所有数据均为整数。

## 样例 #1

### 输入

```
3

4

1 2 1 4 3 4 3 2

4

2 5 2 3 5 3 5 5

4

5 6 5 5 3 5 3 6

3

1 4

2 3

4 5
```

### 输出

```
0

2

1
```

## 样例 #2

### 输入

```
2

4

12 3 12 5 0 5 0 3

12

1 1 1 9 10 9 10 0 4 0 4 6 6 6 6 2 8 2 8 7 2 7 2 1

4

2 6

4 4

6 3

1 8
```

### 输出

```
0

2

1

1
```



---

---
title: "[ABC212F] Greedy Takahashi"
layout: "post"
diff: 提高+/省选-
pid: AT_abc212_f
tag: []
---

# [ABC212F] Greedy Takahashi

## 题目描述

### 题目大意

有 $n$ 座城市和 $m$ 辆公交车，第 $i$ 辆公交车会在 $S_i+0.5$ 时从城市 $A_i$ 出发，在 $T_i+0.5$ 时到达城市 $B_i$。

Takahashi 想要在这些城市中旅行。具体的说，当他在 $t$ 时刻时位于城市 $p$ 时，他会按照如下方案移动：

若存在在 $t$ 时刻后从城市 $p$ 出发的公交车，那么选择其中离 $t$ 时刻最近的一辆并乘坐。否则停留在城市 $p$ 不移动。

现在 Takahashi 想要问你 $Q$ 个问题，每个问题的格式如下：

如果 Takahashi 在 $X$ 时刻从城市 $Y$ 出发，那么 $Z$ 时刻时 Takahashi 位于哪辆公交车上或者哪个城市中？

## 输入格式

第一行三个正整数 $n,m,Q$。

接下来 $m$ 行，每行四个正整数 $A_i,B_i,S_i,T_i$，描述一辆公交车。

接下来 $Q$ 行，每行三个正整数 $X,Y,Z$，描述一个询问。

## 输出格式

输出共 $Q$ 行，每行一个或两个正整数。

如果是城市，输出城市编号，如果是公交车，输出其起点和终点的城市编号。

Translated by \_Ponder_

## 样例 #1

### 输入

```
3 2 3

1 2 1 3

2 3 3 5

1 1 5

2 2 3

1 3 2
```

### 输出

```
2 3

2

3
```

## 样例 #2

### 输入

```
8 10 10

4 3 329982133 872113932

6 8 101082040 756263297

4 7 515073851 793074419

8 7 899017043 941751547

5 7 295510441 597348810

7 2 688716395 890599546

6 1 414221915 748470452

6 4 810915860 904512496

3 1 497469654 973509612

4 1 307142272 872178157

374358788 4 509276232

243448834 6 585993193

156350864 4 682491610

131643541 8 836902943

152874385 6 495945159

382276121 1 481368090

552433623 2 884584430

580376205 2 639442239

108790644 7 879874292

883275610 1 994982498
```

### 输出

```
4

6 1

4 1

8

6 1

1

2

2

7 2

1
```



---

---
title: "[ABC212G] Power Pair"
layout: "post"
diff: 提高+/省选-
pid: AT_abc212_g
tag: []
---

# [ABC212G] Power Pair

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc212/tasks/abc212_g

素数 $ P $ が与えられます。

以下の条件を満たす整数の組 $ (x,\ y) $ はいくつありますか？

- $ 0\ \leq\ x\ \leq\ P-1 $
- $ 0\ \leq\ y\ \leq\ P-1 $
- ある正整数 $ n $ が存在して、$ x^n\ \equiv\ y\ \pmod{P} $ を満たす

ただし答えは非常に大きくなる可能性があるので、$ 998244353 $ で割った余りを出力してください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ P $

## 输出格式

答えを $ 998244353 $ で割った余りを出力せよ。

## 说明/提示

### 制約

- $ 2\ \leq\ P\ \leq\ 10^{12} $
- $ P $ は素数

### Sample Explanation 1

$ (x,\ y)\ =\ (0,\ 0),\ (1,\ 1),\ (2,\ 1),\ (2,\ 2) $ の $ 4 $ 組が条件を満たします。

## 样例 #1

### 输入

```
3
```

### 输出

```
4
```

## 样例 #2

### 输入

```
11
```

### 输出

```
64
```

## 样例 #3

### 输入

```
998244353
```

### 输出

```
329133417
```



---

---
title: "[ABC215G] Colorful Candies 2"
layout: "post"
diff: 提高+/省选-
pid: AT_abc215_g
tag: []
---

# [ABC215G] Colorful Candies 2

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc215/tasks/abc215_g

$ N $ 個のキャンディが左右一列に並んでいます。  
 それぞれのキャンディは、色 $ 1 $、色 $ 2 $、$ \ldots $ 、色 $ 10^9 $ の、$ 10^9 $ 種類の色のうちいずれかの色をしています。  
 $ i\ =\ 1,\ 2,\ \ldots,\ N $ について、左から $ i $ 番目のキャンディの色は色 $ c_i $ です。

高橋君は並んでいる $ N $ 個のキャンディのうち $ K $ 個を選び、選んだ $ K $ 個のキャンディをすべてもらいます。  
 ここで、$ N $ 個のキャンディから $ K $ 個を選ぶ組み合わせの個数は二項係数を用いて $ \binom{N}{K} $ 個と表せますが、 高橋君は $ \binom{N}{K} $ 通りの選び方のうちいずれか一つを等確率でランダムに選びます。

高橋君はいろいろな色のキャンディを食べたいので、もらうキャンディに含まれる色の種類数が多いほどうれしい気持ちになります。  
 $ K\ =\ 1,\ 2,\ \ldots,\ N $ のそれぞれの場合について、高橋君がもらうキャンディに含まれる色の種類数の期待値を求めてください。  
 ここで、求める答えは有理数となることが証明できます。答えとなる有理数を注記で述べるように $ \bmod\ 998244353 $ で出力してください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ c_1 $ $ c_2 $ $ \ldots $ $ c_N $

## 输出格式

$ N $ 行出力せよ。$ i $ 行目には $ K\ =\ i $ の場合における高橋君がもらうキャンディに含まれる色の種類数の期待値を、注記に述べるように $ \bmod\ 998244353 $で出力せよ。

## 说明/提示

### 注記

有理数を出力する際は、まずその有理数を分数 $ \frac{y}{x} $ として表してください。ここで、$ x,\ y $ は整数であり、$ x $ は $ 998244353 $ で割り切れてはなりません（この問題の制約下で、そのような表現は必ず可能です）。そして、$ xz\ \equiv\ y\ \pmod{998244353} $ を満たすような $ 0 $ 以上 $ 998244352 $ 以下の唯一の整数 $ z $ を出力してください。

### 制約

- $ 1\ \leq\ N\ \leq\ 5\ \times\ 10^4 $
- $ 1\ \leq\ c_i\ \leq\ 10^9 $
- 入力はすべて整数

### Sample Explanation 1

$ K\ =\ 1 $ のとき、高橋君がもらうキャンディの組み合わせは、「 $ 1 $ 番目のみ」「 $ 2 $ 番目のみ」「 $ 3 $ 番目のみ」の $ 3 $ 通りがあります。 いずれの場合も、含まれる色は $ 1 $ 種類です。よって、含まれる色の種類数の期待値は $ 1 $ となります。 $ K\ =\ 2 $ のとき、高橋君がもらうキャンディの組み合わせは、「 $ 1 $ 番目と $ 2 $ 番目」「 $ 2 $ 番目と $ 3 $ 番目」「 $ 1 $ 番目と $ 3 $ 番目」の $ 3 $ 通りがあります。 - 「 $ 1 $ 番目と $ 2 $ 番目」をもらう場合、含まれる色は $ 2 $ 種類 - 「 $ 2 $ 番目と $ 3 $ 番目」をもらう場合、含まれる色は $ 1 $ 種類 - 「 $ 1 $ 番目と $ 3 $ 番目」をもらう場合、含まれる色は $ 2 $ 種類 となりますから、含まれる色の種類数の期待値は、$ \frac{1}{3}\ \cdot\ 2\ +\ \frac{1}{3}\ \cdot\ 1\ +\ \frac{1}{3}\ \cdot\ 2\ =\ \frac{5}{3} $ です。 注記に述べたように、$ \bmod\ 998244353 $ で出力することに注意してください。 $ K\ =\ 3 $ のとき、高橋君がもらうキャンディの組み合わせは、「 $ 1,\ 2,\ 3 $ 番目のすべて」の $ 1 $ 通りのみであり、含まれる色は $ 2 $ 種類です。 よって、含まれる色の種類数の期待値は $ 2 $ となります。

## 样例 #1

### 输入

```
3

1 2 2
```

### 输出

```
1

665496237

2
```

## 样例 #2

### 输入

```
11

3 1 4 1 5 9 2 6 5 3 5
```

### 输出

```
1

725995895

532396991

768345657

786495555

937744700

574746754

48399732

707846002

907494873

7
```



---

---
title: "[ABC217G] Groups"
layout: "post"
diff: 提高+/省选-
pid: AT_abc217_g
tag: []
---

# [ABC217G] Groups

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc217/tasks/abc217_g

正の整数 $ N,M $ が与えられます。$ k=1,\ldots,N $ のそれぞれについて、次の問題を解いてください。

- 問題：$ 1 $ から $ N $ の番号がついた $ N $ 人を、空でない $ k $ 個のグループに分けます。 ただし、番号を $ M $ で割ったあまりが等しい人は同じグループになることができません。  
   そのようなグループ分けの方法は何通りありますか？  
   答えは非常に大きくなる可能性があるので $ 998244353 $ で割ったあまりを求めてください。

ここで、グループ分けが異なるとは、一方では人 $ x,y $ が同じグループであり、他方では異なるグループであるような $ (x,y) $ が存在することを指すものとします。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ M $

## 输出格式

$ N $ 行出力せよ。

$ i $ 行目には $ k=i $ の問題の答えを出力せよ。

## 说明/提示

### 制約

- $ 2\ \leq\ N\ \leq\ 5000 $
- $ 2\ \leq\ M\ \leq\ N $
- 入力は全て整数である

### Sample Explanation 1

番号を $ 2 $ で割ったあまりが等しい人、すなわち、人 $ 1 $ と $ 3 $、人 $ 2 $ と $ 4 $ を同じグループにすることはできません。 - $ 1 $ 個のグループにすることはできません。 - $ 2 $ 個のグループにする方法は $ \{\{1,2\},\{3,4\}\},\{\{1,4\},\{2,3\}\} $ の $ 2 $ 通りです。 - $ 3 $ 個のグループにする方法は $ \{\{1,2\},\{3\},\{4\}\},\{\{1,4\},\{2\},\{3\}\},\{\{1\},\{2,3\},\{4\}\},\{\{1\},\{2\},\{3,4\}\} $ の $ 4 $ 通りです。 - $ 4 $ 個のグループにする方法は $ \{\{1\},\{2\},\{3\},\{4\}\} $ の $ 1 $ 通りです。

### Sample Explanation 2

自由にグループ分けすることができます。

### Sample Explanation 3

答えを $ 998244353 $ で割ったあまりを求めてください。

## 样例 #1

### 输入

```
4 2
```

### 输出

```
0

2

4

1
```

## 样例 #2

### 输入

```
6 6
```

### 输出

```
1

31

90

65

15

1
```

## 样例 #3

### 输入

```
20 5
```

### 输出

```
0

0

0

331776

207028224

204931064

814022582

544352515

755619435

401403040

323173195

538468102

309259764

722947327

162115584

10228144

423360

10960

160

1
```



---

---
title: "[ABC218G] Game on Tree 2"
layout: "post"
diff: 提高+/省选-
pid: AT_abc218_g
tag: []
---

# [ABC218G] Game on Tree 2

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc218/tasks/abc218_g

$ N $ 頂点の木があり、各頂点には $ 1 $ から $ N $ までの番号が振られています。また、$ i\,(1\ \leq\ i\ \leq\ N-1) $ 本目の辺は頂点 $ u_i $ と頂点 $ v_i $ を結んでおり、頂点 $ i\,(1\ \leq\ i\ \leq\ N) $ には偶数 $ A_i $ が書かれています。太郎君と次郎君がこの木と $ 1 $ つの駒を使ってゲームをします。

はじめ、駒は頂点 $ 1 $ に置かれています。二人は太郎君から始めて交互に、駒を現在置かれている頂点と直接辺で結ばれた頂点に移動させます。ただし、駒が一度訪れた頂点に移動させることはできません。駒を移動させることができなくなった時点でゲームが終了します。

太郎君はゲームが終了するまでに駒が訪れた頂点（頂点 $ 1 $ を含む）に書かれた数の（多重）集合の中央値を最大化、次郎君は最小化したいです。両者が最適に行動するとき、駒が訪れた頂点に書かれた数の集合の中央値を求めてください。

 中央値とは 大きさ $ K $ の数の（多重）集合の中央値は以下のように定義されます。

- $ K $ が奇数のとき、小さい方から $ \frac{K+1}{2} $ 番目の値
- $ K $ が偶数のとき、小さい方から $ \frac{K}{2} $ 番目の値と $ \frac{K}{2}+1 $ 番目の値の平均値
 
 例えば、$ \{\ 2,2,4\ \} $ の中央値は $ 2 $ 、$ \{\ 2,4,6,6\} $ の中央値は $ 5 $ です。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ A_1 $ $ A_2 $ $ \ldots $ $ A_N $ $ u_1 $ $ v_1 $ $ u_2 $ $ v_2 $ $ \vdots $ $ u_{N-1} $ $ v_{N-1} $

## 输出格式

両者が最適に行動するとき、駒が訪れた頂点に書かれた数の（多重）集合の中央値を出力せよ。

## 说明/提示

### 制約

- $ 2\ \leq\ N\ \leq\ 10^5 $
- $ 2\ \leq\ A_i\ \leq\ 10^9 $
- $ A_i $ は偶数
- $ 1\ \leq\ u_i\ <\ v_i\ \leq\ N $
- 与えられるグラフは木
- 入力は全て整数

### Sample Explanation 1

両者が最適に行動するとき、ゲームは以下のように進行します。 - 太郎君が駒を頂点 $ 1 $ から頂点 $ 5 $ に移動させる - 次郎君が駒を頂点 $ 5 $ から頂点 $ 4 $ に移動させる - 太郎君が駒を頂点 $ 4 $ から頂点 $ 3 $ に移動させる - 次郎君は駒を動かせないのでゲームが終了する 駒が訪れた頂点に書かれた数の集合は $ \{2,10,8,6\} $ となるので、中央値である $ 7 $ を出力します。

### Sample Explanation 2

両者が最適に行動するとき、ゲームは以下のように進行します。 - 太郎君が駒を頂点 $ 1 $ から頂点 $ 4 $ に移動させる - 次郎君は駒を動かせないのでゲームが終了する 駒が訪れた頂点に書かれた数の集合は $ \{6,10\} $ となるので、中央値である $ 8 $ を出力します。

## 样例 #1

### 输入

```
5

2 4 6 8 10

4 5

3 4

1 5

2 4
```

### 输出

```
7
```

## 样例 #2

### 输入

```
5

6 4 6 10 8

1 4

1 2

1 5

1 3
```

### 输出

```
8
```

## 样例 #3

### 输入

```
6

2 2 6 4 6 6

1 2

2 3

4 6

2 5

2 6
```

### 输出

```
2
```



---

---
title: "[ABC221F] Diameter set"
layout: "post"
diff: 提高+/省选-
pid: AT_abc221_f
tag: []
---

# [ABC221F] Diameter set

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc221/tasks/abc221_f

$ N $ 頂点からなる木が与えられます。 頂点は $ 1 $ , $ 2 $ , $ \ldots $ , $ N $ と番号付けられており、 $ 1\leq\ i\leq\ N-1 $ について、$ i $ 本目の辺は頂点 $ U_i $ と頂点 $ V_i $ を結んでいます。 木の直径を $ D $ とするとき、木の頂点のうち $ 2 $ 点以上を選んで赤く塗る方法であって、 赤く塗られたどの頂点の間の距離も $ D $ であるようなものの数を $ 998244353 $ で割った余りを求めてください。

ただし、木の $ 2 $ 頂点の間の距離は一方から他方へ移動するときに用いる辺の本数の最小値であり、 木の直径は任意の $ 2 $ 頂点の間の距離の最大値として定められます。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ U_1 $ $ V_1 $ $ U_2 $ $ V_2 $ $ \vdots $ $ U_{N-1} $ $ V_{N-1} $

## 输出格式

答えを出力せよ。

## 说明/提示

### 制約

- $ 2\ \leq\ N\ \leq\ 2\times\ 10^5 $
- $ 1\ \leq\ U_i,V_i\ \leq\ N $
- $ U_i\ \neq\ V_i $
- 入力は全て整数である。
- 与えられるグラフは木である。

### Sample Explanation 1

与えられた木は $ 5 $ 頂点からなり、直径は $ 3 $ です。 $ 2 $ 頂点の組であって、その間の距離が $ 3 $ であるようなものは $ (2,5) $ , $ (3,5) $ しか存在しないため、 条件をみたす塗り方は $ \lbrace\ 2,5\rbrace $ と $ \lbrace\ 3,5\rbrace $ の $ 2 $ 通りとなります。 $ \lbrace\ 2,3,5\rbrace $ は頂点 $ 2 $ と頂点 $ 3 $ の間の距離が $ 2 $ であるため条件をみたさないことに注意してください。

### Sample Explanation 2

直径は $ 2 $ であり、条件をみたす塗り方は $ \lbrace\ 2,3\rbrace $ , $ \lbrace\ 2,4\rbrace $ , $ \lbrace\ 3,4\rbrace $ , $ \lbrace\ 2,3,4\rbrace $ の $ 4 $ 通りとなります。

## 样例 #1

### 输入

```
5

1 2

1 3

1 4

4 5
```

### 输出

```
2
```

## 样例 #2

### 输入

```
4

1 2

1 3

1 4
```

### 输出

```
4
```



---

---
title: "[ABC222G] 222"
layout: "post"
diff: 提高+/省选-
pid: AT_abc222_g
tag: []
---

# [ABC222G] 222

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc222/tasks/abc222_g

$ 2,22,222,2222,\ldots $ という数列があります。この数列の第 $ i $ 項は、全ての桁が $ 2 $ である $ i $ 桁の整数です。

この数列に初めて $ K $ の倍数が登場するのは何項目ですか？ 存在しない場合は代わりに `-1` と答えてください。

$ T $ 個のケースが与えられるので、それぞれについて答えてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ T $ $ \text{case}_1 $ $ \text{case}_2 $ $ \vdots $ $ \text{case}_T $

各ケースは以下の形式で与えられる。

> $ K $

## 输出格式

$ T $ 行出力せよ。$ i $ 行目には $ \text{case}_i $ の答えを出力せよ。

## 说明/提示

### 制約

- $ 1\ \leq\ T\ \leq\ 200 $
- $ 1\ \leq\ K\ \leq\ 10^8 $
- 入力に含まれる値は全て整数である

### Sample Explanation 1

$ 4 $ 個のケースが与えられています。 - $ 2 $ は $ 1 $ の倍数です - $ 2,22,222,2222,22222 $ は $ 7 $ の倍数ではありませんが、$ 222222 $ は $ 7 $ の倍数です - $ 2,22,\ldots $ が $ 10 $ の倍数になることはありません

## 样例 #1

### 输入

```
4

1

7

10

999983
```

### 输出

```
1

6

-1

999982
```



---

---
title: "[ABC223G] Vertex Deletion"
layout: "post"
diff: 提高+/省选-
pid: AT_abc223_g
tag: []
---

# [ABC223G] Vertex Deletion

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc223/tasks/abc223_g

$ N $ 頂点の木が与えられます。頂点には $ 1,2,\ldots\ ,N $ の番号がついており、$ i\,(1\ \leq\ i\ \leq\ N-1) $ 本目の辺は頂点 $ u_i $ と頂点 $ v_i $ を結んでいます。

以下の条件を満たす整数 $ i\,(1\ \leq\ i\ \leq\ N) $ の個数を求めてください。

- 元の木から頂点 $ i $ およびそれに接続する全ての辺を削除して得られるグラフの最大マッチングの大きさが、元の木の最大マッチングの大きさに等しい。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ u_1 $ $ v_1 $ $ u_2 $ $ v_2 $ $ \vdots $ $ u_{N-1} $ $ v_{N-1} $

## 输出格式

答えを出力せよ。

## 说明/提示

### 制約

- $ 2\ \leq\ N\ \leq\ 2\ \times\ 10^5 $
- $ 1\ \leq\ u_i\ <\ v_i\ \leq\ N $
- 与えられるグラフは木
- 入力は全て整数

### Sample Explanation 1

元の木の最大マッチングの大きさは $ 1 $ です。 頂点 $ 1 $ およびそれに接続する全ての辺を削除して得られるグラフの最大マッチングの大きさは $ 1 $、 頂点 $ 2 $ およびそれに接続する全ての辺を削除して得られるグラフの最大マッチングの大きさは $ 0 $、 頂点 $ 3 $ およびそれに接続する全ての辺を削除して得られるグラフの最大マッチングの大きさは $ 1 $ です。$ i=1,3 $ の $ 2 $ つが条件を満たすので、$ 2 $ を出力します。

## 样例 #1

### 输入

```
3

1 2

2 3
```

### 输出

```
2
```

## 样例 #2

### 输入

```
2

1 2
```

### 输出

```
0
```

## 样例 #3

### 输入

```
6

2 5

3 5

1 4

4 5

4 6
```

### 输出

```
4
```



---

---
title: "[ABC224G] Roll or Increment"
layout: "post"
diff: 提高+/省选-
pid: AT_abc224_g
tag: []
---

# [ABC224G] Roll or Increment

## 题目描述

#### 题意
有一个 $N$ 面的骰子，每个骰子都有相等的概率随机出现 $1$ 到 $N$ 之间的整数目。 

在下文中，我们称骰子 "掷出 " $X$ ，是指骰子的上面有一个整数 $X$ 。 
最初，骰子的放置方式是掷出一个整数 $S$ 。
您可以对这些骰子进行 "以下两种操作中的任意一种"，次数不限（甚至可以是零次）。

 - 支付 $A$ 元，掷出的骰子值增加 $1$。 也就是说，当骰子掷出的原数值是 $X$ 时，骰子掷出的数值变更为 $X + 1$ 。 如果操作前掷出的骰子是 $N$ ，则无法执行此操作。
 - 支付 $B$ 圆并重新掷骰子。 掷出的骰子以相等的概率随机变为 $1$ 到 $N$ 之间的任意整数。

考虑通过上述操作将骰子从掷出 $S$ 的初始状态变为掷出 $T$ 的状态。 

输出采取最优策略时的成本的期望值。

## 输入格式

通过标准输入法输入，格式如下
第一行五个整数， $N, S, T, A, B$ 。

## 输出格式

输出成本的期望值，若误差小于等于 $10^{-5}$ ，则视为正确答案。

## 样例 #1

### 输入

```
5 2 4 10 4
```

### 输出

```
15.0000000000000000
```

## 样例 #2

### 输入

```
10 6 6 1 2
```

### 输出

```
0.0000000000000000
```

## 样例 #3

### 输入

```
1000000000 1000000000 1 1000000000 1000000000
```

### 输出

```
1000000000000000000.0000000000000000
```



---

---
title: "[ABC226F] Score of Permutations"
layout: "post"
diff: 提高+/省选-
pid: AT_abc226_f
tag: []
---

# [ABC226F] Score of Permutations

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc226/tasks/abc226_f

$ (1,2,\ \dots,\ N) $ を並び替えた長さ $ N $ の順列 $ P\ =\ (p_1,\ p_2,\ \dots,\ p_N) $ に対して、 $ P $ のスコア $ S(P) $ を次のように定めます。

- $ N $ 人の人とすぬけ君がいて、$ N $ 人の人には $ 1,2,\dots,N $ の番号がついています。はじめ、人 $ i $ $ (1\ \leq\ i\ \leq\ N) $ はボール $ i $ を持っています。  
   すぬけ君が叫ぶたびに、$ i\ \neq\ p_i $ であるようなすべての人 $ i $ は人 $ p_i $ に持っているボールを同時に渡します。  
   すぬけ君は、$ 1 $ 回以上叫んだ後にすべての人 $ i $ がボール $ i $ を持っている状態になると叫ぶのをやめます。  
   すぬけ君が叫ぶのをやめるまでに叫んだ回数が順列のスコアとなります。ここでスコアは有限の値を取ることが保証されます。

$ P $ としてあり得るものは $ N! $ 通りありますが、それらのスコアを $ K $ 乗した値の総和を $ 998244353 $ で割ったあまりを計算してください。

- 厳密に言い換えると、$ (1,2,\ \dots,\ N) $ を並び替えた長さ $ N $ の順列全体の集合を $ S_N $ として
  
  $ \displaystyle\ \left(\sum_{P\ \in\ S_N}\ S(P)^K\ \right)\ \bmod\ {998244353} $
  
  を計算してください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ K $

## 输出格式

$ \displaystyle\ \left(\sum_{P\ \in\ S_N}\ S(P)^K\ \right)\ \bmod\ {998244353} $ を出力せよ。

## 说明/提示

### 制約

- $ 2\ \leq\ N\ \leq\ 50 $
- $ 1\ \leq\ K\ \leq\ 10^4 $
- 入力はすべて整数である。

### Sample Explanation 1

$ N\ =\ 2 $ のとき $ P $ としてあり得る順列は $ (1,2),(2,1) $ の $ 2 $ つです。 順列 $ (1,2) $ のスコアは次のように決まります。 - はじめ人 $ 1 $ はボール $ 1 $ を、人 $ 2 $ はボール $ 2 $ を持っています。 すぬけ君が $ 1 $ 回目に叫んだ後に、人 $ 1 $ はボール $ 1 $ を、人 $ 2 $ はボール $ 2 $ を持っています。 このとき、すべての人が自身の番号と同じ番号が書かれたボールを持っているので、すぬけ君は叫ぶのをやめます。 よってスコアは $ 1 $ となります。 順列 $ (2,1) $ のスコアは次のように決まります。 - はじめ人 $ 1 $ はボール $ 1 $ を、人 $ 2 $ はボール $ 2 $ を持っています。 すぬけ君が $ 1 $ 回目に叫んだ後に、人 $ 1 $ はボール $ 2 $ を、人 $ 2 $ はボール $ 1 $ を持っています。 すぬけ君が $ 2 $ 回目に叫んだ後に、人 $ 1 $ はボール $ 1 $ を、人 $ 2 $ はボール $ 2 $ を持っています。 このとき、すべての人が自身の番号と同じ番号が書かれたボールを持っているので、すぬけ君は叫ぶのをやめます。 よってスコアは $ 2 $ となります。 よって $ 1^2\ +\ 2^2\ =\ 5 $ がこの問題の答えになります。

### Sample Explanation 2

すべての順列とスコアの組を列挙すると以下のようになります。 - 順列 : $ (1,2,3) $, スコア : $ 1 $ - 順列 : $ (1,3,2) $, スコア : $ 2 $ - 順列 : $ (2,1,3) $, スコア : $ 2 $ - 順列 : $ (2,3,1) $, スコア : $ 3 $ - 順列 : $ (3,1,2) $, スコア : $ 3 $ - 順列 : $ (3,2,1) $, スコア : $ 2 $ よって $ 1^3\ +\ 2^3\ +\ 2^3\ +\ 3^3\ +\ 3^3\ +\ 2^3\ =\ 79 $ を出力します。

## 样例 #1

### 输入

```
2 2
```

### 输出

```
5
```

## 样例 #2

### 输入

```
3 3
```

### 输出

```
79
```

## 样例 #3

### 输入

```
50 10000
```

### 输出

```
77436607
```



---

---
title: "[ABC226G] The baggage"
layout: "post"
diff: 提高+/省选-
pid: AT_abc226_g
tag: []
---

# [ABC226G] The baggage

## 题目描述

有质量为 $1 \sim 5$ 的重物，质量为 $i(1 \leq i \leq 5)$ 的重物有 $A_i$ 个；同时有可搬运的最大质量不超过 $i(1 \leq i \leq 5)$ 的人 $B_i$ 个。 问是否存在一种分配方式，使所有重物均可被一次性搬运。

## 输入格式

本题具有多组测试数据。

第 $1$ 行为一个整数 $T$，表示本测试点共有 $T$ 组测试数据。

第 $2i (1 ≤ i ≤ T)$ 行为 $5$ 个整数，分别为 $A_{1}$，$A_{2}$，$A_{3}$，$A_{4}$，$A_{5}$。

第 $2i+1 (1 ≤ i ≤ T)$ 行为 $5$ 个整数，分别为 $B_{1}$，$B_{2}$，$B_{3}$，$B_{4}$，$B_{5}$。

## 输出格式

输出共 $T$ 行，若 $i (1 ≤ i ≤ T)$ 组测试数据中所有重物均可被一次性搬运，则在第 $i$ 行输出 `Yes` ，否则输出 `No`。

## 样例 #1

### 输入

```
3

5 1 0 0 1

0 0 0 2 1

0 3 0 0 0

0 0 2 0 0

10000000000000000 0 0 0 0

0 0 0 0 2000000000000000
```

### 输出

```
Yes

No

Yes
```



---

---
title: "[ABC227E] Swap"
layout: "post"
diff: 提高+/省选-
pid: AT_abc227_e
tag: []
---

# [ABC227E] Swap

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc227/tasks/abc227_e

`K`, `E`, `Y` のみからなる文字列 $ S $ が与えられます。

$ S $ の隣接する $ 2 $ 文字を入れ替える操作を $ K $ 回まで行えるとき、作ることができる文字列は何種類ありますか？

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ S $ $ K $

## 输出格式

答えを出力せよ。

## 说明/提示

### 制約

- $ 2\ \leq\ |S|\ \leq\ 30 $
- $ 0\ \leq\ K\ \leq\ 10^9 $
- $ S $ は `K`, `E`, `Y` のみからなる

### Sample Explanation 1

`KEY` に対して $ 1 $ 回以下の操作を行うことで得られる文字列は `KEY`, `EKY`, `KYE` の $ 3 $ 種類です。

### Sample Explanation 2

`KKEE` に対して $ 2 $ 回以下の操作を行うことで得られる文字列は `KKEE`, `KEKE`, `EKKE`, `KEEK` の $ 4 $ 種類です。

## 样例 #1

### 输入

```
KEY

1
```

### 输出

```
3
```

## 样例 #2

### 输入

```
KKEE

2
```

### 输出

```
4
```

## 样例 #3

### 输入

```
KKEEYY

1000000000
```

### 输出

```
90
```



---

---
title: "[ABC227F] Treasure Hunting"
layout: "post"
diff: 提高+/省选-
pid: AT_abc227_f
tag: []
---

# [ABC227F] Treasure Hunting

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc227/tasks/abc227_f

縦 $ H $ 行、横 $ W $ 列のマス目があります。上から $ i $ 行目、左から $ j $ 列目のマスを $ (i,j) $ と書くことにします。$ (i,j) $ には整数 $ A_{i,j} $ が書かれています。

高橋君は $ (1,1) $ を出発し、$ (H,W) $ にたどり着くまで、$ 1 $ つ右あるいは $ 1 $ つ下のマスへ移動することを繰り返します。ただし、マス目の外に出ることはできません。

この時、移動のコストを以下のように定義します。

> 通った $ H+W-1 $ 個のマスに書かれた整数のうち大きい方 $ K $ 個の和

コストとしてありうる最小値を求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ H $ $ W $ $ K $ $ A_{1,1} $ $ A_{1,2} $ $ \ldots $ $ A_{1,W} $ $ A_{2,1} $ $ A_{2,2} $ $ \ldots $ $ A_{2,W} $ $ \vdots $ $ A_{H,1} $ $ A_{H,2} $ $ \ldots $ $ A_{H,W} $

## 输出格式

答えを出力せよ。

## 说明/提示

### 制約

- $ 1\ \leq\ H,W\ \leq\ 30 $
- $ 1\ \leq\ K\ <\ H+W $
- $ 1\ \leq\ A_{i,j}\ \leq\ 10^9 $
- 入力は全て整数

### Sample Explanation 1

移動の方法は一通りのみであり、通ったマスに書かれた整数は大きい方から順に $ 5 $、$ 4 $、$ 3 $ となるので、$ 9(=5+4) $ を出力します。

### Sample Explanation 2

$ (1,1) $、$ (1,2) $、$ (2,2) $ の順に通った時コストが最小となります。

## 样例 #1

### 输入

```
1 3 2

3 4 5
```

### 输出

```
9
```

## 样例 #2

### 输入

```
2 2 1

3 2

4 3
```

### 输出

```
3
```

## 样例 #3

### 输入

```
3 5 3

4 7 8 6 4

6 7 3 10 2

3 8 1 10 4
```

### 输出

```
21
```



---

---
title: "[ABC228F] Stamp Game"
layout: "post"
diff: 提高+/省选-
pid: AT_abc228_f
tag: []
---

# [ABC228F] Stamp Game

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc228/tasks/abc228_f

縦 $ H $ 行、横 $ W $ 列のマス目があります。上から $ i $ 行目、左から $ j $ 列目のマスをマス $ (i,\ j) $ と呼びます。  
 $ 1\ \leq\ i\ \leq\ H $ かつ $ 1\ \leq\ j\ \leq\ W $ を満たす整数の組 $ (i,\ j) $ それぞれについて、マス $ (i,\ j) $ には正整数 $ A_{i,\ j} $ が書かれています。また、すべてのマスは白色に塗られています。

高橋君は、縦 $ h_1 $ 行、横 $ w_1 $ 列の長方形の黒いスタンプを持っており、青木君は、縦 $ h_2 $ 行、横 $ w_2 $ 列の長方形の白いスタンプを持っています。  
 $ 2 $ 人はこれらのスタンプとマス目を使って対戦ゲームをします。

まず高橋君が、持っている黒いスタンプを $ 1 $ 回使って、マス目の縦 $ h_1 $ 行、横 $ w_1 $ 列の長方形領域を黒色に塗りつぶします。  
 すなわち、$ 1\ \leq\ i\ \leq\ H\ -\ h_1\ +\ 1 $ かつ $ 1\ \leq\ j\ \leq\ W\ -\ w_1\ +\ 1 $ を満たす整数の組 $ (i,\ j) $ を一つ選び、 $ i\ \leq\ r\ \leq\ i\ +\ h_1\ -\ 1 $ かつ $ j\ \leq\ c\ \leq\ j\ +\ w_1\ -\ 1 $ を満たすすべてのマス $ (r,\ c) $ を黒色に塗りつぶします。

次に青木君が、持っている白いスタンプを $ 1 $ 回使って、マス目の縦 $ h_2 $ 行、横 $ w_2 $ 列の長方形領域を白色に塗りつぶします。  
 すなわち、$ 1\ \leq\ i\ \leq\ H\ -\ h_2\ +\ 1 $ かつ $ 1\ \leq\ j\ \leq\ W\ -\ w_2\ +\ 1 $ を満たす整数の組 $ (i,\ j) $ を一つ選び、 $ i\ \leq\ r\ \leq\ i\ +\ h_2\ -\ 1 $ かつ $ j\ \leq\ c\ \leq\ j\ +\ w_2\ -\ 1 $ を満たすすべてのマス $ (r,\ c) $ を白色に塗りつぶします。  
 このとき、青木君が白色に塗るマスがすでに高橋君によって黒色に塗られていた場合は、そのマスの色は白で上書きされます。

上記の通りに高橋君と青木君がスタンプを $ 1 $ 回ずつ使った後の、黒色に塗られたマスに書かれた整数の合計を、ゲームの「スコア」とします。 高橋君はスコアが出来るだけ大きくなるように、青木君はスコアが出来るだけ小さくなるように、それぞれ最適な戦略をとります。 ゲームのスコアがいくらになるかを求めて下さい。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ H $ $ W $ $ h_1 $ $ w_1 $ $ h_2 $ $ w_2 $ $ A_{1,\ 1} $ $ A_{1,\ 2} $ $ \cdots $ $ A_{1,\ W} $ $ A_{2,\ 1} $ $ A_{2,\ 2} $ $ \cdots $ $ A_{2,\ W} $ $ \vdots $ $ A_{H,\ 1} $ $ A_{H,\ 2} $ $ \cdots $ $ A_{H,\ W} $

## 输出格式

高橋君はスコアが出来るだけ大きくなるように、青木君はスコアが出来るだけ小さくなるように、それぞれ最適な戦略をとるときの、ゲームのスコアを出力せよ。

## 说明/提示

### 制約

- $ 2\ \leq\ H,\ W\ \leq\ 1000 $
- $ 1\ \leq\ h_1,\ h_2\ \leq\ H $
- $ 1\ \leq\ w_1,\ w_2\ \leq\ W $
- $ 1\ \leq\ A_{i,\ j}\ \leq\ 10^9 $
- 入力はすべて整数

### Sample Explanation 1

ゲームは以下の通りに進行します。 - はじめ、すべてのマスは白色で塗られています。 - まず高橋君が、持っている縦 $ 2 $ 行横 $ 3 $ 列の黒いスタンプを使って、マス $ (2,\ 2),\ (2,\ 3),\ (2\ ,4),\ (3,\ 2),\ (3,\ 3),\ (3,\ 4) $ の $ 6 $ つのマスを黒色で塗りつぶします。 - 次に青木君が、持っている縦 $ 3 $ 行横 $ 1 $ 列の白いスタンプを使って、マス $ (1,\ 4),\ (2,\ 4),\ (3,\ 4) $ を白色で塗りつぶします。 - 最終的に黒色で塗られているマスは、マス $ (2,\ 2),\ (2,\ 3),\ (3,\ 2),\ (3,\ 3) $ の $ 4 $ つであるため、ゲームのスコアは $ 9\ +\ 2\ +\ 3\ +\ 5\ =\ 19 $ です。

### Sample Explanation 2

青木君がスタンプを使った後、すべてのマスは白色であり、ゲームのスコアは $ 0 $ となります。

## 样例 #1

### 输入

```
3 4 2 3 3 1

3 1 4 1

5 9 2 6

5 3 5 8
```

### 输出

```
19
```

## 样例 #2

### 输入

```
3 4 2 3 3 4

3 1 4 1

5 9 2 6

5 3 5 8
```

### 输出

```
0
```

## 样例 #3

### 输入

```
10 10 3 7 2 3

9 7 19 7 10 4 13 9 4 8

10 15 16 3 18 19 17 12 13 2

12 18 4 9 13 13 6 13 5 2

16 12 2 14 18 17 14 7 8 12

12 13 17 12 14 15 19 7 13 15

5 2 16 10 4 6 1 2 7 8

10 14 14 10 9 13 11 4 9 19

16 12 3 19 19 6 2 19 14 20

15 3 19 19 2 10 1 4 3 15

13 20 5 6 19 1 7 17 10 19
```

### 输出

```
180
```



---

---
title: "[ABC229F] Make Bipartite"
layout: "post"
diff: 提高+/省选-
pid: AT_abc229_f
tag: []
---

# [ABC229F] Make Bipartite

## 题目描述

给你一张由 $N+1$ 个点组成的无向图，分别命名为 $0,1,...,N$

这张图只有 $2N$ 条边，用 $A$ 和 $B$ 两个数组表示：
+ $A_i$ 表示连接 $0$ 和 $i$ 两点的无向边的权值
+ $B_i$ 表示连接 $i$ 和 $i+1$ 两点的无向边的权值, 这里，点 $N$ 与 点 $1$ 连接

现在要删除若干条边， 使得这个图变成一张二分图，求删除边的最小权值和

## 输入格式

第一行输入$N$，第二行输入 $A$ 数组，第三行输入 $B$ 数组

## 输出格式

一行，即答案

## 说明/提示

- $ 3\ \leq\ N\ \leq\ 2\ \times\ 10^5 $
- $ 1\ \leq\ A_i\ \leq\ 10^9 $
- $ 1\ \leq\ B_i\ \leq\ 10^9 $
- 输入的所有数据都在整型范围内
### 样例解释
![graph](https://img.atcoder.jp/ghi/ded08d4aa13d31bea28b91afe246c790.png)
删除 $(0,2),(0,4),(0,5)$ 三条边

## 样例 #1

### 输入

```
5

31 4 159 2 65

5 5 5 5 10
```

### 输出

```
16
```

## 样例 #2

### 输入

```
4

100 100 100 1000000000

1 2 3 4
```

### 输出

```
10
```



---

---
title: "[ABC229G] Longest Y"
layout: "post"
diff: 提高+/省选-
pid: AT_abc229_g
tag: []
---

# [ABC229G] Longest Y

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc229/tasks/abc229_g

`Y` と `.` からなる文字列 $ S $ が与えられます。

次の操作を $ 0 $ 回以上 $ K $ 回以下行うことができます。

- $ S $ の隣り合う $ 2 $ 文字を入れ替える

操作後に、`Y` を最大で何個連続させることができますか？

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ S $ $ K $

## 输出格式

答えを出力せよ。

## 说明/提示

### 制約

- $ 2\ \leq\ |S|\ \leq\ 2\ \times\ 10^5 $
- $ S $ の各文字は `Y` または `.` である
- $ 0\ \leq\ K\ \leq\ 10^{12} $
- $ K $ は整数である

### Sample Explanation 1

$ S $ の $ 6,7 $ 文字目および $ 9,10 $ 文字目を入れ替えて `YY....YYY..` とすると、$ 7 $ 文字目から $ 9 $ 文字目で `Y` が $ 3 $ 個連続しています。 `Y` を $ 4 $ 個以上連続させることはできないので、答えは $ 3 $ です。

## 样例 #1

### 输入

```
YY...Y.Y.Y.

2
```

### 输出

```
3
```

## 样例 #2

### 输入

```
YYYY....YYY

3
```

### 输出

```
4
```



---

---
title: "[ABC230F] Predilection"
layout: "post"
diff: 提高+/省选-
pid: AT_abc230_f
tag: []
---

# [ABC230F] Predilection

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc230/tasks/abc230_f

長さ $ N $ の数列 $ A $ が与えられます。 数列の長さが $ 2 $ 以上のとき、隣接する二つの値を選び、それらを削除し、それらが元にあった位置にそれらの和を挿入するという操作を好きなだけ行えます。 $ 0 $ 回以上の操作の後の数列として考えられるものは何通りあるか求め、$ 998244353 $ で割ったあまりを出力してください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ A_1 $ $ A_2 $ $ \cdots $ $ A_N $

## 输出格式

答えを出力せよ。

## 说明/提示

### 制約

- $ 1\ \leq\ N\ \leq\ 2\times\ 10^5 $
- $ |A_i|\ \leq\ 10^9 $
- 入力はすべて整数

### Sample Explanation 1

$ 0 $ 回以上の操作の後の数列として考えられるのは以下の $ 4 $ 通りです。 - $ {1,-1,1} $ - $ {1,0} $ - $ {0,1} $ - $ {1} $

## 样例 #1

### 输入

```
3

1 -1 1
```

### 输出

```
4
```

## 样例 #2

### 输入

```
10

377914575 -275478149 0 -444175904 719654053 -254224494 -123690081 377914575 -254224494 -21253655
```

### 输出

```
321
```



---

---
title: "[ABC233F] Swap and Sort"
layout: "post"
diff: 提高+/省选-
pid: AT_abc233_f
tag: []
---

# [ABC233F] Swap and Sort

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc233/tasks/abc233_f

$ (1,2,\ldots,N) $ を並び替えた長さ $ N $ の順列 $ P=(P_1,P_2,\ldots,P_N) $ があります。

あなたが可能な操作は $ M $ 種類あり、操作 $ i $ は「 $ P $ の $ a_i $ 番目の要素と $ P $ の $ b_i $ 番目の要素を入れ替える」というものです。

操作を好きな順序で、合計 $ 5\times\ 10^5 $ 回以下行うことによって、$ P $ を昇順に並び替えることはできますか？

できるならば、操作手順を $ 1 $ つ教えてください。できないならばその旨を伝えてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ P_1 $ $ P_2 $ $ \ldots $ $ P_N $ $ M $ $ a_1 $ $ b_1 $ $ a_2 $ $ b_2 $ $ \vdots $ $ a_M $ $ b_M $

## 输出格式

$ P $ を昇順に並び替えることができるならば以下の形式で出力せよ。

> $ K $ $ c_1 $ $ c_2 $ $ \ldots $ $ c_K $

ここで、$ K $ は操作の回数を表し、$ c_i(1\leq\ i\ \leq\ K) $ は $ i $ 回目に行う操作が操作 $ c_i $ であることを表す。  
 $ 0\leq\ K\ \leq\ 5\times\ 10^5 $ を満たさなければならないことに注意せよ。

$ P $ を昇順に並び替えることができないならば、`-1` と出力せよ。

## 说明/提示

### 制約

- $ 2\leq\ N\ \leq\ 1000 $
- $ P $ は $ (1,2,\ldots,N) $ を並び替えた順列
- $ 1\leq\ M\ \leq\ \min(2\times\ 10^5,\ \frac{N(N-1)}{2}) $
- $ 1\leq\ a_i\ \lt\ b_i\leq\ N $
- $ i\neq\ j $ ならば $ (a_i,b_i)\neq\ (a_j,b_j) $
- 入力に含まれる値は全て整数

### Sample Explanation 1

$ P $ は、$ (5,3,2,4,6,1)\to\ (5,2,3,4,6,1)\to\ (5,2,3,4,1,6)\to\ (1,2,3,4,5,6) $ と変化します。

### Sample Explanation 2

$ P $ を昇順に並び替えることはできません。

### Sample Explanation 3

初めから $ P $ が昇順に並んでいることもあります。 また、以下のような答えも正解になります。 ``` 4 5 5 5 5 ``` 操作の回数を最小化する必要はないことに注意してください。

## 样例 #1

### 输入

```
6

5 3 2 4 6 1

4

1 5

5 6

1 2

2 3
```

### 输出

```
3

4 2 1
```

## 样例 #2

### 输入

```
5

3 4 1 2 5

2

1 3

2 5
```

### 输出

```
-1
```

## 样例 #3

### 输入

```
4

1 2 3 4

6

1 2

1 3

1 4

2 3

2 4

3 4
```

### 输出

```
0
```



---

---
title: "[ABC233G] Strongest Takahashi"
layout: "post"
diff: 提高+/省选-
pid: AT_abc233_g
tag: []
---

# [ABC233G] Strongest Takahashi

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc233/tasks/abc233_g

$ N\ \times\ N $ のグリッドがあり、いくつかのマスにはブロックが置いてあります。  
 グリッドの情報は $ N $ 個の文字列 $ S_1,S_2,\dots,S_N $ によって以下の形式で与えられます。

- $ S_i $ の $ j $ 文字目が `#` のとき、グリッドの上から $ i $ マス目、左から $ j $ マス目にブロックがある。
- $ S_i $ の $ j $ 文字目が `.` のとき、グリッドの上から $ i $ マス目、左から $ j $ マス目にブロックがない。

高橋くんは、以下の操作を $ 0 $ 回以上好きなだけ行うことができます。

- まず、 $ 1 $ 以上 $ N $ 以下の整数 $ D $ と、グリッド内の $ D\ \times\ D $ の部分正方形を選ぶ。
- その後、体力 $ D $ を消費して部分正方形内のブロックをすべて破壊する。

高橋くんがすべてのブロックを破壊するのに必要な体力の最小値を求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ S_1 $ $ S_2 $ $ \vdots $ $ S_N $

## 输出格式

答えを整数として出力せよ。

## 说明/提示

### 制約

- $ N $ は整数
- $ 1\ \le\ N\ \le\ 50 $
- $ S_i $ は `#` と `.` のみからなる
- $ |S_i|=N $

### Sample Explanation 1

以下の部分正方形を選ぶことで、消費する体力を $ 4 $ にすることができ、これが最適です。 - 上から $ 1 $ マス目、左から $ 1 $ マス目を左上とした、 $ 3\ \times\ 3 $ の部分正方形 - 上から $ 5 $ マス目、左から $ 5 $ マス目を左上とした、 $ 1\ \times\ 1 $ の部分正方形

### Sample Explanation 2

グリッドにブロックが $ 1 $ つもない場合もあります。

## 样例 #1

### 输入

```
5

##...

.##..

#.#..

.....

....#
```

### 输出

```
4
```

## 样例 #2

### 输入

```
3

...

...

...
```

### 输出

```
0
```

## 样例 #3

### 输入

```
21

.....................

.....................

...#.#...............

....#.............#..

...#.#...........#.#.

..................#..

.....................

.....................

.....................

..........#.....#....

......#..###.........

........#####..#.....

.......#######.......

.....#..#####........

.......#######.......

......#########......

.......#######..#....

......#########......

..#..###########.....

.........###.........

.........###.........
```

### 输出

```
19
```



---

---
title: "[ABC235G] Gardens"
layout: "post"
diff: 提高+/省选-
pid: AT_abc235_g
tag: []
---

# [ABC235G] Gardens

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc235/tasks/abc235_g

高橋君は $ A $ 株のリンゴの苗、 $ B $ 株のバナナの苗、$ C $ 株のサクランボの苗を持っています。同じ種類の苗は区別できません。  
 $ N $ 園の庭を持っている高橋君は、次の条件をすべて満たすように持っている苗を植えることにしました。

- すべての庭に少なくとも $ 1 $ 株以上の苗を植える。
- $ 1 $ つの庭に同じ種類の果物の苗を $ 2 $ 株以上植えてはいけない。
- 持っているすべての苗を植える必要はない。

条件を満たす植え方は何通りありますか？答えを $ 998244353 $ で割ったあまりを求めてください。  
 ただし、植え方が異なるとは、ある庭が存在して、片方の植え方でその庭に植えられた果物の苗の集合がもう片方と異なることをいいます。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ A $ $ B $ $ C $

## 输出格式

答えを出力せよ。

## 说明/提示

### 制約

- $ 1\ \leq\ N\ \leq\ 5\ \times\ 10^6 $
- $ 0\ \leq\ A\ \leq\ N $
- $ 0\ \leq\ B\ \leq\ N $
- $ 0\ \leq\ C\ \leq\ N $
- 入力はすべて整数である。

### Sample Explanation 1

条件を満たす植え方は $ 21 $ 通りあり、図示すると以下のようになります。 (縦に並んだ $ 2 $ つの枠が庭で、$ A,B,C $ はそれぞれリンゴの苗、バナナの苗、サクランボの苗を意味しています。) !\[image\](https://img.atcoder.jp/ghi/30cbec3c4cc587889e3c37933da06c3f.png)

### Sample Explanation 2

条件を満たす植え方が存在しない場合もあります。

## 样例 #1

### 输入

```
2 2 1 1
```

### 输出

```
21
```

## 样例 #2

### 输入

```
2 0 0 0
```

### 输出

```
0
```

## 样例 #3

### 输入

```
2 0 2 2
```

### 输出

```
9
```

## 样例 #4

### 输入

```
100 12 34 56
```

### 输出

```
769445780
```

## 样例 #5

### 输入

```
5000000 2521993 2967363 3802088
```

### 输出

```
264705492
```



---

---
title: "[ABC236F] Spices"
layout: "post"
diff: 提高+/省选-
pid: AT_abc236_f
tag: []
---

# [ABC236F] Spices

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc236/tasks/abc236_f

スパイス屋には、スパイス $ 1 $ 、スパイス $ 2 $、$ \ldots $ 、スパイス $ 2^N-1 $ の $ 2^N-1 $ 種類のスパイスがそれぞれ $ 1 $ 個ずつ売られています。 $ i\ =\ 1,\ 2,\ \ldots,\ 2^N-1 $ について、スパイス $ i $ の値段は $ c_i $ 円です。 高橋君はそれらを好きなだけ買うことができます。

高橋君は帰宅後、買ったスパイスのうち $ 1 $ つ以上を選び、それらを組み合わせてカレーを作る予定です。  
 高橋君がスパイス $ A_1 $ 、スパイス $ A_2 $ 、$ \ldots $、スパイス $ A_k $ の $ k $ 個のスパイスを組み合わせると、完成するカレーの辛さは $ A_1\ \oplus\ A_2\ \oplus\ \cdots\ \oplus\ A_k $ になります。 ここで、$ \oplus $ はビットごとの排他的論理和を表します。

高橋君は、作るカレーの辛さを帰宅後の気分で決めたいので、とりあえず $ 1 $ 以上 $ 2^N-1 $ 以下の任意の整数の辛さのカレーを作れるように、購入するスパイスの組み合わせを決定します。高橋君が支払う金額としてあり得る最小値を出力してください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ c_1 $ $ c_2 $ $ \ldots $ $ c_{2^N-1} $

## 输出格式

高橋君が支払う金額としてあり得る最小値を出力せよ。

## 说明/提示

### 制約

- $ 2\ \leq\ N\ \leq\ 16 $
- $ 1\ \leq\ c_i\ \leq\ 10^9 $
- 入力はすべて整数

### Sample Explanation 1

高橋君がスパイス $ 1 $ とスパイス $ 3 $ を買うと、下記の通り、$ 1 $ 以上 $ 3 $ 以下の任意の整数の辛さのカレーを作ることができます。 - 辛さ $ 1 $ のカレーを作るには、スパイス $ 1 $ のみを使い、 - 辛さ $ 2 $ のカレーを作るには、スパイス $ 1 $ とスパイス $ 3 $ を組み合わせ、 - 辛さ $ 3 $ のカレーを作るには、スパイス $ 3 $ のみを使えば良いです。 このとき高橋君が支払う金額は $ c_1\ +\ c_3\ =\ 4\ +\ 3\ =\ 7 $ 円であり、これが高橋君が支払う金額としてあり得る最小値です。

## 样例 #1

### 输入

```
2

4 5 3
```

### 输出

```
7
```

## 样例 #2

### 输入

```
4

9 7 9 7 10 4 3 9 4 8 10 5 6 3 8
```

### 输出

```
15
```



---

---
title: "[ABC238F] Two Exams"
layout: "post"
diff: 提高+/省选-
pid: AT_abc238_f
tag: []
---

# [ABC238F] Two Exams

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc238/tasks/abc238_f

高橋王国にて、 $ 1 $ から $ N $ までの番号のついた $ N $ 人の国民が競技プログラミングの試験に参加しました。  
 試験は $ 2 $ 回からなり、人 $ i $ は $ 1 $ 回目の試験で $ P_i $ 位、 $ 2 $ 回目の試験で $ Q_i $ 位となりました。  
 なお、どちらの試験においても、複数人が同じ順位になることはありませんでした。すなわち、順位を表す数列 $ P,Q $ はそれぞれ $ (1,2,...,N) $ の順列です。

高橋王国の大統領であるいろはちゃんは、この試験の結果に基づいて、 $ N $ 人の中から競技プログラミングの世界大会に出場する $ K $ 人の代表を決めることになりました。  
 代表を決めるにあたって、以下が成立していなければなりません。

- 人 $ x $ が代表であり、人 $ y $ が代表でないような人の組 $ (x,y) $ であって、 $ P_x\ >\ P_y $ かつ $ Q_x\ >\ Q_y $ であるようなものが存在してはならない。
  - 言い換えると、 $ 2 $ 回の試験の双方で人 $ y $ が人 $ x $ よりも小さい順位を取っているにも拘らず、人 $ x $ が代表で人 $ y $ が代表でないということがあってはならない。

いろはちゃんは、ひとまず上記の条件を満たす代表の選び方の数を知りたいので、この数を求めてください。  
 ただし、この数は非常に大きくなる場合もあるので、 $ 998244353 $ で割った余りを出力してください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ K $ $ P_1 $ $ P_2 $ $ \dots $ $ P_N $ $ Q_1 $ $ Q_2 $ $ \dots $ $ Q_N $

## 输出格式

答えを整数として出力せよ。

## 说明/提示

### 制約

- 入力は全て整数
- $ 1\ \le\ N\ \le\ 300 $
- $ 1\ \le\ K\ \le\ N $
- $ P,Q $ は $ (1,2,...,N) $ の順列である。

### Sample Explanation 1

\- 人 $ 1 $ と人 $ 2 $ を代表にすることは問題ありません。 - 人 $ 1 $ と人 $ 3 $ を代表にすると、双方の試験で人 $ 4 $ が人 $ 3 $ よりも小さい順位を取っているため、 $ (x,y)=(3,4) $ に対して問題文中の条件に違反します。 - 人 $ 1 $ と人 $ 4 $ を代表にすることは問題ありません。 - 人 $ 2 $ と人 $ 3 $ を代表にすると、 $ (x,y)=(3,1) $ に対して問題文中の条件に違反します。 - 人 $ 2 $ と人 $ 4 $ を代表にすることは問題ありません。 - 人 $ 3 $ と人 $ 4 $ を代表にすると、 $ (x,y)=(3,1) $ に対して問題文中の条件に違反します。 結局、求める答えは $ 3 $ 通りです。

### Sample Explanation 2

$ 33 $ 人から $ 16 $ 人を選ぶ $ \binom{33}{16}\ =\ 1166803110 $ 通りの全てにおいて、問題文中の条件を満たします。 よって、 $ 1166803110 $ を $ 998244353 $ で割った余りである $ 168558757 $ を出力することとなります。

## 样例 #1

### 输入

```
4 2

2 4 3 1

2 1 4 3
```

### 输出

```
3
```

## 样例 #2

### 输入

```
33 16

1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33

33 32 31 30 29 28 27 26 25 24 23 22 21 20 19 18 17 16 15 14 13 12 11 10 9 8 7 6 5 4 3 2 1
```

### 输出

```
168558757
```

## 样例 #3

### 输入

```
15 7

4 9 7 5 6 13 2 11 3 1 12 14 15 10 8

4 14 9 12 7 15 1 2 8 11 3 5 13 6 10
```

### 输出

```
23
```



---

---
title: "[ABC238G] Cubic?"
layout: "post"
diff: 提高+/省选-
pid: AT_abc238_g
tag: []
---

# [ABC238G] Cubic?

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc238/tasks/abc238_g

長さ $ N $ の数列 $ A $ が与えられるので、以下の $ Q $ 個の質問に答えてください。

- $ i $ 個目の質問では整数 $ L_i,R_i $ が与えられます。 $ A_{L_i}\ \times\ A_{L_i+1}\ \times\ \dots\ \times\ A_{R_i} $ は立方数ですか?

ただし、ある正整数 $ x $ が立方数であるとは、 $ x=y^3 $ を満たすある正整数 $ y $ が存在することを言います。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ Q $ $ A_1 $ $ A_2 $ $ \dots $ $ A_N $ $ L_1 $ $ R_1 $ $ L_2 $ $ R_2 $ $ \vdots $ $ L_Q $ $ R_Q $

## 输出格式

$ Q $ 行出力せよ。  
 $ i $ 行目には、$ i $ 個目の質問について $ A_{L_i}\ \times\ A_{L_i+1}\ \times\ \dots\ \times\ A_{R_i} $ が立方数なら `Yes` 、そうでないなら `No` と出力せよ。  
 なお、正誤判定器は英大文字と英小文字を区別せず、どちらも受理する。

## 说明/提示

### 制約

- 入力は全て整数
- $ 1\ \le\ N,Q\ \le\ 2\ \times\ 10^5 $
- $ 1\ \le\ A_i\ \le\ 10^6 $
- $ 1\ \le\ L_i\ \le\ R_i\ \le\ N $

### Sample Explanation 1

\- $ 1 $ 個目の質問について、 $ 7\ \times\ 49\ =\ 343 $ は立方数です。 - $ 2 $ 個目の質問について、 $ 49\ \times\ 30\ =\ 1470 $ は立方数ではありません。 - $ 3 $ 個目の質問について、 $ 1 $ は立方数です。 - $ 4 $ 個目の質問について、 $ 15\ \times\ 8\ \times\ 6\ \times\ 10\ =\ 7200 $ は立方数ではありません。 - $ 5 $ 個目の質問について、 $ 30\ \times\ 1\ \times\ 15\ \times\ 8\ \times\ 6\ \times\ 10\ =\ 216000 $ は立方数です。

## 样例 #1

### 输入

```
8 5

7 49 30 1 15 8 6 10

1 2

2 3

4 4

5 8

3 8
```

### 输出

```
Yes

No

Yes

No

Yes
```



---

---
title: "[ABC239F] Construct Highway"
layout: "post"
diff: 提高+/省选-
pid: AT_abc239_f
tag: []
---

# [ABC239F] Construct Highway

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc239/tasks/abc239_f

Atcoder 国には $ 1 $ から $ N $ の番号がついた $ N $ 個の街と $ 1 $ から $ M $ の番号がついた $ M $ 個の高速道路があります。  
 高速道路 $ i $ は街 $ A_i $ と街 $ B_i $ を双方向に結んでいます。

国王の高橋君は、新たに $ N-M-1 $ 本の高速道路を建設し、次の $ 2 $ つの条件をともに満たそうとしています。

- すべての街同士は、高速道路をいくつか通って互いに行き来できる
- 各 $ i=1,\ldots,N $ について、街 $ i $ はちょうど $ D_i $ 本の高速道路と直接つながっている

条件を満たすような建設方法が存在するか判定し、存在するなら $ 1 $ つ出力してください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ M $ $ D_1 $ $ \ldots $ $ D_N $ $ A_1 $ $ B_1 $ $ \vdots $ $ A_M $ $ B_M $

## 输出格式

条件を満たすような建設方法が存在しないとき `-1` を出力せよ。  
 存在するとき、$ N-M-1 $ 行出力せよ。$ i $ 行目には、$ i $ 番目に建設する高速道路が結ぶ $ 2 $ つの街の番号を空白区切りで出力せよ。

## 说明/提示

### 制約

- $ 2\ \leq\ N\ \leq\ 2\times\ 10^5 $
- $ 0\ \leq\ M\ \lt\ N-1 $
- $ 1\ \leq\ D_i\ \leq\ N-1 $
- $ 1\leq\ A_i\ \lt\ B_i\ \leq\ N $
- $ i\neq\ j $ ならば、$ (A_i,\ B_i)\ \neq\ (A_j,B_j) $
- 入力に含まれる値は全て整数である

### Sample Explanation 1

出力例のように、街 $ 6 $ と$ 2 $、街 $ 5 $ と $ 6 $、街 $ 4 $ と $ 5 $ をそれぞれ結ぶ高速道路を建設すると条件を満たすことができます。 この他にも、例えば 街 $ 6 $ と$ 4 $、街 $ 5 $ と $ 6 $、街 $ 2 $ と $ 5 $ を結ぶような高速道路を建設しても条件を満たすことができます。

## 样例 #1

### 输入

```
6 2

1 2 1 2 2 2

2 3

1 4
```

### 输出

```
6 2

5 6

4 5
```

## 样例 #2

### 输入

```
5 1

1 1 1 1 4

2 3
```

### 输出

```
-1
```

## 样例 #3

### 输入

```
4 0

3 3 3 3
```

### 输出

```
-1
```



---

---
title: "[ABC242F] Black and White Rooks"
layout: "post"
diff: 提高+/省选-
pid: AT_abc242_f
tag: []
---

# [ABC242F] Black and White Rooks

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc242/tasks/abc242_f

縦 $ N $ 行、横 $ M $ 列のマス目に、黒い飛車の駒 $ B $ 個と白い飛車の駒 $ W $ 個を設置することを考えましょう。

以下の条件をすべて満たす設置の仕方を *いい配置* と呼びます。

- $ B+W $ 個の駒すべてが設置されている。
- $ 1 $ つのマスに置かれている駒の数は高々 $ 1 $ つである。
- ある白い駒と黒い駒の組であって、互いが互いを攻撃しているようなものが存在しない。すなわち、ある白い駒と黒い駒の組であって、一方が $ 1 $ 手の移動によってもう片方が置かれているマスに到達できるようなものが存在しない。

ここで、飛車の駒は、今いる位置から上、下、右、左のいずれかの方向に伸びる直線上にあり、かつ他の駒を飛び越えずに到達できるマスに $ 1 $ 手で移動することができます。

いい配置としてあり得るものは何通りありますか？答えは非常に大きくなることがあるので、$ 998244353 $ で割ったあまりを出力してください。

同じ色の駒同士は区別しないものとします。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ M $ $ B $ $ W $

## 输出格式

答えを $ 998244353 $ で割ったあまりを出力せよ。

## 说明/提示

### 制約

- $ 1\ \leq\ N,M\ \leq\ 50 $
- $ 1\ \leq\ B,W\ \leq\ 2500 $
- $ B+W\ \leq\ N\ \times\ M $
- 入力はすべて整数

### Sample Explanation 1

いい配置としてあり得るものは以下の $ 4 $ 通りです。 !\[\](https://img.atcoder.jp/ghi/00c6bee30b78604192be9b9f0701fc48.png)

### Sample Explanation 2

いい配置としてあり得るものが存在しない場合もあります。

### Sample Explanation 3

$ 998244353 $ で割ったあまりを出力することに注意してください。

## 样例 #1

### 输入

```
2 2 1 1
```

### 输出

```
4
```

## 样例 #2

### 输入

```
1 2 1 1
```

### 输出

```
0
```

## 样例 #3

### 输入

```
40 40 30 30
```

### 输出

```
467620384
```



---

---
title: "[ABC242G] Range Pairing Query"
layout: "post"
diff: 提高+/省选-
pid: AT_abc242_g
tag: []
---

# [ABC242G] Range Pairing Query

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc242/tasks/abc242_g

$ 1,2,\dots,N $ と番号付けられた人が並んでおり、人 $ i $ は色 $ A_i $ の服を着ています。

以下の形式で表される $ Q $ 個のクエリに答えてください。

- 整数 $ l,r $ が与えられる。 人 $ l,l+1,\dots,r $ だけに着目したとき、同じ色の服を着た $ 2 $ 人からなるペアは最大何組作れるか答えよ。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ A_1 $ $ A_2 $ $ \dots $ $ A_N $ $ Q $ $ \mathrm{Query}_1 $ $ \mathrm{Query}_2 $ $ \vdots $ $ \mathrm{Query}_Q $

ただし、 $ \mathrm{Query}_i $ は $ i $ 個目のクエリを表す。

各クエリは以下の形式で与えられる。

> $ l $ $ r $

## 输出格式

全体で $ Q $ 行出力せよ。  
 $ i $ 行目には $ i $ 個目のクエリに対する答えを整数として出力せよ。  
 なお、入出力が大きくなる場合があるので、高速な方法で入出力を行うことを推奨する。

## 说明/提示

### 制約

- 入力は全て整数
- $ 1\ \le\ N\ \le\ 10^5 $
- $ 1\ \le\ Q\ \le\ 10^6 $
- $ 1\ \le\ A_i\ \le\ N $
- 各クエリについて、 $ 1\ \le\ l\ \le\ r\ \le\ N $

### Sample Explanation 1

$ A=(1,2,3,2,3,1,3,1,2,3) $ です。この入力には $ 6 $ 個のクエリが含まれます。 $ 1 $ 個目のクエリは $ (l,\ r)\ =\ (6,\ 10) $ です。人 $ 6 $ と人 $ 8 $ 、人 $ 7 $ と人 $ 10 $ を組にすることで、同じ色の服を着たペアを $ 2 $ 組作ることができます。 $ 2 $ 個目のクエリは $ (l,\ r)\ =\ (5,\ 8) $ です。人 $ 5 $ と人 $ 7 $ 、人 $ 6 $ と人 $ 8 $ を組にすることで、同じ色の服を着たペアを $ 2 $ 組作ることができます。 $ l=r $ であるようなクエリも与えられます。

## 样例 #1

### 输入

```
10

1 2 3 2 3 1 3 1 2 3

6

6 10

5 8

3 6

4 4

1 6

1 10
```

### 输出

```
2

2

1

0

3

4
```



---

---
title: "[ABC243F] Lottery"
layout: "post"
diff: 提高+/省选-
pid: AT_abc243_f
tag: []
---

# [ABC243F] Lottery

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc243/tasks/abc243_f

高橋君はくじを引こうとしています。

くじを $ 1 $ 回引くごとに、$ N $ 種類の賞品のいずれかが手に入ります。賞品 $ i $ が手に入る確率は $ \frac{W_i}{\sum_{j=1}^{N}W_j} $ であり、各くじの結果は独立です。

くじを $ K $ 回引いたとき、ちょうど $ M $ 種類の賞品が手に入る確率はいくらでしょうか？ $ \bmod\ 998244353 $ で求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ M $ $ K $ $ W_1 $ $ \vdots $ $ W_N $

## 输出格式

答えを出力せよ。

## 说明/提示

### 注記

有理数を出力する際は、まずその有理数を分数 $ \frac{y}{x} $ として表してください。 ここで、$ x,y $ は整数であり、$ x $ は $ 998244353 $ で割り切れてはなりません（この問題の制約下で、そのような表現は必ず可能です）。 そして、$ xz\equiv\ y\ \pmod{998244353} $ を満たすような $ 0 $ 以上 $ 998244352 $ 以下の唯一の整数 $ z $ を出力してください。

### 制約

- $ 1\ \leq\ K\ \leq\ 50 $
- $ 1\ \leq\ M\ \leq\ N\ \leq\ 50 $
- $ 0\ <\ W_i $
- $ 0\ <\ W_1\ +\ \ldots\ +\ W_N\ <\ 998244353 $
- 入力は全て整数である

### Sample Explanation 1

各くじの結果として、賞品 $ 1 $ が手に入る確率が $ \frac{2}{3} $、賞品 $ 2 $ が手に入る確率が $ \frac{1}{3} $ です。 $ 2 $ 回のくじの結果として、ともに賞品 $ 1 $ を手に入れる確率が $ \frac{4}{9} $、ともに賞品 $ 2 $ を手に入れる確率が $ \frac{1}{9} $ であるため、求める答えは $ \frac{5}{9} $ です。 これを注記にしたがって $ \bmod\ 998244353 $ で出力すると $ 221832079 $ になります。

### Sample Explanation 2

くじを $ 2 $ 回引いて $ 3 $ 種類の賞品を手に入れることはできません。したがって求める確率は $ 0 $ です。

## 样例 #1

### 输入

```
2 1 2

2

1
```

### 输出

```
221832079
```

## 样例 #2

### 输入

```
3 3 2

1

1

1
```

### 输出

```
0
```

## 样例 #3

### 输入

```
3 3 10

499122176

499122175

1
```

### 输出

```
335346748
```

## 样例 #4

### 输入

```
10 8 15

1

1

1

1

1

1

1

1

1

1
```

### 输出

```
755239064
```



---

---
title: "[ABC243G] Sqrt"
layout: "post"
diff: 提高+/省选-
pid: AT_abc243_g
tag: []
---

# [ABC243G] Sqrt

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc243/tasks/abc243_g

長さ $ 1 $ の数列 $ A=(X) $ があります。この数列に対して次の操作を $ 10^{100} $ 回行います。

操作：$ A $ の末尾の要素を $ Y $ とする。$ 1 $ 以上 $ \sqrt{Y} $ 以下の整数を自由に選び、$ A $ の末尾に追加する。

$ 10^{100} $ 回の操作後にできる数列は何種類ありますか？

$ T $ 個のテストケースが与えられるので、それぞれについて答えを求めてください。

なお、制約の条件下で答えは $ 2^{63} $ 未満になることが証明されます。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ T $ $ \rm\ case_1 $ $ \vdots $ $ \rm\ case_T $

各ケースは以下の形式で与えられる。

> $ X $

## 输出格式

$ T $ 行出力せよ。 $ i $ 行目には、$ \rm\ case_i $ に対する答えを出力せよ。

## 说明/提示

### 制約

- $ 1\ \leq\ T\ \leq\ 20 $
- $ 1\ \leq\ X\ \leq\ 9\times\ 10^{18} $
- 入力に含まれる値は全て整数である

### Sample Explanation 1

$ 1 $ つ目のケースでは、操作後の数列として考えられるものは次の $ 5 $ 種類です。 - $ (16,4,2,1,1,1,\ldots) $ - $ (16,4,1,1,1,1,\ldots) $ - $ (16,3,1,1,1,1,\ldots) $ - $ (16,2,1,1,1,1,\ldots) $ - $ (16,1,1,1,1,1,\ldots) $

## 样例 #1

### 输入

```
4

16

1

123456789012

1000000000000000000
```

### 输出

```
5

1

4555793983

23561347048791096
```



---

---
title: "[ABC244G] Construct Good Path"
layout: "post"
diff: 提高+/省选-
pid: AT_abc244_g
tag: []
---

# [ABC244G] Construct Good Path

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc244/tasks/abc244_g

$ N $ 個の頂点と $ M $ 本の辺からなる単純（自己ループおよび多重辺を持たない）かつ連結な無向グラフが与えられます。  
 $ i\ =\ 1,\ 2,\ \ldots,\ M $ について、$ i $ 番目の辺は頂点 $ u_i $ と頂点 $ v_i $ を結びます。

下記の $ 2 $ つの条件をともに満たす整数列 $ (A_1,\ A_2,\ \ldots,\ A_k) $ を長さ $ k $ の**パス**と呼びます。

- すべての $ i\ =\ 1,\ 2,\ \dots,\ k $ について、$ 1\ \leq\ A_i\ \leq\ N $ 。
- すべての $ i\ =\ 1,\ 2,\ \ldots,\ k-1 $ について、頂点 $ A_i $ と頂点 $ A_{i+1} $ は辺で直接結ばれている。

空列も長さ $ 0 $ のパスとみなします。

$ 0 $ と $ 1 $ のみからなる長さ $ N $ の文字列 $ S\ =\ s_1s_2\ldots\ s_N $ が与えられます。 パス $ A\ =\ (A_1,\ A_2,\ \ldots,\ A_k) $ が下記を満たすとき、パス $ A $ を $ S $ に関する**良いパス**と呼びます。

- すべての $ i\ =\ 1,\ 2,\ \ldots,\ N $ について、次を満たす。
  - $ s_i\ =\ 0 $ ならば、$ A $ に含まれる $ i $ の個数は偶数である。
  - $ s_i\ =\ 1 $ ならば、$ A $ に含まれる $ i $ の個数は奇数である。

この問題の制約下において、$ S $ に関する長さ $ 4N $ 以下の良いパスが少なくとも $ 1 $ つ存在することが示せます。 $ S $ に関する長さ $ 4N $ 以下の良いパスを $ 1 $ つ出力してください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ M $ $ u_1 $ $ v_1 $ $ u_2 $ $ v_2 $ $ \vdots $ $ u_M $ $ v_M $ $ S $

## 输出格式

$ S $ に関する長さ $ 4N $ 以下の良いパスを下記の形式にしたがって出力せよ。 すなわち、$ 1 $ 行目にパスの長さ $ K $ を出力し、$ 2 $ 行目にパスの各要素を空白区切りで出力せよ。

> $ K $ $ A_1 $ $ A_2 $ $ \ldots $ $ A_K $

## 说明/提示

### 制約

- $ 2\ \leq\ N\ \leq\ 10^5 $
- $ N-1\ \leq\ M\ \leq\ \min\lbrace\ 2\ \times\ 10^5,\ \frac{N(N-1)}{2}\rbrace $
- $ 1\ \leq\ u_i,\ v_i\ \leq\ N $
- 与えられるグラフは単純かつ連結
- $ N,\ M,\ u_i,\ v_i $ は整数
- $ S $ は $ 0 $ と $ 1 $ のみからなる長さ $ N $ の文字列

### Sample Explanation 1

パス $ (2,\ 5,\ 6,\ 5,\ 6,\ 3,\ 1,\ 3,\ 6) $ は、長さが $ 4N $ 以下であり、 - 含まれる $ 1 $ の個数は奇数（ $ 1 $ 個） - 含まれる $ 2 $ の個数は奇数（ $ 1 $ 個） - 含まれる $ 3 $ の個数は偶数（ $ 2 $ 個） - 含まれる $ 4 $ の個数は偶数（ $ 0 $ 個） - 含まれる $ 5 $ の個数は偶数（ $ 2 $ 個） - 含まれる $ 6 $ の個数は奇数（ $ 3 $ 個） であるため、$ S\ =\ 110001 $ に関する良いパスです。

### Sample Explanation 2

空のパス $ () $ は、$ S\ =\ 000000 $ に関する良いパスです。 代わりにパス $ (1,\ 2,\ 3,\ 1,\ 2,\ 3) $ などを出力しても正解となります。

## 样例 #1

### 输入

```
6 6

6 3

2 5

4 2

1 3

6 5

3 2

110001
```

### 输出

```
9

2 5 6 5 6 3 1 3 6
```

## 样例 #2

### 输入

```
3 3

3 1

3 2

1 2

000
```

### 输出

```
0
```



---

---
title: "[ABC245G] Foreign Friends"
layout: "post"
diff: 提高+/省选-
pid: AT_abc245_g
tag: []
---

# [ABC245G] Foreign Friends

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc245/tasks/abc245_g

$ N $ 人の人と $ K $ 個の国があり、それぞれ 人 $ 1 $, 人 $ 2 $, $ \ldots $, 人 $ N $ および国 $ 1 $, 国 $ 2 $, $ \ldots $, 国 $ K $ と番号が付いています。 それぞれの人はちょうど $ 1 $ つの国に属しており、人 $ i $ は国 $ A_i $ に属しています。 また、$ L $ 人の人気者がおり、具体的には人 $ B_1 $, 人 $ B_2 $, $ \ldots $, 人 $ B_L $ が人気者です。 最初、$ N $ 人のうちどの $ 2 $ 人も友達ではありません。

神様である高橋君は、$ M $ 個の $ 2 $ 人組のペアについて、コストを支払うことで互いに友達にすることができます。 具体的には $ 1\leq\ i\leq\ M $ について、コスト $ C_i $ を支払うことで人 $ U_i $ と人 $ V_i $ を互いに友達にすることができます。

ここで、各 $ 1\leq\ i\leq\ N $ について、次の問題を解いてください。

> 高橋君は、人 $ i $ を、人 $ i $ の属する国とは異なる国に属する人気者と間接的に友達にすることは可能か？ 可能ならば、それを達成するのに必要なコストの総和の最小値を求めよ。 ただし、人 $ s $ と人 $ t $ が間接的に友達であるとは、ある非負整数 $ n $ と人の列 $ (u_0,\ u_1,\ \ldots\ ,\ u_n) $ が存在し, $ u_0=s $, $ u_n=t $ かつ $ 0\leq\ i\ <\ n $ について、人 $ u_i $ と 人 $ u_{i+1} $ が互いに友達であることをさす。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ M $ $ K $ $ L $ $ A_1 $ $ A_2 $ $ \cdots $ $ A_N $ $ B_1 $ $ B_2 $ $ \cdots $ $ B_L $ $ U_1 $ $ V_1 $ $ C_1 $ $ U_2 $ $ V_2 $ $ C_2 $ $ \vdots $ $ U_M $ $ V_M $ $ C_M $

## 输出格式

$ X_i $ を、人 $ i $ を異なる国に属する人気者と間接的に友達にすることが不可能ならば $ -1 $、 そうでないならば、達成するのに必要な最小コストの値として定義する。 $ X_1,X_2,\ldots\ ,X_N $ を空白区切りで一行に出力せよ。

## 说明/提示

### 制約

- $ 2\ \leq\ N\ \leq\ 10^5 $
- $ 1\ \leq\ M\ \leq\ 10^5 $
- $ 1\ \leq\ K\ \leq\ 10^5 $
- $ 1\ \leq\ L\ \leq\ N $
- $ 1\ \leq\ A_i\ \leq\ K $
- $ 1\ \leq\ B_1\ <\ B_2\ <\ \cdots\ <\ B_L\leq\ N $
- $ 1\leq\ C_i\leq\ 10^9 $
- $ 1\leq\ U_i\ <\ V_i\leq\ N $
- $ i\ \neq\ j $ ならば $ (U_i,\ V_i)\neq\ (U_j,V_j) $
- 入力は全て整数である。

### Sample Explanation 1

人 $ 1 $, 人 $ 2 $, 人 $ 3 $, 人 $ 4 $ はそれぞれ国 $ 1 $, 国 $ 1 $, 国 $ 2 $, 国 $ 2 $ に属しており、人気者は人 $ 2 $, 人 $ 3 $ の $ 2 $ 名です。このとき、 - 人 $ 1 $ と異なる国に属する人気者は人 $ 3 $ のみです。人 $ 1 $ と 人 $ 3 $ を間接的に友達にするには、それぞれコスト $ 15,30 $ を払って人 $ 1 $ と人 $ 2 $, 人 $ 2 $ と人 $ 3 $ を友達にした時がかかるコストが最小で、このとき $ 15+30=45 $ となります。 - 人 $ 2 $ と異なる国に属する人気者は人 $ 3 $ のみです。コスト $ 30 $ を払って人 $ 2 $ と人 $ 3 $ を友達にした時が最小となります。 - 人 $ 3 $ と異なる国に属する人気者は人 $ 2 $ のみです。コスト $ 30 $ を払って人 $ 2 $ と人 $ 3 $ を友達にした時が最小となります。 - 人 $ 4 $ と異なる国に属する人気者は人 $ 2 $ のみです。人 $ 4 $ と 人 $ 2 $ を間接的に友達にするには、それぞれコスト $ 15,10 $ を払って人 $ 1 $ と人 $ 2 $, 人 $ 1 $ と人 $ 4 $ を友達にした時がかかるコストが最小で、このとき $ 15+10=25 $ となります。

### Sample Explanation 2

人 $ 1 $ にとって自身は間接的な友達といえますが、異なる国に属していないため、 「異なる国に属する人気者」の条件をみたす相手はいないことに注意してください。

## 样例 #1

### 输入

```
4 4 2 2

1 1 2 2

2 3

1 2 15

2 3 30

3 4 40

1 4 10
```

### 输出

```
45 30 30 25
```

## 样例 #2

### 输入

```
3 1 3 1

1 2 3

1

1 2 1000000000
```

### 输出

```
-1 1000000000 -1
```



---

---
title: "[ABC246G] Game on Tree 3"
layout: "post"
diff: 提高+/省选-
pid: AT_abc246_g
tag: []
---

# [ABC246G] Game on Tree 3

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc246/tasks/abc246_g

$ N $ 個の頂点を持ち、頂点 $ 1 $ を根とする根付き木があります。 $ i\ =\ 1,\ 2,\ \ldots,\ N-1 $ について、$ i $ 本目の辺は頂点 $ u_i $ と頂点 $ v_i $ を結びます。 また、根以外の頂点には正の整数が書かれており、具体的には、$ i\ =\ 2,\ 3,\ \ldots,\ N $ について、頂点 $ i $ に正の整数 $ A_i $ が書かれています。 高橋君と青木君はこの根付き木と $ 1 $ 個のコマを使って次の対戦ゲームをします。

はじめ、頂点 $ 1 $ にコマが置かれています。その後、ゲームが終了するまで下記の手順を繰り返します。

1. まず、青木君が根以外の頂点を任意に $ 1 $ 個選び、その頂点に書かれた整数を $ 0 $ に書き換える。
2. 次に、高橋君がコマを、いまコマがある頂点の（直接の）子のいずれかに移動する。
3. その後、コマが葉にある場合はゲームが終了する。そうでない場合であっても、高橋君は望むならゲームを直ちに終了させることができる。

ゲーム終了時点でコマがある頂点に、ゲーム終了時点で書かれている整数が、高橋君の得点となります。 高橋君は自身の得点を出来るだけ大きく、青木君は高橋君の得点を出来るだけ小さくしたいです。 両者がそのために最適な行動を取るときの高橋君の得点を出力してください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ A_2 $ $ \ldots $ $ A_N $ $ u_1 $ $ v_1 $ $ u_2 $ $ v_2 $ $ \vdots $ $ u_{N-1} $ $ v_{N-1} $

## 输出格式

答えを出力せよ。

## 说明/提示

### 制約

- $ 2\ \leq\ N\ \leq\ 2\ \times\ 10^5 $
- $ 1\ \leq\ A_i\ \leq\ 10^9 $
- $ 1\ \leq\ u_i,\ v_i\ \leq\ N $
- 与えられるグラフは木である。
- 入力はすべて整数

### Sample Explanation 1

両者が最適な行動をとる場合のゲームの進行の一例として次のものがあります。 1. はじめ、コマは頂点 $ 1 $ に置かれています。 2. 青木君が頂点 $ 7 $ に書かれた整数を $ 10 $ から $ 0 $ に書き換えます。 3. 高橋君がコマを頂点 $ 1 $ から頂点 $ 2 $ に動かします。 4. 青木君が頂点 $ 4 $ に書かれた整数を $ 6 $ から $ 0 $ に書き換えます。 5. 高橋君がコマを頂点 $ 2 $ から頂点 $ 5 $ に動かします。 6. 高橋君がゲームを終了します。 ゲーム終了時点でコマは頂点 $ 5 $ にあり、頂点 $ 5 $ にはゲーム終了時点で整数 $ 5 $ が書かれているので、高橋君の得点は $ 5 $ です。

## 样例 #1

### 输入

```
7

2 4 6 5 6 10

1 2

1 3

2 4

2 5

5 6

5 7
```

### 输出

```
5
```

## 样例 #2

### 输入

```
30

29 27 79 27 30 4 93 89 44 88 70 75 96 3 78 39 97 12 53 62 32 38 84 49 93 53 26 13 25

13 15

14 22

17 24

12 3

4 3

5 8

26 15

3 2

2 9

4 25

4 13

2 10

28 15

6 4

2 5

19 9

2 7

2 14

23 30

17 2

7 16

21 13

13 23

13 20

1 2

6 18

27 6

21 29

11 8
```

### 输出

```
70
```



---

---
title: "[ABC247G] Dream Team"
layout: "post"
diff: 提高+/省选-
pid: AT_abc247_g
tag: []
---

# [ABC247G] Dream Team

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc247/tasks/abc247_g

$ N $ 人の競技プログラマがいます。  
 $ i $ 人目の競技プログラマは、所属大学が $ A_i $、得意分野が $ B_i $、強さが $ C_i $ です。

$ N $ 人のうちの何人かによって構成されるチームであって、次の条件をともに満たすものを**ドリームチーム**と呼びます。

- チームに属するどの $ 2 $ 人の所属大学も異なる
- チームに属するどの $ 2 $ 人の得意分野も異なる

構成可能なドリームチームの人数の最大値を $ k $ とします。各 $ i=1,2,\ldots,k $ について、次の問題を解いてください。

問題：ちょうど $ i $ 人で構成されるドリームチームについて、チームに所属する人の強さの合計の最大値を求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ A_1 $ $ B_1 $ $ C_1 $ $ A_2 $ $ B_2 $ $ C_2 $ $ \vdots $ $ A_N $ $ B_N $ $ C_N $

## 输出格式

構成可能なドリームチームの人数の最大値を $ k $ とする。  
 1行目には $ k $ を出力し、その後、$ k $ 行にわたって、$ i=1,2,\ldots,k $ のときの問題に対する答えを順に出力せよ。

## 说明/提示

### 制約

- $ 1\ \leq\ N\ \leq\ 3\times\ 10^4 $
- $ 1\ \leq\ A_i,B_i\ \leq\ 150 $
- $ 1\ \leq\ C_i\ \leq\ 10^9 $
- 入力に含まれる値は全て整数である

### Sample Explanation 1

\- ちょうど $ 1 $ 人で構成されるドリームチームは、$ 1 $ 人目の競技プログラマからなるとき強さの合計が $ 100 $ で最大になります。 - ちょうど $ 2 $ 人で構成されるドリームチームは、$ 2,3 $ 人目の競技プログラマからなるとき強さの合計が $ 11 $ で最大になります。 - ちょうど $ 3 $ 人で構成されるドリームチームを作ることはできません。

## 样例 #1

### 输入

```
3

1 1 100

1 20 10

2 1 1
```

### 输出

```
2

100

11
```

## 样例 #2

### 输入

```
10

1 4 142135623

2 6 457513110

3 1 622776601

5 1 961524227

2 2 360679774

2 4 494897427

3 7 416573867

5 2 915026221

1 7 320508075

5 3 851648071
```

### 输出

```
4

961524227

1537802822

2032700249

2353208324
```



---

---
title: "[ABC249E] RLE"
layout: "post"
diff: 提高+/省选-
pid: AT_abc249_e
tag: []
---

# [ABC249E] RLE

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc249/tasks/abc249_e

英小文字のみからなる文字列 $ X $ に対し、以下の手続きによって文字列を得ることを考えます。

- $ X $ を異なる文字が隣り合っている部分で分割する。
- 分割した各文字列 $ Y $ に対して、$ Y $ を $ Y $ を構成する文字と $ Y $ の長さを繋げた文字列に置き換える。
- 元の順番を保ったまま、置き換えた文字列をすべて繋げる。

例えば、`aaabbcccc` の場合、`aaa`,`bb`,`cccc` に分けられ、それぞれを `a3`,`b2`,`c4` に置き換え、その順番のまま繋げることにより `a3b2c4` を得ます。また、`aaaaaaaaaa` の場合、`a10` になります。

長さ $ N $ の英小文字のみからなる文字列 $ S $ のうち、上記の手続きによって得られた文字列 $ T $ との長さを比べたとき、$ T $ の方が短いものの個数を $ P $ で割ったあまりを求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ P $

## 输出格式

答えを出力せよ。

## 说明/提示

### 制約

- $ 1\ \le\ N\ \le\ 3000 $
- $ 10^8\ \le\ P\ \le\ 10^9 $
- $ N,P $ は整数
- $ P $ は素数

### Sample Explanation 1

$ 1,2,3 $ 文字目が全て等しい文字列のみが条件を満たします。 例えば、`aaa` は `a3` となり条件を満たしますが、`abc` は `a1b1c1` となり条件を満たしません。

### Sample Explanation 2

`aa` → `a2` のように、長さが等しいものは条件を満たさないことに注意してください。

### Sample Explanation 3

`aaabb` や `aaaaa` などが条件を満たします。

### Sample Explanation 4

条件を満たす文字列の個数を $ P $ で割ったあまりを求めてください。

## 样例 #1

### 输入

```
3 998244353
```

### 输出

```
26
```

## 样例 #2

### 输入

```
2 998244353
```

### 输出

```
0
```

## 样例 #3

### 输入

```
5 998244353
```

### 输出

```
2626
```

## 样例 #4

### 输入

```
3000 924844033
```

### 输出

```
607425699
```



---

---
title: "[ABC250F] One Fourth"
layout: "post"
diff: 提高+/省选-
pid: AT_abc250_f
tag: []
---

# [ABC250F] One Fourth

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc250/tasks/abc250_f

ABC250 は、 ABC1000 の開催を目指す高橋くんにとってちょうど $ 1/4 $ となる記念すべき回です。  
 そこで、高橋くんはピザを $ 1 $ 枚買ってきて、そのピザのうちなるべく $ 1/4 $ に近い分量を食べて祝うことにしました。

高橋くんが買ってきたピザは凸 $ N $ 角形 ($ N\ \ge\ 4 $) の平らな形をしており、このピザを $ xy $ 平面上に置いた際、 $ i $ 番目の頂点の座標は $ (X_i,Y_i) $ でした。

高橋くんは、このピザを以下のように切って食べることにしました。

- まず、高橋くんはピザの頂点のうち隣接しない $ 2 $ 頂点を選び、それらを通る直線に沿ってナイフを入れ、ピザを $ 2 $ つに切り分ける。
- その後、 $ 2 $ つのピースのうち好きなものをどちらか $ 1 $ つ選んで食べる。

高橋くんが買ってきたピザの面積の $ 1/4 $ を $ a $ 、高橋くんが食べるピースの面積を $ b $ とした時、 $ 8\ \times\ |a-b| $ としてありえる最小値を求めてください。なお、この値は常に整数となることが示せます。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ X_1 $ $ Y_1 $ $ X_2 $ $ Y_2 $ $ \dots $ $ X_N $ $ Y_N $

## 输出格式

答えを整数として出力せよ。

## 说明/提示

### 制約

- 入力は全て整数
- $ 4\ \le\ N\ \le\ 10^5 $
- $ |X_i|,\ |Y_i|\ \le\ 4\ \times\ 10^8 $
- 入力される頂点は反時計回りに凸 $ N $ 角形をなす。

### Sample Explanation 1

$ 3 $ 番目の頂点と $ 5 $ 番目の頂点を通る直線に沿ってピザを切り分け、 $ 4 $ 番目の頂点を含む側のピースを食べたとします。 このとき、$ a=\frac{33}{2}\ \times\ \frac{1}{4}\ =\ \frac{33}{8} $ 、 $ b=4 $ 、 $ 8\ \times\ |a-b|=1 $ であり、これがありえる最小値です。

## 样例 #1

### 输入

```
5

3 0

2 3

-1 3

-3 1

-1 -1
```

### 输出

```
1
```

## 样例 #2

### 输入

```
4

400000000 400000000

-400000000 400000000

-400000000 -400000000

400000000 -400000000
```

### 输出

```
1280000000000000000
```

## 样例 #3

### 输入

```
6

-816 222

-801 -757

-165 -411

733 131

835 711

-374 979
```

### 输出

```
157889
```



---

---
title: "[ABC250G] Stonks"
layout: "post"
diff: 提高+/省选-
pid: AT_abc250_g
tag: []
---

# [ABC250G] Stonks

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc250/tasks/abc250_g

あなたは $ N $ 日にわたって、 X 社の株の取引を行います。

未来予知の能力者であるあなたは、取引のうち $ i $ 日目の X 社の株価が $ 1 $ 株あたり $ P_i $ 円であることを知っています。

あなたは、毎日以下の行動をどれか $ 1 $ つだけ行うことが出来ます。

- X 社の株を $ 1 $ 株、 $ P_i $ 円で買う。
  - このとき、持ち株が $ 1 $ 株増え、所持金が $ P_i $ 円減少する。
- X 社の株を $ 1 $ 株、 $ P_i $ 円で売る。この行動は株を $ 1 $ 株以上保有している時行える。
  - このとき、持ち株が $ 1 $ 株減り、所持金が $ P_i $ 円増加する。
- 何もしない。

あなたの取引開始時の所持金は $ 10^{100} $ 円なので、現金に困ることはありません。

$ N $ 日目の行動を終えた時点で、所持金の増加額としてありうる最大値を求めてください。  
 なお、 $ N $ 日目の行動を終えた時点でまだ X 社の株をいくつか保有していても、それは所持金の計算上 $ 0 $ 円であるものとします。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ P_1 $ $ P_2 $ $ \dots $ $ P_N $

## 输出格式

答えを整数として出力せよ。

## 说明/提示

### 制約

- 入力は全て整数
- $ 1\ \le\ N\ \le\ 2\ \times\ 10^5 $
- $ 1\ \le\ P_i\ \le\ 10^9 $

### Sample Explanation 1

以下のように行動することで所持金を $ 16 $ 円増加させることができ、これが最大です。 - $ 1 $ 日目、株を $ 1 $ 株買う。 持ち株は $ 1 $ 株、所持金の増加額は $ -2 $ 円になる。 - $ 2 $ 日目、株を $ 1 $ 株売る。 持ち株は $ 0 $ 株、所持金の増加額は $ 3 $ 円になる。 - $ 3 $ 日目、株を $ 1 $ 株買う。 持ち株は $ 1 $ 株、所持金の増加額は $ -1 $ 円になる。 - $ 4 $ 日目、株を $ 1 $ 株買う。 持ち株は $ 2 $ 株、所持金の増加額は $ -4 $ 円になる。 - $ 5 $ 日目、株を $ 1 $ 株売る。 持ち株は $ 1 $ 株、所持金の増加額は $ 3 $ 円になる。 - $ 6 $ 日目、株を $ 1 $ 株買う。 持ち株は $ 2 $ 株、所持金の増加額は $ 2 $ 円になる。 - $ 7 $ 日目、株を $ 1 $ 株売る。 持ち株は $ 1 $ 株、所持金の増加額は $ 10 $ 円になる。 - $ 8 $ 日目、株を $ 1 $ 株売る。 持ち株は $ 0 $ 株、所持金の増加額は $ 16 $ 円になる。

## 样例 #1

### 输入

```
8

2 5 4 3 7 1 8 6
```

### 输出

```
16
```

## 样例 #2

### 输入

```
5

10000 1000 100 10 1
```

### 输出

```
0
```

## 样例 #3

### 输入

```
15

300 1 4000 1 50000 900000000 20 600000 50000 300 50000 80000000 900000000 7000000 900000000
```

### 输出

```
2787595378
```



---

---
title: "[ABC253G] Swap Many Times"
layout: "post"
diff: 提高+/省选-
pid: AT_abc253_g
tag: []
---

# [ABC253G] Swap Many Times

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc253/tasks/abc253_g

$ 2 $ 以上の整数 $ N $ に対し、$ 1\ \leq\ x\ \lt\ y\ \leq\ N $ を満たす整数の組 $ (x,\ y) $ は $ \frac{N(N\ -\ 1)}{2} $ 個あります。

これらを辞書順で小さい順に並べたもののうち $ L $ 番目、$ L+1 $ 番目、$ \ldots $、$ R $ 番目のものをそれぞれ $ (x_1,\ y_1),\ \dots,\ (x_{R\ -\ L\ +\ 1},\ y_{R\ -\ L\ +\ 1}) $ とおきます。数列 $ A\ =\ (1,\ \dots,\ N) $ に対し、$ i\ =\ 1,\ \dots,\ R-L+1 $ の順に以下の操作を行います。

- $ A_{x_i} $ と $ A_{y_i} $ を入れ替える

操作後の $ A $ を求めてください。

なお、$ (a,\ b) $ が $ (c,\ d) $ よりも辞書順で小さいとは、以下のいずれかが成り立つことをいいます。

- $ a\ \lt\ c $
- $ a\ =\ c $ かつ $ b\ \lt\ d $

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ L $ $ R $

## 输出格式

操作後の $ A $ の各項を空白区切りで一行に出力せよ。

## 说明/提示

### 制約

- $ 2\ \leq\ N\ \leq\ 2\ \times\ 10^5 $
- $ 1\ \leq\ L\ \leq\ R\ \leq\ \frac{N(N-1)}{2} $
- 入力は全て整数

### Sample Explanation 1

$ 1\ \leq\ x\ \lt\ y\ \leq\ N $ を満たす整数の組を辞書順で小さい順に並べたもののうち $ 3,\ 4,\ 5,\ 6 $ 番目のものはそれぞれ $ (1,\ 4),\ (1,\ 5),\ (2,\ 3),\ (2,\ 4) $ です。 これらについて順に操作を行うと、$ A $ は次のように変化します。 $ (1,\ 2,\ 3,\ 4,\ 5)\ \rightarrow\ (4,\ 2,\ 3,\ 1,\ 5)\ \rightarrow\ (5,\ 2,\ 3,\ 1,\ 4)\ \rightarrow\ (5,\ 3,\ 2,\ 1,\ 4)\ \rightarrow\ (5,\ 1,\ 2,\ 3,\ 4) $

## 样例 #1

### 输入

```
5 3 6
```

### 输出

```
5 1 2 3 4
```

## 样例 #2

### 输入

```
10 12 36
```

### 输出

```
1 10 9 8 7 4 3 2 5 6
```



---

---
title: "[ABC256G] Black and White Stones"
layout: "post"
diff: 提高+/省选-
pid: AT_abc256_g
tag: []
---

# [ABC256G] Black and White Stones

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc256/tasks/abc256_g

一辺の長さが整数 $ D $ の正 $ N $ 角形があります。

頂点から始めて、周上に距離 $ 1 $ ごとに黒い石か白い石を置きます。これにより、$ N $ 角形の各辺上に $ D+1 $ 個、全体で $ ND $ 個の石が置かれます。

石の置き方のうち、各辺上にある白い石の個数が等しくなるようなものは何通りありますか？ $ 998244353 $ で割った余りを求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ D $

## 输出格式

答えを出力せよ。

## 说明/提示

### 制約

- $ 3\ \leq\ N\ \leq\ 10^{12} $
- $ 1\ \leq\ D\ \leq\ 10^4 $
- 入力に含まれる値は全て整数である

### Sample Explanation 1

下図の $ 10 $ 通りがあります。 !\[図\](https://img.atcoder.jp/abc256/ba2bebe9d374f281e2b44e36231abae2.png)

### Sample Explanation 2

$ 998244353 $ で割った余りを求めてください。

## 样例 #1

### 输入

```
3 2
```

### 输出

```
10
```

## 样例 #2

### 输入

```
299792458 3141
```

### 输出

```
138897974
```



---

---
title: "[ABC257G] Prefix Concatenation"
layout: "post"
diff: 提高+/省选-
pid: AT_abc257_g
tag: []
---

# [ABC257G] Prefix Concatenation

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc257/tasks/abc257_g

英小文字のみからなる $ 2 $ つの文字列 $ S,T $ が与えられます。

(相異なっても良い) $ S $ の接頭辞を $ k $ 個連結することで $ T $ と一致させられるような最小の正整数 $ k $ を求めてください。

すなわち、$ S $ の $ 1 $ 文字目から $ i $ 文字目までを取り出した文字列を $ S_i $ としたときに、 $ k $ 個の $ 1 $ 以上 $ |S| $ 以下の整数の組 $ (a_1,a_2,\ldots,\ a_k) $ によって、  
 $ T=S_{a_1}+S_{a_2}+\cdots\ +S_{a_k} $（ここで $ + $ は文字列としての連結を表す）と書くことができるような 最小の正整数 $ k $ を求めてください。

$ T $ と一致させる事が不可能な場合は $ -1 $ を出力してください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ S $ $ T $

## 输出格式

$ S $ の接頭辞を $ k $ 個連結することで $ T $ と一致させられるような最小の正整数 $ k $ を出力せよ。 $ T $ と一致させる事が不可能な場合は $ -1 $ を出力せよ。

## 说明/提示

### 制約

- $ 1\ \leq\ |S|\ \leq\ 5\times\ 10^5 $
- $ 1\ \leq\ |T|\ \leq\ 5\times\ 10^5 $
- $ S,T $ は英小文字のみからなる文字列

### Sample Explanation 1

$ T= $ `ababaab` は `ab` + `aba` + `ab` と書け、`ab`, `aba` はそれぞれ $ S= $ `aba` の接頭辞となっています。 `ababaab` を $ 2 $ 個以下の `aba` の接頭辞の連結によって表す方法はないため、$ 3 $ を出力します。

### Sample Explanation 2

$ T $ を $ S $ の接頭辞の連結によって表す方法はないため、$ -1 $ を出力します。

## 样例 #1

### 输入

```
aba

ababaab
```

### 输出

```
3
```

## 样例 #2

### 输入

```
atcoder

ac
```

### 输出

```
-1
```



---

---
title: "[ABC258F] Main Street"
layout: "post"
diff: 提高+/省选-
pid: AT_abc258_f
tag: []
---

# [ABC258F] Main Street

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc258/tasks/abc258_f

xy 平面上にある AtCoder 王国の道路は、全ての整数 $ n $ に対する直線 $ x=n $ および直線 $ y=n $ からなります。 そのうち、全ての整数 $ n $ に対する直線 $ x=Bn $ および直線 $ y=Bn $ は大通りです。

高橋君は $ (x,y) $ にいるときに、$ (x,y-1),(x,y+1),(x+1,y),(x-1,y) $ のいずれかに移動することができます。 また、$ 1 $ 回の移動につき、大通りに沿って移動する場合は $ 1 $ 秒、それ以外の場合は $ K $ 秒かかります。

$ (S_x,S_y) $ にいる高橋君が $ (G_x,G_y) $ に移動するのに最短で何秒かかるかを求めてください。

この問題は $ T $ ケース与えられます。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ T $ $ \mathrm{testcase}_1 $ $ \mathrm{testcase}_2 $ $ \vdots $ $ \mathrm{testcase}_T $

それぞれのテストケースは以下の形式で与えられる。

> $ B $ $ K $ $ S_x $ $ S_y $ $ G_x $ $ G_y $

## 输出格式

$ T $ 行出力せよ。$ i $ 行目には $ i $ 個目のテストケースの解を出力せよ。

## 说明/提示

### 制約

- $ 1\ \le\ T\ \le\ 2\ \times\ 10^5 $
- $ 1\ \le\ B,K\ \le\ 10^9 $
- $ 0\ \le\ S_x,S_y,G_x,G_y\ \le\ 10^9 $
- 入力はすべて整数。

### Sample Explanation 1

$ 1 $ 個目のテストケースについて、$ (2,2) $ から $ (2,3) $ に $ 4 $ 秒かけて移動し、$ (2,3) $ から $ (4,3) $ に $ 2 $ 秒かけて移動し、$ (4,3) $ から $ (4,4) $ に $ 4 $ 秒かけて移動することで $ 10 $ 秒で $ (2,2) $ から $ (4,4) $ に移動することができます。$ 10 $ 秒より早く移動することはできないため、解は $ 10 $ です。 $ 2 $ 個目のテストケースについて、初めから $ (G_x,G_y) $ にいるため解は $ 0 $ です。

## 样例 #1

### 输入

```
4
3 4 2 2 4 4
5 6 2 3 2 3
1 1000000000 0 0 1000000000 1000000000
1000000000 1000000000 500000000 500000000 1000000000 1000000000
```

### 输出

```
10
0
2000000000
500000000500000000
```

## 样例 #2

### 输入

```
10
928184439 674654465 203937094 186855052 851783856 805293696
55480262 448852233 823161539 786348805 550018803 322680316
891870741 235679524 32164572 497841190 620600021 96487871
321502816 428964257 499656016 521484999 717623189 824784374
144040837 680268887 76238777 371138006 350230937 78690135
768922620 799628518 403830696 60449731 218880692 88319939
482031503 121412614 472330444 284479575 949635609 427232765
389524418 132987043 656496997 678732442 23028233 488463974
857778764 629964237 714551548 739330018 579247790 874251485
461612428 535402609 555160129 833592114 44418273 287363785
```

### 输出

```
177606591118701316
6205925075792263
30320747646118343
84136273267803188
83764071874751489
118960470930399064
2929499649126153
16403238161749820
84995699148879437
71771264361119335
```



---

---
title: "[ABC258G] Triangle"
layout: "post"
diff: 提高+/省选-
pid: AT_abc258_g
tag: []
---

# [ABC258G] Triangle

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc258/tasks/abc258_g

$ N $ 頂点単純無向グラフ $ G $ が与えられます。

$ G $ は $ N $ 行 $ N $ 列の隣接行列 $ A $ によって与えられます。つまり、$ A_{i,j} $ が $ 1 $ である場合は頂点 $ i,j $ 間に辺があることを、$ 0 $ である場合には辺がないことを意味します。

$ 1\ \le\ i\ <\ j\ <\ k\ \le\ N $ を満たす整数の組 $ (i,j,k) $ のうち、頂点 $ i,j $ 間にも頂点 $ j,k $ 間にも頂点 $ i,k $ 間にも辺があるようなものの個数を求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ A_{1,1}A_{1,2}\dots\ A_{1,N} $ $ A_{2,1}A_{2,2}\dots\ A_{2,N} $ $ \vdots $ $ A_{N,1}A_{N,2}\dots\ A_{N,N} $

## 输出格式

答えを出力せよ。

## 说明/提示

### 制約

- $ 3\ \le\ N\ \le\ 3000 $
- $ A $ は単純無向グラフ $ G $ の隣接行列である。
- 入力はすべて整数。

### Sample Explanation 1

$ (i,j,k)=(1,3,4),(2,3,4) $ が条件を満たします。 $ (i,j,k)=(1,2,3) $ は、頂点 $ 1,2 $ 間に辺がないため条件を満たしません。 よって、解は $ 2 $ です。

## 样例 #1

### 输入

```
4

0011

0011

1101

1110
```

### 输出

```
2
```

## 样例 #2

### 输入

```
10

0000000000

0000000000

0000000000

0000000000

0000000000

0000000000

0000000000

0000000000

0000000000

0000000000
```

### 输出

```
0
```



---

---
title: "[ABC259F] Select Edges"
layout: "post"
diff: 提高+/省选-
pid: AT_abc259_f
tag: []
---

# [ABC259F] Select Edges

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc259/tasks/abc259_f

$ N $ 頂点の木が与えられます。 $ i\ =\ 1,\ 2,\ \ldots,\ N-1 $ について、$ i $ 番目の辺は頂点 $ u_i $ と頂点 $ v_i $ を結ぶ重み $ w_i $ の辺です。

$ N-1 $ 本の辺のうちのいくつか（ $ 0 $ 本または $ N-1 $ 本すべてでも良い）を選ぶことを考えます。 ただし、$ i\ =\ 1,\ 2,\ \ldots,\ N $ について、頂点 $ i $ に接続する辺は $ d_i $ 本までしか選べません。 選ぶ辺の重みの総和としてあり得る最大値を求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ d_1 $ $ d_2 $ $ \ldots $ $ d_N $ $ u_1 $ $ v_1 $ $ w_1 $ $ u_2 $ $ v_2 $ $ w_2 $ $ \vdots $ $ u_{N-1} $ $ v_{N-1} $ $ w_{N-1} $

## 输出格式

答えを出力せよ。

## 说明/提示

### 制約

- $ 2\ \leq\ N\ \leq\ 3\ \times\ 10^5 $
- $ 1\ \leq\ u_i,\ v_i\ \leq\ N $
- $ -10^9\ \leq\ w_i\ \leq\ 10^9 $
- $ d_i $ は頂点 $ i $ の次数以下の非負整数
- 与えられるグラフは木である
- 入力はすべて整数

### Sample Explanation 1

$ 1,\ 2,\ 5,\ 6 $ 番目の辺を選ぶと、選ぶ辺の重みは $ 8\ +\ 9\ +\ 8\ +\ 3\ =\ 28 $ となります。これがあり得る最大値です。

## 样例 #1

### 输入

```
7

1 2 1 0 2 1 1

1 2 8

2 3 9

2 4 10

2 5 -3

5 6 8

5 7 3
```

### 输出

```
28
```

## 样例 #2

### 输入

```
20

0 2 0 1 2 1 0 0 3 0 1 1 1 1 0 0 3 0 1 2

4 9 583

4 6 -431

5 9 325

17 6 131

17 2 -520

2 16 696

5 7 662

17 15 845

7 8 307

13 7 849

9 19 242

20 6 909

7 11 -775

17 18 557

14 20 95

18 10 646

4 3 -168

1 3 -917

11 12 30
```

### 输出

```
2184
```



---

---
title: "[ABC260F] Find 4-cycle"
layout: "post"
diff: 提高+/省选-
pid: AT_abc260_f
tag: []
---

# [ABC260F] Find 4-cycle

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc260/tasks/abc260_f

$ S+T $ 頂点 $ M $ 辺の単純無向グラフ $ G $ があります。頂点には $ 1 $ から $ S+T $ の番号が、辺には $ 1 $ から $ M $ の番号が割り振られています。辺 $ i $ は頂点 $ u_i $ と頂点 $ v_i $ を結んでいます。  
 また、頂点集合 $ V_1\ =\ \lbrace\ 1,\ 2,\dots,\ S\rbrace $ および $ V_2\ =\ \lbrace\ S+1,\ S+2,\ \dots,\ S+T\ \rbrace $ はともに独立集合です。

長さ $ 4 $ のサイクルを 4-cycle と呼びます。  
 $ G $ が 4-cycle を含む場合、4-cycle をどれか 1 つ選び、選んだサイクルに含まれる頂点を出力してください。頂点を出力する順番は自由です。  
 $ G $ が 4-cycle を含まない場合、 `-1` を出力してください。

 独立集合とは？ グラフ $ G $ の独立集合とは、$ G $ に含まれるいくつかの頂点からなる集合 $ V' $ であって、$ V' $ に含まれる任意の $ 2 $ つの頂点の間に辺がないものを言います。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ S $ $ T $ $ M $ $ u_1 $ $ v_1 $ $ u_2 $ $ v_2 $ $ \vdots $ $ u_M $ $ v_M $

## 输出格式

$ G $ が 4-cycle を含む場合は、任意の 4-cycle を 1 つ選び、選んだサイクルに含まれている相異なる $ 4 $ 個の頂点の番号を出力せよ。(頂点の順番は問わない。)  
 $ G $ が 4-cycle を含まない場合は `-1` を出力せよ。

## 说明/提示

### 制約

- $ 2\ \leq\ S\ \leq\ 3\ \times\ 10^5 $
- $ 2\ \leq\ T\ \leq\ 3000 $
- $ 4\ \leq\ M\ \leq\ \min(S\ \times\ T,3\ \times\ 10^5) $
- $ 1\ \leq\ u_i\ \leq\ S $
- $ S\ +\ 1\ \leq\ v_i\ \leq\ S\ +\ T $
- $ i\ \neq\ j $ ならば $ (u_i,\ v_i)\ \neq\ (u_j,\ v_j) $
- 入力される値はすべて整数

### Sample Explanation 1

頂点 $ 1 $ と $ 4 $ 、$ 4 $ と $ 2 $、$ 2 $ と $ 5 $、$ 5 $ と $ 1 $ の間に辺があるので 頂点 $ 1,2,4,5 $ は 4-cycle をなします。よって $ 1,\ 2,\ 4,\ 5 $ を出力すればよいです。 頂点を出力する順番は自由で、出力例のほかにも例えば `2 5 1 4` のような出力も正答となります。

### Sample Explanation 2

$ G $ が 4-cycle を含まない入力もあります。

## 样例 #1

### 输入

```
2 3 5

1 3

1 4

1 5

2 4

2 5
```

### 输出

```
1 2 4 5
```

## 样例 #2

### 输入

```
3 2 4

1 4

1 5

2 5

3 5
```

### 输出

```
-1
```

## 样例 #3

### 输入

```
4 5 9

3 5

1 8

3 7

1 9

4 6

2 7

4 8

1 7

2 9
```

### 输出

```
1 7 2 9
```



---

---
title: "[ABC260G] Scalene Triangle Area"
layout: "post"
diff: 提高+/省选-
pid: AT_abc260_g
tag: []
---

# [ABC260G] Scalene Triangle Area

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc260/tasks/abc260_g

$ N\ \times\ N $ のグリッドがあり、このグリッドの上から $ i $ マス目、左から $ j $ マス目を $ (i,j) $ と呼びます。  
 このグリッドの各マスには高々 $ 1 $ 個のコマが置かれています。  
 グリッドの状態は $ N $ 個の文字列 $ S_i $ として与えられ、

- $ S_i $ の $ j $ 文字目が `O` であるとき $ (i,j) $ に $ 1 $ つコマが置かれていること
- $ S_i $ の $ j $ 文字目が `X` であるとき $ (i,j) $ にコマは置かれていないこと

を表します。

整数 $ M $ が与えられます。 この $ M $ を使って、 $ (s,t) $ に置かれているコマ $ P $ について、以下の条件を全て満たすマス $ (u,v) $ を $ P $ が守っているマスと定義します。

- $ s\ \le\ u\ \le\ N $
- $ t\ \le\ v\ \le\ N $
- $ (u\ -\ s)\ +\ \frac{(v\ -\ t)}{2}\ <\ M $

$ Q $ 個のマス $ (X_i,Y_i) $ について、そのマスを守っているコマの個数を求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ M $ $ S_1 $ $ S_2 $ $ \vdots $ $ S_N $ $ Q $ $ X_1 $ $ Y_1 $ $ X_2 $ $ Y_2 $ $ \vdots $ $ X_Q $ $ Y_Q $

## 输出格式

$ Q $ 行出力せよ。  
 そのうち $ i $ ( $ 1\ \le\ i\ \le\ Q $ ) 行目には、マス $ (X_i,Y_i) $ を守っているコマの個数を整数として出力せよ。

## 说明/提示

### 制約

- $ N,M,X_i,Y_i,Q $ は整数
- $ 1\ \le\ N\ \le\ 2000 $
- $ 1\ \le\ M\ \le\ 2\ \times\ N $
- $ S_i $ は `O`, `X` からなる
- $ 1\ \le\ Q\ \le\ 2\ \times\ 10^5 $
- $ 1\ \le\ X_i,Y_i\ \le\ N $

### Sample Explanation 1

マス $ (1,1) $ のみにコマが置かれ、このコマによって以下の `#` のマスが守られます。 ``` #### ##.. .... .... ```

## 样例 #1

### 输入

```
4 2

OXXX

XXXX

XXXX

XXXX

6

1 1

1 4

2 2

2 3

3 1

4 4
```

### 输出

```
1

1

1

0

0

0
```

## 样例 #2

### 输入

```
5 10

OOOOO

OOOOO

OOOOO

OOOOO

OOOOO

5

1 1

2 3

3 4

4 2

5 5
```

### 输出

```
1

6

12

8

25
```

## 样例 #3

### 输入

```
8 5

OXXOXXOX

XOXXOXOX

XOOXOOXO

OXOOXOXO

OXXOXXOX

XOXXOXOX

XOOXOOXO

OXOOXOXO

6

7 2

8 1

4 5

8 8

3 4

1 7
```

### 输出

```
5

3

9

14

5

3
```



---

---
title: "[ABC262F] Erase and Rotate"
layout: "post"
diff: 提高+/省选-
pid: AT_abc262_f
tag: []
---

# [ABC262F] Erase and Rotate

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc262/tasks/abc262_f

$ 1,2,\ldots,N $ がちょうど $ 1 $ 回ずつ現れる数列 $ P\ =\ (p_1,p_2,\ldots,p_N) $ が与えられます。  
あなたは以下の操作のうち $ 1 $ つを選んで行うことを $ 0 $ 回以上 $ K $ 回以下繰り返せます。

- $ P $ の項を $ 1 $ つ選び、削除する。
- $ P $ の末尾の項を先頭に移動させる。

操作後の $ P $ として考えられるもののうち辞書順で最小のものを求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ K $ $ p_1 $ $ p_2 $ $ \ldots $ $ p_N $

## 输出格式

操作後の $ P $ として考えられるもののうち辞書順で最小のものを空白区切りで出力せよ。

## 说明/提示

### 制約

- $ 1\ \leq\ N\ \leq\ 2\ \times\ 10^5 $
- $ 0\ \leq\ K\ \leq\ N-1 $
- $ 1\ \leq\ p_i\ \leq\ N $
- $ (p_1,p_2,\ldots,p_N) $ には $ 1,2,\ldots,N $ がちょうど $ 1 $ 回ずつ現れる。
- 入力はすべて整数

### Sample Explanation 1

以下のように操作をすると $ P $ は $ (1,2,3) $ になります。 - 先頭の項を削除する。これによって $ P $ は $ (5,2,3,1) $ になる。 - 末尾の項を先頭に移動させる。これによって $ P $ は $ (1,5,2,3) $ になる。 - 先頭から $ 2 $ 番目の項を削除する。これによって $ P $ は $ (1,2,3) $ になる。 また、辞書順で $ (1,2,3) $ より小さい数列は操作後の $ P $ として考えられません。よってこれが答えです。

### Sample Explanation 2

操作を $ 1 $ 回も行えない場合があります。

## 样例 #1

### 输入

```
5 3
4 5 2 3 1
```

### 输出

```
1 2 3
```

## 样例 #2

### 输入

```
3 0
3 2 1
```

### 输出

```
3 2 1
```

## 样例 #3

### 输入

```
15 10
12 10 7 2 8 11 9 1 6 14 3 15 13 5 4
```

### 输出

```
1 3 4 7 2 8 11 9
```



---

---
title: "[ABC263F] Tournament"
layout: "post"
diff: 提高+/省选-
pid: AT_abc263_f
tag: []
---

# [ABC263F] Tournament

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc263/tasks/abc263_f

$ 1 $ から $ 2^N $ の番号がついた $ 2^N $ 人でじゃんけん大会を行います。

大会は以下の形式で行われます。

- 参加者を人 $ 1 $、人 $ 2 $、 $ \ldots $、人 $ 2^N $ の順に横一列に並べる。
- 現在の列の長さを $ 2M $ として、各 $ i\ (1\leq\ i\ \leq\ M) $ について左から $ 2i-1 $ 番目の人と左から $ 2i $ 番目の人で試合を行い、負けた $ M $ 人を列から外す。これを $ N $ 回繰り返す。

ここで、人 $ i $ はちょうど $ j $ 回試合に勝つと $ C_{i,j} $ 円獲得できます。$ 1 $ 回も勝たなかった場合は何も貰えません。全ての試合の勝敗を自由に決められるとき、人 $ 1 $、人 $ 2 $、 $ \ldots $、人 $ 2^N $ が貰えるお金の合計の最大値を求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ C_{1,1} $ $ C_{1,2} $ $ \ldots $ $ C_{1,N} $ $ C_{2,1} $ $ C_{2,2} $ $ \ldots $ $ C_{2,N} $ $ \vdots $ $ C_{2^N,1} $ $ C_{2^N,2} $ $ \ldots $ $ C_{2^N,N} $

## 输出格式

答えを出力せよ。

## 说明/提示

### 制約

- $ 1\ \leq\ N\ \leq\ 16 $
- $ 1\ \leq\ C_{i,j}\ \leq\ 10^9 $
- 入力は全て整数

### Sample Explanation 1

初めの列は $ (1,2,3,4) $ です。 人 $ 1 $ と人 $ 2 $ の試合で人 $ 2 $ が勝ち、人 $ 3 $ と人 $ 4 $ の試合で人 $ 4 $ が勝ったとすると、列は $ (2,4) $ になります。 次に人 $ 2 $ と人 $ 4 $ の試合で人 $ 4 $ が勝ったとすると、列は $ (4) $ になり、これで大会が終了となります。 このとき、人 $ 2 $ はちょうど $ 1 $ 回勝ち、人 $ 4 $ はちょうど $ 2 $ 回勝ったので、貰えるお金の合計は $ 0+6+0+9=15 $ となります。 これが貰えるお金の合計の最大値です。

## 样例 #1

### 输入

```
2
2 5
6 5
2 1
7 9
```

### 输出

```
15
```

## 样例 #2

### 输入

```
3
1 1 1
1 1 1
1 1 1
1 1 1
1 1 1
1 1 1
1 1 1
1 1 1
```

### 输出

```
4
```



---

---
title: "[ABC263G] Erasing Prime Pairs"
layout: "post"
diff: 提高+/省选-
pid: AT_abc263_g
tag: []
---

# [ABC263G] Erasing Prime Pairs

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc263/tasks/abc263_g

黒板に $ N $ 種類の整数が書かれています。 $ i $ 種類目の整数は $ A_i $ で、書かれている個数は $ B_i $ 個です。

あなたは次の操作を可能な限り繰り返すことができます。

- 黒板に書かれている $ 2 $ 個の整数 $ x,y $ であって、$ x+y $ が素数であるものを選ぶ。 選んだ $ 2 $ 個の整数を黒板から消す。

操作を最大で何回行えるか求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ A_1 $ $ B_1 $ $ A_2 $ $ B_2 $ $ \vdots $ $ A_N $ $ B_N $

## 输出格式

答えを出力せよ。

## 说明/提示

### 制約

- $ 1\ \leq\ N\ \leq\ 100 $
- $ 1\ \leq\ A_i\ \leq\ 10^7 $
- $ 1\ \leq\ B_i\ \leq\ 10^9 $
- $ A_i $ は全て異なる
- 入力は全て整数

### Sample Explanation 1

$ 2\ +\ 3\ =\ 5 $ であり、$ 5 $ は素数なので、$ 2 $ と $ 3 $ を選んで消す操作が行えます。また、それ以外の操作は行えません。 $ 2 $ は $ 4 $ 個、 $ 3 $ は $ 3 $ 個あるので、操作を $ 3 $ 回行うことができます。

### Sample Explanation 2

$ 1+\ 1\ =\ 2 $ であり、$ 2 $ は素数なので、$ 1 $ と $ 1 $ を選んで消す操作が行えます。$ 1 $ は $ 4 $ 個あるので、操作を $ 2 $ 回行うことができます。

## 样例 #1

### 输入

```
3

3 3

2 4

6 2
```

### 输出

```
3
```

## 样例 #2

### 输入

```
1

1 4
```

### 输出

```
2
```



---

---
title: "[ABC264G] String Fair"
layout: "post"
diff: 提高+/省选-
pid: AT_abc264_g
tag: []
---

# [ABC264G] String Fair

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc264/tasks/abc264_g

文字列品評会では、英小文字のみからなる空でない文字列 $ S $ に対して、その「美しさ」を決定します。

文字列 $ S $ の美しさは、$ N $ 個の審査項目の点数の和として定められます。 $ i\ =\ 1,\ 2,\ \ldots,\ N $ について、$ i $ 番目の審査項目の点数は 「文字列 $ T_i $（入力で与えられる**長さ $ 3 $ 以下**の文字列）が $ S $ に連続な部分文字列として含まれる回数」に $ P_i $ を掛けて得られる値です。

英小文字のみからなる**空でない**文字列 $ S $ の美しさとしてあり得る最大値を出力して下さい。 ただし、美しさとしていくらでも大きい値が考えられる場合は、代わりに `Infinity` と出力して下さい。

ここで、文字列 $ U\ =\ U_1U_2\ldots\ U_{|U|} $ に文字列 $ V $ が連続な部分列として含まれる回数とは、 $ 1\ \leq\ i\ \leq\ |U|-|V|+1 $ を満たす整数 $ i $ であって $ U_iU_{i+1}\ldots\ U_{i+|V|-1}\ =\ V $ を満たすものの個数です。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ T_1 $ $ P_1 $ $ T_2 $ $ P_2 $ $ \vdots $ $ T_N $ $ P_N $

## 输出格式

英小文字のみからなる**空でない**文字列 $ S $ の美しさとしてあり得る最大値を出力せよ。 ただし、美しさとしていくらでも大きい値が考えられる場合は、代わりに `Infinity` と出力せよ。

## 说明/提示

### 制約

- $ 1\ \leq\ N\ \leq\ 18278 $
- $ N $ は整数
- $ T_i $ は英小文字のみからなる長さ $ 1 $ 以上 $ 3 $ 以下の文字列
- $ i\ \neq\ j\ \Rightarrow\ T_i\ \neq\ T_j $
- $ -10^9\ \leq\ P_i\ \leq\ 10^9 $
- $ P_i $ は整数

### Sample Explanation 1

例えば、$ S\ = $ `abzabz` について、 - $ 1 $ 番目の審査項目の点数は、`a` が $ S $ に連続な部分列として含まれる回数が $ 2 $ 回であることから、$ 2\ \times\ (-5)\ =\ -10 $ 点 - $ 2 $ 番目の審査項目の点数は、`ab` が $ S $ に連続な部分列として含まれる回数が $ 2 $ 回であることから、$ 2\ \times\ 10\ =\ 20 $ 点 - $ 3 $ 番目の審査項目の点数は、`ba` が $ S $ に連続な部分列として含まれる回数が $ 0 $ 回であることから、$ 0\ \times\ (-20)\ =\ 0 $ 点 であるので、$ S $ の美しさは $ (-10)\ +\ 20\ +\ 0\ =\ 10 $ となります。 別の例として、$ S\ = $ `abzabzabz` について、 - $ 1 $ 番目の審査項目の点数は、`a` が $ S $ に連続な部分列として含まれる回数が $ 3 $ 回であることから、$ 3\ \times\ (-5)\ =\ -15 $ 点 - $ 2 $ 番目の審査項目の点数は、`ab` が $ S $ に連続な部分列として含まれる回数が $ 3 $ 回であることから、$ 3\ \times\ 10\ =\ 30 $ 点 - $ 3 $ 番目の審査項目の点数は、`ba` が $ S $ に連続な部分列として含まれる回数が $ 0 $ 回であることから、$ 0\ \times\ (-20)\ =\ 0 $ 点 であるので、$ S $ の美しさは $ (-15)\ +\ 30\ +\ 0\ =\ 15 $ となります。 一般に、正の整数 $ X $ について、`abz` を $ X $ 回繰り返した文字列の美しさは $ 5X $ となります。 $ S $ の美しさとしていくらでも大きい値が考えられるため、`Infinity` を出力します。

### Sample Explanation 2

$ S\ = $ `ab` が考えられる美しさの最大値を達成します。

### Sample Explanation 3

$ S $ は空でない文字列でなければならないことに注意して下さい。

## 样例 #1

### 输入

```
3

a -5

ab 10

ba -20
```

### 输出

```
Infinity
```

## 样例 #2

### 输入

```
28

a -5

ab 10

ba -20

bb -20

bc -20

bd -20

be -20

bf -20

bg -20

bh -20

bi -20

bj -20

bk -20

bl -20

bm -20

bn -20

bo -20

bp -20

bq -20

br -20

bs -20

bt -20

bu -20

bv -20

bw -20

bx -20

by -20

bz -20
```

### 输出

```
5
```

## 样例 #3

### 输入

```
26

a -1

b -1

c -1

d -1

e -1

f -1

g -1

h -1

i -1

j -1

k -1

l -1

m -1

n -1

o -1

p -1

q -1

r -1

s -1

t -1

u -1

v -1

w -1

x -1

y -1

z -1
```

### 输出

```
-1
```



---

---
title: "[ABC265G] 012 Inversion"
layout: "post"
diff: 提高+/省选-
pid: AT_abc265_g
tag: []
---

# [ABC265G] 012 Inversion

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc265/tasks/abc265_g

各要素が $ 0,1,2 $ のいずれかである長さ $ N $ の数列 $ A=(A_1,\ldots,A_N) $ が与えられます。  
 $ Q $ 個のクエリを順に処理してください。各クエリは以下の $ 2 $ 種類のいずれかです。

- `1 L R`：数列 $ (A_L,\ldots,A_R) $ の転倒数を出力する
- `2 L R S T U`： $ L\leq\ i\ \leq\ R $ を満たす各 $ i $ について、$ A_i $ が $ 0 $ なら $ S $ に、$ 1 $ なら $ T $ に、$ 2 $ なら $ U $ に置き換える
 
転倒数とは？ 数列 $ B\ =\ (B_1,\ \ldots,\ B_M) $ の転倒数とは、整数の組 $ (i,\ j) $ $ (1\ \leq\ i\ であって\ B_i\ >\ B_j $ を満たすものの個数です。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ Q $ $ A_1 $ $ A_2 $ $ \ldots $ $ A_N $ $ \rm\ Query_1 $ $ \rm\ Query_2 $ $ \vdots $ $ \rm\ Query_Q $

ここで $ i $ 番目のクエリを表す $ \rm\ Query_i $ は以下のいずれかの形式で与えられる。

> $ 1 $ $ L $ $ R $

> $ 2 $ $ L $ $ R $ $ S $ $ T $ $ U $

## 输出格式

$ 1 $ 種類目のクエリに対する答えを順に改行区切りで出力せよ。

## 说明/提示

### 制約

- $ 1\ \leq\ N\ \leq\ 10^5 $
- $ 0\ \leq\ A_i\ \leq\ 2 $
- $ 1\leq\ Q\leq\ 10^5 $
- 各クエリにおいて、$ 1\leq\ L\ \leq\ R\ \leq\ N $
- $ 2 $ 種類目のクエリにおいて、$ 0\leq\ S,T,U\ \leq\ 2 $
- 入力に含まれる値は全て整数である

### Sample Explanation 1

最初 $ A=(2,0,2,1,0) $ です。 - $ 1 $ 番目のクエリにおいて、$ (A_2,A_3,A_4,A_5)=(0,2,1,0) $ の転倒数 $ 3 $ を出力します。 - $ 2 $ 番目のクエリを処理すると、$ A=(2,2,0,1,0) $ となります。 - $ 3 $ 番目のクエリにおいて、$ (A_2,A_3,A_4,A_5)=(2,0,1,0) $ の転倒数 $ 4 $ を出力します。

## 样例 #1

### 输入

```
5 3

2 0 2 1 0

1 2 5

2 2 4 2 1 0

1 2 5
```

### 输出

```
3

4
```

## 样例 #2

### 输入

```
3 3

0 1 2

1 1 1

2 1 3 0 0 0

1 1 3
```

### 输出

```
0

0
```



---

---
title: "[ABC267F] Exactly K Steps"
layout: "post"
diff: 提高+/省选-
pid: AT_abc267_f
tag: []
---

# [ABC267F] Exactly K Steps

## 题目描述

给定一棵有 $N$ 个点的树，每个点的编号分别为 $1,2,\cdots,N$；给定的第 $i(1\leq i\leq N-1)$ 条边连接编号为 $A_i,B_i$ 的点。

定义两点 $u,v$ 间的距离为这两个点之间的最短路径所包含的边数。

现有 $Q$ 组询问，对于第 $i$ 组询问，给定 $U_i,K_i$，找到任意一个离结点 $U_i$ 的距离恰好为 $K_i$ 的点，或报告无解。

## 输入格式

第一行一个整数 $N$。

接下来 $N-1$ 行，每行两个整数 $A_i,B_i$，表示 $A_i,B_i$ 间有一条边。

接下来一行一个整数 $Q$。

接下来 $Q$ 行，每行两个整数 $U_i,K_i$，意义如上所述。

## 输出格式

对于每一组询问，输出一行一个整数，表示与 $U_i$ 距离恰为 $K_i$ 的结点编号。若不止一个这样的结点，输出任意一个即可；特别地，若没有这样的结点，输出 `-1`。

## 样例 #1

### 输入

```
5
1 2
2 3
3 4
3 5
3
2 2
5 3
3 3
```

### 输出

```
4
1
-1
```

## 样例 #2

### 输入

```
10
1 2
2 3
3 5
2 8
3 4
4 6
4 9
5 7
9 10
5
1 1
2 2
3 3
4 4
5 5
```

### 输出

```
2
4
10
-1
-1
```



---

---
title: "[ABC268E] Chinese Restaurant (Three-Star Version)"
layout: "post"
diff: 提高+/省选-
pid: AT_abc268_e
tag: []
---

# [ABC268E] Chinese Restaurant (Three-Star Version)

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc268/tasks/abc268_e

回転テーブルの周りに人 $ 0 $、人 $ 1 $、$ \ldots $、人 $ N-1 $ がこの順番で反時計回りに等間隔で並んでいます。また、人 $ i $ の目の前には料理 $ p_i $ が置かれています。  
 あなたは次の操作を $ 0 $ 回以上何度でも行うことが出来ます。

- 回転テーブルを反時計回りに $ 1 $ 周の $ \frac{1}{N} $ だけ回す。これによって、(この操作の直前に)人 $ i $ の目の前にあった料理は人 $ (i+1)\ \bmod\ N $ の目の前に移動する。

操作を完了させた後において、人 $ i $ の不満度は料理 $ i $ が人 $ (i-k)\ \bmod\ N $、人 $ (i+k)\ \bmod\ N $ のいずれかの目の前に置かれているような最小の非負整数 $ k $ です。  
 $ N $ 人の不満度の総和の最小値を求めてください。

  $ a\ \bmod\ m $ とは 整数 $ a $ と正整数 $ m $ に対し、$ a\ \bmod\ m $ は $ a-x $ が $ m $ の倍数となるような $ 0 $ 以上 $ m $ 未満の整数 $ x $ を表します。(このような $ x $ は一意に定まることが証明できます)

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ p_0 $ $ \ldots $ $ p_{N-1} $

## 输出格式

答えを出力せよ。

## 说明/提示

### 制約

- $ 3\ \leq\ N\ \leq\ 2\ \times\ 10^5 $
- $ 0\ \leq\ p_i\ \leq\ N-1 $
- $ i\ \neq\ j $ ならば $ p_i\ \neq\ p_j $
- 入力はすべて整数

### Sample Explanation 1

操作を $ 1 $ 回行うと下の画像のようになります。 !\[\](https://img.atcoder.jp/abc268/70536a7b7fad87d6a49ad00df89a4a30.png) この時、不満度の総和が $ 2 $ になることを以下のように確かめられます。 - 人 $ 0 $ の不満度は、料理 $ 0 $ が人 $ 3\ (=(0-1)\ \bmod\ 4) $ の目の前に置かれているので $ 1 $ です。 - 人 $ 1 $ の不満度は、料理 $ 1 $ が人 $ 1\ (=(1+0)\ \bmod\ 4) $ の目の前に置かれているので $ 0 $ です。 - 人 $ 2 $ の不満度は、料理 $ 2 $ が人 $ 2\ (=(2+0)\ \bmod\ 4) $ の目の前に置かれているので $ 0 $ です。 - 人 $ 3 $ の不満度は、料理 $ 3 $ が人 $ 0\ (=(3+1)\ \bmod\ 4) $ の目の前に置かれているので $ 1 $ です。 不満度の総和を $ 2 $ より小さくすることは出来ないため、答えは $ 2 $ です。

## 样例 #1

### 输入

```
4

1 2 0 3
```

### 输出

```
2
```

## 样例 #2

### 输入

```
3

0 1 2
```

### 输出

```
0
```

## 样例 #3

### 输入

```
10

3 9 6 1 7 2 8 0 5 4
```

### 输出

```
20
```



---

---
title: "[ABC270G] Sequence in mod P"
layout: "post"
diff: 提高+/省选-
pid: AT_abc270_g
tag: []
---

# [ABC270G] Sequence in mod P

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc270/tasks/abc270_g

次の漸化式で定められる数列 $ X=(X_0,X_1,\ldots) $ があります。

$ X_i\ =\ \left\{
\begin{array}{ll}
S\  \ (i\ =\ 0)\\
(A\ X_{i-1}+B)\ \bmod\ P\  \ (i\ \geq\ 1)
\end{array}
\right. $

$ X_i=G $ となる $ i $ が存在するか判定し、存在するならばそのような最小の $ i $ を求めてください。  
ここで、$ x\ \bmod\ y $ は、$ x $ を $ y $ で割ったあまり(最小非負剰余)を表すものとします。

$ 1 $ ファイルにつき $ T $ 個のテストケースが与えられます。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ T $ $ \mathrm{case}_1 $ $ \mathrm{case}_2 $ $ \vdots $ $ \mathrm{case}_T $

各テストケースは以下の形式で与えられる。

> $ P $ $ A $ $ B $ $ S $ $ G $

## 输出格式

$ T $ 行出力せよ。  
$ t $ 行目には、$ \mathrm{case}_t $ について、$ X_i=G $ となる最小の $ i $ を出力せよ。そのような $ i $ が存在しないならかわりに `-1` を出力せよ。

## 说明/提示

### 制約

- $ 1\ \leq\ T\ \leq\ 100 $
- $ 2\ \leq\ P\ \leq\ 10^9 $
- $ P $ は素数
- $ 0\leq\ A,B,S,G\ <\ P $
- 入力に含まれる値は全て整数である

### Sample Explanation 1

$ 1 $ 番目のケースについて、$ X=(1,3,2,0,\ldots) $ であることから、$ X_i=0 $ となる最小の $ i $ は $ 3 $ です。 $ 2 $ 番目のケースについて、$ X=(3,3,3,3,\ldots) $ であることから、$ X_i=0 $ となる $ i $ は存在しません。

## 样例 #1

### 输入

```
3
5 2 1 1 0
5 2 2 3 0
11 1 1 0 10
```

### 输出

```
3
-1
10
```



---

---
title: "[ABC272G] Yet Another mod M"
layout: "post"
diff: 提高+/省选-
pid: AT_abc272_g
tag: []
---

# [ABC272G] Yet Another mod M

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc272/tasks/abc272_g

長さ $ N $ の正整数列 $ A=(A_1,A_2,\dots,A_N) $ が与えられます。ここで $ A $ の全ての要素は相異なります。

あなたは $ 3 $ 以上 $ 10^9 $ 以下の正整数 $ M $ を選び、以下の操作を $ 1 $ 回だけ行います。

- $ 1\ \le\ i\ \le\ N $ を満たす整数 $ i $ に対し、$ A_i $ を $ A_i\ \bmod\ M $ で置き換える。

うまく $ M $ を選ぶことで、操作後の $ A $ を以下の条件を満たした状態にすることができますか？ できるのであれば、そのような $ M $ を $ 1 $ 個求めてください。

- ある整数 $ x $ が存在して、$ x $ が $ A $ の過半数を占める。

ここで、整数 $ x $ が $ A $ の過半数を占めるとは、$ A_i\ =\ x $ を満たす整数 $ i $ の個数が $ A_i\ \neq\ x $ を満たす $ i $ の個数より多いことを言います。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ A_1 $ $ A_2 $ $ \dots $ $ A_N $

## 输出格式

条件を満たす $ M $ が存在するのであればそのような $ M $ を $ 1 $ 個出力せよ。そうでないならば $ -1 $ を出力せよ。

## 说明/提示

### 制約

- $ 3\ \le\ N\ \le\ 5000 $
- $ 1\ \le\ A_i\ \le\ 10^9 $
- $ A $ の全ての要素は相異なる
- 入力はすべて整数

### Sample Explanation 1

$ M=7 $ として操作を行うと、$ A=(3,3,1,0,3) $ となり $ 3 $ が $ A $ の過半数を占めるため $ M=7 $ は条件を満たします。

## 样例 #1

### 输入

```
5

3 17 8 14 10
```

### 输出

```
7
```

## 样例 #2

### 输入

```
10

822848257 553915718 220834133 692082894 567771297 176423255 25919724 849988238 85134228 235637759
```

### 输出

```
37
```

## 样例 #3

### 输入

```
10

1 2 3 4 5 6 7 8 9 10
```

### 输出

```
-1
```



---

---
title: "[ABC273F] Hammer 2"
layout: "post"
diff: 提高+/省选-
pid: AT_abc273_f
tag: []
---

# [ABC273F] Hammer 2

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc273/tasks/abc273_f

数直線の原点に高橋君がいます。高橋君は座標 $ X $ にあるゴールに移動しようとしています。

また、数直線上に $ N $ 枚の壁と $ N $ 本のハンマーがあります。

- 座標 $ Y_1,Y_2,\dots,Y_N $ にはそれぞれタイプ $ 1,2,\dots,N $ の壁があります。
  - 最初、高橋君は壁を超えて移動することができません。
- 座標 $ Z_1,Z_2,\dots,Z_N $ にはそれぞれタイプ $ 1,2,\dots,N $ のハンマーがあります。
  - 高橋君はハンマーのある座標に着くとそこにあるハンマーを手に入れます。
  - タイプ $ i $ のハンマーはタイプ $ i $ の壁を破壊するための専用のもので、タイプ $ i $ のハンマーを手に入れた後でなら、タイプ $ i $ の壁を破壊して通過できるようになります。

高橋君がゴールに到達することが可能か判定し、可能であれば移動距離の最小値を求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ X $ $ Y_1 $ $ Y_2 $ $ \dots $ $ Y_N $ $ Z_1 $ $ Z_2 $ $ \dots $ $ Z_N $

## 输出格式

高橋君がゴールに到達することが可能であれば移動距離の最小値を整数として出力せよ。  
 不可能であれば `-1` と出力せよ。

## 说明/提示

### 制約

- 入力は全て整数
- $ 1\ \le\ N\ \le\ 1500 $
- $ 1\ \le\ |X|,|Y_i|,|Z_i|\ \le\ 10^9 $
- 合計 $ 2\ \times\ N\ +\ 1 $ 個の座標 $ X,Y_i,Z_i $ は相異なる

### Sample Explanation 1

以下の手順により、移動距離 $ 40 $ で高橋くんがゴールに到達でき、これが移動距離の最小です。 - 座標 $ 0 $ から高橋君が行動を開始する。 - 座標 $ 3 $ に行く。タイプ $ 3 $ のハンマーを手に入れる。 - 座標 $ 5 $ に行く。タイプ $ 1 $ のハンマーを手に入れる。 - 座標 $ -2 $ に行く。タイプ $ 1 $ の壁を破壊する。 - 座標 $ -5 $ に行く。タイプ $ 3 $ の壁を破壊する。 - 座標 $ -10 $ に行く。タイプ $ 2 $ のハンマーを手に入れる。 - 座標 $ 8 $ に行く。タイプ $ 2 $ の壁を破壊する。 - 座標 $ 10 $ に行く。ここがゴールである。

### Sample Explanation 2

ゴールに移動するために、ハンマーを手に入れる必要も壁を破壊する必要もない場合もあります。

### Sample Explanation 3

高橋君がタイプ $ 1 $ のハンマーを手に入れることは不可能であり、ゴールに辿り着くこともできません。

## 样例 #1

### 输入

```
3 10

-2 8 -5

5 -10 3
```

### 输出

```
40
```

## 样例 #2

### 输入

```
5 -1

10 -20 30 -40 50

-10 20 -30 40 -50
```

### 输出

```
1
```

## 样例 #3

### 输入

```
1 100

30

60
```

### 输出

```
-1
```

## 样例 #4

### 输入

```
4 865942261

703164879 -531670946 -874856231 -700164975

-941120316 599462305 -649785130 665402307
```

### 输出

```
4078987507
```



---

---
title: "[ABC274F] Fishing"
layout: "post"
diff: 提高+/省选-
pid: AT_abc274_f
tag: []
---

# [ABC274F] Fishing

## 题目描述

有 $n$ 条鱼在数轴上移动。

第 $i$ 条鱼在时刻 $0$ 时在位置 $x_i$ 处，价值为 $w_i$，将会以每时刻 $t_i$ 的速度向数轴正方向前进。

你是一个渔夫，你有感应河流的能力，你已经知晓所有鱼的 $x,w,t$ 属性。

你会选择一个时刻 $t$，在位置 $x$ 撒下一张长度为 $a$ 的网，所有在时刻 $t$ 时处于区间 $[x,x+a]$ 的鱼都会被你捕获。

你想求出你撒一次网能捕获的鱼的价值和的最大值。

## 输入格式

第一行两个整数 $n,a$，含义如题中所述。

接下来 $n$ 行，第 $i+1$ 行三个整数，表示第 $i$ 条鱼的 $w,x,t$ 属性。

## 输出格式

一行一个整数，表示答案。

## 说明/提示

对于所有数据，$1\leq n\leq 2\times 10^3,1\leq a,w_i,x_i,t_i\leq 10^4$。

Translate by Zek3L.

## 样例 #1

### 输入

```
3 10

100 0 100

1 10 30

10 20 10
```

### 输出

```
111
```

## 样例 #2

### 输入

```
3 10

100 100 100

1 10 30

10 20 10
```

### 输出

```
100
```

## 样例 #3

### 输入

```
4 10

1000 100 10

100 99 1

10 0 100

1 1 1
```

### 输出

```
1110
```



---

---
title: "[ABC274G] Security Camera 3"
layout: "post"
diff: 提高+/省选-
pid: AT_abc274_g
tag: []
---

# [ABC274G] Security Camera 3

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc274/tasks/abc274_g

縦 $ H $ 行、横 $ W $ 列のグリッドがあります。上から $ i $ 行目、左から $ j $ 列目のマスをマス $ (i,j) $ と表します。  
 マス $ (i,j) $ は $ S_{i,j}= $ `#` のとき障害物が置かれており、$ S_{i,j}= $ `.` のとき何も置かれていません。

高橋君はグリッド内にいくつか監視カメラを設置しようとしています。

監視カメラは障害物のないマスに上下左右の $ 4 $ 方向のいずれかの向きで置くことができます。  
 $ 1 $ つのマスに複数台の監視カメラを設置することも可能です。

各監視カメラは、監視カメラの置かれたマス、及び、監視カメラの向いている向きにある直線上のマスを、障害物に遮られない範囲で監視することができます。

障害物の置かれていない全てのマスを監視するためには、最小でいくつの監視カメラを設置する必要がありますか？

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ H $ $ W $ $ S_{1,1}\ldots\ S_{1,W} $ $ \vdots $ $ S_{H,1}\ldots\ S_{H,W} $

## 输出格式

答えを出力せよ。

## 说明/提示

### 制約

- $ 1\ \leq\ H,W\ \leq\ 300 $
- $ S_{i,j} $ は `.` または `#` である

### Sample Explanation 1

例えば、マス $ (1,1) $ に右向きと下向き、マス $ (3,3) $ に上向きと左向きの合計 $ 4 $ 台の監視カメラを設置すると、障害物の置かれていない全てのマスを監視することができます。

### Sample Explanation 2

例えば、マス $ (1,1) $ に右向きと下向き、マス $ (3,3) $ に左向き、マス $ (2,5) $ に左向きと下向きの合計 $ 5 $ 台の監視カメラを設置すると、障害物の置かれていない全てのマスを監視することができます。 マス $ (2,5) $ に左向きに設置したカメラは、マス $ (2,2) $ の障害物に遮られるため、マス $ (2,1) $ を監視できないことに注意してください。

## 样例 #1

### 输入

```
3 3

...

.#.

...
```

### 输出

```
4
```

## 样例 #2

### 输入

```
3 5

...##

.#...

...#.
```

### 输出

```
5
```

## 样例 #3

### 输入

```
14 107

...........................................................................................................

...........................................................................................................

..#########..###....###########..###.......###...###########..####.......###...###########...###########...

..########..###....###########....###.....###...###########...#####......###..###########...###########....

..#######..###.....###.............###...###....###...........######.....###..###...........###............

..######..###......###..............###.###.....###...........###.###....###..###...........###............

..#####..###.......############......#####......############..###..###...###..###...........############...

..####....###......############.......###.......############..###...###..###..###...........############...

..###......###.....###................###.......###...........###....###.###..###...........###............

..##........###....###................###.......###...........###.....######..###...........###............

..#..........###...############.......###.......############..###......#####..############..############...

..............###...###########.......###........###########..###.......####...###########...###########...

...........................................................................................................

...........................................................................................................
```

### 输出

```
91
```



---

---
title: "[ABC283F] Permutation Distance"
layout: "post"
diff: 提高+/省选-
pid: AT_abc283_f
tag: []
---

# [ABC283F] Permutation Distance

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc283/tasks/abc283_f

$ (1,2,\ldots,N) $ の順列 $ P=(P\ _\ 1,P\ _\ 2,\ldots,P\ _\ N) $ が与えられます。

すべての $ i\ (1\leq\ i\leq\ N) $ に対して、以下の値を求めてください。

- $ D\ _\ i=\displaystyle\min_{j\neq\ i}\left\lparen\left\lvert\ P\ _\ i-P\ _\ j\right\rvert+\left\lvert\ i-j\right\rvert\right\rparen $
 
 順列とは $ (1,2,\ldots,N) $ の順列とは、$ (1,2,\ldots,N) $ を並べ替えて得られる数列のことをいいます。 つまり、長さ $ N $ の数列 $ A $ は $ i\ (1\leq\ i\leq\ N) $ がその中にちょうど $ 1 $ 回だけ現れるとき、かつそのときに限り$ (1,2,\ldots,N) $ の順列です。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ P\ _\ 1 $ $ P\ _\ 2 $ $ \ldots $ $ P\ _\ N $

## 输出格式

$ D\ _\ i\ (1\leq\ i\leq\ N) $ を $ i $ の昇順に空白区切りで出力せよ。

## 说明/提示

### 制約

- $ 2\ \leq\ N\ \leq\ 2\times10^5 $
- $ 1\ \leq\ P\ _\ i\ \leq\ N\ (1\leq\ i\leq\ N) $
- $ i\neq\ j\implies\ P\ _\ i\neq\ P\ _\ j $
- 入力はすべて整数
 
### Sample Explanation 1

たとえば、$ i=1 $ について - $ j=2 $ のとき、$ \left\lvert\ P\ _\ i-P\ _\ j\right\rvert=1,\left\lvert\ i-j\right\rvert=1 $ です。 - $ j=3 $ のとき、$ \left\lvert\ P\ _\ i-P\ _\ j\right\rvert=1,\left\lvert\ i-j\right\rvert=2 $ です。 - $ j=4 $ のとき、$ \left\lvert\ P\ _\ i-P\ _\ j\right\rvert=2,\left\lvert\ i-j\right\rvert=3 $ です。 よって、$ j=2 $ のとき $ \left\lvert\ P\ _\ i-P\ _\ j\right\rvert+\left\lvert\ i-j\right\rvert=2 $ で最小となるので、$ D\ _\ 1=2 $ です。

## 样例 #1

### 输入

```
4

3 2 4 1
```

### 输出

```
2 2 3 3
```

## 样例 #2

### 输入

```
7

1 2 3 4 5 6 7
```

### 输出

```
2 2 2 2 2 2 2
```

## 样例 #3

### 输入

```
16

12 10 7 14 8 3 11 13 2 5 6 16 4 1 15 9
```

### 输出

```
3 3 3 5 3 4 3 3 4 2 2 4 4 4 4 7
```



---

---
title: "[ABC287F] Components"
layout: "post"
diff: 提高+/省选-
pid: AT_abc287_f
tag: []
---

# [ABC287F] Components

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc287/tasks/abc287_f

$ N $ 頂点の木があります。頂点には $ 1 $ から $ N $ までの番号が付いており、$ i $ 番目の辺は頂点 $ a_i $ と頂点 $ b_i $ を結んでいます。

$ x=1,2,\ldots,N $ に対して次の問題を解いてください。

- 木の頂点の部分集合 $ V $ であって空でないものは $ 2^N-1 $ 通り存在するが、そのうち $ V $ による誘導部分グラフの連結成分数が $ x $ であるようなものは何通りあるかを $ 998244353 $ で割った余りを求めよ。
 
 誘導部分グラフとは $ S $ をグラフ $ G $ の頂点の部分集合とします。このとき、$ G $ の $ S $ による誘導部分グラフとは、頂点集合が $ S $ で、辺集合が「$ G $ の辺であって両端が $ S $ に含まれるものすべて」であるようなグラフです。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ a_1 $ $ b_1 $ $ \vdots $ $ a_{N-1} $ $ b_{N-1} $

## 输出格式

$ N $ 行出力せよ。  
 $ i $ 行目には $ x=i $ に対する出力をせよ。

## 说明/提示

### 制約

- $ 1\ \leq\ N\ \leq\ 5000 $
- $ 1\ \leq\ a_i\ \lt\ b_i\ \leq\ N $
- 与えられるグラフは木
 
### Sample Explanation 1

以下の $ 5 $ 通りでは誘導部分グラフの連結成分数が $ 2 $、これら以外では $ 1 $ になります。 - $ V\ =\ \{1,2,4\} $ - $ V\ =\ \{1,3\} $ - $ V\ =\ \{1,3,4\} $ - $ V\ =\ \{1,4\} $ - $ V\ =\ \{2,4\} $

## 样例 #1

### 输入

```
4

1 2

2 3

3 4
```

### 输出

```
10

5

0

0
```

## 样例 #2

### 输入

```
2

1 2
```

### 输出

```
3

0
```

## 样例 #3

### 输入

```
10

3 4

3 6

6 9

1 3

2 4

5 6

6 10

1 8

5 7
```

### 输出

```
140

281

352

195

52

3

0

0

0

0
```



---

---
title: "[ABC287G] Balance Update Query"
layout: "post"
diff: 提高+/省选-
pid: AT_abc287_g
tag: []
---

# [ABC287G] Balance Update Query

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc287/tasks/abc287_g

高橋君は $ N $ 種類のカードを $ 10^{100} $ 枚ずつ持っています。はじめ、$ i $ 種類目のカードの得点は $ a_i $ で、使用可能枚数は $ b_i $ です。

以下の形式のクエリが $ Q $ 個与えられるので、順に処理してください。

- `1 x y` : $ x $ 種類目のカードの得点を $ y $ に設定
- `2 x y` : $ x $ 種類目のカードの使用可能枚数を $ y $ に設定
- `3 x` : 次の条件を満たすように $ x $ 枚のカードを選ぶことができるならば選ばれたカードの得点の総和の最大値を、そうでなければ `-1` を出力
  - どの種類のカードもその使用可能枚数を超えて選ばれない

## 输入格式

入力は以下の形式で標準入力から与えられる。ただし、$ \mathrm{query}_i $ で $ i $ 番目のクエリを表す。

> $ N $ $ a_1 $ $ b_1 $ $ \vdots $ $ a_N $ $ b_N $ $ Q $ $ \mathrm{query}_1 $ $ \vdots $ $ \mathrm{query}_Q $

## 输出格式

$ 3 $ 種類目のクエリの個数を $ M $ とする。$ M $ 行出力をせよ。  
 $ i $ 行目には $ i $ 番目の $ 3 $ 種類目のクエリに対する出力をせよ。

## 说明/提示

### 制約

- $ 1\ \leq\ N,Q\ \leq\ 2\ \times\ 10^5 $
- $ 0\ \leq\ a_i\ \leq\ 10^9 $
- $ 0\ \leq\ b_i\ \leq\ 10^4 $
- $ 1 $ 種類目のクエリにおいて $ 1\ \leq\ x\ \leq\ N,\ 0\ \leq\ y\ \leq\ 10^9 $
- $ 2 $ 種類目のクエリにおいて $ 1\ \leq\ x\ \leq\ N,\ 0\ \leq\ y\ \leq\ 10^4 $
- $ 3 $ 種類目のクエリにおいて $ 1\ \leq\ x\ \leq\ 10^9 $
- $ 3 $ 種類目のクエリが $ 1 $ 個以上含まれる
- 入力はすべて整数
 
### Sample Explanation 1

$ 1 $ 番目の $ 3 $ 種類目のクエリでは、$ 2 $ 種類目のカードを $ 1 $ 枚、$ 3 $ 種類目のカードを $ 3 $ 枚選ぶことで得点の総和が $ 11 $ となり、これが最大です。 $ 2 $ 番目の $ 3 $ 種類目のクエリでは、$ 1 $ 種類目のカードを $ 1 $ 枚、$ 3 $ 種類目のカードを $ 3 $ 枚選ぶことで得点の総和が $ 19 $ となり、これが最大です。 $ 3 $ 番目の $ 3 $ 種類目のクエリでは、$ 4 $ 枚のカードを選ぶことができないため出力は `-1` となります。 $ 4 $ 番目の $ 3 $ 種類目のクエリでは、$ 2 $ 種類目のカードを $ 2 $ 枚選ぶことで得点の総和が $ 4 $ となり、これが最大です。

## 样例 #1

### 输入

```
3

1 1

2 2

3 3

7

3 4

1 1 10

3 4

2 1 0

2 3 0

3 4

3 2
```

### 输出

```
11

19

-1

4
```



---

---
title: "[ABC288E] Wish List"
layout: "post"
diff: 提高+/省选-
pid: AT_abc288_e
tag: []
---

# [ABC288E] Wish List

## 题目描述

商店里有 $N$ 件商品，标号 $1\sim N$，第 $i$ 件商品有**底价** $A_i$ 且只有一件。

Takahashi 想要买其中的 $M$ 件商品，分别是标号 $X_1,X_2,\ldots,X_M$ 的商品。

他会按照以下的方式买东西：

若还剩 $r$ 件商品没有购买过，选择一个符合 $1\le j\le r$ 的 $j$，付这件商品的底价加上 $C_j$ 的钱购买其中标号第 $j$ 小的商品。

求出买到它想要的商品所付的最小价钱。

注意他也可以买不想要的商品。

## 输入格式

第一行两个正整数 $N$ 和 $M$（$1\le M\le N\le 5000$）表示物品数量和想要的物品数量。

第二行 $n$ 个正整数表示 $A$ 数组（$1\le A_i\le 10^9$）。

第三行 $n$ 个正整数表示 $C$ 数组（$1\le C_i\le 10^9$）。

第四行 $m$ 个正整数表示 $X$ 数组（$1\le X_1 < X_2 < \ldots < X_M\le N$）。

## 输出格式

一行一个正整数表示答案。

### 样例解释

样例 $1$ 中，下面是一种可行的方法：

- 一开始有标号为 $1,2,3,4,5$ 的物品。选择 $j = 5$，购买标号第 $5$ 小的物品（即物品 $5$），付 $A_5 + C_5 = 8$ 的钱；

- 此时有标号为 $1,2,3,4$ 的物品。选择 $j = 2$，购买标号第 $2$ 小的物品（即物品 $2$），付 $A_2 + C_2 = 3$ 的钱；

- 最后有标号为 $1,3,4$ 的物品。选择 $j = 2$，购买标号第 $2$ 小的物品（即物品 $3$），付 $A_3 + C_2 = 6$ 的钱。

Takahashi 现在买到了想要的物品（$3$ 和 $5$）以及一个不想要的物品 $2$，付了最少的 $8+3+6 = 17$ 的钱。

## 样例 #1

### 输入

```
5 2

3 1 4 1 5

9 2 6 5 3

3 5
```

### 输出

```
17
```

## 样例 #2

### 输入

```
20 8

29 27 79 27 30 4 93 89 44 88 70 75 96 3 78 39 97 12 53 62

32 38 84 49 93 53 26 13 25 2 76 32 42 34 18 77 14 67 88 12

1 3 4 5 8 14 16 20
```

### 输出

```
533
```



---

---
title: "[ABC289F] Teleporter Takahashi"
layout: "post"
diff: 提高+/省选-
pid: AT_abc289_f
tag: []
---

# [ABC289F] Teleporter Takahashi

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc289/tasks/abc289_f

$ xy $ 平面上に高橋くんがいます。 はじめ、高橋くんは点 $ (s\ _\ x,s\ _\ y) $ にいます。 高橋くんは、点 $ (t\ _\ x,t\ _\ y) $ に移動したいです。

$ xy $ 平面上に、長方形 $ R\coloneqq\lbrace(x,y)\mid\ a-0.5\leq\ x\leq\ b+0.5,c-0.5\leq\ y\leq\ d+0.5\rbrace $ があります。 次の操作を考えます。

- 長方形 $ R $ に含まれる格子点 $ (x,y) $ をひとつ選ぶ。 点 $ (x,y) $ を中心に高橋くんはいまいる位置と対称な位置に瞬間移動する。
 
上の操作を $ 0 $ 回以上 $ 10^6 $ 回以下繰り返して、高橋くんが点 $ (t\ _\ x,t\ _\ y) $ にいるようにできるか判定してください。 できる場合、高橋くんが点 $ (t\ _\ x,t\ _\ y) $ に移動することができるような操作の列を $ 1 $ つ構成してください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ s\ _\ x $ $ s\ _\ y $ $ t\ _\ x $ $ t\ _\ y $ $ a $ $ b $ $ c $ $ d $

## 输出格式

$ 1 $ 行目には、操作を $ 0 $ 回以上 $ 10^6 $ 回以下繰り返して高橋くんが点 $ (t\ _\ x,t\ _\ y) $ に到達できるなら `Yes` 、そうでなければ `No` と出力せよ。 $ 1 $ 行目で `Yes` と出力したとき、かつそのときに限り、あなたが構成した操作列の長さを $ d $ としてさらに $ d $ 行出力せよ（$ d $ は $ 0\leq\ d\leq10^6 $ を満たさなければならない）。 $ 1+i $ 行目 $ (1\leq\ i\leq\ d) $ には、$ i $ 回目の操作で選んだ点 $ (x,\ y)\in\ R $ の座標をこの順に空白区切りで出力せよ。

## 说明/提示

### 制約

- $ 0\leq\ s\ _\ x,s\ _\ y,t\ _\ x,t\ _\ y\leq2\times10^5 $
- $ 0\leq\ a\leq\ b\leq2\times10^5 $
- $ 0\leq\ c\leq\ d\leq2\times10^5 $
- 入力はすべて整数
 
### Sample Explanation 1

例えば、次のようにして $ (1,2) $ から $ (7,8) $ へ移動することができます。 - 点 $ (7,0) $ を選ぶ。高橋くんは $ (13,-2) $ に移動する。 - 点 $ (9,3) $ を選ぶ。高橋くんは $ (5,8) $ に移動する。 - 点 $ (7,1) $ を選ぶ。高橋くんは $ (9,-6) $ に移動する。 - 点 $ (8,1) $ を選ぶ。高橋くんは $ (7,8) $ に移動する。 !\[\](https://img.atcoder.jp/abc289/d6d2cc458bbc92e975ba267856f673cf.png) 条件を満たす操作の列であれば何を出力しても正答となるので、例えば ``` Yes 7 3 9 0 7 2 9 1 8 1 ``` と出力しても正答となります。 !\[\](https://img.atcoder.jp/abc289/3faa56b1d245b87bd4cc36083495383c.png)

### Sample Explanation 2

どのように操作しても点 $ (8,4) $ に移動することはできません。 !\[\](https://img.atcoder.jp/abc289/eb363d09e74f89c5474a4fc7529308bc.png)

### Sample Explanation 3

高橋くんがはじめから目的地にいる場合もあります。

## 样例 #1

### 输入

```
1 2

7 8

7 9 0 3
```

### 输出

```
Yes

7 0

9 3

7 1

8 1
```

## 样例 #2

### 输入

```
0 0

8 4

5 5 0 0
```

### 输出

```
No
```

## 样例 #3

### 输入

```
1 4

1 4

100 200 300 400
```

### 输出

```
Yes
```

## 样例 #4

### 输入

```
22 2

16 7

14 30 11 14
```

### 输出

```
No
```



---

---
title: "[ABC289G] Shopping in AtCoder store"
layout: "post"
diff: 提高+/省选-
pid: AT_abc289_g
tag: []
---

# [ABC289G] Shopping in AtCoder store

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc289/tasks/abc289_g

高橋くんは AtCoder 商店を経営しています。 AtCoder 商店には $ N $ 人の客が訪れ、$ M $ 個の商品が売られています。 $ i $ 番目 $ (1\leq\ i\leq\ N) $ の客は購買意欲 $ B\ _\ i $ を持っています。 $ j $ 番目 $ (1\leq\ j\leq\ M) $ の商品の商品価値は $ C\ _\ j $ です。

高橋くんはそれぞれの商品に値段をつけます。 $ i $ 番目の客は、$ j $ 番目の商品の値段 $ P\ _\ j $ が次の条件を満たすような商品のみを、すべて $ 1 $ 個ずつ購入します。

- $ B\ _\ i+C\ _\ j\geq\ P\ _\ j $
 
$ j=1,2,\ldots,M $ について、高橋くんが売り上げが最大になるような値段をつけたときの $ j $ 番目の商品の売り上げを求めてください。 ただし、$ j $ 番目の商品の売り上げとは、$ P\ _\ j $ に $ j $ 番目の商品を買う人数をかけたものです。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ M $ $ B\ _\ 1 $ $ B\ _\ 2 $ $ \ldots $ $ B\ _\ N $ $ C\ _\ 1 $ $ C\ _\ 2 $ $ \ldots $ $ C\ _\ M $

## 输出格式

$ j=1,2,\ldots,M $ について、$ j $ 番目の商品の売り上げを空白区切りで $ 1 $ 行に出力せよ。

## 说明/提示

### 制約

- $ 1\leq\ N\leq2\times10^5 $
- $ 1\leq\ M\leq2\times10^5 $
- $ 0\leq\ B\ _\ i\leq10^9\quad(1\leq\ i\leq\ N) $
- $ 0\leq\ C\ _\ i\leq10^9\quad(1\leq\ i\leq\ M) $
- 入力はすべて整数
 
### Sample Explanation 1

たとえば、$ 1 $ 番目の商品の値段を $ 320 $ にすると、$ 2,3,4,5 $ 番目の客が購入します。 $ 1 $ 番目の商品の売り上げは $ 1280 $ になります。 $ 1 $ 番目の商品の売り上げを $ 1280 $ より大きくすることはできないので、$ 1 $ 番目に出力すべき値は $ 1280 $ です。

### Sample Explanation 2

購買意欲が同じ $ 2 $ 人や、商品価値が同じ $ 2 $ 品があることもあります。

### Sample Explanation 4

売り上げが $ 32\operatorname{bit} $ 整数におさまらない場合があることに注意してください。

## 样例 #1

### 输入

```
5 4

100 200 300 400 500

120 370 470 80
```

### 输出

```
1280 2350 2850 1140
```

## 样例 #2

### 输入

```
4 4

0 2 10 2

13 13 0 4
```

### 输出

```
52 52 10 18
```

## 样例 #3

### 输入

```
12 15

16 592 222 983 729 338 747 61 451 815 838 281

406 319 305 519 317 590 507 946 365 5 673 478 340 176 2
```

### 输出

```
6280 5466 5382 7410 5454 8120 7290 11680 5870 3670 8950 7000 5620 4608 3655
```

## 样例 #4

### 输入

```
5 5

1000000000 1000000000 1000000000 1000000000 1000000000

1000000000 1000000000 1000000000 1000000000 1000000000
```

### 输出

```
10000000000 10000000000 10000000000 10000000000 10000000000
```



---

---
title: "[ABC290F] Maximum Diameter"
layout: "post"
diff: 提高+/省选-
pid: AT_abc290_f
tag: []
---

# [ABC290F] Maximum Diameter

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc290/tasks/abc290_f

長さ $ N $ の正整数列 $ X=(X_1,X_2\ldots,X_N) $ に対して、$ f(X) $ を以下のように定めます。

- $ N $ 頂点の木であって、$ i\ (1\ \leq\ i\ \leq\ N) $ 番目の頂点の次数が $ X_i $ であるようなものを良い木と呼ぶ。 良い木が存在するならば、$ f(X) $ は良い木の直径の最大値。良い木が存在しないならば、$ f(X)=0 $。
 
ただし、木の $ 2 $ 頂点の間の距離は一方から他方へ移動するときに用いる辺の本数の最小値であり、 木の直径は任意の $ 2 $ 頂点の間の距離の最大値として定められます。

長さ $ N $ の正整数列 $ X $ としてあり得るもの全てに対する $ f(X) $ の総和を $ 998244353 $ で割った余りを求めてください。 なお、$ f(X) $ の総和は有限値になることが証明できます。

$ T $ 個のテストケースが与えられるので、それぞれについて答えを求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。ここで、$ \mathrm{test}_i $ は $ i $ 番目のテストケースを意味する。

> $ T $ $ \mathrm{test}_1 $ $ \mathrm{test}_2 $ $ \vdots $ $ \mathrm{test}_T $

各テストケースは以下の形式で与えられる。

> $ N $

## 输出格式

$ T $ 行出力せよ。

$ i\ (1\leq\ i\ \leq\ T) $ 行目には、$ i $ 番目のテストケースに対する答えを出力せよ。

## 说明/提示

### 制約

- $ 1\leq\ T\ \leq\ 2\times\ 10^5 $
- $ 2\ \leq\ N\ \leq\ 10^6 $
- 入力は全て整数
 
### Sample Explanation 1

$ N=3 $ の場合について、 例えば、 - $ X=(1,1,1) $ のとき、次数が $ 1,1,1 $ となる $ 3 $ 頂点の木は存在しないため、$ f(X)=0 $ です。 - $ X=(2,1,1) $ のとき、良い木は以下の図のものに限られます。この木の直径は $ 2 $ であるため、$ f(X)=2 $ です。 !\[3 頂点の木\](https://img.atcoder.jp/abc290/7b4cd8233d2ee3eb307023bebaebd906.jpg) $ X=(2,1,1),(1,2,1),(1,1,2) $ のとき $ f(X)=2 $ であり、それ以外の $ X $ のとき $ f(X)=0 $ であるため、答えは $ 6 $ です。

## 样例 #1

### 输入

```
10

2

3

5

8

13

21

34

55

89

144
```

### 输出

```
1

6

110

8052

9758476

421903645

377386885

881422708

120024839

351256142
```



---

---
title: "[ABC290G] Edge Elimination"
layout: "post"
diff: 提高+/省选-
pid: AT_abc290_g
tag: []
---

# [ABC290G] Edge Elimination

## 题目描述

给定一颗满 $K$ 叉树，深度为 $D$，即整棵树有 $1+K+K^2+\dots+K^D$ 个节点。

现在你可以选定若干条边并将其删除（也可以选择不删）。删除后将得到一个森林。求使森林中存在一棵树的节点数为 $X$ 的最小删除边数。

## 输入格式

第一行一个整数 $T$，表示有 $T$ 组数据。

接下来 $T$ 行，每行三个整数 $D,K,X$。中间用空格隔开。

## 输出格式

输出共 $T$ 行，每组数据输出一行。对于每组数据，输出最少要删除的边数。

@[robinyqc](https://www.luogu.com.cn/user/338632) 翻译。

## 样例 #1

### 输入

```
11

2 2 1

2 2 2

2 2 3

2 2 4

2 2 5

2 2 6

2 2 7

1 999999999999999999 1

1 999999999999999999 2

1 999999999999999999 999999999999999999

1 999999999999999999 1000000000000000000
```

### 输出

```
1

2

1

1

2

1

0

1

999999999999999998

1

0
```



---

---
title: "[ABC292G] Count Strictly Increasing Sequences"
layout: "post"
diff: 提高+/省选-
pid: AT_abc292_g
tag: []
---

# [ABC292G] Count Strictly Increasing Sequences

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc292/tasks/abc292_g

数字( `0123456789` )と `?` からなる長さ $ M $ の文字列の列 $ S_1,\ldots,S_N $ が与えられます。

`?` を独立に数字に置き換える方法は $ 10^q(q $ は $ S_1,\ldots,S_N $ に含まれる `?` の個数の合計$ ) $ 通りありますが、そのうち置き換え後の文字列をそれぞれ整数値とみなしたときに $ S_1\lt\ S_2\ \lt\ \ldots\ \lt\ S_N $ が成り立つようなものが何通りあるかを $ 998244353 $ で割った余りを求めてください。

なお、`?` を置き換えた後の $ S_i $ は先頭に $ 1 $ 個以上の `0` が連続していても構いません。例えば、`0000000292` を整数値とみなすと $ 292 $ となります。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ M $ $ S_1 $ $ \vdots $ $ S_N $

## 输出格式

答えを出力せよ。

## 说明/提示

### 制約

- $ 2\ \leq\ N\ \leq\ 40 $
- $ 1\ \leq\ M\ \leq\ 40 $
- $ N,M $ は整数
- $ S_i $ は数字と `?` からなる長さ $ M $ の文字列
 
### Sample Explanation 1

条件を満たす置き換え方は以下の $ 4 $ 通りです。 - $ S_1 $ の $ 1 $ 文字目の `?` を `0` に、$ S_2 $ の $ 1,2 $ 文字目の `?` をそれぞれ `0`, `1` に置き換える。 - $ S_1 $ の $ 1 $ 文字目の `?` を `0` に、$ S_2 $ の $ 1,2 $ 文字目の `?` をそれぞれ `0`, `2` に置き換える。 - $ S_1 $ の $ 1 $ 文字目の `?` を `0` に、$ S_2 $ の $ 1,2 $ 文字目の `?` をそれぞれ `0`, `3` に置き換える。 - $ S_1 $ の $ 1 $ 文字目の `?` を `0` に、$ S_2 $ の $ 1,2 $ 文字目の `?` をそれぞれ `0`, `4` に置き換える。

### Sample Explanation 3

答えを $ 998244353 $ で割った余りを求めてください。

## 样例 #1

### 输入

```
3 2

?0

??

05
```

### 输出

```
4
```

## 样例 #2

### 输入

```
2 1

0

0
```

### 输出

```
0
```

## 样例 #3

### 输入

```
10 10

1?22??37?4

1??8?0??49

3?02??8044

51?4?8?7??

5?9?20???2

68?7?6?800

?3??2???23

?442312158

??2??921?8

????5?96??
```

### 输出

```
137811792
```



---

---
title: "[ABC292Ex] Rating Estimator"
layout: "post"
diff: 提高+/省选-
pid: AT_abc292_h
tag: []
---

# [ABC292Ex] Rating Estimator

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc292/tasks/abc292_h

あなたは $ N $ 個のコンテストに参加します。コンテストが開催される順にコンテスト $ 1 $, コンテスト $ 2 $, $ \dots $ コンテスト $ N $ と呼びます。  
 各コンテストに参加すると、コンテストごとに **パフォーマンス** という値が与えられます。コンテスト $ i $ で与えられるパフォーマンスを $ P_i $ とします。  
 また、あなたは **レーティング** という値を持っています。レーティングはコンテストでのパフォーマンスによって変化する値です。コンテストに参加する前のレーティングの値は $ 0 $ で、コンテスト $ n $ に出た後のレーティングの値は $ \frac{1}{n}\ \left(\sum_{i=1}^n\ P_i\ \right) $ に変化します。   
 ただし、あなたのレーティングが一度 $ B $ **以上** になると、それ以降はコンテストに参加してもレーティングは変動しなくなります。

あなたはコンテストに出る前に、それぞれのコンテストで得られるパフォーマンスを予測することにしました。はじめ、コンテスト $ i $ のパフォーマンスの予測値を $ a_i $ とします。クエリが $ Q $ 個与えられるので入力される順にすべて処理してください。

各クエリでは 2 個の整数 $ c,\ x $ が与えられます。あなたは、まずコンテスト $ c $ のパフォーマンスの予測値を $ x $ に変更します。(この変更は永続的です。) そして、あなたが $ N $ 個のコンテスト全てで現在の予測値通りのパフォーマンスを得られた場合の、全てのコンテストに参加した後のレーティングの値を答えてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。ただし、$ c_i,\ x_i $ は $ i $ 番目のクエリで与えられる $ c,\ x $ を意味する。

> $ N $ $ B $ $ Q $ $ a_1 $ $ a_2 $ $ \dots $ $ a_N $ $ c_1 $ $ x_1 $ $ c_2 $ $ x_2 $ $ \vdots $ $ c_Q $ $ x_Q $

## 输出格式

$ Q $ 行出力せよ。$ i $ 行目には $ i $ 番目のクエリに対する答えを出力せよ。  
 なお、真の値との絶対誤差または相対誤差が $ 10^{-9} $ 以下であれば正解として扱われる。

## 说明/提示

### 制約

- $ 1\ \leq\ N\ \leq\ 5\ \times\ 10^5 $
- $ 1\ \leq\ B\ \leq\ 10^9 $
- $ 1\ \leq\ Q\ \leq\ 10^5 $
- $ 0\ \leq\ a_i\ \leq\ 10^9 $
- $ 1\ \leq\ c\ \leq\ N $
- $ 0\ \leq\ x\ \leq\ 10^9 $
- 入力される値はすべて整数
 
### Sample Explanation 1

はじめ、$ (a_1,\ a_2,\ a_3,\ a_4,\ a_5)\ =\ (5,\ 1,\ 9,\ 3,\ 8) $ です。 1 番目のクエリによって $ a_4 $ が $ 9 $ に変更されて $ (a_1,\ a_2,\ a_3,\ a_4,\ a_5)\ =\ (5,\ 1,\ 9,\ 9,\ 8) $ となります。 このとき、コンテスト $ i $ でパフォーマンス $ a_i $ を取った場合のあなたのレーティングの推移は次の通りです。 - はじめ、レーティングは $ 0 $ です。 - コンテスト $ 1 $ が終了した時点でレーティングは $ 5\ /\ 1\ =\ 5 $ に変化します。 - コンテスト $ 2 $ が終了した時点でレーティングは $ (5\ +\ 1)\ /\ 2\ =\ 3 $ に変化します。 - コンテスト $ 3 $ が終了した時点でレーティングは $ (5\ +\ 1\ +\ 9)\ /\ 3\ =\ 5 $ に変化します。 - コンテスト $ 4 $ が終了した時点でレーティングは $ (5\ +\ 1\ +\ 9\ +\ 9)\ /\ 4\ =\ 6 $ に変化します。 - 以降、レーティングの値は変化しません。なぜならば、$ 4 $ 番目のコンテストが終了した時点でレーティングが $ B $ 以上の値になっているからです。 よって、全てのコンテストが終了した時点でのレーティングは $ 6 $ なので、1 行目にはこれを出力します。

## 样例 #1

### 输入

```
5 6 7

5 1 9 3 8

4 9

2 10

1 0

3 0

3 30

5 100

1 100
```

### 输出

```
6.000000000000000

7.500000000000000

6.333333333333333

5.400000000000000

13.333333333333334

13.333333333333334

100.000000000000000
```



---

---
title: "[ABC293F] Zero or One"
layout: "post"
diff: 提高+/省选-
pid: AT_abc293_f
tag: []
---

# [ABC293F] Zero or One

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc293/tasks/abc293_f

$ 2 $ 以上の整数 $ N $ が与えられます。下記の条件を満たす $ 2 $ 以上の整数 $ b $ の個数を出力してください。

- $ N $ を $ b $ 進法で表記したとき、すべての桁について「その桁が $ 0 $ または $ 1 $ である」が成り立つ。
 
$ T $ 個の独立なテストケースについて答えを求めてください。

なお、本問題の制約下において、上記の「条件を満たす $ 2 $ 以上の整数 $ b $ の個数」は有限であることが証明できます。

## 输入格式

入力は以下の形式で標準入力から与えられる。ここで、$ \mathrm{test}_i $ は $ i $ 番目のテストケースを表す。

> $ T $ $ \mathrm{test}_1 $ $ \mathrm{test}_2 $ $ \vdots $ $ \mathrm{test}_T $

各テストケースは以下の形式で与えられる。

> $ N $

## 输出格式

$ T $ 行出力せよ。 $ i\ =\ 1,\ 2,\ \ldots,\ T $ について、$ i $ 行目には $ i $ 番目のテストケースに対する答えを出力せよ。

## 说明/提示

### 制約

- $ 1\ \leq\ T\ \leq\ 1000 $
- $ 2\ \leq\ N\ \leq\ 10^{18} $
- 入力はすべて整数
 
### Sample Explanation 1

$ 1 $ 番目のテストケースについて、問題文中の条件を満たす $ b $ は、$ b\ =\ 2,\ 3,\ 11,\ 12 $ の $ 4 $ つです。 実際、$ N\ =\ 12 $ を $ 2,\ 3,\ 11,\ 12 $ 進法で表すと、それぞれ $ 1100,\ 110,\ 11,\ 10 $ となります。

## 样例 #1

### 输入

```
3

12

2

36
```

### 输出

```
4

1

5
```



---

---
title: "[ABC295E] Kth Number"
layout: "post"
diff: 提高+/省选-
pid: AT_abc295_e
tag: []
---

# [ABC295E] Kth Number

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc295/tasks/abc295_e

$ 0 $ 以上 $ M $ 以下の整数からなる長さ $ N $ の数列 $ A=(A_1,A_2,\dots,A_N) $ があります。

今からすぬけくんが以下の操作 1, 2 を順に行います。

1. $ A_i=0 $ を満たすそれぞれの $ i $ について、$ 1 $ 以上 $ M $ 以下の整数を独立かつ一様ランダムに選び、$ A_i $ をその整数で置き換える。
2. $ A $ を昇順に並び替える。
 
すぬけくんが操作 1, 2 を行ったあとの $ A_K $ の期待値を $ \text{mod\ }\ 998244353 $ で出力してください。

  「期待値を $ \text{mod\ }\ 998244353 $ で出力」とは 求める期待値は必ず有理数となることが証明できます。 またこの問題の制約下では、その値を互いに素な $ 2 $ つの整数 $ P $, $ Q $ を用いて $ \frac{P}{Q} $ と表したとき、 $ R\ \times\ Q\ \equiv\ P\pmod{998244353} $ かつ $ 0\ \leq\ R\ \lt\ 998244353 $ を満たす整数 $ R $ がただ $ 1 $ つ存在することが証明できます。この $ R $ を出力してください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ M $ $ K $ $ A_1 $ $ A_2 $ $ \dots $ $ A_N $

## 输出格式

すぬけくんが操作 1, 2 を行ったあとの $ A_K $ の期待値を $ \text{mod\ }\ 998244353 $ で出力せよ。

## 说明/提示

### 制約

- $ 1\leq\ K\ \leq\ N\ \leq\ 2000 $
- $ 1\leq\ M\ \leq\ 2000 $
- $ 0\leq\ A_i\ \leq\ M $
- 入力は全て整数
 
### Sample Explanation 1

すぬけくんは操作 1 において $ A_2 $ を $ 1 $ 以上 $ 5 $ 以下の整数で置き換えます。この整数を $ x $ とすると、 - $ x=1,2 $ のとき、すぬけくんが操作 1, 2 を行ったあと $ A_2=2 $ です。 - $ x=3 $ のとき、すぬけくんが操作 1, 2 を行ったあと $ A_2=3 $ です。 - $ x=4,5 $ のとき、すぬけくんが操作 1, 2 を行ったあと $ A_2=4 $ です。 よって、$ A_2 $ の期待値は $ \frac{2+2+3+4+4}{5}=3 $ です。

### Sample Explanation 2

期待値は $ \frac{14}{9} $ です。

## 样例 #1

### 输入

```
3 5 2

2 0 4
```

### 输出

```
3
```

## 样例 #2

### 输入

```
2 3 1

0 0
```

### 输出

```
221832080
```

## 样例 #3

### 输入

```
10 20 7

6 5 0 2 0 0 0 15 0 0
```

### 输出

```
617586310
```



---

---
title: "[ABC295F] substr = S"
layout: "post"
diff: 提高+/省选-
pid: AT_abc295_f
tag: []
---

# [ABC295F] substr = S

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc295/tasks/abc295_f

$ T $ 個のテストケースについて、数字のみからなる文字列 $ S $ と正整数 $ L,R $ が与えられるので、以下の問題を解いてください。

正整数 $ x $ に対して $ f(x)= $ ( $ x $ を ( 先頭に $ 0 $ を含まないように ) 書き下した文字列の連続部分列のうち $ S $ と合致するものの個数 ) と定義します。

例えば $ S= $ `22` であるとき、$ f(122)\ =\ 1,\ f(123)\ =\ 0,\ f(226)\ =\ 1,\ f(222)\ =\ 2 $ となります。

このとき、 $ \displaystyle\ \sum_{k=L}^{R}\ f(k) $ を求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。$ \rm{case}_i $ は $ i $ 個目のテストケースを表す。

> $ T $ $ \rm{case}_{1} $ $ \rm{case}_{2} $ $ \vdots $ $ \rm{case}_{\it{T}} $

各テストケースは以下の形式である。

> $ S $ $ L $ $ R $

## 输出格式

全体で $ T $ 行出力せよ。  
 そのうち $ i $ 行目には $ i $ 番目のテストケースに対する答えを整数として出力せよ。

## 说明/提示

### 制約

- $ 1\ \le\ T\ \le\ 1000 $
- $ S $ は数字のみからなる長さ $ 1 $ 以上 $ 16 $ 以下の文字列
- $ L,R $ は $ 1\ \le\ L\ \le\ R\ <\ 10^{16} $ を満たす整数
 
### Sample Explanation 1

この入力には $ 6 $ 個のテストケースが含まれます。 - $ 1 $ つ目のケースは $ S= $ `22` $ ,L=23,R=234 $ です。 - $ f(122)=f(220)=f(221)=f(223)=f(224)=\dots=f(229)=1 $ - $ f(222)=2 $ - 以上より、このケースに対する答えは $ 12 $ です。 - $ 2 $ つ目のケースは $ S= $ `0295` $ ,L=295,R=295 $ です。 - $ f(295)=0 $ となることに注意してください。

## 样例 #1

### 输入

```
6

22 23 234

0295 295 295

0 1 9999999999999999

2718 998244353 9982443530000000

869120 1234567890123456 2345678901234567

2023032520230325 1 9999999999999999
```

### 输出

```
12

0

14888888888888889

12982260572545

10987664021

1
```



---

---
title: "[ABC295G] Minimum Reachable City"
layout: "post"
diff: 提高+/省选-
pid: AT_abc295_g
tag: []
---

# [ABC295G] Minimum Reachable City

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc295/tasks/abc295_g

$ N $ 頂点の有向グラフ $ G_S $ があり、頂点には $ 1 $ から $ N $ までの番号が付けられています。 $ G_S $ には $ N-1 $ 本の辺があり、$ i $ 本目 $ (1\leq\ i\ \leq\ N-1) $ の辺は頂点 $ p_i\ (1\leq\ p_i\ \leq\ i) $ から頂点 $ i+1 $ に伸びています。

$ N $ 頂点の有向グラフ $ G $ があり、頂点には $ 1 $ から $ N $ までの番号が付けられています。 最初、$ G $ は $ G_S $ と一致しています。 $ G $ に関するクエリが $ Q $ 個与えられるので、与えられた順番に処理してください。クエリは次の $ 2 $ 種類のいずれかです。

- `1 u v` : $ G $ に頂点 $ u $ から頂点 $ v $ に伸びる辺を追加する。 このとき、以下の条件が満たされることが保証される。
  - $ u\ \neq\ v $
  - $ G_S $ 上で頂点 $ v $ からいくつかの辺を辿ることで頂点 $ u $ に到達可能である
- `2 x` : $ G $ 上で頂点 $ x $ からいくつかの辺を辿ることで到達可能な頂点 (頂点 $ x $ を含む) のうち、最も番号が小さい頂点の番号を出力する。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ p_1 $ $ p_2 $ $ \dots $ $ p_{N-1} $ $ Q $ $ \mathrm{query}_1 $ $ \mathrm{query}_2 $ $ \vdots $ $ \mathrm{query}_Q $

ただし、$ \mathrm{query}_i $ は $ i $ 個目のクエリを表しており、次のいずれかの形式で与えられる。

> $ 1 $ $ u $ $ v $

> $ 2 $ $ x $

## 输出格式

$ 2 $ 番目の形式のクエリの回数を $ q $ 回として、$ q $ 行出力せよ。 $ j\ (1\leq\ j\ \leq\ q) $ 行目には、$ 2 $ 番目の形式のクエリのうち $ j $ 個目のものに対する答えを出力せよ。

## 说明/提示

### 制約

- $ 2\leq\ N\ \leq\ 2\times\ 10^5 $
- $ 1\leq\ Q\ \leq\ 2\times\ 10^5 $
- $ 1\leq\ p_i\leq\ i $
- $ 1 $ 番目の形式のクエリについて、
  - $ 1\leq\ u,v\ \leq\ N $
  - $ u\ \neq\ v $
  - $ G_S $ 上で頂点 $ v $ からいくつかの辺を辿ることで頂点 $ u $ に到達可能である
- $ 2 $ 番目の形式のクエリについて、$ 1\leq\ x\ \leq\ N $
- 入力は全て整数
 
### Sample Explanation 1

\- $ 1 $ 個目のクエリの時点で、$ G $ 上で頂点 $ 4 $ からいくつかの辺を辿ることで到達可能な頂点は $ 4 $ のみです。 - $ 3 $ 個目のクエリの時点で、$ G $ 上で頂点 $ 4 $ からいくつかの辺を辿ることで到達可能な頂点は $ 2,3,4,\ 5 $ です。 - $ 5 $ 個目のクエリの時点で、$ G $ 上で頂点 $ 4 $ からいくつかの辺を辿ることで到達可能な頂点は $ 1,2,3,4,5 $ です。

## 样例 #1

### 输入

```
5

1 2 3 3

5

2 4

1 4 2

2 4

1 5 1

2 4
```

### 输出

```
4

2

1
```

## 样例 #2

### 输入

```
7

1 1 2 2 3 3

10

2 5

1 5 2

2 5

1 2 1

1 7 1

1 6 3

2 5

2 6

2 1

1 7 1
```

### 输出

```
5

2

1

1

1
```



---

---
title: "[ABC296G] Polygon and Points"
layout: "post"
diff: 提高+/省选-
pid: AT_abc296_g
tag: []
---

# [ABC296G] Polygon and Points

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc296/tasks/abc296_g

$ x $ 軸の正の向きを右、$ y $ 軸の正の向きを上とする $ 2 $ 次元座標平面上に、凸 $ N $ 角形 $ S $ があります。$ S $ の頂点の座標は、反時計回りに $ (X_1,Y_1),\ldots,(X_N,Y_N) $ です。

$ Q $ 個の点 $ (A_i,B_i) $ について、それぞれ $ S $ の内部・外部・境界上のいずれにあるか求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ X_1 $ $ Y_1 $ $ \vdots $ $ X_N $ $ Y_N $ $ Q $ $ A_1 $ $ B_1 $ $ \vdots $ $ A_Q $ $ B_Q $

## 输出格式

$ Q $ 行出力せよ。$ i $ 行目には、$ (A_i,B_i) $ が $ S $ の内部(境界含まず)にあるとき `IN`、外部(境界含まず)にあるとき `OUT`、境界上にあるとき `ON` と出力せよ。

## 说明/提示

### 制約

- $ 3\ \leq\ N\ \leq\ 2\times\ 10^5 $
- $ 1\ \leq\ Q\ \leq\ 2\times\ 10^5 $
- $ -10^9\ \leq\ X_i,Y_i,A_i,B_i\ \leq\ 10^9 $
- $ S $ は狭義凸 $ N $ 角形である。すなわち、全ての内角は $ 180 $ 度未満である。
- $ (X_1,Y_1),\ldots,(X_N,Y_N) $ は $ S $ の頂点を反時計回りに列挙したものである。
- 入力は全て整数である。

### Sample Explanation 1

$ S $ 及び 与えられた $ 3 $ 個の点は下図の通りです。$ 1 $ 番目の点は $ S $ の境界上、$ 2 $ 番目の点は内部、$ 3 $ 番目の点は外部にあります。 !\[図\](https://img.atcoder.jp/abc296/828da6ca52e6b48a908ad06fa59eb9cb.png)

## 样例 #1

### 输入

```
4
0 4
-2 2
-1 0
3 1
3
-1 3
0 2
2 0
```

### 输出

```
ON
IN
OUT
```

## 样例 #2

### 输入

```
3
0 0
1 0
0 1
3
0 0
1 0
0 1
```

### 输出

```
ON
ON
ON
```



---

---
title: "[ABC297F] Minimum Bounding Box 2"
layout: "post"
diff: 提高+/省选-
pid: AT_abc297_f
tag: []
---

# [ABC297F] Minimum Bounding Box 2

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc297/tasks/abc297_f

縦 $ H $ 行、横 $ W $ 列のグリッドがあります。

このグリッドから一様ランダムに $ K $ 個のマスを選びます。選んだマスを全て含むような（グリッドの軸に辺が平行な）最小の長方形に含まれるマスの個数がスコアとなります。

得られるスコアの期待値を $ \text{mod\ }998244353 $ で求めてください。

  有理数 $ \text{mod\ }998244353 $ とは 求める期待値は必ず有理数となることが証明できます。 またこの問題の制約下では、その値を互いに素な $ 2 $ つの整数 $ P $, $ Q $ を用いて $ \frac{P}{Q} $ と表したとき、$ R\ \times\ Q\ \equiv\ P\pmod{998244353} $ かつ $ 0\ \leq\ R\ \lt\ 998244353 $ を満たす整数 $ R $ がただ一つ存在することが証明できます。この $ R $ を求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ H $ $ W $ $ K $

## 输出格式

答えを出力せよ。

## 说明/提示

### 制約

- $ 1\leq\ H,W\ \leq\ 1000 $
- $ 1\leq\ K\ \leq\ HW $
- 入力はすべて整数
 
### Sample Explanation 1

マス $ (1,1) $ とマス $ (2,2) $ が選ばれた場合、またはマス $ (1,2) $ とマス $ (2,1) $ が選ばれた場合の $ 2 $ 通りではスコアは $ 4 $ となります。また、それ以外の $ 4 $ 通りではスコアは $ 2 $ となります。 よって得られるスコアの期待値は $ \frac{4\ \times\ 2\ +\ 2\ \times\ 4}\ {6}\ =\ \frac{8}{3} $ であり、$ 665496238\ \times\ 3\ \equiv\ 8\pmod{998244353} $ なので $ 665496238 $ が答えとなります。

## 样例 #1

### 输入

```
2 2 2
```

### 输出

```
665496238
```

## 样例 #2

### 输入

```
10 10 1
```

### 输出

```
1
```

## 样例 #3

### 输入

```
314 159 2653
```

### 输出

```
639716353
```



---

---
title: "[ABC299G] Minimum Permutation"
layout: "post"
diff: 提高+/省选-
pid: AT_abc299_g
tag: []
---

# [ABC299G] Minimum Permutation

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc299/tasks/abc299_g

$ 1 $ 以上 $ M $ 以下の整数からなる長さ $ N $ の数列 $ A $ があります。ここで、$ 1 $ 以上 $ M $ 以下のどの整数も $ A $ に $ 1 $ 回以上登場します。

$ A $ の長さ $ M $ の（連続とは限らない）部分列であって $ 1,\ \ldots,\ M $ が $ 1 $ 回ずつ登場するもののうち、辞書順最小のものを答えてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ M $ $ A_1 $ $ A_2 $ $ \ldots $ $ A_N $

## 输出格式

求めるべき部分列を $ B_1,\ \ldots,\ B_M $ として、以下の形式で出力せよ。

> $ B_1 $ $ B_2 $ $ \ldots $ $ B_M $

## 说明/提示

### 制約

- $ 1\ \leq\ M\ \leq\ N\ \leq\ 2\ \times\ 10^5 $
- $ 1\ \leq\ A_i\ \leq\ M $
- $ 1 $ 以上 $ M $ 以下のどの整数も $ A $ に $ 1 $ 回以上登場する。
- 入力中の値はすべて整数である。
 
### Sample Explanation 1

$ A $ の長さ $ 3 $ の部分列であって $ 1,\ 2,\ 3 $ が $ 1 $ 回ずつ登場するものは $ (2,\ 3,\ 1) $ と $ (2,\ 1,\ 3) $ であり、このうち辞書順で小さいのは $ (2,\ 1,\ 3) $ です。

## 样例 #1

### 输入

```
4 3

2 3 1 3
```

### 输出

```
2 1 3
```

## 样例 #2

### 输入

```
4 4

2 3 1 4
```

### 输出

```
2 3 1 4
```

## 样例 #3

### 输入

```
20 10

6 3 8 5 8 10 9 3 6 1 8 3 3 7 4 7 2 7 8 5
```

### 输出

```
3 5 8 10 9 6 1 4 2 7
```



---

---
title: "[ABC300G] P-smooth number"
layout: "post"
diff: 提高+/省选-
pid: AT_abc300_g
tag: []
---

# [ABC300G] P-smooth number

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc300/tasks/abc300_g

$ k $ 以下の素数のみを素因数に持つ正整数を $ k $-smooth number と呼びます。  
 整数 $ N $ および $ 100 $ 以下の素数 $ P $ が与えられるので、 $ N $ 以下の $ P $-smooth number の個数を求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ P $

## 输出格式

答えを整数として出力せよ。

## 说明/提示

### 制約

- $ N $ は $ 1\ \le\ N\ \le\ 10^{16} $ を満たす整数
- $ P $ は $ 2\ \le\ P\ \le\ 100 $ を満たす素数
 
### Sample Explanation 1

$ 36 $ 以下の $ 3 $-smooth number は $ 1,2,3,4,6,8,9,12,16,18,24,27,32,36 $ の $ 14 $ 個です。 $ 1 $ は任意の素数 $ k $ に対して $ k $-smooth number であることに注意してください。

## 样例 #1

### 输入

```
36 3
```

### 输出

```
14
```

## 样例 #2

### 输入

```
10000000000000000 97
```

### 输出

```
2345134674
```



---

---
title: "[ABC303F] Damage over Time"
layout: "post"
diff: 提高+/省选-
pid: AT_abc303_f
tag: []
---

# [ABC303F] Damage over Time

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc303/tasks/abc303_f

あなたの前に体力 $ H $ のモンスターが現れ、ターン制の戦闘が開始しました。

あなたは、ターン $ 1,2,… $ のそれぞれに呪文 $ 1,…,N $ の $ N $ 種類の呪文のうち一つを唱えます。

ターン $ i $ に呪文 $ j $ を唱えると、その呪文の効果としてターン $ i,i+1,…,i+t_j\ －1 $ のそれぞれでモンスターの体力が $ d_j $ 減ります。

モンスターの体力を $ 0 $ 以下にすることが可能な最も早いターンを求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ H $ $ t_1 $ $ d_1 $ $ \vdots $ $ t_N $ $ d_N $

## 输出格式

答えを出力せよ。

## 说明/提示

### 制約

- $ 1\ \leq\ N\ \leq\ 3\ \times\ 10^5 $
- $ 1\ \leq\ H\ \leq\ 10^{18} $
- $ 1\ \leq\ t_i,d_i\ \leq\ 10^9 $
- 入力はすべて整数
 
### Sample Explanation 1

以下のようにするとターン $ 6 $ にモンスターの体力を $ 0 $ 以下に出来ます。これが最も早いターンです。 - ターン $ 1 $ に魔法 $ 1 $ を使う。ターン $ 1 $ に使った魔法の効果でモンスターの体力が $ 2 $ 減り、$ 18 $ になる。 - ターン $ 2 $ に魔法 $ 2 $ を使う。ターン $ 1,2 $ に使った魔法の効果でモンスターの体力が $ 2+1=3 $ 減り、$ 15 $ になる。 - ターン $ 3 $ に魔法 $ 1 $ を使う。ターン $ 2,3 $ に使った魔法の効果でモンスターの体力が $ 1+2=3 $ 減り、$ 12 $ になる。 - ターン $ 4 $ に魔法 $ 2 $ を使う。ターン $ 2,3,4 $ に使った魔法の効果でモンスターの体力が $ 1+2+1=4 $ 減り、$ 8 $ になる。 - ターン $ 5 $ に魔法 $ 1 $ を使う。ターン $ 2,4,5 $ に使った魔法の効果でモンスターの体力が $ 1+1+2=4 $ 減り、$ 4 $ になる。 - ターン $ 6 $ に魔法 $ 2 $ を使う。ターン $ 2,4,5,6 $ に使った魔法の効果でモンスターの体力が $ 1+1+2+1=5 $ 減り、$ -1 $ になる。

## 样例 #1

### 输入

```
2 20

2 2

5 1
```

### 输出

```
6
```

## 样例 #2

### 输入

```
10 200

1 21

1 1

1 1

8 4

30 1

3 1

10 2

8 1

9 1

4 4
```

### 输出

```
9
```



---

---
title: "[ABC303G] Bags Game"
layout: "post"
diff: 提高+/省选-
pid: AT_abc303_g
tag: []
---

# [ABC303G] Bags Game

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc303/tasks/abc303_g

$ N $ 個の袋が左右一列に並んでいて、左から $ i $ 番目の袋には $ x_i $ 円が入っています。

十分多くのお金を持っている高橋君と青木君が、高橋君を先手として交互に次の操作をします。

- 以下の $ 3 $ 種類の操作のうち $ 1 $ つを選んで行う。
  - 右端または左端の袋を $ 1 $ 個選んで取る。
  - $ A $ 円をすぬけ君に支払う。そして、「右端または左端の袋を $ 1 $ 個選んで取る」という操作を $ \min(B,n) $ ($ n $ は残っている袋の個数) 回繰り返す。
  - $ C $ 円をすぬけ君に支払う。そして、「右端または左端の袋を $ 1 $ 個選んで取る」という操作を $ \min(D,n) $ ($ n $ は残っている袋の個数) 回繰り返す。

残っている袋が無くなった時点での高橋君の利得を「(高橋君が取った袋に入っている金額の総和) $ - $ (高橋君がすぬけ君に支払った金額の総和)」とし、これを $ X $ 円とします。また、青木君の利得についても同様に定め、$ Y $ 円とします。

高橋君が $ X-Y $ を最大化、青木君が $ X-Y $ を最小化することを目的に最適な操作をしたときの $ X-Y $ を求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ A $ $ B $ $ C $ $ D $ $ x_1 $ $ x_2 $ $ \ldots $ $ x_N $

## 输出格式

答えを出力せよ。

## 说明/提示

### 制約

- $ 1\ \leq\ N\ \leq\ 3000 $
- $ 1\ \leq\ x_i\ \leq\ 10^9 $
- $ 1\ \leq\ A,C\ \leq\ 10^9 $
- $ 1\ \leq\ B,D\ \leq\ N $
- 入力はすべて整数

### Sample Explanation 1

高橋君と青木君が最適な操作をしたとき、$ X=92,\ Y=2 $ となります。

## 样例 #1

### 输入

```
5 10 2 1000000000 1
1 100 1 1 1
```

### 输出

```
90
```

## 样例 #2

### 输入

```
10 45 3 55 4
5 10 15 20 25 30 35 40 45 50
```

### 输出

```
85
```

## 样例 #3

### 输入

```
15 796265 10 165794055 1
18804175 185937909 1934689 18341 68370722 1653 1 2514380 31381214 905 754483 11 5877098 232 31600
```

### 输出

```
302361955
```



---

---
title: "[ABC307F] Virus 2"
layout: "post"
diff: 提高+/省选-
pid: AT_abc307_f
tag: []
---

# [ABC307F] Virus 2

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc307/tasks/abc307_f

部屋 $ 1 $, 部屋 $ 2 $, $ \ldots $, 部屋 $ N $ と番号づけられた $ N $ 個の部屋に人が $ 1 $ 人ずつ住んでおり、 また、いくつかの相異なる $ 2 $ つの部屋の間は通路によって結ばれています。 通路は $ M $ 本あり、$ i $ 本目の通路は部屋 $ U_i $ と部屋 $ V_i $ を結んでおり、長さは $ W_i $ です。

ある日(これを $ 0 $ 日目とします)の夜に、部屋 $ A_1,A_2,\ldots,\ A_K $ に住んでいる $ K $ 人がウイルスに(新しく)感染してしまいました。 さらにその後の $ D $ 日間で $ i $ 日目 $ (1\leq\ i\leq\ D) $ には次のように感染が広がりました。

> $ (i-1) $ 日目の夜の時点で感染していた人は、$ i $ 日目の夜の時点でも感染していた。  
>  そうでない人については、$ (i-1) $ 日目の夜の時点で感染していた人の住んでいる部屋のうちの少なくとも $ 1 $ つから 距離 $ X_i $ 以内の部屋に住んでいた時かつその時に限り、新しく感染した。 ここで、部屋 $ P,Q $ の間の距離は、部屋 $ P $ から 部屋 $ Q $ まで通路のみを使って移動する時に通る通路の長さの総和としてあり得る最小値として定義される。 ただし、部屋 $ P $ から 部屋 $ Q $ へ通路のみを使って移動する事ができない時、距離は $ 10^{100} $ とする。

各 $ i $ ($ 1\leq\ i\leq\ N $) について、部屋 $ i $ に住んでいる人がそれぞれ何日目の夜に(新しく)感染したか出力してください。ただし、$ D $ 日目の夜の時点で感染していない場合は $ -1 $ を出力してください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ M $ $ U_1 $ $ V_1 $ $ W_1 $ $ U_2 $ $ V_2 $ $ W_2 $ $ \vdots $ $ U_M $ $ V_M $ $ W_M $ $ K $ $ A_1 $ $ A_2 $ $ \ldots $ $ A_K $ $ D $ $ X_1 $ $ X_2 $ $ \ldots $ $ X_D $

## 输出格式

$ N $ 行出力せよ。  
 $ i $ 行目 $ (1\leq\ i\leq\ N) $ には、部屋 $ i $ に住んでいる人が何日目の夜に(新しく)感染したか出力せよ。

## 说明/提示

### 制約

- $ 1\ \leq\ N\leq\ 3\times\ 10^5 $
- $ 0\ \leq\ M\leq\ 3\times\ 10^5 $
- $ 1\ \leq\ U_i\ <\ V_i\leq\ N $
- $ (U_i,V_i) $ はすべて異なる。
- $ 1\leq\ W_i\leq\ 10^9 $
- $ 1\ \leq\ K\leq\ N $
- $ 1\leq\ A_1\ <\ A_2\ <\ \cdots\ <\ A_K\leq\ N $
- $ 1\ \leq\ D\leq\ 3\times\ 10^5 $
- $ 1\leq\ X_i\leq\ 10^9 $
- 入力はすべて整数
 
### Sample Explanation 1

次のように感染は広がります。 - $ 0 $ 日目の夜、部屋 $ 1 $ に住んでいる人が感染する。 - 部屋 $ 1 $ と部屋 $ 2,3,4 $ の間の距離はそれぞれ $ 2,3,5 $ である。よって、$ X_1=3 $ であるから、$ 1 $ 日目の夜、部屋 $ 2,3 $ に住んでいる人が新しく感染する。 - 部屋 $ 3 $ と部屋 $ 4 $ の間の距離は $ 2 $ である。よって、$ X_2=3 $ であるから、$ 2 $ 日目の夜、部屋 $ 4 $ に住んでいる人も感染する。 よって、部屋 $ 1,2,3,4 $ に住んでいる人はそれぞれ $ 0,1,1,2 $ 日目に新しく感染したため、$ 0,1,1,2 $ をこの順で各行に出力します。

### Sample Explanation 3

どの $ 2 $ つの部屋の間も通路のみを使って移動できるとは限らないことに注意してください。

## 样例 #1

### 输入

```
4 4

1 2 2

2 3 1

2 4 3

3 4 2

1

1

2

3 3
```

### 输出

```
0

1

1

2
```

## 样例 #2

### 输入

```
7 7

1 2 2

2 3 3

3 4 1

4 5 1

5 6 3

3 7 1

4 7 1

2

1 6

2

2 3
```

### 输出

```
0

1

2

-1

2

0

-1
```

## 样例 #3

### 输入

```
5 1

1 2 5

2

1 3

3

3 7 5
```

### 输出

```
0

2

0

-1

-1
```



---

---
title: "[ABC307G] Approximate Equalization"
layout: "post"
diff: 提高+/省选-
pid: AT_abc307_g
tag: []
---

# [ABC307G] Approximate Equalization

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc307/tasks/abc307_g

長さ $ N $ の整数列 $ A=(A_1,A_2,\ldots,A_N) $ が与えられます。

高橋君は次の $ 2 $ 種類の操作のうち $ 1 $ つを選んで行う事を、何回でも ($ 0 $ 回でも良い) 繰り返し行う事ができます。

- $ 1\leq\ i\leq\ N-1 $ をみたす整数 $ i $ を選び、$ A_i $ を $ 1 $ 減らし、$ A_{i+1} $ を $ 1 $ 増やす。
- $ 1\leq\ i\leq\ N-1 $ をみたす整数 $ i $ を選び、$ A_i $ を $ 1 $ 増やし、$ A_{i+1} $ を $ 1 $ 減らす。
 
数列 $ A $ が次の条件をみたすようにするために必要な操作の回数の最小値を求めてください。

- 任意の $ 1 $ 以上 $ N $ 以下の整数の組 $ (i,j) $ に対して、$ \lvert\ A_i-A_j\rvert\leq\ 1 $ が成り立つ。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ A_1 $ $ A_2 $ $ \ldots $ $ A_N $

## 输出格式

数列 $ A $ が問題文の条件をみたすようにするために必要な操作の回数の最小値を一行に出力せよ。

## 说明/提示

### 制約

- $ 2\ \leq\ N\ \leq\ 5000 $
- $ \lvert\ A_i\ \rvert\ \leq\ 10^9 $
- 入力はすべて整数
 
### Sample Explanation 1

次のようにして $ 4 $ 回の操作で $ A $ が条件をみたすようにできます。 - $ i=1 $ を選び、$ A_1 $ を $ 1 $ 増やし、 $ A_2 $ を $ 1 $ 減らす。$ A=(3,6,6) $ となる。 - $ i=1 $ を選び、$ A_1 $ を $ 1 $ 増やし、 $ A_2 $ を $ 1 $ 減らす。$ A=(4,5,6) $ となる。 - $ i=2 $ を選び、$ A_2 $ を $ 1 $ 増やし、 $ A_3 $ を $ 1 $ 減らす。$ A=(4,6,5) $ となる。 - $ i=1 $ を選び、$ A_1 $ を $ 1 $ 増やし、 $ A_2 $ を $ 1 $ 減らす。$ A=(5,5,5) $ となる。 この時操作回数が最小であり、よって $ 4 $ を出力します。

### Sample Explanation 2

次のようにして $ 2 $ 回の操作で $ A $ が条件をみたすようにできます。 - $ i=1 $ を選び、$ A_1 $ を $ 1 $ 減らし、 $ A_2 $ を $ 1 $ 増やす。$ A=(-3,-4,-2) $ となる。 - $ i=2 $ を選び、$ A_2 $ を $ 1 $ 増やし、 $ A_3 $ を $ 1 $ 減らす。$ A=(-3,-3,-3) $ となる。 この時操作回数が最小であり、よって $ 2 $ を出力します。

### Sample Explanation 3

うまく操作することで、$ 13 $ 回の操作の後で、 $ A=(0,0,-1,-1,-1) $ にでき、これは問題文の条件をみたします。 $ 12 $ 回以下の操作で条件をみたすようにすることはできないため、$ 13 $ を出力します。

## 样例 #1

### 输入

```
3

2 7 6
```

### 输出

```
4
```

## 样例 #2

### 输入

```
3

-2 -5 -2
```

### 输出

```
2
```

## 样例 #3

### 输入

```
5

1 1 1 1 -7
```

### 输出

```
13
```



---

---
title: "[ABC308G] Minimum Xor Pair Query"
layout: "post"
diff: 提高+/省选-
pid: AT_abc308_g
tag: []
---

# [ABC308G] Minimum Xor Pair Query

## 题目描述

这里有一块你可以写整数的黑板，初始黑板上什么都没有。

现在有 $q$ 个操作/询问，格式如下：

+ 操作 `1 x`：在黑板上写下一个数 $x$。
+ 操作 `2 x`：将**一个**整数 $x$ 从黑板上擦去，保证此时黑板上至少有一个整数 $x$。
+ 询问 `3`：输出黑板上任意两个整数的异或值的最小值，保证此时黑板上至少有两个数。

## 输入格式

第一行一个整数 $q$，表示操作/询问总数。

接下来 $q$ 行，每行一个操作，格式如上。

## 输出格式

对于每个询问 `3`，输出黑板上任意两个整数的异或值的最小值。

## 说明/提示

$1\leq q\leq 3\times 10^5,0\leq x<2^{30}$。


**对于样例 1：**

共有 9 个询问。

1. 此时黑板上有整数 $\{2\}$。
2. 此时黑板上有整数 $\{2,10\}$。
3. $2\oplus10=8$ 是黑板上最小的异或值。
4. 此时黑板上有整数 $\{2,3,10\}$。
5. $2\oplus3=1$ 是黑板上最小的异或值。
6. 此时黑板上有整数 $\{3,10\}$。
7. $3\oplus10=9$ 是黑板上最小的异或值。
8. 此时黑板上有整数 $\{3,10,10\}$。
9. $10\oplus10=0$ 是黑板上最小的异或值。

Translate by Ew_Cors.

## 样例 #1

### 输入

```
9

1 2

1 10

3

1 3

3

2 2

3

1 10

3
```

### 输出

```
8

1

9

0
```



---

---
title: "[ABC310F] Make 10 Again"
layout: "post"
diff: 提高+/省选-
pid: AT_abc310_f
tag: []
---

# [ABC310F] Make 10 Again

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc310/tasks/abc310_f

$ N $ 個のサイコロがあります。 $ i\ =\ 1,\ 2,\ \ldots,\ N $ について、$ i $ 番目のサイコロを振ると $ 1 $ 以上 $ A_i $ 以下の整数の出目がそれぞれ等確率でランダムにでます。

$ N $ 個のサイコロすべてを同時に振るとき、その結果が下記の条件を満たす確率を $ \text{mod\ }\ 998244353 $ で求めてください。

> $ N $ 個のサイコロの中からいくつか（ $ N $ 個全部でも良い）を選ぶ方法であって、選んだサイコロの出目の和がちょうど $ 10 $ であるようなものが存在する。

  確率 $ \text{mod\ }\ 998244353 $ の定義この問題で求める確率は必ず有理数になることが証明できます。 また、この問題の制約下では、求める確率を既約分数 $ \frac{y}{x} $ で表したときに $ x $ が $ 998244353 $ で割り切れないことが保証されます。

このとき $ xz\ \equiv\ y\ \pmod{998244353} $ を満たすような $ 0 $ 以上 $ 998244352 $ 以下の整数 $ z $ が一意に定まります。この $ z $ を答えてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ A_1 $ $ A_2 $ $ \ldots $ $ A_N $

## 输出格式

答えを出力せよ。

## 说明/提示

### 制約

- $ 1\ \leq\ N\ \leq\ 100 $
- $ 1\ \leq\ A_i\ \leq\ 10^6 $
- 入力はすべて整数
 
### Sample Explanation 1

例えば、$ 1,\ 2,\ 3,\ 4 $ 個目のサイコロの出目が順に $ 1,\ 3,\ 2,\ 7 $ だった場合、この結果は問題文中の条件を満たします。 実際、$ 2,\ 4 $ 番目のサイコロを選択すると、選んだサイコロの出目の和が $ 3\ +\ 7\ =\ 10 $ になります。 また、$ 1,\ 3,\ 4 $ 番目のサイコロを選択しても、選んだサイコロの出目の和が $ 1\ +\ 2\ +\ 7\ =\ 10 $ になります。 一方、$ 1,\ 2,\ 3,\ 4 $ 個目のサイコロの出目が順に $ 1,\ 6,\ 1,\ 5 $ だった場合、 どのようにサイコロを選んでも選んだサイコロの出目の和が $ 10 $ にならないため、この結果は問題文中の条件を満たしません。 この入力例では、$ N $ 個のサイコロを振った結果が問題文中の条件を満たす確率は $ \frac{11}{18} $ です。 よって、その $ \text{mod\ }\ 998244353 $ における値である $ 942786334 $ を出力します。

## 样例 #1

### 输入

```
4

1 7 2 9
```

### 输出

```
942786334
```

## 样例 #2

### 输入

```
7

1 10 100 1000 10000 100000 1000000
```

### 输出

```
996117877
```



---

---
title: "[ABC318G] Typical Path Problem"
layout: "post"
diff: 提高+/省选-
pid: AT_abc318_g
tag: []
---

# [ABC318G] Typical Path Problem

## 题目描述

给出一个有 $n$ 个顶点和 $m$ 条边的无向连通图 $G$，没有重边和自环。

顶点的编号为 $1 \sim n$，边的编号为 $1 \sim m$，第 $i$ 条边连接顶点 $u_i$ 和 $v_i$。

给出图上三个不同的顶点 $A,B,C$。判断是否有从点 $A$ 经过点 $B$ 到点 $C$ 的简单路径。

简单路径指路径上的点互不相同，即不重复经过同一个点。

## 输入格式

第一行有两个整数 $n,m$。  
第二行有三个整数 $A,B,C$。  
接下来 $m$ 行，每行两个整数 $u_i$ 和 $v_i$。

## 输出格式

输出一行 `Yes` 或 `No`。

## 说明/提示

- $3 \le n \le 2 \times 10^5$
- $n-1 \le m \le \min(\frac{n(n-1)}{2}, 2 \times 10^5)$
- $1 \le A,B,C \le n$
- $1 \le u_i < v_i \le n$

## 样例 #1

### 输入

```
6 7

1 3 2

1 2

1 5

2 3

2 5

2 6

3 4

4 5
```

### 输出

```
Yes
```

## 样例 #2

### 输入

```
6 6

1 3 2

1 2

2 3

2 5

2 6

3 4

4 5
```

### 输出

```
No
```

## 样例 #3

### 输入

```
3 2

1 3 2

1 2

2 3
```

### 输出

```
No
```



---

---
title: "[ABC326F] Robot Rotation"
layout: "post"
diff: 提高+/省选-
pid: AT_abc326_f
tag: []
---

# [ABC326F] Robot Rotation

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc326/tasks/abc326_f

右向きを $ x $ 軸正方向、上向きを $ y $ 軸正方向とする座標平面の原点にロボットがいます。ロボットは最初、$ x $ 軸正方向を向いています。

$ i=1,\ldots,N $ の順に以下の操作を行います：

- ロボットを右回りまたは左回りに $ 90 $ 度回転させる。その後、ロボットは向いている方向に $ A_i $ 進む
 
回転方向を適切に選ぶことで、$ N $ 回の操作後にロボットがいる座標を $ (X,Y) $ にすることはできますか？

できるならば、各操作において、右回りと左回りのどちらを選べばよいか求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ X $ $ Y $ $ A_1 $ $ \ldots $ $ A_N $

## 输出格式

$ N $ 回の操作後にロボットがいる座標を $ (X,Y) $ にできないとき、`No` と出力せよ。  
 $ N $ 回の操作後にロボットがいる座標を $ (X,Y) $ にできるとき、1行目に `Yes` と出力し、2行目に次の条件を満たす長さ $ N $ の文字列 $ S $ を出力せよ。  
 条件： $ S $ は `L` または `R` のみからなり、$ S $ の $ i $ 番目の文字が `L` ならば $ i $ 回目の操作においてロボットを左回りに、`R` ならばロボットを右回りに回転させることで、$ N $ 回の操作後にロボットがいる座標を $ (X,Y) $ にできる。

答えが複数ある場合はどれを出力しても正解となる。

## 说明/提示

### 制約

- $ 1\ \leq\ N\ \leq\ 80 $
- $ 1\ \leq\ A_i\ \leq\ 10^7 $
- $ -10^9\leq\ X,Y\ \leq\ 10^9 $
- 入力は全て整数である
 
### Sample Explanation 1

最初ロボットは $ (0,0) $ にいて、$ x $ 軸正方向を向いています。次の手順により、$ N $ 回の操作後にロボットがいる座標を $ (X,Y) $ にできます。 - $ 1 $ 回目の操作：ロボットを左に $ 90 $ 度回転させ、$ y $ 軸正方向を向かせる。ロボットは向いている方向に $ A_1=3 $ 進み、ロボットのいる座標は $ (0,3) $ となる。 - $ 2 $ 回目の操作：ロボットを左に $ 90 $ 度回転させ、$ x $ 軸負方向を向かせる。ロボットは向いている方向に $ A_2=2 $ 進み、ロボットのいる座標は $ (-2,3) $ となる。 - $ 3 $ 回目の操作：ロボットを右に $ 90 $ 度回転させ、$ y $ 軸正方向を向かせる。ロボットは向いている方向に $ A_3=1 $ 進み、ロボットのいる座標は $ (-2,4) $ となる。 !\[図\](https://img.atcoder.jp/abc326/79baf4537d56c0df5c5d254e6e7f9616.png)

### Sample Explanation 3

`LLLL` や `RRRR` などでも正解となります。

## 样例 #1

### 输入

```
3 -2 4

3 2 1
```

### 输出

```
Yes

LLR
```

## 样例 #2

### 输入

```
1 0 0

1
```

### 输出

```
No
```

## 样例 #3

### 输入

```
4 0 0

1 1 1 1
```

### 输出

```
Yes

LRRR
```

## 样例 #4

### 输入

```
14 2543269 -1705099

3 14 159 2653 58979 323846 2643383 2795028 841971 69399 37510 58 20 9
```

### 输出

```
Yes

LLLLLLLLLRLRRR
```



---

---
title: "[ABC327F] Apples"
layout: "post"
diff: 提高+/省选-
pid: AT_abc327_f
tag: []
---

# [ABC327F] Apples

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc327/tasks/abc327_f

数直線上にりんごの木が並んでおり、 $ N $ 個のりんごが木から落ちてきます。  
具体的には $ 1\leq\ i\leq\ N $ について、時刻 $ T_i $ に座標 $ X_i $ にりんごが落ちてきます。

高橋君は耐久性が $ D $ , 長さ $ W $ のカゴを持っており、**一度だけ** 次の行動を取ることができます。

> 正整数 $ S $, $ L $ を選ぶ。高橋君は時刻 $ S-0.5 $ に $ L-0.5\leq\ x\leq\ L+W-0.5 $ の範囲を覆うようにカゴを設置し、時刻 $ S+D-0.5 $ に回収する。 高橋君はカゴを設置してから回収するまでの間に、カゴが設置されていた範囲に落ちてきたりんごをすべて得ることができる。

高橋君は一度設置したカゴを動かしたり、回収したカゴを再度設置することはできません。  
高橋君が得られるりんごの数の最大値を求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ D $ $ W $ $ T_1 $ $ X_1 $ $ T_2 $ $ X_2 $ $ \vdots $ $ T_N $ $ X_N $

## 输出格式

高橋君が得られるりんごの数の最大値を出力せよ。

## 说明/提示

### 制約

- $ 1\ \leq\ N\leq\ 2\times\ 10^5 $
- $ 1\ \leq\ D\leq\ 2\times\ 10^5 $
- $ 1\ \leq\ W\leq\ 2\times\ 10^5 $
- $ 1\ \leq\ T_i\leq\ 2\times\ 10^5 $
- $ 1\ \leq\ X_i\leq\ 2\times\ 10^5 $
- $ (T_i,X_i) $ はすべて異なる。
- 入力はすべて整数

### Sample Explanation 1

高橋君は $ S=3 $, $ L=2 $ を選ぶと、時刻 $ 2.5 $ から $ 6.5 $ までカゴを $ 1.5\leq\ x\leq\ 4.5 $ の範囲に設置します。このとき、 - 時刻 $ T_2=3 $ に 座標 $ X_2=4 $ に落ちてくるりんご - 時刻 $ T_3=6 $ に 座標 $ X_3=4 $ に落ちてくるりんご - 時刻 $ T_4=5 $ に 座標 $ X_4=2 $ に落ちてくるりんご - 時刻 $ T_5=4 $ に 座標 $ X_5=2 $ に落ちてくるりんご - 時刻 $ T_6=4 $ に 座標 $ X_6=3 $ に落ちてくるりんご の $ 5 $ 個のりんごを得ることができます。 どのように行動しても $ 6 $ 個以上のりんごを得ることはできないため、$ 5 $ を出力します。

## 样例 #1

### 输入

```
8 4 3
1 1
3 4
6 4
5 2
4 2
4 3
5 5
7 3
```

### 输出

```
5
```



---

---
title: "[ABC332E] Lucky bag"
layout: "post"
diff: 提高+/省选-
pid: AT_abc332_e
tag: []
---

# [ABC332E] Lucky bag

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc332/tasks/abc332_e

AtCoder 社は、[オンラインショップ](https://suzuri.jp/AtCoder/home)でグッズを販売しています。

今、$ N $ 個のグッズが社内に残っています。 ここで、$ i $ $ (1\leq\ i\leq\ N) $ 個目のグッズの重さは $ W_i $ です。

高橋君は残ったグッズをまとめて $ D $ 袋の福袋として販売する事にしました。  
高橋君は各福袋に入ったグッズの重さの合計の分散を最小にしたいと考えています。  
ここで、各福袋に入ったグッズの重さの合計がそれぞれ $ x_1,x_2,\ldots,x_D $ であるとき、  
それらの平均を $ \bar{x}=\frac{1}{D}(x_1+x_2+\cdots+x_D) $ として、 分散は $ V=\frac{1}{D}\displaystyle\sum_{i=1}^D\ (x_i-\bar{x})^2 $ として定義されます。

各福袋に入ったグッズの重さの合計の分散が最小になるようにグッズを分けた時の分散の値を求めてください。  
ただし、空の福袋が存在してもかまいません（この時福袋に入ったグッズの重さの合計は $ 0 $ として定義されます）が、  
**どのグッズも $ D $ 袋のうちちょうど $ 1 $ つの福袋に入っている** ようにするものとします。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ D $ $ W_1 $ $ W_2 $ $ \ldots $ $ W_N $

## 输出格式

各福袋に入ったグッズの重さの合計の分散が最小になるようにグッズを分けた時の分散の値を出力せよ。  
出力は、真の値との絶対誤差または相対誤差が $ 10^{-6} $ 以下のとき正解と判定される。

## 说明/提示

### 制約

- $ 2\ \leq\ D\leq\ N\leq\ 15 $
- $ 1\ \leq\ W_i\leq\ 10^8 $
- 入力はすべて整数

### Sample Explanation 1

$ 1 $ つめの福袋に $ 1,3 $ 個目のグッズを、 $ 2 $ つめの福袋に $ 2,5 $ 個目のグッズを、 $ 3 $ つめの福袋に $ 4 $ 個目のグッズを入れると、 それぞれの福袋に入ったグッズの重さの合計は $ 6,8,6 $ となります。 このとき、重さの平均は $ \frac{1}{3}(6+8+6)=\frac{20}{3} $ であり、 分散は $ \frac{1}{3}\left\{\left(6-\frac{20}{3}\right)^2+\left(8-\frac{20}{3}\right)^2+\left(6-\frac{20}{3}\right)^2\ \right\}=\frac{8}{9}=0.888888\ldots $ となり、このときが最小です。 同じ重さのグッズが複数存在し得ること、 各グッズはいずれかの福袋に入っている必要があることに注意してください。

## 样例 #1

### 输入

```
5 3
3 5 3 6 3
```

### 输出

```
0.888888888888889
```



---

---
title: "[ABC332F] Random Update Query"
layout: "post"
diff: 提高+/省选-
pid: AT_abc332_f
tag: []
---

# [ABC332F] Random Update Query

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc332/tasks/abc332_f

長さ $ N $ の整数列 $ A\ =\ (A_1,\ A_2,\ \ldots,\ A_N) $ が与えられます。

$ A $ に対して、$ i\ =\ 1,\ 2,\ \ldots,\ M $ の順に下記の操作を行います。

- まず、$ L_i $ 以上 $ R_i $ 以下の整数を等確率でランダムに $ 1 $ 個を選び、それを $ p $ とおく。
- そして、$ A_p $ の値を整数 $ X_i $ に変更する。
 
上記の手順を行った後の最終的な $ A $ における、$ A_i $ の期待値 $ \text{mod\ }\ 998244353 $ を、 各 $ i\ =\ 1,\ 2,\ \ldots,\ N $ について出力してください。

  期待値 $ \text{mod\ }\ 998244353 $ の定義この問題で求める期待値は必ず有理数になることが証明できます。 また、この問題の制約下では、求める期待値を既約分数 $ \frac{y}{x} $ で表したときに $ x $ が $ 998244353 $ で割り切れないことが保証されます。

このとき $ xz\ \equiv\ y\ \pmod{998244353} $ を満たすような $ 0 $ 以上 $ 998244352 $ 以下の整数 $ z $ が一意に定まります。この $ z $ を答えてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ M $ $ A_1 $ $ A_2 $ $ \ldots $ $ A_N $ $ L_1 $ $ R_1 $ $ X_1 $ $ L_2 $ $ R_2 $ $ X_2 $ $ \vdots $ $ L_M $ $ R_M $ $ X_M $

## 输出格式

各 $ i\ =\ 1,\ 2,\ \ldots,\ N $ に対する最終的な $ A_i $ の期待値 $ E_i $ を、 下記の形式の通りに空白区切りで出力せよ。

> $ E_1 $ $ E_2 $ $ \ldots $ $ E_N $

## 说明/提示

### 制約

- 入力される値は全て整数
- $ 1\ \leq\ N,\ M\ \leq\ 2\ \times\ 10^5 $
- $ 0\ \leq\ A_i\ \leq\ 10^9 $
- $ 1\ \leq\ L_i\ \leq\ R_i\ \leq\ N $
- $ 0\ \leq\ X_i\ \leq\ 10^9 $
 
### Sample Explanation 1

$ A\ =\ (3,\ 1,\ 4,\ 1,\ 5) $ である初期状態からはじめ、下記の通りに $ 2 $ 個の操作が行われます。 - まず、$ 1 $ 個目の操作で、$ A_1 $ と $ A_2 $ のどちらか一方が等確率でランダムに選ばれ、その値が $ 2 $ に変更されます。 - その後、$ 2 $ 個目の操作で、$ A_2,\ A_3,\ A_4 $ のうちいずれか $ 1 $ 個が等確率でランダムに選ばれ、その値が $ 0 $ に変更されます。 その結果、最終的な $ A $ の各要素の期待値は $ (E_1,\ E_2,\ E_3,\ E_4,\ E_5)\ =\ (\frac{5}{2},\ 1,\ \frac{8}{3},\ \frac{2}{3},\ 5) $ です。

## 样例 #1

### 输入

```
5 2

3 1 4 1 5

1 2 2

2 4 0
```

### 输出

```
499122179 1 665496238 665496236 5
```

## 样例 #2

### 输入

```
2 4

1 2

1 1 3

2 2 4

1 1 5

2 2 6
```

### 输出

```
5 6
```

## 样例 #3

### 输入

```
20 20

998769066 273215338 827984962 78974225 994243956 791478211 891861897 680427073 993663022 219733184 570206440 43712322 66791680 164318676 209536492 137458233 289158777 461179891 612373851 330908158

12 18 769877494

9 13 689822685

6 13 180913148

2 16 525285434

2 14 98115570

14 17 622616620

8 12 476462455

13 17 872412050

14 15 564176146

7 13 143650548

2 5 180435257

4 10 82903366

1 2 643996562

8 10 262860196

10 14 624081934

11 13 581257775

9 19 381806138

3 12 427930466

6 19 18249485

14 19 682428942
```

### 输出

```
821382814 987210378 819486592 142238362 447960587 678128197 687469071 405316549 318941070 457450677 426617745 712263899 939619994 228431878 307695685 196179692 241456697 12668393 685902422 330908158
```



---

---
title: "[ABC333F] Bomb Game 2"
layout: "post"
diff: 提高+/省选-
pid: AT_abc333_f
tag: []
---

# [ABC333F] Bomb Game 2

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc333/tasks/abc333_f

$ N $ 人の人が一列に並んでおり、人 $ i $ は先頭から $ i $ 番目に並んでいます。

以下の操作を、列に並んでいる人が $ 1 $ 人になるまで繰り返します。

- 先頭に並んでいる人を $ \frac{1}{2} $ の確率で列から取り除き、そうでない場合は列の末尾に移す。
 
人 $ i=1,2,\ldots,N $ それぞれについて、人 $ i $ が最後まで列に並んでいる $ 1 $ 人になる確率を $ \text{mod\ }998244353 $ で求めて下さい。(取り除くかどうかの選択はすべてランダムかつ独立です。)

  確率 $ \text{mod\ }\ 998244353 $ の定義この問題で求める確率は必ず有理数になることが証明できます。 また、この問題の制約下では、求める確率を既約分数 $ \frac{y}{x} $ で表したときに $ x $ が $ 998244353 $ で割り切れないことが保証されます。

このとき $ xz\ \equiv\ y\ \pmod{998244353} $ を満たすような $ 0 $ 以上 $ 998244352 $ 以下の整数 $ z $ が一意に定まります。この $ z $ を答えてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $

## 输出格式

人 $ i=1,2,\ldots,N $ に対する答えを空白区切りで出力せよ。

## 说明/提示

### 制約

- $ 2\leq\ N\leq\ 3000 $
- 入力は全て整数
 
### Sample Explanation 1

人 $ 1 $ が最後まで列に並んでいる $ 1 $ 人になる確率は $ \frac{1}{3} $ です。 人 $ 2 $ が最後まで列に並んでいる $ 1 $ 人になる確率は $ \frac{2}{3} $ です。

## 样例 #1

### 输入

```
2
```

### 输出

```
332748118 665496236
```

## 样例 #2

### 输入

```
5
```

### 输出

```
235530465 792768557 258531487 238597268 471060930
```



---

---
title: "[ABC335F] Hop Sugoroku"
layout: "post"
diff: 提高+/省选-
pid: AT_abc335_f
tag: []
---

# [ABC335F] Hop Sugoroku

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc335/tasks/abc335_f

一列に並んだ $ N $ 個のマス $ 1,2,\dots,N $ と長さ $ N $ の数列 $ A=(A_1,A_2,\dots,A_N) $ があります。  
 最初、マス $ 1 $ は黒く、他の $ N-1 $ 個のマスは白く塗られており、 $ 1 $ つのコマがマス $ 1 $ に置かれています。

以下の操作を $ 0 $ 回以上好きな回数繰り返します。

- コマがマス $ i $ にあるとき、ある正整数 $ x $ を決めてコマをマス $ i\ +\ A_i\ \times\ x $ に移動させる。
  - 但し、 $ i\ +\ A_i\ \times\ x\ >\ N $ となるような移動はできません。
- その後、マス $ i\ +\ A_i\ \times\ x $ を黒く塗る。
 
操作を終えた時点で黒く塗られたマスの集合として考えられるものの数を $ 998244353 $ で割った余りを求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ A_1 $ $ A_2 $ $ \dots $ $ A_N $

## 输出格式

答えを整数として出力せよ。

## 说明/提示

### 制約

- 入力は全て整数
- $ 1\ \le\ N\ \le\ 2\ \times\ 10^5 $
- $ 1\ \le\ A_i\ \le\ 2\ \times\ 10^5 $
 
### Sample Explanation 1

黒く塗られたマスの集合として考えられるものは以下の $ 8 $ 通りです。 - マス $ 1 $ - マス $ 1,2 $ - マス $ 1,2,4 $ - マス $ 1,2,4,5 $ - マス $ 1,3 $ - マス $ 1,4 $ - マス $ 1,4,5 $ - マス $ 1,5 $

### Sample Explanation 3

$ 998244353 $ で割った余りを求めることに注意してください。

## 样例 #1

### 输入

```
5

1 2 3 1 1
```

### 输出

```
8
```

## 样例 #2

### 输入

```
1

200000
```

### 输出

```
1
```

## 样例 #3

### 输入

```
40

1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1
```

### 输出

```
721419738
```



---

---
title: "[ABC337F] Usual Color Ball Problems"
layout: "post"
diff: 提高+/省选-
pid: AT_abc337_f
tag: []
---

# [ABC337F] Usual Color Ball Problems

## 题目描述

### 题目翻译

你现在手上有 $n$ 个排成一列的球、 $m$ 个盒子。每个球有一种颜色。

现在你需要对于每个 $0\le x< n$，执行以下操作：

1. 将第一个球移动至序列末尾。该操作将执行 $x$ 次。
2. 从前往后处理每个球，假设当前球的颜色为 $c$。具体地，我们通过以下步骤来把球放到盒子里：
> 1. 如果存在一个非空盒子 $y$，这个盒子里的所有球颜色为 $c$ 并且这个盒子里球的个数小于 $k$，你应当将球放入 $y$ 号盒子中。
>2. 如果不存在 (1) 中所述情况，但是存在一个盒子为空，你应当将球放进一个空盒子里。
> 3. 如果不存在 (1)、(2) 中所述情况，你应当将这个球吃掉。

3. 当序列中没有球之后（所有球都被放进盒子里或吃掉后），输出**盒子里**的球的数量。

询问之间互不影响，所有盒子一开始都是空的。

## 输入格式

第一行三个正整数 $n,m,k$，含义如题所示。

接下来一行 $n$ 个正整数 $c_i$ 表示序列中第 $i$ 个球的颜色。

## 输出格式

对于每个 $0\le x<n$ 输出一行一个数，表示整个小球序列经过操作之后的答案。

## 样例 #1

### 输入

```
7 2 2

1 2 3 5 2 5 4
```

### 输出

```
3

3

3

4

4

3

2
```

## 样例 #2

### 输入

```
20 5 4

20 2 20 2 7 3 11 20 3 8 7 9 1 11 8 20 2 18 11 18
```

### 输出

```
14

14

14

14

13

13

13

11

8

9

9

11

13

14

14

14

14

14

14

13
```



---

---
title: "[ABC337G] Tree Inversion"
layout: "post"
diff: 提高+/省选-
pid: AT_abc337_g
tag: []
---

# [ABC337G] Tree Inversion

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc337/tasks/abc337_g

頂点 $ 1, $ 頂点 $ 2,\ldots, $ 頂点 $ N $ の $ N $ 頂点からなる木 $ T $ が与えられます。 $ i $ 番目 $ (1\leq\ i\lt\ N) $ の辺は頂点 $ u\ _\ i $ と頂点 $ v\ _\ i $ を結んでいます。

$ T $ の頂点 $ u $ について $ f(u) $ を次のように定めます。

- $ f(u)\coloneqq $ $ T $ の頂点 $ v $ と頂点 $ w $ の組であって、次の $ 2 $ つの条件を満たすものの個数
  - 頂点 $ u $ と頂点 $ v $ を結ぶパス上に頂点 $ w $ が含まれる。
  - $ v\lt\ w $
 
ただし、「頂点 $ u $ と頂点 $ v $ を結ぶパス上に頂点 $ w $ が含まれる」は、$ u=w $ や $ v=w $ のときにも成立するとします。

$ f(1),f(2),\ldots,f(N) $ の値を求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ u\ _\ 1 $ $ v\ _\ 1 $ $ u\ _\ 2 $ $ v\ _\ 2 $ $ \vdots $ $ u\ _\ {N-1} $ $ v\ _\ {N-1} $

## 输出格式

$ f(1),f(2),\ldots,f(N) $ の値をこの順に空白を区切りとして出力せよ。

## 说明/提示

### 制約

- $ 2\leq\ N\leq2\times10\ ^\ 5 $
- $ 1\leq\ u\ _\ i\leq\ N\ (1\leq\ i\leq\ N) $
- $ 1\leq\ v\ _\ i\leq\ N\ (1\leq\ i\leq\ N) $
- 与えられるグラフは木
- 入力はすべて整数
 
### Sample Explanation 1

与えられる木は以下のようになります。 !\[\](https://img.atcoder.jp/abc337/f02c6287abee93272dda64faf9499a81.png) 例えば、$ f(4)=4 $ です。 実際、$ u=4 $ に対して $ (v,w)=(1,2),(1,4),(2,4),(3,4) $ の $ 4 $ 通りが条件を満たします。

### Sample Explanation 2

与えられる木は以下のようになります。 !\[\](https://img.atcoder.jp/abc337/e59ed095480b6f8ec4ecfc212f14e635.png) $ f(14) $ の値は、数列 $ (14,9,1,6,12,2,15,4,11,13,3,8,10,7,5) $ の転倒数 $ 57 $ になります。

## 样例 #1

### 输入

```
7

1 2

2 3

2 4

4 5

4 6

6 7
```

### 输出

```
0 1 3 4 8 9 15
```

## 样例 #2

### 输入

```
15

14 9

9 1

1 6

6 12

12 2

2 15

15 4

4 11

11 13

13 3

3 8

8 10

10 7

7 5
```

### 输出

```
36 29 32 29 48 37 45 37 44 42 33 36 35 57 35
```

## 样例 #3

### 输入

```
24

7 18

4 2

5 8

5 15

6 5

13 8

4 6

7 11

23 16

6 18

24 16

14 21

20 15

16 18

3 16

11 10

9 11

15 14

12 19

5 1

9 17

5 22

11 19
```

### 输出

```
20 20 41 20 21 20 28 28 43 44 36 63 40 46 34 40 59 28 53 53 66 42 62 63
```



---

---
title: "[ABC387E] Digit Sum Divisible 2"
layout: "post"
diff: 提高+/省选-
pid: AT_abc387_e
tag: []
---

# [ABC387E] Digit Sum Divisible 2

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc387/tasks/abc387_e

正整数 $ n $ の桁和を、$ n $ を $ 10 $ 進法で表したときの各桁の和と定義します。例えば $ 2025 $ の桁和は $ 2\ +\ 0\ +\ 2\ +\ 5\ =\ 9 $ です。  
正整数 $ n $ が $ n $ の桁和で割り切れる時、$ n $ を **良い整数** と呼びます。例えば $ 2025 $ はその桁和である $ 9 $ で割り切れるので良い整数です。  
正整数の組 $ (a,\ a+1) $ であって $ a $ と $ a+1 $ が共に良い整数であるものを **双子の良い整数** と呼びます。例えば $ (2024,\ 2025) $ は双子の良い整数です。

正整数 $ N $ が与えられます。$ N\ \leq\ a $ かつ $ a\ +\ 1\ \leq\ 2N $ であるような双子の良い整数 $ (a,\ a\ +\ 1) $ を発見してください。そのような $ (a,\ a\ +\ 1) $ が存在しない場合はそのことを報告してください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $

## 输出格式

問題文の条件を満たす $ (a,\ a+1) $ が存在する場合は $ a $ を、存在しない場合は `-1` を出力せよ。$ a $ は leading-zeros を省略した表現で出力する必要がある点に注意せよ。  
条件を満たす $ (a,\ a+1) $ が複数存在する場合はどれを出力してもよい。

## 说明/提示

### 制約

- $ N $ は $ 1 $ 以上 $ 10^{100000} $ 未満の整数

### Sample Explanation 1

$ (8,\ 9) $ は問題文の条件を満たす双子の良い整数です。他にも $ (5,\ 6),\ (6,\ 7),\ (7,\ 8),\ (9,\ 10) $ が条件を満たします。

### Sample Explanation 2

問題文の条件を満たす双子の良い整数は存在しません。

### Sample Explanation 3

$ (2024,\ 2025) $ は問題文の条件を満たす双子の良い整数です。

## 样例 #1

### 输入

```
5
```

### 输出

```
8
```

## 样例 #2

### 输入

```
21
```

### 输出

```
-1
```

## 样例 #3

### 输入

```
1234
```

### 输出

```
2024
```

## 样例 #4

### 输入

```
1234567890123456789012345678901234567890
```

### 输出

```
1548651852734633803438094164372911259190
```



---

---
title: "[ABC387F] Count Arrays"
layout: "post"
diff: 提高+/省选-
pid: AT_abc387_f
tag: []
---

# [ABC387F] Count Arrays

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc387/tasks/abc387_f

正整数 $ N,M $ および、各要素が $ 1 $ 以上 $ N $ 以下の整数である長さ $ N $ の数列 $ A=(A_1,A_2,\dots,A_N) $ が与えられます。

各要素が $ 1 $ 以上 $ M $ 以下の整数である長さ $ N $ の数列 $ x=(x_1,x_2,\dots,x_N) $ のうち、以下の条件を満たすものの数を $ 998244353 $ で割った余りを求めてください。

- 全ての $ i\ (1\leq\ i\leq\ N) $ について、$ x_i\ \leq\ x_{A_i} $

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ M $ $ A_1 $ $ A_2 $ $ \dots $ $ A_N $

## 输出格式

答えを出力せよ。

## 说明/提示

### 制約

- $ 1\leq\ N,M\ \leq\ 2025 $
- $ 1\leq\ A_i\leq\ N $
- 入力は全て整数
 
### Sample Explanation 1

$ x=(1,1,1),(2,2,1),(2,2,2),(3,3,1),(3,3,2),(3,3,3) $ が条件を満たします。

## 样例 #1

### 输入

```
3 3

2 1 1
```

### 输出

```
6
```

## 样例 #2

### 输入

```
4 9

1 1 1 1
```

### 输出

```
2025
```

## 样例 #3

### 输入

```
10 5

9 4 5 5 4 2 1 5 7 2
```

### 输出

```
10010
```



---

---
title: "[ABC389E] Square Price"
layout: "post"
diff: 提高+/省选-
pid: AT_abc389_e
tag: []
---

# [ABC389E] Square Price

## 题目描述

有$N$ 种商品，每种商品各有$10^{100}$个。购买$k$个第$i$种商品需要花费$k^2P_i$日元。在总开销不超过$M$日元的前提下，求出最多可以买到的商品数量。

## 输入格式

第一行两个正整数$N,M$；第二行$N$个正整数$P_i$。

## 输出格式

输出一行一个正整数，代表最多能买到的商品数量。

### 样例1解释
购买第一种商品2个，第二种商品1个，共花费$2^2\times1+1^2\times4=8$日元。可以证明不存在购买4件商品的方案，因此输出答案$3$

## 样例 #1

### 输入

```
3 9

4 1 9
```

### 输出

```
3
```

## 样例 #2

### 输入

```
10 1000

2 15 6 5 12 1 7 9 17 2
```

### 输出

```
53
```



---

---
title: "[ABC389F] Rated Range"
layout: "post"
diff: 提高+/省选-
pid: AT_abc389_f
tag: []
---

# [ABC389F] Rated Range

## 题目描述

### 题目翻译

高桥（Takahashi）想参加 AtCoder 比赛 $N$ 次。

对于 $i$ -th $(1\leq i\leq N)$ 比赛，如果评分在 $L_i$ 和 $R_i$ 之间，评分就会增加 $1$。

回答 $Q$ 查询的格式如下。

- 给出一个整数 $X$。 假设高桥的初始评分是 $X$，求他在 $N$ 次比赛后的评分。

## 输入格式

输入以下列形式输入。

>$N$  
$L_1$ $R_1$  
$L_2$ $R_2$  
$\vdots$  
$L_N$ $R_N$  
$Q$  
$\text{query}_1$  
$\text{query}_2$  
$\vdots $  
$\text{query}_Q$

其中 $\text{query}_ i$ 表示第 $i$ 个查询，其形式为:

> $X$

## 输出格式

$Q$ 输出行。在 $i$ 行中，输出第 $i$ 次查询的答案。

### Constraints.

- $ 1\ \leq\ N\ \leq\ 2\ \times\ 10^5 $
- $ 1\ \leq\ L_i\ \leq\ R_i\ \leq\ 5\ \times\ 10^5 $ $ (1\ \leq\ i\ \leq\ N) $
- $ 1\ \leq\ Q\ \leq\ 3\ \times\ 10^5 $
- 对于每个询问 $1\leq X\leq5\times10^5$
- 所有输入都是整数
#### 示例解释 1

对于第一个查询，每场比赛的评分变化如下。
- 在 $1$ 第一项比赛中，评分在 $1$ 和 $5$ 之间，因此评分增加 $1$ 到 $4$。
- 在 $2$ 元第二场比赛中，评级不在 $1$ 元和 $3$ 元之间，因此评级没有增加，仍为 $4$ 元。
- 在 $3$ 第二轮比赛中，评级介于 $3$ 和 $6$ 之间，因此评级增加 $1$ 至 $5$。
- 在 $4$ 第二场比赛中，评级不在 $2$ 和 $4$ 之间，因此评级没有提高，仍为 $5$。
- 在 $5$ 竞赛中，评分介于 $4$ 和 $7$ 之间，因此评分增加 $1$ 至 $6$。对于第二个 $2$ 查询，在 $1、2、3、5$ 竞赛中，评级增加了 $1$，因此评级为 $6$。对于 $3$ 查询，由于 $1,3,5 $ 竞赛的评分提高了 $1$，因此评分为 $8$。

## 样例 #1

### 输入

```
5

1 5

1 3

3 6

2 4

4 7

3

3

2

5
```

### 输出

```
6

6

8
```

## 样例 #2

### 输入

```
10

1 1999

1 1999

1200 2399

1 1999

1 1999

1 1999

2000 500000

1 1999

1 1999

1600 2799

7

1

1995

2000

2399

500000

2799

1000
```

### 输出

```
8

2002

2003

2402

500001

2800

1007
```

## 样例 #3

### 输入

```
15

260522 414575

436426 479445

148772 190081

190629 433447

47202 203497

394325 407775

304784 463982

302156 468417

131932 235902

78537 395728

223857 330739

286918 329211

39679 238506

63340 186568

160016 361868

10

287940

296263

224593

101449

336991

390310

323355

177068

11431

8580
```

### 输出

```
287946

296269

224599

101453

336997

390315

323363

177075

11431

8580
```



---

---
title: "Sum is Multiple"
layout: "post"
diff: 提高+/省选-
pid: AT_acl1_b
tag: []
---

# Sum is Multiple

## 题目描述

[problemUrl]: https://atcoder.jp/contests/acl1/tasks/acl1_b

整数 $ N $ が与えられます． 正の整数 $ k $ であって，$ (1+2+\cdots+k) $ が $ N $ の倍数になるもののうち， 最小のものを求めてください． なお，このような正の整数 $ k $ が必ず存在することは証明できます．

## 输入格式

入力は以下の形式で標準入力から与えられる．

> $ N $

## 输出格式

答えを一行に出力せよ．

## 说明/提示

### 制約

- $ 1\ \leq\ N\ \leq\ 10^{15} $
- 入力は全て整数である．

### Sample Explanation 1

$ 1+2+\cdots+10=55 $ であり，これは確かに $ N=11 $ の倍数です． $ k\ \leq\ 9 $ で条件を満たすものは存在しないため，$ k=10 $ が答えになります．

## 样例 #1

### 输入

```
11
```

### 输出

```
10
```

## 样例 #2

### 输入

```
20200920
```

### 输出

```
1100144
```



---

---
title: "Moving Pieces"
layout: "post"
diff: 提高+/省选-
pid: AT_acl1_c
tag: []
---

# Moving Pieces

## 题目描述

[problemUrl]: https://atcoder.jp/contests/acl1/tasks/acl1_c

$ N $ 行 $ M $ 列からなる盤面があります． この盤面の情報は $ N $ 個の文字列 $ S_1,S_2,\ldots,S_N $ によって表されます． 具体的には，上から $ i $ 行目，左から $ j $ 列目のマスの状態は，以下のように表されます．

- $ S_{i,j}= $`.` : このマスは空である．
- $ S_{i,j}= $`#` : このマスには障害物が置かれている．
- $ S_{i,j}= $`o` : このマスには $ 1 $ つの駒が置かれている．

yosupo くんが，これから以下の操作を繰り返します．

- 駒を $ 1 $ つ選び，$ 1 $ 個下，もしくは $ 1 $ 個右のマスに移動させる． ただし，他の駒もしくは障害物のあるマスに駒を移動させる操作は禁止されている． もちろん，駒が盤面を飛び出すような操作も行えない．

yosupo くんは，できるだけ多くの回数操作をしたいです． 操作回数の最大値を求めてください．

## 输入格式

入力は以下の形式で標準入力から与えられる．

> $ N $ $ M $ $ S_1 $ $ S_2 $ $ \vdots $ $ S_N $

## 输出格式

操作回数の最大値を一行に出力せよ．

## 说明/提示

### 制約

- $ 1\ \leq\ N\ \leq\ 50 $
- $ 1\ \leq\ M\ \leq\ 50 $
- $ S_i $ は，`.`,`#`,`o` からなる長さ $ M $ の文字列．
- $ 1\ \leq\ ( $ 駒の個数 $ )\leq\ 100 $． つまり，$ S_{i,j}= $`o` を満たす $ (i,j) $ の個数は $ 1 $ 個以上 $ 100 $ 個以下．

### Sample Explanation 1

以下のように $ 4 $ 回の操作を行えます． ``` o.. .o. ..o ... ... ... -&gt; ... -&gt; ... -&gt; ..o -&gt; ..o o.# o.# o.# o.# .o# ```

## 样例 #1

### 输入

```
3 3

o..

...

o.#
```

### 输出

```
4
```

## 样例 #2

### 输入

```
9 10

.#....o#..

.#..#..##o

.....#o.##

.###.#o..o

#.#...##.#

..#..#.###

#o.....#..

....###..o

o.......o#
```

### 输出

```
24
```



---

---
title: "[AGC005C] Tree Restoring"
layout: "post"
diff: 提高+/省选-
pid: AT_agc005_c
tag: []
---

# [AGC005C] Tree Restoring

## 题目描述

[problemUrl]: https://atcoder.jp/contests/agc005/tasks/agc005_c

青木君は数列と木が大好きです。

青木君はある日高橋くんから長さ $ N $ の数列 $ a_1,\ a_2,\ ...,\ a_N $ を貰いました。そしてこの数列を見て、木を作りたくなりました。

青木君が作りたいのは、頂点数が $ N $ で、全ての $ i\ =\ 1,2,...,N $ について頂点 $ i $ と最も遠い頂点の距離が $ a_i $ となる木です。なお、辺の長さは全て $ 1 $ とします。

これを満たす木が存在するか判定してください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ a_1 $ $ a_2 $ $ ... $ $ a_N $

## 输出格式

条件を満たす木が存在するならば `Possible`、しないならば `Impossible` と出力する。

## 说明/提示

### 制約

- $ 2\ ≦\ N\ ≦\ 100 $
- $ 1\ ≦\ a_i\ ≦\ N-1 $

### Sample Explanation 1

!\[\](https://atcoder.jp/img/agc005/cda0380bb5cd1b9502cfceaf2526d91e.png) 上図は条件を見たす木の一例です。赤い矢印は最も遠い頂点への経路を表します。

## 样例 #1

### 输入

```
5

3 2 2 3 3
```

### 输出

```
Possible
```

## 样例 #2

### 输入

```
3

1 1 2
```

### 输出

```
Impossible
```

## 样例 #3

### 输入

```
10

1 2 2 2 2 2 2 2 2 2
```

### 输出

```
Possible
```

## 样例 #4

### 输入

```
10

1 1 2 2 2 2 2 2 2 2
```

### 输出

```
Impossible
```

## 样例 #5

### 输入

```
6

1 1 1 1 1 5
```

### 输出

```
Impossible
```

## 样例 #6

### 输入

```
5

4 3 2 3 4
```

### 输出

```
Possible
```



---

---
title: "[AGC009B] Tournament"
layout: "post"
diff: 提高+/省选-
pid: AT_agc009_b
tag: []
---

# [AGC009B] Tournament

## 题目描述

[problemUrl]: https://atcoder.jp/contests/jrex2017/tasks/agc009_b

$ N $ 人の人が大会に出場しました。この大会はトーナメント形式であり、$ N-1 $ 回の試合が行われました。 諸事情により、このトーナメントは全参加者に平等に組まれているとは限りません。 すなわち、各人に対し、優勝するために必要なその人が勝者となるような試合数が等しいとは限りません。 トーナメントの構造は、正式には問題文の末尾で定義されます。

各試合では必ず片方の人が勝者、もう片方の人が敗者となり、最後まで負けなかった $ 1 $ 人が優勝となります。

 ![](https://cdn.luogu.com.cn/upload/vjudge_pic/AT_agc009_b/60b2a9eae65eb70a75e8c33bcbb94cf7111ee45a.png)図: トーナメントの例

 

人には $ 1 $ から $ N $ までの番号がついており、$ 1 $ 番の人が優勝し、優勝者以外の人 $ i(2\ ≦\ i\ ≦\ N) $ は人 $ a_i $ との試合で負けました。

トーナメントの深さとは、すべての人に対する、その人が優勝するために必要な、その人が勝者となるような試合数の最大値です。

トーナメントの深さとしてありうる最小の値を求めてください。

トーナメントの構造の正式な定義は以下の通りです。$ i $ 回目の試合では、

- あらかじめ決められた、まだ試合をしていない $ 2 $ 人の人
- あらかじめ決められたまだ試合をしていない人 $ 1 $ 人と、あらかじめ決められた $ j(j\ <\ i) $ に対する、$ j $ 回目の試合の勝者
- あらかじめ決められた $ j,k(j,k\ <\ i,\ j\ ≠\ k) $ に対する、$ j $ 回目の試合の勝者と $ k $ 回目の試合の勝者

のうちのいずれかの $ 2 $ 人が試合を行います。このような構造であって、どのように試合結果を決めても、すでに一度試合に負けた人が再び試合をすることのないようなものをトーナメントと呼びます。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ a_2 $ : $ a_N $

## 输出格式

トーナメントの深さとしてありうる最小の値を出力せよ。

## 说明/提示

### 制約

- $ 2\ ≦\ N\ ≦\ 10^5 $
- $ 1\ ≦\ a_i\ ≦\ N(2\ ≦\ i\ ≦\ N) $
- 入力の試合結果と合致するようなトーナメントが存在する

### Sample Explanation 1

次のような試合結果が条件を満たします。 - $ 1 $ 回目の試合では、人 $ 4 $ と 人 $ 5 $ が対戦し、人 $ 4 $ が勝つ - $ 2 $ 回目の試合では、人 $ 2 $ と 人 $ 4 $ が対戦し、人 $ 2 $ が勝つ - $ 3 $ 回目の試合では、人 $ 1 $ と 人 $ 3 $ が対戦し、人 $ 1 $ が勝つ - $ 4 $ 回目の試合では、人 $ 1 $ と 人 $ 2 $ が対戦し、人 $ 1 $ が勝つ !\[783f7be9c88350e31963edba8a958879.png\](https://atcoder.jp/img/agc009/783f7be9c88350e31963edba8a958879.png) このトーナメントは、人 $ 5 $ が優勝するためには $ 3 $ 回勝利する必要があるので、深さ $ 3 $ のトーナメントとなります。 逆に、深さ $ 2 $ 以下の条件を満たすトーナメントは存在しないので、$ 3 $ を出力します。

## 样例 #1

### 输入

```
5

1

1

2

4
```

### 输出

```
3
```

## 样例 #2

### 输入

```
7

1

2

1

3

1

4
```

### 输出

```
3
```

## 样例 #3

### 输入

```
4

4

4

1
```

### 输出

```
3
```



---

---
title: "[AGC010B] Boxes"
layout: "post"
diff: 提高+/省选-
pid: AT_agc010_b
tag: []
---

# [AGC010B] Boxes

## 题目描述

[problemUrl]: https://atcoder.jp/contests/agc010/tasks/agc010_b

$ N $ 個の箱が円環状に並んでおり、$ i $ 番目の箱には $ A_i $ 個の石が入っています。

以下の操作を繰り返して、全ての石を取り除くことができるか判定してください。

- 箱を一か所選ぶ。それを $ i $ 番目としたとき、$ 1 $ から $ N $ の各 $ j $ に対して、$ i+j $ 番目の箱から石をちょうど $ j $ 個取り除く。  
   ただし、$ N+k $ 番目と表される箱は $ k $ 番目の箱と同一視するものとする。

各操作において、取り除きたい個数の石がない箱があるときは、その操作を行えないことに注意してください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ A_1 $ $ A_2 $ … $ A_N $

## 输出格式

全ての石を取り除くことができるなら `YES` を、そうでないなら `NO` を出力せよ。

## 说明/提示

### 制約

- $ 1\ ≦\ N\ ≦\ 10^5 $
- $ 1\ ≦\ A_i\ ≦\ 10^9 $

### Sample Explanation 1

最初に箱 $ 2 $ を選ぶことで、一回の操作ですべての石を回収できます。

## 样例 #1

### 输入

```
5

4 5 1 2 3
```

### 输出

```
YES
```

## 样例 #2

### 输入

```
5

6 9 12 10 8
```

### 输出

```
YES
```

## 样例 #3

### 输入

```
4

1 2 3 1
```

### 输出

```
NO
```



---

---
title: "[AGC011C] Squared Graph"
layout: "post"
diff: 提高+/省选-
pid: AT_agc011_c
tag: []
---

# [AGC011C] Squared Graph

## 题目描述

[problemUrl]: https://atcoder.jp/contests/agc011/tasks/agc011_c

高橋君は，$ N $ 頂点 $ 1 $, $ 2 $, ..., $ N $ からなる無向グラフをもらいました． このグラフの辺は $ (u_i,\ v_i) $ で表されます． このグラフには，自己辺や多重辺は存在しません．

高橋君は，このグラフをもとに，$ N^2 $ 頂点 $ (a,\ b) $ ($ 1\ \leq\ a\ \leq\ N $, $ 1\ \leq\ b\ \leq\ N $) からなるグラフを作ることにしました． このグラフの辺は，次の規則で定まります．

- 元のグラフにおいて $ a $ と $ a' $ の間および $ b $ と $ b' $ の間の両方に辺があるとき，またそのときに限り，$ (a,\ b) $ と $ (a',\ b') $ の間に辺を張る．

このようにして作ったグラフの連結成分の個数を求めてください．

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ M $ $ u_1 $ $ v_1 $ $ u_2 $ $ v_2 $ : $ u_M $ $ v_M $

## 输出格式

高橋君の作ったグラフの連結成分の個数を出力せよ．

## 说明/提示

### 制約

- $ 2\ \leq\ N\ \leq\ 100,000 $
- $ 0\ \leq\ M\ \leq\ 200,000 $
- $ 1\ \leq\ u_i\ <\ v_i\ \leq\ N $
- $ u_i\ =\ u_j $ かつ $ v_i\ =\ v_j $ を満たすような異なる $ i,\ j $ の組は存在しない

### Sample Explanation 1

高橋君の作ったグラフは下のようになります． !\[\](https://atcoder.jp/img/agc011/6d34a4ddeba67b2286c00acda56abbcc.png)

## 样例 #1

### 输入

```
3 1

1 2
```

### 输出

```
7
```

## 样例 #2

### 输入

```
7 5

1 2

3 4

3 5

4 5

2 6
```

### 输出

```
18
```



---

---
title: "[AGC014B] Unplanned Queries"
layout: "post"
diff: 提高+/省选-
pid: AT_agc014_b
tag: []
---

# [AGC014B] Unplanned Queries

## 题目描述

[problemUrl]: https://atcoder.jp/contests/agc014/tasks/agc014_b

高橋君は木の問題が苦手です。そこで、青木君は高橋君の練習相手になってあげることにしました。

まず、高橋君は $ N $ 頂点からなる木を用意し、頂点に $ 1 $ から $ N $ の番号を付けました。 そして、各辺に $ 0 $ と書きました。

次に、青木君は高橋君に $ M $ 個のクエリを与えました。$ i $ 個目のクエリは以下のような内容です。

- 頂点 $ a_i $ と頂点 $ b_i $ を結ぶパス上の辺すべてに対して、書かれている数を $ 1 $ 増やす。

全てのクエリを終えた後、高橋君は青木君にどの辺を見ても書かれている数が偶数になったと伝えました。 しかし、青木君は最初に高橋君が用意していた木を確認していなかったので、 高橋君が正しくクエリを処理できたか分かりませんでした。

青木君を助けるために、高橋くんの言う性質を満たす木が存在するかどうかを判定してください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ M $ $ a_1 $ $ b_1 $ : $ a_M $ $ b_M $

## 输出格式

高橋くんの言う性質を満たす木が存在するならば `YES` を、存在しないならば `NO` を出力せよ。

## 说明/提示

### 制約

- $ 2\ ≦\ N\ ≦\ 10^5 $
- $ 1\ ≦\ M\ ≦\ 10^5 $
- $ 1\ ≦\ a_i,b_i\ ≦\ N $
- $ a_i\ ≠\ b_i $

### Sample Explanation 1

例えば、頂点 $ 1 $ と頂点 $ 2,3,4 $ が辺で結ばれているような木を高橋君が持っている場合は、高橋くんの言っていることは正しいです。 この場合、クエリをすべて終えた後各辺に書かれている数はどれも $ 2 $ になります。

## 样例 #1

### 输入

```
4 4

1 2

2 4

1 3

3 4
```

### 输出

```
YES
```

## 样例 #2

### 输入

```
5 5

1 2

3 5

5 1

3 4

2 3
```

### 输出

```
NO
```



---

---
title: "[AGC021B] Holes"
layout: "post"
diff: 提高+/省选-
pid: AT_agc021_b
tag: []
---

# [AGC021B] Holes

## 题目描述

[problemUrl]: https://atcoder.jp/contests/agc021/tasks/agc021_b

平面上に $ N $ 個の穴があります。$ i $ 個目の穴の座標は、$ (x_i,y_i) $ です。

$ R=10^{10^{10^{10}}} $ とします。りんごさんは、以下の操作を行います。

- 原点を中心とする半径 $ R $ の円内から無作為に $ 1 $ 点を選び、すぬけ君を置く。すぬけ君は、置かれた点からユークリッド距離が最も近い穴に移動し、落ちる。そのような穴が複数ある場合は、添え字の最も小さいものを選ぶ。

全ての $ 1\leq\ i\leq\ N $ に対し、すぬけ君が $ i $ 番目の穴に落ちる確率を求めてください。

ただし、半径 $ R $ の円内から無作為に $ 1 $ 点を選ぶ操作とは、以下の操作を指します。

- $ [-R,R] $ 上の独立な一様分布にしたがって実数 $ x,y $ を選ぶ。
- もし$ x^2+y^2\leq\ R^2 $ なら、座標 $ (x,y) $ を選ぶ。そうでないなら、その条件が満たされるまで実数 $ x,y $ を選びなおし続ける。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ x_1 $ $ y_1 $ $ : $ $ x_N $ $ y_N $

## 输出格式

実数を $ N $ 個出力せよ。$ i $ 個目の実数は、すぬけ君が $ i $ 番目の穴に落ちる確率を表さなければならない。

出力されたすべての値について絶対誤差あるいは相対誤差が $ 10^{-5} $ 以下のとき、正答と判定される。

## 说明/提示

### 制約

- $ 2\ \leq\ N\ \leq\ 100 $
- $ |x_i|,|y_i|\ \leq\ 10^6(1\leq\ i\leq\ N) $
- 与えられる点は全て相異なる
- 入力はすべて整数である

### Sample Explanation 1

りんごさんが $ x+y\leq\ 1 $ なる領域にすぬけ君を置いた場合、すぬけ君は $ 1 $ 番目の穴に落ちます。このような確率は $ 0.5 $ に非常に近いです。 また、そうでない場合すぬけ君は $ 2 $ 番目の穴に落ち、そのような確率も $ 0.5 $ に非常に近いです。

## 样例 #1

### 输入

```
2

0 0

1 1
```

### 输出

```
0.5

0.5
```

## 样例 #2

### 输入

```
5

0 0

2 8

4 5

2 6

3 10
```

### 输出

```
0.43160120892732328768

0.03480224363653196956

0.13880483535586193855

0.00000000000000000000

0.39479171208028279727
```



---

---
title: "[AGC022C] Remainder Game"
layout: "post"
diff: 提高+/省选-
pid: AT_agc022_c
tag: []
---

# [AGC022C] Remainder Game

## 题目描述

[problemUrl]: https://atcoder.jp/contests/agc022/tasks/agc022_c

アオキは数列 $ a_{1},\ a_{2},\ ...,\ a_{N} $ で遊んでいます。$ 1 $ 秒ごとに、アオキは次の操作を行います。

- 正の整数 $ k $ を選ぶ。数列のそれぞれの要素 $ v $ について、アオキは $ v $ を「$ v $ を $ k $ で割った余り」に置き換えるか、$ v $ をそのままにするかを選べる。この一連の操作のコストは（書き換えた要素の数によらず）$ 2^{k} $ である。

アオキは、数列を $ b_{1},\ b_{2},\ ...,\ b_{N} $ に変えたいです（要素の順番も考慮します）。この目的を達成することが可能か判定し、可能である場合は必要な最小のコストを求めてください。

## 输入格式

入力は標準入力から以下の形式で与えられる。

> $ N $ $ a_{1} $ $ a_{2} $ $ ... $ $ a_{N} $ $ b_{1} $ $ b_{2} $ $ ... $ $ b_{N} $

## 输出格式

はじめの数列を $ b_{1},\ b_{2},\ ...,\ b_{N} $ に変えるのに必要な最小のコストを出力せよ。目的の達成が不可能である場合は、代わりに $ -1 $ と出力せよ。

## 说明/提示

### 制約

- $ 1\ \leq\ N\ \leq\ 50 $
- $ 0\ \leq\ a_{i},\ b_{i}\ \leq\ 50 $
- 入力中の値はすべて整数である。

### Sample Explanation 1

操作手順の例を挙げます。 - $ k\ =\ 7 $ を選ぶ。$ 19 $ を $ 5 $ に、$ 10 $ を $ 3 $ に置き換えて $ 14 $ はそのままにする。数列は $ 5,\ 3,\ 14 $ となる。 - $ k\ =\ 5 $ を選ぶ。$ 5 $ を $ 0 $ に置き換え、$ 3 $ はそのままにして $ 14 $ を $ 4 $ に置き換える。数列は $ 0,\ 3,\ 4 $ となる。 合計コストは $ 2^{7}\ +\ 2^{5}\ =\ 160 $ です。

### Sample Explanation 2

$ k\ =\ 1 $ を選び、すべてを $ 0 $ に変えるとよいです。コストは $ 2^{1}\ =\ 2 $ です。

### Sample Explanation 3

与えられた操作では $ 8 $ を $ 5 $ に変えることができないため、目的の達成は不可能です。

### Sample Explanation 4

この場合は何もする必要がありません。コストは $ 0 $ です。

### Sample Explanation 5

オーバーフローにご注意。

## 样例 #1

### 输入

```
3

19 10 14

0 3 4
```

### 输出

```
160
```

## 样例 #2

### 输入

```
3

19 15 14

0 0 0
```

### 输出

```
2
```

## 样例 #3

### 输入

```
2

8 13

5 13
```

### 输出

```
-1
```

## 样例 #4

### 输入

```
4

2 0 1 8

2 0 1 8
```

### 输出

```
0
```

## 样例 #5

### 输入

```
1

50

13
```

### 输出

```
137438953472
```



---

---
title: "[AGC023C] Painting Machines"
layout: "post"
diff: 提高+/省选-
pid: AT_agc023_c
tag: []
---

# [AGC023C] Painting Machines

## 题目描述

[problemUrl]: https://atcoder.jp/contests/agc023/tasks/agc023_c

$ N $ 個のマスが横一列に並んでおり、左から右へ $ 1 $ から $ N $ までの番号がついています。 最初、すべてのマス目は白いです。 また、$ N-1 $ 台のペイントマシンがあり、$ 1 $ から $ N-1 $ までの番号が付けられています。 ペイントマシン $ i $ は、稼働すると、マス $ i $ とマス $ i+1 $ を黒く塗ります。

すぬけ君は、これらのペイントマシンを、$ 1 $ 台ずつ順番に稼働させます。 すぬけくんがマシンを稼働させる順番は、$ (1,\ 2,\ ...,\ N-1) $ の順列 $ P $ によって表されます。 これは、$ i $ 番目に稼働させるマシンの番号が $ P_i $ であることを意味します。

ここで、ある順列 $ P $ のスコアは、その順列に従ってマシンを稼働させたとき、 すべてのマスが黒く塗られた状態に初めてなるまでに稼働させたマシンの台数と定義されます。 すぬけ君はまだ順列 $ P $ を決めていませんが、スコアに興味があります。 すぬけ君のために、すべての順列についてそのスコアを求め、その総和を求めてください。 ただし、答えは非常に大きくなることがあるので、$ 10^9\ +7 $ で割った余りを求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $

## 输出格式

すべての順列 $ P $ のスコアの総和を $ 10^9\ +\ 7 $ で割った余りを出力せよ。

## 说明/提示

### 制約

- $ 2\ \leq\ N\ \leq\ 10^6 $

### Sample Explanation 1

順列 $ P $ としてありうるものは $ 6 $ つあります。 この中で、$ P\ =\ (1,\ 3,\ 2) $ または $ P\ =\ (3,\ 1,\ 2) $ のときだけスコアは $ 2 $ になり、 それ以外のときはスコアは $ 3 $ になります。 よって、求める答えは $ 2\ \times\ 2\ +\ 3\ \times\ 4\ =\ 16 $ となります。

### Sample Explanation 2

ありうる唯一つの順列は $ P\ =\ (1) $ で、スコアは $ 1 $ です。

## 样例 #1

### 输入

```
4
```

### 输出

```
16
```

## 样例 #2

### 输入

```
2
```

### 输出

```
1
```

## 样例 #3

### 输入

```
5
```

### 输出

```
84
```

## 样例 #4

### 输入

```
100000
```

### 输出

```
341429644
```



---

---
title: "[AGC025C] Interval Game"
layout: "post"
diff: 提高+/省选-
pid: AT_agc025_c
tag: []
---

# [AGC025C] Interval Game

## 题目描述

[problemUrl]: https://atcoder.jp/contests/agc025/tasks/agc025_c

高橋君と青木君は数直線と区間を使ってゲームをすることにしました。 高橋君は数直線上に立っており、最初は座標 $ 0 $ にいます。 また、青木君は $ N $ 個の区間を持っており、$ i $ 個目の区間は $ [L_i,R_i] $、つまり座標が $ L_i $ 以上 $ R_i $ 以下の点からなる区間となっています。

このゲームは $ N $ 回のステップからなります。$ i $ ステップ目では以下の手順を踏みます。

- まず青木君は、$ N $ 個の区間の内、まだ選んでいない区間を一つ選び、その区間を高橋君に伝える。
- 次に高橋君は、青木君が今回選んだ区間に入るように、数直線上を移動する。

$ N $ 回のステップを終えた後、高橋君が座標 $ 0 $ まで戻ることでゲームは終了します。

高橋君がゲーム全体を通して移動する距離の合計を $ K $ としたとき、青木君は $ K $ ができるだけ大きくなるように区間を選び、 高橋君は $ K $ ができるだけ小さくなるように移動します。 このとき、最終的に高橋君の移動距離の合計 $ K $ はいくつになるでしょうか。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ L_1 $ $ R_1 $ : $ L_N $ $ R_N $

## 输出格式

高橋君と青木君が上記の条件に従って行動するときの高橋君が動く距離の合計を、$ 1 $ つの整数値として出力せよ。 ただし、$ L_i,R_i $ が整数であるとき、$ K $ が整数となることは保証されている。

## 说明/提示

### 制約

- $ 1\ ≦\ N\ ≦\ 10^5 $
- $ -10^5\ ≦\ L_i\ <\ R_i\ ≦\ 10^5 $
- $ L_i $ と $ R_i $ は整数

### Sample Explanation 1

高橋君と青木君の行動の一例は以下のようになります。 - 青木君が $ 1 $ 番目の区間を選び、高橋君は座標 $ 0 $ から座標 $ -4 $ まで距離 $ 4 $ だけ移動する。 - 青木君が $ 3 $ 番目の区間を選び、高橋君は座標 $ -4 $ のまま動かない - 青木君が $ 2 $ 番目の区間を選び、高橋君は座標 $ -4 $ から座標 $ 3 $ まで距離 $ 7 $ だけ移動する。 - 高橋君は座標 $ 3 $ から座標 $ 0 $ まで距離 $ 3 $ だけ移動する。 このとき高橋君の移動距離の合計は $ 14 $ になってしまうので、高橋君の行動は最適ではないですが、 動き方を変えることで、移動距離の合計を $ 10 $ にすることができます。

## 样例 #1

### 输入

```
3

-5 1

3 7

-4 -2
```

### 输出

```
10
```

## 样例 #2

### 输入

```
3

1 2

3 4

5 6
```

### 输出

```
12
```

## 样例 #3

### 输入

```
5

-2 0

-2 0

7 8

9 10

-2 -1
```

### 输出

```
34
```



---

---
title: "[AGC029C] Lexicographic constraints"
layout: "post"
diff: 提高+/省选-
pid: AT_agc029_c
tag: []
---

# [AGC029C] Lexicographic constraints

## 题目描述

[problemUrl]: https://atcoder.jp/contests/agc029/tasks/agc029_c

$ N $ 個の文字列が一列に並んでおり、どの隣り合う $ 2 $ つの文字列に対しても、 左に書いてある文字列の方が右に書いてある文字列よりも辞書順で小さいことが分かっています。 つまり、左から $ i $ 番目の文字列を $ S_i $ としたときに、辞書順で $ S_1\ <\ S_2\ <\ ...\ <\ S_N $ が成り立っています。

$ S_i $ の長さが $ A_i $ であると分かっているとき、$ S_1,S_2,...,S_N $ に含まれる文字の種類数として考えられる最小の値を求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ A_1 $ $ A_2 $ ... $ A_N $

## 输出格式

いずれかの文字列に含まれる文字の種類数として考えられる最小の値を出力せよ。

## 说明/提示

### 制約

- $ 1\ \leq\ N\ \leq\ 2\times\ 10^5 $
- $ 1\ \leq\ A_i\ \leq\ 10^9 $
- $ A_i $ は整数

### Note

文字列は英字アルファベットからなる必要はない。無限に多くの文字があり、辞書式順序がそれらについて定まっているとして良い。

### Sample Explanation 1

例えば、$ S_1= $`abc`, $ S_2= $`bb`, $ S_3= $`c` のときは$ S_1,S_2,...,S_N $ に含まれる文字の種類数は $ 3 $ になります。 しかし、文字列をうまく選ぶと、文字の種類数を $ 2 $ にすることができます。

## 样例 #1

### 输入

```
3

3 2 1
```

### 输出

```
2
```

## 样例 #2

### 输入

```
5

2 3 2 1 2
```

### 输出

```
2
```



---

---
title: "[AGC030B] Tree Burning"
layout: "post"
diff: 提高+/省选-
pid: AT_agc030_b
tag: []
---

# [AGC030B] Tree Burning

## 题目描述

[problemUrl]: https://atcoder.jp/contests/agc030/tasks/agc030_b

高橋湖の周長は $ L $ です。高橋湖の周上には湖の所有者である高橋君の家があります。 高橋湖の周上の地点には高橋君の家から反時計回りに測った距離を用いて、$ 0 $ 以上 $ L $ 未満の実数の座標が定まっています。

高橋湖の周上には木が $ N $ 本生えています。$ i $ 本目の木は座標 $ X_i $ に生えています。高橋君の家のある座標 $ 0 $ には木は生えていません。

高橋君は、自分の家からはじめて、以下の行動を繰り返します。

- すべての木を燃やし終えている場合、終了する。
- 時計回りまたは反時計回りの向きを指定する。
- 初めてまだ燃やしていない木のある座標に到達するまで、指定した方向に高橋湖の周上を歩き続ける。
- 木のある座標に到達したら、その木を燃やしてその場に立ち止まり、最初に戻る。

この行動を通じて、高橋君が歩く距離の合計の最大値を求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ L $ $ N $ $ X_1 $ $ : $ $ X_N $

## 输出格式

高橋君が歩く距離の合計の最大値を出力せよ。

## 说明/提示

### 制約

- $ 2\ \leq\ L\ \leq\ 10^9 $
- $ 1\ \leq\ N\ \leq\ 2\times\ 10^5 $
- $ 1\ \leq\ X_1\ <\ ...\ <\ X_N\ \leq\ L-1 $
- 入力はすべて整数である

### 部分点

この問題には部分点が設定されている。

- $ N\ \leq\ 2000 $ を満たす入力に正解すると、$ 300 $ 点が得られる。

### Sample Explanation 1

以下のような行動で、高橋君は距離 $ 15 $ を歩きます。 - 反時計回りに距離 $ 2 $ ぶんだけ歩き、座標 $ 2 $ にある木を燃やして立ち止まる。 - 反時計回りに距離 $ 5 $ ぶんだけ歩き、座標 $ 7 $ にある木を燃やして立ち止まる。 - 時計回りに距離 $ 8 $ ぶんだけ歩き、座標 $ 9 $ にある木を燃やして立ち止まる。

## 样例 #1

### 输入

```
10 3

2

7

9
```

### 输出

```
15
```

## 样例 #2

### 输入

```
10 6

1

2

3

6

7

9
```

### 输出

```
27
```

## 样例 #3

### 输入

```
314159265 7

21662711

77271666

89022761

156626166

160332356

166902656

298992265
```

### 输出

```
1204124749
```



---

---
title: "[AGC059A] My Last ABC Problem"
layout: "post"
diff: 提高+/省选-
pid: AT_agc059_a
tag: ['Ad-hoc']
---

# [AGC059A] My Last ABC Problem

## 题目描述

[problemUrl]: https://atcoder.jp/contests/agc059/tasks/agc059_a

文字 `A`, `B`, `C` のみからなる文字列 $ t $ を考えます。 これに対し、以下の操作を行えます。

- 任意の部分文字列 $ t[l:r] $ と文字 $ ( $`A`$ , $`B`$ , $`C`$ ) $ の任意の並べ替え $ (X,\ Y,\ Z) $ を選ぶ。ここで、$ t[l:r] $ は $ t $ の $ l $ 文字目から $ r $ 文字目までで形成される部分文字列であり、$ l $ と $ r $ を選べる。そして、$ t[l:r] $ の各文字 `A`, `B`, `C` をそれぞれ $ X $, $ Y $, $ Z $ で置き換える。
 
例えば、文字列 $ t\ = $ `ACBAAC` に対して、部分文字列 $ t[3:6] $ と $ (X,Y,Z)=( $`C`$ , $`B`$ , $`A`$ ) $ を選べます。 この操作を行うと、文字列は `ACBCCA` となります。

アリーナは、すべての文字が同じであるような文字列が好きです。彼女は、文字列 $ t $ の美しさを、そのすべての文字を同じにするために必要な最小の操作回数と定義します。

長さ $ N $ の文字 `A`, `B`, `C` のみからなる文字列 $ S $ が与えられます。 $ Q $ 個のクエリに答えてください。$ i $ 個目のクエリは以下の通りです。

- 整数 $ L_i $ と $ R_i $ が与えられるので、部分文字列 $ t=S[L_i:R_i] $ の美しさを求めよ。

## 输入格式

入力は標準入力から以下の形式で与えられる。

> $ N $ $ Q $ $ S $ $ L_1 $ $ R_1 $ $ L_2 $ $ R_2 $ $ \vdots $ $ L_Q $ $ R_Q $

## 输出格式

$ Q $ 行を出力せよ。$ i $ 行目には、$ i $ 個目のクエリへの答えを出力せよ。

## 说明/提示

### 制約

- $ 1\ \le\ N\ \le\ 10^5 $
- $ S $ は文字 `A`, `B`, `C` のみからなる文字列である。
- $ 1\ \le\ Q\ \le\ 10^5 $
- $ 1\ \le\ L_i\ \le\ R_i\ \le\ N $
- 入力中のすべての数は整数である。
 
### Sample Explanation 1

一つ目のクエリでは、文字列は $ t\ = $ `CCC` であり、すでにすべての文字が同じです。答えは $ 0 $ となります。 二つ目のクエリでは、文字列は $ t\ = $ `BC` です。これは、部分文字列 $ t[2:2] $ と $ (X,Y,Z)=( $`A`$ , $`C`$ , $`B`$ ) $ を選ぶことで、一回の操作で `BB` に変えることができます。 三つ目のクエリでは、文字列は $ t\ = $ `ABC` です。これは、部分文字列 $ t[2:3] $ と $ (X,Y,Z)=( $`C`$ , $`A`$ , $`B`$ ) $ を選ぶことで、一回の操作で `AAB` に、続いて部分文字列 $ t[1:2] $ と $ (X,Y,Z)=( $`B`$ , $`A`$ , $`C`$ ) $ を選ぶことで、二回目の操作で `BBB` に変えることができます。

## 样例 #1

### 输入

```
6 4

ABCCCA

3 5

2 3

1 3

1 6
```

### 输出

```
0

1

2

2
```



---

---
title: "Camel Train"
layout: "post"
diff: 提高+/省选-
pid: AT_aising2020_e
tag: []
---

# Camel Train

## 题目描述

[problemUrl]: https://atcoder.jp/contests/aising2020/tasks/aising2020_e

$ 1,2,\ldots,N $ の番号がついた $ N $ 頭のラクダがいます。 すぬけ君はラクダたちを一列に並べることにしました。

ラクダ $ i $ が先頭から $ K_i $ 番目以内にいるときのうれしさは $ L_i $ です。 そうでない場合のうれしさは $ R_i $ です。

すぬけ君はラクダたちのうれしさの総和を最大化したいです。 ラクダたちのうれしさの総和としてありうる値のうち最大値を求めてください。

テストケースは $ T $ 個与えられるので、それぞれについて答えを求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ T $ $ \mathrm{case}_1 $ $ \vdots $ $ \mathrm{case}_T $

各ケースは以下の形式で与えられる。

> $ N $ $ K_1 $ $ L_1 $ $ R_1 $ $ \vdots $ $ K_N $ $ L_N $ $ R_N $

## 输出格式

$ T $ 行出力せよ。$ i $ 行目には $ i $ 番目のテストケースに対する答えを出力せよ。

## 说明/提示

### 制約

- 与えられる入力は全て整数
- $ 1\ \leq\ T\ \leq\ 10^5 $
- $ 1\ \leq\ N\ \leq\ 2\ \times\ 10^{5} $
- $ 1\ \leq\ K_i\ \leq\ N $
- $ 1\ \leq\ L_i,\ R_i\ \leq\ 10^9 $
- $ 1 $ つの入力ファイルにおいて、$ N $ の総和は $ 2\ \times\ 10^5 $ を超えない。

### Sample Explanation 1

\- $ 1 $ 番目のテストケースにおいて、ラクダ $ 2,1 $ の順で並べるのが最適です。 - ラクダ $ 1 $ は先頭から $ 1 $ 番目以内にいないのでうれしさは $ 10 $ です。 - ラクダ $ 2 $ は先頭から $ 2 $ 番目以内にいるのでうれしさは $ 15 $ です。 - $ 2 $ 番目のテストケースにおいて、ラクダ $ 2,1,3 $ の順で並べるのが最適です。 - ラクダ $ 1 $ は先頭から $ 2 $ 番目以内にいるのでうれしさは $ 93 $ です。 - ラクダ $ 2 $ は先頭から $ 1 $ 番目以内にいるのでうれしさは $ 71 $ です。 - ラクダ $ 3 $ は先頭から $ 3 $ 番目以内にいるのでうれしさは $ 57 $ です。

## 样例 #1

### 输入

```
3

2

1 5 10

2 15 5

3

2 93 78

1 71 59

3 57 96

19

19 23 16

5 90 13

12 85 70

19 67 78

12 16 60

18 48 28

5 4 24

12 97 97

4 57 87

19 91 74

18 100 76

7 86 46

9 100 57

3 76 73

6 84 93

1 6 84

11 75 94

19 15 3

12 11 34
```

### 输出

```
25

221

1354
```



---

---
title: "Forest"
layout: "post"
diff: 提高+/省选-
pid: AT_apc001_d
tag: []
---

# Forest

## 题目描述

[problemUrl]: https://atcoder.jp/contests/apc001/tasks/apc001_d

$ N $ 頂点 $ M $ 辺の森が与えられます。頂点には $ 0 $ から $ N-1 $ の番号がついています。 辺は $ (x_i,y_i) $ の形で与えられます。これは頂点 $ x_i $ と $ y_i $ が辺でつながっていることを意味します。

各頂点 $ i $ には $ a_i $ という値が定まっています。 あなたは与えられた森に辺を追加して連結にしたいです。 辺を追加するときには、まず異なる頂点二つを選択し( $ i $ , $ j $ とする)、 $ i $ と $ j $ の間に辺を張ります。 この時コストが $ a_i+a_j $ かかります。そしてこれ以降，頂点 $ i $ と $ j $ は永遠に選択できなくなります。

森を連結にする最小コストを求めてください。 連結にするのが不可能な場合は`Impossible`と出力してください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ M $ $ a_0 $ $ a_1 $ $ .. $ $ a_{N-1} $ $ x_1 $ $ y_1 $ $ x_2 $ $ y_2 $ $ : $ $ x_M $ $ y_M $

## 输出格式

森を連結にする最小コストを出力せよ。ただし、不可能な場合は`Impossible`と出力せよ。

## 说明/提示

### 制約

- $ 1\ <\ =\ N\ <\ =\ 100,000 $
- $ 0\ <\ =\ M\ <\ =\ N-1 $
- $ 1\ <\ =\ a_i\ <\ =\ 10^9 $
- $ 0\ <\ =\ x_i,y_i\ <\ =\ N-1 $
- 与えられるグラフは森
- 入力は全て整数

### Sample Explanation 1

頂点 $ 0 $, $ 5 $ をつなぐとグラフが連結になり，この時かかるコストは $ 1\ +\ 6\ =\ 7 $ です。

### Sample Explanation 2

どのように辺を追加してもグラフを連結にすることはできません。

### Sample Explanation 3

最初からグラフは連結であるので，辺を追加する必要はありません。

## 样例 #1

### 输入

```
7 5

1 2 3 4 5 6 7

3 0

4 0

1 2

1 3

5 6
```

### 输出

```
7
```

## 样例 #2

### 输入

```
5 0

3 1 4 1 5
```

### 输出

```
Impossible
```

## 样例 #3

### 输入

```
1 0

5
```

### 输出

```
0
```



---

---
title: "[ARC001D] レースゲーム"
layout: "post"
diff: 提高+/省选-
pid: AT_arc001_4
tag: []
---

# [ARC001D] レースゲーム

## 题目描述

![](https://cdn.luogu.org/upload/pic/36289.png)


高桥正在尝试玩赛车游戏。 比赛从 $(x,y)=(start,0)$ 处开始，向 $(x,y)=(goal,N)$ 处的目标前进。

对于 $0 \le y \le n$，我们给出了路径的左端和右端，这条路径就是依次连接这些区间两端的直线的内侧。

![](https://atcoder.jp/img/arc/001/4_1.png)

上图为输入 1 示例。红圈为起点，蓝圈为终点， 棕色区域为赛道。

赛车不能在赛道以外的任何地方行驶。此外，汽车能够在瞬间改变方向，而且汽车的宽度和长度必须可以忽略不计。

高桥希望找到从起点到目标的最短路径，从而征服这款赛车游戏。

## 输入格式

第一行是比赛的总长度 $N$。

第二行给出赛道起点和终点的坐标，中间用空格隔开。

从第 $3$ 行到 $N+2$ 行的每一行中，第 $i+3$ 行给出了 $y=i$ 的最左边 $l_i$ 和最右边 $r_i$，中间用空格隔开。

## 输出格式

一行输出比赛的最短路径。

请注意，输出结果的绝对误差或相对误差不能大于 $1e-9$。

### 样例 1 解释

以红色圆圈为起点，蓝色圆圈为终点，最短路线为下图中的红线。

![](https://atcoder.jp/img/arc/001/4_2.png)

## 说明/提示

- N 为整数，满足 $1 \le N \le 200,000$。

- $l_i$ 和 $r_i$ 为整数，满足 $0 \le li < ri \le 1,000,000$。

- $start$ 是整数，满足 $l_0 \le start \le r_0$。

- $goal$ 是整数，且满足 $l_N \le goal \le r_N$。

## 样例 #1

### 输入

```
7
3 3
2 5
4 6
2 3
3 6
3 4
4 6
2 5
1 5

```

### 输出

```
8.22677276241436

```

## 样例 #2

### 输入

```
5
3 3
0 5
0 5
0 5
0 5
0 5
0 5

```

### 输出

```
5

```



---

---
title: "[ARC004D] 表現の自由 ( Freedom of expression )"
layout: "post"
diff: 提高+/省选-
pid: AT_arc004_4
tag: []
---

# [ARC004D] 表現の自由 ( Freedom of expression )

## 题目描述

[problemUrl]: https://atcoder.jp/contests/arc004/tasks/arc004_4

整数 $ N $ と $ M $ が与えられる時、整数 $ N $ を $ M $ 個の整数の積で表す方法は何通りあるでしょうか。  
 その答えを $ 1,000,000,007 $ で割った余りを答えてください。 入力は以下の形式で標準入力から与えられる。

> $ N $ $ M $

- 入力は $ 1 $ 行のみからなり、整数 $ N(1\ ≦\ |N|\ ≦\ 10^9) $ と整数 $ M(1\ ≦\ M\ ≦\ 10^5) $ が空白区切りで与えられる。
 
 整数 $ N $ を $ M $ 個の整数の積で表す方法の数を $ 1,000,000,007 $ で割った余りを標準出力に $ 1 $ 行で出力せよ 。  
 なお、最後には改行を出力せよ。 ```
<pre class="prettyprint linenums">
10 2
```

 ```
<pre class="prettyprint linenums">
8
```

- $ 10 $ を $ 2 $ つの整数の積で表す方法は以下の $ 8 $ 通りになります。
- $ 1\ \times\ 10 $
- $ 2\ \times\ 5 $
- $ 5\ \times\ 2 $
- $ 10\ \times\ 1 $
- $ (-1)\ \times\ (-10) $
- $ (-2)\ \times\ (-5) $
- $ (-5)\ \times\ (-2) $
- $ (-10)\ \times\ (-1) $
 

```
<pre class="prettyprint linenums">
1000000000 1
```

 ```
<pre class="prettyprint linenums">
1
```

- $ 1,000,000,000 $ を $ 1 $ つの積で書き表すには $ 1,000,000,000 $ と書くしか無いので、$ 1 $ 通りになります。

```
<pre class="prettyprint linenums">
-2 3
```

 ```
<pre class="prettyprint linenums">
12
```

- $ -2 $ を $ 3 $ つの整数の積で表す方法は以下の $ 12 $ 通りになります。
- $ 1\ \times\ 1\ \times\ (-2) $
- $ 1\ \times\ 2\ \times\ (-1) $
- $ 1\ \times\ (-1)\ \times\ 2 $
- $ 1\ \times\ (-2)\ \times\ 1 $
- $ 2\ \times\ 1\ \times\ (-1) $
- $ 2\ \times\ (-1)\ \times\ 1 $
- $ (-1)\ \times\ 1\ \times\ 2 $
- $ (-1)\ \times\ 2\ \times\ 1 $
- $ (-1)\ \times\ (-1)\ \times\ (-2) $
- $ (-1)\ \times\ (-2)\ \times\ (-1) $
- $ (-2)\ \times\ 1\ \times\ 1 $
- $ (-2)\ \times\ (-1)\ \times\ (-1) $
 

```
<pre class="prettyprint linenums">
50 1000
```

 ```
<pre class="prettyprint linenums">
96554651
```



---

---
title: "[ARC005C] 器物損壊！高橋君"
layout: "post"
diff: 提高+/省选-
pid: AT_arc005_3
tag: []
---

# [ARC005C] 器物損壊！高橋君

## 题目描述

[problemUrl]: https://atcoder.jp/contests/arc005/tasks/arc005_3

 良く見てみるとカードの有効期限が切れていたので、高橋君は諦めて魚屋に直接うなぎを買いに行くことにしました。  
 彼の住む街は長方形の形をしており、格子状の区画に区切られています。区画は道または塀のどちらかであり、高橋君は道を東西南北に移動できますが斜めには移動できません。また、塀の区画は通ることができません。高橋君の家から魚屋までの道のりは非常に複雑なため、単純に歩くだけでは辿り着くことは困難です。  
 しかし、高橋君は腕力には自信があるので道に上下左右で面している塀を $ 2 $ 回までなら壊して道にすることができます。  

 高橋君が魚屋に辿り着くことができるかどうか答えてください。 入力は以下の形式で標準入力から与えられる。

> $ H $ $ W $ $ c_{(0,0)}c_{(0,1)} $ … $ c_{(0,W-1)} $ $ c_{(1,0)}c_{(1,1)} $ … $ c_{(1,W-1)} $ : : $ c_{(H-1,0)}c_{(H-1,1)} $ … $ c_{(H-1,W-1)} $

- 入力は $ H+1 $ 行ある。
- $ 1 $ 行目は、街の南北の長さとして整数 $ H(1≦H≦500) $ と東西の長さとして整数 $ W(1≦W≦500) $ が空白で区切られて与えられる。
- $ 2 $ 行目からの $ H $ 行には、格子状の街の各区画における状態 $ c_{(i,j)}(0≦i≦H-1, $ $ 0≦j≦W-1) $ が与えられる。
- $ i $ 行目 $ j $ 文字目の文字 $ c_{(i,j)} $ はそれぞれ `s`, `g`, `.`, `#` のいずれかで与えられ、座標 $ (j,i) $ が下記のような状態であることを表す。
- `s` : その区画が家であることを表す。
- `g` : その区画が魚屋であることを表す。
- `.` : その区画が道であることを表す。
- `#` : その区画が塀であることを表す。

- 高橋君は家?魚屋?道は通ることができるが、塀は通ることができない。
- 与えられた街の外を通ることはできない。
- `s` と `g` はそれぞれ $ 1 $ つずつ与えられる。

 塀を $ 2 $ 回まで越えることで、家から魚屋まで辿り着くことができる場合は `YES`、辿りつけない場合は `NO` を標準出力に $ 1 $ 行で出力せよ。  
 なお、最後には改行を出力せよ。 

```
4 5
s####
....#
#####
#...g
```

```
YES
```

- $ (1,2), $ $ (2,2), $ $ (3,2) $ のいずれかの塀を壊すことで、魚屋に到達することができます。 

```
4 4
...s
....
....
.g..
```

 ```
YES
 ```

- 塀が無いので到達することができます。


```
10 10
s.........
#########.
#.......#.
#..####.#.
##....#.#.
#####.#.#.
g##.#.#.#.
###.#.#.#.
###.#.#.#.
#.....#...
```

```
YES
```

- $ (1,6), $ $ (2,6) $ の $ 2 $ つの塀を壊すことで到達することができます。


```
6 6
.....s
###...
###...
######
...###
g.####
```

 ```
YES
 ```

- 一例として $ (3,3) $, $ (2,3), $ の $ 2 $ つの塀を壊すと、到達することができます。

```
1 10
s..####..g
```

 ```
NO
 ```

- 塀を $ 2 $ つ壊しても魚屋に到達することができません。



---

---
title: "[ARC005D] 連射王高橋君"
layout: "post"
diff: 提高+/省选-
pid: AT_arc005_4
tag: []
---

# [ARC005D] 連射王高橋君

## 题目描述

终于到达鱼屋的高桥君没带多少钱，这样就有些东西不能买，决定向店主询问价格。但店主年老，听力不好，听不见高桥君的声音。没有办法的高桥君决定使用旁边的计算器，把价格打在上面。

但令人困扰的事情是，高桥君不小心把计算器摔了，一些按键摔坏了。计算器有0-9、+和=共12个按键，0、1、+、=四个按键是不会坏的，其余的按键都有坏掉的可能性。

例如，0、1、2、+、=没坏的时候，向店主传达11的方法有以下几种：

1+1+1+1+1+1+1+1+1+1+1=

2+2+2+2+2+1=

11

1+2+1+2+1+1+1+2=

10+1=

+和=有以下的用法：

+只能用于数字之间。

在使用了+的时候，最后需要用=，没有使用+的话不需要使用=。

另外，由于这个鱼屋的店主脾气不大好，需要尽快的打出来避免他生气。所以需要按按钮的次数尽可能的少。之前举例的情况，只按两次按钮的11的时候，按按钮的次数是最少的。

需要在按按钮次数最少的情况下，利用计算器上没有坏的按钮表示出价格。不论输出结果的顺序（若1+2=是正确的，2+1=也是正确的）。

## 输入格式

输入数据为两行

第一行有N(2<=N<=10)个0-9的整数，是可以使用的数字键

	必定包含0、1；按照从小到大的顺序排列；+和=不列出，总可以使用。

第二行是需要表示的整数price(1<=price<=10^18)

	建议使用64bit整形

## 输出格式

输出依次需要按下的按钮，最后输出换行



---

---
title: "[ARC007D] 破れた宿題"
layout: "post"
diff: 提高+/省选-
pid: AT_arc007_4
tag: []
---

# [ARC007D] 破れた宿題

## 题目描述

[problemUrl]: https://atcoder.jp/contests/arc007/tasks/arc007_4

 高橋君は数学の宿題で出された、等差数列の初項と公差を答える問題を解いています。  
 隣接する $ 2 $ つの数字間の差が定数である数字の連続のことを等差数列といい、最初の数字を初項、定数である数字間の差を公差、最後の数字を末項と呼びます。  
 ただ高橋君はうっかり宿題の数列を空白やカンマで区切ることなく $ 0 $から $ 9 $ の数字で構成された $ 1 $ つの文字列としてノートに写しとってしまいました。  
 さらにそのノートの扱いが雑だったので、ノートの一部を破って切り離してしまいました。  
 破れて切り離されてしまったのは初項と末項の部分だけで、少なくとも初項の一部分が残っているのを確認しました。  
 そのような文字列が与えられるので、元の数列を推測してその初項と公差を答えなさい。  
  
 なお、初項と公差は $ 1 $ 以上の整数であり、解が複数ある場合は初項が最も小さいものを答え、初項が等しい解が複数ある場合は公差が最も小さいものを答えなさい。  
 また、$ 003 $ や $ 012 $ のように不必要な $ 0 $ が前に付属している数字は写しとった数列には含まれていませんでした。 入力は以下の形式で標準入力から与えられる。

> $ c_{0} $$ c_{1} $‥‥$ c_{N-1} $

- 入力は $ 1 $ 行のみで等差数列の一部である長さ $ N $ の文字列が与えられる。
- 文字列は `0-9` から成り立っている。
 
 テストデータには以下の $ 4 $ 種類のテストデータセットのいずれかに含まれており、それぞれのデータセットに含まれているテストデータは以下に示すように与えられる文字列 $ N $ の範囲が異なっている。  
 あるテストデータセットに含まれているテストデータ全てに対して正しい解を出力できると、それ以外のテストデータセットで不正解を出力しても以下のように部分点が与えられる。  
- level1 ( $ 25 $ 点) : $ 1≦N≦4 $
- level2 ( $ 25 $ 点) : $ 1≦N≦6 $
- level3 ( $ 25 $ 点) : $ 1≦N≦200 $
- level4 ( $ 25 $ 点) : $ 1≦N≦1,000 $
 
 初項と末項の一部が切り離されている可能性のある等差数列に対して考えうる初項と公差を空白区切りで標準出力に $ 1 $ 行で出力せよ。  
 解が複数ある場合は初項が最も小さいものを答え、初項が等しい解が複数ある場合は公差が最も小さいものを出力せよ。  
 なお、最後には改行を出力せよ。 ```

1
```

 ```

1 1
```

- 前後に文字が続く $ 1 $ つの数字の可能性もありますが、最も小さい初項は数字が切り離されていない場合の $ 1 $ です。
- 公差も任意の正の整数が考えられますが、最も小さい公差は $ 1 $ です。
 
```

0203
```

 ```

10 10
```

- $ 02 $ は数字として認められないので $ 2 $ は初項ではありません。
- 初項の $ 10 $ の $ 1 $ が切り離されており、末項として $ 30 $ の $ 0 $ が切り離された数列であり、元の数列は `102030`です。
 
```

456789101112131415
```

 ```

4 1
```

- 数列のどこも欠けていない初項 $ 4 $、公差 $ 1 $ の等差数列です。
 
```

579111315171921232
```

 ```

5 2
```

- 末項の $ 25 $ の $ 5 $ の部分が欠けている等差数列です。
 
```

001131261391521651
```

 ```

100 13
```

- 初項の $ 100 $ と末項の $ 178 $ の一部が欠けています。



---

---
title: "[ARC008D] タコヤキオイシクナール"
layout: "post"
diff: 提高+/省选-
pid: AT_arc008_4
tag: []
---

# [ARC008D] タコヤキオイシクナール

## 题目描述

在章鱼烧店因试吃活动而获成功后，兴奋的高桥社长决定将业务扩展至全国，并计划在工厂中批量生产冷冻章鱼烧。为此，他购置了一台机器，名为“Takoyaki Oishikunar”。这台设备由 $N$ 个盒子连成通道状结构，每个盒子通过传送带首尾相连。第 $i$ 个盒子的出口直通第 $i+1$ 个盒子的入口。

每个盒子标有一对实数 $(a, b)$，当一个美味度为 $r$ 的章鱼烧通过时，其美味度将变为 $a \times r + b$。例如，若美味度为 $1$ 的章鱼烧经过一个标有 $(2, 1)$ 的盒子，美味度将变为 $3$，然后继续通过一个标有 $(-1, 2)$ 的盒子，最终美味度将为 $-1$。

起初，每个盒子上的数字均为 $(1, 0)$，因此章鱼烧经过所有盒子后美味度并不会改变。你决定依次将美味度为 $1$ 的章鱼烧投入机器中。然而，高桥社长在 $M$ 次实验中改动了盒子上的数字。请你计算出最终制成的章鱼烧的美味度可能的最小值和最大值。

注意，“Takoyaki Oishikunar”一次只能处理一个章鱼烧，并在加工期间盒子上的数值不会被改变。高桥社长可以在当前章鱼烧加工结束和下一个章鱼烧开始加工之间，选择性地修改一个盒子的参数。

### 输入格式
```
N M
p_0 a_0 b_0
p_1 a_1 b_1
...
p_{M-1} a_{M-1} b_{M-1}
```

- 第一行有两个正整数 $N$ 和 $M$，分别表示盒子的数量和高桥社长修改盒子数字的次数。
- 接下来的 $M$ 行，每行有三个数：盒子编号 $p_i\ (1 \le p_i \le N)$、修改后的数值 $a_i\ (-1 \le a_i \le 1)$ 和 $b_i\ (-1 \le b_i \le 1)$。

### 输出格式

输出两行，每行一个实数：
- 第一行输出最终制成的章鱼烧的美味度的最小值。
- 第二行输出其最大值。

### 数据范围与提示

- 对于 small 数据集：$1 \le N \le 1,000$，$0 \le M \le 1,000$
- 对于 large 数据集：$1 \le N \le 10^{12}$，$0 \le M \le 100,000$
- 输出允许绝对误差或相对误差小于等于 $10^{-6}$。

 **本翻译由 AI 自动生成**



---

---
title: "[ARC009C] 高橋君、24歳"
layout: "post"
diff: 提高+/省选-
pid: AT_arc009_3
tag: []
---

# [ARC009C] 高橋君、24歳

## 题目描述

高桥君，24岁，是个学生(esu梗)，过生日辣OwO!  

他要给他的$N$个朋友们发请帖，但是手贱发错了$K$个人的请帖QAQ.  

他现在十分橘促，问他的朋友们拿到的请帖组合一共有多少种可能。

## 输入格式

一行，输入$N$，$K$。

## 输出格式

一行，输出答案数mod$1,777,777,777$的值。

## 说明/提示

$2≦N≦777,777,777,777,777,777$

$2≦K≦777,777$



---

---
title: "[ARC010C] 積み上げパズル"
layout: "post"
diff: 提高+/省选-
pid: AT_arc010_3
tag: []
---

# [ARC010C] 積み上げパズル

## 题目描述

[problemUrl]: https://atcoder.jp/contests/arc010/tasks/arc010_3

高橋君はある日、以下のようなゲームで遊ぶことにしました。  
 $ m $ 色のブロックが $ n $ 個、$ 1 $ つずつ順番に落ちてきます。  
 $ 1 $ つ落ちてくるたびに、高橋君は落ちてきたそのブロックを取って山に積むか、積まずに捨てるか選べます。  
 ブロックを積む山は $ 1 $ つで、ブロックは必ず山の一番上に積まないといけません。  
 全てのブロックが落ちきった後、出来た山は以下のように評価されます。

- 色ボーナス：色ごとに決められた得点が、山に含まれている個数分与えられます。
- コンボボーナス：同じ色のブロックが $ x $ 個続いて積まれている場合、コンボボーナス配点 $ Y $ に応じて $ Y×(x-1) $ 点が与えられます。
- 全色ボーナス：山の中に $ m $ 色のブロックがそれぞれ $ 1 $ 個以上含まれていると $ Z $ 点が与えられます。
 
 落ちてくるブロックの種類と順番、またそれぞれ山を評価するための配点が与えられたとき、評価で得ることのできる最高得点を求めなさい。 入力は以下の形式で標準入力から与えられる。 > $ n $ $ m $ $ Y $ $ Z $ $ c_1 $ $ p_1 $ $ c_2 $ $ p_2 $ $ : $ $ : $ $ c_m $ $ p_m $ $ b_1b_2\ ‥‥\ b_n $

- $ 1 $ 行目に $ n,\ m,\ Y,\ Z $ が半角スペースで区切られて与えられる。 
  1. $ n $ はブロックの個数で $ 1≦n≦5,000 $ を満たす。
  2. $ m $ はブロックの色の総数で $ 1≦m≦10 $ を満たす。
  3. $ Y $ はコンボボーナス配点で $ -100≦Y≦100 $ を満たす。
  4. $ Z $ は全色ボーナス配点で $ -10,000≦Z≦10,000 $ を満たす。
  5. $ n,\ m,\ Y,\ Z $ は全て整数である。
- $ 2 $ 行目からの $ m+1 $ 行目までの $ m $ 行で色ボーナスの配点がそれぞれ与えられる。 
  1. $ c_i $ は $ i(1≦i≦m) $ 番目に与えられるブロックの色である。
  2. $ p_i $ は $ c_i $ に対する色ボーナスの配点である。
  3. $ c_i $ は英大文字(`A`-`Z`)、$ p_i $ は $ -100≦p_i≦100 $ を満たす。
  4. 配点は重複して与えられない（$ x≠y $ ならば $ c_x≠c_y $)
- $ m+2 $ 行目には落ちてくるブロックの順序を表す長さ $ n $ の文字列が与えられる。 
  1. $ b_j $ は $ j(1≦j≦n) $ 番目に落ちてくるブロックの色を表している。
  2. $ b_j $ は $ c_1,c_2,...,c_m $ のいずれかである。
 
 評価で得ることのできる得点の最大値を標準出力に $ 1 $ 行で出力せよ。  
 なお、最後には改行を出力せよ。 ```

5 3 3 5
R 1
G 1
B 1
RGBRR
```

 ```

13
```

- 全てのブロックを山に積むと、 
  - 色ボーナス：どの色も配点が $ 1 $ 点なので、$ 1 $ 点 × $ 5 $ 個 $ =\ 5 $点
  - コンボボ−ナス：Rが $ 2 $ 個連続しているので、$ 3×(2-1)=3 $ 点
  - 全色ボーナス：全ての色が $ 1 $ つ以上山に積まれているので、$ 5 $ 点
   
   により、$ 5+3+5=13 $ 点が与えられます。
- いずれかのブロックを捨てるとこの点数よりも低くなるので、答えは $ 13 $ 点です。
 
```

3 3 3 5
R 1
G 3
B 2
RBR
```

 ```

5
```

- 全てのブロックを山に積むと、 
  - 色ボーナス：$ 1 $ 点 $ ×2 $ 個 $ +2 $ 点 $ ×1 $ 個 $ =4 $ 点
  - 連続していないのでコンボボーナス、Gが含まれていないので全色ボーナスはそれぞれ $ 0 $ 点
   
   により、$ 4 $ 点です。
- しかし、Bを捨ててRRを山に積むと、 
  - 色ボーナス：$ 1 $ 点 $ ×2 $ 個 $ =2 $ 点
  - コンボボーナス：$ 3×(2-1)=3 $ 点
   
   で、$ 5 $ 点が最高得点です。
 
```

8 3 5 3
R 1
G 1
B 1
RRGRRBRR
```

 ```

31
```

- 図 $ (a) $ のように順に $ 8 $ 個のブロックが落ちてきます。
- ブロックを全部山に積むと、図 $ (b) $ のように、$ 2 $ 個のコンボが $ 3 $ 組できます。
- また、全色ボーナスもつくので、$ 1 $ 点 × $ 8 $ 個 + $ 5 $ 点 $ ×\ (2-1)\ ×\ 3 $ 組 $ +\ 3 $ 点 $ =\ 26 $ 点です。
- しかし、図 $ (c) $ のようにRのみを山に積むと、$ 1 $ 点 × $ 6 $ 個 + $ 5 $ 点 $ ×\ (6-1)\ +\ 0 $ 点 $ =\ 31 $ 点になります。
- Rだけ山に積むとき最高得点となり、$ 31 $ が答えです。
 
![](https://cdn.luogu.com.cn/upload/vjudge_pic/AT_arc010_3/0bee256b459d39c38c7b58d68d6189c67aa5bbed.png)```

8 3 5 3
R 1
G 100
B 1
RRGRRBRR
```

 ```

126
```

- 全部積んだ場合(図 $ (a) $)：$ 107 $ 点 + $ 5 $ 点 $ ×\ (2-1)\ ×\ 3 $ 組 $ +\ 3 $ 点 $ =\ 125 $ 点
- Rのみを積んだ場合(図 $ (b) $)：$ 6 $ 点 + $ 5 $ 点 $ ×\ (6-1)\ +\ 0 $ 点 $ =\ 31 $ 点
- B以外を積んだ場合(図 $ (c) $)：$ 106 $ 点 + $ 5 $ 点 $ ×\ \{(2-1)\ +\ (4-1)\}\ +\ 0 $ 点 $ =\ 126 $ 点
- したがって、最高得点は $ 126 $ 点です。

![](https://cdn.luogu.com.cn/upload/vjudge_pic/AT_arc010_3/6cccf310c6e56c5cd110ae0c64aa6d53ab92ea51.png)



---

---
title: "[ARC010D] 情報伝播"
layout: "post"
diff: 提高+/省选-
pid: AT_arc010_4
tag: []
---

# [ARC010D] 情報伝播

## 题目描述

[problemUrl]: https://atcoder.jp/contests/arc010/tasks/arc010_4

$ AtCoder $ 国の秘密情報部に就職した青木くんは諜報活動に勤しむ青年です。  
  
 今回、青木くんに与えられたミッションは以下の様なものです。

- 青木くんは $ 2 $ 次元座標上に散らばる全ての仲間に $ AtCoder $ 国の機密情報を伝えなければならない。
- ただし、その $ 2 $ 次元座標上には仲間だけでなく、敵国のスパイが紛れ込んでいる。
- 青木くんが仲間に機密情報を伝えると、情報を受け取った仲間はスピーカーで情報を拡散する（機密情報だというのに！）
- スピーカーで情報を拡散するとは、自分を中心とする同心円状内（スピーカーの音量は調節できるので、半径は任意である）にいる全ての「人間」に情報を伝えることである。
- 情報を受け取った仲間もスピーカーで情報を拡散し、連鎖的に情報を伝えていく。
- 当然のことながらスパイに機密情報が伝わってはいけない。
 
  
 このミッションを達成するために、青木くんは全ての仲間の場所に赴いて 1. 機密情報を伝える
2. 持っているスピーカーを叩き潰す
3. 「機密情報を漏らすな」と念を押す
 
  
 この $ 3 $ つを行えば良いのですが、残念ながら全ての仲間の場所へ赴くような時間はありません。  
  
 そこで、青木くんは仲間がスピーカーで情報を拡散してしまう性質を利用して、効率良く機密情報を伝えてもらうことにしました。  
 スパイに機密情報が漏れることなく、全ての仲間に機密情報を伝えるとき、青木くんが機密情報を伝えなければならない仲間の最小の人数はいくらでしょうか。  
 入力は以下の形式で標準入力から与えられる。 > $ N $ $ f_{x1} $ $ f_{y1} $ $ f_{x2} $ $ f_{y2} $ $ : $ $ : $ $ f_{xN} $ $ f_{yN} $ $ M $ $ s_{x1} $ $ s_{y1} $ $ s_{x2} $ $ s_{y2} $ $ : $ $ : $ $ s_{xM} $ $ s_{yM} $

- $ 1 $ 行目には仲間の数を表す整数 $ N $ が与えられ、 $ 1≦N≦5,000 $ を満たす。
- $ 2 $ 行目から $ N+1 $ 行目までの $ N $ 行で仲間の位置情報が与えられる。

1. $ f_{xi} $ は $ i $ 番目に与えられる仲間の $ X $ 座標である。
2. $ f_{yi} $ は $ i $ 番目に与えられる仲間の $ Y $ 座標である。
3. $ i $ は $ 1≦i≦N $ を満たし、 $ f_{xi} $ と $ f_{yi} $ はそれぞれ $ -10^9≦f_{xi} $ $ , $ $ f_{yi}≦10^9 $ を満たす整数である。

12. $ N+2 $ 行目にはスパイの数を表す整数 $ M $ が与えられ、 $ 0≦M≦100,000 $ を満たす。
13. $ N+2 $ 行目から $ N+M+2 $ 行目までの $ M $ 行でスパイの位置情報が与えられる。
1. $ s_{xj} $ は $ j $ 番目に与えられるスパイの $ X $ 座標である。
2. $ s_{yj} $ は $ j $ 番目に与えられるスパイの $ Y $ 座標である。
3. $ j $ は $ 1≦j≦M $ を満たし、 $ s_{xj} $ と $ s_{yj} $ はそれぞれ $ -10^9≦s_{xj} $ $ , $ $ s_{yj}≦10^9 $ を満たす整数である。

15. 同じ座標に複数の人間が重なることはない。
16. $ M\ >\ 1,000 $ のとき、スパイはランダムに分布することが保証される。
- $ 0≦N≦10 $ を満たす入力にのみ正解した場合、部分点として $ 10 $ 点が与えられる。
- $ 0≦N≦30 $ を満たす入力にのみ正解した場合、部分点として $ 50 $ 点が与えられる。
 
 情報を伝える必要がある最小の人数を出力せよ。  
 出力は標準出力におこない、末尾には改行をいれること。  
```

3
1 1
1 2
2 1
0
```

 ```

1
```

- 座標 $ (1,\ 1) $ にいる仲間に伝えることができれば、 $ 3 $ 人の仲間全員に伝えることができます。
 
![](https://cdn.luogu.com.cn/upload/vjudge_pic/AT_arc010_4/0ef0ba79f820925d8ec9d57de865cfb4af9694c6.png)```

2
1 1
1 2
1
2 1
```

 ```

1
```

- 座標 $ (1,\ 2) $ にいる仲間に伝えることができれば、 $ 2 $ 人の仲間全員に伝えることができます。
- 座標 $ (1,\ 1) $ にいる仲間から 座標 $ (1,\ 2) $ にいる仲間に伝えようとすると、必ずスパイに見つかってしまいます。
 
![](https://cdn.luogu.com.cn/upload/vjudge_pic/AT_arc010_4/99e73387c2231ae83ab67e4ed5a7cecbda5175fc.png)```

5
1 1
1 2
2 3
3 3
5 3
2
2 1
4 4
```

 ```

2
```

- 座標 $ (2,\ 3) $ にいる仲間に伝えることができれば、座標 $ (1,\ 2) $ にいる仲間と、座標 $ (3,\ 3) $ にいる仲間へ情報を伝えることができます。
- その後、座標 $ (1,\ 2) $ にいる仲間から座標 $ (1,\ 1) $ にいる仲間へ情報が伝搬されます。
- 座標 $ (5,\ 3) $ にいる仲間へは、別途情報を伝える必要があります。
 
![](https://cdn.luogu.com.cn/upload/vjudge_pic/AT_arc010_4/20ae14e99ef31ba084ae4e11250af5205d3790aa.png)```

10
-10 5
2 9
-4 4
10 -9
8 3
5 6
4 -5
6 8
-8 10
-4 -2
10
-1 2
-2 -7
9 -3
-5 5
6 -10
-10 9
7 4
2 1
-10 1
-5 2
```

 ```

8
```



---

---
title: "[ARC013D] 切り分けできるかな？"
layout: "post"
diff: 提高+/省选-
pid: AT_arc013_4
tag: []
---

# [ARC013D] 切り分けできるかな？

## 题目描述

高桥君在路边捡到了一块铁块，他计划将其切割成各种砝码。这种铁块十分特别，每 $1 \text{cm}^3$ 重 $1\text{g}$。为了与朋友青木君共享，他希望能制作出多种类的砝码。然而，由于手艺不够精湛，每块铁块只能切一次。以下是切割规则：

- 切割后铁块的每一边都必须是整数。
- 只能从三个垂直于边的方向水平切割，不可以斜切。
- 每个铁块只能被切一次，不可再对新形成的小铁块进行二次切割。

已知铁块的种类和尺寸，问高桥君和青木君各自制作一系列不同重量的砝码所需的铁块数是多少。输入格式如下：

> $N$  
> $X_1$ $Y_1$ $Z_1$  
> $X_2$ $Y_2$ $Z_2$  
> ...  
> $X_N$ $Y_N$ $Z_N$

其中，第一行的整数 $N (1 \leq N \leq 100)$ 表示铁块的种类数。随后的 $N$ 行，每行三个整数 $X_i, Y_i, Z_i (1 \leq X_i, Y_i, Z_i \leq 20)$，分别代表第 $i$ 个铁块的长、宽和高。

若只对 $N = 1$ 的情况做出正确解答，可得部分分数（20 分）。

### 示例输入与输出

- 输入：
  ```
  2
  3 4 5
  2 3 4
  ```

- 输出：
  ```
  13
  ```

从尺寸为 $3 \times 4 \times 5$ 的铁块中，可以通过在不同面进行水平切割得到重量不同的砝码：
- 在 $3 \times 4$ 的面上切割，得到 12, 24, 36, 48；
- 在 $3 \times 5$ 的面上切割，得到 15, 30, 45；
- 在 $4 \times 5$ 的面上切割，得到 20, 40；

此铁块可形成 9 种不同的砝码。

从尺寸为 $2 \times 3 \times 4$ 的铁块中，可以得到：
- 在 $2 \times 3$ 的面上切割，得到 6, 12, 18；
- 在 $2 \times 4$ 的面上切割，得到 8, 16；
- 在 $3 \times 4$ 的面上切割，得到 12；

此铁块可形成 5 种不同的砝码。

两组砝码合在一起，共有 13 种不同重量。为了保证高桥君和青木君各自都拥有一套完整的砝码，共需要 13 个铁块。

### 输入格式

第一行输入一个整数 $N (1 \leq N \leq 100)$，代表铁块的种类数。接下来 $N$ 行，每行包含三个整数 $X_i, Y_i, Z_i (1 \leq X_i, Y_i, Z_i \leq 20)$，表示第 $i$ 个铁块的长、宽和高。

### 输出格式

输出一个整数，表示制作完整套砝码所需铁块的最小数目。输出末尾需换行。

 **本翻译由 AI 自动生成**



---

---
title: "[ARC015C] 変わった単位"
layout: "post"
diff: 提高+/省选-
pid: AT_arc015_3
tag: []
---

# [ARC015C] 変わった単位

## 题目描述

[problemUrl]: https://atcoder.jp/contests/arc015/tasks/arc015_3

多くの単位は $ 10 $ とその累乗数を元に作られています。ですが、この世の単位にはそうでないものがあります。  
 有名なものとしては時間に関する単位です。$ 1 $ 分は $ 60 $ 秒、$ 1 $ 時間は $ 60 $ 分、$ 1 $ 日は $ 24 $時間、などです。  
  
 いま、あなたに単位の換算表が与えられます。この換算表を元に、「最も大きい単位」を「最も小さい単位」で表したとき、  
 どのように表せるかを出力するプログラムを書いてください。例えば、

- $ 1week $ $ = $ $ 7day $
- $ 1day $ $ = $ $ 24hour $
- $ 1hour $ $ = $ $ 60min $
- $ 1min $ $ = $ $ 60sec $
 
 と換算表が与えられたとき、$ 1week $ $ = $ $ 604800sec $ と出力してください。 入力は以下の形式で標準入力から与えられる。 > $ N $ $ large_1 $ $ m_1 $ $ small_1 $ $ large_2 $ $ m_2 $ $ small_2 $ : $ large_{N} $ $ m_N $ $ small_{N} $

1. $ 1 $ 行目は、換算表の行数を表す整数 $ N\ (1≦N≦200) $ が $ 1 $ 行で与えられる。
2. $ 2 $ 行目から、$ N+1 $ 行目までの $ N $ 行で、換算表が与えられる。

- $ i\ (1≦i≦N) $ 行目において、単位 $ large_i $、係数$ m_i $、単位$ small_i $ が半角空白区切りで与えられる。
- $ i\ (1≦i≦N) $ 行目において、$ 1*large_i $ $ = $ $ m_i*small_i $ が成立する。
- 単位名 $ large_i $ と $ small_i $ はいずれも $ 10 $ 文字以下の半角英小文字から構成される。

7. $ 1 $ 番大きい単位を $ 1 $ 番小さい単位で表したとき、係数 $ M $ は $ 10^9 $ を超えない整数である。
8. 換算表に記載される単位は、必ず別の大きさを持つことが保証されている。つまり、同じ大きさで別名の単位は存在しない。
9. 換算表に記載される単位から、必ず最大・最小の単位を特定できることが保証されている。
10. 換算表に記載される単位は順不同であり、必ずしも大きな単位から順に記載されているとは限らない。
- また、$ i $ 行目の入力が隣接する単位との関係を示すとは限らない。
- 例えば、hour &gt; min &gt; sec という順序関係があるとき、 hour 3600 sec といった入力もありうる。
- ただし、換算表には矛盾するような記載はない。
 
 最大の単位を $ a $、最小の単位を $ b $ としたとき、係数 $ M $ を用いて $ 1a $$ = $$ Mb $ の形式で出力せよ。  
 なお、出力の最後には改行をいれること。 ```
<pre class="prettyprint linenums">
4
week 7 day
day 24 hour
hour 60 min
min 60 sec
```

 ```
<pre class="prettyprint linenums">
1week=604800sec
```

- $ 1week $ $ = $ $ 7*24*60*60sec $ $ = $ $ 604800sec $
 
```
<pre class="prettyprint linenums">
3
sic 29 cou
gal 493 cou
gal 17 sic
```

 ```
<pre class="prettyprint linenums">
1gal=493cou
```

- $ 1gal $ $ = $ $ 17*29cou $ $ = $ $ 493cou $
- $ 2 $ 行目に、$ 1gal $ $ = $ $ 493cou $ が与えられていて、実は演算の必要がないです。
- $ 2 $ 行目は、入力セクションの $ 6 $ で記述したように、隣接する単位との関係を示したものではありません。
 
```
<pre class="prettyprint linenums">
5
chou 360 shaku
jou 100 sun
ken 60 sun
li 2160 ken
li 12960 shaku
```

 ```
<pre class="prettyprint linenums">
1li=129600sun
```

- $ 1li $ $ = $ $ 2160*60sun $ $ = $ $ 129600sun $
- $ 1 $ 行目、$ 2 $ 行目、$ 5 $ 行目のように、演算に不要な入力が与えられることもあります。



---

---
title: "[ARC016C] ソーシャルゲーム"
layout: "post"
diff: 提高+/省选-
pid: AT_arc016_3
tag: []
---

# [ARC016C] ソーシャルゲーム

## 题目描述

高桥君非常喜欢玩偶像收集卡牌游戏。  
在这个游戏中，通过支付一定金额进行抽奖，你可以根据某种概率分布来获得一名偶像。  
高桥君的目标是收集到所有的偶像。  
游戏中有 $M$ 种不同的抽奖方式，每种方式中的偶像出现概率和抽奖费用都不相同。  
请你计算出高桥君要想获得所有偶像所需要的最小期望花费。输入如下格式：

> $N$ $M$ $C_1$ $cost_1$ $idol_{1,1}$ $p_{1,1}$ $idol_{1,2}$ $p_{1,2}$ : $idol_{1,C_1}$ $p_{1,C_1}$ : $C_M$ $cost_M$ $idol_{M,1}$ $p_{M,1}$ $idol_{M,2}$ $p_{M,2}$ : $idol_{M,C_M}$ $p_{M,C_M}$

1. 第一行包含两个整数——$N (1 \le N \le 10)$和$M (1 \le M \le 4)$，分别表示偶像的总数和抽奖方式的数量。

2. 接下来的 $M$ 行每行描述一种抽奖方式的信息。

- 整数 $C_i$ 表示第 $i$ 种抽奖方式中偶像的数量。
- 整数 $cost_i$ 表示进行第 $i$ 种抽奖的费用。

5. 接下来，每个偶像信息包含两个整数 $(idol_{i,j}, p_{i,j})$，分别表示第 $i$ 种抽奖方式中第 $j$ 个偶像的编号以及出现的概率（百分比形式）。
- 每种抽奖方式中所有偶像的出现概率之和为 $100$。

请输出高桥君采用最优策略时，收集全部偶像所需的最小期望花费。结果的绝对误差或相对误差需小于 $10^{-6}$，结果最后附加换行。如你无从确定最佳策略，可尝试代码以获取部分分。

### 示例输入与输出
以下为几个例子以帮助理解这一任务：

```
输入：
5 2
2 300
3 5
4 95
3 500
5 20
1 30
2 50

输出：
9343.17042606516
```

在此例中，有 $5$ 种偶像和 $2$ 种抽奖方式。进行第 $1$ 种抽奖方式所需的期望费用为 $6015.789473684$，进行第 $2$ 种抽奖方式所需的期望费用为 $3327.380952381$，合计为 $9343.17042606516$。

```
输入：
3 3
1 10
1 100
1 10
2 100
1 10
3 100

输出：
30
```

该例子中，进行每种抽奖方式各一次即可收集完所有偶像。

```
输入：
1 1
1 1000
1 100

输出：
1000
```

由于只有一种偶像和一种抽奖方式，只需进行一次抽奖。

```
输入：
2 2
2 1000
1 30
2 70
2 800
1 80
2 20

输出：
2128.57142857143
```

## 输入格式

- 第一行给出偶像的总数 $N$ 和抽奖方式的种类 $M$。

- 接下来的 $M$ 行中，每行描述一种抽奖方式的信息，依次为：
  - $C_i$，该种抽奖方式中所含偶像的数量。
  - $cost_i$，该种抽奖方式的费用。
  - 整数对列出该种抽奖方式中每个偶像的编号和其出现概率的百分比。

## 输出格式

- 输出数字表示在采取最佳策略时收集所有偶像所需的最小期望花费。

## 说明/提示

- $1 \le N \le 10$ 
- $1 \le M \le 4$ 
- $1 \le C_i \le N$ 
- $1 \le cost_i \le 3000$
- 每种抽奖方式中所有偶像的出现概率之和为 $100$。

 **本翻译由 AI 自动生成**



---

---
title: "[ARC017C] 無駄なものが嫌いな人"
layout: "post"
diff: 提高+/省选-
pid: AT_arc017_3
tag: []
---

# [ARC017C] 無駄なものが嫌いな人

## 题目描述

[problemUrl]: https://atcoder.jp/contests/arc017/tasks/arc017_3

私は無駄なものが嫌いなので、無駄なことを言わずに言いたいことだけ言おう。  
 世の中にはナップサック問題というものがあり、決まった大きさのナップサックにできるだけ価値が高くなるよう品物を詰めることを考えるらしいが、そんなことを考えても無駄である。  
 価値がいくら高くなったところで、ナップサックに無駄なスペースができてしまうのは許せない。私は無駄なものが嫌いなのだ。  
 さて、今ここに大きさ $ X $ のナップサックと $ N $ 個の品物がある。  
 $ i $ 番目の品物の大きさは $ w_i $ である。品物の価値については、考えても無駄なので無視する。  
 ナップサックに無駄なスペースができないよう品物を詰める方法は何通りあるだろうか？  
 つまり、$ N $ 個の品物から、大きさの総和が無駄なくぴったり $ X $ となる選び方が何通りあるか、ということだ。  
 私ははじめ手でこの問題を解こうとしたが、無駄が多い手段であると分かったので君に頼むことにした。  
 無駄な計算時間のないプログラムを書いてこの問題を解き、私の無駄な時間を省くのを手伝ってもらいたい。

入力は以下の形式で標準入力から与えられる。

> $ N $ $ X $ $ w_1 $ $ w_2 $ : $ w_N $

- $ 1 $ 行目には、品物の個数を表す整数 $ N\ (1\ \leq\ N\ \leq\ 32) $ とナップサックの大きさを表す整数 $ X\ (1\ \leq\ X\ \leq\ 10^9) $ が半角空白区切りで与えられる。
- $ 2 $ 行目から $ N $ 行では、品物の大きさが与えられる。このうち $ i\ (1\ \leq\ i\ \leq\ N) $ 行目には、$ i $ 番目の品物の大きさを表す整数 $ w_i\ (1\ \leq\ w_i\ \leq\ 5\ \times\ 10^7) $ が書かれている。
 
 $ N $ 個の品物のうちいくつかを選び、その大きさの和がぴったり $ X $ になるような方法が何通りあるかを表す整数を 1 行に出力せよ。 ```
<pre class="prettyprint linenums">
5 5
1
1
2
3
4
```

 ```
<pre class="prettyprint linenums">
4
```

 無駄のない品物の選び方は次の $ 4 $ 通りである。 - 品物 $ 1 $, 品物 $ 2 $, 品物 $ 4 $ を選ぶ: $ 1\ +\ 1\ +\ 3\ =\ 5 $
- 品物 $ 1 $, 品物 $ 5 $ を選ぶ: $ 1\ +\ 4\ =\ 5 $
- 品物 $ 2 $, 品物 $ 5 $ を選ぶ: $ 1\ +\ 4\ =\ 5 $
- 品物 $ 3 $, 品物 $ 4 $ を選ぶ: $ 2\ +\ 3\ =\ 5 $
 
 品物 $ 1 $ と品物 $ 2 $ は同じ重さの品物であるが異なる品物として扱うことに注意すること。 ```
<pre class="prettyprint linenums">
8 21
10
4
2
30
22
20
8
14
```

 ```
<pre class="prettyprint linenums">
0
```

 どのように品物を選んでも、その大きさの和がぴったり $ 21 $ になるようにはできない。 ```
<pre class="prettyprint linenums">
20 100000000
35576749
38866484
6624951
39706038
11133516
25490903
14701702
17888322
14423251
32111678
24509097
43375049
35298298
21158709
30489274
37977301
19510726
28841291
10293962
12022699
```

 ```
<pre class="prettyprint linenums">
45
```

 ```
<pre class="prettyprint linenums">
16 8
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
1
```

 ```
<pre class="prettyprint linenums">
12870
```



---

---
title: "[ARC017D] ARCたんクッキー"
layout: "post"
diff: 提高+/省选-
pid: AT_arc017_4
tag: []
---

# [ARC017D] ARCたんクッキー

## 题目描述

给定一个长度为$N$的序列$A$，要求维护两种操作：

- 将一个区间里的数加上$x$

- 问一个区间里的所有数的最大公约数

## 输入格式

第一行一个正整数$N$，代表序列长度



第二行$N$个正整数，代表序列$A$



第三行一个正整数$M$，代表操作次数



接下来有$M$行，每行三个整数$op,L,R$

- 如果$op=0$，那么要求输出$[L,R]$之间的所有数的最大公约数

- 如果$op\ne 0$，那么将$[L,R]$里的所有数加上$op$

## 输出格式

对每个查询操作，输出一行一个正整数，代表区间里的最大公约数

## 说明/提示

$1\le N,M\le 100000,1\le op,A_i\le 10^9$



有$30\%$数据点满足每次只修改一个数

### 样例1解释

- `A=[6,3,38,49]`

- `Output gcd(6,3,38)=1`

- `A->[6,3,36,49]`

- `Output gcd(6,3,36)=3`

- `A->[6,12,36,49]`

- `Output gcd(6,12)=6`

- `A->[6,12,42,49]`

- `Output gcd(42,49)=7`



---

---
title: "[ARC020C] A mod B Problem"
layout: "post"
diff: 提高+/省选-
pid: AT_arc020_3
tag: []
---

# [ARC020C] A mod B Problem

## 题目描述

[problemUrl]: https://atcoder.jp/contests/arc020/tasks/arc020_3

高橋君が高校生の頃参加していたコンテストでは、$ 2 $ つの整数の和を求める問題が出題されたことがありました。あんなものは最強最速の手に掛かればお茶の子さいさいでした。

大学生になった高橋君は、現在あなたと大学生向けのコンテストに参加している真っ最中です。しかし、得意な言語を使う際に必要な統合開発環境が壊れていて、問題を解くどころではないらしいのです。 そこで、チームメイトであるあなたは、統合開発環境の問題が審判団によって対応されるまでに、彼の代わりに以下の問題を解いておくことにしました。

整数 $ A $ と $ B $ が与えられる。 $ A $ を $ B $ で割った余りを出力しなさい。ただし、整数 $ A $ と整数 $ B $ について以下のような特徴があります。

- 整数 $ A $, $ B $ はどちらも $ 10 $ 進数である。
- 整数 $ B $ は $ 100 $ 点中 $ 99 $ 点分のテストケースで $ B=1000000007(10^9+7) $ を満たしている。
- 整数 $ A $ は非常に大きく、かつ部分的に周期性を持ち、以下のような形式で与えられる。
- $ N $ と $ a_1,a_2,..,a_N $ と $ L_1,L_2,..,L_N $ が与えられる。これは、整数 $ A $ が上の桁から $ a_1 $ が $ L_1 $ 回、$ a_2 $ が $ L_2 $ 回、..、$ a_N $ が $ L_N $ 回と繰り返された形であることを意味する。


例えば、 $ N=3,a=\{123,4,56\},L=\{2,2,1\},B=1000000007 $のとき、$ A=1231234456 $であり、$ A $ を $ B $ で割った余りは $ 231234449 $ です。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ a_1\ L_1 $ $ a_2\ L_2 $ : $ a_N\ L_N $ $ B $

- $ 1 $ 行目には、後に続く整数 $ A $ の情報の長さを表す整数 $ N\ (1\ ≦\ N\ ≦\ 10,000) $ が与えられる。
- $ 2 $ 行目から $ N $ 行では、整数 $ A $ の情報が与えられる。このうち $ i $ 行目では問題文中の $ a_i\ (1\ ≦\ a_i\ ≦\ 10^9) $ と $ L_i\ (1\ ≦\ L_i\ ≦\ 10^9) $ が半角スペース区切りで与えられる。
- $ N+2 $ 行目では、整数 $ B\ (1\ ≦\ B\ ≦\ 1,000,000,007) $ が与えられる。

## 输出格式

$ A $ を $ B $ で割った余りを $ 1 $ 行に出力せよ。出力の末尾に改行をいれること。

## 说明/提示

### 部分点

この問題には3つのデータセットがあり、データセット毎に部分点が設定されている。

- $ L_1+L_2+..+L_N\ ≦\ 100,000 $ かつ、$ B=1000000007 $ を満たすデータセット 1 に正解した場合は $ 20 $ 点が与えられる。
- $ B=1000000007 $ を満たすデータセット 2 に正解した場合は、上記のデータセットとは別に $ 79 $ 点が与えられる。
- 追加制約のないデータセット 3 に正解した場合は、上記のデータセットとは別に $ 1 $ 点が与えられる。

### Sample Explanation 1

問題文中の例です。

### Sample Explanation 2

$ A=123123123 $ です。

### Sample Explanation 3

このテストケースはデータセット 1,2,3 の制約を満たしています。

### Sample Explanation 4

このテストケースはデータセット 2,3 の制約を満たしています。

### Sample Explanation 5

このテストケースはデータセット 3 の制約を満たしています。

## 样例 #1

### 输入

```
3

123 2

4 2

56 1

1000000007
```

### 输出

```
231234449
```

## 样例 #2

### 输入

```
1

123 3

1000000007
```

### 输出

```
123123123
```

## 样例 #3

### 输入

```
1

123456789 10000

1000000007
```

### 输出

```
372735614
```

## 样例 #4

### 输入

```
4

810143056 100000000

81671422 99999999

1639053 99999998

1657560 99999997

1000000007
```

### 输出

```
476685993
```

## 样例 #5

### 输入

```
3

2 3

3 2

5 3

99
```

### 输出

```
36
```



---

---
title: "[ARC021C] 増築王高橋君"
layout: "post"
diff: 提高+/省选-
pid: AT_arc021_3
tag: []
---

# [ARC021C] 増築王高橋君

## 题目描述

[problemUrl]: https://atcoder.jp/contests/arc021/tasks/arc021_3

高橋君は友人達ととあるゲームをしている。

このゲームでは、プレイヤーは建物を購入し、増改築し、できるだけ多くお金を稼ぐことが目的となる。

高橋君は現在 $ 2 $ 位であり、どうにかして首位の青木君より多くのお金を稼がなければならない。

高橋君は、最も多くの回数増築したものに与えられる称号「増築王」を手に入れることで、政府から受ける援助金を利用して勝利しようと計画した。長年の経験から、あと $ K $ 回増築することで増築王になれることが分かっている。

高橋君は現在 $ N $ 軒の建物を所有している。建物には $ 1 $ から $ N $ まで番号がついている。最初、どの建物も増築されていない。

建物 $ i\ (1\ ≦\ i\ ≦\ N) $ について、以下のことが分かっている。

- 建物 $ i $ の増築前の価格は $ A_i $ である。
- 建物 $ i $ を $ 1 $ 回増築するには、建物 $ i $ の現在の価格に等しい費用が必要となる。
- 建物 $ i $ の価格は、$ 1 $ 回増築する度に $ D_i $ だけ上昇する。

高橋君は他の戦略も同時並行で実施するので、増築にかけるお金の合計値ができるだけ少なくなるようにしたい。

あなたは高橋君の代わりに $ K $ 回増築するのに必要な価格の合計値として考えられる最小値を求めてほしい。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ K $ $ N $ $ A_1 $ $ D_1 $ $ A_2 $ $ D_2 $ : $ A_N $ $ D_N $

- $ 1 $ 行目には、増築王になるために必要な増築の回数 $ K\ (1\ ≦\ K\ ≦\ 10^8) $ が与えられる。
- $ 2 $ 行目には、高橋君が所有している建物の軒数 $ N\ (1\ ≦\ N\ ≦\ 10^5) $ が与えられる。
- $ 3 $ 行目から $ N $ 行では、建物の情報が与えられる。このうち $ i $ 行目では整数 $ A_i\ (1\ ≦\ A_i\ ≦10^3) $ と整数 $ D_i\ (1\ ≦\ D_i\ ≦10^3) $ が空白を区切りとして与えられる。

## 输出格式

$ K $ 回増築するのに必要な金額の合計として考えられるものの最小値を $ 1 $ 行に出力せよ。出力の末尾にも改行を入れること。

## 说明/提示

### 部分点

この問題には部分点が設定されている。

- $ K\ ≦\ 300 $ かつ $ N\ ≦\ 300 $ を満たすデータセット $ 1 $ に正解した場合は、$ 30 $ 点が与えられる。
- $ K\ ≦\ 5,000 $ かつ $ N\ ≦\ 5,000 $ を満たすデータセット $ 2 $ に正解した場合は、上記とは別に $ 10 $ 点が与えられる。
- $ K\ ≦\ 10^5 $ を満たすデータセット $ 3 $ に正解した場合は、上記とは別に $ 15 $ 点が与えられる。
- 追加制約のないデータセット $ 4 $ に正解した場合は、上記とは別に $ 45 $ 点が与えられる。

### Sample Explanation 1

例えば、以下のように増築します。 1. 建物 $ 1 $ を増築します。現在の建物 $ 1 $ の価格は $ 10 $ なので、増築にかかった金額の合計は $ 10 $ となります。また、増築後の建物 $ 1 $ の価格は $ 13 $ になります。 2. 建物 $ 1 $ を増築します。現在の建物 $ 1 $ の価格は $ 13 $ なので、増築にかかった金額の合計は $ 23 $ となります。また、増築後の建物 $ 1 $ の価格は $ 16 $ になります。 3. 建物 $ 2 $ を増築します。現在の建物 $ 2 $ の価格は $ 12 $ なので、増築にかかった金額の合計は $ 35 $ となります。また、増築後の建物 $ 2 $ の価格は $ 16 $ になります。 4. 建物 $ 3 $ を増築します。現在の建物 $ 3 $ の価格は $ 15 $ なので、増築にかかった金額の合計は $ 50 $ となります。また、増築後の建物 $ 3 $ の価格は $ 20 $ になります。 このようにすることで、$ 4 $ 回増築するのにかかる金額を $ 50 $ にすることができます。

### Sample Explanation 2

建物 $ 1 $ を $ 8 $ 回増築します。

## 样例 #1

### 输入

```
4

3

10 3

12 4

15 5
```

### 输出

```
50
```

## 样例 #2

### 输入

```
8

4

1 1

10 1

100 1

1000 1
```

### 输出

```
36
```



---

---
title: "[ARC023C] タコヤ木"
layout: "post"
diff: 提高+/省选-
pid: AT_arc023_3
tag: []
---

# [ARC023C] タコヤ木

## 题目描述

高桥君从神秘人X那里得到了章鱼烧，种在院子里，长出了章鱼烧的树。高桥君为它取名“章鱼烧树”，小心翼翼地养护着它。有一天，高桥君发现章鱼烧树上结出了章鱼烧的果实，于是他每天数章鱼烧果实的数量，决定每天将“至今为止章鱼烧果实的总数”记录下来。



记录开始$N$天后，高桥君不小心将章鱼烧掉到了记录表上，共$N$天的记录的一部分被弄脏而无法阅读了。高桥君试图恢复这个记录，决定先计算一下记录数据的总数。

## 输入格式

按照以下格式标准输入：





------------





$N$ 



 $A_1$   $A_2$ ... $A_N$

 



------------

第1行输入一个整数$N$(1 ≦ $N$ ≦ 2,000)，表示记录天数；



第2行输入$ N $ 个表示记录的整数：$A_1$   $A_2$ ... $A_N$，之间以空格隔开(其中任何一个数$A_i$均满足$1$ ≦ $A_i$ ≦ $10^5$或$A_i$ = $0$)：



表示当$A_i$ = $-1$时，第$i$天的记录被弄脏了，无法阅读；当$A_i$ $\not=$ $-1$时，当天数据可读，“第$i$天时章鱼烧果实的总数”为$A_i$。



然而，$A_1$与$A_N$均不为$-1$。



保证输入数据中可阅读数据的个数不小于$1$.

## 输出格式

在下一行输出所有可能数据的个数除以$1,000,000,007$（质数）的余数。

## 说明/提示

对于所有$N$ ≦ $100$且$A_i≦100$的测试点，答案完全正确的给予50分；



对于所有$A_i$ ≦ $2,000$的测试点，答案完全正确的给予80分。

## 样例 #1

### 输入

```
3

1 -1 3
```

### 输出

```
3
```

## 样例 #2

### 输入

```
6

2 -1 -1 9 -1 9
```

### 输出

```
36
```

## 样例 #3

### 输入

```
5

1 -1 -1 -1 1000000000
```

### 输出

```
999999972
```



---

---
title: "[ARC023D] GCD区間"
layout: "post"
diff: 提高+/省选-
pid: AT_arc023_4
tag: []
---

# [ARC023D] GCD区間

## 题目描述

## 题意翻译

给出一个长度为 $n$ $(1<=n<=10^{5})$ 的序列和 $m$ $(1<=m<=10^{5})$ 个询问。对于每个询问，输入 $x$ $(1<=x<=10^{9})$，输出满足 $gcd(a_l,a_{l+1},...,a_r)=x$ 的 $(i,j)$ 的对数。

## 输入格式

第一行两个整数 $n,m$。

接下来的 $n$ 行，为序列，序列中的元素 $a_i$ 满足 $(1<=a_i<=10^{9})$。

最后 $m$ 行，为询问。

## 输出格式

输出 $m$ 行，每行一个整数，回答询问。

## 样例 #1

### 输入

```
3 4

1

2

4

1

2

3

4
```

### 输出

```
3

2

0

1
```

## 样例 #2

### 输入

```
6 7

12

6

4

3

2

1

1

2

3

4

6

12

8
```

### 输出

```
13

3

1

1

2

1

0
```

## 样例 #3

### 输入

```
5 8

4

6

42

28

41

1

2

4

6

7

14

14

41
```

### 输出

```
4

4

1

2

0

1

1

1
```



---

---
title: "[ARC024C] だれじゃ"
layout: "post"
diff: 提高+/省选-
pid: AT_arc024_3
tag: []
---

# [ARC024C] だれじゃ

## 题目描述

在 Takahashi 市，居民们对谐音梗情有独钟。要在这里顺利生活，你得具备较强的谐音梗能力。

当地居民有个习惯，就是用各种谐音梗来“招待”新邻居。最近，有一种名为“变位词谐音梗”的新式谐音梗非常流行。这种谐音梗要求在一句话中找到两个长度相同且没有重叠部分的字符串，其中一个字符串的字母顺序可以通过重新排列变成另一个字符串。如果两个字符串的长度是 $m$，那么我们就说这句话包含长度为 $m$ 的“变位词谐音梗”。

举个例子，在句子“だじゃれをいったのはだれじゃ”中，前 4 个字符“だじゃれ”和后 4 个字符“だれじゃ”没有重叠，并且“だじゃれ”的字符通过重新排列可以变成“だれじゃ”，所以这句话包含长度为 4 的“变位词谐音梗”。

刚刚搬到 Takahashi 市的青木君为了更好地适应生活，想提高自己的“变位词谐音梗”识别能力。然而他并不擅长寻找长度为 $K$ 的“变位词谐音梗”，于是他想通过一个文章生成软件来进行训练。然而，软件本身并没有检测是否包含长度为 $K$ 的变位词谐音梗的功能。

你需要为青木君编写一个程序，判断给定的文章中是否包含长度为 $K$ 的“变位词谐音梗”。

## 输入格式

输入如下所示：

```
N K S
```

- 第 1 行包含两个整数 $N$ 和 $K$，分别表示文章长度 $N$ 和要检测的“变位词谐音梗”长度 $K$。其中 $1 \le N \le 10^5$，$1 \le K \le N$。
- 第 2 行是一个长度为 $N$ 的字符串 $S$，由小写字母构成。

## 输出格式

若文章中包含长度为 $K$ 的“变位词谐音梗”，输出 `YES`；否则输出 `NO`。输出结果后请加换行。

## 说明/提示

在本问题中，数据集有不同的限制条件，符合下列条件的情况会得到对应分数：

- 满足 $N \le 8$ 的数据集 1，可得 15 分。
- 满足 $N \le 300$ 的数据集 2，除上述分数外，可再得 15 分。
- 满足 $N \le 5,000$ 的数据集 3，除上述分数外，可再得 15 分。
- 没有限制条件的数据集 4，除上述分数外，可再得 55 分。

### 样例解释 1

字符串从第 1 个字符开始的 3 个字符“abc”和从第 5 个字符开始的 3 个字符“bca”，通过重新排列可以互相转换，因此包含长度为 3 的“变位词谐音梗”。

### 样例解释 2

字符串从第 1 个字符开始的 4 个字符“abcd”和从第 4 个字符开始的 4 个字符“dcba”尽管可以通过重新排列互相转换，但是因为它们有重叠部分，所以不符合条件。其他划分方式也均不满足条件。

 **本翻译由 AI 自动生成**

## 样例 #1

### 输入

```
8 3

abcdbcae
```

### 输出

```
YES
```

## 样例 #2

### 输入

```
7 4

abcdcba
```

### 输出

```
NO
```

## 样例 #3

### 输入

```
8 1

issample
```

### 输出

```
YES
```



---

---
title: "[ARC025C] ウサギとカメ"
layout: "post"
diff: 提高+/省选-
pid: AT_arc025_3
tag: []
---

# [ARC025C] ウサギとカメ

## 题目描述

兔子和乌龟在图上比赛。

一个图有 $N$ 个节点，节点从 $1$ 到 $N$ 被编号，节点与节点相连的边不会重合，且形成的图是无向图。

在比赛中，从所有节点中选择目的地 $A$、兔子的起点 $B$、乌龟的起点 $C$。$A,B,C$ 互不相同。比赛开始后，兔子以每秒 $R$ 米、乌龟以每秒 $T$ 米的速度向目的地前进。

乌龟想知道通过进行最佳路线是，求当 $A,B,C$ 的组时，兔子任何路是比乌龟后面到达目的地的的个数。

## 输入格式

输入以以下形式从标准输入提供。

$ N $ $ M $ $ R $ $ T $

$ a_1 $ $ b_1 $ $ c_1 $

$ a_2 $ $ b_2 $ $ c_2 $

:

$ a_M $ $ b_M $ $ c_M $

第 $1$ 行中，输入节点个数 $N(3≤N≤2500)$、边数 $M(2≤M≤3000)$、兔子的速度 $R(1≤R≤200)$ 以及乌龟的速度 $T(1≤T≤200)$，空格隔开。

在第 $2$ 行到 $M$ 行中，提供关于该路径的信息。其中，在第 $i$ 行中，为 $2$ 个节点 $a_i,b_i$ 和边长 $c_i$。

## 输出格式

用一行输出组合的总数。

## 说明/提示

样例 1 解释：

可以考虑以下 $2$ 种。
- （目的地，兔子的出发点，乌龟的出发点）为 $(2,4,1)$ 时，乌龟直接去目的地的话，$4$ 秒就到了。另一方面，兔子不管怎么走都至少要花 $4.5$ 秒。
- （目的地，兔子的出发点，乌龟的出发点）是 $(4,3,2)$ 的情况下，乌龟直接去目的地的话 $4$ 秒到达。另一方面，兔子不管怎么走都至少要花 $4.5$ 秒。
顺便说一下（目的地，兔子的开始地点，乌龟的开始地点）是 $(1,4,3)$ 的情况下，兔子和乌龟到达目的地需要 $3$ 秒以上。如果彼此进行了最合适的移动，因为同时到达，所以不满足条件。

## 样例 #1

### 输入

```
4 5 2 1

1 2 4

1 3 3

1 4 6

2 3 5

3 4 4
```

### 输出

```
2
```

## 样例 #2

### 输入

```
5 4 7 7

1 2 1

2 3 1

3 4 1

4 5 1
```

### 输出

```
26
```



---

---
title: "[ARC026C] 蛍光灯"
layout: "post"
diff: 提高+/省选-
pid: AT_arc026_3
tag: []
---

# [ARC026C] 蛍光灯

## 题目描述

[problemUrl]: https://atcoder.jp/contests/arc026/tasks/arc026_3

ある小学校には、すごく長い廊下があります。東西に伸びていて、西端から東端まで $ L $ メートルあります。 学校の方針で窓は一切ついていないので、蛍光灯で廊下を照らさなければいけません。

この廊下には $ N $ 個の蛍光灯がついています。 $ i $ 番目の蛍光灯は西端から $ l_i $ メートルの地点と $ r_i $ メートルの地点の間を照らすことができます。 また、蛍光灯によって点けるのに必要な費用が違います。 $ i $ 番目の蛍光灯を点けるには $ c_i $ 円の費用がかかります。

全ての蛍光灯を点ければ、廊下全体を照らすことは可能ですが、お金がないので可能な限り少ない費用で廊下全体を照らしたいです。 廊下のどの地点、つまり西端から $ 0 $ メートルの地点と $ L $ メートルの地点の間のどの地点も少なくとも1つ以上の蛍光灯に照らされているように蛍光灯を点けるとき、必要な費用の最小値を求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ L $ $ l_1 $ $ r_1 $ $ c_1 $ $ l_2 $ $ r_2 $ $ c_2 $ : $ l_N $ $ r_N $ $ c_N $

 制約に不十分な記述があったため、修正しました。「蛍光灯の照らす範囲」→「蛍光灯の照らす範囲を表す整数」（21:20）

- $ 1 $ 行目には蛍光灯の個数を表す整数 $ N\ (1\ ≦\ N\ ≦\ 10^5) $ と廊下の長さを表すを表す整数$ L(1\ ≦\ L\ ≦\ 10^5) $が空白区切りで与えられる。
- $ 2 $ 行目からの $ N $ 行のうち $ i $ 行目には$ i $番目の蛍光灯の照らす範囲を表す整数 $ l_i,\ r_i\ (0\ ≦\ l_i\ ＜\ r_i\ ≦\ L) $ と、点けるのにかかる費用 $ c_i\ (1\ ≦\ c_i\ ≦\ 10^5) $ が空白区切りで与えられる。
- 全ての蛍光灯を点ければ、廊下全体を照らすことができることが保証されている。

## 输出格式

廊下全体を照らすのに必要な費用の最小値を1行で出力せよ。

## 说明/提示

### 部分点

この問題には部分点が設定されている。

- $ 1\ ≦\ N\ ≦\ 3,000\ ,1\ ≦\ L\ ≦\ 3,000 $を満たすデータセットに正解した場合は $ 60 $ 点が与えられる。
- $ 1\ ≦\ N\ ≦\ 10^5\ ,1\ ≦\ L\ ≦\ 10^5 $を満たすデータセットに正解した場合はさらに $ 40 $ 点が与えられる。合計で$ 100 $点となる。

### Sample Explanation 1

$ 1,\ 2,\ 4,\ 5 $番目の蛍光灯を点けた時、費用の総和が最小になります。

### Sample Explanation 2

$ 6 $番目の蛍光灯を点けない限り、西端から$ 7 $メートルの地点と$ 8 $メートルの地点の間は照らされません。 $ 6 $番目の蛍光灯だけを使うのが、最適な点け方です。

## 样例 #1

### 输入

```
5 5

0 1 1

1 2 1

2 4 3

3 5 1

2 3 2
```

### 输出

```
5
```

## 样例 #2

### 输入

```
8 10

0 2 1

2 3 1

0 4 1

0 2 1

3 7 1

0 10 1080

8 10 1

9 10 1
```

### 输出

```
1080
```

## 样例 #3

### 输入

```
10 10

0 1 1

1 2 1

2 3 1

3 4 1

4 5 1

0 5 4

5 7 2

6 8 3

8 10 1

2 9 3
```

### 输出

```
6
```

## 样例 #4

### 输入

```
5 5

0 1 100000

1 2 100000

2 3 100000

3 4 100000

4 5 100000
```

### 输出

```
500000
```



---

---
title: "[ARC026D] 道を直すお仕事"
layout: "post"
diff: 提高+/省选-
pid: AT_arc026_4
tag: []
---

# [ARC026D] 道を直すお仕事

## 题目描述

[problemUrl]: https://atcoder.jp/contests/arc026/tasks/arc026_4

 ダイナミック王国には $ N $ 個の村があり、$ 0 $ から $ N-1 $ までの番号がついています。それらの村は $ M $ 本の道でひと繋がりになっていました。「ひと繋がりになっている」とは、どの村からどの村へもいくつかの道を辿って行くことが出来る状態のことを指します。ある日大規模な災害によって全ての道が壊れて、村と村の間の移動が出来なくなってしまいました。あなたは王様の高橋君から、道を修理してダイナミック王国の $ N $ 個の村をひと繋がりにする仕事を依頼されました。

 あなたはまず、それぞれの道を修理するため必要な費用と時間を見積もりました。そして、修理する道を適切に選んだ時の「採算がとれる最低限の時給」の最小値を計算することにしました。「採算がとれる最低限の時給」とは、「道を修理するためにかかる時間の合計」×「時給」が「道を修理するためにかかる費用の合計」と等しくなる時の「時給」の金額の値を指します。

 必ずしも全ての道を修理する必要はないことや、村をひと繋がりにするために必要のない道を修理しても良いことに注意して下さい。

## 输入格式

 入力は以下の形式で標準入力から与えられる。

> $ N $ $ M $ $ A_1 $ $ B_1 $ $ C_1 $ $ T_1 $ $ A_2 $ $ B_2 $ $ C_2 $ $ T_2 $ : $ A_M $ $ B_M $ $ C_M $ $ T_M $

- $ 1 $ 行目には、村の個数を表した整数 $ N\ (2\ ≦\ N\ ≦\ 10^4) $ と、道の本数を表した整数 $ M\ (1\ ≦\ M\ ≦\ 10^4) $ が空白区切りで与えられる。
- 続く $ M $ 行には、道の情報が与えられる。このうちの $ i $ 行目には $ 4 $ つの整数 $ A_i\ (0\ ≦\ A_i\ ≦\ N-1),\ B_i\ (0\ ≦\ B_i\ ≦\ N-1),\ C_i\ (1\ ≦\ C_i\ ≦\ 10^6),\ T_i\ (1\ ≦\ T_i\ ≦\ 10^6) $ が空白区切りで書かれており、これは 村 $ A_i $ と村 $ B_i $ を繋ぐ道があり、この道を修理するために費用が $ C_i $、時間が $ T_i $ かかることを表している。
  
   また、道の情報に関して以下の条件が成り立つとして良い。
  
  
  - 全ての $ i $ について、$ A_i\ \neq\ B_i $
  - 全ての $ i,\ j\ (i\ \neq\ j) $ について、「$ A_i\ \neq\ A_j $ または $ B_i\ \neq\ B_j $」かつ「$ A_i\ \neq\ B_j $ または $ B_i\ \neq\ A_j $」

## 输出格式

 「採算がとれる最低限の時給」の最小値を $ 1 $ 行に出力せよ。

 出力は絶対誤差が $ 10^{-2} $ 以下であれば許容される。

 なお、出力の末尾には改行をいれること。

## 说明/提示

### 部分点

 この問題には部分点が設定されている。

- $ M\ ≦\ 16 $ を満たすテストケースすべてに正解した場合は $ 20 $ 点が与えられる。

### Sample Explanation 1

このケースでは、町をひと繋がりにするためには全ての道を修理しなければなりません。全ての道を修理するためにかかる費用の合計が $ 10 $ で時間の合計が $ 5 $ であるため、採算がとれる最低限の時給は $ 2 $ となります。 誤差は $ 10^{-2} $ まで許容されるため、$ 2.01 $ や $ 1.99 $ などと出力しても正解となります。

### Sample Explanation 2

このケースでは、$ 1 $ つ目の道と $ 3 $ つ目の道を修理するときに「採算がとれる最低限の時給」が $ 1.5 $ となり、最小となります。

### Sample Explanation 3

このケースでは、全ての道を修理するときに「採算がとれる最低限の時給」が $ 1.333... $ となり、最小となります。

## 样例 #1

### 输入

```
3 2

0 1 5 3

1 2 5 2
```

### 输出

```
2
```

## 样例 #2

### 输入

```
3 3

0 1 1 1

1 2 3 1

2 0 2 1
```

### 输出

```
1.500
```

## 样例 #3

### 输入

```
4 4

0 1 1 1

1 2 1 1

2 0 1 1

0 3 5 3
```

### 输出

```
1.3333333
```



---

---
title: "[ARC029B] 高橋君と禁断の書"
layout: "post"
diff: 提高+/省选-
pid: AT_arc029_2
tag: []
---

# [ARC029B] 高橋君と禁断の書

## 题目描述

高桥君正在整理自己的房间。

在整理的过程中，他意外地找到了中学时代写的笔记本——一本“不宜公开”的笔记！高桥君觉得这个笔记让人感到羞愧不堪，所以决定将它收进箱子里。

笔记本的形状为一个长方体，底面长 $A$ 厘米，宽 $B$ 厘米，厚度可以忽略不计。房间里有 $N$ 个箱子，每个箱子编号由 $1$ 到 $N$。箱子 $i\ (1 \leq i \leq N)$ 的底面内部是一个长 $C_i$ 厘米、宽 $D_i$ 厘米的长方形，其高度略高于笔记本。

高桥君很讲究，他希望笔记本的底面能够与箱子的内侧底面完全贴合。这意味着，笔记本要放入箱子 $i$ 的条件就是能够通过旋转和平移，使一个长 $A$ 厘米、宽 $B$ 厘米（代表笔记本）的长方形放入同一平面上长 $C_i$ 厘米、宽 $D_i$ 厘米的长方形内。

在选定要放置笔记本的箱子之前，需要确认哪些箱子合适。请编写程序判断每个箱子能否放入笔记本。

## 输入格式

输入通过标准输入给出，格式如下：

> $A$ $B$ $N$  
> $C_1$ $D_1$  
> $C_2$ $D_2$  
> ...  
> $C_N$ $D_N$

- 第一行包含两个整数 $A\ (1 \leq A \leq 300,000)$ 和 $B\ (1 \leq B \leq 300,000)$，表示笔记本的长度和宽度。
- 第二行是一个整数 $N\ (1 \leq N \leq 5,000)$，表示箱子的数量。
- 接下来的 $N$ 行中，每行包含两个整数 $C_i$ 和 $D_i\ (1 \leq C_i, D_i \leq 300,000)$，表示第 $i$ 个箱子的底面长度和宽度。
- 所有测例的情况下，便是即使对每个箱子 $i$ 将 $C_i$ 和 $D_i$ 增加或减少 $0.01$，笔记本能否放入该箱子的结果依然不会改变。

## 输出格式

输出共 $N$ 行。

第 $i$ 行如果笔记本能放入箱子 $i$，则输出 `YES`，否则输出 `NO`。每个输出行末尾都需换行。

## 示例说明

- 对于箱子 $1$，可以通过如下方式放入笔记本（图中斜线部分表示笔记本）。  
  ![](https://img.atcoder.jp/arc/029/2-1.png)
- 对于箱子 $2$，无论如何放置都无法放入笔记本。
- 对于箱子 $3$，可以通过如下方式放入笔记本（图中斜线部分表示笔记本）。  
  ![](https://img.atcoder.jp/arc/029/2-2.png)

 **本翻译由 AI 自动生成**

## 样例 #1

### 输入

```
1 6

3

8 3

4 4

5 5
```

### 输出

```
YES

NO

YES
```



---

---
title: "[ARC029C] 高橋君と国家"
layout: "post"
diff: 提高+/省选-
pid: AT_arc029_3
tag: []
---

# [ARC029C] 高橋君と国家

## 题目描述

[problemUrl]: https://atcoder.jp/contests/arc029/tasks/arc029_3

高橋君はゲーム内で国家を運営している。

国家には $ N $ 個の都市と、$ M $ 本の道がある。それぞれの道は $ 2 $ つの異なる都市を直接結んでおり、道の途中に他の都市がない。また、どの $ 2 $ つの都市についても、それらの都市を直接結ぶ道は高々 $ 1 $ つである。

最初、どの道も舗装されておらず、どの都市にも交易所が設置されていない。

高橋君は国家の発展のため、道路の舗装および交易所の設置を行うことにした。

どの都市についても以下のいずかの条件が満たされていれば、国家は「良い状態」であると呼ぶことにする。

- その都市には交易所が設置されている。
- その都市には交易所が設置されていないものの、その都市から舗装された道のみを経由して、交易所が設置されている別の都市に移動できる。

都市には $ 1 $ から $ N $ まで、道には $ 1 $ から $ M $ までの番号がつけられている。都市 $ i $ に交易所を設置するのには金貨が $ c_i $ 枚必要である。また、道 $ i $ を舗装するのには金貨が $ r_i $ 枚必要である。

あまり金貨を多く持ち合わせていないので、国家を「良い状態」にするのに必要な金貨の枚数をできるだけ少なくしたい。

必要な金貨の枚数として考えられる最小値を求めるプログラムを作成せよ。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ M $ $ c_1 $ $ c_2 $ : $ c_N $ $ a_1 $ $ b_1 $ $ r_1 $ $ a_2 $ $ b_2 $ $ r_2 $ : $ a_M $ $ b_M $ $ r_M $

- $ 1 $ 行目には、$ 2 $ つの整数 $ N\ (2\ ≦\ N\ ≦\ 100,000) $ と $ M\ (1\ ≦\ M\ ≦\ 200,000) $ が空白区切りで書かれている。これは、都市が $ N $ 個、道が $ M $ 本あることを表す。
- $ 2 $ 行目から $ N $ 行には、都市に関する情報を表す整数 $ c_i\ (1\ ≦\ c_i\ ≦\ 1,000,000,000) $ が与えられる。これは、都市 $ i $ に交易所を設置するのには金貨が $ c_i $ 枚必要であることを表す。
- $ N+2 $ 行目から $ M $ 行には、道に関する情報を表す $ 3 $ つの整数 $ a_i $, $ b_i\ (1\ ≦\ a_i\ ＜\ b_i\ ≦\ N) $, $ r_i\ (1\ ≦\ r_i\ ≦\ 1,000,000,000) $ が空白区切りで与えられる。これは、道 $ i $ は都市 $ a_i $ と都市 $ b_i $ を端点に持ち、舗装するのにはコスト $ r_i $ かかることを表す。

## 输出格式

国家を「良い状態」にするのにかかるコストの合計値として考えられる最小値を $ 1 $ 行に出力せよ。出力の末尾にも改行を入れること。

## 说明/提示

### 部分点

この問題には部分点が設定されている。

- $ N\ ≦\ 8 $ かつ $ M\ ≦\ 10 $ を満たすデータセット $ 1 $ に正解した場合は、$ 10 $ 点が与えられる。
- $ N\ ≦\ 12 $ かつ $ M\ ≦\ 66 $ を満たすデータセット $ 2 $ に正解した場合は、上記とは別に $ 20 $ 点が与えられる。
- $ N\ ≦\ 3,000 $ かつ $ M\ ≦\ 6,000 $ を満たすデータセット $ 3 $ に正解した場合は、上記とは別に $ 30 $ 点が与えられる。
- 追加制約のないデータセット $ 4 $ に正解した場合は、上記とは別に $ 40 $ 点が与えられる。

### Sample Explanation 1

都市と道の配置は下図のようになっています。 !\[\](/img/arc/029/3-1.png) 以下の条件で交易所の設置および道の舗装をします。 - 都市 $ 1 $ に交易所を設置する。交易所の設置には金貨が $ 40 $ 枚必要である。 - 都市 $ 3 $ に交易所を設置する。交易所の設置には金貨が $ 30 $ 枚必要である。 - 都市 $ 5 $ に交易所を設置する。交易所の設置には金貨が $ 70 $ 枚必要である。 - 道 $ 1 $ (都市 $ 1 $ と都市 $ 2 $ を結ぶ) を舗装する。舗装には金貨が $ 40 $ 枚必要である。 - 道 $ 3 $ (都市 $ 1 $ と都市 $ 4 $ を結ぶ) を舗装する。舗装には金貨が $ 60 $ 枚必要である。 - 道 $ 7 $ (都市 $ 5 $ と都市 $ 6 $ を結ぶ) を舗装する。舗装には金貨が $ 60 $ 枚必要である。 - 道 $ 8 $ (都市 $ 6 $ と都市 $ 7 $ を結ぶ) を舗装する。舗装には金貨が $ 50 $ 枚必要である。 最終的な都市と道の状態は下図のようになります。ここでは、交易所が設置されている都市の枠を二重に、舗装された道を二重線にして表示してあります。 !\[\](/img/arc/029/3-2.png) この場合、国家は「良い状態」といえます。実際、 - 都市 $ 1 $ には交易所が設置されている。 - 都市 $ 2 $ には交易所が設置されていないが、舗装されている道 $ 1 $ を経由して、交易所が設置されている都市 $ 1 $ に移動することができる。 - 都市 $ 3 $ には交易所が設置されている。 - 都市 $ 4 $ には交易所が設置されていないが、舗装されている道 $ 3 $ を経由して、交易所が設置されている都市 $ 1 $ に移動することができる。 - 都市 $ 5 $ には交易所が設置されている。 - 都市 $ 6 $ には交易所が設置されていないが、舗装されている道 $ 7 $ を経由して、交易所が設置されている都市 $ 5 $ に移動することができる。 - 都市 $ 7 $ には交易所が設置されていないが、舗装されている道 $ 7 $ と舗装されている道 $ 8 $ を経由して、交易所が設置されている都市 $ 5 $ に移動することができる。 となっています。金貨は $ 40\ +\ 30\ +\ 70\ +\ 40\ +\ 60\ +\ 60\ +\ 50\ =\ 350 $ 枚必要となります。

### Sample Explanation 2

すべての都市に交易所を設置する方が安上がりです。

## 样例 #1

### 输入

```
7 8

40

50

30

70

70

80

80

1 2 40

1 3 50

1 4 60

2 5 90

3 4 80

4 5 110

5 6 60

6 7 50
```

### 输出

```
350
```

## 样例 #2

### 输入

```
3 3

50

50

50

1 2 60

1 3 60

2 3 60
```

### 输出

```
150
```

## 样例 #3

### 输入

```
5 7

80

70

60

50

40

1 3 20

1 4 70

1 5 30

2 3 30

2 4 90

3 4 40

4 5 80
```

### 输出

```
160
```



---

---
title: "[ARC030C] 有向グラフ"
layout: "post"
diff: 提高+/省选-
pid: AT_arc030_3
tag: []
---

# [ARC030C] 有向グラフ

## 题目描述

[problemUrl]: https://atcoder.jp/contests/arc030/tasks/arc030_3

$ n $ 個の頂点と $ m $ 本の辺から成る有向グラフがあります．$ n $ 個の頂点は， $ 1 $ から $ n $ の相異なる整数で番号付けされています． 各頂点には，`a` から `z` のアルファベットが $ 1 $ つ書かれています．

あなたはこのグラフを好きな頂点から開始し，各頂点を任意の順番で訪問することで，ちょうど $ k $ 個のアルファベットを回収したいです． 頂点は何度も訪問することができ，その頂点にアルファベットが存在する場合は任意の訪問タイミングで回収することが出来ますが，アルファベットは一度回収すると無くなります．必要がなければ，回収しなくても良いです．

あなたは，ただ回収するだけでは退屈であると思ったので，それらの $ k $ 個のアルファベットを回収した順番に並べたときに辞書順最小になるように回収することにしました．

そのような回収方法を行ったときの，$ k $ 個のアルファベットを，回収した順番に出力しなさい． $ k $ 個のアルファベットを回収する方法が存在しない場合は，`-1` を出力しなさい．

## 输入格式

入力は以下の形式で標準入力から与えられる．

> $ n $ $ m $ $ k $ $ c_1 $ $ c_2 $ … $ c_n $ $ a_1 $ $ b_1 $ $ a_2 $ $ b_2 $ : $ a_{m} $ $ b_{m} $

- $ 1 $ 行目には，グラフの頂点の数を表す整数 $ n\ (1\ ≦\ n\ ≦\ 300) $ と 辺の数を表す整数 $ m\ (0\ ≦\ m\ ≦\ 1000) $ と回収したいアルファベットの数を表す整数 $ k\ (1≦k≦n) $ が与えられる．
- $ 2 $ 行目には，頂点 $ i $ に書かれているアルファベット $ c_i $( `a` から `z` の小文字アルファベット) が $ n $ 個，スペース区切りで与えられる．
- $ 3 $ 行から $ m $ 行，グラフの $ i $ 番目の有向辺が繋いでいる頂点の番号 $ a_i $ と $ b_i\ (1≦a_i,b_i≦n) $ が与えられる． これは，$ i $ 番目の辺が，$ a_i $ から $ b_i $ に移動できる有向辺であることを表す．
- 与えられるグラフに自己辺や多重辺は存在しないが，逆辺は存在することがある．また，連結であることは保障されていない．

## 输出格式

$ 1 $ 行目に，辞書順最小となるように回収した $ k $ 個のアルファベットを，回収した順番に出力せよ．$ k $ 個のアルファベットを回収する方法が存在しない場合は，`-1` を出力せよ．最後に改行を忘れないこと．

## 说明/提示

### Sample Explanation 1

この入出力例を説明する図は以下の通りとなります．頂点 $ 4 $ → $ 3 $ → $ 1 $ → $ 2 $ と移動する過程で，頂点 $ 4 $ の `a`，頂点 $ 1 $ の `a`，そして頂点 $ 2 $ の `b` を順番に回収することで辞書順最小の答えとなります． !\[\](/img/arc/030/Csample1.png)

### Sample Explanation 4

$ 3 $ つの頂点は孤立しており，どの頂点から開始しても，ちょうど $ 2 $ 個のアルファベットを回収することはできません．

## 样例 #1

### 输入

```
4 4 3

a b b a

1 2

2 3

3 1

4 3
```

### 输出

```
aab
```

## 样例 #2

### 输入

```
5 4 4

d a b c a

1 2

2 3

3 4

2 5
```

### 输出

```
dabc
```

## 样例 #3

### 输入

```
5 4 3

d a b c a

1 2

2 3

3 4

2 5
```

### 输出

```
abc
```

## 样例 #4

### 输入

```
3 0 2

a b c
```

### 输出

```
-1
```



---

---
title: "[ARC031C] 積み木"
layout: "post"
diff: 提高+/省选-
pid: AT_arc031_3
tag: []
---

# [ARC031C] 積み木

## 题目描述

[problemUrl]: https://atcoder.jp/contests/arc031/tasks/arc031_3

全て高さの違う $ N $ 個の積み木が $ 1 $ 列に並べられています。隣り合う $ 2 $ 個の積み木を並べ替える操作を何回か行って、一番高い積み木から順に左右へ低くなっていくようにする時、必要な最小の交換回数を求めてください。すなわち、並べ替えた後の $ i $ 番目の積み木の高さを $ Ai $ とし、一番高い積み木の位置を $ T $ としたとき、

- $ A1 $ &lt; $ A2 $ &lt; ... &lt; $ AT $ &gt; ... &gt; $ AN-1 $ &gt; $ AN $
 
 を満たすように並べ替えるのに必要な最小の交換回数を求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ B1 $ $ B2 $ ... $ BN $

- $ 1 $ 行目には、積み木の数 $ N\ (1≦N≦10^5) $ がスペース区切りで与えられる。
- $ 2 $ 行目には、積み木の高さ $ Bi\ (1≦Bi≦N) $ が最初に並べられている順に与えられる。
- ただし、積み木の高さは全て異なる。すなわち、$ Bi≠Bj\ (i≠j) $ が成り立つ。

## 输出格式

並べ替えるのに必要な最小の交換回数を出力せよ。出力の末尾には改行をつけること。

## 说明/提示

### 部分点

この問題には $ 2 $ つのデータセットがあり、データセット毎に部分点が設定されている。

- $ N≦100 $ を満たすデータセット $ 1 $ に正解した場合は $ 30 $ 点が与えられる。
- 追加制約のないデータセット $ 2 $ に正解した場合は、上記のデータセットとは別に $ 70 $ 点が与えられる。

## 样例 #1

### 输入

```
4

2 4 1 3
```

### 输出

```
1
```

## 样例 #2

### 输入

```
5

2 4 1 3 5
```

### 输出

```
3
```

## 样例 #3

### 输入

```
6

1 2 4 3 5 6
```

### 输出

```
1
```



---

---
title: "[ARC032C] 仕事計画"
layout: "post"
diff: 提高+/省选-
pid: AT_arc032_3
tag: []
---

# [ARC032C] 仕事計画

## 题目描述

[problemUrl]: https://atcoder.jp/contests/arc032/tasks/arc032_3

大工のチョーさん(Daiku Cho)は $ N $ 個の仕事を頼まれています。$ i $ 番目の仕事は時刻 $ a_i $ に始まり、$ b_i $ に終わります。

チョーさんは一度に複数の仕事をこなすことはできないので、これらの仕事のうち、仕事を行う時刻が重ならないようになるべく多くの仕事を選びたいです。ただし、終了と同時に別の仕事に取り掛かることはできます。

最も多く選ぶ方法が複数あるときは、選んだ仕事の番号を開始時刻の順に並べた列が辞書順最小となるように選ぼうと思っています。

大工のチョーさんは仕事上手ですが、スケジュールを管理するのは上手くないようです。チョーさんが引き受ける最適な仕事の組み合わせを求めてください。

ただし、長さ $ L $ の列 $ A=\{a_1,a_2,…,a_L\} $ と $ B=\{b_1,b_2,…,b_L\} $ に対し、辞書順で $ A $ が $ B $ より小さいとは、

- $ i\ <\ k $ で $ a_i $=$ b_i $
- $ i=k $ で $ a_i $&lt;$ b_i $

となるような $ k(1≦k≦L) $ が存在するということです。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ a_1 $ $ b_1 $ $ a_2 $ $ b_2 $ : $ a_N $ $ b_N $

- $ 1 $ 行目には、チョーさんが頼まれた仕事の数を表す整数 $ N\ (1\ ≦\ N\ ≦\ 100,000) $ が与えられる。
- $ 2 $ 行目から $ N $ 行には、チョーさんが頼まれた仕事の情報が与えられる。そのうち $ i $ 行目には、$ i $ 番目の仕事の開始時刻と終了時刻を表す $ 2 $ つの整数 $ a_i,\ b_i(0\ ≦\ a_i\ <\ b_i\ ≦\ 1,000,000) $ がスペース区切りで与えられる。

## 输出格式

$ 1 $ 行目には、チョーさんが引き受ける仕事の数を出力せよ。

$ 2 $ 行目には、チョーさんが引き受ける仕事を、時刻が早いものから順に $ 1 $ つの空白で区切って出力せよ。

末尾の改行を忘れないこと。また、末尾に余計な空白を付け加えないこと。

## 说明/提示

### Sample Explanation 1

チョーさんは最大で $ 2 $ つの仕事を選ぶことができます。その選び方は $ 3 $ 通りあり、チョーさんは仕事 $ 1 $ と $ 4 $、または仕事 $ 2 $ と $ 3 $、または仕事 $ 2 $ と $ 4 $ を選ぶことができます。 この内、辞書順で小さくなる選び方は仕事 $ 1 $ と $ 4 $ を選んだときです。なぜならば、それらの仕事番号を \*\*仕事の開始時刻順\*\* に並べたときに $ \{1,4\} $ となり、それが辞書順最小となるからです(21:12修正)。 !\[\](http://arc032.contest.atcoder.jp/img/arc/032/C1.png)

## 样例 #1

### 输入

```
4

0 5

0 3

3 7

5 10
```

### 输出

```
2

1 4
```

## 样例 #2

### 输入

```
5

0 5

0 3

3 7

5 10

7 12
```

### 输出

```
3

2 3 5
```

## 样例 #3

### 输入

```
8

1 5

3 9

2 5

1 2

8 10

9 11

7 15

10 14
```

### 输出

```
4

4 3 5 8
```



---

---
title: "[ARC033D] 見たことのない多項式"
layout: "post"
diff: 提高+/省选-
pid: AT_arc033_4
tag: []
---

# [ARC033D] 見たことのない多項式

## 题目描述

高桥君有一个未知的 $N$ 次多项式 $P(x)$，只知道 $P(x)$在$x=0,1,2,3\cdots N$ 时的值。高桥君希望知道当 $x=T$ 时，多项式的值。结果对 $10^9+7$ 取模。

## 输入格式

输入数据共三行。

第一行一个 $N$ 表示多项式次数。

第二行 $N+1$ 个数顺次表示 $P(x)$ 在 $0\sim N$ 处的值 $A_i$。

第三行一个数 $T$，表示询问。

## 输出格式

共一行一个数，表示 $P(T)$ 在 $\bmod\ 10^9+7$ 意义下的答案。

## 说明/提示

对于 $40 \%$ 的数据，满足 $N \leq 100$。

对于 $80 \%$ 的数据，满足 $N \leq 3000$。

对于全部 $100 \%$ 的数据，$1 \leq N \leq 10^5$, $0 \leq A_i \leq 10^9+6$, $T \leq 10^9$。

## 样例 #1

### 输入

```
2

1 3 7

3
```

### 输出

```
13
```

## 样例 #2

### 输入

```
5

4 16 106 484 1624 4384

1000000000
```

### 输出

```
999984471
```



---

---
title: "[ARC035D] 高橋くんとマラソンコース"
layout: "post"
diff: 提高+/省选-
pid: AT_arc035_d
tag: []
---

# [ARC035D] 高橋くんとマラソンコース

## 题目描述

高桥君在筹办今年的高桥镇马拉松比赛。

高桥镇可以视作一个 $10^6\times 10^6$ 的网格图，我们认为第 $i$ 行第 $j$ 列的点的坐标为 $(i,j)$。

为了方便计时，高桥君为比赛设置了 $N$ 个检查点，第 $i$ 个检查点的坐标为 $(a_i,b_i)$。

参赛选手需要 **顺次通过每个** 检查点，在途中只能够 **向上或向右** 前进。

现在高桥君正在对比赛进行进一步调整，你作为他的参谋，需要响应他的 $Q$ 次行动：

+ 修改：将检查点 $i$ 的坐标更改为 $(x,y)$。
+ 询问：求出从检查点 $l_1$ 到 $r_1$ 的路径总数与 $l_2$ 到 $r_2$ 的路径总数哪个更多。

特别的，保证每次询问时，$l_1$ 到 $r_1$ 的路径总数和 $l_2$ 到 $r_2$ 的路径总数之差大于等于路径总数较小的一个的路径总数。

## 输入格式

首先给出 $N$，表示检查点总数。

之后 $N$ 行，第 $i$ 行有两个整数 $a_i,b_i$ 表示检查点 $i$ 的坐标为 $a_i,b_i$。

之后给出 $Q$，表示行动数。

每行的第一个数 $t$ 表示行动种类：

+ 若 $t=1$，则表示这是一次修改操作，接下来给出三个数 $i,x,y$，表示将检查点 $i$ 的坐标改为 $(x,y)$。
+ 若 $t=2$，则表示这是一次询问操作，接下来给出四个数 $l_1,r_1,l_2,r_2$，含义如题面所述。

## 输出格式

对于每次询问输出一行一个字符串：若 $l_1$ 到 $r_1$ 的路径总数大于 $l_2$ 到 $r_2$ 的路径总数，输出 `FIRST`，否则输出 `SECOND`。

## 说明/提示

对于所有数据，$2\le N\le 2\times 10^5$。

保证输入的坐标均在 $[1,10^6]$ 以内。

保证无论何时，任意两个检查点之间至少存在一条路径。

保证每次询问时路径总数较多的一个的路径总数至少是路径总数较少的一个的两倍。

## 样例 #1

### 输入

```
4

1 1

2 5

4 5

5 6

4

2 1 3 3 4

2 1 3 1 4

1 2 2 2

2 2 3 3 4
```

### 输出

```
FIRST

SECOND

FIRST
```

## 样例 #2

### 输入

```
4

1 1

100 100

101 102

199 199

3

2 1 2 2 3

2 1 2 2 4

2 1 2 3 4
```

### 输出

```
FIRST

FIRST

FIRST
```



---

---
title: "[ARC036C] 偶然ジェネレータ"
layout: "post"
diff: 提高+/省选-
pid: AT_arc036_c
tag: []
---

# [ARC036C] 偶然ジェネレータ

## 题目描述

### 题目简介

有一个长度为$N$的数列，其仅由$0,1$构成。



现在，有一些地方需要填充，这些地方用问号来代替。



需要知道，有几种方案来填充问号，使得无论从数列中取出怎样的**连续的**子数列，其子数列中所包含的$0$的个数和$1$的个数的差都必须在$K$以下。

## 输入格式

- 在第$1$行中，有两个正整数$N(1 \le N \le 300)$和$K(1 \le K \le N)$。这表示数列的长度为$N$，子数列允许的最大差为$K$。

- 第$2$行提供长度为$N$的字符串，表示这个数列。字符串仅由$0$、$1$和问号构成

  - 如果从左起$i$个字符是$0$，则表示随机数表的第$i$个元素必须是$0$。

  - 如果从左起$i$个字符是$1$，则表示随机数表的第$i$个元素必须是$1$。

  - 如果从左起第$i$个字符是问号，则随机数表的第$i$个元素是$0$和$1$都可以（也就是需要填充）。

## 输出格式

输出填充数列中问号的方案的总数对$10^9+7$取模，**末尾要换行。**

## 样例 #1

### 输入

```
9 4

?011?1110
```

### 输出

```
2
```

## 样例 #2

### 输入

```
9 3

?011?1110
```

### 输出

```
0
```

## 样例 #3

### 输入

```
9 1

???1?????
```

### 输出

```
1
```

## 样例 #4

### 输入

```
12 5

???0??1??11?
```

### 输出

```
172
```



---

---
title: "[ARC036D] 偶数メートル"
layout: "post"
diff: 提高+/省选-
pid: AT_arc036_d
tag: []
---

# [ARC036D] 偶数メートル

## 题目描述

高桥君所在的国家有 $N$ 座城市，编号为 $1$ 到 $N$。初始时没有道路，于是国家准备修建几条连接不同城市的双向道路。

由于高桥君很喜欢偶数，所以在从一座城市到达另外一座城市时，即使绕远路，或者走同一条路多次，也要使得走的总距离为偶数。但是在走过一条路后，高桥君不会马上再走一遍这条路。

高桥君有时会指定两座不同的城市，问他是否能用上述方式从其中一座走到另外一座。

由于国家还在建设道路，因此在不同时间提出的相同问题可能有不同的答案。

## 输入格式

第一行两个整数 $N,Q(1\le N,Q\le 10^5)$，表示城市数量和操作数量。

接下来 $Q$ 行每行四个整数 $w,x,y,z(1\le w\le2,1\le x,y\le N,x\ne y,1\le z\le 10^5)$。

- $w=1$，表示国家在 $x$ 和 $y$ 两座城市中修了一条长度为 $z$ 的双向道路。
- $w=2$，表示高桥君询问城市 $x$ 和 $y$ 能否通过他的走路方式互相到达，保证此时 $z=1$。

注意：

- 相同的两座城市间可能有多条道路。
- 高桥君每次提问时，之前所有的道路都已建设完毕。

## 输出格式

对于每次高桥君的询问，若可行输出 ```YES```，否则输出 ```NO```。

by @[Larryyu](https://www.luogu.com.cn/user/475329)

## 样例 #1

### 输入

```
5 9

1 1 2 3

1 1 3 2

1 3 5 5

2 1 5 1

2 2 5 1

1 2 4 4

1 1 4 6

2 1 5 1

2 3 5 1
```

### 输出

```
NO

YES

YES

YES
```

## 样例 #2

### 输入

```
5 7

1 1 2 3

1 2 4 4

1 5 3 1

2 1 3 1

2 5 3 1

1 3 1 2

2 3 4 1
```

### 输出

```
NO

NO

NO
```

## 样例 #3

### 输入

```
3 6

1 1 2 1

1 1 3 3

1 2 3 2

1 2 1 2

2 1 3 1

2 2 3 1
```

### 输出

```
YES

YES
```



---

---
title: "[ARC039C] 幼稚園児高橋君"
layout: "post"
diff: 提高+/省选-
pid: AT_arc039_c
tag: []
---

# [ARC039C] 幼稚園児高橋君

## 题目描述

在一个向四周无限延伸的平面上有一个人，一开始设个人在$(0,0)$



现在这个人将会进行$N$次移动，每次移动都会选择上下左右中的一个方向，然后走到这个方向上第一个没有被走到的整点



问最后这个人在哪里

## 输入格式

第一行一个正整数$N$



第二行一个字符串$S$，其中的`L,R,U,D`分别代表向左、右、上、下移动

## 输出格式

两个整数$x,y$，代表最后这个人所在的位置

## 说明/提示

$1\le N=|S|\le 200000$

走过的路径为$(0,0)(1,0)(-1,0)(-1,1)$

## 样例 #1

### 输入

```
3

RLU
```

### 输出

```
-1 1
```

## 样例 #2

### 输入

```
7

RURDRUL
```

### 输出

```
0 1
```

## 样例 #3

### 输入

```
25

RLRLRLRLRLRLURLRLRLRLRLRL
```

### 输出

```
-12 1
```



---

---
title: "[ARC042D] あまり"
layout: "post"
diff: 提高+/省选-
pid: AT_arc042_d
tag: []
---

# [ARC042D] あまり

## 题目描述

[problemUrl]: https://atcoder.jp/contests/arc042/tasks/arc042_d

$ 4 $ つの整数 $ X,\ P,\ A,\ B\ (1\ ≦\ X\ が与えられます。ただし、P $ は素数です。 $ X^i\ (A\ ≦\ i\ ≦\ B) $ を $ P $ で割った余りの最小値を求めてください。

この問題の入力は得点に影響しない入力例 $ 1 $ を除いて、[このC++プログラム](/img/arc/042/adafrrg/generator.cpp)を用いて生成しました。擬似乱数生成器の初期化に用いられるプログラムの第 $ 1 $ 引数は $ 1 $ 以上 $ 10,000 $ 以下の整数を用いました。[このファイル](/img/arc/042/adafrrg/input.txt)の $ i $ 行目 $ (1\ ≦\ i\ ≦\ 10,000) $ は、入力生成プログラムの第 $ 1 $ 引数が $ i $ であるときの出力と一致します。すなわち、与えられるテストケースは入力例 $ 1 $ を除いて、このファイルのいずれかの行と一致します。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ X $ $ P $ $ A $ $ B $

- $ 1 $ 行目には、$ 4 $ つの整数 $ X,\ P,\ A,\ B\ (1\ ≦\ X\ が空白区切りで与えられる。ただし、P $ は素数である。

## 输出格式

$ X^i\ (A\ ≦\ i\ ≦\ B) $ を $ P $ で割った余りの最小値を $ 1 $ 行に出力せよ。

## 说明/提示

### Sample Explanation 1

$ X^i\ (A\ ≦\ i\ ≦\ B) $ を $ P $ で割った余りは $ 8,\ 5,\ 10,\ 9,\ 7,\ 3,\ 6 $ であるので、最小値は $ 3 $ である。 この入力は入力生成プログラムを用いて作られたものではないので、得られる得点に影響しない。

### Sample Explanation 2

この入力は入力生成プログラムの第 $ 1 $ 引数に $ 1 $ を与えて生成した。

### Sample Explanation 3

この入力は入力生成プログラムの第 $ 1 $ 引数に $ 3 $ を与えて生成した。

### Sample Explanation 4

この入力は入力生成プログラムの第 $ 1 $ 引数に $ 25 $ を与えて生成した。

## 样例 #1

### 输入

```
2 11 3 9
```

### 输出

```
3
```

## 样例 #2

### 输入

```
15 7159 12 12818
```

### 输出

```
1
```

## 样例 #3

### 输入

```
1400884 50141599 4 458568
```

### 输出

```
114
```

## 样例 #4

### 输入

```
1591755 291456379 215 1223
```

### 输出

```
96324
```



---

---
title: "[ARC044C] ビーム"
layout: "post"
diff: 提高+/省选-
pid: AT_arc044_c
tag: []
---

# [ARC044C] ビーム

## 题目描述

### 题意简述

有一个 $H\times W$ 的网格，左下角为 $\left(1,1\right)$，右上角为 $\left(W,H\right)$。

这个网格很危险，会有 $Q$ 束光束飞来，光束用形如 $\left(T,D,X\right)$ 的三元组给出，$T$ 表示光束到来的时间，$D$ 表示方向（$0$ 为垂直，$1$ 为水平），$X$ 为坐标。例如 $\left(t,1,a\right)$ 表示第 $t$ 秒有一束光束会通过所有坐标为 $\left(i,a\right)\left(1\le i\le W\right)$ 的格子。

高桥君已知所有光束来袭的信息，他要让自己不会被光束击中。他可以自由选择初始位置，且结束位置没有限制，一秒可以移动任意次（每次可以横向或竖向移动一步），但不能走出网格。

请计算高桥君最少的移动次数。如果高桥君一定会碰到光束，则输出 $−1$。

## 输入格式

第一行三个整数 $W,H,Q$。

之后 $Q$ 行，每行三个整数 $T_i,D_i,X_i$，表示每束光束。

## 输出格式

一个整数表示答案（记得换行）。

## 说明/提示

$1\le W,H\le 10^5,0\le Q\le 10^5,1\le T_i\le 10^5,D_i\in\left\{0,1\right\}$，当 $D_i=0$ 时 $1\le X_i\le W$；当 $D_i=1$ 时 $1\le X_i\le H$，$\forall i\ne j,\left(T_i,D_i,X_i\right)\ne\left(T_j,D_j,X_j\right)$。

[Y204335](https://www.luogu.com.cn/user/360974)翻译

## 样例 #1

### 输入

```
3 2 8

1 0 2

3 0 2

4 1 2

2 1 2

4 0 3

2 0 3

1 1 1

2 0 1
```

### 输出

```
3
```

## 样例 #2

### 输入

```
2 4 10

3 1 1

2 1 3

3 0 1

2 1 4

1 1 3

2 1 2

3 1 2

1 0 1

3 1 4

2 0 2
```

### 输出

```
4
```

## 样例 #3

### 输入

```
3 3 5

1 0 3

1 0 2

1 1 3

1 1 2

1 0 1
```

### 输出

```
-1
```



---

---
title: "[ARC044D] suffix array"
layout: "post"
diff: 提高+/省选-
pid: AT_arc044_d
tag: []
---

# [ARC044D] suffix array

## 题目描述

[problemUrl]: https://atcoder.jp/contests/arc044/tasks/arc044_d

高橋君はsuffix arrayの構築アルゴリズムが大好きです。毎日さまざまなsuffix arrayの構築アルゴリズムを実装して遊んでいます。 しかし、高橋君はsuffix arrayを構築しすぎてしまったので、suffix arrayを構築するのに飽きてしまいました。 そこで高橋君は、与えられた順列に対し、その順列をsuffix arrayに持つような辞書順最小の文字列を求めることにしました。

ただし、$ 2 $つの文字列$ X_1,X_2,...,X_s $と$ Y_1,Y_2,...,Y_t $に対し、辞書順で$ X\ <\ Y $とは、以下のいずれか片方の条件を満たすこととします。

- ある整数$ i(1\ ≦\ i\ ≦\ min(s,t)) $が存在し、$ 1\ ≦\ j\ ≦\ i-1 $を満たす任意の整数$ j $に対して$ X_j=Y_j $で、かつ$ X_i\ <\ Y_i $
- 任意の整数$ i(1\ ≦\ i\ ≦\ min(s,t)) $に対して$ X_i=Y_i $で、かつ$ s\ <\ t $

また、与えられた文字列Sに対し、そのsuffix arrayとは、すべてのiに対して、Sのi文字目から末尾までを順に並べた文字列を列挙し、その文字列たちを辞書順に並び替えた列の各要素に対し、対応するiを順に並べたものです。 たとえば、文字列ABACABAのsuffix arrayは\[7,5,1,3,6,2,4\]となります。

長さNの順列が与えられるので、その順列をsuffix arrayに持つ英大文字のみからなる辞書順最小の文字列を求めてください。そのような文字列が存在しなければ、代わりに-1を出力してください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ A_1\ A_2\ ...\ A_N $

- $ 1 $ 行目には、整数$ N(1\ ≦\ N\ ≦\ 10^6) $が与えられる。
- $ 2 $ 行目には、整数列$ A_1,...,A_N(1\ ≦\ A_1,...,A_N\ ≦\ N) $が与えられる。これら$ N $個の整数はどの$ 2 $つも互いに異なることが保障される。

## 输出格式

順列$ A_1,...,A_N $をsuffix arrayに持つ辞書順最小の文字列を出力せよ。

 出力の末尾に改行を入れること。(21:40修正)

## 说明/提示

### Sample Explanation 1

条件を満たす文字列は他にも$ CXHZBWA $などがありますが、辞書順最小の$ ABACABA $を出力します。

## 样例 #1

### 输入

```
7

7 5 1 3 6 2 4
```

### 输出

```
ABACABA
```

## 样例 #2

### 输入

```
12

7 1 9 10 2 4 3 6 12 5 11 8
```

### 输出

```
BDEDGFAHCCGG
```



---

---
title: "[ARC045C] エックスオア多橋君"
layout: "post"
diff: 提高+/省选-
pid: AT_arc045_c
tag: []
---

# [ARC045C] エックスオア多橋君

## 题目描述

### 题意简述

有一棵 $N$ 个点的树，每条边上有边权，给定整数 $X$，求树上点对 $\left(a,b\right)\left(1\le a<b\le N\right)$ 的个数，使得 $a$ 到 $b$ 的简单路径上边权的异或和等于 $X$。

## 输入格式

第一行两个整数 $N,X$。

之后 $N-1$ 行每行三个整数 $x,y,c$，表示 $x$ 与 $y$ 间有一条边权为 $c$ 的边。

数据保证为一棵树。

## 输出格式

一个整数表示答案（记得换行）。

## 说明/提示

$1\le N\le10^5,0\le X\le10^9,1\le x_i,y_i\le N,0\le c_i\le10^9$。

[Y204335](https://www.luogu.com.cn/user/360974)翻译

## 样例 #1

### 输入

```
6 7

1 2 5

2 3 3

3 4 6

2 5 2

5 6 7
```

### 输出

```
3
```

## 样例 #2

### 输入

```
6 3

1 2 1

2 3 3

3 4 2

4 5 3

4 6 1
```

### 输出

```
4
```

## 样例 #3

### 输入

```
10 1

9 10 1

6 10 1

5 2 1

8 6 1

4 5 1

7 6 0

3 8 0

3 1 1

8 2 0
```

### 输出

```
25
```



---

---
title: "[ARC046C] 合コン大作戦"
layout: "post"
diff: 提高+/省选-
pid: AT_arc046_c
tag: []
---

# [ARC046C] 合コン大作戦

## 题目描述

小明和小红打算合资成立一家婚介所



现在有$N$名剩男和$M$名剩女来到的这家婚介所，并且所有剩男被编号为$1$到$N$，剩女被编号为了$1$到$M$



已知每个剩男的年薪是$A_i$元，并且想要找一个年薪不低于$B_i$元的妻子；同样的，已知每个剩女的年薪是$C_i$元，并且想要找一个年薪不低于$D_i$元的丈夫



对于剩男$i$和剩女$j$，当且仅当$A_i\ge D_i$且$C_i\ge B_i$时（也就是互相满足了对方的要求时）才可能成为一对夫妻



同时，根据法律规定，重婚（一个人在两对夫妻关系中同时出现）和同婚（男男配对或女女配对）都是不允许的



小明和小红打算最大化他们可能凑成的夫妻对数，但不知道应该怎么如何配对，希望你能写一个小程序帮助他们

## 输入格式

输入共有(N+M+1)行



第1行为剩男人数$N$与剩女人数$M$



第2~(N+1)行为每位剩男的年薪$A_i$和对妻子年薪的要求$B_i$



第(N+2)~(N+M+1)行为每位剩女的年薪$C_i$和对丈夫年薪的要求$D_i$

## 输出格式

输出需输出最多可能配对成功的夫妻对数

## 说明/提示

$30\%$数据：对任意$1\le i\le N$和$1\le j\le M$都有$B_i\le C_j$



$100\%$数据：$1\le N,M\le 150000$，$1\le A_i,B_i,C_i,D_i \le 10^9$

## 样例描述

### 样例1

让剩男$1$和剩女$2$配对，剩男$2$和剩女$3$配对，最大配对数为$2$



再次声明：此题禁止重婚



注意：在这个样例中，存在剩女的年薪低于剩男要求的年薪的情况，因此不符合$30\%$部分分的额外限制

### 样例2

让剩男$3$和剩女$4$配对，剩男$2$和剩女$2$配对，剩男$1$和剩女$1$配对，最大配对数为$3$



此样例符合$30\%$部分分的额外限制

### 样例3

此样例符合$30\%$部分分的额外限制

### 样例4

注意：可能所有剩男剩女之间都不能配对，此时可配对的夫妻数为$0$



此样例符合$30\%$部分分的额外限制

## 样例 #1

### 输入

```
3 3

3 5

2 4

4 5

3 1

6 2

5 3
```

### 输出

```
2
```

## 样例 #2

### 输入

```
3 4

4 1

2 1

7 1

5 3

12 1

1 10

8 5
```

### 输出

```
3
```

## 样例 #3

### 输入

```
5 1

1 1

1 1

1 1

1 1

1 1

1 1
```

### 输出

```
1
```

## 样例 #4

### 输入

```
1 1

1 1

1 2
```

### 输出

```
0
```



---

---
title: "[ARC047C] N!÷K番目の単語"
layout: "post"
diff: 提高+/省选-
pid: AT_arc047_c
tag: []
---

# [ARC047C] N!÷K番目の単語

## 题目描述

[problemUrl]: https://atcoder.jp/contests/arc047/tasks/arc047_c

高橋語には $ N $ 種類の文字があります。

この問題では便宜上、各文字に辞書順で小さい順に $ 1 $ ～ $ N $ の整数を割り振って扱うことにします。

高橋語の単語は全て $ N $ 文字からなり、$ N $ 種類の文字が全てちょうど $ 1 $ 個ずつ含まれます。 また、そのような文字列は全て高橋語の単語です。

つまり、高橋語の単語は $ N! $ 個あります。

ある $ N $ 以下の正の整数 $ K $ が与えられるので、高橋語の単語の中で辞書順で小さい方から $ N!\ ÷\ K $ 番目の単語を求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ K $

- $ 1 $ 行目には $ 2 $ つの整数 $ N,\ K(1\ ≦\ K\ ≦\ N\ ≦\ 10^5) $ が空白区切りで与えられます。

## 输出格式

出力は $ N $ 行からなる。 $ i $ 行目には高橋語の単語の中で辞書順で小さい方から $ N!\ ÷\ K $ 番目の単語の $ i $ 文字目の文字に対応する整数を出力せよ。 出力の末尾に改行を入れること。

## 说明/提示

### 部分点

この問題には部分点が設定されている。

- $ 1\ ≦\ N\ ≦\ 20 $ を満たすデータセットに正解した場合は $ 30 $ 点が与えられる。
- $ 1\ ≦\ N\ ≦\ 10^5 $ を満たすデータセットに正解した場合はさらに $ 70 $ 点が与えられる。合計で$ 100 $点となる。

### Sample Explanation 1

$ 1,2,3,4 $ の並び替えのうち、辞書順で小さい方から $ 4!\ ÷\ 3\ =\ 8 $ 番目の文字を出力しなければなりません。 高橋語の単語のうち辞書順で小さい方から順に $ 8 $ 個を列挙すると $ 1,\ 2,\ 3,\ 4 $ $ 1,\ 2,\ 4,\ 3 $ $ 1,\ 3,\ 2,\ 4 $ $ 1,\ 3,\ 4,\ 2 $ $ 1,\ 4,\ 2,\ 3 $ $ 1,\ 4,\ 3,\ 2 $ $ 2,\ 1,\ 3,\ 4 $ $ 2,\ 1,\ 4,\ 3 $ となります。よって $ 2,\ 1,\ 4,\ 3 $が求めるべき単語です。

## 样例 #1

### 输入

```
4 3
```

### 输出

```
2

1

4

3
```

## 样例 #2

### 输入

```
11 7
```

### 输出

```
2

7

9

5

4

11

10

8

6

3

1
```



---

---
title: "[ARC048C] 足の多い高橋君"
layout: "post"
diff: 提高+/省选-
pid: AT_arc048_c
tag: []
---

# [ARC048C] 足の多い高橋君

## 题目描述

[problemUrl]: https://atcoder.jp/contests/arc048/tasks/arc048_c

高橋君には足が $ N $ 本あり、$ i $ 番目の足は $ L_i $ 本の骨が一列につながった構造をしています。 すべての足の片方の端は、高橋君の胴体につながっています。高橋君の胴体には骨はありません。

今回高橋君は、自分のすべての足のすべての骨に $ 0 $ または $ 1 $ の文字を書き込むことにしました。

高橋君は文字の書き込み方に強いこだわりを持っており、任意の異なる $ 2 $ 本の足 $ A,B $ について、 $ A $ の胴体につながっていないほうの端から $ B $ の胴体につながっていないほうの端までの胴体を経由する経路上にある骨に書かれた文字をすべて順に読むと回文になっているとき、またその時のみ満足します。

高橋君が満足する文字の書き込み方の数を $ 10^9+7 $ で割った余りを求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ L_1 $ . . . $ L_N $

- $ 1 $ 行目には、高橋君の足の本数を表す整数 $ N(1\ ≦\ N\ ≦\ 100000) $ が与えられる。
- 続く $ N $ 行には、$ i $ 番目の足の長さを表す整数 $ L_i(1\ ≦\ L_i\ ≦\ 10^9) $ が与えられる。

## 输出格式

高橋君が満足する文字の書き込み方の数を $ 10^9+7 $ で割った余りを表す整数 $ 1 $ つを出力せよ。

出力の最後には改行を忘れないこと。

## 说明/提示

### Sample Explanation 1

$ 3 $ 本の足に書く文字列を胴体に接続していないほうから読むと、例えば $ (01,0111,01111111) $ などが条件を満たします。

## 样例 #1

### 输入

```
3

2

4

8
```

### 输出

```
8
```

## 样例 #2

### 输入

```
8

2

1

4

3

6

5

8

7
```

### 输出

```
4
```

## 样例 #3

### 输入

```
5

700000000

20000000

9000000

600000000

30000000
```

### 输出

```
861838989
```



---

---
title: "[ARC049C] ぬりまーす"
layout: "post"
diff: 提高+/省选-
pid: AT_arc049_c
tag: []
---

# [ARC049C] ぬりまーす

## 题目描述

高桥君在一次比赛中取得了优异的成绩，因此获得了出行旅游的机会，他趁机买了一款名为「ぬりまーす」的颜料。

与此同时，高桥君在手里有一张包含 $N$ 个顶点的有向图，图中的顶点分别编号为 $1, 2, \ldots, N$。

由于高桥君非常喜欢涂颜料，他打算利用这款「ぬりまーす」颜料给这些顶点上色。然而，他不想随便上色，于是为某些顶点设置了以下两种条件：

- 类型1：给顶点 $x$ 上色时，顶点 $y$ 必须已经被涂上颜色。
- 类型2：给顶点 $u$ 上色时，顶点 $v$ 不能已经被涂上颜色。

类型1的约束共有 $A$ 个，而类型2的约束有 $B$ 个。

一开始，所有的顶点都没有上色。你的任务是找出一种最佳顺序给顶点上色，以实现上色顶点数量的最大化。

## 输入格式

输入由标准输入提供，格式如下：

> $N$ $A$ $x_1$ $y_1$ $x_2$ $y_2$ : $x_A$ $y_A$ $B$ $u_1$ $v_1$ $u_2$ $v_2$ : $u_B$ $v_B$

- 第一行是整数 $N$，表示图中顶点的数量，满足 $1 \le N \le 100$。
- 第二行是整数 $A$，表示类型1约束的数量，范围是 $0 \le A \le 100$。
- 接下来的 $A$ 行中，每行包含两个整数 $x_i, y_i$，表示一种类型1约束：当给顶点 $x_i$ 上色时，顶点 $y_i$ 必须已经上色。这里 $1 \le x_i, y_i \le N$ 且 $x_i \neq y_i$。
- 紧接着一行是整数 $B$，表示类型2约束的数量，范围是 $0 \le B \le 10$。
- 随后的 $B$ 行中，每行包含两个整数 $u_i, v_i$，表示一种类型2约束：当给顶点 $u_i$ 上色时，顶点 $v_i$ 不能已经上色。这里 $1 \le u_i, v_i \le N$ 且 $u_i \neq v_i$。
- 输入中的约束可能导致某些顶点永远无法被上色，并且可能有重复的约束。

## 输出格式

请输出在所有约束条件下，最多能上色的顶点数量。输出要以换行符结束。

## 说明/提示

### 示例解释 1

可以依次给顶点3→顶点2→顶点1上色。

### 示例解释 2

在这种约束下，顶点1不能上色。

### 示例解释 3

在这种约束下，没有顶点可以上色。

 **本翻译由 AI 自动生成**

## 样例 #1

### 输入

```
3

2

1 2

2 3

1

3 1
```

### 输出

```
3
```

## 样例 #2

### 输入

```
3

2

1 2

2 3

1

1 3
```

### 输出

```
2
```

## 样例 #3

### 输入

```
3

3

1 2

2 3

3 1

0
```

### 输出

```
0
```

## 样例 #4

### 输入

```
9

7

1 2

1 3

5 4

8 5

9 8

6 1

7 1

2

1 4

4 1
```

### 输出

```
6
```

## 样例 #5

### 输入

```
100

0

0
```

### 输出

```
100
```



---

---
title: "[ARC050B] 花束"
layout: "post"
diff: 提高+/省选-
pid: AT_arc050_b
tag: []
---

# [ARC050B] 花束

## 题目描述

Takahashi有R个红花、B个蓝花；他可以制作以下两种花束：



1. x朵红花和一朵蓝花

2. y朵蓝花和一朵红花



求Takahashi最多能制作多少种花束（不必要用完所有的花）。

## 输入格式

第一行包含整数R,B;第二行包含整数x,y; 含义见描述。

## 输出格式

一个整数，表示Takahashi最多能制作的花束的数量。



---

---
title: "[ARC050C] LCM 111"
layout: "post"
diff: 提高+/省选-
pid: AT_arc050_c
tag: []
---

# [ARC050C] LCM 111

## 题目描述

[problemUrl]: https://atcoder.jp/contests/arc050/tasks/arc050_c





---

---
title: "[ARC052C] 高橋くんと不思議な道"
layout: "post"
diff: 提高+/省选-
pid: AT_arc052_c
tag: []
---

# [ARC052C] 高橋くんと不思議な道

## 题目描述

[problemUrl]: https://atcoder.jp/contests/arc052/tasks/arc052_c





---

---
title: "[ARC054C] 鯛焼き"
layout: "post"
diff: 提高+/省选-
pid: AT_arc054_c
tag: []
---

# [ARC054C] 鯛焼き

## 题目描述

[problemUrl]: https://atcoder.jp/contests/arc054/tasks/arc054_c

高橋君の家にはタイヤが $ N $ 個と木が $ N $ 本あります。高橋君は、これらを一つずつ組み合わせて鯛焼きを $ N $ 個作ることにしました。

タイヤと木の組には相性があり、相性のいいタイヤと木の組み合わせでのみおいしい鯛焼きを作ることができます。 高橋君はおいしい鯛焼きしか食べないので、作る $ N $ 個の鯛焼きすべてが、相性のいいタイヤと木の組み合わせでできている必要があります。

高橋君はこの条件を満たすように鯛焼きを作る方法が何通りあるのかが気になりましたが、これはとても数えられそうにないことに気付きました。

そこで高橋君は、その方法の数の偶奇だけを求めることにしました。

高橋君は、すべてのタイヤと木のペアについて、そのペアの相性がいいかどうかを表あらわす表 $ (S_{ij}) $ を持っています。この表は $ N $ 行 $ N $ 列からなり、$ i $ 行 $ j $ 列の要素が $ 1 $ のとき $ i $ 番目のタイヤと $ j $ 番目の木の相性がいいことを、 $ 0 $ のとき悪いことを表します。 高橋君に代わって、すべての鯛焼きをおいしくするような組み合わせ方の数の偶奇を求めてください。 ただし、 $ 2 $ つの組み合わせ方が異なるとは、あるタイヤが存在し、そのタイヤが別の木と組み合わせられて鯛焼きが作られていることを指します。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ S_{11}S_{12}..S_{1N} $ $ : $ $ S_{N1}S_{N2}..S_{NN} $

## 输出格式

すべての鯛焼きをおいしくするような組み合わせの個数が偶数なら "Even" 、奇数なら "Odd" を出力せよ。

出力の最後には改行を忘れないこと。

## 说明/提示

### 制約

- $ 1\ ≦\ N\ ≦\ 200 $
- $ S_{ij}=0 $ もしくは $ S_{ij}=1\ (1\ ≦\ i,j\ ≦\ N) $

### Sample Explanation 1

$ 2 $ 通りの組み合わせ方があります。

### Sample Explanation 2

$ 3 $ 通りの組み合わせ方があります。

### Sample Explanation 3

$ 0 $ 通りの組み合わせ方があります。

## 样例 #1

### 输入

```
3

110

101

011
```

### 输出

```
Even
```

## 样例 #2

### 输入

```
3

110

111

011
```

### 输出

```
Odd
```

## 样例 #3

### 输入

```
2

00

00
```

### 输出

```
Even
```

## 样例 #4

### 输入

```
12

000000100000

011111111111

000000100000

000111111100

100100000100

100111111100

100100000100

100111111100

100100000100

100111111100

100000000000

111111111111
```

### 输出

```
Even
```



---

---
title: "[ARC055C] ABCAC"
layout: "post"
diff: 提高+/省选-
pid: AT_arc055_c
tag: []
---

# [ARC055C] ABCAC

## 题目描述

有一个字符串 $s$，你需要找到所有满足如下拆分方法的方法总数：

你需要将 $s$ 分成 $5$ 个字符串，使得第 $1$ 个字符串和第 $4$ 个字符串完全相同，都是 $A$ 字符串；第 $3$ 个字符串和第 $5$ 个字符串完全相同，都是 $C$ 字符串。第 $2$ 个字符串（即 $B$ 字符串）与他们都不相同。

即题目标题中所说的 `ABCAC`。

## 输入格式

输入共一行：

第一行，一个字符串 $s$（$|s| \le 2\times 10^5$）。

## 输出格式

输出共一行：

第一行，一个整数，表示所有满足规则的拆分方法总数。

## 样例 #1

### 输入

```
takaitai

```

### 输出

```
2

```

## 样例 #2

### 输入

```
aaaaaaaaaa

```

### 输出

```
6

```

## 样例 #3

### 输入

```
abcabc

```

### 输出

```
0

```



---

---
title: "[ARC056C] 部門分け"
layout: "post"
diff: 提高+/省选-
pid: AT_arc056_c
tag: []
---

# [ARC056C] 部門分け

## 题目描述

[problemUrl]: https://atcoder.jp/contests/arc056/tasks/arc056_c

高橋くんのいる会社は$ N $人の社員からなる。社員$ i $と社員$ j $の間には、信頼度$ w_{i,j} $が定まっている。 おかげ様で会社はぐんぐん成長したため、$ N $人をいくつかの部門に分けることになった。ここで、部門分けのスコアを、(部門の数)\*$ K $-(異なる部門に属する$ 2 $人の間の信頼度の総和)と定める。 スコアの最大値を求めるプログラムを書いてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ K $ $ w_{1,1} $ ... $ w_{1,N} $ : $ w_{N,1} $ ... $ w_{N,N} $

## 输出格式

$ 1 $行目に、スコアの最大値を出力せよ。

## 说明/提示

### 制約

- $ 1\ ≦\ N\ ≦\ 17 $
- $ i≠j $ のとき、 $ 1\ ≦\ w_{i,j}\ ≦\ 10^6 $
- $ w_{i,i}\ =\ 0 $
- $ w_{i,j}=w_{j,i} $
- $ 1\ ≦\ K\ ≦\ 10^6 $
- 入力はすべて整数である

### 部分点

- $ N\ ≦\ 9 $ を満たすテストケース全てに正解した場合、部分点として$ 40 $点が与えられる。
- $ N\ ≦\ 15 $ を満たすテストケース全てに正解した場合、部分点として追加で$ 40 $点が与えられる。

### Sample Explanation 1

社員$ 1 $と$ 3 $で$ 1 $つの部門、社員$ 2 $で$ 1 $つの部門を作ると、 部門の数は$ 2 $つ、異なる部門の間の$ 2 $人の信頼度の総和は$ 2 $なので、$ 2*3-2=4 $となる。 スコアを$ 4 $より大きくする方法はない。

## 样例 #1

### 输入

```
3 3

0 1 5

1 0 1

5 1 0
```

### 输出

```
4
```

## 样例 #2

### 输入

```
4 8

0 2 3 5

2 0 1 2

3 1 0 8

5 2 8 0
```

### 输出

```
11
```

## 样例 #3

### 输入

```
5 10

0 10 1 2 1

10 0 1 2 1

1 1 0 6 7

2 2 6 0 8

1 1 7 8 0
```

### 输出

```
12
```



---

---
title: "[ARC057B] 高橋君ゲーム"
layout: "post"
diff: 提高+/省选-
pid: AT_arc057_b
tag: []
---

# [ARC057B] 高橋君ゲーム

## 题目描述

[problemUrl]: https://atcoder.jp/contests/arc057/tasks/arc057_b

高橋君は $ N $ 日にわたってゲームをしています。$ i(1\ ≦\ i\ ≦\ N) $ 日目には、$ a_i $ 回のゲームをします。

各ゲームの結果は、勝つか負けるかのどちらかです。

高橋君の $ i(1\ ≦\ i\ ≦\ N) $ 日目の機嫌は、勝率によって定まり、$ i-1 $ 日目までの勝率より $ i $ 日目までの勝率のほうが真に高かった場合、$ i $ 日目に機嫌をよくします。そうでない場合、$ i $ 日目に機嫌を悪くします。 ただし、$ i $ 日目までの勝率とは、$ i\ =\ 0 $のとき $ 0 $ 、そうでないときは $ i $ 日目までにゲームで勝った回数の合計を $ i $ 日目までにゲームをした回数の合計で割った値を指します。

高橋君の機嫌は AtCoder 社の収益に直結するので、青木君は高橋君の機嫌が気になります。青木君は、高橋君が $ N $ 日間で合計 $ K $ 回ゲームに勝ったことを知っています。

青木君に代わって、高橋君の機嫌がよかった日数の最大値を求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ K $ $ a_1 $ : $ a_N $

## 输出格式

高橋君の機嫌がよかった日数の最大値を $ 1 $ 行に出力せよ。

## 说明/提示

### 制約

- $ 1\ ≦\ N\ ≦\ 2000 $
- $ 1\ ≦\ a_i\ ≦\ 500000(1\ ≦\ i\ ≦\ N) $
- $ 0\ ≦\ K\ ≦\ a_1+...+a_N $

## 样例 #1

### 输入

```
5 7

2

3

7

4

9
```

### 输出

```
3
```

## 样例 #2

### 输入

```
3 5

1

2

2
```

### 输出

```
1
```

## 样例 #3

### 输入

```
2 4

2

10
```

### 输出

```
1
```

## 样例 #4

### 输入

```
10 12

2

8

3

5

10

5

2

9

19

22
```

### 输出

```
7
```



---

---
title: "[ARC058D] いろはちゃんとマス目"
layout: "post"
diff: 提高+/省选-
pid: AT_arc058_b
tag: []
---

# [ARC058D] いろはちゃんとマス目

## 题目描述

[problemUrl]: https://atcoder.jp/contests/arc058/tasks/arc058_b

縦 $ H $ マス、横 $ W $ マスのマス目があります。 いろはちゃんは、今一番左上のマス目にいます。 そして、右か下に1マス移動することを繰り返し、一番右下のマス目へと移動します。 ただし、下から $ A $ 個以内、かつ左から $ B $ 個以内のマス目へは移動することは出来ません。

移動する方法は何通りあるか求めてください。

なお、答えは非常に大きくなることがあるので、答えは $ 10^9+7 $ で割ったあまりを出力してください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ H $ $ W $ $ A $ $ B $

## 输出格式

移動する方法の数を $ 10^9+7 $ で割ったあまりを出力せよ。

## 说明/提示

### 制約

- $ 1\ ≦\ H,\ W\ ≦\ 100,000 $
- $ 1\ ≦\ A\ <\ H $
- $ 1\ ≦\ B\ <\ W $

### Sample Explanation 1

$ 2×3 $ マスありますが、左下の $ 1 $ マスには移動することができません。「右右下」、「右下右」という $ 2 $ つの移動の仕方があります。

### Sample Explanation 2

移動できないマスが $ 12 $ マスあります。

## 样例 #1

### 输入

```
2 3 1 1
```

### 输出

```
2
```

## 样例 #2

### 输入

```
10 7 3 4
```

### 输出

```
3570
```

## 样例 #3

### 输入

```
100000 100000 99999 99999
```

### 输出

```
1
```

## 样例 #4

### 输入

```
100000 100000 44444 55555
```

### 输出

```
738162020
```



---

---
title: "[ARC063E] 木と整数"
layout: "post"
diff: 提高+/省选-
pid: AT_arc063_c
tag: []
---

# [ARC063E] 木と整数

## 题目描述

[problemUrl]: https://atcoder.jp/contests/arc063/tasks/arc063_c

$ N $ 頂点の木があり、頂点には $ 1,\ 2,\ ...,\ N $ と番号が振られています。$ i $ ($ 1\ ≦\ i\ ≦\ N\ -\ 1 $) 番目の辺は頂点 $ A_i $ と頂点 $ B_i $ を結んでいます。

高橋君は木の $ K $ 個の頂点に整数を書き込みました。具体的には、各 $ 1\ ≦\ j\ ≦\ K $ について、頂点 $ V_j $ に整数 $ P_j $ を書き込みました。その後、高橋君は居眠りを始めました。

木を見つけた青木君は、残りのすべての頂点に整数を書き込み、高橋君を驚かせようとしています。高橋君を驚かせるためには、木が次の条件を満たさなければなりません。

- 条件: 辺で直接結ばれた $ 2 $ つの頂点に書かれている整数の差がちょうど $ 1 $ である。

残りのすべての頂点に書き込む整数を工夫することで、木が条件を満たすようにできるか判定してください。もし可能な場合は、どのように整数を書き込めばよいかを具体的にひとつ求めて下さい。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ A_1 $ $ B_1 $ $ A_2 $ $ B_2 $ $ : $ $ A_{N-1} $ $ B_{N-1} $ $ K $ $ V_1 $ $ P_1 $ $ V_2 $ $ P_2 $ $ : $ $ V_K $ $ P_K $

## 输出格式

残りのすべての頂点に書き込む整数を工夫することで木が条件を満たすようにできるならば `Yes` を、できないならば `No` を出力せよ。

条件を満たせる場合、追加で $ N $ 行出力せよ。このうちの $ v $ ($ 1\ ≦\ v\ ≦\ N $) 行目には、頂点 $ v $ に書かれる整数を出力せよ。条件を満たすような整数の書き込み方が複数ある場合、そのうちいずれかひとつを出力すればよい。

## 说明/提示

### 制約

- $ 1\ ≦\ N\ ≦\ 10^5 $
- $ 1\ ≦\ K\ ≦\ N $
- $ 1\ ≦\ A_i,\ B_i\ ≦\ N $ ($ 1\ ≦\ i\ ≦\ N\ -\ 1 $)
- $ 1\ ≦\ V_j\ ≦\ N $ ($ 1\ ≦\ j\ ≦\ K $) (21:18, 制約の誤記を修正)
- $ 0\ ≦\ P_j\ ≦\ 10^6 $ ($ 1\ ≦\ j\ ≦\ K $)
- 与えられるグラフは木になることが保証される
- $ V_j $ はすべて相異なる

### Sample Explanation 1

はじめ、木は以下の図のような状態である。頂点のそばに書かれた数が頂点番号を、頂点の中に書かれた青い数が元から書き込まれていた整数を表す。 !\[6da26f89839711a520acdf5c3e1cc309.png\](https://atcoder.jp/img/arc063/6da26f89839711a520acdf5c3e1cc309.png) 青木君はたとえば次のように残りの頂点に整数を書き込むことで木が条件を満たすようにできる。これは出力例 $ 1 $ に対応している。 !\[1858d5af5a2c0e51aca39a39d765debb.png\](https://atcoder.jp/img/arc063/1858d5af5a2c0e51aca39a39d765debb.png) 木が条件を満たしていれば、これとは異なった出力でも AC となることに注意せよ。たとえば、入力例 $ 1 $ に対しては ``` Yes 7 6 8 7 7 ``` という出力でも正答となる。

### Sample Explanation 3

新たに書き込む整数は負になったり $ 10^6 $ を超えたりしても構わない。

## 样例 #1

### 输入

```
5

1 2

3 1

4 3

3 5

2

2 6

5 7
```

### 输出

```
Yes

5

6

6

5

7
```

## 样例 #2

### 输入

```
5

1 2

3 1

4 3

3 5

3

2 6

4 3

5 7
```

### 输出

```
No
```

## 样例 #3

### 输入

```
4

1 2

2 3

3 4

1

1 0
```

### 输出

```
Yes

0

-1

-2

-3
```



---

---
title: "[ABC055D] Menagerie"
layout: "post"
diff: 提高+/省选-
pid: AT_arc069_b
tag: []
---

# [ABC055D] Menagerie

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc055/tasks/arc069_b

すぬけくんは動物が好きなので動物園を作りました。

この動物園では $ 1,2,3,\ ...,\ N $ の番号を割り振られた $ N $ 匹の動物が円環状に並べられています。 $ i\ (2≦i≦N-1) $ 番の動物は $ i-1 $ 番の動物と $ i+1 $ 番の動物と隣り合っています。また、$ 1 $ 番の動物は $ N $ 番の動物と $ 2 $ 番の動物と隣り合っており、$ N $ 番の動物は $ N-1 $ 番の動物と $ 1 $ 番の動物と隣り合っています。

動物園には本当のことしか言わない正直者の羊と、嘘しか言わない嘘つきの狼の 2 種類の動物がいます。

すぬけくんには羊と狼の区別がつかないので、それぞれの動物に両隣の動物が同じ種類かどうかを訪ねたところ、$ i $ 番目の動物は $ s_i $ と答えました。$ s_i $ が `o` ならば両隣の動物が同じ種類であると、`x` ならば異なる種類であると $ i $ 番の動物が言ったことを示します。

より形式的には、羊は両隣の動物がどちらも羊あるいはどちらも狼のとき `o` と答え、そうでないとき `x` と答えます。 狼は両隣の動物がどちらも羊あるいはどちらも狼のとき `x` と答え、そうでないとき `o` と答えます。

これらの回答結果と矛盾しないような各動物の種別の割り当てが存在するか、すぬけくんは気になっています。存在するならば一例を示し、存在しないならば `-1` を出力しなさい。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ s $

## 输出格式

$ s $ と矛盾しないような各動物の種類の割当てが存在しないならば `-1` を出力してください。 存在するならば以下の形式で文字列 $ t $ を出力してください。 $ t $ で示される割り当てが $ s $ と矛盾しないならば正解となります。

- $ t $ は長さ $ N $ で `S` と `W` のみからなる文字列
- $ t_i $ が `S` ならば $ i $ 番の動物が羊であることを、`W` ならば狼であることを示す

## 说明/提示

### 制約

- $ 3\ ≦\ N\ ≦\ 10^{5} $
- $ s $ は `o` と `x` のみからなる長さ $ N $ の文字列

### Sample Explanation 1

例えば $ 1,2,3,4,5,6 $ 番の動物がそれぞれ羊、羊、羊、狼、狼、羊であるとき発言と矛盾しません。その他、狼、羊、狼、羊、狼、狼であるようなときも矛盾しません。 両隣が同じ種類の動物のとき羊は `o` と発言し、狼は `x` と発言すること、 両隣が異なる種類の動物のとき羊は `x` と発言し、狼は `o` と発言することに注意してください。 !\[b34c052fc21c42d2def9b98d6dccd05c.png\](https://atcoder.jp/img/arc069/b34c052fc21c42d2def9b98d6dccd05c.png)

### Sample Explanation 2

存在しない場合は `-1` を出力してください。

## 样例 #1

### 输入

```
6

ooxoox
```

### 输出

```
SSSWWS
```

## 样例 #2

### 输入

```
3

oox
```

### 输出

```
-1
```

## 样例 #3

### 输入

```
10

oxooxoxoox
```

### 输出

```
SSWWSSSWWS
```



---

---
title: "[ARC069E] Frequency"
layout: "post"
diff: 提高+/省选-
pid: AT_arc069_c
tag: []
---

# [ARC069E] Frequency

## 题目描述

[problemUrl]: https://atcoder.jp/contests/arc069/tasks/arc069_c

すぬけくんは数列を作るのが好きです。

$ 1 $ から $ N $ までの番号がついた石の山があります。 $ i $ 番の石の山は $ a_i $ 個の石からなります。

すぬけくんは以下の手順により長さ $ Σa_i $ の数列 $ s $ を構成することにしました。

1. 石の数が最大である山のうち、最も番号が小さい山の番号を $ x $ として、$ s $ の末尾に $ x $ を追加する
2. 石が $ 1 $ 個以上存在する山を $ 1 $ つ選んで、選んだ山から石を $ 1 $ つ取り除く
3. 石が $ 1 $ 個以上存在する山が存在するなら $ 1. $ へ、そうでなければ数列の構成を終了する

$ s $ が辞書順で最小の数列となるようにしたとき、$ s $ に $ 1,2,3,...,N $ という数がそれぞれいくつ含まれるか求めなさい。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ a_1 $ $ a_2 $ $ ... $ $ a_{N} $

## 输出格式

答えを $ N $ 行に出力せよ。$ i $ 行目では辞書順で最小の $ s $ における $ i $ の出現回数を出力せよ。

## 说明/提示

### 制約

- $ 1\ ≦\ N\ ≦\ 10^{5} $
- $ 1\ ≦\ a_i\ ≦\ 10^{9} $

### Sample Explanation 1

以下の手順で辞書順最小であるような数列が構成できます。 - 石の数が最大であるような山は $ 2 $ 番なので $ 2 $ を $ s $ に追加する。その後、番号 $ 2 $ の山から石を $ 1 $ つ取り除く。 - 石の数が最大であるような山は $ 1 $ 番と $ 2 $ 番なので、最も番号が小さい $ 1 $ を $ s $ に追加する。その後、番号 $ 2 $ の山から石を $ 1 $ つ取り除く。 - 石の数が最大であるような山は $ 1 $ 番なので $ 1 $ を $ s $ に追加する。その後、番号 $ 1 $ の山から石を $ 1 $ つ取り除く。 このときできる数列は $ (2,1,1) $ となります。$ 1 $ は $ 2 $ つ含まれ、$ 2 $ は $ 1 $ つ含まれます。

## 样例 #1

### 输入

```
2

1 2
```

### 输出

```
2

1
```

## 样例 #2

### 输入

```
10

1 2 1 3 2 4 2 5 8 1
```

### 输出

```
10

7

0

4

0

3

0

2

3

0
```



---

---
title: "[ABC056D] No Need"
layout: "post"
diff: 提高+/省选-
pid: AT_arc070_b
tag: []
---

# [ABC056D] No Need

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc056/tasks/arc070_b

シカのAtCoDeerくんは正整数が書かれたカードを $ N $ 枚持っています。$ i(1≦i≦N) $ 枚目に書かれている数は $ a_i $ です。 AtCoDeerくんは大きい数が好きなので、カードに書かれた数の総和が $ K $ 以上になるようなカードの部分集合を*よい集合*と呼びます。

そして、各カード $ i $ に対して、そのカードが*不必要*かどうかを次のように判定します。

- 「カード $ i $ を含む任意の*よい集合*に対して、その集合からカード $ i $ を除いたものも*よい集合*」 ならカード $ i $ は*不必要*
- それ以外の場合は、*不必要*でない

不必要なカードの枚数を求めてください。ただし、それぞれの判定は独立に行われ、不必要だからと言ってカードが途中で捨てられたりすることはありません。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ K $ $ a_1 $ $ a_2 $ ... $ a_N $

## 输出格式

不必要なカードの枚数を出力せよ。

## 说明/提示

### 制約

- 入力は全て整数
- $ 1≦N≦5000 $
- $ 1≦K≦5000 $
- $ 1≦a_i≦10^9\ (1≦i≦N) $

### 部分点

- $ N,K≦400 $ を満たすデータセットに正解した場合は、部分点として $ 300 $ 点が与えられる。

### Sample Explanation 1

よい集合は {$ 2,3 $} と {$ 1,2,3 $} の二つです。 カード $ 1 $ を含むよい集合は {$ 1,2,3 $} しかなく、これから $ 1 $ を取り除いた {$ 2,3 $} もよい集合なので、カード $ 1 $ は不必要です。 また、よい集合である {$ 2,3 $} から $ 2 $ を取り除いた集合 {$ 3 $} はよい集合ではないため、カード $ 2 $ は不必要ではありません。 カード $ 3 $ も同様に不必要ではないため、答えは $ 1 $ です。

### Sample Explanation 2

この場合よい集合は存在しないため、全てのカードは不必要となります。

## 样例 #1

### 输入

```
3 6

1 4 3
```

### 输出

```
1
```

## 样例 #2

### 输入

```
5 400

3 1 4 1 5
```

### 输出

```
5
```

## 样例 #3

### 输入

```
6 20

10 4 3 10 25 2
```

### 输出

```
3
```



---

---
title: "[ARC071F] Infinite Sequence"
layout: "post"
diff: 提高+/省选-
pid: AT_arc071_d
tag: []
---

# [ARC071F] Infinite Sequence

## 题目描述

[problemUrl]: https://atcoder.jp/contests/arc071/tasks/arc071_d

{$ {1,\ ...\ ,n} $} からなる無限長の列 $ a_1,\ a_2,\ ... $ のうち、 次の条件を満たしているものは何通りあるでしょうか？

- 第 $ n $ 項から先はすべて同じ数である。つまり、$ n\ \leq\ i,j $ ならば $ a_i\ =\ a_j $ を満たす。
- どの正の整数 $ i $ に対しても、第 $ i $ 項の直後に並ぶ $ a_i $ 個の項はすべて同じ数である。つまり、 $ i\ <\ j\ <\ k\leq\ i+a_i $ ならば $ a_j\ =\ a_k $ を満たす。

答えを $ 10^9+7 $ で割ったあまりを求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ n $

## 输出格式

条件を満たす数列の数を $ 10^9+7 $ で割ったあまりを出力せよ。

## 说明/提示

### 制約

- $ 1\ \leq\ n\ \leq\ 10^6 $
- $ n $ は整数

### Sample Explanation 1

以下の $ 4 $ 通りがあります。 - $ 1,\ 1,\ 1,\ ... $ - $ 1,\ 2,\ 2,\ ... $ - $ 2,\ 1,\ 1,\ ... $ - $ 2,\ 2,\ 2,\ ... $

## 样例 #1

### 输入

```
2
```

### 输出

```
4
```

## 样例 #2

### 输入

```
654321
```

### 输出

```
968545283
```



---

---
title: "[ARC075F] Mirrored"
layout: "post"
diff: 提高+/省选-
pid: AT_arc075_d
tag: []
---

# [ARC075F] Mirrored

## 题目描述

[problemUrl]: https://atcoder.jp/contests/arc075/tasks/arc075_d

正の整数 $ n $ に対し、$ n $ の十進表記（先頭に $ 0 $ を付けない）を左右に反転させて得られる整数を $ rev(n) $ と表記します。例えば、$ rev(123)\ =\ 321 $, $ rev(4000)\ =\ 4 $ です。

正の整数 $ D $ が与えられます。$ rev(N)\ =\ N\ +\ D $ であるような正の整数 $ N $ はいくつ存在するでしょうか？

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ D $

## 输出格式

$ rev(N)\ =\ N\ +\ D $ であるような正の整数 $ N $ の個数を出力せよ。

## 说明/提示

### 制約

- $ D $ は整数である。
- $ 1\ <\ =\ D\ <\ 10^9 $

### Sample Explanation 1

$ rev(N)\ =\ N\ +\ 63 $ であるような正の整数 $ N $ は、$ N\ =\ 18,\ 29 $ の $ 2 $ 個存在します。

### Sample Explanation 2

$ rev(N)\ =\ N\ +\ 75 $ であるような正の整数 $ N $ は存在しません。

## 样例 #1

### 输入

```
63
```

### 输出

```
2
```

## 样例 #2

### 输入

```
75
```

### 输出

```
0
```

## 样例 #3

### 输入

```
864197532
```

### 输出

```
1920
```



---

---
title: "[ABC065D] Built?"
layout: "post"
diff: 提高+/省选-
pid: AT_arc076_b
tag: []
---

# [ABC065D] Built?

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc065/tasks/arc076_b

平面上に、$ N $ 個の街があります。$ i $ 個目の街は、座標 $ (x_i,y_i) $ にあります。同じ座標に、複数の街があるかもしれません。

座標 $ (a,b) $ にある街と座標 $ (c,d) $ にある街の間に道を造るのには、$ min(|a-c|,|b-d|) $ 円かかります。街と街の間以外に、道を造ることはできません。

任意の $ 2 $ つの街の間を、道を何本か通って行き来できるようにするためは、最低で何円必要でしょうか。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ x_1 $ $ y_1 $ $ x_2 $ $ y_2 $ : $ x_N $ $ y_N $

## 输出格式

任意の $ 2 $ つの街の間を道を何本か通って行き来できるようにするためにかかるお金の最小値を出力せよ。

## 说明/提示

### 制約

- $ 2\ ≦\ N\ ≦\ 10^5 $
- $ 0\ ≦\ x_i,y_i\ ≦\ 10^9 $
- 入力は全て整数である

### Sample Explanation 1

街 $ 1 $ と $ 2 $ 、街 $ 2 $ と $ 3 $ の間に道を造ると、かかるお金は $ 2+1=3 $ 円になります。

## 样例 #1

### 输入

```
3

1 5

3 9

7 8
```

### 输出

```
3
```

## 样例 #2

### 输入

```
6

8 3

4 9

12 19

18 1

13 5

7 6
```

### 输出

```
8
```



---

---
title: "[ARC076E] Connected?"
layout: "post"
diff: 提高+/省选-
pid: AT_arc076_c
tag: []
---

# [ARC076E] Connected?

## 题目描述

[problemUrl]: https://atcoder.jp/contests/arc076/tasks/arc076_c

すぬけ君は、パズルゲームで遊んでいます。 このパズルゲームでは、$ R\ ×\ C $ の長方形の盤面に、$ 1 $ から $ N $ までの整数が $ 2 $ つずつ書かれています。 整数 $ i $ が書かれている座標は、$ (x_{i,1},y_{i,1}) $ と $ (x_{i,2},y_{i,2}) $ です。

すぬけ君の目的は、$ 1 $ から $ N $ までのすべての整数に対し、同じ整数の書かれている座標同士を曲線で結ぶことです。 このとき、曲線が長方形の外に出たり、互いに交わったりしてはいけません。

このようなことが可能かどうか判定してください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ R $ $ C $ $ N $ $ x_{1,1} $ $ y_{1,1} $ $ x_{1,2} $ $ y_{1,2} $ : $ x_{N,1} $ $ y_{N,1} $ $ x_{N,2} $ $ y_{N,2} $

## 输出格式

すぬけ君が目的を達成できるなら `YES` を、そうでないなら `NO` を出力せよ。

## 说明/提示

### 制約

- $ 1\ ≦\ R,C\ ≦\ 10^8 $
- $ 1\ ≦\ N\ ≦\ 10^5 $
- $ 0\ ≦\ x_{i,1},x_{i,2}\ ≦\ R(1\ ≦\ i\ ≦\ N) $
- $ 0\ ≦\ y_{i,1},y_{i,2}\ ≦\ C(1\ ≦\ i\ ≦\ N) $
- 与えられるどの $ 2 $ 点も異なる
- 入力は全て整数である

### Sample Explanation 1

!\[\](https://atcoder.jp/img/arc076/hogehogehoge.png) 上図のように整数同士を結べば、目的を達成することができます。

## 样例 #1

### 输入

```
4 2 3

0 1 3 1

1 1 4 1

2 0 2 2
```

### 输出

```
YES
```

## 样例 #2

### 输入

```
2 2 4

0 0 2 2

2 0 0 1

0 2 1 2

1 1 2 1
```

### 输出

```
NO
```

## 样例 #3

### 输入

```
5 5 7

0 0 2 4

2 3 4 5

3 5 5 2

5 5 5 4

0 3 5 1

2 2 4 4

0 5 4 1
```

### 输出

```
YES
```

## 样例 #4

### 输入

```
1 1 2

0 0 1 1

1 0 0 1
```

### 输出

```
NO
```



---

---
title: "[ARC077E] guruguru"
layout: "post"
diff: 提高+/省选-
pid: AT_arc077_c
tag: []
---

# [ARC077E] guruguru

## 题目描述

[problemUrl]: https://atcoder.jp/contests/arc077/tasks/arc077_c

snuke 君は明るさを $ m $ 段階に切り替えられる照明を買いに来ました。 この照明の 明るさは $ 1 $ 以上 $ m $ 以下の整数で表され、 リモコンに付いた $ 2 $ 種類のボタンで明るさを切り替えます。

$ 1 $ つめのボタンは「順送り」ボタンで、 明るさを $ 1 $ 増やすことができます。ただし、ボタンを押す前の明るさが最大の $ m $ である場合には、 明るさは $ 1 $ になります。

$ 2 $ つめのボタンは「お気に入り」ボタンで、 購入時に決めたお気に入りの明るさ $ x $ に切り替えることが出来ます。

snuke 君はお気に入りの明るさ $ x $ を、できるだけ効率的に明るさが切り替えられるように設定しようと考えました。 snuke 君は今後 $ n-1 $ 回明るさを切り替える予定で、$ i $ 回目には明るさ $ a_i $ から 明るさ $ a_{i+1} $ に切り替えようと計画しています。 最初、明るさは $ a_1 $ です。 ボタンを押す回数の合計が最小になるようにお気に入りの明るさ $ x $ を決めた時の ボタンを押す回数を求めて下さい。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ n $ $ m $ $ a_1 $ $ a_2 $ … $ a_n $

## 输出格式

ボタンを押す回数の合計の最小値を出力せよ。

## 说明/提示

### 制約

- $ 2\ \leq\ n,m\ \leq\ 10^5 $
- $ 1\ \leq\ a_i\leq\ m $
- $ a_i\ \neq\ a_{i+1} $
- $ n,m,a_i $ は整数である。

### Sample Explanation 1

お気に入りの明るさを $ 1,2,3,4,5,6 $ のそれぞれに設定したときのボタンを押す最小回数はそれぞれ $ 8,9,7,5,6,9 $ 回です。 よって、お気に入りの明るさを $ 4 $ に設定したときにボタンを押す回数の合計を最小に出来ます。 お気に入りの明るさを $ 4 $ に設定したときの切り替え方は以下のとおりです。 - $ 1 $ 回目には、お気に入りボタンを $ 1 $ 回押した後、順送りボタンを $ 1 $ 回押します。 - $ 2 $ 回目には、順送りボタンを $ 2 $ 回押します。 - $ 3 $ 回目には、お気に入りボタンを $ 1 $ 回押します。

## 样例 #1

### 输入

```
4 6

1 5 1 4
```

### 输出

```
5
```

## 样例 #2

### 输入

```
10 10

10 9 8 7 6 5 4 3 2 1
```

### 输出

```
45
```



---

---
title: "[ARC078E] Awkward Response"
layout: "post"
diff: 提高+/省选-
pid: AT_arc078_c
tag: []
---

# [ARC078E] Awkward Response

## 题目描述

[problemUrl]: https://atcoder.jp/contests/arc078/tasks/arc078_c

**これはインタラクティブな問題です。**

すぬけくんはお気に入りの正の整数 $ N $ を持っています。あなたは 「$ n $ はお気に入りの正の整数か？」と最大 $ 64 $ 回すぬけくんに質問することができます。 $ N $ を特定してください。

すぬけくんはひねくれ者なので「$ n $ はお気に入りの正の整数か？」と質問されたとき、$ n $ が以下の $ 2 $ つの条件のどちらかを満たすとき Yes と、それ以外のとき No と答えます。

- $ n\ \leq\ N $ かつ $ str(n)\ \leq\ str(N) $を満たす
- $ n\ >\ N $ かつ $ str(n)\ >\ str(N) $ を満たす

ここで、$ str(x) $ は正の整数 $ x $ を十進表記(先頭に $ 0 $ をつけない)の文字列として表したものです。例えば $ str(123)\ = $ `123`，$ str(2000) $ = `2000` です。 なお、この問題において文字列同士は辞書順で比較されます。例えば `11111` $ < $ `123`，`123456789` $ < $ `9` が成立します。

### Input &amp; Output Format

各質問は、標準出力に以下の形式で出力せよ：

> ? $ n $

ここで $ n $ は $ 1 $ 以上 $ 10^{18} $ 以下の整数でなければならない。

次に、質問の答えが標準入力から以下の形式で与えられる：

> $ ans $

ここで $ ans $ は `Y` または `N` である．`Y` ならば、質問の答えが Yes であることを、`N` ならば No であることを示す。

最後に、答えを以下の形式で出力せよ：

> ! $ n $

ここで $ n=N $ でなくてはならない。

## 说明/提示

### 制約

- $ 1\ \leq\ N\ \leq\ 10^{9} $

### ジャッジ

- **出力のあと、標準出力を flush せよ。**従わない場合 `TLE` の可能性がある。
- 答えを出力した後、プログラムをすぐに終了せよ。従わない場合のジャッジの挙動は定義されていない。
- 出力の答えが間違っている場合の挙動は定義されていない(`WA` とは限らない)。

### 入出力例

これは $ N=123 $ のときの入出力例です。

 Input Output  `? 1` `Y`   `? 32` `N`   `? 1010` `N`   `? 999` `Y`   `! 123`- $ 1\ \leq\ 123 $ かつ $ str(1)\ \leq\ str(123) $ なので答えは Yes です
- $ 32\ \leq\ 123 $ ですが、$ str(32)\ >\ str(123) $ なので答えは No です
- $ 1010\ >\ 123 $ ですが、$ str(1010)\ \leq\ str(123) $ なので答えは No です
- $ 999\ \geq\ 123 $ かつ $ str(999)\ >\ str(123) $ なので答えは Yes です
- $ N $ は $ 123 $ であると $ 4 $ 回の質問で回答できたため正解となります



---

---
title: "[ARC080E] Young Maids"
layout: "post"
diff: 提高+/省选-
pid: AT_arc080_c
tag: []
---

# [ARC080E] Young Maids

## 题目描述

[problemUrl]: https://atcoder.jp/contests/arc080/tasks/arc080_c

$ N $ を正の偶数とします。

$ (1,\ 2,\ ...,\ N) $ の順列 $ p\ =\ (p_1,\ p_2,\ ...,\ p_N) $ があります。 すぬけ君は、次の手続きによって $ (1,\ 2,\ ...,\ N) $ の順列 $ q $ を作ろうとしています。

まず、空の数列 $ q $ を用意します。 $ p $ が空になるまで、次の操作を繰り返します。

- $ p $ の隣り合う $ 2 $ つの要素を選び、順に $ x $, $ y $ とする。 $ x $, $ y $ を $ p $ から取り除き (このとき、$ p $ は $ 2 $ だけ短くなる)、$ x $, $ y $ をこの順のまま $ q $ の先頭へ追加する。

$ p $ が空になったとき、$ q $ は $ (1,\ 2,\ ...,\ N) $ の順列になっています。

辞書順で最小の $ q $ を求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ p_1 $ $ p_2 $ $ ... $ $ p_N $

## 输出格式

辞書順で最小の $ q $ を空白区切りで出力せよ。

## 说明/提示

### 制約

- $ N $ は偶数である。
- $ 2\ <\ =\ N\ <\ =\ 2\ ×\ 10^5 $
- $ p $ は $ (1,\ 2,\ ...,\ N) $ の順列である。

### Sample Explanation 1

次の順に操作を行えばよいです。 $ p $ $ q $ $ (3,\ 2,\ 4,\ 1) $ $ () $ ↓ ↓ $ (3,\ 1) $ $ (2,\ 4) $ ↓ ↓ $ () $ $ (3,\ 1,\ 2,\ 4) $

### Sample Explanation 3

次の順に操作を行えばよいです。 $ p $ $ q $ $ (4,\ 6,\ 3,\ 2,\ 8,\ 5,\ 7,\ 1) $ $ () $ ↓ ↓ $ (4,\ 6,\ 3,\ 2,\ 7,\ 1) $ $ (8,\ 5) $ ↓ ↓ $ (3,\ 2,\ 7,\ 1) $ $ (4,\ 6,\ 8,\ 5) $ ↓ ↓ $ (3,\ 1) $ $ (2,\ 7,\ 4,\ 6,\ 8,\ 5) $ ↓ ↓ $ () $ $ (3,\ 1,\ 2,\ 7,\ 4,\ 6,\ 8,\ 5) $

## 样例 #1

### 输入

```
4

3 2 4 1
```

### 输出

```
3 1 2 4
```

## 样例 #2

### 输入

```
2

1 2
```

### 输出

```
1 2
```

## 样例 #3

### 输入

```
8

4 6 3 2 8 5 7 1
```

### 输出

```
3 1 2 7 4 6 8 5
```



---

---
title: "[ARC083E] Bichrome Tree"
layout: "post"
diff: 提高+/省选-
pid: AT_arc083_c
tag: []
---

# [ARC083E] Bichrome Tree

## 题目描述

[problemUrl]: https://atcoder.jp/contests/arc083/tasks/arc083_c

$ N $ 頂点からなる木があります。頂点 $ 1 $ は木の根であり、頂点 $ i $ ($ 2\ ≦\ i\ ≦\ N $) の親は頂点 $ P_i $ です。

すぬけ君は、この木の各頂点に白または黒の色と非負整数の重みを割り当てることにしました。

すぬけ君にはお気に入りの数列 $ X_1,\ X_2,\ ...,\ X_N $ があります。そこで、色および重みの割り当てが、すべての $ v $ について以下の条件を満たすようにしたいと考えました。

- 頂点 $ v $ を根とする部分木に含まれる頂点のうち、頂点 $ v $ と同じ色であるものの重みの和は $ X_v $ である。

ここで、頂点 $ v $ を根とする部分木とは、頂点 $ v $ およびそのすべての子孫からなる木を指すものとします。

このような色および重みの割り当てが可能かどうか判定してください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ P_2 $ $ P_3 $ $ ... $ $ P_N $ $ X_1 $ $ X_2 $ $ ... $ $ X_N $

## 输出格式

条件を満たす色および重みの割り当てが可能である場合 `POSSIBLE` と、不可能である場合 `IMPOSSIBLE` と出力せよ。

## 说明/提示

### 制約

- $ 1\ ≦\ N\ ≦\ 1,000 $
- $ 1\ ≦\ P_i\ ≦\ i\ -\ 1 $
- $ 0\ ≦\ X_i\ ≦\ 5,000 $

### Sample Explanation 1

たとえば、以下のような色と重みの割り当ては条件を満たします。 - 頂点 $ 1 $ の色を白、重みを $ 2 $ とする。 - 頂点 $ 2 $ の色を黒、重みを $ 3 $ とする。 - 頂点 $ 3 $ の色を白、重みを $ 2 $ とする。 他にも条件を満たす割り当て方は存在します。

### Sample Explanation 2

頂点 $ 2 $ と頂点 $ 3 $ に同じ色を割り当てる場合、頂点 $ 2 $ に非負の重みを割り当てることができません。 頂点 $ 2 $ と頂点 $ 3 $ に異なる色を割り当てる場合、頂点 $ 1 $ にどちらの色を割り当てても、非負の重みを割り当てることができません。 よって、条件を満たす色および重みの割り当て方は存在しません。

## 样例 #1

### 输入

```
3

1 1

4 3 2
```

### 输出

```
POSSIBLE
```

## 样例 #2

### 输入

```
3

1 2

1 2 3
```

### 输出

```
IMPOSSIBLE
```

## 样例 #3

### 输入

```
8

1 1 1 3 4 5 5

4 1 6 2 2 1 3 3
```

### 输出

```
POSSIBLE
```

## 样例 #4

### 输入

```
1



0
```

### 输出

```
POSSIBLE
```



---

---
title: "[ARC084E] Finite Encyclopedia of Integer Sequences"
layout: "post"
diff: 提高+/省选-
pid: AT_arc084_c
tag: []
---

# [ARC084E] Finite Encyclopedia of Integer Sequences

## 题目描述

[problemUrl]: https://atcoder.jp/contests/arc084/tasks/arc084_c

有限整数列大辞典(Finite Encyclopedia of Integer Sequences)には、 $ 1 $ 以上 $ K $ 以下の整数からなる、長さ $ 1 $ 以上 $ N $ 以下の整数列がすべて載っています。

有限整数列大辞典に載っている整数列の個数が $ X $ 個あるとするとき、その中で辞書順で $ X/2 $ (小数点以下切り上げ)番目のものを求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ K $ $ N $

## 输出格式

有限整数列大辞典に載っている整数列の個数が $ X $ 個あるとするとき、 その中で辞書順で $ X/2 $ (小数点以下切り上げ)番目のものを、項ごとに空白で区切って出力せよ。

## 说明/提示

### 制約

- $ 1\ \leq\ K,N\ \leq\ 3\ ×\ 10^5 $
- $ N,K $ は整数である

### Sample Explanation 1

有限整数列大辞典に載っている整数列は、$ (1),(1,1),(1,2),(1,3),(2),(2,1),(2,2),(2,3),(3),(3,1),(3,2),(3,3) $ の $ 12 $ 個です。 この中で辞書順で $ 12/2\ =\ 6 $ 番目のものは、$ (2,1) $ です。

## 样例 #1

### 输入

```
3 2
```

### 输出

```
2 1
```

## 样例 #2

### 输入

```
2 4
```

### 输出

```
1 2 2 2
```

## 样例 #3

### 输入

```
5 14
```

### 输出

```
3 3 3 3 3 3 3 3 3 3 3 3 2 2
```



---

---
title: "[ARC087E] Prefix-free Game"
layout: "post"
diff: 提高+/省选-
pid: AT_arc087_c
tag: []
---

# [ARC087E] Prefix-free Game

## 题目描述

[problemUrl]: https://atcoder.jp/contests/arc087/tasks/arc087_c

文字列 $ s $, $ t $ について、$ s $ が $ t $ の prefix でなく、$ t $ が $ s $ の prefix でないとき、$ s $, $ t $ は prefix-free であると言います。

$ L $ を正の整数とします。 文字列集合 $ S $ が **良い文字列集合** であるとは、次の条件が成り立つことです。

- $ S $ の各文字列は、長さ $ 1 $ 以上 $ L $ 以下であり、文字 `0`, `1` のみからなる。
- $ S $ の相異なる $ 2 $ つの文字列のペアはいずれも prefix-free である。

良い文字列集合 $ S\ =\ \{\ s_1,\ s_2,\ ...,\ s_N\ \} $ があります。 Alice と Bob が次のゲームで勝負します。 二人は交互に次の操作を行います。 Alice が先手です。

- $ S $ に新しい文字列をひとつ追加する。 ただし、追加後の $ S $ は良い文字列集合のままでなければならない。

先に操作を行えなくなった方が負けです。 二人が最適に行動するとき、どちらが勝つか判定してください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ L $ $ s_1 $ $ s_2 $ $ : $ $ s_N $

## 输出格式

Alice が勝つならば `Alice` を、Bob が勝つならば `Bob` を出力せよ。

## 说明/提示

### 制約

- $ 1\ \leq\ N\ \leq\ 10^5 $
- $ 1\ \leq\ L\ \leq\ 10^{18} $
- $ s_1 $, $ s_2 $, ..., $ s_N $ はすべて相異なる。
- $ \{\ s_1,\ s_2,\ ...,\ s_N\ \} $ は良い文字列集合である。
- $ |s_1|\ +\ |s_2|\ +\ ...\ +\ |s_N|\ \leq\ 10^5 $

### Sample Explanation 1

Alice が `1` を追加すると、Bob は新たに文字列を追加できなくなります。

### Sample Explanation 2

初手で Alice が追加できる文字列は `01`, `10` の $ 2 $ 通りです。 初手で Alice が `01` を追加した場合は、Bob が `10` を追加すると、Alice は新たに文字列を追加できなくなります。 初手で Alice が `10` を追加した場合も、Bob が `01` を追加すると、Alice は新たに文字列を追加できなくなります。

### Sample Explanation 3

Alice が `111` を追加すると、Bob は新たに文字列を追加できなくなります。

### Sample Explanation 4

初手で Alice は新たに文字列を追加できません。

## 样例 #1

### 输入

```
2 2

00

01
```

### 输出

```
Alice
```

## 样例 #2

### 输入

```
2 2

00

11
```

### 输出

```
Bob
```

## 样例 #3

### 输入

```
3 3

0

10

110
```

### 输出

```
Alice
```

## 样例 #4

### 输入

```
2 1

0

1
```

### 输出

```
Bob
```

## 样例 #5

### 输入

```
1 2

11
```

### 输出

```
Alice
```

## 样例 #6

### 输入

```
2 3

101

11
```

### 输出

```
Bob
```



---

---
title: "[ARC088E] Papple Sort"
layout: "post"
diff: 提高+/省选-
pid: AT_arc088_c
tag: []
---

# [ARC088E] Papple Sort

## 题目描述

[problemUrl]: https://atcoder.jp/contests/arc088/tasks/arc088_c

英小文字からなる文字列 $ S $ が与えられます。 隣り合う $ 2 $ つの文字を入れ替える操作を繰り返して $ S $ を回文にできるかどうか判定し、できる場合は操作の最小回数を求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ S $

## 输出格式

回文にできない場合、`-1` を出力せよ。そうでない場合、操作の最小回数を出力せよ。

## 说明/提示

### 制約

- $ 1\ \leq\ |S|\ \leq\ 2\ ×\ 10^5 $
- $ S $ は英小文字からなる

### Sample Explanation 1

以下の操作で、$ S $ を回文にすることができます。 - $ 2 $ 文字目と $ 3 $ 文字目を入れ替える。新しい $ S $ は `ele` となる。

### Sample Explanation 2

以下の操作で、$ S $ を回文にすることができます。 - $ 5 $ 文字目と $ 6 $ 文字目を入れ替える。新しい $ S $ は `ataamtma` となる。 - $ 4 $ 文字目と $ 5 $ 文字目を入れ替える。新しい $ S $ は `atamatma` となる。 - $ 3 $ 文字目と $ 4 $ 文字目を入れ替える。新しい $ S $ は `atmaatma` となる。 - $ 2 $ 文字目と $ 3 $ 文字目を入れ替える。新しい $ S $ は `amtaatma` となる。

### Sample Explanation 3

$ S $ を回文にすることはできません。

## 样例 #1

### 输入

```
eel
```

### 输出

```
1
```

## 样例 #2

### 输入

```
ataatmma
```

### 输出

```
4
```

## 样例 #3

### 输入

```
snuke
```

### 输出

```
-1
```



---

---
title: "[ARC088F] Christmas Tree"
layout: "post"
diff: 提高+/省选-
pid: AT_arc088_d
tag: []
---

# [ARC088F] Christmas Tree

## 题目描述

给定一棵 $N$ 个节点的树。用如下方法生成一棵与其相同的树：

- 首先生成 $A$ 个边数均不超过 $B$ 的链。
- 重复以下操作直到所有的点连通：
  - 选择两个当前属于不同连通块的点，将这两个点合并为一个点，所有原来与这两个点中的至少一个点有边的点与这个新点有边。
- 将点重新标号。

求出能够生成给定树的最小的 $A$ 值，在最小化 $A$ 的基础上最小化 $B$ 值。

对于 $100 \%$ 的数据，$2\le N\le 10^5$。

## 输入格式

第一行输入 $N$，随后 $N-1$ 行每行两个整数描述一条边。

## 输出格式

输出一行两个整数，题目所求的 $A$ 和 $B$。

## 样例 #1

### 输入

```
7

1 2

2 3

2 4

4 5

4 6

6 7
```

### 输出

```
3 2
```

## 样例 #2

### 输入

```
8

1 2

2 3

3 4

4 5

5 6

5 7

5 8
```

### 输出

```
2 5
```

## 样例 #3

### 输入

```
10

1 2

2 3

3 4

2 5

6 5

6 7

7 8

5 9

10 5
```

### 输出

```
3 4
```



---

---
title: "[ABC086D] Checker"
layout: "post"
diff: 提高+/省选-
pid: AT_arc089_b
tag: []
---

# [ABC086D] Checker

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc086/tasks/arc089_b

シカのAtCoDeerくんは無限に広がる二次元グリッドを一辺が $ K $ の市松模様で塗ろうと考えています。 ただし、一辺が $ K $ の市松模様とは、各マスが白か黒で塗られたパターンであって、各色の各連結成分が $ K $ $ × $ $ K $ の正方形となっているようなものです。 例えば以下は一辺が $ 3 $ の市松模様の例です。

 ![cba927b2484fad94fb5ff7473e9aadef.png](https://cdn.luogu.com.cn/upload/vjudge_pic/AT_arc089_b/f249ddb0b7d4831bdbfc799a6785c179fe0b5887.png)

AtCoDeerくんは $ N $ 個の希望を持っています。 $ i $ 個目の希望は、 $ x_i,y_i,c_i $ で表されます。 これは、$ c_i $ が `B` ならマス $ (x_i,y_i) $ を黒で塗る、 `W` なら白で塗ることを意味しています。 同時に最大でいくつの希望を叶えることが出来るか答えてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ K $ $ x_1 $ $ y_1 $ $ c_1 $ $ x_2 $ $ y_2 $ $ c_2 $ $ : $ $ x_N $ $ y_N $ $ c_N $

## 输出格式

同時に叶えられる希望の個数の最大値を出力せよ。

## 说明/提示

### 制約

- $ 1 $ $ <\ = $ $ N $ $ <\ = $ $ 10^5 $
- $ 1 $ $ <\ = $ $ K $ $ <\ = $ $ 1000 $
- $ 0 $ $ <\ = $ $ x_i $ $ <\ = $ $ 10^9 $
- $ 0 $ $ <\ = $ $ y_i $ $ <\ = $ $ 10^9 $
- $ i $ $ ≠ $ $ j $ なら $ (x_i,y_i) $ $ ≠ $ $ (x_j,y_j) $
- $ c_i $ は `B` または `W`
- $ N,K,x_i,y_i $ は整数

### Sample Explanation 1

上であげた例のように塗ればすべての希望を同時に叶えることができます。

## 样例 #1

### 输入

```
4 3

0 1 W

1 2 W

5 3 B

5 4 B
```

### 输出

```
4
```

## 样例 #2

### 输入

```
2 1000

0 0 B

0 1 W
```

### 输出

```
2
```

## 样例 #3

### 输入

```
6 2

1 2 B

2 1 W

2 2 B

1 0 B

0 6 W

4 5 W
```

### 输出

```
4
```



---

---
title: "[ARC091E] LISDL"
layout: "post"
diff: 提高+/省选-
pid: AT_arc091_c
tag: []
---

# [ARC091E] LISDL

## 题目描述

[problemUrl]: https://atcoder.jp/contests/arc091/tasks/arc091_c

$ 1,2,...,N $ を並べ替えてできる列であって、以下の条件を満たすものがあるかどうか判定し、あればその例をひとつ構成してください。

- 最長増加部分列の長さは $ A $ である
- 最長減少部分列の長さは $ B $ である

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ A $ $ B $

## 输出格式

条件を満たす列が存在しない場合、`-1` を出力せよ。

そうでない場合、整数を $ N $ 個出力せよ。 $ i $ 個目には、構成した列の $ i $ 番目の要素を出力せよ。

## 说明/提示

### 注釈

列 $ P $ の部分列とは $ P $ の要素をいくつか抜き出して元の順に並べてできる列のことを指し、 また、列 $ P $ の最長増加部分列とは、$ P $ の単調増加な部分列の中で列の長さが最大のものを指します。

同様に、列 $ P $ の最長減少部分列とは、$ P $ の単調減少な部分列の中で列の長さが最大のものを指します。

### 制約

- $ 1\ \leq\ N,A,B\ \leq\ 3\times\ 10^5 $
- 入力はすべて整数である

### Sample Explanation 1

$ {2,4,5} $ が最長増加部分列の一例、$ {4,3} $ が最長減少部分列の一例です。

## 样例 #1

### 输入

```
5 3 2
```

### 输出

```
2 4 1 5 3
```

## 样例 #2

### 输入

```
7 7 1
```

### 输出

```
1 2 3 4 5 6 7
```

## 样例 #3

### 输入

```
300000 300000 300000
```

### 输出

```
-1
```



---

---
title: "[ABC091D] Two Sequences"
layout: "post"
diff: 提高+/省选-
pid: AT_arc092_b
tag: []
---

# [ABC091D] Two Sequences

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc091/tasks/arc092_b

$ 2 $ つの長さ $ N $ の非負整数列 $ a_1,\ ...,\ a_N,\ b_1,\ ...,\ b_N $ が与えられます。

$ 1\ \leq\ i,\ j\ \leq\ N $ となるように整数 $ i,\ j $ を選ぶ方法は $ N^2 $ 通りありますが，この $ N^2 $ 通りの $ i,\ j $ それぞれについて，$ a_i\ +\ b_j $ を計算し，紙に書き出します。 つまり，紙に $ N^2 $ 個の整数を書きます。

この $ N^2 $ 個の整数のxorを計算してください。

xorの説明

整数 $ c_1,\ c_2,\ ...,\ c_m $ のxor $ X $ は，以下のように定義されます。

- $ X $ を $ 2 $ 進数表記したときの $ 2^k $($ 0\ \leq\ k $, $ k $ は整数)の位の値は，$ c_1,\ c_2,\ ...c_m $ のうち，$ 2 $ 進数表記したときの $ 2^k $ の位の値が $ 1 $ となるものの個数が奇数個ならば $ 1 $，偶数個ならば $ 0 $ となります

例えば，$ 3 $ と $ 5 $ のxorの値は，$ 3 $ の $ 2 $ 進数表記が $ 011 $，$ 5 $ の $ 2 $ 進数表記が $ 101 $ のため，$ 2 $ 進数表記が $ 110 $ の $ 6 $ となります。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ a_1 $ $ a_2 $ $ ... $ $ a_N $ $ b_1 $ $ b_2 $ $ ... $ $ b_N $

## 输出格式

求めた結果を出力せよ。

## 说明/提示

### 制約

- 入力は全て整数
- $ 1\ \leq\ N\ \leq\ 200,000 $
- $ 0\ \leq\ a_i,\ b_i\ <\ 2^{28} $

### Sample Explanation 1

紙には $ 4(1+3),\ 5(1+4),\ 5(2+3),\ 6(2+4) $ の $ 2^2\ =\ 4 $ つの数が書かれます。

## 样例 #1

### 输入

```
2

1 2

3 4
```

### 输出

```
2
```

## 样例 #2

### 输入

```
6

4 6 0 0 3 3

0 5 6 5 0 3
```

### 输出

```
8
```

## 样例 #3

### 输入

```
5

1 2 3 4 5

1 2 3 4 5
```

### 输出

```
2
```

## 样例 #4

### 输入

```
1

0

0
```

### 输出

```
0
```



---

---
title: "[ARC092E] Both Sides Merger"
layout: "post"
diff: 提高+/省选-
pid: AT_arc092_c
tag: []
---

# [ARC092E] Both Sides Merger

## 题目描述

[problemUrl]: https://atcoder.jp/contests/arc092/tasks/arc092_c

あなたは，長さ $ N $ の数列 $ a_1,\ a_2,\ ...,\ a_N $ を持っています。

あなたは，この数列の長さが $ 1 $ になるまで，繰り返し以下の操作を行います。

- まず，数列の要素を $ 1 $ つ選ぶ。
- もしその要素が数列の端だった場合，その要素を削除する。
- もしその要素が数列の端でない場合，その要素を，選んだ要素の両隣の要素の和に書き換える。そしてその後，両隣の要素を削除する。

あなたは，最終的な数列の要素の値を最大化したいです。

最終的な数列の要素の値の最大値と，それを達成する手順を求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ a_1 $ $ a_2 $ $ ... $ $ a_N $

## 输出格式

- $ 1 $ 行目には，最終的な数列の要素の値の最大値を出力せよ。
- $ 2 $ 行目には，操作の回数を出力せよ。
- $ 2+i $ 行目には，$ i $ 回目の操作で選ぶ要素が，その時点の数列で左から何番目かを出力せよ。
- 最大値を達成する手順が複数存在する場合，そのうちどれを出力しても良い。

## 说明/提示

### 制約

- 入力は全て整数
- $ 2\ \leq\ N\ \leq\ 1000 $
- $ |a_i|\ \leq\ 10^9 $

### Sample Explanation 1

数列は以下のように変化します。 - $ 1 $ 回目の操作後の数列 : $ 4,\ 3,\ 7,\ 5 $ - $ 2 $ 回目の操作後の数列 : $ 4,\ 3,\ 7 $ - $ 3 $ 回目の操作後の数列 : $ 11(4+7) $

### Sample Explanation 2

\- $ 1 $ 回目の操作後の数列 : $ 100,\ 200(100+100) $ - $ 2 $ 回目の操作後の数列 : $ 200 $

### Sample Explanation 3

\- $ 1 $ 回目の操作後の数列 : $ -4,\ 1,\ 2,\ 3 $ - $ 2 $ 回目の操作後の数列 : $ 1,\ 2,\ 3 $ - $ 3 $ 回目の操作後の数列 : $ 4 $

## 样例 #1

### 输入

```
5

1 4 3 7 5
```

### 输出

```
11

3

1

4

2
```

## 样例 #2

### 输入

```
4

100 100 -1 100
```

### 输出

```
200

2

3

1
```

## 样例 #3

### 输入

```
6

-1 -2 -3 1 2 3
```

### 输出

```
4

3

2

1

2
```

## 样例 #4

### 输入

```
9

1000000000 1000000000 1000000000 1000000000 1000000000 1000000000 1000000000 1000000000 1000000000
```

### 输出

```
5000000000

4

2

2

2

2
```



---

---
title: "[ARC097E] Sorted and Sorted"
layout: "post"
diff: 提高+/省选-
pid: AT_arc097_c
tag: []
---

# [ARC097E] Sorted and Sorted

## 题目描述

[problemUrl]: https://atcoder.jp/contests/arc097/tasks/arc097_c

それぞれ $ 1 $ から $ N $ の整数が $ 1 $ つずつ書かれた白いボールと黒いボールが合わせて $ 2N $ 個一列に並んでいます。 左から $ i $ ($ 1 $ $ <\ = $ $ i $ $ <\ = $ $ 2N $) 個目のボールに書いてある数は $ a_i $ で、色は $ c_i $ で表されます。 $ c_i $ $ = $ `W` のとき ボールが白いことを、$ c_i $ $ = $ `B` のとき ボールが黒いことを表します。

人間の高橋君は次のような目標を達成したいです。

- $ 1 $ $ <\ = $ $ i $ $ j $ $ <\ = $ $ N $ を満たす任意の整数の組 $ (i,j) $ に対して、$ i $ が書かれた白いボールの方が $ j $ が書かれた白いボールより左にある
- $ 1 $ $ <\ = $ $ i $ $ j $ $ <\ = $ $ N $ を満たす任意の整数の組 $ (i,j) $ に対して、$ i $ が書かれた黒いボールの方が $ j $ が書かれた黒いボールより左にある

目標を達成するために高橋君は次のような操作ができます。

- 隣り合う二つのボールをスワップする

目標を達成するために必要な操作回数の最小値を求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ c_1 $ $ a_1 $ $ c_2 $ $ a_2 $ $ : $ $ c_{2N} $ $ a_{2N} $

## 输出格式

目標を達成するために必要な操作回数の最小値を出力せよ。

## 说明/提示

### 制約

- $ 1 $ $ <\ = $ $ N $ $ <\ = $ $ 2000 $
- $ 1 $ $ <\ = $ $ a_i $ $ <\ = $ $ N $
- $ c_i $ $ = $ `W` または $ c_i $ $ = $ `B`
- $ i $ $ ≠ $ $ j $ なら、 $ (a_i,c_i) $ $ ≠ $ $ (a_j,c_j) $

### Sample Explanation 1

例えば次のようにすると $ 4 $ 回で可能です。 - 黒の $ 3 $ と白の $ 1 $ をスワップ - 白の $ 1 $ と白の $ 2 $ をスワップ - 黒の $ 3 $ と白の $ 3 $ をスワップ - 黒の $ 3 $ と黒の $ 2 $ をスワップ

## 样例 #1

### 输入

```
3

B 1

W 2

B 3

W 1

W 3

B 2
```

### 输出

```
4
```

## 样例 #2

### 输入

```
4

B 4

W 4

B 3

W 3

B 2

W 2

B 1

W 1
```

### 输出

```
18
```

## 样例 #3

### 输入

```
9

W 3

B 1

B 4

W 1

B 5

W 9

W 2

B 6

W 5

B 3

W 8

B 9

W 7

B 2

B 8

W 4

W 6

B 7
```

### 输出

```
41
```



---

---
title: "[ARC098E] Range Minimum Queries"
layout: "post"
diff: 提高+/省选-
pid: AT_arc098_c
tag: []
---

# [ARC098E] Range Minimum Queries

## 题目描述

你有一个长度为 $n$ 的整数序列 $A$，以及一个整数 $K$。你会进行 $Q$ 次操作，一次操作如下：



- 选择序列中一个长度为 $K$ 的区间，并且删除区间中的最小元素。如果有多个，你可以选择任何一个。   

   

现在，设 $X$ 是你删除了的元素中最大的一个，$Y$ 是最小的一个，请找出在最优情况下，$X-Y$ 的最小值。

## 输入格式

请从标准输入中读入：  

 $ N $   $ K $   $ Q $   

 $ A_1 $   $ A_2 $   $ ... $   $ A_N $

## 输出格式

请输出 $X-Y$ 可能的最小值。   

## 限制

- $1\le K\le N\le 2000$   

- $1\le Q\le N-K+1$  

- $1\le A_i\le 10^9$

- 输入都是整数

## 样例 #1

### 输入

```
5 3 2

4 3 1 5 2
```

### 输出

```
1
```

## 样例 #2

### 输入

```
10 1 6

1 1 2 3 5 8 13 21 34 55
```

### 输出

```
7
```

## 样例 #3

### 输入

```
11 7 5

24979445 861648772 623690081 433933447 476190629 262703497 211047202 971407775 628894325 731963982 822804784
```

### 输出

```
451211184
```



---

---
title: "[ABC101D] Snuke Numbers"
layout: "post"
diff: 提高+/省选-
pid: AT_arc099_b
tag: []
---

# [ABC101D] Snuke Numbers

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc101/tasks/arc099_b

整数 $ n $ に対して，$ n $ を十進法で表したときの各桁の和を $ S(n) $ で表すことにします． たとえば，$ S(123)\ =\ 1\ +\ 2\ +\ 3\ =\ 6 $ です．

正の整数 $ n $ であって，$ m\ >\ n $ であるような任意の正の整数 $ m $ に対して $ \frac{n}{S(n)}\ \leq\ \frac{m}{S(m)} $ が成り立つようなものを， **すぬけ数** と呼ぶことにします．

整数 $ K $ が与えられたとき，すぬけ数を小さいほうから $ K $ 個列挙してください．

## 输入格式

入力は以下の形式で標準入力から与えられる．

> $ K $

## 输出格式

$ K $ 行出力せよ．$ i $ 行目には，$ i $ 番目に小さいすぬけ数を出力せよ．

## 说明/提示

### 制約

- $ 1\ \leq\ K $
- $ K $ 番目のすぬけ数は $ 10^{15} $ 以下

## 样例 #1

### 输入

```
10
```

### 输出

```
1

2

3

4

5

6

7

8

9

19
```



---

---
title: "[ARC100E] Or Plus Max"
layout: "post"
diff: 提高+/省选-
pid: AT_arc100_c
tag: []
---

# [ARC100E] Or Plus Max

## 题目描述

[problemUrl]: https://atcoder.jp/contests/arc100/tasks/arc100_c

長さ $ 2^N $ の整数列 $ A_0,\ A_1,\ ...,\ A_{2^N-1} $ があります。（添字が $ 0 $ から始まることに注意）

$ 1\ \leq\ K\ \leq\ 2^N-1 $ を満たすすべての整数 $ K $ について、次の問題を解いてください。

- $ i,j $ を整数とする。$ 0\ \leq\ i\ <\ j\ \leq\ 2^N-1 $, $ (i $ $ or $ $ j)\ \leq\ K $ のとき、$ A_i\ +\ A_j $ の最大値を求めよ。 ただしここで $ or $ はビットごとの論理和を表す。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ A_0 $ $ A_1 $ $ ... $ $ A_{2^N-1} $

## 输出格式

$ 2^N-1 $ 行出力せよ。 $ i $ 行目には、$ K=i $ のときの上記の問題の答えを出力せよ。

## 说明/提示

### 制約

- $ 1\ \leq\ N\ \leq\ 18 $
- $ 1\ \leq\ A_i\ \leq\ 10^9 $
- 入力はすべて整数である。

### Sample Explanation 1

$ K=1 $ のとき、$ i,j $ としてあり得る組合せは $ (i,j)=(0,1) $ のみなので、答えは $ A_0+A_1=1+2=3 $ となります。 $ K=2 $ のとき、$ i,j $ としてあり得る組合せは $ (i,j)=(0,1),(0,2) $ です。 $ (i,j)=(0,2) $ のとき、$ A_i+A_j=1+3=4 $ となり、これが最大なので、答えは $ 4 $ です。 $ K=3 $ のとき、$ i,j $ としてあり得る組合せは $ (i,j)=(0,1),(0,2),(0,3),(1,2),(1,3),(2,3) $ です。 $ (i,j)=(1,2) $ のとき、$ A_i+A_j=2+3=5 $ となり、これが最大なので、答えは $ 5 $ です。

## 样例 #1

### 输入

```
2

1 2 3 1
```

### 输出

```
3

4

5
```

## 样例 #2

### 输入

```
3

10 71 84 33 6 47 23 25
```

### 输出

```
81

94

155

155

155

155

155
```

## 样例 #3

### 输入

```
4

75 26 45 72 81 47 97 97 2 2 25 82 84 17 56 32
```

### 输出

```
101

120

147

156

156

178

194

194

194

194

194

194

194

194

194
```



---

---
title: "[ABC107D] Median of Medians"
layout: "post"
diff: 提高+/省选-
pid: AT_arc101_b
tag: []
---

# [ABC107D] Median of Medians

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc107/tasks/arc101_b

長さ $ M $ の数列 $ b $ の **中央値** を次のように定義します。

- $ b $ を昇順にソートして得られる数列を $ b' $ とする。 このとき、$ b' $ の $ M\ /\ 2\ +\ 1 $ 番目の要素の値を、$ b $ の中央値とする。 ここで、$ / $ は小数点以下を切り捨てる除算である。

例えば、$ (10,\ 30,\ 20) $ の中央値は $ 20 $ であり、$ (10,\ 30,\ 20,\ 40) $ の中央値は $ 30 $ であり、$ (10,\ 10,\ 10,\ 20,\ 30) $ の中央値は $ 10 $ です。

すぬけ君は次のような問題を思いつきました。

長さ $ N $ の数列 $ a $ があります。 各 $ (l,\ r) $ ($ 1\ \leq\ l\ \leq\ r\ \leq\ N $) について、$ a $ の連続部分列 $ (a_l,\ a_{l\ +\ 1},\ ...,\ a_r) $ の中央値を $ m_{l,\ r} $ とします。 すべての $ (l,\ r) $ に対する $ m_{l,\ r} $ を並べ、新たに数列 $ m $ を作ります。 $ m $ の中央値を求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ a_1 $ $ a_2 $ $ ... $ $ a_N $

## 输出格式

$ m $ の中央値を出力せよ。

## 说明/提示

### 制約

- $ 1\ \leq\ N\ \leq\ 10^5 $
- $ a_i $ は整数である。
- $ 1\ \leq\ a_i\ \leq\ 10^9 $

### Sample Explanation 1

$ a $ のそれぞれの連続部分列の中央値は次のようになります。 - $ (10) $ の中央値は $ 10 $ - $ (30) $ の中央値は $ 30 $ - $ (20) $ の中央値は $ 20 $ - $ (10,\ 30) $ の中央値は $ 30 $ - $ (30,\ 20) $ の中央値は $ 30 $ - $ (10,\ 30,\ 20) $ の中央値は $ 20 $ よって、$ m\ =\ (10,\ 30,\ 20,\ 30,\ 30,\ 20) $ となり、$ m $ の中央値は $ 30 $ です。

## 样例 #1

### 输入

```
3

10 30 20
```

### 输出

```
30
```

## 样例 #2

### 输入

```
1

10
```

### 输出

```
10
```

## 样例 #3

### 输入

```
10

5 9 5 9 8 9 3 5 4 3
```

### 输出

```
8
```



---

---
title: "[ABC108D] All Your Paths are Different Lengths"
layout: "post"
diff: 提高+/省选-
pid: AT_arc102_b
tag: []
---

# [ABC108D] All Your Paths are Different Lengths

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc108/tasks/arc102_b

整数 $ L $ が与えられます。以下の条件を満たす有向グラフをひとつ構成してください。構成したグラフに多重辺が含まれていても構いません。 なお、条件を満たす有向グラフは必ず存在することが証明できます。

- 頂点数 $ N $ は $ 20 $ 以下で、すべての頂点には $ 1 $ 以上 $ N $ 以下の相異なる番号が付けられている
- 辺数 $ M $ は $ 60 $ 以下で、すべての辺には $ 0 $ 以上 $ 10^6 $ 以下の整数の長さが付けられている
- 全ての辺は番号の小さい方の頂点から大きい方の頂点に向かって向きづけられている。すなわち、$ 1,2,...,N $ はこのグラフの頂点の番号を適当なトポロジカル順序で並べてできる列である
- 頂点 $ 1 $ から頂点 $ N $ への異なるパスはちょうど $ L $ 個あり、それらの長さは $ 0 $ から $ L-1 $ までの相異なる整数である

ただし、パスの長さとは、そのパス上の辺の長さの和を表します。また、$ 2 $ つのパスが異なるとは、パス上の辺の集合が異なることを指します。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ L $

## 输出格式

$ 1 $ 行目には、構成したグラフの頂点数 $ N $ と辺数 $ M $ を出力せよ。 続く $ M $ 行のうちの $ i $ 行目には、$ 3 $ つの整数 $ u_i,v_i,w_i $ を出力せよ。これらはそれぞれ、$ i $ 本目の辺の始点、$ i $ 本目の辺の終点、$ i $ 本目の辺の長さを表す。 解が複数考えられる場合、どれを出力してもよい。

## 说明/提示

### 制約

- $ 2\ \leq\ L\ \leq\ 10^6 $
- $ L $ は整数である

### Sample Explanation 1

出力例のグラフには 頂点 $ 1 $ から $ N=8 $ への $ 4 $ 本のパスがあり、 - パス $ 1 $ → $ 2 $ → $ 3 $ → $ 4 $ → $ 8 $ の長さは $ 0 $ - パス $ 1 $ → $ 2 $ → $ 3 $ → $ 7 $ → $ 8 $ の長さは $ 1 $ - パス $ 1 $ → $ 2 $ → $ 6 $ → $ 7 $ → $ 8 $ の長さは $ 2 $ - パス $ 1 $ → $ 5 $ → $ 6 $ → $ 7 $ → $ 8 $ の長さは $ 3 $ となります。これ以外にも、正答として認められる出力があります。

## 样例 #1

### 输入

```
4
```

### 输出

```
8 10

1 2 0

2 3 0

3 4 0

1 5 0

2 6 0

3 7 0

4 8 0

5 6 1

6 7 1

7 8 1
```

## 样例 #2

### 输入

```
5
```

### 输出

```
5 7

1 2 0

2 3 1

3 4 0

4 5 0

2 4 0

1 3 3

3 5 1
```



---

---
title: "[ARC103E] Tr/ee"
layout: "post"
diff: 提高+/省选-
pid: AT_arc103_c
tag: []
---

# [ARC103E] Tr/ee

## 题目描述

[problemUrl]: https://atcoder.jp/contests/arc103/tasks/arc103_c

長さ $ n $ の文字列 $ s $ が与えられます。 以下の条件を満たす $ n $ 頂点の木は存在するでしょうか？

- 各頂点には $ 1,2,...,\ n $ の番号が付けられている
- 各辺には $ 1,2,...,\ n-1 $ の番号が付けられていて、$ i $ 番目の辺は 頂点 $ u_i $ と $ v_i $ をつないでいる
- $ s $ の $ i $ 番目の文字が `1` であるとき、 木からある辺を $ 1 $ つ取り除くことで、サイズ $ i $ の連結成分が作れる
- $ s $ の $ i $ 番目の文字が `0` であるとき、 木からどのように辺を $ 1 $ つ取り除いてもサイズ $ i $ の連結成分が作れない

条件を満たす木が存在する場合、$ 1 $ つ構築してください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ s $

## 输出格式

条件を満たす $ n $ 頂点の木が存在しない場合、`-1` と出力してください。

条件を満たす $ n $ 頂点の木が存在する場合、 $ n-1 $ 行出力してください。 $ i $ 行目には $ u_i,v_i $ を空白区切りで出力してください。 複数の木が条件を満たす場合、どれを出力しても構いません。

## 说明/提示

### 制約

- $ 2\leq\ n\ \leq\ 10^5 $
- $ s $ は `0` と `1` からなる長さ $ n $ の文字列

### Sample Explanation 1

$ n $ 頂点の木から辺を $ 1 $ つ取り除いてサイズ $ n $ の連結成分を作ることはできません。

### Sample Explanation 2

$ 1 $ 番目の辺または $ 3 $ 番目の辺を取り除くと、サイズ $ 1 $ の連結成分とサイズ $ 3 $ の連結成分ができます。 $ 2 $ 番目の辺を取り除くと、サイズ $ 2 $ の連結成分が $ 2 $ つできます。

### Sample Explanation 3

どの辺を取り除いても、サイズ $ 1 $ の連結成分とサイズ $ 3 $ の連結成分ができます。

## 样例 #1

### 输入

```
1111
```

### 输出

```
-1
```

## 样例 #2

### 输入

```
1110
```

### 输出

```
1 2

2 3

3 4
```

## 样例 #3

### 输入

```
1010
```

### 输出

```
1 2

1 3

1 4
```



---

---
title: "[ARC104C] Fair Elevator"
layout: "post"
diff: 提高+/省选-
pid: AT_arc104_c
tag: []
---

# [ARC104C] Fair Elevator

## 题目描述

[problemUrl]: https://atcoder.jp/contests/arc104/tasks/arc104_c

下の階から順に $ 1,\ 2,\ \ldots,\ 2N $ の番号がついた $ 2N $ 階から成る建物があります。

この建物のエレベーターが $ 1 $ 度だけ $ 1 $ 階から $ 2N $ 階まで動きました。

この途中で、 $ N $ 人が乗り降りしました。人 $ i\ (1\ \leq\ i\ \leq\ N) $ は、それぞれエレベーターに $ A_i $ 階で乗り、$ B_i $ 階で降りました。ただし、$ 1\ \leq\ A_i\ <\ B_i\ \leq\ 2N $ であり、それぞれの階で乗り降りした人はただ $ 1 $ 人です。

また、この $ N $ 人は気難しいため、以下の条件が満たされていました。

- 人 $ i\ (1\ \leq\ i\ \leq\ N) $ がエレベーターに乗っているとき、他の人が乗り降りした回数を $ C_i\ (=\ B_i\ -\ A_i\ -\ 1) $ で表すと、次の条件が成り立つ
  - 人 $ i $ と人 $ j $ が同時にエレベーターに乗っていた瞬間が存在するならば、$ C_i\ =\ C_j $ である

$ A,\ B $ は記録されていましたが、残念なことに、記録の一部が消えてしまいました。$ A_i,\ B_i $ が消えている場合は $ -1 $ として与えられます。

また、残っている記録も誤っている可能性があります。

残っている記録に矛盾しないような $ A,\ B $ の組み合わせが存在するかどうか判定してください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ A_1 $ $ B_1 $ $ A_2 $ $ B_2 $ $ : $ $ A_N $ $ B_N $

## 输出格式

残っている記録に矛盾しないような $ A,\ B $ の組み合わせが存在する場合は `Yes` を、しない場合は `No` を出力せよ。

## 说明/提示

### 制約

- $ 1\ \leq\ N\ \leq\ 100 $
- $ A_i\ =\ -1 $ または $ 1\ \leq\ A_i\ \leq\ 2N $
- $ B_i\ =\ -1 $ または $ 1\ \leq\ B_i\ \leq\ 2N $
- 入力は全て整数である

### Sample Explanation 1

例えば、$ B_1\ =\ 3,\ A_2\ =\ 2,\ A_3\ =\ 5 $ であった場合、全ての条件を満たします。 この場合、人 $ 1,\ 2 $ が同時にエレベーターに乗っている瞬間がありますが、$ C_1\ =\ C_2\ =\ 1 $ であるので問題ありません。

### Sample Explanation 2

人 $ 1,\ 2 $ が同時にエレベーターに乗っている瞬間がありますが、$ C_1\ =\ 2,\ C_2\ =\ 0 $ なのでいずれかの情報が誤っています。

### Sample Explanation 3

記録は全て残っているように見えますが、明らかに誤っています。

## 样例 #1

### 输入

```
3

1 -1

-1 4

-1 6
```

### 输出

```
Yes
```

## 样例 #2

### 输入

```
2

1 4

2 3
```

### 输出

```
No
```

## 样例 #3

### 输入

```
2

4 1

2 4
```

### 输出

```
No
```



---

---
title: "[ARC104D] Multiset Mean"
layout: "post"
diff: 提高+/省选-
pid: AT_arc104_d
tag: []
---

# [ARC104D] Multiset Mean

## 题目描述

[problemUrl]: https://atcoder.jp/contests/arc104/tasks/arc104_d

正の整数 $ N,\ K,\ M $ が与えられるので、$ 1 $ 以上 $ N $ 以下の全ての整数 $ x $ について、次の問題を解いてください。

- $ 1,\ 2,\ 3\ \cdots,\ N $ の各整数をそれぞれ $ 0 $ 個以上 $ K $ 個以下含むような空でない多重集合であって、平均が $ x $ であるものの個数を $ M $ で割った余りを求めよ。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ K $ $ M $

## 输出格式

以下の形式で出力せよ。

> $ c_1 $ $ c_2 $ $ : $ $ c_N $

ただし $ c_x $ は、平均が $ x $ である多重集合の個数を $ M $ で割った余りを表す。

## 说明/提示

### 制約

- $ 1\ \leq\ N,\ K\ \leq\ 100 $
- $ 10^8\ \leq\ M\ \leq\ 10^9\ +\ 9 $
- $ M $ は素数である
- 入力は全て整数である

### Sample Explanation 1

$ 1 $ 以上 $ 3 $ 以下の整数をそれぞれ $ 0 $ 個以上 $ 1 $ 個以下含むような空でない多重集合を考えます。 - 平均が $ x\ =\ 1 $ である多重集合は、$ \{1\} $ の $ 1 $ 個です。 - 平均が $ x\ =\ 2 $ である多重集合は、$ \{2\},\ \{1,\ 3\},\ \{1,\ 2,\ 3\} $ の $ 3 $ 個です。 - 平均が $ x\ =\ 3 $ である多重集合は、$ \{3\} $ の $ 1 $ 個です。

### Sample Explanation 2

$ 1 $ 以上 $ 1 $ 以下の整数をそれぞれ $ 0 $ 個以上 $ 2 $ 個以下含むような空でない多重集合を考えます。 - 平均が $ x\ =\ 1 $ である多重集合は、$ \{1\},\ \{1,\ 1\} $ の $ 2 $ 個です。

## 样例 #1

### 输入

```
3 1 998244353
```

### 输出

```
1

3

1
```

## 样例 #2

### 输入

```
1 2 1000000007
```

### 输出

```
2
```

## 样例 #3

### 输入

```
10 8 861271909
```

### 输出

```
8

602

81827

4054238

41331779

41331779

4054238

81827

602

8
```



---

---
title: "[ARC105C] Camels and Bridge"
layout: "post"
diff: 提高+/省选-
pid: AT_arc105_c
tag: []
---

# [ARC105C] Camels and Bridge

## 题目描述

[problemUrl]: https://atcoder.jp/contests/arc105/tasks/arc105_c

$ 1 $ から $ N $ の番号がついた $ N $ 頭のラクダがいます。

ラクダ $ i $ の体重は $ w_i $ です。

あなたはラクダたちに隊列を組ませ、$ M $ 個のパーツからなる橋を渡らせようとしています。

あなたは橋を渡る前にラクダたちの隊列を決め(番号の昇順となる必要はありません)、ラクダどうしを任意の非負の実数の間隔で並ばせることができます。 ラクダたちはこの決められた間隔を保って橋を渡ります。

橋の $ i $ 番目のパーツは長さ $ l_i $ で耐荷重は $ v_i $ です。 パーツ内部(両端を除く)にいるラクダたちの体重の総和が $ v_i $ より大きくなると、橋は崩落してしまいます。

橋が崩落しないようにラクダたちを渡らせることが可能かどうかを判定し、可能ならばそのときの先頭のラクダと末尾のラクダの距離としてありうる値の最小値を求めてください。 これは整数になることが証明できるので、整数で出力してください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ M $ $ w_1 $ $ w_2 $ $ \cdots $ $ w_N $ $ l_1 $ $ v_1 $ $ \vdots $ $ l_M $ $ v_M $

## 输出格式

どのようにしても橋が崩落してしまう場合、`-1` を出力せよ。 そうでない場合、橋が崩落しないようにラクダたちを渡らせるときの先頭のラクダと末尾のラクダの距離としてありうる値の最小値を出力せよ。

## 说明/提示

### 制約

- 与えられる入力は全て整数
- $ 2\ \leq\ N\ \leq\ 8 $
- $ 1\ \leq\ M\ \leq\ 10^5 $
- $ 1\ \leq\ w_i,l_i,v_i\ \leq\ 10^8 $

### Sample Explanation 1

\- 例えば、先頭から順に $ 1,3,2 $ の順番に並べ、ラクダどうしの間隔をそれぞれ $ 0,10 $ にすることで橋が崩落しないようにラクダたちを渡らせることが可能です。 - パーツ $ 1 $ ではラクダ $ 1,3 $ あるいはラクダ $ 2 $ のみがパーツの内部にいる状態が起こります。どちらもパーツの内部にいるラクダたちの体重の総和がパーツ $ 1 $ の耐荷重である $ 4 $ 以下のため、橋が崩落することはありません。 - パーツ $ 2 $ ではラクダ $ 1,3 $ あるいはラクダ $ 2 $ のみがパーツの内部にいる状態が起こります。どちらもパーツの内部にいるラクダたちの体重の総和がパーツ $ 1 $ の耐荷重である $ 6 $ 以下のため、橋が崩落することはありません。 - ラクダどうしの間隔が $ 0 $ でもよいこと、パーツの内部はパーツの両端を含まないことに注意してください。

### Sample Explanation 2

\- どのようにしても橋が崩落してしまう場合は `-1` を出力してください。

## 样例 #1

### 输入

```
3 2

1 4 2

10 4

2 6
```

### 输出

```
10
```

## 样例 #2

### 输入

```
2 1

12 345

1 1
```

### 输出

```
-1
```

## 样例 #3

### 输入

```
8 1

1 1 1 1 1 1 1 1

100000000 1
```

### 输出

```
700000000
```

## 样例 #4

### 输入

```
8 20

57 806 244 349 608 849 513 857

778 993

939 864

152 984

308 975

46 860

123 956

21 950

850 876

441 899

249 949

387 918

34 965

536 900

875 889

264 886

583 919

88 954

845 869

208 963

511 975
```

### 输出

```
3802
```



---

---
title: "[ARC105D] Let&#39;s Play Nim"
layout: "post"
diff: 提高+/省选-
pid: AT_arc105_d
tag: []
---

# [ARC105D] Let&#39;s Play Nim

## 题目描述

[problemUrl]: https://atcoder.jp/contests/arc105/tasks/arc105_d

$ 1 $ から $ N $ の番号がついた $ N $ 枚の袋と、$ 1 $ から $ N $ の番号がついた $ N $ 枚の皿があります。 袋 $ i $ には $ a_i $ 個のコインが入っています。どの皿もはじめは何も乗っていません。

先手太郎君と後手次郎君が対戦ゲームをします。 先手太郎君と後手次郎君の手番が交互に訪れます。先手太郎君が先手です。 それぞれのプレイヤーは、手番において以下の $ 2 $ つの手のどちらかを打つことが可能です。

1. (コインが入った袋が $ 1 $ つ以上存在するとき)：コインが入った袋と皿を $ 1 $ 枚ずつ選び、選んだ袋の中に入った全てのコインを選んだ皿に移す(選ぶ皿にはコインが乗っていてもいなくても構わない)
2. (コインが入った袋が存在しないとき)：コインが乗った皿を $ 1 $ 枚選び、選んだ皿から $ 1 $ 枚以上のコインを取り除く

先に手が打てなくなった人の負けです。$ 2 $ 人が最適に行動したときに勝つのはどちらかを判定してください。

$ T $ 個のテストケースが与えられるので、それぞれについて答えを求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ T $ $ \mathrm{case}_1 $ $ \vdots $ $ \mathrm{case}_T $

各ケースは以下の形式で与えられる。

> $ N $ $ a_1 $ $ a_2 $ $ \cdots $ $ a_N $

## 输出格式

$ T $ 行出力せよ。$ i $ 行目には $ i $ 番目のテストケースの勝者が先手太郎君ならば `First`、後手次郎君ならば `Second` を出力せよ。

## 说明/提示

### 制約

- 与えられる入力は全て整数
- $ 1\ \leq\ T\ \leq\ 10^5 $
- $ 1\ \leq\ N\ \leq\ 10^{5} $
- $ 1\ \leq\ a_i\ \leq\ 10^9 $
- $ 1 $ つの入力ファイルにおいて、$ N $ の総和は $ 2\ \times\ 10^5 $ を超えない。

### Sample Explanation 1

\- テストケース $ 1 $ では後手次郎君が勝利します。以下はそのような $ 2 $ 人の行動の例です。 - 先手太郎君の手番では、袋 $ 1 $ を選んで皿 $ 1 $ にコインを移すしかできません。 - 後手次郎君の手番で皿 $ 1 $ を選んで全てのコインを取り除くことで、先手太郎君は手番で手を打つことができず敗北します。 - コインが入った袋が存在するとき、コインの入った袋を選んで皿に移す手しか打てないことに注意してください。 - 同様に、コインが入った袋が存在しないときは皿を選んでコインを $ 1 $ つ以上取り除く手しか打てないことに注意してください。

## 样例 #1

### 输入

```
3

1

10

2

1 2

21

476523737 103976339 266993 706803678 802362985 892644371 953855359 196462821 817301757 409460796 773943961 488763959 405483423 616934516 710762957 239829390 55474813 818352359 312280585 185800870 255245162
```

### 输出

```
Second

First

Second
```



---

---
title: "[ARC106D] Powers"
layout: "post"
diff: 提高+/省选-
pid: AT_arc106_d
tag: []
---

# [ARC106D] Powers

## 题目描述

[problemUrl]: https://atcoder.jp/contests/arc106/tasks/arc106_d

長さ $ N $ の整数列 $ A\ =\ (A_1,\ A_2,\ \cdots,\ A_N) $ と整数 $ K $ が与えられます。

$ 1\ \le\ X\ \le\ K $ を満たす整数 $ X $ それぞれについて、以下の値を求めてください。

$ \left(\displaystyle\ \sum_{L=1}^{N-1}\ \sum_{R=L+1}^{N}\ (A_L+A_R)^X\right)\ \bmod\ 998244353 $

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ K $ $ A_1 $ $ A_2 $ $ \cdots $ $ A_N $

## 输出格式

$ K $ 行出力せよ。

$ X $ 行目には、$ \left(\displaystyle\ \sum_{L=1}^{N-1}\ \sum_{R=L+1}^{N}\ (A_L+A_R)^X\ \right)\ \bmod\ 998244353 $ の値を出力せよ。

## 说明/提示

### 制約

- 入力は全て整数
- $ 2\ \le\ N\ \le\ 2\ \times\ 10^5 $
- $ 1\ \le\ K\ \le\ 300 $
- $ 1\ \le\ A_i\ \le\ 10^8 $

### Sample Explanation 1

$ 1 $ 行目には、$ (1+2)^1\ +\ (1+3)^1\ +\ (2+3)^1\ =\ 3\ +\ 4\ +\ 5\ =\ 12 $ を出力します。 $ 2 $ 行目には、$ (1+2)^2\ +\ (1+3)^2\ +\ (2+3)^2\ =\ 9\ +\ 16\ +\ 25\ =\ 50 $ を出力します。 $ 3 $ 行目には、$ (1+2)^3\ +\ (1+3)^3\ +\ (2+3)^3\ =\ 27\ +\ 64\ +\ 125\ =\ 216 $ を出力します。

### Sample Explanation 3

$ \bmod\ 998244353 $ での値を出力してください。

## 样例 #1

### 输入

```
3 3

1 2 3
```

### 输出

```
12

50

216
```

## 样例 #2

### 输入

```
10 10

1 1 1 1 1 1 1 1 1 1
```

### 输出

```
90

180

360

720

1440

2880

5760

11520

23040

46080
```

## 样例 #3

### 输入

```
2 5

1234 5678
```

### 输出

```
6912

47775744

805306038

64822328

838460992
```



---

---
title: "[ARC108D] AB"
layout: "post"
diff: 提高+/省选-
pid: AT_arc108_d
tag: []
---

# [ARC108D] AB

## 题目描述

[problemUrl]: https://atcoder.jp/contests/arc108/tasks/arc108_d

整数 $ N $ と $ 4 $ つの文字 $ c_{\mathrm{AA}},c_{\mathrm{AB}},c_{\mathrm{BA}},c_{\mathrm{BB}} $ が与えられます。 ここで、与えられる $ 4 $ つの文字はいずれも `A` か `B` であることが保証されます。

すぬけ君は文字列 $ s $ を持っています。 $ s $ ははじめ `AB` です。

$ s $ の長さを $ |s| $ と書くことにします。 すぬけ君は以下の $ 4 $ 種類の操作を任意の順序で $ 0 $ 回以上行うことができます。

1. $ 1\ \leq\ i\ <\ |s|,\ s_{i} $ = `A`, $ s_{i+1} $ = `A` なる $ i $ を選んで、$ s $ の $ i $ 文字目と $ i+1 $ 文字目の間に $ c_{\mathrm{AA}} $ を挿入する。
2. $ 1\ \leq\ i\ <\ |s|,s_{i} $ = `A`, $ s_{i+1} $ = `B` なる $ i $ を選んで、$ s $ の $ i $ 文字目と $ i+1 $ 文字目の間に $ c_{\mathrm{AB}} $ を挿入する。
3. $ 1\ \leq\ i\ <\ |s|,s_{i} $ = `B`, $ s_{i+1} $ = `A` なる $ i $ を選んで、$ s $ の $ i $ 文字目と $ i+1 $ 文字目の間に $ c_{\mathrm{BA}} $ を挿入する。
4. $ 1\ \leq\ i\ <\ |s|,s_{i} $ = `B`, $ s_{i+1} $ = `B` なる $ i $ を選んで、$ s $ の $ i $ 文字目と $ i+1 $ 文字目の間に $ c_{\mathrm{BB}} $ を挿入する。

$ s $ の長さが $ N $ になるまで操作を行ったあとの $ s $ としてありうる文字列の個数を $ 10^9+7 $ で割ったあまりを求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ c_{\mathrm{AA}} $ $ c_{\mathrm{AB}} $ $ c_{\mathrm{BA}} $ $ c_{\mathrm{BB}} $

## 输出格式

$ s $ の長さが $ N $ になるまで操作を行ったあとの $ s $ としてありうる文字列の個数を $ 10^9+7 $ で割ったあまりを出力せよ。

## 说明/提示

### 制約

- $ 2\ \leq\ N\ \leq\ 1000 $
- $ c_{\mathrm{AA}},c_{\mathrm{AB}},c_{\mathrm{BA}},c_{\mathrm{BB}} $ は `A` か `B`

### Sample Explanation 1

\- $ s $ としてありうる文字列は `ABAB` と `ABBB` の $ 2 $ 通りです。

### Sample Explanation 2

\- $ s $ としてありうる文字列は $ 1 $ 通りです。

## 样例 #1

### 输入

```
4

A

B

B

A
```

### 输出

```
2
```

## 样例 #2

### 输入

```
1000

B

B

B

B
```

### 输出

```
1
```



---

---
title: "[ARC109D] く"
layout: "post"
diff: 提高+/省选-
pid: AT_arc109_d
tag: []
---

# [ARC109D] く

## 题目描述

[problemUrl]: https://atcoder.jp/contests/arc109/tasks/arc109_d

<!-- $ 2\time\ 10^{10}\ +\ 1 $ 行 $ 2\time\ 10^{10}\ +\ 1 $ 列からなるマス目上に区切られた盤面があります。行には上から順番に $ -10^{10},\ \dots,\ 10^{10} $ の番号が、列には左から$ 2\time\ 10^{10}\ +\ 1 $ の場脳が振られています。この盤面の上に石が $ 3 $ つ置かれています。
 -->二次元平面上の点 $ (0,\ 0),\ (1,0),\ (0,1) $ に石がひとつずつ置かれています。

$ 3 $ つの石が次の条件を満たしているとき、くの字に並んでいるといいます。

- どの石も、座標が整数である点に置かれている
- どの石も、別の石と隣接している（石からの距離が $ 1 $ である場所に別の石が存在する）
- $ 3 $ つの石が一直線上に存在しない

特に、最初の石の並べ方 $ (0,\ 0),\ (1,0),\ (0,1) $ は、くの字です。

好きな石を $ 1 $ つ選んで好きな位置に移動させる操作を好きなだけできます。ただし、各操作後の石は、くの字に並んでいなければなりません。 できるだけ少ない操作回数で、石が点 $ (ax,\ ay),\ (bx,\ by),\ (cx,\ cy) $ にひとつずつ置かれている状態にしたいです。必要な操作回数は何回ですか？ただし、この状態で石がくの字に並んでいることは保証されます。この制約のもと、有限回の操作で目標を達成できます。

$ T $ 個のケースが与えられるので、それぞれについて答えを求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ T $ $ \text{case}_1 $ $ \vdots $ $ \text{case}_T $

各ケースは以下の形式で与えられる。

> $ ax $ $ ay $ $ bx $ $ by $ $ cx $ $ cy $

## 输出格式

$ T $ 個の値を出力せよ。$ i $ 個目には $ \text{case}_i $ に対応する操作回数の最小値を出力せよ。

## 说明/提示

### 注意

$ 3 $ つの石は互いに区別できないとします。例えば、最初に点 $ (0,0) $ に置かれていた石が最終的に点 $ (ax,\ ay),\ (bx,\ by),\ (cx,\ cy) $ のどこに置かれていても構いません。

### 制約

- $ 1\ \leq\ T\ \leq\ 10^3 $
- $ |ax|,|ay|,|bx|,|by|,|cx|,|cy|\ \leq\ 10^9 $
- 点 $ (ax,\ ay),\ (bx,\ by),\ (cx,\ cy) $ に石がひとつずつ置かれている時、石はくの字に並んでいる

### Sample Explanation 1

Let us use `#` to represent a stone. You can move the stones to the specified positions with four operations, as follows:

```
....    ....    ....    ..#.    ..##
#... -> ##.. -> .##. -> .##. -> ..#.
##..    .#..    .#..    ....    ....
```

## 样例 #1

### 输入

```
1

3 2 2 2 2 1
```

### 输出

```
4
```

## 样例 #2

### 输入

```
10

0 0 1 0 0 1

1 0 0 1 1 1

2 -1 1 -1 1 0

1 -2 2 -1 1 -1

-1 2 0 2 -1 3

-1 -2 -2 -2 -2 -3

-2 4 -3 3 -2 3

3 1 4 2 4 1

-4 2 -4 3 -3 3

5 4 5 3 4 4
```

### 输出

```
0

1

2

3

4

5

6

7

8

9
```



---

---
title: "[ARC110D] Binomial Coefficient is Fun"
layout: "post"
diff: 提高+/省选-
pid: AT_arc110_d
tag: []
---

# [ARC110D] Binomial Coefficient is Fun

## 题目描述

我们有一个包含 $N$ 个非负整数的序列 $A$。

对于所有长度为 $N$ 且和不超过 $M$ 的非负整数序列 $B$，求 $\prod_{i = 1}^N {B_i \choose A_i}$ 之和， 对 $(10^9 + 7)$ 取模。

## 输入格式

第一行输入两个整 $N, M$，第二行 $N$ 个整数，表示序列 $A$。

## 输出格式

一行，表示答案对 $(10^9 + 7)$ 取模的值。





### 样例解释1

有四个序列 $B$ 满足 $\prod_{i=1}^N {B_i \choose A_i}$ 至少为 $1$：
	
- $B = \{1, 2, 1\}, \prod_{i = 1}^N{B_i \choose A_i} = {1 \choose 1} \times {2 \choose 2} \times {1 \choose 1} = 1$;
- $B = \{2, 2, 1\}, \prod_{i = 1}^N{B_i \choose A_i} = {2 \choose 1} \times {2 \choose 2} \times {1 \choose 1} = 2$;
- $B = \{1, 3, 1\}, \prod_{i = 1}^N{B_i \choose A_i} = {1 \choose 1} \times {3 \choose 2} \times {1 \choose 1} = 3$;
- $B = \{1, 2, 2\}, \prod_{i = 1}^N{B_i \choose A_i} = {1 \choose 1} \times {2 \choose 2} \times {2 \choose 1} = 2$.

它们的答案之和为 $1+2+3+2=8$。

###### $\text{\tiny{Translated by @nr0728.}}$

## 说明/提示

- $1 \le N \le 2000$
- $1 \le M \le 10^9$
- $0 \le A_i \le 2000$

## 样例 #1

### 输入

```
3 5

1 2 1
```

### 输出

```
8
```

## 样例 #2

### 输入

```
10 998244353

31 41 59 26 53 58 97 93 23 84
```

### 输出

```
642612171
```



---

---
title: "[ARC111D] Orientation"
layout: "post"
diff: 提高+/省选-
pid: AT_arc111_d
tag: []
---

# [ARC111D] Orientation

## 题目描述

[problemUrl]: https://atcoder.jp/contests/arc111/tasks/arc111_d

$ N $ 頂点 $ M $ 辺の単純な無向グラフが与えられます。頂点には $ 1,\ \cdots,\ N $ の番号がついています。$ i $ 番目の辺は頂点 $ a_i $, $ b_i $ を繋いでいます。 また、正整数列 $ c_1,\ c_2,\ \cdots,\ c_N $ も与えられます。

このグラフを、次の条件を満たすように有向グラフに変換してください。つまり、各 $ i $ について無向辺 $ (a_i,\ b_i) $ を削除し、有向辺 $ a_i\ \to\ b_i $、$ b_i\ \to\ a_i $ のどちらか $ 1 $ つを張ってください。

- 全ての $ i\ =\ 1,\ 2,\ \cdots,\ N $ について、頂点 $ i $ から(有向辺を好きな回数使うことで)到達可能な頂点数がちょうど $ c_i $ 個。なお、頂点 $ i $ 自身も $ 1 $ 個と数える。

なお、この問題では、**解が存在する**ような入力のみが与えられます。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ M $ $ a_1 $ $ b_1 $ $ : $ $ a_M $ $ b_M $ $ c_1 $ $ c_2 $ $ ... $ $ c_N $

## 输出格式

$ M $ 行出力せよ。

$ i $ 行目には、$ i $ 番目の辺について $ a_i\ \to\ b_i $ に辺を張りたい場合 `->`、$ a_i\ \gets\ b_i $ に辺を張りたい場合 `<-` を出力せよ。

解が複数存在する場合、どれを出力しても構わない。

## 说明/提示

### 制約

- $ 1\ \leq\ N\ \leq\ 100 $
- $ 0\ \leq\ M\ \leq\ \frac{N(N\ -\ 1)}{2} $
- $ 1\ \leq\ a_i,\ b_i\ \leq\ N $
- 与えられるグラフに自己ループや多重辺は存在しない
- $ 1\ \leq\ c_i\ \leq\ N $
- **必ず題意を満たす解が存在する**

### Sample Explanation 1

長さ $ 3 $ のサイクルでは、どの頂点からも全ての頂点に到達できます。

### Sample Explanation 3

グラフは非連結のこともあります。

## 样例 #1

### 输入

```
3 3

1 2

2 3

3 1

3 3 3
```

### 输出

```
->

->

->
```

## 样例 #2

### 输入

```
3 2

1 2

2 3

1 2 3
```

### 输出

```
<-

<-
```

## 样例 #3

### 输入

```
6 3

1 2

4 3

5 6

1 2 1 2 2 1
```

### 输出

```
<-

->

->
```



---

---
title: "[ARC112C] DFS Game"
layout: "post"
diff: 提高+/省选-
pid: AT_arc112_c
tag: []
---

# [ARC112C] DFS Game

## 题目描述

[problemUrl]: https://atcoder.jp/contests/arc112/tasks/arc112_c

高橋くんと青木くんは $ n $ 頂点の根付き木を使ったゲームをします。 木の頂点には $ 1 $ から $ n $ の整数がふられています。 この木の根は頂点 $ 1 $ であり、$ v=2,\dots,n $ について、頂点 $ v $ の親は $ p_v $ です。 最初、各頂点にコインが $ 1 $ 枚ずつ置かれています。また、頂点 $ 1 $ にコマが置かれています。

高橋くんと青木くんは、高橋くんから始めて交互に、以下の操作を行います。

- コマの置かれている頂点にコインがある場合、そのコインを獲得し、手番を終える。
- コマの置かれている頂点にコインがない場合、以下のルールでコマを動かす (またはゲームを終える)。
  - コマが置かれている頂点の子のうち、コインが置かれている頂点が存在するときは、そのうちのいずれかの頂点を選んでその頂点にコマを動かし、手番を終える。
  - 存在しない場合、コマが置かれている頂点が根ならゲームを終える。そうでないとき、コマが置かれている頂点の親にコマを動かし、手番を終える。

高橋くんも青木くんも、自分が獲得するコインの枚数を最大にするために最適な行動をします。高橋くんが獲得するコインの枚数を求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ n $ $ p_2 $ $ \dots $ $ p_n $

## 输出格式

両者が最適な行動をしたときに、高橋くんが獲得するコインの枚数を出力せよ。

## 说明/提示

### 制約

- $ 2\le\ n\ \le\ 10^5 $
- $ 1\le\ p_v\ \lt\ v $

### Sample Explanation 1

どちらのプレイヤーにも選択肢が与えられず、必ず以下のようにゲームが進むため、高橋くんがすべてのコインを獲得します。 - 高橋くんが頂点 $ 1 $ に置かれたコインを獲得する。 - 青木くんがコマを頂点 $ 2 $ に動かす。 - 高橋くんが頂点 $ 2 $ に置かれたコインを獲得する。 - 青木くんがコマを頂点 $ 3 $ に動かす。 - $ \vdots $ - 高橋くんが頂点 $ 10 $ に置かれたコインを獲得する。 - 青木くんがコマを頂点 $ 9 $ に動かす。 - 高橋くんがコマを頂点 $ 8 $ に動かす。 - 青木くんがコマを頂点 $ 7 $ に動かす。 - $ \vdots $ - 高橋くんがコマを頂点 $ 2 $ に動かす。 - 青木くんがコマを頂点 $ 1 $ に動かす。 - ゲームを終える。

### Sample Explanation 2

まず、高橋くんが頂点 $ 1 $ に置かれたコインを獲得します。 その後、青木くんは頂点 $ 2 $ か頂点 $ 5 $ のどちらかにコマを動かすことができます。 もし頂点 $ 2 $ に動かした場合、青木くんは最終的に頂点 $ 5 $ に置かれたコインのみを獲得します。 一方で、頂点 $ 5 $ に動かした場合、青木くんは最終的に頂点 $ 2,3,4 $ に置かれたコインを獲得します。 青木くんは自分が獲得するコインの枚数を最大にするために最適な行動をするため、コマを頂点 $ 5 $ に動かすことを選びます。 よって、高橋くんが獲得するコインは $ 2 $ 枚です。

## 样例 #1

### 输入

```
10

1 2 3 4 5 6 7 8 9
```

### 输出

```
10
```

## 样例 #2

### 输入

```
5

1 2 3 1
```

### 输出

```
2
```

## 样例 #3

### 输入

```
10

1 1 3 1 3 6 7 6 6
```

### 输出

```
5
```



---

---
title: "[ARC112D] Skate"
layout: "post"
diff: 提高+/省选-
pid: AT_arc112_d
tag: []
---

# [ARC112D] Skate

## 题目描述

给定一个 $h$ 行 $w$ 列的网格图，图中的每个格子不是`#`就是`.`。

若当前处于静止状态，可以向四个方向中的任意一个移动，直到到达网格图边界或到达一个为`#`的格子时才可停止。

将图中上起第 $r$ 行左起第 $c$ 列的格子记为 $(r,c)$。“从 $(r,c)$ 来看，可以满足目的”的条件是：从 $(r,c)$ 出发，通过以上形式的移动，在移动若干次以后能够访问到图中的所有格子。

问最少改变多少个`.`格子为`#`格子才能满足：从任意一个格子来看，都能满足目的？

## 输入格式

第一行输入两个整数 $h,w$。

接下来 $h$ 行，每行一个长度为 $w$，仅有`#`和`.`的字符串。

## 输出格式

一行一个整数，最少需要改变的格子数量。

## 说明/提示

#### 数据规模与约定

$2\le h,w\le 1000$。

#### 样例 #1 解释

将格子 $(2,2)$ 改成`#`即可。

## 样例 #1

### 输入

```
3 9

.........

.........

.........
```

### 输出

```
1
```

## 样例 #2

### 输入

```
10 10

..........

#...#.....

..........

..........

..........

....#.....

.#......#.

..........

..........

..........
```

### 输出

```
6
```



---

---
title: "[ARC114C] Sequence Scores"
layout: "post"
diff: 提高+/省选-
pid: AT_arc114_c
tag: []
---

# [ARC114C] Sequence Scores

## 题目描述

[problemUrl]: https://atcoder.jp/contests/arc114/tasks/arc114_c

$ 1 $ 以上 $ M $ 以下の整数から成る長さ $ N $ の数列 $ A $ に対して， $ f(A) $ を以下のように定義します．

- 長さ $ N $ の数列 $ X $ があり，初め全ての要素は $ 0 $ である．$ f(A) $ を，次の操作を繰り返して $ X $ を $ A $ に等しくするための最小の操作回数とする．
  - $ 1\ \leq\ l\ \leq\ r\ \leq\ N $ と $ 1\ \leq\ v\ \leq\ M $ を指定する．$ l\ \leq\ i\ \leq\ r $ に対して $ X_i $ を $ \max(X_i,\ v) $ で置き換える．

$ A $ として考えられる数列は $ M^N $ 通りあります．これら全ての数列に対する $ f(A) $ の和を $ 998244353 $ で割った余りを求めてください．

## 输入格式

入力は以下の形式で標準入力から与えられる．

> $ N $ $ M $

## 输出格式

全ての数列に対する $ f(A) $ の和を $ 998244353 $ で割った余りを出力せよ．

## 说明/提示

### 制約

- $ 1\ \leq\ N,\ M\ \leq\ 5000 $
- 入力は全て整数

### Sample Explanation 1

$ 3\ ^\ 2\ =\ 9 $ 通りの数列と，それに対する $ f $ の値は以下の通りです． - $ A\ =\ (1,\ 1) $ のとき，$ (l\ =\ 1,\ r\ =\ 2,\ v\ =\ 1) $ として $ 1 $ 回の操作で可能なので，$ f(A)\ =\ 1 $ です． - $ A\ =\ (1,\ 2) $ のとき，$ (l\ =\ 1,\ r\ =\ 2,\ v\ =\ 1) $ , $ (l\ =\ 2,\ r\ =\ 2,\ v\ =\ 2) $ として $ 2 $ 回の操作で可能なので，$ f(A)\ =\ 2 $ です． - $ A\ =\ (1,\ 3) $ のとき，$ (l\ =\ 1,\ r\ =\ 2,\ v\ =\ 1) $ , $ (l\ =\ 2,\ r\ =\ 2,\ v\ =\ 3) $ として $ 2 $ 回の操作で可能なので，$ f(A)\ =\ 2 $ です． - $ A\ =\ (2,\ 1) $ のとき，$ (l\ =\ 1,\ r\ =\ 2,\ v\ =\ 1) $ , $ (l\ =\ 1,\ r\ =\ 1,\ v\ =\ 2) $ として $ 2 $ 回の操作で可能なので，$ f(A)\ =\ 2 $ です． - $ A\ =\ (2,\ 2) $ のとき，$ (l\ =\ 1,\ r\ =\ 2,\ v\ =\ 2) $ として $ 1 $ 回の操作で可能なので，$ f(A)\ =\ 1 $ です． - $ A\ =\ (2,\ 3) $ のとき，$ (l\ =\ 1,\ r\ =\ 2,\ v\ =\ 2) $ , $ (l\ =\ 2,\ r\ =\ 2,\ v\ =\ 3) $ として $ 2 $ 回の操作で可能なので，$ f(A)\ =\ 2 $ です． - $ A\ =\ (3,\ 1) $ のとき，$ (l\ =\ 1,\ r\ =\ 2,\ v\ =\ 1) $ , $ (l\ =\ 1,\ r\ =\ 1,\ v\ =\ 3) $ として $ 2 $ 回の操作で可能なので，$ f(A)\ =\ 2 $ です． - $ A\ =\ (3,\ 2) $ のとき，$ (l\ =\ 1,\ r\ =\ 2,\ v\ =\ 2) $ , $ (l\ =\ 1,\ r\ =\ 1,\ v\ =\ 3) $ として $ 2 $ 回の操作で可能なので，$ f(A)\ =\ 2 $ です． - $ A\ =\ (3,\ 3) $ のとき，$ (l\ =\ 1,\ r\ =\ 2,\ v\ =\ 3) $ として $ 1 $ 回の操作で可能なので，$ f(A)\ =\ 1 $ です． これらの和は $ 3\ \times\ 1\ +\ 6\ \times\ 2\ =\ 15 $ です．

## 样例 #1

### 输入

```
2 3
```

### 输出

```
15
```

## 样例 #2

### 输入

```
3 2
```

### 输出

```
15
```

## 样例 #3

### 输入

```
34 56
```

### 输出

```
649717324
```



---

---
title: "[ARC115D] Odd Degree"
layout: "post"
diff: 提高+/省选-
pid: AT_arc115_d
tag: []
---

# [ARC115D] Odd Degree

## 题目描述

[problemUrl]: https://atcoder.jp/contests/arc115/tasks/arc115_d

$ N $ 頂点 $ M $ 辺の単純無向グラフが与えられます。頂点には $ 1,\ \ldots,\ N $ の番号がついています。$ i $ 番目の辺は頂点 $ A_i $ と頂点 $ B_i $ を結んでいます。このグラフの全域部分グラフ(※)であって、次数が奇数の頂点がちょうど $ K $ 個であるものの個数をすべての $ K(0\ \leq\ K\ \leq\ N) $ について求めてください。ただし答えは非常に大きくなる可能性があるので、$ 998244353 $ で割った余りを出力してください。

(※)$ G $ の部分グラフ $ H $ が $ G $ の全域部分グラフであるとは、$ H $ の頂点集合が $ G $ の頂点集合と等しく、$ H $ の辺集合が $ G $ の辺集合の部分集合であることをいいます。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ M $ $ A_1 $ $ B_1 $ $ A_2 $ $ B_2 $ $ : $ $ A_M $ $ B_M $

## 输出格式

$ N+1 $ 行出力せよ。$ i $ 行目には、$ K=i-1 $ のときの答えを出力せよ。

> $ ans_0 $ $ ans_1 $ $ : $ $ ans_N $

## 说明/提示

### 制約

- $ 1\ \leq\ N\ \leq\ 5000 $
- $ 0\ \leq\ M\ \leq\ 5000 $
- $ 1\ \leq\ A_i\ ,\ B_i\ \leq\ N $
- 与えられるグラフは単純グラフである。すなわち、自己ループや多重辺は存在しない。

### Sample Explanation 1

各全域部分グラフの次数が奇数の頂点の個数は以下の通りです。 - 辺が無いとき、次数が奇数の頂点は $ 0 $ 個 - $ 1 $ と $ 2 $ を結ぶ辺だけがあるとき、次数が奇数の頂点は $ 2 $ 個 - $ 2 $ と $ 3 $ を結ぶ辺だけがあるとき、次数が奇数の頂点は $ 2 $ 個 - 両方の辺があるとき、次数が奇数の頂点は $ 2 $ 個

## 样例 #1

### 输入

```
3 2

1 2

2 3
```

### 输出

```
1

0

3

0
```

## 样例 #2

### 输入

```
4 2

1 2

3 4
```

### 输出

```
1

0

2

0

1
```



---

---
title: "[ARC117C] Tricolor Pyramid"
layout: "post"
diff: 提高+/省选-
pid: AT_arc117_c
tag: []
---

# [ARC117C] Tricolor Pyramid

## 题目描述

[problemUrl]: https://atcoder.jp/contests/arc117/tasks/arc117_c

$ N $ 個のブロックが横一列に並んでおり、それぞれのブロックは青・白・赤のうちいずれかで塗られています。 左から $ i $ 番目 $ (1\ \leq\ i\ \leq\ N) $ のブロックの色は文字 $ c_i $ で表され、`B` は青、`W` は白、`R` は赤に対応しています。

この状態から青・白・赤のブロックを積み上げ、$ N $ 段のピラミッドの形にします。以下の図がその一例です。

 ![](https://cdn.luogu.com.cn/upload/vjudge_pic/AT_arc117_c/f795a525a74e48b7e43010cb259b0e9d82262039.png) 

ここでは、ブロックを下から順に、以下の規則で $ 1 $ 個ずつ置いていきます。

- 直下にある $ 2 $ 個のブロックの色が同じ場合、それと同じ色のブロックを置く
- 直下にある $ 2 $ 個のブロックの色が異なる場合、そのどちらでもない色のブロックを置く

このとき、一番上のブロックはどの色になるでしょうか？

## 输入格式

入力は以下の形式で標準入力から与えられます。

> $ N $ $ c_1 $$ c_2 $$ \cdots $$ c_N $

## 输出格式

一番上のブロックの色が青ならば `B`、白ならば `W`、赤ならば `R` を出力してください。

## 说明/提示

### 制約

- $ N $ は $ 2\ \leq\ N\ \leq\ 400000 $ を満たす整数
- $ c_1,\ c_2,\ \dots,\ c_N $ はそれぞれ `B`，`W`，`R` のいずれか

### Sample Explanation 1

この入力例では、ブロックを以下のように積み上げることになります。 - 一番下の段の左から $ 1,\ 2 $ 番目のブロックはそれぞれ青色・白色なので、その上に赤色のブロックを置く。 - 一番下の段の左から $ 2,\ 3 $ 番目のブロックはそれぞれ白色・赤色なので、その上に青色のブロックを置く。 - 下から $ 2 $ 段目のブロックはそれぞれ赤色・青色なので，その上に白色のブロックを置く。 一番上のブロックの色は白となるため、`W` を出力します。

### Sample Explanation 2

この入力例では、ブロックを以下のように積み上げることになります。 - 一番下の段の左から $ 1,\ 2 $ 番目のブロックはそれぞれ赤色・赤色なので、その上に赤色のブロックを置く。 - 一番下の段の左から $ 2,\ 3 $ 番目のブロックはそれぞれ赤色・青色なので、その上に白色のブロックを置く。 - 一番下の段の左から $ 3,\ 4 $ 番目のブロックはそれぞれ青色・青色なので、その上に青色のブロックを置く。 - 下から $ 2 $ 段目の左から $ 1,\ 2 $ 番目のブロックはそれぞれ赤色・白色なので、その上に青色のブロックを置く。 - 下から $ 2 $ 段目の左から $ 2,\ 3 $ 番目のブロックはそれぞれ白色・青色なので、その上に赤色のブロックを置く。 - 下から $ 3 $ 段目のブロックはそれぞれ青色・赤色なので、その上に白色のブロックを置く。 一番上のブロックの色は白となるため、`W` を出力します。

### Sample Explanation 3

最終的なブロックの並びは、以下の図のように表されます。一番上のブロックの色は青となるため、`B` を出力します。 !\[ \](https://img.atcoder.jp/arc117/333af8ef18ae0a6ce966c46492cb07e6.png) なお、これは問題文中に例示したケースと同じものになっています。

### Sample Explanation 4

最終的なブロックの並びは、以下の図のように表されます。一番上のブロックの色は赤となるため、`R` を出力します。 !\[ \](https://img.atcoder.jp/arc117/36a2a6777ac49fa0bb43440de385dced.png)

## 样例 #1

### 输入

```
3

BWR
```

### 输出

```
W
```

## 样例 #2

### 输入

```
4

RRBB
```

### 输出

```
W
```

## 样例 #3

### 输入

```
6

BWWRBW
```

### 输出

```
B
```

## 样例 #4

### 输入

```
8

WWBRBBWB
```

### 输出

```
R
```

## 样例 #5

### 输入

```
21

BWBRRBBRWBRBBBRRBWWWR
```

### 输出

```
B
```



---

---
title: "[ARC117D] Miracle Tree"
layout: "post"
diff: 提高+/省选-
pid: AT_arc117_d
tag: []
---

# [ARC117D] Miracle Tree

## 题目描述

[problemUrl]: https://atcoder.jp/contests/arc117/tasks/arc117_d

$ N $ 頂点の木があり、頂点には $ 1,\ 2,\ \dots,\ N $ と番号が振られています。$ i $ 番目 $ (1\ \leq\ i\ \leq\ N-1) $ の辺は頂点 $ A_i $ と頂点 $ B_i $ を結んでいます。

木を見つけた E869120 君は、$ N $ 個の頂点それぞれに整数を書き込み、square1001 君を驚かせようとしています。彼を驚かせるためには、頂点 $ i $ に書かれた整数を $ E_i $ とするとき、次の条件を満たす必要があります。

> **条件1** $ E_i\ \geq\ 1 $ $ (1\ \leq\ i\ \leq\ N) $ を満たす。  
> **条件2** すべての組 $ (i,\ j) $ $ (1\ \leq\ i\ <\ j\ \leq\ N) $ について、$ |E_i\ -\ E_j|\ \geq\ dist(i,\ j) $ を満たす。  
> **条件3** 条件 1・条件 2 を満たす中で、$ \max(E_1,\ E_2,\ \dots,\ E_N) $ の値が最小になる。

ただし、$ dist(i,\ j) $ は次の値を指します。

- 頂点 $ i $ から $ j $ への単純パス（同じ頂点を $ 2 $ 度通らない経路）の長さ。
- つまり、単純パスを $ q_0\ \to\ q_1\ \to\ q_2\ \to\ \cdots\ \to\ q_L $（$ q_0\ =\ i,\ q_L\ =\ j $）とするときの $ L $ の値。

square1001 君を驚かせるような整数の書き方を $ 1 $ つ構成してください。

## 输入格式

入力は以下の形式で標準入力から与えられます。

> $ N $ $ A_1 $ $ B_1 $ $ A_2 $ $ B_2 $ $ \vdots $ $ A_{N-1} $ $ B_{N-1} $

## 输出格式

木に書き込む整数 $ E_1,\ E_2,\ \cdots,\ E_N $ を順に、空白で区切って $ 1 $ 行で出力してください。

問題文の条件を満たす整数の書き込み方が複数存在する場合は、どれを出力しても正解となります。

> $ E_1 $ $ E_2 $ $ \cdots $ $ E_{N} $

## 说明/提示

### 制約

- $ 2\ \leq\ N\ \leq\ 200000 $
- $ 1\ \leq\ A_i\ <\ B_i\ \leq\ N $
- 与えられるグラフは木である
- 入力はすべて整数

### Sample Explanation 1

頂点 $ 1 $ に整数 $ 2 $ を、頂点 $ 2 $ に整数 $ 1 $ を書き込んだ場合、$ dist(1,\ 2)\ =\ 1 $、$ |E_1\ -\ E_2|\ =\ 1 $ であるため、問題文中の条件 2 を満たします。 その他の条件もすべて満たすため、この書き込み方は square1001 君を驚かせることができます。 他にも、$ (E_1,\ E_2)\ =\ (1,\ 2) $ は正解となります。

### Sample Explanation 2

他にも、$ (E_1,\ E_2,\ E_3,\ E_4)\ =\ (2,\ 3,\ 4,\ 1) $ は正解となります。

## 样例 #1

### 输入

```
2

1 2
```

### 输出

```
2 1
```

## 样例 #2

### 输入

```
4

1 2

1 4

2 3
```

### 输出

```
3 2 1 4
```



---

---
title: "[ARC120C] Swaps 2"
layout: "post"
diff: 提高+/省选-
pid: AT_arc120_c
tag: []
---

# [ARC120C] Swaps 2

## 题目描述

[problemUrl]: https://atcoder.jp/contests/arc120/tasks/arc120_c

長さ $ N $ の数列 $ A\ =\ (A_1,\ A_2,\ A_3,\ \dots,\ A_N),\ B\ =\ (B_1,\ B_2,\ B_3,\ \dots,\ B_N) $ が与えられます。  
 以下の操作を繰り返す ($ 1 $ 回も行わなくてもよい) ことで $ A $ を $ B $ に一致させることが可能かを判定してください。また、可能なら、$ A $ を $ B $ に一致させるのに必要な最小の操作回数を求めてください。

- $ 1\ \le\ i\ \lt\ N $ を満たす整数 $ i $ を選び、以下のことを順に行う 
  - $ A_i $ と $ A_{i\ +\ 1} $ を入れ替える
  - $ A_i $ に $ 1 $ を足す
  - $ A_{i\ +\ 1} $ から $ 1 $ を引く

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ A_1 $ $ A_2 $ $ A_3 $ $ \dots $ $ A_N $ $ B_1 $ $ B_2 $ $ B_3 $ $ \dots $ $ B_N $

## 输出格式

$ A $ を $ B $ に一致させることが不可能なら `-1` を出力せよ。  
 可能なら、そのために必要な最小の操作回数を出力せよ。

## 说明/提示

### 制約

- $ 2\ \le\ N\ \le\ 2\ \times\ 10^5 $
- $ 0\ \le\ A_i\ \le\ 10^9 $
- $ 0\ \le\ B_i\ \le\ 10^9 $
- 入力に含まれる値は全て整数

### Sample Explanation 1

以下のように操作すると、$ 2 $ 回の操作で $ A $ を $ B $ に一致させることができます。 - まず、$ i\ =\ 2 $ として操作する。$ A\ =\ (3,\ 5,\ 0) $ となる。 - 次に、$ i\ =\ 1 $ として操作する。$ A\ =\ (6,\ 2,\ 0) $ となる。 $ 1 $ 回以下の操作で目的を達成することはできません。

### Sample Explanation 2

この場合、$ A $ を $ B $ に一致させることは不可能です。

### Sample Explanation 3

$ 1 $ 回も操作をしなくても $ A $ が $ B $ に一致している可能性があります。

## 样例 #1

### 输入

```
3

3 1 4

6 2 0
```

### 输出

```
2
```

## 样例 #2

### 输入

```
3

1 1 1

1 1 2
```

### 输出

```
-1
```

## 样例 #3

### 输入

```
5

5 4 1 3 2

5 4 1 3 2
```

### 输出

```
0
```

## 样例 #4

### 输入

```
6

8 5 4 7 4 5

10 5 6 7 4 1
```

### 输出

```
7
```



---

---
title: "[ARC120D] Bracket Score 2"
layout: "post"
diff: 提高+/省选-
pid: AT_arc120_d
tag: []
---

# [ARC120D] Bracket Score 2

## 题目描述

[problemUrl]: https://atcoder.jp/contests/arc120/tasks/arc120_d

**括弧の対応が取れている文字列**を、次のうちいずれかの条件を満たす文字列と定義します。

- 空文字列
- ある括弧の対応が取れている空でない文字列 $ s,\ t $ が存在し、$ s,\ t $ をこの順に連結した文字列
- ある括弧の対応が取れている文字列 $ s $ が存在し、 `(`, $ s $, `)` をこの順に連結した文字列

また、括弧の対応が取れている文字列 $ s $ の $ i $ 文字目と $ j $ 文字目が**対応している**とは、以下の条件を全て満たすこととします。

- $ 1\ \le\ i\ <\ j\ \le\ |s| $
- $ s_i\ = $ `(`
- $ s_j\ = $ `)`
- $ s $ の $ i $ 文字目と $ j $ 文字目の間にある文字列 ($ i $ 文字目と $ j $ 文字目は含まない) は括弧の対応が取れている文字列である

長さ $ 2N $ の数列 $ A\ =\ (A_1,\ A_2,\ A_3,\ \dots,\ A_{2N}) $ が与えられます。  
 括弧の対応が取れている長さ $ 2N $ の文字列 $ s $ の**スコア**を、$ s $ の $ i $ 文字目と $ j $ 文字目が対応しているような全ての組 $ (i,\ j) $ について $ |A_i\ -\ A_j| $ を足し合わせたものと定義します。

括弧の対応が取れている長さ $ 2N $ の文字列のうち、スコアが最大となるような文字列を $ 1 $ つ求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ A_1 $ $ A_2 $ $ A_3 $ $ \dots $ $ A_{2N} $

## 输出格式

長さ $ 2N $ の括弧の対応が取れている文字列のうち、スコアが最大となるような文字列を $ 1 $ つ出力せよ。  
 正しい答えが複数存在する場合、どれを出力しても正解と判定される。

## 说明/提示

### 制約

- $ 1\ \le\ N\ \le\ 2\ \times\ 10^5 $
- $ 1\ \le\ A_i\ \le\ 10^9 $
- 入力に含まれる値は全て整数

### Sample Explanation 1

長さ $ 4 $ の括弧の対応が取れている文字列は `(())` と `()()` の $ 2 $ 種類あり、それぞれのスコアは以下の通りです。 - `(())` : $ |1\ -\ 4|\ +\ |2\ -\ 3|\ =\ 4 $ - `()()` : $ |1\ -\ 2|\ +\ |3\ -\ 4|\ =\ 2 $ よって、`(())` のみが正しい答えとなります。

### Sample Explanation 2

`(())` と `()()` のスコアは以下の通りです。 - `(())` : $ |2\ -\ 3|\ +\ |3\ -\ 2|\ =\ 2 $ - `()()` : $ |2\ -\ 3|\ +\ |2\ -\ 3|\ =\ 2 $ よって、この場合どちらを出力しても正解となります。

## 样例 #1

### 输入

```
2

1 2 3 4
```

### 输出

```
(())
```

## 样例 #2

### 输入

```
2

2 3 2 3
```

### 输出

```
()()
```



---

---
title: "[ARC122D] XOR Game"
layout: "post"
diff: 提高+/省选-
pid: AT_arc122_d
tag: []
---

# [ARC122D] XOR Game

## 题目描述

[problemUrl]: https://atcoder.jp/contests/arc122/tasks/arc122_d

黒板に $ 2N $ 個の整数が書かれており，そのうち $ i $ 番目の整数は $ A_i $ です．

Alice と Bob がゲームをします． ゲームは $ N $ ラウンドにわたって行われ，各ラウンドでは以下の操作を行います．

- まず，Alice が黒板に書かれている整数を一つ選び，消す． ここで選ばれた整数を $ x $ とする．
- 次に，Bob が黒板に書かれている整数を一つ選び，消す． ここで選ばれた整数を $ y $ とする．
- $ x\ \oplus\ y $ の値をノートに記録する．ただしここで $ \oplus $ はビットごとの排他的論理和を表す．

最終的に，黒板からは全ての整数が消え去り，ノートには $ N $ 個の整数が記録されます． ゲームのスコアは，ノートに記録された整数の最大値です． Alice の目標はスコアを最大化することで，Bob の目標はスコアを最小化することです． 両者が最適に行動した場合，ゲームのスコアがいくつになるか求めてください．

## 输入格式

入力は以下の形式で標準入力から与えられる．

> $ N $ $ A_1 $ $ A_2 $ $ \cdots $ $ A_{2N} $

## 输出格式

答えを出力せよ．

## 说明/提示

### 制約

- $ 1\ \leq\ N\ \leq\ 2\ \times\ 10^5 $
- $ 0\ \leq\ A_i\ <\ 2^{30} $
- 入力される値はすべて整数である

### Sample Explanation 1

例えば，以下のようなゲームの進行が考えられます．なお，この進行が最適な手順であるとは限りません． - ラウンド $ 1 $: - Alice が $ A_1=0 $ を選択する． - Bob が $ A_3=3 $ を選択する． - ノートに $ 0\ \oplus\ 3=3 $ が記録される． - ラウンド $ 2 $: - Alice が $ A_4=5 $ を選択する． - Bob が $ A_2=1 $ を選択する． - ノートに $ 5\ \oplus\ 1=4 $ が記録される． - ゲームのスコアが $ \max(3,4)=4 $ になる．

## 样例 #1

### 输入

```
2

0 1 3 5
```

### 输出

```
4
```

## 样例 #2

### 输入

```
2

0 0 0 0
```

### 输出

```
0
```

## 样例 #3

### 输入

```
10

974654030 99760550 750234695 255777344 907989127 917878091 818948631 690392797 579845317 549202360 511962375 203530861 491981716 64663831 561104719 541423175 301832976 252317904 471905694 350223945
```

### 输出

```
268507123
```



---

---
title: "[ARC123D] Inc, Dec - Decomposition"
layout: "post"
diff: 提高+/省选-
pid: AT_arc123_d
tag: []
---

# [ARC123D] Inc, Dec - Decomposition

## 题目描述

[problemUrl]: https://atcoder.jp/contests/arc123/tasks/arc123_d

整数列 $ A\ =\ (A_1,\ \ldots,\ A_N) $ が与えられます。

整数列 $ B\ =\ (B_1,\ \ldots,\ B_N) $ および $ C\ =\ (C_1,\ \ldots,\ C_N) $ の組であって、以下の条件を満たすものを考えます：

- $ 1\leq\ i\leq\ N $ に対して $ A_i\ =\ B_i\ +\ C_i $ が成り立つ。
- $ B $ は広義単調増加である。つまり $ 1\leq\ i\leq\ N-1 $ に対して $ B_i\leq\ B_{i+1} $ が成り立つ。
- $ C $ は広義単調減少である。つまり $ 1\leq\ i\leq\ N-1 $ に対して $ C_i\geq\ C_{i+1} $ が成り立つ。

$ \sum_{i=1}^N\ \bigl(\lvert\ B_i\rvert\ +\ \lvert\ C_i\rvert\bigr) $ としてありうる最小値を求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられます。

> $ N $ $ A_1 $ $ A_2 $ $ \ldots $ $ A_N $

## 输出格式

答えを出力してください。

## 说明/提示

### 制約

- $ 1\leq\ N\leq\ 2\times\ 10^5 $
- $ -10^8\leq\ A_i\leq\ 10^8 $

### Sample Explanation 1

最小値を与える整数列 $ B $, $ C $ として、例えば次があります： - $ B\ =\ (0,\ 0,\ 5) $ - $ C\ =\ (1,\ -2,\ -2) $ $ \sum_{i=1}^N\ \bigl(\lvert\ B_i\rvert\ +\ \lvert\ C_i\rvert\bigr)\ =\ (0+1)\ +\ (0+2)\ +\ (5+2)\ =\ 10 $ となっています。

### Sample Explanation 2

最小値を与える整数列 $ B $, $ C $ として、例えば次があります： - $ B\ =\ (0,\ 1,\ 2,\ 4) $ - $ C\ =\ (5,\ 3,\ 1,\ 1) $

### Sample Explanation 3

最小値を与える整数列 $ B $, $ C $ として、例えば次があります： - $ B\ =\ (-3) $ - $ C\ =\ (-7) $

## 样例 #1

### 输入

```
3

1 -2 3
```

### 输出

```
10
```

## 样例 #2

### 输入

```
4

5 4 3 5
```

### 输出

```
17
```

## 样例 #3

### 输入

```
1

-10
```

### 输出

```
10
```



---

---
title: "[ARC125D] Unique Subsequence"
layout: "post"
diff: 提高+/省选-
pid: AT_arc125_d
tag: []
---

# [ARC125D] Unique Subsequence

## 题目描述

[problemUrl]: https://atcoder.jp/contests/arc125/tasks/arc125_d

長さ $ N $ の整数列 $ A_1,A_2,\cdots,A_N $ が与えられます．

$ A $ の非空な部分列 $ s $ であって，以下の条件を満たすものの個数を $ 998244353 $ で割った余りを求めてください．

- $ A $ から $ s $ を取り出す方法が一意である． つまり，$ s=(s_1,s_2,\cdots,s_k) $ とした時，$ A_{idx(i)}=s_i $ ($ 1\ \leq\ i\ \leq\ k $)を満たす添字の列 $ 1\ \leq\ idx(1)\ <\ idx(2)\ <\ \cdots\ <\ idx(k)\ \leq\ N $ がちょうど一つ存在する．

## 输入格式

入力は以下の形式で標準入力から与えられる．

> $ N $ $ A_1 $ $ A_2 $ $ \cdots $ $ A_N $

## 输出格式

答えを出力せよ．

## 说明/提示

### 制約

- $ 1\ \leq\ N\ \leq\ 2\ \times\ 10^5 $
- $ 1\ \leq\ A_i\ \leq\ N $
- 入力される値はすべて整数である

### Sample Explanation 1

以下の $ 5 $ つの部分列が条件を満たします． - $ (1,1) $ - $ (1,2) $ - $ (1,2,1) $ - $ (2) $ - $ (2,1) $ 部分列 $ (1) $ は取り出す方法が $ 2 $ 通りあるので条件を満たしません．

## 样例 #1

### 输入

```
3

1 2 1
```

### 输出

```
5
```

## 样例 #2

### 输入

```
4

4 2 1 3
```

### 输出

```
15
```

## 样例 #3

### 输入

```
12

1 2 3 6 9 2 3 3 9 6 1 6
```

### 输出

```
1178
```



---

---
title: "[ARC126C] Maximize GCD"
layout: "post"
diff: 提高+/省选-
pid: AT_arc126_c
tag: []
---

# [ARC126C] Maximize GCD

## 题目描述

[problemUrl]: https://atcoder.jp/contests/arc126/tasks/arc126_c

$ N $ 項からなる正整数列 $ A\ =\ (A_1,\ A_2,\ \ldots,\ A_N) $ が与えられます。あなたはこの数列に対して、次の操作を $ 0 $ 回以上 $ K $ 回以下行うことができます：

- $ i\in\ \{1,2,\ldots,N\} $ をひとつ選び、$ A_i $ に $ 1 $ を加える。

操作後の $ \gcd(A_1,\ A_2,\ \ldots,\ A_N) $ としてありうる最大値を求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられます。

> $ N $ $ K $ $ A_1 $ $ A_2 $ $ \ldots $ $ A_N $

## 输出格式

操作後の $ \gcd(A_1,\ A_2,\ \ldots,\ A_N) $ としてありうる最大値を出力してください。

## 说明/提示

### 制約

- $ 2\leq\ N\leq\ 3\times\ 10^5 $
- $ 1\leq\ K\leq\ 10^{18} $
- $ 1\ \leq\ A_i\leq\ 3\times\ 10^5 $

### Sample Explanation 1

例えば以下のようにして、$ \gcd(A_1,\ A_2,\ A_3)\ =\ 5 $ を実現できます。 - $ i\ =\ 1 $ に対して $ 2 $ 回、$ i\ =\ 2 $ に対して $ 1 $ 回、$ i=3 $ に対して $ 1 $ 回の操作を行う。合計の操作回数は $ 4 $ 回で、$ K=6 $ 以下である。 - 操作の結果、$ A_1\ =\ 5 $, $ A_2\ =\ 5 $, $ A_3\ =\ 10 $ となり、$ \gcd(A_1,\ A_2,\ A_3)\ =\ 5 $ である。

### Sample Explanation 2

操作を一度も行わないことで、$ \gcd(A_1,\ A_2,\ A_3)\ =\ 10 $ を実現できます。

## 样例 #1

### 输入

```
3 6

3 4 9
```

### 输出

```
5
```

## 样例 #2

### 输入

```
3 4

30 10 20
```

### 输出

```
10
```

## 样例 #3

### 输入

```
5 12345

1 2 3 4 5
```

### 输出

```
2472
```



---

---
title: "[ARC126D] Pure Straight"
layout: "post"
diff: 提高+/省选-
pid: AT_arc126_d
tag: []
---

# [ARC126D] Pure Straight

## 题目描述

[problemUrl]: https://atcoder.jp/contests/arc126/tasks/arc126_d

$ N $ 項からなる正整数列 $ A\ =\ (A_1,\ A_2,\ \ldots,\ A_N) $ が与えられます。各 $ A_i $ は $ 1,\ 2,\ \ldots,\ K $ のいずれかです。

あなたはこの数列に対して、次の操作を何度でも行うことができます：

- 隣接する $ 2 $ 項を入れ替える。つまり、$ |i-j|=1 $ となる $ i,\ j $ を選び、$ A_i $ と $ A_j $ を入れ替える。

数列 $ A $ が以下の条件を満たすようにするために必要な操作回数の最小値を求めてください。

- 数列 $ A $ は、連続部分列として $ (1,\ 2,\ \ldots,\ K) $ を含む。 つまり、$ A_n\ =\ 1 $, $ A_{n+1}\ =\ 2 $, $ \ldots $, $ A_{n+K-1}\ =\ K $ が成り立つような $ N-K+1 $ 以下の正整数 $ n $ が存在する。

## 输入格式

入力は以下の形式で標準入力から与えられます。

> $ N $ $ K $ $ A_1 $ $ A_2 $ $ \ldots $ $ A_N $

## 输出格式

数列 $ A $ が条件を満たすようにするために必要な操作回数の最小値を出力してください。

## 说明/提示

### 制約

- $ 2\leq\ K\leq\ 16 $
- $ K\ \leq\ N\leq\ 200 $
- $ A_i $ は $ 1,\ 2,\ \ldots,\ K $ のいずれかに等しい
- 数列 $ A $ は、$ 1,\ 2,\ \ldots,\ K $ のそれぞれを少なくともひとつ含む

### Sample Explanation 1

例えば次のように操作を行うのが最適です。 - $ A_1 $ と $ A_2 $ を入れ替える。$ A $ は $ (1,3,2,1) $ へ変化する。 - $ A_2 $ と $ A_3 $ を入れ替える。$ A $ は $ (1,2,3,1) $ へ変化する。 - $ A_1\ =\ 1 $, $ A_2\ =\ 2 $, $ A_3\ =\ 3 $ が成り立ち、条件を満たす。

## 样例 #1

### 输入

```
4 3

3 1 2 1
```

### 输出

```
2
```

## 样例 #2

### 输入

```
5 5

4 1 5 2 3
```

### 输出

```
5
```

## 样例 #3

### 输入

```
8 4

4 2 3 2 4 2 1 4
```

### 输出

```
5
```



---

---
title: "[ARC127C] Binary Strings"
layout: "post"
diff: 提高+/省选-
pid: AT_arc127_c
tag: []
---

# [ARC127C] Binary Strings

## 题目描述

[problemUrl]: https://atcoder.jp/contests/arc127/tasks/arc127_c

すぬけくんは黒板に $ 1 $ 以上 $ (2^N-1) $ 以下の整数をすべて書きました． ただし，整数は $ 2 $ 進表記で書きました．

黒板に書かれた整数を文字列として見た時，辞書順で $ X $ 番目に小さい文字列を求めてください．

なお，入力において $ N $ は $ 10 $ 進法で与えられますが，$ X $ は $ 2 $ 進法で与えられます．

## 输入格式

入力は以下の形式で標準入力から与えられる．

> $ N $ $ X $

## 输出格式

答えを出力せよ．

## 说明/提示

### 制約

- $ 1\ \leq\ N\ \leq\ 10^6 $
- $ 1\ \leq\ X\ \leq\ 2^N-1 $
- $ X $ は $ 2 $ 進法で与えられる．

### Sample Explanation 1

黒板に書かれた文字列を辞書順に並べると，`1`,`10`,`100`,`101`,`11`,`110`,`111` です． また $ X=101(2\mathrm{進})=5(10\mathrm{進}) $ です． よって，答えは `11` になります．

## 样例 #1

### 输入

```
3

101
```

### 输出

```
11
```

## 样例 #2

### 输入

```
10

10100011
```

### 输出

```
1001001111
```

## 样例 #3

### 输入

```
1000000

11111
```

### 输出

```
1000000000000000000000000000000
```



---

---
title: "[ARC129C] Multiple of 7"
layout: "post"
diff: 提高+/省选-
pid: AT_arc129_c
tag: []
---

# [ARC129C] Multiple of 7

## 题目描述

[problemUrl]: https://atcoder.jp/contests/arc129/tasks/arc129_c

整数 $ N $ が与えられます．

`1`, `2`, $ \cdots $, `9` からなる文字列 $ s $ であって，以下の条件を満たすものを一つ求めてください．

- $ s $ の長さ $ |s| $ は $ 10^6 $ 以下．
- 次の条件を満たす整数の組 $ (l,r) $ ($ 1\ \leq\ l\ \leq\ r\ \leq\ |s| $) の個数がちょうど $ N $ である．
  - $ s $ の $ l $ 文字目から $ r $ 文字目までを取り出して数として見たとき，$ 7 $ で割り切れる．

なお，この問題の制約より，解が必ず存在することが証明できます．

## 输入格式

入力は以下の形式で標準入力から与えられる．

> $ N $

## 输出格式

条件を満たす $ s $ を出力せよ． 解が複数存在する場合，どれを出力しても正解とみなされる．

## 说明/提示

### 制約

- $ 1\ \leq\ N\ \leq\ 10^6 $
- 入力される値はすべて整数である

### Sample Explanation 1

$ (l,r)=(1,2),(2,3) $ の $ 2 $ つが条件を満たします．

### Sample Explanation 2

$ (l,r)=(1,1),(2,2),(1,2) $ の $ 3 $ つが条件を満たします．

## 样例 #1

### 输入

```
2
```

### 输出

```
142
```

## 样例 #2

### 输入

```
3
```

### 输出

```
77
```



---

---
title: "[ARC129D] -1+2-1"
layout: "post"
diff: 提高+/省选-
pid: AT_arc129_d
tag: []
---

# [ARC129D] -1+2-1

## 题目描述

[problemUrl]: https://atcoder.jp/contests/arc129/tasks/arc129_d

長さ $ N $ の整数列 $ A=(A_1,A_2,\cdots,A_N) $ が与えられます．

あなたは，以下の操作を好きな回数繰り返すことができます．

- 整数 $ i $ ($ 1\ \leq\ i\ \leq\ N $) を選び，$ A_{i-1},A_i,A_{i+1} $ にそれぞれ $ -1,2,-1 $ を足す． ただしここで，$ A_0 $ は $ A_N $ を指すものとし，また $ A_{N+1} $ は $ A_1 $ を指すものとする．

$ A $ のすべての要素を $ 0 $ にすることが可能かどうか判定し，また可能な場合は必要な最小の操作回数を求めてください．

## 输入格式

入力は以下の形式で標準入力から与えられる．

> $ N $ $ A_1 $ $ A_2 $ $ \cdots $ $ A_N $

## 输出格式

$ A $ のすべての要素を $ 0 $ にすることが不可能なら，`-1` と出力せよ． 可能ならば，必要な最小の操作回数を出力せよ．

## 说明/提示

### 制約

- $ 3\ \leq\ N\ \leq\ 200000 $
- $ -100\ \leq\ A_i\ \leq\ 100 $
- 入力される値はすべて整数である

### Sample Explanation 1

以下のように $ 5 $ 回操作すればよいです． - $ i=2 $ を選んで操作する．$ A=(2,2,-2,-2) $ になる． - $ i=3 $ を選んで操作する．$ A=(2,1,0,-3) $ になる． - $ i=3 $ を選んで操作する．$ A=(2,0,2,-4) $ になる． - $ i=4 $ を選んで操作する．$ A=(1,0,1,-2) $ になる． - $ i=4 $ を選んで操作する．$ A=(0,0,0,0) $ になる．

## 样例 #1

### 输入

```
4

3 0 -1 -2
```

### 输出

```
5
```

## 样例 #2

### 输入

```
3

1 0 -2
```

### 输出

```
-1
```

## 样例 #3

### 输入

```
4

1 -1 1 -1
```

### 输出

```
-1
```

## 样例 #4

### 输入

```
10

-28 -3 90 -90 77 49 -31 48 -28 -84
```

### 输出

```
962
```



---

---
title: "[ARC131D] AtArcher"
layout: "post"
diff: 提高+/省选-
pid: AT_arc131_d
tag: []
---

# [ARC131D] AtArcher

## 题目描述

[problemUrl]: https://atcoder.jp/contests/arc131/tasks/arc131_d

りんごさんはアーチェリーの大会「AtArcher」に出場しました。

AtArcher では、数直線上に表される的に $ N $ 本の矢を撃って合計得点を競います。的の中心は座標 $ 0 $ であり、矢が当たった位置に応じて以下のように得点が定められています。

- $ i\ =\ 0,\ 1,\ \dots,\ M-1 $ に対して、中心からの距離が $ r_i $ から $ r_{i+1} $ までの場所に当てると $ s_i $ 点を獲得し、中心からの距離が $ r_M $ より大きい場所に当てると $ 0 $ 点を獲得する。**境界に当たった場合は高い方の得点になる。**
- 中心から近いほど高得点が得られるようになっている。すなわち、次を満たす。
  - $ 0\ =\ r_0\ \lt\ r_1\ \lt\ \cdots\ \lt\ r_{M-1}\ \lt\ r_M $
  - $ s_0\ \gt\ s_1\ \gt\ \cdots\ \gt\ s_{M-1}\ \gt\ 0 $

例えば、$ r\ =\ (0,\ 2,\ 7,\ 9),\ s\ =\ (100,\ 70,\ 30) $ の場合、得点は下図のようになります。

 ![](https://cdn.luogu.com.cn/upload/vjudge_pic/AT_arc131_d/87bb83172b692d63b862011e8b84e6414b495125.png) 

さらに、AtArcher では「どの $ 2 $ 本の矢も距離 $ D $ 以上の間隔を空ける」という特殊ルールがあります。これに違反した場合は失格となり、全体の得点が $ 0 $ 点になります。

さて、りんごさんが全ての矢を撃ち終わった時点で、最大何点獲得できるでしょう？

## 输入格式

入力は以下の形式で標準入力から与えられます。

> $ N $ $ M $ $ D $ $ r_0 $ $ r_1 $ $ \cdots $ $ r_{M-1} $ $ r_M $ $ s_0 $ $ s_1 $ $ \cdots $ $ s_{M-1} $

## 输出格式

答えを出力してください。

## 说明/提示

### 制約

- $ 1\ \leq\ N\ \leq\ 10^5 $
- $ 1\ \leq\ M\ \leq\ 10^5 $
- $ 1\ \leq\ D\ \leq\ 10^6 $
- $ 0\ =\ r_0\ \lt\ r_1\ \lt\ \cdots\ \lt\ r_{M-1}\ \lt\ r_M\ \leq\ 10^{11} $
- $ 10^{11}\ \geq\ s_0\ \gt\ s_1\ \gt\ \cdots\ \gt\ s_{M-1}\ \gt\ 0 $
- 入力はすべて整数

### Sample Explanation 1

この入力例は問題文中の例に対応していますが、$ D\ =\ 3 $ となっています。 例えば、$ N\ =\ 3 $ 本の矢が座標 $ -6,\ -2,\ 1 $ に当たると、それぞれ $ 70,\ 100,\ 100 $ 点を獲得します。このとき合計得点は $ 270 $ 点となり、実現可能なものとしては最大です。 !\[\](https://img.atcoder.jp/arc131/3b9fbfbeaf90d953098e650d7b070e0d.png) なお、すべての矢を $ 100 $ 点のエリアに当てて $ 300 $ 点を取ることはできません。なぜなら、どの $ 2 $ 本の矢も距離 $ D\ =\ 3 $ 以上の間隔を空けなければ、失格で $ 0 $ 点になるからです。

### Sample Explanation 2

この入力例も問題文中の例に対応していますが、$ D\ =\ 8 $ となっています。 例えば、$ N\ =\ 3 $ 本の矢が座標 $ -7,\ 1,\ 9 $ に当たると、それぞれ $ 70,\ 100,\ 30 $ 点を獲得します。このとき合計得点は $ 200 $ 点となり、実現可能なものとしては最大です。 !\[\](https://img.atcoder.jp/arc131/aefdd113cd212d29142783d0ffb1ea1e.png)

### Sample Explanation 3

例えば、下図のように矢を当てると、合計得点は $ 111 $ 点となり、これが最大です。 !\[\](https://img.atcoder.jp/arc131/2058c9b1e1deeea3bc6bae11da70b210.png)

### Sample Explanation 4

$ N\ =\ 100 $ 本の矢を当てることができますが、失格にならないためには、得点が入るゾーンに $ 3 $ 本までしか入れることができません。

## 样例 #1

### 输入

```
3 3 3

0 2 7 9

100 70 30
```

### 输出

```
270
```

## 样例 #2

### 输入

```
3 3 8

0 2 7 9

100 70 30
```

### 输出

```
200
```

## 样例 #3

### 输入

```
7 5 47

0 10 40 100 160 220

50 25 9 6 3
```

### 输出

```
111
```

## 样例 #4

### 输入

```
100 1 5

0 7

100000000000
```

### 输出

```
300000000000
```

## 样例 #5

### 输入

```
15 10 85

0 122 244 366 488 610 732 854 976 1098 1220

10 9 8 7 6 5 4 3 2 1
```

### 输出

```
119
```



---

---
title: "[ARC131E] Christmas Wreath"
layout: "post"
diff: 提高+/省选-
pid: AT_arc131_e
tag: []
---

# [ARC131E] Christmas Wreath

## 题目描述

[problemUrl]: https://atcoder.jp/contests/arc131/tasks/arc131_e

高橋君は、$ N $ 個のボールと $ \frac{N(N-1)}{2} $ 個のロープからなるクリスマス飾りを持っています。ボールには $ 1 $ から $ N $ までの番号が付けられており、どの 2 つの相異なるボールについても、ちょうど 1 つのロープで結ばれています。

![ ](https://cdn.luogu.com.cn/upload/vjudge_pic/AT_arc131_e/201156bf72fd4f5c2906ec6e262f89d87bd43722.png)

彼は、それぞれのロープを赤・青・白のいずれかの色で点灯させることにしました。

見栄えを良くするため、以下の条件をすべて満たすようにしたいです。

> **条件1** 赤・青・白で点灯されているロープの数は、すべて同数である。
> 
> **条件2** 整数 $ a,\ b,\ c $ $ (1\ \leq\ a\ <\ b\ <\ c\ \leq\ N) $ であって、以下の 3 つのロープの色がすべて異なるものは存在しない。
> 
> - ボール $ a $ と $ b $ を結ぶロープ
> - ボール $ b $ と $ c $ を結ぶロープ
> - ボール $ a $ と $ c $ を結ぶロープ

条件を満たす点灯の方法を 1 つ構成してください。このような方法が存在しない場合、その旨を出力してください。

## 输入格式

入力は以下の形式で標準入力から与えられます。

> $ N $

## 输出格式

条件を満たす点灯の方法が存在しない場合は、`No` と出力してください。

存在する場合は、以下の形式で出力してください。

> Yes $ c_{1,2} $$ c_{1,3} $$ c_{1,4} $$ \ldots $$ c_{1,N} $ $ c_{2,3} $$ c_{2,4} $$ \ldots $$ c_{2,N} $ $ : $ $ c_{N-1,N} $

ただし、文字 $ c_{i,\ j} $ $ (1\ \leq\ i\ <\ j\ \leq\ N) $ は以下の通りにしてください。

- ボール $ i $ と $ j $ を結ぶロープを赤にするとき：$ c_{i,\ j}\ = $ `R`
- ボール $ i $ と $ j $ を結ぶロープを青にするとき：$ c_{i,\ j}\ = $ `B`
- ボール $ i $ と $ j $ を結ぶロープを白にするとき：$ c_{i,\ j}\ = $ `W`

## 说明/提示

### 制約

- $ 3\ \leq\ N\ \leq\ 50 $
- $ N $ は整数

### Sample Explanation 1

$ N=4 $ では、条件を満たす点灯の方法が存在しないため、`No` と出力すれば正解となります。 `Yes` のときの出力の一例も以下に示しておきますが、\*\*このケースでは不正解となります。\*\*これは、\*\*条件2\*\* で $ (a,\ b,\ c)\ =\ (1,\ 2,\ 3) $ を選ぶと、ボール $ a,\ b $ を結ぶロープは赤、ボール $ b,\ c $ を結ぶロープは白、ボール $ a,\ c $ を結ぶロープは青と、すべて異なるからです。 ``` Yes RBW WB R ```

## 样例 #1

### 输入

```
4
```

### 输出

```
No
```



---

---
title: "[ARC132D] Between Two Binary Strings"
layout: "post"
diff: 提高+/省选-
pid: AT_arc132_d
tag: []
---

# [ARC132D] Between Two Binary Strings

## 题目描述

[problemUrl]: https://atcoder.jp/contests/arc132/tasks/arc132_d

文字列の **美しさ** を、その文字列のなかで同じ $ 2 $ 文字が隣り合っている位置の個数として定義します。 例えば、`00011` の美しさは $ 3 $ で、`10101` の美しさは $ 0 $ です。

$ S_{n,m} $ を $ n $ 文字の `0` と $ m $ 文字の `1` からなる長さ $ n+m $ の文字列全体の集合とします。

$ s_1,s_2\ \in\ S_{n,m} $ について、$ s_1,s_2 $ の **距離** $ d(s_1,s_2) $ を 「隣り合った $ 2 $ 文字を入れ替える操作によって文字列 $ s_1 $ を文字列 $ s_2 $ に並び替えるのに必要な最小の操作回数」 と定義します。

また、$ s_1,s_2,s_3\in\ S_{n,m} $ について、$ s_2 $ が $ s_1 $ と $ s_3 $ の **間にある** ことを、$ d(s_1,s_3)=d(s_1,s_2)+d(s_2,s_3) $ で定義します。

$ s,t\in\ S_{n,m} $ が与えられるので、$ s $ と $ t $ の間にある文字列の美しさの最大値を出力してください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ n $ $ m $ $ s $ $ t $

## 输出格式

$ s $ と $ t $ の間にある文字列の美しさの最大値を出力せよ。

## 说明/提示

### 制約

- $ 2\ \le\ n\ +\ m\le\ 3\times\ 10^5 $
- $ 0\ \le\ n,m $
- $ s,t $ は $ n $ 文字の `0` と $ m $ 文字の `1` からなる長さ $ n+m $ の文字列

### Sample Explanation 1

`10110` と `01101` の距離は $ 2 $ で、これらの間にある文字列は、`10110`, `01110`, `01101`, `10101` です。 それぞれの美しさは $ 1,2,1,0 $ であるため、答えは $ 2 $ です。

### Sample Explanation 2

`000011` と `110000` の距離は $ 8 $ です。 美しさが最大になる文字列は `000011` と `110000` で、答えは $ 4 $ です。

## 样例 #1

### 输入

```
2 3

10110

01101
```

### 输出

```
2
```

## 样例 #2

### 输入

```
4 2

000011

110000
```

### 输出

```
4
```

## 样例 #3

### 输入

```
12 26

01110111101110111101001101111010110110

10011110111011011001111011111101001110
```

### 输出

```
22
```



---

---
title: "[ARC134D] Concatenate Subsequences"
layout: "post"
diff: 提高+/省选-
pid: AT_arc134_d
tag: []
---

# [ARC134D] Concatenate Subsequences

## 题目描述

[problemUrl]: https://atcoder.jp/contests/arc134/tasks/arc134_d

長さ $ 2N $ の数列 $ a $ が与えられます。

すぬけ君が $ (1,2,\ \ldots,\ N) $ の**空でない**（連続するとは限らない）部分列 $ x=(x_1,x_2,\ldots,x_k) $ を用いて、数列を作ろうとしています。 作られる数列は、$ a $ の $ x_1 $ 番目、$ x_2 $ 番目、$ \ldots $、$ x_k $ 番目、$ x_{1}+N $ 番目、$ \ldots $、$ x_{k}+N $ 番目の要素を抜き出してこの順で連結した数列です。

すぬけ君が作ることができる数列のうち、辞書順最小のものを求めてください。

 数列の辞書順とは？ 相異なる数列 $ S $ と数列 $ T $ の大小を判定するアルゴリズムを以下に説明します。

以下では $ S $ の $ i $ 番目の要素を $ S_i $ のように表します。また、 $ S $ が $ T $ より辞書順で小さい場合は $ S\ \lt\ T $ 、大きい場合は $ S\ \gt\ T $ と表します。

1. $ S $ と $ T $ のうち長さが短い方の数列の長さを $ L $ とします。$ i=1,2,\dots,L $ に対して $ S_i $ と $ T_i $ が一致するか調べます。
2. $ S_i\ \neq\ T_i $ である $ i $ が存在する場合、そのような $ i $ のうち最小のものを $ j $ とします。そして、$ S_j $ と $ T_j $ を比較して、 $ S_j $ が $ T_j $ より（数として）小さい場合は $ S\ \lt\ T $ 、大きい場合は $ S\ \gt\ T $ と決定して、アルゴリズムを終了します。
3. $ S_i\ \neq\ T_i $ である $ i $ が存在しない場合、 $ S $ と $ T $ の長さを比較して、$ S $ が $ T $ より短い場合は $ S\ \lt\ T $ 、長い場合は $ S\ \gt\ T $ と決定して、アルゴリズムを終了します。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ a_{1} $ $ \cdots $ $ a_{2N} $

## 输出格式

すぬけ君が作ることができる数列のうち、辞書順最小のものを出力せよ。

## 说明/提示

### 制約

- 与えられる入力は全て整数
- $ 1\ \leq\ N\ \leq\ 10^5 $
- $ 1\ \leq\ a_i\ \leq\ 10^9 $

### Sample Explanation 1

\- $ x\ =\ (2) $ とします。 - このとき、作られる数列は $ (1,2) $ となり辞書順最小です。

## 样例 #1

### 输入

```
3

2 1 3 1 2 2
```

### 输出

```
1 2
```

## 样例 #2

### 输入

```
10

38 38 80 62 62 67 38 78 74 52 53 77 59 83 74 63 80 61 68 55
```

### 输出

```
38 38 38 52 53 77 80 55
```

## 样例 #3

### 输入

```
12

52 73 49 63 55 74 35 68 22 22 74 50 71 60 52 62 65 54 70 59 65 54 60 52
```

### 输出

```
22 22 50 65 54 52
```



---

---
title: "[ARC136C] Circular Addition"
layout: "post"
diff: 提高+/省选-
pid: AT_arc136_c
tag: []
---

# [ARC136C] Circular Addition

## 题目描述

[problemUrl]: https://atcoder.jp/contests/arc136/tasks/arc136_c

長さ $ N $ の整数列 $ x=(x_0,x_1,\cdots,x_{N-1}) $ があります（添字が $ 0 $ から始まることに注意）． 最初，$ x $ の要素はすべて $ 0 $ です．

あなたは，以下の操作を好きな回数繰り返すことができます．

- 整数 $ i,k $ ($ 0\ \leq\ i\ \leq\ N-1 $, $ 1\ \leq\ k\ \leq\ N $) を選ぶ． その後，$ i\ \leq\ j\ \leq\ i+k-1 $ を満たすすべての $ j $ について，$ x_{j\bmod\ N} $ の値を $ 1 $ 増やす．

長さ $ N $ の整数列 $ A=(A_0,A_1,\cdots,A_{N-1}) $ が与えられます． $ x $ を $ A $ に一致させるために必要な最小の操作回数を求めてください．

## 输入格式

入力は以下の形式で標準入力から与えられる．

> $ N $ $ A_0 $ $ A_1 $ $ \cdots $ $ A_{N-1} $

## 输出格式

答えを出力せよ．

## 说明/提示

### 制約

- $ 1\ \leq\ N\ \leq\ 200000 $
- $ 1\ \leq\ A_i\ \leq\ 10^9 $
- 入力される値はすべて整数

### Sample Explanation 1

以下のように操作すればよいです． - 最初，$ x=(0,0,0,0) $ である． - $ i=1,k=3 $ で操作を行う．$ x=(0,1,1,1) $ となる． - $ i=3,k=3 $ で操作を行う．$ x=(1,2,1,2) $ となる．

## 样例 #1

### 输入

```
4

1 2 1 2
```

### 输出

```
2
```

## 样例 #2

### 输入

```
5

3 1 4 1 5
```

### 输出

```
7
```

## 样例 #3

### 输入

```
1

1000000000
```

### 输出

```
1000000000
```



---

---
title: "[ARC137D] Prefix XORs"
layout: "post"
diff: 提高+/省选-
pid: AT_arc137_d
tag: []
---

# [ARC137D] Prefix XORs

## 题目描述

[problemUrl]: https://atcoder.jp/contests/arc137/tasks/arc137_d

長さ $ N $ の整数列 $ A=(A_1,A_2,\cdots,A_N) $，及び整数 $ M $ が与えられます．

各 $ k=1,2,\cdots,M $ について，以下の操作をちょうど $ k $ 回行ったあとの $ A_N $ の値を求めてください．

- すべての $ i $ ($ 1\ \leq\ i\ \leq\ N $) について，$ A_i $ の値を $ A_1\ \oplus\ A_2\ \oplus\ \cdots\ \oplus\ A_i $ で置き換える． この置き換えはすべての $ i $ に対して同時に行う．

ただしここで，$ \oplus $ はビット単位 $ \mathrm{XOR} $ 演算を表します．

  ビット単位 $ \mathrm{XOR} $ 演算とは  非負整数 $ A,\ B $ のビット単位 $ \mathrm{XOR} $ 、$ A\ \oplus\ B $ は、以下のように定義されます。

- $ A\ \oplus\ B $ を二進表記した際の $ 2^k $ ($ k\ \geq\ 0 $) の位の数は、$ A,\ B $ を二進表記した際の $ 2^k $ の位の数のうち一方のみが $ 1 $ であれば $ 1 $、そうでなければ $ 0 $ である。
 
 例えば、$ 3\ \oplus\ 5\ =\ 6 $ となります (二進表記すると: $ 011\ \oplus\ 101\ =\ 110 $)。  
 一般に $ k $ 個の整数 $ p_1,\ p_2,\ p_3,\ \dots,\ p_k $ のビット単位 $ \mathrm{XOR} $ は $ (\dots\ ((p_1\ \oplus\ p_2)\ \oplus\ p_3)\ \oplus\ \dots\ \oplus\ p_k) $ と定義され、これは $ p_1,\ p_2,\ p_3,\ \dots\ p_k $ の順番によらないことが証明できます。

## 输入格式

入力は以下の形式で標準入力から与えられる．

> $ N $ $ M $ $ A_1 $ $ A_2 $ $ \cdots $ $ A_N $

## 输出格式

各 $ k $ に対する答えを空白区切りで出力せよ．

## 说明/提示

### 制約

- $ 1\ \leq\ N\ \leq\ 10^6 $
- $ 1\ \leq\ M\ \leq\ 10^6 $
- $ 0\ \leq\ A_i\ <\ 2^{30} $
- 入力される値はすべて整数

### Sample Explanation 1

操作の度に $ A $ は以下のように変化します． - 初期状態：$ A=(2,1,3) $ - $ 1 $ 回目の操作後：$ A=(2,3,0) $ - $ 2 $ 回目の操作後：$ A=(2,1,1) $

## 样例 #1

### 输入

```
3 2

2 1 3
```

### 输出

```
0 1
```

## 样例 #2

### 输入

```
10 12

721939838 337089195 171851101 1069204754 348295925 77134863 839878205 89360649 838712948 918594427
```

### 输出

```
716176219 480674244 678890528 642764255 259091950 663009497 942498522 584528336 364872846 145822575 392655861 844652404
```



---

---
title: "[ARC138D] Differ by K bits"
layout: "post"
diff: 提高+/省选-
pid: AT_arc138_d
tag: []
---

# [ARC138D] Differ by K bits

## 题目描述

[problemUrl]: https://atcoder.jp/contests/arc138/tasks/arc138_d

整数 $ N,K $ が与えられます． $ (0,1,\cdots,2^N-1) $ の順列 $ P=(P_0,P_1,\cdots,P_{2^N-1}) $ であって，以下の条件を満たすものが存在するか判定し， また存在するなら一つ構成してください．$ P $ の添字が $ 0 $ から始まることに注意してください．

- すべての $ i $ ($ 0\ \leq\ i\ \leq\ 2^N-1 $) について，$ P_i $ と $ P_{i+1\ \mod\ 2^N} $ は $ 2 $ 進表記でちょうど $ K $ 桁だけ異なる． なお，比較の際はどちらも leading $ 0 $'s を補って $ N $ 桁に揃えた上で比較する．

## 输入格式

入力は以下の形式で標準入力から与えられる．

> $ N $ $ K $

## 输出格式

条件を満たす $ P $ が存在しない場合，`No` と出力せよ． 存在する場合，以下の形式で答えを出力せよ．

> Yes $ P_0 $ $ P_1 $ $ \cdots $ $ P_{2^N-1} $

条件を満たす解が複数存在する場合，どれを出力しても正解とみなされる．

## 说明/提示

### 制約

- $ 1\ \leq\ K\ \leq\ N\ \leq\ 18 $
- 入力される値はすべて整数

### Sample Explanation 1

$ P $ を $ 2 $ 進表記で書くと，$ P=(000,001,011,010,110,111,101,100) $ です． 例えば $ P_1=001,P_2=011 $ なので，これらはちょうど $ 1 $ 桁だけ異なっており，$ i=1 $ について条件が成立していることが確認できます． 同様に，すべての $ i $ についても条件を満たしています．

## 样例 #1

### 输入

```
3 1
```

### 输出

```
Yes

0 1 3 2 6 7 5 4
```

## 样例 #2

### 输入

```
2 2
```

### 输出

```
No
```



---

---
title: "[ARC141C] Bracket and Permutation"
layout: "post"
diff: 提高+/省选-
pid: AT_arc141_c
tag: []
---

# [ARC141C] Bracket and Permutation

## 题目描述

[problemUrl]: https://atcoder.jp/contests/arc141/tasks/arc141_c

長さ $ 2N $ の文字列 $ S=S_1S_2\dots\ S_{2N} $ について、 $ S $ が $ N $ 個の `(` , および $ N $ 個の `)` で構成されるとき、 $ S $ は「括弧列」であるといいます。

また、「括弧列」$ S $ のうち、以下のいずれかに該当するものを「正しい括弧列」といいます。

- 空文字列
- ある「正しい括弧列」$ A $ が存在して `(`, $ A $, `)` をこの順に連結した文字列
- ある空でない「正しい括弧列」$ A,\ B $ が存在して、 $ A,\ B $ をこの順に連結した文字列

$ 1 $ から $ 2N $ までの整数からなる $ 2 $ つの順列 $ P=(P_1,\ P_2,\ \dots,\ P_{2N}),\ Q=(Q_1,\ Q_2,\ \dots,\ Q_{2N}) $ が与えられます。

以下の条件を満たすような「括弧列」$ S=S_1S_2\dots\ S_{2N} $ が存在するか判定してください。

- $ S_{p_1}S_{p_2}\dots\ S_{p_{2N}} $ が「正しい括弧列」となるような $ 1 $ から $ 2N $ までの整数の順列 $ p $ のうち、辞書式順序で最小のものが $ P $
- $ S_{p_1}S_{p_2}\dots\ S_{p_{2N}} $ が「正しい括弧列」となるような $ 1 $ から $ 2N $ までの整数の順列 $ p $ のうち、辞書式順序で最大のものが $ Q $

存在する場合は $ 1 $ つ求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられます。

> $ N $ $ P_1 $ $ P_2 $ $ \dots $ $ P_{2N} $ $ Q_1 $ $ Q_2 $ $ \dots $ $ Q_{2N} $

## 输出格式

上記のような「括弧列」$ S $ が存在する場合、そのうち $ 1 $ つを出力してください。答えが複数存在する場合はいずれを出力してもかまいません。

存在しない場合は `-1` を出力してください。

## 说明/提示

### 制約

- $ 1\ \leq\ N\ \leq\ 2\ \times\ 10^5 $
- $ 1\ \leq\ P_i,Q_i\ \leq\ 2N $
- $ P,\ Q $ はそれぞれ $ 1 $ から $ 2N $ までの整数の順列
- 入力される値はすべて整数

### Sample Explanation 1

$ S= $ `())(` のとき、$ S_{p_1}S_{p_2}S_{p_3}S_{p_4} $ が「正しい括弧列」となる $ p $ は $ p=(1,\ 4,\ 2,\ 3),\ (1,\ 4,\ 3,\ 2) $ などが考えられますが、このうち辞書式順序で最小のものは $ p=(1,\ 2,\ 4,\ 3) $ 、最大のものは $ p=(4,\ 3,\ 1,\ 2) $ であり、 $ S $ は条件を満たします。

### Sample Explanation 2

条件を満たす $ S $ は存在しません。

## 样例 #1

### 输入

```
2

1 2 4 3

4 3 1 2
```

### 输出

```
())(
```

## 样例 #2

### 输入

```
2

1 3 2 4

4 3 2 1
```

### 输出

```
-1
```

## 样例 #3

### 输入

```
3

2 1 5 3 4 6

6 5 3 4 2 1
```

### 输出

```
-1
```



---

---
title: "[ARC143D] Bridges"
layout: "post"
diff: 提高+/省选-
pid: AT_arc143_d
tag: []
---

# [ARC143D] Bridges

## 题目描述

[problemUrl]: https://atcoder.jp/contests/arc143/tasks/arc143_d

$ 1 $ 以上 $ N $ 以下の整数からなる $ 2 $ つの数列 $ A_1,\ldots,\ A_M $ および $ B_1,\ldots,B_M $ があります．

`0` と `1` からなる長さ $ M $ の文字列に対して，$ 2N $ 頂点 $ (M+N) $ 辺からなる次のような無向グラフを対応させます:

- $ i $ 番目の文字が `0` のとき，$ i $ 番目の辺は頂点 $ A_i $ と頂点 $ (B_i+N) $ を結ぶ辺である．
- $ i $ 番目の文字が `1` のとき，$ i $ 番目の辺は頂点 $ B_i $ と頂点 $ (A_i+N) $ を結ぶ辺である．
- $ (j+M) $ 番目の辺は頂点 $ j $ と頂点 $ (j+N) $ を結ぶ辺である．

ただし，$ i $, $ j $ はそれぞれ $ 1\ \leq\ i\ \leq\ M $, $ 1\ \leq\ j\ \leq\ N $ を満たす整数を動くものとします． また，頂点には $ 1 $ から $ 2N $ までの番号がついています．

対応する無向グラフに含まれる橋の個数が最小となるような，`0` と `1` からなる長さ $ M $ の文字列を $ 1 $ つ求めてください．

 橋について グラフの辺であって，その辺を除くと連結成分の個数が増えるようなものを橋と呼びます．

## 输入格式

入力は以下の形式で標準入力から与えられる．

> $ N $ $ M $ $ A_1 $ $ A_2 $ $ \cdots $ $ A_M $ $ B_1 $ $ B_2 $ $ \cdots $ $ B_M $

## 输出格式

条件を満たすような文字列を $ 1 $ つ出力せよ．答えが複数存在する場合，いずれを出力してもかまわない．

## 说明/提示

### 制約

- $ 1\ \leq\ N\ \leq\ 2\ \times\ 10^5 $
- $ 1\ \leq\ M\ \leq\ 2\ \times\ 10^5 $
- $ 1\ \leq\ A_i,\ B_i\ \leq\ N $

### Sample Explanation 1

`01` に対応するグラフには橋が存在しません． `00` に対応するグラフでは頂点 $ 1 $ と頂点 $ 3 $ を結ぶ辺と頂点 $ 2 $ と頂点 $ 4 $ を結ぶ辺が橋となるので， `00` は条件を満たしません．

## 样例 #1

### 输入

```
2 2

1 1

2 2
```

### 输出

```
01
```

## 样例 #2

### 输入

```
6 7

1 1 2 3 4 4 5

2 3 3 4 5 6 6
```

### 输出

```
0100010
```



---

---
title: "[ARC145D] Non Arithmetic Progression Set"
layout: "post"
diff: 提高+/省选-
pid: AT_arc145_d
tag: []
---

# [ARC145D] Non Arithmetic Progression Set

## 题目描述

[problemUrl]: https://atcoder.jp/contests/arc145/tasks/arc145_d

以下の条件を全て満たす整数集合 $ S $ を一つ構築してください。なお、この問題の制約下で条件を満たす $ S $ が少なくとも一つ存在することが証明できます。

- $ S $ の要素数は $ N $
- $ S $ の要素は $ -10^7 $ 以上 $ 10^7 $ 以下の相異なる整数
- $ \displaystyle\ \sum\ _{s\ \in\ S}\ s\ =\ M $
- $ S $ の任意の相異なる要素 $ x,y,z $ $ (x\ <\ y\ <\ z) $ について $ y-x\neq\ z-y $

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ M $

## 输出格式

$ S $ の要素を $ s_1,s_2,\ldots,s_N $ とする。条件を満たす $ S $ を $ 1 $ つ以下の形式で出力せよ。

> $ s_1 $ $ s_2 $ $ \ldots $ $ s_N $

条件を満たす解が複数存在する場合、どれを出力しても正解とみなされる。

## 说明/提示

### 制約

- $ 1\ \leq\ N\ \leq\ 10^4 $
- $ |M|\ \leq\ N\times\ 10^6 $
- 入力は全て整数

### Sample Explanation 1

$ 2-1\ \neq\ 6-2 $ であり、 $ 1+2+6=9 $ なのでこの出力は条件を満たします。他にも様々な答えが考えられます。

### Sample Explanation 2

$ M $ が負のこともあります。

## 样例 #1

### 输入

```
3 9
```

### 输出

```
1 2 6
```

## 样例 #2

### 输入

```
5 -15
```

### 输出

```
-15 -5 0 2 3
```



---

---
title: "[ARC147C] Min Diff Sum"
layout: "post"
diff: 提高+/省选-
pid: AT_arc147_c
tag: []
---

# [ARC147C] Min Diff Sum

## 题目描述

[problemUrl]: https://atcoder.jp/contests/arc147/tasks/arc147_c

$ 1,2,\ldots\ ,N $ の番号のついた $ N $ 人の人を数直線上に並べます。人 $ i\,(1\ \leq\ i\ \leq\ N) $ がいる地点の座標を $ x_i $ としたとき、 $ x_i $ は $ L_i $ 以上 $ R_i $ 以下の整数である必要があります。複数の人が同じ座標にいても構いません。

ここで、並べ方の**不満度**を以下の式で定義します。

> $ \displaystyle\sum_{i=1}^{N-1}\sum_{j=i+1}^{N}|x_j-x_i| $

不満度としてあり得る値の最小値を求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ L_1 $ $ R_1 $ $ L_2 $ $ R_2 $ $ \vdots $ $ L_N $ $ R_N $

## 输出格式

答えを出力せよ。

## 说明/提示

### 制約

- $ 2\ \leq\ N\ \leq\ 3\ \times\ 10^5 $
- $ 1\ \leq\ L_i\ \leq\ R_i\ \leq\ 10^7\ \,(1\ \leq\ i\ \leq\ N) $
- 入力はすべて整数

### Sample Explanation 1

$ x_1=3,x_2=4,x_3=5 $ とすると、不満度は $ 4 $ です。不満度を $ 3 $ 以下にすることはできないので、$ 4 $ を出力します。

## 样例 #1

### 输入

```
3

1 3

2 4

5 6
```

### 输出

```
4
```

## 样例 #2

### 输入

```
3

1 1

1 1

1 1
```

### 输出

```
0
```

## 样例 #3

### 输入

```
6

1 5

2 4

1 1

4 4

3 6

3 3
```

### 输出

```
15
```



---

---
title: "[ARC148D] mod M Game"
layout: "post"
diff: 提高+/省选-
pid: AT_arc148_d
tag: []
---

# [ARC148D] mod M Game

## 题目描述

[problemUrl]: https://atcoder.jp/contests/arc148/tasks/arc148_d

黒板に $ 2N $ 個の整数 $ A_1,\ A_2,\ ...,\ A_{2N} $ が書かれています。また、$ 2 $ 以上の整数 $ M $ があります。  
 Alice と Bob はゲームをします。 ゲームは Alice を先攻として、黒板の上の数が全てなくなるまで次の操作を交互に行います。

- 数を $ 1 $ 個選び、その数を黒板から消す。

ゲームを終了した時点で、(Alice が消した数の和) $ \text{mod\ }M $ と (Bob が消した数の和) $ \text{mod\ }M $ が一致していれば Bob の勝ち、そうでない場合は Alice の勝ちです。  
 両者が最善を尽くしたとき、どちらが勝ちますか？

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ M $ $ A_1 $ $ A_2 $ $ \dots $ $ A_{2N} $

## 输出格式

Alice が勝つ場合は `Alice` を、Bob が勝つ場合は `Bob` を出力せよ。

## 说明/提示

### 制約

- $ 1\ \leq\ N\ \leq\ 2\ \times\ 10^5 $
- $ 2\ \leq\ M\ \leq\ 10^9 $
- $ 0\ \leq\ A_i\ \leq\ M\ -\ 1 $
- 入力される値はすべて整数

### Sample Explanation 1

ゲームの進行例として次のようなものが考えられます。 - Alice が $ 1 $ を消す。 - Bob が $ 4 $ を消す。 - Alice が $ 5 $ を消す。 - Bob が $ 8 $ を消す。 このように進んだ場合、(Alice が消した数の和) $ \text{mod\ }M $ は $ (1\ +\ 5)\ \bmod\ 9\ =\ 6 $, (Bob が消した数の和) $ \text{mod\ }M $ は $ (4\ +\ 8)\ \bmod\ 9\ =\ 3 $ で、$ 6\ \neq\ 3 $ なので Alice の勝ちです。

## 样例 #1

### 输入

```
2 9

1 4 8 5
```

### 输出

```
Alice
```

## 样例 #2

### 输入

```
3 998244353

1 2 3 1 2 3
```

### 输出

```
Bob
```



---

---
title: "[ARC151C] 01 Game"
layout: "post"
diff: 提高+/省选-
pid: AT_arc151_c
tag: []
---

# [ARC151C] 01 Game

## 题目描述

[problemUrl]: https://atcoder.jp/contests/arc151/tasks/arc151_c

マス $ 1 $ 、マス $ 2 $ 、$ \ldots $ 、マス $ N $ の $ N $ 個のマスがあり、 $ i\ =\ 1,\ 2,\ \ldots,\ N-1 $ についてマス $ i $ とマス $ i+1 $ は隣り合っています。

はじめ、$ M $ 個のマスには $ 0 $ または $ 1 $ が書かれています。 具体的には、$ i\ =\ 1,\ 2,\ \ldots,\ M $ について、マス $ X_i $ に $ Y_i $ が書かれています。 また、その他の $ N-M $ 個のマスには何も書かれていません。

高橋君と青木君が $ 2 $ 人で対戦ゲームをします。 高橋君の先手で、$ 2 $ 人は交互に下記の行動を行います。

- まだ何も書かれていないマスを $ 1 $ つ選び、そのマスに $ 0 $ または $ 1 $ を書きこむ。 ただしその結果、ある $ 2 $ つの隣り合うマスに同じ数字が書かれた状態になってはならない。

先に行動することができなくなったプレイヤーの負けとなり、負けなかったプレイヤーの勝ちとなります。

両者がそれぞれ自身が勝つために最適な戦略をとる場合に、どちらが勝つかを判定してください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ M $ $ X_1 $ $ Y_1 $ $ X_2 $ $ Y_2 $ $ \vdots $ $ X_M $ $ Y_M $

## 输出格式

高橋君が勝つ場合は `Takahashi` を、青木君が勝つ場合は `Aoki` を出力せよ。

## 说明/提示

### 制約

- $ 1\ \leq\ N\ \leq\ 10^{18} $
- $ 0\ \leq\ M\ \leq\ \min\lbrace\ N,\ 2\ \times\ 10^5\ \rbrace $
- $ 1\ \leq\ X_1\ \lt\ X_2\ \lt\ \cdots\ \lt\ X_M\ \leq\ N $
- $ Y_i\ \in\ \lbrace\ 0,\ 1\rbrace $
- $ X_i\ +\ 1\ =\ X_{i+1}\ \implies\ Y_i\ \neq\ Y_{i+1} $
- 入力はすべて整数

### Sample Explanation 1

ゲームの進行の一例を示します。 1. 高橋君がマス $ 6 $ に $ 0 $ を書きこむ。 2. 青木君がマス $ 1 $ に $ 1 $ を書きこむ。 3. 高橋君がマス $ 7 $ に $ 1 $ を書きこむ。 その後、青木君はどのマスにも $ 0 $ または $ 1 $ を書きこむことが出来ないため、高橋君の勝ちとなります。

### Sample Explanation 2

ゲーム開始時点ですでにすべてのマスに $ 0 $ または $ 1 $ が書きこまれているため、先手の高橋君は行動できず青木君の勝ちとなります。

## 样例 #1

### 输入

```
7 2

2 0

4 1
```

### 输出

```
Takahashi
```

## 样例 #2

### 输入

```
3 3

1 1

2 0

3 1
```

### 输出

```
Aoki
```

## 样例 #3

### 输入

```
1000000000000000000 0
```

### 输出

```
Aoki
```



---

---
title: "[ARC151D] Binary Representations and Queries"
layout: "post"
diff: 提高+/省选-
pid: AT_arc151_d
tag: []
---

# [ARC151D] Binary Representations and Queries

## 题目描述

[problemUrl]: https://atcoder.jp/contests/arc151/tasks/arc151_d

長さ $ 2^N $ の整数列 $ A\ =\ (A_0,\ A_1,\ \ldots,\ A_{2^N-1}) $ が与えられます。

また、$ Q $ 個のクエリが与えられます。 $ i\ =\ 1,\ 2,\ \ldots,\ Q $ について、$ i $ 番目のクエリでは $ 2 $ つの整数 $ X_i,\ Y_i $ が与えられ、下記の操作を行います。

> $ j\ =\ 0,\ 1,\ 2,\ \ldots,\ 2^N-1 $ の順に下記の手順を行う。
> 
> 1. まず、$ j $ の $ N $ 桁の $ 2 $ 進数表現を $ b_{N-1}b_{N-2}\ldots\ b_0 $ とおく。また、$ b_{N-1}b_{N-2}\ldots\ b_0 $ から $ b_{X_i} $ を反転（ $ 0 $ ならば $ 1 $ に、$ 1 $ ならば $ 0 $ に変更）させて得られる $ 2 $ 進数表現によって表される整数を $ j' $ とおく。
> 2. そして、$ b_{X_i}\ =\ Y_i $ ならば、$ A_{j'} $ に $ A_j $ の値を加算する。

すべてのクエリを入力で与えられる順番に実行した後の $ A $ の各要素を $ 998244353 $ で割ったあまりを出力してください。

 $ N $ 桁の $ 2 $ 進数表現とは？非負整数 $ X $ ($ 0\ \leq\ X\ )\ の\ N $ 桁の $ 2 $ 進数表現とは、$ 0 $ と $ 1 $ のみからなり下記の条件を満たす唯一の、長さ $ N $ の列 $ b_{N-1}b_{N-2}\ldots\ b_0 $です。

- $ \sum_{i\ =\ 0}^{N-1}\ b_i\ \cdot\ 2^i\ =\ X $

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ Q $ $ A_0 $ $ A_1 $ $ \ldots $ $ A_{2^N-1} $ $ X_1 $ $ Y_1 $ $ X_2 $ $ Y_2 $ $ \vdots $ $ X_Q $ $ Y_Q $

## 输出格式

$ i\ =\ 0,\ 1,\ \ldots,\ 2^N-1 $ について、すべてのクエリを実行した後の $ A_i $ を $ 998244353 $ で割ったあまり $ A'_i $ を、下記の形式にしたがって空白区切りで出力せよ。

> $ A'_0 $ $ A'_1 $ $ \ldots $ $ A'_{2^N-1} $

## 说明/提示

### 制約

- $ 1\ \leq\ N\ \leq\ 18 $
- $ 1\ \leq\ Q\ \leq\ 2\ \times\ 10^5 $
- $ 0\ \leq\ A_i\ \lt\ 998244353 $
- $ 0\ \leq\ X_i\ \leq\ N-1 $
- $ Y_i\ \in\ \lbrace\ 0,\ 1\rbrace $
- 入力はすべて整数

### Sample Explanation 1

$ 1 $ 番目のクエリに対する操作は次の通りです。 - $ j\ =\ 0 $ のとき、$ b_1b_0\ =\ 00,\ j'\ =\ 2 $ です。$ b_1\ \neq\ 1 $ であるので、加算の手順は行いません。 - $ j\ =\ 1 $ のとき、$ b_1b_0\ =\ 01,\ j'\ =\ 3 $ です。$ b_1\ \neq\ 1 $ であるので、加算の手順は行いません。 - $ j\ =\ 2 $ のとき、$ b_1b_0\ =\ 10,\ j'\ =\ 0 $ です。$ b_1\ =\ 1 $ であるので、$ A_0 $ に $ A_2 $ の値を加算します。その結果、$ A\ =\ (2,\ 1,\ 2,\ 3) $ となります。 - $ j\ =\ 3 $ のとき、$ b_1b_0\ =\ 11,\ j'\ =\ 1 $ です。$ b_1\ =\ 1 $ であるので、$ A_1 $ に $ A_3 $ の値を加算します。その結果、$ A\ =\ (2,\ 4,\ 2,\ 3) $ となります。 $ 2 $ 番目のクエリに対する操作は次の通りです。 - $ j\ =\ 0 $ のとき、$ b_1b_0\ =\ 00,\ j'\ =\ 1 $ です。$ b_0\ =\ 0 $ であるので、$ A_1 $ に $ A_0 $ の値を加算します。その結果、$ A\ =\ (2,\ 6,\ 2,\ 3) $ となります。 - $ j\ =\ 1 $ のとき、$ b_1b_0\ =\ 01,\ j'\ =\ 0 $ です。$ b_0\ \neq\ 0 $ であるので、加算の手順は行いません。 - $ j\ =\ 2 $ のとき、$ b_1b_0\ =\ 10,\ j'\ =\ 3 $ です。$ b_0\ =\ 0 $ であるので、$ A_3 $ に $ A_2 $ の値を加算します。その結果、$ A\ =\ (2,\ 6,\ 2,\ 5) $ となります。 - $ j\ =\ 3 $ のとき、$ b_1b_0\ =\ 11,\ j'\ =\ 2 $ です。$ b_0\ \neq\ 0 $ であるので、加算の手順は行いません。 以上より、すべてのクエリを実行した後の $ A $ は $ (2,\ 6,\ 2,\ 5) $ です。

## 样例 #1

### 输入

```
2 2

0 1 2 3

1 1

0 0
```

### 输出

```
2 6 2 5
```

## 样例 #2

### 输入

```
3 10

606248357 338306877 919152167 981537317 808873985 845549408 680941783 921035119

1 1

0 0

0 0

0 0

0 1

0 1

0 1

2 0

2 0

2 0
```

### 输出

```
246895115 904824001 157201385 744260759 973709546 964549010 61683812 205420980
```



---

---
title: "[ARC155C] Even Sum Triplet"
layout: "post"
diff: 提高+/省选-
pid: AT_arc155_c
tag: ['分类讨论']
---

# [ARC155C] Even Sum Triplet

## 题目描述

[problemUrl]: https://atcoder.jp/contests/arc155/tasks/arc155_c

長さ $ N $ の整数列 $ A=(A_1,\ A_2,\ \dots,\ A_N),\ B=(B_1,\ B_2,\ \dots,\ B_N) $ が与えられます。

あなたは以下の操作を好きな回数行うことができます。

- $ A_i+A_{i+1}+A_{i+2} $ が偶数であるような整数 $ i\ (1\ \leq\ i\ \leq\ N-2) $ を選ぶ。そして $ A_i,\ A_{i+1},\ A_{i+2} $ を好きに並び替える。
 
$ A $ を $ B $ に一致させることができるか判定してください。

## 输入格式

入力は以下の形式で標準入力から与えられます。

> $ N $ $ A_1 $ $ A_2 $ $ \dots $ $ A_N $ $ B_1 $ $ B_2 $ $ \dots $ $ B_N $

## 输出格式

$ A $ を $ B $ に一致させることが可能な場合は `Yes` を、そうでない場合は `No` を出力せよ。

## 说明/提示

### 制約

- $ 3\ \leq\ N\ \leq\ 2\ \times\ 10^5 $
- $ 1\ \leq\ A_i,\ B_i\ \leq\ 2\ \times\ 10^5 $
- 入力される値はすべて整数
 
### Sample Explanation 1

$ A_1+A_2+A_3 $ は $ 1+2+3=6 $ であり偶数なので、操作では $ i=1 $ を選ぶことができます。 $ i=1 $ を選んで操作し、$ A_1,\ A_2,\ A_3 $ を $ A_3,\ A_1,\ A_2 $ に並び替えると、 $ A $ は $ (3,\ 1,\ 2,\ 4,\ 5) $ に変化します。 この操作により $ A $ を $ B $ に一致させることができるので、 `Yes` を出力します。

## 样例 #1

### 输入

```
5

1 2 3 4 5

3 1 2 4 5
```

### 输出

```
Yes
```

## 样例 #2

### 输入

```
5

1 2 4 6 5

5 1 4 2 6
```

### 输出

```
No
```

## 样例 #3

### 输入

```
9

2 10 4 3 6 2 6 8 5

2 4 10 3 8 6 6 2 5
```

### 输出

```
Yes
```



---

---
title: "[ARC183B] Near Assignment"
layout: "post"
diff: 提高+/省选-
pid: AT_arc183_b
tag: ['分类讨论']
---

# [ARC183B] Near Assignment

## 题目描述

给定两个长度为 $n$ 的序列 $A,B$ 以及整数 $k$，可以进行以下操作任意多次（也可以不操作）：

选择两个整数 $i,j$（$1\le i,j\le n$）满足 $|i-j|\le k$，将 $a_i$ 的值变为 $a_j$。

求是否可以将 $A$ 序列变为 $B$ 序列，如果可以，输出 `Yes`，否则输出 `No`。多组询问。

## 输入格式

第一行一个正整数 $T$ 表示数据组数。

每组数据第一行两个正整数 $n,k$，题目接下来两行分别 $n$ 个数表示序列 $A$ 和 $B$。

## 输出格式

对于每一组数据，输出 `Yes` 表示可以将 $A$ 变为 $B$，否则输出 `No`。

## 说明/提示

样例的第 1 组数据解释：

选择 $i=2,j=3$，则 $a_2\leftarrow a_3=2$，$A$ 变成 $(1,2,2)$。

对于所有数据，满足：$1\le T\le 1.25\times 10^5,1\le k<n\le 2.5\times 10^5,\sum n\le2.5\times 10^5$。保证输入的数都是整数。

## 样例 #1

### 输入

```
4

3 1

1 1 2

1 2 2

5 4

2 4 5 1 3

2 1 3 2 2

13 1

3 1 3 3 5 3 3 4 2 2 2 5 1

5 3 3 3 4 2 2 2 2 5 5 1 3

20 14

10 6 6 19 13 16 15 15 2 10 2 16 9 12 2 6 13 5 5 9

5 9 6 2 10 19 16 15 13 12 10 2 9 6 5 16 19 12 15 13
```

### 输出

```
Yes

Yes

No

Yes
```



---

---
title: "[ARC191C] A^n - 1"
layout: "post"
diff: 提高+/省选-
pid: AT_arc191_c
tag: []
---

# [ARC191C] A^n - 1

## 题目描述

[problemUrl]: https://atcoder.jp/contests/arc191/tasks/arc191_c

$ 1 $ 以上 $ 10^9 $ 以下の正整数 $ N $ が与えられます。

以下の条件を共に満たす正整数の組 $ (A,M) $ を一つ求めてください。ただし、制約下でそのような正整数の組が必ず存在することが証明できます。

- $ A,M $ はどちらも $ 1 $ 以上 $ 10^{18} $ 以下の正整数である。
- $ A^n-1 $ が $ M $ の倍数となるような正整数 $ n $ が存在し、その最小値は $ N $ である。

$ T $ 個のテストケースが与えられるので、それぞれについて答えを求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ T $ $ \text{case}_1 $ $ \text{case}_2 $ $ \vdots $ $ \text{case}_T $

ここで、 $ \text{case}_i $ は $ i $ 番目のテストケースを意味する。

各テストケースは以下の形式で与えられる。

> $ N $

## 输出格式

それぞれのケースについて、条件を満たす正整数の組 $ (A,M) $ を以下の形式で出力せよ。

> $ A $ $ M $

条件を満たす解が複数存在する場合、どれを出力しても正解とみなされる。

## 说明/提示

### 制約

- $ 1\le\ T\le\ 10^4 $
- $ 1\le\ N\le\ 10^9 $
- 入力される値は全て整数

### Sample Explanation 1

$ \text{case}_1 $ について考えます。 例えば $ (A,M)=(2,7) $ とすると - $ n=1 $ のとき： $ 2^1-1=1 $ は $ 7 $ の倍数ではない。 - $ n=2 $ のとき： $ 2^2-1=3 $ は $ 7 $ の倍数ではない。 - $ n=3 $ のとき： $ 2^3-1=7 $ は $ 7 $ の倍数である。 となり、条件を満たす最小の $ n $ は $ 3 $ になることが確認できます。したがって、 $ (A,M)=(2,7) $ を出力すると正答となります。 この他にも、例えば $ (A,M)=(100,777) $ などが条件を満たします。

## 样例 #1

### 输入

```
4
3
16
1
55
```

### 输出

```
2 7
11 68
20250126 1
33 662
```



---

---
title: "数列と計算"
layout: "post"
diff: 提高+/省选-
pid: AT_bcu30_f
tag: []
---

# 数列と計算

## 题目描述

[problemUrl]: https://atcoder.jp/contests/bcu30/tasks/bcu30_f

ある町に、数列が大好きな黒猫と計算が大好きな狼が住んでいます。今日は、二人である数列をもとに計算をして遊ぶことにしました。

黒猫は、長さ $ N $ の整数列 {$ a_i $} を持っていて、この数列の隣り合う項の間に $ + $ または $ \times $ を挿入した式を作り、狼がその値を計算しようとしています。 二人はこの整数列を使いできるだけ長く遊びたいので、作ることができる全ての式 ($ 2^{N-1} $ 通りある) を作り、それらの式の値の合計を求めることにしました。

最終的に答えが合っているかどうかをチェックしたいので、二人はこれらの合計を $ 1,000,000,007\ (=\ 10^9\ +\ 7) $ で割ったあまりを求めるプログラムを作ることを、プログラミングコンテストで日々鍛錬を続けているあなたに頼んできました。

あなたはこの値を計算するプログラムを作ることで、二人を助けてください。

ただし、 $ \times $ は $ + $ よりも計算の優先順序が高いことに注意してください。

## 输入格式

入力は以下の形式で与えられる。

> $ N $ $ a_1 $ ... $ a_N $

## 输出格式

求める答えを出力せよ。

## 说明/提示

### 制約

- $ 1\ \leq\ N\ \leq\ 10^5 $
- $ 1\ \leq\ a_i\ \leq\ 10^9 $ $ (1\ \leq\ i\ \leq\ N) $
- $ a_i $ $ (1\ \leq\ i\ \leq\ N) $ は整数である。

### Sample Explanation 1

考えられる数式は、 $ 1+2+3 $ と $ 1+2\ \times\ 3 $ と $ 1\ \times\ 2+3 $ と $ 1\ \times\ 2\ \times\ 3 $ の $ 4 $ 種類です。 これらの式を計算すると、それぞれ答えは $ 6 $、$ 7 $、$ 5 $、$ 6 $ となるので、合計は $ 6+7+5+6=24 $ です。

### Sample Explanation 2

求める合計は $ 1000000007\ (=\ 10^9+7) $ となるので、これを $ 10^9+7 $ で割ったあまりである $ 0 $ を出力します。

## 样例 #1

### 输入

```
3

1 2 3
```

### 输出

```
24
```

## 样例 #2

### 输入

```
2

28055 35642
```

### 输出

```
0
```

## 样例 #3

### 输入

```
12

31415926 535897932 38462643 383279502 884197 169399375 105820974 944592307 81640628 620899862 803482534 21170679
```

### 输出

```
626713706
```



---

---
title: "Negative Doubling"
layout: "post"
diff: 提高+/省选-
pid: AT_caddi2018_c
tag: []
---

# Negative Doubling

## 题目描述

[problemUrl]: https://atcoder.jp/contests/caddi2018/tasks/caddi2018_c

$ N $ 個の正の整数 $ A_1,\ A_2,\ ...,\ A_N $ があります． 高橋君は，これらの整数に対して，次の操作を好きな回数行うことができます：

- $ 1\ \leq\ i\ \leq\ N $ を選び，$ A_i $ の値を $ -2 $ 倍にする．

**マイナス** $ 2 $ 倍であることに注意してください．

高橋君は，$ A_1\ \leq\ A_2\ \leq\ ...\ \leq\ A_N $ が成り立つようにしたいです． このために必要な操作の回数の最小値を求めてください．ただし，不可能な場合は `-1` を出力してください．

## 输入格式

入力は以下の形式で標準入力から与えられる．

> $ N $ $ A_1 $ $ A_2 $ $ ... $ $ A_N $

## 输出格式

答えを出力せよ．

## 说明/提示

### 制約

- $ 1\ \leq\ N\ \leq\ 200000 $
- $ 1\ \leq\ A_i\ \leq\ 10^9 $

### Sample Explanation 1

例えば，次のようにすればよいです． - $ i=4 $ を選び，$ A_4 $ の値を $ -2 $ 倍にする．$ A_1,\ A_2,\ A_3,\ A_4 $ はそれぞれ $ 3,\ 1,\ 4,\ -2 $ になる． - $ i=1 $ を選び，$ A_1 $ の値を $ -2 $ 倍にする．$ A_1,\ A_2,\ A_3,\ A_4 $ はそれぞれ $ -6,\ 1,\ 4,\ -2 $ になる． - $ i=4 $ を選び，$ A_4 $ の値を $ -2 $ 倍にする．$ A_1,\ A_2,\ A_3,\ A_4 $ はそれぞれ $ -6,\ 1,\ 4,\ 4 $ になる．

### Sample Explanation 2

操作を一切せずとも $ A_1\ \leq\ A_2\ \leq\ ...\ \leq\ A_N $ が成り立っています．

## 样例 #1

### 输入

```
4

3 1 4 1
```

### 输出

```
3
```

## 样例 #2

### 输入

```
5

1 2 3 4 5
```

### 输出

```
0
```

## 样例 #3

### 输入

```
8

657312726 129662684 181537270 324043958 468214806 916875077 825989291 319670097
```

### 输出

```
7
```



---

---
title: "マスと駒と色塗り"
layout: "post"
diff: 提高+/省选-
pid: AT_codefestival_2015_qualB_d
tag: []
---

# マスと駒と色塗り

## 题目描述

[problemUrl]: https://atcoder.jp/contests/code-festival-2015-qualb/tasks/codefestival_2015_qualB_d

$ 10^{100} $ 個の白いマスが横 $ 1 $ 列に並んでいます。左から $ i\ (1≦i≦10^{100}) $ 番目のマスをマス $ i $ と呼びます。

また、駒が $ N $ 個あり、$ i\ (1≦i≦N) $ 番目の駒を駒 $ i $ と呼びます。

さらに、$ 0 $ から $ 10^{100} $ までの数を数えることのできるカウンタが $ 1 $ つあります。

これらのマスと駒に対し $ N $ 回の操作を行います。$ i\ (1≦i≦N) $ 回目の操作は以下のように行います。

1. まず、マス $ S_i $ に駒 $ i $ を置き、カウンタを $ 0 $ に初期化する。
2. 駒のあるマスの色が白ならそのマスを黒に塗ってカウンタを $ 1 $ 増加させ、駒のあるマスの色が黒なら $ 1 $ つ右のマスに駒を移動させる。
3. $ 2. $ を繰り返していき、カウンタの値が $ C_i $ になったらその時点で操作を終了する。

これらの操作が終わった時点で $ N $ 個の駒がそれぞれどのマスにあるかを求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ S_1 $ $ C_1 $ $ S_2 $ $ C_2 $ : $ S_N $ $ C_N $

- $ 1 $ 行目には、整数 $ N\ (1\ ≦\ N\ ≦\ 10^5) $ が与えられる。
- $ 2 $ 行目からの $ N $ 行には、各操作の情報が与えられる。このうち $ i\ (1\ ≦\ i\ ≦\ N) $ 行目には、整数 $ S_i\ (1\ ≦\ S_i\ ≦\ 10^9),\ C_i\ (1≦C_i≦10^9) $ が与えられる。これは $ i $ 回目の操作のはじめに駒 $ i $ を置くマスがマス $ S_i $ であり、カウンタが $ C_i $ になった時点で操作 $ i $ が終了となることを表す。

## 输出格式

出力は $ N $ 行からなる。このうち $ i\ (1≦i≦N) $ 行目には、全ての操作が終わった時点で駒 $ i $ があるマスの番号を表す $ 1 $ つの整数を出力せよ。出力の末尾にも改行を入れること。

## 说明/提示

### 部分点

この問題には部分点が設定されている。

- 全ての操作が終わった時点での駒のあるマスの番号が全て $ 10^5 $ 以下であるデータセットに正解した場合は、$ 35 $ 点が与えられる。
- $ N\ ≦\ 1000 $ を満たすデータセットに正解した場合は、上記とは別に $ 40 $ 点が与えられる。
- 追加の制約のないデータセットに正解した場合は、上記とは別に $ 25 $ 点が与えられる。

### Sample Explanation 1

下図は各操作後のマスと駒の状態を表しています。 !\[figure1\](http://code-festival-2015-qualb.contest.atcoder.jp/img/other/code\_festival\_2015\_qualb/komasunuri.png)

### Sample Explanation 3

出力が $ 32 $ bit整数型に収まらない場合もあることに注意してください。

## 样例 #1

### 输入

```
4

3 3

10 1

4 2

2 4
```

### 输出

```
5

10

7

11
```

## 样例 #2

### 输入

```
8

2 1

3 1

1 1

5 1

1 1

9 1

8 2

7 9
```

### 输出

```
2

3

1

5

4

9

10

18
```

## 样例 #3

### 输入

```
5

1000000000 1000000000

1000000000 1000000000

1000000000 1000000000

1000000000 1000000000

1000000000 1000000000
```

### 输出

```
1999999999

2999999999

3999999999

4999999999

5999999999
```



---

---
title: "マス目と整数"
layout: "post"
diff: 提高+/省选-
pid: AT_codefestival_2016_qualA_d
tag: []
---

# マス目と整数

## 题目描述

[problemUrl]: https://atcoder.jp/contests/code-festival-2016-quala/tasks/codefestival_2016_qualA_d

縦 $ R $ 行、横 $ C $ 列のマス目があります。 上から $ r $ 行目、左から $ c $ 列目にあるマスを $ (r，c) $ と呼びます。

高橋君は $ N $ 箇所のマスに非負整数を書き込みました。 具体的には、各 $ 1\ <\ =i\ <\ =N $ について、マス $ (r_i，c_i) $ に非負整数 $ a_i $ を書き込みました。 その後、高橋君は居眠りを始めました。

マス目を見つけた青木君は、残りすべてのマスに整数を書き込み、高橋君を驚かせようとしています。 高橋君を驚かせるためには、マス目が次の条件を満たさなければなりません。

- 条件 $ 1 $ : 各マスには非負整数が書き込まれている。
- 条件 $ 2 $ : 縦 $ 2 $ 行、横 $ 2 $ 列の正方形をどこから取り出しても、$ (左上の整数)\ +\ (右下の整数)\ =\ (右上の整数)\ +\ (左下の整数) $ が常に成り立つ。

残りすべてのマスに書き込む整数を工夫することで、マス目が条件を満たすようにできるか判定してください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ R $ $ C $ $ N $ $ r_1 $ $ c_1 $ $ a_1 $ $ r_2 $ $ c_2 $ $ a_2 $ $ : $ $ r_N $ $ c_N $ $ a_N $

## 输出格式

残りすべてのマスに書き込む整数を工夫することで、マス目が条件を満たすようにできるならば、`Yes` を出力せよ。 できないならば、`No` を出力せよ。

## 说明/提示

### 制約

- $ 2\ <\ =R，C\ <\ =10^5 $
- $ 1\ <\ =N\ <\ =10^5 $
- $ 1\ <\ =r_i\ <\ =R $
- $ 1\ <\ =c_i\ <\ =C $
- $ (r_i，c_i) $ はすべて相異なる。
- $ a_i $ は整数である。
- $ 0\ <\ =a_i\ <\ =10^9 $

### Sample Explanation 1

図のように整数を書き込めばよいです。 !\[\](/img/other/code\_festival\_2016\_quala/gbanjthabot/D\_0.png)

### Sample Explanation 2

マス目には次の $ 2 $ 個の正方形があります。 - マス $ (1，1) $，$ (1，2) $，$ (2，1) $，$ (2，2) $ からなる正方形 - マス $ (1，2) $，$ (1，3) $，$ (2，2) $，$ (2，3) $ からなる正方形 左側の正方形において条件 $ 2 $ が成り立つためには、空きマスの整数は $ 40 $ でなければなりません。 すると、右側の正方形において条件 $ 2 $ が成り立たなくなります。 !\[\](/img/other/code\_festival\_2016\_quala/gbanjthabot/D\_1.png)

### Sample Explanation 3

条件 $ 2 $ が成り立つためには、空きマスの整数は $ -10 $ でなければなりません。 すると、条件 $ 1 $ が成り立たなくなります。 !\[\](/img/other/code\_festival\_2016\_quala/gbanjthabot/D\_2.png)

### Sample Explanation 4

例えば、図のように整数を書き込めばよいです。 !\[\](/img/other/code\_festival\_2016\_quala/gbanjthabot/D\_3.png)

### Sample Explanation 5

既にすべてのマスに整数が書き込まれており、条件 $ 2 $ が成り立っていません。 !\[\](/img/other/code\_festival\_2016\_quala/gbanjthabot/D\_4.png)

## 样例 #1

### 输入

```
2 2

3

1 1 0

1 2 10

2 1 20
```

### 输出

```
Yes
```

## 样例 #2

### 输入

```
2 3

5

1 1 0

1 2 10

1 3 20

2 1 30

2 3 40
```

### 输出

```
No
```

## 样例 #3

### 输入

```
2 2

3

1 1 20

1 2 10

2 1 0
```

### 输出

```
No
```

## 样例 #4

### 输入

```
3 3

4

1 1 0

1 3 10

3 1 10

3 3 20
```

### 输出

```
Yes
```

## 样例 #5

### 输入

```
2 2

4

1 1 0

1 2 10

2 1 30

2 2 20
```

### 输出

```
No
```



---

---
title: "Friction"
layout: "post"
diff: 提高+/省选-
pid: AT_codefestival_2016_qualC_d
tag: []
---

# Friction

## 题目描述

[problemUrl]: https://atcoder.jp/contests/code-festival-2016-qualc/tasks/codefestival_2016_qualC_d

高橋君の部屋には縦 $ H $ 行、横 $ W $ 列、 $ H\ \times\ W $ 個のブロックからなるオブジェがあります。 各ブロックには色がついています。色は英小文字(`a`-`z`) で表されます。上から $ i $ 個目、左から $ j $ 個目のブロックの色は $ c_{i,j} $ です。

あまり見栄えが良くないため高橋君はこのオブジェを解体しようとしています。解体作業は以下の操作の繰り返しになります。

- $ W $ 個の列のうち一つを選び、その列を一段沈める。その列の一番下にあったブロックは消滅する。

同じ色のブロックは引き寄せ合う力を持つため、この操作にかかるコストは、「選んだ列のブロックと(操作前に)横に隣り合っているブロックで、色が同じもの の個数」になります。

高橋君はこの作業を $ H\ \times\ W $ 回行うことで全てのブロックを消滅させオブジェを解体します。操作する列の順番をうまく選ぶことによって、解体にかかるコストの総和を最小化してください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ H $ $ W $ $ c_{1,1}c_{1,2} $..$ c_{1,W} $ $ c_{2,1}c_{2,2} $..$ c_{2,W} $ $ : $ $ c_{H,1}c_{H,2} $..$ c_{H,W} $

## 输出格式

解体にかかるコストの総和の最小値を出力せよ。

## 说明/提示

### 制約

- $ 1≦H≦300 $
- $ 2≦W≦300 $
- $ c_{i,j} $ は英小文字(`a`-`z`)

### 部分点

- $ W=3 $ を満たすデータセットに正解すると、$ 300 $ 点が与えられる。

### Sample Explanation 1

例えば下図のような順で操作するとコストの総和は $ 2 $ に出来て、これが最小値です。 !\[c116dab4c0a2f42759c6476d95330a37.png\](https://atcoder.jp/img/code-festival-2016-qualc/c116dab4c0a2f42759c6476d95330a37.png)

### Sample Explanation 2

はじめに真ん中の列を全て沈め、次に左の列を全て沈め、最後に右の列を全て沈めることでコスト$ 0 $を達成できます。

### Sample Explanation 3

右の列を一段沈める→左の列を一段沈める→右の段を全て沈める→左の段を全て沈める とすることでコスト$ 0 $にすることが可能です。

## 样例 #1

### 输入

```
2 3

rrr

brg
```

### 输出

```
2
```

## 样例 #2

### 输入

```
6 3

xya

xya

ayz

ayz

xaz

xaz
```

### 输出

```
0
```

## 样例 #3

### 输入

```
4 2

ay

xa

xy

ay
```

### 输出

```
0
```

## 样例 #4

### 输入

```
5 5

aaaaa

abbba

ababa

abbba

aaaaa
```

### 输出

```
24
```

## 样例 #5

### 输入

```
7 10

xxxxxxxxxx

ccccxxffff

cxxcxxfxxx

cxxxxxffff

cxxcxxfxxx

ccccxxfxxx

xxxxxxxxxx
```

### 输出

```
130
```



---

---
title: "3 Steps"
layout: "post"
diff: 提高+/省选-
pid: AT_code_festival_2017_qualb_c
tag: []
---

# 3 Steps

## 题目描述

[problemUrl]: https://atcoder.jp/contests/code-festival-2017-qualb/tasks/code_festival_2017_qualb_c

りんごさんは $ N $ 頂点 の連結な無向グラフを持っています。 このグラフにはすでに $ M $ 本の辺があり、$ i $ 本目の辺は頂点 $ A_i $ と頂点 $ B_i $ を繋いでいます。

りんごさんは以下の操作を行うことで、辺を追加しようと思っています。

- 操作：頂点 $ u $ から辺をちょうど $ 3 $ 本辿ることによって頂点 $ v $ に辿り着けるような $ u,v\ (u\ \neq\ v) $ をとり、頂点 $ u $ と頂点 $ v $ の間に辺を追加する。ただし、すでに頂点 $ u $ と頂点 $ v $ の間に辺が存在する場合は辺を追加することはできない。

りんごさんが追加できる辺の本数の最大値を求めて下さい。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ M $ $ A_1 $ $ B_1 $ $ A_2 $ $ B_2 $ $ : $ $ A_M $ $ B_M $

## 输出格式

追加できる辺の本数の最大値を出力せよ。

## 说明/提示

### 制約

- $ 2\ \leq\ N\ \leq\ 10^5 $
- $ 1\ \leq\ M\ \leq\ 10^5 $
- $ 1\ \leq\ A_i,B_i\ \leq\ N $
- 多重辺や自己ループは存在しない
- 与えられるグラフは連結である

### Sample Explanation 1

下の図のように辺を追加していくと $ 4 $ 本の辺を追加することができ、これ以上辺を追加することはできません。 !\[\](https://img.atcoder.jp/code-festival-2017-qualb/6e99dccc06ac8b14d9ca2e297524bc0c.png)

### Sample Explanation 2

例えば、以下のような順番で辺を追加することによって $ 5 $ 本の辺を追加することができます。 - 頂点 $ 5 $ と頂点 $ 3 $ の間に辺を追加する。 - 頂点 $ 5 $ と頂点 $ 2 $ の間に辺を追加する。 - 頂点 $ 4 $ と頂点 $ 1 $ の間に辺を追加する。 - 頂点 $ 4 $ と頂点 $ 2 $ の間に辺を追加する。 - 頂点 $ 4 $ と頂点 $ 3 $ の間に辺を追加する。

## 样例 #1

### 输入

```
6 5

1 2

2 3

3 4

4 5

5 6
```

### 输出

```
4
```

## 样例 #2

### 输入

```
5 5

1 2

2 3

3 1

5 4

5 1
```

### 输出

```
5
```



---

---
title: "Yet Another Palindrome Partitioning"
layout: "post"
diff: 提高+/省选-
pid: AT_code_festival_2017_qualc_d
tag: []
---

# Yet Another Palindrome Partitioning

## 题目描述

给定一个字符串$\texttt{s}$，把$\texttt{s}$分成$N$个子串，要求每个子串中的字母经过一定的移动，会变成一个回文串（如`aab`经过一定的移动，变成了`aba`，`aba`是一个回文串），**且$N$最少**。

## 输入格式

一个字符串$\texttt{s}$（$1 \le \texttt{|s|} \le 2 \times 10^5$）

## 输出格式

一个正整数$N$，表示最少的子串个数。

## 样例 #1

### 输入

```
aabxyyzz
```

### 输出

```
2
```

## 样例 #2

### 输入

```
byebye
```

### 输出

```
1
```

## 样例 #3

### 输入

```
abcdefghijklmnopqrstuvwxyz
```

### 输出

```
26
```

## 样例 #4

### 输入

```
abcabcxabcx
```

### 输出

```
3
```



---

---
title: "誤情報"
layout: "post"
diff: 提高+/省选-
pid: AT_code_festival_final_f
tag: []
---

# 誤情報

## 题目描述

高桥君是一位非常厉害的工程师。他最近发明了一款机器人“欧几里得君”，能够计算出两正整数的最大公约数。

为了测试这台机器人的能力，高桥君准备了一列包含 $N$ 个正整数的数组 $A$（从1开始编号）。

高桥君让欧几里得君计算 $A_i$ 和 $A_{i+1}$ 的最大公约数，其中 $1 \leq i \leq N$，并且规定 $A_{N+1} = A_1$。

机器人报告说 $A_i$ 和 $A_{i+1}$ 的最大公约数为 $B_i$。

高桥君发现，报告中似乎存在矛盾，因此他计划根据数组 $A$ 来核对。然而，他意外丢失了数组 $A$ 的数据。

这使他无法准确判断欧几里得君的性能。

尽管如此，作为超级工程师，高桥君不认为欧几里得君会有太多错误的结果。因此，他希望计算出 $B$ 中可能存在的最少错误信息数量，并将其视为测量结果。

请你找出 $B$ 中错误信息数量的最小值。

## 输入格式

输入的第一行为一个整数 $N$，表示 $A$ 的元素数量，其中 $1 \leq N \leq 10^5$。

接下来的 $N$ 行中，第 $i$ 行表示整数 $B_i$，其中 $1 \leq B_i \leq 10^9$。

## 输出格式

输出错误信息的最小数量。在结果末尾换行。

## 说明/提示

### 示例解释 1

如果假设 $B_1$ 和 $B_3$ 是正确的，那么 $A_2$ 和 $A_3$ 必须都是 $4$ 的倍数，因此 $B_2 \geq 4$，这与给定的 $B_2$ 不符。所以，假设 $B_2$ 是误报的话，矛盾就消除了，答案就是 $1$。

### 示例解释 2

移除 $B_8$ 后，矛盾消失。例如，可能的 $A$ 序列为 $[21, 39, 44, 28, 65, 45, 18, 34, 25, 15]$。

 **本翻译由 AI 自动生成**

## 样例 #1

### 输入

```
3

4

2

4
```

### 输出

```
1
```

## 样例 #2

### 输入

```
10

3

1

4

1

5

9

2

6

5

3
```

### 输出

```
1
```

## 样例 #3

### 输入

```
10

2

7

1

8

2

8

1

8

2

8
```

### 输出

```
2
```



---

---
title: "枕決め"
layout: "post"
diff: 提高+/省选-
pid: AT_code_festival_morning_easy_d
tag: []
---

# 枕決め

## 题目描述

[problemUrl]: https://atcoder.jp/contests/code-festival-2014-morning-easy/tasks/code_festival_morning_easy_d

`CODE FESTIVAL 2014` の参加者のうち、$ n $ 人の人がホテルに宿泊しようとしています。

ホテルには $ m $ 個の部屋があり、部屋 $ i $ には高さが $ a_i $ の枕が置いてあります。 ホテルの部屋はあまり広くないため、$ 1 $ つの部屋には高々 $ 1 $ 人しか宿泊することができません。 参加者はそれぞれ枕の高さに対して好みがあり、$ i $ 番目の参加者は $ x_i $ 以上 $ y_i $ 以下の高さの枕を好んでいます。

できるだけ多くの参加者が好みの枕を使うことができるようにホテルの部屋を割り当てたときに、好みの枕を使うことができる人数を求めてください。

## 输入格式

入力は以下の形式で与えられる。

> $ n $ $ m $ $ x_1 $ $ y_1 $ $ ... $ $ x_n $ $ y_n $ $ a_1 $ $ ... $ $ a_m $

- $ 1 $ 行目には、宿泊する人数を表す整数 $ n $ ($ 1\ \leq\ n\ \leq\ 100{,}000 $) と、ホテルの部屋の数を表す整数 $ m $ ($ 1\ \leq\ m\ \leq\ 100{,}000 $) が与えられる。
- 続く $ n $ 行には、各参加者の枕の高さに対する好みの範囲が与えられる。
- $ x_i,\ y_i $ ($ 1\ \leq\ x_i\ \leq\ y_i\ \leq\ 100{,}000 $) は、$ i $ 番目の宿泊者が $ x_i $ 以上 $ y_i $ 以下の高さの枕を好むことを意味する。
- 続く $ m $ 行には、ホテルの各部屋にある枕の高さが与えられる。
- $ a_i $ ($ 1\ \leq\ a_i\ \leq\ 100{,}000 $) は、$ i $ 番目の部屋にある枕の高さが $ a_i $ であることを意味する。

## 输出格式

できるだけ多くの参加者が好みの枕を使えるようにホテルの部屋を割り当てたときに、好みの枕を使うことができる人数を $ 1 $ 行で出力せよ。

最後は改行し、余計な文字、空行を含まないこと。

## 样例 #1

### 输入

```
3 3

1 2

2 3

3 4

1

2

3
```

### 输出

```
3
```

## 样例 #2

### 输入

```
3 3

1 2

2 3

3 4

2

4

5
```

### 输出

```
2
```

## 样例 #3

### 输入

```
3 4

1 4

2 3

5 5

2

4

5

6
```

### 输出

```
3
```



---

---
title: "eject"
layout: "post"
diff: 提高+/省选-
pid: AT_code_festival_morning_med_c
tag: []
---

# eject

## 题目描述

[problemUrl]: https://atcoder.jp/contests/code-festival-2014-morning-middle/tasks/code_festival_morning_med_c

一人暮らしをしている amylase さんは、夏に帰宅したとき部屋が暑くてつらい思いをしていました。 amylase さんは、帰宅した時にすでに部屋を涼しい状態にするために、家の外からエアコンを ON にしたいと考えました。

そこで、PC の CD トレイの前にエアコンのスイッチを置くことで CD トレイを開閉するたびにスイッチを押す装置を制作しました。 これにより、CD トレイを遠隔操作によって開閉することで、離れた場所からエアコンの ON と OFF を切り替えられるようになりました。

このエアコンのスイッチは初期状態が OFF であり、$ 1 $ 回スイッチを押すたびにエアコンの OFF と ON が切り替わります。

しかし amylase さんは小学校の図画工作で成績 $ 1 $ をもらうほど不器用だったので、CD トレイを $ 1 $ 回開閉しても確率 $ p $ でしかスイッチが押せないことがわかりました。

ヤケになった amylase さんは CD トレイを $ n $ 回開閉しました。

このとき、最終的にエアコンが ON になっている確率を求めてください。

## 输入格式

入力は以下の形式で与えられる。

> $ p $ $ n $

- $ 1 $ 行目には、スイッチを押せる確率を表す小数 $ p $ ($ 0\ \leq\ p\ \leq\ 1 $) と、CD トレイを開閉した回数を表す整数 $ n $ ($ 1\ \leq\ n\ \leq\ 10^{18} $) が与えられる。
- $ p $ は最大で小数第 $ 10 $ 位まで与えられる。

## 输出格式

最終的にエアコンが ON になっている確率を $ 1 $ 行で出力せよ。

絶対・相対誤差のうち少なくとも片方が $ 10^{-6} $ 以下ならば正解とみなされる。

最後は改行し、余計な文字、空行を含まないこと。

## 说明/提示

### Sample Explanation 2

極端な入力に対して誤差が出ないように注意しましょう。

## 样例 #1

### 输入

```
0.3 1
```

### 输出

```
0.3
```

## 样例 #2

### 输入

```
0.0000000001 10000000000
```

### 输出

```
0.432332358362
```



---

---
title: "ぽよぽよ"
layout: "post"
diff: 提高+/省选-
pid: AT_code_festival_morning_med_d
tag: []
---

# ぽよぽよ

## 题目描述

在一条直线上，有 $ n $ 只名为ポヨクン的生物。第 $ i $ 只ポヨクン用长度为 $ l_i $ 的链子拴在位置 $ p_i $ 的柱子上。这意味着，第 $ i $ 只ポヨクン可以在从 $ p_i - l_i $ 到 $ p_i + l_i $ 之间的任何一个格子内自由移动。

当这些ポヨクン根据索引顺序从左到右各自占据不同的格子时，我们需要计算有多少种可能的配置。具体来说，我们需要统计满足以下条件的位置组合的数量：
1. $ x_i $ 是整数。
2. $ x_i $ 满足 $ p_i - l_i \leq x_i \leq p_i + l_i $。
3. 对于任意的 $ j $ 满足 $ 1 \leq j \leq n $，如果 $ i < j $，则 $ x_i < x_j $。

如果任何一种组合中至少有一只ポヨクン的位置不同，那么这两种组合就是不同的。

由于答案可能非常大，需要将答案对 $ 1,000,000,007 $ 取模，并输出该结果。

## 输入格式

输入的第一行包含一个整数 $ n $ ($ 1 \leq n \leq 1,000 $)，表示ポヨクン的总数。

接下来的 $ n $ 行中，每行包含两个整数 $ p_i $ 和 $ l_i $，分别表示每只ポヨクン连接的柱子的位置和链子的长度。满足 $ 0 \leq p_i \leq 1,000,000,000 $ 和 $ 0 \leq l_i \leq 1,000 $。并且当 $ i < j $ 时，保证 $ p_i < p_j $。

## 输出格式

输出满足条件的ポヨクン所有可能配位置的总数，并对 $ 1,000,000,007 $ 取模。

答案仅需一行，并且最后以换行符结束。

## 说明/提示

### 示例解释 1

对于給定的范围，ポヨクン有 $ -3 $, $ -2 $, $ -1 $, $ 0 $, $ 1 $, $ 2 $, $ 3 $ 共计 $ 7 $ 种可能的配置。

### 示例解释 2

对于给定的情况，可能的配置包括：$ (-3, -1) $, $ (-3, 0) $, $ (-3, 1) $, $ (-3, 2) $, $ (-3, 3) $, $ (-2, -1) $, $ (-2, 0) $, $ (-2, 1) $, $ (-2, 2) $, $ (-2, 3) $, $ (-1, 0) $, $ (-1, 1) $, $ (-1, 2) $, $ (-1, 3) $, $ (0, 1) $, $ (0, 2) $, $ (0, 3) $, $ (1, 2) $, $ (1, 3) $, $ (2, 3) $，总共有 $ 20 $ 种配置。

 **本翻译由 AI 自动生成**

## 样例 #1

### 输入

```
1

0 3
```

### 输出

```
7
```

## 样例 #2

### 输入

```
2

0 3

1 2
```

### 输出

```
20
```



---

---
title: "映画の連続視聴"
layout: "post"
diff: 提高+/省选-
pid: AT_code_formula_2014_final_d
tag: []
---

# 映画の連続視聴

## 题目描述

高桥老弟喜欢一遍又一遍的看同一部电影。每看一遍就会获得一定的幸福感



但是高桥老弟十分健忘，所以他一旦看到另一部电影，就会忘记之前看过的电影，所以当他再看一次之前看过的那个电影时，他又会得到第一次观看时的幸福感



当高桥老弟连续观看同一部电影第i次时获得的幸福感为Hi，因此连续k次观看同一部电影获得的幸福感就是H1+H2+…+Hk



现给出高桥老弟连续观看同一部电影第i次获得的幸福感Hi和当日的电影时间表，请求出高桥老弟最多能获得多少幸福感



#### 注意

- 你不能从电影的中间开始观看或看到一半离场

- 如果一个电影的开始时间恰为另一部电影的结束时间，你仍可以同时观看这两部电影

## 输入格式

第一行为一个整数N表示当日的电影场次数(1<=N<=3000).



第二行为N个整数，第i个整数表示高桥老弟连续第i次观看同一部电影时获得的幸福感Hi(1<=Hi<=10000).



保证当i<j时，Hi<Hj.



从第三行到第N+2行，第i+2行(1<=i<=N)有三个整数分别表示电影的编号(同一标号为同一部电影)、电影开始的时间、电影结束的时间(保证电影开始的时间早于电影结束的时间，且都小于100000).

## 输出格式

一行，高桥老弟最多能获得的幸福感.

## 说明/提示

#### 样例1

高桥老弟连续观看两场标号为1的电影获得总幸福感为100+200=300.

## 样例 #1

### 输入

```
4

100 200 300 400

1 0 120

1 15 135

2 10 40

1 240 330
```

### 输出

```
300
```

## 样例 #2

### 输入

```
10

100 200 250 250 300 400 540 600 650 680

1 10 130

2 0 900

1 20 110

1 200 230

3 200 210

2 201 220

2 240 300

3 0 90

1 250 320

2 330 400
```

### 输出

```
650
```



---

---
title: "ab文字列"
layout: "post"
diff: 提高+/省选-
pid: AT_code_formula_2014_final_e
tag: []
---

# ab文字列

## 题目描述

对于字符串F(p,q)

请参考以下的渐进式：

- F(1,0)="b"

- F(2,0)="a"

- 当n>=3且k>=0且k为偶数时，

F(n,k)=F(n-1,floor(k/2))+F(n-2,floor(k/4))

- 当n>=3且k>=0且k为奇数时，

F(n,k)=F(n-2,floor(k/4))+F(n-1,floor(k/2))

- 对于以上的渐进式无法给出定义的F(n,k)，在这里不予考虑





------------

- 字符串S被赋了一个值值，我们知道这个字符串可以用F(p,q)来表达，即S=F(p,q)

- 请分别输出p与q

-  _注解1：floor函数（高斯函数）即向下取整（不大于要求值的最大的那个整数值），如floor(2)=2;floor(2.1)=2;floor(-4.7)=-5_

-  _注解2：字符串的加法即为把第二个字符串简单拼接在第一个字符串后面_

## 输入格式

一行一个字符串S（1<=|S|<=20000）（|S|即为S的长度）

## 输出格式

一行两个数，分别为p和q，中间加空格

# 样例输入/输出

-	输入#1

-	babaa

-	输出#1

-	5 5 

-	输入#2

-	aababaabaababaabaababaababaabaabab

-	输出#2

-	9 44

## 说明/提示

样例一：

-	F(1,0)=”b”

-	F(2,0)=”a”

-	F(3,1)=F(1,0)+F(2,0)=”ba”

-	F(4,2)=F(3,1)+F(2,0)=”baa”

-	F(5,5)=F(3,1)+F(4,2)=”babaa”

-	所以p=5,q=5，输出5 5

## 样例 #1

### 输入

```
babaa
```

### 输出

```
5 5
```

## 样例 #2

### 输入

```
aababaabaababaabaababaababaabaabab
```

### 输出

```
9 44
```



---

---
title: "無刻印キーボード"
layout: "post"
diff: 提高+/省选-
pid: AT_code_formula_2014_qualA_d
tag: []
---

# 無刻印キーボード

## 题目描述

高桥君非常喜欢无标记键盘。今天，他计划在一个只标有字母和数字的键盘上输入一段文字。

不过高桥君并没有完全记住键盘的布局。对于他记得的字符，可以直接敲击对应的键；对于不记得的字符，则必须随机敲击按键，如果按错了，就要用退格键来删除。

他希望输入一串文本 $S$，且希望敲击键盘的次数尽可能少。他可以根据之前按下的键对应的字符来记忆信息，并在下次选择按键时进行优化。

请计算高桥君在使用最优策略下，每次键击的期望次数。

假设高桥君记住了退格键的位置，以及所有非字母和数字的键的位置。另外，不允许使用方向键或鼠标等改变输入位置的操作。

## 输入格式

输入的格式如下：

> $ S $  
> $ K $

- 第一行给出高桥君想要输入的字符串 $S\ (1 \le |S| \le 50)$，字符串仅包含小写字母和数字。
- 第二行给出高桥君记住的按键种类字符串 $K$。字符串 $K$ 是由 `1234567890abcdefghijklmnopqrstuvwxyz` 中任意删除若干字符后得到的，且首字符保证为 `1`。

## 输出格式

输出一行代表高桥君所需敲击按键次数的期望值，结果需在行尾加上换行符。

答案允许的绝对误差或相对误差不超过 $10^{-6}$。

## 示例说明

### 示例 1 解释

高桥君记住了键盘上的所有按键，因此敲击键盘的次数等于字符串 `takahashikun` 的长度，即 $12$ 次。

### 示例 2 解释

高桥君不记得 `p` 和 `q` 两个按键的位置。在输入 `p` 时，需要在两个不确定的按键中随便选择一个：
- 如果按错了键，返回的是 `q`，他需要用退格键删除一个字符，然后再输入 `p`，总共敲击 $3$ 次。
- 如果选择正确，直接敲`p`，则完成文章，总共敲击 $1$ 次。

两种情况等可能发生，因此按键次数的期望值为 $2$。

 **本翻译由 AI 自动生成**

## 样例 #1

### 输入

```
takahashikun

1234567890abcdefghijklmnopqrstuvwxyz
```

### 输出

```
12
```

## 样例 #2

### 输入

```
p

1234567890abcdefghijklmnorstuvwxyz
```

### 输出

```
2
```



---

---
title: "お釣りの嫌いな高橋君"
layout: "post"
diff: 提高+/省选-
pid: AT_code_formula_2014_qualB_d
tag: []
---

# お釣りの嫌いな高橋君

## 题目描述

[problemUrl]: https://atcoder.jp/contests/code-formula-2014-qualb/tasks/code_formula_2014_qualB_d

高橋君の国では、$ N $ 種類の硬貨が使われています。 $ 1 $ 番目の硬貨の価値は $ 1 $ 円です。 $ k $ 番目の硬貨の価値は、$ k-1 $ 番目の硬貨の $ 10 $ 倍あります。 つまり、$ 2 $ 番目の硬貨は $ 10 $ 円の価値があり、$ 5 $ 番目の硬貨は $ 10000 $ 円の価値があります。

高橋君は、お釣りが嫌いです。なので、出来るだけぴったりの金額で買い物がしたいと思っています。 そこで高橋君は、今持っている硬貨で、何種類の金額が払えるかを調べたいと思いました。

高橋君が払える金額が何通りあるかを出力しなさい。 ただし、これは膨大な数となるため、 $ 1000000007 $ 以上となる場合は、 $ 1000000007 $ で割った余りを出力しなさい。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ A_1 $ $ A_2 $ : $ A_N $

- $ 1 $ 行目には、硬貨の種類数 $ N\ (1\ ≦\ N\ ≦\ 50) $ が、$ 1 $ 行で与えられる。
- $ 2 $ 行目から $ N $ 行では、高橋君が各硬貨を何枚持っているかが与えられる。 このうち $ i(1≦i≦N) $ 行目では、 $ i $ 番目の硬貨を、高橋君が何枚持っているかを表す整数 $ A_i(0≦A_i≦50000) $が与えられる。

## 输出格式

高橋君が払える金額の種類数を、 $ 1000000007 $ で割った余りを $ 1 $ 行で出力せよ。出力の末尾は改行をいれること。

## 说明/提示

### Sample Explanation 1

払える金額は、$ 1 $ 円, $ 2 $ 円, $ 10 $ 円, $ 11 $ 円, $ 12 $ 円の $ 5 $ 通りとなります。 $ 0 $ 円は含まないことに注意してください。

### Sample Explanation 2

$ 1 $ 円から $ 62 $ 円の $ 62 $ 通りの金額を支払うことが出来ます。

### Sample Explanation 4

$ 1000000007 $ で割った余りを出力してください。

## 样例 #1

### 输入

```
2

2

1
```

### 输出

```
5
```

## 样例 #2

### 输入

```
2

32

3
```

### 输出

```
62
```

## 样例 #3

### 输入

```
4

12

3

7

34
```

### 输出

```
12039
```

## 样例 #4

### 输入

```
10

1234

2

857

3858

1

5000

32

4

1

857
```

### 输出

```
969347336
```



---

---
title: "道路網"
layout: "post"
diff: 提高+/省选-
pid: AT_ddcc_2016_qual_d
tag: []
---

# 道路網

## 题目描述

[problemUrl]: https://atcoder.jp/contests/ddcc2016-qual/tasks/ddcc_2016_qual_d

$ N $ 個の都市と $ N-1 $ 個の道からなる国があります。各都市には $ 1,\ \,\ 2,\ \,\ …\ \,\ ,\ \,\ N $ と番号がついています。 $ i(1\ ≦\ i\ ≦\ N-1) $ 番目の道は都市 $ A_i $ と都市 $ B_i $ を長さ $ C_i $ でつないでいます。 道は双方向に移動可能で、どの都市同士も何本かの道を通って互いに行き来することが可能です。

ある日、$ 1≦i\ <\ j≦N $ を満たす $ 2 $ つの都市 $ i,\ \,\ j $ について都市 $ i $ と 都市 $ j $ を直接つなぐ道が存在しない場合、都市 $ i $ と 都市 $ j $ を直接つなぐ長さ $ X $ の道を追加する、という操作が行われました。

$ d(u,\ \,\ v) $ を都市 $ u $ から都市 $ v $ までの最短距離として、 $ 1≦i\ <\ j≦N $ を満たす $ 2 $ つの都市 $ i,\ \,\ j $ について $ d(i,\ \,\ j) $ をそれぞれ求め、その総和を出力してください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ X $ $ A_1 $ $ B_1 $ $ C_{1} $ $ . $ $ . $ $ . $ $ A_{N-1} $ $ B_{N-1} $ $ C_{N-1} $

## 输出格式

答えを $ 1 $ 行に出力せよ。

## 说明/提示

### 制約

- $ 2\ ≦\ N\ ≦\ 10^{5} $
- $ 1\ ≦\ A_i,\ \,\ B_i\ ≦\ N(1\ ≦\ i\ ≦\ N-1) $
- $ 1\ ≦\ C_i\ ≦\ 10^{5}(1\ ≦\ i\ ≦\ N-1) $
- $ 1\ ≦\ X\ ≦\ 10^5 $
- 操作が行われる以前の時点において、どの $ 2 $ つの都市同士も何本かの道をたどって移動可能
- $ C_i,\ \,\ X $ はいずれも整数

### Sample Explanation 1

以下の図は都市と道の関係を表します。青い実線は元々あった $ N-1 $ 本の道を、黒い破線は操作により新たに追加された長さ $ 3 $ の道を表しています。 

![9461ca7dead16c099ef63ac3b181699f.png](https://atcoder.jp/img/ddcc2016-qual/9461ca7dead16c099ef63ac3b181699f.png)

## 样例 #1

### 输入

```
6 3

1 2 2

2 3 3

4 1 4

6 4 10

5 4 8
```

### 输出

```
51
```

## 样例 #2

### 输入

```
20 68

12 10 34

12 14 35

12 9 15

17 9 37

1 17 47

1 2 12

11 2 7

11 15 32

13 11 15

13 4 2

5 1 35

20 5 51

3 4 39

16 11 21

3 18 70

17 8 68

20 7 2

6 3 34

19 2 5
```

### 输出

```
11278
```



---

---
title: "Chokutter"
layout: "post"
diff: 提高+/省选-
pid: AT_digitalarts_3
tag: []
---

# Chokutter

## 题目描述

高桥君是一位对网络安全颇有兴趣，并希望加入数字艺术公司的年轻人。他正在审查自己开发的“吐槽型”社交网络「Chokutter」的日志，这个平台在部分竞赛程序员中非常受欢迎。以下是「Chokutter」的操作规则。

1. 用户可以发布“微博”，并且发布的内容会显示在自己的时间线上。

2. 用户可以关注其他用户：
   - 关注后，所关注的用户A发布的新微博会显示在你的时间线上，但在关注之前的微博不会显示。
   - 当你关注用户A时，用户A也会自动关注你。
   - 因此，你和用户A会互相看到对方发布的新微博。
   - 注意：不能关注已经关注的人或自己。

3. 用户可以取消对其他用户的关注：
   - 取消关注后，用户A的新微博将不再显示在你的时间线上，但之前已经显示的微博不受影响。
   - 当你取消对用户A的关注时，用户A也会自动取消对你的关注。
   - 要注意的是，取消关注后，用户A将不会再看到你新的微博。
   - 注意：不能取消对未关注的人的关注，也不能取消对自己的关注。

请注意，这些规则与其他类似的服务有所不同。

高桥君计划根据Chokutter日志，制作一个用户时间线上微博数量的排行榜。给定一个整数 $ K $，请输出在排行榜中第 $ K $ 位的用户其时间线上显示的微博数量。初始状态下，所有用户均未关注其他用户。输入格式如下：

### 输入格式
- 第一行输入三个整数 $ N $、$ M $ 和 $ K $，分别表示用户数、日志行数以及目标排名位置。其中 $ 2 \leq N \leq 100,000 $，$ 0 \leq M \leq 100,000 $，$ 1 \leq K \leq N $。
- 接下来 $ M $ 行：每行包含一条日志记录 $ s_i $。
- 每条日志 $ s_i $ 有三种格式，其中整数 $ j $ 和 $ k $ 表示用户编号，$ 1 \leq j, k \leq N $ 且 $ j \neq k $。

   - 如果 $ s_i $ 的首字符是 `t`，表示用户 $ j $ 发布了一条微博。
   - 如果 $ s_i $ 的首字符是 `f`，表示用户 $ j $ 关注了用户 $ k $。
   - 如果 $ s_i $ 的首字符是 `u`，表示用户 $ j $ 取消关注了用户 $ k $。

### 输出格式
- 输出排名第 $ K $ 位的用户的时间线上显示的微博数量。最后输出一个换行符。

### 数据范围与提示
- $ 2 \leq N \leq 100,000 $
- $ 0 \leq M \leq 100,000 $
- $ 1 \leq K \leq N $

### 示例
#### 输入
```
5 9 1
t 1
f 1 3
f 2 1
t 2
t 1
u 3 1
t 1
t 5
t 5
```

#### 输出
```
4
```

#### 解释
- 初始状态下：所有用户都未关注他人。
- 用户1发布一条微博，只有用户1能看到。
- 用户1关注了用户3，系统也自动让用户3关注用户1。
- 用户2关注了用户1，系统也自动让用户1关注用户2。
- 用户2发布了一条微博，用户1和用户2都能看到。
- 用户1再次发布一条微博，用户1、用户2和用户3都能看到。
- 用户3取消了对用户1的关注，用户1也自动取消了对用户3的关注。
- 用户1发布一条微博，用户1和用户2能看到。
- 用户5发布两条微博，只有用户5能看到。
- 最终，每个用户时间线上显示的微博数量为：用户1有4条，用户2有3条，用户3有1条，用户4有0条，用户5有2条。
- 因此，第1名的用户是用户1，时间线上显示的微博数量为4。

#### 输入示例以及对应输出请参考上面的描述。

 **本翻译由 AI 自动生成**



---

---
title: "特別講演「括弧列と塗り分け」"
layout: "post"
diff: 提高+/省选-
pid: AT_discovery_2016_final_c
tag: []
---

# 特別講演「括弧列と塗り分け」

## 题目描述

你是一位讲授特别课程「括号序列与涂色」的讲师。今天，你计划向学生们介绍一种为含有 `(` 和 `)` 的字符串 $S$ 涂色的方法。字符串 $S$ 已经保证了括号的配对关系是正确无误的。

我们要为 $S$ 中的每个字符涂上红色或蓝色。如果第 $i$ 个 `(` 和第 $j$ 个 `)` 是配对的，则要求子串 $S[i, j]$ 中，红色字符计数为 $R$，蓝色字符计数为 $B$，需要满足 $|R - B| \leq K$。

请计算出满足条件的所有涂色方案的总数，然后将结果对 $1,000,000,007$ 取模，并输出。

对于本问题，括号配对正确的字符串定义如下：

1. 空字符串视作配对正确。
2. 如果 $A$ 和 $B$ 都是配对正确的字符串，那么 $AB$ 也是配对正确的。
3. 若 $A$ 是配对正确的字符串，则形式为 `(`$A$`)` 的字符串也是配对正确的，并且括号 `(` 与 `)` 视为一对。
4. 不满足上述条件的字符串即为配对错误的。

## 输入格式

输入如下：

- 第一行是括号字符串 $S$，其长度满足 $2 \leq |S| \leq 3,000$，且 $S$ 配对正确。
- 第二行是整数 $K\ (0 \leq K \leq 3,000)$，表示涂色时的约束。

## 输出格式

输出满足条件的涂色方案的个数，并对 $1,000,000,007$ 取模。

## 说明/提示

### 部分分数

本题设有部分得分。

- 若能正确解决满足 $2 \leq |S| \leq 8$ 条件的数据集，可得 $10$ 分。
- 解决 $2 \leq |S| \leq 100$ 数据集，可得 $10$ 分的额外奖励。
- 满足完整数据集的要求，可以额外获得 $50$ 分，总计 $70$ 分。

### 示例解释

1. 在示例 1 中，第 $1$ 和第 $2$ 个字符，$3$ 和第 $4$ 个字符分别配对。可能的涂色情况有：`<><>`, `<>[]`, `[><]`, `[[]]` 共 $4$ 种。
2. 在示例 2 中，共有 $16$ 种涂色方案。
3. 在示例 3 中，多个配对存在。
4. 示例 4 的涂色方案总数为 $4,294,967,296$，输出其对 $1,000,000,007$ 取模结果 $294,967,268$。

 **本翻译由 AI 自动生成**

## 样例 #1

### 输入

```
()()

0
```

### 输出

```
4
```

## 样例 #2

### 输入

```
()()

2
```

### 输出

```
16
```

## 样例 #3

### 输入

```
(()())

2
```

### 输出

```
50
```

## 样例 #4

### 输入

```
()()()()()()()()()()()()()()()()

2
```

### 输出

```
294967268
```



---

---
title: "ドーナツの箱詰め"
layout: "post"
diff: 提高+/省选-
pid: AT_donuts_2015_4
tag: []
---

# ドーナツの箱詰め

## 题目描述

须藤なつき小姐是一位负责甜甜圈装箱的店员。她现在有 $ K $ 个甜甜圈和 $ N $ 个箱子要进行装箱。每个箱子 $ i\ (1 \le i \le N) $ 的体积是 $ C_i $，且每个箱子只能装一个甜甜圈。

由于箱子的数量多于甜甜圈的数量，为了使用所有箱子，なつき决定通过把一些箱子放入其他更大的箱子中来使用所有箱子。每个箱子中必须放一个甜甜圈或一个比它体积小的箱子。如果将箱子 $ j $ 放到箱子 $ i $ 里，则需要在两个箱子之间放入体积为 $ C_{i} - C_{j} $ 的缓冲材料。请计算在所有箱子都得到合理利用的情况下，所需的缓冲材料总量的最小值。

此外，由于なつき在操作中可能会不小心压坏一些箱子。每当有箱子被压坏时，请计算使用剩余箱子进行装箱时���要的缓冲材料总量的最小值。なつき总共会压坏 $ Q $ 个箱子，第 $ i $ 个被压坏的箱子是 $ D_i $。

## 输入格式

输入通过标准输入按如下格式提供：

> $ N $ $ K $ $ C_1 $ $ C_2 $ ... $ C_N $ $ Q $ $ D_1 $ $ D_2 $ ... $ D_Q $

- 第一行包含两个整数 $ N\ (1 \le N \le 200,000)$ 和 $ K\ (1 \le K \le N)$，表示起初有 $ N $ 个箱子和 $ K $ 个甜甜圈。
- 第二行包含 $ N $ 个整数，分别表示每个箱子的体积。其中第 $ i $ 个整数 $ C_i\ (1 \le C_i \le 200,000)$ 表示箱子 $ i $ 的体积。保证对于任意 $ p \neq q $，都有 $ C_p \neq C_q $。
- 第三行包含一个整数 $ Q\ (0 \le Q \le N-K)$，表示なつき压坏的箱子数量。
- 接下来的 $ Q $ 行中，每行给出一个整数 $ D_i\ (1 \le D_i \le N)$，表示なつき压坏的第 $ i $ 个箱子是 $ D_i $。保证对于任意 $ p \neq q $，都有 $ D_p \neq D_q $。

## 输出格式

输出共 $ Q+1 $ 行。第一行输出使用所有 $ N $ 个箱子进行装箱时所需的最小缓冲材料总量。接下来的 $ Q $ 行中，第 $ i $ 行输出在压坏了第 $ i $ 个箱子后，使用剩余箱子进行装箱时所需缓冲材料总量的最小值。输出每行末尾需要换行。

## 说明/提示

### 部分分

以下是题目的一些部分分提示：

- 当满足 $ Q = 0 $ 且 $ K = 2 $ 的数据集 1 正确时，可以获得 15 分。
- 当满足 $ Q = 0 $ 的数据集 2 正确时（与上述分数无关），可以获得 25 分。
- 当满足 $ K = 2 $ 的数据集 3 正确时（与上述分数无关），可以获得 30 分。

 **本翻译由 AI 自动生成**

## 样例 #1

### 输入

```
5 4

1 9 3 7 4

0
```

### 输出

```
1
```

## 样例 #2

### 输入

```
4 2

6 5 10 2

2

3

1
```

### 输出

```
4

1

0
```

## 样例 #3

### 输入

```
7 3

2 12 3 13 7 17 1

4

4

3

1

6
```

### 输出

```
7

6

6

5

0
```



---

---
title: "7th"
layout: "post"
diff: 提高+/省选-
pid: AT_donuts_live2014_2
tag: []
---

# 7th

## 题目描述

[problemUrl]: https://atcoder.jp/contests/donuts-live2014/tasks/donuts_live2014_2

パンチくんは、 $ 7 $ という数字が大好きです。先日も、ナナにまつわるゲームをリリースし、順調にユーザ数を伸ばしています。

さて、パンチくんは、 $ 7 $ の倍数に興味をもちました。以下の様なゲームを考えます。

パンチくんとニコルちゃんは、数字の $ 1〜7 $ のカードを、十分たくさん持っています。まずパンチくんは、カードをいくつか並べて、ある自然数を作ります。次にニコルちゃんは、カードをいくつか並べて、以下の条件を満たす自然数を作ります。

- ニコルちゃんが作った数字は、パンチくんが作った数字以下である。
- ニコルちゃんが作った数字は、 $ 10 $ 進数表記で、 $ 7 $ の倍数である。

ニコルちゃんは、何通りの数字を作ることができるでしょうか。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $

- $ 1 $ 行目には、パンチくんが作った自然数 $ N\ (1\ ≦\ N\ <\ 1000000000000000000\ (10^{18})) $ が与えられる。
- $ N $ の各桁の数値は、 $ {1,\ 2,\ 3,\ 4,\ 5,\ 6,\ 7} $ のいずれかであることが保証されている。

## 输出格式

ニコルちゃんが作ることのできる数字の個数を、 $ 1 $ 行で出力せよ。出力の末尾には改行をいれること。

## 说明/提示

### 部分点

$ 1\ ≦\ N\ <\ 100000\ (10^5) $ を満たすテストケースに正解した場合、部分点として $ 40 $ 点が与えられる。

### Sample Explanation 1

ニコルちゃんが作ることのできる数字は、 $ 7,\ 14,\ 21 $ の $ 3 $ つです。 $ 28 $ は作ることができないことに注意して下さい。

### Sample Explanation 3

十分たくさんのカードを持っているので、ニコルちゃんは同じ数字を並べた $ 77 $ という数字を作ることも可能です。

## 样例 #1

### 输入

```
31
```

### 输出

```
3
```

## 样例 #2

### 输入

```
7
```

### 输出

```
1
```

## 样例 #3

### 输入

```
111
```

### 输出

```
8
```

## 样例 #4

### 输入

```
777777777777777777
```

### 输出

```
271402266318408
```



---

---
title: "Matching"
layout: "post"
diff: 提高+/省选-
pid: AT_dp_o
tag: []
---

# Matching

## 题目描述

[problemUrl]: https://atcoder.jp/contests/dp/tasks/dp_o

$ N $ 人の男性たちと $ N $ 人の女性たちがいます。 男性たちには $ 1,\ 2,\ \ldots,\ N $ と番号が振られています。 同様に、女性たちには $ 1,\ 2,\ \ldots,\ N $ と番号が振られています。

各 $ i,\ j $ ($ 1\ \leq\ i,\ j\ \leq\ N $) について、男性 $ i $ と女性 $ j $ の相性の良し悪しが整数 $ a_{i,\ j} $ によって与えられます。 $ a_{i,\ j}\ =\ 1 $ ならば男性 $ i $ と女性 $ j $ は相性が良く、$ a_{i,\ j}\ =\ 0 $ ならば相性が悪いです。

太郎君は、相性が良い男女どうしのペアを $ N $ 組作ろうとしています。 このとき、各男性および各女性はちょうど $ 1 $ つのペアに属さなければなりません。

$ N $ 組のペアを作る方法は何通りでしょうか？ $ 10^9\ +\ 7 $ で割った余りを求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ a_{1,\ 1} $ $ \ldots $ $ a_{1,\ N} $ $ : $ $ a_{N,\ 1} $ $ \ldots $ $ a_{N,\ N} $

## 输出格式

$ N $ 組のペアを作る方法は何通りか？ $ 10^9\ +\ 7 $ で割った余りを出力せよ。

## 说明/提示

### 制約

- 入力はすべて整数である。
- $ 1\ \leq\ N\ \leq\ 21 $
- $ a_{i,\ j} $ は $ 0 $ または $ 1 $ である。

### Sample Explanation 1

ペアを作る方法は次の $ 3 $ 通りです。 男性 $ i $ と女性 $ j $ のペアを $ (i,\ j) $ で表します。 - $ (1,\ 2),\ (2,\ 1),\ (3,\ 3) $ - $ (1,\ 2),\ (2,\ 3),\ (3,\ 1) $ - $ (1,\ 3),\ (2,\ 1),\ (3,\ 2) $

### Sample Explanation 2

ペアを作る方法は次の $ 1 $ 通りです。 - $ (1,\ 2),\ (2,\ 4),\ (3,\ 1),\ (4,\ 3) $

### Sample Explanation 4

答えを $ 10^9\ +\ 7 $ で割った余りを出力することを忘れずに。

## 样例 #1

### 输入

```
3

0 1 1

1 0 1

1 1 1
```

### 输出

```
3
```

## 样例 #2

### 输入

```
4

0 1 0 0

0 0 0 1

1 0 0 0

0 0 1 0
```

### 输出

```
1
```

## 样例 #3

### 输入

```
1

0
```

### 输出

```
0
```

## 样例 #4

### 输入

```
21

0 0 0 0 0 0 0 1 1 0 1 1 1 1 0 0 0 1 0 0 1

1 1 1 0 0 1 0 0 0 1 0 0 0 0 1 1 1 0 1 1 0

0 0 1 1 1 1 0 1 1 0 0 1 0 0 1 1 0 0 0 1 1

0 1 1 0 1 1 0 1 0 1 0 0 1 0 0 0 0 0 1 1 0

1 1 0 0 1 0 1 0 0 1 1 1 1 0 0 0 0 0 0 0 0

0 1 1 0 1 1 1 0 1 1 1 0 0 0 1 1 1 1 0 0 1

0 1 0 0 0 1 0 1 0 0 0 1 1 1 0 0 1 1 0 1 0

0 0 0 0 1 1 0 0 1 1 0 0 0 0 0 1 1 1 1 1 1

0 0 1 0 0 1 0 0 1 0 1 1 0 0 1 0 1 0 1 1 1

0 0 0 0 1 1 0 0 1 1 1 0 0 0 0 1 1 0 0 0 1

0 1 1 0 1 1 0 0 1 1 0 0 0 1 1 1 1 0 1 1 0

0 0 1 0 0 1 1 1 1 0 1 1 0 1 1 1 0 0 0 0 1

0 1 1 0 0 1 1 1 1 0 0 0 1 0 1 1 0 1 0 1 1

1 1 1 1 1 0 0 0 0 1 0 0 1 1 0 1 1 1 0 0 1

0 0 0 1 1 0 1 1 1 1 0 0 0 0 0 0 1 1 1 1 1

1 0 1 1 0 1 0 1 0 0 1 0 0 1 1 0 1 0 1 1 0

0 0 1 1 0 0 1 1 0 0 1 1 0 0 1 1 1 1 0 0 1

0 0 0 1 0 0 1 1 0 1 0 1 0 1 1 0 0 1 1 0 1

0 0 0 0 1 1 1 0 1 0 1 1 1 0 1 1 0 0 1 1 0

1 1 0 1 1 0 0 1 1 0 1 1 0 1 1 1 1 1 0 1 0

1 0 0 1 1 0 1 1 1 1 1 0 1 0 1 1 0 0 0 0 0
```

### 输出

```
102515160
```



---

---
title: "Digit Sum"
layout: "post"
diff: 提高+/省选-
pid: AT_dp_s
tag: []
---

# Digit Sum

## 题目描述

[problemUrl]: https://atcoder.jp/contests/dp/tasks/dp_s

$ 1 $ 以上 $ K $ 以下の整数のうち、十進表記における各桁の数字の総和が $ D $ の倍数であるようなものは何個でしょうか？ $ 10^9\ +\ 7 $ で割った余りを求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ K $ $ D $

## 输出格式

条件を満たす整数は何個か？ $ 10^9\ +\ 7 $ で割った余りを出力せよ。

## 说明/提示

### 制約

- 入力はすべて整数である。
- $ 1\ \leq\ K\ <\ 10^{10000} $
- $ 1\ \leq\ D\ \leq\ 100 $

### Sample Explanation 1

$ 4,\ 8,\ 13,\ 17,\ 22,\ 26 $ の $ 6 $ 個です。

### Sample Explanation 2

答えを $ 10^9\ +\ 7 $ で割った余りを出力することを忘れずに。

## 样例 #1

### 输入

```
30

4
```

### 输出

```
6
```

## 样例 #2

### 输入

```
1000000009

1
```

### 输出

```
2
```

## 样例 #3

### 输入

```
98765432109876543210

58
```

### 输出

```
635270834
```



---

---
title: "Grouping"
layout: "post"
diff: 提高+/省选-
pid: AT_dp_u
tag: []
---

# Grouping

## 题目描述

[problemUrl]: https://atcoder.jp/contests/dp/tasks/dp_u

$ N $ 羽のうさぎたちがいます。 うさぎたちには $ 1,\ 2,\ \ldots,\ N $ と番号が振られています。

各 $ i,\ j $ ($ 1\ \leq\ i,\ j\ \leq\ N $) について、うさぎ $ i $ と $ j $ の相性が整数 $ a_{i,\ j} $ によって与えられます。 ただし、各 $ i $ ($ 1\ \leq\ i\ \leq\ N $) について $ a_{i,\ i}\ =\ 0 $ であり、各 $ i,\ j $ ($ 1\ \leq\ i,\ j\ \leq\ N $) について $ a_{i,\ j}\ =\ a_{j,\ i} $ です。

太郎君は、$ N $ 羽のうさぎたちをいくつかのグループへ分けようとしています。 このとき、各うさぎはちょうど $ 1 $ つのグループに属さなければなりません。 グループ分けの結果、各 $ i,\ j $ ($ 1\ \leq\ i\ <\ j\ \leq\ N $) について、うさぎ $ i $ と $ j $ が同じグループに属するならば、太郎君は $ a_{i,\ j} $ 点を得ます。

太郎君の総得点の最大値を求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ a_{1,\ 1} $ $ \ldots $ $ a_{1,\ N} $ $ : $ $ a_{N,\ 1} $ $ \ldots $ $ a_{N,\ N} $

## 输出格式

太郎君の総得点の最大値を出力せよ。

## 说明/提示

### 制約

- 入力はすべて整数である。
- $ 1\ \leq\ N\ \leq\ 16 $
- $ |a_{i,\ j}|\ \leq\ 10^9 $
- $ a_{i,\ i}\ =\ 0 $
- $ a_{i,\ j}\ =\ a_{j,\ i} $

### Sample Explanation 1

$ \{1,\ 3\},\ \{2\} $ とグループ分けすればよいです。

### Sample Explanation 2

$ \{1\},\ \{2\} $ とグループ分けすればよいです。

### Sample Explanation 3

$ \{1,\ 2,\ 3,\ 4\} $ とグループ分けすればよいです。 答えは 32-bit 整数型に収まらない場合があります。

## 样例 #1

### 输入

```
3

0 10 20

10 0 -100

20 -100 0
```

### 输出

```
20
```

## 样例 #2

### 输入

```
2

0 -10

-10 0
```

### 输出

```
0
```

## 样例 #3

### 输入

```
4

0 1000000000 1000000000 1000000000

1000000000 0 1000000000 1000000000

1000000000 1000000000 0 -1

1000000000 1000000000 -1 0
```

### 输出

```
4999999999
```

## 样例 #4

### 输入

```
16

0 5 -4 -5 -8 -4 7 2 -4 0 7 0 2 -3 7 7

5 0 8 -9 3 5 2 -7 2 -7 0 -1 -4 1 -1 9

-4 8 0 -9 8 9 3 1 4 9 6 6 -6 1 8 9

-5 -9 -9 0 -7 6 4 -1 9 -3 -5 0 1 2 -4 1

-8 3 8 -7 0 -5 -9 9 1 -9 -6 -3 -8 3 4 3

-4 5 9 6 -5 0 -6 1 -2 2 0 -5 -2 3 1 2

7 2 3 4 -9 -6 0 -2 -2 -9 -3 9 -2 9 2 -5

2 -7 1 -1 9 1 -2 0 -6 0 -6 6 4 -1 -7 8

-4 2 4 9 1 -2 -2 -6 0 8 -6 -2 -4 8 7 7

0 -7 9 -3 -9 2 -9 0 8 0 0 1 -3 3 -6 -6

7 0 6 -5 -6 0 -3 -6 -6 0 0 5 7 -1 -5 3

0 -1 6 0 -3 -5 9 6 -2 1 5 0 -2 7 -8 0

2 -4 -6 1 -8 -2 -2 4 -4 -3 7 -2 0 -9 7 1

-3 1 1 2 3 3 9 -1 8 3 -1 7 -9 0 -6 -8

7 -1 8 -4 4 1 2 -7 7 -6 -5 -8 7 -6 0 -9

7 9 9 1 3 2 -5 8 7 -6 3 0 1 -8 -9 0
```

### 输出

```
132
```



---

---
title: "ゲーマーじゃんけん"
layout: "post"
diff: 提高+/省选-
pid: AT_dwango2015_prelims_3
tag: []
---

# ゲーマーじゃんけん

## 题目描述

给你一个由 $N$ 个正整数组成的序列 $A = \{A_1, A_2, \dots, A_N\}$。请你计算出满足以下条件的三元组 $(i, j, k)$ 的数量：

- $1 \leq i < j < k \leq N$
- $A_i \times A_j \times A_k$ 是 $6$ 的倍数

## 输入格式

输入由两行组成：

第一行为一个整数 $N$，表示序列的长度。

第二行为 $N$ 个用空格隔开的整数 $A_1, A_2, \dots, A_N$，表示序列中的元素。

## 输出格式

输出一个整数，表示满足条件的三元组的数量。

## 说明/提示

- $1 \leq N \leq 10^3$
- $1 \leq A_i \leq 10^9$

 **本翻译由 AI 自动生成**



---

---
title: "メンテナンス明け"
layout: "post"
diff: 提高+/省选-
pid: AT_dwango2016qual_c
tag: []
---

# メンテナンス明け

## 题目描述

[problemUrl]: https://atcoder.jp/contests/dwango2016-prelims/tasks/dwango2016qual_c





---

---
title: "庭園"
layout: "post"
diff: 提高+/省选-
pid: AT_dwango2016qual_d
tag: []
---

# 庭園

## 题目描述

dwango公司拥有一个很大的庭院，这个庭院被划分成南北 $H$ 行、东西 $W$ 列的 $1$ 平方米的区域。我们用 $(i, j)$ 表示从北数第 $i$ 行、第 $j$ 列的区域。每个区域中都盛开着花朵，其美观程度用整数 $B_{i,j}$ 来表示。

我们希望通过选取两个至少包含一个区域的矩形，并用栅栏围住这两个矩形，使得未被栅栏围住的地方成为道路，从而美化庭院。请注意，这两个矩形不能有重叠的区域，但是栅栏的重叠没有关系。

整个庭院的美观度被定义为被任何一个矩形围住的区域的总美观程度。

为了创造一个完美的庭院，我们需要计算出可达到的最大美观度。请编写一个程序来找到庭院的最大美观度。

### 输入格式

输入内容如下：

第一行包含两个整数 $H$ 和 $W$（$2 \leq H \leq 300$，$2 \leq W \leq 300$），分别表示庭院在南北方向和东西方向的长度。

接下来的 $H$ 行中，每行有 $W$ 个整数，表示从北数第 $i$ 行各个区域的花朵美观程度 $B_{i,1}, B_{i,2}, \ldots, B_{i,W}$。

### 输出格式

输出一个整数，表示选择两个矩形后的庭院最大美观度。输出应该在一行结束，并在行末加上换行符。

### 数据范围与提示

有部分分测试用例满足以下条件：

- 如果 $H \leq 50$ 和 $W \leq 50$，正确解答可得到 $50$ 分。
- 如果所有测试用例都正确解答，额外再得 $50$ 分。

### 样例解释

1. 通过两个矩形的巧妙选择，整个庭院的美观度可以达到最大值 $9$。

2. 即便在有的情况下，美观度可能为负数，但每个矩形必须至少包含一个区域。

3. 比如，可以像下图所示围住两个矩形：

![围住两个矩形的示意图](https://discovery2016-qual.contest.atcoder.jp/img/other/dwango2016qual/hdfksjghkjsdfhgkjsdhfgkjs/problem2.PNG)

 **本翻译由 AI 自动生成**

## 样例 #1

### 输入

```
3 3

1 1 1

1 1 1

1 1 1
```

### 输出

```
9
```

## 样例 #2

### 输入

```
3 3

-1 -1 -1

-1 -1 -1

-1 -1 -1
```

### 输出

```
-2
```

## 样例 #3

### 输入

```
2 3

5 -1 8

-1 4 -1
```

### 输出

```
16
```

## 样例 #4

### 输入

```
4 4

5 2 -3 2

3 8 -3 -10

4 5 3 2

-5 -3 3 5
```

### 输出

```
40
```



---

---
title: "Modulo Operations"
layout: "post"
diff: 提高+/省选-
pid: AT_exawizards2019_d
tag: []
---

# Modulo Operations

## 题目描述

[problemUrl]: https://atcoder.jp/contests/exawizards2019/tasks/exawizards2019_d

すぬけ君は黒板と $ N $ 個の整数からなる集合 $ S $ を持っています。 $ S $ の $ i $ 番目の要素は $ S_i $ です。

すぬけ君は黒板に整数 $ X $ を書いたのち、以下の操作を $ N $ 回行います。

- $ S $ から要素を $ 1 $ つ選んで取り除く。
- その後、現在黒板に書かれた数を $ x $、$ S $ から取り除かれた整数を $ y $ として、黒板に書かれた数を $ x\ \bmod\ {y} $ に書き換える。

$ S $ から要素を取り除く順序は $ N! $ 通りありえます。 それぞれの場合について、$ N $ 回の操作後に黒板に書かれている数を求め、その総和を $ 10^{9}+7 $ で割ったあまりを求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ X $ $ S_1 $ $ S_2 $ $ \ldots $ $ S_{N} $

## 输出格式

答えを出力せよ。

## 说明/提示

### 制約

- 入力は全て整数である。
- $ 1\ \leq\ N\ \leq\ 200 $
- $ 1\ \leq\ S_i,\ X\ \leq\ 10^{5} $
- $ S_i $ たちは相異なる。

### Sample Explanation 1

\- $ S $ から数を取り除く順序は $ 2 $ 通りあります。 - $ 3,7 $ の順で取り除いたとき、黒板に書かれた数は $ 19\ \rightarrow\ 1\ \rightarrow\ 1 $ と変化します。 - $ 7,3 $ の順で取り除いたとき、黒板に書かれた数は $ 19\ \rightarrow\ 5\ \rightarrow\ 2 $ と変化します。 - これらの総和である $ 3 $ を出力してください。

### Sample Explanation 3

\- 総和を $ 10^{9}+7 $ で割ったあまりを求めるのを忘れずに。

## 样例 #1

### 输入

```
2 19

3 7
```

### 输出

```
3
```

## 样例 #2

### 输入

```
5 82

22 11 6 5 13
```

### 输出

```
288
```

## 样例 #3

### 输入

```
10 100000

50000 50001 50002 50003 50004 50005 50006 50007 50008 50009
```

### 输出

```
279669259
```



---

---
title: "Black or White"
layout: "post"
diff: 提高+/省选-
pid: AT_exawizards2019_e
tag: []
---

# Black or White

## 题目描述

[problemUrl]: https://atcoder.jp/contests/exawizards2019/tasks/exawizards2019_e

今日のすぬけ君のおやつは $ B $ 個の黒いチョコレートと $ W $ 個の白いチョコレートです。

すぬけ君は以下の手続きをチョコレートがなくなるまで繰り返します。

- 黒か白を等確率で選び、選んだ色のチョコレートが存在するなら $ 1 $ つ食べる。

$ 1 $ 以上 $ B+W $ 以下の各整数 $ i $ について、すぬけ君が $ i $ 番目に食べたチョコレートの色が黒である確率を求めてください。 これらの確率は有理数となることが示せます。これらを注記で述べるように modulo $ 10^{9}+7 $ で出力してください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ B $ $ W $

## 输出格式

答えを $ B+W $ 行に出力せよ。$ i $ 行目ではすぬけ君が $ i $ 番目に食べたチョコレートの色が黒である確率を注記で述べるように modulo $ 10^{9}+7 $ で出力せよ。

## 说明/提示

### 注記

有理数を出力する際は、まずその有理数を分数 $ \frac{y}{x} $ として表してください。ここで、$ x,\ y $ は整数であり、$ x $ は $ 10^9\ +\ 7 $ で割り切れてはなりません (この問題の制約下で、そのような表現は必ず可能です)。そして、$ xz\ \equiv\ y\ \pmod{10^9\ +\ 7} $ を満たすような $ 0 $ 以上 $ 10^9\ +\ 6 $ 以下の唯一の整数 $ z $ を出力してください。

### 制約

- 入力は全て整数である。
- $ 1\ \leq\ B,W\ \leq\ 10^{5} $

### Sample Explanation 1

\- チョコレートを食べる順序としてありうるものは以下の $ 3 $ 通りで、そのような食べ方が生じる確率はそれぞれ $ \frac{1}{2},\ \frac{1}{4},\ \frac{1}{4} $ です。 - 白、黒、黒 - 黒、白、黒 - 黒、黒、白 - よって、$ 1 $ 番目、$ 2 $ 番目、$ 3 $ 番目に食べたチョコレートが黒である確率はそれぞれ $ \frac{1}{2},\frac{3}{4},\frac{3}{4} $ です。

### Sample Explanation 2

\- それぞれ $ \frac{1}{2},\frac{1}{2},\frac{5}{8},\frac{11}{16},\frac{11}{16} $ です。

## 样例 #1

### 输入

```
2 1
```

### 输出

```
500000004

750000006

750000006
```

## 样例 #2

### 输入

```
3 2
```

### 输出

```
500000004

500000004

625000005

187500002

187500002
```

## 样例 #3

### 输入

```
6 9
```

### 输出

```
500000004

500000004

500000004

500000004

500000004

500000004

929687507

218750002

224609377

303710940

633300786

694091802

172485353

411682132

411682132
```



---

---
title: "高速フーリエ変換"
layout: "post"
diff: 提高+/省选-
pid: AT_fft_c
tag: []
---

# 高速フーリエ変換

## 题目描述

[problemUrl]: https://atcoder.jp/contests/atc001/tasks/fft_c

この問題は、講座用問題です。ページ下部に解説が掲載されています。

AtCoder 食堂では、定食のメニューを検討しています。

- 主菜は、価格が $ i $ 円のものが $ A_i $ 種類あります $ (1\ ≦\ i\ ≦\ N) $。
- 副菜は、価格が $ i $ 円のものが $ B_i $ 種類あります $ (1\ ≦\ i\ ≦\ N) $。

定食は、主菜と副菜を 1 種類ずつ選んで構成します。 定食の価格は、選んだ主菜と副菜の価格の和とします。

各 $ k\ (1\ ≦\ k\ ≦\ 2N) $ について、価格が $ k $ 円になる定食の種類の数を計算して下さい。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ A_1 $ $ B_1 $ $ A_2 $ $ B_2 $ : $ A_N $ $ B_N $

- $ 1 $ 行目には、整数 $ N\ (1\ ≦\ N\ ≦\ 100,000) $ が書かれている。
- $ 2 $ 行目からの $ N $ 行の $ i $ 行目には、整数 $ A_i,\ B_i\ (0\ ≦\ A_i,\ B_i\ ≦\ 100) $ が書かれている。

## 输出格式

$ 2N $ 行の出力をせよ。$ k $ 行目に価格が $ k $ 円になる定食の種類数を整数で出力せよ。

## 说明/提示

### 解説

  **[高速フーリエ変換](https://www.slideshare.net/secret/fc5RcW8Wkqciu "高速フーリエ変換")**  from **[AtCoder Inc.](http://www.slideshare.net/chokudai)** 

### Sample Explanation 1

\- $ 1 $ 円になる組合せは存在しない。 - $ 2 $ 円の組み合わせは、$ 1 $ 円の主菜と副菜が $ 1 $ 種類ずつなので $ 1 $ 通り。 - $ 3 $ 円の組み合わせは、$ 1×2\ +\ 2×1\ =\ 4 $ 通り。

## 样例 #1

### 输入

```
4

1 1

2 2

3 4

4 8
```

### 输出

```
0

1

4

11

26

36

40

32
```



---

---
title: "1=0.999..."
layout: "post"
diff: 提高+/省选-
pid: AT_hbpc_3
tag: []
---

# 1=0.999...

## 题目描述

[problemUrl]: https://atcoder.jp/contests/hbpc2012/tasks/hbpc_3

1 と 0.999... がまったく同じ実数を表すということは、 ネット上でもしばしば議論される話題です。  
 この問題は、そんな小数に関する問題です。 入力は以下の形式に従う。

> $ N $ $ a_1 $ $ a_2 $ : $ a_N $

 1行目には、与えられる小数の数 $ N $ が与えられる。 2行目から続く $ N $ 行では、実数 $ a_i $ が与えられる。  
 $ a_i $ は有限小数または循環小数であり、実数の集合 $ A\ =\ {a_i} $ のすべての要素を表す。 $ 1 $ つの実数が異なる表記で与えられる場合がある。  
 有限小数および循環小数は以下のBNFに従う。 循環小数において括弧で囲まれた部分は循環節を表し、 例えば `0.(01)` は $ 0.010101... $ を表現する。  
```
<pre style="font-family: monospace;letter-spacing:0;">
 ::=  "." 
 ::=  "."  "("  ")"
   ::= "0" |  
      ::= "" | 
      ::=  
    ::= "0" | 
    ::= "1" | "2" | "3" | "4" | "5" | "6" | "7" | "8" | "9"
```

- $ 1\ ≦\ N\ ≦\ 300 $
- $ a_i $ の文字列長は $ 300 $ 以下
 
 実数の集合 $ A $ の要素数を求めよ。 ```
<pre class="prettyprint linenums">
2
1.0
0.(9)
```

 ```
<pre class="prettyprint linenums">
1
```

 ```
<pre class="prettyprint linenums">
3
3.(142857)
3.1(428571)
3.14(285714)
```

 ```
<pre class="prettyprint linenums">
1
```



---

---
title: "ThREE"
layout: "post"
diff: 提高+/省选-
pid: AT_hitachi2020_c
tag: []
---

# ThREE

## 题目描述

[problemUrl]: https://atcoder.jp/contests/hitachi2020/tasks/hitachi2020_c

$ N $ 頂点の木があります。頂点には $ 1 $ から $ N $ までの番号がついており、 $ i $ 番目の辺は頂点 $ a_i $ と頂点 $ b_i $ を結んでいます。

$ 3 $ が大好きな高橋くんは、以下の条件を満たす $ 1 $ から $ N $ までの整数の順列 $ p_1,\ p_2,\ \ldots\ ,\ p_N $ を探しています。

- すべての頂点の組 $ (i,\ j) $ について、頂点 $ i $ と頂点 $ j $ の距離が $ 3 $ であるならば、$ p_i $ と $ p_j $ の和または積が $ 3 $ の倍数である。

ただし、頂点 $ i $ と頂点 $ j $ の距離とは、頂点 $ i $ から頂点 $ j $ へ最短経路で移動するときに使用する辺の個数のことを指します。

高橋くんのために条件を満たす順列を $ 1 $ つ見つけてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ a_1 $ $ b_1 $ $ a_2 $ $ b_2 $ $ \vdots $ $ a_{N-1} $ $ b_{N-1} $

## 输出格式

問題の条件を満たす順列が存在しない場合は `-1` と $ 1 $ 行に出力せよ。

存在する場合、条件を満たす順列の $ 1 $ つを空白区切りで $ 1 $ 行に出力せよ。

## 说明/提示

### 制約

- $ 2\leq\ N\leq\ 2\times\ 10^5 $
- $ 1\leq\ a_i,\ b_i\ \leq\ N $
- 与えられるグラフは木である

### Sample Explanation 1

距離が $ 3 $ である頂点の組は $ (2,\ 4) $ と $ (2,\ 5) $ の $ 2 $ つです。 - $ p_2\ +\ p_4\ =\ 6 $ - $ p_2\times\ p_5\ =\ 6 $ であるため、この順列は条件を満たします。

## 样例 #1

### 输入

```
5

1 2

1 3

3 4

3 5
```

### 输出

```
1 2 5 4 3
```



---

---
title: "Minimum Spanning Tree"
layout: "post"
diff: 提高+/省选-
pid: AT_icpc2013spring_e
tag: []
---

# Minimum Spanning Tree

## 题目描述

[problemUrl]: https://atcoder.jp/contests/JAG2013Spring/tasks/icpc2013spring_e





---

---
title: "真っ暗な部屋"
layout: "post"
diff: 提高+/省选-
pid: AT_icpc2015summer_day2_d
tag: []
---

# 真っ暗な部屋

## 题目描述

睁开眼睛，A君发现自己在一个漆黑的房间里，他身处在一个由 $N$ 个房间(其中 $M$ 间是小黑屋)组成的迷宫内，但是不知道自己在哪个房间，现在你有这个迷宫的地图，你需要带领A君走出迷宫。

虽然A君不知道自己在哪，但是他面前有 $K$ 条道路，你可以通过许多指令告诉他该走第几条道路最终到达明亮的屋子。当然，如果指令还未结束，但A君已经到达明亮的屋子时，他便不会再执行指令。

注意：你不知道A君在哪个小黑屋，所以你需要给A君一串万能的指令，让他无论在哪个小黑屋，都可以通过这串指令走到明亮的屋子。

由于A君的记忆力不好，所以你需要让这串指令的长度尽可能的小，问这串指令的最短长度。

## 输入格式

第一行三个整数 $N,M,K$。

第二行 $M$ 个整数，$D_i$ 代表第 $i$ 个小黑屋编号是 $D_i$。

接下来 $N$ 行，每行 $K$ 个整数 $v_{i,j}$，第 $i$ 行第 $j$ 个数表示房间 $i$ 到房间 $j$ 有一条单向道路（可能存在自环）。

## 输出格式

一个整数，代表最短的指令长度。

## 说明/提示

### 数据规模与约定
$2\ \leq\ N\ \leq\ 100$，

$1\ \leq\ M\ \leq\ min(16,\ N-1)$，

$1\ \leq\ K\ \leq\ N$，

$1\ \leq\ D_i\ \leq\ N$，

$1\ \leq\ v_{i,\ j}\ \leq\ N$

保证每个 $D_i$ 不相同，且每个小黑屋都至少有一条路径可以到达明亮的屋子。

### 样例解释1
![](https://cdn.luogu.com.cn/upload/vjudge_pic/AT1449/f3908ff54756afa86688e91fce4eb6ce09d2229d.png)

如果你给出指令 ```1,1```，

当A君在 $1$ 号屋子时，他会走道路 $v_{1,1}$（即道路 $1$） 到达 $2$ 号屋子，再从 $2$ 号屋子走 $v_{2,1}$ 到达 $3$ 号屋子（亮屋）。

当A君在 $2$ 号屋子时，他会走 $v_{2,1}$ 到达 $3$ 号屋子，由于此时A君已经到达明亮的屋子，所以他不会再去执行下一条指令（即从 $3$ 号屋子走 $v_{3,1}$ 到达 $4$ 号屋子）。

### 样例解释2
![](https://cdn.luogu.com.cn/upload/vjudge_pic/AT1449/2c40711da8bb302f53576b4f2fe9db6e7bacb670.png)

如果你给出指令 ```2,1,2```，

当A君在 $1$ 号屋子时，他会走 $v_{1,2}$ 到达 $3$ 号屋子（此时情况处理见样例解释1）。

当A君在 $2$ 号屋子时，他会走 $v_{2,2}$ 到达 $2$ 号屋子，走 $v_{2,1}$ 到达 $1$ 号屋子，走 $v_{1,2}$ 到达 $3$ 号屋子。

### 样例解释3
![](https://cdn.luogu.com.cn/upload/vjudge_pic/AT1449/3422b955471ad6e11300f3a42a30605370eb1e29.png)

此时给出指令 ```1,2,3``` 即可。

### 注意
要求输出指令的**最短长度**，而不是指令。



---

---
title: "Prime-Factor Prime"
layout: "post"
diff: 提高+/省选-
pid: AT_jag2017autumn_c
tag: []
---

# Prime-Factor Prime

## 题目描述

[problemUrl]: https://atcoder.jp/contests/jag2017autumn/tasks/jag2017autumn_c





---

---
title: "Conveyor Belt"
layout: "post"
diff: 提高+/省选-
pid: AT_jag2017autumn_k
tag: []
---

# Conveyor Belt

## 题目描述

[题目链接]: https://atcoder.jp/contests/jag2017autumn/tasks/jag2017autumn_k

## 说明/提示

**本翻译由 AI 自动生成**



---

---
title: "夜店 (Night Market)"
layout: "post"
diff: 提高+/省选-
pid: AT_joi2012ho3
tag: []
---

# 夜店 (Night Market)

## 题目描述

从 $N$ 个夜市中选择其中几个夜市进行游玩，给定：

$A_i$：在夜市 $i$ 玩的乐趣值；

$B_i$：在夜市 $i$ 游玩的时长。

要求：

- 必须按顺序游玩；

- 在夜市游玩的时间是 $0$~$T$；

- 游玩时间不得与时间点 $S$ 重叠；

- 使游玩乐趣值之和 $M$ 尽可能大。

## 输入格式

第一行三个整数 $N$，$T$，$S$；

以下 $N$ 行，每行两个整数 $A_i$，$B_i$。

## 输出格式

一个整数 $M$。

### 样例

#### 样例输入

```
5 20 14
8 9
2 4
7 13
6 3
5 8
```

#### 样例输出

```
16
```

## 说明/提示

**样例解释**

$0$ 时游玩夜市 $1$；

$9$ 时游玩夜市 $2$；

$14$ 时游玩夜市 $4$；
 
$M=8+2+6=16$
 

$10 \%$ 的数据满足：$N \le 20$

$20 \%$ 的数据满足：$S = 0$

全部的数据满足：

$1 \le N, T, B_i \le 3000$

$0 \le S \le T$

$0 \le A_i \le 10^5$

保证输入数据能够制定至少一种游玩方案。

**Source**

[JOI 2011/2012 本選 問題3](https://www.ioi-jp.org/joi/2011/2012-ho-prob_and_sol/2012-ho.pdf#page=7)

**Translate**

By [zerc](https://www.luogu.com.cn/user/581312)



---

---
title: "JOI 国のお祭り事情 (Festivals in JOI Kingdom)"
layout: "post"
diff: 提高+/省选-
pid: AT_joi2012ho5
tag: []
---

# JOI 国のお祭り事情 (Festivals in JOI Kingdom)

## 题目描述

给定一张 $n$ 点 $m$ 边的无向图，其中有 $k$ 个点上有特殊标记。你需要回答 $q$ 次询问，每次询问包含两个整数 $s_i$ 和 $t_i$，请求出从 $s_i$ 到 $t_i$ 的路径中，在尽可能远离有标记的点的情况下距离有标记的点的长度的最小值。

## 输入格式

第一行：四个整数 $n,m,k,q$，意义如题；

接下来 $m$ 行，每行三个整数 $a_i,b_i,l_i$，表示存在一条连接 $a_i$ 和 $b_i$ 的，长度为 $l_i$ 的边；

接下来 $k$ 行，每行一个整数 $f_i$，表示第 $f_i$ 个点有标记；

接下来 $q$ 行，每行两个正整数 $s_i,t_i$，意义如题。

## 输出格式

输出 $q$ 行，每行一个整数，表示从 $s_i$ 到 $t_i$ 的路径中到有标记的点的距离最大的路径到有标记的点的距离。

### 输入输出样例

#### 输入 #1

```
6 6 2 3
1 2 5
2 3 4
2 4 6
3 5 9
4 5 3
5 6 7
1
6
3 4
5 2
1 4
```

#### 输出 #1

```
7
5
0
```

#### 输入 #2

```
12 17 2 5
1 3 6
1 6 7
2 3 8
2 4 4
2 8 11
2 12 2
3 6 3
3 7 8
3 11 2
4 12 2
5 10 3
6 10 5
8 9 6
8 12 7
9 10 6
11 9 10
12 9 5
8
7
2 6
5 2
1 10
8 9
9 4
```

#### 输出 #2

```
8
8
11
0
6
```

## 说明/提示

#### 样例 #1 解释

$6$ 个点 $6$ 条边，第 $1,6$ 个点做了标记。

从点 $3$ 到点 $4$ 的路径有`3 2 4`和`3 5 4`两条。前者的最短距离为 $5$，后者为 $7$，所以输出 $7$。

从点 $5$ 到点 $2$ 的路径中，点 $2$ 一定是距离标记点最近的点，所以输出 $5$。

从点 $1$ 到点 $4$ 的路径中，由于点 $1$ 被标记，所以输出 $0$。

#### 样例 #2 解释

（详细解释无，有需要者可以自行打开 PPT 看本样例的图）

#### 数据规模与约定

- $2 \le n \le 10^5$，$1 \le m \le 2 \times 10^5$，$1 \le k \le n$，$1 \le q \le 10^5$，$1 \le l_i \le 1000$；
- $1 \le a_i,b_i,f_i,s_i,t_i \le n$，给出的图无重边，无自环，保证图联通；
- 对于任意一组 $(s_i,t_i)$，保证 $s_i\neq t_i$。



---

---
title: "現代的な屋敷 (Modern Mansion)"
layout: "post"
diff: 提高+/省选-
pid: AT_joi2013ho3
tag: []
---

# 現代的な屋敷 (Modern Mansion)

## 题目描述

有一座东西 $M$ 列南北 $N$ 行的大宅。

任何相邻的两间房之间都有一扇门连接，若一扇门是打开状态，则可以从门的一边走到另一边，并且花费 $1$ 分钟。

$K$ 个房间设有开关，按下开关会导致所有门的开关状态切换，并且花费 $1$ 分钟。

最开始连接东西相邻房间的所有门都关闭，连接南北相邻房间的所有门都打开，输出从房间 $(1,1)$ 移动到房间 $(M,N)$ 的最短时间。

## 输入格式

第一行三个数 $M,N,K$。

接下来 $K$ 行，每行两个数，表示有开关房间的坐标。

## 输出格式

输出从房间 $(1,1)$ 移动到房间 $(M,N)$ 的最短时间，如果无法到达输出 $-1$。

## 说明/提示

样例 $1$ 解释：

从 $(1,1)$ 到 $(1,2)$，按下开关，然后到 $(2,2)$，最后到达 $(3,2)$，耗时 $4$ 分钟。可以证明不存在时间更短的方案。

![](https://img.atcoder.jp/joi2013ho/088a24305fc2470b9ff17a0cd60c556b.png)

样例 $2$ 解释：

容易证明只能到达 $(1,1)$ 或 $(1,2)$，因此不能到达 $(3,2)$。

样例 $3$ 图示：

![](https://img.atcoder.jp/joi2013ho/128c91a07269803fa720723600260cea.png)

对于 $20\%$ 的数据，$M,N\le10^3$。

对于另外 $30\%$ 的数据，$K\le2\times10^3$。

对于 $100\%$ 的数据，$M,N\le10^5, K\le2 \times 10^5$。

## 样例 #1

### 输入

```
3 2 1
1 2
```

### 输出

```
4
```

## 样例 #2

### 输入

```
3 2 1
2 1
```

### 输出

```
-1
```

## 样例 #3

### 输入

```
8 9 15
3 1
3 2
3 7
3 8
1 1
4 5
4 3
5 6
5 8
6 3
6 2
7 5
8 9
8 6
8 5
```

### 输出

```
25
```



---

---
title: "IOI 饅頭 (IOI Manju)"
layout: "post"
diff: 提高+/省选-
pid: AT_joi2014ho2
tag: []
---

# IOI 饅頭 (IOI Manju)

## 题目描述

[problemUrl]: https://atcoder.jp/contests/joi2014ho/tasks/joi2014ho2

Incredible Okashi Inc. は「途方もなくおいしいお菓子 (incredible okashi)」を製作している会社である．ここでは略して IOI 社と呼ぶ．IOI 社は特製の IOI 饅頭を作ったので，それを販売することになった．IOI 社は $ M $ 種類の饅頭を $ 1 $ 個ずつ作った．作られた $ M $ 個の饅頭はすべて同じ大きさであるが，ひとつひとつ異なる味なので価格は様々であり，$ i $ 番目 ($ 1\ \leqq\ i\ \leqq\ M $) の饅頭の価格は $ P_i $ 円である．

ところで，あなたは Just Odd Inventions 社を知っているだろうか？ この会社の業務は「ただ奇妙な発明 (just odd inventions)」をすることである．ここでは略して JOI 社と呼ぶ．IOI 社は，饅頭を詰めるための高級な箱を JOI 社に発注することになった．JOI 社の製作する饅頭用の箱は $ N $ 種類あり，$ j $ 番目 ($ 1\ \leqq\ j\ \leqq\ N $) の箱は最大で $ C_j $ 個の饅頭を詰められる大きさであり，販売価格は $ E_j $ 円である．これらの $ N $ 種類の箱のうちの何種類か ($ 0 $ 種類以上 $ N $ 種類以下) を $ 1 $ 個ずつ発注し，饅頭をそれらの箱に詰め分けてセットで販売することになった．各饅頭セットの価格は，それに含まれる饅頭の価格の合計である．

すべての饅頭セットが売れるとした場合，IOI 社が得ることができる利益の最大値はいくらだろうか．ここで利益とは，販売した饅頭セットの価格の合計から，発注した箱の価格の合計を引いた値である．なお，箱に詰めなかった饅頭については，IOI 社のスタッフがおいしくいただくため，利益には影響しないものとする．

## 输入格式

標準入力から以下のデータを読み込め．

- $ 1 $ 行目には，整数 $ M,\ N $ が空白を区切りとして書かれており，饅頭が $ M $ 個，箱が $ N $ 種類あることを表す．
- 続く $ M $ 行のうちの $ i $ 行目 ($ 1\ \leqq\ i\ \leqq\ M $) には，整数 $ P_i $ が書かれており，$ i $ 番目の饅頭の価格が $ P_i $ 円であることを表す．
- 続く $ N $ 行のうちの $ j $ 行目 ($ 1\ \leqq\ j\ \leqq\ N $) には，整数 $ C_j,\ E_j $ が空白を区切りとして書かれており，$ j $ 番目の箱は最大で $ C_j $ 個の饅頭を詰められる大きさであり，価格が $ E_j $ 円であることを表す．

## 输出格式

標準出力に，IOI 社が得られる利益の最大値を円単位で表す整数を $ 1 $ 行で出力せよ．

- - - - - -

## 说明/提示

### 課題

各饅頭の価格と，各箱の大きさと価格が与えられたとき，IOI 社が得ることができる利益の最大値を求めるプログラムを作成せよ．

- - - - - -

### 制限

すべての入力データは以下の条件を満たす．

- $ 1\ \leqq\ M\ \leqq\ 10\,000 $．
- $ 1\ \leqq\ N\ \leqq\ 500 $．
- $ 1\ \leqq\ P_i\ \leqq\ 10\,000 $ ($ 1\ \leqq\ i\ \leqq\ M $)．
- $ 1\ \leqq\ C_j\ \leqq\ 10\,000 $ ($ 1\ \leqq\ j\ \leqq\ N $)．
- $ 1\ \leqq\ E_j\ \leqq\ 10\,000 $ ($ 1\ \leqq\ j\ \leqq\ N $)．

### 小課題

#### 小課題 1 \[25 点\]

$ N\ \leqq\ 10 $ を満たす．

#### 小課題 2 \[35 点\]

$ C_j\ \leqq\ 10 $ ($ 1\ \leqq\ j\ \leqq\ N $) を満たす．

#### 小課題 3 \[40 点\]

追加の制限はない．

- - - - - -

### Sample Explanation 1

この例では，$ 1 $ 番目の箱 ($ 100 $ 円) と $ 2 $ 番目の箱 ($ 120 $ 円) を発注し，たとえば $ 1 $ 番目の箱に $ 1 $ 番目の饅頭と $ 2 $ 番目の饅頭を詰めて $ 180\ +\ 160\ =\ 340 $ 円のセットとして販売，$ 2 $ 番目の箱に $ 3 $ 番目の饅頭と $ 4 $ 番目の饅頭を詰めて $ 170\ +\ 190\ =\ 360 $ 円のセットとして販売すると，IOI 社の利益は $ 700\ -\ 220\ =\ 480 $ 円となる． - - - - - -

### Sample Explanation 2

\- - - - - -

## 样例 #1

### 输入

```
4 3
180
160
170
190
2 100
3 120
4 250
```

### 输出

```
480
```

## 样例 #2

### 输入

```
2 2
1000
2000
1 6666
1 7777
```

### 输出

```
0
```

## 样例 #3

### 输入

```
10 4
200
250
300
300
350
400
500
300
250
200
3 1400
2 500
2 600
1 900
```

### 输出

```
450
```



---

---
title: "バームクーヘン (Baumkuchen)"
layout: "post"
diff: 提高+/省选-
pid: AT_joi2014ho3
tag: []
---

# バームクーヘン (Baumkuchen)

## 题目描述

[problemUrl]: https://atcoder.jp/contests/joi2014ho/tasks/joi2014ho3

JOI 君は妹の JOI 子ちゃんと JOI 美ちゃんと一緒におやつを食べようとしている．今日のおやつは $ 3 $ 人の大好物のバームクーヘンだ．

バームクーヘンは下図のような円筒形のお菓子である．$ 3 $ 人に分けるために，JOI 君は半径向に刃を $ 3 $ 回入れて，これを $ 3 $ つのピースに切り分けなければならない．ただしこのバームクーヘンは本物の木材のように固いので，刃を入れるのは簡単ではない．そのためこのバームクーヘンにはあらかじめ $ N $ 個の切れ込みが入っており，JOI 君は切れ込みのある位置でのみ切ることができる．切れ込みに $ 1 $ から $ N $ まで時計回りに番号をふったとき，$ 1\ \leqq\ i\ \leqq\ N\ -\ 1 $ に対し，$ i $ 番目の切れ込みと $ i\ +\ 1 $ 番目の切れ込みの間の部分の大きさは $ A_i $ である．また $ N $ 番目の切れ込みと $ 1 $ 番目の切れ込みの間の部分の大きさは $ A_N $ である．

![](https://cdn.luogu.com.cn/upload/vjudge_pic/AT_joi2014ho3/5c087c509e50fd3943f3a436bd121047a3ea6c93.png)図 1: バームクーヘンの例 $ N\ =\ 6 $，$ A_1\ =\ 1 $，$ A_2\ =\ 5 $，$ A_3\ =\ 4 $，$ A_4\ =\ 5 $，$ A_5\ =\ 2 $，$ A_6\ =\ 4 $



妹思いの JOI 君は，バームクーヘンを $ 3 $ つのピースに切り分けたあと，自分は最も小さいピースを選び，残りの $ 2 $ つのピースを $ 2 $ 人の妹にあげることにした．一方で，JOI 君はバームクーヘンが大好物なので，できるだけたくさん食べたいと思っている．最も小さいピースの大きさが最大になるように切ったとき，JOI 君が食べることになるピースの大きさはいくらになるだろうか．

## 输入格式

標準入力から以下の入力を読み込め．

- $ 1 $ 行目には，整数 $ N $ が書かれている．これはバームクーヘンに $ N $ 個の切れ込みがあることを表す．
- 続く $ N $ 行のうちの $ i $ 行目 ($ 1\ \leqq\ i\ \leqq\ N $) には，整数 $ A_i $ が書かれている．これは $ i $ 番目の切れ込みと $ i\ +\ 1 $ 番目の切れ込みの間の部分 ($ i\ =\ N $ のときは $ N $ 番目の切れ込みと $ 1 $ 番目の切れ込みの間の部分) の大きさが $ A_i $ であることを表す．

## 输出格式

標準出力に，バームクーヘンを $ 3 $ つに切り分けたときの，最も小さいピースの大きさの最大値を表す整数を $ 1 $ 行で出力せよ．

- - - - - -

## 说明/提示

### 課題

切れ込みの個数 $ N $ と，各部分の大きさを表す整数 $ A_1,\ \ldots,\ A_N $ が与えられる．バームクーヘンを $ 3 $ つに切り分けたときの，最も小さいピースの大きさの最大値を出力するプログラムを作成せよ．

- - - - - -

### 制限

すべての入力データは以下の条件を満たす．

- $ 3\ \leqq\ N\ \leqq\ 100\,000 $．
- $ 1\ \leqq\ Ai\ \leqq\ 1\,000\,000\,000 $ ($ 1\ \leqq\ i\ \leqq\ N $)．

### 小課題

#### 小課題 1 \[5 点\]

$ N\ \leqq\ 100 $ を満たす．

#### 小課題 2 \[15 点\]

$ N\ \leqq\ 400 $ を満たす．

#### 小課題 3 \[30 点\]

$ N\ \leqq\ 8\,000 $ を満たす．

#### 小課題 4 \[50 点\]

追加の制限はない．

- - - - - -

### Sample Explanation 1

!\[\](https://img.atcoder.jp/joi2014ho/2014-ho-t3-fig02.png)図 2: $ 1 $ 番目の切れ込みと $ 3 $ 番目の切れ込みと $ 5 $ 番目の切れ込みで切るのが最善である． - - - - - -

## 样例 #1

### 输入

```
6
1
5
4
5
2
4
```

### 输出

```
6
```

## 样例 #2

### 输入

```
30
1
34
44
13
30
1
9
3
7
7
20
12
2
44
6
9
44
31
17
20
33
18
48
23
19
31
24
50
43
15
```

### 输出

```
213
```



---

---
title: "フクロモモンガ  (Sugar Glider)"
layout: "post"
diff: 提高+/省选-
pid: AT_joi2014ho4
tag: []
---

# フクロモモンガ  (Sugar Glider)

## 题目描述

有 $ n $ 棵树，第 $ i $ 棵树高 $ h_i $ 米，一只小鼠初始位于 $ 1 $ 号树 $ X $ 高度。现有 $ m $ 条航线，表示从 $ u_i $ 号树飞到 $ v_i $ 号树需要 $ t_i $ 秒（是双向边！），飞行过程中它离地面的高度会每秒下降 $ 1 $ 米，小鼠必须保证飞到 $ v_i $ 号树时不会高于树，也不会低于地面，它可以通过在 $ u_i $ 号树上以一米每秒的速度向上（向下）奔波完成！现在它需要到 $ n $ 号树的最高处，请你求出最短时间，不能到达输出 $ -1 $ 。  $ n,m\le 10^5~;~h_i,X,t_i\le 10^9 $ 


接下来 $N$ 行中，第 $i(1\le i\le N)$ 行有一个整数 $H_{i}$，表示树木$i$的高度是 $H_{i}$ 米。

接下来 $M$ 行中，第 $j(1\le j\le M)$ 行有三个以空格分开的整数 $A_{j},B_{j},T_{j}$ $(1\le A_{j}, B_{j}\le N,$ $A_{j}\ne B_{j})$，表示小鼠能花 $T_{j}$ 秒的时间从 $A_{j}$ 飞到 $B_{j}$ 或从 $B_{j}$ 飞到 $A_{j}$。  

对于任意 $1\le j < k\le M$，满足 $(A_{j},B_{j})\neq (A_{k},B_{k})$ 且 $(A_{j},B_{j})\neq (B_{k},A_{k})$。

## 输出格式

输出到标准输出，仅一行一个整数，表示从树木 $1$ 上高度为 $X$ 米处移动到树木 $N$ 顶端所需时间的最小值（单位：秒）。如果不能到达目的地则输出 $-1$。

## 样例：

### 输入样例 1
```plain
5 5 0
50
100
25
30
10
1 2 10
2 5 50
2 4 20
4 3 1
5 4 20
```

### 输出样例 1
```plain
110
```

## 说明/提示

下列是其中一种最优解：

1. 沿着树木 $1$ 向上爬 $50$ 米。
1. 从树木 $1$ 飞到树木 $2$。
1. 从树木 $2$ 飞到树木 $4$。
1. 从树木 $4$ 飞到树木 $5$。
1. 沿着树木 $5$ 向上爬 $10$ 米。

### 输入样例 2
```plain
2 1 0
1
1
1 2 100
```

### 输出样例 2
```plain
-1
```

### 样例解释 2

小鼠无法从树木 $1$ 飞到树木 $2$。

### 输入样例 3
```plain
4 3 30
50
10
20
50
1 2 10
2 3 10
3 4 10
```

### 输出样例 3
```plain
100
```

全部的输入数据满足：

- $2\le N\le 100000$
- $1\le M\le 300000$
- $1\le H_{i}\le 10^{9}(1\le i\le N)$
- $1\le T_{j}\le 10^{9}(1\le j\le M)$
- $0\le X\le H_{1}$

#### 子任务 1（25 分）

满足以下条件：

- $N\le 1000$
- $M\le 3000$
- $H_{i}\le 100(1\le i\le N)$
- $T_{j}\le 100(1\le j\le M)$

#### 子任务 2（25 分）

满足 $X=0$。

#### 子任务 3（50 分）

没有额外限制。

## 样例 #1

### 输入

```
5 5 0
50
100
25
30
10
1 2 10
2 5 50
2 4 20
4 3 1
5 4 20
```

### 输出

```
110
```

## 样例 #2

### 输入

```
2 1 0
1
1
1 2 100
```

### 输出

```
-1
```

## 样例 #3

### 输入

```
4 3 30
50
10
20
50
1 2 10
2 3 10
3 4 10
```

### 输出

```
100
```



---

---
title: "小籠包 (Xiao Long Bao)"
layout: "post"
diff: 提高+/省选-
pid: AT_joi2014yo_f
tag: []
---

# 小籠包 (Xiao Long Bao)

## 题目描述

## 题目大意

JOI再吃他的小笼包，第i个小笼包和第j个小笼包的距离是|i-j|。众所周知，吃小笼包时会把汁溅到别的小笼包上，吃第i个小笼包时，与第i个小笼包的距离在d[i]范围内的所有小笼包（不包括自己，包括距离刚好的d[i]的笼包）的味道会+1。吃到的笼包的味道=这个笼包本来的味道a[i]+这个笼包上的汁水。

现在JOI想知道，用怎么样的吃小笼包顺序可以让吃到的总味道最大。

## 输入格式

第1行是一个整数n（1<=n<=100),表示有n个笼包。

第2行有n个整数：D1、D2、D3...Dn(0<=Di<=7)，表示笼包会溅到的距离范围。

第3行有n个整数：A1、A2、A3...An(0<=Ai<=1000),表示笼包初始味道。

## 输出格式

输出最大的总味道。

## 输入输出样例：

![捕获.PNG](https://i.loli.net/2018/12/31/5c29e963e05fc.png)



样例1解释：吃的顺序：5->3->1->2->4

## 样例 #1

### 输入

```
5
1 0 1 1 2
0 2 6 3 4
```

### 输出

```
20
```

## 样例 #2

### 输入

```
10
5 2 7 2 6 5 3 5 3 6
8 7 8 4 0 6 0 10 10 0
```

### 输出

```
237
```



---

---
title: "城壁 (Rampart)"
layout: "post"
diff: 提高+/省选-
pid: AT_joi2015ho_e
tag: []
---

# 城壁 (Rampart)

## 题目描述

[problemUrl]: https://atcoder.jp/contests/joi2015ho/tasks/joi2015ho_e

歴史学者である JOI 教授は，かつて存在した IOI 王国について研究している．

過去の調査によると，IOI 王国は縦 $ H $ 行，横 $ W $ 列のマスに区切られた長方形の形をしていた．IOI 王国の首都は，防衛のために城壁で囲われていた．

IOI 王国の首都を囲う城壁は次のような形をしている．城壁には大きさと呼ばれる値が定まっている．大きさ $ s $ ($ s\ \geqq\ 3 $) の城壁とは，$ s\ \times\ s $ の正方形の領域から外周以外の $ (s\ -\ 2)\ \times\ (s\ -\ 2) $ の正方形の領域を除いたものである．

調査によると，首都を囲う城壁の大きさは $ L $ 以上であった．また，IOI 王国のいくつかのマスには城壁が存在しなかったことがわかっている．

JOI 教授は，さらなる研究のために，城壁としてありうるものが何通りあるかを知りたい．

## 输入格式

標準入力から以下のデータを読み込め．

- $ 1 $ 行目には，整数 $ H,\ W,\ L,\ P $ が空白を区切りとして書かれている．これは，IOI 王国は縦 $ H $ 行，横 $ W $ 列のマスに区切られた長方形の形をしており，城壁の大きさは $ L $ 以上であり，城壁が存在しなかったことがわかっているマスが $ P $ マス存在することを表す．
- 続く $ P $ 行のうちの $ i $ 行目 ($ 1\ \leqq\ i\ \leqq\ P $) には，整数 $ A_i,\ B_i $ が空白を区切りとして書かれている．これは，IOI 王国の上から $ A_i $ 行目，左から $ B_i $ 列目のマスには城壁が存在しなかったことがわかっていることを表す．

## 输出格式

標準出力に，城壁としてありうるものは何通りあるかを表す整数を $ 1 $ 行で出力せよ．

- - - - - -

## 说明/提示

### 課題

IOI 王国の大きさと，城壁の大きさの最小値，城壁が存在しなかったことが分かっているマスの情報が与えられたとき，城壁としてありうるものは何通りあるかを求めるプログラムを作成せよ．

- - - - - -

### 制限

すべての入力データは以下の条件を満たす．

- $ 1\ \leqq\ H\ \leqq\ 4\,000 $．
- $ 1\ \leqq\ W\ \leqq\ 4\,000 $．
- $ 3\ \leqq\ L\ \leqq\ H $ かつ $ 3\ \leqq\ L\ \leqq\ W $．
- $ 0\ \leqq\ P\ \leqq\ 100\,000 $．
- $ 1\ \leqq\ A_i\ \leqq\ H $ ($ 1\ \leqq\ i\ \leqq\ P $)．
- $ 1\ \leqq\ B_i\ \leqq\ W $ ($ 1\ \leqq\ i\ \leqq\ P $)．
- ($ A_i,\ B_i)\ \neq\ (A_j,\ B_j $) ($ 1\ \leqq\ i\ <\ j\ \leqq\ P $)．

### 小課題

#### 小課題 1 \[4 点\]

以下の条件を満たす．

- $ H\ \leqq\ 500 $．
- $ W\ \leqq\ 500 $．

#### 小課題 2 \[16 点\]

- $ 0\ \leqq\ P\ \leqq\ 10 $ を満たす．

#### 小課題 3 \[80 点\]

追加の制限はない．

- - - - - -

### Sample Explanation 1

この入力例の場合，城壁としてありうるものは以下の $ 4 $ 通りが考えられる．ただし，`×` で示したマスは城壁が存在しなかったことがわかっているマスである． !\[e-1.png\](https://img.atcoder.jp/joi2015ho/e-1.png) - - - - - -

### Sample Explanation 2

\- - - - - -

## 样例 #1

### 输入

```
5 5 3 2
2 2
4 3
```

### 输出

```
4
```

## 样例 #2

### 输入

```
7 8 4 3
2 2
3 7
6 5
```

### 输出

```
13
```

## 样例 #3

### 输入

```
4000 4000 1234 4
1161 3028
596 1892
3731 2606
702 1530
```

### 输出

```
7050792912
```



---

---
title: "スタンプラリー 2 (Collecting Stamps 2)"
layout: "post"
diff: 提高+/省选-
pid: AT_joi2016ho_b
tag: []
---

# スタンプラリー 2 (Collecting Stamps 2)

## 题目描述

[problemUrl]: https://atcoder.jp/contests/joi2016ho/tasks/joi2016ho_b

JOI 商店街には大通りに沿って $ N $ 個の店があり，JOI 商店街の入口から出口に向かってそれぞれ $ 1,\ 2,\ \ldots,\ N $ の番号が付けられている．JOI 商店街は一方通行で，入口から出口方向へしか移動することはできない．

まちおこしのため，JOI 商店街でスタンプラリーを行うことになった．このスタンプラリーでは，それぞれの店は `J`，`O`，`I` のいずれかのスタンプを用意し，店で買い物をした人はスタンプカードにスタンプを押してもらう．スタンプラリーに参加する人はちょうど $ 3 $ つの店に入る．商店街の入口では $ 3 $ つの欄のあるスタンプカードを配り，$ 1 $ 回目に入った店，$ 2 $ 回目に入った店，$ 3 $ 回目に入った店のスタンプを押してもらう．商店街の出口でスタンプカードを回収し，押されたスタンプが先に入った店のものから順に `J`，`O`，`I` になっているとき，出口で商品券がもらえるキャンペーンを実施することになった．押されたスタンプの種類や順番が異なるときは商品券はもらえない．

すでに $ N $ 個のすべての店はどのスタンプを用意するか決めたが，新たに $ 1 $ つの店を JOI 商店街に出すことになり，新しく出店する場所と，その店が用意するスタンプを決めることになった．新しい店を出す場所は，店 $ i $ と店 $ i\ +\ 1 $ の間 ($ 1\ \leqq\ i\ \leqq\ N\ -\ 1 $)，入口と店 $ 1 $ の間，店 $ N $ と出口の間のいずれかから決める．また，新しい店のスタンプは `J`，`O`，`I` の 3 通りから決める．

商品券をもらえるような店の選び方の数が大きいほど，スタンプラリーが盛り上がると商店街は考えた．そこで，新しく出す店の場所と用意するスタンプを決めたときの，上記の店の選び方の数の最大値を求めたい．

## 输入格式

標準入力から以下の入力を読み込め．

- $ 1 $ 行目には，$ 1 $ つの整数 $ N $ が書かれている．これは，JOI 商店街には現在 $ N $ 個の店があることを意味 する．
- $ 2 $ 行目には，$ N $ 文字の半角英大文字 `J`，`O`，`I` のみからなる文字列 $ S $ が書かれている．文字列 $ S $ の左から $ i $ 文字目 ($ 1\ \leqq\ i\ \leqq\ N $) は，店 $ i $ が用意したスタンプの種類を表す．

## 输出格式

商品券をもらえるような店の選び方の数の最大値を標準出力に $ 1 $ 行で出力せよ．

商品券をもらえるような店の選び方の数が $ 32 $ ビット符号付き整数の範囲に収まるとは限らないことに注意せよ．

- - - - - -

## 说明/提示

### 課題

JOI 商店街のすでにある店が用意したスタンプの情報が与えられたとき，新しく出す店の場所と用意するスタンプを決めたときの，商品券をもらえるような店の選び方の数の最大値を求めるプログラムを作成せよ．

- - - - - -

### 制限

すべての入力データは以下の条件を満たす．

- $ 3\ \leqq\ N\ \leqq\ 100\,000 $．

### 小課題

#### 小課題 1 \[30 点\]

- $ N\ \leqq\ 200 $ を満たす．

#### 小課題 2 \[20 点\]

- $ N\ \leqq\ 3\,000 $ を満たす．

#### 小課題 3 \[50 点\]

追加の制限はない．

- - - - - -

### Sample Explanation 1

入力例 $ 1 $ では，店 $ 1 $ と店 $ 2 $ の間に，スタンプ `J` を用意する新しい店を出したとき，店が用意したスタンプを入口から順に並べると `JJOIOI` となる． このとき，商品券をもらえるような店の選び方は以下の $ 6 $ 通りである． - $ 1,\ 3,\ 4 $ 番目の店に行く． - $ 1,\ 3,\ 6 $ 番目の店に行く． - $ 1,\ 5,\ 6 $ 番目の店に行く． - $ 2,\ 3,\ 4 $ 番目の店に行く． - $ 2,\ 3,\ 6 $ 番目の店に行く． - $ 2,\ 5,\ 6 $ 番目の店に行く． 入力例 $ 1 $ において，商品券をもらえるような店の選び方が $ 7 $ 通り以上になることはない． - - - - - -

### Sample Explanation 2

\- - - - - -

### Sample Explanation 3

入力例 $ 3 $ では，入口と店 $ 1 $ の間にスタンプ `J` を用意する新しい店を出したとき，商品券をもらえるような店の選び方の数が最大となる．

## 样例 #1

### 输入

```
5
JOIOI
```

### 输出

```
6
```

## 样例 #2

### 输入

```
7
JJJOIII
```

### 输出

```
18
```

## 样例 #3

### 输入

```
4
OIIJ
```

### 输出

```
2
```



---

---
title: "準急電車 (Semiexpress)"
layout: "post"
diff: 提高+/省选-
pid: AT_joi2017ho_b
tag: []
---

# 準急電車 (Semiexpress)

## 题目描述

JOI 铁路公司是 JOI 国唯一的铁路公司。



在某条铁路沿线共有$n$个站点，依次编号为$1,2,\cdots, n$。当前有两种列车服役，分别是高速列车和普通列车。



- 普通列车每站都停，对于每一个$i(1\leq i < N)$，从站点$i$到站点$i+1$用时$A$分钟。



- 高速列车只在站点$S_1,S_2,\cdots,S_M(1=S_1<S_2<\cdots<S_M=N)$停车，对于每一个$i(1\leq i < N)$，从站点$i$到站点$i+1$用时$B$分钟。



JOI 铁路公司拟定开设第三类车次：准高速列车。对于每一个$i(1\leq i < N)$，从站点$i$到站点$i+1$用时$C$分钟。准高速列车停的站点还没有决定好，但是这些站点必须满足以下要求：



- 高速列车停的所有站点准高速列车都必须停。



- 准高速列车必须停恰好$K$个站点。



JOI 铁路公司想要最大化从$1$号站点在$T$分钟内可以到的站点数目（不计$1$号站点，不计等车和换乘时间）。JOI 铁路公司想要合理地安排站点使得这个数目最大。



当合理地安排准高速列车停的站点时，从$1$号站点出发在$T$分钟内抵达的站点（$1$号站点不计）最多是多少？

## 输入格式

第一行三个整数$N,M,K$，意义如题面所示。



第二行三个整数$A,B,C$，意义如题面所示。



第三行一个整数$T$，意义如题面所示。



接下来$M$行，这$M$行中的第$i$行有一个整数$S_i$，表示快车停的站点。

## 输出格式

一行一个整数，表示答案。



### 样例解释 1



在这组数据中，一共有$10$个站点，快车停$1,6,10$三个站点。我们假设准快车停$1,5,6,8,10$五个站点，于是，在$2,3,\cdots,10$中，我们可以从$1$号站点在$30$分钟内抵达除了$9$号站点的所有站点。



对于某些$i$，从$1$号站点到$i$号站点最优的方案如下：



- 从$1$号站点到$3$号站点，只需要乘坐普通列车，时间为$20$分钟。



- 从$1$号站点到$7$号站点，先乘坐高速列车到站点$6$，然后转乘普通列车，时间为$25$分钟。



- 从$1$号站点到$8$号站点，先乘坐高速列车到站点$6$，然后转乘准高速列车，时间为$25$分钟。



- 从$1$号站点到$9$号站点，先乘坐高速列车到站点$6$，然后转乘准高速列车到站点$8$，再换乘普通列车，时间为$35$分钟。

## 说明/提示

所有的数据满足以下条件：



$2\leq N\leq 10^9,2\leq M\leq K\leq 3000,K\leq N$



$1\leq B < C < A \leq 10^9,1\leq T\leq 10^{18}$



$1=S_1<S_2<\cdots<S_M=N$



子任务 $1(\texttt{18 pts})$



$N\leq 3000,K-M=2,A\leq 10^6,T\leq 10^9$



子任务 $2(\texttt{30 pts})$



$N\leq 300$



子任务 $3(\texttt{52 pts})$



无特殊限制。

## 样例 #1

### 输入

```
10 3 5
10 3 5
30
1
6
10
```

### 输出

```
8
```

## 样例 #2

### 输入

```
10 3 5
10 3 5
25
1
6
10
```

### 输出

```
7
```

## 样例 #3

### 输入

```
90 10 12
100000 1000 10000
10000
1
10
20
30
40
50
60
70
80
90
```

### 输出

```
2
```

## 样例 #4

### 输入

```
12 3 4
10 1 2
30
1
11
12
```

### 输出

```
8
```

## 样例 #5

### 输入

```
300 8 16
345678901 123456789 234567890
12345678901
1
10
77
82
137
210
297
300
```

### 输出

```
72
```

## 样例 #6

### 输入

```
1000000000 2 3000
1000000000 1 2
1000000000
1
1000000000
```

### 输出

```
3000
```



---

---
title: "JOIOI 王国 (Kingdom of JOIOI)"
layout: "post"
diff: 提高+/省选-
pid: AT_joi2017ho_c
tag: []
---

# JOIOI 王国 (Kingdom of JOIOI)

## 题目描述

JOIOI 王国是一个 $H$ 行 $W$ 列的长方形网格，每个 $1 \times 1$ 的子网格都是一个正方形的小**区块**。为了提高管理效率，我们决定把整个国家划分成两个省 JOI 和 IOI。

我们定义，两个同省的区块**互相连接**，意为从一个区块出发，不用穿过任何一个不同省的区块，就可以移动到另一个区块。有公共边的区块间可以任意移动。

我们不希望划分得过于复杂，因此划分方案需满足以下条件：

- 区块不能被分割为两半，一半属 JOI 省，一半属 IOI 省。
- 每个省必须包含至少一个区块，每个区块也必须属于且只属于其中一个省。
- 同省的任意两个小区块互相连接。
- 对于每一行/列，如果我们将这一行/列单独取出，这一行/列里同省的任意两个区块互相连接。这一行/列内的所有区块可以全部属于一个省。

现给出所有区块的海拔，第 $i$ 行第 $j$ 列的区块的海拔为 $A_{i,j}$ 。设 JOI 省内各区块海拔的极差（最大值减去最小值）为 $R_{JOI}$，IOI 省内各区块海拔的极差为 $R_{IOI}$ 。在划分后，省内的交流有望更加活跃。但如果两个区块的海拔差太大，两地间的交通会很不方便。 因此，理想的划分方案是 $\max(R_{JOI},R_{IOI})$ 尽可能小。

你的任务是求出 $\max(R_{JOI},R_{IOI})$ 至少为多大。

## 输入格式

第一行，两个整数 $H,W$，用空格分隔。

在接下来的 $H$ 行中，第 $i$ 行有 $W$ 个整数 $A_{i,1},A_{i,2}, \cdots ,A_{i,W}$，用空格分隔。

## 输出格式

一行，一个整数，表示 $\max(R_{JOI},R_{IOI})$ 可能的最小值。

## 说明/提示

对于 $15\%$ 的数据，$H,W \leqslant 10$。

对于另外 $45\%$ 的数据，$H,W \leqslant 200$。

对于所有数据，$2 \leqslant H,W \leqslant 2000,A_{i,j} \leqslant 10^9$（$1 \leqslant i \leqslant H,1 \leqslant j \leqslant W$）。

## 样例 #1

### 输入

```
4 4
1 12 6 11
11 10 2 14
10 1 9 20
4 17 19 10
```

### 输出

```
11
```

## 样例 #2

### 输入

```
8 6
23 23 10 11 16 21
15 26 19 28 19 20
25 26 28 16 15 11
11 8 19 11 15 24
14 19 15 14 24 11
10 8 11 7 6 14
23 5 19 23 17 17
18 11 21 14 20 16
```

### 输出

```
18
```



---

---
title: "ぬいぐるみの整理 (Plush Toys)"
layout: "post"
diff: 提高+/省选-
pid: AT_joi2017yo_d
tag: []
---

# ぬいぐるみの整理 (Plush Toys)

## 题目描述

JOI的一名员工在一家玩具店工作，他被指派整理商店的毛绒玩具。

货架上有 $m$ 种、一共 $n$ 个毛绒玩具排成一行，每个种类的毛绒玩具都至少有一个，种类用 $1\sim m$ 的整数表示。店员的工作是将相同种类的毛绒玩具都排列成连续的一段，具体地说，对于任意两个相同种类的毛绒玩具，它们之间不能有其他种类的毛绒玩具。他将采取如下方法重新新排列玩具：

从 $n$ 个毛绒玩具中拿出若干个，然后按照任意的顺序放回货架的空位上。

为了让相同种类的毛绒玩具排成连续的一段，这名员工最少需要拿出多少个玩具？

## 输入格式

第$1$行，$2$个正整数 $n$,$m$。

接下来 $n$ 行，每行1个正整数 $a_i$，表示货架上从左至右第 $i$ 个毛绒玩具的种类。

## 输出格式

最少需要拿出的毛绒玩具个数。

## 说明/提示

对 $100\%$数据：$1≤n≤10^5$，$1≤m≤20$，$1≤a_i≤m$，保证$1\sim m$都在数列 $a$ 中至少出现一次。

## 样例 #1

### 输入

```
7 2
1
2
2
2
1
2
1
```

### 输出

```
2
```

## 样例 #2

### 输入

```
12 4
1
3
2
4
2
1
2
3
1
1
3
4
```

### 输出

```
7
```



---

---
title: "団子職人 (Dango Maker)"
layout: "post"
diff: 提高+/省选-
pid: AT_joi2018ho_c
tag: []
---

# 団子職人 (Dango Maker)

## 题目描述

你是一个包団子（日本传统食物，不要在意）的工匠。现在你要把団子串起来了。

所有的団子都放在一个正方形中，分为 $N$ 行和 $M$ 列。 每个点上有 $1$ 个団子。 每个団子的颜色为红色（R）、绿色（G）或白色（W）其中一种。你可以从左到右或从上到下连续取出 $3$ 个団子，然后按取出的顺序将 $3$ 个団子粘在 $1$ 个串上。

现在你想串尽可能多的串，但这些串上的団子必须按照 $1$ 个红、$1$ 个绿、$1$ 个白的顺序。另外，一个団子只能放在一个串上。

## 输入格式

第一行为 $N$ 和 $M$，意义如上所述。

第二行到第 $N+1$ 行，每行 $M$ 个字符，代表団子的排列。

## 输出格式

输出一个整数，代表你能串的最多的串数。

## 样例 #1

### 输入

```
3 4
RGWR
GRGG
RGWW
```

### 输出

```
3
```

## 样例 #2

### 输入

```
4 4
RGWR
GRRG
WGGW
WWWR
```

### 输出

```
4
```

## 样例 #3

### 输入

```
5 5
RGRGW
GRRGW
WGGWR
RWRGW
RGWGW
```

### 输出

```
6
```



---

---
title: "たのしいたのしいたのしい家庭菜園 (Growing Vegetables is Fun 3)"
layout: "post"
diff: 提高+/省选-
pid: AT_joi2019ho_c
tag: []
---

# たのしいたのしいたのしい家庭菜園 (Growing Vegetables is Fun 3)

## 题目描述

[problemUrl]: https://atcoder.jp/contests/joi2019ho/tasks/joi2019ho_c

JOI 君は，長年にわたる家庭菜園の経験を生かして，自宅の庭で新たにジョイ草という植物を育てている．庭には東西方向に並んだ $ N $ 個のプランターがあり，西側から順に $ 1 $ から $ N $ までの番号がついている．ジョイ草は全部で $ N $ 株あり，それぞれのプランターに $ 1 $ 株ずつ植えてある．

春になって様子を見に行った JOI 君は，ジョイ草が予想に反して色とりどりの葉を付けていることに気がついた．さらに，ジョイ草が思ったほど生育していないことに気がついた．JOI 君はこれらのことを不思議に思い，本で調べたところ，次のことがわかった：

- ジョイ草には $ 3 $ 種類あり，それぞれ赤，緑，黄の葉を付ける．
- 葉の色が同じジョイ草を近くに置くと，その成長が阻害されてしまう．

そこで，JOI 君は，ジョイ草を並び替えて，葉の色が同じジョイ草が隣り合わないようにすることにした．このとき，JOI 君は隣り合う $ 2 $ つのジョイ草を入れ替えることしかできない．つまり，$ 1 $ 回の操作で JOI 君はプランター $ i $ ($ 1\ \leqq\ i\ \leqq\ N\ -\ 1 $) を任意に $ 1 $ つ選び，プランター $ i $ のジョイ草とプランター $ i\ +\ 1 $ のジョイ草を入れ替えることができる．JOI 君は，できるだけ少ない回数の操作で，葉の色が同じジョイ草が隣り合わないようにしたい．

ジョイ草の数と，それぞれのジョイ草の葉の色が与えられたとき，葉の色が同じジョイ草が隣り合わないように並び替えるために必要な操作回数の最小値を求めるプログラムを作成せよ．

- - - - - -

## 输入格式

入力は以下の形式で標準入力から与えられる．

> $ N $ $ S $

$ S $ は長さ $ N $ の文字列で，その $ i $ 文字目 ($ 1\ \leqq\ i\ \leqq\ N $) は，プランター $ i $ に植えてあるジョイ草の葉の色が赤ならば `R`，緑ならば `G`，黄ならば `Y` である．

## 输出格式

標準出力に，必要な操作回数の最小値を $ 1 $ 行で出力せよ．ただし，葉の色が同じジョイ草が隣り合わないように並び替えることが不可能ならば，代わりに $ -1 $ を出力せよ．

- - - - - -

## 说明/提示

### 制約

- $ 1\ \leqq\ N\ \leqq\ 400 $．
- $ S $ は長さ $ N $ の文字列である．
- $ S $ の各文字は `R`，`G`，`Y` のいずれかである．

### 小課題

1. ($ 5 $ 点) $ N\ \leqq\ 15 $．
2. ($ 55 $ 点) $ N\ \leqq\ 60 $．
3. ($ 15 $ 点) $ S $ の各文字は `R`，`G` のいずれかである．
4. ($ 25 $ 点) 追加の制約はない．

- - - - - -

### Sample Explanation 1

この入力例では，例えば次のようにすると，葉の色が同じジョイ草が隣り合わないようにすることができる． - まず，プランター $ 3 $ のジョイ草とプランター $ 4 $ のジョイ草を入れ替える． - 次に，プランター $ 2 $ のジョイ草とプランター $ 3 $ のジョイ草を入れ替える． このようにすると，ジョイ草の並びは `RYRGY` のようになる．$ 1 $ 回以下の操作で葉の色が同じジョイ草が隣り合わないようにすることはできないので，$ 2 $ を出力する． - - - - - -

### Sample Explanation 2

この入力例では，どのように操作をしても，葉の色が同じジョイ草が隣り合わないようにすることはできない． - - - - - -

## 样例 #1

### 输入

```
5
RRGYY
```

### 输出

```
2
```

## 样例 #2

### 输入

```
6
RRRRRG
```

### 输出

```
-1
```

## 样例 #3

### 输入

```
20
YYGYYYGGGGRGYYGRGRYG
```

### 输出

```
8
```



---

---
title: "コイン集め (Coin Collecting)"
layout: "post"
diff: 提高+/省选-
pid: AT_joi2019ho_d
tag: []
---

# コイン集め (Coin Collecting)

## 题目描述

在 JOI 氏的收藏室中，有一张巨大的桌子，上面放满了珍贵的硬币。为了清理这张桌子，JOI 氏决定要整理这些硬币，把它们排列整齐。

桌面的大小是 $2\,000\,000\,001 \times 2\,000\,000\,001$，形成一个庞大的网格。列从左到右的编号为 $-1\,000\,000\,000$ 到 $1\,000\,000\,000$，行从下到上的编号为 $-1\,000\,000\,000$ 到 $1\,000\,000\,000$。我们用 $(x, y)$ 表示网格中列号为 $x$，行号为 $y$ 的位置。

桌子上一共有 $2N$ 枚硬币，现在第 $i$ 枚硬币 ($1 \leq i \leq 2N$) 位于位置 $(X_i, Y_i)$。JOI 氏的目标是将这些硬币放到网格左上角的一个小方块中，每个格子恰好放一个。这个小方块由 $(x, y)$ 表示，其中 $1 \leq x \leq N$ 且 $1 \leq y \leq 2$。

为了避免损坏硬币，仅能进行以下操作：选择一枚硬币，并将它移动到与其当前所在位置相邻的另一个格子（即共享一条边的格子）。移动过程中，可以暂时将多个硬币堆叠在一起。JOI 氏希望用尽量少的操作次数实现目标。

现在，给出硬币的数量和它们的初始位置，请编写一个程序，计算用最少多少次操作可以将硬币移到目标位置。

## 输入格式

从标准输入中读取数据，格式如下：

> $N$ $X_1$ $Y_1$ $\vdots$ $X_{2N}$ $Y_{2N}$

## 输出格式

输出一行，表示达成目标位置所需的最小操作次数。

## 说明/提示

- 条件限制：
  - $1 \leq N \leq 100\,000$。
  - $-1\,000\,000\,000 \leq X_i \leq 1\,000\,000\,000$ ($1 \leq i \leq 2N$)。
  - $-1\,000\,000\,000 \leq Y_i \leq 1\,000\,000\,000$ ($1 \leq i \leq 2N$)。

- 子任务：
  1. （8 分）$N \leq 10$。
  2. （29 分）$N \leq 1\,000$。
  3. （63 分）没有其他额外的约束条件。

### 示例说明 1
在这个例子中，6 枚硬币的初始位置如下图所示：![2019-ho-t4-fig01.png](https://img.atcoder.jp/joi2019ho/2019-ho-t4-fig01.png)

我们的目标是将硬币移到粗框标记的区域。例如，通过以下路径移动硬币，可以在 15 次操作后实现目标：
- 第 1 枚硬币：$(0, 0) \rightarrow (1, 0) \rightarrow (1, 1) \rightarrow (1, 2)$
- 第 2 枚硬币：$(0, 4) \rightarrow (1, 4) \rightarrow (1, 3) \rightarrow (2, 3) \rightarrow (3, 3) \rightarrow (3, 2)$
- 第 3 枚硬币：$(4, 0) \rightarrow (4, 1) \rightarrow (3, 1)$
- 第 5 枚硬币：$(2, 5) \rightarrow (2, 4) \rightarrow (2, 3) \rightarrow (2, 2)$
- 第 6 枚硬币：$(-1, 1) \rightarrow (0, 1) \rightarrow (1, 1)$

无法在 14 次或更少的操作内达成目标，因此输出为 15。

### 示例说明 2
注意，移动过程中可能会有多个硬币暂时放在同一个格子中。

 **本翻译由 AI 自动生成**

## 样例 #1

### 输入

```
3
0 0
0 4
4 0
2 1
2 5
-1 1
```

### 输出

```
15
```

## 样例 #2

### 输入

```
4
2 1
2 1
2 1
3 1
3 1
3 1
3 1
3 1
```

### 输出

```
9
```

## 样例 #3

### 输入

```
5
1000000000 1000000000
-1000000000 1000000000
-1000000000 -1000000000
1000000000 -1000000000
-1 -5
-2 2
2 8
4 7
-2 5
7 3
```

### 输出

```
8000000029
```



---

---
title: "スタンプラリー 3 (Collecting Stamps 3)"
layout: "post"
diff: 提高+/省选-
pid: AT_joi2020ho_c
tag: []
---

# スタンプラリー 3 (Collecting Stamps 3)

## 题目描述

JOI 君生活的 IOI 国有一个著名的湖泊，今天一场集邮大会在湖边举行。

绕湖一圈总共有 $N$ 种邮票可以收集，编号分别为 $1...N$ ，收集点绕湖顺时针排列。湖的周长为 $L$，第 $i$ 张邮票 $(1\le i\le N)$ 的收集点在距离出发点顺时针走 $X_i$ 米的位置。

参赛者在比赛开始的时候要站在出发点的位置，当大会开始时，参赛者可以绕湖顺时针或者逆时针移动，参赛者能够得到第 $i$ 张邮票 $(1\le i\le N)$ 当且仅当他到达收集点的时间在比赛开始时的 $T_i$ 秒以内（含）。

JOI 君也是集邮大会的参与者。他的移动速度是每秒钟 $1$ 米，你可以认为只有移动才会消耗时间。

请你计算他最多能收集到多少种邮票。

## 输入格式

第一行两个正整数 $N,L$，表示邮票种类和湖泊周长。

接下来一行 $N$ 个数，分别为 $X_1,X_2,...,X_N$，表示各种类邮票的收集位置。

接下来一行 $N$ 个数，分别为 $T_1,T_2,...,T_N$，表示各种类邮票的最晚可收集时间。

## 输出格式

输出一行一个整数，表示最多能收集到多少种种类的邮票。

**样例 $1$ 解释**

JOI 君可以通过下述策略收集到 $4$ 种邮票：

1. 逆时针走 $2$ 米，此时只过了 $2$ 秒，可以收集到第 $6$ 种邮票。
2. 逆时针走 $2$ 米，此时只过了 $4$ 秒，可以收集到第 $5$ 种邮票。
3. 顺时针走 $7$ 米，此时只过了 $11$ 秒，可以收集到第 $1$ 种邮票。
4. 顺时针走 $1$ 米，此时已经过了 $12$ 秒，无法收集到第 $2$ 种邮票。
5. 顺时针走 $3$ 米，此时只过了 $15$ 秒，可以收集到第 $3$ 种邮票。

JOI 君没有办法收集到 $5$ 种或更多邮票，所以答案是 $4$ 。

## 说明/提示

对于 $100\%$ 的数据，保证 $1\le N\le200,2\le L\le10^9,1\le X_i<L,X_i<X_{i+1},0\le T_i\le10^9$ 。

|子任务编号|分值|特殊限制|
|:-:|:-:|:-:|
|$1$|$5$|$N\le12,L\le200,T_i\le200$|
|$2$|$10$|$N\le15$|
|$3$|$10$|$L\le200,T_i\le200$|
|$4$|$75$|无|

## 样例 #1

### 输入

```
6 25
3 4 7 17 21 23
11 7 17 10 8 10
```

### 输出

```
4
```

## 样例 #2

### 输入

```
5 20
4 5 8 13 17
18 23 15 7 10
```

### 输出

```
5
```

## 样例 #3

### 输入

```
4 19
3 7 12 14
2 0 5 4
```

### 输出

```
0
```

## 样例 #4

### 输入

```
10 87
9 23 33 38 42 44 45 62 67 78
15 91 7 27 31 53 12 91 89 46
```

### 输出

```
5
```



---

---
title: "オリンピックバス (Olympic Bus)"
layout: "post"
diff: 提高+/省选-
pid: AT_joi2020ho_d
tag: []
---

# オリンピックバス (Olympic Bus)

## 题目描述

[problemUrl]: https://atcoder.jp/contests/joi2020ho/tasks/joi2020ho_d

JOI 国には $ N $ 個の都市があり，$ 1 $ から $ N $ までの番号が付いている．また，都市と都市を一方向に結ぶ $ M $ 本のバス路線があり，$ 1 $ から $ M $ までの番号が付いている．バス路線 $ i $ ($ 1\ \leqq\ i\ \leqq\ M $) は都市 $ U_i $ から都市 $ V_i $ へ向けて運行されており，運賃は $ C_i $ 円である．バス路線 $ i $ ($ 1\ \leqq\ i\ \leqq\ M $) では，都市 $ U_i $ 以外で乗ったり，都市 $ V_i $ 以外で降りることはできない．ある都市からある都市へ向けて運行されるバス路線が複数存在するかもしれない．

JOI 国では間もなくオリンピックが開催される．JOI 国の運輸大臣である $ K $ 理事長は，バス路線を高々 $ 1 $ つ選び，オリンピック期間中，運賃を変更せずにそのバス路線の運行方向を反転させることにした．つまり，バス路線 $ i $ ($ 1\ \leqq\ i\ \leqq\ M $) を選んだ場合，オリンピック期間中，そのバス路線は都市 $ U_i $ から都市 $ V_i $ へ向けて運行されるのではなく，都市 $ V_i $ から都市 $ U_i $ へ向けて運行されるようになる．ただし，バス路線 $ i $ の運行方向の反転には $ D_i $ 円かかり，これは K 理事長のポケットマネーにより賄われる．また，混乱を避けるため，オリンピック期間の途中でバス路線を反転させることはできない．

運輸大臣である K 理事長は，オリンピック期間中，都市 $ 1 $ と都市 $ N $ の間をバス路線を乗り継いで往復する予定である．運行方向を反転させるバス路線をうまく選ぶことで，往復の合計運賃と運行方向の反転の費用との和を最小化したい．

都市の個数と，バス路線の情報が与えられたとき，運行方向を反転させるバス路線をうまく選ぶことで，都市 $ 1 $ と都市 $ N $ の間の往復の合計運賃と，運行方向の反転の費用との和の最小値を求めるプログラムを作成せよ．ただし，どのようにバス路線を選んでも都市 $ 1 $ と都市 $ N $ の間を往復することができない場合は，代わりに $ −1 $ を出力せよ．

- - - - - -

## 输入格式

入力は以下の形式で標準入力から与えられる．入力される値はすべて整数である．

> $ N $ $ M $ $ U_1 $ $ V_1 $ $ C_1 $ $ D_1 $ $ \vdots $ $ U_M $ $ V_M $ $ C_M $ $ D_M $

## 输出格式

都市 $ 1 $ と都市 $ N $ の間の往復の合計運賃と，運行方向の反転の費用との和の最小値を，標準出力に $ 1 $ 行で出力せよ．ただし，どのようにバス路線を選んでも都市 $ 1 $ と都市 $ N $ の間を往復することができない場合は，代わりに $ −1 $ を出力せよ．

- - - - - -

## 说明/提示

### 制約

- $ 2\ \leqq\ N\ \leqq\ 200 $．
- $ 1\ \leqq\ M\ \leqq\ 50\,000 $．
- $ 1\ \leqq\ U_i\ \leqq\ N $ ($ 1\ \leqq\ i\ \leqq\ M $)．
- $ 1\ \leqq\ V_i\ \leqq\ N $ ($ 1\ \leqq\ i\ \leqq\ M $)．
- $ U_i\ \neq\ V_i $ ($ 1\ \leqq\ i\ \leqq\ M $)．
- $ 0\ \leqq\ C_i\ \leqq\ 1\,000\,000 $ ($ 1\ \leqq\ i\ \leqq\ M $)．
- $ 0\ \leqq\ D_i\ \leqq\ 1\,000\,000\,000 $ ($ 1\ \leqq\ i\ \leqq\ M $)．

### 小課題

1. ($ 5 $ 点) $ M\ \leqq\ 1\,000 $．
2. ($ 11 $ 点) $ M $ は偶数，$ U_{2i\ −\ 1}\ =\ U_{2i} $，$ V_{2i\ −\ 1}\ =\ V_{2i} $，$ C_{2i\ −\ 1}\ =\ C_{2i} $ ($ 1\ \leqq\ i\ \leqq\ \frac{M}{2} $)．
3. ($ 21 $ 点) $ C_i\ =\ 0 $ ($ 1\ \leqq\ i\ \leqq\ M $)．
4. ($ 63 $ 点) 追加の制約はない．

- - - - - -

### Sample Explanation 1

バス路線 $ 2 $ の運行方向を費用 $ 1 $ で反転させると，都市 $ 1 $ から都市 $ 4 $ への移動にかかる運賃は最小で $ 6 $，都市 $ 4 $ から都市 $ 1 $ への移動にかかる運賃は最小で $ 3 $ となり，都市 $ 1 $ と都市 $ 4 $ の間の往復の合計運賃と，運行方向の反転の費用との和は $ 10 $ となる． 都市 $ 1 $ と都市 $ 4 $ の間の往復の合計運賃と，運行方向の反転の費用との和を $ 10 $ より小さくすることはできないので，$ 10 $ を出力する． - - - - - -

### Sample Explanation 2

この入出力例は小課題 $ 2 $ の制約を満たす． - - - - - -

### Sample Explanation 3

この入出力例は小課題 $ 3 $ の制約を満たす． - - - - - -

### Sample Explanation 4

バス路線の運行方向を反転させなくてもよい． - - - - - -

### Sample Explanation 5

この入力例では，都市 $ 4 $ から都市 $ 3 $ へと運行されるバス路線が $ 2 $ 本存在する．

## 样例 #1

### 输入

```
4 5
1 2 4 4
1 3 2 1
4 3 1 2
4 1 6 1
2 4 2 5
```

### 输出

```
10
```

## 样例 #2

### 输入

```
4 10
1 2 4 4
1 2 4 4
1 3 2 1
1 3 2 1
4 3 1 2
4 3 1 2
4 1 6 1
4 1 6 1
2 4 2 5
2 4 2 5
```

### 输出

```
10
```

## 样例 #3

### 输入

```
4 4
1 2 0 4
1 3 0 1
4 3 0 2
4 1 0 1
```

### 输出

```
2
```

## 样例 #4

### 输入

```
4 5
1 2 4 4
1 3 2 4
4 3 1 5
4 1 6 1
2 4 2 5
```

### 输出

```
12
```

## 样例 #5

### 输入

```
4 5
2 1 4 4
1 3 2 1
4 3 1 2
4 3 6 1
2 4 2 5
```

### 输出

```
-1
```



---

---
title: "雪玉 (Snowball)"
layout: "post"
diff: 提高+/省选-
pid: AT_joi2021ho_b
tag: []
---

# 雪玉 (Snowball)

## 题目描述

# [JOI 2021 Final] 雪玉


在一条无限长的数轴上，有 $N$ 个雪球，这 $N$ 个雪球编号为 $1 \sim N$，第 $i$ 个雪球在第 $A_i$ 个点上。刚开始，整条数轴覆盖满了雪，接下来 $Q$ 天将会刮起大风，第 $j$ 天的风力强度为 $W_j$，如果 $W_j$ 为正数，所有雪球都朝右移动 $W_j$ 个单位长度，如果 $W_j$ 为负数，所有雪球都朝左移动 $-W_j$ 个单位长度。

当一个区间 $[a,a+1]$ 被雪覆盖时，雪球滚上去雪球的质量会加一，这一个区间里的雪也会被清空。刚开始每一个雪球的质量均为 $0$，而这 $Q$ 天里也没有再下雪。

你想问这 $Q$ 天结束后每个雪球的质量是怎样的。

## 输入格式

第一行两个整数 $N,Q$ 代表雪球个数和下雪天数。

第二行 $N$ 个整数 $A_i$ 代表这 $N$ 个雪球的初始位置。

接下来 $Q$ 行每行一个整数 $W_j$ 代表每一天的风力强度。

## 输出格式

$N$ 行每行一个整数代表这 $Q$ 天结束后每一个雪球的质量。

## 样例 #1

### 样例输入 #1

```
4 3
-2 3 5 8
2
-4
7
```

### 样例输出 #1

```
5
4
2
6
```

## 样例 #2

### 样例输入 #2

```
1 4
1000000000000
1000000000000
-1000000000000
-1000000000000
-1000000000000
```

### 样例输出 #2

```
3000000000000
```

## 样例 #3

### 样例输入 #3

```
10 10
-56 -43 -39 -31 -22 -5 0 12 18 22
-3
0
5
-4
-2
10
-13
-1
9
6
```

### 样例输出 #3

```
14
8
7
9
11
10
9
8
5
10
```

## 说明/提示

#### 样例 1 解释

雪球初始位置为 $-2,3,5,8$，初始质量为 $0,0,0,0$。

- 第一天过后，雪球位置为 $0,5,7,10$，质量为 $2,2,2,2$。
- 第二天过后，雪球位置为 $-4,1,3,6$，质量为 $4,4,2,3$。
- 第三天过后，雪球位置为 $3,8,10,13$，质量为 $5,4,2,6$。

#### 数据规模与约定

**本题采用捆绑测试。**

- Subtask 1（33 pts）：$N,Q \le 2000$。
- Subtask 2（67 pts）：无特殊限制。

对于 $100\%$ 的数据，$1 \le N,Q \le 2 \times 10^5$，$|A_i|,|W_j| \le 10^{12}$，$A_i<A_{i+1}$。


翻译自 [The 20th Japanese Olympiad in Informatics Final Round B 雪玉的英文翻译 Snowball](https://www.ioi-jp.org/joi/2020/2021-ho/2021-ho-t2-en.pdf)。

## 样例 #1

### 输入

```
4 3
-2 3 5 8
2
-4
7
```

### 输出

```
5
4
2
6
```

## 样例 #2

### 输入

```
1 4
1000000000000
1000000000000
-1000000000000
-1000000000000
-1000000000000
```

### 输出

```
3000000000000
```

## 样例 #3

### 输入

```
10 10
-56 -43 -39 -31 -22 -5 0 12 18 22
-3
0
5
-4
-2
10
-13
-1
9
6
```

### 输出

```
14
8
7
9
11
10
9
8
5
10
```



---

---
title: "安全点検 (Safety Inspection)"
layout: "post"
diff: 提高+/省选-
pid: AT_joi2021_yo2_d
tag: []
---

# 安全点検 (Safety Inspection)

## 题目描述

在 JOI 市有一条恒长不变的道路，它可以被看作是一条数轴。数轴上的每一个点都用一个实数坐标来表示。沿这条路分布着 $N$ 个设施，这些设施按坐标从小到大依次标记为 $1$ 到 $N$。设施 $i$ 位于坐标 $A_i$。

JOI 市计划对这些设施进行安全检查。对每个设施 $i$，需要进行 $B_i$ 个独立的检查项目。目前有 $K$ 名工人参与这次检查。在开始检查时，所有工人都位于坐标 $0$。进行检查时，工人每分钟可以选择以下两种操作之一：

- 向任意方向移动 $1$ 个单位距离。
- 在当前坐标对一个检查项目进行检查。

要完成这次检查任务，所有设施的每个检查项目都必须至少由一名工人检查。

根据给定的工人数和设施的信息，请编写程序计算完成所有安全检查所需的最短时间（分钟）。

## 输入格式

输入以如下格式提供：
> $N$ $K$ $A_1$ $A_2$ $\cdots$ $A_N$ $B_1$ $B_2$ $\cdots$ $B_N$

## 输出格式

输出一个整数，表示完成所有安全检查所需的最短时间（分钟）。

## 说明/提示

- $1 \leq N \leq 100\,000$：设施数目。
- $1 \leq K \leq 10^{9}$：工人数。
- $1 \leq A_i \leq 10^{9}$：设施 $i$ 的坐标。
- $A_i < A_{i+1}$ ($1 \leq i \leq N-1$)：设施坐标递增。
- $1 \leq B_i \leq 10^{9}$：每个设施需要检查的项目数。

### 子任务
1. ($3$ 分) $K = 1$。
2. ($15$ 分) $K = 2$。
3. ($82$ 分) 没有额外限制。

### 样例解释

例如，可以通过以下步骤在 $7$ 分钟内完成检查。三名工人分别编号为工人 $1, 2, 3$：
1. 工人 $1, 2, 3$ 移动到坐标 $1$。
2. 工人 $1, 2, 3$ 各自完成设施 $1$ 的一个检查项目。
3. 工人 $1, 2$ 移动到坐标 $2$，工人 $3$ 继续检查设施 $1$ 的一个项目。
4. 工人 $1, 2$ 移动到坐标 $3$，工人 $3$ 移动到坐标 $2$。
5. 工人 $1, 2$ 移动到坐标 $4$，工人 $3$ 移动到坐标 $3$。
6. 工人 $1, 2$ 各自完成设施 $3$ 的一个检查项目，工人 $3$ 完成设施 $2$ 的一个检查项目。
7. 工人 $1, 2$ 各自再完成设施 $3$ 的一个检查项目，工人 $3$ 再完成设施 $2$ 的一个检查项目。

任何情况下都无法在 $7$ 分钟内完成检查，因此输出 $7$。

 **本翻译由 AI 自动生成**

## 样例 #1

### 输入

```
3 3

1 3 4

4 2 4
```

### 输出

```
7
```

## 样例 #2

### 输入

```
6 1

1 4 5 6 11 15

12 5 9 8 10 4
```

### 输出

```
63
```

## 样例 #3

### 输入

```
6 2

1 4 5 6 11 15

12 5 9 8 10 4
```

### 输出

```
35
```

## 样例 #4

### 输入

```
6 5

1 4 5 6 11 15

12 5 9 8 10 4
```

### 输出

```
19
```



---

---
title: "選挙で勝とう (Let&#39;s Win the Election)"
layout: "post"
diff: 提高+/省选-
pid: AT_joi2022ho_c
tag: []
---

# 選挙で勝とう (Let&#39;s Win the Election)

## 题目描述

[problemUrl]: https://atcoder.jp/contests/joi2022ho/tasks/joi2022ho_c

JOI 国は $ N $ 個の州からなり，それぞれ $ 1 $ から $ N $ までの番号が付けられている．$ 2022 $ 年，JOI 国では大統領選挙が開催されることになった．この選挙では各州で投票が行われ，勝った候補者がその州に割り当てられている $ 1 $ 票を獲得する．

さて，大統領選挙に出馬する理恵さんは，演説によって自身への信頼度を上げ，選挙で勝とうと考えた．演説により，具体的には次のことが起こる．

- 州 $ i $ ($ 1\ \leqq\ i\ \leqq\ N $) での合計演説時間が $ A_i $ 時間に達すると，その州に割り当てられている $ 1 $ 票を獲得できる．
- 州 $ i $ ($ 1\ \leqq\ i\ \leqq\ N $) での合計演説時間が $ B_i $ 時間に達すると，協力者 $ 1 $ 人を得ることができる．得られた協力者は，それ以降演説を行い，合計演説時間を増やすことができる．
- ただし，州 $ i $ からの協力者を得られない場合もあり，その場合は $ B_i\ =\ -1 $ として情報が与えられる．それ以外の場合は，$ B_i\ \geqq\ A_i $ であることが保証される．

なお，州 $ i $ ($ 1\ \leqq\ i\ \leqq\ N $) で獲得した協力者が州 $ i $ 以外で演説をすることや，$ 1 $ つの州で同時に $ 2 $ 人以上が演説をすることも可能である．たとえば，ある州で同時に $ 2 $ 人が $ x $ 時間演説をした場合，この州の合計演説時間は $ 2x $ 時間増加する．ただし，演説時間が整数である必要はない．また，州の間を移動する時間は無視できるものとする．

投票日が近いので，理恵さんは目標の $ K $ 票をできるだけ早く獲得したい．

州の数と各州の情報が与えられたとき，$ K $ 票を集めるまでにかかる時間の最小値を求めるプログラムを作成せよ．

- - - - - -

## 输入格式

入力は以下の形式で標準入力から与えられる．入力される値はすべて整数である．

> $ N $ $ K $ $ A_1 $ $ B_1 $ $ A_2 $ $ B_2 $ $ \vdots $ $ A_N $ $ B_N $

## 输出格式

標準出力に，$ K $ 票を集めるまでにかかる時間の最小値を $ 1 $ 行で出力せよ．正解との絶対誤差が $ 0.01 $ 以下であるような答えを出力すれば，正答とみなされる．出力は以下のいずれかの形式でなければならない．

- 整数．（例：`123`，`0`，`-2022`）
- 整数，半角ピリオド，$ 0 $ から $ 9 $ までの数字を並べた列，をその順にスペースなどで区切らず続けた形式．出力する小数点以下の桁数に制限はない．（例：`123.4`，`-123.00`，`0.00288`）

たとえば，`1.23456e+05` や `1.23456e5` のような指数表記で出力してはならない．

- - - - - -

## 说明/提示

### 制約

- $ 1\ \leqq\ N\ \leqq\ 500 $．
- $ 1\ \leqq\ K\ \leqq\ N $．
- $ 1\ \leqq\ A_i\ \leqq\ 1\,000 $ ($ 1\ \leqq\ i\ \leqq\ N $)．
- $ A_i\ \leqq\ B_i\ \leqq\ 1\,000 $ または $ B_i\ =\ -1 $ ($ 1\ \leqq\ i\ \leqq\ N $)．

### 小課題

1. ($ 5 $ 点) $ B_i\ =\ -1 $ ($ 1\ \leqq\ i\ \leqq\ N $)．
2. ($ 5 $ 点) $ B_i\ =\ -1 $ または $ B_i\ =\ A_i $ ($ 1\ \leqq\ i\ \leqq\ N $)．
3. ($ 11 $ 点) $ N\ \leqq\ 7 $．
4. ($ 12 $ 点) $ N\ \leqq\ 20 $．
5. ($ 33 $ 点) $ N\ \leqq\ 100 $．
6. ($ 11 $ 点) $ K\ =\ N $．
7. ($ 23 $ 点) 追加の制約はない．

- - - - - -

### Sample Explanation 1

以下のような順序で選挙活動を行うと，$ 5.5 $ 時間ですべての州の票を獲得することができる． 1. 理恵さんが州 $ 2 $ で $ 2 $ 時間演説を行い，その州の票を得る． 2. 理恵さんが州 $ 2 $ でさらに $ 1 $ 時間演説を行い，その州の協力者を得る． 3. 理恵さんと協力者 $ 1 $ 人が州 $ 3 $ で $ 2 $ 時間演説を行い，その州の票を得る． 4. 理恵さんと協力者 $ 1 $ 人が州 $ 1 $ で $ 0.5 $ 時間演説を行い，その州の票を得る． この入力例は小課題 $ 3,\ 4,\ 5,\ 6,\ 7 $ の制約を満たす． - - - - - -

### Sample Explanation 2

以下のような順序で選挙活動を行うと，$ 32 $ 時間で $ 4 $ 票を獲得することができる． 1. 理恵さんが州 $ 1 $ で $ 4 $ 時間演説を行い，その州の票を得る． 2. 理恵さんが州 $ 2 $ で $ 11 $ 時間演説を行い，その州の票を得る． 3. 理恵さんが州 $ 3 $ で $ 6 $ 時間演説を行い，その州の票を得る． 4. 理恵さんが州 $ 6 $ で $ 11 $ 時間演説を行い，その州の票を得る． この入力例は小課題 $ 1,\ 2,\ 3,\ 4,\ 5,\ 7 $ の制約を満たす． - - - - - -

### Sample Explanation 3

以下のような順序で選挙活動を行うと，$ 11.5 $ 時間で $ 3 $ 票を獲得することができる． 1. 理恵さんが州 $ 4 $ で $ 7 $ 時間演説を行い，その州の票と協力者を得る． 2. 理恵さんが州 $ 1 $ で $ 4 $ 時間演説を行い，その州の票を得る．同時に，協力者 $ 1 $ 人が州 $ 2 $ で $ 4 $ 時間演説を行う． 3. 理恵さんと協力者 $ 1 $ 人が州 $ 2 $ で $ 0.5 $ 時間演説を行い，その州の票を得る． この入力例は小課題 $ 2,\ 3,\ 4,\ 5,\ 7 $ の制約を満たす． - - - - - -

### Sample Explanation 4

この入力例は小課題 $ 3,\ 4,\ 5,\ 7 $ の制約を満たす． - - - - - -

### Sample Explanation 5

この入力例は小課題 $ 4,\ 5,\ 7 $ の制約を満たす．

## 样例 #1

### 输入

```
3
3
1 5
2 3
4 5
```

### 输出

```
5.500000000000000
```

## 样例 #2

### 输入

```
7
4
4 -1
11 -1
6 -1
12 -1
36 -1
11 -1
20 -1
```

### 输出

```
32.000000000000000
```

## 样例 #3

### 输入

```
5
3
4 -1
5 -1
6 -1
7 7
8 8
```

### 输出

```
11.500000000000000
```

## 样例 #4

### 输入

```
7
5
28 36
11 57
20 35
19 27
31 33
25 56
38 51
```

### 输出

```
62.166666666666664
```

## 样例 #5

### 输入

```
20
14
106 277
175 217
170 227
164 245
118 254
139 261
142 270
185 200
162 241
153 239
128 264
103 299
147 248
158 236
160 232
183 205
194 197
135 260
153 234
128 260
```

### 输出

```
644.203571428571422
```



---

---
title: "タクシー 2 (Taxis 2)"
layout: "post"
diff: 提高+/省选-
pid: AT_joig2022_f
tag: []
---

# タクシー 2 (Taxis 2)

## 题目描述

### 题目要求

IOI 国家有 $N$ 个城市，编号从 $1$ 到 $N$；$M$ 条道路，编号从 $1$ 到 $M$ 。

想通过每条道路，都只能乘坐出租车。第 $i$（$1 \le i \le M$ ）条道路连接第 $A_i$ 个城市和第 $B_i$ 个城市，$C_i=1$ 表示出租车是红色的，$C_i=2$ 表示出租车是蓝色的。当然，出租车是收费的，收费如下：

- 设 $a$ 为上出租车前所持有的钱数，$b$ 为下车后你的钱数。
- 如果出租车是红色的，那么 $b=a - 1$ 。
- 如果出租车是蓝色的，那么 $b=\lfloor \frac{a+0.5}{2}\rfloor$。

你住在 IOI 国家的 $1$ 号城市。现在，你有 $Q$ 个朋友，第 $i$ 个朋友住在编号为 $t_i$ 的城市。现在你想知道，如果你想到达第 $i$ 个朋友家且到达后身上至少有 $1$ 元钱，那么你至少要带多少元钱？特别的，当这个钱数大于 $L$ 元时，输出 `Large`。

## 输入格式

共 $M+Q+1$ 行。

第一行，四个正整数分别为 $N,M,Q,L$。

接下来的 $M$ 行，每行三个正整数 $A_i,B_i,C_i$。

接下来的 $Q$ 行，每行一个正整数 $t_i$。

## 输出格式

共 $Q$ 行，每行一个正整数，表示每个询问的答案。

## 说明/提示

**本题有捆绑测试。**

对于 $100\%$ 的数据：

- $2 \le N \le 2\times10^5$，
- $N - 1 \le M \le 2\times10^5$，
- $1 \le Q \le 2\times10^5$，
- $1 \le L \le 10^9$，
- $\forall i \in[1,M],1 \le A_i \lt B_i \le N,C_i\in\{1,2\}$，
- $\forall i\neq j ,(A_i,B_i) \neq (A_j,B_j)$，
- $\forall i \in[2,Q],2 \le T_j \le N$，
- 在任意两个城市之间，你可以通过多条路径来回穿梭，
- 所有输入值均为整数。

#### 部分分

| 子任务编号 | $N\le$ | $M\le$ | $Q\le$ | 特殊性质 | 分数 |
| :----------: | :----------: | :----------: | :----------: | :----------: | :----------: | 
| 1 | $100$ | $N-1$ | $1$ | $\textbf{A},\textbf{C}$ | $9$ |
| 2 | $2\times10^5$ | $N-1$ | $1$ | $\textbf{A}$ | $19$ |
| 3 | $2\times10^5$ | $N-1$ | $2\times10^5$ | $\textbf{A}$ | $19$ |
| 4 | $5\times10^4$ | $5\times10^4$ | $1$ | $\textbf{B}$ | $16$ |
| 5 | $5\times10^4$ | $5\times10^4$ | $1$ | 无 | $20$ |
| 6 | $5\times10^4$ | $5\times10^4$ | $5\times10^4$ | 无 | $12$ |
| 7 | $2\times10^5$ | $2\times10^5$ | $2\times10^5$ | 无 | $5$ |

特殊性质 $\textbf{A}$：$\forall i \in[1,M],(A_i,B_i)=(i,i+1)$。

特殊性质 $\textbf{B}$：$\forall i \in[1,M],C_i=1$。

特殊性质 $\textbf{C}$：$L\le100$。

由 [OIer_Tan](\user\700210) 翻译。

## 样例 #1

### 输入

```
7 6 1 10

1 2 2

2 3 1

3 4 2

4 5 1

5 6 1

6 7 2

5
```

### 输出

```
10
```

## 样例 #2

### 输入

```
10 9 3 25

1 2 2

2 3 1

3 4 1

4 5 1

5 6 2

6 7 1

7 8 1

8 9 1

9 10 2

10

9

3
```

### 输出

```
Large

22

4
```

## 样例 #3

### 输入

```
5 6 1 1000000000

1 4 1

1 5 1

4 5 1

3 4 1

3 5 1

2 3 1

2
```

### 输出

```
4
```

## 样例 #4

### 输入

```
9 11 5 10

1 2 1

1 3 2

2 3 2

2 9 2

3 9 1

4 9 1

8 9 1

5 8 1

5 7 1

4 7 2

6 7 2

2

6

7

8

9
```

### 输出

```
2

Large

7

5

3
```



---

---
title: "チーム戦 (Team Contest)"
layout: "post"
diff: 提高+/省选-
pid: AT_joigsc2022_c
tag: []
---

# チーム戦 (Team Contest)

## 题目描述

# [JOISC 2022 Day2] 团队竞技

## 题目背景

JOISC 2022 D2T3


JOI 大学有 $N$ 只海狸，他们都参与竞技编程。每只海狸有三项能力值：思考值，行动值和运气值。如果一个能力值很大，意味着他这项能力比较强大。对于第 $i~(i\in[1,N])$ 只海狸，他的思考值为 $X_i$，行动值为 $Y_i$，运气值为 $Z_i$。

今年 JOI 大学的海狸们将参与一场团体竞技编程，一支队伍由三名队员组成。Bitaro 是 JOI 大学的教练，由于团队合作很重要，Bitaro 决定从 $N$ 只海狸中选出三只海狸组成队伍，这三只海狸要满足以下条件：

**条件**：每个成员都有自己的优势，这意味着每个成员都有一项能力值严格大于其他两人的对应能力值。

在所有符合条件的组队中，Bitaro 想要选一个总能力最强的队伍，一个队伍的总能力定义为：三人最大思考值，三人最大行动值和三人最大运气值之和。

请你求出，是否存在一个符合条件的组队，如果是，计算队伍总能力可能的最大值。

## 输入格式

第一行一个整数 $N$ 表示海狸数。

接下来 $N$ 行每行三个整数 $X_i,Y_i,Z_i$ 表示海狸的各项能力值。

## 输出格式

一行一个整数，如果不存在符合条件的组队，输出 `-1`，否则输出队伍总能力的最大值。

## 样例 #1

### 样例输入 #1

```
5
3 1 4
2 3 1
1 5 5
4 4 2
5 2 3
```

### 样例输出 #1

```
13
```

## 样例 #2

### 样例输入 #2

```
8
1 1 1
1 1 5
1 5 1
5 1 1
1 5 5
5 1 5
5 5 1
5 5 5
```

### 样例输出 #2

```
15
```

## 样例 #3

### 样例输入 #3

```
4
1 2 3
1 2 3
1 2 3
1 2 3
```

### 样例输出 #3

```
-1
```

## 说明/提示

**【样例解释 #1】**

由海狸 $1,4,5$ 组成的队伍符合条件，因为：

1. 海狸 $1$ 的优势是运气。
2. 海狸 $4$ 的优势是行动。
3. 海狸 $5$ 的优势是思考。

总能力值为：$5+4+4=13$。

可以证明这是符合条件的组队中，总能力值最高的队伍。

注意如果选择海狸 $1,3,5$，总能力值将达到 $15$，但是这会导致海狸 $1$ 没有特长。

这组样例满足所有子任务的限制。

**【样例解释 #2】**

最优组队为：海狸 $2,3,4$。

这组样例满足所有子任务的限制。

**【样例解释 #3】**

任何组队方式都会导致队员没有特长，不存在符合条件的组队。

这组样例满足所有子任务的限制。


对于所有数据，满足：

- $3\leq N\leq 150000$。
- $1\leq X_i,Y_i,Z_i\leq 10^8$ $(1\leq i\leq N)$。

详细子任务附加限制及分值如下表所示：

|子任务编号|附加限制|分值|
|:-:|:-:|:-:|
|$1$|$N\leq 300$|$8$|
|$2$|$N\leq 4000$|$29$|
|$3$|$X_i,Y_i,Z_i\leq 5$ $(i\in[1,N])$|$9$|
|$4$|$X_i,Y_i,Z_i\leq 20$ $(i\in[1,N])$|$9$|
|$5$|$X_i,Y_i,Z_i\leq 300$ $(i\in[1,N])$|$9$|
|$6$|$X_i,Y_i,Z_i\leq 4000$ $(i\in[1,N])$|$9$|
|$7$|无附加限制|$27$|



---

---
title: "コアラ (Koala)"
layout: "post"
diff: 提高+/省选-
pid: AT_joisc2013_koala
tag: []
---

# コアラ (Koala)

## 题目描述

有一条数轴，你需要从点 $K$ 走到点 $M$。数轴上有 $N$ 个关键点，第 $i$ 个关键点是 $T_i$，当你**首次**走到这个位置的时候，愉悦度会增加 $B_i$。若你在点 $x$，那么你可以消耗 $A$ 的愉悦度，走到任意距离点 $x$ 不超过 $D$ 的点。求最终走到 $M$ 后的愉悦度最大值。

## 输入格式

第一行五个非负整数 $K,M,D,A,N$。

接下来 $N$ 行每行两个正整数 $T_i,B_i$。

## 输出格式

输出一行一个整数表示答案。

## 说明/提示

- $1\leq N\leq 10^5$；

- $0\leq K<T_1<T_2<\dots<T_n<M\leq 10^9$；

- $1\leq D,A,B_i\leq 10^9$。

## 输入输出样例

### 输入 #1
```
0 10 4 10 2
3 10
8 5
```

### 输出 #1

```
-20
```

### 输入 #2
```
3 42 9 10 8
10 5
12 9
26 7
27 2
30 8
34 6
36 8
40 1
```

### 输出 #2

```
-25
```



---

---
title: "バス通学"
layout: "post"
diff: 提高+/省选-
pid: AT_joisc2014_a
tag: []
---

# バス通学

## 题目描述

[problemUrl]: https://atcoder.jp/contests/joisc2014/tasks/joisc2014_a





---

---
title: "ストラップ"
layout: "post"
diff: 提高+/省选-
pid: AT_joisc2014_m
tag: []
---

# ストラップ

## 题目描述

JOI 君有 $N$ 个装在手机上的挂饰，编号为$1 \dots N$。 JOI君可以将其中的一些装在手机上。

JOI 君的挂饰有一些与众不同——其中的一些挂饰附有可以挂其他挂件的挂钩。每个挂件要么直接挂在手机上，要么挂在其他挂件的挂钩上。直接挂在手机上的挂件最多有 $1$ 个。

此外，每个挂件有一个安装时会获得的喜悦值，用一个整数来表示。如果 JOI 君很讨厌某个挂饰，那么这个挂饰的喜悦值就是一个负数。

JOI 君想要最大化所有挂饰的喜悦值之和。注意不必要将所有的挂钩都挂上挂饰，而且一个都不挂也是可以的。

## 输入格式

第一行一个整数 $N$，代表挂饰的个数。

接下来 $N$ 行，第 $i$ 行（$1 \le i \le N$）有两个空格分隔的整数 $A_i$ 和 $B_i$，表示挂饰 $i$ 有 $A_i$ 个挂钩，安装后会获得 $B_i$ 的喜悦值。

## 输出格式

输出一行一个整数，表示手机上连接的挂饰总和的最大值

## 样例 #1

### 样例输入 #1

```
5
0 4
2 -2
1 -1
0 1
0 3
```

### 样例输出 #1

```
5
```

## 说明/提示

$1\leq N\leq 2000$

$0\leq Ai\leq N(1\leq i\leq N)$

$-10^6\leq Bi\leq 10^6(1\leq i\leq N)$



---

---
title: "道路整備"
layout: "post"
diff: 提高+/省选-
pid: AT_joisc2015_g
tag: []
---

# 道路整備

## 题目描述

## JOISC2015 Day2T3 道路整备


给定一个$N$个点的森林，初始森林上没有边。接下来进行$Q$次操作，操作有以下两种：

$1\ u\ v$：如果当前$u\ v$不连通，则在森林上添加一条边$(u,v)$，边权为$1$；否则将森林中路径$(u,v)$上的所有边的边权赋为$0$。

$2\ u\ v$：询问此时森林上$(u,v)$对应的路径的边权和。

## 输入格式

第一行两个正整数$N,Q$，

接下来$Q$行每行三个正整数$type,u,v$描述一个操作。

## 输出格式

对于每个$2$操作输出一行表示路径边权和，如果森林上$(u,v)$不连通输出`-1`。

## 说明/提示

$1 \leq N \leq 10^5$

$1 \leq Q \leq 3 \times 10^5$

$type \in \{1,2\} , 1 \leq u,v \leq N , u \neq v$

### 样例

#### 样例输入1

```
3 7
1 1 2
2 2 1
2 2 3
1 2 1
2 1 2
1 2 3
2 1 3
```

#### 样例输出1

```
1
-1
0
1
```

#### 样例输入2

```
6 8
1 1 3
1 6 1
1 2 5
2 3 6
1 3 6
1 4 1
2 4 3
2 2 5
```

#### 样例输出2

```
2
1
1
```

#### 样例输入3

```
7 11
1 5 1
1 6 2
1 1 3
1 3 5
1 5 7
1 4 5
1 4 1
2 1 3
2 3 7
2 4 3
2 5 6
```

#### 样例输出3

```
0
1
0
-1
```



---

---
title: "とてもたのしいカードゲーム"
layout: "post"
diff: 提高+/省选-
pid: AT_joisc2015_i
tag: []
---

# とてもたのしいカードゲーム

## 题目描述

## JOISC2015 Day3T2 有趣的纸牌游戏


给定$N$张纸牌，纸牌自上而下堆在牌堆$A$中。牌堆$A$中从上而下第$i$张纸牌颜色是$c_i$、权值是$a_i$、价值是$v_i$。

同时你还有另一个牌堆$B$，初始$B$中没有牌。你可以进行以下操作若干次：

从牌堆中$A$选出自上而下第$1$张或者第$3$张纸牌（如果存在）。如果牌堆$B$中没有牌，或者牌堆$B$的堆顶的牌与你当前选出的牌在颜色或者权值上存在至少一个相同，则将这张纸牌移动到牌堆$B$的堆顶。

定义一个牌堆的价值为其中所有纸牌的价值之和，你需要求出牌堆$B$的可能最大价值。

## 输入格式

第一行一个正整数$N$；

接下来$N$行每行三个正整数$c_i,a_i,v_i$表示自上而下第$i$张牌的颜色、权值、价值。

## 输出格式

一行一个正整数表示牌堆$B$的最大可能价值。

## 说明/提示

$1 \leq N , a_i , c_i \leq 500$

$1 \leq v_i \leq 10^6$

### 样例

#### 样例输入1

```
5
1 3 2
4 2 9
1 4 6
2 3 3
2 2 1
```

#### 样例输出1

```
15
```

#### 样例1解释

依次选出牌堆$A$的第$1,3,3,1$张牌可使牌堆$B$达到最大价值。

#### 样例输入2

```
8
11 5 31
2 8 19
2 9 2
11 8 45
4 8 22
4 2 23
6 9 58
6 2 5
```

#### 样例输出2

```
160
```



---

---
title: "遺産相続"
layout: "post"
diff: 提高+/省选-
pid: AT_joisc2015_k
tag: []
---

# 遺産相続

## 题目描述

## JOISC2015 Day4T1 遗产继承


给定一个$N$个点、$M$条边的无向图，每条边有权值，任意两条边的权值不同。图上保证没有自环，但是可能有重边。每条边有一个标记值，初始每条边的标记值均为$0$。

接下来对这个图进行$K$次操作，第$i$次操作时执行如下操作：在图中选择一个边的集合，满足：

1、其包含的所有边的标记值都是$0$；

2、不存在任何非空子集满足这个子集在图上构成环；

3、选择的集合中所有边的权值之和是当前所有可能的选择方案中权值和最大的选择方案；

然后将这些边的标记值赋为$i$。

求$K$次操作完成之后每一条边的标记值。

## 输入格式

第一行三个正整数$N,M,K$，意义如上所述；

接下来$M$行每行三个正整数$A_i,B_i,C_i$表示一条连接$(A_i,B_i)$、权值为$C_i$的边。

## 输出格式

$M$行每行一个非负整数表示输入的第$i$条边在操作完成之后的标记值。

## 说明/提示

$1 \leq N \leq 1000$；

$1 \leq M \leq 300000$；

$1 \leq K \leq 10000$；

$1 \leq A_i , B_i \leq N , A_i \neq B_i$；

$1 \leq C_i \leq 10^9 , \forall i \neq j , C_i \neq C_j$；



---

---
title: "危険なスケート"
layout: "post"
diff: 提高+/省选-
pid: AT_joisc2016_j
tag: []
---

# 危険なスケート

## 题目描述

JOI 君的爱好是在大自然的广阔滑冰场上滑冰。

滑冰场呈长方形，由南北方向的 $R$ 个格子和东西方向的 $C$ 个格子组成。我们将北边第 $r$ 行、西边第 $c$ 列的格子称为格子 $( r , c )$ 。每个格子要么是 JOI 君可以通过的格子，要么是有冰块而无法通过的格子。此外，滑冰场的外周的格子上都有冰块，JOI君不会滑出场外。也就是说，格子 $( i , 1 )$、$( i , C ) (1 ≦ i ≦ R)$ 以及格子 $( 1 , j )$、$( R , j ) (1 ≦ j ≦ C)$ 上都有冰块。

JOI 君的滑冰技术并不好。JOI 君在滑冰场上移动时，会朝东、西、南、北其中一个方向滑出当前所在的格子，并在撞到冰块的前一个格子停下。滑出去并停下的过程算作一次移动。如果相邻的格子上有冰块，则无法朝该方向移动。

有一天，JOI 君在享受滑冰时，突然发现当他滑出格子时，那个格子上会长出冰块。除了滑出格子的地方，经过的格子上不会长出冰块。在这种情况下继续滑冰非常危险，因此 JOI 君想尽快逃离这个滑冰场。

JOI 君当前的位置是格子 $( r1 , c1 )$。要从这个滑冰场逃脱，必须在出口的格子 $( r2 , c2 )$ 停下。为了让 JOI 君安全地从滑冰场逃脱，请编写一个程序，计算从当前位置开始移动到出口的格子至少需要多少次移动。可能会出现无论如何移动都无法停在出口的格子的情况。请注意，仅仅经过而不是停在出口的格子并不能算作逃离滑冰场。

给定滑冰场上冰块的信息、JOI 君的当前位置和出口的格子的位置，请判断 JOI 君是否能够从当前位置开始移动并在出口的格子停下，如果可以，则求出所需的最小移动次数。

## 输入格式

从标准输入读取以下数据。

第一行包含两个整数 $R$ 和 $C$，以空格分隔。这表示滑冰场的大小为南北 $R$ 个格子，东西 $C$ 个格子。

接下来的 $R$ 行中，每行有一包含 $C$ 个字符的字符串。每个字符是 `.` 或 `#` 之一。第 $r$ 行 $( 1 \leq r \leq R )$ 的第 $c$ 个字符 $( 1 \leq c \leq C )$ 表示滑冰场的格子 $( r , c )$ 的初始状态。当这个字符是 `.` 时，表示该格子可以通过；当这个字符是 `#` 时，表示该格子上有冰块，无法通过。

接下来的一行包含两个整数 $r1$ 和 $c1$，以空格分隔。这表示 JOI 君的当前位置是格子 $( r1 , c1 )$。
接下来的一行包含两个整数 $r2$ 和 $c2$，以空格分隔。这表示滑冰场的出口是格子 $( r2 , c2 )$。

## 输出格式

在标准输出中，输出 JOI 君从当前位置开始移动并在出口的格子停下所需的最小移动次数的整数，输出一行。如果 JOI 君无论如何移动都无法在出口的格子停下，则输出 $-1$。

### 限制
$3 \leq R \leq 1000$，$3 \leq C \leq 1000$，$1 \leq r1 , r2 \leq R$，$1 \leq c1 , c2 \leq C$。

滑冰场的外周的格子上都有冰块。也就是说，格子 $( i , 1 )$、$( i , C ) ( 1 \leq i \leq R )$ 以及格子 $( 1 , j )$、$( R , j ) ( 1 \leq j \leq C )$ 上都有冰块。

格子 $( r1 , c1 )$ 和格子 $( r2 , c2 )$ 上没有冰块。

## 说明/提示

#### 子任务 $1$（$13$ 分）

$R \leq 10$，$C \leq 10$。

如果 JOI 君能够从当前位置开始移动并在出口的格子停下，则所需的移动次数在 $10$ 次以内。

#### 子任务 $2$（$65$ 分）

$R \leq 200$，$C \leq 200$。

#### 子任务 $3$（$22$ 分）

没有额外的限制。

翻自[此处](https://www2.ioi-jp.org/camp/2016/2016-sp-tasks/2016-sp-d4.pdf)。



---

---
title: "ランプ (Lamps)"
layout: "post"
diff: 提高+/省选-
pid: AT_joisc2019_h
tag: []
---

# ランプ (Lamps)

## 题目描述

[problemUrl]: https://atcoder.jp/contests/joisc2019/tasks/joisc2019_h





---

---
title: "合併 (Mergers)"
layout: "post"
diff: 提高+/省选-
pid: AT_joisc2019_k
tag: []
---

# 合併 (Mergers)

## 题目描述

[problemUrl]: https://atcoder.jp/contests/joisc2019/tasks/joisc2019_k





---

---
title: "ビルの飾りつけ 4 (Building 4)"
layout: "post"
diff: 提高+/省选-
pid: AT_joisc2020_a
tag: []
---

# ビルの飾りつけ 4 (Building 4)

## 题目描述

[problemUrl]: https://atcoder.jp/contests/joisc2020/tasks/joisc2020_a





---

---
title: "スプリンクラー (Sprinkler)"
layout: "post"
diff: 提高+/省选-
pid: AT_joisc2022_h
tag: []
---

# スプリンクラー (Sprinkler)

## 题目描述

IOI 农场由 $N$ 块土地组成。土地间有 $N-1$ 条双向道路相连，编号从 $1$ 到 $N-1$ ，第 $i$ 条道路连接土地 $A_i$  和 $B_i$ ，任意两块土地间都可以通过道路互达。农场的每块土地上都有一个洒水器，使用洒水器可以向附近的土地洒水。

JOI 谷是一种脆弱的植物，若它的高度大于等于 $L$ ，JOI 谷顶部长为 $L$ 的部分会立刻断裂并掉落。JOI 君会收获掉落的部分。

初始时，JOI 君在土地 $j$ 上种了一株高度为 $H_j$ 的 JOI 谷，之后的 $Q$ 天，JOI 君都会照料这些 JOI 谷，在第 $k$ 天，JOI 君会做如下两个操作之一：

- 操作 $1$：使用土地 $X_k$ 上的洒水器，向与土地 $X_k$ 距离不超过 $D_k$ 的土地上浇水，使这些土地上的 JOI 谷高度乘以 $W_k$。对高度为 h 的 JOI 谷洒水，它的高度会变为 $hW_k \bmod L$。

- 操作 $2$：测量土地 $X_k$ 上 JOI 谷的高度。

土地 $x$ 和土地 $y$ 间距离的定义为：从土地 $x$ 前往土地 $y$ 经过道路数的最小值。

## 输入格式

第一行两个整数 $N,L$，表示土地块数和 JOI 谷的断裂阈值。

接下来 $N-1$ 行，每行两个整数 $A_i,B_i$ 表示一条道路。

接下来 $N$ 行，每行一个整数 $H_i$ 表示 JOI 谷的初始高度。

接下来一行一个整数 $Q$ 表示操作次数。

接下来 $Q$ 行，第 $k$ 行以 $T_k$ 开头，表示这次操作类型，接下来：

- 若 $T_k=1$ ，这是一次操作 $1$ ，接下来三个整数 $X_k,D_k,W_k$ 分别表示洒水器编号，洒水半径和生长参数。
- 若 $T_k=2$ ，这是一次操作 $2$ ，接下来一个整数 $X_k$ 表示需要测量的 JOI 谷的编号。

## 输出格式

对于每一次操作 $2$，输出一个整数表示 JOI 谷的预期高度。

### 输入输出样例

#### 输入 #1

```cpp
4 7
1 2
2 3
3 4
1
1
1
1
11
1 2 1 2
1 1 0 2
2 1
2 2
2 3
2 4
1 4 10 2
2 1
2 2
2 3
2 4
```



#### 输出 #1

```cpp
4
2
2
1
1
4
4
2
```

初始时，JOI 君在所有土地上种植了高度为 $1$ 的 JOI 谷。

第一天，JOI 君使用土地 $2$ 的洒水器，土地 $1,2,3$ 的 JOI 谷被影响，高度乘以 $2$，四株 JOI 谷的高度变为 $2,2,2,1$ 。

第二天，JOI 君使用土地 $1$ 的洒水器，土地 $1$ 的 JOI 谷被影响，高度乘以 $2$，四株 JOI 谷的高度变为 $4,2,2,1$ 。

第七天，JOI 君使用土地 $4$ 的洒水器，土地 $1,2,3,4$ 的 JOI 谷被影响，高度乘以 $2$，第一株 JOI 谷的高度变为 $8$，发生断裂，因此四株 JOI 谷的高度变为 $1,4,4,2$ 。

这组样例满足子任务 $1,5,6$ 的限制。

#### 输入 #2

```cpp
6 10
5 6
1 2
1 4
2 6
3 6
9
2
3
4
9
1
10
1 5 1 7
2 4
1 4 1 9
1 5 0 7
2 1
1 1 1 3
1 6 1 4
2 5
2 4
2 3
```

#### 输出 #2

```cpp
4
1
4
8
2
```

第一天，JOI 君使用土地 $5$ 的洒水器，土地 $5,6$ 上的 JOI 谷高度乘以 $7$ ，高度分别变为 $63,7$ ，因此，土地 $5$ 上的 JOI 谷会不断断裂，高度变为 $3$ 。

这组样例满足子任务 $1,2,3,6$ 的限制。

#### 输入 #3

```cpp
8 10
1 3
3 5
4 7
6 7
4 5
7 8
2 4
5
8
6
4
6
2
9
3
11
1 2 2 0
2 1
1 6 1 0
2 4
2 6
1 5 2 0
2 8
1 7 2 0
2 6
2 7
2 4
```

#### 输出 #3

```cpp
5
0
0
3
0
0
0
```

这组样例满足子任务 $1,3,4,6$ 的限制。

## 说明/提示

对于所有数据，满足：

- $2\leq N\leq 200000$
- $2\leq L\leq 10^9$
- $1\leq A_i\lt B_i\leq N (i\in[1,N-1])$
- 任意土地之间都可以通过若干条道路到达
- $0\leq H_j\lt L (1\leq j\leq N)$
- $1\leq Q\leq 400000$
- $T_k$ 均为 $1$ 或 $2$
- 对于满足 $T_k=1 (k\in[1, Q])$ 的 $k$ ，保证 $1\leq X_k\leq N, 0\leq D_k\leq 40, 0\leq W_k\lt L$
- 对于满足 $T_k=2 (k\in[1, Q])$ 的 $k$ ，保证 $1\leq X_k\leq N$

详细子任务附加限制及分值如下表所示：

| 子任务编号 |                  附加限制                  | 分值 |
| :--------: | :----------------------------------------: | :--: |
|     1      |               $N,Q\le 1000$                | $3$  |
|     2      | 对于满足 $T_k=1$ 的 $k$ ，保证 $D_k\leq 1$ | $9$  |
|     3      | 对于满足 $T_k=1$ 的 $k$ ，保证 $D_k\leq 2$ | $29$ |
|     4      |   对于满足 $T_k=1$ 的 $k$ ，保证 $W_k=0$   | $12$ |
|     5      |   对于满足 $T_k=1$ 的 $k$ ，保证 $W_k=2$   | $30$ |
|     6      |                 无附加限制                 | $17$ |



---

---
title: "Classified"
layout: "post"
diff: 提高+/省选-
pid: AT_jsc2019_qual_d
tag: []
---

# Classified

## 题目描述

AtCoder 的最高级办公室由 $N$ 个房间组成，房间编号 $1\sim N$，任意两个房间之间有一条走廊。

由于一些原因，Takahashi 需要给每一条走廊确定一个正整数作为安全程度，满足：

- 从任意一个房间出发，仅经过相同安全系数的走廊回到这个房间，穿过的走廊数恒为偶数。

你需要构造一组给每条走廊确定安全程度的方案，使得安全程度的最大值最小。

## 输入格式

输入一行一个正整数 $N$（$2\le N\le 500$）表示房间个数。

## 输出格式

输出一种满足条件的方案，格式如下：

> $a_{1,2}\quad a_{1,3}\quad \ldots \quad a_{1,N}\\a_{2,3}\quad \ldots \quad a_{2_N}\\\vdots\\a_{N-1,N}$

其中 $a_{i,j}$ 表示房间 $i$ 和 $j$ 间的走廊的安全程度。

若有多组符合条件的解，输出任意一组。

### 样例解释

如图为一种可行方案。例如，从房间 $2$ 出发，路线 $2\rightarrow 3\rightarrow 2\rightarrow 3\rightarrow 2\rightarrow 1\rightarrow 2$ 经过了 $6$ 条安全程度均为 $1$ 的走廊回到房间 $2$，且 $6$ 为偶数，符合条件。

## 样例 #1

### 输入

```
3
```

### 输出

```
1 2

1
```



---

---
title: "Level K Palindrome"
layout: "post"
diff: 提高+/省选-
pid: AT_jsc2021_e
tag: []
---

# Level K Palindrome

## 题目描述

[problemUrl]: https://atcoder.jp/contests/jsc2021/tasks/jsc2021_e

高橋くんは、すぬけくんに日頃の感謝を込めてレベル $ K $ の回文を送ることにしました。レベル $ L $ の回文 ( $ L $ は $ 0 $ 以上の整数 ) は以下のように定義されます。

- 文字列 $ s $ の左右を反転させたものを $ \mathrm{rev}(s) $ と表す。
- 文字列 $ s $ は $ s\ =\ \mathrm{rev}(s) $ であるとき、回文という。
- 空文字列と回文でない文字列はレベル $ 0 $ の回文である。
- 任意の**空でない**レベル $ L\ -\ 1 $ の回文 $ t $ に対して、$ t,\ \mathrm{rev}(t) $ をこの順に繋げた文字列はレベル $ L $ の回文である。
- 任意のレベル $ L\ -\ 1 $ の回文 $ t $ と任意の文字 $ c $ に対して、$ t,\ c,\ \mathrm{rev}(t) $ をこの順に繋げた文字列はレベル $ L $ の回文である。

いま、高橋くんは文字列 $ S $ を持っています。  
 $ S $ から $ 1 $ 文字選んで別の英小文字に書き換えるということを $ 0 $ 回以上繰り返すことで、$ S $ をちょうどレベル $ K $ の回文にすることができるか判定してください。また、できる場合は、$ S $ がちょうどレベル $ K $ の回文になるまでに必要な最小の書き換え回数を求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ K $ $ S $

## 输出格式

ちょうどレベル $ K $ の回文を作ることができる場合は、必要な最小の書き換え回数を出力せよ。  
 できない場合は、`impossible` と出力せよ。

## 说明/提示

### 制約

- $ K $ は整数
- $ 0\ <\ = K\ <\ = 5\ \times\ 10^5 $
- $ S $ は英小文字からなる
- $ 1\ <\ =\ |S|\ <\ = 5\ \times\ 10^5 $

### Sample Explanation 1

`aabaaaabaa` のレベルは以下のように計算できます。 - 空文字列はレベル $ 0 $ の回文である。 - `a` は (空文字列), `a`, (空文字列) を順に繋げた文字列だから、レベル $ 1 $ の回文である。 - `aa` は `a`, `a` を順に繋げた文字列だから、レベル $ 2 $ の回文である。 - `aabaa` は `aa`, `b`, `aa` を順に繋げた文字列だから、レベル $ 3 $ の回文である。 - `aabaaaabaa` は `aabaa`, `aabaa` を順に繋げた文字列だから、レベル $ 4 $ の回文である。 よって、`aabaaaabaa` は初めからレベル $ 4 $ の回文であるので、書き換える必要はありません。

### Sample Explanation 2

例えば、`aabaaaabaa` を `acbcaacbca` に書き換えると、ちょうどレベル $ 2 $ の回文を作ることができます。 `aabaaaabaa` はレベル $ 2 $ の回文ではないことに注意してください。

## 样例 #1

### 输入

```
4

aabaaaabaa
```

### 输出

```
0
```

## 样例 #2

### 输入

```
2

aabaaaabaa
```

### 输出

```
4
```

## 样例 #3

### 输入

```
3

aabaaaabaa
```

### 输出

```
impossible
```

## 样例 #4

### 输入

```
5

aabaaaabaa
```

### 输出

```
impossible
```

## 样例 #5

### 输入

```
2

acaabcbababaaac
```

### 输出

```
6
```



---

---
title: "Max Matrix"
layout: "post"
diff: 提高+/省选-
pid: AT_jsc2021_f
tag: []
---

# Max Matrix

## 题目描述

[problemUrl]: https://atcoder.jp/contests/jsc2021/tasks/jsc2021_f

長さ $ N $ の数列 $ a $ と、長さ $ M $ の数列 $ b $ があります。最初、$ a,b $ の要素は全て $ 0 $ です。  
 $ Q $ 個のクエリを処理してください。$ i $ 個目のクエリでは $ 3 $ つの整数 $ T_i,\ X_i,\ Y_i $ が与えられ、以下の処理をします。

- $ T_i\ =\ 1 $ のとき : $ a_{X_i} $ を $ Y_i $ に置き換える
- $ T_i\ =\ 2 $ のとき : $ b_{X_i} $ を $ Y_i $ に置き換える

そして、毎回のクエリの処理直後に $ \displaystyle\ \sum_{i\ =\ 1}^N\ \sum_{j\ =\ 1}^M\ \max(a_i,\ b_j) $ の値を出力してください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ M $ $ Q $ $ T_1 $ $ X_1 $ $ Y_1 $ $ T_2 $ $ X_2 $ $ Y_2 $ $ T_3 $ $ X_3 $ $ Y_3 $ $ \hspace{21pt}\ \vdots $ $ T_Q $ $ X_Q $ $ Y_Q $

## 输出格式

問題文の指示に従って $ Q $ 個の整数を改行区切りで出力せよ。

## 说明/提示

### 制約

- $ 1\ \le\ N\ \le\ 2\ \times\ 10^5 $
- $ 1\ \le\ M\ \le\ 2\ \times\ 10^5 $
- $ 1\ \le\ Q\ \le\ 2\ \times\ 10^5 $
- $ T_i $ は $ 1 $ または $ 2 $
- $ T_i\ =\ 1 $ ならば $ 1\ \le\ X_i\ \le\ N $
- $ T_i\ =\ 2 $ ならば $ 1\ \le\ X_i\ \le\ M $
- $ 1\ \le\ Y_i\ \le\ 10^8 $
- 入力に含まれる値は全て整数である

### Sample Explanation 1

上から $ i $ 行目、左から $ j $ 列目に $ \max(a_i,\ b_j) $ を書き込んだマス目は、$ 4 $ 回のクエリで以下のように変化します。 !\[\](https://img.atcoder.jp/ghi/9a4098e2aa50b21c51ce3664d278ba87.png)

### Sample Explanation 3

出力する整数は $ 32 $ bit 整数型に収まらない可能性があります。

## 样例 #1

### 输入

```
2 2 4

1 1 10

2 1 20

2 2 5

1 1 30
```

### 输出

```
20

50

55

85
```

## 样例 #2

### 输入

```
3 3 5

1 3 10

2 1 7

1 3 5

2 2 10

2 1 1
```

### 输出

```
30

44

31

56

42
```

## 样例 #3

### 输入

```
200000 200000 4

2 112219 100000000

1 73821 100000000

2 26402 100000000

1 73821 100000000
```

### 输出

```
20000000000000

39999900000000

59999800000000

59999800000000
```



---

---
title: "Bichromization"
layout: "post"
diff: 提高+/省选-
pid: AT_keyence2020_e
tag: []
---

# Bichromization

## 题目描述

[problemUrl]: https://atcoder.jp/contests/keyence2020/tasks/keyence2020_e

$ N $ 頂点 $ M $ 辺の連結な無向グラフがあります。 このグラフの辺 $ i $ ($ 1\ \leq\ i\ \leq\ M $) は頂点 $ U_i $ と頂点 $ V_i $ を双方向に結んでいます。 また、$ N $ 個の整数 $ D_1,\ D_2,\ ...,\ D_N $ が与えられます。

このグラフの各頂点に白または黒の色を割り当て、さらに 各辺に $ 1 $ 以上 $ 10^9 $ 以下の整数の重みを割り当てる方法であって、以下の条件を満たすものが存在するかどうか判定してください。 さらに、存在する場合、そのような割り当てをひとつ求めてください。

- 白および黒が割り当てられた頂点がそれぞれ少なくとも $ 1 $ 個以上存在する。
- 各頂点 $ v $ ($ 1\ \leq\ v\ \leq\ N $) に対して以下の条件が成り立つ。
  - 頂点 $ v $ からグラフの辺を通って頂点 $ v $ と異なる色が割り当てられた頂点に移動する際にかかる最小のコストはちょうど $ D_v $ である。

なお、グラフ上の移動にかかるコストとは、 移動の際に通る辺の重みの和のことです。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ M $ $ D_1 $ $ D_2 $ $ ... $ $ D_N $ $ U_1 $ $ V_1 $ $ U_2 $ $ V_2 $ $ \vdots $ $ U_M $ $ V_M $

## 输出格式

割り当てが不可能である場合、`-1` と一行に出力せよ。

可能である場合、 割り当て方をひとつ、 以下の形式で出力せよ。

> $ S $ $ C_1 $ $ C_2 $ $ \vdots $ $ C_M $

ただし、

- $ 1 $ 行目の出力 $ S $ は長さ $ N $ の文字列とせよ。 その $ i $ 番目 ($ 1\ \leq\ i\ \leq\ N $) の文字は、頂点 $ i $ に白色を割り当てる場合は `W` とし、黒色を割り当てる場合は `B` とせよ。
- $ i\ +\ 1 $ 行目 ($ 1\ \leq\ i\ \leq\ M $) の出力 $ C_i $ は辺 $ i $ に割り当てる重みとせよ（整数として出力すること）。

## 说明/提示

### 制約

- $ 2\ \leq\ N\ \leq\ 100,000 $
- $ 1\ \leq\ M\ \leq\ 200,000 $
- $ 1\ \leq\ D_i\ \leq\ 10^9 $
- $ 1\ \leq\ U_i,\ V_i\ \leq\ N $
- 与えられるグラフは連結であり、自己ループや多重辺を持たない。
- 入力値はすべて整数である。

### Sample Explanation 1

出力例のように色と重みを割り当てた場合、たとえば頂点 $ 5 $ からグラフの辺を通って頂点 $ 5 $ と異なる色が割り当てられた頂点に最小のコストで移動するには、 頂点 $ 5 $ $ \to $ 頂点 $ 4 $ $ \to $ 頂点 $ 2 $ と移動すればよく、この移動のコストは $ 7 $ となるので、条件を満たします。 他の頂点についても条件を満たすことが確かめられます。

## 样例 #1

### 输入

```
5 5

3 4 3 5 7

1 2

1 3

3 2

4 2

4 5
```

### 输出

```
BWWBB

4

3

1

5

2
```

## 样例 #2

### 输入

```
5 7

1 2 3 4 5

1 2

1 3

1 4

2 3

2 5

3 5

4 5
```

### 输出

```
-1
```

## 样例 #3

### 输入

```
4 6

1 1 1 1

1 2

1 3

1 4

2 3

2 4

3 4
```

### 输出

```
BBBW

1

1

1

2

1

1
```



---

---
title: "Choosing Up Sides"
layout: "post"
diff: 提高+/省选-
pid: AT_keyence2021_d
tag: []
---

# Choosing Up Sides

## 题目描述

[problemUrl]: https://atcoder.jp/contests/keyence2021/tasks/keyence2021_d

$ N $ を正の整数とします。 $ 2 $ つの $ 2^{N-1} $ 人チームが対戦する競技があります。

$ 1 $ から $ 2^N $ の番号がついた $ 2^N $ 人の人がいます。 すぬけ監督は、彼らを A と B の $ 2 $ つの $ 2^{N-1} $ 人チームに分けて対戦させる、という操作を何回でも行うことができます。

すぬけ監督は、$ 1 $ 回以上操作を行った後、以下の $ 2 $ つの条件の両方を満たすようにしたいです。

1. ある整数 $ n $ が存在して、$ 1\ \leq\ i\ <\ j\ \leq\ 2^N $ を満たす任意の $ (i,j) $ について、人 $ i $ と人 $ j $ が **同じ** チームだった回数が $ n $ 回
2. ある整数 $ m $ が存在して、$ 1\ \leq\ i\ <\ j\ \leq\ 2^N $ を満たす任意の $ (i,j) $ について、人 $ i $ と人 $ j $ が **異なる** チームだった回数が $ m $ 回

すぬけ監督の要望を満たすような操作列が存在することが証明できます。そのうち **操作回数が最小** であるようなものの一例を示してください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $

## 输出格式

下記のフォーマットで操作列を出力せよ。

> $ K $ $ s_1 $ $ s_2 $ $ \vdots $ $ s_K $

ここで、$ K $ は操作列の長さを、$ s_i $ は $ i $ 回目の操作でのチーム分けを表す。 $ s_{i} $ は長さ $ 2^N $ の `A`, `B` のみからなる文字列であり、$ s_{i} $ の $ {j} $ 文字目が `A` ならば $ i $ 回目の操作で人 $ j $ はチーム A に所属していたことを、`B` ならばチーム B に所属していたことを表す。`A`, `B` は $ s_i $ において $ 2^{N-1} $ 回ずつ出現する必要があることに注意せよ。

$ K $ が要望を満たす操作列の長さとして最小であり、操作の結果すぬけ監督の要望が満たされたならば正解となる。

## 说明/提示

### 制約

- 与えられる入力は全て整数
- $ 1\ \leq\ N\ \leq\ 8 $

### Sample Explanation 1

\- $ 1 $ 回操作を行うことですぬけ監督の要望を満たすことができます。 - 操作は $ 1 $ 回以上行う必要があることに注意してください。

## 样例 #1

### 输入

```
1
```

### 输出

```
1

AB
```



---

---
title: "σ"
layout: "post"
diff: 提高+/省选-
pid: AT_kupc2013_i
tag: []
---

# σ

## 题目描述

请提供详细、清晰的问题描述，以便参赛者理解题目要解决的问题。

## 输入格式

详细说明输入的数据格式，包括数据的类型、顺序，以及可能的特殊情况。

## 输出格式

明确说明输出的要求，包含格式、顺序，以及要满足的条件。

## 说明/提示

提供与数据相关的约束和范围，以帮助参赛者估计可能的算法复杂度和性能需求。另外，给出一些可能有用的提示，帮助参赛者找到解决问题的思路。

欢迎补充具体内容，以便更好地翻译和润色。

 **本翻译由 AI 自动生成**



---

---
title: "Maximin Game"
layout: "post"
diff: 提高+/省选-
pid: AT_kupc2019_d
tag: []
---

# Maximin Game

## 题目描述

[problemUrl]: https://atcoder.jp/contests/kupc2019/tasks/kupc2019_d

$ 2N $ 枚のカードがあります。 $ i~(1\ \leq\ i\ \leq\ 2N) $ 番目のカードには、整数 $ i $ が書かれています。

千咲さんと月乃瀬さんは、これらのカードを使って次のようなゲームをすることにしました。

1. カードをよくシャッフルし、$ N $ 枚ずつ取ってお互いの最初の手札とする。
2. ゲームは $ N $ ラウンドからなる。各ラウンドでは、$ 2 $ 人のプレイヤーは手札の中で最も小さい数が書かれたカードを選び、見せ合う。見せたカードに書かれた数の大きいほうが、そのラウンドの勝者になる。見せたカードはお互いに手札から取り除き、それ以降のラウンドでは考慮しない。

千咲さんと月乃瀬さんは、このゲームを $ 1 $ 回プレイしました。

ゲームの結果が `0` と `1` のみからなる長さ $ N $ の文字列 $ S $ として与えられます。 任意の整数 $ i\ (1\ \leq\ i\ \leq\ N) $ について、$ S_i $ が `1` のとき、 千咲さんがゲームの $ i $ 回目のラウンドの勝者になったことを、$ S_i $ が `0` のとき、そうでないことを意味します。

このようなゲームの結果を与える千咲さんの最初の手札として、ありえるものは何種類あるでしょうか？ 答えはとても大きくなることがあるため、$ 998244353 $ で割った余りを出力してください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ S $

## 输出格式

千咲さんの最初の手札として、ありえるものの種類数を $ 998244353 $ で割った余りを出力せよ。

## 说明/提示

### 制約

- $ 1\ \leq\ N\ \leq\ 10^5 $
- $ S $ は `0` と `1` のみからなる長さ $ N $ の文字列である。

### Sample Explanation 1

千咲さんの最初の手札に $ 1 $ と $ 4 $ が、月乃瀬さんの最初の手札に $ 2 $ と $ 3 $ が書かれたカードがある場合を考えます。このとき、 - $ 1 $ 回目のラウンドでは、千咲さんは $ 1 $ が書かれたカードを、月乃瀬さんは $ 2 $ が書かれたカードをお互いに見せ、月乃瀬さんがラウンドの勝者になります。 - $ 2 $ 回目のラウンドでは、千咲さんは $ 4 $ が書かれたカードを、月乃瀬さんは $ 3 $ が書かれたカードをお互いに見せ、千咲さんがラウンドの勝者になります。 よって、千咲さんのこの最初の手札は、与えられたゲーム結果を満たします。

## 样例 #1

### 输入

```
2

01
```

### 输出

```
1
```

## 样例 #2

### 输入

```
15

111110001011100
```

### 输出

```
2100
```



---

---
title: "オレンジグラフ"
layout: "post"
diff: 提高+/省选-
pid: AT_mujin_pc_2016_c
tag: []
---

# オレンジグラフ

## 题目描述

[problemUrl]: https://atcoder.jp/contests/mujin-pc-2016/tasks/mujin_pc_2016_c





---

---
title: "Robot Racing"
layout: "post"
diff: 提高+/省选-
pid: AT_mujin_pc_2017_a
tag: []
---

# Robot Racing

## 题目描述

[problemUrl]: https://atcoder.jp/contests/mujin-pc-2017/tasks/mujin_pc_2017_a

あなたはカエル型のロボットを開発しています。 あなたはこのロボットに競走をさせることにしました。

まず、あなたは数直線上に $ N $ 体のロボットを置きました。 ロボットには $ 1 $ から $ N $ までの番号が振られています。 今、$ i $ 番目のロボットは座標 $ x_i $ にいます。 ただし、$ x_i $ はすべて整数であり、$ 0\ <\ x_1\ <\ x_2\ <\ ...\ <\ x_N $ が成り立ちます。

あなたは次の操作を繰り返し行います。

- 数直線上のロボットを一体選ぶ。 選んだロボットの座標を $ x $ とする。 座標 $ x\ -\ 1 $, $ x\ -\ 2 $ のうち他のロボットがいない座標を着地点に選ぶ。 選んだロボットを着地点へジャンプさせる。

あるロボットの座標が 0 以下になった場合、そのロボットはゴールしたと見なされ、即座に数直線から取り除かれます。 すべてのロボットがゴールするまで、あなたは操作を行い続けます。

あなたが操作を行う方法によって、$ N $ 体のロボットがゴールする順番は何通りかありえます。 $ N $ 体のロボットがゴールする順番は何通りありうるでしょうか？ $ 10^9+7 $ で割った余りを求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ x_1 $ $ x_2 $ $ ... $ $ x_N $

## 输出格式

$ N $ 体のロボットがゴールする順番は何通りありうるか？ $ 10^9+7 $ で割った余りを出力せよ。

## 说明/提示

### 制約

- $ 2\ <\ =\ N\ <\ =\ 10^5 $
- $ x_i $ は整数である。
- $ 0\ <\ x_1\ <\ x_2\ <\ ...\ <\ x_N\ <\ =\ 10^9 $

### 部分点

- $ 500 $ 点分のテストケースでは、$ N\ <\ =\ 8 $ が成り立つ。

### Sample Explanation 1

$ 3 $ 体のロボットがゴールする順番は、次の $ 4 $ 通りありえます。 - $ (ロボット\ 1\ →\ ロボット\ 2\ →\ ロボット\ 3) $ - $ (ロボット\ 1\ →\ ロボット\ 3\ →\ ロボット\ 2) $ - $ (ロボット\ 2\ →\ ロボット\ 1\ →\ ロボット\ 3) $ - $ (ロボット\ 2\ →\ ロボット\ 3\ →\ ロボット\ 1) $

### Sample Explanation 2

$ 3 $ 体のロボットがゴールする順番は、次の $ 6 $ 通りありえます。 - $ (ロボット\ 1\ →\ ロボット\ 2\ →\ ロボット\ 3) $ - $ (ロボット\ 1\ →\ ロボット\ 3\ →\ ロボット\ 2) $ - $ (ロボット\ 2\ →\ ロボット\ 1\ →\ ロボット\ 3) $ - $ (ロボット\ 2\ →\ ロボット\ 3\ →\ ロボット\ 1) $ - $ (ロボット\ 3\ →\ ロボット\ 1\ →\ ロボット\ 2) $ - $ (ロボット\ 3\ →\ ロボット\ 2\ →\ ロボット\ 1) $ 例えば、次図のように操作を行うと、$ (ロボット\ 3\ →\ ロボット\ 2\ →\ ロボット\ 1) $ の順にゴールします。 !\[a55aed48a00614569d4844f39807e2fb.png\](https://atcoder.jp/img/mujin/a55aed48a00614569d4844f39807e2fb.png)

### Sample Explanation 4

答えを $ 10^9+7 $ で割った余りを出力してください。 なお、このケースは部分点のテストケースには含まれません。

## 样例 #1

### 输入

```
3

1 2 3
```

### 输出

```
4
```

## 样例 #2

### 输入

```
3

2 3 4
```

### 输出

```
6
```

## 样例 #3

### 输入

```
8

1 2 3 5 7 11 13 17
```

### 输出

```
10080
```

## 样例 #4

### 输入

```
13

4 6 8 9 10 12 14 15 16 18 20 21 22
```

### 输出

```
311014372
```



---

---
title: "Row to Column"
layout: "post"
diff: 提高+/省选-
pid: AT_mujin_pc_2017_b
tag: []
---

# Row to Column

## 题目描述

[problemUrl]: https://atcoder.jp/contests/mujin-pc-2017/tasks/mujin_pc_2017_b

縦 $ N $ 行、横 $ N $ 列の正方形状のマス目があります。 上から $ i $ 行目、左から $ j $ 列目のマスを $ (i,\ j) $ と表します。

最初、各マスは白か黒です。 最初のマス目の配色は、正方形状に並ぶ文字 $ a_{ij} $ ($ 1\ <\ =\ i,\ j\ <\ =\ N $) として与えられます。 マス $ (i,\ j) $ が白ならば $ a_{ij} $ は `.` であり、黒ならば $ a_{ij} $ は `#` です。

あなたは、マス目の配色を塗り替えるロボットを開発しています。 このロボットは次の操作を繰り返し行うことができます。

- 整数 $ i $, $ j $ ($ 1\ <\ =\ i,\ j\ <\ =\ N $) をそれぞれ自由に選ぶ。 マス $ (i,\ 1) $, $ (i,\ 2) $, $ ... $, $ (i,\ N) $ の色をそれぞれ $ c_1 $, $ c_2 $, $ ... $, $ c_N $ として記憶する。 その後、マス $ (1,\ j) $, $ (2,\ j) $, $ ... $, $ (N,\ j) $ の色をそれぞれ $ c_1 $, $ c_2 $, $ ... $, $ c_N $ で塗り替える。

あなたの目標は、すべてのマスを黒にすることです。 すべてのマスを黒にすることが可能か判定し、可能ならば必要な操作回数の最小値を求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ a_{11} $$ ... $$ a_{1N} $ $ : $ $ a_{N1} $$ ... $$ a_{NN} $

## 输出格式

すべてのマスを黒にすることが可能ならば、必要な操作回数の最小値を出力せよ。 不可能ならば、代わりに `-1` を出力せよ。

## 说明/提示

### 制約

- $ 2\ <\ =\ N\ <\ =\ 500 $
- $ a_{ij} $ は `.` または `#` である。

### 部分点

- $ 300 $ 点分のテストケースでは、$ N\ <\ =\ 3 $ が成り立つ。

### Sample Explanation 1

例えば、次のように操作を行うと、次図のようにマス目の配色が変わります。 - $ i\ =\ 1 $, $ j\ =\ 2 $ と選んで操作を行う。 - $ i\ =\ 1 $, $ j\ =\ 1 $ と選んで操作を行う。 - $ i\ =\ 1 $, $ j\ =\ 2 $ と選んで操作を行う。 !\[6a0314bb2b1073694a7ef5a062e77b13.png\](https://atcoder.jp/img/mujin/6a0314bb2b1073694a7ef5a062e77b13.png)

## 样例 #1

### 输入

```
2

#.

.#
```

### 输出

```
3
```

## 样例 #2

### 输入

```
2

..

..
```

### 输出

```
-1
```

## 样例 #3

### 输入

```
2

##

##
```

### 输出

```
0
```

## 样例 #4

### 输入

```
3

.#.

###

.#.
```

### 输出

```
2
```

## 样例 #5

### 输入

```
3

...

.#.

...
```

### 输出

```
5
```



---

---
title: "Best-of-(2n-1)"
layout: "post"
diff: 提高+/省选-
pid: AT_m_solutions2019_c
tag: []
---

# Best-of-(2n-1)

## 题目描述

高桥和青木将要玩一个游戏。他们会反复游戏直到其中一人胜利 $N$ 次。

他们玩游戏时，高桥、青木的胜率分别为 $A\%$、$B\%$，平局（双方均不获胜）的概率为 $C\%$。请计算游戏进行次数的估计值，并按以下方式输出。

我们可以找出两个互质的整数 $P$，$Q$，用 $P/Q$ 表示估计值。输出满足 $0 \leq R \leq 10^9+6$ 的整数 $R$，使得 $R \times Q \equiv P \pmod {10^9+7}$ 成立（在本题的条件下，整数 $R$ 总是唯一存在）。

## 输入格式

四个整数，分别为 $N$，$A$，$B$ 和 $C$。

## 输出格式

按照问题中的方法输出游戏次数的估计值。

## 说明/提示

- $1 \leq N \leq 100000$
- $0 \leq A,B,C \leq 100$
- $A+B \geq 1$
- $A+B+C=100$
- 输入的数均是整数。

**【样例解释】**

【样例 1】因为 $N=1$，所以他们会重复游戏，直至一人胜利。因此，游戏次数的估计值为 $2$。

【样例 2】$C$ 可能是 $0$。

【样例 3】$B$ 也可能是 $0$。

## 样例 #1

### 输入

```
1 25 25 50
```

### 输出

```
2
```

## 样例 #2

### 输入

```
4 50 50 0
```

### 输出

```
312500008
```

## 样例 #3

### 输入

```
1 100 0 0
```

### 输出

```
1
```

## 样例 #4

### 输入

```
100000 31 41 28
```

### 输出

```
104136146
```



---

---
title: "Product of Arithmetic Progression"
layout: "post"
diff: 提高+/省选-
pid: AT_m_solutions2019_e
tag: []
---

# Product of Arithmetic Progression

## 题目描述

[problemUrl]: https://atcoder.jp/contests/m-solutions2019/tasks/m_solutions2019_e

以下のような、$ n $ 項からなる等差数列を考えます。

- $ x,\ x\ +\ d,\ x\ +\ 2d,\ \ldots,\ x\ +\ (n-1)d $

この数列のすべての項の積はいくつでしょうか？ その積を $ 1,000,003 $ で割った余りを計算してください。

この形式の問いが $ Q $ 個与えられます。 $ i $ 個目の問いでは、$ x\ =\ x_i,\ d\ =\ d_i,\ n\ =\ n_i $ の場合の答えを計算してください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ Q $ $ x_1 $ $ d_1 $ $ n_1 $ $ : $ $ x_Q $ $ d_Q $ $ n_Q $

## 输出格式

$ Q $ 行出力せよ。

$ i $ 行目に、$ i $ 個目の問いに対する答えを出力せよ。

## 说明/提示

### 制約

- $ 1\ \leq\ Q\ \leq\ 10^5 $
- $ 0\ \leq\ x_i,\ d_i\ \leq\ 1,000,002 $
- $ 1\ \leq\ n_i\ \leq\ 10^9 $
- 入力中の値はすべて整数である。

### Sample Explanation 1

最初のクエリに対し、答えは $ 7\ \times\ 9\ \times\ 11\ \times\ 13\ =\ 9009 $ です。 積を $ 1,000,003 $ で割った余りを求めることをお忘れなく。

## 样例 #1

### 输入

```
2

7 2 4

12345 67890 2019
```

### 输出

```
9009

916936
```



---

---
title: "M&#39;s Solution"
layout: "post"
diff: 提高+/省选-
pid: AT_m_solutions2020_e
tag: []
---

# M&#39;s Solution

## 题目描述

新 AtCoder 市有着类似无限扩展的棋盘结构，如下描述：

- 市中心坐落着一座钟楼，其坐标为 $ (0, 0) $。
- 钟楼所在的东西向大路被称作「东西大路」，在二维坐标系中表示为 $ x $ 轴。
- 除此之外，还有无数条平行于东西大路的道路，相距均为 1。这些道路对应于 $ y = (非零整数) $ 的直线。
- 钟楼所在的南北向大路被称作「南北大路」，在二维坐标系中表示为 $ y $ 轴。
- 另外，同样有无数条平行于南北大路的道路，相隔距离均为 1，这些道路对应于 $ x = (非零整数) $ 的直线。

在新 AtCoder 市中，存在 $ N $ 个村落。第 $ i $ 个村落位于坐标 $ (X_i, Y_i) $ 的十字路口上，人口为 $ P_i $。所有市民皆居住于这些村落中。

**目前，铁路仅有两条：一条沿东西大路延伸，另一条沿南北大路延伸。**  
然而，市长 M 君认为这样的布局给出行带来了不便，因此计划在 $ K $ 条道路上增设铁路，使铁路无限延伸。

定义每个市民到最近铁路线路的距离为「步行距离」。我们的目标是通过合理选址新修铁路，使得所有市民的步行距离之和 $ S $ 达到最小。

请计算，对于每一个 $ K = 0, 1, 2, \dots, N $，修建铁路后 $ S $ 的最小值是多少？

## 输入格式

输入格式如下：

> $ N $ $ X_1 $ $ Y_1 $ $ P_1 $ $ X_2 $ $ Y_2 $ $ P_2 $ $\ldots$ $ X_N $ $ Y_N $ $ P_N $

## 输出格式

请输出 $ N+1 $ 行。第 $ i $ 行（$ i = 1, \ldots, N+1 $）表示当 $ K = i - 1 $ 时 $ S $ 的最小值。每个最小值应为整数。

## 说明/提示

- $ 1 \leq N \leq 15 $
- $ -10\ 000 \leq X_i \leq 10\ 000 $
- $ -10\ 000 \leq Y_i \leq 10\ 000 $
- $ 1 \leq P_i \leq 1\ 000\ 000 $
- 所有 $ N $ 个村落的位置 $ (X_i, Y_i) $ 都不同
- 输入均为整数

### 样例解释

1. 对于 $ K = 0 $，村落 1、2、3 的居民分别需要步行 1、3、1 个单位到达铁道。所以，总步行距离 $ S = 1 \times 300 + 3 \times 600 + 1 \times 800 = 2900 $。
2. 当 $ K = 1 $ 时，在东西大路向北 4 单位的地方修建铁路，村落 1、2、3 的居民步行距离分别为 1、1、0。此时 $ S = 1 \times 300 + 1 \times 600 + 0 \times 800 = 900 $。对于其他方案，$ S $ 都无法小于 900。
3. 当 $ K = 2 $ 时，在南北大路东 1 和 3 单位处修建铁路，所有居民的步行距离均为 0，因此 $ S = 0 $。同样地，$ K = 3 $ 时 $ S = 0 $ 也是最优解。
   下图展示了 $ K = 0, 1, 2 $ 三种情况下最优的铁道铺设方案，蓝色代表铺设铁路的道路。
   ![](https://img.atcoder.jp/m-solutions2020/fc274bed71a4c37706550fa083496d39.png)

 **本翻译由 AI 自动生成**

## 样例 #1

### 输入

```
3

1 2 300

3 3 600

1 4 800
```

### 输出

```
2900

900

0

0
```

## 样例 #2

### 输入

```
5

3 5 400

5 3 700

5 5 1000

5 7 700

7 5 400
```

### 输出

```
13800

1600

0

0

0

0
```

## 样例 #3

### 输入

```
6

2 5 1000

5 2 1100

5 5 1700

-2 -5 900

-5 -2 600

-5 -5 2200
```

### 输出

```
26700

13900

3200

1200

0

0

0
```

## 样例 #4

### 输入

```
8

2 2 286017

3 1 262355

2 -2 213815

1 -3 224435

-2 -2 136860

-3 -1 239338

-2 2 217647

-1 3 141903
```

### 输出

```
2576709

1569381

868031

605676

366338

141903

0

0

0
```



---

---
title: "Air Safety"
layout: "post"
diff: 提高+/省选-
pid: AT_m_solutions2020_f
tag: []
---

# Air Safety

## 题目描述

[problemUrl]: https://atcoder.jp/contests/m-solutions2020/tasks/m_solutions2020_f

M 君は立派な航空管制官です。

今、彼が管理するレーダーのディスプレイの中では、番号 $ 1,\ 2,\ ...,\ N $ の $ N $ 機の飛行機が、全て同じ高度を飛行しています。  
 各飛行機は秒速 $ 0.1 $ という一定の速度で一定の方向に飛行しており、番号 $ i $ の飛行機の現在の座標は $ (X_i,\ Y_i) $、進行方向は以下の通りです。

- $ U_i $ が `U` の場合：y 座標の正の方向に進む。
- $ U_i $ が `R` の場合：x 座標の正の方向に進む。
- $ U_i $ が `D` の場合：y 座標の負の方向に進む。
- $ U_i $ が `L` の場合：x 座標の負の方向に進む。

M 君の仕事を助けるために、このままでは衝突してしまう飛行機の組が存在するかどうか判定してください。  
 もし存在する場合は、最も早いもので今から何秒後に衝突してしまうかを求めてください。  
 ただし、すべての飛行機は無視できるほど小さく、衝突は $ 2 $ つの飛行機が同じ座標に同時に到達した場合にのみ起こるものとします。

## 输入格式

入力は以下の形式で標準入力から与えられます。

> $ N $ $ X_1 $ $ Y_1 $ $ U_1 $ $ X_2 $ $ Y_2 $ $ U_2 $ $ X_3 $ $ Y_3 $ $ U_3 $ $ : $ $ X_N $ $ Y_N $ $ U_N $

## 输出格式

このままでは衝突してしまう飛行機の組が存在する場合は、最も早いもので今から何秒後に衝突するかを整数で出力してください。  
 存在しない場合は、`SAFE` と出力してください。

## 说明/提示

### 制約

- $ 1\ \leq\ N\ \leq\ 200000 $
- $ 0\ \leq\ X_i,\ Y_i\ \leq\ 200000 $
- $ U_i $ は `U`、`R`、`D`、`L` のいずれかである
- $ N $ 機の飛行機の現在位置 $ (X_i,\ Y_i) $ はすべて異なる
- $ N,\ X_i,\ Y_i $ は整数

### Sample Explanation 1

このままでは、$ 230 $ 秒後に、番号 $ 1 $ の飛行機と番号 $ 2 $ の飛行機が同時に座標 $ (11,\ 24) $ に到達し、衝突してしまいます。

### Sample Explanation 2

衝突してしまう飛行機の組はひとつもありません。

## 样例 #1

### 输入

```
2

11 1 U

11 47 D
```

### 输出

```
230
```

## 样例 #2

### 输入

```
4

20 30 U

30 20 R

20 10 D

10 20 L
```

### 输出

```
SAFE
```

## 样例 #3

### 输入

```
8

168 224 U

130 175 R

111 198 D

121 188 L

201 116 U

112 121 R

145 239 D

185 107 L
```

### 输出

```
100
```



---

---
title: "Notorious B.I.T."
layout: "post"
diff: 提高+/省选-
pid: AT_nikkei2019_2_final_e
tag: []
---

# Notorious B.I.T.

## 题目描述

Snuke 君准备提交一个长度为 $N$ 的比特串 $S$，这个比特串仅由 `0` 和 `1` 组成。

有 $M$ 条评审标准，第 $i$ 条标准要求比特串 $S$ 的从第 $L_i$ 个到第 $R_i$ 个字符的子串中必须至少包含一个 `1`。

比特串满足的评审标准数量即为其得分。

Snuke 君的对手 Smeke 君计划对比特串 $S$ 进行 $Q$ 次修改。在第 $j$ 次修改中，Snuke 会将比特串中第 $X_j$ 个字符从 `0` 改为 `1` 或从 `1` 改为 `0`。

你的任务是帮助计算在每次修改之后，比特串的新得分。

## 输入格式

输入以以下格式提供：

> $N$ $M$ $Q$ $S$ $L_1$ $R_1$ ... $L_M$ $R_M$ $X_1$ ... $X_Q$

## 输出格式

输出 $Q$ 行，每行包含一次修改后的比特串得分。

## 说明/提示

### 约束条件

- $1 \leq N \leq 200,000$
- $1 \leq M \leq 100,000$
- $1 \leq Q \leq 200,000$
- $S$ 是一个仅由 `0` 和 `1` 组成的长度为 $N$ 的字符串
- $1 \leq L_i \leq R_i \leq N$
- $1 \leq X_j \leq N$
- 除 $S$ 外的其他输入均为整数

### 样例解释
- 第一次修改后，比特串变为 `010`，满足所有的评审标准。
- 第二次修改后，比特串变为 `000`，不满足任何评审标准。
- 第三次修改后，比特串变为 `100`，满足第 $1$ 和第 $3$ 条评审标准。
- 第四次修改后，比特串变为 `101`，满足第 $1$、第 $3$ 和第 $4$ 条评审标准。

 **本翻译由 AI 自动生成**

## 样例 #1

### 输入

```
3 4 4

011

1 3

2 2

1 2

2 3

3

2

1

3
```

### 输出

```
4

0

2

3
```

## 样例 #2

### 输入

```
50 10 10

10010000000001000000001000000000000000000100000000

2 25

11 33

20 31

21 26

26 50

4 42

23 40

2 8

36 37

15 18

20

1

4

49

14

10

23

37

42

20
```

### 输出

```
8

8

7

7

7

7

5

7

7

5
```



---

---
title: "Swaps"
layout: "post"
diff: 提高+/省选-
pid: AT_nikkei2019_2_qual_c
tag: []
---

# Swaps

## 题目描述

[problemUrl]: https://atcoder.jp/contests/nikkei2019-2-qual/tasks/nikkei2019_2_qual_c

$ N $ 要素からなる $ 2 $ つの整数列 $ A_1,...,A_N $ 及び $ B_1,...,B_N $ が与えられます。 以下の操作を $ N-2 $ 回まで ($ 0 $ 回でもよい) 行うことで、$ 1 $ 以上 $ N $ 以下のすべての整数 $ i $ に対して $ A_i\ \leqq\ B_i $ となるようにできるかを判定してください。

- $ 1 $ 以上 $ N $ 以下の相異なる整数 $ x $, $ y $ を選び、$ A_x $ の値と $ A_y $ の値を入れ替える。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ A_1 $ $ A_2 $ $ ... $ $ A_N $ $ B_1 $ $ B_2 $ $ ... $ $ B_N $

## 输出格式

可能な場合は `Yes` を、不可能な場合は `No` を出力せよ。

## 说明/提示

### 制約

- $ 2\ ≦\ N\ ≦\ 10^5 $
- $ 1\ ≦\ A_i,B_i\ ≦\ 10^9 $

### Sample Explanation 1

$ A_2 $ の値と $ A_3 $ の値を入れ替えればよいです。

## 样例 #1

### 输入

```
3

1 3 2

1 2 3
```

### 输出

```
Yes
```

## 样例 #2

### 输入

```
3

1 2 3

2 2 2
```

### 输出

```
No
```

## 样例 #3

### 输入

```
6

3 1 2 6 3 4

2 2 8 3 4 3
```

### 输出

```
Yes
```



---

---
title: "Non-triangular Triplets"
layout: "post"
diff: 提高+/省选-
pid: AT_nikkei2019_2_qual_e
tag: []
---

# Non-triangular Triplets

## 题目描述

[problemUrl]: https://atcoder.jp/contests/nikkei2019-2-qual/tasks/nikkei2019_2_qual_e

正の整数 $ N $ 及び $ K $ が与えられます。

以下の条件をみたすように、$ 3N $ 個の整数 $ K,K+1,...,K+3N-1 $ を $ 3 $ 整数からなる $ N $ 個の組 $ (a_1,b_1,c_1),...,(a_N,b_N,c_N) $ に分割することが可能かを判定して下さい。$ K,K+1,...,K+3N-1 $ のうちどの整数も、$ N $ 個の組のうちちょうど $ 1 $ 個に現れなければなりません。

- $ 1 $ 以上 $ N $ 以下のすべての整数 $ i $ に対して $ a_i\ +\ b_i\ \leqq\ c_i $ が成り立つ。

また、可能な場合はそのような分割を $ 1 $ つ構成してください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ K $

## 输出格式

条件をみたすように $ N $ 個の三つ組に分割することができない場合 `-1` を出力せよ。可能な場合は $ N $ 個の三つ組を以下の形式で出力せよ。

> $ a_1 $ $ b_1 $ $ c_1 $ $ : $ $ a_N $ $ b_N $ $ c_N $

## 说明/提示

### 制約

- $ 1\ ≦\ N\ ≦\ 10^5 $
- $ 1\ ≦\ K\ ≦\ 10^9 $

## 样例 #1

### 输入

```
1 1
```

### 输出

```
1 2 3
```

## 样例 #2

### 输入

```
3 3
```

### 输出

```
-1
```



---

---
title: "Weights on Vertices and Edges"
layout: "post"
diff: 提高+/省选-
pid: AT_nikkei2019_qual_e
tag: []
---

# Weights on Vertices and Edges

## 题目描述

[problemUrl]: https://atcoder.jp/contests/nikkei2019-qual/tasks/nikkei2019_qual_e

$ N $ 頂点 $ M $ 辺の連結な無向グラフがあります。 頂点には $ 1 $ から $ N $ までの番号が、辺には $ 1 $ から $ M $ までの番号がついています。 また、各頂点、各辺にはそれぞれ重みが定められています。 頂点 $ i $ の重みは $ X_i $ です。 辺 $ i $ は頂点 $ A_i $ と $ B_i $ を結ぶ辺で、その重みは $ Y_i $ です。

グラフから辺を $ 0 $ 本以上削除して、次の条件が満たされるようにしたいです。

- 削除されていない任意の辺について、その辺を含む連結成分の頂点の重みの総和が、その辺の重み以上である。

最小で何本の辺を消す必要があるかを求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ M $ $ X_1 $ $ X_2 $ $ ... $ $ X_N $ $ A_1 $ $ B_1 $ $ Y_1 $ $ A_2 $ $ B_2 $ $ Y_2 $ $ : $ $ A_M $ $ B_M $ $ Y_M $

## 输出格式

最小で何本の辺を消す必要があるかを出力せよ。

## 说明/提示

### 制約

- $ 1\ \leq\ N\ \leq\ 10^5 $
- $ N-1\ \leq\ M\ \leq\ 10^5 $
- $ 1\ \leq\ X_i\ \leq\ 10^9 $
- $ 1\ \leq\ A_i\ <\ B_i\ \leq\ N $
- $ 1\ \leq\ Y_i\ \leq\ 10^9 $
- $ (A_i,B_i)\ \neq\ (A_j,B_j) $ ($ i\ \neq\ j $)
- 与えられるグラフは連結である。
- 入力される値はすべて整数である。

### Sample Explanation 1

辺 $ 3,4 $ を削除したとします。 このとき、辺 $ 1 $ を含む連結成分は、頂点 $ 1,2,3 $ からなる連結成分であり、頂点の重みの総和は $ 2+3+5=10 $ です。 辺 $ 1 $ の重みは $ 7 $ なので、辺 $ 1 $ については条件を満たしています。 また同様に、辺 $ 2 $ についても条件を満たしています。 よって、辺を $ 2 $ 本削除することで条件を満たすグラフが得られます。 辺を $ 1 $ 本以下削除することによって条件を満たすことはできないので、答えは $ 2 $ になります。

## 样例 #1

### 输入

```
4 4

2 3 5 7

1 2 7

1 3 9

2 3 12

3 4 18
```

### 输出

```
2
```

## 样例 #2

### 输入

```
6 10

4 4 1 1 1 7

3 5 19

2 5 20

4 5 8

1 6 16

2 3 9

3 6 16

3 4 1

2 6 20

2 4 19

1 2 9
```

### 输出

```
4
```

## 样例 #3

### 输入

```
10 9

81 16 73 7 2 61 86 38 90 28

6 8 725

3 10 12

1 4 558

4 9 615

5 6 942

8 9 918

2 7 720

4 7 292

7 10 414
```

### 输出

```
8
```



---

---
title: "のびたす"
layout: "post"
diff: 提高+/省选-
pid: AT_pakencamp_2020_day1_l
tag: []
---

# のびたす

## 题目描述

[problemUrl]: https://atcoder.jp/contests/pakencamp-2020-day1/tasks/pakencamp_2020_day1_l

配点 : $ 500 $ 点

 筑駒 71 期の数学の授業では、「のびたす」という演算が登場しました。 $ x $ のびたす $ y $ は、$ x,\ y $ を文字列として見て連結する操作を表します。

 例えば、$ 10 $ のびたす $ 20=1020 $ です。 ある正整数 $ x $ に対して、$ i=1,\ 2,\ldots,\ Q $ について以下の操作のいずれか片方を選んで行うことを考えます。

1. $ x $ を $ x+A_i $ で置き換える
2. $ x $ を $ x $ のびたす $ A_i $ で置き換える
 
 操作の仕方は $ 2^Q $ 通りありますが、それら全てについて最終的な $ x $ を求め、その総和を $ 10^9+7 $ で割った余りを求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられます。

 ```

\(Q\) \(x\)
\(A_1\)
\(A_2\)
\(⋮\)
\(A_Q\)
```

## 输出格式

最終的な $ x $ の総和を $ 10^9+7 $ で割った余りを出力してください。 出力の最後に改行を忘れないでください。

## 样例 #1

### 输入

```
1 3

10
```

### 输出

```
323
```

## 样例 #2

### 输入

```
4 10

12

21

30

9
```

### 输出

```
116122282
```

## 样例 #3

### 输入

```
10 102

2109

10329

710923

49832

5437

57432389

78322

572973938

923483

998244353
```

### 输出

```
986794595
```



---

---
title: "Bracket Inserting"
layout: "post"
diff: 提高+/省选-
pid: AT_pakencamp_2021_day2_k
tag: []
---

# Bracket Inserting

## 题目描述

龟君对字符串玩法情有独钟。今天，他开始了一个有趣的游戏，从一个空字符串 $ s $ 开始，他进行了以下操作 $ N $ 次：

- 把 $ s $ 分成两个字符串 $ l $ 和 $ r $。然后用 $ l\ + $ `()` $ +\ r $ 替换 $ s $。

现在，给你 $ N $ 次操作完成后的字符串 $ s $，即 $ T $，你的任务是找出所有可能的操作方法的数量，并将其对 $ 998244353 $ 取模后输出。

需要注意的是，如果存在一个正整数 $ k\ (1\ \le\ k\ \le\ N) $，使得第 $ k $ 次操作中的 $ (l, r) $ 不同，那么这两种操作方法被认为是不同的。

另外，考虑到龟君一定是诚实的，给定的字符串 $ T $ 总能通过某种合法的操作方法获得。

## 输入格式

标准输入给出如下格式：

> $ N $ $ T $

## 输出格式

输出结果。

## 说明/提示

### 约束

- $ 1\ \le\ N\ \le\ 10^5 $
- $ T $ 是由 `(` 和 `)` 组成的长度为 $ 2N $ 的字符串
- 通过合适的操作，总是可以使 $ s=T $

### 样例解释 1

考虑一种可能的操作：第一次操作时，$ l $ 和 $ r $ 为空字符串，所以 $ s= $ `()`；第二次操作时，令 $ l= $ `()`，$ r $ 为空字符串，于是 $ s= $ `()()`；第三次操作时，选择 $ l= $ `(`，$ r= $ ` )()`，于是 $ s= $ `(())()`。

### 样例解释 3

出题者：\[turtle0123\_\_\](https://atcoder.jp/users/turtle0123\_\_)

 **本翻译由 AI 自动生成**

## 样例 #1

### 输入

```
3

(())()
```

### 输出

```
3
```

## 样例 #2

### 输入

```
1

()
```

### 输出

```
1
```

## 样例 #3

### 输入

```
7

(()(()(())()))
```

### 输出

```
72
```



---

---
title: "Three Substrings"
layout: "post"
diff: 提高+/省选-
pid: AT_panasonic2020_e
tag: []
---

# Three Substrings

## 题目描述

[problemUrl]: https://atcoder.jp/contests/panasonic2020/tasks/panasonic2020_e

すぬけ君は、文字列 $ s $ を持っています。 あぬけ君、ぶぬけ君、くぬけ君は次のような方法でそれぞれ文字列 $ a,\ b,\ c $ を得ました。

- $ s $ の空でない ($ s $ 全体であってもよい) 連続な部分文字列を一つ選ぶ。その部分文字列のうちいくつかの文字 ($ 0 $ 個や全部であってもよい) を `?` で置き換える。

たとえば、$ s $ が `mississippi` であるとき、部分文字列として `ssissip` を選び、その $ 1,\ 3 $ 文字目を `?` で置き換えることで `?s?ssip` を得ることができます。

文字列 $ a,\ b,\ c $ が与えられます。 $ s $ の長さとして考えられる最小値を求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ a $ $ b $ $ c $

## 输出格式

$ s $ の長さとして考えられる最小値を出力せよ。

## 说明/提示

### 制約

- $ 1\ \leq\ |a|,\ |b|,\ |c|\ \leq\ 2000 $
- $ a,\ b,\ c $ は英小文字と `?` からなる。

### Sample Explanation 1

たとえば、$ s $ が `atcoder` のとき条件を満たします。

### Sample Explanation 2

$ a,\ b,\ c $ は相異なるとは限りません。

## 样例 #1

### 输入

```
a?c

der

cod
```

### 输出

```
7
```

## 样例 #2

### 输入

```
atcoder

atcoder

???????
```

### 输出

```
7
```



---

---
title: "Medals"
layout: "post"
diff: 提高+/省选-
pid: AT_s8pc_6_g
tag: []
---

# Medals

## 题目描述

### 题意翻译

一场比赛有 $N$ 人参加，第一天第 $i$ 个人得到了 $A_i$ 分，且分数互不相同，第二天每个人的得分将是一个 $1,2\dots,N$ 的排列，比赛的排名按两天的总分从大到小排序（有同分则随机排序），第一、二、三名分别为金、银、铜牌。现在，你已知每个人第一天的分数，给定 $P$ 求符合以下要求的三元组 $\left (x,y,z\right ) $ 的数量。

1. 当 $P=1$ 时，$A_x>A_y>A_z$；当 $P=2$ 时，$A_x>A_z>A_y$。
2. 第 $x,y,z$ 个人在第二天结束后可能分别获得金、银、铜牌。

## 输入格式

第一行两个整数表示 $N,P$。

第二行 $N$ 个整数表示 $A_1,A_2,\dots,A_N$。

## 输出格式

一个整数表示答案（记得换行）。

## 说明/提示

$5\le N\le 10^6$，$P\in\left \{ 1,2\right \}$，$1\le A_i\le10^9$

[Y204335](https://www.luogu.com.cn/user/360974) 翻译

## 样例 #1

### 输入

```
5 1

3 1 6 4 8
```

### 输出

```
4
```

## 样例 #2

### 输入

```
5 2

6 4 1 7 2
```

### 输出

```
3
```

## 样例 #3

### 输入

```
10 1

6 4 11 14 3 17 13 18 8 10
```

### 输出

```
26
```

## 样例 #4

### 输入

```
10 2

18 14 19 4 12 1 7 15 9 5
```

### 输出

```
14
```



---

---
title: "Tournament"
layout: "post"
diff: 提高+/省选-
pid: AT_snuke21_e
tag: []
---

# Tournament

## 题目描述

[problemUrl]: https://atcoder.jp/contests/snuke21/tasks/snuke21_e





---

---
title: "広告"
layout: "post"
diff: 提高+/省选-
pid: AT_soundhound2018_c
tag: []
---

# 広告

## 题目描述

有$r$行$c$列的矩阵，矩阵中的点有`.`，还有`*`。

要求选尽量多的`.`，使其两两不相邻。

## 输入格式

第一行$r$和$c$。

接下来$r$行，每行$c$个字符，是矩阵。

## 输出格式

一行，为最多能选多少个`.`

## 说明/提示

$1\leq r,c\leq 40$

矩阵中只有`.字符`和`*字符`

## 样例 #1

### 输入

```
3 3

...

...

...
```

### 输出

```
5
```

## 样例 #2

### 输入

```
2 2

**

**
```

### 输出

```
0
```

## 样例 #3

### 输入

```
1 1

.
```

### 输出

```
1
```

## 样例 #4

### 输入

```
3 4

*..*

..**

*...
```

### 输出

```
4
```



---

---
title: "+ Graph"
layout: "post"
diff: 提高+/省选-
pid: AT_soundhound2018_summer_qual_e
tag: []
---

# + Graph

## 题目描述

[problemUrl]: https://atcoder.jp/contests/soundhound2018-summer-qual/tasks/soundhound2018_summer_qual_e

kenkooooさんは $ n $ 頂点 $ m $ 辺の単純連結グラフを拾いました。 グラフの頂点には $ 1 $ から $ n $ の番号が付けられていて、 $ i $ 番目の辺は頂点 $ u_i $ と $ v_i $ をつないでいます。 また、$ i $ 番目の辺には整数 $ s_i $ が定められています。

kenkooooさんは次の条件を満たすようにそれぞれの頂点に *正の整数* を書き込もうとしています。

- どの辺 $ i $ についても、頂点 $ u_i $ と $ v_i $ に書かれた正の整数の和は $ s_i $ に等しい

条件を満たすような正の整数の書き方が何通りあるか求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ n $ $ m $ $ u_1 $ $ v_1 $ $ s_1 $ $ : $ $ u_m $ $ v_m $ $ s_m $

## 输出格式

条件を満たす正の整数の書き込み方が何通りあるか出力せよ。

## 说明/提示

### 制約

- $ 2\ \leq\ n\ \leq\ 10^5 $
- $ 1\ \leq\ m\ \leq\ 10^5 $
- $ 1\ \leq\ u_i\ <\ v_i\ \leq\ n $
- $ 2\ \leq\ s_i\ \leq\ 10^9 $
- $ i\neq\ j $ のとき $ u_i\ \neq\ u_j $ または $ v_i\ \neq\ v_j $
- グラフは連結
- 入力はすべて整数

### Sample Explanation 1

頂点 $ 1,2,3 $ にそれぞれ $ 1,2,3 $ を書くと条件を満たします。 これ以外に条件を満たすような整数の書き方は無いため、答えは $ 1 $ です。

### Sample Explanation 2

頂点 $ 1,2,3,4 $ に書く数をそれぞれ $ a,b,c,d $ で表すことにすると、条件を満たす $ (a,b,c,d) $の組は以下の $ 3 $ つです。 - $ (a,b,c,d)=(1,5,2,3) $ - $ (a,b,c,d)=(2,4,3,2) $ - $ (a,b,c,d)=(3,3,4,1) $

## 样例 #1

### 输入

```
3 3

1 2 3

2 3 5

1 3 4
```

### 输出

```
1
```

## 样例 #2

### 输入

```
4 3

1 2 6

2 3 7

3 4 5
```

### 输出

```
3
```

## 样例 #3

### 输入

```
8 7

1 2 1000000000

2 3 2

3 4 1000000000

4 5 2

5 6 1000000000

6 7 2

7 8 1000000000
```

### 输出

```
0
```



---

---
title: "ナップザック"
layout: "post"
diff: 提高+/省选-
pid: AT_tdpc_knapsack
tag: []
---

# ナップザック

## 题目描述

# AT683 背包
有$N$个物品，第i个重$w_i$，价值是$v_i$，颜色是$c_i$。背包可以容纳总重量小于$W$，颜色总数小于$C$的物品。问拿到的物品价值总和最大是多少？

## 输入格式

$N\ W\ C$  
$w_1\ \ v_1\ \ c_1$  
$\ \vdots\quad\ \vdots\quad\vdots$  
$w_N\ v_N\ c_N$

## 输出格式

一行，拿到的物品最大价值总和。

## 说明/提示

- $1\le N\le100$
- $1\le W\le10000$
- $1\le C\le50$
- $1\le w_i,v_i\le10000$
- $1\le c_i\le50$  

**样例数据**  
输入：
```
4 5 2
1 10 1
1 20 2
1 30 3
10 100 4
```
输出：
```
50
```
选择第二、三个物品

---
输入：
```
10 20 2
4 5 6
3 3 9
5 2 9
4 1 6
6 8 3
3 7 6
2 4 9
4 7 3
6 5 6
3 2 9
```
输出：
```
27
```



---

---
title: "木"
layout: "post"
diff: 提高+/省选-
pid: AT_tdpc_tree
tag: []
---

# 木

## 题目描述

[problemUrl]: https://atcoder.jp/contests/tdpc/tasks/tdpc_tree

入力は以下の形式で標準入力から与えられる。

> $ N $ $ a_1\ b_1 $ $ ... $ $ a_{N-1}\ b_{N-1} $

 答えを一行に出力せよ。 ```

4
1 2
2 3
3 4
```

```

4
```

```

8
1 2
4 6
6 7
3 2
2 4
4 5
8 6
```

```

752
```

## 说明/提示

### Constraints

 頂点 1 から頂点 $ N $ までが紙が描かれている。すぬけ君は、頂点 $ a_i $ と頂点 $ b_i $ の間に辺を描き、木にすることにした。木を書いている途中で常に辺が連結になっているようにしたいとき、辺を描く順番は何通り考えられるか、mod 1,000,000,007 で求めよ。

- - - - - -

- $ 2\ <\ =\ N\ <\ =\ 1000 $
- $ 1\ <\ =\ a_i,\ b_i\ <\ =\ N $
- The input will represent a tree.



---

---
title: "席が足りない"
layout: "post"
diff: 提高+/省选-
pid: AT_tenka1_2012_7
tag: []
---

# 席が足りない

## 题目描述

[problemUrl]: https://atcoder.jp/contests/tenka1-2012-qualB/tasks/tenka1_2012_7

 急成長中のK社は、ハイペースで採用しすぎて席が足りなくなってしまいました。  
 次のオフィスの移転先は決まっているのですが、それまでは少ない席をやりくりしないといけません。

 幸い、社員の生活リズムがバラバラなので、ある人が退社したあとに別の人が出社するなら席をシェアすることにしました。  
 しかし、出社から退社まで席を移動しないようにしたいです。

 また、プロジェクトごとにまとまって座りたいと考えています。  
 プロジェクトの社員全員がそのプロジェクトに割り当てられた席に座り、  
 それ以外の社員がそのプロジェクトに割り当てられた席に座ることがないようにしたいです。

 あるプロジェクトの社員それぞれの出社時間と退社時間が与えられるので、  
 そのプロジェクトには最低何席割り当てる必要があるかを求めてください。

 入力は以下の形式で標準入力から与えられる。 > $ N $ $ Ts_1 $ $ Te_1 $ $ Ts_2 $ $ Te_2 $ : : $ Ts_N $ $ Te_N $

- 入力は $ N+1 $ 行ある。
- $ 1 $ 行目には、社員数を表す $ N $ ( $ 1\ \leq\ N\ \leq\ 15 $ ) が与えられる。
- $ 2 $ 行目からの $ N $ 行には $ i $ ( $ 1\ \leq\ i\ \leq\ N $ ) 番目の社員の出社時間 $ Ts_i $ ( $ 00:00\ \leq\ Ts_i\ \leq\ 23:59 $ ) と退社時間 $ Te_i $ ( $ Ts_i\ \lt\ Te_i\ \leq\ 35:59 $ ) が空白区切りとして与えられる。
- $ Te_i\ \geq\ 24:00 $ は翌日を意味する。
- 出社から退社までの時間が $ 24 $ 時間以上になることはない。
 
 プロジェクトの社員が少ない入力 ( $ 1\ \leq\ N\ \leq\ 8 $ ) のみ正解すると、$ 100 $ 点満点に対して部分点として $ 20 $ 点が与えられる。  
 また、すべての社員が $ 23:59 $ までに退社する入力 ( $ 1\ \leq\ i\ \leq\ N $ に対し $ Te_i\ \leq\ 23:59 $ ) のみ正解すると、$ 100 $ 点満点に対して部分点として $ 30 $ 点が与えられる。  
 上記 $ 2 $ 条件のいずれかを満たす入力すべてに正解すると、$ 100 $ 点満点に対して部分点として $ 50 $ 点が与えられる。 最低限プロジェクトに割り当てる必要のある座席の数を標準出力に $ 1 $ 行で出力せよ。  
 なお、行の終端には改行が必要である。 ```

3
10:00 12:00
12:00 14:00
14:00 18:00
```

 ```

1
```

- 出社時刻・退社時刻が同じ場合は席をシェアすることができる。
 
```

3
00:00 09:00
08:00 17:00
16:00 25:00
```

- $ 25:00 $ は翌日 $ 01:00 $ を意味する。
- この場合、この $ 3 $ 人は席をシェアすることができない。
 
```

3
```

 ```

4
00:00 07:00
06:00 13:00
12:00 19:00
18:00 25:00
```

 ```

2
```



---

---
title: "敵対的引用"
layout: "post"
diff: 提高+/省选-
pid: AT_tenka1_2012_qualA_3
tag: []
---

# 敵対的引用

## 题目描述

你有 $N$ 个小组，每个小组的名字从「group1」到「group$N$」。这些小组之间有时会相互呼叫并引用彼此的发言。

当 group$A$ 对 group$B$ 是攻击性时：

- group$A$ 呼叫 group$B$ 时，会在名字末尾加一个 `w`，变成「group$B$w」。
- group$A$ 引用 group$B$ 的发言时，会用双引号把发言内容括起来，并在后面加上 `ww`，形成 `"...ww"`。

当 group$A$ 对 group$B$ 没有攻击性时：

- 呼叫 group$B$ 时，直接使用「group$B$」。
- 引用 group$B$ 的发言时，仅用双引号括起发言内容，不加附加内容，表现为 `"..."`。

例如：如果 group2 对 group1 是攻击性的，那么 group2 会说 `group1w`。如果 group3 对 group2 也是攻击性的，那么 group3 会说 `"group1w"ww`。若 group2 对 group3 没有攻击性，则 group2 会说 `group3`。若 group1 对 group2 没有攻击性，则 group1 会说 `"group3"`。

需要注意的是，有可能 group$A$ 对 group$B$ 是攻击性的，但 group$B$ 不对 group$A$ 攻击，甚至会有组自对自身攻击的情况。

给你一个发言，请判断哪些小组可能说出了这句话，并给出可能的小组数量。

## 输入格式

输入第一行包含两个整数 $N$ 和 $M$，分别表示小组的总数和敌对关系的数量。这一行的格式是：

```
N M
```

之后的 $M$ 行，每行两个整数 $a_i$ 和 $b_i$，表示小组 $a_i$ 对小组 $b_i$ 是攻击性的，其格式为：

```
a_1 b_1
a_2 b_2
...
a_M b_M
```

接下来最后一行是一个字符串 $s$，代表某小组的发言内容：

```
s
```

## 输出格式

输出一个整数，表示可能发出该发言的小组数量。

## 说明/提示

- $1 \leq N \leq 10^5$
- $1 \leq M \leq 10000$
- $1 \leq a_i, b_i \leq N$
- 字符串 $s$ 的长度不超过 $300$
- 至少有一个小组可能发出的发言

在小组数量小的情况下（$1 \leq N \leq 100$），正确解答这些情况即可获得部分分数（50分）。

 **本翻译由 AI 自动生成**



---

---
title: "天下一二三パズル"
layout: "post"
diff: 提高+/省选-
pid: AT_tenka1_2013_qualA_c
tag: []
---

# 天下一二三パズル

## 题目描述

[problemUrl]: https://atcoder.jp/contests/tenka1-2013-quala/tasks/tenka1_2013_qualA_c

 ![](https://cdn.luogu.com.cn/upload/vjudge_pic/AT_tenka1_2013_qualA_c/7e406069f12e803b96ea491d6c13225894258dcf.png)図 $ 2 $

 

 ![](https://cdn.luogu.com.cn/upload/vjudge_pic/AT_tenka1_2013_qualA_c/40b9d5d20950b80c3e734ad236cabd4619d6ee60.png)図 $ 3 $

 

 $ 2 $ を配置する場合は $ 2 $ マス以上空いていなければならない。

 ![](https://cdn.luogu.com.cn/upload/vjudge_pic/AT_tenka1_2013_qualA_c/98e7f7f0b2f0c64325eea43fd27eeee89b778034.png)図 $ 4 $

 

 入力は以下の形式で標準入力から与えられる。

> $ M $ $ N $

- 横方向のマスの数 $ M $ と 縦方向のマスの数 $ N $ ( $ 1\ \leq\ M,\ N\ \leq\ 10^6 $ ) が空白区切りで $ 1 $ 行で与えられる。

- $ M,\ N\ \leq\ 4 $ の入力に正解すると、120 点満点に対して部分点として 40 点が与えられる。
- $ M,\ N\ \leq\ 100 $ の入力に正解すると、120 点満点に対して部分点として、さらに 20 点が与えられる。

 数字の配置の仕方が何通りあるかを標準出力に $ 1 $ 行で出力せよ。  
 なお、行の終端には改行が必要である。

 ```

1 1
```

 ```

3
```

 ```

3 1
```

 ```

8
```



---

---
title: "天下一最短路コンテスト"
layout: "post"
diff: 提高+/省选-
pid: AT_tenka1_2013_qualB_e
tag: []
---

# 天下一最短路コンテスト

## 题目描述

[problemUrl]: https://atcoder.jp/contests/tenka1-2013-qualb/tasks/tenka1_2013_qualB_e

 あなたは、天下一最短路コンテストの運営者です。  
 天下一最短路コンテストでは、以下のようなルールで開催されます。

- 二次元平面上に $ N $ $ (\ 1\ ≦\ N\ ≦\ 100) $ 個の点 $ p_i $ $ (\ 1\ ≦\ i\ ≦\ N\ ) $ が与えられます 
  - 点 $ p_i $ の$ x $ 座標は $ x_i $ で $ y $ 座標は $ y_i $ です
  - 点の数 $ N $ は最大 $ 100 $ 個です
  - 各座標の値 $ x_i $, $ y_i $ は全て $ 10,000 $ 以下の非負の整数です
  - 全ての点の座標は異なります。つまり、$ i\ ≠\ j $ のとき、$ (x_i,\ y_i)\ ≠\ (x_j,\ y_j) $ を満たします
- $ p_1 $ から始まり、全ての点を通る経路を出力します
- 経路の長さが最も短い人の勝ちです

 高橋君は、天下一最短路コンテストに出場しようとしていますが、ライバルである、KLabのスーパープログラマー、タクヤ君に勝てる気がしません。タクヤ君のプログラムは、オープンソースとして公開されていたので、これを改造することで、コンテストに勝とうと考えました。

 タクヤ君のプログラムは、以下のようなプログラムです。

- 最初に点 $ p_1 $ を選び、まだ選んでいない点が存在する間、以下の手順で点を選ぶ
- 最後に選んだ点から、最も近い、まだ選んでいない点を選ぶ
- 最も近い点が複数ある場合は、その中でidが一番小さいものを選ぶ（点 $ p_i $ のidは $ i $ ）

- 点を選ばれた順番に、線分で結んで、それを経路として出力する

 このプログラムを、高橋君が改造した結果、以下のようになりました。

- 最初に点 $ p_1 $ を選び、まだ選んでいない点が存在する間、以下の手順で点を選ぶ
- まだ選んでいない点が $ 3 $ つ以上ある場合、最後に選んだ点から $ 2 $ 番目に近い点を選ぶ
- この際、最も近い点が、最後に選んだ点と $ 2 $ 番目に近い点とを結ぶ線分の上にあったとしても、最も近い点は選ばれたとみなされない

- まだ選んでいない点が $ 2 $ つ以下の場合、最後に選んだ点から最も近い点を選ぶ 
  - 最も近い点が選ばれるのは、最後の $ 1 $ 回ではなく、 $ 2 $ 回であることに注意してください
- 同じ距離の点が複数ある場合は、idの小さいものほど近い点であるとみなす

- 点を選ばれた順番に、線分で結んで、それを経路として出力する

 この $ 2 $ つのプログラムを戦わせてみたところ、殆どの場合で、高橋君が負けてしまいます。ですが、このままだと高橋君が可哀想なので、高橋君が引き分け以上の結果を残せる入力を１つだけ用意することにしました。  
 あなたは、高橋君が引き分け以上の結果を出す、可能な限り頂点数の多いデータセットを作らなければいけません。

 入力は与えられない。 高橋君が引き分け以上の結果を出すことができるデータセットを出力しなさい。出力は以下の形式で行う。  
> $ N $ $ x_1 $ $ y_1 $ $ x_2 $ $ y_2 $ : $ x_N $ $ y_N $

   
1. $ 1 $行目には、データセットの頂点数 $ N\ (1≦N≦100) $ を $ 1 $ 行で出力する
2. $ 2 $行目には、各点の $ x $ 座標 $ x_i $、$ y $ 座標 $ y_i $を、$ x_i $ $ y_i $の順でスペース区切りに、$ N $行で出力する $ (\ 0\ ≦\ x_i,\ y_i\ ≦\ 10,000) $
3. 条件を満たすデータセットであれば、$ N×2 $点の点数が得られます。
 
 二つのプログラムの出力する経路の長さの、絶対的な差または相対的な差が $ 10^{-9} $以下であれば、二つのプログラムは引き分けとみなす。  
 つまり、二つのプログラムの出力する経路の長さがそれぞれ$ d_1 $, $ d_2 $であるとき、$ \frac{|d_1\ -\ d_2|}{{\rm\ max}(1,\ d_1,\ d_2)}\ ≦\ 10^{-9} $であれば、引き分けとみなす。  
 また、出力の最後には改行をいれること。   
 なお、あらかじめ計算して出力した結果を、そのまま提出しても良い。その場合は、使用言語にText(cat)を選択して提出すること。  
```

1
1 1
```

- 点が $ 1 $ 個の時、どちらのプログラムも出力する経路の長さは $ 0 $ となり、引き分けとなります
- この出力を提出すると、 $ 2 $ 点を得ることが出来ます
 
```

5
4 6
2 5
6 10
1 2
1 6
```

- タクヤ君のプログラムが求める経路は、 $ (4,6)\ →\ (2,5)\ →\ (1,6)\ →\ (1,2)\ →\ (6,10) $であり、この経路の長さは約$ 17.084 $です
 ![](https://cdn.luogu.com.cn/upload/vjudge_pic/AT_tenka1_2013_qualB_e/e3a188bf2c19d137a39673f73d7874c0043d2fc1.png)図 $ 1 $タクヤ君のプログラムの経路

 

- 高橋君のプログラムが求める経路は、 $ (4,6)\ →\ (1,6)\ →\ (1,2)\ →\ (2,5)\ →\ (6,10) $であり、この経路の長さは約$ 16.565 $です
 ![](https://cdn.luogu.com.cn/upload/vjudge_pic/AT_tenka1_2013_qualB_e/c0ac09c104567967ebe2486f46e232f9268d35b6.png)図 $ 2 $高橋君のプログラムの経路

 

- この出力を提出すると、 $ 10 $ 点を得ることができます



---

---
title: "天下一文字列集合"
layout: "post"
diff: 提高+/省选-
pid: AT_tenka1_2014_qualA_c
tag: []
---

# 天下一文字列集合

## 题目描述

[problemUrl]: https://atcoder.jp/contests/tenka1-2014-quala/tasks/tenka1_2014_qualA_c

 英小文字 (`a`～`z`) と、英小文字 $ 1 $ 文字と一致するワイルドカード (`*`) からなる $ m $ 文字の文字列のパターンが $ n $ 個与えられる。  
 この文字列のパターンは、 $ m $ 文字の英小文字からなる文字列の集合 $ X $ のいずれかの要素に一致するようにように作られたものである。

 集合 $ X $ の要素数の最小値を求めよ、ダイキ君。

## 输入格式

 入力は、以下の形式で標準入力から与えられる。

> $ n $ $ m $ $ P1 $ $ P2 $ : $ Pn $

 $ 1 $ 行目に文字列のパターンの数を表す整数 $ n $( $ 1\ ≦\ n\ ≦\ 14 $ ) と文字列の長さを表す整数 $ m $( $ 1\ ≦\ m\ ≦\ 100000 $ ) が与えられる。 その後、長さ $ m $ の文字列のパターン $ P_i $ が $ n $ 行で与えられる。

## 输出格式

 集合 $ X $ としてありうる要素数のうち最小の値を1行で出力せよ。 なお、行の終端には改行が必要である。

## 说明/提示

### 部分点

- $ 1\ ≦\ n\ ≦\ 4 $, $ 1\ ≦\ m\ ≦\ 4 $ の全てのテストケースに正解した場合、部分点として20点が与えられる
- $ 1\ ≦\ n\ ≦\ 14 $, $ 1\ ≦\ m\ ≦\ 10 $ の全てのテストケースに正解した場合、部分点としてさらに30点が与えられる

### Sample Explanation 1

集合 $ X $ の例としては、 ``` axxb oocb ``` がありうる。

## 样例 #1

### 输入

```
5 4

a*x*

*xx*

*x*b

**cb

****
```

### 输出

```
2
```



---

---
title: "EMLauncher"
layout: "post"
diff: 提高+/省选-
pid: AT_tenka1_2014_qualA_d
tag: []
---

# EMLauncher

## 题目描述

在天下一王国，测试一种新开发的高科技武器——电磁炮（ElectroMagneticLauncher）。测试的目标是击穿所有摆放在场地上的 $N$ 块铁板。理论上，电磁炮的威力足以穿透任意多的障碍物，但每次发射都会消耗大量的电力。因此，如何计算出最少的发射次数来破坏所有障碍物成了大辉君的任务。炮座可以调整方向朝任意方向发射。

为了便于分析，障碍物可以看作平面坐标系中的线段，电磁炮则位于原点 $(0, 0)$。每次发射形成的弹体轨迹可以看作从原点射出的半直线，能摧毁所有与之相交或接触的障碍物。

![示例图1](https://cdn.luogu.com.cn/upload/vjudge_pic/AT_tenka1_2014_qualA_d/6a5ff3641aef0d30c564cd709021ee34455ab3c1.png)    
图中射击红线方向，两次可完成任务。  

![示例图2](https://cdn.luogu.com.cn/upload/vjudge_pic/AT_tenka1_2014_qualA_d/0ccec9447ed19fe00a3e6c343d2930518e7cbe3e.png)  
因为两块障碍物接触到红线，一次射击即完成任务。

![示例图3](https://cdn.luogu.com.cn/upload/vjudge_pic/AT_tenka1_2014_qualA_d/385613489f79ded586b561a6d78091e64651687e.png)  
图中射击红线方向，需四次射击完成任务。

## 输入格式

输入包括以下信息：

- 第一行是一个整数 $N$，表示障碍物的数量，满足 $1 \leq N \leq 2000$。
- 接下来的 $N$ 行，每行有四个整数，分别是每个障碍物的两个端点坐标：$(X_{i,1}, Y_{i,1})$ 和 $(X_{i,2}, Y_{i,2})$，它们满足 $-1000 \leq X_{i,1}, Y_{i,1}, X_{i,2}, Y_{i,2} \leq 1000$。
- 这些障碍物（包括端点）不会碰到原点，也不会相互交叉或接触。

## 输出格式

输出一个整数，表示击穿所有障碍物所需的最小发射次数。输出需要换行。

## 说明/提示

- 当 $N \leq 20$ 时，通过所有测试可得 $45$ 分。
- 当 $N \leq 200$ 时，通过所有测试可再得 $40$ 分。

 **本翻译由 AI 自动生成**

## 样例 #1

### 输入

```
2

10 10 10 -10

-10 10 -10 -10
```

### 输出

```
2
```

## 样例 #2

### 输入

```
2

5 -10 5 0

10 0 10 10
```

### 输出

```
1
```

## 样例 #3

### 输入

```
8

1 5 6 1

6 -1 1 -6

-1 -6 -5 -1

-5 1 -1 5

7 5 7 -6

-5 -7 6 -7

-6 -6 -6 5

-5 6 6 6
```

### 输出

```
4
```



---

---
title: "天下一王国の歴史"
layout: "post"
diff: 提高+/省选-
pid: AT_tenka1_2014_qualB_c
tag: []
---

# 天下一王国の歴史

## 题目描述

正在学习天下一王国历史的Tomoki正在调查曾经统治王国的伟大英雄HAGIXILE。

HAGIXILE以其奇异行为而闻名。他将王国的领土分割成了一个 $ N\ \times\ N $ 的方格板，将其分为白色格子和黑色格子。

白色格子代表当年要巡游的区域，黑色格子代表当年不巡游的区域。

这些格子的颜色会随时间变化。颜色是根据前一年的格子颜色重新涂上去的。

对于一个格子来说，如果其相邻的上下左右四个格子中，原来是黑色的格子的数量为偶数，则该格子在重新涂色后将变成白色，如果为奇数，则变成黑色。

与角相邻的格子有 2 个，与边上的格子（不包括角）相邻的格子有 3 个，其他格子有 4 个相邻的格子。

例如，用 $ . $ 表示白色格子，用 $ # $ 表示黑色格子，如果某一年的方格板如下所示，

 ```
<pre class="linenums">
.#.
.##
.#.
```

那么第二年将会被重新涂上如下颜色。

 ```
<pre class="linenums">
##.
###
##.
```

Tomoki 发现了史书中记载的最古老的方格板，并想要恢复出重新涂色之前的方格板。

给定最古老的方格板，请输出可能的重新涂色之前的方格板。然而，要保证存在至少一个这样的可能的重新涂色之前的方格板。

## 输入格式

从标准输入中按以下格式读入数据。

> $ N $ $ C1,1C1,2..C1,N $ $ C2,1C2,2..C2,N $ : $ CN,1CN,2..CN,N $

- 第一行有一个整数 $ N\ (1\ \leq\ N\ \leq\ 750) $ ，表示方格板的列数和行数。
- 第二行到第 $ N $ 行，每行包含 $ N $ 个整数，表示第 $ i $ 行第 $ j $ 列的格子颜色 $ Ci,j\ (1\ \leq\ i,\ j\ \leq\ N) $。
- 白色格子用 $ . $ 表示，黑色格子用 $ # $ 表示。
- 给定的方格板中，至少存在一个可能的重新涂色之前的方格板。

## 输出格式

请在一行中输出给定方格板重新涂色之前的颜色，每行包含 $ N $ 个字符。请确保输出的最后包含一个换行符。

### 样例 #1

#### 样例输入 #1

```
3
##.
###
##.
```

#### 样例输出 #1

```
.#.
.##
.#.
```

### 样例 #2

#### 样例输入 #2

```
5
.....
.....
.....
....#
...#.
```

#### 样例输出 #2

```
.....
.....
.....
.....
....#
```

### 样例 #3

#### 样例输入 #3

```
10
#...#.#.#.
.####.#..#
##..###..#
#...###...
.#.#.##...
..##.##..#
######..#.
.#.....#..
.#...#####
..##...###
```

#### 样例输出 #3

```
##########
....#.#.##
#..#.#.#.#
#.#..#..#.
..........
####..#.#.
#.#.#.#...
....####..
####..#.#.
##.#.#..#.
```

## 说明/提示

#### 部分情况

- 如果能够正确解决 $ 1\ \leq{}\ N\ \leq{}\ 3 $ 的情况，则可以得到 25 分。
- 如果能够正确解决 $ 1\ \leq{}\ N\ \leq{}\ 9 $ 的情况，则可以额外得到 30 分。


对于输出的方格板中的第一行第一列的格子，它的上面和左边都没有格子。右边的格子是 $ # $。下面的格子是 $ . $。第一行第一列的格子的上下左右的格子中，$ # $ 的数量为 1，是奇数，所以重新涂色后的颜色是 $ # $。同理，对于输出的方格板中的第一行第二列的格子，它的上面和左边都没有格子。右边的格子是 $ . $。下面的格子是 $ # $。$ # $ 的数量为 1，是奇数，所以重新涂色后的颜色是 $ # $。同样，对于输出的方格板中的第一行第三列的格子，它的上面和左边都没有格子。右边的格子是 $ # $。下面的格子是 $ # $。$ # $ 的数量为 2，是偶数，所以重新涂色后的颜色是 $ . $。对于所有的格子都进行这样的重新涂色操作，就能得到输入的方格板的颜色，因此是正确答案。

## 样例 #1

### 输入

```
3

##.

###

##.
```

### 输出

```
.#.

.##

.#.
```

## 样例 #2

### 输入

```
5

.....

.....

.....

....#

...#.
```

### 输出

```
.....

.....

.....

.....

....#
```

## 样例 #3

### 输入

```
10

#...#.#.#.

.####.#..#

##..###..#

#...###...

.#.#.##...

..##.##..#

######..#.

.#.....#..

.#...#####

..##...###
```

### 输出

```
##########

....#.#.##

#..#.#.#.#

#.#..#..#.

..........

####..#.#.

#.#.#.#...

....####..

####..#.#.

##.#.#..#.
```



---

---
title: "ほぼピタゴラスの三角形"
layout: "post"
diff: 提高+/省选-
pid: AT_tenka1_2015_final_d
tag: []
---

# ほぼピタゴラスの三角形

## 题目描述

[problemUrl]: https://atcoder.jp/contests/tenka1-2015-final/tasks/tenka1_2015_final_d

ヨシオくんは次のような三角形を「ほぼピタゴラスの三角形」と呼ぶことにしました。

- 辺の長さ $ a,\ b,\ c $ が全て自然数
- $ gcd\ (a,\ b,\ c)\ =\ 1 $
- $ a\ \leq\ b\ \leq\ c $
- $ a^2\ +\ b^2\ +\ s^2\ =\ c^2 $

しかし、ヨシオくんには「ほぼピタゴラスの三角形」が何個あるのか見当がつきません。

周長の上限 $ L $ および $ s $ が与えられるので、ヨシオくんに代わり、「ほぼピタゴラスの三角形」の個数を数えてください。

## 输入格式

入力は以下の形式で標準入力から与えられます。

> $ L $ $ s $

- 三角形の周長 $ a\ +\ b\ +\ c $ の上限を表す整数 $ L $ ( $ 1\ \leq\ L\ \leq\ 10^8 $ ) と $ s $ ( $ 1\ \leq\ s\ \leq\ 50 $ ) が空白区切りで与えられます。

## 输出格式

条件を満たす三角形の個数を $ 1 $ 行で出力してください。

出力の末尾には改行を入れてください。

## 说明/提示

### 配点

この問題には部分点が設定されています。

- $ L\ \leq\ 10000 $ を満たすテストケース全てに正解した場合は、$ 60 $ 点が与えられます。
- 全てのテストケースに正解した場合は、上記とは別に $ 140 $ 点が与えられます。

### Sample Explanation 1

条件を満たす三角形は $ (2,2,3) $ と $ (4,8,9) $ です。

### Sample Explanation 2

条件を満たす三角形は $ (6,6,11) $ のみです。

## 样例 #1

### 输入

```
30 1
```

### 输出

```
2
```

## 样例 #2

### 输入

```
50 7
```

### 输出

```
1
```



---

---
title: "根付き木のみさわさん"
layout: "post"
diff: 提高+/省选-
pid: AT_tenka1_2015_final_f
tag: []
---

# 根付き木のみさわさん

## 题目描述

[problemUrl]: https://atcoder.jp/contests/tenka1-2015-final/tasks/tenka1_2015_final_f

高橋君の家の庭には、頂点 $ 1 $ を根とする一本の根付き木である、みさわさんが生えています。

$ i $ 日目の朝、みさわさんは $ M_i $ 個の頂点 $ v_{i,1},\ …,\ v_{i,M_i} $ に実をつけます。

しかし、同じ日の晩には鳥がやってきて、残っているすべての実を食べてしまいます。

高橋君は、一日に一回、みさわさんの頂点をひとつ選んでゆさぶることができます。

頂点 $ w $ をゆさぶると、$ w $ の子孫 ($ w $ 自身も含む) である頂点についている実をすべて得られます。

高橋君は、 $ i $ 日目に、みさわさんから $ K_i $ 個以上の実を取りたいです。

高いところが好きな高橋君のために、ゆさぶることで $ K_i $ 個以上の実を得ることができる頂点のうち、根からもっとも遠いものをもとめ、その根からの距離を教えてください。

ただし、各頂点に対し、根からの距離とは、根からその頂点への唯一の単純なパスに含まれる辺の数を表します。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ a_1 $ $ b_1 $ $ a_2 $ $ b_2 $ : $ a_{N-1} $ $ b_{N-1} $ $ Q $ $ M_1 $ $ K_1 $ $ v_1_1 $ $ v_1_2 $ ... $ v_1_{M_1} $ : $ M_Q $ $ K_Q $ $ v_Q_1 $ $ v_Q_2 $ ... $ v_Q_{M_Q} $

- $ 1 $ 行目には、みさわさんの頂点の個数を表す整数 $ N $ ($ 3≦N≦10^5 $) が与えられる。
- $ 2 $ 行目からの $ N-1 $ 行のうち $ i $ 行目には、$ i $ 番目の辺の接続している $ 2 $ 頂点を表す整数 $ a_i,b_i $ ($ 1≦a_i＜b_i≦N $) が空白区切りで与えられる。 
  - このとき、みさわさんが木であることが保証されている。
- $ N+1 $ 行目には、高橋君が実を取りつづける日数を表す整数 $ Q\ (1≦Q≦10^5) $ が与えられる。
- $ N+2 $ 行目からの $ 2Q $ 行のうち、 
  - $ 2i-1 $ 行目には、$ i $ 日目にみさわさんがつける実の数を表す整数 $ M_i $ と、高橋君が取りたい実の数を表す整数 $ K_i $ ($ 1\ ≦\ K_i\ ≦\ M_i\ ≦\ N $) が与えられ、
  - $ 2i $ 行目には、$ i $ 日目にみさわさんが実をつける頂点を表す $ M_i $ 個の整数が与えられる。
- 但し、入力は $ ΣM_i\ ≦\ 10^5 $ をみたす。

## 输出格式

$ Q $ 日分の入力について、条件を満たす頂点のうち、根からもっとも遠い頂点までの距離を、 $ 1 $ 行ずつ出力せよ。 出力の末尾には改行を入れること。

## 说明/提示

### 部分点

この問題には部分点が設定されている。

- $ 1≦N≦100 $ を満たすデータセットに正解した場合は $ 20 $ 点が得られる。
- 全てのデータセットに正解した場合はさらに $ 110 $ 点が得られる。合計で $ 130 $ 点となる。

### Sample Explanation 1

\- $ 1 $ つ目のクエリでは、みさわさんは $ 2 $ つの頂点 $ 4,5 $ に実をつけます。このうち $ 2 $ つの実を得られる頂点のうち、もっとも根から遠い頂点は $ 3 $ であり、この頂点の根からの距離は $ 2 $ です。 - $ 2 $ つ目のクエリでは、みさわさんは $ 1 $ つの頂点 $ 1 $ に実をつけます。このうち $ 1 $ つの実を得られる頂点のうち、もっとも根から遠い頂点は $ 1 $ であり、この頂点の根からの距離は $ 0 $ です。 - $ 3 $ つ目のクエリでは、みさわさんは $ 2 $ つの頂点 $ 2,1 $ に実をつけます。このうち $ 1 $ つの実を得られる頂点のうち、もっとも根から遠い頂点は $ 2 $ であり、この頂点の根からの距離は $ 1 $ です。

## 样例 #1

### 输入

```
5

3 5

1 2

2 3

3 4

3

2 2

4 5

1 1

1

2 1

2 1
```

### 输出

```
2

0

1
```

## 样例 #2

### 输入

```
10

4 10

2 3

1 4

1 2

3 5

1 8

4 6

8 9

2 7

5

10 4

9 7 3 1 5 10 4 6 2 8

2 2

8 2

10 9

6 2 10 4 7 1 5 8 9 3

2 2

10 2

5 1

1 7 2 3 9
```

### 输出

```
1

0

0

0

2
```

## 样例 #3

### 输入

```
15

3 4

4 6

11 13

2 6

4 8

7 13

4 7

8 9

1 8

5 9

8 15

9 14

8 12

9 10

5

14 5

5 1 13 8 14 3 2 9 7 10 11 4 12 15

5 5

6 8 12 2 11

1 1

12

12 8

2 13 1 10 12 3 8 9 6 4 7 15

10 8

8 14 13 12 15 10 7 5 2 4
```

### 输出

```
2

1

2

1

1
```



---

---
title: "stepモード"
layout: "post"
diff: 提高+/省选-
pid: AT_tenka1_2015_qualA_b
tag: []
---

# stepモード

## 题目描述

[problemUrl]: https://atcoder.jp/contests/tenka1-2015-quala/tasks/tenka1_2015_qualA_b

 アンドウくんは、 $ N $ 個のスクリプトを実行し、実行開始時刻と実行終了時刻を記録しました。  
 しかしこの日、アンドウくんの時計は $ 1000 $ ミリ秒巻き戻るという事象が一度発生しました。  
 もしかすると、スクリプトの実行時間がわからなくなってしまったかもしれません。

 実行開始時刻と実行終了時刻のリストが与えられるので、各スクリプトの実行時間を計算し、ミリ秒単位で出力してください。  
 ただし、以下の点に注意してください。

- 実行時間が一意に定まらないスクリプトに対しては`-1`を出力してください。
- スクリプトの実行時間はいずれも $ 1 $ ミリ秒以上でした。
- 巻き戻りは瞬間的な事象であり、巻き戻りにかかる時間は $ 0 $ ミリ秒です。
- 実行開始時刻と実行終了時刻について丸めは起こらないものとし、実行開始時刻と実行終了時刻のミリ秒未満の位の値はすべて $ 0 $ であるとします。  
   つまり、実行開始時刻および実行終了時刻をミリ秒単位で表した値 $ t $ に関して、 $ t $ は整数であることが分かっています。
- 巻き戻りの発生時刻のミリ秒未満の値は $ 0 $ ではありません。  
   つまり、巻き戻りの発生時刻をミリ秒単位で表した値 $ r $ に関して、 $ r $ は整数**でないこと**が分かっています。  
   よって、巻き戻りの発生時刻は、実行開始時刻および実行終了時刻と同時刻ではありません。
- 夏時間はありません。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ S_1 $ $ E_1 $ : $ S_N $ $ E_N $

- スクリプトの数 $ N $ ( $ 1\ \leq{}\ N\ \leq{}\ 100 $ ) が $ 1 $ 行で与えられる。
- 続く $ N $ 行には各スクリプトの実行の開始時刻 $ S_i $ と終了時刻 $ E_i $ が空白区切りで与えられる。
- $ S_i $, $ E_i $ の形式は、`HH:MM:SS.mmm`である。ただし、 `H`, `M`, `S`, `m` は数字 $ 1 $ 文字を表す。  
   また、 `21`$ {}\leq{} $`HH`$ \leq $`22`, `00`$ {}\leq{} $`MM`$ \leq $`59`, `00`$ {}\leq{} $`SS`$ \leq $`59`, `000`$ {}\leq{} $`mmm`$ \leq $`999` である。
- $ 2 $ 回以上巻き戻りが発生するといった、問題の条件を満たさない入力は与えられない。

## 输出格式

スクリプトの実行時間をミリ秒単位で $ N $ 行に出力せよ。

ただし、実行時間が一意に定まらないスクリプトに対しては`-1`を出力せよ。

出力の末尾に改行を入れること。

## 说明/提示

### 配点

この問題には部分点が設定されていない。全てのテストケースに正解した場合は、 $ 50 $ 点が与えられる。

### Sample Explanation 1

スクリプトの終了時刻が開始時刻より前になっているので、実行中に巻き戻りが発生したことが分かります。

### Sample Explanation 2

スクリプトの実行中に巻き戻りが発生したかどうか特定できません。 発生していた場合は $ 4000 $ ミリ秒、発生していなかった場合は $ 3000 $ ミリ秒になります。

### Sample Explanation 3

$ 2 $ つ目のスクリプトから、巻き戻り前の時間軸で`21:00:01.500`より後、`21:00:02.000`より前に巻き戻ったことが分かります。 !\[\](http://tenka1.klab.jp/2015/images/b7f72704a8bc78d22cb2ccb26a88375c431c7532.png)

### Sample Explanation 4

入力例3と同様に、 $ 2 $ つ目のスクリプトから、巻き戻り前の時間軸で`21:00:01.500`より後、`21:00:02.000`より前に巻き戻ったことが分かります。 しかし、$ 3 $つ目のスクリプトの終了時刻が、巻き戻り前の時間軸での記述なのか巻き戻った後の記述なのかの判断ができません。

## 样例 #1

### 输入

```
1

21:00:01.500 21:00:01.000
```

### 输出

```
500
```

## 样例 #2

### 输入

```
1

22:00:00.000 22:00:03.000
```

### 输出

```
-1
```

## 样例 #3

### 输入

```
3

21:00:00.000 21:00:03.000

21:00:01.500 21:00:01.000

21:00:02.000 21:00:02.500
```

### 输出

```
4000

500

500
```

## 样例 #4

### 输入

```
3

21:00:00.000 21:00:03.000

21:00:01.500 21:00:01.000

21:00:00.500 21:00:01.000
```

### 输出

```
4000

500

-1
```



---

---
title: "天下一美術館"
layout: "post"
diff: 提高+/省选-
pid: AT_tenka1_2015_qualA_c
tag: []
---

# 天下一美術館

## 题目描述

[problemUrl]: https://atcoder.jp/contests/tenka1-2015-quala/tasks/tenka1_2015_qualA_c

天下一美術館のセト館長は、新コーナーの白黒のモザイクアートコーナーのレイアウトを決めることになりました。

見栄えを良くするためには、隣同士に並ぶ各アートは似ているものにしたいと考えています。

そこでセト館長の２つのアート同士の相違度を定義することにしました。

モザイクアートは白か黒に塗られた $ M\ \times\ N $ のマス目です。

一方のモザイクアートを他方のモザイクアートに変換する操作を考え、その操作に必要な最小のコストを相違度とします。

操作は、黒マスから白マスへの変換、白マスから黒マスへの変換、上下左右の4方向に隣り合ったマス目の交換の3種類あり、どれもコストが$ 1 $かかります。

セト館長のために与えられた2つのモザイクアートの相違度を求めるプログラムを作成してください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ M $ $ N $ $ A_{1,1} $ $ A_{1,2} $ … $ A_{1,N} $ $ A_{2,1} $ $ A_{2,2} $ … $ A_{2,N} $ : $ A_{M,1} $ $ A_{M,2} $ … $ A_{M,N} $ $ B_{1,1} $ $ B_{1,2} $ … $ B_{1,N} $ $ B_{2,1} $ $ B_{2,2} $ … $ B_{2,N} $ : $ B_{M,1} $ $ B_{M,2} $ … $ B_{M,N} $

- $ 1 $ 行目には絵の縦幅 $ M $ ( $ 1\ \leq\ M\ \leq\ 70 $ ) と、絵の横幅 $ N $ ( $ 1\ \leq\ N\ \leq\ 70 $ ) が空白区切りで与えられる。
- $ 2 $ 行目から $ M $ 行には $ 1 $ 番目のモザイクアートが与えられる。  
   各行には各マスの色 $ A_{i,j} $ が空白区切りで $ N $ 個与えられる。  
   $ 1 $ 番目のモザイクアートの $ i $ 行目 $ j $ 列目のマスが黒マスの場合は $ A_{i,j}\ =\ 0 $ であり、白マスの場合は $ A_{i,j}\ =\ 1 $ である。
- $ M+2 $ 行目から $ M $ 行には $ 2 $ 番目のモザイクアートが与えられる。  
   各行には各マスの色 $ B_{i,j} $ が空白区切りで $ N $ 個与えられる。  
   $ 2 $ 番目のモザイクアートの $ i $ 行目 $ j $ 列目のマスが黒マスの場合は $ B_{i,j}\ =\ 0 $ であり、白マスの場合は $ B_{i,j}\ =\ 1 $ である。

## 输出格式

$ 2 $つのモザイクアート同士の相違度を$ 1 $行に出力せよ。出力の末尾に改行を入れること。

## 说明/提示

### 配点

この問題には部分点が設定されている。

- $ N,\ M\ \leq{}\ 10 $を満たすテストケース全てに正解した場合は、$ 40 $ 点が与えられる。
- 全てのテストケースに正解した場合は、上記とは別に $ 50 $ 点が与えられる。

### Sample Explanation 1

下の行に対してマス目の交換を行うことにより、コスト1で変換が可能です。

### Sample Explanation 2

白から黒への変換を1回、マス目の交換を3回行うことでコスト4で変換が可能です。

### Sample Explanation 3

白から黒への変換を2回、マス目の交換を1回行うことでコスト3で変換が可能です。

## 样例 #1

### 输入

```
2 2

0 0

1 0

0 0

0 1
```

### 输出

```
1
```

## 样例 #2

### 输入

```
3 3

0 0 0

0 1 0

1 0 1

0 1 0

1 0 1

0 1 0
```

### 输出

```
4
```

## 样例 #3

### 输入

```
3 4

0 0 0 0

1 1 0 0

0 0 0 0

1 1 1 0

0 1 0 0

0 0 0 0
```

### 输出

```
3
```



---

---
title: "擬二等辺三角形"
layout: "post"
diff: 提高+/省选-
pid: AT_tenka1_2015_qualB_c
tag: []
---

# 擬二等辺三角形

## 题目描述

[problemUrl]: https://atcoder.jp/contests/tenka1-2015-qualb/tasks/tenka1_2015_qualB_c

ニシモリ君は下記の $ 3 $ つの条件を満たす三角形を“擬二等辺三角形”と呼ぶことにしました。

- すべての辺の長さが整数である
- すべての辺の長さが異なる
- いずれかの二辺の長さの差が $ 1 $ となる

三角形の周長が $ L $ 以下となる擬二等辺三角形の個数を求め、$ 1000000007 $ で割った余りを出力して下さい。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ L $

- 最大の周長 $ L $ ( $ 5\ \leq\ L\ \leq\ 10^{12} $ ) が1行に与えられる。

## 输出格式

三角形の周長が $ L $ 以下となる擬二等辺三角形の個数を求め、 $ 1000000007 $ で割った余りを出力せよ。出力の末尾に改行を入れること。

## 说明/提示

### 配点

この問題には部分点が設定されている。

- $ L\leq\ 10^6 $ を満たすテストケース全てに正解した場合は、$ 25 $ 点が与えられる。
- 全てのテストケースに正解した場合は、上記とは別に $ 75 $ 点が与えられる。

## 样例 #1

### 输入

```
10
```

### 输出

```
1
```

## 样例 #2

### 输入

```
1100011
```

### 输出

```
251098945
```



---

---
title: "Knapsack Queries on a tree"
layout: "post"
diff: 提高+/省选-
pid: AT_tokiomarine2020_d
tag: []
---

# Knapsack Queries on a tree

## 题目描述

[problemUrl]: https://atcoder.jp/contests/tokiomarine2020/tasks/tokiomarine2020_d

$ N $ 頂点からなる根付き二分木があり、各頂点には $ 1 $ から $ N $ までの番号がついています。 頂点 $ 1 $ が根であり、頂点 $ i $ ($ i\ \geqq\ 2 $) の親は頂点 $ \left[\ \frac{i}{2}\ \right] $ です。

各頂点には $ 1 $ つのアイテムがあります。頂点 $ i $ にあるアイテムの価値は $ V_i $ であり、重さは $ W_i $ です。 そこで、次のクエリに $ Q $ 回答えてください。

- 二分木の頂点 $ v $ 及び正の整数 $ L $ が与えられる。 $ v $ 及び $ v $ の先祖にあるアイテムを、重さの合計が $ L $ 以下となるようにいくつか（$ 0 $ 個でもよい）選ぶ。 このとき、選んだアイテムの価値の総和の最大値を求めよ。

ただし、頂点 $ u $ が頂点 $ v $ の先祖であるとは、頂点 $ u $ が頂点 $ v $ の間接的な親である、つまり、 $ w_1=v $、$ w_k=u $、さらに各 $ i $ について $ w_{i+1} $ が $ w_i $ の親となるような頂点の列 $ w_1,w_2,\ldots,w_k $ ($ k\geqq\ 2 $) が存在することを指します。

## 输入格式

$ i $ 回目のクエリで指定される $ v $, $ L $ をそれぞれ $ v_i $, $ L_i $ とする。 このとき、入力は以下の形式で標準入力から与えられる。

> $ N $ $ V_1 $ $ W_1 $ $ : $ $ V_N $ $ W_N $ $ Q $ $ v_1 $ $ L_1 $ $ : $ $ v_Q $ $ L_Q $

## 输出格式

$ 1 $ から $ Q $ までの各整数 $ i $ について、 $ i $ 回目のクエリに対する答えを $ i $ 行目に出力せよ。

## 说明/提示

### 制約

- $ 1\ \leqq\ N\ <\ 2^{18} $
- $ 1\ \leqq\ Q\ \leqq\ 10^5 $
- $ 1\ \leqq\ V_i\ \leqq\ 10^5 $
- $ 1\ \leqq\ W_i\ \leqq\ 10^5 $
- 各クエリで指定される $ v $, $ L $ は $ 1\ \leqq\ v\ \leqq\ N $, $ 1\ \leqq\ L\ \leqq\ 10^5 $ を満たす。
- 入力で与えられる値はすべて整数である。

### Sample Explanation 1

最初のクエリでは、選ぶことのできるアイテムは $ (V,W)=(1,2) $ なるアイテムのみであるので、 $ L=1 $ より $ 1 $ つもアイテムを選ぶことができません。 したがって、答えは $ 0 $ になります。 一方で $ 2 $ 番目のクエリでは、選ぶことのできるアイテムは $ (V,W)=(1,2) $ なるアイテムと $ (V,W)=(2,3) $ なるアイテムの $ 2 $ つであり、 $ L=5 $ より両方を選ぶことができます。 したがって、答えは $ 3 $ になります。

## 样例 #1

### 输入

```
3

1 2

2 3

3 4

3

1 1

2 5

3 5
```

### 输出

```
0

3

3
```

## 样例 #2

### 输入

```
15

123 119

129 120

132 112

126 109

118 103

115 109

102 100

130 120

105 105

132 115

104 102

107 107

127 116

121 104

121 115

8

8 234

9 244

10 226

11 227

12 240

13 237

14 206

15 227
```

### 输出

```
256

255

250

247

255

259

223

253
```



---

---
title: "Count Dividing XOR"
layout: "post"
diff: 提高+/省选-
pid: AT_toyota2023spring_final_c
tag: []
---

# Count Dividing XOR

## 题目描述

[problemUrl]: https://atcoder.jp/contests/toyota2023spring-final/tasks/toyota2023spring_final_c

整数 $ L,R $ が与えられます． 以下の条件を満たす整数の組 $ (A,B) $ の個数を数えてください．

- $ L\ \leq\ A\ <\ B\ \leq\ R $
- $ A $ は $ A\ \oplus\ B $ で割り切れる．
- $ B $ は $ A\ \oplus\ B $ で割り切れる．

ただしここで $ \oplus $ はビット単位 $ \mathrm{XOR} $ 演算を表します．

  ビット単位 $ \mathrm{XOR} $ 演算とは  非負整数 $ A,\ B $ のビット単位 $ \mathrm{XOR} $ 、$ A\ \oplus\ B $ は、以下のように定義されます。

- $ A\ \oplus\ B $ を二進表記した際の $ 2^k $ ($ k\ \geq\ 0 $) の位の数は、$ A,\ B $ を二進表記した際の $ 2^k $ の位の数のうち一方のみが $ 1 $ であれば $ 1 $、そうでなければ $ 0 $ である。
 
 例えば、$ 3\ \oplus\ 5\ =\ 6 $ となります (二進表記すると: $ 011\ \oplus\ 101\ =\ 110 $)。  
 一般に $ k $ 個の非負整数 $ p_1,\ p_2,\ p_3,\ \dots,\ p_k $ のビット単位 $ \mathrm{XOR} $ は $ (\dots\ ((p_1\ \oplus\ p_2)\ \oplus\ p_3)\ \oplus\ \dots\ \oplus\ p_k) $ と定義され、これは $ p_1,\ p_2,\ p_3,\ \dots,\ p_k $ の順番によらないことが証明できます。

## 输入格式

入力は以下の形式で標準入力から与えられる．

> $ L $ $ R $

## 输出格式

答えを出力せよ．

## 说明/提示

### 制約

- $ 1\ \leq\ L\ <\ R\ \leq\ 10^{18} $
- $ R-L\ \leq\ 10^6 $
- 入力される値はすべて整数である

### Sample Explanation 1

$ (A,B)=(4,5) $ と $ (A,B)=(4,6) $ が条件を満たします．

## 样例 #1

### 输入

```
3 6
```

### 输出

```
2
```

## 样例 #2

### 输入

```
1 100
```

### 输出

```
124
```

## 样例 #3

### 输入

```
999000000 1000000000
```

### 输出

```
1726239
```



---

---
title: "Inversion Numbers of Tree"
layout: "post"
diff: 提高+/省选-
pid: AT_ttpc2019_m
tag: []
---

# Inversion Numbers of Tree

## 题目描述

[problemUrl]: https://atcoder.jp/contests/ttpc2019/tasks/ttpc2019_m

$ 1 $ から $ N $ までの番号がつけられた $ N $ 個の頂点を持つ木があります。 この木の $ i $ 番目の辺は頂点 $ A_i $ と頂点 $ B_i $ を結んでいます。

この木に対し、頂点 $ r $ を根としたときの転倒数を以下のように定義します。

- 頂点 $ r $ から頂点 $ u $ の単純パスの端点または辺上に頂点 $ v $ が含まれるような組 $ (u,\ v)\ (u\ \lt\ v) $ の個数

$ 1 $ 以上 $ N $ 以下の全ての整数 $ r $ に対し、頂点 $ r $ を根としたときの転倒数を求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ A_1 $ $ B_1 $ $ \vdots $ $ A_{N-1} $ $ B_{N-1} $

## 输出格式

$ N $ 行出力せよ。$ i $ 行目には頂点 $ i $ を根としたときの転倒数を出力すること。

## 说明/提示

### 制約

- 入力は全て整数
- $ 2\ \leq\ N\ \leq\ 10^{5} $
- $ 1\ \leq\ A_i,\ B_i\ \leq\ N $
- 与えられるグラフは木である。

### Sample Explanation 1

\- 頂点 $ 1 $ を根としたときの転倒数は、$ (u,\ v)\ =\ (2,\ 3) $ より $ 1 $ です - 頂点 $ 2 $ を根としたときの転倒数は、$ (u,\ v)\ =\ (1,\ 2),\ (1,\ 3) $ より $ 2 $ です - 頂点 $ 3 $ を根としたときの転倒数は、$ (u,\ v)\ =\ (1,\ 3),\ (2,\ 3) $ より $ 2 $ です。

## 样例 #1

### 输入

```
3

1 3

2 3
```

### 输出

```
1

2

2
```

## 样例 #2

### 输入

```
7

1 4

1 6

2 4

2 5

3 4

4 7
```

### 输出

```
2

3

4

3

7

7

9
```



---

---
title: "Marunomi for All Prefixes"
layout: "post"
diff: 提高+/省选-
pid: AT_ttpc2024_2_o
tag: []
---

# Marunomi for All Prefixes

## 题目描述

Shobon 想到了一个有趣的问题。

> #### 史莱姆吞噬
>
> 现有一个正整数序列 $ W = (w_1, w_2, \dots, w_N) $。
>
> 有 $ N $ 只史莱姆，编号分别是 $ 1, 2, \dots, N $。最初，每只史莱姆 $ i $（$ 1 \leq i \leq N $）的重量是 $ w_i $，胜利次数是 $ 0 $。
> 
> 你可以对这些史莱姆执行以下操作任意次：
>
> - 选择任意两个编号不同且活着的史莱姆，分别是史莱姆 $ i $ 和史莱姆 $ j\ (i \neq j)$。
>   - 设史莱姆 $ i $ 的重量为 $ W_i $，史莱姆 $ j $ 的重量为 $ W_j $。
>   - 如果 $ W_i > W_j $，则史莱姆 $ i $ 的胜利次数加 $ 1 $，其重量变为 $ W_i + W_j $，同时史莱姆 $ j $ 消亡。
>   - 否则，就什么也不做。
>
> ![](https://img.atcoder.jp/ttpc2024_2/a91ebda9babf3e276c4e56e302e4fb46.svg)
>
> 对于每个 $ i = 1, 2, \dots, N $，假设我们尽可能增加史莱姆 $ i $ 的胜利次数，将其最大化，记为 $ S_i $。  
> 求 $ S_1 + S_2 + \dots + S_N $ 的总和。

由于该问题与 [ARC189 D - Takahashi is Slime](https://atcoder.jp/contests/arc189/tasks/arc189_d) 类似，noya2 将其变为：

> #### 前缀史莱姆吞噬
>
> 给定一个正整数序列 $ A = (a_1, a_2, \dots, a_M) $。
>
> 对每个 $ i = 1, 2, \dots, M $，计算当输入序列 $ W = (a_1, a_2, \dots, a_i) $ 时，上述问题的结果。

请解决这个问题。

## 输入格式

输入格式如下：

> $ M $ $ a_1 $ $ a_2 $ $ \cdots $ $ a_M $

## 输出格式

输出 $ M $ 行。对于每个 $ i $（$ 1 \leq i \leq M $），输出第 $ i $ 行，表示当输入 $ W = (a_1, a_2, \dots, a_i) $ 时对应的问题答案。

## 说明/提示

- 输入的所有值均为整数。
- $ 1 \leq M \leq 2 \times 10^5 $。
- $ 1 \leq a_i \leq 10^9 \ (1 \leq i \leq M) $。

 **本翻译由 AI 自动生成**

## 样例 #1

### 输入

```
5

1 2 3 5 20
```

### 输出

```
0 1 3 7 11
```

## 样例 #2

### 输入

```
3

1 1 1
```

### 输出

```
0 0 0
```

## 样例 #3

### 输入

```
10

17 3467 115 716 9070 32 12251 237 549 17
```

### 输出

```
0 1 3 6 10 15 22 29 38 46
```



---

---
title: "Bounding Box"
layout: "post"
diff: 提高+/省选-
pid: AT_utpc2021_e
tag: []
---

# Bounding Box

## 题目描述

在平面直角坐标系中有 $N$ 个点，第 $i$ 个点在 $(x_i,y_i)$ 处，价值为 $c_i$。

你需要选择 $K$ 个点，令：

- $X_{\max}$ $\coloneqq$ 选择的点的 $x$ 坐标的最大值
- $X_{\min}$ $\coloneqq$ 选择的点的 $x$ 坐标的最小值
- $Y_{\max}$ $\coloneqq$ 选择的点的 $y$ 坐标的最大值
- $Y_{\min}$ $\coloneqq$ 选择的点的 $y$ 坐标的最小值
- $S$ $\coloneqq$ 选择的点的价值之和

要求最大化 $(X_{\max}-X_{\min})+(Y_{\max}-Y_{\min})+S$，请输出其最大值。

## 输入格式

输入共 $N+1$ 行。

第一行两个整数，分别为 $N,K$。

接下来的 $N$ 行，第 $i+1$ 行有三个整数，分别为 $x_i,y_i,c_i$

## 输出格式

一行一个整数，表示答案。

## 说明/提示

- $1\le K\le\ N\le 2\times10^5$
- $1\le x_i,y_i\le 10^9$
- $1\le c_i\le 10^9$

## 样例 #1

### 输入

```
3 2

1 3 1

3 1 1

3 3 2
```

### 输出

```
6
```

## 样例 #2

### 输入

```
12 5

79 29 4

47 96 11

31 100 13

89 67 13

28 45 9

66 70 12

18 12 9

21 57 14

67 17 6

91 12 9

79 11 8

67 50 6
```

### 输出

```
220
```



---

---
title: "Card Decks"
layout: "post"
diff: 提高+/省选-
pid: AT_utpc2021_i
tag: []
---

# Card Decks

## 题目描述

[problemUrl]: https://atcoder.jp/contests/utpc2021/tasks/utpc2021_i

$ 1 $ から $ M $ までの数が一つずつ書かれた $ M $ 枚のカードからなる山札が $ N $ 個あります。 $ i $ 個目の山札の上から $ j $ 枚目には、 $ a_{i,\ j} $ が書かれています。

あなたはこれらの山札に対して、以下の $ 2 $ 種類の操作をそれぞれ好きな順に何度でも行うことができます。

- 操作 $ 1 $：山札を $ 1 $ つ選び、一番上のカードを、同じ山札の一番下に移動させる。
- 操作 $ 2 $：$ N $ 個の山札の一番上のカードに書かれている数が全て同じなら、それらを全て取って食べる。

全てのカードを食べるために必要な操作 $ 1 $ の回数の最小値はいくつですか？

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ M $ $ a_{1,\ 1} $ $ \ldots $ $ a_{1,\ M} $ $ \vdots $ $ a_{N,\ 1} $ $ \ldots $ $ a_{N,\ M} $

## 输出格式

答えを $ 1 $ 行に出力せよ。

## 说明/提示

### 制約

- 入力は全て整数
- $ 1\ \le\ N\ \le\ 2\ \times\ 10^5 $
- $ 1\ \le\ M\ \le\ 22 $
- $ 1\ \leq\ a_{i,\ j}\ \leq\ M $
- $ a_{i,\ j}\ \neq\ a_{i,\ k} $ $ (j\ \neq\ k) $

### 部分点

- $ 1\ \le\ M\ \le\ 16 $ を満たすデータセットに正解した場合は $ 30 $ 点が与えられる。

### Sample Explanation 1

次のように操作を行えばよいです。 - 山札 $ 2 $ に対して操作 $ 1 $ を行う。 - 山札 $ 4 $ に対して操作 $ 1 $ を行う。 - 操作 $ 2 $ を行う。（全ての山札の一番上のカードは $ 2 $ である。） - 山札 $ 1 $ に対して操作 $ 1 $ を行う。 - 山札 $ 2 $ に対して操作 $ 1 $ を行う。 - 操作 $ 2 $ を行う。（全ての山札の一番上のカードは $ 1 $ である。） - 操作 $ 2 $ を行う。（全ての山札の一番上のカードは $ 3 $ である。）

## 样例 #1

### 输入

```
4 3

2 3 1

1 2 3

2 1 3

3 2 1
```

### 输出

```
4
```

## 样例 #2

### 输入

```
7 6

1 2 3 4 5 6

3 5 6 1 4 2

2 5 4 3 6 1

5 1 2 4 6 3

3 2 6 5 4 1

4 1 2 5 3 6

6 5 4 3 1 2
```

### 输出

```
35
```



---

---
title: "Maze Game"
layout: "post"
diff: 提高+/省选-
pid: AT_utpc2021_l
tag: []
---

# Maze Game

## 题目描述

[problemUrl]: https://atcoder.jp/contests/utpc2021/tasks/utpc2021_l

縦 $ H $ 行、横 $ W $ 列のグリッド状の迷路があります。 各マスには `S` , `G` , `#` , `.` のいずれかの文字が書かれています。$ i $ 行目 $ j $ 列目のマスに書かれている文字は$ c_{i,j} $ です。`#` と書かれたマスは壁になっており、そうでないマスは壁ではありません。 また、`S` と `G` は $ 1 $ つずつで、上下左右に隣接していないことが保証されます。

迷路が次の条件を満たす時、**到達可能な状態** と呼ぶことにします。

- `S` と書かれたマスから、`G` と書かれたマスに、上下左右に隣接する壁でないマス (つまり `#` と書かれてないマス) のみを通って到達できる。  ただし、迷路の外に出るような移動はできない。

最初、迷路は **到達可能な状態** であることが保証されます。

Alice と Bob がこの迷路を使ってゲームをします。 Alice が先手で、交互に以下の操作を行います。

- `.` と書かれたマスを $ 1 $ つ選び、 `#` と書かれたマスに変更する。

先に自分の操作終了時に、迷路が **到達可能な状態** でなくなったプレイヤーの勝利となります。 本問題の制約下で与えられる迷路では、必ず勝者が決定することが証明できます。 二人が最適に行動した場合、どちらが勝つか求めてください。

$ T $ 個のテストケースが与えられるので、それぞれについて答えを求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ T $ $ \mathrm{case}_1 $ $ \vdots $ $ \mathrm{case}_T $

各ケースは以下の形式で与えられる。

> $ H $ $ W $ $ c_{1,1}c_{1,2}\ldots\ c_{1,W} $ $ c_{2,1}c_{2,2}\ldots\ c_{2,W} $ $ \vdots $ $ c_{H,1}c_{H,2}\ldots\ c_{H,W} $

## 输出格式

各テストケースについて、Aliceが勝つ場合は `Alice`、Bobが勝つ場合は `Bob` と出力せよ。

## 说明/提示

### 制約

- $ 1\ \le\ T\ \le\ 50 $
- $ 2\ \le\ H,W\ \le\ 100 $
- 迷路に含まれる文字は、`S`, `G`, `.`, `#` のいずれか
- `S` と `G` は 1 つずつ含まれ、上下左右に隣接していない
- 与えられる迷路は **到達可能な状態** である

### Sample Explanation 1

1つめのケースでは、Aliceが選べるマスは右上か左下の2通りですが、どちらを選んでも次にBobがもう一方の `.` であるマスを選択してBobが勝ちます。 2つめのケースでは、Aliceが2行目の `.` を `#` に変えてAliceの勝利となります。

## 样例 #1

### 输入

```
2

2 2

S.

.G

2 3

#G#

S.#
```

### 输出

```
Bob

Alice
```



---

---
title: "Save the Monsters"
layout: "post"
diff: 提高+/省选-
pid: AT_wtf22_day1_a
tag: []
---

# Save the Monsters

## 题目描述

[problemUrl]: https://atcoder.jp/contests/wtf22-day1-open/tasks/wtf22_day1_a

$ 1 $ から $ N $ までの番号がついた $ N $ 体のモンスターをあなたは飼っています．

あなたのモンスターを討伐するために勇者がやってきました． 勇者はこれから $ M $ ターンかけてモンスターに攻撃を仕掛けます． $ i $ ターン目には，勇者は以下のいずれかの行動を行います．

- MP を $ 1 $ 消費してモンスター $ X_i $ を攻撃する． この行動は，モンスター $ X_i $ がまだ生きており，かつ勇者の MP が $ 1 $ 以上のときにのみ行える．
- 何もしない．

勇者が攻撃を行った場合，あなたはそれに対して以下のいずれかの行動を行います．

- MP を $ 1 $ 消費してモンスター $ X_i $ を守る． この行動はあなたの MP が $ 1 $ 以上のときにのみ行える．
- 何もしない．このとき，モンスター $ X_i $ は死んでしまう．

最初のターンが始まる前の段階で，勇者の MP は $ A $，あなたの MP は $ B $ です． また，勇者もあなたも $ N,M,A,B,X_i $ の値をすべて把握しています． このとき，以下の条件をみたす最大の整数 $ k $ を求めてください．

- あなたが適切な戦略を取ることで，勇者がどのように行動したとしても，$ k $ 体以上のモンスターを最後まで生存させることができる．

## 输入格式

入力は以下の形式で標準入力から与えられる．

> $ N $ $ M $ $ A $ $ B $ $ X_1 $ $ X_2 $ $ \cdots $ $ X_M $

## 输出格式

答えを出力せよ．

## 说明/提示

### 制約

- $ 1\ \leq\ N,M\ \leq\ 250000 $
- $ 1\ \leq\ B\ \leq\ A\ \leq\ M $
- $ 1\ \leq\ X_i\ \leq\ N $
- 入力される値はすべて整数．

### Sample Explanation 1

あなたは $ 1 $ 体以上のモンスターを必ず生存させることができます． 以下にありうる進行の一例を示します． - $ 1 $ ターン目: 勇者がモンスター $ 1 $ を攻撃する． - あなたは何もせず，モンスター $ 1 $ が死ぬ． - $ 2 $ ターン目: 勇者がモンスター $ 2 $ を攻撃する． - あなたはモンスター $ 2 $ を守る． - $ 3 $ ターン目: 勇者はなにもしない．

## 样例 #1

### 输入

```
2 3 2 1
1 2 1
```

### 输出

```
1
```

## 样例 #2

### 输入

```
2 6 3 2
1 1 1 2 2 2
```

### 输出

```
1
```

## 样例 #3

### 输入

```
100 1 1 1
100
```

### 输出

```
100
```

## 样例 #4

### 输入

```
6 20 16 5
5 6 1 3 2 1 4 3 2 4 1 4 4 6 3 3 5 2 2 2
```

### 输出

```
2
```



---

---
title: "Pass"
layout: "post"
diff: 提高+/省选-
pid: AT_yahoo_procon2019_qual_f
tag: []
---

# Pass

## 题目描述

# Pass


有 $N$ 个人排成一列。给定一个长度为 $N$ 的字符串 $S$，第 $i$ 个人手中的球的数量如下：

- 当 $S_i=0$ 时，这个人手中有两个红球；
- 当 $S_i=1$ 时，这个人手中有一个红球和一个蓝球；
- 当 $S_i=2$ 时，这个人手中有两个蓝球。

一开始，高桥君手中没有球，他要进行 $2N$ 次操作，每次操作如下：

- 如果有人手中有球，则所有人同时选择一个自己手中的球，将其交给前面的人（第一个人将球交给高桥君）；
- 高桥君将收到的球放到队列的末尾。

请计算出高桥君可以得到的所有队列的数量，答案对 $998244353$ 取模。

## 输入格式

> $S$

## 输出格式

输出高桥君可以得到的所有队列的数量，答案对 $998244353$ 取模。

## 样例 #1

### 样例输入 #1

```
02
```

### 样例输出 #1

```
3
```

## 样例 #2

### 样例输入 #2

```
1210
```

### 样例输出 #2

```
55
```

## 样例 #3

### 样例输入 #3

```
12001021211100201020
```

### 样例输出 #3

```
543589959
```

## 说明/提示

- $1\leq |S|\leq 2000$
- $S$ 仅包含数字 $0,1,2$。

注意：输入中不会给出 $N$，而是通过字符串 $S$ 的长度间接给出。

### 样例解释

可以将队列看作一个长度为 $2N$ 的字符串，第 $i$ 个字符表示第 $i$ 个人交给高桥君的球的颜色，红色用字母 `r` 表示，蓝色用字母 `b` 表示。例如，字符串 `rrbb` 表示高桥君先收到两个红球，然后收到两个蓝球。

对于样例 #1，可以构造出三个合法的队列：`rrbb`，`rbrb` 和 `rbbr`。

对于样例 #2 和样例 #3，可以使用动态规划的方法求解。

## 样例 #1

### 输入

```
02
```

### 输出

```
3
```

## 样例 #2

### 输入

```
1210
```

### 输出

```
55
```

## 样例 #3

### 输入

```
12001021211100201020
```

### 输出

```
543589959
```



---

---
title: "出会いと別れ"
layout: "post"
diff: 提高+/省选-
pid: AT_zone2021_f
tag: []
---

# 出会いと別れ

## 题目描述

[problemUrl]: https://atcoder.jp/contests/zone2021/tasks/zone2021_f

あなたは、スタートアップの新製品として全ての惑星間を行き来出来るようなワープゲートを構築しようとしています。  
 惑星が $ N $ 個あり、$ 0 $ から $ N\ -\ 1 $ までの番号がついています。ここで、ある整数 $ n $ が存在して、$ N\ =\ 2^n $ です。これらの惑星の間を高速に移動するために、$ 2 $ 惑星間を瞬時に移動出来るワープゲートを $ N\ -\ 1 $ 個作成し、全ての惑星間を行き来出来るようなゲート網を作りたいです。しかし、星同士には相性があり、相性が悪い惑星間にはワープゲートを作ることが出来ません。  
 具体的には、相性の悪い惑星は数列 $ A\ =\ (A_1,\ A_2,\ \dots,\ A_M) $ で表され、ある整数 $ i $ が存在して $ a\ \mathrm{xor}\ b\ =\ A_i $ である場合、かつそのときに限り惑星 $ a $ と惑星 $ b $ の間にワープゲートを作ることが出来ません。   
 全ての惑星間を行き来できるようなゲート網を作ることができるか判定し、できる場合は $ N\ -\ 1 $ 個のワープゲートの作り方を求めてください。

 $ \mathrm{xor} $ とは 整数 $ a,\ b $ のビットごとの排他的論理和 $ a\ \mathrm{xor}\ b $ は、以下のように定義されます。

- $ a\ \mathrm{xor}\ b $ を二進表記した際の $ 2^k $ ($ k\ \geq\ 0 $) の位の数は、$ a,\ b $ を二進表記した際の $ 2^k $ の位の数のうち一方のみが $ 1 $ であれば $ 1 $、そうでなければ $ 0 $ である。
 
 例えば、$ 3\ \mathrm{xor}\ 5\ =\ 6 $ となります (二進表記すると: $ 011\ \mathrm{xor}\ 101\ =\ 110 $)。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ M $ $ A_1 $ $ A_2 $ $ \cdots $ $ A_M $

## 输出格式

全ての惑星間を行き来できるようなゲート網を作ることができない場合、`-1` と出力せよ。

作ることができる場合、$ N\ -\ 1 $ 個のワープゲートの作り方を以下の形式で出力せよ。

> $ U_1 $ $ V_1 $ $ U_2 $ $ V_2 $ $ \vdots $ $ U_{N-1} $ $ V_{N-1} $

これは、惑星 $ U_i $ と惑星 $ V_i $ の間にワープゲートを作ることを表す。

## 说明/提示

### ストーリー

梯子を登りきり UFO に入ると、そこには捕らえられたムーアと、恐ろしい形相の宇宙人が待ち構えていた。 しかしそれ以上に、見覚えのある缶がうずたかく積まれているのが目に留まった。 間違いない。あれは間違いなく ZONe mad\_hacker ver.1.0.0 だ。 そして mad\_hacker を飲んでいるということは、この宇宙人も別の星で MADHACKING に勤しむエンジニアに違いない、と俺は確信した。 勉強会で初めての相手に話しかける時の如く、俺はやや緊張しながら口を開いた。  
 「...foo」  
 聞くや否や、宇宙人の目が輝いた。  
 「...bar!」

「fizz!」「buzz!」  
 ハッカーたちの魂が、星を超えて交わった。 すっかり意気投合した俺たちは、それぞれの星の言語やプログラミングパラダイムについて一晩中語り明かした。 気に入られ、その場でスカウトされた俺は地球人として初のミルキーウェイ(天の川)のスタートアップで働くことになったのだった。 さようなら、地球。ありがとう、ZONe mad\_hacker。そして、hello, space!

### 制約

- 入力は全て整数
- $ 1\ <\ = n\ <\ =\ 18 $ を満たす整数 $ n $ が存在して、$ N\ =\ 2^n $
- $ 0\ <\ = M\ <\ = N\ -\ 1 $
- $ 0\ <\ A_1\ <\ A_2\ <\ \dots\ <\ A_M\ <\ N $

### Sample Explanation 1

$ 1\ \mathrm{xor}\ 0\ =\ 1,\ 1\ \mathrm{xor}\ 3\ =\ 2,\ 0\ \mathrm{xor}\ 2\ =\ 2 $ であるためワープゲートを作ることができ、$ N\ -\ 1 $ 個のワープゲートで全ての惑星間を行き来できるようになっているので、正解となります。 正解となる出力は他にも多数あります。

## 样例 #1

### 输入

```
4 1

3
```

### 输出

```
1 0

1 3

0 2
```

## 样例 #2

### 输入

```
8 0
```

### 输出

```
1 0

1 3

1 5

6 7

6 4

6 2

3 2
```

## 样例 #3

### 输入

```
8 7

1 2 3 4 5 6 7
```

### 输出

```
-1
```



---


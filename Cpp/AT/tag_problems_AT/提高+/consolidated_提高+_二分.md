---
title: "[ABC346F] SSttrriinngg in StringString"
layout: "post"
diff: 提高+/省选-
pid: AT_abc346_f
tag: ['贪心', '二分']
---

# [ABC346F] SSttrriinngg in StringString

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc346/tasks/abc346_f

長さ $ n $ の文字列 $ X $ に対して、$ X $ を $ k $ 回繰り返して得られる文字列を $ f(X,k) $ と表記し、$ X $ の $ 1 $ 文字目、$ 2 $ 文字目、$ \dots $、$ n $ 文字目を $ k $ 回ずつこの順に繰り返して得られる文字列を $ g(X,k) $ と表記します。 例えば、$ X= $ `abc` のとき、$ f(X,2)= $ `abcabc`、$ g(X,3)= $ `aaabbbccc` です。 また、任意の文字列 $ X $ に対して、$ f(X,0) $ と $ g(X,0) $ は共に空文字列です。

正整数 $ N $ および文字列 $ S,T $ が与えられます。 $ g(T,k) $ が $ f(S,N) $ の（連続とは限らない）部分列であるような最大の非負整数 $ k $ を求めてください。 なお、定義より、$ g(T,0) $ は常に $ f(S,N) $ の部分列であることに注意してください。

部分列とは文字列 $ X $ の（連続とは限らない）部分列とは、$ X $ から $ 0 $ 個以上の文字を取り除いた後、残りの文字を元の順序で連結して得られる文字列のことをいいます。 例えば、`ac`、`atcoder`、` `（空文字列）などはどれも `atcoder` の部分列ですが、`ta` は `atcoder` の部分列ではありません。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ S $ $ T $

## 输出格式

$ g(T,k) $ が $ f(S,N) $ の（連続とは限らない）部分列であるような最大の非負整数 $ k $ を出力せよ。

## 说明/提示

### 制約

- $ N $ は整数
- $ 1\leq\ N\leq\ 10^{12} $
- $ S,\ T $ は英小文字からなる長さ $ 1 $ 以上 $ 10^5 $ 以下の文字列

### Sample Explanation 1

$ f(S,3)= $ `abcabcabc` です。 $ g(T,2)= $ `aabb` は $ f(S,3) $ の部分列ですが、$ g(T,3)= $ `aaabbb` は $ f(S,3) $ の部分列ではないので、$ 2 $ を出力します。

## 样例 #1

### 输入

```
3
abc
ab
```

### 输出

```
2
```

## 样例 #2

### 输入

```
3
abc
arc
```

### 输出

```
0
```

## 样例 #3

### 输入

```
1000000000000
kzazkakxkk
azakxk
```

### 输出

```
344827586207
```



---

---
title: "[ABC356F] Distance Component Size Query"
layout: "post"
diff: 提高+/省选-
pid: AT_abc356_f
tag: ['线段树', '二分']
---

# [ABC356F] Distance Component Size Query

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc356/tasks/abc356_f

整数 $ K $ が与えられます。はじめ空である集合 $ S $ に対して、次の $ 2 $ 種類のクエリを順に $ Q $ 個処理してください。

- `1 x`：整数 $ x $ が与えられる。$ S $ に $ x $ が含まれているならば、$ S $ から $ x $ を取り除く。そうでないならば、$ S $ に $ x $ を追加する。
- `2 x`：$ S $ に含まれる整数 $ x $ が与えられる。$ S $ に含まれる数を頂点とし、差の絶対値が $ K $ 以下であるような数の間に辺を張ったグラフにおいて、$ x $ が属する連結成分の頂点数を出力する。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ Q $ $ K $ $ \mathrm{query}_1 $ $ \vdots $ $ \mathrm{query}_Q $

各クエリはそれぞれ次の形式で与えられる。

> $ 1 $ $ x $

> $ 2 $ $ x $

## 输出格式

クエリを処理せよ。

## 说明/提示

### 制約

- $ 1\ \leq\ Q\ \leq\ 2\times\ 10^5 $
- $ 0\ \leq\ K\ \leq\ 10^{18} $
- 各クエリにおいて、$ 1\leq\ x\ \leq\ 10^{18} $
- $ 2 $ 種類目のクエリにおいて与えられる $ x $ はその時点で $ S $ に含まれる。
- 入力は全て整数である。
 
### Sample Explanation 1

クエリの処理は次のように進行します。 - $ 1 $ 番目のクエリでは、$ S $ に $ 3 $ が追加され、$ S=\{3\} $ となります。 - $ 2 $ 番目のクエリでは、$ S $ に $ 10 $ が追加され、$ S=\{3,10\} $ となります。 - $ 3 $ 番目のクエリでは、$ 3,10 $ の $ 2 $ 頂点からなる辺のないグラフを考え、$ 3 $ が属する連結成分のサイズである $ 1 $ を出力します。 - $ 4 $ 番目のクエリでは、$ S $ に $ 7 $ が追加され、$ S=\{3,7,10\} $ となります。 - $ 5 $ 番目のクエリでは、$ 3,7,10 $ の $ 3 $ 頂点からなり、$ 3 $ と $ 7 $、$ 7 $ と $ 10 $ の間に辺のあるグラフを考え、$ 3 $ が属する連結成分のサイズである $ 3 $ を出力します。 - $ 6 $ 番目のクエリでは、$ S $ から $ 10 $ が削除され、$ S=\{3,7\} $ となります。 - $ 7 $ 番目のクエリでは、$ 3,7 $ の $ 2 $ 頂点からなり、$ 3 $ と $ 7 $ の間に辺のあるグラフを考え、$ 3 $ が属する連結成分のサイズである $ 2 $ を出力します。

## 样例 #1

### 输入

```
7 5

1 3

1 10

2 3

1 7

2 3

1 10

2 3
```

### 输出

```
1

3

2
```

## 样例 #2

### 输入

```
11 1000000000000000000

1 1

1 100

1 10000

1 1000000

1 100000000

1 10000000000

1 1000000000000

1 100000000000000

1 10000000000000000

1 1000000000000000000

2 1
```

### 输出

```
10
```

## 样例 #3

### 输入

```
8 0

1 1

1 2

2 1

1 1

1 2

1 1

1 2

2 1
```

### 输出

```
1

1
```



---

---
title: "[ABC370F] Cake Division"
layout: "post"
diff: 提高+/省选-
pid: AT_abc370_f
tag: ['倍增', '二分']
---

# [ABC370F] Cake Division

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc370/tasks/abc370_f

円形のケーキがあり、ケーキは切り目によって $ N $ 個のピースに分けられています。各切り目は円の中心と円弧上の点を結ぶ線分です。

ピースおよび切り目には時計回りに $ 1,\ 2,\ \ldots,\ N $ の番号が付けられており、ピース $ i $ の質量は $ A_i $ です。ピース $ 1 $ をピース $ N\ +\ 1 $ とも呼ぶこととします。

切り目 $ i $ は ピース $ i $ とピース $ i\ +\ 1 $ の間にあり、ピース $ 1 $, 切り目 $ 1 $, ピース $ 2 $, 切り目 $ 2 $, $ \ldots $, ピース $ N $, 切り目 $ N $ の順に時計回りに並んでいます。

このケーキを以下の条件を満たすように $ K $ 人に分けようとしています。ただし、$ i $ 番目の人が受け取るピースの質量の合計を $ w_i $ とします。

- すべての人が $ 1 $ つ以上の**連続する**ピースを受け取る
- 誰も受け取らないピースは存在しない
- 上の $ 2 $ つの条件を満たすという条件下で $ \min(w_1,\ w_2,\ \ldots,\ w_K) $ が最大になるようにする
 
条件を満たす分け方における $ \min(w_1,\ w_2,\ \ldots,\ w_K) $ の値および条件を満たすすべての分け方で切られることのない切り目の個数を求めてください。ただし、切り目 $ i $ が切られるとは、ピース $ i $ とピース $ i\ +\ 1 $ が異なる人に分けられることを指します。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ K $ $ A_1 $ $ A_2 $ $ \ldots $ $ A_N $

## 输出格式

条件を満たす分け方における $ \min(w_1,\ w_2,\ \ldots,\ w_K) $ の値を $ x $、 切られることのない切り目の個数を $ y $ として、$ x $ と $ y $ をこの順に空白区切りで出力せよ。

## 说明/提示

### 制約

- $ 2\ \leq\ K\ \leq\ N\ \leq\ 2\ \times\ 10^5 $
- $ 1\ \leq\ A_i\ \leq\ 10^4 $
- 入力される値はすべて整数
 
### Sample Explanation 1

以下の分け方が条件を満たします。 - 一方の人にピース $ 2,\ 3 $ を渡し、もう一方の人にピース $ 4,\ 5,\ 1 $ を渡す。ピース $ 2,\ 3 $ の質量の合計は $ 14 $、ピース $ 4,\ 5,\ 1 $ の質量の合計は $ 13 $ である。 - 一方の人にピース $ 3,\ 4 $ を渡し、もう一方の人にピース $ 5,\ 1,\ 2 $ を渡す。ピース $ 3,\ 4 $ の質量の合計は $ 14 $、ピース $ 5,\ 1,\ 2 $ の質量の合計は $ 13 $ である。 条件を満たす分け方における $ \min(w_1,\ w_2) $ の値は $ 13 $ であり、どちらの分け方でも切られない切り目は切り目 $ 5 $ の $ 1 $ つです。

## 样例 #1

### 输入

```
5 2

3 6 8 6 4
```

### 输出

```
13 1
```

## 样例 #2

### 输入

```
6 3

4 7 11 3 9 2
```

### 输出

```
11 1
```

## 样例 #3

### 输入

```
10 3

2 9 8 1 7 9 1 3 5 8
```

### 输出

```
17 4
```



---

---
title: "[ABC371F] Takahashi in Narrow Road"
layout: "post"
diff: 提高+/省选-
pid: AT_abc371_f
tag: ['线段树', '二分']
---

# [ABC371F] Takahashi in Narrow Road

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc371/tasks/abc371_f

東西に続く道があり、道の上には $ N $ 人の高橋くんがいます。 道は原点と呼ばれる点から東西に十分長く続いています。

$ i $ 番目 $ (1\leq\ i\leq\ N) $ の高橋くんは、はじめ原点から東に $ X\ _\ i $ メートル進んだところにいます。

高橋くんたちは道の上を東西に動くことができます。 具体的には、次の移動を好きなだけ行うことができます。

- 高橋くんを一人選ぶ。**移動する先に他の高橋くんがいない場合**、選んだ高橋くんを $ 1 $ メートル東に、もしくは西に移動させる。

高橋くんたちには合計 $ Q $ 個の用事があり、$ i $ 個目 $ (1\leq\ i\leq\ Q) $ の用事は次の形式で表されます。

- $ T\ _\ i $ 番目の高橋くんが座標 $ G\ _\ i $ に到着する。

$ Q $ 個の用事を先頭から順にすべて完了するために必要な移動回数の最小値を求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ X\ _\ 1 $ $ X\ _\ 2 $ $ \ldots $ $ X\ _\ N $ $ Q $ $ T\ _\ 1 $ $ G\ _\ 1 $ $ T\ _\ 2 $ $ G\ _\ 2 $ $ \vdots $ $ T\ _\ Q $ $ G\ _\ Q $

## 输出格式

答えを出力せよ。

## 说明/提示

### 制約

- $ 1\leq\ N\leq2\times10\ ^\ 5 $
- $ 0\leq\ X\ _\ 1\lt\ X\ _\ 2\lt\dotsb\lt\ X\ _\ N\leq10\ ^\ 8 $
- $ 1\leq\ Q\leq2\times10\ ^\ 5 $
- $ 1\leq\ T\ _\ i\leq\ N\ (1\leq\ i\leq\ Q) $
- $ 0\leq\ G\ _\ i\leq10\ ^\ 8\ (1\leq\ i\leq\ Q) $
- 入力はすべて整数

### Sample Explanation 1

高橋くんたちの最適な行動は以下のようになります（それぞれの高橋くんの座標は正確に描かれているとは限りません）。 !\[\](https://img.atcoder.jp/abc371/2ebef79b440e6dae3115bb518fccfb5f.png) それぞれの用事では、高橋くんたちは次のように移動しています。 - $ 4 $ 番目の高橋くんが $ 6 $ 回東に進み、$ 3 $ 番目の高橋くんが $ 15 $ 回東に進む。 - $ 2 $ 番目の高橋くんが $ 2 $ 回西に進み、$ 3 $ 番目の高橋くんが $ 26 $ 回西に進み、$ 4 $ 番目の高橋くんが $ 26 $ 回西に進む。 - $ 4 $ 番目の高橋くんが $ 18 $ 回東に進み、$ 3 $ 番目の高橋くんが $ 18 $ 回東に進み、$ 2 $ 番目の高橋くんが $ 18 $ 回東に進み、$ 1 $ 番目の高橋くんが $ 25 $ 回東に進む。 - $ 5 $ 番目の高橋くんが $ 13 $ 回東に進み、$ 4 $ 番目の高橋くんが $ 24 $ 回東に進み、$ 3 $ 番目の高橋くんが $ 24 $ 回東に進み、$ 2 $ 番目の高橋くんが $ 24 $ 回東に進む。 高橋くんたちの移動回数の合計は $ 21+54+79+85=239 $ 回となります。 移動回数の合計を $ 238 $ 回以下としてすべての用事を完了することはできないため、`239` を出力してください。

### Sample Explanation 2

途中で一部の高橋くんが原点より西側や、原点より $ 10\ ^\ 8+1 $ メートル以上東に進んだところに移動する必要がある場合があることに注意してください。 また、答えが $ 2\ ^\ {32} $ を超える場合があることに注意してください。

## 样例 #1

### 输入

```
5
10 20 30 40 50
4
3 45
4 20
1 35
2 60
```

### 输出

```
239
```

## 样例 #2

### 输入

```
8
0 1 2 3 4 5 6 100000000
6
1 100000000
8 0
1 100000000
8 4
1 100000000
5 21006578
```

### 输出

```
4294967297
```

## 样例 #3

### 输入

```
12
1558 3536 3755 3881 4042 4657 5062 7558 7721 8330 8542 9845
8
9 1694
7 3296
12 5299
5 5195
5 5871
1 2491
8 1149
8 2996
```

### 输出

```
89644
```



---

---
title: "[ABC388G] Simultaneous Kagamimochi 2"
layout: "post"
diff: 提高+/省选-
pid: AT_abc388_g
tag: ['二分', 'ST 表']
---

# [ABC388G] Simultaneous Kagamimochi 2

## 题目描述

有 $N$ 个饼从小到大依次排列。第 $i$ 个饼（$1 \leq i \leq N$）的大小为 $A_i$。

对于两个饼 $A$ 和 $B$，其大小分别为 $a$ 和 $b$，当且仅当 $a$ 不超过 $b$ 的一半时，可以将饼 $A$ 放在饼 $B$ 上，形成一个镜饼。

给定 $Q$ 个整数对。第 $i$ 个整数对为 $(L_i, R_i)$，请对每个 $i$ 解决以下问题：

> 仅使用第 $L_i$ 到第 $R_i$ 个饼（共 $R_i - L_i + 1$ 个饼），最多可以同时制作多少个镜饼？
>
> 更严格地说，求最大的非负整数 $K$，使得：
>
> - 从第 $L_i$ 到第 $R_i$ 个饼中选出 $2K$ 个饼，将其分成 $K$ 对，每对中一个饼放在另一个饼上，形成 $K$ 个镜饼。

## 输入格式

输入通过标准输入给出，格式如下：

> $N$  
> $A_1$ $A_2$ $\dots$ $A_N$  
> $Q$  
> $L_1$ $R_1$  
> $L_2$ $R_2$  
> $\vdots$  
> $L_Q$ $R_Q$

## 输出格式

输出 $Q$ 行。第 $i$ 行（$1 \leq i \leq Q$）输出第 $i$ 个整数对对应问题的答案。

## 说明/提示

- $2 \leq N \leq 2 \times 10^5$
- $1 \leq A_i \leq 10^9$（$1 \leq i \leq N$）
- $A_i \leq A_{i+1}$（$1 \leq i < N$）
- $1 \leq Q \leq 2 \times 10^5$
- $1 \leq L_i < R_i \leq N$（$1 \leq i \leq Q$）
- 输入均为整数

### 样例解释 1

每个问题的答案如下所示。镜饼的制作方式为示例：

- 饼的大小为 $(1,2,3,4)$。可以制作 $(1,3)$ 和 $(2,4)$ 两个镜饼。
- 饼的大小为 $(2,3,4,4,7,10)$。可以制作 $(2,4)$、$(3,7)$ 和 $(4,10)$ 三个镜饼。
- 饼的大小为 $(7,10,11,12,20)$。可以制作 $(10,20)$ 一个镜饼。
- 饼的大小为 $(1,1)$。无法制作任何镜饼。
- 饼的大小为 $(1,1,2,3,4,4,7,10,11,12,20)$。可以制作 $(1,2)$、$(1,3)$、$(4,10)$、$(4,11)$ 和 $(7,20)$ 五个镜饼。

因此，请按顺序输出 `2`、`3`、`1`、`0`、`5`。

## 样例 #1

### 输入

```
11

1 1 2 3 4 4 7 10 11 12 20

5

2 5

3 8

7 11

1 2

1 11
```

### 输出

```
2

3

1

0

5
```

## 样例 #2

### 输入

```
24

127 148 170 174 258 311 331 414 416 436 517 523 532 587 591 638 660 748 760 776 837 857 972 984

15

7 11

8 9

8 13

12 15

9 23

1 17

8 12

1 5

6 17

3 7

12 19

13 18

7 22

1 12

14 15
```

### 输出

```
0

0

0

0

2

6

0

1

1

0

0

0

3

5

0
```



---

---
title: "[ABC401G] Push Simultaneously"
layout: "post"
diff: 提高+/省选-
pid: AT_abc401_g
tag: ['二分', '二分图']
---

# [ABC401G] Push Simultaneously

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc401/tasks/abc401_g

平面上有 $N$ 个高桥君和 $N$ 个按钮。平面上设有原点，从原点向东移动 $x$ 米、向北移动 $y$ 米的位置用坐标 $(x,y)$ 表示。第 $i$ 个高桥君 $(1 \leq i \leq N)$ 初始位于坐标 $(\mathit{sx}_i, \mathit{sy}_i)$，第 $i$ 个按钮位于坐标 $(\mathit{gx}_i, \mathit{gy}_i)$。

高桥君们需要在移动后**同时**按下这 $N$ 个按钮。每个按钮只能由位于该按钮坐标的高桥君按下。从到达按钮所在坐标到按下按钮所需的时间为 $0$ 秒。

每个高桥君可以以不超过 $1$ 米/秒的速度向任意方向移动。更严格地说，设第 $i$ 个高桥君在开始后 $t$ 秒时的坐标为 $(x_i(t), y_i(t))$，则必须满足以下所有条件：

- $x_i(0) = \mathit{sx}_i$
- $y_i(0) = \mathit{sy}_i$
- 对于所有非负实数 $t_0, t_1$，点 $(x_i(t_0), y_i(t_0))$ 和点 $(x_i(t_1), y_i(t_1))$ 之间的距离不超过 $|t_0 - t_1|$

请计算高桥君们达成目标所需的最短时间。严格来说，求满足以下条件的最小 $t$ 值：

- 适当定义满足上述条件的 $x_i, y_i$ 后，对于所有整数 $j$ $(1 \leq j \leq N)$ 和实数 $t'$ $(t' > t)$，存在整数 $i$ $(1 \leq i \leq N)$ 使得 $(x_i(t'), y_i(t')) = (\mathit{gx}_j, \mathit{gy}_j)$ 成立。

## 输入格式

输入通过标准输入给出，格式如下：

> $N$  
> $\mathit{sx}_1$ $\mathit{sy}_1$  
> $\mathit{sx}_2$ $\mathit{sy}_2$  
> $\vdots$  
> $\mathit{sx}_N$ $\mathit{sy}_N$  
> $\mathit{gx}_1$ $\mathit{gy}_1$  
> $\mathit{gx}_2$ $\mathit{gy}_2$  
> $\vdots$  
> $\mathit{gx}_N$ $\mathit{gy}_N$

## 输出格式

输出 $N$ 个高桥君同时按下 $N$ 个按钮所需的时间。当输出值与真实值的相对误差不超过 $10^{-6}$ 时，判定为正确。


## 说明/提示

### 约束条件

- $1 \leq N \leq 300$
- $0 \leq \mathit{sx}_i \leq 10^{18}$ $(1 \leq i \leq N)$
- $0 \leq \mathit{sy}_i \leq 10^{18}$ $(1 \leq i \leq N)$
- $0 \leq \mathit{gx}_i \leq 10^{18}$ $(1 \leq i \leq N)$
- $0 \leq \mathit{gy}_i \leq 10^{18}$ $(1 \leq i \leq N)$
- $(\mathit{sx}_i, \mathit{sy}_i) \neq (\mathit{sx}_j, \mathit{sy}_j)$ $(1 \leq i < j \leq N)$
- $(\mathit{gx}_i, \mathit{gy}_i) \neq (\mathit{gx}_j, \mathit{gy}_j)$ $(1 \leq i < j \leq N)$
- $(\mathit{sx}_i, \mathit{sy}_i) \neq (\mathit{gx}_j, \mathit{gy}_j)$ $(1 \leq i \leq N, 1 \leq j \leq N)$
- 输入的所有数值均为整数

### 样例解释 1

初始时，高桥君和按钮的位置关系如图所示。

![](https://img.atcoder.jp/abc401/c384b713a3b955d1450b7c503cb429cd.png)

假设第 $1,2,3,4$ 个高桥君分别直接向第 $1,3,2,4$ 个按钮移动。

![](https://img.atcoder.jp/abc401/9e54567c2b21a9757d3769ea756ab892.png)

这样，高桥君们分别在开始后 $2$ 秒、$\sqrt{2}$ 秒、$1$ 秒、$\sqrt{2}$ 秒时到达对应按钮的坐标。因此，可以在开始后 $2$ 秒时同时按下所有按钮。反之，无法在 $2$ 秒之前同时按下所有按钮，所以输出 `2`。只要输出值与真实值的相对误差不超过 $10^{-6}$，例如 `1.999998` 或 `2.00000014` 也会被判定为正确。

### 样例解释 2

注意输入的坐标可能超出 $32$ 位整数的范围。

翻译由 DeepSeek V3 完成

## 样例 #1

### 输入

```
4

0 0

0 1

2 0

3 1

0 2

1 0

1 2

2 2
```

### 输出

```
2
```

## 样例 #2

### 输入

```
3

1 4

1 5

9 2

653589793238462643 383279502884197169

399375105820974944 592307816406286208

99862803482534211 706798214808651328
```

### 输出

```
757682516069002110.04581169374262658710741005525
```

## 样例 #3

### 输入

```
12

4459915897 5789359311

4393259463 4247016333

4827828467 4179021045

2654035685 3406423989

1790405301 4886103164

2978675817 4818583236

5912369644 5824121992

6016882384 4165667191

4305949638 3454894060

6545166942 5390976281

4043403253 4019611554

3462096432 4117859301

3528911877 4631601790

4627979431 4814676729

3810130146 5728760563

5586470124 3310360339

3664130072 4525834271

1710246881 3750440871

3143440609 5038869551

2294021341 3965849888

6189106395 4499485672

4799619607 5151972020

6905793542 3976136296

1764267574 4525373194
```

### 输出

```
1299999319.116399442508650717909981965254
```



---

---
title: "[AGC049C] Robots"
layout: "post"
diff: 提高+/省选-
pid: AT_agc049_c
tag: ['贪心', '二分']
---

# [AGC049C] Robots

## 题目描述

[problemUrl]: https://atcoder.jp/contests/agc049/tasks/agc049_c

数直線上にロボットがいます． 具体的には，各 $ i=0,1,2,\cdots,10^{100} $ について，座標 $ i $ に $ 1 $ 台のロボットがおり，ロボット $ i $ と呼ばれています．

たくさんのボールがあります． それぞれのボールには，正整数が $ 1 $ つ書いてあります． これらのボールの情報は，長さ $ N $ の整数列 $ A $ と $ B $ で表されます． 具体的には，各 $ i $ ($ 1\ \leq\ i\ \leq\ N $) について，$ A_i $ の書かれたボールが $ B_i $ 個あります．

今からすぬけくんは，次の操作を行います．

- Step 1: $ 0 $ 個以上のボールを選び，そこに書かれている整数を，$ 1 $ 以上 $ 10^{100} $ 以下の好きな**正整数**に書き換える．（ボールごとに書き換える整数を選択できる）
- Step 2: ボールを $ 1 $ つずつ食べる．ボールを食べる順番は自由に選べる．ボールを食べるたびに，以下の操作を行う．
  
  
  - 今食べたボールに書かれた整数を $ v $ とする．ロボット $ v $ が存在するなら，それを，現在の座標より $ 1 $ 小さい座標へ移動させる．もし移動先に別のロボットがいるなら，そのロボットは破壊される．（ロボット $ v $ は無事である）

すぬけくんは，ロボット $ 0 $ が破壊されないように，すべてのボールを食べきりたいです． すぬけくんが目標を達成するために Step 1 で書き換える必要のあるボールの個数の最小値を求めてください．

## 输入格式

入力は以下の形式で標準入力から与えられる．

> $ N $ $ A_1 $ $ A_2 $ $ \ldots $ $ A_N $ $ B_1 $ $ B_2 $ $ \ldots $ $ B_N $

## 输出格式

答えを出力せよ．

## 说明/提示

### 制約

- $ 1\ \leq\ N\ \leq\ 2\ \times\ 10^5 $
- $ 1\ \leq\ A_1\ <\ A_2\ <\ \ldots\ <\ A_N\ \leq\ 10^9 $
- $ 1\ \leq\ B_i\ \leq\ 10^9 $

### Sample Explanation 1

$ 2 $ の書かれたボールを $ 1 $ つ選び，$ 3 $ に書き換えればよいです． その後，以下の順序でボールを食べればよいです． - $ 2 $ の書かれたボールを食べる．ロボット $ 2 $ を座標 $ 2 $ から座標 $ 1 $ へ移動させる． ロボット $ 1 $ が破壊される． - $ 3 $ の書かれたボールを食べる．ロボット $ 3 $ を座標 $ 3 $ から座標 $ 2 $ へ移動させる． - $ 3 $ の書かれたボールを食べる．ロボット $ 3 $ を座標 $ 2 $ から座標 $ 1 $ へ移動させる． ロボット $ 2 $ が破壊される． - $ 1 $ の書かれたボールを食べる．ロボット $ 1 $ はすでに破壊されているので，何もしない．

## 样例 #1

### 输入

```
3

1 2 3

1 2 1
```

### 输出

```
1
```

## 样例 #2

### 输入

```
4

1 3 5 7

3 1 4 1
```

### 输出

```
0
```



---

---
title: "[ARC079E] Decrease (Judge ver.)"
layout: "post"
diff: 提高+/省选-
pid: AT_arc079_c
tag: ['模拟', '二分']
---

# [ARC079E] Decrease (Judge ver.)

## 题目描述

[problemUrl]: https://atcoder.jp/contests/arc079/tasks/arc079_c

長さ $ N $ の非負整数列 $ a_i $ に対し、数列の最大値が $ N-1 $ 以下になるまで以下の操作を繰り返し行うことを考えます。なお、この操作はD問題で考える操作と同一です。

- 数列のうち最も大きい要素を求める、複数ある場合はどれか $ 1 $ つ選ぶ。この要素の値を $ N $ 減らす。これ以外の要素の値を $ 1 $ 増やす。

なお、この操作を行い続けると、いつかは数列の最大値が $ N-1 $ 以下になることが証明できます。

ここで、数列 $ a_i $ が与えられるので、何回操作を行うことになるかを求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ a_1 $ $ a_2 $ ... $ a_N $

## 输出格式

何回操作を行うことになるかを出力する。

## 说明/提示

### 制約

- $ 2\ ≦\ N\ ≦\ 50 $
- $ 0\ ≦\ a_i\ ≦\ 10^{16}\ +\ 1000 $

## 样例 #1

### 输入

```
4

3 3 3 3
```

### 输出

```
0
```

## 样例 #2

### 输入

```
3

1 0 3
```

### 输出

```
1
```

## 样例 #3

### 输入

```
2

2 2
```

### 输出

```
2
```

## 样例 #4

### 输入

```
7

27 0 0 0 0 0 0
```

### 输出

```
3
```

## 样例 #5

### 输入

```
10

1000 193 256 777 0 1 1192 1234567891011 48 425
```

### 输出

```
1234567894848
```



---

---
title: "[ARC116E] Spread of Information"
layout: "post"
diff: 提高+/省选-
pid: AT_arc116_e
tag: ['动态规划 DP', '贪心', '二分', '树形 DP']
---

# [ARC116E] Spread of Information

## 题目描述

[problemUrl]: https://atcoder.jp/contests/arc116/tasks/arc116_e

高橋国には $ N $ 箇所の町があり、それぞれ町 $ 1 $ 、町 $ 2 $、 $ \ldots $ 、町 $ N $ と名付けられています。 この国には $ N-1 $ 本の道があり、 $ i $ 本目の道は 町 $ u_i $ と町 $ v_i $ を双方向に結びます。任意の $ 2 $ つの町 $ a $, $ b $ について、いくつかの道を通ることにより、町 $ a $ から町 $ b $ へ移動することが出来ます。

高橋国王は、ある情報を国土全体に流そうとしています。多忙な高橋国王は、 $ K $ 箇所までの町にしか直接情報を伝達することが出来ません。

高橋国王の情報伝達が終わった瞬間を時刻 $ 0 $ とします。 $ t\ =\ 1,\ 2,\ 3,\ \cdots $ について、以下の現象が発生します。

- $ 1 $ 本の道で直接結ばれている町の組 $ a $, $ b $ について、 時刻 $ t-0.5 $ に町 $ a $ に情報が伝わっており、町 $ b $ に情報が伝わっていないとき、 時刻 $ t $ に町 $ b $ にも情報が伝わる。

高橋国王は $ K $ 箇所の連絡先を適切に選択し、全ての町に情報が伝わるまでに掛かる時間を最小化しようと考えています。最小値を答えてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ K $ $ u_1 $ $ v_1 $ $ u_2 $ $ v_2 $ $ \vdots $ $ u_{N-1} $ $ v_{N-1} $

## 输出格式

答えを出力せよ。

## 说明/提示

### 制約

- 入力は全て整数
- $ 1\ \leq\ K\ <\ N\ \leq\ 2\ \times\ 10^5 $
- $ 1\ \leq\ u_i,\ v_i\ \leq\ N $
- 任意の $ 2 $ つの町 $ a $, $ b $ について、いくつかの道を通ることにより、町 $ a $ から町 $ b $ へ移動することが出来る。

### Sample Explanation 1

高橋国王が町 $ 2 $ と町 $ 4 $ に直接情報を伝達した場合、町 $ 1 $ 、 $ \ldots $ 、町$ 5 $ に初めて情報が伝わる時刻は、それぞれ $ 1,\ 0,\ 1,\ 0,\ 1 $ となります。このとき、 国土全体に情報が広まるのは時刻 $ 1 $ であり、これが達成可能な最小値であることが証明出来ます。

## 样例 #1

### 输入

```
5 2

1 2

2 3

3 4

4 5
```

### 输出

```
1
```

## 样例 #2

### 输入

```
5 1

1 2

1 3

1 4

5 4
```

### 输出

```
2
```

## 样例 #3

### 输入

```
20 3

2 15

6 5

12 1

7 9

17 2

15 5

2 4

17 16

12 2

8 17

17 19

18 11

20 8

20 3

13 9

11 10

11 20

14 8

11 7
```

### 输出

```
3
```



---

---
title: "[ARC179C] Beware of Overflow"
layout: "post"
diff: 提高+/省选-
pid: AT_arc179_c
tag: ['贪心', '二分', '排序']
---

# [ARC179C] Beware of Overflow

## 题目描述

[problemUrl]: https://atcoder.jp/contests/arc179/tasks/arc179_c

この問題は**インタラクティブな問題**（あなたの作成したプログラムとジャッジシステムが入出力を介して対話を行う形式の問題）です.

正整数 $ N $ が与えられます.

ジャッジシステムは正整数 $ R $ および $ N $ 個の整数 $ A_1,A_2,\dots\ ,A_N $ を隠し持っています. ここで $ |A_i|\le\ R,\ \left|\displaystyle\sum_{i=1}^{N}A_i\right|\ \le\ R $ を満たすことが保証されます.

絶対値が $ R $ 以下の整数しか書き込むことができない黒板があり, はじめは何も書き込まれていません.

ジャッジシステムは, 黒板に $ A_1,A_2,\ \dots\ ,A_N $ の値を **この順で** 書き込みました. あなたは, 黒板にただ $ 1 $ つの値 $ \displaystyle\sum_{i=1}^{N}A_i $ が書き込まれている状態にする必要があります.

あなたは $ R $ および $ A_i $ の値を直接知ることはできませんが, その代わりにジャッジシステムに対して次のやり取りを $ 25000 $ 回まで行うことができます.

正整数 $ i $ について, $ i $ 番目に黒板に書き込まれた整数を $ X_i $ とします. 特に, $ i=1,2,\dots\ ,N $ について $ X_i=A_i $ です.

$ 1 $ 回のやり取りでは, 相異なる正整数 $ i,j $ を指定し, 次のいずれかを選んで行います.

- 足し算をしてもらう. ジャッジシステムは黒板から $ X_i,X_j $ を消し, 新たに $ X_i+X_j $ の値を黒板に書き込む.
  - $ |X_i+X_j|\le\ R $ を満たしていなくてはならない.
- 大小比較をしてもらう. ジャッジシステムは $ X_i\lt\ X_j $ の真偽を答える.

ただし, 各やり取りを始める時点で $ i,j $ 番目に黒板に書き込まれた整数がすでに黒板から消されていてはなりません.

適切にやり取りを行って, 全てのやり取りを終えた後に黒板にただ $ 1 $ つの値 $ \displaystyle\sum_{i=1}^{N}A_i $ が書き込まれている状態にしてください.

$ R $ および $ A_i $ はプログラムとジャッジシステムの対話の開始前に決定されます.

### Input &amp; Output Format

この問題はインタラクティブな問題（あなたの作成したプログラムとジャッジシステムが入出力を介して対話を行う形式の問題）です.

最初に, $ N $ を標準入力から受け取ってください.

> $ N $

次に, 黒板にただ $ 1 $ つの値 $ \displaystyle\sum_{i=1}^{N}A_i $ が書かれている状態になるまで, やり取りを繰り返してください.

足し算をしてもらうときは, 以下の形式で標準出力に出力してください. 末尾に改行を入れてください. ここで $ i,j $ は相異なる正整数です.

> + $ i $ $ j $

これに対するジャッジシステムの応答は, 次の形式で標準入力から与えられます.

> $ P $

ここで $ P $ は整数で,

- $ P\geq\ N+1 $ の場合は, $ X_i+X_j $ の値が黒板に書き込まれ, それが $ P $ 番目に書き込まれたことを表します.
- $ P=-1 $ の場合は, $ i,j $ が制約を満たしていないか, やり取りの回数が $ 25000 $ 回を超えたことを表します.

大小比較をしてもらうときは, 以下の形式で標準出力に出力してください. 末尾に改行を入れてください. ここで $ i,j $ は相異なる正整数です.

> ? $ i $ $ j $

これに対するジャッジシステムの応答は, 次の形式で標準入力から与えられます.

> $ Q $

ここで $ Q $ は整数で,

- $ Q=1 $ の場合は, $ X_i\ <\ X_j $ が真であることを表します.
- $ Q=0 $ の場合は, $ X_i\ <\ X_j $ が偽であることを表します.
- $ Q=-1 $ の場合は, $ i,j $ が制約を満たしていないか, やり取りの回数が $ 25000 $ 回を超えたことを表します.

足し算をしてもらうやり取りおよび大小比較をしてもらうやり取りのいずれについても, ジャッジシステムの応答が $ -1 $ であった場合は, プログラムはすでに不正解とみなされています. この場合, ただちにプログラムを終了してください.

黒板にただ $ 1 $ つの値 $ \displaystyle\sum_{i=1}^{N}A_i $ が書かれている状態になったら, 以下の形式でそのことをジャッジシステムに報告してください. ただし, これはジャッジシステムとのやり取りの回数に計上されません. その後, ただちにプログラムを終了してください.

```
!
```

上記のいずれの形式にも当てはまらない出力を行った場合は, `-1` が標準入力から与えられます.

```
-1
```

このときも, プログラムはすでに不正解とみなされています. ただちにプログラムを終了してください.

## 说明/提示

### 制約

- $ 2\leq\ N\leq\ 1000 $
- $ 1\leq\ R\leq\ 10^9 $
- $ |A_i|\leq\ R $
- $ \left|\displaystyle\sum_{i=1}^{N}A_i\right|\ \le\ R $
- $ N,R,A_i $ は整数.

### 注意点

- **出力を行うたびに, 末尾に改行を入れて標準出力を flush してください. そうしなかった場合, ジャッジ結果が TLE となる可能性があります.**
- 解答を出力したら（または `-1` を受け取ったら）ただちにプログラムを終了してください. そうしない場合, ジャッジ結果は不定です.
- 余計な改行は不正なフォーマットの出力とみなされることに注意してください.

### 入出力例

$ N=3,R=10,A_1=-1,A_2=10,A_3=1 $ のときの対話の一例を示します.

入力出力説明`3`まず整数 $ N $ が与えられます。`? 1 2`大小比較をしてもらいます.`1`$ X_1\lt\ X_2\ (-1\lt\ 10) $ なのでジャッジシステムは $ 1 $ を返します. `+ 1 3`足し算をしてもらいます.`4`ジャッジシステムは $ X_1=-1,X_3=1 $ を黒板から消し, $ X_1+X_3=0 $ の値を黒板に書き込みました. $ 4 $ 番目の書き込みでした.`+ 2 4`足し算をしてもらいます.`5`ジャッジシステムは $ X_2=10,X_4=0 $ を黒板から消し, $ X_2+X_4=10 $ の値を黒板に書き込みました. $ 5 $ 番目の書き込みでした.`!`黒板にはただ $ 1 $ つの値 $ \displaystyle\sum_{i=1}^{N}A_i $ が書き込まれている状態になったので, そのことをジャッジシステムに報告します.



---


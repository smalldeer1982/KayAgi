---
title: "[ABC334F] Christmas Present 2"
layout: "post"
diff: 提高+/省选-
pid: AT_abc334_f
tag: ['动态规划 DP', '单调队列']
---

# [ABC334F] Christmas Present 2

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc334/tasks/abc334_f

$ xy $ 平面として表される町があり、サンタさんと、$ 1 $ から $ N $ までの番号が付けられた $ N $ 人の子供が住んでいます。 サンタさんの家の座標は $ (S_X,S_Y) $ であり、子供 $ i\ (1\leq\ i\leq\ N) $ の家の座標は $ (X_i,Y_i) $ です。

サンタさんは、$ N $ 人の子供たちに**番号順に**プレゼントを $ 1 $ 個ずつ配りたいです。 子供 $ i $ にプレゼントを配るためには、プレゼントを $ 1 $ 個以上持った状態で子供 $ i $ の家に行く必要があります。 しかし、サンタさんは同時に $ K $ 個までしかプレゼントを持つことができず、プレゼントを補充するためには一旦自分の家に戻る必要があります（サンタさんの家には十分な数のプレゼントがあります）。

サンタさんが自分の家を出発し、$ N $ 人の子供たち全員にプレゼントを配って、自分の家まで戻ってくるために移動する距離の最小値を求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ K $ $ S_X $ $ S_Y $ $ X_1 $ $ Y_1 $ $ X_2 $ $ Y_2 $ $ \vdots $ $ X_N $ $ Y_N $

## 输出格式

サンタさんが移動する距離の最小値を出力せよ。 出力は、真の値との絶対誤差または相対誤差が $ 10^{−6} $ 以下のとき正解と判定される。

## 说明/提示

### 制約

- $ 1\leq\ K\leq\ N\ \leq\ 2\times\ 10^5 $
- $ -10^9\leq\ S_X,S_Y,X_i,Y_i\ \leq\ 10^9 $
- $ (S_X,S_Y)\neq\ (X_i,Y_i) $
- $ (X_i,Y_i)\neq\ (X_j,Y_j)\ (i\neq\ j) $
- 入力は全て整数

### Sample Explanation 1

![](https://img.atcoder.jp/abc334/3c258c2a4866ff2c01dbcdbdfebb4111.png) 

上図において、赤い丸はサンタさんの家、中に数字が書かれた丸はその番号の子供の家を表しています。 サンタさんが以下のように行動することを考えます。 1. プレゼントを $ 2 $ 個持ってサンタさんの家を出る。 2. 子供 $ 1 $ の家に行ってプレゼントを $ 1 $ 個配る。 3. サンタさんの家に戻ってプレゼントを $ 1 $ 個補充する。 4. 子供 $ 2 $ の家に行ってプレゼントを $ 1 $ 個配る。 5. 子供 $ 3 $ の家に行ってプレゼントを $ 1 $ 個配る。 6. サンタさんの家に戻る。 このとき、サンタさんが移動する距離は $ 2+2+1+2+\sqrt{5}=7+\sqrt{5}=9.236\dots $ となり、これが最小です。

## 样例 #1

### 输入

```
3 2
1 1
3 1
1 2
3 2
```

### 输出

```
9.236067977499790
```

## 样例 #2

### 输入

```
2 1
0 1
-1 1
1 1
```

### 输出

```
4.000000000000000
```

## 样例 #3

### 输入

```
8 3
735867677 193944314
586260100 -192321079
95834122 802780784
418379342 -790013317
-445130206 189801569
-354684803 -49687658
-204491568 -840249197
853829789 470958158
-751917965 762048217
```

### 输出

```
11347715738.116592407226562
```



---

---
title: "[AGC058B] Adjacent Chmax"
layout: "post"
diff: 提高+/省选-
pid: AT_agc058_b
tag: ['动态规划 DP', '单调队列']
---

# [AGC058B] Adjacent Chmax

## 题目描述

## 题目翻译


给你一个 $1 \sim n$ 的排列 $P$ ,你可以进行若干次如下操作，也可以不进行操作。

- 每次选择一个整数 $i$ ($1\ \leq\ i\ \leq\ N-1$) ，使 $v=\max(P_i,P_{i+1})$ ，然后将 $P_i$ 和 $P_{i+1}$ 改为 $v$ 。

求问最后可能得到多少种不同的结果，答案对 $ 998244353 $ 取模。

## 输入格式

第一行一行一个整数 $N$ 。

第二行 $N$ 个整数，第 $i$ 个数表示 $P_i$ 。

## 输出格式

一行一个整数，多少种不同的结果。

## 说明/提示

- $ 2\ \leq\ N\ \leq\ 5000 $
- $ (P_1,P_2,\cdots,P_N) $ 为 $ (1,2,\cdots,N) $ 的排列
- 输入均为整数

### 样例解释 1

操作后 $P$ 可能为 $(1,3,2),(3,3,2),(1,3,3),(3,3,3)$ 这 $4$ 种结果。

## 样例 #1

### 输入

```
3

1 3 2
```

### 输出

```
4
```

## 样例 #2

### 输入

```
4

2 1 3 4
```

### 输出

```
11
```

## 样例 #3

### 输入

```
10

4 9 6 3 8 10 1 2 7 5
```

### 输出

```
855
```



---


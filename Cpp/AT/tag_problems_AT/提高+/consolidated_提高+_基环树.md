---
title: "[ABC284G] Only Once"
layout: "post"
diff: 提高+/省选-
pid: AT_abc284_g
tag: ['组合数学', '基环树']
---

# [ABC284G] Only Once

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc284/tasks/abc284_g

$ 1 $ 以上 $ N $ 以下の整数からなる長さ $ N $ の数列 $ A\ =\ (A_1,A_2,\dots,A_N) $ および整数 $ i\ (1\leq\ i\ \leq\ N) $ に対して、 長さ $ 10^{100} $ の数列 $ B_i=(B_{i,1},B_{i,2},\dots,B_{i,10^{100}}) $ を以下のように定義します。

- $ B_{i,1}=i $
- $ B_{i,j+1}=A_{B_{i,j}}\ (1\leq\ j\ <\ 10^{100}) $
 
また、$ S_i $ を「数列 $ B_i $ のなかでちょうど $ 1 $ 度だけ出てくる数の種類数」と定義します。 より厳密には、$ S_i $ は「$ B_{i,j}=k $ を満たす $ j\ (1\leq\ j\leq\ 10^{100}) $ がちょうど $ 1 $ つであるような $ k $ の数」です。

整数 $ N $ が与えられます。数列 $ A $ として考えられるものは $ N^N $ 通りありますが、それら全てに対して $ \displaystyle\ \sum_{i=1}^{N}\ S_i $ を求め、 その総和を $ M $ で割った余りを答えてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ M $

## 输出格式

答えを整数として出力せよ。

## 说明/提示

### 制約

- $ 1\leq\ N\ \leq\ 2\times\ 10^5 $
- $ 10^8\leq\ M\ \leq\ 10^9 $
- $ N,M $ は整数
 
### Sample Explanation 1

例として、$ A=(2,3,3,4) $ の場合を考えます。 - $ i=1 $ のとき : $ B_1=(1,2,3,3,3,\dots) $ となるから、$ 1 $ 度だけ出てくる数は $ 1,2 $ の $ 2 $ つで、$ S_1=2 $ - $ i=2 $ のとき : $ B_2=(2,3,3,3,\dots) $ となるから、$ 1 $ 度だけ出てくる数は $ 2 $ のみで、$ S_2=1 $ - $ i=3 $ のとき : $ B_3=(3,3,3,\dots) $ となるから、$ 1 $ 度だけ出てくる数は存在せず、$ S_3=0 $ - $ i=4 $ のとき : $ B_4=(4,4,4,\dots) $ となるから、$ 1 $ 度だけ出てくる数は存在せず、$ S_4=0 $ よって、$ \displaystyle\ \sum_{i=1}^{N}\ S_i=2+1+0+0=3 $ です。 他の $ 255 $ 通りの $ A $ に対しても同様に $ \displaystyle\ \sum_{i=1}^{N}\ S_i $ を計算したうえで、 $ 256 $ 通り全ての総和をとると $ 624 $ になります。

### Sample Explanation 3

総和を $ M $ で割った余りを出力してください。

## 样例 #1

### 输入

```
4 100000000
```

### 输出

```
624
```

## 样例 #2

### 输入

```
7 1000000000
```

### 输出

```
5817084
```

## 样例 #3

### 输入

```
2023 998244353
```

### 输出

```
737481389
```

## 样例 #4

### 输入

```
100000 353442899
```

### 输出

```
271798911
```



---

---
title: "[ABC399E] Replace"
layout: "post"
diff: 提高+/省选-
pid: AT_abc399_e
tag: ['图论', '图论建模', '基环树']
---

# [ABC399E] Replace

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc399/tasks/abc399_e

给定一个正整数 $N$ 以及两个长度为 $N$ 的小写英文字母字符串 $S$ 和 $T$。  
请判断是否可以通过重复以下操作（允许 0 次操作）将 $S$ 变为 $T$。若可能，还需输出所需的最小操作次数。

**操作**：  
选择两个小写英文字母 $x$ 和 $y$，将 $S$ 中 **所有** 出现的 $x$ 替换为 $y$。

## 输入格式

输入通过标准输入给出，格式如下：

> $N$  
> $S$  
> $T$

## 输出格式

若可以将 $S$ 变为 $T$，则输出所需的最小操作次数；否则输出 $-1$。

## 说明/提示

### 约束条件

- $1 \leq N \leq 2 \times 10^5$
- $N$ 为整数
- $S$ 和 $T$ 均为长度为 $N$ 的小写英文字母字符串

### 样例解释 1

通过以下 4 次操作可将 $S$ 变为 $T$：
1. 选择 $x=$ `b`, $y=$ `c`，操作后 $S=$ `afcfda`
2. 选择 $x=$ `a`, $y=$ `b`，操作后 $S=$ `bfcfdb`
3. 选择 $x=$ `f`, $y=$ `k`，操作后 $S=$ `bkckdb`
4. 选择 $x=$ `d`, $y=$ `b`，操作后 $S=$ `bkckbb`（与 $T$ 一致）

由于无法在 3 次或更少操作内完成，最小操作次数为 4。

### 样例解释 2

$S$ 与 $T$ 初始时已一致，无需任何操作。

### 样例解释 3

无论如何操作，都无法将 $S$ 变为 $T$。

翻译由 DeepSeek R1 完成

## 样例 #1

### 输入

```
6

afbfda

bkckbb
```

### 输出

```
4
```

## 样例 #2

### 输入

```
4

abac

abac
```

### 输出

```
0
```

## 样例 #3

### 输入

```
4

abac

abrc
```

### 输出

```
-1
```

## 样例 #4

### 输入

```
4

abac

bcba
```

### 输出

```
4
```



---


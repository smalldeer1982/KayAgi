---
title: "[ABC266G] Yet Another RGB Sequence"
layout: "post"
diff: 提高+/省选-
pid: AT_abc266_g
tag: ['组合数学', '容斥原理']
---

# [ABC266G] Yet Another RGB Sequence

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc266/tasks/abc266_g

整数 $ R,G,B,K $ が与えられます。`R`, `G`, `B` からなる文字列 $ S $ であって、以下の条件をすべて満たすものの個数を $ 998244353 $ で割った余りを求めてください。

- $ S $ に含まれる `R`, `G`, `B` の個数はそれぞれ $ R,G,B $ 個である。
- $ S $ に（連続する）部分文字列として含まれる `RG` の個数は $ K $ 個である。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ R $ $ G $ $ B $ $ K $

## 输出格式

答えを出力せよ。

## 说明/提示

### 制約

- $ 1\ \leq\ R,G,B\leq\ 10^6 $
- $ 0\ \leq\ K\ \leq\ \mathrm{min}(R,G) $
- 入力は全て整数

### Sample Explanation 1

条件を満たす文字列は以下の $ 6 $ 個です。 - `RRGB` - `RGRB` - `RGBR` - `RBRG` - `BRRG` - `BRGR`

### Sample Explanation 2

個数を $ 998244353 $ で割った余りを求めてください。

## 样例 #1

### 输入

```
2 1 1 1
```

### 输出

```
6
```

## 样例 #2

### 输入

```
1000000 1000000 1000000 1000000
```

### 输出

```
80957240
```



---

---
title: "[ABC377F] Avoid Queen Attack"
layout: "post"
diff: 提高+/省选-
pid: AT_abc377_f
tag: ['容斥原理']
---

# [ABC377F] Avoid Queen Attack

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc377/tasks/abc377_f

縦 $ N $ マス、横 $ N $ マスの $ N\ ^\ 2 $ マスからなるマス目があります。 上から $ i $ 行目 $ (1\leq\ i\leq\ N) $ 、左から $ j $ 列目 $ (1\leq\ j\leq\ N) $ のマスをマス $ (i,j) $ と呼ぶことにします。

それぞれのマスは、空マスであるかコマが置かれているかのどちらかです。 マス目には合計で $ M $ 個のコマが置かれており、$ k $ 番目 $ (1\leq\ k\leq\ M) $ のコマはマス $ (a\ _\ k,b\ _\ k) $ に置かれています。

あなたは、すでに置かれている**どのコマにも取られないように**、いずれかの**空マス**に自分のコマを置きたいです。

マス $ (i,j) $ に置かれているコマは、次のどれかの条件を満たすコマを取ることができます。

- $ i $ 行目に置かれている
- $ j $ 列目に置かれている
- $ i+j=a+b $ となるようなマス $ (a,b)\ (1\leq\ a\leq\ N,1\leq\ b\leq\ N) $ に置かれている
- $ i-j=a-b $ となるようなマス $ (a,b)\ (1\leq\ a\leq\ N,1\leq\ b\leq\ N) $ に置かれている
 
たとえば、マス $ (4,4) $ に置かれているコマは、以下の図で青く示されたマスに置かれているコマを取ることができます。

![](https://cdn.luogu.com.cn/upload/vjudge_pic/AT_abc377_f/8d18db86e94185f3231deea439fe06a4aa9df2f8.png)

あなたがコマを置くことができるマスがいくつあるか求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ M $ $ a\ _\ 1 $ $ b\ _\ 1 $ $ a\ _\ 2 $ $ b\ _\ 2 $ $ \vdots $ $ a\ _\ M $ $ b\ _\ M $

## 输出格式

すでに置かれているコマに取られずに自分のコマを置くことができる空マスの個数を出力せよ。

## 说明/提示

### 制約

- $ 1\leq\ N\leq10\ ^\ 9 $
- $ 1\leq\ M\leq10\ ^\ 3 $
- $ 1\leq\ a\ _\ k\leq\ N,1\leq\ b\ _\ k\leq\ N\ (1\leq\ k\leq\ M) $
- $ (a\ _\ k,b\ _\ k)\neq(a\ _\ l,b\ _\ l)\ (1\leq\ k\lt\ l\leq\ M) $
- 入力はすべて整数
 
### Sample Explanation 1

すでに置かれているコマは、以下の図で青く示されたマスに置かれたコマを取ることができます。 !\[\](https://img.atcoder.jp/abc377/49766c3613371e99673e5722bd64ad58.png) よって、あなたがすでに置かれているコマに取られないように自分のコマを置くことができるマスはマス $ (6,6) $ とマス $ (7,7) $ の $ 2 $ つです。

### Sample Explanation 2

$ 10\ ^\ {18} $ マスのうち、置くことができないマスは $ 1 $ 行目のマス、$ 1 $ 列目のマス、およびマス $ (1,1), $ マス $ (2,2),\ldots, $ マス $ (10\ ^\ 9,10\ ^\ 9) $ の $ 3\times10\ ^\ 9-2 $ マスです。 答えが $ 2\ ^\ {32} $ 以上になる場合があることに注意してください。

## 样例 #1

### 输入

```
8 6

1 4

2 1

3 8

4 5

5 2

8 3
```

### 输出

```
2
```

## 样例 #2

### 输入

```
1000000000 1

1 1
```

### 输出

```
999999997000000002
```

## 样例 #3

### 输入

```
20 10

1 4

7 11

7 15

8 10

11 6

12 5

13 1

15 2

20 10

20 15
```

### 输出

```
77
```



---

---
title: "[ARC115E] LEQ and NEQ"
layout: "post"
diff: 提高+/省选-
pid: AT_arc115_e
tag: ['动态规划 DP', '容斥原理']
---

# [ARC115E] LEQ and NEQ

## 题目描述

[problemUrl]: https://atcoder.jp/contests/arc115/tasks/arc115_e

長さ $ N $ の整数列 $ A_1,A_2,\ldots,A_N $ が与えられます。長さ $ N $ の整数列 $ X_1,X_2,\ldots,X_N $ であって、以下の条件をすべて満たすものはいくつあるか求め、$ 998244353 $ で割った余りを出力してください。

- $ 1\ \leq\ X_i\ \leq\ A_i $
- $ X_i\ \neq\ X_{i+1}\ (1\ \leq\ i\ \leq\ N-1) $

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ A_1 $ $ A_2 $ $ \ldots $ $ A_N $

## 输出格式

答えを出力せよ。

## 说明/提示

### 制約

- $ 2\ \leq\ N\ \leq\ 5\ \times\ 10^5 $
- $ 1\ \leq\ A_i\ \leq\ 10^9 $

### Sample Explanation 1

条件をすべて満たす整数列は以下の $ 6 $ 通りです。 - $ 1,2,1 $ - $ 1,3,1 $ - $ 1,3,2 $ - $ 2,1,2 $ - $ 2,3,1 $ - $ 2,3,2 $

## 样例 #1

### 输入

```
3

2 3 2
```

### 输出

```
6
```

## 样例 #2

### 输入

```
10

158260522 877914575 602436426 24979445 861648772 623690081 433933447 476190629 262703497 211047202
```

### 输出

```
524691026
```



---

---
title: "Grid 2"
layout: "post"
diff: 提高+/省选-
pid: AT_dp_y
tag: ['动态规划 DP', '容斥原理']
---

# Grid 2

## 题目描述

[problemUrl]: https://atcoder.jp/contests/dp/tasks/dp_y

縦 $ H $ 行、横 $ W $ 列のグリッドがあります。 上から $ i $ 行目、左から $ j $ 列目のマスを $ (i,\ j) $ で表します。

グリッドのうち、$ N $ 個のマス $ (r_1,\ c_1),\ (r_2,\ c_2),\ \ldots,\ (r_N,\ c_N) $ は壁のマスであり、それら以外のマスはすべて空マスです。 マス $ (1,\ 1) $ および $ (H,\ W) $ は空マスであることが保証されています。

太郎君は、マス $ (1,\ 1) $ から出発し、右または下に隣り合う空マスへの移動を繰り返すことで、マス $ (H,\ W) $ まで辿り着こうとしています。

マス $ (1,\ 1) $ から $ (H,\ W) $ までの太郎君の経路は何通りでしょうか？ $ 10^9\ +\ 7 $ で割った余りを求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ H $ $ W $ $ N $ $ r_1 $ $ c_1 $ $ r_2 $ $ c_2 $ $ : $ $ r_N $ $ c_N $

## 输出格式

マス $ (1,\ 1) $ から $ (H,\ W) $ までの太郎君の経路は何通りか？ $ 10^9\ +\ 7 $ で割った余りを出力せよ。

## 说明/提示

### 制約

- 入力はすべて整数である。
- $ 2\ \leq\ H,\ W\ \leq\ 10^5 $
- $ 1\ \leq\ N\ \leq\ 3000 $
- $ 1\ \leq\ r_i\ \leq\ H $
- $ 1\ \leq\ c_i\ \leq\ W $
- マス $ (r_i,\ c_i) $ はすべて相異なる。
- マス $ (1,\ 1) $ および $ (H,\ W) $ は空マスである。

### Sample Explanation 1

経路は次図の $ 3 $ 通りです。 !\[\](https://img.atcoder.jp/dp/grid\_1\_0\_muffet.png)

### Sample Explanation 2

経路が存在しない場合もあります。

### Sample Explanation 4

答えを $ 10^9\ +\ 7 $ で割った余りを出力することを忘れずに。

## 样例 #1

### 输入

```
3 4 2

2 2

1 4
```

### 输出

```
3
```

## 样例 #2

### 输入

```
5 2 2

2 1

4 2
```

### 输出

```
0
```

## 样例 #3

### 输入

```
5 5 4

3 1

3 5

1 3

5 3
```

### 输出

```
24
```

## 样例 #4

### 输入

```
100000 100000 1

50000 50000
```

### 输出

```
123445622
```



---


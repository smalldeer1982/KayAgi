---
title: "[ABC368E] Train Delay"
layout: "post"
diff: 提高+/省选-
pid: AT_abc368_e
tag: ['堆', '差分约束']
---

# [ABC368E] Train Delay

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc368/tasks/abc368_e

Atcoder 国には $ 1 $ から $ N $ の番号がついた $ N $ 個の街と、$ 1 $ から $ M $ の番号がついた $ M $ 本の電車が走っています。  
 電車 $ i $ は街 $ A_i $ を時刻 $ S_i $ に発車し、街 $ B_i $ に時刻 $ T_i $ に到着します。

正の整数 $ X_1 $ が与えられるので、$ 0 $ 以上の整数 $ X_2,\ldots,X_M $ を以下の条件を満たすように定める方法のうち、$ X_2+\ldots+X_M $ が最小になるものを求めてください。

- 条件：$ 1\ \leq\ i,j\ \leq\ M $ を満たす全ての組 $ (i,j) $ について、「$ B_i=A_j $ かつ $ T_i\ \leq\ S_j $」ならば「$ T_i+X_i\ \leq\ S_j+X_j $」
  - すなわち、もともと乗り換え可能だった電車の組は、各電車 $ i $ の発車時刻・到着時刻を $ X_i $ 遅らせても乗り換え可能である
 
なお、$ X_2+\ldots+X_M $ が最小になるような $ X_2,\ldots,X_M $ の定め方は一意であることが証明できます。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ M $ $ X_1 $ $ A_1 $ $ B_1 $ $ S_1 $ $ T_1 $ $ \vdots $ $ A_M $ $ B_M $ $ S_M $ $ T_M $

## 输出格式

条件を満たし、和を最小化するような $ X_2,\ldots,X_M $ を、この順に空白区切りで出力せよ。

## 说明/提示

### 制約

- $ 2\ \leq\ N\ \leq\ 2\times\ 10^5 $
- $ 2\ \leq\ M\ \leq\ 2\times\ 10^5 $
- $ 1\ \leq\ A_i,B_i\ \leq\ N $
- $ A_i\ \neq\ B_i $
- $ 0\ \leq\ S_i\ <\ T_i\ \leq\ 10^9 $
- $ 1\ \leq\ X_1\ \leq\ 10^9 $
- 入力は全て整数
 
### Sample Explanation 1

街 $ 1 $ から $ 2 $ へ行く電車 $ 1 $ の到着が $ 15 $ 遅れ、時刻 $ 35 $ になりました。 街 $ 2 $ での電車 $ 1 $ から $ 3 $ への乗り換えのため、電車 $ 3 $ の発車時刻を $ 10 $ 遅らせて、時刻 $ 35 $ 発 時刻 $ 50 $ 着とします。 さらに街 $ 3 $ での電車 $ 3 $ から $ 6 $ への乗り換えのため、電車 $ 6 $ の発車時刻を $ 5 $ 遅らせて、時刻 $ 50 $ 発とします。 他の電車は発車を遅らせることなく、元々乗り換え可能だった電車の間を乗り換えることができるため、$ (X_2,X_3,X_4,X_5,X_6)=(0,10,0,0,5) $ は条件を満たします。 また、条件を満たすもののうち和がこれより小さいものは存在しないため、これが答えとなります。

## 样例 #1

### 输入

```
3 6 15

1 2 10 20

1 2 20 30

2 3 25 40

2 3 35 50

3 1 15 30

3 1 45 60
```

### 输出

```
0 10 0 0 5
```

## 样例 #2

### 输入

```
10 9 100

1 10 0 1

10 2 1 100

10 3 1 100

10 4 1 100

10 5 1 100

10 6 1 100

10 7 1 100

10 8 1 100

10 9 1 100
```

### 输出

```
100 100 100 100 100 100 100 100
```

## 样例 #3

### 输入

```
4 4 10

1 2 0 1

1 2 0 10

2 3 100 200

2 4 100 200
```

### 输出

```
0 0 0
```



---

---
title: "[AGC043B] 123 Triangle"
layout: "post"
diff: 提高+/省选-
pid: AT_agc043_b
tag: ['数论', '排列组合', 'Lucas 定理', '差分']
---

# [AGC043B] 123 Triangle

## 题目描述

[problemUrl]: https://atcoder.jp/contests/agc043/tasks/agc043_b

各要素が $ 1 $ か $ 2 $ か $ 3 $ である長さ $ N $ の数字列 $ a_1a_2\ldots\ a_N $ が与えられます。 $ x_{i,j} $ を次のように定義します。

- $ x_{1,j}\ :=\ a_j $ $ \quad $ ($ 1\ \leq\ j\ \leq\ N $)
- $ x_{i,j}\ :=\ |\ x_{i-1,j}\ -\ x_{i-1,j+1}\ | $ $ \quad $ ($ 2\ \leq\ i\ \leq\ N $ かつ $ 1\ \leq\ j\ \leq\ N+1-i $)

$ x_{N,1} $ を求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ a_1 $$ a_2 $$ \ldots $$ a_N $

## 输出格式

$ x_{N,1} $ を出力せよ。

## 说明/提示

### 制約

- $ 2\ ≦\ N\ ≦\ 10^6 $
- $ a_i\ =\ 1,2,3 $ $ (1\ \leq\ i\ \leq\ N) $

### Sample Explanation 1

$ x_{1,1},x_{1,2},x_{1,3},x_{1,4} $ はそれぞれ、$ 1,2,3,1 $ です。 $ x_{2,1},x_{2,2},x_{2,3} $ はそれぞれ、$ |1-2|\ =\ 1,|2-3|\ =\ 1,|3-1|\ =\ 2 $ です。 $ x_{3,1},x_{3,2} $ はそれぞれ、$ |1-1|\ =\ 0,|1-2|\ =\ 1 $ です。 最後に、 $ x_{4,1}\ =\ |0-1|\ =\ 1 $ なので、答えは $ 1 $ です。

## 样例 #1

### 输入

```
4

1231
```

### 输出

```
1
```

## 样例 #2

### 输入

```
10

2311312312
```

### 输出

```
0
```



---

---
title: "[ARC153C] ± Increasing Sequence"
layout: "post"
diff: 提高+/省选-
pid: AT_arc153_c
tag: ['前缀和', '构造', '差分']
---

# [ARC153C] ± Increasing Sequence

## 题目描述

[problemUrl]: https://atcoder.jp/contests/arc153/tasks/arc153_c

$ 1 $ と $ -1 $ のみからなる長さ $ N $ の数列 $ A\ =\ (A_1,\ \ldots,\ A_N) $ が与えられます．

以下の条件をすべて満たす整数列 $ x\ =\ (x_1,\ \ldots,\ x_N) $ が存在するか否かを判定し， 存在する場合にはそのような整数列をひとつ答えてください．

- 任意の $ i $ ($ 1\leq\ i\leq\ N $) に対して $ |x_i|\ \leq\ 10^{12} $．
- $ x $ は狭義単調増加である．つまり $ x_1\ <\ \cdots\ <\ x_N $．
- $ \sum_{i=1}^N\ A_ix_i\ =\ 0 $．

## 输入格式

入力は以下の形式で標準入力から与えられます．

> $ N $ $ A_1 $ $ \ldots $ $ A_N $

## 输出格式

問題の条件をすべて満たす整数列 $ x $ が存在するならば `Yes` を，そうでなければ `No` を出力してください．`Yes` の場合には，$ 2 $ 行目にそのような整数列 $ x $ の各要素を，空白で区切って $ 1 $ 行で出力してください．

> $ x_1 $ $ \ldots $ $ x_N $

条件を満たす整数列が複数存在する場合は，どれを出力しても正解となります．

## 说明/提示

### 制約

- $ 1\leq\ N\leq\ 2\times\ 10^5 $
- $ A_i\ \in\ \lbrace\ 1,\ -1\rbrace $
 
### Sample Explanation 1

この出力について $ \sum_{i=1}^NA_ix_i=\ -(-3)\ +\ (-1)\ -\ 4\ -\ 5\ +\ 7\ =\ 0 $ となります．

## 样例 #1

### 输入

```
5

-1 1 -1 -1 1
```

### 输出

```
Yes

-3 -1 4 5 7
```

## 样例 #2

### 输入

```
1

-1
```

### 输出

```
Yes

0
```

## 样例 #3

### 输入

```
2

1 -1
```

### 输出

```
No
```



---


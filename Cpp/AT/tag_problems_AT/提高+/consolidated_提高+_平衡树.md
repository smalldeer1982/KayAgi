---
title: "[ABC403G] Odd Position Sum Query"
layout: "post"
diff: 提高+/省选-
pid: AT_abc403_g
tag: ['线段树', '平衡树']
---

# [ABC403G] Odd Position Sum Query

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc403/tasks/abc403_g

初始有一个空数列 $A$。

需要依次处理 $Q$ 个查询。第 $i$ 个查询的描述如下：

> 给定整数 $y_i$。定义 $z$ 为：当 $i=1$ 时 $z=0$，否则 $z$ 为第 $i-1$ 个查询的答案。然后定义 $x_i=((y_i+z)\bmod 10^9)+1$。将 $x_i$ 添加到 $A$ 的末尾。
> 
> 接着，将 $A$ 升序排列得到序列 $B=(B_1,B_2,\ldots,B_i)$，求 $B$ 中奇数位置元素的总和。即若 $m$ 为不超过 $i$ 的最大奇数，则求 $B_1+B_3+B_5+\ldots+B_m$。

## 输入格式

输入通过标准输入给出，格式如下：

> $Q$  
> $y_1$  
> $y_2$  
> $\vdots$  
> $y_Q$

## 输出格式

输出 $Q$ 行。第 $i$ 行输出第 $i$ 个查询的答案。


## 说明/提示

### 约束条件

- $1 \leq Q \leq 3 \times 10^5$
- $0 \leq y_i < 10^9$
- $1 \leq x_i \leq 10^9$
- 输入均为整数

### 样例解释 #1

- 第 1 个查询：$y_1=1,z=0$，故 $x_1=((1+0)\bmod 10^9)+1=2$。$A$ 变为 $(2)$，排序后 $B=(2)$，答案为 $B_1=2$。
- 第 2 个查询：$y_2=3,z=2$，故 $x_2=((3+2)\bmod 10^9)+1=6$。$A$ 变为 $(2,6)$，排序后 $B=(2,6)$，答案为 $B_1=2$。
- 第 3 个查询：$y_3=1,z=2$，故 $x_3=((1+2)\bmod 10^9)+1=4$。$A$ 变为 $(2,6,4)$，排序后 $B=(2,4,6)$，答案为 $B_1+B_3=8$。
- 第 4 个查询：$y_4=999999994,z=8$，故 $x_4=((999999994+8)\bmod 10^9)+1=3$。$A$ 变为 $(2,6,4,3)$，排序后 $B=(2,3,4,6)$，答案为 $B_1+B_3=6$。
- 第 5 个查询：$y_5=999999993,z=6$，故 $x_5=((999999993+6)\bmod 10^9)+1=1000000000$。$A$ 变为 $(2,6,4,3,1000000000)$，排序后 $B=(2,3,4,6,1000000000)$，答案为 $B_1+B_3+B_5=1000000006$。

### 样例解释 #2

$x_1,x_2,\ldots,x_8$ 的值依次为：

- 105282054
- 800516877
- 573289179
- 26509423
- 168629803
- 696409999
- 656737335
- 915059758

翻译由 DeepSeek V3 完成

## 样例 #1

### 输入

```
5
1
3
1
999999994
999999993
```

### 输出

```
2
2
8
6
1000000006
```

## 样例 #2

### 输入

```
8
105282053
695234822
468007124
120710491
568831200
700753895
765188109
262666319
```

### 输出

```
105282054
105282054
905798931
599798602
995656103
891549225
1652393438
1652393438
```



---

---
title: "[ARC153B] Grid Rotations"
layout: "post"
diff: 提高+/省选-
pid: AT_arc153_b
tag: ['数学', '平衡树']
---

# [ARC153B] Grid Rotations

## 题目描述

[problemUrl]: https://atcoder.jp/contests/arc153/tasks/arc153_b

縦 $ H $ 行，横 $ W $ 列のグリッドがあります．はじめ，上から $ i $ 行目，左から $ j $ 列目のマスには英小文字 $ A_{i,j} $ が書かれています．

このグリッドに対して $ Q $ 回の操作を行います．$ i $ 回目の操作では，$ 1\leq\ a_i\ \leq\ H-1 $, $ 1\leq\ b_i\leq\ W-1 $ を満たす整数 $ a_i,\ b_i $ が与えられ，次を行います．

- グリッド内の長方形領域 $ R_1,\ R_2,\ R_3,\ R_4 $ を次で定める：
  - 上から $ a_i $ 行，左から $ b_i $ 列の部分を $ R_1 $ とする．
  - 上から $ a_i $ 行，右から $ W-b_i $ 列の部分を $ R_2 $ とする．
  - 下から $ H-a_i $ 行，左から $ b_i $ 列の部分を $ R_3 $ とする．
  - 下から $ H-a_i $ 行，右から $ W-b_i $ 列の部分を $ R_4 $ とする．
- $ R_1,\ R_2,\ R_3,\ R_4 $ のそれぞれを $ 180 $ 度回転する．
 
ただし，グリッド内の長方形領域 $ R $ の $ 180 $ 度回転とは，$ R $ において上から $ i $ 番目，左から $ j $ 番目のマスに書かれた文字を，$ R $ において 下から $ i $ 番目，右から $ j $ 番目のマスに移すことをいいます．入出力例の図も参考にしてください．

$ Q $ 回すべての操作を行ったとき，操作後のグリッドの状態を出力してください．

## 输入格式

入力は以下の形式で標準入力から与えられます．

> $ H $ $ W $ $ A_{1,1}\cdots\ A_{1,\ W} $ $ \vdots $ $ A_{H,1}\cdots\ A_{H,\ W} $ $ Q $ $ a_1 $ $ b_1 $ $ \vdots $ $ a_Q $ $ b_Q $

## 输出格式

操作後のマス $ (i,j) $ に書かれている文字を $ B_{i,j} $ とするとき，操作後のグリッドの状態を，次の形式で出力してください．

> $ B_{1,1}\cdots\ B_{1,\ W} $ $ \vdots $ $ B_{H,1}\cdots\ B_{H,\ W} $

## 说明/提示

### 制約

- $ 2\leq\ H,\ W $ かつ $ HW\ \leq\ 5\times\ 10^5 $
- $ A_{i,j} $ は英小文字
- $ 1\leq\ Q\leq\ 2\times\ 10^5 $
- $ 1\leq\ a_i\leq\ H\ -\ 1 $
- $ 1\leq\ b_i\leq\ W\ -\ 1 $
 
### Sample Explanation 1

グリッドの状態は次の図のように変化します． !\[\](https://img.atcoder.jp/arc153/5503f0a5f92e488238556b943aa1d6b7.png)

### Sample Explanation 2

グリッドの状態は次の図のように変化します． !\[\](https://img.atcoder.jp/arc153/353f0b30a9561e38967fb3aedf5767c5.png)

### Sample Explanation 3

グリッドの状態は次の図のように変化します． !\[\](https://img.atcoder.jp/arc153/655a0ac98f0625e806f6abc97853a437.png)

## 样例 #1

### 输入

```
4 5

abcde

fghij

klmno

pqrst

1

3 3
```

### 输出

```
mlkon

hgfji

cbaed

rqpts
```

## 样例 #2

### 输入

```
3 7

atcoder

regular

contest

2

1 1

2 5
```

### 输出

```
testcon

oderatc

ularreg
```

## 样例 #3

### 输入

```
2 2

ac

wa

3

1 1

1 1

1 1
```

### 输出

```
ac

wa
```



---


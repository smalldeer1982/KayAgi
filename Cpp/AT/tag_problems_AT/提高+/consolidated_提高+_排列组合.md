---
title: "[ABC281G] Farthest City"
layout: "post"
diff: 提高+/省选-
pid: AT_abc281_g
tag: ['动态规划 DP', '组合数学', '排列组合']
---

# [ABC281G] Farthest City

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc281/tasks/abc281_g

正整数 $ N,\ M $ が与えられます。  
 頂点に $ 1,\ \dots,\ N $ の番号が付けられた $ N $ 頂点の単純連結無向グラフであって、以下の条件を満たすものの総数を $ M $ で割った余りを求めてください。

- 全ての $ u\ =\ 2,\ \dots,\ N-1 $ について、頂点 $ 1 $ から頂点 $ u $ までの最短距離は、頂点 $ 1 $ から頂点 $ N $ までの最短距離より真に小さい。
 
ただし、頂点 $ u $ から頂点 $ v $ までの最短距離とは、頂点 $ u,\ v $ を結ぶ単純パスに含まれる辺の本数の最小値を指します。  
 また、$ 2 $ つのグラフが異なるとは、ある $ 2 $ 頂点 $ u,\ v $ が存在して、これらの頂点を結ぶ辺が一方のグラフにのみ存在することを指します。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ M $

## 输出格式

答えを出力せよ。

## 说明/提示

### 制約

- $ 3\ \leq\ N\ \leq\ 500 $
- $ 10^8\ \leq\ M\ \leq\ 10^9 $
- $ N,\ M $ は整数
 
### Sample Explanation 1

以下の $ 8 $ 通りが条件を満たします。 !\[example\_00\](https://img.atcoder.jp/abc281/5c77dfe15dfa3c03666e654bf8cfdc01.png)

### Sample Explanation 3

$ M $ で割った余りを求めることに注意してください。

## 样例 #1

### 输入

```
4 1000000000
```

### 输出

```
8
```

## 样例 #2

### 输入

```
3 100000000
```

### 输出

```
1
```

## 样例 #3

### 输入

```
500 987654321
```

### 输出

```
610860515
```



---

---
title: "[AGC036C] GP 2"
layout: "post"
diff: 提高+/省选-
pid: AT_agc036_c
tag: ['排列组合']
---

# [AGC036C] GP 2

## 题目描述

[problemUrl]: https://atcoder.jp/contests/agc036/tasks/agc036_c

長さ $ N $ の数列 $ x=(x_0,x_1,\cdots,x_{N-1}) $ があります。 最初、すべての $ i $ ($ 0\ \leq\ i\ \leq\ N-1 $) について $ x_i=0 $ です。

すぬけさんは、次の操作を**ちょうど** $ M $ 回行います。

- 相異なる添字 $ i,j $ ($ 0\ \leq\ i,j\ \leq\ N-1,\ i\ \neq\ j $) を選ぶ。 そして、$ x_i $ を $ x_i+2 $ で置き換える。また、$ x_j $ を $ x_j+1 $ で置き換える。

最終的な数列 $ x $ の状態としてありうるものが何通りあるかを求めてください。 ただし、答えは非常に大きくなることがあるので、$ 998244353 $ で割ったあまりを求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ M $

## 输出格式

最終的な数列 $ x $ の状態としてありうるものが何通りあるかを $ 998244353 $ で割ったあまりを出力せよ。

## 说明/提示

### 制約

- $ 2\ \leq\ N\ \leq\ 10^6 $
- $ 1\ \leq\ M\ \leq\ 5\ \times\ 10^5 $
- 入力される値はすべて整数である。

### Sample Explanation 1

$ 2 $ 回の操作後の $ x $ の状態としてありうるものは以下の $ 3 $ 通りです。 - $ x=(2,4) $ - $ x=(3,3) $ - $ x=(4,2) $ たとえば、$ x=(3,3) $ としたい場合、次のように操作すればよいです。 - $ 1 $ 回目の操作：$ i=0,j=1 $ とする。$ x $ は $ (0,0) $ から $ (2,1) $ へ変化する。 - $ 2 $ 回目の操作：$ i=1,j=0 $ とする。$ x $ は $ (2,1) $ から $ (3,3) $ へ変化する。

## 样例 #1

### 输入

```
2 2
```

### 输出

```
3
```

## 样例 #2

### 输入

```
3 2
```

### 输出

```
19
```

## 样例 #3

### 输入

```
10 10
```

### 输出

```
211428932
```

## 样例 #4

### 输入

```
100000 50000
```

### 输出

```
3463133
```



---

---
title: "[AGC037B] RGB Balls"
layout: "post"
diff: 提高+/省选-
pid: AT_agc037_b
tag: ['贪心', '排列组合']
---

# [AGC037B] RGB Balls

## 题目描述

[problemUrl]: https://atcoder.jp/contests/agc037/tasks/agc037_b

色のついたボールが $ 3N $ 個あり、それぞれには $ 1 $ から $ 3N $ の番号がついています。 各ボールの色は長さ $ 3N $ の文字列 $ S $ によって表されており、ボール $ i $ の色は $ S_i $ が `R` のとき赤色、`G` のとき緑色、`B` のとき青色です。 赤色のボール、緑色のボール、青色のボールはそれぞれ $ N $ 個ずつあります。

高橋君はこの $ 3N $ 個のボールを、各人が赤、青、緑のボールを $ 1 $ つずつ割り当てられるよう、$ N $ 人の人に分配することにしました。 ただし、ボールをもらう人たちはできるだけ近い番号のボールが欲しいので、高橋君はさらに以下の条件をみたすように分配することにしました。

- $ j $ 番目の人が受け取ったボールの番号を小さい順に $ a_j\ <\ b_j\ <\ c_j $ とする。
- このとき $ \sum_j\ (c_j-a_j) $ ができるだけ小さくなるように分配する。

高橋君がボールを分配する方法は何通りあるか求めてください。 答えは非常に大きくなることがあるので、$ 998244353 $ で割ったあまりを求めてください。 ただし、$ 2 $ つのボールの分配方法が異なるとは、ある人が存在して、その人が受け取ったボールの集合が異なることを指します。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ S $

## 输出格式

高橋君のボールの分配方法が何通りあるかを $ 998244353 $ で割ったあまりを出力せよ。

## 说明/提示

### 制約

- $ 1\ ≦\ N\ ≦\ 10^5 $
- $ |S|=3N $
- $ S $ は `R`, `G`, `B` のみからなり、それぞれ $ N $ 回ずつ $ S $ に登場する

### Sample Explanation 1

例えば以下のようにボールを分配したとき、$ \sum_j\ (c_j-a_j) $ の値が $ 18 $ となり最小となります。 - $ 1 $ 番目の人にボール $ 1,5,9 $ を渡す。 - $ 2 $ 番目の人にボール $ 2,4,8 $ を渡す。 - $ 3 $ 番目の人にボール $ 3,6,7 $ を渡す。

## 样例 #1

### 输入

```
3

RRRGGGBBB
```

### 输出

```
216
```

## 样例 #2

### 输入

```
5

BBRGRRGRGGRBBGB
```

### 输出

```
960
```



---

---
title: "[AGC043B] 123 Triangle"
layout: "post"
diff: 提高+/省选-
pid: AT_agc043_b
tag: ['数论', '排列组合', 'Lucas 定理', '差分']
---

# [AGC043B] 123 Triangle

## 题目描述

[problemUrl]: https://atcoder.jp/contests/agc043/tasks/agc043_b

各要素が $ 1 $ か $ 2 $ か $ 3 $ である長さ $ N $ の数字列 $ a_1a_2\ldots\ a_N $ が与えられます。 $ x_{i,j} $ を次のように定義します。

- $ x_{1,j}\ :=\ a_j $ $ \quad $ ($ 1\ \leq\ j\ \leq\ N $)
- $ x_{i,j}\ :=\ |\ x_{i-1,j}\ -\ x_{i-1,j+1}\ | $ $ \quad $ ($ 2\ \leq\ i\ \leq\ N $ かつ $ 1\ \leq\ j\ \leq\ N+1-i $)

$ x_{N,1} $ を求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ a_1 $$ a_2 $$ \ldots $$ a_N $

## 输出格式

$ x_{N,1} $ を出力せよ。

## 说明/提示

### 制約

- $ 2\ ≦\ N\ ≦\ 10^6 $
- $ a_i\ =\ 1,2,3 $ $ (1\ \leq\ i\ \leq\ N) $

### Sample Explanation 1

$ x_{1,1},x_{1,2},x_{1,3},x_{1,4} $ はそれぞれ、$ 1,2,3,1 $ です。 $ x_{2,1},x_{2,2},x_{2,3} $ はそれぞれ、$ |1-2|\ =\ 1,|2-3|\ =\ 1,|3-1|\ =\ 2 $ です。 $ x_{3,1},x_{3,2} $ はそれぞれ、$ |1-1|\ =\ 0,|1-2|\ =\ 1 $ です。 最後に、 $ x_{4,1}\ =\ |0-1|\ =\ 1 $ なので、答えは $ 1 $ です。

## 样例 #1

### 输入

```
4

1231
```

### 输出

```
1
```

## 样例 #2

### 输入

```
10

2311312312
```

### 输出

```
0
```



---

---
title: "[AGC054C] Roughly Sorted"
layout: "post"
diff: 提高+/省选-
pid: AT_agc054_c
tag: ['贪心', '排列组合']
---

# [AGC054C] Roughly Sorted

## 题目描述

[problemUrl]: https://atcoder.jp/contests/agc054/tasks/agc054_c

すぬけくんは，$ (1,\ 2,\ ...\ N) $ の順列 $ P=(P_1,P_2,\cdots,P_N) $ と整数 $ K $ をもらいました． そこですぬけくんは，$ P $ の隣接する二項をswapすることを繰り返して，以下の条件が満たされるようにしました．

- それぞれの $ 1\ \leq\ i\ \leq\ N $ について， $ 1\ \leq\ j\ <\ i $, $ P_j\ >\ P_i $ を満たす $ j $ が高々 $ K $ 個である．

ここで，すぬけくんは**最小**の操作回数でこの条件を達成しました．

すべての操作が終わったあと，すぬけくんは元の順列を忘れてしまいました． 操作後の順列 $ P' $ が与えられるので，元の順列 $ P $ としてあり得るものが何通りあるかを $ 998244353 $ で割った余りを求めてください．

## 输入格式

入力は以下の形式で標準入力から与えられる．

> $ N $ $ K $ $ P'_1 $ $ P'_2 $ $ \cdots $ $ P'_N $

## 输出格式

答えを出力せよ．

## 说明/提示

### 制約

- $ 2\ \leq\ N\ \leq\ 5000 $
- $ 1\ \leq\ K\ \leq\ N-1 $
- $ 1\ \leq\ P'_i\ \leq\ N $
- $ P'_i\ \neq\ P'_j $ ($ i\ \neq\ j $)
- それぞれの $ 1\ \leq\ i\ \leq\ N $ について， $ 1\ \leq\ j\ <\ i $, $ P'_j\ >\ P'_i $ を満たす $ j $ が高々 $ K $ 個である
- 入力される値はすべて整数である

### Sample Explanation 1

$ P $ として考えられるのは以下の $ 2 $ 通りです． - $ P=(3,1,2) $: 最小の操作回数は $ 0 $ 回です．操作後の順列は $ P' $ に一致します． - $ P=(3,2,1) $: 最小の操作回数は $ 1 $ 回です．$ P_2 $ と $ P_3 $ をswapすることで，$ P=(3,1,2) $ となり，これは条件を満たします．操作後の順列は $ P' $ に一致します．

## 样例 #1

### 输入

```
3 1

3 1 2
```

### 输出

```
2
```

## 样例 #2

### 输入

```
4 3

4 3 2 1
```

### 输出

```
1
```

## 样例 #3

### 输入

```
5 2

4 2 1 5 3
```

### 输出

```
3
```



---

---
title: "[ARC176C] Max Permutation"
layout: "post"
diff: 提高+/省选-
pid: AT_arc176_c
tag: ['图论', '排列组合']
---

# [ARC176C] Max Permutation

## 题目描述

[problemUrl]: https://atcoder.jp/contests/arc176/tasks/arc176_c

$ (1,2,\dots,N) $ の順列 $ P=(P_1,P_2,\dots,P_N) $ のうち、以下の条件を全て満たすものの個数を $ 998244353 $ で割ったあまりを出力してください。

- $ \max(P_{A_i},P_{B_i})\ =\ C_i\ (1\ \le\ i\ \le\ M) $

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ M $ $ A_1 $ $ B_1 $ $ C_1 $ $ A_2 $ $ B_2 $ $ C_2 $ $ \vdots $ $ A_M $ $ B_M $ $ C_M $

## 输出格式

答えを出力せよ。

## 说明/提示

### 制約

- $ 2\ \le\ N\ \le\ 2\ \times\ 10^5 $
- $ 1\ \le\ M\ \le\ 2\ \times\ 10^5 $
- $ 1\ \le\ A_i\ <\ B_i\ \le\ N $
- $ 1\ \le\ C_i\ \le\ N $
- $ i\ \neq\ j $ ならば $ (A_i,B_i)\ \neq\ (A_j,B_j) $
 
### Sample Explanation 1

条件を満たす $ P $ は $ (4,1,2,3),(4,2,1,3) $ の $ 2 $ 個です。

## 样例 #1

### 输入

```
4 2

1 2 4

2 3 2
```

### 输出

```
2
```

## 样例 #2

### 输入

```
6 3

1 4 3

2 5 6

3 4 2
```

### 输出

```
8
```

## 样例 #3

### 输入

```
20 17

9 16 13

5 14 20

15 20 14

5 13 17

18 20 14

14 20 20

6 13 11

12 16 19

2 15 10

6 17 11

7 18 7

8 18 12

8 16 13

6 16 13

2 18 10

9 10 15

7 14 20
```

### 输出

```
1209600
```



---


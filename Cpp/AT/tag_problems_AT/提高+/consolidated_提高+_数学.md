---
title: "[ABC217F] Make Pair"
layout: "post"
diff: 提高+/省选-
pid: AT_abc217_f
tag: ['动态规划 DP', '区间 DP', '组合数学']
---

# [ABC217F] Make Pair

## 题目描述

一共 $2N$ 个学生站成一排，其中有 $M$ 对朋友关系。老师每次从队列中挑出两个相邻的学生作为同桌。为了关系和睦，每次选出的两个学生必须是朋友关系。选出的两个学生离开队列，空出来的位置左右合拢。

请问老师有多少种方式选完所有学生？对于两种选人的方案，即使同桌关系相同，只要离开队列的顺序不同，也算是不同的方案。

## 输入格式

先输入一行两个整数 $N$、$M$，然后输入 $M$ 行数据，每行两个数 $A_i$ 和 $B_i$，表示两个同学的朋友关系。

## 输出格式

一个数，为所得方案数对 $998244353$ 取模后得到的值。

## 样例 #1

### 输入

```
2 3

1 2

1 4

2 3
```

### 输出

```
1
```

## 样例 #2

### 输入

```
2 2

1 2

3 4
```

### 输出

```
2
```

## 样例 #3

### 输入

```
2 2

1 3

2 4
```

### 输出

```
0
```



---

---
title: "[ABC227G] Divisors of Binomial Coefficient"
layout: "post"
diff: 提高+/省选-
pid: AT_abc227_g
tag: ['数学']
---

# [ABC227G] Divisors of Binomial Coefficient

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc227/tasks/abc227_g

二項係数 $ \displaystyle\ \binom{N}{K} $ の正の約数の個数を $ 998244353 $ で割った余りを求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ K $

## 输出格式

答えを出力せよ。

## 说明/提示

### 制約

- $ 1\ \leq\ N\ \leq\ 10^{12} $
- $ 0\ \leq\ K\ \leq\ \min(10^6,N) $
- 入力に含まれる値は全て整数である

### Sample Explanation 1

$ \displaystyle\ \binom{5}{2}=10 $ です。$ 10 $ の正の約数は $ 1,2,5,10 $ の $ 4 $ 個です。

### Sample Explanation 2

$ \displaystyle\ \binom{103}{3}=176851 $ です。$ 176851 $ の正の約数は $ 8 $ 個あります。

## 样例 #1

### 输入

```
5 2
```

### 输出

```
4
```

## 样例 #2

### 输入

```
103 3
```

### 输出

```
8
```

## 样例 #3

### 输入

```
1000000000000 1000000
```

### 输出

```
110520107
```



---

---
title: "[ABC266G] Yet Another RGB Sequence"
layout: "post"
diff: 提高+/省选-
pid: AT_abc266_g
tag: ['组合数学', '容斥原理']
---

# [ABC266G] Yet Another RGB Sequence

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc266/tasks/abc266_g

整数 $ R,G,B,K $ が与えられます。`R`, `G`, `B` からなる文字列 $ S $ であって、以下の条件をすべて満たすものの個数を $ 998244353 $ で割った余りを求めてください。

- $ S $ に含まれる `R`, `G`, `B` の個数はそれぞれ $ R,G,B $ 個である。
- $ S $ に（連続する）部分文字列として含まれる `RG` の個数は $ K $ 個である。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ R $ $ G $ $ B $ $ K $

## 输出格式

答えを出力せよ。

## 说明/提示

### 制約

- $ 1\ \leq\ R,G,B\leq\ 10^6 $
- $ 0\ \leq\ K\ \leq\ \mathrm{min}(R,G) $
- 入力は全て整数

### Sample Explanation 1

条件を満たす文字列は以下の $ 6 $ 個です。 - `RRGB` - `RGRB` - `RGBR` - `RBRG` - `BRRG` - `BRGR`

### Sample Explanation 2

個数を $ 998244353 $ で割った余りを求めてください。

## 样例 #1

### 输入

```
2 1 1 1
```

### 输出

```
6
```

## 样例 #2

### 输入

```
1000000 1000000 1000000 1000000
```

### 输出

```
80957240
```



---

---
title: "[ABC268G] Random Student ID"
layout: "post"
diff: 提高+/省选-
pid: AT_abc268_g
tag: ['组合数学', '概率论', '字典树 Trie']
---

# [ABC268G] Random Student ID

## 题目描述

**题目大意**

有 $n$ 个学生，第 $i$ 个学生的名字是一个字符串 $S_i$，编号是 $i$。

接下来校长要按照一种绝妙的字典序来对这 $n$ 个学生的名字排序。他随机选取一个 $\tt{a}\sim\tt{z}$ 的排列，定为 $P$。$P$ 中越早出现的字母，他的字典序就越小。

对于每一个学生，求出他的期望排名，对 $998244353$ 取模。

## 输入格式

第一行一个整数 $n$。

接下来 $n$ 行每行一个字符串 $S_i$。

## 输出格式

输出 $n$ 行，第 $i$ 行表示编号为 $i$ 的学生的期望排名。

## 说明/提示

对于所有数据，我们保证 $S_i$ 只由小写字母组成，并且这些学生的名字互不相同。$n\geqslant 2$，字符串总长度不超过 $5\times 10^5$。

## 样例 #1

### 输入

```
3

a

aa

ab
```

### 输出

```
1

499122179

499122179
```

## 样例 #2

### 输入

```
3

a

aa

aaa
```

### 输出

```
1

2

3
```



---

---
title: "[ABC281G] Farthest City"
layout: "post"
diff: 提高+/省选-
pid: AT_abc281_g
tag: ['动态规划 DP', '组合数学', '排列组合']
---

# [ABC281G] Farthest City

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc281/tasks/abc281_g

正整数 $ N,\ M $ が与えられます。  
 頂点に $ 1,\ \dots,\ N $ の番号が付けられた $ N $ 頂点の単純連結無向グラフであって、以下の条件を満たすものの総数を $ M $ で割った余りを求めてください。

- 全ての $ u\ =\ 2,\ \dots,\ N-1 $ について、頂点 $ 1 $ から頂点 $ u $ までの最短距離は、頂点 $ 1 $ から頂点 $ N $ までの最短距離より真に小さい。
 
ただし、頂点 $ u $ から頂点 $ v $ までの最短距離とは、頂点 $ u,\ v $ を結ぶ単純パスに含まれる辺の本数の最小値を指します。  
 また、$ 2 $ つのグラフが異なるとは、ある $ 2 $ 頂点 $ u,\ v $ が存在して、これらの頂点を結ぶ辺が一方のグラフにのみ存在することを指します。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ M $

## 输出格式

答えを出力せよ。

## 说明/提示

### 制約

- $ 3\ \leq\ N\ \leq\ 500 $
- $ 10^8\ \leq\ M\ \leq\ 10^9 $
- $ N,\ M $ は整数
 
### Sample Explanation 1

以下の $ 8 $ 通りが条件を満たします。 !\[example\_00\](https://img.atcoder.jp/abc281/5c77dfe15dfa3c03666e654bf8cfdc01.png)

### Sample Explanation 3

$ M $ で割った余りを求めることに注意してください。

## 样例 #1

### 输入

```
4 1000000000
```

### 输出

```
8
```

## 样例 #2

### 输入

```
3 100000000
```

### 输出

```
1
```

## 样例 #3

### 输入

```
500 987654321
```

### 输出

```
610860515
```



---

---
title: "[ABC284G] Only Once"
layout: "post"
diff: 提高+/省选-
pid: AT_abc284_g
tag: ['组合数学', '基环树']
---

# [ABC284G] Only Once

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc284/tasks/abc284_g

$ 1 $ 以上 $ N $ 以下の整数からなる長さ $ N $ の数列 $ A\ =\ (A_1,A_2,\dots,A_N) $ および整数 $ i\ (1\leq\ i\ \leq\ N) $ に対して、 長さ $ 10^{100} $ の数列 $ B_i=(B_{i,1},B_{i,2},\dots,B_{i,10^{100}}) $ を以下のように定義します。

- $ B_{i,1}=i $
- $ B_{i,j+1}=A_{B_{i,j}}\ (1\leq\ j\ <\ 10^{100}) $
 
また、$ S_i $ を「数列 $ B_i $ のなかでちょうど $ 1 $ 度だけ出てくる数の種類数」と定義します。 より厳密には、$ S_i $ は「$ B_{i,j}=k $ を満たす $ j\ (1\leq\ j\leq\ 10^{100}) $ がちょうど $ 1 $ つであるような $ k $ の数」です。

整数 $ N $ が与えられます。数列 $ A $ として考えられるものは $ N^N $ 通りありますが、それら全てに対して $ \displaystyle\ \sum_{i=1}^{N}\ S_i $ を求め、 その総和を $ M $ で割った余りを答えてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ M $

## 输出格式

答えを整数として出力せよ。

## 说明/提示

### 制約

- $ 1\leq\ N\ \leq\ 2\times\ 10^5 $
- $ 10^8\leq\ M\ \leq\ 10^9 $
- $ N,M $ は整数
 
### Sample Explanation 1

例として、$ A=(2,3,3,4) $ の場合を考えます。 - $ i=1 $ のとき : $ B_1=(1,2,3,3,3,\dots) $ となるから、$ 1 $ 度だけ出てくる数は $ 1,2 $ の $ 2 $ つで、$ S_1=2 $ - $ i=2 $ のとき : $ B_2=(2,3,3,3,\dots) $ となるから、$ 1 $ 度だけ出てくる数は $ 2 $ のみで、$ S_2=1 $ - $ i=3 $ のとき : $ B_3=(3,3,3,\dots) $ となるから、$ 1 $ 度だけ出てくる数は存在せず、$ S_3=0 $ - $ i=4 $ のとき : $ B_4=(4,4,4,\dots) $ となるから、$ 1 $ 度だけ出てくる数は存在せず、$ S_4=0 $ よって、$ \displaystyle\ \sum_{i=1}^{N}\ S_i=2+1+0+0=3 $ です。 他の $ 255 $ 通りの $ A $ に対しても同様に $ \displaystyle\ \sum_{i=1}^{N}\ S_i $ を計算したうえで、 $ 256 $ 通り全ての総和をとると $ 624 $ になります。

### Sample Explanation 3

総和を $ M $ で割った余りを出力してください。

## 样例 #1

### 输入

```
4 100000000
```

### 输出

```
624
```

## 样例 #2

### 输入

```
7 1000000000
```

### 输出

```
5817084
```

## 样例 #3

### 输入

```
2023 998244353
```

### 输出

```
737481389
```

## 样例 #4

### 输入

```
100000 353442899
```

### 输出

```
271798911
```



---

---
title: "[ABC312Ex] snukesnuke"
layout: "post"
diff: 提高+/省选-
pid: AT_abc312_h
tag: ['哈希 hashing', 'KMP 算法', '均摊分析', '数学']
---

# [ABC312Ex] snukesnuke

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc312/tasks/abc312_h

高橋君は人 $ 1,\ldots,N $ の $ N $ 人のあだ名を決めることになりました。

人 $ i $ はあだ名を $ S_i $ にしてほしいと思っています。複数人に同じあだ名をつけるのを避けるため、高橋君は次の手順で $ N $ 人のあだ名を決めることにしました。

- $ i=1,\ldots,N $ の順に、以下の操作により人 $ i $ のあだ名を決める
  - 変数 $ k_i $ を $ 1 $ とする。
  - 「$ S_i $ を $ k_i $ 回繰り返した文字列」がすでに誰かのあだ名である間、$ k_i $ を $ 1 $ 増やすことを繰り返す。
  - 「$ S_i $ を $ k_i $ 回繰り返した文字列」を人 $ i $ のあだ名とする。
 
$ N $ 人のあだ名を決めた後の $ k_1,\ldots,k_N $ を求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ S_1 $ $ \vdots $ $ S_N $

## 输出格式

問題文中の操作により $ N $ 人のあだ名を決めた後の $ k_1,\ldots,k_N $ をこの順に空白区切りで出力せよ。

## 说明/提示

### 制約

- $ N\ \geq\ 1 $
- $ S_i $ は英小文字のみからなる、長さ $ 1 $ 以上の文字列
- $ S_i $ の長さの総和は $ 2\times\ 10^5 $ 以下
 
### Sample Explanation 1

\- まず人 $ 1 $ のあだ名を決めます。 - $ k_1=1 $ とします。 - $ S_1 $ を $ k_1 $ 回繰り返した文字列 `snuke` は誰のあだ名でもないので、人 $ 1 $ のあだ名は `snuke` になります。 - 次に人 $ 2 $ のあだ名を決めます。 - $ k_2=1 $ とします。 - $ S_2 $ を $ k_2 $ 回繰り返した文字列 `snuke` はすでに人 $ 1 $ のあだ名なので、$ k_2 $ を $ 1 $ 増やして $ 2 $ とします。 - $ S_2 $ を $ k_2 $ 回繰り返した文字列 `snukesnuke` は誰のあだ名でもないので、人 $ 2 $ のあだ名は `snukesnuke` になります。 - 最後に人 $ 3 $ のあだ名を決めます。 - $ k_3=1 $ とします。 - $ S_3 $ を $ k_3 $ 回繰り返した文字列 `rng` は誰のあだ名でもないので、人 $ 3 $ のあだ名は `rng` になります。 以上により、$ k_1,k_2,k_3 $ はそれぞれ $ 1,2,1 $ となります。

### Sample Explanation 2

\- 人 $ 1 $ のあだ名は `aa` になります。 - 人 $ 2 $ のあだ名は `a` になります。 - 人 $ 3 $ のあだ名は、`a`, `aa` がすでに他の人のあだ名なので、`aaa` になります。 - 人 $ 4 $ のあだ名は、`aaa` がすでに他の人のあだ名なので、`aaaaaa` になります。

## 样例 #1

### 输入

```
3

snuke

snuke

rng
```

### 输出

```
1 2 1
```

## 样例 #2

### 输入

```
4

aa

a

a

aaa
```

### 输出

```
1 1 3 2
```

## 样例 #3

### 输入

```
5

x

x

x

x

x
```

### 输出

```
1 2 3 4 5
```



---

---
title: "[ABC353F] Tile Distance"
layout: "post"
diff: 提高+/省选-
pid: AT_abc353_f
tag: ['数学', '分类讨论']
---

# [ABC353F] Tile Distance

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc353/tasks/abc353_f

座標平面上にタイルが敷き詰められています。 $ 1\times1 $ の大きさの小タイルと $ K\times\ K $ の大きさの大タイルの $ 2 $ 種類があり、次の規則に従って敷き詰められています。

- 整数の組 $ (i,j) $ に対し、正方形 $ \lbrace(x,y)\mid\ i\leq\ x\leq\ i+1\wedge\ j\leq\ y\leq\ j+1\rbrace $ は $ 1 $ つの小タイルもしくは $ 1 $ つの大タイルに含まれる。
  - $ \left\lfloor\dfrac\ iK\right\rfloor+\left\lfloor\dfrac\ jK\right\rfloor $ が偶数のとき、小タイルに含まれる。
  - そうでないとき、大タイルに含まれる。
 
ただし、タイルは境界を含むものとし、共通部分が正の面積をもつような $ 2 $ つの異なるタイルは存在しないとします。

例えば、$ K=3 $ のとき、タイルは以下のようになります。

![](https://cdn.luogu.com.cn/upload/vjudge_pic/AT_abc353_f/4828cef3de44d96612c498eeceffc46bc8c608c7.png)

 高橋君は、はじめ座標平面上の点 $ (S\ _\ x+0.5,S\ _\ y+0.5) $ にいます。

高橋君は、次の移動を好きなだけ繰り返します。

- 上下左右の方向と正の整数 $ n $ を選ぶ。その方向に $ n $ だけ進む。
 
高橋君が異なるタイルを通るたび、高橋君は通行料を $ 1 $ だけ支払います。

高橋君が点 $ (T\ _\ x+0.5,T\ _\ y+0.5) $ にたどり着くために支払わなければならない通行料の最小値を求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ K $ $ S\ _\ x $ $ S\ _\ y $ $ T\ _\ x $ $ T\ _\ y $

## 输出格式

高橋君が支払わなければならない通行料の最小値を出力せよ。

## 说明/提示

### 制約

- $ 1\leq\ K\leq10\ ^\ {16} $
- $ 0\leq\ S\ _\ x\leq2\times10\ ^\ {16} $
- $ 0\leq\ S\ _\ y\leq2\times10\ ^\ {16} $
- $ 0\leq\ T\ _\ x\leq2\times10\ ^\ {16} $
- $ 0\leq\ T\ _\ y\leq2\times10\ ^\ {16} $
- 入力はすべて整数
 
### Sample Explanation 1

例えば、以下のように移動することで支払う通行料を $ 5 $ にすることができます。 !\[\](https://img.atcoder.jp/abc353/35d47ae5cfbcc870ac4d285a8e024278.png) - 上に $ 3 $ 進む。通行料を $ 1 $ 支払う。 - 左に $ 2 $ 進む。通行料を $ 1 $ 支払う。 - 上に $ 1 $ 進む。通行料を $ 1 $ 支払う。 - 左に $ 4 $ 進む。通行料を $ 2 $ 支払う。 支払う通行料を $ 4 $ 以下にすることはできないので、`5` を出力してください。

### Sample Explanation 2

!\[\](https://img.atcoder.jp/abc353/a454c75aab412b8ada226a5e7741e5e1.png) 高橋君が最短距離で移動するとき、どのように移動しても通行料を $ 42 $ だけ支払います。 支払う通行料を $ 41 $ 以下にすることはできないので、`42` を出力してください。

### Sample Explanation 3

通行料を支払わなくてよい場合もあります。

## 样例 #1

### 输入

```
3

7 2

1 6
```

### 输出

```
5
```

## 样例 #2

### 输入

```
1

41 42

13 56
```

### 输出

```
42
```

## 样例 #3

### 输入

```
100

100 99

199 1
```

### 输出

```
0
```

## 样例 #4

### 输入

```
96929423

5105216413055191 10822465733465225

1543712011036057 14412421458305526
```

### 输出

```
79154049
```



---

---
title: "[ABC373F] Knapsack with Diminishing Values"
layout: "post"
diff: 提高+/省选-
pid: AT_abc373_f
tag: ['动态规划 DP', '贪心', '数学']
---

# [ABC373F] Knapsack with Diminishing Values

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc373/tasks/abc373_f

$ N $ 種類の品物があり、 $ i $ 種類目の品物の重みは $ w_i $、価値は $ v_i $ です。どの種類の品物も $ 10^{10} $ 個ずつあります。

高橋君はこれから、品物をいくつか選んで、容量 $ W $ のバッグに入れます。高橋君は、選ぶ品物の価値を大きくしつつ、同じ種類の品物ばかりにならないようにしたいです。そこで高橋君は、$ i $ 種類目の品物を $ k_i $ 個選んだときの **うれしさ** を $ k_i\ v_i\ -\ k_i^2 $ と定義したとき、選んだ品物の重さの総和を $ W $ 以下にしつつ、各種類のうれしさの総和が最大になるように品物を選びます。高橋君が達成できる、うれしさの総和の最大値を求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ W $ $ w_1 $ $ v_1 $ $ w_2 $ $ v_2 $ $ \vdots $ $ w_N $ $ v_N $

## 输出格式

答えを出力せよ。

## 说明/提示

### 制約

- $ 1\ \leq\ N\ \leq\ 3000 $
- $ 1\ \leq\ W\ \leq\ 3000 $
- $ 1\ \leq\ w_i\ \leq\ W $
- $ 1\ \leq\ v_i\ \leq\ 10^9 $
- 入力はすべて整数
 
### Sample Explanation 1

$ 1 $ 種類目の品物を $ 2 $ 個、$ 2 $ 種類目の品物を $ 1 $ 個選ぶと、うれしさの総和を $ 5 $ にすることができ、これが最適です。 $ 1 $ 種類目の品物についてのうれしさは $ 2\ \times\ 4\ -\ 2^2\ =\ 4 $、$ 2 $ 種類目の品物についてのうれしさは $ 1\ \times\ 2\ -\ 1^2\ =\ 1 $ です。 また、重さの総和は $ 9 $ であり、容量 $ 10 $ のバッグに入ります。

## 样例 #1

### 输入

```
2 10

3 4

3 2
```

### 输出

```
5
```

## 样例 #2

### 输入

```
3 6

1 4

2 3

2 7
```

### 输出

```
14
```

## 样例 #3

### 输入

```
1 10

1 7
```

### 输出

```
12
```



---

---
title: "[AGC036B] Do Not Duplicate"
layout: "post"
diff: 提高+/省选-
pid: AT_agc036_b
tag: ['数学', '数论', '图论建模']
---

# [AGC036B] Do Not Duplicate

## 题目描述

[problemUrl]: https://atcoder.jp/contests/agc036/tasks/agc036_b

長さ $ N\ \times\ K $ の数列 $ X=(X_0,X_1,\cdots,X_{N\ \times\ K-1}) $ があります。 数列 $ X $ の要素は長さ $ N $ の数列 $ A=(A_0,A_1,\cdots,A_{N-1}) $ によって表され、全ての $ i,j $ ($ 0\ \leq\ i\ \leq\ K-1,\ 0\ \leq\ j\ \leq\ N-1 $) について、 $ X_{i\ \times\ N\ +\ j}=A_j $ です。

すぬけさんは、整数列 $ s $ を持っています。 最初、$ s $ は空です。 すぬけさんはこれから、すべての $ i=0,1,2,\cdots,N\ \times\ K-1 $ について、この順に、以下の操作を行います。

- $ s $ が $ X_i $ を含んでいない場合: $ s $ の末尾に $ X_i $ を追加する。
- $ s $ が $ X_i $ を含んでいる場合: $ s $ が $ X_i $ を含まなくなるまで、$ s $ の末尾の要素を削除し続ける。 このとき、$ X_i $ を末尾に**加えない**ことに注意せよ。

全ての操作が終わったあとの数列 $ s $ の状態を求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ K $ $ A_0 $ $ A_1 $ $ \cdots $ $ A_{N-1} $

## 输出格式

全ての操作が終わったあとの数列 $ s $ の要素を、先頭から末尾の順に空白区切りで出力せよ。

## 说明/提示

### 制約

- $ 1\ \leq\ N\ \leq\ 2\ \times\ 10^5 $
- $ 1\ \leq\ K\ \leq\ 10^{12} $
- $ 1\ \leq\ A_i\ \leq\ 2\ \times\ 10^5 $
- 入力される値はすべて整数である。

### Sample Explanation 1

$ X=(1,2,3,1,2,3) $ です。 操作は、以下のように行われます。 - $ i=0 $: $ s $ が $ 1 $ を含まないので、$ s $ の末尾に $ 1 $ を追加する。$ s=(1) $ となる。 - $ i=1 $: $ s $ が $ 2 $ を含まないので、$ s $ の末尾に $ 2 $ を追加する。$ s=(1,2) $ となる。 - $ i=2 $: $ s $ が $ 3 $ を含まないので、$ s $ の末尾に $ 3 $ を追加する。$ s=(1,2,3) $ となる。 - $ i=3 $: $ s $ が $ 1 $ を含むので、$ s $ が $ 1 $ を含む限り、末尾の要素を削除し続ける。$ s $ は $ (1,2,3)→(1,2)→(1)→() $ と変化する。 - $ i=4 $: $ s $ が $ 2 $ を含まないので、$ s $ の末尾に $ 2 $ を追加する。$ s=(2) $ となる。 - $ i=5 $: $ s $ が $ 3 $ を含まないので、$ s $ の末尾に $ 3 $ を追加する。$ s=(2,3) $ となる。

### Sample Explanation 3

数列 $ s $ が空のこともあります。

## 样例 #1

### 输入

```
3 2

1 2 3
```

### 输出

```
2 3
```

## 样例 #2

### 输入

```
5 10

1 2 3 2 3
```

### 输出

```
3
```

## 样例 #3

### 输入

```
6 1000000000000

1 1 2 2 3 3
```

### 输出

```

```

## 样例 #4

### 输入

```
11 97

3 1 4 1 5 9 2 6 5 3 5
```

### 输出

```
9 2 6
```



---

---
title: "[AGC055B] ABC Supremacy"
layout: "post"
diff: 提高+/省选-
pid: AT_agc055_b
tag: ['数学', '构造']
---

# [AGC055B] ABC Supremacy

## 题目描述

[problemUrl]: https://atcoder.jp/contests/agc055/tasks/agc055_b

`A`, `B`, `C` からなる長さ $ N $ の文字列 $ S $ が与えられます。あなたは、次の操作を何回でも行うことができます。

- $ S_iS_{i+1}S_{i+2} $ が `ABC`, `BCA`, `CAB` のいずれかに等しいような $ 1\ \le\ i\ \le\ N-2 $ を任意に選ぶ。そして、その三文字を `ABC`, `BCA`, `CAB` のいずれかで置換する。

例えば、文字列 `AABC` に対して、以下の変換を行うことができます。

- `AABC` $ \to $ `ABCA` $ \to $ `BCAA`

上記の操作を有限回行うことで（$ 0 $ 回でもよい）、文字列 $ S $ から文字列 $ T $ を得ることが可能か判定してください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ S $ $ T $

## 输出格式

上記の操作で $ S $ を $ T $ に変換することが可能であれば `YES`、そうでなければ `NO` と出力せよ。大文字、小文字は不問である。

## 说明/提示

### 制約

- $ 3\le\ N\ \le\ 5\cdot\ 10^5 $
- $ S $ は、`A`, `B`, `C` からなる長さ $ N $ の文字列である。
- $ T $ は、`A`, `B`, `C` からなる長さ $ N $ の文字列である。

### Sample Explanation 1

これは問題文で説明した例です。

## 样例 #1

### 输入

```
4

AABC

BCAA
```

### 输出

```
YES
```

## 样例 #2

### 输入

```
4

ABCA

BCAB
```

### 输出

```
NO
```



---

---
title: "[AGC057B] 2A + x"
layout: "post"
diff: 提高+/省选-
pid: AT_agc057_b
tag: ['数学', '贪心']
---

# [AGC057B] 2A + x

## 题目描述

[problemUrl]: https://atcoder.jp/contests/agc057/tasks/agc057_b

正整数列 $ A\ =\ (A_1,\ A_2,\ \ldots,\ A_N) $ および正整数 $ X $ が与えられます。あなたはこの数列に対して、次の操作を何度でも行うことができます（$ 0 $ 回でもよい）：

- 添字 $ i $ （$ 1\leq\ i\leq\ N $）および、$ 0\leq\ x\leq\ X $ となる非負整数 $ x $ を選ぶ。$ A_i $ を $ 2A_i+x $ に変更する。

操作結果の $ \max\{A_1,A_2,\ldots,A_N\}-\min\{A_1,A_2,\ldots,A_N\} $ としてありうる最小値を求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられます。

> $ N $ $ X $ $ A_1 $ $ A_2 $ $ \ldots $ $ A_N $

## 输出格式

操作結果の $ \max\{A_1,A_2,\ldots,A_N\}-\min\{A_1,A_2,\ldots,A_N\} $ としてありうる最小値を出力してください。

## 说明/提示

### 制約

- $ 2\leq\ N\leq\ 10^5 $
- $ 1\leq\ X\leq\ 10^9 $
- $ 1\leq\ A_i\leq\ 10^9 $

### Sample Explanation 1

$ A_i $ を $ 2A_i+x $ に変更する操作を $ (i,\ x) $ と表すことにします。最適な操作列の一例は次の通りです。 - $ (1,0) $, $ (1,1) $, $ (2,2) $, $ (3,0) $ 操作結果は $ A\ =\ (21,\ 18,\ 24,\ 20) $ となり、$ \max\{A_1,A_2,A_3,A_4\}-\min\{A_1,A_2,A_3,A_4\}\ =\ 6 $ が達成できます。

### Sample Explanation 2

最適な操作列の一例は次の通りです。 - $ (1,5) $, $ (1,5) $, $ (2,5) $, $ (2,1) $, $ (3,2) $, $ (3,3) $, $ (4,0) $, $ (4,3) $ 操作結果は $ A\ =\ (111,111,111,111) $ となり、$ \max\{A_1,A_2,A_3,A_4\}-\min\{A_1,A_2,A_3,A_4\}\ =\ 0 $ が達成できます。

### Sample Explanation 3

一度も操作を行わないことにより、$ \max\{A_1,A_2,A_3,A_4\}-\min\{A_1,A_2,A_3,A_4\}\ =\ 3 $ が達成できます。

## 样例 #1

### 输入

```
4 2

5 8 12 20
```

### 输出

```
6
```

## 样例 #2

### 输入

```
4 5

24 25 26 27
```

### 输出

```
0
```

## 样例 #3

### 输入

```
4 1

24 25 26 27
```

### 输出

```
3
```

## 样例 #4

### 输入

```
10 5

39 23 3 7 16 19 40 16 33 6
```

### 输出

```
13
```



---

---
title: "[AGC061A] Long Shuffle"
layout: "post"
diff: 提高+/省选-
pid: AT_agc061_a
tag: ['组合数学']
---

# [AGC061A] Long Shuffle

## 题目描述

[problemUrl]: https://atcoder.jp/contests/agc061/tasks/agc061_a

配列 $ A_1,\ \ldots,\ A_N $ があり、はじめ全ての $ i $ について $ A_i\ =\ i $ です。手順 $ \mathrm{shuffle}(L,\ R) $ を以下として定義します。

- $ R\ =\ L\ +\ 1 $ なら、$ A_L $ と $ A_R $ の値を入れ替えて終了する。
- そうでないなら、$ \mathrm{shuffle}(L,\ R\ -\ 1) $ を実行してから $ \mathrm{shuffle}(L\ +\ 1,\ R) $ を実行する。

$ \mathrm{shuffle}(1,\ N) $ を行うとします。手順終了後の $ A_K $ の値を出力してください。

各入力ファイルについて、テストケースを $ T $ 個解いてください。

## 输入格式

入力は、標準入力から以下の形式で与えられる。

> $ T $ $ case_1 $ $ case_2 $ $ \vdots $ $ case_T $

各ケースは、以下の形式である。

> $ N $ $ K $

## 输出格式

$ T $ 行出力せよ。$ i $ 行目に、$ i $ 個目のテストケースの答えを出力すること。

## 说明/提示

### 制約

- $ 1\ \leq\ T\ \leq\ 1000 $
- $ 2\ \leq\ N\ \leq\ 10^{18} $
- $ 1\ \leq\ K\ \leq\ N $

### Sample Explanation 1

$ N=2 $ のときは、以下を行って $ A=(2,1) $ を得ます。 - $ \mathrm{shuffle}(1,\ 2) $ を実行し、$ A_1 $ と $ A_2 $ を入れ替える。 $ N=5 $ のときは、以下を行って $ A=(2,4,1,5,3) $ を得ます。 - $ \mathrm{shuffle}(1,\ 5) $ を実行する。 - $ \mathrm{shuffle}(1,\ 4) $ を実行する。 - $ \mathrm{shuffle}(1,\ 3) $ を実行する。 - $ \vdots $ - $ \mathrm{shuffle}(2,\ 4) $ を実行する。 - $ \vdots $ - $ \mathrm{shuffle}(2,\ 5) $ を実行する。 - $ \mathrm{shuffle}(2,\ 4) $ を実行する。 - $ \vdots $ - $ \mathrm{shuffle}(3,\ 5) $ を実行する。 - $ \vdots $

## 样例 #1

### 输入

```
7
2 1
2 2
5 1
5 2
5 3
5 4
5 5
```

### 输出

```
2
1
2
4
1
5
3
```



---

---
title: "[AGC062C] Mex of Subset Sum"
layout: "post"
diff: 提高+/省选-
pid: AT_agc062_c
tag: ['数学', '分类讨论']
---

# [AGC062C] Mex of Subset Sum

## 题目描述

[problemUrl]: https://atcoder.jp/contests/agc062/tasks/agc062_c

長さ $ N $ の整数列 $ A=(A_1,A_2,\dots,A_N) $ が与えられます。

以下の条件を満たす正整数 $ X $ を小さいほうから順に $ K $ 個求めてください。

- $ A $ の空でない（連続とは限らない）部分列であって、要素の和が $ X $ であるものが**存在しない**

## 输入格式

入力は以下の形式で標準入力から与えられます。

> $ N $ $ K $ $ A_1 $ $ A_2 $ $ \dots $ $ A_N $

## 输出格式

条件を満たす $ K $ 個の正整数を昇順に、空白区切りで出力してください。

## 说明/提示

### 制約

- $ 1\ \leq\ N\ \leq\ 60 $
- $ 1\ \leq\ K\ \leq\ 1000 $
- $ 1\ \leq\ A_i\ \leq\ 10^{15} $
- 入力される値はすべて整数
 
### Sample Explanation 1

$ A $ の部分列としては $ (1),(2),(1,2),(5),(1,5),(2,5),(1,2,5) $ が考えられ、要素の和はそれぞれ $ 1,2,3,5,6,7,8 $ です。よって $ X=1,2,3,5,6,7,8 $ に対しては、要素の和が $ X $ であるような $ A $ の部分列が存在します。 一方 $ X=4,9,10 $ に対しては、要素の和が $ X $ であるような $ A $ の部分列は存在しません。

## 样例 #1

### 输入

```
3 3

1 2 5
```

### 输出

```
4 9 10
```

## 样例 #2

### 输入

```
20 10

324 60 1 15 60 15 1 60 319 1 327 1 2 60 2 345 1 2 2 15
```

### 输出

```
14 29 44 59 74 89 104 119 134 149
```



---

---
title: "[AGC066B] Decreasing Digit Sums"
layout: "post"
diff: 提高+/省选-
pid: AT_agc066_b
tag: ['数学', '构造']
---

# [AGC066B] Decreasing Digit Sums

## 题目描述

### 题意翻译

定义 $f(x)$ 表示 $x$ 各数位之和，例如 $f(331)=3+3+1=7$，$f(2024)=2+0+2+4=8$，$f(1)=1$ 等。

给定 $n$，你需要找到一个数 $k$ 满足以下条件：

- $1\leq k\leq10^{10000}$；
- 对于任意整数 $1\leq i\leq n$，有 $f(2^{i-1}k)>f(2^ik)$。

## 输入格式

一行一个正整数 $n$。

## 输出格式

一行一个整数表示你给出的答案 $k$。

## 说明/提示

$1\leq n\leq50$。

## 样例 #1

### 输入

```
3
```

### 输出

```
89
```



---

---
title: "[ABC044D] 桁和"
layout: "post"
diff: 提高+/省选-
pid: AT_arc060_b
tag: ['数学', '枚举', '进制']
---

# [ABC044D] 桁和

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc044/tasks/arc060_b

$ 2 $ 以上の整数 $ b $ および $ 1 $ 以上の整数 $ n $ に対し、関数 $ f(b,n) $ を次のように定義します。

- $ n\ <\ b $ のとき $ f(b,n)\ =\ n $
- $ n\ \geq\ b $ のとき $ f(b,n)\ =\ f(b,\,{\rm\ floor}(n\ /\ b))\ +\ (n\ {\rm\ mod}\ b) $

ここで、$ {\rm\ floor}(n\ /\ b) $ は $ n\ /\ b $ を超えない最大の整数を、 $ n\ {\rm\ mod}\ b $ は $ n $ を $ b $ で割った余りを表します。

直感的に言えば、$ f(b,n) $ は、$ n $ を $ b $ 進表記したときの各桁の和となります。 例えば、

- $ f(10,\,87654)=8+7+6+5+4=30 $
- $ f(100,\,87654)=8+76+54=138 $

などとなります。

整数 $ n $ と $ s $ が与えられます。 $ f(b,n)=s $ を満たすような $ 2 $ 以上の整数 $ b $ が存在するか判定してください。 さらに、そのような $ b $ が存在するならば、その最小値を求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ n $ $ s $

## 输出格式

$ f(b,n)=s $ を満たす $ 2 $ 以上の整数 $ b $ が存在するならば、そのような $ b $ の最小値を出力せよ。 そのような $ b $ が存在しないならば、代わりに `-1` を出力せよ。

## 说明/提示

### 制約

- $ 1\ \leq\ n\ \leq\ 10^{11} $
- $ 1\ \leq\ s\ \leq\ 10^{11} $
- $ n,\,s $ はいずれも整数である

## 样例 #1

### 输入

```
87654

30
```

### 输出

```
10
```

## 样例 #2

### 输入

```
87654

138
```

### 输出

```
100
```

## 样例 #3

### 输入

```
87654

45678
```

### 输出

```
-1
```

## 样例 #4

### 输入

```
31415926535

1
```

### 输出

```
31415926535
```

## 样例 #5

### 输入

```
1

31415926535
```

### 输出

```
-1
```



---

---
title: "[ABC050D] Xor Sum"
layout: "post"
diff: 提高+/省选-
pid: AT_arc066_b
tag: ['数学', '递推', '进制']
---

# [ABC050D] Xor Sum

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc050/tasks/arc066_b

正の整数 $ N $ が与えられます。 $ 2 $ つの整数 $ u,v(0≦u,v≦N) $ であって、ある非負整数 $ a,b $ が存在して、$ a $ $ xor $ $ b=u $、$ a+b=v $ となるようなものが何通りあるかを求めてください。 ここで、$ xor $ はビットごとの排他的論理和を表します。 なお、答えは非常に大きくなることがあるので、$ 10^9+7 $ で割った余りを求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $

## 输出格式

ありうる $ 2 $ 数の組が何通りあるかを求め、$ 10^9+7 $ で割った余りを出力せよ。

## 说明/提示

### 制約

- $ 1≦N≦10^{18} $

### Sample Explanation 1

$ u,v $ としてありうるものは、以下の $ 5 $ 通りです。 - $ u=0,v=0 $（ $ a=0,b=0 $ とすると、$ 0 $ $ xor $ $ 0=0 $、$ 0+0=0 $ となります。） - $ u=0,v=2 $（ $ a=1,b=1 $ とすると、$ 1 $ $ xor $ $ 1=0 $、$ 1+1=2 $ となります。） - $ u=1,v=1 $（ $ a=1,b=0 $ とすると、$ 1 $ $ xor $ $ 0=1 $、$ 1+0=1 $ となります。） - $ u=2,v=2 $（ $ a=2,b=0 $ とすると、$ 2 $ $ xor $ $ 0=2 $、$ 2+0=2 $ となります。） - $ u=3,v=3 $（ $ a=3,b=0 $ とすると、$ 3 $ $ xor $ $ 0=3 $、$ 3+0=3 $ となります。）

## 样例 #1

### 输入

```
3
```

### 输出

```
5
```

## 样例 #2

### 输入

```
1422
```

### 输出

```
52277
```

## 样例 #3

### 输入

```
1000000000000000000
```

### 输出

```
787014179
```



---

---
title: "[ARC147D] Sets Scores"
layout: "post"
diff: 提高+/省选-
pid: AT_arc147_d
tag: ['数学', '组合数学']
---

# [ARC147D] Sets Scores

## 题目描述

[problemUrl]: https://atcoder.jp/contests/arc147/tasks/arc147_d

長さ $ N $ の整数の集合の列 $ S=(S_1,S_2,\dots,S_N) $ のうち、以下の条件を全て満たすものを「素晴らしい集合の列」と呼びます。

- $ S_i $ は $ 1 $ 以上 $ M $ 以下の整数のみからなる集合(空集合でもよい)である。$ (1\ \le\ i\ \le\ N) $
- $ S_i $ と $ S_{i+1} $ のうち、ちょうど片方にのみ含まれる要素の個数は $ 1 $ 個である。$ (1\ \le\ i\ \le\ N-1) $

ここで、素晴らしい集合の列 $ S $ のスコアを $ \displaystyle\ \prod_{i=1}^{M} $ $ (S_1,S_2,\dots,S_N $ のうち、$ i $ を含む集合の個数 $ ) $ と定義します。

全ての素晴らしい集合の列に対するスコアの総和を $ 998244353 $ で割ったあまりを求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ M $

## 输出格式

答えを出力せよ。

## 说明/提示

### 制約

- $ 1\ \le\ N,M\ \le\ 2\ \times\ 10^5 $
- 入力は全て整数である。

### Sample Explanation 1

素晴らしい集合の列のうち、スコアが正であるものは以下の $ 6 $ 個です。 - $ S_1=\{1,2\},S_2=\{1,2,3\} $ - $ S_1=\{1,3\},S_2=\{1,2,3\} $ - $ S_1=\{2,3\},S_2=\{1,2,3\} $ - $ S_1=\{1,2,3\},S_2=\{1,2\} $ - $ S_1=\{1,2,3\},S_2=\{1,3\} $ - $ S_1=\{1,2,3\},S_2=\{2,3\} $ 全てスコアは $ 4 $ であるため、解は $ 24 $ です。

## 样例 #1

### 输入

```
2 3
```

### 输出

```
24
```

## 样例 #2

### 输入

```
12 34
```

### 输出

```
786334067
```



---

---
title: "[ARC152C] Pivot"
layout: "post"
diff: 提高+/省选-
pid: AT_arc152_c
tag: ['数学']
---

# [ARC152C] Pivot

## 题目描述

[problemUrl]: https://atcoder.jp/contests/arc152/tasks/arc152_c

$ N $ 項からなる数列 $ a_1,a_2,\ldots,a_N $ があります。 あなたはこれから、この数列に以下の操作を好きな回数行うことができます。（$ 1 $ 回も行わなくてもよいです。）

- その時点の数列から項を $ 1 $ つ選び、その値を $ s $ とする。 次に、全ての $ 1\leq\ i\leq\ N $ に対して、$ a_i $ を $ 2s-a_i $ で置き換える。 ただし、この操作によって、数列に負の値を持つ項が生じてはならない。
 
あなたは、数列の項の最大値をできるだけ小さくしたいと考えています。 適切に操作を行った場合の、数列の項の最大値はいくつになるでしょうか。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ a_1 $ $ a_2 $ $ \ldots $ $ a_N $

## 输出格式

答えを整数で出力せよ。

## 说明/提示

### 制約

- $ 2\ \leq\ N\ \leq\ 2\ \times\ 10^5 $
- $ 1\ \leq\ a_1\ <\ a_2\ <\ \ldots\ <\ a_N\ \leq\ 10^9 $
- 入力される値はすべて整数である
 
### Sample Explanation 1

$ s=3 $ として操作を行うと、数列は $ (5,3,0) $ になります。このとき最大値は $ 5 $ です。 数列に負の項が生じてはいけないという条件の下で、これ以上数列の項の最大値を小さくすることはできませんので、$ 5 $ と答えてください。

### Sample Explanation 2

$ s=400 $ として操作を一度行うほか、$ s=500 $ として操作を行った後、$ s=300 $ としてもう一度操作を行うなどの方法が考えられます。

## 样例 #1

### 输入

```
3

1 3 6
```

### 输出

```
5
```

## 样例 #2

### 输入

```
5

400 500 600 700 800
```

### 输出

```
400
```



---

---
title: "[ARC153B] Grid Rotations"
layout: "post"
diff: 提高+/省选-
pid: AT_arc153_b
tag: ['数学', '平衡树']
---

# [ARC153B] Grid Rotations

## 题目描述

[problemUrl]: https://atcoder.jp/contests/arc153/tasks/arc153_b

縦 $ H $ 行，横 $ W $ 列のグリッドがあります．はじめ，上から $ i $ 行目，左から $ j $ 列目のマスには英小文字 $ A_{i,j} $ が書かれています．

このグリッドに対して $ Q $ 回の操作を行います．$ i $ 回目の操作では，$ 1\leq\ a_i\ \leq\ H-1 $, $ 1\leq\ b_i\leq\ W-1 $ を満たす整数 $ a_i,\ b_i $ が与えられ，次を行います．

- グリッド内の長方形領域 $ R_1,\ R_2,\ R_3,\ R_4 $ を次で定める：
  - 上から $ a_i $ 行，左から $ b_i $ 列の部分を $ R_1 $ とする．
  - 上から $ a_i $ 行，右から $ W-b_i $ 列の部分を $ R_2 $ とする．
  - 下から $ H-a_i $ 行，左から $ b_i $ 列の部分を $ R_3 $ とする．
  - 下から $ H-a_i $ 行，右から $ W-b_i $ 列の部分を $ R_4 $ とする．
- $ R_1,\ R_2,\ R_3,\ R_4 $ のそれぞれを $ 180 $ 度回転する．
 
ただし，グリッド内の長方形領域 $ R $ の $ 180 $ 度回転とは，$ R $ において上から $ i $ 番目，左から $ j $ 番目のマスに書かれた文字を，$ R $ において 下から $ i $ 番目，右から $ j $ 番目のマスに移すことをいいます．入出力例の図も参考にしてください．

$ Q $ 回すべての操作を行ったとき，操作後のグリッドの状態を出力してください．

## 输入格式

入力は以下の形式で標準入力から与えられます．

> $ H $ $ W $ $ A_{1,1}\cdots\ A_{1,\ W} $ $ \vdots $ $ A_{H,1}\cdots\ A_{H,\ W} $ $ Q $ $ a_1 $ $ b_1 $ $ \vdots $ $ a_Q $ $ b_Q $

## 输出格式

操作後のマス $ (i,j) $ に書かれている文字を $ B_{i,j} $ とするとき，操作後のグリッドの状態を，次の形式で出力してください．

> $ B_{1,1}\cdots\ B_{1,\ W} $ $ \vdots $ $ B_{H,1}\cdots\ B_{H,\ W} $

## 说明/提示

### 制約

- $ 2\leq\ H,\ W $ かつ $ HW\ \leq\ 5\times\ 10^5 $
- $ A_{i,j} $ は英小文字
- $ 1\leq\ Q\leq\ 2\times\ 10^5 $
- $ 1\leq\ a_i\leq\ H\ -\ 1 $
- $ 1\leq\ b_i\leq\ W\ -\ 1 $
 
### Sample Explanation 1

グリッドの状態は次の図のように変化します． !\[\](https://img.atcoder.jp/arc153/5503f0a5f92e488238556b943aa1d6b7.png)

### Sample Explanation 2

グリッドの状態は次の図のように変化します． !\[\](https://img.atcoder.jp/arc153/353f0b30a9561e38967fb3aedf5767c5.png)

### Sample Explanation 3

グリッドの状態は次の図のように変化します． !\[\](https://img.atcoder.jp/arc153/655a0ac98f0625e806f6abc97853a437.png)

## 样例 #1

### 输入

```
4 5

abcde

fghij

klmno

pqrst

1

3 3
```

### 输出

```
mlkon

hgfji

cbaed

rqpts
```

## 样例 #2

### 输入

```
3 7

atcoder

regular

contest

2

1 1

2 5
```

### 输出

```
testcon

oderatc

ularreg
```

## 样例 #3

### 输入

```
2 2

ac

wa

3

1 1

1 1

1 1
```

### 输出

```
ac

wa
```



---

---
title: "[ARC159C] Permutation Addition"
layout: "post"
diff: 提高+/省选-
pid: AT_arc159_c
tag: ['数学', '构造']
---

# [ARC159C] Permutation Addition

## 题目描述

[problemUrl]: https://atcoder.jp/contests/arc159/tasks/arc159_c

正整数列 $ A=(a_1,\ldots,a_N) $ が与えられます。

次の操作を $ 0 $ 回以上 $ 10^4 $ 回以下繰り返すことで $ A $ の値をすべて等しくできるかを判定し、可能な場合は操作列の一例を示してください。

- $ (1,\ldots,N) $ の順列 $ (p_1,\ldots,p_N) $ を決め、$ A $ を $ (a_1+p_1,\ldots,a_N+p_N) $ に置き換える。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ a_1 $ $ \ldots $ $ a_N $

## 输出格式

$ A $ の値をすべて等しくできない場合は `No` と出力せよ。  
 等しくできる場合、操作回数を $ M $ 回、$ i $ 回目の操作における順列を $ (p_{i,1},\ldots,p_{i,N}) $ として以下の形式で出力せよ。

> Yes $ M $ $ p_{1,1} $ $ \ldots $ $ p_{1,N} $ $ \vdots $ $ p_{M,1} $ $ \ldots $ $ p_{M,N} $

答えが複数存在する場合はどれを出力しても正解とみなされる。

## 说明/提示

### 制約

- $ 2\ \leq\ N\ \leq\ 50 $
- $ 1\ \leq\ a_i\ \leq\ 50 $
- 入力はすべて整数
 
### Sample Explanation 1

この出力例の通りに $ 8 $ 回の操作を行うことで $ A $ は $ (24,24) $ となり、値がすべて等しくなります。

### Sample Explanation 3

初めから $ A $ の値がすべて等しいです。

## 样例 #1

### 输入

```
2

15 9
```

### 输出

```
Yes

8

1 2

1 2

1 2

1 2

2 1

1 2

1 2

1 2
```

## 样例 #2

### 输入

```
5

1 2 3 10 10
```

### 输出

```
No
```

## 样例 #3

### 输入

```
4

1 1 1 1
```

### 输出

```
Yes

0
```



---

---
title: "[ARC166C] LU / RD Marking"
layout: "post"
diff: 提高+/省选-
pid: AT_arc166_c
tag: ['动态规划 DP', '数学']
---

# [ARC166C] LU / RD Marking

## 题目描述

[problemUrl]: https://atcoder.jp/contests/arc166/tasks/arc166_c

縦 $ H $ 行，横 $ W $ 列のグリッドがあります．

このグリッドには縦向きの辺が $ H(W+1) $ 個，横向きの辺が $ W(H+1) $ 個，合計で $ H(W+1)\ +\ W(H+1) $ 個の辺があります（入出力例の図も参考にしてください）．これらの辺に対して，次の $ 2 $ 種の操作によって印をつけることを考えます．

- **操作 (1)**：操作を行う時点で左側の辺と上側の辺に印がついていないようなマスをひとつ選ぶ．そのマスの左側の辺と上側の辺に印をつける．
- **操作 (2)**：操作を行う時点で右側の辺と下側の辺に印がついていないようなマスをひとつ選ぶ．そのマスの右側の辺と下側の辺に印をつける．
 
操作 (1) と操作 (2) を（$ 0 $ 回を含め）何回でも行えるとき，最終的に印がついている辺の集合としてありうるものの個数を $ 998244353 $ で割った余りを求めてください．

$ T $ 個のテストケースが与えられるので，それぞれについて答えを求めてください．

## 输入格式

入力は以下の形式で標準入力から与えられます．

> $ T $ $ \text{case}_1 $ $ \vdots $ $ \text{case}_T $

各テストケースは以下の形式で与えられます．

> $ H $ $ W $

## 输出格式

$ T $ 行出力してください．$ i $ 行目には $ i $ 番目のテストケースについて，最終的に印がついている辺の集合としてありうるものの個数を $ 998244353 $ で割った余りを出力してください．

## 说明/提示

### 制約

- $ 1\leq\ T\leq\ 2\times\ 10^5 $
- $ 1\leq\ H,\ W\leq\ 10^6 $
 
### Sample Explanation 1

$ (H,\ W)=(1,1) $ の場合には，最終的に印がついている辺の集合としてありうるのは次の $ 4 $ 通りです．印がついている辺を太線で表しています． !\[\](https://img.atcoder.jp/arc166/bd84a15ada55c0df6d4e66863053bd59.png) $ (H,\ W)=(2,3) $ の場合には，例えば次のような辺の集合が\*\*ありえます\*\*． !\[\](https://img.atcoder.jp/arc166/66c77b9132c38d82c36732966ff3ae4f.png) 一方で，次のような辺の集合は\*\*ありえません\*\*． !\[\](https://img.atcoder.jp/arc166/0029e3cc83a0232231ddf6e280c7f9a8.png)

## 样例 #1

### 输入

```
2

1 1

2 3
```

### 输出

```
4

800
```

## 样例 #2

### 输入

```
3

123 456

654 321

1000000 1000000
```

### 输出

```
60549740

298307903

656009181
```



---

---
title: "[ARC167C] MST on Line++"
layout: "post"
diff: 提高+/省选-
pid: AT_arc167_c
tag: ['生成树', '组合数学']
---

# [ARC167C] MST on Line++

## 题目描述

[problemUrl]: https://atcoder.jp/contests/arc167/tasks/arc167_c

正整数 $ N,K $ と長さ $ N $ の正整数列 $ A=(A_{1},A_{2},\dots,A_{N}) $ が与えられます。

$ (1,2,\dots\ ,N) $ の順列 $ P=(P_{1},P_{2},\dots\ ,P_{N}) $ に対して以下の「問題 MST on Line」について考え、その答えを $ f(P) $ と書きます。

> **問題 MST on Line**
> 
> 頂点に $ 1 $ から $ N $ までの番号がついた頂点数 $ N $ の重み付き無向グラフ $ G $ があります。$ G $ について $ 1\leq\ i\lt\ j\leq\ N $ を満たす任意の整数の組 $ (i,j) $ に対して以下が成り立ちます。
> 
> - $ j-i\leq\ K $ ならば頂点 $ i $ と頂点 $ j $ の間に辺が存在して、その辺の重みは **$ \max(A_{P_{i}},A_{P_{j}}) $**
> - $ j-i\gt\ K $ ならば頂点 $ i $ と頂点 $ j $ の間に辺は存在しない
>  
> $ G $ の最小全域木の辺の重みの和を求めてください。

全ての $ (1,2,\dots\ ,N) $ の順列 $ P=(P_{1},P_{2},\dots\ ,P_{N}) $ に対する $ f(P) $ の総和を $ 998244353 $ で割ったあまりを求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられます。

> $ N $ $ K $ $ A_{1} $ $ A_{2} $ $ \cdots $ $ A_{N} $

## 输出格式

答えを出力してください。

## 说明/提示

### 制約

- $ 1\leq\ K\lt\ N\leq\ 5000 $
- $ 1\leq\ A_{i}\leq\ 10^{9} $
- 入力は全て整数
 
### Sample Explanation 1

$ P=(1,2,3,4,5) $ としたとき、 頂点 $ 1 $ と $ 2 $ の間に存在する、重み $ 4 $ の辺、 頂点 $ 2 $ と $ 3 $ の間に存在する、重み $ 5 $ の辺、 頂点 $ 2 $ と $ 4 $ の間に存在する、重み $ 4 $ の辺、 頂点 $ 4 $ と $ 5 $ の間に存在する、重み $ 2 $ の辺、 という $ 4 $ つの辺は $ G $ の全域木となり、辺の重みの和は $ 15 $ です。 これ以上辺の重みの和を少なくするように全域木をとることはできないので、$ f(P)=15 $ となります。 以上のように全ての $ (1,2,3,4,5) $ の順列 $ P $ に対する $ f(P) $ の総和を求めると $ 1740 $ になるので、これを出力します。

## 样例 #1

### 输入

```
5 2

3 4 5 2 1
```

### 输出

```
1740
```

## 样例 #2

### 输入

```
2 1

167 924
```

### 输出

```
1848
```

## 样例 #3

### 输入

```
12 9

22847 98332 854 68844 81080 46058 40949 62493 76561 52907 88628 99740
```

### 输出

```
660459584
```



---

---
title: "[ARC168C] Swap Characters"
layout: "post"
diff: 提高+/省选-
pid: AT_arc168_c
tag: ['枚举', '组合数学']
---

# [ARC168C] Swap Characters

## 题目描述

[problemUrl]: https://atcoder.jp/contests/arc168/tasks/arc168_c

`A`, `B`, `C` からなる長さ $ N $ の文字列 $ S $ が与えられます．

以下の操作を $ 0 $ 回以上 $ K $ 回以下行うことを考えます．

- $ S $ 内の $ 2 $ 文字を自由に選び，入れ替える．
 
操作後の $ S $ としてあり得る文字列が何通りあるかを $ 998244353 $ で割ったあまりを求めてください．

## 输入格式

入力は以下の形式で標準入力から与えられる．

> $ N $ $ K $ $ S $

## 输出格式

答えを出力せよ．

## 说明/提示

### 制約

- $ 1\ \leq\ N\ \leq\ 250000 $
- $ 1\ \leq\ K\ \leq\ 100 $
- $ S $ は `A`, `B`, `C` からなる長さ $ N $ の文字列．
- 入力される値はすべて整数．
 
### Sample Explanation 1

以下のように $ 4 $ 通りの文字列が得られます． - $ S= $`ABC` : $ 0 $ 回の操作を行えばよい． - $ S= $`BAC` : $ 1,2 $ 文字目を入れ替える操作を行えばよい． - $ S= $`CBA` : $ 1,3 $ 文字目を入れ替える操作を行えばよい． - $ S= $`ACB` : $ 2,3 $ 文字目を入れ替える操作を行えばよい．

## 样例 #1

### 输入

```
3 1

ABC
```

### 输出

```
4
```

## 样例 #2

### 输入

```
3 2

ABC
```

### 输出

```
6
```

## 样例 #3

### 输入

```
4 5

AAAA
```

### 输出

```
1
```

## 样例 #4

### 输入

```
30 10

CACCABAABBABABBCBBCAAACAAACCCA
```

### 输出

```
42981885
```



---

---
title: "[ARC185E] Adjacent GCD"
layout: "post"
diff: 提高+/省选-
pid: AT_arc185_e
tag: ['数学', '数论', '标签462']
---

# [ARC185E] Adjacent GCD

## 题目描述

定义一个整数序列 $B=(B_1,B_2,\dots,B_k)$ 的分数为 $\sum_{i=1}^{k-1}\gcd(B_i,B_{i+1})$。

给出一个整数序列 $A=(A_1,A_2,\dots,A_N)$，求出以下问题在 $m=1,2,\dots,N$ 时的答案：

- 序列 $A=(A_1,A_2,\dots,A_m)$ 有 $2^m-1$ 个非空子序列。求出这些子序列的分数之和对 $998244353$ 取模后的值。如果两个子序列在原序列中的位置不同，即使它们的元素全部相同，我们也认为它们是不同的。

## 输入格式

输入来自标准输入，格式如下：

> $N$
> $A_1\ A_2\ \dots\ A_N$

## 输出格式

输出 $N$ 行，第 $i$ 行表示当 $m=i$ 时的答案。

### 样例 1 解释

以 $m=3$ 为例。以下是 $(A_1,A_2,A_3)=(9,6,4)$ 的所有非空子序列和分数：

- $(9)$，分数为 $0$。  
- $(6)$，分数为 $0$。  
- $(4)$，分数为 $0$。  
- $(9,6)$，分数为 $\gcd(9,6)=3$。  
- $(9,4)$，分数为 $\gcd(9,4)=1$。
- $(6,4)$，分数为 $\gcd(6,4)=2$。
- $(9,6,4)$，分数为 $\gcd(9,6)+\gcd(6,4)=3+2=5$。

因此当 $m=3$ 时答案为 $0+0+0+3+1+2+5=11$。

## 说明/提示

- $1\le N\le 5\times 10^5$
- $1\le A_i\le 10^5$
- 输入的值全部为整数

## 样例 #1

### 输入

```
3

9 6 4
```

### 输出

```
0

3

11
```

## 样例 #2

### 输入

```
5

3 8 12 6 9
```

### 输出

```
0

1

13

57

155
```

## 样例 #3

### 输入

```
10

47718 21994 74148 76721 98917 73766 29598 59035 69293 29127
```

### 输出

```
0

2

14

35

97

372

866

1859

4273

43287
```



---

---
title: "[ARC186B] Typical Permutation Descriptor"
layout: "post"
diff: 提高+/省选-
pid: AT_arc186_b
tag: ['树形 DP', '组合数学', '笛卡尔树']
---

# [ARC186B] Typical Permutation Descriptor

## 题目描述

[problemUrl]: https://atcoder.jp/contests/arc186/tasks/arc186_b

長さ $ N $ の整数列 $ (A_1,\dots,A_N) $ が与えられます。この整数列は、各 $ i=1,\dots,N $ について、$ 0\le\ A_i\ <\ i $ を満たします。 次の条件を満たす $ (1,\dots,N) $ の順列 $ (P_1,\dots,P_N) $ の数を $ 998244353 $ で割ったあまりを求めてください。

- $ i=1,\dots,N $ について、
  - $ A_i\ <\ j\ <\ i $ であるすべての整数 $ j $ について、$ P_j\ >\ P_i $
  - $ A_i\ >\ 0 $ ならば $ P_{A_i}\ <\ P_i $

ただし、この問題の入力で与えられる $ (A_1,\dots,A_N) $ について、条件を満たす順列が存在することが保証されます。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ A_1 $ $ A_2 $ $ \dots $ $ A_N $

## 输出格式

条件を満たす順列の数を $ 998244353 $ で割ったあまりを出力せよ。

## 说明/提示

### 制約

- $ 1\le\ N\le\ 3\times\ 10^5 $
- $ 0\le\ A_i\ \lt\ i $
- $ A_1,\dots,A_N $ について、問題文中の条件を満たすような順列が存在する
- 入力はすべて整数

### Sample Explanation 1

$ (2,\ 3,\ 1,\ 4),\ (2,\ 4,\ 1,\ 3),\ (3,\ 4,\ 1,\ 2) $ の $ 3 $ つです。

### Sample Explanation 2

$ 2350309500 $ を $ 998244353 $ で割ったあまりである、 $ 353820794 $ が答えです。

## 样例 #1

### 输入

```
4
0 1 0 3
```

### 输出

```
3
```

## 样例 #2

### 输入

```
22
0 1 2 2 2 2 2 2 1 9 9 9 9 0 14 15 15 15 14 19 19 19
```

### 输出

```
353820794
```



---

---
title: "[ARC187B] Sum of CC"
layout: "post"
diff: 提高+/省选-
pid: AT_arc187_b
tag: ['动态规划 DP', '数学', '组合数学']
---

# [ARC187B] Sum of CC

## 题目描述

对于序列 $A=(A_1,A_2,\cdots,A_N)$ ，定义 $f(A)$ 如下：

- 图中包含 $N$ 个点，编号 $1\sim N$，初始没有边。对于每个满足 $1\le i<j\le N$ 的二元组 $(i,j)$，如果 $A_i\le A_j$，则在节点 $i,j$ 之间连接一条双向边。
- $f(A)$ 是图中的连通块数量。

给定序列 $B=(B_1,B_2,\cdots,B_N)$，每一项的值 $1\le B_i\le M$ 或者 $B_i=-1$。

将 $B$ 序列中的 $-1$ 替换为 $1$ 到 $M$ 中的整数，有 $M^q$ 种不同的序列 $B'$，其中 $q$ 是 $B$ 序列中 $-1$ 的数量。

求所有 $B'$ 序列的 $f(B')$ 之和 $\bmod 998\ 244\ 353$。

## 输入格式

第一行两个整数 $N,M$。

第二行 $N$ 个整数 $B_1,B_2,\cdots,B_N$。

## 输出格式

一个整数答案。

## 样例 #1

### 输入

```
3 3
2 -1 1
```

### 输出

```
6
```

## 样例 #2

### 输入

```
10 8
-1 7 -1 -1 -1 2 -1 1 -1 2
```

### 输出

```
329785
```

## 样例 #3

### 输入

```
11 12
-1 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1
```

### 输出

```
529513150
```



---

---
title: "[ARC190B] L Partition"
layout: "post"
diff: 提高+/省选-
pid: AT_arc190_b
tag: ['组合数学']
---

# [ARC190B] L Partition

## 题目描述

有一个 $N \times N$ 的网格。从上往下第 $i$ 行、从左往右第 $j$ 列的格子记作 $(i,j)$。

对于 $K=1,2,\ldots,N$，级别 $K$ 的 **L 型** 是指由 $2K-1$ 个格子组成的集合，且满足以下四个条件中的至少一个：

- 从某个格子 $(i,j)$ 出发，向下或向右移动 $0$ 格以上、$K-1$ 格以下所到达的所有格子（其中 $1 \leq i \leq N-K+1$，$1 \leq j \leq N-K+1$）。
- 从某个格子 $(i,j)$ 出发，向下或向左移动 $0$ 格以上、$K-1$ 格以下所到达的所有格子（其中 $1 \leq i \leq N-K+1$，$K \leq j \leq N$）。
- 从某个格子 $(i,j)$ 出发，向上或向右移动 $0$ 格以上、$K-1$ 格以下所到达的所有格子（其中 $K \leq i \leq N$，$1 \leq j \leq N-K+1$）。
- 从某个格子 $(i,j)$ 出发，向上或向左移动 $0$ 格以上、$K-1$ 格以下所到达的所有格子（其中 $K \leq i \leq N$，$K \leq j \leq N$）。

给定格子 $(a,b)$ 以及 $Q$ 个查询 $k_1, \ldots, k_Q$。

对于每个 $i$，请计算将整个网格划分为级别 $1, \ldots, N$ 的 L 型各一个的方法数（要求格子 $(a,b)$ 包含在级别 $k_i$ 的 L 型中），结果对 $998244353$ 取模后输出。


## 输入格式

输入通过标准输入给出，格式如下：

> $N$ $a$ $b$
> $Q$
> $k_1$ $\cdots$ $k_Q$

## 输出格式

输出 $Q$ 行。

第 $i$ 行应输出满足条件的划分方法数对 $998244353$ 取模后的结果。


## 说明/提示

### 约束条件

- $1 \leq N \leq 10^7$
- $1 \leq a \leq N$
- $1 \leq b \leq N$
- $1 \leq Q \leq \min\{ N, 200000 \}$
- $1 \leq k_1 < \cdots < k_Q \leq N$
- 输入中的所有值均为整数

### 样例解释 1

存在如下图所示的 $6$ 种满足条件的方法。图中格子上的整数 $k$ 表示该格子属于级别 $k$ 的 L 型。 

![](https://img.atcoder.jp/arc190/d853bd693f0d3848c725803512dc382a.png)

翻译由 DeepSeek R1 完成

## 样例 #1

### 输入

```
3 1 2
1
2
```

### 输出

```
6
```

## 样例 #2

### 输入

```
5 2 5
3
1 3 5
```

### 输出

```
4
32
128
```

## 样例 #3

### 输入

```
100 50 50
4
1 10 50 100
```

### 输出

```
934228871
758172260
444239843
0
```



---

---
title: "Not Too Close"
layout: "post"
diff: 提高+/省选-
pid: AT_soundhound2018_summer_final_c
tag: ['动态规划 DP', '组合数学']
---

# Not Too Close

## 题目描述

[problemUrl]: https://atcoder.jp/contests/soundhound2018-summer-final/tasks/soundhound2018_summer_final_c

$ N $ 頂点の無向グラフであって、以下の条件をすべて満たすものの個数を $ 10^9\ +\ 7 $ で割った余りを求めてください。

- $ N $ 個の頂点には $ 1 $ から $ N $ までの番号が振られている。
- グラフは自己辺や多重辺を持たない（連結である必要はない）。
- すべての辺の長さを $ 1 $ とすると、頂点 $ 1,\ 2 $ 間の最短距離は $ D $ である。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ D $

## 输出格式

条件をすべて満たすグラフの個数を $ 10^9\ +\ 7 $ で割った余りを出力せよ。

## 说明/提示

### 注記

二つのグラフ $ G_1,\ G_2 $ は、以下が満たされる場合に異なるとみなされ、満たされない場合に同一とみなされます。

- ある整数の組 $ (i,\ j) $ $ (1\ <\ =\ i\ <\ j\ <\ =\ N) $ が存在し、頂点 $ i,\ j $ を直接結ぶ辺が $ G_1,\ G_2 $ のうち一方のみに存在する。

### 制約

- $ 1\ <\ =\ D\ <\ N\ <\ =\ 30 $
- $ N,\ D $ は整数である。

### Sample Explanation 1

条件を満たすグラフは下図の $ 2 $ 通りです。 !\[\](https://img.atcoder.jp/soundhound2018-summer-final/4b0c83895d12c1a9c90cb3e8060db969.png)

### Sample Explanation 2

条件を満たすグラフは下図の $ 14 $ 通りです。 !\[\](https://img.atcoder.jp/soundhound2018-summer-final/df4dffb7f2140b22a6c7ccc86f6c9cf9.png)

### Sample Explanation 3

mod $ (10^9\ +\ 7) $ にご注意ください。

## 样例 #1

### 输入

```
4 3
```

### 输出

```
2
```

## 样例 #2

### 输入

```
4 2
```

### 输出

```
14
```

## 样例 #3

### 输入

```
30 15
```

### 输出

```
313862829
```



---

---
title: "素数取りゲーム"
layout: "post"
diff: 提高+/省选-
pid: AT_ttpc2019_d
tag: ['数学', '博弈论', '素数判断,质数,筛法', '位运算']
---

# 素数取りゲーム

## 题目描述

# 素数取り游戏



东工大的安酱和爱酱玩了一个叫做石头取走游戏的两人游戏，但是因为知道必胜法，所以不再感兴趣了。

于是，安酱考虑了一个基于素数的石头取回游戏，并将它命名为“素数取回游戏”。

素数取回游戏的规则如下：

- 开始时有 $N$ 堆小石子，在第 $i$ 堆中有 $X_i$ 个（$X_i$ 是素数）小石子。
- 两个玩家轮流选择存在小石堆的那一堆，并从那里拿走一些石子。
- **只能同时获取素数枚石子，并且在剩余的石子数量为 $0$ 或素数枚时才能继续进行**
- 先无法拿走石头的玩家输掉比赛。

虽然这条规则新颖，但似乎安和爱仍然知道怎样获胜。

请问当安穗是先手，爱穗是后手，面对由 $X_1$，$X_2$，$\ldots$，$X_N$ 个石头组成的 $N$ 堆石头时，假设他们采取最优策略，谁将获胜？

## 输入格式

从标准输入中按以下格式给出输入：

> $ N $ $ X_1 $ $ X_2 $ $ \ldots $ $ X_N $

## 输出格式

如果先手安穂赢了，输出 `An`；如果后手爱赢了，则输出 `Ai`。

## 样例 #1

### 输入

```
1

13
```

### 输出

```
An
```

## 样例 #2

### 输入

```
2

17 13
```

### 输出

```
An
```

## 样例 #3

### 输入

```
6

49529 868033 52361 519803 19289 386501
```

### 输出

```
Ai
```



---


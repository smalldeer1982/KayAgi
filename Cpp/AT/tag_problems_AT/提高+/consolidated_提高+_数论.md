---
title: "[ABC020D] LCM Rush"
layout: "post"
diff: 提高+/省选-
pid: AT_abc020_d
tag: ['数论', '莫比乌斯反演']
---

# [ABC020D] LCM Rush

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc020/tasks/abc020_d

$ 2 $ つの正整数 $ a, $ $ b $ の最小公倍数 $ LCM(a,\ b) $ とは、 $ a $ の倍数であり、かつ $ b $ の倍数でもあるような正整数のうち最小のものをいいます。

$ 2 $ つの正整数 $ N, $ $ K $ が与えられます。 $ 1 $ 以上 $ N $ 以下のすべての整数 $ i $ について $ LCM(i,\ K) $ を足しあわせたものを $ 1,000,000,007 $ で割った余りを求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ K $

- $ 1 $ 行目に、 $ 2 $ 個の整数 $ N, $ $ K $ ($ 1 $ $ ≦ $ $ N, $ $ K $ $ ≦ $ $ 10^9 $) がスペース区切りで与えられる。

## 输出格式

標準出力に、求める和を $ 1,000,000,007 $ で割った余りを出力せよ。

末尾の改行を忘れないこと。

## 说明/提示

### 部分点

この問題は AtCoder Beginner Contest の問題としては非常に難しいため、通常 ($ 100 $ 点満点) と異なり $ 101 $ 点満点であり、部分点が設定されている。

- $ 5 $ 点分のテストケースは $ 1 $ $ ≦ $ $ N, $ $ K $ $ ≦ $ $ 100 $ を満たす。
- 別の $ 10 $ 点分のテストケースは $ 1 $ $ ≦ $ $ N $ $ ≦ $ $ 10^4, $ $ 1 $ $ ≦ $ $ K $ $ ≦ $ $ 100 $ を満たす。
- さらに別の $ 85 $ 点分のテストケースは $ 1 $ $ ≦ $ $ N $ $ ≦ $ $ 10^9, $ $ 1 $ $ ≦ $ $ K $ $ ≦ $ $ 100 $ を満たす。以上で合計 $ 100 $ 点となる。

### Sample Explanation 1

$ LCM(1,\ 2)\ +\ LCM(2,\ 2)\ +\ LCM(3,\ 2)\ +\ LCM(4,\ 2)\ =\ 2\ +\ 2\ +\ 6\ +\ 4\ =\ 14 $ となります。

## 样例 #1

### 输入

```
4 2
```

### 输出

```
14
```

## 样例 #2

### 输入

```
10000 100
```

### 输出

```
865504986
```

## 样例 #3

### 输入

```
1000000000 90
```

### 输出

```
50001213
```

## 样例 #4

### 输入

```
1000000000 999999900
```

### 输出

```
231285006
```



---

---
title: "[ABC286F] Guess The Number 2"
layout: "post"
diff: 提高+/省选-
pid: AT_abc286_f
tag: ['数论', '中国剩余定理 CRT']
---

# [ABC286F] Guess The Number 2

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc286/tasks/abc286_f

この問題は **インタラクティブな問題**（あなたが作成したプログラムとジャッジプログラムが標準入出力を介して対話を行う形式の問題）です。

あなたとジャッジは下記の手順を行います。 手順はフェイズ $ 1 $ とフェイズ $ 2 $ からなり、まずフェイズ $ 1 $ を行った直後、続けてフェイズ $ 2 $ を行います。

（フェイズ $ 1 $ ）

- ジャッジが $ 1 $ 以上 $ 10^9 $ 以下の整数 $ N $ を決める。この整数は隠されている。
- あなたは $ 1 $ 以上 $ 110 $ 以下の整数 $ M $ を出力する。
- さらにあなたは、すべての $ i\ =\ 1,\ 2,\ \ldots,\ M $ について $ 1\ \leq\ A_i\ \leq\ M $ を満たす、長さ $ M $ の整数列 $ A=(A_1,A_2,\ldots,A_M) $ を出力する。
 
（フェイズ $ 2 $ ）

- ジャッジから、長さ $ M $ の整数列 $ B=(B_1,B_2,\ldots,B_M) $ が与えられる。ここで、 $ B_i\ =\ f^N(i) $ である。 $ f(i) $ は $ 1 $ 以上 $ M $ 以下の整数 $ i $ に対し $ f(i)=A_i $ で定められ、 $ f^N(i) $ は $ i $ を $ f(i) $ で置き換える操作を $ N $ 回行った際に得られる整数である。
- あなたは、$ B $ の情報から、ジャッジが決めた整数 $ N $ を特定し、$ N $ を出力する。
 
上記の手順を行った後、直ちにプログラムを終了することで正解となります。

### Input &amp; Output Format

この問題はインタラクティブな問題（あなたが作成したプログラムとジャッジプログラムが標準入出力を介して対話を行う形式の問題）です。

（フェイズ $ 1 $ ）

- まず、$ 1 $ 以上 $ 110 $ 以下の整数 $ M $ を出力してください。出力後、必ず改行してください。
 
> $ M $

- その後、空白区切りで $ 1 $ 以上 $ M $ 以下の整数からなる長さ $ M $ の整数列 $ A=(A_1,A_2,\ldots,A_M) $ を出力してください。出力後、必ず改行してください。
 
> $ A_1 $ $ A_2 $ $ \ldots $ $ A_M $

（フェイズ $ 2 $ ）

- まず、長さ $ M $ の整数列 $ B=(B_1,B_2,\ldots,B_M) $ が入力から与えられます。
 
> $ B_1 $ $ B_2 $ $ \ldots $ $ B_M $

- 整数 $ N $ を求め、出力してください。出力後、必ず改行してください。
 
> $ N $

不正な出力がなされた場合、ジャッジは `-1` を出力します。この時、提出はすでに不正解と判定されています。ジャッジプログラムはこの時点で終了するため、あなたのプログラムも終了するのが望ましいです。

## 说明/提示

### 制約

- $ N $ は $ 1 $ 以上 $ 10^9 $ 以下の整数
 
### 注意点

- **出力を行うたびに、末尾に改行を入れて標準出力を flush してください。そうしなかった場合、ジャッジ結果が TLE となる可能性があります。**
- **対話の途中で不正な出力を行った、あるいはプログラムが途中で終了した場合のジャッジ結果は不定です。**
- 答えを出力したら(または `-1` を受け取ったら)直ちにプログラムを正常終了してください。そうしなかった場合、ジャッジ結果は不定です。
- 特に、余計な改行も不正なフォーマットの出力とみなされるので注意してください。
 
### 入出力例

以下は、$ N\ =\ 2 $ の場合の入出力例です。

    入力 出力 説明        ジャッジは $ N=2 $ と決めました。$ N $ は入力としては与えられず、隠されています。    `4` $ M $ を出力します。    `2 3 4 4` $ A=(2,3,4,4) $ を出力します。    `3 4 4 4`   $ f^2(1)=3,f^2(2)=4,f^2(3)=4,f^2(4)=4 $ なので、ジャッジは $ B=(3,4,4,4) $ をあなたのプログラムに与えます。    `2` $ B $ から $ N=2 $ であると特定しました。 $ N $ を出力し、プログラムを正常終了させてください。



---

---
title: "[ABC371G] Lexicographically Smallest Permutation"
layout: "post"
diff: 提高+/省选-
pid: AT_abc371_g
tag: ['贪心', '数论']
---

# [ABC371G] Lexicographically Smallest Permutation

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc371/tasks/abc371_g

$ (1,2,\ldots,N) $ の並べ替え $ P=(P\ _\ 1,P\ _\ 2,\ldots,P\ _\ N),A=(A\ _\ 1,A\ _\ 2,\ldots,A\ _\ N) $ が与えられます。

あなたは、次の操作を $ 0 $ 回以上好きな回数行うことができます。

- $ i=1,2,\ldots,N $ に対して**一斉に** $ A\ _\ i $ を $ A\ _\ {P\ _\ i} $ で置き換える。
 
得られる $ A $ としてありえるもののうち、辞書順で最小のものを出力してください。

 辞書順の大小とは？ 長さ $ N $ の列 $ A=(A\ _\ 1,A\ _\ 2,\ldots,A\ _\ N),B=(B\ _\ 1,B\ _\ 2,\ldots,B\ _\ N) $ について、辞書順で $ A $ が $ B $ より小さいとは、次のことが成り立つことをいいます。

- ある整数 $ i\ (1\leq\ i\leq\ N) $ が存在し、$ A\ _\ i\lt\ B\ _\ i $ が成り立ち、$ 1\leq\ j\lt\ i $ を満たすすべての整数 $ j $ に対して $ A\ _\ j=B\ _\ j $ が成り立つ。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ P\ _\ 1 $ $ P\ _\ 2 $ $ \ldots $ $ P\ _\ N $ $ A\ _\ 1 $ $ A\ _\ 2 $ $ \ldots $ $ A\ _\ N $

## 输出格式

$ 0 $ 回以上の操作の結果としてあり得る $ A $ のうち辞書順で最小のものを $ (A\ _\ 1,A\ _\ 2,\ldots,A\ _\ N) $ として、$ A\ _\ 1,A\ _\ 2,\ldots,A\ _\ N $ をこの順に空白を区切りとして $ 1 $ 行に出力せよ。

## 说明/提示

### 制約

- $ 1\leq\ N\leq2\times10\ ^\ 5 $
- $ 1\leq\ P\ _\ i\leq\ N\ (1\leq\ i\leq\ N) $
- $ P\ _\ i\neq\ P\ _\ j\ (1\leq\ i\lt\ j\leq\ N) $
- $ 1\leq\ A\ _\ i\leq\ N\ (1\leq\ i\leq\ N) $
- $ A\ _\ i\neq\ A\ _\ j\ (1\leq\ i\lt\ j\leq\ N) $
- 入力はすべて整数
 
### Sample Explanation 1

はじめ、$ A=(4,3,1,6,2,5) $ です。 ここから操作を繰り返すと、以下のようになります。 - $ A=(1,4,2,5,3,6) $ となる。 - $ A=(2,1,3,6,4,5) $ となる。 - $ A=(3,2,4,5,1,6) $ となる。 - $ A=(4,3,1,6,2,5) $ となる。 以降、$ 4 $ 回操作を行うたびにもとの $ A $ に戻ります。 よって、このうち辞書順で最小である `1 4 2 5 3 6` を出力してください。

### Sample Explanation 2

$ 1 $ 度も操作をしなくても構いません。

## 样例 #1

### 输入

```
6

3 1 5 6 2 4

4 3 1 6 2 5
```

### 输出

```
1 4 2 5 3 6
```

## 样例 #2

### 输入

```
8

3 5 8 7 2 6 1 4

1 2 3 4 5 6 7 8
```

### 输出

```
1 2 3 4 5 6 7 8
```

## 样例 #3

### 输入

```
26

24 14 4 20 15 19 16 11 23 22 12 18 21 3 6 8 26 2 25 7 13 1 5 9 17 10

15 3 10 1 13 19 22 24 20 4 14 23 7 26 25 18 11 6 9 12 2 21 5 16 8 17
```

### 输出

```
4 1 22 18 20 13 14 6 15 11 3 26 2 12 5 23 9 10 25 24 7 17 16 21 19 8
```



---

---
title: "[AGC036B] Do Not Duplicate"
layout: "post"
diff: 提高+/省选-
pid: AT_agc036_b
tag: ['数学', '数论', '图论建模']
---

# [AGC036B] Do Not Duplicate

## 题目描述

[problemUrl]: https://atcoder.jp/contests/agc036/tasks/agc036_b

長さ $ N\ \times\ K $ の数列 $ X=(X_0,X_1,\cdots,X_{N\ \times\ K-1}) $ があります。 数列 $ X $ の要素は長さ $ N $ の数列 $ A=(A_0,A_1,\cdots,A_{N-1}) $ によって表され、全ての $ i,j $ ($ 0\ \leq\ i\ \leq\ K-1,\ 0\ \leq\ j\ \leq\ N-1 $) について、 $ X_{i\ \times\ N\ +\ j}=A_j $ です。

すぬけさんは、整数列 $ s $ を持っています。 最初、$ s $ は空です。 すぬけさんはこれから、すべての $ i=0,1,2,\cdots,N\ \times\ K-1 $ について、この順に、以下の操作を行います。

- $ s $ が $ X_i $ を含んでいない場合: $ s $ の末尾に $ X_i $ を追加する。
- $ s $ が $ X_i $ を含んでいる場合: $ s $ が $ X_i $ を含まなくなるまで、$ s $ の末尾の要素を削除し続ける。 このとき、$ X_i $ を末尾に**加えない**ことに注意せよ。

全ての操作が終わったあとの数列 $ s $ の状態を求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ K $ $ A_0 $ $ A_1 $ $ \cdots $ $ A_{N-1} $

## 输出格式

全ての操作が終わったあとの数列 $ s $ の要素を、先頭から末尾の順に空白区切りで出力せよ。

## 说明/提示

### 制約

- $ 1\ \leq\ N\ \leq\ 2\ \times\ 10^5 $
- $ 1\ \leq\ K\ \leq\ 10^{12} $
- $ 1\ \leq\ A_i\ \leq\ 2\ \times\ 10^5 $
- 入力される値はすべて整数である。

### Sample Explanation 1

$ X=(1,2,3,1,2,3) $ です。 操作は、以下のように行われます。 - $ i=0 $: $ s $ が $ 1 $ を含まないので、$ s $ の末尾に $ 1 $ を追加する。$ s=(1) $ となる。 - $ i=1 $: $ s $ が $ 2 $ を含まないので、$ s $ の末尾に $ 2 $ を追加する。$ s=(1,2) $ となる。 - $ i=2 $: $ s $ が $ 3 $ を含まないので、$ s $ の末尾に $ 3 $ を追加する。$ s=(1,2,3) $ となる。 - $ i=3 $: $ s $ が $ 1 $ を含むので、$ s $ が $ 1 $ を含む限り、末尾の要素を削除し続ける。$ s $ は $ (1,2,3)→(1,2)→(1)→() $ と変化する。 - $ i=4 $: $ s $ が $ 2 $ を含まないので、$ s $ の末尾に $ 2 $ を追加する。$ s=(2) $ となる。 - $ i=5 $: $ s $ が $ 3 $ を含まないので、$ s $ の末尾に $ 3 $ を追加する。$ s=(2,3) $ となる。

### Sample Explanation 3

数列 $ s $ が空のこともあります。

## 样例 #1

### 输入

```
3 2

1 2 3
```

### 输出

```
2 3
```

## 样例 #2

### 输入

```
5 10

1 2 3 2 3
```

### 输出

```
3
```

## 样例 #3

### 输入

```
6 1000000000000

1 1 2 2 3 3
```

### 输出

```

```

## 样例 #4

### 输入

```
11 97

3 1 4 1 5 9 2 6 5 3 5
```

### 输出

```
9 2 6
```



---

---
title: "[AGC043B] 123 Triangle"
layout: "post"
diff: 提高+/省选-
pid: AT_agc043_b
tag: ['数论', '排列组合', 'Lucas 定理', '差分']
---

# [AGC043B] 123 Triangle

## 题目描述

[problemUrl]: https://atcoder.jp/contests/agc043/tasks/agc043_b

各要素が $ 1 $ か $ 2 $ か $ 3 $ である長さ $ N $ の数字列 $ a_1a_2\ldots\ a_N $ が与えられます。 $ x_{i,j} $ を次のように定義します。

- $ x_{1,j}\ :=\ a_j $ $ \quad $ ($ 1\ \leq\ j\ \leq\ N $)
- $ x_{i,j}\ :=\ |\ x_{i-1,j}\ -\ x_{i-1,j+1}\ | $ $ \quad $ ($ 2\ \leq\ i\ \leq\ N $ かつ $ 1\ \leq\ j\ \leq\ N+1-i $)

$ x_{N,1} $ を求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ a_1 $$ a_2 $$ \ldots $$ a_N $

## 输出格式

$ x_{N,1} $ を出力せよ。

## 说明/提示

### 制約

- $ 2\ ≦\ N\ ≦\ 10^6 $
- $ a_i\ =\ 1,2,3 $ $ (1\ \leq\ i\ \leq\ N) $

### Sample Explanation 1

$ x_{1,1},x_{1,2},x_{1,3},x_{1,4} $ はそれぞれ、$ 1,2,3,1 $ です。 $ x_{2,1},x_{2,2},x_{2,3} $ はそれぞれ、$ |1-2|\ =\ 1,|2-3|\ =\ 1,|3-1|\ =\ 2 $ です。 $ x_{3,1},x_{3,2} $ はそれぞれ、$ |1-1|\ =\ 0,|1-2|\ =\ 1 $ です。 最後に、 $ x_{4,1}\ =\ |0-1|\ =\ 1 $ なので、答えは $ 1 $ です。

## 样例 #1

### 输入

```
4

1231
```

### 输出

```
1
```

## 样例 #2

### 输入

```
10

2311312312
```

### 输出

```
0
```



---

---
title: "[ARC122C] Calculator"
layout: "post"
diff: 提高+/省选-
pid: AT_arc122_c
tag: ['数论', '斐波那契数列', 'Ad-hoc']
---

# [ARC122C] Calculator

## 题目描述

Snuke有整数$x$和$y$。最初，$x=0，y=0$。

Snuke可以以任何顺序执行以下四种操作任意次: 

- 操作$1$:将$x+1$。 
- 操作$2$:将$y+1$。 
- 操作$3$:将$x+y$。 
- 操作$4$:将$y+x$。

给你一个正整数$N$。最多做$130$次运算，使$x$的值为$N$。在这里，$y$可以有任何值。

我们可以证明，在这个问题的约束下，存在这样一个运算序列。

## 输入格式

一个正整数$N$。

## 输出格式

第一行一个正整数$K$，表示变化的次数。
下面$K$行，每行一个正整数，表示第几种操作。

## 样例 #1

### 输入

```
4
```

### 输出

```
5

1

4

2

3

1
```



---

---
title: "[ARC185E] Adjacent GCD"
layout: "post"
diff: 提高+/省选-
pid: AT_arc185_e
tag: ['数学', '数论', '标签462']
---

# [ARC185E] Adjacent GCD

## 题目描述

定义一个整数序列 $B=(B_1,B_2,\dots,B_k)$ 的分数为 $\sum_{i=1}^{k-1}\gcd(B_i,B_{i+1})$。

给出一个整数序列 $A=(A_1,A_2,\dots,A_N)$，求出以下问题在 $m=1,2,\dots,N$ 时的答案：

- 序列 $A=(A_1,A_2,\dots,A_m)$ 有 $2^m-1$ 个非空子序列。求出这些子序列的分数之和对 $998244353$ 取模后的值。如果两个子序列在原序列中的位置不同，即使它们的元素全部相同，我们也认为它们是不同的。

## 输入格式

输入来自标准输入，格式如下：

> $N$
> $A_1\ A_2\ \dots\ A_N$

## 输出格式

输出 $N$ 行，第 $i$ 行表示当 $m=i$ 时的答案。

### 样例 1 解释

以 $m=3$ 为例。以下是 $(A_1,A_2,A_3)=(9,6,4)$ 的所有非空子序列和分数：

- $(9)$，分数为 $0$。  
- $(6)$，分数为 $0$。  
- $(4)$，分数为 $0$。  
- $(9,6)$，分数为 $\gcd(9,6)=3$。  
- $(9,4)$，分数为 $\gcd(9,4)=1$。
- $(6,4)$，分数为 $\gcd(6,4)=2$。
- $(9,6,4)$，分数为 $\gcd(9,6)+\gcd(6,4)=3+2=5$。

因此当 $m=3$ 时答案为 $0+0+0+3+1+2+5=11$。

## 说明/提示

- $1\le N\le 5\times 10^5$
- $1\le A_i\le 10^5$
- 输入的值全部为整数

## 样例 #1

### 输入

```
3

9 6 4
```

### 输出

```
0

3

11
```

## 样例 #2

### 输入

```
5

3 8 12 6 9
```

### 输出

```
0

1

13

57

155
```

## 样例 #3

### 输入

```
10

47718 21994 74148 76721 98917 73766 29598 59035 69293 29127
```

### 输出

```
0

2

14

35

97

372

866

1859

4273

43287
```



---


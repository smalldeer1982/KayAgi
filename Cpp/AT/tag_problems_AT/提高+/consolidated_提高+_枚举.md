---
title: "[ABC311G] One More Grid Task"
layout: "post"
diff: 提高+/省选-
pid: AT_abc311_g
tag: ['枚举', '单调栈']
---

# [ABC311G] One More Grid Task

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc311/tasks/abc311_g

$ N\ \times\ M $ のグリッドがあり、上から $ i $ 行目、左から $ j $ 列目のマス $ (i,j) $ には非負整数 $ A_{i,j} $ が書かれています。  
 このグリッドのうち長方領域をひとつ選び、それを $ R $ とします。  
 厳密には、長方領域は以下の手順で選ばれます。

- $ 1\ \le\ l_x\ \le\ r_x\ \le\ N,\ 1\ \le\ l_y\ \le\ r_y\ \le\ M $ なる整数 $ l_x,\ r_x,\ l_y,\ r_y $ を選ぶ。
- このとき、整数 $ i,j $ が $ l_x\ \le\ i\ \le\ r_x $ かつ $ l_y\ \le\ j\ \le\ r_y $ を満たす、またその時に限って、マス $ (i,j) $ は $ R $ に含まれる。
 
適切に $ R $ を選ぶことによって、 $ f(R)\ = $ ( $ R $ 内のマスに書かれた整数の総和 ) $ \times $ ( $ R $ 内のマスに書かれた整数の最小値 ) として達成可能な最大値を求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ M $ $ A_{1,1} $ $ A_{1,2} $ $ \dots $ $ A_{1,M} $ $ A_{2,1} $ $ A_{2,2} $ $ \dots $ $ A_{2,M} $ $ \vdots $ $ A_{N,1} $ $ A_{N,2} $ $ \dots $ $ A_{N,M} $

## 输出格式

答えを整数として出力せよ。

## 说明/提示

### 制約

- 入力は全て整数
- $ 1\ \le\ N,M\ \le\ 300 $
- $ 1\ \le\ A_{i,j}\ \le\ 300 $
 
### Sample Explanation 1

左上がマス $ (1,1) $ 、右下がマス $ (2,2) $ の長方領域を選ぶことで、 $ f(R)\ =\ (5+4+4+3)\ \times\ \min(5,4,4,3)\ =\ 48 $ が達成でき、これが達成可能な最大値です。

## 样例 #1

### 输入

```
3 3

5 4 3

4 3 2

3 2 1
```

### 输出

```
48
```

## 样例 #2

### 输入

```
4 5

3 1 4 1 5

9 2 6 5 3

5 8 9 7 9

3 2 3 8 4
```

### 输出

```
231
```

## 样例 #3

### 输入

```
6 6

1 300 300 300 300 300

300 1 300 300 300 300

300 300 1 300 300 300

300 300 300 1 300 300

300 300 300 300 1 300

300 300 300 300 300 1
```

### 输出

```
810000
```



---

---
title: "[ABC312E] Tangency of Cuboids"
layout: "post"
diff: 提高+/省选-
pid: AT_abc312_e
tag: ['枚举']
---

# [ABC312E] Tangency of Cuboids

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc312/tasks/abc312_e

$ 3 $ 次元空間内に $ N $ 個の直方体があります。

直方体同士は重なっていません。厳密には、相異なるどの $ 2 $ つの直方体の共通部分の体積も $ 0 $ です。

$ i $ 番目の直方体は、$ 2 $ 点 $ (X_{i,1},Y_{i,1},Z_{i,1}),\ (X_{i,2},Y_{i,2},Z_{i,2}) $ を結ぶ線分を対角線とし、辺は全ていずれかの座標軸に平行です。

各直方体について、他のいくつの直方体と面で接しているか求めてください。  
 厳密には、各 $ i $ に対し、$ 1\leq\ j\ \leq\ N $ かつ $ j\neq\ i $ である $ j $ のうち、$ i $ 番目の直方体の表面と $ j $ 番目の直方体の表面の共通部分の面積が正であるものの個数を求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ X_{1,1} $ $ Y_{1,1} $ $ Z_{1,1} $ $ X_{1,2} $ $ Y_{1,2} $ $ Z_{1,2} $ $ \vdots $ $ X_{N,1} $ $ Y_{N,1} $ $ Z_{N,1} $ $ X_{N,2} $ $ Y_{N,2} $ $ Z_{N,2} $

## 输出格式

答えを出力せよ。

## 说明/提示

### 制約

- $ 1\ \leq\ N\ \leq\ 10^5 $
- $ 0\ \leq\ X_{i,1}\ <\ X_{i,2}\ \leq\ 100 $
- $ 0\ \leq\ Y_{i,1}\ <\ Y_{i,2}\ \leq\ 100 $
- $ 0\ \leq\ Z_{i,1}\ <\ Z_{i,2}\ \leq\ 100 $
- 直方体同士は体積が正の共通部分を持たない
- 入力は全て整数である
 
### Sample Explanation 1

$ 1 $ 番目の直方体と $ 2 $ 番目の直方体は、$ 2 $ 点 $ (0,0,1),(1,1,1) $ を結ぶ線分を対角線とする長方形を共有しています。 $ 1 $ 番目の直方体と $ 3 $ 番目の直方体は、点 $ (1,1,1) $ を共有していますが、面で接してはいません。

## 样例 #1

### 输入

```
4

0 0 0 1 1 1

0 0 1 1 1 2

1 1 1 2 2 2

3 3 3 4 4 4
```

### 输出

```
1

1

0

0
```

## 样例 #2

### 输入

```
3

0 0 10 10 10 20

3 4 1 15 6 10

0 9 6 1 20 10
```

### 输出

```
2

1

1
```

## 样例 #3

### 输入

```
8

0 0 0 1 1 1

0 0 1 1 1 2

0 1 0 1 2 1

0 1 1 1 2 2

1 0 0 2 1 1

1 0 1 2 1 2

1 1 0 2 2 1

1 1 1 2 2 2
```

### 输出

```
3

3

3

3

3

3

3

3
```



---

---
title: "[ABC315G] Ai + Bj + Ck = X (1 <= i, j, k <= N)"
layout: "post"
diff: 提高+/省选-
pid: AT_abc315_g
tag: ['枚举', '扩展欧几里德算法', '类欧几里得算法']
---

# [ABC315G] Ai + Bj + Ck = X (1 <= i, j, k <= N)

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc315/tasks/abc315_g

整数 $ N,A,B,C,X $ が与えられるので、以下の条件を全て満たす整数組 $ (i,j,k) $ の数を求めてください。

- $ 1\ \le\ i,j,k\ \le\ N $
- $ Ai+Bj+Ck=X $

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ A $ $ B $ $ C $ $ X $

## 输出格式

答えを整数として出力せよ。

## 说明/提示

### 制約

- 入力は全て整数
- $ 1\ \le\ N\ \le\ 10^6 $
- $ 1\ \le\ A,B,C\ \le\ 10^9 $
- $ 1\ \le\ X\ \le\ 3\ \times\ 10^{15} $
 
### Sample Explanation 1

条件を満たす整数組は以下の $ 3 $ つです。 - $ (1,2,2) $ : $ 3\ \times\ 1\ +\ 1\ \times\ 2\ +\ 5\ \times\ 2\ =\ 15 $ - $ (2,4,1) $ : $ 3\ \times\ 2\ +\ 1\ \times\ 4\ +\ 5\ \times\ 1\ =\ 15 $ - $ (3,1,1) $ : $ 3\ \times\ 3\ +\ 1\ \times\ 1\ +\ 5\ \times\ 1\ =\ 15 $

## 样例 #1

### 输入

```
5 3 1 5 15
```

### 输出

```
3
```

## 样例 #2

### 输入

```
1 1 1 1 1
```

### 输出

```
0
```

## 样例 #3

### 输入

```
100000 31415 92653 58979 1000000000
```

### 输出

```
2896
```



---

---
title: "[ABC318F] Octopus"
layout: "post"
diff: 提高+/省选-
pid: AT_abc318_f
tag: ['贪心', '枚举']
---

# [ABC318F] Octopus

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc318/tasks/abc318_f

数直線上に $ 1 $ 体のタコ型ロボットと $ N $ 個の宝があります。 $ i $ $ (1\leq\ i\leq\ N) $ 個目の宝はそれぞれ座標 $ X_i $ にあります。  
 タコ型ロボットは $ 1 $ つの頭と $ N $ 本の足を持っており、$ i $ 本目の足の長さは $ L_i $ $ (1\leq\ i\leq\ N) $ です。

タコ型ロボットが次のようにして $ N $ 個の宝すべてを掴む事ができるような**整数** $ k $ の個数を求めてください。

- 頭を座標 $ k $ におく。
- $ i=1,2,\ldots,N $ の順に、「頭から距離 $ L_i $ 以下の範囲、すなわち $ k-L_i\leq\ x\leq\ k+L_i $ をみたす座標 $ x $ にまだ掴んでいない宝が存在する場合、そのうちの $ 1 $ つを選んで掴む」ことを繰り返す。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ X_1 $ $ X_2 $ $ \ldots $ $ X_N $ $ L_1 $ $ L_2 $ $ \ldots $ $ L_N $

## 输出格式

問題文の条件をみたす整数 $ k $ の個数を出力せよ。

## 说明/提示

### 制約

- $ 1\ \leq\ N\leq\ 200 $
- $ -10^{18}\ \leq\ X_1\ <\ X_2\ <\ \cdots\ <\ X_N\leq\ 10^{18} $
- $ 1\leq\ L_1\leq\ L_2\leq\cdots\leq\ L_N\leq\ 10^{18} $
- 入力はすべて整数
 
### Sample Explanation 1

$ k=-3,-2,-1,2,3,4 $ が条件をみたします。例えば、$ k=-3 $ のときは、次のようにして $ 3 $ 個の宝をすべて掴む事ができます。 - $ 1 $ 本目の足は $ -6\leq\ x\leq\ 0 $ にある宝を掴む事ができる。このうち座標 $ -6 $ にある $ 1 $ 個目の宝を掴む。 - $ 2 $ 本目の足は $ -8\leq\ x\leq\ 2 $ にある宝を掴む事ができる。このうち座標 $ 0 $ にある $ 2 $ 個目の宝を掴む。 - $ 3 $ 本目の足は $ -13\leq\ x\leq\ 7 $ にある宝を掴む事ができる。このうち座標 $ 7 $ にある $ 3 $ 個目の宝を掴む。

### Sample Explanation 2

$ -10^{18} $ 以上 $ 10^{18} $ 以下のすべての整数が $ k $ として条件をみたします。

### Sample Explanation 3

条件をみたす $ k $ は存在しません。

## 样例 #1

### 输入

```
3

-6 0 7

3 5 10
```

### 输出

```
6
```

## 样例 #2

### 输入

```
1

0

1000000000000000000
```

### 输出

```
2000000000000000001
```

## 样例 #3

### 输入

```
2

-100 100

1 1
```

### 输出

```
0
```



---

---
title: "[AGC018B] Sports Festival"
layout: "post"
diff: 提高+/省选-
pid: AT_agc018_b
tag: ['贪心', '枚举', '概率论']
---

# [AGC018B] Sports Festival

## 题目描述

[problemUrl]: https://atcoder.jp/contests/agc018/tasks/agc018_b

高橋君は、スポーツ大会を開こうと考えています。 スポーツ大会に参加するのは、$ 1 $ から $ N $ までの番号のついた $ N $ 人の人です。 また、大会で行うスポーツとして、$ 1 $ から $ M $ までの番号のついた $ M $ 個のスポーツが候補に上がっています。 高橋君は、これらの中から $ 1 $ つ以上（全てでもよい）のスポーツを選んで、スポーツ大会で実施します。

高橋君は、人 $ i $ が、$ j $ 番目に好きなスポーツが $ A_{ij} $ であることを知っています。 それぞれの人は、スポーツ大会で実施されるスポーツのうち、自分が最も好きなスポーツだけに参加し、他のスポーツには参加しません。

高橋君は、一つのスポーツにたくさんの人が集まり過ぎることを懸念しています。 そこで高橋君は、スポーツ大会で実施するスポーツをうまく選んで、最も多くの人が参加しているスポーツの参加人数を最小化したくなりました。 最も多くの人が参加しているスポーツの参加人数の最小値を求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ M $ $ A_{11} $ $ A_{12} $ $ ... $ $ A_{1M} $ $ A_{21} $ $ A_{22} $ $ ... $ $ A_{2M} $ $ : $ $ A_{N1} $ $ A_{N2} $ $ ... $ $ A_{NM} $

## 输出格式

最も多くの人が参加しているスポーツの参加人数の最小値を出力せよ。

## 说明/提示

### 制約

- $ 1\ \leq\ N\ \leq\ 300 $
- $ 1\ \leq\ M\ \leq\ 300 $
- $ A_{i1} $ , $ A_{i2} $ , $ ... $ , $ A_{iM} $ は、$ 1 $ から $ M $ の順列である。

### Sample Explanation 1

スポーツ $ 1 $,$ 3 $,$ 4 $ を実施することにすると、人 $ 1 $ はスポーツ $ 1 $ に、人 $ 2 $ はスポーツ $ 3 $ に、 人 $ 3 $ はスポーツ $ 3 $ に、人 $ 4 $ はスポーツ $ 4 $ に参加します。 このとき、参加人数が最大のスポーツはスポーツ $ 3 $ で、その参加人数 $ 2 $ 人です。 また、参加人数が最大のスポーツの参加人数が $ 1 $ 人になるような方法は存在しないので、この例の答えは $ 2 $ になります。

### Sample Explanation 2

全員の好みが一致しているので、どうやっても一つのスポーツに $ 3 $ 人集まってしまいます。 よってこの例の答えは $ 3 $ です。

## 样例 #1

### 输入

```
4 5

5 1 3 4 2

2 5 3 1 4

2 3 1 4 5

2 5 4 3 1
```

### 输出

```
2
```

## 样例 #2

### 输入

```
3 3

2 1 3

2 1 3

2 1 3
```

### 输出

```
3
```



---

---
title: "[ABC044D] 桁和"
layout: "post"
diff: 提高+/省选-
pid: AT_arc060_b
tag: ['数学', '枚举', '进制']
---

# [ABC044D] 桁和

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc044/tasks/arc060_b

$ 2 $ 以上の整数 $ b $ および $ 1 $ 以上の整数 $ n $ に対し、関数 $ f(b,n) $ を次のように定義します。

- $ n\ <\ b $ のとき $ f(b,n)\ =\ n $
- $ n\ \geq\ b $ のとき $ f(b,n)\ =\ f(b,\,{\rm\ floor}(n\ /\ b))\ +\ (n\ {\rm\ mod}\ b) $

ここで、$ {\rm\ floor}(n\ /\ b) $ は $ n\ /\ b $ を超えない最大の整数を、 $ n\ {\rm\ mod}\ b $ は $ n $ を $ b $ で割った余りを表します。

直感的に言えば、$ f(b,n) $ は、$ n $ を $ b $ 進表記したときの各桁の和となります。 例えば、

- $ f(10,\,87654)=8+7+6+5+4=30 $
- $ f(100,\,87654)=8+76+54=138 $

などとなります。

整数 $ n $ と $ s $ が与えられます。 $ f(b,n)=s $ を満たすような $ 2 $ 以上の整数 $ b $ が存在するか判定してください。 さらに、そのような $ b $ が存在するならば、その最小値を求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ n $ $ s $

## 输出格式

$ f(b,n)=s $ を満たす $ 2 $ 以上の整数 $ b $ が存在するならば、そのような $ b $ の最小値を出力せよ。 そのような $ b $ が存在しないならば、代わりに `-1` を出力せよ。

## 说明/提示

### 制約

- $ 1\ \leq\ n\ \leq\ 10^{11} $
- $ 1\ \leq\ s\ \leq\ 10^{11} $
- $ n,\,s $ はいずれも整数である

## 样例 #1

### 输入

```
87654

30
```

### 输出

```
10
```

## 样例 #2

### 输入

```
87654

138
```

### 输出

```
100
```

## 样例 #3

### 输入

```
87654

45678
```

### 输出

```
-1
```

## 样例 #4

### 输入

```
31415926535

1
```

### 输出

```
31415926535
```

## 样例 #5

### 输入

```
1

31415926535
```

### 输出

```
-1
```



---

---
title: "[ARC168C] Swap Characters"
layout: "post"
diff: 提高+/省选-
pid: AT_arc168_c
tag: ['枚举', '组合数学']
---

# [ARC168C] Swap Characters

## 题目描述

[problemUrl]: https://atcoder.jp/contests/arc168/tasks/arc168_c

`A`, `B`, `C` からなる長さ $ N $ の文字列 $ S $ が与えられます．

以下の操作を $ 0 $ 回以上 $ K $ 回以下行うことを考えます．

- $ S $ 内の $ 2 $ 文字を自由に選び，入れ替える．
 
操作後の $ S $ としてあり得る文字列が何通りあるかを $ 998244353 $ で割ったあまりを求めてください．

## 输入格式

入力は以下の形式で標準入力から与えられる．

> $ N $ $ K $ $ S $

## 输出格式

答えを出力せよ．

## 说明/提示

### 制約

- $ 1\ \leq\ N\ \leq\ 250000 $
- $ 1\ \leq\ K\ \leq\ 100 $
- $ S $ は `A`, `B`, `C` からなる長さ $ N $ の文字列．
- 入力される値はすべて整数．
 
### Sample Explanation 1

以下のように $ 4 $ 通りの文字列が得られます． - $ S= $`ABC` : $ 0 $ 回の操作を行えばよい． - $ S= $`BAC` : $ 1,2 $ 文字目を入れ替える操作を行えばよい． - $ S= $`CBA` : $ 1,3 $ 文字目を入れ替える操作を行えばよい． - $ S= $`ACB` : $ 2,3 $ 文字目を入れ替える操作を行えばよい．

## 样例 #1

### 输入

```
3 1

ABC
```

### 输出

```
4
```

## 样例 #2

### 输入

```
3 2

ABC
```

### 输出

```
6
```

## 样例 #3

### 输入

```
4 5

AAAA
```

### 输出

```
1
```

## 样例 #4

### 输入

```
30 10

CACCABAABBABABBCBBCAAACAAACCCA
```

### 输出

```
42981885
```



---

---
title: "愉快なロゴデザイン"
layout: "post"
diff: 提高+/省选-
pid: AT_joisc2015_b
tag: ['字符串', '2015', '枚举', 'JOI（日本）']
---

# 愉快なロゴデザイン

## 题目描述

[problemUrl]: https://atcoder.jp/contests/joisc2015/tasks/joisc2015_b





---


---
title: "[ABC360G] Suitable Edit for LIS"
layout: "post"
diff: 提高+/省选-
pid: AT_abc360_g
tag: ['动态规划 DP', '树状数组']
---

# [ABC360G] Suitable Edit for LIS

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc360/tasks/abc360_g

長さ $ N $ の整数列 $ A $ が与えられます。高橋くんは、 $ 1 $ 回だけ次の操作をします。

- $ 1 $ 以上 $ N $ 以下の整数 $ x $ と、任意の整数 $ y $ を選ぶ。$ A_x $ を $ y $ に置き換える。
 
操作をした後の $ A $ の最長増加部分列の長さとしてあり得る最大の値を求めてください。

  最長増加部分列とは？ 列 $ A $ の部分列とは $ A $ の要素をいくつか抜き出して元の順に並べてできる列を指します。

 列 $ A $ の最長増加部分列とは、 $ A $ の狭義単調増加な部分列のうち列の長さが最大のものを指します。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ A_1 $ $ A_2 $ $ \cdots $ $ A_N $

## 输出格式

答えを $ 1 $ 行に出力せよ。

## 说明/提示

### 制約

- $ 1\ \leq\ N\ \leq\ 2\ \times\ 10^5 $
- $ 1\ \leq\ A_i\ \leq\ 10^9 $
 
### Sample Explanation 1

与えられた数列 $ A $ の LIS の長さは $ 2 $ です。例えば $ A_1 $ を $ 1 $ に置き換えると、操作後の $ A $ の LIS の長さが $ 3 $ になり、これが最大です。

## 样例 #1

### 输入

```
4

3 2 2 4
```

### 输出

```
3
```

## 样例 #2

### 输入

```
5

4 5 3 6 7
```

### 输出

```
4
```



---

---
title: "[ABC380G] Another Shuffle Window"
layout: "post"
diff: 提高+/省选-
pid: AT_abc380_g
tag: ['树状数组', '概率论', '期望']
---

# [ABC380G] Another Shuffle Window

## 题目描述

[问题链接](https://atcoder.jp/contests/abc380/tasks/abc380_g)

给定一个排列 $P = (1, 2, \dots, N)$ 和一个整数 $K$。

请计算经过以下操作后，排列 $P$ 的**逆序对数**的期望值模 $998244353$ 的结果：

- 首先，从 $1$ 到 $N-K+1$ 的整数中随机均匀地选择一个整数 $i$；
- 然后，将子数组 $P_i, P_{i+1}, \dots, P_{i+K-1}$ 进行随机均匀打乱。



#### 逆序对是什么？

>  对于一个数组 $(A_1, A_2, \dots, A_N)$，逆序对是满足 $1 \leq i < j \leq N$ 且 $A_i > A_j$ 的整数对 $(i, j)$ 的个数。

#### 期望值模 $998244353$ 是什么？

> 在本问题的约束条件下，期望值可以表示为一个分数 $\frac{P}{Q}$，且 $Q \not \equiv 0 \pmod{998244353}$。  
> 因此可以找到一个唯一的整数 $R$ 满足：
> $$
> R \times Q \equiv P \pmod{998244353}, \quad 0 \leq R < 998244353
> $$
> 你需要输出这个整数 $R$。

## 输入格式

从标准输入流读入，格式如下：
$$
N\ K\ P_1\ P_2\ \dots\ P_N
$$

## 输出格式

输出在标准输出流，在一行中输出答案。

## 说明/提示

#### 约束条件

- 所有输入均为整数；
- $1 \leq K \leq N \leq 2 \times 10^5$；
- $P$ 是 $(1, 2, \dots, N)$ 的一个排列。

#### 样例解释 1

通过操作，排列 $P$ 会变为以下形式：

- $(1, 4, 2, 3)$ —— 概率 $\frac{1}{2}$；
- $(4, 1, 2, 3)$ —— 概率 $\frac{1}{6}$；
- $(1, 2, 4, 3)$ —— 概率 $\frac{1}{6}$；
- $(1, 4, 3, 2)$ —— 概率 $\frac{1}{6}$。

对应的逆序对数期望值为：
$$
\displaystyle 2 \times \frac{1}{2} + 3 \times \frac{1}{6} + 1 \times \frac{1}{6} + 3 \times \frac{1}{6} = \frac{13}{6}
$$

将 $\frac{13}{6}$ 转换为模 $998244353$ 的结果为 $166374061$，因此输出 $166374061$。

Translated By [$\mathtt{Mr\_Az}$](/user/536560)。

## 样例 #1

### 输入

```
4 2

1 4 2 3
```

### 输出

```
166374061
```

## 样例 #2

### 输入

```
1 1

1
```

### 输出

```
0
```

## 样例 #3

### 输入

```
10 6

7 4 10 5 6 1 8 2 3 9
```

### 输出

```
499122200
```



---

---
title: "[ABC410G] Longest Chord Chain"
layout: "post"
diff: 提高+/省选-
pid: AT_abc410_g
tag: ['动态规划 DP', '线段树', '树状数组']
---

# [ABC410G] Longest Chord Chain

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc410/tasks/abc410_g

円周上に $ 1 $ から $ 2N $ の番号がついた相異なる $ 2N $ 個の点があり、点 $ 1 $ から時計回りに順に点 $ 2 $、点 $ 3 $、…、点 $ 2N $ と並んでいます。

この円の弦が $ N $ 個与えられます。$ i $ 番目の弦の端点は点 $ A_i $ と点 $ B_i $ であり、$ 2N $ 個の値 $ A_1,\ldots,A_N,B_1,\ldots,B_N $ は相異なります。

この円に対し以下の操作を一度ずつ順に行います。

1. 円の $ N $ 本の弦のうち、互いに交わらないように弦を好きな個数選び、残りの弦を削除する。
2. 円に自由に弦を $ 1 $ つ追加する。

適切に操作を行ったとき、操作を終えた後の弦同士の交点の個数として考えられる最大値を求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ A_1 $ $ B_1 $ $ A_2 $ $ B_2 $ $ \vdots $ $ A_N $ $ B_N $

## 输出格式

答えを出力せよ。

## 说明/提示

### 制約

- $ 1\ \leq\ N\ \leq\ 2\times\ 10^5 $
- $ 1\ \leq\ A_i,B_i\ \leq\ 2N $
- $ 2N $ 個の値 $ A_1,\ \ldots,\ A_N,B_1,\ldots,B_N $ は相異なる
- 入力は全て整数である

### Sample Explanation 1

最初、円には弦が $ 3 $ 本あり、図のようになっています。 操作により点 $ 3 $ と点 $ 6 $ を結ぶ弦を削除し、新たな弦を追加することで、弦同士の交点の個数は $ 2 $ 個となります。 !\[図\](https://img.atcoder.jp/abc410/be5d090022ebeba5ad0aeea63ef1c38b.png) 弦同士の交点の個数を $ 3 $ 個以上にすることはできないため、答えは $ 2 $ となります。 最後に追加する弦の端点は、点 $ 1,\ldots,\ 2N $ のいずれかである必要はありません。

## 样例 #1

### 输入

```
3
1 5
6 3
4 2
```

### 输出

```
2
```

## 样例 #2

### 输入

```
4
1 8
2 7
3 6
4 5
```

### 输出

```
4
```

## 样例 #3

### 输入

```
3
1 2
3 4
5 6
```

### 输出

```
2
```



---


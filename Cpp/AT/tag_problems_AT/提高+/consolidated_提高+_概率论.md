---
title: "[ABC268G] Random Student ID"
layout: "post"
diff: 提高+/省选-
pid: AT_abc268_g
tag: ['组合数学', '概率论', '字典树 Trie']
---

# [ABC268G] Random Student ID

## 题目描述

**题目大意**

有 $n$ 个学生，第 $i$ 个学生的名字是一个字符串 $S_i$，编号是 $i$。

接下来校长要按照一种绝妙的字典序来对这 $n$ 个学生的名字排序。他随机选取一个 $\tt{a}\sim\tt{z}$ 的排列，定为 $P$。$P$ 中越早出现的字母，他的字典序就越小。

对于每一个学生，求出他的期望排名，对 $998244353$ 取模。

## 输入格式

第一行一个整数 $n$。

接下来 $n$ 行每行一个字符串 $S_i$。

## 输出格式

输出 $n$ 行，第 $i$ 行表示编号为 $i$ 的学生的期望排名。

## 说明/提示

对于所有数据，我们保证 $S_i$ 只由小写字母组成，并且这些学生的名字互不相同。$n\geqslant 2$，字符串总长度不超过 $5\times 10^5$。

## 样例 #1

### 输入

```
3

a

aa

ab
```

### 输出

```
1

499122179

499122179
```

## 样例 #2

### 输入

```
3

a

aa

aaa
```

### 输出

```
1

2

3
```



---

---
title: "[ABC271G] Access Counter"
layout: "post"
diff: 提高+/省选-
pid: AT_abc271_g
tag: ['矩阵加速', '概率论']
---

# [ABC271G] Access Counter

## 题目描述

【题目翻译】

给定 $24$ 个时间点，每个时间点有可能有两种指令

如果指令是 `T`，则高桥有 $x\%$ 的概率登录洛谷。

如果指令是 `A`，则青木有 $y\%$ 的概率登录洛谷。

操作是依次进行的。求洛谷第 $n$ 次被登录是由青木操作的概率。

答案对 $998244353$ 取模。

## 输入格式

第一行三个数 $n,x,y$。

接下来有 24 个操作，每个操作只会有 `T` 或 `A`。

## 输出格式

求洛谷第 $n$ 次被登录是由青木操作的概率。

Translated by @cc0000

## 样例 #1

### 输入

```
1 50 50

ATATATATATATATATATATATAT
```

### 输出

```
665496236
```

## 样例 #2

### 输入

```
271 95 1

TTTTTTTTTTTTTTTTTTTTTTTT
```

### 输出

```
0
```

## 样例 #3

### 输入

```
10000000000000000 62 20

ATAATTATATTTAAAATATTATAT
```

### 输出

```
744124544
```



---

---
title: "[ABC342F] Black Jack"
layout: "post"
diff: 提高+/省选-
pid: AT_abc342_f
tag: ['动态规划 DP', '线段树', '概率论']
---

# [ABC342F] Black Jack

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc342/tasks/abc342_f

あなたとディーラーでゲームをします。 ゲームは $ 1 $ 以上 $ D $ 以下の整数が等確率で出る $ D $ 面サイコロ、$ 0 $ で初期化された変数 $ x,y $ を用いて以下のように行われます。

- あなたはサイコロを振り、出た目を $ x $ に加算する操作を好きな回数行える。ここで、あなたは操作を行うたびに次の操作を行うかを選択できる。
- その後、ディーラーは $ y\ <\ L $ を満たす限り、サイコロを振り、出た目を $ y $ に加算する操作を繰り返す。
- $ x\ >\ N $ の場合あなたの負けである。そうでない場合、$ y\ >\ N $ または $ x\ >\ y $ のいずれかを満たす場合あなたの勝ちで、どちらも満たさない場合あなたの負けである。
 
あなたが勝率を最大化するように適切に行動する際、勝率を求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ L $ $ D $

## 输出格式

答えを出力せよ。出力した値の真の値との絶対誤差または相対誤差が $ 10^{-6} $ 以下のとき正解と判定される。

## 说明/提示

### 制約

- 入力は全て整数
- $ 1\leq\ L\leq\ N\leq\ 2\times\ 10^5 $
- $ 1\leq\ D\ \leq\ N $
 
### Sample Explanation 1

$ x $ が $ 2 $ 以下の場合操作を続けるという戦略が最適であることが証明できます。

## 样例 #1

### 输入

```
3 2 2
```

### 输出

```
0.468750000000000
```

## 样例 #2

### 输入

```
200000 200000 200000
```

### 输出

```
0.999986408692793
```



---

---
title: "[ABC380G] Another Shuffle Window"
layout: "post"
diff: 提高+/省选-
pid: AT_abc380_g
tag: ['树状数组', '概率论', '期望']
---

# [ABC380G] Another Shuffle Window

## 题目描述

[问题链接](https://atcoder.jp/contests/abc380/tasks/abc380_g)

给定一个排列 $P = (1, 2, \dots, N)$ 和一个整数 $K$。

请计算经过以下操作后，排列 $P$ 的**逆序对数**的期望值模 $998244353$ 的结果：

- 首先，从 $1$ 到 $N-K+1$ 的整数中随机均匀地选择一个整数 $i$；
- 然后，将子数组 $P_i, P_{i+1}, \dots, P_{i+K-1}$ 进行随机均匀打乱。



#### 逆序对是什么？

>  对于一个数组 $(A_1, A_2, \dots, A_N)$，逆序对是满足 $1 \leq i < j \leq N$ 且 $A_i > A_j$ 的整数对 $(i, j)$ 的个数。

#### 期望值模 $998244353$ 是什么？

> 在本问题的约束条件下，期望值可以表示为一个分数 $\frac{P}{Q}$，且 $Q \not \equiv 0 \pmod{998244353}$。  
> 因此可以找到一个唯一的整数 $R$ 满足：
> $$
> R \times Q \equiv P \pmod{998244353}, \quad 0 \leq R < 998244353
> $$
> 你需要输出这个整数 $R$。

## 输入格式

从标准输入流读入，格式如下：
$$
N\ K\ P_1\ P_2\ \dots\ P_N
$$

## 输出格式

输出在标准输出流，在一行中输出答案。

## 说明/提示

#### 约束条件

- 所有输入均为整数；
- $1 \leq K \leq N \leq 2 \times 10^5$；
- $P$ 是 $(1, 2, \dots, N)$ 的一个排列。

#### 样例解释 1

通过操作，排列 $P$ 会变为以下形式：

- $(1, 4, 2, 3)$ —— 概率 $\frac{1}{2}$；
- $(4, 1, 2, 3)$ —— 概率 $\frac{1}{6}$；
- $(1, 2, 4, 3)$ —— 概率 $\frac{1}{6}$；
- $(1, 4, 3, 2)$ —— 概率 $\frac{1}{6}$。

对应的逆序对数期望值为：
$$
\displaystyle 2 \times \frac{1}{2} + 3 \times \frac{1}{6} + 1 \times \frac{1}{6} + 3 \times \frac{1}{6} = \frac{13}{6}
$$

将 $\frac{13}{6}$ 转换为模 $998244353$ 的结果为 $166374061$，因此输出 $166374061$。

Translated By [$\mathtt{Mr\_Az}$](/user/536560)。

## 样例 #1

### 输入

```
4 2

1 4 2 3
```

### 输出

```
166374061
```

## 样例 #2

### 输入

```
1 1

1
```

### 输出

```
0
```

## 样例 #3

### 输入

```
10 6

7 4 10 5 6 1 8 2 3 9
```

### 输出

```
499122200
```



---

---
title: "[ABC382E] Expansion Packs"
layout: "post"
diff: 提高+/省选-
pid: AT_abc382_e
tag: ['动态规划 DP', '概率论', '期望']
---

# [ABC382E] Expansion Packs

## 题目描述

给定无数包卡牌，每一包卡牌有 $N$ 张卡，对于每一张卡 $i$，有百分之 $P_i$ 的概率是稀有卡，否则是普通卡。现在，你要一直开包，直到你有 $X$ 张稀有卡，求你开包的期望次数。

## 输入格式

共两行，第一行两个整数，$N \space X$。

第二行 $N$ 个整数，$P_1 \space P_2 \dots P_N$。

## 输出格式

一个实数，表示答案。

与标准答案相对误差在 $10^{-6}$ 以内的答案将视为正确。

## 说明/提示

- $1 \le N \le 5000$

- $1 \le X \le 5000$

- $1 \le P_i \le 100$


UID：928955

## 样例 #1

### 输入

```
2 2

50 100
```

### 输出

```
1.5000000000000000
```

## 样例 #2

### 输入

```
2 3

40 60
```

### 输出

```
3.2475579530543811
```

## 样例 #3

### 输入

```
6 3

10 33 33 10 100 10
```

### 输出

```
1.8657859189536100
```



---

---
title: "[AGC018B] Sports Festival"
layout: "post"
diff: 提高+/省选-
pid: AT_agc018_b
tag: ['贪心', '枚举', '概率论']
---

# [AGC018B] Sports Festival

## 题目描述

[problemUrl]: https://atcoder.jp/contests/agc018/tasks/agc018_b

高橋君は、スポーツ大会を開こうと考えています。 スポーツ大会に参加するのは、$ 1 $ から $ N $ までの番号のついた $ N $ 人の人です。 また、大会で行うスポーツとして、$ 1 $ から $ M $ までの番号のついた $ M $ 個のスポーツが候補に上がっています。 高橋君は、これらの中から $ 1 $ つ以上（全てでもよい）のスポーツを選んで、スポーツ大会で実施します。

高橋君は、人 $ i $ が、$ j $ 番目に好きなスポーツが $ A_{ij} $ であることを知っています。 それぞれの人は、スポーツ大会で実施されるスポーツのうち、自分が最も好きなスポーツだけに参加し、他のスポーツには参加しません。

高橋君は、一つのスポーツにたくさんの人が集まり過ぎることを懸念しています。 そこで高橋君は、スポーツ大会で実施するスポーツをうまく選んで、最も多くの人が参加しているスポーツの参加人数を最小化したくなりました。 最も多くの人が参加しているスポーツの参加人数の最小値を求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ M $ $ A_{11} $ $ A_{12} $ $ ... $ $ A_{1M} $ $ A_{21} $ $ A_{22} $ $ ... $ $ A_{2M} $ $ : $ $ A_{N1} $ $ A_{N2} $ $ ... $ $ A_{NM} $

## 输出格式

最も多くの人が参加しているスポーツの参加人数の最小値を出力せよ。

## 说明/提示

### 制約

- $ 1\ \leq\ N\ \leq\ 300 $
- $ 1\ \leq\ M\ \leq\ 300 $
- $ A_{i1} $ , $ A_{i2} $ , $ ... $ , $ A_{iM} $ は、$ 1 $ から $ M $ の順列である。

### Sample Explanation 1

スポーツ $ 1 $,$ 3 $,$ 4 $ を実施することにすると、人 $ 1 $ はスポーツ $ 1 $ に、人 $ 2 $ はスポーツ $ 3 $ に、 人 $ 3 $ はスポーツ $ 3 $ に、人 $ 4 $ はスポーツ $ 4 $ に参加します。 このとき、参加人数が最大のスポーツはスポーツ $ 3 $ で、その参加人数 $ 2 $ 人です。 また、参加人数が最大のスポーツの参加人数が $ 1 $ 人になるような方法は存在しないので、この例の答えは $ 2 $ になります。

### Sample Explanation 2

全員の好みが一致しているので、どうやっても一つのスポーツに $ 3 $ 人集まってしまいます。 よってこの例の答えは $ 3 $ です。

## 样例 #1

### 输入

```
4 5

5 1 3 4 2

2 5 3 1 4

2 3 1 4 5

2 5 4 3 1
```

### 输出

```
2
```

## 样例 #2

### 输入

```
3 3

2 1 3

2 1 3

2 1 3
```

### 输出

```
3
```



---

---
title: "[AGC049A] Erasing Vertices"
layout: "post"
diff: 提高+/省选-
pid: AT_agc049_a
tag: ['概率论', '期望']
---

# [AGC049A] Erasing Vertices

## 题目描述

[problemUrl]: https://atcoder.jp/contests/agc049/tasks/agc049_a

$ 1 $ から $ N $ までの番号のついた $ N $ 頂点からなる有向グラフがあります． このグラフの辺は，$ N $ 個の長さ $ N $ の文字列 $ S_1,S_2,\ldots,S_N $ によって表されます． 具体的には，頂点 $ i $ から頂点 $ j $ に向かう辺が存在する場合は $ S_{i,j}= $`1` で， そうでない場合は $ S_{i,j}= $`0` です． このグラフに自己ループや多重辺はありません．

クマの AtCobear くんが，以下の操作をグラフが空になるまで繰り返します．

- (まだ削除されていない) グラフの頂点を一様ランダムに $ 1 $ つ選ぶ（このランダムな選択は，今までの選択とは独立である）． そして，その頂点，およびその頂点からいくつかの辺をたどることで到達可能なすべての頂点を，削除する． 削除された頂点に接続する辺も，すべて削除される．

操作回数の期待値を求めてください．

## 输入格式

入力は以下の形式で標準入力から与えられる．

> $ N $ $ S_1 $ $ S_2 $ $ \vdots $ $ S_N $

## 输出格式

操作回数の期待値を出力せよ． 絶対誤差または相対誤差が $ 10^{-9} $ 以下ならば，正解と判定される．

## 说明/提示

### 制約

- $ 1\ \leq\ N\ \leq\ 100 $
- $ S_i $ は `0`,`1` からなる長さ $ N $ の文字列．
- $ S_{i,i}= $`0`

### Sample Explanation 1

以下の $ 3 $ つのシナリオが等確率で起こります． - 最初の操作で頂点 $ 1 $ を選び，頂点 $ 1,2,3 $ が削除される． グラフが空になったので操作を終了する． - 最初の操作で頂点 $ 2 $ を選び，頂点 $ 2,3 $ が削除される． 次の操作で，頂点 $ 1 $ を選び，頂点 $ 1 $ が削除される． グラフが空になったので操作を終了する． - 最初の操作で頂点 $ 3 $ を選び，頂点 $ 2,3 $ が削除される． 次の操作で，頂点 $ 1 $ を選び，頂点 $ 1 $ が削除される． グラフが空になったので操作を終了する． よって操作回数の期待値は，$ (1+2+2)/3=5/3 $ になります．

### Sample Explanation 2

必ず $ 3 $ 回の操作を行います．

### Sample Explanation 3

必ず $ 1 $ 回の操作を行います．

## 样例 #1

### 输入

```
3

010

001

010
```

### 输出

```
1.66666666666666666667
```

## 样例 #2

### 输入

```
3

000

000

000
```

### 输出

```
3.00000000000000000000
```

## 样例 #3

### 输入

```
3

011

101

110
```

### 输出

```
1.00000000000000000000
```



---

---
title: "ボール"
layout: "post"
diff: 提高+/省选-
pid: AT_tdpc_ball
tag: ['动态规划 DP', '状态合并', '概率论']
---

# ボール

## 题目描述

[problemUrl]: https://atcoder.jp/contests/tdpc/tasks/tdpc_ball

入力は以下の形式で標準入力から与えられる。

> $ N $ $ x_1\ ...\ x_N $

 答えを一行に出力せよ。絶対誤差が $ 10^{-6} $ 以下のとき正当と判定される。 ```

2
0 2
```

```

4.500000000
```

```

5
1 3 4 2 5
```

```

8.986111111
```

## 说明/提示

### Constraints

 $ N $ 個のものがある。$ i $ 番目のものは座標 $ x_i $ におかれている。すぬけ君が、座標 $ x $ の点を目指してボールを投げると $ x-1,\ x,\ x+1 $ のうちのいずれかに 1/3 ずつの確率で飛んでいき、そこに物がおいてあった場合は倒れる。最適な戦略でボールを投げたとき、すべての物を倒すのに必要なボールを投げる回数の期待値を求めよ。   
 追記 : **ボールを投げる場所は、前に投げたボールの飛んだ場所を見た後に決めることができる。**

- - - - - -

- $ 1\ <\ =\ N\ <\ =\ 16 $
- $ 0\ <\ =\ x_i\ <\ =\ 15 $
- $ x_i $ are pairwise distinct.



---


---
title: "[ABC345F] Many Lamps"
layout: "post"
diff: 提高+/省选-
pid: AT_abc345_f
tag: ['生成树']
---

# [ABC345F] Many Lamps

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc345/tasks/abc345_f

頂点に $ 1 $ から $ N $ の、辺に $ 1 $ から $ M $ の番号がついた $ N $ 頂点 $ M $ 辺の単純グラフがあります。辺 $ i $ は頂点 $ u_i $ と頂点 $ v_i $ を結んでいます。  
 各頂点にはランプが $ 1 $ 個ずつ載っています。はじめ、全てのランプは消えています。

以下の操作を $ 0 $ 回以上 $ M $ 回以下行うことで、ランプがちょうど $ K $ 個ついた状態にできるかどうかを判定してください。

- 辺を $ 1 $ 本選ぶ。辺の両端点を $ u $, $ v $ とする。$ u,\ v $ に載っているランプの状態を反転させる。つまり、ランプがついていたら消して、消えていたらつける。
 
また、ちょうど $ K $ 個のランプがついた状態にすることが可能な場合は、そのような操作の手順を出力してください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ M $ $ K $ $ u_1 $ $ v_1 $ $ u_2 $ $ v_2 $ $ \vdots $ $ u_M $ $ v_M $

## 输出格式

ちょうど $ K $ 個のランプがついた状態にすることが不可能な場合は `No` を出力せよ。  
 可能な場合はまず `Yes` を出力して、その後に操作の手順を以下の形式で出力せよ。

> $ X $ $ e_1 $ $ e_2 $ $ \dots $ $ e_X $

ここで、$ X $ は操作回数を、$ e_i $ は $ i $ 番目の操作で選ぶ辺の番号を意味する。これらは次を満たす必要がある。

- $ 0\ \leq\ X\ \leq\ M $
- $ 1\ \leq\ e_i\ \leq\ M $
 
条件を満たす操作の手順が複数ある場合は、どれを出力しても正解とみなされる。

## 说明/提示

### 制約

- $ 1\ \leq\ N\ \leq\ 2\ \times\ 10^5 $
- $ 0\ \leq\ M\ \leq\ \min\left(\ 2\ \times\ 10^5,\ \frac{N(N-1)}{2}\ \right) $
- $ 0\ \leq\ K\ \leq\ N $
- $ 1\ \leq\ u_i\ \lt\ v_i\ \leq\ N $
- 入力で与えられるグラフは単純
- 入力される値は全て整数
 
### Sample Explanation 1

出力例に従って操作を行うと次のようになります。 - 辺 $ 3 $ を選ぶ。頂点 $ 2 $ と頂点 $ 4 $ に載っているランプをつける。 - 辺 $ 4 $ を選ぶ。頂点 $ 3 $ と頂点 $ 5 $ に載っているランプをつける。 - 辺 $ 5 $ を選ぶ。頂点 $ 1 $ に載っているランプをつけて、頂点 $ 5 $ に載っているランプを消す。 操作を全て終了した時点で頂点 $ 1,2,3,4 $ に載っているランプがついています。よってこの操作の手順は条件を満たしています。 条件を満たす操作の手順としては他に $ X\ =\ 4,\ (e_1,e_2,e_3,e_4)\ =\ (3,4,3,1) $ などが挙げられます。(同じ辺を $ 2 $ 回以上選んでもよいです。)

## 样例 #1

### 输入

```
5 5 4

1 2

1 3

2 4

3 5

1 5
```

### 输出

```
Yes

3

3 4 5
```

## 样例 #2

### 输入

```
5 5 5

1 2

1 3

2 4

3 5

1 5
```

### 输出

```
No
```

## 样例 #3

### 输入

```
10 10 6

2 5

2 6

3 5

3 8

4 6

4 8

5 9

6 7

6 10

7 9
```

### 输出

```
Yes

3

10 9 6
```



---

---
title: "[ABC383E] Sum of Max Matching"
layout: "post"
diff: 提高+/省选-
pid: AT_abc383_e
tag: ['贪心', '并查集', '生成树']
---

# [ABC383E] Sum of Max Matching

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc383/tasks/abc383_e

頂点に $ 1 $ から $ N $ の番号が、辺に $ 1 $ から $ M $ の番号が付いた $ N $ 頂点 $ M $ 辺の重み付き単純連結無向グラフが与えられます。辺 $ i $ $ (1\ \leq\ i\ \leq\ M) $ は頂点 $ u_i $ と頂点 $ v_i $ を双方向に結び、重みは $ w_i $ です。

あるパスに対してその重みをそのパスに含まれる辺の重みの最大値とします。 また、$ f(x,y) $ を 頂点 $ x $ から頂点 $ y $ へのパスの重みとしてありえる最小値とします。

長さ $ K $ の数列 $ (A_1,A_2,\ldots,A_K) $ と $ (B_1,B_2,\ldots,B_K) $ が与えられます。ここで、$ A_i\ \neq\ B_j $ $ (1\ \leq\ i,j\ \leq\ K) $ が成り立つことが保証されます。

数列 $ B $ を自由に並べ替えて、$ \displaystyle\sum_{i=1}^{K}f(A_i,B_i) $ を最小化してください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

>$ N $ $ M $ $ K $
>
>$ u_1 $ $ v_1 $ $ w_1 $
>
>$ u_2 $ $ v_2 $ $ w_2 $
>
>$ \vdots $
>
>$ u_M $ $ v_M $ $ w_M $
>
>$ A_1 $ $ A_2 $ $ \ldots $ $ A_K $
>
>$ B_1 $ $ B_2 $ $ \ldots $ $ B_K $


## 输出格式

$ \displaystyle\sum_{i=1}^{K}f(A_i,B_i) $ の最小値を出力せよ。

## 说明/提示

### 制約

- $ 2\ \leq\ N\ \leq\ 2\ \times\ 10^5 $
- $ N-1\ \leq\ M\ \leq\ \min(\frac{N\ \times\ (N-1)}{2},2\ \times\ 10^5) $
- $ 1\ \leq\ K\ \leq\ N $
- $ 1\ \leq\ u_i\ <\ v_i\ \leq\ N $ $ (1\ \leq\ i\ \leq\ M) $
- $ 1\ \leq\ w_i\ \leq\ 10^9 $
- $ 1\ \leq\ A_i,B_i\ \leq\ N $ $ (1\ \leq\ i\ \leq\ K) $
- $ A_i\ \neq\ B_j $ $ (1\ \leq\ i,j\ \leq\ K) $
- 与えられるグラフは単純かつ連結
- 入力は全て整数

### Sample Explanation 1

$ B $ を並び替えて、$ B=(2,4,4) $ としたとき、 - $ f(1,2)=5 $ : 頂点 $ 1 $ から頂点 $ 4 $ を経由し頂点 $ 2 $ に行くパスがあり、辺 $ 3 $ の重み $ 5 $ が最大値を取ります。また、辺の重みの最大値が $ 4 $ 以下になるようなパスは存在しないため $ 5 $ が最小値です。 - $ f(1,4)=2 $ : 頂点 $ 1 $ から頂点 $ 3 $ を経由し頂点 $ 4 $ に行くパスがあり、辺 $ 1 $ の重み $ 2 $ が最大値を取ります。また、辺の重みの最大値が $ 1 $ 以下になるようなパスは存在しないため $ 2 $ が最小値です。 - $ f(3,4)=1 $ : 頂点 $ 3 $ から頂点 $ 4 $ への辺を通るパスがあり、辺の重みは $ 1 $ でこれが辺の重みの最大値です。また、パスの重みが $ 0 $ 以下になることはないため $ 1 $ が最小値です。 よって、この場合 $ \displaystyle\ \sum_{i=1}^{3}f(A_i,B_i)=5+2+1=8 $ となります。また、$ B $ をどのように並び替えても $ 7 $ 以下になることはないため、答えは $ 8 $ です。

## 样例 #1

### 输入

```
4 4 3
1 3 2
3 4 1
2 4 5
1 4 4
1 1 3
4 4 2
```

### 输出

```
8
```

## 样例 #2

### 输入

```
3 3 2
1 2 5
2 3 2
1 3 1
1 1
2 3
```

### 输出

```
3
```



---

---
title: "[ARC167C] MST on Line++"
layout: "post"
diff: 提高+/省选-
pid: AT_arc167_c
tag: ['生成树', '组合数学']
---

# [ARC167C] MST on Line++

## 题目描述

[problemUrl]: https://atcoder.jp/contests/arc167/tasks/arc167_c

正整数 $ N,K $ と長さ $ N $ の正整数列 $ A=(A_{1},A_{2},\dots,A_{N}) $ が与えられます。

$ (1,2,\dots\ ,N) $ の順列 $ P=(P_{1},P_{2},\dots\ ,P_{N}) $ に対して以下の「問題 MST on Line」について考え、その答えを $ f(P) $ と書きます。

> **問題 MST on Line**
> 
> 頂点に $ 1 $ から $ N $ までの番号がついた頂点数 $ N $ の重み付き無向グラフ $ G $ があります。$ G $ について $ 1\leq\ i\lt\ j\leq\ N $ を満たす任意の整数の組 $ (i,j) $ に対して以下が成り立ちます。
> 
> - $ j-i\leq\ K $ ならば頂点 $ i $ と頂点 $ j $ の間に辺が存在して、その辺の重みは **$ \max(A_{P_{i}},A_{P_{j}}) $**
> - $ j-i\gt\ K $ ならば頂点 $ i $ と頂点 $ j $ の間に辺は存在しない
>  
> $ G $ の最小全域木の辺の重みの和を求めてください。

全ての $ (1,2,\dots\ ,N) $ の順列 $ P=(P_{1},P_{2},\dots\ ,P_{N}) $ に対する $ f(P) $ の総和を $ 998244353 $ で割ったあまりを求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられます。

> $ N $ $ K $ $ A_{1} $ $ A_{2} $ $ \cdots $ $ A_{N} $

## 输出格式

答えを出力してください。

## 说明/提示

### 制約

- $ 1\leq\ K\lt\ N\leq\ 5000 $
- $ 1\leq\ A_{i}\leq\ 10^{9} $
- 入力は全て整数
 
### Sample Explanation 1

$ P=(1,2,3,4,5) $ としたとき、 頂点 $ 1 $ と $ 2 $ の間に存在する、重み $ 4 $ の辺、 頂点 $ 2 $ と $ 3 $ の間に存在する、重み $ 5 $ の辺、 頂点 $ 2 $ と $ 4 $ の間に存在する、重み $ 4 $ の辺、 頂点 $ 4 $ と $ 5 $ の間に存在する、重み $ 2 $ の辺、 という $ 4 $ つの辺は $ G $ の全域木となり、辺の重みの和は $ 15 $ です。 これ以上辺の重みの和を少なくするように全域木をとることはできないので、$ f(P)=15 $ となります。 以上のように全ての $ (1,2,3,4,5) $ の順列 $ P $ に対する $ f(P) $ の総和を求めると $ 1740 $ になるので、これを出力します。

## 样例 #1

### 输入

```
5 2

3 4 5 2 1
```

### 输出

```
1740
```

## 样例 #2

### 输入

```
2 1

167 924
```

### 输出

```
1848
```

## 样例 #3

### 输入

```
12 9

22847 98332 854 68844 81080 46058 40949 62493 76561 52907 88628 99740
```

### 输出

```
660459584
```



---

---
title: "水筒"
layout: "post"
diff: 提高+/省选-
pid: AT_joisc2014_e
tag: ['2014', '广度优先搜索 BFS', '生成树', 'JOI（日本）']
---

# 水筒

## 题目描述

[problemUrl]: https://atcoder.jp/contests/joisc2014/tasks/joisc2014_e





---


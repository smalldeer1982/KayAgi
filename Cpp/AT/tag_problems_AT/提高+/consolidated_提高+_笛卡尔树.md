---
title: "[ARC186B] Typical Permutation Descriptor"
layout: "post"
diff: 提高+/省选-
pid: AT_arc186_b
tag: ['树形 DP', '组合数学', '笛卡尔树']
---

# [ARC186B] Typical Permutation Descriptor

## 题目描述

[problemUrl]: https://atcoder.jp/contests/arc186/tasks/arc186_b

長さ $ N $ の整数列 $ (A_1,\dots,A_N) $ が与えられます。この整数列は、各 $ i=1,\dots,N $ について、$ 0\le\ A_i\ <\ i $ を満たします。 次の条件を満たす $ (1,\dots,N) $ の順列 $ (P_1,\dots,P_N) $ の数を $ 998244353 $ で割ったあまりを求めてください。

- $ i=1,\dots,N $ について、
  - $ A_i\ <\ j\ <\ i $ であるすべての整数 $ j $ について、$ P_j\ >\ P_i $
  - $ A_i\ >\ 0 $ ならば $ P_{A_i}\ <\ P_i $

ただし、この問題の入力で与えられる $ (A_1,\dots,A_N) $ について、条件を満たす順列が存在することが保証されます。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ A_1 $ $ A_2 $ $ \dots $ $ A_N $

## 输出格式

条件を満たす順列の数を $ 998244353 $ で割ったあまりを出力せよ。

## 说明/提示

### 制約

- $ 1\le\ N\le\ 3\times\ 10^5 $
- $ 0\le\ A_i\ \lt\ i $
- $ A_1,\dots,A_N $ について、問題文中の条件を満たすような順列が存在する
- 入力はすべて整数

### Sample Explanation 1

$ (2,\ 3,\ 1,\ 4),\ (2,\ 4,\ 1,\ 3),\ (3,\ 4,\ 1,\ 2) $ の $ 3 $ つです。

### Sample Explanation 2

$ 2350309500 $ を $ 998244353 $ で割ったあまりである、 $ 353820794 $ が答えです。

## 样例 #1

### 输入

```
4
0 1 0 3
```

### 输出

```
3
```

## 样例 #2

### 输入

```
22
0 1 2 2 2 2 2 2 1 9 9 9 9 0 14 15 15 15 14 19 19 19
```

### 输出

```
353820794
```



---

---
title: "[ARC189D] Takahashi is Slime"
layout: "post"
diff: 提高+/省选-
pid: AT_arc189_d
tag: ['贪心', 'ST 表', '笛卡尔树']
---

# [ARC189D] Takahashi is Slime

## 题目描述

有 $N$ 个史莱姆排成一列，从左到右依次编号为 $1, 2, \ldots, N$。第 $i$ 个史莱姆的大小为 $A_i$。  
对于每一个位置 $K = 1, 2, \ldots, N$，解决下面的问题：

> 初始时，第 $K$ 个史莱姆是高桥君。高桥君可以执行任意多次（可以是 $0$ 次）的操作。请计算高桥君在操作后能达到的最大大小。
>
> - 高桥君可以吸收一个相邻且大小小于他的史莱姆。吸收后，该史莱姆消失，高桥君的大小增加该史莱姆的大小。
>
> 在这个过程中，被吸收的史莱姆消失后空出的位置会立即由两侧的史莱姆填补，这使得两端的史莱姆重新相邻（请参考样例 1）。

## 输入格式

从标准输入读取以下格式的数据：

> $N$ $A_1$ $A_2$ $\ldots$ $A_N$

## 输出格式

对于每个 $K = 1, 2, \ldots, N$，输出问题的答案 $B_K$，各答案以空格分隔：

> $B_1$ $B_2$ $\ldots$ $B_N$

## 说明/提示

- $2 \leq N \leq 5 \times 10^5$
- $1 \leq A_i \leq 10^9$
- 所有输入都是整数

### 样例解释

以 $K = 4$ 为例。我们用方括号 `[]` 标识高桥君，称其为**列状态**。初始状态下的列为 $(4, 13, 2, [3], 2, 6)$。以下是高桥君的操作步骤：
1. 高桥君吸收右邻的史莱姆，大小变为 $3 + 2 = 5$，列状态变为 $(4, 13, 2, [5], 6)$。
2. 高桥君吸收左邻的史莱姆，大小变为 $5 + 2 = 7$，列状态变为 $(4, 13, [7], 6)$。
3. 高桥君吸收右邻的史莱姆，大小变为 $7 + 6 = 13$，列状态变为 $(4, 13, [13])$。

最终，高桥君再也无法吸收任何比他小的邻居，所以他的最大可能大小是 $13$。

 **本翻译由 AI 自动生成**

## 样例 #1

### 输入

```
6

4 13 2 3 2 6
```

### 输出

```
4 30 2 13 2 13
```

## 样例 #2

### 输入

```
12

22 25 61 10 21 37 2 14 5 8 6 24
```

### 输出

```
22 47 235 10 31 235 2 235 5 235 6 235
```



---


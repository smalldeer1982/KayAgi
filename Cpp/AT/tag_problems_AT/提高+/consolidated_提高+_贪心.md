---
title: "[ABC314G] Amulets"
layout: "post"
diff: 提高+/省选-
pid: AT_abc314_g
tag: ['贪心']
---

# [ABC314G] Amulets

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc314/tasks/abc314_g

洞窟に、モンスター $ 1 $ 、モンスター $ 2 $ 、$ \ldots $ 、モンスター $ N $ の $ N $ 体のモンスターがおり、各モンスターには正整数の**攻撃力**と、$ 1 $ 以上 $ M $ 以下の整数で表される**タイプ**が定められています。 具体的には、$ i\ =\ 1,\ 2,\ \ldots,\ N $ について、モンスター $ i $ の攻撃力は $ A_i $ でタイプは $ B_i $ です。

高橋君はお守り $ 1 $ 、お守り $ 2 $ 、$ \ldots $ 、お守り $ M $ の $ M $ 個のお守りのうちのいくつかを持って、**体力**が $ H $ の状態でこの洞窟に冒険に出かけます。

冒険では高橋君は（体力が $ 0 $ 以下になって力尽きない限り）$ i\ =\ 1,\ 2,\ \ldots,\ N $ の順に下記の手順を行います。

- もし高橋君がお守り $ B_i $ を冒険に持ってきていないなら、高橋君はモンスター $ i $ の攻撃を受け、高橋君の体力が $ A_i $ だけ減少する。
- その後の時点での高橋君の体力が、
  - $ 0 $ より大きいならば、高橋君はモンスター $ i $ を倒す。
  - $ 0 $ 以下ならば、高橋君はモンスター $ i $ を倒せずに力尽きて冒険を終了する。

$ K\ =\ 0,\ 1,\ \ldots,\ M $ のそれぞれの場合について独立に、下記の問題を解いてください。

> 高橋君が全 $ M $ 個のお守りの中から $ K $ 個を選んで冒険に持っていくときの、高橋君が倒すモンスターの数としてあり得る最大値を求めよ。

なお、任意の $ i\ =\ 1,\ 2,\ \ldots,\ M $ について、タイプが $ i $ であるモンスターが必ず $ 1 $ 体以上いることが、制約として保証されます。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ M $ $ H $ $ A_1 $ $ B_1 $ $ A_2 $ $ B_2 $ $ \vdots $ $ A_N $ $ B_N $

## 输出格式

各 $ i\ =\ 0,\ 1,\ 2,\ \ldots,\ M $ について、$ K\ =\ i $ の場合の高橋君が倒すモンスターの数の最大値を $ X_i $ とする。 $ X_0,\ X_1,\ \ldots,\ X_M $ を下記の形式にしたがって空白区切りで出力せよ。

> $ X_0 $ $ X_1 $ $ \ldots $ $ X_M $

## 说明/提示

### 制約

- $ 1\ \leq\ M\ \leq\ N\ \leq\ 3\ \times\ 10^5 $
- $ 1\ \leq\ H\ \leq\ 10^9 $
- $ 1\ \leq\ A_i\ \leq\ 10^9 $
- $ 1\ \leq\ B_i\ \leq\ M $
- 任意の $ 1\ \leq\ i\ \leq\ M $ に対して、ある $ 1\ \leq\ j\ \leq\ N $ が存在して $ B_j\ =\ i $ が成り立つ
- 入力はすべて整数

### Sample Explanation 1

$ K\ =\ 1 $ の問題を考えます。この場合、高橋君はお守り $ 2 $ を持っていくことで、$ 5 $ 体のモンスターを倒し、倒すモンスターの数の最大値を達成することができます。 その際の冒険は、下記の通りに進行します。 - $ i\ =\ 1 $ について、高橋君はお守り $ 2 $ を持っているため、モンスター $ 1 $ の攻撃を免れます。その後、高橋君はモンスター $ 1 $ を倒します。 - $ i\ =\ 2 $ について、高橋君はお守り $ 1 $ を持っていないため、モンスター $ 2 $ の攻撃を受けて体力が $ 6 $ になります。その後、高橋君はモンスター $ 2 $ を倒します。 - $ i\ =\ 3 $ について、高橋君はお守り $ 2 $ を持っているため、モンスター $ 3 $ の攻撃を免れます。その後、高橋君はモンスター $ 3 $ を倒します。 - $ i\ =\ 4 $ について、高橋君はお守り $ 2 $ を持っているため、モンスター $ 4 $ の攻撃を免れます。その後、高橋君はモンスター $ 4 $ を倒します。 - $ i\ =\ 5 $ について、高橋君はお守り $ 1 $ を持っていないため、モンスター $ 5 $ の攻撃を受けて体力が $ 1 $ になります。その後、高橋君はモンスター $ 5 $ を倒します。 - $ i\ =\ 6 $ について、高橋君はお守り $ 3 $ を持っていないため、モンスター $ 6 $ の攻撃を受けて体力が $ -8 $ になります。その後、高橋君はモンスター $ 6 $ を倒せずに力尽きて冒険を終了します。 同様に、$ K\ =\ 0 $ の場合は $ 2 $ 体のモンスターを、 $ K\ =\ 2 $ の場合はお守り $ 2,\ 3 $ を持っていくことで $ 7 $ 体のモンスター全てを、 $ K\ =\ 3 $ の場合はお守り $ 1,\ 2,\ 3 $ を持っていくことで $ 7 $ 体のモンスター全てを倒すことができます。

## 样例 #1

### 输入

```
7 3 7
3 2
1 1
4 2
1 2
5 1
9 3
2 3
```

### 输出

```
2 5 7 7
```

## 样例 #2

### 输入

```
15 5 400
29 5
27 4
79 1
27 2
30 3
4 1
89 2
88 3
75 5
3 1
39 4
12 1
62 4
38 2
49 1
```

### 输出

```
8 12 15 15 15 15
```



---

---
title: "[ABC318F] Octopus"
layout: "post"
diff: 提高+/省选-
pid: AT_abc318_f
tag: ['贪心', '枚举']
---

# [ABC318F] Octopus

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc318/tasks/abc318_f

数直線上に $ 1 $ 体のタコ型ロボットと $ N $ 個の宝があります。 $ i $ $ (1\leq\ i\leq\ N) $ 個目の宝はそれぞれ座標 $ X_i $ にあります。  
 タコ型ロボットは $ 1 $ つの頭と $ N $ 本の足を持っており、$ i $ 本目の足の長さは $ L_i $ $ (1\leq\ i\leq\ N) $ です。

タコ型ロボットが次のようにして $ N $ 個の宝すべてを掴む事ができるような**整数** $ k $ の個数を求めてください。

- 頭を座標 $ k $ におく。
- $ i=1,2,\ldots,N $ の順に、「頭から距離 $ L_i $ 以下の範囲、すなわち $ k-L_i\leq\ x\leq\ k+L_i $ をみたす座標 $ x $ にまだ掴んでいない宝が存在する場合、そのうちの $ 1 $ つを選んで掴む」ことを繰り返す。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ X_1 $ $ X_2 $ $ \ldots $ $ X_N $ $ L_1 $ $ L_2 $ $ \ldots $ $ L_N $

## 输出格式

問題文の条件をみたす整数 $ k $ の個数を出力せよ。

## 说明/提示

### 制約

- $ 1\ \leq\ N\leq\ 200 $
- $ -10^{18}\ \leq\ X_1\ <\ X_2\ <\ \cdots\ <\ X_N\leq\ 10^{18} $
- $ 1\leq\ L_1\leq\ L_2\leq\cdots\leq\ L_N\leq\ 10^{18} $
- 入力はすべて整数
 
### Sample Explanation 1

$ k=-3,-2,-1,2,3,4 $ が条件をみたします。例えば、$ k=-3 $ のときは、次のようにして $ 3 $ 個の宝をすべて掴む事ができます。 - $ 1 $ 本目の足は $ -6\leq\ x\leq\ 0 $ にある宝を掴む事ができる。このうち座標 $ -6 $ にある $ 1 $ 個目の宝を掴む。 - $ 2 $ 本目の足は $ -8\leq\ x\leq\ 2 $ にある宝を掴む事ができる。このうち座標 $ 0 $ にある $ 2 $ 個目の宝を掴む。 - $ 3 $ 本目の足は $ -13\leq\ x\leq\ 7 $ にある宝を掴む事ができる。このうち座標 $ 7 $ にある $ 3 $ 個目の宝を掴む。

### Sample Explanation 2

$ -10^{18} $ 以上 $ 10^{18} $ 以下のすべての整数が $ k $ として条件をみたします。

### Sample Explanation 3

条件をみたす $ k $ は存在しません。

## 样例 #1

### 输入

```
3

-6 0 7

3 5 10
```

### 输出

```
6
```

## 样例 #2

### 输入

```
1

0

1000000000000000000
```

### 输出

```
2000000000000000001
```

## 样例 #3

### 输入

```
2

-100 100

1 1
```

### 输出

```
0
```



---

---
title: "[ABC344F] Earn to Advance"
layout: "post"
diff: 提高+/省选-
pid: AT_abc344_f
tag: ['动态规划 DP', '贪心']
---

# [ABC344F] Earn to Advance

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc344/tasks/abc344_f

縦 $ N $ 行横 $ N $ 列のグリッドがあります。上から $ i $ 行目、左から $ j $ 列目のマスをマス $ (i,j) $ と表します。

高橋君は最初マス $ (1,1) $ におり、所持金は $ 0 $ です。

高橋君はマス $ (i,j) $ にいるとき、$ 1 $ 回の**行動**で以下のいずれかを行うことができます。

- 同じマスにとどまり、所持金を $ P_{i,j} $ 増やす。
- 所持金から $ R_{i,j} $ 払ってマス $ (i,j+1) $ に移動する。
- 所持金から $ D_{i,j} $ 払ってマス $ (i+1,j) $ に移動する。

所持金が負になる移動、グリッドの外に出る移動はできません。

高橋君が最適に行動したとき、何回の行動でマス $ (N,N) $ にたどり着くことができますか。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ P_{1,1} $ $ \ldots $ $ P_{1,N} $ $ \vdots $ $ P_{N,1} $ $ \ldots $ $ P_{N,N} $ $ R_{1,1} $ $ \ldots $ $ R_{1,N-1} $ $ \vdots $ $ R_{N,1} $ $ \ldots $ $ R_{N,N-1} $ $ D_{1,1} $ $ \ldots $ $ D_{1,N} $ $ \vdots $ $ D_{N-1,1} $ $ \ldots $ $ D_{N-1,N} $

## 输出格式

答えを出力せよ。

## 说明/提示

### 制約

- $ 2\ \leq\ N\ \leq\ 80 $
- $ 1\ \leq\ P_{i,j}\ \leq\ 10^9 $
- $ 1\ \leq\ R_{i,j},D_{i,j}\ \leq\ 10^9 $
- 入力は全て整数である

### Sample Explanation 1

!\[図\](https://img.atcoder.jp/abc344/ec8d878cbf8ad189f178d8b5a3262974.png) 以下のようにして $ 8 $ 回の行動でマス $ (3,3) $ にたどり着くことができます。 - マス $ (1,1) $ にとどまり、所持金を $ 1 $ 増やす。所持金は $ 1 $ になる。 - 所持金から $ 1 $ 払ってマス $ (2,1) $ に移動する。所持金は $ 0 $ になる。 - マス $ (2,1) $ にとどまり、所持金を $ 3 $ 増やす。所持金は $ 3 $ になる。 - マス $ (2,1) $ にとどまり、所持金を $ 3 $ 増やす。所持金は $ 6 $ になる。 - マス $ (2,1) $ にとどまり、所持金を $ 3 $ 増やす。所持金は $ 9 $ になる。 - 所持金から $ 4 $ 払ってマス $ (2,2) $ に移動する。所持金は $ 5 $ になる。 - 所持金から $ 3 $ 払ってマス $ (3,2) $ に移動する。所持金は $ 2 $ になる。 - 所持金から $ 2 $ 払ってマス $ (3,3) $ に移動する。所持金は $ 0 $ になる。

## 样例 #1

### 输入

```
3
1 2 3
3 1 2
2 1 1
1 2
4 3
4 2
1 5 7
5 3 3
```

### 输出

```
8
```

## 样例 #2

### 输入

```
3
1 1 1
1 1 1
1 1 1
1000000000 1000000000
1000000000 1000000000
1000000000 1000000000
1000000000 1000000000 1000000000
1000000000 1000000000 1000000000
```

### 输出

```
4000000004
```



---

---
title: "[ABC346F] SSttrriinngg in StringString"
layout: "post"
diff: 提高+/省选-
pid: AT_abc346_f
tag: ['贪心', '二分']
---

# [ABC346F] SSttrriinngg in StringString

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc346/tasks/abc346_f

長さ $ n $ の文字列 $ X $ に対して、$ X $ を $ k $ 回繰り返して得られる文字列を $ f(X,k) $ と表記し、$ X $ の $ 1 $ 文字目、$ 2 $ 文字目、$ \dots $、$ n $ 文字目を $ k $ 回ずつこの順に繰り返して得られる文字列を $ g(X,k) $ と表記します。 例えば、$ X= $ `abc` のとき、$ f(X,2)= $ `abcabc`、$ g(X,3)= $ `aaabbbccc` です。 また、任意の文字列 $ X $ に対して、$ f(X,0) $ と $ g(X,0) $ は共に空文字列です。

正整数 $ N $ および文字列 $ S,T $ が与えられます。 $ g(T,k) $ が $ f(S,N) $ の（連続とは限らない）部分列であるような最大の非負整数 $ k $ を求めてください。 なお、定義より、$ g(T,0) $ は常に $ f(S,N) $ の部分列であることに注意してください。

部分列とは文字列 $ X $ の（連続とは限らない）部分列とは、$ X $ から $ 0 $ 個以上の文字を取り除いた後、残りの文字を元の順序で連結して得られる文字列のことをいいます。 例えば、`ac`、`atcoder`、` `（空文字列）などはどれも `atcoder` の部分列ですが、`ta` は `atcoder` の部分列ではありません。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ S $ $ T $

## 输出格式

$ g(T,k) $ が $ f(S,N) $ の（連続とは限らない）部分列であるような最大の非負整数 $ k $ を出力せよ。

## 说明/提示

### 制約

- $ N $ は整数
- $ 1\leq\ N\leq\ 10^{12} $
- $ S,\ T $ は英小文字からなる長さ $ 1 $ 以上 $ 10^5 $ 以下の文字列

### Sample Explanation 1

$ f(S,3)= $ `abcabcabc` です。 $ g(T,2)= $ `aabb` は $ f(S,3) $ の部分列ですが、$ g(T,3)= $ `aaabbb` は $ f(S,3) $ の部分列ではないので、$ 2 $ を出力します。

## 样例 #1

### 输入

```
3
abc
ab
```

### 输出

```
2
```

## 样例 #2

### 输入

```
3
abc
arc
```

### 输出

```
0
```

## 样例 #3

### 输入

```
1000000000000
kzazkakxkk
azakxk
```

### 输出

```
344827586207
```



---

---
title: "[ABC362F] Perfect Matching on a Tree"
layout: "post"
diff: 提高+/省选-
pid: AT_abc362_f
tag: ['贪心', '树形数据结构']
---

# [ABC362F] Perfect Matching on a Tree

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc362/tasks/abc362_f

$ N $ 頂点の木 $ T $ が与えられます。$ T $ の頂点には $ 1 $ から $ N $ の番号がついており、 $ i\,(1\leq\ i\ \leq\ N-1) $ 番目の辺は頂点 $ u_i $ と頂点 $ v_i $ を双方向に結んでいます。

$ T $ を用いて、$ N $ 頂点の完全グラフ $ G $ を次のように定めます。

- $ G $ の頂点 $ x $ と頂点 $ y $ の間の辺の重み $ w(x,y) $ を、$ T $ における頂点 $ x $ と頂点 $ y $ の間の最短距離とする
 
$ G $ の**最大重み最大マッチング**を一つ求めてください。すなわち、$ \lfloor\ N/2\ \rfloor $ 個の頂点のペアの集合 $ M=\{(x_1,y_1),(x_2,y_2),\dots,(x_{\lfloor\ N/2\ \rfloor},y_{\lfloor\ N/2\ \rfloor})\} $ であって、各頂点 $ 1,2,\dots,\ N $ が $ M $ に現れる回数がたかだか $ 1 $ 回であるようなもののうち、 $ \displaystyle\ \sum_{i=1}^{\lfloor\ N/2\ \rfloor}\ w(x_i,y_i) $ が最大であるものを一つ求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ u_1 $ $ v_1 $ $ u_2 $ $ v_2 $ $ \vdots $ $ u_{N-1} $ $ v_{N-1} $

## 输出格式

答えを $ \{(x_1,y_1),(x_2,y_2),\dots,(x_{\lfloor\ N/2\ \rfloor},y_{\lfloor\ N/2\ \rfloor})\} $ として、以下の形式で出力せよ。答えが複数あり得る場合、そのうちどれを出力しても良い。

> $ x_1 $ $ y_1 $ $ x_2 $ $ y_2 $ $ \vdots $ $ x_{\lfloor\ N/2\ \rfloor} $ $ y_{\lfloor\ N/2\ \rfloor} $

## 说明/提示

### 制約

- $ 2\ \leq\ N\ \leq\ 2\ \times\ 10^5 $
- $ 1\ \leq\ u_i\ <\ v_i\ \leq\ N $
- 入力されるグラフは木である
- 入力はすべて整数
 
### Sample Explanation 1

$ T $ において、頂点 $ 2,4 $ 間の距離は $ 2 $、頂点 $ 1,3 $ 間の距離は $ 2 $ なので、マッチング $ \{(2,4),(1,3)\} $ の重みは $ 4 $ です。重みが $ 4 $ より大きいマッチングは存在しないので、これが最大重み最大マッチングの一つです。他にも、 ``` 2 3 1 4 ``` などを出力しても正解になります。

### Sample Explanation 2

$ T $ において、頂点 $ 1,3 $ 間の距離は $ 2 $ なので、マッチング $ \{(1,3)\} $ の重みは $ 2 $ です。重みが $ 2 $ より大きいマッチングは存在しないので、これが最大重み最大マッチングの一つです。他にも、 ``` 3 1 ``` を出力しても正解になります。

## 样例 #1

### 输入

```
4

1 2

2 3

3 4
```

### 输出

```
2 4

1 3
```

## 样例 #2

### 输入

```
3

1 2

2 3
```

### 输出

```
1 3
```



---

---
title: "[ABC369G] As far as possible"
layout: "post"
diff: 提高+/省选-
pid: AT_abc369_g
tag: ['贪心', '线段树', '树链剖分']
---

# [ABC369G] As far as possible

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc369/tasks/abc369_g

$ N $ 頂点からなる木が与えられます。 頂点は頂点 $ 1 $, 頂点 $ 2 $, $ \ldots $, 頂点 $ N $ と番号づけられています。  
 また、$ i $ 番目（ $ 1\leq\ i\leq\ N-1 $ ）の辺は頂点 $ U_i $ と頂点 $ V_i $ を結んでおり、長さは $ L_i $ です。

$ K=1,2,\ldots,\ N $ について次の問題を解いてください。

> 高橋君と青木君がゲームをします。ゲームは次のように行われます。
> 
> - まず、青木君が木上の相異なる $ K $ 個の頂点を指定します。
> - 次に、高橋君は始点と終点がともに頂点 $ 1 $ であるような歩道であって、青木君が指定した頂点をすべて通るようなものを構成します。
>  
> 高橋君が構成した歩道の長さをスコアと定義します。高橋君はスコアをなるべく小さく、青木君はスコアをなるべく大きくしたいです。 $ 2 $ 人が最善に行動したときのスコアを求めてください。

  歩道とは 無向グラフ（木を含む）上の歩道とは、$ k $ 個 ($ k $ は正整数) の頂点と $ k-1 $ 個の辺を交互に並べた列 $ v_1,e_1,v_2,\ldots,v_{k-1},e_{k-1},v_k $ であって、 辺 $ e_i $ が頂点 $ v_i $ と頂点 $ v_{i+1} $ を結んでいるようなものを指す。列の中に同じ頂点や同じ辺が何回登場しても良い。 歩道が頂点 $ x $ を通るとは、$ v_i=x $ となるような $ 1\leq\ i\leq\ k $ が $ 1 $ つ以上存在することをいう。（複数個存在しても良い。） また、歩道の始点、終点はそれぞれ $ v_1 $, $ v_k $ のことをさし、歩道の長さとは $ e_1 $, $ e_2 $, $ \ldots $, $ e_{k-1} $ の長さの総和を表す。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ U_1 $ $ V_1 $ $ L_1 $ $ U_2 $ $ V_2 $ $ L_2 $ $ \vdots $ $ U_{N-1} $ $ V_{N-1} $ $ L_{N-1} $

## 输出格式

$ N $ 行出力せよ。 $ i $ 行目 $ (1\leq\ i\leq\ N) $ には $ K=i $ のときの問題の答えを出力せよ。

## 说明/提示

### 制約

- $ 2\leq\ N\leq\ 2\times\ 10^5 $
- $ 1\leq\ U_i\ <\ V_i\leq\ N $
- $ 1\leq\ L_i\leq\ 10^9 $
- 入力はすべて整数
- 与えられるグラフは木である。
 
### Sample Explanation 1

$ K=1 $ のとき青木君は頂点 $ 3 $ を指定するのが最善で、このとき高橋君は頂点 $ 1 $ $ \to $ 頂点 $ 2 $ $ \to $ 頂点 $ 3 $ $ \to $ 頂点 $ 2 $ $ \to $ 頂点 $ 1 $ の歩道を構成しスコアを $ 16 $ とするのが最善となります。 $ K=2 $ のとき青木君は頂点 $ 3,5 $ を指定するのが最善で、このとき高橋君は頂点 $ 1 $ $ \to $ 頂点 $ 5 $ $ \to $ 頂点 $ 1 $ $ \to $ 頂点 $ 2 $ $ \to $ 頂点 $ 3 $ $ \to $ 頂点 $ 2 $ $ \to $ 頂点 $ 1 $ などの歩道を構成しスコアを $ 22 $ とするのが最善となります。 $ K\geq\ 3 $ のとき、両者が最善を尽くしたときのスコアは $ 26 $ となります。

### Sample Explanation 2

答えが $ 32 $bit 整数型に収まらない可能性があることに注意してください。

## 样例 #1

### 输入

```
5

1 2 3

2 3 5

2 4 2

1 5 3
```

### 输出

```
16

22

26

26

26
```

## 样例 #2

### 输入

```
3

1 2 1000000000

2 3 1000000000
```

### 输出

```
4000000000

4000000000

4000000000
```



---

---
title: "[ABC371G] Lexicographically Smallest Permutation"
layout: "post"
diff: 提高+/省选-
pid: AT_abc371_g
tag: ['贪心', '数论']
---

# [ABC371G] Lexicographically Smallest Permutation

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc371/tasks/abc371_g

$ (1,2,\ldots,N) $ の並べ替え $ P=(P\ _\ 1,P\ _\ 2,\ldots,P\ _\ N),A=(A\ _\ 1,A\ _\ 2,\ldots,A\ _\ N) $ が与えられます。

あなたは、次の操作を $ 0 $ 回以上好きな回数行うことができます。

- $ i=1,2,\ldots,N $ に対して**一斉に** $ A\ _\ i $ を $ A\ _\ {P\ _\ i} $ で置き換える。
 
得られる $ A $ としてありえるもののうち、辞書順で最小のものを出力してください。

 辞書順の大小とは？ 長さ $ N $ の列 $ A=(A\ _\ 1,A\ _\ 2,\ldots,A\ _\ N),B=(B\ _\ 1,B\ _\ 2,\ldots,B\ _\ N) $ について、辞書順で $ A $ が $ B $ より小さいとは、次のことが成り立つことをいいます。

- ある整数 $ i\ (1\leq\ i\leq\ N) $ が存在し、$ A\ _\ i\lt\ B\ _\ i $ が成り立ち、$ 1\leq\ j\lt\ i $ を満たすすべての整数 $ j $ に対して $ A\ _\ j=B\ _\ j $ が成り立つ。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ P\ _\ 1 $ $ P\ _\ 2 $ $ \ldots $ $ P\ _\ N $ $ A\ _\ 1 $ $ A\ _\ 2 $ $ \ldots $ $ A\ _\ N $

## 输出格式

$ 0 $ 回以上の操作の結果としてあり得る $ A $ のうち辞書順で最小のものを $ (A\ _\ 1,A\ _\ 2,\ldots,A\ _\ N) $ として、$ A\ _\ 1,A\ _\ 2,\ldots,A\ _\ N $ をこの順に空白を区切りとして $ 1 $ 行に出力せよ。

## 说明/提示

### 制約

- $ 1\leq\ N\leq2\times10\ ^\ 5 $
- $ 1\leq\ P\ _\ i\leq\ N\ (1\leq\ i\leq\ N) $
- $ P\ _\ i\neq\ P\ _\ j\ (1\leq\ i\lt\ j\leq\ N) $
- $ 1\leq\ A\ _\ i\leq\ N\ (1\leq\ i\leq\ N) $
- $ A\ _\ i\neq\ A\ _\ j\ (1\leq\ i\lt\ j\leq\ N) $
- 入力はすべて整数
 
### Sample Explanation 1

はじめ、$ A=(4,3,1,6,2,5) $ です。 ここから操作を繰り返すと、以下のようになります。 - $ A=(1,4,2,5,3,6) $ となる。 - $ A=(2,1,3,6,4,5) $ となる。 - $ A=(3,2,4,5,1,6) $ となる。 - $ A=(4,3,1,6,2,5) $ となる。 以降、$ 4 $ 回操作を行うたびにもとの $ A $ に戻ります。 よって、このうち辞書順で最小である `1 4 2 5 3 6` を出力してください。

### Sample Explanation 2

$ 1 $ 度も操作をしなくても構いません。

## 样例 #1

### 输入

```
6

3 1 5 6 2 4

4 3 1 6 2 5
```

### 输出

```
1 4 2 5 3 6
```

## 样例 #2

### 输入

```
8

3 5 8 7 2 6 1 4

1 2 3 4 5 6 7 8
```

### 输出

```
1 2 3 4 5 6 7 8
```

## 样例 #3

### 输入

```
26

24 14 4 20 15 19 16 11 23 22 12 18 21 3 6 8 26 2 25 7 13 1 5 9 17 10

15 3 10 1 13 19 22 24 20 4 14 23 7 26 25 18 11 6 9 12 2 21 5 16 8 17
```

### 输出

```
4 1 22 18 20 13 14 6 15 11 3 26 2 12 5 23 9 10 25 24 7 17 16 21 19 8
```



---

---
title: "[ABC373F] Knapsack with Diminishing Values"
layout: "post"
diff: 提高+/省选-
pid: AT_abc373_f
tag: ['动态规划 DP', '贪心', '数学']
---

# [ABC373F] Knapsack with Diminishing Values

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc373/tasks/abc373_f

$ N $ 種類の品物があり、 $ i $ 種類目の品物の重みは $ w_i $、価値は $ v_i $ です。どの種類の品物も $ 10^{10} $ 個ずつあります。

高橋君はこれから、品物をいくつか選んで、容量 $ W $ のバッグに入れます。高橋君は、選ぶ品物の価値を大きくしつつ、同じ種類の品物ばかりにならないようにしたいです。そこで高橋君は、$ i $ 種類目の品物を $ k_i $ 個選んだときの **うれしさ** を $ k_i\ v_i\ -\ k_i^2 $ と定義したとき、選んだ品物の重さの総和を $ W $ 以下にしつつ、各種類のうれしさの総和が最大になるように品物を選びます。高橋君が達成できる、うれしさの総和の最大値を求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ W $ $ w_1 $ $ v_1 $ $ w_2 $ $ v_2 $ $ \vdots $ $ w_N $ $ v_N $

## 输出格式

答えを出力せよ。

## 说明/提示

### 制約

- $ 1\ \leq\ N\ \leq\ 3000 $
- $ 1\ \leq\ W\ \leq\ 3000 $
- $ 1\ \leq\ w_i\ \leq\ W $
- $ 1\ \leq\ v_i\ \leq\ 10^9 $
- 入力はすべて整数
 
### Sample Explanation 1

$ 1 $ 種類目の品物を $ 2 $ 個、$ 2 $ 種類目の品物を $ 1 $ 個選ぶと、うれしさの総和を $ 5 $ にすることができ、これが最適です。 $ 1 $ 種類目の品物についてのうれしさは $ 2\ \times\ 4\ -\ 2^2\ =\ 4 $、$ 2 $ 種類目の品物についてのうれしさは $ 1\ \times\ 2\ -\ 1^2\ =\ 1 $ です。 また、重さの総和は $ 9 $ であり、容量 $ 10 $ のバッグに入ります。

## 样例 #1

### 输入

```
2 10

3 4

3 2
```

### 输出

```
5
```

## 样例 #2

### 输入

```
3 6

1 4

2 3

2 7
```

### 输出

```
14
```

## 样例 #3

### 输入

```
1 10

1 7
```

### 输出

```
12
```



---

---
title: "[ABC381F] 1122 Subsequence"
layout: "post"
diff: 提高+/省选-
pid: AT_abc381_f
tag: ['贪心', '标签464']
---

# [ABC381F] 1122 Subsequence

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc381/tasks/abc381_f

正整数からなる（空でも良い）数列 $ X=(X_1,X_2,\ldots) $ が以下の $ 3 $ つの条件をすべてみたすとき、かつそのときに限り、$ X $ を **1122 数列** と呼びます。  
（1122 数列の定義はD問題と共通です。）

- $ \lvert\ X\ \rvert $ は偶数である。ここで、$ \lvert\ X\ \rvert $ は $ X $ の長さを表す。
- $ 1\leq\ i\leq\ \frac{\lvert\ X\ \rvert}{2} $ をみたす整数 $ i $ について、$ X_{2i-1} $ と $ X_{2i} $ は等しい。
- 各正整数は $ X $ に現れないか、ちょうど $ 2 $ 回現れるかのどちらかである。すなわち、$ X $ に含まれる正整数は $ X $ にちょうど $ 2 $ 回ずつ登場する。

正整数からなる長さ $ N $ の数列 $ A=(A_1,A_2,\ldots,A_N) $ が与えられるので、$ A $ の **（連続でなくても良い）部分列** であって、1122 数列であるようなもののうち最長のものの長さを出力してください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ A_1 $ $ A_2 $ $ \ldots $ $ A_N $

## 输出格式

$ A $ の（連続でなくても良い）部分列であって、1122 数列であるようなもののうち最長のものの長さを出力せよ。

## 说明/提示

### 制約

- $ 1\leq\ N\ \leq\ 2\times\ 10^5 $
- $ 1\leq\ A_i\ \leq\ 20 $
- 入力はすべて整数

### Sample Explanation 1

例えば $ A $ の部分列として、$ 1,4,5,6 $ 項目をとると $ (1,1,2,2) $ となりますが、これは長さが $ 4 $ の 1122 数列となっています。 これより長い部分列であって、1122 数列の条件をみたすようなものは存在しないため、$ 4 $ を出力します。

## 样例 #1

### 输入

```
7
1 3 3 1 2 2 1
```

### 输出

```
4
```

## 样例 #2

### 输入

```
1
20
```

### 输出

```
0
```



---

---
title: "[ABC383E] Sum of Max Matching"
layout: "post"
diff: 提高+/省选-
pid: AT_abc383_e
tag: ['贪心', '并查集', '生成树']
---

# [ABC383E] Sum of Max Matching

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc383/tasks/abc383_e

頂点に $ 1 $ から $ N $ の番号が、辺に $ 1 $ から $ M $ の番号が付いた $ N $ 頂点 $ M $ 辺の重み付き単純連結無向グラフが与えられます。辺 $ i $ $ (1\ \leq\ i\ \leq\ M) $ は頂点 $ u_i $ と頂点 $ v_i $ を双方向に結び、重みは $ w_i $ です。

あるパスに対してその重みをそのパスに含まれる辺の重みの最大値とします。 また、$ f(x,y) $ を 頂点 $ x $ から頂点 $ y $ へのパスの重みとしてありえる最小値とします。

長さ $ K $ の数列 $ (A_1,A_2,\ldots,A_K) $ と $ (B_1,B_2,\ldots,B_K) $ が与えられます。ここで、$ A_i\ \neq\ B_j $ $ (1\ \leq\ i,j\ \leq\ K) $ が成り立つことが保証されます。

数列 $ B $ を自由に並べ替えて、$ \displaystyle\sum_{i=1}^{K}f(A_i,B_i) $ を最小化してください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

>$ N $ $ M $ $ K $
>
>$ u_1 $ $ v_1 $ $ w_1 $
>
>$ u_2 $ $ v_2 $ $ w_2 $
>
>$ \vdots $
>
>$ u_M $ $ v_M $ $ w_M $
>
>$ A_1 $ $ A_2 $ $ \ldots $ $ A_K $
>
>$ B_1 $ $ B_2 $ $ \ldots $ $ B_K $


## 输出格式

$ \displaystyle\sum_{i=1}^{K}f(A_i,B_i) $ の最小値を出力せよ。

## 说明/提示

### 制約

- $ 2\ \leq\ N\ \leq\ 2\ \times\ 10^5 $
- $ N-1\ \leq\ M\ \leq\ \min(\frac{N\ \times\ (N-1)}{2},2\ \times\ 10^5) $
- $ 1\ \leq\ K\ \leq\ N $
- $ 1\ \leq\ u_i\ <\ v_i\ \leq\ N $ $ (1\ \leq\ i\ \leq\ M) $
- $ 1\ \leq\ w_i\ \leq\ 10^9 $
- $ 1\ \leq\ A_i,B_i\ \leq\ N $ $ (1\ \leq\ i\ \leq\ K) $
- $ A_i\ \neq\ B_j $ $ (1\ \leq\ i,j\ \leq\ K) $
- 与えられるグラフは単純かつ連結
- 入力は全て整数

### Sample Explanation 1

$ B $ を並び替えて、$ B=(2,4,4) $ としたとき、 - $ f(1,2)=5 $ : 頂点 $ 1 $ から頂点 $ 4 $ を経由し頂点 $ 2 $ に行くパスがあり、辺 $ 3 $ の重み $ 5 $ が最大値を取ります。また、辺の重みの最大値が $ 4 $ 以下になるようなパスは存在しないため $ 5 $ が最小値です。 - $ f(1,4)=2 $ : 頂点 $ 1 $ から頂点 $ 3 $ を経由し頂点 $ 4 $ に行くパスがあり、辺 $ 1 $ の重み $ 2 $ が最大値を取ります。また、辺の重みの最大値が $ 1 $ 以下になるようなパスは存在しないため $ 2 $ が最小値です。 - $ f(3,4)=1 $ : 頂点 $ 3 $ から頂点 $ 4 $ への辺を通るパスがあり、辺の重みは $ 1 $ でこれが辺の重みの最大値です。また、パスの重みが $ 0 $ 以下になることはないため $ 1 $ が最小値です。 よって、この場合 $ \displaystyle\ \sum_{i=1}^{3}f(A_i,B_i)=5+2+1=8 $ となります。また、$ B $ をどのように並び替えても $ 7 $ 以下になることはないため、答えは $ 8 $ です。

## 样例 #1

### 输入

```
4 4 3
1 3 2
3 4 1
2 4 5
1 4 4
1 1 3
4 4 2
```

### 输出

```
8
```

## 样例 #2

### 输入

```
3 3 2
1 2 5
2 3 2
1 3 1
1 1
2 3
```

### 输出

```
3
```



---

---
title: "[AGC004D] Teleporter"
layout: "post"
diff: 提高+/省选-
pid: AT_agc004_d
tag: ['贪心', '图论建模']
---

# [AGC004D] Teleporter

## 题目描述

[problemUrl]: https://atcoder.jp/contests/agc004/tasks/agc004_d

高橋王国には $ N $ 個の町があります。 町は $ 1 $ から $ N $ まで番号が振られています。 町 $ 1 $ は首都です。

それぞれの町にはテレポーターが $ 1 $ 台ずつ設置されています。 町 $ i $ ($ 1\ <\ =i\ <\ =N $) のテレポーターの転送先は町 $ a_i $ ($ 1\ <\ =a_i\ <\ =N $) です。 **どの町から出発しても、テレポーターを何回か使うことで首都へ辿り着ける**ことが保証されます。

高橋王は正の整数 $ K $ が好きです。 わがままな高橋王は、いくつかのテレポーターの転送先を変え、次の条件が成り立つようにしたいと思っています。

- どの町から出発しても、テレポーターをちょうど $ K $ 回使うと、最終的に首都にいる。

条件が成り立つようにするためには、最少でいくつのテレポーターの転送先を変えればよいかを求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ K $ $ a_1 $ $ a_2 $ $ ... $ $ a_N $

## 输出格式

条件が成り立つようにするためには、最少でいくつのテレポーターの転送先を変えればよいかを出力せよ。

## 说明/提示

### 制約

- $ 2\ <\ =N\ <\ =10^5 $
- $ 1\ <\ =a_i\ <\ =N $
- どの町から出発しても、テレポーターを何回か使うことで首都へ辿り着ける。
- $ 1\ <\ =K\ <\ =10^9 $

### Sample Explanation 1

テレポーターの転送先を $ a\ =\ (1，1，1) $ と変えればよいです。

### Sample Explanation 2

最初から条件が成り立っているので、テレポーターの転送先を変える必要はありません。

### Sample Explanation 3

例えば、テレポーターの転送先を $ a\ =\ (1，1，2，1，1，2，2，4) $ と変えればよいです。

## 样例 #1

### 输入

```
3 1

2 3 1
```

### 输出

```
2
```

## 样例 #2

### 输入

```
4 2

1 1 2 2
```

### 输出

```
0
```

## 样例 #3

### 输入

```
8 2

4 1 2 3 1 2 3 4
```

### 输出

```
3
```



---

---
title: "[AGC008D] K-th K"
layout: "post"
diff: 提高+/省选-
pid: AT_agc008_d
tag: ['贪心', '构造']
---

# [AGC008D] K-th K

## 题目描述

[problemUrl]: https://atcoder.jp/contests/agc008/tasks/agc008_d

長さ $ N $ の数列 $ x $ が与えられます。 次の条件をすべて満たす数列 $ a $ が存在するか判定し、存在するならば $ a $ を $ 1 $ つ構成してください。

- $ a $ は長さ $ N^2 $ であり、整数 $ 1 $, $ 2 $, $ ... $, $ N $ をそれぞれちょうど $ N $ 個ずつ含む。
- 各 $ 1\ <\ =\ i\ <\ =\ N $ について、$ a $ に含まれる整数 $ i $ のうち左から $ i $ 番目に位置するものは、$ a $ 全体では左から $ x_i $ 番目に位置する。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ x_1 $ $ x_2 $ $ ... $ $ x_N $

## 输出格式

条件をすべて満たす数列 $ a $ が存在しないならば、`No` を出力せよ。 存在するならば、$ 1 $ 行目に `Yes` を出力し、$ 2 $ 行目に $ a $ を空白区切りで出力せよ。

## 说明/提示

### 制約

- $ 1\ <\ =\ N\ <\ =\ 500 $
- $ 1\ <\ =\ x_i\ <\ =\ N^2 $
- $ x_i $ はすべて相異なる。

### Sample Explanation 1

たとえば、$ a $ に含まれる整数 $ 2 $ のうち左から $ 2 $ 番目に位置するものは、$ a $ 全体では左から $ 5 $ 番目に位置しています。 整数 $ 1 $, $ 3 $ についても同様に条件が成り立っています。

## 样例 #1

### 输入

```
3

1 5 9
```

### 输出

```
Yes

1 1 1 2 2 2 3 3 3
```

## 样例 #2

### 输入

```
2

4 1
```

### 输出

```
No
```



---

---
title: "[AGC018B] Sports Festival"
layout: "post"
diff: 提高+/省选-
pid: AT_agc018_b
tag: ['贪心', '枚举', '概率论']
---

# [AGC018B] Sports Festival

## 题目描述

[problemUrl]: https://atcoder.jp/contests/agc018/tasks/agc018_b

高橋君は、スポーツ大会を開こうと考えています。 スポーツ大会に参加するのは、$ 1 $ から $ N $ までの番号のついた $ N $ 人の人です。 また、大会で行うスポーツとして、$ 1 $ から $ M $ までの番号のついた $ M $ 個のスポーツが候補に上がっています。 高橋君は、これらの中から $ 1 $ つ以上（全てでもよい）のスポーツを選んで、スポーツ大会で実施します。

高橋君は、人 $ i $ が、$ j $ 番目に好きなスポーツが $ A_{ij} $ であることを知っています。 それぞれの人は、スポーツ大会で実施されるスポーツのうち、自分が最も好きなスポーツだけに参加し、他のスポーツには参加しません。

高橋君は、一つのスポーツにたくさんの人が集まり過ぎることを懸念しています。 そこで高橋君は、スポーツ大会で実施するスポーツをうまく選んで、最も多くの人が参加しているスポーツの参加人数を最小化したくなりました。 最も多くの人が参加しているスポーツの参加人数の最小値を求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ M $ $ A_{11} $ $ A_{12} $ $ ... $ $ A_{1M} $ $ A_{21} $ $ A_{22} $ $ ... $ $ A_{2M} $ $ : $ $ A_{N1} $ $ A_{N2} $ $ ... $ $ A_{NM} $

## 输出格式

最も多くの人が参加しているスポーツの参加人数の最小値を出力せよ。

## 说明/提示

### 制約

- $ 1\ \leq\ N\ \leq\ 300 $
- $ 1\ \leq\ M\ \leq\ 300 $
- $ A_{i1} $ , $ A_{i2} $ , $ ... $ , $ A_{iM} $ は、$ 1 $ から $ M $ の順列である。

### Sample Explanation 1

スポーツ $ 1 $,$ 3 $,$ 4 $ を実施することにすると、人 $ 1 $ はスポーツ $ 1 $ に、人 $ 2 $ はスポーツ $ 3 $ に、 人 $ 3 $ はスポーツ $ 3 $ に、人 $ 4 $ はスポーツ $ 4 $ に参加します。 このとき、参加人数が最大のスポーツはスポーツ $ 3 $ で、その参加人数 $ 2 $ 人です。 また、参加人数が最大のスポーツの参加人数が $ 1 $ 人になるような方法は存在しないので、この例の答えは $ 2 $ になります。

### Sample Explanation 2

全員の好みが一致しているので、どうやっても一つのスポーツに $ 3 $ 人集まってしまいます。 よってこの例の答えは $ 3 $ です。

## 样例 #1

### 输入

```
4 5

5 1 3 4 2

2 5 3 1 4

2 3 1 4 5

2 5 4 3 1
```

### 输出

```
2
```

## 样例 #2

### 输入

```
3 3

2 1 3

2 1 3

2 1 3
```

### 输出

```
3
```



---

---
title: "[AGC037B] RGB Balls"
layout: "post"
diff: 提高+/省选-
pid: AT_agc037_b
tag: ['贪心', '排列组合']
---

# [AGC037B] RGB Balls

## 题目描述

[problemUrl]: https://atcoder.jp/contests/agc037/tasks/agc037_b

色のついたボールが $ 3N $ 個あり、それぞれには $ 1 $ から $ 3N $ の番号がついています。 各ボールの色は長さ $ 3N $ の文字列 $ S $ によって表されており、ボール $ i $ の色は $ S_i $ が `R` のとき赤色、`G` のとき緑色、`B` のとき青色です。 赤色のボール、緑色のボール、青色のボールはそれぞれ $ N $ 個ずつあります。

高橋君はこの $ 3N $ 個のボールを、各人が赤、青、緑のボールを $ 1 $ つずつ割り当てられるよう、$ N $ 人の人に分配することにしました。 ただし、ボールをもらう人たちはできるだけ近い番号のボールが欲しいので、高橋君はさらに以下の条件をみたすように分配することにしました。

- $ j $ 番目の人が受け取ったボールの番号を小さい順に $ a_j\ <\ b_j\ <\ c_j $ とする。
- このとき $ \sum_j\ (c_j-a_j) $ ができるだけ小さくなるように分配する。

高橋君がボールを分配する方法は何通りあるか求めてください。 答えは非常に大きくなることがあるので、$ 998244353 $ で割ったあまりを求めてください。 ただし、$ 2 $ つのボールの分配方法が異なるとは、ある人が存在して、その人が受け取ったボールの集合が異なることを指します。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ S $

## 输出格式

高橋君のボールの分配方法が何通りあるかを $ 998244353 $ で割ったあまりを出力せよ。

## 说明/提示

### 制約

- $ 1\ ≦\ N\ ≦\ 10^5 $
- $ |S|=3N $
- $ S $ は `R`, `G`, `B` のみからなり、それぞれ $ N $ 回ずつ $ S $ に登場する

### Sample Explanation 1

例えば以下のようにボールを分配したとき、$ \sum_j\ (c_j-a_j) $ の値が $ 18 $ となり最小となります。 - $ 1 $ 番目の人にボール $ 1,5,9 $ を渡す。 - $ 2 $ 番目の人にボール $ 2,4,8 $ を渡す。 - $ 3 $ 番目の人にボール $ 3,6,7 $ を渡す。

## 样例 #1

### 输入

```
3

RRRGGGBBB
```

### 输出

```
216
```

## 样例 #2

### 输入

```
5

BBRGRRGRGGRBBGB
```

### 输出

```
960
```



---

---
title: "[AGC048B] Bracket Score"
layout: "post"
diff: 提高+/省选-
pid: AT_agc048_b
tag: ['贪心']
---

# [AGC048B] Bracket Score

## 题目描述

[problemUrl]: https://atcoder.jp/contests/agc048/tasks/agc048_b

この問題では，`(`,`)`,`[`,`]` からなる文字列を考えます．

文字列 $ x $ は，以下の**いずれか**の条件を満たす時，**良い括弧列**と呼ばれます．

- $ x $ は空文字列である．
- ある良い括弧列 $ s $ が存在し，`(`,$ s $,`)` をこの順に連結すると $ x $ が得られる．
- ある良い括弧列 $ s $ が存在し，`[`,$ s $,`]` をこの順に連結すると $ x $ が得られる．
- ある空でない良い括弧列 $ s $ および $ t $ が存在し，$ s,t $ をこの順に連結すると $ x $ が得られる．

例えば，`[]`, `([()])`, `()[()]` などは良い括弧列ですが，`())`, `([)]` などは良い括弧列ではありません．

偶数 $ N $ と，長さ $ N $ の整数列 $ A $ および $ B $ が与えられます． ここで，長さ $ N $ の良い括弧列 $ s=s_1s_2\cdots\ s_N $ に対して，$ s $ のスコアを次のように定めます．

- $ s $ のスコアは，各文字のスコアの合計である．
- $ i $ 文字目 ($ 1\ \leq\ i\ \leq\ N $) のスコアは，$ s_i $ が `(` または `)` ならば $ A_i $ であり，$ s_i $ が `[` または `]` ならば $ B_i $ である．

長さ $ N $ の良い括弧列のスコアとしてあり得る最大の値を求めてください．

## 输入格式

入力は以下の形式で標準入力から与えられる．

> $ N $ $ A_1 $ $ A_2 $ $ \cdots $ $ A_N $ $ B_1 $ $ B_2 $ $ \cdots $ $ B_N $

## 输出格式

答えを出力せよ．

## 说明/提示

### 制約

- $ 2\ \leq\ N\ \leq\ 10^5 $
- $ N $ は偶数
- $ 1\ \leq\ A_i\ \leq\ 10^9 $
- $ 1\ \leq\ B_i\ \leq\ 10^9 $
- 入力される数はすべて整数．

### Sample Explanation 1

$ s= $`()\[\]` とするとスコアが $ A_1+A_2+B_3+B_4=12 $ になり，これが最大です．

## 样例 #1

### 输入

```
4

4 2 3 1

2 3 2 4
```

### 输出

```
12
```

## 样例 #2

### 输入

```
10

866111664 844917655 383133839 353498483 472381277 550309930 378371075 304570952 955719384 705445072

178537096 218662351 231371336 865935868 579910117 62731178 681212831 16537461 267238505 318106937
```

### 输出

```
6629738472
```



---

---
title: "[AGC048C] Penguin Skating"
layout: "post"
diff: 提高+/省选-
pid: AT_agc048_c
tag: ['贪心']
---

# [AGC048C] Penguin Skating

## 题目描述

[problemUrl]: https://atcoder.jp/contests/agc048/tasks/agc048_c

$ L $ 個のマスが横一列に並んでいます． マスは左から順に $ 1,2,\ldots,L $ と番号が振られています．

$ N $ 匹のペンギンがマス目の上にいます． ペンギンは左から順に $ 1,2,\ldots,N $ と番号が振られています． 最初，ペンギン $ i $ はマス $ A_i $ の上にいます． ここで，$ 1\ \leq\ A_1\ <\ A_2\ <\ \ldots\ <\ A_N\ \leq\ L $ です．

あなたは，次の操作を好きな回数行うことができます．

- ペンギンを $ 1 $ 匹選び，左または右へ向かって滑らせる． ペンギンは，目の前に空マスがある限り滑り続ける． 別のペンギンのいるマスの直前のマスに到達する，もしくは目の前にマスが存在しなくなったら，ペンギンは停止する．

例えば，$ N=3,L=10 $ で，ペンギンのいるマスが $ (2,3,7) $ であるとします． このとき，ペンギン $ 2 $ を右に滑らせると，ペンギン $ 2 $ はマス $ 6 $ まで移動します． また，ペンギン $ 3 $ を右に滑らせると，ペンギン $ 3 $ はマス $ 10 $ まで移動します．

あなたの目標は，すべての $ i $ について，ペンギン $ i $ がマス $ B_i $ の上にいるようにすることです． ここで，$ 1\ \leq\ B_1\ <\ B_2\ <\ \ldots\ <\ B_N\ \leq\ L $ です． 目標が達成可能か判定し，可能ならば必要な操作回数の最小値を求めてください．

## 输入格式

入力は以下の形式で標準入力から与えられる．

> $ N $ $ L $ $ A_1 $ $ A_2 $ $ \cdots $ $ A_N $ $ B_1 $ $ B_2 $ $ \cdots $ $ B_N $

## 输出格式

目標が達成不可能な場合は $ -1 $ を，可能な場合は必要な操作回数の最小値を出力せよ．

## 说明/提示

### 制約

- $ 1\ \leq\ N\ \leq\ 10^5 $
- $ N\ \leq\ L\ \leq\ 10^9 $
- $ 1\ \leq\ A_1\ <\ A_2\ <\ \ldots\ <\ A_N\ \leq\ L $
- $ 1\ \leq\ B_1\ <\ B_2\ <\ \ldots\ <\ B_N\ \leq\ L $
- 入力される数はすべて整数．

### Sample Explanation 1

次のように操作すればよいです． - ペンギン $ 1 $ を左に滑らせる．ペンギンの位置は，$ (1,4,6,10) $ になる． - ペンギン $ 2 $ を右に滑らせる．ペンギンの位置は，$ (1,5,6,10) $ になる． - ペンギン $ 4 $ を右に滑らせる．ペンギンの位置は，$ (1,5,6,11) $ になる．

## 样例 #1

### 输入

```
4 11

3 4 6 10

1 5 6 11
```

### 输出

```
3
```

## 样例 #2

### 输入

```
1 3

1

2
```

### 输出

```
-1
```

## 样例 #3

### 输入

```
10 1000000000

65110170 68805223 123016442 275946481 661490312 760727752 764540566 929355340 930658577 947099792

1 2 123016442 661490311 929355337 930658574 999999997 999999998 999999999 1000000000
```

### 输出

```
13
```



---

---
title: "[AGC049C] Robots"
layout: "post"
diff: 提高+/省选-
pid: AT_agc049_c
tag: ['贪心', '二分']
---

# [AGC049C] Robots

## 题目描述

[problemUrl]: https://atcoder.jp/contests/agc049/tasks/agc049_c

数直線上にロボットがいます． 具体的には，各 $ i=0,1,2,\cdots,10^{100} $ について，座標 $ i $ に $ 1 $ 台のロボットがおり，ロボット $ i $ と呼ばれています．

たくさんのボールがあります． それぞれのボールには，正整数が $ 1 $ つ書いてあります． これらのボールの情報は，長さ $ N $ の整数列 $ A $ と $ B $ で表されます． 具体的には，各 $ i $ ($ 1\ \leq\ i\ \leq\ N $) について，$ A_i $ の書かれたボールが $ B_i $ 個あります．

今からすぬけくんは，次の操作を行います．

- Step 1: $ 0 $ 個以上のボールを選び，そこに書かれている整数を，$ 1 $ 以上 $ 10^{100} $ 以下の好きな**正整数**に書き換える．（ボールごとに書き換える整数を選択できる）
- Step 2: ボールを $ 1 $ つずつ食べる．ボールを食べる順番は自由に選べる．ボールを食べるたびに，以下の操作を行う．
  
  
  - 今食べたボールに書かれた整数を $ v $ とする．ロボット $ v $ が存在するなら，それを，現在の座標より $ 1 $ 小さい座標へ移動させる．もし移動先に別のロボットがいるなら，そのロボットは破壊される．（ロボット $ v $ は無事である）

すぬけくんは，ロボット $ 0 $ が破壊されないように，すべてのボールを食べきりたいです． すぬけくんが目標を達成するために Step 1 で書き換える必要のあるボールの個数の最小値を求めてください．

## 输入格式

入力は以下の形式で標準入力から与えられる．

> $ N $ $ A_1 $ $ A_2 $ $ \ldots $ $ A_N $ $ B_1 $ $ B_2 $ $ \ldots $ $ B_N $

## 输出格式

答えを出力せよ．

## 说明/提示

### 制約

- $ 1\ \leq\ N\ \leq\ 2\ \times\ 10^5 $
- $ 1\ \leq\ A_1\ <\ A_2\ <\ \ldots\ <\ A_N\ \leq\ 10^9 $
- $ 1\ \leq\ B_i\ \leq\ 10^9 $

### Sample Explanation 1

$ 2 $ の書かれたボールを $ 1 $ つ選び，$ 3 $ に書き換えればよいです． その後，以下の順序でボールを食べればよいです． - $ 2 $ の書かれたボールを食べる．ロボット $ 2 $ を座標 $ 2 $ から座標 $ 1 $ へ移動させる． ロボット $ 1 $ が破壊される． - $ 3 $ の書かれたボールを食べる．ロボット $ 3 $ を座標 $ 3 $ から座標 $ 2 $ へ移動させる． - $ 3 $ の書かれたボールを食べる．ロボット $ 3 $ を座標 $ 2 $ から座標 $ 1 $ へ移動させる． ロボット $ 2 $ が破壊される． - $ 1 $ の書かれたボールを食べる．ロボット $ 1 $ はすでに破壊されているので，何もしない．

## 样例 #1

### 输入

```
3

1 2 3

1 2 1
```

### 输出

```
1
```

## 样例 #2

### 输入

```
4

1 3 5 7

3 1 4 1
```

### 输出

```
0
```



---

---
title: "[AGC054C] Roughly Sorted"
layout: "post"
diff: 提高+/省选-
pid: AT_agc054_c
tag: ['贪心', '排列组合']
---

# [AGC054C] Roughly Sorted

## 题目描述

[problemUrl]: https://atcoder.jp/contests/agc054/tasks/agc054_c

すぬけくんは，$ (1,\ 2,\ ...\ N) $ の順列 $ P=(P_1,P_2,\cdots,P_N) $ と整数 $ K $ をもらいました． そこですぬけくんは，$ P $ の隣接する二項をswapすることを繰り返して，以下の条件が満たされるようにしました．

- それぞれの $ 1\ \leq\ i\ \leq\ N $ について， $ 1\ \leq\ j\ <\ i $, $ P_j\ >\ P_i $ を満たす $ j $ が高々 $ K $ 個である．

ここで，すぬけくんは**最小**の操作回数でこの条件を達成しました．

すべての操作が終わったあと，すぬけくんは元の順列を忘れてしまいました． 操作後の順列 $ P' $ が与えられるので，元の順列 $ P $ としてあり得るものが何通りあるかを $ 998244353 $ で割った余りを求めてください．

## 输入格式

入力は以下の形式で標準入力から与えられる．

> $ N $ $ K $ $ P'_1 $ $ P'_2 $ $ \cdots $ $ P'_N $

## 输出格式

答えを出力せよ．

## 说明/提示

### 制約

- $ 2\ \leq\ N\ \leq\ 5000 $
- $ 1\ \leq\ K\ \leq\ N-1 $
- $ 1\ \leq\ P'_i\ \leq\ N $
- $ P'_i\ \neq\ P'_j $ ($ i\ \neq\ j $)
- それぞれの $ 1\ \leq\ i\ \leq\ N $ について， $ 1\ \leq\ j\ <\ i $, $ P'_j\ >\ P'_i $ を満たす $ j $ が高々 $ K $ 個である
- 入力される値はすべて整数である

### Sample Explanation 1

$ P $ として考えられるのは以下の $ 2 $ 通りです． - $ P=(3,1,2) $: 最小の操作回数は $ 0 $ 回です．操作後の順列は $ P' $ に一致します． - $ P=(3,2,1) $: 最小の操作回数は $ 1 $ 回です．$ P_2 $ と $ P_3 $ をswapすることで，$ P=(3,1,2) $ となり，これは条件を満たします．操作後の順列は $ P' $ に一致します．

## 样例 #1

### 输入

```
3 1

3 1 2
```

### 输出

```
2
```

## 样例 #2

### 输入

```
4 3

4 3 2 1
```

### 输出

```
1
```

## 样例 #3

### 输入

```
5 2

4 2 1 5 3
```

### 输出

```
3
```



---

---
title: "[AGC057B] 2A + x"
layout: "post"
diff: 提高+/省选-
pid: AT_agc057_b
tag: ['数学', '贪心']
---

# [AGC057B] 2A + x

## 题目描述

[problemUrl]: https://atcoder.jp/contests/agc057/tasks/agc057_b

正整数列 $ A\ =\ (A_1,\ A_2,\ \ldots,\ A_N) $ および正整数 $ X $ が与えられます。あなたはこの数列に対して、次の操作を何度でも行うことができます（$ 0 $ 回でもよい）：

- 添字 $ i $ （$ 1\leq\ i\leq\ N $）および、$ 0\leq\ x\leq\ X $ となる非負整数 $ x $ を選ぶ。$ A_i $ を $ 2A_i+x $ に変更する。

操作結果の $ \max\{A_1,A_2,\ldots,A_N\}-\min\{A_1,A_2,\ldots,A_N\} $ としてありうる最小値を求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられます。

> $ N $ $ X $ $ A_1 $ $ A_2 $ $ \ldots $ $ A_N $

## 输出格式

操作結果の $ \max\{A_1,A_2,\ldots,A_N\}-\min\{A_1,A_2,\ldots,A_N\} $ としてありうる最小値を出力してください。

## 说明/提示

### 制約

- $ 2\leq\ N\leq\ 10^5 $
- $ 1\leq\ X\leq\ 10^9 $
- $ 1\leq\ A_i\leq\ 10^9 $

### Sample Explanation 1

$ A_i $ を $ 2A_i+x $ に変更する操作を $ (i,\ x) $ と表すことにします。最適な操作列の一例は次の通りです。 - $ (1,0) $, $ (1,1) $, $ (2,2) $, $ (3,0) $ 操作結果は $ A\ =\ (21,\ 18,\ 24,\ 20) $ となり、$ \max\{A_1,A_2,A_3,A_4\}-\min\{A_1,A_2,A_3,A_4\}\ =\ 6 $ が達成できます。

### Sample Explanation 2

最適な操作列の一例は次の通りです。 - $ (1,5) $, $ (1,5) $, $ (2,5) $, $ (2,1) $, $ (3,2) $, $ (3,3) $, $ (4,0) $, $ (4,3) $ 操作結果は $ A\ =\ (111,111,111,111) $ となり、$ \max\{A_1,A_2,A_3,A_4\}-\min\{A_1,A_2,A_3,A_4\}\ =\ 0 $ が達成できます。

### Sample Explanation 3

一度も操作を行わないことにより、$ \max\{A_1,A_2,A_3,A_4\}-\min\{A_1,A_2,A_3,A_4\}\ =\ 3 $ が達成できます。

## 样例 #1

### 输入

```
4 2

5 8 12 20
```

### 输出

```
6
```

## 样例 #2

### 输入

```
4 5

24 25 26 27
```

### 输出

```
0
```

## 样例 #3

### 输入

```
4 1

24 25 26 27
```

### 输出

```
3
```

## 样例 #4

### 输入

```
10 5

39 23 3 7 16 19 40 16 33 6
```

### 输出

```
13
```



---

---
title: "[AGC060B] Unique XOR Path"
layout: "post"
diff: 提高+/省选-
pid: AT_agc060_b
tag: ['贪心']
---

# [AGC060B] Unique XOR Path

## 题目描述

[problemUrl]: https://atcoder.jp/contests/agc060/tasks/agc060_b

$ N $ 行 $ M $ 列のグリッドがあります． あなたはグリッドの各マスに $ 0 $ 以上 $ 2^K-1 $ 以下の整数を書き込み，以下の条件を満たしたいです．

- 左上のマスを出発し，右または下に隣接するマスへの移動を繰り返して，右下のマスへと至るパスを考える． ここで，通ったマス (始点終点を含む) に書かれた整数の総 $ \mathrm{XOR} $ が $ 0 $ になるパスを，**よい**パスと呼ぶことにする．
- よいパスはちょうど $ 1 $ つだけ存在し，それは文字列 $ S $ が表すパスである． 文字列 $ S $ が表すパスとは，各 $ i $ ($ 1\ \leq\ i\ \leq\ N+M-2 $) について，$ i $ 回目の移動の際，$ S $ の $ i $ 文字目が `R` なら右，`D` なら下に進むようなパスである．

条件を満たす整数の書き込み方が存在するかどうか判定してください．

$ 1 $ つの入力ファイルにつき，$ T $ 個のテストケースを解いてください．

  ビット単位 $ \mathrm{XOR} $ 演算とは  非負整数 $ A,\ B $ のビット単位 $ \mathrm{XOR} $ 、$ A\ \oplus\ B $ は、以下のように定義されます。

- $ A\ \oplus\ B $ を二進表記した際の $ 2^k $ ($ k\ \geq\ 0 $) の位の数は、$ A,\ B $ を二進表記した際の $ 2^k $ の位の数のうち一方のみが $ 1 $ であれば $ 1 $、そうでなければ $ 0 $ である。
 
 例えば、$ 3\ \oplus\ 5\ =\ 6 $ となります (二進表記すると: $ 011\ \oplus\ 101\ =\ 110 $)。  
 一般に $ k $ 個の非負整数 $ p_1,\ p_2,\ p_3,\ \dots,\ p_k $ のビット単位 $ \mathrm{XOR} $ は $ (\dots\ ((p_1\ \oplus\ p_2)\ \oplus\ p_3)\ \oplus\ \dots\ \oplus\ p_k) $ と定義され、これは $ p_1,\ p_2,\ p_3,\ \dots,\ p_k $ の順番によらないことが証明できます。

## 输入格式

入力は以下の形式で標準入力から与えられる．

> $ T $ $ case_1 $ $ case_2 $ $ \vdots $ $ case_T $

各ケースは以下の形式で与えられる．

> $ N $ $ M $ $ K $ $ S $

## 输出格式

各ケースに対し，条件を満たす整数の書き込み方が存在する場合は `Yes` を，存在しないならば `No` を出力せよ． 出力中の各文字は英大文字・小文字のいずれでもよい．

## 说明/提示

### 制約

- $ 1\ \leq\ T\ \leq\ 100 $
- $ 2\ \leq\ N,M\ \leq\ 30 $
- $ 1\ \leq\ K\ \leq\ 30 $
- $ S $ はちょうど $ N-1 $ 個の `D` と $ M-1 $ 個の `R` からなる文字列
- 入力される数はすべて整数

### Sample Explanation 1

例えば $ 1 $ ケース目については，以下のようなグリッドを作れば良いです． ``` 11 00 ```

## 样例 #1

### 输入

```
4
2 2 1
RD
4 3 1
RDDDR
15 20 18
DDRRRRRRRDDDDRRDDRDRRRRDDRDRDDRRR
20 15 7
DRRDDDDDRDDDRRDDRRRDRRRDDDDDRRRDD
```

### 输出

```
Yes
No
Yes
No
```



---

---
title: "[AGC065A] Shuffle and mod K"
layout: "post"
diff: 提高+/省选-
pid: AT_agc065_a
tag: ['贪心']
---

# [AGC065A] Shuffle and mod K

## 题目描述

[problemUrl]: https://atcoder.jp/contests/agc065/tasks/agc065_a

長さ $ N $ の整数列 $ A=(A_1,A_2,\dots,A_N) $ が与えられます。

あなたは $ A $ を自由に並び替えることが出来ます。並び替えた後の $ \sum_{i=1}^{N-1}\ ((A_{i+1}\ -\ A_i)\ \bmod\ K) $ としてあり得る最大値を求めてください。

ここで、$ x\ \bmod\ K $ とは $ 0\ \le\ y\ <\ K $ かつ $ x\ -\ y $ が $ K $ の倍数になる整数 $ y $ のことを指します。例えば、$ -3\ \bmod\ 8\ =\ 5,9\ \bmod\ 6\ =\ 3 $ となります。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ K $ $ A_1 $ $ A_2 $ $ \dots $ $ A_N $

## 输出格式

答えを出力せよ。

## 说明/提示

### 制約

- $ 2\ \le\ N\ \le\ 2\ \times\ 10^5 $
- $ 1\ \le\ K\ \le\ 10^9 $
- $ 0\ \le\ A_i\ <\ K $
 
### Sample Explanation 1

最適な例として、$ A\ =\ (2,1,0) $ と並び替えると $ (1\ -\ 2)\ \bmod\ 4\ +\ (0\ -\ 1)\ \bmod\ 4\ =\ 3\ +\ 3\ =\ 6 $ が達成できます。

## 样例 #1

### 输入

```
3 4

0 1 2
```

### 输出

```
6
```

## 样例 #2

### 输入

```
7 123

11 34 56 0 32 100 78
```

### 输出

```
638
```



---

---
title: "[ARC053C] 魔法使い高橋君"
layout: "post"
diff: 提高+/省选-
pid: AT_arc053_c
tag: ['贪心', '排序']
---

# [ARC053C] 魔法使い高橋君

## 题目描述

高桥君会 $N$ 个魔法。将这些魔法分别编号为 $1$ 到 $N$ 。

开始时，气温为 $0$ 度。高桥君咏唱第 $i$ 个魔法后，气温会先上升 $a_i$ 度再下降 $b_i$ 度。

高桥君会将所有魔法都咏唱一遍。这期间气温的最大值为 $X$ 度。高桥君可以自己决定咏唱魔法的顺序，来使 $X$ 的值尽量小。

求最小的 $X$ 值。

## 输入格式

输入按以下形式：
$$ N $$
$$ a_1 \space b_1 $$
$$ : $$
$$ a_N \space b_N $$

## 输出格式

输出 $X$ 的最小值。

## 输入输出样例
### 输入样例1
```
1
10 20
```
### 输出样例1
```
10
```
### 样例解释1
咏唱唯一一个魔法。气温的变化如下：$0 → 10 → -10$ 。
### 输入样例2
```
2
30 20
10 20
```
### 输出样例2
```
20
```
### 样例解释2
先咏唱第 $2$ 个魔法，再咏唱第 $1$ 个魔法，气温变化如下： $0 →10 → -10 → 20 → 0$ 。
### 输入样例3
```
5
5 10
10 5
10 15
15 10
20 20
```
### 输出样例3
```
10
```
### 样例解释3
举例来说，可以按 $1,3,5,2,4$ 的顺序咏唱魔法。

## 说明/提示

- $1 \le N \le 10^5$
- $a_i,b_i$ 都是整数。
- $1 \le a_i,b_i \le 10^9$



---

---
title: "[ARC111C] Too Heavy"
layout: "post"
diff: 提高+/省选-
pid: AT_arc111_c
tag: ['贪心']
---

# [ARC111C] Too Heavy

## 题目描述

[problemUrl]: https://atcoder.jp/contests/arc111/tasks/arc111_c

$ 1 $ から $ N $ の番号がついた $ N $ 人の人間と、同じく $ 1 $ から $ N $ の番号がついた $ N $ 個の荷物があります。 人 $ i $ の体重は $ a_i $, 荷物 $ j $ の重さは $ b_j $ です。 はじめ人 $ i $ は 荷物 $ p_i $ を持っており、以下の操作を $ 0 $ 回以上繰り返すことで全ての人が自分と同じ番号の荷物を持っている状態にしたいです。

- $ i,j\ (i\ \neq\ j) $ を選び、人 $ i $ と人 $ j $ の荷物を交換する。

ただし、人は自分の体重**以上**の重さの荷物を持つと疲れてしまい、その後一切操作には加われません (すなわち、$ i,j $として選べません)。 特に、 $ a_i\ \leq\ b_{p_i} $ なら一度も操作に加われません。

条件を満たす操作列があるか判定し、存在するならばそのうち**操作回数が最小**であるものをひとつ構成してください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ a_1 $ $ a_2 $ $ \ldots $ $ a_N $ $ b_1 $ $ b_2 $ $ \ldots $ $ b_N $ $ p_1 $ $ p_2 $ $ \ldots $ $ p_N $

## 输出格式

どのように操作しても条件を満たせない場合、`-1` を出力せよ。 条件を満たすことが可能な場合、以下のフォーマットで操作列を出力せよ。

> $ K $ $ i_1 $ $ j_1 $ $ i_2 $ $ j_2 $ $ : $ $ i_K $ $ j_K $

ここで $ K $ は操作回数であり、 $ i_t,j_t $ は $ t $ 回目の操作で選んだ人間の番号である。

解が複数存在する場合、どれを出力しても構わない。

## 说明/提示

### 制約

- $ 1\ \leq\ N\ \leq\ 200000 $
- $ 1\ \leq\ a_i,b_i\ \leq\ 10^9 $
- $ p $ は $ 1,\ \ldots\ ,N $ の順列
- 入力される数はすべて整数

### Sample Explanation 1

初期状態で人 $ 1,2,3,4 $ が持っている荷物の重さはそれぞれ $ 1,3,3,5 $ なので、初期状態では誰も疲れていません。 まず人 $ 3 $ と $ 4 $ で操作をします。人 $ 1,2,3,4 $ が持っている荷物の重さはそれぞれ $ 1,3,5,3 $ なので、まだ誰も疲れていません。 次に人 $ 1 $ と $ 3 $ で操作をします。人 $ 1,2,3,4 $ が持っている荷物の重さはそれぞれ $ 5,3,1,3 $ なので、人 $ 1 $ が疲れます。 最後に人 $ 4 $ と $ 2 $ で操作をします。人 $ 1,2,3,4 $ が持っている荷物の重さはそれぞれ $ 5,3,1,3 $ なので、これで新たに疲れる人はいません。 これによって全員が正しい荷物を持っている状態になり、さらにこれは最小の操作回数なので、正しい出力の一つです。

### Sample Explanation 2

条件を満たすように操作することは出来ません。

### Sample Explanation 3

初期状態で条件を満たしています。

## 样例 #1

### 输入

```
4

3 4 8 6

5 3 1 3

3 4 2 1
```

### 输出

```
3

3 4

1 3

4 2
```

## 样例 #2

### 输入

```
4

1 2 3 4

4 3 2 1

4 3 2 1
```

### 输出

```
-1
```

## 样例 #3

### 输入

```
1

58

998244353

1
```

### 输出

```
0
```



---

---
title: "[ARC116E] Spread of Information"
layout: "post"
diff: 提高+/省选-
pid: AT_arc116_e
tag: ['动态规划 DP', '贪心', '二分', '树形 DP']
---

# [ARC116E] Spread of Information

## 题目描述

[problemUrl]: https://atcoder.jp/contests/arc116/tasks/arc116_e

高橋国には $ N $ 箇所の町があり、それぞれ町 $ 1 $ 、町 $ 2 $、 $ \ldots $ 、町 $ N $ と名付けられています。 この国には $ N-1 $ 本の道があり、 $ i $ 本目の道は 町 $ u_i $ と町 $ v_i $ を双方向に結びます。任意の $ 2 $ つの町 $ a $, $ b $ について、いくつかの道を通ることにより、町 $ a $ から町 $ b $ へ移動することが出来ます。

高橋国王は、ある情報を国土全体に流そうとしています。多忙な高橋国王は、 $ K $ 箇所までの町にしか直接情報を伝達することが出来ません。

高橋国王の情報伝達が終わった瞬間を時刻 $ 0 $ とします。 $ t\ =\ 1,\ 2,\ 3,\ \cdots $ について、以下の現象が発生します。

- $ 1 $ 本の道で直接結ばれている町の組 $ a $, $ b $ について、 時刻 $ t-0.5 $ に町 $ a $ に情報が伝わっており、町 $ b $ に情報が伝わっていないとき、 時刻 $ t $ に町 $ b $ にも情報が伝わる。

高橋国王は $ K $ 箇所の連絡先を適切に選択し、全ての町に情報が伝わるまでに掛かる時間を最小化しようと考えています。最小値を答えてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ K $ $ u_1 $ $ v_1 $ $ u_2 $ $ v_2 $ $ \vdots $ $ u_{N-1} $ $ v_{N-1} $

## 输出格式

答えを出力せよ。

## 说明/提示

### 制約

- 入力は全て整数
- $ 1\ \leq\ K\ <\ N\ \leq\ 2\ \times\ 10^5 $
- $ 1\ \leq\ u_i,\ v_i\ \leq\ N $
- 任意の $ 2 $ つの町 $ a $, $ b $ について、いくつかの道を通ることにより、町 $ a $ から町 $ b $ へ移動することが出来る。

### Sample Explanation 1

高橋国王が町 $ 2 $ と町 $ 4 $ に直接情報を伝達した場合、町 $ 1 $ 、 $ \ldots $ 、町$ 5 $ に初めて情報が伝わる時刻は、それぞれ $ 1,\ 0,\ 1,\ 0,\ 1 $ となります。このとき、 国土全体に情報が広まるのは時刻 $ 1 $ であり、これが達成可能な最小値であることが証明出来ます。

## 样例 #1

### 输入

```
5 2

1 2

2 3

3 4

4 5
```

### 输出

```
1
```

## 样例 #2

### 输入

```
5 1

1 2

1 3

1 4

5 4
```

### 输出

```
2
```

## 样例 #3

### 输入

```
20 3

2 15

6 5

12 1

7 9

17 2

15 5

2 4

17 16

12 2

8 17

17 19

18 11

20 8

20 3

13 9

11 10

11 20

14 8

11 7
```

### 输出

```
3
```



---

---
title: "[ARC124D] Yet Another Sorting Problem"
layout: "post"
diff: 提高+/省选-
pid: AT_arc124_d
tag: ['贪心', '并查集', '图论建模', 'Ad-hoc']
---

# [ARC124D] Yet Another Sorting Problem

## 题目描述

[problemUrl]: https://atcoder.jp/contests/arc124/tasks/arc124_d

$ (1,2\ \ldots,\ N+M) $ を並べ替えて得られる長さ $ N+M $ の数列 $ p $ が与えられます。 $ p $ の $ i $ 番目の数は $ p_i $ です。

あなたは以下の **操作** を何回でも行うことができます。

操作：$ 1 $ 以上 $ N $ 以下の整数 $ n $ と $ 1 $ 以上 $ M $ 以下の整数 $ m $ を選び、$ p_{n} $ と $ p_{N+m} $ を交換する

$ p $ を昇順に並べ替えるために必要な最小の操作回数を求めてください。この問題の制約下で $ p $ を昇順に並べ替えることができることが証明できます。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ M $ $ p_{1} $ $ \cdots $ $ p_{N+M} $

## 输出格式

$ p $ を昇順に並べ替えるために必要な最小の操作回数を出力せよ。

## 说明/提示

### 制約

- 与えられる入力は全て整数
- $ 1\ \leq\ N,M\ \leq\ 10^5 $
- $ 1\ \leq\ p_i\ \leq\ N+M $
- $ p $ は $ (1,2\ \ldots,\ N+M) $ を並べ替えて得られる

## 样例 #1

### 输入

```
2 3

1 4 2 5 3
```

### 输出

```
3
```

## 样例 #2

### 输入

```
5 7

9 7 12 6 1 11 2 10 3 8 4 5
```

### 输出

```
10
```



---

---
title: "[ARC137C] Distinct Numbers"
layout: "post"
diff: 提高+/省选-
pid: AT_arc137_c
tag: ['贪心', '博弈论']
---

# [ARC137C] Distinct Numbers

## 题目描述

给定长为 $N$ 的非负整数列 $A=(A_1,\dots,A_N)$，保证 $A$ 中元素互不相同。

Alice 和 Bob 在玩游戏。Alice 为先手，两人轮流操作。每次操作选手可以如下进行：

+ 选择当前 $A$ 中最大的元素，将其替换为一个更小的非负整数。要求替换后 $A$ 中元素仍然互不相同。

首先无法操作的一方失败。当两人都采取最优策略时，求谁有必胜策略。

## 输入格式

第一行一个正整数 $N$；

第二行 $N$ 个非负整数表示 $A_1,\dots,a_N$。

## 输出格式

如果 Alice 有必胜策略则输出 `Alice`，如果 Bob 有必胜策略则输出 `Bob`。

## 说明/提示

+ $2 \le N \le 3 \times 10^5$

+ $0 \le A_1<A_2<\dots<A_N\le10^9$

#### 样例 1 解释

第一回合 Alice 可以将 $4$ 变为 $0,1,3$，如果 Alice 将 $4$ 变为 $0,1$ 中的一个，则 Bob 可以将 $2$ 变为 $0,1$ 中另一个，Alice 无法操作从而落败；如果 Alice 将 $4$ 变为 $3$，则此时 Bob 需要将 $3$ 变为 $0,1$ 中一个，同上知 Bob 必败。因此 Alice 有必胜策略。

## 样例 #1

### 输入

```
2

2 4
```

### 输出

```
Alice
```

## 样例 #2

### 输入

```
3

0 1 2
```

### 输出

```
Bob
```



---

---
title: "[ARC166D] Interval Counts"
layout: "post"
diff: 提高+/省选-
pid: AT_arc166_d
tag: ['贪心']
---

# [ARC166D] Interval Counts

## 题目描述

[problemUrl]: https://atcoder.jp/contests/arc166/tasks/arc166_d

$ x_1\ <\ \cdots\ <\ x_N $ を満たす正整数 $ x_1,\ \ldots,\ x_N $ および，正整数 $ y_1,\ \ldots,\ y_N $ が与えられます．

組 $ (M,\ L_1,\ R_1,\ \ldots,\ L_M,\ R_M) $ であって，以下の条件を全て満たすものを考えます：

- $ M $ は正整数である．
- 各 $ j\ (1\leq\ j\leq\ M) $ に対して，$ L_j,\ R_j $ は $ L_j\leq\ R_j $ を満たす整数である．
- 各 $ i\ (1\leq\ i\leq\ N) $ に対して，$ L_j\leq\ x_i\leq\ R_j $ を満たす $ j\ (1\leq\ j\leq\ M) $ がちょうど $ y_i $ 個存在する．
 
このような組は必ず存在することが証明できます．そのような組に対する $ \min\ \lbrace\ R_j-L_j\mid\ 1\leq\ j\leq\ M\rbrace $ としてありうる最大値を求めてください．ただし，最大値が存在しない場合には `-1` を出力してください．

## 输入格式

入力は以下の形式で標準入力から与えられます．

> $ N $ $ x_1 $ $ \cdots $ $ x_N $ $ y_1 $ $ \cdots $ $ y_N $

## 输出格式

条件を満たす組に対する $ \min\ \lbrace\ R_j-L_j\mid\ 1\leq\ j\leq\ M\rbrace $ としてありうる最大値を出力してください．ただし，最大値が存在しない場合には `-1` を出力してください．

## 说明/提示

### 制約

- $ 1\leq\ N\leq\ 2\times\ 10^5 $
- $ 1\leq\ x_1\ <\ \cdots\ <\ x_N\ \leq\ 10^9 $
- $ 1\leq\ y_i\ \leq\ 10^9 $
 
### Sample Explanation 1

例えば組 $ (3,\ 1,\ 4,\ 2,\ 4,\ 3,\ 5) $ に対して $ \min\ \lbrace\ R_j-L_j\mid\ 1\leq\ j\leq\ M\rbrace\ =\ 2 $ が成り立ちます．

### Sample Explanation 2

例えば組 $ (3,\ -1000,\ 10,\ -1000,\ 1000,\ 10,\ 1000) $ に対して $ \min\ \lbrace\ R_j-L_j\mid\ 1\leq\ j\leq\ M\rbrace\ =\ 990 $ が成り立ちます．$ \min\ \lbrace\ R_j-L_j\mid\ 1\leq\ j\leq\ M\rbrace $ の最大値は存在しません．

## 样例 #1

### 输入

```
3

1 3 5

1 3 1
```

### 输出

```
2
```

## 样例 #2

### 输入

```
3

1 10 100

2 3 2
```

### 输出

```
-1
```

## 样例 #3

### 输入

```
7

10 31 47 55 68 73 90

3 7 4 6 3 4 4
```

### 输出

```
56
```



---

---
title: "[ARC167D] Good Permutation"
layout: "post"
diff: 提高+/省选-
pid: AT_arc167_d
tag: ['贪心', '并查集']
---

# [ARC167D] Good Permutation

## 题目描述

[problemUrl]: https://atcoder.jp/contests/arc167/tasks/arc167_d

この問題では順列と言った際には $ (1,2,\dots\ ,N) $ の順列を指すものとします。

順列 $ P=(P_{1},P_{2},\dots\ ,P_{N}) $ が与えられます。

ここで、以下の条件を満たす順列 $ Q=(Q_{1},Q_{2},\dots\ ,Q_{N}) $ を良い順列とします。

- 任意の整数 $ 1\leq\ x\leq\ N $ について、 $ x\leftarrow\ Q_{x} $ という置換を好きな回数繰り返すことで、 $ x $ を $ 1 $ にすることができる。
 
$ P $ に対して、以下の操作を $ 0 $ 回以上行うことで、 $ P $ を良い順列にしたいです。

- $ 1\leq\ i\lt\ j\ \leq\ N $ を満たす整数 $ i,j $ を選んで、 $ P_{i} $ と $ P_{j} $ を入れ替える
 
$ P $ を良い順列にするのに必要な最小の操作回数を $ M $ としたとき、 $ P $ に対し操作を $ M $ 回行うことで得られる良い順列のうち、辞書式順序で最小のものを求めてください。

$ 1 $ つの入力ファイルにつき $ T $ 個のテストケースが与えられるので、それぞれについて解いてください。

  数列の辞書順とは？数列 $ S\ =\ (S_1,S_2,\ldots,S_{|S|}) $ が数列 $ T\ =\ (T_1,T_2,\ldots,T_{|T|}) $ より**辞書順で小さい**とは、下記の 1. と 2. のどちらかが成り立つことを言います。 ここで、$ |S|,\ |T| $ はそれぞれ $ S,\ T $ の長さを表します。

1. $ |S|\ \lt\ |T| $ かつ $ (S_1,S_2,\ldots,S_{|S|})\ =\ (T_1,T_2,\ldots,T_{|S|}) $。
2. ある整数 $ 1\ \leq\ i\ \leq\ \min\lbrace\ |S|,\ |T|\ \rbrace $ が存在して、下記の $ 2 $ つがともに成り立つ。 
  - $ (S_1,S_2,\ldots,S_{i-1})\ =\ (T_1,T_2,\ldots,T_{i-1}) $
  - $ S_i $ が $ T_i $ より（数として）小さい。

## 输入格式

入力は以下の形式で標準入力から与えられます。

> $ T $ $ \text{case}_{1} $ $ \text{case}_{2} $ $ \vdots $ $ \text{case}_{T} $

各ケースは以下の形式で与えられます。

> $ N $ $ P_{1} $ $ P_{2} $ $ \cdots $ $ P_{N} $

## 输出格式

$ T $ 行出力してください。 $ i $ 行目には $ \text{case}_{i} $ に対する答えの良い順列を空白区切りで出力してください。

## 说明/提示

### 制約

- $ 1\leq\ T\leq\ 10^{5} $
- $ 2\leq\ N\leq\ 2\times\ 10^{5} $
- $ (P_{1},P_{2},\dots\ ,P_{N}) $ は $ (1,2,\dots\ ,N) $ の順列
- $ 1 $ つの入力ファイルにつき、 $ N $ の総和は $ 2\times\ 10^{5} $ を超えない
- 入力は全て整数
 
### Sample Explanation 1

$ 1 $ つ目のテストケースについて $ P $ は良い順列ではありません。$ P_{1} $ と $ P_{3} $ を入れ替えると $ P=(4,1,2,3) $ となりますがこのとき $ P $ は良い順列となるので、 $ M=1 $ です。 他にも $ P_{2} $ と $ P_{4} $ を入れ替えると $ P=(2,3,4,1) $ となりますが、これは $ M=1 $ 回の操作で得られる良い順列のうち辞書順で最も小さいものになるため、これが答えです。

## 样例 #1

### 输入

```
5

4

2 1 4 3

5

2 1 3 4 5

2

1 2

2

2 1

9

4 3 6 2 7 1 9 8 5
```

### 输出

```
2 3 4 1

2 3 4 5 1

2 1

2 1

4 3 5 2 7 1 8 9 6
```



---

---
title: "[ARC170D] Triangle Card Game"
layout: "post"
diff: 提高+/省选-
pid: AT_arc170_d
tag: ['贪心', '博弈论']
---

# [ARC170D] Triangle Card Game

## 题目描述

[problemUrl]: https://atcoder.jp/contests/arc170/tasks/arc170_d

Alice と Bob でゲームをします．

はじめ，Alice, Bob はそれぞれ $ N $ 枚のカードを持っていて，Alice が持っている $ i $ 番目のカードには整数 $ A_i $ が，Bob が持っている $ i $ 番目のカードには整数 $ B_i $ が書かれてます．

ゲームは以下の手順で行われます．

- 何も書かれていない黒板を用意する．
- Alice が持っているカードを一枚食べ，食べたカードに書かれた整数を黒板に書く．
- 次に，Bob が持っているカードを一枚食べ，食べたカードに書かれた整数を黒板に書く．
- 最後に，Alice が持っているカードを一枚食べ，食べたカードに書かれた整数を黒板に書く．
 
黒板に書かれた $ 3 $ 個の整数を $ 3 $ 辺の長さとする（非退化な）三角形が存在すれば Alice の勝ちで，そうでないとき Bob の勝ちです．

両者が最適な行動をするとき，どちらが勝つか判定してください．

$ T $ 個のテストケースが与えられるので，それぞれについて答えてください．

## 输入格式

入力は以下の形式で標準入力から与えられる．

> $ T $ $ \mathrm{case}_1 $ $ \vdots $ $ \mathrm{case}_T $

各ケースは以下の形式で与えられる．

> $ N $ $ A_1 $ $ \ldots $ $ A_N $ $ B_1 $ $ \ldots $ $ B_N $

## 输出格式

$ T $ 行出力せよ．$ i $ 行目 $ (1\ \leq\ i\ \leq\ T) $ には， $ i $ 番目のテストケースについて，Alice が勝つ場合 `Alice` を，Bob が勝つ場合 `Bob` を出力せよ．

## 说明/提示

### 制約

- $ 1\ \leq\ T\ \leq\ 10^5 $
- $ 2\leq\ N\leq\ 2\times\ 10^5 $
- $ 1\leq\ A_i,B_i\leq\ 10^9 $
- 入力される数値は全て整数
- $ 1 $ つの入力に含まれるテストケースについて，$ N $ の総和は $ 2\times\ 10^5 $ 以下
 
### Sample Explanation 1

$ 1 $ 番目のテストケースでは，例えばゲームは以下のように進行します． - Alice が $ 2 $ を書かれたカードを食べ，黒板に $ 2 $ を書く． - Bob が $ 4 $ を書かれたカードを食べ，黒板に $ 4 $ を書く． - Alice が $ 1 $ を書かれたカードを食べ，黒板に $ 1 $ を書く． - 黒板に書かれた数は $ 2,4,1 $ であり，$ 3 $ 辺の長さが $ 2,4,1 $ であるような三角形は存在しないので Bob の勝ちとなる． このテストケースについて，上記の手順が必ずしも両者にとって最適な行動とは限りませんが，両者が最適な行動をした場合勝利するのは Bob であることが示せます．

## 样例 #1

### 输入

```
3

3

1 2 3

4 5 6

4

6 1 5 10

2 2 4 5

10

3 1 4 1 5 9 2 6 5 3

2 7 1 8 2 8 1 8 2 8
```

### 输出

```
Bob

Alice

Alice
```



---

---
title: "[ARC173C] Not Median"
layout: "post"
diff: 提高+/省选-
pid: AT_arc173_c
tag: ['贪心']
---

# [ARC173C] Not Median

## 题目描述

你有一个从 $1$ 到 $n$ 的整数排列 $P$ 。

对于所有 $ i=1,2,\dots,N $ ，输出满足以下所有条件的一对整数 $ (l,r) $ 的 $ r-l+1 $ 的最小值。如果不存在这样的 $ (l,r) $ ，则输出 `-1` 。

- $1 \le l \le i \le r \le N$ 。
- $r-l+1$ 是奇数。
- $ P_i $ **不是** $P$ 的子序列 $ (P_l,P_{l+1},\dots,P_r) $ 的中位数。

长度为 $ L $（奇数）的整数序列 $A$ 的中位数被定义为按升序对 $ A $ 排序后的序列 $ A' $ 的第 $ \frac{L+1}{2} $ 个值。

## 输入格式

输入来自标准输入，以 $ N $ $ P_1 $ $ P_2 $ $ \dots $ $ P_N $ 的格式输入。

## 输出格式

输出 $ i=1,2,\dots,N $ 的答案，用空格隔开。

### 样例解释1
例如，当 $ i=2 $ 时，若 $ (l,r)=(2,4) $ ，则 $ r-l+1=3 $ ，为奇数，且 $ (P_2,P_3,P_4)=(3,5,4) $ 的中位数是 $ 4 $ ，不是 $ P_2 $ ，满足条件, 因此答案是 $3$ 。   
当 $ i=4 $ 时，$ (l,r)=(4,4),(2,4),(3,5) $ 的中位数都是 $ P_4=4 $ 。 若 $ (l,r)=(1,5) $ ，则 $ (P_1,P_2,P_3,P_4,P_5)=(1,3,5,4,2) $ 的中位数为 $3$ ，不是 $ P_4 $ ，满足条件,因此答案是 $5$ 。

### 样例解释2
$ i=1 $ 时，不存在满足条件的整数组 $ (l,r) $ 。

### 数据规模与约定

- $ 3 \le N \le 3 \times 10^5 $。
- $ (P_1,P_2,\dots,P_N) $ 是从 $1$ 到 $n$ 的整数排列。
- 所有输入值都是整数。

## 样例 #1

### 输入

```
5

1 3 5 4 2
```

### 输出

```
3 3 3 5 3
```

## 样例 #2

### 输入

```
3

2 1 3
```

### 输出

```
-1 3 3
```

## 样例 #3

### 输入

```
14

7 14 6 8 10 2 9 5 4 12 11 3 13 1
```

### 输出

```
5 3 3 7 3 3 3 5 3 3 5 3 3 3
```



---

---
title: "[ARC175C] Jumping Through Intervals"
layout: "post"
diff: 提高+/省选-
pid: AT_arc175_c
tag: ['贪心']
---

# [ARC175C] Jumping Through Intervals

## 题目描述

[problemUrl]: https://atcoder.jp/contests/arc175/tasks/arc175_c

$ N $ 個の整数組 $ (L_1,\ R_1),\ (L_2,\ R_2),\ \dots,\ (L_N,\ R_N) $ が与えられます．ここで，全ての $ 1\leq\ i\leq\ N $ に対して $ L_i\ \leq\ R_i $ が満たされています．

$ N $ 個の整数からなる列 $ A\ =\ (A_1,\ A_2,\ \ldots,\ A_N) $ であって，以下の条件を満たすものを**良い整数列**と呼びます．

- 全ての $ 1\leq\ i\leq\ N $ に対して，$ L_i\ \leq\ A_i\ \leq\ R_i $ である．
 
$ \displaystyle\ \sum_{i\ =\ 1}^{N-1}\ |A_{i+1}\ -\ A_{i}| $ を最小にするような**良い整数列** $ A $ のうち，辞書順で最小のものを求めてください．

  数列の辞書順とは数列 $ S\ =\ (S_1,S_2,\ldots,S_{|S|}) $ が数列 $ T\ =\ (T_1,T_2,\ldots,T_{|T|}) $ より**辞書順で小さい**とは，下記の 1. と 2. のどちらかが成り立つことを言います． ここで，$ |S|,\ |T| $ はそれぞれ $ S,\ T $ の長さを表します．

1. $ |S|\ \lt\ |T| $ かつ $ (S_1,S_2,\ldots,S_{|S|})\ =\ (T_1,T_2,\ldots,T_{|S|}) $．
2. ある整数 $ 1\ \leq\ i\ \leq\ \min\lbrace\ |S|,\ |T|\ \rbrace $ が存在して，下記の $ 2 $ つがともに成り立つ． 
  - $ (S_1,S_2,\ldots,S_{i-1})\ =\ (T_1,T_2,\ldots,T_{i-1}) $．
  - $ S_i $ が $ T_i $ より（数として）小さい．

## 输入格式

入力は以下の形式で標準入力から与えられる．

> $ N $ $ L_1 $ $ R_1 $ $ L_2 $ $ R_2 $ $ \vdots $ $ L_N $ $ R_N $

## 输出格式

答えを以下の形式で $ 1 $ 行に出力せよ．

> $ A_1 $ $ A_2 $ $ \ldots $ $ A_N $

## 说明/提示

### 制約

- 入力される数値は全て整数
- $ 2\ \leq\ N\ \leq\ 5\ \times\ 10^5 $
- $ 0\ \leq\ L_i\ \leq\ R_i\ \leq\ 10^9 $
 
### Sample Explanation 1

$ (A_1,\ A_2,\ A_3,\ A_4)\ =\ (8,\ 8,\ 4,\ 5) $ は良い整数列です．このとき $ \sum_{i\ =\ 1}^{N-1}\ |A_{i+1}\ -\ A_{i}|\ =\ |8\ -\ 8|\ +\ |4\ -\ 8|\ +\ |5\ -\ 4|\ =\ 5 $ となり，これが $ \sum_{i\ =\ 1}^{N-1}\ |A_{i+1}\ -\ A_{i}| $ の最小の値です．

### Sample Explanation 2

$ \sum_{i\ =\ 1}^{N-1}\ |A_{i+1}\ -\ A_{i}| $ が最小となる良い数列 $ A $ が複数あるときは，そのうち辞書順で最小のものを出力することに注意してください．

## 样例 #1

### 输入

```
4

1 10

8 13

3 4

5 20
```

### 输出

```
8 8 4 5
```

## 样例 #2

### 输入

```
3

20 24

3 24

1 75
```

### 输出

```
20 20 20
```

## 样例 #3

### 输入

```
15

335279264 849598327

446755913 822889311

526239859 548830120

181424399 715477619

342858071 625711486

448565595 480845266

467825612 647639160

160714711 449656269

336869678 545923679

61020590 573085537

626006012 816372580

135599877 389312924

511429216 547865075

561330066 605997004

539239436 921749002
```

### 输出

```
526239859 526239859 526239859 467825612 467825612 467825612 467825612 449656269 449656269 449656269 626006012 389312924 511429216 561330066 561330066
```



---

---
title: "[ARC175D] LIS on Tree 2"
layout: "post"
diff: 提高+/省选-
pid: AT_arc175_d
tag: ['贪心']
---

# [ARC175D] LIS on Tree 2

## 题目描述

[problemUrl]: https://atcoder.jp/contests/arc175/tasks/arc175_d

頂点に $ 1 $ から $ N $ の番号がついた $ N $ 頂点の木があります．木の $ i $ 番目の辺は頂点 $ u_i $ と頂点 $ v_i $ を双方向に結んでいます．

$ (1,\ldots,N) $ の順列 $ P=(P_1,\ldots,P_N) $ に対し $ f(P) $ を以下で定めます．

- 頂点 $ i\ (1\leq\ i\leq\ N) $ に対し，頂点 $ 1 $ から頂点 $ i $ への単純パスを $ (v_1=1,v_2,\ldots,v_k=i) $ として，$ (P_{v_1},P_{v_2},\ldots,P_{v_k}) $ の最長増加部分列の長さを $ L_i $ とする．$ f(P)\ =\ \sum_{i=1}^N\ L_i $ と定める．
 
整数 $ K $ が与えられます．$ f(P)=K $ を満たす $ (1,\ldots,N) $ の順列 $ P $ が存在するか判定し，存在する場合は一つ示してください．

  最長増加部分列とは 数列の**部分列**とは，数列から $ 0 $ 個以上の要素を取り除いた後，残りの要素を元の順序で連結して得られる数列のことをいいます． 例えば，$ (10,30) $ は $ (10,20,30) $ の部分列ですが，$ (20,10) $ は $ (10,20,30) $ の部分列ではありません．  
 数列の**最長増加部分列**とは，数列の狭義単調増加な部分列の中で列の長さが最大のものを指します．   単純パスとは グラフ $ G $ 上の頂点 $ X,Y $ に対して，頂点列 $ (v_1,v_2,\ \ldots,\ v_k) $ であって， $ v_1=X $, $ v_k=Y $ かつ，$ 1\leq\ i\leq\ k-1 $ に対して $ v_i $ と $ v_{i+1} $ が辺で結ばれているようなものを頂点 $ X $ から頂点 $ Y $ への **ウォーク** と呼びます． さらに，$ v_1,v_2,\ \ldots,\ v_k $ がすべて異なるようなものを頂点 $ X $ から頂点 $ Y $ への **単純パス** (あるいは単に **パス**) と呼びます．

## 输入格式

入力は以下の形式で標準入力から与えられる．

> $ N $ $ K $ $ u_1 $ $ v_1 $ $ \vdots $ $ u_{N-1} $ $ v_{N-1} $

## 输出格式

$ f(P)=K $ を満たす順列 $ P $ が存在しない場合， `No` を出力せよ．

$ f(P)=K $ を満たす順列 $ P $ が存在する場合，以下の形式で出力せよ．

> Yes $ P_1 $ $ \ldots $ $ P_N $

条件を満たす順列 $ P $ が複数存在する場合，どれを出力しても正解とみなされる．

## 说明/提示

### 制約

- 入力される数値は全て整数
- $ 2\ \leq\ N\ \leq\ 2\times\ 10^5 $
- $ 1\leq\ K\ \leq\ 10^{11} $
- $ 1\leq\ u_i,v_i\leq\ N $
- 与えられるグラフは木
 
### Sample Explanation 1

$ P=(3,2,1,4,5) $ のとき，$ f(P) $ は以下のように定まります． - 頂点 $ 1 $ から頂点 $ 1 $ への単純パスは $ (1) $ であり，$ (P_1)=(3) $ の最長増加部分列の長さは $ 1 $ である．よって $ L_1\ =\ 1 $ である． - 頂点 $ 1 $ から頂点 $ 2 $ への単純パスは $ (1,2) $ であり，$ (P_1,P_2)=(3,2) $ の最長増加部分列の長さは $ 1 $ である．よって $ L_2\ =\ 1 $ である． - 頂点 $ 1 $ から頂点 $ 3 $ への単純パスは $ (1,2,3) $ であり，$ (P_1,P_2,P_3)=(3,2,1) $ の最長増加部分列の長さは $ 1 $ である．よって $ L_3\ =\ 1 $ である． - 頂点 $ 1 $ から頂点 $ 4 $ への単純パスは $ (1,2,4) $ であり，$ (P_1,P_2,P_4)=(3,2,4) $ の最長増加部分列の長さは $ 2 $ である．よって $ L_4\ =\ 2 $ である． - 頂点 $ 1 $ から頂点 $ 5 $ への単純パスは $ (1,2,4,5) $ であり，$ (P_1,P_2,P_4,P_5)=(3,2,4,5) $ の最長増加部分列の長さは $ 3 $ である．よって $ L_5\ =\ 3 $ である． - 以上より，$ f(P)=1+1+1+2+3=\ 8 $ である． このことから，出力例の $ P $ は $ f(P)=8 $ という条件を満たすことが分かります．この他にも，例えば $ P=(3,2,4,5,1) $ も条件を満たします．

### Sample Explanation 2

$ f(P)\ =\ 21 $ を満たす順列 $ P $ は存在しないことが証明できます．

## 样例 #1

### 输入

```
5 8

1 2

2 3

2 4

4 5
```

### 输出

```
Yes

3 2 1 4 5
```

## 样例 #2

### 输入

```
7 21

2 1

7 2

5 1

3 7

2 6

3 4
```

### 输出

```
No
```

## 样例 #3

### 输入

```
8 20

3 1

3 8

7 1

7 5

3 2

6 5

4 7
```

### 输出

```
Yes

2 1 3 5 6 8 4 7
```



---

---
title: "[ARC179C] Beware of Overflow"
layout: "post"
diff: 提高+/省选-
pid: AT_arc179_c
tag: ['贪心', '二分', '排序']
---

# [ARC179C] Beware of Overflow

## 题目描述

[problemUrl]: https://atcoder.jp/contests/arc179/tasks/arc179_c

この問題は**インタラクティブな問題**（あなたの作成したプログラムとジャッジシステムが入出力を介して対話を行う形式の問題）です.

正整数 $ N $ が与えられます.

ジャッジシステムは正整数 $ R $ および $ N $ 個の整数 $ A_1,A_2,\dots\ ,A_N $ を隠し持っています. ここで $ |A_i|\le\ R,\ \left|\displaystyle\sum_{i=1}^{N}A_i\right|\ \le\ R $ を満たすことが保証されます.

絶対値が $ R $ 以下の整数しか書き込むことができない黒板があり, はじめは何も書き込まれていません.

ジャッジシステムは, 黒板に $ A_1,A_2,\ \dots\ ,A_N $ の値を **この順で** 書き込みました. あなたは, 黒板にただ $ 1 $ つの値 $ \displaystyle\sum_{i=1}^{N}A_i $ が書き込まれている状態にする必要があります.

あなたは $ R $ および $ A_i $ の値を直接知ることはできませんが, その代わりにジャッジシステムに対して次のやり取りを $ 25000 $ 回まで行うことができます.

正整数 $ i $ について, $ i $ 番目に黒板に書き込まれた整数を $ X_i $ とします. 特に, $ i=1,2,\dots\ ,N $ について $ X_i=A_i $ です.

$ 1 $ 回のやり取りでは, 相異なる正整数 $ i,j $ を指定し, 次のいずれかを選んで行います.

- 足し算をしてもらう. ジャッジシステムは黒板から $ X_i,X_j $ を消し, 新たに $ X_i+X_j $ の値を黒板に書き込む.
  - $ |X_i+X_j|\le\ R $ を満たしていなくてはならない.
- 大小比較をしてもらう. ジャッジシステムは $ X_i\lt\ X_j $ の真偽を答える.

ただし, 各やり取りを始める時点で $ i,j $ 番目に黒板に書き込まれた整数がすでに黒板から消されていてはなりません.

適切にやり取りを行って, 全てのやり取りを終えた後に黒板にただ $ 1 $ つの値 $ \displaystyle\sum_{i=1}^{N}A_i $ が書き込まれている状態にしてください.

$ R $ および $ A_i $ はプログラムとジャッジシステムの対話の開始前に決定されます.

### Input &amp; Output Format

この問題はインタラクティブな問題（あなたの作成したプログラムとジャッジシステムが入出力を介して対話を行う形式の問題）です.

最初に, $ N $ を標準入力から受け取ってください.

> $ N $

次に, 黒板にただ $ 1 $ つの値 $ \displaystyle\sum_{i=1}^{N}A_i $ が書かれている状態になるまで, やり取りを繰り返してください.

足し算をしてもらうときは, 以下の形式で標準出力に出力してください. 末尾に改行を入れてください. ここで $ i,j $ は相異なる正整数です.

> + $ i $ $ j $

これに対するジャッジシステムの応答は, 次の形式で標準入力から与えられます.

> $ P $

ここで $ P $ は整数で,

- $ P\geq\ N+1 $ の場合は, $ X_i+X_j $ の値が黒板に書き込まれ, それが $ P $ 番目に書き込まれたことを表します.
- $ P=-1 $ の場合は, $ i,j $ が制約を満たしていないか, やり取りの回数が $ 25000 $ 回を超えたことを表します.

大小比較をしてもらうときは, 以下の形式で標準出力に出力してください. 末尾に改行を入れてください. ここで $ i,j $ は相異なる正整数です.

> ? $ i $ $ j $

これに対するジャッジシステムの応答は, 次の形式で標準入力から与えられます.

> $ Q $

ここで $ Q $ は整数で,

- $ Q=1 $ の場合は, $ X_i\ <\ X_j $ が真であることを表します.
- $ Q=0 $ の場合は, $ X_i\ <\ X_j $ が偽であることを表します.
- $ Q=-1 $ の場合は, $ i,j $ が制約を満たしていないか, やり取りの回数が $ 25000 $ 回を超えたことを表します.

足し算をしてもらうやり取りおよび大小比較をしてもらうやり取りのいずれについても, ジャッジシステムの応答が $ -1 $ であった場合は, プログラムはすでに不正解とみなされています. この場合, ただちにプログラムを終了してください.

黒板にただ $ 1 $ つの値 $ \displaystyle\sum_{i=1}^{N}A_i $ が書かれている状態になったら, 以下の形式でそのことをジャッジシステムに報告してください. ただし, これはジャッジシステムとのやり取りの回数に計上されません. その後, ただちにプログラムを終了してください.

```
!
```

上記のいずれの形式にも当てはまらない出力を行った場合は, `-1` が標準入力から与えられます.

```
-1
```

このときも, プログラムはすでに不正解とみなされています. ただちにプログラムを終了してください.

## 说明/提示

### 制約

- $ 2\leq\ N\leq\ 1000 $
- $ 1\leq\ R\leq\ 10^9 $
- $ |A_i|\leq\ R $
- $ \left|\displaystyle\sum_{i=1}^{N}A_i\right|\ \le\ R $
- $ N,R,A_i $ は整数.

### 注意点

- **出力を行うたびに, 末尾に改行を入れて標準出力を flush してください. そうしなかった場合, ジャッジ結果が TLE となる可能性があります.**
- 解答を出力したら（または `-1` を受け取ったら）ただちにプログラムを終了してください. そうしない場合, ジャッジ結果は不定です.
- 余計な改行は不正なフォーマットの出力とみなされることに注意してください.

### 入出力例

$ N=3,R=10,A_1=-1,A_2=10,A_3=1 $ のときの対話の一例を示します.

入力出力説明`3`まず整数 $ N $ が与えられます。`? 1 2`大小比較をしてもらいます.`1`$ X_1\lt\ X_2\ (-1\lt\ 10) $ なのでジャッジシステムは $ 1 $ を返します. `+ 1 3`足し算をしてもらいます.`4`ジャッジシステムは $ X_1=-1,X_3=1 $ を黒板から消し, $ X_1+X_3=0 $ の値を黒板に書き込みました. $ 4 $ 番目の書き込みでした.`+ 2 4`足し算をしてもらいます.`5`ジャッジシステムは $ X_2=10,X_4=0 $ を黒板から消し, $ X_2+X_4=10 $ の値を黒板に書き込みました. $ 5 $ 番目の書き込みでした.`!`黒板にはただ $ 1 $ つの値 $ \displaystyle\sum_{i=1}^{N}A_i $ が書き込まれている状態になったので, そのことをジャッジシステムに報告します.



---

---
title: "[ARC180B] Improve Inversions"
layout: "post"
diff: 提高+/省选-
pid: AT_arc180_b
tag: ['贪心']
---

# [ARC180B] Improve Inversions

## 题目描述

[problemUrl]: https://atcoder.jp/contests/arc180/tasks/arc180_b

$ (1,2,\cdots,N) $ の順列 $ P=(P_1,P_2,\cdots,P_N) $ が与えられます． また整数 $ K $ も与えられます．

あなたはこれから以下の操作を $ 0 $ 回以上行います．

- 整数 $ l,r $ ($ 1\ \leq\ l\ <\ r\ \leq\ N $) を選ぶ．ただしここで $ (l,r) $ は以下の条件をすべて満たす必要がある．
  - $ K\ \leq\ r-l $
  - 操作を行う段階で $ P_l\ >\ P_r $ である．
  - 同じ組 $ (l,r) $ を今までに選んだことが一度もない．
- そして，$ P_l $ と $ P_r $ の値を入れ替える．

あなたは操作回数を最大化したいです． その方法を一つ求めてください．

## 输入格式

入力は以下の形式で標準入力から与えられる．

> $ N $ $ K $ $ P_1 $ $ P_2 $ $ \cdots $ $ P_N $

## 输出格式

以下の形式で答えを出力せよ．

> $ m $ $ l_1 $ $ r_1 $ $ l_2 $ $ r_2 $ $ \vdots $ $ l_m $ $ r_m $

ただしここで $ m $ は操作回数の最大値であり，$ l_i,r_i $ は $ i $ 回目の操作で選んだ $ l,r $ の値である． 複数の解がある場合は，どれを出力してもよい．

## 说明/提示

### 制約

- $ 2\ \leq\ N\ \leq\ 500 $
- $ 1\ \leq\ K\ \leq\ N-1 $
- $ (P_1,P_2,\cdots,P_N) $ は $ (1,2,\cdots,N) $ の順列
- 入力される値はすべて整数

### Sample Explanation 1

この例では操作回数の最大値は $ 3 $ です． 出力例の操作の様子は以下のとおりです． - $ 1 $ 回目の操作: $ (l,r)=(2,3) $ を選ぶ．$ 1\ \leq\ 3-2,\ P_2\ >\ P_3 $ かつ $ (2,3) $ を選んだことはないので条件は満たされている．$ P_2,P_3 $ の値を入れ替え，$ P=(3,1,2) $ になる． - $ 2 $ 回目の操作: $ (l,r)=(1,3) $ を選ぶ．$ 1\ \leq\ 3-1,\ P_1\ >\ P_3 $ かつ $ (1,3) $ を選んだことはないので条件は満たされている．$ P_1,P_3 $ の値を入れ替え，$ P=(2,1,3) $ になる． - $ 3 $ 回目の操作: $ (l,r)=(1,2) $ を選ぶ．$ 1\ \leq\ 2-1,\ P_1\ >\ P_2 $ かつ $ (1,2) $ を選んだことはないので条件は満たされている．$ P_1,P_2 $ の値を入れ替え，$ P=(1,2,3) $ になる．

## 样例 #1

### 输入

```
3 1
3 2 1
```

### 输出

```
3
2 3
1 3
1 2
```

## 样例 #2

### 输入

```
5 4
1 4 3 2 5
```

### 输出

```
0
```

## 样例 #3

### 输入

```
4 2
4 1 2 3
```

### 输出

```
2
1 4
1 3
```

## 样例 #4

### 输入

```
10 5
8 7 6 10 9 3 1 5 2 4
```

### 输出

```
15
3 8
2 8
3 10
3 9
1 8
2 10
2 9
2 7
1 10
5 10
1 9
4 10
4 9
1 7
1 6
```



---

---
title: "[ARC186C] Ball and Box"
layout: "post"
diff: 提高+/省选-
pid: AT_arc186_c
tag: ['贪心', '博弈论']
---

# [ARC186C] Ball and Box

## 题目描述

[problemUrl]: https://atcoder.jp/contests/arc186/tasks/arc186_c

球橋さんと箱木さんはボールと箱を使ったゲームをします。

最初、球橋さんは $ M $ 種類のボールをそれぞれ $ 10^{100} $ 個ずつ持っていて、 箱木さんは $ 10^{100} $ 円持っています。 また、$ N $ 個の箱があり、$ i $ 番目の箱の容量は $ V_i $ で、値段は $ P_i $ 円です。ゲーム中、箱木さんはいつでも好きな箱を買うことができます。

このゲームでは、ゲームが終わるまで以下の操作を繰り返します。

1. 球橋さんはボールを $ 1 $ つ選び、箱木さんに渡す。
2. 箱木さんは渡されたボールを受け取るか、受け取らずにゲームを終えるかを選ぶ。
3. ボールを受け取った場合、箱木さんは購入済みの箱を $ 1 $ つ選び、受け取ったボールを入れる。
4. ボールを入れた箱が以下の条件を満たしている場合、箱木さんは $ 1 $ 円をもらう。そうでない場合、ゲームを終える。
  - 箱の中のボールの個数は、その箱の容量以下である。
  - 箱の中のボールの種類は、すべて同じである。

球橋さんは、ゲーム終了時の箱木さんの所持金がなるべく少なくなるための最適な行動をし、反対に、箱木さんはなるべく多くなるための最適な行動をします。 ゲームを通して、箱木さんの所持金はいくら増えますか？

ただし、両者ともにすべての情報が公開されているとします。特に、球橋さんは、それぞれの箱について、容量と値段、どの種類のボールがいくつ入っているかを見ることができます。 また、箱木さんの初期の所持金は十分多く、お金が足りなくて箱が買えなくなることはないことに注意してください。

$ 1 $ つの入力ファイルにつき、$ T $ 個のテストケースを解いてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。ここで $ \mathrm{case}_i $ は $ i $ 番目のテストケースを意味する。

> $ T $ $ \mathrm{case}_1 $ $ \mathrm{case}_2 $ $ \vdots $ $ \mathrm{case}_T $

各テストケースは以下の形式で与えられる。

> $ N $ $ M $ $ V_1 $ $ P_1 $ $ V_2 $ $ P_2 $ $ \vdots $ $ V_N $ $ P_N $

## 输出格式

両者が最適に行動したときの、箱木さんの最終的な所持金と最初の所持金の差を出力せよ。

## 说明/提示

### 制約

- $ 1\le\ T,N,M\le\ 3\times\ 10^5 $
- $ 1\le\ V_i,P_i\ \le\ 10^9 $
- $ T $ 個のテストケースに対する $ N $ の総和は $ 3\times\ 10^5 $ 以下
- 入力はすべて整数

### Sample Explanation 1

最初のテストケースでは $ 2 $ 種類のボールと $ 3 $ つの箱を使います。 $ 2 $ 種類のボールをそれぞれ白のボールと黒のボールと呼び、$ i $ 種類目の箱を箱 $ i $ と呼ぶことにします。 このテストケースについて、所持金が $ 2 $ 円増えるゲームの進み方の例を示します。 1. 球橋さんが白のボールを選び、渡す。 2. 箱木さんはボールを受け取り、箱 $ 2 $ を $ 1 $ 円で買って白のボールを入れる。 - 箱 $ 2 $ には白のボールが $ 1 $ 個入っている。これは条件を満たしているため、箱木さんは $ 1 $ 円をもらう。 3. 球橋さんが白のボールを選び、渡す。 4. 箱木さんはボールを受け取り、箱 $ 2 $ に白のボールを入れる。 - 箱 $ 2 $ には白のボールが $ 2 $ 個入っている。これは条件を満たしているため、箱木さんは $ 1 $ 円をもらう。 5. 球橋さんが黒のボールを選び、渡す。 6. 箱木さんはボールを受け取り、箱 $ 3 $ を $ 1 $ 円で買って黒のボールを入れる。 - 箱 $ 3 $ には黒のボールが $ 1 $ 個入っている。これは条件を満たしているため、箱木さんは $ 1 $ 円をもらう。 7. 球橋さんが白のボールを選び、渡す。 8. 箱木さんはボールを受け取り、箱 $ 2 $ に白のボールを入れる。 - 箱 $ 2 $ には白のボールが $ 3 $ 個入っている。これは条件を満たしているため、箱木さんは $ 1 $ 円をもらう。 9. 球橋さんが白のボールを選び、渡す。 10. 箱木さんは受け取らずにゲームを終えることを選ぶ。 最終的に、箱 $ 2 $ には白のボールが $ 3 $ 個、箱 $ 3 $ には黒のボールが $ 1 $ 個入っています。 合計で $ 2 $ 円使って $ 4 $ 円もらったので、所持金は $ 2 $ 円増えました。 $ 2 $ つめのテストケースでは、球橋さんは、箱木さんにお金を稼がせないような行動ができます。

## 样例 #1

### 输入

```
3
3 2
1 1000000000
3 1
3 1
1 300000
1000000000 1
10 4
22 5
26 45
72 21
47 39
97 2
75 35
82 24
17 46
32 22
28 67
```

### 输出

```
2
0
28
```



---

---
title: "[ARC189D] Takahashi is Slime"
layout: "post"
diff: 提高+/省选-
pid: AT_arc189_d
tag: ['贪心', 'ST 表', '笛卡尔树']
---

# [ARC189D] Takahashi is Slime

## 题目描述

有 $N$ 个史莱姆排成一列，从左到右依次编号为 $1, 2, \ldots, N$。第 $i$ 个史莱姆的大小为 $A_i$。  
对于每一个位置 $K = 1, 2, \ldots, N$，解决下面的问题：

> 初始时，第 $K$ 个史莱姆是高桥君。高桥君可以执行任意多次（可以是 $0$ 次）的操作。请计算高桥君在操作后能达到的最大大小。
>
> - 高桥君可以吸收一个相邻且大小小于他的史莱姆。吸收后，该史莱姆消失，高桥君的大小增加该史莱姆的大小。
>
> 在这个过程中，被吸收的史莱姆消失后空出的位置会立即由两侧的史莱姆填补，这使得两端的史莱姆重新相邻（请参考样例 1）。

## 输入格式

从标准输入读取以下格式的数据：

> $N$ $A_1$ $A_2$ $\ldots$ $A_N$

## 输出格式

对于每个 $K = 1, 2, \ldots, N$，输出问题的答案 $B_K$，各答案以空格分隔：

> $B_1$ $B_2$ $\ldots$ $B_N$

## 说明/提示

- $2 \leq N \leq 5 \times 10^5$
- $1 \leq A_i \leq 10^9$
- 所有输入都是整数

### 样例解释

以 $K = 4$ 为例。我们用方括号 `[]` 标识高桥君，称其为**列状态**。初始状态下的列为 $(4, 13, 2, [3], 2, 6)$。以下是高桥君的操作步骤：
1. 高桥君吸收右邻的史莱姆，大小变为 $3 + 2 = 5$，列状态变为 $(4, 13, 2, [5], 6)$。
2. 高桥君吸收左邻的史莱姆，大小变为 $5 + 2 = 7$，列状态变为 $(4, 13, [7], 6)$。
3. 高桥君吸收右邻的史莱姆，大小变为 $7 + 6 = 13$，列状态变为 $(4, 13, [13])$。

最终，高桥君再也无法吸收任何比他小的邻居，所以他的最大可能大小是 $13$。

 **本翻译由 AI 自动生成**

## 样例 #1

### 输入

```
6

4 13 2 3 2 6
```

### 输出

```
4 30 2 13 2 13
```

## 样例 #2

### 输入

```
12

22 25 61 10 21 37 2 14 5 8 6 24
```

### 输出

```
22 47 235 10 31 235 2 235 5 235 6 235
```



---


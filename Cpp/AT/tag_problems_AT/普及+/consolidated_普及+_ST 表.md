---
title: "[ABC254F] Rectangle GCD"
layout: "post"
diff: 普及+/提高
pid: AT_abc254_f
tag: ['数论', '未知标签231', '最大公约数 gcd', 'ST 表']
---

# [ABC254F] Rectangle GCD

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc254/tasks/abc254_f

正整数 $ N $ と長さ $ N $ の正整数列 $ A=(A_1,A_2,\dots,A_N) $ と $ B=(B_1,B_2,\dots,B_N) $ が与えられます。

$ N\ \times\ N $ のマス目があります。上から $ i $ 行目、左から $ j $ 列目のマスをマス $ (i,j) $ と呼びます。$ 1\ \le\ i,j\ \le\ N $ を満たす整数の組 $ (i,j) $ に対し、マス $ (i,j) $ に $ A_i\ +\ B_j $ が書かれています。以下のクエリを $ Q $ 個処理してください。

- $ 1\ \le\ h_1\ \le\ h_2\ \le\ N,1\ \le\ w_1\ \le\ w_2\ \le\ N $ を満たす整数の組 $ h_1,h_2,w_1,w_2 $ が与えられる。左上隅が $ (h_1,w_1) $、右下隅が $ (h_2,w_2) $ である矩形領域に含まれる整数の最大公約数を求めよ。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ Q $ $ A_1 $ $ A_2 $ $ \dots $ $ A_N $ $ B_1 $ $ B_2 $ $ \dots $ $ B_N $ $ \mathrm{query}_1 $ $ \mathrm{query}_2 $ $ \vdots $ $ \mathrm{query}_Q $

各クエリは以下の形式で与えられる。

> $ h_1 $ $ h_2 $ $ w_1 $ $ w_2 $

## 输出格式

$ Q $ 行出力せよ。$ i $ 行目には $ \mathrm{query}_i $ の答えを出力せよ。

## 说明/提示

### 制約

- $ 1\ \le\ N,Q\ \le\ 2\ \times\ 10^5 $
- $ 1\ \le\ A_i,B_i\ \le\ 10^9 $
- $ 1\ \le\ h_1\ \le\ h_2\ \le\ N $
- $ 1\ \le\ w_1\ \le\ w_2\ \le\ N $
- 入力はすべて整数である。

### Sample Explanation 1

マス $ (i,j) $ に書かれている整数を $ C_{i,j} $ とします。 $ 1 $ 個目のクエリについて、$ C_{1,2}=4,C_{1,3}=6,C_{2,2}=6,C_{2,3}=8 $ なのでこれらの最大公約数の $ 2 $ が答えとなります。

## 样例 #1

### 输入

```
3 5
3 5 2
8 1 3
1 2 2 3
1 3 1 3
1 1 1 1
2 2 2 2
3 3 1 1
```

### 输出

```
2
1
11
6
10
```

## 样例 #2

### 输入

```
1 1
9
100
1 1 1 1
```

### 输出

```
109
```



---

---
title: "[ABC282F] Union of Two Sets"
layout: "post"
diff: 普及+/提高
pid: AT_abc282_f
tag: ['倍增', 'ST 表', '构造']
---

# [ABC282F] Union of Two Sets

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc282/tasks/abc282_f

この問題は **インタラクティブな問題**（あなたが作成したプログラムとジャッジプログラムが標準入出力を介して対話を行う形式の問題）です。

あなたとジャッジは下記の手順を行います。 手順はフェイズ $ 1 $ とフェイズ $ 2 $ からなり、まずフェイズ $ 1 $ を行った直後、続けてフェイズ $ 2 $ を行います。

（フェイズ $ 1 $ ）

- ジャッジから整数 $ N $ が与えられる。
- あなたは $ 1 $ 以上 $ 50000 $ 以下の整数 $ M $ を出力する。
- さらにあなたは、すべての $ i\ =\ 1,\ 2,\ \ldots,\ M $ について $ 1\ \leq\ l_i\ \leq\ r_i\ \leq\ N $ を満たす、$ M $ 個の整数の組 $ (l_1,\ r_1),\ (l_2,\ r_2),\ \ldots,\ (l_M,\ r_M) $ を出力する（$ M $ 個の整数の組が相異なる必要はない）。

（フェイズ $ 2 $ ）

- ジャッジから整数 $ Q $ が与えられる。
- その後、あなたとジャッジは下記の手順を $ Q $ 回繰り返す。
  - ジャッジからクエリとして $ 2 $ つの整数 $ L,\ R $ が与えられる。
  - それに対する応答として、あなたは $ 1 $ 以上 $ M $ 以下の $ 2 $ つの整数 $ a,\ b $ を出力する（ $ a\ =\ b $ でもよい）。 このとき、$ a $ と $ b $ は下記の条件を満たさなければならない。もし満たさなかった場合は不正解となる。
      - 集合 $ \lbrace\ l_a,\ l_a+1,\ \ldots,\ r_a\rbrace $ と集合 $ \lbrace\ l_b,\ l_b+1,\ \ldots,\ r_b\rbrace $ の和集合が、集合 $ \lbrace\ L,\ L+1,\ \ldots,\ R\rbrace $ と一致する。

上記の手順を行った後、直ちにプログラムを終了することで正解となります。

### Input &amp; Output Format

この問題はインタラクティブな問題（あなたが作成したプログラムとジャッジプログラムが標準入出力を介して対話を行う形式の問題）です。

（フェイズ $ 1 $ ）

- まず、$ N $ が入力から与えられます。
- 次に、$ 1 $ 以上 $ 50000 $ 以下の整数 $ M $ を出力してください。
- その後、$ M $ 回にわたって $ (l_1,\ r_1),\ (l_2,\ r_2),\ \ldots,\ (l_M,\ r_M) $ を出力してください。 具体的には、$ i\ =\ 1,\ 2,\ \ldots,\ M $ について、$ i $ 回目の出力では $ (l_i,\ r_i) $ を下記の形式で出力してください。

> $ l_i $ $ r_i $

（フェイズ $ 2 $ ）

- まず、$ Q $ が入力から与えられます。
- 各クエリでは、クエリを表す整数 $ L,\ R $ が下記の形式で与えられます。

> $ L $ $ R $

- 各クエリに対する応答では、$ 2 $ つの整数 $ a,\ b $ を下記の形式で出力してください。

> $ a $ $ b $

## 说明/提示

### 制約

- $ 1\ \leq\ N\ \leq\ 4000 $
- $ 1\ \leq\ Q\ \leq\ 10^5 $
- $ 1\ \leq\ L\ \leq\ R\ \leq\ N $
- 入力はすべて整数

### 注意点

- **出力を行うたびに、末尾に改行を入れて標準出力を flush してください。そうしなかった場合、ジャッジ結果が TLE となる可能性があります。**
- **対話の途中で不正な出力を行った、あるいはプログラムが途中で終了した場合のジャッジ結果は不定です。** 特に、プログラムの実行中に実行時エラーが起こった場合に、ジャッジ結果が RE ではなく WA や TLE になる可能性があることに注意してください。
- フェイズ $ 2 $ を終了したらただちにプログラムを終了してください。そうしない場合、ジャッジ結果は不定です。
- フェイズ $ 2 $ で与えられる $ L,\ R $ は、あなたがフェイズ $ 1 $ で出力した $ (l_1,\ r_1),\ (l_2,\ r_2),\ \ldots,\ (l_M,\ r_M) $ に応じて決定されます。

### 入出力例

以下は、$ N\ =\ 4,\ Q\ =\ 4 $ の場合の入出力例です。

入力出力説明`4`$ N $ が与えられます。`6`$ M $ を出力します。`3 3`$ (l_1,\ r_1)\ =\ (3,\ 3) $ を出力します。`4 4`$ (l_2,\ r_2)\ =\ (4,\ 4) $ を出力します。`1 1`$ (l_3,\ r_3)\ =\ (1,\ 1) $ を出力します。`2 4`$ (l_4,\ r_4)\ =\ (2,\ 4) $ を出力します。`1 3`$ (l_5,\ r_5)\ =\ (1,\ 3) $ を出力します。`2 2`$ (l_6,\ r_6)\ =\ (2,\ 2) $ を出力します。`4`$ Q $ が与えられます。`1 3`$ 1 $ 個目のクエリとして $ L\ =\ 1,\ R\ =\ 3 $ が与えられます。`1 5`$ 1 $ 個目のクエリに対する応答として $ a\ =\ 1,\ b\ =\ 5 $ を出力します。`3 4`$ 2 $ 個目のクエリとして $ L\ =\ 3,\ R\ =\ 4 $ が与えられます。`2 1`$ 2 $ 個目のクエリに対する応答として $ a\ =\ 2,\ b\ =\ 1 $ を出力します。`2 4`$ 3 $ 個目のクエリとして $ L\ =\ 2,\ R\ =\ 4 $ が与えられます。`4 4`$ 3 $ 個目のクエリに対する応答として $ a\ =\ 4,\ b\ =\ 4 $ を出力します。`1 1`$ 4 $ 個目のクエリとして $ L\ =\ 1,\ R\ =\ 1 $ が与えられます。`3 3`$ 4 $ 個目のクエリに対する応答として $ a\ =\ 3,\ b\ =\ 3 $ を出力します。



---

---
title: "[ABC338E] Chords"
layout: "post"
diff: 普及+/提高
pid: AT_abc338_e
tag: ['栈', 'ST 表']
---

# [ABC338E] Chords

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc338/tasks/abc338_e

円周上に $ 2N $ 個の点が等間隔に並んでおり、ある点から始めて時計回りに $ 1 $ から $ 2N $ までの番号が付けられています。

円周上にはさらに $ N $ 個の弦があり、$ i $ 個目の弦は点 $ A_i $ と点 $ B_i $ を結んでいます。 ここで、$ A_1,\dots,A_N,B_1,\dots,B_N $ は全て相異なることが保証されます。

弦どうしの交点が存在するかどうか判定してください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ A_1 $ $ B_1 $ $ A_2 $ $ B_2 $ $ \vdots $ $ A_N $ $ B_N $

## 输出格式

弦どうしの交点が存在するならば `Yes` を、存在しないならば `No` を出力せよ。

## 说明/提示

### 制約

- $ 2\leq\ N\ \leq\ 2\times\ 10^5 $
- $ 1\leq\ A_i,B_i\ \leq\ 2N $
- $ A_1,\dots,A_N,B_1,\dots,B_N $ は全て相異なる
- 入力は全て整数

### Sample Explanation 1

!\[\](https://img.atcoder.jp/abc338/de1d9dd6cf38caec1c69fe035bdba545.png) 図のように、弦 $ 1 $（点 $ 1 $ と点 $ 3 $ を結ぶ線分）と弦 $ 2 $（点 $ 4 $ と点 $ 2 $ を結ぶ線分）が交点を持つので、`Yes` を出力します。

### Sample Explanation 2

!\[\](https://img.atcoder.jp/abc338/1b3b982c8d6ca59f00ca0edd218fb9c4.png) 図のように、弦どうしの交点は存在しないので、`No` を出力します。

## 样例 #1

### 输入

```
3
1 3
4 2
5 6
```

### 输出

```
Yes
```

## 样例 #2

### 输入

```
3
6 1
4 3
2 5
```

### 输出

```
No
```

## 样例 #3

### 输入

```
4
2 4
3 7
8 6
5 1
```

### 输出

```
Yes
```



---

---
title: "Largest N"
layout: "post"
diff: 普及+/提高
pid: AT_nikkei2019_2_final_c
tag: ['动态规划 DP', '二分', 'ST 表']
---

# Largest N

## 题目描述

[problemUrl]: https://atcoder.jp/contests/nikkei2019-2-final/tasks/nikkei2019_2_final_c

$ H $ 行 $ W $ 列 のマス目があり、それぞれのマスは黒または白で塗られています。上から $ i $ 行目、左から $ j $ 列目のマスをマス $ (i,\ j) $ と呼びます。

マス $ (a_i,\ b_i)\ (1\ \leq\ i\ \leq\ K) $ は白で塗られており、それ以外の $ H\ \times\ W\ -\ K $ マスは黒で塗られています。

$ 1 $ 以上の整数 $ k $ に対してマス目がサイズ $ k $ の `N` を含むとは、次の条件をみたす整数 $ i,\ j $ が存在することを言います。

- マス $ (i\ +\ t,\ j)\ (0\ \leq\ t\ <\ k) $ がすべて黒
- マス $ (i\ +\ t,\ j\ +\ t)\ (0\ \leq\ t\ <\ k) $ がすべて黒
- マス $ (i\ +\ t,\ j\ +\ k\ -\ 1)\ (0\ \leq\ t\ <\ k) $ がすべて黒

ただし、この条件に関わる全てのマスが $ H $ 行 $ W $ 列のマス目に含まれなければなりません。

このマス目に含まれる `N` のサイズの最大値を求めてください。ただし、どのサイズの `N` も含まない場合は、$ 0 $ を出力してください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ H $ $ W $ $ K $ $ a_1 $ $ b_1 $ $ a_2 $ $ b_2 $ $ : $ $ a_K $ $ b_K $

## 输出格式

マス目に含まれる `N` のサイズの最大値を出力せよ。

## 说明/提示

### 制約

- $ 1\ \leq\ H,\ W\ \leq\ 3000 $
- $ 0\ \leq\ K\ \leq\ \mathrm{min}(H\ \times\ W,\ 2\ \times\ 10^5) $
- $ 1\ \leq\ a_i\ \leq\ H $
- $ 1\ \leq\ b_i\ \leq\ W $
- $ (a_i,\ b_i)\ \neq\ (a_j,\ b_j)\ (i\ \neq\ j) $
- 入力は全て整数である

### Sample Explanation 1

マス目は以下の状態になっています。(`#` が黒、`.` が白で塗られていることを表しています) ``` ##.# #### ##.# ``` このとき、$ i\ =\ 1,\ j\ =\ 2 $ とすれば $ k\ =\ 3 $ に対して条件を満たすのでこのマス目はサイズ $ 3 $ の `N` を含み、これが最大です。

### Sample Explanation 2

マス目は以下の状態になっています。 ``` .. .. ``` どのサイズの `N` も含まれないので、$ 0 $ を出力してください。

### Sample Explanation 3

マス目は以下の状態になっています。 ``` .# #. ``` $ i\ =\ 2,\ j\ =\ 1 $ または $ i\ =\ 1,\ j\ =\ 2 $ とすれば $ k\ =\ 1 $ に対して条件を満たします。

### Sample Explanation 4

マス目は以下の状態になっています。 ``` ##.# ##.# #.## #..# ```

## 样例 #1

### 输入

```
3 4 2

1 3

3 3
```

### 输出

```
3
```

## 样例 #2

### 输入

```
2 2 4

2 1

1 1

1 2

2 2
```

### 输出

```
0
```

## 样例 #3

### 输入

```
2 2 2

1 1

2 2
```

### 输出

```
1
```

## 样例 #4

### 输入

```
4 4 5

2 3

1 3

4 2

4 3

3 2
```

### 输出

```
4
```



---


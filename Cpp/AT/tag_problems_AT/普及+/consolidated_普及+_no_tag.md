---
title: "[ABC002D] 派閥"
layout: "post"
diff: 普及+/提高
pid: AT_abc002_4
tag: []
---

# [ABC002D] 派閥

## 题目描述

从上帝和母亲鼓励的话语中重新获得信心（中二）的高桥君决定去任选国会议员，以纠正AtCoder国家的腐败政治。
以实践操控和演讲而闻名的高桥君最终以实践操控和演讲而闻名的高桥君最终没有困难地赢得了大家的信任，成为了国会议员。
成为国会议员后，接下来就是实际操作。为了纠正这个国家的腐败政治，他需要被任命为总理。
在AtCoder国家除了高桥君之外，还有**N名议员**，存在**M个人际关系（x，y）**。
**人际关系（x，y）的意思是表示成员x和成员y彼此熟悉**（就是可以搞投票的意思）。
高桥君计划通过从N位议员中选出一些议员来制造自己的派系（就是会支持自己）。
**要求包括在该派系中的所有成员必须彼此了解。**
请你动动你的小手写一个程序，求出能属于高桥派系的最大成员人数。

## 输出格式

请输出属于高桥君可以创建的派系的最大成员数量。
另外，请在输出结尾处放置一个回车符。

## 说明/提示

（样例一）

第1行：与五位议员有三种人际关系。
第2行：议员1和2互相熟悉。（1,2）
第3行：议员2和3互相熟悉。 （2,3）
第4行：议员1和3互相熟悉。 （1,3）
因为国会议员1，国会议员2，国会议员3相互认识，所以这三个人可以组成高桥君的~~后宫~~支持队伍。

（样例二）

这一个样例有以下可能的关系 ：
1.议员1和议员2互相熟悉（1,2）
2.议员2和议员3互相熟悉 （2,3）
3.议员3和议员4互相熟悉（3,4）
（但是议员1和议员4不互相熟悉所以只能是选择2号议员和3号议员）

翻译：Forgetrmber~这个小小蒟蒻



---

---
title: "[ABC005D] おいしいたこ焼きの焼き方"
layout: "post"
diff: 普及+/提高
pid: AT_abc005_4
tag: []
---

# [ABC005D] おいしいたこ焼きの焼き方

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc005/tasks/abc005_4

高橋君のたこ焼き屋で使っているたこ焼き器は焼く場所によって美味しさの変わるクセの強いたこ焼き器です。  
 また、店員の力量によって一度に焼けるたこ焼きの数が違います。  
 高橋君はそれぞれの店員ができるだけ美味しくたこ焼きを焼けるようにしようと思いました。  
  
 たこ焼き器は$ N×N $の正方形をしています。  
 それぞれの場所ごとにたこ焼きの美味しさ$ D_{ij} $が決まっています。  
 それぞれの店員は一度に焼けるたこ焼きの上限$ P_k $が決まっています。  
 また、一度に焼くたこ焼きは必ずたこ焼き器の長方形の部分になっていて、その中の全てを使わなければなりません。  
 それぞれの店員について一度に焼けるたこ焼きの美味しさの合計の最大値を求めて下さい。  
 ただし、店員が焼き始める時はたこ焼き器が完全に空いていてどの場所でも使えるとします。 入力は以下の形式で標準入力から与えられる。

> $ N $ $ D_{11} $ $ D_{12} $ ... $ D_{1N} $ $ D_{21} $ $ D_{22} $ ... $ D_{2N} $ $ ... $ $ D_{N1} $ $ D_{N2} $ ... $ D_{NN} $ $ Q $ $ P_1 $ $ P_2 $ $ ... $ $ P_Q $

- １行目にたこ焼き器の一辺の大きさを表す整数$ N(1≦N≦50) $が与えられます。
- 続く$ N $行にたこ焼き器のそれぞれの場所で焼けるたこ焼きの美味しさを表す整数$ D_{ij}(1≦D_{ij}≦100) $が与えられます。
- 次の行に店員の人数を表す整数$ Q $($ 1≦Q≦N^2 $)が与えられます。
- 続く$ Q $行にそれぞれの店員が焼けるたこ焼きの数を表す整数$ P_k(1≦P_k≦N^2) $が与えられます。
 
 それぞれの店員について一度に焼けるたこ焼きの美味しさの合計の最大値を出力して下さい。  
また、出力の末尾には改行を入れて下さい。$ 1≦N≦5 $を満たすテストケース全てに正解すると、$ 100 $点満点のうち $ 50 $点が与えられる。

 ```

3
3 2 1
2 2 1
1 1 1
3
1
4
9
```

 ```

3
9
14
```

- １人目の店員は左上でたこ焼きを焼くと美味しさの合計が$ 3 $になります。
- ２人目の店員は左上の2×2の範囲でたこ焼きを焼くと美味しさの合計が$ 9 $になります。
- ３人目の店員はたこ焼き器全てを使えるので美味しさの合計が$ 14 $になります。
 
 これは部分点に含まれる入力になります。 ```

3
1 1 1
1 1 1
9 9 9
1
4
```

 ```

27
```

- 一番下の列の範囲1×3でたこ焼きを焼くと美味しさの合計が$ 27 $になります。
- この店員はたこ焼きを４個焼くことができますが、３個しか焼かないほうが美味しさの合計が大きくなります。
 
 これは部分点に含まれる入力になります。



---

---
title: "[ABC008C] コイン"
layout: "post"
diff: 普及+/提高
pid: AT_abc008_3
tag: []
---

# [ABC008C] コイン

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc008/tasks/abc008_3

高橋君は裏表が区別できる $ N $ 枚のコインを持っている。コインの大きさは異なり、それぞれのコインには $ 1 $ つずつ正の整数が書かれている。

これらのコインを無作為に ($ N! $ 通りの組み合わせがすべて同じ確率で出てくるように) 一列に並べる。その後、以下の手順を実行する。

1. すべてのコインを表向きにする。
2. 左端のコインから順に、現在見ているコインよりも右側 (それ自身を除く) にあるコインのうち、現在見ているコインに書かれている整数の倍数が書かれているコインすべての裏表をひっくり返す。

高橋君はこの操作を終了した後に表を向いているコインの枚数の期待値が知りたい。

あなたは高橋くんの代わりに、期待値を計算するプログラムを作成してほしい。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ C_1 $ $ C_2 $ : $ C_N $

- $ 1 $ 行目には、コインの枚数を表す整数 $ N\ (1\ ≦\ N\ ≦\ 100) $ が与えられる。
- $ 2 $ 行目から $ N $ 行のうち $ i\ (1\ ≦\ i\ ≦\ N) $ 行目には、$ i $ 番目に大きいコインに書かれている整数 $ C_i\ (1\ ≦\ C_i\ ≦\ 10^9) $ が書かれている。

## 输出格式

表を向いているコインの枚数の期待値を出力せよ。絶対誤差または相対誤差が $ 10^{-6} $ 以下であれば許容される。出力の末尾にも改行を入れること。

## 说明/提示

### 部分点

この問題には部分点が設定されている。

- $ N\ ≦\ 8 $ を満たすデータセット $ 1 $ に正解した場合は、$ 99 $ 点が与えられる。
- 追加制約のないデータセット $ 2 $ に正解した場合は、さらに $ 1 $ 点が与えられ、合計で $ 100 $ 点が得られる。

### Sample Explanation 1

コインには、サイズの小さい方から順にそれぞれ $ 2 $ , $ 4 $ , $ 8 $ という数が書かれています。例えば、$ 3! $ 通りの並べ方のうち、コインが大きさの昇順に並んでいる場合は、以下の手順が行われることになります。 1. 初期状態で、すべてのコインを表に向けるので、コインは左から順に、\\\[`表`, `表`, `表`\\\] となっています。 2. 次に、左から $ 2 $ 番目以降のコインの中で、$ 2 $ の倍数が書かれたコインを探します。左から $ 2 $ 番目のコインと左から $ 3 $ 番目のコインが該当するので、これらのコインを裏返します。その結果、コインは左から順に \\\[`表`, `裏`, `裏`\\\] となります。 3. 次に、左から $ 3 $ 番目以降のコインの中で、$ 4 $ の倍数が書かれたコインを探します。左から $ 3 $ 番目のコインのみが該当するので、このコインを裏返します。その結果、コインは左から順に \\\[`表`, `裏`, `表`\\\] となります。 コインの裏表は下図のように変化します。この図において、白いコインは表向きのコイン、黒いコインは裏向きのコインで表してあります。 !\[\](http://abc008.contest.atcoder.jp/img/abc/008/3-1.png)このように、$ 3!\ =\ 6 $ 通りの並べ方について、それぞれの並べ方での最終状態は下図のようになります。 !\[\](http://abc008.contest.atcoder.jp/img/abc/008/3-2.png)以上より期待値は $ 13/6\ =\ 2.16666666666... $ となります。

### Sample Explanation 2

どのような順番で並べても、左から順に、\\\[`表`, `裏`, `表`, `裏`\\\] となります。

## 样例 #1

### 输入

```
3

2

4

8
```

### 输出

```
2.166666666667
```

## 样例 #2

### 输入

```
4

5

5

5

5
```

### 输出

```
2.000000000000
```

## 样例 #3

### 输入

```
5

2

3

2

6

12
```

### 输出

```
3.100000000000
```



---

---
title: "[ABC011D] 大ジャンプ"
layout: "post"
diff: 普及+/提高
pid: AT_abc011_4
tag: []
---

# [ABC011D] 大ジャンプ

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc011/tasks/abc011_4

$ XY $ 座標上に、スタート地点とゴール地点が $ 1 $ つずつあります。 スタート地点は $ (0,\ 0) $ にあり、ゴール地点は $ (X,\ Y) $ です。

あなたは、ジャンプという移動法を用いて、移動を行います。 ジャンプを $ 1 $ 回行うと、あなたは、以下の $ 4 $ つのうち、ランダムで選ばれた $ 1 $ つの移動が行われます。

- $ X $ 軸に平行に $ +D $ だけ移動する。
- $ X $ 軸に平行に $ -D $ だけ移動する。
- $ Y $ 軸に平行に $ +D $ だけ移動する。
- $ Y $ 軸に平行に $ -D $ だけ移動する。

これらの移動は、どれもちょうど $ 1/4 $ の確率で選択されます。

あなたは、最初にスタート地点におり、ちょうど $ N $ 回のジャンプでゴール地点にたどり着きたいです。

目的を達成できる確率を出力しなさい。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ D $ $ X $ $ Y $

- $ 1 $ 行目には、ジャンプする回数を表す整数 $ N\ (1\ ≦\ N\ ≦\ 1,000) $ と、ジャンプの距離 $ D\ (1\ ≦\ D\ ≦\ 10^9) $ が、スペース区切りで与えられる。
- $ 2 $ 行目には、ゴール地点の座標を表す整数 $ X,\ Y\ (-10^9\ ≦\ X,\ Y\ ≦\ 10^9) $ が、スペース区切りで与えられる。

## 输出格式

あなたが最終的にゴール地点にたどり着ける確率を $ 1 $ 行で出力せよ。出力の末尾にも改行をいれること。

なお、想定解答との絶対誤差または相対誤差が、$ 10^{-9} $ 以下であれば、正解として扱われる。

## 说明/提示

### 部分点

$ 1\ ≦\ N\ ≦\ 8 $ のケースに全て正解すると、部分点として $ 90 $ 点が与えられる。

$ 1\ ≦\ N\ ≦\ 30 $ のケースに全て正解すると、追加で $ 10 $ 点が与えられる。

全てのケースに正解すると、ボーナス点として $ 1 $ 点が与えられる。

### Sample Explanation 1

$ (0,\ 0) $ から $ 2 $ 回のジャンプで $ (10000000,\ 10000000) $ へ飛ぶ確率は、 $ 1/8 $ です。

### Sample Explanation 2

偶数の距離のジャンプでは、奇数の座標にたどり着くことはできないため、到達する確率は $ 0 $ となります。

## 样例 #1

### 输入

```
2 10000000

10000000 10000000
```

### 输出

```
0.125
```

## 样例 #2

### 输入

```
100 2

3 7
```

### 输出

```
0.0
```

## 样例 #3

### 输入

```
11 8562174

25686522 17124348
```

### 输出

```
0.018174648284912
```



---

---
title: "[ABC013C] 節制"
layout: "post"
diff: 普及+/提高
pid: AT_abc013_3
tag: []
---

# [ABC013C] 節制

## 题目描述

安全意识很高的高桥君买了最好的锁，然而他的钱包因此出现了一场金钱危机

高桥君领工资的时间不稳定，下一次领工资的时间是从现在开始N日后，于是高桥君在N天内开始尽量抑制伙食费，过起了节约的生活。

首先，高桥的饱食度是H，对于N天中的每一天高桥君可以选择下列三种饮食中的一种：

· 普通的饮食：支付A日元的费用，增加B点饱食度

· 朴素的饮食：支出C日元，增加D饱食度

· 不吃饭：不支出费用，但是高桥君的肚子饿极了，会降低E点饱食度

对于以上饮食方案，C<A，D<B

如果严格节约的话，可以减少支出，但是如果太节约了，高桥君的身体就会不舒服，所以N天内每一天的饱食度都不能降到0以下

高桥君有超人级的胃袋，其饱食度是没有上限的，也就是说，无论怎么吃，高桥君的饱食度都不会达到最大值

现在请你回答高桥君最低能用多少日元的伙食费坚持这N天呢？

## 输入格式

输入按以下标准提供

第一行输入表示节约生活天数的整数N（1<=N<=5e5），表示节约生活开始前高桥的饱食度的整数H（1<=H<=1e9），中间以空格分开

第二行输入表示3种饮食的信息的整数A、B、C、D、E，中间以空格分开

对于支出，保证1<=C<A<=1e6

对于饱食度的增减，保证1<=D<B<=1e6，1<=E<=1e6

## 输出格式

一行，输出在饱食度不小于0的情况下，高桥君度过N天所需的最少伙食费

输出末尾添加换行符

## 说明/提示

对于10%的数据，N<=10

对于50%的数据，N<=50，H<=50，B<=50，D<=50

对于100%的数据，N<=1000

对于数据，请勿使用32位整形（取自原题面）

Translated by @权御天下

## 样例 #1

### 输入

```
4 5

100 4 60 1 4
```

### 输出

```
160
```

## 样例 #2

### 输入

```
10 1

5000 2 2000 1 300
```

### 输出

```
20000
```

## 样例 #3

### 输入

```
9 23

170 8 120 5 12
```

### 输出

```
650
```

## 样例 #4

### 输入

```
653 314159

6728 123456 5141 41928 222222
```

### 输出

```
2818162
```



---

---
title: "[ABC013D] 阿弥陀"
layout: "post"
diff: 普及+/提高
pid: AT_abc013_4
tag: []
---

# [ABC013D] 阿弥陀

## 题目描述

你知道从古至今传承下来的日本传统抽签方法——鬼脚图（日语：阿弥陀籤/あみだくじ）吗？

进行鬼脚图时，首先画出 $N$ 条平行的竖线。接着，在这些竖线之间画 $M$ 条横线。每条横线必须连接相邻的两条竖线，且不能有两条或更多的横线在完全相同的高度上。假设从上往下数的第 $i$ 条横线连接了从左往右数的第 $A_i$ ($1\le A_i < N$) 条竖线和第 $A_i + 1$ 条竖线。

以下是 $N = 5,M = 7,A = \{1,4,3,4,2,3,1\}$ 情况下的鬼脚图示例。抽签时，从某条竖线的顶部出发，沿着线向下走。当遇到横线时，必须转弯，且不能回头向上。例如，在这个鬼脚图中，从左往右数第 $4$ 条竖线顶部开始，最终会到达左边数第 $3$ 条竖线的底部。

![](https://cdn.luogu.com.cn/upload/vjudge_pic/AT_abc013_4/287d97cea4ffe55ad2fe3822a307197d29129150.png)

以上是普通的鬼脚图。然而，在“大数据”这一术语流行的当下，鬼脚图若想在未来继续存在下去，也需要“大”起来，以迎战“大数据”。

因此，我们考虑通过将多个鬼脚图**纵向连接 $D$ 次**，构造一个巨大的鬼脚图。例如，将上面提到的鬼脚图纵向连接 $2$ 次，可以得到如下示例。在这种情况下，从左边数第 $4$ 条竖线顶部开始抽签，最终会到达左边数第 $5$ 条竖线的底部。

![](https://cdn.luogu.com.cn/upload/vjudge_pic/AT_abc013_4/ff270a32cd6de8309812dd03feb2e11021ca985c.png)

虽然我们构造了如此巨大的鬼脚图，但如果无法高效计算抽签的结果，这个巨大的鬼脚图也不过是徒有其表的涂鸦。因此，请编写一个程序，对于满足 $1\le k\le N$ 的每个整数 $k$，计算在巨大鬼脚图中，从左边数第 $k$ 条竖线顶部开始抽签，最终会到达左边数第几条竖线底部。

## 输入格式

输入以以下格式通过标准输入提供：

> $N$ $M$ $D$ $A_1$ $A_2$ $\cdots$ $A_M$

- 第 1 行包含 $3$ 个整数，表示初始鬼脚图的竖线数量 $N$（$2\le N\le 10^5$）、横线数量 $M$（$0\le M\le 2 \times 10^5$）、以及将初始鬼脚图纵向连接的次数 $D$（$1\le D\le 10^9$）。
- 第 2 行包含 $M$ 个整数 $A_1, A_2, \cdots, A_M$（$1\le A_i < N$），表示每条横线的连接信息。

## 输出格式

输出 $N$ 行，第 $k$ 行输出一个整数，表示在巨大鬼脚图中，从左边数第 $k$ 条竖线顶部开始抽签，最终会到达左边数第几条竖线底部。

输出的末尾需包含换行符。

### 部分分

测试样例分为 4 组，分别有如下限制条件及分数：

1. 第一组：$D = 1$，全部正确可得 $10$ 分。
2. 第二组：$N\le 1000$ 且 $D\le 1000$，全部正确可得 $20$ 分。
3. 第三组：$N\le 8$，全部正确可得 $20$ 分。
4. 第四组：无额外限制条件，全部正确可得 $50$ 分。

题面译自 [D - 阿弥陀](https://atcoder.jp/contests/abc013/tasks/abc013_4)。翻译来自于 [ChatGPT](https://chatgpt.com) 并进行人工校对，若有误请联系 [rui_er](https://www.luogu.com.cn/user/122461)。

## 样例 #1

### 输入

```
5 7 1

1 4 3 4 2 3 1
```

### 输出

```
4

2

5

3

1
```

## 样例 #2

### 输入

```
5 7 2

1 4 3 4 2 3 1
```

### 输出

```
3

2

1

5

4
```

## 样例 #3

### 输入

```
10 20 300

9 1 2 5 8 1 9 3 5 6 4 5 4 6 8 3 2 7 9 6
```

### 输出

```
3

7

2

4

5

9

6

1

8

10
```



---

---
title: "[ABC014D] 閉路"
layout: "post"
diff: 普及+/提高
pid: AT_abc014_4
tag: []
---

# [ABC014D] 閉路

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc014/tasks/abc014_4

$ n $ 個の頂点と $ n-1 $ 本の辺からなる連結な無向グラフが与えられます．それぞれの頂点には $ 1 $ から $ n $ までの番号が順番にふられています．

グラフ理論において，このような条件を満たすグラフは木と呼ばれ，閉路を含まないという性質があります． このグラフに対し，元のグラフに含まれない追加辺 $ (a,b) $ を1つ追加したグラフについて考えてみると，このグラフはちょうど1つの閉路を含みます． あなたの仕事は，そのようなグラフについて，閉路の長さ(閉路に含まれる辺の数)を出力することです．ただ，追加辺の候補はいくつかあり，$ Q $ 個与えられるので，それら全ての候補について答えを出力してください．

## 输入格式

入力は以下の形式で標準入力から与えられる．

> $ N $ $ x_1\ y_1 $ $ x_2\ y_2 $ ： $ x_{N-1}\ y_{N-1} $ $ Q $ $ a_1\ b_1 $ $ a_2\ b_2 $ ： $ a_{Q}\ b_{Q} $

- $ 1 $ 行目には，グラフの頂点数を表す整数 $ N\ (1≦N≦100,000) $ が与えられる．
- 続く$ 2 $ 行目から$ N-1 $行は，グラフの辺情報を表す．$ i $番目の行には，辺が結ぶ頂点 $ x_i $ と $ y_i $が空白区切りで与えられる．
- 続く$ 1+N $ 行目には，辺$ (a,b) $の候補の数を表す整数 $ Q\ (1≦Q≦100,000) $ が与えられる．
- 続く$ 2+N $ 行目から$ Q $行は，$ i $番目の追加辺候補の情報を表す．$ i $ 番目の行には，追加辺が結ぶ頂点 $ a_i $ と $ b_i $が空白区切りで与えられる．
- 与えられる辺は全て，存在する頂点を結んでいる．
- グラフは自己辺を含まない．つまり，任意の$ i $について，$ x_i≠y_i $が成り立つ．
- グラフは多重辺を含まない．つまり，任意の$ i,j(i≠j) $について，$ x_i≠x_j $もしくは$ y_i≠y_j $が成り立つ．
- 追加辺は，元のグラフに含まれない辺であり自己辺でないことが保障されている．

## 输出格式

全ての追加辺候補について，それを元のグラフに追加したときにできる閉路の長さを，$ 1 $ 行目から $ Q $ 行順番に出力せよ．出力の末尾に改行を入れること．

## 说明/提示

### 部分点

この問題には2つのデータセットがあり，データセット毎に部分点が設定されている．

- $ Q=1 $ を満たすデータセット 1 に正解した場合は $ 30 $ 点が与えられる．
- 追加制約のないデータセット 2 に正解した場合は，上記のデータセットとは別に $ 70 $ 点が与えられる．

### Sample Explanation 1

図は以下の通りです．
![](https://atcoder.jp/img/abc/014/d1.png)

## 样例 #1

### 输入

```
5

1 2

1 3

1 4

4 5

3

2 3

2 5

2 4
```

### 输出

```
3

4

3
```

## 样例 #2

### 输入

```
6

1 2

2 3

3 4

4 5

5 6

4

1 3

1 4

1 5

1 6
```

### 输出

```
3

4

5

6
```

## 样例 #3

### 输入

```
7

3 1

2 1

2 4

2 5

3 6

3 7

5

4 5

1 6

5 6

4 7

5 3
```

### 输出

```
3

3

5

5

4
```



---

---
title: "[ABC015D] 高橋くんの苦悩"
layout: "post"
diff: 普及+/提高
pid: AT_abc015_4
tag: []
---

# [ABC015D] 高橋くんの苦悩

## 题目描述

# 题目大意

你有 $N$ 个物品，第 $i$ 个物品的重量为 $A_i$ ，体积为 $1$ ，价值为 $B_i$ ，你还有一个背包，背包的容积为 $K$ ，所能承受的最大重量为 $W$ ，现在你要将一些物品放入背包中，求放入背包的物品的最大价值。

## 输入格式

输入共三行。

第一行输入一个数 $W(1\le W\le10000)$ ，表示背包所能承受的最大重量。

第二行输入两个数 $N,K(1\le K\le N\le50)$ ，表示物品的数量和背包的容积。

剩下的 $n$ 行分别输入两个数 $A_i,B_i(1\le A_i\le1000,1\le B_i\le100)$ ，表示第 $i$ 个物品的重量和价值。

## 输出格式

一个数 $ans$ ，表示放入背包的物品的最大价值。

## 样例 #1

### 输入

```
10

3 2

4 20

3 40

6 100
```

### 输出

```
140
```

## 样例 #2

### 输入

```
10

5 4

9 10

3 7

3 1

2 6

4 5
```

### 输出

```
18
```

## 样例 #3

### 输入

```
22

5 3

5 40

8 50

3 60

4 70

6 80
```

### 输出

```
210
```



---

---
title: "[ABC017C] ハイスコア"
layout: "post"
diff: 普及+/提高
pid: AT_abc017_3
tag: []
---

# [ABC017C] ハイスコア

## 题目描述

### 题意 

高桥君非常喜欢打电动。

现在他在玩的这个游戏中有 $N$ 个遗迹，你可以按照你喜欢的顺序去探索这些遗迹（不一定都要探索）。在探索遗迹的过程中会获得宝石，游戏中一共有 $M$ 种宝石。

当你探索过第 $i(1\le i \le N)$ 个遗迹后，你的得分将增加 $s_i$，同时，你将得到所有种类编号在 $l_i$ 到 $r_i$ 之间的宝石各一个，但是再一次探索同一个遗迹的话，你将什么都无法得到。

获得的宝石无法被丢弃，当所有种类的宝石都获得之后，会复活魔王导致得分清零且不再能得分。

高桥君想要得到尽可能高的分数，请求出在不复活魔王的情况下，可以得到的分数最高能是多少。

## 输入格式

输入是由标准输入提供的，格式如下：

```
N M
l1 r1 s1
l2 r2 s2
:
lN rN sN
```

## 输出格式

一行一个整数，表示你的答案。**注意在最后输出一个换行**。

## 说明/提示

- $1\le N \le 10^5$
- $1\le M \le 10^5$
- $1\le l_i,r_i \le M$
- $1\le s_i \le 5\times 10^3$
- 所有读入的数值都是整数。

---

## 样例 #1

### 输入

```
4 6

1 3 30

2 3 40

3 6 25

6 6 10
```

### 输出

```
80
```

## 样例 #2

### 输入

```
2 7

1 3 90

5 7 90
```

### 输出

```
180
```

## 样例 #3

### 输入

```
1 4

1 4 70
```

### 输出

```
0
```



---

---
title: "[ABC018C] 菱型カウント"
layout: "post"
diff: 普及+/提高
pid: AT_abc018_3
tag: []
---

# [ABC018C] 菱型カウント

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc018/tasks/abc018_3

縦 $ R $ 行、横 $ C $ 列の長方形領域がある。上から $ i\ (1\ ≦\ i\ ≦\ R) $ 行目、左から $ j\ (1\ ≦\ j\ ≦\ C) $ 列目にあるマスをマス ($ i $, $ j $) と呼ぶことにする。これらのマスのうちいくつかのマスは黒く、他のマスは白く塗られている。

また、ある整数 $ K $ が定められている。

ここで、以下の条件を満たすように新たに緑色を塗ることを考える。この操作は1 回だけ行う。

- ある整数 の組 $ x\ (K\ ≦\ x\ ≦\ R\ -\ K\ +\ 1) $, $ y\ (K\ ≦\ y\ ≦\ C\ -\ K\ +\ 1) $ に対して、|$ i-x $|+|$ j-y $|$ ≦\ K\ -\ 1 $ を満たすすべてのマス ($ i $,$ j $) について、マス ($ i $,$ j $) は元々白いマスで、かつ、この操作で緑色に塗られる。さらに、|$ i-x $|+|$ j-y $|$ ≧\ K $ を満たすすべてのマスについて、そのマスは緑色に塗らない。

このような色の塗り方の総数はいくらか。ただし、ここでいう塗り方とは、どのマスがどの色になったかという組み合わせのことで、色の塗る順番は考慮しないものとする。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ R $ $ C $ $ K $ $ s_1 $ $ s_2 $ : $ s_R $

- $ 1 $ 行目には、$ 3 $ つの整数 $ R\ (3\ ≦\ R\ ≦\ 500) $, $ C\ (3\ ≦\ C\ ≦\ 500) $, $ K\ (2\ ≦\ K\ ≦\ 500) $ が空白区切りで書かれている。これは、長方形領域が縦 $ R $ 行、横 $ C $ 列あることを表す。$ K $ は文中で定められた整数である。
- $ 2 $ 行目から $ R $ 行には、マスに関する情報が与えられる。$ R $ 行のうち $ i\ (1\ ≦\ i\ ≦\ R) $ 行目には、長さ $ C $ の文字列 $ s_i $ が与えられる。文字列 $ s_i $ は `o`, `x` の $ 2 $ 種類の文字でのみ構成されており、$ s_i $ の左から $ j\ (1\ ≦\ j\ ≦\ C) $ 文字目の文字が `o` ならマス ($ i $,$ j $) が白いマスであることを、`x` ならマス ($ i $,$ j $) が黒いマスであることを表す。

## 输出格式

緑色の塗り方の総数を $ 1 $ 行に出力せよ。出力の末尾に改行を入れること。

## 说明/提示

### 部分点

この問題には部分点が設定されている。

- $ R\ ≦\ 50 $ かつ $ C\ ≦\ 50 $ を満たすデータセット $ 1 $ に正解した場合は、$ 30 $ 点が与えられる。

### Sample Explanation 1

以下の $ 3 $ 通りが考えられます (`o` は白いマス、`x` は黒いマス、`\*` は緑色のマスを表します)。 x\\\*ooo\\\*\\\*\\\*oxo\\\*ooooxxoo xo\\\*ooo\\\*\\\*\\\*xoo\\\*oooxxoo xooooooo\\\*xoo\\\*\\\*\\\*oxx\\\*o

## 样例 #1

### 输入

```
4 5 2

xoooo

oooox

ooooo

oxxoo
```

### 输出

```
3
```

## 样例 #2

### 输入

```
4 5 2

ooooo

oxoox

oooox

oxxoo
```

### 输出

```
0
```

## 样例 #3

### 输入

```
8 6 3

oooooo

oooooo

oooooo

oooooo

oxoooo

oooooo

oooooo

oooooo
```

### 输出

```
4
```



---

---
title: "[ABC018D] バレンタインデー"
layout: "post"
diff: 普及+/提高
pid: AT_abc018_4
tag: []
---

# [ABC018D] バレンタインデー

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc018/tasks/abc018_4

あるクラスには女子が $ N $ 人、男子が $ M $ 人いる。女子には $ 1 $ から $ N $ までの出席番号が、男子には $ 1 $ から $ M $ までの出席番号が割り当てられている。

幸運のキューピットはここから女子 $ P $ 人と男子 $ Q $ 人からなる、1 つの旅行グループを作る。

$ N $ 人の女子は合わせて $ R $ 個のチョコレートを持っており、チョコレートには $ 1 $ から $ R $ までの番号が付けられている。

チョコレート $ i\ (1\ ≦\ i\ ≦\ R) $ は出席番号が $ x_i $ である女子が持っており、旅行中に出席番号が $ y_i $ である男子に渡す予定である。そのため旅行グループに出席番号が $ x_i $ である女子と出席番号が $ y_i $ である男子が両方含まれていた場合に限り渡すことができる。無事にチョコレート $ i $ が渡された場合の幸福度は $ z_i $ である。

無事に渡されたチョコレートによる幸福度の合計値として考えられる最大値はいくらか。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ M $ $ P $ $ Q $ $ R $ $ x_1 $ $ y_1 $ $ z_1 $ $ x_2 $ $ y_2 $ $ z_2 $ : $ x_R $ $ y_R $ $ z_R $

- $ 1 $ 行目には、$ 5 $ つの整数 $ N\ (1\ ≦\ N\ ≦\ 18) $, $ M\ (1\ ≦\ M\ ≦\ 18) $, $ P\ (1\ ≦\ P\ ≦\ N) $, $ Q\ (1\ ≦\ Q\ ≦\ M) $, $ R\ (1\ ≦\ R\ ≦\ N×M) $ が空白区切りで書かれている。これは、クラスに女子が $ N $ 人、男子が $ M $ 人おり、旅行グループは女子 $ P $ 人、男子 $ Q $ 人からなり、チョコレートが $ R $ 個あることを表す。
- $ 2 $ 行目から $ R $ 行には、チョコレートに関する情報が与えられる。$ R $ 行のうち $ i\ (1\ ≦\ i\ ≦\ R) $ 行目には、$ 3 $ つの整数 $ x_i\ (1\ ≦\ x_i\ ≦\ N) $, $ y_i\ (1\ ≦\ y_i\ ≦\ M) $, $ z_i\ (1\ ≦\ z_i\ ≦\ 10,000) $ が空白区切りで与えられる。これは、チョコレート $ i $ を出席番号が $ x_i $ である女子が持っており、旅行中に出席番号が $ y_i $ である男子に渡す予定であり、チョコレート $ i $ の幸福度が $ z_i $ であることを表す。
- $ 1\ ≦\ i\ ＜\ j\ ≦\ R $ である整数 $ i $,$ j $ に対して、$ x_i≠x_j $ または $ y_i≠y_j $ が成り立つ。

## 输出格式

無事に渡されたチョコレートによる幸福度の合計値として考えられる最大値を $ 1 $ 行に出力せよ。(21:51 表現の変更)出力の末尾に改行を入れること。

## 说明/提示

### 部分点

この問題には部分点が設定されている。

- $ N\ ≦\ 8 $ かつ $ M\ ≦\ 8 $ を満たすデータセット $ 1 $ に正解した場合は、$ 30 $ 点が与えられる。

### Sample Explanation 1

出席番号が $ 1 $, $ 2 $ の女子と出席番号が $ 2 $, $ 3 $, $ 4 $ の男子からなる旅行グループを考えます。 - チョコレート $ 1 $ は出席番号が $ 1 $ の男子が旅行に参加しないため、渡されません。 - チョコレート $ 2 $ は受け渡しする男女がともに旅行に参加するため、無事に渡されます。チョコレートの幸福度は $ 7 $ です。 - チョコレート $ 3 $ は受け渡しする男女がともに旅行に参加するため、無事に渡されます。チョコレートの幸福度は $ 15 $ です。 - チョコレート $ 4 $ は受け渡しする男女がともに旅行に参加するため、無事に渡されます。チョコレートの幸福度は $ 6 $ です。 - チョコレート $ 5 $ は受け渡しする男女がともに旅行に参加するため、無事に渡されます。チョコレートの幸福度は $ 3 $ です。 - チョコレート $ 6 $ は受け渡しする男女がともに旅行に参加するため、無事に渡されます。チョコレートの幸福度は $ 6 $ です。 - チョコレート $ 7 $ は出席番号が $ 3 $ の女子が旅行に参加しないため、渡されません。 幸福度の合計値は $ 7\ +\ 15\ +\ 6\ +\ 3\ +\ 6\ =\ 37 $ となり、これが最大値となります。

## 样例 #1

### 输入

```
3 4 2 3 7

1 1 9

1 2 7

1 3 15

1 4 6

2 2 3

2 4 6

3 3 6
```

### 输出

```
37
```

## 样例 #2

### 输入

```
4 5 3 2 9

2 3 5

3 1 4

2 2 2

4 1 9

3 5 3

3 3 8

1 4 5

1 5 7

2 4 8
```

### 输出

```
26
```



---

---
title: "[ABC020C] 壁抜け"
layout: "post"
diff: 普及+/提高
pid: AT_abc020_c
tag: []
---

# [ABC020C] 壁抜け

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc020/tasks/abc020_c

正方形のマスが縦 $ H $ 行、横 $ W $ 列に並んでいます。各マスは白または黒で塗られており、白マスのうち $ 2 $ つがそれぞれスタート地点とゴール地点として指定されています。

高橋君はスタート地点から出発して $ T $ 秒以内にゴール地点に到着したいです。高橋君は、各マスから上下左右に隣接する別のマスに移動することができます。このとき、移動先が白マスであれば $ 1 $ 秒、黒マスであれば $ x $ 秒の時間がかかります（移動前のマスの色は移動時間に影響しません）。ここで、 $ x $ の値は高橋君がスタート地点から出発する前にあなたに選んでもらいます。 $ x $ の値は正整数でなければならず、高橋君の出発後に値を変更することはできません。

高橋君が $ T $ 秒以内にゴール地点に到着することが可能であるような正整数 $ x $ の最大値を求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ H $ $ W $ $ T $ $ s_{1,1} $$ s_{1,2} $ .. $ s_{1,W} $ $ s_{2,1} $$ s_{2,2} $ .. $ s_{2,W} $ : $ s_{H,1} $$ s_{H,2} $ .. $ s_{H,W} $

- $ 1 $ 行目には、 $ 3 $ 個の整数 $ H, $ $ W, $ $ T $ ($ 2 $ $ ≦ $ $ H, $ $ W $ $ ≦ $ $ 10, $ $ 2 $ $ ≦ $ $ T $ $ ≦ $ $ 10^9 $) が与えられる。これらはそれぞれ、マスの行数と列数、および高橋君の目標時間を表す。
- $ 2 $ 行目から $ H\ +\ 1 $ 行目には、各マスの情報が与えられる。 $ i\ +\ 1 $ 行目の $ j $ 文字目 $ s_{i,j} $ が $ i $ 行 $ j $ 列目のマスに対応する。各文字の意味は以下の通り： 
  - `.` : スタート地点にもゴール地点にも指定されていない白マス
  - `S` : スタート地点として指定された白マス
  - `G` : ゴール地点として指定された白マス
  - `#` : 黒マス
   
   これら以外の文字は $ s_{i,j} $ として出現せず、 `S` および `G` はそれぞれちょうど $ 1 $ 個ずつ出現する。また、入力では求める最大値が存在することが保証される。すなわち、少なくとも $ 1 $ 度は黒マスに移動しなければスタート地点から出発してゴール地点に到着できないこと、および $ x\ =\ 1 $ のとき $ T $ 秒以内にゴール地点に到着することが可能であることが保証される。

## 输出格式

標準出力に、 高橋君が $ T $ 秒以内にゴール地点に到着することが可能であるような正整数 $ x $ の最大値を出力せよ。

末尾の改行を忘れないこと。

## 说明/提示

### 部分点

この問題には部分点が設定されている。

- $ 40 $ 点分のテストケースは $ 2 $ $ ≦ $ $ H, $ $ W $ $ ≦ $ $ 3, $ $ 2 $ $ ≦ $ $ T $ $ ≦ $ $ 30 $ を満たす。
- 別の $ 30 $ 点分のテストケースは $ 2 $ $ ≦ $ $ T $ $ ≦ $ $ 30 $ を満たす。

（※ 問題 D にも部分点が設定されています。そちらもご確認ください。）

### Sample Explanation 1

$ i $ 行 $ j $ 列目のマスを $ (i,\ j) $ で表します。 $ x\ =\ 8 $ のとき、 $ (1,\ 1)\ →\ (2,\ 1)\ →\ (2,\ 2)\ →\ (2,\ 3) $ と移動すると $ 1\ +\ 8\ +\ 1\ =\ 10 $ 秒でゴール地点に到着することができます。 $ x\ \geq\ 9 $ のとき、 $ 10 $ 秒以内にゴール地点に到着することはできません。

### Sample Explanation 2

スタート地点から右に直進すると $ 2x\ +\ 1 $ 秒でゴール地点に到達できます。遠回りすることで黒マスへの移動回数を減らすことができますが、 $ x $ の値によってはかえって時間がかかってしまいます。

## 样例 #1

### 输入

```
2 3 10

S##

.#G
```

### 输出

```
8
```

## 样例 #2

### 输入

```
3 4 7

S##G

.##.

..#.
```

### 输出

```
3
```

## 样例 #3

### 输入

```
4 4 1000000000

S###

####

####

###G
```

### 输出

```
199999999
```



---

---
title: "[ABC021D] 多重ループ"
layout: "post"
diff: 普及+/提高
pid: AT_abc021_d
tag: []
---

# [ABC021D] 多重ループ

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc021/tasks/abc021_d

新入社員の高橋君は、とある企業の新人プログラマーとして部署に配属されました。 高橋君が担当した初めての仕事は、以下の擬似コードで表されるプログラムを高速化するというものでした。

 ```

n←(標準入力)
ans←0
for i=1..n
  for j=i..n
    ans ← ans+1
ansの値を表示
```

高橋君にかかってしまえばこんな仕事はお茶の子さいさいです。 各 $ i $ に対する内側のループ回数を考えて総和の公式を用いれば $ ans=n+n-1+…+1=n(n+1)/2 $ となり、これを用いればすぐ答えが出せます。

劇的な高速化に成功した高橋君への部署からの期待は鰻登りです。そこで、上司は彼に更なる仕事を与えることにしました。

その仕事内容は、以下のような for ループのネストの深さが $ k $ の場合におけるプログラムの高速化です。

 ```

n←(標準入力)
k←(標準入力)
ans←0
for a_1=1..n
  for a_2=a_1..n
    for a_3=a_2..n
      …
      for a_k=a_{k-1}..n // a_0=1とする
        ans ← ans+1
ansの値を表示
```

さすがの高橋君もこれには少し悩みました。総和の公式が使えないからです。

いろいろ考えてみたところ、このプログラムの出力する答えは $ 1≦a_1≦a_2≦…≦a_k≦n $ であるような整数の組 $ (a_1,a_2,…,a_k) $ の個数に等しいということに気づきました。 しかし、彼はそのようなものの個数を数える方法を思いつきませんでした。

彼の同僚であるあなたは、彼の代わりにこの課題をこなすプログラムを作ってあげることにしました。 ただし、答えは非常に大きくなることがあるので、ans の代わりに ans を $ 1,000,000,007(=10^9+7) $ で割った余りを出力してください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ n $ $ k $

- $ 1 $ 行目には、整数 $ n\ (1\ ≦\ n\ ≦\ 10^5) $ が与えられる。
- $ 2 $ 行目には、整数 $ k\ (1\ ≦\ k\ ≦\ 10^5) $ が与えられる。

## 输出格式

$ 1 $ 行目に、$ 2 $ つ目のプログラムにおける最終的な ans の値を $ 1,000,000,007 $ で割った余りを出力してください。

末尾の改行を忘れないこと。

## 说明/提示

### 部分点

この問題には部分点が設定されている。

- $ 1≦n≦1000 $ かつ $ 1≦k≦1000 $ であるようなデータセットに正解した場合は $ 99 $ 点が得られる。
- 上記のデータセットを含む全てのデータセットに正解した場合はさらに $ 1 $ 点が得られる。

## 样例 #1

### 输入

```
10

2
```

### 输出

```
55
```

## 样例 #2

### 输入

```
10

3
```

### 输出

```
220
```

## 样例 #3

### 输入

```
10

4
```

### 输出

```
715
```

## 样例 #4

### 输入

```
400

296
```

### 输出

```
546898535
```

## 样例 #5

### 输入

```
100000

100000
```

### 输出

```
939733670
```



---

---
title: "[ABC022C] Blue Bird"
layout: "post"
diff: 普及+/提高
pid: AT_abc022_c
tag: []
---

# [ABC022C] Blue Bird

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc022/tasks/abc022_c

高橋君の住む街には $ N $ 個の家と $ M $ 個の道があります。 家は $ 1 $ ～ $ N $ の整数によって番号付けされています。 高橋君は家 $ 1 $ に住んでいます。 道も $ 1 $ ～ $ M $ の整数によって番号付けされています。 $ i $ 番目の道は家 $ u_i $ と 家 $ v_i $ を双方向につなぐ長さ $ l_i $ メートルの道です。

高橋君は街のどこかの家に居るという「幸せの青い鳥」を探しています。 実は、「幸せの青い鳥」は高橋くんの家にいて、高橋君もそのことを知っています。 しかし、形だけでも探す旅に出ないと盛り上がりに欠けて面白くないので、仕方なく旅の計画をたてることにしました。

高橋君は自分の家から開始して、同じ道を二度以上通らないようにいくつかの家に訪れ、最後に自分の家に戻ってくる、という旅の計画をたてる予定です。 このとき盛り上がりを作るために、旅の途中で自分の家以外の家を少なくとも $ 1 $ 軒訪れる予定です。 高橋君はこの茶番をできるだけ早く終わらせたいので、通る道の長さの総和が最も小さくなるような計画が最適だと考えています。

高橋君の住む街の家と道の情報が与えられるので、高橋君が上の条件のもとで最適な計画をたてることができるかどうかを求めてください。 もし最適な計画をたてることができるならば、そのとき通る道の長さの総和を求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる

> $ N $ $ M $ $ u_1 $ $ v_1 $ $ l_1 $ $ u_2 $ $ v_2 $ $ l_2 $ : $ u_M $ $ v_M $ $ l_M $

- $ 1 $ 行目には高橋君の住む街にある家の個数 $ N(3\ ≦\ N\ ≦\ 300) $ と 道の本数 $ M(3\ ≦\ M\ ≦\ N(N-1)/2) $ が空白区切りで与えられる。
- $ 2 $ 行目からの $ M $ 行のうち $ i $ 行目には $ i $ 番目の道路が結ぶ家の番号 $ u_i,\ v_i(1\ ≦\ u_i\ ＜\ v_i\ ≦\ N) $ とその長さを表す整数 $ l_i(1\ ≦\ l_i\ ≦\ 10^5) $ が空白区切りで与えられる。
- $ i\ ≠\ j $ ならば $ u_i\ ≠\ u_j $ または $ v_i\ ≠\ v_j $ の少なくとも一方が成り立つ。

## 输出格式

最適な計画をたてることができないならば $ -1 $ を、できるならばそのとき通る道の長さの総和を $ 1 $ 行に出力せよ。出力の末尾にも改行を入れること。

## 说明/提示

### Sample Explanation 1

家と道の様子は以下のようになります !\[\](/img/abc/022/ajfsieojafioes/C\_sample1.png) $ 1,\ 2,\ 5,\ 3,\ 4,\ 1 $ という順番に訪れる計画が最適です。 $ 1,\ 2,\ 1 $ という順番に訪れる計画は $ 1 $ 番目の道を $ 2 $ 回通っているので条件を満たしていません。

### Sample Explanation 2

同じ道を $ 2 $ 度以上通らない旅の計画をたてることはできません。よって $ -1 $ を出力します。

## 样例 #1

### 输入

```
5 7

1 2 2

1 4 1

2 3 7

1 5 12

3 5 2

2 5 3

3 4 5
```

### 输出

```
13
```

## 样例 #2

### 输入

```
5 4

1 2 1

1 3 1

1 4 1

1 5 1
```

### 输出

```
-1
```

## 样例 #3

### 输入

```
10 12

1 4 3

1 9 1

2 5 4

2 6 1

3 7 5

3 10 9

4 7 2

5 6 6

5 8 5

6 8 3

7 9 5

8 10 8
```

### 输出

```
11
```



---

---
title: "[ABC022D] Big Bang"
layout: "post"
diff: 普及+/提高
pid: AT_abc022_d
tag: []
---

# [ABC022D] Big Bang

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc022/tasks/abc022_d

宇宙はビッグバンによって誕生して以来、膨張し続けていることが知られています。

天文学者である高橋君はその宇宙の膨張の速度を計測することにしました。

高橋君はある $ 2 $ つの日について、同じ $ N $ 個の星の位置を観測しました。星の位置は座標平面上の点として記録されます。つまり各日の観測結果は座標平面上の $ N $ 個の点からなる点集合になります。

$ 2 $ 回の観測の結果を見比べてみると、$ 1 $ 回目の観測結果である点集合に対して以下の $ 3 $ つの操作を順に実行すると $ 2 $ 回目の観測結果である点集合に一致することがわかりました。

1. 同じ向きに同じ距離だけ平行移動する。
2. 原点を中心に同じ角度だけ回転する。
3. 原点を中心に $ P $ 倍 $ (1\ ≦\ P) $ に相似拡大する。つまり点 $ (a,\ b) $ を点 $ (a×P,\ b×P) $ に移すという操作をすべての点に実行する。

ここで $ P $ の値がわかれば膨張速度を求めることができそうです。

いざ $ P $ を求めようとした高橋君でしたが、うっかりどの点がどの星に対応するのか記したデータをなくしてしまいました。

そこで高橋君は優秀なプログラマーであるあなたに助けを借りることにしました。

$ 1 $ 回目と $ 2 $ 回目の観測結果が与えられるので $ P $ を求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる

> $ N $ $ Ax_1 $ $ Ay_1 $ $ Ax_2 $ $ Ay_2 $ : $ Ax_N $ $ Ay_N $ $ Bx_1 $ $ By_1 $ $ Bx_2 $ $ By_2 $ : $ Bx_N $ $ By_N $

- $ 1 $ 行目には高橋君が観測した星の個数 $ N\ (2\ ≦\ N\ ≦\ 10^5) $ が与えられる。
- $ 2 $ 行目からの $ N $ 行のうち $ i $ 行目には $ 1 $ 回目に観測された $ i $ 番目の星の位置の $ x $ 座標と $ y $ 座標の値を表す $ 2 $ つの整数 $ Ax_i,\ Ay_i\ (-15,000\ ≦Ax_i,\ Ay_i\ ≦\ 15,000) $ が空白区切りで与えられる。
- $ N+2 $ 行目からの $ N $ 行のうち $ i $ 行目には $ 2 $ 回目に観測された $ i $ 番目の星の位置の $ x $ 座標と $ y $ 座標の値を表す $ 2 $ つの整数 $ Bx_i,\ By_i\ (-10^9\ ≦Bx_i,\ By_i\ ≦\ 10^9) $ が空白区切りで与えられる。
- $ 1 $ 回目も $ 2 $ 回目も、同じ点に複数の星が観測されることはない。
- $ 1 $ 回目に観測された $ i $ 番目の星と $ 2 $ 回目に観測された $ i $ 番目の星が同一の星とは限らない。

## 输出格式

$ P $ の値を $ 1 $ 行に出力せよ。 出力は絶対誤差あるいは相対誤差の少なくとも片方が $ 10^{-6} $ 以下であれば許容される。出力の末尾にも改行を入れること。

## 说明/提示

### 部分点

この問題には部分点が設定されている。

- $ 1\ ≦\ N\ ≦\ 3,000 $を満たすデータセットに正解した場合は $ 50 $ 点が与えられる。
- $ 1\ ≦\ N\ ≦\ 10^5 $を満たすデータセットに正解した場合はさらに $ 50 $ 点が与えられる。合計で$ 100 $点となる。

### Sample Explanation 1

以下のように操作を実行すれば、 $ 1 $ 回目の観測結果の点集合が、 $ 2 $ 回目の観測結果の点集合に移されます。 1. $ x $ 軸方向に $ -0.5 $、 $ y $ 軸方向に $ -0.5 $ 平行移動させる。 2. 原点を中心にして、$ 45° $ 時計回りに回転させる。 3. 原点を中心に $ 2√2 $ 倍する。 よって $ P\ =\ 2√2 $ となります。

## 样例 #1

### 输入

```
4

0 0

0 1

1 0

1 1

0 2

2 0

-2 0

0 -2
```

### 输出

```
2.8284271247
```

## 样例 #2

### 输入

```
6

3 4

1 3

4 3

2 2

0 1

2 0

5 5

-1 2

-1 -3

2 1

2 6

4 -3
```

### 输出

```
2.2360679775
```



---

---
title: "[ABC023C] 収集王"
layout: "post"
diff: 普及+/提高
pid: AT_abc023_c
tag: []
---

# [ABC023C] 収集王

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc023/tasks/abc023_c

高橋君はある部屋に移動する予定です。

部屋は正方形のマスが縦に $ R $ 行、横に $ C $ 列並んだ形状をしています。このうち $ i\ (1\ ≦\ i\ ≦\ R) $ 行目の $ j\ (1\ ≦\ j\ ≦\ C) $ 列目にあるマスをマス $ (i,j) $ と呼ぶことにします。

これらのマスには飴が合計 $ N $ 個存在します。飴には $ 1 $ から $ N $ までの番号が付けられており、飴 $ i\ (1\ ≦\ i\ ≦\ N) $ はマス $ (r_i,c_i) $ に置いてあります。これらのうちどの $ 2 $ つの飴も同一のマス上にありません。

高橋君はマスのうち任意の $ 1 $ マスに移動します。移動した後、高橋君は次に示すように飴を獲得します。

- 最初に、高橋君がいるマスと同じ行にあるすべてのマスについて、そのマスにある飴をすべて獲得する。
- 次に、高橋君がいるマスと同じ列にあるすべてのマスについて、そのマスにあるすべての飴を獲得する。

高橋君はこの行動以外には何も行動しません。

高橋君は獲得する飴の個数がちょうど $ K $ 個になるようにしたいです。このような移動先として考えられるマスの総数を求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ R $ $ C $ $ K $ $ N $ $ r_1 $ $ c_1 $ $ r_2 $ $ c_2 $ : $ r_N $ $ c_N $

- $ 1 $ 行目には、$ 3 $ つの整数 $ R\ (1\ ≦\ R\ ≦\ 100,000) $, $ C\ (1\ ≦\ C\ ≦\ 100,000) $, $ K\ (1\ ≦\ K\ ≦\ 100,000) $ が空白区切りで書かれている。これは、部屋を構成する正方形マスが縦 $ R $ 行、横 $ C $ 列あることを表す。$ K $ は高橋君が獲得したい飴の個数である。
- $ 2 $ 行目には、飴の個数を表す整数 $ N\ (K\ ≦\ N\ ≦\ 100,000) $ が与えられる。
- $ 3 $ 行目から $ N $ 行には、飴に関する情報が与えられる。$ N $ 行のうち $ i\ (1\ ≦\ i\ ≦\ N) $ 行目には、$ 2 $ つの整数 $ r_i\ (1\ ≦\ r_i\ ≦\ R) $, $ c_i\ (1\ ≦\ c_i\ ≦\ C) $ が空白区切りで書かれている。これは飴 $ i $ がマス ($ r_i $,$ c_i $) にあることを表す。
- $ i≠j $ のとき、$ (r_i,c_i)≠(r_j,c_j) $ となる。

## 输出格式

獲得する飴の個数がちょうど $ K $ 個になるような移動先の総数を $ 1 $ 行に出力せよ。出力の末尾にも改行を入れること。

## 说明/提示

### 部分点

この問題には部分点が設定されている。

- $ R\ ≦\ 50 $ かつ $ C\ ≦\ 50 $ かつ $ N\ ≦\ 50 $ を満たすデータセット $ 1 $ に正解した場合は、$ 30 $ 点が与えられる。
- 追加制約のないデータセット $ 2 $ に正解した場合は、上記とは別に $ 70 $ 点が与えられる。

### Sample Explanation 1

例えば、マス $ (3,2) $ に高橋君が移動した場合を考えます。 - 飴 $ 1 $ は、マス $ (1,2) $ にあります。このマスはマス $ (3,2) $ と同じ列にあるので、高橋君は飴 $ 1 $ を獲得します。 - 飴 $ 2 $ は、マス $ (2,1) $ にあります。このマスはマス $ (3,2) $ と同じ行にも同じ列にもないので、高橋君は飴 $ 2 $ を獲得しません。 - 飴 $ 3 $ は、マス $ (2,5) $ にあります。このマスはマス $ (3,2) $ と同じ行にも同じ列にもないので、高橋君は飴 $ 3 $ を獲得しません。 - 飴 $ 4 $ は、マス $ (3,2) $ にあります。このマスはマス $ (3,2) $ と同じマス (同じ行かつ同じ列) にあるので、高橋君は飴 $ 4 $ を獲得します。 - 飴 $ 5 $ は、マス $ (3,5) $ にあります。このマスはマス $ (3,2) $ と同じ行にあるので、高橋君は飴 $ 5 $ を獲得します。 以上より、飴 $ 1 $, $ 4 $, $ 5 $ のちょうど $ 3 $ 個だけ飴を獲得するので、マス $ (3,2) $ は獲得する飴の個数がちょうど $ K $ 個になるような移動先です。 他にもマス $ (1,5) $, $ (2,5) $, $ (3,1) $, $ (3,5) $ が条件をみたすので答えとして $ 5 $ を出力します。

### Sample Explanation 2

どのように移動先を指定しても、獲得する飴の個数をちょうど $ 1 $ 個にすることはできません。

## 样例 #1

### 输入

```
3 5 3

5

1 2

2 1

2 5

3 2

3 5
```

### 输出

```
5
```

## 样例 #2

### 输入

```
7 3 1

4

3 2

3 3

4 2

4 3
```

### 输出

```
0
```

## 样例 #3

### 输入

```
5 5 2

5

1 1

2 2

3 3

4 4

5 5
```

### 输出

```
20
```



---

---
title: "[ABC023D] 射撃王"
layout: "post"
diff: 普及+/提高
pid: AT_abc023_d
tag: []
---

# [ABC023D] 射撃王

## 题目描述

高桥最近正在练习射击。
他参加了一个射击比赛，比赛内容是射击气球，让自己得到的分数尽量小。
气球从1到N依次编号。每个气球都有一个起始高度Hi，每个气球每秒可以升高的高度为Si。
高桥开始时可以先打掉一个气球，随后每一秒他可以射击一次。当他打掉气球后，所得的分数就是气球的高度。而最终的的得分就是这些分数中的一个最大值。
高桥想知道他自己能得到的尽量小的分数是多少，来判断自己是否真的是一个菜鸡。

## 输入格式

第一行为气球的个数N（1 ≦ N ≦ 100,000）
下面N+1行，每行两个整数Hi和Si，表示气球的初始高度和气球的升高速度。 (1 ≦ Hi,Si ≦ 1,000,000,000)
输入数据保证气球的高度只会增加而不会下降

## 输出格式

输出一个数，表示高桥能拿到的最小分数

## 样例 #1

### 输入

```
4

5 6

12 4

14 7

21 2
```

### 输出

```
23
```

## 样例 #2

### 输入

```
6

100 1

100 1

100 1

100 1

100 1

1 30
```

### 输出

```
105
```



---

---
title: "[ABC025C] 双子と○×ゲーム"
layout: "post"
diff: 普及+/提高
pid: AT_abc025_c
tag: []
---

# [ABC025C] 双子と○×ゲーム

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc025/tasks/abc025_c

直大くんと直子さんは双子の兄妹です。時々、休日に $ 2 $ 人でゲームをしています。

ゲームは○×ゲームをベースにしており、以下の要領でゲームが行われます。

- ゲームは縦 $ 3 $ マス、横 $ 3 $ マスの盤面を使います。ゲーム開始時点ではどのマスにも文字が書かれていません。
- 挨拶した後、直大くんから始めて交互に文字を書いていきます。文字は盤面上のまだ文字が書かれていないマスの上にのみ書くことができます。そのようなマスが複数ある場合は好きな $ 1 $ 箇所を選んで書きます。書く文字は、直大くんが○、直子さんが×です。
- 合わせて $ 9 $ 回文字を書いた時点で、すべてのマスが埋まります。その後、得点計算を行い、得点の高い方が勝ちます。

得点計算は以下の方法で行われます。ここで、盤面の左上のマスをマス $ (1,\ 1) $ とし、左上から下に $ i-1\ (1\ ≦\ i\ ≦\ 3) $ マス、右に $ j-1\ (1\ ≦\ j\ ≦\ 3) $ マス進んだところにあるマスをマス $ (i,\ j) $ と呼ぶことにします。

- $ 1\ ≦\ i\ ≦\ 2 $ および $ 1\ ≦\ j\ ≦\ 3 $ を満たすすべての整数組 $ (i,j) $ に対して、マス $ (i,j) $ とマス $ (i+1,j) $ に書かれているマスを見て、同じ文字が書かれていたなら直大くんに、違う文字が書かれていたなら直子さんに $ b_{i,j} $ 点が入る。
- $ 1\ ≦\ i\ ≦\ 3 $ および $ 1\ ≦\ j\ ≦\ 2 $ を満たすすべての整数組 $ (i,j) $ に対して、マス $ (i,j) $ とマス $ (i,j+1) $ に書かれているマスを見て、同じ文字が書かれていたなら直大くんに、違う文字が書かれていたなら直子さんに $ c_{i,j} $ 点が入る。

直大くんも直子さんも、最終的に得られる自分の得点ができるだけ多くなるようにゲームを行います。両者が最善を尽くしたときのそれぞれの得点を計算してください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ b_{1,1} $ $ b_{1,2} $ $ b_{1,3} $ $ b_{2,1} $ $ b_{2,2} $ $ b_{2,3} $ $ c_{1,1} $ $ c_{1,2} $ $ c_{2,1} $ $ c_{2,2} $ $ c_{3,1} $ $ c_{3,2} $

- $ 1 $ 行目には、$ 3 $ つの整数 $ b_{1,1}\ (0\ ≦\ b_{1,1}\ ≦\ 100) $ と $ b_{1,2}\ (0\ ≦\ b_{1,2}\ ≦\ 100) $ と $ b_{1,3}\ (0\ ≦\ b_{1,3}\ ≦\ 100) $ が空白区切りで書かれている。
- $ 2 $ 行目には、$ 3 $ つの整数 $ b_{2,1}\ (0\ ≦\ b_{2,1}\ ≦\ 100) $ と $ b_{2,2}\ (0\ ≦\ b_{2,2}\ ≦\ 100) $ と $ b_{2,3}\ (0\ ≦\ b_{2,3}\ ≦\ 100) $ が空白区切りで書かれている。
- $ 3 $ 行目には、$ 2 $ つの整数 $ c_{1,1}\ (0\ ≦\ c_{1,1}\ ≦\ 100) $ と $ c_{1,2}\ (0\ ≦\ c_{1,2}\ ≦\ 100) $ が空白区切りで書かれている。
- $ 4 $ 行目には、$ 2 $ つの整数 $ c_{2,1}\ (0\ ≦\ c_{2,1}\ ≦\ 100) $ と $ c_{2,2}\ (0\ ≦\ c_{2,2}\ ≦\ 100) $ が空白区切りで書かれている。
- $ 5 $ 行目には、$ 2 $ つの整数 $ c_{3,1}\ (0\ ≦\ c_{3,1}\ ≦\ 100) $ と $ c_{3,2}\ (0\ ≦\ c_{3,2}\ ≦\ 100) $ が空白区切りで書かれている。

## 输出格式

出力は $ 2 $ 行からなる。$ 1 $ 行目には直大くんの得点を、$ 2 $ 行目には直子さんの得点を出力せよ。出力の末尾に改行を入れること。

## 说明/提示

### Sample Explanation 1

\- 例えば、マス $ (2,1) $ →マス $ (1,1) $ →マス $ (2,2) $ →マス $ (1,3) $ →マス $ (1,2) $ →マス $ (2,3) $ →マス $ (3,1) $ →マス $ (3,2) $ →マス $ (3,3) $ の順に文字が書かれた場合を考えます。この場合、盤面は最終的に以下のようになります。 ×○×○○×○×○- この場合、直大くんの得点は、$ (b_{1,2}\ +\ b_{1,3}\ +\ b_{2,1}\ +\ c_{1,2}\ =\ )\ 15\ +\ 0\ +\ 0\ +\ 0\ =\ 15 $ 点となります。 - 一方、直子さんの得点は、$ (b_{1,1}\ +\ b_{2,2}\ +\ b_{2,3}\ +\ c_{1,1}\ +\ c_{1,2}\ +\ c_{2,2}\ +\ c_{3,1}\ +\ c_{3,2}\ =\ )\ 0\ +\ 0\ +\ 25\ +\ 20\ +\ 10\ +\ 0\ +\ 25\ +\ 0\ =\ 80 $ 点となります。

## 样例 #1

### 输入

```
0 15 0

0 0 25

20 10

0 0

25 0
```

### 输出

```
15

80
```

## 样例 #2

### 输入

```
18 22 15

11 16 17

4 25

22 15

10 4
```

### 输出

```
72

107
```



---

---
title: "[ABC026D] 高橋君ボール1号"
layout: "post"
diff: 普及+/提高
pid: AT_abc026_d
tag: []
---

# [ABC026D] 高橋君ボール1号

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc026/tasks/abc026_d

高橋君は野球が得意です。高橋君は、高橋君ボール $ 1 $ 号という変化球を投げることが出来ます。

このボールは、投げてから $ t $ 秒後のボールの位置を $ f(t) $ とすると、 $ f(t)\ =\ A\ \times\ t\ +\ B\ \times{\rm\ sin}(C\ \times\ t\ \times\ π) $ と表すことが出来ます。

あなたは、$ t\ ≧\ 0 $ かつ $ f(t)\ =\ 100 $ となるタイミングで、ボールを打たなければいけません。この時の $ t $ を求めたいです。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ A $ $ B $ $ C $

- $ 1 $ 行目には、$ f(t) $ の式を表す整数 $ A,B,C\ (1≦A,B,C≦100) $ が、スペース区切りで与えられる。

## 输出格式

$ f(t)\ =\ 100 $ となる、 $ 0 $ 以上の $ t $ を $ 1 $ つ出力せよ。解が複数ある場合は、どの解を出力しても良い。 この問題は誤差が発生するが、 $ |f(t)\ -\ 100|\ ≦\ 10^{-6} $ であれば、正解となる。

出力の末尾には改行を入れること。

誤差が出やすい問題ですので、誤差に十分に注意してください。

## 说明/提示

### Sample Explanation 1

$ t\ =\ 100 $ のとき、 $ f(t)\ =\ 100 $ となります。

### Sample Explanation 2

解が一つではないことに注意してください。

## 样例 #1

### 输入

```
1 1 1
```

### 输出

```
100
```

## 样例 #2

### 输入

```
53 82 49
```

### 输出

```
1.63372043395339
```



---

---
title: "[ABC027C] 倍々ゲーム"
layout: "post"
diff: 普及+/提高
pid: AT_abc027_c
tag: []
---

# [ABC027C] 倍々ゲーム

## 题目描述

高桥君和青木君通过以下的双人游戏决定胜负。

给定正整数 $N$ 并将变量 $x$ 初始化为 $1$ 。从高桥君开始，高桥君和青木君交替操作，将 $x$ 的值换成 $2x$ 或 $2x+1$ 。

当 $x$ 比 $N$ 大的时候游戏结束，最后进行操作的人输。

两个人均以最优策略进行操作，问谁会赢。

## 输入格式

一行一个正整数 $ N $ ($ 1 \le N \le 10^{18} $)

## 输出格式

如果高桥君获胜,就输出 `Takahashi`；如果青木君获胜,就输出 `Aoki`。末尾输出一个换行。

## 样例 #1

### 输入

```
1
```

### 输出

```
Aoki
```

## 样例 #2

### 输入

```
5
```

### 输出

```
Takahashi
```

## 样例 #3

### 输入

```
7
```

### 输出

```
Aoki
```

## 样例 #4

### 输入

```
10
```

### 输出

```
Takahashi
```

## 样例 #5

### 输入

```
123456789123456789
```

### 输出

```
Aoki
```



---

---
title: "[ABC030D] へんてこ辞書"
layout: "post"
diff: 普及+/提高
pid: AT_abc030_d
tag: []
---

# [ABC030D] へんてこ辞書

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc030/tasks/abc030_d

ミカミくんは怪しい英単語帳を使っています。その単語帳には $ N $ 個の単語の意味が載っており、単語 $ i $ の説明には「単語 $ b_i $ と同じ意味である」とだけ書いてあります。ここで、$ i $ 番目の単語を単語 $ i $ と呼ぶことにします。 ミカミくんはまだ一つの英単語も知らないので、単語 $ i $ の意味を調べようとしたとき、単語 $ b_i $ の意味を調べようとします。ミカミくんは真面目なので、今までにすでに調べようとしたことのある単語でも同じように単語帳をひき続けます。 しかし、残念ながらこの単語帳では英単語の意味自体はどこにも書いていないため、意味を知ることはできません。 ある単語 $ i $ を調べようとして、単語帳を参照し、単語 $ b_i $ を調べようとするまでを1ステップとします。

ミカミくんが単語 $ i $ を調べようとして、$ k $ ステップ経ったとき、ミカミくんはどの単語を調べようとしているでしょうか？

### Input &amp; Output Format

入力は以下の形式で標準入力から与えられる。

> $ N $ $ a $ $ k $ $ b_1 $ $ b_2 $ … $ b_N $

- $ 1 $ 行目には、単語の数 $ N\ (2\ ≦\ N\ ≦\ 10^5) $ とミカミくんが調べようとしている単語の番号 $ a\ (1\ ≦\ a\ ≦\ N) $ がスペース区切りで与えられる。
- $ 2 $ 行目には、ミカミくんが単語を調べるステップ数 $ k(1\ ≦\ k\ ≦\ 10^{100000}) $ が与えられる。
- $ 3 $ 行目には、各単語の説明を表す $ N $ 個の整数 $ b_1,...,b_N $ が空白区切りで与えられる。
- $ 1\ ≦\ b_i\ ≦\ N\ かつ\ b_i\ ≠\ i\ (1\ ≦\ i\ ≦\ N) $ であることが保証される。

## 输出格式

ミカミくんが単語 $ a $ を調べようとしてから $ k $ ステップ経ったとき、調べようとしている単語の番号を $ 1 $ 行に出力せよ。出力の末尾にも改行をいれること。

## 说明/提示

### 部分点

この問題には部分点が設定されている。

- $ k\ ≦\ 10^{18} $ を満たすデータセットに正解した場合は $ 50 $ 点が与えられる。

### Sample Explanation 1

ミカミくんは、それぞれのステップで以下のように単語を調べます。 $ 1 $ ステップ目で、単語 $ 4 $ の意味を知るため、単語 $ 2 $ を調べようとします。 $ 2 $ ステップ目で、単語 $ 2 $ の意味を知るため、単語 $ 3 $ を調べようとします。 $ 3 $ ステップ目で、単語 $ 3 $ の意味を知るため、単語 $ 1 $ を調べようとします。 $ 4 $ ステップ目で、単語 $ 1 $ の意味を知るため、単語 $ 2 $ を調べようとします。 $ 5 $ ステップ目で、単語 $ 2 $ の意味を知るため、単語 $ 3 $ を調べようとします。 よって、$ 5 $ ステップ経ったとき、ミカミくんは単語 $ 3 $ を調べようとしています。

### Sample Explanation 2

$ k $ はたいへん大きくなることがあります。

## 样例 #1

### 输入

```
6 4

5

2 3 1 2 6 5
```

### 输出

```
3
```

## 样例 #2

### 输入

```
4 1

100000000000000000000

2 3 4 1
```

### 输出

```
1
```

## 样例 #3

### 输入

```
8 1

1

2 3 4 5 3 2 4 5
```

### 输出

```
2
```



---

---
title: "[ABC031D] 語呂合わせ"
layout: "post"
diff: 普及+/提高
pid: AT_abc031_d
tag: []
---

# [ABC031D] 語呂合わせ

## 题目描述

日本有一种将数字与短字符串对应的记忆文化。

对此产生兴趣的高桥君，决定推断出仅由 $1$ 以上 $K$ 以下的数字组成的正整数 $v_1,v_2,\cdots,v_n$ 以及对应的字符串 $w_1,w_2,\cdots,w_n$ 的组合 $(v_1,w_1),(v_2,w_2),\cdots,(v_n,w_n)$ 中，哪个数字对应哪个字符串。

也就是说，想要找出满足以下条件的 $K$ 个字符串 $s_1,s_2,\cdots,s_K$。

- 对于满足 $1 \leqq i \leqq K$ 的任意整数 $i$，必须满足 $1 \leqq |s_i| \leqq 3$。
- 对于满足 $1 \leqq i \leqq N$ 的任意整数 $i$，当将整数 $v_i$ 按位分解时，得到的数字从上到下依次为 $d_1,d_2,\cdots,d_l$，则将字符串 $s_{d_1},s_{d_2},\cdots,s_{d_l}$ 按此顺序连接的字符串等于 $w_i$。

请编写程序输出 $K$ 个字符串 $s_1,s_2,\cdots,s_k$。

## 输入格式

输入通过标准输入以以下格式给出。

> $K \space N$  
> $v_1 \space w_1$  
> $v_2 \space w_2$  
> $\vdots$  
> $v_N \space w_N$  

- 第 $1$ 行包含用空格分隔的两个整数 $K,N$。
- 第 $2 \sim N$ 行，每一行给出关于数字和字符串组合的信息。在每一行中，包含空格分隔的完全由 $1 \sim K$ **组成的数字**和完全由**半角小写字母**组成的字符串。


翻译来自 @[lby_commandBlock](/user/791222)。

## 输出格式

共 $K$ 行。第 $i(1 \leqq i \leqq K)$ 行输出字符串 $s_i$。

若有多种组合，输出任意一个组合即可。

注意输出的末尾要加上换行。

### 样例解释 1

在这个样例中，通过将 $s_1=$ `i`，$s_2=$ `ni`，$s_3=$ `mi`，$s_4=$ `yo`，$s_5=$ `go`，$s_6=$ `ro` 设定为可以满足题意的 $K$ 个字符串。事实上，

- 当将 $v_1=356$ 按位分解时，得到 $3,5,6$，将 $s_3=$ `mi`，$s_5=$ `go`，$s_6=$ `ro` 按此按此顺序连接的字符串 `migoro` 等于 $w_1$。
- 当将 $v_2=461$ 按位分解时，得到 $4,6,1$，将 $s_4=$ `yo`，$s_6=$ `ro`，$s_1=$ `i` 按此按此顺序连接的字符串 `yoroi` 等于 $w_2$。
- 当将 $v_3=2$ 按位分解时，得到 $2$，$s_2=$ `ni` 等于 $w_3$。
- 当将 $v_4=12$ 按位分解时，得到 $1,2$，$s_1=$ `i`，$s_2=$ `ni` 按此顺序连接的字符串 `ini` 等于 $w_4$。

### 数据规模与约定

- 对于所有数据，满足 $1 \leqq K \leqq 9,1 \leqq N \leqq 50$。
- 满足 $1 \sim K$ 的所有数字在 $v_1,v_2,\cdots,v_N$ 中**至少出现过一次**。
- 满足 $s_1,s_2,\cdots,s_K$ 一定存在。

### 部分分

本题设置了部分分。

- 如果通过了由 $K \leqq 3$ 和 $w_1$ 到 $w_N$ 的任何字符串组成的数据集 $1$，将获得 $40$ 分。

## 样例 #1

### 输入

```
6 4

356 migoro

461 yoroi

2 ni

12 ini
```

### 输出

```
i

ni

mi

yo

go

ro
```

## 样例 #2

### 输入

```
3 4

21 aaa

12 aaa

123 aaaaaa

13 aaaa
```

### 输出

```
a

aa

aaa
```

## 样例 #3

### 输入

```
2 3

12211 abcaaaaabcabc

2121 aaabcaaabc

222221 aaaaaaaaaaabc
```

### 输出

```
abc

aa
```

## 样例 #4

### 输入

```
2 1

12 abcab
```

### 输出

```
ab

cab
```



---

---
title: "[ABC032C] 列"
layout: "post"
diff: 普及+/提高
pid: AT_abc032_c
tag: []
---

# [ABC032C] 列

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc032/tasks/abc032_c

 長さ $ N $ の非負整数列 $ S={s_1,s_2,...,s_N} $ と整数 $ K $ があります。 あなたの仕事は、以下の条件を満たす $ S $ の **連続する** 部分列のうち、最も長いものの長さを求めることです。部分列の長さは $ 1 $ 以上の列でないといけません。

- その部分列に含まれる全ての要素の値の積は、$ K $ 以下である。

もし条件を満たす部分列が一つも存在しないときは、$ 0 $ を出力してください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ K $ $ s_1 $ $ s_2 $ : $ s_N $

- $ 1 $ 行目には、数列の長さを表す整数 $ N\ (1≦N≦10^5) $ と問題文中の整数 $ K\ (0≦K≦10^9) $ が空白区切りで与えられる。
- $ 2 $ 行目からの $ N $ 行には、数列の各要素の値が与えられる。そのうち $ i(1≦i≦N) $ 行目には、$ s_i\ (0≦s_i≦10^9) $ が書かれている。

## 输出格式

出力は以下の形式で標準出力に行うこと。

$ 1 $ 行目に、含まれる全ての要素の値の積が $ K $ 以下となる連続する部分列のうち最長のものの長さを出力せよ。もし条件を満たす部分列が一つも存在しないときは、$ 0 $ を出力せよ。末尾の改行を忘れないこと。

## 说明/提示

### 部分点

この問題には部分点が設定されている。満点は $ 100 $ 点である。

- $ N≦1000 $ を満たすデータセット $ 1 $ に正解した場合は、$ 20 $ 点が与えられる。
- 追加制約のないデータセット $ 2 $ に正解した場合、上記の点数に加え $ 80 $ 点が与えられる。

### Sample Explanation 1

部分列 $ S[2..5]=s_2,s_3,s_4,s_5 $ を選ぶと、積は $ 3×1×1×2=6 $ となり、$ K $ 以下になります。

## 样例 #1

### 输入

```
7 6

4

3

1

1

2

10

2
```

### 输出

```
4
```

## 样例 #2

### 输入

```
6 10

10

10

10

10

0

10
```

### 输出

```
6
```

## 样例 #3

### 输入

```
6 9

10

10

10

10

10

10
```

### 输出

```
0
```

## 样例 #4

### 输入

```
4 0

1

2

3

4
```

### 输出

```
0
```



---

---
title: "[ABC032D] ナップサック問題"
layout: "post"
diff: 普及+/提高
pid: AT_abc032_d
tag: []
---

# [ABC032D] ナップサック問題

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc032/tasks/abc032_d

0/1ナップサック問題を解いてください。0/1ナップサック問題とは以下のような問題のことです。

- $ N $ 個の荷物があり、$ i\ (1≦i≦N) $ 番目の荷物には価値 $ v_i $ と重さ $ w_i $ が割り当てられている。
- 許容重量 $ W $ のナップサックが1つある。
- 重さの和が $ W $ 以下となるように荷物の集合を選びナップサックに詰め込むとき、価値の和の最大値を求めよ。ただし、同じ荷物は一度しか選ぶことができない。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ W $ $ v_1 $ $ w_1 $ $ v_2 $ $ w_2 $ : $ v_N $ $ w_N $

- $ 1 $ 行目には、荷物の数を表す整数 $ N\ (1≦N≦200) $ とナップサックの許容重量を表す整数 $ W(1≦W≦10^9) $ が空白区切りで与えられる。
- $ 2 $ 行目からの $ N $ 行には、各荷物の情報が与えられる。そのうち $ i(1≦i≦N) $ 行目には、$ i $ 番目の荷物の価値を表す整数 $ v_i\ (1≦v_i≦10^9) $ と重さを表す整数 $ w_i\ (1≦w_i≦10^9) $ が空白区切りで与えられる。
- 「$ N≦30 $」、「全ての$ i(1≦i≦N) $ について $ 1≦w_i≦1000 $」、「全ての$ i(1≦i≦N) $ について $ 1≦v_i≦1000 $」という $ 3 $ つの条件のうち少なくとも1つの条件が成り立つ。

## 输出格式

出力は以下の形式で標準出力に行うこと。

$ 1 $ 行目に、達成できる最大の合計価値を出力せよ。末尾の改行を忘れないこと。

## 说明/提示

### 部分点

この問題には部分点が設定されている。満点は $ 100 $ 点である。

- $ N≦30 $ を満たすデータセット $ 1 $ に正解した場合は、$ 34 $ 点が与えられる。
- $ N≦200 $ かつ全ての $ i(1≦i≦N) $ について $ 1≦w_i≦1000 $ を満たすデータセット $ 2 $ に正解した場合は、上記の点数とは別に $ 33 $ 点が与えられる。
- $ N≦200 $ かつ全ての $ i(1≦i≦N) $ について $ 1≦v_i≦1000 $ を満たすデータセット $ 3 $ に正解した場合は、上記の点数とは別に $ 33 $ 点が与えられる。

### Sample Explanation 1

$ 2 $ 番目と $ 3 $ 番目のアイテムを選ぶと、合計の重みが $ 10 $ で価値が $ 16 $ となり、最大価値を達成できます。 この入出力例は、データセット $ 1,2,3 $ の制約を満たしているため、全てのデータセットの採点に用いられます。

### Sample Explanation 2

この入出力例は、データセット $ 1 $ の制約のみ満たしているため、データセット $ 2,3 $ の採点には用いられません。

### Sample Explanation 3

この入出力例は、データセット $ 3 $ の制約を満たしていないため、データセット $ 3 $ の採点には用いられません。

### Sample Explanation 4

この入出力例は、データセット $ 2 $ の制約を満たしていないため、データセット $ 2 $ の採点には用いられません。

## 样例 #1

### 输入

```
3 10

15 9

10 6

6 4
```

### 输出

```
16
```

## 样例 #2

### 输入

```
30 499887702

128990795 137274936

575374246 989051853

471048785 85168425

640066776 856699603

819841327 611065509

704171581 22345022

536108301 678298936

119980848 616908153

117241527 28801762

325850062 478675378

623319578 706900574

998395208 738510039

475707585 135746508

863910036 599020879

340559411 738084616

122579234 545330137

696368935 86797589

665665204 592749599

958833732 401229830

371084424 523386474

463433600 5310725

210508742 907821957

685281136 565237085

619500108 730556272

88215377 310581512

558193168 136966252

475268130 132739489

303022740 12425915

122379996 137199296

304092766 23505143
```

### 输出

```
3673016420
```

## 样例 #3

### 输入

```
10 2921

981421680 325

515936168 845

17309336 371

788067075 112

104855562 96

494541604 960

32007355 161

772339969 581

55112800 248

98577050 22
```

### 输出

```
3657162058
```

## 样例 #4

### 输入

```
10 936447862

854 810169801

691 957981784

294 687140254

333 932608409

832 42367415

642 727293784

139 870916042

101 685539955

853 243593312

369 977358410
```

### 输出

```
1686
```



---

---
title: "[ABC034D] 食塩水"
layout: "post"
diff: 普及+/提高
pid: AT_abc034_d
tag: []
---

# [ABC034D] 食塩水

## 题目描述

有$N$ $(1≤N≤1000)$个装有食盐水的容器。容器从$1$到$N$标号。第$i$号容器有浓度为$p_i\%$ $(0≤p_i≤100)$的食盐水$w_i$ $(1≤w_i≤10^9)$克。高桥君需要选择$K$ $(1≤K≤1000)$个容器，并把选择的容器里的食盐水全部混合在一起。请你编程求出高桥君可以获得的盐水的最大浓度。

## 输入格式

第一行两个整数$N$、$K$；
接下来$N$行，每行两个数$w_i$、$p_i$。

## 输出格式

一行一个实数$x$，表示高桥君能得到的最大浓度的盐水浓度为$x\%$。

## 样例 #1

### 输入

```
3 2
100 15
300 20
200 30

```

### 输出

```
25.000000000

```



---

---
title: "[ABC035D] トレジャーハント"
layout: "post"
diff: 普及+/提高
pid: AT_abc035_d
tag: []
---

# [ABC035D] トレジャーハント

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc035/tasks/abc035_d

高橋君が住む国には $ N $ 箇所の町と町同士をつなぐ一方通行の道が $ M $ 本あり、それぞれの町には $ 1 $ から $ N $ の番号が割りふられています。 $ i $ 番目の道は $ a_i $ 番の町から $ b_i $ 番の町へ移動することが可能であり、移動に $ c_i $ 分だけかかります。

所持金が $ 0 $ 円の高橋君は $ T $ 分間のトレジャーハントに出かけることにしました。高橋君は開始 $ 0 $ 分の時点で $ 1 $ 番の町にいます。また、開始から $ T $ 分の時点にも $ 1 $ 番の町にいなくてはなりません。高橋君が $ i $ 番の町に $ 1 $ 分間滞在すると、 $ A_i $ 円が高橋君の所持金に加算されます。

$ T $ 分間のトレジャーハントによって高橋君の所持金は最大いくらになるか求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ M $ $ T $ $ A_1 $ … $ A_N $ $ a_1 $ $ b_1 $ $ c_1 $ . . . $ a_M $ $ b_M $ $ c_M $

- $ 1 $ 行目に町の数と道の数、トレジャーハントの分数を表す $ 3 $ つの整数 $ N,M,T\ (2≦N≦10^5,\ 1≦M≦min(N(N-1),10^5),\ 1≦T≦10^9) $ が空白区切りで与えられる。
- $ 2 $ 行目には $ i $ 番目の町に滞在したときに得られるお金の情報を表す整数 $ A_i(1≦A_i≦10^5) $ が空白区切りで与えられる。
- $ 3 $ 行目から続く $ M $ 行のうち $ i $ 行目においては、 $ i $ 番目の道の情報を表す $ 3 $ つの整数 $ a_i,\ b_i,\ c_i\ (1≦a_i,b_i≦N,a_i≠b_i,\ 1≦c_i≦10^5) $が空白区切りで与えられる。
- $ i≠j $ であるような $ i,j $ において、$ a_i≠a_j $ または $ b_i≠b_j $ のどちらかが成立する。

## 输出格式

トレジャーハントの結果としてありうる高橋君の所持金のうち最大値を $ 1 $ 行に出力せよ。改行を忘れないこと。

## 说明/提示

### 部分点

この問題には部分点が設定されている。

- $ 1≦N≦200 $ を満たすデータセットに正解した場合 $ 50 $ 点が与えられる。
- 追加制約のないデータセットに正解した場合は、追加で $ 50 $ 点が与えられ、合計 $ 100 $ 点が得られる。

### Sample Explanation 1

\- 開始から $ 0 $ 分の時点から $ 2 $ 分かけて町 $ 1 $ から町 $ 2 $ に移動します。 - 開始から $ 2 $ 分の時点から $ 2 $ 分間、町 $ 2 $ に滞在します。所持金は $ 6 $ 円になります。 - 開始から $ 4 $ 分の時点から $ 1 $ 分かけて町 $ 2 $ から町 $ 1 $ に移動します。 - 開始から $ 5 $ 分の時点で町 $ 1 $ にいます。トレジャーハントが終了します。 - このケースは部分点の制約を満たします。

### Sample Explanation 2

\- 開始 $ 0 $ 分の時点から $ 3 $ 分間、町 $ 1 $ に滞在するのが最適であり、所持金を $ 3 $ 円にすることができます。 - このケースは部分点の制約を満たします。

### Sample Explanation 3

\- このケースは部分点の制約を満たします。

## 样例 #1

### 输入

```
2 2 5

1 3

1 2 2

2 1 1
```

### 输出

```
6
```

## 样例 #2

### 输入

```
2 2 3

1 3

1 2 2

2 1 1
```

### 输出

```
3
```

## 样例 #3

### 输入

```
8 15 120

1 2 6 16 1 3 11 9

1 8 1

7 3 14

8 2 13

3 5 4

5 7 5

6 4 1

6 8 17

7 8 5

1 4 2

4 7 1

6 1 3

3 1 10

2 6 5

2 4 12

5 1 30
```

### 输出

```
1488
```



---

---
title: "[ABC036D] 塗り絵"
layout: "post"
diff: 普及+/提高
pid: AT_abc036_d
tag: []
---

# [ABC036D] 塗り絵

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc036/tasks/abc036_d





---

---
title: "[ABC037D] 経路"
layout: "post"
diff: 普及+/提高
pid: AT_abc037_d
tag: []
---

# [ABC037D] 経路

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc037/tasks/abc037_d

$ H\ *\ W $ のマス目があり、それぞれのマスには整数が書かれています。 $ i $ 行 $ j $ 列に書かれている数は $ a_{ij} $ です。

あなたはこのグリッドの中の好きなマスから好きなだけ動きます(最初のマスから動かなくてもかまいません)。 今いるマスの上下左右に隣接しているマスのうち、今いるマスより大きな整数が書かれたマスに移動することができます。

ありうる移動経路の個数を$ 10^9+7 $で割った余りを求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ H $ $ W $ $ a_{11} $ .. $ a_{1W} $ : $ a_{H1} $ .. $ a_{HW} $

## 输出格式

移動経路の個数を$ 10^9+7 $で割った余りを出力せよ。

## 说明/提示

### 制約

- $ 1\ \leq\ H,\ W\ \leq\ 1,000 $
- $ 1\ \leq\ a_{ij}\ \leq\ 10^9 $

### Sample Explanation 1

例えば、$ 1 $ 行 $ 2 $ 列から出発し、右、下と移動する経路や、 $ 1 $ 行 $ 1 $ 列から出発し、下に移動する経路などがあります。 全部で $ 18 $ 種類の経路があります。

## 样例 #1

### 输入

```
2 3

1 4 5

2 4 9
```

### 输出

```
18
```

## 样例 #2

### 输入

```
6 6

1 3 4 6 7 5

1 2 4 8 8 7

2 7 9 2 7 2

9 4 2 7 6 5

2 8 4 6 7 6

3 7 9 1 2 7
```

### 输出

```
170
```



---

---
title: "[ABC040D] 道路の老朽化対策について"
layout: "post"
diff: 普及+/提高
pid: AT_abc040_d
tag: []
---

# [ABC040D] 道路の老朽化対策について

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc040/tasks/abc040_d

ある国には $ N $ 個の都市があり、それぞれ $ 1 $ から $ N $ までの番号がつけられています。これらの都市間を結ぶ $ M $ 本の道路があり、$ i $ 本目の道路は都市 $ a_i $ と都市 $ b_i $ を結ぶもので、$ y_i $ 年に造られたものです。

この国の国民はとても心配性なので、あまりに古い道は事故の危険性が高いと考えて使わないことがあります。そこであなたは、この国の交通状況を調査することにしました。

$ Q $ 人の国民の情報が与えられます。$ j $ 人目の国民について、都市 $ v_j $ に住んでおり、造られた年が $ w_j $ 年以前 ($ w_j $ 年ちょうども含む) であるような道路を使わないことがわかっています。

それぞれの国民に対し、その人が住んでいる都市から道路のみを使って行き来できるような都市の個数を求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ M $ $ a_1 $ $ b_1 $ $ y_1 $ : $ a_M $ $ b_M $ $ y_M $ $ Q $ $ v_1 $ $ w_1 $ : $ v_Q $ $ w_Q $

## 输出格式

$ Q $ 行出力せよ。そのうちの $ j $ 行目には、$ j $ 人目の国民が道路のみを使って行き来可能な都市の個数を出力せよ。

## 说明/提示

### 制約

- $ 1\ ≦\ N\ ≦\ 100,000 $
- $ 0\ ≦\ M\ ≦\ 200,000 $
- $ 1\ ≦\ a_i,b_i\ ≦\ N $
- $ a_i\ ≠\ b_i $
- $ 1\ ≦\ y_i\ ≦\ 200,000 $
- $ 1\ ≦\ Q\ ≦\ 100,000 $
- $ 1\ ≦\ v_j\ ≦\ N $
- $ 0\ ≦\ w_j\ ≦\ 200,000 $

### 部分点

- $ 50 $ 点分のテストケースでは、$ N\ ≦\ 1,000 $, $ M\ ≦\ 2,000 $, $ Q\ ≦\ 1,000 $ をみたす。

### Sample Explanation 1

$ Q $ 人それぞれの国民について、答えは以下のようになります。 - $ 1 $ 人目は都市 $ 1 $ に住んでおり、$ 2000 $ 年以前に造られた道を使いません。都市 $ 1 $ につながる唯一の道は $ 2000 $ 年に造られているので、都市 $ 1 $ 以外へ行くことができません。したがって答えは $ 1 $ となります。 - $ 2 $ 人目は都市 $ 1 $ に住んでおり、都市 $ 2 $ や $ 3 $ へ行くことができます。しかし、$ 1999 $ 年以前に造られた道を使わないので都市 $ 4 $ へ行くことはできません。したがって答えは $ 3 $ となります。 - $ 3 $ 人目は $ 1995 $ 年以前に造られた道を使いませんが、すべての道はそれより新しいため、すべての道をつかってすべての都市へ行くことができます。したがって答えは $ 5 $ となります。

### Sample Explanation 3

同じふたつの都市間を結ぶ道が $ 2 $ 本以上あることや、すべての道を使っても辿り着けない都市がありうることに注意してください。

## 样例 #1

### 输入

```
5 4

1 2 2000

2 3 2004

3 4 1999

4 5 2001

3

1 2000

1 1999

3 1995
```

### 输出

```
1

3

5
```

## 样例 #2

### 输入

```
4 5

1 2 2005

3 1 2001

3 4 2002

1 4 2004

4 2 2003

5

1 2003

2 2003

1 2001

3 2003

4 2004
```

### 输出

```
3

3

4

1

1
```

## 样例 #3

### 输入

```
4 5

1 2 10

1 2 1000

2 3 10000

2 3 100000

3 1 200000

4

1 0

2 10000

3 100000

4 0
```

### 输出

```
3

3

2

1
```



---

---
title: "[ABC041D] 徒競走"
layout: "post"
diff: 普及+/提高
pid: AT_abc041_d
tag: []
---

# [ABC041D] 徒競走

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc041/tasks/abc041_d



## 样例 #1

### 输入

```
3 2
2 1
2 3

```

### 输出

```
2

```

## 样例 #2

### 输入

```
5 5
1 2
2 3
3 5
1 4
4 5

```

### 输出

```
3

```

## 样例 #3

### 输入

```
16 1
1 2

```

### 输出

```
10461394944000

```



---

---
title: "[ABC051D] Candidates of No Shortest Paths"
layout: "post"
diff: 普及+/提高
pid: AT_abc051_d
tag: []
---

# [ABC051D] Candidates of No Shortest Paths

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc051/tasks/abc051_d

自己ループと二重辺を含まない $ N $ 頂点 $ M $ 辺の重み付き無向連結グラフが与えられます。  
 $ i\ (1≦i≦M) $ 番目の辺は頂点 $ a_i $ と頂点 $ b_i $ を距離 $ c_i $ で結びます。   
 ここで、自己ループは $ a_i\ =\ b_i\ (1≦i≦M) $ となる辺のことを表します。   
 また、二重辺は $ (a_i,b_i)=(a_j,b_j) $ または $ (a_i,b_i)=(b_j,a_j)\ (1≦i\ <\ j≦M) $ となる辺のことを表します。   
 連結グラフは、どの異なる $ 2 $ 頂点間にも経路が存在するグラフのことを表します。   
 どの異なる $ 2 $ 頂点間の、どの最短経路にも含まれない辺の数を求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ M $ $ a_1 $ $ b_1 $ $ c_1 $ $ a_2 $ $ b_2 $ $ c_2 $ $ : $ $ a_M $ $ b_M $ $ c_M $

## 输出格式

グラフ上の、どの異なる $ 2 $ 頂点間の、どの最短経路にも含まれない辺の数を出力せよ。

## 说明/提示

### 制約

- $ 2≦N≦100 $
- $ N-1≦M≦min(N(N-1)/2,1000) $
- $ 1≦a_i,b_i≦N $
- $ 1≦c_i≦1000 $
- $ c_i $ は整数である。
- 与えられるグラフは自己ループと二重辺を含まない。
- 与えられるグラフは連結である。

### Sample Explanation 1

この入力例で与えられるグラフにおける、全ての異なる $ 2 $ 頂点間の最短経路は以下の通りです。 - 頂点 $ 1 $ から頂点 $ 2 $ への最短経路は、頂点 $ 1 $ → 頂点 $ 2 $ で経路長は $ 1 $ - 頂点 $ 1 $ から頂点 $ 3 $ への最短経路は、頂点 $ 1 $ → 頂点 $ 3 $ で経路長は $ 1 $ - 頂点 $ 2 $ から頂点 $ 1 $ への最短経路は、頂点 $ 2 $ → 頂点 $ 1 $ で経路長は $ 1 $ - 頂点 $ 2 $ から頂点 $ 3 $ への最短経路は、頂点 $ 2 $ → 頂点 $ 1 $ → 頂点 $ 3 $ で経路長は $ 2 $ - 頂点 $ 3 $ から頂点 $ 1 $ への最短経路は、頂点 $ 3 $ → 頂点 $ 1 $ で経路長は $ 1 $ - 頂点 $ 3 $ から頂点 $ 2 $ への最短経路は、頂点 $ 3 $ → 頂点 $ 1 $ → 頂点 $ 2 $ で経路長は $ 2 $ したがって、一度も最短経路として使用されていない辺は、頂点 $ 2 $ と頂点 $ 3 $ を結ぶ長さ $ 3 $ の辺のみであるため、$ 1 $ を出力します。

### Sample Explanation 2

全ての辺が異なる $ 2 $ 頂点間のある最短経路で使用されます。

## 样例 #1

### 输入

```
3 3

1 2 1

1 3 1

2 3 3
```

### 输出

```
1
```

## 样例 #2

### 输入

```
3 2

1 2 1

2 3 1
```

### 输出

```
0
```



---

---
title: "[ABC070D] Transit Tree Path"
layout: "post"
diff: 普及+/提高
pid: AT_abc070_d
tag: []
---

# [ABC070D] Transit Tree Path

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc070/tasks/abc070_d

$ N $ 頂点の木が与えられます。   
 木とはグラフの一種であり、頂点の数を $ N $ とすると、辺の数が $ N-1 $ 本である閉路のない連結グラフです。   
 $ i(1≦i≦N-1) $ 番目の辺は 頂点 $ a_i $ と 頂点 $ b_i $ を距離 $ c_i $ で結びます。

また、$ Q $ 個の質問クエリと整数 $ K $ が与えられます。

- $ j(1≦j≦Q) $ 番目の質問クエリでは、頂点 $ x_j $ から 頂点 $ K $ を経由しつつ、頂点 $ y_j $ まで移動する場合の最短経路の距離を求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ a_1 $ $ b_1 $ $ c_1 $ $ : $ $ a_{N-1} $ $ b_{N-1} $ $ c_{N-1} $ $ Q $ $ K $ $ x_1 $ $ y_1 $ $ : $ $ x_{Q} $ $ y_{Q} $

## 输出格式

質問クエリの解答を $ Q $ 行出力せよ。   
 $ j(1≦j≦Q) $ 行目には、$ j $ 番目のクエリの答えを出力せよ。

## 说明/提示

### 制約

- $ 3≦N≦10^5 $
- $ 1≦a_i,b_i≦N\ (1≦i≦N-1) $
- $ 1≦c_i≦10^9\ (1≦i≦N-1) $
- 与えられるグラフは木である。
- $ 1≦Q≦10^5 $
- $ 1≦K≦N $
- $ 1≦x_j,y_j≦N\ (1≦j≦Q) $
- $ x_j≠y_j\ (1≦j≦Q) $
- $ x_j≠K,y_j≠K\ (1≦j≦Q) $

### Sample Explanation 1

与えられた $ 3 $ つの質問クエリに対する最短経路は以下の通りです。 - $ 1 $ つ目の質問クエリ: 頂点 $ 2 $ → 頂点 $ 1 $ → 頂点 $ 2 $ → 頂点 $ 4 $ : 距離 $ 1+1+1=3 $ - $ 2 $ つ目の質問クエリ: 頂点 $ 2 $ → 頂点 $ 1 $ → 頂点 $ 3 $ : 距離 $ 1+1=2 $ - $ 3 $ つ目の質問クエリ: 頂点 $ 4 $ → 頂点 $ 2 $ → 頂点 $ 1 $ → 頂点 $ 3 $ → 頂点 $ 5 $ : 距離 $ 1+1+1+1=4 $

### Sample Explanation 2

質問クエリに対する最短経路は、必ず頂点 $ K=2 $ を通過する必要があります。

## 样例 #1

### 输入

```
5

1 2 1

1 3 1

2 4 1

3 5 1

3 1

2 4

2 3

4 5
```

### 输出

```
3

2

4
```

## 样例 #2

### 输入

```
7

1 2 1

1 3 3

1 4 5

1 5 7

1 6 9

1 7 11

3 2

1 3

4 5

6 7
```

### 输出

```
5

14

22
```

## 样例 #3

### 输入

```
10

1 2 1000000000

2 3 1000000000

3 4 1000000000

4 5 1000000000

5 6 1000000000

6 7 1000000000

7 8 1000000000

8 9 1000000000

9 10 1000000000

1 1

9 10
```

### 输出

```
17000000000
```



---

---
title: "[ABC073D] joisino&#39;s travel"
layout: "post"
diff: 普及+/提高
pid: AT_abc073_d
tag: []
---

# [ABC073D] joisino&#39;s travel

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc073/tasks/abc073_d

Atcoder国には $ N $ 個の町があり、$ M $ 本の双方向に移動可能な道で結ばれています。

また、 $ i $ 本目の道は町 $ A_i $ と町 $ B_i $ の間を距離 $ C_i $ で結んでいます。

joisinoお姉ちゃんは、この国の $ R $ 個の町 $ r_1,r_2..r_R $ を訪れることとなりました。

最初に訪れる町までの移動と、最後に訪れる町からの移動は空路で行うが、それ以外は道を使わなければなりません。

町を訪れる順番を、道での移動距離が最小となるように決めた時の移動距離を答えてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ M $ $ R $ $ r_1 $ $ ... $ $ r_R $ $ A_1 $ $ B_1 $ $ C_1 $ $ : $ $ A_M $ $ B_M $ $ C_M $

## 输出格式

町を訪れる順番を、道での移動距離が最小となるように決めた時の移動距離を出力せよ。

## 说明/提示

### 制約

- $ 2≦N≦200 $
- $ 1≦M≦N×(N-1)/2 $
- $ 2≦R≦min(8,N) $ ( $ min(8,N) $ は $ 8 $ と $ N $ のうち小さい方)
- $ r_i≠r_j\ (i≠j) $
- $ 1≦A_i,B_i≦N\ ,\ A_i≠B_i $
- $ (A_i,B_i)≠(A_j,B_j),(A_i,B_i)≠(B_j,A_j)\ (i≠j) $
- $ 1≦C_i≦100000 $
- すべての町の間は道のみで移動することができる。
- 入力は全て整数である。

### Sample Explanation 1

例えば、町 $ 1 $ ,町 $ 2 $ ,町 $ 3 $ の順番で訪れると、移動距離が $ 2 $ となり、最小となります。

### Sample Explanation 2

町 $ 1 $ を訪れたあとに町 $ 3 $ を訪れても、町 $ 3 $ を訪れたあとに町 $ 1 $ を訪れても、町 $ 1 $ と町 $ 3 $ の間の最短距離は $ 4 $ であるため、どの順番を選んだとしても答えは $ 4 $ となります。

## 样例 #1

### 输入

```
3 3 3

1 2 3

1 2 1

2 3 1

3 1 4
```

### 输出

```
2
```

## 样例 #2

### 输入

```
3 3 2

1 3

2 3 2

1 3 6

1 2 2
```

### 输出

```
4
```

## 样例 #3

### 输入

```
4 6 3

2 3 4

1 2 4

2 3 3

4 3 1

1 4 1

4 2 2

3 1 6
```

### 输出

```
3
```



---

---
title: "[ABC075D] Axis-Parallel Rectangle"
layout: "post"
diff: 普及+/提高
pid: AT_abc075_d
tag: []
---

# [ABC075D] Axis-Parallel Rectangle

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc075/tasks/abc075_d

2次元座標上に $ N $ 個の点があります。   
 $ i(1≦i≦N) $ 番目の点の座標は $ (x_i,y_i) $ です。   
 長方形の内部に $ N $ 点のうち $ K $ 個以上の点を含みつつ、それぞれの辺がX軸かY軸に平行な長方形を考えます。  
 このとき、長方形の辺上の点は長方形の内部に含みます。   
 それらの長方形の中で、最小の面積となるような長方形の面積を求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ K $ $ x_1 $ $ y_1 $ $ : $ $ x_{N} $ $ y_{N} $

## 输出格式

条件を満たす長方形の中で最小面積となるような長方形の面積を出力せよ。

## 说明/提示

### 制約

- $ 2≦K≦N≦50 $
- $ -10^9≦x_i,y_i≦10^9\ (1≦i≦N) $
- $ x_i≠x_j\ (1≦i\ <\ j≦N) $
- $ y_i≠y_j\ (1≦i\ <\ j≦N) $
- 入力値はすべて整数である。(21:50 追記)

### Sample Explanation 1

条件を満たす最小面積となる長方形の $ 1 $ つは $ (1,1),(8,1),(1,4),(8,4) $ の $ 4 $ つの頂点で構成されます。 その面積は $ (8-1)\ ×\ (4-1)\ =\ 21 $ であるため、$ 21 $ と出力します。

### Sample Explanation 3

オーバーフローに注意してください。

## 样例 #1

### 输入

```
4 4

1 4

3 3

6 2

8 1
```

### 输出

```
21
```

## 样例 #2

### 输入

```
4 2

0 0

1 1

2 2

3 3
```

### 输出

```
1
```

## 样例 #3

### 输入

```
4 3

-1000000000 -1000000000

1000000000 1000000000

-999999999 999999999

999999999 -999999999
```

### 输出

```
3999999996000000001
```



---

---
title: "[ABC099D] Good Grid"
layout: "post"
diff: 普及+/提高
pid: AT_abc099_d
tag: []
---

# [ABC099D] Good Grid

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc099/tasks/abc099_d

$ N $ 行 $ N $ 列からなるグリッドがあり、上から $ i $ 行目の左から $ j $ 列目のマスを $ (i,j) $ とします。

これらのマスは色 $ 1 $ から 色 $ C $ までのいずれかの色で塗られていなければならず、はじめに $ (i,j) $ は色 $ c_{i,j} $ で塗られています。

グリッドが、$ 1\ \leq\ i,j,x,y\ \leq\ N $ を満たす任意の $ i,j,x,y $ に対して以下の条件を満たす場合、良いグリッドであるとします。

- $ (i+j)\ \%\ 3=(x+y)\ \%\ 3 $ ならば $ (i,j) $ の色と $ (x,y) $ の色は同じ
- $ (i+j)\ \%\ 3\ \neq\ (x+y)\ \%\ 3 $ ならば $ (i,j) $ の色と $ (x,y) $ の色は異なる

ただし、$ X\ \%\ Y $ は $ X $ を $ Y $ で割った余りを表すこととします。

グリッドが良いグリッドになるように $ 0 $ 個以上のマスを塗り替えます。

あるマスにおいて、塗り替える前の色が $ X $ であり、塗り替えた後の色が $ Y $ である場合に感じる、そのマスに対して感じる違和感は $ D_{X,Y} $ です。

すべてのマスに対して感じる違和感の和のとりうる最小値を求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ C $ $ D_{1,1} $ $ ... $ $ D_{1,C} $ $ : $ $ D_{C,1} $ $ ... $ $ D_{C,C} $ $ c_{1,1} $ $ ... $ $ c_{1,N} $ $ : $ $ c_{N,1} $ $ ... $ $ c_{N,N} $

## 输出格式

すべてのマスに対して感じる違和感の和のとりうる最小値が $ x $ のとき、$ x $ を出力せよ。

## 说明/提示

### 制約

- $ 1\ \leq\ N\ \leq\ 500 $
- $ 3\ \leq\ C\ \leq\ 30 $
- $ 1\ \leq\ D_{i,j}\ \leq\ 1000\ (i\ \neq\ j),D_{i,j}=0\ (i=j) $
- $ 1\ \leq\ c_{i,j}\ \leq\ C $
- 入力は全て整数

### Sample Explanation 1

\- $ (1,1) $ を色 $ 2 $ に塗り替えます。$ (1,1) $ に対して感じる違和感は $ D_{1,2}=1 $ となります。 - $ (1,2) $ を色 $ 3 $ に塗り替えます。$ (1,2) $ に対して感じる違和感は $ D_{2,3}=1 $ となります。 - $ (2,2) $ を色 $ 1 $ に塗り替えます。$ (2,2) $ に対して感じる違和感は $ D_{3,1}=1 $ となります。 このとき、すべてのマスに対して感じる違和感の和は $ 3 $ です。 なお、$ D_{i,j}\ \neq\ D_{j,i} $ である場合に注意してください。

## 样例 #1

### 输入

```
2 3

0 1 1

1 0 1

1 4 0

1 2

3 3
```

### 输出

```
3
```

## 样例 #2

### 输入

```
4 3

0 12 71

81 0 53

14 92 0

1 1 2 1

2 1 1 2

2 2 1 3

1 1 2 2
```

### 输出

```
428
```



---

---
title: "[ABC100D] Patisserie ABC"
layout: "post"
diff: 普及+/提高
pid: AT_abc100_d
tag: []
---

# [ABC100D] Patisserie ABC

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc100/tasks/abc100_d

高橋君はプロのパティシエになり, AtCoder Beginner Contest 100 を記念して, 「ABC洋菓子店」というお店を開いた.

ABC洋菓子店では, $ N $ 種類のケーキを売っている.  
 各種類のケーキには「綺麗さ」「おいしさ」「人気度」の $ 3 $ つの値を持ち, $ i $ 種類目のケーキの綺麗さは $ x_i $, おいしさは $ y_i $, 人気度は $ z_i $ である.  
 これらの値は $ 0 $ 以下である可能性もある.

りんごさんは, ABC洋菓子店で $ M $ 個のケーキを食べることにした. 彼は次のように, 食べるケーキの組み合わせを選ぶことにした.

- 同じ種類のケーキを $ 2 $ 個以上食べない.
- 上の条件を満たしつつ, (綺麗さの合計の絶対値) + (おいしさの合計の絶対値) + (人気度の合計の絶対値) が最大になるように選ぶ.

このとき, りんごさんが選ぶケーキの (綺麗さの合計の絶対値) + (おいしさの合計の絶対値) + (人気度の合計の絶対値) の最大値を求めなさい.

## 输入格式

入力は以下の形式で標準入力から与えられる.

> $ N $ $ M $ $ x_1 $ $ y_1 $ $ z_1 $ $ x_2 $ $ y_2 $ $ z_2 $ $ : $ $ : $ $ x_N $ $ y_N $ $ z_N $

## 输出格式

りんごさんが選ぶケーキの (綺麗さの合計の絶対値) + (おいしさの合計の絶対値) + (人気度の合計の絶対値) の最大値を出力しなさい.

## 说明/提示

### 制約

- $ N $ は $ 1 $ 以上 $ 1\ 000 $ 以下の整数
- $ M $ は $ 0 $ 以上 $ N $ 以下の整数
- $ x_i,\ y_i,\ z_i\ (1\ \leq\ i\ \leq\ N) $ は, それぞれ $ -10\ 000\ 000\ 000 $ 以上 $ 10\ 000\ 000\ 000 $ 以下の整数.

### Sample Explanation 1

$ 2,\ 4,\ 5 $ 種類目のケーキを食べることを考える. そのとき, 「綺麗さ」「おいしさ」「人気度」の合計はそれぞれ次のようになる. - 綺麗さ：$ 1\ +\ 3\ +\ 9\ =\ 13 $ - おいしさ：$ 5\ +\ 5\ +\ 7\ =\ 17 $ - 人気度：$ 9\ +\ 8\ +\ 9\ =\ 26 $ このときの (綺麗さの合計の絶対値) + (おいしさの合計の絶対値) + (人気度の合計の絶対値) は $ 13\ +\ 17\ +\ 26\ =\ 56 $ となり, これが最大になる.

### Sample Explanation 2

$ 1,\ 3,\ 5 $ 種類目のケーキを食べることを考える. そのとき, 「綺麗さ」「おいしさ」「人気度」の合計はそれぞれ次のようになる. - 綺麗さ：$ 1\ +\ 7\ +\ 13\ =\ 21 $ - おいしさ：$ (-2)\ +\ (-8)\ +\ (-14)\ =\ -24 $ - 人気度：$ 3\ +\ (-9)\ +\ 15\ =\ 9 $ このときの (綺麗さの合計の絶対値) + (おいしさの合計の絶対値) + (人気度の合計の絶対値) は $ 21\ +\ 24\ +\ 9\ =\ 54 $ となり, これが最大になる.

### Sample Explanation 3

$ 3,\ 4,\ 5,\ 7,\ 10 $ 種類目のケーキを食べると, 綺麗さの合計は $ -323 $, おいしさの合計は $ 66 $, 人気度の合計は $ 249 $ となる. このときの (綺麗さの合計の絶対値) + (おいしさの合計の絶対値) + (人気度の合計の絶対値) は $ 323\ +\ 66\ +\ 249\ =\ 638 $ となり, これが最大になる.

### Sample Explanation 4

ケーキの綺麗さ, おいしさ, 人気度や出力すべき値が, 32bit 整数に収まらない場合もある.

## 样例 #1

### 输入

```
5 3

3 1 4

1 5 9

2 6 5

3 5 8

9 7 9
```

### 输出

```
56
```

## 样例 #2

### 输入

```
5 3

1 -2 3

-4 5 -6

7 -8 -9

-10 11 -12

13 -14 15
```

### 输出

```
54
```

## 样例 #3

### 输入

```
10 5

10 -80 21

23 8 38

-94 28 11

-26 -2 18

-69 72 79

-26 -86 -54

-72 -50 59

21 65 -32

40 -94 87

-62 18 82
```

### 输出

```
638
```

## 样例 #4

### 输入

```
3 2

2000000000 -9000000000 4000000000

7000000000 -5000000000 3000000000

6000000000 -1000000000 8000000000
```

### 输出

```
30000000000
```



---

---
title: "[ABC104C] All Green"
layout: "post"
diff: 普及+/提高
pid: AT_abc104_c
tag: []
---

# [ABC104C] All Green

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc104/tasks/abc104_c

プログラミングコンペティションサイト *AtCode* は、アルゴリズムの問題集を提供しています。 それぞれの問題には、難易度に応じて点数が付けられています。 現在、$ 1 $ 以上 $ D $ 以下のそれぞれの整数 $ i $ に対して、$ 100i $ 点を付けられた問題が $ p_i $ 問存在します。 これらの $ p_1\ +\ …\ +\ p_D $ 問が AtCode に収録された問題のすべてです。

AtCode のユーザーは *総合スコア* と呼ばれる値を持ちます。 ユーザーの総合スコアは、以下の $ 2 $ つの要素の和です。

- 基本スコア: ユーザーが解いた問題すべての配点の合計です。
- コンプリートボーナス: $ 100i $ 点を付けられた $ p_i $ 問の問題すべてを解いたユーザーは、基本スコアと別にコンプリートボーナス $ c_i $ 点を獲得します $ (1\ <\ =\ i\ <\ =\ D) $。

AtCode の新たなユーザーとなった高橋くんは、まだ問題を $ 1 $ 問も解いていません。 彼の目標は、総合スコアを $ G $ 点以上にすることです。 このためには、少なくとも何問の問題を解く必要があるでしょうか？

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ D $ $ G $ $ p_1 $ $ c_1 $ $ : $ $ p_D $ $ c_D $

## 输出格式

総合スコアを $ G $ 点以上にするために解く必要のある最小の問題数を出力せよ。なお、この目標は必ず達成可能である（制約を参照のこと）。

## 说明/提示

### 制約

- $ 1\ <\ =\ D\ <\ =\ 10 $
- $ 1\ <\ =\ p_i\ <\ =\ 100 $
- $ 100\ <\ =\ c_i\ <\ =\ 10^6 $
- $ 100\ <\ =\ G $
- 入力中のすべての値は整数である。
- $ c_i,\ G $ はすべて $ 100 $ の倍数である。
- 総合スコアを $ G $ 点以上にすることは可能である。

### Sample Explanation 1

この場合、AtCode には $ 100 $ 点を付けられた問題が $ 3 $ 問、$ 200 $ 点を付けられた問題が $ 5 $ 問あります。$ 100 $ 点の $ 3 $ 問をすべて解いた際のコンプリートボーナスは $ 500 $ 点、$ 200 $ 点の $ 5 $ 問をすべて解いた際のコンプリートボーナスは $ 800 $ 点です。高橋くんの目標は総合スコアを $ 700 $ 点以上にすることです。 目標を達成する方法の一つは、$ 200 $ 点問題を $ 4 $ 問解いて $ 800 $ 点の基本スコアを得ることです。しかし、$ 100 $ 点問題を $ 3 $ 問すべて解くと、基本スコア $ 300 $ 点に加えてコンプリートボーナスの $ 500 $ 点が与えられて総合スコアが $ 800 $ 点となり、より少ない問題数で目標を達成することができます。

### Sample Explanation 2

入力例 1 と似たケースですが、今回の高橋くんの目標は $ 2000 $ 点以上です。この場合、$ 200 $ 点の $ 5 $ 問は必ずすべて解かなければならず、さらに $ 100 $ 点問題を $ 2 $ 問解くことで総合スコアが $ 2000 $ 点となります。

### Sample Explanation 3

ふたたび入力例 1 と似たケースですが、今回の高橋くんの目標は $ 400 $ 点以上です。この場合、$ 200 $ 点問題を $ 2 $ 問解くだけで目標を達成できます。

### Sample Explanation 4

$ 500 $ 点の問題が $ 1 $ 問しか存在しませんが、このような場合でもその問題を解くことでコンプリートボーナスが与えられます。

## 样例 #1

### 输入

```
2 700

3 500

5 800
```

### 输出

```
3
```

## 样例 #2

### 输入

```
2 2000

3 500

5 800
```

### 输出

```
7
```

## 样例 #3

### 输入

```
2 400

3 500

5 800
```

### 输出

```
2
```

## 样例 #4

### 输入

```
5 25000

20 1000

40 1000

50 1000

30 1000

1 1000
```

### 输出

```
66
```



---

---
title: "[ABC104D] We Love ABC"
layout: "post"
diff: 普及+/提高
pid: AT_abc104_d
tag: []
---

# [ABC104D] We Love ABC

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc104/tasks/abc104_d

文字列 $ T $ の *ABC 数* とは、以下の条件をすべて満たす整数の組 $ (i,\ j,\ k) $ の個数です。

- $ 1\ <\ =\ i\ <\ j\ <\ k\ <\ =\ |T| $（$ |T| $ は $ T $ の長さ）
- $ T_i\ = $ `A`（$ T_i $ は $ T $ の先頭から $ i $ 番目の文字）
- $ T_j\ = $ `B`
- $ T_k\ = $ `C`

例えば、$ T\ = $ `ABCBC` のとき、条件をすべて満たす組 $ (i,\ j,\ k) $ は $ (1,\ 2,\ 3),\ (1,\ 2,\ 5),\ (1,\ 4,\ 5) $ の $ 3 $ 個であるため、$ T $ の ABC 数は $ 3 $ です。

文字列 $ S $ が与えられます。$ S $ のそれぞれの文字は `A`, `B`, `C`, `?` のいずれかです。

$ S $ に含まれる `?` の個数を $ Q $ とします。$ S $ に含まれる `?` をそれぞれ `A`, `B`, `C` のいずれかに置き換えることで $ 3^Q $ 通りの文字列が作られます。これらの文字列すべての ABC 数の和を求めてください。

ただし、この和は非常に大きくなりうるため、和を $ 10^9\ +\ 7 $ で割った余りを出力してください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ S $

## 输出格式

$ 3^Q $ 通りの文字列すべての ABC 数の和を $ 10^9\ +\ 7 $ で割った余りを出力せよ。

## 说明/提示

### 制約

- $ 3\ <\ =\ |S|\ <\ =\ 10^5 $
- $ S $ のそれぞれの文字は `A`, `B`, `C`, `?` のいずれかである。

### Sample Explanation 1

この場合、$ Q\ =\ 2 $ であり、`?` をそれぞれ `A`, `B`, `C` のいずれかに置き換えることで $ 3^Q\ =\ 9 $ 通りの文字列が作られます。これらの文字列それぞれの ABC 数を以下に示します。 - `AAAC`: $ 0 $ - `AABC`: $ 2 $ - `AACC`: $ 0 $ - `ABAC`: $ 1 $ - `ABBC`: $ 2 $ - `ABCC`: $ 2 $ - `ACAC`: $ 0 $ - `ACBC`: $ 1 $ - `ACCC`: $ 0 $ これらの和は $ 0\ +\ 2\ +\ 0\ +\ 1\ +\ 2\ +\ 2\ +\ 0\ +\ 1\ +\ 0\ =\ 8 $ であり、$ 8 $ を $ 10^9\ +\ 7 $ で割った余りである $ 8 $ を出力します。

### Sample Explanation 2

$ Q\ =\ 0 $ のときは、$ S $ 自体の ABC 数を $ 10^9\ +\ 7 $ で割った余りを出力します。この文字列は問題文中で例として挙げたものと同じであり、その ABC 数は $ 3 $ です。

### Sample Explanation 3

この場合、$ 3^Q $ 通りの文字列すべての ABC 数の和は $ 2291979612924 $ であり、これを $ 10^9\ +\ 7 $ で割った余りである $ 979596887 $ を出力します。

## 样例 #1

### 输入

```
A??C
```

### 输出

```
8
```

## 样例 #2

### 输入

```
ABCBC
```

### 输出

```
3
```

## 样例 #3

### 输入

```
????C?????B??????A???????
```

### 输出

```
979596887
```



---

---
title: "[ABC106D] AtCoder Express 2"
layout: "post"
diff: 普及+/提高
pid: AT_abc106_d
tag: []
---

# [ABC106D] AtCoder Express 2

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc106/tasks/abc106_d

高橋王国には, 東西にのびる $ 1 $ 本の線路がある. これに沿って $ N $ 個の都市があり, 西から順に都市 $ 1,\ 2,\ 3,\ \cdots,\ N $ と番号づけられている.  
 AtCoder Express という会社は $ M $ 本の列車を保有しており, 列車 $ i $ は都市 $ L_i $ から都市 $ R_i $ の区間 ($ L_i\ =\ R_i $ の場合もある) を走っている.

この王国の国王である高橋君は, $ Q $ 個のことに興味を持った. 具体的には, $ i=1,\ 2,\ 3,\ \dots,\ Q $ のときの以下の質問の答えを求めたくなった.

- 都市 $ p_i $ から都市 $ q_i $ までの区間に, 走る区間が **完全に含まれる** 列車の本数. 言い換えれば, $ p_i\ \leq\ L_j $ と $ R_j\ \leq\ q_i $ が両方成り立つような列車 $ j $ の本数.

高橋君は天才である. しかし流石の彼でも, 膨大なデータを処理することはできない. 高橋君のために, $ Q $ 個の質問それぞれに対して答えを求めよ.

## 输入格式

入力は以下の形式で標準入力から与えられる.

> $ N $ $ M $ $ Q $ $ L_1 $ $ R_1 $ $ L_2 $ $ R_2 $ $ : $ $ L_M $ $ R_M $ $ p_1 $ $ q_1 $ $ p_2 $ $ q_2 $ $ : $ $ p_Q $ $ q_Q $

## 输出格式

$ Q $ 行出力せよ. $ i $ 行目には, 都市 $ p_i $ から都市 $ q_i $ までの区間に, それぞれの走る区間が完全に含まれる列車の本数を出力せよ.

## 说明/提示

### 制約

- $ N $ は $ 1 $ 以上 $ 500 $ 以下の整数
- $ M $ は $ 1 $ 以上 $ 200\ 000 $ 以下の整数
- $ Q $ は $ 1 $ 以上 $ 100\ 000 $ 以下の整数
- $ 1\ \leq\ L_i\ \leq\ R_i\ \leq\ N $ $ (1\ \leq\ i\ \leq\ M) $
- $ 1\ \leq\ p_i\ \leq\ q_i\ \leq\ N $ $ (1\ \leq\ i\ \leq\ Q) $

### Sample Explanation 1

全ての列車の走る区間が, 都市 $ 1 $ から都市 $ 2 $ までの区間に含まれているので, この質問の答えは $ 3 $ となる.

### Sample Explanation 2

$ 1 $ 個目の質問は, 都市 $ 1 $ から $ 7 $ までの区間についてである. その区間に走る区間が完全に含まれている列車は, 列車 $ 1 $ のみである. $ 2 $ 個目の質問は, 都市 $ 3 $ から $ 10 $ までの区間についてである. その区間に走る区間が完全に含まれている列車は, 列車 $ 3 $ のみである.

## 样例 #1

### 输入

```
2 3 1

1 1

1 2

2 2

1 2
```

### 输出

```
3
```

## 样例 #2

### 输入

```
10 3 2

1 5

2 8

7 10

1 7

3 10
```

### 输出

```
1

1
```

## 样例 #3

### 输入

```
10 10 10

1 6

2 9

4 5

4 7

4 7

5 8

6 6

6 7

7 9

10 10

1 8

1 9

1 10

2 8

2 9

2 10

3 8

3 9

3 10

1 10
```

### 输出

```
7

9

10

6

8

9

6

7

8

10
```



---

---
title: "[ABC110D] Factorization"
layout: "post"
diff: 普及+/提高
pid: AT_abc110_d
tag: []
---

# [ABC110D] Factorization

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc110/tasks/abc110_d

正整数 $ N,\ M $ が与えられます。

$ a_1\ \times\ a_2\ \times\ ...\ \times\ a_N\ =\ M $ となる正整数からなる長さ $ N $ の数列 $ a $ が何通りあるかを $ 10^9+7 $ で割った余りを求めてください。

ただし、数列 $ a' $ と $ a'' $ が異なるとは、ある $ i $ が存在して $ a_i'\ \neq\ a_i'' $ であることをいいます。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ M $

## 输出格式

条件を満たす正整数からなる数列が何通りあるかを $ 10^9\ +\ 7 $ で割った余りを出力せよ。

## 说明/提示

### 制約

- 入力はすべて整数である
- $ 1\ \leq\ N\ \leq\ 10^5 $
- $ 1\ \leq\ M\ \leq\ 10^9 $

### Sample Explanation 1

$ \{a_1,\ a_2\}\ =\ \{1,\ 6\},\ \{2,\ 3\},\ \{3,\ 2\},\ \{6,\ 1\} $ の $ 4 $ 通りの数列が条件を満たします。

## 样例 #1

### 输入

```
2 6
```

### 输出

```
4
```

## 样例 #2

### 输入

```
3 12
```

### 输出

```
18
```

## 样例 #3

### 输入

```
100000 1000000000
```

### 输出

```
957870001
```



---

---
title: "[ABC113D] Number of Amidakuji"
layout: "post"
diff: 普及+/提高
pid: AT_abc113_d
tag: []
---

# [ABC113D] Number of Amidakuji

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc113/tasks/abc113_d

あみだくじは, 日本に古くから伝わる伝統的なくじ引きである.

あみだくじを作るには, まず $ W $ 本の平行な縦線を引き, 次にそれらを繋ぐ横線を引いていく. それぞれの縦棒の長さは $ H+1 $ \[cm\] であり、横線の端点となれるのは上から $ 1,2,3,...,H $ \[cm\] の位置のみである.

ここで,「正しいあみだくじ」とは, 以下のような条件を満たすあみだくじのことである.

- どの $ 2 $ つの横棒も端点を共有しない.
- それぞれの横棒の $ 2 $ つの端点は同じ高さになければならない.
- 横棒は隣り合う縦線を繋がなければならない.

![ ](https://cdn.luogu.com.cn/upload/vjudge_pic/AT_abc113_d/76ad4dbaf6281d141632ee1be437fcd6eb62cf06.png)

縦棒 $ 1 $ の上端から, 横線があれば必ずそれを通るというルールで下へたどったときに, 最終的にたどり着く縦棒の番号が $ K $ となるような「正しいあみだくじ」の本数を $ 1\ 000\ 000\ 007 $ で割った余りを求めなさい.

例として, 以下のあみだくじにおいて, 最終的にたどり着く縦棒の番号は $ 4 $ である.

![ ](https://cdn.luogu.com.cn/upload/vjudge_pic/AT_abc113_d/798f2b4676c5cd94b2fff66ef18034da71e67ad6.png)

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ H $ $ W $ $ K $

## 输出格式

条件を満たすあみだくじの本数を $ 1\ 000\ 000\ 007 $ で割った余りを出力しなさい.

## 说明/提示

### 制約

- $ H $ は $ 1 $ 以上 $ 100 $ 以下の整数
- $ W $ は $ 1 $ 以上 $ 8 $ 以下の整数
- $ K $ は $ 1 $ 以上 $ W $ 以下の整数

### Sample Explanation 1

以下の $ 1 $ 個のあみだくじのみが条件を満たす. !\[ \](https://img.atcoder.jp/abc113/c68c6daccfc4cba8bc94af5f1a80ef2f.png)

### Sample Explanation 2

以下の $ 2 $ 個のあみだくじのみが条件を満たす. !\[ \](https://img.atcoder.jp/abc113/4be150946de8bef9b14d9bc17814d963.png)

### Sample Explanation 3

以下の $ 1 $ 個のあみだくじのみが条件を満たす. !\[ \](https://img.atcoder.jp/abc113/9b2e9f49832458c3488b1e04afd51ed4.png)

### Sample Explanation 4

以下の $ 5 $ 個のあみだくじのみが条件を満たす. !\[ \](https://img.atcoder.jp/abc113/bf6ec766f8923ac2f082f538a6c736b6.png)

### Sample Explanation 5

縦線が $ 1 $ 本しかないので, 横線をそもそも引くことができない. よって条件を満たすあみだくじは「一本も横線を引かない」の $ 1 $ 通りしかない.

### Sample Explanation 6

答えを $ 1\ 000\ 000\ 007 $ で割った余りを出力すること.

## 样例 #1

### 输入

```
1 3 2
```

### 输出

```
1
```

## 样例 #2

### 输入

```
1 3 1
```

### 输出

```
2
```

## 样例 #3

### 输入

```
2 3 3
```

### 输出

```
1
```

## 样例 #4

### 输入

```
2 3 1
```

### 输出

```
5
```

## 样例 #5

### 输入

```
7 1 1
```

### 输出

```
1
```

## 样例 #6

### 输入

```
15 8 5
```

### 输出

```
437760187
```



---

---
title: "[ABC114D] 756"
layout: "post"
diff: 普及+/提高
pid: AT_abc114_d
tag: []
---

# [ABC114D] 756

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc114/tasks/abc114_d

整数 $ N $ が与えられます。$ N! $ $ (=\ 1\ \times\ 2\ \times\ ...\ \times\ N) $ の約数のうち、*七五数* は何個あるでしょうか？

ここで、七五数とは約数をちょうど $ 75 $ 個持つ正の整数です。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $

## 输出格式

$ N! $ の約数であるような七五数の個数を出力せよ。

## 说明/提示

### 注記

正の整数 $ A $ が正の整数 $ B $ を割り切るとき、$ A $ を $ B $ の *約数* といいます。 例えば、$ 6 $ の約数は $ 1,2,3,6 $ の $ 4 $ 個です。

### 制約

- $ 1\ \leq\ N\ \leq\ 100 $
- $ N $ は整数である。

### Sample Explanation 1

$ 9!\ =\ 1\ \times\ 2\ \times\ ...\ \times\ 9\ =\ 362880 $ の約数に七五数はありません。

### Sample Explanation 2

$ 10!\ =\ 3628800 $ の約数のうち、七五数であるのは $ 32400 $ の $ 1 $ 個です。

## 样例 #1

### 输入

```
9
```

### 输出

```
0
```

## 样例 #2

### 输入

```
10
```

### 输出

```
1
```

## 样例 #3

### 输入

```
100
```

### 输出

```
543
```



---

---
title: "[ABC116D] Various Sushi"
layout: "post"
diff: 普及+/提高
pid: AT_abc116_d
tag: []
---

# [ABC116D] Various Sushi

## 题目描述

现有 $N$ 个寿司。每个寿司有两个参数：“寿司种类” $t_i$ 和 “美味程度” $d_i$。您现在需要在这 $N$ 个寿司中选择吃 $K$ 个。您的 “满足感” 会被按照如下标准计算：

- 满足感是 “基础美味程度总和” 和 “多样性加成” 数值的总和。

- “基础美味程度总和” 指的是你吃的所有寿司的美味程度的总和。

- “多样性加成” 是 $x \times x$，其中 $x$ 是你吃的寿司种类 （即一共有多少种 $t$）。

您现在想要得到最大的 “满足感”。找到这个 “满足感” 的最大值。

## 输入格式

第一行为两个整数 $N$ 和 $K$。

接下来从第 $2$ 行到第 $N + 1$ 行，第 $i$ 行两个整数 $t_i$ 和 $d_i$，分别代表第 $i$ 种寿司的寿司种类和美味程度。

## 输出格式

输出您可以得到的 “满足感” 的最大值。

## 说明/提示

- $1 \leq K \leq N \leq 10 ^ 5$

- $1 \leq t_i \leq N$

- $1 \leq d_i \leq 10 ^ 9$

- 所有输入数据均为整数

### 样例解释 1

吃第 $1,2,3$ 个寿司时，“基础美味程度总和” 为 $9 + 7 + 6 = 22$，“多样性加成” 为 $2 \times 2 = 4$ ，得到 “满足感” 最大值为 $26$ ，可以验证不存在更好的吃法。

### 样例解释 2

吃第 $1,2,3,4$ 个寿司，可以验证不存在更好的吃法。

### 样例解释 3

注意数据可能会爆 $int$

### 样例解释 4、5、6

同上

## 样例 #1

### 输入

```
5 3

1 9

1 7

2 6

2 5

3 1
```

### 输出

```
26
```

## 样例 #2

### 输入

```
7 4

1 1

2 1

3 1

4 6

4 5

4 5

4 5
```

### 输出

```
25
```

## 样例 #3

### 输入

```
6 5

5 1000000000

2 990000000

3 980000000

6 970000000

6 960000000

4 950000000
```

### 输出

```
4900000016
```



---

---
title: "[ABC117D] XXOR"
layout: "post"
diff: 普及+/提高
pid: AT_abc117_d
tag: []
---

# [ABC117D] XXOR

## 题目描述

有n个数$a_1,a_2……a_n$和一个数k，$\oplus$表示按位异或。对于$0\leq x\leq k，f(x)=(x \oplus a_1)+(x \oplus a_2)……(x \oplus a_n)$。求$f_{max}$为多少。

## 输入格式

一行两个数n，m，接下来一行m个用空格隔开的整数$x_1,x_2……x_n$。

## 输出格式

一行一个数表示答案。

## 说明/提示

$1\leq n\leq 10^5,0\leq k,a_i\leq 10^{12}$

## 样例 #1

### 输入

```
3 7

1 6 3
```

### 输出

```
14
```

## 样例 #2

### 输入

```
4 9

7 4 0 3
```

### 输出

```
46
```

## 样例 #3

### 输入

```
1 0

1000000000000
```

### 输出

```
1000000000000
```



---

---
title: "[ABC119D] Lazy Faith"
layout: "post"
diff: 普及+/提高
pid: AT_abc119_d
tag: []
---

# [ABC119D] Lazy Faith

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc119/tasks/abc119_d

東西方向に伸びる道路に沿って $ A $ 社の神社と $ B $ 軒の寺が建っています。 西から $ i $ 社目の神社は道路の西端から $ s_i $ メートルの地点に、西から $ i $ 軒目の寺は道路の西端から $ t_i $ メートルの地点にあります。

以下の $ Q $ 個の問いに答えてください。

問 $ i $ ($ 1\ \leq\ i\ \leq\ Q $): 道路の西端から $ x_i $ メートルの地点から出発して道路上を自由に移動するとき、神社一社と寺一軒を訪れるのに必要な最小の移動距離は何メートルか？ (必要数を超えた数の寺社を通過してもよい。)

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ A $ $ B $ $ Q $ $ s_1 $ $ : $ $ s_A $ $ t_1 $ $ : $ $ t_B $ $ x_1 $ $ : $ $ x_Q $

## 输出格式

$ Q $ 行出力せよ。$ i $ 行目に問 $ i $ への答えを出力すること。

## 说明/提示

### 制約

- $ 1\ \leq\ A,\ B\ \leq\ 10^5 $
- $ 1\ \leq\ Q\ \leq\ 10^5 $
- $ 1\ \leq\ s_1\ <\ s_2\ <\ ...\ <\ s_A\ \leq\ 10^{10} $
- $ 1\ \leq\ t_1\ <\ t_2\ <\ ...\ <\ t_B\ \leq\ 10^{10} $
- $ 1\ \leq\ x_i\ \leq\ 10^{10} $
- $ s_1,\ ...,\ s_A,\ t_1,\ ...,\ t_B,\ x_1,\ ...,\ x_Q $ はすべて異なる。
- 入力される値はすべて整数である。

### Sample Explanation 1

$ 2 $ 社の神社と $ 3 $ 軒の寺があり、神社は道路の西端から $ 100,\ 600 $ メートルの地点に、寺は道路の西端から $ 400,\ 900,\ 1000 $ メートルの地点にあります。 - 問 $ 1 $: 道路の西端から $ 150 $ メートルの地点から出発する場合、まず西に $ 50 $ メートル進んで神社を訪れ、次に東に $ 300 $ メートル進んで寺を訪れるのが最適です。 - 問 $ 2 $: 道路の西端から $ 2000 $ メートルの地点から出発する場合、まず西に $ 1000 $ メートル進んで寺を訪れ、次に西に $ 400 $ メートル進んで神社を訪れるのが最適です。途中で寺をもう一軒通過しますが、構いません。 - 問 $ 3 $: 道路の西端から $ 899 $ メートルの地点から出発する場合、まず東に $ 1 $ メートル進んで寺を訪れ、次に西に $ 300 $ メートル進んで神社を訪れるのが最適です。 - 問 $ 4 $: 道路の西端から $ 799 $ メートルの地点から出発する場合、まず西に $ 199 $ メートル進んで神社を訪れ、次に西に $ 200 $ メートル進んで寺を訪れるのが最適です。

### Sample Explanation 2

道路は長く、$ 32 $ ビット整数に収まらない距離を移動する必要があるかもしれません。

## 样例 #1

### 输入

```
2 3 4

100

600

400

900

1000

150

2000

899

799
```

### 输出

```
350

1400

301

399
```

## 样例 #2

### 输入

```
1 1 3

1

10000000000

2

9999999999

5000000000
```

### 输出

```
10000000000

10000000000

14999999998
```



---

---
title: "[ABC122D] We Like AGC"
layout: "post"
diff: 普及+/提高
pid: AT_abc122_d
tag: []
---

# [ABC122D] We Like AGC

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc122/tasks/abc122_d

整数 $ N $ が与えられます。次の条件を満たす長さ $ N $ の文字列の数を $ 10^9+7 $ で割った余りを求めてください。

- `A`, `C`, `G`, `T` 以外の文字を含まない。
- `AGC` を部分文字列として含まない。
- 隣接する $ 2 $ 文字の入れ替えを $ 1 $ 回行うことで上記の条件に違反させることはできない。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $

## 输出格式

条件を満たす文字列の数を $ 10^9+7 $ で割った余りを出力せよ。

## 说明/提示

### 注記

文字列 $ T $ の部分文字列とは、$ T $ の先頭と末尾から $ 0 $ 文字以上を取り去って得られる文字列です。

例えば、`ATCODER` の部分文字列には `TCO`, `AT`, `CODER`, `ATCODER`, `` (空文字列) が含まれ、`AC` は含まれません。

### 制約

- $ 3\ \leq\ N\ \leq\ 100 $

### Sample Explanation 1

`A`, `C`, `G`, `T` 以外の文字を含まない長さ $ 3 $ の文字列は $ 4^3\ =\ 64 $ 通り存在し、そのうち `AGC`, `ACG`, `GAC` のみが条件に違反するため、答えは $ 64\ -\ 3\ =\ 61 $ 通りです。

### Sample Explanation 3

文字列の数を $ 10^9+7 $ で割った余りを出力することをお忘れなく。

## 样例 #1

### 输入

```
3
```

### 输出

```
61
```

## 样例 #2

### 输入

```
4
```

### 输出

```
230
```

## 样例 #3

### 输入

```
100
```

### 输出

```
388130742
```



---

---
title: "[ABC123D] Cake 123"
layout: "post"
diff: 普及+/提高
pid: AT_abc123_d
tag: []
---

# [ABC123D] Cake 123

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc123/tasks/abc123_d

AtCoder 洋菓子店は数字の形をしたキャンドルがついたケーキを販売しています。  
 ここには $ 1,\ 2,\ 3 $ の形をしたキャンドルがついたケーキがそれぞれ $ X $ 種類、$ Y $ 種類、$ Z $ 種類あります。  
 それぞれのケーキには「美味しさ」という整数の値が以下のように割り当てられています。

- $ 1 $ の形のキャンドルがついたケーキの美味しさはそれぞれ $ A_1,\ A_2,\ ...,\ A_X $
- $ 2 $ の形のキャンドルがついたケーキの美味しさはそれぞれ $ B_1,\ B_2,\ ...,\ B_Y $
- $ 3 $ の形のキャンドルがついたケーキの美味しさはそれぞれ $ C_1,\ C_2,\ ...,\ C_Z $

高橋君は ABC 123 を記念するために、$ 1,\ 2,\ 3 $ の形のキャンドルがついたケーキを $ 1 $ つずつ買うことにしました。  
 そのようにケーキを買う方法は $ X\ \times\ Y\ \times\ Z $ 通りあります。

これらの選び方を $ 3 $ つのケーキの美味しさの合計が大きい順に並べたとき、$ 1,\ 2,\ ...,\ K $ 番目の選び方でのケーキの美味しさの合計をそれぞれ出力してください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ X $ $ Y $ $ Z $ $ K $ $ A_1\ A_2\ A_3\ ...\ A_X $ $ B_1\ B_2\ B_3\ ...\ B_Y $ $ C_1\ C_2\ C_3\ ...\ C_Z $

## 输出格式

$ i $ 行目に、問題文中の $ i $ 番目の値を出力せよ。

## 说明/提示

### 制約

- $ 1\ \leq\ X\ \leq\ 1\ 000 $
- $ 1\ \leq\ Y\ \leq\ 1\ 000 $
- $ 1\ \leq\ Z\ \leq\ 1\ 000 $
- $ 1\ \leq\ K\ \leq\ \min(3\ 000,\ X\ \times\ Y\ \times\ Z) $
- $ 1\ \leq\ A_i\ \leq\ 10\ 000\ 000\ 000 $
- $ 1\ \leq\ B_i\ \leq\ 10\ 000\ 000\ 000 $
- $ 1\ \leq\ C_i\ \leq\ 10\ 000\ 000\ 000 $
- 入力中の値はすべて整数である。

### Sample Explanation 1

$ 3 $ つのケーキの選び方は $ 2\ \times\ 2\ \times\ 2\ =\ 8 $ 通りあり、それらをケーキの美味しさの合計が大きい順に並べると以下の通りです。 - $ (A_2,\ B_2,\ C_2) $: $ 6\ +\ 5\ +\ 8\ =\ 19 $ - $ (A_1,\ B_2,\ C_2) $: $ 4\ +\ 5\ +\ 8\ =\ 17 $ - $ (A_2,\ B_1,\ C_2) $: $ 6\ +\ 1\ +\ 8\ =\ 15 $ - $ (A_2,\ B_2,\ C_1) $: $ 6\ +\ 5\ +\ 3\ =\ 14 $ - $ (A_1,\ B_1,\ C_2) $: $ 4\ +\ 1\ +\ 8\ =\ 13 $ - $ (A_1,\ B_2,\ C_1) $: $ 4\ +\ 5\ +\ 3\ =\ 12 $ - $ (A_2,\ B_1,\ C_1) $: $ 6\ +\ 1\ +\ 3\ =\ 10 $ - $ (A_1,\ B_1,\ C_1) $: $ 4\ +\ 1\ +\ 3\ =\ 8 $

### Sample Explanation 2

美味しさの合計が同じになる組み合わせが複数ある可能性もあります。例えば、このテストケースで $ (A_1,\ B_3,\ C_3) $ を選ぶときと $ (A_3,\ B_3,\ C_1) $ を選ぶときはともに、美味しさの合計が $ 301 $ となります。 しかし、これらは異なる選び方であるため、出力には $ 301 $ が $ 2 $ 回出現します。

### Sample Explanation 3

入力・出力は $ 32 $ ビット整数に収まらない可能性があることに注意してください。

## 样例 #1

### 输入

```
2 2 2 8

4 6

1 5

3 8
```

### 输出

```
19

17

15

14

13

12

10

8
```

## 样例 #2

### 输入

```
3 3 3 5

1 10 100

2 20 200

1 10 100
```

### 输出

```
400

310

310

301

301
```

## 样例 #3

### 输入

```
10 10 10 20

7467038376 5724769290 292794712 2843504496 3381970101 8402252870 249131806 6310293640 6690322794 6082257488

1873977926 2576529623 1144842195 1379118507 6003234687 4925540914 3902539811 3326692703 484657758 2877436338

4975681328 8974383988 2882263257 7690203955 514305523 6679823484 4263279310 585966808 3752282379 620585736
```

### 输出

```
23379871545

22444657051

22302177772

22095691512

21667941469

21366963278

21287912315

21279176669

21160477018

21085311041

21059876163

21017997739

20703329561

20702387965

20590247696

20383761436

20343962175

20254073196

20210218542

20150096547
```



---

---
title: "[ABC127F] Absolute Minima"
layout: "post"
diff: 普及+/提高
pid: AT_abc127_f
tag: []
---

# [ABC127F] Absolute Minima

## 题目描述

有一个函数 $f(x)$ ，初始时 $f(x)=0$

接下来你会对这个函数进行 $Q$ 次以下操作：

- $\texttt{1 a b}$，将 $f(x)$ 替换为 $g(x)=f(x)+|x-a|+b$
- $\texttt{2}$，询问最小的整数 $x$ ，使得  $f(x)$ 取到最小值，以及 $f(x)$ 的最小值

## 输入格式

第一行一个整数 $Q$

接下来 $Q$ 行，每行一个或三个整数，表示一次操作。

## 输出格式

对于每一次询问，输出一行两个整数，分别表示最小的整数 $x$ ，使得 $f(x)$ 取到最小值，和 $f(x)$ 的最小值

## 说明/提示

$1 \le Q \le 200000,-10^9 \le a,b \le 10^9$ ，保证第一次操作一定是修改操作

## 样例 #1

### 输入

```
4

1 4 2

2

1 1 -8

2
```

### 输出

```
4 2

1 -3
```

## 样例 #2

### 输入

```
4

1 -1000000000 1000000000

1 -1000000000 1000000000

1 -1000000000 1000000000

2
```

### 输出

```
-1000000000 3000000000
```



---

---
title: "[ABC128D] equeue"
layout: "post"
diff: 普及+/提高
pid: AT_abc128_d
tag: []
---

# [ABC128D] equeue

## 题目描述

有一个双端队列，初始时队列中共有 $n$ 个元素，元素从头到尾的权值为 $v_{1},v_{2},\cdots,v_{n}$

你可以进行不超过 $k$ 次操作（也可以一次都不操作），每次操作可以选择队头或队尾的一个元素，将它归为己有，或将自己手上的一个元素塞到队头或队尾

问最终你手上所有元素的权值之和的最大值是多少

## 输入格式

第一行两个整数 $n,k$

接下来一行 $n$ 个整数表示 $v_{i}$

## 输出格式

一行一个整数，表示答案

## 说明/提示

$ 1 \le n \le 50,1 \le k \le 100, -10^7 \le v_{i} \le 10^7 $

## 样例 #1

### 输入

```
6 4

-10 8 2 1 2 6
```

### 输出

```
14
```

## 样例 #2

### 输入

```
6 4

-6 -100 50 -2 -5 -3
```

### 输出

```
44
```

## 样例 #3

### 输入

```
6 3

-6 -100 50 -2 -5 -3
```

### 输出

```
0
```



---

---
title: "[ABC128E] Roadwork"
layout: "post"
diff: 普及+/提高
pid: AT_abc128_e
tag: []
---

# [ABC128E] Roadwork

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc128/tasks/abc128_e

東西に無限に続く $ 1 $ 本の大通りがあり、数直線とみなすことができます。

この大通り上で $ N $ 回道路工事が行われます。 $ i $ 番目の道路工事は時刻 $ S_i\ -\ 0.5 $ から時刻 $ T_i\ -\ 0.5 $ まで座標 $ X_i $ を通行止めにします。

$ Q $ 人の人が座標 $ 0 $ に立っています。 $ i $ 番目の人は時刻 $ D_i $ に座標 $ 0 $ を出発し、速度 $ 1 $ で正の方向へ歩き続けます。 歩いている途中で通行止めとなっている地点に到達した場合には、そこで歩くのをやめます。

$ Q $ 人それぞれが進む距離を求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ Q $ $ S_1 $ $ T_1 $ $ X_1 $ $ : $ $ S_N $ $ T_N $ $ X_N $ $ D_1 $ $ : $ $ D_Q $

## 输出格式

$ Q $ 行出力せよ。

$ i $ 行目には $ i $ 番目の人が進む距離を出力せよ。 ただし $ i $ 番目の人が無限に歩き続ける場合は、代わりに $ -1 $ を出力せよ。

## 说明/提示

### 制約

- 入力は全て整数
- $ 1\ \leq\ N,\ Q\ \leq\ 2\ \times\ 10^5 $
- $ 0\ \leq\ S_i\ <\ T_i\ \leq\ 10^9 $
- $ 1\ \leq\ X_i\ \leq\ 10^9 $
- $ 0\ \leq\ D_1\ <\ D_2\ <\ ...\ <\ D_Q\ \leq\ 10^9 $
- $ i\ \neq\ j $ かつ $ X_i\ =\ X_j $ の時、区間 $ [S_i,\ T_i) $ と 区間 $ [S_j,\ T_j) $ は重ならない

### Sample Explanation 1

$ 1 $ 番目の人は時刻 $ 0 $ に座標 $ 0 $ を出発し、時刻 $ 2 $ に座標 $ 2 $ に到着した時点で、$ 1 $ 番目の道路工事による通行止めによって歩くのをやめます。 $ 2 $ 番目の人は時刻 $ 1 $ に座標 $ 0 $ を出発し、時刻 $ 3 $ に座標 $ 2 $ に到着します。この時、$ 1 $ 番目の道路工事は既に終了していますが、$ 4 $ 番目の道路工事が始まっているため、同様に座標 $ 2 $ で歩くのをやめます。 $ 4 $ 番目および $ 6 $ 番目の人は、歩いている最中に通行止めに出くわさないため、無限に歩き続けます。

## 样例 #1

### 输入

```
4 6

1 3 2

7 13 10

18 20 13

3 4 2

0

1

2

3

5

8
```

### 输出

```
2

2

10

-1

13

-1
```



---

---
title: "[ABC129E] Sum Equals Xor"
layout: "post"
diff: 普及+/提高
pid: AT_abc129_e
tag: []
---

# [ABC129E] Sum Equals Xor

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc129/tasks/abc129_e

正整数 $ L $ が二進数表記で与えられます。 以下の条件を満たす非負整数 $ a,\ b $ の組 $ (a,\ b) $ がいくつ存在するか求めてください:

- $ a\ +\ b\ \leq\ L $
- $ a\ +\ b\ =\ a\ \text{\ XOR\ }\ b $

ただし、この値は非常に大きくなることがあるので、$ 10^9\ +\ 7 $ で割った余りを出力してください。

XOR とは

整数 $ A,\ B $ のビットごとの排他的論理和 $ a\ \text{\ XOR\ }\ b $ は、以下のように定義されます。

$ a\ \text{\ XOR\ }\ b $ を二進数表記した際の $ 2^k $ ($ k\ \geq\ 0 $) の位の数は、$ A,\ B $ を二進数表記した際の $ 2^k $ の位の数のうち一方のみが $ 1 $ であれば $ 1 $、そうでなければ $ 0 $ である。 例えば、$ 3\ \text{\ XOR\ }\ 5\ =\ 6 $ となります (二進数表記すると: $ 011\ \text{\ XOR\ }\ 101\ =\ 110 $)。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ L $

## 输出格式

条件を満たす組 $ (a,\ b) $ の個数を $ 10^9\ +\ 7 $ で割った余りを出力せよ。

## 说明/提示

### 制約

- $ L $は二進数表記で与えられ、先頭文字は必ず $ 1 $ である
- $ 1\ \leq\ L\ <\ 2^{100,001} $

### Sample Explanation 1

条件を満たす $ (a,\ b) $ としては $ (0,\ 0),\ (0,\ 1),\ (1,\ 0),\ (0,\ 2),\ (2,\ 0) $ の $ 5 $ つが考えられます。

## 样例 #1

### 输入

```
10
```

### 输出

```
5
```

## 样例 #2

### 输入

```
1111111111111111111
```

### 输出

```
162261460
```



---

---
title: "[ABC130E] Common Subsequence"
layout: "post"
diff: 普及+/提高
pid: AT_abc130_e
tag: []
---

# [ABC130E] Common Subsequence

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc130/tasks/abc130_e

$ 1 $ 以上 $ 10^5 $ 以下の整数から成る、長さ $ N $ の整数列 $ S $ と 長さ $ M $ の整数列 $ T $ が与えられます。

$ S $ の部分列と $ T $ の部分列の組であって、整数列として等しいような組は何通りあるでしょうか。

ただし、整数列 $ A $ の部分列とは、$ A $ の要素を $ 0 $ 個以上いくつか選んで削除し、残ったものを元の順序を保って並べた整数列を表します。

また、$ S,\ T $ それぞれの部分列は、整数列として等しい場合でも、削除した要素の添字の集合が異なる場合には異なる部分列として区別してください。

答えは非常に大きくなることがあるので、$ 10^9+7 $ で割った余りを出力してください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ M $ $ S_1 $ $ S_2 $ $ ... $ $ S_{N-1} $ $ S_{N} $ $ T_1 $ $ T_2 $ $ ... $ $ T_{M-1} $ $ T_{M} $

## 输出格式

整数列として等しいような、$ S,\ T $ の部分列の組の個数を $ 10^9+7 $ で割った余りを出力せよ。

## 说明/提示

### 制約

- $ 1\ \leq\ N,\ M\ \leq\ 2\ \times\ 10^3 $
- $ S $ の長さは $ N $ である
- $ T $ の長さは $ M $ である
- $ 1\ \leq\ S_i,\ T_i\ \leq\ 10^5 $
- 入力は全て整数である

### Sample Explanation 1

$ S $ の部分列としては $ (),\ (1),\ (3),\ (1,\ 3) $ が考えられます。 $ T $ の部分列としては $ (),\ (3),\ (1),\ (3,\ 1) $ が考えられます。 共に部分列が $ () $ である組は $ 1\ \times\ 1 $ 通り、共に部分列が $ (1) $ である組は $ 1\ \times\ 1 $ 通り、共に部分列が $ (3) $ である組は $ 1\ \times\ 1 $ 通り考えられるので、合計 $ 3 $ 通りの組が存在します。

### Sample Explanation 2

$ S $ の部分列としては $ (),\ (1),\ (1),\ (1,\ 1) $ が考えられます。 $ T $ の部分列としては $ (),\ (1),\ (1),\ (1,\ 1) $ が考えられます。 共に部分列が $ () $ である組は $ 1\ \times\ 1 $ 通り、共に部分列が $ (1) $ である組は $ 2\ \times\ 2 $ 通り、共に部分列が $ (1,\ 1) $ である組は $ 1\ \times\ 1 $ 通り考えられるので、合計 $ 6 $ 通りの組が存在します。 部分列において削除する要素の添字の集合が異なるものを区別することに注意してください。

### Sample Explanation 5

個数を $ 10^9+7 $ で割った余りを出力することに注意してください。

## 样例 #1

### 输入

```
2 2

1 3

3 1
```

### 输出

```
3
```

## 样例 #2

### 输入

```
2 2

1 1

1 1
```

### 输出

```
6
```

## 样例 #3

### 输入

```
4 4

3 4 5 6

3 4 5 6
```

### 输出

```
16
```

## 样例 #4

### 输入

```
10 9

9 6 5 7 5 9 8 5 6 7

8 6 8 5 5 7 9 9 7
```

### 输出

```
191
```

## 样例 #5

### 输入

```
20 20

1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1

1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1
```

### 输出

```
846527861
```



---

---
title: "[ABC131E] Friendships"
layout: "post"
diff: 普及+/提高
pid: AT_abc131_e
tag: []
---

# [ABC131E] Friendships

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc131/tasks/abc131_e

以下の条件を満たす $ N $ 頂点の無向グラフは存在するでしょうか？

- グラフは単純かつ連結である。
- 各頂点には $ 1,\ 2,\ ...,\ N $ の番号が付けられている。
- グラフの辺数を $ M $ としたとき、各辺には $ 1,\ 2,\ ...,\ M $ の番号が付けられていて、辺 $ i $ は頂点 $ u_i $ と頂点 $ v_i $ をつなぐ長さ $ 1 $ の辺である。
- 最短距離が $ 2 $ であるような頂点対 $ (i,\ j)\ (i\ <\ j) $ が、ちょうど $ K $ 個存在する。

条件を満たすグラフが存在するならば $ 1 $ つ構築してください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ K $

## 输出格式

条件を満たすグラフが存在しなければ `-1` を出力せよ。

存在するならば、そのようなグラフを $ 1 $ つ、以下の形式で出力せよ (記号の意味は問題文を参照せよ)。

> $ M $ $ u_1 $ $ v_1 $ $ : $ $ u_M $ $ v_M $

条件を満たすグラフが複数存在する場合、どれを出力してもよい。

## 说明/提示

### 制約

- 入力は全て整数である。
- $ 2\ \leq\ N\ \leq\ 100 $
- $ 0\ \leq\ K\ \leq\ \frac{N(N\ -\ 1)}{2} $

### Sample Explanation 1

このグラフには最短距離が $ 2 $ であるような頂点対が $ (1,\ 4),\ (2,\ 4),\ (3,\ 5) $ の $ 3 $ 個存在します。よって条件を満たしています。

### Sample Explanation 2

条件を満たすグラフは存在しません。

## 样例 #1

### 输入

```
5 3
```

### 输出

```
5

4 3

1 2

3 1

4 5

2 3
```

## 样例 #2

### 输入

```
5 8
```

### 输出

```
-1
```



---

---
title: "[ABC132D] Blue and Red Balls"
layout: "post"
diff: 普及+/提高
pid: AT_abc132_d
tag: []
---

# [ABC132D] Blue and Red Balls

## 题目描述

有 $K$ 个蓝球和 $N-K$ 个红球。同一颜色的球是完全相同的。Snuke 和 Takahashi 在玩这些球。

首先，Snuke 将把 $N$ 个球从左到右排成一排。

然后，Takahashi 将收走 $K$ 个蓝球。在一次操作中，他可以收走连续的一个区间的蓝球。他将以最少的操作数收走所有蓝球。

Snuke 有多少种排列这 $N$ 个球的方法，使得 Takahashi 恰好操作 $i$ 次才能收走所有的 $K$ 个蓝球？对于每个 $i$（$1\le i\le K$）计算排列数对 $10^9+7$ 取模的结果。

------------

## 输入格式

$N\ K$

------------

## 输出格式

输出 $K$ 行。第 $i$ 行（$1\le i\le K$）表示有多少种排列这 $N$ 个球的方法，使得 Takahashi 恰好操作 $i$ 次才能收走所有的 $K$ 个蓝球，对 $10^9+7$ 取模。

------------

## 说明/提示

#### 样例解释 1
有三种方法来排列球，使得 Takahashi 恰好操作 $1$ 次：$(B, B, B, R, R)$，$(R, B, B, B, R)$ 和 $(R, R, B, B, B)$。（$R$ 和 $B$ 分别代表红色和蓝色）。

有六种方法来排列球，使得 Takahashi 恰好操作 $2$ 次：$(B, B, R, B, R)$，$(B, B, R, R, B)$，$(R, B, B, R, B)$，$(R, B, B, R, B)$，$(B, R, B, B, R)$，和 $(B, R, R, B, B)$。

有一种方法来排列球，使得 Takahashi 恰好操作 $3$ 次：$(B, R, B, R, B)$。

#### 样例解释 2
务必输出对 $10^9+7$ 的排列数。

## 样例 #1

### 输入

```
5 3
```

### 输出

```
3

6

1
```

## 样例 #2

### 输入

```
2000 3
```

### 输出

```
1998

3990006

327341989
```



---

---
title: "[ABC132E] Hopscotch Addict"
layout: "post"
diff: 普及+/提高
pid: AT_abc132_e
tag: []
---

# [ABC132E] Hopscotch Addict

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc132/tasks/abc132_e

ケンくんはけんけんぱが大好きです。今日は有向グラフ $ G $ の上でけんけんぱをすることにしました。 $ G $ は $ 1 $ から $ N $ で番号付けされた $ N $ 頂点および $ M $ 辺からなり、 $ i $ 番目の辺は頂点 $ u_i $ から頂点 $ v_i $ に接続しています。

ケンくんははじめ頂点 $ S $ にいて、頂点 $ T $ までけんけんぱで移動したいです。 $ 1 $ 回のけんけんぱでは、「自分の今いる頂点から出ている辺を $ 1 $ つ選んで、その辺が接続する頂点に移動する」という操作をちょうど $ 3 $ 回連続で行います。

ケンくんが頂点 $ T $ に移動することができるか、また移動できるなら最小何回のけんけんぱで頂点 $ T $ まで移動することができるかを答えてください。 けんけんぱの操作の途中で頂点 $ T $ に訪れても、「頂点 $ T $ に移動できた」とは見なさないことに注意してください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ M $ $ u_1 $ $ v_1 $ $ : $ $ u_M $ $ v_M $ $ S $ $ T $

## 输出格式

何回けんけんぱを繰り返しても頂点 $ S $ から頂点 $ T $ へ移動できない場合には、$ -1 $ を出力せよ。 移動できる場合には、移動するのに必要なけんけんぱの最小回数を出力せよ。

## 说明/提示

### 制約

- $ 2\ \leq\ N\ \leq\ 10^5 $
- $ 0\ \leq\ M\ \leq\ \min(10^5,\ N\ (N-1)) $
- $ 1\ \leq\ u_i,\ v_i\ \leq\ N(1\ \leq\ i\ \leq\ M) $
- $ u_i\ \neq\ v_i\ (1\ \leq\ i\ \leq\ M) $
- $ i\ \neq\ j $ ならば $ (u_i,\ v_i)\ \neq\ (u_j,\ v_j) $
- $ 1\ \leq\ S,\ T\ \leq\ N $
- $ S\ \neq\ T $

### Sample Explanation 1

$ 1 $ 回目のけんけんぱでは $ 1\ \rightarrow\ 2\ \rightarrow\ 3\ \rightarrow\ 4 $、$ 2 $ 回目のけんけんぱでは $ 4\ \rightarrow\ 1\ \rightarrow\ 2\ \rightarrow\ 3 $ と移動することで頂点 $ 3 $ に辿り着くことができ、これが最小回数です。

### Sample Explanation 2

何回けんけんぱを繰り返しても頂点 $ 1 $ に辿り着くため、頂点 $ 2 $ に移動することは不可能です。 けんけんぱの途中で頂点 $ 2 $ を通過することはできますが、これは移動できたとは見なしません。

### Sample Explanation 3

頂点 $ S $ と頂点 $ T $ は非連結である場合があります。

## 样例 #1

### 输入

```
4 4

1 2

2 3

3 4

4 1

1 3
```

### 输出

```
2
```

## 样例 #2

### 输入

```
3 3

1 2

2 3

3 1

1 2
```

### 输出

```
-1
```

## 样例 #3

### 输入

```
2 0

1 2
```

### 输出

```
-1
```

## 样例 #4

### 输入

```
6 8

1 2

2 3

3 4

4 5

5 1

1 4

1 5

4 6

1 6
```

### 输出

```
2
```



---

---
title: "[ABC133E] Virus Tree 2"
layout: "post"
diff: 普及+/提高
pid: AT_abc133_e
tag: []
---

# [ABC133E] Virus Tree 2

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc133/tasks/abc133_e

$ N $ 頂点、$ N-1 $ 辺を持つ木が与えられます。 頂点には番号 $ 1,2,...,N $ がつけられており、$ i $ 番目の辺は頂点 $ a_i,b_i $ をつないでいます。

あなたは $ K $ 色の絵の具を持っています。 木の頂点それぞれに対して、以下の条件を満たすように、$ K $ 色の中から $ 1 $ 色を選んで塗ることにしました。

- 二つの異なる頂点 $ x,y $ 間の距離が $ 2 $ 以下ならば、頂点 $ x $ の色と頂点 $ y $ の色は異なる。

木を塗り分ける方法は何通りあるでしょうか。 総数を $ 1,000,000,007 $ で割った余りを求めてください。

木とは

木とはグラフの一種です。詳しくはこちらをご覧ください: [Wikipedia「木 (数学)」](https://ja.wikipedia.org/wiki/%E6%9C%A8_(%E6%95%B0%E5%AD%A6))

距離とは

二つの頂点 $ x,y $ 間の距離とは、$ x $ から $ y $ に到達する際にたどる必要のある最小の辺数です。

## 输入格式

入力は以下の形式で標準入力から与えられます。

> $ N $ $ K $ $ a_1 $ $ b_1 $ $ a_2 $ $ b_2 $ $ . $ $ . $ $ . $ $ a_{N-1} $ $ b_{N-1} $

## 输出格式

木の塗り分け方の総数を $ 1,000,000,007 $ で割った余りを出力してください。

## 说明/提示

### 制約

- $ 1\ \leqq\ N,K\ \leqq\ 10^5 $
- $ 1\ \leqq\ a_i,b_i\ \leqq\ N $
- 与えられるグラフは木である。

### Sample Explanation 1

!\[zu\](https://img.atcoder.jp/ghi/491cd56a53e99ba7677ee4827b8f767a.png) 塗り分け方は $ 6 $ 通りです。

## 样例 #1

### 输入

```
4 3

1 2

2 3

3 4
```

### 输出

```
6
```

## 样例 #2

### 输入

```
5 4

1 2

1 3

1 4

4 5
```

### 输出

```
48
```

## 样例 #3

### 输入

```
16 22

12 1

3 1

4 16

7 12

6 2

2 15

5 16

14 16

10 11

3 10

3 13

8 6

16 8

9 12

4 3
```

### 输出

```
271414432
```



---

---
title: "[ABC136E] Max GCD"
layout: "post"
diff: 普及+/提高
pid: AT_abc136_e
tag: []
---

# [ABC136E] Max GCD

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc136/tasks/abc136_e

長さ $ N $ の整数列 $ A_1,\ A_2,\ \cdots,\ A_N $ があります。

次の操作を $ 0 $ 回以上 $ K $ 回以下行うことができます。

- $ i\ \neq\ j $ なる $ 1 $ 以上 $ N $ 以下の $ 2 $ つの整数 $ i,\ j $ を選び、$ A_i $ に $ 1 $ を足し、$ A_j $ に $ -1 $ を足す。この操作の後いずれかの要素が負になってもよい。

操作後の $ A $ の全ての要素を割り切る正の整数として考えられる値の最大値を計算してください。ただし、正の整数 $ x $ が整数 $ y $ を割り切るとは、ある整数 $ z $ を用いて $ y\ =\ xz $ と表せる場合を表します。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ K $ $ A_1 $ $ A_2 $ $ \cdots $ $ A_{N-1} $ $ A_{N} $

## 输出格式

操作後の $ A $ の全ての要素を割り切る正の整数として考えられる値の最大値を出力せよ。

## 说明/提示

### 制約

- $ 2\ \leq\ N\ \leq\ 500 $
- $ 1\ \leq\ A_i\ \leq\ 10^6 $
- $ 0\ \leq\ K\ \leq\ 10^9 $
- 入力は全て整数である

### Sample Explanation 1

例えば以下の操作で、$ 7 $ が $ A $ の全ての要素を割り切るようにできます。 - $ i\ =\ 2,\ j\ =\ 1 $ とする。$ A $ は $ (7,\ 21) $ となる。 また、$ 8 $ 以上の整数が $ A $ の全ての要素を割り切るようにはできません。

### Sample Explanation 2

例えば、以下のように操作を $ 5 $ 回行います。 - $ i\ =\ 2,\ j\ =\ 1 $ とする。$ A $ は $ (2,\ 6) $ となる。 - $ i\ =\ 2,\ j\ =\ 1 $ とする。$ A $ は $ (1,\ 7) $ となる。 - $ i\ =\ 2,\ j\ =\ 1 $ とする。$ A $ は $ (0,\ 8) $ となる。 - $ i\ =\ 2,\ j\ =\ 1 $ とする。$ A $ は $ (-1,\ 9) $ となる。 - $ i\ =\ 1,\ j\ =\ 2 $ とする。$ A $ は $ (0,\ 8) $ となる。 このとき、$ 0\ =\ 8\ \times\ 0,\ 8\ =\ 8\ \times\ 1 $ と表せるので、$ 8 $ は $ A $ の全ての要素を割り切ります。また、$ 9 $ 以上の整数が $ A $ の全ての要素を割り切るようにはできません。

## 样例 #1

### 输入

```
2 3

8 20
```

### 输出

```
7
```

## 样例 #2

### 输入

```
2 10

3 5
```

### 输出

```
8
```

## 样例 #3

### 输入

```
4 5

10 1 2 22
```

### 输出

```
7
```

## 样例 #4

### 输入

```
8 7

1 7 5 6 8 2 6 5
```

### 输出

```
5
```



---

---
title: "[ABC137D] Summer Vacation"
layout: "post"
diff: 普及+/提高
pid: AT_abc137_d
tag: []
---

# [ABC137D] Summer Vacation

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc137/tasks/abc137_d

$ N $ 件の日雇いアルバイトがあり、$ i $ 件目の日雇いアルバイトを請けて働くと、その $ A_i $ 日後に報酬 $ B_i $ が得られます。

あなたは、これらの中から $ 1 $ 日に $ 1 $ 件まで選んで請け、働くことができます。

ただし、請けたことのある日雇いアルバイトは選べません。

今日から $ M $ 日後まで($ M $ 日後を含む)に得られる報酬の合計の最大値を求めてください。

なお、日雇いアルバイトは今日から請けて働くことができます。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ M $ $ A_1 $ $ B_1 $ $ A_2 $ $ B_2 $ $ \vdots $ $ A_N $ $ B_N $

## 输出格式

$ M $ 日後までに得られる報酬の合計の最大値を出力せよ。

## 说明/提示

### 制約

- 入力は全て整数である。
- $ 1\ \leq\ N\ \leq\ 10^5 $
- $ 1\ \leq\ M\ \leq\ 10^5 $
- $ 1\ \leq\ A_i\ \leq\ 10^5 $
- $ 1\ \leq\ B_i\ \leq\ 10^4 $

### Sample Explanation 1

以下のように日雇いアルバイトを請けて働くと、報酬の合計は $ 5 $ となり、このときが最大です。 - 今日、$ 1 $ 件目の日雇いアルバイトを請けて働き、今日から $ 4 $ 日後に報酬 $ 3 $ を得ます。 - 明日(今日から $ 1 $ 日後)、$ 3 $ 件目の日雇いアルバイトを請けて働き、今日から $ 1+2\ =\ 3 $ 日後に報酬 $ 2 $ を得ます。

## 样例 #1

### 输入

```
3 4

4 3

4 1

2 2
```

### 输出

```
5
```

## 样例 #2

### 输入

```
5 3

1 2

1 3

1 4

2 1

2 3
```

### 输出

```
10
```

## 样例 #3

### 输入

```
1 1

2 1
```

### 输出

```
0
```



---

---
title: "[ABC137E] Coins Respawn"
layout: "post"
diff: 普及+/提高
pid: AT_abc137_e
tag: []
---

# [ABC137E] Coins Respawn

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc137/tasks/abc137_e

$ 1 $ から $ N $ までの番号がつけられた $ N $ 頂点と $ M $ 辺からなる有向グラフがあります。 $ i $ 番目の辺は頂点 $ A_i $ から頂点 $ B_i $ へと向かい、この辺の上には $ C_i $ 枚のコインが置かれています。 また、頂点 $ N $ にはボタンが設置されています。

このグラフ上でゲームを行います。 あなたは頂点 $ 1 $ でコインを $ 0 $ 枚持ってゲームを開始し、辺をたどってコインを拾いながら頂点 $ N $ を目指します。 $ 1 $ 本の辺を通るには $ 1 $ 分の時間がかかり、辺を通るたびにその辺の上に置かれているすべてのコインを拾うことができます。 ゲームの世界ではよくあるように、ある辺を通ってその上のコインを拾っても、その辺を次に通る際には同じ枚数のコインが再び出現しており、それらを再び拾うことができます。

頂点 $ N $ に到着したとき、ボタンを押してゲームを終了することができます。(ボタンを押さずに移動を続けることもできます。) ただし、ゲームを終了する際に、ゲーム開始からの経過時間を $ T $ 分として $ T\ \times\ P $ 枚のコインの支払いが要求されます。持っているコインの枚数が $ T\ \times\ P $ 枚未満の場合は、代わりに持っているコインをすべて支払います。

この支払いの後に残ったコインの枚数があなたのスコアとなります。 獲得できるスコアの最大値が存在するか判定し、存在する場合はその最大値を求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ M $ $ P $ $ A_1 $ $ B_1 $ $ C_1 $ $ : $ $ A_M $ $ B_M $ $ C_M $

## 输出格式

獲得できるスコアの最大値が存在する場合はその最大値を、存在しない場合は `-1` を出力せよ。

## 说明/提示

### 制約

- $ 2\ \leq\ N\ \leq\ 2500 $
- $ 1\ \leq\ M\ \leq\ 5000 $
- $ 1\ \leq\ A_i,\ B_i\ \leq\ N $
- $ 1\ \leq\ C_i\ \leq\ 10^5 $
- $ 0\ \leq\ P\ \leq\ 10^5 $
- 入力中の値はすべて整数である。
- 頂点 $ 1 $ から頂点 $ N $ に到達することが可能である。

### Sample Explanation 1

!\[入力例 1 で与えられるグラフの図\](https://img.atcoder.jp/ghi/5cb074e2d7c3282da137ac4ab2fbc700.png) 頂点 $ 1 $ から頂点 $ 3 $ に移動する方法は以下の $ 2 $ 通りです。 - 頂点 $ 1\ \rightarrow\ 2\ \rightarrow\ 3 $: 道中でコインを $ 20\ +\ 30\ =\ 50 $ 枚拾う。ゲーム開始から $ 2 $ 分後に頂点 $ 3 $ に着き、ボタンを押してコインを $ 2\ \times\ 10\ =\ 20 $ 枚支払い、$ 50\ -\ 20\ =\ 30 $ 枚残る。 - 頂点 $ 1\ \rightarrow\ 3 $: 道中でコインを $ 45 $ 枚拾う。ゲーム開始から $ 1 $ 分後に頂点 $ 3 $ に着き、ボタンを押してコインを $ 1\ \times\ 10\ =\ 10 $ 枚支払い、$ 45\ -\ 10\ =\ 35 $ 枚残る。 よって、獲得できるスコアの最大値は $ 35 $ です。

### Sample Explanation 2

!\[入力例 2 で与えられるグラフの図\](https://img.atcoder.jp/ghi/eb2188ad1e8189f963d233415fb293b6.png) 頂点 $ 1 $ から伸びる辺を通ると頂点 $ 2 $ に着き、ここで頂点 $ 2 $ から自分自身へと向かう辺を $ t $ 回通ってからボタンを押すとスコアは $ 90\ +\ 90t $ となります。よってスコアは無限に高めることができ、獲得できるスコアの最大値は存在しません。

### Sample Explanation 3

!\[入力例 3 で与えられるグラフの図\](https://img.atcoder.jp/ghi/217f7a224b80a05d8e25140c57e65ae7.png) 頂点 $ 1 $ から頂点 $ 4 $ へと直接向かう辺を通ること以外に頂点 $ 1 $ から頂点 $ 4 $ に移動する方法はありません。この辺の上で $ 1 $ 枚のコインを拾いますが、ゲーム終了時に $ 10 $ 枚のコインの支払いを要求されてスコアは $ 0 $ となります。 なお、頂点 $ 1 $ から頂点 $ 2 $ へと向かう辺を通るとその後コインを無限に拾えますが、頂点 $ 4 $ に到達してゲームを終了することができなくなるため無意味です。

## 样例 #1

### 输入

```
3 3 10

1 2 20

2 3 30

1 3 45
```

### 输出

```
35
```

## 样例 #2

### 输入

```
2 2 10

1 2 100

2 2 100
```

### 输出

```
-1
```

## 样例 #3

### 输入

```
4 5 10

1 2 1

1 4 1

3 4 1

2 2 100

3 3 100
```

### 输出

```
0
```



---

---
title: "[ABC138E] Strings of Impurity"
layout: "post"
diff: 普及+/提高
pid: AT_abc138_e
tag: []
---

# [ABC138E] Strings of Impurity

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc138/tasks/abc138_e

英小文字からなる二つの文字列 $ s,\ t $ が与えられます。次の条件を満たす整数 $ i $ $ (1\ \leq\ i\ \leq\ 10^{100}\ \times\ |s|) $ が存在するか判定し、存在する場合はそのような $ i $ の最小値を求めてください。

- $ s $ を $ 10^{100} $ 個連結して得られる文字列を $ s' $ とする。$ t $ は、文字列 $ {s'}_1{s'}_2\ldots{s'}_i $ ($ s' $ の先頭 $ i $ 文字) の部分列である。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ s $ $ t $

## 输出格式

条件を満たす整数 $ i $ が存在する場合はそのような $ i $ の最小値を、存在しない場合は `-1` を出力せよ。

## 说明/提示

### 注記

- 文字列 $ a $ の部分列とは、$ a $ から $ 0 $ 文字以上を削除して残った文字を相対的な順序を保ったまま連結して得られる文字列です。例えば、`contest` の部分列には `net`, `c`, `contest` などがあります。

### 制約

- $ 1\ \leq\ |s|\ \leq\ 10^5 $
- $ 1\ \leq\ |t|\ \leq\ 10^5 $
- $ s,\ t $ は英小文字からなる。

### Sample Explanation 1

$ t\ = $ `son` は文字列 `contestcon` ($ s'\ = $ `contestcontestcontest...` の先頭 $ 10 $ 文字) の部分列であるため、$ i\ =\ 10 $ は条件を満たします。 一方で、$ t $ は文字列 `contestco` ($ s' $ の先頭 $ 9 $ 文字) の部分列ではないため、$ i\ =\ 9 $ は条件を満たしません。 同様に、$ 8 $ 以下の任意の整数も条件を満たしません。よって、条件を満たす整数 $ i $ の最小値は $ 10 $ です。

### Sample Explanation 2

$ t\ = $ `programming` は $ s'\ = $ `contestcontestcontest...` の部分列ではありません。よって、条件を満たす整数 $ i $ は存在しません。

### Sample Explanation 3

ここにそのようなケースを置くことはできませんが、答えは $ 32 $ bit 整数に収まらない可能性があるのでご注意ください。

## 样例 #1

### 输入

```
contest

son
```

### 输出

```
10
```

## 样例 #2

### 输入

```
contest

programming
```

### 输出

```
-1
```

## 样例 #3

### 输入

```
contest

sentence
```

### 输出

```
33
```



---

---
title: "[ABC139E] League"
layout: "post"
diff: 普及+/提高
pid: AT_abc139_e
tag: []
---

# [ABC139E] League

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc139/tasks/abc139_e

$ N $ 人の選手がテニスの大会に参加します。彼らを選手 $ 1 $、選手 $ 2 $、$ \ldots $、選手 $ N $ と呼びます。

大会は総当たり戦で、合計 $ N(N-1)/2 $ 試合が行われます。 これらの試合の日程を、以下の条件をすべて満たすように決めることは可能でしょうか。可能である場合、必要な最小の日数も求めてください。

- 各選手は一日に最大で一試合を行う。
- 各選手 $ i $ $ (1\ \leq\ i\ \leq\ N) $ は、選手 $ A_{i,\ 1},\ A_{i,\ 2},\ \ldots,\ A_{i,\ N-1} $ とこの順に一度ずつ試合を行う。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ A_{1,\ 1} $ $ A_{1,\ 2} $ $ \ldots $ $ A_{1,\ N-1} $ $ A_{2,\ 1} $ $ A_{2,\ 2} $ $ \ldots $ $ A_{2,\ N-1} $ $ : $ $ A_{N,\ 1} $ $ A_{N,\ 2} $ $ \ldots $ $ A_{N,\ N-1} $

## 输出格式

条件をすべて満たすように全試合の日程を決めることが可能なら必要な最小の日数を、不可能なら `-1` を出力せよ。

## 说明/提示

### 制約

- $ 3\ \leq\ N\ \leq\ 1000 $
- $ 1\ \leq\ A_{i,\ j}\ \leq\ N $
- $ A_{i,\ j}\ \neq\ i $
- $ A_{i,\ 1},\ A_{i,\ 2},\ \ldots,\ A_{i,\ N-1} $ はすべて異なる。

### Sample Explanation 1

$ 3 $ 日間で次のように試合を行えばすべての条件を満たせます。 - $ 1 $ 日目: 選手 $ 1 $ 対 選手 $ 2 $ - $ 2 $ 日目: 選手 $ 1 $ 対 選手 $ 3 $ - $ 3 $ 日目: 選手 $ 2 $ 対 選手 $ 3 $ これが必要な最小日数です。

### Sample Explanation 2

$ 4 $ 日間で次のように試合を行えばすべての条件を満たせます。 - $ 1 $ 日目: 選手 $ 1 $ 対 選手 $ 2 $、選手 $ 3 $ 対 選手 $ 4 $ - $ 2 $ 日目: 選手 $ 1 $ 対 選手 $ 3 $ - $ 3 $ 日目: 選手 $ 1 $ 対 選手 $ 4 $、選手 $ 2 $ 対 選手 $ 3 $ - $ 4 $ 日目: 選手 $ 2 $ 対 選手 $ 4 $ これが必要な最小日数です。

### Sample Explanation 3

どのような日程で試合を行っても何らかの条件に違反します。

## 样例 #1

### 输入

```
3

2 3

1 3

1 2
```

### 输出

```
3
```

## 样例 #2

### 输入

```
4

2 3 4

1 3 4

4 1 2

3 1 2
```

### 输出

```
4
```

## 样例 #3

### 输入

```
3

2 3

3 1

1 2
```

### 输出

```
-1
```



---

---
title: "[ABC140E] Second Sum"
layout: "post"
diff: 普及+/提高
pid: AT_abc140_e
tag: []
---

# [ABC140E] Second Sum

## 题目描述

### 题面描述

给出一个 $1 \sim n$ 的排列（即 $1 \sim n$ 每个数只出现一次）$P$。

给出一对 $[L, R]$，设 $X_{L, R}$ 是 $P_L \sim P_R$ 中的次大值（第二大值）。

求 $\sum_{L = 1}^{N - 1} \sum_{R = L + 1}^{N} X_{L, R}$。

注：即求所有 $[L, R]$ 区间的次大值之和。

## 输入格式

第一行一个整数 $N$，表示之后给出的排列长度为 $N$。

第二行一个长度为 $N$ 的排列 $P$。

## 输出格式

输出一个整数，表示 $\sum_{L = 1}^{N - 1} \sum_{R = L + 1}^{N} X_{L, R}$

## 说明/提示

#### 样例 1 解释

$X_{1, 2} = 2, X_{1, 3} = 2, X_{2, 3} = 1$，次大值和为 $2 + 2 + 1 = 5$。

#### 数据约束

对于 $100\%$ 的数据，保证：
- $2 \le N \le 10^5$
- $1 \le P_i \le N$
- $P_i \ne P_j (i \ne j)$
- $1 \le L < R \le N$
- 所有输入均为整数。

---

署名：[George222](https://www.luogu.com.cn/user/848194)

## 样例 #1

### 输入

```
3

2 3 1
```

### 输出

```
5
```

## 样例 #2

### 输入

```
5

1 2 3 4 5
```

### 输出

```
30
```

## 样例 #3

### 输入

```
8

8 2 7 3 4 5 6 1
```

### 输出

```
136
```



---

---
title: "[ABC141E] Who Says a Pun?"
layout: "post"
diff: 普及+/提高
pid: AT_abc141_e
tag: []
---

# [ABC141E] Who Says a Pun?

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc141/tasks/abc141_e

長さ $ N $ の文字列 $ S $ が与えられます。

非空文字列であって、$ S $ の連続する部分文字列として重ならずに $ 2 $ 回以上現れるもののうち、最長のものの長さを答えてください。

より厳密には、

- $ l_1\ +\ len\ \leq\ l_2 $
- $ S[l_1+i]\ =\ S[l_2+i]\ (i\ =\ 0,\ 1,\ ...,\ len\ -\ 1) $

を満たす整数 $ l_1 $ , $ l_2 $ ( $ 1\ \leq\ l_1,\ l_2\ \leq\ N\ -\ len\ +\ 1 $ ) が存在するような正整数 $ len $ の最大値を求めてください。そのような $ len $ が存在しないときは、$ 0 $ を出力してください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ S $

## 输出格式

非空文字列であって、$ S $ の連続する部分文字列として重ならずに $ 2 $ 回以上現れるもののうち、最長のものの長さを出力せよ。そのような非空文字列が存在しないときは、$ 0 $ を出力せよ。

## 说明/提示

### 制約

- $ 2\ <\ =\ N\ <\ =\ 5\ \times\ 10^3 $
- $ |S|\ =\ N $
- $ S $ は英小文字から成る

### Sample Explanation 1

条件を満たす文字列として、`a`, `b`, `ab`, `ba` が考えられます。これらの長さの最大値 $ 2 $ が答えです。 `aba` は $ S $ の連続する部分文字列として $ 2 $ 度現れますが、$ l_1\ +\ len\ \leq\ l_2 $ を満たすような $ l_1 $ , $ l_2 $ が取れないことに注意してください。

### Sample Explanation 2

条件を満たす非空文字列は存在しません。

## 样例 #1

### 输入

```
5

ababa
```

### 输出

```
2
```

## 样例 #2

### 输入

```
2

xy
```

### 输出

```
0
```

## 样例 #3

### 输入

```
13

strangeorange
```

### 输出

```
5
```



---

---
title: "[ABC142E] Get Everything"
layout: "post"
diff: 普及+/提高
pid: AT_abc142_e
tag: []
---

# [ABC142E] Get Everything

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc142/tasks/abc142_e

鍵のかかった宝箱が $ N $ 個あり、$ 1 $ から $ N $ までの番号がつけられています。

店で $ M $ 個の鍵が売られています。$ i $ 個目の鍵は $ a_i $ 円で販売されており、$ b_i $ 種類の宝箱 $ c_{i1} $ , $ c_{i2} $ , ..., $ c_{i{b_i}} $ を開けることが出来ます。購入した鍵は何度でも使うことが出来ます。

全ての宝箱を開ける為に必要な費用の最小値を答えてください。全ての宝箱を開けることが不可能である場合は $ -1 $ を出力してください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ M $ $ a_1 $ $ b_1 $ $ c_{11} $ $ c_{12} $ $ ... $ $ c_{1{b_1}} $ $ : $ $ a_M $ $ b_M $ $ c_{M1} $ $ c_{M2} $ $ ... $ $ c_{M{b_M}} $

## 输出格式

全ての宝箱を開ける為に必要な費用の最小値を出力せよ。 全ての宝箱を開けることが不可能である場合は $ -1 $ を出力せよ。

## 说明/提示

### 制約

- 入力は全て整数
- $ 1\ <\ =\ N\ <\ =\ 12 $
- $ 1\ <\ =\ M\ <\ =\ 10^3 $
- $ 1\ \leq\ a_i\ \leq\ 10^5 $
- $ 1\ \leq\ b_i\ \leq\ N $
- $ 1\ \leq\ c_{i1}\ <\ c_{i2}\ <\ ...\ <\ c_{i{b_i}}\ \leq\ N $

### Sample Explanation 1

鍵 $ 1 $ と鍵 $ 2 $ を購入すると、全ての宝箱を開けることが出来ます。このときの費用は $ 25 $ 円であり、これが最小値です。

### Sample Explanation 2

全ての宝箱を開けることは出来ません。

## 样例 #1

### 输入

```
2 3

10 1

1

15 1

2

30 2

1 2
```

### 输出

```
25
```

## 样例 #2

### 输入

```
12 1

100000 1

2
```

### 输出

```
-1
```

## 样例 #3

### 输入

```
4 6

67786 3

1 3 4

3497 1

2

44908 3

2 3 4

2156 3

2 3 4

26230 1

2

86918 1

3
```

### 输出

```
69942
```



---

---
title: "[ABC142F] Pure"
layout: "post"
diff: 普及+/提高
pid: AT_abc142_f
tag: []
---

# [ABC142F] Pure

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc142/tasks/abc142_f

$ N $ 頂点 $ M $ 辺の有向グラフ $ G $ が与えられます。  
 このグラフの頂点には $ 1 $ から $ N $ までの番号が付けられており、$ i $ 番目の辺は頂点 $ A_i $ から頂点 $ B_i $ に向けて張られています。  
 このグラフは自己辺や多重辺を持たないことが保証されています。

すべての頂点の入次数が $ 1 $、出次数が $ 1 $ であるような $ G $ の誘導部分グラフ (注記を参照) が存在するか判定し、 存在するならその一例を示してください。  
 ただし、空グラフは含めないものとします。

## 输入格式

入力は以下の形式で標準入力から与えられます。

> $ N $ $ M $ $ A_1 $ $ B_1 $ $ A_2 $ $ B_2 $ $ : $ $ A_M $ $ B_M $

## 输出格式

条件を満たす $ G $ の誘導部分グラフが存在しないとき、`-1` と出力してください。 そうでないとき、以下のフォーマットで条件を満たす $ G $ の誘導部分グラフの一例を出力してください。

> $ K $ $ v_1 $ $ v_2 $ : $ v_K $

これは、頂点数が $ K $、頂点集合が $ \{v_1,\ v_2,\ \ldots,\ v_K\} $ であるような $ G $ の誘導部分グラフを表します。($ v_1,\ v_2,\ \ldots,\ v_K $ の順序は問いません。) 条件を満たす $ G $ の誘導部分グラフが複数存在するときは、そのうちのどれを出力しても構いません。

## 说明/提示

### 注記

有向グラフ $ G\ =\ (V,\ E) $ に対し、次のような条件を満たす有向グラフ $ G'\ =\ (V',\ E') $ を $ G $ の誘導部分グラフと呼びます。

- $ V' $ は $ V $ の (空でない) 部分集合である。
- $ E' $ は、$ E $ の辺であって両端点がともに $ V' $ に含まれるものすべてを含む集合である。

### 制約

- $ 1\ \leq\ N\ \leq\ 1000 $
- $ 0\ \leq\ M\ \leq\ 2000 $
- $ 1\ \leq\ A_i,B_i\ \leq\ N $
- $ A_i\ \neq\ B_i $
- 組 $ (A_i,\ B_i) $ はすべて異なる。
- 入力はすべて整数である。

### Sample Explanation 1

頂点集合が $ \{1,\ 2,\ 4\} $ であるような $ G $ の誘導部分グラフの辺集合は $ \{(1,\ 2),\ (2,\ 4),\ (4,\ 1)\} $ であり、すべての頂点の入次数が $ 1 $、出次数が $ 1 $ となります。

### Sample Explanation 2

条件を満たす $ G $ の誘導部分グラフは存在しません。

## 样例 #1

### 输入

```
4 5

1 2

2 3

2 4

4 1

4 3
```

### 输出

```
3

1

2

4
```

## 样例 #2

### 输入

```
4 5

1 2

2 3

2 4

1 4

4 3
```

### 输出

```
-1
```

## 样例 #3

### 输入

```
6 9

1 2

2 3

3 4

4 5

5 6

5 1

5 2

6 1

6 2
```

### 输出

```
4

2

3

4

5
```



---

---
title: "[ABC143E] Travel by Car"
layout: "post"
diff: 普及+/提高
pid: AT_abc143_e
tag: []
---

# [ABC143E] Travel by Car

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc143/tasks/abc143_e

$ 1 $ から $ N $ までの番号がついた $ N $ 個の町と $ M $ 本の道があります。$ i $ 本目の道は町 $ A_i $ と町 $ B_i $ を双方向に結び、その長さは $ C_i $ です。

高橋君はこれらの町の間を、道を車で通行することで移動します。車の燃料タンクの容量は $ L $ リットルであり、距離 $ 1 $ を移動する度に燃料を $ 1 $ リットル消費します。移動中に町を訪れた場合、燃料をタンクが一杯になるまで補給することが出来ます (補給しないという選択も可能です)。道の途中で燃料が尽きるような移動は出来ません。

以下の $ Q $ 個のクエリに答えてください。

- はじめ、車の燃料タンクは一杯です。町 $ s_i $ から町 $ t_i $ へ移動するとき、最小で何回途中で燃料を補給する必要があるかを答えてください。町 $ t_i $ まで移動出来ない場合は $ −1 $ を出力してください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ M $ $ L $ $ A_1 $ $ B_1 $ $ C_1 $ $ : $ $ A_M $ $ B_M $ $ C_M $ $ Q $ $ s_1 $ $ t_1 $ $ : $ $ s_Q $ $ t_Q $

## 输出格式

$ Q $ 行出力せよ。

$ i $ 行目には、町 $ s_i $ から町 $ t_i $ へ移動するとき、最小で何回燃料を補給する必要があるかを出力せよ。町 $ t_i $ まで移動出来ない場合は $ −1 $ を出力せよ。

## 说明/提示

### 制約

- 入力は全て整数
- $ 2\ <\ =\ N\ <\ =\ 300 $
- $ 0\ <\ =\ M\ <\ =\ \frac{N(N-1)}{2} $
- $ 1\ \leq\ L\ \leq\ 10^9 $
- $ 1\ <\ =\ A_i,\ B_i\ <\ =\ N $
- $ A_i\ \neq\ B_i $
- $ \left(A_i,\ B_i\right)\ \neq\ \left(A_j,\ B_j\right) $ ( $ i\ \neq\ j $ のとき)
- $ \left(A_i,\ B_i\right)\ \neq\ \left(B_j,\ A_j\right) $ ( $ i\ \neq\ j $ のとき)
- $ 1\ \leq\ C_i\ \leq\ 10^9 $
- $ 1\ <\ =\ Q\ <\ =\ N\left(N-1\right) $
- $ 1\ <\ =\ s_i,\ t_i\ <\ =\ N $
- $ s_i\ \neq\ t_i $
- $ \left(s_i,\ t_i\right)\ \neq\ \left(s_j,\ t_j\right) $ ( $ i\ \neq\ j $ のとき)

### Sample Explanation 1

町 $ 3 $ から町 $ 2 $ へ移動するときは、 $ 2 $ 本目の道を使えば、途中で燃料を補給することなく町 $ 2 $ へ到着することが出来ます。 町 $ 1 $ から町 $ 3 $ へ移動するときは、まず $ 1 $ 本目の道を使って町 $ 2 $ へ移動し、燃料をタンク一杯まで補給し、 $ 2 $ 本目の道を使うことにより、町 $ 3 $ へ到着することが出来ます。

### Sample Explanation 2

道が無いこともあります。

## 样例 #1

### 输入

```
3 2 5

1 2 3

2 3 3

2

3 2

1 3
```

### 输出

```
0

1
```

## 样例 #2

### 输入

```
4 0 1

1

2 1
```

### 输出

```
-1
```

## 样例 #3

### 输入

```
5 4 4

1 2 2

2 3 2

3 4 3

4 5 2

20

2 1

3 1

4 1

5 1

1 2

3 2

4 2

5 2

1 3

2 3

4 3

5 3

1 4

2 4

3 4

5 4

1 5

2 5

3 5

4 5
```

### 输出

```
0

0

1

2

0

0

1

2

0

0

0

1

1

1

0

0

2

2

1

0
```



---

---
title: "[ABC145E] All-you-can-eat"
layout: "post"
diff: 普及+/提高
pid: AT_abc145_e
tag: []
---

# [ABC145E] All-you-can-eat

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc145/tasks/abc145_e

高橋君は食べ放題のお店に来ました。

$ N $ 種類の料理があり、$ i $ 番目の料理は、食べるために $ A_i $ 分必要で、美味しさは $ B_i $ です。

この店のルールは以下の通りです。

- $ 1 $ 度に $ 1 $ つの料理のみを注文することができます。注文した料理は即座に提供され、食べ始めることができます。
- 同じ種類の料理を $ 2 $ 度以上注文することはできません。
- 提供済みの料理を食べ終わるまで次の料理を注文することはできません。
- 最初の注文から $ T-0.5 $ 分後以降に注文することはできませんが、提供済みの料理を食べることはできます。

高橋君の満足度を、この来店で高橋君が食べる料理の美味しさの合計とします。

高橋君が適切に行動したとき、満足度は最大でいくらになるでしょうか。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ T $ $ A_1 $ $ B_1 $ $ : $ $ A_N $ $ B_N $

## 输出格式

高橋君が適切に行動したときの、満足度の最大値を出力せよ。

## 说明/提示

### 制約

- $ 2\ \leq\ N\ \leq\ 3000 $
- $ 1\ \leq\ T\ \leq\ 3000 $
- $ 1\ \leq\ A_i\ \leq\ 3000 $
- $ 1\ \leq\ B_i\ \leq\ 3000 $
- 入力中のすべての値は整数である。

### Sample Explanation 1

$ 1 $ 番目、$ 2 $ 番目の順に料理を注文することで、満足度は $ 110 $ になります。 注文が時間内に間に合えば、食べるのにどれだけ時間がかかっても良いことに注意してください。

### Sample Explanation 2

$ 60 $ 分以内に全ての料理を食べることができます。

### Sample Explanation 3

$ 2 $ 番目、$ 3 $ 番目の順に料理に注文することで、満足度を $ 50 $ にできます。 どのような順に料理を注文しても、料理を $ 3 $ つ注文することはできません。

## 样例 #1

### 输入

```
2 60

10 10

100 100
```

### 输出

```
110
```

## 样例 #2

### 输入

```
3 60

10 10

10 20

10 30
```

### 输出

```
60
```

## 样例 #3

### 输入

```
3 60

30 10

30 20

30 30
```

### 输出

```
50
```

## 样例 #4

### 输入

```
10 100

15 23

20 18

13 17

24 12

18 29

19 27

23 21

18 20

27 15

22 25
```

### 输出

```
145
```



---

---
title: "[ABC146E] Rem of Sum is Num"
layout: "post"
diff: 普及+/提高
pid: AT_abc146_e
tag: []
---

# [ABC146E] Rem of Sum is Num

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc146/tasks/abc146_e

長さ $ N $ の正整数列 $ A_1,\ A_2,\ \ldots\ ,\ A_N $ と正の整数 $ K $ が与えられます。

$ A $ の空でない連続する部分列であって、要素の和を $ K $ で割った余りが要素の数と等しくなるものの数を求めてください。ただし、$ 2 $ つの部分列が列として同じでも、取り出す位置が異なるならば区別するものとします。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ K $ $ A_1 $ $ A_2 $ $ \cdots $ $ A_N $

## 输出格式

条件をみたす部分列の個数を出力してください。

## 说明/提示

### 制約

- 入力は全て整数である。
- $ 1\ \leq\ N\ \leq\ 2\times\ 10^5 $
- $ 1\ \leq\ K\ \leq\ 10^9 $
- $ 1\ \leq\ A_i\ \leq\ 10^9 $

### Sample Explanation 1

$ (1) $, $ (4,2) $, $ (1,4,2) $, $ (5) $ の $ 4 $ つが条件をみたす部分列です。

### Sample Explanation 2

$ (4,2) $ が $ 4 $ 回、$ (2,4) $ が $ 3 $ 回数えられています。

## 样例 #1

### 输入

```
5 4

1 4 2 3 5
```

### 输出

```
4
```

## 样例 #2

### 输入

```
8 4

4 2 4 2 4 2 4 2
```

### 输出

```
7
```

## 样例 #3

### 输入

```
10 7

14 15 92 65 35 89 79 32 38 46
```

### 输出

```
8
```



---

---
title: "[ABC146F] Sugoroku"
layout: "post"
diff: 普及+/提高
pid: AT_abc146_f
tag: []
---

# [ABC146F] Sugoroku

## 题目描述

ABC146F 双六


高桥君在玩双六棋，棋盘格由用$0$到$N$编号的共$N+1$个格子构成。每一回合，高桥君会扔一个点数$1$到$M$的骰子。如果高桥君当前在第$i$格，骰子扔出$k$点，高桥君就前进到第$i+k$格。 如果此时$i+k > N$，高桥君立刻输掉。另外，棋盘上还有若干个“GameOver格”，如果高桥停在这些格子，也立刻输掉游戏。

假设高桥君可以自由控制骰子的点数，那么他从$0$号格子出发，到达$N$号格子，最短需要多少回合？输出用最短回合到达$N$格时，每回合骰子的点数组成的序列；如果无法到达$N$号格子，输出-1。

## 输入格式

第1行，两个正整数$N,M$

第2行，一个长为$N+1$的字符串$S$。$S_i=0$表示第$i$格是一个普通格子；$S_i=1$表示第$i$格是一个GameOver格。

## 输出格式

输出用最短回合到达$N$格时，每回合骰子的点数组成的序列，若有多种序列回合数都是最短，输出其中字典序最小的。

如果无法到达$N$号格子，输出-1。

【输入样例\#1】

```
9 3
0001000100
```

【输出样例\#1】

```
1 3 2 3
```

## 说明/提示

按$1,3,2,3$的顺序扔出骰子的点数，高桥君会经过第$1,4,6$格最终到达第$9$格。

无法在$3$次以内到达第$9$格。$1,3,2,3$是所有$4$次到达第$9$格的点数序列中，字典序最小的。


$1 \le N \le 10^5$

$1 \le M \le 10^5$

$S$长度为$N+1$，只由字符'0'和'1'组成，保证$S_0=0$，$S_N=0$。

## 样例 #1

### 输入

```
9 3

0001000100
```

### 输出

```
1 3 2 3
```

## 样例 #2

### 输入

```
5 4

011110
```

### 输出

```
-1
```

## 样例 #3

### 输入

```
6 6

0101010
```

### 输出

```
6
```



---

---
title: "[ABC148F] Playing Tag on Tree"
layout: "post"
diff: 普及+/提高
pid: AT_abc148_f
tag: []
---

# [ABC148F] Playing Tag on Tree

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc148/tasks/abc148_f

$ N $ 頂点の木があります。$ i $ 番目の辺は頂点 $ A_i $ と $ B_i $ を双方向に結んでいます。

この木の頂点 $ u $ に高橋君が、頂点 $ v $ に青木君がいます。

$ 2 $ 人は次のような手順で鬼ごっこをします。

- $ 1 $. 高橋君と青木君が同じ頂点にいるときゲームを終了する。そうでないとき、高橋君は隣接する頂点を $ 1 $ つ選んでその頂点に移動する。
- $ 2 $. 高橋君と青木君が同じ頂点にいるときゲームを終了する。そうでないとき、青木君は隣接する頂点を $ 1 $ つ選んでその頂点に移動する。
- $ 3 $. $ 1 $ に戻る。

高橋君はできるだけ遅くゲームが終了するように移動し、青木君はできるだけ早くゲームが終了するように移動します。

高橋君と青木君が常に互いの位置と戦略を把握し最適に移動するとき、ゲームが終了するまでに青木君が移動する回数を求めてください。

なお、ゲームは必ず終了することが証明できます。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ u $ $ v $ $ A_1 $ $ B_1 $ $ : $ $ A_{N-1} $ $ B_{N-1} $

## 输出格式

ゲームが終了するまでに青木君が移動する回数を出力せよ。

## 说明/提示

### 制約

- $ 2\ \leq\ N\ \leq\ 10^5 $
- $ 1\ \leq\ u,v\ \leq\ N $
- $ u\ \neq\ v $
- $ 1\ \leq\ A_i,B_i\ \leq\ N $
- 与えられるグラフは木である

### Sample Explanation 1

互いに最適に移動した場合、ゲームは次のように進行します。 - 高橋君が頂点 $ 3 $ に移動 - 青木君が頂点 $ 2 $ に移動 - 高橋君が頂点 $ 5 $ に移動 - 青木君が頂点 $ 3 $ に移動 - 高橋君が頂点 $ 3 $ に移動 このとき、ゲームが終了するまでの青木君の移動回数は $ 2 $ 回です。 各手番で同じ頂点にとどまることは出来ないことに注意してください。

## 样例 #1

### 输入

```
5 4 1

1 2

2 3

3 4

3 5
```

### 输出

```
2
```

## 样例 #2

### 输入

```
5 4 5

1 2

1 3

1 4

1 5
```

### 输出

```
1
```

## 样例 #3

### 输入

```
2 1 2

1 2
```

### 输出

```
0
```

## 样例 #4

### 输入

```
9 6 1

1 2

2 3

3 4

4 5

5 6

4 7

7 8

8 9
```

### 输出

```
5
```



---

---
title: "[ABC149E] Handshake"
layout: "post"
diff: 普及+/提高
pid: AT_abc149_e
tag: []
---

# [ABC149E] Handshake

## 题目描述

Takahashi  作为特殊嘉宾参加一个晚会 , 晚会上还有 N 个非特殊嘉宾 , 第 i  个特殊嘉宾有 A_i  的欢乐值.晚会目前的欢乐值是 0 .  
 Takahashi  想跟非特殊嘉宾握 M  次手来提高晚会的欢乐值.每一次握手可以被描述为以下的操作:  
1.  Takahashi  选择两个非特殊嘉宾 x  和 y   
2.  Takahashi  用左手和 x  握手 , 用右手和 y  握手 , 晚会的欢乐值增加 A_x + A_y .    

然而 ,  Takahashi  不能以同一种握手方式握两次手.也就是说 ,  Takahashi  的 M  次握手必须满足以下条件:  
- 假设在第 k  次握手中 ,  Takashi  握了非特殊嘉宾 x_k  的左手和 y_k  的右手 , 则没有一组 p  ,  q  (  1 ≤ p < q ≤ M)  可以满足 (  x_p  ,  y_p  ) = (  x_q  ,  y_q  ) .  

请问:在 M  次握手后 , 晚会的欢乐值最大是多少 ?

## 输入格式

第一行: N  ,  M   
第二行: A_1  ,  A_2  , ··· ,  A_N

## 输出格式

一行 , 最大的欢乐值  


---
[翻译者的个人中心](https://www.luogu.com.cn/user/324250)  
[翻译者的博客](https://324250.blog.luogu.org)

## 样例 #1

### 输入

```
5 3

10 14 19 34 33
```

### 输出

```
202
```

## 样例 #2

### 输入

```
9 14

1 3 5 110 24 21 34 5 3
```

### 输出

```
1837
```

## 样例 #3

### 输入

```
9 73

67597 52981 5828 66249 75177 64141 40773 79105 16076
```

### 输出

```
8128170
```



---

---
title: "[ABC150D] Semi Common Multiple"
layout: "post"
diff: 普及+/提高
pid: AT_abc150_d
tag: []
---

# [ABC150D] Semi Common Multiple

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc150/tasks/abc150_d

長さ $ N $ の偶数からなる正の整数列 $ A=\ {a_1,a_2,...,a_N} $ と、整数 $ M $ が与えられます。

任意の $ k(1\ \leq\ k\ \leq\ N) $ に対して以下の条件を満たす正の整数 $ X $ を $ A $ の「半公倍数」と定義します。

- $ X=\ a_k\ \times\ (p+0.5) $ を満たす負でない整数 $ p $ が存在する。

$ 1 $ 以上 $ M $ 以下の整数のうちの $ A $ の半公倍数の個数を求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ M $ $ a_1 $ $ a_2 $ $ ... $ $ a_N $

## 输出格式

$ 1 $ 以上 $ M $ 以下の整数のうちの $ A $ の半公倍数の個数を出力せよ。

## 说明/提示

### 制約

- $ 1\ \leq\ N\ \leq\ 10^5 $
- $ 1\ \leq\ M\ \leq\ 10^9 $
- $ 2\ \leq\ a_i\ \leq\ 10^9 $
- $ a_i $ は偶数である。
- 入力は全て整数である。

### Sample Explanation 1

\- $ 15\ =\ 6\ \times\ 2.5 $ - $ 15\ =\ 10\ \times\ 1.5 $ - $ 45\ =\ 6\ \times\ 7.5 $ - $ 45\ =\ 10\ \times\ 4.5 $ より、$ 15,45 $ は $ A $ の半公倍数です。$ 1 $ 以上 $ 50 $ 以下の整数に他に $ A $ の半公倍数はないので、答えは $ 2 $ となります。

### Sample Explanation 2

答えが $ 0 $ の場合もあります。

## 样例 #1

### 输入

```
2 50

6 10
```

### 输出

```
2
```

## 样例 #2

### 输入

```
3 100

14 22 40
```

### 输出

```
0
```

## 样例 #3

### 输入

```
5 1000000000

6 6 2 6 2
```

### 输出

```
166666667
```



---

---
title: "[ABC152E] Flatten"
layout: "post"
diff: 普及+/提高
pid: AT_abc152_e
tag: []
---

# [ABC152E] Flatten

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc152/tasks/abc152_e

$ N $ 個の正整数 $ A_1,...,A_N $ が与えられます。

次の条件を満たすような正整数 $ B_1,...,B_N $ を考えます。

条件：$ 1\ \leq\ i\ <\ j\ \leq\ N $ を満たすどのような $ i,j $ についても $ A_i\ B_i\ =\ A_j\ B_j $ が成り立つ。

このような $ B_1,...,B_N $ における $ B_1\ +\ ...\ +\ B_N $ の最小値を求めてください。

ただし、答えは非常に大きくなる可能性があるため、$ (10^9\ +7) $ で割ったあまりを出力してください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ A_1 $ $ ... $ $ A_N $

## 输出格式

条件を満たすような $ B_1,...,B_N $ における $ B_1\ +\ ...\ +\ B_N $ の最小値を $ (10^9\ +7) $ で割ったあまりを出力せよ。

## 说明/提示

### 制約

- $ 1\ \leq\ N\ \leq\ 10^4 $
- $ 1\ \leq\ A_i\ \leq\ 10^6 $
- 入力中のすべての値は整数である。

### Sample Explanation 1

$ B_1=6 $, $ B_2=4 $, $ B_3=3 $ とすると条件を満たします。

### Sample Explanation 2

全ての $ B_i $ を $ 1 $ とすればよいです。

### Sample Explanation 3

和を $ (10^9+7) $ で割った余りを出力してください。

## 样例 #1

### 输入

```
3

2 3 4
```

### 输出

```
13
```

## 样例 #2

### 输入

```
5

12 12 12 12 12
```

### 输出

```
5
```

## 样例 #3

### 输入

```
3

1000000 999999 999998
```

### 输出

```
996989508
```



---

---
title: "[ABC155D] Pairs"
layout: "post"
diff: 普及+/提高
pid: AT_abc155_d
tag: []
---

# [ABC155D] Pairs

## 题目描述

$N$个数两两相乘的结果有 $\frac{N(N-1)}{2}$ 种，问第 $K$ 小的乘积是多少。

## 输入格式

第一行两个整数 $N,K$。  
第二行 $N$ 个整数 $A_i$，为那 $N$ 个要乘起来的数

## 输出格式

一行一个整数，第 $K$ 小的乘积

## 说明/提示

$N \leq 2 \times 10^5,-10^9 \leq A_i \leq 10^9$

## 样例 #1

### 输入

```
4 3

3 3 -4 -2
```

### 输出

```
-6
```

## 样例 #2

### 输入

```
10 40

5 4 3 2 -1 0 0 0 0 0
```

### 输出

```
6
```

## 样例 #3

### 输入

```
30 413

-170202098 -268409015 537203564 983211703 21608710 -443999067 -937727165 -97596546 -372334013 398994917 -972141167 798607104 -949068442 -959948616 37909651 0 886627544 -20098238 0 -948955241 0 -214720580 277222296 -18897162 834475626 0 -425610555 110117526 663621752 0
```

### 输出

```
448283280358331064
```



---

---
title: "[ABC155E] Payment"
layout: "post"
diff: 普及+/提高
pid: AT_abc155_e
tag: []
---

# [ABC155E] Payment

## 题目描述

给定正整数 $N$，设 $f(x)$ 表示 $x$ 在十进制下各个数位上的数的和，求一个正整数 $x$ 满足 $x\ge N$ 且最小化 $f(x)+f(x-N)$。

## 输入格式

一行一个正整数 $N$，含义如题所述。

## 输出格式

一行一个正整数 $ans$，表示最小的 $f(x)+f(x-N)$。

## 说明/提示

$1\le N\le10^{1000000}$。

## 样例 #1

### 输入

```
36
```

### 输出

```
8
```

## 样例 #2

### 输入

```
91
```

### 输出

```
3
```

## 样例 #3

### 输入

```
314159265358979323846264338327950288419716939937551058209749445923078164062862089986280348253421170
```

### 输出

```
243
```



---

---
title: "[ABC157E] Simple String Queries"
layout: "post"
diff: 普及+/提高
pid: AT_abc157_e
tag: []
---

# [ABC157E] Simple String Queries

## 题目描述

给定长度为n的原字符串与q次操作或询问。其格式如下:

①1 i c: 将第i位字符改为c(c也是字符)。

②2 l r: 询问区间[l,r]内不同字符的个数。



感谢ducati小蒟蒻的翻译

## 输入格式

第一行输入n，表示原字符串的长度。

第二行输入原字符串。

第三行输入q，表示询问或操作的次数。

## 样例 #1

### 输入

```
7

abcdbbd

6

2 3 6

1 5 z

2 1 1

1 4 a

1 7 d

2 1 7
```

### 输出

```
3

1

5
```



---

---
title: "[ABC159F] Knapsack for All Segments"
layout: "post"
diff: 普及+/提高
pid: AT_abc159_f
tag: []
---

# [ABC159F] Knapsack for All Segments

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc159/tasks/abc159_f

長さ $ N $ の整数列 $ A_1 $, $ A_2 $, $ \ldots $, $ A_N $ と正の整数 $ S $ が与えられます。  
 $ 1\leq\ L\ \leq\ R\ \leq\ N $ をみたす整数 $ (L,\ R) $ の組について、$ f(L,\ R) $ を以下のように定めます。

- $ L\ \leq\ x_1\ <\ x_2\ <\ \cdots\ <\ x_k\ \leq\ R $ かつ $ A_{x_1}+A_{x_2}+\cdots\ +A_{x_k}\ =\ S $ を満たすような整数列 $ (x_1,\ x_2,\ \ldots\ ,\ x_k) $ の個数

$ 1\leq\ L\ \leq\ R\leq\ N $ を満たす整数 $ (L,\ R) $ の組すべてに対する $ f(L,\ R) $ の和を求めてください。ただし、答えは非常に大きくなることがあるので、$ 998244353 $ で割ったあまりを出力してください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ S $ $ A_1 $ $ A_2 $ $ ... $ $ A_N $

## 输出格式

$ f(L,\ R) $ の和を $ 998244353 $ で割ったあまりを出力せよ。

## 说明/提示

### 制約

- 入力は全て整数である。
- $ 1\ \leq\ N\ \leq\ 3000 $
- $ 1\ \leq\ S\ \leq\ 3000 $
- $ 1\ \leq\ A_i\ \leq\ 3000 $

### Sample Explanation 1

それぞれ以下のように計算できて、その和は $ 5 $ です。 - $ f(1,1)\ =\ 0 $ - $ f(1,2)\ =\ 1 $ ($ (1,\ 2) $ の $ 1 $ つ) - $ f(1,3)\ =\ 2 $ ($ (1,\ 2) $ と $ (3) $ の $ 2 $ つ) - $ f(2,2)\ =\ 0 $ - $ f(2,3)\ =\ 1 $ ($ (3) $ の $ 1 $ つ) - $ f(3,3)\ =\ 1 $ ($ (3) $ の $ 1 $ つ)

## 样例 #1

### 输入

```
3 4

2 2 4
```

### 输出

```
5
```

## 样例 #2

### 输入

```
5 8

9 9 9 9 9
```

### 输出

```
0
```

## 样例 #3

### 输入

```
10 10

3 1 4 1 5 9 2 6 5 3
```

### 输出

```
152
```



---

---
title: "[ABC162E] Sum of gcd of Tuples (Hard)"
layout: "post"
diff: 普及+/提高
pid: AT_abc162_e
tag: []
---

# [ABC162E] Sum of gcd of Tuples (Hard)

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc162/tasks/abc162_e

$ 1 $ 以上 $ K $ 以下の整数からなる長さ $ N $ の数列 $ \{A_1,...,A_N\} $ を考えます。

そのようなものは $ K^N $ 個ありますが、その全てについての $ \gcd(A_1,...,A_N) $ の和を求めてください。

ただし、答えは非常に大きくなる可能性があるため、和を $ (10^9+7) $ で割ったあまりを出力してください。

なお、$ \gcd(A_1,...,A_N) $ は $ A_1,...,A_N $ の最大公約数を表します。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ K $

## 输出格式

$ K^N $ 個の数列全てについての $ \gcd(A_1,...,A_N) $ の和を $ (10^9+7) $ で割ったあまりを出力せよ。

## 说明/提示

### 制約

- $ 2\ \leq\ N\ \leq\ 10^5 $
- $ 1\ \leq\ K\ \leq\ 10^5 $
- 入力は全て整数

### Sample Explanation 1

$ \gcd(1,1,1)+\gcd(1,1,2)+\gcd(1,2,1)+\gcd(1,2,2) $ $ +\gcd(2,1,1)+\gcd(2,1,2)+\gcd(2,2,1)+\gcd(2,2,2) $ $ =1+1+1+1+1+1+1+2=9 $ となるため、答えは $ 9 $ です。

### Sample Explanation 3

和を $ 10^9+7 $ で割った余りを出力してください。

## 样例 #1

### 输入

```
3 2
```

### 输出

```
9
```

## 样例 #2

### 输入

```
3 200
```

### 输出

```
10813692
```

## 样例 #3

### 输入

```
100000 100000
```

### 输出

```
742202979
```



---

---
title: "[ABC165E] Rotation Matching"
layout: "post"
diff: 普及+/提高
pid: AT_abc165_e
tag: []
---

# [ABC165E] Rotation Matching

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc165/tasks/abc165_e

あなたは「AtCoderじゃんけん」という一対一のゲームの大会を主催することになりました。 大会の参加者は $ N $ 人で、それぞれには $ 1 $ から $ N $ の相異なる番号が割り振られています。 アリーナには二人が入ることのできる対戦場が $ M $ 個用意されており、あなたはそれぞれの対戦場に二つの相異なる $ 1 $ 以上 $ N $ 以下の整数を割り当てなければいけません。 複数の対戦場に同じ整数を割り当てることはできません。 大会は $ N $ ラウンドによって構成され、それぞれのラウンドは以下のようにして取り行われます。

- それぞれの参加者は、自分の番号が割り当てられた対戦場が存在するならそこに行き、そこに来たもう一方の相手と対戦する。
- その後、それぞれの参加者が、自分の番号に $ 1 $ を足す。もし $ 1 $ を足した後の番号が $ N+1 $ であるなら、その値を $ 1 $ に変更する。

$ N $ 回のラウンドを通じて、二回以上同じ参加者と対戦するような参加者が存在しないようにしたいです。 このような条件を満たす対戦場への整数の割り当てをひとつ出力してください。 ただし、与えられる制約のもとでそのような割り当てが必ず存在することが示せます。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ M $

## 输出格式

以下の形式で $ M $ 行に出力せよ。 $ i $ 行目には $ i $ 個目の対戦場に割り当てる二つの整数を出力せよ。

> $ a_1 $ $ b_1 $ $ a_2 $ $ b_2 $ $ : $ $ a_M $ $ b_M $

## 说明/提示

### 制約

- $ 1\ \leq\ M $
- $ M\ \times\ 2\ +1\ \leq\ N\ \leq\ 200000 $

### Sample Explanation 1

参加者 $ 4 $ 人を $ A,B,C,D $ とし、はじめ A には $ 1 $、Bには $ 2 $、Cには $ 3 $、Dには $ 4 $ が割り振られているとします。 - $ 1 $ 回目のラウンドでは $ 2 $ の割り振られた B と $ 3 $ の割り振られた C が対戦し、A の番号が $ 2 $ 、B の番号が $ 3 $、Cの番号が $ 4 $、D の番号が $ 1 $となります。 - $ 2 $ 回目のラウンドでは $ 2 $ の割り振られた A と $ 3 $ の割り振られた B が対戦し、A の番号が $ 3 $ 、B の番号が $ 4 $、C の番号が $ 1 $、D の番号が $ 2 $ となります。 - $ 3 $ 回目のラウンドでは $ 2 $ の割り振られた D と $ 3 $ の割り振られた A が対戦し、A の番号が $ 4 $ 、B の番号が $ 1 $、C の番号が $ 2 $、D の番号が $ 3 $ となります。 - $ 4 $ 回目のラウンドでは $ 2 $ の割り振られた C と $ 3 $ の割り振られた D が対戦し、A の番号が $ 1 $ 、B の番号が $ 2 $、C の番号が $ 3 $、D の番号が $ 4 $ となります。 $ 4 $ 回のラウンドを通じて二回以上同じ参加者と対戦するような参加者が存在しないため、この出力は正解となります。

## 样例 #1

### 输入

```
4 1
```

### 输出

```
2 3
```

## 样例 #2

### 输入

```
7 3
```

### 输出

```
1 6

2 5

3 4
```



---

---
title: "[ABC166F] Three Variables Game"
layout: "post"
diff: 普及+/提高
pid: AT_abc166_f
tag: []
---

# [ABC166F] Three Variables Game

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc166/tasks/abc166_f

あるゲームでは $ 3 $ つの変数があり、それぞれ $ A,B,C $ で表されます。

ゲームの進行と共に、あなたは $ N $ 回の選択に迫られます。 それぞれの選択は文字列 $ s_i $ によって示され、 $ s_i $ が `AB` のとき、$ A $ と $ B $ のどちらかに $ 1 $ を足しもう一方から $ 1 $ を引くこと、 `AC` のとき、$ A $ と $ C $ のどちらかに $ 1 $ を足しもう一方から $ 1 $ を引くこと、 `BC` のとき、$ B $ と $ C $ のどちらかに $ 1 $ を足しもう一方から $ 1 $ を引くことを意味します。

いずれの選択の後にも、$ A,B,C $ のいずれも負の値になってはいけません。

この条件を満たしつつ $ N $ 回すべての選択を終えることが可能であるか判定し、可能であるならそのような選択方法をひとつ示してください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ A $ $ B $ $ C $ $ s_1 $ $ s_2 $ $ : $ $ s_N $

## 输出格式

条件を満たしつつ $ N $ 個すべての選択を終えることが可能である場合は `Yes` を、そうでない場合は `No` を出力せよ。

加えて、前者の場合は続く $ N $ 行に選択方法を示せ。$ i+1 $ 行目には $ i $ 回目の選択で $ 1 $ を足す変数の名前 (`A`, `B`, `C` のいずれか) を出力せよ。

## 说明/提示

### 制約

- $ 1\ \leq\ N\ \leq\ 10^5 $
- $ 0\ \leq\ A,B,C\ \leq\ 10^9 $
- $ N,\ A,\ B,\ C $ は整数である。
- $ s_i $ は `AB`, `AC`, `BC` のいずれか

### Sample Explanation 1

次のようにすることで $ 2 $ 回すべての選択を終えることができます。 - $ 1 $ 回目の選択では、$ A $ に $ 1 $ を足し $ B $ から $ 1 $ を引く。$ A $ の値が $ 2 $ に、$ B $ の値が $ 2 $ に変化する。 - $ 2 $ 回目の選択では、$ C $ に $ 1 $ を足し $ A $ から $ 1 $ を引く。$ C $ の値が $ 1 $ に、$ A $ の値が $ 1 $ に変化する。

## 样例 #1

### 输入

```
2 1 3 0

AB

AC
```

### 输出

```
Yes

A

C
```

## 样例 #2

### 输入

```
3 1 0 0

AB

BC

AB
```

### 输出

```
No
```

## 样例 #3

### 输入

```
1 0 9 0

AC
```

### 输出

```
No
```

## 样例 #4

### 输入

```
8 6 9 1

AC

BC

AB

BC

AC

BC

AB

AB
```

### 输出

```
Yes

C

B

B

C

C

B

A

A
```



---

---
title: "[ABC167E] Colorful Blocks"
layout: "post"
diff: 普及+/提高
pid: AT_abc167_e
tag: []
---

# [ABC167E] Colorful Blocks

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc167/tasks/abc167_e

$ N $ 個のブロックが横一列に並んでいます。このブロック列に色を塗ります。

$ 2 $ つのブロック列の塗り方が異なるとは、あるブロックが存在して、そのブロックが異なる色で塗られていることと定義します。

次の条件を満たすブロック列の塗り方が何通りあるか求めてください。

- 各ブロックを色 $ 1 $ から色 $ M $ までのいずれか一色で塗る。使わない色があってもよい。
- 隣り合うブロックの組であって同じ色で塗られている組は、 $ K $ 組以下である。

ただし、答えは非常に大きくなる場合があるので、 $ 998244353 $ で割った余りを出力してください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ M $ $ K $

## 输出格式

答えを出力せよ。

## 说明/提示

### 制約

- 入力は全て整数
- $ 1\ \leq\ N,\ M\ \leq\ 2\ \times\ 10^5 $
- $ 0\ \leq\ K\ \leq\ N\ -\ 1 $

### Sample Explanation 1

ブロック列の塗り方を色を書き並べた文字列で表すと、条件を満たすブロック列の色の塗り方は、`112` , `121`, `122`, `211`, `212`, `221` です。

## 样例 #1

### 输入

```
3 2 1
```

### 输出

```
6
```

## 样例 #2

### 输入

```
100 100 0
```

### 输出

```
73074801
```

## 样例 #3

### 输入

```
60522 114575 7559
```

### 输出

```
479519525
```



---

---
title: "[ABC168E] ∙ (Bullet)"
layout: "post"
diff: 普及+/提高
pid: AT_abc168_e
tag: []
---

# [ABC168E] ∙ (Bullet)

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc168/tasks/abc168_e

$ N $ 匹のイワシが釣れました。$ i $ 匹目のイワシの美味しさは $ A_i $、香り高さは $ B_i $ です。

この中から $ 1 $ 匹以上のイワシを選んで同じクーラーボックスに入れますが、互いに仲が悪い $ 2 $ 匹を同時に選ぶことはできません。

$ i $ 匹目と $ j\ (\neq\ i) $ 匹目のイワシは、$ A_i\ \cdot\ A_j\ +\ B_i\ \cdot\ B_j\ =\ 0 $ を満たすとき(また、その時に限り)仲が悪いです。

イワシの選び方は何通りあるでしょう？答えは非常に大きくなる可能性があるので、$ 1000000007 $ で割ったあまりを出力してください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ A_1 $ $ B_1 $ $ : $ $ A_N $ $ B_N $

## 输出格式

答えを $ 1000000007 $ で割ったあまりを出力せよ。

## 说明/提示

### 制約

- 入力はすべて整数
- $ 1\ \leq\ N\ \leq\ 2\ \times\ 10^5 $
- $ -10^{18}\ \leq\ A_i,\ B_i\ \leq\ 10^{18} $

### Sample Explanation 1

条件を満たす選び方は以下の $ 5 $ 通りです。 - $ 1 $ 匹目 - $ 1,\ 2 $ 匹目 - $ 2 $ 匹目 - $ 2,\ 3 $ 匹目 - $ 3 $ 匹目

## 样例 #1

### 输入

```
3

1 2

-1 1

2 -1
```

### 输出

```
5
```

## 样例 #2

### 输入

```
10

3 2

3 2

-1 1

2 -1

-3 -9

-8 12

7 7

8 1

8 2

8 4
```

### 输出

```
479
```



---

---
title: "[ABC169E] Count Median"
layout: "post"
diff: 普及+/提高
pid: AT_abc169_e
tag: []
---

# [ABC169E] Count Median

## 题目描述

有 $N$ 个整数 $X_1, X_2, X_3,\cdots,X_N $，满足 $A_i \le X_i \le B_i$。

求 $X_1，X_2,\cdots,X_N$ 的中位数可能的不同值的数量。

## 输入格式

第一行，一个整数 $N$。  
接下来 $N$ 行，每行两个整数 $A_i$，$B_i$。

## 输出格式

一行一个整数，代表可能的不同中位数取值。

Translated by @[immccn123](https://www.luogu.com.cn/user/385633).

## 样例 #1

### 输入

```
2

1 2

2 3
```

### 输出

```
3
```

## 样例 #2

### 输入

```
3

100 100

10 10000

1 1000000000
```

### 输出

```
9991
```



---

---
title: "[ABC169F] Knapsack for All Subsets"
layout: "post"
diff: 普及+/提高
pid: AT_abc169_f
tag: []
---

# [ABC169F] Knapsack for All Subsets

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc169/tasks/abc169_f

長さ $ N $ の正整数列 $ A_1 $, $ A_2 $, $ \ldots $, $ A_N $ と正の整数 $ S $ が与えられます。  
 集合$ \{1,\ 2,\ \ldots\ ,\ N\ \} $ の空でない部分集合 $ T $ について、$ f(T) $ を以下のように定めます。

- $ T $ の空でない部分集合 $ \{x_1,\ x_2,\ \ldots\ ,\ x_k\ \} $ であって、 $ A_{x_1}+A_{x_2}+\cdots\ +A_{x_k}\ =\ S $ をみたすものの個数

$ T $ として考えられる集合は $ 2^N-1 $ 通りありますが、そのすべてに対する $ f(T) $ の和を求めてください。ただし、答えは非常に大きくなることがあるので、$ 998244353 $ で割ったあまりを出力してください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ S $ $ A_1 $ $ A_2 $ $ ... $ $ A_N $

## 输出格式

$ f(T) $ の和を $ 998244353 $ で割ったあまりを出力せよ。

## 说明/提示

### 制約

- 入力は全て整数である。
- $ 1\ \leq\ N\ \leq\ 3000 $
- $ 1\ \leq\ S\ \leq\ 3000 $
- $ 1\ \leq\ A_i\ \leq\ 3000 $

### Sample Explanation 1

それぞれ以下のように計算できて、その和は $ 6 $ です。 - $ f(\{1\})\ =\ 0 $ - $ f(\{2\})\ =\ 0 $ - $ f(\{3\})\ =\ 1 $ ( $ \{3\} $ の $ 1 $ つ) - $ f(\{1,\ 2\})\ =\ 1 $ ( $ \{1,\ 2\} $ の $ 1 $ つ) - $ f(\{2,\ 3\})\ =\ 1 $ ( $ \{3\} $ の $ 1 $ つ) - $ f(\{1,\ 3\})\ =\ 1 $ ( $ \{3\} $ の $ 1 $ つ) - $ f(\{1,\ 2,\ 3\})\ =\ 2 $ ( $ \{1,\ 2\},\ \{3\} $ の $ 2 $ つ)

## 样例 #1

### 输入

```
3 4

2 2 4
```

### 输出

```
6
```

## 样例 #2

### 输入

```
5 8

9 9 9 9 9
```

### 输出

```
0
```

## 样例 #3

### 输入

```
10 10

3 1 4 1 5 9 2 6 5 3
```

### 输出

```
3296
```



---

---
title: "[ABC170E] Smart Infants"
layout: "post"
diff: 普及+/提高
pid: AT_abc170_e
tag: []
---

# [ABC170E] Smart Infants

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc170/tasks/abc170_e

AtCoder に参加している幼児が $ N $ 人おり、$ 1 $ から $ N $ の番号が付けられています。また、幼稚園が $ 2\times\ 10^5 $ 校あり、$ 1 $ から $ 2\times\ 10^5 $ の番号が付けられています。 幼児 $ i $ のレートは $ A_i $ であり、はじめ幼稚園 $ B_i $ に所属しています。

これから $ Q $ 回にわたって、転園が行われます。 $ j $ 回目の転園では、幼児 $ C_j $ の所属を幼稚園 $ D_j $ に変更します。

ここで、「平等さ」を、AtCoderに参加している幼児が一人以上いるような幼稚園それぞれについて園内で最もレートの高い幼児のレートを求め、その最小値として得られる値とします。

$ Q $ 回それぞれの転園後の平等さを求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ Q $ $ A_1 $ $ B_1 $ $ A_2 $ $ B_2 $ $ : $ $ A_N $ $ B_N $ $ C_1 $ $ D_1 $ $ C_2 $ $ D_2 $ $ : $ $ C_Q $ $ D_Q $

## 输出格式

$ Q $ 行出力せよ。 $ j $ 行目には、$ j $ 回目の転園の後の平等さを出力せよ。

## 说明/提示

### 制約

- $ 1\ \leq\ N,Q\ \leq\ 2\ \times\ 10^5 $
- $ 1\ \leq\ A_i\ \leq\ 10^9 $
- $ 1\ \leq\ C_j\ \leq\ N $
- $ 1\ \leq\ B_i,D_j\ \leq\ 2\ \times\ 10^5 $
- 入力はすべて整数である。
- $ j $ 回目の転園の前後で幼児 $ C_j $ の所属は異なる。

### Sample Explanation 1

はじめ、幼稚園 $ 1 $ には幼児 $ 1,\ 4 $、幼稚園 $ 2 $ には幼児 $ 2,\ 5 $、幼稚園 $ 3 $ には幼児 $ 3,\ 6 $ が所属しています。 $ 1 $ 回目の転園で幼児 $ 4 $ の所属を幼稚園 $ 3 $ に変更すると、幼稚園 $ 1 $ には幼児 $ 1 $、幼稚園 $ 2 $ には幼児 $ 2,\ 5 $、幼稚園 $ 3 $ には幼児 $ 3,\ 4,\ 6 $ が所属している状態になります。幼稚園 $ 1 $ で最もレートの高い幼児のレートは $ 8 $、幼稚園 $ 2 $ では $ 6 $、幼稚園 $ 3 $ では $ 9 $ です。これらの最小値は $ 6 $ であるので、$ 1 $ 行目には $ 6 $ を出力します。 $ 2 $ 回目の転園で $ 2 $ 番目の幼児の所属を幼稚園 $ 1 $ に変更すると、幼稚園 $ 1 $ には幼児 $ 1,\ 2 $、幼稚園 $ 2 $ には幼児 $ 5 $、幼稚園 $ 3 $ には幼児 $ 3,\ 4,\ 6 $ が所属している状態になります。幼稚園 $ 1 $ で最もレートの高い幼児のレートは $ 8 $、幼稚園 $ 2 $ では $ 2 $、幼稚園 $ 3 $ では $ 9 $ です。これらの最小値は $ 2 $ であるので、$ 2 $ 行目には $ 2 $ を出力します。 $ 3 $ 回目の転園で $ 1 $ 番目の幼児の所属を幼稚園 $ 2 $ に変更すると、幼稚園 $ 1 $ には幼児 $ 2 $、幼稚園 $ 2 $ には幼児 $ 1,\ 5 $、幼稚園 $ 3 $ には幼児 $ 3,\ 4,\ 6 $ が所属している状態になります。幼稚園 $ 1 $ で最もレートの高い幼児のレートは $ 6 $、幼稚園 $ 2 $ では $ 8 $、幼稚園 $ 3 $ では $ 9 $ です。これらの最小値は $ 6 $ であるので、$ 3 $ 行目には $ 6 $ を出力します。

## 样例 #1

### 输入

```
6 3

8 1

6 2

9 3

1 1

2 2

1 3

4 3

2 1

1 2
```

### 输出

```
6

2

6
```

## 样例 #2

### 输入

```
2 2

4208 1234

3056 5678

1 2020

2 2020
```

### 输出

```
3056

4208
```



---

---
title: "[ABC171F] Strivore"
layout: "post"
diff: 普及+/提高
pid: AT_abc171_f
tag: []
---

# [ABC171F] Strivore

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc171/tasks/abc171_f

「好きな英小文字 $ 1 $ 文字を好きな位置に挿入する」という操作を文字列 $ S $ にちょうど $ K $ 回繰り返してできる文字列は何通りあるでしょう？

答えは非常に大きくなる可能性があるので、$ (10^9+7) $ で割ったあまりを出力してください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ K $ $ S $

## 输出格式

条件を満たす文字列の個数を $ (10^9+7) $ で割ったあまりを出力せよ。

## 说明/提示

### 制約

- $ K $ は $ 1 $ 以上 $ 10^6 $ 以下の整数
- $ S $ は英小文字からなる長さ $ 1 $ 以上 $ 10^6 $ 以下の文字列

### Sample Explanation 1

たとえば、`proofend`、`moonwolf`、`onionpuf` などが条件を満たします。 それに対し、`oofsix`、`oofelevennn`、`voxafolt`、`fooooooo` などは条件を満たしません。

## 样例 #1

### 输入

```
5

oof
```

### 输出

```
575111451
```

## 样例 #2

### 输入

```
37564

whydidyoudesertme
```

### 输出

```
318008117
```



---

---
title: "[ABC172E] NEQ"
layout: "post"
diff: 普及+/提高
pid: AT_abc172_e
tag: []
---

# [ABC172E] NEQ

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc172/tasks/abc172_e

$ 1 $ 以上 $ M $ 以下の整数からなる長さ $ N $ の数列 $ A_1,A_2,\cdots,\ A_{N} $ と $ B_1,B_2,\cdots,\ B_{N} $ の組であって、以下の条件をすべて満たすものの個数を求めてください。

- $ 1\leq\ i\leq\ N $ なる任意の $ i $ について $ A_i\ \neq\ B_i $
- $ 1\leq\ i\ <\ j\leq\ N $ なる任意の $ (i,j) $ について $ A_i\ \neq\ A_j $ かつ $ B_i\ \neq\ B_j $

ただし、答えは非常に大きくなる可能性があるので、$ (10^9+7) $ で割ったあまりを出力してください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ M $

## 输出格式

答えを $ (10^9+7) $ で割ったあまりを出力せよ。

## 说明/提示

### 制約

- $ 1\leq\ N\ \leq\ M\ \leq\ 5\times10^5 $
- 入力はすべて整数

### Sample Explanation 1

$ A_1=1,A_2=2,B_1=2,B_2=1 $ のときと $ A_1=2,A_2=1,B_1=1,B_2=2 $ のとき条件が満たされます。

## 样例 #1

### 输入

```
2 2
```

### 输出

```
2
```

## 样例 #2

### 输入

```
2 3
```

### 输出

```
18
```

## 样例 #3

### 输入

```
141421 356237
```

### 输出

```
881613484
```



---

---
title: "[ABC173E] Multiplication 4"
layout: "post"
diff: 普及+/提高
pid: AT_abc173_e
tag: []
---

# [ABC173E] Multiplication 4

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc173/tasks/abc173_e

$ N $ 個の整数 $ A_1,\ldots,A_N $ が与えられます。

このなかからちょうど $ K $ 個の要素を選ぶとき、選んだ要素の積としてありえる最大値を求めてください。

そして、答えを $ (10^9+7) $ で割った余りを $ 0 $ 以上 $ 10^9+6 $ 以下の整数として出力してください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ K $ $ A_1 $ $ \ldots $ $ A_N $

## 输出格式

答えを $ (10^9+7) $ で割った余りを、$ 0 $ 以上 $ 10^9+6 $ 以下の整数として出力せよ。

## 说明/提示

### 制約

- $ 1\ \leq\ K\ \leq\ N\ \leq\ 2\times\ 10^5 $
- $ |A_i|\ \leq\ 10^9 $

### Sample Explanation 1

要素を $ 2 $ 個選んだときの積としてありえる値は $ 2,-3,-4,-6,-8,12 $ なので、最大値は $ 12 $ です。

### Sample Explanation 2

要素を $ 3 $ 個選んだときの積としてありえる値は $ -24,-12,-8,-6 $ なので、最大値は $ -6 $ です。 これを $ (10^9+7) $ で割った余りである $ 1000000001 $ を出力します。

### Sample Explanation 3

要素を $ 1 $ 個選んだときの積としてありえる値は $ -1,1000000000 $ なので、最大値は $ 1000000000 $ です。

### Sample Explanation 4

答えを $ (10^9+7) $ で割った余りを出力してください。

## 样例 #1

### 输入

```
4 2

1 2 -3 -4
```

### 输出

```
12
```

## 样例 #2

### 输入

```
4 3

-1 -2 -3 -4
```

### 输出

```
1000000001
```

## 样例 #3

### 输入

```
2 1

-1 1000000000
```

### 输出

```
1000000000
```

## 样例 #4

### 输入

```
10 10

1000000000 100000000 10000000 1000000 100000 10000 1000 100 10 1
```

### 输出

```
999983200
```



---

---
title: "[ABC173F] Intervals on Tree"
layout: "post"
diff: 普及+/提高
pid: AT_abc173_f
tag: []
---

# [ABC173F] Intervals on Tree

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc173/tasks/abc173_f

$ N $ 頂点 $ N-1 $ 辺から成る木があり、頂点には $ 1,\ 2,\cdots,\ N $ の番号が、辺には $ 1,\ 2,\ \cdots,\ N-1 $ の番号がついています。辺 $ i $ は頂点 $ u_i,\ v_i $ を繋いでいます。

整数 $ 1\ \leq\ L\ \leq\ R\ \leq\ N $ に対して関数 $ f(L,\ R) $ を次のように定義します。

- $ S $ を番号が $ L $ 以上 $ R $ 以下の頂点から成る集合とする。頂点集合 $ S $ と、両端が $ S $ に属する辺のみから成るような部分グラフの連結成分の個数を $ f(L,\ R) $ で表す。

$ \sum_{L=1}^{N}\ \sum_{R=L}^{N}\ f(L,\ R) $ を計算してください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ u_1 $ $ v_1 $ $ u_2 $ $ v_2 $ $ : $ $ u_{N-1} $ $ v_{N-1} $

## 输出格式

$ \sum_{L=1}^{N}\ \sum_{R=L}^{N}\ f(L,\ R) $ を出力せよ。

## 说明/提示

### 制約

- $ 1\ \leq\ N\ \leq\ 2\ \times\ 10^5 $
- $ 1\ \leq\ u_i,\ v_i\ \leq\ N $
- 与えられるグラフは木である
- 入力は全て整数である

### Sample Explanation 1

考えられる $ L,\ R $ の組み合わせは以下の $ 6 $ 通りがあります。 - $ L\ =\ 1,\ R\ =\ 1 $ のとき、$ S\ =\ \{1\} $ であり、連結成分の個数は $ 1 $ です。 - $ L\ =\ 1,\ R\ =\ 2 $ のとき、$ S\ =\ \{1,\ 2\} $ であり、連結成分の個数は $ 2 $ です。 - $ L\ =\ 1,\ R\ =\ 3 $ のとき、$ S\ =\ \{1,\ 2,\ 3\} $ であり、辺 $ 1,\ 2 $ は両端が $ S $ に含まれるので、連結成分の個数は $ 1 $ です。 - $ L\ =\ 2,\ R\ =\ 2 $ のとき、$ S\ =\ \{2\} $ であり、連結成分の個数は $ 1 $ です。 - $ L\ =\ 2,\ R\ =\ 3 $ のとき、$ S\ =\ \{2,\ 3\} $ であり、辺 $ 2 $ は両端が $ S $ に含まれるので、連結成分の個数は $ 1 $ です。 - $ L\ =\ 3,\ R\ =\ 3 $ のとき、$ S\ =\ \{3\} $ であり、連結成分の個数は $ 1 $ です。 これらの和は $ 7 $ です。

## 样例 #1

### 输入

```
3

1 3

2 3
```

### 输出

```
7
```

## 样例 #2

### 输入

```
2

1 2
```

### 输出

```
3
```

## 样例 #3

### 输入

```
10

5 3

5 7

8 9

1 9

9 10

8 4

7 4

6 10

7 2
```

### 输出

```
113
```



---

---
title: "[ABC175D] Moving Piece"
layout: "post"
diff: 普及+/提高
pid: AT_abc175_d
tag: []
---

# [ABC175D] Moving Piece

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc175/tasks/abc175_d

高橋君は $ 1,\ 2,\ \cdots,\ N $ の番号のついた $ N $ マスから成るマス目の上で、コマを使ってゲームを行おうとしています。マス $ i $ には整数 $ C_i $ が書かれています。また、$ 1,\ 2\ …,\ N $ の順列 $ P_1,\ P_2,\ \cdots,\ P_N $ が与えられています。

これから高橋君は好きなマスを $ 1 $ つ選んでコマを $ 1 $ つ置き、$ 1 $ 回以上 $ K $ 回以下の好きな回数だけ、次のような方法でコマを移動させます。

- $ 1 $ 回の移動では、現在コマがマス $ i\ (1\ \leq\ i\ \leq\ N) $ にあるなら、コマをマス $ P_i $ に移動させる。このとき、スコアに $ C_{P_i} $ が加算される。

高橋君のために、ゲーム終了時のスコアとしてあり得る値の最大値を求めてください。(ゲーム開始時のスコアは $ 0 $ です。)

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ K $ $ P_1 $ $ P_2 $ $ \cdots $ $ P_N $ $ C_1 $ $ C_2 $ $ \cdots $ $ C_N $

## 输出格式

ゲーム終了時のスコアとしてあり得る値の最大値を出力せよ。

## 说明/提示

### 制約

- $ 2\ \leq\ N\ \leq\ 5000 $
- $ 1\ \leq\ K\ \leq\ 10^9 $
- $ 1\ \leq\ P_i\ \leq\ N $
- $ P_i\ \neq\ i $
- $ P_1,\ P_2,\ \cdots,\ P_N $ は全て異なる
- $ -10^9\ \leq\ C_i\ \leq\ 10^9 $
- 入力は全て整数である

### Sample Explanation 1

好きなマスから始めて $ 2 $ 回以下コマを移動させる方法は以下の通りです。 - 初めマス $ 1 $ にコマを置く場合。$ 1 $ 回移動するとマス $ 2 $ に動き、スコアが $ 4 $ になる。$ 2 $ 回移動するとマス $ 4 $ に動き、スコアが $ 4\ +\ (-8)\ =\ -4 $ になる。 - 初めマス $ 2 $ にコマを置く場合。$ 1 $ 回移動するとマス $ 4 $ に動き、スコアが $ -8 $ になる。$ 2 $ 回移動するとマス $ 1 $ に動き、スコアが $ -8\ +\ 3\ =\ -5 $ になる。 - 初めマス $ 3 $ にコマを置く場合。$ 1 $ 回移動するとマス $ 5 $ に動き、スコアが $ 8 $ になる。$ 2 $ 回移動するとマス $ 3 $ に動き、スコアが $ 8\ +\ (-10)\ =\ -2 $ になる。 - 初めマス $ 4 $ にコマを置く場合。$ 1 $ 回移動するとマス $ 1 $ に動き、スコアが $ 3 $ になる。$ 2 $ 回移動するとマス $ 2 $ に動き、スコアが $ 3\ +\ 4\ =\ 7 $ になる。 - 初めマス $ 5 $ にコマを置く場合。$ 1 $ 回移動するとマス $ 3 $ に動き、スコアが $ -10 $ になる。$ 2 $ 回移動するとマス $ 5 $ に動き、スコアが $ -10\ +\ 8\ =\ -2 $ になる。 これらの最大値は $ 8 $ です。

### Sample Explanation 3

最低 $ 1 $ 回はコマを移動させる必要があります。

### Sample Explanation 4

答えの絶対値は非常に大きくなる場合があります。

## 样例 #1

### 输入

```
5 2

2 4 5 1 3

3 4 -10 -8 8
```

### 输出

```
8
```

## 样例 #2

### 输入

```
2 3

2 1

10 -7
```

### 输出

```
13
```

## 样例 #3

### 输入

```
3 3

3 1 2

-1000 -2000 -3000
```

### 输出

```
-1000
```

## 样例 #4

### 输入

```
10 58

9 1 6 7 8 4 3 2 10 5

695279662 988782657 -119067776 382975538 -151885171 -177220596 -169777795 37619092 389386780 980092719
```

### 输出

```
29507023469
```



---

---
title: "[ABC175E] Picking Goods"
layout: "post"
diff: 普及+/提高
pid: AT_abc175_e
tag: []
---

# [ABC175E] Picking Goods

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc175/tasks/abc175_e

$ R $ 行 $ C $ 列に並んだマス目に $ K $ 個のアイテムが置いてあります。$ 1\ \leq\ i\ \leq\ R $ 行目、 $ 1\ \leq\ j\ \leq\ C $ 列目のマスを $ (i,\ j) $ と表すとき、$ i $ 番目のアイテムはマス $ (r_i,\ c_i) $ に存在し、その価値は $ v_i $ です。

高橋君はマス $ (1,\ 1) $ からスタートしてゴールのマス $ (R,\ C) $ まで移動します。高橋君はマス $ (i,\ j) $ にいるとき、次には (存在すれば) マス $ (i\ +\ 1,\ j) $ またはマス $ (i,\ j\ +\ 1) $ に移動することができます。

高橋君は通ったマス (スタートとゴールも含む) のアイテムを拾うことができます。ただし、マス目の同じ行では $ 3 $ 個までしかアイテムを拾うことができません。通ったマスにアイテムがある場合に、そのアイテムを拾わないことはできます。

高橋君が拾うことのできるアイテムの価値の合計としてありうる値の最大値を求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ R $ $ C $ $ K $ $ r_1 $ $ c_1 $ $ v_1 $ $ r_2 $ $ c_2 $ $ v_2 $ $ : $ $ r_K $ $ c_K $ $ v_K $

## 输出格式

高橋君が拾うことのできるアイテムの価値の合計としてありうる値の最大値を出力せよ。

## 说明/提示

### 制約

- $ 1\ \leq\ R,\ C\ \leq\ 3000 $
- $ 1\ \leq\ K\ \leq\ \min(2\ \times\ 10^5,\ R\ \times\ C) $
- $ 1\ \leq\ r_i\ \leq\ R $
- $ 1\ \leq\ c_i\ \leq\ C $
- $ (r_i,\ c_i)\ \neq\ (r_j,\ c_j)\ (i\ \neq\ j) $
- $ 1\ \leq\ v_i\ \leq\ 10^9 $
- 入力は全て整数である

### Sample Explanation 1

移動の方法は以下の $ 2 $ 通りあります。 - マス $ (1,\ 1) $ 、マス $ (1,\ 2) $、マス $ (2,\ 2) $ の順に移動する。このとき拾うことのできるアイテムの価値の合計は $ 3\ +\ 5\ =\ 8 $ である。 - マス $ (1,\ 1) $ 、マス $ (2,\ 1) $、マス $ (2,\ 2) $ の順に移動する。このとき拾うことのできるアイテムの価値の合計は $ 3\ +\ 4\ =\ 7 $ である。 よって、高橋君が拾うことのできるアイテムの価値の合計としてありうる値の最大値は $ 8 $ です。

### Sample Explanation 2

$ 1 $ 行目にアイテムが $ 4 $ 個あります。次のように移動してアイテムを拾う方法が最適です。 - マス $ (1,\ 1) $ 、マス $ (1,\ 2) $、マス $ (1,\ 3) $、マス $ (1,\ 4) $ 、マス $ (2,\ 4) $、マス $ (2,\ 5) $ の順に移動する。このうちマス $ (1,\ 2) $ にあるアイテムのみ拾わないことにすると、アイテムの価値の合計は $ 3\ +\ 4\ +\ 2\ +\ 20\ =\ 29 $ である。

## 样例 #1

### 输入

```
2 2 3

1 1 3

2 1 4

1 2 5
```

### 输出

```
8
```

## 样例 #2

### 输入

```
2 5 5

1 1 3

2 4 20

1 2 1

1 3 4

1 4 2
```

### 输出

```
29
```

## 样例 #3

### 输入

```
4 5 10

2 5 12

1 5 12

2 3 15

1 2 20

1 1 28

2 4 26

3 2 27

4 5 21

3 5 10

1 3 10
```

### 输出

```
142
```



---

---
title: "[ABC178F] Contrast"
layout: "post"
diff: 普及+/提高
pid: AT_abc178_f
tag: []
---

# [ABC178F] Contrast

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc178/tasks/abc178_f

長さ $ N $ の数列 $ A $ と $ B $ が与えられます。 $ A,B $ はそれぞれ昇順にソートされています。 $ B $ を好きに並べ替えてすべての $ i(1\ \leq\ i\ \leq\ N) $ について $ A_i\ \neq\ B_i $ を満たすようにできるか判定し、できるならそのような $ B $ の並べ替え方を一つ示してください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ A_1 $ $ A_2 $ $ \cdots $ $ A_N $ $ B_1 $ $ B_2 $ $ \cdots $ $ B_N $

## 输出格式

条件を満たす並べ替え方が存在しない場合 `No` と出力せよ。

条件を満たす並べ替え方が存在する場合、一行目に `Yes` を出力し、二行目に並べ替え方を出力せよ。 二行目には並び替えた後の $ B $ を空白区切りで出力せよ。

条件を満たす並べ替え方が複数存在する場合、そのうちどれを出力しても構わない。

## 说明/提示

### 制約

- $ 1\leq\ N\ \leq\ 2\ \times\ 10^5 $
- $ 1\leq\ A_i,B_i\ \leq\ N $
- $ A,B $ はそれぞれ昇順にソートされている。
- 入力はすべて整数

## 样例 #1

### 输入

```
6

1 1 1 2 2 3

1 1 1 2 2 3
```

### 输出

```
Yes

2 2 3 1 1 1
```

## 样例 #2

### 输入

```
3

1 1 2

1 1 3
```

### 输出

```
No
```

## 样例 #3

### 输入

```
4

1 1 2 3

1 2 3 3
```

### 输出

```
Yes

3 3 1 2
```



---

---
title: "[ABC179F] Simplified Reversi"
layout: "post"
diff: 普及+/提高
pid: AT_abc179_f
tag: []
---

# [ABC179F] Simplified Reversi

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc179/tasks/abc179_f

縦 $ N $ マス、横 $ N $ マスのグリッドがあります。上から $ i $ 行目、左から $ j $ 列目のマスをマス$ (i,j) $ と表します。

グリッドの中央 $ (N-2)\times\ (N-2) $ マスには黒い石が $ 1 $ 個ずつ置いてあり、下辺と右辺の計 $ 2N-1 $ マスには白い石が $ 1 $ 個ずつ置いてあります。

$ Q $ 個のクエリが与えられるので、順番に処理してください。 クエリには $ 2 $ 種類あり、入力形式とクエリの内容は以下のとおりです。

- `1 x`： $ (1,x) $ に白い石を置く。そこから下方向に最も近い白い石との間にある黒い石を全て白い石に置き換える
- `2 x`： $ (x,1) $ に白い石を置く。そこから右方向に最も近い白い石との間にある黒い石を全て白い石に置き換える

$ Q $ 個のクエリを全て処理したあとグリッド上に黒い石はいくつありますか。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ Q $ $ Query_1 $ $ \vdots $ $ Query_Q $

## 输出格式

$ Q $ 個のクエリを全て処理したあとグリッド上にある黒い石の個数を出力せよ。

## 说明/提示

### 制約

- $ 3\ \leq\ N\ \leq\ 2\times\ 10^5 $
- $ 0\ \leq\ Q\ \leq\ \min(2N-4,2\times\ 10^5) $
- $ 2\ \leq\ x\ \leq\ N-1 $
- 同じクエリが複数回与えられることはない

### Sample Explanation 1

各クエリにより、グリッドは次のように変化します。 !\[図\](https://img.atcoder.jp/ghi/31ba2cd6b3155b137f0e007299225028.png)

## 样例 #1

### 输入

```
5 5

1 3

2 3

1 4

2 2

1 2
```

### 输出

```
1
```

## 样例 #2

### 输入

```
200000 0
```

### 输出

```
39999200004
```

## 样例 #3

### 输入

```
176527 15

1 81279

2 22308

2 133061

1 80744

2 44603

1 170938

2 139754

2 15220

1 172794

1 159290

2 156968

1 56426

2 77429

1 97459

2 71282
```

### 输出

```
31159505795
```



---

---
title: "[ABC183F] Confluence"
layout: "post"
diff: 普及+/提高
pid: AT_abc183_f
tag: []
---

# [ABC183F] Confluence

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc183/tasks/abc183_f

$ N $ 人の生徒が登校しようとしています。生徒 $ i $ はクラス $ C_i $ に属しています。

各生徒はそれぞれの家から出発したあと、他の生徒と合流を繰り返しながら学校へ向かいます。一度合流した生徒が分かれることはありません。

$ Q $ 個のクエリが与えられるので、順番に処理してください。クエリには $ 2 $ 種類あり、入力形式とクエリの内容は以下の通りです。

- `1 a b` : 生徒 $ a $ を含む集団と、生徒 $ b $ を含む集団が合流する (既に合流しているときは何も起こらない)
- `2 x y` : クエリの時点で既に生徒 $ x $ と合流している生徒(生徒 $ x $ を含む)のうち、クラス $ y $ に属している生徒の数を求める

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ Q $ $ C_1 $ $ \ldots $ $ C_N $ $ Query_1 $ $ \vdots $ $ Query_Q $

## 输出格式

`2 x y` のクエリに対する答えを、$ 1 $ 行に $ 1 $ つずつ、順に出力せよ。

## 说明/提示

### 制約

- $ 1\ \leq\ N\ \leq\ 2\ \times\ 10^5 $
- $ 1\ \leq\ Q\ \leq\ 2\ \times\ 10^5 $
- $ 1\ \leq\ C_i,a,b,x,y\ \leq\ N $
- `1 a b` のクエリにおいて、$ a\ \neq\ b $
- 入力はすべて整数

### Sample Explanation 1

$ 3 $ 番目のクエリの時点で、生徒 $ 1 $ は、生徒 $ 2,5 $ と合流しています。生徒 $ 1,2,5 $ のうちクラス $ 1 $ に属する生徒は $ 2 $ 人です。 $ 5 $ 番目のクエリの時点で、生徒 $ 3 $ は、生徒 $ 4 $ と合流しています。生徒 $ 3,4 $ のうちクラス $ 4 $ に属する生徒は $ 0 $ 人です。

### Sample Explanation 2

すでに同じ集団に属している生徒に対して、`1 a b` のクエリが与えられることもあります。

## 样例 #1

### 输入

```
5 5

1 2 3 2 1

1 1 2

1 2 5

2 1 1

1 3 4

2 3 4
```

### 输出

```
2

0
```

## 样例 #2

### 输入

```
5 4

2 2 2 2 2

1 1 2

1 1 3

1 2 3

2 2 2
```

### 输出

```
3
```

## 样例 #3

### 输入

```
12 9

1 2 3 1 2 3 1 2 3 1 2 3

1 1 2

1 3 4

1 5 6

1 7 8

2 2 1

1 9 10

2 5 6

1 4 8

2 6 1
```

### 输出

```
1

0

0
```



---

---
title: "[ABC184E] Third Avenue"
layout: "post"
diff: 普及+/提高
pid: AT_abc184_e
tag: []
---

# [ABC184E] Third Avenue

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc184/tasks/abc184_e

縦 $ H $ マス、横 $ W $ マスの $ 2 $ 次元グリッドで表された街があります。  
 上から $ i $ 行目、左から $ j $ 列目のマスの情報が文字 $ a_{i,j} $ により与えられます。 $ a_{i,j} $ は `S` , `G` , `.` , `#` , `a` ~ `z` のいずれかです。  
`#` は入ることができないマスを、`a` ~ `z` はテレポーターのあるマスを表します。

高橋くんははじめ `S` のマスにおり、 $ 1 $ 秒ごとに以下のいずれかの移動を行います。

- 現在いるマスと上下左右に隣り合う、`#` でないマスに移動する。
- 今いるマスと同じ文字が書かれているマスを $ 1 $ つ選び、そこにテレポートする。この移動は現在いるマスが `a` ~ `z` のいずれかであるとき使える。

高橋くんが `S` のマスから `G` のマスに移動するのに必要な最短の時間を求めてください。  
 ただし、どうしても `G` のマスにたどり着けない場合は、代わりに `-1` を出力してください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ H $ $ W $ $ a_{1,1}\dots\ a_{1,W} $ $ \vdots $ $ a_{H,1}\dots\ a_{H,W} $

## 输出格式

`S` のマスから `G` のマスに移動するのに必要な最短時間を出力せよ。  
`S` のマスから `G` のマスに移動する方法が存在しない場合は、代わりに `-1` を出力せよ。

## 说明/提示

### 制約

- $ 1\ \le\ H,\ W\ \le\ 2000 $
- $ a_{i,j} $ は `S` , `G` , `.` , `#` , 英小文字のいずれか
- `S` のマスと `G` のマスはちょうど $ 1 $ つ存在する

### Sample Explanation 1

上から $ i $ 行目、左から $ j $ 列目のマスを $ (i,\ j) $ で表すこととします。 はじめ、高橋くんは $ (1,\ 1) $ にいます。 例えば、以下のような手順で $ 4 $ 秒で $ (2,\ 5) $ に移動することができます。 - $ (1,\ 1) $ から $ (2,\ 1) $ に移動する - $ (2,\ 1) $ と同じ `a` のマスである $ (2,\ 3) $ にテレポートする - $ (2,\ 3) $ から $ (2,\ 4) $ に移動する - $ (2,\ 4) $ から $ (2,\ 5) $ に移動する

## 样例 #1

### 输入

```
2 5

S.b.b

a.a.G
```

### 输出

```
4
```

## 样例 #2

### 输入

```
11 11

S##...#c...

...#d.#.#..

..........#

.#....#...#

#.....bc...

#.##......#

.......c..#

..#........

a..........

d..#...a...

.#........G
```

### 输出

```
14
```

## 样例 #3

### 输入

```
11 11

.#.#.e#a...

.b..##..#..

#....#.#..#

.#dd..#..#.

....#...#e.

c#.#a....#.

.....#..#.e

.#....#b.#.

.#...#..#..

......#c#G.

#..S...#...
```

### 输出

```
-1
```



---

---
title: "[ABC184F] Programming Contest"
layout: "post"
diff: 普及+/提高
pid: AT_abc184_f
tag: []
---

# [ABC184F] Programming Contest

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc184/tasks/abc184_f

高橋くんはプログラミングコンテストに参加します。 このコンテストのコンテスト時間は $ T $ 分間で、 $ N $ 問の問題が出題されます。  
 高橋くんは超能力者なので、 $ i $ 番目の問題が $ A_i $ 分で解けることが分かっています。  
 高橋くんは $ N $ 問の中から $ 0 $ 問以上を、解くのにかかる時間の総和が $ T $ 分以下になるように選び、それらの問題を解きます。  
 選んだ問題を解くのにかかる時間の総和の最大値を求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ T $ $ A_1 $ $ \dots $ $ A_N $

## 输出格式

答えを整数として出力せよ。

## 说明/提示

### 制約

- 入力は全て整数
- $ 1\ \le\ N\ \le\ 40 $
- $ 1\ \le\ T\ \le\ 10^9 $
- $ 1\ \le\ A_i\ \le\ 10^9 $

### Sample Explanation 1

$ 1,2,3,4 $ 問目を選ぶと、解くのにかかる時間の総和が $ 2+3+5+7=17 $ 分となり、 $ T=17 $ 分以下での最大になります。

### Sample Explanation 2

全ての問題を解くのが最適です。

### Sample Explanation 3

どの問題も解くことができません。

### Sample Explanation 4

$ 2,3,7 $ 問目を選ぶと、解くのにかかる時間の総和が $ 273555143 $ 分になります。

## 样例 #1

### 输入

```
5 17

2 3 5 7 11
```

### 输出

```
17
```

## 样例 #2

### 输入

```
6 100

1 2 7 5 8 10
```

### 输出

```
33
```

## 样例 #3

### 输入

```
6 100

101 102 103 104 105 106
```

### 输出

```
0
```

## 样例 #4

### 输入

```
7 273599681

6706927 91566569 89131517 71069699 75200339 98298649 92857057
```

### 输出

```
273555143
```



---

---
title: "[ABC185E] Sequence Matching"
layout: "post"
diff: 普及+/提高
pid: AT_abc185_e
tag: []
---

# [ABC185E] Sequence Matching

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc185/tasks/abc185_e

長さ $ N $ の整数列 $ A $ と、長さ $ M $ の整数列 $ B $ があります。  
 高橋君は $ A $ から、いくつかの要素を取り除き、残った要素をそのままの順番で繋げることで新たな数列 $ A' $ を作ります。(一つも取り除かなくても、全部取り除いても構いません。)  
 $ B $ についても同様に、いくつかの要素を取り除き、残った要素をそのままの順番で繋げることで新たな数列 $ B' $ を作ります。(一つも取り除かなくても、全部取り除いても構いません。)  
 このとき、$ |A'|\ =\ |B'| $ となるような取り除き方をします。(数列 $ s $ について $ |s| $ は $ s $ の長さを表します。)  
 $ A,\ B $ から取り除いた合計要素数を $ x $ とし、$ 1\ \le\ i\ \le\ |A'| $ かつ $ {A'}_i\ \neq\ {B'}_i $ を満たす整数 $ i $ の数を $ y $ とするとき、$ x\ +\ y $ として考えられる最小の値を求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ M $ $ A_1\ \hspace{7pt}\ A_2\ \hspace{7pt}\ A_3\ \hspace{5pt}\ \dots\ \hspace{5pt}\ A_N $ $ B_1\ \hspace{7pt}\ B_2\ \hspace{7pt}\ B_3\ \hspace{5pt}\ \dots\ \hspace{5pt}\ B_M $

## 输出格式

$ x\ +\ y $ として考えられる最小の値を出力せよ。

## 说明/提示

### 制約

- $ 1\ \le\ N,\ M\ \le\ 1000 $
- $ 1\ \le\ A_i,\ B_i\ \le\ 10^9 $
- 入力は全て整数

### Sample Explanation 1

$ A $ から $ A_4 $ を削除して $ A' $ を作り、$ B $ からは何も削除せず $ B' $ を作ることにすると、$ x\ =\ 1 $ となります。 また、このとき $ 1\ \le\ i\ \le\ |A'| $ かつ $ {A'}_i\ \neq\ {B'}_i $ を満たす整数 $ i $ は $ 2 $ の一つのみなので $ y\ =\ 1 $ となります。そして $ x\ +\ y $ は $ 2 $ となり、これが最小です。

### Sample Explanation 2

$ A $ からは何も取り除かず、$ B $ からは $ B_4,\ B_6 $ の $ 2 $ 要素を削除すると $ x\ =\ 2,\ y\ =\ 1 $ となり、 $ x\ +\ y $ は $ 3 $ で、これが最小です。

### Sample Explanation 3

$ A $ からも $ B $ からも何も取り除かないことも許されます。

## 样例 #1

### 输入

```
4 3

1 2 1 3

1 3 1
```

### 输出

```
2
```

## 样例 #2

### 输入

```
4 6

1 3 2 4

1 5 2 6 4 3
```

### 输出

```
3
```

## 样例 #3

### 输入

```
5 5

1 1 1 1 1

2 2 2 2 2
```

### 输出

```
5
```



---

---
title: "[ABC186E] Throne"
layout: "post"
diff: 普及+/提高
pid: AT_abc186_e
tag: []
---

# [ABC186E] Throne

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc186/tasks/abc186_e

円周上に $ N $ 個の椅子が並べられています。そのうち $ 1 $ つは玉座です。

高橋君は最初、玉座から時計回りに数えて $ S $ 個隣の椅子に座っており、次の行動を繰り返します。

行動：いま座っている椅子から時計回りに数えて $ K $ 個隣の椅子に移動し座る。

高橋君がはじめて玉座に座ることができるのは何回目の行動の後ですか？ ただし、玉座に座ることが永遠にできない場合は、代わりに `-1` を出力してください。

$ T $ 個のテストケースに答えてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。$ 1 $ 行目は以下の通りである。

> $ T $

そして、続く $ T $ 行が $ T $ 個のテストケースを表す。これらはそれぞれ以下の形式の行である。

> $ N $ $ S $ $ K $

## 输出格式

各テストケースに対し、答えを出力せよ。テストケースごとに改行すること。

## 说明/提示

### 制約

- $ 1\leq\ T\ \leq\ 100 $
- $ 2\leq\ N\ \leq\ 10^9 $
- $ 1\leq\ S\ <\ N $
- $ 1\leq\ K\ \leq\ 10^9 $

### Sample Explanation 1

$ 1 $ つ目のテストケースでは、椅子が $ 10 $ 個あり、高橋君は最初、玉座から時計回りに数えて $ 4 $ 個隣の席に座っています。 時計回りに $ 3 $ 個隣の席に移動する行動を $ 2 $ 回行うと玉座に座れます。 $ 2 $ つ目のテストケースでは、高橋君が玉座に座ることは永遠にできないので、`-1` を出力します。

## 样例 #1

### 输入

```
4

10 4 3

1000 11 2

998244353 897581057 595591169

10000 6 14
```

### 输出

```
2

-1

249561088

3571
```



---

---
title: "[ABC186F] Rook on Grid"
layout: "post"
diff: 普及+/提高
pid: AT_abc186_f
tag: []
---

# [ABC186F] Rook on Grid

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc186/tasks/abc186_f

縦 $ H $ マス、横 $ W $ マスのグリッドがあります。上から $ i $ 行目、左から $ j $ 列目のマスをマス $ (i,j) $ と表します。

グリッド上には $ M $ 個の障害物があり、$ i $ 番目の障害物はマス $ (X_i,Y_i) $ に置かれています。

マス $ (1,1) $ に飛車の駒が置いてあります。飛車の駒は、今いる位置から右または下方向に伸びる直線上にあり、障害物を飛び越えずに到達できるマスに $ 1 $ 手で移動することができます。

$ 2 $ 手以内の移動で飛車の駒が到達できるマスの数を求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ H $ $ W $ $ M $ $ X_1 $ $ Y_1 $ $ \vdots $ $ X_M $ $ Y_M $

## 输出格式

$ 2 $ 手以内の移動で飛車の駒が到達できるマスの数を出力せよ。

## 说明/提示

### 制約

- $ 1\leq\ H,W\ \leq\ 2\times\ 10^5 $
- $ 0\leq\ M\ \leq\ 2\times\ 10^5 $
- $ 1\leq\ X_i\ \leq\ H $
- $ 1\leq\ Y_i\ \leq\ W $
- $ (X_i,Y_i)\ \neq\ (1,1) $
- $ (X_i,Y_i) $ は相異なる
- 入力は全て整数

### Sample Explanation 1

障害物のない全てのマスに $ 2 $ 手以内で移動できます。

### Sample Explanation 2

障害物のないマスのうち、$ (4,4),(5,4) $ 以外の全てのマスに $ 2 $ 手以内で移動できます。

## 样例 #1

### 输入

```
4 3 2

2 2

3 3
```

### 输出

```
10
```

## 样例 #2

### 输入

```
5 4 4

3 2

3 4

4 2

5 2
```

### 输出

```
14
```

## 样例 #3

### 输入

```
200000 200000 0
```

### 输出

```
40000000000
```



---

---
title: "[ABC187E] Through Path"
layout: "post"
diff: 普及+/提高
pid: AT_abc187_e
tag: []
---

# [ABC187E] Through Path

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc187/tasks/abc187_e

$ N $ 頂点 $ N-1 $ 辺から成る木があり、頂点には $ 1,\ 2,\ \dots,\ N $ の番号が、辺には $ 1,\ 2,\ \dots,\ N-1 $ の番号がついています。辺 $ i $ は頂点 $ a_i $ と頂点 $ b_i $ を結びます。 この木の各頂点には $ 1 $ つの整数が書かれています。頂点 $ i $ に書かれている整数を $ c_i $ とします。はじめ、 $ c_i\ =\ 0 $ です。

$ Q $ 個のクエリが与えられます。 $ i $ 番目のクエリでは、整数 $ t_i,\ e_i,\ x_i $ が与えられます。クエリの内容は以下の通りです。

- $ t_i\ =\ 1 $ のとき : 頂点 $ a_{e_i} $ から辺をたどって頂点 $ b_{e_i} $ を通らずに到達できるような全ての頂点 $ v $ に対して、$ c_v $ を $ c_v\ +\ x_i $ に書き換える。
- $ t_i\ =\ 2 $ のとき : 頂点 $ b_{e_i} $ から辺をたどって頂点 $ a_{e_i} $ を通らずに到達できるような全ての頂点 $ v $ に対して、$ c_v $ を $ c_v\ +\ x_i $ に書き換える。

すべてのクエリを処理した後、各頂点に書かれた整数を出力してください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ a_1 $ $ b_1 $ $ \vdots $ $ a_{N-1} $ $ b_{N-1} $ $ Q $ $ t_1 $ $ e_1 $ $ x_1 $ $ \vdots $ $ t_Q $ $ e_Q $ $ x_Q $

## 输出格式

すべてのクエリを処理した後の $ c_1,\ c_2,\ \dots,\ c_N $ をこの順に改行区切りで出力せよ。

## 说明/提示

### 制約

- 入力は全て整数
- $ 2\ \le\ N\ \le\ 2\ \times\ 10^5 $
- $ 1\ \le\ a_i,\ b_i\ \le\ N $
- 与えられるグラフは木である
- $ 1\ \le\ Q\ \le\ 2\ \times\ 10^5 $
- $ t_i\ \in\ \{1,\ 2\} $
- $ 1\ \le\ e_i\ \le\ N-1 $
- $ 1\ \le\ x_i\ \le\ 10^9 $

### Sample Explanation 1

$ 1 $ 番目のクエリでは、頂点 $ 1 $ から始めて頂点 $ 2 $ を通らずに到達できる頂点 $ 1 $ に $ 1 $ を足します。 $ 2 $ 番目のクエリでは、頂点 $ 4 $ から始めて頂点 $ 5 $ を通らずに到達できる頂点 $ 1,\ 2,\ 3,\ 4 $ に $ 10 $ を足します。 $ 3 $ 番目のクエリでは、頂点 $ 2 $ から始めて頂点 $ 1 $ を通らずに到達できる頂点 $ 2,\ 3,\ 4,\ 5 $ に $ 100 $ を足します。 $ 4 $ 番目のクエリでは、頂点 $ 3 $ から始めて頂点 $ 2 $ を通らずに到達できる頂点 $ 3 $ に $ 1000 $ を足します。

## 样例 #1

### 输入

```
5

1 2

2 3

2 4

4 5

4

1 1 1

1 4 10

2 1 100

2 2 1000
```

### 输出

```
11

110

1110

110

100
```

## 样例 #2

### 输入

```
7

2 1

2 3

4 2

4 5

6 1

3 7

7

2 2 1

1 3 2

2 2 4

1 6 8

1 3 16

2 4 32

2 1 64
```

### 输出

```
72

8

13

26

58

72

5
```

## 样例 #3

### 输入

```
11

2 1

1 3

3 4

5 2

1 6

1 7

5 8

3 9

3 10

11 4

10

2 6 688

1 10 856

1 8 680

1 8 182

2 2 452

2 4 183

2 6 518

1 3 612

2 6 339

2 3 206
```

### 输出

```
1657

1657

2109

1703

1474

1657

3202

1474

1247

2109

2559
```



---

---
title: "[ABC188F] +1-1x2"
layout: "post"
diff: 普及+/提高
pid: AT_abc188_f
tag: []
---

# [ABC188F] +1-1x2

## 题目描述

高桥君在黑板上写下了一个正整数 X，现在高桥君想要让这个正整数变成 Y，每一次都可以按以下三种中的任意一种方式来改变这个数:

1. 将目前黑板上的数加1。

2. 将目前黑板上的数减1。

3. 将目前黑板上的数乘以2。

现在高桥君想要知道从 X 变成 Y 的最小次数。

## 输入格式

两个正整数 X ， Y。

## 输出格式

X 变成 Y 的最小操作的次数。

## 说明/提示

- 1≤X≤${10^{18}}$
- 1≤Y≤${10^{18}}$

## 样例 #1

### 输入

```
3 9
```

### 输出

```
3
```

## 样例 #2

### 输入

```
7 11
```

### 输出

```
3
```

## 样例 #3

### 输入

```
1000000000000000000 1000000000000000000
```

### 输出

```
0
```



---

---
title: "[ABC189E] Rotate and Flip"
layout: "post"
diff: 普及+/提高
pid: AT_abc189_e
tag: []
---

# [ABC189E] Rotate and Flip

## 题目描述

给出 $N$ 个点，以及每个点得坐标 $(x_i,y_i)$，给出 $M$ 次操作，操作如下：

- 第一种操作：将所有点绕原点 $(0,0)$ 顺时针旋转 $90$ 度。

- 第二种操作：将所有点绕原点 $(0,0)$ 逆时针旋转 $90$ 度。

- 第三种操作：以 $x=p$ 为对称轴，将所有的点对称过去。

- 第四种操作：以 $y=p$ 为对称轴，将所有的点对称过去。

接着给出 $Q$ 组询问，每次询问在某次操作过后某个点的坐标。

## 输入格式

第一行输入 $N$，表示 $N$ 个点。

接下来 $N$ 行，每行输入 $x_i,y_i$，表示第 $i$ 个点的坐标。

第 $N+2$ 行输入 $M$，表示操作次数。

接下来 $M$ 行，每行首先输入 $opt_i$，表示执行第 $opt_i$ 种操作。如果 $opt_i=3$ 或者 $opt_i=4$，再输入一个数字 $p$，表示一条直线。

第 $N+M+3$ 行输入 $Q$，表示询问个数。

接下来 $Q$ 行，每行两个数字 $A_i,B_i$，表示询问在第 $A_i$ 次操作过后第 $B_i$ 个点的坐标。特别的，$A_i=0$  表示询问初始的坐标。

## 输出格式

输出 $Q$ 行，每行输出对于一次询问的答案。

## 样例 #1

### 输入

```
1

1 2

4

1

3 3

2

4 2

5

0 1

1 1

2 1

3 1

4 1
```

### 输出

```
1 2

2 -1

4 -1

1 4

1 0
```

## 样例 #2

### 输入

```
2

1000000000 0

0 1000000000

4

3 -1000000000

4 -1000000000

3 1000000000

4 1000000000

2

4 1

4 2
```

### 输出

```
5000000000 4000000000

4000000000 5000000000
```



---

---
title: "[ABC190E] Magical Ornament"
layout: "post"
diff: 普及+/提高
pid: AT_abc190_e
tag: []
---

# [ABC190E] Magical Ornament

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc190/tasks/abc190_e

AtCoder 王国には $ 1,\ 2,\ \dots,\ N $ の番号がついた $ N $ 種類の魔法石が流通しています。  
 高橋くんは、魔法石を一列に並べて飾りを作ろうとしています。  
 魔法石には隣り合わせにできる組とできない組があります。 隣り合わせにできる組は $ ( $魔法石 $ A_1, $ 魔法石 $ B_1),\ ( $魔法石 $ A_2, $ 魔法石 $ B_2),\ \dots,\ ( $魔法石 $ A_M, $ 魔法石 $ B_M) $ の $ M $ 組で、それ以外の組は隣り合わせることができません。(これらの組において、石の順序は不問です。)  
 魔法石 $ C_1,\ C_2,\ \dots,\ C_K $ をそれぞれ $ 1 $ 個以上含む魔法石の列を作ることができるか判定し、作れる場合はそのような列を作るのに必要な魔法石の個数の最小値を求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ M $ $ A_1 $ $ B_1 $ $ A_2 $ $ B_2 $ $ \hspace{7mm}\vdots $ $ A_M $ $ B_M $ $ K $ $ C_1 $ $ C_2 $ $ \cdots $ $ C_K $

## 输出格式

魔法石 $ C_1,\ C_2,\ \dots,\ C_K $ を含む魔法石の列を作るのに必要な魔法石の個数の最小値を出力せよ。  
 作ることができない場合、代わりに `-1` を出力せよ。

## 说明/提示

### 制約

- 入力は全て整数
- $ 1\ <\ = N\ <\ =\ 10^5 $
- $ 0\ <\ = M\ <\ =\ 10^5 $
- $ 1\ <\ =\ A_i\ <\ B_i\ <\ =\ N $
- $ i\ ≠\ j $ ならば $ (A_i,\ B_i)\ ≠\ (A_j,\ B_j) $
- $ 1\ <\ =\ K\ <\ =\ 17 $
- $ 1\ <\ =\ C_1\ <\ C_2\ <\ \dots\ <\ C_K\ <\ =\ N $

### Sample Explanation 1

例えば、魔法石を $ [1,\ 4,\ 2,\ 4,\ 3] $ と並べると、魔法石 $ 1,\ 2,\ 3 $ を含む長さ $ 5 $ の列を作ることができます。

### Sample Explanation 3

例えば、魔法石を $ [1,\ 6,\ 7,\ 5,\ 8,\ 3,\ 9,\ 3,\ 8,\ 10,\ 2] $ と並べると、魔法石 $ 1,\ 2,\ 7,\ 9 $ を含む長さ $ 11 $ の列を作ることができます。

## 样例 #1

### 输入

```
4 3

1 4

2 4

3 4

3

1 2 3
```

### 输出

```
5
```

## 样例 #2

### 输入

```
4 3

1 4

2 4

1 2

3

1 2 3
```

### 输出

```
-1
```

## 样例 #3

### 输入

```
10 10

3 9

3 8

8 10

2 10

5 8

6 8

5 7

6 7

1 6

2 4

4

1 2 7 9
```

### 输出

```
11
```



---

---
title: "[ABC190F] Shift and Inversions"
layout: "post"
diff: 普及+/提高
pid: AT_abc190_f
tag: []
---

# [ABC190F] Shift and Inversions

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc190/tasks/abc190_f

$ 0,\ 1,\ 2,\ \dots,\ N\ -\ 1 $ を並び替えた数列 $ A\ =\ [a_0,\ a_1,\ a_2,\ \dots,\ a_{N-1}] $ が与えられます。  
 $ k\ =\ 0,\ 1,\ 2,\ \dots,\ N\ -\ 1 $ のそれぞれについて、$ b_i\ =\ a_{i+k\ \bmod\ N} $ で定義される数列 $ B\ =\ [b_0,\ b_1,\ b_2,\ \dots,\ b_{N-1}] $ の転倒数を求めてください。

 転倒数とは 数列 $ A\ =\ [a_0,\ a_1,\ a_2,\ \dots,\ a_{N-1}] $ の転倒数とは、$ i\ かつ\ a_i\ >\ a_j $ を満たす添字の組 $ (i,\ j) $ の個数のことです。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ a_0 $ $ a_1 $ $ a_2 $ $ \cdots $ $ a_{N-1} $

## 输出格式

$ N $ 行出力せよ。  
 $ i\ +\ 1 $ 行目には、$ k\ =\ i $ としたときの答えを出力せよ。

## 说明/提示

### 制約

- 入力は全て整数
- $ 2\ <\ =\ N\ <\ =\ 3\ \times\ 10^5 $
- $ a_0,\ a_1,\ a_2,\ \dots,\ a_{N-1} $ は $ 0,\ 1,\ 2,\ \dots,\ N\ -\ 1 $ の並び替えである

### Sample Explanation 1

$ A\ =\ [0,\ 1,\ 2,\ 3] $ です。 $ k\ =\ 0 $ のとき、$ B\ =\ [0,\ 1,\ 2,\ 3] $ の転倒数は $ 0 $ です。 $ k\ =\ 1 $ のとき、$ B\ =\ [1,\ 2,\ 3,\ 0] $ の転倒数は $ 3 $ です。 $ k\ =\ 2 $ のとき、$ B\ =\ [2,\ 3,\ 0,\ 1] $ の転倒数は $ 4 $ です。 $ k\ =\ 3 $ のとき、$ B\ =\ [3,\ 0,\ 1,\ 2] $ の転倒数は $ 3 $ です。

## 样例 #1

### 输入

```
4

0 1 2 3
```

### 输出

```
0

3

4

3
```

## 样例 #2

### 输入

```
10

0 3 1 5 4 2 9 6 8 7
```

### 输出

```
9

18

21

28

27

28

33

24

21

14
```



---

---
title: "[ABC191E] Come Back Quickly"
layout: "post"
diff: 普及+/提高
pid: AT_abc191_e
tag: []
---

# [ABC191E] Come Back Quickly

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc191/tasks/abc191_e

AtCoder 国には、町 $ 1 $ から町 $ N $ までの $ N $ 個の町と、道路 $ 1 $ から道路 $ M $ までの $ M $ 本の道路があります。  
 道路 $ i $ は町 $ A_i $ から町 $ B_i $ への一方通行で、通るのに $ C_i $ 分かかります。$ A_i\ =\ B_i $ かもしれませんし、同じ町の組を結ぶ道路が複数あるかもしれません。  
 高橋君はこの国で散歩をしようと考えました。ある町から出発し、$ 1 $ 本以上の道路を通り、出発した町に帰ってくるような経路を**正しい散歩経路**と呼ぶことにします。  
 各町について、その町から出発する正しい散歩経路が存在するかを判定してください。また、存在するなら、そのような経路を通るのにかかる時間の最小値を求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ M $ $ A_1 $ $ B_1 $ $ C_1 $ $ A_2 $ $ B_2 $ $ C_2 $ $ A_3 $ $ B_3 $ $ C_3 $ $ \hspace{25pt}\ \vdots $ $ A_M $ $ B_M $ $ C_M $

## 输出格式

$ N $ 行に渡って出力せよ。 $ i(1\ \le\ i\ \le\ N) $ 行目には以下を出力せよ。

- 町 $ i $ から出発する正しい散歩経路が存在するなら、そのような経路を通るのにかかる時間の最小値
- 存在しないなら `-1`

## 说明/提示

### 制約

- $ 1\ \le\ N\ \le\ 2000 $
- $ 1\ \le\ M\ \le\ 2000 $
- $ 1\ \le\ A_i\ \le\ N $
- $ 1\ \le\ B_i\ \le\ N $
- $ 1\ \le\ C_i\ \le\ 10^5 $
- 入力は全て整数

### Sample Explanation 1

道路 $ 1,\ 2,\ 3 $ によって、町 $ 1,\ 2,\ 3 $ は一周に $ 30 $ 分かかる一つの輪のように繋がっています。 町 $ 4 $ から町 $ 1,\ 2,\ 3 $ に行くことはできますが、町 $ 4 $ に帰ってくることはできません。

### Sample Explanation 2

$ A_i\ =\ B_i $ であるような道路が存在するかもしれません。 この場合、町 $ 1 $ からは、道路 $ 6 $ だけを使って $ 10 $ 分で町 $ 1 $ に帰ってくることができます。

### Sample Explanation 3

同じ町の組を結ぶ道路が複数あるかもしれないことに注意してください。

## 样例 #1

### 输入

```
4 4

1 2 5

2 3 10

3 1 15

4 3 20
```

### 输出

```
30

30

30

-1
```

## 样例 #2

### 输入

```
4 6

1 2 5

1 3 10

2 4 5

3 4 10

4 1 10

1 1 10
```

### 输出

```
10

20

30

20
```

## 样例 #3

### 输入

```
4 7

1 2 10

2 3 30

1 4 15

3 4 25

3 4 20

4 3 20

4 3 30
```

### 输出

```
-1

-1

40

40
```



---

---
title: "[ABC192D] Base n"
layout: "post"
diff: 普及+/提高
pid: AT_abc192_d
tag: []
---

# [ABC192D] Base n

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc192/tasks/abc192_d

`0` ～ `9` からなる文字列 $ X $ と、整数 $ M $ が与えられます。

$ X $ に含まれる最も大きい数字を $ d $ とします。

$ d+1 $ 以上の整数 $ n $ を選んで $ X $ を $ n $ 進法表記の数とみなして得られる値のうち、$ M $ 以下であるようなものは何種類あるでしょうか？

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ X $ $ M $

## 输出格式

答えを出力せよ。

## 说明/提示

### 制約

- $ X $ は `0` ～ `9` のみからなる
- $ X $ の長さは $ 1 $ 以上 $ 60 $ 以下
- $ X $ の先頭の文字は `0` ではない
- $ 1\ \leq\ M\ \leq\ 10^{18} $

### Sample Explanation 1

$ X $ に含まれる最も大きい数字は `2` です。 - $ X $ を $ 3 $ 進法表記とみなして得られる値は $ 8 $ です。 - $ X $ を $ 4 $ 進法表記とみなして得られる値は $ 10 $ です。 得られる値のうち $ 10 $ 以下のものはこの $ 2 $ つのみです。

### Sample Explanation 2

$ X $ に含まれる最も大きい数字は `9` です。 - $ X $ を $ 10 $ 進法表記とみなして得られる値は $ 999 $ です。 - $ X $ を $ 11 $ 進法表記とみなして得られる値は $ 1197 $ です。 - $ X $ を $ 12 $ 進法表記とみなして得られる値は $ 1413 $ です。 得られる値のうち $ 1500 $ 以下のものはこの $ 3 $ つのみです。

### Sample Explanation 3

$ X $ を $ 2 $ 進法表記とみなして得られる $ 576460752303423488 $ が、唯一の $ 1000000000000000000 $ 以下の得られる数です。

## 样例 #1

### 输入

```
22

10
```

### 输出

```
2
```

## 样例 #2

### 输入

```
999

1500
```

### 输出

```
3
```

## 样例 #3

### 输入

```
100000000000000000000000000000000000000000000000000000000000

1000000000000000000
```

### 输出

```
1
```



---

---
title: "[ABC192F] Potion"
layout: "post"
diff: 普及+/提高
pid: AT_abc192_f
tag: []
---

# [ABC192F] Potion

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc192/tasks/abc192_f

$ N $ 種類の素材があり、素材 $ i $ には $ A_i $ の魔力があります。

魔法使いの高橋君は、この中から $ 1 $ 種類以上を選んで合成し、ポーションを作ろうとしています。

$ k $ 種類の素材を合成して出来たポーションの魔力は、合成した直後には素材の魔力の合計であり、時間が $ 1 $ 経過するごとに $ k $ 増加します。 魔力の増加は連続的ではなく離散的であることに注意してください。

高橋君が時刻 $ 0 $ に $ 1 $ 度だけ素材の合成を行うとき、魔力がちょうど $ X $ のポーションは、最速でいつ手に入りますか？

なお、制約下で魔力がちょうど $ X $ のポーションを作れることが証明されます。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ X $ $ A_1 $ $ \ldots $ $ A_N $

## 输出格式

魔力がちょうど $ X $ のポーションを手に入れることができる最も早い時刻を出力せよ。

## 说明/提示

### 制約

- $ 1\ \leq\ N\ \leq\ 100 $
- $ 1\ \leq\ A_i\ \leq\ 10^7 $
- $ 10^9\ \leq\ X\ \leq\ 10^{18} $
- 入力は全て整数

### Sample Explanation 1

素材 $ 1 $ と素材 $ 3 $ を合成して出来たポーションの魔力は、時刻 $ 0 $ で $ 3+8=11 $ であり、時間が $ 1 $ 経過するごとに $ 2 $ 増加するので、時刻 $ 4999999994 $ に $ 9999999999 $ になります。これが最速です。 素材 $ 1,2,3 $ 全てを合成して出来たポーションの魔力は、時刻 $ 3333333327 $ に $ 9999999998 $、時刻 $ 3333333328 $ に $ 10000000001 $ となり、ちょうど $ 9999999999 $ にはなりません。

## 样例 #1

### 输入

```
3 9999999999

3 6 8
```

### 输出

```
4999999994
```

## 样例 #2

### 输入

```
1 1000000000000000000

1
```

### 输出

```
999999999999999999
```



---

---
title: "[ABC195E] Lucky 7 Battle"
layout: "post"
diff: 普及+/提高
pid: AT_abc195_e
tag: []
---

# [ABC195E] Lucky 7 Battle

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc195/tasks/abc195_e

`0`,$ \ldots $,`9` からなる長さ $ N $ の文字列 $ S $ と、`A`,`T` からなる長さ $ N $ の文字列 $ X $ が与えられます。また、空文字列で初期化された文字列 $ T $ があります。

高橋君と青木君がこれらを使ってゲームをします。ゲームは $ N $ ラウンドからなり、$ i $ 回目 $ (1\leq\ i\ \leq\ N) $ のラウンドでは次の操作が行われます。

- $ X_i $ が `A` なら青木君が、`T` なら高橋君が以下の操作を行う
- 操作：$ T $ の末尾に $ S_i $ か `0` のどちらか一方を加える

$ N $ 回の操作が終了したあと、$ T $ は `0`,$ \ldots $,`9` からなる長さ $ N $ の文字列となります。 $ T $ を (先頭の余計な $ 0 $ を取り除いた上で) $ 10 $ 進法で表された数と解釈したとき、$ 7 $ の倍数であれば高橋君の勝ちであり、そうでなければ青木君の勝ちです。

$ 2 $ 人が最適に行動する時、どちらが勝つか判定してください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ S $ $ X $

## 输出格式

$ 2 $ 人が最適に行動する時、高橋君が勝つなら `Takahashi`、 青木君が勝つなら `Aoki` と出力せよ。

## 说明/提示

### 制約

- $ 1\ \leq\ N\ \leq\ 2\times\ 10^5 $
- $ S,X $ の長さは $ N $
- $ S $ は `0`,$ \ldots $,`9` のみからなる
- $ X $ は `A`,`T` のみからなる

### Sample Explanation 1

$ 1 $ 回目のラウンドでは青木君が `3` か `0` を $ T $ の末尾に加え、$ 2 $ 回目のラウンドでは高橋君が `5` か `0` を $ T $ の末尾に加えます。 青木君が `3` を加えた場合、高橋君が `5` を追加すると $ T $ は `35` となり、これは $ 7 $ の倍数です。 青木君が `0` を加えた場合、高橋君が `0` を追加すると $ T $ は `00` となり、これは $ 7 $ の倍数です。 したがって、かならず高橋君が勝ちます。

## 样例 #1

### 输入

```
2

35

AT
```

### 输出

```
Takahashi
```

## 样例 #2

### 输入

```
5

12345

AAAAT
```

### 输出

```
Aoki
```

## 样例 #3

### 输入

```
5

67890

TTTTA
```

### 输出

```
Takahashi
```

## 样例 #4

### 输入

```
5

12345

ATATA
```

### 输出

```
Aoki
```



---

---
title: "[ABC196E] Filters"
layout: "post"
diff: 普及+/提高
pid: AT_abc196_e
tag: []
---

# [ABC196E] Filters

## 题目描述

给出整数数列 $A=(a_1,a_2,...,a_n)$，$T=(t_1,t_2,...,t_n)$，$X=(x_1,x_2,...,x_q)$。

定义 $n$ 个函数 $f_1(x),f_2(x),...,f_n(x)$：
$$
f_i(x)=\begin{cases}
x+a_i& t_i=1\\
\max(x,a_i)& t_i=2\\
\min(x,a_i)& t_i=3\\
\end{cases}
$$
对于 $i=1,2,...,q$，求出 $f_n(...f_2(f_1(x_i))...)$ 的值。

## 输入格式

第一行一个整数 $n$，为函数的个数。

接下来 $n$ 行每行两个整数 $a_i,t_i$，含义如题面所示。

下一行有一个整数 $q$，为需要求值的点数。

接下来一行 $q$ 个整数，第 $i$ 个数为 $x_i$。

## 输出格式

输出$q$ 行，第 $i$ 行为 $f_n(...f_2(f_1(x_i))...)$ 的值。

## 说明/提示

对于 $100\%$ 的数据所有输入的值均为整数，$1 \leqslant n,q \leqslant 2 \times 10^5$，$1 \leqslant t_i \leqslant 3$，$|a_i|,|x_i| \leqslant 10^9$。

## 样例 #1

### 输入

```
3

-10 2

10 1

10 3

5

-15 -10 -5 0 5
```

### 输出

```
0

0

5

10

10
```



---

---
title: "[ABC197E] Traveler"
layout: "post"
diff: 普及+/提高
pid: AT_abc197_e
tag: []
---

# [ABC197E] Traveler

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc197/tasks/abc197_e

数直線上にボール $ 1 $ からボール $ N $ までの $ N $ 個のボールがあります。  
 ボール $ i $ は座標 $ X_i $ にあります。  
 各ボールには $ 1 $ 以上 $ N $ 以下の整数で表される色がついていて、ボール $ i $ の色は整数 $ C_i $ で表されます。  
 今座標 $ 0 $ にいるあなたは、毎秒 $ 1 $ の速さで数直線上を動き、全てのボールを回収してから再び座標 $ 0 $ に戻ります。  
 このとき、ボールの色を表す整数を回収順に並べた時に広義単調増加となっている必要があります。  
 ボールを回収するにはボールと同じ座標にいる必要がありますが、ボールを回収できる時に必ずしも回収する必要はありません。  
 座標 $ 0 $ を出発してから、全てのボールを回収して再び座標 $ 0 $ に戻るまでにかかる時間の最小値を求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ X_1 $ $ C_1 $ $ X_2 $ $ C_2 $ $ X_3 $ $ C_3 $ $ \hspace{15pt}\ \vdots $ $ X_N $ $ C_N $

## 输出格式

答え \[秒\] を出力せよ。

## 说明/提示

### 制約

- $ 1\ \le\ N\ \le\ 2\ \times\ 10^5 $
- $ |X_i|\ \le\ 10^9 $
- $ X_i\ \neq\ X_j\ (i\ \neq\ j) $
- $ X_i\ \neq\ 0 $
- $ 1\ \le\ C_i\ \le\ N $
- 入力に含まれる値は全て整数である

### Sample Explanation 1

以下のように行動するのが最適です。 - $ 3 $ 秒かけて座標 $ 3 $ に移動し、ボール $ 2 $ を回収する - $ 1 $ 秒かけて座標 $ 2 $ に移動し、ボール $ 1 $ を回収する - $ 2 $ 秒かけて座標 $ 4 $ に移動し、ボール $ 4 $ を回収する - $ 1 $ 秒かけて座標 $ 5 $ に移動し、ボール $ 5 $ を回収する - $ 4 $ 秒かけて座標 $ 1 $ に移動し、ボール $ 3 $ を回収する - $ 1 $ 秒かけて座標 $ 0 $ に戻る ボールの色を表す整数を回収順に並べると $ 1,\ 2,\ 2,\ 3,\ 3 $ と広義単調増加になっています。

## 样例 #1

### 输入

```
5

2 2

3 1

1 3

4 2

5 3
```

### 输出

```
12
```

## 样例 #2

### 输入

```
9

5 5

-4 4

4 3

6 3

-5 5

-3 2

2 2

3 3

1 4
```

### 输出

```
38
```



---

---
title: "[ABC199D] RGB Coloring 2"
layout: "post"
diff: 普及+/提高
pid: AT_abc199_d
tag: []
---

# [ABC199D] RGB Coloring 2

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc199/tasks/abc199_d

$ N $ 頂点 $ M $ 辺の単純無向グラフがあります。頂点には $ 1 $ から $ N $ までの、辺には $ 1 $ から $ M $ までの番号がついています。  
 辺 $ i $ は頂点 $ A_i $ と頂点 $ B_i $ を結んでいます。  
 このグラフの各頂点を赤、緑、青の $ 3 $ 色のいずれかで塗る方法であって、以下の条件を満たすものの数を求めてください。

- 辺で直接結ばれている $ 2 $ 頂点は必ず異なる色で塗られている

なお、使われない色があっても構いません。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ M $ $ A_1 $ $ B_1 $ $ A_2 $ $ B_2 $ $ A_3 $ $ B_3 $ $ \hspace{15pt}\ \vdots $ $ A_M $ $ B_M $

## 输出格式

答えを出力せよ。

## 说明/提示

### 制約

- $ 1\ \le\ N\ \le\ 20 $
- $ 0\ \le\ M\ \le\ \frac{N(N\ -\ 1)}{2} $
- $ 1\ \le\ A_i\ \le\ N $
- $ 1\ \le\ B_i\ \le\ N $
- 与えられるグラフは単純 (多重辺や自己ループを含まない)

### Sample Explanation 1

頂点 $ 1,\ 2,\ 3 $ の色をそれぞれ $ c_1,\ c_2,\ c_3 $ とし、赤、緑、青をそれぞれ `R`, `G`, `B` で表すと、以下の $ 6 $ 通りが条件を満たします。 - $ c_1c_2c_3\ = $ `RGB` - $ c_1c_2c_3\ = $ `RBG` - $ c_1c_2c_3\ = $ `GRB` - $ c_1c_2c_3\ = $ `GBR` - $ c_1c_2c_3\ = $ `BRG` - $ c_1c_2c_3\ = $ `BGR`

### Sample Explanation 2

辺がないため、各頂点の色を自由に決めることができます。

### Sample Explanation 3

条件を満たす塗り方が存在しない場合もあります。

### Sample Explanation 4

答えは $ 32 $ ビット符号付き整数型に収まらないことがあります。

## 样例 #1

### 输入

```
3 3

1 2

2 3

3 1
```

### 输出

```
6
```

## 样例 #2

### 输入

```
3 0
```

### 输出

```
27
```

## 样例 #3

### 输入

```
4 6

1 2

2 3

3 4

2 4

1 3

1 4
```

### 输出

```
0
```

## 样例 #4

### 输入

```
20 0
```

### 输出

```
3486784401
```



---

---
title: "[ABC199E] Permutation"
layout: "post"
diff: 普及+/提高
pid: AT_abc199_e
tag: []
---

# [ABC199E] Permutation

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc199/tasks/abc199_e

$ (1,\ 2,\ 3,\ \dots,\ N) $ を並び替えてできる数列 $ a $ であって、以下の条件を満たすものの数を出力してください。

- $ 1\ \le\ i\ \le\ M $ を満たす全ての整数 $ i $ について、$ a_1,\ a_2,\ a_3,\ \dots,\ a_{X_i} $ の中に $ Y_i $ 以下の数は $ Z_i $ 個以下しか存在しない

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ M $ $ X_1 $ $ Y_1 $ $ Z_1 $ $ X_2 $ $ Y_2 $ $ Z_2 $ $ X_3 $ $ Y_3 $ $ Z_3 $ $ \hspace{23pt}\ \vdots $ $ X_M $ $ Y_M $ $ Z_M $

## 输出格式

答えを出力せよ。

## 说明/提示

### 制約

- $ 2\ \le\ N\ \le\ 18 $
- $ 0\ \le\ M\ \le\ 100 $
- $ 1\ \le\ X_i\ \lt\ N $
- $ 1\ \le\ Y_i\ \lt\ N $
- $ 0\ \le\ Z_i\ \lt\ N $
- 入力に含まれる値は全て整数である

### Sample Explanation 1

条件を満たす $ a $ は以下の $ 4 $ つです。 - $ (1,\ 3,\ 2) $ - $ (2,\ 3,\ 1) $ - $ (3,\ 1,\ 2) $ - $ (3,\ 2,\ 1) $ $ (1,\ 2,\ 3) $ や $ (2,\ 1,\ 3) $ は、$ a_1,\ a_2 $ の中に $ 2 $ 以下の数が $ 2 $ つあるため条件を満たしません。

## 样例 #1

### 输入

```
3 1

2 2 1
```

### 输出

```
4
```

## 样例 #2

### 输入

```
5 2

3 3 2

4 4 3
```

### 输出

```
90
```

## 样例 #3

### 输入

```
18 0
```

### 输出

```
6402373705728000
```



---

---
title: "[ABC201D] Game in Momotetsu World"
layout: "post"
diff: 普及+/提高
pid: AT_abc201_d
tag: []
---

# [ABC201D] Game in Momotetsu World

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc201/tasks/abc201_d

$ H $ 行 $ W $ 列のマス目があり、各マスは青マスまたは赤マスのどちらかです。上から $ i $ 番目、左から $ j $ 番目のマスは、$ A_{i,\ j} $ が `+` なら青マスであり、`-` なら赤マスです。  
 最初、このマス目の一番左上のマスに一つ駒が置かれていて、高橋君と青木君はこの駒を使ってゲームをします。  
 $ 2 $ 人の得点は最初 $ 0 $ 点ずつです。$ 2 $ 人は、高橋君から始めて交互に次の操作をします。

- 駒を一つ右または一つ下のマスに動かす。ただし、駒がマス目の外に出るような動かし方はできない。動かした人は、駒の移動後のマスが青マスなら $ 1 $ 点を得て、赤マスなら $ 1 $ 点を失う。

どちらかが操作できなくなった時点でゲームは終了します。ゲームの結果は、終了時の $ 2 $ 人の得点が異なるならば得点の大きい方が勝ち、同じならば引き分けとなります。  
 両者とも自分の勝敗が最適になるように行動したとき、ゲームの結果を求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ H $ $ W $ $ A_{1,\ 1}A_{1,\ 2}A_{1,\ 3}\ \dots\ A_{1,\ W} $ $ A_{2,\ 1}A_{2,\ 2}A_{2,\ 3}\ \dots\ A_{2,\ W} $ $ A_{3,\ 1}A_{3,\ 2}A_{3,\ 3}\ \dots\ A_{3,\ W} $ $ \hspace{2cm}\vdots $ $ A_{H,\ 1}A_{H,\ 2}A_{H,\ 3}\ \dots\ A_{H,\ W} $

## 输出格式

高橋君が勝つなら `Takahashi` を、青木君が勝つなら `Aoki` を、引き分けになるなら `Draw` を出力せよ。

## 说明/提示

### 制約

- $ 1\ \le\ H,\ W\ \le\ 2000 $
- $ A_{i,\ j} $ は `+` または `-`

### Sample Explanation 1

高橋君は以下のような戦略で勝つことができます。 まず高橋君が最初に駒を右に動かします。移動先のマスは赤マスなので高橋君は $ 1 $ 点を失い、高橋君と青木君の得点はそれぞれ $ -1,\ 0 $ となります。 - 青木君が次に駒を右に動かしたなら、高橋君は駒を下に動かします - 青木君が次に駒を下に動かしたなら、高橋君は駒を右に動かします いずれの場合でも青木君は赤マスに駒を動かして $ 1 $ 点を失い、高橋君は青マスに駒を動かして $ 1 $ 点を得るため、両者の得点はそれぞれ $ 0,\ -1 $ となります。 現在駒はマス目の上から $ 2 $ 番目、左から $ 3 $ 番目のマスにあるので、次の移動では青木君は下に動かすほかなく、移動先が赤マスなので両者の得点はそれぞれ $ 0,\ -2 $ となります。 もう駒は右にも下にも動かせないのでゲームは終了し、得点の大きい高橋君が勝利します。

### Sample Explanation 2

青木君は、高橋君がどのように操作しても、上手く操作すれば勝つことができます。

### Sample Explanation 3

この場合ゲームは直ちに終了し、両者得点 $ 0 $ であるため結果は引き分けとなります。

## 样例 #1

### 输入

```
3 3

---

+-+

+--
```

### 输出

```
Takahashi
```

## 样例 #2

### 输入

```
2 4

+++-

-+-+
```

### 输出

```
Aoki
```

## 样例 #3

### 输入

```
1 1

-
```

### 输出

```
Draw
```



---

---
title: "[ABC201E] Xor Distances"
layout: "post"
diff: 普及+/提高
pid: AT_abc201_e
tag: []
---

# [ABC201E] Xor Distances

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc201/tasks/abc201_e

$ N $ 頂点の重み付き木があります。$ i $ 本目の辺は頂点 $ u_i $ と頂点 $ v_i $ を双方向に結んでいて、その重みは $ w_i $ です。

頂点の組 $ (x,y) $ について、$ \text{dist}(x,y) $ を以下のように定めます。

- $ x $ から $ y $ への最短パスに含まれる辺全ての重みの **XOR**

$ 1\ \leq\ i\ \lt\ j\ \leq\ N $ を満たす全ての組 $ (i,j) $ について $ \text{dist}(i,j) $ を求め、その総和を $ (10^9+7) $ で割った余りを出力してください。

 $ \text{\ XOR\ } $ とは 整数 $ a,\ b $ のビットごとの排他的論理和 $ a\ \text{\ XOR\ }\ b $ は、以下のように定義されます。

- $ a\ \text{\ XOR\ }\ b $ を二進表記した際の $ 2^k $ ($ k\ \geq\ 0 $) の位の数は、$ a,\ b $ を二進表記した際の $ 2^k $ の位の数のうち一方のみが $ 1 $ であれば $ 1 $、そうでなければ $ 0 $ である。
 
 例えば、$ 3\ \text{\ XOR\ }\ 5\ =\ 6 $ となります (二進表記すると: $ 011\ \text{\ XOR\ }\ 101\ =\ 110 $)。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ u_1 $ $ v_1 $ $ w_1 $ $ u_2 $ $ v_2 $ $ w_2 $ $ \vdots $ $ u_{N-1} $ $ v_{N-1} $ $ w_{N-1} $

## 输出格式

$ \text{dist}(i,j) $ の総和を $ (10^9+7) $ で割った余りを出力せよ。

## 说明/提示

### 制約

- $ 2\ \leq\ N\ \leq\ 2\ \times\ 10^5 $
- $ 1\ \leq\ u_i\ \lt\ v_i\ \leq\ N $
- $ 0\ \leq\ w_i\ \lt\ 2^{60} $
- 与えられるグラフは木
- 入力は全て整数

### Sample Explanation 1

$ \text{dist}(1,2)=1, $ $ \text{dist}(1,3)=3, $ $ \text{dist}(2,3)=2 $ であり、これらの総和は $ 6 $ です。

### Sample Explanation 3

$ (10^9+7) $ で割った余りを出力してください。

## 样例 #1

### 输入

```
3

1 2 1

1 3 3
```

### 输出

```
6
```

## 样例 #2

### 输入

```
5

3 5 2

2 3 2

1 5 1

4 5 13
```

### 输出

```
62
```

## 样例 #3

### 输入

```
10

5 7 459221860242673109

6 8 248001948488076933

3 5 371922579800289138

2 5 773108338386747788

6 10 181747352791505823

1 3 803225386673329326

7 8 139939802736535485

9 10 657980865814127926

2 4 146378247587539124
```

### 输出

```
241240228
```



---

---
title: "[ABC202E] Count Descendants"
layout: "post"
diff: 普及+/提高
pid: AT_abc202_e
tag: []
---

# [ABC202E] Count Descendants

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc202/tasks/abc202_e

$ N $ 頂点の根付き木があり、頂点は $ 1,\ 2,\ \dots,\ N $ と番号付けられています。

頂点 $ 1 $ が根であり、頂点 $ i\ \,\ (2\ \leq\ i\ \leq\ N) $ の親は $ P_i $ です。

$ Q $ 個のクエリが与えられます。$ i\ \,\ (1\ \leq\ i\ \leq\ Q) $ 番目のクエリでは、整数 $ U_i,\ D_i $ が与えられるので、次の条件を全て満たす頂点 $ u $ の個数を求めてください。

- $ u $ から根への最短パス上（端点も含む）に頂点 $ U_i $ が存在する。
- $ u $ から根への最短パスに含まれる辺の数が**ちょうど** $ D_i $ である。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ P_2 $ $ P_3 $ $ \ldots $ $ P_N $ $ Q $ $ U_1 $ $ D_1 $ $ U_2 $ $ D_2 $ $ \vdots $ $ U_Q $ $ D_Q $

## 输出格式

$ Q $ 行出力せよ。 $ i $ 行目には $ i $ 番目のクエリに対する答えを出力せよ。

## 说明/提示

### 制約

- $ 2\ \leq\ N\ \leq\ 2\ \times\ 10^5 $
- $ 1\ \leq\ P_i\ <\ i $
- $ 1\ \leq\ Q\ \leq\ 2\ \times\ 10^5 $
- $ 1\ \leq\ U_i\ \leq\ N $
- $ 0\ \leq\ D_i\ \leq\ N\ -\ 1 $
- 入力は全て整数である。

### Sample Explanation 1

$ 1 $ 番目のクエリでは、頂点 $ 4,\ 5,\ 7 $ が条件を満たします。 $ 2 $ 番目のクエリでは、頂点 $ 7 $ のみが条件を満たします。 $ 3 $ 番目、$ 4 $ 番目のクエリでは、条件を満たす頂点は存在しません。 !\[sample\](https://img.atcoder.jp/ghi/abc202\_e\_sample\_00.jpg)

## 样例 #1

### 输入

```
7

1 1 2 2 4 2

4

1 2

7 2

4 1

5 5
```

### 输出

```
3

1

0

0
```



---

---
title: "[ABC203D] Pond"
layout: "post"
diff: 普及+/提高
pid: AT_abc203_d
tag: []
---

# [ABC203D] Pond

## 题目描述

### 题目大意

给定一个 $n\times n$ 的矩阵 $A$，再给定一个数 $k$，求矩阵中所有大小为 $k\times k$ 的子矩阵的中位数的最小值。

一个 $k\times k$ 的矩阵的中位数被定义为将矩阵中的所有数从大到小排序后的第 $\lfloor\frac{k^2}{2}\rfloor+1$ 个数。

## 输入格式

第一行两个正整数 $n,k$。

接下来 $n$ 行，每行 $n$ 个数，描述了一个矩阵。

## 输出格式

输出一行一个数，表示中位数的最小值。

## 说明/提示

$1\le k\le n\le 800,0\le A_{i,j}\le 10^9$。

Translated by \_Ponder_

## 样例 #1

### 输入

```
3 2

1 7 0

5 8 11

10 4 2
```

### 输出

```
4
```

## 样例 #2

### 输入

```
3 3

1 2 3

4 5 6

7 8 9
```

### 输出

```
5
```



---

---
title: "[ABC203E] White Pawn"
layout: "post"
diff: 普及+/提高
pid: AT_abc203_e
tag: []
---

# [ABC203E] White Pawn

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc203/tasks/abc203_e

$ N $ を正の整数とします。 行と列にそれぞれ $ 0 $ から $ 2N $ までの番号が付いた $ (2N+1)\times\ (2N+1) $ のマス目があり、行 $ i $ かつ列 $ j $ に属するマスを $ (i,j) $ で表します。

白のポーンが $ 1 $ つあり、最初 $ (0,N) $ に置かれています。 黒のポーンは $ M $ 個あり、$ i $ 個目の黒のポーンは $ (X_i,\ Y_i) $ に置かれています。

白のポーンが $ (i,j) $ にあるとき、あなたは以下のいずれかの操作で白のポーンを動かすことができます。

- $ 0\leq\ i\leq\ 2N-1 $, $ 0\ \leq\ j\leq\ 2N $ を満たし、$ (i+1,j) $ に黒のポーンが**無い**ならば、白のポーンを $ (i+1,j) $ に動かす。
- $ 0\leq\ i\leq\ 2N-1 $, $ 0\ \leq\ j\leq\ 2N-1 $ を満たし、$ (i+1,j+1) $ に黒のポーンが**有る**ならば、白のポーンを $ (i+1,j+1) $ に動かす。
- $ 0\leq\ i\leq\ 2N-1 $, $ 1\ \leq\ j\leq\ 2N $ を満たし、$ (i+1,j-1) $ に黒のポーンが**有る**ならば、白のポーンを $ (i+1,j-1) $ に動かす。

黒のポーンは動かすことができません。

この操作を繰り返した結果、$ (2N,Y) $ に白のポーンが置かれている状態にできるような $ Y $ の値としてあり得るものの個数を求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ M $ $ X_1 $ $ Y_1 $ $ : $ $ X_M $ $ Y_M $

## 输出格式

答えを出力せよ。

## 说明/提示

### 制約

- $ 1\ \leq\ N\ \leq\ 10^9 $
- $ 0\ \leq\ M\ \leq\ 2\times\ 10^5 $
- $ 1\ \leq\ X_i\ \leq\ 2N $
- $ 0\ \leq\ Y_i\ \leq\ 2N $
- $ (X_i,\ Y_i)\ \neq\ (X_j,\ Y_j) $ $ (i\ \neq\ j) $
- 入力は全て整数である。

### Sample Explanation 1

$ (4,0) $, $ (4,1) $, $ (4,2) $ の $ 3 $ つへはそれぞれ次のように動かせます: - $ (0,2)\to\ (1,1)\to\ (2,1)\to\ (3,1)\to\ (4,2) $ - $ (0,2)\to\ (1,1)\to\ (2,1)\to\ (3,1)\to\ (4,1) $ - $ (0,2)\to\ (1,1)\to\ (2,0)\to\ (3,0)\to\ (4,0) $ 一方、 $ (4,3) $ と $ (4,4) $ へは動かすことができません。 よって、 $ 3 $ を出力します。

### Sample Explanation 2

白のポーンを $ (0,1) $ から動かすことはできません。

## 样例 #1

### 输入

```
2 4

1 1

1 2

2 0

4 2
```

### 输出

```
3
```

## 样例 #2

### 输入

```
1 1

1 1
```

### 输出

```
0
```



---

---
title: "[ABC204E] Rush Hour 2"
layout: "post"
diff: 普及+/提高
pid: AT_abc204_e
tag: []
---

# [ABC204E] Rush Hour 2

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc204/tasks/abc204_e

AtCoder国には $ N $ 個の都市と $ M $ 本の道路があります。

都市には $ 1 $ から $ N $ の番号が、道路には $ 1 $ から $ M $ の番号が振られています。道路 $ i $ は都市 $ A_i $ と都市 $ B_i $ を双方向に結びます。

AtCoder国には時刻 $ 0 $ をピークとするラッシュアワーがあり、時刻 $ t $ に道路 $ i $ の通行を始めると、移動するのに $ C_i+\ \left\lfloor\ \frac{D_i}{t+1}\ \right\rfloor $ の時間がかかります。 ( $ \lfloor\ x\rfloor $ は $ x $ を超えない最大の整数を表す)

高橋君は時刻 $ 0 $ またはそれ以降の **整数時刻に** 都市 $ 1 $ を出発して、道路を通行することで都市 $ N $ へ向かおうとしています。

高橋君が各都市で **整数時間** 待機することができるとき、高橋君が都市 $ N $ に到達することができる最も早い時刻を出力してください。なお、制約の下で答えは整数になることが証明できます。

ただし、都市 $ N $ に到達できないときはかわりに `-1` を出力してください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ M $ $ A_1 $ $ B_1 $ $ C_1 $ $ D_1 $ $ \vdots $ $ A_M $ $ B_M $ $ C_M $ $ D_M $

## 输出格式

高橋君が都市 $ N $ に到達することができる最も早い時刻を整数で出力せよ。ただし、都市 $ N $ に到達できないときはかわりに `-1` を出力せよ。

## 说明/提示

### 制約

- $ 2\ \leq\ N\ \leq\ 10^5 $
- $ 0\ \leq\ M\ \leq\ 10^5 $
- $ 1\ \leq\ A_i,B_i\ \leq\ N $
- $ 0\ \leq\ C_i,D_i\ \leq\ 10^9 $
- 入力は全て整数

### Sample Explanation 1

最初に都市 $ 1 $ で時刻 $ 1 $ まで待機します。そして時刻 $ 1 $ に道路 $ 1 $ を使って移動をすると、移動に $ 2+\left\lfloor\ \frac{3}{1+1}\ \right\rfloor\ =\ 3 $ の時間がかかり、都市 $ 2 $ には時刻 $ 4 $ に到着することができます。 時刻 $ 4 $ より早く都市 $ 2 $ に到着することはできません。

### Sample Explanation 2

同じ都市の組を結ぶ道路が複数ある場合や、同じ都市に戻ってくる道路がある場合もあります。

### Sample Explanation 3

都市 $ 1 $ から都市 $ N $ に至る経路がないこともあります。

## 样例 #1

### 输入

```
2 1

1 2 2 3
```

### 输出

```
4
```

## 样例 #2

### 输入

```
2 3

1 2 2 3

1 2 2 1

1 1 1 1
```

### 输出

```
3
```

## 样例 #3

### 输入

```
4 2

1 2 3 4

3 4 5 6
```

### 输出

```
-1
```

## 样例 #4

### 输入

```
6 9

1 1 0 0

1 3 1 2

1 5 2 3

5 2 16 5

2 6 1 10

3 4 3 4

3 5 3 10

5 6 1 100

4 2 0 110
```

### 输出

```
20
```



---

---
title: "[ABC206E] Divide Both"
layout: "post"
diff: 普及+/提高
pid: AT_abc206_e
tag: []
---

# [ABC206E] Divide Both

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc206/tasks/abc206_e

整数 $ L,R\ (L\ \le\ R) $ が与えられるので、以下の条件を全て満たす整数組 $ (x,y) $ の数を求めてください。

- $ L\ \le\ x,y\ \le\ R $
- $ g $ を $ x,y $ の最大公約数とすると、以下が成立する。
  - $ g\ \neq\ 1 $ かつ $ \frac{x}{g}\ \neq\ 1 $ かつ $ \frac{y}{g}\ \neq\ 1 $

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ L $ $ R $

## 输出格式

答えを整数として出力せよ。

## 说明/提示

### 制約

- 入力は全て整数
- $ 1\ \le\ L\ \le\ R\ \le\ 10^6 $

### Sample Explanation 1

いくつかの整数組を例として示します。 - $ (x,y)=(4,6) $ は条件を満たします。 - $ (x,y)=(7,5) $ は $ g=1 $ となり、条件に違反します。 - $ (x,y)=(6,3) $ は $ \frac{y}{g}=1 $ となり、条件に違反します。 条件を満たすのは $ (x,y)=(4,6),(6,4) $ の $ 2 $ 組です。

## 样例 #1

### 输入

```
3 7
```

### 输出

```
2
```

## 样例 #2

### 输入

```
4 10
```

### 输出

```
12
```

## 样例 #3

### 输入

```
1 1000000
```

### 输出

```
392047955148
```



---

---
title: "[ABC207E] Mod i"
layout: "post"
diff: 普及+/提高
pid: AT_abc207_e
tag: []
---

# [ABC207E] Mod i

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc207/tasks/abc207_e

長さ $ N $ の数列 $ A $ が与えられます。$ A $ をいくつかの連続した空でない部分列 $ B_1,B_2,\ldots,B_k $ に切り分ける方法であって、以下の条件を満たすものの個数を求めてください。

- 全ての $ i\ (1\ \leq\ i\ \leq\ k) $ について、$ B_i $ に含まれる要素の総和が $ i $ で割り切れる。

答えは非常に大きくなることがあるので、$ (10^9+7) $ で割ったあまりを出力してください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ A_1 $ $ A_2 $ $ \ldots $ $ A_N $

## 输出格式

問題文中の条件を満たすような切り分け方の個数を $ (10^9+7) $ で割ったあまりを出力せよ。

## 说明/提示

### 制約

- $ 1\ \leq\ N\ \leq\ 3000 $
- $ 1\ \leq\ A_i\ \leq\ 10^{15} $
- 入力は全て整数

### Sample Explanation 1

以下の $ 3 $ 通りの切り分け方があります。 - $ (1),(2),(3),(4) $ - $ (1,2,3),(4) $ - $ (1,2,3,4) $

### Sample Explanation 3

入力が $ 32 $ bit 整数型に収まりきらない場合があります。

## 样例 #1

### 输入

```
4

1 2 3 4
```

### 输出

```
3
```

## 样例 #2

### 输入

```
5

8 6 3 3 3
```

### 输出

```
5
```

## 样例 #3

### 输入

```
10

791754273866483 706434917156797 714489398264550 918142301070506 559125109706263 694445720452148 648739025948445 869006293795825 718343486637033 934236559762733
```

### 输出

```
15
```



---

---
title: "[ABC208D] Shortest Path Queries 2"
layout: "post"
diff: 普及+/提高
pid: AT_abc208_d
tag: []
---

# [ABC208D] Shortest Path Queries 2

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc208/tasks/abc208_d

高橋王国には $ N $ 個の都市と $ M $ 本の道路があります。

都市には $ 1 $ から $ N $ の番号が、道路には $ 1 $ から $ M $ の番号が割り振られています。道路 $ i $ は都市 $ A_i $ から $ B_i $ へ向かう**一方通行**の道で、移動するのに $ C_i $ 分かかります。

$ f(s,\ t,\ k) $ を次のクエリへの答えとして定めます。

- 都市 $ s $ を出発して都市 $ t $ に到着するまでの最短時間を計算してください。ただし、通ってよい都市は $ s,\ t $ および番号が $ k $ 以下の都市のみとします。また、都市 $ t $ に到着できない場合や $ s\ =\ t $ である場合におけるクエリの答えは $ 0 $ とします。

全ての $ s,t,k $ に対して $ f(s,t,k) $ を計算して総和を出力してください。より厳密には、$ \displaystyle\ \sum_{s\ =\ 1}^N\ \sum_{t\ =\ 1}^N\ \sum_{k\ =\ 1}^N\ f(s,\ t,\ k) $ を出力してください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ M $ $ A_1 $ $ B_1 $ $ C_1 $ $ \vdots $ $ A_M $ $ B_M $ $ C_M $

## 输出格式

$ \displaystyle\ \sum_{s\ =\ 1}^N\ \sum_{t\ =\ 1}^N\ \sum_{k\ =\ 1}^N\ f(s,\ t,\ k) $ を出力せよ。

## 说明/提示

### 制約

- $ 1\ \leq\ N\ \leq\ 400 $
- $ 0\ \leq\ M\ \leq\ N(N-1) $
- $ 1\ \leq\ A_i\ \leq\ N $ $ (1\ \leq\ i\ \leq\ M) $
- $ 1\ \leq\ B_i\ \leq\ N $ $ (1\ \leq\ i\ \leq\ M) $
- $ A_i\ \neq\ B_i $ $ (1\ \leq\ i\ \leq\ M) $
- $ 1\ \leq\ C_i\ \leq\ 10^6 $ $ (1\ \leq\ i\ \leq\ M) $
- $ i\ \neq\ j $ ならば $ A_i\ \neq\ A_j $ または $ B_i\ \neq\ B_j $ である。
- 入力は全て整数である。

### Sample Explanation 1

$ f(s,t,k)\ \neq\ 0 $ であるような $ s,t,k $ を以下に挙げます。 - $ k\ =\ 1 $ のとき：$ f(1,2,1)\ =\ 3,\ f(2,3,1)\ =\ 2 $ - $ k\ =\ 2 $ のとき：$ f(1,2,2)\ =\ 3,\ f(2,3,2)\ =\ 2,\ f(1,3,2)\ =\ 5 $ - $ k\ =\ 3 $ のとき：$ f(1,2,3)\ =\ 3,\ f(2,3,3)\ =\ 2,\ f(1,3,3)\ =\ 5 $

### Sample Explanation 2

全ての $ s,t,k $ に対して $ f(s,t,k)\ =\ 0 $ です。

## 样例 #1

### 输入

```
3 2

1 2 3

2 3 2
```

### 输出

```
25
```

## 样例 #2

### 输入

```
3 0
```

### 输出

```
0
```

## 样例 #3

### 输入

```
5 20

1 2 6

1 3 10

1 4 4

1 5 1

2 1 5

2 3 9

2 4 8

2 5 6

3 1 5

3 2 1

3 4 7

3 5 9

4 1 4

4 2 6

4 3 4

4 5 8

5 1 2

5 2 5

5 3 6

5 4 5
```

### 输出

```
517
```



---

---
title: "[ABC210D] National Railway"
layout: "post"
diff: 普及+/提高
pid: AT_abc210_d
tag: []
---

# [ABC210D] National Railway

## 题目描述

## 题目翻译

国王想在他 $ H $ 行 $ W $ 列的国土上建铁路  
具体地，建铁路的花费可以表示为两部分：建车站和建轨道。  
- 在 $ (i,\ j) $ 处建车站的费用表示为 $ A_{i,j} $  
- 连接 $ (i,\ j) $ 处的车站和 $ (i',\ j') $ 处车站之间铁路的花费为 $ C\ \times\ (|i-i'|\ +\ |j-j'|) $  

由于不修铁路会下台，而国王又没有太多钱，所以想知道在不考虑便利性的前提下修铁路的最小花费。

## 输入格式

>第一行三个整数 $ H $ $ W $ $ C $  
 接下来 $ H $ 行 $ W $ 列表示在各地建车站的费用

## 输出格式

>最小花费

## 样例 #1

### 输入

```
3 4 2

1 7 7 9

9 6 3 7

7 8 6 4
```

### 输出

```
10
```

## 样例 #2

### 输入

```
3 3 1000000000

1000000 1000000 1

1000000 1000000 1000000

1 1000000 1000000
```

### 输出

```
1001000001
```



---

---
title: "[ABC210E] Ring MST"
layout: "post"
diff: 普及+/提高
pid: AT_abc210_e
tag: []
---

# [ABC210E] Ring MST

## 题目描述

- 给定一张 $n$ 个点的图，顶点的编号为 $[0, n - 1]$，同时给出两个长度为 $m$ 的数组 $a_1, a_2, \cdots, a_m$ 和 $b_1, b_2, \cdots, b_m$。

- 初始时图中并没有任何边，你可以按照以下操作加边：选择一个 $1 \le i \le m$ 和一个 $0 \le x < n$，并在顶点 $x$ 和顶点 $(x + a_i) \bmod n$ 中添加一条长度为 $b_i$ 的边。

- 你现在想要知道，你添加的边的长度总和至少为多少，才能使得整个图连通?如果无论如何都不能使整个图连通，输出 `-1`。

## 输入格式

- 第一行包含两个整数 $n, m$，分别表示图的顶点个数和数组的数组的长度。

- 接下来 $m$ 行，第 $i$ 行包含两个整数 $a_i, b_i\space(1 \le a_i \le n - 1)$。

## 输出格式

- 输出一个数，表示答案。

## 说明/提示

- 对于 $30 \%$ 的数据：$1 \le n, m \le 1000, 1 \le b_i \le 10^9$。

- 对于 $60 \%$ 的数据：$1 \le n, m \le 10^5, 1 \le b_i \le 10^9$。

- 对于 $100 \%$ 的数据：$1 \le n \le 10^9, 1 \le m \le 10^5, 1 \le b_i \le 10^9$。

翻译提供者：[Sunrize](https://www.luogu.com.cn/user/502658)。

## 样例 #1

### 输入

```
4 2

2 3

3 5
```

### 输出

```
11
```

## 样例 #2

### 输入

```
6 1

3 4
```

### 输出

```
-1
```



---

---
title: "[ABC211E] Red Polyomino"
layout: "post"
diff: 普及+/提高
pid: AT_abc211_e
tag: []
---

# [ABC211E] Red Polyomino

## 题目描述

## 题目翻译
&emsp;给你边长为 $ N $ 的且仅由字符 `#` 和 `.` 组成的正方形阵列，其中 `#` 表示黑色格子， `.` 表示白色格子。  
&emsp;你需要在白色格子中选择 $ K $ 个涂成红色，且使红色格子互相连接（仅包括上下左右相邻），求有多少种可能的方案。

## 输入格式

第一行一个整数 $ N $  
第二行一个整数 $ K $ 
以下 $ N $ 行每行 $ N $ 个字符表示给出的阵列

## 输出格式

可能的答案

## 样例 #1

### 输入

```
3

5

#.#

...

..#
```

### 输出

```
5
```

## 样例 #2

### 输入

```
2

2

#.

.#
```

### 输出

```
0
```

## 样例 #3

### 输入

```
8

8

........

........

........

........

........

........

........

........
```

### 输出

```
64678
```



---

---
title: "[ABC212E] Safety Journey"
layout: "post"
diff: 普及+/提高
pid: AT_abc212_e
tag: []
---

# [ABC212E] Safety Journey

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc212/tasks/abc212_e

AtCoder国には $ N $ 個の都市があり、都市 $ 1 $ , 都市 $ 2 $ , $ \ldots $ , 都市 $ N $ と番号付けられています。 最初、どの $ 2 $ つの相異なる都市の間も双方向に通れる道で結ばれていましたが、老朽化が進み、これらのうち $ M $ 本の道が使えなくなってしまいました。具体的には $ 1\leq\ i\ \leq\ M $ について都市 $ U_i $ と都市 $ V_i $ を結ぶ道が使えなくなってしまいました。

いま、高橋君は都市 $ 1 $ で始まり、都市 $ 1 $ で終わる $ K $ 日間の旅をしようと考えました。都市 $ 1 $ で始まり、都市 $ 1 $ で終わる $ K $ 日間の旅とは、 $ K+1 $ 個の都市の列 $ (A_0,\ A_1,\ \ldots,\ A_K) $ であって、$ A_0=A_K=1 $ をみたし、 $ 0\leq\ i\leq\ K-1 $ について $ A_i $ と $ A_{i+1} $ が相異なり、かつ都市 $ A_i $ と都市 $ A_{i+1} $ が現在も使用可能な道で結ばれているものを指します。

都市 $ 1 $ で始まり、都市 $ 1 $ で終わる $ K $ 日間の相異なる旅の数を $ 998244353 $ で割った余りを出力してください。ただし、 $ 2 $ つの $ K $ 日間の旅 $ (A_0,\ A_1,\ \ldots,\ A_K) $ と $ (B_0,\ B_1,\ \ldots,\ B_K) $ が相異なるとは、ある $ i $ が存在して $ A_i\neq\ B_i $ となることを言います。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ M $ $ K $ $ U_1 $ $ V_1 $ $ : $ $ U_M $ $ V_M $

## 输出格式

答えを出力せよ。

## 说明/提示

### 制約

- $ 2\ \leq\ N\ \leq\ 5000 $
- $ 0\ \leq\ M\ \leq\ \min\left(\ \frac{N(N-1)}{2},5000\ \right) $
- $ 2\ \leq\ K\ \leq\ 5000 $
- $ 1\ \leq\ U_i\ <\ V_i\ \leq\ N $
- $ (U_i,\ V_i) $ は全て互いに相異なる。
- 入力は全て整数である。

### Sample Explanation 1

次のような $ 4 $ 種類の旅が存在します。 - ($ 1,2,1,2,1 $) - ($ 1,2,1,3,1 $) - ($ 1,3,1,2,1 $) - ($ 1,3,1,3,1 $) これ以外に条件をみたすようなものは無いため、 $ 4 $ を出力します。

### Sample Explanation 2

使える道が $ 1 $ 本も残っておらず、条件をみたすような旅は存在しません。

## 样例 #1

### 输入

```
3 1 4

2 3
```

### 输出

```
4
```

## 样例 #2

### 输入

```
3 3 3

1 2

1 3

2 3
```

### 输出

```
0
```

## 样例 #3

### 输入

```
5 3 100

1 2

4 5

2 3
```

### 输出

```
428417047
```



---

---
title: "[ABC213E] Stronger Takahashi"
layout: "post"
diff: 普及+/提高
pid: AT_abc213_e
tag: []
---

# [ABC213E] Stronger Takahashi

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc213/tasks/abc213_e

$ H $ 行 $ W $ 列の格子状の区画に区切られた街があります。上から $ i $ 行目、左から $ j $ 列目の区画は、$ S_{i,j} $ が `.` のとき道、`#` のとき塀です。

高橋君は自分の家から魚屋に買い物に行くことにしました。高橋君の家は街の左上隅の区画にあり、魚屋は街の右下隅の区画にあります。

高橋君は、自分がいる区画から上下左右に隣接する道の区画に移動することができます。街の外に出ることはできません。  
 塀の区画に移動することはできませんが、高橋君は非常に腕力が強いため、パンチを $ 1 $ 回繰り出すことで任意の $ 2\times\ 2 $ の区画内の塀を壊して道にすることができます。

高橋君が魚屋にたどり着くためには、最低何回パンチを繰り出せばよいか求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ H $ $ W $ $ S_{1,1}\ \ldots\ S_{1,W} $ $ \vdots $ $ S_{H,1}\ \ldots\ S_{H,W} $

## 输出格式

答えを出力せよ。

## 说明/提示

### 制約

- $ 2\ \leq\ H,W\ \leq\ 500 $
- $ H,W $ は整数
- $ S_{i,j} $ は `.` または `#`
- $ S_{1,1} $ と $ S_{H,W} $ は `.`

### Sample Explanation 1

例えば、以下の `\*` で表す $ 2\times\ 2 $ の区画にある塀を破壊すると魚屋にたどり着くことができます。 ``` ..#.. #.\*\*# ##\*\*# #.#.# ..#.. ``` 破壊対象の $ 2\ \times\ 2 $ の区画の全てが塀である必要はありません。

### Sample Explanation 2

遠回りが必要ですが、塀を破壊することなく魚屋にたどり着くことができます。

## 样例 #1

### 输入

```
5 5

..#..

#.#.#

##.##

#.#.#

..#..
```

### 输出

```
1
```

## 样例 #2

### 输入

```
5 7

.......

######.

.......

.######

.......
```

### 输出

```
0
```

## 样例 #3

### 输入

```
8 8

.#######

########

########

########

########

########

########

#######.
```

### 输出

```
5
```



---

---
title: "[ABC214D] Sum of Maximum Weights"
layout: "post"
diff: 普及+/提高
pid: AT_abc214_d
tag: []
---

# [ABC214D] Sum of Maximum Weights

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc214/tasks/abc214_d

$ N $ 頂点の木があり、頂点は $ 1,\ 2,\ \dots,\ N $ と番号付けられています。  
 $ i\ \,\ (1\ \leq\ i\ \leq\ N\ -\ 1) $ 番目の辺は頂点 $ u_i $ と頂点 $ v_i $ を結び、重みは $ w_i $ です。

異なる頂点 $ u,\ v $ に対し、頂点 $ u $ から頂点 $ v $ までの最短パスに含まれる辺の重みの最大値を $ f(u,\ v) $ とおきます。

$ \displaystyle\ \sum_{i\ =\ 1}^{N\ -\ 1}\ \sum_{j\ =\ i\ +\ 1}^N\ f(i,\ j) $ を求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ u_1 $ $ v_1 $ $ w_1 $ $ \vdots $ $ u_{N\ -\ 1} $ $ v_{N\ -\ 1} $ $ w_{N\ -\ 1} $

## 输出格式

答えを出力せよ。

## 说明/提示

### 制約

- $ 2\ \leq\ N\ \leq\ 10^5 $
- $ 1\ \leq\ u_i,\ v_i\ \leq\ N $
- $ 1\ \leq\ w_i\ \leq\ 10^7 $
- 与えられるグラフは木である。
- 入力は全て整数である。

### Sample Explanation 1

$ f(1,\ 2)\ =\ 10,\ f(2,\ 3)\ =\ 20,\ f(1,\ 3)\ =\ 20 $ であるので、これらの和である $ 50 $ を出力します。

## 样例 #1

### 输入

```
3

1 2 10

2 3 20
```

### 输出

```
50
```

## 样例 #2

### 输入

```
5

1 2 1

2 3 2

4 2 5

3 5 14
```

### 输出

```
76
```



---

---
title: "[ABC214E] Packing Under Range Regulations"
layout: "post"
diff: 普及+/提高
pid: AT_abc214_e
tag: []
---

# [ABC214E] Packing Under Range Regulations

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc214/tasks/abc214_e

$ T $ 個のテストケースについて、以下の問題を解いてください。

$ 1,2,\dots,10^9 $ の番号がついた $ 10^9 $ 個の箱と、 $ 1,2,\dots,N $ の番号がついた $ N $ 個のボールがあります。  
 それぞれの箱に入れることのできるボールの個数は多くとも $ 1 $ 個です。  
 以下の条件を満たすように、 $ N $ 個のボールを全て箱に入れることができるか判定してください。

- 全ての $ 1 $ 以上 $ N $ 以下の整数 $ i $ について、番号 $ i $ のボールが $ L_i $ 以上 $ R_i $ 以下の番号がついた箱に入っている。

## 输入格式

入力は標準入力から与えられる。入力の $ 1 $ 行目は以下の形式である。

> $ T $

その後、 $ T $ 個のテストケースが続く。各テストケースは以下の形式で与えられる。

> $ N $ $ L_1 $ $ R_1 $ $ L_2 $ $ R_2 $ $ \dots $ $ L_N $ $ R_N $

## 输出格式

出力は $ T $ 行からなる。  
 $ i(1\ \le\ i\ \le\ T) $ 行目には、 $ i $ 番目に入力されたテストケースについて、問題文中の条件を満たすように $ N $ 個のボールを全て箱に入れることができるなら `Yes` 、そうでないなら `No` と出力せよ。  
 なお、正誤判定器は英大文字と英小文字を区別せず、どちらも受理する。

## 说明/提示

### 制約

- $ 1\ \le\ T\ \le\ 2\ \times\ 10^5 $
- $ 1\ \le\ N\ \le\ 2\ \times\ 10^5 $
- $ 1\ \le\ L_i\ \le\ R_i\ \le\ 10^9 $
- $ 1 $ つの入力に含まれるテストケースについて、それらの $ N $ の総和は $ 2\ \times\ 10^5 $ を超えない。

### Sample Explanation 1

この入力には $ 2 $ つのテストケースが含まれます。 - $ 1 $ つ目のテストケースについて、以下のようにボールを箱に入れると、問題文中の条件を満たすように $ 3 $ 個のボールを全て箱に入れることができるので、 `Yes` と出力します。 - ボール $ 1 $ を箱 $ 1 $ に入れる。 - ボール $ 2 $ を箱 $ 2 $ に入れる。 - ボール $ 3 $ を箱 $ 3 $ に入れる。 - $ 2 $ つ目のテストケースについて、問題文中の条件を満たすように $ 5 $ 個のボールを全て箱に入れることはできないので、 `No` と出力します。

## 样例 #1

### 输入

```
2

3

1 2

2 3

3 3

5

1 2

2 3

3 3

1 3

999999999 1000000000
```

### 输出

```
Yes

No
```



---

---
title: "[ABC214F] Substrings"
layout: "post"
diff: 普及+/提高
pid: AT_abc214_f
tag: []
---

# [ABC214F] Substrings

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc214/tasks/abc214_f

文字列 $ S $ が与えられます。高橋君はこの文字列から以下の手順にしたがって新しい文字列 $ T $ を作ります。

- まず、$ S $ の文字のうちの一つ以上に印をつける。ただし、印をつけた文字どうしが隣り合ってはならない。
- 次に、印がついていない文字を全て削除する。
- 最後に、残った文字列を $ T $ とする。ただし、この時に文字を並び替えてはならない。

$ T $ としてありうる文字列は何種類ありますか？ $ (10^9\ +\ 7) $ で割ったあまりを求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ S $

## 输出格式

$ T $ としてありうる文字列の種類数を $ (10^9\ +\ 7) $ で割ったあまりを出力せよ。

## 说明/提示

### 制約

- $ S $ は英小文字のみからなる長さ $ 1 $ 以上 $ 2\ \times\ 10^5 $ 以下の文字列

### Sample Explanation 1

$ T $ としてありうるものは `a`、 `b`、 `c`、 `ac` の $ 4 $ つです。 $ S $ の $ 1 $ 文字目のみに印をつけたとき $ T $ は `a`、 $ S $ の $ 2 $ 文字目のみに印をつけたとき $ T $ は `b`、 $ S $ の $ 3 $ 文字目のみに印をつけたとき $ T $ は `c`、 $ S $ の $ 1 $ 文字目と $ 3 $ 文字目のみに印をつけたとき $ T $ は `ac`、 となります。例えば $ 1 $ 文字目と $ 2 $ 文字目の両方に印をつけることはできないことに注意してください。

### Sample Explanation 2

$ T $ としてありうるものは `a` のみです。 印をつけた位置が異なっていても $ T $ が同じ文字列となる可能性があることに注意してください。

### Sample Explanation 3

$ T $ としてありうるものは `a`、 `b`、 `c`、 `aa`、 `ab`、 `ca` の $ 6 $ つです。

## 样例 #1

### 输入

```
abc
```

### 输出

```
4
```

## 样例 #2

### 输入

```
aa
```

### 输出

```
1
```

## 样例 #3

### 输入

```
acba
```

### 输出

```
6
```

## 样例 #4

### 输入

```
chokudai
```

### 输出

```
54
```



---

---
title: "[ABC215E] Chain Contestant"
layout: "post"
diff: 普及+/提高
pid: AT_abc215_e
tag: []
---

# [ABC215E] Chain Contestant

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc215/tasks/abc215_e

別世界の AtCoder では現在、 AAC, ..., AJC の $ 10 $ 種類のコンテストが開催されており、これから $ N $ 回のコンテストが開催されます。  
 各コンテストの種類は文字列 $ S $ として与えられ、 $ S $ の $ i $ 文字目が $ x $ なら $ i $ 回目には A$ x $C が開催されます。  
 シカの AtCoDeer くんは、 $ N $ 個のコンテストから $ 1 $ 個以上いくつか選んで、以下の条件を満たすように選んで出場します。

- 出るコンテストを順番を保ったまま抜き出したとき、コンテストの種類ごとにひとかたまりとなっている。
  - 厳密には、 AtCoDeer くんが $ x $ 個のコンテストに出場し、そのうち $ i $ 回目のコンテストの種類が $ T_i $ であるとき、全ての $ 1\ \le\ i\ <\ j\ <\ k\ \le\ x $ を満たす整数組 $ (i,j,k) $ に対して、 $ T_i=T_k $ であるならば $ T_i=T_j $ でなければならない。

AtCoDeer くんが出場するコンテストの選び方として考えられるものの総数を $ 998244353 $ で割った余りを求めてください。  
 ただし、 $ 2 $ つのコンテストの選び方が異なるとは、あるコンテスト $ c $ が存在して、片方の選び方では $ c $ に出場するがもう片方の選び方では出場しないということを指します。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ S $

## 输出格式

答えを整数として出力せよ。

## 说明/提示

### 制約

- $ 1\ \le\ N\ \le\ 1000 $
- $ |S|=N $
- $ S $ は `A` から `J` までの英大文字のみからなる

### Sample Explanation 1

例えば、 $ 1,3 $ 回目のコンテストに出場する、 $ 2,4 $ 回目のコンテストに出場するという選び方は条件を満たします。 一方、 $ 1,2,3,4 $ 回目のコンテストに出場する場合、 ABC への出場がひとかたまりになっておらず、整数組 $ (i,j,k)=(1,2,3) $ について条件に違反します。 また、全てのコンテストに出場しないということも認められません。 問題文の条件に適する出場するコンテストの選び方は $ 13 $ 通りあります。

### Sample Explanation 2

総数を $ 998244353 $ で割った余りを求めることに注意してください。

## 样例 #1

### 输入

```
4

BGBH
```

### 输出

```
13
```

## 样例 #2

### 输入

```
100

BBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBIEIJEIJIJCGCCFGIEBIHFCGFBFAEJIEJAJJHHEBBBJJJGJJJCCCBAAADCEHIIFEHHBGF
```

### 输出

```
330219020
```



---

---
title: "[ABC215F] Dist Max 2"
layout: "post"
diff: 普及+/提高
pid: AT_abc215_f
tag: []
---

# [ABC215F] Dist Max 2

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc215/tasks/abc215_f

$ 2 $ 次元平面上の $ N $ 個の相異なる点が与えられます。点 $ i\,\ (1\ \leq\ i\ \leq\ N) $ の座標は $ (x_i,y_i) $ です。

$ 2 $ つの点 $ i,j\,\ (1\ \leq\ i,j\ \leq\ N) $ の距離を $ \mathrm{min}\ (|x_i-x_j|,|y_i-y_j|) $ 、すなわち $ x $ 座標の差と $ y $ 座標の差の小さい方と定義します。

異なる $ 2 $ つの点の距離の最大値を求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ x_1 $ $ y_1 $ $ x_2 $ $ y_2 $ $ \vdots $ $ x_N $ $ y_N $

## 输出格式

異なる $ 2 $ つの点の距離の最大値を出力せよ。

## 说明/提示

### 制約

- $ 2\ \leq\ N\ \leq\ 200000 $
- $ 0\ \leq\ x_i,y_i\ \leq\ 10^9 $
- $ (x_i,y_i) $ $ \neq $ $ (x_j,y_j) $ $ (i\ \neq\ j) $
- 入力は全て整数である。

### Sample Explanation 1

点 $ 1 $ と点 $ 2 $ の距離は $ 2 $ 、点 $ 1 $ と点 $ 3 $ の距離は $ 4 $ 、点 $ 2 $ と点 $ 3 $ の距離は $ 1 $ です。よって $ 4 $ を出力してください。

## 样例 #1

### 输入

```
3

0 3

3 1

4 10
```

### 输出

```
4
```

## 样例 #2

### 输入

```
4

0 1

0 4

0 10

0 6
```

### 输出

```
0
```

## 样例 #3

### 输入

```
8

897 729

802 969

765 184

992 887

1 104

521 641

220 909

380 378
```

### 输出

```
801
```



---

---
title: "[ABC216F] Max Sum Counting"
layout: "post"
diff: 普及+/提高
pid: AT_abc216_f
tag: []
---

# [ABC216F] Max Sum Counting

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc216/tasks/abc216_f

長さ $ N $ の数列 $ A\ =\ (A_1,\ \dots,\ A_N),\ B\ =\ (B_1,\ \dots,\ B_N) $ が与えられます。$ \{1,2,\ldots,N\} $ の空でない部分集合 $ S $ であって、以下の条件を満たすものの個数を数えてください。

- $ \max_{i\ \in\ S}\ A_i\ \geq\ \sum_{i\ \in\ S}\ B_i $

なお、答えは非常に大きくなることがあるため、$ 998244353 $ で割ったあまりを出力してください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ A_1 $ $ A_2 $ $ \ldots $ $ A_N $ $ B_1 $ $ B_2 $ $ \ldots $ $ B_N $

## 输出格式

問題文中の条件を満たす $ S $ の個数を $ 998244353 $ で割ったあまりを出力せよ。

## 说明/提示

### 制約

- $ 1\ \leq\ N\ \leq\ 5000 $
- $ 1\ \leq\ A_i,B_i\ \leq\ 5000 $
- 入力は全て整数

### Sample Explanation 1

$ \{1,2,\ldots,N\} $ の空でない部分集合としてあり得るものは、$ \{1\} $, $ \{2\} $, $ \{1,2\} $ の $ 3 $ 通りです。 - $ S=\{1\} $ のとき $ \max_{i\ \in\ S}\ A_i=3 $, $ \sum_{i\ \in\ S}\ B_i=1 $ - $ S=\{2\} $ のとき $ \max_{i\ \in\ S}\ A_i=1 $, $ \sum_{i\ \in\ S}\ B_i=2 $ - $ S=\{1,2\} $ のとき $ \max_{i\ \in\ S}\ A_i=3 $, $ \sum_{i\ \in\ S}\ B_i=3 $ であるため、問題文中の条件、即ち $ \max_{i\ \in\ S}\ A_i\ \geq\ \sum_{i\ \in\ S}\ B_i $ を満たす $ S $ は $ \{1\} $ と $ \{1,2\} $ の $ 2 $ 通りです。

### Sample Explanation 2

条件を満たす $ S $ が存在しない場合もあります。

## 样例 #1

### 输入

```
2

3 1

1 2
```

### 输出

```
2
```

## 样例 #2

### 输入

```
2

1 1

2 2
```

### 输出

```
0
```

## 样例 #3

### 输入

```
20

1937 3980 2689 1208 3640 1979 581 2271 4229 3948 3708 1522 4161 4661 3797 96 3388 3395 2920 2247

4485 2580 174 1156 3770 3396 3558 3500 3494 479 269 3383 1230 1711 3545 3919 134 475 3796 1017
```

### 输出

```
476
```



---

---
title: "[ABC216G] 01Sequence"
layout: "post"
diff: 普及+/提高
pid: AT_abc216_g
tag: []
---

# [ABC216G] 01Sequence

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc216/tasks/abc216_g

`0` と `1` のみからなる長さ $ N $ の数列 $ A=(A_1,A_2,\dots,A_N) $ であって、以下の条件を満たすものを考えます。

> すべての $ i=1,2,\dots,M $ について、$ A_{L_i}, A_{L_i+1},\dots\ ,A_{R_i} $ に `1` が $ X_i $ 個以上含まれる

条件を満たす数列 $ A $ のうち、含まれる `1` の数が**最も少ない**例を $ 1 $ つ出力してください。

なお、制約のもとで条件を満たす数列 $ A $ は必ず存在します。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ M $ $ L_1 $ $ R_1 $ $ X_1 $ $ L_2 $ $ R_2 $ $ X_2 $ $ \vdots $ $ L_M $ $ R_M $ $ X_M $

## 输出格式

`0` と `1` のみからなる数列 $ A $ を空白区切りで出力せよ。

> $ A_1 $ $ A_2 $ $ \dots $ $ A_N $

数列 $ A $ は上記の条件を全て満たさなければならない。

## 说明/提示

### 制約

- $ 1\ \leq\ N\ \leq\ 2\ \times\ 10^5 $
- $ 1\ \leq\ M\ \leq\ \min(2\ \times\ 10^5,\ \frac{N(N+1)}{2}\ ) $
- $ 1\ \leq\ L_i\ \leq\ R_i\ \leq\ N $
- $ 1\ \leq\ X_i\ \leq\ R_i-L_i+1 $
- $ i\ \neq\ j $ ならば $ (L_i,R_i)\ \neq\ (L_j,R_j) $
- 入力は全て整数

### Sample Explanation 1

`1 1 0 1 1 0` などの答えも正解です。 `0 1 1 1 1 1` などの答えは含まれる `1` の数が最小化されていないので、不正解です。

## 样例 #1

### 输入

```
6 3

1 4 3

2 2 1

4 6 2
```

### 输出

```
0 1 1 1 0 1
```

## 样例 #2

### 输入

```
8 2

2 6 1

3 5 3
```

### 输出

```
0 0 1 1 1 0 0 0
```



---

---
title: "[ABC218F] Blocked Roads"
layout: "post"
diff: 普及+/提高
pid: AT_abc218_f
tag: []
---

# [ABC218F] Blocked Roads

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc218/tasks/abc218_f

$ N $ 頂点 $ M $ 辺の有向グラフが与えられます。頂点には $ 1 $ から $ N $ の番号、辺には $ 1 $ から $ M $ の番号がついています。辺 $ i\,(1\ \leq\ i\ \leq\ M) $ は頂点 $ s_i $ から頂点 $ t_i $ に向かう長さ $ 1 $ の辺です。

各 $ i\,(1\ \leq\ i\ \leq\ M) $ について、辺 $ i $ のみ通れないときの頂点 $ 1 $ から頂点 $ N $ までの最短距離を求めてください。ただし、頂点 $ 1 $ から頂点 $ N $ にたどり着けない場合は `-1` を出力してください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ M $ $ s_1 $ $ t_1 $ $ s_2 $ $ t_2 $ $ \vdots $ $ s_M $ $ t_M $

## 输出格式

$ M $ 行出力せよ。

$ i $ 行目には、辺 $ i $ のみ通れないときの頂点 $ 1 $ から頂点 $ N $ までの最短距離を出力せよ。ただし、頂点 $ 1 $ から頂点 $ N $ にたどり着けない場合は `-1` を出力せよ。

## 说明/提示

### 制約

- $ 2\ \leq\ N\ \leq\ 400 $
- $ 1\ \leq\ M\ \leq\ N(N-1) $
- $ 1\ \leq\ s_i,t_i\ \leq\ N $
- $ s_i\ \neq\ t_i $
- $ (s_i,t_i)\ \neq\ (s_j,t_j) $ $ (i\ \neq\ j) $
- 入力は全て整数である。

### Sample Explanation 2

辺 $ 1 $ のみ通れないとき、頂点 $ 1 $ から頂点 $ N $ にたどり着けないので `-1` を出力します。

## 样例 #1

### 输入

```
3 3

1 2

1 3

2 3
```

### 输出

```
1

2

1
```

## 样例 #2

### 输入

```
4 4

1 2

2 3

2 4

3 4
```

### 输出

```
-1

2

3

2
```

## 样例 #3

### 输入

```
5 10

1 2

1 4

1 5

2 1

2 3

3 1

3 2

3 5

4 2

4 3
```

### 输出

```
1

1

3

1

1

1

1

1

1

1
```

## 样例 #4

### 输入

```
4 1

1 2
```

### 输出

```
-1
```



---

---
title: "[ABC219E] Moat"
layout: "post"
diff: 普及+/提高
pid: AT_abc219_e
tag: []
---

# [ABC219E] Moat

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc219/tasks/abc219_e

$ xy $ -平面上のいくつかの点に村があります。  
 高橋君はこれらの村を民兵や魔女などの外敵から守るため、これらのすべての村を囲むようなお堀を建設します。

$ 0 $ と $ 1 $ からなる $ 4\ \times\ 4 $ 行列 $ A\ =\ (A_{i,\ j}) $ が与えられます。  
 $ A_{i,\ j}\ =\ 1 $ を満たす整数の組 $ (i,\ j) $ $ (1\ \leq\ i,\ j\ \leq\ 4) $ ごとに、座標 $ (i-0.5,\ j-0.5) $ に村があります。

お堀は平面上の多角形です。 高橋君は以下の条件をすべて満たすお堀を建設します（入力例１・出力例１の説明も参考にして下さい）。

1. 自己交差がない
2. 内部にすべての村を含む
3. すべての頂点の $ x $ 座標と $ y $ 座標は $ 0 $ 以上 $ 4 $ 以下の整数
4. すべての辺は $ x $ 軸と $ y $ 軸のどちらかに平行
5. それぞれの内角の大きさは $ 90 $ 度または $ 270 $ 度

高橋君が建設するお堀として考えられるものが何通りあるかを出力して下さい。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ A_{1,\ 1} $ $ A_{1,\ 2} $ $ A_{1,\ 3} $ $ A_{1,\ 4} $ $ A_{2,\ 1} $ $ A_{2,\ 2} $ $ A_{2,\ 3} $ $ A_{2,\ 4} $ $ A_{3,\ 1} $ $ A_{3,\ 2} $ $ A_{3,\ 3} $ $ A_{3,\ 4} $ $ A_{4,\ 1} $ $ A_{4,\ 2} $ $ A_{4,\ 3} $ $ A_{4,\ 4} $

## 输出格式

高橋君が建設するお堀として考えられるものが何通りあるかを出力せよ。

## 说明/提示

### 制約

- $ A_{i,\ j}\ \in\ \lbrace\ 0,\ 1\rbrace $
- $ A_{i,\ j}\ =\ 1 $ となる $ (i,\ j) $ が少なくとも $ 1 $ つ存在する

### Sample Explanation 1

下記の $ 2 $ つの画像の例は、高橋君が建設する**お堀の条件を満たします**。 

![](https://img.atcoder.jp/ghi/7b3181deb4e1df72e4c0661b1137db4d.png)
![](https://img.atcoder.jp/ghi/a1e46c7db32d63942caa7119a4f3a593.png) 

下記の $ 4 $ つの画像の例は、高橋君が建設する**お堀の条件を満たしません**。 
![](https://img.atcoder.jp/ghi/335053c01a13eb99e55767a3dc02eb38.png)
![](https://img.atcoder.jp/ghi/c4df3d1fa24557b0d4d94ac0eaa8b9ab.png)
![](https://img.atcoder.jp/ghi/be93de595e9222d5e20c90bd28d24563.png)
![](https://img.atcoder.jp/ghi/37dac3af065c013ce0b8c0ee7591b97a.png) 

上記の $ 4 $ つの例が高橋君の建設するお堀の条件を満たさない理由は、以下の通りです。 - $ 1 $ つ目の画像の例は、「自己交差がない」という条件を満たしません。 - $ 2 $ つ目の画像の例は、「内部にすべての村を含む」という条件を満たしません。 - $ 3 $ つ目の画像の例は、「すべての頂点の $ x $ 座標と $ y $ 座標は $ 0 $ 以上 $ 4 $ 以下の整数」という条件を満たしません。（座標が整数でない頂点があります。） - $ 4 $ つ目の画像の例は、「すべての辺は $ x $ 軸と $ y $ 軸のどちらかに平行」という条件を満たしません。

## 样例 #1

### 输入

```
1 0 0 0

0 0 1 0

0 0 0 0

1 0 0 0
```

### 输出

```
1272
```

## 样例 #2

### 输入

```
1 1 1 1

1 1 1 1

1 1 1 1

1 1 1 1
```

### 输出

```
1
```



---

---
title: "[ABC220E] Distance on Large Perfect Binary Tree"
layout: "post"
diff: 普及+/提高
pid: AT_abc220_e
tag: []
---

# [ABC220E] Distance on Large Perfect Binary Tree

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc220/tasks/abc220_e

$ 2^N-1 $ 頂点からなる木があります。  
 頂点には $ 1 $ から $ 2^N-1 $ の番号がつけられており、各 $ 1\leq\ i\ <\ 2^{N-1} $ について、

- 頂点 $ i $ と頂点 $ 2i $ を結ぶ無向辺
- 頂点 $ i $ と頂点 $ 2i+1 $ を結ぶ無向辺

が存在します。これら以外の辺はありません。

$ 2 $ 頂点間の距離を、その $ 2 $ 頂点を結ぶ単純パスに含まれる辺の個数とします。

頂点の組 $ (i,j) $ であって、距離が $ D $ であるようなものの個数を $ 998244353 $ で割った余りを求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ D $

## 输出格式

答えを出力せよ。

## 说明/提示

### 制約

- $ 2\ \leq\ N\ \leq\ 10^6 $
- $ 1\ \leq\ D\ \leq\ 2\times\ 10^6 $
- 入力に含まれる値は全て整数である

### Sample Explanation 1

与えられる木は以下の図のようなものです。 !\[図\](https://img.atcoder.jp/ghi/86d098048a50638decb39ed6659d32cf.png) 距離が $ 2 $ であるような頂点の組は $ (1,4),(1,5),(1,6),(1,7),(2,3),(3,2),(4,1),(4,5),(5,1),(5,4),(6,1),(6,7),(7,1),(7,6) $ の $ 14 $ 組存在します。

## 样例 #1

### 输入

```
3 2
```

### 输出

```
14
```

## 样例 #2

### 输入

```
14142 17320
```

### 输出

```
11284501
```



---

---
title: "[ABC220F] Distance Sums 2"
layout: "post"
diff: 普及+/提高
pid: AT_abc220_f
tag: []
---

# [ABC220F] Distance Sums 2

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc220/tasks/abc220_f

$ N $ 頂点の木が与えられます。頂点には $ 1,2,\ldots\ ,N $ の番号がついており、$ i $ 番目の辺は頂点 $ u_i,v_i $ を結ぶ無向辺です。

各整数 $ i\,(1\ \leq\ i\ \leq\ N) $ に対して、$ \sum_{j=1}^{N}dis(i,j) $ を求めてください。

ただし、$ dis(i,j) $ は頂点 $ i $ から頂点 $ j $ に到達する際にたどる必要のある最小の辺数です。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ u_1 $ $ v_1 $ $ u_2 $ $ v_2 $ $ \vdots $ $ u_{N-1} $ $ v_{N-1} $

## 输出格式

$ N $ 行出力せよ。

$ i $ 行目には $ \sum_{j=1}^{N}dis(i,j) $ を出力せよ。

## 说明/提示

### 制約

- $ 2\ \leq\ N\ \leq\ 2\ \times\ 10^5 $
- $ 1\ \leq\ u_i\ <\ v_i\ \leq\ N $
- 与えられるグラフは木
- 入力は全て整数

### Sample Explanation 1

$ dis(1,1)+dis(1,2)+dis(1,3)=0+1+2=3 $、 $ dis(2,1)+dis(2,2)+dis(2,3)=1+0+1=2 $、 $ dis(3,1)+dis(3,2)+dis(3,3)=2+1+0=3 $、 です。

## 样例 #1

### 输入

```
3

1 2

2 3
```

### 输出

```
3

2

3
```

## 样例 #2

### 输入

```
2

1 2
```

### 输出

```
1

1
```

## 样例 #3

### 输入

```
6

1 6

1 5

1 3

1 4

1 2
```

### 输出

```
5

9

9

9

9

9
```



---

---
title: "[ABC221E] LEQ"
layout: "post"
diff: 普及+/提高
pid: AT_abc221_e
tag: []
---

# [ABC221E] LEQ

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc221/tasks/abc221_e

長さ $ N $ の整数列 $ A\ =\ (A_1,\ A_2,\ \dots,\ A_N) $ が与えられます。

$ A $ の連続するとは限らない、長さが $ 2 $ 以上である部分列 $ A'=(A'_1,A'_2,\ldots,A'_k) $ のうち以下の条件を満たすものの個数を求めてください。

- $ A'_1\ \leq\ A'_k $

なお、この値は非常に大きくなることがあるため、$ 998244353 $ で割ったあまりを出力してください。

ただし、$ 2 $ つの部分列は、列として同じであっても、取り出す添字が異なる場合は区別されます。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ A_1 $ $ A_2 $ $ \ldots $ $ A_N $

## 输出格式

$ A $ の連続するとは限らない、長さが $ 2 $ 以上である部分列のうち問題文中の条件を満たすものの個数を、$ 998244353 $ で割ったあまりを出力せよ。

## 说明/提示

### 制約

- $ 2\ \leq\ N\ \leq\ 3\ \times\ 10^5 $
- $ 1\ \leq\ A_i\ \leq\ 10^9 $
- 入力はすべて整数

### Sample Explanation 1

$ A=(1,2,1) $ の連続するとは限らない、長さが $ 2 $ 以上である部分列は $ (1,2) $, $ (1,1) $, $ (2,1) $, $ (1,2,1) $ の $ 4 $ 通りあります。 そのうち問題文中の条件を満たすものは、$ (1,2) $, $ (1,1) $, $ (1,2,1) $ の $ 3 $ 通りです。

### Sample Explanation 2

列として同じであっても、取り出す添字が異なる場合 $ 2 $ つの部分列は区別されることに注意してください。 この入出力例において、問題文中の条件を満たすような部分列は $ (1,2) $, $ (1,2) $, $ (2,2) $, $ (1,2,2) $ の $ 4 $ 通りです。

### Sample Explanation 3

問題文中の条件を満たすような部分列が存在しない場合もあります。

## 样例 #1

### 输入

```
3

1 2 1
```

### 输出

```
3
```

## 样例 #2

### 输入

```
3

1 2 2
```

### 输出

```
4
```

## 样例 #3

### 输入

```
3

3 2 1
```

### 输出

```
0
```

## 样例 #4

### 输入

```
10

198495780 28463047 859606611 212983738 946249513 789612890 782044670 700201033 367981604 302538501
```

### 输出

```
830
```



---

---
title: "[ABC222E] Red and Blue Tree"
layout: "post"
diff: 普及+/提高
pid: AT_abc222_e
tag: []
---

# [ABC222E] Red and Blue Tree

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc222/tasks/abc222_e

$ N $ 頂点の木と、長さ $ M $ の数列 $ A=(A_1,\ldots,A_M) $、整数 $ K $ が与えられます。  
 木の頂点には $ 1 $ から $ N $ の番号がつけられており、$ i $ 番目の辺は頂点 $ U_i $ と $ V_i $ を結んでいます。

この木の $ N-1 $ 個の辺をそれぞれ赤か青のどちらかに塗ります。そのような方法は $ 2^{N-1} $ 通りありますが、そのうち次の条件を満たすような塗り方の個数を $ 998244353 $ で割った余りを求めてください。

条件：  
 最初、駒を頂点 $ A_1 $ におく。$ i=1,\ldots,M-1 $ の順に、駒を頂点 $ A_i $ から頂点 $ A_{i+1} $ まで、辺をたどって最短経路で動かす。 これらの操作を最後まで行ったとき、赤く塗られた辺を通過した回数を $ R $、青く塗られた辺を通過した回数を $ B $ とすると、$ R-B=K $ である。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ M $ $ K $ $ A_1 $ $ A_2 $ $ \ldots $ $ A_M $ $ U_1 $ $ V_1 $ $ \vdots $ $ U_{N-1} $ $ V_{N-1} $

## 输出格式

答えを出力せよ。

## 说明/提示

### 制約

- $ 2\ \leq\ N\ \leq\ 1000 $
- $ 2\ \leq\ M\ \leq\ 100 $
- $ |K|\ \leq\ 10^5 $
- $ 1\ \leq\ A_i\ \leq\ N $
- $ 1\leq\ U_i,V_i\leq\ N $
- 与えられるグラフは木である
- 入力に含まれる値は全て整数である

### Sample Explanation 1

$ 1,3 $ 番目の辺を赤く、$ 2 $ 番目の辺を青く塗ったとき、 - 頂点 $ 2 $ から頂点 $ 3 $ への移動で赤い辺を $ 0 $ 回、青い辺を $ 1 $ 回 - 頂点 $ 3 $ から頂点 $ 2 $ への移動で赤い辺を $ 0 $ 回、青い辺を $ 1 $ 回 - 頂点 $ 2 $ から頂点 $ 1 $ への移動で赤い辺を $ 1 $ 回、青い辺を $ 0 $ 回 - 頂点 $ 1 $ から頂点 $ 4 $ への移動で赤い辺を $ 2 $ 回、青い辺を $ 1 $ 回 それぞれ通過し、全体では赤い辺を $ 3 $ 回、青い辺を $ 3 $ 回通るため、条件を満たします。 !\[図\](https://img.atcoder.jp/ghi/f9b2b199fb6eedaca02e15ff556b72b1.png) この他、$ 1,3 $ 番目の辺を青く、$ 2 $ 番目の辺を赤く塗るときも条件を満たし、これら以外の塗り方は条件を満たさないため、答えは $ 2 $ 通りです。

### Sample Explanation 2

条件を満たす塗り方が存在しないこともあります。

## 样例 #1

### 输入

```
4 5 0

2 3 2 1 4

1 2

2 3

3 4
```

### 输出

```
2
```

## 样例 #2

### 输入

```
3 10 10000

1 2 1 2 1 2 2 1 1 2

1 2

1 3
```

### 输出

```
0
```

## 样例 #3

### 输入

```
10 2 -1

1 10

1 2

2 3

3 4

4 5

5 6

6 7

7 8

8 9

9 10
```

### 输出

```
126
```

## 样例 #4

### 输入

```
5 8 -1

1 4 1 4 2 1 3 5

1 2

4 1

3 1

1 5
```

### 输出

```
2
```



---

---
title: "[ABC223E] Placing Rectangles"
layout: "post"
diff: 普及+/提高
pid: AT_abc223_e
tag: []
---

# [ABC223E] Placing Rectangles

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc223/tasks/abc223_e

正整数 $ X,\ Y $ に対し、$ 2 $ 次元平面上において以下の条件を満たす長方形を**良い長方形**と呼びます。

- 全ての辺は $ x $ 軸または $ y $ 軸に並行である。
- 全ての頂点に対し、その $ x $ 座標は $ 0 $ 以上 $ X $ 以下の整数であり、その $ y $ 座標は $ 0 $ 以上 $ Y $ 以下の整数である。

面積がそれぞれ $ A $ 以上、$ B $ 以上、$ C $ 以上であるような $ 3 $ つの良い長方形を重ならないように配置することができるか判定してください。

ただし、$ 3 $ つの長方形が重ならないとは、どの $ 2 $ つの長方形についても、それらの共通部分の面積が $ 0 $ であることを指します。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ X $ $ Y $ $ A $ $ B $ $ C $

## 输出格式

問題文で与えられた条件を満たすように長方形を配置することができるならば `Yes`、できないならば `No` と出力せよ。

## 说明/提示

### 制約

- $ 1\ \leq\ X,\ Y\ \leq\ 10^9 $
- $ 1\ \leq\ A,\ B,\ C\ \leq\ 10^{18} $
- 入力は全て整数である。

### Sample Explanation 1

下の図のように配置すればよいです。長方形内の数値は面積を表します。 $ 2\ \geq\ A,\ 3\ \geq\ B,\ 3\ \geq\ C $ であるので、問題文で与えられた条件を満たします。 !\[image\](https://img.atcoder.jp/ghi/abc223e\_sample.png)

### Sample Explanation 2

条件を満たすように配置することはできません。

## 样例 #1

### 输入

```
3 3 2 2 3
```

### 输出

```
Yes
```

## 样例 #2

### 输入

```
3 3 4 4 1
```

### 输出

```
No
```

## 样例 #3

### 输入

```
1000000000 1000000000 1000000000000000000 1000000000000000000 1000000000000000000
```

### 输出

```
No
```



---

---
title: "[ABC223F] Parenthesis Checking"
layout: "post"
diff: 普及+/提高
pid: AT_abc223_f
tag: []
---

# [ABC223F] Parenthesis Checking

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc223/tasks/abc223_f

以下のいずれかの条件を満たす文字列を**正しい括弧列**と定義します。

- 空文字列
- ある**正しい括弧列** $ A $ が存在して、`(`, $ A $, `)` をこの順に連結した文字列
- ある空でない**正しい括弧列** $ A $, $ B $ が存在して、$ A $, $ B $ をこの順に連結した文字列

`(` と `)` のみからなる長さ $ N $ の文字列 $ S $ があります。

$ Q $ 個のクエリ $ \text{Query}_1,\text{Query}_2,\ldots,\text{Query}_Q $ が与えられるので、順番に処理してください。クエリには $ 2 $ 種類があり、入力形式とクエリの内容は以下の通りです。

- `1 l r` : $ S $ の $ l $ 文字目と $ r $ 文字目を入れ替える。
- `2 l r` : $ S $ の $ l $ 文字目から $ r $ 文字目までの連続部分文字列が**正しい括弧列**であるか判定する。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ Q $ $ S $ $ \text{Query}_1 $ $ \text{Query}_2 $ $ \vdots $ $ \text{Query}_Q $

## 输出格式

`2 l r` の形式の各クエリに対して、連続部分文字列が**正しい括弧列**である場合 `Yes`、そうでない場合 `No` と出力し、改行せよ。

## 说明/提示

### 制約

- $ 1\ \leq\ N,Q\ \leq\ 2\ \times\ 10^5 $
- $ S $ は `(` と `)` のみからなる長さ $ N $ の文字列
- $ 1\ \leq\ l\ <\ r\ \leq\ N $
- $ N,Q,l,r $ はいずれも整数
- 各クエリは `1 l r`、`2 l r` のいずれかの形式で与えられる。
- `2 l r` の形式のクエリは $ 1 $ つ以上与えられる。

### Sample Explanation 1

$ 1 $ つ目のクエリにおいて、`(())` は\*\*正しい括弧列\*\*です。 $ 2 $ つ目のクエリにおいて、`((` は\*\*正しい括弧列\*\*ではありません。 $ 3 $ つ目のクエリにおいて、`)(` は\*\*正しい括弧列\*\*ではありません。

### Sample Explanation 2

$ 1 $ つ目のクエリにおいて、`(())` は\*\*正しい括弧列\*\*です。 $ 2 $ つ目のクエリによって、$ S $ は `)()((` となります。 $ 3 $ つ目のクエリにおいて、`)()(` は\*\*正しい括弧列\*\*ではありません。

## 样例 #1

### 输入

```
5 3

(())(

2 1 4

2 1 2

2 4 5
```

### 输出

```
Yes

No

No
```

## 样例 #2

### 输入

```
5 3

(())(

2 1 4

1 1 4

2 1 4
```

### 输出

```
Yes

No
```

## 样例 #3

### 输入

```
8 8

(()(()))

2 2 7

2 2 8

1 2 5

2 3 4

1 3 4

1 3 5

1 1 4

1 6 8
```

### 输出

```
Yes

No

No
```



---

---
title: "[ABC224D] 8 Puzzle on Graph"
layout: "post"
diff: 普及+/提高
pid: AT_abc224_d
tag: []
---

# [ABC224D] 8 Puzzle on Graph

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc224/tasks/abc224_d

高橋君は道端であるパズルを拾いました。  
 このパズルは、$ 9 $ 個の頂点と $ M $ 本の辺からなる無向グラフ、および、$ 8 $ つのコマで構成されます。

グラフの $ 9 $ つの頂点はそれぞれ頂点 $ 1 $、頂点 $ 2 $、$ \ldots $、頂点 $ 9 $ と呼ばれ、 $ i\ =\ 1,\ 2,\ \ldots,\ M $ について、$ i $ 番目の辺は頂点 $ u_i $ と頂点 $ v_i $ を結んでいます。  
 $ 8 $ つのコマはそれぞれコマ $ 1 $、コマ $ 2 $、$ \ldots $、コマ $ 8 $ と呼ばれ、 $ j\ =\ 1,\ 2,\ \ldots,\ 8 $ について、コマ $ j $ は頂点 $ p_j $ に置かれています。 ここで、すべてのコマはそれぞれ異なる頂点に置かれていることが保証されます。 コマが置かれていない「空の頂点」がただ一つ存在することに注意してください。

高橋君はこのパズルに対して下記の操作を好きな回数（ $ 0 $ 回でもよい）だけ行うことができます。

> 空の頂点に隣接する頂点に置かれたコマを $ 1 $ つ選び、選んだコマを空の頂点に移動する。

高橋君は上記の操作を繰り返して、このパズルを「完成」させようとしています。 パズルは、下記の状態を満たしたときに完成となります。

> $ j\ =\ 1,\ 2,\ \ldots,\ 8 $ について、コマ $ j $ は 頂点 $ j $ に置かれている。

高橋君がパズルを完成させることが可能かどうかを判定し、可能な場合はそのために必要な操作回数の最小値を出力してください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ M $ $ u_1 $ $ v_1 $ $ u_2 $ $ v_2 $ $ \vdots $ $ u_M $ $ v_M $ $ p_1 $ $ p_2 $ $ \ldots $ $ p_8 $

## 输出格式

高橋君がパズルを完成させることが可能な場合は、そのために必要な操作回数の最小値を出力せよ。 高橋君がパズルを完成させることが不可能な場合は、$ -1 $ を出力せよ。

## 说明/提示

### 制約

- $ 0\ \leq\ M\ \leq\ 36 $
- $ 1\ \leq\ u_i,\ v_i\ \leq\ 9 $
- 与えられるグラフは多重辺、自己ループを持たない
- $ 1\ \leq\ p_j\ \leq\ 9 $
- $ j\ \neq\ j'\ \Rightarrow\ p_j\ \neq\ p_{j'} $
- 入力はすべて整数

### Sample Explanation 1

下記の手順によって、$ 5 $ 回の操作でパズルを完成させることができます。 1. コマ $ 2 $ を頂点 $ 9 $ から頂点 $ 1 $ に移動する。 2. コマ $ 3 $ を頂点 $ 2 $ から頂点 $ 9 $ に移動する。 3. コマ $ 2 $ を頂点 $ 1 $ から頂点 $ 2 $ に移動する。 4. コマ $ 1 $ を頂点 $ 3 $ から頂点 $ 1 $ に移動する。 5. コマ $ 3 $ を頂点 $ 9 $ から頂点 $ 3 $ に移動する。 一方、$ 5 $ 回未満の操作でパズルを完成させることはできません。よって、$ 5 $ を出力します。 与えられるグラフは連結とは限らないことに注意してください。

### Sample Explanation 2

パズルは初めから完成しています。よって、完成させるために必要な操作回数の最小値は $ 0 $ 回です。

### Sample Explanation 3

操作の繰り返しによってパズルを完成させることができないので、$ -1 $ を出力します。

## 样例 #1

### 输入

```
5

1 2

1 3

1 9

2 9

3 9

3 9 2 4 5 6 7 8
```

### 输出

```
5
```

## 样例 #2

### 输入

```
5

1 2

1 3

1 9

2 9

3 9

1 2 3 4 5 6 7 8
```

### 输出

```
0
```

## 样例 #3

### 输入

```
12

8 5

9 6

4 5

4 1

2 5

8 9

2 1

3 6

8 7

6 5

7 4

2 3

1 2 3 4 5 6 8 7
```

### 输出

```
-1
```

## 样例 #4

### 输入

```
12

6 5

5 4

4 1

4 7

8 5

2 1

2 5

6 9

3 6

9 8

8 7

3 2

2 3 4 6 1 9 7 8
```

### 输出

```
16
```



---

---
title: "[ABC224E] Integers on Grid"
layout: "post"
diff: 普及+/提高
pid: AT_abc224_e
tag: []
---

# [ABC224E] Integers on Grid

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc224/tasks/abc224_e

縦 $ H $ 行、横 $ W $ 列のマス目があります。上から $ i $ 行目、左から $ j $ 列目のマスをマス $ (i,\ j) $ と呼びます。

それぞれのマスには整数が書かれています。 $ i\ =\ 1,\ 2,\ \ldots,\ N $ について、マス $ (r_i,\ c_i) $ には正整数 $ a_i $ が書かれており、それら以外のマスには $ 0 $ が書かれています。

はじめ、マス $ (R,\ C) $ にコマが置かれています。 高橋君は、コマを「いま置かれているマスから別のマスに移動させる」ことを好きな回数だけ行うことができます。 ただし、コマを移動する際には下記の $ 2 $ つの条件をともに満たさなければなりません。

- 移動先のマスに書かれている整数は、移動前のマスに書かれている整数より真に大きい。
- 移動先のマスは移動前のマスと同じ行にある、または、移動先のマスは移動前のマスと同じ列にある。

$ i\ =\ 1,\ 2,\ \ldots,\ N $ のそれぞれについて、$ (R,\ C)\ =\ (r_i,\ c_i) $ の場合に高橋君がコマの移動を行うことができる回数の最大値を出力してください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ H $ $ W $ $ N $ $ r_1 $ $ c_1 $ $ a_1 $ $ r_2 $ $ c_2 $ $ a_2 $ $ \vdots $ $ r_N $ $ c_N $ $ a_N $

## 输出格式

$ N $ 行出力せよ。 $ i\ =\ 1,\ 2,\ \ldots,\ N $ について、$ i $ 行目には $ (R,\ C)\ =\ (r_i,\ c_i) $ の場合に高橋君がコマの移動を行うことができる回数の最大値を出力せよ。

## 说明/提示

### 制約

- $ 2\ \leq\ H,\ W\ \leq\ 2\ \times\ 10^5 $
- $ 1\ \leq\ N\ \leq\ \min(2\ \times\ 10^5,\ HW) $
- $ 1\ \leq\ r_i\ \leq\ H $
- $ 1\ \leq\ c_i\ \leq\ W $
- $ 1\ \leq\ a_i\ \leq\ 10^9 $
- $ i\ \neq\ j\ \Rightarrow\ (r_i,\ c_i)\ \neq\ (r_j,\ c_j) $
- 入力はすべて整数

### Sample Explanation 1

マス目に書かれた整数は下記の通りです。 ``` 4 7 0 3 0 5 2 5 5 ``` - $ (R,\ C)\ =\ (r_1,\ c_1)\ =\ (1,\ 1) $ の場合、$ (1,\ 1)\ \rightarrow\ (1,\ 2) $ と移動すると、コマの移動を $ 1 $ 回行うことができます。 - $ (R,\ C)\ =\ (r_2,\ c_2)\ =\ (1,\ 2) $ の場合、一度もコマの移動を行うことができません。 - $ (R,\ C)\ =\ (r_3,\ c_3)\ =\ (2,\ 1) $ の場合、$ (2,\ 1)\ \rightarrow\ (1,\ 1)\ \rightarrow\ (1,\ 2) $ と移動すると、コマの移動を $ 2 $ 回行うことができます。 - $ (R,\ C)\ =\ (r_4,\ c_4)\ =\ (2,\ 3) $ の場合、一度もコマの移動を行うことができません。 - $ (R,\ C)\ =\ (r_5,\ c_5)\ =\ (3,\ 1) $ の場合、$ (3,\ 1)\ \rightarrow\ (2,\ 1)\ \rightarrow\ (1,\ 1)\ \rightarrow\ (1,\ 2) $ と移動すると、コマの移動を $ 3 $ 回行うことができます。 - $ (R,\ C)\ =\ (r_6,\ c_6)\ =\ (3,\ 2) $ の場合、$ (3,\ 2)\ \rightarrow\ (1,\ 2) $ と移動すると、コマの移動を $ 1 $ 回行うことができます。 - $ (R,\ C)\ =\ (r_7,\ c_7)\ =\ (3,\ 3) $ の場合、一度もコマの移動を行うことができません。

## 样例 #1

### 输入

```
3 3 7

1 1 4

1 2 7

2 1 3

2 3 5

3 1 2

3 2 5

3 3 5
```

### 输出

```
1

0

2

0

3

1

0
```

## 样例 #2

### 输入

```
5 7 20

2 7 8

2 6 4

4 1 9

1 5 4

2 2 7

5 5 2

1 7 2

4 6 6

1 4 1

2 1 10

5 6 9

5 3 3

3 7 9

3 6 3

4 3 4

3 3 10

4 2 1

3 5 4

1 2 6

4 7 9
```

### 输出

```
2

4

1

5

3

6

6

2

7

0

0

4

1

5

3

0

5

2

4

0
```



---

---
title: "[ABC224F] Problem where +s Separate Digits"
layout: "post"
diff: 普及+/提高
pid: AT_abc224_f
tag: []
---

# [ABC224F] Problem where +s Separate Digits

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc224/tasks/abc224_f

$ 1 $ から $ 9 $ までの数字のみで構成された文字列 $ S $ が与えられます。  
 この文字列 $ S $ から、以下の操作によって式 $ T $ を作ります。

- はじめ、 $ T=S $ であるとする。
- 各要素が $ 1 $ 以上 $ |S|-1 $ 以下の整数である、値に重複のない集合 $ A $ を選ぶ。なお、 $ A $ が空集合であってもよい。
- $ A $ の全ての要素 $ x $ について、 $ x $ の降順に以下の操作を行う。
  - $ T $ の $ x $ 文字目と $ x+1 $ 文字目の間に、 `+` を挿入する。

例えば、 $ S= $ `1234`、 $ A=\ \lbrace\ 2,3\ \rbrace $ であるとき、 $ T $= `12+3+4` となります。

この操作によって得られる $ T $ としてあり得る全ての式に対して、式を計算したときの値の総和を $ 998244353 $ で割った余りを求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ S $

## 输出格式

答えを整数として出力せよ。

## 说明/提示

### 制約

- $ 1\ \le\ |S|\ \le\ 2\ \times\ 10^5 $
- $ S $ は `1`, `2`, `3`, `4`, `5`, `6`, `7`, `8`, `9` のみからなる。

### Sample Explanation 1

式 $ T $ としてあり得るものは `1234`, `123+4`, `12+34`, `12+3+4`, `1+234`, `1+23+4`, `1+2+34`, `1+2+3+4` の $ 8 $ つです。 これらを計算した値の総和は $ 1736 $ です。

### Sample Explanation 2

$ S $ の長さが $ 1 $ であることもあります。この場合、 $ A $ として指定可能なのは空集合のみです。

### Sample Explanation 3

答えを $ 998244353 $ で割った余りを求めてください。

## 样例 #1

### 输入

```
1234
```

### 输出

```
1736
```

## 样例 #2

### 输入

```
1
```

### 输出

```
1
```

## 样例 #3

### 输入

```
31415926535897932384626433832795
```

### 输出

```
85607943
```



---

---
title: "[ABC225E] フ"
layout: "post"
diff: 普及+/提高
pid: AT_abc225_e
tag: []
---

# [ABC225E] フ

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc225/tasks/abc225_e

二次元平面上の第一象限上に $ N $ 個のフの字があります。

$ i\ (1\ \leq\ i\ \leq\ N) $ 個目のフの字は、$ (x_i-1,y_i) $ と $ (x_i,y_i) $ を結ぶ線分と $ (x_i,y_i-1) $ と $ (x_i,y_i) $ を結ぶ線分の $ 2 $ つを組み合わせた図形です。

あなたは、$ N $ 個のフの字から $ 0 $ 個以上を選び、削除することができます。

適切に削除するフの字を選んだとき、原点から全体が見えるフの字の個数は最大でいくつになりますか？

ここで、原点からあるフの字（便宜上 $ i $ 個目のフの字とする）の全体が見える必要十分条件は、以下の通りです。

- 原点、$ (x_i-1,y_i) $、$ (x_i,y_i) $、$ (x_i,y_i-1) $ の $ 4 $ 点を頂点とする四角形の内部（境界を除く）と他のフの字が共通部分を持たない。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ x_1 $ $ y_1 $ $ x_2 $ $ y_2 $ $ \hspace{0.45cm}\vdots $ $ x_N $ $ y_N $

## 输出格式

原点から全体が見えるフの字の個数の最大値を出力せよ。

## 说明/提示

### 制約

- $ 1\ \leq\ N\ \leq\ 2\ \times\ 10^5 $
- $ 1\ \leq\ x_i,y_i\ \leq\ 10^9 $
- $ (x_i,y_i)\ \neq\ (x_j,y_j)\ (i\ \neq\ j) $
- 入力はすべて整数

### Sample Explanation 1

$ 1 $ 個目のフの字を削除したとき原点からは $ 2 $ 個目のフの字と $ 3 $ 個目のフの字の $ 2 $ つが見えるようになり、これが最大です。 $ 1 $ つのフの字も削除しない場合、原点からは $ 1 $ 個目のフの字のみしか見えません。

### Sample Explanation 2

すべてのフの字を削除せずに残すのが最善です。

## 样例 #1

### 输入

```
3

1 1

2 1

1 2
```

### 输出

```
2
```

## 样例 #2

### 输入

```
10

414598724 87552841

252911401 309688555

623249116 421714323

605059493 227199170

410455266 373748111

861647548 916369023

527772558 682124751

356101507 249887028

292258775 110762985

850583108 796044319
```

### 输出

```
10
```



---

---
title: "[ABC226E] Just one"
layout: "post"
diff: 普及+/提高
pid: AT_abc226_e
tag: []
---

# [ABC226E] Just one

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc226/tasks/abc226_e

$ N $ 頂点 $ M $ 辺の無向グラフが与えられます。 頂点は頂点 $ 1 $ ,頂点 $ 2 $ , $ \ldots $ ,頂点 $ N $、辺は辺 $ 1 $ ,辺 $ 2 $ , $ \ldots $ ,辺 $ M $ と番号付けられており、特に辺 $ i $ $ (1\ \leq\ i\ \leq\ M) $ は頂点 $ U_i $ と頂点 $ V_i $ を結んでいます。 また、このグラフは単純であることが保証されます。すなわち、自己ループや多重辺は存在しません。

このグラフの $ M $ 本の辺すべてに向き付けをする方法は $ 2^M $ 通り考えられますが、 そのうち、どの頂点についても、その頂点から他の頂点に向かう辺がちょうど $ 1 $ 本ずつ存在するような向き付けの方法は何通りありますか。 答えは非常に大きくなる可能性があるので、$ 998244353 $ で割った余りを出力してください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ M $ $ U_1 $ $ V_1 $ $ U_2 $ $ V_2 $ $ \vdots $ $ U_M $ $ V_M $

## 输出格式

答えを出力せよ。

## 说明/提示

### 制約

- $ 2\ \leq\ N\ \leq\ 2\times\ 10^5 $
- $ 1\ \leq\ M\ \leq\ 2\times\ 10^5 $
- $ 1\ \leq\ U_i,V_i\ \leq\ N $
- $ U_i\ \neq\ V_i $
- 入力は全て整数である。
- 与えられるグラフは単純である。

### Sample Explanation 1

条件をみたす辺の向き付けの方法は、 - $ 1\rightarrow\ 2 $ , $ 2\rightarrow\ 3 $ , $ 1\leftarrow\ 3 $ - $ 1\leftarrow\ 2 $ , $ 2\leftarrow\ 3 $ , $ 1\rightarrow\ 3 $ の $ 2 $ 通りです。

### Sample Explanation 2

すべての頂点から $ 1 $ 本ずつ辺が出ているようにすることは明らかに不可能です。

## 样例 #1

### 输入

```
3 3

1 2

1 3

2 3
```

### 输出

```
2
```

## 样例 #2

### 输入

```
2 1

1 2
```

### 输出

```
0
```

## 样例 #3

### 输入

```
7 7

1 2

2 3

3 4

4 2

5 6

6 7

7 5
```

### 输出

```
4
```



---

---
title: "[ABC227D] Project Planning"
layout: "post"
diff: 普及+/提高
pid: AT_abc227_d
tag: []
---

# [ABC227D] Project Planning

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc227/tasks/abc227_d

キーエンスには $ N $ 個の部署があり、$ i\,(1\ \leq\ i\ \leq\ N) $ 番目の部署には $ A_i $ 人の社員が所属しています。異なる部署に同じ社員が所属していることはありません。

キーエンスは、部署をまたいだ全社横断プロジェクトを計画しています。$ 1 $ つのプロジェクトは $ K $ 個の相異なる部署から $ 1 $ 人ずつ選出して作り、ちょうど $ K $ 人から構成されるようにします。

プロジェクトは最大でいくつ作れますか？ただし、$ 1 $ 人が複数のプロジェクトに参加することはできません。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ K $ $ A_1 $ $ A_2 $ $ \ldots $ $ A_N $

## 输出格式

プロジェクトの個数の最大値を出力せよ。

## 说明/提示

### 制約

- $ 1\ \leq\ K\ \leq\ N\ \leq\ 2\ \times\ 10^5 $
- $ 1\ \leq\ A_i\ \leq\ 10^{12} $
- 入力は全て整数

### Sample Explanation 1

$ 3 $ 個の部署それぞれから $ 1 $ 人ずつ選出したプロジェクトを $ 2 $ つ作ることができます。

## 样例 #1

### 输入

```
3 3

2 3 4
```

### 输出

```
2
```

## 样例 #2

### 输入

```
4 2

1 1 3 4
```

### 输出

```
4
```

## 样例 #3

### 输入

```
4 3

1 1 3 4
```

### 输出

```
2
```



---

---
title: "[ABC228E] Integer Sequence Fair"
layout: "post"
diff: 普及+/提高
pid: AT_abc228_e
tag: []
---

# [ABC228E] Integer Sequence Fair

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc228/tasks/abc228_e

整数列を一堂に集めてその優劣を定める、整数列品評会が行われます。 品評会では、$ 1 $ 以上 $ K $ 以下の整数からなる長さ $ N $ の整数列すべてが審査対象となり、 審査対象の数列それぞれに対して $ 1 $ 以上 $ M $ 以下の整数の点数をつけます。

「審査対象の数列それぞれに対して $ 1 $ 以上 $ M $ 以下の整数の点数をつける方法」が何通りあるかを $ 998244353 $ で割ったあまりを出力してください。

ただし、$ 2 $ つの方法が異なるとは「審査対象となるある数列 $ A\ =\ (A_1,\ A_2,\ \ldots,\ A_N) $ が存在して、 $ A $ に対してつける点数が $ 2 $ つの方法で異なる」ことを言います。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ K $ $ M $

## 输出格式

「審査対象の数列それぞれに対して $ 1 $ 以上 $ M $ 以下の整数の点数をつける方法」が何通りあるかを $ 998244353 $ で割ったあまりを出力せよ。

## 说明/提示

### 制約

- $ 1\ \leq\ N,\ K,\ M\ \leq\ 10^{18} $
- $ N,\ K,\ M $ は整数

### Sample Explanation 1

審査対象となる数列は、$ (1,\ 1),\ (1,\ 2),\ (2,\ 1),\ (2,\ 2) $ の $ 4 $ つです。「審査対象の数列それぞれに対して $ 1 $ 以上 $ 2 $ 以下の整数の点数をつける方法」は、以下の $ 16 $ 通りあります。 - $ (1,\ 1) $ に $ 1 $ 点、$ (1,\ 2) $ に $ 1 $ 点、$ (2,\ 1) $ に $ 1 $ 点、$ (2,\ 2) $ に $ 1 $ 点をつける方法 - $ (1,\ 1) $ に $ 1 $ 点、$ (1,\ 2) $ に $ 1 $ 点、$ (2,\ 1) $ に $ 1 $ 点、$ (2,\ 2) $ に $ 2 $ 点をつける方法 - $ (1,\ 1) $ に $ 1 $ 点、$ (1,\ 2) $ に $ 1 $ 点、$ (2,\ 1) $ に $ 2 $ 点、$ (2,\ 2) $ に $ 1 $ 点をつける方法 - $ (1,\ 1) $ に $ 1 $ 点、$ (1,\ 2) $ に $ 1 $ 点、$ (2,\ 1) $ に $ 2 $ 点、$ (2,\ 2) $ に $ 2 $ 点をつける方法 - $ \cdots $ - $ (1,\ 1) $ に $ 2 $ 点、$ (1,\ 2) $ に $ 2 $ 点、$ (2,\ 1) $ に $ 2 $ 点、$ (2,\ 2) $ に $ 2 $ 点をつける方法 よって、$ 16 $ を出力します。

### Sample Explanation 2

$ 998244353 $ で割ったあまりを出力することに注意してください。

## 样例 #1

### 输入

```
2 2 2
```

### 输出

```
16
```

## 样例 #2

### 输入

```
3 14 15926535
```

### 输出

```
109718301
```



---

---
title: "[ABC231E] Minimal payments"
layout: "post"
diff: 普及+/提高
pid: AT_abc231_e
tag: []
---

# [ABC231E] Minimal payments

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc231/tasks/abc231_e

Atcoder 王国では $ A_1 $ 円, $ A_2 $ 円, $ \ldots $, $ A_N $ 円の $ N $ 種類の硬貨が使用されています。  
 ここで、$ 1=A_1\ <\ \ldots\ <\ A_N $ であり、全ての $ 1\leq\ i\ \leq\ N-1 $ に対し、$ A_{i+1} $ は $ A_i $ の倍数です。

硬貨のみを使って $ X $ 円を支払うとき、支払いに使う硬貨の枚数とお釣りでもらう硬貨の枚数の合計の最小値はいくつですか？

正確には、$ Y $ が $ X $ 以上の整数を自由に動く時、$ Y $ 円ちょうどを表すために必要な硬貨の枚数と、$ Y-X $ 円ちょうどを表すために必要な硬貨の枚数の和の最小値を求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ X $ $ A_1 $ $ \ldots $ $ A_N $

## 输出格式

答えを出力せよ。

## 说明/提示

### 制約

- 入力に含まれる値は全て整数である
- $ 1\ \leq\ N\ \leq\ 60 $
- $ 1=A_1\ <\ \ldots\ <\ A_N\ \leq\ 10^{18} $
- 全ての $ 1\leq\ i\ \leq\ N-1 $ で $ A_{i+1} $ は $ A_i $ の倍数である
- $ 1\leq\ X\ \leq\ 10^{18} $

### Sample Explanation 1

$ 100 $ 円硬貨 $ 1 $ 枚で支払いを行い、$ 10 $ 円硬貨 $ 1 $ 枚と $ 1 $ 円硬貨 $ 3 $ 枚をお釣りでもらうと、合計枚数は $ 5 $ 枚になります。

### Sample Explanation 2

$ 7 $ 円硬貨 $ 7 $ 枚で支払いを行うのが最適です。

## 样例 #1

### 输入

```
3 87

1 10 100
```

### 输出

```
5
```

## 样例 #2

### 输入

```
2 49

1 7
```

### 输出

```
7
```

## 样例 #3

### 输入

```
10 123456789012345678

1 100 10000 1000000 100000000 10000000000 1000000000000 100000000000000 10000000000000000 1000000000000000000
```

### 输出

```
233
```



---

---
title: "[ABC231F] Jealous Two"
layout: "post"
diff: 普及+/提高
pid: AT_abc231_f
tag: []
---

# [ABC231F] Jealous Two

## 题目描述

&emsp;滑头君要给他的两个好基友 A、B 每人送一个礼物。\
&emsp;滑头君有 **$ N $ 种**礼物，对于每种礼物，两个好基友都有不同的喜爱值。\
&emsp;两个好基友非常嫉妒。对于任意一个人来说，如果对方收到的礼物对自己的喜爱值比自己的礼物对自己的喜爱值更高，换句话说就是如果有人更喜欢对方的礼物的话，两个人就会打架。\
&emsp;滑头君不想失去他的朋友，于是请你求出共有几种可能的送礼方案。  
**请注意，可以给两个人送同样的礼物。**

## 输入格式

>第一行一个整数 $ N $  
第二行 $ N $ 个整数$ A_1 $ $ \ldots $ $ A_N $ 表示 A 对第 $i$个礼物的喜欢值。  
第三行 $ N $ 个整数$ B_1 $ $ \ldots $ $ B_N $ 表示 B 对第 $i$个礼物的喜欢值。

## 输出格式

输出可能的方案数。

## 样例 #1

### 输入

```
3

50 100 150

1 3 2
```

### 输出

```
4
```

## 样例 #2

### 输入

```
3

123456789 123456 123

987 987654 987654321
```

### 输出

```
6
```

## 样例 #3

### 输入

```
10

3 1 4 1 5 9 2 6 5 3

2 7 1 8 2 8 1 8 2 8
```

### 输出

```
37
```



---

---
title: "[ABC232E] Rook Path"
layout: "post"
diff: 普及+/提高
pid: AT_abc232_e
tag: []
---

# [ABC232E] Rook Path

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc232/tasks/abc232_e

縦 $ H $ 行、横 $ W $ 行の $ H\ \times\ W $ マスからなるグリッドがあります。上から $ i $ 行目、左から $ j $ 列目のマスを $ (i,\ j) $ と表します。

はじめ、マス $ (x_1,\ y_1) $ にルークが置かれており、高橋君は以下の操作を $ K $ 回行います。

- 現在ルークが置かれているマスと行または列が同じマスにルークを移動させる。ただし、現在ルークが置かれているマスとは異なるマスに移動させる必要がある。

$ K $ 回の操作の後、ルークがマス $ (x_2,\ y_2) $ に置かれているようにする方法は何通りありますか？答えは非常に大きくなることがあるので、$ 998244353 $ で割った余りを求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ H $ $ W $ $ K $ $ x_1 $ $ y_1 $ $ x_2 $ $ y_2 $

## 输出格式

$ K $ 回の操作の後、ルークがマス $ (x_2,\ y_2) $ に置かれているようにする方法の総数を $ 998244353 $ で割った余りを出力せよ。

## 说明/提示

### 制約

- $ 2\ \leq\ H,\ W\ \leq\ 10^9 $
- $ 1\ \leq\ K\ \leq\ 10^6 $
- $ 1\ \leq\ x_1,\ x_2\ \leq\ H $
- $ 1\ \leq\ y_1,\ y_2\ \leq\ W $

### Sample Explanation 1

以下の $ 2 $ 通りです。 - $ 1 $ 回目の操作でルークをマス $ (1,\ 2) $ からマス $ (1,\ 1) $ へ動かし、$ 2 $ 回目の操作でルークをマス $ (1,\ 1) $ からマス $ (2,\ 1) $ に動かす。 - $ 1 $ 回目の操作でルークをマス $ (1,\ 2) $ からマス $ (2,\ 2) $ へ動かし、$ 2 $ 回目の操作でルークをマス $ (2,\ 2) $ からマス $ (2,\ 1) $ に動かす。

### Sample Explanation 2

$ 998244353 $ で割った余りを求めなければならないことに注意して下さい。

## 样例 #1

### 输入

```
2 2 2

1 2 2 1
```

### 输出

```
2
```

## 样例 #2

### 输入

```
1000000000 1000000000 1000000

1000000000 1000000000 1000000000 1000000000
```

### 输出

```
24922282
```

## 样例 #3

### 输入

```
3 3 3

1 3 3 3
```

### 输出

```
9
```



---

---
title: "[ABC232F] Simple Operations on Sequence"
layout: "post"
diff: 普及+/提高
pid: AT_abc232_f
tag: []
---

# [ABC232F] Simple Operations on Sequence

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc232/tasks/abc232_f

長さ $ N $ の $ 2 $ つの整数列 $ A\ =\ (A_1,\ A_2,\ \ldots,\ A_N) $ および $ B\ =\ (B_1,\ B_2\ \ldots,\ B_N) $ が与えられます。

整数列 $ A $ に対して、「下記の $ 2 $ つの操作のうちどちらかを行う」ということを好きな回数（ $ 0 $ 回でもよい）繰り返すことができます。

- $ 1\ \leq\ i\ \leq\ N $ を満たす整数 $ i $ を選び、$ A_i $ の値を $ 1 $ 増やすか $ 1 $ 減らす。この操作には $ X $ 円の費用がかかる。
- $ 1\ \leq\ i\ \leq\ N-1 $ を満たす整数 $ i $ を選び、$ A_i $ の値と $ A_{i+1} $ の値を入れ替える。この操作には $ Y $ 円の費用がかかる。

上記の繰り返しによって整数列 $ A $ を整数列 $ B $ に一致させるためにかかる合計費用としてあり得る最小値を出力してください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ X $ $ Y $ $ A_1 $ $ A_2 $ $ \ldots $ $ A_N $ $ B_1 $ $ B_2 $ $ \ldots $ $ B_N $

## 输出格式

$ A $ を $ B $ に一致させるためにかかる合計費用としてあり得る最小値を求めよ。

## 说明/提示

### 制約

- $ 2\ \leq\ N\ \leq\ 18 $
- $ 1\ \leq\ X\ \leq\ 10^8 $
- $ 1\ \leq\ Y\ \leq\ 10^{16} $
- $ 1\ \leq\ A_i,\ B_i\ \leq\ 10^8 $
- 入力はすべて整数

### Sample Explanation 1

はじめ、$ A\ =\ (4,\ 2,\ 5,\ 2) $ です。 下記の通りに操作を行うと、$ A $ を $ B $ に一致させることができます。 - $ X\ =\ 3 $ 円払い、$ A_3 $ の値を $ 1 $ 増やす。その結果 $ A\ =\ (4,\ 2,\ 6,\ 2) $ となる。 - $ Y\ =\ 5 $ 円払い、$ A_2 $ の値と $ A_3 $ の値を入れ替える。その結果 $ A\ =\ (4,\ 6,\ 2,\ 2) $ となる。 - $ Y\ =\ 5 $ 円払い、$ A_1 $ の値と $ A_2 $ の値を入れ替える。その結果 $ A\ =\ (6,\ 4,\ 2,\ 2) $ となる。 - $ X\ =\ 3 $ 円払い、$ A_4 $ の値を $ 1 $ 減らす。その結果 $ A\ =\ (6,\ 4,\ 2,\ 1)\ =\ B $ となる。 上記の操作にかかる費用の合計は $ 3+5+5+3\ =\ 16 $ 円であり、これが最小となります。

### Sample Explanation 2

$ A $ と $ B $ は初めから一致しているため、一度も操作を行う必要がありません。

### Sample Explanation 3

入力や出力が $ 32 $ bit 整数型に収まらないことがあることに注意してください。

## 样例 #1

### 输入

```
4 3 5

4 2 5 2

6 4 2 1
```

### 输出

```
16
```

## 样例 #2

### 输入

```
5 12345 6789

1 2 3 4 5

1 2 3 4 5
```

### 输出

```
0
```

## 样例 #3

### 输入

```
18 20719114 5117250357733867

10511029 36397527 63027379 44706927 47672230 79861204 57882493 42931589 51053644 52300688 43971370 26515475 62139996 41282303 34022578 12523039 6696497 64922712

14720753 4621362 25269832 91410838 86751784 32741849 6602693 60719353 28911226 88280613 18745325 80675202 34289776 37849132 99280042 73760634 43897718 40659077
```

### 输出

```
13104119429316474
```



---

---
title: "[ABC234F] Reordering"
layout: "post"
diff: 普及+/提高
pid: AT_abc234_f
tag: []
---

# [ABC234F] Reordering

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc234/tasks/abc234_f

文字列 $ S $ が与えられます。$ S $ の空でない、**連続するとは限らない**部分列を並び替えて得られる文字列は何種類ありますか？

答えは非常に大きくなる場合があるので、$ 998244353 $ で割ったあまりを出力してください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ S $

## 输出格式

$ S $ の部分列を並び替えて得られる文字列の種類数を $ 998244353 $ で割ったあまりを出力せよ。

## 说明/提示

### 制約

- $ S $ は英小文字のみからなる長さ $ 1 $ 以上 $ 5000 $ 以下の文字列

### Sample Explanation 1

$ S $ の部分列を並び替えて得られる文字列は、`a`, `b`, `aa`, `ab`, `ba`, `aab`, `aba`, `baa` の $ 8 $ 種類です。

### Sample Explanation 3

$ 998244353 $ で割ったあまりを出力することに注意してください。

## 样例 #1

### 输入

```
aab
```

### 输出

```
8
```

## 样例 #2

### 输入

```
aaa
```

### 输出

```
3
```

## 样例 #3

### 输入

```
abcdefghijklmnopqrstuvwxyz
```

### 输出

```
149621752
```



---

---
title: "[ABC235E] MST + 1"
layout: "post"
diff: 普及+/提高
pid: AT_abc235_e
tag: []
---

# [ABC235E] MST + 1

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc235/tasks/abc235_e

$ N $ 頂点 $ M $ 辺の重み付き無向連結グラフ $ G $ が与えられます。$ G $ には自己ループや多重辺が含まれている可能性があります。  
 頂点には頂点 $ 1 $, 頂点 $ 2 $, $ \dots $, 頂点 $ N $ と番号がついています。  
 辺には辺 $ 1 $, 辺 $ 2 $, $ \dots $, 辺 $ M $ と番号がついています。辺 $ i $ は頂点 $ a_i $ と頂点 $ b_i $ を結ぶ重み $ c_i $ の辺です。ここで、$ 1\ \leq\ i\ \lt\ j\ \leq\ M $ を満たすすべての整数の組 $ (i,\ j) $ について $ c_i\ \neq\ c_j $ が成り立ちます。

以下で説明される $ Q $ 個のクエリに答えてください。  
 $ i $ 番目のクエリでは整数の組 $ (u_i,\ v_i,\ w_i) $ が与えられます。ここで、$ 1\ \leq\ j\ \leq\ M $ を満たすすべての整数 $ j $ について $ w_i\ \neq\ c_j $ が成り立ちます。   
 頂点 $ u_i $ と頂点 $ v_i $ を結ぶ重み $ w_i $ の無向辺を $ e_i $ として、$ G $ に $ e_i $ を追加してできるグラフ $ G_i $ を考えます。 このとき $ G_i $ の最小全域木 $ T_i $ は一意に定まることが証明できますが、$ T_i $ に $ e_i $ は含まれるでしょうか？答えを `Yes` あるいは `No` で出力してください。

ここで、クエリの前後で $ G $ は変化しないことに注意してください。言い換えると、クエリ $ i $ で $ G $ に $ e_i $ を追加したグラフを考えたとしても、他のクエリで出てくる $ G $ に $ e_i $ が追加されていることはありません。

 最小全域木とは？ $ G $ の **全域木** とは、$ G $ に含まれるすべての頂点と $ G $ に含まれる辺の一部からなる木のことを言います。  
 $ G $ の **最小全域木** とは、$ G $ の全域木の中で辺の重みの和が最小である木のことを言います。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ M $ $ Q $ $ a_1 $ $ b_1 $ $ c_1 $ $ a_2 $ $ b_2 $ $ c_2 $ $ \vdots $ $ a_M $ $ b_M $ $ c_M $ $ u_1 $ $ v_1 $ $ w_1 $ $ u_2 $ $ v_2 $ $ w_2 $ $ \vdots $ $ u_Q $ $ v_Q $ $ w_Q $

## 输出格式

$ Q $ 行出力せよ。$ i $ 行目ではクエリ $ i $ への答えを `Yes` または `No` で出力せよ。

## 说明/提示

### 制約

- $ 2\ \leq\ N\ \leq\ 2\ \times\ 10^5 $
- $ N\ -\ 1\ \leq\ M\ \leq\ 2\ \times\ 10^5 $
- $ 1\ \leq\ a_i\ \leq\ N $ $ (1\ \leq\ i\ \leq\ M) $
- $ 1\ \leq\ b_i\ \leq\ N $ $ (1\ \leq\ i\ \leq\ M) $
- $ 1\ \leq\ c_i\ \leq\ 10^9 $ $ (1\ \leq\ i\ \leq\ M) $
- $ c_i\ \neq\ c_j $ $ (1\ \leq\ i\ \lt\ j\ \leq\ M) $
- グラフ $ G $ は連結である。
- $ 1\ \leq\ Q\ \leq\ 2\ \times\ 10^5 $
- $ 1\ \leq\ u_i\ \leq\ N $ $ (1\ \leq\ i\ \leq\ Q) $
- $ 1\ \leq\ v_i\ \leq\ N $ $ (1\ \leq\ i\ \leq\ Q) $
- $ 1\ \leq\ w_i\ \leq\ 10^9 $ $ (1\ \leq\ i\ \leq\ Q) $
- $ w_i\ \neq\ c_j $ $ (1\ \leq\ i\ \leq\ Q,\ 1\ \leq\ j\ \leq\ M) $
- 入力はすべて整数である。

### Sample Explanation 1

以下では頂点 $ u $ と頂点 $ v $ を結ぶ重み $ w $ の無向辺を $ (u,v,w) $ と表します。 $ G $ を図に表したものを以下に挙げます。 !\[image\](https://img.atcoder.jp/ghi/15ac15edee5a8b055f65192d7323d43b.png) たとえばクエリ $ 1 $ では $ G $ に $ e_1\ =\ (1,3,1) $ を追加したグラフ $ G_1 $ を考えます。$ G_1 $ の最小全域木 $ T_1 $ の辺集合は $ \lbrace\ (1,2,2),(1,3,1),(2,4,5),(3,5,8)\ \rbrace $ であり $ e_1 $ を含みます。よって `Yes` を出力します。

## 样例 #1

### 输入

```
5 6 3

1 2 2

2 3 3

1 3 6

2 4 5

4 5 9

3 5 8

1 3 1

3 4 7

3 5 7
```

### 输出

```
Yes

No

Yes
```

## 样例 #2

### 输入

```
2 3 2

1 2 100

1 2 1000000000

1 1 1

1 2 2

1 1 5
```

### 输出

```
Yes

No
```



---

---
title: "[ABC236E] Average and Median"
layout: "post"
diff: 普及+/提高
pid: AT_abc236_e
tag: []
---

# [ABC236E] Average and Median

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc236/tasks/abc236_e

$ N $ 枚のカードがあり、$ i\ \,\ (1\ \leq\ i\ \leq\ N) $ 番目のカードには整数 $ A_i $ が書かれています。

高橋君は、これらのカードから好きな枚数選びます。ただし、各 $ i\ \,\ (1\ \leq\ i\ \leq\ N\ -\ 1) $ について、$ i $ 番目のカードと $ i\ +\ 1 $ 番目のカードの少なくとも一方を選ぶ必要があります。

以下の値を求めてください。

- 選んだカードに書かれた整数の平均値としてあり得る最大値
- 選んだカードに書かれた整数の中央値としてあり得る最大値

ただし、$ n $ 個の整数の中央値は、それらのうち小さい方から数えて $ \lceil\ \frac{n}{2}\ \rceil $ 番目であるものとします。ここで、$ \lceil\ x\ \rceil $ は $ x $ 以上の最小の整数を表します。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ A_1 $ $ \ldots $ $ A_N $

## 输出格式

$ 2 $ 行出力せよ。$ 1 $ 行目には選んだカードに書かれた整数の平均値としてあり得る最大値を、$ 2 $ 行目には選んだカードに書かれた整数の中央値としてあり得る最大値を出力せよ。 平均値の出力については、正しい値との相対誤差または絶対誤差が $ 10^{-3} $ 以下であれば正答とみなされる。

## 说明/提示

### 制約

- $ 2\ \leq\ N\ \leq\ 10^5 $
- $ 1\ \leq\ A_i\ \leq\ 10^{9} $
- 入力は全て整数である。

### Sample Explanation 1

$ 2 $ 番目、$ 4 $ 番目、$ 6 $ 番目のカードを選ぶと、書かれた整数の平均は $ \frac{12}{3}\ =\ 4 $ となり、これが最大です。 $ 1 $ 番目、$ 3 $ 番目、$ 5 $ 番目、$ 6 $ 番目のカードを選ぶと、書かれた整数の中央値は $ 2 $ となり、これが最大です。

### Sample Explanation 2

平均値の出力については誤差が認められるので、例えば $ 5.2491 $ と出力しても正答とみなされます。ただし、中央値は正確な値を出力しなければなりません。

## 样例 #1

### 输入

```
6

2 1 2 1 1 10
```

### 输出

```
4

2
```

## 样例 #2

### 输入

```
7

3 1 4 1 5 9 2
```

### 输出

```
5.250000000

4
```



---

---
title: "[ABC237F] |LIS| = 3"
layout: "post"
diff: 普及+/提高
pid: AT_abc237_f
tag: []
---

# [ABC237F] |LIS| = 3

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc237/tasks/abc237_f

以下の条件を全て満たす数列の個数を、$ 998244353 $ で割った余りを求めてください。

- 数列の長さが $ N $
- 数列の各項は $ 1 $ 以上 $ M $ 以下の整数
- 最長増加部分列の長さがちょうど $ 3 $

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ M $

## 输出格式

答えを出力せよ。

## 说明/提示

### 注記

数列の**部分列**とは、数列から $ 0 $ 個以上の要素を取り除いた後、残りの要素を元の順序で連結して得られる数列のことをいいます。  
 例えば、$ (10,30) $ は $ (10,20,30) $ の部分列ですが、$ (20,10) $ は $ (10,20,30) $ の部分列ではありません。

数列の**最長増加部分列**とは、数列の**狭義**単調増加な部分列のうち、長さが最大のもののことをいいます。

### 制約

- $ 3\ \leq\ N\ \leq\ 1000 $
- $ 3\ \leq\ M\ \leq\ 10 $
- 入力は全て整数である

### Sample Explanation 1

例えば $ (3,4,1,5) $ は条件を満たす数列です。 一方 $ (4,4,1,5) $ は最長増加部分列の長さが $ 2 $ なので条件を満たしません。

### Sample Explanation 3

$ 998244353 $ で割った余りを求めてください。

## 样例 #1

### 输入

```
4 5
```

### 输出

```
135
```

## 样例 #2

### 输入

```
3 4
```

### 输出

```
4
```

## 样例 #3

### 输入

```
111 3
```

### 输出

```
144980434
```



---

---
title: "[ABC238E] Range Sums"
layout: "post"
diff: 普及+/提高
pid: AT_abc238_e
tag: []
---

# [ABC238E] Range Sums

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc238/tasks/abc238_e

高橋くんは秘密の整数列 $ a $ を持っており、現時点で、$ a $ の長さが $ N $ であることは分かっています。

$ a $ の中身を当てたいあなたに対し、高橋くんは以下の $ Q $ 個の情報を追加で与えてくれることを約束しました。

- $ i\ (1\ \leq\ i\ \leq\ Q) $ 個目の情報: $ a_{l_i}+a_{l_i+1}+\cdots+a_{r_i} $ の値

高橋くんが約束を守り、$ Q $ 個の情報すべてが与えられた場合、$ a $ に含まれる全要素の総和 $ a_1+a_2+\cdots+a_N $ を特定することは可能ですか？

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ Q $ $ l_1 $ $ r_1 $ $ l_2 $ $ r_2 $ $ \hspace{0.4cm}\vdots $ $ l_Q $ $ r_Q $

## 输出格式

$ a $ に含まれる全要素の総和を特定することが可能なら `Yes` を、そうでないなら `No` を出力せよ。

## 说明/提示

### 制約

- $ 1\ \leq\ N\ \leq\ 2\ \times\ 10^5 $
- $ 1\ \leq\ Q\ \leq\ \min(2\ \times\ 10^5,\frac{N(N+1)}{2}) $
- $ 1\ \leq\ l_i\ \leq\ r_i\ \leq\ N $
- $ (l_i,r_i)\ \neq\ (l_j,r_j)\ (i\ \neq\ j) $
- 入力はすべて整数

### Sample Explanation 1

$ 1 $ 個目の情報と $ 2 $ 個目の情報から、$ a_1+a_2+a_2+a_3 $ の値が分かります。そこから $ 3 $ 個目の情報によって得られる $ a_2 $ の値を引くと、$ a_1+a_2+a_3 $ の値を特定可能です。

### Sample Explanation 2

$ a $ の先頭 $ 3 $ 項の総和を特定することは可能ですが、全要素の総和を特定することは不可能です。

### Sample Explanation 3

$ 4 $ 個目の情報によって全要素の総和が直接与えられています。

## 样例 #1

### 输入

```
3 3

1 2

2 3

2 2
```

### 输出

```
Yes
```

## 样例 #2

### 输入

```
4 3

1 3

1 2

2 3
```

### 输出

```
No
```

## 样例 #3

### 输入

```
4 4

1 1

2 2

3 3

1 4
```

### 输出

```
Yes
```



---

---
title: "[ABC240F] Sum Sum Max"
layout: "post"
diff: 普及+/提高
pid: AT_abc240_f
tag: []
---

# [ABC240F] Sum Sum Max

## 题目描述

有三个数列 $A,B,C$。

其中 $C$ 表示为 $ x_1,\ \dots,\ x_N,\ y_1,\ \dots,\ y_N $ 的形式，意思是前 $y_1$ 个数为 $x_1$,之后 $y_2$ 个数为 $x_2$……最后 $y_N$ 个数为 $x_N$。

$B$ 为 $C$ 的前缀和数组。

$A$ 为 $B$ 的前缀和数组。

求 $A$ 中最大值。

## 输入格式

对于每组数据，

第一行为两个数 $N$ 和 $M$，

第 $2$ 至 $N+1$ 行，第 $i$ 行为两个数 $x_{i-1}$ 和 $y_{i-1}$。

## 输出格式

对于每组数据，输出一行一个整数表示答案

## 样例 #1

### 样例输入 #1

```
3
3 7
-1 2
2 3
-3 2
10 472
-4 12
1 29
2 77
-1 86
0 51
3 81
3 17
-2 31
-4 65
4 23
1 1000000000
4 1000000000
```

### 样例输出 #1

```
4
53910
2000000002000000000
```

## 说明/提示

- $ 1\ \leq\ T\ \leq\ 2\ \times\ 10^5 $
- $ 1\ \leq\ N\ \leq\ 2\ \times\ 10^5 $
- $ \sum\ N\ \leq\ 2\times\ 10^5 $
- $ 1\ \leq\ M\ \leq\ 10^9 $
- $ |x_i|\ \leq\ 4\ \,\ (1\ \leq\ i\ \leq\ N) $
- $ y_i\ \gt\ 0\ \,\ (1\ \leq\ i\ \leq\ N) $
- $ \sum_{k\ =\ 1}^N\ y_k\ =\ M $

## 样例 #1

### 输入

```
3

3 7

-1 2

2 3

-3 2

10 472

-4 12

1 29

2 77

-1 86

0 51

3 81

3 17

-2 31

-4 65

4 23

1 1000000000

4 1000000000
```

### 输出

```
4

53910

2000000002000000000
```



---

---
title: "[ABC241F] Skate"
layout: "post"
diff: 普及+/提高
pid: AT_abc241_f
tag: []
---

# [ABC241F] Skate

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc241/tasks/abc241_f

$ H $ 行 $ W $ 列のグリッド型のスケート場があります。上から $ i $ 行目、左から $ j $ 行目のマスを $ (i,j) $ で表します。

スケート場には $ N $ 個の障害物があり、$ i $ 個目の障害物は $ (X_i,Y_i) $ に置かれています。

高橋君は $ 1 $ 回の移動において、上下左右いずれかの方向を選んで、障害物に当たるまで進み続けます。  
 障害物に当たるとその $ 1 $ つ手前のマスで停止します。 なお、スケート場の周りは崖になっており、障害物に当たらないような移動は禁止とします。

高橋君ははじめ $ (s_x,s_y) $ にいて、何回か移動することで $ (g_x,g_y) $ で停止したいと考えています。

$ (g_x,g_y) $ へ辿り着くには最小で何回の移動が必要ですか？辿り着けないときはその旨を伝えてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ H $ $ W $ $ N $ $ s_x $ $ s_y $ $ g_x $ $ g_y $ $ X_1 $ $ Y_1 $ $ X_2 $ $ Y_2 $ $ \vdots $ $ X_N $ $ Y_N $

## 输出格式

$ (g_x,g_y) $ へ辿り着くには最小で何回の移動が必要か出力せよ。  
 ただし、辿り着けないならば `-1` と出力せよ。

## 说明/提示

### 制約

- $ 1\leq\ H\ \leq\ 10^9 $
- $ 1\leq\ W\ \leq\ 10^9 $
- $ 1\leq\ N\ \leq\ 10^5 $
- $ 1\leq\ s_x,g_x\leq\ H $
- $ 1\leq\ s_y,g_y\leq\ W $
- $ 1\leq\ X_i\ \leq\ H $
- $ 1\leq\ Y_i\ \leq\ W $
- $ (s_x,s_y)\neq\ (g_x,g_y) $
- $ (s_x,s_y)\neq\ (X_i,Y_i) $
- $ (g_x,g_y)\neq\ (X_i,Y_i) $
- $ i\neq\ j $ ならば、$ (X_i,Y_i)\neq\ (X_j,Y_j) $
- 入力は全て整数である

### Sample Explanation 1

!\[\](https://img.atcoder.jp/ghi/c376ca3813eb4c947eb605dea2d30454.png) 図は、$ (s_x,s_y) $ を `S` で、$ (g_x,g_y) $ を `G` で表しています。 $ (3,4)\rightarrow(2,4)\ \rightarrow(2,2)\ \rightarrow(5,2)\ \rightarrow(5,6) $ と移動すると、$ 4 $ 回の移動で $ (g_x,g_y) $ に辿り着くことができます。

### Sample Explanation 2

!\[\](https://img.atcoder.jp/ghi/07ab8a3e7c94525cd52704dd43e43b87.png) $ (g_x,g_y) $ で停止する必要があります。 通過しただけでは $ (g_x,g_y) $ へ辿り着いたとみなされないことに注意してください。

### Sample Explanation 3

!\[\](https://img.atcoder.jp/ghi/a423524262f4a075b94e2ab5f9e61164.png) 左を選んで進むと、高橋君は $ (g_x,g_y) $ を通過したのちに崖に落ちてしまいます。 スケート場の周りは崖になっており、障害物に当たらないような移動は禁止されていることに注意してください。

## 样例 #1

### 输入

```
7 8 7

3 4

5 6

1 4

2 1

2 8

4 5

5 7

6 2

6 6
```

### 输出

```
4
```

## 样例 #2

### 输入

```
4 6 2

3 2

3 5

4 5

2 5
```

### 输出

```
-1
```

## 样例 #3

### 输入

```
1 10 1

1 5

1 1

1 7
```

### 输出

```
-1
```



---

---
title: "[ABC242E] (∀x∀)"
layout: "post"
diff: 普及+/提高
pid: AT_abc242_e
tag: []
---

# [ABC242E] (∀x∀)

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc242/tasks/abc242_e

$ T $ 個のテストケースについて、次の問題を解いてください。

整数 $ N $ と文字列 $ S $ が与えられるので、以下の条件を全て満たす文字列 $ X $ の数を $ 998244353 $ で割った余りを求めてください。

- $ X $ は英大文字のみからなる長さ $ N $ の文字列
- $ X $ は回文
- 辞書順で $ X\ \le\ S $
  - すなわち、 $ X=S $ であるか、辞書順で $ X $ が $ S $ より前に来る

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ T $ $ \mathrm{case}_1 $ $ \mathrm{case}_2 $ $ \vdots $ $ \mathrm{case}_T $

ただし、 $ \mathrm{case}_i $ は $ i $ 個目のテストケースを表す。

各テストケースは以下の形式で与えられる。

> $ N $ $ S $

## 输出格式

全体で $ T $ 行出力せよ。  
 $ i $ 行目には $ i $ 個目のテストケースに対する答えを整数として出力せよ。

## 说明/提示

### 制約

- $ 1\ \le\ T\ \le\ 250000 $
- $ N $ は $ 1 $ 以上 $ 10^6 $ 以下の整数
- ひとつの入力について、含まれるテストケースの $ N $ の総和は $ 10^6 $ を超えない
- $ S $ は英大文字のみからなる長さ $ N $ の文字列

### Sample Explanation 1

この入力には $ 5 $ 個のテストケースが含まれます。 $ 1 $ 個目のテストケース: 問題文中の条件を満たす文字列は `AAA`$ , $ `ABA`$ , $ `ACA`$ ,..., $ `AXA` の $ 24 $ 個です。 $ 2 $ 個目のテストケース: $ S $ が回文であるとは限りません。 $ 3 $ 個目のテストケース: $ 998244353 $ で割った余りを求めることに注意してください。

## 样例 #1

### 输入

```
5

3

AXA

6

ABCZAZ

30

QWERTYUIOPASDFGHJKLZXCVBNMQWER

28

JVIISNEOXHSNEAAENSHXOENSIIVJ

31

KVOHEEMSOZZASHENDIGOJRTJVMVSDWW
```

### 输出

```
24

29

212370247

36523399

231364016
```



---

---
title: "[ABC243E] Edge Deletion"
layout: "post"
diff: 普及+/提高
pid: AT_abc243_e
tag: []
---

# [ABC243E] Edge Deletion

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc243/tasks/abc243_e

$ N $ 頂点 $ M $ 辺の単純連結無向グラフが与えられます。  
 辺 $ i $ は頂点 $ A_i $ と頂点 $ B_i $ を結ぶ長さ $ C_i $ の辺です。

以下の条件を満たすようにいくつかの辺を削除します。削除する辺の数の最大値を求めてください。

- 辺を削除した後のグラフも連結である。
- 全ての頂点対 $ (s,t) $ について、頂点 $ s $ と頂点 $ t $ の間の距離が削除前と削除後で変化しない。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ M $ $ A_1 $ $ B_1 $ $ C_1 $ $ A_2 $ $ B_2 $ $ C_2 $ $ \vdots $ $ A_M $ $ B_M $ $ C_M $

## 输出格式

答えを出力せよ。

## 说明/提示

### 注釈

単純連結無向グラフとは、単純かつ連結で辺に向きの無いグラフのことをいいます。  
 グラフが単純であるとは、グラフが自己ループや多重辺を含まないことをいいます。  
 グラフが連結であるとは、グラフ上の任意の $ 2 $ 頂点 $ s,\ t $ について $ s $ から $ t $ へ辺をたどって行けることをいいます。  
 頂点 $ s $ と頂点 $ t $ の間の距離とは、頂点 $ s $ と頂点 $ t $ の間の最短路の長さのことをいいます。

### 制約

- $ 2\ \leq\ N\ \leq\ 300 $
- $ N-1\ \leq\ M\ \leq\ \frac{N(N-1)}{2} $
- $ 1\ \leq\ A_i\ \lt\ B_i\ \leq\ N $
- $ 1\ \leq\ C_i\ \leq\ 10^9 $
- $ i\ \neq\ j $ ならば $ (A_i,\ B_i)\ \neq\ (A_j,\ B_j) $ である。
- 与えられるグラフは連結である。
- 入力はすべて整数である。

### Sample Explanation 1

辺を削除する前の全ての頂点対の距離は次の通りです。 - 頂点 $ 1 $ と頂点 $ 2 $ の距離は $ 2 $ - 頂点 $ 1 $ と頂点 $ 3 $ の距離は $ 5 $ - 頂点 $ 2 $ と頂点 $ 3 $ の距離は $ 3 $ 辺 $ 3 $ を削除しても全ての頂点間の距離は変化しません。また、問題文の条件を満たすように $ 2 $ 本以上の辺を削除することはできないので、答えは $ 1 $ 本になります。

### Sample Explanation 2

どの辺も削除することができません。

## 样例 #1

### 输入

```
3 3

1 2 2

2 3 3

1 3 6
```

### 输出

```
1
```

## 样例 #2

### 输入

```
5 4

1 3 3

2 3 9

3 5 3

4 5 3
```

### 输出

```
0
```

## 样例 #3

### 输入

```
5 10

1 2 71

1 3 9

1 4 82

1 5 64

2 3 22

2 4 99

2 5 1

3 4 24

3 5 18

4 5 10
```

### 输出

```
5
```



---

---
title: "[ABC244F] Shortest Good Path"
layout: "post"
diff: 普及+/提高
pid: AT_abc244_f
tag: []
---

# [ABC244F] Shortest Good Path

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc244/tasks/abc244_f

$ N $ 個の頂点と $ M $ 本の辺からなる単純（自己ループおよび多重辺を持たない）かつ連結な無向グラフが与えられます。  
 $ i\ =\ 1,\ 2,\ \ldots,\ M $ について、$ i $ 番目の辺は頂点 $ u_i $ と頂点 $ v_i $ を結びます。

下記の $ 2 $ つの条件をともに満たす整数列 $ (A_1,\ A_2,\ \ldots,\ A_k) $ を長さ $ k $ の**パス**と呼びます。

- すべての $ i\ =\ 1,\ 2,\ \dots,\ k $ について、$ 1\ \leq\ A_i\ \leq\ N $ 。
- すべての $ i\ =\ 1,\ 2,\ \ldots,\ k-1 $ について、頂点 $ A_i $ と頂点 $ A_{i+1} $ は辺で直接結ばれている。

空列も長さ $ 0 $ のパスとみなします。

$ S\ =\ s_1s_2\ldots\ s_N $ を $ 0 $ と $ 1 $ のみからなる長さ $ N $ の文字列とします。 パス $ A\ =\ (A_1,\ A_2,\ \ldots,\ A_k) $ が下記を満たすとき、パス $ A $ を $ S $ に関する**良いパス**と呼びます。

- すべての $ i\ =\ 1,\ 2,\ \ldots,\ N $ について、次を満たす。
  - $ s_i\ =\ 0 $ ならば、$ A $ に含まれる $ i $ の個数は偶数である。
  - $ s_i\ =\ 1 $ ならば、$ A $ に含まれる $ i $ の個数は奇数である。

$ S $ として考えられる文字列（すなわち、$ 0 $ と $ 1 $ のみからなる長さ $ N $ の文字列）は $ 2^N $ 個ありますが、そのすべてにわたる「 $ S $ に関する良いパスのうち最短のものの長さ」の総和を出力してください。

この問題の制約下において、$ 0 $ と $ 1 $ からなる長さ $ N $ のどのような文字列を $ S $ として選んでも、$ S $ に関する良いパスが少なくとも $ 1 $ つ存在することが示せます。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ M $ $ u_1 $ $ v_1 $ $ u_2 $ $ v_2 $ $ \vdots $ $ u_M $ $ v_M $

## 输出格式

答えを出力せよ。

## 说明/提示

### 制約

- $ 2\ \leq\ N\ \leq\ 17 $
- $ N-1\ \leq\ M\ \leq\ \frac{N(N-1)}{2} $
- $ 1\ \leq\ u_i,\ v_i\ \leq\ N $
- 与えられるグラフは単純かつ連結
- 入力はすべて整数

### Sample Explanation 1

\- $ S\ =\ 000 $ のとき、空列 $ () $ は $ S $ に関する最短の良いパスであり、その長さは $ 0 $ です。 - $ S\ =\ 100 $ のとき、$ (1) $ は $ S $ に関する最短の良いパスであり、その長さは $ 1 $ です。 - $ S\ =\ 010 $ のとき、$ (2) $ は $ S $ に関する最短の良いパスであり、その長さは $ 1 $ です。 - $ S\ =\ 110 $ のとき、$ (1,\ 2) $ は $ S $ に関する最短の良いパスであり、その長さは $ 2 $ です。 - $ S\ =\ 001 $ のとき、$ (3) $ は $ S $ に関する最短の良いパスであり、その長さは $ 1 $ です。 - $ S\ =\ 101 $ のとき、$ (1,\ 2,\ 3,\ 2) $ は $ S $ に関する最短の良いパスであり、その長さは $ 4 $ です。 - $ S\ =\ 011 $ のとき、$ (2,\ 3) $ は $ S $ に関する最短の良いパスであり、その長さは $ 2 $ です。 - $ S\ =\ 111 $ のとき、$ (1,\ 2,\ 3) $ は $ S $ に関する最短の良いパスであり、その長さは $ 3 $ です。 よって、求める答えは $ 0\ +\ 1\ +\ 1\ +\ 2\ +\ 1\ +\ 4\ +\ 2\ +\ 3\ =\ 14 $ です。

## 样例 #1

### 输入

```
3 2

1 2

2 3
```

### 输出

```
14
```

## 样例 #2

### 输入

```
5 5

4 2

2 3

1 3

2 1

1 5
```

### 输出

```
108
```



---

---
title: "[ABC245E] Wrapping Chocolate"
layout: "post"
diff: 普及+/提高
pid: AT_abc245_e
tag: []
---

# [ABC245E] Wrapping Chocolate

## 题目描述

高桥先生有 $N$ 块巧克力。第 $i$ 块巧克力是长为 $A_i$，宽为 $B_i$ cm 的长方形。高桥先生还有 $M$ 个盒子。第 $i$ 个盒子是长为 $C_i$，宽为 $D_i$ cm 的长方形。

请问是否能在满足以下条件的情况下把所有巧克力放入盒子中。

- 一个盒子中最多放入一块巧克力。
- 当把第 $i$ 块巧克力放入第 $j$ 个盒子的时候，必须满足 $A_i\le C_j$ 并且 $B_i\le D_j$（不允许旋转）。

## 输入格式

从标准格式读入数据，格式如下：

> $N\space M\space A_i … A_N\space B_i … B_N\space C_i … C_M\space D_i … D_M$

## 输出格式

如果可以把所有巧克力都放在盒子里，就输出 ``Yes``，否则输出 ``No``。

### 样例解释 1

把第 $1$ 块巧克力放进第 $3$ 个盒子，把第 $2$ 块巧克力放进第 $1$ 个盒子。

### 样例解释 2

如果想全部放入盒子中，第 $1$ 个盒子至少应该放 $2$ 块巧克力。

## 说明/提示

- $1\le N\le M\le 2\times 10^5$
- $1\le A_i,B_i,C_i,D_i\le 10^9$
- 所有数据均为整数。

—— Translated by 2c_s

## 样例 #1

### 输入

```
2 3

2 4

3 2

8 1 5

2 10 5
```

### 输出

```
Yes
```

## 样例 #2

### 输入

```
2 2

1 1

2 2

100 1

100 1
```

### 输出

```
No
```

## 样例 #3

### 输入

```
1 1

10

100

100

10
```

### 输出

```
No
```

## 样例 #4

### 输入

```
1 1

10

100

10

100
```

### 输出

```
Yes
```



---

---
title: "[ABC245F] Endless Walk"
layout: "post"
diff: 普及+/提高
pid: AT_abc245_f
tag: []
---

# [ABC245F] Endless Walk

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc245/tasks/abc245_f

$ N $ 頂点 $ M $ 辺からなる単純な有向グラフ $ G $ があり、頂点には頂点 $ 1 $, 頂点 $ 2 $, $ \ldots $, 頂点 $ N $ と番号がついています。 また、$ i $ $ (1\leq\ i\leq\ M) $ 本目の辺は頂点 $ U_i $ から頂点 $ V_i $ へ張られています。

高橋君がある頂点から始めて、$ G $ の上を有向辺に沿って頂点から頂点へ移動することを繰り返します。 $ G $ の頂点のうち、高橋君がうまく経路を選ぶことで、その頂点から始めていくらでも移動を繰り返すことができるようなものの個数を求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ M $ $ U_1 $ $ V_1 $ $ U_2 $ $ V_2 $ $ \vdots $ $ U_M $ $ V_M $

## 输出格式

答えを出力せよ。

## 说明/提示

### 制約

- $ 1\ \leq\ N\ \leq\ 2\times\ 10^5 $
- $ 0\ \leq\ M\ \leq\ \min(N(N-1),\ 2\times\ 10^5) $
- $ 1\ \leq\ U_i,V_i\leq\ N $
- $ U_i\neq\ V_i $
- $ i\neq\ j $ ならば $ (U_i,V_i)\neq\ (U_j,V_j) $
- 入力はすべて整数である。

### Sample Explanation 1

頂点 $ 2 $ を始点とした場合、頂点 $ 2 $ $ \to $ 頂点 $ 3 $ $ \to $ 頂点 $ 4 $ $ \to $ 頂点 $ 2 $ $ \to $ 頂点 $ 3 $ $ \to $ $ \cdots $ と高橋君はいくらでも移動を繰り返す事ができます。 頂点 $ 3 $, 頂点 $ 4 $ を始点とした場合も同様です。 頂点 $ 1 $ からは最初に頂点 $ 2 $ に移動して、以下同様にいくらでも行動を繰り返すことができます。 一方、頂点 $ 5 $ からは一度も移動することができません。 よって、条件を満たすのは頂点 $ 1 $, $ 2 $, $ 3 $, $ 4 $ の $ 4 $ つであるので、 $ 4 $ を出力します。

### Sample Explanation 2

単純な有向グラフにおいて、$ 2 $ つの頂点の間を互いに逆向きに結ぶ辺が、ともに存在する事はあり得ることに注意してください。 また、$ G $ は連結であるとは限りません。

## 样例 #1

### 输入

```
5 5

1 2

2 3

3 4

4 2

4 5
```

### 输出

```
4
```

## 样例 #2

### 输入

```
3 2

1 2

2 1
```

### 输出

```
2
```



---

---
title: "[ABC246E] Bishop 2"
layout: "post"
diff: 普及+/提高
pid: AT_abc246_e
tag: []
---

# [ABC246E] Bishop 2

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc246/tasks/abc246_e

ここに、 $ N\ \times\ N $ のチェス盤があります。このチェス盤の上から $ i $ 行目、左から $ j $ 列目にあるマスをマス $ (i,j) $ と呼びます。  
 チェス盤の情報は $ N $ 個の文字列 $ S_i $ として与えられます。  
 文字列 $ S_i $ の $ j $ 文字目である $ S_{i,j} $ には、以下の情報が含まれています。

- $ S_{i,j}= $ `.` のとき マス $ (i,j) $ には何も置かれていない。
- $ S_{i,j}= $ `#` のとき マス $ (i,j) $ には白のポーンが $ 1 $ つ置かれている。このポーンを動かしたり取り除いたりすることはできない。

この盤面のマス $ (A_x,A_y) $ に、白のビショップを $ 1 $ つ置きました。  
 この白のビショップをチェスのルール (注記参照) に従ってマス $ (A_x,A_y) $ からマス $ (B_x,B_y) $ に移動させるために必要な最小の手数を求めてください。  
 ただし、移動できない場合は代わりに `-1` を出力してください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ A_x $ $ A_y $ $ B_x $ $ B_y $ $ S_1 $ $ S_2 $ $ \vdots $ $ S_N $

## 输出格式

答えを出力せよ。

## 说明/提示

### 注記

マス $ (i,j) $ に置かれている白の [ビショップ](https://ja.wikipedia.org/wiki/%E3%83%93%E3%82%B7%E3%83%A7%E3%83%83%E3%83%97) は、 $ 1 $ 手で以下のルールに従って移動することができます。

- 各正整数 $ d $ について、以下の条件を全て満たせばマス $ (i+d,j+d) $ に移動できる。
  
  
  - マス $ (i+d,j+d) $ が盤内に存在する
  - 全ての正整数 $ l\ \le\ d $ について、 $ (i+l,j+l) $ に白のポーンがない
- 各正整数 $ d $ について、以下の条件を全て満たせばマス $ (i+d,j-d) $ に移動できる。
  
  
  - マス $ (i+d,j-d) $ が盤内に存在する
  - 全ての正整数 $ l\ \le\ d $ について、 $ (i+l,j-l) $ に白のポーンがない
- 各正整数 $ d $ について、以下の条件を全て満たせばマス $ (i-d,j+d) $ に移動できる。
  
  
  - マス $ (i-d,j+d) $ が盤内に存在する
  - 全ての正整数 $ l\ \le\ d $ について、 $ (i-l,j+l) $ に白のポーンがない
- 各正整数 $ d $ について、以下の条件を全て満たせばマス $ (i-d,j-d) $ に移動できる。
  
  
  - マス $ (i-d,j-d) $ が盤内に存在する
  - 全ての正整数 $ l\ \le\ d $ について、 $ (i-l,j-l) $ に白のポーンがない

### 制約

- $ 2\ \le\ N\ \le\ 1500 $
- $ 1\ \le\ A_x,A_y\ \le\ N $
- $ 1\ \le\ B_x,B_y\ \le\ N $
- $ (A_x,A_y)\ \neq\ (B_x,B_y) $
- $ S_i $ は `.` および `#` からなる $ N $ 文字の文字列
- $ S_{A_x,A_y}= $ `.`
- $ S_{B_x,B_y}= $ `.`

### Sample Explanation 1

以下のように移動させることで $ 3 $ 手でビショップを $ (1,3) $ から $ (3,5) $ まで移動させることができます。 $ 2 $ 手以内でビショップを $ (1,3) $ から $ (3,5) $ まで移動させることはできません。 - $ (1,3)\ \rightarrow\ (2,2)\ \rightarrow\ (4,4)\ \rightarrow\ (3,5) $

### Sample Explanation 2

どのようにビショップを動かしても $ (3,2) $ から $ (4,2) $ に移動させることはできません。

## 样例 #1

### 输入

```
5

1 3

3 5

....#

...#.

.....

.#...

#....
```

### 输出

```
3
```

## 样例 #2

### 输入

```
4

3 2

4 2

....

....

....

....
```

### 输出

```
-1
```

## 样例 #3

### 输入

```
18

18 1

1 18

..................

.####.............

.#..#..####.......

.####..#..#..####.

.#..#..###...#....

.#..#..#..#..#....

.......####..#....

.............####.

..................

..................

.####.............

....#..#..#.......

.####..#..#..####.

.#.....####..#....

.####.....#..####.

..........#..#..#.

.............####.

..................
```

### 输出

```
9
```



---

---
title: "[ABC246F] typewriter"
layout: "post"
diff: 普及+/提高
pid: AT_abc246_f
tag: []
---

# [ABC246F] typewriter

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc246/tasks/abc246_f

$ N $ 段からなるタイプライターがあります。このうち、上から $ i $ 段目のキーでは文字列 $ S_i $ に含まれる文字が打てます。

このキーボードを使って、以下のルールで文字列をひとつ入力することを考えます。

- まず、整数 $ 1\ \le\ k\ \le\ N $ を選択する。
- その後、空文字列から始めて、上から $ k $ 段目にあるキーだけを使ってちょうど $ L $ 文字の文字列を入力する。

このルールに従って入力可能な $ L $ 文字の文字列は何通りありますか？ 答えは非常に大きくなる場合があるので $ 998244353 $ で割った余りを出力してください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ L $ $ S_1 $ $ S_2 $ $ \dots $ $ S_N $

## 输出格式

答えを出力せよ。

## 说明/提示

### 制約

- $ N,L $ は整数
- $ 1\ \le\ N\ \le\ 18 $
- $ 1\ \le\ L\ \le\ 10^9 $
- $ S_i $ は `abcdefghijklmnopqrstuvwxyz` の(連続とは限らない)空でない部分列

### Sample Explanation 1

入力可能な文字列は `aa`, `ab`, `ac`, `ba`, `bb`, `ca`, `cc` の $ 7 $ つです。

### Sample Explanation 3

答えを $ 998244353 $ で割った余りを出力してください。

## 样例 #1

### 输入

```
2 2

ab

ac
```

### 输出

```
7
```

## 样例 #2

### 输入

```
4 3

abcdefg

hijklmnop

qrstuv

wxyz
```

### 输出

```
1352
```

## 样例 #3

### 输入

```
5 1000000000

abc

acde

cefg

abcfh

dghi
```

### 输出

```
346462871
```



---

---
title: "[ABC249F] Ignore Operations"
layout: "post"
diff: 普及+/提高
pid: AT_abc249_f
tag: []
---

# [ABC249F] Ignore Operations

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc249/tasks/abc249_f

高橋君は整数 $ x $ を持っています。はじめ、$ x\ =\ 0 $ です。

$ N $ 個の操作があります。$ i\ \,\ (1\ \leq\ i\ \leq\ N) $ 個目の操作は整数 $ t_i,\ y_i $ を用いて以下のように表されます。

- $ t_i\ =\ 1 $ のとき、$ x $ を $ y_i $ で置き換える。
- $ t_i\ =\ 2 $ のとき、$ x $ を $ x\ +\ y_i $ で置き換える。

高橋君は $ 0 $ 個以上 $ K $ 個以下の好きな個数の操作を無視することができます。残った操作を一度ずつ順序を変えずに行ったとき、最終的な $ x $ の値としてあり得る最大値を求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ K $ $ t_1 $ $ y_1 $ $ \vdots $ $ t_N $ $ y_N $

## 输出格式

答えを出力せよ。

## 说明/提示

### 制約

- $ 1\ \leq\ N\ \leq\ 2\ \times\ 10^5 $
- $ 0\ \leq\ K\ \leq\ N $
- $ t_i\ \in\ \{1,2\}\ \,\ (1\ \leq\ i\ \leq\ N) $
- $ |y_i|\ \leq\ 10^9\ \,\ (1\ \leq\ i\ \leq\ N) $
- 入力は全て整数

### Sample Explanation 1

$ 5 $ 個目の操作を無視すると、$ x $ は $ 0\ \rightarrow\ 4\ \rightarrow\ 1\ \rightarrow\ 2\ \rightarrow\ 3 $ と変化し、最終的な $ x $ の値は $ 3 $ となります。これが最大です。

## 样例 #1

### 输入

```
5 1
2 4
2 -3
1 2
2 1
2 -3
```

### 输出

```
3
```

## 样例 #2

### 输入

```
1 0
2 -1000000000
```

### 输出

```
-1000000000
```

## 样例 #3

### 输入

```
10 3
2 3
2 -1
1 4
2 -1
2 5
2 -9
2 2
1 -6
2 5
2 -3
```

### 输出

```
15
```



---

---
title: "[ABC251D] At Most 3 (Contestant ver.)"
layout: "post"
diff: 普及+/提高
pid: AT_abc251_d
tag: []
---

# [ABC251D] At Most 3 (Contestant ver.)

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc251/tasks/abc251_d

整数 $ W $ が与えられます。  
 あなたは以下の条件をすべて満たすようにいくつかのおもりを用意することにしました。

- おもりの個数は $ 1 $ 個以上 $ 300 $ 個以下である。
- おもりの重さは $ 10^6 $ 以下の正整数である。
- $ 1 $ 以上 $ W $ 以下のすべての正整数は **良い整数** である。ここで、以下の条件を満たす正整数 $ n $ を良い整数と呼ぶ。
  - 用意したおもりのうち $ \bf{3} $ **個以下** の異なるおもりを自由に選んで、選んだおもりの重さの和を $ n $ にすることができる。

条件を満たすようなおもりの組を $ 1 $ つ出力してください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ W $

## 输出格式

$ N $ をおもりの個数、$ A_i $ を $ i $ 番目のおもりの重さとして、以下の形式で出力せよ。答えが複数存在する場合、どれを出力しても正解とみなされる。

> $ N $ $ A_1 $ $ A_2 $ $ \dots $ $ A_N $

ただし、$ N $ および $ A_1,A_2,\dots,A_N $ は以下の条件を満たす必要がある。

- $ 1\ \leq\ N\ \leq\ 300 $
- $ 1\ \leq\ A_i\ \leq\ 10^6 $

## 说明/提示

### 制約

- $ 1\ \leq\ W\ \leq\ 10^6 $
- $ W $ は整数

### Sample Explanation 1

上の出力は重さ $ 1 $ のおもり、重さ $ 2 $ のおもり、重さ $ 3 $ のおもりの $ 3 $ 個のおもりを用意しています。 この出力は条件を満たしています。特に $ 3 $ 番目の条件について、以下のようにおもりを選ぶことで $ 1 $ 以上 $ W $ 以下の整数すべてが良い整数であることが確認できます。 - $ 1 $ 番目のおもりのみを選ぶと、重さの和は $ 1 $ になる。 - $ 2 $ 番目のおもりのみを選ぶと、重さの和は $ 2 $ になる。 - $ 3 $ 番目のおもりのみを選ぶと、重さの和は $ 3 $ になる。 - $ 1 $ 番目と $ 3 $ 番目のおもりを選ぶと、重さの和は $ 4 $ になる。 - $ 2 $ 番目と $ 3 $ 番目のおもりを選ぶと、重さの和は $ 5 $ になる。 - $ 1 $ 番目、$ 2 $ 番目と $ 3 $ 番目のおもりを選ぶと、重さの和は $ 6 $ になる。

### Sample Explanation 2

同じ重さのおもりを $ 2 $ 個以上用意しても良いです。

## 样例 #1

### 输入

```
6
```

### 输出

```
3

1 2 3
```

## 样例 #2

### 输入

```
12
```

### 输出

```
6

2 5 1 2 5 1
```



---

---
title: "[ABC259E] LCM on Whiteboard"
layout: "post"
diff: 普及+/提高
pid: AT_abc259_e
tag: []
---

# [ABC259E] LCM on Whiteboard

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc259/tasks/abc259_e

$ N $ 個の整数 $ a_1,\ldots,a_N $ が白板に書かれています。  
 ここで、$ a_i $ は $ m_i $ 個の素数 $ p_{i,1}\ \lt\ \ldots\ \lt\ p_{i,m_i} $ と正整数 $ e_{i,1},\ldots,e_{i,m_i} $ を用いて $ a_i\ =\ p_{i,1}^{e_{i,1}}\ \times\ \ldots\ \times\ p_{i,m_i}^{e_{i,m_i}} $ と表せる整数です。  
 あなたは $ N $ 個の整数から $ 1 $ つ選んで $ 1 $ に書き換えます。  
 書き換えた後の $ N $ 個の整数の最小公倍数としてあり得る値の個数を求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ m_1 $ $ p_{1,1} $ $ e_{1,1} $ $ \vdots $ $ p_{1,m_1} $ $ e_{1,m_1} $ $ m_2 $ $ p_{2,1} $ $ e_{2,1} $ $ \vdots $ $ p_{2,m_2} $ $ e_{2,m_2} $ $ \vdots $ $ m_N $ $ p_{N,1} $ $ e_{N,1} $ $ \vdots $ $ p_{N,m_N} $ $ e_{N,m_N} $

## 输出格式

答えを出力せよ。

## 说明/提示

### 制約

- $ 1\ \leq\ N\ \leq\ 2\ \times\ 10^5 $
- $ 1\ \leq\ m_i $
- $ \sum{m_i}\ \leq\ 2\ \times\ 10^5 $
- $ 2\ \leq\ p_{i,1}\ \lt\ \ldots\ \lt\ p_{i,m_i}\ \leq\ 10^9 $
- $ p_{i,j} $ は素数
- $ 1\ \leq\ e_{i,j}\ \leq\ 10^9 $
- 入力はすべて整数

### Sample Explanation 1

白板に書かれている整数は $ a_1\ =7^2=49,\ a_2=2^2\ \times\ 5^1\ =\ 20,\ a_3\ =\ 5^1\ =\ 5,\ a_4=2^1\ \times\ 7^1\ =\ 14 $ です。 $ a_1 $ を $ 1 $ に書き換えると白板に書かれている整数は $ 1,20,5,14 $ となり、これらの最小公倍数は $ 140 $ です。 $ a_2 $ を $ 1 $ に書き換えると白板に書かれている整数は $ 49,1,5,14 $ となり、これらの最小公倍数は $ 490 $ です。 $ a_3 $ を $ 1 $ に書き換えると白板に書かれている整数は $ 49,20,1,14 $ となり、これらの最小公倍数は $ 980 $ です。 $ a_4 $ を $ 1 $ に書き換えると白板に書かれている整数は $ 49,20,5,1 $ となり、これらの最小公倍数は $ 980 $ です。 以上より、書き換えた後の $ N $ 個の整数の最小公倍数としてあり得る値は $ 140,490,980 $ であり、この入力における答えが $ 3 $ と分かります。

### Sample Explanation 2

白板に書かれている整数はとても大きい場合があります。

## 样例 #1

### 输入

```
4

1

7 2

2

2 2

5 1

1

5 1

2

2 1

7 1
```

### 输出

```
3
```

## 样例 #2

### 输入

```
1

1

998244353 1000000000
```

### 输出

```
1
```



---

---
title: "[ABC260E] At Least One"
layout: "post"
diff: 普及+/提高
pid: AT_abc260_e
tag: []
---

# [ABC260E] At Least One

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc260/tasks/abc260_e

整数 $ M $ および $ N $ 個の整数の組 $ (A_1,\ B_1),\ (A_2,\ B_2),\ \dots,\ (A_N,\ B_N) $ が与えられます。  
 すべての $ i $ について $ 1\ \leq\ A_i\ \lt\ B_i\ \leq\ M $ が成り立っています。

次の条件を満たす数列 $ S $ を**良い数列**と呼びます。

- $ S $ は数列 $ (1,2,3,...,\ M) $ の連続部分列である。
- すべての $ i $ について $ S $ は $ A_i,\ B_i $ の少なくとも一方を含んでいる。

長さ $ k $ の良い数列としてあり得るものの個数を $ f(k) $ とします。  
 $ f(1),\ f(2),\ \dots,\ f(M) $ を列挙してください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ M $ $ A_1 $ $ B_1 $ $ A_2 $ $ B_2 $ $ \vdots $ $ A_N $ $ B_N $

## 输出格式

答えを以下の形式で出力せよ。

> $ f(1) $ $ f(2) $ $ \dots $ $ f(M) $

## 说明/提示

### 制約

- $ 1\ \leq\ N\ \leq\ 2\ \times\ 10^5 $
- $ 2\ \leq\ M\ \leq\ 2\ \times\ 10^5 $
- $ 1\ \leq\ A_i\ \lt\ B_i\ \leq\ M $
- 入力される値はすべて整数

### Sample Explanation 1

良い数列としてあり得るものを列挙すると次のようになります。 - $ (1,2) $ - $ (1,2,3) $ - $ (2,3,4) $ - $ (3,4,5) $ - $ (1,2,3,4) $ - $ (2,3,4,5) $ - $ (1,2,3,4,5) $

## 样例 #1

### 输入

```
3 5

1 3

1 4

2 5
```

### 输出

```
0 1 3 2 1
```

## 样例 #2

### 输入

```
1 2

1 2
```

### 输出

```
2 1
```

## 样例 #3

### 输入

```
5 9

1 5

1 7

5 6

5 8

2 6
```

### 输出

```
0 0 1 2 4 4 3 2 1
```



---

---
title: "[ABC261E] Many Operations"
layout: "post"
diff: 普及+/提高
pid: AT_abc261_e
tag: []
---

# [ABC261E] Many Operations

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc261/tasks/abc261_e

変数 $ X $ と、$ X $ の値を変更する $ N $ 種類の操作があります。操作 $ i $ は整数の組 $ (T_i,A_i) $ で表され、意味は次の通りです。

- $ T_i=1 $ のとき、$ X $ の値を $ X\ {\rm\ and}\ A_i $ に置き換える。
- $ T_i=2 $ のとき、$ X $ の値を $ X\ {\rm\ or}\ A_i $ に置き換える。
- $ T_i=3 $ のとき、$ X $ の値を $ X\ {\rm\ xor}\ A_i $ に置き換える。

変数 $ X $ を値 $ C $ で初期化した状態から、以下の処理を順に実行してください。

- 操作 $ 1 $ を行い、操作後の $ X $ の値を出力する。
- 続けて、操作 $ 1,2 $ を順に行い、操作後の $ X $ の値を出力する。
- 続けて、操作 $ 1,2,3 $ を順に行い、操作後の $ X $ の値を出力する。
- $ \vdots $
- 続けて、操作 $ 1,2,\ldots,N $ を順に行い、操作後の $ X $ の値を出力する。
 
$ {\rm\ and},\ {\rm\ or},\ {\rm\ xor} $ とは 非負整数 $ A,\ B $ の $ {\rm\ and},\ {\rm\ or},\ {\rm\ xor} $ は、以下のように定義されます。 - $ A\ {\rm\ and}\ B $ を二進表記した際の $ 2^k $ ($ k\ \geq\ 0 $) の位の数は、$ A,\ B $ を二進表記した際の $ 2^k $ の位の数のうち両方が $ 1 $ であれば $ 1 $、そうでなければ $ 0 $ である。
- $ A\ {\rm\ or}\ B $ を二進表記した際の $ 2^k $ ($ k\ \geq\ 0 $) の位の数は、$ A,\ B $ を二進表記した際の $ 2^k $ の位の数のうち少なくとも一方が $ 1 $ であれば $ 1 $、そうでなければ $ 0 $ である。
- $ A\ {\rm\ xor}\ B $ を二進表記した際の $ 2^k $ ($ k\ \geq\ 0 $) の位の数は、$ A,\ B $ を二進表記した際の $ 2^k $ の位の数のうちちょうど一方が $ 1 $ であれば $ 1 $、そうでなければ $ 0 $ である。
 
 例えば、$ 3\ {\rm\ and}\ 5\ =\ 1 $、 $ 3\ {\rm\ or}\ 5\ =\ 7 $、 $ 3\ {\rm\ xor}\ 5\ =\ 6 $ となります。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ C $ $ T_1 $ $ A_1 $ $ T_2 $ $ A_2 $ $ \vdots $ $ T_N $ $ A_N $

## 输出格式

問題文中の指示に従って $ N $ 行出力せよ。

## 说明/提示

### 制約

- $ 1\ \leq\ N\ \leq\ 2\times\ 10^5 $
- $ 1\leq\ T_i\ \leq\ 3 $
- $ 0\leq\ A_i\ \lt\ 2^{30} $
- $ 0\leq\ C\ \lt\ 2^{30} $
- 入力に含まれる値は全て整数である

### Sample Explanation 1

最初、$ X $ の値は $ 10 $ です。 - 操作 $ 1 $ を行うと $ X $ の値は $ 9 $ になります。 - 続けて操作 $ 1 $ を行うと $ X $ の値は $ 10 $ になり、さらに操作 $ 2 $ を行うと $ 15 $ になります。 - 続けて操作 $ 1 $ を行うと $ X $ の値は $ 12 $ になり、さらに操作 $ 2 $ を行うと $ 13 $ に、さらに続けて操作 $ 3 $ を行うと $ 12 $ になります。

## 样例 #1

### 输入

```
3 10

3 3

2 5

1 12
```

### 输出

```
9

15

12
```

## 样例 #2

### 输入

```
9 12

1 1

2 2

3 3

1 4

2 5

3 6

1 7

2 8

3 9
```

### 输出

```
0

2

1

0

5

3

3

11

2
```



---

---
title: "[ABC261F] Sorting Color Balls"
layout: "post"
diff: 普及+/提高
pid: AT_abc261_f
tag: []
---

# [ABC261F] Sorting Color Balls

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc261/tasks/abc261_f

$ N $ 個の球が左右一列に並んでいます。 左から $ i $ 番目の球の色は色 $ C_i $ であり、整数 $ X_i $ が書かれています。

高橋君の目標は球を左から右に見た時に書かれている数が非減少になるように球を並べ替えることです。 言い換えれば、高橋君の目標は、任意の $ 1\leq\ i\leq\ N-1 $ について、左から $ i+1 $ 番目の球に書かれている数 が左から $ i $ 番目に書かれている数以上であるようにすることです。

高橋君は目標を達成するために、次の操作を好きなだけ（ $ 0 $ 回でも良い ）繰り返すことができます。

> $ 1\leq\ i\leq\ N-1 $ をみたす整数 $ i $ を選ぶ。  
>  左から $ i $ 番目の球と $ i+1 $ 番目の球の色が異なっているならば、コストを $ 1 $ 支払う。 （色が等しいならばコストを支払う必要は無い。）  
>  左から $ i $ 番目の球と $ i+1 $ 番目の球を入れ替える。

高橋君が目標を達成するために支払う必要のあるコストの最小値を求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ C_1 $ $ C_2 $ $ \ldots $ $ C_N $ $ X_1 $ $ X_2 $ $ \ldots $ $ X_N $

## 输出格式

高橋君が支払う必要のあるコストの最小値を整数で出力せよ。

## 说明/提示

### 制約

- $ 2\ \leq\ N\ \leq\ 3\times\ 10^5 $
- $ 1\leq\ C_i\leq\ N $
- $ 1\leq\ X_i\leq\ N $
- 入力は全て整数

### Sample Explanation 1

球の情報を $ (色,\ 整数) $ で表すとします。 最初の状態は $ (1,3) $, $ (5,2) $, $ (2,1) $, $ (2,2) $, $ (1,1) $ です。 例えば、高橋君は次のように操作を行うことができます。 - 左から $ 1 $ 番目の球 (色 $ 1 $) と $ 2 $ 番目の球 (色 $ 5 $) を入れ替える。 球は左から $ (5,2) $, $ (1,3) $, $ (2,1) $, $ (2,2) $, $ (1,1) $ となる。 - 左から $ 2 $ 番目の球 (色 $ 1 $) と $ 3 $ 番目の球 (色 $ 2 $) を入れ替える。 球は左から $ (5,2) $, $ (2,1) $, $ (1,3) $, $ (2,2) $, $ (1,1) $ となる。 - 左から $ 3 $ 番目の球 (色 $ 1 $) と $ 4 $ 番目の球 (色 $ 2 $) を入れ替える。 球は左から $ (5,2) $, $ (2,1) $, $ (2,2) $, $ (1,3) $, $ (1,1) $ となる。 - 左から $ 4 $ 番目の球 (色 $ 1 $) と $ 5 $ 番目の球 (色 $ 1 $) を入れ替える。 球は左から $ (5,2) $, $ (2,1) $, $ (2,2) $, $ (1,1) $, $ (1,3) $ となる。 - 左から $ 3 $ 番目の球 (色 $ 2 $) と $ 4 $ 番目の球 (色 $ 1 $) を入れ替える。 球は左から $ (5,2) $, $ (2,1) $, $ (1,1) $, $ (2,2) $, $ (1,3) $ となる。 - 左から $ 1 $ 番目の球 (色 $ 5 $) と $ 2 $ 番目の球 (色 $ 2 $) を入れ替える。 球は左から $ (2,1) $, $ (5,2) $, $ (1,1) $, $ (2,2) $, $ (1,3) $ となる。 - 左から $ 2 $ 番目の球 (色 $ 5 $) と $ 3 $ 番目の球 (色 $ 1 $) を入れ替える。 球は左から $ (2,1) $, $ (1,1) $, $ (5,2) $, $ (2,2) $, $ (1,3) $ となる。 最後の操作の後で球に書かれている数は左から順に $ 1,1,2,2,3 $ となっているため、高橋君は目的を達成しています。 $ 1,2,3,5,6,7 $ 回目の操作にコストが $ 1 $ ずつかかるため、 このとき合計でコストは $ 6 $ かかり、このときが最小となります。 $ 4 $ 回目の操作では、入れ替えた球の色がともに色 $ 1 $ であるためコストがかからないことに注意してください。

### Sample Explanation 2

すべての球の色は同じであるため、球の入れ替えにコストがかかることはありません。

### Sample Explanation 3

高橋君は一度も操作を行わずとも、目的を達成できています。

## 样例 #1

### 输入

```
5

1 5 2 2 1

3 2 1 2 1
```

### 输出

```
6
```

## 样例 #2

### 输入

```
3

1 1 1

3 2 1
```

### 输出

```
0
```

## 样例 #3

### 输入

```
3

3 1 2

1 1 2
```

### 输出

```
0
```



---

---
title: "[ABC262E] Red and Blue Graph"
layout: "post"
diff: 普及+/提高
pid: AT_abc262_e
tag: []
---

# [ABC262E] Red and Blue Graph

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc262/tasks/abc262_e

$ N $ 頂点 $ M $ 辺の単純無向グラフが与えられます。頂点は $ 1,\ \dots,\ N $ と番号付けられ、$ i\ \,\ (1\ \leq\ i\ \leq\ M) $ 番目の辺は頂点 $ U_i,\ V_i $ を結んでいます。

それぞれの頂点を赤または青で塗る方法は全部で $ 2^N $ 通りあります。これらのうち、以下の条件を全て満たすものの総数を $ 998244353 $ で割った余りを求めてください。

- 赤く塗られた頂点がちょうど $ K $ 個ある
- 異なる色で塗られた頂点を結ぶ辺の本数は偶数である

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ M $ $ K $ $ U_1 $ $ V_1 $ $ \vdots $ $ U_M $ $ V_M $

## 输出格式

答えを出力せよ。

## 说明/提示

### 制約

- $ 2\ \leq\ N\ \leq\ 2\ \times\ 10^5 $
- $ 1\ \leq\ M\ \leq\ 2\ \times\ 10^5 $
- $ 0\ \leq\ K\ \leq\ N $
- $ 1\ \leq\ U_i\ \lt\ V_i\ \leq\ N\ \,\ (1\ \leq\ i\ \leq\ M) $
- $ (U_i,\ V_i)\ \neq\ (U_j,\ V_j)\ \,\ (i\ \neq\ j) $
- 入力は全て整数

### Sample Explanation 1

以下の $ 2 $ 通りが条件を満たします。 - 頂点 $ 1,\ 2 $ を赤く、頂点 $ 3,\ 4 $ を青く塗る。 - 頂点 $ 3,\ 4 $ を赤く、頂点 $ 1,\ 2 $ を青く塗る。 上記の塗り方について、異なる色で塗られた頂点を結ぶ辺は $ 2 $ 番目の辺と $ 3 $ 番目の辺です。

## 样例 #1

### 输入

```
4 4 2

1 2

1 3

2 3

3 4
```

### 输出

```
2
```

## 样例 #2

### 输入

```
10 10 3

1 2

2 4

1 5

3 6

3 9

4 10

7 8

9 10

5 9

3 4
```

### 输出

```
64
```



---

---
title: "[ABC263E] Sugoroku 3"
layout: "post"
diff: 普及+/提高
pid: AT_abc263_e
tag: []
---

# [ABC263E] Sugoroku 3

## 题目描述

一共有 $N$ 个格子编号 $1$ 到 $N$。有一个人站在 $1$ 号格子。

对于 $\forall i \in [1,N-1]$ 号格子有一个 $A_i + 1$ 面的骰子，写有 $0$ 到 $A_i$ 这些数。如果 ta 掷到了 $k$，他将往前走 $k$ 格，走到 $i+k$ 号方格。

求走到 $N$ 号方格的期望次数。对 $998244353$ 取模。

## 输入格式

第一行一个正整数 $N$，第二行 $N-1$ 个正整数表示 $A_i$。

## 输出格式

如果期望次数为 $\frac{P}{Q}$，输入最小非负整数 $R$ 使得 $R\times Q \equiv P\pmod {998244353}$。

## 说明/提示

$2\leq N\leq 2\times 10^5$

$\forall i \in [1,N-1],1\leq A_i\leq N-i$

## 样例 #1

### 输入

```
3

1 1
```

### 输出

```
4
```

## 样例 #2

### 输入

```
5

3 1 2 1
```

### 输出

```
332748122
```



---

---
title: "[ABC264E] Blackout 2"
layout: "post"
diff: 普及+/提高
pid: AT_abc264_e
tag: []
---

# [ABC264E] Blackout 2

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc264/tasks/abc264_e

ある国には $ N $ 個の都市と $ M $ 個の発電所があります。これらを総称して地点と呼びます。  
 地点には $ 1,2,\dots,N+M $ の番号がつけられており、そのうち都市は地点 $ 1,2,\dots,N $ で発電所は地点 $ N+1,N+2,\dots,N+M $ です。

この国には電線が $ E $ 本あり、電線 $ i $ ( $ 1\ \le\ i\ \le\ E $ ) は地点 $ U_i $ と地点 $ V_i $ を双方向に結びます。  
 また、ある都市に **電気が通っている** とは、ある都市から電線をいくつか辿って少なくともひとつの発電所に辿り着くことができる状態を言います。

今、 $ Q $ 個のイベントが起こります。そのうち $ i $ ( $ 1\ \le\ i\ \le\ Q $ ) 番目のイベントでは電線 $ X_i $ が切れ、その電線を辿ることができなくなります。一度切れた電線は、その後のイベントにおいても切れたままです。

全てのイベントについて、そのイベントが終わった直後に電気が通っている都市の数を求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ M $ $ E $ $ U_1 $ $ V_1 $ $ U_2 $ $ V_2 $ $ \vdots $ $ U_E $ $ V_E $ $ Q $ $ X_1 $ $ X_2 $ $ \vdots $ $ X_Q $

## 输出格式

$ Q $ 行出力せよ。  
 そのうち $ i $ ( $ 1\ \le\ i\ \le\ Q $ ) 行目には $ i $ 番目のイベントが終わった直後に電気が通っている都市の数を出力せよ。

## 说明/提示

### 制約

- 入力は全て整数
- $ 1\ \le\ N,M $
- $ N+M\ \le\ 2\ \times\ 10^5 $
- $ 1\ \le\ Q\ \le\ E\ \le\ 5\ \times\ 10^5 $
- $ 1\ \le\ U_i\ <\ V_i\ \le\ N+M $
- $ i\ \neq\ j $ ならば、 $ U_i\ \neq\ U_j $ または $ V_i\ \neq\ V_j $
- $ 1\ \le\ X_i\ \le\ E $
- $ X_i $ は相異なる

### Sample Explanation 1

はじめ、全ての都市に電気が通っています。 - $ 1 $ 番目のイベントによって地点 $ 5 $ と地点 $ 10 $ を結ぶ電線 $ 3 $ が切れます。 - これにより、都市 $ 5 $ に電気が通らなくなり、電気が通っている都市の数は $ 4 $ となります。 - $ 2 $ 番目のイベントによって地点 $ 2 $ と地点 $ 9 $ を結ぶ電線 $ 5 $ が切れます。 - $ 3 $ 番目のイベントによって地点 $ 3 $ と地点 $ 6 $ を結ぶ電線 $ 8 $ が切れます。 - これにより、都市 $ 2,3 $ に電気が通らなくなり、電気が通っている都市の数は $ 2 $ となります。 - $ 4 $ 番目のイベントによって地点 $ 1 $ と地点 $ 8 $ を結ぶ電線 $ 10 $ が切れます。 - $ 5 $ 番目のイベントによって地点 $ 4 $ と地点 $ 10 $ を結ぶ電線 $ 2 $ が切れます。 - $ 6 $ 番目のイベントによって地点 $ 1 $ と地点 $ 7 $ を結ぶ電線 $ 7 $ が切れます。 - これにより、都市 $ 1 $ に電気が通らなくなり、電気が通っている都市の数は $ 1 $ となります。

## 样例 #1

### 输入

```
5 5 10

2 3

4 10

5 10

6 9

2 9

4 8

1 7

3 6

8 10

1 8

6

3

5

8

10

2

7
```

### 输出

```
4

4

2

2

2

1
```



---

---
title: "[ABC266F] Well-defined Path Queries on a Namori"
layout: "post"
diff: 普及+/提高
pid: AT_abc266_f
tag: []
---

# [ABC266F] Well-defined Path Queries on a Namori

## 题目描述

给定一张有 $N$ 个点、$N$ 条边的简单连通无向图和 $Q$ 次询问，对于每次询问，给定 $x_i,y_i$，表示两点的编号，请你回答第 $x_i$ 个点和第 $y_i$ 个点之间是否**有且仅有**一条简单路径。

+ 什么是简单路径？

如果路径上的各顶点均不重复，则称这样的路径为简单路径。

## 输入格式

第一行包含一个整数 $N$；

接下来 $N$ 行，每行两个整数 $u_i,v_i$，表示第 $i$ 条边连接的两个点；

再接下来一行包含一个整数 $Q$；

## 输出格式

对于每次询问，输出一个字符串 `Yes` 或 `No`，分别表示两点之间是否仅存在一条简单路径，每个询问分别输出一行。

### 样例

见原题面。

### 样例解析

样例 #1 解析：

对于第一次询问，从 $1$ 到 $2$ 有两条简单路径 $(1,2)$、$(1,3,2)$，所以输出 `No`。

对于第二次询问，从 $1$ 到 $4$ 仅有一条路径 $(1,4)$，所以输出 `Yes`。

对于第三次询问，从 $1$ 到 $5$ 有两条简单路径 $(1,2,5)$、$(1,3,2,5)$，所以输出 `No`。

## 说明/提示

对于 $30\%$ 的数据，$N \le 100$，$Q \le \frac{N(N-1)}{2}$；

对于 $100\%$ 的数据，$3 \le N \le 2 \times 10^5$，$1 \le u_i<v_i \le N$，$1 \le Q \le 2 \times 10^5$，$1 \le x_i < y_i \le N$，保证图没有重边或自环，且给定询问均不重复。

翻译 by @CarroT1212

## 样例 #1

### 输入

```
5
1 2
2 3
1 3
1 4
2 5
3
1 2
1 4
1 5
```

### 输出

```
No
Yes
No
```

## 样例 #2

### 输入

```
10
3 5
5 7
4 8
2 9
1 2
7 9
1 6
4 10
2 5
2 10
10
1 8
6 9
8 10
6 8
3 10
3 9
1 10
5 8
1 10
7 8
```

### 输出

```
Yes
No
Yes
Yes
No
No
Yes
No
Yes
No
```



---

---
title: "[ABC267E] Erasing Vertices 2"
layout: "post"
diff: 普及+/提高
pid: AT_abc267_e
tag: []
---

# [ABC267E] Erasing Vertices 2

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc267/tasks/abc267_e

$ N $ 頂点 $ M $ 辺の単純無向グラフ（すなわち、自己辺も多重辺もない無向グラフ）が与えられます。$ i $ 本目の辺は頂点 $ U_i $ と頂点 $ V_i $ を結んでいます。頂点 $ i $ には正整数 $ A_i $ が書かれています。

あなたは、以下の操作を $ N $ 回繰り返します。

- まだ削除されていない頂点 $ x $ を選び、「頂点 $ x $ 」と「頂点 $ x $ を端点に持つ辺全て」を削除する。この操作のコストは、頂点 $ x $ と辺で直接結ばれていて、かつまだ削除されていない頂点に書かれている整数の総和である。

$ N $ 回の操作全体のコストを、$ 1 $ 回ごとの操作におけるコストのうちの最大値として定めます。操作全体のコストとして取り得る値の最小値を求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ M $ $ A_1 $ $ A_2 $ $ \dots $ $ A_N $ $ U_1 $ $ V_1 $ $ U_2 $ $ V_2 $ $ \vdots $ $ U_M $ $ V_M $

## 输出格式

答えを出力せよ。

## 说明/提示

### 制約

- $ 1\ \le\ N\ \le\ 2\ \times\ 10^5 $
- $ 0\ \le\ M\ \le\ 2\ \times\ 10^5 $
- $ 1\ \le\ A_i\ \le\ 10^9 $
- $ 1\ \le\ U_i,V_i\ \le\ N $
- 与えられるグラフは単純。
- 入力は全て整数。

### Sample Explanation 1

以下のように操作を行うことにより、$ N $ 回の操作のコストのうちの最大値を $ 3 $ にすることができます。 - 頂点 $ 3 $ を選ぶ。コストは $ A_1=3 $ である。 - 頂点 $ 1 $ を選ぶ。コストは $ A_2+A_4=3 $ である。 - 頂点 $ 2 $ を選ぶ。コストは $ 0 $ である。 - 頂点 $ 4 $ を選ぶ。コストは $ 0 $ である。 $ N $ 回の操作のコストのうちの最大値を $ 2 $ 以下にすることはできないため、解は $ 3 $ です。

## 样例 #1

### 输入

```
4 3

3 1 4 2

1 2

1 3

4 1
```

### 输出

```
3
```

## 样例 #2

### 输入

```
7 13

464 661 847 514 74 200 188

5 1

7 1

5 7

4 1

4 5

2 4

5 2

1 3

1 6

3 5

1 2

4 6

2 7
```

### 输出

```
1199
```



---

---
title: "[ABC268D] Unique Username"
layout: "post"
diff: 普及+/提高
pid: AT_abc268_d
tag: []
---

# [ABC268D] Unique Username

## 题目描述

高桥君有取名选择困难症，于是他找到你，希望帮他取一个用户名。

具体取名规则是：把给定的 $N$ 个字符串 $S_1，S_2,\ldots,S_N$ 以任意顺序排列，并在每两个字符串中间加 $\ge1$ 个下划线，要求不能与后面给定的 $M$ 个字符串 $T_1，T_2,\ldots,T_M$ 中的任意一个相同。

其中，你给出的字符串的长度 $X$ 应该满足 $3\le X \le 16$ 。如果无法满足条件，输出 $-1$。

## 输入格式

第一行两个整数，分别为 $N$ 和 $M$ ；

后 $N$ 行每行一个字符串 $S_i$ ；

后 $M$ 行每行一个字符串 $T_i$ 。

## 输出格式

一个满足题意的字符串 $X$ 。如果没有满足的，输出一个数 $-1$ 。

## 样例 #1

### 输入

```
1 1

chokudai

chokudai
```

### 输出

```
-1
```

## 样例 #2

### 输入

```
2 2

choku

dai

chokudai

choku_dai
```

### 输出

```
dai_choku
```

## 样例 #3

### 输入

```
2 2

chokudai

atcoder

chokudai_atcoder

atcoder_chokudai
```

### 输出

```
-1
```

## 样例 #4

### 输入

```
4 4

ab

cd

ef

gh

hoge

fuga

____

_ab_cd_ef_gh_
```

### 输出

```
ab__ef___cd_gh
```



---

---
title: "[ABC268F] Best Concatenation"
layout: "post"
diff: 普及+/提高
pid: AT_abc268_f
tag: []
---

# [ABC268F] Best Concatenation

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc268/tasks/abc268_f

`1` から `9` の数字および `X` のみからなる $ N $ 個の文字列 $ S_1,\ S_2,\ \ldots,\ S_N $ が与えられます。

$ (1,\ 2,\ \ldots,\ N) $ を並べ替えた列 $ P\ =\ (P_1,\ P_2,\ \ldots,\ P_N) $ を一つ選び、 文字列 $ T\ =\ S_{P_1}\ +\ S_{P_2}\ +\ \cdots\ +\ S_{P_N} $ を作ります。ここで、$ + $ は文字列の連結を表します。

そして、文字列 $ T\ =\ T_1T_2\ldots\ T_{|T|} $ の「スコア」を計算します（ $ |T| $ は文字列 $ T $ の長さを表します）。  
 $ T $ のスコアは、スコアが $ 0 $ の状態から始め、下記の $ 9 $ 個の手順を行うことで計算されます。

- $ 1\ \leq\ i\ \lt\ j\ \leq\ |T| $ および $ T_i\ = $ `X` かつ $ T_j\ = $ `1` を満たす整数の組 $ (i,\ j) $ の個数だけ、スコアを $ 1 $ 点加算する 。
- $ 1\ \leq\ i\ \lt\ j\ \leq\ |T| $ および $ T_i\ = $ `X` かつ $ T_j\ = $ `2` を満たす整数の組 $ (i,\ j) $ の個数だけ、スコアを $ 2 $ 点加算する。
- $ 1\ \leq\ i\ \lt\ j\ \leq\ |T| $ および $ T_i\ = $ `X` かつ $ T_j\ = $ `3` を満たす整数の組 $ (i,\ j) $ の個数だけ、スコアを $ 3 $ 点加算する。
- $ \cdots $
- $ 1\ \leq\ i\ \lt\ j\ \leq\ |T| $ および $ T_i\ = $ `X` かつ $ T_j\ = $ `9` を満たす整数の組 $ (i,\ j) $ の個数だけ、スコアを $ 9 $ 点加算する。

$ P $ を任意に選ぶときの、$ T $ のスコアとしてあり得る最大値を出力してください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ S_1 $ $ S_2 $ $ \vdots $ $ S_N $

## 输出格式

答えを出力せよ。

## 说明/提示

### 制約

- $ 2\ \leq\ N\ \leq\ 2\ \times\ 10^5 $
- $ N $ は整数
- $ S_i $ は `1` から `9` の数字および `X` のみからなる長さ $ 1 $ 以上の文字列
- $ S_1,\ S_2,\ \ldots,\ S_N $ の長さの総和は $ 2\ \times\ 10^5 $ 以下

### Sample Explanation 1

$ P\ =\ (3,\ 1,\ 2) $ とすると、$ T\ =\ S_3\ +\ S_1\ +\ S_2\ = $ `XXX1X359` です。 このとき、$ T $ のスコアは次の通り計算されます。 - $ 1\ \leq\ i\ \lt\ j\ \leq\ |T| $ および $ T_i\ = $ `X` かつ $ T_j\ = $ `1` を満たす整数の組 $ (i,\ j) $ が $ 3 $ 個あり、 - $ 1\ \leq\ i\ \lt\ j\ \leq\ |T| $ および $ T_i\ = $ `X` かつ $ T_j\ = $ `3` を満たす整数の組 $ (i,\ j) $ が $ 4 $ 個あり、 - $ 1\ \leq\ i\ \lt\ j\ \leq\ |T| $ および $ T_i\ = $ `X` かつ $ T_j\ = $ `5` を満たす整数の組 $ (i,\ j) $ が $ 4 $ 個あり、 - $ 1\ \leq\ i\ \lt\ j\ \leq\ |T| $ および $ T_i\ = $ `X` かつ $ T_j\ = $ `9` を満たす整数の組 $ (i,\ j) $ が $ 4 $ 個あります。 よって、$ T $ のスコアは $ 1\ \times\ 3\ +\ 3\ \times\ 4\ +\ 5\ \times\ 4\ +\ 9\ \times\ 4\ =\ 71 $ であり、これが考えられる最大値です。

## 样例 #1

### 输入

```
3

1X3

59

XXX
```

### 输出

```
71
```

## 样例 #2

### 输入

```
10

X63X395XX

X2XX3X22X

13

3716XXX6

45X

X6XX

9238

281X92

1XX4X4XX6

54X9X711X1
```

### 输出

```
3010
```



---

---
title: "[ABC269F] Numbered Checker"
layout: "post"
diff: 普及+/提高
pid: AT_abc269_f
tag: []
---

# [ABC269F] Numbered Checker

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc269/tasks/abc269_f

$ N $ 行 $ M $ 列のグリッドがあり、上から $ i $ 行目、左から $ j $ 列目のマス $ (i,j) $ には整数 $ (i-1)\ \times\ M\ +\ j $ が書かれています。  
 このグリッドに、以下の操作を施します。

- 全てのマス $ (i,j) $ について、 $ i+j $ が奇数ならそのマスに書かれている数字を $ 0 $ に書き換える。

操作後のグリッドについて、$ Q $ 個の質問に答えてください。  
 $ i $ 個目の質問は以下の通りです:

- 以下の条件を全て満たすマス $ (p,q) $ 全てについて、そこに書かれている整数を全て足し合わせた値を $ 998244353 $ で割った余りを求めよ。
  - $ A_i\ \le\ p\ \le\ B_i $
  - $ C_i\ \le\ q\ \le\ D_i $

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ M $ $ Q $ $ A_1 $ $ B_1 $ $ C_1 $ $ D_1 $ $ A_2 $ $ B_2 $ $ C_2 $ $ D_2 $ $ \vdots $ $ A_Q $ $ B_Q $ $ C_Q $ $ D_Q $

## 输出格式

$ Q $ 行出力せよ。  
 そのうち $ i $ 行目には、 $ i $ 個目の質問に対する答えを整数として出力せよ。

## 说明/提示

### 制約

- 入力は全て整数
- $ 1\ \le\ N,M\ \le\ 10^9 $
- $ 1\ \le\ Q\ \le\ 2\ \times\ 10^5 $
- $ 1\ \le\ A_i\ \le\ B_i\ \le\ N $
- $ 1\ \le\ C_i\ \le\ D_i\ \le\ M $

### Sample Explanation 1

この入力では、グリッドは以下の通りです。 !\[\](https://img.atcoder.jp/abc269/81d92debe7aa949266f3a00cff13b513.png) この入力には $ 6 $ つの質問が含まれます。 - $ 1 $ 個目の質問の答えは $ 0+3+0+6+0+8+0+11+0=28 $ です。 - $ 2 $ 個目の質問の答えは $ 1+0+9+0+17=27 $ です。 - $ 3 $ 個目の質問の答えは $ 17+0+19+0=36 $ です。 - $ 4 $ 個目の質問の答えは $ 14 $ です。 - $ 5 $ 個目の質問の答えは $ 0 $ です。 - $ 6 $ 個目の質問の答えは $ 104 $ です。

### Sample Explanation 2

$ 1 $ 個目の質問について、マス $ (10^9,10^9) $ に書かれている整数は $ 10^{18} $ ですが、それを $ 998244353 $ で割った余りを求めることに注意してください。

## 样例 #1

### 输入

```
5 4

6

1 3 2 4

1 5 1 1

5 5 1 4

4 4 2 2

5 5 4 4

1 5 1 4
```

### 输出

```
28

27

36

14

0

104
```

## 样例 #2

### 输入

```
1000000000 1000000000

3

1000000000 1000000000 1000000000 1000000000

165997482 306594988 719483261 992306147

1 1000000000 1 1000000000
```

### 输出

```
716070898

240994972

536839100
```

## 样例 #3

### 输入

```
999999999 999999999

3

999999999 999999999 999999999 999999999

216499784 840031647 84657913 415448790

1 999999999 1 999999999
```

### 输出

```
712559605

648737448

540261130
```



---

---
title: "[ABC270D] Stones"
layout: "post"
diff: 普及+/提高
pid: AT_abc270_d
tag: []
---

# [ABC270D] Stones

## 题目描述

#### 题目翻译
Takahashi 和 Aoki 在玩一个取石子的游戏。

刚开始，有 $N$ 个石子，还有一个长度为 $K$ 的序列 $A = \{A_1,A_2,\cdots,A_K\}$。

现在，他们要按照以下规则轮流取石子：

* 对于每次操作，他可以选择一个 $i$（$1 \leq i \leq K$），这时他会取走 $A_i$ 块石子。

* 当一个人没法取石子时，游戏结束。

现在，Takahashi 先取石子，Aoki 后取石子。
他们都想尽可能的最大化他们自己取走的石子数量。

若他们都以最优策略取石子，最后 Takahashi 会取走多少块石子？

## 输入格式

第一行两个正整数 $N, K$

第二行有 $K$ 个正整数，其中第 $i$ 个表示 $A_i$

## 输出格式

一行一个正整数，表示若他们都以最优策略取石子，最后 Takahashi 取走的石子数量。

## 说明/提示

对于 $100\%$ 的数据，保证：
* $1 \leq N \leq 10^4$
* $1 \leq K \leq 100$
* $1 = A_1 < A_2 < \cdots < A_K \leq N$

## 样例 #1

### 输入

```
10 2
1 4
```

### 输出

```
5
```

## 样例 #2

### 输入

```
11 4
1 2 3 6
```

### 输出

```
8
```

## 样例 #3

### 输入

```
10000 10
1 2 4 8 16 32 64 128 256 512
```

### 输出

```
5136
```



---

---
title: "[ABC270F] Transportation"
layout: "post"
diff: 普及+/提高
pid: AT_abc270_f
tag: []
---

# [ABC270F] Transportation

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc270/tasks/abc270_f

AtCoder 国には $ N $ 個の島があり、 最初、どの島にも空港・港はなく、どの島の間にも道路はありません。 王である高橋君はこれらの島の間に交通手段を用意することにしました。 具体的には、高橋君は次の操作のうち $ 1 $ つを選んで行うことを好きなだけ繰り返す事ができます。

- $ 1\leq\ i\leq\ N $ をみたす $ i $ を選び、コスト $ X_i $ を払って、島 $ i $ に空港を建設する。
- $ 1\leq\ i\leq\ N $ をみたす $ i $ を選び、コスト $ Y_i $ を払って、島 $ i $ に港を建設する。
- $ 1\leq\ i\leq\ M $ をみたす $ i $ を選び、コスト $ Z_i $ を払って、島 $ A_i $ と島 $ B_i $ の間を双方向に結ぶ道路を建設する。

高橋君の目標は、任意の相異なる $ 2 $ つの島 $ U $, $ V $ について、 島 $ U $ からはじめて次の行動のうち $ 1 $ つを選んで行うことを好きなだけ繰り返す事で、 島 $ V $ に到達することができるようにする事です。

- 島 $ S,T $ の両方に空港がある時、島 $ S $ から島 $ T $ まで移動する。
- 島 $ S,T $ の両方に港がある時、島 $ S $ から島 $ T $ まで移動する。
- 島 $ S,T $ を結ぶ道路が存在する時、島 $ S $ から島 $ T $ まで移動する。

高橋君が目標を達成するのに必要な最小コストを求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ M $ $ X_1 $ $ X_2 $ $ \ldots $ $ X_N $ $ Y_1 $ $ Y_2 $ $ \ldots $ $ Y_N $ $ A_1 $ $ B_1 $ $ Z_1 $ $ A_2 $ $ B_2 $ $ Z_2 $ $ \vdots $ $ A_M $ $ B_M $ $ Z_M $

## 输出格式

高橋君が目標を達成するのに必要な最小コストを出力せよ。

## 说明/提示

### 制約

- $ 2\ \leq\ N\ \leq\ 2\times\ 10^5 $
- $ 1\ \leq\ M\ \leq\ 2\times\ 10^5 $
- $ 1\leq\ X_i\leq\ 10^9 $
- $ 1\leq\ Y_i\leq\ 10^9 $
- $ 1\leq\ A_i\ <\ B_i\leq\ N $
- $ 1\leq\ Z_i\leq\ 10^9 $
- $ i\neq\ j $ ならば $ (A_i,B_i)\neq\ (A_j,B_j) $
- 入力は全て整数

### Sample Explanation 1

高橋君は次のように交通手段を建設します。 - コスト $ X_1=1 $ を払って、島 $ 1 $ に空港を建設する。 - コスト $ X_3=4 $ を払って、島 $ 3 $ に空港を建設する。 - コスト $ Y_2=2 $ を払って、島 $ 2 $ に港を建設する。 - コスト $ Y_4=3 $ を払って、島 $ 4 $ に港を建設する。 - コスト $ Z_2=6 $ を払って、島 $ 1 $ と島 $ 4 $ の間を結ぶ道路を建設する。 このとき、目標は達成されており、かかったコストは $ 16 $ となります。 コスト $ 15 $ 以下で目標を達成する方法はないため、$ 16 $ を出力します。

### Sample Explanation 2

空港・港・道路のうち、一度も建設されないものがあっても構いません。

## 样例 #1

### 输入

```
4 2

1 20 4 7

20 2 20 3

1 3 5

1 4 6
```

### 输出

```
16
```

## 样例 #2

### 输入

```
3 1

1 1 1

10 10 10

1 2 100
```

### 输出

```
3
```

## 样例 #3

### 输入

```
7 8

35 29 36 88 58 15 25

99 7 49 61 67 4 57

2 3 3

2 5 36

2 6 89

1 6 24

5 7 55

1 3 71

3 4 94

5 6 21
```

### 输出

```
160
```



---

---
title: "[ABC271E] Subsequence Path"
layout: "post"
diff: 普及+/提高
pid: AT_abc271_e
tag: []
---

# [ABC271E] Subsequence Path

## 题目描述

某地区有 $N$ 个城镇，编号为 1 到 $N$ ，并且由 $M$ 条公路连接，编号 1 到 $M$ 。

每条公路都是有向的；而且编号为 $i(1 \le i \le M)$ 的道路将带领你从编号 $A_i$ 的城镇到编号为 $B_i$ 的城镇去,它的长度为 $C_i$。

现在给你一个长度为 $K$ 的正整数序列 $E=(E_1,E_2,...,E_K)$ 且 $\forall i \in [1,K],E_i \in [1,M]$ 。我们说一条由一些连通的公路组成的路径为“**好路**”，当且仅当满足以下条件：

+ 这条路径的起点为 1 ，终点为 $N$ 。
+ 按经过顺序组成这条路径的公路的编号组成的序列是 $E$ 的子序列。

**注意**，若序列 $S$ 是长度为 $L$ 的数列 $T$ 的**子序列**，则 $S$ 是数列 $T$ 删除任意 $i\ (i\in [0,L])$ 个元素得到的。

现在你要找到最短的“**好路**”。如果没有，输出 ```-1``` 。

## 输入格式

一切按照以下标准输入：

>$N\ M\ K\newline A_1\ B_1\ C_1\newline\vdots\newline A_M\ B_M\ C_M\newline E_1\ ...\ E_K$

## 输出格式

输出最短的“**好路**”。如果没有，输出 ```-1``` 。

## 说明/提示

- $ 2\ \leq\ N\ \leq\ 2\ \times\ 10^5 $
- $ 1\ \leq\ M,\ K\ \leq\ 2\ \times\ 10^5 $
- $ 1\ \leq\ A_i,\ B_i\ \leq\ N,\ A_i\ \neq\ B_i\ \,\ (1\ \leq\ i\ \leq\ M) $
- $ 1\ \leq\ C_i\ \leq\ 10^9\ \,\ (1\ \leq\ i\ \leq\ M) $
- $ 1\ \leq\ E_i\ \leq\ M\ \,\ (1\ \leq\ i\ \leq\ K) $
+ 所有输入都是整数

#### 样例解释

对于**样例1**，有两条好路：

+ 选择编号为 $4$ 的公路。在这种情况下，“**好路**”的长度是 $5$ 。
+ 依次选择编号为 $1$ 和 $2$ 的公路。在这种情况下，“**好路**”的长度就变为了 $2+2=4$ 。

因此，输出的期望值为 $4$ 。

对于**样例2**，没有“**好路**”，输出 ``` -1 ``` 。

## 样例 #1

### 输入

```
3 4 4

1 2 2

2 3 2

1 3 3

1 3 5

4 2 1 2
```

### 输出

```
4
```

## 样例 #2

### 输入

```
3 2 3

1 2 1

2 3 1

2 1 1
```

### 输出

```
-1
```

## 样例 #3

### 输入

```
4 4 5

3 2 2

1 3 5

2 4 7

3 4 10

2 4 1 4 3
```

### 输出

```
14
```



---

---
title: "[ABC272E] Add and Mex"
layout: "post"
diff: 普及+/提高
pid: AT_abc272_e
tag: []
---

# [ABC272E] Add and Mex

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc272/tasks/abc272_e

長さ $ N $ の整数列 $ A=(A_1,A_2,\ldots,A_N) $ が与えられます。

以下の操作を $ M $ 回行ってください。

- 各 $ i\ (1\leq\ i\ \leq\ N) $ について、 $ A_i $ に $ i $ を加算する。その後 $ A $ に含まれない最小の非負整数を求める。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ M $ $ A_1 $ $ A_2 $ $ \ldots $ $ A_N $

## 输出格式

$ M $ 行出力せよ。

$ i $ $ (1\leq\ i\ \leq\ M) $ 行目には $ i $ 回目の操作後に $ A $ に含まれない最小の非負整数を出力せよ。

## 说明/提示

### 制約

- $ 1\leq\ N,M\ \leq\ 2\times\ 10^5 $
- $ -10^9\leq\ A_i\leq\ 10^9 $
- 入力は全て整数

### Sample Explanation 1

$ 1 $ 回目の操作では、数列 $ A $ は $ (-1\ +\ 1,\ -1\ +2\ ,-6+3)\ =\ (0,1,-3) $ になります。 $ A $ に含まれない最小の非負整数は $ 2 $ です。 $ 2 $ 回目の操作では、数列 $ A $ は $ (0\ +\ 1,\ 1\ +2\ ,-3+3)\ =\ (1,3,0) $ になります。 $ A $ に含まれない最小の非負整数は $ 2 $ です。 $ 3 $ 回目の操作では、数列 $ A $ は $ (1\ +\ 1,\ 3\ +2\ ,0+3)\ =\ (2,5,3) $ になります。 $ A $ に含まれない最小の非負整数は $ 0 $ です。

## 样例 #1

### 输入

```
3 3
-1 -1 -6
```

### 输出

```
2
2
0
```

## 样例 #2

### 输入

```
5 6
-2 -2 -5 -7 -15
```

### 输出

```
1
3
2
0
0
0
```



---

---
title: "[ABC273E] Notebook"
layout: "post"
diff: 普及+/提高
pid: AT_abc273_e
tag: []
---

# [ABC273E] Notebook

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc273/tasks/abc273_e

整数列 $ A $ とノートがあります。ノートには $ 10^9 $ 枚のページがあります。

$ Q $ 個のクエリが与えられます。各クエリは下記の $ 4 $ 種類のいずれかです。

> ADD $ x $ : 整数 $ x $ を $ A $ の末尾に追加する。

> DELETE : $ A $ の末尾の要素を削除する。ただし、$ A $ が空である場合は何もしない。

> SAVE $ y $ : ノートの $ y $ ページ目に書かれている数列を消し、代わりに現在の $ A $ を $ y $ ページ目に書き込む。

> LOAD $ z $ : $ A $ をノートの $ z $ ページ目に書かれている数列で置き換える。

はじめ、$ A $ は空列であり、ノートのすべてのページには空列の情報が書かれています。 その初期状態から、$ Q $ 個のクエリを与えられる順に実行し、各クエリの実行直後における $ A $ の末尾の要素を出力してください。

なお、入出力の量が多くなる場合があるので、高速な方法で入出力を行うことを推奨します。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ Q $ $ \mathrm{query}_1 $ $ \mathrm{query}_2 $ $ \vdots $ $ \mathrm{query}_Q $

## 输出格式

下記の形式にしたがい、$ i\ =\ 1,\ 2,\ \ldots,\ Q $ について、$ i $ 番目までのクエリを実行した直後の $ A $ の末尾の要素 $ X_i $ を（ $ A $ が空の場合は $ X_i\ :=\ -1 $ とする）出力せよ。

> $ X_1 $ $ X_2 $ $ \ldots $ $ X_Q $

## 说明/提示

### 制約

- $ 1\ \leq\ Q\ \leq\ 5\ \times\ 10^5 $
- $ 1\ \leq\ x,\ y,\ z\ \leq\ 10^9 $
- $ Q,\ x,\ y,\ z $ は整数
- 与えられるクエリは問題文中の $ 4 $ 種類のいずれか

### Sample Explanation 1

はじめ、$ A $ は空列、すなわち $ A\ =\ () $ であり、ノートのすべてのページには空列の情報が書かれています。 - $ 1 $ 番目のクエリによって、 $ A $ の末尾に $ 3 $ が追加され、$ A\ =\ (3) $ となります。 - $ 2 $ 番目のクエリによって、ノートの $ 1 $ ページ目に書かれた数列が $ (3) $ になります。$ A $ は変わらず $ A\ =\ (3) $ です。 - $ 3 $ 番目のクエリによって、 $ A $ の末尾に $ 4 $ が追加され、$ A\ =\ (3,\ 4) $ となります。 - $ 4 $ 番目のクエリによって、ノートの $ 2 $ ページ目に書かれた数列が $ (3,\ 4) $ になります。$ A $ は変わらず $ A\ =\ (3,\ 4) $ です。 - $ 5 $ 番目のクエリによって、 $ A $ がノートの $ 1 $ ページ目に書かれた数列 $ (3) $ で置き換えられ、$ A\ =\ (3) $ となります。 - $ 6 $ 番目のクエリによって、 $ A $ の末尾の要素が削除され、$ A\ =\ () $ となります。 - $ 7 $ 番目のクエリでは、$ A $ がすでに空であるので何もしません。$ A $ は変わらず $ A\ =\ () $ です。 - $ 8 $ 番目のクエリによって、 $ A $ がノートの $ 2 $ ページ目に書かれた数列 $ (3,\ 4) $ で置き換えられ、$ A\ =\ (3,\ 4) $ となります。 - $ 9 $ 番目のクエリによって、ノートの $ 1 $ ページ目に書かれた数列が $ (3,\ 4) $ になります。$ A $ は変わらず $ A\ =\ (3,\ 4) $ です。 - $ 10 $ 番目のクエリによって、 $ A $ がノートの $ 3 $ ページ目に書かれた数列 $ () $ で置き換えられ、$ A\ =\ () $ となります。 - $ 11 $ 番目のクエリによって、 $ A $ がノートの $ 1 $ ページ目に書かれた数列 $ (3,\ 4) $ で置き換えられ、$ A\ =\ (3,\ 4) $ となります。

## 样例 #1

### 输入

```
11

ADD 3

SAVE 1

ADD 4

SAVE 2

LOAD 1

DELETE

DELETE

LOAD 2

SAVE 1

LOAD 3

LOAD 1
```

### 输出

```
3 3 4 4 3 -1 -1 4 4 -1 4
```

## 样例 #2

### 输入

```
21

ADD 4

ADD 3

DELETE

ADD 10

LOAD 7

SAVE 5

SAVE 5

ADD 4

ADD 4

ADD 5

SAVE 5

ADD 2

DELETE

ADD 1

SAVE 5

ADD 7

ADD 8

DELETE

ADD 4

DELETE

LOAD 5
```

### 输出

```
4 3 4 10 -1 -1 -1 4 4 5 5 2 5 1 1 7 8 7 4 7 1
```



---

---
title: "[ABC274E] Booster"
layout: "post"
diff: 普及+/提高
pid: AT_abc274_e
tag: []
---

# [ABC274E] Booster

## 题目描述

在平面直角坐标系中，有 $n$ 个城镇和 $m$ 个箱子。

你现在在 $(0,0)$，速度为 $1$，你需要走遍所有城镇后回到 $(0,0)$。

你可以选择走到箱子所处的位置，如果你第一次走到这个箱子，你可以吞下箱子里仅剩的一颗能量球，然后你的速度就翻倍了。

求从 $(0,0)$ 走遍所有城镇后回到 $(0,0)$ 所需的最短时间。

## 输入格式

第一行两个整数 $n,m$，含义如题中所述。

接下来 $n$ 行，第 $i+1$ 行两个整数表示第 $i$ 个城镇的坐标 $(x_i,y_i)$。

接下来 $m$ 行，第 $i+n+1$ 行两个整数表示第 $i$ 个箱子的坐标 $(p_i,q_i)$。

## 输出格式

一行一个小数，表示答案。

## 说明/提示

样例一：路径为 $O-Chest_1-Town_1-Town_2-O$。  
样例二：路径为 $O-Town_1-Town_2-O$。


对于所有数据，$1\leq n\leq 12,0\leq m\leq 5,0\leq |x_i|,|y_i|,|p_i|,|q_i|\leq 10^9$。

Translate by Zek3L.

## 样例 #1

### 输入

```
2 1
1 1
0 1
1 0
```

### 输出

```
2.5000000000
```

## 样例 #2

### 输入

```
2 1
1 1
0 1
100 0
```

### 输出

```
3.4142135624
```

## 样例 #3

### 输入

```
1 2
4 4
1 0
0 1
```

### 输出

```
4.3713203436
```



---

---
title: "[ABC275F] Erase Subarrays"
layout: "post"
diff: 普及+/提高
pid: AT_abc275_f
tag: []
---

# [ABC275F] Erase Subarrays

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc275/tasks/abc275_f

正整数列 $ A=(a_1,a_2,\ldots,a_N) $ が与えられます。  
あなたは次の操作を $ 0 $ 回以上何度でも繰り返せます。

- $ A $ から（空でない）連続する部分列を選び、削除する。

$ x=1,2,\ldots,M $ に対し、次の問題を解いてください。

- $ A $ の要素の総和をちょうど $ x $ にするために必要な操作回数の最小値を求めてください。ただし、どのように操作を行っても $ A $ の要素の総和をちょうど $ x $ にできない場合は代わりに `-1` と出力してください。

なお、$ A $ が空である時、$ A $ の要素の総和は $ 0 $ であるとします。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ M $ $ a_1 $ $ \ldots $ $ a_N $

## 输出格式

$ M $ 行出力せよ。$ i $ 行目には $ x=i $ に対する答えを出力せよ。

## 说明/提示

### 制約

- $ 1\ \leq\ N,M\ \leq\ 3000 $
- $ 1\ \leq\ a_i\ \leq\ 3000 $
- 入力はすべて整数

### Sample Explanation 1

操作回数が最小である操作の例を以下に示します。 - $ x=1 $ について、$ a_2,a_3,a_4 $ に対して操作をすることで $ A $ の要素の総和が $ x $ になります。 - $ x=2 $ について、$ a_3,a_4 $ に対して操作をした後、$ a_1 $ に対して操作をすることで $ A $ の要素の総和が $ x $ になります。 - $ x=3 $ について、$ a_3,a_4 $ に対して操作をすることで $ A $ の要素の総和が $ x $ になります。 - $ x=4 $ について、$ a_1,a_2,a_3 $ に対して操作をすることで $ A $ の要素の総和が $ x $ になります。 - $ x=5 $ について、$ a_2,a_3 $ に対して操作をすることで $ A $ の要素の総和が $ x $ になります。

## 样例 #1

### 输入

```
4 5
1 2 3 4
```

### 输出

```
1
2
1
1
1
```

## 样例 #2

### 输入

```
1 5
3
```

### 输出

```
-1
-1
0
-1
-1
```

## 样例 #3

### 输入

```
12 20
2 5 6 5 2 1 7 9 7 2 5 5
```

### 输出

```
2
1
2
2
1
2
1
2
2
1
2
1
1
1
2
2
1
1
1
1
```



---

---
title: "[ABC276F] Double Chance"
layout: "post"
diff: 普及+/提高
pid: AT_abc276_f
tag: []
---

# [ABC276F] Double Chance

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc276/tasks/abc276_f

カード $ 1 $, カード $ 2 $, $ \ldots $, カード $ N $ の $ N $ 枚のカードがあり、 カード $ i $ $ (1\leq\ i\leq\ N) $ には整数 $ A_i $ が書かれています。

$ K=1,2,\ldots,N $ について、次の問題を解いてください。

> カード $ 1 $, カード $ 2 $, $ \ldots $, カード $ K $ の $ K $ 枚のカードが入っている袋があります。  
> 次の操作を $ 2 $ 回繰り返し、記録された数を順に $ x,y $ とします。
> 
> > 袋から無作為にカードを $ 1 $ 枚取り出し、カードに書かれている数を記録する。その後、カードを **袋の中に戻す** 。
> 
> $ \max(x,y) $ の値の期待値を $ \text{mod}\ 998244353 $ で出力してください（注記参照）。  
> ただし、$ \max(x,y) $ で $ x $ と $ y $ のうち小さくない方の値を表します。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ A_1 $ $ A_2 $ $ \ldots $ $ A_N $

## 输出格式

$ N $ 行出力せよ。 $ i $ 行目 $ (1\leq\ i\leq\ N) $ には、$ K=i $ の時の問題に対する答えを出力せよ。

## 说明/提示

### 注記

求める期待値は必ず有限値かつ有理数となることが証明できます。また、この問題の制約下では、その値を互いに素な $ 2 $ つの整数 $ P $, $ Q $ を用いて $ \frac{P}{Q} $ と表したとき、$ R\ \times\ Q\ \equiv\ P\pmod{998244353} $ かつ $ 0\ \leq\ R\ \lt\ 998244353 $ を満たす整数 $ R $ がただ一つ存在することが証明できます。この $ R $ を出力してください。

### 制約

- $ 1\ \leq\ N\ \leq\ 2\times\ 10^5 $
- $ 1\ \leq\ A_i\ \leq\ 2\times\ 10^5 $
- 入力は全て整数

### Sample Explanation 1

例えば、$ K=2 $ の時の答えは次のようにして求まります。 袋の中にはカード $ 1 $ とカード $ 2 $ が入っており、それぞれには $ A_1=5 $ と $ A_2=7 $ が書かれています。 - $ 1 $ 回目に取り出されたカードがカード $ 1 $ 、$ 2 $ 回目に取り出されたカードもカード $ 1 $ のとき、$ x=y=5 $ であり、$ \max(x,y)=5 $ となります。 - $ 1 $ 回目に取り出されたカードがカード $ 1 $ 、$ 2 $ 回目に取り出されたカードはカード $ 2 $ のとき、$ x=5 $, $ y=7 $ であり、$ \max(x,y)=7 $ となります。 - $ 1 $ 回目に取り出されたカードがカード $ 2 $ 、$ 2 $ 回目に取り出されたカードはカード $ 1 $ のとき、$ x=7 $, $ y=5 $ であり、$ \max(x,y)=7 $ となります。 - $ 1 $ 回目に取り出されたカードがカード $ 2 $ 、$ 2 $ 回目に取り出されたカードもカード $ 2 $ のとき、$ x=y=7 $ であり、$ \max(x,y)=7 $ となります。 これらが等確率で起こるため、期待値は $ \frac{5+7+7+7}{4}=\frac{13}{2} $ となります。 $ 499122183\times\ 2\equiv\ 13\ \pmod{998244353} $ であるため、$ 499122183 $ を出力します。

## 样例 #1

### 输入

```
3
5 7 5
```

### 输出

```
5
499122183
443664163
```

## 样例 #2

### 输入

```
7
22 75 26 45 72 81 47
```

### 输出

```
22
249561150
110916092
873463862
279508479
360477194
529680742
```



---

---
title: "[ABC277E] Crystal Switches"
layout: "post"
diff: 普及+/提高
pid: AT_abc277_e
tag: []
---

# [ABC277E] Crystal Switches

## 题目描述

【题面翻译】

给定一张 $n$ 个点 $m$ 条边的无向图。每条边有一个权值 $w \in \{0, 1\}$。$w = 0$ 表示这条边无法通过，$w = 1$ 则可以通过。

有 $k$ 个点上面有按钮 $s_i$。

你现在位于 $1$ 号点。每次，你可以做两件事情中的一件：

1. 移动。移到相邻的一个点上，注意这条边一定是可以通行的。
2. 按开关。此时，全部路的边权取反。即：$w = 0$ 变成 $1$，$w = 1$ 变成 $0$。

请问你是否能够到达 $n$ 号点。如果可以，求出最少移动次数。

translated by @[liangbowen](https://www.luogu.com.cn/user/367488).

## 输入格式

第一行三个数 $n, m, k$。

接下来 $m$ 行，每行三个数 $u_i, v_i, w_i$表示一条连接 $u_i$ 与 $v_i$ 的边。

最后一行 $k$ 个数，表示按钮的位置。

## 输出格式

如果无法到达，输出 $-1$。否则输出最少移动次数。

## 说明/提示

$2 \le n \le 2 \times 10^5$

$1 \le m \le 2 \times 10^5$

$1 \le k \le n$

保证 $1 \le u_i, v_i \le n$，且 $u_i \ne v_i$。

保证 $1 \le s_1 < s_2 < \cdots < s_k \le n$。

## 样例 #1

### 输入

```
5 5 2

1 3 0

2 3 1

5 4 1

2 1 1

1 4 0

3 4
```

### 输出

```
5
```

## 样例 #2

### 输入

```
4 4 2

4 3 0

1 2 1

1 2 0

2 1 1

2 4
```

### 输出

```
-1
```



---

---
title: "[ABC278F] Shiritori"
layout: "post"
diff: 普及+/提高
pid: AT_abc278_f
tag: []
---

# [ABC278F] Shiritori

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc278/tasks/abc278_f

$ N $ 個の文字列 $ S\ _\ 1,S\ _\ 2,\ldots,S\ _\ N $ が与えられます。 $ S\ _\ i\ (1\leq\ i\leq\ N) $ は英小文字からなる長さ $ 10 $ 以下の空でない文字列で、互いに異なります。

先手太郎君と後手次郎君がしりとりをします。 このしりとりでは、先手太郎君と後手次郎君の手番が交互に訪れます。 はじめの手番は先手太郎君の手番です。 それぞれのプレイヤーは自分の手番において整数 $ i\ (1\leq\ i\leq\ N) $ を $ 1 $ つ選びます。 このとき、$ i $ は次の $ 2 $ つの条件を満たしていなければなりません。

- $ i $ は、しりとりが開始してからこれまでの $ 2 $ 人の手番で選ばれたどの整数とも異なる
- この手番がしりとりの最初の手番であるか、直前に選ばれた整数を $ j $ として、$ S\ _\ j $ の最後の文字と $ S\ _\ i $ の最初の文字が等しい
 
条件を満たす $ i $ を選べなくなったプレイヤーの負けで、負けなかったプレイヤーの勝ちです。

$ 2 $ 人が最適に行動したときに勝つのはどちらかを判定してください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ S_1 $ $ S_2 $ $ \vdots $ $ S_N $

## 输出格式

$ 2 $ 人が最適に行動したとき、先手太郎君が勝つなら `First`、後手次郎君が勝つなら `Second` と出力せよ。

## 说明/提示

### 制約

- $ 1\ \leq\ N\ \leq\ 16 $
- $ N $ は整数
- $ S\ _\ i\ (1\leq\ i\leq\ N) $ は英小文字からなる長さ $ 10 $ 以下の空でない文字列
- $ S\ _\ i\neq\ S\ _\ j\ (1\leq\ i\lt\ j\leq\ N) $
 
### Sample Explanation 1

例えば、ゲームは以下のように進行します。 この進行例では $ 2 $ 人の行動が必ずしも最適とは限らないことに注意してください。 - 先手太郎君が $ i=3 $ を選ぶ。$ S\ _\ i= $`if` である。 - 後手次郎君が $ i=2 $ を選ぶ。$ S\ _\ i= $`float` であり、`if` の最後の文字と `float` の最初の文字は等しい。 - 先手太郎君が $ i=5 $ を選ぶ。$ S\ _\ i= $`takahashi` であり、`float` の最後の文字と `takahashi` の最初の文字は等しい。 - 後手次郎君は $ i\neq2,3,5 $ であって $ S\ _\ i $ の最初の文字が `i` と等しいものを選べないため、負ける。 このとき、先手太郎君が勝ちます。

## 样例 #1

### 输入

```
6

enum

float

if

modint

takahashi

template
```

### 输出

```
First
```

## 样例 #2

### 输入

```
10

catch

chokudai

class

continue

copy

exec

havoc

intrinsic

static

yucatec
```

### 输出

```
Second
```

## 样例 #3

### 输入

```
16

mnofcmzsdx

lgeowlxuqm

ouimgdjxlo

jhwttcycwl

jbcuioqbsj

mdjfikdwix

jhvdpuxfil

peekycgxco

sbvxszools

xuuqebcrzp

jsciwvdqzl

obblxzjhco

ptobhnpfpo

muizaqtpgx

jtgjnbtzcl

sivwidaszs
```

### 输出

```
First
```



---

---
title: "[ABC279E] Cheating Amidakuji"
layout: "post"
diff: 普及+/提高
pid: AT_abc279_e
tag: []
---

# [ABC279E] Cheating Amidakuji

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc279/tasks/abc279_e

<!-- 
$ N $ 本の縦棒と、それらの間を結ぶ $ M $ 本の横棒からなるあみだくじがあります。
各横棒は縦棒と垂直に引かれていて、その高さは相異なります。
縦棒を左から順に $ 1,2,\dots,N $、横棒を上から順に $ 1,2,\dots,M $ としたとき、
横棒 $ i\ (1\ \leq\ i\ \leq\ M) $ は縦棒 $ A_i $ と縦棒 $ A_i+1 $ の間を結んでいます。

縦棒 $ 1 $ の上端からあみだくじを下に辿っていったとき、最終的に到達する縦棒の番号を**スコア**と定義します。

$ i=1,2,\dots,M $ について、以下の質問に答えてください。

- 横棒 $ i $ を消したときのスコアを $ S_i $ と定義する。$ S_i $ を求めよ。

なお、実際には横棒は消さないため、各質問は独立であることに注意してください。

より厳密には、以下の通りです。
-->$ 1 $ 以上 $ N-1 $ 以下の整数からなる長さ $ M $ の数列 $ A=(A_1,A_2,\dots,A_M) $ が与えられます。 $ i=1,2,\dots,M $ について、以下の質問に答えてください。

- 数列 $ B=(B_1,B_2,\dots,B_N) $ がある。最初、各 $ j $ について $ B_j=j $ である。今から、$ k=1,2,\dots,i-1,i+1,\dots,M $ の順に以下の操作を行う （すなわち、$ i $ を除いた $ 1 $ 以上 $ M $ 以下の整数 $ k $ について、昇順に以下の操作を行う）。
  - $ B_{A_k} $ と $ B_{A_k+1} $ の値を入れ替える。
- 全ての操作が終了した段階で、$ B_j=1 $ を満たす $ j $ の値を $ S_i $ と定義する。$ S_i $ を求めよ。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ M $ $ A_1 $ $ A_2 $ $ \dots $ $ A_M $

## 输出格式

$ M $ 行出力せよ。 $ i\ (1\leq\ i\ \leq\ M) $ 行目には、$ S_i $ の値を整数として出力せよ。

## 说明/提示

### 制約

- $ 2\ \leq\ N\ \leq\ 2\times\ 10^5 $
- $ 1\ \leq\ M\ \leq\ 2\times\ 10^5 $
- $ 1\ \leq\ A_i\ \leq\ N-1\ (1\leq\ i\ \leq\ M) $
- 入力は全て整数
 
### Sample Explanation 1

$ i\ =\ 2 $ のとき、操作によって $ B $ は以下のように変化します。 - 最初、$ B\ =\ (1,2,3,4,5) $ - $ k=1 $ として操作を行う。すなわち $ B_1 $ と $ B_2 $ の値を入れ替えて、$ B\ =\ (2,1,3,4,5) $ - $ k=3 $ として操作を行う。すなわち $ B_3 $ と $ B_4 $ の値を入れ替えて、$ B\ =\ (2,1,4,3,5) $ - $ k=4 $ として操作を行う。すなわち $ B_2 $ と $ B_3 $ の値を入れ替えて、$ B\ =\ (2,4,1,3,5) $ 全ての操作が終了した段階で $ B_3=1 $ であるため、$ S_2\ =\ 3 $ です。 同様に、 - $ i=1 $ のとき：$ k=2,3,4 $ の順に操作を行うと $ B=(1,4,3,2,5) $ になるので、$ S_1=1 $ - $ i=3 $ のとき：$ k=1,2,4 $ の順に操作を行うと $ B=(2,1,3,4,5) $ になるので、$ S_3=2 $ - $ i=4 $ のとき：$ k=1,2,3 $ の順に操作を行うと $ B=(2,3,4,1,5) $ になるので、$ S_4=4 $ です。

## 样例 #1

### 输入

```
5 4

1 2 3 2
```

### 输出

```
1

3

2

4
```

## 样例 #2

### 输入

```
3 3

2 2 2
```

### 输出

```
1

1

1
```

## 样例 #3

### 输入

```
10 10

1 1 1 9 4 4 2 1 3 3
```

### 输出

```
2

2

2

3

3

3

1

3

4

4
```



---

---
title: "[ABC279F] BOX"
layout: "post"
diff: 普及+/提高
pid: AT_abc279_f
tag: []
---

# [ABC279F] BOX

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc279/tasks/abc279_f

$ N $ 個の箱 $ 1,2,\dots,N $ と、 $ 10^{100} $ 個のボール $ 1,2,\dots,10^{100} $ があります。 最初、箱 $ i $ にはボール $ i $ のみが入っています。

ここに以下の操作が合計 $ Q $ 回行われるので、処理してください。

操作にはタイプ $ 1,2,3 $ の $ 3 $ 種類があります。

タイプ $ 1 $ : 箱 $ X $ に箱 $ Y $ の中身を全て入れる。 この操作では $ X\ \neq\ Y $ が保証される。

> 1 $ X $ $ Y $

タイプ $ 2 $ : 現在いずれかの箱に入っているボールの数の合計を $ k $ とすると、箱 $ X $ にボール $ k+1 $ を入れる。

> 2 $ X $

タイプ $ 3 $ : ボール $ X $ が入っている箱の番号を答える。

> 3 $ X $

## 输入格式

入力は以下の形式で標準入力から与えられる。  
但し、 $ op_i $ は $ i $ 回目の操作を表す。

> $ N $ $ Q $ $ op_1 $ $ op_2 $ $ \vdots $ $ op_Q $

## 输出格式

各タイプ $ 3 $ の操作に対して、答えを $ 1 $ 行に $ 1 $ つ、整数として出力せよ。

## 说明/提示

### 制約

- 入力は全て整数
- $ 2\ \le\ N\ \le\ 3\ \times\ 10^5 $
- $ 1\ \le\ Q\ \le\ 3\ \times\ 10^5 $
- タイプ $ 1 $ の操作について、 $ 1\ \le\ X,Y\ \le\ N $ かつ $ X\ \neq\ Y $
- タイプ $ 2 $ の操作について、 $ 1\ \le\ X\ \le\ N $
- タイプ $ 3 $ の操作について、その時点でボール $ X $ がいずれかの箱に入っている
- タイプ $ 3 $ の操作が少なくとも $ 1 $ つ与えられる

### Sample Explanation 1

この入力は $ 10 $ 個の操作を含みます。 - $ 1 $ 回目の操作はタイプ $ 3 $ です。ボール $ 5 $ は箱 $ 5 $ に入っています。 - $ 2 $ 回目の操作はタイプ $ 1 $ です。箱 $ 1 $ に箱 $ 4 $ の中身を全て入れます。 - 箱 $ 1 $ の中身はボール $ 1,4 $ 、箱 $ 4 $ の中身は空になります。 - $ 3 $ 回目の操作はタイプ $ 2 $ です。箱 $ 1 $ にボール $ 6 $ を入れます。 - $ 4 $ 回目の操作はタイプ $ 2 $ です。箱 $ 4 $ にボール $ 7 $ を入れます。 - $ 5 $ 回目の操作はタイプ $ 3 $ です。ボール $ 7 $ は箱 $ 4 $ に入っています。 - $ 6 $ 回目の操作はタイプ $ 1 $ です。箱 $ 3 $ に箱 $ 1 $ の中身を全て入れます。 - 箱 $ 3 $ の中身はボール $ 1,3,4,6 $ 、箱 $ 1 $ の中身は空になります。 - $ 7 $ 回目の操作はタイプ $ 3 $ です。ボール $ 4 $ は箱 $ 3 $ に入っています。 - $ 8 $ 回目の操作はタイプ $ 1 $ です。箱 $ 1 $ に箱 $ 4 $ の中身を全て入れます。 - 箱 $ 1 $ の中身はボール $ 7 $ 、箱 $ 4 $ の中身は空になります。 - $ 9 $ 回目の操作はタイプ $ 3 $ です。ボール $ 7 $ は箱 $ 1 $ に入っています。 - $ 10 $ 回目の操作はタイプ $ 3 $ です。ボール $ 6 $ は箱 $ 3 $ に入っています。

## 样例 #1

### 输入

```
5 10
3 5
1 1 4
2 1
2 4
3 7
1 3 1
3 4
1 1 4
3 7
3 6
```

### 输出

```
5
4
3
1
3
```



---

---
title: "[ABC280F] Pay or Receive"
layout: "post"
diff: 普及+/提高
pid: AT_abc280_f
tag: []
---

# [ABC280F] Pay or Receive

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc280/tasks/abc280_f

$ 1,\ldots,N $ の番号がついた $ N $ 個の街と、$ 1,\ldots,M $ の番号がついた $ M $ 本の道路があります。

道路 $ i $ は街 $ A_i $ と $ B_i $ を結んでいます。道路を通行すると、所持している **ポイント** が次の通り増減します。

- 道路 $ i $ を使って、街 $ A_i $ から街 $ B_i $ に移動するときにはポイントが $ C_i $ 増加し、街 $ B_i $ から街 $ A_i $ に移動するときにはポイントが $ C_i $ 減少する。
 
所持しているポイントは負にもなりえます。

次の $ Q $ 個の質問に答えてください。

- 所持しているポイントが $ 0 $ である状態で街 $ X_i $ から移動を始めたとき、街 $ Y_i $ にいる状態で所持しているポイントの最大値を出力せよ。  
   ただし、街 $ X_i $ から街 $ Y_i $ に到達できないときは `nan`、街 $ Y_i $ にいる状態で所持しているポイントをいくらでも増やせるときは `inf` を代わりに出力せよ。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ M $ $ Q $ $ A_1 $ $ B_1 $ $ C_1 $ $ \vdots $ $ A_M $ $ B_M $ $ C_M $ $ X_1 $ $ Y_1 $ $ \vdots $ $ X_Q $ $ Y_Q $

## 输出格式

問題文の指示通りに $ Q $ 行出力せよ。  
 $ i $ 行目には $ i $ 番目の質問に対する答えを出力せよ。

## 说明/提示

### 制約

- $ 2\leq\ N\ \leq\ 10^5 $
- $ 0\leq\ M\ \leq\ 10^5 $
- $ 1\leq\ Q\ \leq\ 10^5 $
- $ 1\leq\ A_i,B_i,X_i,Y_i\ \leq\ N $
- $ 0\leq\ C_i\ \leq\ 10^9 $
- 入力は全て整数である
 
### Sample Explanation 1

$ 1 $ 番目の質問では、道路 $ 5 $ を使って街 $ 5 $ から街 $ 3 $ に移動すると、ポイントを $ -2 $ 所持している状態で街 $ 3 $ にいることができます。 これ以上ポイントを大きくすることはできないので答えは $ -2 $ になります。 $ 2 $ 番目の質問では、「道路 $ 2 $ を使って街 $ 1 $ から街 $ 2 $ に移動し、道路 $ 1 $ を使って街 $ 2 $ から街 $ 1 $ に移動する」 という行動を好きなだけ繰り返したあと、道路 $ 2 $ を使って街 $ 1 $ から街 $ 2 $ に移動することで、 街 $ 2 $ にいる状態で所持しているポイントをいくらでも増やすことができます。 $ 3 $ 番目の質問では、街 $ 3 $ から移動を始めて街 $ 1 $ へ到達することはできません。

### Sample Explanation 2

始点と終点が同じ街である道路や、始点と終点が同じ街である質問が含まれることもあります。

## 样例 #1

### 输入

```
5 5 3

1 2 1

1 2 2

3 4 1

4 5 1

3 5 2

5 3

1 2

3 1
```

### 输出

```
-2

inf

nan
```

## 样例 #2

### 输入

```
2 1 1

1 1 1

1 1
```

### 输出

```
inf
```

## 样例 #3

### 输入

```
9 7 5

3 1 4

1 5 9

2 6 5

3 5 8

9 7 9

3 2 3

8 4 6

2 6

4 3

3 8

3 2

7 9
```

### 输出

```
inf

nan

nan

inf

-9
```



---

---
title: "[ABC281E] Least Elements"
layout: "post"
diff: 普及+/提高
pid: AT_abc281_e
tag: []
---

# [ABC281E] Least Elements

## 题目描述

给定一个序列 $A$，对于每个 $1 \le i \le N - M + 1$，将 $A_i A_{i + 1} \cdots A_{i + M - 1}$ **从小到大**排序后（不影响原序列），求出 $\displaystyle ans_i = \sum\limits_{j=i}^{i+k-1} A_j$。

## 输入格式

> $N, M, K\\ A_1 A_2 \cdots A_N$

## 输出格式

> $\mathrm{ans}_1 \mathrm{ans}_2 \cdots \mathrm{ans}_{N-M+1}$

## 说明/提示

$1 \le K \le M \le N \le 2 \times 10^5$

$1 \le A_i \le 10^9$

## 样例 #1

### 输入

```
6 4 3

3 1 4 1 5 9
```

### 输出

```
5 6 10
```

## 样例 #2

### 输入

```
10 6 3

12 2 17 11 19 8 4 3 6 20
```

### 输出

```
21 14 15 13 13
```



---

---
title: "[ABC285E] Work or Rest"
layout: "post"
diff: 普及+/提高
pid: AT_abc285_e
tag: []
---

# [ABC285E] Work or Rest

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc285/tasks/abc285_e

高橋君が住む世界の一週間は $ N $ 日からなります。  
 一週間は曜日 $ 1,2,\dots,N $ と進んでいき、曜日 $ N $ が終わると次の週の曜日 $ 1 $ が始まります。

ABC 国の国王である高橋君は、各曜日に「平日」「休日」のどちらかを割り当てます。この割り当ては毎週同じでなければなりません。また、少なくとも $ 1 $ つの曜日を「休日」に割り当てなければなりません。

この条件の下で、曜日 $ i $ の生産量は長さ $ N $ の数列 $ A $ を用いて以下のように定義されます。

- 曜日 $ i $ が「休日」である場合は $ 0 $
- 曜日 $ i $ が「平日」のとき、直前の休日が $ x $ 日前、直後の休日が $ y $ 日後である場合は $ A_{\min(x,y)} $
  - 割り当ては毎週繰り返されるため、 直前 / 直後 の「休日」が当日とは別の週に属する可能性があることに注意してください。詳しくはサンプルを参照してください。
 
上手く割り当てを決めたときの一週間当たりの生産量の最大値を答えてください。  
 但し、一週間当たりの生産量とは曜日 $ 1,2,\dots,N $ の生産量の総和を指します。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ A_1 $ $ A_2 $ $ \dots $ $ A_N $

## 输出格式

答えを整数として出力せよ。

## 说明/提示

### 制約

- 入力はすべて整数
- $ 1\ \le\ N\ \le\ 5000 $
- $ 1\ \le\ A_i\ \le\ 10^9 $
 
### Sample Explanation 1

例えば曜日 $ 2,4 $ を「休日」、残りを「平日」に割り当てることで、以下のように一週間当たりの生産量 $ 50 $ を達成できます。 - 曜日 $ 1 $ ... $ x=4,y=1 $ なので、この曜日の生産量は $ A_1\ =\ 10 $ である。 - 曜日 $ 2 $ ... 「休日」であるので、この曜日の生産量は $ 0 $ である。 - 曜日 $ 3 $ ... $ x=1,y=1 $ なので、この曜日の生産量は $ A_1\ =\ 10 $ である。 - 曜日 $ 4 $ ... 「休日」であるので、この曜日の生産量は $ 0 $ である。 - 曜日 $ 5 $ ... $ x=1,y=4 $ なので、この曜日の生産量は $ A_1\ =\ 10 $ である。 - 曜日 $ 6 $ ... $ x=2,y=3 $ なので、この曜日の生産量は $ A_2\ =\ 10 $ である。 - 曜日 $ 7 $ ... $ x=3,y=2 $ なので、この曜日の生産量は $ A_2\ =\ 10 $ である。 一週間当たりの生産量を $ 51 $ 以上にすることはできません。

## 样例 #1

### 输入

```
7

10 10 1 1 1 1 1
```

### 输出

```
50
```

## 样例 #2

### 输入

```
10

200000000 500000000 1000000000 800000000 100000000 80000000 600000 900000000 1 20
```

### 输出

```
5100000000
```

## 样例 #3

### 输入

```
20

38 7719 21238 2437 8855 11797 8365 32285 10450 30612 5853 28100 1142 281 20537 15921 8945 26285 2997 14680
```

### 输出

```
236980
```



---

---
title: "[ABC287Ex] Directed Graph and Query"
layout: "post"
diff: 普及+/提高
pid: AT_abc287_h
tag: []
---

# [ABC287Ex] Directed Graph and Query

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc287/tasks/abc287_h

$ N $ 頂点 $ M $ 辺の有向グラフがあります。頂点には $ 1 $ から $ N $ までの番号が付いており、$ i $ 番目の有向辺は頂点 $ a_i $ から頂点 $ b_i $ へと結ばれています。

また、このグラフ上の経路について、コストを次のように定めます。

- 経路上の頂点(始点・終点を含む)の番号の最大値
 
$ x=1,2,\ldots,Q $ に対して次の問題を解いてください。

- 頂点 $ s_x $ から頂点 $ t_x $ への経路のコストの最小値を求めよ。ただし、そのような経路が一つも存在しない場合は代わりに `-1` と出力せよ。
 
なお、入力の量が多くなる場合があるので、高速な方法で入出力を行うことを推奨します。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ M $ $ a_1 $ $ b_1 $ $ \vdots $ $ a_M $ $ b_M $ $ Q $ $ s_1 $ $ t_1 $ $ \vdots $ $ s_Q $ $ t_Q $

## 输出格式

$ Q $ 行出力せよ。  
 $ i $ 行目には $ x=i $ に対する出力をせよ。

## 说明/提示

### 制約

- $ 2\ \leq\ N\ \leq\ 2000 $
- $ 0\ \leq\ M\ \leq\ N(N-1) $
- $ 1\ \leq\ a_i,b_i\ \leq\ N $
- $ a_i\ \neq\ b_i $
- $ i\ \neq\ j $ ならば $ (a_i,b_i)\ \neq\ (a_j,b_j) $
- $ 1\ \leq\ Q\ \leq\ 10^4 $
- $ 1\ \leq\ s_i,t_i\ \leq\ N $
- $ s_i\ \neq\ t_i $
- 入力はすべて整数
 
### Sample Explanation 1

$ x=1 $ に対しては、$ 1 $ 番目の辺を通って頂点 $ 1 $ から頂点 $ 2 $ へ行く経路のコストが $ 2 $ であり、これが最小です。 $ x=2 $ に対しては、$ 2 $ 番目の辺を通って頂点 $ 2 $ から頂点 $ 3 $ へ、そして $ 3 $ 番目の辺を通って頂点 $ 3 $ から頂点 $ 1 $ へ行く経路のコストが $ 3 $ であり、これが最小です。 $ x=3 $ に対しては、頂点 $ 1 $ から頂点 $ 4 $ への経路が存在しないため `-1` と出力します。

## 样例 #1

### 输入

```
4 4

1 2

2 3

3 1

4 3

3

1 2

2 1

1 4
```

### 输出

```
2

3

-1
```



---

---
title: "[ABC288D] Range Add Query"
layout: "post"
diff: 普及+/提高
pid: AT_abc288_d
tag: []
---

# [ABC288D] Range Add Query

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc288/tasks/abc288_d

長さ $ N $ の整数列 $ A\ =\ (A_1,\ A_2,\ \ldots,\ A_N) $ と正整数 $ K $ が与えられます。

各 $ i\ =\ 1,\ 2,\ \ldots,\ Q $ について、$ A $ の連続部分列 $ (A_{l_i},\ A_{l_i+1},\ \ldots,\ A_{r_i}) $ が**良い数列**かどうかを判定してください。

ここで、長さ $ n $ の数列 $ X\ =\ (X_1,\ X_2,\ \ldots,\ X_n) $ は、下記の操作を好きな回数（ $ 0 $ 回でも良い）だけ行うことによって、$ X $ のすべての要素を $ 0 $ にすることができるとき、かつ、そのときに限り**良い数列**です。

> $ 1\ \leq\ i\ \leq\ n-K+1 $ を満たす整数 $ i $ および、整数 $ c $ （負の数でも良い）を選び、$ K $ 個の要素 $ X_{i},\ X_{i+1},\ \ldots,\ X_{i+K-1} $ のそれぞれに $ c $ を加算する。

なお、すべての $ i\ =\ 1,\ 2,\ \ldots,\ Q $ について、$ r_i\ -\ l_i\ +\ 1\ \geq\ K $ が保証されます。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ K $ $ A_1 $ $ A_2 $ $ \ldots $ $ A_N $ $ Q $ $ l_1 $ $ r_1 $ $ l_2 $ $ r_2 $ $ \vdots $ $ l_Q $ $ r_Q $

## 输出格式

$ Q $ 行出力せよ。 $ i\ =\ 1,\ 2,\ \ldots,\ Q $ について、$ i $ 行目には数列 $ (A_{l_i},\ A_{l_i+1},\ \ldots,\ A_{r_i}) $ が良い数列である場合は `Yes` を、 そうでない場合は `No` を出力せよ。

## 说明/提示

### 制約

- $ 1\ \leq\ N\ \leq\ 2\ \times\ 10^5 $
- $ 1\ \leq\ K\ \leq\ \min\lbrace\ 10,\ N\ \rbrace $
- $ -10^9\ \leq\ A_i\ \leq\ 10^9 $
- $ 1\ \leq\ Q\ \leq\ 2\ \times\ 10^5 $
- $ 1\ \leq\ l_i,\ r_i\ \leq\ N $
- $ r_i-l_i+1\ \geq\ K $
- 入力はすべて整数
 
### Sample Explanation 1

数列 $ X\ \coloneqq\ (A_1,\ A_2,\ A_3,\ A_4,\ A_5,\ A_6)\ =\ (3,\ -1,\ 1,\ -2,\ 2,\ 0) $ は良い数列です。 実際、下記の手順で操作を行うことで、すべての要素を $ 0 $ にすることができます。 - まず、$ i\ =\ 2,\ c\ =\ 4 $ として操作を行う。その結果、$ X\ =\ (3,\ 3,\ 5,\ 2,\ 2,\ 0) $ となる。 - 次に、$ i\ =\ 3,\ c\ =\ -2 $ として操作を行う。その結果、$ X\ =\ (3,\ 3,\ 3,\ 0,\ 0,\ 0) $ となる。 - 最後に、$ i\ =\ 1,\ c\ =\ -3 $ として操作を行う。その結果、$ X\ =\ (0,\ 0,\ 0,\ 0,\ 0,\ 0) $ となる。 よって、$ 1 $ 行目には `Yes` を出力します。 一方、数列 $ (A_2,\ A_3,\ A_4,\ A_5,\ A_6,\ A_7)\ =\ (-1,\ 1,\ -2,\ 2,\ 0,\ 5) $ は、 どのような手順で操作を行ってもすべての要素を $ 0 $ にすることはできないため、良い数列ではありません。 よって、$ 2 $ 行目には `No` を出力します。

## 样例 #1

### 输入

```
7 3

3 -1 1 -2 2 0 5

2

1 6

2 7
```

### 输出

```
Yes

No
```

## 样例 #2

### 输入

```
20 4

-19 -66 -99 16 18 33 32 28 26 11 12 0 -16 4 21 21 37 17 55 -19

5

13 16

4 11

3 12

13 18

4 10
```

### 输出

```
No

Yes

No

Yes

No
```



---

---
title: "[ABC288F] Integer Division"
layout: "post"
diff: 普及+/提高
pid: AT_abc288_f
tag: []
---

# [ABC288F] Integer Division

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc288/tasks/abc288_f

$ 10 $ 進表記で $ N $ 桁の正整数 $ X $ が与えられます。$ X $ の各桁は $ 0 $ ではありません。  
$ \lbrace\ 1,2,\ \ldots,\ N-1\ \rbrace $ の部分集合 $ S $ に対し、$ f(S) $ を以下のように定義します。

> $ X $ を $ 10 $ 進表記したものを長さ $ N $ の文字列とみなし、$ i\ \in\ S $ のとき、またそのときに限り文字列の $ i $ 文字目と $ i\ +\ 1 $ 文字目に区切りを入れることで $ |S|\ +\ 1 $ 個の文字列に分解する。  
> このようにして得られた $ |S|+1 $ 個の文字列を $ 10 $ 進表記された整数とみなし、$ f(S) $ をこれら $ |S|+1 $ 個の整数の積で定める。

$ S $ としてあり得るものは空集合を含めて $ 2^{N-1} $ 通りありますが、これら全てに対する $ f(S) $ の総和を $ 998244353 $ で割った余りを求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ X $

## 输出格式

答えを出力せよ。

## 说明/提示

### 制約

- $ 2\ \leq\ N\ \leq\ 2\ \times\ 10^5 $
- $ X $ は $ 10 $ 進表記で $ N $ 桁で、各桁は $ 0 $ でない
- 入力はすべて整数

### Sample Explanation 1

$ S\ =\ \emptyset $ とすると、$ f(S)\ =\ 234 $ です。 $ S\ =\ \lbrace\ 1\ \rbrace $ とすると、$ f(S)\ =\ 2\ \times\ 34\ =\ 68 $ です。 $ S\ =\ \lbrace\ 2\ \rbrace $ とすると、$ f(S)\ =\ 23\ \times\ 4\ =\ 92 $ です。 $ S\ =\ \lbrace\ 1,\ 2\ \rbrace $ とすると、$ f(S)\ =\ 2\ \times\ 3\ \times\ 4\ =\ 24 $ です。 $ 234\ +\ 68\ +\ 92\ +\ 24\ =\ 418 $ であるため、$ 418 $ を出力します。

## 样例 #1

### 输入

```
3
234
```

### 输出

```
418
```

## 样例 #2

### 输入

```
4
5915
```

### 输出

```
17800
```

## 样例 #3

### 输入

```
9
998244353
```

### 输出

```
258280134
```



---

---
title: "[ABC290E] Make it Palindrome"
layout: "post"
diff: 普及+/提高
pid: AT_abc290_e
tag: []
---

# [ABC290E] Make it Palindrome

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc290/tasks/abc290_e

数列 $ X $ に対し、 $ f(X)\ = $ ( $ X $ を回文にするために変更する必要のある要素の個数の最小値 ) とします。

与えられた長さ $ N $ の数列 $ A $ の全ての **連続** 部分列 $ X $ に対する $ f(X) $ の総和を求めてください。

但し、長さ $ m $ の数列 $ X $ が回文であるとは、全ての $ 1\ \le\ i\ \le\ m $ を満たす整数 $ i $ について、 $ X $ の $ i $ 項目と $ m+1-i $ 項目が等しいことを指します。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ A_1 $ $ A_2 $ $ \dots $ $ A_N $

## 输出格式

答えを整数として出力せよ。

## 说明/提示

### 制約

- 入力は全て整数
- $ 1\ \le\ N\ \le\ 2\ \times\ 10^5 $
- $ 1\ \le\ A_i\ \le\ N $
 
### Sample Explanation 1

\- $ f(5)\ =\ 0 $ - $ f(2)\ =\ 0 $ - $ f(1)\ =\ 0 $ - $ f(2)\ =\ 0 $ - $ f(2)\ =\ 0 $ - $ f(5,2)\ =\ 1 $ - $ f(2,1)\ =\ 1 $ - $ f(1,2)\ =\ 1 $ - $ f(2,2)\ =\ 0 $ - $ f(5,2,1)\ =\ 1 $ - $ f(2,1,2)\ =\ 0 $ - $ f(1,2,2)\ =\ 1 $ - $ f(5,2,1,2)\ =\ 2 $ - $ f(2,1,2,2)\ =\ 1 $ - $ f(5,2,1,2,2)\ =\ 1 $ 以上より、求める答えは $ 9 $ です。

## 样例 #1

### 输入

```
5

5 2 1 2 2
```

### 输出

```
9
```



---

---
title: "[ABC291F] Teleporter and Closed off"
layout: "post"
diff: 普及+/提高
pid: AT_abc291_f
tag: []
---

# [ABC291F] Teleporter and Closed off

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc291/tasks/abc291_f

$ N $ 個の都市があり、都市 $ 1 $, 都市 $ 2 $, $ \ldots $, 都市 $ N $ と番号づけられています。  
いくつかの異なる都市の間は一方通行のテレポーターによって移動できます。 都市 $ i $ $ (1\leq\ i\leq\ N) $ からテレポーターによって直接移動できる都市は `0` と `1` からなる長さ $ M $ の文字列 $ S_i $ によって表されます。具体的には、$ 1\leq\ j\leq\ N $ に対して、

- $ 1\leq\ j-i\leq\ M $ かつ $ S_i $ の $ (j-i) $ 文字目が `1` ならば、都市 $ i $ から都市 $ j $ に直接移動できる。
- そうでない時、都市 $ i $ から都市 $ j $ へは直接移動できない。

$ k=2,3,\ldots,\ N-1 $ に対して次の問題を解いてください。

> テレポータを繰り返し使用することによって、**都市 $ k $ を通らずに**都市 $ 1 $ から 都市 $ N $ へ移動できるか判定し、 できるならばそのために必要なテレポーターの使用回数の最小値を、 できないならば $ -1 $ を出力せよ。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ M $ $ S_1 $ $ S_2 $ $ \vdots $ $ S_N $

## 输出格式

$ N-2 $ 個の整数を空白区切りで一行に出力せよ。 $ i $ $ (1\leq\ i\leq\ N-2) $ 番目には、$ k=i+1 $ に対する問題の答えを出力せよ。

## 说明/提示

### 制約

- $ 3\ \leq\ N\ \leq\ 10^5 $
- $ 1\leq\ M\leq\ 10 $
- $ M\ <\ N $
- $ S_i $ は `0` と `1` のみからなる長さ $ M $ の文字列
- $ i+j\ >\ N $ ならば $ S_i $ の $ j $ 文字目は `0`
- $ N,M $ は整数

### Sample Explanation 1

テレポータによって各都市からはそれぞれ以下の都市へ直接移動する事ができます。 - 都市 $ 1 $ からは都市 $ 2,3 $ へ移動できる。 - 都市 $ 2 $ からは都市 $ 4 $ へ移動できる。 - 都市 $ 3 $ からは都市 $ 4,5 $ へ移動できる。 - 都市 $ 4 $ からは都市 $ 5 $ へ移動できる。 - 都市 $ 5 $ から移動できる都市は存在しない。 よって、都市 $ 1 $ から都市 $ 5 $ へ移動する方法は、 - 経路 $ 1 $ : 都市 $ 1 $ $ \to $ 都市 $ 2 $ $ \to $ 都市 $ 4 $ $ \to $ 都市 $ 5 $ - 経路 $ 2 $ : 都市 $ 1 $ $ \to $ 都市 $ 3 $ $ \to $ 都市 $ 4 $ $ \to $ 都市 $ 5 $ - 経路 $ 3 $ : 都市 $ 1 $ $ \to $ 都市 $ 3 $ $ \to $ 都市 $ 5 $ の $ 3 $ つがあり、 - 都市 $ 2 $ を通らない経路は経路 $ 2 $, 経路 $ 3 $ の $ 2 $つであり、そのうちテレポーターの使用回数が最小となるのは経路 $ 3 $ で、この時 $ 2 $ 回使用する。 - 都市 $ 3 $ を通らない経路は経路 $ 1 $ のみであり、この時テレポーターは $ 3 $ 回使用する。 - 都市 $ 4 $ を通らない経路は経路 $ 3 $ のみであり、この時テレポーターは $ 2 $ 回使用する。 となります。よって、$ 2,3,2 $ をこの順に空白区切りで出力します。

### Sample Explanation 2

都市 $ 1 $ から都市 $ 6 $ へ移動する方法は、都市 $ 1 $ $ \to $ 都市 $ 2 $ $ \to $ 都市 $ 5 $ $ \to $ 都市 $ 6 $ のみであるため、 $ k=2,5 $ の場合には都市 $ k $ を通らずに都市 $ 1 $ から都市 $ 6 $ へ移動する方法は存在せず、 $ k=3,4 $ の場合には上の方法が条件をみたし、テレポーターを $ 3 $ 回使用します。 よって、$ -1,3,3,-1 $ をこの順に空白区切りで出力します。 テレポーターは一方通行であるため、 都市 $ 3 $ から都市 $ 4 $ へはテレポーターによって移動できますが、 都市 $ 4 $ から都市 $ 3 $ へは移動できず、 都市 $ 1 $ $ \to $ 都市 $ 4 $ $ \to $ 都市 $ 3 $ $ \to $ 都市 $ 6 $ のような移動はできない事に注意してください。

## 样例 #1

### 输入

```
5 2
11
01
11
10
00
```

### 输出

```
2 3 2
```

## 样例 #2

### 输入

```
6 3
101
001
101
000
100
000
```

### 输出

```
-1 3 3 -1
```



---

---
title: "[ABC292F] Regular Triangle Inside a Rectangle"
layout: "post"
diff: 普及+/提高
pid: AT_abc292_f
tag: []
---

# [ABC292F] Regular Triangle Inside a Rectangle

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc292/tasks/abc292_f

縦の長さが $ A $、横の長さが $ B $ の長方形の内部に描ける正三角形の一辺の長さの最大値を求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ A $ $ B $

## 输出格式

答えを出力せよ。  
 なお、真の値との絶対誤差または相対誤差が $ 10^{-9} $ 以下であれば正解として扱われる。

## 说明/提示

### 制約

- $ 1\ \leq\ A,B\ \leq\ 1000 $
- $ A,B $ は整数
 
### Sample Explanation 1

下図のように描くのが最適で、一辺の長さが $ \sqrt{6}\ -\ \sqrt{2} $ になります。 ![image](https://img.atcoder.jp/abc292/2cd44ddc3d8241e510a356be9533631f.png) なお、この出力例の値は $ \sqrt{6}-\ \sqrt{2} $ と厳密には一致しませんが、誤差が $ 10^{-9} $ 以下なので正解として扱われます。

## 样例 #1

### 输入

```
1 1
```

### 输出

```
1.03527618041008295791
```



---

---
title: "[ABC293E] Geometric Progression"
layout: "post"
diff: 普及+/提高
pid: AT_abc293_e
tag: []
---

# [ABC293E] Geometric Progression

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc293/tasks/abc293_e

整数 $ A,\ X,\ M $ が与えられます。$ \displaystyle\ \sum_{i\ =\ 0}^{X-1}\ A^i $ を $ M $ で割った余りを求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ A $ $ X $ $ M $

## 输出格式

答えを出力せよ。

## 说明/提示

### 制約

- $ 1\ \leq\ A,\ M\ \leq\ 10^9 $
- $ 1\ \leq\ X\ \leq\ 10^{12} $
- 入力はすべて整数

### Sample Explanation 1

$ 3^0\ +\ 3^1\ +\ 3^2\ +\ 3^3\ =\ 40 $ です。$ 40 $ を $ 7 $ で割った余りは $ 5 $ であるため、$ 5 $ を出力します。

## 样例 #1

### 输入

```
3 4 7
```

### 输出

```
5
```

## 样例 #2

### 输入

```
8 10 9
```

### 输出

```
0
```

## 样例 #3

### 输入

```
1000000000 1000000000000 998244353
```

### 输出

```
919667211
```



---

---
title: "[ABC294F] Sugar Water 2"
layout: "post"
diff: 普及+/提高
pid: AT_abc294_f
tag: []
---

# [ABC294F] Sugar Water 2

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc294/tasks/abc294_f

高橋君は $ N $ 本の砂糖水を、青木君は $ M $ 本の砂糖水を持っています。  
 高橋君の持っている $ i $ 番目の砂糖水は砂糖 $ A_i $ グラムと水 $ B_i $ グラムからなります。  
 青木君の持っている $ i $ 番目の砂糖水は砂糖 $ C_i $ グラムと水 $ D_i $ グラムからなります。  
 2 人の持つ砂糖水をそれぞれ 1 本ずつ選んで混ぜる方法は $ NM $ 通りあります。そのような方法でできる砂糖水の中で、濃度が高い方から $ K $ 番目の砂糖水の濃度が何 $ \% $ であるかを求めてください。  
 ここで、砂糖 $ x $ グラムと水 $ y $ グラムからなる砂糖水の濃度は $ \dfrac{100x}{x+y}\ \% $ です。また、砂糖が溶け残ることは考えないものとします。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ M $ $ K $ $ A_1 $ $ B_1 $ $ A_2 $ $ B_2 $ $ \vdots $ $ A_N $ $ B_N $ $ C_1 $ $ D_1 $ $ C_2 $ $ D_2 $ $ \vdots $ $ C_M $ $ D_M $

## 输出格式

濃度が高い方から $ K $ 番目の砂糖水の濃度をパーセントで出力せよ。  
 なお、真の値との絶対誤差または相対誤差が $ 10^{−9} $ 以下であれば正解として扱われる。

## 说明/提示

### 制約

- $ 1\ \leq\ N,\ M\ \leq\ 5\ \times\ 10^4 $
- $ 1\ \leq\ K\ \leq\ N\ \times\ M $
- $ 1\ \leq\ A_i,\ B_i,\ C_i,\ D_i\ \leq\ 10^5 $
- 入力される値はすべて整数
 
### Sample Explanation 1

以下では高橋君が持っている $ i $ 番目の砂糖水と青木君が持っている $ j $ 番目の砂糖水を混ぜてできる砂糖水を $ (i,\ j) $ と表します。 あり得る砂糖水の混ぜ方とその濃度を列挙すると以下のようになります。 - $ (1,\ 1) $ : $ 100\ \times\ \frac{1\ +\ 1}{(1\ +\ 1)\ +\ (2\ +\ 4)}\ =\ 25\ \% $ - $ (2,\ 1) $ : $ 100\ \times\ \frac{1\ +\ 4}{(4\ +\ 1)\ +\ (1\ +\ 4)}\ =\ 50\ \% $ - $ (3,\ 1) $ : $ 100\ \times\ \frac{1\ +\ 1}{(1\ +\ 1)\ +\ (4\ +\ 4)}\ =\ 20\ \% $ この中で濃度が高い方から $ 1 $ 番目の砂糖水は $ (2,\ 1) $ で、濃度は $ 50\ \% $ です。

## 样例 #1

### 输入

```
3 1 1

1 2

4 1

1 4

1 4
```

### 输出

```
50.000000000000000
```

## 样例 #2

### 输入

```
2 2 2

6 4

10 1

5 8

9 6
```

### 输出

```
62.500000000000000
```

## 样例 #3

### 输入

```
4 5 10

5 4

1 6

7 4

9 8

2 2

5 6

6 7

5 3

8 1
```

### 输出

```
54.166666666666664
```



---

---
title: "[ABC294G] Distance Queries on a Tree"
layout: "post"
diff: 普及+/提高
pid: AT_abc294_g
tag: []
---

# [ABC294G] Distance Queries on a Tree

## 题目描述

给定一颗有 $n$ 个节点的树，带边权，要进行 $Q$ 次操作，操作有两种：

`1 i w`：将第 $i$ 条边的边权改为 $w$。  
`2 u v`：询问 $u,v$ 两点的距离。

## 输入格式

第一行，一个正整数 $n$。  
接下来 $n-1$ 行，每行三个数 $u,v,w$，表示一条树边。  
接下来一个正整数 $Q$。  
接下来 $Q$ 行，每行三个数，描述一个询问，格式如上。

## 输出格式

对于每个 $2$ 操作，输出一行一个数，表示该询问的答案。

## 说明/提示

$1\le n,Q\le 2\times10^5，1\le w_i\le 10^9$

## 样例 #1

### 输入

```
5
1 2 3
1 3 6
1 4 9
4 5 10
4
2 2 3
2 1 5
1 3 1
2 1 5
```

### 输出

```
9
19
11
```

## 样例 #2

### 输入

```
7
1 2 1000000000
2 3 1000000000
3 4 1000000000
4 5 1000000000
5 6 1000000000
6 7 1000000000
3
2 1 6
1 1 294967296
2 1 6
```

### 输出

```
5000000000
4294967296
```

## 样例 #3

### 输入

```
1
1
2 1 1
```

### 输出

```
0
```

## 样例 #4

### 输入

```
8
1 2 105
1 3 103
2 4 105
2 5 100
5 6 101
3 7 106
3 8 100
18
2 2 8
2 3 6
1 4 108
2 3 4
2 3 5
2 5 5
2 3 1
2 4 3
1 1 107
2 3 1
2 7 6
2 3 8
2 1 5
2 7 6
2 4 7
2 1 7
2 5 3
2 8 6
```

### 输出

```
308
409
313
316
0
103
313
103
525
100
215
525
421
209
318
519
```



---

---
title: "[ABC296F] Simultaneous Swap"
layout: "post"
diff: 普及+/提高
pid: AT_abc296_f
tag: []
---

# [ABC296F] Simultaneous Swap

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc296/tasks/abc296_f

長さ $ N $ の数列 $ A=(A_1,A_2,\ldots,A_N) $, $ B=(B_1,B_2,\ldots,B_N) $ が与えられます。

高橋君は次の操作を好きなだけ ($ 0 $ 回でも良い) 繰り返す事ができます。

> $ 1 $ 以上 $ N $ 以下の、どの $ 2 $ つも互いに相異なる $ 3 $ つの整数 $ i,j,k $ を選ぶ。  
>  $ A $ の $ i $ 番目の要素と $ j $ 番目の要素を交換し、$ B $ の $ i $ 番目の要素と $ k $ 番目の要素を交換する。

高橋君がうまく操作を繰り返すことによって、 $ A $ と $ B $ を一致させる事が可能ならば `Yes` を、不可能ならば `No` を出力してください。  
 ただし、$ A $ と $ B $ が一致しているとは、任意の $ 1\leq\ i\leq\ N $ について $ A $ の $ i $ 番目の要素と $ B $ の $ i $ 番目の要素が等しいことを言います。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ A_1 $ $ A_2 $ $ \ldots $ $ A_N $ $ B_1 $ $ B_2 $ $ \ldots $ $ B_N $

## 输出格式

操作を繰り返すことによって、高橋君が $ A $ と $ B $ を一致させる事が可能ならば `Yes` を、不可能ならば `No` を出力せよ。

## 说明/提示

### 制約

- $ 3\ \leq\ N\ \leq\ 2\times\ 10^5 $
- $ 1\leq\ A_i,B_i\leq\ N $
- 入力はすべて整数
 
### Sample Explanation 1

$ (i,j,k)=(1,2,3) $ として $ 1 $ 回操作を行うことで、$ A_1 $ と $ A_2 $、$ B_1 $ と $ B_3 $ がそれぞれ交換され、 $ A,B $ はともに $ (2,1,1) $ となって一致します。よって、`Yes` を出力します。

### Sample Explanation 2

どのように操作を行っても $ A $ と $ B $ を一致させることはできません。よって、`No` を出力します。

## 样例 #1

### 输入

```
3

1 2 1

1 1 2
```

### 输出

```
Yes
```

## 样例 #2

### 输入

```
3

1 2 2

1 1 2
```

### 输出

```
No
```

## 样例 #3

### 输入

```
5

1 2 3 2 1

3 2 2 1 1
```

### 输出

```
Yes
```

## 样例 #4

### 输入

```
8

1 2 3 4 5 6 7 8

7 8 5 6 4 3 1 2
```

### 输出

```
No
```



---

---
title: "[ABC297G] Constrained Nim 2"
layout: "post"
diff: 普及+/提高
pid: AT_abc297_g
tag: []
---

# [ABC297G] Constrained Nim 2

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc297/tasks/abc297_g

$ N $ 個の石の山があり、はじめ $ i $ 番目の山には石が $ A_i $ 個あります。これらの山を使って先手太郎君と後手次郎君でゲームをします。

先手太郎君と後手次郎君は、先手太郎君が先手で交互に以下の操作を行います。

- 石の山を一つ選び、そこから $ L $ 個以上 $ R $ 個以下の石を取り除く。

操作が行えなくなった方が負けで、負けなかった方が勝ちです。両者が勝ちを目指して最適な行動を取るとき、どちらが勝つか判定してください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ L $ $ R $ $ A_1 $ $ A_2 $ $ \ldots $ $ A_N $

## 输出格式

先手太郎君が勝つ場合 `First` を、後手次郎君が勝つ場合 `Second` を出力せよ。

## 说明/提示

### 制約

- $ 1\leq\ N\ \leq\ 2\times\ 10^5 $
- $ 1\leq\ L\ \leq\ R\ \leq\ 10^9 $
- $ 1\leq\ A_i\ \leq\ 10^9 $
- 入力はすべて整数である。

### Sample Explanation 1

先手太郎君が最初に $ 1 $ 番目の山の石を $ 2 $ 個取り除くことで、必ず勝つことができます。

## 样例 #1

### 输入

```
3 1 2
2 3 3
```

### 输出

```
First
```

## 样例 #2

### 输入

```
5 1 1
3 1 4 1 5
```

### 输出

```
Second
```

## 样例 #3

### 输入

```
7 3 14
10 20 30 40 50 60 70
```

### 输出

```
First
```



---

---
title: "[ABC298E] Unfair Sugoroku"
layout: "post"
diff: 普及+/提高
pid: AT_abc298_e
tag: []
---

# [ABC298E] Unfair Sugoroku

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc298/tasks/abc298_e

高橋君と青木君がすごろくをします。  
 高橋君ははじめ地点 $ A $、青木君ははじめ地点 $ B $ にいて、交互にサイコロを振ります。  
 高橋君が振るサイコロは $ 1,\ 2,\ \ldots,\ P $ の出目が一様ランダムに出るサイコロで、青木君が振るサイコロは $ 1,\ 2,\ \ldots,\ Q $ の出目が一様ランダムに出るサイコロです。  
 地点 $ x $ にいるときに自分の振ったサイコロの出目が $ i $ であるとき、地点 $ \min(x\ +\ i,\ N) $ に進みます。  
 地点 $ N $ に先に着いた人をすごろくの勝者とします。  
 高橋君が先にサイコロを振るとき、高橋君が勝つ確率を $ \text{mod\ }998244353 $ で求めてください。

 確率 $ \text{mod\ }998244353 $ とは この問題で求める確率は必ず有理数になることが証明できます。また、この問題の制約下では、求める確率を既約分数 $ \frac{y}{x} $ で表したときに $ x $ が $ 998244353 $ で割り切れないことが保証されます。  
 このとき $ xz\ \equiv\ y\ \pmod\ {998244353} $ を満たすような $ 0 $ 以上 $ 998244352 $ 以下の整数 $ z $ が一意に定まります。この $ z $ を答えてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ A $ $ B $ $ P $ $ Q $

## 输出格式

答えを出力せよ。

## 说明/提示

### 制約

- $ 2\ \leq\ N\ \leq\ 100 $
- $ 1\ \leq\ A,\ B\ <\ N $
- $ 1\ \leq\ P,\ Q\ \leq\ 10 $
- 入力はすべて整数
 
### Sample Explanation 1

高橋君が最初の手番で $ 2 $ あるいは $ 3 $ の出目を出すと、高橋君は地点 $ 4 $ に進んで高橋君が勝利します。 高橋君が最初の手番で $ 1 $ の出目を出すと、高橋君は地点 $ 3 $ に進み、青木君は次の手番で必ず地点 $ 4 $ に進んで青木君が勝利します。 よって、高橋君が勝つ確率は $ \frac{2}{3} $ です。

### Sample Explanation 2

サイコロの出目は常に $ 1 $ です。 このとき高橋君が地点 $ 5 $ に進み、次いで青木君が地点 $ 3 $ に進み、次いで高橋君が地点 $ 6 $ に進むので、高橋君は必ず勝ちます。

## 样例 #1

### 输入

```
4 2 3 3 2
```

### 输出

```
665496236
```

## 样例 #2

### 输入

```
6 4 2 1 1
```

### 输出

```
1
```

## 样例 #3

### 输入

```
100 1 1 10 10
```

### 输出

```
264077814
```



---

---
title: "[ABC298F] Rook Score"
layout: "post"
diff: 普及+/提高
pid: AT_abc298_f
tag: []
---

# [ABC298F] Rook Score

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc298/tasks/abc298_f

縦 $ 10^9 $ マス、横 $ 10^9 $ マスのマス目があります。上から $ i $ 番目、左から $ j $ 番目のマスを $ (i,j) $ と表記します。

$ i=1,2,\ldots,N $ に対し $ (r_i,c_i) $ には正整数 $ x_i $ が、他の $ 10^{18}-N $ 個のマスには $ 0 $ が書かれています。

あなたはあるマス $ (R,C) $ を選び、 $ (R,C) $ と行または列が同じ $ 2\ \times\ 10^9\ -\ 1 $ 個のマスに書かれた整数の総和 $ S $ を求めました。

$ S $ として考えられる最大値を求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ r_1 $ $ c_1 $ $ x_1 $ $ \vdots $ $ r_N $ $ c_N $ $ x_N $

## 输出格式

答えを出力せよ。

## 说明/提示

### 制約

- $ 1\ \leq\ N\ \leq\ 2\ \times\ 10^5 $
- $ 1\ \leq\ r_i,c_i,x_i\ \leq\ 10^9 $
- $ i\ \neq\ j $ ならば $ (r_i,c_i)\ \neq\ (r_j,c_j) $
- 入力はすべて整数

### Sample Explanation 1

$ (R,C) $ として $ (2,2) $ を選ぶと $ S $ が $ 20 $ となります。これが最大値です。

## 样例 #1

### 输入

```
4
1 1 2
1 2 9
2 1 8
3 2 3
```

### 输出

```
20
```

## 样例 #2

### 输入

```
1
1 1000000000 1
```

### 输出

```
1
```

## 样例 #3

### 输入

```
15
158260522 877914575 602436426
24979445 861648772 623690081
433933447 476190629 262703497
211047202 971407775 628894325
731963982 822804784 450968417
430302156 982631932 161735902
880895728 923078537 707723857
189330739 910286918 802329211
404539679 303238506 317063340
492686568 773361868 125660016
650287940 839296263 462224593
492601449 384836991 191890310
576823355 782177068 404011431
818008580 954291757 160449218
155374934 840594328 164163676
```

### 输出

```
1510053068
```



---

---
title: "[ABC300E] Dice Product 3"
layout: "post"
diff: 普及+/提高
pid: AT_abc300_e
tag: []
---

# [ABC300E] Dice Product 3

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc300/tasks/abc300_e

あなたは $ 1 $ 以上 $ 6 $ 以下の整数が等確率で出るサイコロと整数 $ 1 $ を持っています。  
 あなたは持っている整数が $ N $ 未満である間、次の操作を繰り返します。

- サイコロを振り、出た目を $ x $ とする。持っている整数に $ x $ を掛ける。
 
全ての操作を終了した時に、持っている整数が $ N $ に一致する確率を $ \text{mod\ }998244353 $ で求めてください。

   確率 $ \text{mod\ }998244353 $ とは？ 求める確率は必ず有理数となることが証明できます。 またこの問題の制約下では、その値を互いに素な $ 2 $ つの整数 $ P $, $ Q $ を用いて $ \frac{P}{Q} $ と表したとき、$ R\ \times\ Q\ \equiv\ P\pmod{998244353} $ かつ $ 0\ \leq\ R\ \lt\ 998244353 $ を満たす整数 $ R $ がただ一つ存在することが証明できます。この $ R $ を求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $

## 输出格式

全ての操作を終了した時に、持っている整数が $ N $ に一致する確率を $ \text{mod\ }998244353 $ で出力せよ。

## 说明/提示

### 制約

- $ 2\ \leq\ N\ \leq\ 10^{18} $
- $ N $ は整数
 
### Sample Explanation 1

操作が終了するまでの手順としてあり得る一例を挙げると次のようになります。 - はじめ, 持っている整数は $ 1 $ である。 - サイコロを振り, $ 2 $ が出る。持っている整数は $ 1\ \times\ 2\ =\ 2 $ になる。 - サイコロを振り, $ 4 $ が出る。持っている整数は $ 2\ \times\ 4\ =\ 8 $ になる。 - 持っている整数が $ 6 $ 以上になったので操作を終了する。 操作がこのように進んだ場合、操作後に持っている整数は $ 8 $ であり $ N\ =\ 6 $ に一致しません。 操作後に持っている整数が $ 6 $ である確率は $ \frac{7}{25} $ です。 $ 239578645\ \times\ 25\ \equiv\ 7\ \pmod{998244353} $ より、 $ 239578645 $ を出力してください。

### Sample Explanation 2

どのような目が出ても、操作後に持っている整数が $ 7 $ になることはありません。

## 样例 #1

### 输入

```
6
```

### 输出

```
239578645
```

## 样例 #2

### 输入

```
7
```

### 输出

```
0
```

## 样例 #3

### 输入

```
300
```

### 输出

```
183676961
```

## 样例 #4

### 输入

```
979552051200000000
```

### 输出

```
812376310
```



---

---
title: "[ABC300F] More Holidays"
layout: "post"
diff: 普及+/提高
pid: AT_abc300_f
tag: []
---

# [ABC300F] More Holidays

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc300/tasks/abc300_f

`o` と `x` からなる長さ $ N $ の文字列 $ S $ と、整数 $ M,K $ が与えられます。  
$ S $ には少なくとも $ 1 $ つの `x` が含まれることが保証されます。

$ S $ を $ M $ 個連結して得られる長さ $ NM $ の文字列を $ T $ とします。 $ T $ に含まれる `x` のうち丁度 $ K $ 個を選んで `o` に変えることを考えます。  
あなたの目標は、変更後の $ T $ に `o` のみからなるできるだけ長い連続部分文字列が含まれるようにすることです。  
`o` のみからなる連続部分文字列の長さとして達成可能な最大値を求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ M $ $ K $ $ S $

## 输出格式

答えを整数として出力せよ。

## 说明/提示

### 制約

- $ N,M,K $ は整数
- $ 1\ \le\ N\ \le\ 3\ \times\ 10^5 $
- $ 1\ \le\ M\ \le\ 10^9 $
- $ x $ を文字列 $ T $ に含まれる `x` の総数としたとき、 $ 1\ \le\ K\ \le\ x $
- $ S $ は `o` と `x` からなる長さ $ N $ の文字列
- $ S $ には少なくとも $ 1 $ つの `x` が含まれる

### Sample Explanation 1

$ S= $ `ooxxooooox` 、 $ T= $ `ooxxooooox` です。 $ 3 $ 文字目と $ 4 $ 文字目の `x` を `o` に変更することにより、変更後の $ T= $ `ooooooooox` となります。 このとき `o` のみからなる長さ $ 9 $ の連続部分文字列が得られ、これが達成可能な最大値です。

### Sample Explanation 2

$ S= $ `oxxox` 、 $ T= $ `oxxoxoxxoxoxxox` です。 $ 5,7,8,10 $ 文字目の `x` を `o` に変更することにより、変更後の $ T= $ `oxxooooooooxxox` となります。 このとき `o` のみからなる長さ $ 8 $ の連続部分文字列が得られ、これが達成可能な最大値です。

## 样例 #1

### 输入

```
10 1 2
ooxxooooox
```

### 输出

```
9
```

## 样例 #2

### 输入

```
5 3 4
oxxox
```

### 输出

```
8
```

## 样例 #3

### 输入

```
30 1000000000 9982443530
oxoxooxoxoxooxoxooxxxoxxxooxox
```

### 输出

```
19964887064
```



---

---
title: "[ABC302F] Merge Set"
layout: "post"
diff: 普及+/提高
pid: AT_abc302_f
tag: []
---

# [ABC302F] Merge Set

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc302/tasks/abc302_f

黒板に $ 1 $ 以上 $ M $ 以下の整数からなる集合 $ N $ 個 $ S_1,S_2,\dots,S_N $ が書かれています。ここで、$ S_i\ =\ \lbrace\ S_{i,1},S_{i,2},\dots,S_{i,A_i}\ \rbrace $ です。

あなたは、以下の操作を好きな回数（$ 0 $ 回でもよい）行うことが出来ます。

- $ 1 $ 個以上の共通した要素を持つ $ 2 $ 個の集合 $ X,Y $ を選ぶ。$ X,Y $ の $ 2 $ 個を黒板から消し、新たに $ X\cup\ Y $ を黒板に書く。
 
ここで、$ X\cup\ Y $ とは $ X $ か $ Y $ の少なくともどちらかに含まれている要素のみからなる集合を意味します。

$ 1 $ と $ M $ が両方含まれる集合を作ることが出来るか判定してください。出来るならば、必要な操作回数の最小値を求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ M $ $ A_1 $ $ S_{1,1} $ $ S_{1,2} $ $ \dots $ $ S_{1,A_1} $ $ A_2 $ $ S_{2,1} $ $ S_{2,2} $ $ \dots $ $ S_{2,A_2} $ $ \vdots $ $ A_N $ $ S_{N,1} $ $ S_{N,2} $ $ \dots $ $ S_{N,A_N} $

## 输出格式

$ 1 $ と $ M $ が両方含まれる集合を作ることが出来るならば必要な操作回数の最小値を、出来ないならば `-1` を出力せよ。

## 说明/提示

### 制約

- $ 1\ \le\ N\ \le\ 2\ \times\ 10^5 $
- $ 2\ \le\ M\ \le\ 2\ \times\ 10^5 $
- $ 1\ \le\ \sum_{i=1}^{N}\ A_i\ \le\ 5\ \times\ 10^5 $
- $ 1\ \le\ S_{i,j}\ \le\ M(1\ \le\ i\ \le\ N,1\ \le\ j\ \le\ A_i) $
- $ S_{i,j}\ \neq\ S_{i,k}(1\ \le\ j\ <\ k\ \le\ A_i) $
- 入力は全て整数である。
 
### Sample Explanation 1

まず、$ \lbrace\ 1,2\ \rbrace $ と $ \lbrace\ 2,3\ \rbrace $ を選んで消し、$ \lbrace\ 1,2,3\ \rbrace $ を追加します。 そして、$ \lbrace\ 1,2,3\ \rbrace $ と $ \lbrace\ 3,4,5\ \rbrace $ を選んで消し、$ \lbrace\ 1,2,3,4,5\ \rbrace $ を追加します。 すると $ 2 $ 回の操作で $ 1 $ と $ M $ を両方含む集合を作ることが出来ます。$ 1 $ 回の操作では目標を達成できないため、答えは $ 2 $ です。

### Sample Explanation 2

始めから $ S_1 $ が $ 1,M $ を共に含むため、必要な操作回数の最小値は $ 0 $ 回です。

## 样例 #1

### 输入

```
3 5

2

1 2

2

2 3

3

3 4 5
```

### 输出

```
2
```

## 样例 #2

### 输入

```
1 2

2

1 2
```

### 输出

```
0
```

## 样例 #3

### 输入

```
3 5

2

1 3

2

2 4

3

2 4 5
```

### 输出

```
-1
```

## 样例 #4

### 输入

```
4 8

3

1 3 5

2

1 2

3

2 4 7

4

4 6 7 8
```

### 输出

```
2
```



---

---
title: "[ABC302G] Sort from 1 to 4"
layout: "post"
diff: 普及+/提高
pid: AT_abc302_g
tag: []
---

# [ABC302G] Sort from 1 to 4

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc302/tasks/abc302_g

全ての要素が $ 1 $ 以上 $ 4 $ 以下の整数である、長さ $ N $ の数列 $ A=(A_1,A_2,\ldots,A_N) $ が与えられます。

高橋君は次の操作を何回でも ($ 0 $ 回でも良い) 繰り返し行う事ができます。

- $ 1\leq\ i\ <\ j\leq\ N $ をみたす整数の組 $ (i,j) $ を選び、$ A_i $ と $ A_j $ を交換する。
 
数列 $ A $ を広義単調増加にするために必要な操作回数の最小値を求めてください。  
 ただし、数列 $ A $ が広義単調増加であるとは、$ 1\leq\ i\leq\ N-1 $ をみたすすべての整数について $ A_i\leq\ A_{i+1} $ が成り立つことをさします。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ A_1 $ $ A_2 $ $ \ldots $ $ A_N $

## 输出格式

数列 $ A $ を広義単調増加にするために必要な操作回数の最小値を一行に出力せよ。

## 说明/提示

### 制約

- $ 2\ \leq\ N\ \leq\ 2\times\ 10^5 $
- $ 1\leq\ A_i\ \leq\ 4 $
- 入力はすべて整数
 
### Sample Explanation 1

次のようにして $ 3 $ 回の操作で $ A $ を広義単調増加にすることができます。 - $ (i,j)=(2,3) $ を選び、$ A_2 $ と $ A_3 $ を交換する。$ A=(3,1,4,1,2,4) $ となる。 - $ (i,j)=(1,4) $ を選び、$ A_1 $ と $ A_4 $ を交換する。$ A=(1,1,4,3,2,4) $ となる。 - $ (i,j)=(3,5) $ を選び、$ A_3 $ と $ A_5 $ を交換する。$ A=(1,1,2,3,4,4) $ となる。 $ 2 $ 回以下の操作で $ A $ を広義単調増加にすることはできないため、このとき操作回数が最小となります。 よって、$ 3 $ を出力します。

## 样例 #1

### 输入

```
6

3 4 1 1 2 4
```

### 输出

```
3
```

## 样例 #2

### 输入

```
4

2 3 4 1
```

### 输出

```
3
```



---

---
title: "[ABC305F] Dungeon Explore"
layout: "post"
diff: 普及+/提高
pid: AT_abc305_f
tag: []
---

# [ABC305F] Dungeon Explore

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc305/tasks/abc305_f

この問題は **インタラクティブな問題**（あなたが作成したプログラムとジャッジプログラムが標準入出力を介して対話を行う形式の問題）です。

$ N $ 個の頂点と $ M $ 本の辺からなる連結かつ単純な無向グラフがあります。 頂点には $ 1 $ から $ N $ までの整数の番号がついています。

あなたは、はじめ頂点 $ 1 $ にいます。 隣り合う頂点に移動することを最大 $ 2N $ 回まで繰り返して、頂点 $ N $ へ移動してください。

ただし、はじめはグラフの辺をすべて知ることはできず、今いる頂点と隣り合っている頂点の情報を知ることができます。

### Input &amp; Output Format

最初に、グラフの頂点数 $ N $ と辺数 $ M $ を標準入力から受け取ってください。

> $ N $ $ M $

次に、あなたはジャッジに対して問題文中の操作を $ 2N $ 回まで繰り返すことができます。

各操作のはじめには、あなたが現在いる頂点に隣接する頂点が次の形式で標準入力から与えられます。

> $ k $ $ v\ _\ 1 $ $ v\ _\ 2 $ $ \ldots $ $ v\ _\ k $

ここで、$ v\ _\ i\ (1\leq\ i\leq\ k) $ は $ 1 $ 以上 $ N $ 以下の整数で、$ v\ _\ 1\lt\ v\ _\ 2\lt\cdots\lt\ v\ _\ k $ を満たします。

あなたは、$ v\ _\ i\ (1\leq\ i\leq\ k) $ を $ 1 $ つ選んで以下の形式で標準出力へ出力してください。

> $ v\ _\ i $

この操作をすることで、あなたは頂点 $ v\ _\ i $ へ移動します。

移動回数が $ 2N $ 回を上回ったり、不正な出力を行った場合、ジャッジは標準入力に `-1` を送ります。

移動する先の頂点が頂点 $ N $ である場合、ジャッジは標準入力に `OK` を送り、終了します。

`-1` もしくは `OK` を受け取った場合、ただちにあなたのプログラムを終了させてください。

## 说明/提示

### 制約

- $ 2\leq\ N\leq100 $
- $ N-1\leq\ M\leq\dfrac{N(N-1)}2 $
- グラフは連結かつ単純
- 入力はすべて整数
 
### 注意点

- **出力を行うたびに、末尾に改行を入れて標準出力を flush してください。そうしなかった場合、ジャッジ結果が TLE となる可能性があります。**
- **対話の途中で不正な出力を行った、あるいはプログラムが途中で終了した場合のジャッジ結果は不定です。**
- 頂点 $ N $ に到達したらただちにプログラムを終了してください。そうしない場合、ジャッジ結果は不定です。
- **この問題のジャッジはアダプティブです。つまり、制約および以前の出力に矛盾しない範囲でグラフの形が変わる場合があります。**
 
### 入出力例

以下は、$ N=4,M=5 $ の場合の入出力例です。 この入出力では、グラフは以下の図のようになっています。

![](https://cdn.luogu.com.cn/upload/vjudge_pic/AT_abc305_f/c0782babede862d29b96c59cb832ffd123590408.png)

    入力 出力 説明     `4 5`  $ N $ と $ M $ が与えられます。   `2 2 3`  はじめ、あなたは頂点 $ 1 $ にいます。頂点 $ 1 $ に隣接している頂点が与えられます。    `3` 移動する頂点として、頂点 $ v\ _\ 2=3 $ を選びます。    `3 1 2 4`  頂点 $ 3 $ に隣接している頂点が与えられます。    `2` 移動する頂点として、頂点 $ v\ _\ 2=2 $ を選びます。    `3 1 3 4`  頂点 $ 2 $ に隣接している頂点が与えられます。    `4` 移動する頂点として、頂点 $ v\ _\ 3=4 $ を選びます。    `OK`  $ 8(=2\times4) $ 回以内で頂点 $ 4 $ に到達したので、`OK` が渡されます。   `OK` を受け取ったあと、ただちにプログラムを終了することで正解と判定されます。



---

---
title: "[ABC306F] Merge Sets"
layout: "post"
diff: 普及+/提高
pid: AT_abc306_f
tag: []
---

# [ABC306F] Merge Sets

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc306/tasks/abc306_f

$ A\ \cap\ B\ =\ \emptyset $ を満たす $ 2 $ つの整数の集合 $ A,\ B $ に対して、$ f(A,B) $ を以下のように定義します。

- $ A\ \cup\ B $ に含まれる要素を昇順に並べた数列を $ C=(C_1,C_2,\dots,C_{|A|+|B|}) $ とする。
- $ A=\lbrace\ C_{k_1},C_{k_2},\dots,C_{k_{|A|}}\rbrace $ となるような $ k_1,k_2,\dots,k_{|A|} $ をとる。 このとき、$ \displaystyle\ f(A,B)=\sum_{i=1}^{|A|}\ k_i $ とする。
 
例えば、$ A=\lbrace\ 1,3\rbrace,B=\lbrace\ 2,8\rbrace $ のとき、$ C=(1,2,3,8) $ より $ A=\lbrace\ C_1,C_3\rbrace $ なので、$ f(A,B)=1+3=4 $ です。

それぞれが $ M $ 個の要素からなる $ N $ 個の整数の集合 $ S_1,S_2\dots,S_N $ があり、各 $ i\ (1\ \leq\ i\ \leq\ N) $ について $ S_i\ =\ \lbrace\ A_{i,1},A_{i,2},\dots,A_{i,M}\rbrace $ です。 ただし、$ S_i\ \cap\ S_j\ =\ \emptyset\ (i\ \neq\ j) $ が保証されます。

$ \displaystyle\ \sum_{1\leq\ i\ <\ j\ \leq\ N}\ f(S_i,\ S_j) $ を求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ M $ $ A_{1,1} $ $ A_{1,2} $ $ \dots $ $ A_{1,M} $ $ \vdots $ $ A_{N,1} $ $ A_{N,2} $ $ \dots $ $ A_{N,M} $

## 输出格式

答えを整数として出力せよ。

## 说明/提示

### 制約

- $ 1\leq\ N\ \leq\ 10^4 $
- $ 1\leq\ M\ \leq\ 10^2 $
- $ 1\leq\ A_{i,j}\ \leq\ 10^9 $
- $ i_1\ \neq\ i_2 $ または $ j_1\ \neq\ j_2 $ ならば $ A_{i_1,j_1}\ \neq\ A_{i_2,j_2} $
- 入力は全て整数
 
### Sample Explanation 1

$ S_1,S_2 $ はそれぞれ問題文中で例示した $ A,B $ と一致し、$ f(S_1,S_2)=1+3=4 $ です。 $ f(S_1,S_3)=1+2=3,f(S_2,S_3)=1+4=5 $ であるため、$ 4+3+5=12 $ が答えです。

## 样例 #1

### 输入

```
3 2

1 3

2 8

4 6
```

### 输出

```
12
```

## 样例 #2

### 输入

```
1 1

306
```

### 输出

```
0
```

## 样例 #3

### 输入

```
4 4

155374934 164163676 576823355 954291757

797829355 404011431 353195922 138996221

191890310 782177068 818008580 384836991

160449218 545531545 840594328 501899080
```

### 输出

```
102
```



---

---
title: "[ABC309F] Box in Box"
layout: "post"
diff: 普及+/提高
pid: AT_abc309_f
tag: []
---

# [ABC309F] Box in Box

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc309/tasks/abc309_f

$ N $ 個の箱があります。 $ i $ 番目の箱は高さ・幅・奥行きがそれぞれ $ h_i,w_i,d_i $ の直方体の形をしています。

二つの箱であって、必要ならば回転させることで片方の高さ・幅・奥行きがもう片方の高さ・幅・奥行きをそれぞれ上回るようなものが存在するかを判定してください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ h_1 $ $ w_1 $ $ d_1 $ $ \vdots $ $ h_N $ $ w_N $ $ d_N $

## 输出格式

二つの箱であって、必要ならば回転させることで片方の高さ・幅・奥行きがもう片方の高さ・幅・奥行きをそれぞれ上回るようなものが存在するならば `Yes` と、そうでなければ `No` と出力せよ。

## 说明/提示

### 制約

- $ 2\ \leq\ N\ \leq\ 2\ \times\ 10^5 $
- $ 1\ \leq\ h_i,w_i,d_i\ \leq\ 10^9 $
- 入力はすべて整数
 
### Sample Explanation 1

$ 2 $ 番目の箱を回転させて高さと奥行きを入れ替えると、$ 3 $ 番目の箱が高さ・幅・奥行きをそれぞれ上回ります。

## 样例 #1

### 输入

```
3

19 8 22

10 24 12

15 25 11
```

### 输出

```
Yes
```

## 样例 #2

### 输入

```
3

19 8 22

10 25 12

15 24 11
```

### 输出

```
No
```

## 样例 #3

### 输入

```
2

1 1 2

1 2 2
```

### 输出

```
No
```



---

---
title: "[ABC310D] Peaceful Teams"
layout: "post"
diff: 普及+/提高
pid: AT_abc310_d
tag: []
---

# [ABC310D] Peaceful Teams

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc310/tasks/abc310_d

$ N $ 人のスポーツ選手がいます。

$ N $ 人の選手たちには互いに相性の悪い選手のペアが $ M $ 組あり、相性の悪い組のうち $ i\ (1\leq\ i\leq\ M) $ 組目は $ A\ _\ i $ 番目の選手と $ B\ _\ i $ 番目の選手です。

あなたは、選手を $ T $ チームに分けます。 どの選手もちょうど一つのチームに属さなければならず、どのチームにも少なくとも一人の選手が属さなければなりません。 さらに、どの $ i=1,2,\ldots,M $ についても、 $ A\ _\ i $ 番目の選手と $ B\ _\ i $ 番目の選手が同じチームに属していてはいけません。

この条件を満たすチーム分けの方法は何通りあるか求めてください。 ただし、チーム分けの方法が異なるとは、ある二人が存在して、彼らが一方のチーム分けでは同じチームに所属し、もう一方では異なるチームに所属することをいいます。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ T $ $ M $ $ A\ _\ 1 $ $ B\ _\ 1 $ $ A\ _\ 2 $ $ B\ _\ 2 $ $ \vdots $ $ A\ _\ M $ $ B\ _\ M $

## 输出格式

答えを $ 1 $ 行で出力せよ。

## 说明/提示

### 制約

- $ 1\leq\ T\leq\ N\leq10 $
- $ 0\leq\ M\leq\dfrac{N(N-1)}2 $
- $ 1\leq\ A\ _\ i\lt\ B\ _\ i\leq\ N\ (1\leq\ i\leq\ M) $
- $ (A\ _\ i,B\ _\ i)\neq\ (A\ _\ j,B\ _\ j)\ (1\leq\ i\lt\ j\leq\ M) $
- 入力はすべて整数
 
### Sample Explanation 1

次の $ 4 $ 通りのチーム分けが条件を満たします。 !\[\](https://img.atcoder.jp/abc310/b92c2629f68d56350fe18e6d0a8fa060.png) 他に条件を満たすチーム分けは存在しないので、$ 4 $ を出力してください。

### Sample Explanation 2

条件を満たすチーム分けがひとつも存在しないこともあります。

### Sample Explanation 3

相性の悪いペアがひとつも存在しないこともあります。

## 样例 #1

### 输入

```
5 2 2

1 3

3 4
```

### 输出

```
4
```

## 样例 #2

### 输入

```
5 1 2

1 3

3 4
```

### 输出

```
0
```

## 样例 #3

### 输入

```
6 4 0
```

### 输出

```
65
```

## 样例 #4

### 输入

```
10 6 8

5 9

1 4

3 8

1 6

4 10

5 7

5 6

3 7
```

### 输出

```
8001
```



---

---
title: "[ABC310E] NAND repeatedly"
layout: "post"
diff: 普及+/提高
pid: AT_abc310_e
tag: []
---

# [ABC310E] NAND repeatedly

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc310/tasks/abc310_e

`0` と `1` からなる長さ $ N $ の文字列 $ S $ が与えられます。 $ S $ は長さ $ N $ の数列 $ A=(A\ _\ 1,A\ _\ 2,\ldots,A\ _\ N) $ の情報を表しており、$ S $ の $ i $ 文字目 $ (1\leq\ i\leq\ N) $ が `0` のとき $ A\ _\ i=0 $ 、`1` のとき $ A\ _\ i=1 $です。

\\\[\\sum \_ {1\\leq i\\leq j\\leq N}(\\cdots((A \_ i\\barwedge A \_ {i+1})\\barwedge A \_ {i+2})\\barwedge\\cdots\\barwedge A \_ j)\\\]

を求めてください。

より厳密には、次のように定められる $ f(i,j)\ (1\leq\ i\leq\ j\leq\ N) $ に対して $ \displaystyle\sum\ _\ {i=1}\ ^\ {N}\sum\ _\ {j=i}\ ^\ Nf(i,j) $ を求めてください。

\\\[f(i,j)=\\left\\{\\begin{matrix} A \_ i&amp;(i=j)\\\\ f(i,j-1)\\barwedge A \_ j\\quad&amp;(i\\lt j) \\end{matrix}\\right.\\\]

ただし、否定論理積 $ \barwedge $ は次を満たす二項演算子です。

\\\[0\\barwedge0=1,0\\barwedge1=1,1\\barwedge0=1,1\\barwedge1=0\\\]

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ S $

## 输出格式

答えを $ 1 $ 行で出力せよ。

## 说明/提示

### 制約

- $ 1\leq\ N\leq10^6 $
- $ S $ は `0` と `1` からなる長さ $ N $ の文字列
- 入力はすべて整数
 
### Sample Explanation 1

$ 1\leq\ i\leq\ j\leq\ N $ を満たすすべての組 $ (i,j) $ に対して、$ f(i,j) $ の値は以下のようになります。 - $ f(1,1)=0=0 $ - $ f(1,2)=0\barwedge0=1 $ - $ f(1,3)=(0\barwedge0)\barwedge1=0 $ - $ f(1,4)=((0\barwedge0)\barwedge1)\barwedge1=1 $ - $ f(1,5)=(((0\barwedge0)\barwedge1)\barwedge1)\barwedge0=1 $ - $ f(2,2)=0=0 $ - $ f(2,3)=0\barwedge1=1 $ - $ f(2,4)=(0\barwedge1)\barwedge1=0 $ - $ f(2,5)=((0\barwedge1)\barwedge1)\barwedge0=1 $ - $ f(3,3)=1=1 $ - $ f(3,4)=1\barwedge1=0 $ - $ f(3,5)=(1\barwedge1)\barwedge0=1 $ - $ f(4,4)=1=1 $ - $ f(4,5)=1\barwedge0=1 $ - $ f(5,5)=0=0 $ これらの総和は $ 0+1+0+1+1+0+1+0+1+1+0+1+1+1+0=9 $ なので、$ 9 $ を出力してください。 $ \barwedge $ は結合法則を満たさないことに注意してください。 例えば、$ (1\barwedge1)\barwedge0=0\barwedge0=1\neq0=1\barwedge1=1\barwedge(1\barwedge0) $ です。

## 样例 #1

### 输入

```
5

00110
```

### 输出

```
9
```

## 样例 #2

### 输入

```
30

101010000100101011010011000010
```

### 输出

```
326
```



---

---
title: "[ABC322D] Polyomino"
layout: "post"
diff: 普及+/提高
pid: AT_abc322_d
tag: []
---

# [ABC322D] Polyomino

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc322/tasks/abc322_d

いくつかの正方形を辺でつなげてできる、連結な多角形の形をしたパズルのピースのことを **ポリオミノ** と呼びます。

縦 $ 4 $ マス、横 $ 4 $ マスのグリッドと、グリッドに収まる大きさの $ 3 $ 個のポリオミノがあります。  
 $ i $ 番目のポリオミノの形は $ 16 $ 個の文字 $ P_{i,j,k} $ ($ 1\ \leq\ j,\ k\ \leq\ 4 $) によって表されます。$ P_{i,\ j,\ k} $ は何も置かれていないグリッドに $ i $ 番目のポリオミノを置いたときの状態を意味して、$ P_{i,\ j,\ k} $ が `#` の場合は上から $ j $ 行目、左から $ k $ 列目のマスにポリオミノが置かれていることを、`.` の場合は置かれていないことを意味します。(入出力例 $ 1 $ の図も参考にしてください。)

あなたは次の条件を全て満たすように $ 3 $ 個のポリオミノ全てをグリッドに敷き詰めることにしました。

- グリッドの全てのマスはポリオミノで覆われている。
- ポリオミノ同士が重なるように置くことはできない。
- ポリオミノがグリッドからはみ出るように置くことはできない。
- ポリオミノの平行移動と回転は自由に行うことができるが、裏返すことはできない。
 
条件を満たすようにグリッドにポリオミノを敷き詰めることは可能ですか？

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ P_{1,1,1}P_{1,1,2}P_{1,1,3}P_{1,1,4} $ $ P_{1,2,1}P_{1,2,2}P_{1,2,3}P_{1,2,4} $ $ P_{1,3,1}P_{1,3,2}P_{1,3,3}P_{1,3,4} $ $ P_{1,4,1}P_{1,4,2}P_{1,4,3}P_{1,4,4} $ $ P_{2,1,1}P_{2,1,2}P_{2,1,3}P_{2,1,4} $ $ P_{2,2,1}P_{2,2,2}P_{2,2,3}P_{2,2,4} $ $ P_{2,3,1}P_{2,3,2}P_{2,3,3}P_{2,3,4} $ $ P_{2,4,1}P_{2,4,2}P_{2,4,3}P_{2,4,4} $ $ P_{3,1,1}P_{3,1,2}P_{3,1,3}P_{3,1,4} $ $ P_{3,2,1}P_{3,2,2}P_{3,2,3}P_{3,2,4} $ $ P_{3,3,1}P_{3,3,2}P_{3,3,3}P_{3,3,4} $ $ P_{3,4,1}P_{3,4,2}P_{3,4,3}P_{3,4,4} $

## 输出格式

問題文の条件を満たすようにポリオミノを敷き詰めることが可能である場合は `Yes` を、そうでない場合は `No` を出力せよ。

## 说明/提示

### 制約

- $ P_{i,\ j,\ k} $ は `#` または `.`
- 与えられるポリオミノは連結である。つまり、ポリオミノを構成する正方形同士は、正方形のみを上下左右に辿って互いに行き来できる
- 与えられるポリオミノは空でない
 
### Sample Explanation 1

入力例 $ 1 $ に対応するポリオミノの形は次の図のようになります。 !\[image1\](https://img.atcoder.jp/abc322/f0e25c2abcdbeade76fcb12eaee39f23.jpg) この場合、次の図のようにポリオミノを配置することで、問題文の条件を満たすようにグリッドにポリオミノを敷き詰めることができます。 !\[image2\](https://img.atcoder.jp/abc322/81e983f85e958e0d612063adcc455c71.jpg) よって答えは `Yes` になります。

### Sample Explanation 2

入力例 $ 2 $ の $ 1 $ 番目のポリオミノのように、ポリオミノは穴の空いた多角形の形をしている場合があります。

### Sample Explanation 3

ポリオミノを敷き詰めるときに、ポリオミノを裏返してはならないのに注意してください。

## 样例 #1

### 输入

```
....

###.

.#..

....

....

.###

.##.

....

..#.

.##.

.##.

.##.
```

### 输出

```
Yes
```

## 样例 #2

### 输入

```
###.

#.#.

##..

....

....

..#.

....

....

####

##..

#...

#...
```

### 输出

```
Yes
```

## 样例 #3

### 输入

```
##..

#..#

####

....

....

##..

.##.

....

.#..

.#..

.#..

.#..
```

### 输出

```
No
```

## 样例 #4

### 输入

```
....

..#.

....

....

....

..#.

....

....

....

..#.

....

....
```

### 输出

```
No
```

## 样例 #5

### 输入

```
....

####

#...

#...

....

####

...#

..##

....

..##

..#.

..##
```

### 输出

```
No
```

## 样例 #6

### 输入

```
###.

.##.

..#.

.###

....

...#

..##

...#

....

#...

#...

#...
```

### 输出

```
Yes
```



---

---
title: "[ABC322E] Product Development"
layout: "post"
diff: 普及+/提高
pid: AT_abc322_e
tag: []
---

# [ABC322E] Product Development

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc322/tasks/abc322_e

AtCoder 社はある商品の開発をしようとしています。この商品には $ K $ 個のパラメーターがあり、現段階ではすべてのパラメーターの値が $ 0 $ です。AtCoder 社の目標は、パラメーターの値を全て $ P $ 以上にすることです。

ここで、$ N $ 個の開発案があります。$ i(1\ \le\ i\ \le\ N) $ 個目の開発案を実行すると、$ 1\ \le\ j\ \le\ K $ を満たす整数 $ j $ 全てに対して $ j $ 個目のパラメーターが $ A_{i,j} $ 上がりますが、この開発案を実行するにはコストが $ C_i $ かかります。

同じ開発案を $ 2 $ 回以上実行することは出来ません。AtCoder 社が目標を達成出来るか判定し、出来る場合は目標を達成するのに必要なコストの総和の最小値を求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ K $ $ P $ $ C_1 $ $ A_{1,1} $ $ A_{1,2} $ $ \dots $ $ A_{1,K} $ $ C_2 $ $ A_{2,1} $ $ A_{2,2} $ $ \dots $ $ A_{2,K} $ $ \dots $ $ C_N $ $ A_{N,1} $ $ A_{N,2} $ $ \dots $ $ A_{N,K} $

## 输出格式

AtCoder 社が目標を達成出来るならば目標を達成するのに必要なコストの総和の最小値を、出来ないならば `-1` を出力せよ。

## 说明/提示

### 制約

- $ 1\ \le\ N\ \le\ 100 $
- $ 1\ \le\ K,P\ \le\ 5 $
- $ 0\ \le\ A_{i,j}\ \le\ P(1\ \le\ i\ \le\ N,1\ \le\ j\ \le\ K) $
- $ 1\ \le\ C_i\ \le\ 10^9(1\ \le\ i\ \le\ N) $
- 入力は全て整数
 
### Sample Explanation 1

$ 1 $ 個目と $ 3 $ 個目と $ 4 $ 個目の開発案を実行すると、それぞれのパラメーターが $ 3+2+0=5,0+4+1=5,2+0+4=6 $ で全て $ 5 $ 以上となるため目標を達成できます。この場合コストの総和は $ 5\ +\ 3\ +\ 1\ =\ 9 $ となります。 コストの総和 $ 8 $ 以下で目標を達成することは出来ません。よって答えは $ 9 $ です。

### Sample Explanation 2

どのようにしても目標を達成することは出来ません。よって `-1` を出力します。

## 样例 #1

### 输入

```
4 3 5

5 3 0 2

3 1 2 3

3 2 4 0

1 0 1 4
```

### 输出

```
9
```

## 样例 #2

### 输入

```
7 3 5

85 1 0 1

37 1 1 0

38 2 0 0

45 0 2 2

67 1 1 0

12 2 2 0

94 2 2 1
```

### 输出

```
-1
```



---

---
title: "[ABC322F] Vacation Query"
layout: "post"
diff: 普及+/提高
pid: AT_abc322_f
tag: []
---

# [ABC322F] Vacation Query

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc322/tasks/abc322_f

`0`, `1` からなる長さ $ N $ の文字列 $ S $ が与えられます。$ S $ の $ i $ 文字目を $ S_i $ とします。

$ Q $ 個のクエリを与えられた順に処理してください。  
 クエリは $ 3 $ 個の整数の組 $ (c,\ L,\ R) $ で表されて、$ c $ の値によってクエリの種類が異なります。

- $ c=1 $ のとき : $ L\ \leq\ i\ \leq\ R $ を満たす整数 $ i $ について、$ S_i $ が `1` ならば `0` に、`0` ならば `1` に変更する。
- $ c=2 $ のとき : $ S $ の $ L $ 文字目から $ R $ 文字目までを取り出して出来る文字列を $ T $ とする。$ T $ に含まれる連続する `1` の長さの最大値を出力する。

## 输入格式

入力は以下の形式で標準入力から与えられる。ここで $ \mathrm{query}_i $ は $ i $ 番目のクエリを意味する。

> $ N $ $ Q $ $ S $ $ \mathrm{query}_1 $ $ \mathrm{query}_2 $ $ \vdots $ $ \mathrm{query}_Q $

各クエリは次の形式で与えられる。

> $ c $ $ L $ $ R $

## 输出格式

$ c=2 $ であるクエリの個数を $ k $ として、$ k $ 行出力せよ。  
 $ i $ 行目には $ i $ 番目の $ c=2 $ であるクエリに対する答えを出力せよ。

## 说明/提示

### 制約

- $ 1\ \leq\ N\ \leq\ 5\ \times\ 10^5 $
- $ 1\ \leq\ Q\ \leq\ 10^5 $
- $ S $ は長さ $ N $ の `0`, `1` からなる文字列
- $ c\ \in\ \lbrace\ 1,\ 2\ \rbrace $
- $ 1\ \leq\ L\ \leq\ R\ \leq\ N $
- $ N,\ Q,\ c,\ L,\ R $ は全て整数
 
### Sample Explanation 1

クエリを順に処理すると次のようになります。 - はじめ、$ S= $ `1101110` です。 - $ 1 $ 番目のクエリについて、$ T\ = $ `1101110` です。$ T $ に含まれる連続する `1` の中で最も長いものは、$ T $ の $ 4 $ 文字目から $ 6 $ 文字目からなる `111` なので、答えは $ 3 $ になります。 - $ 2 $ 番目のクエリについて、$ T\ = $ `101` です。$ T $ に含まれる連続する `1` の中で最も長いものは、$ T $ の $ 1 $ 文字目あるいは $ 3 $ 文字目の `1` なので、答えは $ 1 $ になります。 - $ 3 $ 番目のクエリについて、操作後の $ S $ は `1110000` です。 - $ 4 $ 番目のクエリについて、$ T\ = $ `00` です。$ T $ に `1` は含まれないので答えは $ 0 $ になります。 - $ 5 $ 番目のクエリについて、操作後の $ S $ は `1111111` です。 - $ 6 $ 番目のクエリについて、$ T\ = $ `1111111` です。$ T $ に含まれる連続する `1` の中で最も長いものは、$ T $ の $ 1 $ 文字目から $ 7 $ 文字目からなる `1111111` なので、答えは $ 7 $ になります。

## 样例 #1

### 输入

```
7 6

1101110

2 1 7

2 2 4

1 3 6

2 5 6

1 4 7

2 1 7
```

### 输出

```
3

1

0

7
```



---

---
title: "[ABC324F] Beautiful Path"
layout: "post"
diff: 普及+/提高
pid: AT_abc324_f
tag: []
---

# [ABC324F] Beautiful Path

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc324/tasks/abc324_f

$ N $ 個の頂点と $ M $ 本の辺からなる有向グラフがあります。各辺には**美しさ**と**コスト**の $ 2 $ つの正整数値が定められています。

$ i\ =\ 1,\ 2,\ \ldots,\ M $ について、$ i $ 番目の辺は頂点 $ u_i $ から頂点 $ v_i $ への有向辺であり、その美しさは $ b_i $ 、コストは $ c_i $ です。 ここで、$ u_i\ \lt\ v_i $ が制約として保証されます。

頂点 $ 1 $ から頂点 $ N $ へのパス $ P $ を $ 1 $ つ選んだときの、下記の値としてあり得る最大値を求めてください。

- $ P $ 上のすべての辺の美しさの総和を、$ P $ 上のすべての辺のコストの総和で割った値
 
ここで、与えられるグラフにおいて頂点 $ 1 $ から頂点 $ N $ へのパスが $ 1 $ 個以上存在することが制約として保証されます。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ M $ $ u_1 $ $ v_1 $ $ b_1 $ $ c_1 $ $ u_2 $ $ v_2 $ $ b_2 $ $ c_2 $ $ \vdots $ $ u_M $ $ v_M $ $ b_M $ $ c_M $

## 输出格式

答えを出力せよ。出力された値と真の値の相対誤差もしくは絶対誤差が $ 10^{-9} $ 以下のとき、正答と判定される。

## 说明/提示

### 制約

- $ 2\ \leq\ N\ \leq\ 2\ \times\ 10^5 $
- $ 1\ \leq\ M\ \leq\ 2\ \times\ 10^5 $
- $ 1\ \leq\ u_i\ \lt\ v_i\ \leq\ N $
- $ 1\ \leq\ b_i,\ c_i\ \leq\ 10^4 $
- 頂点 $ 1 $ から頂点 $ N $ へのパスが存在する
- 入力される値はすべて整数
 
### Sample Explanation 1

パス $ P $ として、 $ 2,\ 6,\ 7 $ 番目の辺をこの順に通り頂点 $ 1\ \rightarrow\ 3\ \rightarrow\ 4\ \rightarrow\ 5 $ とたどるバスを選んだとき、「 $ P $ 上のすべての辺の美しさの総和を $ P $ 上のすべての辺のコストの総和で割った値」 は、 $ (b_2\ +\ b_6\ +\ b_7)\ /\ (c_2\ +\ c_6\ +\ c_7)\ =\ (9\ +\ 4\ +\ 2)\ /\ (5\ +\ 8\ +\ 7)\ =\ 15\ /\ 20\ =\ 0.75 $ であり、これがあり得る最大値です。

## 样例 #1

### 输入

```
5 7

1 2 3 6

1 3 9 5

2 3 1 5

2 4 5 3

2 5 1 9

3 4 4 8

4 5 2 7
```

### 输出

```
0.7500000000000000
```

## 样例 #2

### 输入

```
3 3

1 3 1 1

1 3 2 1

1 3 3 1
```

### 输出

```
3.0000000000000000
```

## 样例 #3

### 输入

```
10 20

3 4 1 2

7 9 4 5

2 4 4 5

4 5 1 4

6 9 4 1

9 10 3 2

6 10 5 5

5 6 1 2

5 6 5 2

2 3 2 3

6 10 4 4

4 6 3 4

4 8 4 1

3 5 3 2

2 4 3 2

3 5 4 2

1 5 3 4

1 2 4 2

3 7 2 2

7 8 1 3
```

### 输出

```
1.8333333333333333
```



---

---
title: "[ABC326E] Revenge of "The Salary of AtCoder Inc.""
layout: "post"
diff: 普及+/提高
pid: AT_abc326_e
tag: []
---

# [ABC326E] Revenge of "The Salary of AtCoder Inc."

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc326/tasks/abc326_e

AtCoder社の社員である青木さんの今月の給料は、整数 $ N $ と長さ $ N $ の数列 $ A $ を用いて以下のように決められます。  
 まず、青木さんに $ 1 $ から $ N $ までの整数が等確率で出る $ N $ 面ダイスと変数 $ x=0 $ を渡します。

その後、以下の手順を終了まで繰り返します。

- ダイスを $ 1 $ 度振り、出た目を $ y $ とする。
  - もし $ x\ <\ y $ なら $ A_y $ 円支給し、 $ x=y $ と更新する。
  - そうでないなら終了する。
 
青木さんの今月の給料は、この手順によって支給された金額の合計です。  
 青木さんの今月の給料の期待値を $ {}\bmod{998244353} $ で求めてください。

 期待値 $ {}\bmod{998244353} $ の定義 この問題で求める期待値は必ず有理数になることが証明できます。 また、この問題の制約下では、求める期待値を既約分数 $ \frac\ yx $ で表したときに $ x $ が $ 998244353 $ で割り切れないことが保証されます。 このとき、$ y\equiv\ xz\pmod{998244353} $ を満たす $ 0\leq\ z\lt998244353 $ がただ一つ存在するので、$ z $ を出力してください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ A_1 $ $ A_2 $ $ \dots $ $ A_N $

## 输出格式

答えを出力せよ。

## 说明/提示

### 制約

- 入力は全て整数
- $ 1\ \le\ N\ \le\ 3\ \times\ 10^5 $
- $ 0\ \le\ A_i\ <\ 998244353 $
 
### Sample Explanation 1

手順の一例は、以下の通りです。 - 最初、 $ x=0 $ である。 - ダイスを $ 1 $ 度振り、出た目が $ 1 $ であった。 $ 0\ <\ 1 $ であるため、 $ A_1\ =\ 3 $ 円支給し、 $ x=1 $ とする。 - ダイスを $ 1 $ 度振り、出た目が $ 3 $ であった。 $ 1\ <\ 3 $ であるため、 $ A_3\ =\ 6 $ 円支給し、 $ x=3 $ とする。 - ダイスを $ 1 $ 度振り、出た目が $ 1 $ であった。 $ 3\ \ge\ 1 $ であるため、終了する。 この例では、青木さんの今月の給料は $ 9 $ 円です。 なお、青木さんの今月の給料の期待値は $ \frac{49}{9} $ 円と求めることができ、これを $ {}\bmod{998244353} $ 上で表現すると $ 776412280 $ となります。

## 样例 #1

### 输入

```
3

3 2 6
```

### 输出

```
776412280
```

## 样例 #2

### 输入

```
1

998244352
```

### 输出

```
998244352
```

## 样例 #3

### 输入

```
9

3 14 159 2653 58979 323846 2643383 27950288 419716939
```

### 输出

```
545252774
```



---

---
title: "[ABC330F] Minimize Bounding  Square"
layout: "post"
diff: 普及+/提高
pid: AT_abc330_f
tag: []
---

# [ABC330F] Minimize Bounding  Square

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc330/tasks/abc330_f

$ xy $ 平面上に $ N $ 個の点 $ 1,2,\dots,N $ があります。このうち点 $ i $ は座標 $ (X_i,Y_i) $ にあります。  
あなたは、以下の操作を $ 0 $ 回以上 $ K $ 回以下行うことができます。

- まず、 $ N $ 点の中からひとつを選択する。選ばれた点を $ k $ とし、この点が現在 $ (x,y) $ にあるものとする。
- 次に、以下の $ 4 $ つからひとつを選択し、実行する。
  - 点 $ k $ を $ x $ 軸沿いに $ +1 $ だけ移動させる。点 $ k $ の座標は $ (x+1,y) $ となる。
  - 点 $ k $ を $ x $ 軸沿いに $ -1 $ だけ移動させる。点 $ k $ の座標は $ (x-1,y) $ となる。
  - 点 $ k $ を $ y $ 軸沿いに $ +1 $ だけ移動させる。点 $ k $ の座標は $ (x,y+1) $ となる。
  - 点 $ k $ を $ y $ 軸沿いに $ -1 $ だけ移動させる。点 $ k $ の座標は $ (x,y-1) $ となる。
- 複数の点を同じ座標に存在させることも許されます。また、入力で複数の点が同じ座標に存在しうることに注意してください。

全ての操作が終わった後、 $ N $ 個全ての点を内部または周上に包含する、各辺が $ x $ 軸または $ y $ 軸に平行な正方形をひとつ書き込みます。  
このとき、書き込む正方形の一辺の長さとしてありうる最小の値を求めてください。全ての点が常に格子点にあることから、この値は整数であることが示せます。

**特に、全ての点を同じ座標に存在させられる時、答えは $ 0 $ であるものとします。**

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ K $ $ X_1 $ $ Y_1 $ $ X_2 $ $ Y_2 $ $ \vdots $ $ X_N $ $ Y_N $

## 输出格式

答えを整数として出力せよ。

## 说明/提示

### 制約

- 入力は全て整数
- $ 1\ \le\ N\ \le\ 2\ \times\ 10^5 $
- $ 0\ \le\ K\ \le\ 4\ \times\ 10^{14} $
- $ 0\ \le\ X_i,Y_i\ \le\ 10^9 $

### Sample Explanation 1

このケースについて、横を $ x $ 軸、縦を $ y $ 軸として図示したものが以下です。 !\[\](https://img.atcoder.jp/abc330/932178d158b342b9bda6bdc72b439f0e.png) 例えば、図中の矢印に従って $ 4 $ 度の移動を行った後、図中に示した一辺が $ 3 $ の正方形で全ての点を内部または周上に含むことができ、これが最小値であることが示せます。

### Sample Explanation 2

最初から全ての点が同じ座標に存在します。 例えば操作を $ 0 $ 回行う (即ち、全く行わない) ことにより、全ての点を同じ座標に存在させられるので、この入力に対する答えは $ 0 $ です。

## 样例 #1

### 输入

```
6 5
2 0
5 2
0 3
3 2
3 4
1 5
```

### 输出

```
3
```

## 样例 #2

### 输入

```
4 400000000000000
1000000000 1000000000
1000000000 1000000000
1000000000 1000000000
1000000000 1000000000
```

### 输出

```
0
```

## 样例 #3

### 输入

```
10 998244353
489733278 189351894
861289363 30208889
450668761 133103889
306319121 739571083
409648209 922270934
930832199 304946211
358683490 923133355
369972904 539399938
915030547 735320146
386219602 277971612
```

### 输出

```
484373824
```



---

---
title: "[ABC335E] Non-Decreasing Colorful Path"
layout: "post"
diff: 普及+/提高
pid: AT_abc335_e
tag: []
---

# [ABC335E] Non-Decreasing Colorful Path

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc335/tasks/abc335_e

$ N $ 頂点 $ M $ 辺の連結な無向グラフがあり、 $ i $ 番目の辺は頂点 $ U_i $ と頂点 $ V_i $ を双方向に結びます。  
 また、全ての頂点に整数が書いてあり、頂点 $ v $ には整数 $ A_v $ が書かれています。

頂点 $ 1 $ から頂点 $ N $ への単純なパス ( 同じ頂点を複数回通らないパス ) に対して、以下のように得点を定めます。

- パス上の頂点に書かれた整数を通った順に並べた数列 を $ S $ とする。
- $ S $ が広義単調増加になっていない場合、そのパスの得点は $ 0 $ である。
- そうでない場合、 $ S $ に含まれる整数の種類数が得点となる。
 
頂点 $ 1 $ から頂点 $ N $ への全ての単純なパスのうち、最も得点が高いものを求めてその得点を出力してください。

  $ S $ が広義単調増加であるとは? 長さ $ l $ の数列 $ S=(S_1,S_2,\dots,S_l) $ が広義単調増加であるとは、 全ての整数 $ 1\ \le\ i\ について\ S_i\ \le\ S_{i+1} $ を満たすことを言います。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ M $ $ A_1 $ $ A_2 $ $ \dots $ $ A_N $ $ U_1 $ $ V_1 $ $ U_2 $ $ V_2 $ $ \vdots $ $ U_M $ $ V_M $

## 输出格式

答えを整数として出力せよ。

## 说明/提示

### 制約

- 入力は全て整数
- $ 2\ \le\ N\ \le\ 2\ \times\ 10^5 $
- $ N-1\ \le\ M\ \le\ 2\ \times\ 10^5 $
- $ 1\ \le\ A_i\ \le\ 2\ \times\ 10^5 $
- グラフは連結である
- $ 1\ \le\ U_i\ <\ V_i\ \le\ N $
- $ i\ \neq\ j $ なら $ (U_i,V_i)\ \neq\ (U_j,V_j) $
 
### Sample Explanation 1

$ 1\ \rightarrow\ 3\ \rightarrow\ 4\ \rightarrow\ 5 $ というパスについて $ S=(10,30,40,50) $ となり、このパスの得点は $ 4 $ で、これが最大です。

### Sample Explanation 2

頂点 $ 1 $ から頂点 $ N $ への単純パスであって、 $ S $ が広義単調増加となるものはありません。この場合、最大の得点は $ 0 $ です。

## 样例 #1

### 输入

```
5 6

10 20 30 40 50

1 2

1 3

2 5

3 4

3 5

4 5
```

### 输出

```
4
```

## 样例 #2

### 输入

```
4 5

1 10 11 4

1 2

1 3

2 3

2 4

3 4
```

### 输出

```
0
```

## 样例 #3

### 输入

```
10 12

1 2 3 3 4 4 4 6 5 7

1 3

2 9

3 4

5 6

1 2

8 9

4 5

8 10

7 10

4 6

2 8

6 7
```

### 输出

```
5
```



---

---
title: "[ABC387C] Snake Numbers"
layout: "post"
diff: 普及+/提高
pid: AT_abc387_c
tag: []
---

# [ABC387C] Snake Numbers

## 题目描述

在 $10$ 以上（含）的正整数中，我们称一个数字为**蛇数**当且仅当其开头的位（首位）数字严格大于其他位数。例如， $31$ 和 $201$ 是蛇数，而 $35$ 和 $202$ 不是。

求 $L$ 以上 $R$ 以下的蛇数的个数。

## 输入格式

输入按照如下格式由标准输入给出。

> $L$ $R$

## 输出格式

输出答案即可。

## 说明/提示

#### 约定

- $10\leq L \leq R \leq 10^{18}$
- 输入均为整数


$97$ 以上 $210$ 以下的蛇数有 $97,98,100,200,201,210$ 这 $6$ 个。

Translation by @[$\varLambda\omicron\varrho\acute{\varepsilon}\nu\tau\zeta$](/user/1232305).

## 样例 #1

### 输入

```
97 210
```

### 输出

```
6
```

## 样例 #2

### 输入

```
1000 9999
```

### 输出

```
2025
```

## 样例 #3

### 输入

```
252509054433933519 760713016476190692
```

### 输出

```
221852052834757
```



---

---
title: "[ABC390D] Stone XOR"
layout: "post"
diff: 普及+/提高
pid: AT_abc390_d
tag: []
---

# [ABC390D] Stone XOR

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc390/tasks/abc390_d

袋 $ 1 $, 袋 $ 2 $, $ \ldots $, 袋 $ N $ と番号づけられた $ N $ 個の袋があります。  
 袋 $ i $ $ (1\leq\ i\leq\ N) $ には $ A_i $ 個の石が入っています。

高橋君は次の操作を好きなだけ（$ 0 $ 回でも良い）繰り返すことができます。

> $ 2 $ つの袋 A, B を選び、袋 A に入っている石を **すべて** 袋 B に入れる。

操作を繰り返した後の状態における次の値としてあり得るものが何個あるか求めてください。

- 袋 $ i $ に入っている石の個数を $ B_i $ として、$ B_1\oplus\ B_2\oplus\cdots\oplus\ B_N $ の値。  
   ただし、$ \oplus $ は排他的論理和を表す。
 
  排他的論理和とは 非負整数 $ a,b $ の排他的論理和 $ a\ \oplus\ b $ は、以下のように定義されます。 > $ a\ \oplus\ b $ を二進表記した際の $ 2^k $ $ (k\ \geq\ 0) $ の位の数は、 $ a $, $ b $ を二進表記した際の $ 2^k $ の位の数のうち一方のみが $ 1 $ であれば $ 1 $ 、 そうでなければ $ 0 $ である。

 例えば、$ 3\ \oplus\ 5\ =\ 6 $ となります（二進表記すると $ 011\ \oplus\ 101\ =\ 110 $）。  
 一般に $ k $ 個の非負整数 $ x_1,\ x_2,\ \ldots,\ x_k $ の排他的論理和 $ x_1\oplus\ x_2\oplus\cdots\oplus\ x_k $ は $ (\cdots((x_1\ \oplus\ x_2)\ \oplus\ x_3)\ \oplus\ \cdots\ \oplus\ x_k) $ と定義され、 これは $ x_1,\ x_2,\ \ldots,\ x_k $ の順番によらないことが証明できます。 なお、問題の制約下において、操作を繰り返した後の状態における上記の値としてあり得るものが有限個しかないことが証明できます。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ A_1 $ $ A_2 $ $ \ldots $ $ A_N $

## 输出格式

高橋君が操作を繰り返した後の状態における、問題文中で定義された値としてあり得るものの個数を出力せよ。

## 说明/提示

### 制約

- $ 2\leq\ N\ \leq\ 12 $
- $ 1\leq\ A_i\ \leq\ 10^{17} $
- 入力はすべて整数
 
### Sample Explanation 1

例えば、高橋君が袋 A, B として袋 $ 1 $, $ 3 $ を選び、操作を行ったとすると、袋 $ 1,2,3 $ に入っている石はそれぞれ $ 0,5,9 $ となります。 ここで高橋君が操作を終了したとき、この状態における、袋に入っている石の個数の排他的論理和は $ 0\oplus\ 5\oplus\ 9=12 $ となります。 他に、高橋君が操作を繰り返した後の状態における、袋に入っている石の個数の排他的論理和としてあり得るものは $ 0,14 $ があります。 よって、あり得る値は $ 0,12,14 $ の $ 3 $ 個であるため、$ 3 $ を出力します。

## 样例 #1

### 输入

```
3

2 5 7
```

### 输出

```
3
```

## 样例 #2

### 输入

```
2

100000000000000000 100000000000000000
```

### 输出

```
2
```

## 样例 #3

### 输入

```
6

71 74 45 34 31 60
```

### 输出

```
84
```



---

---
title: "[ABC390F] Double Sum 3"
layout: "post"
diff: 普及+/提高
pid: AT_abc390_f
tag: []
---

# [ABC390F] Double Sum 3

## 题目描述

给你一个长为 $N$ 的整数序列 $A=(A_1,A_2, \dots A_N)$。\
定义 $f(L,R)$ 如下
- 从一块空黑板开始。在黑板上依次写下 $R−L+1$ 个整数 $A_L,A_{l+1}, \dots,A_R$
- 重复下面的操作，直到擦去黑板上的所有整数：
	- 选择 $l,r(l \le r)$ 使得**数值**在 $[l,r]$ 的每个整数都至少在黑板上出现一次。然后，擦除所有**数值**在 $[l,r]$ 之间的整数。
- 设 $f(L,R)$ 是擦除黑板上所有整数所需的最少次数。

求出 $\displaystyle \sum_{L=1}^N \sum_{R=L}^N f(L,R)$。

## 输入格式

第一行一个正整数 $N$。第二行 $N$ 个正整数 $A_1,A_2,\dots,A_N$。

## 输出格式

输出一行，即所求答案。
### 样例1解释
以 $(L,R)$ 为例。\
黑板上有 $1,3,1,4$。\
选择 $(L,R)=(1,1)$ 并擦除所有 $1$。现在黑板上有 $(3,4)$。\
选择 $(L,R)=(3,4)$ 并擦除所有 $3$ 和 $4$。黑板就变成空的了。\
不能少于 $2$ 次操作完成。\
$\displaystyle \sum_{L=1}^N \sum_{R=L}^N f(L,R)=16$，所以打印 $16$。

## 样例 #1

### 输入

```
4
1 3 1 4
```

### 输出

```
16
```

## 样例 #2

### 输入

```
5
3 1 4 2 4
```

### 输出

```
23
```

## 样例 #3

### 输入

```
10
5 1 10 9 2 5 6 9 1 6
```

### 输出

```
129
```



---

---
title: "Flat Subsequence"
layout: "post"
diff: 普及+/提高
pid: AT_abl_d
tag: []
---

# Flat Subsequence

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abl/tasks/abl_d

数列 $ A_1,\ A_2,\ ...,\ A_N $ と整数 $ K $ が与えられます。

以下の条件を満たす数列 $ B $ の長さとして考えられる最大値を出力してください。

- $ B $ は $ A $ の (連続とは限らない) 部分列である。
- どの $ B $ の隣り合う要素の差の絶対値も $ K $ 以下である。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ K $ $ A_1 $ $ A_2 $ $ : $ $ A_N $

## 输出格式

答えを出力せよ。

## 说明/提示

### 制約

- $ 1\ \leq\ N\ \leq\ 300,000 $
- $ 0\ \leq\ A_i\ \leq\ 300,000 $
- $ 0\ \leq\ K\ \leq\ 300,000 $
- 入力は全て整数である。

### Sample Explanation 1

たとえば、 $ B\ =\ (1,\ 4,\ 3,\ 6,\ 9,\ 7,\ 4) $ は条件を満たします。 - これは $ A\ =\ (1,\ 5,\ 4,\ 3,\ 8,\ 6,\ 9,\ 7,\ 2,\ 4) $ の部分列です。 - 全ての隣り合う要素の差の絶対値 ($ |1-4|,\ |4-3|,\ |3-6|,\ |6-9|,\ |9-7|,\ |7-4| $) は $ K\ =\ 3 $ 以下です。

## 样例 #1

### 输入

```
10 3

1

5

4

3

8

6

9

7

2

4
```

### 输出

```
7
```



---

---
title: "Replace Digits"
layout: "post"
diff: 普及+/提高
pid: AT_abl_e
tag: []
---

# Replace Digits

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abl/tasks/abl_e

長さ $ N $ の文字列 $ S $ があります。 最初は $ S $ のすべての文字が `1` です。

クエリを $ Q $ 回処理します。 $ i $ 番目のクエリでは、整数 $ L_i,\ R_i $ と文字 (数字) $ D_i $ が与えられます。 $ L_i $ 番目から $ R_i $ 番目までの全ての文字を $ D_i $ に書き換えてください。

各クエリの後、$ S $ を十進法で書かれた整数とみなし、その値を $ 998,244,353 $ でわった余りを出力してください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ Q $ $ L_1 $ $ R_1 $ $ D_1 $ $ : $ $ L_Q $ $ R_Q $ $ D_Q $

## 输出格式

$ Q $ 行出力せよ。 $ i $ 行目には $ i $ 番目のクエリの後の $ S $ の値を modulo $ 998,244,353 $ で出力せよ。

## 说明/提示

### 制約

- $ 1\ \leq\ N,\ Q\ \leq\ 200,000 $
- $ 1\ \leq\ L_i\ \leq\ R_i\ \leq\ N $
- $ 1\ \leq\ D_i\ \leq\ 9 $
- 入力は全て整数である。

### Sample Explanation 2

あまりをとるのを忘れないでください。

## 样例 #1

### 输入

```
8 5

3 6 2

1 4 7

3 8 3

2 2 2

4 5 1
```

### 输出

```
11222211

77772211

77333333

72333333

72311333
```

## 样例 #2

### 输入

```
200000 1

123 456 7
```

### 输出

```
641437905
```



---

---
title: "Reachable Towns"
layout: "post"
diff: 普及+/提高
pid: AT_acl1_a
tag: []
---

# Reachable Towns

## 题目描述

[problemUrl]: https://atcoder.jp/contests/acl1/tasks/acl1_a

$ 2 $ 次元平面上に $ N $ 個の街があります。$ i $ 個目の街の座標は $ (x_i,\ y_i) $ です。ここで、$ (x_1,\ x_2,\ \dots,\ x_N) $ と $ (y_1,\ y_2,\ \dots,\ y_N) $ は、ともに $ (1,\ 2,\ \dots,\ N) $ の順列となっています。

各 $ k\ =\ 1,2,\dots,N $ について、以下の問題の答えを求めてください。

rngさんが街 $ k $ にいる。 rngさんは、今いる街よりも「$ x,\ y $ 座標がともに小さい街」か「$ x,\ y $ 座標がともに大きい街」に移動することを好きな回数繰り返すことができる。 rngさんが到達可能な街は、(街 $ k $ を含めて) 何種類あるか？

## 输入格式

> $ N $ $ x_1 $ $ y_1 $ $ x_2 $ $ y_2 $ $ : $ $ x_N $ $ y_N $

## 输出格式

$ N $ 行出力する。$ i $ 行目には、$ k\ =\ i $ のときの答えを出力すること。

## 说明/提示

### 制約

- $ 1\ \leq\ N\ \leq\ 200,000 $
- $ (x_1,\ x_2,\ \dots,\ x_N) $ は $ (1,\ 2,\ \dots,\ N) $ の並び替え
- $ (y_1,\ y_2,\ \dots,\ y_N) $ は $ (1,\ 2,\ \dots,\ N) $ の並び替え
- 入力される数は全て整数である．

### Sample Explanation 1

街 $ 3 $ からは街 $ 4 $ に、また逆に街 $ 4 $ からは街 $ 3 $ へ移動できます。

## 样例 #1

### 输入

```
4

1 4

2 3

3 1

4 2
```

### 输出

```
1

1

2

2
```

## 样例 #2

### 输入

```
7

6 4

4 3

3 5

7 1

2 7

5 2

1 6
```

### 输出

```
3

3

1

1

2

3

2
```



---

---
title: "[AGC003C] BBuBBBlesort!"
layout: "post"
diff: 普及+/提高
pid: AT_agc003_c
tag: []
---

# [AGC003C] BBuBBBlesort!

## 题目描述

[problemUrl]: https://atcoder.jp/contests/agc003/tasks/agc003_c

高橋君は、誕生日に長さ $ N $ の数列をもらいました。$ i(1\ ≦\ i\ ≦\ N) $ 番目の要素は整数 $ A_i $ です。どの $ 2 $ つの要素も、互いに異なります。 高橋君はこの数列を単調増加になるように並べ替えたいです。 高橋君は超能力者なので、以下の $ 2 $ つの操作が任意のタイミングでできます。

- 操作$ 1 $: 数列の連続する $ 2 $ つの要素を選び、その $ 2 $ つの順番を反転する。
- 操作$ 2 $: 数列の連続する $ 3 $ つの要素を選び、その $ 3 $ つの順番を反転する。

高橋君は操作$ 2 $は好きですが、操作$ 1 $は嫌いです。この $ 2 $ 種類の操作を使って数列を単調増加になるように並び替えるときの、操作$ 1 $の最小回数を求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ A_1 $ : $ A_N $

## 输出格式

操作$ 1 $の最小回数を出力せよ。

## 说明/提示

### 制約

- $ 1\ ≦\ N\ ≦\ 10^5 $
- $ 0\ ≦\ A_i\ ≦\ 10^9 $
- $ i\ ≠\ j $ ならば $ A_i\ ≠\ A_j $
- 入力はすべて整数である。

### Sample Explanation 1

以下の操作で、単調増加な数列にすることができます。 - まず、後ろの $ 3 $ つの要素を反転する。数列は $ 2,1,3,4 $ となる。 - 次に、前の $ 2 $ つの要素を反転する。数列は $ 1,2,3,4 $ となる。 この操作列において、連続する $ 2 $ つの要素を入れ替える操作の回数は $ 1 $ です。これより少ない回数で単調増加な数列は作れないので、$ 1 $ を出力します。

## 样例 #1

### 输入

```
4

2

4

3

1
```

### 输出

```
1
```

## 样例 #2

### 输入

```
5

10

8

5

3

2
```

### 输出

```
0
```



---

---
title: "[AGC004B] Colorful Slimes"
layout: "post"
diff: 普及+/提高
pid: AT_agc004_b
tag: []
---

# [AGC004B] Colorful Slimes

## 题目描述

[problemUrl]: https://atcoder.jp/contests/agc004/tasks/agc004_b

高橋君は異世界に住んでいます。 この世界には $ N $ 色のスライムがいます。 最初、高橋君はどの色のスライムも飼っていません。 高橋君の目標は、全色のスライムを一緒に飼うことです。

高橋君は次の $ 2 $ 種類の操作を行えます。

- 今飼っていないスライムの色 $ i $ ($ 1\ <\ =i\ <\ =N $) をひとつ選ぶ。 色 $ i $ のスライムを捕まえて飼う。 この操作には $ a_i $ 秒掛かる。
- 魔法を唱える。 すると、今飼っている各スライムについて、色 $ i $ ($ 1\ <\ =i\ <\ =N-1 $) のスライムは色 $ i+1 $ へ変色する。 ただし、色 $ N $ のスライムは色 $ 1 $ へ変色する。 この操作には $ x $ 秒掛かる。

高橋君が全色のスライムを一緒に飼うためには、最短で合計何秒掛かるかを求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ x $ $ a_1 $ $ a_2 $ $ ... $ $ a_N $

## 输出格式

高橋君が全色のスライムを一緒に飼うためには、最短で合計何秒掛かるかを出力せよ。

## 说明/提示

### 制約

- $ 2\ <\ =N\ <\ =2,000 $
- $ a_i $ は整数である。
- $ 1\ <\ =a_i\ <\ =10^9 $
- $ x $ は整数である。
- $ 1\ <\ =x\ <\ =10^9 $

### Sample Explanation 1

次のように操作を行えばよいです。 - 色 $ 1 $ のスライムを捕まえて飼う。 $ 1 $ 秒掛かる。 - 魔法を唱える。 スライムの色が $ 1 $ → $ 2 $ と変わる。 $ 10 $ 秒掛かる。 - 色 $ 1 $ のスライムを捕まえて飼う。 $ 1 $ 秒掛かる。

### Sample Explanation 2

次のように操作を行えばよいです。 - 色 $ 2 $ のスライムを捕まえて飼う。 $ 1 $ 秒掛かる。 - 魔法を唱える。 スライムの色が $ 2 $ → $ 3 $ と変わる。 $ 10 $ 秒掛かる。 - 色 $ 2 $ のスライムを捕まえて飼う。 $ 1 $ 秒掛かる。 - 魔法を唱える。 スライムの色が $ 3 $ → $ 1 $，$ 2 $ → $ 3 $ とそれぞれ変わる。 $ 10 $ 秒掛かる。 - 色 $ 2 $ のスライムを捕まえて飼う。 $ 1 $ 秒掛かる。

### Sample Explanation 3

次のように操作を行えばよいです。 - 色 $ 1 $ のスライムを捕まえて飼う。 $ 1 $ 秒掛かる。 - 色 $ 2 $ のスライムを捕まえて飼う。 $ 2 $ 秒掛かる。 - 色 $ 3 $ のスライムを捕まえて飼う。 $ 3 $ 秒掛かる。 - 色 $ 4 $ のスライムを捕まえて飼う。 $ 4 $ 秒掛かる。

## 样例 #1

### 输入

```
2 10

1 100
```

### 输出

```
12
```

## 样例 #2

### 输入

```
3 10

100 1 100
```

### 输出

```
23
```

## 样例 #3

### 输入

```
4 10

1 2 3 4
```

### 输出

```
10
```



---

---
title: "[AGC012B] Splatter Painting"
layout: "post"
diff: 普及+/提高
pid: AT_agc012_b
tag: []
---

# [AGC012B] Splatter Painting

## 题目描述

[problemUrl]: https://atcoder.jp/contests/agc012/tasks/agc012_b

イカはグラフの頂点に色を塗るのが好きです。

$ 1 $ から $ N $ までの番号がついた $ N $ 個の頂点と $ M $ 本の辺からなる単純無向グラフが与えられます。 全ての頂点ははじめ、色 $ 0 $ で塗られています。$ i $ 番目の辺は頂点 $ a_i $ と頂点 $ b_i $ を双方向につなぐ長さ $ 1 $ の辺です。

イカはこのグラフに対して $ Q $ 回の操作を行いました。 $ i $ 回目の操作では、頂点 $ v_i $ から距離 $ d_i $ 以内にあるような頂点たち全ての色を色 $ c_i $ で上書きしました。

$ Q $ 回の操作後において、各頂点がどの色で塗られているか調べてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ M $ $ a_1 $ $ b_1 $ $ : $ $ a_{M} $ $ b_{M} $ $ Q $ $ v_1 $ $ d_1 $ $ c_1 $ $ : $ $ v_{Q} $ $ d_{Q} $ $ c_{Q} $

## 输出格式

答えを $ N $ 行に出力せよ。 $ i $ 行目では $ Q $ 回の操作後における頂点 $ i $ の色を出力せよ。

## 说明/提示

### 制約

- $ 1\ ≦\ N,M,Q\ ≦\ 10^5 $
- $ 1\ ≦\ a_i,b_i,v_i\ ≦\ N $
- $ a_i\ ≠\ b_i $
- $ 0\ ≦\ d_i\ ≦\ 10 $
- $ 1\ ≦\ c_i\ ≦10^5 $
- $ d_i,\ c_i $ いずれも整数
- 与えられるグラフに自己ループや多重辺は存在しない

### 部分点

- $ 1\ ≦\ N,M,Q\ ≦\ 2{,}000 $ を満たすデータセットに正解した場合は、部分点として $ 200 $ 点が与えられる。

### Sample Explanation 1

はじめ、各頂点は色 $ 0 $ で塗られています。 $ 1 $ 回目の操作により、頂点 $ 5,6 $ が色 $ 1 $ で塗られます。 $ 2 $ 回目の操作により、頂点 $ 1,2,3,4,5 $ が色 $ 2 $ で塗られます。 !\[2ab7e180230b159d42d35ea7e555b3b0.png\](https://atcoder.jp/img/agc012/2ab7e180230b159d42d35ea7e555b3b0.png)

### Sample Explanation 2

与えられるグラフは連結とは限りません。

## 样例 #1

### 输入

```
7 7

1 2

1 3

1 4

4 5

5 6

5 7

2 3

2

6 1 1

1 2 2
```

### 输出

```
2

2

2

2

2

1

0
```

## 样例 #2

### 输入

```
14 10

1 4

5 7

7 11

4 10

14 7

14 3

6 14

8 11

5 13

8 3

8

8 6 2

9 7 85

6 9 3

6 7 5

10 3 1

12 9 4

9 6 6

8 2 3
```

### 输出

```
1

0

3

1

5

5

3

3

6

1

3

4

5

3
```



---

---
title: "[AGC014C] Closed Rooms"
layout: "post"
diff: 普及+/提高
pid: AT_agc014_c
tag: []
---

# [AGC014C] Closed Rooms

## 题目描述

[problemUrl]: https://atcoder.jp/contests/agc014/tasks/agc014_c

高橋君は建物の中に閉じ込められてしまいました。

この建物は $ H $ 行 $ W $ 列に並んだ $ H×W $ 個の部屋からなり、上から $ i $ 行目、左から $ j $ 列目の部屋は $ (i,j) $ で表され、その部屋の状態は $ A_{i,j} $ で表されています。 $ A_{i,j}= $ `#` の場合は、この部屋は閉じられており、$ A_{i,j}= $ `.` の場合は、この部屋には自由に出入りできます。 そして、 $ A_{i,j}= $ `S` となる部屋が高橋君の今いる部屋です。ただし、高橋君が今いる部屋も自由に出入りできる部屋です。

また、$ 1 $ 行目、$ 1 $ 列目、$ H $ 行目、$ W $ 列目のいずれかに含まれる部屋は建物の外につながっており、 それ以外の各部屋 $ (i,j) $ は $ 4 $ つの部屋 $ (i-1,j) $ $ , $ $ (i+1,j) $ $ , $ $ (i,j-1) $ $ , $ $ (i,j+1) $ と隣接しています。

高橋君はこの建物から脱出するために魔法を使うことにしました。一回の魔法で高橋君は以下の操作ができます。

- 高橋君は今いる部屋から隣り合う部屋に移動することを $ K $ 回まで繰り返す。ただし、閉じられている部屋には移動することはできない。
- その後、閉じられている部屋を $ K $ 個まで選び、それらを開いた状態にする。それらの部屋は以降自由に出入りできるようになる。

ただし、これらの操作では、全く動かなかったり、閉じられている部屋があっても開かなかったりしてもよいです。

高橋君の目標は建物の外につながっている部屋のいずれかにたどり着くことです。そのために必要な魔法の回数の最小値を求めてください。

ただし、はじめに高橋君がいる部屋は建物の外とはつながっていないことが保証されています。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ H $ $ W $ $ K $ $ A_{1,1}A_{1,2} $...$ A_{1,W} $ : $ A_{H,1}A_{H,2} $...$ A_{H,W} $

## 输出格式

高橋君が必要な魔法の回数の最小値を出力せよ。

## 说明/提示

### 制約

- $ 3\ ≦\ H\ ≦\ 800 $
- $ 3\ ≦\ W\ ≦\ 800 $
- $ 1\ ≦\ K\ ≦\ H×W $
- $ A_{i,j} $ は `#` , `.` , `S` のいずれかである。
- $ A_{i,j}= $ `S` となる $ (i,j) $ は一意に存在し、$ 2\ ≦\ i\ ≦\ H-1\ ,\ 2\ ≦\ j\ ≦\ W-1 $ を満たす。

### Sample Explanation 1

高橋君は最初の魔法で部屋 $ (1,2) $ に移動することができるので、$ 1 $ 回の魔法で十分です。

### Sample Explanation 2

高橋君は最初の魔法では移動することができないですが、部屋 $ (1,2) $ を $ 1 $ 回目の魔法で開けることができます。 そして、次の魔法で部屋 $ (1,2) $ に移動することで、$ 2 $ 回の魔法で目標を達成できます。

## 样例 #1

### 输入

```
3 3 3

#.#

#S.

###
```

### 输出

```
1
```

## 样例 #2

### 输入

```
3 3 3

###

#S#

###
```

### 输出

```
2
```

## 样例 #3

### 输入

```
7 7 2

#######

#######

##...##

###S###

##.#.##

###.###

#######
```

### 输出

```
2
```



---

---
title: "[AGC016C] +/- Rectangle"
layout: "post"
diff: 普及+/提高
pid: AT_agc016_c
tag: []
---

# [AGC016C] +/- Rectangle

## 题目描述

[problemUrl]: https://atcoder.jp/contests/agc016/tasks/agc016_c

整数 $ H $, $ W $, $ h $, $ w $ ($ 1\ <\ =\ h\ <\ =\ H $, $ 1\ <\ =\ w\ <\ =\ W $) が与えられます。 次の条件がすべて成り立つような行列が存在するか判定し、存在するならばひとつ構成してください。

- 行列は $ H $ 行 $ W $ 列である。
- 行列の各要素は $ -10^9 $ 以上 $ 10^9 $ 以下の整数である。
- 行列の全要素の総和は正の値である。
- どこから $ h $ 行 $ w $ 列の部分長方形を取り出しても、部分長方形に含まれる全要素の総和は負の値である。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ H $ $ W $ $ h $ $ w $

## 输出格式

条件がすべて成り立つような行列が存在しないならば、`No` を出力せよ。

存在するならば、$ 1 $ 行目に `Yes` を出力し、$ 2 $ 行目以降に行列をひとつ出力せよ。 行列は以下の形式で出力せよ。 ただし、$ a_{ij} $ は行列の $ (i,\ j) $ 要素を表す。

> $ a_{11} $ $ ... $ $ a_{1W} $ $ : $ $ a_{H1} $ $ ... $ $ a_{HW} $

## 说明/提示

### 制約

- $ 1\ <\ =\ h\ <\ =\ H\ <\ =\ 500 $
- $ 1\ <\ =\ w\ <\ =\ W\ <\ =\ 500 $

### Sample Explanation 1

行列の全要素の総和は $ 4 $ であり、正の値です。 また、部分長方形を取り出す方法は次図の $ 4 $ 通りですが、どの場合も、部分長方形に含まれる全要素の総和は $ -1 $ であり、負の値です。 !\[bbdb651fa1f05996886da9f0c4d8090a.png\](https://atcoder.jp/img/agc016/bbdb651fa1f05996886da9f0c4d8090a.png)

## 样例 #1

### 输入

```
3 3 2 2
```

### 输出

```
Yes

1 1 1

1 -4 1

1 1 1
```

## 样例 #2

### 输入

```
2 4 1 2
```

### 输出

```
No
```

## 样例 #3

### 输入

```
3 4 2 3
```

### 输出

```
Yes

2 -5 8 7

3 -5 -4 -5

2 1 -1 7
```



---

---
title: "[AGC020B] Ice Rink Game"
layout: "post"
diff: 普及+/提高
pid: AT_agc020_b
tag: []
---

# [AGC020B] Ice Rink Game

## 题目描述

[problemUrl]: https://atcoder.jp/contests/agc020/tasks/agc020_b

スケートリンクで、一人の大人の司会と $ N $ 人の子供がゲームを行います。 ゲームは $ K $ ラウンドからなり、ラウンド $ i $ では司会が次のように言います。

- $ A_i $ 人組を作って！

すると、まだ脱落していない子供たちは $ A_i $ 人からなるグループをできるだけ多く組みます。 一人につき一つのグループにしか入れません。 グループに入れなかった子供たちは脱落し、その他は次のラウンドに進みます。 ラウンドで誰も脱落しないこともありえます。

最後まで、つまりラウンド $ K $ のあとまで残ったのは $ 2 $ 人で、彼らが勝者となりました。

あなたは $ A_1 $, $ A_2 $, ..., $ A_K $ の値を聞き、$ N $ の値は知りませんが、推定してみたくなりました。

ゲームの開始前にいた子供たちの人数として考えられる最小の値と、最大の値を求めてください。もしくは、考えられる $ N $ の値は存在しないと判定してください。

## 输入格式

入力は標準入力から以下の形式で与えられる。

> $ K $ $ A_1 $ $ A_2 $ $ ... $ $ A_K $

## 输出格式

考えられる最小の $ N $ の値と最大の $ N $ の値をそれぞれ表す二つの整数を出力せよ。ただし、問題文で述べた状況が発生しえない場合は、整数 $ -1 $ を単独で出力せよ。

## 说明/提示

### 制約

- $ 1\ \leq\ K\ \leq\ 10^5 $
- $ 2\ \leq\ A_i\ \leq\ 10^9 $
- 入力値はすべて整数である。

### Sample Explanation 1

例えば、ゲームの開始時に子供が $ 6 $ 人いた場合、以下のように進行します。 - ラウンド $ 1 $ では、$ 6 $ 人の子供たちが $ 3 $ 人組を $ 2 $ つ作り、誰も脱落しません。 - ラウンド $ 2 $ では、$ 6 $ 人の子供たちが $ 4 $ 人組を $ 1 $ つ作り、$ 2 $ 人が脱落します。 - ラウンド $ 3 $ では、$ 4 $ 人の子供たちが $ 3 $ 人組を $ 1 $ つ作り、$ 1 $ 人が脱落します。 - ラウンド $ 4 $ では、$ 3 $ 人の子供たちが $ 2 $ 人組を $ 1 $ つ作り、$ 1 $ 人が脱落します。 最後まで残った二人が勝者となります。

### Sample Explanation 2

このような状況はありえません。 特に、ゲームの開始時の子供たちの人数が $ 100 $ 人未満の場合は、ラウンド $ 3 $ で全員が脱落します。

## 样例 #1

### 输入

```
4

3 4 3 2
```

### 输出

```
6 8
```

## 样例 #2

### 输入

```
5

3 4 100 3 2
```

### 输出

```
-1
```

## 样例 #3

### 输入

```
10

2 2 2 2 2 2 2 2 2 2
```

### 输出

```
2 3
```



---

---
title: "[AGC023B] Find Symmetries"
layout: "post"
diff: 普及+/提高
pid: AT_agc023_b
tag: []
---

# [AGC023B] Find Symmetries

## 题目描述

Snuke 有两块板子。每块板都是一个 $n$ 行 $n$ 列的网格。对于这两块板子，记第 $i$ 行 $j$ 列的格子为 $(i,j)$。

第一块板子的每个格子上都写着一个小写字母：格子 $(i,j)$ 上的字母为 $S_{i,j}$。第二块板子上没有写任何东西。

Snuke 将以以下方法在第二块板子上写下字母：

首先，选择两个整数 $A$，$B$；然后在第二块板子的每个格子上写下一个字母。具体的说，第二块板子的格子 $(i+A,j+B)$ 将写上 $S_{i,j}$。这里第 $n+k$ 行即第 $k$ 行，第 $n+k$ 列即为第 $k$ 列。

此操作后，若对任意的 $i,j$，第二块板的格子 $(j,i)$ 上的字母和格子 $(i,j)$ 上的字母相同，则称第二块板为“好板”。

请你求出有多少 $A,B$ 满足 $0\le A,B<n$，且经过上述操作后第二块板为“好板”。

## 输入格式

输入来自以下格式的标准输入：

$\boxed{\begin{matrix}n\\
S_{1,1}S_{1,2}\dots S_{1,n}\\
S_{2,1}S_{2,2}\dots S_{2,n}\\
\vdots\\
S_{n,1}S_{n,2}\dots S_{n,n}\end{matrix}}$

## 输出格式

输出一个数，表示有多少 $A,B$ 满足 $0\le A,B<n$，且经过上述操作后第二块板为“好板”。

## 说明/提示

- $1\le n\le 300$。
- $S_{i,j}$ 都是小写字母。

#### 样例解释：

对于样例 1：对于所有可能的 $A$ 和 $B$，二号板上的字母如下所示：

![](https://img.atcoder.jp/agc023/2414e26dc3abb6dd7bfa0c800bb4af0c.png)

当且仅当 $(A,B)=(0,1)$ 或 $(A,B)=(1,0)$ 时满足第二块板是“好板”，因此答案是 $22$。

对于样例 2，所有被选中的 $A$ 和 $B$ 都会使第二块板成为“好板”。

对于样例 3，没有 $A$ 和 $B$ 可以使第二块板成为“好板”。

## 样例 #1

### 输入

```
2

ab

ca
```

### 输出

```
2
```

## 样例 #2

### 输入

```
4

aaaa

aaaa

aaaa

aaaa
```

### 输出

```
16
```

## 样例 #3

### 输入

```
5

abcde

fghij

klmno

pqrst

uvwxy
```

### 输出

```
0
```



---

---
title: "[AGC024B] Backfront"
layout: "post"
diff: 普及+/提高
pid: AT_agc024_b
tag: []
---

# [AGC024B] Backfront

## 题目描述

[problemUrl]: https://atcoder.jp/contests/agc024/tasks/agc024_b

$ 1 $ 以上 $ N $ 以下の整数を並び替えてできる数列 $ (P_1,P_2,...,P_N) $ が与えられます。 次の操作を繰り返してこの列を昇順に並び替えるとき、操作の回数の最小値を求めてください。

- 数列の要素を $ 1 $ つ選び、その要素を列の先頭または末尾のうち好きなほうに移動する

なお、この操作によって与えられた列を昇順に並び替えられることは証明できます。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ P_1 $ $ : $ $ P_N $

## 输出格式

操作の回数の最小値を出力せよ。

## 说明/提示

### 制約

- $ 1\ \leq\ N\ \leq\ 2\times\ 10^5 $
- $ (P_1,P_2,...,P_N) $ は $ (1,2,...,N) $ の並び替えである
- 入力はすべて整数である

### Sample Explanation 1

例えば、以下の操作によって列を昇順に並び替えることができます。 - $ 2 $ を先頭に移動する。新しい数列は $ (2,1,3,4) $ となる。 - $ 1 $ を先頭に移動する。新しい数列は $ (1,2,3,4) $ となる。

## 样例 #1

### 输入

```
4

1

3

2

4
```

### 输出

```
2
```

## 样例 #2

### 输入

```
6

3

2

5

1

4

6
```

### 输出

```
4
```

## 样例 #3

### 输入

```
8

6

3

1

2

7

4

8

5
```

### 输出

```
5
```



---

---
title: "[AGC024C] Sequence Growing Easy"
layout: "post"
diff: 普及+/提高
pid: AT_agc024_c
tag: []
---

# [AGC024C] Sequence Growing Easy

## 题目描述

[problemUrl]: https://atcoder.jp/contests/agc024/tasks/agc024_c

長さ $ N $ の数列 $ X $ があり、最初はすべての要素が $ 0 $ です。$ X $ の $ i $ 項目を $ X_i $ で表すことにします。

長さ $ N $ の数列 $ A $ が与えられます。$ A $ の $ i $ 項目は $ A_i $ です。 以下の操作を繰り返すことで $ X $ を $ A $ と等しくすることができるかどうか判定し、できるなら最小の操作回数を求めてください。

- $ 1\leq\ i\leq\ N-1 $ なる整数 $ i $ を選ぶ。$ X_{i+1} $ の値を $ X_i $ の値に $ 1 $ を足したもので置き換える。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ A_1 $ $ : $ $ A_N $

## 输出格式

操作を繰り返すことで $ X $ を $ A $ と等しくすることができるなら最小の操作回数を、できないなら $ -1 $ を出力せよ。

## 说明/提示

### 制約

- $ 1\ \leq\ N\ \leq\ 2\ \times\ 10^5 $
- $ 0\ \leq\ A_i\ \leq\ 10^9(1\leq\ i\leq\ N) $
- 入力はすべて整数である

### Sample Explanation 1

次のようにして、$ X $ を $ A $ と等しくすることができます。 - $ i=2 $ に対して操作する。$ X $ は $ (0,0,1,0) $ となる。 - $ i=1 $ に対して操作する。$ X $ は $ (0,1,1,0) $ となる。 - $ i=3 $ に対して操作する。$ X $ は $ (0,1,1,2) $ となる。

## 样例 #1

### 输入

```
4

0

1

1

2
```

### 输出

```
3
```

## 样例 #2

### 输入

```
3

1

2

1
```

### 输出

```
-1
```

## 样例 #3

### 输入

```
9

0

1

1

0

1

2

2

1

2
```

### 输出

```
8
```



---

---
title: "[AGC025B] RGB Coloring"
layout: "post"
diff: 普及+/提高
pid: AT_agc025_b
tag: []
---

# [AGC025B] RGB Coloring

## 题目描述

[problemUrl]: https://atcoder.jp/contests/agc025/tasks/agc025_b

高橋君はタワーを $ 1 $ つ持っており、それは $ N $ 個のブロックが縦一列に重なって構成されています。 はじめすべてのブロックは無色ですが、高橋君はいくつかのブロックを赤色、緑色、青色のいずれかの色で塗ることで、 タワーを美しくしようとしています。そこで、高橋君は *タワーの美しさ* を以下のように定義することにしました。

- 各ブロックの得点を、赤色に塗られていれば $ A $ 点、緑色に塗られていれば $ A+B $ 点、青色に塗られていれば $ B $ 点、無色ならば $ 0 $ 点として、 $ N $ 個のブロックの得点の合計をタワーの美しさとする。

ただし、$ A,B $ はあらかじめ与えられる正整数の定数であり、各マスが $ 2 $ つ以上の色で同時に塗られることがないことにも注意してください。

高橋君はタワーの美しさがちょうど $ K $ になるようにブロックを塗ろうと考えています。 そのようにタワーを塗る方法は何通りあるでしょうか。 $ 998244353 $ で割った余りを求めてください。 ただし、$ 2 $ つのタワーを塗る方法が異なるとは、あるブロックが存在し、そのブロックに塗られている色が異なること、もしくは、そのブロックが一方では塗られているが、 他方では無色であることを指します。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ A $ $ B $ $ K $

## 输出格式

タワーを塗る方法の個数を $ 998244353 $ で割った余りを出力せよ。

## 说明/提示

### 制約

- $ 1\ ≦\ N\ ≦\ 3×10^5 $
- $ 1\ ≦\ A,B\ ≦\ 3×10^5 $
- $ 0\ ≦\ K\ ≦\ 18×10^{10} $
- 入力される値は全て整数である

### Sample Explanation 1

この場合、赤色 $ 1 $ つにつき $ 1 $ 点、緑色 $ 1 $ つにつき $ 3 $ 点、青色 $ 1 $ つにつき $ 2 $ 点なので、美しさが $ 5 $ になるのは、 - 緑色 $ 1 $ つ、青色 $ 1 $ つ - 赤色 $ 1 $ つ、青色 $ 2 $ つ - 赤色 $ 2 $ つ、緑色 $ 1 $ つ - 赤色 $ 3 $ つ、青色 $ 1 $ つ のいずれかの場合だけです。よって、求める答えは $ 40 $ になります。

### Sample Explanation 2

美しさが $ 0 $ であるタワーは、すべてのブロックが無色であるものだけです。よって、答えは $ 1 $ になります。

## 样例 #1

### 输入

```
4 1 2 5
```

### 输出

```
40
```

## 样例 #2

### 输入

```
2 5 6 0
```

### 输出

```
1
```

## 样例 #3

### 输入

```
90081 33447 90629 6391049189
```

### 输出

```
577742975
```



---

---
title: "[AGC026B] rng_10s"
layout: "post"
diff: 普及+/提高
pid: AT_agc026_b
tag: []
---

# [AGC026B] rng_10s

## 题目描述

[problemUrl]: https://atcoder.jp/contests/agc026/tasks/agc026_b

コンビニエンスストアのりんごマートでは，りんごジュースを販売しています。

りんごマートはある日の朝に開店し，その時にはジュースの在庫が $ A $ 本ありました。 すぬけ君は毎日昼にりんごマートでジュースを $ B $ 本買います。 りんごマートでは毎日夜にジュースの在庫を確認し，$ C $ 本以下だった場合，次の日の朝までに $ D $ 本在庫を追加します。

すぬけ君がジュースを永遠に買い続けられるかを判定して下さい。 つまり，ジュースを買おうとした時，必ず在庫が $ B $ 本以上あるかどうかを判定して下さい。 すぬけ君以外がジュースを買うことはありません。

また，今回の問題では入力ケースは $ T $ 個のクエリからなります。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ T $ $ A_1 $ $ B_1 $ $ C_1 $ $ D_1 $ $ A_2 $ $ B_2 $ $ C_2 $ $ D_2 $ $ : $ $ A_T $ $ B_T $ $ C_T $ $ D_T $

$ i $ 個目のクエリにおいては，$ A\ =\ A_i,\ B\ =\ B_i,\ C\ =\ C_i,\ D\ =\ D_i $ である。

## 输出格式

$ T $ 行出力せよ。$ i $ 行目には，$ i $ 個目のクエリですぬけ君が永遠にりんごジュースを買い続けられる場合 `Yes`，そうでない場合 `No` と出力せよ。

## 说明/提示

### 制約

- $ 1\ \leq\ T\ \leq\ 300 $
- $ 1\ \leq\ A,\ B,\ C,\ D\ \leq\ 10^{18} $
- 入力される値は全て整数である

### Sample Explanation 1

$ 1 $ 個目のクエリでは在庫の個数は以下のように変動します。 $ 9 $ →昼 $ 2 $ →夜 $ 11 $ →昼 $ 4 $ →夜 $ 13 $ →昼 $ 6 $ →夜 $ 6 $ →昼 x $ 2 $ 個目のクエリでは在庫の個数は以下のように変動します。 $ 9 $ →昼 $ 2 $ →夜 $ 11 $ →昼 $ 4 $ →夜 $ 13 $ →昼 $ 6 $ →夜 $ 15 $ →昼 $ 8 $ →夜 $ 8 $ →昼 $ 1 $ →夜 $ 10 $ →昼 $ 3 $ →夜 $ 12 $ →昼 $ 5 $ →夜 $ 14 $ →昼 $ 7 $ →夜 $ 7 $ →昼 $ 0 $ →夜 $ 9 $ →昼 $ 2 $ →夜 $ 11 $ →昼 … と続いていき，このまま永遠に購入し続けられます。

## 样例 #1

### 输入

```
14

9 7 5 9

9 7 6 9

14 10 7 12

14 10 8 12

14 10 9 12

14 10 7 11

14 10 8 11

14 10 9 11

9 10 5 10

10 10 5 10

11 10 5 10

16 10 5 10

1000000000000000000 17 14 999999999999999985

1000000000000000000 17 15 999999999999999985
```

### 输出

```
No

Yes

No

Yes

Yes

No

No

Yes

No

Yes

Yes

No

No

Yes
```

## 样例 #2

### 输入

```
24

1 2 3 4

1 2 4 3

1 3 2 4

1 3 4 2

1 4 2 3

1 4 3 2

2 1 3 4

2 1 4 3

2 3 1 4

2 3 4 1

2 4 1 3

2 4 3 1

3 1 2 4

3 1 4 2

3 2 1 4

3 2 4 1

3 4 1 2

3 4 2 1

4 1 2 3

4 1 3 2

4 2 1 3

4 2 3 1

4 3 1 2

4 3 2 1
```

### 输出

```
No

No

No

No

No

No

Yes

Yes

No

No

No

No

Yes

Yes

Yes

No

No

No

Yes

Yes

Yes

No

No

No
```



---

---
title: "[AGC027C] ABland Yard"
layout: "post"
diff: 普及+/提高
pid: AT_agc027_c
tag: []
---

# [AGC027C] ABland Yard

## 题目描述

[problemUrl]: https://atcoder.jp/contests/agc027/tasks/agc027_c

$ N $ 頂点 $ M $ 本の辺からなる無向グラフが与えられます。 頂点には $ 1 $ から $ N $ の番号が、辺には $ 1 $ から $ M $ の番号がついています。 頂点には番号以外に `A` か `B` のラベルがついており、頂点 $ i $ には $ s_i $ のラベルがついています。

辺 $ i $ は頂点 $ a_i $ と $ b_i $ を双方向につなぐ辺です。

怪盗ヌスークは好きな頂点を始点として選び、そこから $ 0 $ 回以上辺を辿って移動するのが好きです。 今日は移動後に、訪れた頂点についているラベルを始点から訪問した順に並べて文字列を作ることにしました。

例えば、頂点 $ 1 $ にラベル `A` が、頂点 $ 2 $ にラベル `B` がついているグラフにおいて、ヌスークが $ 1\ \rightarrow\ 2\ \rightarrow\ 1\ \rightarrow\ 2\ \rightarrow\ 2 $ と移動した場合、`ABABB` が作られます。

怪盗ヌスークが文字 `A`,`B` のみからなる任意の文字列が作れるかどうかを判定してください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ M $ $ s $ $ a_1 $ $ b_1 $ $ : $ $ a_{M} $ $ b_{M} $

## 输出格式

ヌスークが文字 `A`,`B` のみからなる任意の文字列が作ることが可能なら `Yes` を、そうでなければ `No` を出力せよ。

## 说明/提示

### 制約

- $ 2\ \leq\ N\ \leq\ 2\ \times\ 10^{5} $
- $ 1\ \leq\ M\ \leq\ 2\ \times\ 10^{5} $
- $ |s|\ =\ N $
- $ s_i $ は `A` または `B`
- $ 1\ \leq\ a_i,\ b_i\ \leq\ N $
- 与えられるグラフは単純とも連結とも限らない

### Sample Explanation 1

\- ヌスークは頂点 $ 1 $ と頂点 $ 2 $ を自由に訪れることができるため、`A`,`B` のみからなる任意の文字列が作ることが可能です !\[77e96cf8e213d606ddd8f3c3f8315d32.png\](https://img.atcoder.jp/agc027/77e96cf8e213d606ddd8f3c3f8315d32.png)

### Sample Explanation 2

\- 例えば、`BB` を作ることができません - 与えられるグラフは連結とは限りません !\[1ab1411cb9d6ee023d14ca4e77c4b584.png\](https://img.atcoder.jp/agc027/1ab1411cb9d6ee023d14ca4e77c4b584.png)

## 样例 #1

### 输入

```
2 3

AB

1 1

1 2

2 2
```

### 输出

```
Yes
```

## 样例 #2

### 输入

```
4 3

ABAB

1 2

2 3

3 1
```

### 输出

```
No
```

## 样例 #3

### 输入

```
13 23

ABAAAABBBBAAB

7 1

10 6

1 11

2 10

2 8

2 11

11 12

8 3

7 12

11 2

13 13

11 9

4 1

9 7

9 6

8 13

8 6

4 10

8 7

4 3

2 1

8 12

6 9
```

### 输出

```
Yes
```

## 样例 #4

### 输入

```
13 17

BBABBBAABABBA

7 1

7 9

11 12

3 9

11 9

2 1

11 5

12 11

10 8

1 11

1 8

7 7

9 10

8 8

8 12

6 2

13 11
```

### 输出

```
No
```



---

---
title: "[AGC029B] Powers of two"
layout: "post"
diff: 普及+/提高
pid: AT_agc029_b
tag: []
---

# [AGC029B] Powers of two

## 题目描述

[problemUrl]: https://atcoder.jp/contests/agc029/tasks/agc029_b

高橋君は正整数が書かれたボールを $ N $ 個持っています。$ i $ 番目のボールに書かれている正整数は $ A_i $ です。 高橋君は $ N $ 個のボールからいくつかのペアを作って、それぞれのペアのボールに書かれた数の和が $ 2 $ べきとなるようにしたいです。 ただし、同じボールが複数のペアに属することはできません。 最大でいくつのペアが作れるか求めてください。

ただし、正整数が $ 2 $ べきであるとは、ある非負整数 $ t $ を用いて $ 2^t $ と書けることを指します。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ A_1 $ $ A_2 $ $ ... $ $ A_N $

## 输出格式

$ 2 $ つのボールに書かれた数の和が $ 2 $ べきとなるペアの個数として考えられる最大値を出力せよ。

## 说明/提示

### 制約

- $ 1\ \leq\ N\ \leq\ 2\times\ 10^5 $
- $ 1\ \leq\ A_i\ \leq\ 10^9 $
- $ A_i $ は整数

### Sample Explanation 1

$ 1 $ 番目のボールと $ 3 $ 番目のボールをペアにすることで、書かれた数の和が $ 4 $ となるペアを $ 1 $ つ作ることができます。 $ 2 $ 番目のボール同士をペアにできないことに注意してください。

## 样例 #1

### 输入

```
3

1 2 3
```

### 输出

```
1
```

## 样例 #2

### 输入

```
5

3 11 14 5 13
```

### 输出

```
2
```



---

---
title: "Nearest Card Game"
layout: "post"
diff: 普及+/提高
pid: AT_aising2019_d
tag: []
---

# Nearest Card Game

## 题目描述

## 题面描述
现在高桥和青木有N张卡片，每张卡片上有一个整数 $ A_i $ ，并且**任意2张卡片**上的整数都不相同

高桥和青木决定用这些卡玩下面这个游戏：

- 首先青木决定了一个整数 $ x $ 。
- **从高桥开始**，每人轮流拿一张卡。此时，取的卡如下选择。
	- 高桥取**剩下**的卡片中写的整数**最大**的卡片。
	- 青木取**剩下**的卡片中写的整数**最接近** $ x $ 的卡片。但是，在有多张这样的卡的情况下，取它们中写的整数**最小**的卡。
	- 剩下的卡数量为零（也就是全被拿走了）时游戏结束。

对于 $ x $ 的值，你将获得 $ Q $ 个候选值：$ X_1,\ X_2,\ ...,\ X_Q $ 。对于每个 $ i $ （ $ 1\ \leq\ i\ \leq\ Q $ ），请找出**当青木所选的 $ x $ 值为 $ X_i $ 时**，高桥所选的所有卡片上整数的和。

## 输入格式

```
 $ N $   $ Q $ 
 $ A_1 $   $ A_2 $   $ ... $   $ A_N $ 
 $ X_1 $ 
 $ X_2 $ 
 $ : $ 
 $ X_Q $ 
```

## 输出格式

输出 $ Q $ 行，第 $ i $ （ $ 1\ \leq\ i\ \leq\ Q $ ）行应该包含 $ x $ = $ X_i $ 的答案

## 样例 #1

### 输入

```
5 5

3 5 7 11 13

1

4

9

10

13
```

### 输出

```
31

31

27

23

23
```

## 样例 #2

### 输入

```
4 3

10 20 30 40

2

34

34
```

### 输出

```
70

60

60
```



---

---
title: "Anything Goes to Zero"
layout: "post"
diff: 普及+/提高
pid: AT_aising2020_d
tag: []
---

# Anything Goes to Zero

## 题目描述

# 任何东西都会归零
[problemUrl]: https://atcoder.jp/contests/aising2020/tasks/aising2020_d
定义 $ \mathrm{popcount}(n) $ 为 $ n $ 在二进制表示中 '1' 的个数。例如，$ \mathrm{popcount}(3)\ =\ 2,\ \mathrm{popcount}(7)\ =\ 3,\ \mathrm{popcount}(0)\ =\ 0 $。
定义 $ f(n) $ 为将 $ n $ 用 $ \mathrm{popcount}(n) $ 除后取余数替换 $ n $ 的操作次数，直到 $ n $ 变为 $ 0 $ 为止（在这个问题的约束下，可以证明 $ n $ 经过有限次操作后一定会变为 $ 0 $）。
以下是以 $ n=7 $ 为例，经过 2 次操作 $ n $ 变为 0 的过程。
- 因为 $ \mathrm{popcount}(7)=3 $，所以用 3 除 7 后的余数 1 替换 7。
- 因为 $ \mathrm{popcount}(1)=1 $，所以用 1 除 1 后的余数 0 替换 1。
给定一个二进制表示的 $ N $ 位整数 $ X $。对于满足 $ 1\ \leq\ i\ \leq\ N $ 的整数 $ i $，定义将 $ X $ 的第 $ i $ 位取反后的整数为 $ X_i $。求 $ f(X_1),\ f(X_2),\ \ldots,\ f(X_N) $。

## 输入格式

输入从标准输入中以以下形式给出。
> $ N $ $ X $

## 输出格式

输出 $ N $ 行。第 $ i $ 行输出 $ f(X_i) $ 的值。
## 样例 #1
### 样例输入 #1
```
3
011
```
### 样例输出 #1
```
2
1
1
```
## 样例 #2
### 样例输入 #2
```
23
00110111001011011001110
```
### 样例输出 #2
```
2
1
2
2
1
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
1
3
```

## 说明/提示

### 制約
- $ 1\ \leq\ N\ \leq\ 2\ \times\ 10^5 $
- $ X $ 是二进制表示的 $ N $ 位的整数（首位不一定是 '1'）
### 样例解释 #1
- $ X_1 $ 是 7。因为 7 变为 1 再变为 0，所以 $ f(7) = 2 $。
- $ X_2 $ 是 1。因为 1 变为 0，所以 $ f(1) = 1 $。
- $ X_3 $ 是 2。因为 2 变为 0，所以 $ f(2) = 1 $。

## 样例 #1

### 输入

```
3

011
```

### 输出

```
2

1

1
```

## 样例 #2

### 输入

```
23

00110111001011011001110
```

### 输出

```
2

1

2

2

1

2

2

2

2

2

2

2

2

2

2

2

2

2

2

2

2

1

3
```



---

---
title: "[ARC003C] 暗闇帰り道"
layout: "post"
diff: 普及+/提高
pid: AT_arc003_3
tag: []
---

# [ARC003C] 暗闇帰り道

## 题目描述

## 漆黑归家路



高桥君一个人走夜路从学校回家。



他所居住的城市是一个被分为小格的长方形。高桥君一秒只能向东、南、西、北方向移动一格。



输入给出格子$i,j$的阳光值$c_i,_j$，$t$秒时，该格子的明亮度为$0.99^t×c_i,_j$$（出发时间为$0$秒）。



从学校回到家的路径明亮度为路线所经格子的明亮度的**最小值**。



高桥君有黑暗恐惧症，会尽可能地选择**明亮度大**的路径。



请求出他回家路径中的最大明亮度。

## 输入格式

第$1$行为空格隔开的$N$,$M$,第$2-N+1$行是一个$N×M$的矩阵。格子的状态用```s```,```g```,```1```-```9```,```#```来表示。



第$i$行的第$j$个字母$c_i,_j$ 表示格子$i,j$的状态。



- ```s``` 学校的位置。

- ```g``` 家的位置。

- ```1```-```9``` 该格的阳光值。

- ```#``` 此路不通。

- 高桥君无法走出城市外。

- ```s```,```g```唯一且不相邻。

## 输出格式

输出的第一行为所求的最大明亮度，若路径不存在则输出```-1```，答案的相对误差控制在```1e-9```以内，请在末尾输出换行。



样例1



输入

```

3 3

s52

743

32g

```



输出



```

2.910897

```

## 说明/提示

- 時刻0: 从学校$(1,1)$出发。

- 時刻1: 移动到$(2,1) $。时间 $t=1$, 阳光值$=7$ 、$(2,1)$ 的明亮度为$6.93$。

- 時刻2: 移动到$(2,2)$ 。时间 $t=2$, 阳光值$=4$ 、$(2,2)$的明亮度为$3.9204$。

- 時刻3: 移动到$(2,3)$ 。时间 $t=3$, 阳光值$=3$、$(2,3)$的明亮度为$2.910897$。

- 時刻4: 回到家$(3,3)$了 。当前最小的明亮值是时间 $t=3$时的$(2,3)$的明亮度为$2.910897$，答案也就是$2.910897$。

![样例1](https://cdn.luogu.org/upload/pic/39444.png)



样例2



输入

```

4 6

g31784

621415

627914

7451s3

```



输出



```

2.97

```



![样例2](https://cdn.luogu.org/upload/pic/39446.png)



不需要解释。



---

---
title: "[ARC006D] アルファベット探し"
layout: "post"
diff: 普及+/提高
pid: AT_arc006_4
tag: []
---

# [ARC006D] アルファベット探し

## 题目描述

在长为H，宽为W的矩阵中，可以用黑格子组成一些字母。



例如图1



![图1](https://cdn.luogu.com.cn/upload/image_hosting/8yah7syy.png)

图1（用7*7的格子分别组成了A，B，C）



矩阵中只能由黑格组成A，B，C字母，并且将A，B，C分别放大或缩小后的图案以及将3个字母分别旋转90°后的图案都算A，B，C的相同形状。



例如图2



![图2](https://cdn.luogu.com.cn/upload/image_hosting/zb1lce1g.png)



图2（以上字母均为合法字母，并分别属于A，B，C）



设这个字母最长的长为h，最长的宽为w，则该字母所占的矩阵大小为：（h+1）*（w+1）



如果两个字母的矩阵相互重叠，则两个字母均为不合法。



例如图3



![图3](https://cdn.luogu.com.cn/upload/image_hosting/v3hirerx.png)



图3（因为两个A所占的矩阵有重叠部分，所以均为不合法）



现在给出H*W的矩阵，分别求其中A，B，C 3个字母的个数。

## 输入格式

第一行两个整数H，W



接下来输入H*M大小的矩阵，由"o"和"."组成。



"o"代表黑块，可以算作字母的一部分。



"."代表白块，不能算作字母的一部分

## 输出格式

分别输出矩阵中所含的合法的A，B，C个数。中间用空格隔开。



---

---
title: "[ARC008C] THE☆たこ焼き祭り2012"
layout: "post"
diff: 普及+/提高
pid: AT_arc008_3
tag: []
---

# [ARC008C] THE☆たこ焼き祭り2012

## 题目描述

[problemUrl]: https://atcoder.jp/contests/arc008/tasks/arc008_3

 たこ焼き屋の開店にあたって、たこ焼きの味を皆に分かってもらうために試食イベントを行うことにしました。  
 しかし、高橋社長はたこ焼きをより多くの人に食べてもらいたいので、試食イベントを兼ねたお祭り『THE☆たこ焼き祭り2012』をすることを提案してきました。高橋社長が提案してきた『THE☆たこ焼き祭り2012』の試食イベント内容は以下のようになっています。

 会場にはあなたと参加者を足して $ N $ 人の人がいます。あなたはたこ焼きを $ N $ 個持っており、それを全員に $ 1 $ 人 $ 1 $ 個ずつ行き渡るようにします。  
 会場は広いのであなたはたこ焼きを投げて配らないといけません。 あなただけで全員に配ることは大変なので、参加者にも協力してもらうことにし、参加者は受け取ったたこ焼きを別の参加者へと投げることもできます。  
 あなたと参加者はつまようじを$ 1 $ 人につき $ 1 $ 本しか持っていないので同じタイミングで複数のたこ焼きを投げることはできず、たこ焼きを投げてから $ 1 $ 秒間は次のたこ焼きを投げることができません。受け取る側はいつでも何個でも受け取ることができます。  
 さらに、あなたと参加者は立っている位置から動いてはいけません。  
 参加者は大人から子供までいるのでそれぞれにはたこ焼きをキャッチできる速度の上限があり、たこ焼きを投げる側にも投げられる速度の上限があります。投げられたたこ焼きの速度は減衰することなく受け取り手に届きます。

 たこ焼きはなるべく出来立てを食べて欲しいので、たこ焼きを全員に配り切るために必要な時間の最小値を答えなさい。

 入力は以下の形式で標準入力から与えられる。 > $ N $ $ x_{0} $ $ y_{0} $ $ t_{0} $ $ r_{0} $ $ x_{1} $ $ y_{1} $ $ t_{1} $ $ r_{1} $ : : $ x_{N-1} $ $ y_{N-1} $ $ t_{N-1} $ $ r_{N-1} $

- 入力は $ N+1 $ 行ある。
- $ 1 $ 行目には、たこ焼き祭りの参加者数とあなたを足した数を表す整数 $ N\ (1≦N≦1,000) $ が与えられる。
- $ 2 $ 行目には、あなたが立っている位置の $ x $ 座標を表す整数 $ x_0\ (-10,000≦x_0≦10,000) $、$ y $ 座標を表す整数 $ y_0\ (-10,000≦y_0≦10,000) $、たこ焼きを投げる速度の上限を表す整数 $ t_0\ (3≦t_0≦340) $ とたこ焼きを受け取る速度の上限を表す整数 $ r_0\ (3≦r_0≦340) $ が空白で区切られて与えられる。
- $ 3 $ 行目から $ N-1 $ 行のうち $ i+2\ (1≦i≦N-1) $ 行目には $ i $ 番目の参加者が立っている位置の $ x $ 座標を表す整数 $ x_i\ (-10,000≦x_i≦10,000) $、$ y $ 座標を表す整数 $ y_i\ (-10,000≦y_i≦10,000) $、たこ焼きを投げる速度の上限を表す整数 $ t_i\ (3≦t_i≦340) $ とたこ焼きを受け取る速度の上限を表す整数 $ r_i\ (3≦r_i≦340) $ が空白で区切られて与えられる。
- 与えられる速度は $ 1 $ 秒辺りの速度である。
- 複数の人が同じ位置に立つことはない。
 
 たこ焼きを全ての参加者が $ 1 $ つずつ受け取るためまでに必要な秒数の最小値を $ 1 $ 行で出力せよ。  
 出力は整数および小数のみとし、誤差は絶対誤差あるいは相対誤差の少なくとも片方が $ 10^{−6} $ 以下であれば許容する。  
 なお、最後には改行を出力せよ。 ```

4
0 0 300 10
0 100 10 100
0 200 10 200
0 300 10 300
```

 ```

3
```

- $ 0 $ 秒目 : 
  - あなた : $ 1 $ 番目の参加者に速度 $ 100 $ でたこ焼きを投げる。
- $ 1 $ 秒目 : 
  - あなた : $ 2 $ 番目の参加者に速度 $ 200 $ でたこ焼きを投げる。
  - $ 1 $ 番目の参加者 : あなたが $ 0 $ 秒目に投げたたこ焼きをキャッチする。
- $ 2 $ 秒目 : 
  - あなた : $ 3 $ 番目の参加者に速度 $ 300 $ でたこ焼きを投げる。
  - $ 2 $ 番目の参加者 : あなたが $ 1 $ 秒目に投げたたこ焼きをキャッチする。
- $ 3 $ 秒目 : 
  - $ 3 $ 番目の参加者 : あなたが $ 2 $ 秒目に投げたたこ焼きをキャッチする。
 
```

4
0 0 100 10
0 90 10 10
0 100 30 100
-20 100 10 10
```

 ```

3
```

- $ 0 $ 秒目 : 
  - あなた : $ 2 $ 番目の参加者に速度 $ 100 $ でたこ焼きを投げる。
- $ 1 $ 秒目 : 
  - あなた : $ 2 $ 番目の参加者に速度 $ 100 $ でたこ焼きを投げる。
  - $ 2 $ 番目の参加者 : あなたが $ 0 $ 秒目に投げたたこ焼きをキャッチし、$ 3 $ 番目の参加者に速度 $ 10 $ で投げる。
- $ 2 $ 秒目 : 
  - あなた : $ 2 $ 番目の参加者に速度 $ 100 $ でたこ焼きを投げる。
  - $ 2 $ 番目の参加者 : あなたが $ 1 $ 秒目に投げたたこ焼きをキャッチし、$ 2 $ 番目の参加者に速度 $ 10 $ で投げる。
- $ 3 $ 秒目 : 
  - $ 1 $ 番目の参加者 : $ 2 $ 番目の参加者が $ 2 $ 秒目に投げたたこ焼きをキャッチする。
  - $ 2 $ 番目の参加者 : あなたが $ 2 $ 秒目に投げたたこ焼きをキャッチする。
  - $ 3 $ 番目の参加者 : $ 2 $ 番目の参加者が $ 1 $ 秒目に投げたたこ焼きをキャッチする。
 
```

1
0 0 3 3
```

 ```

0
```

- 参加者があなただけなので配る必要がありません。
 
```

4
58 -49 38 109
45 -29 200 56
-32 123 103 98
49 -234 289 43
```

 ```

4.874179
```


```

8
100 100 30 50
100 50 93 123
100 0 89 111
50 100 13 18
50 0 155 86
0 100 30 58
0 50 58 49
0 0 98 153
```

 ```

7.666667
```



---

---
title: "[ARC011C] ダブレット"
layout: "post"
diff: 普及+/提高
pid: AT_arc011_3
tag: []
---

# [ARC011C] ダブレット

## 题目描述

你正在玩一个单词接龙游戏。

一个单词可以变换为另一个单词，当且仅当这两个单词恰有一个字母不同。

给定起始单词 $first$ 和目标单词 $last$，以及一个含有 $N$ 个单词的 **可重** 词集 $\{s_0,s_1,...,s_{N-1}\}$。请回答，在只使用词集中的词进行变换的情况下，从 $first$ 变换到 $last$ 最少需要多少步 **（所使用的词集中的词的个数）**，并给出一组方案。

特别地：

- 若 $first$ 和 $last$ 相同，则步数为 $0$；
- 若无法完成变换，仅输出一行 `-1` 即可；
- **若 $first$ 只经过一次变换即可得到 $last$，则步数也为 $0$。（这段话原题没写）**

## 输入格式

第一行输入两个单词 $first$ 和 $last$。

第二行输入一个正整数 $N$，表示词集大小。

第三行到第 $(N+2)$ 行，每行输入一个单词 $s_i$ 表示词集中的一个词。

## 输出格式

若无法完成变换，仅输出一行一个整数 `-1`。

否则，按如下格式输出：

- 第一行输出一个整数 $k$，表示中间词的个数；
- 接下来 $(k+2)$ 行，每行一个单词。这 $(k+2)$ 行展示的即为从 $first$ 变换至 $last$ 的一种可能的过程。

若有多解，输出任一解即可。

**输出末尾换行。**

### 输入输出样例

#### 输入 #1

```
eye lid
4
lie
die
did
dye
```

#### 输出 #1

```
3
eye
dye
die
lie
lid
```

#### 输入 #2

```
eye eye
4
lie
die
did
dye
```

#### 输出 #2

```
0
eye
eye
```

#### 输入 #3

```
eye lid
4
lie
lip
did
dye
```

#### 输出 #3

```
-1
```

## 说明/提示

- $1\le N\le 1\ 000$；
- 词集中可能含有重复的单词，也可能含有 $first$ 和 $last$；
- 输入的每个单词长度都相同，且该长度 $L$ 满足 $1\le L\le 30$；
- 每个单词仅由英文小写字母 `a-z` 构成。



---

---
title: "[ARC012C] 五目並べチェッカー"
layout: "post"
diff: 普及+/提高
pid: AT_arc012_3
tag: []
---

# [ARC012C] 五目並べチェッカー

## 题目描述

[problemUrl]: https://atcoder.jp/contests/arc012/tasks/arc012_3

高橋君は、五目並べが大好きです。  
 五目並べとは、 $ 19 $ × $ 19 $ の碁盤の上に交互に碁石を $ 1 $ つずつ並べ、 $ 5 $ つ以上の碁石が縦・横・ななめに並べたプレーヤーが勝ちとなってゲームが終了する、というルールのゲームです。  
 ゲームは必ず黒のプレーヤーから始めるものとします。  
 高橋君は、友達の青木君と五目並べをしていたのですが、うっかり居眠りをしてしまいました。  
 高橋君は寝ている間に青木君が不正をしたのではないかと疑っているので、盤面から五目並べの状態として異常なところがないかを探したいです。  
 五目並べの状態として、正常であるかどうか判定するプログラムを作ってください。  
 ここでの異常な状態とは、

- どちらかのプレーヤーの勝利条件を満たしているのに、もう片方のプレーヤーがさらに碁石を置いている。
- お互いが置いた個数がありえない状態になっている。
 
 のどちらかであることを指します。 入力は以下の形式で標準入力から与えられる。 > $ b_{1,1}\ b_{2,1}\ ‥‥\ b_{19,1} $ $ b_{1,2}\ b_{2,2}\ ‥‥\ b_{19,2} $ $ : $ $ : $ $ b_{1,19}\ b_{2,19}\ ‥‥\ b_{19,19} $

- 入力は $ 19 $ 行与えられる。
- $ i(1≦i≦19) $ 行目の $ j(1≦j≦19) $ 文字目には、盤面の縦 $ i $ 番目、横 $ j $ 番目のマスの情報を表す文字 $ b_{i,j} $ が与えられる。
- $ b_{i,j} $ は、`o`、`x`、`.` の $ 3 $ 種類のいずれかの文字である。 
  - `o` は、黒石が置かれていることを表す。
  - `x` は、白石が置かれていることを表す。
  - `.` は、何も置かれていないことを表す。


 盤面が正常な状態であれば、`YES`、そうでなければ `NO` と出力しなさい。   
 出力は標準出力におこない、末尾には改行をいれること。  
```

...................
...................
...................
...................
....x......o.......
...................
...................
.......o....o......
...................
........x..........
..............o....
...................
.......x...........
...................
...................
...................
...................
...................
...................
```

 ```

YES
```

- 黒が $ 4 $ 手、白が $ 3 $ 手打った状態です。
- （記述に誤りがありましたので、修正しました。）
 
```

...................
...................
...................
...................
....x......o.......
...................
...................
.......o....o......
...................
........x..........
..............o....
...................
.......x...........
...................
...................
.........o.........
...................
...................
...................
```

 ```

NO
```

- 黒が $ 5 $ 手、白が $ 3 $ 手打った状態です。
- 黒が $ 1 $ 手多く打ってしまっているので、異常な状態です。
 
```

...................
...................
...................
...................
...................
...................
...................
...................
........ooooo......
.........xxxx......
........x..........
...................
...................
...................
...................
...................
...................
...................
...................
```

 ```

NO
```

- 黒が $ 5 $ 手、白が $ 5 $ 手打った状態です。
- 片方が勝利条件を満たしていればゲームは終了しているので、黒が勝利条件を満たしているのは異常な状態です。
- （記述に間違いがありましたので、訂正しました。）
 
```

...................
...................
...................
...................
...................
...................
...................
...................
........ooooo......
.........xxxx......
...................
...................
...................
...................
...................
...................
...................
...................
...................
```

 ```

YES
```

- 黒が $ 5 $ 手、白が $ 4 $ 手打った状態です。
- 黒が $ 5 $ つ並べて勝利した状態となり、正常です。
 
```

...................
...................
...................
...................
...................
...................
...................
...................
.........x.........
......oooooo.......
........xxxx.......
...................
...................
...................
...................
...................
...................
...................
...................
```

 ```

YES
```

- 黒石が $ 6 $ つ並んでいますが、正常です。
- 例えば黒石が $ 2 $ つ並んでおり、$ 1 $ マス空いてさらに $ 3 $ つ並んでいる状態で、空いている真ん中のマスに黒石を置いた場合このような形になります。
 
```

...................
...................
...................
...................
...................
...................
........x..........
........x....x.....
...........x.......
...oooooooooo......
...................
......x......x.....
....x......x.......
.........x.........
...................
...................
...................
...................
...................
```

 ```

NO
```

- 黒が $ 10 $ 手、白が $ 9 $ 手打った状態です。
- 黒石を $ 10 $ 個並べる前に、黒が勝利してゲームが終了していないとおかしいので、異常な状態です。
 
```

...................
...................
...................
...................
...................
...................
...................
...................
...................
...................
...................
...................
...................
...................
...................
...................
...................
...................
...................
```

 ```

YES
```

- 黒が高橋君で、一手も打たないうちに居眠りしてしまった場合も、正常な状態です。



---

---
title: "[ARC013C] 笑いをとれるかな？"
layout: "post"
diff: 普及+/提高
pid: AT_arc013_3
tag: []
---

# [ARC013C] 笑いをとれるかな？

## 题目描述

新晋艺人组合「あっとこーだー」的高桥君和青木君将在一个地方电视节目中亮相。其中有一项非常受欢迎的游戏叫做「惊险☆哈瓦那辣椒游戏」。这个游戏的规则如下：

1. 两个玩家轮流从一个长方体豆腐中切下一部分，然后吃掉。
2. 谁吃到包含哈瓦那辣椒的部分谁就输。
3. 高桥君和青木君每次轮流切一块。
4. 豆腐中某些部分暗藏哈瓦那辣椒。
5. 游戏中可能会有多个豆腐。
6. 每个豆腐至少藏有一个哈瓦那辣椒。

因为高桥君和青木君都不擅长作出滑稽的表演，如果不小心吃到包含哈瓦那辣椒的部分，很可能会遭到观众的嘲笑。所以，他们都努力让对方吃到哈瓦那辣椒与自己出丑。于是，他们偷偷地从节目制作人那里了解到哈瓦那辣椒的具体位置。在双方都采取最佳策略的情况下，谁会先吃到哈瓦那辣椒输掉比赛呢？出于上帝视角的你决定只告诉高桥君结果。注意高桥君是先手，切割豆腐的方式如下：

- 只能从三个水平方向进行切割，不能斜切。
- 切割后每一块豆腐的边长必须是整数。
- 例如，一个 $2 \times 2 \times 2$ 的豆腐可以像图中那样进行切割。

输入数据格式如下：

\[ N\ X_1\ Y_1\ Z_1\ M_1\ x_{1,0}\ y_{1,0}\ z_{1,0}\ x_{1,1}\ y_{1,1}\ z_{1,1}\ :\ x_{1,M_1-1}\ y_{1,M_1-1}\ z_{1,M_1-1}\ \ \cdots \]

1. 第一行的数字表示豆腐的数量 $ N\ (1 \leq N \leq 1,000) $。
2. 对于每块豆腐，有三维尺寸 $X_i, Y_i, Z_i$：
   - $X_i$ 是第 $i$ 块豆腐的长。
   - $Y_i$ 是第 $i$ 块豆腐的宽。
   - $Z_i$ 是第 $i$ 块豆腐的高。
   - $ X_{i}, Y_{i}, Z_{i} $ 都是整数，并且范围在 $ 1 \leq X_{i}, Y_{i}, Z_{i} \leq 1,000,000,000 $。
3. $ M_i(1 \leq M_i \leq 100) $ 表示第 $i$ 块豆腐内藏的哈瓦那辣椒数目。
4. 接下来每一个坐标 $x_{i,j}, y_{i,j}, z_{i,j}$ 表示在第 $i$ 个豆腐中第 $j$ 个哈瓦那辣椒的位置：
   - 例如，坐标 $(1, 1, 1)$ 处放置哈瓦那辣椒时，它在豆腐中的位置如图所示。

输出要求如下：
- 如果高桥君能够获胜，输出`WIN`。
- 如果高桥君会输掉，输出`LOSE`。
- 输出结果后需要换行。

示例输入1：
```
1
2 3 3
1
1 1 1
```

示例输出1：
```
WIN
```

- 高桥君可以通过先切掉 $ x=0 $ 的豆腐部分，确保自己获胜。

示例输入2：
```
1
3 3 3
1
1 1 1
```

示例输出2：
```
LOSE
```

- 由于豆腐和哈瓦那辣椒的位置是对称的，无论高桥君怎么切，青木君都能通过对称位置的切割保证高桥君必输。

示例输入3：
```
2
4 4 4
1
1 1 1
4 4 4
1
2 2 2
```

示例输出3：
```
LOSE
```

- 两块豆腐形状相同，无论高桥君怎么切��青木君都能通过对称位置的切割保证高桥君必输。

 **本翻译由 AI 自动生成**



---

---
title: "[ARC014D] grepマスター"
layout: "post"
diff: 普及+/提高
pid: AT_arc014_4
tag: []
---

# [ARC014D] grepマスター

## 题目描述

高桥君对使用 `grep` 命令很在行。然而，由于很多人也擅长 `grep`，这已不足以证明他的特别之处。为了掌握新的技能，他正在研究 `grep` 命令的手册。

在 `grep` 命令中，有 `-B` 和 `-A` 选项。使用这些选项时，例如：

```sh
grep -B x -A y "needle" kakikomi.txt
```

这行命令会在文件 `kakikomi.txt` 中，不仅显示符合模式 `"needle"` 的行，还会显示该行前面的 `x` 行和后面的 `y` 行。如果文件没有足够的前后行数，就仅显示实际存在的行数。而且，每一行只会被显示一次，即使它被多个命中行所覆盖。关于这个行为，可以参考输出示例。

现在，已知道在某个模式下对文件 `kakikomi.txt` 执行 `grep` 命令后，得到了匹配的行号列表 $L_1, L_2, \ldots, L_n$。现在有 $m$ 个查询，每个查询给定 `x` 和 `y`。对每个查询，求出使用 `-B x -A y` 选项时，将会显示多少行。

### 输入格式

1. 输入的第一行包含三个整数：文件 `kakikomi.txt` 的总行数 $all (1 \leq all \leq 10^9)$，命中行数 $N (1 \leq N \leq \min(all, 10^5))$，以及查询数量 $M (1 \leq M \leq 10^5)$。
2. 接下来有 $N$ 行，每行包含一个整数 $L_i (1 \leq L_i \leq all)$，表示每个命中行的行号。
3. 接下来是 $M$ 行，每行包含两个整数 $x_i, y_i (0 \leq x_i, y_i \leq 10^9)$，表示查询中的 `x` 和 `y`。

### 输出格式

对于每一个查询 $(x, y)$，输出一行，表示使用 `-B x -A y` 选项时，将会显示的行数。在输出的最后要有一个换行符。

### 示例
#### 输入
```
7 2 3
2
4
1 1
3 0
3 4
```

#### 输出
```
5
4
7
```

#### 解释
- 匹配的行是第 2 行和第 4 行。
- 对于第一个查询 $x = 1, y = 1$，命中范围为第 1 到 3 行和第 3 到 5 行，加起来共 5 行。
- 对于第二个查询 $x = 3, y = 0$，命中范围为第 1 到 2 行和第 1 到 4 行，加起来共 4 行。
- 对于第三个查询 $x = 3, y = 4$，命中范围为第 1 到 6 行和第 1 到 7 行，加起来共 7 行。

#### 输入
```
100 5 5
3
18
24
57
90
1 8
27 0
15 16
22 3
2 2
```

#### 输出
```
46
80
98
79
25
```

通过这样的调整和润色，题目描述变得更加简明和易于理解，增强了中文阅读的流畅性。

 **本翻译由 AI 自动生成**



---

---
title: "[ARC018C] 席替え"
layout: "post"
diff: 普及+/提高
pid: AT_arc018_3
tag: []
---

# [ARC018C] 席替え

## 题目描述

我所在的学校每个班级的人数特别多，甚至有多达 $1,000,000$ 人的班级。我的班级也不例外。教室的座位排成 $N$ 行 $M$ 列的矩形，共有 $N \times M$ 名学生，每人拥有一张自己的桌子。

学校非常重视防灾意识，如果发生意外，教室后面的墙壁可以打开，让学生从这里避难。最近，学校决定让成绩好的学生优先撤离，所以我们班决定重新安排座位，让成绩好的学生坐得更靠后。具体来说，把最前面的一行称为第 $0$ 行，最左边的一列称为第 $0$ 列。位于第 $i$ 行第 $j$ 列的座位用 $(i, j)$ 表示，坐在这个位置的学生成绩用 $G[i][j]$ 表示。对于任意两个座位 $(a, b)$ 和 $(c, d)$，如果 $a > c$，则无论 $b, d$ 的值如何，必须满足 $G[a][b] \geq G[c][d]$。

学生可以自由移动到任意座位，但是不能有两个或更多学生坐在同一座位，也不能有空位。同时，桌子数量不能改变，仍保持 $N$ 行 $M$ 列的布局。

重新安排座位是好事，但由于人数众多，我们希望尽量减少所有学生移动的总距离。这里的移动距离是指从原座位到新座位的曼哈顿距离，即如果一个学生从 $(a, b)$ 移动到 $(c, d)$，则移动距离为 $|a - c| + |b - d|$。

给定所有学生在重新安排前的成绩数据，请计算所有学生的最小移动距离总和。

### 输入格式

- 第一行包含两个整数 $N$ 和 $M$，分别表示教室的行数和列数（$1 \le N, M \le 1,000$）。
- 第二行包含三个整数 $x_0$、$a$ 和 $p$，用来生成每位学生的初始成绩（$0 \le x_0, a \le 10^9$，$N \times M \le p \le 10^9$，$p$ 必为素数）。初始成绩通过递归式 $x_i = (x_{i-1} + a) \mod p$ 生成。在位置 $(i, j)$ 的学生成绩为 $x_{i \times M + j}$。

### 输出格式

输出所有学生移动距离最小总和。最后包括一个换行符。

### 数据范围和提示

- $1 \le N, M \le 1,000$
- $0 \le x_0, a \le 10^9$
- $N \times M \le p \le 10^9$ 且 $p$ 为素数

### 示例

#### 输入
```
2 3
1 2 59
```

#### 输出
```
0
```

#### 解释

重新安排座位前，学生的成绩如下：
```
1  3  5
7  9 11
```

各座位在自己后面（屏幕下方）没有比自己成绩更差的学生，因此无需重新安排。

#### 输入
```
2 3
6 55 59
```

#### 输出
```
2
```

#### 解释

重新安排座位前，学生的成绩如下：
```
6  2 57
53 49 45
```

交换座位 $(0, 2)$ 和 $(1, 2)$ 的学生即可。两者分别移动 1 个单位，总移动距离为 2。

#### 输入
```
4 5
15 25 79
```

#### 输出
```
26
```

#### 解释

重新安排座位前，学生的成绩如下：
```
15 40 65 11 36
61  7 32 57  3
28 53 78 24 49
74 20 45 70 16
```

符合条件的重新安排如：
```
15  7 16 11  3
28 20 32 24 36
53 40 45 57 49
74 61 65 70 78
```

 **本翻译由 AI 自动生成**



---

---
title: "[ARC021B] Your Numbers are XORed..."
layout: "post"
diff: 普及+/提高
pid: AT_arc021_2
tag: []
---

# [ARC021B] Your Numbers are XORed...

## 题目描述

有两个序列 $a$ 和 $b$。

已知序列 $b$ 的构造方法：
- 对于 $1 \le i < L$ 的情况，$b_i = a_i \operatorname{xor} a_{i + 1}$，其中 $\operatorname{xor}$ 表示异或；
- $b_L = a_L \operatorname{xor} a_1$。

给定序列 $b$ 的长度 $L$ ，以及序列 $b$，求序列 $a$，如果没有一个满足的序列 $a$，请输出`-1`。

如果你不知道什么是异或，请点[这个链接](https://baike.baidu.com/item/%E5%BC%82%E6%88%96/10993677)。

## 输入格式

第一行一个整数 $L$。

第二行到第 $L + 1$ 行，每行一个整数，代表 $b_i$。

## 输出格式

输出符合要求的 $a$ 数列，一行一个数，如果没有，输出`-1`。

## 说明/提示

对于 $100\%$ 的数据：
- $2 \le L \le 10^5$；
- $0 \le b_i < 2^{31}$。

## 样例 #1

### 输入

```
2

1

1
```

### 输出

```
0

1
```

## 样例 #2

### 输入

```
3

1

4

1
```

### 输出

```
-1
```

## 样例 #3

### 输入

```
3

1

2

3
```

### 输出

```
0

1

3
```



---

---
title: "[ARC022B] 細長いお菓子"
layout: "post"
diff: 普及+/提高
pid: AT_arc022_2
tag: []
---

# [ARC022B] 細長いお菓子

## 题目描述

### 题目简述



有一个长度为$N$的序列。



请从这个序列里面找出**满足全部的值都是不相同的**子序列。



请输出最长子序列的**这个长度**。

## 输入格式

第一行是一个正整数$N(1 \le N \le 10^5)$。



第二行是$N$个正整数用空格分隔，表示这个序列的全部的值。

## 输出格式

输出一个正整数，表示满足要求的最长子序列的长度

## 样例 #1

### 输入

```
7

1 2 1 3 1 4 4
```

### 输出

```
3
```

## 样例 #2

### 输入

```
1

100
```

### 输出

```
1
```



---

---
title: "[ARC022C] ロミオとジュリエット"
layout: "post"
diff: 普及+/提高
pid: AT_arc022_3
tag: []
---

# [ARC022C] ロミオとジュリエット

## 题目描述

[problemUrl]: https://atcoder.jp/contests/arc022/tasks/arc022_3

高橋王国には $ N $ 個の村があり、$ 1 $ から $ N $ の番号がついています。$ N-1 $ 組の村の間は道で繋がっていて、どの村と村の間も道をいくつか辿ることによって移動できるようになっています。

高橋王国に住んでいるロミオさんとジュリエット君が引っ越しをすることになりました。$ 2 $ 人はとても仲が悪いので出来るだけ離れた村に引っ越したいと思っています。あなたは、$ 2 $ 人がそれぞれどの村に引っ越せば $ 2 $ 人の住む村の間の距離が最大になるのかを計算してあげてください。ただし「村の間の距離」とは、片方の村からもう片方の村まで行くために通る必要のある道の本数であるとします。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ A_1 $ $ B_1 $ $ A_2 $ $ B_2 $ : $ A_{N-1} $ $ B_{N-1} $

- $ 1 $ 行目には、高橋王国にある村の個数を表す整数 $ N\ (2\ ≦\ N\ ≦\ 10^5) $ が与えられる。
- $ 2 $ 行目から $ N-1 $ 行では、村どうしをつなぐ道の情報が与えられる。このうち $ i $ 行目には、整数 $ A_i\ (1\ ≦\ A_i\ ≦\ N) $ と $ B_i\ (1\ ≦\ B_i\ ≦\ N) $ が空白区切りで書かれており、これは村 $ A_i $ と村 $ B_i $ を繋ぐ道があることを表す。

## 输出格式

$ 2 $ 人の住む村の間の距離が最大にするときに、ロミオさんが住むべき村とジュリエット君が住むべき村の番号を表す整数を空白区切りで $ 1 $ 行に出力せよ。出力の末尾に改行をいれること。答えが複数考えられる場合は、そのうちのいずれかを出力すれば良い。

## 说明/提示

### 部分点

この問題には部分点が設定されている。

- $ N\ ≦\ 1,000 $ を満たすテストケースすべてに正解した場合は $ 40 $ 点が与えられる。

### Sample Explanation 1

!\[\](/img/arc/022/3-1.png) この入力では、高橋王国は図のような構造をしている。 「10 5」と出力しても正解である。

### Sample Explanation 2

!\[\](/img/arc/022/3-2.png) この入力では、高橋王国は図のような構造をしている。 「2 3」「3 2」「2 4」「4 2」「3 4」と出力しても正解である。

## 样例 #1

### 输入

```
10

7 6

3 2

2 4

4 5

8 9

1 8

1 6

1 2

9 10
```

### 输出

```
5 10
```

## 样例 #2

### 输入

```
4

1 2

1 3

1 4
```

### 输出

```
4 3
```



---

---
title: "[ARC024B] 赤と黒の木"
layout: "post"
diff: 普及+/提高
pid: AT_arc024_2
tag: []
---

# [ARC024B] 赤と黒の木

## 题目描述

在红黑岛上生长着一种奇特的树，它们的颜色会在红色和黑色之间变化。这些树以一个圆圈的形式排列在岛上。

这种树具有独特的“平衡”特性：如果一棵树和它相邻的两棵树颜色相同，那么第二天这棵树的颜色会改变。具体来说，假设有三棵连续的树 $A, B, C$，它们的颜色分别为 $C_A, C_B, C_C$。如果当天三棵树的颜色都为红色，即 $C_A = C_B = C_C = $ 红色，那么第二天 $C_B$ 的颜色会变为黑色，反之亦然。

需要注意的是，这些树在“平衡”时，只根据当天自己的颜色情况来做决定，而不考虑邻居的变化。因此，即便经过一天，也可能出现三个连续的同色树（请参见示例）。在这种情况下，第二天也会继续“平衡”。

作为研究者，你已经观察到了由 $N$ 棵树组成的这个群体第一天的颜色分布。请你计算出经过多少天这些树的颜色才不再变化。

## 输入格式

输入格式如下：

> $ N $  
> $ color_1 $  
> $ color_2 $  
> ...  
> $ color_N $

- 第一行是树的数量 $N\ (3 \leq N \leq 10^5)$。
- 随后的 $N$ 行中，第 $i$ 行表示第 $i$ 棵树的颜色 $color_i\ (color_i = 0, 1)$。
- 如果 $color_i = 0$，则表示该树为黑色；如果 $color_i = 1$，则为红色。
- 树呈圆形排列，意味着第 $i$ 棵树与第 $i+1$ 棵树相邻，第 $N$ 棵树与第 $1$ 棵树相邻。

## 输出格式

输出所有树的颜色不再变化的那一天。如果这种情况永远不会出现，则输出 $-1$。

## 说明/提示

### 示例解释

#### 示例 1
如图所示，变化停留在第二天。
- 第一天，第 3 棵树与其相邻的树颜色相同，因此颜色改变。
- 从第二天开始，颜色不再变化。

#### 示例 2
如图所示。注意第 6 棵树和第 1 棵树是相邻的。
- 第一天，第 1、5 和 6 棵树因为与相邻树相同颜色，因此颜色改变。
- 第二天，第 6 棵树颜色改变。
- 从第三天开始，颜色不再变化。

#### 示例 3
所有树仅在全黑或全红两种状态间交替。


 **本翻译由 AI 自动生成**

## 样例 #1

### 输入

```
5

0

1

1

1

0
```

### 输出

```
2
```

## 样例 #2

### 输入

```
6

1

1

0

1

1

1
```

### 输出

```
3
```

## 样例 #3

### 输入

```
3

1

1

1
```

### 输出

```
-1
```



---

---
title: "[ARC025B] チョコレート"
layout: "post"
diff: 普及+/提高
pid: AT_arc025_2
tag: []
---

# [ARC025B] チョコレート

## 题目描述

有一块纵 $H$ 格，横 $W$ 格的巧克力。每一格要么是黑巧克力要么是白巧克力。黑巧克力之间、白巧克力之间没有共有的边。每一格的巧克力都有自己的浓度。以下是巧克力的一个例子（其中的数字表示巧克力浓度）。



![](https://arc025.contest.atcoder.jp/img/arc/025/2-1.png)



Imouto想从这块巧克力中取出一块长方形区域，将其熔化成为巧克力酱。Imouto很重视巧克力的口味，因此她希望取出的长方形区域中的白巧克力浓度合计值等于黑巧克力浓度合计值（如果没有使用黑/白巧克力，则浓度为 $0$ ）。



Imouto想知道满足条件的方案中，使用的巧克力格子数最大是多少。

## 输入格式

输入按以下形式：

$$ H \space W $$

$$ C_{1,1} \space C_{1,2} \space \dots \space C_{1,W} $$

$$ C_{2,1} \space C_{2,2} \space \dots \space C_{2,W} $$

$$ : $$

$$ C_{H,1} \space C_{H,2} \space \dots \space C_{H,W} $$



- 第 $1$ 行两个整数 $H(1 \le H \leq 100)$ 和 $W(1 \leq W \leq 100)$ 分别表示纵向格子数和横向格子数。

- 第 $2$ 行开始的 $H$ 行，为每个格子的浓度。每行为 $W$ 个以空格分开的非负整数。浓度 $C_{i,j}$ 满足 $(0 \leq C_{i,j} \leq 99)$ 。

## 输出格式

如果存在满足条件的方案，输出这些方案中使用格子数的最大值。如果不存在满足条件的方案，输出 '0' 。输出的末尾请换行。



## 样例解释

### 样例1解释

将如下图所示的纵 $2$ 格，横 $3$ 格的长方形取出。格子数为 $6$ ，黑白巧克力的浓度总和都为 $17$ ，故满足条件。



![](https://arc025.contest.atcoder.jp/img/arc/025/2-2.png)



### 样例2解释

注意：浓度为 $0$ 的情况也可能存在。



### 样例4解释

在此输入的情况下，不存在满足条件的方案。



### 样例5解释

注意：存在只选择黑白巧克力中一方的情况。

## 样例 #1

### 输入

```
3 4

4 6 2 5

3 5 6 7

2 5 5 6
```

### 输出

```
6
```

## 样例 #2

### 输入

```
2 2

4 0

7 3
```

### 输出

```
4
```

## 样例 #3

### 输入

```
2 3

0 0 0

1 2 3
```

### 输出

```
3
```

## 样例 #4

### 输入

```
3 3

1 2 3

6 5 4

7 8 9
```

### 输出

```
0
```

## 样例 #5

### 输入

```
1 5

0 1 2 3 4
```

### 输出

```
1
```



---

---
title: "[ARC027B] 大事な数なのでZ回書きまLた。"
layout: "post"
diff: 普及+/提高
pid: AT_arc027_2
tag: []
---

# [ARC027B] 大事な数なのでZ回書きまLた。

## 题目描述

有一个长度为 $N$ 的数字串 $S$。它现在被2个混有大写字母的字符串替代。

你需要找到有多少个数字串 $S$ ，可以符合以下条件：

> - 不含前导零；
>
> - 在给出的2个字符串中，可以把每一个大写字母都分别替换成一种数字，相同的字母替换为相同的数字；
>
> - 替换完成后，两个字符串都和这个字符串 $S$ 相等。

## 输入格式

输入共三行

- 第一行是一个整数 $ N\ (1\ ≦\ N\ ≦\ 18) $ ，代表长度。
- 接下来两行，分别各是一个长度为 $N$ 的字符串。它只包含了数字和大写字母。

## 输出格式

输出一个整数代表答案。**输出最后也要换行。**

## 样例 #1

### 输入

```
4

1XYX

1Z48
```

### 输出

```
1
```

## 样例 #2

### 输入

```
3

XXX

YYY
```

### 输出

```
9
```

## 样例 #3

### 输入

```
6

PRBLMB

ARC027
```

### 输出

```
90
```



---

---
title: "[ARC027C] 最高のトッピングにしような"
layout: "post"
diff: 普及+/提高
pid: AT_arc027_3
tag: []
---

# [ARC027C] 最高のトッピングにしような

## 题目描述

在我常去的一家餐馆里，用餐可以获得兑换券。

兑换券有两种类型：一种是提供额外功能的“特殊兑换券”，另一种是“普通兑换券”。

这家餐馆提供 $N$ 种配料，你可以用 $t_i$ 张票券换得每种配料 $i$。在组合兑换中，同一种配料不可重复获取。兑换时，尽管两种类型的兑换券等值，但需保证每种配料的兑换至少包含一张“特殊兑换券”。例如，若某种配料需要 4 张票券，有以下 4 种兑换组合：

- 1 张特殊兑换券和 3 张普通兑换券。
- 2 张特殊兑换券和 2 张普通兑换券。
- 3 张特殊兑换券和 1 张普通兑换券。
- 全用 4 张特殊兑换券。

每种配料都有各自的“快乐值”，用 $h_i$ 表示获取配料 $i$ 时的快乐值。

今天是个特别的日子，我希望通过合理利用现有的兑换券，最大化兑换配料带来的总快乐值。请设计一个程序，计算出在当前的票券和配料信息下，能够获取的最大快乐值。

## 输入格式

输入由标准输入提供，格式如下：

> $X$ $Y$ $N$ $t_1$ $h_1$ $t_2$ $h_2$ : $t_N$ $h_N$

- 第一行有两个整数 $X$ 和 $Y$（$1 \leq X \leq 300$，$0 \leq Y \leq 300$），分别表示初始持有的特殊兑换券数和普通兑换券数。
- 第二行有一个整数 $N$（$1 \leq N \leq 300$），表示配料种类数。
- 接下来的 $N$ 行中，每行包含两个整数 $t_i$ 和 $h_i$（$1 \leq t_i \leq 600$，$1 \leq h_i \leq 5,000,000$），分别表示配料 $i$ 需要的票券数和对应的快乐值。

## 输出格式

输出可能获得的最大快乐值，以一个整数形式输出。记得在最后加上换行。

## 说明/提示

### 部分得分

题目设有部分得分：

- 对于数据集 1，满足条件 $X \leq 50$，$Y \leq 50$，$N \leq 50$，$t_i \leq 100$ 的正确解答可以获得 30 分。
- 对于没有额外限制的通用数据集 2，正确解答可以获得 70 分。

### 样例解释

- 初始有 3 张特殊兑换券和 5 张普通兑换券。通过以下组合可以得到最大快乐值 100（即40 + 60）：
  - 使用 1 张特殊兑换券和 2 张普通兑换券兑换配料 2（需 3 张票券），获得快乐值 40。
  - 使用 2 张特殊兑换券和 3 张普通兑换券兑换配料 3（需 5 张票券），获得快乐值 60。
  这个组合用掉了 3 张特殊和 5 张普通兑换券，是可行的。

- 最优选择是获取配料 1 和配料 2。

- 选择配料 3，并留下一张票券，是最优解。

- 可以获取所有的配料。

 **本翻译由 AI 自动生成**

## 样例 #1

### 输入

```
3 5

4

3 30

3 40

5 60

7 80
```

### 输出

```
100
```

## 样例 #2

### 输入

```
3 3

4

3 30

3 40

5 60

7 80
```

### 输出

```
70
```

## 样例 #3

### 输入

```
1 5

4

3 30

3 40

5 60

7 80
```

### 输出

```
60
```

## 样例 #4

### 输入

```
6 12

4

3 30

3 40

5 60

7 80
```

### 输出

```
210
```



---

---
title: "[ARC028B] 特別賞"
layout: "post"
diff: 普及+/提高
pid: AT_arc028_2
tag: []
---

# [ARC028B] 特別賞

## 题目描述

[problemUrl]: https://atcoder.jp/contests/arc028/tasks/arc028_2

高橋君はプログラミングコンテストを行い、$ N $ 人の人が参加しました。賞品がないと物足りないのではないかと思った高橋君は「$ i $ 位以上の人のうち、$ K $ 番目に若い人」に特別賞を出すことにしました。参加者全員の年齢は分かっています。$ K $ の値はもう既に決めているのですが、$ i $ の値はまだ決めていません。$ i $ の値を決めるために高橋君は、$ K $ 以上 $ N $ 以下の整数 $ i $ それぞれについて誰が特別賞を取ることが出来るのかを計算してみることにしました。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ K $ $ X_1 $ $ X_2 $ ... $ X_N $

- $ 1 $ 行目には、コンテストに参加した人数を表した整数 $ N\ (1\ ≦\ N\ ≦\ 100,000) $ と、整数 $ K\ (1\ ≦\ K\ ≦\ N) $ が空白区切りで与えられる。
- $ 2 $ 行目には、参加者の年齢の情報を表す $ N $ 個の整数が空白区切りで与えられる。このうち $ i $ 番目の整数 $ X_i\ (1\ ≦\ X_i\ ≦\ N) $ は、順位が $ i $ 位の参加者の年齢が全参加者のうち $ X_i $ 番目に若いことを表す。ただし、$ p\ \neq\ q $ のとき $ X_p\ \neq\ X_q $ であることが保証される。

## 输出格式

$ N-K+1 $ 行に出力せよ。そのうち $ i $ 行目には、「$ i+K-1 $ 位以上の人のうち、$ K $ 番目に若い人」の順位を表す $ 1 $ つの整数を出力せよ。

## 说明/提示

### 部分点

この問題には部分点が設定されている。

- $ N\ ≦\ 1000 $ を満たすテストケースすべてに正解した場合は $ 40 $ 点が与えられる。

### Sample Explanation 1

以下は、出力の各行についての説明です。 - $ 1 $ 行目： $ 2 $ 位以上の人のうち $ 2 $ 番目に若い人は $ 2 $ 位の人です。 - $ 2 $ 行目： $ 3 $ 位以上の人のうち $ 2 $ 番目に若い人は $ 1 $ 位の人です。 - $ 3 $ 行目： $ 4 $ 位以上の人のうち $ 2 $ 番目に若い人は $ 3 $ 位の人です。 - $ 4 $ 行目： $ 5 $ 位以上の人のうち $ 2 $ 番目に若い人は $ 5 $ 位の人です。

## 样例 #1

### 输入

```
5 2

4 5 3 1 2
```

### 输出

```
2

1

3

5
```

## 样例 #2

### 输入

```
3 1

2 3 1
```

### 输出

```
1

1

3
```



---

---
title: "[ARC028C] 高橋王国の分割統治"
layout: "post"
diff: 普及+/提高
pid: AT_arc028_3
tag: []
---

# [ARC028C] 高橋王国の分割統治

## 题目描述

[problemUrl]: https://atcoder.jp/contests/arc028/tasks/arc028_3

高橋王国は $ N $ 個の町からなり、それぞれの町には $ 0 $ から $ N-1 $ までの番号がついています。また、２つの町を繋ぐ道が $ N-1 $ 本あり、どの町からどの町へもいくつかの道を使うことで辿り着けるようになっています。

高橋王国の王様である高橋君は、首都にする町を決めようとしています。高橋君は首都を決める参考にするために「バランス値」を計算してみることにしました。町 $ v $ を首都としたときの「バランス値」は、町 $ v $ を通らずに相互に通行可能である町の集合の最大の大きさです。

例えば、下の図の町 $ 1 $ を首都とした場合、{町 $ 0 $, 町 $ 4 $} や {町 $ 2 $} や {町 $ 3 $} などの町の集合において、町 $ 1 $ を通らずに相互に通行することが可能となっています。そのうち最も大きい集合は {町 $ 0 $, 町 $ 4 $} であり、その大きさは $ 2 $ であるため、町 $ 1 $ を首都としたときの「バランス値」は $ 2 $ となります。

 ![figure](https://cdn.luogu.com.cn/upload/vjudge_pic/AT_arc028_3/a2884d775d8d248a4b6d27c592f114eb88daf1ec.png)

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ p_1 $ $ p_2 $ : $ p_{N-1} $

- $ 1 $ 行目には、町の個数を表した整数 $ N\ (1\ ≦\ N\ ≦\ 100,000) $ が与えられる。
- $ 2 $ 行目からの $ N-1 $ 行では、道の情報が与えられる。このうち $ i $ 行目では１つの整数 $ p_i\ (0\ ≦\ p_i\ ≦\ i-1) $ が与えられる。これは、町 $ i $ と 町 $ p_i $ を繋ぐ道があることを表す。

## 输出格式

$ N $ 行に出力せよ。そのうち $ i $ 行目には、町 $ i-1 $ を首都としたときの「バランス値」を表す $ 1 $ つの整数を出力せよ。

## 说明/提示

### 部分点

この問題には部分点が設定されている。

- $ N\ ≦\ 1000 $ を満たすテストケースすべてに正解した場合は $ 30 $ 点が与えられる。

### Sample Explanation 1

このケースでの入力は、問題文中の図のような道の情報を表しています。

## 样例 #1

### 输入

```
5

0

1

1

0
```

### 输出

```
3

2

4

4

4
```

## 样例 #2

### 输入

```
3

0

0
```

### 输出

```
1

2

2
```



---

---
title: "[ARC033C] データ構造"
layout: "post"
diff: 普及+/提高
pid: AT_arc033_3
tag: []
---

# [ARC033C] データ構造

## 题目描述

[problemUrl]: https://atcoder.jp/contests/arc033/tasks/arc033_3

数の集合 $ S $ に対する以下のクエリを処理してください。

- タイプ $ 1 $ ： $ S $ に数 $ X $ を追加する。
- タイプ $ 2 $ ： $ S $ に含まれる数のうち $ X $ 番目に小さい数を答え、その数を $ S $ から削除する。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ Q $ $ T_1 $ $ X_1 $ $ T_2 $ $ X_2 $ : $ T_Q $ $ X_Q $

- $ 1 $ 行目には、クエリの個数を表す整数 $ Q\ (1\ ≦\ Q\ ≦\ 200,000) $ が与えられる。
- $ 2 $ 行目からの $ Q $ 行には、クエリの情報が与えられる。このうち $ i $ 行目では、$ 2 $ つの整数 $ T_i\ (1\ ≦\ T_i\ ≦\ 2),\ X_i\ (1\ ≦\ X_i\ ≦\ 200,000) $ が空白区切りで与えられる。これは、 
  - $ T_i\ =\ 1 $ の場合、「$ S $ に数 $ X_i $ を追加する」というクエリを表す。ただし、クエリを処理する前の $ S $ には $ X_i $ が含まれていないことが保証される。
  - $ T_i\ =\ 2 $ の場合、「$ S $ に含まれる数のうち $ X_i $ 番目に小さい数を答え、その数を $ S $ から削除する」というクエリを表す。ただし、クエリを処理する前の $ S $ に含まれる数の個数が $ X_i $ 個以上であることが保証される。

## 输出格式

タイプ $ 2 $ のクエリの個数を $ Q_2 $ とすると、出力は $ Q_2 $ 行からなる。このうち $ i $ 行目には、タイプ $ 2 $ のクエリのうち $ i $ 番目のものに対する答えを出力せよ。出力の末尾にも改行を入れること。

## 样例 #1

### 输入

```
5

1 11

1 29

1 89

2 2

2 2
```

### 输出

```
29

89
```

## 样例 #2

### 输入

```
12

1 8932

1 183450

1 34323

1 81486

1 127874

1 114850

1 55277

1 112706

2 3

1 39456

1 52403

2 4
```

### 输出

```
55277

52403
```



---

---
title: "[ARC034C] 約数かつ倍数"
layout: "post"
diff: 普及+/提高
pid: AT_arc034_3
tag: []
---

# [ARC034C] 約数かつ倍数

## 题目描述

[problemUrl]: https://atcoder.jp/contests/arc034/tasks/arc034_3

$ 2 $ 個の正整数 $ A,\ B $ が与えられる。 $ A! $ の約数であり、かつ $ B! $ の倍数でもあるような正整数の個数を $ 1,000,000,007 $ で割った余りを求めよ。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ A $ $ B $

- $ 1 $ 行目に、$ 2 $ 個の整数 $ A,\ B $ ($ 1\ ≦\ B\ ≦\ A\ ≦\ 10^9 $, $ A\ -\ B\ ≦\ 100 $) がスペース区切りで与えられる。

## 输出格式

題意を満たす正整数の個数を $ 1,000,000,007 $ で割った余りを $ 1 $ 行目に出力せよ。

末尾の改行を忘れないこと。

## 说明/提示

### 部分点

この問題には部分点が設定されている。

- $ 5 $ 点分のテストケースは $ 1\ ≦\ B\ ≦\ A\ ≦\ 15 $ を満たす。
- 別の $ 35 $ 点分のテストケースは $ 1\ ≦\ B\ ≦\ A\ ≦\ 10^6 $, $ A\ -\ B\ ≦\ 100 $ を満たす。

### Sample Explanation 1

正整数 $ n $ に対し、 $ n! $ は $ n $ の階乗 $ n\ ×\ (n\ -\ 1)\ ×\ (n\ -\ 2)\ ×\ ...\ ×\ 1 $ を表す。 $ 3!\ =\ 3\ ×\ 2\ ×\ 1\ =\ 6 $ の約数であり、かつ $ 2!\ =\ 2\ ×\ 1\ =\ 2 $ の倍数であるような正整数は $ 2, $ $ 6 $ の $ 2 $ 個存在する。

## 样例 #1

### 输入

```
3 2
```

### 输出

```
2
```

## 样例 #2

### 输入

```
15 4
```

### 输出

```
2592
```

## 样例 #3

### 输入

```
1000000 999900
```

### 输出

```
21398499
```

## 样例 #4

### 输入

```
1000000000 999999900
```

### 输出

```
745508745
```



---

---
title: "[ARC035C] アットコーダー王国の交通事情"
layout: "post"
diff: 普及+/提高
pid: AT_arc035_c
tag: []
---

# [ARC035C] アットコーダー王国の交通事情

## 题目描述

高桥君是 Atcoder 王国的国王。Atcoder 王国包括$N$个城市（编号$1$~$N$）和$m$条双向的道路。每条道路都有长度。对于 Atcoder 王国中的任意城市 [A,B]，都可以保证从$A$到$B$有多条道路。



高桥君认为，Atcoder人的幸福在很大程度上取决于交通的便利性。为了找出人们的幸福程度，他想找到所有可能城市之间最短路径长度的总和$S$。



如果城市i和j之间的最短路径的长度为 D(i,j)，则



![](https://cdn.luogu.com.cn/upload/vjudge_pic/AT1215/c6cb071ff4a2960ab2be46d08083e517ddb9f45e.png)



高桥先生正计划建造K条新道路作为公共项目。这样的建设可能会导致多于两条或两条直接连接城市的道路，在这种情况下，现有道路将不会被拆除，而是会被增加。



您的任务是按照给定的顺序建造一条新路，并编写一个程序来计算上述每种施工的S。

## 输入格式

第一行两个数$n$和$m$，分别表示城市数和道路数。  

接下来$2$~$m+1$行每行三个数$u,v,w$，表示有一条连接$u,v$城市的长度为w的路径。  

第$m+2$行一个数$k$，表示有$k$条新的路要修建。  

第$m+3$~$m+k+2$行每行三个数$x,y,z$，表示又要建一条连接$x,y$的长度为$z$的路径。

## 输出格式

输出$k$行，每行一个数，表示在修完第$i$条道路后的$S$。

## 样例 #1

### 输入

```
4 3

1 2 1

2 3 1

3 4 10

2

3 4 1

1 4 1
```

### 输出

```
10

8
```

## 样例 #2

### 输入

```
8 16

8 7 38

2 8 142

5 2 722

8 6 779

4 6 820

1 3 316

1 7 417

8 3 41

1 4 801

3 2 126

4 2 71

8 4 738

4 3 336

7 5 717

5 6 316

2 1 501

10

6 1 950

6 1 493

1 6 308

3 4 298

2 5 518

1 5 402

4 7 625

7 6 124

3 8 166

2 4 708
```

### 输出

```
13649

12878

11954

11954

11280

11058

11058

8099

8099

8099
```



---

---
title: "[ARC037C] 億マス計算"
layout: "post"
diff: 普及+/提高
pid: AT_arc037_c
tag: []
---

# [ARC037C] 億マス計算

## 题目描述

[problemUrl]: https://atcoder.jp/contests/arc037/tasks/arc037_c

高橋君は「$ N^2 $マス計算」で計算力をつけることにした。「$ N^2 $マス計算」は $ N $ 行 $ N $ 列の表を用意して行う。 $ i $ 行目の左端のマスのさらに左には数 $ a_i $ が書かれており、 $ j $ 列目の上端のマスのさらに上には数 $ b_j $ が書かれている。高橋君はこの表の $ i $ 行 $ j $ 列目 に $ a_i\ ×\ b_j $ の値を計算して書き込む。

すぐに解き終わってしまい退屈したので、高橋君は自分が書き込んだ $ N^2 $ 個の値を昇順に並べ替えることにした。並べ替えた結果小さい方から $ K $ 番目 ($ 1 $ 番から数える) に位置する値を求めよ。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ K $ $ a_1 $ $ a_2 $ .. $ a_N $ $ b_1 $ $ b_2 $ .. $ b_N $

- $ 1 $ 行目には、表の行数および列数 $ N $ ($ 1 $ $ ≦ $ $ N $ $ ≦ $ $ 30000 $) と求めるべき値の並べ替え後の位置 $ K $ ($ 1 $ $ ≦ $ $ K $ $ ≦ $ $ N^2 $) がスペース区切りで与えられる。
- $ 2 $ 行目には、表の各行 $ i $ ($ 1 $ $ ≦ $ $ i $ $ ≦ $ $ N $) について、その行の左端のマスよりさらに左に書かれた数 $ a_i $ ($ 1 $ $ ≦ $ $ a_i $ $ ≦ $ $ 10^9 $) がスペース区切りで与えられる。
- $ 3 $ 行目には、表の各列 $ j $ ($ 1 $ $ ≦ $ $ j $ $ ≦ $ $ N $) について、その列の上端のマスよりさらに上に書かれた数 $ b_j $ ($ 1 $ $ ≦ $ $ b_j $ $ ≦ $ $ 10^9 $) がスペース区切りで与えられる。

## 输出格式

標準出力に、高橋君が表に書き込んだ $ N^2 $ 個の値を昇順に並べ替えたとき小さい方から $ K $ 番目 ($ 1 $ 番から数える) に位置する値を出力し、末尾で改行せよ。

## 说明/提示

### 部分点

この問題には部分点が設定されている。

- $ 5 $ 点分のテストケースは $ 1 $ $ ≦ $ $ N $ $ ≦ $ $ 10 $ を満たす。

### Sample Explanation 1

!\[\](http://arc037.contest.atcoder.jp/img/arc/037/ljlefijfewkjfwefk/C\_sample1.png) 高橋君が書き込んだ値を昇順に並べ替えると $ 6,\ 9,\ 10,\ 15 $ となり、小さい方から $ 3 $ 番目の値は $ 10 $ となる。

### Sample Explanation 2

!\[\](http://arc037.contest.atcoder.jp/img/arc/037/ljlefijfewkjfwefk/C\_sample2.png) 高橋君が書き込んだ値を昇順に並べ替えると $ 1,\ 1,\ 2,\ 2,\ 2,\ 2,\ 2,\ 4,\ 4 $ となり、小さい方から $ 7 $ 番目の値は $ 2 $ となる。

## 样例 #1

### 输入

```
2 3

2 3

3 5
```

### 输出

```
10
```

## 样例 #2

### 输入

```
3 7

1 2 1

2 1 2
```

### 输出

```
2
```

## 样例 #3

### 输入

```
4 8

701687787 500872619 516391519 599949380

458299111 633119409 377269575 717229869
```

### 输出

```
317112176525562171
```



---

---
title: "[ARC038B] マス目と駒"
layout: "post"
diff: 普及+/提高
pid: AT_arc038_b
tag: []
---

# [ARC038B] マス目と駒

## 题目描述

[problemUrl]: https://atcoder.jp/contests/arc038/tasks/arc038_b

$ H $ 行 $ W $ 列のマス目とチェスの駒が $ 1 $ つあります。$ i\ (1\ ≦\ i\ ≦\ H) $ 行目 $ j\ (1\ ≦\ j\ ≦\ W) $ 列目のマスを、マス $ (i,j) $ と呼ぶことにします。このとき、左上のマスがマス $ (1,1) $ で右下のマスがマス $ (H,W) $ となっています。また、マス $ (1,1) $ 以外のいくつかのマスには障害物が置いてあります。ゲーム好きな兄妹がこのマス目と駒を使って以下のようなゲームをしようとしています。

- 最初、駒をマス $ (1,1) $ に置く。
- プレイヤーは自分のターンに、駒を $ 1 $ つ下か $ 1 $ つ右下か $ 1 $ つ右のマスのうち障害物のないいずれかのマスに動かさなければならない。つまり、駒がマス $ (i,j) $ にあるときは、マス $ (i+1,j) $ かマス $ (i+1,j+1) $ かマス $ (i,j+1) $ のうち障害物のないいずれかのマスに動かさなければならない。ただしこのとき、マス目の外に動かすことはできない。すなわち、$ i\ =\ H $ のときは下や右下には動かせず、$ j\ =\ W $ のときは右下や右には動かせない。
- 交互にターンを繰り返し、自分のターンに駒を動かせなくなったプレイヤーの負けとなる（もう一方のプレイヤーが勝ちとなる）。

$ 2 $ 人ともが勝ちを目指して最適な戦略をとったとき、先手と後手のどちらが勝つでしょうか？

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ H $ $ W $ $ S_{1,1} $$ S_{1,2} $..$ S_{1,W} $ $ S_{2,1} $$ S_{2,2} $..$ S_{2,W} $ : $ S_{H,1} $$ S_{H,2} $..$ S_{H,W} $

- $ 1 $ 行目には、$ 2 $ つの整数 $ H\ (1\ ≦\ H\ ≦\ 100),\ W\ (1\ ≦\ W\ ≦\ 100) $ が空白区切りで与えられる。これは、マス目の行数が $ H $、マス目の列数が $ W $ であることを表す。
- $ 2 $ 行目からの $ H $ 行には、マスの情報が与えられる。このうち $ i\ (1\ ≦\ i\ ≦\ H) $ 行目には、$ W $ 個の文字が与えられる。このうちの $ j\ (1\ ≦\ j\ ≦\ W) $ 個目の文字 $ S_{i,j} $ は、マス $ (i,j) $ の情報を表す `#` または `.` の文字である。`#` である場合はマス $ (i,j) $ に障害物があることを表し、`.` である場合はマス $ (i,j) $ に障害物がないことを表す。ただし、$ S_{1,1} $ は `.` であることが保証される。

## 输出格式

先手が勝つ場合は `First` を、後手が勝つ場合は `Second` を $ 1 $ 行に出力せよ。出力の末尾に改行を入れること。

## 说明/提示

### 部分点

この問題には部分点が設定されている。

- $ H\ ≦\ 4 $ かつ $ W\ ≦\ 4 $ を満たすデータセット $ 1 $ に正解した場合は、$ 30 $ 点が与えられる。
- 全てのテストケースに正解した場合は、上記とは別に $ 70 $ 点が与えられる。

### Sample Explanation 1

ゲームは、例えば以下のように進行します。`o` は駒の位置を表しています。 ``` o#. ... ``` - $ 1 $ ターン目：駒はマス $ (1,1) $ にあります。駒を下か右下に動かすことができます。先手は、駒を下に動かしました。 ``` .#. o.. ``` - $ 2 $ ターン目：駒はマス $ (2,1) $ にあります。駒は右にしか動かせません。後手は、駒を右に動かしました。 ``` .#. .o. ``` - $ 3 $ ターン目：駒はマス $ (2,2) $ にあります。駒は右にしか動かせません。先手は、駒を右に動かしました。 ``` .#. ..o ``` - $ 4 $ ターン目：駒はマス $ (2,3) $ にあります。後手は、駒を動かすことができないため負けとなります。 後手がどのように駒を動かしても、先手は適切な動かし方をすることによって勝つことができるため `First` を出力します。

### Sample Explanation 2

先手がどのように駒を動かしても、後手は適切な動かし方をすることによって勝つことができるため `Second` を出力します。

## 样例 #1

### 输入

```
2 3

.#.

...
```

### 输出

```
First
```

## 样例 #2

### 输入

```
4 4

....

...#

....

.#..
```

### 输出

```
Second
```

## 样例 #3

### 输入

```
11 44

............................................

............................................

............................................

.....#.....#####....####.....####....####...

....#.#....#....#..#....#...#....#..#....#..

....#.#....#....#..#.............#..#....#..

...#####...#####...#..........###....####...

...#...#...#....#..#.............#..#....#..

..#.....#..#....#..#....#...#....#..#....#..

..#.....#..#....#...####.....####....####...

............................................
```

### 输出

```
Second
```



---

---
title: "[ARC039B] 高橋幼稚園"
layout: "post"
diff: 普及+/提高
pid: AT_arc039_b
tag: []
---

# [ARC039B] 高橋幼稚園

## 题目描述

高桥先生是一名幼儿园老师。他决定给N个孩子发放K个糖果，每个孩子得到的糖果数都为整数个。

在这里，定义孩子们的整体幸福度为所有孩子得到的糖果的数量之乘积。

高桥先生发糖果时想尽量提高孩子们的整体幸福度，请你设计方案达到目的，并输出整体幸福度最高时的方案个数。（答案可能很大，请输出答案%1000000007的结果）

此题中，孩子们之间有差别，而糖果之间视为无差别。

** 请注意有孩子未分到糖果时乘积为零的情况（详见样例三）**

## 输入格式

保证由以下格式输入：

一行，两个正整数N(1<=N<=100)和K(1<=K<=500)（含义见描述），由空格隔开。

## 输出格式

一个数，即答案mod 1000000007的结果，并附加一个换行符。

# 输入输出样例

### 输入样例#1：

```

4 10

```

### 输出样例#1：

```

6

```

### 输入样例#2：

```

100 450

```

### 输出样例#2：

```

538992043

```

### 输入样例#3：

```

5 2

```

### 输出样例#3：

```

15

```

## 说明/提示

### **数据范围**

- 有80%数据满足N<=K

### **样例说明1**

这四个孩子中有两个人分到2颗糖果，两个人分到3颗糖果时整体幸福度最大，最大值为2×2×3×3=36.

分配方式有(3,3,2,2),(3,2,3,2),(3,2,2,3),(2,3,3,2),(2,3,2,3),(2,2,3,3) 共6种.

### **样例说明2**

注意答案取模1000000007

### **样例说明3**

无论你如何分发糖果，整体幸福度都为0。

## 样例 #1

### 输入

```
4 10
```

### 输出

```
6
```

## 样例 #2

### 输入

```
100 450
```

### 输出

```
538992043
```

## 样例 #3

### 输入

```
5 2
```

### 输出

```
15
```



---

---
title: "[ARC041C] ウサギ跳び"
layout: "post"
diff: 普及+/提高
pid: AT_arc041_c
tag: []
---

# [ARC041C] ウサギ跳び

## 题目描述

[problemUrl]: https://atcoder.jp/contests/arc041/tasks/arc041_c

$ L $ 個のマスが横一列に並んでいる。 マスの上には $ N $ 匹のウサギがいる。 $ i $ ($ 1≦i≦N $) 番目のウサギは、左から $ x_i $ 番目のマスにいる。 ただし、$ 1≦x_1\ <\ x_2\ <\ ..\ <\ x_N≦L $ を満たす。 また、ウサギはそれぞれ左向きまたは右向きである。

それぞれのウサギは、自分の $ 1 $ つ前にマスが存在し、そこに他のウサギがいなければ、ジャンプして自分の $ 1 $ つ前のマスへ移動できる。

ウサギがジャンプする順番を自由に選べるとき、ジャンプの総回数の最大値を求めよ。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ L $ $ x_1 $ $ d_1 $ $ x_2 $ $ d_2 $ : $ x_N $ $ d_N $

- $ 1 $ 行目には、ウサギの匹数 $ N $ ($ 1≦N≦10^5 $) とマスの個数 $ L $ ($ N≦L≦10^9 $) が空白区切りで与えられる。
- $ 2 $ 行目からの $ N $ 行には、ウサギの情報が与えられる。このうち $ i $ 行目には、$ i $ 番目のウサギの位置 $ x_i $ と向き $ d_i $ が空白区切りで与えられる。ただし、$ d_i $ は `L`（左向き）または `R`（右向き）である。
- $ 1≦x_1\ <\ x_2\ <\ ..\ <\ x_N≦L $ を満たす。

## 输出格式

ウサギがジャンプする順番を自由に選べるとき、ジャンプの総回数の最大値を $ 1 $ 行に出力せよ。 出力の末尾に改行を入れること。

## 说明/提示

### Sample Explanation 1

図のようにジャンプすればよい。 !\[\](https://arc041.contest.atcoder.jp/img/arc/041/qawsedrftgyhujikolp/rabbit\_1.png)

### Sample Explanation 2

図のようにジャンプすればよい。 !\[\](https://arc041.contest.atcoder.jp/img/arc/041/qawsedrftgyhujikolp/rabbit\_2.png)

### Sample Explanation 3

どのウサギもジャンプできない。

## 样例 #1

### 输入

```
1 5

1 R
```

### 输出

```
4
```

## 样例 #2

### 输入

```
4 5

1 R

3 L

4 L

5 L
```

### 输出

```
3
```

## 样例 #3

### 输入

```
4 10

1 L

5 R

6 L

10 R
```

### 输出

```
0
```



---

---
title: "[ARC042A] 掲示板"
layout: "post"
diff: 普及+/提高
pid: AT_arc042_a
tag: []
---

# [ARC042A] 掲示板

## 题目描述

[problemUrl]: https://atcoder.jp/contests/arc042/tasks/arc042_a

$ 1 $ から $ N $ までの番号がついたスレッドのある掲示板があります。 スレッドは書き込みがあると一番上に来ます。 書き込み前のスレッドは上から順に $ 1 $ から $ N $ の順に並んでいました。 $ M $ 個の書き込みが書き込まれた順で与えられるので、全ての書き込みが終わった後のスレッドの順番を出力してください。

例えば、$ 3 $ 個のスレッドがある掲示板に $ 2 $、$ 3 $、$ 1 $ の順で書き込みがあると、以下のようになります。

 ![](https://cdn.luogu.com.cn/upload/vjudge_pic/AT_arc042_a/bac8cb43a2c36713e87d6142d247ade9a4ca302d.png)

従って、書き込み後のスレッドの順番は $ 1 $、$ 3 $、$ 2 $ となります。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ M $ $ a_1 $ $ a_2 $ : $ a_M $

- $ 1 $ 行目には、スレッドの数と書き込みの数を表す $ 2 $ つの整数 $ N,\ M\ (1\ ≦\ N\ ≦\ 10^5,\ 1\ ≦\ M\ ≦\ 10^5) $ が空白区切りで与えられる。
- 続く $ M $ 行の $ i $ 行目には $ i $ 番目に書き込まれたスレッドを表す整数 $ a_i\ (1\ ≦\ a_i\ ≦\ N) $ が与えられる。

## 输出格式

全ての書き込みが終わった後のスレッドの番号を上から順に $ 1 $ 行ずつ出力せよ。

## 说明/提示

### 部分点

この問題には部分点が設定されている。

- $ 1\ ≦\ N\ ≦\ 100,\ 1\ ≦\ M\ ≦\ 100 $ を満たすデータセットに正解した場合は $ 30 $ 点が与えられる。

### Sample Explanation 1

$ 1 $ つめの書き込みの後、スレッドは上から $ 2 $、$ 1 $、$ 3 $ の順で並んでいる。 $ 2 $ つめの書き込みの後、スレッドは上から $ 3 $、$ 2 $、$ 1 $ の順で並んでいる。 $ 3 $ つめの書き込みの後、スレッドは上から $ 1 $、$ 3 $、$ 2 $ の順で並んでいる。

### Sample Explanation 2

元から $ 1 $ 番上にあったスレッド $ 1 $ にしか書き込みがなかったので、スレッドの順番は変わらない。

## 样例 #1

### 输入

```
3 3

2

3

1
```

### 输出

```
1

3

2
```

## 样例 #2

### 输入

```
3 3

1

1

1
```

### 输出

```
1

2

3
```

## 样例 #3

### 输入

```
10 10

3

1

4

1

5

9

2

6

5

3
```

### 输出

```
3

5

6

2

9

1

4

7

8

10
```



---

---
title: "[ARC042C] おやつ"
layout: "post"
diff: 普及+/提高
pid: AT_arc042_c
tag: []
---

# [ARC042C] おやつ

## 题目描述

[problemUrl]: https://atcoder.jp/contests/arc042/tasks/arc042_c

高橋くんは遠足に持って行くおやつを選んでいます。 この遠足には合計で $ P $ 円までのおやつを持って行くことができます。 ただし、担任のけんしょう先生はやさしいので、どの $ 1 $ つのおやつについても、そのおやつがなければ合計が $ P $ 円以下になるのであれば許してくれます。

例えば、$ 100 $ 円まで持って行くことができる時に、値段がそれぞれ $ 30 $ 円、$ 40 $ 円、$ 50 $ 円のおやつを持って行くと、どの $ 1 $ つのおやつを取り除いても合計が $ 100 $ 円以下になるので許してくれます。 しかし、$ 40 $ 円、$ 50 $ 円、$ 60 $円のおやつを持って行くと、$ 40 $ 円のおやつがなかったとしても合計は $ 110 $ 円となり $ 100 $ 円を超えているので、やさしいけんしょう先生もこれは許してくれません。

高橋くんが持って行きたいおやつは $ N $ 種類あり、それぞれに値段と満足度があります。 高橋くんはそれぞれの種類のおやつについて最大でも $ 1 $ つしか遠足に持って行きません。 けんしょう先生が許してくれるおやつの選び方のうち、満足度の合計が最も大きくなるように選んだ時の満足度の合計を求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ P $ $ a_1 $ $ b_1 $ $ a_2 $ $ b_2 $ : $ a_N $ $ b_N $

- $ 1 $ 行目には、高橋くんが持って行きたいおやつの種類と合計で持っていけるおやつの金額を表す $ 2 $ つの整数 $ N,\ P\ (1\ ≦\ N\ ≦\ 5,000,\ 1\ ≦\ P\ ≦\ 5,000) $ が空白区切りで与えられる。
- $ 2 $ 行目からの $ N $ 行には高橋くんの持って行きたいそれぞれおやつの値段と満足度を表す整数 $ a_i\ b_i\ (1\ ≦\ a_i\ ≦\ 100,\ 1\ ≦\ b_i\ ≦\ 100) $ が空白区切りで与えられる。

## 输出格式

けんしょう先生が許してくれるおやつの選び方のうち、満足度の合計が最も大きくなるように選んだ時の満足度の合計を $ 1 $ 行に出力せよ。

## 说明/提示

### 部分点

この問題には部分点が設定されている。

- $ 1\ ≦\ N\ ≦\ 100,\ 1\ ≦\ P\ ≦\ 100 $ を満たすデータセットに正解した場合は $ 50 $ 点が与えられる。

### Sample Explanation 1

$ 1 $ つ目と $ 2 $ つ目と $ 3 $ つ目のおやつを選ぶと満足度の合計が $ 190 $ となり、これがけんしょう先生が許してくれる選び方の中で最大である。

### Sample Explanation 3

この入力は部分点に含まれない。

## 样例 #1

### 输入

```
4 100

30 50

40 40

50 100

60 80
```

### 输出

```
190
```

## 样例 #2

### 输入

```
5 100

40 10

30 50

60 80

20 40

20 70
```

### 输出

```
200
```

## 样例 #3

### 输入

```
10 654

76 54

62 19

8 5

29 75

28 4

76 16

96 24

79 30

20 64

23 56
```

### 输出

```
347
```



---

---
title: "[ARC044B] 最短路問題"
layout: "post"
diff: 普及+/提高
pid: AT_arc044_b
tag: []
---

# [ARC044B] 最短路問題

## 题目描述

一个图有 $n$ 个顶点，每条边长度为 $1$，没有重边，满足从顶点 $1$ 到顶点 $i$ 的最短距离为 $A_i$。

计算符合条件的图总数。

------------

## 输入格式

第一行一个整数 $n$。

第二行 $n$ 个整数，分别为 $A_1$ 到 $A_n$。

## 输出格式

一行，一个整数，为符合条件的图总数 ${}\bmod1000000007$。

**样例解释**

第二，三组样例输出都是 $0$。

## 样例 #1

### 输入

```
4

0 1 1 2
```

### 输出

```
6
```

## 样例 #2

### 输入

```
4

0 1 2 0
```

### 输出

```
0
```

## 样例 #3

### 输入

```
3

1 1 2
```

### 输出

```
0
```

## 样例 #4

### 输入

```
17

0 1 1 2 2 4 3 2 4 5 3 3 2 1 5 4 2
```

### 输出

```
855391686
```



---

---
title: "[ARC046B] 石取り大作戦"
layout: "post"
diff: 普及+/提高
pid: AT_arc046_b
tag: []
---

# [ARC046B] 石取り大作戦

## 题目描述

高桥和青木决定使用 $N$ 个石头组成的石山来玩取石游戏。游戏规则如下：

- 玩家交替从山上取一块以上的石头。
- 取了最后的石头的玩家的胜利。

先手高桥君一次最多可以拿下 $A$ 个石头，而后手青木君一次最多可以取出 $B$ 个石头。你的工作就是当两个人采取最佳行动时，来判断获胜的玩家。

## 输入格式

输入三个正整数 $N,A,B$。

第一行中的整数 $N$ 表示石头数量。第二行是两个整数 $A,B$，表示高桥君和青木君第一次从山上取下的最大石头数。有空格分隔。

## 输出格式

如果先手高桥君赢了，输出 `Takahashi`；如果后手青木君赢了，输出 `Aoki`，输出后要换行。

## 说明/提示

$1\le N\le 10^9$

$1\le A,B\le 10^9$。

## 样例 #1

### 输入

```
5

3 3
```

### 输出

```
Takahashi
```

## 样例 #2

### 输入

```
4

3 3
```

### 输出

```
Aoki
```

## 样例 #3

### 输入

```
5

3 2
```

### 输出

```
Takahashi
```

## 样例 #4

### 输入

```
1000000000

1000000000 1
```

### 输出

```
Takahashi
```



---

---
title: "[ARC049B] 高橋ノルム君"
layout: "post"
diff: 普及+/提高
pid: AT_arc049_b
tag: []
---

# [ARC049B] 高橋ノルム君

## 题目描述

[problemUrl]: https://atcoder.jp/contests/arc049/tasks/arc049_b

高橋ノルム君の可能性は無限大です。高橋ノルムという名前の人物はこの世界にたくさんいます。

$ 2 $ 次元平面上に $ N $ 人の高橋ノルム君がいます。$ i(1≦i≦N) $ 人目の高橋ノルム君は座標 $ (x_i,y_i) $ にいます。 各高橋ノルム君には正整数定数 $ c_i $ が割り当てられており、$ i $ 人目の高橋ノルム君がある点 $ (X,Y) $ に移動するためには $ c_i* $max$ (\|x_i-X|,\|y_i-Y\|) $ の時間がかかります。

あなたの仕事は、全ての高橋ノルム君が一点に集まるために必要な最小の時間を求めることです。 ここで、一点に集まるために必要な最小の時間とは最も遅くその点に到着する高橋君の移動にかかった時間とします。

高橋ノルム君は一斉に動き出し、お互いに干渉せず動くものとします。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ x_1 $ $ y_1 $ $ c_1 $ $ x_2 $ $ y_2 $ $ c_2 $ : $ x_N $ $ y_N $ $ c_N $

- $ 1 $ 行目には、高橋ノルム君の数を表す整数 $ N\ (2≦N≦1,000) $ が与えられる。
- $ 2 $ 行目からの $ N $ 行のうち $ i\ (1≦i≦N) $ 行目には、$ i $ 人目の高橋君の二次元平面上の位置と定数を表す $ 3 $ つの整数 $ x_i,y_i,c_i\ (-10^5≦x_i,y_i≦10^5,1≦c_i≦1,000) $ が空白区切りで与えられる。
- 同じ座標に複数の高橋ノルム君がいることもあります。

## 输出格式

全ての高橋ノルム君が一点に集まるために必要な最小の時間を出力せよ。 絶対誤差または相対誤差が $ 10^{−4} $ 以下ならば正解となる。 出力の末尾には改行を入れること。

## 说明/提示

### 部分点

この問題には部分点が設定されている。

- 任意の $ i(1≦i≦N) $ について、$ c_i=1 $ を満たすデータセットに正解した場合は、$ 30 $ 点が与えられる。
- 追加制約のないデータセットに正解した場合は、上記とは別に $ 70 $ 点が与えられる。

### Sample Explanation 1

集合位置を $ (5,5) $ にすれば、5秒で2人ともその点に移動することができ、これが最小である。

## 样例 #1

### 输入

```
2

0 0 1

10 10 1
```

### 输出

```
5.000000000000000
```

## 样例 #2

### 输入

```
2

0 0 1

10 10 2
```

### 输出

```
6.666666666666667
```

## 样例 #3

### 输入

```
10

-27 -67 10

59 13 10

14 -15 9

-29 -84 7

-75 -2 2

-12 -74 5

77 31 9

40 64 8

-81 32 1

81 26 5
```

### 输出

```
582.222222222222222
```

## 样例 #4

### 输入

```
8

-81739 73917 446

42230 30484 911

79354 -50126 200

33440 -47087 651

-73 84114 905

79222 -53608 713

65194 -46284 685

81145 40933 47
```

### 输出

```
54924095.383189122374461
```



---

---
title: "[ARC051C] 掛け算"
layout: "post"
diff: 普及+/提高
pid: AT_arc051_c
tag: []
---

# [ARC051C] 掛け算

## 题目描述

[problemUrl]: https://atcoder.jp/contests/arc051/tasks/arc051_c

$ N $ 個の整数 $ a_1,\ a_2,\ ...,\ a_N $ が与えられるので、一番小さいものを $ A $ 倍する、という操作を $ B $ 回行います。

この結果できた整数たちを昇順に並べ、順番に出力してください。

ただし出力するときは、出力したい数を $ 10^9\ +\ 7 $ で割ったあまりを出力するようにしてください。

なお、$ 10^9+7 $ で割ったあまりを昇順に並べる、というわけではないことに注意してください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ A $ $ B $ $ a_1 $ $ a_2 $ ... $ a_N $

## 输出格式

$ N $ 行出力する。

$ i $ 行目には、並べ換えた後の $ i $ 番目の整数を $ 10^9+7 $ で割ったあまりを出力する。

## 说明/提示

### 制約

- $ 1\ ≦\ N\ ≦\ 50 $
- $ 1\ ≦\ a_i\ ≦\ 1,000,000,000 $
- $ 1\ ≦\ A,\ B\ ≦\ 1,000,000,000 $
- $ A $ は整数である

### Sample Explanation 2

操作の結果、$ 20000,\ 10000200001 $ の $ 2 $ つの整数ができます。$ 10^9+7 $ で割ったあまりを出力することに注意してください。

## 样例 #1

### 输入

```
3 10 3

1 99 10
```

### 输出

```
99

100

100
```

## 样例 #2

### 输入

```
2 100001 2

1 200000
```

### 输出

```
200000

199931
```

## 样例 #3

### 输入

```
10 123 1000000000

394632992 714094234 84420 5 3439891 3395 35 58 5001 730
```

### 输出

```
954804718

385989482

948741792

268211139

100694402

492858064

955116743

68100851

154525400

479209143
```



---

---
title: "[ARC052B] 円錐"
layout: "post"
diff: 普及+/提高
pid: AT_arc052_b
tag: []
---

# [ARC052B] 円錐

## 题目描述

三维空间( $xyz$ 空间)中有 $N$ 个 **互相不重合** 的圆锥漂浮着。

每个圆锥的底面都与 $yz$ 平面平行，顶点朝向 $x$ 轴正方向。

第 $i$ 个圆锥的底面的中心的 $x$ 坐标为 $X_i$ ，半径为 $R_i$ ，高为 $H_i$ 。

请回答 $Q$ 个如下的询问。
- 给出两个整数 $A,B$ 。请回答 $A \le x \le B$ 的空间里，这些圆锥共占了多少体积。

## 输入格式

输入按以下格式。
$$ N \space Q $$
$$ X_1 \space R_1 \space H_1 $$
$$ X_2 \space R_2 \space H_2 $$
$$ : $$
$$ X_N \space R_N \space H_N $$
$$ A_1 \space B_1 $$
$$ A_2 \space B_2 $$
$$ : $$
$$ A_Q \space B_Q $$

- 第 $1$ 行为表示圆锥个数的一个整数 $N$ 和表示询问个数的一个整数 $Q$ 。
- 从第 $2$ 行开始的 $N$ 行中的第 $i$ 行为第 $i$ 个圆锥的底面中心的 $x$ 坐标值 $X_i$ 和半径的长度 $R_i$ ，高度 $H_i$ 。
- 从 $N+2$ 行开始的 $Q$ 行中的第 $i$ 行为表示第 $i$ 个询问内容的 $A_i,B_i$ 。

## 输出格式

输出共 $Q$ 行。第 $i$ 行为第 $i$ 次询问的答案。输出和答案的误差不能超过 $10^{-3}$ 。另外，输出的末尾请换行。

## 说明/提示

数据范围见原题面最下方。另：输入的所有数据都为整数。

## 样例 #1

### 输入

```
10 10

3 3 3

2 1 1

5 2 3

1 5 6

2 9 3

4 6 12

11 18 5

4 15 25

0 2 3

1 1 7

0 1

0 2

0 10

3 10

0 100

3 8

1 5

2 9

3 4

6 9
```

### 输出

```
8.843002

80.992182

4173.878112

3865.997282

8512.668894

2882.971997

1227.377293

3629.490541

114.081013

1747.545749
```

## 样例 #2

### 输入

```
5 5

5 10 10

4 100 100

3 1000 1000

2 1000 1000

1 1000 1000

0 3

2 1000

4 314

3 217

5 432
```

### 输出

```
9409079.422279

3139502408.531295

2100737789.465234

1613523459.243475

2532621914.444282
```



---

---
title: "[ARC056B] 駐車場"
layout: "post"
diff: 普及+/提高
pid: AT_arc056_b
tag: []
---

# [ARC056B] 駐車場

## 题目描述

[problemUrl]: https://atcoder.jp/contests/arc056/tasks/arc056_b

駐車場で$ N $人が車を駐めようとしています。 駐車場は$ N $個の駐車スペースがあり$ 1 $から$ N $まで番号付けられています。また、$ 2 $つの駐車スペースを双方向に結ぶ道が$ M $本あり、$ i $番目の道は$ u_i $番目の駐車スペースと$ v_i $番目の駐車スペースを結んでいます。 駐車スペース$ S $は駐車場の入り口とつながっています。

$ i $番目の人は、どういうわけか$ i $番目の駐車スペースにしか車を駐めたくないようです。このため、駐車場の入り口から、まだ誰も車を駐めていない駐車スペースとそれらを結ぶ道を通って$ i $番目の駐車スペースに行くことができないとき、車を駐めずに帰ってしまいます。

$ 1 $番目の人から$ N $番目の人まで順番に駐車場にやってきます。最終的に駐車場に駐める人の番号を昇順に出力してください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ M $ $ S $ $ u_1 $ $ v_1 $ : $ u_M $ $ v_M $

## 输出格式

最終的に駐車場に駐める人の番号を昇順に$ 1 $行ずつ出力せよ。

## 说明/提示

### 制約

- $ 1\ ≦\ N,\ M\ ≦\ 2*10^5 $
- $ 1≦u_i,\ v_i≦N $
- $ u_i\ ≠\ v_i $
- $ 1\ ≦\ S\ ≦\ N $
- 全ての駐車スペースへは、入り口から道と駐車スペースを経由してたどり着くことができる

### 部分点

- $ M\ ≦\ 2,000 $ を満たすテストケース全てに正解した場合、部分点として$ 40 $点が与えられる。

### Sample Explanation 1

$ 1 $番目の車は、駐車スペース$ 1 $に行くことができるためそこに駐めます。 $ 2 $番目の車は、駐車スペース$ 2 $に行くことができるためそこに駐めます。 $ 3 $番目の車は、$ 2 $番目の車に塞がれ駐車スペース$ 3 $に行くことができないため、帰ります。

### Sample Explanation 2

!\[https://arc056.contest.atcoder.jp/img/arc/056/vafbafvasrf/imgB.png\](https://arc056.contest.atcoder.jp/img/arc/056/vafbafvasrf/imgB.png)青い円を空いている駐車スペース、赤い円を車のいる駐車スペースとすると、上図のような順番で駐車スペースが埋まっていき、$ 4 $番目の車は駐めることができません。

## 样例 #1

### 输入

```
3 3 2

1 2

2 3

1 3
```

### 输出

```
1

2
```

## 样例 #2

### 输入

```
5 6 5

1 5

3 5

3 2

4 1

1 2

4 3
```

### 输出

```
1

2

3

5
```

## 样例 #3

### 输入

```
5 5 5

1 4

4 3

3 2

2 5

5 1
```

### 输出

```
1

2

5
```



---

---
title: "[ABC045D] すぬけ君の塗り絵"
layout: "post"
diff: 普及+/提高
pid: AT_arc061_b
tag: []
---

# [ABC045D] すぬけ君の塗り絵

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc045/tasks/arc061_b

縦 $ H $ 行、横 $ W $ 列のマス目からなる盤があります。最初、どのマス目も白く塗られています。

すぬけ君が、このうち $ N $ マスを黒く塗りつぶしました。$ i $ 回目 ( $ 1\ \leq\ i\ \leq\ N $ ) に塗りつぶしたのは、 上から $ a_i $ 行目で左から $ b_i $ 列目のマスでした。

すぬけ君がマス目を塗りつぶした後の盤の状態について、以下のものの個数を計算してください。

- 各整数 $ j $ ( $ 0\ \leq\ j\ \leq\ 9 $ ) について、盤の中に完全に含まれるすべての $ 3 $ 行 $ 3 $ 列の連続するマス目のうち、黒いマスがちょうど $ j $ 個あるもの。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ H $ $ W $ $ N $ $ a_1 $ $ b_1 $ : $ a_N $ $ b_N $

## 输出格式

出力は $ 10 $ 行からなる。 $ j+1 $ 行目 ( $ 0\ \leq\ j\ \leq\ 9 $ ) には、盤の中に完全に含まれるすべての $ 3 $ 行 $ 3 $ 列の連続するマス目のうち、黒いマスがちょうど $ j $ 個あるものの 総数を出力せよ。

## 说明/提示

### 制約

- $ 3\ \leq\ H\ \leq\ 10^9 $
- $ 3\ \leq\ W\ \leq\ 10^9 $
- $ 0\ \leq\ N\ \leq\ min(10^5,H×W) $
- $ 1\ \leq\ a_i\ \leq\ H $ $ (1\ \leq\ i\ \leq\ N) $
- $ 1\ \leq\ b_i\ \leq\ W $ $ (1\ \leq\ i\ \leq\ N) $
- $ (a_i,\ b_i)\ \neq\ (a_j,\ b_j) $ $ (i\ \neq\ j) $

### Sample Explanation 1

!\[\](https://atcoder.jp/img/arc061/30326702be007759dce81231012a8353.png) この盤に含まれる $ 3×3 $ の正方形は全部で $ 6 $ 個ありますが、これらのうち $ 2 $ 個の内部には黒いマスが $ 3 $ 個、残りの $ 4 $ 個の内部には黒いマスが $ 4 $ 個含まれています。

## 样例 #1

### 输入

```
4 5 8

1 1

1 4

1 5

2 3

3 1

3 2

3 4

4 4
```

### 输出

```
0

0

0

2

4

0

0

0

0

0
```

## 样例 #2

### 输入

```
10 10 20

1 1

1 4

1 9

2 5

3 10

4 2

4 7

5 9

6 4

6 6

6 7

7 1

7 3

7 7

8 1

8 5

8 10

9 2

10 4

10 9
```

### 输出

```
4

26

22

10

2

0

0

0

0

0
```

## 样例 #3

### 输入

```
1000000000 1000000000 0
```

### 输出

```
999999996000000004

0

0

0

0

0

0

0

0

0
```



---

---
title: "[ABC046C] AtCoDeerくんと選挙速報"
layout: "post"
diff: 普及+/提高
pid: AT_arc062_a
tag: []
---

# [ABC046C] AtCoDeerくんと選挙速報

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc046/tasks/arc062_a

シカのAtCoDeerくんは選挙速報を見ています。選挙には二人の候補高橋くんと青木くんが出ています。速報では、現在の二人の得票数の比が表示されていますが、得票数そのものは表示されていません。AtCoDeerくんは $ N $ 回画面を見て、 $ i(1≦i≦N) $ 回目に見たときに表示されている比は $ T_i:A_i $ でした。ここで、AtCoDeerくんが選挙速報の画面を$ 1 $回目に見た段階で既にどちらの候補にも少なくとも一票は入っていたことがわかっています。 $ N $ 回目に画面を見たときの投票数(二人の得票数の和)として考えられるもののうち最小となるものを求めてください。ただし、得票数が途中で減ることはありません。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ T_1 $ $ A_1 $ $ T_2 $ $ A_2 $ $ : $ $ T_N $ $ A_N $

## 输出格式

$ N $ 回目に画面を見たときの投票数として考えられる最小値を出力せよ。

## 说明/提示

### 制約

- $ 1≦N≦1000 $
- $ 1≦T_i,A_i≦1000\ (1≦i≦N) $
- $ T_i $ と $ A_i $ は互いに素 $ (1≦i≦N) $
- 答えが $ 10^{18} $ 以下になることは保証されている

### Sample Explanation 1

二人の得票数が $ 2,3 $ -&gt; $ 3,3 $ -&gt; $ 6,4 $ と動くと投票数は $ 10 $ になって、これが最小値です。

### Sample Explanation 2

一度画面を見てからもう一度画面を見るまでに一票も入ってないことがありえます。

## 样例 #1

### 输入

```
3

2 3

1 1

3 2
```

### 输出

```
10
```

## 样例 #2

### 输入

```
4

1 1

1 1

1 5

1 100
```

### 输出

```
101
```

## 样例 #3

### 输入

```
5

3 10

48 17

31 199

231 23

3 2
```

### 输出

```
6930
```



---

---
title: "[ABC047D] 高橋君と見えざる手"
layout: "post"
diff: 普及+/提高
pid: AT_arc063_b
tag: []
---

# [ABC047D] 高橋君と見えざる手

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc047/tasks/arc063_b

$ N $ 個の町が一直線上に並んでいます。行商人の高橋君は町 $ 1 $ から出発し、リンゴの売買をしながら町 $ N $ へと向かいます。

はじめ高橋君は町 $ 1 $ におり、リンゴを $ 1 $ つも持っていません。高橋君は次のいずれかの行動を繰り返し行います。

- 移動: 町 $ i $ ($ i\ <\ N $) にいるとき、町 $ i\ +\ 1 $ へ移動する。
- リンゴの売買: リンゴを好きな個数だけ売買する。ここで、町 $ i $ ($ 1\ ≦\ i\ ≦\ N $) ではリンゴの買値も売値もともに $ A_i $ 円とする。ここで $ A_i $ は相異なる整数です。

$ 1 $ つの町で売買するリンゴの個数に制限はありませんが、旅の中で売買するリンゴの個数は合計で (買う個数と売る個数を合わせて) $ T $ 個以下にしなくてはなりません。

高橋君は旅の利益、すなわちリンゴを売った代金から買った代金を引いた値を最大にするように旅をするとします。旅が終わったときに持っていたリンゴの価値は考えず、旅の中で売買した金額だけを考えます。

この旅に先立って、青木君は任意の町 $ i $ に対して $ A_i $ を好きな非負整数 $ A_i' $ に変えるという操作を好きなだけ行うことができます。ただし、この操作は行うごとに $ |A_i\ -\ A_i'| $ のコストがかかります。操作後には異なる町の間でリンゴの値段が同じになっていても構いません。

青木君の目的はできるだけ少ない合計コストの操作で高橋君の利益を少なくとも $ 1 $ 円下げることです。合計コストの最小値を求めてください。

ただし、元の状態で高橋君が $ 1 $ 円以上の利益を上げられることは仮定して構いません。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ T $ $ A_1 $ $ A_2 $ $ ... $ $ A_N $

## 输出格式

高橋君の収益を少なくとも $ 1 $ 円下げるために必要な合計コストの最小値を出力せよ。

## 说明/提示

### 制約

- $ 1\ ≦\ N\ ≦\ 10^5 $
- $ 1\ ≦\ A_i\ ≦\ 10^9 $ ($ 1\ ≦\ i\ ≦\ N $)
- $ A_i $ は相異なる
- $ 2\ ≦\ T\ ≦\ 10^9 $
- 入力の状態では高橋君は $ 1 $ 円以上の利益を上げられることが保証される

### Sample Explanation 1

この入力の状態では、高橋君は次のようにして最大の利益である $ 150 $ 円を達成することができます。 1. 町 $ 1 $ から町 $ 2 $ へ移動する。 2. 町 $ 2 $ で $ 50 $ 円を支払い、リンゴを $ 1 $ 個買う。 3. 町 $ 2 $ から町 $ 3 $ へ移動する。 4. 町 $ 3 $ で $ 200 $ 円でリンゴを $ 1 $ 個売る。 たとえば、青木君が町 $ 2 $ のリンゴの値段を $ 50 $ 円から $ 51 $ 円に変えると、高橋君はどのようにしても $ 150 $ 円の利益を上げることができなくなります。すなわち、コスト $ 1 $ で高橋君の利益を少なくとも $ 1 $ 円下げることが可能であり、答えは $ 1 $ となります。 他にも、町 $ 3 $ のリンゴの値段を $ 200 $ 円から $ 199 $ 円に変えることでもコスト $ 1 $ で高橋君の利益を下げることが可能です。

## 样例 #1

### 输入

```
3 2

100 50 200
```

### 输出

```
1
```

## 样例 #2

### 输入

```
5 8

50 30 40 10 20
```

### 输出

```
2
```

## 样例 #3

### 输入

```
10 100

7 10 4 5 9 3 6 8 2 1
```

### 输出

```
2
```



---

---
title: "[ABC059C] Sequence"
layout: "post"
diff: 普及+/提高
pid: AT_arc072_a
tag: []
---

# [ABC059C] Sequence

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc059/tasks/arc072_a

長さ $ N $ の数列があり、$ i $ 番目の数は $ a_i $ です。 あなたは $ 1 $ 回の操作でどれか $ 1 $ つの項の値を $ 1 $ だけ増やすか減らすことができます。

以下の条件を満たすために必要な操作回数の最小値を求めてください。

- すべての$ i\ (1≦i≦n) $ に対し、第 $ 1 $ 項から第 $ i $ 項までの和は $ 0 $ でない
- すべての$ i\ (1≦i≦n-1) $ に対し、$ i $ 項までの和と $ i+1 $ 項までの和の符号が異なる

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ n $ $ a_1 $ $ a_2 $ $ ... $ $ a_n $

## 输出格式

必要な操作回数の最小値を出力せよ。

## 说明/提示

### 制約

- $ 2≦\ n\ ≦\ 10^5 $
- $ |a_i|\ ≦\ 10^9 $
- $ a_i $ は整数

### Sample Explanation 1

例えば、数列を $ 1,\ -2,\ 2,\ -2 $ に $ 4 $ 回の操作で変更することができます。この数列は $ 1,\ 2,\ 3,\ 4 $ 項までの和がそれぞれ $ 1,\ -1,\ 1,\ -1 $ であるため、条件を満たしています。

### Sample Explanation 2

はじめから条件を満たしています。

## 样例 #1

### 输入

```
4

1 -3 1 0
```

### 输出

```
4
```

## 样例 #2

### 输入

```
5

3 -6 4 -5 7
```

### 输出

```
0
```

## 样例 #3

### 输入

```
6

-1 4 3 2 -5 4
```

### 输出

```
8
```



---

---
title: "[ABC059D] Alice&Brown"
layout: "post"
diff: 普及+/提高
pid: AT_arc072_b
tag: []
---

# [ABC059D] Alice&Brown

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc059/tasks/arc072_b

AliceとBrownはゲームをするのが好きです。今日は以下のゲームを思いつきました。

$ 2 $つの山があり、はじめに$ X,\ Y $個の石が置かれています。 AliceとBrownは毎ターン以下の操作を交互に行い、操作を行えなくなったプレイヤーは負けとなります。

- 片方の山から $ 2i $ 個の石を取り、そのうち $ i $ 個の石を捨て、残りの $ i $ 個の石をもう片方の山に置く。ここで、整数 $ i\ (1≦i) $ の値は山に十分な個数の石がある範囲で自由に選ぶことができる。

Aliceが先手で、二人とも最適にプレイすると仮定したとき、与えられた $ X,\ Y $ に対しどちらのプレイヤーが勝つか求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ X $ $ Y $

## 输出格式

Aliceが勝つとき`Alice`と、Brownが勝つとき`Brown`と出力せよ。

## 说明/提示

### 制約

- $ 0≦\ X,\ Y\ ≦\ 10^{18} $

### Sample Explanation 1

Aliceは $ 2 $ 個石のある山から $ 2 $ 個取るしかありません。その結果、山の石の数はそれぞれ $ 0,\ 2 $ 個となり、Brownは $ 2 $ 個の石を取り、山の石の数はそれぞれ $ 1,\ 0 $ 個となります。 Aliceはこれ以上操作を行うことができないので、Brownの勝ちです。

## 样例 #1

### 输入

```
2 1
```

### 输出

```
Brown
```

## 样例 #2

### 输入

```
5 0
```

### 输出

```
Alice
```

## 样例 #3

### 输入

```
0 0
```

### 输出

```
Brown
```

## 样例 #4

### 输入

```
4 8
```

### 输出

```
Alice
```



---

---
title: "[ABC063D] Widespread"
layout: "post"
diff: 普及+/提高
pid: AT_arc075_b
tag: []
---

# [ABC063D] Widespread

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc063/tasks/arc075_b

あなたが散歩していると、突然 $ N $ 体の魔物が出現しました。それぞれの魔物は *体力* という値を持ち、$ i $ 体目の魔物の出現時の体力は $ h_i $ です。体力が $ 0 $ 以下となった魔物は直ちに消滅します。

幸い、あなたは熟練の魔法使いであり、爆発を引き起こして魔物を攻撃できます。一回の爆発では、以下のように魔物の体力を減らすことができます。

- 生存している魔物を一体選び、その魔物を中心に爆発を引き起こす。爆発の中心となる魔物の体力は $ A $ 減り、その他の魔物の体力はそれぞれ $ B $ 減る。ここで、$ A $ と $ B $ はあらかじめ定まった値であり、$ A\ >\ B $ である。

すべての魔物を消し去るためには、最小で何回の爆発を引き起こす必要があるでしょうか？

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ A $ $ B $ $ h_1 $ $ h_2 $ $ : $ $ h_N $

## 输出格式

すべての魔物を消し去るために必要な最小の爆発の回数を出力せよ。

## 说明/提示

### 制約

- 入力値はすべて整数である。
- $ 1\ <\ =\ N\ <\ =\ 10^5 $
- $ 1\ <\ =\ B\ <\ A\ <\ =\ 10^9 $
- $ 1\ <\ =\ h_i\ <\ =\ 10^9 $

### Sample Explanation 1

以下のようにして、$ 2 $ 回の爆発ですべての魔物を消し去ることができます。 - まず、体力が $ 8 $ の魔物を中心に爆発を引き起こす。$ 4 $ 体の魔物の体力はそれぞれ $ 3 $, $ 4 $, $ 1 $, $ -1 $ となり、最後の魔物は消滅する。 - 次に、残りの体力が $ 4 $ の魔物を中心に爆発を引き起こす。残っていた $ 3 $ 体の魔物の体力はそれぞれ $ 0 $, $ -1 $, $ -2 $ となり、すべての魔物が消滅する。

### Sample Explanation 2

それぞれの魔物を中心に $ 2 $ 回ずつ、合計で $ 4 $ 回の爆発を引き起こす必要があります。

## 样例 #1

### 输入

```
4 5 3

8

7

4

2
```

### 输出

```
2
```

## 样例 #2

### 输入

```
2 10 4

20

20
```

### 输出

```
4
```

## 样例 #3

### 输入

```
5 2 1

900000000

900000000

1000000000

1000000000

1000000000
```

### 输出

```
800000000
```



---

---
title: "[ARC075E] Meaningful Mean"
layout: "post"
diff: 普及+/提高
pid: AT_arc075_c
tag: []
---

# [ARC075E] Meaningful Mean

## 题目描述

**题目大意：**
给一个长度为N的整数序列{a},对于其一共N*(N+1)/2个的非空区间，求有多少个区间的平均数大于等于K。

## 输入格式

第一行两个数字分别为 N K
接下来N行 每行一个数字表示a[i]

## 输出格式

输出一个整数 代表有多少个区间的平均数大于等于K

## 说明/提示

输入的全部为整数

1 ≤ N ≤ 2×10^5

1 ≤ K ≤ 10^9

1 ≤ a[i] ≤ 10^9

## 样例 #1

### 输入

```
3 6

7

5

7
```

### 输出

```
5
```

## 样例 #2

### 输入

```
1 2

1
```

### 输出

```
0
```

## 样例 #3

### 输入

```
7 26

10

20

30

40

30

20

10
```

### 输出

```
13
```



---

---
title: "[ABC066D] 11"
layout: "post"
diff: 普及+/提高
pid: AT_arc077_b
tag: []
---

# [ABC066D] 11

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc066/tasks/arc077_b

$ 1,...,n $ の $ n $ 個の整数からなる長さ $ n+1 $ の数列 $ a_1,a_2,...,a_{n+1} $ が与えられます。 この数列には $ 1,...,n $ のどの整数もかならず $ 1 $ 回以上出現することが分かっています。

$ k=1,...,n+1 $ のそれぞれについて、与えられた数列の長さ $ k $ の（連続とは限らない）部分列の個数を求め、 $ 10^9+7 $ で割ったあまりを出力して下さい。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ n $ $ a_1 $ $ a_2 $ ... $ a_{n+1} $

## 输出格式

答えを $ n+1 $ 行に出力せよ。 $ k $ 行目には、長さ $ k $ の部分列の個数を $ 10^9+7 $ で割ったあまりを出力せよ。

## 说明/提示

### 注意

- $ 2 $ つの部分列が数列として同じであれば、元の数列での位置が異なっていたとしても、$ 1 $ 通りと数えます。
- 数列 $ a $ の長さ $ k $ の部分列とは、$ a $ の要素のうち $ k $ 個を選んで、 それらを順番を変えずに取り出して並べた数列のことを指します。 例えば、数列 $ 1,2,3,4,5 $ の長さ $ 3 $ の部分列には、 $ 1,3,5 $ や $ 1,2,3 $ などがあります。 一方で、$ 3,1,2 $ や $ 1,10,100 $ はこの数列の部分列ではありません。

### 制約

- $ 1\ \leq\ n\ \leq\ 10^5 $
- $ 1\ \leq\ a_i\ \leq\ n $
- $ 1,...,n $ のどの整数も必ず数列に出現する。
- $ n,a_i $ は整数である。

### Sample Explanation 1

長さ $ 1 $ の部分列は $ 1 $、$ 2 $、$ 3 $ の $ 3 $ 通りです。 長さ $ 2 $ の部分列は $ 1,1 $、$ 1,2 $、$ 1,3 $、$ 2,1 $、$ 2,3 $ の $ 5 $ 通りです。 長さ $ 3 $ の部分列は $ 1,1,3 $、$ 1,2,1 $、$ 1,2,3 $、$ 2,1,3 $ の $ 4 $ 通りです。 長さ $ 4 $ の部分列は $ 1,2,1,3 $ の $ 1 $ 通りです。

### Sample Explanation 2

長さ $ 1 $ の部分列は $ 1 $ の $ 1 $ 通りです。 長さ $ 2 $ の部分列は $ 1,1 $ の $ 1 $ 通りです。

### Sample Explanation 3

$ 10^9+7 $ で割ったあまりを出力することに注意して下さい。

## 样例 #1

### 输入

```
3

1 2 1 3
```

### 输出

```
3

5

4

1
```

## 样例 #2

### 输入

```
1

1 1
```

### 输出

```
1

1
```

## 样例 #3

### 输入

```
32

29 19 7 10 26 32 27 4 11 20 2 8 16 23 5 14 6 12 17 22 18 30 28 24 15 1 25 3 13 21 19 31 9
```

### 输出

```
32

525

5453

40919

237336

1107568

4272048

13884156

38567100

92561040

193536720

354817320

573166440

818809200

37158313

166803103

166803103

37158313

818809200

573166440

354817320

193536720

92561040

38567100

13884156

4272048

1107568

237336

40920

5456

528

33

1
```



---

---
title: "[ABC074D] Restoring Road Network"
layout: "post"
diff: 普及+/提高
pid: AT_arc083_b
tag: []
---

# [ABC074D] Restoring Road Network

## 题目描述

#### 题面翻译
曾经存在的高桥王国有N个城市，城市与城市之间用长度为正整数的无向道路连接。

现有一考古学家找到了一张N×N的表A，这张表代表了这N座城市两两之间的最短路。即表中的第u行第v列的值代表了从城市u到v的最短路长度。

问能否根据这张表，求出高桥王国的最小道路长度总和。

## 输入格式

第一行：N
下面是大小为N×N的表A

## 输出格式

一个整数，表示最小道路长度总和。如果无解，输出−1
#### 数据范围与约定
- 1 <= N <= 300
- 当 i != j 时，1 <= 表A中第i行第j列的值 == 表A中第j行第i列的值 <= 10^9
- 表A中第i行第i列的值为0
#### 样例1解释
- 从城市1到城市2有长度为1的直接道路
- 从城市2到城市3有长度为2的直接道路
- 从城市1到城市3无直接道路
#### 样例2解释
从城市1走到城市2要走长度为1的道路，从城市2走到城市3要走长度为1的道路，所以从城市1到城市3要走的距离为2，但表中是3，所以无解。

## 样例 #1

### 输入

```
3

0 1 3

1 0 2

3 2 0
```

### 输出

```
3
```

## 样例 #2

### 输入

```
3

0 1 3

1 0 1

3 1 0
```

### 输出

```
-1
```

## 样例 #3

### 输入

```
5

0 21 18 11 28

21 0 13 10 26

18 13 0 23 13

11 10 23 0 17

28 26 13 17 0
```

### 输出

```
82
```

## 样例 #4

### 输入

```
3

0 1000000000 1000000000

1000000000 0 1000000000

1000000000 1000000000 0
```

### 输出

```
3000000000
```



---

---
title: "[ABC081D] Non-decreasing"
layout: "post"
diff: 普及+/提高
pid: AT_arc086_b
tag: []
---

# [ABC081D] Non-decreasing

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc081/tasks/arc086_b

すぬけ君は長さ $ N $ の数列 $ a $ を持っています。$ a $ の ($ 1 $-indexedでの) $ i $ 番目の数は $ a_{i} $ です。

すぬけ君は以下の操作を何度でも行うことができます。

- 操作：$ 1 $ 以上 $ N $ 以下の整数 $ x,y $ を選び、$ a_y $ に $ a_x $ を加算する。

すぬけ君はこの操作を $ 0 $ 回以上 $ 2N $ 回以下行って $ a $ が下記の条件を満たすようにしたいです。そのような操作手順の一例を示してください。 なお、この問題の制約下で、条件を満たすような操作の手順が必ず存在することが証明できます。

- 条件：$ a_1\ \leq\ a_2\ \leq\ ...\ \leq\ a_{N} $

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ a_1 $ $ a_2 $ $ ... $ $ a_{N} $

## 输出格式

操作回数(これを $ m $ とする)を $ 1 $ 行目に出力せよ。 続く $ m $ 行のうち $ i $ 行目には $ i $ 番目の操作で選んだ数 $ x,y $ を空白区切りで出力せよ。 $ m $ が $ 0 $ 以上 $ 2N $ 以下であり、$ m $ 回の操作後に $ a $ が条件を満たしていれば正解となる。

## 说明/提示

### 制約

- $ 2\ \leq\ N\ \leq\ 50 $
- $ -10^{6}\ \leq\ a_i\ \leq\ 10^{6} $
- 与えられる入力は全て整数

### Sample Explanation 1

\- $ 1 $ 番目の操作により $ a\ =\ (-2,5,4) $ となります - $ 2 $ 番目の操作により $ a\ =\ (-2,5,8) $ となり、条件を満たします

### Sample Explanation 2

\- $ 1 $ 番目の操作により $ a\ =\ (-4,-3) $ となり、条件を満たします

### Sample Explanation 3

\- すでに条件を満たしています

## 样例 #1

### 输入

```
3

-2 5 -1
```

### 输出

```
2

2 3

3 3
```

## 样例 #2

### 输入

```
2

-1 -3
```

### 输出

```
1

2 1
```

## 样例 #3

### 输入

```
5

0 0 0 0 0
```

### 输出

```
0
```



---

---
title: "[ABC082D] FT Robot"
layout: "post"
diff: 普及+/提高
pid: AT_arc087_b
tag: []
---

# [ABC082D] FT Robot

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc082/tasks/arc087_b

二次元平面の原点にロボットが置かれています。 最初、ロボットは $ x $ 軸の正の向きを向いています。

このロボットに命令列 $ s $ が与えられます。 $ s $ は次の $ 2 $ 文字のみからなり、先頭から末尾まで順に実行されます。

- `F` : 今向いている向きに長さ $ 1 $ だけ移動する。
- `T` : 時計回りまたは反時計回りの好きな方向に $ 90 $ 度だけ向きを変える。

ロボットの目標は、命令列をすべて実行し終わった後に座標 $ (x,\ y) $ にいることです。 この目標が達成可能か判定してください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ s $ $ x $ $ y $

## 输出格式

目標が達成可能ならば `Yes` を出力し、達成不可能ならば `No` を出力せよ。

## 说明/提示

### 制約

- $ s $ は `F`, `T` のみからなる。
- $ 1\ \leq\ |s|\ \leq\ 8\ 000 $
- $ x $, $ y $ は整数である。
- $ |x|,\ |y|\ \leq\ |s| $

### Sample Explanation 1

$ 1 $ 番目の `T` で反時計周りに $ 90 $ 度だけ向きを変え、$ 2 $ 番目の `T` で時計周りに $ 90 $ 度だけ向きを変えればよいです。

### Sample Explanation 2

$ 1 $ 番目の `T` で時計周りに $ 90 $ 度だけ向きを変え、$ 2 $ 番目の `T` で時計周りに $ 90 $ 度だけ向きを変えればよいです。

### Sample Explanation 5

例えば、$ 1 $ 番目の `T` で反時計周りに $ 90 $ 度だけ向きを変え、$ 2 $ 番目の `T` で反時計周りに $ 90 $ 度だけ向きを変えればよいです。

## 样例 #1

### 输入

```
FTFFTFFF

4 2
```

### 输出

```
Yes
```

## 样例 #2

### 输入

```
FTFFTFFF

-2 -2
```

### 输出

```
Yes
```

## 样例 #3

### 输入

```
FF

1 0
```

### 输出

```
No
```

## 样例 #4

### 输入

```
TF

1 0
```

### 输出

```
No
```

## 样例 #5

### 输入

```
FFTTFF

0 0
```

### 输出

```
Yes
```

## 样例 #6

### 输入

```
TTTT

1 0
```

### 输出

```
No
```



---

---
title: "[ABC092D] Grid Components"
layout: "post"
diff: 普及+/提高
pid: AT_arc093_b
tag: []
---

# [ABC092D] Grid Components

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc092/tasks/arc093_b

$ 2 $ つの整数 $ A,\ B $ が与えられます。

各マスが白または黒に塗られたグリッドであって以下の条件を満たすものを、出力の項で指定されたフォーマットに従って一つ出力してください。

- グリッドの大きさを縦 $ h $ 行横 $ w $ 列としたとき、$ h $ および $ w $ はともに $ 100 $ 以下である。
- 白く塗られたマスの集合はちょうど $ A $ 個の連結成分に分かれている (連結成分という単語の定義については後の注釈を参照)。
- 黒く塗られたマスの集合はちょうど $ B $ 個の連結成分に分かれている。

制約の項で指定される条件のもとで解は必ず一つ以上存在することが証明できます。 解が複数ある場合、どれを出力しても構いません。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ A $ $ B $

## 输出格式

以下の形式で出力せよ。

- $ 1 $ 行目には構成したグリッドの大きさを表す整数 $ h,\ w $ を空白を区切りとして出力せよ。
- 続いて $ h $ 行出力せよ。このうちの $ i $ 行目 ($ 1\ \leq\ i\ \leq\ h $) には以下のような長さ $ w $ の文字列 $ s_i $ を出力せよ。
  - 構成したグリッドの $ i $ 行 $ j $ ($ 1\ \leq\ j\ \leq\ w $) 列のマスが白く塗られているならば、$ s_i $ の $ j $ 文字目は `.` である。
  - 構成したグリッドの $ i $ 行 $ j $ ($ 1\ \leq\ j\ \leq\ w $) 列のマスが黒く塗られているならば、$ s_i $ の $ j $ 文字目は `#` である。

## 说明/提示

### 注釈

$ 2 $ つの白く塗られたマス $ c_1,\ c_2 $が連結であるとは、マス $ c_1 $ からマス $ c_2 $ へ、上下左右に隣り合うマスへの移動を繰り返して、 白く塗られたマスだけを通って移動できることを意味します。

白く塗られたマスの集合 $ S $ が連結成分であるとは、$ S $ が以下の条件を満たすことを意味します。

- $ S $ のどの $ 2 $ つのマスも連結である。
- $ S $ に含まれないどの白く塗られたマスと、$ S $ に含まれるどのマスも連結ではない。

黒く塗られたマスについても連結成分を同様に定義します。

### 制約

- $ 1\ \leq\ A\ \leq\ 500 $
- $ 1\ \leq\ B\ \leq\ 500 $

### Sample Explanation 1

この出力は以下のグリッドに対応します。 !\[2701558bf42f7c088abad927b419472a.png\](https://img.atcoder.jp/arc093/2701558bf42f7c088abad927b419472a.png)

## 样例 #1

### 输入

```
2 3
```

### 输出

```
3 3

##.

..#

#.#
```

## 样例 #2

### 输入

```
7 8
```

### 输出

```
3 5

#.#.#

.#.#.

#.#.#
```

## 样例 #3

### 输入

```
1 1
```

### 输出

```
4 2

..

#.

##

##
```

## 样例 #4

### 输入

```
3 14
```

### 输出

```
8 18

..................

..................

....##.......####.

....#.#.....#.....

...#...#....#.....

..#.###.#...#.....

.#.......#..#.....

#.........#..####.
```



---

---
title: "[ABC093D] Worst Case"
layout: "post"
diff: 普及+/提高
pid: AT_arc094_b
tag: []
---

# [ABC093D] Worst Case

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc093/tasks/arc094_b

高橋君を含めた $ 10^{10^{10}} $ 人の参加者が $ 2 $ 回のプログラミングコンテストに参加しました。 各コンテストでは全員に $ 1 $ 位から $ 10^{10^{10}} $ 位までの相異なる順位がつきました。

参加者のスコアとは、$ 2 $ 回のコンテストでの順位を掛け合わせた値です。

次のクエリ $ Q $ 個に答えてください。

- $ i $ 個目のクエリでは、$ 2 $ つの正の整数 $ A_i,B_i $ が与えられる。高橋君が $ 1 $ 回目のコンテストで $ A_i $ 位、$ 2 $ 回目のコンテストで $ B_i $ 位を取ったと仮定して、高橋君よりスコアの小さい参加者の人数の最大値を求めよ。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ Q $ $ A_1 $ $ B_1 $ $ : $ $ A_Q $ $ B_Q $

## 输出格式

クエリごとに、高橋君よりスコアの小さい参加者の人数の最大値を出力せよ。

## 说明/提示

### 制約

- $ 1\ \leq\ Q\ \leq\ 100 $
- $ 1\leq\ A_i,B_i\leq\ 10^9(1\leq\ i\leq\ Q) $
- 入力はすべて整数である

### Sample Explanation 1

$ 1 $ 回目のコンテストで $ x $ 位を、$ 2 $ 回目のコンテストで $ y $ 位を取った参加者を $ (x,y) $ で表すことにします。 $ 1 $ つめのクエリでは、高橋君よりスコアの小さい参加者として $ (2,1) $ が考えられます。$ 2 $ 人以上のスコアが高橋君のスコアより小さくなることはないため、$ 1 $ を出力します。

## 样例 #1

### 输入

```
8

1 4

10 5

3 3

4 11

8 9

22 40

8 36

314159265 358979323
```

### 输出

```
1

12

4

11

14

57

31

671644785
```



---

---
title: "[ABC095D] Static Sushi"
layout: "post"
diff: 普及+/提高
pid: AT_arc096_b
tag: []
---

# [ABC095D] Static Sushi

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc095/tasks/arc096_b

日本料理店「停止寿司」は円形のカウンターが一つあるだけのシンプルな店です。カウンターの外周の長さは $ C $ メートルで、カウンターの内部に客が立ち入ることはできません。

中橋くんが入店し、カウンターのそばまで案内されました。いま、カウンター上には $ N $ 貫の寿司が置かれています。そのうち $ i $ 貫目は中橋くんがいる位置から $ x_i $ メートル時計回りに進んだ位置に置かれており、$ v_i $ キロカロリーの栄養価を持ちます。

中橋くんはカウンターの外周を自由に歩き回ることができます。寿司が置かれている位置にたどり着いたら、その寿司を食べて寿司が持つ栄養価を摂取することができます（当然、その寿司は消えます）。ただし、歩く際に $ 1 $ メートルあたり $ 1 $ キロカロリーを消費します。

満足したら、いつでも好きな位置から店を出ることができます（始めにいた位置に戻らなくても構いません）。店を出るまでに最大で差し引き何キロカロリーを摂取することができるでしょうか？すなわち、退店するまでに摂取した栄養価の合計から消費したエネルギーを引いた値の最大値はいくらでしょうか？なお、他に客はおらず、新たな寿司がカウンターに追加されることもないものとします。また、中橋くんは十分な栄養を蓄えているため、どれだけ歩いてエネルギーを消費しても餓死しないものとします。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ C $ $ x_1 $ $ v_1 $ $ x_2 $ $ v_2 $ $ : $ $ x_N $ $ v_N $

## 输出格式

退店するまでに差し引きで最大 $ c $ キロカロリーを摂取できるとき、$ c $ の値を出力せよ。

## 说明/提示

### 制約

- $ 1\ <\ =\ N\ <\ =\ 10^5 $
- $ 2\ <\ =\ C\ <\ =\ 10^{14} $
- $ 1\ <\ =\ x_1\ <\ x_2\ <\ ...\ <\ x_N\ <\ C $
- $ 1\ <\ =\ v_i\ <\ =\ 10^9 $
- 入力中のすべての値は整数である。

### 部分点

- $ N\ <\ =\ 100 $ を満たすテストセットに正解すると、$ 300 $ 点が与えられる。

### Sample Explanation 1

外周 $ 20 $ メートルのカウンターに $ 3 $ 貫の寿司が置かれています。中橋くんの始めの位置から時計回りに $ 2 $ メートル歩くと、$ 80 $ キロカロリーの寿司を食べることができます。さらに時計回りに $ 7 $ メートル歩くと、$ 120 $ キロカロリーの寿司を食べることができます。ここで退店すると、摂取した栄養価の合計は $ 200 $ キロカロリー、消費したエネルギーの合計は $ 9 $ キロカロリーで、差し引き $ 191 $ キロカロリーを摂取することができ、これが最大の値です。

### Sample Explanation 2

$ 2 $ 貫目と $ 3 $ 貫目の寿司の位置が入れ替わりました。再び、中橋くんの始めの位置から時計回りに $ 2 $ メートル歩くと、$ 80 $ キロカロリーの寿司を食べることができます。今回はここで向きを変え、反時計回りに $ 6 $ メートル歩くと、$ 120 $ キロカロリーの寿司を食べることができます。ここで退店すると、摂取した栄養価の合計は $ 200 $ キロカロリー、消費したエネルギーの合計は $ 8 $ キロカロリーで、差し引き $ 192 $ キロカロリーを摂取することができ、これが最大の値です。

### Sample Explanation 3

唯一の寿司が $ 32 $ bit 整数に収まらないほど遠くにあるわりに栄養価が低いため、何もせず直ちに退店するべきです。

### Sample Explanation 4

以上のすべての入力例は、部分点のためのテストセットに含まれます。

## 样例 #1

### 输入

```
3 20

2 80

9 120

16 1
```

### 输出

```
191
```

## 样例 #2

### 输入

```
3 20

2 80

9 1

16 120
```

### 输出

```
192
```

## 样例 #3

### 输入

```
1 100000000000000

50000000000000 1
```

### 输出

```
0
```

## 样例 #4

### 输入

```
15 10000000000

400000000 1000000000

800000000 1000000000

1900000000 1000000000

2400000000 1000000000

2900000000 1000000000

3300000000 1000000000

3700000000 1000000000

3800000000 1000000000

4000000000 1000000000

4100000000 1000000000

5200000000 1000000000

6600000000 1000000000

8000000000 1000000000

9300000000 1000000000

9700000000 1000000000
```

### 输出

```
6500000000
```



---

---
title: "[ABC102D] Equal Cut"
layout: "post"
diff: 普及+/提高
pid: AT_arc100_b
tag: []
---

# [ABC102D] Equal Cut

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc102/tasks/arc100_b

すぬけ君は、長さ $ N $ の整数列 $ A $ を持っています。

すぬけ君は $ A $ を $ 3 $ 箇所で切って、$ 4 $ つの（空でない）連続する部分列 $ B,C,D,E $ に分解します。 切る位置は自由に選ぶことができます。

ここで、整数列 $ B,C,D,E $ について、その要素の総和をそれぞれ $ P,Q,R,S $ とおきます。 すぬけ君は、$ P,Q,R,S $ の最大値と最小値の差の絶対値が小さいほど嬉しいです。 $ P,Q,R,S $ の最大値と最小値の差の絶対値としてあり得る最も小さい値を求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ A_1 $ $ A_2 $ $ ... $ $ A_N $

## 输出格式

$ P,Q,R,S $ の最大値と最小値の差の絶対値としてあり得る最も小さい値を出力せよ。

## 说明/提示

### 制約

- $ 4\ \leq\ N\ \leq\ 2\ \times\ 10^5 $
- $ 1\ \leq\ A_i\ \leq\ 10^9 $
- 入力はすべて整数である。

### Sample Explanation 1

$ B,C,D,E=(3),(2),(4),(1,2) $ と分割すれば、$ P=3,Q=2,R=4,S=1+2=3 $ となります。 このとき、$ P,Q,R,S $ の最大値は $ 4 $、最小値は $ 2 $ で、その差の絶対値は $ 2 $ です。 最大値と最小値の差の絶対値を $ 2 $ 未満にすることは出来ないため、$ 2 $ が答えになります。

## 样例 #1

### 输入

```
5

3 2 4 1 2
```

### 输出

```
2
```

## 样例 #2

### 输入

```
10

10 71 84 33 6 47 23 25 52 64
```

### 输出

```
36
```

## 样例 #3

### 输入

```
7

1 2 3 1000000000 4 5 6
```

### 输出

```
999999994
```



---

---
title: "[ARC107C] Shuffle Permutation"
layout: "post"
diff: 普及+/提高
pid: AT_arc107_c
tag: []
---

# [ARC107C] Shuffle Permutation

## 题目描述

[problemUrl]: https://atcoder.jp/contests/arc107/tasks/arc107_c

$ N\ \times\ N $ の行列と、整数 $ K $ が与えられます。この行列の $ i $ 行目、$ j $ 列目の値を $ a_{i,\ j} $ とします。この行列は、 $ 1,\ 2,\ \dots,\ N^2 $ をちょうど一つずつ要素に含みます。

sigma くんは、以下の $ 2 $ 種類の操作を、好きな順序で **好きな回数** 行えます。

- 全ての $ i $ ($ 1\ \leq\ i\ \leq\ N $) について $ a_{i,\ x}\ +\ a_{i,\ y}\ \leq\ K $ を満たす $ x,\ y(1\ \leq\ x\ <\ y\ \leq\ N) $ を選び、行列の $ x,\ y $ 列目をswapする。
- 全ての $ i $ ($ 1\ \leq\ i\ \leq\ N $) について $ a_{x,\ i}\ +\ a_{y,\ i}\ \leq\ K $ を満たす $ x,\ y(1\ \leq\ x\ <\ y\ \leq\ N) $ を選び、行列の $ x,\ y $ 行目をswapする。

最終的に得られる行列は何種類存在するでしょうか？ $ \bmod\ 998244353 $ で答えてください。

## 输入格式

入力は以下の形式で標準入力から与えられる．

> $ N $ $ K $ $ a_{1,\ 1} $ $ a_{1,\ 2} $ $ ... $ $ a_{1,\ N} $ $ a_{2,\ 1} $ $ a_{2,\ 2} $ $ ... $ $ a_{2,\ N} $ $ : $ $ a_{N,\ 1} $ $ a_{N,\ 2} $ $ ... $ $ a_{N,\ N} $

## 输出格式

最終的に得られる行列が何種類存在するかを $ \bmod\ 998244353 $ で出力せよ。

## 说明/提示

### 制約

- $ 1\ \leq\ N\ \leq\ 50 $
- $ 1\ \leq\ K\ \leq\ 2\ \times\ N^2 $
- $ a_{i,\ j} $ は $ 1,\ 2,\ \dots,\ N^2 $ の並び替え
- 入力される数は全て整数である。

### Sample Explanation 1

例えば $ x\ =\ 1,\ y\ =\ 2 $ として列ベクトルを swap でき、以下のようになります。 ``` 2 3 7 8 4 9 6 1 5 ``` その後更に $ x\ =\ 1,\ y\ =\ 3 $ として行ベクトルを swap でき、以下のようになります。 ``` 6 1 5 8 4 9 2 3 7 ```

## 样例 #1

### 输入

```
3 13

3 2 7

4 8 9

1 6 5
```

### 输出

```
12
```

## 样例 #2

### 输入

```
10 165

82 94 21 65 28 22 61 80 81 79

93 35 59 85 96 1 78 72 43 5

12 15 97 49 69 53 18 73 6 58

60 14 23 19 44 99 64 17 29 67

24 39 56 92 88 7 48 75 36 91

74 16 26 10 40 63 45 76 86 3

9 66 42 84 38 51 25 2 33 41

87 54 57 62 47 31 68 11 83 8

46 27 55 70 52 98 20 77 89 34

32 71 30 50 90 4 37 95 13 100
```

### 输出

```
348179577
```



---

---
title: "[ARC108C] Keep Graph Connected"
layout: "post"
diff: 普及+/提高
pid: AT_arc108_c
tag: []
---

# [ARC108C] Keep Graph Connected

## 题目描述

[problemUrl]: https://atcoder.jp/contests/arc108/tasks/arc108_c

$ 1 $ から $ N $ の番号がついた $ N $ 個の頂点と $ 1 $ から $ M $ の番号がついた $ M $ 本の辺からなる連結な無向グラフが与えられます。 このグラフに多重辺は存在するかもしれませんが、自己ループはありません。

このグラフのそれぞれの辺には $ 1 $ 以上 $ N $ 以下の整数で表されるラベルがついています。 辺 $ i $ はラベル $ c_i $ がついており、頂点 $ u_i,v_i $ を双方向につなぐ辺です。

すぬけ君はそれぞれの頂点に $ 1 $ 以上 $ N $ 以下の整数を書き込んだのち(頂点に書き込まれた整数に重複があっても構いません)、以下の条件を満たす辺のみを残してそれ以外の辺を取り除くことにしました。

**条件**：辺の両端の頂点に書き込まれた整数を $ x,y $ として、$ x,y $ のいずれか一方**のみ**が辺についたラベルと等しい

上記の条件を満たさない辺を取り除いたあとのグラフも連結のままであるような頂点への整数の書き込み方を *よい書き込み方* と呼びます。よい書き込み方が存在するかどうかを判定し、存在するならばその一例を示してください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ M $ $ u_1 $ $ v_1 $ $ c_1 $ $ \vdots $ $ u_M $ $ v_M $ $ c_M $

## 输出格式

よい書き込み方が存在しないならば `No` を出力せよ。 存在する場合、$ N $ 行出力せよ。$ i $ 行目には頂点 $ i $ に書き込む整数を出力せよ。 この書き込み方がよい書き込み方ならば正解となる。

## 说明/提示

### 制約

- $ 2\ \leq\ N\ \leq\ 10^5 $
- $ N-1\ \leq\ M\ \leq\ 2\ \times\ 10^5 $
- $ 1\ \leq\ u_i,v_i,c_i\ \leq\ N $
- 与えられるグラフは連結
- 与えられるグラフに自己ループはない

### Sample Explanation 1

\- 頂点 $ 1,2,3 $ にそれぞれ $ 1,2,1 $ を書き込みます。 - 辺 $ 1 $ は頂点 $ 1,2 $ をつないでおり、ラベルが $ 1 $ です。 - 頂点 $ 1 $ に書き込まれた整数のみが辺についたラベルと等しいため辺 $ 1 $ は取り除かれません。 - 辺 $ 2 $ は頂点 $ 2,3 $ をつないでおり、ラベルが $ 2 $ です。 - 頂点 $ 2 $ に書き込まれた整数のみが辺についたラベルと等しいため辺 $ 2 $ は取り除かれません。 - 辺 $ 3 $ は頂点 $ 1,3 $ をつないでおり、ラベルが $ 3 $ です。 - どちらの頂点に書き込まれた整数も辺についたラベルと異なるため辺 $ 3 $ は取り除かれます。 - 辺 $ 4 $ は頂点 $ 1,3 $ をつないでおり、ラベルが $ 1 $ です。 - どちらの頂点に書き込まれた整数も辺についたラベルと等しいため辺 $ 4 $ は取り除かれます。 - 辺 $ 3,4 $ が取り除かれたあともグラフは連結なので、この書き込み方はよい書き込み方です。

## 样例 #1

### 输入

```
3 4

1 2 1

2 3 2

3 1 3

1 3 1
```

### 输出

```
1

2

1
```



---

---
title: "[ARC111B] Reversible Cards"
layout: "post"
diff: 普及+/提高
pid: AT_arc111_b
tag: []
---

# [ARC111B] Reversible Cards

## 题目描述

[problemUrl]: https://atcoder.jp/contests/arc111/tasks/arc111_b

$ 1 $ から $ N $ の番号がついた $ N $ 枚のカードがあり、各カードの両面には正整数で表される色がついています。

カード $ i $ の片面の色は $ a_i $, もう片面の色は $ b_i $ です。

各カードについてどちらの面を表にするか自由に選べるとき、表側に見える色の種類数の最大値はいくつになるか求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ a_1 $ $ b_1 $ $ a_2 $ $ b_2 $ $ : $ $ a_N $ $ b_N $

## 输出格式

答えを出力せよ。

## 说明/提示

### 制約

- $ 1\ \leq\ N\ \leq\ 200000 $
- $ 1\ \leq\ a_i,b_i\ \leq\ 400000 $
- 入力される数はすべて整数

### Sample Explanation 1

それぞれ、$ 1 $,$ 3 $,$ 4 $,$ 2 $ の側を表にすることで $ 4 $ 色を達成できます。

### Sample Explanation 2

そもそも一色しか使われていません。

## 样例 #1

### 输入

```
4

1 2

1 3

4 2

2 3
```

### 输出

```
4
```

## 样例 #2

### 输入

```
2

111 111

111 111
```

### 输出

```
1
```

## 样例 #3

### 输入

```
12

5 2

5 6

1 2

9 7

2 7

5 5

4 2

6 7

2 2

7 8

9 7

1 8
```

### 输出

```
8
```



---

---
title: "[ARC113D] Sky Reflector"
layout: "post"
diff: 普及+/提高
pid: AT_arc113_d
tag: []
---

# [ARC113D] Sky Reflector

## 题目描述

[problemUrl]: https://atcoder.jp/contests/arc113/tasks/arc113_d

縦 $ N $ マス横 $ M $ マスのマス目の各マスに $ 1 $ 以上 $ K $ 以下の整数をひとつずつ書き込み、列 $ A,B $ を以下のように定義します。

- $ i=1,\dots,\ N $ に対し、$ A_i $ は $ i $ 行目のマスに書かれた整数の最小値
- $ j=1,\dots,\ M $ に対し、$ B_j $ は $ j $ 列目のマスに書かれた整数の最大値

$ N,M,K $ が与えられるので、列対 $ (A,B) $ としてありうる相異なるものの個数を $ 998244353 $ で割った余りを求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ M $ $ K $

## 输出格式

列対 $ (A,B) $ としてありうる相異なるものの個数を $ 998244353 $ で割った余りを出力せよ。

## 说明/提示

### 制約

- $ 1\ \leq\ N,M,K\ \leq\ 2\times\ 10^5 $
- 入力はすべて整数である

### Sample Explanation 1

$ (A_1,A_2,B_1,B_2) $ としてありうるものは、$ (1,1,1,1),(1,1,1,2),(1,1,2,1),(1,1,2,2),(1,2,2,2),(2,1,2,2),(2,2,2,2) $ の $ 7 $ 通りです。

## 样例 #1

### 输入

```
2 2 2
```

### 输出

```
7
```

## 样例 #2

### 输入

```
1 1 100
```

### 输出

```
100
```

## 样例 #3

### 输入

```
31415 92653 58979
```

### 输出

```
469486242
```



---

---
title: "[ARC116C] Multiple Sequences"
layout: "post"
diff: 普及+/提高
pid: AT_arc116_c
tag: []
---

# [ARC116C] Multiple Sequences

## 题目描述

[problemUrl]: https://atcoder.jp/contests/arc116/tasks/arc116_c

整数 $ N $ , $ M $ が与えられます。 長さ $ N $ の整数列 $ A $ であって、以下の条件を満たすものの数を答えてください。

- $ 1\ \leq\ A_i\ \leq\ M\ \left(i\ =\ 1,\ 2,\ \ldots,\ N\right) $
- $ A_{i+1} $ は $ A_i $ の倍数 $ \left(i\ =\ 1,\ 2,\ \ldots,\ N\ -\ 1\right) $

ただし、答えは非常に大きくなる場合があるので、 $ 998244353 $ で割った余りを答えてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ M $

## 输出格式

答えを出力せよ。

## 说明/提示

### 制約

- 入力は全て整数
- $ 1\ \leq\ N\ \leq\ 2\ \times\ 10^5 $
- $ 1\ \leq\ M\ \leq\ 2\ \times\ 10^5 $

### Sample Explanation 1

条件を満たす数列 $ A $ として、例えば以下のようなものが考えられます。 - $ A\ =\ \left(1,\ 1,\ 4\right) $ - $ A\ =\ \left(3,\ 3,\ 3\right) $ - $ A\ =\ \left(1,\ 2,\ 4\right) $

## 样例 #1

### 输入

```
3 4
```

### 输出

```
13
```

## 样例 #2

### 输入

```
20 30
```

### 输出

```
71166
```

## 样例 #3

### 输入

```
200000 200000
```

### 输出

```
835917264
```



---

---
title: "[ARC116D] I Wanna Win The Game"
layout: "post"
diff: 普及+/提高
pid: AT_arc116_d
tag: []
---

# [ARC116D] I Wanna Win The Game

## 题目描述

[problemUrl]: https://atcoder.jp/contests/arc116/tasks/arc116_d

整数 $ N $ , $ M $ が与えられます。 長さ $ N $ の整数列 $ A $ であって、以下の条件を満たすものの数を答えてください。

- $ 0\ \leq\ A_i\ \left(i\ =\ 1,\ 2,\ \ldots,\ N\right) $
- $ \sum_{i\ =\ 1}^{N}\ A_i\ =\ M $
- $ A_1 $ xor $ A_2 $ xor $ \cdots $ xor $ A_N\ =\ 0 $ （ここで xor はビットごとの排他的論理和を表す）

ただし、答えは非常に大きくなる場合があるので、 $ 998244353 $ で割った余りを答えてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ M $

## 输出格式

答えを出力せよ。

## 说明/提示

### 制約

- 入力は全て整数
- $ 1\ \leq\ N\ \leq\ 5000 $
- $ 1\ \leq\ M\ \leq\ 5000 $

### Sample Explanation 1

条件を満たす数列 $ A $ として、例えば以下のようなものが考えられます。 - $ A\ =\ \left(10,\ 0,\ 10,\ 0,\ 0\right) $ - $ A\ =\ \left(1,\ 2,\ 3,\ 7,\ 7\right) $

## 样例 #1

### 输入

```
5 20
```

### 输出

```
475
```

## 样例 #2

### 输入

```
10 5
```

### 输出

```
0
```

## 样例 #3

### 输入

```
3141 2718
```

### 输出

```
371899128
```



---

---
title: "[ARC119C] ARC Wrecker 2"
layout: "post"
diff: 普及+/提高
pid: AT_arc119_c
tag: []
---

# [ARC119C] ARC Wrecker 2

## 题目描述

---

给出一个长度为 $n$ $(2\le n\le 3\times 10^5)$ 的正整数序列 $A_i$ $(1\le A_i\le 10^9)$，您可以进行以下两种操作：

- 操作 $1$：选定整数 x $(l\le x<r)$，$A_x \leftarrow A_x+1$，$A_{x+1} \leftarrow A_{x+1}+1$

- 操作 $2$：选定整数 x $(l\le x<r)$，$A_x \leftarrow A_x-1$，$A_{x+1} \leftarrow A_{x+1}-1$

**您需要保证任意时刻 $A_i$ 非负**。求问有多少个数对 $(l,r)$ 满足可以通过任意次操作使得 $A_l,A_{l+1}\ ...\ A_r$ 均为零？操作之间不互相影响。

翻译 by wukaichen888

## 输入格式

输入共两行，第一行含一个正整数 $n$。

第二行包括 $n$ 个正整数，表示序列。

## 输出格式

一行，表示答案，行末换行。

### 样例解释

#### 样例#1

数对 $(2,3),(4,5),(2,5)$ 符合要求。

#### 样例#2

数对 $(2,4),(3,7),(4,5)$ 符合要求。

其中，对于 $(l,r)=(3,7)$，下图为合法方案之一。

![](https://img.atcoder.jp/arc119/392b686a479008a3dbc3fb36893ed144.png)

## 样例 #1

### 输入

```
5

5 8 8 6 6
```

### 输出

```
3
```

## 样例 #2

### 输入

```
7

12 8 11 3 3 13 2
```

### 输出

```
3
```

## 样例 #3

### 输入

```
10

8 6 3 9 5 4 7 2 1 10
```

### 输出

```
1
```

## 样例 #4

### 输入

```
14

630551244 683685976 249199599 863395255 667330388 617766025 564631293 614195656 944865979 277535591 390222868 527065404 136842536 971731491
```

### 输出

```
8
```



---

---
title: "[ARC125C] LIS to Original Sequence"
layout: "post"
diff: 普及+/提高
pid: AT_arc125_c
tag: []
---

# [ARC125C] LIS to Original Sequence

## 题目描述

# [ARC125C] LIS to Original Sequence


[problemUrl]: https://atcoder.jp/contests/arc125/tasks/arc125_c

给定一个长度为 $k$ 的序列 $A_1,A_2,\cdots,A_n$，试求出长度为 $n$ 的序列 $P$，使得 $P$ 的最长上升子序列为 $A_1,A_2,\cdots,A_n$，且 $P$ 的字典序最小。


## 样例 #1

### 样例输入 #1

```
3 2
2 3
```

### 样例输出 #1

```
2 1 3
```

## 样例 #2

### 样例输入 #2

```
5 1
4
```

### 样例输出 #2

```
5 4 3 2 1
```

## 输入格式

第一行两个用空格隔开的整数 $n,k$。

第二行 $n$ 个整数，分别为 $A_1,A_2,\cdots,A_n$。

## 说明/提示

- $ 1\ \leq\ K\ \leq\ N\ \leq\ 2\ \times\ 10^5 $
- $ 1\ \leq\ A_1\ <\ A_2\ <\ \cdots\ <\ A_K\ \leq\ N $
- 输入的所有值均为整数。

### 样例一解释

当 $P=（2，1，3）$ 或 $（2，3，1）$ 时，$P$ 的最长上升子序列与 $A$ 一样。 其中，$（2，1，3）$的字典序最小。

## 样例 #1

### 输入

```
3 2

2 3
```

### 输出

```
2 1 3
```

## 样例 #2

### 输入

```
5 1

4
```

### 输出

```
5 4 3 2 1
```



---

---
title: "[ARC126B] Cross-free Matching"
layout: "post"
diff: 普及+/提高
pid: AT_arc126_b
tag: []
---

# [ARC126B] Cross-free Matching

## 题目描述

[problemUrl]: https://atcoder.jp/contests/arc126/tasks/arc126_b

座標平面上に、$ x $ 座標が $ 1,\ 2,\ \ldots,\ N $、$ y $ 座標が $ 0 $ または $ 1 $ であるような合計 $ 2N $ 個の頂点 $ (1,\ 0),\ldots,\ (N,0),\ (1,1),\ \ldots,\ (N,1) $ があります。 これらのうちの $ 2 $ 頂点を結ぶ線分が $ M $ 個あり、$ i $ 番目の線分は $ (a_i,\ 0) $ と $ (b_i,\ 1) $ を結んでいます。

これら $ M $ 個の線分から $ K $ 個の線分を選び、選んだ線分のうちどの $ 2 $ 個の線分も同一の点を含まないようにすることを考えます。ただし、線分の両端点も線分に含まれる点として扱います。可能な $ K $ の最大値を求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられます。

> $ N $ $ M $ $ a_1 $ $ b_1 $ $ \vdots $ $ a_M $ $ b_M $

## 输出格式

可能な $ K $ の最大値を出力してください。

## 说明/提示

### 制約

- $ 1\leq\ N,\ M\ \leq\ 2\times\ 10^5 $
- $ 1\leq\ a_i,\ b_i\leq\ N $
- $ i\neq\ j $ ならば、$ a_i\neq\ a_j $ または $ b_i\neq\ b_j $

### Sample Explanation 1

$ 1,\ 2 $ 番目の線分を選ぶことが、最適解のひとつです。 例えば $ 1 $ 番目の線分と $ 3 $ 番目の線分は同一の点 $ \left(\frac53,\ \frac23\right) $ を含むため、同時に選ぶことはできません。 !\[\](https://img.atcoder.jp/arc126/3e4cb12392855ea49b7ed0b643ebd370.png)

### Sample Explanation 2

$ 1,\ 3,\ 5 $ 番目の線分を選ぶことが、最適解のひとつです。 例えば $ 1 $ 番目の線分と $ 2 $ 番目の線分は同一の点 $ (1,\ 1) $ を含むため、同時に選ぶことはできません。 !\[\](https://img.atcoder.jp/arc126/416681cace776c87fac353e0acb9c4a1.png)

### Sample Explanation 3

!\[\](https://img.atcoder.jp/arc126/2436c39ccc0fa35fc57d35647bce9f08.png)

## 样例 #1

### 输入

```
3 3

1 2

2 3

3 1
```

### 输出

```
2
```

## 样例 #2

### 输入

```
3 5

1 1

2 1

2 2

3 2

3 3
```

### 输出

```
3
```

## 样例 #3

### 输入

```
7 5

1 7

7 1

3 4

2 6

5 2
```

### 输出

```
1
```



---

---
title: "[ARC127B] Ternary Strings"
layout: "post"
diff: 普及+/提高
pid: AT_arc127_b
tag: []
---

# [ARC127B] Ternary Strings

## 题目描述

[problemUrl]: https://atcoder.jp/contests/arc127/tasks/arc127_b

整数 $ N,L $ が与えられます． 以下の条件をすべて満たす $ 3N $ 個の文字列の組 $ (S_1,S_2,\cdots,S_{3N}) $ を一つ求めてください．

- $ S_i $ は `0`, `1`, `2` からなる長さ $ L $ の文字列である．
- $ S_i $ はすべて互いに異なる．
- すべての $ j $ ($ 1\ \leq\ j\ \leq\ L $) および $ c= $`0`, `1`, `2` について，次が成り立つ．
  
  
  - $ S_i $ のうち，$ j $ 文字目が $ c $ であるようなものはちょうど $ N $ 個存在する．
- $ S_1,S_2,\cdots,S_{3N} $ の中で，辞書順で最も大きい文字列を $ t $ で表すことにする． このときの $ t $ は，$ t $ としてありうる文字列の中で辞書順最小の文字列である．

## 输入格式

入力は以下の形式で標準入力から与えられる．

> $ N $ $ L $

## 输出格式

以下の形式で答えを出力せよ．

> $ S_1 $ $ S_2 $ $ \vdots $ $ S_{3N} $

なお，条件を満たす解が複数存在する場合，どれを出力しても正解とみなされる．

## 说明/提示

### 制約

- $ 1\ \leq\ N\ \leq\ 5\ \times\ 10^4 $
- $ 1\ \leq\ L\ \leq\ 15 $
- $ 3N\ \leq\ 3^L $
- 入力される値はすべて整数である

### Sample Explanation 1

この出力例はすべての条件を満たしています． 例えば，$ 2 $ 文字目が `0` であるような文字列は $ 2 $ 個存在しています． また，この例では $ t= $`21` ですが，$ t $ がこれより辞書順で小さくなることはありません．

## 样例 #1

### 输入

```
2 2
```

### 输出

```
00

02

11

12

20

21
```



---

---
title: "[ARC128C] Max Dot"
layout: "post"
diff: 普及+/提高
pid: AT_arc128_c
tag: []
---

# [ARC128C] Max Dot

## 题目描述

[problemUrl]: https://atcoder.jp/contests/arc128/tasks/arc128_c

整数 $ N,M,S $，及び長さ $ N $ の整数列 $ A=(A_1,A_2,\cdots,A_N) $ が与えられます．

次の条件をすべて満たす長さ $ N $ の非負**実数**列 $ x=(x_1,x_2,\cdots,x_N) $ を作ることを考えます．

- $ 0\ \leq\ x_1\ \leq\ x_2\ \leq\ \cdots\ \leq\ x_N\ \leq\ M $
- $ \sum_{1\ \leq\ i\ \leq\ N}\ x_i=S $

ここで，$ x $ のスコアを $ \sum_{1\ \leq\ i\ \leq\ N}\ A_i\ \times\ x_i $ と定義します． $ x $ のスコアとしてありうる最大の値を求めてください．

## 输入格式

入力は以下の形式で標準入力から与えられる．

> $ N $ $ M $ $ S $ $ A_1 $ $ A_2 $ $ \cdots $ $ A_N $

## 输出格式

答えを出力せよ． 絶対誤差または相対誤差が $ 10^{-6} $ 以内であれば，正解と判定される．

## 说明/提示

### 制約

- $ 1\ \leq\ N\ \leq\ 5000 $
- $ 1\ \leq\ M\ \leq\ 10^6 $
- $ 1\ \leq\ S\ \leq\ \min(N\ \times\ M,10^6) $
- $ 1\ \leq\ A_i\ \leq\ 10^6 $
- 入力される値はすべて整数である

### Sample Explanation 1

$ x=(0,1,2) $ とするのが最適です．

### Sample Explanation 2

$ x=(2/3,2/3,2/3) $ とするのが最適です．

## 样例 #1

### 输入

```
3 2 3

1 2 3
```

### 输出

```
8.00000000000000000000
```

## 样例 #2

### 输入

```
3 3 2

5 1 1
```

### 输出

```
4.66666666666666666667
```

## 样例 #3

### 输入

```
10 234567 1000000

353239 53676 45485 617014 886590 423581 172670 928532 312338 981241
```

### 输出

```
676780145098.25000000000000000000
```



---

---
title: "[ARC133B] Dividing Subsequence"
layout: "post"
diff: 普及+/提高
pid: AT_arc133_b
tag: []
---

# [ARC133B] Dividing Subsequence

## 题目描述

**【题目大意】**

给定两个长度为 $n(n\le 2\times 10^5)$ 的 $1\sim n$ 的排列 $\text{P}$ 和 $\text{Q}$。

现在需要在 $\text{P}$ 和 $\text{Q}$ 中分别取出长度为 $k$ 两个子序列 $\text{A}$ 和 $\text{B}$，满足 $\forall i\in [1,k],a_i\mid b_i$。

最大化 $k$，求 $k$。

## 输入格式

共三行。

第一行一个整数 $n$。

第二行 $n$ 个整数表示排列 $\text{P}$。

第三行 $n$ 个整数表示排列 $\text{Q}$。

## 输出格式

一行一个整数 $k$ 表示答案。

## 样例 #1

### 输入

```
4

3 1 4 2

4 2 1 3
```

### 输出

```
2
```

## 样例 #2

### 输入

```
5

1 2 3 4 5

5 4 3 2 1
```

### 输出

```
3
```

## 样例 #3

### 输入

```
10

4 3 1 10 9 2 8 6 5 7

9 6 5 4 2 3 8 10 1 7
```

### 输出

```
6
```



---

---
title: "[ARC133C] Row Column Sums"
layout: "post"
diff: 普及+/提高
pid: AT_arc133_c
tag: []
---

# [ARC133C] Row Column Sums

## 题目描述

[problemUrl]: https://atcoder.jp/contests/arc133/tasks/arc133_c

$ H $ 行 $ W $ 列からなるマス目があります．

すぬけくんは，各マスに $ 0 $ 以上 $ K-1 $ 以下の整数を書き込もうとしています． ここで，以下の条件を満たす必要があります．

- 各 $ 1\ \leq\ i\ \leq\ H $ について，$ i $ 行目にあるマスに書かれた整数の総和を $ K $ で割った余りは $ A_i $ である．
- 各 $ 1\ \leq\ i\ \leq\ W $ について，$ i $ 列目にあるマスに書かれた整数の総和を $ K $ で割った余りは $ B_i $ である．

条件を満たすようにマスに整数を書き込むことができるかどうか判定し，また可能な場合は，書き込む整数の総和としてありうる最大値を求めてください．

## 输入格式

入力は以下の形式で標準入力から与えられる．

> $ H $ $ W $ $ K $ $ A_1 $ $ A_2 $ $ \cdots $ $ A_H $ $ B_1 $ $ B_2 $ $ \cdots $ $ B_W $

## 输出格式

条件を満たすようにマスに整数を書き込むことが不可能な場合，`-1` と出力せよ． 可能な場合，書き込む整数の総和としてありうる最大値を出力せよ．

## 说明/提示

### 制約

- $ 1\ \leq\ H,W\ \leq\ 200000 $
- $ 2\ \leq\ K\ \leq\ 200000 $
- $ 0\ \leq\ A_i\ \leq\ K-1 $
- $ 0\ \leq\ B_i\ \leq\ K-1 $
- 入力される値はすべて整数である

### Sample Explanation 1

以下のように書き込めば良いです． ``` ----------------- | 2 | 0 | 2 | 2 | ----------------- | 2 | 2 | 0 | 1 | ----------------- ``` この書き方は条件を満たしています． 例えば $ 1 $ 行目に書かれた整数の総和は $ 6 $ であり，これを $ K(=3) $ で割ったあまりは $ A_1(=0) $ になっています． この書き方では整数の総和は $ 11 $ になっており，これはありうる最大値です．

## 样例 #1

### 输入

```
2 4 3

0 2

1 2 2 0
```

### 输出

```
11
```

## 样例 #2

### 输入

```
3 3 4

0 1 2

1 2 3
```

### 输出

```
-1
```



---

---
title: "[ARC134C] The Majority"
layout: "post"
diff: 普及+/提高
pid: AT_arc134_c
tag: []
---

# [ARC134C] The Majority

## 题目描述

[problemUrl]: https://atcoder.jp/contests/arc134/tasks/arc134_c

$ 1 $ から $ K $ の番号がついた $ K $ 個の箱があります。はじめ、箱は全て空です。

すぬけ君は $ 1 $ 以上 $ N $ 以下の整数が書かれたボールをいくつか持っています。 すぬけ君が持っているボールのうち、$ i $ が書かれたものは $ a_i $ 個あります。 同じ整数が書かれたボール同士は区別できません。

すぬけ君は持っている全てのボールを箱にしまうことにしました。 すぬけ君はどの箱についても $ 1 $ と書かれたボールが過半数を占めるようにしたいです。 過半数を占めるとは、$ 1 $ と書かれたボールの個数がそれ以外のボールの個数より多いことを意味します。

そのようなしまい方の個数を $ 998244353 $ で割ったあまりを求めてください。

$ 2 $ つのしまい方が異なるとは、$ 1\ \leq\ i\ \leq\ K,\ 1\ \leq\ j\ \leq\ N $ を満たす整数の組 $ (i,j) $ であって、箱 $ i $ に入っている $ j $ が書かれたボールの個数が異なるようなものが存在することをいいます。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ K $ $ a_1 $ $ \cdots $ $ a_N $

## 输出格式

どの箱も $ 1 $ と書かれたボールが過半数を占めるようなしまい方の個数を $ 998244353 $ で割ったあまりを出力せよ。

## 说明/提示

### 制約

- 与えられる入力は全て整数
- $ 1\ \leq\ N\ \leq\ 10^5 $
- $ 1\ \leq\ K\ \leq\ 200 $
- $ 1\ \leq\ a_i\ <\ 998244353 $

### Sample Explanation 1

\- $ 1 $ と書かれたボールが過半数を占めるようなしまい方は $ 2 $ 通りあります。 - 例えば $ 1 $ と書かれたボールを箱 $ 1 $ に $ 2 $ 個、箱 $ 2 $ に $ 1 $ 個入れ、$ 2 $ と書かれたボールを箱 $ 1 $ に $ 1 $ 個入れたとき条件を満たします。

### Sample Explanation 2

\- 条件を満たすようなしまい方が存在しないこともあります。

### Sample Explanation 3

\- $ 998244353 $ で割ったあまりを求めるのを忘れずに。

## 样例 #1

### 输入

```
2 2

3 1
```

### 输出

```
2
```

## 样例 #2

### 输入

```
2 1

1 100
```

### 输出

```
0
```

## 样例 #3

### 输入

```
20 100

1073813 90585 41323 52293 62633 28788 1925 56222 54989 2772 36456 64841 26551 92115 63191 3603 82120 94450 71667 9325
```

### 输出

```
313918676
```



---

---
title: "[ARC135C] XOR to All"
layout: "post"
diff: 普及+/提高
pid: AT_arc135_c
tag: []
---

# [ARC135C] XOR to All

## 题目描述

给定 $n$ 个非负整数 $a_1,a_2,\dots,a_n$，你可以执行以下操作任意（可以为零）次：

- 选择一个数 $x\in \{a_1,a_2,\dots,a_n\}$。

- 对于所有 $a\leq i\leq n$，将 $a_i$ 修改为 $a_i\oplus x$，其中 $\oplus$ 表示按位异或操作。

请你最大化操作后 $\sum_{i=1}^na_i$ 的值。

## 输入格式

第一行一个整数 $n$。

第二行 $n$ 个整数 $a_1,a_2,\dots,a_n$。

## 输出格式

一行一个整数，表示操作后 $\sum_{i=1}^na_i$ 的最大值。 

## 样例 #1

### 样例输入 #1

```
5
1 2 3 4 5
```

### 样例输出 #1

```
19
```

## 样例 #2

### 样例输入 #2

```
5
10 10 10 10 10
```

### 样例输出 #2

```
50
```

## 样例 #3

### 样例输入 #3

```
5
3 1 4 1 5
```

### 样例输出 #3

```
18
```

## 说明/提示

- $1\leq n \leq 3\times 10^5$
- $0\leq a_i<2^{30}$

## 样例 #1

### 输入

```
5

1 2 3 4 5
```

### 输出

```
19
```

## 样例 #2

### 输入

```
5

10 10 10 10 10
```

### 输出

```
50
```

## 样例 #3

### 输入

```
5

3 1 4 1 5
```

### 输出

```
18
```



---

---
title: "[ARC136B] Triple Shift"
layout: "post"
diff: 普及+/提高
pid: AT_arc136_b
tag: []
---

# [ARC136B] Triple Shift

## 题目描述

[problemUrl]: https://atcoder.jp/contests/arc136/tasks/arc136_b

長さ $ N $ の整数列 $ A=(A_1,A_2,\cdots,A_N) $ および $ B=(B_1,B_2,\cdots,B_N) $ が与えられます．

あなたは，以下の操作を好きな回数繰り返すことができます．

- 整数 $ i $ ($ 1\ \leq\ i\ \leq\ N-2 $) を選び，現在の $ A_i,A_{i+1},A_{i+2} $ の値をそれぞれ $ x,y,z $ とする． そして，$ A_i,A_{i+1},A_{i+2} $ の値をそれぞれ $ z,x,y $ で置き換える．

$ A $ を $ B $ に一致させることができるかどうか判定してください．

## 输入格式

入力は以下の形式で標準入力から与えられる．

> $ N $ $ A_1 $ $ A_2 $ $ \cdots $ $ A_N $ $ B_1 $ $ B_2 $ $ \cdots $ $ B_N $

## 输出格式

$ A $ を $ B $ に一致させることが可能な場合は `Yes` を，そうでない場合は `No` を出力せよ．

## 说明/提示

### 制約

- $ 3\ \leq\ N\ \leq\ 5000 $
- $ 1\ \leq\ A_i,B_i\ \leq\ 5000 $
- 入力される値はすべて整数

### Sample Explanation 1

以下のように操作すればよいです． - 最初，$ A=(3,1,4,5) $ である． - $ i=1 $ で操作を行う．$ A=(4,3,1,5) $ となる． - $ i=2 $ で操作を行う．$ A=(4,5,3,1) $ となる． - $ i=2 $ で操作を行う．$ A=(4,1,5,3) $ となる．

## 样例 #1

### 输入

```
4

3 1 4 5

4 1 5 3
```

### 输出

```
Yes
```

## 样例 #2

### 输入

```
3

1 2 2

2 1 2
```

### 输出

```
Yes
```

## 样例 #3

### 输入

```
3

1 2 3

2 3 4
```

### 输出

```
No
```



---

---
title: "[ARC137A] Coprime Pair"
layout: "post"
diff: 普及+/提高
pid: AT_arc137_a
tag: []
---

# [ARC137A] Coprime Pair

## 题目描述

[problemUrl]: https://atcoder.jp/contests/arc137/tasks/arc137_a

整数 $ L,R $ ($ L\ <\ R $) が与えられます．

すぬけ君は，以下の条件を両方満たす整数の組 $ (x,y) $ を探しています．

- $ L\ \leq\ x\ <\ y\ \leq\ R $
- $ \gcd(x,y)=1 $

条件を満たす組において，$ (y-x) $ がとりうる最大の値を求めてください． なお，問題の制約より，条件を満たす組が少なくとも一つ存在することが証明できます．

## 输入格式

入力は以下の形式で標準入力から与えられる．

> $ L $ $ R $

## 输出格式

答えを出力せよ．

## 说明/提示

### 制約

- $ 1\ \leq\ L\ <\ R\ \leq\ 10^{18} $
- 入力される値はすべて整数

### Sample Explanation 1

$ (x,y)=(2,4) $ とすると，$ \gcd(x,y)=2 $ となってしまい，条件を満たしません． $ (x,y)=(2,3) $ とすれば条件を満たし，このとき $ (y-x) $ の値は $ 1 $ です． $ (y-x) $ の値がこれより大きくなることはないため，答えは $ 1 $ です．

## 样例 #1

### 输入

```
2 4
```

### 输出

```
1
```

## 样例 #2

### 输入

```
14 21
```

### 输出

```
5
```

## 样例 #3

### 输入

```
1 100
```

### 输出

```
99
```



---

---
title: "[ARC138C] Rotate and Play Game"
layout: "post"
diff: 普及+/提高
pid: AT_arc138_c
tag: []
---

# [ARC138C] Rotate and Play Game

## 题目描述

[problemUrl]: https://atcoder.jp/contests/arc138/tasks/arc138_c

$ N $ 枚のカードがあり，$ 1 $ から $ N $ までの番号がついています． カード $ i $ には整数 $ A_i $ が書かれています． なお，ここで $ N $ は偶数です．

これから，すぬけ君と最小太郎君がゲームをします． ゲームは $ N $ ターンからなり，すぬけ君から始めて二人が交互にターンをプレイします． 各ターンでは，以下の操作を行います．

- すぬけ君のターン：まだ誰にも取られていないカードのうち，好きなものを一つ選び，取る．
- 最小太郎君のターン：まだ誰にも取られていないカードのうち，**番号**が最小のものを一つ選び，取る．

すぬけ君のスコアは，すぬけ君が取ったカードに書かれた整数の総和になります． すぬけ君はスコアを最大化するように最適に行動します．

ところで，すぬけ君の大ファンであるあなたは，とある不正を行うことでスコアを最大化しようと考えています． 具体的には，ゲームの開始前に，あなたは以下の行動を一回行います．

- 整数 $ k $ ($ 0\ \leq\ k\ \leq\ N-1 $) を選び，カードに書かれている整数を $ k $ 個左に cyclic-shift する． つまり，カード $ 1,2,\cdots,N $ に書かれている数を，$ A_{k+1},A_{k+2},\cdots,A_N,A_1,\cdots,A_k $ に置き換える．

スコアを最大化するためにあなたが選ぶべき $ k $ の値，およびその $ k $ を選んだ場合のスコアを求めてください．

## 输入格式

入力は以下の形式で標準入力から与えられる．

> $ N $ $ A_1 $ $ A_2 $ $ \cdots $ $ A_N $

## 输出格式

以下の形式で答えを出力せよ．

> $ k $ $ s $

ここで $ k $ はあなたが選ぶ整数 ($ 0\ \leq\ k\ \leq\ N-1 $) であり，$ s $ はその $ k $ を選んだ場合のスコアである． なお，$ s $ を最大化するような $ k $ が複数存在する場合，どれを出力しても正解とみなされる．

## 说明/提示

### 制約

- $ 2\ \leq\ N\ \leq\ 2\ \times\ 10^5 $
- $ N $ は偶数
- $ 1\ \leq\ A_i\ \leq\ 10^9 $
- 入力される値はすべて整数

### Sample Explanation 1

$ k=1 $ を選ぶと，カード $ 1,2,3,4 $ に書かれた整数は $ 4,1,2,3 $ になります． その後，ゲームは以下のように進行します． - すぬけ君がカード $ 1 $ を取る． - 最小太郎君がカード $ 2 $ を取る． - すぬけ君がカード $ 4 $ を取る． - 最小太郎君がカード $ 3 $ を取る． このときのすぬけ君のスコアは $ 7 $ になります． なお，この例では $ k=2,3 $ でも正解になります．

## 样例 #1

### 输入

```
4

3 4 1 2
```

### 输出

```
1 7
```

## 样例 #2

### 输入

```
2

1 1
```

### 输出

```
0 1
```

## 样例 #3

### 输入

```
10

716893678 779607519 555600775 393111963 950925400 636571379 912411962 44228139 15366410 2063694
```

### 输出

```
7 3996409938
```



---

---
title: "[ARC139B] Make N"
layout: "post"
diff: 普及+/提高
pid: AT_arc139_b
tag: []
---

# [ARC139B] Make N

## 题目描述

[problemUrl]: https://atcoder.jp/contests/arc139/tasks/arc139_b

整数 $ P=0 $ があります。以下の $ 3 $ 種類の操作を任意の回数選んで行うことで $ P=N $ とするとき、コストの総和の最小値を求めてください。

- $ P $ を $ 1 $ 増やす。この操作はコストが $ X $ かかる。
- $ P $ を $ A $ 増やす。この操作はコストが $ Y $ かかる。
- $ P $ を $ B $ 増やす。この操作はコストが $ Z $ かかる。

$ T $ 個のテストケースが与えられるので、それぞれについて答えを求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられます。

> $ T $ $ \mathrm{case}_1 $ $ \mathrm{case}_2 $ $ \vdots $ $ \mathrm{case}_T $

各テストケースは以下の形式で与えられます。

> $ N\ A\ B\ X\ Y\ Z $

## 输出格式

$ T $ 行出力してください。$ i $ 行目には、$ \mathrm{case}_i $ に対する答えを出力してください。

## 说明/提示

### 制約

- $ 1\ \le\ T\ \le\ 100 $
- $ 1\ \le\ N,A,B,X,Y,Z\ \le\ 10^9 $
- 入力は全て整数である。

### Sample Explanation 1

$ 1 $ 個目のテストケースでは、例えば以下のようにするとコスト $ 11 $ で $ P=10 $ とでき、これが最適です。 - $ P $ を $ 3 $ 増やす。$ P=3 $ となる。コストが $ 3 $ かかる。 - $ P $ を $ 1 $ 増やす。$ P=4 $ となる。コストが $ 2 $ かかる。 - $ P $ を $ 3 $ 増やす。$ P=7 $ となる。コストが $ 3 $ かかる。 - $ P $ を $ 3 $ 増やす。$ P=10 $ となる。コストが $ 3 $ かかる。

## 样例 #1

### 输入

```
5

10 3 5 2 3 6

10 3 5 1 1000000000 1000000000

139 2 139 1 1 1

139 1 1 1 1 1

139 7 10 3845 26982 30923
```

### 输出

```
11

10

1

139

436604
```



---

---
title: "[ARC140C] ABS Permutation (LIS ver.)"
layout: "post"
diff: 普及+/提高
pid: AT_arc140_c
tag: []
---

# [ARC140C] ABS Permutation (LIS ver.)

## 题目描述

[problemUrl]: https://atcoder.jp/contests/arc140/tasks/arc140_c

$ (1,\dots,N) $ の順列 $ P=(P_1,P_2,\ldots,P_N) $ の**嬉しさ**を以下で定義します。

- 長さ $ N-1 $ の数列 $ A=(A_1,A_2,\ldots,A_{N-1}) $ を、$ A_i\ =\ |P_i-P_{i+1}|(1\leq\ i\ \leq\ N-1) $ で定める。 $ A $ の最長狭義単調増加部分列の長さを $ P $ の嬉しさとする。

$ P_1\ =\ X $ を満たす順列 $ P $ のうち、嬉しさが最大になるものを一つ出力してください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ X $

## 输出格式

$ P_1\ =\ X $ を満たす順列 $ P $ のうち、嬉しさが最大になるものを $ 1 $ つ以下の形式で出力せよ。

> $ P_1 $ $ P_2 $ $ \ldots $ $ P_N $

条件を満たす解が複数存在する場合、どれを出力しても正解とみなされる。

## 说明/提示

### 制約

- $ 2\ \leq\ N\ \leq\ 2\times\ 10^5 $
- $ 1\ \leq\ X\ \leq\ N $
- 入力は全て整数

### Sample Explanation 1

$ A=(1,2) $ となるので、$ P $ の嬉しさは $ 2 $ です。これが達成可能な嬉しさの最大であるため、出力は条件を満たします。

### Sample Explanation 2

$ A=(1,1) $ となるので、$ P $ の嬉しさは $ 1 $ です。これが達成可能な嬉しさの最大であるため、出力は条件を満たします。

## 样例 #1

### 输入

```
3 2
```

### 输出

```
2 1 3
```

## 样例 #2

### 输入

```
3 1
```

### 输出

```
1 2 3
```



---

---
title: "[ARC142C] Tree Queries"
layout: "post"
diff: 普及+/提高
pid: AT_arc142_c
tag: []
---

# [ARC142C] Tree Queries

## 题目描述

[problemUrl]: https://atcoder.jp/contests/arc142/tasks/arc142_c

$ N $ 頂点の木があり、各頂点には $ 1,\ldots,N $ と番号が付けられています。  
 また、各整数 $ u,v\,\ (1\ \leq\ u,v\ \leq\ N) $ に対し、頂点 $ u,v $ の距離 $ d_{u,v} $ を次のように定めます。

- 頂点 $ u $ と頂点 $ v $ を結ぶ最短パスに含まれる辺の本数

あなたは次のような質問を $ 0 $ 回以上 $ 2N $ 回以下行うことが出来ます。

- $ 1\leq\ u,v\ \leq\ N $ かつ $ u+v\ >\ 3 $ を満たす整数 $ u,v $ を指定し、頂点 $ u,v $ の距離 $ d_{u,v} $ を聞く。

頂点 $ 1,2 $ の距離 $ d_{1,2} $ を求めてください。

### Input &amp; Output Format

**この問題はインタラクティブな問題**（あなたの作成したプログラムとジャッジプログラムが入出力を介して対話を行う形式の問題）である。

まず、あなたのプログラムに標準入力から正の整数 $ N $ が与えられる。

> $ N $

その後、あなたは質問を行うことが出来る。  
 質問は標準出力に以下の形式で出力せよ(末尾に改行を入れること)。

> ? $ u $ $ v $

質問が正当な場合、その質問への答え $ d_{u,v} $ が標準入力から与えられる。

> $ d_{u,v} $

質問の形式が間違っている・質問を規定の回数より多く行った等の理由から質問が不正と判定された場合、質問への答えの代わりに `-1` が与えられる。

 ```
-1
```

この時、提出はすでに不正解と判定されている。ジャッジプログラムはこの時点で終了するため、あなたのプログラムも終了するのが望ましい。

答え $ d_{1,2} $ が分かったら、標準出力に以下の形式で出力せよ(末尾に改行を入れること)。

> ! $ d_{1,2} $

## 说明/提示

### 制約

- $ 3\ \leq\ N\ \leq\ 100 $
- $ N $ は整数
- 木はプログラムとジャッジの対話の開始前に決定される

### 注意点

- **出力を行うたびに標準出力をflushせよ。そうしなかった場合、ジャッジ結果が TLE となる可能性がある。**
- 答えを出力したら(または `-1` を受け取ったら)直ちにプログラムを正常終了せよ。そうしなかった場合、ジャッジ結果は不定である。
- 不正なフォーマットの出力を行った場合のジャッジ結果は不定である。
- 特に、余計な改行も不正なフォーマットの出力とみなされるので注意せよ。

### 入出力例

木がこの画像のような時の対話の一例を示します。

![](https://cdn.luogu.com.cn/upload/vjudge_pic/AT_arc142_c/2372d0c2156cba417b179dc14ab627f8984c08d8.png)

 入力 出力 説明 `3`  まず整数 $ N $ が与えられます。  `?` `1` `3` $ 1 $ 回目の質問として頂点 $ 1,3 $ の距離を聞きます。 `1`  頂点 $ 1,3 $ の距離が与えられます。  `?` `2` `2` $ 2 $ 回目の質問として頂点 $ 2,2 $ の距離を聞きます。 `0`  頂点 $ 2,2 $ の距離が与えられます。  `?` `2` `3` $ 3 $ 回目の質問として頂点 $ 2,3 $ の距離を聞きます。 `1`  頂点 $ 2,3 $ の距離が与えられます。  `?` `3` `1` $ 4 $ 回目の質問として頂点 $ 3,1 $ の距離を聞きます。 `1`  頂点 $ 3,1 $ の距離が与えられます。  `?` `3` `2` $ 5 $ 回目の質問として頂点 $ 3,2 $ の距離を聞きます。 `1`  頂点 $ 3,2 $ の距離が与えられます。  `?` `2` `2` $ 6 $ 回目の質問として頂点 $ 2,2 $ の距離を聞きます。 `0`  頂点 $ 2,2 $ の距離が与えられます。  `!` `2` 頂点 $ 1,2 $ の距離を回答し、終了します。実際に木の頂点 $ 1,2 $ の距離は $ 2 $ であるため AC が得られます。



---

---
title: "[ARC143B] Counting Grids"
layout: "post"
diff: 普及+/提高
pid: AT_arc143_b
tag: []
---

# [ARC143B] Counting Grids

## 题目描述

[problemUrl]: https://atcoder.jp/contests/arc143/tasks/arc143_b

$ N\ \times\ N $ のマス目の各マスに $ 1 $ から $ N^2 $ までの整数を $ 1 $ つずつ書き込む方法であって， どのマスも以下の条件のうち少なくとも一方を満たすようなものの個数を $ 998244353 $ で割ったあまりを求めてください．

- そのマスに書かれている数より大きい数が書かれているマスが同じ列に存在する．
- そのマスに書かれている数より小さい数が書かれているマスが同じ行に存在する．

## 输入格式

入力は以下の形式で標準入力から与えられる．

> $ N $

## 输出格式

答えを出力せよ．

## 说明/提示

### 制約

- $ 1\ \leq\ N\ \leq\ 500 $

### Sample Explanation 1

例えば，以下のような書き込み方は条件を満たします． ``` 13 42 ``` この場合，左上のマスは左下のマスに書かれている数より小さい数が書かれているので， $ 1 $ つ目の条件を満たします．ただし，$ 2 $ つ目の条件は満たしません．

## 样例 #1

### 输入

```
2
```

### 输出

```
8
```

## 样例 #2

### 输入

```
5
```

### 输出

```
704332752
```

## 样例 #3

### 输入

```
100
```

### 输出

```
927703658
```



---

---
title: "[ARC143C] Piles of Pebbles"
layout: "post"
diff: 普及+/提高
pid: AT_arc143_c
tag: []
---

# [ARC143C] Piles of Pebbles

## 题目描述

[problemUrl]: https://atcoder.jp/contests/arc143/tasks/arc143_c

小石の山が $ N $ 個あります．最初，$ i $ 番目の山には $ A_i $ 個の小石があります．

これらを用いて，高橋君と青木君がゲームをします． 高橋君から始めて，交互に次の操作を行い，操作を行えなくなった方が負けとなります．

- 山を $ 1 $ つ以上選び，選んだそれぞれの山から，高橋君の操作の場合は $ X $ 個ずつ，青木君の操作の場合は $ Y $ 個ずつ小石を取り除く． ただし，小石の個数が足りない山を選ぶことはできない．

二人が最適に行動したとき，どちらがゲームに勝つかを求めてください.

## 输入格式

入力は以下の形式で標準入力から与えられる．

> $ N $ $ X $ $ Y $ $ A_1 $ $ A_2 $ $ \cdots $ $ A_N $

## 输出格式

このゲームに勝つのが高橋君の場合 `First` を，青木君の場合 `Second` を出力せよ．

## 说明/提示

### 制約

- $ 1\ \leq\ N\ \leq\ 2\times\ 10^5 $
- $ 1\ \leq\ X,\ Y\ \leq\ 10^9 $
- $ 1\ \leq\ A_i\ \leq\ 10^9 $

### Sample Explanation 1

例えば，以下のようなゲームの進行が考えられます． - 高橋君が両方の山から石を $ 1 $ つ取り除く． - 青木君が $ 1 $ 番目の山から石を $ 1 $ つ取り除く． - 高橋君が $ 1 $ 番目の山から石を $ 1 $ つ取り除く． - 青木君が $ 2 $ 番目の山から石を $ 1 $ つ取り除く． - 高橋君が $ 2 $ 番目の山から石を $ 1 $ つ取り除く． 青木君がどのように操作を行っても高橋君が勝つことができるので，答えは `First` です．

## 样例 #1

### 输入

```
2 1 1

3 3
```

### 输出

```
First
```

## 样例 #2

### 输入

```
2 1 2

3 3
```

### 输出

```
Second
```



---

---
title: "[ARC144C] K Derangement"
layout: "post"
diff: 普及+/提高
pid: AT_arc144_c
tag: []
---

# [ARC144C] K Derangement

## 题目描述

[problemUrl]: https://atcoder.jp/contests/arc144/tasks/arc144_c

正整数 $ N,\ K $ が与えられます． $ 1 $ から $ N $ までの整数からなる順列 $ A\ =\ (A_1,\ A_2,\ \ldots,\ A_N) $ であって次の条件を満たすもののうち， 辞書順最小のものを求めてください．

- 任意の $ i $ ($ 1\leq\ i\leq\ N $) に対して $ \lvert\ A_i\ -\ i\rvert\ \geq\ K $ が成り立つ．

そのような順列が存在しない場合には，`-1` を出力してください．

 数列の辞書順とは？ 相異なる数列 $ S $ と数列 $ T $ の大小を判定するアルゴリズムを以下に説明します．

以下では $ S $ の $ i $ 番目の要素を $ S_i $ のように表します．また， $ S $ が $ T $ より辞書順で小さい場合は $ S\ \lt\ T $ ，大きい場合は $ S\ \gt\ T $ と表します．

1. $ S $ と $ T $ のうち長さが短い方の文字列の長さを $ L $ とします．$ i=1,2,\dots,L $ に対して $ S_i $ と $ T_i $ が一致するか調べます．
2. $ S_i\ \neq\ T_i $ である $ i $ が存在する場合，そのような $ i $ のうち最小のものを $ j $ とします．そして，$ S_j $ と $ T_j $ を比較して， $ S_j $ が $ T_j $ より（数として）小さい場合は $ S\ \lt\ T $ ，大きい場合は $ S\ \gt\ T $ と決定して，アルゴリズムを終了します．
3. $ S_i\ \neq\ T_i $ である $ i $ が存在しない場合， $ S $ と $ T $ の長さを比較して，$ S $ が $ T $ より短い場合は $ S\ \lt\ T $ ，長い場合は $ S\ \gt\ T $ と決定して，アルゴリズムを終了します．

## 输入格式

入力は以下の形式で標準入力から与えられます．

> $ N $ $ K $

## 输出格式

条件を満たす順列 $ A $ のうち，辞書順最小のものを次の形式で出力してください．

> $ A_1 $ $ A_2 $ $ \ldots $ $ A_N $

そのような順列が存在しない場合には，`-1` を出力してください．

## 说明/提示

### 制約

- $ 2\leq\ N\leq\ 3\times\ 10^5 $
- $ 1\leq\ K\leq\ N\ -\ 1 $

### Sample Explanation 1

条件を満たす順列は，$ (2,\ 3,\ 1) $ と $ (3,\ 1,\ 2) $ の $ 2 $ つです．例えば $ (2,\ 3,\ 1) $ は - $ \lvert\ A_1\ -\ 1\rvert\ =\ 1\ \geq\ K $ - $ \lvert\ A_2\ -\ 2\rvert\ =\ 1\ \geq\ K $ - $ \lvert\ A_3\ -\ 3\rvert\ =\ 2\ \geq\ K $ であるため条件を満たしています．

## 样例 #1

### 输入

```
3 1
```

### 输出

```
2 3 1
```

## 样例 #2

### 输入

```
8 3
```

### 输出

```
4 5 6 7 8 1 2 3
```

## 样例 #3

### 输入

```
8 6
```

### 输出

```
-1
```



---

---
title: "[ARC146B] Plus and AND"
layout: "post"
diff: 普及+/提高
pid: AT_arc146_b
tag: []
---

# [ARC146B] Plus and AND

## 题目描述

[problemUrl]: https://atcoder.jp/contests/arc146/tasks/arc146_b

長さ $ N $ の非負整数列 $ A=(A_1,A_2,\dots,A_N) $ が与えられます。あなたは以下の操作を $ M $ 回以下行うことができます。($ 1 $ 回も行わなくてもよいです。)

- $ 1\ \le\ i\ \le\ N $ を満たす整数 $ i $ を選び、$ A_i $ を $ 1 $ 増やす。

その後、$ A $ の中から $ K $ 要素を選びます。

選んだ $ K $ 要素のビット単位 $ \mathrm{AND} $ の最大値を求めてください。

  ビット単位 $ \mathrm{AND} $ 演算とは  整数 $ A,\ B $ のビット単位 $ \mathrm{AND} $、$ A\ \mathrm{AND}\ B $ は以下のように定義されます。

- $ A\ \mathrm{AND}\ B $ を二進表記した際の $ 2^k $ ($ k\ \geq\ 0 $) の位の数は、$ A,\ B $ を二進表記した際の $ 2^k $ の位の数のうち両方が $ 1 $ であれば $ 1 $、そうでなければ $ 0 $ である。
 
 例えば、$ 3\ \mathrm{AND}\ 5\ =\ 1 $ となります (二進表記すると: $ 011\ \mathrm{AND}\ 101\ =\ 001 $)。  
 一般に $ k $ 個の整数 $ p_1,\ p_2,\ p_3,\ \dots,\ p_k $ のビット単位 $ \mathrm{AND} $ は $ (\dots\ ((p_1\ \mathrm{AND}\ p_2)\ \mathrm{AND}\ p_3)\ \mathrm{AND}\ \dots\ \mathrm{AND}\ p_k) $ と定義され、これは $ p_1,\ p_2,\ p_3,\ \dots\ p_k $ の順番によらないことが証明できます。 ​

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ M $ $ K $ $ A_1 $ $ A_2 $ $ \dots $ $ A_N $

## 输出格式

答えを出力せよ。

## 说明/提示

### 制約

- $ 1\ \le\ K\ \le\ N\ \le\ 2\ \times\ 10^5 $
- $ 0\ \le\ M\ <\ 2^{30} $
- $ 0\ \le\ A_i\ <\ 2^{30} $
- 入力は全て整数である。

### Sample Explanation 1

以下のような手順を踏むことで 選んだ $ 2 $ 要素の $ \mathrm{AND} $ として $ 10 $ を達成できます。 - $ A_3 $ を選ぶ操作を $ 6 $ 回行う。$ A_3\ =\ 10 $ となる。 - $ A_4 $ を選ぶ操作を $ 2 $ 回行う。$ A_4\ =\ 10 $ となる。 - $ A_3,A_4 $ を選ぶ。$ 2 $ 要素の $ \mathrm{AND} $ は $ 10 $ である。 選んだ $ 2 $ 要素の $ \mathrm{AND} $ を $ 11 $ 以上にすることはできないので、解は $ 10 $ です。

## 样例 #1

### 输入

```
4 8 2

1 2 4 8
```

### 输出

```
10
```

## 样例 #2

### 输入

```
5 345 3

111 192 421 390 229
```

### 输出

```
461
```



---

---
title: "[ARC148C] Lights Out on Tree"
layout: "post"
diff: 普及+/提高
pid: AT_arc148_c
tag: []
---

# [ARC148C] Lights Out on Tree

## 题目描述

[problemUrl]: https://atcoder.jp/contests/arc148/tasks/arc148_c

頂点に $ 1 $ から $ N $ の番号がついた $ N $ 頂点の根付き木があります。頂点 $ 1 $ が根で、頂点 $ i $ $ (2\ \leq\ i\ \leq\ N) $ の親は頂点 $ P_i $ です。  
 表裏のあるコインが $ N $ 枚あります。コインは全ての頂点の上に $ 1 $ 枚ずつ載っています。  
 また、$ 1 $ から $ N $ までの番号がついた $ N $ 個のボタンがあります。ボタン $ n $ を押すと $ n $ を根とする部分木に含まれる頂点に載っている全てのコインが裏返ります。

以下で説明するクエリを $ Q $ 個処理してください。

$ i $ 番目のクエリではサイズ $ M_i $ の頂点集合 $ S_i\ =\ \lbrace\ v_{i,1},\ v_{i,2},\dots,\ v_{i,M_i}\ \rbrace $ が与えられます。  
 今、$ S_i $ に含まれる頂点の上に載っているコインは表を、それ以外のコインは裏を向いています。ボタンを $ 1 $ つ選んで押すことを繰り返して、$ N $ 枚のコイン全てを裏向きにするには、最小で何回ボタンを押す必要がありますか？答えを出力してください。ただし、どのようにボタンを押しても $ N $ 枚のコイン全てが裏向きにならない場合は $ -1 $ を出力してください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ Q $ $ P_2 $ $ P_3 $ $ \dots $ $ P_N $ $ M_1 $ $ v_{1,1} $ $ v_{1,2} $ $ \dots $ $ v_{1,M_1} $ $ M_2 $ $ v_{2,1} $ $ v_{2,2} $ $ \dots $ $ v_{2,M_2} $ $ \vdots $ $ M_Q $ $ v_{Q,1} $ $ v_{Q,2} $ $ \dots $ $ v_{Q,M_Q} $

## 输出格式

$ Q $ 行出力せよ。$ i $ 行目には $ i $ 番目のクエリの答えを出力せよ。

## 说明/提示

### 制約

- $ 2\ \leq\ N\ \leq\ 2\ \times\ 10^5 $
- $ 1\ \leq\ P_i\ \lt\ i $
- $ 1\ \leq\ Q\ \leq\ 2\ \times\ 10^5 $
- $ 1\ \leq\ M_i $
- $ \displaystyle\ \sum_{i=1}^Q\ M_i\ \leq\ 2\ \times\ 10^5 $
- $ 1\ \leq\ v_{i,j}\ \leq\ N $
- $ v_{i,1},\ v_{i,2},\dots,v_{i,M_i} $ は互いに異なる
- 入力される値はすべて整数

### Sample Explanation 1

$ 1 $ 番目のクエリについて、以下に説明するようにボタンを $ 1 $ 回押すことで条件を満たすことができて、これが最小です。 - ボタン $ 1 $ を押す。頂点 $ 1,2,3,4,5,6 $ に載っているコインが裏返る。 $ 2 $ 番目のクエリについて、以下に説明するようにボタンを $ 2 $ 回押すことで条件を満たすことができて、これが最小です。 - ボタン $ 4 $ を押す。頂点 $ 4 $ に載っているコインが裏返る。 - ボタン $ 2 $ を押す。頂点 $ 2,4,5,6 $ に載っているコインが裏返る。

## 样例 #1

### 输入

```
6 6

1 1 2 2 5

6 1 2 3 4 5 6

3 2 5 6

1 3

3 1 2 3

3 4 5 6

4 2 3 4 5
```

### 输出

```
1

2

1

3

2

3
```



---

---
title: "[ARC149B] Two LIS Sum"
layout: "post"
diff: 普及+/提高
pid: AT_arc149_b
tag: []
---

# [ARC149B] Two LIS Sum

## 题目描述

[problemUrl]: https://atcoder.jp/contests/arc149/tasks/arc149_b

数列 $ P\ =\ (P_1,\ \ldots,\ P_N) $ に対し，その最長増加部分列の長さを $ \mathrm{LIS}(P) $ と書くことにします．

$ 1 $ 以上 $ N $ 以下の整数からなる順列 $ A\ =\ (A_1,\ \ldots,\ A_N) $ および $ B\ =\ (B_1,\ \ldots,\ B_N) $ が与えられます．これらの数列に対して，以下の操作を何度でも行うことができます（$ 0 $ 回でもよいです）．

- $ 1\leq\ i\leq\ N-1 $ となる整数 $ i $ をひとつ選ぶ．$ A_i $ と $ A_{i+1} $ をスワップし，$ B_i $ と $ B_{i+1} $ をスワップする．

操作結果の $ \mathrm{LIS}(A)\ +\ \mathrm{LIS}(B) $ としてありうる最大値を答えてください．

 最長増加部分列とは 数列の部分列とは，数列から $ 0 $ 個以上の要素を取り除いた後，残りの要素を元の順序で連結して得られる数列のことをいいます． 例えば，$ (10,30) $ は $ (10,20,30) $ の部分列ですが，$ (20,10) $ は $ (10,20,30) $ の部分列ではありません．

 数列の最長増加部分列とは，数列の狭義単調増加な部分列のうち，長さが最大のもののことをいいます．

## 输入格式

入力は以下の形式で標準入力から与えられます．

> $ N $ $ A_1 $ $ \ldots $ $ A_N $ $ B_1 $ $ \ldots $ $ B_N $

## 输出格式

操作結果の $ \mathrm{LIS}(A)\ +\ \mathrm{LIS}(B) $ としてありうる最大値を出力してください．

## 说明/提示

### 制約

- $ 2\leq\ N\leq\ 3\times\ 10^5 $
- $ 1\leq\ A_i\leq\ N $
- $ 1\leq\ B_i\leq\ N $
- $ i\neq\ j $ ならば $ A_i\neq\ A_j $ かつ $ B_i\neq\ B_j $

### Sample Explanation 1

例えば次のように操作を行うことで，$ \mathrm{LIS}(A)\ +\ \mathrm{LIS}(B)\ =\ 8 $ を達成できます． - $ i\ =\ 2 $ として操作を行う．$ A\ =\ (5,1,2,4,3) $, $ B\ =\ (3,2,1,5,4) $ となる． - $ i\ =\ 1 $ として操作を行う．$ A\ =\ (1,5,2,4,3) $, $ B\ =\ (2,3,1,5,4) $ となる． - $ i\ =\ 4 $ として操作を行う．$ A\ =\ (1,5,2,3,4) $, $ B\ =\ (2,3,1,4,5) $ となる． このとき $ A $ は最長増加部分列 $ (1,2,3,4) $ を持ち，$ \mathrm{LIS}(A)=4 $ が成り立ちます．$ B $ は最長増加部分列 $ (2,3,4,5) $ を持ち，$ \mathrm{LIS}(B)=4 $ が成り立ちます．

### Sample Explanation 2

操作を $ 1 $ 度も行わないことにより，$ \mathrm{LIS}(A)\ +\ \mathrm{LIS}(B)\ =\ 10 $ を達成できます．

## 样例 #1

### 输入

```
5

5 2 1 4 3

3 1 2 5 4
```

### 输出

```
8
```

## 样例 #2

### 输入

```
5

1 2 3 4 5

1 2 3 4 5
```

### 输出

```
10
```



---

---
title: "[ARC149C] Avoid Prime Sum"
layout: "post"
diff: 普及+/提高
pid: AT_arc149_c
tag: []
---

# [ARC149C] Avoid Prime Sum

## 题目描述

[problemUrl]: https://atcoder.jp/contests/arc149/tasks/arc149_c

正整数 $ N $ が与えられます．

$ N $ 行 $ N $ 列からなるマス目の各マスに $ N^2 $ 以下の正整数を $ 1 $ つずつ書き込んで，以下の条件がすべて成り立つようにしてください．

- 上下左右の $ 4 $ 方向いずれかに隣接する $ 2 $ マスに書き込まれた正整数の和は，どれも素数ではない．
- $ N^2 $ 以下の正整数はすべてどれかのマスに $ 1 $ 度ずつ書き込まれている．

なお本問題の制約のもと，このような書き込み方が必ず存在することが証明できます．

## 输入格式

入力は以下の形式で標準入力から与えられます．

> $ N $

## 输出格式

$ i $ 行 $ j $ 列に書き込む正整数を $ A_{ij} $ として，条件を満たす書き込み方を，以下の形式で出力してください．

> $ A_{11} $ $ \ldots $ $ A_{1N} $ $ \vdots $ $ A_{N1} $ $ \ldots $ $ A_{NN} $

条件を満たす書き込み方が複数存在する場合は，どれを出力しても正解となります．

## 说明/提示

### 制約

- $ 3\leq\ N\leq\ 1000 $

### Sample Explanation 1

このマス目には $ 1 $ 以上 $ 16 $ 以下の正整数がすべて $ 1 $ 度ずつ書き込まれています．また隣接する $ 2 $ マスに書き込まれた正整数の和には $ 15+11=26 $, $ 11+16=27 $, $ 15+13=28 $ などがありますが，これらはすべて素数ではありません．

## 样例 #1

### 输入

```
4
```

### 输出

```
15 11 16 12

13 3 6 9

14 7 8 1

4 2 10 5
```



---

---
title: "[ARC150B] Make Divisible"
layout: "post"
diff: 普及+/提高
pid: AT_arc150_b
tag: []
---

# [ARC150B] Make Divisible

## 题目描述

[problemUrl]: https://atcoder.jp/contests/arc150/tasks/arc150_b

正整数 $ A,\ B $ が与えられます。

非負整数 $ X,\ Y $ であって、 $ B+Y $ が $ A+X $ の倍数となるようなものに対する $ X+Y $ の最小値を求めてください。

$ T $ 個のテストケースが与えられるので、それぞれについて求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられます。

> $ T $ $ \mathrm{case}_{1} $ $ \mathrm{case}_{2} $ $ \vdots $ $ \mathrm{case}_{T} $

各ケースは以下の形式で与えられます。

> $ A $ $ B $

## 输出格式

$ T $ 行出力してください。 $ i $ 行目には $ i $ 番目のテストケースに対する答えを出力してください。

## 说明/提示

### 制約

- $ 1\ \leq\ T\ \leq\ 100 $
- $ 1\ \leq\ A,\ B\ \leq\ 10^9 $
- 入力される値はすべて整数

### Sample Explanation 1

$ 1 $ 個目のテストケースについて、$ X=1,\ Y=1 $ とすると $ B+Y=24 $ は $ A+X=12 $ の倍数になります。このとき $ X+Y=2 $ であり、$ X+Y $ はこれより小さくすることはできないので答えは $ 2 $ です。 $ 2 $ 個目のテストケースについて、$ X=0,\ Y=0 $ とすると $ B+Y=16 $ は $ A+X=8 $ の倍数になります。

## 样例 #1

### 输入

```
5

11 23

8 16

4394 993298361

95392025 569922442

8399283 10293
```

### 输出

```
2

0

65

2429708

8388990
```



---

---
title: "[ARC150C] Path and Subsequence"
layout: "post"
diff: 普及+/提高
pid: AT_arc150_c
tag: []
---

# [ARC150C] Path and Subsequence

## 题目描述

[problemUrl]: https://atcoder.jp/contests/arc150/tasks/arc150_c

$ N $ 頂点 $ M $ 辺の連結無向グラフ $ G $ があります。頂点には $ 1 $ から $ N $ の番号がついています。$ i $ 番目の辺は頂点 $ U_i,\ V_i $ を結びます。

また、長さ $ N $ の整数列 $ A=(A_1,\ A_2,\ \dots,\ A_N) $ 、および長さ $ K $ の整数列 $ B=(B_1,\ B_2,\ \dots,\ B_K) $ が与えられます。

$ G,\ A,\ B $ が以下の条件を満たすか判定してください。

- $ G $ における頂点 $ 1 $ から $ N $ への任意の単純パス $ v=(v_1,\ v_2,\ \dots,\ v_k)\ (v_1=1,\ v_k=N) $ に対し、$ B $ は $ (A_{v_1},\ A_{v_2},\ \dots,\ A_{v_k}) $ の（連続とは限らない）部分列になる。

## 输入格式

入力は以下の形式で標準入力から与えられます。

> $ N $ $ M $ $ K $ $ U_1 $ $ V_1 $ $ U_2 $ $ V_2 $ $ \vdots $ $ U_M $ $ V_M $ $ A_1 $ $ A_2 $ $ \dots $ $ A_N $ $ B_1 $ $ B_2 $ $ \dots $ $ B_K $

## 输出格式

条件を満たす場合 `Yes` と、満たさない場合 `No` と出力してください。

## 说明/提示

### 制約

- $ 2\ \leq\ N\ \leq\ 10^5 $
- $ 1\ \leq\ K\ \leq\ N $
- $ N-1\ \leq\ M\ \leq\ 2\ \times\ 10^5 $
- $ 1\ \leq\ U_i\ <\ V_i\ \leq\ N $
- $ i\ \neq\ j $ ならば $ (U_i,\ V_i)\ \neq\ (U_j,\ V_j) $
- $ 1\ \leq\ A_i,\ B_i\ \leq\ N $
- 入力される値はすべて整数
- 与えられるグラフ $ G $ は連結

### Sample Explanation 1

頂点 $ 1 $ から頂点 $ 6 $ への単純パスは $ (1,\ 2,\ 4,\ 6),\ (1,\ 3,\ 5,\ 6) $ の $ 2 $ 通りであり、これらに対する $ (A_{v_1},\ A_{v_2},\ \dots,\ A_{v_k}) $ はそれぞれ $ (1,\ 2,\ 5,\ 6),\ (1,\ 4,\ 2,\ 6) $ です。 これらはいずれも $ B=(1,\ 2,\ 6) $ を部分列に持つので答えは `Yes` です。

### Sample Explanation 2

頂点 $ 1 $ から頂点 $ 5 $ への単純パスである $ (1,\ 2,\ 5) $ に対する $ (A_{v_1},\ A_{v_2},\ \dots,\ A_{v_k}) $ は $ (1,\ 2,\ 2) $ であり、これは $ B=(1,\ 3,\ 2) $ を部分列に持ちません。

## 样例 #1

### 输入

```
6 6 3

1 2

1 3

2 4

3 5

4 6

5 6

1 2 4 5 2 6

1 2 6
```

### 输出

```
Yes
```

## 样例 #2

### 输入

```
5 5 3

1 2

2 3

3 4

4 5

2 5

1 2 3 5 2

1 3 2
```

### 输出

```
No
```

## 样例 #3

### 输入

```
10 20 3

5 6

5 10

5 7

3 5

3 7

2 6

3 8

4 5

5 8

7 10

1 6

1 9

4 6

1 2

1 4

6 7

4 8

2 5

3 10

6 9

2 5 8 5 1 5 1 1 5 10

2 5 1
```

### 输出

```
Yes
```



---

---
title: "[ARC151B] A < AP"
layout: "post"
diff: 普及+/提高
pid: AT_arc151_b
tag: []
---

# [ARC151B] A < AP

## 题目描述

[problemUrl]: https://atcoder.jp/contests/arc151/tasks/arc151_b

$ (1,\ 2,\ \ldots,\ N) $ の順列 $ P\ =\ (P_1,\ P_2,\ \ldots,\ P_N) $ が与えられます。

下記の $ 2 $ つの条件をともに満たす長さ $ N $ の整数列 $ A\ =\ (A_1,\ A_2,\ \ldots,\ A_N) $ の個数を $ 998244353 $ で割ったあまりを出力してください。

- すべての $ i\ =\ 1,\ 2,\ \ldots,\ N $ について、$ 1\ \leq\ A_i\ \leq\ M $。
- 整数列 $ A $ は整数列 $ (A_{P_1},\ A_{P_2},\ \ldots,\ A_{P_N}) $ より辞書順で小さい。
 
辞書順で小さいとは？整数列 $ X\ =\ (X_1,\ X_2,\ \ldots,\ X_N) $ が 整数列 $ Y\ =\ (Y_1,\ Y_2,\ \ldots,\ Y_N) $ より**辞書順で小さい**とは、下記の $ 2 $ つの条件をともに満たす整数 $ 1\ \leq\ i\ \leq\ N $ が存在することを言います。

- $ 1\ \leq\ j\ \leq\ i-1 $ を満たすすべての整数 $ j $ について、$ X_j\ =\ Y_j $
- $ X_i\ \lt\ Y_i $

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ M $ $ P_1 $ $ P_2 $ $ \ldots $ $ P_N $

## 输出格式

問題文中の $ 2 $ つの条件をともに満たす整数列 $ A $ の個数を $ 998244353 $ で割ったあまりを出力せよ。

## 说明/提示

### 制約

- $ 1\ \leq\ N\ \leq\ 2\ \times\ 10^5 $
- $ 1\ \leq\ M\ \leq\ 10^9 $
- $ 1\ \leq\ P_i\ \leq\ N $
- $ i\ \neq\ j\ \implies\ P_i\ \neq\ P_j $
- 入力はすべて整数

### Sample Explanation 1

問題文中の $ 2 $ つの条件をともに満たす整数列 $ A $ は、 $ (1,\ 1,\ 1,\ 2),\ (1,\ 1,\ 2,\ 2),\ (1,\ 2,\ 1,\ 2),\ (1,\ 2,\ 2,\ 2),\ (2,\ 1,\ 1,\ 2),\ (2,\ 1,\ 2,\ 2) $ の $ 6 $ 個です。 例えば、$ A\ =\ (1,\ 1,\ 1,\ 2) $ のとき、$ (A_{P_1},\ A_{P_2},\ A_{P_3},\ A_{P_4})\ =\ (2,\ 1,\ 1,\ 1) $ であり、これは $ A $ より辞書順で大きいです。

## 样例 #1

### 输入

```
4 2

4 1 3 2
```

### 输出

```
6
```

## 样例 #2

### 输入

```
1 1

1
```

### 输出

```
0
```

## 样例 #3

### 输入

```
20 100000

11 15 3 20 17 6 1 9 5 19 10 16 7 8 12 2 18 14 4 13
```

### 输出

```
55365742
```



---

---
title: "[ARC152B] Pass on Path"
layout: "post"
diff: 普及+/提高
pid: AT_arc152_b
tag: []
---

# [ARC152B] Pass on Path

## 题目描述

[problemUrl]: https://atcoder.jp/contests/arc152/tasks/arc152_b

長さ $ L $ の細長い一直線の道が東西に伸びており、この道を $ 2 $ 人の旅人が訪れます。 この道には $ N $ 個の休憩所があり、$ i $ 番目の休憩所は、道の西端から $ a_i $ の地点にあります （ただし、どの休憩所も道の端には存在しません）。 この道はとても細いため、休憩所以外の地点で $ 2 $ 人がすれ違ったり、横に並んで歩いたりすることはできません。

$ 2 $ 人の旅人は、この道で次のような旅をします。

- 時刻 $ 0 $ に、それぞれ好きな休憩所を選んで出発点とする（ $ 2 $ 人が同じ休憩所を選んでもよい）。 その後、それぞれ道の両端を訪れたあと、自身の出発点に戻る。
 
$ 2 $ 人は、毎秒 $ 1 $ 以下の速さで道を歩くか、休憩所で休憩することができます。 休憩所以外の地点ですれ違わない限り、旅の途中いつでも向きを変えることは可能です。 両者が道の両端を訪れて出発点に戻ってくるまで、最短で何秒かかるでしょうか。 ただし、この問題の制約下では答えが整数になることが証明できます。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ L $ $ a_1 $ $ a_2 $ $ \ldots $ $ a_N $

## 输出格式

答えを整数で出力せよ。

## 说明/提示

### 制約

- $ 1\ \leq\ N\ \leq\ 2\ \times\ 10^5 $
- $ 1\ \leq\ L\ \leq\ 10^9 $
- $ 0\ <\ a_1\ <\ a_2\ <\ \ldots\ <\ a_N\ <\ L $
- 入力される値はすべて整数である
 
### Sample Explanation 1

$ 2 $ 人の旅人を A、B とします。また、以下では $ i $ 番目の休憩所を単に休憩所 $ i $ と呼びます。 例えば、$ 2 $ 人は以下のような旅をすることができます。 最初に A が休憩所 $ 1 $ から東側に、B が休憩所 $ 2 $ から東側に速さ $ 1 $ で歩き始め、両者とも東端→西端の順に訪れることにします。 すると、B は $ 2 $ 秒後に東端を訪れて休憩所 $ 2 $ に戻って来ることができますが、A はまだ休憩所 $ 1 $ と $ 2 $ の間です。 ここで B が $ 1 $ 秒休憩すると、A も休憩所 $ 2 $ にたどり着き、すれ違いが可能になります。 その後、再び両者が速さ $ 1 $ で歩き続け、A が休憩所 $ 1 $ で $ 2 $ 秒だけ休憩した場合、 B は出発から $ 13 $ 秒後、A は $ 14 $ 秒後に元の休憩所に戻り、旅を終えることができます。 実はこれは最善の方法の $ 1 $ つであり、答えは $ 14 $ となります。

### Sample Explanation 2

この場合は、適切な方法を取ると、両者が休憩することなく速さ $ 1 $ で歩き続けることができます。

## 样例 #1

### 输入

```
2 6

2 5
```

### 输出

```
14
```

## 样例 #2

### 输入

```
2 3

1 2
```

### 输出

```
6
```



---

---
title: "[ARC155A] ST and TS  Palindrome"
layout: "post"
diff: 普及+/提高
pid: AT_arc155_a
tag: ['分类讨论']
---

# [ARC155A] ST and TS  Palindrome

## 题目描述

[problemUrl]: https://atcoder.jp/contests/arc155/tasks/arc155_a

英小文字からなる長さ $ N $ の文字列 $ S $ と正整数 $ K $ が与えられます。

以下の条件を満たす長さ $ K $ の文字列 $ S' $ が存在するか判定してください。

- $ S,\ S' $ をこの順に結合して得られる文字列は回文である
- $ S',\ S $ をこの順に結合して得られる文字列は回文である
 
$ T $ 個のテストケースが与えられるのでそれぞれについて判定してください。

## 输入格式

入力は以下の形式で標準入力から与えられます。

> $ T $ $ \mathrm{case}_1 $ $ \vdots $ $ \mathrm{case}_T $

各ケースは以下の形式で与えられます。

> $ N $ $ K $ $ S $

## 输出格式

$ T $ 行出力せよ。$ i $ 行目には $ i $ 番目のテストケースについて、条件を満たす文字列 $ S' $ が存在する場合は `Yes` を、存在しない場合は `No` を出力せよ。

## 说明/提示

### 制約

- $ 1\ \leq\ T\ \leq\ 10^5 $
- $ 1\ \leq\ N\ \leq\ 2\ \times\ 10^5 $
- $ 1\ \leq\ K\ \leq\ 10^{18} $
- $ S $ は英小文字からなる長さ $ N $ の文字列
- 入力される数値はすべて整数
- $ 1 $ つの入力に含まれるテストケースについて、 $ N $ の総和は $ 2\ \times\ 10^5 $ 以下
 
### Sample Explanation 1

$ 1 $ 番目のテストケースについて、例えば $ S'\ =\ {} $`ba` とすると $ S,S' $ をこの順に結合して得られる文字列 `abbaabba` は回文になっています。また、 $ S',S $ をこの順に結合して得られる文字列 `baabbaab` も回文になっています。以上より $ S'\ =\ {} $`ba` は条件を満たすので答えは `Yes` になります。 $ 2 $ 番目のテストケースについては、条件を満たす $ S' $ が存在しないことが証明できます。

## 样例 #1

### 输入

```
2

6 2

abbaab

5 3

abcbb
```

### 输出

```
Yes

No
```

## 样例 #2

### 输入

```
3

12 400378271514996652

njvhhvjnnjvh

10 884633988115575508

rrhiyvrrur

36 71630165869626180

vsxmxajrrduhhudrrjaxmxsvvsxmxajrrduh
```

### 输出

```
Yes

No

Yes
```



---

---
title: "ヘイホー君と削除"
layout: "post"
diff: 普及+/提高
pid: AT_cf_2015_morning_easy_d
tag: []
---

# ヘイホー君と削除

## 题目描述

一个字符串重复两次会得到一个平方字符串。例如，`abcabc`、`abababab`都是平方字符串；而`abc`和`ababab`都不是平方字符串；长度为0的字符串，也是平方字符串。



一天，ヘイホー君得到了一个只包含小写英文字母的字符串，他想让你删除任意P个字符后变成平方字符串。



求P（也就是删除次数）的最小值。

## 输入格式

- 第一行，一个整数N($1 \leq n \leq 100$)，表示ヘイホー君得到的字符串的长度。



- 第二行，为ヘイホー君得到的字符串。

## 输出格式

在一行输出P（最小删除次数），末尾要有换行。



### 关于样例#2



输出样例#2有误，ATC官网的输出样例#2为0。

## 样例 #1

### 输入

```
8

abacbabc
```

### 输出

```
2
```

## 样例 #2

### 输入

```
8

abababab
```

### 输出

```
0
```

## 样例 #3

### 输入

```
5

abcde
```

### 输出

```
5
```

## 样例 #4

### 输入

```
26

codefestivaltwozeroonefive
```

### 输出

```
14
```



---

---
title: "一次元オセロ"
layout: "post"
diff: 普及+/提高
pid: AT_cf_2015_morning_hard_a
tag: []
---

# 一次元オセロ

## 题目描述

小A在玩一维奥赛罗。一维奥赛罗是一种在无限长的一行格子内摆放棋子的游戏。棋子的一面是黑色，而另一面是白色。

它的规则如下：

1. 首先按照白色棋子  $A_1$ 个，黑色棋子  $A_2$ 个，白色棋子  $A_3$ 个，...，白色棋子  $A_N$ 个这样的顺序进行摆放。
2. 把黑色的棋子放在任意一个空闲位置。这时，所放置的位置左右的2格中必须正好1格有白色的棋子。
3. 将距离放置的黑色棋子最近的其他黑色棋子之间的白色陀螺全部翻过来做成黑色的棋子，这样的若干对黑色棋子总是唯一确定的。
4. 黑白棋子交换。
5. 重复  $2$～  $4$。
6.   步骤$3$ 或  $4$结束时，如果所有的棋子颜色相同，则游戏结束。

因为要把很多棋子翻过来是很困难的，所以小A想把棋子翻过来的次数减少一些。请在游戏结束前，求小A翻转棋子的次数之和的最小值。

## 输入格式

第一行是一个整数  $N(3\leqslant N<10^5,N$ 为奇数 $)$。

第二行是  $N$ 个整数，分别表示  $A_1,A_2,...,A_N$。

## 输出格式

游戏结束时小A反转棋子的最少次数。输出这个数。

## 说明/提示

像图片中所示的一样反转棋子，一共反转了  $1+4+5+10=20$ 次棋子，使得游戏结束。

翻译By @[liuziwen0224](/user/141683)

## 样例 #1

### 输入

```
5

1 2 3 4 5
```

### 输出

```
20
```

## 样例 #2

### 输入

```
9

100000000 20 15 11 14 20 15 11 15
```

### 输出

```
554
```



---

---
title: "辞書順で何番目？"
layout: "post"
diff: 普及+/提高
pid: AT_chokudai_S001_k
tag: []
---

# 辞書順で何番目？

## 题目描述

[problemUrl]: https://atcoder.jp/contests/chokudai_S001/tasks/chokudai_S001_k

長さ $ N $ の順列のうち、$ a $ は辞書順で何番目になるかを求めなさい。

ただし、答えは非常に大きくなるため、$ 1,000,000,007 $ で割った余りを出力しなさい。

## 说明/提示

### 制約

- $ 1\ \leq\ N\ \leq\ 100,000 $

## 样例 #1

### 输入

```
5

3 1 5 4 2
```

### 输出

```
54
```

## 样例 #2

### 输入

```
6

1 2 3 4 5 6
```

### 输出

```
1
```

## 样例 #3

### 输入

```
7

7 6 5 4 3 2 1
```

### 输出

```
5040
```

## 样例 #4

### 输入

```
20

19 11 10 7 8 9 17 18 20 4 3 15 16 1 5 14 6 2 13 12
```

### 输出

```
542869439
```



---

---
title: "種類数 β"
layout: "post"
diff: 普及+/提高
pid: AT_chokudai_S002_k
tag: []
---

# 種類数 β

## 题目描述

[problemUrl]: https://atcoder.jp/contests/chokudai_S002/tasks/chokudai_S002_k

整数のペアが $ N $ 組あります。$ i $ 番目の整数のペアは $ (A_i,\ B_i) $ です。

すぬけ君は各ペアからちょうど $ 1 $ つずつ整数を選ぼうとしています。選ばれた $ N $ 個の整数の**種類数**として考えられる最大値はいくらでしょうか？

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ A_1 $ $ B_1 $ $ A_2 $ $ B_2 $ $ : $ $ A_N $ $ B_N $

## 输出格式

すぬけ君が選ぶ $ N $ 個の整数の種類数として考えられる最大値を出力せよ。

## 说明/提示

### 制約

入力は以下の条件を満たす。

- $ 1\ \leq\ N\ \leq\ 2\ \times\ 10^5 $
- $ 1\ \leq\ A_i,B_i\ \leq\ 10^9 $
- 入力される値は全て整数

### Sample Explanation 1

各ペアからそれぞれ $ 58,58,20,425,48 $ を選ぶと $ 4 $ 種類の整数を選ぶことができます。$ 5 $ 種類以上の整数を選ぶことはできません。

## 样例 #1

### 输入

```
5

58 48

58 58

20 19

58 425

48 425
```

### 输出

```
4
```

## 样例 #2

### 输入

```
3

1000000000 1000000000

1000000000 1000000000

1000000000 1000000000
```

### 输出

```
1
```



---

---
title: "壊れた電車"
layout: "post"
diff: 普及+/提高
pid: AT_codefestival_2015_qualA_d
tag: []
---

# 壊れた電車

## 题目描述

[problemUrl]: https://atcoder.jp/contests/code-festival-2015-quala/tasks/codefestival_2015_qualA_d

高橋鉄道では、$ N $ 両編成の電車の一部が壊れてしまったため、$ M $ 人の整備士が点検をすることになりました。

$ i $ 人目の整備士ははじめ、$ X_i $ 両目の車両にいます。それぞれの整備士は、今いる車両を点検することと、隣の車両に移動することができます。車両の点検には時間はかかりませんが、隣の車両に移動するには $ 1 $ 分かかります。

全ての車両を少なくとも $ 1 $ 人の整備士が点検した状態になると点検作業は終了となります。点検作業は最短何分で終了させることができるでしょうか。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ M $ $ X_1 $ $ X_2 $ : $ X_M $

- $ 1 $ 行目には、$ 2 $ つの整数 $ N\ (1\ ≦\ N\ ≦\ 10^9),\ M\ (1\ ≦\ M\ ≦\ 10^5,\ M\ ≦\ N) $ が空白区切りで与えられる。これは、電車が $ N $ 両の車両からなり、整備士が $ M $ 人いることを表す。
- $ 2 $ 行目からの $ M $ 行には、整備士の情報が与えられる。このうち $ i\ (1\ ≦\ i\ ≦\ M) $ 行目には、整数 $ X_i\ (1\ ≦\ X_i\ ≦\ N) $ が与えられる。これは、$ i $ 人目の整備士がはじめ $ X_i $ 両目の車両にいることを表す。ただし、$ X_i $ は全て相異なることが保証される。また、整備士の情報は $ 1 $ 両目の車両に近い順に与えられる、つまり $ X_j\ <\ X_{j+1}\ (1\ ≦\ j\ ≦\ M-1) $ であることが保証される。

## 输出格式

点検作業にかかる時間の最小値を分単位で $ 1 $ 行に出力せよ。出力の末尾に改行を入れること。

## 说明/提示

### 部分点

この問題には部分点が設定されている。

- $ N\ ≦\ 100 $ を満たすデータセットに正解した場合は、$ 20 $ 点が与えられる。
- $ N\ ≦\ 500,000 $ を満たすデータセットに正解した場合は、上記とは別に $ 60 $ 点が与えられる。
- 追加の制約のないデータセットに正解した場合は、上記とは別に $ 20 $ 点が与えられる。

### Sample Explanation 1

下の図のように整備士が移動すれば $ 3 $ 分で点検作業を終了させることができます。 !\[figure1\](https://code-festival-2015-quala.contest.atcoder.jp/img/other/code\_festival\_2015\_quala/BrokenDensya.png)

## 样例 #1

### 输入

```
17 5

1

5

10

15

16
```

### 输出

```
3
```

## 样例 #2

### 输入

```
66 10

8

9

16

23

37

47

51

52

53

64
```

### 输出

```
8
```



---

---
title: "Exactly N points"
layout: "post"
diff: 普及+/提高
pid: AT_codefestival_2016_final_b
tag: []
---

# Exactly N points

## 题目描述

[problemUrl]: https://atcoder.jp/contests/cf16-final/tasks/codefestival_2016_final_b

ある年のCODE FESTIVALの決勝では $ N $ 問の問題が出題されました。

$ i\ (1≦i≦N) $ 番目の問題の配点は $ i $ 点です。

高橋くんは、このコンテストでちょうど $ N $ 点を取りたいと思い、そのために解く問題の集合をどうするかを考えています。

配点が高い問題は難しいので、解く問題の配点のうちの最大値が最小になるようにしようと考えました。

高橋くんが解くべき問題の集合を求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $

## 输出格式

点数の合計がちょうど $ N $ となるような集合のうち、配点の最大値が最小となるようなものを求め、その集合に含まれる問題の番号を $ 1 $ 行にひとつずつ出力せよ。昇順に出力する必要はありません。

そのような集合が複数考えられる場合は、いずれを出力しても構わない。

## 说明/提示

### 制約

- $ 1≦N≦10^7 $

### 部分点

- $ 1≦N≦1000 $ を満たすデータセットに正解した場合は、$ 200 $ 点が与えられる。
- 追加制約のないデータセットに正解した場合は、上記とは別に $ 100 $ 点が与えられる。

### Sample Explanation 1

$ 4 $ 番目の問題のみを解いた場合もちょうど $ 4 $ 点が得られますが、$ 1,3 $ 番目の問題を解く方が配点の最大値が小さくなります。

### Sample Explanation 2

$ \{3,4\} $ という集合も考えられます。

## 样例 #1

### 输入

```
4
```

### 输出

```
1

3
```

## 样例 #2

### 输入

```
7
```

### 输出

```
1

2

4
```

## 样例 #3

### 输入

```
1
```

### 输出

```
1
```



---

---
title: "Interpretation"
layout: "post"
diff: 普及+/提高
pid: AT_codefestival_2016_final_c
tag: []
---

# Interpretation

## 题目描述

用 $1$ 到 $m$ 这 $m$ 个正整数为 $m$ 种语言编号。现在有 $n$ 个人，他们的编号依次为 $1,2,...,n$。第 $i$ 个人会说这 $m$ 种语言中的 $k_i$ 种，它们的编号分别为 $l_{i,1},l_{i,2},...,l_{i,k_i}$。

现在，如果说编号 $a$ 和编号 $b$ 的两个人是“可以交流的”，当且仅当两人存在以下两种模式中的至少一种：

- 当 $a$ 和 $b$ 可以直接交流时，满足：存在至少一种语言，$a$ 和 $b$ 都会。
- 当 $a$ 和 $b$ 可以间接交流时，满足：存在一个人 $x$，他（她）可以分别与 $a$ 和 $b$ 直接交流。

请问：每个人是否都能和其他人中的任意一个直接或间接地交流？

## 输入格式

输入共 $(n+1)$ 行。第一行是一行两个以单个空格隔开的正整数 $n$ 和 $m$，接下来的 $n$ 行中，第 $i$ 行会输入 $(k_i+1)$ 个数，依次为 $k_i$ 和所有的 $l_{i,j}(1 \le j \le k_i)$，相邻的两个数之间以单个空格隔开。

## 输出格式

输出一行一个字符串。如果每个人都可以和其他人中的任意一个交流请输出`YES`；否则，请输出`NO`。

## 说明/提示

#### 输入输出样例 #1 说明

（为了简便，每个人直接用其编号代替，样例 $ \#2 $ 解释同）

任意两个人都可以交流，如下：

- $1$ 和 $2$ 都会说语言 $2$；
- $2$ 和 $3$ 都会说语言 $4$；
- $1$ 和 $3$ 可以通过 $2$ 间接交流；
- $3$ 和 $4$ 都会说语言 $6$；
- $2$ 和 $4$ 可以通过 $3$ 间接交流；
- $1$ 和 $4$ 可以通过 $2$ 间接交流。（这里请注意，$1$ 和 $4$ 是通过 $1-2-3-4$ 的链条来间接交流的）

#### 输入输出样例 #2 说明

例如，$1$ 和 $3$ 不能交流。

#### 数据规模与约定

所有输入数据保证：

- $2 \le n \le 10^5$，$1 \le m \le 10^5$，$1 \le k_i \le m$，且所有 $k_i$ 之和 $\le 10^5$；
- $1 \le l_{i,j} \le m$，且对于同一个 $i$ 来说，$l_{i,j}$ 互不相同。

## 样例 #1

### 输入

```
4 6

3 1 2 3

2 4 2

2 4 6

1 6
```

### 输出

```
YES
```

## 样例 #2

### 输入

```
4 4

2 1 2

2 1 2

1 3

2 4 3
```

### 输出

```
NO
```



---

---
title: "Pair Cards"
layout: "post"
diff: 普及+/提高
pid: AT_codefestival_2016_final_d
tag: []
---

# Pair Cards

## 题目描述

## 题意：

已知高桥君有 $n$ 张卡片，每一张卡牌上有一个整数 $x_i$。高桥君想要以以下两种条件合并两张卡牌：

$1$：两张卡牌上的整数相等。

$2$：两张卡牌上的整数之和是 $m$ 的倍数。

求出高桥君可以组成多少组的组数最大值。

注：一张卡牌不能在多组中使用。


------------

## 输入格式

第一行两个整数 $n$ 和 $m$。

接下来一行，有 $n$ 个整数：$x_1$，$x_2...x_n$。


------------

## 输出格式

输出组数的最大值。



------------

## 说明/提示

$2\le n \le 10^5$，$1\le m \le 10^5$，$1 \le x_i \le 10^5$。

## 样例 #1

### 输入

```
7 5

3 1 4 1 5 9 2
```

### 输出

```
3
```

## 样例 #2

### 输入

```
15 10

1 5 6 10 11 11 11 20 21 25 25 26 99 99 99
```

### 输出

```
6
```



---

---
title: "Gr-idian MST"
layout: "post"
diff: 普及+/提高
pid: AT_codefestival_2016_qualB_c
tag: []
---

# Gr-idian MST

## 题目描述

[problemUrl]: https://atcoder.jp/contests/code-festival-2016-qualb/tasks/codefestival_2016_qualB_c

$ xy $平面上の$ 0\ ≦\ x\ ≦\ W,\ 0\ ≦\ y\ ≦\ H $をみたす領域にある$ x,y $ともに整数である点すべてに、ひとつずつ家があります。

$ x $座標が等しく$ y $座標の差が$ 1 $であるか、$ y $座標が等しく$ x $座標の差が$ 1 $であるような$ 2 $点の組のうち、両方の点に家が存在するような全てのものに対し、その$ 2 $点の間には舗装されていない道路があります。

座標$ (i,j) $と$ (i+1,j) $にある家の間の道路を舗装するのには$ j $の値にかかわらずコストが$ p_i $、 座標$ (i,j) $と$ (i,j+1) $にある家の間の道路を舗装するのには$ i $の値にかかわらずコストが$ q_j $かかります。

高橋君は、このうちいくつかの道路を舗装し、舗装された道路のみを通って任意の$ 2 $つの家の間を行き来できるようにしたいです。 かかるコストの総和の最小値を求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ W $ $ H $ $ p_0 $ : $ p_{W-1} $ $ q_0 $ : $ q_{H-1} $

## 输出格式

コストの総和の最小値を表す整数を出力せよ。

## 说明/提示

### 制約

- $ 1\ ≦\ W,H\ ≦\ 10^5 $
- $ 1\ ≦\ p_i\ ≦\ 10^8(0\ ≦\ i\ ≦\ W-1) $
- $ 1\ ≦\ q_j\ ≦\ 10^8(0\ ≦\ j\ ≦\ H-1) $
- $ p_i(0\ ≦\ i\ ≦\ W-1) $は整数である
- $ q_j(0\ ≦\ j\ ≦\ H-1) $は整数である

### Sample Explanation 1

次の$ 8 $本の道路を舗装すればよいです。 - $ (0,0) $と$ (0,1) $にある家を結ぶ道路 - $ (0,1) $と$ (1,1) $にある家を結ぶ道路 - $ (0,2) $と$ (1,2) $にある家を結ぶ道路 - $ (1,0) $と$ (1,1) $にある家を結ぶ道路 - $ (1,0) $と$ (2,0) $にある家を結ぶ道路 - $ (1,1) $と$ (1,2) $にある家を結ぶ道路 - $ (1,2) $と$ (2,2) $にある家を結ぶ道路 - $ (2,0) $と$ (2,1) $にある家を結ぶ道路

## 样例 #1

### 输入

```
2 2

3

5

2

7
```

### 输出

```
29
```

## 样例 #2

### 输入

```
4 3

2

4

8

1

2

9

3
```

### 输出

```
60
```



---

---
title: "Greedy customers"
layout: "post"
diff: 普及+/提高
pid: AT_codefestival_2016_qualB_d
tag: []
---

# Greedy customers

## 题目描述

[problemUrl]: https://atcoder.jp/contests/code-festival-2016-qualb/tasks/codefestival_2016_qualB_d

高橋商店の前には、$ N $ 人の人が $ 1 $ 列に並んでいます。前から $ i $ 人目の人の所持金は正整数 $ A_i $ です。

店主の高橋君は、「品物を選んでその価格を表す正の整数 $ P $ を設定し、前の人から順にその品物を見せていく」というステップを繰り返します。

各ステップにおいて、各人は、品物を見せられた時、その価格 $ P $ が現時点でのその人の所持金以下だった場合その品物を購入し、高橋君の $ 1 $ 回のステップは終了します。 すなわち、所持金が $ P $ 以上の最初の人の所持金が $ P $ 減少し、次のステップに移ります。

高橋君は正整数 $ P $ の値を、ステップごとに独立に決めることができます。

高橋君はできるだけ多くの品物を売りたいですが、品物を売った人の所持金が $ 0 $ になってしまうと、その人は帰れなくなってしまいます。人が帰れなくなってしまうと高橋君は困ってしまうので、どの人の所持金も $ 0 $ にしてはいけません。

高橋君に代わって、各人の最初の所持金が与えられたとき、高橋君が最大でいくつの品物を売ることができるかを求めるプログラムを作成してください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ A_1 $ : $ A_N $

## 输出格式

高橋君が売ることのできる商品の最大数を表す整数を出力せよ。

## 说明/提示

### 制約

- $ 1\ ≦\ N\ ≦\ 100000 $
- $ 1\ ≦\ A_i\ ≦\ 10^9(1\ ≦\ i\ ≦\ N) $
- 入力はすべて整数である

### Sample Explanation 1

$ P $の値として、順に$ 1,4,1 $と選べばよいです。

## 样例 #1

### 输入

```
3

3

2

5
```

### 输出

```
3
```

## 样例 #2

### 输入

```
15

3

1

4

1

5

9

2

6

5

3

5

8

9

7

9
```

### 输出

```
18
```



---

---
title: "二人のアルピニスト"
layout: "post"
diff: 普及+/提高
pid: AT_codefestival_2016_qualC_c
tag: []
---

# 二人のアルピニスト

## 题目描述

[problemUrl]: https://atcoder.jp/contests/code-festival-2016-qualc/tasks/codefestival_2016_qualC_c

アルピニストである高橋君と青木君は最近ある有名な山脈を踏破しました。この山脈は$ N $ 個の山からなっており、西から東に向けて山$ 1 $,山$ 2 $,$ ... $,山$ N $と一直線に並んでいます。高橋君は西から、青木君は東からこの山脈を踏破しました。

山$ i $ の高さは$ h_i $ ですが、二人とも各$ h_i $ の値は忘れてしまいました。その代わり、各$ i\ (1≦i≦N) $ に対して、山$ i $ の山頂にたどり着いた時の、それまでに登った山(山$ i $ も含む)の高さの最大値を記録しています。 高橋君の記録した値は$ T_i $ で、青木君の記録した値は$ A_i $ です。

各山の高さ$ h_i $ が正の整数であることはわかっています。山の高さの列としてありうるものが何通りあるかを$ 10^9+7 $ で割ったあまりを求めてください。

ただし記録が間違っていてありうる山の高さの列が存在しないこともあります。この場合は$ 0 $を出力してください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ T_1 $ $ T_2 $ $ ... $ $ T_N $ $ A_1 $ $ A_2 $ $ ... $ $ A_N $

## 输出格式

山の高さの列としてありうるものが何通りあるかを $ 10^9+7 $ で割ったあまりを出力せよ。

## 说明/提示

### 制約

- $ 1≦N≦10^5 $
- $ 1≦T_i≦10^9 $
- $ 1≦A_i≦10^9 $
- $ T_i≦T_{i+1}\ (1≦i≦N-1) $
- $ A_i≧A_{i+1}\ (1≦i≦N-1) $

### Sample Explanation 1

山の高さの列として、 - $ 1,3,2,2,2 $ - $ 1,3,2,1,2 $ - $ 1,3,1,2,2 $ - $ 1,3,1,1,2 $ の$ 4 $通りがありえます。

### Sample Explanation 2

高橋君によると山を全て登り切った後の山の高さの最大値は$ 2 $で、青木君によると$ 3 $なので、記録は矛盾しています。

### Sample Explanation 3

$ 10^9+7 $ で割ったあまりを求めることを忘れないようにしてください。

### Sample Explanation 4

山が一つの山脈もあります。

## 样例 #1

### 输入

```
5

1 3 3 3 3

3 3 2 2 2
```

### 输出

```
4
```

## 样例 #2

### 输入

```
5

1 1 1 2 2

3 2 1 1 1
```

### 输出

```
0
```

## 样例 #3

### 输入

```
10

1 3776 3776 8848 8848 8848 8848 8848 8848 8848

8848 8848 8848 8848 8848 8848 8848 8848 3776 5
```

### 输出

```
884111967
```

## 样例 #4

### 输入

```
1

17

17
```

### 输出

```
1
```



---

---
title: "Palindromic Matrix"
layout: "post"
diff: 普及+/提高
pid: AT_code_festival_2017_quala_c
tag: []
---

# Palindromic Matrix

## 题目描述

[problemUrl]: https://atcoder.jp/contests/code-festival-2017-quala/tasks/code_festival_2017_quala_c

縦 $ H $ 行、横 $ W $ 列の行列 $ A $ があります。 上から $ i $ 行目、左から $ j $ 列目の要素を $ a_{ij} $ とします。 各 $ a_{ij} $ は英小文字です。

すぬけ君は、$ A $ の要素を自由に並べ替え、縦 $ H $ 行、横 $ W $ 列の行列 $ A' $ を作ろうとしています。 このとき、次の条件が成り立つようにします。

- $ A' $ のどの行およびどの列もそれぞれ回文になっている。

条件を満たす $ A' $ が存在するか判定してください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ H $ $ W $ $ a_{11} $$ a_{12} $$ ... $$ a_{1W} $ $ : $ $ a_{H1} $$ a_{H2} $$ ... $$ a_{HW} $

## 输出格式

条件を満たす $ A' $ が存在するならば `Yes` を、存在しないならば `No` を出力せよ。

## 说明/提示

### 注釈

回文とは、前後を反転しても変わらない文字列のことです。 例えば、`a`, `aa`, `abba`, `abcba` は回文ですが、`ab`, `abab`, `abcda` は回文ではありません。

### 制約

- $ 1\ <\ =\ H,\ W\ <\ =\ 100 $
- $ a_{ij} $ は英小文字である。

### Sample Explanation 1

例えば、次の $ A' $ は条件を満たします。 ``` abba acca abba ```

### Sample Explanation 2

どのように $ A $ の要素を並べ替えても、条件を満たす $ A' $ を作れません。

### Sample Explanation 3

例えば、次の $ A' $ は条件を満たします。 ``` t e w e t ```

## 样例 #1

### 输入

```
3 4

aabb

aabb

aacc
```

### 输出

```
Yes
```

## 样例 #2

### 输入

```
2 2

aa

bb
```

### 输出

```
No
```

## 样例 #3

### 输入

```
5 1

t

w

e

e

t
```

### 输出

```
Yes
```

## 样例 #4

### 输入

```
2 5

abxba

abyba
```

### 输出

```
No
```

## 样例 #5

### 输入

```
1 1

z
```

### 输出

```
Yes
```



---

---
title: "身体バランス"
layout: "post"
diff: 普及+/提高
pid: AT_code_festival_morning_easy_c
tag: []
---

# 身体バランス

## 题目描述

[problemUrl]: https://atcoder.jp/contests/code-festival-2014-morning-easy/tasks/code_festival_morning_easy_c

C さんは斜めがけの鞄を愛用しています。 しかし、片方の肩にばかり鞄をかけていると、身体が歪んでしまうと言われたため、両方の肩に同じ時間だけ鞄をかけるように心がけることにしています。

C さんの住んでいる国には、$ n $ 個の街と、街同士をつなぐ $ m $ 個の道があります。 どの $ 2 $ つの異なる道に関しても、結んでいる $ 2 $ つの街同士が一致することはありません。

C さんはある日、街 $ s $ から街 $ t $ へと移動する必要が出てきました。 そこで、途中の街 $ u $ で一度だけ鞄を持ち替えて、左右の肩に鞄をかける時間を同じにしたいと考えています。 しかし、C さんは最強最速なので、街 $ s $ から街 $ u $、街 $ u $ から街 $ t $ への移動は最短経路を通ります。

このような街 $ u $ の選び方があるかどうかを求めてください。

## 输入格式

入力は以下の形式で与えられる。

> $ n $ $ m $ $ s $ $ t $ $ x_1 $ $ y_1 $ $ d_1 $ $ x_2 $ $ y_2 $ $ d_2 $ $ ... $ $ x_m $ $ y_m $ $ d_m $

- $ 1 $ 行目には、街の数を表す整数 $ n $ ($ 3\ \leq\ n\ \leq\ 1{,}000 $) と、道の数を表す整数 $ m $ ($ 1\ \leq\ m\ \leq\ min(n(n-1)/2,\ 10^4) $) が与えられる。
- 街にはそれぞれ $ 1 $ から $ n $ までの番号が振られている。
- $ 2 $ 行目には、出発する街の番号を表す整数 $ s $ ($ 1\ \leq\ s\ \leq\ n $) と、目的地の街の番号を表す整数 $ t $ ($ 1\ \leq\ t\ \leq\ n $) が与えられる。
- 続く $ m $ 行には、各道の情報が与えられる。
- $ x_i,\ y_i $ ($ 1\ \leq\ x_i,\ y_i\ \leq\ n $ かつ $ x_i\ \neq\ y_i $) と $ d_i $ ($ 1\ \leq\ d_i\ \leq\ 1{,}000 $) は、$ i $ 番目の道によって街 $ x_i $ と街 $ y_i $ の間を移動するのに $ d_i $ の時間がかかることを意味する。
- 街 $ s $ から街 $ t $ へは到達可能であることが保証される。

## 输出格式

答えとなる街 $ u $ が存在する場合は、その街の番号を $ 1 $ 行で出力せよ。

答えの候補が複数ある場合は、どれを出力してもよい。

また、そのような街 $ u $ が無い場合は `-1` を出力せよ。

最後は改行し、余計な文字、空行を含まないこと。

## 说明/提示

### Sample Explanation 1

街 $ 1 $ から街 $ 2 $ へ行く際に、街 $ 3 $ を経由した場合、$ 1\ →\ 3 $ で $ 3 $ の時間がかかり、$ 3\ →\ 2 $ で $ 3 $ の時間がかかるため、街 $ 3 $ を経由して、そこで鞄を持ち替えればよい。

### Sample Explanation 2

$ 1\ →\ 2\ →\ 4\ →\ 3 $ という順に移動すれば、街 $ 4 $ で鞄を持ち替えることで左右にかかる負担を同じにすることができるが、C さんは街 $ 1 $ から街 $ 4 $ まで最短経路を通るので、このような移動のしかたはできない。

## 样例 #1

### 输入

```
3 3

1 2

1 3 3

3 2 3

1 2 1
```

### 输出

```
3
```

## 样例 #2

### 输入

```
4 4

1 3

1 2 2

1 4 3

2 4 3

3 4 5
```

### 输出

```
-1
```



---

---
title: "壊れた電卓"
layout: "post"
diff: 普及+/提高
pid: AT_code_festival_qualA_d
tag: []
---

# 壊れた電卓

## 题目描述

高桥君的计算器坏了。如果输入的数中，数字种类多于 $K$ 种（如：$12235$ 中，有 $4$ 种数字，分别为：$1$、$2$、$3$、$5$），计算将中断。

给定整数 $A$，高桥君想输入这个整数。但是，如果尝试正常输入整数，计算可能会中断，因此请在计算不中断的范围内输入与整数 $A$ 差异尽可能小的整数。

此时，输出高桥君输入的整数与整数 $A$ 之间的差值有多大。

## 输入格式

一行两个整数，表示 $A$ 与 $K$。

## 输出格式

一行一个整数，表示高桥君输入的整数与整数 $A$ 之差的最小值。

## 样例 #1

### 输入

```
1234 2
```

### 输出

```
12
```

## 样例 #2

### 输入

```
800000 1
```

### 输出

```
22223
```

## 样例 #3

### 输入

```
7328495 10
```

### 输出

```
0
```

## 样例 #4

### 输入

```
262004 2
```

### 输出

```
218
```



---

---
title: "錬金術士"
layout: "post"
diff: 普及+/提高
pid: AT_code_festival_qualB_c
tag: []
---

# 錬金術士

## 题目描述

[problemUrl]: https://atcoder.jp/contests/code-festival-2014-qualb/tasks/code_festival_qualB_c

高橋君は錬金術のプロフェッショナルです。

この世界の金属には、 $ 2N $ 文字（ $ N $ は整数）からなる名前が付けられており、名前は全て大文字アルファベットで構成されています。

高橋君が既存の金属 $ S1,\ S2 $ から新たな金属 $ S3 $ を錬金できる条件は、$ S1,S2 $ からそれぞれ $ N $ 文字ずつ取り出してきて、それらの文字を適当に並べ替えた結果、 $ S3 $ と一致するときです。

$ 3 $ つの金属の名前$ S1,\ S2,\ S3 $が与えられるので $ S1,\ S2 $ から $ S3 $ が錬金できるか判定してください。

## 输入格式

入力は以下の形式で標準入力から与えられる

> $ S1 $ $ S2 $ $ S3 $

- $ 1 $ 行目には錬金の材料となる $ 1 $ つめの金属の名前 $ S1 $ が与えられる。
- $ 2 $ 行目には錬金の材料となる $ 2 $ つめの金属の名前 $ S2 $ が与えられる。
- $ 3 $ 行目には生成したい金属の名前 $ S3 $ が与えられる。
- $ S1,\ S2,\ S3 $は大文字アルファベットのみから構成される。
- $ S1,\ S2,\ S3 $の文字数は等しく、偶数である。
- $ 2\ ≦\ |\ S1\ |\ ≦\ 10^5 $ が常に成り立つ。

## 输出格式

もし$ S1,\ S2 $から$ S3 $が錬金可能ならば`YES`、錬金不可能ならば`NO`と1行で出力せよ。

## 说明/提示

### Sample Explanation 1

$ 1 $ つ目の金属から `AAD` 、 $ 2 $ つ目の金属から `AED` を取り出せば、 `EDDAAA` を作ることができます。

### Sample Explanation 2

$ 1 $ つ目の金属から少なくとも $ 4 $ 文字取り出さなければならないので錬金できません。

## 样例 #1

### 输入

```
AABCCD

ABEDDA

EDDAAA
```

### 输出

```
YES
```

## 样例 #2

### 输入

```
AAAAAB

CCCCCB

AAABCB
```

### 输出

```
NO
```



---

---
title: "登山家"
layout: "post"
diff: 普及+/提高
pid: AT_code_festival_qualB_d
tag: []
---

# 登山家

## 题目描述

高桥君是登山家，现在正在登山。

这个山脉上N个山中小屋向东西一条直线排列着，

各山小屋从西向东依次排列着，以1到N的号码排序。

第i的山中小屋建于海拔hi。

高桥君很在意从各小屋能看到几间山中小屋?

从第i个山中小屋可以看到第j个（山中小屋）的条件是，

##### 第j（山中小屋）的海拔全部为hi下（hj≤hi）。

求在各山中小屋可以看到的山中小屋的个数。

另外，从第i的山中小屋可以看到的山中小屋不包括第i个山中小屋。

## 输入格式

###### 第一行为山中小屋的个数N（1 ≦ N ≦ 100000）

###### 第二行为各小屋的海拔

## 输出格式

###### 输出N行，其中第i行表示在第i个小屋能看到的小屋数j

## 样例 #1

### 输入

```
3

1

2

3
```

### 输出

```
0

1

2
```

## 样例 #2

### 输入

```
5

1

2

3

2

1
```

### 输出

```
0

1

4

1

0
```

## 样例 #3

### 输入

```
5

3

2

1

2

3
```

### 输出

```
4

2

0

2

4
```

## 样例 #4

### 输入

```
8

4

3

2

3

4

3

2

1
```

### 输出

```
7

2

0

2

7

2

1

0
```



---

---
title: "決勝進出者"
layout: "post"
diff: 普及+/提高
pid: AT_code_formula_2014_qualA_c
tag: []
---

# 決勝進出者

## 题目描述

[problemUrl]: https://atcoder.jp/contests/code-formula-2014-quala/tasks/code_formula_2014_qualA_c

高橋君は、コンテストを開こうと思っています。

コンテストは、 $ n $ 回の予選と、 $ 1 $ 回の本選に分かれており、予選の上位 $ k $ 人を本選に招待しようと思っています。

本選の出場選手は、以下のように選ばれます。

- 各予選の最高順位が高い人から順番に選ばれる。
- 最高順位が同じ場合は、最高順位を取った予選が開かれた時期が早い方から先に選ばれる。
- $ k $ 人が選ばれるまで、この操作を続ける。

高橋君は、招待される選手に出来るだけ早く、本選への招待をしたいです。そこで、予選が終わるたびに、本選への招待が確定した選手に対し、メールを送りたいです。

各予選の結果が与えられるので、予選が終わった際に、誰にメールを送るべきかを求めてください。 なお、本選を辞退する選手はいないものとします。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ n $ $ k $ $ a_{1,1} $ $ a_{1,2} $ ... $ a_{1,k} $ $ a_{2,1} $ $ a_{2,2} $ ... $ a_{2,k} $ : $ a_{n,1} $ $ a_{n,2} $ ... $ a_{n,k} $

- $ 1 $ 行目には、予選の回数を表す整数 $ n\ (1\ ≦\ n\ ≦\ 50) $ と、本選への招待人数を表す整数 $ k\ (1\ ≦\ k\ ≦\ 1000) $ が、スペース区切りで与えられる。
- $ 2 $ 行目から $ n $ 行は、各予選での上位 $ k $ 人の選手のIDが与えられる。このうち $ i\ (1\ ≦\ i\ ≦\ n) $ 行目は、$ i $ 回目の予選の結果を表す。結果はスペース区切りの $ k $ 個の整数で与えられ、このうち $ j $ 個目の整数 $ a_{i,j}\ (1\ ≦\ a_{i,j}\ ≦\ 999999) $は、$ i $ 回目の予選で $ j $ 位だった人のIDを表す。なお、$ p\ ≠\ q $のとき、$ a_{i,p}\ ≠\ a_{i,q} $であることが保障されている。

## 输出格式

$ i\ (1\ ≦\ i\ ≦\ n) $ 回目の予選で、予選通過が確定した人のIDの一覧を、$ i $ 行目にスペース区切りで出力せよ。予選通過者が複数人いる場合は、IDが小さい順に出力しなさい。 出力の末尾にも改行をいれること。

## 说明/提示

### Sample Explanation 1

予選が $ 2 $ 回あります。 まず、$ 1 $ 回目の予選が行われた直後に、上位 $ 6 $ 人は、その後の予選の結果に拠らず、本選への招待が確定します。 次に、$ 2 $ 回目の予選が行われた際、IDが、$ 1,2 $ の二人の参加者が重複するため、$ 1 $ 回目の予選の $ 7 $ 位までと、 $ 2 $ 回目の予選の $ 6 $ 位までの、本選への招待が確定します。 出力順序は、順位に関係なく、IDが若い順であることに注意してください。

### Sample Explanation 2

本選への招待者が確定しない予選があることにも注意してください。

## 样例 #1

### 输入

```
2 11

1 2 3 4 5 6 7 8 9 10 11

1 2 15 14 13 16 17 18 19 20 21
```

### 输出

```
1 2 3 4 5 6

7 13 14 15 16
```

## 样例 #2

### 输入

```
4 5

1 2 3 4 5

2 1 3 4 5

1 2 3 4 5

2 1 3 4 5
```

### 输出

```
1 2



3

4 5
```



---

---
title: "仲良し文字列"
layout: "post"
diff: 普及+/提高
pid: AT_code_formula_2014_qualB_c
tag: []
---

# 仲良し文字列

## 题目描述

[problemUrl]: https://atcoder.jp/contests/code-formula-2014-qualb/tasks/code_formula_2014_qualB_c

(21:13 追記) |A|=|B|=1のケースがテスト中に一つ含まれていましたので、リジャッジを行います。なお、このケースで`NO`を出力するプログラムに影響はありません。

文字列 $ A $ の文字をちょうど $ 3 $ 回スワップすることにより、文字列 $ B $ に変換できるとき、二つの文字列 $ A $, $ B $ を、仲良し文字列と呼ぶことにします。

スワップとは、文字列に含まれる $ 2 $ つの文字を、入れ替えることを指します。 例えば、`abc`という文字列であれば、`a`と`c`を入れ替えて、`cba`のように変換することが出来ます。

`aa`のような文字列に対し、 $ 1 $ 文字目の`a`と、 $ 2 $ 文字目の`a`を入れ替えることは許されていますが、同じ場所の文字を指定することはできません。

文字列 $ A $, $ B $ が与えられるので、仲良し文字列になっているかどうかを判定しなさい。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ A $ $ B $

- $ 1 $ 行目には、文字列 $ A\ (2\ ≦\ |A|≦\ 1000) $ が与えられる。
- $ 2 $ 行目には、文字列 $ B\ (|B|\ =\ |A|) $ が与えられる。
- $ A $, $ B $ 共に、小文字アルファベットのみで構成されていることが保障されている。

## 输出格式

与えられた $ 2 $ つの文字列が、仲良し文字列であれば`YES`、そうでなければ`NO`を出力せよ。 出力の末尾には改行をいれること。

## 说明/提示

### Sample Explanation 1

まず、文字列 $ A $ の`abcdef`の`a`と`f`をスワップし、`fbcdea`とします。 次に、`b`と`e`をスワップし、`fecdba`とします。 最後に、`c`と`d`をスワップし、`fedcba`とすると、文字列 $ B $ と一致します。 よって、この $ 2 $ つの文字列は、仲良し文字列となるため、`YES`と出力します。

### Sample Explanation 2

使っている文字数が同じでも、 $ 3 $ 回のスワップでは同じ文字列にできないパターンも存在します。

### Sample Explanation 3

スワップの仕方が $ 1 $ 通りしかなく、 $ 3 $ 回のスワップを繰り返すと、`tn`になってしまいます。 よって、同じ $ 2 $ つの文字列ですが、仲良し文字列ではありません。

### Sample Explanation 4

まず、 $ 1 $ 番目の文字と $ 2 $ 番目の文字を入れ替え、`qpqq`とします。 次に、 $ 3 $ 番目の文字と $ 4 $ 番目の文字を入れ替え、`qpqq`とします。この際、同じ文字を選んでいますが、場所が違うので問題ありません。 最後に、$ 1 $番目の文字と、$ 2 $番目の文字を入れ替え、`pqqq`とします。

### Sample Explanation 5

長い文字列が与えらえれることがあることにも注意してください。

## 样例 #1

### 输入

```
abcdef

fedcba
```

### 输出

```
YES
```

## 样例 #2

### 输入

```
abababab

babababa
```

### 输出

```
NO
```

## 样例 #3

### 输入

```
nt

nt
```

### 输出

```
NO
```

## 样例 #4

### 输入

```
pqqq

pqqq
```

### 输出

```
YES
```

## 样例 #5

### 输入

```
abcdefghijklmnopqrstuvwxyzabcdefghijklmnopqrstuvwxyzabcdefghijklmnopqrstuvxyzw

abcdefghijklmnopqrstuvwxyzabcdefghijklmnopqrstuvwxyzabcdefghijklmnopqrstuvwxyz
```

### 输出

```
YES
```

## 样例 #6

### 输入

```
abcdef

ghijkl
```

### 输出

```
NO
```



---

---
title: "Div/de"
layout: "post"
diff: 普及+/提高
pid: AT_ddcc2020_final_a
tag: []
---

# Div/de

## 题目描述

[problemUrl]: https://atcoder.jp/contests/ddcc2020-final/tasks/ddcc2020_final_a

双子の姉妹である Yes と No は、東京で行われるプログラミングコンテストに参加します。姉妹はウォーミングアップのため、会場へ向かう新幹線でゲームをすることにしました。

姉妹は紙に $ N $ 個の正の整数を書きます。$ i\ (1\ \leq\ i\ \leq\ N) $ 番目の値は $ A_i $ です。

ゲームでは、Yes が先攻、No が後攻となって、交互に以下の操作をします。

- 紙に書いてある $ 2 $ 以上の整数を $ 1 $ つ選び、より小さい正の約数に書き換える。

先に操作ができなくなった方が負けとなります。

$ 2 $ 人が最善を尽くしたとき、勝つのは Yes と No のどちらでしょうか？

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ A_1 $ $ A_2 $ $ \dots $ $ A_N $

## 输出格式

$ 2 $ 人が最善を尽くしたとき、Yes が勝つならば `Yes` を、No が勝つならば `No` を出力せよ。

## 说明/提示

### 制約

- 入力はすべて整数
- $ 1\ \leq\ N\ \leq\ 100 $
- $ 1\ \leq\ A_i\ \leq\ 100\ (1\ \leq\ i\ \leq\ N) $

### Sample Explanation 1

ゲームの進行は、一例として次のようになります。 - Yes が $ A_4 $ を $ 4 $ から $ 2 $ に書き換える。 - No が $ A_3 $ を $ 3 $ から $ 1 $ に書き換える。 - Yes が $ A_2 $ を $ 2 $ から $ 1 $ に書き換える。 - No が $ A_4 $ を $ 2 $ から $ 1 $ に書き換える。 - Yes が $ A_5 $ を $ 5 $ から $ 1 $ に書き換える。 - No は操作できなくなり、Yes が勝つ。 No がどう動かしても、Yes が適切に操作すれば No が先に操作できなくなります。

### Sample Explanation 2

はじめから操作できないので、No が勝ちます。

## 样例 #1

### 输入

```
5

1 2 3 4 5
```

### 输出

```
Yes
```

## 样例 #2

### 输入

```
6

1 1 1 1 1 1
```

### 输出

```
No
```

## 样例 #3

### 输入

```
3

19 12 15
```

### 输出

```
No
```

## 样例 #4

### 输入

```
10

91 92 93 94 95 96 97 98 99 100
```

### 输出

```
No
```



---

---
title: "Strawberry Cakes"
layout: "post"
diff: 普及+/提高
pid: AT_ddcc2020_qual_c
tag: []
---

# Strawberry Cakes

## 题目描述

[problemUrl]: https://atcoder.jp/contests/ddcc2020-qual/tasks/ddcc2020_qual_c

chokudai さんは，DDCC 2020 本戦で参加者に配る長方形のケーキを用意しました．

このケーキは，$ H\ -\ 1 $ 本の横方向の切れ目と $ W\ -\ 1 $ 本の縦方向の切れ目により，$ H\ \times\ W $ 個の区画に等分されています．これらの区画のうち $ K $ 個には，それぞれイチゴが $ 1 $ 個乗っています．

イチゴの位置は，$ H\ \times\ W $ 個の文字 $ s_{i,\ j} $ $ (1\ \leq\ i\ \leq\ H,\ 1\ \leq\ j\ \leq\ W) $ によって与えられます．$ s_{i,\ j} $ が `#` のとき，上から $ i $ 行目，左から $ j $ 列目の区画にイチゴが乗っており，$ s_{i,\ j} $ が `.` のとき乗っていません．`#` はちょうど $ K $ 個出現します．

さて，chokudai さんはこのケーキを切れ目に沿って $ K $ 個のピースに切り分け，参加者に配布したいです．ただし，すべてのピースは以下の条件を満たさなければなりません．

- 形状は長方形である．
- ちょうど $ 1 $ 個のイチゴを含む．

例えば，次のような例が考えられます．

![ ](https://cdn.luogu.com.cn/upload/vjudge_pic/AT_ddcc2020_qual_c/cc1d9c887e66319321dc6aab838f872b37b7268e.png)

条件を満たすケーキの切り分け方を $ 1 $ つ求めてください．このような切り分け方は，イチゴの個数や位置にかかわらず必ず存在することが示せます．

## 输入格式

入力は以下の形式で標準入力から与えられます.

> $ H $ $ W $ $ K $ $ s_{1,\ 1}\ s_{1,\ 2}\ \cdots\ s_{1,\ W} $ $ s_{2,\ 1}\ s_{2,\ 2}\ \cdots\ s_{2,\ W} $ $ : $ $ s_{H,\ 1}\ s_{H,\ 2}\ \cdots\ s_{H,\ W} $

## 输出格式

切り分け後の $ K $ 個のピースに任意の順で $ 1,\ 2,\ 3,\ \dots,\ K $ の番号を付け，上から $ i $ 行目，左から $ j $ 列目の区画が属するピースの番号を $ a_{i,\ j} $ として，次の形式で出力してください．

> $ a_{1,\ 1}\ a_{1,\ 2}\ \cdots\ a_{1,\ W} $ $ a_{2,\ 1}\ a_{2,\ 2}\ \cdots\ a_{2,\ W} $ $ : $ $ a_{H,\ 1}\ a_{H,\ 2}\ \cdots\ a_{H,\ W} $

複数の切り分け方が考えられる場合，そのうちのどれを出力しても構いません．

## 说明/提示

### 制約

- $ 1\ \leq\ H\ \leq\ 300 $
- $ 1\ \leq\ W\ \leq\ 300 $
- $ 1\ \leq\ K\ \leq\ H\ \times\ W $
- $ s_{i,\ j} $ は `#` または `.`
- `#` は $ s $ にちょうど $ K $ 個出現する

### Sample Explanation 1

例えば，下の図の方法で切り分けることができます． !\[ \](https://img.atcoder.jp/ddcc2020-qual/d09e88243931000a04e555892fe7e6c9.png)

### Sample Explanation 2

例えば，下の図の方法で切り分けることができます． !\[ \](https://img.atcoder.jp/ddcc2020-qual/18d0f45847f5d107ac0322aecea39835.png)

## 样例 #1

### 输入

```
3 3 5

#.#

.#.

#.#
```

### 输出

```
1 2 2

1 3 4

5 5 4
```

## 样例 #2

### 输入

```
3 7 7

#...#.#

..#...#

.#..#..
```

### 输出

```
1 1 2 2 3 4 4

6 6 2 2 3 5 5

6 6 7 7 7 7 7
```

## 样例 #3

### 输入

```
13 21 106

.....................

.####.####.####.####.

..#.#..#.#.#....#....

..#.#..#.#.#....#....

..#.#..#.#.#....#....

.####.####.####.####.

.....................

.####.####.####.####.

....#.#..#....#.#..#.

.####.#..#.####.#..#.

.#....#..#.#....#..#.

.####.####.####.####.

.....................
```

### 输出

```
12 12 23 34 45 45 60 71 82 93 93 2 13 24 35 35 17 28 39 50 50

12 12 23 34 45 45 60 71 82 93 93 2 13 24 35 35 17 28 39 50 50

12 12 56 89 89 89 60 104 82 31 31 46 13 24 35 35 61 61 39 50 50

12 12 67 67 100 100 60 9 9 42 42 57 13 24 6 72 72 72 72 72 72

12 12 78 5 5 5 20 20 20 53 68 68 90 24 6 83 83 83 83 83 83

16 16 27 38 49 49 64 75 86 97 79 79 90 101 6 94 94 105 10 21 21

16 16 27 38 49 49 64 75 86 97 79 79 90 101 6 94 94 105 10 21 21

32 32 43 54 65 65 80 11 106 95 22 22 33 44 55 55 70 1 96 85 85

32 32 43 54 76 76 91 11 106 84 84 4 99 66 66 66 81 1 96 74 74

14 14 3 98 87 87 102 11 73 73 73 4 99 88 77 77 92 92 63 63 63

25 25 3 98 87 87 7 29 62 62 62 15 99 88 77 77 103 19 30 52 52

36 36 47 58 69 69 18 29 40 51 51 26 37 48 59 59 8 19 30 41 41

36 36 47 58 69 69 18 29 40 51 51 26 37 48 59 59 8 19 30 41 41
```



---

---
title: "Digit Sum Replace"
layout: "post"
diff: 普及+/提高
pid: AT_ddcc2020_qual_d
tag: []
---

# Digit Sum Replace

## 题目描述

[problemUrl]: https://atcoder.jp/contests/ddcc2020-qual/tasks/ddcc2020_qual_d

DDCC 20XX の予選には，$ N $ 人のプログラマーが参加する予定です．しかし，会場の都合上，本戦には $ 9 $ 人までしか参加できません．

そこで，予選を何ラウンドかに分けて勝ち抜き方式で行うことにしました．これは，以下のルールに従って行われます．

- 最初のラウンドには $ N $ 人全員が参加する．
- あるラウンドに $ X\ (X\ \geq\ 10) $ 人が参加するとき，次のラウンドに勝ち残る人数を以下のように決定する．
  - $ X $ の十進表記において，ある連続する $ 2 $ 桁を選び，それらをその和で置き換えて得られる数を勝ち残る人数とする．  
       例えば，$ X\ =\ 2378 $ のとき，勝ち残る人数は $ 578 $ ($ 2,3 $ を選んだ場合)，$ 2108 $ ($ 3,7 $ を選んだ場合)，$ 2315 $ ($ 7,8 $ を選んだ場合) 人のいずれかとなる．  
       $ X\ =\ 100 $ のときは，どちらの $ 2 $ 桁を選んだとしても勝ち残る人数は $ 10 $ 人となる．
- 勝ち残った人数が $ 9 $ 人以下となったら，予選を終了する．

DDCC 20XX の運営リーダーであるりんごさんは，できるだけ多くの予選ラウンドを開催したいです．  
 最大で何ラウンドの予選を開催できるか求めてください．

ただし，参加者数 $ N $ は非常に多くなる場合があるので，$ 2 $ つの整数列 $ d_1,\ \ldots,\ d_M $，$ c_1,\ \ldots,\ c_M $ として与えられます．  
 これは，$ N $ が十進表記において $ c_1\ +\ c_2\ +\ \ldots\ +\ c_M $ 桁の数であり，その先頭の $ c_1 $ 桁の数字がいずれも $ d_1 $，続く $ c_2 $ 桁の数字がいずれも $ d_2 $，$ \ldots $，最後の $ c_M $ 桁の数字がいずれも $ d_M $ であることを表します．

## 输入格式

入力は以下の形式で標準入力から与えられます.

> $ M $ $ d_1 $ $ c_1 $ $ d_2 $ $ c_2 $ $ : $ $ d_M $ $ c_M $

## 输出格式

予選ラウンドの数の最大値を出力してください．

## 说明/提示

### 制約

- $ 1\ \leq\ M\ \leq\ 200000 $
- $ 0\ \leq\ d_i\ \leq\ 9 $
- $ d_1\ \neq\ 0 $
- $ d_i\ \neq\ d_{i+1} $
- $ c_i\ \geq\ 1 $
- $ 2\ \leq\ c_1\ +\ \ldots\ +\ c_M\ \leq\ 10^{15} $

### Sample Explanation 1

この場合，予選の最初のラウンドには $ N=229 $ 人が参加します．大会の経過の一例として、次のパターンがありえます． - ラウンド $ 1 $ に $ 229 $ 人が参加し，ラウンド $ 2 $ に $ 49 $ 人が参加し，ラウンド $ 3 $ に $ 13 $ 人が参加し，本戦に $ 4 $ 人が進出する． このとき，予選は $ 3 $ ラウンド行われ、これが実は最適であることが分かります。

### Sample Explanation 2

この場合，最初のラウンドには $ 1000000007 $ 人が参加します．

## 样例 #1

### 输入

```
2

2 2

9 1
```

### 输出

```
3
```

## 样例 #2

### 输入

```
3

1 1

0 8

7 1
```

### 输出

```
9
```



---

---
title: "Password"
layout: "post"
diff: 普及+/提高
pid: AT_digitalarts_2
tag: []
---

# Password

## 题目描述

[problemUrl]: https://atcoder.jp/contests/digitalarts2012/tasks/digitalarts_2

セキュリティに興味がある高橋君は、デジタルアーツ株式会社に就職したい青年です。  
 そこで、高橋君は自分が運営するサービスであるAtCoderのセキュリティについて見なおしてみることにしました。  
  
 現在AtCoderのシステムでは、パスワードは $ 1 $ 文字以上 $ 20 $ 文字以下の英小文字のみとしています。  
 そして、文字列 $ s $ に対してハッシュ値( $ hash(s) $ )を求める以下の式があり、パスワードと入力した文字列に対して、それぞれこの式で算出したハッシュ値が一致すると、入力した文字列は正しいとみなします。  
  
 $ hash(s)\ =\ Num(c_1)\ +\ Num(c_2)\ +\ ...\ +\ Num(c_{N}) $ ($ c_i $ は文字列 $ s $ の $ i $ 番目の文字を意味する)  
  
 なお、上記の式の関数 $ Num() $ とは英小文字を数字に変換する関数で、$ Num( $`a`$ )\ =\ 1, $ $ Num( $`b`$ )\ =\ 2, $ $ ...., $ $ Num( $`z`$ )\ =\ 26 $ というように、`a` から `z` に対して順に $ 1 $ から $ 26 $ までの数字を返します。  
  
 高橋君は、このシステムではパスワードと違う文字列でも簡単にハッシュ値が一致してしまうことに気づきました。  
 例えば、文字列 `abc` のハッシュ値は、$ 1+2+3=6 $ となりますが、文字列 `bbb` のハッシュ値も $ 2+2+2=6 $ ですし、`f` も $ 6 $ になってしまいます。  
  
 高橋君は、現在使っているパスワードに対してどのような文字列が正しいパスワードとして認識されてしまうか知りたいです。  
 正しいパスワード以外で条件を満たすものを $ 1 $ つ出力しなさい。  
 条件を満たすものが複数ある場合は、どの文字列を出力しても構いません。  
 もし条件を満たすパスワードが存在しない場合は `NO` と出力しなさい。  
 なお、AtCoderのシステムで入力できるパスワードは $ 1 $ 文字以上 $ 20 $ 文字以下の英小文字のみなので、 答えとして出力する文字列もその条件をみたします。 入力は以下の形式で標準入力から与えられる。

> $ c_1c_2‥‥c_N $

- 入力には正しいパスワードを表す長さ $ N(1≦N≦20) $ の文字列が $ 1 $ 行で与えられる。 
  - 正しいパスワードの $ i $ 番目の文字を表す $ c_i $ は英小文字 (`a-z`) である。
 
 与えられた正しいパスワードを表す文字列と等しいハッシュ値になる英小文字 $ 1 $ 文字以上 $ 20 $ 文字以下の文字列を、正しいパスワード以外のいずれか $ 1 $ つ出力せよ。  
 また、そのような文字列が存在しない場合は `NO` と出力せよ。  
 なお、出力は $ 1 $ 行のみとし、最後には改行を出力せよ。 ```

abc
```

 ```

bbb
```

- 問題文内に示しているように、ハッシュ値が $ 6 $ になります。
- 他にも `f` 、`aaaaaa` 、 `cc` でも構いません。
 
```

zzzzzzzzzzzzzzzzzzzz
```

 ```

NO
```

- 条件を満たす文字列は正しいパスワードしか存在しません。
 
```

abcdef
```

 ```

fedcba
```

- ハッシュ値は $ 21 $ になります。
 
```

k
```

 ```

bbbbba
```


```

aa
```

 ```

b
```

- ハッシュ値が $ 2 $ になる文字列は正しいパスワード以外に、`b` しかありません。



---

---
title: "DDPC特別ビュッフェⅡ"
layout: "post"
diff: 普及+/提高
pid: AT_discovery_2016_final_b
tag: []
---

# DDPC特別ビュッフェⅡ

## 题目描述

[problemUrl]: https://atcoder.jp/contests/discovery2016-final/tasks/discovery_2016_final_b

DISCO presents ディスカバリーチャンネルプログラミングコンテスト 2016本戦のDDPC特別ビュッフェの時間が始まりました。あなたはこれから料理の載っていないトレーに料理を載せに行くところです。 DDPC特別ビュッフェには $ N $ 種類の料理があります。 $ i $ 種類目の料理はビュッフェの開始から $ T_i $ 秒後になくなり、料理の美味しさは $ A_i $ です。

DDPC特別ビュッフェにはいくつかの特別なルールがあります。

- あなたは $ 1 $ 種類の料理をトレーに載せるのに $ 1 $ 秒かけなくてはならない。すなわち料理を載せ始めた時刻が $ s $ であったとき、料理を載せ終わったときの時刻は $ s+1 $ となる。
- あなたは以前にトレーに載せた料理と同じ種類の料理を載せてはならない。
- 現在の時刻 $ s $ が$ s+1≦T_i $ を満たさないとき、種類 $ i $ の料理をトレーに載せることはできない。

あなたはトレーに載っている料理の美味しさの総和が $ X $ 以上になったところで席に戻ることにしました。トレーに載っている料理の美味しさの総和を $ X $ 以上にすることが可能な最小の時刻 $ t $ を求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ X $ $ T_1 $ $ T_2 $ … $ T_N $ $ A_1 $ $ A_2 $ … $ A_N $

- $ 1 $ 行目にDDPC特別ビュッフェに存在する料理の種類数を表す整数 $ N(1≦N≦10^{5}) $ とトレーに載っている料理の美味しさの総和の目標値 $ X(1≦X≦10^{9}) $ が空白区切りで与えられる。
- $ 2 $ 行目にDDPC特別ビュッフェに存在する料理の $ i $ 種類目の料理がなくなる時刻 $ T_i\ (1≦T_i≦10^{5}) $ が空白区切りで与えられる。
- $ 3 $ 行目にDDPC特別ビュッフェに存在する料理の $ i $ 種類目の料理の美味しさを表す整数 $ A_i\ (1≦A_i≦10^{5}) $ が空白区切りで与えられる。

## 输出格式

トレーに載っている料理の美味しさの総和を $ X $ 以上にすることが可能な最小の時刻 $ t $ を $ 1 $ 行に出力せよ。不可能な場合は`-1`を出力せよ。末尾に改行を忘れないこと。

## 说明/提示

### 部分点

この問題には部分点が設定されている。

- $ T_i\ <\ T_j $ のとき、$ A_i≧A_j $ を満たすようなデータセットに正解した場合 $ 10 $ 点が与えられる。
- 追加制約のないデータセットに正解した場合さらに $ 40 $ 点が得られ合計 $ 50 $ 点が得られる。

### Sample Explanation 1

\- 以下のような料理の取り方をすることで、時刻 $ 2 $ にトレーに載っている料理の美味しさの総和が $ 5 $ 以上にすることが可能です。 - $ 0 $ 秒目の時点でトレーに載っている料理の美味しさの総和は $ 0 $ です。種類 $ 1 $ の料理をトレーに載せます。 - $ 1 $ 秒目の時点でトレーに載っている料理の美味しさの総和は $ 3 $ です。種類 $ 2 $ の料理をトレーに載せます。 - $ 2 $ 秒目の時点でトレーに載っている料理の美味しさの総和は $ 6 $ です。 - このケースは部分点の追加制約を満たします。

### Sample Explanation 2

\- 以下のような料理の取り方をすることで、時刻 $ 3 $ にトレーに載っている料理の美味しさの総和が $ 10 $ 以上にすることが可能です。 - $ 0 $ 秒目の時点でトレーに載っている料理の美味しさの総和は $ 0 $ です。種類 $ 1 $ の料理をトレーに載せます。 - $ 1 $ 秒目の時点でトレーに載っている料理の美味しさの総和は $ 3 $ です。種類 $ 2 $ の料理をトレーに載せます。 - $ 2 $ 秒目の時点でトレーに載っている料理の美味しさの総和は $ 6 $ です。種類 $ 3 $ の料理をトレーに載せます。 - $ 3 $ 秒目の時点でトレーに載っている料理の美味しさの総和は $ 10 $ です。 - このケースは部分点の追加制約を満たしません。

### Sample Explanation 3

\- 以下のような料理の取り方をすることで、時刻 $ 1 $ にトレーに載っている料理の美味しさの総和が $ 5 $ 以上にすることが可能です。 - $ 0 $ 秒目の時点でトレーに載っている料理の美味しさの総和は $ 0 $ です。種類 $ 3 $ の料理をトレーに載せます。 - $ 1 $ 秒目の時点でトレーに載っている料理の美味しさの総和は $ 6 $ です。 - このケースは部分点の追加制約を満たします。

### Sample Explanation 4

\- どのように料理をとっても、トレーに載っている料理の美味しさの総和を $ 101 $ 以上にすることはできません。 - このケースは部分点の追加制約を満たします。

### Sample Explanation 5

\- 時刻 $ 0 $ でどちらの料理をとっても、もう片方の料理が時刻 $ 1 $ でなくなってしまうため、トレーに載っている料理の美味しさを $ 2 $ 以上にすることはできません。 - このケースは部分点の追加制約を満たします。

### Sample Explanation 6

\- 以下のような料理の取り方をすることで、時刻 $ 2 $ にトレーに載っている料理の美味しさの総和が $ 6 $ 以上にすることが可能です。 - $ 0 $ 秒目の時点でトレーに載っている料理の美味しさの総和は $ 0 $ です。種類 $ 2 $ の料理をトレーに載せます。 - $ 1 $ 秒目の時点でトレーに載っている料理の美味しさの総和は $ 4 $ です。種類 $ 4 $ の料理をトレーに載せます。 - $ 2 $ 秒目の時点でトレーに載っている料理の美味しさの総和は $ 6 $ です。 - このケースは部分点の追加制約を満たします。

### Sample Explanation 7

\- 以下のような料理の取り方をすることで、時刻 $ 2 $ にトレーに載っている料理の美味しさの総和が $ 4 $ 以上にすることが可能です。 - $ 0 $ 秒目の時点でトレーに載っている料理の美味しさの総和は $ 0 $ です。種類 $ 2 $ の料理をトレーに載せます。 - $ 1 $ 秒目の時点でトレーに載っている料理の美味しさの総和は $ 2 $ です。種類 $ 3 $ の料理をトレーに載せます。 - $ 2 $ 秒目の時点でトレーに載っている料理の美味しさの総和は $ 4 $ です。 - このケースは部分点の追加制約を満たしません。

## 样例 #1

### 输入

```
4 5

1 2 3 4

3 3 1 1
```

### 输出

```
2
```

## 样例 #2

### 输入

```
3 10

1 2 3

3 3 4
```

### 输出

```
3
```

## 样例 #3

### 输入

```
3 5

9 9 4

2 2 6
```

### 输出

```
1
```

## 样例 #4

### 输入

```
5 101

1 2 3 4 5

20 20 20 20 20
```

### 输出

```
-1
```

## 样例 #5

### 输入

```
2 2

1 1

1 1
```

### 输出

```
-1
```

## 样例 #6

### 输入

```
4 6

1 1 2 2

3 4 1 2
```

### 输出

```
2
```

## 样例 #7

### 输入

```
3 4

1 2 2

1 2 2
```

### 输出

```
2
```



---

---
title: "ディスコ社内ツアー"
layout: "post"
diff: 普及+/提高
pid: AT_discovery_2016_qual_b
tag: []
---

# ディスコ社内ツアー

## 题目描述

[problemUrl]: https://atcoder.jp/contests/discovery2016-qual/tasks/discovery_2016_qual_b

あなたはDISCO presents ディスカバリーチャンネルプログラミングコンテスト 2016本戦のディスコ社内ツアーの案内人です。

社内ツアーにおいて案内する部屋が $ N $ 箇所あり、それぞれの部屋には $ 1 $ から $ N $ の番号が割り振られています。建物の構造は環状となっており、 $ i(1≦i≦N-1) $ 番目の部屋から $ i+1 $ 番目の部屋へと移動可能です。 $ N $ 番目の部屋からは $ 1 $番目の部屋へと移動可能です。これらの道は一方通行であり、逆向きに移動することはできません。

$ i $ 番目の部屋にいるとき、その部屋を見学するか隣の部屋へ移動するかどちらかを選ぶことが可能です。ただし、参加者に何度も同じ部屋を見学させると飽きてしまうため、見学はそれぞれの部屋につき $ 1 $ 度しか行うことはできません。 あなたは社内ツアーを長年行ってきた経験から $ i $番目の部屋を見学したときに得られる面白さはある整数 $ A_i $ で表されることを知っています。

社内ツアーは $ 1 $ 番目の部屋から出発して、全ての部屋を見学し終わった状態で $ 1 $ 番目の部屋にいるように終わらなくてはなりません。 あなたは参加者に社内ツアーを楽しんでもらうため、見学した部屋の面白さを見学した順番に並べたとき、広義単調増加列であるように部屋を案内することにしました。 このような制約のもとで社内ツアーを行うとき、建物内を最低何周する必要があるでしょうか？

ここで、 $ n $ 項からなる数列 $ a $ が $ a_1 $ $ ≦ $ $ a_2 $ $ ≦ $ ... $ ≦ $ $ a_n $ を満たすとき、 $ a $ は広義単調増加列であると呼ばれます。 また、 $ 1 $ 番目の部屋から移動し、全ての部屋を $ 1 $ 度ずつ訪れて $ 1 $ 番目の部屋に戻ってくることを、建物を $ 1 $ 周すると呼びます。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ A_1 $ $ A_2 $ … $ A_N $

- $ 1 $ 行目に案内する部屋の数 $ N\ (2≦N≦10^{5}) $ が与えられる。
- $ 2 $ 行目に各部屋の見学したときの面白さを表す整数 $ A_i\ (1≦A_i≦10^{5}) $ が空白区切りで与えられる。

## 输出格式

与えられた条件を満たすよう社内ツアーを行うのに必要な周回の回数の最低値を $ 1 $ 行に出力せよ。末尾の改行を忘れないこと。

## 说明/提示

### 部分点

この問題には部分点が設定されている。

- $ 2≦N≦100 $ を満たすデータセットに正解した場合 $ 20 $ 点が与えられる。
- $ 1≦A_i≦N $かつ$ i≠j $において$ A_i≠A_j $が成立するようなデータセットに正解した場合上記の部分点とは別に $ 10 $ 点が与えられる。
- 追加制約のないデータセットに正解した場合さらに $ 70 $ 点が得られる。

### Sample Explanation 1

\- 下記のような順序で見学を行うことにより、 $ 3 $ 周で社内ツアーを終えることが可能です。 $ 1 $ 番目の部屋から出発し、すぐに $ 1 $ 番目の部屋を見学することは許されています。ツアーは全ての部屋を見学し終えた状態で $ 1 $ 番の部屋にいる状態で終わらなくてはならないことに注意してください。 - $ 1 $ 周目において、 $ 1 $ 番目の部屋と $ 4 $ 番目の部屋を見学する。 - $ 2 $ 周目において、 $ 3 $ 番目の部屋を見学する。 - $ 3 $ 周目において、 $ 2 $ 番目の部屋と $ 5 $ 番目の部屋を見学する。 - このケースは上記の部分点の $ 1 $ つ目の条件と $ 2 $ つ目の条件を満たします。

### Sample Explanation 2

\- $ 1 $ 周目において、全ての部屋を見学することが可能です。 - このケースは上記の部分点の $ 1 $ つ目の条件と $ 2 $ つ目の条件を満たします。

### Sample Explanation 3

\- 最後に $ 1 $ 番目の部屋を見学した直後にツアーを終了することで $ 1 $ 周でツアーを終了することが可能です。 - このケースは上記の部分点の $ 1 $ つ目の条件と $ 2 $ つ目の条件を満たします。

### Sample Explanation 4

\- 部屋の面白さは重複しているものもあることに注意してください。 - このケースは上記の部分点の $ 1 $ つ目の条件を満たしますが $ 2 $ つ目の条件は満たしません。

## 样例 #1

### 输入

```
5

1 4 3 2 5
```

### 输出

```
3
```

## 样例 #2

### 输入

```
5

1 2 3 4 5
```

### 输出

```
1
```

## 样例 #3

### 输入

```
5

5 1 2 3 4
```

### 输出

```
1
```

## 样例 #4

### 输入

```
8

1 1 1 2 2 2 3 3
```

### 输出

```
1
```



---

---
title: "Squirrel Merchant"
layout: "post"
diff: 普及+/提高
pid: AT_diverta2019_2_d
tag: []
---

# Squirrel Merchant

## 题目描述

松鼠直大君有 $N$ 个橡子。一天，为了获得更多的橡子，他决定去几家贵金属交易所做几笔交易。

他计划这么做：

1. 拿着 $N$ 个橡子离开巢穴；
2. 到交易所 $A$ 做几笔交易；
3. 到交易所 $B$ 做几笔交易；
4. 再到交易所 $A$ 做几笔交易；
5. 回巢穴。

在交易所 $X$ $(X\ =\ A,\ B)$，他可以以任意顺序完成任意整数笔（可能为零）如下的交易：

- 花费 $g_{X}$ 个橡子买来 $1$ 克金；
- 花费 $1$ 克金买来 $g_{X}$ 个橡子；
- 花费 $s_{X}$ 个橡子买来 $1$ 克银；
- 花费 $1$ 克银买来 $s_{X}$ 个橡子；
- 花费 $b_{X}$ 个橡子买来 $1$ 克铜；
- 花费 $1$ 克铜买来 $b_{X}$ 个橡子。

当然，他不能在橡子不够时购买金、银或铜；也不能在金、银或铜不够时购买橡子。

请求出他最多能带多少橡子回巢穴。注意，金、银或铜即使被带回巢穴也是无意义的，因为他只是一只松鼠。

## 输入格式

从标准输入中按以下格式读入：
   
```
$N$
$g_A$ $s_A$ $b_A$
$g_B$ $s_B$ $b_B$
```

## 输出格式

一行一个整数，代表直大君能带回巢穴的最大橡子数。

## 样例 #1

### 样例输入 #1

```
23
1 1 1
2 1 1
```

### 样例输出 #1

```
46
```

## 说明/提示

- $1\ \leq\ N\ \leq\ 5000$
- $1\ \leq\ g_{X}\ \leq\ 5000$
- $1\ \leq\ s_{X}\ \leq\ 5000$
- $1\ \leq\ b_{X}\ \leq\ 5000$
- 所有输入的值都是整数。

### 样例 #1 解释

他可以拿 $46$ 个橡子回巢穴：

- 在交易所 $A$，用 $23$ 个橡子买 $23$ 克金。{ 橡子，金，银，铜 }={ $0,23,0,0$ }
- 在交易所 $B$，用 $23$ 克金买 $46$ 个橡子。{ 橡子，金，银，铜 }={ $46,0,0,0$ }
- 在交易所 $A$，不做任何交易。{ 橡子，金，银，铜 }={ $46,0,0,0$ }

他不能得到 $47$ 个或更多橡子，因此答案是 $46$。

## 样例 #1

### 输入

```
23

1 1 1

2 1 1
```

### 输出

```
46
```



---

---
title: "行列のできるドーナツ屋"
layout: "post"
diff: 普及+/提高
pid: AT_donuts_2015_3
tag: []
---

# 行列のできるドーナツ屋

## 题目描述

在甜甜圈小镇里，有一家每天都排长队的超人气甜甜圈店。现在有 $N$ 个人在这家甜甜圈店排队。排队的人担心在排到自己之前甜甜圈就会卖完。于是甜甜圈店的店长决定计算表示每个人不安程度的「不安度」。

设第 $i$ 个人的身高为 $H_i$，第 $i$ 个人的「不安度」即为「第 $i$ 个人向前看时看到的人数」。第 $i$ 个人向前看时看到第 $j$ 个人需要满足以下条件。

- 第 $j$ 个人需要排在第 $i$ 个人的前面，也即 $j<i$。
- 第 $i$ 个人与第 $j$ 个人之间没有人比第 $j$ 个人更高，也即不存在 $k$ 同时满足 $j<k<i$ 和 $H_j<H_k$。

例如，如果排队的人从前往后的身高分别为 $2,5,3,4,1$，那么排在最后的人向前看时可以看到排在第 $2$ 和第 $4$ 的两人，因此第 $5$ 个人的「不安度」就为 $2$。

## 输入格式

第一行一个正整数 $N$，表示排队的人数。

第二行 $N$ 个正整数，第 $i$ 个数 $H_i$ 表示第 $i$ 个人的身高。

## 输出格式

共 $N$ 行，第 $i$ 行包含一个整数，表示第 $i$ 个人的「不安度」。

末尾额外输出一个空行。

## 说明/提示

对于 $10\%$ 的测试数据，满足 $N\leqslant100$；

对于 $40\%$ 的测试数据，满足 $N\leqslant5000$；

对于 $100\%$ 的测试数据，满足 $1\leqslant N\leqslant10^5$ 且 $1\leqslant H_i\leqslant10^6$。

## 样例 #1

### 输入

```
5

2 5 3 4 1
```

### 输出

```
0

1

1

2

2
```

## 样例 #2

### 输入

```
1

1000000
```

### 输出

```
0
```

## 样例 #3

### 输入

```
8

66 52 56 32 27 50 72 23
```

### 输出

```
0

1

2

2

3

4

3

1
```



---

---
title: "お菓子やさん"
layout: "post"
diff: 普及+/提高
pid: AT_donuts_live2014_5
tag: []
---

# お菓子やさん

## 题目描述

[problemUrl]: https://atcoder.jp/contests/donuts-live2014/tasks/donuts_live2014_5

幼少のパンチくんは、全部で $ N $ 店あるお菓子やさんを巡ろうとしています。

このうちのいくつかの店では、スタンプをカードに押してもらえます。その店のスタンプがあると、さらに別のいくつかの店で、ボーナスのお菓子がもらえるというシステムです。

ただし、パンチくんは一度行った店には $ 2 $ 回行きたくありません。そのため、例えば

- 店 $ A $ のスタンプがあると、店 $ B $ でお菓子が $ 3 $ 個もらえる
- 店 $ B $ のスタンプがあると、店 $ A $ でお菓子が $ 2 $ 個もらえる

という $ 2 $ つの条件が重なっている場合 、どちらかのお菓子を諦めなければいけません。この場合、後者を諦めて、前者の $ 3 $ 個のお菓子をもらうのが得です。

パンチくんがもらえるお菓子の最大値はいくらでしょうか。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ E $ $ a_1 $ $ b_1 $ $ c_1 $ $ a_2 $ $ b_2 $ $ c_2 $ : $ a_E $ $ b_E $ $ c_E $

- $ 1 $ 行目には、お菓子屋さんの数を表す整数 $ N\ (1\ ≦\ N\ ≦\ 16) $ と、お菓子をもらえる店舗関係の数を表す整数 $ E\ (0\ ≦\ E\ ≦\ N×N) $がスペース区切りで与えられる。
- $ 2 $ 行目から $ E $ 行では、お菓子をもらえる店舗関係の情報が与えられる。  
  このうち $ i $ 行目では、 $ 3 $ つの整数 $ a_i\ (1\ ≦\ a_i\ ≦\ N) $, $ b_i\ (1\ ≦\ b_i\ ≦\ N) $, $ c_i\ (1\ ≦\ c_i\ ≦\ 1000) $ が与えられる。  
  これらは、「店 $ a_i $ のスタンプがあると、店 $ b_i $ にて、お菓子が $ c_i $ 個もらえる」ということを表している。
- $ i≠j $ のとき、 $ a_i≠a_j $ または $ b_i≠b_j $ であることが保障されている。

## 输出格式

パンチくんがもらえるお菓子の最大値を、 $ 1 $ 行で出力せよ。出力の末尾には改行をいれること。

## 说明/提示

### 部分点

$ 1\ ≦\ N\ ≦\ 8 $ を満たすテストケースに正解した場合、部分点として $ 130 $ 点が与えられる。

### Sample Explanation 1

問題文に記載されている例です。

### Sample Explanation 2

全てのお菓子をもらうことが出来ます。

### Sample Explanation 3

$ 10 $ 個のお菓子を諦めることで、最大値を得ます。

### Sample Explanation 4

同じ店に $ 2 $ 回行くことはできないので、お菓子はもらえません。また、このスタンプサービスと関係ない店がいくつかあることもあります。

## 样例 #1

### 输入

```
2 2

1 2 3

2 1 2
```

### 输出

```
3
```

## 样例 #2

### 输入

```
4 3

1 2 10

1 3 20

1 4 30
```

### 输出

```
60
```

## 样例 #3

### 输入

```
3 3

1 2 20

2 3 30

3 1 10
```

### 输出

```
50
```

## 样例 #4

### 输入

```
16 1

4 4 1000
```

### 输出

```
0
```

## 样例 #5

### 输入

```
4 6

4 1 3

1 3 3

4 2 3

3 4 2

2 3 3

2 2 10
```

### 输出

```
12
```



---

---
title: "Coins"
layout: "post"
diff: 普及+/提高
pid: AT_dp_i
tag: []
---

# Coins

## 题目描述

设 $N$ 是一个正的奇数。

有 $N$ 枚硬币，每枚硬币上标有编号 $1, 2, \ldots, N$。对于每个 $i$ ($1 \leq i \leq N$)，掷硬币 $i$ 时，正面朝上的概率是 $p _ i$，反面朝上的概率是 $1 - p _ i$。

太郎君把这 $N$ 枚硬币全部投掷了一次。请计算正面朝上的硬币数多于反面朝上的硬币数的概率。

## 输入格式

输入以以下形式从标准输入中给出：

> $N$ $p _ 1$ $p _ 2$ $\ldots$ $p _ N$

## 输出格式

输出正面朝上的硬币数多于反面朝上的硬币数的概率。绝对误差不超过 $10 ^ {-9}$ 的结果将被视为正确。

### 约束条件

- $N$ 是奇数。
- $1 \leq N \leq 2999$
- $p _ i$ 是实数，精确到小数点后两位。
- $0 < p _ i < 1$

### 样例解释 1

计算正面朝上的硬币数多于反面朝上的硬币数的每种情况的概率如下：

- 当（硬币 $1$，硬币 $2$，硬币 $3$）$=$（正, 正, 正）时，概率是 $0.3 \times 0.6 \times 0.8 = 0.144$。
- 当（硬币 $1$，硬币 $2$，硬币 $3$）$=$（反, 正, 正）时，概率是 $0.7 \times 0.6 \times 0.8 = 0.336$。
- 当（硬币 $1$，硬币 $2$，硬币 $3$）$=$（正, 反, 正）时，概率是 $0.3 \times 0.4 \times 0.8 = 0.096$。
- 当（硬币 $1$，硬币 $2$，硬币 $3$）$=$（正, 正, 反）时，概率是 $0.3 \times 0.6 \times 0.2 = 0.036$。

因此，正面朝上的硬币数多于反面朝上的硬币数的概率是 $0.144 + 0.336 + 0.096 + 0.036 = 0.612$。

### 样例解释 2

例如，输出 `0.500`、`0.500000001` 或 `0.499999999` 等答案都将被视为正确。

---

Translated by User 735713.

## 样例 #1

### 输入

```
3

0.30 0.60 0.80
```

### 输出

```
0.612
```

## 样例 #2

### 输入

```
1

0.50
```

### 输出

```
0.5
```

## 样例 #3

### 输入

```
5

0.42 0.01 0.42 0.99 0.42
```

### 输出

```
0.3821815872
```



---

---
title: "Candies"
layout: "post"
diff: 普及+/提高
pid: AT_dp_m
tag: []
---

# Candies

## 题目描述

[problemUrl]: https://atcoder.jp/contests/dp/tasks/dp_m

$ N $ 人の子供たちがいます。 子供たちには $ 1,\ 2,\ \ldots,\ N $ と番号が振られています。

子供たちは $ K $ 個の飴を分け合うことにしました。 このとき、各 $ i $ ($ 1\ \leq\ i\ \leq\ N $) について、子供 $ i $ が受け取る飴の個数は $ 0 $ 以上 $ a_i $ 以下でなければなりません。 また、飴が余ってはいけません。

子供たちが飴を分け合う方法は何通りでしょうか？ $ 10^9\ +\ 7 $ で割った余りを求めてください。 ただし、$ 2 $ 通りの方法が異なるとは、ある子供が存在し、その子供が受け取る飴の個数が異なることを言います。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ K $ $ a_1 $ $ a_2 $ $ \ldots $ $ a_N $

## 输出格式

子供たちが飴を分け合う方法は何通りか？ $ 10^9\ +\ 7 $ で割った余りを出力せよ。

## 说明/提示

### 制約

- 入力はすべて整数である。
- $ 1\ \leq\ N\ \leq\ 100 $
- $ 0\ \leq\ K\ \leq\ 10^5 $
- $ 0\ \leq\ a_i\ \leq\ K $

### Sample Explanation 1

子供たちが飴を分け合う方法は、次の $ 5 $ 通りです。 各数列において、$ i $ 番目の要素は子供 $ i $ が受け取る飴の個数を表します。 - $ (0,\ 1,\ 3) $ - $ (0,\ 2,\ 2) $ - $ (1,\ 0,\ 3) $ - $ (1,\ 1,\ 2) $ - $ (1,\ 2,\ 1) $

### Sample Explanation 2

子供たちが飴を分け合う方法が存在しない場合もあります。

### Sample Explanation 3

子供たちが飴を分け合う方法は、次の $ 1 $ 通りです。 - $ (0,\ 0) $

### Sample Explanation 4

答えを $ 10^9\ +\ 7 $ で割った余りを出力することを忘れずに。

## 样例 #1

### 输入

```
3 4

1 2 3
```

### 输出

```
5
```

## 样例 #2

### 输入

```
1 10

9
```

### 输出

```
0
```

## 样例 #3

### 输入

```
2 0

0 0
```

### 输出

```
1
```

## 样例 #4

### 输入

```
4 100000

100000 100000 100000 100000
```

### 输出

```
665683269
```



---

---
title: "Flowers"
layout: "post"
diff: 普及+/提高
pid: AT_dp_q
tag: []
---

# Flowers

## 题目描述

[problemUrl]: https://atcoder.jp/contests/dp/tasks/dp_q

$ N $ 本の花が横一列に並んでいます。 各 $ i $ ($ 1\ \leq\ i\ \leq\ N $) について、左から $ i $ 番目の花の高さは $ h_i $ で、美しさは $ a_i $ です。 ただし、$ h_1,\ h_2,\ \ldots,\ h_N $ はすべて相異なります。

太郎君は何本かの花を抜き去ることで、次の条件が成り立つようにしようとしています。

- 残りの花を左から順に見ると、高さが単調増加になっている。

残りの花の美しさの総和の最大値を求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ h_1 $ $ h_2 $ $ \ldots $ $ h_N $ $ a_1 $ $ a_2 $ $ \ldots $ $ a_N $

## 输出格式

残りの花の美しさの総和の最大値を出力せよ。

## 说明/提示

### 制約

- 入力はすべて整数である。
- $ 1\ \leq\ N\ \leq\ 2\ ×\ 10^5 $
- $ 1\ \leq\ h_i\ \leq\ N $
- $ h_1,\ h_2,\ \ldots,\ h_N $ はすべて相異なる。
- $ 1\ \leq\ a_i\ \leq\ 10^9 $

### Sample Explanation 1

左から $ 2,\ 4 $ 番目の花を残せばよいです。 すると、高さは左から順に $ 1,\ 2 $ となり、単調増加になっています。 また、美しさの総和は $ 20\ +\ 40\ =\ 60 $ となります。

### Sample Explanation 2

最初から条件が成り立っています。

### Sample Explanation 3

答えは 32-bit 整数型に収まらない場合があります。

### Sample Explanation 4

左から $ 2,\ 3,\ 6,\ 8,\ 9 $ 番目の花を残せばよいです。

## 样例 #1

### 输入

```
4

3 1 4 2

10 20 30 40
```

### 输出

```
60
```

## 样例 #2

### 输入

```
1

1

10
```

### 输出

```
10
```

## 样例 #3

### 输入

```
5

1 2 3 4 5

1000000000 1000000000 1000000000 1000000000 1000000000
```

### 输出

```
5000000000
```

## 样例 #4

### 输入

```
9

4 2 5 8 3 6 1 7 9

6 8 8 4 6 3 5 7 5
```

### 输出

```
31
```



---

---
title: "Walk"
layout: "post"
diff: 普及+/提高
pid: AT_dp_r
tag: []
---

# Walk

## 题目描述

[problemUrl]: https://atcoder.jp/contests/dp/tasks/dp_r

$ N $ 頂点の単純有向グラフ $ G $ があります。 頂点には $ 1,\ 2,\ \ldots,\ N $ と番号が振られています。

各 $ i,\ j $ ($ 1\ \leq\ i,\ j\ \leq\ N $) について、頂点 $ i $ から $ j $ への有向辺の有無が整数 $ a_{i,\ j} $ によって与えられます。 $ a_{i,\ j}\ =\ 1 $ ならば頂点 $ i $ から $ j $ への有向辺が存在し、$ a_{i,\ j}\ =\ 0 $ ならば存在しません。

$ G $ の長さ $ K $ の有向パスは何通りでしょうか？ $ 10^9\ +\ 7 $ で割った余りを求めてください。 ただし、同じ辺を複数回通るような有向パスも数えるものとします。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ K $ $ a_{1,\ 1} $ $ \ldots $ $ a_{1,\ N} $ $ : $ $ a_{N,\ 1} $ $ \ldots $ $ a_{N,\ N} $

## 输出格式

$ G $ の長さ $ K $ の有向パスは何通りか？ $ 10^9\ +\ 7 $ で割った余りを出力せよ。

## 说明/提示

### 制約

- 入力はすべて整数である。
- $ 1\ \leq\ N\ \leq\ 50 $
- $ 1\ \leq\ K\ \leq\ 10^{18} $
- $ a_{i,\ j} $ は $ 0 $ または $ 1 $ である。
- $ a_{i,\ i}\ =\ 0 $

### Sample Explanation 1

$ G $ は次図です。 ![](https://img.atcoder.jp/dp/paths\_0\_muffet.png) 長さ $ 2 $ の有向パスは、次の $ 6 $ 通りです。 - $ 1 $ → $ 2 $ → $ 3 $ - $ 1 $ → $ 2 $ → $ 4 $ - $ 2 $ → $ 3 $ → $ 4 $ - $ 2 $ → $ 4 $ → $ 1 $ - $ 3 $ → $ 4 $ → $ 1 $ - $ 4 $ → $ 1 $ → $ 2 $

### Sample Explanation 2

$ G $ は次図です。 ![](https://img.atcoder.jp/dp/paths\_1\_muffet.png) 長さ $ 3 $ の有向パスは、次の $ 3 $ 通りです。 - $ 1 $ → $ 2 $ → $ 1 $ → $ 2 $ - $ 2 $ → $ 1 $ → $ 2 $ → $ 1 $ - $ 2 $ → $ 1 $ → $ 2 $ → $ 3 $

### Sample Explanation 3

$ G $ は次図です。 ![](https://img.atcoder.jp/dp/paths\_2\_muffet.png) 長さ $ 2 $ の有向パスは、次の $ 1 $ 通りです。 - $ 4 $ → $ 5 $ → $ 6 $

### Sample Explanation 5

答えを $ 10^9\ +\ 7 $ で割った余りを出力することを忘れずに。

## 样例 #1

### 输入

```
4 2

0 1 0 0

0 0 1 1

0 0 0 1

1 0 0 0
```

### 输出

```
6
```

## 样例 #2

### 输入

```
3 3

0 1 0

1 0 1

0 0 0
```

### 输出

```
3
```

## 样例 #3

### 输入

```
6 2

0 0 0 0 0 0

0 0 1 0 0 0

0 0 0 0 0 0

0 0 0 0 1 0

0 0 0 0 0 1

0 0 0 0 0 0
```

### 输出

```
1
```

## 样例 #4

### 输入

```
1 1

0
```

### 输出

```
0
```

## 样例 #5

### 输入

```
10 1000000000000000000

0 0 1 1 0 0 0 1 1 0

0 0 0 0 0 1 1 1 0 0

0 1 0 0 0 1 0 1 0 1

1 1 1 0 1 1 0 1 1 0

0 1 1 1 0 1 0 1 1 1

0 0 0 1 0 0 1 0 1 0

0 0 0 1 1 0 0 1 0 1

1 0 0 0 1 0 1 0 0 0

0 0 0 0 0 1 0 0 0 0

1 0 1 1 1 0 1 1 1 0
```

### 输出

```
957538352
```



---

---
title: "Sum AND Subarrays"
layout: "post"
diff: 普及+/提高
pid: AT_dwacon5th_prelims_b
tag: []
---

# Sum AND Subarrays

## 题目描述

[problemUrl]: https://atcoder.jp/contests/dwacon5th-prelims/tasks/dwacon5th_prelims_b

ある日、ドワンゴ社員のニワンゴくんは、長さ $ N $ の整数列 $ (a_1,\ ...,\ a_N) $ を見つけました。ニワンゴくんは、数列 $ a $ の性質に興味を持っています。

数列 $ a $ の空でない連続する部分列 $ a_l,\ ...,\ a_r $ $ (1\ \leq\ l\ \leq\ r\ \leq\ N) $ の **美しさ** は、 $ a_l\ +\ ...\ +\ a_r $ と定義されます。ニワンゴくんは、ありうる $ N(N+1)/2 $ 個の空でない連続する部分列のうち、 $ K $ 個を選んで取ってきて、それらの美しさのビット毎の論理積 (AND) を計算したとき、その最大値がどうなるかを知りたがっています (取ってくる部分列の間で重複する要素があっても構いません)。

彼の代わりに最大値を求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ K $ $ a_1 $ $ a_2 $ $ ... $ $ a_N $

## 输出格式

答えを出力せよ。

## 说明/提示

### 制約

- $ 2\ \leq\ N\ \leq\ 1000 $
- $ 1\ \leq\ a_i\ \leq\ 10^9 $
- $ 1\ \leq\ K\ \leq\ N(N+1)/2 $
- 入力として与えられる数値はすべて整数である

### Sample Explanation 1

異なる空でない連続する部分列は $ 10 $ 個存在します。全列挙すると、 - 1 番目から始まるもの: $ \{2\},\ \{2,\ 5\},\ \{2,\ 5,\ 2\},\ \{2,\ 5,\ 2,\ 5\} $ - 2 番目から始まるもの: $ \{5\},\ \{5,\ 2\},\ \{5,\ 2,\ 5\} $ - 3 番目から始まるもの: $ \{2\},\ \{2,\ 5\} $ - 4 番目から始まるもの: $ \{5\} $ です (数列の要素が同じでも、異なる添字から始まる列は異なるものとみなすことに注意してください)。 このうち異なる $ 2 $ 個の部分列の美しさのビット毎の論理積 (AND) として得られる値の最大値は $ 12 $ です。 これは $ \{5,\ 2,\ 5\} $ (美しさ $ 12 $) と $ \{2,\ 5,\ 2,\ 5\} $ (美しさ $ 14 $) を選んだ時に達成できます。

## 样例 #1

### 输入

```
4 2

2 5 2 5
```

### 输出

```
12
```

## 样例 #2

### 输入

```
8 4

9 1 8 2 7 5 6 4
```

### 输出

```
32
```



---

---
title: "k-DMC"
layout: "post"
diff: 普及+/提高
pid: AT_dwacon5th_prelims_c
tag: []
---

# k-DMC

## 题目描述

[problemUrl]: https://atcoder.jp/contests/dwacon5th-prelims/tasks/dwacon5th_prelims_c

ドワンゴのコンテンツ配信基盤システム Dwango Media Cluster は、略して DMC と呼ばれています。  
 この名前をかっこ良いと感じたニワンゴくんは、文字列の DMC らしさを数値として定義することにしました。  
 具体的には、長さ $ N $ のある文字列 $ S $ と3以上の整数 $ k $ が与えられた時、以下を満たす整数の3つ組 $ (a,b,c) $ の個数を $ S $ の $ k $-DMC 数と呼ぶことにします。

- $ 0\ \leq\ a $
- $ S[a] $ = `D`
- $ S[b] $ = `M`
- $ S[c] $ = `C`
- $ c-a $

ここで、$ S[a] $ は $ S $ の $ a $ 番目の文字を表します。先頭の文字は $ 0 $ 文字目として扱います (つまり、$ 0\ \leq\ a\ \leq\ N\ -\ 1 $ です)。

ある文字列 $ S $ と $ Q $ 個の整数 $ k_0,\ k_1,\ ...,\ k_{Q-1} $ に対して、$ k_i $-DMC 数をそれぞれ計算してください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ S $ $ Q $ $ k_{0} $ $ k_{1} $ $ ... $ $ k_{Q-1} $

## 输出格式

$ Q $ 行出力せよ。  
 $ i $ 行目 $ (0\ \leq\ i\ \leq\ Q-1) $ には、文字列 $ S $ の $ k_i $-DMC 数を出力せよ。

## 说明/提示

### 制約

- $ 3\ \leq\ N\ \leq\ 10^6 $
- $ S $ は`A` - `Z` からなる文字列
- $ 1\ \leq\ Q\ \leq\ 75 $
- $ 3\ \leq\ k_i\ \leq\ N $
- 入力として与えられる数値はすべて整数である

### Sample Explanation 1

$ (a,b,c)\ =\ (0,\ 6,\ 11) $ が条件を満たします。 Dwango Media Cluster は、ニワンゴくんの定義では意外と DMC らしくないようです。

### Sample Explanation 2

$ 6\times\ 5\times\ 7 $ 個の組み合わせがありえます。

### Sample Explanation 3

$ c-a\ 以外の条件は\ (a,\ b,\ c)\ =\ (0,\ 23,\ 36),\ (8,\ 23,\ 36) $ が満たします。 ちなみに、DWANGO は「Dial-up Wide Area Network Gaming Operation」の頭文字です。

## 样例 #1

### 输入

```
18

DWANGOMEDIACLUSTER

1

18
```

### 输出

```
1
```

## 样例 #2

### 输入

```
18

DDDDDDMMMMMCCCCCCC

1

18
```

### 输出

```
210
```

## 样例 #3

### 输入

```
54

DIALUPWIDEAREANETWORKGAMINGOPERATIONCORPORATIONLIMITED

3

20 30 40
```

### 输出

```
0

1

2
```

## 样例 #4

### 输入

```
30

DMCDMCDMCDMCDMCDMCDMCDMCDMCDMC

4

5 10 15 20
```

### 输出

```
10

52

110

140
```



---

---
title: "Snuke the Wizard"
layout: "post"
diff: 普及+/提高
pid: AT_exawizards2019_c
tag: []
---

# Snuke the Wizard

## 题目描述

[problemUrl]: https://atcoder.jp/contests/exawizards2019/tasks/exawizards2019_c

左から右に向かって $ 1 $ から $ N $ の番号がついた $ N $ 個のマスがあります。 各マスには文字が書かれており、マス $ i $ には文字 $ s_i $ が書かれています。また、各マスにははじめ $ 1 $ 体のゴーレムがいます。

すぬけ君は $ Q $ 回呪文を唱え、ゴーレムたちを移動させました。

$ i $ 番目の呪文は文字 $ t_i $ と $ d_i $ からなり、$ d_i $ は `L` か `R` のいずれかです。 すぬけ君がこの呪文を唱えると、$ t_i $ が書かれた全てのマスについて、そのマスにいる全てのゴーレムが隣接するマスに移動します。移動する方向は $ d_i $ が `L` ならば左、`R` ならば右です。

ただし、マス $ 1 $ から左に移動しようとしたゴーレムと、マス $ N $ から右に移動しようとしたゴーレムは消滅します。

$ Q $ 回の呪文詠唱後に消滅していないゴーレムの総数を求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ Q $ $ s $ $ t_1 $ $ d_1 $ $ \vdots $ $ t_{Q} $ $ d_Q $

## 输出格式

答えを出力せよ。

## 说明/提示

### 制約

- $ 1\ \leq\ N,Q\ \leq\ 2\ \times\ 10^{5} $
- $ |s|\ =\ N $
- $ s_i,t_i $ は英大文字
- $ d_i $ は `L` または `R`

### Sample Explanation 1

\- はじめ、各マスに $ 1 $ 体のゴーレムがいます。 - $ 1 $ 番目の呪文では、マス $ 1 $ にいるゴーレムが左に移動しようとし、消滅します。 - $ 2 $ 番目の呪文では、マス $ 2 $ にいるゴーレムが左に移動します。 - $ 3 $ 番目の呪文では、移動するゴーレムはいません。 - $ 4 $ 番目の呪文では、マス $ 1 $ にいるゴーレムが右に移動します。 - $ 4 $ 回の呪文詠唱後、マス $ 2 $ に $ 1 $ 体、マス $ 3 $ に $ 1 $ 体のゴーレムがいるため、消滅していないゴーレムは $ 2 $ 体です。

### Sample Explanation 2

\- $ 3 $ 回の呪文詠唱後、マス $ 2 $ に $ 1 $ 体、マス $ 4 $ に $ 2 $ 体、マス $ 6 $ に $ 2 $ 体のゴーレムがいるため、消滅していないゴーレムは $ 5 $ 体です。 - $ 1 $ つの呪文で複数のゴーレムが移動しうることに注意してください。

## 样例 #1

### 输入

```
3 4

ABC

A L

B L

B R

A R
```

### 输出

```
2
```

## 样例 #2

### 输入

```
8 3

AABCBDBA

A L

B R

A R
```

### 输出

```
5
```

## 样例 #3

### 输入

```
10 15

SNCZWRCEWB

B R

R R

E R

W R

Z L

S R

Q L

W L

B R

C L

A L

N L

E R

Z L

S L
```

### 输出

```
3
```



---

---
title: "Squares"
layout: "post"
diff: 普及+/提高
pid: AT_hhkb2020_d
tag: []
---

# Squares

## 题目描述

平面直角坐标系上有一个边长为 $n$ 的白色正方形，它的四个顶点的坐标分别为 $(0,0)$，$(0,n)$，$(n,0)$，$(n,n)$。

我们准备在该白色正方形内部（含边界）放置两个边与坐标轴平行、且顶点均为整点的正方形。其中，蓝色正方形的边长为 $a$，红色正方形的边长为 $b$。

请求出放置后两个正方形没有重叠部分的方案数对 $10^9+7$ 取模之后的结果。**边界可以重合。**

## 输入格式

**本题中，单个测试点有多组数据。**

每个测试点的输入第一行为数据组数 $t$。

接下来是 $t$ 组数据，每组数据一行，依次输入 $n,a,b$。

## 输出格式

每组数据输出一行一个整数，表示方案总数对 $10^9+7$ 取模之后的结果。

## 说明/提示

#### 样例 #1 说明

以第一组数据为例。

边长为 $3$ 的正方形内，有 $9$ 种方法放边长为 $1$ 的正方形，有 $4$ 种方法放边长为 $2$ 的正方形。

无论怎么放红色正方形，蓝色正方形都会有 $4$ 种与红色正方形重叠的放法。

从而，方案数就为 $9 \times 4 - 4 \times 4 =20$。

#### 数据规模与约定

$1 \le t \le 10^5$，$1 \le n \le 10^9$，$1 \le a,b \le n$，输入的数值均为整数。

## 样例 #1

### 输入

```
3

3 1 2

4 2 2

331895368 154715807 13941326
```

### 输出

```
20

32

409369707
```



---

---
title: "Lamps"
layout: "post"
diff: 普及+/提高
pid: AT_hhkb2020_e
tag: []
---

# Lamps

## 题目描述

[problemUrl]: https://atcoder.jp/contests/hhkb2020/tasks/hhkb2020_e

縦 $ H $ 行、横 $ W $ 列からなるマス目があり、それぞれのマスは散らかっているか散らかっていないかのどちらかです。

今からあなたはこのマス目のうち $ 0 $ 個以上の散らかっていないマスに照明を置きます。

照明は置かれたマスの上下左右の $ 4 $ 方向に、マス目の端もしくは最初に散らかっているマスにぶつかる直前まで照らします (散らかっているマスは照らされません)。照明は、置かれたマス自身も照らします。

整数 $ H,\ W $ と $ H $ 個の長さ $ W $ の文字列 $ S_i $ が与えられます。 $ S_i $ の $ j $ 文字目が `.` のとき、上から $ i $ 行目、左から $ j $ 列目のマスは散らかっていません。$ S_i $ の $ j $ 文字目が `#` のとき、上から $ i $ 行目、左から $ j $ 列目のマスは散らかっています。

散らかっていないマスの個数を $ K $ 個だとすると、照明の置き方は全部で $ 2^K $ 通りあります。 この $ 2^K $ 通りそれぞれについて、$ 1 $ 個以上の照明によって照らされるマスの個数を計算したときの総和を $ 1,000,000,007 $ で割ったあまりを求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ H $ $ W $ $ S_1 $ $ : $ $ S_H $

## 输出格式

$ 2^K $ 通りそれぞれについて、$ 1 $ 個以上の照明によって照らされるマスの個数を計算したときの総和を $ 1,000,000,007 $ で割ったあまりを出力せよ。

## 说明/提示

### 制約

- $ 1\ \leq\ H\ \leq\ 2000 $
- $ 1\ \leq\ W\ \leq\ 2000 $
- $ S_i $ は `.` と `#` のみからなる長さ $ W $ の文字列

### Sample Explanation 1

全部で照明の置き方は $ 16 $ 通りあります。 - このうち $ 9 $ 通り (左から $ 1 $ 番目か $ 2 $ 番目の少なくとも一方に照明が置かれている、かつ左から $ 4 $ 番目か $ 5 $ 番目の少なくとも一方に照明が置かれている) では、$ 4 $ マスが照らされます。 - このうち $ 3 $ 通り (左から $ 1 $ 番目か $ 2 $ 番目の少なくとも一方に照明が置かれている、かつ左から $ 4 $ 番目と $ 5 $ 番目のどちらにも照明が置かれていない) では、$ 2 $ マスが照らされます。 - このうち $ 3 $ 通り (左から $ 4 $ 番目か $ 5 $ 番目の少なくとも一方に照明が置かれている、かつ左から $ 1 $ 番目と $ 2 $ 番目のどちらにも照明が置かれていない) では、$ 2 $ マスが照らされます。 - このうち $ 1 $ 通り (照明が $ 1 $ つも置かれていない) では、$ 0 $ マスが照らされます。 求める総和は $ 4\ \times\ 9\ +\ 2\ \times\ 3\ +\ 2\ \times\ 3\ +\ 0\ \times\ 1\ =\ 48 $ となります。

## 样例 #1

### 输入

```
1 5

..#..
```

### 输出

```
48
```

## 样例 #2

### 输入

```
2 3

..#

#..
```

### 输出

```
52
```



---

---
title: "Dictionary"
layout: "post"
diff: 普及+/提高
pid: AT_icpc2012autumn_a
tag: []
---

# Dictionary

## 题目描述

[problemUrl]: https://atcoder.jp/contests/jag2012autumn/tasks/icpc2012autumn_a





---

---
title: "説明会"
layout: "post"
diff: 普及+/提高
pid: AT_indeednow_2015_quala_3
tag: []
---

# 説明会

## 题目描述

[problemUrl]: https://atcoder.jp/contests/indeednow-quala/tasks/indeednow_2015_quala_3

ある企業は、説明会に参加する学生の選抜コンテストを行いました。 説明会を行おうとしている会場の最大収容可能人数が決まっているため、コンテスト担当者はボーダーラインを何点にするかを悩んでいます。

選抜方法を説明します。

- ボーダーラインが $ x $ 点のとき、正の点数を取っている学生のうち $ x $ 点以上の得点を得た学生を全て選抜する。
- つまり、$ 0 $ 点の学生は会場の最大収容可能人数に関わらず選抜しない。

あなたには、選抜コンテストにおける $ N $ 人の学生の点数が与えられます。 また、会場の候補が $ Q $ 個あります。そして、会場の最大収容可能人数はそれぞれ $ k_1,k_2,…,k_Q $ です。 ある企業は、説明会をこれらの会場の候補のうちいずれかで開催しようとしています。

あなたの仕事は、それぞれの会場候補で説明会を行う場合について、最小のボーダーラインを出力しなければなりません。 具体的には、$ i\ (1≦i≦Q) $ 番目の会場候補で説明会を行うと仮定したとき、上記の方法に基づいて選抜した学生の数が $ k_i $ 人以下となるようなボーダーラインのうち $ 0 $ 以上かつ最小のものを出力してください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ s_1 $ $ s_2 $ : $ s_N $ $ Q $ $ k_1 $ $ k_2 $ : $ k_Q $

- $ 1 $ 行目には、学生の数 $ N\ (1≦N≦100,000) $ が与えられる。
- $ 2 $ 行目から $ N $ 行には、選抜コンテストにおける各学生の得点情報が与えられる。そのうち $ i\ (1≦i≦N) $ 行目には、$ i $ 番目の学生の得点 $ s_i\ (0≦s_i≦1,000,000) $ が与えられる。
- $ 2+N $ 行目には、会場候補の数 $ Q\ (1≦Q≦100,000) $ が与えられる。
- $ 3+N $ 行目から $ Q $ 行には、各会場候補の最大収容可能人数が与えられる。そのうち $ i\ (1≦i≦Q) $ 行目には、$ i $ 番目の会場の最大収容可能人数 $ k_i\ (0≦k_i≦N) $ が与えられる。

## 输出格式

$ 1 $ 行目から $ Q $ 行には、各会場候補で説明会を行う場合のボーダーラインを出力せよ。そのうち $ i\ (1≦i≦Q) $ 行目には、$ i $ 番目の会場で説明会を行う場合のボーダーラインを出力せよ。

## 说明/提示

### Sample Explanation 1

とんでもないケースですが、$ 1 $ 番目の会場の最大収容可能人数は $ 0 $ なので、誰も通過させたくありません。それを達成するボーダーラインで最小のものは $ 11 $ 点です。 $ 2 $ 番目の会場の最大収容可能人数は $ 4 $ 人なので、選抜する人数がそれ以下になるようなボーダーラインを設定しなければなりません。 もしボーダーラインを $ 6 $ 点に設定した場合、$ 6 $ 人通過してしまい会場の最大収容可能人数をオーバーしてしまいます。$ 7 $ 点に設定した場合は $ 3 $ 人のみ通過し、会場に収容可能でき、これが最小のボーダーラインです。 $ 3 $ 番目の会場の最大収容可能人数は $ 12 $ 人ですが、ボーダーラインは $ 0 $ 点にします。なぜならば、選抜方法より $ 0 $ 点の学生は通過できないので、正の点数を取った $ 12 $ 人のみが通過するからです。

### Sample Explanation 3

全員が $ 0 $ 点のケースもありえます。 この場合は、どんなボーダーラインに設定しても誰も通過しないので、会場の最大収容可能人数に関わらずボーダーラインは $ 0 $ 点にします。

## 样例 #1

### 输入

```
15

0

0

0

1

1

2

3

4

5

6

6

6

8

9

10

3

0

4

12
```

### 输出

```
11

7

0
```

## 样例 #2

### 输入

```
9

3

3

3

2

2

2

1

1

1

1

4
```

### 输出

```
3
```

## 样例 #3

### 输入

```
4

0

0

0

0

1

0
```

### 输出

```
0
```



---

---
title: "パズル"
layout: "post"
diff: 普及+/提高
pid: AT_indeednow_2015_quala_4
tag: []
---

# パズル

## 题目描述

[problemUrl]: https://atcoder.jp/contests/indeednow-quala/tasks/indeednow_2015_quala_4

あなたには、以下のような縦 $ H $マス、横 $ W $ マスのスライドパズルの盤面が与えられます(図1)。

![](https://cdn.luogu.com.cn/upload/vjudge_pic/AT_indeednow_2015_quala_4/27c449b69b0c35720b6d1bee41096f7623a661f9.png)  
図1. スライドパズル盤面

   
各マスには、相異なる $ 1 $ から $ H×W-1 $ までの番号が割り振られており、さらにある $ 1 $ つのマスは空きマスとなっています。

このスライドパズルでは、空白マスを左右上下のマスのいずれかと入れ替える操作が許されています。 ただし、入れ替えたい方向にマスが存在しない場合は入れ替えることができません。

この盤面に入れ替え操作を任意の回数行い、完成の状態にしたいと思っています。 ここで、完成の状態とは、左上のマスから順番に番号付けされており右下が空白マスであるような状態にしたいと思っています(図2)。

![](https://cdn.luogu.com.cn/upload/vjudge_pic/AT_indeednow_2015_quala_4/0618fe48636154c76d651eb5484bdec3557384e5.png)  
図2. 完成盤面

   
つまり、完成盤面とは、

- 番号 $ i\ (1≦i≦H×W-1) $ のマスは $ (1+[(i-1)÷W],1+(i-1)%W) $ にある
- さらに、空きマスが $ (H,W) $ にある

という状態を指します。$ [a÷b] $ は $ a $ を $ b $ で割った値の小数点以下を切り捨てたもの、$ a%b $ は $ a $ を $ b $ で割った余りを指します。

最小操作数が $ 24 $ 回以内ということが保障されているとき、パズルを解くのに必要な最小操作数を出力しなさい。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ H $ $ W $ $ c_{1,1} $ $ c_{1,2} $ … $ c_{1,W} $ $ c_{2,1} $ $ c_{2,2} $ … $ c_{2,W} $ : $ c_{H,1} $ $ c_{H,2} $ … $ c_{H,W} $

- $ 1 $ 行目には、パズルの盤面の縦方向の長さを表す整数 $ H\ (2≦H≦6) $ と横方向の長さを表す整数 $ W\ (2≦W≦6) $ がスペース区切りで与えられる。
- $ 2 $ 行目から $ H $ 行には、パズルの盤面の情報が与えられる。そのうち $ i\ (1≦i≦H) $ 行目には、スライドパズルの座標 $ (i,1),(i,2),...,(i,W) $ のマスに書かれている数字を表す整数 $ c_{i,1},c_{i,2},...,c_{i,W} $ がスペース区切りで与えられる。ただし、$ c_{i,j}=0 $のときは特別に、そのマスが空マスであることを表す。
- パズルの盤面には、$ 1 $ から $ H×W-1 $ までの整数が1つと、空マスを表す整数 $ 0 $ がちょうど $ 1 $ つずつ現れることが保障されている。
- パズルを解く最小操作数が $ 24 $ 回以内ということが保障されている。

## 输出格式

$ 1 $ 行目に、パズルを解く最小操作数を出力せよ。末尾の改行を忘れないこと。

## 说明/提示

### Sample Explanation 1

最初、空きマスは $ (1,2) $ にあります。この空きマスを「右→下→下」と動かすことで完成の状態にすることができ、そのとき最小操作回数を達成します。

### Sample Explanation 4

パズルが元から完成している場合もあります。

### Sample Explanation 5

出力する答えが最大となるケースです。

## 样例 #1

### 输入

```
3 3

1 0 2

4 5 3

7 8 6
```

### 输出

```
3
```

## 样例 #2

### 输入

```
3 5

6 1 2 8 5

7 0 4 3 10

11 12 13 9 14
```

### 输出

```
12
```

## 样例 #3

### 输入

```
2 2

1 2

3 0
```

### 输出

```
0
```

## 样例 #4

### 输入

```
4 4

1 2 3 4

5 6 7 8

9 10 11 12

13 14 15 0
```

### 输出

```
0
```

## 样例 #5

### 输入

```
6 6

1 2 3 4 5 6

14 15 10 16 11 12

8 9 19 17 0 18

7 13 20 22 23 24

25 26 21 28 29 30

31 32 27 33 34 35
```

### 输出

```
24
```



---

---
title: "Tree Separator"
layout: "post"
diff: 普及+/提高
pid: AT_jag2017autumn_e
tag: []
---

# Tree Separator

## 题目描述

给定一棵无根树 $T$ 与一个整数 $K$，你需要找到两个不同的节点 $u,v$，使得将在 $u,v$ 简单路径上的点及其所连接的边全部删去后剩余的连通块中大小至少为 $K$ 的连通块数量最多。

## 输入格式

第一行两个正整数 $N,K(2 \le N \le 10^5, 1 \le K \le N)$。

接下来 $N-1$ 行，每行两个正整数 $u_i,v_i(1\le u_i,v_i \le n, u_i \ne v_i)$，表示树上的一条边 $(u_i,v_i)$。

## 输出格式

输出剩余的连通块中大小至少为 $K$ 的连通块数量的最大值。



---

---
title: "チーズ (Cheese)"
layout: "post"
diff: 普及+/提高
pid: AT_joi2011yo_e
tag: []
---

# チーズ (Cheese)

## 题目描述

[problemUrl]: https://atcoder.jp/contests/joi2011yo/tasks/joi2011yo_e

今年も JOI 町のチーズ工場がチーズの生産を始め，ねずみが巣から顔を出した．JOI 町は東西南北に区画整理されていて，各区画は巣，チーズ工場，障害物，空き地のいずれかである．ねずみは巣から出発して全てのチーズ工場を訪れチーズを $ 1 $ 個ずつ食べる．

この町には，$ N $ 個のチーズ工場があり，どの工場も $ １ $ 種類のチーズだけを生産している．チーズの硬さは工場によって異なっており，硬さ $ 1 $ から $ N $ までのチーズを生産するチーズ工場がちょうど $ 1 $ つずつある．

ねずみの最初の体力は $ 1 $ であり，チーズを $ 1 $ 個食べるごとに体力が $ 1 $ 増える．ただし，ねずみは自分の体力よりも硬いチーズを食べることはできない．

ねずみは，東西南北に隣り合う区画に $ 1 $ 分で移動することができるが，障害物の区画には入ることができない．チーズ工場をチーズを食べずに通り過ぎることもできる．すべてのチーズを食べ終えるまでにかかる最短時間を求めるプログラムを書け．ただし，ねずみがチーズを食べるのにかかる時間は無視できる．

- - - - - -

## 输入格式

入力は $ H+1 $ 行ある．$ 1 $ 行目には $ 3 $ つの整数 $ H，W，N $ ($ 1\ \leqq\ H\ \leqq\ 1000 $，$ 1\ \leqq\ W\ \leqq\ 1000 $，$ 1\ \leqq\ N\ \leqq\ 9 $) がこの順に空白で区切られて書かれている．$ 2 $ 行目から $ H\ +\ 1 $ 行目までの各行には，`S`，`1`，`2`，$ \ldots $，`9`，`X`，`.` からなる $ W $ 文字の文字列が書かれており，各々が各区画の状態を表している．北から $ i $ 番目，西から $ j $ 番目の区画を $ (i,\ j) $ と記述することにすると ($ 1\ \leqq\ i\ \leqq\ H $，$ 1\ \leqq\ j\ \leqq\ W $)，第 $ i\ +\ 1 $ 行目の $ j $ 番目の文字は，区画 $ (i,\ j) $ が巣である場合は `S` となり，障害物である場合は `X` となり，空き地である場合は `.` となり，硬さ $ 1 $，$ 2 $，$ \ldots $，$ 9 $ のチーズを生産する工場である場合はそれぞれ `1`，`2`，$ \ldots $，`9` となる．入力には巣と硬さ $ 1 $，$ 2 $，$ \ldots $，$ N $ のチーズを生産する工場がそれぞれ $ 1 $ つずつある．他のマスは障害物または空き地であることが保証されている．ねずみは全てのチーズを食べられることが保証されている．

## 输出格式

すべてのチーズを食べ終えるまでにかかる最短時間（分）を表す整数を $ 1 $ 行で出力せよ．

- - - - - -

## 说明/提示

### Sample Explanation 1

\- - - - - -

### Sample Explanation 2

\- - - - - -

## 样例 #1

### 输入

```
3 3 1
S..
...
..1
```

### 输出

```
4
```

## 样例 #2

### 输入

```
4 5 2
.X..1
....X
.XX.S
.2.X.
```

### 输出

```
12
```

## 样例 #3

### 输入

```
10 10 9
.X...X.S.X
6..5X..X1X
...XXXX..X
X..9X...X.
8.X2X..X3X
...XX.X4..
XX....7X..
X..X..XX..
X...X.XX..
..X.......
```

### 输出

```
91
```



---

---
title: "ケーキの切り分け２ (Cake 2)"
layout: "post"
diff: 普及+/提高
pid: AT_joi2015ho_b
tag: []
---

# ケーキの切り分け２ (Cake 2)

## 题目描述

# 「JOI 2014/2015 决赛」分蛋糕 2

**译自 [JOI 2014/2015 决赛](https://www.ioi-jp.org/joi/2014/2015-ho/index.html) T2「[ケーキの切り分け２](https://www.ioi-jp.org/joi/2014/2015-ho/2015-ho.pdf)」**

JOI 君和 IOI 酱是双胞胎兄妹。 JOI 君最近闲暇时常常会做甜点。今天 JOI 君也烤了蛋糕吃，IOI 酱立马嗅到了蛋糕的香气于是跑来想分着吃。  
蛋糕是圆形的，从蛋糕中某点开始将蛋糕放射状切为 $ N $ 块，按逆时针顺序编号为 $ 1 $ 到 $ N $ 。也就是说，对任意 $ i $ 来说 $ (1 \leq i \leq N) $ ，第 $ i $ 块蛋糕紧挨着第 $ i-1 $ 块与第 $ i+1 $ 块（不过第 $ 0 $ 块相当于第 $ N $ 块，第 $ N+1 $ 块相当于第 $ 1 $ 块）。第 $ i $ 块蛋糕的大小为 $ A_i $ 。由于切蛋糕的人刀功很不好，所以 $ A_i $ 互不相同。

![](https://www.z4a.net/images/2018/08/04/5c83a03e0789dafd806d5f7e488b001d.png)

JOI 君和 IOI 酱按照以下的方法分这 $N$ 块蛋糕：
1. 首先 JOI 君从这 $ N $ 块蛋糕中任选一块取走；
2. 然后，从 IOI 酱开始， IOI 酱和 JOI 君交替地从剩下的蛋糕中选出一块取走。不过，当且仅当一块蛋糕两旁的蛋糕至少有一块已经被选择，这块蛋糕才能被选择。如果可供选择的蛋糕有多个， IOI 酱会选择最大的一个，而 JOI 君可以任选一个。

JOI 君想让自己所得到的蛋糕大小的合计值最大。

#### 任务
给出蛋糕的块数 $ N $ 和这 $ N $ 块蛋糕的大小。请编写程序求出 JOI 君得到的蛋糕大小的总和的最大值。

## 输入格式

第一行为整数 $ N $ ，表示蛋糕被切成了 $ N $ 块；  
接下来 $ N $ 行中的第 $ i $ 行 $ (1 \leq i \leq N) $ 为一个整数 $ A_i $ 。表示第 $ i $ 块蛋糕的大小。

## 输出格式

输出一行： JOI 君得到的蛋糕大小的总和的最大值。
## 样例
#### 输入样例 1
```plain
5
2
8
1
10
9
```
#### 输出样例 1
```plain
18
```

## 说明/提示

JOI 君依次进行以下操作时为最优解：

1.  JOI 君选择第 $ 2 $ 块蛋糕，这块蛋糕的大小为 $ 8 $；
2.  IOI 酱选择第 $ 1 $ 块蛋糕，这块蛋糕的大小为 $ 2 $；
3.  JOI 君选择第 $ 5 $ 块蛋糕，这块蛋糕的大小为 $ 9 $；
4.  IOI 酱选择第 $ 4 $ 块蛋糕，这块蛋糕的大小为 $ 10 $；
5.  JOI 君选择第 $ 3 $ 块蛋糕，这块蛋糕的大小为 $ 1 $；

最后 JOI 君得到的蛋糕的大小的总和为 $ 8+9+1=18 $。

#### 输入样例 2
```plain
8
1
10
4
5
6
2
9
3
```
#### 输出样例 2
```plain
26
```
#### 输入样例 3
```plain
15
182243672
10074562
977552215
122668426
685444213
3784162
463324752
560071245
134465220
21447865
654556327
183481051
20041805
405079805
564327789
```
#### 输出样例 3
```plain
3600242976
```
对于 $ 15\% $ 的分值：
- $ N \leq 20 $

对于另 $45\%$ 的分值：
- $ N \leq 300 $

对于 $100\%$ 的分值，所有输入数据满足以下条件：
- $ 1 \leq N \leq 2000 $；
- $ 1 \leq A_i \leq 10^9 $；
- 每个 $ A_i $ 都不同。

感谢@ミク 提供的翻译

## 样例 #1

### 输入

```
5
2
8
1
10
9
```

### 输出

```
18
```

## 样例 #2

### 输入

```
8
1
10
4
5
6
2
9
3
```

### 输出

```
26
```

## 样例 #3

### 输入

```
15
182243672
10074562
977552215
122668426
685444213
3784162
463324752
560071245
134465220
21447865
654556327
183481051
20041805
405079805
564327789
```

### 输出

```
3600242976
```



---

---
title: "JOI 公園 (JOI Park)"
layout: "post"
diff: 普及+/提高
pid: AT_joi2015ho_c
tag: []
---

# JOI 公園 (JOI Park)

## 题目描述

# 「JOI 2014/2015 决赛」JOI 公园

**译自 [JOI 2014/2015 决赛](https://www.ioi-jp.org/joi/2014/2015-ho/index.html) T3「[JOI 公園](https://www.ioi-jp.org/joi/2014/2015-ho/2015-ho.pdf)」**

时值 $ 20\text{XX} $ 年， IOI 国为了给办奥赛做准备，将要修缮 IOI 国中的 JOI 公园。 JOI 公园里有 $ N $ 个广场，这些广场从 $ 1 $ 到 $ N $ 编号。有 $ M $ 条道路连接各个广场，这些道路从 $ 1 $ 到 $ M $ 编号。第 $ i(1 \leq i \leq M) $ 条道路是一条连接第 $ A_i $ 和第 $ B_i $ 个广场的双向边，长度为 $ D_i $ 。任意两个广场间一定有道路（直接或间接）相连。

修缮计划如下：首先，选择一个**自然数**  $ X $ ，将和第一个广场距离等于 $ X $ 或在 $ X $ 以下的所有广场（含第一个广场）相互之间连结一条地下通道。广场 $ i $ 和广场 $ j $ 的距离指，从广场 $ i $ 到广场 $ j $ 经过的道路长度总和的最小值。定义 $ C $ 为一个与修筑地下通道花费有关的量（ $ C $ 是整数）。修筑所有地下通道的花费为 $ C\times X $ 。

接下来，撤去已经通过地下通道连接的广场之间的道路。撤去道路的花费不计。

最后，将没有被撤去的道路进行修补，长为 $ d $ 的道路修补的花费为 $ d $ 。

修缮计划实施之前， JOI 公园没有地下通道。请求出 JOI 公园修缮花费总和的最小值。

#### 任务
给出 JOI 公园的广场间道路的情况和 $ C $ 的值，请编写程序求出修缮 JOI 公园的花费总和的最小值。

## 输入格式

输入标准如下：
- 第一行为三个以空格分开的整数 $ N,M,C $ ，分别表示广场共有 $ N $ 个，道路有 $ M $ 条，而 $ C $ 为与修筑地下通道花费有关的量；
- 接下来 $ M $ 行中的第 $ i $ 行 $ (1 \leq i \leq M) $ 为三个以空格分开的整数 $ A_i,B_i,D_i $ 。表示第 $ i $ 条道路连接广场 $ A_i $ 和广场 $ B_i $ ，其长度为 $ D_i $ 。

## 输出格式

输出一行一个整数：修缮 JOI 公园的花费总和的最小值。

## 样例
#### 输入样例 1
```plain
5 5 2
2 3 1
3 1 2
2 4 3
1 2 4
2 5 5
```
#### 输出样例 1
```plain
14
```

## 说明/提示

对于输入样例 $1$， $ X=3 $ 也就是说，和广场 $ 1 $ 的距离在 $ 3 $ 或以下的广场（广场 $ 1 $ ，广场 $ 2 $ ，广场 $ 3 $ ）互相之间连接一条地下通道。修缮总花费为 $ 2\times 3+3+5=14 $ 。这就是最小值。
#### 输入样例 2
```plain
5 4 10
1 2 3
2 3 4
3 4 3
4 5 5
```
#### 输出样例 2
```plain
15
```
对于输入样例 $ 2 $ ，$ X=0 $ 时修缮总花费最小。
#### 输入样例 3
```plain
6 5 2
1 2 2
1 3 4
1 4 3
1 5 1
1 6 5
```
#### 输出样例 3
```plain
10
```
对于输入样例 $3$，$ X=5 $ 时所有广场相互间都会连接一条地下通道，此时修缮的花费最小。

对于 $ 15\% $ 的分值：
- $ N \leq 100 $
- $ M \leq 200 $
- $ C \leq 100 $
- $ D_i \leq 10 (1 \leq i \leq M) $

对于另 $ 45\% $ 的分值：
- $ N \leq 100 $
- $ M \leq 4000 $

对于 $ 100\% $ 的分值，所以输入数据满足以下条件：
- $ 2 \leq N \leq 10^5 $
- $ 1 \leq M \leq 2\times 10^5 $
- $ 1 \leq C \leq 10^5 $
- $ 1 \leq A_i,B_i \leq N (1 \leq i \leq M) $
- $ A_i\not = B_i (1 \leq i \leq M) $
- $ (A_i,B_i)\not =(A_j,B_j) $ 而且 $ (A_i,B_i)\not =(B_j,A_j) (1 \leq i\lt j \leq M) $
- $ 1 \leq D_i \leq 10^5 (1 \leq i \leq M) $
- 输入数据保证任意两个广场之间一定有道路连接（直接或间接）。

感谢@ミク 提供的翻译

## 样例 #1

### 输入

```
5 5 2
2 3 1
3 1 2
2 4 3
1 2 4
2 5 5
```

### 输出

```
14
```

## 样例 #2

### 输入

```
5 4 10
1 2 3
2 3 4
3 4 3
4 5 5
```

### 输出

```
15
```

## 样例 #3

### 输入

```
6 5 2
1 2 2
1 3 4
1 4 3
1 5 1
1 6 5
```

### 输出

```
10
```



---

---
title: "展覧会 (Exhibition)"
layout: "post"
diff: 普及+/提高
pid: AT_joi2019ho_b
tag: []
---

# 展覧会 (Exhibition)

## 题目描述

[problemUrl]: https://atcoder.jp/contests/joi2019ho/tasks/joi2019ho_b

あなたは，絵の展覧会を開催しようとしている．展覧会では，いくつかの絵を額縁に入れ，左から右に一列に並べて展示する．

展覧会で展示する候補となる絵が $ N $ 枚あり，$ 1 $ から $ N $ までの番号が付けられている．絵 $ i $ ($ 1\ \leqq\ i\ \leqq\ N $) の大きさは $ S_i $，価値は $ V_i $ である．

また，これらの絵を入れるための額縁が $ M $ 枚あり，$ 1 $ から $ M $ までの番号が付けられている．額縁 $ j $ ($ 1\ \leqq\ j\ \leqq\ M $) の大きさは $ C_j $ である．額縁 $ j $ には，大きさが $ C_j $ 以下の絵のみを入れることができる．$ 1 $ 枚の額縁には高々 $ 1 $ 枚の絵しか入れることができない．

展示する絵はすべて何らかの額縁に入っていなければならない．見栄えを良くするため，展示する絵は以下の条件を満たさなければならない：

- 左右に隣り合うどの $ 2 $ 枚の絵についても，右側の絵が入っている額縁の大きさは左側の絵が入っている額縁の大きさ以上である．
- 左右に隣り合うどの $ 2 $ 枚の絵についても，右側の絵の価値は左側の絵の価値以上である．

あなたは，できるだけ多くの絵を展示したい．

展示候補の絵の枚数，額縁の枚数，及びそれらの大きさや価値が与えられたとき，展示する絵の枚数の最大値を求めるプログラムを作成せよ．

- - - - - -

## 输入格式

入力は以下の形式で標準入力から与えられる．

> $ N $ $ M $ $ S_1 $ $ V_1 $ $ \vdots $ $ S_N $ $ V_N $ $ C_1 $ $ \vdots $ $ C_M $

## 输出格式

標準出力に，展覧会に展示する絵の枚数の最大値を $ 1 $ 行で出力せよ．

- - - - - -

## 说明/提示

### 制約

- $ 1\ \leqq\ N\ \leqq\ 100\,000 $．
- $ 1\ \leqq\ M\ \leqq\ 100\,000 $．
- $ 1\ \leqq\ S_i\ \leqq\ 1\,000\,000\,000 $ ($ 1\ \leqq\ i\ \leqq\ N $)．
- $ 1\ \leqq\ V_i\ \leqq\ 1\,000\,000\,000 $ ($ 1\ \leqq\ i\ \leqq\ N $)．
- $ 1\ \leqq\ C_j\ \leqq\ 1\,000\,000\,000 $ ($ 1\ \leqq\ j\ \leqq\ M $)．

### 小課題

1. ($ 10 $ 点) $ N\ \leqq\ 10 $，$ M\ \leqq\ 10 $．
2. ($ 40 $ 点) $ N\ \leqq\ 1\,000 $，$ M\ \leqq\ 1\,000 $．
3. ($ 50 $ 点) 追加の制約はない．

- - - - - -

### Sample Explanation 1

この入出力例では，左から順に (絵 $ 2 $, 額縁 $ 2 $)，(絵 $ 1 $, 額縁 $ 3 $) と並べることで，$ 2 $ 枚の絵を展示することができる．$ 3 $ 枚以上の絵を展示することはできないので，$ 2 $ を出力する．ここで，(絵 $ i $, 額縁 $ j $) は，額縁 $ j $ に入った絵 $ i $ を表す． - - - - - -

### Sample Explanation 2

\- - - - - -

### Sample Explanation 3

\- - - - - -

## 样例 #1

### 输入

```
3 4
10 20
5 1
3 5
4
6
10
4
```

### 输出

```
2
```

## 样例 #2

### 输入

```
3 2
1 2
1 2
1 2
1
1
```

### 输出

```
2
```

## 样例 #3

### 输入

```
4 2
28 1
8 8
6 10
16 9
4
3
```

### 输出

```
0
```

## 样例 #4

### 输入

```
8 8
508917604 35617051
501958939 840246141
485338402 32896484
957730250 357542366
904165504 137209882
684085683 775621730
552953629 20004459
125090903 607302990
433255278
979756183
28423637
856448848
276518245
314201319
666094038
149542543
```

### 输出

```
3
```



---

---
title: "たのしい家庭菜園"
layout: "post"
diff: 普及+/提高
pid: AT_joisc2014_b
tag: []
---

# たのしい家庭菜園

## 题目描述

[problemUrl]: https://atcoder.jp/contests/joisc2014/tasks/joisc2014_b





---

---
title: "Cell Inversion"
layout: "post"
diff: 普及+/提高
pid: AT_jsc2019_qual_c
tag: []
---

# Cell Inversion

## 题目描述

[problemUrl]: https://atcoder.jp/contests/jsc2019-qual/tasks/jsc2019_qual_c

$ 2N $ 個のマスが左右一列に並んでおり、各マスの色を表す長さ $ 2N $ の文字列 $ S $ が与えられます。

左から $ i $ 番目のマスの色は、$ S $ の $ i $ 文字目が `B` のとき黒色で、`W` のとき白色です。

あなたは異なる $ 2 $ マスを選んで、それらのマスおよびそれらの間にあるマスの色を反転する操作をちょうど $ N $ 回行います。 ここで、マスの色を反転するとは、そのマスの色が黒色なら白色に、白色なら黒色にすることです。

ただし、操作を通して同じマスを $ 2 $ 回以上選ぶことはできません。 つまり、各マスがちょうど $ 1 $ 回ずつ選ばれることになります。

$ N $ 回の操作終了後に全てのマスを白色にする方法が何通りあるかを $ 10^9+7 $ で割った余りを求めてください。

ここで、条件を満たす $ 2 $ つの方法が異なるとは、$ 1 $ つ目の方法で $ i $ 番目に選んだ $ 2 $ つのマスの組と $ 2 $ つ目の方法で $ i $ 番目に選んだ $ 2 $ つのマスの組が異なるような $ i $ $ (1\ \leq\ i\ \leq\ N) $ が存在することをいいます。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ S $

## 输出格式

$ N $ 回の操作終了後に全てのマスを白色にする方法の個数を $ 10^9+7 $ で割った余りを出力せよ。そのような方法が存在しない場合、代わりに $ 0 $ を出力せよ。

## 说明/提示

### 制約

- $ 1\ \leq\ N\ \leq\ 10^5 $
- $ |S|\ =\ 2N $
- $ S $ の各文字は `B` または `W` である。

### Sample Explanation 1

全てのマスを白色にする方法は次の $ 4 $ 通りあります。 - 最初の操作では $ 1,\ 3 $ 番目のマスを選び、次の操作では $ 2,\ 4 $ 番目のマスを選びます。 - 最初の操作では $ 2,\ 4 $ 番目のマスを選び、次の操作では $ 1,\ 3 $ 番目のマスを選びます。 - 最初の操作では $ 1,\ 4 $ 番目のマスを選び、次の操作では $ 2,\ 3 $ 番目のマスを選びます。 - 最初の操作では $ 2,\ 3 $ 番目のマスを選び、次の操作では $ 1,\ 4 $ 番目のマスを選びます。

## 样例 #1

### 输入

```
2

BWWB
```

### 输出

```
4
```

## 样例 #2

### 输入

```
4

BWBBWWWB
```

### 输出

```
288
```

## 样例 #3

### 输入

```
5

WWWWWWWWWW
```

### 输出

```
0
```



---

---
title: "Double Landscape"
layout: "post"
diff: 普及+/提高
pid: AT_keyence2019_d
tag: []
---

# Double Landscape

## 题目描述

[problemUrl]: https://atcoder.jp/contests/keyence2019/tasks/keyence2019_d

$ N $ 行 $ M $ 列のグリッドに，$ 1 $ から $ N\ \times\ M $ までの整数を重複のないように $ 1 $ つずつ書き込むことを考えます． ここで，普通に書き込むのでは面白くないと思った高橋君は，以下の条件を満たすように数を書き込むことにしました．

- $ i $ 行目に書き込まれている値のうち，最大の値は $ A_i $ $ (1\ \leq\ i\ \leq\ N) $
- $ j $ 列目に書き込まれている値のうち，最大の値は $ B_j $ $ (1\ \leq\ j\ \leq\ M) $

高橋君のために，この条件を満たすような書き込み方の個数を $ 10^9\ +\ 7 $ で割ったあまりを求めてください．

## 输入格式

入力は以下の形式で標準入力から与えられる．

> $ N $ $ M $ $ A_1 $ $ A_2 $ $ ... $ $ A_{N} $ $ B_1 $ $ B_2 $ $ ... $ $ B_{M} $

## 输出格式

条件を満たすような書き込み方の個数を $ 10^9\ +\ 7 $ で割ったあまりを出力せよ．

## 说明/提示

### 制約

- $ 1\ \leq\ N\ \leq\ 1000 $
- $ 1\ \leq\ M\ \leq\ 1000 $
- $ 1\ \leq\ A_i\ \leq\ N\ \times\ M $
- $ 1\ \leq\ B_j\ \leq\ N\ \times\ M $
- $ A_i,\ B_j $ は整数

### Sample Explanation 1

$ (A_1,\ A_2)\ =\ (4,\ 3) $，$ (B_1,\ B_2)\ =\ (3,\ 4) $ であり，この場合は以下の $ 2 $ 通りの書き込み方があります． - $ 1 $ 行 $ 1 $ 列目に $ 1 $，$ 1 $ 行 $ 2 $ 列目に $ 4 $，$ 2 $ 行 $ 1 $ 列目に $ 3 $，$ 2 $ 行 $ 2 $ 列目に $ 2 $ - $ 1 $ 行 $ 1 $ 列目に $ 2 $，$ 1 $ 行 $ 2 $ 列目に $ 4 $，$ 2 $ 行 $ 1 $ 列目に $ 3 $，$ 2 $ 行 $ 2 $ 列目に $ 1 $

### Sample Explanation 2

どのような書き込み方をしても条件を満たすことができないので，$ 0 $ を出力します．

## 样例 #1

### 输入

```
2 2

4 3

3 4
```

### 输出

```
2
```

## 样例 #2

### 输入

```
3 3

5 9 7

3 6 9
```

### 输出

```
0
```

## 样例 #3

### 输入

```
2 2

4 4

4 4
```

### 输出

```
0
```

## 样例 #4

### 输入

```
14 13

158 167 181 147 178 151 179 182 176 169 180 129 175 168

181 150 178 179 167 180 176 169 182 177 175 159 173
```

### 输出

```
343772227
```



---

---
title: "Swap and Flip"
layout: "post"
diff: 普及+/提高
pid: AT_keyence2020_d
tag: []
---

# Swap and Flip

## 题目描述

[problemUrl]: https://atcoder.jp/contests/keyence2020/tasks/keyence2020_d

$ N $ 枚のカードがあり、$ 1,\ 2,\ ...,\ N $ の番号がついています。 カード $ i $ ($ 1\ \leq\ i\ \leq\ N $) の片方の面には赤い文字で整数 $ A_i $ が、 もう片方の面には青い文字で整数 $ B_i $ が書かれています。 最初、これらのカードは赤い文字が書かれた面を表にして 左から右に番号順に一列に並んでいます。

以下の操作を繰り返すことで、カードの表側の面に書かれた整数の列が左から右に広義単調増加となる （すなわち、各 $ i $ ($ 1\ \leq\ i\ \leq\ N\ -\ 1 $) に対して、左から $ i\ +\ 1 $ 枚目のカードの表側の面に書かれた整数が $ i $ 枚目のカードの表側の面に書かれた整数以上である） ようにすることが可能かどうか判定してください。 さらに、可能である場合、必要な操作の回数の最小値を求めてください。

- 整数 $ i $ ($ 1\ \leq\ i\ \leq\ N\ -\ 1 $) を一つ選ぶ。 左から $ i $ 番目のカードと $ i\ +\ 1 $ 番目のカードの位置を入れ替え、さらにこれら $ 2 $ 枚のカードを裏返す。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ A_1 $ $ A_2 $ $ ... $ $ A_N $ $ B_1 $ $ B_2 $ $ ... $ $ B_N $

## 输出格式

単調増加となるようにすることが不可能である場合、`-1` と出力せよ。 可能である場合、必要な操作の回数の最小値を出力せよ。

## 说明/提示

### 制約

- $ 1\ \leq\ N\ \leq\ 18 $
- $ 1\ \leq\ A_i,\ B_i\ \leq\ 50 $ ($ 1\ \leq\ i\ \leq\ N $)
- 入力値はすべて整数である。

### Sample Explanation 1

$ i\ =\ 1 $ として操作を $ 1 $ 回行うと、 カードの表側の面に書かれた整数の列は $ [2,\ 3,\ 3] $ となり、単調増加となります。

### Sample Explanation 2

何回操作を行っても、 カードの表側の面に書かれた整数の列は $ [2,\ 1] $ のままであり、これは単調増加ではありません。

### Sample Explanation 3

操作を行う必要がない場合もあります。

## 样例 #1

### 输入

```
3

3 4 3

3 2 3
```

### 输出

```
1
```

## 样例 #2

### 输入

```
2

2 1

1 2
```

### 输出

```
-1
```

## 样例 #3

### 输入

```
4

1 2 3 4

5 6 7 8
```

### 输出

```
0
```

## 样例 #4

### 输入

```
5

28 15 22 43 31

20 22 43 33 32
```

### 输出

```
-1
```

## 样例 #5

### 输入

```
5

4 46 6 38 43

33 15 18 27 37
```

### 输出

```
3
```



---

---
title: "Robot on Grid"
layout: "post"
diff: 普及+/提高
pid: AT_keyence2021_c
tag: []
---

# Robot on Grid

## 题目描述

[problemUrl]: https://atcoder.jp/contests/keyence2021/tasks/keyence2021_c

$ H $ 行 $ W $ 列のマス目があります。上から $ i $ 行目、左から $ j $ 列目のマスを $ (i,j) $ と書くことにします。 それぞれのマスには `R`, `D`, `X` のいずれかの文字を書き込むことができます。はじめ、どのマスにも文字は書き込まれていません。

すぬけ君は $ K $ 個のマスを選んで文字を書き込みました。 $ i $ 番目に文字を書き込んだマスは $ (h_i,w_i) $ で、書き込んだ文字は $ c_i $ でした。

残りのマスへの文字の書き込み方は $ 3^{HW-K} $ 通りあります。それぞれの場合について以下の問題の答えを計算し、その総和を $ 998244353 $ で割ったあまりを求めてください。

> 上記のマス目上を移動可能なロボットがあります。 ロボットは $ (i,j) $ にいるとき、$ (i+1,j),(i,j+1) $ のいずれかに移動することができます。 ただし、$ (i,j) $ に `R` と書かれていた場合は $ (i,j+1) $ にのみ、`D` と書かれていた場合は $ (i+1,j) $ にのみ移動することができます。`X` と書かれていた場合はどちらにも移動可能です。
> 
> ロボットを $ (1,1) $ に設置したとき、ロボットがマス目の外に出ずに $ (H,W) $ に到達するようなロボットの移動経路は何通りありますか？ただし、ロボットは $ (H,W) $ に到達した時点で停止するものとします。
> 
> ここで、$ 2 $ つの移動経路が異なるとはロボットが通ったマスの集合が異なることをいいます。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ H $ $ W $ $ K $ $ h_1 $ $ w_1 $ $ c_1 $ $ \vdots $ $ h_K $ $ w_K $ $ c_K $

## 输出格式

答えを出力せよ。

## 说明/提示

### 制約

- $ 2\ \leq\ H,W\ \leq\ 5000 $
- $ 0\ \leq\ K\ \leq\ \min(HW,2\ \times\ 10^5) $
- $ 1\ \leq\ h_i\ \leq\ H $
- $ 1\ \leq\ w_i\ \leq\ W $
- $ i\ \neq\ j $ ならば $ (h_i,w_i)\ \neq\ (h_j,w_j) $
- $ c_i $ は `R`, `D`, `X` のいずれか

### Sample Explanation 1

\- $ (1,2) $ のみまだ文字が書き込まれていません。 - `R` を書いたとき、ロボットが $ (H,W) $ に到達するようなロボットの移動経路は $ 1 $ 通りです。 - `D` を書いたとき、ロボットが $ (H,W) $ に到達するようなロボットの移動経路は $ 2 $ 通りです。 - `X` を書いたとき、ロボットが $ (H,W) $ に到達するようなロボットの移動経路は $ 2 $ 通りです。 - これらの総和である $ 5 $ を出力してください。

### Sample Explanation 3

\- $ 998244353 $ で割ったあまりを求めるのを忘れずに。

## 样例 #1

### 输入

```
2 2 3

1 1 X

2 1 R

2 2 R
```

### 输出

```
5
```

## 样例 #2

### 输入

```
3 3 5

2 3 D

1 3 D

2 1 D

1 2 X

3 1 R
```

### 输出

```
150
```

## 样例 #3

### 输入

```
5000 5000 10

585 1323 R

2633 3788 X

1222 4989 D

1456 4841 X

2115 3191 R

2120 4450 X

4325 2864 X

222 3205 D

2134 2388 X

2262 3565 R
```

### 输出

```
139923295
```



---

---
title: "Two Step Sort"
layout: "post"
diff: 普及+/提高
pid: AT_kupc2021_g
tag: []
---

# Two Step Sort

## 题目描述

有 $N$ 个盒子和 $N$ 个球，编号为 1 到 $N$。最初，第 $i$ 个盒子里装着编号为 $P_i$ 的球。每个盒子只能装一个球，开始时所有盒子都是关闭的，可以打开盒子。

接下来将进行两次球的移动操作，每次操作遵循以下步骤：

1. 选择若干盒子打开，每个盒子都有固定的打开成本。
2. 在打开的盒子之间随意移动球，操作完成时，每个盒子必须有一个球。
3. 将所有打开的盒子再次关闭。

第一次操作时，打开第 $i$ 个盒子的成本为 $A_i$；第二次操作时，打开第 $i$ 个盒子的成本为 $B_i$。经过两次操作后，要求第 $i$ 个盒子里装有第 $i$ 个球。请计算达到目标的最低总成本。

## 输入格式

输入由标准输入给出：  
> $N$ $P_1$ $P_2$ $\ldots$ $P_N$ $A_1$ $A_2$ $\ldots$ $A_N$ $B_1$ $B_2$ $\ldots$ $B_N$

## 输出格式

输出一个整数，表示实现目标的最小总成本。

## 说明/提示

- $1 \leq N \leq 10^5$
- $1 \leq P_i \leq N$
- 当 $i \neq j$ 时，$P_i \neq P_j$
- $1 \leq A_i \leq 10^9$
- $1 \leq B_i \leq 10^9$
- 所有输入均为整数

### 示例解释

在第一个移动事件中，打开盒子 2 和 4，把球 1 放入盒子 2，把球 4 放入盒子 4，这样的操作成本是 8。在第二次移动事件中，打开盒子 1、2、3 和 5，把球 1、2、3 和 5 放入相应的盒子中，操作成本为 20。整个过程的总成本为 28，这是满足条件的最小成本。

有时候，初始状态已经满足要求，意味着不需要进行任何移动。

 **本翻译由 AI 自动生成**

## 样例 #1

### 输入

```
5

2 4 5 1 3

11 5 3 3 8

4 6 7 9 3
```

### 输出

```
28
```

## 样例 #2

### 输入

```
1

1

1000000000

1000000000
```

### 输出

```
0
```



---

---
title: "Three Coloring"
layout: "post"
diff: 普及+/提高
pid: AT_kupc2021_k
tag: []
---

# Three Coloring

## 题目描述

[problemUrl]: https://atcoder.jp/contests/kupc2021/tasks/kupc2021_k

$ N $ 個の壁があります。各壁を赤、緑、青のいずれか $ 1 $ 色で塗ることを考えます。

$ M $ 個の条件が与えられます。$ i $ 番目の条件は、整数 $ a_i,b_i $ と文字 $ x_i,y_i $ が与えられ、

- 壁 $ a_i $ を 色 $ x_i $ で塗ったとき、壁 $ b_i $ を 色 $ y_i $ で塗ってはならない

ことを表しています。ただし、 $ x_i,y_i $ はそれぞれ文字 `R` , `G` , `B` のいずれかであり、 `R` のとき赤を、`G` のとき緑を、 `B` のとき青を表しています。

$ M $ 個全ての条件を満たす色の塗り方が何通りあるかを答えてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ M $ $ a_1 $ $ x_1 $ $ b_1 $ $ y_1 $ $ \vdots $ $ a_M $ $ x_M $ $ b_M $ $ y_M $

## 输出格式

答えを $ 1 $ 行で出力せよ。

## 说明/提示

### 制約

- $ 1\ \leq\ N\ \leq\ 22 $
- $ 0\ \leq\ M\ \leq\ 9\ \times\ \frac{N(N-1)}{2} $
- $ 1\ \leq\ a_i\ <\ b_i\ \leq\ N $
- $ x_i,y_i $ はそれぞれ文字 `R` , `G` , `B` のいずれかである。
- $ i\ \neq\ j $ のとき、$ (a_i,x_i,b_i,y_i)\ \neq\ (a_j,x_j,b_j,y_j) $
- $ N,M,a_i,b_i $ はいずれも整数

### Sample Explanation 1

壁 $ 1 $ を赤色で塗る場合、壁 $ 2 $ は緑色または青色で塗ることができます。 壁 $ 1 $ を緑色で塗る場合、壁 $ 2 $ は緑色または青色で塗ることができます。 壁 $ 1 $ を青色で塗る場合、壁 $ 2 $ は赤色または青色で塗ることができます。 よって、合計で $ 6 $ 通りの塗り方があります。

### Sample Explanation 2

壁 $ 1 $ をどの色で塗っても条件を満たします。

### Sample Explanation 3

オーバーフローに注意してください。

## 样例 #1

### 输入

```
2 3

1 R 2 R

1 G 2 R

1 B 2 G
```

### 输出

```
6
```

## 样例 #2

### 输入

```
1 0
```

### 输出

```
3
```

## 样例 #3

### 输入

```
22 0
```

### 输出

```
31381059609
```

## 样例 #4

### 输入

```
4 12

2 R 3 R

1 B 2 B

2 R 3 B

3 R 4 R

1 B 4 G

1 R 3 B

3 G 4 B

2 G 3 G

1 B 2 R

1 G 2 R

1 R 3 G

1 G 3 B
```

### 输出

```
13
```



---

---
title: "Shortest Path on a Line"
layout: "post"
diff: 普及+/提高
pid: AT_nikkei2019_2_qual_d
tag: []
---

# Shortest Path on a Line

## 题目描述

[problemUrl]: https://atcoder.jp/contests/nikkei2019-2-qual/tasks/nikkei2019_2_qual_d

一直線上に $ N $ 個の点があり、順に $ 1 $ から $ N $ までの番号がついています。

高橋君はこれらの点を頂点として無向グラフを作ることにしました。 はじめはグラフに辺はないですが、$ M $ 回の操作によって辺を追加します。 $ i $ 回目の操作では次のように辺を追加します。

- $ 1 $ 以上 $ N $ 以下の整数 $ L_i $, $ R_i $ 及び正整数 $ C_i $ を用いる。 $ L_i\ ≦\ s\ <\ t\ ≦\ R_i $ なる整数の組 $ (s,t) $ すべてに対し、頂点 $ s $ と頂点 $ t $ の間に長さ $ C_i $ の辺を追加する。

ただし、$ L_1,...,L_M $, $ R_1,...,R_M $, $ C_1,...,C_M $ はすべて入力で与えられます。

高橋君は最終的に得られたグラフ上で最短路問題を解きたいです。得られたグラフ上での頂点 $ 1 $ から頂点 $ N $ までの最短路の長さを求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ M $ $ L_1 $ $ R_1 $ $ C_1 $ $ : $ $ L_M $ $ R_M $ $ C_M $

## 输出格式

頂点 $ 1 $ から頂点 $ N $ までの最短路の長さを出力せよ。 ただし、最短路が存在しない場合は `-1` を出力せよ。

## 说明/提示

### 制約

- $ 2\ ≦\ N\ ≦\ 10^5 $
- $ 1\ ≦\ M\ ≦\ 10^5 $
- $ 1\ ≦\ L_i\ <\ R_i\ ≦\ N $
- $ 1\ ≦\ C_i\ ≦\ 10^9 $

### Sample Explanation 1

頂点 $ 1 $ と頂点 $ 2 $ の間に長さ $ 2 $ の辺があり、頂点 $ 2 $ と頂点 $ 4 $ の間に長さ $ 3 $ の辺があるので、頂点 $ 1 $ と頂点 $ 4 $ の間に長さ $ 5 $ のパスが存在します。

## 样例 #1

### 输入

```
4 3

1 3 2

2 4 3

1 4 6
```

### 输出

```
5
```

## 样例 #2

### 输入

```
4 2

1 2 1

3 4 2
```

### 输出

```
-1
```

## 样例 #3

### 输入

```
10 7

1 5 18

3 4 8

1 3 5

4 7 10

5 9 8

6 10 5

8 10 3
```

### 输出

```
28
```



---

---
title: "Restore the Tree"
layout: "post"
diff: 普及+/提高
pid: AT_nikkei2019_qual_d
tag: []
---

# Restore the Tree

## 题目描述

[problemUrl]: https://atcoder.jp/contests/nikkei2019-qual/tasks/nikkei2019_qual_d

$ N $ 頂点の根付き木 (注記を参照) があり、その頂点には $ 1 $ から $ N $ までの番号が振られています。 根以外の各頂点には、その親から一本の有向辺が伸びています。 なお、根は頂点 $ 1 $ とは限りません。

高橋くんは、このグラフに $ M $ 本の新たな有向辺を書き加えました。 書き足された各辺 $ u\ \rightarrow\ v $ は、ある頂点 $ u $ からその子孫であるような頂点 $ v $ に向かって伸びています。

高橋くんが辺を書き加えたあとの $ N $ 頂点 $ N-1+M $ 辺の有向グラフが与えられます。 より具体的には、$ N-1+M $ 組の整数のペア $ (A_1,\ B_1),\ ...,\ (A_{N-1+M},\ B_{N-1+M}) $ が与えられ、これらは $ i $ 番目の辺が頂点 $ A_i $ から頂点 $ B_i $ に向かって伸びていることを表します。

元の根付き木を復元してください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ M $ $ A_1 $ $ B_1 $ $ : $ $ A_{N-1+M} $ $ B_{N-1+M} $

## 输出格式

$ N $ 行出力せよ。 $ i $ 行目には、頂点 $ i $ が元の木の根であれば `0` を出力し、そうでなければ元の木で頂点 $ i $ の親を表す整数を出力すること。

なお、元の木は一意に定まることが示せる。

## 说明/提示

### 注記

「木」や関連するグラフ理論の用語に関しては、[Wikipediaの記事](https://ja.wikipedia.org/wiki/%E6%9C%A8_(%E6%95%B0%E5%AD%A6))などをご覧ください。

### 制約

- $ 3\ \leq\ N $
- $ 1\ \leq\ M $
- $ N\ +\ M\ \leq\ 10^5 $
- $ 1\ \leq\ A_i,\ B_i\ \leq\ N $
- $ A_i\ \neq\ B_i $
- $ i\ \neq\ j $ ならば $ (A_i,\ B_i)\ \neq\ (A_j,\ B_j) $
- 入力されるグラフは、$ N $ 頂点の根付き木に問題文中の条件を満たす $ M $ 本の辺を書き足すことで得られる。

### Sample Explanation 1

入力されたグラフは次のようなものです。 !\[\](https://img.atcoder.jp/nikkei2019-qual/ee05880ceecf703f656dd50bf22c573f.png) これは、$ 1\ \rightarrow\ 2\ \rightarrow\ 3 $ という根付き木に辺 $ 1\ \rightarrow\ 3 $ を書き足したものであると考えられます。

## 样例 #1

### 输入

```
3 1

1 2

1 3

2 3
```

### 输出

```
0

1

2
```

## 样例 #2

### 输入

```
6 3

2 1

2 3

4 1

4 2

6 1

2 6

4 6

6 5
```

### 输出

```
6

4

2

0

6

2
```



---

---
title: "Broken Skateboard"
layout: "post"
diff: 普及+/提高
pid: AT_s8pc_5_e
tag: []
---

# Broken Skateboard

## 题目描述

编码员 E869120 正在考虑去溜冰场，溜冰场的大小为 $H \times W$ 。左上角单元格为 $(1,1)$ ，右下角单元格为 $(H,W)$ 。  
溜冰场由 $1$ 个球门单元格、一些冰单元格和一些混凝土单元格组成。

溜冰场的特征如下：

- 滑冰者在冰格上移动时方向一致。
- 滑冰者只有在停止时才能改变方向。
- 如果滑冰者滑到了球门单元，他/她就完成了比赛。但是，如果滑冰者来到滑冰场外，则无法完成游戏。

此外，他的滑板坏了，因此移动速度会发生如下变化：

- 移动一个格子需要 $k$ 秒。最初， $k$ 为 $1$ 。
- 如果滑板滑到水泥格上， $k$ 将增加 $1$ 。
- 他只能向 4 个方向移动：上、下、左、右。

他想知道每个起始格完成游戏所需的最短时间。  
请写出代替 E869120 的程序。

## 输入格式

在 $1$ 行中，给出了滑行链路 $H$ $W$ 的大小。  
从 $2$ 行到 $H+1$ 行，给出了滑行链路的状态。每个单元格的状态表示如下：

- `.` 表示该单元是冰单元。
- `#` 表示该单元格为混凝土单元格。
- `G` 表示该单元是目标单元。

## 输出格式

$d_{i,j}$ 表示从 $(i,j)$ 单元格开始计算的最短时间。如果他无法从 $(i,j)$ 单元格到达目标单元格，则 $d_{i,j}$ 的值为 $-1$ 。

## 说明/提示

- $1 \leq H \leq 777$ .
- $1 \leq W \leq 777$ .
- 具体单元的数量不超过 $7 \ 777$ 。
- 目标单元的数量正好是 $1$ 。

## 样例 #1

### 输入

```
6 6

......

.#....

......

......

......

...#.G
```

### 输出

```
-1 -1 -1 9 -1 5

-1 -1 -1 8 -1 4

-1 -1 -1 7 -1 3

-1 -1 -1 6 -1 2

-1 -1 -1 5 -1 1

7 6 5 2 1 0
```

## 样例 #2

### 输入

```
1 8

#####G##
```

### 输出

```
15 10 6 3 1 0 1 3
```

## 样例 #3

### 输入

```
9 9

....#..#.

#........

....#....

.#......#

...###...

##....#.#

....#...#

#....#...

.#.#..#.G
```

### 输出

```
54 37 52 29 38 38 17 53 18

43 36 60 28 37 37 16 65 17

40 35 38 27 26 36 15 39 16

35 22 21 20 19 18 14 16 10

28 27 26 16 16 25 13 36 9

28 17 16 15 14 13 7 9 5

18 17 16 14 8 7 6 5 2

41 22 52 13 15 37 5 51 1

22 14 13 7 6 5 2 1 0
```



---

---
title: "Subsequence"
layout: "post"
diff: 普及+/提高
pid: AT_snuke21_d
tag: []
---

# Subsequence

## 题目描述

[problemUrl]: https://atcoder.jp/contests/snuke21/tasks/snuke21_d





---

---
title: "Medals"
layout: "post"
diff: 普及+/提高
pid: AT_snuke21_g
tag: []
---

# Medals

## 题目描述

[problemUrl]: https://atcoder.jp/contests/snuke21/tasks/snuke21_g





---

---
title: "Ordinary Beauty"
layout: "post"
diff: 普及+/提高
pid: AT_soundhound2018_summer_qual_c
tag: []
---

# Ordinary Beauty

## 题目描述

[problemUrl]: https://atcoder.jp/contests/soundhound2018-summer-qual/tasks/soundhound2018_summer_qual_c

数列 $ (a_1,...\ ,a_n) $ の *美しさ* を、隣り合う $ 2 $ 項の組であって、 差の絶対値が $ d $ であるものの個数として定義します。 例えば、$ d=1 $ であるとき、数列 $ (3,\ 2,\ 3,\ 10,\ 9) $ の美しさは $ 3 $ です。

各要素が $ 1 $ 以上 $ n $ 以下の整数である長さ $ m $ の数列は全部で $ n^m $ 通り存在します。 この $ n^m $ 通りの数列すべてに対して美しさを求めて、 それらの平均を出力してください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ n $ $ m $ $ d $

## 输出格式

各要素が $ 1 $ 以上 $ n $ 以下の整数である長さ $ m $ の数列 の美しさの平均を出力せよ。 絶対誤差または相対誤差が $ 10^{-6} $ 以下ならば正解となる。

## 说明/提示

### 制約

- $ 0\ \leq\ d\ <\ n\ \leq\ 10^9 $
- $ 2\ \leq\ m\ \leq\ 10^9 $
- 入力はすべて整数

### Sample Explanation 1

$ (1,1,1) $ の美しさは $ 0 $ です。 $ (1,1,2) $ の美しさは $ 1 $ です。 $ (1,2,1) $ の美しさは $ 2 $ です。 $ (1,2,2) $ の美しさは $ 1 $ です。 $ (2,1,1) $ の美しさは $ 1 $ です。 $ (2,1,2) $ の美しさは $ 2 $ です。 $ (2,2,1) $ の美しさは $ 1 $ です。 $ (2,2,2) $ の美しさは $ 0 $ です。 これらの平均である、 $ (0+1+2+1+1+2+1+0)/8=1 $ が答えとなります。

## 样例 #1

### 输入

```
2 3 1
```

### 输出

```
1.0000000000
```

## 样例 #2

### 输入

```
1000000000 180707 0
```

### 输出

```
0.0001807060
```



---

---
title: "Saving Snuuk"
layout: "post"
diff: 普及+/提高
pid: AT_soundhound2018_summer_qual_d
tag: []
---

# Saving Snuuk

## 题目描述

[problemUrl]: https://atcoder.jp/contests/soundhound2018-summer-qual/tasks/soundhound2018_summer_qual_d

kenkoooo さんはすぬけ国での旅行の計画を立てています。 すぬけ国には $ n $ 個の都市があり、$ m $ 本の電車が走っています。 都市には $ 1 $ から $ n $ の番号がつけられていて、 $ i $ 番目の電車は都市 $ u_i $ と $ v_i $ の間を両方向に走っています。 どの都市からどの都市へも電車を乗り継ぐことで到達できます。

すぬけ国で使える通貨には、円とスヌークの $ 2 $ 種類があります。 どの電車の運賃も円とスヌークのどちらの通貨でも支払え、 $ i $ 番目の電車の運賃は、 円で支払う場合 $ a_i $ 円、 スヌークで払う場合 $ b_i $ スヌークです。

両替所のある都市に行くと、$ 1 $ 円を $ 1 $ スヌークに両替することができます。 ただし、 両替をするときには持っている円すべてをスヌークに両替しなければなりません。 つまり、kenkoooo さんの所持金が $ X $ 円であるときに両替をすると、 kenkoooo さんの所持金は $ X $ スヌークになります。 現在、両替所は $ n $ 個の都市すべてに存在しますが、 $ i $ 番目の都市の両替所は今年から $ i $ 年後に閉鎖されてしまい、 $ i $ 年後とそれ以降は使うことができません。

kenkoooo さんは $ 10^{15} $ 円を持って都市 $ s $ から旅に出て、 都市 $ t $ へ向かおうと思っています。 移動中、kenkoooo さんは両替所のある都市のいずれかで円をスヌークに両替しようと考えています。 ただし、都市 $ s $ または都市 $ t $ の両替所で両替をしてもよいものとします。

kenkoooo さんは移動の経路と両替をする都市を適切に選ぶことで、できるだけ多くのスヌークを持っている状態で 都市 $ t $ に辿り着きたいと考えています。 $ i=0,...,n-1 $ のそれぞれについて、$ i $ 年後に都市 $ s $ から都市 $ t $ へ移動した際に kenkoooo さんが所持しているスヌークの最大額を求めてください。 ただし、旅行中に年をまたぐことは無いとします。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ n $ $ m $ $ s $ $ t $ $ u_1 $ $ v_1 $ $ a_1 $ $ b_1 $ $ : $ $ u_m $ $ v_m $ $ a_m $ $ b_m $

## 输出格式

$ n $ 行出力せよ。 $ i $ 行目には、 $ i-1 $ 年後に都市 $ s $ から都市 $ t $ へ移動した際に kenkoooo さんの所持しているスヌークの最大額を出力せよ。

## 说明/提示

### 制約

- $ 2\ \leq\ n\ \leq\ 10^5 $
- $ 1\ \leq\ m\ \leq\ 10^5 $
- $ 1\ \leq\ s,t\ \leq\ n $
- $ s\ \neq\ t $
- $ 1\ \leq\ u_i\ <\ v_i\ \leq\ n $
- $ 1\ \leq\ a_i,b_i\ \leq\ 10^9 $
- $ i\neq\ j $ のとき $ u_i\ \neq\ u_j $ または $ v_i\ \neq\ v_j $
- どの都市からどの都市へも電車を乗り継ぐことで到達できる
- 入力はすべて整数

### Sample Explanation 1

$ 0 $ 年後には、都市 $ 1 $ で両替をするのが最適です。 $ 1 $ 年後には、都市 $ 2 $ で両替をするのが最適です。 両替所が閉鎖されても都市 $ 1 $ を訪れることは可能であることに注意してください。 また、都市 $ 2 $ で両替をするときに $ 1 $ 円だけ残して残りをスヌークに両替をすると $ 999999999999998 $ スヌークを持った状態で都市 $ 3 $ にたどり着けますが、 このような両替は許されていないことにも注意してください。 $ 2 $ 年後には、都市 $ 3 $ で両替をするのが最適です。 $ 3 $ 年後には、都市 $ 4 $ で両替をするのが最適です。 同じ電車を複数回使っても良いことに注意してください。

## 样例 #1

### 输入

```
4 3 2 3

1 4 1 100

1 2 1 10

1 3 20 1
```

### 输出

```
999999999999998

999999999999989

999999999999979

999999999999897
```

## 样例 #2

### 输入

```
8 12 3 8

2 8 685087149 857180777

6 7 298270585 209942236

2 4 346080035 234079976

2 5 131857300 22507157

4 8 30723332 173476334

2 6 480845267 448565596

1 4 181424400 548830121

4 5 57429995 195056405

7 8 160277628 479932440

1 6 475692952 203530153

3 5 336869679 160714712

2 7 389775999 199123879
```

### 输出

```
999999574976994

999999574976994

999999574976994

999999574976994

999999574976994

999999574976994

999999574976994

999999574976994
```



---

---
title: "Interval Running"
layout: "post"
diff: 普及+/提高
pid: AT_sumitb2019_f
tag: []
---

# Interval Running

## 题目描述

[problemUrl]: https://atcoder.jp/contests/sumitrust2019/tasks/sumitb2019_f

高橋君と青木君は、西から東に向けて一直線に果てしなく続くランニングコースで長距離走の練習をしています。

彼らは同じ地点から同時にスタートし、**東に向かって**次のように移動します。

- 高橋君は最初の $ T_1 $ 分間、分速 $ A_1 $ メートルで走り、次の $ T_2 $ 分間、分速 $ A_2 $ メートルで走り、これを交互にいつまでも繰り返す。
- 青木君は最初の $ T_1 $ 分間、分速 $ B_1 $ メートルで走り、次の $ T_2 $ 分間、分速 $ B_2 $ メートルで走り、これを交互にいつまでも繰り返す。

さて、高橋君と青木君は何回出会う、すなわち、同じ位置に来るでしょうか？スタート地点にいる時は数えません。無限回出会う場合は、その旨を報告してください。

## 输入格式

入力は以下の形式で標準入力から与えられます。

> $ T_1 $ $ T_2 $ $ A_1 $ $ A_2 $ $ B_1 $ $ B_2 $

## 输出格式

高橋君と青木君が出会う回数を出力してください。  
 ただし、無限回出会う場合は代わりに `infinity` と出力してください。

## 说明/提示

### 制約

- $ 1\ \leq\ T_i\ \leq\ 100000 $
- $ 1\ \leq\ A_i\ \leq\ 10^{10} $
- $ 1\ \leq\ B_i\ \leq\ 10^{10} $
- $ A_1\ \neq\ B_1 $
- $ A_2\ \neq\ B_2 $
- 入力中の値はすべて整数

### Sample Explanation 1

彼らはスタートしてから $ \frac{4}{3} $ 分後に $ 1 $ 回だけ、スタート地点から $ \frac{40}{3} $ メートルの位置で出会います。

### Sample Explanation 2

彼らはスタートしてから $ 101,\ 202,\ 303,\ 404,\ 505,\ 606,\ ... $ 分後に出会うので、無限回出会うことになります。

### Sample Explanation 3

入力中の値は $ 32 $ ビット整数型に収まらないことがあります。

## 样例 #1

### 输入

```
1 2

10 10

12 4
```

### 输出

```
1
```

## 样例 #2

### 输入

```
100 1

101 101

102 1
```

### 输出

```
infinity
```

## 样例 #3

### 输入

```
12000 15700

3390000000 3810000000

5550000000 2130000000
```

### 输出

```
113
```



---

---
title: "サイコロ"
layout: "post"
diff: 普及+/提高
pid: AT_tdpc_dice
tag: []
---

# サイコロ

## 题目描述

[problemUrl]: https://atcoder.jp/contests/tdpc/tasks/tdpc_dice

入力は以下の形式で標準入力から与えられる。

> $ N $ $ D $

 答えを一行に出力せよ。絶対誤差が $ 10^{-6} $ 以下のとき正当と判定される。 ```

2 6
```

```

0.416666667
```

```

3 2
```

```

0.875000000
```

## 说明/提示

### Constraints

 サイコロを $ N $ 回振ったとき、出た目の積が $ D $ の倍数となる確率を求めよ。

- - - - - -

- $ 1\ <\ =\ N\ <\ =\ 100 $
- $ 1\ <\ =\ D\ <\ =\ 10^{18} $



---

---
title: "トーナメント"
layout: "post"
diff: 普及+/提高
pid: AT_tdpc_tournament
tag: []
---

# トーナメント

## 题目描述

[problemUrl]: https://atcoder.jp/contests/tdpc/tasks/tdpc_tournament

入力は以下の形式で標準入力から与えられる。

> $ K $ $ R_1 $ $ … $ $ R_{2^K} $

 答えを $ 2^K $ 行出力せよ。$ i $ 行目は人 $ i $ が優勝する確率であり、絶対誤差が $ 10^{-6} $ 以下のとき正当と判定される。 ```

1
2200
2600
```

```

0.090909091
0.909090909
```

```

3
2000
2500
2300
2700
2100
2400
2600
2200
```

```

0.000086893
0.122042976
0.005522752
0.493464665
0.000651695
0.053982389
0.321828438
0.002420190
```

## 说明/提示

### Constraints

 $ 2^K $ 人が参加するトーナメントがある。このトーナメントでは以下の形式で試合を行う。

- 第 1 ラウンドでは、1 と 2、3 と 4、… が試合を行う。
- 第 2 ラウンドでは、(1 と 2 の勝者) と (3 と 4 の勝者), (5 と 6 の勝者) と (7 と 8 の勝者), … が試合を行う。
- 第 3 ラウンドでは、((1 と 2 の勝者) と (3 と 4 の勝者) の勝者) と ((5 と 6 の勝者) と (7 と 8 の勝者) の勝者), ((9 と 10 の勝者) と (11 と 12 の勝者) の勝者) と ((13 と 14 の勝者) と (15 と 16 の勝者) の勝者), … が試合を行う。
- 以下同様に第 $ K $ ラウンドまで行う。
 
 第 $ K $ ラウンドの終了後に優勝者が決定する。人 $ i $ の Elo Rating が $ R_i $ であるとき、人 $ i $ の優勝確率を求めよ。   
 ただし、Elo Rating $ R_P $ の人 P と Elo Rating $ R_Q $ の人 Q が対戦した場合、人 P が勝つ確率は $ 1\ /\ (1\ +\ 10^{(R_Q\ -\ R_P)\ /\ 400}) $ であり、異なる試合の勝敗は独立であるとする。 - - - - - -

- $ 1\ <\ =\ K\ <\ =\ 10 $
- $ 0\ <\ =\ R_i\ <\ =\ 4000 $



---

---
title: "天下一後入れ先出しデータ構造"
layout: "post"
diff: 普及+/提高
pid: AT_tenka1_2013_qualB_b
tag: []
---

# 天下一後入れ先出しデータ構造

## 题目描述

[problemUrl]: https://atcoder.jp/contests/tenka1-2013-qualb/tasks/tenka1_2013_qualB_b

 スタックは最も基本的なデータ構造の1つであり、データを後入れ先出し (Last In First Out) の構造で保持するものである。スタックは最初は空で、要素の追加と取り出しができるが、取り出しは追加されたのが遅い順に行われる。

 ある日、天下一株式会社に務めるユウヤ君は、スタックになりきるという仕事を言い渡された。唖然とするユウヤ君を心配するあなたは、以下の形式の入力で与えられる命令の列をユウヤ君の代わりに処理して、後述のような出力を行うプログラムを作成することにした。

- - - - - -

 入力は以下の形式で標準入力から与えられる。

> $ Q $ $ L $ $ query_1 $ $ query_2 $ $ ... $ $ query_Q $

- $ 1 $ 行目は、与えられる命令の数 $ Q $ ($ 1\ \leq\ Q\ \leq\ 10^5 $) と スタックのサイズ $ L $ ($ 1\ \leq\ L\ \leq\ 2147483647 $) が空白区切りで与えられる。
- $ 2 $ 行目から $ Q+1 $ 行目までの $ Q $ 行は、$ i $ ($ 1\ \leq\ i\ \leq\ Q $) 番目の 命令が与えられる。

 各命令は、以下 $ 4 $ 種類のうちいずれかに該当する。

1. Push $ N $ $ M $

- スタックに要素 $ M $ を $ N $ 個追加する。出力は行わない。

10. Pop $ N $
- スタックから要素を $ N $ 個取り出す。出力は行わない。

12. Top
- スタックの先頭要素を $ 1 $ 行で出力する。この命令でスタックを構成する要素は変更されない。

14. Size
- スタックの要素数を $ 1 $ 行で出力する。

$ N $, $ M $ はそれぞれ整数で、 $ 1\ \leq\ N\ \leq\ 10^5 $, $ -2^{20}\ \leq\ M\ \leq\ 2^{20} $ をみたす。

ただし、スタックの先頭要素とは、スタックの要素のうちで最後に追加されたものであり、もしそのときPop $ 1 $を行ったとすると取り出される要素である。

- $ Q\ \leq\ 50 $, $ N\ \leq\ 50 $ の入力に正解すると、$ 60 $ 点満点に対して部分点として、$ 30 $ 点が与えられる。

 上記のとおり、与えられた命令を順番に処理していき、Top、またはSizeの入力が与えられた際に出力を行う。

 ただし、以下の $ 3 $ つの場合、スタックは例外を投げて止まってしまう。

- Push $ N $ $ M $ を要素数が $ L-N $ より大きいスタックに対して行った場合
- Pop $ N $を要素数が $ N $ 未満のスタックに対して行った場合
- Top を空のスタックに対して行った場合

 スタックが投げる例外は以下の通りである。

- Push による例外でプログラムが終了した場合は `FULL`
- Pop または Top による例外でプログラムが終了した場合は `EMPTY`

 これらの例外は $ 1 $ 行で出力され、例外を投げた後のスタックはそれ以降の命令を放棄する。  
 スタックは最後まで正常に命令を処理できた場合、 `SAFE` を $ 1 $ 行で出力して終了する。

 ```

7 20
Push 2 3
Push 4 5
Top
Size
Pop 5
Top
Size
```

 ```

5
6
3
1
SAFE
```

 ```

1 10
Push 40 40
```

 ```

FULL
```

 ```

5 10
Push 1 2
Top
Pop 1
Top
Size
```

 ```

2
EMPTY
```

 ```

4 10
Top
Size
Push 1 1
Top
```

 ```

EMPTY
```



---

---
title: "かぶりん！"
layout: "post"
diff: 普及+/提高
pid: AT_tenka1_2014_qualA_b
tag: []
---

# かぶりん！

## 题目描述

“ぶん投げRPG『かぶりん！』”是一款靠投掷包裹的神秘生物かぶりん来击败敌人的动作角色扮演游戏。

国民ダイキ君对かぶりん游戏非常着迷，于是决定写一个程序来计算对敌人造成的伤害。

游戏规则如下：

- 游戏开始时，玩家手中有 $5$ 袋かぶりん。
- 玩家可以投掷手中的かぶりん，造成一定的伤害；投掷后，かぶりん会在一段时间后返回。
- 共有两种投掷方式：「普通投掷」和「蓄力投掷」，每次成功造成伤害后，连击数会增加。

### 普通投掷

- 投掷 $1$ 袋かぶりん。
- 至少需要 $1$ 袋かぶりん。
- 投掷时间 $0.5$ 秒。
- 投掷后 $1$ 秒造成伤害。
- 基础伤害为 $10$，与投掷时的连击数有关。
- 造成伤害后 $5$ 秒かぶりん返回手中。

### 蓄力投掷

- 投掷 $3$ 袋かぶりん。
- 至少需要 $3$ 袋かぶりん。
- 投掷时间 $2.5$ 秒，期间无法进行其他操作。
- 投掷后 $1$ 秒造成伤害。
- 基础伤害为 $50$，与投掷时的连击数有关。
- 造成伤害后 $5$ 秒かぶりん返回手中。

### 连击机制

- 游戏开始时连击数为 $0$。
- 每成功一次投掷攻击，连击数加 $1$。
- 每 $10$ 连击，造成的伤害增加基础伤害的 $10\%$。
- 伤害计算公式为：$A \times (1 + \text{floor}(C / 10) \times 0.1)$，其中 $A$ 是基础伤害，$C$ 是当前连击数。
- 伤害增幅从达成连击后的第一投生效。

### 用户输入

- 每秒钟，用户可以输入一次「普通投掷」、「蓄力投掷」或「无动作」。
- 如果投掷指令时手中没有足够的かぶりん，该指令被忽略。
- 在蓄力期间所有输入被忽略。

根据用户输入，计算对敌人造成的总伤害。注意，包括用户输入结束后，未返回的かぶりん的伤害。

## 输入格式

标准输入包含一行，表示用户输入序列：

> $ S_1\ S_2\ \ldots\ S_n $

- 输入时长为 $n$ 的字符串 ($1 \leq n \leq 1000000$)
- 第 $i$ 个字符 $S_i$ 表示第 $i$ 秒的用户输入
- $S_i$ 可以为：
  - `-` 无动作
  - `N` 普通投掷
  - `C` 蓄力投掷

## 输出格式

输出对敌人造成的总伤害，以一行整数形式给出。需注意，输出需以一个换行结束，确保总伤害不会超过 $10^{11}$。请注意，一般的 32 位整数类型无法存储这么大的数据。

## 说明/提示

### 样例解释 1

尝试进行 $8$ 次普通投掷，其中第 $6$ 和第 $7$ 秒因かぶりん不足未成功，到第 $8$ 秒才因第 $1$ 秒的投掷返还かぶりん，故成功投掷 $6$ 次，造成 $60$ 点伤害。

### 样例解释 2

在第 $1$ 秒开始蓄力投掷，第 $2$ 和第 $3$ 秒的输入因处于蓄力状态被忽略，第 $4$ 和第 $5$ 秒因かぶりん不足而被忽略。

### 样例解释 3

连击导致的伤害增益是在开始投掷前生效的。注意，当连击数达到 $10$ 时，之后的投掷立即享受伤害增益。

 **本翻译由 AI 自动生成**

## 样例 #1

### 输入

```
NNNNNNNN
```

### 输出

```
60
```

## 样例 #2

### 输入

```
CCCCC
```

### 输出

```
50
```

## 样例 #3

### 输入

```
NNC------NNC------NNC------NNC------NNC------NNC
```

### 输出

```
439
```



---

---
title: "グラフィカルグラフ"
layout: "post"
diff: 普及+/提高
pid: AT_tenka1_2016_qualA_d
tag: []
---

# グラフィカルグラフ

## 题目描述

[problemUrl]: https://atcoder.jp/contests/tenka1-2016-quala/tasks/tenka1_2016_qualA_d

*天下一株式会社では、グラフ理論におけるグラフを視覚的に表現するソフトウェアを開発しています。 特に、あまり複雑でないグラフをテキストベースで見やすく表示するツールが人気です。*

$ N $ 頂点の無向木が与えられます。 各頂点には、大文字のアルファベットが重複なく割り振られています（頂点の個数は $ 26 $ 以下です）。

$ N-1 $ 本の辺のうち $ i $ 番目は、頂点 $ v_i $ と頂点 $ w_i $ を結びます。 ただし、任意の頂点について、その頂点に接続する辺の本数が $ 4 $ 以下であることが保証されます。

与えられた木を以下のように視覚的に表示するプログラムを作ってください。 詳細は「出力」セクションに記します。

 ```
8 12
............
...D...E....
...|...|....
.C-A---B---F
.|.....|...|
.|.....G.J-I
.H..........
............
```

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ v_1 $ $ w_1 $ $ v_2 $ $ w_2 $ $ : $ $ v_{N-1} $ $ w_{N-1} $

## 输出格式

入力された木を、以下の形式で $ H+1 $ 行に表示せよ。

> $ H $ $ W $ $ c_{1,1} $$ c_{1,2} $ $ … $ $ c_{1,W} $ $ c_{2,1} $$ c_{2,2} $ $ … $ $ c_{2,W} $ $ : $ $ c_{H,1} $$ c_{H,2} $ $ … $ $ c_{H,W} $

ここで、

- $ H $, $ W $ は以下に続く視覚表示の大きさを表し、半角スペース一つで区切られる。$ 1≦H≦100,\ 1≦W≦100 $ を満たさなければならない。
- 視覚表示は、文字を縦 $ H $ 文字、横 $ W $ 文字の長方形状に並べたものである。
- 視覚表示を構成するそれぞれの文字 $ c_{i,j} $ は、英大文字の最初の $ N $ 文字および `.`、`-`、`|` のいずれかであり、以下を満たす。
  - 木の各頂点は、対応する英大文字で表される。それぞれの頂点は、視覚表示にちょうど一度ずつ現れなければならない。
  - 頂点を表す文字は、別の頂点を表す文字と縦または横に隣接してはならない。
  - 二つの頂点 $ a,\ b $ が一本の辺で直接結ばれるなら、以下の条件 **(A)**, **(B)** のうち一方を満たさなければならない。
      - **(A)** 頂点 $ a,\ b $ を表す二つの文字が視覚表示の同じ行にあり、それらに挟まれた文字はすべて `-` である。
      - **(B)** 頂点 $ a,\ b $ を表す二つの文字が視覚表示の同じ列にあり、それらに挟まれた文字はすべて `|` である。
  - 二つの頂点 $ a,\ b $ が一本の辺で直接結ばれないなら、上記の条件 **(A)**, **(B)** を満たすことはどちらも禁止される。
  - 以上のように頂点や辺を表す文字以外の文字は、すべて `.` でなければならない。

なお、制約を満たす入力に対し、これらの条件を満たす視覚表示が必ず存在することが示せる。そのような視覚表示のうち、どれを出力してもよい。

## 说明/提示

### 制約

- $ 2≦N≦26 $
- $ v_i $, $ w_i $ は、それぞれ英大文字の最初の $ N $ 文字のいずれかである。
- 与えられるグラフは木である。
- 任意の頂点について、その頂点に接続する辺の本数は $ 4 $ 以下である。

### Sample Explanation 1

出力例は問題文中で示した例と同一です。

### Sample Explanation 2

頂点を表す文字が `-` や `|` と縦や横に隣接することは禁止されていません。

## 样例 #1

### 输入

```
10

A B

A C

A D

B E

B F

B G

C H

F I

I J
```

### 输出

```
8 12

............

...D...E....

...|...|....

.C-A---B---F

.|.....|...|

.|.....G.J-I

.H..........

............
```

## 样例 #2

### 输入

```
7

A B

B C

C D

D E

E F

F G
```

### 输出

```
5 4

.A-B

E-F|

|.||

|.G|

D--C
```



---

---
title: "無限グラフ"
layout: "post"
diff: 普及+/提高
pid: AT_tenka1_2016_qualA_e
tag: []
---

# 無限グラフ

## 题目描述

[problemUrl]: https://atcoder.jp/contests/tenka1-2016-quala/tasks/tenka1_2016_qualA_e

*天下一研究所は、組合せ数学の研究拠点として様々な活動を行っています。 最近は、無限個の頂点を持つグラフに関する研究が盛んなようです。*

正の整数 $ N $ と、$ 0 $ 以上 $ N-1 $ 以下の整数のペア $ M $ 組 $ (A_1,\ B_1),\ (A_2,\ B_2),\ …,\ (A_M,\ B_M) $ が与えられます。

次のような、無限個の頂点を持つ無向グラフを考えます。

- 任意の整数 $ z $ に対し（負の整数も考える）、それに対応する頂点がただ一つ存在する。整数 $ z $ に対応する頂点を頂点 $ z $ と呼ぶ。どの整数にも対応しない頂点は存在しない。
- 任意の二つの整数 $ i,\ k\ (1\ ≦\ i\ ≦\ M) $ に対し、頂点 $ A_i\ +\ k\ ×\ N $ と頂点 $ B_i\ +\ (k\ +\ 1)\ ×\ N $ は一本の辺で直接結ばれる。それらの辺以外に辺は存在しない。

（入力例・出力例のセクションの画像を参考にしてください）

このグラフの連結成分の個数が有限かどうかを判定し、有限ならその個数を求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ M $ $ A_1 $ $ B_1 $ $ A_2 $ $ B_2 $ $ : $ $ A_M $ $ B_M $

## 输出格式

与えられたグラフの連結成分の個数が有限なら、その個数を出力せよ。無限なら、代わりに $ -1 $ と出力せよ。

## 说明/提示

### 制約

- $ 1\ ≦\ N\ ≦\ 10^5 $
- $ 1\ ≦\ M\ ≦\ 10^5 $
- $ 0\ ≦\ A_i,\ B_i\ ≦\ N-1 $
- すべての組 $ (A_i,\ B_i) $ は異なる。

### 部分点

- $ 400 $ 点分のデータセットは以下を満たす。
  - $ 1\ ≦\ N\ ≦\ 1000 $
  - $ 1\ ≦\ M\ ≦\ 1000 $

### Sample Explanation 1

!\[E1.png\](https://tenka1-2016-quala.contest.atcoder.jp/img/other/tenka1\_2016\_quala/bagnyahay/E1.png) 辺をたどって、任意の二頂点間を行き来できます。したがって、このグラフの連結成分の個数は $ 1 $ です。

### Sample Explanation 2

!\[E2.png\](https://tenka1-2016-quala.contest.atcoder.jp/img/other/tenka1\_2016\_quala/bagnyahay/E2.png) 無限の長さを持つ直線状の連結成分が $ 2 $ 個あります。

### Sample Explanation 3

!\[E3.png\](https://tenka1-2016-quala.contest.atcoder.jp/img/other/tenka1\_2016\_quala/bagnyahay/E3.png) $ 3 $ 頂点からなる連結成分が無限個あります。

## 样例 #1

### 输入

```
2 2

0 0

1 0
```

### 输出

```
1
```

## 样例 #2

### 输入

```
2 2

0 1

1 0
```

### 输出

```
2
```

## 样例 #3

### 输入

```
3 2

0 1

2 1
```

### 输出

```
-1
```

## 样例 #4

### 输入

```
7 8

0 3

1 2

1 5

2 5

3 4

4 6

5 2

6 3
```

### 输出

```
4
```



---

---
title: "IntegerotS"
layout: "post"
diff: 普及+/提高
pid: AT_tenka1_2017_d
tag: []
---

# IntegerotS

## 题目描述

[problemUrl]: https://atcoder.jp/contests/tenka1-2017/tasks/tenka1_2017_d

非負整数専門店「せいすうや」には、$ N $ 個の非負整数が売られています。$ i $ 個目の非負整数は $ A_i $ で、その価値は $ B_i $ です。 価値の異なる同じ非負整数が複数売られていることもあります。

高橋君は、「せいすうや」でいくつかの整数を買うことにしました。高橋君は、買う整数たちの bitwise or が $ K $ 以下になるような 任意の組み合わせで、整数を買うことができます。高橋君は、買った整数たちの価値の総和をできるだけ大きくしたいです。

高橋君が達成できる、価値の総和の最大値を求めてください。ただし、bitwise or とは、ビットごとの論理和を表します。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ K $ $ A_1 $ $ B_1 $ : $ A_N $ $ B_N $

## 输出格式

高橋君が達成できる価値の総和の最大値を出力せよ。

## 说明/提示

### 制約

- $ 1\ \leq\ N\ \leq\ 10^5 $
- $ 0\ \leq\ K\ <\ 2^{30} $
- $ 0\ \leq\ A_i\ <\ 2^{30}(1\leq\ i\leq\ N) $
- $ 1\ \leq\ B_i\ \leq\ 10^9(1\leq\ i\leq\ N) $
- 入力は全て整数である

### Sample Explanation 1

$ 2 $ と $ 3 $ を購入することで、最大値 $ 8 $ を達成できます。

### Sample Explanation 2

$ 2 $ と $ 4 $ を購入することで、最大値 $ 9 $ を達成できます。

## 样例 #1

### 输入

```
3 5

3 3

4 4

2 5
```

### 输出

```
8
```

## 样例 #2

### 输入

```
3 6

3 3

4 4

2 5
```

### 输出

```
9
```

## 样例 #3

### 输入

```
7 14

10 5

7 4

11 4

9 8

3 6

6 2

8 9
```

### 输出

```
32
```



---

---
title: "Crossing"
layout: "post"
diff: 普及+/提高
pid: AT_tenka1_2018_d
tag: []
---

# Crossing

## 题目描述

[problemUrl]: https://atcoder.jp/contests/tenka1-2018/tasks/tenka1_2018_d

整数 $ N $ が与えられます。$ \{1,2,...N\} $ の部分集合の組 $ (S_1,S_2,...,S_k) $ であって、以下の条件を満たすものが存在するか判定し、 存在する場合はひとつ構成してください。

- $ 1,2,...,N $ のうちどの整数も、$ S_1,S_2,...,S_k $ のうちちょうど $ 2 $ つに含まれる
- $ S_1,S_2,...,S_k $ のうちどの $ 2 $ つの集合をとっても、それらに共通して含まれる要素はちょうど $ 1 $ つである

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $

## 输出格式

条件を満たす部分集合の組が存在しない場合、`No` を出力せよ。 存在する場合、まず `Yes` を出力し、次いで以下の形式で部分集合の情報を出力せよ。 ただし、$ S_i=\{S_{i,1},S_{i,2},...,S_{i,|S_i|}\} $ とする。

条件を満たすものが複数ある場合、どれを出力しても構わない。

> $ k $ $ |S_1| $ $ S_{1,1} $ $ S_{1,2} $ $ ... $ $ S_{1,|S_1|} $ $ : $ $ |S_k| $ $ S_{k,1} $ $ S_{k,2} $ $ ... $ $ S_{k,|S_k|} $

## 说明/提示

### 制約

- $ 1\ \leq\ N\ \leq\ 10^5 $
- $ N $ は整数である

### Sample Explanation 1

$ (S_1,S_2,S_3)=(\{1,2\},\{3,1\},\{2,3\}) $ とすれば、条件を満たすことが確認できます。

## 样例 #1

### 输入

```
3
```

### 输出

```
Yes

3

2 1 2

2 3 1

2 2 3
```

## 样例 #2

### 输入

```
4
```

### 输出

```
No
```



---

---
title: "Area Sum"
layout: "post"
diff: 普及+/提高
pid: AT_toyota2023spring_final_a
tag: []
---

# Area Sum

## 题目描述

[problemUrl]: https://atcoder.jp/contests/toyota2023spring-final/tasks/toyota2023spring_final_a

$ N $ 行 $ M $ 列からなる盤面があり，各マス目には row-major 順に $ 1 $ から $ N\ \times\ M $ までの整数が書かれています． つまり，上から $ i $ 行目，左から $ j $ 列目のマスに書かれている整数を $ A_{i,j} $ で表すことにすると， $ A_{i,j}=(i-1)\ \times\ M\ +\ j $ です．

この盤面の部分長方形であって，その内部に書かれた値の総和がちょうど $ V $ になるものの個数を数えてください．

より厳密に言えば，整数の $ 4 $ つ組 $ (a,b,c,d) $ ($ 1\ \leq\ a\ \leq\ b\ \leq\ N $, $ 1\ \leq\ c\ \leq\ d\ \leq\ M $) であって，$ \sum_{a\ \leq\ i\ \leq\ b,\ c\ \leq\ j\ \leq\ d}\ A_{i,j}=V $ を満たすものの個数を数えてください．

## 输入格式

入力は以下の形式で標準入力から与えられる．

> $ N $ $ M $ $ V $

## 输出格式

答えを出力せよ．

## 说明/提示

### 制約

- $ 1\ \leq\ N,\ M\ \leq\ 5000 $
- $ 1\ \leq\ V\ \leq\ 10^{15} $
- 入力される値はすべて整数である

### Sample Explanation 1

盤面には以下のように整数が書き込まれています． ``` 12 34 ``` 条件を満たす部分長方形は，$ (a,b,c,d)=(1,1,1,2),(2,2,1,1) $ の $ 2 $ つです．

## 样例 #1

### 输入

```
2 2 3
```

### 输出

```
2
```

## 样例 #2

### 输入

```
2 2 5
```

### 输出

```
0
```

## 样例 #3

### 输入

```
13 8 1032
```

### 输出

```
5
```



---

---
title: "[[iwi]]"
layout: "post"
diff: 普及+/提高
pid: AT_utpc2011_3
tag: []
---

# [[iwi]]

## 题目描述

[problemUrl]: https://atcoder.jp/contests/utpc2011/tasks/utpc2011_3





---

---
title: "直径"
layout: "post"
diff: 普及+/提高
pid: AT_utpc2013_03
tag: []
---

# 直径

## 题目描述

### 题目背景
鳗鱼王国有一个名为鱼鳗王国的邻国。这两个王国都有许多的大城市，这些城市之间有一些道路相连。然而现在，鳗鱼王国和鱼鳗王国之间没有互通的道路。所以，鳗鱼王国的国王殿下为了和鱼鳗王国构筑友好关系，打算在两个城市间建设一条道路，因为有很多条可以建设的道路，对运费很敏感的国王殿下想知道两两城市间最短距离的最大值。
给出顶点数 $n_1$，边数 $m_1$ 的无向图 $G_1$ 和顶点数 $n_2$，边数 $m_2$ 的无向图 $G_2$。每个图都是连通图。换句话说，对于每张图来说，任意的两个顶点间都有直接或间接的道路连接。请回答出在两张图之间任加一条边后构成的图形中，最远的两个顶点的距离（称为图形的直径）的最小值和最大值。

## 输入格式

输入按以下形式给出：
> $n_1$ $m_1$ $a_1$ $b_1$ $a_2$ $b_2$ $\cdots$ $a_{m_1}$ $b_{m_1}$ $n_2$ $m_2$ $c_1$ $d_1$ $c_2$ $d_2$ $\cdots$ $c_{m_2}$ $d_{m_2}$

第一行给出图 $G_1$ 的顶点数 $n_1$ 和边数 $m_1$。接下来的 $m_1$ 行为边的情况。$a_i,b_i$ 表示 $G_1$ 图中有一条以 $a_i,b_i$ 为顶点的边。接下来一行为图 $G_2$ 的顶点数 $n_2$ 和边数 $m_2$。接下来的 $m_2$ 行为边的情况。$c_i,d_i$ 表示 $G_2$ 图中有一条以 $c_i,d_i$ 为顶点的边。

## 输出格式

将在两个图间加一条边得到的图的直径最小值与最大值以空格分开输出。

## 说明/提示

输入中的各变量满足以下条件。
- $1 \leq n_{1},n_{2} \leq 1000(=10^4)$
- $0 \leq m_{1},m_{2} \leq 10000(=10^5)$
- $0 \leq a_i,b_i<n_1$
- $0\leq c_i,d_i<n_2$
- 每张图为连通图
- 每张图为简单图，也就是说没有重边与自环。

对于 $50\%$ 的数据，$1\leq n_1,n_2\leq20$。

#### 样例解释
【样例解释 1】

直径为 $3$ 及直径为 $5$ 的情况见下图：

![样例解释1](https://img.atcoder.jp/other/utpc2013/C_sample_1.png)

【样例解释 2】

直径为 $7$ 及直径为 $11$ 的情况见下图：

![样例解释2](https://img.atcoder.jp/other/utpc2013/C_sample_2.png)

【样例解释 3】

请注意此处的最小值。

## 样例 #1

### 输入

```
4 5
0 1
0 2
0 3
1 2
2 3
4 5
0 1
0 2
0 3
1 2
2 3

```

### 输出

```
3 5

```

## 样例 #2

### 输入

```
6 5
0 1
1 2
2 3
3 4
4 5
6 5
0 1
1 2
2 3
3 4
4 5

```

### 输出

```
7 11

```

## 样例 #3

### 输入

```
7 6
0 1
1 2
2 3
3 4
4 5
5 6
2 1
0 1

```

### 输出

```
6 8

```



---

---
title: "5キューブ"
layout: "post"
diff: 普及+/提高
pid: AT_wupc_04
tag: []
---

# 5キューブ

## 题目描述

[problemUrl]: https://atcoder.jp/contests/wupc2nd/tasks/wupc_04

 5キューブは立方体を使ったパズルである．今回はこれをコンピュータを用いて自動で解くことを考えよう． 一辺の長さが $ 5 $ である立方体状のコンテナがある．また，それ以下の整数の大きさを持つ立方体のオブジェがたくさんある．パズルのゴールは，これらのオブジェをコンテナからはみ出さないように敷き詰めることである．オブジェはたくさんあるので，コンテナの数は $ 1 $ つでは足りないかもしれないが，使うコンテナの数が少なければ少ないほど高得点が得られる．  
  
 それぞれの大きさのオブジェの数が与えられるので，使うべきコンテナの数の最小値を答えよ． 入力は以下の形式で標準入力から与えられる．

> $ N_{1}　N_{2}　N_{3}　N_{4}　N_{5} $

- $ 1 $ 行目には，一辺の長さが $ x $ であるオブジェの数 $ N_{x} $($ 1\ ≦\ x\ ≦\ 5 $, $ 0\ ≦\ N_{x}\ ≦\ 1,000,000,000 $) が半角スペース区切りで与えられる．
- $ ∃x\ ::\ N_{x}\ ≧\ 1 $ を仮定してよい．すなわち，オブジェは必ず $ 1 $ つ以上与えられる．
 
 必要なコンテナの数を $ 1 $ 行に出力せよ．  
 なお、最後には改行を出力せよ． ```
<pre class="prettyprint linenums">
109 2 0 0 1
```

 ```
<pre class="prettyprint linenums">
2
```

 ```
<pre class="prettyprint linenums">
0 0 0 5 0
```

 ```
<pre class="prettyprint linenums">
5
```

 ```
<pre class="prettyprint linenums">
1000000000 1000000000 1000000000 1000000000 1000000000
```

 ```
<pre class="prettyprint linenums">
3000000000
```



---

---
title: "潜入"
layout: "post"
diff: 普及+/提高
pid: AT_zone2021_e
tag: []
---

# 潜入

## 题目描述

[problemUrl]: https://atcoder.jp/contests/zone2021/tasks/zone2021_e

$ 2 $ 次元平面があり、あなたは今いる座標 $ (1,\ 1) $ から UFO のある座標 $ (R,\ C) $ に移動したいです。  
 あなたが $ (r,\ c) $ にいるとき、あなたは以下の $ 4 $ 種類の移動を行うことができます。

- $ (r,\ c) $ から $ (r,\ c\ +\ 1) $ に移動する。$ A_{r,\ c} $ のコストがかかる。この移動は $ c\ <\ C $ のとき使える。
- $ (r,\ c) $ から $ (r,\ c\ -\ 1) $ に移動する。$ A_{r,\ c\ -\ 1} $ のコストがかかる。この移動は $ c\ >\ 1 $ のとき使える。
- $ (r,\ c) $ から $ (r\ +\ 1,\ c) $ に移動する。$ B_{r,\ c} $ のコストがかかる。この移動は $ r\ <\ R $ のとき使える。
- $ 1\ <\ =\ i\ <\ r $ を満たす整数 $ i $ を $ 1 $ つ選び、$ (r,\ c) $ から $ (r\ -\ i,\ c) $ に移動する。$ 1\ +\ i $ のコストがかかる。

$ (1,\ 1) $ から $ (R,\ C) $ に移動するために必要な最小のコストを求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ R $ $ C $ $ A_{1,1} $ $ \cdots $ $ A_{1,C-1} $ $ \vdots $ $ A_{R,1} $ $ \cdots $ $ A_{R,C-1} $ $ B_{1,1} $ $ \cdots $ $ B_{1,C} $ $ \vdots $ $ B_{R-1,1} $ $ \cdots $ $ B_{R-1,C} $

## 输出格式

答えを出力せよ。

## 说明/提示

### ストーリー

暗号解読を進めていると、仲間のムーアが突如 UFO に吸い込まれ、連れ去られてしまった。 ムーアは UFO との通信システムをほぼ 1 人で開発していたため、このままでは UFO と交信することができない！  
 デスマーチが横行していたブラックスタートアップ時代を思い出す。 バス係数$ {}\ =\ 1 $ のチームはいつだって脆いものだ。  
 仕方がない、UFO 内に乗り込んで直接話すしかなさそうだ。 上空を見上げると、UFO から梯子のようなものが下されている。  
 だがよく見るとボロボロで所々腐り落ちているようだ。 どうにかしてうまい登り方を考えなければ。

### 制約

- 入力は全て整数
- $ 2\ <\ =\ R,\ C\ <\ =\ 500 $
- $ 0\ <\ =\ A_{i,j}\ <\ 10^3 $
- $ 0\ <\ =\ B_{i,j}\ <\ 10^3 $

### Sample Explanation 1

以下のように移動するとコスト $ 9 $ が達成できます。 - $ (1,\ 1) $ から $ (2,\ 1) $ に移動する。コストが $ 1 $ かかる。 - $ (2,\ 1) $ から $ (3,\ 1) $ に移動する。コストが $ 1 $ かかる。 - $ (3,\ 1) $ から $ (3,\ 2) $ に移動する。コストが $ 1 $ かかる。 - $ (3,\ 2) $ から $ (1,\ 2) $ に移動する。コストが $ 3 $ かかる。 - $ (1,\ 2) $ から $ (1,\ 3) $ に移動する。コストが $ 1 $ かかる。 - $ (1,\ 3) $ から $ (2,\ 3) $ に移動する。コストが $ 1 $ かかる。 - $ (2,\ 3) $ から $ (3,\ 3) $ に移動する。コストが $ 1 $ かかる。

## 样例 #1

### 输入

```
3 3

10 1

10 10

1 10

1 10 1

1 10 1
```

### 输出

```
9
```

## 样例 #2

### 输入

```
7 11

42 77 94 76 40 66 43 28 66 23

27 34 41 31 83 13 64 69 81 82

23 81 0 22 39 51 4 37 84 43

62 37 82 86 26 67 45 78 85 2

79 18 72 62 68 84 69 88 19 48

0 27 21 51 71 13 87 45 39 11

74 57 32 0 97 41 87 96 17 98

69 58 76 32 51 16 38 68 86 82 64

53 47 33 7 51 75 43 14 96 86 70

80 58 12 76 94 50 59 2 1 54 25

14 14 62 28 12 43 15 70 65 44 41

56 50 50 54 53 34 16 3 2 59 88

27 85 50 79 48 86 27 81 78 78 64
```

### 输出

```
498
```

## 样例 #3

### 输入

```
4 4

0 0 0

0 0 0

0 0 0

0 0 0

0 0 0 0

0 0 0 0

0 0 0 0
```

### 输出

```
0
```



---


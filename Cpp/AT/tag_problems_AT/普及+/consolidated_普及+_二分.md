---
title: "[ABC181F] Silver Woods"
layout: "post"
diff: 普及+/提高
pid: AT_abc181_f
tag: ['二分', '并查集']
---

# [ABC181F] Silver Woods

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc181/tasks/abc181_f

$ xy $ 平面上に $ 2 $ 直線 $ y=-100,\ y=100 $ で囲まれた通路があります。

この通路の中の $ -100\ <\ x\ <\ 100 $ の部分に $ N $ 本の大きさの無視できる釘が打たれており、 $ i $ 本目の釘の座標は $ (x_i,\ y_i) $ です。

高橋くんは実数 $ r\ (0\ <\ r\ \leq\ 100) $ を $ 1 $ つ選び、半径 $ r $ の円を中心が $ (-10^9,\ 0) $ に位置するように置きます。

その後、円を $ (-10^9,\ 0) $ から $ (10^9,\ 0) $ まで移動させます。

このとき、円は通路の境界や釘が円の内部に入らないような範囲で連続的に動かすことができるものとします。

円を $ (10^9,\ 0) $ まで動かせるような最大の $ r $ を求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ x_1 $ $ y_1 $ $ \vdots $ $ x_N $ $ y_N $

## 输出格式

円を $ (10^9,\ 0) $ まで動かせるような最大の $ r $ を出力せよ。  
 なお、想定解答との絶対誤差または相対誤差が $ 10^{-4} $ 以下であれば正解として扱われる。

## 说明/提示

### 制約

- 入力はすべて整数
- $ 1\ \leq\ N\ \leq\ 100 $
- $ |x_i|,\ |y_i|\ <\ 100 $
- $ i\ \neq\ j $ ならば $ (x_i,\ y_i)\ \neq\ (x_j,\ y_j) $

### Sample Explanation 1

!\[\](https://img.atcoder.jp/ghi/493d8b75d6dd331fcc0f3949f12262b3.jpg) $ r=40 $ の円を図のように $ y=0 $ に沿って動かすと、 $ (-10^9,\ 0) $ から $ (10^9,\ 0) $ まで移動させることができます。 $ x=0 $ のときにちょうど $ 2 $ つの点と接しますが、円の内部には入っていないため問題ありません。 $ r $ を $ 40 $ より大きくすると、円の中心を $ (10^9,\ 0) $ まで動かすことができなくなるため、 $ r=40 $ が最大になります。

## 样例 #1

### 输入

```
2

0 -40

0 40
```

### 输出

```
40
```

## 样例 #2

### 输入

```
4

0 -10

99 10

0 91

99 -91
```

### 输出

```
50.5
```

## 样例 #3

### 输入

```
10

-90 40

20 -30

0 -90

10 -70

80 70

-90 30

-20 -80

10 90

50 30

60 -70
```

### 输出

```
33.541019662496845446
```

## 样例 #4

### 输入

```
10

65 -90

-34 -2

62 99

42 -13

47 -84

84 87

16 -78

56 35

90 8

90 19
```

### 输出

```
35.003571246374276203
```



---

---
title: "[ABC282D] Make Bipartite 2"
layout: "post"
diff: 普及+/提高
pid: AT_abc282_d
tag: ['图遍历', '二分图']
---

# [ABC282D] Make Bipartite 2

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc282/tasks/abc282_d

$ N $ 個の頂点と $ M $ 本の辺からなる単純な（すなわち、自己ループも多重辺も含まない）無向グラフ $ G $ が与えられます。 $ i\ =\ 1,\ 2,\ \ldots,\ M $ について、$ i $ 番目の辺は頂点 $ u_i $ と頂点 $ v_i $ を結びます。

$ 1\ \leq\ u\ \lt\ v\ \leq\ N $ を満たす整数の組 $ (u,\ v) $ であって、下記の $ 2 $ つの条件をともに満たすものの個数を出力してください。

- グラフ $ G $ において、頂点 $ u $ と頂点 $ v $ を結ぶ辺は存在しない。
- グラフ $ G $ に、頂点 $ u $ と頂点 $ v $ を結ぶ辺を追加して得られるグラフは、二部グラフである。
 
  二部グラフとは？無向グラフが**二部グラフ**であるとは、下記の条件を満たすように各頂点を黒または白のどちらかの色で塗ることができることを言います。

- 同じ色に塗られた頂点どうしを結ぶ辺は存在しない。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ M $ $ u_1 $ $ v_1 $ $ u_2 $ $ v_2 $ $ \vdots $ $ u_M $ $ v_M $

## 输出格式

答えを出力せよ。

## 说明/提示

### 制約

- $ 2\ \leq\ N\ \leq\ 2\ \times\ 10^5 $
- $ 0\ \leq\ M\ \leq\ \min\ \lbrace\ 2\ \times\ 10^5,\ N(N-1)/2\ \rbrace $
- $ 1\ \leq\ u_i,\ v_i\ \leq\ N $
- グラフ $ G $ は単純
- 入力はすべて整数
 
### Sample Explanation 1

問題文中の条件を満たす整数の組 $ (u,\ v) $ は、$ (1,\ 4) $ と $ (1,\ 5) $ の $ 2 $ つです。よって、$ 2 $ を出力します。 他の組については、例えば、$ (1,\ 3) $ はグラフ $ G $ において頂点 $ 1 $ と頂点 $ 3 $ を結ぶ辺が存在することから、 $ (4,\ 5) $ はグラフ $ G $ に頂点 $ 4 $ と頂点 $ 5 $ を結ぶ辺を追加して得られるグラフが二部グラフではないことから、 それぞれ問題文中の条件を満たしません。

### Sample Explanation 2

与えられるグラフが二部グラフであったり連結であるとは限らないことに注意してください。

## 样例 #1

### 输入

```
5 4

4 2

3 1

5 2

3 2
```

### 输出

```
2
```

## 样例 #2

### 输入

```
4 3

3 1

3 2

1 2
```

### 输出

```
0
```

## 样例 #3

### 输入

```
9 11

4 9

9 1

8 2

8 3

9 2

8 4

6 7

4 6

7 5

4 5

7 8
```

### 输出

```
9
```



---

---
title: "[ABC311E] Defect-free Squares"
layout: "post"
diff: 普及+/提高
pid: AT_abc311_e
tag: ['动态规划 DP', '二分', '前缀和']
---

# [ABC311E] Defect-free Squares

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc311/tasks/abc311_e

縦 $ H $ 行, 横 $ W $ 列のグリッドがあります。グリッドの上から $ i $ 行目, 左から $ j $ 列目のマスを $ (i,\ j) $ と呼びます。  
 グリッドの各マスは穴の空いたマスとそうでないマスのどちらかです。穴が空いたマスは $ (a_1,\ b_1),\ (a_2,\ b_2),\ \dots,\ (a_N,\ b_N) $ のちょうど $ N $ マスです。

正整数の組 $ (i,\ j,\ n) $ が次の条件を満たすとき、$ (i,\ j) $ を左上隅, $ (i\ +\ n\ -\ 1,\ j\ +\ n\ -\ 1) $ を右下隅とする正方形領域を **穴のない正方形** と呼びます。

- $ i\ +\ n\ -\ 1\ \leq\ H $
- $ j\ +\ n\ -\ 1\ \leq\ W $
- $ 0\ \leq\ k\ \leq\ n\ -\ 1,\ 0\ \leq\ l\ \leq\ n\ -\ 1 $ を満たす全ての非負整数の組 $ (k,\ l) $ に対して、$ (i\ +\ k,\ j\ +\ l) $ は穴が空いていないマスである。
 
グリッド内に穴のない正方形は何個ありますか？

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ H $ $ W $ $ N $ $ a_1 $ $ b_1 $ $ a_2 $ $ b_2 $ $ \vdots $ $ a_N $ $ b_N $

## 输出格式

穴のない正方形の個数を出力せよ。

## 说明/提示

### 制約

- $ 1\ \leq\ H,\ W\ \leq\ 3000 $
- $ 0\ \leq\ N\ \leq\ \min(H\ \times\ W,\ 10^5) $
- $ 1\ \leq\ a_i\ \leq\ H $
- $ 1\ \leq\ b_i\ \leq\ W $
- $ (a_i,\ b_i) $ は互いに異なる
- 入力される値は全て整数
 
### Sample Explanation 1

穴のない正方形は全部で $ 6 $ 個あります。 それらを列挙すると次の通りです。このうちはじめの $ 5 $ 個は $ n\ =\ 1 $ の場合であり、領域の左上隅のマスと右下隅のマスが一致します。 - $ (1,\ 1) $ を左上隅かつ右下隅とする正方形領域 - $ (1,\ 2) $ を左上隅かつ右下隅とする正方形領域 - $ (1,\ 3) $ を左上隅かつ右下隅とする正方形領域 - $ (2,\ 1) $ を左上隅かつ右下隅とする正方形領域 - $ (2,\ 2) $ を左上隅かつ右下隅とする正方形領域 - $ (1,\ 1) $ を左上隅, $ (2,\ 2) $ を右下隅とする正方形領域

### Sample Explanation 2

穴のない正方形が存在しない場合もあります。

### Sample Explanation 3

穴のない正方形がグリッド全体と一致する場合もあります。

## 样例 #1

### 输入

```
2 3 1

2 3
```

### 输出

```
6
```

## 样例 #2

### 输入

```
3 2 6

1 1

1 2

2 1

2 2

3 1

3 2
```

### 输出

```
0
```

## 样例 #3

### 输入

```
1 1 0
```

### 输出

```
1
```

## 样例 #4

### 输入

```
3000 3000 0
```

### 输出

```
9004500500
```



---

---
title: "[ABC366E] Manhattan Multifocal Ellipse"
layout: "post"
diff: 普及+/提高
pid: AT_abc366_e
tag: ['二分', '前缀和']
---

# [ABC366E] Manhattan Multifocal Ellipse

## 题目描述

二维平面上有 $N$ 个点 $(x_1,y_1),(x_2,y_2),\ldots,(x_n,y_n)$，给你一个正整数 $D$，求有多少组 $(x,y)$ 满足 

$$\sum\limits^N_{i=1}(|x-x_i|+|y-y_i|) \leq D$$

## 输入格式

第一行两个正整数 $N,D$。接下来 $N$ 行，每行两个整数，表示二维平面上点的坐标。

## 输出格式

一行一个整数，表示你的答案。

## 说明/提示

- $1 \leq N \leq 2 \times 10^5$

- $0 \leq D \leq 10^6$

- $-10^6 \leq x_i,y_i \leq 10^6$

- 保证对于所有的 $i \ne j$，$(x_i,y_i) \ne (x_j,y_j)$。

- 所有输入均为整数。

## 样例 #1

### 输入

```
2 3

0 0

1 0
```

### 输出

```
8
```

## 样例 #2

### 输入

```
2 0

0 0

2 0
```

### 输出

```
0
```

## 样例 #3

### 输入

```
6 100

9 -6

10 -1

2 10

-1 7

-7 5

-1 -4
```

### 输出

```
419
```



---

---
title: "[ABC373E] How to Win the Election"
layout: "post"
diff: 普及+/提高
pid: AT_abc373_e
tag: ['贪心', '二分']
---

# [ABC373E] How to Win the Election

## 题目描述

现在正在举行一场选举，有 $N$ 位候选人，编号为 $1, 2, \ldots, N$。目前已经有 $K$ 张选票，其中一些已经被计入。

到目前为止，第 $i$ 位候选人已经获得了 $A_i$ 票。

在所有选票被计完后，如果某位候选人的得票数比他们多的候选人数少于 $M$，那么该候选人将被当选。可能会有多位候选人同时当选。

对于每个候选人，求出他们需要从剩余的选票中获得的最少票数，以确保无论其他候选人获得多少票，他们都能当选。

具体来说，对于每个 $i = 1, 2, \ldots, N$，解决以下问题：

确定是否存在一个非负整数 $X$，其不超过 $K - \displaystyle{\sum_{i=1}^{N}} A_i$，并满足以下条件。如果存在，找出满足条件的最小 $X$。

- 如果候选人 $i$ 获得了 $X$ 张额外选票，那么候选人 $i$ 将始终当选。

## 输入格式

第一行包含三个整数 $N$、$M$ 和 $K$。

第二行包含 $N$ 个整数，分别是 $A_1, A_2, \ldots, A_N$，表示每个候选人当前已经获得的票数。

## 输出格式

设 $C_i$ 为候选人 $i$ 从剩余选票中需要的最少额外票数，以保证无论其他候选人获得多少票，他们都能当选。输出 $C_1, C_2, \ldots, C_N$。

如果候选人 $i$ 已经确保当选，则 $C_i = 0$。如果候选人 $i$ 无法在任何情况下确保当选，则 $C_i = -1$。

## 说明/提示

- $1 \leq M \leq N \leq 2 \times 10^5$。
- $1 \leq K \leq 10^{12}$。
- $0 \leq A_i \leq 10^{12}$。
- $\displaystyle{\sum_{i=1}^{N} A_i} \leq K$。

## 样例 #1

### 输入

```
5 2 16
3 1 4 1 5
```

### 输出

```
2 -1 1 -1 0
```

## 样例 #2

### 输入

```
12 1 570
81 62 17 5 5 86 15 7 79 26 6 28
```

### 输出

```
79 89 111 117 117 74 112 116 80 107 117 106
```



---

---
title: "[ABC374E] Sensor Optimization Dilemma 2"
layout: "post"
diff: 普及+/提高
pid: AT_abc374_e
tag: ['数学', '二分']
---

# [ABC374E] Sensor Optimization Dilemma 2

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc374/tasks/abc374_e

ある製品の製造には $ 1,2,\dots,N $ の番号が付いた $ N $ 個の工程が必要です。

各工程 $ i $ について、それを処理する $ 2 $ 種類の機械 $ S_i,T_i $ が売られています。

- 機械 $ S_i $ : $ 1 $ 台につき $ 1 $ 日あたり製品 $ A_i $ 個分の処理ができ、 $ 1 $ 台 $ P_i $ 円で導入できる
- 機械 $ T_i $ : $ 1 $ 台につき $ 1 $ 日あたり製品 $ B_i $ 個分の処理ができ、 $ 1 $ 台 $ Q_i $ 円で導入できる

それぞれの機械は $ 0 $ 台以上何台でも導入できます。

機械の導入の結果、工程 $ i $ を $ 1 $ 日あたり製品 $ W_i $ 個分処理できるようになったとします。  
このとき、製造能力を $ W $ の最小値、すなわち $ \displaystyle\ \min^{N}_{i=1}\ W_i $ と定義します。

全体の予算が $ X $ 円のとき、達成可能な製造能力の最大値を求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ X $ $ A_1 $ $ P_1 $ $ B_1 $ $ Q_1 $ $ A_2 $ $ P_2 $ $ B_2 $ $ Q_2 $ $ \vdots $ $ A_N $ $ P_N $ $ B_N $ $ Q_N $

## 输出格式

答えを整数として出力せよ。

## 说明/提示

### 制約

- 入力は全て整数
- $ 1\ \le\ N\ \le\ 100 $
- $ 1\ \le\ A_i,B_i\ \le\ 100 $
- $ 1\ \le\ P_i,Q_i,X\ \le\ 10^7 $

### Sample Explanation 1

例えば、次の通り機械を導入することで製造能力を $ 4 $ にすることができ、これが達成可能な最大値です。 - 工程 $ 1 $ に対し機械 $ S_1 $ を $ 2 $ 台導入する。 - $ 1 $ 日あたり製品 $ 4 $ 個分の処理に相当し、導入に合計 $ 10 $ 円かかる。 - 工程 $ 2 $ に対し機械 $ S_2 $ を $ 1 $ 台導入する。 - $ 1 $ 日あたり製品 $ 1 $ 個分の処理に相当し、導入に合計 $ 1 $ 円かかる。 - 工程 $ 2 $ に対し機械 $ T_2 $ を $ 1 $ 台導入する。 - $ 1 $ 日あたり製品 $ 3 $ 個分の処理に相当し、導入に合計 $ 3 $ 円かかる。 - 工程 $ 3 $ に対し機械 $ T_3 $ を $ 2 $ 台導入する。 - $ 1 $ 日あたり製品 $ 4 $ 個分の処理に相当し、導入に合計 $ 8 $ 円かかる。

### Sample Explanation 3

正の製造能力が得られない場合もあります。

## 样例 #1

### 输入

```
3 22
2 5 3 6
1 1 3 3
1 3 2 4
```

### 输出

```
4
```

## 样例 #2

### 输入

```
1 10000000
100 1 100 1
```

### 输出

```
1000000000
```

## 样例 #3

### 输入

```
1 1
1 10000000 1 10000000
```

### 输出

```
0
```

## 样例 #4

### 输入

```
10 7654321
8 6 9 1
5 6 4 3
2 4 7 9
7 8 9 1
7 9 1 6
4 8 9 1
2 2 8 9
1 6 2 6
4 2 3 4
6 6 5 2
```

### 输出

```
894742
```



---

---
title: "[ABC379F] Buildings 2"
layout: "post"
diff: 普及+/提高
pid: AT_abc379_f
tag: ['二分', '单调栈']
---

# [ABC379F] Buildings 2

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc379/tasks/abc379_f

ビル $ 1 $, ビル $ 2 $, $ \ldots $, ビル $ N $ の $ N $ 棟がこの順で東西に一列に並んでおり、ビル $ 1 $ が最も西に、ビル $ N $ が最も東に建っています。ビル $ i\ (1\leq\ i\leq\ N) $ の高さは $ H_i $ です。

整数の組 $ (i,j)\ (1\leq\ i\lt\ j\leq\ N) $ に対して、以下の条件を満たすとき ビル $ i $ からビル $ j $ を見ることができます。

- ビル $ i $ とビル $ j $ の間にビル $ j $ より高いビルが存在しない。すなわち、$ H_k\gt\ H_j $ を満たす整数 $ k\ (i\lt\ k\lt\ j) $ が存在しない。

$ Q $ 個の質問に答えてください。$ i $ 番目の質問では整数の組 $ (l_i,r_i)\ (l_i\lt\ r_i) $ が与えられるので、ビル $ r_i $ より東にあるビル（ビル $ r_i+1 $, ビル $ r_i+2 $,$ \ldots $,ビル $ N $ ）のうちビル $ l_i $ とビル $ r_i $ の両方から見ることができるものの個数を答えてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ Q $ $ H_1 $ $ H_2 $ $ \ldots $ $ H_N $ $ l_1 $ $ r_1 $ $ l_2 $ $ r_2 $ $ \vdots $ $ l_Q $ $ r_Q $

## 输出格式

$ Q $ 行出力せよ。$ i\ (1\leq\ i\leq\ Q) $ 行目には $ i $ 番目の質問に対する答えを出力せよ。

## 说明/提示

### 制約

- $ 2\leq\ N\leq\ 2\times\ 10^5 $
- $ 1\leq\ Q\leq\ 2\times\ 10^5 $
- $ 1\leq\ H_i\leq\ N $
- $ H_i\neq\ H_j\ (i\neq\ j) $
- $ 1\leq\ l_i\lt\ r_i\leq\ N $
- 入力は全て整数

### Sample Explanation 1

\- $ 1 $ つ目の質問について、ビル $ 2 $ より東にあるビルのうち ビル $ 1 $ とビル $ 2 $ の両方から見ることができるものはビル $ 3,5 $ の $ 2 $ つです。 - $ 2 $ つ目の質問について、ビル $ 5 $ より東にあるビルは存在しません。 - $ 3 $ つ目の質問について、ビル $ 4 $ より東にあるビルのうち、ビル $ 1,4 $ の両方から見ることができるビルはビル $ 5 $ の $ 1 $ つです。

## 样例 #1

### 输入

```
5 3
2 1 4 3 5
1 2
3 5
1 4
```

### 输出

```
2
0
1
```

## 样例 #2

### 输入

```
10 10
2 1 5 3 4 6 9 8 7 10
3 9
2 5
4 8
5 6
3 8
2 10
7 8
6 7
8 10
4 10
```

### 输出

```
1
3
1
2
1
0
1
1
0
0
```



---

---
title: "[ABC381E] 11/22 Subsequence"
layout: "post"
diff: 普及+/提高
pid: AT_abc381_e
tag: ['二分', '前缀和']
---

# [ABC381E] 11/22 Subsequence

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc381/tasks/abc381_e

> この問題における 11/22 文字列の定義は A 問題および C 問題と同じです。

文字列 $ T $ が以下の条件を全て満たすとき、$ T $ を **11/22 文字列** と呼びます。

- $ |T| $ は奇数である。ここで、$ |T| $ は $ T $ の長さを表す。
- $ 1 $ 文字目から $ \frac{|T|+1}{2}\ -\ 1 $ 文字目までが `1` である。
- $ \frac{|T|+1}{2} $ 文字目が `/` である。
- $ \frac{|T|+1}{2}\ +\ 1 $ 文字目から $ |T| $ 文字目までが `2` である。

例えば `11/22`, `111/222`, `/` は 11/22 文字列ですが、`1122`, `1/22`, `11/2222`, `22/11`, `//2/2/211` はそうではありません。

`1`, `2`, `/` からなる長さ $ N $ の文字列 $ S $ が与えられるので、$ Q $ 個のクエリを処理してください。

各クエリでは $ L $, $ R $ が与えられます。$ S $ の $ L $ 文字目から $ R $ 文字目までからなる **(連続な)** 部分文字列を $ T $ としたとき、 11/22 文字列であるような $ T $ の **(連続とは限らない)** 部分列の長さの最大値を求めてください。そのような部分列が存在しないときは `0` を出力してください。

## 输入格式

入力は以下の形式で標準入力から与えられる。ここで $ \mathrm{query}_i $ は $ i $ 番目のクエリを意味する。

> $ N $ $ Q $ $ S $ $ \mathrm{query}_1 $ $ \mathrm{query}_2 $ $ \vdots $ $ \mathrm{query}_Q $

各クエリは以下の形式で与えられる。

> $ L $ $ R $

## 输出格式

$ Q $ 行出力せよ。$ i $ 行目には $ i $ 番目のクエリへの答えを出力せよ。

## 说明/提示

### 制約

- $ 1\ \leq\ N\ \leq\ 10^5 $
- $ 1\ \leq\ Q\ \leq\ 10^5 $
- $ S $ は `1`, `2`, `/` からなる長さ $ N $ の文字列
- $ 1\ \leq\ L\ \leq\ R\ \leq\ N $
- $ N,\ Q,\ L,\ R $ は整数

### Sample Explanation 1

$ 1 $ 番目のクエリについて、$ S $ の $ 1 $ 文字目から $ 7 $ 文字目からなる部分文字列は `111/212` です。この文字列は `11/22` を部分列として含み、これは 11/22 文字列であるような部分列として最大です。よって答えは $ 5 $ です。 $ 2 $ 番目のクエリについて、$ S $ の $ 9 $ 文字目から $ 12 $ 文字目からなる部分文字列は `1122` です。この文字列は 11/22 文字列であるような部分列を含まないので、答えは $ 0 $ です。

## 样例 #1

### 输入

```
12 5
111/212/1122
1 7
9 12
3 6
4 10
1 12
```

### 输出

```
5
0
3
1
7
```



---

---
title: "[ABC385D] Santa Claus 2"
layout: "post"
diff: 普及+/提高
pid: AT_abc385_d
tag: ['线段树', '二分']
---

# [ABC385D] Santa Claus 2

## 题目描述

在二次元平面上有 $N$ 个点 $(X_1,Y_1),\ldots,(X_N,Y_N)$ 建有房子。

最初，圣诞老人在点 $(S_x,S_y)$。圣诞老人将按照序列 $(D_1,C_1),\ldots,(D_M,C_M)$ 进行以下行动：

- 对于 $i=1,2,\ldots,M$，按顺序进行以下移动：
  - 设 $(x,y)$ 为他当前所在的点。
      - 如果 $D_i$ 是 `U`，则从 $(x,y)$ 沿直线移动到 $(x,y+C_i)$。
      - 如果 $D_i$ 是 `D`，则从 $(x,y)$ 沿直线移动到 $(x,y-C_i)$。
      - 如果 $D_i$ 是 `L`，则从 $(x,y)$ 沿直线移动到 $(x-C_i,y)$。
      - 如果 $D_i$ 是 `R`，则从 $(x,y)$ 沿直线移动到 $(x+C_i,y)$。

请找出他完成所有行动后所在的点，以及他在行动过程中经过或到达的不同房子的数量。如果多次经过同一个房子，只计数一次。

## 输入格式

输入从标准输入按以下格式给出：

> $N$ $M$ $S_x$ $S_y$  
$X_1$ $Y_1$  
$\dots$  
$X_N$ $Y_N$  
$D_1$ $C_1$  
$\dots$  
$D_M$ $C_M$

## 输出格式

设 $(X,Y)$ 为他完成所有行动后所在的点，$C$ 为他在行动过程中经过或到达的不同房子的数量。按顺序输出用空格分隔的 $X$、$Y$、$C$。

## 说明/提示

- $1 \leq N \leq 2\times 10^5$
- $1 \leq M \leq 2\times 10^5$
- $-10^9 \leq X_i,Y_i \leq 10^9$
- $(X_i,Y_i)$ 互不相同
- $-10^9 \leq S_x,S_y \leq 10^9$
- 点 $(S_x,S_y)$ 没有房子
- 每个 $D_i$ 是 `U`、`D`、`L`、`R` 之一
- $1 \leq C_i \leq 10^9$
- 所有给定数字均为整数

**【样例 #1 解释】**

圣诞老人的行动如下图所示：

![](https://img.atcoder.jp/abc385/f3d0f313d3b20c135af60ca6eb04900d.png)

- $D_1=$ `L`，所以他从 $(3,2)$ 直线移动到 $(3-2,2)$。在此期间，他经过 $(2,2)$ 处的房子。
- $D_2=$ `D`，所以他从 $(1,2)$ 直线移动到 $(1,2-1)$。
- $D_3=$ `R`，所以他从 $(1,1)$ 直线移动到 $(1+1,1)$。在此期间，他经过 $(2,1)$ 处的房子。
- $D_4=$ `U`，所以他从 $(2,1)$ 直线移动到 $(2,1+2)$。在此期间，他经过 $(2,2)$ 处的房子，但该房子已经被经过。

他在行动期间经过或到达的房子数量为 $2$。

**【样例 #2 解释】**

小心溢出。

## 样例 #1

### 输入

```
3 4 3 2
2 2
3 3
2 1
L 2
D 1
R 1
U 2
```

### 输出

```
2 3 2
```

## 样例 #2

### 输入

```
1 3 0 0
1 1
R 1000000000
R 1000000000
R 1000000000
```

### 输出

```
3000000000 0 0
```



---

---
title: "[ABC393F] Prefix LIS Query"
layout: "post"
diff: 普及+/提高
pid: AT_abc393_f
tag: ['二分', '离线处理']
---

# [ABC393F] Prefix LIS Query

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc393/tasks/abc393_f

给定一个长度为 $ N $ 的整数序列 $ A=(A_1,A_2,\dots,A_N) $。

请处理 $ Q $ 个查询。第 $ i\ (1 \leq i \leq Q) $ 个查询如下：

- 给定整数 $ R_i $ 和 $ X_i $。求数列 $ (A_1,A_2,\dots,A_{R_i}) $ 的（不一定连续的）子序列中，满足严格单调递增且所有元素不超过 $ X_i $ 的最长长度。保证 $ X_i \geq \min\{ A_1, A_2, \dots, A_{R_i} \} $。

## 输入格式

输入通过标准输入给出，格式如下：

> $ N $ $ Q $  
> $ A_1 $ $ A_2 $ $ \dots $ $ A_N $  
> $ R_1 $ $ X_1 $  
> $ R_2 $ $ X_2 $  
> $ \vdots $  
> $ R_Q $ $ X_Q $  

## 输出格式

输出 $ Q $ 行。第 $ i\ (1 \leq i \leq Q) $ 行输出第 $ i $ 个查询的答案。

## 说明/提示

### 约束条件

- $ 1 \leq N, Q \leq 2 \times 10^5 $
- $ 1 \leq A_i \leq 10^9 $
- $ 1 \leq R_i \leq N $
- $ \min\{ A_1, A_2, \dots, A_{R_i} \} \leq X_i \leq 10^9 $
- 输入中所有值均为整数

### 样例解释 1

- **第 1 个查询**：数列 $ (2,4) $ 中严格单调递增且所有元素不超过 $ 5 $ 的最长子序列长度为 $ 2 $。具体来说，子序列 $ (2,4) $ 满足条件。
- **第 2 个查询**：数列 $ (2,4,1,3,3) $ 中严格单调递增且所有元素不超过 $ 2 $ 的最长子序列长度为 $ 1 $。具体来说，子序列 $ (2) $ 或 $ (1) $ 满足条件。
- **第 3 个查询**：数列 $ (2,4,1,3,3) $ 中严格单调递增且所有元素不超过 $ 3 $ 的最长子序列长度为 $ 2 $。具体来说，子序列 $ (2,3) $ 或 $ (1,3) $ 满足条件。

翻译由 DeepSeek R1 完成

## 样例 #1

### 输入

```
5 3

2 4 1 3 3

2 5

5 2

5 3
```

### 输出

```
2

1

2
```

## 样例 #2

### 输入

```
10 8

2 5 6 5 2 1 7 9 7 2

7 8

5 2

2 3

2 6

7 3

8 9

9 6

8 7
```

### 输出

```
4

1

1

2

1

5

3

4
```



---

---
title: "[ABC395F] Smooth Occlusion"
layout: "post"
diff: 普及+/提高
pid: AT_abc395_f
tag: ['贪心', '二分']
---

# [ABC395F] Smooth Occlusion

## 题目描述

高桥君共有 $2N$ 颗牙齿，其中 $N$ 颗是上牙，剩余的 $N$ 颗是下牙。

左数第 $i$ 颗（$1 \leq i \leq N$）上牙的长度为 $U_i$，左数第 $i$ 颗（$1 \leq i \leq N$）下牙的长度为 $D_i$。

当高桥君的牙齿满足以下两个条件时，称为「良好咬合」：
1. 存在一个整数 $H$，使得对于所有 $1 \leq i \leq N$，有 $U_i + D_i = H$。
2. 对于所有 $1 \leq i < N$，有 $|U_i - U_{i+1}| \leq X$。

高桥君可以执行以下操作任意次：
- 支付 $1$ 日元使用磨牙工具，选择一个长度为正的牙齿，将其长度减少 $1$。

除上述操作外，无法通过其他方式改变牙齿长度。请计算高桥君达成良好咬合所需支付的最小金额。

## 输入格式

输入通过标准输入给出，格式如下：

> $N$ $X$  
> $U_1$ $D_1$  
> $U_2$ $D_2$  
> $\vdots$  
> $U_N$ $D_N$

## 输出格式

输出达成良好咬合所需的最小金额。

## 说明/提示

### 约束条件
- $2 \leq N \leq 2 \times 10^5$
- $1 \leq U_i \leq 10^9$（$1 \leq i \leq N$）
- $1 \leq D_i \leq 10^9$（$1 \leq i \leq N$）
- $1 \leq X \leq 10^9$
- 输入均为整数

### 样例解释 1
初始牙齿长度示意图（图片链接略）。通过以下调整可达成良好咬合（调整后示意图略），总成本为 $15$ 日元。无法以 $14$ 日元或更少达成，因此输出 `15`。

### 样例解释 2
存在牙齿初始状态已满足良好咬合的情况。

### 样例解释 3
答案可能超过 32 位整数范围，需注意处理大数。

翻译由 DeepSeek R1 完成

## 样例 #1

### 输入

```
4 3

3 1

4 1

5 9

2 6
```

### 输出

```
15
```

## 样例 #2

### 输入

```
4 1000000000

3 3

3 3

3 3

3 3
```

### 输出

```
0
```

## 样例 #3

### 输入

```
4 1

1000000000 1000000000

1000000000 1000000000

1000000000 1000000000

1 1
```

### 输出

```
5999999994
```

## 样例 #4

### 输入

```
15 128

748 169

586 329

972 529

432 519

408 587

138 249

656 114

632 299

984 755

404 772

155 506

832 854

353 465

387 374

567 385
```

### 输出

```
9460
```



---

---
title: "[ABC398E] Tree Game"
layout: "post"
diff: 普及+/提高
pid: AT_abc398_e
tag: ['博弈论', '二分图']
---

# [ABC398E] Tree Game

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc398/tasks/abc398_e

本题是一道**交互题**（你的程序需要通过输入输出与评测系统进行交互）。

给定一棵包含 $N$ 个顶点的树 $G$，顶点编号为 $1$ 至 $N$。第 $i$ 条边连接顶点 $U_i$ 和 $V_i$。

你和高桥君将使用这棵树 $G$ 进行游戏。首先，你选择先手或后手。之后，双方轮流进行以下操作（先手先行动）：

- 选择一个满足 $1 \leq i < j \leq N$ 的整数对 $(i, j)$，并满足以下两个条件：
  - $G$ 中当前不存在连接顶点 $i$ 和顶点 $j$ 的边。
  - 在 $G$ 中添加连接顶点 $i$ 和顶点 $j$ 的边后，不会形成奇环。
- 将该边添加到 $G$ 中。

无法进行操作的一方判负，另一方获胜。请通过实际与高桥君对弈取得胜利。

**奇环的定义**：顶点序列 $(v_0, v_1, \ldots, v_k)$ 满足以下所有条件时，称为 $G$ 的一个奇环：
- $k$ 为奇数。
- $v_0 = v_k$。
- 对所有 $1 \leq i \leq k$，存在连接 $v_{i-1}$ 和 $v_i$ 的边。
### 交互方式

本题是一道交互题，你的程序需通过标准输入输出与评测系统交互。

首先，通过标准输入接收 $N$ 及 $G$ 的信息，格式如下：

> $N$  
> $U_1$ $V_1$  
> $U_2$ $V_2$  
> $\vdots$  
> $U_{N-1}$ $V_{N-1}$  

接着，你需决定选择先手或后手。若选择先手，通过标准输出输出 `First`；若选择后手，输出 `Second`。

此后游戏开始。

你的回合时，需将选择的整数对 $(i, j)$ 按顺序以空格分隔输出至标准输出：

> $i$ $j$

高桥君的回合时，将通过标准输入给出两个整数 $i$ 和 $j$：

> $i$ $j$

当 $(i, j) = (-1, -1)$ 时，表示你已获胜且游戏结束，此时需立即终止程序。  
其他情况下，$(i, j)$ 表示高桥君选择的整数对。

## 输入格式

见「交互方式」。

## 输出格式

见「交互方式」。

## 说明/提示

### 约束条件

- $2 \leq N \leq 100$
- $1 \leq U_i < V_i \leq N$
- 给定的图是树。
- 输入均为整数。

### 注意事项

- $\footnotesize\color{red}\textsf{\textbf{每次输出后，需在末尾添加换行符并刷新标准输出缓冲区。否则可能导致评测结果为 \colorbox{#f0ad4e}{\color{white}{TLE}}。}}$
- **若在交互过程中输出格式错误或程序意外终止，评测结果将不确定。**
- 游戏结束后请立即终止程序，否则评测结果不确定。

### 交互示例

|输入|输出|解释|
|:-|:-|:-|
|$\begin{matrix} \texttt{4 { }} \\ \texttt{1 2} \\ \texttt{2 3} \\ \texttt{3 4} \end{matrix}$| |首先，你收到 $N$ 和 $G$ 的边信息。|
||$\texttt{First}$|你选择先手行动。|
||$\texttt{1 4}$|你在顶点 $1$ 和 $4$ 之间添加一条边|
|$\texttt{-1 -1}$||高桥无法继续操作，你获胜。评测结果返回 $\colorbox{#5cb85c}{\footnotesize\textsf{\textbf{\color{white}{AC}}}}$。|



---

---
title: "[ABC401F] Add One Edge 3"
layout: "post"
diff: 普及+/提高
pid: AT_abc401_f
tag: ['二分', '树的直径']
---

# [ABC401F] Add One Edge 3

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc401/tasks/abc401_f

给定两棵树：
- 树 1 包含 $N_1$ 个顶点，编号为 $1$ 到 $N_1$
- 树 2 包含 $N_2$ 个顶点，编号为 $1$ 到 $N_2$

树 1 的第 $i$ 条边双向连接顶点 $u_{1,i}$ 和 $v_{1,i}$，树 2 的第 $i$ 条边双向连接顶点 $u_{2,i}$ 和 $v_{2,i}$。

如果在树 1 的顶点 $i$ 和树 2 的顶点 $j$ 之间添加一条双向边，将得到一棵新的树。定义这棵新树的直径为 $f(i,j)$。

请计算 $\displaystyle\sum_{i=1}^{N_1}\sum_{j=1}^{N_2} f(i,j)$ 的值。

其中：
- 两顶点之间的距离定义为它们之间最短路径的边数
- 树的直径定义为所有顶点对之间距离的最大值

## 输入格式

输入通过标准输入给出，格式如下：

> $N_1$  
> $u_{1,1}$ $v_{1,1}$  
> $\vdots$  
> $u_{1,N_1-1}$ $v_{1,N_1-1}$  
> $N_2$  
> $u_{2,1}$ $v_{2,1}$  
> $\vdots$  
> $u_{2,N_2-1}$ $v_{2,N_2-1}$

## 输出格式

输出计算结果。


## 说明/提示

### 约束条件

- $1 \leq N_1, N_2 \leq 2 \times 10^5$
- $1 \leq u_{1,i}, v_{1,i} \leq N_1$
- $1 \leq u_{2,i}, v_{2,i} \leq N_2$
- 输入的两张图都是树
- 输入的所有数值均为整数

### 样例解释 1

例如，当连接树 1 的顶点 2 和树 2 的顶点 3 时，得到的新树直径为 5，因此 $f(2,3)=5$。所有 $f(i,j)$ 的总和为 39。

翻译由 DeepSeek V3 完成

## 样例 #1

### 输入

```
3
1 3
1 2
3
1 2
3 1
```

### 输出

```
39
```

## 样例 #2

### 输入

```
7
5 6
1 3
5 7
4 5
1 6
1 2
5
5 3
2 4
2 3
5 1
```

### 输出

```
267
```



---

---
title: "[ABC402F] Path to Integer"
layout: "post"
diff: 普及+/提高
pid: AT_abc402_f
tag: ['搜索', '贪心', '二分', '双指针 two-pointer', '折半搜索 meet in the middle']
---

# [ABC402F] Path to Integer

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc402/tasks/abc402_f

有一个 $N$ 行 $N$ 列的网格。从上往下第 $i$ 行、从左往右第 $j$ 列的格子记作格子 $(i,j)$。每个格子上都写有 `1` 到 `9` 的数字，格子 $(i,j)$ 上写的数字是 $A_{i,j}$。

初始时，棋子位于格子 $(1,1)$。同时，设 $S$ 为空字符串，接下来进行 $2N-1$ 次操作：

1. 将当前棋子所在格子的数字追加到 $S$ 的末尾。
2. 将棋子向右或向下移动一格（第 $2N-1$ 次操作时不移动）。

$2N-1$ 次操作后，棋子将位于格子 $(N,N)$，且 $S$ 的长度为 $2N-1$。

将最终得到的字符串 $S$ 视为整数，其值对 $M$ 取模的结果即为得分。

请计算可以获得的最高得分。

## 输入格式

输入通过标准输入给出，格式如下：

> $N$ $M$  
> $A_{1,1}$ $A_{1,2}$ $\ldots$ $A_{1,N}$  
> $A_{2,1}$ $A_{2,2}$ $\ldots$ $A_{2,N}$  
> $\vdots$  
> $A_{N,1}$ $A_{N,2}$ $\ldots$ $A_{N,N}$


## 输出格式

输出答案。


## 说明/提示

### 约束条件

- $1 \leq N \leq 20$
- $2 \leq M \leq 10^9$
- $1 \leq A_{i,j} \leq 9$
- 输入中的所有数值均为整数

### 样例解释 1

棋子的移动方式有以下两种：
1. 按 $(1,1)\rightarrow(1,2)\rightarrow(2,2)$ 的顺序移动。此时 $S=$ `121`，得分为 $121 \bmod 7 = 2$。
2. 按 $(1,1)\rightarrow(2,1)\rightarrow(2,2)$ 的顺序移动。此时 $S=$ `131`，得分为 $131 \bmod 7 = 5$。

最高得分为 5，因此输出 5。

翻译由 DeepSeek V3 完成

## 样例 #1

### 输入

```
2 7
1 2
3 1
```

### 输出

```
5
```

## 样例 #2

### 输入

```
3 100000
1 2 3
3 5 8
7 1 2
```

### 输出

```
13712
```

## 样例 #3

### 输入

```
5 402
8 1 3 8 9
8 2 4 1 8
4 1 8 5 9
6 2 1 6 7
6 6 7 7 6
```

### 输出

```
384
```



---

---
title: "[AGC039B] Graph Partition"
layout: "post"
diff: 普及+/提高
pid: AT_agc039_b
tag: ['最短路', '二分图']
---

# [AGC039B] Graph Partition

## 题目描述

给定一张 $N$ 个顶点，$M$ 条边的无向连通图。  
顶点以 $1\ldots N$ 编号，边以仅包含 $\texttt{0/1}$ 的邻接矩阵的形式给出。

请判断是否能够将顶点分为 $k$ 个非空集合 $V_1,\ldots,V_k$，使得其满足以下条件。若可以，则最大化 $k$：
 - 对于每条边 $(i,j)$，存在 $1 \le t \le k-1$ 满足 $i \in V_t, j \in V_{t+1}$ 或 $i \in V_{t+1}, j \in V_t$。

## 输入格式

第一行，一个正整数 $N$。  
以下 $N$ 行，每行一个长度为 $N$ 的 $\texttt{0/1}$ 串，表示邻接矩阵。

## 输出格式

如果无法找到一种划分方案满足上述条件，输出 $-1$。  
否则输出所有方案中最大的 $k$。

## 说明/提示

### 数据限制
- $N \in [2,200] \bigcap \mathbb Z$。
- 邻接矩阵仅由 $\texttt0$ 与 $\texttt1$ 组成。
- 邻接矩阵关于主对角线对称。
- 邻接矩阵主对角线均为 $\texttt0$（无自环）。
- 图一定连通。

#### 样例解释 #1
可以分别将顶点 $1,2$ 分入 $V_1,V_2$。

## 样例 #1

### 输入

```
2

01

10
```

### 输出

```
2
```

## 样例 #2

### 输入

```
3

011

101

110
```

### 输出

```
-1
```

## 样例 #3

### 输入

```
6

010110

101001

010100

101000

100000

010000
```

### 输出

```
4
```



---

---
title: "[ARC158C] All Pair Digit Sums"
layout: "post"
diff: 普及+/提高
pid: AT_arc158_c
tag: ['数学', '二分']
---

# [ARC158C] All Pair Digit Sums

## 题目描述

[problemUrl]: https://atcoder.jp/contests/arc158/tasks/arc158_c

正整数 $ x $ に対し，その各桁の和を $ f(x) $ と表すことにします．例えば $ f(158)\ =\ 1\ +\ 5\ +\ 8\ =\ 14 $，$ f(2023)\ =\ 2\ +\ 0\ +\ 2\ +\ 3\ =\ 7 $，$ f(1)\ =\ 1 $ です．

正整数列 $ A\ =\ (A_1,\ \ldots,\ A_N) $ が与えられます．$ \sum_{i=1}^N\sum_{j=1}^N\ f(A_i\ +\ A_j) $ を求めてください．

## 输入格式

入力は以下の形式で標準入力から与えられます．

> $ N $ $ A_1 $ $ \ldots $ $ A_N $

## 输出格式

$ \sum_{i=1}^N\sum_{j=1}^N\ f(A_i\ +\ A_j) $ を出力してください．

## 说明/提示

### 制約

- $ 1\leq\ N\leq\ 2\times\ 10^5 $
- $ 1\leq\ A_i\ <\ 10^{15} $
 
### Sample Explanation 1

$ \sum_{i=1}^N\sum_{j=1}^N\ f(A_i\ +\ A_j)\ =\ f(A_1+A_1)+f(A_1+A_2)+f(A_2+A_1)+f(A_2+A_2)=7+9+9+11=36 $ です．

### Sample Explanation 2

$ \sum_{i=1}^N\sum_{j=1}^N\ f(A_i\ +\ A_j)\ =\ f(A_1+A_1)\ =\ 135 $ です．

## 样例 #1

### 输入

```
2

53 28
```

### 输出

```
36
```

## 样例 #2

### 输入

```
1

999999999999999
```

### 输出

```
135
```

## 样例 #3

### 输入

```
5

123 456 789 101 112
```

### 输出

```
321
```



---

---
title: "[ARC165B] Sliding Window Sort 2"
layout: "post"
diff: 普及+/提高
pid: AT_arc165_b
tag: ['贪心', '二分']
---

# [ARC165B] Sliding Window Sort 2

## 题目描述

[problemUrl]: https://atcoder.jp/contests/arc165/tasks/arc165_b

$ 1 $ から $ N $ までの整数からなる順列 $ P=(P_1,P_2,\dots,P_N) $ と整数 $ K $ が与えられます。

順列 $ P $ に対して以下のような操作を考えます。

- $ 1\ \leq\ i\ \leq\ N-K+1 $ を満たす整数 $ i $ を $ 1 $ つ選び、 $ P_i,P_{i+1},\dots,P_{i+K-1} $ を昇順に並び替える。すなわち、$ P_i,P_{i+1},\dots,P_{i+K-1} $ を小さい方から順に並べたものを $ (x_1,x_2,\dots,x_K) $ としたとき、各 $ 1\ \leq\ j\ \leq\ K $ に対して $ P_{i+j-1} $ を $ x_j $ で置き換える。
 
$ P $ に対して上記の操作をちょうど $ 1 $ 回行うことで得られる順列のうち、辞書式順序最大のものを求めてください。

  数列の辞書順とは？数列 $ S\ =\ (S_1,S_2,\ldots,S_{|S|}) $ が数列 $ T\ =\ (T_1,T_2,\ldots,T_{|T|}) $ より**辞書順で小さい**とは、下記の 1. と 2. のどちらかが成り立つことを言います。 ここで、$ |S|,\ |T| $ はそれぞれ $ S,\ T $ の長さを表します。

1. $ |S|\ \lt\ |T| $ かつ $ (S_1,S_2,\ldots,S_{|S|})\ =\ (T_1,T_2,\ldots,T_{|S|}) $。
2. ある整数 $ 1\ \leq\ i\ \leq\ \min\lbrace\ |S|,\ |T|\ \rbrace $ が存在して、下記の $ 2 $ つがともに成り立つ。 
  - $ (S_1,S_2,\ldots,S_{i-1})\ =\ (T_1,T_2,\ldots,T_{i-1}) $
  - $ S_i $ が $ T_i $ より（数として）小さい。

## 输入格式

入力は以下の形式で標準入力から与えられます。

> $ N $ $ K $ $ P_1 $ $ P_2 $ $ \dots $ $ P_N $

## 输出格式

$ P $ に対して操作をちょうど $ 1 $ 回行うことで得られる順列のうち、辞書式順序で最大のものを空白区切りで出力してください。

## 说明/提示

### 制約

- $ 1\ \leq\ K\ \leq\ N\ \leq\ 2\ \times\ 10^5 $
- $ 1\ \leq\ P_i\ \leq\ N $
- $ (P_1,P_2,\dots,P_N) $ は $ 1 $ から $ N $ までの整数からなる順列
- 入力される値はすべて整数
 
### Sample Explanation 1

$ i=1 $ として操作を行うと $ (P_1,P_2,P_3)=(2,1,4) $ であり、これを昇順に並び替えると $ (1,2,4) $ となります。よって操作によって $ P_1,P_2,P_3 $ はそれぞれ $ 1,2,4 $ に置き換えられ、 $ P=(1,2,4,3) $ となります。同様に $ i=2 $ として操作を行うと $ P $ は $ (2,1,3,4) $ となります。 これらのうち辞書式順序で大きいのは $ (2,1,3,4) $ であるため、答えは $ (2,1,3,4) $ となります。

## 样例 #1

### 输入

```
4 3

2 1 4 3
```

### 输出

```
2 1 3 4
```

## 样例 #2

### 输入

```
5 1

3 1 4 2 5
```

### 输出

```
3 1 4 2 5
```

## 样例 #3

### 输入

```
20 7

9 4 3 1 11 12 13 15 17 7 2 5 6 20 19 18 8 16 14 10
```

### 输出

```
9 4 3 1 11 12 13 15 17 7 2 5 6 8 18 19 20 16 14 10
```



---

---
title: "[ARC165C] Social Distance on Graph"
layout: "post"
diff: 普及+/提高
pid: AT_arc165_c
tag: ['贪心', '二分', '生成树', '二分图']
---

# [ARC165C] Social Distance on Graph

## 题目描述

[problemUrl]: https://atcoder.jp/contests/arc165/tasks/arc165_c

頂点に $ 1 $ から $ N $ の番号が付いた $ N $ 頂点からなる単純連結無向グラフがあります。グラフには重みを持つ辺が $ M $ 本あり、$ i $ 番目の辺は頂点 $ A_i,B_i $ を結ぶ重みが $ W_i $ の辺です。また、$ 2 $ 頂点を結ぶ単純パスの重みを、単純パスが含む辺の重みの総和とします。

各頂点に対し赤、青のいずれかの色を塗ります。以下の条件を満たす塗り分け方が存在するような整数 $ X $ の最大値を求めてください。

- 同じ色で塗られた相異なる $ 2 $ 頂点を結ぶどの単純パスについても、単純パスの重みは $ X $ 以上である。
 
  単純パスとは グラフ $ G $ 上の頂点 $ X,Y $ に対して、頂点列 $ v_1,v_2,\ \ldots,\ v_k $ であって、 $ v_1=X $, $ v_k=Y $ かつ、$ 1\leq\ i\leq\ k-1 $ に対して $ v_i $ と $ v_{i+1} $ が辺で結ばれているようなものを頂点 $ X $ から頂点 $ Y $ への **ウォーク** と呼びます。 さらに、$ v_1,v_2,\ \ldots,\ v_k $ がすべて異なるようなものを頂点 $ X $ から頂点 $ Y $ への **単純パス** (あるいは単に **パス**) と呼びます。

## 输入格式

入力は以下の形式で標準入力から与えられます。

> $ N $ $ M $ $ A_1 $ $ B_1 $ $ W_1 $ $ A_2 $ $ B_2 $ $ W_2 $ $ \vdots $ $ A_M $ $ B_M $ $ W_M $

## 输出格式

答えを出力してください。

## 说明/提示

### 制約

- $ 3\ \leq\ N\ \leq\ 2\ \times\ 10^5 $
- $ N-1\ \leq\ M\ \leq\ \min(\frac{N(N-1)}{2},2\ \times\ 10^5) $
- $ 1\ \leq\ A_i\ <\ B_i\ \leq\ N $
- $ 1\ \leq\ W_i\ \leq\ 10^9 $
- 与えられるグラフは単純連結無向グラフ
- 入力される値はすべて整数
 
### Sample Explanation 1

$ X=11 $ としたときに条件を満たす色の塗り方が存在するか考えます。頂点 $ 1,3 $ を赤、頂点 $ 2 $ を青で塗った場合、同じ色の頂点を結ぶ単純パス $ 1-2-3 $ の重みが $ 5+6=11 $ となります。これが同じ色の頂点を結ぶ単純パスの重みの最小値となるのでこの塗り分け方は条件を満たしています。 $ X $ が $ 12 $ 以上のとき、条件を満たす塗り分け方が存在しないことが示せます。よって答えは $ 11 $ となります。

## 样例 #1

### 输入

```
3 3

1 2 5

2 3 6

1 3 12
```

### 输出

```
11
```

## 样例 #2

### 输入

```
10 20

7 10 982219000

3 10 968366179

2 4 992330437

5 6 984414664

2 8 897295423

7 9 155604979

6 8 958833005

2 3 973209957

3 7 985173062

6 10 963895817

2 10 986243534

4 5 721724794

1 3 657562445

1 6 566370694

1 4 988050146

1 9 967817807

4 9 796531581

5 9 983960054

1 10 964450079

8 9 959369491
```

### 输出

```
952136560
```

## 样例 #3

### 输入

```
10 20

5 6 871895994

8 10 873709822

3 5 454175869

6 10 980782191

2 6 901290987

1 8 298092290

4 8 693116157

4 5 947939338

7 8 934395075

7 9 759563833

5 8 779870031

4 6 919637355

2 9 822858749

4 10 855497285

3 7 954942051

1 2 950411658

4 7 665939990

3 4 634533617

5 7 908372507

1 9 591466693
```

### 输出

```
759563833
```



---

---
title: "[ARC169B] Subsegments with Small Sums"
layout: "post"
diff: 普及+/提高
pid: AT_arc169_b
tag: ['动态规划 DP', '二分']
---

# [ARC169B] Subsegments with Small Sums

## 题目描述

给定一个正整数 $S$。对于正整数序列 $x$ ，我们定义函数 $f(x)$ 如下:

- 将 $x$ 分解为几个连续的子序列。对于每个连续子序列，其元素之和最多为 $S$。$f(x)$ 是在这样的要求下分解成的连续子序列的最小数目。

现在给定一个长度为 $N$ 的正整数序列 $A=(A_1,A_2,\cdots,A_N)$，请求出 $\sum_{1 \leq l \leq r \leq N} f((A_l,A_{l+1},\cdots,A_r))$。

## 输入格式

第一行两个整数 $N$ 和 $S$。

第二行 $N$ 个整数表示序列 $A$。

## 输出格式

一行一个整数 $\sum_{1 \leq l \leq r \leq N} f((A_l,A_{l+1},\cdots,A_r))$。

## 说明/提示

$1 \leq N \leq 250000$，$1 \leq S \leq 10^{15}$，$1 \leq A_i \leq \min(S,10^9)$，所有输入都是整数。

样例一解释：

样例中 $x=(1,2,3)$。分解方案 $(1,2),(3)$ 满足条件，可以证明没有分解成少于两个连续子序列的方案满足条件，所以 $f((1,2,3))=2$。

下面显示的是可能的 $l,r$ 和对应的 $f$ 值:

-  $(l,r)=(1,1)$：$f((1))=1$
-  $(l,r)=(1,2)$：$f((1,2))=1$
-  $(l,r)=(1,3)$：$f((1,2,3))=2$
-  $(l,r)=(2,2)$：$f((2))=1$
-  $(l,r)=(2,3)$：$f((2,3))=2$
-  $(l,r)=(3,3)$：$f((3))=1$

因此，答案是$1+1+2+1+2+1=8$。

## 样例 #1

### 输入

```
3 3

1 2 3
```

### 输出

```
8
```

## 样例 #2

### 输入

```
5 1

1 1 1 1 1
```

### 输出

```
35
```

## 样例 #3

### 输入

```
5 15

5 4 3 2 1
```

### 输出

```
15
```

## 样例 #4

### 输入

```
20 1625597454

786820955 250480341 710671229 946667801 19271059 404902145 251317818 22712439 520643153 344670307 274195604 561032101 140039457 543856068 521915711 857077284 499774361 419370025 744280520 249168130
```

### 输出

```
588
```



---

---
title: "Largest N"
layout: "post"
diff: 普及+/提高
pid: AT_nikkei2019_2_final_c
tag: ['动态规划 DP', '二分', 'ST 表']
---

# Largest N

## 题目描述

[problemUrl]: https://atcoder.jp/contests/nikkei2019-2-final/tasks/nikkei2019_2_final_c

$ H $ 行 $ W $ 列 のマス目があり、それぞれのマスは黒または白で塗られています。上から $ i $ 行目、左から $ j $ 列目のマスをマス $ (i,\ j) $ と呼びます。

マス $ (a_i,\ b_i)\ (1\ \leq\ i\ \leq\ K) $ は白で塗られており、それ以外の $ H\ \times\ W\ -\ K $ マスは黒で塗られています。

$ 1 $ 以上の整数 $ k $ に対してマス目がサイズ $ k $ の `N` を含むとは、次の条件をみたす整数 $ i,\ j $ が存在することを言います。

- マス $ (i\ +\ t,\ j)\ (0\ \leq\ t\ <\ k) $ がすべて黒
- マス $ (i\ +\ t,\ j\ +\ t)\ (0\ \leq\ t\ <\ k) $ がすべて黒
- マス $ (i\ +\ t,\ j\ +\ k\ -\ 1)\ (0\ \leq\ t\ <\ k) $ がすべて黒

ただし、この条件に関わる全てのマスが $ H $ 行 $ W $ 列のマス目に含まれなければなりません。

このマス目に含まれる `N` のサイズの最大値を求めてください。ただし、どのサイズの `N` も含まない場合は、$ 0 $ を出力してください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ H $ $ W $ $ K $ $ a_1 $ $ b_1 $ $ a_2 $ $ b_2 $ $ : $ $ a_K $ $ b_K $

## 输出格式

マス目に含まれる `N` のサイズの最大値を出力せよ。

## 说明/提示

### 制約

- $ 1\ \leq\ H,\ W\ \leq\ 3000 $
- $ 0\ \leq\ K\ \leq\ \mathrm{min}(H\ \times\ W,\ 2\ \times\ 10^5) $
- $ 1\ \leq\ a_i\ \leq\ H $
- $ 1\ \leq\ b_i\ \leq\ W $
- $ (a_i,\ b_i)\ \neq\ (a_j,\ b_j)\ (i\ \neq\ j) $
- 入力は全て整数である

### Sample Explanation 1

マス目は以下の状態になっています。(`#` が黒、`.` が白で塗られていることを表しています) ``` ##.# #### ##.# ``` このとき、$ i\ =\ 1,\ j\ =\ 2 $ とすれば $ k\ =\ 3 $ に対して条件を満たすのでこのマス目はサイズ $ 3 $ の `N` を含み、これが最大です。

### Sample Explanation 2

マス目は以下の状態になっています。 ``` .. .. ``` どのサイズの `N` も含まれないので、$ 0 $ を出力してください。

### Sample Explanation 3

マス目は以下の状態になっています。 ``` .# #. ``` $ i\ =\ 2,\ j\ =\ 1 $ または $ i\ =\ 1,\ j\ =\ 2 $ とすれば $ k\ =\ 1 $ に対して条件を満たします。

### Sample Explanation 4

マス目は以下の状態になっています。 ``` ##.# ##.# #.## #..# ```

## 样例 #1

### 输入

```
3 4 2

1 3

3 3
```

### 输出

```
3
```

## 样例 #2

### 输入

```
2 2 4

2 1

1 1

1 2

2 2
```

### 输出

```
0
```

## 样例 #3

### 输入

```
2 2 2

1 1

2 2
```

### 输出

```
1
```

## 样例 #4

### 输入

```
4 4 5

2 3

1 3

4 2

4 3

3 2
```

### 输出

```
4
```



---

---
title: "MAD TEAM"
layout: "post"
diff: 普及+/提高
pid: AT_zone2021_c
tag: ['二分', '位运算']
---

# MAD TEAM

## 题目描述

[problemUrl]: https://atcoder.jp/contests/zone2021/tasks/zone2021_c

$ N $ 人のメンバー候補がおり、それぞれの人は、パワー・スピード・テクニック・知識・発想力の $ 5 $ 種類の能力値を持っています。  
 $ i $ 番目の人のパワーは $ A_i $ 、スピードは $ B_i $ 、テクニックは $ C_i $ 、知識は $ D_i $ 、発想力は $ E_i $ です。  
 あなたは、$ N $ 人のメンバー候補から $ 3 $ 人を選び、$ 1 $ つのチームを作ります。  
 チーム全体のパワーをチームメンバーのパワーの最大値で定義します。スピード・テクニック・知識・発想力についても同様に定義します。  
 チームの総合力を、チーム全体のパワー・スピード・テクニック・知識・発想力の最小値で定義します。  
 チームの総合力としてありえる最大値を求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ A_1 $ $ B_1 $ $ C_1 $ $ D_1 $ $ E_1 $ $ A_2 $ $ B_2 $ $ C_2 $ $ D_2 $ $ E_2 $ $ \vdots $ $ A_N $ $ B_N $ $ C_N $ $ D_N $ $ E_N $

## 输出格式

答えを出力せよ。

## 说明/提示

### ストーリー

さて、本格的に UFO と対峙する仲間を集めることにしよう。それも、とびきり MAD で優秀な。  
 俺は数多の天才たちと競い合ってきた「AtCoder」上でメンバーを集めることにした。  
 名の知れたプログラマに片っ端から声をかけてもいいが、どうせなら得意分野のバランスが良い少数精鋭で最高なチームを作るとしよう。

### 制約

- 入力は全て整数
- $ 3\ <\ =\ N\ <\ =\ 3000 $
- $ 1\ <\ =\ A_i,\ B_i,\ C_i,\ D_i,\ E_i\ <\ =\ 10^9 $

### Sample Explanation 1

$ 3 $ 人全員をチームに入れるほかありません。 この時、チーム全体の各能力値は以下のようになります。 - チーム全体のパワー : $ \max(3,\ 6,\ 8)\ =\ 8 $ - チーム全体のスピード : $ \max(9,\ 9,\ 8)\ =\ 9 $ - チーム全体のテクニック : $ \max(6,\ 3,\ 9)\ =\ 9 $ - チーム全体の知識 : $ \max(4,\ 1,\ 3)\ =\ 4 $ - チーム全体の発想力 : $ \max(6,\ 1,\ 7)\ =\ 7 $ したがって、チームの総合力は $ \min(8,\ 9,\ 9,\ 4,\ 7)\ =\ 4 $ となります。

### Sample Explanation 2

$ 1,\ 2,\ 3 $ 番目の人を採用すると、チームの総合力は $ \min(20,\ 13,\ 19,\ 19,\ 18)\ =\ 13 $ です。

## 样例 #1

### 输入

```
3

3 9 6 4 6

6 9 3 1 1

8 8 9 3 7
```

### 输出

```
4
```

## 样例 #2

### 输入

```
5

6 13 6 19 11

4 4 12 11 18

20 7 19 2 5

15 5 12 20 7

8 7 6 18 5
```

### 输出

```
13
```

## 样例 #3

### 输入

```
10

6 7 5 18 2

3 8 1 6 3

7 2 8 7 7

6 3 3 4 7

12 8 9 15 9

9 8 6 1 10

12 9 7 8 2

10 3 17 4 10

3 1 3 19 3

3 14 7 13 1
```

### 输出

```
10
```



---


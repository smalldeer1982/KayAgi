---
title: "[ABC379F] Buildings 2"
layout: "post"
diff: 普及+/提高
pid: AT_abc379_f
tag: ['二分', '单调栈']
---

# [ABC379F] Buildings 2

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc379/tasks/abc379_f

ビル $ 1 $, ビル $ 2 $, $ \ldots $, ビル $ N $ の $ N $ 棟がこの順で東西に一列に並んでおり、ビル $ 1 $ が最も西に、ビル $ N $ が最も東に建っています。ビル $ i\ (1\leq\ i\leq\ N) $ の高さは $ H_i $ です。

整数の組 $ (i,j)\ (1\leq\ i\lt\ j\leq\ N) $ に対して、以下の条件を満たすとき ビル $ i $ からビル $ j $ を見ることができます。

- ビル $ i $ とビル $ j $ の間にビル $ j $ より高いビルが存在しない。すなわち、$ H_k\gt\ H_j $ を満たす整数 $ k\ (i\lt\ k\lt\ j) $ が存在しない。

$ Q $ 個の質問に答えてください。$ i $ 番目の質問では整数の組 $ (l_i,r_i)\ (l_i\lt\ r_i) $ が与えられるので、ビル $ r_i $ より東にあるビル（ビル $ r_i+1 $, ビル $ r_i+2 $,$ \ldots $,ビル $ N $ ）のうちビル $ l_i $ とビル $ r_i $ の両方から見ることができるものの個数を答えてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ Q $ $ H_1 $ $ H_2 $ $ \ldots $ $ H_N $ $ l_1 $ $ r_1 $ $ l_2 $ $ r_2 $ $ \vdots $ $ l_Q $ $ r_Q $

## 输出格式

$ Q $ 行出力せよ。$ i\ (1\leq\ i\leq\ Q) $ 行目には $ i $ 番目の質問に対する答えを出力せよ。

## 说明/提示

### 制約

- $ 2\leq\ N\leq\ 2\times\ 10^5 $
- $ 1\leq\ Q\leq\ 2\times\ 10^5 $
- $ 1\leq\ H_i\leq\ N $
- $ H_i\neq\ H_j\ (i\neq\ j) $
- $ 1\leq\ l_i\lt\ r_i\leq\ N $
- 入力は全て整数

### Sample Explanation 1

\- $ 1 $ つ目の質問について、ビル $ 2 $ より東にあるビルのうち ビル $ 1 $ とビル $ 2 $ の両方から見ることができるものはビル $ 3,5 $ の $ 2 $ つです。 - $ 2 $ つ目の質問について、ビル $ 5 $ より東にあるビルは存在しません。 - $ 3 $ つ目の質問について、ビル $ 4 $ より東にあるビルのうち、ビル $ 1,4 $ の両方から見ることができるビルはビル $ 5 $ の $ 1 $ つです。

## 样例 #1

### 输入

```
5 3
2 1 4 3 5
1 2
3 5
1 4
```

### 输出

```
2
0
1
```

## 样例 #2

### 输入

```
10 10
2 1 5 3 4 6 9 8 7 10
3 9
2 5
4 8
5 6
3 8
2 10
7 8
6 7
8 10
4 10
```

### 输出

```
1
3
1
2
1
0
1
1
0
0
```



---

---
title: "滑动窗口最大值"
layout: "post"
diff: 普及+/提高
pid: AT_abc407_f
tag: ['线段树', '树状数组', '差分', '单调栈']
---

# 滑动窗口最大值

## 题目描述

给你一个长度为 $N$ 的数列 $A=(A_1,\dots,A_N)$，请对于所有 $1\le k\le N$ 求解下面的问题：

- 求出 $A$ 的全部 $N-k+1$ 个连续子序列的最大值的和。

## 输入格式

将按照以下格式输入：

> $N$
>
> $A_1$ $ A_2$ $A_3$ $\dots$ $A_N$

## 输出格式

$N$ 行，第 $i$ 行为 $k=i$ 时所求解问题的答案。

## 说明/提示

### 数据规模与约定

- $1 \le N \le 2 \times 10^{5}$
- $0 \le A_i \le 10^{7} (1 \le i \le N)$
- 输入的所有数字为整数。

## 样例 #1

### 输入

```
4
5 3 4 2
```

### 输出

```
14
13
9
5
```

## 样例 #2

### 输入

```
8
2 0 2 5 0 5 2 4
```

### 输出

```
20
28
27
25
20
15
10
5
```

## 样例 #3

### 输入

```
11
9203973 9141294 9444773 9292472 5507634 9599162 497764 430010 4152216 3574307 430010
```

### 输出

```
61273615
68960818
69588453
65590626
61592799
57594972
47995810
38396648
28797486
19198324
9599162
```



---

---
title: "[AGC005B] Minimum Sum"
layout: "post"
diff: 普及+/提高
pid: AT_agc005_b
tag: ['线段树', '枚举', '单调栈']
---

# [AGC005B] Minimum Sum

## 题目描述

[problemUrl]: https://atcoder.jp/contests/agc005/tasks/agc005_b

すぬけ君はある日友人から長さ $ N $ の順列 $ a_1,\ a_2,\ ...,\ a_N $ を貰いました。

![](https://cdn.luogu.com.cn/upload/vjudge_pic/AT_agc005_b/7385c80af4629f5f6d11fed58e1b38d3c006d06d.png)

を求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ a_1 $ $ a_2 $ $ ... $ $ a_N $

## 输出格式

$ 1 $ 行に答えを出力する。

なお、32bit整数型に答えが収まるとは限らないことに注意すること。

## 说明/提示

### 制約

- $ 1\ ≦\ N\ ≦\ 200,000 $
- $ (a_1,\ a_2,\ ...,\ a_N) $ は $ (1,\ 2,\ ...,\ N) $ を並び替えたものである

## 样例 #1

### 输入

```
3

2 1 3
```

### 输出

```
9
```

## 样例 #2

### 输入

```
4

1 3 2 4
```

### 输出

```
19
```

## 样例 #3

### 输入

```
8

5 4 8 1 2 6 7 3
```

### 输出

```
85
```



---


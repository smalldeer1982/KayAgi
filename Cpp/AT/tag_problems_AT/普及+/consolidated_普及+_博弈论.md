---
title: "[ABC368F] Dividing Game"
layout: "post"
diff: 普及+/提高
pid: AT_abc368_f
tag: ['博弈论', '数论']
---

# [ABC368F] Dividing Game

## 题目描述

给定一个长度为 $ N $ 的正整数列 $ A = (A_1, A_2, \dots, A_N) $，其中每个元素都大于等于 $ 2 $。Anna 和 Bruno 将使用这些整数进行游戏。游戏由 Anna 先手，两人轮流进行以下操作：

- 随意选择一个整数 $ i $（$ 1 \leq i \leq N $）。选择 $ A_i $ 的一个正的除数 $ x $（$ x $ 不能是 $ A_i $ 本身），并将 $ A_i $ 替换为 $ x $。

当某一方无法进行操作时，该方输掉游戏，另一方获胜。双方都采取最优策略时，判断谁会获胜。

## 输入格式

输入从标准输入以以下格式给出：

```
N
A_1 A_2 ... A_N
```

## 输出格式

如果 Anna 获胜，输出 `Anna`；如果 Bruno 获胜，输出 `Bruno`。

## 说明/提示

### 限制

- $ 1 \leq N \leq 10^5 $
- $ 2 \leq A_i \leq 10^5 $
- 所有输入都是整数

### 示例解释 #1

以下是一个可能的游戏过程，但请注意，这并不一定是双方都采取最优策略的情况。例如：

- Anna 将 $ A_3 $ 替换为 $ 2 $。
- Bruno 将 $ A_1 $ 替换为 $ 1 $。
- Anna 将 $ A_2 $ 替换为 $ 1 $。
- Bruno 将 $ A_3 $ 替换为 $ 1 $。
- Anna 无法进行操作，因此 Bruno 获胜。
  实际上，在这个示例中，如果 Anna 采取最优策略，她总是可以获胜。

## 样例 #1

### 输入

```
3

2 3 4
```

### 输出

```
Anna
```

## 样例 #2

### 输入

```
4

2 3 4 6
```

### 输出

```
Bruno
```



---

---
title: "[ABC398E] Tree Game"
layout: "post"
diff: 普及+/提高
pid: AT_abc398_e
tag: ['博弈论', '二分图']
---

# [ABC398E] Tree Game

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc398/tasks/abc398_e

本题是一道**交互题**（你的程序需要通过输入输出与评测系统进行交互）。

给定一棵包含 $N$ 个顶点的树 $G$，顶点编号为 $1$ 至 $N$。第 $i$ 条边连接顶点 $U_i$ 和 $V_i$。

你和高桥君将使用这棵树 $G$ 进行游戏。首先，你选择先手或后手。之后，双方轮流进行以下操作（先手先行动）：

- 选择一个满足 $1 \leq i < j \leq N$ 的整数对 $(i, j)$，并满足以下两个条件：
  - $G$ 中当前不存在连接顶点 $i$ 和顶点 $j$ 的边。
  - 在 $G$ 中添加连接顶点 $i$ 和顶点 $j$ 的边后，不会形成奇环。
- 将该边添加到 $G$ 中。

无法进行操作的一方判负，另一方获胜。请通过实际与高桥君对弈取得胜利。

**奇环的定义**：顶点序列 $(v_0, v_1, \ldots, v_k)$ 满足以下所有条件时，称为 $G$ 的一个奇环：
- $k$ 为奇数。
- $v_0 = v_k$。
- 对所有 $1 \leq i \leq k$，存在连接 $v_{i-1}$ 和 $v_i$ 的边。
### 交互方式

本题是一道交互题，你的程序需通过标准输入输出与评测系统交互。

首先，通过标准输入接收 $N$ 及 $G$ 的信息，格式如下：

> $N$  
> $U_1$ $V_1$  
> $U_2$ $V_2$  
> $\vdots$  
> $U_{N-1}$ $V_{N-1}$  

接着，你需决定选择先手或后手。若选择先手，通过标准输出输出 `First`；若选择后手，输出 `Second`。

此后游戏开始。

你的回合时，需将选择的整数对 $(i, j)$ 按顺序以空格分隔输出至标准输出：

> $i$ $j$

高桥君的回合时，将通过标准输入给出两个整数 $i$ 和 $j$：

> $i$ $j$

当 $(i, j) = (-1, -1)$ 时，表示你已获胜且游戏结束，此时需立即终止程序。  
其他情况下，$(i, j)$ 表示高桥君选择的整数对。

## 输入格式

见「交互方式」。

## 输出格式

见「交互方式」。

## 说明/提示

### 约束条件

- $2 \leq N \leq 100$
- $1 \leq U_i < V_i \leq N$
- 给定的图是树。
- 输入均为整数。

### 注意事项

- $\footnotesize\color{red}\textsf{\textbf{每次输出后，需在末尾添加换行符并刷新标准输出缓冲区。否则可能导致评测结果为 \colorbox{#f0ad4e}{\color{white}{TLE}}。}}$
- **若在交互过程中输出格式错误或程序意外终止，评测结果将不确定。**
- 游戏结束后请立即终止程序，否则评测结果不确定。

### 交互示例

|输入|输出|解释|
|:-|:-|:-|
|$\begin{matrix} \texttt{4 { }} \\ \texttt{1 2} \\ \texttt{2 3} \\ \texttt{3 4} \end{matrix}$| |首先，你收到 $N$ 和 $G$ 的边信息。|
||$\texttt{First}$|你选择先手行动。|
||$\texttt{1 4}$|你在顶点 $1$ 和 $4$ 之间添加一条边|
|$\texttt{-1 -1}$||高桥无法继续操作，你获胜。评测结果返回 $\colorbox{#5cb85c}{\footnotesize\textsf{\textbf{\color{white}{AC}}}}$。|



---

---
title: "[ABC067D] Fennec VS. Snuke"
layout: "post"
diff: 普及+/提高
pid: AT_arc078_b
tag: ['搜索', '博弈论']
---

# [ABC067D] Fennec VS. Snuke

## 题目描述

$Fennec$ 和 $Snuke$ 正在玩棋盘游戏。

在这个游戏中，有 $n$ 个格子和 $n-1$ 条道路， 编号为 $a_i$ 和 $b_i$ 的格子通过第 $i$ 条边相连。这些格子和边组成了一棵树。

第 $1$ 个格子是黑色，第 $n$ 个格子是白色，其他格子没有颜色。先手 $Fennec$ 和后手 $Snuke$ 交替给格子涂色，两人依次执行以下操作：

   $Fennec$：将一个与黑色格子相邻且未被涂色的格子涂成黑色。
   
   $Snuke$：将一个与白色格子相邻且未被涂色的格子涂成白色。

如果当前行动的玩家无法涂色，他将输掉游戏。请你写一个程序，判断当 $Fennec$ 和 $Snuke$ 都采取最佳策略时，谁能获胜。

## 输入格式

第一行一个整数 $n\ \ (2 ≤n≤1e5)$

接下来 $n-1$行，每行两个整数 $a_i$ 和 $b_i$，表示 $a_i$ 和 $b_i$ 间有一条边 $(1≤a_i ,b_i ≤n)$

## 输出格式

若 Fennec 获胜，输出“Fennec”，否则输出“Snuke”（不包含引号）

## 样例 #1

### 输入

```
7

3 6

1 2

3 1

7 4

5 7

1 4
```

### 输出

```
Fennec
```

## 样例 #2

### 输入

```
4

1 4

4 2

2 3
```

### 输出

```
Snuke
```



---

---
title: "[ARC094E] Tozan and Gezan"
layout: "post"
diff: 普及+/提高
pid: AT_arc094_c
tag: ['博弈论']
---

# [ARC094E] Tozan and Gezan

## 题目描述

[problemUrl]: https://atcoder.jp/contests/arc094/tasks/arc094_c

非負整数からなる数列 $ A,B $ が与えられます。 $ A,B $ の長さはともに $ N $ であり、$ A $ の値の総和と $ B $ の値の総和は等しいです。 $ A $ の $ i $ 項目は $ A_i $ であり、$ B $ の $ i $ 項目は $ B_i $ です。

とざん君とげざん君は、以下の操作を繰り返します。

- もし $ A,B $ が列として等しいなら、繰り返しを終了する
- そうでない場合、まずとざん君が $ A $ の正の要素を $ 1 $ つ選び、$ 1 $ 減らす
- その後、げざん君が $ B $ の正の要素を $ 1 $ つ選び、$ 1 $ 減らす
- その後、ペットの高橋君に飴を $ 1 $ つ食べさせる

とざん君は繰り返しが終了するまでに高橋君に食べさせる飴の個数を最大に、げざん君は最小にしたいです。 両者最適に操作を行ったとき、高橋君に食べさせる飴の個数を求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ A_1 $ $ B_1 $ $ : $ $ A_N $ $ B_N $

## 输出格式

両者最適に操作を行ったとき、高橋君に食べさせる飴の個数を出力せよ。

## 说明/提示

### 制約

- $ 1\ \leq\ N\ \leq\ 2\ ×\ 10^5 $
- $ 0\ \leq\ A_i,B_i\ \leq\ 10^9(1\leq\ i\leq\ N) $
- $ A,B $ の値の総和は等しい
- 入力はすべて整数である

### Sample Explanation 1

両者最適に操作を行ったとき、操作は以下のように進みます。 - とざん君は $ A_1 $ を $ 1 $ 減らす。 - げざん君は $ B_1 $ を $ 1 $ 減らす。 - 高橋君に飴を $ 1 $ つ食べさせる。 - とざん君は $ A_2 $ を $ 1 $ 減らす。 - げざん君は $ B_1 $ を $ 1 $ 減らす。 - 高橋君に飴を $ 1 $ つ食べさせる。 - $ A,B $ が等しくなったので終了する。

## 样例 #1

### 输入

```
2

1 2

3 2
```

### 输出

```
2
```

## 样例 #2

### 输入

```
3

8 3

0 1

4 8
```

### 输出

```
9
```

## 样例 #3

### 输入

```
1

1 1
```

### 输出

```
0
```



---

---
title: "[ARC162C] Mex Game on Tree"
layout: "post"
diff: 普及+/提高
pid: AT_arc162_c
tag: ['贪心', '博弈论']
---

# [ARC162C] Mex Game on Tree

## 题目描述

[problemUrl]: https://atcoder.jp/contests/arc162/tasks/arc162_c

頂点に $ 1 $ から $ N $ の番号がついた $ N $ 頂点の根付き木が与えられます。頂点 $ 1 $ が根であり、頂点 $ i\ (2\leq\ i\ \leq\ N) $ の親は $ P_i $ です。

根付き木の何個かの頂点には $ 0 $ 以上 $ N $ 以下の整数が書かれています。この情報は数列 $ A=(A_1,A_2,\ldots,A_N) $ で与えられ、$ A_i\ \neq\ -1 $ の場合頂点 $ i $ に整数 $ A_i $ が書かれており、$ A_i=-1 $ の場合頂点 $ i $ には整数が書かれていないことを意味しています。

Alice と Bob でゲームをします。Alice が先手で、全ての頂点に整数が書かれるまで以下の操作を交互に繰り返します。

- 整数が書かれていない頂点を $ 1 $ 個選び、 $ 0 $ 以上 $ N $ 以下の整数を書く。
 
操作終了後の各頂点 $ v $ に対して、 $ f(v) $ を「頂点 $ v $ の部分木に含まれるどの頂点（$ v $ 含む）にも書かれていないような最小の非負整数」と定めます。

$ f(v)\ =\ K $ を満たす頂点 $ v $ が存在する場合 Alice の勝利、そうでない場合 Bob の勝利となります。両者が最適な行動を行う場合、どちらが勝つか判定してください。

$ T $ 個のテストケースが与えられるので、それぞれについて答えてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ T $ $ \mathrm{case}_1 $ $ \vdots $ $ \mathrm{case}_T $

各ケースは以下の形式で与えられる。

> $ N $ $ K $ $ P_2 $ $ P_3 $ $ \ldots $ $ P_N $ $ A_1 $ $ A_2 $ $ \ldots $ $ A_N $

## 输出格式

$ T $ 行出力せよ。$ i\ (1\leq\ i\ \leq\ T) $ 行目には、 $ i $ 番目のテストケースについて、両者が最適な行動を行う場合 Alice が勝つならば `Alice` を、Bob が勝つならば `Bob` を出力せよ。

## 说明/提示

### 制約

- $ 1\ \leq\ T\ \leq\ 10^3 $
- $ 2\ \leq\ N\ \leq\ 10^3 $
- $ 0\ \leq\ K\ \leq\ N $
- $ 1\ \leq\ P_i\ <\ i\ (2\leq\ i\leq\ N) $
- $ -1\ \leq\ A_i\ \leq\ N\ (1\leq\ i\leq\ N) $
- 入力される数値は全て整数
- $ 1 $ つの入力に含まれるテストケースについて、$ N $ の総和は $ 2\times\ 10^3 $ 以下
 
### Sample Explanation 1

$ 1 $ 番目のテストケースについては、Alice が頂点 $ 2 $ に $ 0 $ を書き込むと、Bob の操作に依らず $ f(2)\ =\ 2 $ となります。そのため、Alice は勝つことができます。 $ 2 $ 番目のテストケースについては、Bob が上手く書き込む整数を選ぶことで、 $ f(v)\ =\ 4 $ なる頂点が存在しないようにできます。

## 样例 #1

### 输入

```
2

4 2

1 1 2

-1 -1 3 1

6 4

1 2 2 1 3

-1 -1 -1 -1 -1 -1
```

### 输出

```
Alice

Bob
```



---

---
title: "[ARC164C] Reversible Card Game"
layout: "post"
diff: 普及+/提高
pid: AT_arc164_c
tag: ['贪心', '博弈论']
---

# [ARC164C] Reversible Card Game

## 题目描述

[problemUrl]: https://atcoder.jp/contests/arc164/tasks/arc164_c

両面に数が書かれた $ N $ 枚のカードがあり、$ i $ 枚目のカードには片方の面に赤い数字で $ A_i $ が、もう片方の面には青い数字で $ B_i $ が書かれています。初め、全てのカードは赤い数字が書かれた面を表にして置かれており、Alice と Bob は次のような手順を繰り返すゲームをします。

- まず、Alice が残っているカードの中から $ 1 $ 枚を選び、裏返す。次に、Bob が残っているカードの中から $ 1 $ 枚を取り除く。このとき、取り除いたカードの表側の面に書かれていた数の分だけ Bob は得点を得る。
 
残っているカードが $ 0 $ 枚になった時、ゲームを終了します。

Alice はゲーム終了時の Bob の得点を最小にしようとし、Bob はこれを最大にしようとします。両者が最善の手順を取ったとき、ゲーム終了時の Bob の得点は何点でしょうか。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ A_1 $ $ B_1 $ $ A_2 $ $ B_2 $ $ \vdots $ $ A_N $ $ B_N $

## 输出格式

答えを整数で出力せよ。

## 说明/提示

### 制約

- $ 1\leq\ N\leq\ 2\times\ 10^5 $
- $ 1\leq\ A_i,\ B_i\leq\ 10^9 $ $ (1\leq\ i\ \leq\ N) $
- 入力される値はすべて整数である
 
### Sample Explanation 1

初めの状態では、表側の面に書かれた数はそれぞれ $ 6,2,5 $ です。ここから、例えば次のような進行が考えられます。 1. Alice は $ 1 $ 枚目のカードを裏返す。このとき、表側の面に書かれた数は $ 4,2,5 $ となる。Bob は $ 3 $ 枚目のカードを取り除き、$ 5 $ 点を得る。 2. Alice は $ 2 $ 枚目のカードを裏返す。このとき、表側の面に書かれた数は $ 4,1 $ となる。Bob は $ 2 $ 枚目のカードを取り除き、$ 1 $ 点を得る。 3. Alice は最後に残った $ 1 $ 枚目のカードを裏返す。このとき、表側の面に書かれた数は $ 6 $ となる。Bob はこれを取り除き、$ 6 $ 点を得る。 この場合、Bob が最終的に得る得点は $ 12 $ 点です。実は、この進行は双方の最善手の一例であり、答えは $ 12 $ となります。

## 样例 #1

### 输入

```
3

6 4

2 1

5 3
```

### 输出

```
12
```

## 样例 #2

### 输入

```
5

166971716 552987438

219878198 619875818

918378176 518975015

610749017 285601372

701849287 307601390
```

### 输出

```
3078692091
```



---

---
title: "[ARC168B] Arbitrary Nim"
layout: "post"
diff: 普及+/提高
pid: AT_arc168_b
tag: ['博弈论']
---

# [ARC168B] Arbitrary Nim

## 题目描述

[problemUrl]: https://atcoder.jp/contests/arc168/tasks/arc168_b

石の山が $ N $ 個あり，$ i $ 番目 ($ 1\ \leq\ i\ \leq\ N $) の山には $ A_i $ 個の石が積まれています．

あなたは今から正整数 $ k $ を選びます． その後，Alice と Bob がこの山を使って以下のようなゲームを行います．

- Alice から始めて両者は交互に手番をプレイする．
- 各手番では，プレイヤーは空でない山を一つ選び，その山から $ 1 $ 個以上 $ k $ 個以下の好きな個数の石を取り除く．
 
自分の手番で操作が行えなくなった人が負けで，負けなかった人が勝ちです．

あなたは正整数 $ k $ を選ぶとき，Alice に必勝法が存在するようにしたいです． そのような $ k $ が存在するか判定してください． 存在する場合は，そのような $ k $ の最大値が存在するか判定してください． 最大値が存在する場合は，その値を答えてください．

## 输入格式

入力は以下の形式で標準入力から与えられる．

> $ N $ $ A_1 $ $ A_2 $ $ \cdots $ $ A_N $

## 输出格式

Alice に必勝法が存在するような $ k $ が存在しない場合，$ 0 $ を出力せよ．

Alice に必勝法が存在するような $ k $ が存在するが，その最大値が存在しない場合，$ -1 $ を出力せよ．

Alice に必勝法が存在するような $ k $ が存在し，その最大値も存在する場合，その値を出力せよ．

## 说明/提示

### 制約

- $ 1\ \leq\ N\ \leq\ 250000 $
- $ 1\ \leq\ A_i\ \leq\ 10^9 $
- 入力される値はすべて整数．
 
### Sample Explanation 1

例えば，$ k=2 $ とすると Alice に必勝法が存在します． $ 3\ \leq\ k $ を選んだ場合は Alice に必勝法が存在しないので，$ k=2 $ が答えです．

### Sample Explanation 2

例えば，すべての $ k=100,200,300,\cdots $ に対して Alice に必勝法が存在します． よって $ k $ の最大値は存在しないため，$ -1 $ を出力します．

### Sample Explanation 3

どのような $ k $ を選んでも Alice に必勝法は存在しません． よって $ 0 $ を出力します．

## 样例 #1

### 输入

```
3

1 2 3
```

### 输出

```
2
```

## 样例 #2

### 输入

```
4

1 2 3 4
```

### 输出

```
-1
```

## 样例 #3

### 输入

```
2

100 100
```

### 输出

```
0
```



---


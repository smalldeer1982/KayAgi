---
title: "[ABC250E] Prefix Equality"
layout: "post"
diff: 普及+/提高
pid: AT_abc250_e
tag: ['哈希 hashing']
---

# [ABC250E] Prefix Equality

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc250/tasks/abc250_e

長さ $ N $ の整数列 $ A\ =\ (a_1,\ldots,a_N) $ と $ B\ =\ (b_1,\ldots,b_N) $ が与えられます。

$ i=1,...,Q $ に対し、次の形式のクエリに答えてください。

- $ A $ の先頭 $ x_i $ 項 $ (a_1,\ldots,a_{x_i}) $ に含まれる値の集合と $ B $ の先頭 $ y_i $ 項 $ (b_1,\ldots,b_{y_i}) $ に含まれる値の集合が等しいならば `Yes` と、そうでなければ `No` と出力せよ。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ a_1 $ $ \ldots $ $ a_N $ $ b_1 $ $ \ldots $ $ b_N $ $ Q $ $ x_1 $ $ y_1 $ $ \vdots $ $ x_Q $ $ y_Q $

## 输出格式

$ Q $ 行出力せよ。 $ i $ 行目には、$ i $ 番目のクエリに対する出力をせよ。

## 说明/提示

### 制約

- $ 1\ \leq\ N,Q\ \leq\ 2\ \times\ 10^5 $
- $ 1\ \leq\ a_i,b_i\ \leq\ 10^9 $
- $ 1\ \leq\ x_i,y_i\ \leq\ N $
- 入力は全て整数

### Sample Explanation 1

集合は各値が含まれるかどうかのみに注目した概念であることに気を付けてください。 $ 3 $ 番目のクエリにおいて、$ A $ の先頭 $ 2 $ 項には $ 1 $ と $ 2 $ が $ 1 $ 個ずつ、$ B $ の先頭 $ 3 $ 項には $ 1 $ が $ 1 $ 個と $ 2 $ が $ 2 $ 個含まれます。しかし、それぞれに含まれる値の集合はどちらも $ \{\ 1,2\ \} $ となり、一致します。 また、$ 6 $ 番目のクエリにおいては各値が現れる順番が異なりますが、やはり集合としては一致します。

## 样例 #1

### 输入

```
5

1 2 3 4 5

1 2 2 4 3

7

1 1

2 2

2 3

3 3

4 4

4 5

5 5
```

### 输出

```
Yes

Yes

Yes

No

No

Yes

No
```



---

---
title: "[ABC265E] Warp"
layout: "post"
diff: 普及+/提高
pid: AT_abc265_e
tag: ['动态规划 DP', '哈希 hashing']
---

# [ABC265E] Warp

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc265/tasks/abc265_e

$ 2 $ 次元平面の原点に高橋君がいます。  
 高橋君はこれから、ワープを $ N $ 回繰り返します。各ワープでは、以下の $ 3 $ つのうちいずれか $ 1 $ つを行います。

- 現在いる座標 $ (x,y) $ から $ (x+A,y+B) $ に移動する
- 現在いる座標 $ (x,y) $ から $ (x+C,y+D) $ に移動する
- 現在いる座標 $ (x,y) $ から $ (x+E,y+F) $ に移動する

平面上の $ M $ 箇所 $ (X_1,Y_1),\ldots,(X_M,Y_M) $ には障害物があり、これらの座標に移動することはできません。

$ N $ 回のワープによる移動経路として考えられるものは何通りですか？ $ 998244353 $ で割ったあまりを求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ M $ $ A $ $ B $ $ C $ $ D $ $ E $ $ F $ $ X_1 $ $ Y_1 $ $ X_2 $ $ Y_2 $ $ \vdots $ $ X_M $ $ Y_M $

## 输出格式

答えを出力せよ。

## 说明/提示

### 制約

- $ 1\ \leq\ N\ \leq\ 300 $
- $ 0\ \leq\ M\ \leq\ 10^5 $
- $ -10^9\ \leq\ A,B,C,D,E,F\ \leq\ 10^9 $
- $ (A,B),(C,D),(E,F) $ は相異なる
- $ -10^9\ \leq\ X_i,Y_i\ \leq\ 10^9 $
- $ (X_i,Y_i)\neq(0,0) $
- $ (X_i,Y_i) $ は相異なる
- 入力に含まれる値は全て整数である

### Sample Explanation 1

以下の $ 5 $ 通りが考えられます。 - $ (0,0)\to(1,1)\to(2,3) $ - $ (0,0)\to(1,1)\to(2,4) $ - $ (0,0)\to(1,3)\to(2,4) $ - $ (0,0)\to(1,3)\to(2,5) $ - $ (0,0)\to(1,3)\to(2,6) $

## 样例 #1

### 输入

```
2 2

1 1 1 2 1 3

1 2

2 2
```

### 输出

```
5
```

## 样例 #2

### 输入

```
10 3

-1000000000 -1000000000 1000000000 1000000000 -1000000000 1000000000

-1000000000 -1000000000

1000000000 1000000000

-1000000000 1000000000
```

### 输出

```
0
```

## 样例 #3

### 输入

```
300 0

0 0 1 0 0 1
```

### 输出

```
292172978
```



---

---
title: "[ABC284F] ABCBAC"
layout: "post"
diff: 普及+/提高
pid: AT_abc284_f
tag: ['哈希 hashing', 'KMP 算法']
---

# [ABC284F] ABCBAC

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc284/tasks/abc284_f

長さ $ N $ の文字列 $ S $ および整数 $ i\ (0\leq\ i\leq\ N) $ に対して、$ f_i(S) $ を、

- $ S $ の先頭 $ i $ 文字
- $ S $ を反転した文字列
- $ S $ の末尾 $ N-i $ 文字

をこの順に連結した文字列と定義します。 例えば、$ S= $ `abc`、$ i=2 $ のとき、$ f_i(S)= $ `abcbac` です。

長さ $ 2N $ の文字列 $ T $ が与えられます。 $ f_i(S)=T $ を満たす長さ $ N $ の文字列 $ S $ と整数 $ i\ (0\leq\ i\leq\ N) $ の組を $ 1 $ つ見つけてください。 そのような $ S,i $ の組が存在しない場合は、それを報告してください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ T $

## 输出格式

条件を満たす $ S,i $ の組が存在しないならば、`-1` と出力せよ。 存在するならば、$ S,i $ を改行区切りで出力せよ。 条件を満たす $ S,i $ の組が複数存在する場合は、そのどれを出力しても良い。

## 说明/提示

### 制約

- $ 1\leq\ N\ \leq\ 10^6 $
- $ N $ は整数
- $ T $ は英小文字からなる長さ $ 2N $ の文字列

### Sample Explanation 1

問題文中に書いた通り、$ S= $ `abc`、$ i=2 $ とすると $ f_i(S)= $ `abcbac` となって $ T $ に一致するため、`abc` と $ 2 $ を出力します。

### Sample Explanation 2

$ S= $ `abab`、$ i=3 $ としても条件を満たします。

### Sample Explanation 3

$ S= $ `agc`、$ i=3 $ としても条件を満たします。

### Sample Explanation 4

条件を満たす $ S,i $ の組が存在しない場合は `-1` を出力してください。

## 样例 #1

### 输入

```
3
abcbac
```

### 输出

```
abc
2
```

## 样例 #2

### 输入

```
4
abababab
```

### 输出

```
abab
1
```

## 样例 #3

### 输入

```
3
agccga
```

### 输出

```
cga
0
```

## 样例 #4

### 输入

```
4
atcodeer
```

### 输出

```
-1
```



---

---
title: "[ABC331F] Palindrome Query"
layout: "post"
diff: 普及+/提高
pid: AT_abc331_f
tag: ['线段树', '树状数组', '哈希 hashing']
---

# [ABC331F] Palindrome Query

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc331/tasks/abc331_f

英小文字からなる長さ $ N $ の文字列 $ S $ が与えられます。  
 以下で説明されるクエリを与えられる順に $ Q $ 個処理してください。  
 クエリは次の $ 2 $ 種類のいずれかです。

- `1 x c` : $ S $ の $ x $ 文字目を英小文字 $ c $ に変更する。
- `2 L R` : $ S $ の $ L $ 文字目から $ R $ 文字目までからなる部分文字列が回文であるならば `Yes` を、そうでないならば `No` を出力する。

## 输入格式

入力は以下の形式で標準入力から与えられる。ここで $ \text{query}_i $ は $ i $ 番目に処理するクエリである。

> $ N $ $ Q $ $ S $ $ \text{query}_1 $ $ \text{query}_2 $ $ \vdots $ $ \text{query}_Q $

各クエリは以下のいずれかの形式で与えられる。

> $ 1 $ $ x $ $ c $

> $ 2 $ $ L $ $ R $

## 输出格式

問題文の指示に従ってクエリへの答えを改行区切りで出力せよ。

## 说明/提示

### 制約

- $ 1\ \leq\ N\ \leq\ 10^6 $
- $ 1\ \leq\ Q\ \leq\ 10^5 $
- $ S $ は英小文字からなる長さ $ N $ の文字列
- $ 1\ \leq\ x\ \leq\ N $
- $ c $ は英小文字
- $ 1\ \leq\ L\ \leq\ R\ \leq\ N $
- $ N,\ Q,\ x,\ L,\ R $ は整数
 
### Sample Explanation 1

はじめ、$ S\ = $ `abcbacb` です。 $ 1 $ 番目のクエリについて、$ S $ の $ 1 $ 文字目から $ 5 $ 文字目までからなる文字列は `abcba` で、これは回文です。よって `Yes` を出力します。 $ 2 $ 番目のクエリについて、$ S $ の $ 4 $ 文字目から $ 7 $ 文字目までからなる文字列は `bacb` で、これは回文ではありません。よって `No` を出力します。 $ 3 $ 番目のクエリについて、$ S $ の $ 2 $ 文字目から $ 2 $ 文字目までからなる文字列は `b` で、これは回文です。よって `Yes` を出力します。 $ 4 $ 番目のクエリについて、$ S $ の $ 5 $ 文字目を `c` に変更します。$ S $ は `abcbccb` になります。 $ 5 $ 番目のクエリについて、$ S $ の $ 1 $ 文字目から $ 5 $ 文字目までからなる文字列は `abcbc` で、これは回文ではありません。よって `No` を出力します。 $ 6 $ 番目のクエリについて、$ S $ の $ 4 $ 文字目から $ 7 $ 文字目までからなる文字列は `bccb` で、これは回文です。よって `Yes` を出力します。 $ 7 $ 番目のクエリについて、$ S $ の $ 4 $ 文字目を `c` に変更します。$ S $ は `abccccb` になります。 $ 8 $ 番目のクエリについて、$ S $ の $ 3 $ 文字目から $ 6 $ 文字目までからなる文字列は `cccc` で、これは回文です。よって `Yes` を出力します。

## 样例 #1

### 输入

```
7 8

abcbacb

2 1 5

2 4 7

2 2 2

1 5 c

2 1 5

2 4 7

1 4 c

2 3 6
```

### 输出

```
Yes

No

Yes

No

Yes

Yes
```



---

---
title: "[ABC339F] Product Equality"
layout: "post"
diff: 普及+/提高
pid: AT_abc339_f
tag: ['数学', '哈希 hashing']
---

# [ABC339F] Product Equality

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc339/tasks/abc339_f

$ N $ 個の整数 $ A_1,A_2,\dots,A_N $ が与えられます。  
 以下の条件を満たす整数の組 $ (i,j,k) $ の個数を求めてください。

- $ 1\ \le\ i,j,k\ \le\ N $
- $ A_i\ \times\ A_j\ =\ A_k $

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ A_1 $ $ A_2 $ $ \vdots $ $ A_N $

## 输出格式

答えを整数として出力せよ。

## 说明/提示

### 制約

- $ 1\ \le\ N\ \le\ 1000 $
- $ \color{red}{1\ \le\ A_i\ <\ 10^{1000}} $
 
### Sample Explanation 1

問題文中の条件を満たす $ (i,j,k) $ の組は以下の $ 6 $ 通りです。 - $ (1,2,3) $ - $ (1,3,4) $ - $ (1,4,5) $ - $ (2,1,3) $ - $ (3,1,4) $ - $ (4,1,5) $

### Sample Explanation 2

各整数 $ A_i $ の値が非常に大きくなりうることに注意してください。

### Sample Explanation 3

$ A_i $ の値に重複がありうることに注意してください。

## 样例 #1

### 输入

```
5

2

3

6

12

24
```

### 输出

```
6
```

## 样例 #2

### 输入

```
11

1

2

3

4

5

6

123456789123456789

123456789123456789

987654321987654321

987654321987654321

121932631356500531347203169112635269
```

### 输出

```
40
```

## 样例 #3

### 输入

```
9

4

4

4

2

2

2

1

1

1
```

### 输出

```
162
```



---

---
title: "[ABC367F] Rearrange Query"
layout: "post"
diff: 普及+/提高
pid: AT_abc367_f
tag: ['哈希 hashing']
---

# [ABC367F] Rearrange Query

## 题目描述

给定两个长度为 $N$ 的正整数序列 $A=(A_1,A_2,\ldots,A_N)$ 和 $B=(B_1,B_2,\ldots,B_N)$。

你需要处理 $Q$ 个查询。对于第 $i$ 个查询，给定四个正整数 $l_i$, $r_i$, $L_i$, 和 $R_i$。你需要判断是否可以通过重新排列序列 $(A_{l_i},A_{l_i+1},\ldots,A_{r_i})$ 来使其与 $(B_{L_i},B_{L_i+1},\ldots,B_{R_i})$ 完全相同。如果可以做到，则输出 `Yes`；否则输出 `No`。

## 输入格式

输入以以下格式从标准输入中给出：

- 第一行包含 $N$, $Q$, 接着是序列 $A$ 的元素 $A_1, A_2, \ldots, A_N$ 和序列 $B$ 的元素 $B_1, B_2, \ldots, B_N$。
- 接下来有 $Q$ 行，每行包含四个整数 $l_i$, $r_i$, $L_i$, 和 $R_i$，代表每个查询。

## 输出格式

输出共 $Q$ 行。第 $i$ 行输出第 $i$ 个查询的答案。

## 说明/提示

#### 制约条件

- $1 \leq N, Q \leq 2 \times 10^5$
- $1 \leq A_i, B_i \leq N$
- $1 \leq l_i \leq r_i \leq N$
- $1 \leq L_i \leq R_i \leq N$
- 所有输入均为整数。

#### 示例解释 1

- 对于第 1 个查询，$(1,2,3)$ 可以通过重排变为 $(2,3,1)$。因此输出 `Yes`。
- 对于第 2 个查询，无论怎样重排 $(1,2)$ 都无法变为 $(1,4,2)$。因此输出 `No`。
- 对于第 3 个查询，无论怎样重排 $(1,2,3,2)$ 都无法变为 $(3,1,4,2)$。因此输出 `No`。
- 对于第 4 个查询，$(1,2,3,2,4)$ 可以通过重排变为 $(2,3,1,4,2)$。因此输出 `Yes`。

## 样例 #1

### 输入

```
5 4

1 2 3 2 4

2 3 1 4 2

1 3 1 3

1 2 3 5

1 4 2 5

1 5 1 5
```

### 输出

```
Yes

No

No

Yes
```

## 样例 #2

### 输入

```
4 4

4 4 4 4

4 4 4 4

1 2 2 3

3 3 1 1

1 3 1 4

1 4 2 3
```

### 输出

```
Yes

Yes

No

No
```



---

---
title: "[ABC403E] Forbidden Prefix"
layout: "post"
diff: 普及+/提高
pid: AT_abc403_e
tag: ['字符串', '哈希 hashing', '字典树 Trie']
---

# [ABC403E] Forbidden Prefix

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc403/tasks/abc403_e

现有两个字符串多重集合 $X$ 和 $Y$，初始时均为空集合。

需要依次处理 $Q$ 个查询。第 $i$ 个查询给出整数 $T_i$ 和字符串 $S_i$：
- 若 $T_i=1$，则将 $S_i$ 加入 $X$；
- 若 $T_i=2$，则将 $S_i$ 加入 $Y$。

在每个查询处理完成后，请输出以下值：
- $Y$ 中满足"不以 $X$ 中任何字符串作为前缀"的字符串数量。

## 输入格式

输入通过标准输入给出，格式如下：

> $Q$  
> $T_1$ $S_1$  
> $T_2$ $S_2$  
> $\vdots$  
> $T_Q$ $S_Q$

## 输出格式

输出 $Q$ 行。第 $i$ 行 $(1 \leq i \leq Q)$ 应输出第 $i$ 个查询处理后的答案。


## 说明/提示

### 约束条件

- $Q$ 是 $1$ 到 $2 \times 10^5$ 之间的整数
- $T_i \in \{1,2\}$
- $S_i$ 是长度在 $1$ 到 $5 \times 10^5$ 之间的小写字母字符串
- $\displaystyle \sum_{i=1}^Q |S_i| \leq 5 \times 10^5$

### 样例解释 #1

各查询处理后的结果如下：
- $i=1$：$Y$ 为空集，答案为 $0$
- $i=2$：`watcoder` 不以 $X$ 中的 `at` 为前缀，答案为 $1$
- $i=3$：`watcoder` 仍满足条件，而 `atcoder` 以 `at` 为前缀，答案为 $1$
- $i=4$：`watcoder` 以新增的 `wa` 为前缀，`atcoder` 以 `at` 为前缀，答案为 $0$

翻译由 DeepSeek V3 完成

## 样例 #1

### 输入

```
4
1 at
2 watcoder
2 atcoder
1 wa
```

### 输出

```
0
1
1
0
```

## 样例 #2

### 输入

```
10
1 w
1 avko
2 atcoder
1 bzginn
2 beginner
1 atco
2 contest
1 ntxcdg
1 atc
1 contest
```

### 输出

```
0
0
1
1
2
1
2
2
2
1
```



---

---
title: "[ARC181B] Annoying String Problem"
layout: "post"
diff: 普及+/提高
pid: AT_arc181_b
tag: ['哈希 hashing', 'KMP 算法']
---

# [ARC181B] Annoying String Problem

## 题目描述

[problemUrl]: https://atcoder.jp/contests/arc181/tasks/arc181_b

英小文字からなる文字列 $ S,T $ および `0`, `1` からなる文字列 $ X $ に対し、英小文字からなる文字列 $ f(S,T,X) $ を以下のように定めます。

- 空文字列に対し、 $ i=1,2,\dots,|X| $ の順に、 $ X $ の $ i $ 文字目が `0` なら $ S $ を、 `1` なら $ T $ を末尾に結合することで得られる文字列
 
英小文字からなる文字列 $ S $ および `0`, `1` からなる文字列 $ X,Y $ が与えられます。

英小文字からなる文字列 $ T $ （空文字列でもよい）であって、 $ f(S,T,X)=f(S,T,Y) $ が成り立つようなものが存在するか判定してください。

$ t $ 個のテストケースが与えられるのでそれぞれについて答えを求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ t $ $ \mathrm{case}_1 $ $ \vdots $ $ \mathrm{case}_t $

各ケースは以下の形式で与えられる。

> $ S $ $ X $ $ Y $

## 输出格式

$ t $ 行出力せよ。 $ i $ 行目には $ i $ 番目のテストケースについて、条件を満たす $ T $ が存在するならば `Yes` を、存在しないならば `No` を出力せよ。

## 说明/提示

### 制約

- $ 1\ \leq\ t\ \leq\ 5\ \times\ 10^5 $
- $ 1\ \leq\ |S|\ \leq\ 5\times\ 10^5 $
- $ 1\ \leq\ |X|,|Y|\ \leq\ 5\times\ 10^5 $
- $ S $ は英小文字からなる文字列
- $ X,Y $ は `0`, `1` からなる文字列
- $ 1 $ つの入力に含まれるテストケースについて、 $ |S| $ の総和は $ 5\ \times\ 10^5 $ 以下
- $ 1 $ つの入力に含まれるテストケースについて、 $ |X| $ の総和は $ 5\ \times\ 10^5 $ 以下
- $ 1 $ つの入力に含まれるテストケースについて、 $ |Y| $ の総和は $ 5\ \times\ 10^5 $ 以下
 
### Sample Explanation 1

以下、文字列の結合を $ + $ を用いて表します。 $ 1 $ 番目のテストケースについて、 $ T= $`ara` とすると $ f(S,T,X)=S+T= $`araaraara` $ ,\ f(S,T,Y)=T+T+T= $`araaraara` となるため、 $ f(S,T,X)=f(S,T,Y) $ が成り立ちます。 $ 2,3 $ 番目のテストケースについて、条件を満たす $ T $ は存在しません。

### Sample Explanation 2

$ T $ は空文字列であっても構いません。

## 样例 #1

### 输入

```
3

araara

01

111

araaaa

100100

0010111

abacabac

0

1111
```

### 输出

```
Yes

No

No
```

## 样例 #2

### 输入

```
2

empty

10101

00

empty

11111

111
```

### 输出

```
Yes

Yes
```



---

---
title: "DNAの合成 (DNA Synthesizer)"
layout: "post"
diff: 普及+/提高
pid: AT_joisc2010_dna
tag: ['字符串', '动态规划 DP', '哈希 hashing']
---

# DNAの合成 (DNA Synthesizer)

## 题目描述

[problemUrl]: https://atcoder.jp/contests/joisc2010/tasks/joisc2010_dna





---


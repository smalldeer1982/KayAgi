---
title: "[ABC377E] Permute K times 2"
layout: "post"
diff: 普及+/提高
pid: AT_abc377_e
tag: ['图论建模']
---

# [ABC377E] Permute K times 2

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc377/tasks/abc377_e

$ (1,2,\ldots,N) $ の並べ替え $ P=(P\ _\ 1,P\ _\ 2,\ldots,P\ _\ N) $ が与えられます。

次の操作を $ K $ 回行います。

- $ i=1,2,\ldots,N $ に対して**同時に** $ P\ _\ i $ を $ P\ _\ {P\ _\ i} $ で更新する
 
すべての操作を終えたあとの $ P $ を出力してください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ K $ $ P\ _\ 1 $ $ P\ _\ 2 $ $ \ldots $ $ P\ _\ N $

## 输出格式

操作をすべて行ったあとの $ P $ について、$ P\ _\ 1,P\ _\ 2,\ldots,P\ _\ N $ をこの順に空白を区切りとして出力せよ。

## 说明/提示

### 制約

- $ 1\leq\ N\leq2\times10^5 $
- $ 1\leq\ K\leq10^{18} $
- $ 1\leq\ P\ _\ i\leq\ N\ (1\leq\ i\leq\ N) $
- $ P\ _\ i\neq\ P\ _\ j\ (1\leq\ i\lt\ j\leq\ N) $
- 入力はすべて整数
 
### Sample Explanation 1

それぞれの操作によって、$ P $ は次のように変化します。 - $ 1 $ 回目の操作の結果、$ P=(2,4,3,5,6,1) $ となります。 - $ 2 $ 回目の操作の結果、$ P=(4,5,3,6,1,2) $ となります。 - $ 3 $ 回目の操作の結果、$ P=(6,1,3,2,4,5) $ となります。 よって、`6 1 3 2 4 5` を出力してください。

### Sample Explanation 2

$ P\ _\ i=i $ なので、何度操作を行っても $ P $ は変化しません。

## 样例 #1

### 输入

```
6 3

5 6 3 1 2 4
```

### 输出

```
6 1 3 2 4 5
```

## 样例 #2

### 输入

```
5 1000000000000000000

1 2 3 4 5
```

### 输出

```
1 2 3 4 5
```

## 样例 #3

### 输入

```
29 51912426

7 24 8 23 6 1 4 19 11 18 20 9 17 28 22 27 15 2 12 26 10 13 14 25 5 29 3 21 16
```

### 输出

```
18 23 16 24 21 10 2 27 19 7 12 8 13 5 15 26 17 4 3 9 1 22 25 14 28 11 29 6 20
```



---

---
title: "[ABC396E] Min of Restricted Sum"
layout: "post"
diff: 普及+/提高
pid: AT_abc396_e
tag: ['图论建模', '连通块', '位运算']
---

# [ABC396E] Min of Restricted Sum

## 题目描述

给定整数 $N, M$ 和长度为 $M$ 的整数序列 $X=(X_1,X_2,\ldots,X_M)$、$Y=(Y_1,Y_2,\ldots,Y_M)$、$Z=(Z_1,Z_2,\ldots,Z_M)$。其中，保证 $X$ 和 $Y$ 的所有元素均在 $1$ 至 $N$ 的范围内。

定义长度为 $N$ 的非负整数序列 $A=(A_1,A_2,\ldots,A_N)$ 为 **好的整数序列**，当且仅当满足以下条件：
- 对于所有满足 $1 \leq i \leq M$ 的整数 $i$，有 $A_{X_i} \oplus A_{Y_i} = Z_i$，其中 $\oplus$ 表示异或运算。

请判断是否存在这样的好的整数序列。若存在，请找出使得元素总和 $\displaystyle \sum_{i=1}^N A_i$ 最小的好的整数序列，并输出该序列。

关于异或（XOR）的定义：  
对于非负整数 $A$ 和 $B$，它们的异或 $A \oplus B$ 定义如下：
- $A \oplus B$ 的二进制表示中，$2^k$ 位（$k \geq 0$）的值为 $1$，当且仅当 $A$ 和 $B$ 在 $2^k$ 位上的值不同；否则为 $0$。

例如，$3 \oplus 5 = 6$（二进制表示为 $011 \oplus 101 = 110$）。

## 输入格式

输入通过标准输入给出，格式如下：

> $N$ $M$  
> $X_1$ $Y_1$ $Z_1$  
> $X_2$ $Y_2$ $Z_2$  
> $\vdots$  
> $X_M$ $Y_M$ $Z_M$


## 输出格式

若不存在好的整数序列，输出 $-1$。  
若存在，则输出满足总和最小的好的整数序列，元素间用空格分隔。  
若存在多个总和最小的序列，输出任意一个均可。

## 说明/提示

### 约束条件

- $1 \leq N \leq 2 \times 10^5$
- $0 \leq M \leq 10^5$
- $1 \leq X_i, Y_i \leq N$
- $0 \leq Z_i \leq 10^9$
- 输入中的所有值均为整数

### 样例解释 1

序列 $A=(0, 3, 4)$ 满足 $A_1 \oplus A_2 = 3$ 和 $A_1 \oplus A_3 = 4$，因此是好的整数序列。其他可能的序列如 $A=(1, 2, 5)$ 或 $A=(7, 4, 3)$ 也满足条件，但总和最小的序列是 $A=(0, 3, 4)$。

### 样例解释 2

不存在满足条件的好的整数序列，因此输出 $-1$。

翻译由 DeepSeek R1 完成

## 样例 #1

### 输入

```
3 2
1 3 4
1 2 3
```

### 输出

```
0 3 4
```

## 样例 #2

### 输入

```
3 3
1 3 4
1 2 3
2 3 5
```

### 输出

```
-1
```

## 样例 #3

### 输入

```
5 8
4 2 4
2 3 11
3 4 15
4 5 6
3 2 11
3 3 0
3 1 9
3 4 15
```

### 输出

```
0 2 9 6 0
```



---


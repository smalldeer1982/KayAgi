---
title: "[ABC351E] Jump Distance Sum"
layout: "post"
diff: 普及+/提高
pid: AT_abc351_e
tag: ['差分']
---

# [ABC351E] Jump Distance Sum

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc351/tasks/abc351_e

座標平面上に $ N $ 個の点 $ P_1,P_2,\ldots,P_N $ があり、点 $ P_i $ の座標は $ (X_i,Y_i) $ です。  
$ 2 $ つの点 $ A,B $ の距離 $ \text{dist}(A,B) $ を次のように定義します。

> 最初、ウサギが点 $ A $ にいる。  
> $ (x,y) $ にいるウサギは $ (x+1,y+1) $, $ (x+1,y-1) $, $ (x-1,y+1) $, $ (x-1,y-1) $ のいずれかに $ 1 $ 回のジャンプで移動することができる。  
> 点 $ A $ から点 $ B $ まで移動するために必要なジャンプの回数の最小値を $ \text{dist}(A,B) $ として定義する。  
> ただし、何度ジャンプを繰り返しても点 $ A $ から点 $ B $ まで移動できないとき、$ \text{dist}(A,B)=0 $ とする。

$ \displaystyle\sum_{i=1}^{N-1}\displaystyle\sum_{j=i+1}^N\ \text{dist}(P_i,P_j) $ を求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ X_1 $ $ Y_1 $ $ X_2 $ $ Y_2 $ $ \vdots $ $ X_N $ $ Y_N $

## 输出格式

$ \displaystyle\sum_{i=1}^{N-1}\displaystyle\sum_{j=i+1}^N\ \text{dist}(P_i,P_j) $ の値を整数で出力せよ。

## 说明/提示

### 制約

- $ 2\leq\ N\leq\ 2\times\ 10^5 $
- $ 0\leq\ X_i,Y_i\leq\ 10^8 $
- $ i\neq\ j $ ならば $ (X_i,Y_i)\neq\ (X_j,Y_j) $
- 入力はすべて整数

### Sample Explanation 1

$ P_1,P_2,P_3 $ の座標はそれぞれ $ (0,0) $, $ (1,3) $, $ (5,6) $ です。 $ P_1 $ から $ P_2 $ へはウサギは $ (0,0)\to\ (1,1)\to\ (0,2)\to\ (1,3) $ と $ 3 $ 回で移動でき、$ 2 $ 回以下では $ P_1 $ から $ P_2 $ まで移動できないため、 $ \text{dist}(P_1,P_2)=3 $ です。 $ P_1 $ から $ P_3 $ および $ P_2 $ から $ P_3 $ へはウサギは移動できないため、$ \text{dist}(P_1,P_3)=\text{dist}(P_2,P_3)＝0 $ となります。 よって、答えは $ \displaystyle\sum_{i=1}^{2}\displaystyle\sum_{j=i+1}^3\text{dist}(P_i,P_j)=\text{dist}(P_1,P_2)+\text{dist}(P_1,P_3)+\text{dist}(P_2,P_3)=3+0+0=3 $ となります。

## 样例 #1

### 输入

```
3
0 0
1 3
5 6
```

### 输出

```
3
```

## 样例 #2

### 输入

```
5
0 5
1 7
2 9
3 8
4 6
```

### 输出

```
11
```



---

---
title: "[ABC404G] Specified Range Sums"
layout: "post"
diff: 普及+/提高
pid: AT_abc404_g
tag: ['最短路', '差分约束']
---

# [ABC404G] Specified Range Sums

## 题目描述

给你一个整数 $N$ 和 $M$ 个整数三元组 $(L_i,R_i,S_i)$。

判断是否存在一个长度为 $N$ 的**正整数**数列 $A$，满足对于所有的三元组限制 $(L_i,R_i,S_i)$，满足 $\sum\limits_{j=L_i}^{R_i}A_j=S_i$。如果存在，找出合法的 $A$ 的最小元素和。

## 输入格式

第一行两个整数 $N,M(1\le N,M\le 4000)$。\
接下来 $M$ 行，每行三个整数 $L_i,R_i,S_i(1\le L_i\le R_i\le N,1\le S_i\le 10^9)$。

## 输出格式

如果不存在符合条件的 $A$，输出一个整数 $-1$。\
否则，输出一个整数，表示合法的 $A$ 的最小元素和。

## 说明/提示

**样例 1 解释**

$A=(1,3,2,1,5)$ 是一种符合条件的情况。\
此情况下 $A$ 的和是 $12$，可以证明这是可能的最小值。

**样例 2 解释**

此时无解。

By chenxi2009

## 样例 #1

### 输入

```
5 3

1 2 4

2 3 5

5 5 5
```

### 输出

```
12
```

## 样例 #2

### 输入

```
1 2

1 1 1

1 1 2
```

### 输出

```
-1
```

## 样例 #3

### 输入

```
9 6

8 9 8

3 6 18

2 4 19

5 6 8

3 5 14

1 3 26
```

### 输出

```
44
```



---

---
title: "指定区间和"
layout: "post"
diff: 普及+/提高
pid: AT_abc404_g
tag: ['最短路', '差分约束']
---

# 指定区间和

## 题目描述

给你一个整数 $N$ 和 $M$ 个整数三元组 $(L_i,R_i,S_i)$。

判断是否存在一个长度为 $N$ 的**正整数**数列 $A$，满足对于所有的三元组限制 $(L_i,R_i,S_i)$，满足 $\sum\limits_{j=L_i}^{R_i}A_j=S_i$。如果存在，找出合法的 $A$ 的最小元素和。

## 输入格式

第一行两个整数 $N,M(1\le N,M\le 4000)$。\
接下来 $M$ 行，每行三个整数 $L_i,R_i,S_i(1\le L_i\le R_i\le N,1\le S_i\le 10^9)$。

## 输出格式

如果不存在符合条件的 $A$，输出一个整数 $-1$。\
否则，输出一个整数，表示合法的 $A$ 的最小元素和。

## 说明/提示

**样例 1 解释**

$A=(1,3,2,1,5)$ 是一种符合条件的情况。\
此情况下 $A$ 的和是 $12$，可以证明这是可能的最小值。

**样例 2 解释**

此时无解。

By chenxi2009

## 样例 #1

### 输入

```
5 3

1 2 4

2 3 5

5 5 5
```

### 输出

```
12
```

## 样例 #2

### 输入

```
1 2

1 1 1

1 1 2
```

### 输出

```
-1
```

## 样例 #3

### 输入

```
9 6

8 9 8

3 6 18

2 4 19

5 6 8

3 5 14

1 3 26
```

### 输出

```
44
```



---

---
title: "滑动窗口最大值"
layout: "post"
diff: 普及+/提高
pid: AT_abc407_f
tag: ['线段树', '树状数组', '差分', '单调栈']
---

# 滑动窗口最大值

## 题目描述

给你一个长度为 $N$ 的数列 $A=(A_1,\dots,A_N)$，请对于所有 $1\le k\le N$ 求解下面的问题：

- 求出 $A$ 的全部 $N-k+1$ 个连续子序列的最大值的和。

## 输入格式

将按照以下格式输入：

> $N$
>
> $A_1$ $ A_2$ $A_3$ $\dots$ $A_N$

## 输出格式

$N$ 行，第 $i$ 行为 $k=i$ 时所求解问题的答案。

## 说明/提示

### 数据规模与约定

- $1 \le N \le 2 \times 10^{5}$
- $0 \le A_i \le 10^{7} (1 \le i \le N)$
- 输入的所有数字为整数。

## 样例 #1

### 输入

```
4
5 3 4 2
```

### 输出

```
14
13
9
5
```

## 样例 #2

### 输入

```
8
2 0 2 5 0 5 2 4
```

### 输出

```
20
28
27
25
20
15
10
5
```

## 样例 #3

### 输入

```
11
9203973 9141294 9444773 9292472 5507634 9599162 497764 430010 4152216 3574307 430010
```

### 输出

```
61273615
68960818
69588453
65590626
61592799
57594972
47995810
38396648
28797486
19198324
9599162
```



---

---
title: "[AGC035B] Even Degrees"
layout: "post"
diff: 普及+/提高
pid: AT_agc035_b
tag: ['图论', '构造', '差分']
---

# [AGC035B] Even Degrees

## 题目描述

[problemUrl]: https://atcoder.jp/contests/agc035/tasks/agc035_b

$ N $ 頂点 $ M $ 辺の単純連結無向グラフが与えられます。頂点には $ 1 $ から $ N $ までの番号がついており、$ i $ 本目の辺は頂点 $ A_i $ と頂点 $ B_i $ を結んでいます。 高橋君は、与えられたグラフのすべての辺にどちらかの向きをつけて有向グラフを作ります。 どの頂点から出る辺の本数も偶数になるような有向グラフを作ることが可能かどうか判定し、可能ならそのような例をひとつ構成してください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ M $ $ A_1 $ $ B_1 $ $ : $ $ A_M $ $ B_M $

## 输出格式

条件を満たす向き付けが不可能な場合、$ -1 $ を出力せよ。 そうでない場合、以下の形式でグラフのすべての辺の向きを重複なく出力せよ。

> $ C_1 $ $ D_1 $ $ : $ $ C_M $ $ D_M $

ただし、組 $ (C_i,D_i) $ は $ C_i $ から頂点 $ D_i $ に向かって向き付けられた辺が存在することを表す。 辺は任意の順で出力して構わない。

## 说明/提示

### ノート

無向グラフが単純であるとは、自己ループと多重辺を含まないことを指します。

### 制約

- $ 2\ \leq\ N\ \leq\ 10^5 $
- $ N-1\ \leq\ M\ \leq\ 10^5 $
- $ 1\ \leq\ A_i,B_i\ \leq\ N\ (1\leq\ i\leq\ M) $
- 与えられるグラフは単純かつ連結

### Sample Explanation 1

このように向き付けることで、頂点 $ 1,3 $ からは $ 2 $ 本、頂点 $ 2,4 $ からは $ 0 $ 本の辺が出るようになります。

## 样例 #1

### 输入

```
4 4

1 2

2 3

3 4

4 1
```

### 输出

```
1 2

1 4

3 2

3 4
```

## 样例 #2

### 输入

```
5 5

1 2

2 3

3 4

2 5

4 5
```

### 输出

```
-1
```



---

---
title: "[ABC087D] People on a Line"
layout: "post"
diff: 普及+/提高
pid: AT_arc090_b
tag: ['搜索', '并查集', '深度优先搜索 DFS', '差分约束', '差分']
---

# [ABC087D] People on a Line

## 题目描述

在一根数轴上站有 $n$ 个人，我们称第 $i$ 个人的坐标为 $x_i(x_i\in [0,10^{9}],x_i\in Z)$，同一个坐标点上可能有多个人。

你现在手上有 $m$ 条信息，第 $i$ 条信息形如 $(li,ri,di)$，含义是第 $r_i$ 个人在第 $l_i$ 个人右数第 $d_i$ 个坐标点上，换言之，$x_{r_i} - x_{l_i} = d_i$。

不幸的是，这 $m$ 条信息中的一些可能有误，请你求出是否存在一组 $x (x_1,x_2,x_3,\dots ,x_n)$ 满足所有信息。

## 输入格式

输入数据的第一行包含两个以空格分开的整数 $n$ 和 $m$，分别表示总人数和信息条数；

接下来的 $m$ 行中第 $i(1\le i\le m)$ 行包含三个以空格分开的整数 $l_i,r_i,d_i$，表示第 $i$ 条信息是 $r_i$ 号人在 $l_i$ 号人右边 $d_i$ 个位置上。

## 输出格式

若存在一组合法的 $x$，输出一行 ``Yes``；否则输出一行 ``No``。

## 说明/提示

全部的输入数据满足以下条件：

-  $1 \le n \le 100000$；
-  $0 \le m \le 200000$；
- $1\le l_i,r_i\le n (1\le i\le m)$；
- $0\le d_i\le 10000 (1\le i\le m)$；
- $l_i \ne r_i (1 \le i \le m)$；
- 如果 $i\le j$，则有 $(l_i,r_i)\ne (l_j,r_j),(l_i,r_i)\ne (r_j,l_j)$；
- $d_i$ 为整数。


$(0,1,2)$ 与 $(101,102,103)$ 都是合法的解。


若前两条信息是正确的，则有 $x_3 - x_1 = 2$，那么第三条信息就是错误的。

感谢@fbhou  提供的翻译

## 样例 #1

### 输入

```
3 3

1 2 1

2 3 1

1 3 2
```

### 输出

```
Yes
```

## 样例 #2

### 输入

```
3 3

1 2 1

2 3 1

1 3 5
```

### 输出

```
No
```

## 样例 #3

### 输入

```
4 3

2 1 1

2 3 5

3 4 2
```

### 输出

```
Yes
```

## 样例 #4

### 输入

```
10 3

8 7 100

7 9 100

9 8 100
```

### 输出

```
No
```

## 样例 #5

### 输入

```
100 0
```

### 输出

```
Yes
```



---

---
title: "[ARC189B] Minimize Sum"
layout: "post"
diff: 普及+/提高
pid: AT_arc189_b
tag: ['数学', '差分']
---

# [ARC189B] Minimize Sum

## 题目描述

数轴上有 $N$ 个棋子，最初所有棋子都放置在不同的坐标上，第 $i$ 个棋子放置在坐标 $X_i$ 上。

你可以进行以下操作若干次（可以为 $0$ 次）：

- 选择一个 $i$ 满足 $1\le i\le N-3$，并设 $M$ 为 $X_i$ 与 $X_{i+3}$ 的中点坐标。

- 然后，分别将坐标为 $X_{i+1}$ 与 $X_{i+2}$ 的两颗棋子放在原坐标关于 $M$ 对称的坐标，最后，使坐标较小的棋子的坐标为 $X_{i+1}$，另外一个棋子的坐标为 $X_{i+2}$。

- 可以证明无论如何重复操作，所有的棋子都放置在不同的坐标处。

请找出若干次操作后，$\sum_{i=1}^N X_i$ 的最小值。

## 输入格式

输入按以下格式给出：

> $N$
>
> $X_1$ $X_2$ $\dots$ $X_N$

## 输出格式

一行一个数，表示若干次操作后，$\sum_{i=1}^N X_i$ 的最小值。

Translated by @[ARIS2_0](luogu://user/1340759)

## 样例 #1

### 输入

```
4

1 5 7 10
```

### 输出

```
21
```

## 样例 #2

### 输入

```
6

0 1 6 10 14 16
```

### 输出

```
41
```



---

---
title: "フェーン現象 (Foehn Phenomena)"
layout: "post"
diff: 普及+/提高
pid: AT_joi2017ho_a
tag: ['线段树', '树状数组', '差分']
---

# フェーン現象 (Foehn Phenomena)

## 题目描述

### 题目简述

你知道$N+1$个地点的海拔$A_i$,编号为$0 \dots N$,有风从$0$吹向$N$,想让你求出地点$N$的风的温度.

保证$A_0=0$

规则：
- 如果$A_i=A_{i+1}$风的温度不变.
- 如果$A_i>A_{i+1}$由于海拔降低,风的温度会上升$(A_i-A_{i+1})\times T$度
- 如果$A_i<A_{i+1}$由于海拔升高,风的温度会下降$(A_{i+1}-A_i)\times S$度

## 输入格式

从标准输入中读入下面的数据.

- 第一行输入包括四个被空格隔开的整数$N,Q,S,T$.这表示JOI先生在地点$N$有一所房子,有$Q$次地壳运动,海拔每上升1米的话,风的温度会降低$S$度,海拔每下降一米的话,风的温度会上升$T$度.
- 接下来的$N+1$行中第$i$行$(1\leq i\leq N+1)$包含一个整数$A_{i-1}$,表示地壳运动前地点$i-1$的海拔高度.
- 接下来的$Q$行中第$j$行$(1\leq j\leq Q)$包括三个被空格隔开的整数$L_j,R_j,X_j$.这表示第$j$天地壳运动使地点$L_j$到地点$R_j$中这些地点的海拔变化了$X_j$

## 输出格式

输出$Q$行,第$j$行的输出代表第$j$天地壳运动后JOI先生家的风的温度.
(即$N$位置的风的温度)

## 样例 #1

### 输入

```
3 5 1 2
0
4
1
8
1 2 2
1 1 -2
2 3 5
1 2 -1
1 3 5
```

### 输出

```
-5
-7
-13
-13
-18
```

## 样例 #2

### 输入

```
2 2 5 5
0
6
-1
1 1 4
1 2 8
```

### 输出

```
5
-35
```

## 样例 #3

### 输入

```
7 8 8 13
0
4
-9
4
-2
3
10
-9
1 4 8
3 5 -2
3 3 9
1 7 4
3 5 -1
5 6 3
4 4 9
6 7 -10
```

### 输出

```
277
277
322
290
290
290
290
370
```



---


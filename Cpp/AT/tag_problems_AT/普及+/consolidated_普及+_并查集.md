---
title: "[ABC120D] Decayed Bridges"
layout: "post"
diff: 普及+/提高
pid: AT_abc120_d
tag: ['图论', '并查集']
---

# [ABC120D] Decayed Bridges

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc120/tasks/abc120_d

$ N $ 個の島と $ M $ 本の橋があります。

$ i $ 番目の橋は $ A_i $ 番目の島と $ B_i $ 番目の島を繋いでおり、双方向に行き来可能です。

はじめ、どの $ 2 $ つの島についてもいくつかの橋を渡って互いに行き来できます。

調査の結果、老朽化のためこれら $ M $ 本の橋は $ 1 $ 番目の橋から順に全て崩落することがわかりました。

「いくつかの橋を渡って互いに行き来できなくなった $ 2 $ つの島の組 $ (a,\ b) $ ($ a\ <\ b $) の数」を**不便さ**と呼ぶことにします。

各 $ i $ $ (1\ \leq\ i\ \leq\ M) $ について、$ i $ 番目の橋が崩落した直後の不便さを求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ M $ $ A_1 $ $ B_1 $ $ A_2 $ $ B_2 $ $ \vdots $ $ A_M $ $ B_M $

## 输出格式

$ i\ =\ 1,\ 2,\ ...,\ M $ の順に、$ i $ 番目の橋が崩落した直後の不便さを出力せよ。 答えが $ 32 $ bit整数型に収まらない場合があることに注意すること。

## 说明/提示

### 制約

- 入力は全て整数である。
- $ 2\ \leq\ N\ \leq\ 10^5 $
- $ 1\ \leq\ M\ \leq\ 10^5 $
- $ 1\ \leq\ A_i\ <\ B_i\ \leq\ N $
- $ (A_i,\ B_i) $ の組は全て異なる。
- 初期状態における不便さは $ 0 $ である。

### Sample Explanation 1

例えば、$ 1 $ から $ 3 $ 番目の橋が崩落したとき、$ (1,\ 2),\ (1,\ 3),\ (2,\ 4),\ (3,\ 4) $ の島の組について行き来できなくなるので不便さは $ 4 $ です。

## 样例 #1

### 输入

```
4 5

1 2

3 4

1 3

2 3

1 4
```

### 输出

```
0

0

4

5

6
```

## 样例 #2

### 输入

```
6 5

2 3

1 2

5 6

3 4

4 5
```

### 输出

```
8

9

12

14

15
```

## 样例 #3

### 输入

```
2 1

1 2
```

### 输出

```
1
```



---

---
title: "[ABC181F] Silver Woods"
layout: "post"
diff: 普及+/提高
pid: AT_abc181_f
tag: ['二分', '并查集']
---

# [ABC181F] Silver Woods

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc181/tasks/abc181_f

$ xy $ 平面上に $ 2 $ 直線 $ y=-100,\ y=100 $ で囲まれた通路があります。

この通路の中の $ -100\ <\ x\ <\ 100 $ の部分に $ N $ 本の大きさの無視できる釘が打たれており、 $ i $ 本目の釘の座標は $ (x_i,\ y_i) $ です。

高橋くんは実数 $ r\ (0\ <\ r\ \leq\ 100) $ を $ 1 $ つ選び、半径 $ r $ の円を中心が $ (-10^9,\ 0) $ に位置するように置きます。

その後、円を $ (-10^9,\ 0) $ から $ (10^9,\ 0) $ まで移動させます。

このとき、円は通路の境界や釘が円の内部に入らないような範囲で連続的に動かすことができるものとします。

円を $ (10^9,\ 0) $ まで動かせるような最大の $ r $ を求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ x_1 $ $ y_1 $ $ \vdots $ $ x_N $ $ y_N $

## 输出格式

円を $ (10^9,\ 0) $ まで動かせるような最大の $ r $ を出力せよ。  
 なお、想定解答との絶対誤差または相対誤差が $ 10^{-4} $ 以下であれば正解として扱われる。

## 说明/提示

### 制約

- 入力はすべて整数
- $ 1\ \leq\ N\ \leq\ 100 $
- $ |x_i|,\ |y_i|\ <\ 100 $
- $ i\ \neq\ j $ ならば $ (x_i,\ y_i)\ \neq\ (x_j,\ y_j) $

### Sample Explanation 1

!\[\](https://img.atcoder.jp/ghi/493d8b75d6dd331fcc0f3949f12262b3.jpg) $ r=40 $ の円を図のように $ y=0 $ に沿って動かすと、 $ (-10^9,\ 0) $ から $ (10^9,\ 0) $ まで移動させることができます。 $ x=0 $ のときにちょうど $ 2 $ つの点と接しますが、円の内部には入っていないため問題ありません。 $ r $ を $ 40 $ より大きくすると、円の中心を $ (10^9,\ 0) $ まで動かすことができなくなるため、 $ r=40 $ が最大になります。

## 样例 #1

### 输入

```
2

0 -40

0 40
```

### 输出

```
40
```

## 样例 #2

### 输入

```
4

0 -10

99 10

0 91

99 -91
```

### 输出

```
50.5
```

## 样例 #3

### 输入

```
10

-90 40

20 -30

0 -90

10 -70

80 70

-90 30

-20 -80

10 90

50 30

60 -70
```

### 输出

```
33.541019662496845446
```

## 样例 #4

### 输入

```
10

65 -90

-34 -2

62 99

42 -13

47 -84

84 87

16 -78

56 35

90 8

90 19
```

### 输出

```
35.003571246374276203
```



---

---
title: "[ABC247F] Cards"
layout: "post"
diff: 普及+/提高
pid: AT_abc247_f
tag: ['动态规划 DP', '并查集']
---

# [ABC247F] Cards

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc247/tasks/abc247_f

$ 1,\ldots,N $ の番号がついた $ N $ 枚のカードがあり、カード $ i $ の表には $ P_i $ が、裏には $ Q_i $ が書かれています。  
 ここで、$ P=(P_1,\ldots,P_N) $ 及び $ Q=(Q_1,\ldots,Q_N) $ はそれぞれ $ (1,\ 2,\ \dots,\ N) $ の並び替えです。

$ N $ 枚のカードから何枚かを選ぶ方法のうち、次の条件を満たすものは何通りありますか？ $ 998244353 $ で割った余りを求めてください。

条件：$ 1,2,\ldots,N $ のどの数も選んだカードのいずれかに書かれている

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ P_1 $ $ P_2 $ $ \ldots $ $ P_N $ $ Q_1 $ $ Q_2 $ $ \ldots $ $ Q_N $

## 输出格式

答えを出力せよ。

## 说明/提示

### 制約

- $ 1\ \leq\ N\ \leq\ 2\times\ 10^5 $
- $ 1\ \leq\ P_i,Q_i\ \leq\ N $
- $ P,Q $ はそれぞれ $ (1,\ 2,\ \dots,\ N) $ の並び替えである
- 入力に含まれる値は全て整数である

### Sample Explanation 1

例えばカード $ 1,3 $ を選ぶと、$ 1 $ はカード $ 1 $ の表に、$ 2 $ はカード $ 1 $ の裏に、$ 3 $ はカード $ 3 $ の表に書かれているため条件を満たします。 条件を満たすカードの選び方は $ \{1,3\},\{2,3\},\{1,2,3\} $ の $ 3 $ 通りです。

## 样例 #1

### 输入

```
3

1 2 3

2 1 3
```

### 输出

```
3
```

## 样例 #2

### 输入

```
5

2 3 5 4 1

4 2 1 3 5
```

### 输出

```
12
```

## 样例 #3

### 输入

```
8

1 2 3 4 5 6 7 8

1 2 3 4 5 6 7 8
```

### 输出

```
1
```



---

---
title: "[ABC314F] A Certain Game"
layout: "post"
diff: 普及+/提高
pid: AT_abc314_f
tag: ['并查集']
---

# [ABC314F] A Certain Game

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc314/tasks/abc314_f

とあるゲームの大会に、プレイヤー $ 1 $ 、プレイヤー $ 2 $ 、$ \ldots $ 、プレイヤー $ N $ の $ N $ 人のプレイヤーが参加します。 大会の開始直前、各プレイヤーはそれぞれ $ 1 $ 人のみからなるチームをなし、全部で $ N $ 個のチームがあります。

大会では全部で $ N−1 $ 回の試合があり、各試合では $ 2 $ つの異なるチームが選ばれ、一方が先攻を、もう一方が後攻を受け持って対戦し、その結果ちょうど一方のチームが勝ちます。 具体的には、$ i\ =\ 1,\ 2,\ \ldots,\ N-1 $ について $ i $ 回目の試合は下記の通りに進行します。

- プレイヤー $ p_i $ の属するチームが先攻、プレイヤー $ q_i $ の属するチームが後攻として、対戦を行う。
- その結果、先攻チームの人数を $ a $ 、後攻チームの人数を $ b $ として、$ \frac{a}{a+b} $ の確率で先攻のチームが、$ \frac{b}{a+b} $ の確率で後攻のチームが勝つ。
- その後、勝負した $ 2 $ チームは $ 1 $ つのチームに併合される。

なお、各試合の対戦結果は他の試合の対戦結果とは独立です。

$ N $ 人のプレイヤーそれぞれについて、大会全体で自分が所属するチームが勝つという出来事が起こる回数の期待値 $ \text{mod\ }\ 998244353 $ を出力してください。

 期待値 $ \text{mod\ }\ 998244353 $ の定義この問題で求める期待値は必ず有理数になることが証明できます。 また、この問題の制約下では、求める期待値を既約分数 $ \frac{y}{x} $ で表したときに $ x $ が $ 998244353 $ で割り切れないことが保証されます。

このとき $ xz\ \equiv\ y\ \pmod{998244353} $ を満たすような $ 0 $ 以上 $ 998244352 $ 以下の整数 $ z $ が一意に定まります。この $ z $ を答えてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ p_1 $ $ q_1 $ $ p_2 $ $ q_2 $ $ \vdots $ $ p_{N-1} $ $ q_{N-1} $

## 输出格式

各 $ i\ =\ 1,\ 2,\ \ldots,\ N $ について、大会全体でプレイヤー $ i $ が所属するチームが勝つという出来事が起こる回数の期待値 $ \text{mod\ }\ 998244353 $ である $ E_i $ を、 下記の形式にしたがって空白区切りで出力せよ。

> $ E_1 $ $ E_2 $ $ \ldots $ $ E_N $

## 说明/提示

### 制約

- $ 2\ \leq\ N\ \leq\ 2\ \times\ 10^5 $
- $ 1\ \leq\ p_i,\ q_i\ \leq\ N $
- $ i $ 回目の試合の直前、プレイヤー $ p_i $ が属するチームとプレイヤー $ q_i $ が属するチームは異なる。
- 入力はすべて整数

### Sample Explanation 1

チームに所属するプレイヤーの番号が $ x_1,\ x_2,\ \ldots,\ x_k $ であるチームを、チーム $ \lbrace\ x_1,\ x_2,\ \ldots,\ x_k\ \rbrace $ と呼びます。 - $ 1 $ 回目の試合では、プレイヤー $ 1 $ が所属するチーム $ \lbrace\ 1\ \rbrace $ とプレイヤー $ 2 $ が所属するチーム $ \lbrace\ 2\ \rbrace $ が対戦し、 $ \frac{1}{2} $ の確率でチーム $ \lbrace\ 1\ \rbrace $ が、$ \frac{1}{2} $ の確率でチーム $ \lbrace\ 2\ \rbrace $ が勝ちます。 その後、$ 2 $ つのチームは併合され、$ 1 $ つのチーム $ \lbrace\ 1,\ 2\ \rbrace $ になります。 - $ 2 $ 回目の試合では、プレイヤー $ 4 $ が所属するチーム $ \lbrace\ 4\ \rbrace $ とプレイヤー $ 3 $ が所属するチーム $ \lbrace\ 3\ \rbrace $ が対戦し、 $ \frac{1}{2} $ の確率でチーム $ \lbrace\ 4\ \rbrace $ が、$ \frac{1}{2} $ の確率でチーム $ \lbrace\ 3\ \rbrace $ が勝ちます。 その後、$ 2 $ つのチームは併合され、$ 1 $ つのチーム $ \lbrace\ 3,\ 4\ \rbrace $ になります。 - $ 3 $ 回目の試合では、プレイヤー $ 5 $ が所属するチーム $ \lbrace\ 5\ \rbrace $ とプレイヤー $ 3 $ が所属するチーム $ \lbrace\ 3,\ 4\ \rbrace $ が対戦し、 $ \frac{1}{3} $ の確率でチーム $ \lbrace\ 5\ \rbrace $ が、$ \frac{2}{3} $ の確率でチーム $ \lbrace\ 3,\ 4\ \rbrace $ が勝ちます。 その後、$ 2 $ つのチームは併合され、$ 1 $ つのチーム $ \lbrace\ 3,\ 4,\ 5\ \rbrace $ になります。 - $ 4 $ 回目の試合では、プレイヤー $ 1 $ が所属するチーム $ \lbrace\ 1,\ 2\ \rbrace $ とプレイヤー $ 4 $ が所属するチーム $ \lbrace\ 3,\ 4,\ 5\ \rbrace $ が対戦し、 $ \frac{2}{5} $ の確率でチーム $ \lbrace\ 1,\ 2\ \rbrace $ が、$ \frac{3}{5} $ の確率でチーム $ \lbrace\ 3,\ 4,\ 5\ \rbrace $ が勝ちます。 その後、$ 2 $ つのチームは併合され、$ 1 $ つのチーム $ \lbrace\ 1,\ 2,\ 3,\ 4,\ 5\ \rbrace $ になります。 プレイヤー $ 1,\ 2,\ 3,\ 4,\ 5 $ それぞれの、大会全体で自分が所属するチームが勝つという出来事が起こる回数の期待値 $ E_1,\ E_2,\ E_3,\ E_4,\ E_5 $ は、それぞれ $ \frac{9}{10},\ \frac{9}{10},\ \frac{53}{30},\ \frac{53}{30},\ \frac{14}{15} $ です。

## 样例 #1

### 输入

```
5
1 2
4 3
5 3
1 4
```

### 输出

```
698771048 698771048 964969543 964969543 133099248
```

## 样例 #2

### 输入

```
15
9 2
8 10
13 6
12 11
7 10
4 10
14 2
5 4
1 15
15 2
6 9
8 11
6 3
2 8
```

### 输出

```
43970290 310168785 806914186 501498951 950708909 272140427 335124893 168750835 310168785 168750835 280459129 280459129 272140427 476542843 43970290
```



---

---
title: "[ABC328F] Good Set Query"
layout: "post"
diff: 普及+/提高
pid: AT_abc328_f
tag: ['并查集']
---

# [ABC328F] Good Set Query

## 题目描述

### 题目内容

给定 $Q$ 个三元组 $(a_1,b_1,d_1),(a_2,b_2,d_2),...,(a_Q,b_Q,d_Q)$ 。

集合 ${1,2,...,Q}$ 的一个子集 $S$ 被定义为**好的子集**，当且仅当存在一个长度为 $N$ 的序列 $(X_1,X_2,...,X_N)$ 满足以下条件：

> 对于所有 $i\in S$ ， $X_{a_i}-X_{b_i}=d_i$ 。

将 $S$ 初始化为空集，对于 $i=1,2,...,Q$ 依次进行以下操作：

> 如果 $S\cup \{i\}$ 是一个好的集合，那么将 $S$ 替换成 $S\cup \{i\}$ 。

以**升序**输出 $S$ 中的所有元素。

## 输入格式

从标准输入流读入，格式如下：

$$
N\quad Q\\
a_1\quad b_1\quad d_1\\
a_2\quad b_2\quad d_2\\
.\\
.\\
.\\
a_Q\quad b_Q\quad d_Q\\
$$

## 输出格式

以**升序**按照以下格式输出集合 $S$ 中的所有元素 $(s_1,s_2,...,s_k)$ ：

$$
s_1\quad s_2\quad ...\quad s_k
$$

## 说明/提示

* 所有输入元素为整数。
* $1\le N,Q\le 2\times 10^5$
* $1\le a_i,b_i\le N$
* $-10^9\le d_i\le 10^9$

## 样例 #1

### 输入

```
3 5

1 2 2

3 2 -3

2 1 -1

3 3 0

1 3 5
```

### 输出

```
1 2 4 5
```

## 样例 #2

### 输入

```
200000 1

1 1 1
```

### 输出

```

```

## 样例 #3

### 输入

```
5 20

4 2 125421359

2 5 -191096267

3 4 -42422908

3 5 -180492387

3 3 174861038

2 3 -82998451

3 4 -134761089

3 1 -57159320

5 2 191096267

2 4 -120557647

4 2 125421359

2 3 142216401

4 5 -96172984

3 5 -108097816

1 5 -50938496

1 2 140157771

5 4 65674908

4 3 35196193

4 4 0

3 4 188711840
```

### 输出

```
1 2 3 6 8 9 11 14 15 16 17 19
```



---

---
title: "[ABC355F] MST Query"
layout: "post"
diff: 普及+/提高
pid: AT_abc355_f
tag: ['并查集', '生成树', '动态树 LCT']
---

# [ABC355F] MST Query

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc355/tasks/abc355_f

頂点に $ 1 $ から $ N $ の番号が、辺に $ 1 $ から $ N-1 $ の番号が付いた $ N $ 頂点 $ N-1 $ 辺の重み付き無向連結グラフ $ G $ が与えられます。辺 $ i $ は頂点 $ a_i $ と頂点 $ b_i $ を結んでおり、その重みは $ c_i $ です。

$ Q $ 個のクエリが与えられるので順に処理してください。$ i $ 番目のクエリは以下で説明されます。

- 整数 $ u_i,v_i,w_i $ が与えられる。$ G $ の頂点 $ u_i,v_i $ の間に重み $ w_i $ の辺を追加する。その後、$ G $ の最小全域木に含まれる辺の重みの和を出力する。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ Q $ $ a_1 $ $ b_1 $ $ c_1 $ $ \vdots $ $ a_{N-1} $ $ b_{N-1} $ $ c_{N-1} $ $ u_1 $ $ v_1 $ $ w_1 $ $ \vdots $ $ u_Q $ $ v_Q $ $ w_Q $

## 输出格式

$ Q $ 行出力せよ。$ i $ 行目には $ i $ 番目のクエリに対する答えを出力せよ。

## 说明/提示

### 制約

- $ 2\leq\ N\leq\ 2\ \times\ 10^5 $
- $ 1\leq\ Q\leq\ 2\ \times\ 10^5 $
- $ 1\leq\ a_i\lt\ b_i\leq\ N $
- $ 1\leq\ u_i\lt\ v_i\leq\ N $
- $ 1\leq\ c_i,w_i\leq\ 10 $
- クエリを処理する前のグラフは連結
- 入力はすべて整数
 
### Sample Explanation 1

各クエリで辺を追加した後のグラフを示しています。最小全域木に含まれる辺は赤色で塗られています。 !\[\](https://img.atcoder.jp/abc355/4e83a6e54750f138ecada66dd93b2b67.png)

## 样例 #1

### 输入

```
4 4

1 2 6

2 3 5

2 4 4

1 3 3

1 2 3

1 4 10

3 4 1
```

### 输出

```
12

10

10

7
```

## 样例 #2

### 输入

```
8 6

1 8 8

1 6 10

1 5 8

2 6 6

6 7 6

1 3 9

2 4 7

1 3 4

1 6 7

3 4 6

1 5 1

7 8 4

3 5 3
```

### 输出

```
49

46

45

38

34

33
```



---

---
title: "[ABC372E] K-th Largest Connected Components"
layout: "post"
diff: 普及+/提高
pid: AT_abc372_e
tag: ['并查集', '标签477']
---

# [ABC372E] K-th Largest Connected Components

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc372/tasks/abc372_e

$ N $ 頂点 $ 0 $ 辺の無向グラフがあります。頂点には $ 1 $ から $ N $ の番号がつけられています。

$ Q $ 個のクエリが与えられるので、与えられた順に処理してください。各クエリは以下の $ 2 $ 種類のいずれかです。

- タイプ $ 1 $ : `1 u v` の形式で与えられる。頂点 $ u $ と頂点 $ v $ の間に辺を追加する。
- タイプ $ 2 $ : `2 v k` の形式で与えられる。頂点 $ v $ と連結な頂点の中で、$ k $ 番目に頂点番号が大きいものを出力する。ただし、頂点 $ v $ と連結な頂点が $ k $ 個未満のときは `-1` を出力する。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ Q $ $ \mathrm{query}_1 $ $ \mathrm{query}_2 $ $ \vdots $ $ \mathrm{query}_Q $

ただし、$ \mathrm{query}_i $ は $ i $ 個目のクエリであり、以下のいずれかの形式で与えられる。

> $ 1 $ $ u $ $ v $

> $ 2 $ $ v $ $ k $

## 输出格式

タイプ $ 2 $ のクエリの個数を $ q $ として、$ q $ 行出力せよ。$ i $ 行目には $ i $ 個目のタイプ $ 2 $ に対するクエリの答えを出力せよ。

## 说明/提示

### 制約

- $ 1\leq\ N,Q\leq\ 2\times\ 10^5 $
- タイプ $ 1 $ のクエリにおいて、$ 1\leq\ u\lt\ v\leq\ N $
- タイプ $ 2 $ のクエリにおいて、$ 1\leq\ v\leq\ N,\ 1\leq\ k\leq\ 10 $
- 入力は全て整数
 
### Sample Explanation 1

\- $ 1 $ 個目のクエリについて、頂点 $ 1 $ と頂点 $ 2 $ の間に辺が追加されます。 - $ 2 $ 個目のクエリについて、頂点 $ 1 $ と連結な頂点は $ 1,2 $ の $ 2 $ つです。この中で $ 1 $ 番目に大きい $ 2 $ を出力します。 - $ 3 $ 個目のクエリについて、頂点 $ 1 $ と連結な頂点は $ 1,2 $ の $ 2 $ つです。この中で $ 2 $ 番目に大きい $ 1 $ を出力します。 - $ 4 $ 個目のクエリについて、頂点 $ 1 $ と連結な頂点は $ 1,2 $ の $ 2 $ つです。$ 3 $ 個未満なので `-1` を出力します。 - $ 5 $ 個目のクエリについて、頂点 $ 1 $ と頂点 $ 3 $ の間に辺が追加されます。 - $ 6 $ 個目のクエリについて、頂点 $ 2 $ と頂点 $ 3 $ の間に辺が追加されます。 - $ 7 $ 個目のクエリについて、頂点 $ 3 $ と頂点 $ 4 $ の間に辺が追加されます。 - $ 8 $ 個目のクエリについて、頂点 $ 1 $ と連結な頂点は $ 1,2,3,4 $ の $ 4 $ つです。この中で $ 1 $ 番目に大きい $ 4 $ を出力します。 - $ 9 $ 個目のクエリについて、頂点 $ 1 $ と連結な頂点は $ 1,2,3,4 $ の $ 4 $ つです。この中で $ 3 $ 番目に大きい $ 2 $ を出力します。 - $ 10 $ 個目のクエリについて、頂点 $ 1 $ と連結な頂点は $ 1,2,3,4 $ の $ 4 $ つです。$ 5 $ 個未満なので `-1` を出力します。

## 样例 #1

### 输入

```
4 10

1 1 2

2 1 1

2 1 2

2 1 3

1 1 3

1 2 3

1 3 4

2 1 1

2 1 3

2 1 5
```

### 输出

```
2

1

-1

4

2

-1
```

## 样例 #2

### 输入

```
6 20

1 3 4

1 3 5

2 1 1

2 3 1

1 1 5

2 6 9

2 1 3

2 6 1

1 4 6

2 2 1

2 6 2

2 4 7

1 1 4

2 6 2

2 3 4

1 2 5

2 4 1

1 1 6

2 3 3

2 1 3
```

### 输出

```
1

5

-1

3

6

2

5

-1

5

3

6

4

4
```



---

---
title: "[ABC378F] Add One Edge 2"
layout: "post"
diff: 普及+/提高
pid: AT_abc378_f
tag: ['并查集', '排列组合']
---

# [ABC378F] Add One Edge 2

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc378/tasks/abc378_f

$ N $ 頂点の木が与えられます。$ i $ 番目の辺 $ (1\leq\ i\leq\ N-1) $ は頂点 $ u_i $ と頂点 $ v_i $ を双方向に結んでいます。

与えられた木に無向辺を一本追加して得られるグラフは、必ずちょうど一つの閉路を含みます。

そのようなグラフのうち、以下の条件を全て満たすものの個数を求めてください。

- グラフは単純グラフ
- グラフの閉路に含まれる頂点の次数は全て $ 3 $

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ u_1 $ $ v_1 $ $ u_2 $ $ v_2 $ $ \vdots $ $ u_{N-1} $ $ v_{N-1} $

## 输出格式

答えを出力せよ。

## 说明/提示

### 制約

- $ 3\ \leq\ N\ \leq\ 2\ \times\ 10^5 $
- $ 1\leq\ u_i,v_i\leq\ N $
- 与えられるグラフは木である
- 入力される数値は全て整数
 
### Sample Explanation 1

頂点 $ 2 $ と頂点 $ 4 $ を結ぶ辺を追加して得られるグラフは単純グラフであり、閉路に含まれる頂点の次数は全て $ 3 $ なので条件を満たします。

### Sample Explanation 2

条件を満たすグラフが存在しない場合もあります。

## 样例 #1

### 输入

```
6

1 2

2 3

3 4

4 5

3 6
```

### 输出

```
1
```

## 样例 #2

### 输入

```
7

1 2

2 7

3 5

7 3

6 2

4 7
```

### 输出

```
0
```

## 样例 #3

### 输入

```
15

1 15

11 14

2 10

1 7

9 8

6 9

4 12

14 5

4 9

8 11

7 4

1 13

3 6

11 10
```

### 输出

```
6
```



---

---
title: "[ABC380E] 1D Bucket Tool"
layout: "post"
diff: 普及+/提高
pid: AT_abc380_e
tag: ['并查集']
---

# [ABC380E] 1D Bucket Tool

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc380/tasks/abc380_e

$ 1 $ から $ N $ の番号がついた $ N $ 個のマスが一列に並んでいます。  
$ 1\ \leq\ i\ <\ N $ について、マス $ i $ とマス $ i+1 $ は隣接しています。

最初、マス $ i $ は色 $ i $ で塗られています。

クエリが $ Q $ 個与えられるので、順に処理してください。クエリは次の $ 2 $ 種類のいずれかです。

- `1 x c`: マス $ x $ から始めて「いまいるマスと同じ色に塗られている隣接するマス」への移動を繰り返すことで到達可能なマスを全て色 $ c $ に塗り替える
- `2 c`: 色 $ c $ で塗られているマスの個数を答える

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ Q $ $ \mathrm{query}_1 $ $ \vdots $ $ \mathrm{query}_Q $

各クエリは以下の $ 2 $ 種類のいずれかの形式で与えられる。

> $ 1 $ $ x $ $ c $

> $ 2 $ $ c $

## 输出格式

$ 2 $ 種類目のクエリの回数を $ q $ として、$ q $ 行出力せよ。  
$ i $ 行目には、$ i $ 回目のそのようなクエリに対する答えを出力せよ。

## 说明/提示

### 制約

- $ 1\ \leq\ N\ \leq\ 5\times\ 10^5 $
- $ 1\ \leq\ Q\ \leq\ 2\times\ 10^5 $
- $ 1 $ 種類目のクエリにおいて、$ 1\ \leq\ x\ \leq\ N $
- $ 1,2 $ 種類目のクエリにおいて、$ 1\ \leq\ c\ \leq\ N $
- $ 2 $ 種類目のクエリが少なくとも $ 1 $ つ存在する
- 入力は全て整数である

### Sample Explanation 1

クエリにより、マスの色は図のように塗り替えられていきます。 
![図](https://img.atcoder.jp/abc380/c3bf3eec819a7b7fcbfd21065c06bab2.png)

## 样例 #1

### 输入

```
5 6
1 5 4
1 4 2
2 2
1 3 2
1 2 3
2 3
```

### 输出

```
3
4
```



---

---
title: "[ABC401E] Reachable Set"
layout: "post"
diff: 普及+/提高
pid: AT_abc401_e
tag: ['并查集']
---

# [ABC401E] Reachable Set

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc401/tasks/abc401_e

给定一个包含 $N$ 个顶点和 $M$ 条边的无向图。顶点编号为 $1,2,\ldots,N$，第 $i$ 条边 $(1 \leq i \leq M)$ 连接顶点 $u_i$ 和顶点 $v_i$。

对于每个 $k=1,2,\ldots,N$，请解决以下问题：

> 考虑以下操作：
> 
> - 选择一个顶点，删除该顶点及其所有连接的边。
>  
> 通过重复上述操作，判断是否能够满足以下条件：
> 
> - 从顶点 $1$ 出发，通过边能够到达的顶点集合恰好为 $\{1,2,\ldots,k\}$（共 $k$ 个顶点）。
>  
> 如果可能，求出满足条件所需的最少操作次数；否则输出 `-1`。

## 输入格式

输入通过标准输入给出，格式如下：

> $N$ $M$  
> $u_1$ $v_1$  
> $u_2$ $v_2$  
> $\vdots$  
> $u_M$ $v_M$


## 输出格式

输出 $N$ 行。第 $i$ 行 $(1 \leq i \leq N)$ 输出 $k=i$ 时的答案：若无法满足条件则输出 `-1`，否则输出所需的最少操作次数。


## 说明/提示

### 约束条件

- $1 \leq N \leq 2 \times 10^5$
- $0 \leq M \leq 3 \times 10^5$
- $1 \leq u_i < v_i \leq N$ $(1 \leq i \leq M)$
- $(u_i, v_i) \neq (u_j, v_j)$ $(1 \leq i < j \leq M)$
- 输入的所有数值均为整数

### 样例解释 1

例如，当 $k=2$ 时，可以通过删除顶点 $3$、顶点 $4$ 和顶点 $5$（共 3 次操作），使得从顶点 $1$ 可达的顶点仅为 $\{1,2\}$。由于无法通过少于 3 次操作满足条件，因此第 2 行输出 `3`。  
当 $k=6$ 时，不需要删除任何顶点即可满足条件，因此第 6 行输出 `0`。

### 样例解释 3

图中可能不存在任何边。

翻译由 DeepSeek V3 完成

## 样例 #1

### 输入

```
6 7

1 2

1 5

2 3

2 4

2 5

3 6

5 6
```

### 输出

```
2

3

3

2

1

0
```

## 样例 #2

### 输入

```
5 4

1 5

2 3

3 4

4 5
```

### 输出

```
1

-1

-1

-1

0
```

## 样例 #3

### 输入

```
2 0
```

### 输出

```
0

-1
```

## 样例 #4

### 输入

```
11 25

6 9

5 9

2 3

1 9

10 11

4 5

9 10

8 9

7 8

3 5

1 7

6 10

4 7

7 9

1 10

4 11

3 8

2 7

3 4

1 8

2 8

3 7

2 10

1 6

6 11
```

### 输出

```
5

-1

-1

-1

-1

-1

4

3

2

1

0
```



---

---
title: "[ABC409F] Connecting Points"
layout: "post"
diff: 普及+/提高
pid: AT_abc409_f
tag: ['并查集', '枚举']
---

# [ABC409F] Connecting Points

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc409/tasks/abc409_f

在二维平面上有一个初始为 $N$ 个顶点、$0$ 条边的图 $G$。顶点编号为 $1$ 到 $N$，顶点 $i$ 的坐标为 $(x_i,y_i)$。

对于图 $G$ 中的顶点 $u$ 和 $v$，定义它们之间的距离 $d(u,v)$ 为曼哈顿距离：$d(u,v)=|x_u-x_v|+|y_u-y_v|$。

对于图 $G$ 的两个连通分量 $A$ 和 $B$，设它们的顶点集合分别为 $V(A)$ 和 $V(B)$，则定义 $A$ 和 $B$ 之间的距离 $d(A,B)$ 为：$d(A,B)=\min\lbrace d(u,v) \mid u \in V(A), v \in V(B) \rbrace$。

请处理以下 $Q$ 个查询，查询分为三种类型：

1. `1 a b`：设当前图 $G$ 的顶点数为 $n$，在坐标 $(a,b)$ 处新增顶点 $n+1$，并将其加入图 $G$。
2. `2`：设当前图 $G$ 的顶点数为 $n$，连通分量数为 $m$：
   - 若 $m=1$，输出 `-1`。
   - 若 $m \geq 2$，找到距离最小的连通分量对，并将它们合并（即在这些连通分量之间添加边，使得所有距离等于最小值的顶点对相连），然后输出该最小距离值。
3. `3 u v`：若顶点 $u$ 和 $v$ 属于同一连通分量，输出 `Yes`；否则输出 `No`。

## 输入格式

输入通过标准输入给出，格式如下：

> $N$ $Q$  
> $x_1$ $y_1$  
> $x_2$ $y_2$  
> $\vdots$  
> $x_N$ $y_N$  
> $\mathrm{query}_1$  
> $\mathrm{query}_2$  
> $\vdots$  
> $\mathrm{query}_Q$

每个查询为以下三种形式之一：

> $1$ $a$ $b$  
> $2$  
> $3$ $u$ $v$

## 输出格式

按照题目要求输出每个查询的结果，每个结果占一行。

## 说明/提示

### 约束条件

- $2 \leq N \leq 1500$
- $1 \leq Q \leq 1500$
- $0 \leq x_i, y_i \leq 10^9$
- 对于类型 `1` 的查询，$0 \leq a, b \leq 10^9$
- 对于类型 `3` 的查询，设处理该查询前图 $G$ 的顶点数为 $n$，则 $1 \leq u < v \leq n$
- 输入均为整数

### 样例解释 1

初始时，顶点 $1,2,3,4$ 的坐标分别为 $(3,4),(3,3),(7,3),(2,2)$。  
- 第 1 个查询：顶点 $1$ 和 $2$ 不连通，输出 `No`。  
- 第 2 个查询：有 4 个连通分量（$\lbrace 1 \rbrace, \lbrace 2 \rbrace, \lbrace 3 \rbrace, \lbrace 4 \rbrace$），最小距离为 $1$（顶点 $1$ 和 $2$ 之间），合并后输出 $1$。  
- 第 3 个查询：顶点 $1$ 和 $2$ 已连通，输出 `Yes`。  
- 第 4 个查询：新增顶点 $5$，坐标为 $(6,4)$。  
- 第 5 个查询：最小距离为 $2$（顶点 $2$ 和 $4$、顶点 $3$ 和 $5$ 之间），合并后输出 $2$。  
- 第 6 个查询：顶点 $2$ 和 $5$ 不连通，输出 `No`。  
- 第 7 个查询：最小距离为 $3$（顶点 $1$ 和 $5$ 之间），合并后输出 $3$。  
- 第 8 个查询：顶点 $2$ 和 $5$ 已连通，输出 `Yes`。  
- 第 9 个查询：所有顶点连通，输出 `-1`。  
- 第 10 个查询：新增顶点 $6$，坐标为 $(2,2)$。  
- 第 11 个查询：最小距离为 $0$（顶点 $4$ 和 $6$ 之间），合并后输出 $0$。

翻译由 DeepSeek V3 完成

## 样例 #1

### 输入

```
4 11
3 4
3 3
7 3
2 2
3 1 2
2
3 1 2
1 6 4
2
3 2 5
2
3 2 5
2
1 2 2
2
```

### 输出

```
No
1
Yes
2
No
3
Yes
-1
0
```



---

---
title: "[ABC087D] People on a Line"
layout: "post"
diff: 普及+/提高
pid: AT_arc090_b
tag: ['搜索', '并查集', '深度优先搜索 DFS', '差分约束', '差分']
---

# [ABC087D] People on a Line

## 题目描述

在一根数轴上站有 $n$ 个人，我们称第 $i$ 个人的坐标为 $x_i(x_i\in [0,10^{9}],x_i\in Z)$，同一个坐标点上可能有多个人。

你现在手上有 $m$ 条信息，第 $i$ 条信息形如 $(li,ri,di)$，含义是第 $r_i$ 个人在第 $l_i$ 个人右数第 $d_i$ 个坐标点上，换言之，$x_{r_i} - x_{l_i} = d_i$。

不幸的是，这 $m$ 条信息中的一些可能有误，请你求出是否存在一组 $x (x_1,x_2,x_3,\dots ,x_n)$ 满足所有信息。

## 输入格式

输入数据的第一行包含两个以空格分开的整数 $n$ 和 $m$，分别表示总人数和信息条数；

接下来的 $m$ 行中第 $i(1\le i\le m)$ 行包含三个以空格分开的整数 $l_i,r_i,d_i$，表示第 $i$ 条信息是 $r_i$ 号人在 $l_i$ 号人右边 $d_i$ 个位置上。

## 输出格式

若存在一组合法的 $x$，输出一行 ``Yes``；否则输出一行 ``No``。

## 说明/提示

全部的输入数据满足以下条件：

-  $1 \le n \le 100000$；
-  $0 \le m \le 200000$；
- $1\le l_i,r_i\le n (1\le i\le m)$；
- $0\le d_i\le 10000 (1\le i\le m)$；
- $l_i \ne r_i (1 \le i \le m)$；
- 如果 $i\le j$，则有 $(l_i,r_i)\ne (l_j,r_j),(l_i,r_i)\ne (r_j,l_j)$；
- $d_i$ 为整数。


$(0,1,2)$ 与 $(101,102,103)$ 都是合法的解。


若前两条信息是正确的，则有 $x_3 - x_1 = 2$，那么第三条信息就是错误的。

感谢@fbhou  提供的翻译

## 样例 #1

### 输入

```
3 3

1 2 1

2 3 1

1 3 2
```

### 输出

```
Yes
```

## 样例 #2

### 输入

```
3 3

1 2 1

2 3 1

1 3 5
```

### 输出

```
No
```

## 样例 #3

### 输入

```
4 3

2 1 1

2 3 5

3 4 2
```

### 输出

```
Yes
```

## 样例 #4

### 输入

```
10 3

8 7 100

7 9 100

9 8 100
```

### 输出

```
No
```

## 样例 #5

### 输入

```
100 0
```

### 输出

```
Yes
```



---


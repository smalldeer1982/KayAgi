---
title: "[ABC371E] I Hate Sigma Problems"
layout: "post"
diff: 普及+/提高
pid: AT_abc371_e
tag: ['排列组合']
---

# [ABC371E] I Hate Sigma Problems

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc371/tasks/abc371_e

長さ $ N $ の整数列 $ A=(A_1,A_2,\ldots,A_N) $ が与えられます。また、$ f(l,r) $ を以下で定義します。

- $ (A_l,A_{l+1},\ldots,A_{r-1},A_{r}) $ に含まれる値の種類数
 
次の式の値を求めてください。

 $ \displaystyle\ \sum_{i=1}^{N}\sum_{j=i}^N\ f(i,j) $

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ A_1 $ $ \ldots $ $ A_N $

## 输出格式

答えを出力せよ。

## 说明/提示

### 制約

- $ 1\leq\ N\leq\ 2\times\ 10^5 $
- $ 1\leq\ A_i\leq\ N $
- 入力される数値は全て整数
 
### Sample Explanation 1

$ f(1,2) $ について考えます。$ (A_1,A_2)=(1,2) $ に含まれる値の種類数は $ 2 $ なので $ f(1,2)=2 $ です。 $ f(2,3) $ について考えます。$ (A_2,A_3)=(2,2) $ に含まれる値の種類数は $ 1 $ なので $ f(2,3)=1 $ です。 $ f $ の総和は $ 8 $ となります。

## 样例 #1

### 输入

```
3

1 2 2
```

### 输出

```
8
```

## 样例 #2

### 输入

```
9

5 4 2 2 3 2 4 4 1
```

### 输出

```
111
```



---

---
title: "[ABC378F] Add One Edge 2"
layout: "post"
diff: 普及+/提高
pid: AT_abc378_f
tag: ['并查集', '排列组合']
---

# [ABC378F] Add One Edge 2

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc378/tasks/abc378_f

$ N $ 頂点の木が与えられます。$ i $ 番目の辺 $ (1\leq\ i\leq\ N-1) $ は頂点 $ u_i $ と頂点 $ v_i $ を双方向に結んでいます。

与えられた木に無向辺を一本追加して得られるグラフは、必ずちょうど一つの閉路を含みます。

そのようなグラフのうち、以下の条件を全て満たすものの個数を求めてください。

- グラフは単純グラフ
- グラフの閉路に含まれる頂点の次数は全て $ 3 $

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ u_1 $ $ v_1 $ $ u_2 $ $ v_2 $ $ \vdots $ $ u_{N-1} $ $ v_{N-1} $

## 输出格式

答えを出力せよ。

## 说明/提示

### 制約

- $ 3\ \leq\ N\ \leq\ 2\ \times\ 10^5 $
- $ 1\leq\ u_i,v_i\leq\ N $
- 与えられるグラフは木である
- 入力される数値は全て整数
 
### Sample Explanation 1

頂点 $ 2 $ と頂点 $ 4 $ を結ぶ辺を追加して得られるグラフは単純グラフであり、閉路に含まれる頂点の次数は全て $ 3 $ なので条件を満たします。

### Sample Explanation 2

条件を満たすグラフが存在しない場合もあります。

## 样例 #1

### 输入

```
6

1 2

2 3

3 4

4 5

3 6
```

### 输出

```
1
```

## 样例 #2

### 输入

```
7

1 2

2 7

3 5

7 3

6 2

4 7
```

### 输出

```
0
```

## 样例 #3

### 输入

```
15

1 15

11 14

2 10

1 7

9 8

6 9

4 12

14 5

4 9

8 11

7 4

1 13

3 6

11 10
```

### 输出

```
6
```



---

---
title: "[AGC051A] Dodecagon"
layout: "post"
diff: 普及+/提高
pid: AT_agc051_a
tag: ['数学', '排列组合']
---

# [AGC051A] Dodecagon

## 题目描述

[problemUrl]: https://atcoder.jp/contests/agc051/tasks/agc051_a

すぬけ君は、正方形のタイルと正三角形のタイルを無限枚持っています。タイルの辺の長さは全て $ 1 $ です。 これらを使って、辺の長さが $ d $ の正 $ 12 $ 角形を作る方法は何通りあるでしょうか。 この答えを $ 998,244,353 $ で割った余りを計算してください。

厳密に述べると、

- タイルを使う枚数に制限はありません。
- 使ったタイルのうち、どの $ 2 $ 枚も重なっていてはいけません。
- 使ったタイルが覆う領域の和集合は、穴のない正 $ 12 $ 角形でなければなりません。
- 二つの作り方について、一方に回転と平行移動を施す (鏡映は不可) ことでもう一方を得られる、すなわち一方における各タイルがもう一方における同種のタイルと完全に一致するとき、これらの作り方を同一とみなします。

## 输入格式

入力は標準入力から以下の形式で与えられる。

> $ d $

## 输出格式

答えを出力せよ。

## 说明/提示

### 制約

- $ 1\ \leq\ d\ \leq\ 10^6 $
- 入力中の全ての値は整数である。

### Sample Explanation 1

唯一の作り方を以下の図に示します。 !\[\](https://img.atcoder.jp/agc051/dad0de5f2e5c47119aa1a0da8ed28808.png)

## 样例 #1

### 输入

```
1
```

### 输出

```
1
```



---

---
title: "[ARC156B] Mex on Blackboard"
layout: "post"
diff: 普及+/提高
pid: AT_arc156_b
tag: ['组合数学', '排列组合']
---

# [ARC156B] Mex on Blackboard

## 题目描述

[problemUrl]: https://atcoder.jp/contests/arc156/tasks/arc156_b

有限個の非負整数からなる多重集合 $ S $ にたいして、$ \mathrm{mex}(S) $ を、$ S $ に含まれない最小の非負整数と定義します。例えば、$ \mathrm{mex}(\lbrace\ 0,0,\ 1,3\rbrace\ )\ =\ 2,\ \mathrm{mex}(\lbrace\ 1\ \rbrace)\ =\ 0,\ \mathrm{mex}(\lbrace\ \rbrace)\ =\ 0 $ です。

黒板に $ N $ 個の非負整数が書かれており、$ i $ 番目の非負整数は $ A_i $ です。

あなたは、以下の操作をちょうど $ K $ 回行います。

- 黒板に書かれている非負整数を $ 0 $ 個以上選ぶ。選んだ非負整数からなる多重集合を $ S $ として、$ \mathrm{mex}(S) $ を黒板に $ 1 $ 個書き込む。
 
最終的に黒板に書かれている非負整数の多重集合としてありうるものの個数を $ 998244353 $ で割ったあまりを求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ K $ $ A_1 $ $ A_2 $ $ \ldots $ $ A_N $

## 输出格式

答えを出力せよ。

## 说明/提示

### 制約

- $ 1\ \leq\ N,K\ \leq\ 2\times\ 10^5 $
- $ 0\leq\ A_i\leq\ 2\times\ 10^5 $
- 入力される数値は全て整数
 
### Sample Explanation 1

操作後に得られる多重集合は、以下の $ 3 $ 通りです。 - $ \lbrace\ 0,0,1,3\ \rbrace $ - $ \lbrace\ 0,1,1,3\rbrace $ - $ \lbrace\ 0,1,2,3\ \rbrace $ 例えば、$ \lbrace\ 0,1,1,3\rbrace $ は黒板に書かれている $ 0 $ を選び、$ S=\lbrace\ 0\rbrace $ として操作をすることで得られます。

### Sample Explanation 2

操作後に得られる多重集合は、以下の $ 2 $ 通りです。 - $ \lbrace\ 0,0,0\ \rbrace $ - $ \lbrace\ 0,0,1\rbrace $ 操作で選ぶ整数は $ 0 $ 個でも良いことに注意してください。

## 样例 #1

### 输入

```
3 1

0 1 3
```

### 输出

```
3
```

## 样例 #2

### 输入

```
2 1

0 0
```

### 输出

```
2
```

## 样例 #3

### 输入

```
5 10

3 1 4 1 5
```

### 输出

```
7109
```



---

---
title: "[ARC171B] Chmax"
layout: "post"
diff: 普及+/提高
pid: AT_arc171_b
tag: ['组合数学', '排列组合']
---

# [ARC171B] Chmax

## 题目描述

对于一个 $1$ 到 $N$ 的排列 $P=(P_1,P_2,\cdots,P_N)$，如下定义 $F(P)$：

- 初始序列 $B=(1,2,\cdots,N)$。只要有一个整数 $i$ 令 $B_i<P_{B_i}$ 存在，就进行下面的操作：
    - 找到最小的满足 $B_j<P_{B_j}$ 的整数 $j$，则将 $B_j$ 替换为 $P_{B_j}$。
  
  将 $F(P)$ 定义为这一过程结束时的 $B$（可以证明这个过程会在有限步数后终止）。

给你一个长度为 $N$ 的序列 $A=(A_1,A_2,\cdots,A_N)$，请问有多少个 $1$ 到 $N$ 的排列 $P$ 满足 $F(P) = A$？答案对 $998244353$ 取模。

## 输入格式

第一行一个整数 $N$，接下来 $N$ 个整数 $A_1,A_2,\cdots,A_N$。

## 输出格式

输出答案，对 $998244353$ 取模。

### 样例 1 解释

> 以下用 $\xrightarrow{j}(B_1',B_2',\cdots,B_N')$ 表示选择 $j$ 将 $B_j$ 替换为 $P_{B_j}$ 得到 $(B_1',B_2',\cdots,B_N')$。

选择 $P=(2,3,1,4)$，然后
$$\begin{aligned}(1,2,3,4)&\xrightarrow{1}(2,2,3,4)\\&\xrightarrow{1}(3,2,3,4)\\&\xrightarrow{2}(3,3,3,4)\\\end{aligned}$$
于是 $F((2,3,1,4))=(3,3,3,4)$。

只有这一个 $P$ 满足 $F(P)=(3,3,3,4)$。

## 说明/提示

- $1 \leq N \leq 2 \times 10^5$
- $1 \leq A_i \leq N$
- 所有的输入都是整数。

## 样例 #1

### 输入

```
4

3 3 3 4
```

### 输出

```
1
```

## 样例 #2

### 输入

```
4

2 2 4 3
```

### 输出

```
0
```

## 样例 #3

### 输入

```
8

6 6 8 4 5 6 8 8
```

### 输出

```
18
```



---

---
title: "[ARC172B] AtCoder Language"
layout: "post"
diff: 普及+/提高
pid: AT_arc172_b
tag: ['组合数学', '排列组合']
---

# [ARC172B] AtCoder Language

## 题目描述

[problemUrl]: https://atcoder.jp/contests/arc172/tasks/arc172_b

AtCoder 語には $ L $ 種類の文字があります。 AtCoder 語の文字からなる $ N $ 文字の文字列 $ s $ のうち、以下の条件を満たすものは何通りありますか。 答えを $ 998244353 $ で割った余りを求めてください。

- 文字列 $ s $ のどの「$ K $ 文字の部分列」も異なる。厳密には、文字列 $ s $ から $ K $ 文字を抜き出し、そのままの順序で連結して $ K $ 文字の文字列を得る方法は $ _N\mathrm{C}_K $ 通りあるが、それらすべてが異なる文字列を生成する。
 
 $ _N\mathrm{C}_K $ とは$ N $ 個のものの中から $ K $ 個を選ぶ方法の総数を指します。より厳密には、$ _N\mathrm{C}_K $ は $ N! $ を $ K!\ \times\ (N-K)! $ で割った値です。

## 输入格式

入力は以下の形式で標準入力から与えられます。

> $ N $ $ K $ $ L $

## 输出格式

答えを出力してください。

## 说明/提示

### 制約

- $ 1\ \leq\ K\ <\ N\ \leq\ 500000 $
- $ 1\ \leq\ L\ \leq\ 10^9 $
- 入力はすべて整数
 
### Sample Explanation 1

AtCoder 語の $ 1 $ 種類目の文字を `a`、$ 2 $ 種類目の文字を `b` と表すとき、条件を満たす文字列は `abab`、`baba` の $ 2 $ 通りとなります。

### Sample Explanation 2

条件を満たす文字列はおよそ $ 10^{86} $ 通りありますが、ここでは $ 998244353 $ で割った余りである $ 496798269 $ を出力します。

## 样例 #1

### 输入

```
4 3 2
```

### 输出

```
2
```

## 样例 #2

### 输入

```
100 80 26
```

### 输出

```
496798269
```

## 样例 #3

### 输入

```
100 1 26
```

### 输出

```
0
```

## 样例 #4

### 输入

```
500000 172172 503746693
```

### 输出

```
869120
```



---


---
title: "[ABC034C] 経路"
layout: "post"
diff: 普及+/提高
pid: AT_abc034_c
tag: ['组合数学', '逆元']
---

# [ABC034C] 経路

## 题目描述

有一个 $W$ 行 $H$ 列的网格图（$2 \leq W,H \leq 10^5$），其中第 $i$ 行第 $j$ 列的坐标为 $(i,j)$。

现在有一个人想从起点 $(1,1)$ 走到终点 $(W,H)$，已知他每次可以从网格 $(i,j)$ 走向 $(i+1,j)$ 或 $(i,j+1)$。现在请你求出，他从起点走到终点的路线个数为多少。

由于这个数可能很大，因此你只要输出路线个数对 $10^9 + 7$ 取模的结果即可。

## 输入格式

一行两个正整数 $W,H$，含义如上所述。

## 输出格式

一行一个整数，表示路线个数对 $10^9 + 7$ 取模的结果。

Translated by [user/817365](https://www.luogu.com.cn/user/817365)

## 样例 #1

### 输入

```
4 3
```

### 输出

```
10
```

## 样例 #2

### 输入

```
123 456
```

### 输出

```
210368064
```



---

---
title: "[ABC151E] Max-Min Sums"
layout: "post"
diff: 普及+/提高
pid: AT_abc151_e
tag: ['数学', '组合数学']
---

# [ABC151E] Max-Min Sums

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc151/tasks/abc151_e

有限個の整数からなる集合 $ X $ に対し $ f(X)=\max\ X\ -\ \min\ X $ と定義します。

$ N $ 個の整数 $ A_1,...,A_N $ が与えられます。

このうち $ K $ 個を選び、それらからなる集合を $ S $ とします。同じ値であっても添字が異なる要素を区別すると、そのような選び方は $ {}_N\ C_K $ 通りありますが、その全てについての $ f(S) $ の合計を求めてください。

答えは非常に大きくなる可能性があるので、$ \bmod\ 10^9+7 $ で出力してください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ K $ $ A_1 $ $ ... $ $ A_N $

## 输出格式

答えを $ \bmod\ 10^9+7 $ で出力せよ。

## 说明/提示

### 制約

- $ 1\ \leq\ N\ \leq\ 10^5 $
- $ 1\ \leq\ K\ \leq\ N $
- $ |A_i|\ \leq\ 10^9 $

### Sample Explanation 1

$ S $ の選び方は $ \{1,1\},\{1,3\},\{1,4\},\{1,3\},\{1,4\},\{3,4\} $ の $ 6 $ 通りあり (ふたつの $ 1 $ は区別します)、$ f(S) $ はそれぞれ $ 0,2,3,2,3,1 $ となるので、合計は $ 11 $ です。

### Sample Explanation 2

$ S $ の選び方は $ 20 $ 通りあり、そのうち $ 18 $ 通りで $ f(S)=20 $、$ 2 $ 通りで $ f(S)=0 $ となります。

### Sample Explanation 4

合計は $ \bmod\ 10^9+7 $ で出力してください。

## 样例 #1

### 输入

```
4 2

1 1 3 4
```

### 输出

```
11
```

## 样例 #2

### 输入

```
6 3

10 10 10 -10 -10 -10
```

### 输出

```
360
```

## 样例 #3

### 输入

```
3 1

1 1 1
```

### 输出

```
0
```

## 样例 #4

### 输入

```
10 6

1000000000 1000000000 1000000000 1000000000 1000000000 0 0 0 0 0
```

### 输出

```
999998537
```



---

---
title: "[ABC339F] Product Equality"
layout: "post"
diff: 普及+/提高
pid: AT_abc339_f
tag: ['数学', '哈希 hashing']
---

# [ABC339F] Product Equality

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc339/tasks/abc339_f

$ N $ 個の整数 $ A_1,A_2,\dots,A_N $ が与えられます。  
 以下の条件を満たす整数の組 $ (i,j,k) $ の個数を求めてください。

- $ 1\ \le\ i,j,k\ \le\ N $
- $ A_i\ \times\ A_j\ =\ A_k $

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ A_1 $ $ A_2 $ $ \vdots $ $ A_N $

## 输出格式

答えを整数として出力せよ。

## 说明/提示

### 制約

- $ 1\ \le\ N\ \le\ 1000 $
- $ \color{red}{1\ \le\ A_i\ <\ 10^{1000}} $
 
### Sample Explanation 1

問題文中の条件を満たす $ (i,j,k) $ の組は以下の $ 6 $ 通りです。 - $ (1,2,3) $ - $ (1,3,4) $ - $ (1,4,5) $ - $ (2,1,3) $ - $ (3,1,4) $ - $ (4,1,5) $

### Sample Explanation 2

各整数 $ A_i $ の値が非常に大きくなりうることに注意してください。

### Sample Explanation 3

$ A_i $ の値に重複がありうることに注意してください。

## 样例 #1

### 输入

```
5

2

3

6

12

24
```

### 输出

```
6
```

## 样例 #2

### 输入

```
11

1

2

3

4

5

6

123456789123456789

123456789123456789

987654321987654321

987654321987654321

121932631356500531347203169112635269
```

### 输出

```
40
```

## 样例 #3

### 输入

```
9

4

4

4

2

2

2

1

1

1
```

### 输出

```
162
```



---

---
title: "[ABC340F] S = 1"
layout: "post"
diff: 普及+/提高
pid: AT_abc340_f
tag: ['数学', '扩展欧几里德算法']
---

# [ABC340F] S = 1

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc340/tasks/abc340_f

整数 $ X,\ Y $ が与えられます。$ X,\ Y $ は $ X\ \neq\ 0 $ と $ Y\ \neq\ 0 $ の少なくとも一方を満たします。  
 次の条件を全て満たす整数の組 $ (A,\ B) $ を発見してください。そのような整数の組が存在しない場合はそれを報告してください。

- $ -10^{18}\ \leq\ A,\ B\ \leq\ 10^{18} $
- $ xy $ 平面上の点 $ (0,\ 0),\ (X,\ Y),\ (A,\ B) $ を頂点とする三角形の面積は $ 1 $

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ X $ $ Y $

## 输出格式

条件を満たす整数の組 $ (A,\ B) $ が存在する場合は以下の形式で出力せよ。

> $ A $ $ B $

条件を満たす整数の組 $ (A,\ B) $ が存在しない場合は `-1` を出力せよ。

## 说明/提示

### 制約

- $ -10^{17}\ \leq\ X,\ Y\ \leq\ 10^{17} $
- $ (X,\ Y)\ \neq\ (0,\ 0) $
- $ X,\ Y $ は整数
 
### Sample Explanation 1

点 $ (0,\ 0),\ (3,\ 5),\ (1,\ 1) $ を頂点とする三角形の面積は $ 1 $ です。よって $ (A,\ B)\ =\ (1,\ 1) $ は条件を満たします。

## 样例 #1

### 输入

```
3 5
```

### 输出

```
1 1
```

## 样例 #2

### 输入

```
-2 0
```

### 输出

```
0 1
```

## 样例 #3

### 输入

```
8752654402832944 -6857065241301125
```

### 输出

```
-1
```



---

---
title: "[ABC343E] 7x7x7"
layout: "post"
diff: 普及+/提高
pid: AT_abc343_e
tag: ['数学', '枚举']
---

# [ABC343E] 7x7x7

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc343/tasks/abc343_e

> 座標空間上に一辺 $ 7 $ の立方体を $ 3 $ つ、ちょうど $ 1,2,3 $ 個の立方体に含まれる領域の体積がそれぞれ $ V_1,V_2,V_3 $ となるように配置したいです。

$ 3 $ つの整数 $ a,b,c $ に対し、$ (a\leq\ x\leq\ a+7)\ \land\ (b\leq\ y\leq\ b+7)\ \land\ (c\leq\ z\leq\ c+7) $ で表される立方体領域を $ C(a,b,c) $ とおきます。

以下の条件を全て満たすような $ 9 $ つの整数 $ a_1,b_1,c_1,a_2,b_2,c_2,a_3,b_3,c_3 $ が存在するか判定し、存在するならば実際に $ 1 $ つ求めてください。

- $ |a_1|,|b_1|,|c_1|,|a_2|,|b_2|,|c_2|,|a_3|,|b_3|,|c_3|\ \leq\ 100 $
- $ C_i\ =\ C(a_i,b_i,c_i)\ (i=1,2,3) $ とおいたとき、
  - $ C_1,C_2,C_3 $ のうちちょうど $ 1 $ 個に含まれる領域の体積は $ V_1 $ である。
  - $ C_1,C_2,C_3 $ のうちちょうど $ 2 $ 個に含まれる領域の体積は $ V_2 $ である。
  - $ C_1,C_2,C_3 $ の全てに含まれる領域の体積は $ V_3 $ である。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ V_1 $ $ V_2 $ $ V_3 $

## 输出格式

問題文中の条件を全て満たすような $ 9 $ つの整数 $ a_1,b_1,c_1,a_2,b_2,c_2,a_3,b_3,c_3 $ が存在しないならば `No` を出力し、存在するならば以下の形式で出力せよ。 複数存在する場合はそのどれを出力してもよい。

> Yes $ a_1 $ $ b_1 $ $ c_1 $ $ a_2 $ $ b_2 $ $ c_2 $ $ a_3 $ $ b_3 $ $ c_3 $

## 说明/提示

### 制約

- $ 0\leq\ V_1,V_2,V_3\ \leq\ 3\times\ 7^3 $
- 入力は全て整数

### Sample Explanation 1

$ (a_1,b_1,c_1,a_2,b_2,c_2,a_3,b_3,c_3)=(0,0,0,0,6,0,6,0,0) $ の場合を考えます。 !\[\](https://img.atcoder.jp/abc343/aa534bf0a0e8e3f3487c5eeb540e54dc.png) この図は $ C_1,C_2,C_3 $ の位置関係を表したもので、それぞれ橙、水色、緑の立方体に対応しています。 このとき、 - $ |a_1|,|b_1|,|c_1|,|a_2|,|b_2|,|c_2|,|a_3|,|b_3|,|c_3| $ は全て $ 100 $ 以下 - $ C_1,C_2,C_3 $ の全てに含まれる領域は $ (6\leq\ x\leq\ 7)\land\ (6\leq\ y\leq\ 7)\ \land\ (0\leq\ z\leq\ 7) $ であり、その体積は $ (7-6)\times(7-6)\times(7-0)=7 $ - $ C_1,C_2,C_3 $ のうちちょうど $ 2 $ 個に含まれる領域は $ ((0\leq\ x\ <\ 6)\land\ (6\leq\ y\leq\ 7)\ \land\ (0\leq\ z\leq\ 7))\lor((6\leq\ x\leq\ 7)\land\ (0\leq\ y\ <\ 6)\ \land\ (0\leq\ z\leq\ 7)) $ であり、 その体積は $ (6-0)\times(7-6)\times(7-0)\times\ 2=84 $ - $ C_1,C_2,C_3 $ のうちちょうど $ 1 $ 個に含まれる領域の体積は $ 840 $ であり、条件を全て満たします。 $ (a_1,b_1,c_1,a_2,b_2,c_2,a_3,b_3,c_3)=(-10,\ 0,\ 0,\ -10,\ 0,\ 6,\ -10,\ 6,\ 1) $ なども同様に条件を全て満たすため、正当な出力として判定されます。

### Sample Explanation 2

条件を全て満たすような $ 9 $ つの整数 $ a_1,b_1,c_1,a_2,b_2,c_2,a_3,b_3,c_3 $ は存在しません。

## 样例 #1

### 输入

```
840 84 7
```

### 输出

```
Yes
0 0 0 0 6 0 6 0 0
```

## 样例 #2

### 输入

```
343 34 3
```

### 输出

```
No
```



---

---
title: "[ABC354D] AtCoder Wallpaper"
layout: "post"
diff: 普及+/提高
pid: AT_abc354_d
tag: ['数学', '分类讨论']
---

# [ABC354D] AtCoder Wallpaper

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc354/tasks/abc354_d

AtCoder 社の壁紙の模様を $ xy $ 平面上に表現すると、以下のようになります。

- 以下の $ 3 $ 種類の直線で領域が分割されている。 
  - $ x\ =\ n $ ($ n $ は整数)
  - $ y\ =\ n $ ($ n $ は偶数)
  - $ x\ +\ y\ =\ n $ ($ n $ は偶数)
- 各領域は白もしくは黒で塗られている。いずれかの直線で隣接する $ 2 $ 領域は異なる色で塗られている。
- $ (0.5,\ 0.5) $ を含む領域は黒で塗られている。

下の図は、模様の一部を表したものです。

![](https://cdn.luogu.com.cn/upload/vjudge_pic/AT_abc354_d/1813abe2f2a9c36459abd56b5463d1fab3634991.png)

整数 $ A,\ B,\ C,\ D $ が与えられます。各辺が $ x,\ y $ 軸に平行で、左下の頂点が $ (A,\ B) $ にあり右上の頂点が $ (C,\ D) $ にあるような長方形を考えます。この長方形の内側に存在する黒で塗られた領域の面積を求め、それを $ 2 $ 倍したものを出力してください。

出力する値は整数になることが証明できます。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ A $ $ B $ $ C $ $ D $

## 输出格式

答えを一行に出力せよ。

## 说明/提示

### 制約

- $ -10^9\ \leq\ A,\ B,\ C,\ D\ \leq\ 10^9 $
- $ A\ <\ C $ かつ $ B\ <\ D $
- 入力はすべて整数

### Sample Explanation 1

求めるのは、以下の正方形で囲われた領域内の黒く塗られた領域の面積です。 !\[\](https://img.atcoder.jp/abc354/d\_img2\_zzwqsaaewub.png) これは $ 5 $ なので、 $ 2 $ 倍した $ 10 $ を出力します。

### Sample Explanation 2

面積は $ 5.5 $ と小数になりますが、出力するべき値は整数になります。

### Sample Explanation 3

これは長方形が最大のケースですが、出力は 64bit 符号付き整数の範囲に収まります。

## 样例 #1

### 输入

```
0 0 3 3
```

### 输出

```
10
```

## 样例 #2

### 输入

```
-1 -2 1 3
```

### 输出

```
11
```

## 样例 #3

### 输入

```
-1000000000 -1000000000 1000000000 1000000000
```

### 输出

```
4000000000000000000
```



---

---
title: "[ABC361F] x = a^b"
layout: "post"
diff: 普及+/提高
pid: AT_abc361_f
tag: ['数学', '枚举']
---

# [ABC361F] x = a^b

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc361/tasks/abc361_f

$ 1 $ 以上 $ N $ 以下の正整数 $ x $ であって、ある正整数 $ a $ と **$ 2 $ 以上の** 正整数 $ b $ を用いて $ x=a^b $ と表現できるものはいくつありますか？

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $

## 输出格式

答えを整数として出力せよ。

## 说明/提示

### 制約

- 入力は全て整数
- $ 1\ \le\ N\ \le\ 10^{18} $
 
### Sample Explanation 1

問題文中の条件を満たす整数は $ 1,4,8,9,16,25,27,32,36,49,64,81 $ の $ 12 $ 個です。

## 样例 #1

### 输入

```
99
```

### 输出

```
12
```

## 样例 #2

### 输入

```
1000000000000000000
```

### 输出

```
1001003332
```



---

---
title: "[ABC374E] Sensor Optimization Dilemma 2"
layout: "post"
diff: 普及+/提高
pid: AT_abc374_e
tag: ['数学', '二分']
---

# [ABC374E] Sensor Optimization Dilemma 2

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc374/tasks/abc374_e

ある製品の製造には $ 1,2,\dots,N $ の番号が付いた $ N $ 個の工程が必要です。

各工程 $ i $ について、それを処理する $ 2 $ 種類の機械 $ S_i,T_i $ が売られています。

- 機械 $ S_i $ : $ 1 $ 台につき $ 1 $ 日あたり製品 $ A_i $ 個分の処理ができ、 $ 1 $ 台 $ P_i $ 円で導入できる
- 機械 $ T_i $ : $ 1 $ 台につき $ 1 $ 日あたり製品 $ B_i $ 個分の処理ができ、 $ 1 $ 台 $ Q_i $ 円で導入できる

それぞれの機械は $ 0 $ 台以上何台でも導入できます。

機械の導入の結果、工程 $ i $ を $ 1 $ 日あたり製品 $ W_i $ 個分処理できるようになったとします。  
このとき、製造能力を $ W $ の最小値、すなわち $ \displaystyle\ \min^{N}_{i=1}\ W_i $ と定義します。

全体の予算が $ X $ 円のとき、達成可能な製造能力の最大値を求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ X $ $ A_1 $ $ P_1 $ $ B_1 $ $ Q_1 $ $ A_2 $ $ P_2 $ $ B_2 $ $ Q_2 $ $ \vdots $ $ A_N $ $ P_N $ $ B_N $ $ Q_N $

## 输出格式

答えを整数として出力せよ。

## 说明/提示

### 制約

- 入力は全て整数
- $ 1\ \le\ N\ \le\ 100 $
- $ 1\ \le\ A_i,B_i\ \le\ 100 $
- $ 1\ \le\ P_i,Q_i,X\ \le\ 10^7 $

### Sample Explanation 1

例えば、次の通り機械を導入することで製造能力を $ 4 $ にすることができ、これが達成可能な最大値です。 - 工程 $ 1 $ に対し機械 $ S_1 $ を $ 2 $ 台導入する。 - $ 1 $ 日あたり製品 $ 4 $ 個分の処理に相当し、導入に合計 $ 10 $ 円かかる。 - 工程 $ 2 $ に対し機械 $ S_2 $ を $ 1 $ 台導入する。 - $ 1 $ 日あたり製品 $ 1 $ 個分の処理に相当し、導入に合計 $ 1 $ 円かかる。 - 工程 $ 2 $ に対し機械 $ T_2 $ を $ 1 $ 台導入する。 - $ 1 $ 日あたり製品 $ 3 $ 個分の処理に相当し、導入に合計 $ 3 $ 円かかる。 - 工程 $ 3 $ に対し機械 $ T_3 $ を $ 2 $ 台導入する。 - $ 1 $ 日あたり製品 $ 4 $ 個分の処理に相当し、導入に合計 $ 8 $ 円かかる。

### Sample Explanation 3

正の製造能力が得られない場合もあります。

## 样例 #1

### 输入

```
3 22
2 5 3 6
1 1 3 3
1 3 2 4
```

### 输出

```
4
```

## 样例 #2

### 输入

```
1 10000000
100 1 100 1
```

### 输出

```
1000000000
```

## 样例 #3

### 输入

```
1 1
1 10000000 1 10000000
```

### 输出

```
0
```

## 样例 #4

### 输入

```
10 7654321
8 6 9 1
5 6 4 3
2 4 7 9
7 8 9 1
7 9 1 6
4 8 9 1
2 2 8 9
1 6 2 6
4 2 3 4
6 6 5 2
```

### 输出

```
894742
```



---

---
title: "[ABC384F] Double Sum 2"
layout: "post"
diff: 普及+/提高
pid: AT_abc384_f
tag: ['数学', '字典树 Trie', '位运算']
---

# [ABC384F] Double Sum 2

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc384/tasks/abc384_f

正整数 $ x $ に対して $ f(x) $ を「 $ x $ が偶数である間 $ x $ を $ 2 $ で割り続けたときの、最終的な $ x $ の値」として定義します。例えば $ f(4)=f(2)=f(1)=1 $ 、 $ f(12)=f(6)=f(3)=3 $ です。

長さ $ N $ の整数列 $ A=(A_1,A_2,\ldots,\ A_N) $ が与えられるので、 $ \displaystyle\ \sum_{i=1}^N\ \sum_{j=i}^N\ f(A_i+A_j) $ を求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ A_1 $ $ A_2 $ $ \ldots $ $ A_N $

## 输出格式

答えを出力せよ。

## 说明/提示

### 制約

- $ 1\le\ N\le\ 2\times\ 10^5 $
- $ 1\le\ A_i\le\ 10^7 $
- 入力は全て整数
 
### Sample Explanation 1

$ f(A_1+A_1)=f(8)=1 $ 、 $ f(A_1+A_2)=f(12)=3 $ 、 $ f(A_2+A_2)=f(16)=1 $ です。したがって、 $ 1+3+1=5 $ を出力してください。

## 样例 #1

### 输入

```
2

4 8
```

### 输出

```
5
```

## 样例 #2

### 输入

```
3

51 44 63
```

### 输出

```
384
```

## 样例 #3

### 输入

```
8

577752 258461 183221 889769 278633 577212 392309 326001
```

### 输出

```
20241214
```



---

---
title: "[ABC385E] Snowflake Tree"
layout: "post"
diff: 普及+/提高
pid: AT_abc385_e
tag: ['数学', '树的遍历']
---

# [ABC385E] Snowflake Tree

## 题目描述

"雪花树"是通过以下步骤生成的树：

1. 选择正整数 $x,y$。
2. 准备一个顶点。
3. 再准备 $x$ 个顶点，并将它们每个都与步骤 2 中准备的顶点相连。
4. 对于步骤 3 中准备的每个 $x$ 个顶点，为其连接 $y$ 个叶子节点。

下图展示了一个 $x=4,y=2$ 的雪花树。在步骤 2、3、4 中准备的顶点分别用红色、蓝色和绿色表示。

![](https://img.atcoder.jp/abc385/b836ca95b1add288731cbe63816da3b1.png)

给定一个有 $N$ 个顶点的树 $T$。顶点编号从 1 到 $N$，第 $i$ 条边（$i=1,2,\dots,N-1$）连接顶点 $u_i$ 和 $v_i$。

考虑删除 $T$ 中零个或多个顶点及其相邻的边，使得剩余图形成为一个雪花树。求必须删除的最少顶点数。在本题的约束条件下，总是可以将 $T$ 转换为雪花树。

## 输入格式

输入从标准输入按以下格式给出：

> $N$  
$u_1$ $v_1$  
$u_2$ $v_2$  
$\vdots$  
$u_{N-1}$ $v_{N-1}$

## 输出格式

输出答案。

**【样例 1 解释】**

通过删除顶点 $8$，给定的树可以转换为一个 $x=2,y=2$ 的雪花树。

**【样例 2 解释】**

给定的树已经是一个 $x=1,y=1$ 的雪花树。

## 说明/提示

- $3 \leq N \leq 3 \times 10^5$
- $1 \leq u_i < v_i \leq N$
- 给定图是一棵树
- 所有输入值均为整数

## 样例 #1

### 输入

```
8

1 3

2 3

3 4

4 5

5 6

5 7

4 8
```

### 输出

```
1
```

## 样例 #2

### 输入

```
3

1 2

2 3
```

### 输出

```
0
```

## 样例 #3

### 输入

```
10

1 3

1 2

5 7

6 10

2 8

1 6

8 9

2 7

1 4
```

### 输出

```
3
```



---

---
title: "[ABC399F] Range Power Sum"
layout: "post"
diff: 普及+/提高
pid: AT_abc399_f
tag: ['动态规划 DP', '组合数学']
---

# [ABC399F] Range Power Sum

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc399/tasks/abc399_f

给定正整数 $N, K$ 以及长度为 $N$ 的整数序列 $A = (A_1, A_2, \dots, A_N)$。  
请计算以下表达式的值对 $998244353$ 取模后的余数：

$$
\displaystyle \sum_{1 \leq l \leq r \leq N} \left( \sum_{l \leq i \leq r} A_i \right)^K
$$

## 输入格式

输入通过标准输入给出，格式如下：

> $N$ $K$  
> $A_1$ $A_2$ $\dots$ $A_N$

## 输出格式

输出计算结果对 $998244353$ 取模后的余数。

## 说明/提示

### 约束条件

- $1 \leq N \leq 2 \times 10^5$
- $1 \leq K \leq 10$
- $0 \leq A_i < 998244353$
- 输入均为整数

### 样例解释 1

所求的值为 $A_1^2 + A_2^2 + A_3^2 + (A_1 + A_2)^2 + (A_2 + A_3)^2 + (A_1 + A_2 + A_3)^2 = 3^2 + 1^2 + 2^2 + 4^2 + 3^2 + 6^2 = 75$。

### 样例解释 3

注意需要对结果取 $998244353$ 的模。

翻译由 DeepSeek R1 完成

## 样例 #1

### 输入

```
3 2

3 1 2
```

### 输出

```
75
```

## 样例 #2

### 输入

```
1 10

0
```

### 输出

```
0
```

## 样例 #3

### 输入

```
10 5

91 59 85 60 57 72 12 3 27 16
```

### 输出

```
428633385
```



---

---
title: "[ABC405E] Fruit Lineup"
layout: "post"
diff: 普及+/提高
pid: AT_abc405_e
tag: ['组合数学']
---

# [ABC405E] Fruit Lineup

## 题目描述

你有 $A$ 个苹果，$B$ 个橙子，$C$ 串香蕉，$D$ 串葡萄。同种水果之间是完全相同的。

求把它们从左往右排成一排的方案数，方案需要满足：
- 所有的苹果都在所有的香蕉的左边；
- 所有的苹果都在所有的葡萄的左边；
- 所有的橙子都在所有的葡萄的左边。

答案对 $998244353$ 取模。

## 输入格式

一行四个整数 $A,B,C,D(1\le A,B,C,D\le 10^6)$。

## 输出格式

输出一行一个整数，为答案对 $998244353$ 取模后的结果。

## 说明/提示

**样例 1 解释**

以下为所有 $5$ 种合法的排列方案：
- 苹果，橙子，香蕉，葡萄
- 苹果，橙子，葡萄，香蕉
- 苹果，香蕉，橙子，葡萄
- 橙子，苹果，香蕉，葡萄
- 橙子，苹果，葡萄，香蕉

By @[chenxi2009](/user/1020063)

## 样例 #1

### 输入

```
1 1 1 1
```

### 输出

```
5
```

## 样例 #2

### 输入

```
1 2 4 8
```

### 输出

```
2211
```

## 样例 #3

### 输入

```
834150 21994 467364 994225
```

### 输出

```
947921688
```



---

---
title: "[ABC406E] Popcount Sum 3"
layout: "post"
diff: 普及+/提高
pid: AT_abc406_e
tag: ['数位 DP', '组合数学']
---

# [ABC406E] Popcount Sum 3

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc406/tasks/abc406_e

正の整数 $ N,K $ が与えられます。  
 $ N $ 以下の正の整数 $ x $ であって、次の条件をみたすものの **総和** を $ 998244353 $ で割った余りを求めてください。

- $ x $ の popcount の値はちょうど $ K $ である。
 
$ T $ 個のテストケースが与えられるので、それぞれについて答えを求めてください。

  popcount とは 正整数 $ y $ に対して、$ y $ の popcount の値 $ \mathrm{popcount}(y) $ は、$ y $ を二進数表記したとき $ 1 $ となっている桁の個数を表します。 例えば、$ \mathrm{popcount}(5)=2 $, $ \mathrm{popcount}(16)=1 $, $ \mathrm{popcount}(25)=3 $ です。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ T $ $ \mathrm{case}_1 $ $ \mathrm{case}_2 $ $ \vdots $ $ \mathrm{case}_T $

$ \mathrm{case}_i $ は $ i $ 番目のテストケースを表す。 各テストケースは以下の形式で与えられる。

> $ N $ $ K $

## 输出格式

$ T $ 行出力せよ。$ i $ 行目 $ (1\leq\ i\leq\ T) $ には $ i $ 番目のテストケースに対する答えを出力せよ。

## 说明/提示

### 制約

- $ 1\leq\ T\leq\ 100 $
- $ 1\leq\ N\ <\ 2^{60} $
- $ 1\leq\ K\ \leq\ 60 $
- $ T,N,K $ は整数
 
### Sample Explanation 1

$ 1 $ 番目のテストケースについて、$ 20 $ 以下の正の整数のうち、popcount の値が $ 2 $ であるものは $ 3,5,6,9,10,12,17,18,20 $ の $ 9 $ つであり、その総和は $ 100 $ となります。 $ 100 $ を $ 998244353 $ で割った余りは $ 100 $ であるため、$ 1 $ 行目には $ 100 $ を出力します。 $ 998244353 $ で割った余りを出力する必要があることに注意してください。

## 样例 #1

### 输入

```
2

20 2

1234567890 17
```

### 输出

```
100

382730918
```



---

---
title: "[AGC017B] Moderate Differences"
layout: "post"
diff: 普及+/提高
pid: AT_agc017_b
tag: ['数学']
---

# [AGC017B] Moderate Differences

## 题目描述

[problemUrl]: https://atcoder.jp/contests/agc017/tasks/agc017_b

$ N $ 個のマスが一列に並んでいます． 一番左のマスには整数 $ A $ が，一番右のマスには整数 $ B $ が書かれており，他のマスには何も書かれていません．

青橋君は，何も書かれていないマスに整数を書き込み，次の条件を満たすようにしたいです：

- どの隣接する $ 2 $ マスについても，書かれている整数の差は $ C $ 以上 $ D $ 以下である．

青橋君は，この条件を満たす限り，いくらでも大きい整数や小さい整数を書き込むことができます． 青橋君が条件を満たすように整数を書き込むことができるかを判定してください．

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ A $ $ B $ $ C $ $ D $

## 输出格式

青橋君が条件を満たすように整数を書き込むことができるなら `YES` を，できないなら `NO` を出力せよ．

## 说明/提示

### 制約

- $ 3\ \leq\ N\ \leq\ 500000 $
- $ 0\ \leq\ A\ \leq\ 10^9 $
- $ 0\ \leq\ B\ \leq\ 10^9 $
- $ 0\ \leq\ C\ \leq\ D\ \leq\ 10^9 $
- 入力はすべて整数

### Sample Explanation 1

例えば，左のマスから順に $ 1,\ -1,\ 3,\ 7,\ 5 $ となるように整数を書き込めばよいです．

## 样例 #1

### 输入

```
5 1 5 2 4
```

### 输出

```
YES
```

## 样例 #2

### 输入

```
4 7 6 4 5
```

### 输出

```
NO
```

## 样例 #3

### 输入

```
48792 105960835 681218449 90629745 90632170
```

### 输出

```
NO
```

## 样例 #4

### 输入

```
491995 412925347 825318103 59999126 59999339
```

### 输出

```
YES
```



---

---
title: "[AGC022B] GCD Sequence"
layout: "post"
diff: 普及+/提高
pid: AT_agc022_b
tag: ['数学', '最大公约数 gcd', '构造']
---

# [AGC022B] GCD Sequence

## 题目描述

[problemUrl]: https://atcoder.jp/contests/agc022/tasks/agc022_b

ナガセは高校の優等生です。ある日のこと、ナガセは正の整数からなる特別な集合のとある性質を分析しています。

ナガセの考えでは、**異なる** 正の整数の集合 $ S\ =\ \{a_{1},\ a_{2},\ ...,\ a_{N}\} $ は、以下の条件を満たす場合に **特別** であると呼ばれます。条件：どの $ 1\ \leq\ i\ \leq\ N $ についても、$ a_{i} $ と、$ S $ のその他の要素の和の最大公約数は $ 1 $ **ではない**。

ナガセは、要素数 $ N $ の **特別** な集合を求めたいです。ところがこれは簡単すぎるので、難易度を上げることにしました。要素数 $ N $ の **特別** な集合であって、すべての要素の最大公約数が $ 1 $ であり、どの要素も $ 30000 $ 以下であるものを求めてみよ、とのことです。

## 输入格式

入力は標準入力から以下の形式で与えられる。

> $ N $

## 输出格式

$ S $ の要素を表す $ N $ 個の整数を空白で区切って出力せよ。$ S $ は以下の条件を満たさなければならない。

- 要素は $ 30000 $ 以下の **異なる** 正の整数でなければならない。
- $ S $ のすべての要素の最大公約数は $ 1 $ である。すなわち、$ S $ のすべての要素を割り切るような整数 $ d\ >\ 1 $ は存在しない。
- $ S $ は **特別** な集合である。

複数の解が存在する場合は、そのうちどれを出力してもよい。また、$ S $ の要素はどのような順番で出力してもよい。なお、与えられた制約の下で解が少なくとも一つ存在することが保証される。

## 说明/提示

### 制約

- $ 3\ \leq\ N\ \leq\ 20000 $

### Sample Explanation 1

$ \{2,\ 5,\ 63\} $ は特別です。なぜなら、$ gcd(2,\ 5\ +\ 63)\ =\ 2,\ gcd(5,\ 2\ +\ 63)\ =\ 5,\ gcd(63,\ 2\ +\ 5)\ =\ 7 $ であり、さらに $ gcd(2,\ 5,\ 63)\ =\ 1 $ であるため、すべての判定条件を満たすからです。 なお、$ \{2,\ 4,\ 6\} $ は解として認められません。$ gcd(2,\ 4,\ 6)\ =\ 2\ >\ 1 $ であるからです。

### Sample Explanation 2

$ \{2,\ 5,\ 20,\ 63\} $ は特別です。なぜなら、$ gcd(2,\ 5\ +\ 20\ +\ 63)\ =\ 2,\ gcd(5,\ 2\ +\ 20\ +\ 63)\ =\ 5,\ gcd(20,\ 2\ +\ 5\ +\ 63)\ =\ 10,\ gcd(63,\ 2\ +\ 5\ +\ 20)\ =\ 9 $ であり、さらに $ gcd(2,\ 5,\ 20,\ 63)\ =\ 1 $ であるため、すべての判定条件を満たすからです。

## 样例 #1

### 输入

```
3
```

### 输出

```
2 5 63
```

## 样例 #2

### 输入

```
4
```

### 输出

```
2 5 20 63
```



---

---
title: "[AGC051A] Dodecagon"
layout: "post"
diff: 普及+/提高
pid: AT_agc051_a
tag: ['数学', '排列组合']
---

# [AGC051A] Dodecagon

## 题目描述

[problemUrl]: https://atcoder.jp/contests/agc051/tasks/agc051_a

すぬけ君は、正方形のタイルと正三角形のタイルを無限枚持っています。タイルの辺の長さは全て $ 1 $ です。 これらを使って、辺の長さが $ d $ の正 $ 12 $ 角形を作る方法は何通りあるでしょうか。 この答えを $ 998,244,353 $ で割った余りを計算してください。

厳密に述べると、

- タイルを使う枚数に制限はありません。
- 使ったタイルのうち、どの $ 2 $ 枚も重なっていてはいけません。
- 使ったタイルが覆う領域の和集合は、穴のない正 $ 12 $ 角形でなければなりません。
- 二つの作り方について、一方に回転と平行移動を施す (鏡映は不可) ことでもう一方を得られる、すなわち一方における各タイルがもう一方における同種のタイルと完全に一致するとき、これらの作り方を同一とみなします。

## 输入格式

入力は標準入力から以下の形式で与えられる。

> $ d $

## 输出格式

答えを出力せよ。

## 说明/提示

### 制約

- $ 1\ \leq\ d\ \leq\ 10^6 $
- 入力中の全ての値は整数である。

### Sample Explanation 1

唯一の作り方を以下の図に示します。 !\[\](https://img.atcoder.jp/agc051/dad0de5f2e5c47119aa1a0da8ed28808.png)

## 样例 #1

### 输入

```
1
```

### 输出

```
1
```



---

---
title: "[AGC051B] Bowling"
layout: "post"
diff: 普及+/提高
pid: AT_agc051_b
tag: ['数学']
---

# [AGC051B] Bowling

## 题目描述

[problemUrl]: https://atcoder.jp/contests/agc051/tasks/agc051_b

> 平面上にボウリングのピンが何本か立っており、それを $ 4 $ 人の人が異なる角度から眺めています。 $ 1 $ 人にだけ他の人より遥かに多くのピンが見えることはあるでしょうか。

ピンを単純に $ xy $ 平面上の点集合とみなしましょう。 $ 4 $ 人の位置を以下の図に示します。 厳密には、

- **A** さんから見ると、$ y $ 座標が等しい $ 2 $ 本のピンは重なって見えます。
- **B** さんから見ると、($ x $ 座標 - $ y $ 座標) が等しい $ 2 $ 本のピンは重なって見えます。
- **C** さんから見ると、$ x $ 座標が等しい $ 2 $ 本のピンは重なって見えます。
- **D** さんから見ると、($ x $ 座標 + $ y $ 座標) が等しい $ 2 $ 本のピンは重なって見えます。

![](https://cdn.luogu.com.cn/upload/vjudge_pic/AT_agc051_b/cf17bb504667e73875a26607be26bad6c893bba0.png)

**A**, **B**, **C**, **D** さんに見えるピンの数をそれぞれ $ a,\ b,\ c,\ d $ とします。

以下の条件を全て満たすような何らかのピンの配置を構成してください。

- $ d\ \geq\ 10\ \cdot\ \max\ \{\ a,\ b,\ c\ \} $
- ピンの本数は $ 1 $ 本以上 $ 10^5 $ 本以下である。
- ピンの座標は全て $ 0 $ 以上 $ 10^9 $ 以下の整数である。
- $ 2 $ 本のピンが同じ位置にあることはない。

## 输入格式

入力はない。

## 输出格式

答えを以下の形式で出力せよ。ここで、$ N $ はピンの本数、$ (x_i,\ y_i) $ は $ i $ 本目のピンの座標である。

> $ N $ $ x_1 $ $ y_1 $ $ : $ $ x_N $ $ y_N $

出力は、問題文中の条件を満たすものでなければならない。

## 说明/提示

### Sample Explanation 1

\*\*この出力例は出力形式を例示するものであり、正解ではありません。\*\* この出力は問題文中の図に対応し、$ d\ =\ 8,\ a\ =\ b\ =\ c\ =\ 7 $ です。頑張りましたが、AC には届きません。

## 样例 #1

### 输入

```

```

### 输出

```
9

1 1

1 5

2 7

4 4

5 3

6 8

7 5

8 2

8 7
```



---

---
title: "[ARC145C] Split and Maximize"
layout: "post"
diff: 普及+/提高
pid: AT_arc145_c
tag: ['组合数学', 'Catalan 数']
---

# [ARC145C] Split and Maximize

## 题目描述

[problemUrl]: https://atcoder.jp/contests/arc145/tasks/arc145_c

$ (1,2,\ldots,2N) $ の順列 $ P=(P_1,P_2,\ldots,P_{2N}) $ に対し、スコアを以下で定義します。

> $ P $ を順序を保ったまま二つの長さ $ N $ の（連続するとは限らない）部分列 $ A\ =\ (A_1,A_2,\ldots,A_N),B\ =\ (B_1,B_2,\ldots,B_N) $ に分割する。分割を行ったときに得られる $ \displaystyle\sum_{i=1}^{N}A_i\ B_i $ の最大値をスコアとする。

$ (1,2,\ldots,2N) $ の順列全てについてスコアを計算し、それらの最大値を $ M $ とします。 $ (1,2,\ldots,2N) $ の順列のうち、スコアが $ M $ であるものの個数を $ 998244353 $ で割ったあまりを求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $

## 输出格式

答えを出力せよ。

## 说明/提示

### 制約

- $ 1\ \leq\ N\ \leq\ 2\times\ 10^5 $
- 入力は全て整数

### Sample Explanation 1

考えられる順列 $ 24 $ 通りの中で、スコアの最大値 $ M $ は $ 14 $ です。スコアが $ 14 $ となる順列は $ 16 $ 通りあります。 例えば、順列 $ (1,2,3,4) $ は $ A=(1,3),\ B=(2,4) $ と分割することで、$ \sum\ _{i=1}^{N}A_i\ B_i\ =\ 14 $ となります。

### Sample Explanation 2

$ 998244353 $ で割ったあまりを答えてください。

## 样例 #1

### 输入

```
2
```

### 输出

```
16
```

## 样例 #2

### 输入

```
10000
```

### 输出

```
391163238
```



---

---
title: "[ARC154C] Roller"
layout: "post"
diff: 普及+/提高
pid: AT_arc154_c
tag: ['数学']
---

# [ARC154C] Roller

## 题目描述

[problemUrl]: https://atcoder.jp/contests/arc154/tasks/arc154_c

長さ $ N $ の正整数列 $ A=(A_1,A_2,\dots,A_N),B=(B_1,B_2,\dots,B_N) $ が与えられます。

あなたは以下の操作を好きな回数（$ 0 $ 回でもよい）繰り返すことができます。

- $ 1\ \le\ i\ \le\ N $ を満たす整数 $ i $ を選び、$ A_i $ を $ A_{i+1} $ で置き換える。
 
ただし、$ A_{N+1} $ とは $ A_1 $ のこととします。

$ A $ を $ B $ に一致させることが出来るか判定してください。

$ T $ 個のテストケースが与えられるので、それぞれについて答えを求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ T $ $ \mathrm{case}_1 $ $ \mathrm{case}_2 $ $ \vdots $ $ \mathrm{case}_T $

各テストケースは、以下の形式で与えられる。

> $ N $ $ A_1 $ $ A_2 $ $ \dots $ $ A_N $ $ B_1 $ $ B_2 $ $ \dots $ $ B_N $

## 输出格式

$ T $ 行出力せよ。 $ i $ 行目には、$ i $ 個目のテストケースにおいて $ A $ を $ B $ と一致させることが出来るならば `Yes`、出来ないならば `No` を出力せよ。

## 说明/提示

### 制約

- $ 1\ \le\ T\ \le\ 5000 $
- $ 1\ \le\ N\ \le\ 5000 $
- $ 1\ \le\ A_i,B_i\ \le\ N $
- $ 1 $ 個の入力に含まれるテストケースについて、それらの $ N $ の総和は $ 5000 $ を超えない。
 
### Sample Explanation 1

$ 1 $ 個目のテストケースでは、以下のように操作することにより $ A $ を $ B $ と一致させることが出来ます。 - $ i=1 $ を選ぶ。$ A_1 $ を $ A_2 $ で置き換える。$ A=(2,2) $ となる。 $ 2 $ 個目のテストケースでは、以下のように操作することにより $ A $ を $ B $ と一致させることが出来ます。 - $ i=4 $ を選ぶ。$ A_4 $ を $ A_1 $ で置き換える。$ A=(2,3,1,2) $ となる。 - $ i=2 $ を選ぶ。$ A_2 $ を $ A_3 $ で置き換える。$ A=(2,1,1,2) $ となる。 $ 3 $ 個目のテストケースでは、どのように操作しても $ A $ を $ B $ と一致させることは出来ません。

## 样例 #1

### 输入

```
3

2

1 2

2 2

4

2 3 1 1

2 1 1 2

2

1 1

2 2
```

### 输出

```
Yes

Yes

No
```



---

---
title: "[ARC155B] Abs Abs Function"
layout: "post"
diff: 普及+/提高
pid: AT_arc155_b
tag: ['数学']
---

# [ARC155B] Abs Abs Function

## 题目描述

[problemUrl]: https://atcoder.jp/contests/arc155/tasks/arc155_b

$ 2 $ つの非負整数からなる組の集合 $ S $ 、および非負整数 $ x $ に対し $ f_S(x) $ を $ \displaystyle\ f_S(x)=\min_{(a,\ b)\ \in\ S}\ \left|\ \left|\ x-a\ \right|\ -\ b\ \right| $ と定義します。

$ 2 $ つの非負整数からなる組の集合 $ T $ があります。はじめ $ T=\lbrace\ (A,\ B)\rbrace $ です。

$ Q $ 個のクエリを処理してください。$ i $ 番目のクエリでは $ 3 $ つの非負整数 $ t_i,\ a_i,\ b_i $ が与えられるので、以下のように処理してください。

- $ t_i=1 $ のとき 、 $ T $ に $ 2 $ つの非負整数からなる組 $ (a_i,\ b_i) $ を追加する。
- $ t_i=2 $ のとき 、 $ a_i\ \leq\ x\ \leq\ b_i $ を満たす非負整数 $ x $ に対する $ f_{T}(x) $ の最小値を出力する。

## 输入格式

入力は以下の形式で標準入力から与えられます。

> $ Q $ $ A $ $ B $ $ t_1 $ $ a_1 $ $ b_1 $ $ t_2 $ $ a_2 $ $ b_2 $ $ \vdots $ $ t_Q $ $ a_Q $ $ b_Q $

## 输出格式

$ t_i=2 $ であるような各クエリについて、答えを $ 1 $ 行に $ 1 $ つずつ、順に出力せよ。

## 说明/提示

### 制約

- $ 1\ \leq\ Q\ \leq\ 2\ \times\ 10^5 $
- $ 0\ \leq\ A,B\ \leq\ 10^{9} $
- $ t_i $ は $ 1 $ または $ 2 $
- $ 0\ \leq\ a_i,b_i\ \leq\ 10^{9} $
- $ t_i=2 $ のとき、$ a_i\ \leq\ b_i $
- $ t_i=2 $ を満たすクエリは $ 1 $ つ以上存在する
- 入力される値はすべて整数
 
### Sample Explanation 1

$ 2 $ 番目のクエリを実行するとき、$ T=\lbrace(0,\ 5),\ (3,\ 11)\ \rbrace $ であり、たとえば $ x=7 $ とすると $ f_T(7)=\min\ \lbrace\ \left|\ \left|7-0\right|-5\right|,\ \left|\ \left|7-3\right|-11\right|\ \rbrace=\min\ \lbrace\ 2,\ 7\ \rbrace=2 $ となります。 同様に、$ f_T(8)=3 $ となります。よって $ 2 $ 番目のクエリの答えは $ \min\ \lbrace\ 2,\ 3\ \rbrace\ =2 $ です。 $ 4 $ 番目のクエリを実行するとき、 $ T=\lbrace(0,\ 5),\ (3,\ 11),\ (8,\ 2)\ \rbrace $ です。$ 8\ \leq\ x\ \leq\ 9 $ において $ f_T(x) $ は $ x=9 $ で最小値 $ f_T(9)=1 $ をとります。

## 样例 #1

### 输入

```
4 0 5

1 3 11

2 7 8

1 8 2

2 8 9
```

### 输出

```
2

1
```

## 样例 #2

### 输入

```
2 1 2

1 2 3

2 2 6
```

### 输出

```
0
```

## 样例 #3

### 输入

```
20 795629912 123625148

2 860243184 892786970

2 645778367 668513124

1 531411849 174630323

1 635062977 195695960

2 382061637 411843651

1 585964296 589553566

1 310118888 68936560

1 525351160 858166280

2 395304415 429823333

2 583145399 703645715

2 97768492 218377432

1 707220749 459967102

1 210842017 363390878

2 489541834 553583525

2 731279777 811513313

1 549864943 493384741

1 815378318 826084592

2 369622093 374205455

1 78240781 821999998

2 241667193 243982581
```

### 输出

```
26468090

3491640

25280111

9543684

0

22804896

20649370

19245624

4849993

484865
```



---

---
title: "[ARC156B] Mex on Blackboard"
layout: "post"
diff: 普及+/提高
pid: AT_arc156_b
tag: ['组合数学', '排列组合']
---

# [ARC156B] Mex on Blackboard

## 题目描述

[problemUrl]: https://atcoder.jp/contests/arc156/tasks/arc156_b

有限個の非負整数からなる多重集合 $ S $ にたいして、$ \mathrm{mex}(S) $ を、$ S $ に含まれない最小の非負整数と定義します。例えば、$ \mathrm{mex}(\lbrace\ 0,0,\ 1,3\rbrace\ )\ =\ 2,\ \mathrm{mex}(\lbrace\ 1\ \rbrace)\ =\ 0,\ \mathrm{mex}(\lbrace\ \rbrace)\ =\ 0 $ です。

黒板に $ N $ 個の非負整数が書かれており、$ i $ 番目の非負整数は $ A_i $ です。

あなたは、以下の操作をちょうど $ K $ 回行います。

- 黒板に書かれている非負整数を $ 0 $ 個以上選ぶ。選んだ非負整数からなる多重集合を $ S $ として、$ \mathrm{mex}(S) $ を黒板に $ 1 $ 個書き込む。
 
最終的に黒板に書かれている非負整数の多重集合としてありうるものの個数を $ 998244353 $ で割ったあまりを求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ K $ $ A_1 $ $ A_2 $ $ \ldots $ $ A_N $

## 输出格式

答えを出力せよ。

## 说明/提示

### 制約

- $ 1\ \leq\ N,K\ \leq\ 2\times\ 10^5 $
- $ 0\leq\ A_i\leq\ 2\times\ 10^5 $
- 入力される数値は全て整数
 
### Sample Explanation 1

操作後に得られる多重集合は、以下の $ 3 $ 通りです。 - $ \lbrace\ 0,0,1,3\ \rbrace $ - $ \lbrace\ 0,1,1,3\rbrace $ - $ \lbrace\ 0,1,2,3\ \rbrace $ 例えば、$ \lbrace\ 0,1,1,3\rbrace $ は黒板に書かれている $ 0 $ を選び、$ S=\lbrace\ 0\rbrace $ として操作をすることで得られます。

### Sample Explanation 2

操作後に得られる多重集合は、以下の $ 2 $ 通りです。 - $ \lbrace\ 0,0,0\ \rbrace $ - $ \lbrace\ 0,0,1\rbrace $ 操作で選ぶ整数は $ 0 $ 個でも良いことに注意してください。

## 样例 #1

### 输入

```
3 1

0 1 3
```

### 输出

```
3
```

## 样例 #2

### 输入

```
2 1

0 0
```

### 输出

```
2
```

## 样例 #3

### 输入

```
5 10

3 1 4 1 5
```

### 输出

```
7109
```



---

---
title: "[ARC157C] YY Square"
layout: "post"
diff: 普及+/提高
pid: AT_arc157_c
tag: ['动态规划 DP', '数学']
---

# [ARC157C] YY Square

## 题目描述

[problemUrl]: https://atcoder.jp/contests/arc157/tasks/arc157_c

$ H $ 行 $ W $ 列のマス目の各マスに `X`, `Y` のいずれかの文字が書かれています． 上から $ i $ 行目，左から $ j $ 列目のマスを $ (i,\ j) $ で表します． マス目に書かれている文字は $ H $ 個の文字列 $ S_1,\ S_2,\ \dots,\ S_H $ によって与えられ，$ S_i $ の $ j $ 文字目がマス $ (i,\ j) $ に書かれた文字を表します．

下または右に隣接するマスへの移動を繰り返してマス $ (1,\ 1) $ からマス $ (H,\ W) $ に至る経路 $ P $ に対して，

- 「 $ P $ で通るマスに書かれた文字を順に並べて得られる長さ $ (H\ +\ W\ -\ 1) $ の文字列」を $ \mathrm{str}(P) $ とし，
- 「 $ \mathrm{str}(P) $ 中で `Y` 同士が隣り合う箇所の**個数の $ 2 $ 乗**」を $ P $ の**スコア**と定義します．
 
そのような経路 $ P $ としてあり得るものは $ \displaystyle\binom{H\ +\ W\ -\ 2}{H\ -\ 1} $ 通りありますが，その全てに対するスコアの総和を $ 998244353 $ で割った余りを求めてください．

  $ \binom{N}{K} $ の意味 $ \displaystyle\binom{N}{K} $ は，$ N $ 個の相異なる要素から $ K $ 個を選ぶ場合の数を表す二項係数です．

## 输入格式

入力は以下の形式で標準入力から与えられる．

> $ H $ $ W $ $ S_1 $ $ S_2 $ $ \vdots $ $ S_H $

## 输出格式

あり得る経路全てに対するスコアの総和を $ 998244353 $ で割った余りを出力せよ．

## 说明/提示

### 制約

- $ 1\ \leq\ H\ \leq\ 2000 $
- $ 1\ \leq\ W\ \leq\ 2000 $
- $ S_i\ (1\ \leq\ i\ \leq\ H) $ は `X`, `Y` からなる長さ $ W $ の文字列である．
 
### Sample Explanation 1

経路 $ P $ としてあり得るものは $ (1,\ 1)\ \to\ (1,\ 2)\ \to\ (2,\ 2) $ と $ (1,\ 1)\ \to\ (2,\ 1)\ \to\ (2,\ 2) $ の $ 2 $ 通りです． - $ (1,\ 1)\ \to\ (1,\ 2)\ \to\ (2,\ 2) $ の場合，$ \mathrm{str}(P)\ =\ {} $`YYY` であり，$ 1,\ 2 $ 文字目と $ 2,\ 3 $ 文字目の $ 2 $ 箇所で `Y` 同士が隣り合っているので，スコアは $ 2^2\ =\ 4 $ です． - $ (1,\ 1)\ \to\ (2,\ 1)\ \to\ (2,\ 2) $ の場合，$ \mathrm{str}(P)\ =\ {} $`YXY` であり，`Y` 同士が隣り合う箇所は無いので，スコアは $ 0^2\ =\ 0 $ です． したがって，求める総和は $ 4\ +\ 0\ =\ 4 $ となります．

### Sample Explanation 2

$ 2 $ 通りのいずれの経路の場合も $ \mathrm{str}(P)\ =\ {} $`XYY` であり，スコアは $ 1^2\ =\ 1 $ です．

### Sample Explanation 3

スコアの総和を $ 998244353 $ で割った余りを出力してください．

## 样例 #1

### 输入

```
2 2

YY

XY
```

### 输出

```
4
```

## 样例 #2

### 输入

```
2 2

XY

YY
```

### 输出

```
2
```

## 样例 #3

### 输入

```
10 20

YYYYYYYYYYYYYYYYYYYY

YYYYYYYYYYYYYYYYYYYY

YYYYYYYYYYYYYYYYYYYY

YYYYYYYYYYYYYYYYYYYY

YYYYYYYYYYYYYYYYYYYY

YYYYYYYYYYYYYYYYYYYY

YYYYYYYYYYYYYYYYYYYY

YYYYYYYYYYYYYYYYYYYY

YYYYYYYYYYYYYYYYYYYY

YYYYYYYYYYYYYYYYYYYY
```

### 输出

```
423787835
```



---

---
title: "[ARC158B] Sum-Product Ratio"
layout: "post"
diff: 普及+/提高
pid: AT_arc158_b
tag: ['数学']
---

# [ARC158B] Sum-Product Ratio

## 题目描述

[problemUrl]: https://atcoder.jp/contests/arc158/tasks/arc158_b

$ 0 $ でない整数 $ x_1,\ \ldots,\ x_N $ が与えられます．$ i,j,k $ を $ 1\leq\ i\ <\ j\ <\ k\leq\ N $ を満たす整数とするとき，$ \dfrac{x_i+x_j+x_k}{x_ix_jx_k} $ としてありうる最小値と最大値を求めてください．

## 输入格式

入力は以下の形式で標準入力から与えられます．

> $ N $ $ x_1 $ $ \ldots $ $ x_N $

## 输出格式

$ \dfrac{x_i+x_j+x_k}{x_ix_jx_k} $ としてありうる最小値と最大値を，それぞれ 1 行目，2 行目に出力してください．

絶対誤差または相対誤差が $ 10^{-12} $ 以内であれば，正解と判定されます．

## 说明/提示

### 制約

- $ 3\leq\ N\leq\ 2\times\ 10^5 $
- $ -10^6\leq\ x_i\ \leq\ 10^6 $
- $ x_i\neq\ 0 $
 
### Sample Explanation 1

$ \dfrac{x_i+x_j+x_k}{x_ix_jx_k} $ としてありうる値は次の $ 4 $ 通りです． - $ (i,j,k)\ =\ (1,2,3) $：$ \dfrac{(-2)\ +\ (-4)\ +\ 4}{(-2)\cdot\ (-4)\cdot\ 4}\ =\ -\dfrac{1}{16} $． - $ (i,j,k)\ =\ (1,2,4) $：$ \dfrac{(-2)\ +\ (-4)\ +\ 5}{(-2)\cdot\ (-4)\cdot\ 5}\ =\ -\dfrac{1}{40} $． - $ (i,j,k)\ =\ (1,3,4) $：$ \dfrac{(-2)\ +\ 4\ +\ 5}{(-2)\cdot\ 4\cdot\ 5}\ =\ -\dfrac{7}{40} $． - $ (i,j,k)\ =\ (2,3,4) $：$ \dfrac{(-4)\ +\ 4\ +\ 5}{(-4)\cdot\ 4\cdot\ 5}\ =\ -\dfrac{1}{16} $． これらの最小値は $ -\dfrac{7}{40} $，最大値は $ -\dfrac{1}{40} $ です．

## 样例 #1

### 输入

```
4

-2 -4 4 5
```

### 输出

```
-0.175000000000000

-0.025000000000000
```

## 样例 #2

### 输入

```
4

1 1 1 1
```

### 输出

```
3.000000000000000

3.000000000000000
```

## 样例 #3

### 输入

```
5

1 2 3 4 5
```

### 输出

```
0.200000000000000

1.000000000000000
```



---

---
title: "[ARC158C] All Pair Digit Sums"
layout: "post"
diff: 普及+/提高
pid: AT_arc158_c
tag: ['数学', '二分']
---

# [ARC158C] All Pair Digit Sums

## 题目描述

[problemUrl]: https://atcoder.jp/contests/arc158/tasks/arc158_c

正整数 $ x $ に対し，その各桁の和を $ f(x) $ と表すことにします．例えば $ f(158)\ =\ 1\ +\ 5\ +\ 8\ =\ 14 $，$ f(2023)\ =\ 2\ +\ 0\ +\ 2\ +\ 3\ =\ 7 $，$ f(1)\ =\ 1 $ です．

正整数列 $ A\ =\ (A_1,\ \ldots,\ A_N) $ が与えられます．$ \sum_{i=1}^N\sum_{j=1}^N\ f(A_i\ +\ A_j) $ を求めてください．

## 输入格式

入力は以下の形式で標準入力から与えられます．

> $ N $ $ A_1 $ $ \ldots $ $ A_N $

## 输出格式

$ \sum_{i=1}^N\sum_{j=1}^N\ f(A_i\ +\ A_j) $ を出力してください．

## 说明/提示

### 制約

- $ 1\leq\ N\leq\ 2\times\ 10^5 $
- $ 1\leq\ A_i\ <\ 10^{15} $
 
### Sample Explanation 1

$ \sum_{i=1}^N\sum_{j=1}^N\ f(A_i\ +\ A_j)\ =\ f(A_1+A_1)+f(A_1+A_2)+f(A_2+A_1)+f(A_2+A_2)=7+9+9+11=36 $ です．

### Sample Explanation 2

$ \sum_{i=1}^N\sum_{j=1}^N\ f(A_i\ +\ A_j)\ =\ f(A_1+A_1)\ =\ 135 $ です．

## 样例 #1

### 输入

```
2

53 28
```

### 输出

```
36
```

## 样例 #2

### 输入

```
1

999999999999999
```

### 输出

```
135
```

## 样例 #3

### 输入

```
5

123 456 789 101 112
```

### 输出

```
321
```



---

---
title: "[ARC163C] Harmonic Mean"
layout: "post"
diff: 普及+/提高
pid: AT_arc163_c
tag: ['数学', '构造']
---

# [ARC163C] Harmonic Mean

## 题目描述

[problemUrl]: https://atcoder.jp/contests/arc163/tasks/arc163_c

以下の条件を全て満たす長さ $ N $ の正整数列 $ A=(A_1,A_2,\dots,A_N) $ が存在するか判定し、存在するならば一つ構築してください。

- $ \sum_{i=1}^{N}\ \frac{1}{A_i}\ =\ 1 $
- $ A $ の要素は全て相異なる。
- $ 1\ \le\ A_i\ \le\ 10^9(1\ \le\ i\ \le\ N) $
 
$ T $ 個のテストケースが与えられるので、それぞれについて答えを求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ T $ $ \mathrm{case}_1 $ $ \mathrm{case}_2 $ $ \vdots $ $ \mathrm{case}_T $

ここで、$ \mathrm{case}_i $ とは $ i $ 個目のテストケースである。各テストケースは以下の形式で与えられる。

> $ N $

## 输出格式

それぞれのケースについて、条件を満たす正整数列 $ A=(A_1,A_2,\dots,A_N) $ が存在しないならば `No` を出力せよ。存在するならば、以下の形式で出力せよ。

> Yes $ A_1 $ $ A_2 $ $ \dots $ $ A_N $

条件を満たす解が複数存在する場合、どれを出力しても正解とみなされる。

## 说明/提示

### 制約

- $ 1\ \le\ T\ \le\ 500 $
- $ 1\ \le\ N\ \le\ 500 $
 
### Sample Explanation 1

$ 1 $ 個目のテストケースでは、$ N=3 $ です。 $ A=(2,3,6) $ は、$ \frac{1}{2}\ +\ \frac{1}{3}\ +\ \frac{1}{6}\ =\ 1 $ かつ他の条件も全て満たすため正当です。 $ 2 $ 個目のテストケースでは、$ N=5 $ です。 $ A=(3,4,5,6,20) $ は、$ \frac{1}{3}\ +\ \frac{1}{4}\ +\ \frac{1}{5}\ +\ \frac{1}{6}\ +\ \frac{1}{20}\ =\ 1 $ かつ他の条件も全て満たすため正当です。 例えば、$ A=(5,5,5,5,5) $ は、$ 1,3 $ 個目の条件を満たしていますが同じ要素が存在するため不適であることに注意してください。

## 样例 #1

### 输入

```
2

3

5
```

### 输出

```
Yes

2 3 6 

Yes

3 4 5 6 20
```



---

---
title: "[ARC171B] Chmax"
layout: "post"
diff: 普及+/提高
pid: AT_arc171_b
tag: ['组合数学', '排列组合']
---

# [ARC171B] Chmax

## 题目描述

对于一个 $1$ 到 $N$ 的排列 $P=(P_1,P_2,\cdots,P_N)$，如下定义 $F(P)$：

- 初始序列 $B=(1,2,\cdots,N)$。只要有一个整数 $i$ 令 $B_i<P_{B_i}$ 存在，就进行下面的操作：
    - 找到最小的满足 $B_j<P_{B_j}$ 的整数 $j$，则将 $B_j$ 替换为 $P_{B_j}$。
  
  将 $F(P)$ 定义为这一过程结束时的 $B$（可以证明这个过程会在有限步数后终止）。

给你一个长度为 $N$ 的序列 $A=(A_1,A_2,\cdots,A_N)$，请问有多少个 $1$ 到 $N$ 的排列 $P$ 满足 $F(P) = A$？答案对 $998244353$ 取模。

## 输入格式

第一行一个整数 $N$，接下来 $N$ 个整数 $A_1,A_2,\cdots,A_N$。

## 输出格式

输出答案，对 $998244353$ 取模。

### 样例 1 解释

> 以下用 $\xrightarrow{j}(B_1',B_2',\cdots,B_N')$ 表示选择 $j$ 将 $B_j$ 替换为 $P_{B_j}$ 得到 $(B_1',B_2',\cdots,B_N')$。

选择 $P=(2,3,1,4)$，然后
$$\begin{aligned}(1,2,3,4)&\xrightarrow{1}(2,2,3,4)\\&\xrightarrow{1}(3,2,3,4)\\&\xrightarrow{2}(3,3,3,4)\\\end{aligned}$$
于是 $F((2,3,1,4))=(3,3,3,4)$。

只有这一个 $P$ 满足 $F(P)=(3,3,3,4)$。

## 说明/提示

- $1 \leq N \leq 2 \times 10^5$
- $1 \leq A_i \leq N$
- 所有的输入都是整数。

## 样例 #1

### 输入

```
4

3 3 3 4
```

### 输出

```
1
```

## 样例 #2

### 输入

```
4

2 2 4 3
```

### 输出

```
0
```

## 样例 #3

### 输入

```
8

6 6 8 4 5 6 8 8
```

### 输出

```
18
```



---

---
title: "[ARC172B] AtCoder Language"
layout: "post"
diff: 普及+/提高
pid: AT_arc172_b
tag: ['组合数学', '排列组合']
---

# [ARC172B] AtCoder Language

## 题目描述

[problemUrl]: https://atcoder.jp/contests/arc172/tasks/arc172_b

AtCoder 語には $ L $ 種類の文字があります。 AtCoder 語の文字からなる $ N $ 文字の文字列 $ s $ のうち、以下の条件を満たすものは何通りありますか。 答えを $ 998244353 $ で割った余りを求めてください。

- 文字列 $ s $ のどの「$ K $ 文字の部分列」も異なる。厳密には、文字列 $ s $ から $ K $ 文字を抜き出し、そのままの順序で連結して $ K $ 文字の文字列を得る方法は $ _N\mathrm{C}_K $ 通りあるが、それらすべてが異なる文字列を生成する。
 
 $ _N\mathrm{C}_K $ とは$ N $ 個のものの中から $ K $ 個を選ぶ方法の総数を指します。より厳密には、$ _N\mathrm{C}_K $ は $ N! $ を $ K!\ \times\ (N-K)! $ で割った値です。

## 输入格式

入力は以下の形式で標準入力から与えられます。

> $ N $ $ K $ $ L $

## 输出格式

答えを出力してください。

## 说明/提示

### 制約

- $ 1\ \leq\ K\ <\ N\ \leq\ 500000 $
- $ 1\ \leq\ L\ \leq\ 10^9 $
- 入力はすべて整数
 
### Sample Explanation 1

AtCoder 語の $ 1 $ 種類目の文字を `a`、$ 2 $ 種類目の文字を `b` と表すとき、条件を満たす文字列は `abab`、`baba` の $ 2 $ 通りとなります。

### Sample Explanation 2

条件を満たす文字列はおよそ $ 10^{86} $ 通りありますが、ここでは $ 998244353 $ で割った余りである $ 496798269 $ を出力します。

## 样例 #1

### 输入

```
4 3 2
```

### 输出

```
2
```

## 样例 #2

### 输入

```
100 80 26
```

### 输出

```
496798269
```

## 样例 #3

### 输入

```
100 1 26
```

### 输出

```
0
```

## 样例 #4

### 输入

```
500000 172172 503746693
```

### 输出

```
869120
```



---

---
title: "[ARC172C] Election"
layout: "post"
diff: 普及+/提高
pid: AT_arc172_c
tag: ['数学']
---

# [ARC172C] Election

## 题目描述

[problemUrl]: https://atcoder.jp/contests/arc172/tasks/arc172_c

今年の AtCoder 市長選挙には A 候補と B 候補の $ 2 $ 人が立候補し、$ N $ 人の有権者が投票しました。 投票者にはそれぞれ $ 1 $ から $ N $ までの番号が付けられており、投票者 $ i $ $ (1\ \leq\ i\ \leq\ N) $ は $ c_i $ 候補に投票しました。

さて、これから開票作業が行われます。 開票作業では $ 1 $ 票ずつ票が開けられていき、票が開けられるたびに、現時点での開票結果が以下の $ 3 $ つのうちどれであるかが発表されます。

- **結果 A:** 現時点で、A 候補の方が獲得票数が多い。
- **結果 B:** 現時点で、B 候補の方が獲得票数が多い。
- **結果 C:** 現時点で、A 候補と B 候補の獲得票数が同数である。
 
ここで開票の順番にはルールがあり、投票者 $ 1 $ 以外の票は、投票者の番号の小さい順に開票されなければなりません。 (投票者 $ 1 $ の票は好きなタイミングで開票してかまいません)

発表される開票結果の列としてあり得るものが何通りあるかを答えてください。

 開票結果の列とは$ i $ 票目 $ (1\ \leq\ i\ \leq\ N) $ が開けられたタイミングで報告された結果を $ s_i $ (`A`, `B`, `C` のいずれか) とするとき，文字列 $ s_1\ s_2\ \dots\ s_N $ のことを指します。

## 输入格式

入力は以下の形式で標準入力から与えられます。

> $ N $ $ c_1\ c_2\ \cdots\ c_N $

## 输出格式

答えを出力してください。

## 说明/提示

### 制約

- $ N $ は $ 2\ \leq\ N\ \leq\ 1000000 $ を満たす整数
- $ c_1,\ c_2,\ \dots,\ c_N $ は `A` または `B`
 
### Sample Explanation 1

この入力例では、開票が行われる順番として以下の $ 4 $ 通りが考えられます。 - 投票者 $ 1\ \to\ 2\ \to\ 3\ \to\ 4 $ の順に開票が行われる。 - 投票者 $ 2\ \to\ 1\ \to\ 3\ \to\ 4 $ の順に開票が行われる。 - 投票者 $ 2\ \to\ 3\ \to\ 1\ \to\ 4 $ の順に開票が行われる。 - 投票者 $ 2\ \to\ 3\ \to\ 4\ \to\ 1 $ の順に開票が行われる。 開票結果の列は上から順に `AAAC`、`AAAC`、`ACAC`、`ACBC` となるため、開票結果の列としてあり得るものは $ 3 $ 通りです。

### Sample Explanation 2

どのような順序で開票を行っても、開票結果の列は `AAAA` となります。

## 样例 #1

### 输入

```
4

AABB
```

### 输出

```
3
```

## 样例 #2

### 输入

```
4

AAAA
```

### 输出

```
1
```

## 样例 #3

### 输入

```
10

BBBAAABBAA
```

### 输出

```
5
```

## 样例 #4

### 输入

```
172

AABAAAAAABBABAABBBBAABBAAABBABBABABABBAAABAAABAABAABBBBABBBABBABBBBBBBBAAABAAABAAABABBBAABAAAABABBABBABBBBBABAABAABBBABABBAAAABAABABBBABAAAABBBBABBBABBBABAABBBAAAABAAABAAAB
```

### 输出

```
24
```



---

---
title: "[ARC173A] Neq Number"
layout: "post"
diff: 普及+/提高
pid: AT_arc173_a
tag: ['数学', '数位 DP', '进制']
---

# [ARC173A] Neq Number

## 题目描述

[problemUrl]: https://atcoder.jp/contests/arc173/tasks/arc173_a

正整数 $ X $ が以下の条件を満たすとき、$ X $ は **“Neq Number”** であるといいます。

- $ X $ を十進法表記した際、どの隣接する $ 2 $ 文字も相異なる
 
例えば $ 1,173,9090 $ は “Neq Number” です。一方、 $ 22,6335 $ は “Neq Number” ではありません。

正整数 $ K $ が与えられます。小さいほうから $ K $ 番目の “Neq Number” を求めてください。

$ T $ 個のテストケースが与えられるので、それぞれについて答えを求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ T $ $ \mathrm{case}_1 $ $ \vdots $ $ \mathrm{case}_T $

各ケースは以下の形式で与えられる。

> $ K $

## 输出格式

$ T $ 行出力せよ。$ i $ 行目には $ i $ 番目のテストケースに対する答えを出力せよ。

## 说明/提示

### 制約

- $ 1\ \leq\ T\ \leq\ 100 $
- $ 1\ \leq\ K\ \leq\ 10^{12} $
- 入力される値はすべて整数
 
### Sample Explanation 1

$ 1 $ つめのテストケースについて、 “Neq Number” を小さいものから $ 25 $ 個あげていくと - $ 1 $ から $ 9 $ までの整数の $ 9 $ 個 - $ 10 $ から $ 19 $ までの整数のうち、 $ 11 $ を除いた $ 9 $ 個 - $ 20 $ から $ 27 $ までの整数のうち、 $ 22 $ を除いた $ 7 $ 個 となります。よって、小さいほうから $ 25 $ 番目の “Neq Number” は $ 27 $ となります。

## 样例 #1

### 输入

```
3

25

148

998244353
```

### 输出

```
27

173

2506230721
```



---

---
title: "[ARC173B] Make Many Triangles"
layout: "post"
diff: 普及+/提高
pid: AT_arc173_b
tag: ['数学']
---

# [ARC173B] Make Many Triangles

## 题目描述

[problemUrl]: https://atcoder.jp/contests/arc173/tasks/arc173_b

二次元平面上に相異なる $ N $ 個の点があります。 $ i $ 番目の点の座標は $ (x_i,y_i) $ です。

これらの点のいずれかを頂点とする（非退化な）三角形をたくさん作りたいです。ただし、同じ点を複数の三角形の頂点として用いることはできません。

最大で何個の三角形が作れるか求めてください。

   非退化な三角形とは 非退化な三角形とは、 $ 3 $ つの頂点が同一直線上に並ばない三角形のことを指します。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ x_1 $ $ y_1 $ $ x_2 $ $ y_2 $ $ \vdots $ $ x_{N} $ $ y_{N} $

## 输出格式

答えを出力せよ。

## 说明/提示

### 制約

- $ 3\ \leq\ N\ \leq\ 300 $
- $ -10^9\ \leq\ x_i,y_i\ \leq\ 10^9 $
- $ i\ \neq\ j $ ならば $ (x_i,y_i)\ \neq\ (x_j,y_j) $
- 入力される値はすべて整数
 
### Sample Explanation 1

例えば $ 1,3,6 $ 番目の点からなる三角形と $ 2,4,5 $ 番目の点からなる三角形を考えると、三角形を $ 2 $ つ作ることができます。 同じ点を複数の三角形の頂点として用いることはできませんが、三角形が共通部分を持っても構いません。

## 样例 #1

### 输入

```
7

0 0

1 1

0 3

5 2

3 4

2 0

2 2
```

### 输出

```
2
```

## 样例 #2

### 输入

```
3

0 0

0 1000000000

0 -1000000000
```

### 输出

```
0
```



---

---
title: "[ARC174D] Digit vs Square Root"
layout: "post"
diff: 普及+/提高
pid: AT_arc174_d
tag: ['数学']
---

# [ARC174D] Digit vs Square Root

## 题目描述

[problemUrl]: https://atcoder.jp/contests/arc174/tasks/arc174_d

$ T $ 個のテストケースについて、以下の問題に答えてください。

整数 $ N $ が与えられるので、以下の条件を全て満たす整数 $ x $ の個数を求めてください。

- $ 1\ \le\ x\ \le\ N $
- $ y\ =\ \lfloor\ \sqrt{x}\ \rfloor $ とする。このとき、 $ x,y $ 双方を (先頭に $ 0 $ を含まずに) 十進法で書き下した場合、 $ y $ が $ x $ の接頭辞になる。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ T $ $ N_1 $ $ N_2 $ $ \vdots $ $ N_T $

但し、 $ N_i $ は $ i $ 個目のテストケースにおける整数 $ N $ を表す。

## 输出格式

全体で $ T $ 行出力せよ。  
 そのうち $ i $ 行目には、 $ i $ 個目のテストケースに対する答えを整数として出力せよ。

## 说明/提示

### 制約

- $ T $ は $ 1\ \le\ T\ \le\ 10^5 $ を満たす整数
- $ N $ は $ 1\ \le\ N\ \le\ 10^{18} $ を満たす整数
 
### Sample Explanation 1

この入力には、 $ 2 $ 個のテストケースが含まれます。 - $ 1 $ つ目のテストケースについて、 $ x=1 $ は $ y\ =\ \lfloor\ \sqrt{1}\ \rfloor\ =\ 1 $ となり問題文中の条件を満たします。 - $ 2 $ つ目のテストケースについて、例えば $ x=100 $ は $ y\ =\ \lfloor\ \sqrt{100}\ \rfloor\ =\ 10 $ となり問題文中の条件を満たします。

## 样例 #1

### 输入

```
2

1

174
```

### 输出

```
1

22
```



---

---
title: "[ARC176B] Simple Math 4"
layout: "post"
diff: 普及+/提高
pid: AT_arc176_b
tag: ['数学', '数论']
---

# [ARC176B] Simple Math 4

## 题目描述

[problemUrl]: https://atcoder.jp/contests/arc176/tasks/arc176_b

$ 2^N $ を $ 2^M\ -\ 2^K $ で割ったあまりの $ 1 $ の位を求めてください。

$ T $ 個のテストケースが与えられるので、それぞれについて答えを求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。ここで、$ \mathrm{case}_i $ は $ i $ 番目のテストケースを意味する。

> $ T $ $ \mathrm{case}_1 $ $ \mathrm{case}_2 $ $ \vdots $ $ \mathrm{case}_T $

各テストケースは以下の形式で与えられる。

> $ N $ $ M $ $ K $

## 输出格式

答えを出力せよ。

## 说明/提示

### 制約

- $ 1\ \le\ T\ \le\ 2\ \times\ 10^5 $
- $ 1\ \le\ N\ \le\ 10^{18} $
- $ 1\ \le\ K\ <\ M\ \le\ 10^{18} $
- $ N,M,K $ は整数
 
### Sample Explanation 1

$ 1 $ 個目のテストケースについて、$ 2^9 $ を $ 2^6\ -\ 2^2 $ で割ったあまりは $ 32 $ です。よって $ 32 $ の $ 1 $ の位の $ 2 $ が答えです。

## 样例 #1

### 输入

```
5

9 6 2

123 84 50

95 127 79

1000000007 998244353 924844033

473234053352300580 254411431220543632 62658522328486675
```

### 输出

```
2

8

8

8

4
```



---

---
title: "[ARC178B] 1 + 6 = 7"
layout: "post"
diff: 普及+/提高
pid: AT_arc178_b
tag: ['数学']
---

# [ARC178B] 1 + 6 = 7

## 题目描述

[problemUrl]: https://atcoder.jp/contests/arc178/tasks/arc178_b

正の整数 $ A_{1},\ A_{2},\ A_{3} $ が与えられます。 以下の条件を全て満たす正の整数の組 $ (X_{1},\ X_{2},\ X_{3}) $ の場合の数を $ 998244353 $ で割ったあまりを求めてください。

- $ X_{1} $ は $ 10 $ 進法で $ A_{1} $ 桁の正の整数
- $ X_{2} $ は $ 10 $ 進法で $ A_{2} $ 桁の正の整数
- $ X_{3} $ は $ 10 $ 進法で $ A_{3} $ 桁の正の整数
- $ X_{1}\ +\ X_{2}\ =\ X_{3} $
 
$ 1 $ つの入力ファイルにつき $ T $ 個のテストケースが与えられるので、それぞれについて解いてください。

## 输入格式

入力は以下の形式で標準入力から与えられます。

> $ T $ $ \text{case}_{1} $ $ \text{case}_{2} $ $ \vdots $ $ \text{case}_{T} $

各ケースは以下の形で与えられます。

> $ A_{1} $ $ A_{2} $ $ A_{3} $

## 输出格式

$ T $ 行出力してください。$ i $ 行目には $ \text{case}_{i} $ に対する答えを出力してください。

## 说明/提示

### 制約

- $ 1\leq\ T\leq\ 10^{5} $
- $ 1\leq\ A_{i}\leq\ 10^{9} $
- 入力は全て整数
 
### Sample Explanation 1

$ 1 $ つ目のケースについて、$ (X_{1},\ X_{2},\ X_{3})\ =\ (1,\ 6,\ 7),\ (2,\ 1,\ 3) $ などが条件を満たします。 $ (X_{1},\ X_{2},\ X_{3})\ =\ (6,\ 7,\ 13),\ (3,\ 4,\ 5) $ などは条件を満たしません。 条件を満たす $ (X_{1},\ X_{2},\ X_{3}) $ の組は $ 36 $ 通りあるので $ 36 $ を出力してください。 $ 3 $ つ目のケースについて、答えを $ 998244353 $ で割ったあまりを出力することに注意してください。 $ 4 $ つ目のケースについて、条件を満たす $ (X_{1},\ X_{2},\ X_{3}) $ の組が存在しないこともあります。

## 样例 #1

### 输入

```
4

1 1 1

1 6 7

167 167 167

111 666 777
```

### 输出

```
36

45

731780675

0
```



---

---
title: "[ARC184A] Appraiser"
layout: "post"
diff: 普及+/提高
pid: AT_arc184_a
tag: ['数学', '贪心', '构造']
---

# [ARC184A] Appraiser

## 题目描述

[problemUrl]: https://atcoder.jp/contests/arc184/tasks/arc184_a

この問題は **インタラクティブ** な問題であり、 **ジャッジは適応的(adaptive)** です。詳しくは注意点を参照してください。  
**また、問題文中のパラメータは $ N=1000,M=10,Q=950 $ で固定されています。**

硬貨が $ N $ 枚あり、 $ 1,2,\dots,N $ の番号が付けられています。  
これらの硬貨のうち、丁度 $ M $ 枚が偽物です。

鑑定士は $ 1 $ 度の鑑定で $ 2 $ つの硬貨が同種か異種かを判定できます。厳密には、

- $ 2 $ つの硬貨が「双方とも本物」「双方とも偽物」のどちらかであれば、同種と判定する。
- そうでないとき、異種と判定する。

$ Q $ 回以下の鑑定で、全ての偽物の硬貨を特定してください。

### Input &amp; Output Format

この問題はインタラクティブな問題です。  
最初に、 $ N,M,Q $ を標準入力から受け取ってください。

> $ N $ $ M $ $ Q $

次に、以下の流れで鑑定を $ 0 $ 回以上 $ Q $ 回以下行ってください。

まず、次の形式で標準出力に出力することで、硬貨 $ x,y $ を鑑定することを表します。 (末尾に改行を入れること。)

> ? $ x $ $ y $

ここで、 $ x,y $ は $ 1 $ 以上 $ N $ 以下の相異なる整数である必要があります。

これに対するジャッジシステムの応答は、以下の $ 3 $ 通りです。

```
0
```

応答が `0` であるとき、硬貨 $ x,y $ が同種であることを表します。

```
1
```

応答が `1` であるとき、硬貨 $ x,y $ が異種であることを表します。

```
-1
```

応答が `-1` であるとき、不当な鑑定であることを表します。具体的には

- 出力した $ x,y $ が制約を満たさなかった
- $ Q $ 回を超えて鑑定が行われた

の少なくともひとつが満たされた際にこの応答を行います。  
この応答を受け取った場合、プログラムはすでに不正解とみなされています。直ちにプログラムを終了してください。

最後に、次の形式で標準出力に出力することで、硬貨 $ A_1,A_2,\dots,A_{M} $ が偽物であると解答します。 (末尾に改行を入れること。)

> ! $ A_1 $ $ A_2 $ $ \dots $ $ A_{M} $

ここで、 $ A_i $ は $ 1 $ 以上 $ N $ 以下の相異なる整数である必要があります。  
この出力の後、直ちにプログラムを終了してください。

なお、全ての出力について、出力が指定された形式を満たさなかった場合もプログラムが不正解とみなされます。 その後 `-1` が返答されるので、その場合も直ちにプログラムを終了してください。

## 说明/提示

### 制約

- $ \color{red}{N\ =\ 1000} $
- $ \color{red}{M\ =\ 10} $
- $ \color{red}{Q\ =\ 950} $

### 注意点

- **出力を行うたびに、末尾に改行を入れて標準出力を flush してください。** そうしなかった場合、ジャッジ結果が TLE や WA となる可能性があります。
- 解答を出力したら (または `-1` を受け取ったら) ただちにプログラムを終了してください。そうしない場合、ジャッジ結果は不定です。
- 余計な改行は不正なフォーマットの出力とみなされることに注意してください。
- **この問題のジャッジシステムは、適応的(adaptive)です。** つまり、ジャッジシステムは、任意のタイミングにおいて、整合性がとれる限り、偽物の硬貨として想定しているものを変更する可能性があります。詳しくは入出力例も参照してください。

### 入出力例

この入力では $ N=5,M=2,Q=10 $ であり、ジャッジシステムは最初硬貨 $ 1,2 $ が偽物であると想定しています。

なお、この例は制約を満たさないので、ジャッジには含まれないことに注意してください。

入力出力説明`5 2 10`$ N,M,Q $ が与えられます。`? 1 2`硬貨 $ 1,2 $ について鑑定を行います。`0`硬貨 $ 1,2 $ は同種だと判定します。`? 1 3`硬貨 $ 1,3 $ について鑑定を行います。`1`硬貨 $ 1,3 $ は異種だと判定します。`? 1 4`硬貨 $ 1,4 $ について鑑定を行います。`1`硬貨 $ 1,4 $ は異種だと判定します。`! 1 2`硬貨 $ 1,2 $ が偽物だと解答します。確かに硬貨 $ 1,2 $ は偽物だと想定されていますが、硬貨 $ 3,4 $ を偽物であると想定しても整合性が取れます。  
よって、ジャッジシステムは偽物の硬貨として想定しているものを硬貨 $ 3,4 $ に変更できます。  
これにより、ジャッジシステムは不正解の判定を下すこともあります。



---

---
title: "[ARC187A] Add and Swap"
layout: "post"
diff: 普及+/提高
pid: AT_arc187_a
tag: ['数学', '分类讨论']
---

# [ARC187A] Add and Swap

## 题目描述

给定两个整数 $N,K$ 与一个长度为 $N$ 的数列 $A=(A_1,\dots,A_N)$。

问是否能对 $A$ 执行不超过 $500000$ 次以下的操作，使 $A$ 变为单调不减数列：

- 选择一个 $i$ 满足 $1\le i<N$，将 $A_{i+1}+k \to A_i$ 且 $A_{i}\to A_{i+1}$，注意两种操作同时进行。

如果可以，请输出具体方案。

## 输入格式

输入按以下格式给出：

>$N$ $K$ 
>
>$A_1$ $\dots$ $A_N$

## 输出格式

若无法对 $A$ 执行不超过 $500000$ 次的操作，使 $A$ 变为单调不减数列，输出一个字符串 `No`。否则，设 $M$ 为操作次数，$i_k$ 为第 $k$ 次操作选择的 $i$，则按以下格式输出：

>Yes
>
>$M$
>
>$i_1$ $\dots$ $i_m$

若有多个方案，输出任意一种均可。

## 说明/提示

输入的所有数字均为整数。

$2\le N\le 50$

$1\le K\le 50$

$1\le A_i\le 50$

Translated by @[ARIS2_0](https://www.luogu.com.cn/user/1340759)

## 样例 #1

### 输入

```
3 2
3 6 4
```

### 输出

```
Yes
1
2
```

## 样例 #2

### 输入

```
3 3
1 5 8
```

### 输出

```
Yes
2
2 2
```



---

---
title: "[ARC189A] Reversi 2"
layout: "post"
diff: 普及+/提高
pid: AT_arc189_a
tag: ['组合数学']
---

# [ARC189A] Reversi 2

## 题目描述

在一个由 $N$ 个格子组成的棋盘上，每个格子从 $1$ 到 $N$ 进行编号。

起初，第 $i$ 个格子上写有 $i \bmod 2$ 的数字。你可以进行以下操作若干次（可以是零次）：

- 选择两个满足条件的格子 $l$ 和 $r$（要求 $l + 1 < r$），将中间格子 $l + 1, l + 2, \dots, r - 1$ 上的数字全部改为格子 $l$ 上的数字。
  - 条件是格子 $l$ 和格子 $r$ 上的数字相同。
  - 并且中间的每个格子 $i$ （$l < i < r$）上的数字要与格子 $l$ 上的不同。
  
计算最后能使每个格子 $i$ 上的数字为 $A_i$ 的操作序列数量，并对结果取 $998244353$ 的余数。

注：若两个操作序列满足以下任一条件即视作不同：长度不同，或者存在一个正整数 $t$，使得操作中第 $t$ 次选择的 $(l, r)$ 组合不同。

## 输入格式

从标准输入读入以下格式的数据：
> $N$ $A_1$ $A_2$ $\dots$ $A_N$

## 输出格式

输出计算结果。

## 说明/提示

- $1 \le N \le 2 \times 10^5$
- $0 \le A_i \le 1$
  
### 样例解释 1

为了使格子 $i(1 \le i \le N)$ 上的数字变为 $A_i$，可以按照以下步骤进行操作（这里用数列 $X = (X_1, X_2, \dots, X_N)$ 表示格子的状态）：
- 初始状态：$X = (1, 0, 1, 0, 1, 0)$。
- 选择格子 $2$ 和 $4$，之后状态变为 $X = (1, 0, 0, 0, 1, 0)$。
- 选择格子 $1$ 和 $5$，最终状态为 $X = (1, 1, 1, 1, 1, 0)$。

除了上述方法外，还有另外两种操作方法可以实现每个格子 $i$ 上的数字变为 $A_i$，因此答案是 $3$。

 **本翻译由 AI 自动生成**

## 样例 #1

### 输入

```
6

1 1 1 1 1 0
```

### 输出

```
3
```

## 样例 #2

### 输入

```
10

1 1 1 1 1 0 1 1 1 0
```

### 输出

```
9
```



---

---
title: "[ARC189B] Minimize Sum"
layout: "post"
diff: 普及+/提高
pid: AT_arc189_b
tag: ['数学', '差分']
---

# [ARC189B] Minimize Sum

## 题目描述

数轴上有 $N$ 个棋子，最初所有棋子都放置在不同的坐标上，第 $i$ 个棋子放置在坐标 $X_i$ 上。

你可以进行以下操作若干次（可以为 $0$ 次）：

- 选择一个 $i$ 满足 $1\le i\le N-3$，并设 $M$ 为 $X_i$ 与 $X_{i+3}$ 的中点坐标。

- 然后，分别将坐标为 $X_{i+1}$ 与 $X_{i+2}$ 的两颗棋子放在原坐标关于 $M$ 对称的坐标，最后，使坐标较小的棋子的坐标为 $X_{i+1}$，另外一个棋子的坐标为 $X_{i+2}$。

- 可以证明无论如何重复操作，所有的棋子都放置在不同的坐标处。

请找出若干次操作后，$\sum_{i=1}^N X_i$ 的最小值。

## 输入格式

输入按以下格式给出：

> $N$
>
> $X_1$ $X_2$ $\dots$ $X_N$

## 输出格式

一行一个数，表示若干次操作后，$\sum_{i=1}^N X_i$ 的最小值。

Translated by @[ARIS2_0](luogu://user/1340759)

## 样例 #1

### 输入

```
4

1 5 7 10
```

### 输出

```
21
```

## 样例 #2

### 输入

```
6

0 1 6 10 14 16
```

### 输出

```
41
```



---

---
title: "[ARC190A] Inside or Outside"
layout: "post"
diff: 普及+/提高
pid: AT_arc190_a
tag: ['数学', '分类讨论']
---

# [ARC190A] Inside or Outside

## 题目描述

[problemUrl]: https://atcoder.jp/contests/arc190/tasks/arc190_a

整数列 $ x\ =\ (x_1,\ \ldots,\ x_N) $ があり，$ x_1=\cdots=x_N=0 $ で初期化されています．

あなたはこの整数列について，$ M $ 回の操作を行います．$ i $ 回目の操作では，$ 1\leq\ L_i\leq\ R_i\leq\ N $ を満たす整数の組 $ (L_i,\ R_i) $ が与えられるので，以下の $ 3 $ つのうち**ちょうど** $ 1 $ つを行います．

- 操作 $ 0 $：何もしない．この操作にはコストが $ 0 $ かかる．
- 操作 $ 1 $：$ 1\leq\ j\leq\ N $ を満たす各整数 $ j $ に対して，$ L_i\leq\ j\leq\ R_i $ を**満たす**ならば $ x_j=1 $ と定める．この操作にはコストが $ 1 $ かかる．
- 操作 $ 2 $：$ 1\leq\ j\leq\ N $ を満たす各整数 $ j $ に対して，$ L_i\leq\ j\leq\ R_i $ を**満たさない**ならば $ x_j=1 $ と定める．この操作にはコストが $ 1 $ かかる．

あなたの目標は，最終的に $ x_1=\cdots=x_N=1 $ が成り立つようにすることです．この目標が達成できるか否かを判定してください．目標が達成可能な場合には，そのような方法のうち操作にかかるコストの総和が最小となるものをひとつ答えてください．

## 输入格式

入力は以下の形式で標準入力から与えられます．

> $ N $ $ M $ $ L_1 $ $ R_1 $ $ \vdots $ $ L_M $ $ R_M $

## 输出格式

目標が達成不可能な場合には `-1` と出力してください．

目標が達成可能な場合には，そのような方法のうち操作にかかるコストの総和が最小となるものを，コストの総和の最小値を $ K $，$ i $ 回目で行う操作の種類（$ 0 $ または $ 1 $ または $ 2 $）を $ \mathrm{op}_i $ として，次の形式で出力してください．

> $ K $ $ \mathrm{op}_1 $ $ \cdots $ $ \mathrm{op}_M $

操作にかかるコストの総和を最小化する方法が複数存在する場合には，そのどれを出力しても正解となります．

## 说明/提示

### 制約

- $ 1\leq\ N\leq\ 1000000 $
- $ 1\leq\ M\leq\ 200000 $
- $ 1\leq\ L_i\leq\ R_i\leq\ N $
- 入力される値はすべて整数

### Sample Explanation 1

出力例では $ x $ は次のように変化します． - はじめ $ x=(0,0,0,0,0) $ である． - $ 1 $ 回目の操作で操作 $ 2 $ を行う．$ x_1,x_5 $ が $ 1 $ になり，$ x=(1,0,0,0,1) $ になる． - $ 2 $ 回目の操作で操作 $ 0 $ を行う．$ x=(1,0,0,0,1) $ になる． - $ 3 $ 回目の操作で操作 $ 1 $ を行う．$ x_1,x_2,x_3,x_4 $ が $ 1 $ になり，$ x=(1,1,1,1,1) $ になる． - $ 4 $ 回目の操作で操作 $ 0 $ を行う．$ x=(1,1,1,1,1) $ になる．

## 样例 #1

### 输入

```
5 4
2 4
3 5
1 4
2 5
```

### 输出

```
2
2 0 1 0
```

## 样例 #2

### 输入

```
5 4
1 3
1 5
2 4
3 5
```

### 输出

```
1
0 1 0 0
```

## 样例 #3

### 输入

```
5 2
1 3
2 5
```

### 输出

```
2
1 1
```

## 样例 #4

### 输入

```
5 2
1 3
2 4
```

### 输出

```
-1
```



---


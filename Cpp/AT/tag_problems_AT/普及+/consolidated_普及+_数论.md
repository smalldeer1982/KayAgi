---
title: "[ABC254F] Rectangle GCD"
layout: "post"
diff: 普及+/提高
pid: AT_abc254_f
tag: ['数论', '未知标签231', '最大公约数 gcd', 'ST 表']
---

# [ABC254F] Rectangle GCD

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc254/tasks/abc254_f

正整数 $ N $ と長さ $ N $ の正整数列 $ A=(A_1,A_2,\dots,A_N) $ と $ B=(B_1,B_2,\dots,B_N) $ が与えられます。

$ N\ \times\ N $ のマス目があります。上から $ i $ 行目、左から $ j $ 列目のマスをマス $ (i,j) $ と呼びます。$ 1\ \le\ i,j\ \le\ N $ を満たす整数の組 $ (i,j) $ に対し、マス $ (i,j) $ に $ A_i\ +\ B_j $ が書かれています。以下のクエリを $ Q $ 個処理してください。

- $ 1\ \le\ h_1\ \le\ h_2\ \le\ N,1\ \le\ w_1\ \le\ w_2\ \le\ N $ を満たす整数の組 $ h_1,h_2,w_1,w_2 $ が与えられる。左上隅が $ (h_1,w_1) $、右下隅が $ (h_2,w_2) $ である矩形領域に含まれる整数の最大公約数を求めよ。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ Q $ $ A_1 $ $ A_2 $ $ \dots $ $ A_N $ $ B_1 $ $ B_2 $ $ \dots $ $ B_N $ $ \mathrm{query}_1 $ $ \mathrm{query}_2 $ $ \vdots $ $ \mathrm{query}_Q $

各クエリは以下の形式で与えられる。

> $ h_1 $ $ h_2 $ $ w_1 $ $ w_2 $

## 输出格式

$ Q $ 行出力せよ。$ i $ 行目には $ \mathrm{query}_i $ の答えを出力せよ。

## 说明/提示

### 制約

- $ 1\ \le\ N,Q\ \le\ 2\ \times\ 10^5 $
- $ 1\ \le\ A_i,B_i\ \le\ 10^9 $
- $ 1\ \le\ h_1\ \le\ h_2\ \le\ N $
- $ 1\ \le\ w_1\ \le\ w_2\ \le\ N $
- 入力はすべて整数である。

### Sample Explanation 1

マス $ (i,j) $ に書かれている整数を $ C_{i,j} $ とします。 $ 1 $ 個目のクエリについて、$ C_{1,2}=4,C_{1,3}=6,C_{2,2}=6,C_{2,3}=8 $ なのでこれらの最大公約数の $ 2 $ が答えとなります。

## 样例 #1

### 输入

```
3 5
3 5 2
8 1 3
1 2 2 3
1 3 1 3
1 1 1 1
2 2 2 2
3 3 1 1
```

### 输出

```
2
1
11
6
10
```

## 样例 #2

### 输入

```
1 1
9
100
1 1 1 1
```

### 输出

```
109
```



---

---
title: "[ABC319E] Bus Stops"
layout: "post"
diff: 普及+/提高
pid: AT_abc319_e
tag: ['数论']
---

# [ABC319E] Bus Stops

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc319/tasks/abc319_e

高橋君ははじめ高橋君の家におり、これから青木君の家に遊びに行きます。

$ 2 $ 人の家の間には $ 1 $ から $ N $ までの番号がつけられた $ N $ 個のバス停があり、高橋君はそれらの間を下記の方法で移動できます。

- 高橋君の家からバス停 $ 1 $ まで $ X $ だけの時間をかけて徒歩で移動できます。
- 各 $ i\ =\ 1,\ 2,\ \ldots,\ N-1 $ について、バス停 $ i $ からは $ P_i $ の倍数である時刻それぞれにバスが出発し、そのバスに乗ることで $ T_i $ だけの時間をかけてバス停 $ (i+1) $ に移動できます。**ここで、$ 1\ \leq\ P_i\ \leq\ 8 $ が制約として保証されます。**
- バス停 $ N $ から青木君の家まで、$ Y $ だけの時間をかけて徒歩で移動できます。
 
各 $ i\ =\ 1,\ 2,\ \ldots,\ Q $ に対して下記のクエリを処理してください。

> 高橋君が高橋君の家を時刻 $ q_i $ に出発するときの、高橋君が青木君の家に到着する時刻としてあり得る最も早いものを求めよ。

なお、バスの出発時刻ちょうどにそのバスが出発するバス停に到着した場合であっても、そのバスに乗ることができます。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ X $ $ Y $ $ P_1 $ $ T_1 $ $ P_2 $ $ T_2 $ $ \vdots $ $ P_{N-1} $ $ T_{N-1} $ $ Q $ $ q_1 $ $ q_2 $ $ \vdots $ $ q_Q $

## 输出格式

$ Q $ 行出力せよ。 $ i\ =\ 1,\ 2,\ \ldots,\ Q $ について、$ i $ 行目には $ i $ 番目のクエリに対する答えを出力せよ。

## 说明/提示

### 制約

- $ 2\ \leq\ N\ \leq\ 10^5 $
- $ 1\ \leq\ X,\ Y\ \leq\ 10^9 $
- $ 1\ \leq\ P_i\ \leq\ 8 $
- $ 1\ \leq\ T_i\ \leq\ 10^9 $
- $ 1\ \leq\ Q\ \leq\ 2\ \times\ 10^5 $
- $ 0\ \leq\ q_i\ \leq\ 10^9 $
- 入力はすべて整数
 
### Sample Explanation 1

$ 1 $ 番目のクエリについて、高橋君は下記の通りに移動を行って、時刻 $ 34 $ に青木君の家に到着することができます。 - 時刻 $ 13 $ に高橋君の家を出発する。 - 高橋君の家から徒歩で移動し、時刻 $ 15 $ にバス停 $ 1 $ に到着する。 - 時刻 $ 15 $ にバス停 $ 1 $ を出発するバスに乗り、時刻 $ 19 $ にバス停 $ 2 $ に到着する。 - 時刻 $ 24 $ にバス停 $ 2 $ を出発するバスに乗り、時刻 $ 30 $ にバス停 $ 3 $ に到着する。 - 時刻 $ 30 $ にバス停 $ 3 $ を出発するバスに乗り、時刻 $ 31 $ にバス停 $ 4 $ に到着する。 - バス停 $ 4 $ から徒歩で移動し、時刻 $ 34 $ に青木君の家に到着する。 $ 2 $ 番目のクエリについて、高橋君は下記の通りに移動を行って、時刻 $ 22 $ に青木君の家に到着することができます。 - 時刻 $ 0 $ に高橋君の家を出発する。 - 高橋君の家から徒歩で移動し、時刻 $ 2 $ にバス停 $ 1 $ に到着する。 - 時刻 $ 5 $ にバス停 $ 1 $ を出発するバスに乗り、時刻 $ 9 $ にバス停 $ 2 $ に到着する。 - 時刻 $ 12 $ にバス停 $ 2 $ を出発するバスに乗り、時刻 $ 18 $ にバス停 $ 3 $ に到着する。 - 時刻 $ 18 $ にバス停 $ 3 $ を出発するバスに乗り、時刻 $ 19 $ にバス停 $ 4 $ に到着する。 - バス停 $ 4 $ から徒歩で移動し、時刻 $ 22 $ に青木君の家に到着する。

## 样例 #1

### 输入

```
4 2 3

5 4

6 6

3 1

7

13

0

710511029

136397527

763027379

644706927

447672230
```

### 输出

```
34

22

710511052

136397548

763027402

644706946

447672250
```



---

---
title: "[ABC342D] Square Pair"
layout: "post"
diff: 普及+/提高
pid: AT_abc342_d
tag: ['数论']
---

# [ABC342D] Square Pair

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc342/tasks/abc342_d

長さ $ N $ の非負整数列 $ A=(A_1,\ldots,A_N) $ が与えられます。以下の条件を共に満たす整数組 $ (i,j) $ の個数を求めてください。

- $ 1\leq\ i\ <\ j\leq\ N $
- $ A_i\ A_j $ は平方数
 
ここで非負整数 $ a $ は、ある非負整数 $ d $ を用いて $ a=d^2 $ と表せる場合平方数と呼ばれます。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ A_1 $ $ \ldots $ $ A_N $

## 输出格式

答えを出力せよ。

## 说明/提示

### 制約

- 入力は全て整数
- $ 2\leq\ N\leq\ 2\times\ 10^5 $
- $ 0\leq\ A_i\leq\ 2\times\ 10^5 $
 
### Sample Explanation 1

条件を満たす整数組は $ (i,j)=(1,2),(1,3),(1,4),(1,5),(2,5),(3,4) $ の $ 6 $ つです。 例えば、$ A_2A_5=36 $ であり $ 36 $ は平方数なので、$ (i,j)=(2,5) $ は条件を満たします。

## 样例 #1

### 输入

```
5

0 3 2 8 12
```

### 输出

```
6
```

## 样例 #2

### 输入

```
8

2 2 4 6 3 100 100 25
```

### 输出

```
7
```



---

---
title: "[ABC368F] Dividing Game"
layout: "post"
diff: 普及+/提高
pid: AT_abc368_f
tag: ['博弈论', '数论']
---

# [ABC368F] Dividing Game

## 题目描述

给定一个长度为 $ N $ 的正整数列 $ A = (A_1, A_2, \dots, A_N) $，其中每个元素都大于等于 $ 2 $。Anna 和 Bruno 将使用这些整数进行游戏。游戏由 Anna 先手，两人轮流进行以下操作：

- 随意选择一个整数 $ i $（$ 1 \leq i \leq N $）。选择 $ A_i $ 的一个正的除数 $ x $（$ x $ 不能是 $ A_i $ 本身），并将 $ A_i $ 替换为 $ x $。

当某一方无法进行操作时，该方输掉游戏，另一方获胜。双方都采取最优策略时，判断谁会获胜。

## 输入格式

输入从标准输入以以下格式给出：

```
N
A_1 A_2 ... A_N
```

## 输出格式

如果 Anna 获胜，输出 `Anna`；如果 Bruno 获胜，输出 `Bruno`。

## 说明/提示

### 限制

- $ 1 \leq N \leq 10^5 $
- $ 2 \leq A_i \leq 10^5 $
- 所有输入都是整数

### 示例解释 #1

以下是一个可能的游戏过程，但请注意，这并不一定是双方都采取最优策略的情况。例如：

- Anna 将 $ A_3 $ 替换为 $ 2 $。
- Bruno 将 $ A_1 $ 替换为 $ 1 $。
- Anna 将 $ A_2 $ 替换为 $ 1 $。
- Bruno 将 $ A_3 $ 替换为 $ 1 $。
- Anna 无法进行操作，因此 Bruno 获胜。
  实际上，在这个示例中，如果 Anna 采取最优策略，她总是可以获胜。

## 样例 #1

### 输入

```
3

2 3 4
```

### 输出

```
Anna
```

## 样例 #2

### 输入

```
4

2 3 4 6
```

### 输出

```
Bruno
```



---

---
title: "[AGC047A] Integer Product"
layout: "post"
diff: 普及+/提高
pid: AT_agc047_a
tag: ['数论']
---

# [AGC047A] Integer Product

## 题目描述

[problemUrl]: https://atcoder.jp/contests/agc047/tasks/agc047_a

$ N $ 個の実数 $ A_1,\ A_2,\ \ldots,\ A_N $ が与えられます。添字のペア $ (i,\ j) $ ($ i\ <\ j $) であって、積 $ A_i\ \cdot\ A_j $ が整数であるようなものの個数を求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ A_1 $ $ A_2 $ $ \vdots $ $ A_N $

## 输出格式

積 $ A_i\ \cdot\ A_j $ が整数であるような添字のペア $ (i,\ j) $ ($ i\ <\ j $) の個数を出力せよ。

## 说明/提示

### 制約

- $ 2\ \leq\ N\ \leq\ 200\,000 $
- $ 0\ <\ A_i\ <\ 10^4 $
- $ A_i $ は小数部の桁数が $ 9 $ 以下であるような数として与えられる。

### Sample Explanation 1

積が整数であるようなペアは以下の $ 3 $ 個です。 - $ 7.5\ \cdot\ 2.4\ =\ 18 $ - $ 7.5\ \cdot\ 16\ =\ 120 $ - $ 17\ \cdot\ 16\ =\ 272 $

## 样例 #1

### 输入

```
5

7.5

2.4

17.000000001

17

16.000000000
```

### 输出

```
3
```

## 样例 #2

### 输入

```
11

0.9

1

1

1.25

2.30000

5

70

0.000000001

9999.999999999

0.999999999

1.000000001
```

### 输出

```
8
```



---

---
title: "[ARC124C] LCM of GCDs"
layout: "post"
diff: 普及+/提高
pid: AT_arc124_c
tag: ['数论', '枚举', '最大公约数 gcd']
---

# [ARC124C] LCM of GCDs

## 题目描述

[problemUrl]: https://atcoder.jp/contests/arc124/tasks/arc124_c

赤い袋と青い袋と $ N $ 個のカードパックがあります。はじめどちらの袋も空です。 それぞれのカードパックには整数が書かれた $ 2 $ 枚のカードが封入されており、$ i $ 番目のカードパックに入っているカードにはそれぞれ $ a_i,b_i $ が書かれていることがわかっています。

それぞれのカードパックについて、一方のカードを赤い袋に、他方のカードを青い袋に入れます。

カードを袋に入れ終えたのち、赤い袋に入ったカードに書かれた整数全体の最大公約数を $ X $ とします。 同様に、青い袋に入ったカードに書かれた整数全体の最大公約数を $ Y $ とします。 $ X $ と $ Y $ の最小公倍数の値が得点となります。

得点としてありうる値の最大値を求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ a_1 $ $ b_1 $ $ \vdots $ $ a_N $ $ b_N $

## 输出格式

得点としてありうる値の最大値を出力せよ。

## 说明/提示

### 制約

- 与えられる入力は全て整数
- $ 1\ \leq\ N\ \leq\ 50 $
- $ 1\ \leq\ a_i,\ b_i\ \leq\ 10^9 $

### Sample Explanation 1

\- $ 2 $ が書かれたカードを赤い袋に入れ、$ 15 $ が書かれたカードを青い袋に入れ、$ 6 $ が書かれたカードを赤い袋に入れ、$ 10 $ が書かれたカードを青い袋に入れるのが最適な入れ方の $ 1 $ つです。 - このとき、赤い袋に入ったカードに書かれた整数全体の最大公約数は $ 2 $、青い袋に入ったカードに書かれた整数全体の最大公約数は $ 5 $ です。 - このときの得点は $ 10 $ です。

## 样例 #1

### 输入

```
2

2 15

10 6
```

### 输出

```
10
```

## 样例 #2

### 输入

```
5

148834018 644854700

947642099 255192490

35137537 134714230

944287156 528403260

68656286 200621680
```

### 输出

```
238630
```

## 样例 #3

### 输入

```
20

557057460 31783488

843507940 794587200

640711140 620259584

1901220 499867584

190122000 41414848

349507610 620259584

890404700 609665088

392918800 211889920

507308870 722352000

156850650 498904448

806117280 862969856

193607570 992030080

660673950 422816704

622015810 563434560

207866720 316871744

63057130 117502592

482593010 366954816

605221700 705015552

702500790 900532160

171743540 353470912
```

### 输出

```
152594452160
```



---

---
title: "[ARC159B] GCD Subtraction"
layout: "post"
diff: 普及+/提高
pid: AT_arc159_b
tag: ['数论']
---

# [ARC159B] GCD Subtraction

## 题目描述

[problemUrl]: https://atcoder.jp/contests/arc159/tasks/arc159_b

変数 $ a,b $ があり、初め $ a=A,\ b=B $ です。

高橋君は $ a,b $ がともに $ 1 $ 以上の間、次の操作を繰り返すことにしました。

- $ a $ と $ b $ の最大公約数を $ g $ とする。そして、$ a,b $ をそれぞれ $ a-g,b-g $ に置き換える。
 
操作は何回行われますか。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ A $ $ B $

## 输出格式

答えを出力せよ。

## 说明/提示

### 制約

- $ 1\ \leq\ A,B\ \leq\ 10^{12} $
- $ A,B $ は整数
 
### Sample Explanation 1

$ a=15,b=9 $ の状態から以下のように操作が行われます。 - $ g=3 $ とする。そして、$ a,b $ がそれぞれ $ 12(=15-3),6(=9-3) $ に置き換えられる。 - $ g=6 $ とする。そして、$ a,b $ がそれぞれ $ 6(=12-6),0(=6-6) $ に置き換えられる。$ b $ が $ 1 $ 以上でなくなったため、操作の繰り返しはここで終了する。

## 样例 #1

### 输入

```
15 9
```

### 输出

```
2
```

## 样例 #2

### 输入

```
1 1
```

### 输出

```
1
```

## 样例 #3

### 输入

```
12345678910 10987654321
```

### 输出

```
36135
```



---

---
title: "[ARC160B] Triple Pair"
layout: "post"
diff: 普及+/提高
pid: AT_arc160_b
tag: ['数论', '整除分块']
---

# [ARC160B] Triple Pair

## 题目描述

[problemUrl]: https://atcoder.jp/contests/arc160/tasks/arc160_b

正整数 $ N $ が与えられます。

以下の条件を満たす $ 3 $ 個の正整数の組 $ (x,y,z) $ の個数を $ 998244353 $ で割ったあまりを求めてください。

- $ xy,yz,zx $ が全て $ N $ 以下である。
 
$ T $ 個のテストケースが与えられるので、それぞれについて答えを求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

ここで、$ \mathrm{case}_i $ とは、$ i $ 番目のテストケースを意味する。

> $ T $ $ \mathrm{case}_1 $ $ \mathrm{case}_2 $ $ \vdots $ $ \mathrm{case}_T $

各テストケースは以下の形式で与えられる。

> $ N $

## 输出格式

$ T $ 行出力せよ。$ i(1\ \le\ i\ \le\ T) $ 行目には、$ i $ 番目のテストケースに対する答えを出力せよ。

## 说明/提示

### 制約

- $ 1\ \le\ T\ \le\ 100 $
- $ 1\ \le\ N\ \le\ 10^9 $
 
### Sample Explanation 1

$ 1 $ 個目のテストケースでは、$ N=1 $ です。条件を満たす $ (x,y,z) $ は $ (1,1,1) $ の $ 1 $ 個です。 $ 2 $ 個目のテストケースでは、$ N=2 $ です。条件を満たす $ (x,y,z) $ は、$ (1,1,1),(2,1,1),(1,2,1),(1,1,2) $ の $ 4 $ 個です。

## 样例 #1

### 输入

```
4

1

2

5

998244353
```

### 输出

```
1

4

17

727512986
```



---

---
title: "[ARC176B] Simple Math 4"
layout: "post"
diff: 普及+/提高
pid: AT_arc176_b
tag: ['数学', '数论']
---

# [ARC176B] Simple Math 4

## 题目描述

[problemUrl]: https://atcoder.jp/contests/arc176/tasks/arc176_b

$ 2^N $ を $ 2^M\ -\ 2^K $ で割ったあまりの $ 1 $ の位を求めてください。

$ T $ 個のテストケースが与えられるので、それぞれについて答えを求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。ここで、$ \mathrm{case}_i $ は $ i $ 番目のテストケースを意味する。

> $ T $ $ \mathrm{case}_1 $ $ \mathrm{case}_2 $ $ \vdots $ $ \mathrm{case}_T $

各テストケースは以下の形式で与えられる。

> $ N $ $ M $ $ K $

## 输出格式

答えを出力せよ。

## 说明/提示

### 制約

- $ 1\ \le\ T\ \le\ 2\ \times\ 10^5 $
- $ 1\ \le\ N\ \le\ 10^{18} $
- $ 1\ \le\ K\ <\ M\ \le\ 10^{18} $
- $ N,M,K $ は整数
 
### Sample Explanation 1

$ 1 $ 個目のテストケースについて、$ 2^9 $ を $ 2^6\ -\ 2^2 $ で割ったあまりは $ 32 $ です。よって $ 32 $ の $ 1 $ の位の $ 2 $ が答えです。

## 样例 #1

### 输入

```
5

9 6 2

123 84 50

95 127 79

1000000007 998244353 924844033

473234053352300580 254411431220543632 62658522328486675
```

### 输出

```
2

8

8

8

4
```



---

---
title: "[ARC188B] Symmetric Painting"
layout: "post"
diff: 普及+/提高
pid: AT_arc188_b
tag: ['数论']
---

# [ARC188B] Symmetric Painting

## 题目描述

[problemUrl]: https://atcoder.jp/contests/arc188/tasks/arc188_b

円周上を $ N $ 等分する位置に、点 $ 0,1,\ \ldots\ ,\ N-1 $ がこの順に並んでおり、Alice が点 $ 0 $ に、Bob が点 $ K $ にいます。また、初め全ての点は白色に塗られています。両者は、Alice から始めて交互に次のような操作を行います。

- その時点で白色である点を $ 1 $ つ選び、黒色に塗る。ただし、操作後に、操作者と円の中心を結ぶ直線に対して、各点の色が線対称でなければいけない。

操作者が上記の条件を満たす操作ができなければ、そこで一連の操作を打ち切ります。

両者とも、最終的に最も多くの点を黒く塗ることができるように協力して最善の選択をします。一連の操作が全て終了したときに全ての点を黒く塗ることができているかどうかを求めてください。

$ T $ 個のテストケースが与えられるので、それぞれについて答えてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ T $ $ \mathrm{case}_1 $ $ \mathrm{case}_2 $ $ \vdots $ $ \mathrm{case}_T $

各テストケース $ \mathrm{case}_i\ (1\leq\ i\ \leq\ T) $ は以下の形式である。

> $ N $ $ K $

## 输出格式

$ T $ 行出力せよ。$ i $ 行目には、$ i $ 番目のテストケースについて、全ての点を黒く塗ることができるなら `Yes` 、できないなら `No` と出力せよ。

## 说明/提示

### 制約

- $ 1\leq\ T\leq\ 10^5 $
- $ 2\leq\ N\leq\ 2\times\ 10^5 $
- $ 1\leq\ K\leq\ N-1 $
- 入力される値はすべて整数である

### Sample Explanation 1

$ N=6,\ K=2 $ の場合、例えば以下のような順で操作を行うことで全ての点を黒く塗ることができます。 1. Alice が点 $ 3 $ を黒く塗る。 2. Bob が点 $ 1 $ を黒く塗る。 3. Alice が点 $ 5 $ を黒く塗る。 4. Bob が点 $ 2 $ を黒く塗る。 5. Alice が点 $ 4 $ を黒く塗る。 6. Bob が点 $ 0 $ を黒く塗る。 !\[\](https://img.atcoder.jp/arc188/ecb64f0798aaa883117c594cb6db2724.png) $ N=6,\ K=3 $ の場合、例えば以下のような進行が考えられます。実は、どのようにしても全ての点を黒く塗ることはできません。 1. Alice が点 $ 3 $ を黒く塗る。 2. Bob が点 $ 0 $ を黒く塗る。 3. Alice はどの点を黒く塗っても自身から見て線対称にできないため、操作を行えない。

## 样例 #1

### 输入

```
4
6 2
6 3
6 1
200000 100000
```

### 输出

```
Yes
No
Yes
No
```



---


---
title: "[ABC254F] Rectangle GCD"
layout: "post"
diff: 普及+/提高
pid: AT_abc254_f
tag: ['数论', '未知标签231', '最大公约数 gcd', 'ST 表']
---

# [ABC254F] Rectangle GCD

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc254/tasks/abc254_f

正整数 $ N $ と長さ $ N $ の正整数列 $ A=(A_1,A_2,\dots,A_N) $ と $ B=(B_1,B_2,\dots,B_N) $ が与えられます。

$ N\ \times\ N $ のマス目があります。上から $ i $ 行目、左から $ j $ 列目のマスをマス $ (i,j) $ と呼びます。$ 1\ \le\ i,j\ \le\ N $ を満たす整数の組 $ (i,j) $ に対し、マス $ (i,j) $ に $ A_i\ +\ B_j $ が書かれています。以下のクエリを $ Q $ 個処理してください。

- $ 1\ \le\ h_1\ \le\ h_2\ \le\ N,1\ \le\ w_1\ \le\ w_2\ \le\ N $ を満たす整数の組 $ h_1,h_2,w_1,w_2 $ が与えられる。左上隅が $ (h_1,w_1) $、右下隅が $ (h_2,w_2) $ である矩形領域に含まれる整数の最大公約数を求めよ。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ Q $ $ A_1 $ $ A_2 $ $ \dots $ $ A_N $ $ B_1 $ $ B_2 $ $ \dots $ $ B_N $ $ \mathrm{query}_1 $ $ \mathrm{query}_2 $ $ \vdots $ $ \mathrm{query}_Q $

各クエリは以下の形式で与えられる。

> $ h_1 $ $ h_2 $ $ w_1 $ $ w_2 $

## 输出格式

$ Q $ 行出力せよ。$ i $ 行目には $ \mathrm{query}_i $ の答えを出力せよ。

## 说明/提示

### 制約

- $ 1\ \le\ N,Q\ \le\ 2\ \times\ 10^5 $
- $ 1\ \le\ A_i,B_i\ \le\ 10^9 $
- $ 1\ \le\ h_1\ \le\ h_2\ \le\ N $
- $ 1\ \le\ w_1\ \le\ w_2\ \le\ N $
- 入力はすべて整数である。

### Sample Explanation 1

マス $ (i,j) $ に書かれている整数を $ C_{i,j} $ とします。 $ 1 $ 個目のクエリについて、$ C_{1,2}=4,C_{1,3}=6,C_{2,2}=6,C_{2,3}=8 $ なのでこれらの最大公約数の $ 2 $ が答えとなります。

## 样例 #1

### 输入

```
3 5
3 5 2
8 1 3
1 2 2 3
1 3 1 3
1 1 1 1
2 2 2 2
3 3 1 1
```

### 输出

```
2
1
11
6
10
```

## 样例 #2

### 输入

```
1 1
9
100
1 1 1 1
```

### 输出

```
109
```



---

---
title: "[AGC022B] GCD Sequence"
layout: "post"
diff: 普及+/提高
pid: AT_agc022_b
tag: ['数学', '最大公约数 gcd', '构造']
---

# [AGC022B] GCD Sequence

## 题目描述

[problemUrl]: https://atcoder.jp/contests/agc022/tasks/agc022_b

ナガセは高校の優等生です。ある日のこと、ナガセは正の整数からなる特別な集合のとある性質を分析しています。

ナガセの考えでは、**異なる** 正の整数の集合 $ S\ =\ \{a_{1},\ a_{2},\ ...,\ a_{N}\} $ は、以下の条件を満たす場合に **特別** であると呼ばれます。条件：どの $ 1\ \leq\ i\ \leq\ N $ についても、$ a_{i} $ と、$ S $ のその他の要素の和の最大公約数は $ 1 $ **ではない**。

ナガセは、要素数 $ N $ の **特別** な集合を求めたいです。ところがこれは簡単すぎるので、難易度を上げることにしました。要素数 $ N $ の **特別** な集合であって、すべての要素の最大公約数が $ 1 $ であり、どの要素も $ 30000 $ 以下であるものを求めてみよ、とのことです。

## 输入格式

入力は標準入力から以下の形式で与えられる。

> $ N $

## 输出格式

$ S $ の要素を表す $ N $ 個の整数を空白で区切って出力せよ。$ S $ は以下の条件を満たさなければならない。

- 要素は $ 30000 $ 以下の **異なる** 正の整数でなければならない。
- $ S $ のすべての要素の最大公約数は $ 1 $ である。すなわち、$ S $ のすべての要素を割り切るような整数 $ d\ >\ 1 $ は存在しない。
- $ S $ は **特別** な集合である。

複数の解が存在する場合は、そのうちどれを出力してもよい。また、$ S $ の要素はどのような順番で出力してもよい。なお、与えられた制約の下で解が少なくとも一つ存在することが保証される。

## 说明/提示

### 制約

- $ 3\ \leq\ N\ \leq\ 20000 $

### Sample Explanation 1

$ \{2,\ 5,\ 63\} $ は特別です。なぜなら、$ gcd(2,\ 5\ +\ 63)\ =\ 2,\ gcd(5,\ 2\ +\ 63)\ =\ 5,\ gcd(63,\ 2\ +\ 5)\ =\ 7 $ であり、さらに $ gcd(2,\ 5,\ 63)\ =\ 1 $ であるため、すべての判定条件を満たすからです。 なお、$ \{2,\ 4,\ 6\} $ は解として認められません。$ gcd(2,\ 4,\ 6)\ =\ 2\ >\ 1 $ であるからです。

### Sample Explanation 2

$ \{2,\ 5,\ 20,\ 63\} $ は特別です。なぜなら、$ gcd(2,\ 5\ +\ 20\ +\ 63)\ =\ 2,\ gcd(5,\ 2\ +\ 20\ +\ 63)\ =\ 5,\ gcd(20,\ 2\ +\ 5\ +\ 63)\ =\ 10,\ gcd(63,\ 2\ +\ 5\ +\ 20)\ =\ 9 $ であり、さらに $ gcd(2,\ 5,\ 20,\ 63)\ =\ 1 $ であるため、すべての判定条件を満たすからです。

## 样例 #1

### 输入

```
3
```

### 输出

```
2 5 63
```

## 样例 #2

### 输入

```
4
```

### 输出

```
2 5 20 63
```



---

---
title: "[ARC124C] LCM of GCDs"
layout: "post"
diff: 普及+/提高
pid: AT_arc124_c
tag: ['数论', '枚举', '最大公约数 gcd']
---

# [ARC124C] LCM of GCDs

## 题目描述

[problemUrl]: https://atcoder.jp/contests/arc124/tasks/arc124_c

赤い袋と青い袋と $ N $ 個のカードパックがあります。はじめどちらの袋も空です。 それぞれのカードパックには整数が書かれた $ 2 $ 枚のカードが封入されており、$ i $ 番目のカードパックに入っているカードにはそれぞれ $ a_i,b_i $ が書かれていることがわかっています。

それぞれのカードパックについて、一方のカードを赤い袋に、他方のカードを青い袋に入れます。

カードを袋に入れ終えたのち、赤い袋に入ったカードに書かれた整数全体の最大公約数を $ X $ とします。 同様に、青い袋に入ったカードに書かれた整数全体の最大公約数を $ Y $ とします。 $ X $ と $ Y $ の最小公倍数の値が得点となります。

得点としてありうる値の最大値を求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ a_1 $ $ b_1 $ $ \vdots $ $ a_N $ $ b_N $

## 输出格式

得点としてありうる値の最大値を出力せよ。

## 说明/提示

### 制約

- 与えられる入力は全て整数
- $ 1\ \leq\ N\ \leq\ 50 $
- $ 1\ \leq\ a_i,\ b_i\ \leq\ 10^9 $

### Sample Explanation 1

\- $ 2 $ が書かれたカードを赤い袋に入れ、$ 15 $ が書かれたカードを青い袋に入れ、$ 6 $ が書かれたカードを赤い袋に入れ、$ 10 $ が書かれたカードを青い袋に入れるのが最適な入れ方の $ 1 $ つです。 - このとき、赤い袋に入ったカードに書かれた整数全体の最大公約数は $ 2 $、青い袋に入ったカードに書かれた整数全体の最大公約数は $ 5 $ です。 - このときの得点は $ 10 $ です。

## 样例 #1

### 输入

```
2

2 15

10 6
```

### 输出

```
10
```

## 样例 #2

### 输入

```
5

148834018 644854700

947642099 255192490

35137537 134714230

944287156 528403260

68656286 200621680
```

### 输出

```
238630
```

## 样例 #3

### 输入

```
20

557057460 31783488

843507940 794587200

640711140 620259584

1901220 499867584

190122000 41414848

349507610 620259584

890404700 609665088

392918800 211889920

507308870 722352000

156850650 498904448

806117280 862969856

193607570 992030080

660673950 422816704

622015810 563434560

207866720 316871744

63057130 117502592

482593010 366954816

605221700 705015552

702500790 900532160

171743540 353470912
```

### 输出

```
152594452160
```



---


---
title: "[ABC257F] Teleporter Setting"
layout: "post"
diff: 普及+/提高
pid: AT_abc257_f
tag: ['图论', '最短路']
---

# [ABC257F] Teleporter Setting

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc257/tasks/abc257_f

$ N $ 個の町と $ M $ 個のテレポーターがあり、 町は町 $ 1 $, 町 $ 2 $, $ \ldots $, 町$ N $ と番号づけられています。  
 それぞれのテレポーターは $ 2 $ つの町を双方向に結んでおり、テレポーターを使用する事によってその $ 2 $ つの町の間を $ 1 $ 分で移動することができます。

$ i $ 番目のテレポーターは町 $ U_i $ と町 $ V_i $ を双方向に結んでいますが、 いくつかのテレポーターについては結ぶ町の片方が決まっておらず、 $ U_i=0 $ のときそのテレポーターが結ぶ町の片方は町 $ V_i $ であるが、 もう片方が未定であることを意味します。

$ i=1,2,\ldots,N $ それぞれについて、次の問題を解いてください。

> 結ぶ町の片方が未定となっているテレポーターの結ぶ先をすべて町 $ i $ とする。 この時に町 $ 1 $ から町 $ N $ まで移動するのに最小で何分かかるか求めよ。 町 $ 1 $ から町 $ N $ までテレポーターのみを使って移動するのが不可能な場合は $ -1 $ を出力せよ。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ M $ $ U_1 $ $ V_1 $ $ U_2 $ $ V_2 $ $ \vdots $ $ U_M $ $ V_M $

## 输出格式

$ N $ 個の整数を空白区切りで出力せよ。 ここで、$ k $ 番目の整数は $ i=k $ とした時の問題に対する答えである.

## 说明/提示

### 制約

- $ 2\ \leq\ N\ \leq\ 3\times\ 10^5 $
- $ 1\leq\ M\leq\ 3\times\ 10^5 $
- $ 0\leq\ U_i\ <\ V_i\leq\ N $
- $ i\ \neq\ j $ ならば $ (U_i,V_i)\neq\ (U_j,V_j) $
- 入力は全て整数

### Sample Explanation 1

結ぶ先が未定となっているテレポーターの結び先を町 $ 1 $ としたとき、 $ 1 $ 番目と $ 2 $ 番目のテレポーターはともに町 $ 1 $ と町 $ 2 $ を結びます。 このとき、町 $ 1 $ から町 $ 3 $ への移動はできません。 結ぶ先が未定となっているテレポーターの結び先を町 $ 2 $ としたとき、 $ 1 $ 番目のテレポーターは町 $ 2 $ 同士を、 $ 2 $ 番目のテレポーターは町 $ 1 $ と町 $ 2 $ を結びます。 このときもやはり、町 $ 1 $ から町 $ 3 $ への移動はできません。 結ぶ先が未定となっているテレポーターの結び先を町 $ 3 $ としたとき、 $ 1 $ 番目のテレポーターは町 $ 3 $ と町 $ 2 $ を、 $ 2 $ 番目のテレポーターは町 $ 1 $ と町 $ 2 $ を結びます。 この時、次のようにして町 $ 1 $ から町 $ 3 $ へ $ 2 $ 分で移動できます。 - $ 2 $ 番目のテレポーターを使用し、町 $ 1 $ から町 $ 2 $ まで移動する。 - $ 1 $ 番目のテレポーターを使用し、町 $ 2 $ から町 $ 3 $ まで移動する。 よって、$ -1,-1,2 $ をこの順に出力します。 結ぶ先が未定となっているテレポーターの結び先によっては、 同じ町同士を結ぶテレポーターが存在する可能性や、 ある $ 2 $ つの町を結ぶテレポーターが複数存在する可能性がある事に注意してください。

## 样例 #1

### 输入

```
3 2

0 2

1 2
```

### 输出

```
-1 -1 2
```

## 样例 #2

### 输入

```
5 5

1 2

1 3

3 4

4 5

0 2
```

### 输出

```
3 3 3 3 2
```



---

---
title: "[ABC342E] Last Train"
layout: "post"
diff: 普及+/提高
pid: AT_abc342_e
tag: ['最短路']
---

# [ABC342E] Last Train

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc342/tasks/abc342_e

AtCoder 国には駅 $ 1, $ 駅 $ 2,\ldots, $ 駅 $ N $ の $ N $ 個の駅があります。

AtCoder 国に存在する電車の情報が $ M $ 個与えられます。 $ i $ 番目 $ (1\leq\ i\leq\ M) $ の情報は正整数の $ 6 $ つ組 $ (l\ _\ i,d\ _\ i,k\ _\ i,c\ _\ i,A\ _\ i,B\ _\ i) $ で表され、次のような情報に対応しています。

- $ t=l\ _\ i,l\ _\ i+d\ _\ i,l\ _\ i+2d\ _\ i,\ldots,l\ _\ i+(k\ _\ i-1)d\ _\ i $ それぞれについて、次のような電車が存在する。
  - 時刻 $ t $ に 駅 $ A\ _\ i $ を出発し、時刻 $ t+c\ _\ i $ に駅 $ B\ _\ i $ に到着する。

これらの情報にあてはまらない電車は存在せず、電車以外の方法である駅から異なる駅へ移動することはできません。  
また、乗り換えにかかる時間は無視できるとします。

駅 $ S $ から駅 $ N $ に到着できる最終時刻を $ f(S) $ とします。  
より厳密には、整数の $ 4 $ つ組の列 $ \big((t\ _\ i,c\ _\ i,A\ _\ i,B\ _\ i)\big)\ _\ {i=1,2,\ldots,k} $ であって、次のすべての条件を満たすものが存在するような $ t $ の最大値を $ f(S) $ とします。

- $ t\leq\ t\ _\ 1 $
- $ A\ _\ 1=S,B\ _\ k=N $
- すべての $ 1\leq\ i\lt\ k $ について、$ B\ _\ i=A\ _\ {i+1} $
- すべての $ 1\leq\ i\leq\ k $ について、時刻 $ t\ _\ i $ に駅 $ A\ _\ i $ を出発して時刻 $ t\ _\ i+c\ _\ i $ に駅 $ B\ _\ i $ に到着する電車が存在する。
- すべての $ 1\leq\ i\lt\ k $ について、$ t\ _\ i+c\ _\ i\leq\ t\ _\ {i+1} $

ただし、そのような $ t $ が存在しないとき $ f(S)=-\infty $ とします。

$ f(1),f(2),\ldots,f(N-1) $ を求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ M $ $ l\ _\ 1 $ $ d\ _\ 1 $ $ k\ _\ 1 $ $ c\ _\ 1 $ $ A\ _\ 1 $ $ B\ _\ 1 $ $ l\ _\ 2 $ $ d\ _\ 2 $ $ k\ _\ 2 $ $ c\ _\ 2 $ $ A\ _\ 2 $ $ B\ _\ 2 $ $ \vdots $ $ l\ _\ M $ $ d\ _\ M $ $ k\ _\ M $ $ c\ _\ M $ $ A\ _\ M $ $ B\ _\ M $

## 输出格式

$ N-1 $ 行出力せよ。 $ k $ 行目には $ f(k)\neq-\infty $ ならば $ f(k) $ を、$ f(k)=-\infty $ ならば `Unreachable` を出力せよ。

## 说明/提示

### 制約

- $ 2\leq\ N\leq2\times10\ ^\ 5 $
- $ 1\leq\ M\leq2\times10\ ^\ 5 $
- $ 1\leq\ l\ _\ i,d\ _\ i,k\ _\ i,c\ _\ i\leq10\ ^\ 9\ (1\leq\ i\leq\ M) $
- $ 1\leq\ A\ _\ i,B\ _\ i\leq\ N\ (1\leq\ i\leq\ M) $
- $ A\ _\ i\neq\ B\ _\ i\ (1\leq\ i\leq\ M) $
- 入力はすべて整数

### Sample Explanation 1

AtCoder 国に走っている電車は以下の図のようになります（発着時間の情報は図には含まれていません）。 !\[\](https://img.atcoder.jp/abc342/c3007f6fd6e6bffff5483312395e51f6.png) 駅 $ 2 $ から駅 $ 6 $ に到着できる最終時刻について考えます。 次の図のように、駅 $ 2 $ を時刻 $ 56 $ に出発して駅 $ 2\rightarrow $ 駅 $ 3\rightarrow $ 駅 $ 4\rightarrow $ 駅 $ 6 $ のように移動することで駅 $ 6 $ に到着することができます。 !\[\](https://img.atcoder.jp/abc342/bf9e3c0a042ef63f63e45fd5b94a23af.png) 駅 $ 2 $ を時刻 $ 56 $ より遅く出発して駅 $ 6 $ に到着することはできないため、$ f(2)=56 $ です。

### Sample Explanation 2

駅 $ 1 $ を時刻 $ 10\ ^\ {18} $ に出発して駅 $ 5 $ に時刻 $ 10\ ^\ {18}+10\ ^\ 9 $ に到着するような電車が存在します。それ以降に駅 $ 1 $ を出発する電車はないため、$ f(1)=10\ ^\ {18} $ です。 このように、答えが $ 32\operatorname{bit} $ 整数におさまらない場合もあります。 また、時刻 $ 14 $ に駅 $ 2 $ を出発して時刻 $ 20 $ に駅 $ 3 $ に到着するような電車は $ 2 $ 番目の情報と $ 3 $ 番目の情報の両方で存在が保証されています。 このように、複数の情報に重複している電車もあります。

## 样例 #1

### 输入

```
6 7
10 5 10 3 1 3
13 5 10 2 3 4
15 5 10 7 4 6
3 10 2 4 2 5
7 10 2 3 5 6
5 3 18 2 2 3
6 3 20 4 2 1
```

### 输出

```
55
56
58
60
17
```

## 样例 #2

### 输入

```
5 5
1000000000 1000000000 1000000000 1000000000 1 5
5 9 2 6 2 3
10 4 1 6 2 3
1 1 1 1 3 5
3 1 4 1 5 1
```

### 输出

```
1000000000000000000
Unreachable
1
Unreachable
```

## 样例 #3

### 输入

```
16 20
4018 9698 2850 3026 8 11
2310 7571 7732 1862 13 14
2440 2121 20 1849 11 16
2560 5115 190 3655 5 16
1936 6664 39 8822 4 16
7597 8325 20 7576 12 5
5396 1088 540 7765 15 1
3226 88 6988 2504 13 5
1838 7490 63 4098 8 3
1456 5042 4 2815 14 7
3762 6803 5054 6994 10 9
9526 6001 61 8025 7 8
5176 6747 107 3403 1 5
2014 5533 2031 8127 8 11
8102 5878 58 9548 9 10
3788 174 3088 5950 3 13
7778 5389 100 9003 10 15
556 9425 9458 109 3 11
5725 7937 10 3282 2 9
6951 7211 8590 1994 15 12
```

### 输出

```
720358
77158
540926
255168
969295
Unreachable
369586
466218
343148
541289
42739
165772
618082
16582
591828
```



---

---
title: "[ABC369E] Sightseeing Tour"
layout: "post"
diff: 普及+/提高
pid: AT_abc369_e
tag: ['最短路']
---

# [ABC369E] Sightseeing Tour

## 题目描述

#### 题目大意
给你一张 $N$ 个点，$M$ 条边的无向图（可能有重边）。第 $i$ 条边的端点是 $U_i$ 和 $V_i$，长度是 $T_i$。

给定 $Q$ 个询问，每个询问会给出 $K$ 条边。对于每个询问，请求出经过这 $K$ 条边（一定经过这 $K$ 条边，但是也可以经过其他的边）的 $1$ 到 $N$ 的最短路的长度。

## 输入格式

第一行是两个正整数 $N,M$。

接下来 $M$ 行，第 $i+1$ 行输入编号为 $i$ 的边：$U_i,V_i,T_i$。

接下来一行，输入询问的个数 $Q$。

接下来 $Q \times 2$ 行，每两行描述一个询问。
每个询问的第一行是给出的边的数量 $K_i$，第二行有 $K_i$ 个数：$B_{i,1}\space B_{i,2}\cdots B_{i,K_i}$，表示给出的边的编号。

## 输出格式

对于每个询问，输出一行一个整数表示你的答案。

## 说明/提示

- $2 \leq N \leq 400$
- $N-1 \leq M \leq 2 \times 10^5$
- $1 \leq U_i < V_i \leq N$
- $1 \leq T_i \leq 10^9$
- $1 \leq Q \leq 3000$
- $1 \leq K_i \leq 5$
- $1 \leq B_{i,1} < B_{i,2} < \cdots < B_{i,K_i} \leq M$
- 所有输入值都是整数。
- 这个图是连通图。

translate by @wujiawei36

## 样例 #1

### 输入

```
3 5

1 2 10

1 3 20

1 3 30

2 3 15

2 3 25

2

1

1

2

3 5
```

### 输出

```
25

70
```

## 样例 #2

### 输入

```
6 6

1 5 1

2 5 1

2 4 1

3 4 1

3 6 1

1 6 1

2

5

1 2 3 4 5

1

5
```

### 输出

```
5

3
```

## 样例 #3

### 输入

```
5 5

1 2 1000000000

2 3 1000000000

3 4 1000000000

4 5 1000000000

1 5 1000000000

1

1

3
```

### 输出

```
4000000000
```



---

---
title: "[ABC375F] Road Blocked"
layout: "post"
diff: 普及+/提高
pid: AT_abc375_f
tag: ['最短路']
---

# [ABC375F] Road Blocked

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc375/tasks/abc375_f

AtCoder国には $ 1 $ から $ N $ の番号がついた $ N $ 個の都市と、$ 1 $ から $ M $ の番号がついた $ M $ 本の道路があります。  
 道路 $ i $ は都市 $ A_i $ と都市 $ B_i $ を双方向に結び長さは $ C_i $ です。

$ Q $ 個のクエリが与えられるので順に処理してください。クエリは以下の $ 2 $ 種類のどちらかです。

- `1 i`：道路 $ i $ が通行止めとなる。
- `2 x y`：通行止めでない道路のみを通るときの都市 $ x $ から都市 $ y $ への最短距離を出力する。都市 $ x $ から都市 $ y $ に到達できないときは代わりに `-1` を出力する。
 
なお、$ 1 $ 種類目のクエリはテストケースごとに $ 300 $ 回以下であることが保証されます。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ M $ $ Q $ $ A_1 $ $ B_1 $ $ C_1 $ $ \vdots $ $ A_M $ $ B_M $ $ C_M $ $ \mathrm{query}_1 $ $ \vdots $ $ \mathrm{query}_Q $

各クエリは次の $ 2 $ 種類の形式のどちらかである。

> $ 1 $ $ i $

> $ 2 $ $ x $ $ y $

## 输出格式

クエリを順に処理せよ。

## 说明/提示

### 制約

- $ 2\ \leq\ N\ \leq\ 300 $
- $ 0\ \leq\ M\ \leq\ \frac{N(N-1)}{2} $
- $ 1\leq\ A_i\ <\ B_i\ \leq\ N $
- $ (A_i,B_i) $ は相異なる
- $ 1\ \leq\ C_i\ \leq\ 10^9 $
- $ 1\ \leq\ Q\ \leq\ 2\times\ 10^5 $
- $ 1 $ 種類目のクエリにおいて、$ 1\leq\ i\ \leq\ M $
- $ 1 $ 種類目のクエリにおいて与えられる道路は、その時点で通行止めでない
- $ 1 $ 種類目のクエリは $ 300 $ 回以下である
- $ 2 $ 種類目のクエリにおいて、$ 1\leq\ x\ <\ y\ \leq\ N $
- 入力は全て整数である
 
### Sample Explanation 1

\- $ 1 $ 番目のクエリでは、都市 $ 1 $ から都市 $ 3 $ への最短距離である $ 10 $ を出力します。 - $ 2 $ 番目のクエリにより、道路 $ 2 $ が通行止めとなりました。 - $ 3 $ 番目のクエリでは、都市 $ 1 $ から都市 $ 3 $ への最短距離である $ 11 $ を出力します。 - $ 4 $ 番目のクエリにより、道路 $ 1 $ が通行止めとなりました。 - $ 5 $ 番目のクエリでは、都市 $ 1 $ から都市 $ 3 $ には到達できないので、`-1` を出力します。

## 样例 #1

### 输入

```
3 3 5

1 2 5

1 3 10

2 3 6

2 1 3

1 2

2 1 3

1 1

2 1 3
```

### 输出

```
10

11

-1
```

## 样例 #2

### 输入

```
4 6 6

2 3 1

2 4 1

3 4 1

1 2 1

1 3 1

1 4 1

1 4

1 5

1 6

2 1 2

2 1 3

2 1 4
```

### 输出

```
-1

-1

-1
```



---

---
title: "[ABC395E] Flip Edge"
layout: "post"
diff: 普及+/提高
pid: AT_abc395_e
tag: ['最短路']
---

# [ABC395E] Flip Edge

## 题目描述

给定一个包含 $N$ 个顶点和 $M$ 条边的有向图。第 $i$ 条边（$1 \leq i \leq M$）从顶点 $u_i$ 指向顶点 $v_i$。

初始时，你位于顶点 $1$，需要通过重复以下操作到达顶点 $N$：

- 选择以下两种操作之一：
  - **移动操作**：从当前顶点沿边移动到相邻顶点，成本为 $1$。具体来说，设当前顶点为 $v$，选择一条从 $v$ 指向 $u$ 的边，移动到顶点 $u$。
  - **翻转操作**：反转所有边的方向，成本为 $X$。具体来说，在操作前存在的每条从 $v$ 到 $u$ 的边，在操作后将变为从 $u$ 到 $v$ 的边，反之亦然。

题目保证存在从顶点 $1$ 到顶点 $N$ 的操作序列。

请计算到达顶点 $N$ 所需的最小总成本。

## 输入格式

输入通过标准输入给出，格式如下：

> $N$ $M$ $X$  
> $u_1$ $v_1$  
> $u_2$ $v_2$  
> $\vdots$  
> $u_M$ $v_M$

## 输出格式

输出到达顶点 $N$ 的最小总成本。

## 说明/提示

### 约束条件
- $2 \leq N \leq 2 \times 10^5$
- $1 \leq M \leq 2 \times 10^5$
- $1 \leq X \leq 10^9$
- $1 \leq u_i \leq N$（$1 \leq i \leq M$）
- $1 \leq v_i \leq N$（$1 \leq i \leq M$）
- 输入均为整数

### 样例解释 1
给定图的示意图（图片链接略）。通过以下操作序列，总成本为 $4$：
- 花费 $1$ 移动到顶点 $2$
- 花费 $1$ 移动到顶点 $4$
- 花费 $1$ 移动到顶点 $3$
- 花费 $1$ 移动到顶点 $5$

无法以 $3$ 或更小的总成本到达顶点 $5$，因此输出 `4`。

### 样例解释 2
图的边与样例 1 相同，但翻转成本不同。通过以下操作序列，总成本为 $3$：
- 花费 $1$ 移动到顶点 $2$
- 花费 $1$ 执行翻转操作
- 花费 $1$ 移动到顶点 $5$

无法以 $2$ 或更小的总成本到达顶点 $5$，因此输出 `3`。

### 样例解释 3
答案可能超过 32 位整数范围，需注意处理大数。

翻译由 DeepSeek R1 完成

## 样例 #1

### 输入

```
5 6 5

1 2

2 4

3 1

3 5

4 3

5 2
```

### 输出

```
4
```

## 样例 #2

### 输入

```
5 6 1

1 2

2 4

3 1

3 5

4 3

5 2
```

### 输出

```
3
```

## 样例 #3

### 输入

```
8 7 613566756

2 1

2 3

4 3

4 5

6 5

6 7

8 7
```

### 输出

```
4294967299
```

## 样例 #4

### 输入

```
20 13 5

1 3

14 18

18 17

12 19

3 5

4 6

13 9

8 5

14 2

20 18

8 14

4 9

14 8
```

### 输出

```
21
```



---

---
title: "[ABC404G] Specified Range Sums"
layout: "post"
diff: 普及+/提高
pid: AT_abc404_g
tag: ['最短路', '差分约束']
---

# [ABC404G] Specified Range Sums

## 题目描述

给你一个整数 $N$ 和 $M$ 个整数三元组 $(L_i,R_i,S_i)$。

判断是否存在一个长度为 $N$ 的**正整数**数列 $A$，满足对于所有的三元组限制 $(L_i,R_i,S_i)$，满足 $\sum\limits_{j=L_i}^{R_i}A_j=S_i$。如果存在，找出合法的 $A$ 的最小元素和。

## 输入格式

第一行两个整数 $N,M(1\le N,M\le 4000)$。\
接下来 $M$ 行，每行三个整数 $L_i,R_i,S_i(1\le L_i\le R_i\le N,1\le S_i\le 10^9)$。

## 输出格式

如果不存在符合条件的 $A$，输出一个整数 $-1$。\
否则，输出一个整数，表示合法的 $A$ 的最小元素和。

## 说明/提示

**样例 1 解释**

$A=(1,3,2,1,5)$ 是一种符合条件的情况。\
此情况下 $A$ 的和是 $12$，可以证明这是可能的最小值。

**样例 2 解释**

此时无解。

By chenxi2009

## 样例 #1

### 输入

```
5 3

1 2 4

2 3 5

5 5 5
```

### 输出

```
12
```

## 样例 #2

### 输入

```
1 2

1 1 1

1 1 2
```

### 输出

```
-1
```

## 样例 #3

### 输入

```
9 6

8 9 8

3 6 18

2 4 19

5 6 8

3 5 14

1 3 26
```

### 输出

```
44
```



---

---
title: "指定区间和"
layout: "post"
diff: 普及+/提高
pid: AT_abc404_g
tag: ['最短路', '差分约束']
---

# 指定区间和

## 题目描述

给你一个整数 $N$ 和 $M$ 个整数三元组 $(L_i,R_i,S_i)$。

判断是否存在一个长度为 $N$ 的**正整数**数列 $A$，满足对于所有的三元组限制 $(L_i,R_i,S_i)$，满足 $\sum\limits_{j=L_i}^{R_i}A_j=S_i$。如果存在，找出合法的 $A$ 的最小元素和。

## 输入格式

第一行两个整数 $N,M(1\le N,M\le 4000)$。\
接下来 $M$ 行，每行三个整数 $L_i,R_i,S_i(1\le L_i\le R_i\le N,1\le S_i\le 10^9)$。

## 输出格式

如果不存在符合条件的 $A$，输出一个整数 $-1$。\
否则，输出一个整数，表示合法的 $A$ 的最小元素和。

## 说明/提示

**样例 1 解释**

$A=(1,3,2,1,5)$ 是一种符合条件的情况。\
此情况下 $A$ 的和是 $12$，可以证明这是可能的最小值。

**样例 2 解释**

此时无解。

By chenxi2009

## 样例 #1

### 输入

```
5 3

1 2 4

2 3 5

5 5 5
```

### 输出

```
12
```

## 样例 #2

### 输入

```
1 2

1 1 1

1 1 2
```

### 输出

```
-1
```

## 样例 #3

### 输入

```
9 6

8 9 8

3 6 18

2 4 19

5 6 8

3 5 14

1 3 26
```

### 输出

```
44
```



---

---
title: "[AGC039B] Graph Partition"
layout: "post"
diff: 普及+/提高
pid: AT_agc039_b
tag: ['最短路', '二分图']
---

# [AGC039B] Graph Partition

## 题目描述

给定一张 $N$ 个顶点，$M$ 条边的无向连通图。  
顶点以 $1\ldots N$ 编号，边以仅包含 $\texttt{0/1}$ 的邻接矩阵的形式给出。

请判断是否能够将顶点分为 $k$ 个非空集合 $V_1,\ldots,V_k$，使得其满足以下条件。若可以，则最大化 $k$：
 - 对于每条边 $(i,j)$，存在 $1 \le t \le k-1$ 满足 $i \in V_t, j \in V_{t+1}$ 或 $i \in V_{t+1}, j \in V_t$。

## 输入格式

第一行，一个正整数 $N$。  
以下 $N$ 行，每行一个长度为 $N$ 的 $\texttt{0/1}$ 串，表示邻接矩阵。

## 输出格式

如果无法找到一种划分方案满足上述条件，输出 $-1$。  
否则输出所有方案中最大的 $k$。

## 说明/提示

### 数据限制
- $N \in [2,200] \bigcap \mathbb Z$。
- 邻接矩阵仅由 $\texttt0$ 与 $\texttt1$ 组成。
- 邻接矩阵关于主对角线对称。
- 邻接矩阵主对角线均为 $\texttt0$（无自环）。
- 图一定连通。

#### 样例解释 #1
可以分别将顶点 $1,2$ 分入 $V_1,V_2$。

## 样例 #1

### 输入

```
2

01

10
```

### 输出

```
2
```

## 样例 #2

### 输入

```
3

011

101

110
```

### 输出

```
-1
```

## 样例 #3

### 输入

```
6

010110

101001

010100

101000

100000

010000
```

### 输出

```
4
```



---

---
title: "[AGC044B] Joker"
layout: "post"
diff: 普及+/提高
pid: AT_agc044_b
tag: ['最短路']
---

# [AGC044B] Joker

## 题目描述

[problemUrl]: https://atcoder.jp/contests/agc044/tasks/agc044_b

映画「ジョーカー」が今夜放映されるとあり、あなたの行きつけの劇場はすでに満席です。この劇場には $ N $ 席の座席からなる列が $ N $ 列あり、これらの席が $ N\times\ N $ の正方形型に並んでいます。最前列の観客に左から $ 1,\ 2,\dots,\ N $ の番号を、前から $ 2 $ 列目の観客に左から $ N+1,\ \dots,\ 2N $ の番号を付け、以降の観客にも同様に番号を付けます。最後列の観客の番号は、左から $ N^2-N+1,\dots,\ N^2 $ となります。

上映が終わると、観客は決まった順に劇場を出ます。$ i $ 番目に劇場を出るのは、番号 $ P_i $ の観客です。番号 $ P_{i+1} $ の観客は、番号 $ P_{i} $ の観客が劇場を出るまで待ってから移動します。劇場を出るには、席から席への移動を繰り返し、席からなる正方形型のエリアの外に出なければなりません (四辺のどこからでも出ることができます)。席から席への移動では、前後左右の $ 4 $ 方向への移動が可能です。

番号 $ x $ の観客が、劇場を出る際に番号 $ y $ の別の観客が **まだ座っている** 席を通り抜けてしまうと、番号 $ x $ の観客は番号 $ y $ の観客に永遠に嫌われます。各観客は、自分を永遠に嫌う観客の数が最小となるように移動方法を選びます。

番号 $ x $ の観客が番号 $ y $ の観客に永遠に嫌われるような組 $ (x,\ y) $ の個数を求めてください。

## 输入格式

入力は標準入力から以下の形式で与えられる。

> $ N $ $ P_1 $ $ P_2 $ $ \cdots $ $ P_{N^2} $

## 输出格式

問題文で述べたような観客の組 $ (x,\ y) $ が $ ans $ 組存在するとして、標準出力に以下の形式で出力せよ。

> $ ans $

## 说明/提示

### 制約

- $ 2\ \le\ N\ \le\ 500 $
- 列 $ P_1,\ P_2,\ \dots,\ P_{N^2} $ は $ \{1,\ 2,\ \dots,\ N^2\} $ の順列である。

### Sample Explanation 1

上映が終わる前の劇場内の観客の配置は以下の通りです。 ``` 1 2 3 4 5 6 7 8 9 ``` 劇場を出る最初の $ 4 $ 人 (番号 $ 1 $, $ 3 $, $ 7 $, $ 9 $ の観客) は席を通り抜けることなく劇場を出られるので、誰にも嫌われません。 その後、番号 $ 5 $ の観客は、劇場を出る際に番号 $ 2 $, $ 4 $, $ 6 $, $ 8 $ の観客が座る席のうちいずれかを通り抜けなければなりません。よって、番号 $ 5 $ の観客は上記の観客のうち少なくとも一人に嫌われます。 最後に残った $ 4 $ 人 (順に番号 $ 4 $, $ 8 $, $ 6 $, $ 2 $ の観客) は、人が座っている席を通り抜けずに劇場を出られます (そもそも、席を通り抜ける必要がありません)。

## 样例 #1

### 输入

```
3

1 3 7 9 5 4 8 6 2
```

### 输出

```
1
```

## 样例 #2

### 输入

```
4

6 7 1 4 13 16 10 9 5 11 12 14 15 2 3 8
```

### 输出

```
3
```

## 样例 #3

### 输入

```
6

11 21 35 22 7 36 27 34 8 20 15 13 16 1 24 3 2 17 26 9 18 32 31 23 19 14 4 25 10 29 28 33 12 6 5 30
```

### 输出

```
11
```



---

---
title: "[ARC061E] すぬけ君の地下鉄旅行"
layout: "post"
diff: 普及+/提高
pid: AT_arc061_c
tag: ['最短路']
---

# [ARC061E] すぬけ君の地下鉄旅行

## 题目描述

Snuke的城镇有地铁行驶，地铁线路图包括 $N$ 个站点和 $M$ 个地铁线。站点被从 $1$ 到 $N$ 的整数所标记，每条线路被一个公司所拥有，并且每个公司用彼此不同的整数来表示。

第 $i$ 条线路( $1≤i≤M$ )是直接连接 $p_i$ 与 $q_i$ 的双向铁路，中间不存在其他站点，且这条铁路由 $c_i$ 公司所拥有。

如果乘客只乘坐同一公司的铁路，他只需要花费一元，但如果更换其他公司的铁路需要再花一元。当然，如果你要再换回原来的公司，你还是要花一元。

Snuke在1号站的位置出发，他想通过地铁去第 $N$ 站，请求出最小钱数。如果无法到达第 $N$ 站，输出-1。

## 输入格式

第一行，输入 $N$ , $M$ 

接下来的 $M$ 行，输入 $p_i$   $q_i$   $c_i$ ，代表 $p_i$ 与 $q_i$ 中间有直接连接的双向边，且这条铁路由 $c_i$ 公司所拥有。

## 输出格式

输出最小钱数（若无法到达，输出-1）

感谢@SaltedHXJ 提供的翻译

## 样例 #1

### 输入

```
3 3

1 2 1

2 3 1

3 1 2
```

### 输出

```
1
```

## 样例 #2

### 输入

```
8 11

1 3 1

1 4 2

2 3 1

2 5 1

3 4 3

3 6 3

3 7 3

4 8 4

5 6 1

6 7 5

7 8 5
```

### 输出

```
2
```

## 样例 #3

### 输入

```
2 0
```

### 输出

```
-1
```



---


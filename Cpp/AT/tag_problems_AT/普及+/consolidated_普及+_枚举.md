---
title: "[ABC255E] Lucky Numbers"
layout: "post"
diff: 普及+/提高
pid: AT_abc255_e
tag: ['枚举']
---

# [ABC255E] Lucky Numbers

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc255/tasks/abc255_e

長さ $ N-1 $ の整数列 $ S\ =\ (S_1,\ S_2,\ \ldots,\ S_{N-1}) $ および、「ラッキーナンバー」として $ M $ 個の相異なる整数 $ X_1,\ X_2,\ \ldots,\ X_M $ が与えられます。

長さ $ N $ の整数列 $ A\ =\ (A_1,\ A_2,\ \ldots,\ A_N) $ であって、次の条件を満たすものを「良い数列」と呼びます。

> すべての $ i\ =\ 1,\ 2,\ \ldots,\ N-1 $ について、$ A_i\ +\ A_{i+1}\ =\ S_i $ が成り立つ。

良い数列 $ A $ を $ 1 $ つ選ぶときの、$ A $ の要素のうちラッキーナンバーであるものの個数（すなわち、$ A_i\ \in\ \lbrace\ X_1,\ X_2,\ \ldots,\ X_M\ \rbrace $ となる $ 1 $ 以上 $ N $ 以下の整数 $ i $ の個数）としてあり得る最大値を求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ M $ $ S_1 $ $ S_2 $ $ \ldots $ $ S_{N-1} $ $ X_1 $ $ X_2 $ $ \ldots $ $ X_M $

## 输出格式

良い数列 $ A $ を $ 1 $ つ選ぶときの、$ A $ の要素のうちラッキーナンバーであるものの個数としてありうる最大値を出力せよ。

## 说明/提示

### 制約

- $ 2\ \leq\ N\ \leq\ 10^5 $
- $ 1\ \leq\ M\ \leq\ 10 $
- $ -10^9\ \leq\ S_i\ \leq\ 10^9 $
- $ -10^9\ \leq\ X_i\ \leq\ 10^9 $
- $ X_1\ \lt\ X_2\ \lt\ \cdots\ \lt\ X_M $
- 入力はすべて整数

### Sample Explanation 1

良い数列 $ A $ として $ A\ =\ (3,\ -1,\ 4,\ -1,\ 5,\ -9,\ 2,\ -6,\ 5) $ を選ぶと、$ A $ の要素のうちラッキーナンバーであるものは $ A_2,\ A_4,\ A_5,\ A_9 $ の $ 4 $ 個となり、これが考えられる中で最大です。

## 样例 #1

### 输入

```
9 2

2 3 3 4 -4 -7 -4 -1

-1 5
```

### 输出

```
4
```

## 样例 #2

### 输入

```
20 10

-183260318 206417795 409343217 238245886 138964265 -415224774 -499400499 -313180261 283784093 498751662 668946791 965735441 382033304 177367159 31017484 27914238 757966050 878978971 73210901

-470019195 -379631053 -287722161 -231146414 -84796739 328710269 355719851 416979387 431167199 498905398
```

### 输出

```
8
```



---

---
title: "[ABC257E] Addition and Multiplication 2"
layout: "post"
diff: 普及+/提高
pid: AT_abc257_e
tag: ['贪心', '枚举']
---

# [ABC257E] Addition and Multiplication 2

## 题目描述

高桥君有一个整数 $x$ 。一开始的时候， $x=0$ 。

高桥君可以无限执行以下操作：

- 选择一个整数 $i$ （ $1 \leq i \leq 9$ ）。支付 $C_i$ 日元，把 $x$ 变为 $10x+i$ 。

高桥君有 $N$ 日元，问 $x$ 最大是多少？

### 约束 ###

$1 \leq N \leq 10^6$

$1 \leq C_i \leq N$

保证 $N,C_i$ 都是整数。

## 输入格式

输入数据按以下格式给出：

$N$

$C_1$ $C_2$ … $C_9$

## 输出格式

输出用不超过 $N$ 日元，最多可以使 $x$ 变为多少，并在末尾换行。

### 样例解释 ###

#### 样例1 ####

分别令 $i$ 为 $9$ 和 $5$ ， $x$ 将得到 $95$ 。一共花费 $C_9+C_5=5$ 日元，并未超过 $N$ ，符合要求。这是 $x$ 的最大值。

#### 样例2 ####

请注意，答案可能无法用 $64$ 位整数表示。

## 样例 #1

### 输入

```
5
5 4 3 3 2 5 3 5 3
```

### 输出

```
95
```

## 样例 #2

### 输入

```
20
1 1 1 1 1 1 1 1 1
```

### 输出

```
99999999999999999999
```



---

---
title: "[ABC312F] Cans and Openers"
layout: "post"
diff: 普及+/提高
pid: AT_abc312_f
tag: ['贪心', '枚举']
---

# [ABC312F] Cans and Openers

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc312/tasks/abc312_f

$ N $ 個の品物があります。  
 これらはそれぞれ、缶切りが不要な缶・缶切りが必要な缶・缶切りのいずれかです。  
 $ i $ 個目の品物は、整数の組 $ (T_i,\ X_i) $ により次のように表されます。

- $ T_i\ =\ 0 $ ならば、$ i $ 個目の品物は缶切りが不要な缶で、入手すると満足度 $ X_i $ を得る。
- $ T_i\ =\ 1 $ ならば、$ i $ 個目の品物は缶切りが必要な缶で、入手した上で缶切りを使うと満足度 $ X_i $ を得る。
- $ T_i\ =\ 2 $ ならば、$ i $ 個目の品物は缶切りで、$ X_i $ 個までの缶に対して使用できる。
 
$ N $ 個の品物から $ M $ 個を選んで入手するとき、得られる満足度の合計としてあり得る最大値を求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ M $ $ T_1 $ $ X_1 $ $ T_2 $ $ X_2 $ $ \vdots $ $ T_N $ $ X_N $

## 输出格式

答えを整数として出力せよ。

## 说明/提示

### 制約

- $ 1\ \leq\ M\ \leq\ N\ \leq\ 2\ \times\ 10^5 $
- $ T_i $ は $ 0,1,2 $ のいずれか
- $ 1\ \leq\ X_i\ \leq\ 10^9 $
- 入力される値はすべて整数
 
### Sample Explanation 1

$ 1,\ 2,\ 5,\ 7 $ 個目の品物を入手し、$ 7 $ 個目の品物である缶切りを $ 5 $ 個目の品物に対して使用すると、満足度 $ 6\ +\ 6\ +\ 15\ =\ 27 $ を得ます。 満足度が $ 28 $ 以上になる品物の入手方法は存在しませんが、上記の例において $ 7 $ 個目の品物のかわりに $ 6 $ 個目の品物や $ 8 $ 個目の品物を選んでも満足度 $ 27 $ を得ることができます。

## 样例 #1

### 输入

```
8 4

0 6

0 6

1 3

1 5

1 15

2 1

2 10

2 100
```

### 输出

```
27
```

## 样例 #2

### 输入

```
5 5

1 5

1 5

1 5

1 5

1 5
```

### 输出

```
0
```

## 样例 #3

### 输入

```
12 6

2 2

0 1

0 9

1 3

1 5

1 3

0 4

2 1

1 8

2 1

0 1

0 4
```

### 输出

```
30
```



---

---
title: "[ABC315D] Magical Cookies"
layout: "post"
diff: 普及+/提高
pid: AT_abc315_d
tag: ['模拟', '枚举']
---

# [ABC315D] Magical Cookies

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc315/tasks/abc315_d

$ H\ \times\ W $ 枚のクッキーが $ H $ 行 $ W $ 列に並んでいます。  
上から $ i $ 行目・左から $ j $ 列目のクッキーの色は英小文字 $ c_{i,j} $ で表されます。

これから、以下の手続きを行います。

1\. 各行に対して次の操作を行う : その行に $ 2 $ 枚以上のクッキーが残っており、それらの色がすべて同じならば、それらに印をつける。

2\. 各列に対して次の操作を行う : その列に $ 2 $ 枚以上のクッキーが残っており、それらの色がすべて同じならば、それらに印をつける。

3\. 印のついたクッキーがあればそれらをすべて取り除いて 1. に戻り、なければ手続きを終了する。

手続きを終了した時点で残っているクッキーの枚数を求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ H $ $ W $ $ c_{1,1} $$ c_{1,2} $ $ \ldots $ $ c_{1,W} $ $ c_{2,1} $$ c_{2,2} $ $ \ldots $ $ c_{2,W} $ $ \vdots $ $ c_{H,1} $$ c_{H,2} $ $ \ldots $ $ c_{H,W} $

## 输出格式

答えを出力せよ。

## 说明/提示

### 制約

- $ 2\ \leq\ H,\ W\ \leq\ 2000 $
- $ c_{i,j} $ は英小文字である

### Sample Explanation 1

以下で示す順で手続きを行います。 - 1. により、$ 1,\ 2 $ 行目のクッキーに印をつける。 - 2. により、$ 1 $ 列目のクッキーに印をつける。 - 3. により、印を付けたクッキーを取り除く。 この時点でクッキーは以下のようになっています。ただし、クッキーを取り除いた箇所は `.` で表しています。 ``` ... ... .bc .bd ``` - 1. により、何もしない。 - 2. により、$ 2 $ 列目のクッキーに印をつける。 - 3. により、印を付けたクッキーを取り除く。 この時点でクッキーは以下のようになっています。ただし、クッキーを取り除いた箇所は `.` で表しています。 ``` ... ... ..c ..d ``` - 1. により、何もしない。 - 2. により、何もしない。 - 3. により、印がついているクッキーが存在しないので手続きを終了する。 最終的に残っているクッキーの枚数は $ 2 $ 枚です。

## 样例 #1

### 输入

```
4 3
aaa
aaa
abc
abd
```

### 输出

```
2
```

## 样例 #2

### 输入

```
2 5
aaaaa
abcde
```

### 输出

```
4
```

## 样例 #3

### 输入

```
3 3
ooo
ooo
ooo
```

### 输出

```
0
```



---

---
title: "[ABC321E] Complete Binary Tree"
layout: "post"
diff: 普及+/提高
pid: AT_abc321_e
tag: ['枚举', '进制']
---

# [ABC321E] Complete Binary Tree

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc321/tasks/abc321_e

$ 1 $ から $ N $ までの番号が付けられた $ N $ 頂点からなる木があります。 各 $ i\ (2\ \leq\ i\ \leq\ N) $ について、頂点 $ i $ と頂点 $ \lfloor\ \frac{i}{2}\ \rfloor $ を結ぶ辺が張られています。 逆に、これら以外の辺は存在しません。

この木において、頂点 $ X $ との距離が $ K $ である頂点の数を求めてください。 ただし、$ 2 $ 頂点 $ u,v $ の距離は、頂点 $ u,v $ を結ぶ単純パスに含まれる辺の個数として定義されます。

$ T $ 個のテストケースが与えられるので、それぞれについて答えを求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。 ここで、$ \mathrm{test}_i $ は $ i $ 番目のテストケースを意味する。

> $ T $ $ \mathrm{test}_1 $ $ \mathrm{test}_2 $ $ \vdots $ $ \mathrm{test}_T $

各テストケースは以下の形式で与えられる。

> $ N $ $ X $ $ K $

## 输出格式

$ T $ 行出力せよ。

$ i\ (1\ \leq\ i\ \leq\ T) $ 行目には、$ i $ 番目のテストケースに対する答えを整数として出力せよ。

## 说明/提示

### 制約

- $ 1\leq\ T\ \leq\ 10^5 $
- $ 1\leq\ N\ \leq\ 10^{18} $
- $ 1\leq\ X\ \leq\ N $
- $ 0\leq\ K\ \leq\ N-1 $
- 入力は全て整数
 
### Sample Explanation 1

$ N=10 $ のとき、木は以下の図のようになります。 !\[\](https://img.atcoder.jp/abc321/0d1a718458ffcf25a6bc26d11b3a7641.png) このとき、 - 頂点 $ 2 $ との距離が $ 0 $ である頂点は $ 2 $ の $ 1 $ つです。 - 頂点 $ 2 $ との距離が $ 1 $ である頂点は $ 1,4,5 $ の $ 3 $ つです。 - 頂点 $ 2 $ との距離が $ 2 $ である頂点は $ 3,8,9,10 $ の $ 4 $ つです。 - 頂点 $ 2 $ との距離が $ 3 $ である頂点は $ 6,7 $ の $ 2 $ つです。 - 頂点 $ 2 $ との距離が $ 4 $ である頂点は存在しません。

## 样例 #1

### 输入

```
5

10 2 0

10 2 1

10 2 2

10 2 3

10 2 4
```

### 输出

```
1

3

4

2

0
```

## 样例 #2

### 输入

```
10

822981260158260522 52 20

760713016476190629 2314654 57

1312150450968417 1132551176249851 7

1000000000000000000 1083770654 79

234122432773361868 170290518806790 23

536187734191890310 61862 14

594688604155374934 53288633578 39

1000000000000000000 120160810 78

89013034180999835 14853481725739 94

463213054346948152 825589 73
```

### 输出

```
1556480

140703128616960

8

17732923532771328

65536

24576

2147483640

33776997205278720

7881299347898368

27021597764222976
```



---

---
title: "[ABC323F] Push and Carry"
layout: "post"
diff: 普及+/提高
pid: AT_abc323_f
tag: ['枚举', '分类讨论']
---

# [ABC323F] Push and Carry

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc323/tasks/abc323_f

座標平面上に高橋君と荷物があります。

高橋君は現在 $ (X_A,Y_A) $ におり、荷物は $ (X_B,Y_B) $ にあります。 高橋君は荷物を $ (X_C,Y_C) $ まで運びたいです。

高橋君は $ (x,y) $ にいるとき、$ 1 $ 回の行動で次のいずれかの動きをすることができます。

- $ (x+1,y) $ に移動する。移動前の時点で荷物が $ (x+1,y) $ にあった時、荷物を $ (x+2,y) $ に移動させる。
- $ (x-1,y) $ に移動する。移動前の時点で荷物が $ (x-1,y) $ にあった時、荷物を $ (x-2,y) $ に移動させる。
- $ (x,y+1) $ に移動する。移動前の時点で荷物が $ (x,y+1) $ にあった時、荷物を $ (x,y+2) $ に移動させる。
- $ (x,y-1) $ に移動する。移動前の時点で荷物が $ (x,y-1) $ にあった時、荷物を $ (x,y-2) $ に移動させる。

荷物を $ (X_C,Y_C) $ に移動させるまでに必要な最小の行動回数を求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ X_A $ $ Y_A $ $ X_B $ $ Y_B $ $ X_C $ $ Y_C $

## 输出格式

荷物を $ (X_C,Y_C) $ に移動させるまでに必要な最小の行動回数を出力せよ。

## 说明/提示

### 制約

- $ -10^{17}\leq\ X_A,Y_A,X_B,Y_B,X_C,Y_C\leq\ 10^{17} $
- $ (X_A,Y_A)\neq\ (X_B,Y_B) $
- $ (X_B,Y_B)\neq\ (X_C,Y_C) $
- 入力はすべて整数

### Sample Explanation 1

高橋君は次のように行動することで $ 9 $ 回で荷物を $ (0,5) $ に運ぶことができます。 - $ (2,2) $ へ移動する。 - $ (3,2) $ へ移動する。 - $ (3,3) $ へ移動する。荷物は $ (3,4) $ に移動する。 - $ (3,4) $ へ移動する。荷物は $ (3,5) $ に移動する。 - $ (4,4) $ へ移動する。 - $ (4,5) $ へ移動する。 - $ (3,5) $ へ移動する。荷物は $ (2,5) $ に移動する。 - $ (2,5) $ へ移動する。荷物は $ (1,5) $ に移動する。 - $ (1,5) $ へ移動する。荷物は $ (0,5) $ に移動する。 $ 8 $ 回以下で荷物を $ (0,5) $ に運ぶことができないので、$ 9 $ を出力します。

## 样例 #1

### 输入

```
1 2 3 3 0 5
```

### 输出

```
9
```

## 样例 #2

### 输入

```
0 0 1 0 -1 0
```

### 输出

```
6
```

## 样例 #3

### 输入

```
-100000000000000000 -100000000000000000 100000000000000000 100000000000000000 -100000000000000000 -100000000000000000
```

### 输出

```
800000000000000003
```



---

---
title: "[ABC343E] 7x7x7"
layout: "post"
diff: 普及+/提高
pid: AT_abc343_e
tag: ['数学', '枚举']
---

# [ABC343E] 7x7x7

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc343/tasks/abc343_e

> 座標空間上に一辺 $ 7 $ の立方体を $ 3 $ つ、ちょうど $ 1,2,3 $ 個の立方体に含まれる領域の体積がそれぞれ $ V_1,V_2,V_3 $ となるように配置したいです。

$ 3 $ つの整数 $ a,b,c $ に対し、$ (a\leq\ x\leq\ a+7)\ \land\ (b\leq\ y\leq\ b+7)\ \land\ (c\leq\ z\leq\ c+7) $ で表される立方体領域を $ C(a,b,c) $ とおきます。

以下の条件を全て満たすような $ 9 $ つの整数 $ a_1,b_1,c_1,a_2,b_2,c_2,a_3,b_3,c_3 $ が存在するか判定し、存在するならば実際に $ 1 $ つ求めてください。

- $ |a_1|,|b_1|,|c_1|,|a_2|,|b_2|,|c_2|,|a_3|,|b_3|,|c_3|\ \leq\ 100 $
- $ C_i\ =\ C(a_i,b_i,c_i)\ (i=1,2,3) $ とおいたとき、
  - $ C_1,C_2,C_3 $ のうちちょうど $ 1 $ 個に含まれる領域の体積は $ V_1 $ である。
  - $ C_1,C_2,C_3 $ のうちちょうど $ 2 $ 個に含まれる領域の体積は $ V_2 $ である。
  - $ C_1,C_2,C_3 $ の全てに含まれる領域の体積は $ V_3 $ である。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ V_1 $ $ V_2 $ $ V_3 $

## 输出格式

問題文中の条件を全て満たすような $ 9 $ つの整数 $ a_1,b_1,c_1,a_2,b_2,c_2,a_3,b_3,c_3 $ が存在しないならば `No` を出力し、存在するならば以下の形式で出力せよ。 複数存在する場合はそのどれを出力してもよい。

> Yes $ a_1 $ $ b_1 $ $ c_1 $ $ a_2 $ $ b_2 $ $ c_2 $ $ a_3 $ $ b_3 $ $ c_3 $

## 说明/提示

### 制約

- $ 0\leq\ V_1,V_2,V_3\ \leq\ 3\times\ 7^3 $
- 入力は全て整数

### Sample Explanation 1

$ (a_1,b_1,c_1,a_2,b_2,c_2,a_3,b_3,c_3)=(0,0,0,0,6,0,6,0,0) $ の場合を考えます。 !\[\](https://img.atcoder.jp/abc343/aa534bf0a0e8e3f3487c5eeb540e54dc.png) この図は $ C_1,C_2,C_3 $ の位置関係を表したもので、それぞれ橙、水色、緑の立方体に対応しています。 このとき、 - $ |a_1|,|b_1|,|c_1|,|a_2|,|b_2|,|c_2|,|a_3|,|b_3|,|c_3| $ は全て $ 100 $ 以下 - $ C_1,C_2,C_3 $ の全てに含まれる領域は $ (6\leq\ x\leq\ 7)\land\ (6\leq\ y\leq\ 7)\ \land\ (0\leq\ z\leq\ 7) $ であり、その体積は $ (7-6)\times(7-6)\times(7-0)=7 $ - $ C_1,C_2,C_3 $ のうちちょうど $ 2 $ 個に含まれる領域は $ ((0\leq\ x\ <\ 6)\land\ (6\leq\ y\leq\ 7)\ \land\ (0\leq\ z\leq\ 7))\lor((6\leq\ x\leq\ 7)\land\ (0\leq\ y\ <\ 6)\ \land\ (0\leq\ z\leq\ 7)) $ であり、 その体積は $ (6-0)\times(7-6)\times(7-0)\times\ 2=84 $ - $ C_1,C_2,C_3 $ のうちちょうど $ 1 $ 個に含まれる領域の体積は $ 840 $ であり、条件を全て満たします。 $ (a_1,b_1,c_1,a_2,b_2,c_2,a_3,b_3,c_3)=(-10,\ 0,\ 0,\ -10,\ 0,\ 6,\ -10,\ 6,\ 1) $ なども同様に条件を全て満たすため、正当な出力として判定されます。

### Sample Explanation 2

条件を全て満たすような $ 9 $ つの整数 $ a_1,b_1,c_1,a_2,b_2,c_2,a_3,b_3,c_3 $ は存在しません。

## 样例 #1

### 输入

```
840 84 7
```

### 输出

```
Yes
0 0 0 0 6 0 6 0 0
```

## 样例 #2

### 输入

```
343 34 3
```

### 输出

```
No
```



---

---
title: "[ABC361F] x = a^b"
layout: "post"
diff: 普及+/提高
pid: AT_abc361_f
tag: ['数学', '枚举']
---

# [ABC361F] x = a^b

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc361/tasks/abc361_f

$ 1 $ 以上 $ N $ 以下の正整数 $ x $ であって、ある正整数 $ a $ と **$ 2 $ 以上の** 正整数 $ b $ を用いて $ x=a^b $ と表現できるものはいくつありますか？

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $

## 输出格式

答えを整数として出力せよ。

## 说明/提示

### 制約

- 入力は全て整数
- $ 1\ \le\ N\ \le\ 10^{18} $
 
### Sample Explanation 1

問題文中の条件を満たす整数は $ 1,4,8,9,16,25,27,32,36,49,64,81 $ の $ 12 $ 個です。

## 样例 #1

### 输入

```
99
```

### 输出

```
12
```

## 样例 #2

### 输入

```
1000000000000000000
```

### 输出

```
1001003332
```



---

---
title: "[ABC409F] Connecting Points"
layout: "post"
diff: 普及+/提高
pid: AT_abc409_f
tag: ['并查集', '枚举']
---

# [ABC409F] Connecting Points

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc409/tasks/abc409_f

在二维平面上有一个初始为 $N$ 个顶点、$0$ 条边的图 $G$。顶点编号为 $1$ 到 $N$，顶点 $i$ 的坐标为 $(x_i,y_i)$。

对于图 $G$ 中的顶点 $u$ 和 $v$，定义它们之间的距离 $d(u,v)$ 为曼哈顿距离：$d(u,v)=|x_u-x_v|+|y_u-y_v|$。

对于图 $G$ 的两个连通分量 $A$ 和 $B$，设它们的顶点集合分别为 $V(A)$ 和 $V(B)$，则定义 $A$ 和 $B$ 之间的距离 $d(A,B)$ 为：$d(A,B)=\min\lbrace d(u,v) \mid u \in V(A), v \in V(B) \rbrace$。

请处理以下 $Q$ 个查询，查询分为三种类型：

1. `1 a b`：设当前图 $G$ 的顶点数为 $n$，在坐标 $(a,b)$ 处新增顶点 $n+1$，并将其加入图 $G$。
2. `2`：设当前图 $G$ 的顶点数为 $n$，连通分量数为 $m$：
   - 若 $m=1$，输出 `-1`。
   - 若 $m \geq 2$，找到距离最小的连通分量对，并将它们合并（即在这些连通分量之间添加边，使得所有距离等于最小值的顶点对相连），然后输出该最小距离值。
3. `3 u v`：若顶点 $u$ 和 $v$ 属于同一连通分量，输出 `Yes`；否则输出 `No`。

## 输入格式

输入通过标准输入给出，格式如下：

> $N$ $Q$  
> $x_1$ $y_1$  
> $x_2$ $y_2$  
> $\vdots$  
> $x_N$ $y_N$  
> $\mathrm{query}_1$  
> $\mathrm{query}_2$  
> $\vdots$  
> $\mathrm{query}_Q$

每个查询为以下三种形式之一：

> $1$ $a$ $b$  
> $2$  
> $3$ $u$ $v$

## 输出格式

按照题目要求输出每个查询的结果，每个结果占一行。

## 说明/提示

### 约束条件

- $2 \leq N \leq 1500$
- $1 \leq Q \leq 1500$
- $0 \leq x_i, y_i \leq 10^9$
- 对于类型 `1` 的查询，$0 \leq a, b \leq 10^9$
- 对于类型 `3` 的查询，设处理该查询前图 $G$ 的顶点数为 $n$，则 $1 \leq u < v \leq n$
- 输入均为整数

### 样例解释 1

初始时，顶点 $1,2,3,4$ 的坐标分别为 $(3,4),(3,3),(7,3),(2,2)$。  
- 第 1 个查询：顶点 $1$ 和 $2$ 不连通，输出 `No`。  
- 第 2 个查询：有 4 个连通分量（$\lbrace 1 \rbrace, \lbrace 2 \rbrace, \lbrace 3 \rbrace, \lbrace 4 \rbrace$），最小距离为 $1$（顶点 $1$ 和 $2$ 之间），合并后输出 $1$。  
- 第 3 个查询：顶点 $1$ 和 $2$ 已连通，输出 `Yes`。  
- 第 4 个查询：新增顶点 $5$，坐标为 $(6,4)$。  
- 第 5 个查询：最小距离为 $2$（顶点 $2$ 和 $4$、顶点 $3$ 和 $5$ 之间），合并后输出 $2$。  
- 第 6 个查询：顶点 $2$ 和 $5$ 不连通，输出 `No`。  
- 第 7 个查询：最小距离为 $3$（顶点 $1$ 和 $5$ 之间），合并后输出 $3$。  
- 第 8 个查询：顶点 $2$ 和 $5$ 已连通，输出 `Yes`。  
- 第 9 个查询：所有顶点连通，输出 `-1`。  
- 第 10 个查询：新增顶点 $6$，坐标为 $(2,2)$。  
- 第 11 个查询：最小距离为 $0$（顶点 $4$ 和 $6$ 之间），合并后输出 $0$。

翻译由 DeepSeek V3 完成

## 样例 #1

### 输入

```
4 11
3 4
3 3
7 3
2 2
3 1 2
2
3 1 2
1 6 4
2
3 2 5
2
3 2 5
2
1 2 2
2
```

### 输出

```
No
1
Yes
2
No
3
Yes
-1
0
```



---

---
title: "[ABC410F] Balanced Rectangles"
layout: "post"
diff: 普及+/提高
pid: AT_abc410_f
tag: ['枚举', '前缀和', '根号分治']
---

# [ABC410F] Balanced Rectangles

## 题目描述

给你一个 $H\times W$ 的网格 $S$，仅由 `#` 和 `.` 组成。

求其中有多少个矩形区域，其中 `#` 和 `.` 的个数相等。

形式化地，求满足以下条件的整数四元组 $(u,d,l,r)$ 的个数：
- $1\le u\le d\le H$
- $1\le l\le r\le W$
- $\sum\limits_{i=u}^d\sum\limits_{j=l}^r[S_{i,j}=$`#`$]=\sum\limits_{i=u}^d\sum\limits_{j=l}^r[S_{i,j}=$`.`$]$

## 输入格式

多组数据。第一行一个整数 $T(1\le T\le 2.5\times 10^4)$，表示数据组数。

对于每组数据：\
第一行两个整数 $H,W$。\
接下来 $H$ 行，每行一个长为 $W$ 的，由 `#` 和 `.` 组成的字符串 $S_i$。

保证单个测试点中，$\sum (HW)\le 3\times 10^5$。

## 输出格式

对于每组数据，输出一行一个整数表示答案。

## 说明/提示

**样例解释**

样例包含三组测试数据。

对于第一组数据，满足条件的 $4$ 个四元组如下：
- $(1,2,2,2)$
- $(2,3,1,1)$
- $(2,2,1,2)$
- $(1,3,1,2)$

By @[chenxi2009](/user/1020063)

## 样例 #1

### 输入

```
3
3 2
##
#.
..
6 6
..#...
..#..#
#.#.#.
.###..
######
.###..
15 50
.......................#...........###.###.###.###
....................#..#..#..........#.#.#...#.#..
.................#...#####...#.....###.#.#.###.###
..................#..##.##..#......#...#.#.#.....#
...................#########.......###.###.###.###
....................#.....#.......................
.###........##......#.....#..#...#.####.####.##..#
#..#.........#......#.....#..#...#.#....#....##..#
#..#.........#......#.....#..#...#.#....#....##..#
#.....##...###..##..#.....#..#...#.#....#....#.#.#
#....#..#.#..#.#..#.#..##.#..#...#.####.####.#.#.#
#....#..#.#..#.####.#....##..#...#.#....#....#.#.#
#....#..#.#..#.#....#.....#..#...#.#....#....#..##
#..#.#..#.#..#.#..#.#....#.#.#...#.#....#....#..##
.##...##...####.##...####..#..###..####.####.#..##
```

### 输出

```
4
79
4032
```



---

---
title: "[AGC001C] Shorten Diameter"
layout: "post"
diff: 普及+/提高
pid: AT_agc001_c
tag: ['枚举', '树的直径']
---

# [AGC001C] Shorten Diameter

## 题目描述

给你一棵 $N$ 个点的无向树，定义点 $u$ 和 $v$ 之间的距离是从 $u$ 到 $v$ 的简单路径上的边数。

你需要删除一些点，使树的直径小于等于 $K$，当且仅当删除某点不会对树的联通性产生影响时才可以删除。问至少删除多少点才可以满足要求。

## 输入格式

>
>第一行两个个整数 $N, K$。
>
>之后 $N - 1$ 行描述一棵树。
>

## 输出格式

>
>一个整数，表示最少删掉点的个数。

感谢 @ToBiChi 提供翻译

## 说明/提示

$2≤N≤2000$，$1≤K≤N-1$，保证给出的图是一棵树。

## 样例 #1

### 输入

```
6 2

1 2

3 2

4 2

1 6

5 6
```

### 输出

```
2
```

## 样例 #2

### 输入

```
6 5

1 2

3 2

4 2

1 6

5 6
```

### 输出

```
0
```



---

---
title: "[AGC005B] Minimum Sum"
layout: "post"
diff: 普及+/提高
pid: AT_agc005_b
tag: ['线段树', '枚举', '单调栈']
---

# [AGC005B] Minimum Sum

## 题目描述

[problemUrl]: https://atcoder.jp/contests/agc005/tasks/agc005_b

すぬけ君はある日友人から長さ $ N $ の順列 $ a_1,\ a_2,\ ...,\ a_N $ を貰いました。

![](https://cdn.luogu.com.cn/upload/vjudge_pic/AT_agc005_b/7385c80af4629f5f6d11fed58e1b38d3c006d06d.png)

を求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ a_1 $ $ a_2 $ $ ... $ $ a_N $

## 输出格式

$ 1 $ 行に答えを出力する。

なお、32bit整数型に答えが収まるとは限らないことに注意すること。

## 说明/提示

### 制約

- $ 1\ ≦\ N\ ≦\ 200,000 $
- $ (a_1,\ a_2,\ ...,\ a_N) $ は $ (1,\ 2,\ ...,\ N) $ を並び替えたものである

## 样例 #1

### 输入

```
3

2 1 3
```

### 输出

```
9
```

## 样例 #2

### 输入

```
4

1 3 2 4
```

### 输出

```
19
```

## 样例 #3

### 输入

```
8

5 4 8 1 2 6 7 3
```

### 输出

```
85
```



---

---
title: "[ARC121C] Odd Even Sort"
layout: "post"
diff: 普及+/提高
pid: AT_arc121_c
tag: ['贪心', '枚举', '排序', '构造']
---

# [ARC121C] Odd Even Sort

## 题目描述

[problemUrl]: https://atcoder.jp/contests/arc121/tasks/arc121_c

$ (1,2,\ \ldots,\ N) $ を並び替えた数列 $ p $ が与えられます。 はじめ、$ p $ の第 $ n $ 項は $ p_{n} $ です。

あなたの目的は $ N^2 $ 回以下 *操作* を行い $ p $ を昇順に並び替えることです。 あなたは操作により以下のように $ p $ を変更することができます。

- **奇数** 回目の操作では $ 1 $ 以上 $ N-1 $ 以下の **奇数** $ n $ を選んで $ p_n $ と $ p_{n+1} $ を入れ替えます。
- **偶数** 回目の操作では $ 2 $ 以上 $ N-1 $ 以下の **偶数** $ n $ を選んで $ p_n $ と $ p_{n+1} $ を入れ替えます。

この問題の制約下で必ず目的を達成できることが証明できます。 そのような操作列を $ 1 $ つ求めてください。

$ T $ 個のテストケースが与えられるのでそれぞれについて答えを求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ T $ $ \mathrm{case}_{1} $ $ \vdots $ $ \mathrm{case}_{T} $

各テストケースは以下の形式で与えられる。

> $ N $ $ p_1 $ $ \cdots $ $ p_N $

## 输出格式

$ T $ 個のテストケースについて与えられた順番に以下の形式で答えを出力せよ。

> $ M $ $ a_1 $ $ \cdots $ $ a_M $

$ M $ は操作列の長さを表し、$ a_i $ は $ i $ 回目の操作で選んだ整数を表す。

全てのテストケースにおいて目的が達成される操作列が出力されたならば正解となる。

## 说明/提示

### 制約

- 与えられる入力は全て整数
- $ 1\ \leq\ T\ \leq\ 250 $
- $ 2\ \leq\ N\ \leq\ 500 $
- $ 1\ \leq\ p_i\ \leq\ N $
- $ p $ は $ (1,2,\ldots,N) $ を並び替えて得られる。
- $ 1 $ つの入力ファイルにおいて $ N $ の総和は $ 500 $ を超えない。

### Sample Explanation 1

\- $ 1 $ つ目のテストケースについて説明します。 - $ 1 $ 回目の操作で $ 1 $ を選ぶと $ p $ は $ (1,2,3,5,4) $ となります。 - $ 2 $ 回目の操作で $ 4 $ を選ぶと $ p $ は $ (1,2,3,4,5) $ となります。 - $ (1,4) $ は操作列として正しいですが、$ (4,1) $ は操作列として正しくないことに注意してください。 - 操作を $ 1 $ 度も行わなくともよいこと、操作回数を最小にする必要はないことに注意してください。

## 样例 #1

### 输入

```
2

5

2 1 3 5 4

2

1 2
```

### 输出

```
2

1 4

0
```



---

---
title: "[ARC124C] LCM of GCDs"
layout: "post"
diff: 普及+/提高
pid: AT_arc124_c
tag: ['数论', '枚举', '最大公约数 gcd']
---

# [ARC124C] LCM of GCDs

## 题目描述

[problemUrl]: https://atcoder.jp/contests/arc124/tasks/arc124_c

赤い袋と青い袋と $ N $ 個のカードパックがあります。はじめどちらの袋も空です。 それぞれのカードパックには整数が書かれた $ 2 $ 枚のカードが封入されており、$ i $ 番目のカードパックに入っているカードにはそれぞれ $ a_i,b_i $ が書かれていることがわかっています。

それぞれのカードパックについて、一方のカードを赤い袋に、他方のカードを青い袋に入れます。

カードを袋に入れ終えたのち、赤い袋に入ったカードに書かれた整数全体の最大公約数を $ X $ とします。 同様に、青い袋に入ったカードに書かれた整数全体の最大公約数を $ Y $ とします。 $ X $ と $ Y $ の最小公倍数の値が得点となります。

得点としてありうる値の最大値を求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ a_1 $ $ b_1 $ $ \vdots $ $ a_N $ $ b_N $

## 输出格式

得点としてありうる値の最大値を出力せよ。

## 说明/提示

### 制約

- 与えられる入力は全て整数
- $ 1\ \leq\ N\ \leq\ 50 $
- $ 1\ \leq\ a_i,\ b_i\ \leq\ 10^9 $

### Sample Explanation 1

\- $ 2 $ が書かれたカードを赤い袋に入れ、$ 15 $ が書かれたカードを青い袋に入れ、$ 6 $ が書かれたカードを赤い袋に入れ、$ 10 $ が書かれたカードを青い袋に入れるのが最適な入れ方の $ 1 $ つです。 - このとき、赤い袋に入ったカードに書かれた整数全体の最大公約数は $ 2 $、青い袋に入ったカードに書かれた整数全体の最大公約数は $ 5 $ です。 - このときの得点は $ 10 $ です。

## 样例 #1

### 输入

```
2

2 15

10 6
```

### 输出

```
10
```

## 样例 #2

### 输入

```
5

148834018 644854700

947642099 255192490

35137537 134714230

944287156 528403260

68656286 200621680
```

### 输出

```
238630
```

## 样例 #3

### 输入

```
20

557057460 31783488

843507940 794587200

640711140 620259584

1901220 499867584

190122000 41414848

349507610 620259584

890404700 609665088

392918800 211889920

507308870 722352000

156850650 498904448

806117280 862969856

193607570 992030080

660673950 422816704

622015810 563434560

207866720 316871744

63057130 117502592

482593010 366954816

605221700 705015552

702500790 900532160

171743540 353470912
```

### 输出

```
152594452160
```



---

---
title: "[ARC130C] Digit Sum Minimization"
layout: "post"
diff: 普及+/提高
pid: AT_arc130_c
tag: ['贪心', '枚举', '分类讨论']
---

# [ARC130C] Digit Sum Minimization

## 题目描述

[problemUrl]: https://atcoder.jp/contests/arc130/tasks/arc130_c

正の整数 $ a,\ b $ が与えられます。ただし、$ a,\ b $ のどの桁も $ 0 $ ではありません。

$ a+b $ の各桁の和が最小になるように、$ a $, $ b $ のそれぞれの桁を並べ替えてください。

## 输入格式

入力は以下の形式で標準入力から与えられます。

> $ a $ $ b $

## 输出格式

$ a+b $ の各桁の和が最小になるように $ a $, $ b $ のそれぞれの桁を並べ替えて、$ 1 $ 行目に $ a $ を、$ 2 $ 行目に $ b $ を出力してください。

答が複数考えられる場合には、そのどれを出力しても正解となります。

## 说明/提示

### 制約

- $ 1\leq\ a,\ b\ <\ 10^{100000} $
- $ a,\ b $ のどの桁も $ 0 $ ではない

### Sample Explanation 1

$ 532\ +\ 268\ =\ 800 $ で、その各桁の和は $ 8+0+0=8 $ となります。 他にも、$ (a,\ b)\ =\ (325,\ 682) $ を出力しても正解となります。

### Sample Explanation 2

$ 435+565=1000 $ で、その各桁の和は $ 1+0+0+0=1 $ となります。

### Sample Explanation 3

$ 312\ +\ 799788\ =\ 800100 $ で、その各桁の和は $ 8+0+0+1+0+0=9 $ となります。

## 样例 #1

### 输入

```
253

286
```

### 输出

```
532

268
```

## 样例 #2

### 输入

```
345

556
```

### 输出

```
435

565
```

## 样例 #3

### 输入

```
123

987987
```

### 输出

```
312

799788
```

## 样例 #4

### 输入

```
11111111111111111111

111111111111111111111111111111
```

### 输出

```
11111111111111111111

111111111111111111111111111111
```



---


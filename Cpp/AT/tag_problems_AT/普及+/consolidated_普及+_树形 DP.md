---
title: "[ABC348E] Minimize Sum of Distances"
layout: "post"
diff: 普及+/提高
pid: AT_abc348_e
tag: ['树形 DP']
---

# [ABC348E] Minimize Sum of Distances

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc348/tasks/abc348_e

$ N $ 頂点からなる木が与えられます。頂点は $ 1 $ から $ N $ までの番号がついており、 $ i $ 番目の辺は頂点 $ A_i,\ B_i $ を結んでいます。

長さ $ N $ の正整数列 $ C\ =\ (C_1,\ C_2,\ \ldots\ ,C_N) $ が与えられます。$ d(a,\ b) $ を頂点 $ a,\ b $ の間にある辺の数とし、 $ x\ =\ 1,\ 2,\ \ldots\ ,N $ に対して $ \displaystyle\ f(x)\ =\ \sum_{i=1}^{N}\ (C_i\ \times\ d(x,\ i)) $ とします。$ \displaystyle\ \min_{1\ \leq\ v\ \leq\ N}\ f(v) $ を求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ A_1 $ $ B_1 $ $ A_2 $ $ B_2 $ $ \vdots $ $ A_{N\ -\ 1} $ $ B_{N\ -\ 1} $ $ C_1 $ $ C_2 $ $ \cdots $ $ C_N $

## 输出格式

答えを一行に出力せよ。

## 说明/提示

### 制約

- $ 1\ \leq\ N\ \leq\ 10^5 $
- $ 1\ \leq\ A_i,\ B_i\ \leq\ N $
- 与えられるグラフは木である。
- $ 1\ \leq\ C_i\ \leq\ 10^9 $

### Sample Explanation 1

例として、 $ f(1) $ を求めることを考えます。$ d(1,\ 1)\ =\ 0,\ d(1,\ 2)\ =\ 1,\ d(1,\ 3)\ =\ 1,\ d(1,\ 4)\ =\ 2 $ です。 よって、 $ f(1)\ =\ 0\ \times\ 1\ +\ 1\ \times\ 1\ +\ 1\ \times\ 1\ +\ 2\ \times\ 2\ =\ 6 $ となります。 同様に、 $ f(2)\ =\ 5,\ f(3)\ =\ 9,\ f(4)\ =\ 6 $ です。$ f(2) $ が最小なので `5` を出力します。

### Sample Explanation 2

$ f(2)\ =\ 1 $ で、これが最小です。

## 样例 #1

### 输入

```
4
1 2
1 3
2 4
1 1 1 2
```

### 输出

```
5
```

## 样例 #2

### 输入

```
2
2 1
1 1000000000
```

### 输出

```
1
```

## 样例 #3

### 输入

```
7
7 3
2 5
2 4
3 1
3 6
2 1
2 7 6 9 3 4 6
```

### 输出

```
56
```



---

---
title: "[ABC394F] Alkane"
layout: "post"
diff: 普及+/提高
pid: AT_abc394_f
tag: ['树形 DP', '树的遍历']
---

# [ABC394F] Alkane

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc394/tasks/abc394_f

给定一棵包含 $N$ 个顶点的无向树 $T$。顶点编号为 $1, 2, \ldots, N$，第 $i$ 条边连接顶点 $A_i$ 和顶点 $B_i$。

定义满足以下两个条件的图为**烷烃**：
- 该图是一棵无向树
- 所有顶点的度数为 $1$ 或 $4$，且至少存在一个度数为 $4$ 的顶点

请判断 $T$ 中是否存在满足烷烃定义的子图。若存在，求此类子图的顶点数的最大值；否则输出 $-1$。

## 输入格式

输入通过标准输入按以下格式给出：

> $N$  
> $A_1$ $B_1$  
> $A_2$ $B_2$  
> $\vdots$  
> $A_{N-1}$ $B_{N-1}$

## 输出格式

若存在满足烷烃定义的子图，输出其顶点数的最大值；否则输出 $-1$。

## 说明/提示

### 约束条件

- $1 \leq N \leq 2 \times 10^5$
- $1 \leq A_i, B_i \leq N$
- 输入的图是一棵无向树
- 所有输入值为整数

### 样例解释 1

选取顶点 $1, 2, 3, 4, 6, 7, 8, 9$ 及边 $(1,2)$、$(2,3)$、$(3,4)$、$(2,6)$、$(2,7)$、$(3,8)$、$(3,9)$ 构成的子图满足烷烃条件。其中顶点 $2$ 和顶点 $3$ 的度数为 $4$，其余顶点度数为 $1$，因此顶点数的最大值为 $8$。

翻译由 DeepSeek R1 完成

## 样例 #1

### 输入

```
9

1 2

2 3

3 4

4 5

2 6

2 7

3 8

3 9
```

### 输出

```
8
```

## 样例 #2

### 输入

```
7

1 2

1 3

2 4

2 5

3 6

3 7
```

### 输出

```
-1
```

## 样例 #3

### 输入

```
15

8 5

2 9

1 12

6 11

9 3

15 1

7 12

7 13

10 5

6 9

5 1

1 9

4 5

6 14
```

### 输出

```
11
```



---

---
title: "[ABC397E] Path Decomposition of a Tree"
layout: "post"
diff: 普及+/提高
pid: AT_abc397_e
tag: ['树形 DP']
---

# [ABC397E] Path Decomposition of a Tree

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc397/tasks/abc397_e

给定一棵包含 $NK$ 个顶点的树。顶点编号为 $1,2,\dots,NK$，其中第 $i$ 条边（$i=1,2,\dots,NK-1$）双向连接顶点 $u_i$ 和 $v_i$。

请判断是否可以将这棵树分解为 $N$ 条长度为 $K$ 的路径。更具体地说，判断是否存在满足以下条件的 $N \times K$ 矩阵 $P$：

- $P_{1,1}, \dots, P_{1,K}, P_{2,1}, \dots, P_{N,K}$ 是 $1,2,\dots,NK$ 的一个排列。
- 对于每个 $i=1,2,\dots,N$ 和 $j=1,2,\dots,K-1$，顶点 $P_{i,j}$ 和顶点 $P_{i,j+1}$ 之间存在一条边。


## 输入格式

输入通过标准输入给出，格式如下：

> $N$ $K$   
> $u_1$ $v_1$    
> $u_2$ $v_2$    
> $\vdots$   
> $u_{NK-1}$ $v_{NK-1}$   

## 输出格式

若可以分解为 $N$ 条长度为 $K$ 的路径，则输出 `Yes`，否则输出 `No`。

## 说明/提示

### 约束条件

- $1 \leq N$
- $1 \leq K$
- $NK \leq 2 \times 10^5$
- $1 \leq u_i < v_i \leq NK$
- 输入的图是一棵树
- 输入均为整数

### 样例解释 1

可以将树分解为由顶点 1,2 组成的路径、由顶点 3,4 组成的路径和由顶点 5,6 组成的路径。

翻译由 DeepSeek R1 完成

## 样例 #1

### 输入

```
3 2

1 2

2 3

3 4

2 5

5 6
```

### 输出

```
Yes
```

## 样例 #2

### 输入

```
3 2

1 2

2 3

3 4

2 5

3 6
```

### 输出

```
No
```



---

---
title: "Independent Set"
layout: "post"
diff: 普及+/提高
pid: AT_dp_p
tag: ['动态规划 DP', '树形 DP']
---

# Independent Set

## 题目描述

[problemUrl]: https://atcoder.jp/contests/dp/tasks/dp_p

$ N $ 頂点の木があります。 頂点には $ 1,\ 2,\ \ldots,\ N $ と番号が振られています。 各 $ i $ ($ 1\ \leq\ i\ \leq\ N\ -\ 1 $) について、$ i $ 番目の辺は頂点 $ x_i $ と $ y_i $ を結んでいます。

太郎君は、各頂点を白または黒で塗ることにしました。 ただし、隣り合う頂点どうしをともに黒で塗ってはいけません。

頂点の色の組合せは何通りでしょうか？ $ 10^9\ +\ 7 $ で割った余りを求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ x_1 $ $ y_1 $ $ x_2 $ $ y_2 $ $ : $ $ x_{N\ -\ 1} $ $ y_{N\ -\ 1} $

## 输出格式

頂点の色の組合せは何通りか？ $ 10^9\ +\ 7 $ で割った余りを出力せよ。

## 说明/提示

### 制約

- 入力はすべて整数である。
- $ 1\ \leq\ N\ \leq\ 10^5 $
- $ 1\ \leq\ x_i,\ y_i\ \leq\ N $
- 与えられるグラフは木である。

### Sample Explanation 1

頂点の色の組合せは次図の $ 5 $ 通りです。 !\[\](https://img.atcoder.jp/dp/indep\_0\_muffet.png)

### Sample Explanation 2

頂点の色の組合せは次図の $ 9 $ 通りです。 !\[\](https://img.atcoder.jp/dp/indep\_1\_muffet.png)

## 样例 #1

### 输入

```
3

1 2

2 3
```

### 输出

```
5
```

## 样例 #2

### 输入

```
4

1 2

1 3

1 4
```

### 输出

```
9
```

## 样例 #3

### 输入

```
1
```

### 输出

```
2
```

## 样例 #4

### 输入

```
10

8 5

10 8

6 5

1 5

4 8

2 10

3 6

9 2

1 7
```

### 输出

```
157
```



---


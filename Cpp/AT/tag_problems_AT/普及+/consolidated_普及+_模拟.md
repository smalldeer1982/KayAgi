---
title: "[ABC258E] Packing Potatoes"
layout: "post"
diff: 普及+/提高
pid: AT_abc258_e
tag: ['模拟']
---

# [ABC258E] Packing Potatoes

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc258/tasks/abc258_e

ベルトコンベアに載って $ 10^{100} $ 個のじゃがいもが $ 1 $ 個ずつ流れてきます。流れてくるじゃがいもの重さは長さ $ N $ の数列 $ W\ =\ (W_0,\ \dots,\ W_{N-1}) $ で表され、$ i\ \,\ (1\ \leq\ i\ \leq\ 10^{100}) $ 番目に流れてくるじゃがいもの重さは $ W_{(i-1)\ \bmod\ N} $ です。ここで、$ (i-1)\ \bmod\ N $ は $ i\ -\ 1 $ を $ N $ で割った余りを表します。

高橋君は、まず空の箱を用意し、次のルールに従ってじゃがいもを順番に箱に詰めていきます。

- じゃがいもを箱に入れる。箱に入っているじゃがいもの重さの総和が $ X $ 以上になったら、その箱には蓋をし、新たに空の箱を用意する。

$ Q $ 個のクエリが与えられます。$ i\ \,\ (1\ \leq\ i\ \leq\ Q) $ 番目のクエリでは、正整数 $ K_i $ が与えられるので、$ K_i $ 番目に蓋をされた箱に入っているじゃがいもの個数を求めてください。問題の制約下で、蓋をされた箱が $ K_i $ 個以上存在することが証明できます。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ Q $ $ X $ $ W_0 $ $ W_1 $ $ \ldots $ $ W_{N-1} $ $ K_1 $ $ \vdots $ $ K_Q $

## 输出格式

$ Q $ 行出力せよ。$ i\ \,\ (1\ \leq\ i\ \leq\ Q) $ 行目には、$ i $ 番目のクエリへの答えを出力せよ。

## 说明/提示

### 制約

- $ 1\ \leq\ N,\ Q\ \leq\ 2\ \times\ 10^5 $
- $ 1\ \leq\ X\ \leq\ 10^9 $
- $ 1\ \leq\ W_i\ \leq\ 10^9\ \,\ (0\ \leq\ i\ \leq\ N\ -\ 1) $
- $ 1\ \leq\ K_i\ \leq\ 10^{12}\ \,\ (1\ \leq\ i\ \leq\ Q) $
- 入力は全て整数

### Sample Explanation 1

$ 2 $ つの箱に蓋をするまでの高橋くんの行動は以下の通りです。 - 空の箱を用意する。 - $ 1 $ 番目のじゃがいもを箱に入れる。箱に入っているじゃがいもの重さの総和は $ 3 $ である。 - $ 2 $ 番目のじゃがいもを箱に入れる。箱に入っているじゃがいもの重さの総和は $ 3\ +\ 4\ =\ 7 $ であり、$ X\ =\ 5 $ 以上になったのでこの箱には蓋をする。 - 新たに空の箱を用意する。 - $ 3 $ 番目のじゃがいもを箱に入れる。箱に入っているじゃがいもの重さの総和は $ 1 $ である。 - $ 4 $ 番目のじゃがいもを箱に入れる。箱に入っているじゃがいもの重さの総和は $ 1\ +\ 3\ =\ 4 $ である。 - $ 5 $ 番目のじゃがいもを箱に入れる。箱に入っているじゃがいもの重さの総和は $ 1\ +\ 3\ +\ 4\ =\ 8 $ であり、$ X\ =\ 5 $ 以上になったのでこの箱には蓋をする。 $ 1 $ 番目に蓋をされた箱には $ 2 $ つのじゃがいもが入っており、$ 2 $ 番目に蓋をされた箱には $ 3 $ つのじゃがいもが入っています。

## 样例 #1

### 输入

```
3 2 5
3 4 1
1
2
```

### 输出

```
2
3
```

## 样例 #2

### 输入

```
10 5 20
5 8 5 9 8 7 4 4 8 2
1
1000
1000000
1000000000
1000000000000
```

### 输出

```
4
5
5
5
5
```



---

---
title: "[ABC264F] Monochromatic Path"
layout: "post"
diff: 普及+/提高
pid: AT_abc264_f
tag: ['模拟', '动态规划 DP']
---

# [ABC264F] Monochromatic Path

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc264/tasks/abc264_f

各マスが白または黒で塗られた $ H $ 行 $ W $ 列のグリッドがあります。 $ 1\ \leq\ i\ \leq\ H $ かつ $ 1\ \leq\ j\ \leq\ W $ を満たす整数の組 $ (i,\ j) $ について、 グリッドの上から $ i $ 行目、左から $ j $ 行目のマス（以下、単にマス $ (i,\ j) $ と呼ぶ）の色は $ A_{i,\ j} $ で表されます。 $ A_{i,\ j}\ =\ 0 $ のときマス $ (i,\ j) $ は白色、$ A_{i,\ j}\ =\ 1 $ のときマス $ (i,\ j) $ は黒色です。

「下記の $ 2 $ つの操作のどちらかを行うこと」を好きなだけ（ $ 0 $ 回でも良い）繰り返すことができます。

- $ 1\ \leq\ i\ \leq\ H $ を満たす整数を選び、$ R_i $ 円払った後、グリッドの上から $ i $ 行目にあるそれぞれのマスの色を反転させる（白色のマスは黒色に、黒色のマスは白色に塗り替える）。
- $ 1\ \leq\ j\ \leq\ W $ を満たす整数を選び、$ C_j $ 円払った後、グリッドの左から $ j $ 列目にあるそれぞれのマスの色を反転させる。

下記の条件を満たすようにするためにかかる合計費用の最小値を出力して下さい。

- マス $ (1,\ 1) $ から「現在いるマスの右隣もしくは下隣のマスに移動する」 ことを繰り返してマス $ (H,\ W) $ まで移動する経路であって、通るマス（マス $ (1,\ 1) $ とマス $ (H,\ W) $ も含む）の色がすべて同じであるようなものが存在する。

本問題の制約下において、有限回の操作によって上記の条件を満たすようにすることが可能であることが証明できます。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ H $ $ W $ $ R_1 $ $ R_2 $ $ \ldots $ $ R_H $ $ C_1 $ $ C_2 $ $ \ldots $ $ C_W $ $ A_{1,\ 1}A_{1,\ 2}\ldots\ A_{1,\ W} $ $ A_{2,\ 1}A_{2,\ 2}\ldots\ A_{2,\ W} $ $ \vdots $ $ A_{H,\ 1}A_{H,\ 2}\ldots\ A_{H,\ W} $

## 输出格式

答えを出力せよ。

## 说明/提示

### 制約

- $ 2\ \leq\ H,\ W\ \leq\ 2000 $
- $ 1\ \leq\ R_i\ \leq\ 10^9 $
- $ 1\ \leq\ C_j\ \leq\ 10^9 $
- $ A_{i,\ j}\ \in\ \lbrace\ 0,\ 1\rbrace $
- 入力はすべて整数

### Sample Explanation 1

白色のマスを `0` 、黒色のマスを `1` で表します。 初期状態のグリッドに対し、$ R_2\ =\ 3 $ 円払って上から $ 2 $ 行目にあるそれぞれのマスを反転させると、 ``` 0100 0100 1010 ``` となります。さらに、$ C_2\ =\ 6 $ 円払って左から $ 2 $ 列目にあるそれぞれのマスを反転させると、 ``` 0000 0000 1110 ``` となり、マス $ (1,\ 1) $ からマス $ (3,\ 4) $ への移動経路であって通るマスの色がすべて同じであるようなものが存在する状態になります（例えば $ (1,\ 1)\ \rightarrow\ (2,\ 1)\ \rightarrow\ (2,\ 2)\ \rightarrow\ (2,\ 3)\ \rightarrow\ (2,\ 4)\ \rightarrow\ (3,\ 4) $ という経路）。 かかった合計費用は $ 3+6\ =\ 9 $ 円であり、このときが考えられる中で最小です。

## 样例 #1

### 输入

```
3 4

4 3 5

2 6 7 4

0100

1011

1010
```

### 输出

```
9
```

## 样例 #2

### 输入

```
15 20

29 27 79 27 30 4 93 89 44 88 70 75 96 3 78

39 97 12 53 62 32 38 84 49 93 53 26 13 25 2 76 32 42 34 18

01011100110000001111

10101111100010011000

11011000011010001010

00010100011111010100

11111001101010001011

01111001100101011100

10010000001110101110

01001011100100101000

11001000100101011000

01110000111011100101

00111110111110011111

10101111111011101101

11000011000111111001

00011101011110001101

01010000000001000000
```

### 输出

```
125
```



---

---
title: "[ABC315D] Magical Cookies"
layout: "post"
diff: 普及+/提高
pid: AT_abc315_d
tag: ['模拟', '枚举']
---

# [ABC315D] Magical Cookies

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc315/tasks/abc315_d

$ H\ \times\ W $ 枚のクッキーが $ H $ 行 $ W $ 列に並んでいます。  
上から $ i $ 行目・左から $ j $ 列目のクッキーの色は英小文字 $ c_{i,j} $ で表されます。

これから、以下の手続きを行います。

1\. 各行に対して次の操作を行う : その行に $ 2 $ 枚以上のクッキーが残っており、それらの色がすべて同じならば、それらに印をつける。

2\. 各列に対して次の操作を行う : その列に $ 2 $ 枚以上のクッキーが残っており、それらの色がすべて同じならば、それらに印をつける。

3\. 印のついたクッキーがあればそれらをすべて取り除いて 1. に戻り、なければ手続きを終了する。

手続きを終了した時点で残っているクッキーの枚数を求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ H $ $ W $ $ c_{1,1} $$ c_{1,2} $ $ \ldots $ $ c_{1,W} $ $ c_{2,1} $$ c_{2,2} $ $ \ldots $ $ c_{2,W} $ $ \vdots $ $ c_{H,1} $$ c_{H,2} $ $ \ldots $ $ c_{H,W} $

## 输出格式

答えを出力せよ。

## 说明/提示

### 制約

- $ 2\ \leq\ H,\ W\ \leq\ 2000 $
- $ c_{i,j} $ は英小文字である

### Sample Explanation 1

以下で示す順で手続きを行います。 - 1. により、$ 1,\ 2 $ 行目のクッキーに印をつける。 - 2. により、$ 1 $ 列目のクッキーに印をつける。 - 3. により、印を付けたクッキーを取り除く。 この時点でクッキーは以下のようになっています。ただし、クッキーを取り除いた箇所は `.` で表しています。 ``` ... ... .bc .bd ``` - 1. により、何もしない。 - 2. により、$ 2 $ 列目のクッキーに印をつける。 - 3. により、印を付けたクッキーを取り除く。 この時点でクッキーは以下のようになっています。ただし、クッキーを取り除いた箇所は `.` で表しています。 ``` ... ... ..c ..d ``` - 1. により、何もしない。 - 2. により、何もしない。 - 3. により、印がついているクッキーが存在しないので手続きを終了する。 最終的に残っているクッキーの枚数は $ 2 $ 枚です。

## 样例 #1

### 输入

```
4 3
aaa
aaa
abc
abd
```

### 输出

```
2
```

## 样例 #2

### 输入

```
2 5
aaaaa
abcde
```

### 输出

```
4
```

## 样例 #3

### 输入

```
3 3
ooo
ooo
ooo
```

### 输出

```
0
```



---


---
title: "[ABC057D] Maximum Average Sets"
layout: "post"
diff: 普及+/提高
pid: AT_abc057_d
tag: ['贪心', '排序']
---

# [ABC057D] Maximum Average Sets

## 题目描述

你有 $n$ 个物品，第 $i$ 个物品的价值为 $v_i$。
你需要从这些物品中选择 $A$ 个以上，$B$ 个以下的物品，计算出所选物品平均值的最大值，并求出能使选择物品的平均值最大的选择方法有几种。

## 输入格式

输入共两行。  
第一行三个整数 $n,A,B$。  
第二行 $n$ 个整数 $v_1\sim v_n$。  
由标准输入给出。

## 输出格式

输出共两行。  
第一行一个实数，代表所选物品平均价值的最大值。如果选手答案与标准答案的绝对误差或相对误差在 $10^{-6}$ 以下，则视为正确答案。  
第二行一个整数，代表所选物品平均价值达到最大选择方法的数量。

## 说明/提示

#### 数据规模与约定
对于 $100\%$ 的测试点数据，保证：
- $1\le a\le b\le n\le50$
- $1\le v_i\le10^{15}$
- $v_i$ 全部为整数。

#### 样例 $1$ 解释
选择第 $4$ 个物品和第 $5$ 个物品，价值的平均值是最大的，所以第一行输出 $4.5$。另外，由于除此之外的物品的选择方法中没有价值平均值为 $4.5$ 的东西，所以第二行输出 $1$。

#### 样例 $2$ 解释
物品价值平均值最大的物品的选择方法可能有多个。

---
翻译：@[Wuzetong](https://www.luogu.com.cn/user/1219873)

## 样例 #1

### 输入

```
5 2 2

1 2 3 4 5
```

### 输出

```
4.500000

1
```

## 样例 #2

### 输入

```
4 2 3

10 20 10 10
```

### 输出

```
15.000000

3
```

## 样例 #3

### 输入

```
5 1 5

1000000000000000 999999999999999 999999999999998 999999999999997 999999999999996
```

### 输出

```
1000000000000000.000000

1
```

## 样例 #4

### 输入

```
50 1 50

1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1
```

### 输出

```
1.000000

1125899906842623
```



---

---
title: "[ABC159E] Dividing Chocolate"
layout: "post"
diff: 普及+/提高
pid: AT_abc159_e
tag: ['贪心', '递归']
---

# [ABC159E] Dividing Chocolate

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc159/tasks/abc159_e

縦 $ H $ マス、横 $ W $ マスのグリッドに区切られたチョコレートがあります。

上から $ i $ 行目、左から $ j $ 列目にあるマス $ (i,j) $ のチョコレートは、$ S_{i,j} $ が `0` のとき普通のチョコレートであり、`1` のときホワイトチョコレートです。

このチョコレートに対して、マスの境界に沿った直線によってグリッド全体の端から端まで割る操作を何度か行い、いくつかのブロックに分割します。

分割後のどのブロックにもホワイトチョコレートのマスが $ K $ マス以下しか含まれないようにするためには、最小で操作を何回行う必要があるか求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ H $ $ W $ $ K $ $ S_{1,1}S_{1,2}...S_{1,W} $ $ : $ $ S_{H,1}S_{H,2}...S_{H,W} $

## 输出格式

分割後のどのブロックにもホワイトチョコレートのマスが $ K $ マス以下しか含まれないようにするため必要な操作回数の最小値を出力せよ。

## 说明/提示

### 制約

- $ 1\ \leq\ H\ \leq\ 10 $
- $ 1\ \leq\ W\ \leq\ 1000 $
- $ 1\ \leq\ K\ \leq\ H\ \times\ W $
- $ S_{i,j} $ は `0` か `1`

### Sample Explanation 1

例えば左の図のように $ 1 $ 行目と $ 2 $ 行目の間と、$ 3 $ 列目と $ 4 $ 列目の間の $ 2 $ か所で割ればよいです。 右の2つの図のような割り方はできないことに注意してください。 !\[図\](https://img.atcoder.jp/ghi/ac90dd542639c04402125403b1c319d7.png)

### Sample Explanation 2

操作を行う必要はありません。

## 样例 #1

### 输入

```
3 5 4

11100

10001

00111
```

### 输出

```
2
```

## 样例 #2

### 输入

```
3 5 8

11100

10001

00111
```

### 输出

```
0
```

## 样例 #3

### 输入

```
4 10 4

1110010010

1000101110

0011101001

1101000111
```

### 输出

```
3
```



---

---
title: "[ABC252F] Bread"
layout: "post"
diff: 普及+/提高
pid: AT_abc252_f
tag: ['贪心']
---

# [ABC252F] Bread

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc252/tasks/abc252_f

長さ $ L $ のパンが $ 1 $ つあり、これを $ N $ 人の子供たちに切り分けます。 $ i $ 番目 $ (1\leq\ i\leq\ N) $ の子供は長さ $ A_i $ のパンを欲しがっています。

そこで、高橋君は次の操作を繰り返して、長さ $ A_1,A_2,\ldots,A_N $ のパンを切り出して配ることにしました。

> 長さ $ k $ のパン $ 1 $ つと $ 1 $ 以上 $ k-1 $ 以下の整数 $ x $ を選ぶ。選んだパンを長さ $ x $ のパンと 長さ $ k-x $ のパンに切り分ける。   
> このとき、$ x $ の値によらずコストが $ k $ かかる。

それぞれの子供に配るパンは長さがちょうど $ A_i $ のパン $ 1 $ つである必要がありますが、誰にも配られずに余るパンがいくつあっても構いません。

このとき、全ての子供たちにパンを配るために必要な最小のコストを求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ L $ $ A_1 $ $ A_2 $ $ \ldots $ $ A_N $

## 输出格式

全ての子供たちにパンを配るために必要な最小のコストを出力せよ。

## 说明/提示

### 制約

- $ 2\ \leq\ N\ \leq\ 2\times\ 10^5 $
- $ 1\leq\ A_i\leq\ 10^9 $
- $ A_1+A_2+\cdots+A_N\leq\ L\leq\ 10^{15} $
- 入力は全て整数

### Sample Explanation 1

高橋君は次のようにしてパンを切り分けて配ることができます。 - 長さ $ 7 $ のパンと整数 $ x=3 $ を選ぶ。パンは長さ $ 3 $ のパンと長さ $ 4 $ のパンに切り分けられる。 (コスト $ 7 $ ) - 長さ $ 3 $ のパンと整数 $ x=1 $ を選ぶ。パンは長さ $ 1 $ のパンと長さ $ 2 $ のパンに切り分けられる。前者を $ 1 $ 番目の子供に配る。 (コスト $ 3 $ ) - 長さ $ 2 $ のパンと整数 $ x=1 $ を選ぶ。パンは長さ $ 1 $ のパン $ 2 $ つに切り分けられる。これを $ 3,5 $ 番目の子供に配る。 (コスト $ 2 $ ) - 長さ $ 4 $ のパンと整数 $ x=2 $ を選ぶ。パンは長さ $ 2 $ のパン $ 2 $ つに切り分けられる。これを $ 2,4 $ 番目の子供に配る。 (コスト $ 4 $ ) このとき、コストは $ 7+3+2+4=16 $ かかり、これが最小です。 また、余るパンはありません。

### Sample Explanation 2

それぞれの子供に配るパンの長さはちょうど $ A_i $ でなければならない事に注意してください。

## 样例 #1

### 输入

```
5 7
1 2 1 2 1
```

### 输出

```
16
```

## 样例 #2

### 输入

```
3 1000000000000000
1000000000 1000000000 1000000000
```

### 输出

```
1000005000000000
```



---

---
title: "[ABC257E] Addition and Multiplication 2"
layout: "post"
diff: 普及+/提高
pid: AT_abc257_e
tag: ['贪心', '枚举']
---

# [ABC257E] Addition and Multiplication 2

## 题目描述

高桥君有一个整数 $x$ 。一开始的时候， $x=0$ 。

高桥君可以无限执行以下操作：

- 选择一个整数 $i$ （ $1 \leq i \leq 9$ ）。支付 $C_i$ 日元，把 $x$ 变为 $10x+i$ 。

高桥君有 $N$ 日元，问 $x$ 最大是多少？

### 约束 ###

$1 \leq N \leq 10^6$

$1 \leq C_i \leq N$

保证 $N,C_i$ 都是整数。

## 输入格式

输入数据按以下格式给出：

$N$

$C_1$ $C_2$ … $C_9$

## 输出格式

输出用不超过 $N$ 日元，最多可以使 $x$ 变为多少，并在末尾换行。

### 样例解释 ###

#### 样例1 ####

分别令 $i$ 为 $9$ 和 $5$ ， $x$ 将得到 $95$ 。一共花费 $C_9+C_5=5$ 日元，并未超过 $N$ ，符合要求。这是 $x$ 的最大值。

#### 样例2 ####

请注意，答案可能无法用 $64$ 位整数表示。

## 样例 #1

### 输入

```
5
5 4 3 3 2 5 3 5 3
```

### 输出

```
95
```

## 样例 #2

### 输入

```
20
1 1 1 1 1 1 1 1 1
```

### 输出

```
99999999999999999999
```



---

---
title: "[ABC281F] Xor Minimization"
layout: "post"
diff: 普及+/提高
pid: AT_abc281_f
tag: ['贪心', '位运算']
---

# [ABC281F] Xor Minimization

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc281/tasks/abc281_f

非負整数列 $ A=(a_1,\ldots,a_N) $ が与えられます。

$ A $ に対して次の操作をちょうど $ 1 $ 回行います。

- 非負整数 $ x $ を選ぶ。そして、$ i=1,\ldots,N $ すべてに対し、$ a_i $ の値を「$ a_i $ と $ x $ のビット単位 xor」に置き換える。
 
操作後の $ A $ に含まれる値の最大値を $ M $ とします。$ M $ の最小値を求めてください。

 ビット単位 xor とは 非負整数 $ A,\ B $ のビット単位 xor 、$ A\ \oplus\ B $ は、以下のように定義されます。 - $ A\ \oplus\ B $ を二進表記した際の $ 2^k $ ($ k\ \geq\ 0 $) の位の数は、$ A,\ B $ を二進表記した際の $ 2^k $ の位の数のうち一方のみが $ 1 $ であれば $ 1 $、そうでなければ $ 0 $ である。

 例えば、$ 3\ \oplus\ 5\ =\ 6 $ となります (二進表記すると: $ 011\ \oplus\ 101\ =\ 110 $)。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ a_1 $ $ \ldots $ $ a_N $

## 输出格式

答えを出力せよ。

## 说明/提示

### 制約

- $ 1\ \leq\ N\ \leq\ 1.5\ \times\ 10^5 $
- $ 0\ \leq\ a_i\ \lt\ 2^{30} $
- 入力はすべて整数
 
### Sample Explanation 1

$ x=2 $ として操作をすると、操作後の数列は $ (12\ \oplus\ 2,18\ \oplus\ 2,\ 11\ \oplus\ 2)\ =\ (14,16,9) $ となり、最大値 $ M $ は $ 16 $ となります。 $ M $ を $ 16 $ より小さくすることは出来ないため、この値が答えです。

## 样例 #1

### 输入

```
3

12 18 11
```

### 输出

```
16
```

## 样例 #2

### 输入

```
10

0 0 0 0 0 0 0 0 0 0
```

### 输出

```
0
```

## 样例 #3

### 输入

```
5

324097321 555675086 304655177 991244276 9980291
```

### 输出

```
805306368
```



---

---
title: "[ABC312F] Cans and Openers"
layout: "post"
diff: 普及+/提高
pid: AT_abc312_f
tag: ['贪心', '枚举']
---

# [ABC312F] Cans and Openers

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc312/tasks/abc312_f

$ N $ 個の品物があります。  
 これらはそれぞれ、缶切りが不要な缶・缶切りが必要な缶・缶切りのいずれかです。  
 $ i $ 個目の品物は、整数の組 $ (T_i,\ X_i) $ により次のように表されます。

- $ T_i\ =\ 0 $ ならば、$ i $ 個目の品物は缶切りが不要な缶で、入手すると満足度 $ X_i $ を得る。
- $ T_i\ =\ 1 $ ならば、$ i $ 個目の品物は缶切りが必要な缶で、入手した上で缶切りを使うと満足度 $ X_i $ を得る。
- $ T_i\ =\ 2 $ ならば、$ i $ 個目の品物は缶切りで、$ X_i $ 個までの缶に対して使用できる。
 
$ N $ 個の品物から $ M $ 個を選んで入手するとき、得られる満足度の合計としてあり得る最大値を求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ M $ $ T_1 $ $ X_1 $ $ T_2 $ $ X_2 $ $ \vdots $ $ T_N $ $ X_N $

## 输出格式

答えを整数として出力せよ。

## 说明/提示

### 制約

- $ 1\ \leq\ M\ \leq\ N\ \leq\ 2\ \times\ 10^5 $
- $ T_i $ は $ 0,1,2 $ のいずれか
- $ 1\ \leq\ X_i\ \leq\ 10^9 $
- 入力される値はすべて整数
 
### Sample Explanation 1

$ 1,\ 2,\ 5,\ 7 $ 個目の品物を入手し、$ 7 $ 個目の品物である缶切りを $ 5 $ 個目の品物に対して使用すると、満足度 $ 6\ +\ 6\ +\ 15\ =\ 27 $ を得ます。 満足度が $ 28 $ 以上になる品物の入手方法は存在しませんが、上記の例において $ 7 $ 個目の品物のかわりに $ 6 $ 個目の品物や $ 8 $ 個目の品物を選んでも満足度 $ 27 $ を得ることができます。

## 样例 #1

### 输入

```
8 4

0 6

0 6

1 3

1 5

1 15

2 1

2 10

2 100
```

### 输出

```
27
```

## 样例 #2

### 输入

```
5 5

1 5

1 5

1 5

1 5

1 5
```

### 输出

```
0
```

## 样例 #3

### 输入

```
12 6

2 2

0 1

0 9

1 3

1 5

1 3

0 4

2 1

1 8

2 1

0 1

0 4
```

### 输出

```
30
```



---

---
title: "[ABC359F] Tree Degree Optimization"
layout: "post"
diff: 普及+/提高
pid: AT_abc359_f
tag: ['贪心']
---

# [ABC359F] Tree Degree Optimization

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc359/tasks/abc359_f

整数列 $ A=(A_1,\ldots,A_N) $ が与えられます。 $ N $ 頂点の木 $ T $ に対して、 $ f(T) $ を以下で定めます。

- $ T $ の頂点 $ i $ の次数を $ d_i $ とする。このとき、$ f(T)=\sum_{i=1}^N\ {d_i}^2\ A_i $ とする。
 
$ f(T) $ として考えられる最小値を求めてください。

なお、制約下において答えが $ 2^{63} $ 未満となることは保証されています。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ A_1 $ $ A_2 $ $ \ldots $ $ A_N $

## 输出格式

答えを出力せよ。

## 说明/提示

### 制約

- $ 2\leq\ N\leq\ 2\times\ 10^5 $
- $ 1\leq\ A_i\ \leq\ 10^9 $
- 入力される数値は全て整数
 
### Sample Explanation 1

頂点 $ 1 $ と頂点 $ 2 $ を結ぶ辺、頂点 $ 2 $ と頂点 $ 4 $ を結ぶ辺、頂点 $ 4 $ と頂点 $ 3 $ を結ぶ辺からなるような木 $ T $ を考えます。 このとき $ f(T)\ =\ 1^2\times\ 3\ +\ 2^2\times\ 2+1^2\times\ 5\ +2^2\times\ 2\ =\ 24 $ です。これが $ f(T) $ の最小値であることが証明できます。

## 样例 #1

### 输入

```
4

3 2 5 2
```

### 输出

```
24
```

## 样例 #2

### 输入

```
3

4 3 2
```

### 输出

```
15
```

## 样例 #3

### 输入

```
7

10 5 10 2 10 13 15
```

### 输出

```
128
```



---

---
title: "[ABC366F] Maximum Composition"
layout: "post"
diff: 普及+/提高
pid: AT_abc366_f
tag: ['动态规划 DP', '贪心']
---

# [ABC366F] Maximum Composition

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc366/tasks/abc366_f

$ N $ 個の一次関数 $ f_1,f_2,\ldots,f_N $ が与えられます。$ f_i(x)=A_i\ x+B_i $ です。

$ 1 $ 以上 $ N $ 以下の**相異なる** $ K $ 個の整数からなる長さ $ K $ の数列 $ p=(p_1,p_2,\ \ldots\ p_K) $ について、$ f_{p_1}(f_{p_2}(\ldots\ f_{p_K}(1)\ldots\ )) $ としてありえる最大値を求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ K $ $ A_1 $ $ B_1 $ $ A_2 $ $ B_2 $ $ \vdots $ $ A_N $ $ B_N $

## 输出格式

答えを整数として出力せよ。

## 说明/提示

### 制約

- $ 1\ \leq\ N\ \leq\ 2\ \times\ 10^{5} $
- $ 1\ \leq\ K\ \leq\ \text{min}(N,10) $
- $ 1\ \leq\ A_i,B_i\ \leq\ 50 $ $ (1\ \leq\ i\ \leq\ N) $
- 入力はすべて整数

### Sample Explanation 1

ありえるすべての $ p $ とそれに対応する $ f_{p_1}(f_{p_2}(1)) $ の値は以下の通りです。 - $ p=\ (\ 1,2\ ) $ : $ f_1(f_2(1))=15 $ - $ p=\ (\ 1,3\ ) $ : $ f_1(f_3(1))=15 $ - $ p=\ (\ 2,1\ ) $ : $ f_2(f_1(1))=10 $ - $ p=\ (\ 2,3\ ) $ : $ f_2(f_3(1))=11 $ - $ p=\ (\ 3,1\ ) $ : $ f_3(f_1(1))=22 $ - $ p=\ (\ 3,2\ ) $ : $ f_3(f_2(1))=26 $ よって、 $ 26 $ と出力します。

## 样例 #1

### 输入

```
3 2
2 3
1 5
4 2
```

### 输出

```
26
```

## 样例 #2

### 输入

```
10 3
48 40
34 22
24 37
45 40
48 31
49 44
45 40
44 6
35 22
39 28
```

### 输出

```
216223
```



---

---
title: "[ABC373E] How to Win the Election"
layout: "post"
diff: 普及+/提高
pid: AT_abc373_e
tag: ['贪心', '二分']
---

# [ABC373E] How to Win the Election

## 题目描述

现在正在举行一场选举，有 $N$ 位候选人，编号为 $1, 2, \ldots, N$。目前已经有 $K$ 张选票，其中一些已经被计入。

到目前为止，第 $i$ 位候选人已经获得了 $A_i$ 票。

在所有选票被计完后，如果某位候选人的得票数比他们多的候选人数少于 $M$，那么该候选人将被当选。可能会有多位候选人同时当选。

对于每个候选人，求出他们需要从剩余的选票中获得的最少票数，以确保无论其他候选人获得多少票，他们都能当选。

具体来说，对于每个 $i = 1, 2, \ldots, N$，解决以下问题：

确定是否存在一个非负整数 $X$，其不超过 $K - \displaystyle{\sum_{i=1}^{N}} A_i$，并满足以下条件。如果存在，找出满足条件的最小 $X$。

- 如果候选人 $i$ 获得了 $X$ 张额外选票，那么候选人 $i$ 将始终当选。

## 输入格式

第一行包含三个整数 $N$、$M$ 和 $K$。

第二行包含 $N$ 个整数，分别是 $A_1, A_2, \ldots, A_N$，表示每个候选人当前已经获得的票数。

## 输出格式

设 $C_i$ 为候选人 $i$ 从剩余选票中需要的最少额外票数，以保证无论其他候选人获得多少票，他们都能当选。输出 $C_1, C_2, \ldots, C_N$。

如果候选人 $i$ 已经确保当选，则 $C_i = 0$。如果候选人 $i$ 无法在任何情况下确保当选，则 $C_i = -1$。

## 说明/提示

- $1 \leq M \leq N \leq 2 \times 10^5$。
- $1 \leq K \leq 10^{12}$。
- $0 \leq A_i \leq 10^{12}$。
- $\displaystyle{\sum_{i=1}^{N} A_i} \leq K$。

## 样例 #1

### 输入

```
5 2 16
3 1 4 1 5
```

### 输出

```
2 -1 1 -1 0
```

## 样例 #2

### 输入

```
12 1 570
81 62 17 5 5 86 15 7 79 26 6 28
```

### 输出

```
79 89 111 117 117 74 112 116 80 107 117 106
```



---

---
title: "[ABC391F] K-th Largest Triplet"
layout: "post"
diff: 普及+/提高
pid: AT_abc391_f
tag: ['贪心']
---

# [ABC391F] K-th Largest Triplet

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc391/tasks/abc391_f

長さ $ N $ の整数列 $ A=(A_1,A_2,\ldots,A_N),\ B=(B_1,B_2,\ldots,B_N),C=(C_1,C_2,\ldots,C_N) $ および整数 $ K $ が与えられます。

$ 1\leq\ i,j,k\leq\ N $ を満たす整数 $ i,j,k $ の選び方 $ N^3 $ 通りそれぞれに対して $ A_iB_j+B_jC_k+C_kA_i $ の値を計算したとき、その中で大きい方から $ K $ 番目の値を求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ K $ $ A_1 $ $ A_2 $ $ \ldots $ $ A_N $ $ B_1 $ $ B_2 $ $ \ldots $ $ B_N $ $ C_1 $ $ C_2 $ $ \ldots $ $ C_N $

## 输出格式

答えを出力せよ。

## 说明/提示

### 制約

- $ 1\leq\ N\leq\ 2\times\ 10^5 $
- $ 1\leq\ K\leq\ \min(N^3,5\times\ 10^5) $
- $ 1\leq\ A_i,B_i,C_i\leq\ 10^9 $
- 入力は全て整数

### Sample Explanation 1

$ N^3=8 $ 個の整数の値は以下の通りです。 - $ (i,j,k)=(1,1,1) $ : $ A_1B_1+B_1C_1+C_1A_1=1\times\ 3+3\times\ 5+5\times\ 1=23 $ - $ (i,j,k)=(1,1,2) $ : $ A_1B_1+B_1C_2+C_2A_1=1\times\ 3+3\times\ 6+6\times\ 1=27 $ - $ (i,j,k)=(1,2,1) $ : $ A_1B_2+B_2C_1+C_1A_1=1\times\ 4+4\times\ 5+5\times\ 1=29 $ - $ (i,j,k)=(1,2,2) $ : $ A_1B_2+B_2C_2+C_2A_1=1\times\ 4+4\times\ 6+6\times\ 1=34 $ - $ (i,j,k)=(2,1,1) $ : $ A_2B_1+B_1C_1+C_1A_2=2\times\ 3+3\times\ 5+5\times\ 2=31 $ - $ (i,j,k)=(2,1,2) $ : $ A_2B_1+B_1C_2+C_2A_2=2\times\ 3+3\times\ 6+6\times\ 2=36 $ - $ (i,j,k)=(2,2,1) $ : $ A_2B_2+B_2C_1+C_1A_2=2\times\ 4+4\times\ 5+5\times\ 2=38 $ - $ (i,j,k)=(2,2,2) $ : $ A_2B_2+B_2C_2+C_2A_2=2\times\ 4+4\times\ 6+6\times\ 2=44 $ これらを値の降順に並べ替えると $ (44,38,36,34,31,29,27,23) $ となるため、 大きい方から $ 5 $ 番目の値は $ 31 $ です。

## 样例 #1

### 输入

```
2 5
1 2
3 4
5 6
```

### 输出

```
31
```

## 样例 #2

### 输入

```
3 10
100 100 100
100 100 100
100 100 100
```

### 输出

```
30000
```

## 样例 #3

### 输入

```
5 54
800516877 573289179 26509423 168629803 696409999
656737335 915059758 201458890 931198638 185928366
140174496 254538849 830992027 305186313 322164559
```

### 输出

```
689589940713840351
```



---

---
title: "[ABC395F] Smooth Occlusion"
layout: "post"
diff: 普及+/提高
pid: AT_abc395_f
tag: ['贪心', '二分']
---

# [ABC395F] Smooth Occlusion

## 题目描述

高桥君共有 $2N$ 颗牙齿，其中 $N$ 颗是上牙，剩余的 $N$ 颗是下牙。

左数第 $i$ 颗（$1 \leq i \leq N$）上牙的长度为 $U_i$，左数第 $i$ 颗（$1 \leq i \leq N$）下牙的长度为 $D_i$。

当高桥君的牙齿满足以下两个条件时，称为「良好咬合」：
1. 存在一个整数 $H$，使得对于所有 $1 \leq i \leq N$，有 $U_i + D_i = H$。
2. 对于所有 $1 \leq i < N$，有 $|U_i - U_{i+1}| \leq X$。

高桥君可以执行以下操作任意次：
- 支付 $1$ 日元使用磨牙工具，选择一个长度为正的牙齿，将其长度减少 $1$。

除上述操作外，无法通过其他方式改变牙齿长度。请计算高桥君达成良好咬合所需支付的最小金额。

## 输入格式

输入通过标准输入给出，格式如下：

> $N$ $X$  
> $U_1$ $D_1$  
> $U_2$ $D_2$  
> $\vdots$  
> $U_N$ $D_N$

## 输出格式

输出达成良好咬合所需的最小金额。

## 说明/提示

### 约束条件
- $2 \leq N \leq 2 \times 10^5$
- $1 \leq U_i \leq 10^9$（$1 \leq i \leq N$）
- $1 \leq D_i \leq 10^9$（$1 \leq i \leq N$）
- $1 \leq X \leq 10^9$
- 输入均为整数

### 样例解释 1
初始牙齿长度示意图（图片链接略）。通过以下调整可达成良好咬合（调整后示意图略），总成本为 $15$ 日元。无法以 $14$ 日元或更少达成，因此输出 `15`。

### 样例解释 2
存在牙齿初始状态已满足良好咬合的情况。

### 样例解释 3
答案可能超过 32 位整数范围，需注意处理大数。

翻译由 DeepSeek R1 完成

## 样例 #1

### 输入

```
4 3

3 1

4 1

5 9

2 6
```

### 输出

```
15
```

## 样例 #2

### 输入

```
4 1000000000

3 3

3 3

3 3

3 3
```

### 输出

```
0
```

## 样例 #3

### 输入

```
4 1

1000000000 1000000000

1000000000 1000000000

1000000000 1000000000

1 1
```

### 输出

```
5999999994
```

## 样例 #4

### 输入

```
15 128

748 169

586 329

972 529

432 519

408 587

138 249

656 114

632 299

984 755

404 772

155 506

832 854

353 465

387 374

567 385
```

### 输出

```
9460
```



---

---
title: "[ABC402F] Path to Integer"
layout: "post"
diff: 普及+/提高
pid: AT_abc402_f
tag: ['搜索', '贪心', '二分', '双指针 two-pointer', '折半搜索 meet in the middle']
---

# [ABC402F] Path to Integer

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc402/tasks/abc402_f

有一个 $N$ 行 $N$ 列的网格。从上往下第 $i$ 行、从左往右第 $j$ 列的格子记作格子 $(i,j)$。每个格子上都写有 `1` 到 `9` 的数字，格子 $(i,j)$ 上写的数字是 $A_{i,j}$。

初始时，棋子位于格子 $(1,1)$。同时，设 $S$ 为空字符串，接下来进行 $2N-1$ 次操作：

1. 将当前棋子所在格子的数字追加到 $S$ 的末尾。
2. 将棋子向右或向下移动一格（第 $2N-1$ 次操作时不移动）。

$2N-1$ 次操作后，棋子将位于格子 $(N,N)$，且 $S$ 的长度为 $2N-1$。

将最终得到的字符串 $S$ 视为整数，其值对 $M$ 取模的结果即为得分。

请计算可以获得的最高得分。

## 输入格式

输入通过标准输入给出，格式如下：

> $N$ $M$  
> $A_{1,1}$ $A_{1,2}$ $\ldots$ $A_{1,N}$  
> $A_{2,1}$ $A_{2,2}$ $\ldots$ $A_{2,N}$  
> $\vdots$  
> $A_{N,1}$ $A_{N,2}$ $\ldots$ $A_{N,N}$


## 输出格式

输出答案。


## 说明/提示

### 约束条件

- $1 \leq N \leq 20$
- $2 \leq M \leq 10^9$
- $1 \leq A_{i,j} \leq 9$
- 输入中的所有数值均为整数

### 样例解释 1

棋子的移动方式有以下两种：
1. 按 $(1,1)\rightarrow(1,2)\rightarrow(2,2)$ 的顺序移动。此时 $S=$ `121`，得分为 $121 \bmod 7 = 2$。
2. 按 $(1,1)\rightarrow(2,1)\rightarrow(2,2)$ 的顺序移动。此时 $S=$ `131`，得分为 $131 \bmod 7 = 5$。

最高得分为 5，因此输出 5。

翻译由 DeepSeek V3 完成

## 样例 #1

### 输入

```
2 7
1 2
3 1
```

### 输出

```
5
```

## 样例 #2

### 输入

```
3 100000
1 2 3
3 5 8
7 1 2
```

### 输出

```
13712
```

## 样例 #3

### 输入

```
5 402
8 1 3 8 9
8 2 4 1 8
4 1 8 5 9
6 2 1 6 7
6 6 7 7 6
```

### 输出

```
384
```



---

---
title: "[ABC407E] Most Valuable Parentheses"
layout: "post"
diff: 普及+/提高
pid: AT_abc407_e
tag: ['贪心', '堆']
---

# [ABC407E] Most Valuable Parentheses

## 题目描述

给你一个长度为 $2N$ 的数列 $A$。

定义一个长度为 $2N$ 的括号序列 $s$ 的得分：

- 对于所有 $s_i=$`)`，$A_i\leftarrow 0$；
- 得分为上述操作后 $A$ 中所有元素之和。

请求出对于一个长为 $2N$ 的合法的括号序列 $s$，它的得分的最大值。一个括号序列是合法的当且仅当它可以通过多次删去子段 `()` 变为空串。

## 输入格式

多组数据。第一行一个整数 $T(1\le T\le 500)$ 表示数据组数。

对于每组数据：\
第一行一个整数 $N(1\le N\le 2\times 10^5)$。\
接下来 $2N$ 行，每行一个数字，依次为 $A_1,A_2,\cdots,A_{2N}(0\le A_i\le 10^9)$。

保证单个测试点内 $\sum N\le 2\times 10^5$。

## 输出格式

对于每组数据，输出一行一个整数表示答案。***

## 说明/提示

**样例解释 1**

在第一组数据中，$s=$`(())()` 的得分为 $400+500+0+0+300+0=1200$。可以证明这是可能获得的最大的分，故答案为 $1200$。

如第二组数据所示，答案可能超出 32 位整数的表示范围。

By @[chenxi2009](/user/1020063)

## 样例 #1

### 输入

```
2
3
400
500
200
100
300
600
6
1000000000
1000000000
1000000000
1000000000
1000000000
1000000000
1000000000
1000000000
1000000000
1000000000
1000000000
1000000000
```

### 输出

```
1200
6000000000
```



---

---
title: "[AGC008B] Contiguous Repainting"
layout: "post"
diff: 普及+/提高
pid: AT_agc008_b
tag: ['贪心']
---

# [AGC008B] Contiguous Repainting

## 题目描述

[problemUrl]: https://atcoder.jp/contests/agc008/tasks/agc008_b

$ N $ 個のマスが横一列に並んでいます。 左から $ i $ 番目のマスには整数 $ a_i $ が書かれています。

最初、すべてのマスは白色です。 すぬけ君は次の操作を好きな回数だけ繰り返します。

- 連続する $ K $ 個のマスを選び、それらすべてを白く塗るか、それらすべてを黒く塗る。 このとき、各マスの色は上書きされる。

すぬけ君が操作を終えた後、黒いマスに書かれた整数の総和がスコアになります。 考えられるスコアの最大値を求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ K $ $ a_1 $ $ a_2 $ $ ... $ $ a_N $

## 输出格式

考えられるスコアの最大値を出力せよ。

## 说明/提示

### 制約

- $ 1\ <\ =N\ <\ =10^5 $
- $ 1\ <\ =K\ <\ =N $
- $ a_i $ は整数である。
- $ |a_i|\ <\ =10^9 $

### Sample Explanation 1

左から $ 2 $, $ 3 $, $ 4 $ 番目のマスを黒く塗ればよいです。

### Sample Explanation 2

たとえば、次のように操作を行えばよいです。 - 左から $ 1 $, $ 2 $ 番目のマスを黒く塗る。 - 左から $ 3 $, $ 4 $ 番目のマスを黒く塗る。 - 左から $ 2 $, $ 3 $ 番目のマスを白く塗る。

## 样例 #1

### 输入

```
5 3

-10 10 -10 10 -10
```

### 输出

```
10
```

## 样例 #2

### 输入

```
4 2

10 -10 -10 10
```

### 输出

```
20
```

## 样例 #3

### 输入

```
1 1

-10
```

### 输出

```
0
```

## 样例 #4

### 输入

```
10 5

5 -4 -5 -8 -4 7 2 -4 0 7
```

### 输出

```
17
```



---

---
title: "[AGC008C] Tetromino Tiling"
layout: "post"
diff: 普及+/提高
pid: AT_agc008_c
tag: ['贪心']
---

# [AGC008C] Tetromino Tiling

## 题目描述

[problemUrl]: https://atcoder.jp/contests/agc008/tasks/agc008_c

正方形のマスを $ 4 $ 個繋げた形をテトロミノといいます。 次の $ 7 $ 種類のテトロミノを順に I, O, T, J, L, S, Z 型と呼ぶことにします。

 ![a60bcb8e9e8f22e3af51049eda063392.png](https://cdn.luogu.com.cn/upload/vjudge_pic/AT_agc008_c/41da26817a0aa4921d5f3228c5ba880f4ed240c0.png)

すぬけ君は I, O, T, J, L, S, Z 型のテトロミノをそれぞれ $ a_I $, $ a_O $, $ a_T $, $ a_J $, $ a_L $, $ a_S $, $ a_Z $ 個ずつ持っています。 すぬけ君はこれらのテトロミノのうち $ K $ 個を組み合わせ、縦 $ 2 $ マス、横 $ 2K $ マスの長方形を作ろうとしています。 このとき、すぬけ君は次のルールに従います。

- 各テトロミノを置くとき、回転はできるが、反転はできない。
- 長方形の各マスにはちょうど $ 1 $ 個のテトロミノが置かれているようにする。
- 長方形の外部にテトロミノが置かれていないようにする。

すぬけ君はできるだけ大きい長方形を作ろうとしています。 $ K $ の最大値を求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ a_I $ $ a_O $ $ a_T $ $ a_J $ $ a_L $ $ a_S $ $ a_Z $

## 输出格式

$ K $ の最大値を出力せよ。 長方形を作ることができない場合、`0` を出力せよ。

## 说明/提示

### 制約

- $ 0\ <\ =a_I,a_O,a_T,a_J,a_L,a_S,a_Z\ <\ =10^9 $
- $ a_I+a_O+a_T+a_J+a_L+a_S+a_Z\ >\ =1 $

### Sample Explanation 1

たとえば、図のように組み合わせればよいです。 !\[45515ed2a1dd5e41c5e4ca1f39323d8e.png\](https://atcoder.jp/img/agc008/45515ed2a1dd5e41c5e4ca1f39323d8e.png)

### Sample Explanation 2

長方形を作ることができません。

## 样例 #1

### 输入

```
2 1 1 0 0 0 0
```

### 输出

```
3
```

## 样例 #2

### 输入

```
0 0 10 0 0 0 0
```

### 输出

```
0
```



---

---
title: "[AGC029D] Grid game"
layout: "post"
diff: 普及+/提高
pid: AT_agc029_d
tag: ['贪心']
---

# [AGC029D] Grid game

## 题目描述

[problemUrl]: https://atcoder.jp/contests/agc029/tasks/agc029_d

高橋君と青木君は $ H $ 行 $ W $ 列のマス目を使ってゲームをします。 このマス目上には $ N $ 個の障害物があり、$ i $ 番目の障害物は $ (X_i,Y_i) $ にあります。 ただし、$ i $ 行 $ j $ 列目 $ (1\ \leq\ i\ \leq\ H,\ 1\ \leq\ j\ \leq\ W) $ にあるマスを $ (i,j) $ で表すことにします。 また、どの障害物も $ (1,1) $ にはなく、$ (1,1) $ には $ 1 $ つの駒が置いてあります。

そこで、高橋君と青木君は高橋君から始めて、交互に以下の行動のいずれかを行います。

- 駒を隣り合うマスに動かす。 ただし、駒の位置を $ (x,y) $ としたとき、高橋君は $ (x+1,y) $ にのみ、青木君は $ (x,y+1) $ にのみ駒を動かすことができる。 また、動かすことのできるマスが存在しない、もしくは、動かす予定のマス目に障害物がある場合はこの行動をとることはできない。
- 駒を動かさず、マス目を元の状態のまま行動を終える。

$ 2 $ 回連続で駒が動かされなかった場合、そこでゲームを終了します。

高橋君はできるだけ多くの回数の行動 (駒を動かさないのも含む) を行ってゲームを終えたいですが、 青木君はできるだけ少ない回数の行動を行ってゲームを終えたいです。 このとき、高橋君が行うことになる行動の回数は何回か求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ H $ $ W $ $ N $ $ X_1 $ $ Y_1 $ $ : $ $ X_N $ $ Y_N $

## 输出格式

高橋君が行うことになる行動の回数を出力せよ。

## 说明/提示

### 制約

- $ 1\ \leq\ H,W\ \leq\ 2\times\ 10^5 $
- $ 0\ \leq\ N\ \leq\ 2\times\ 10^5 $
- $ 1\ \leq\ X_i\ \leq\ H $
- $ 1\ \leq\ Y_i\ \leq\ W $
- $ i\ \neq\ j $ のとき $ (X_i,Y_i)\ \neq\ (X_j,Y_j) $
- $ (X_i,Y_i)\ \neq\ (1,1) $
- $ X_i,Y_i $ は整数

### Sample Explanation 1

ゲームの一例は以下のようになります。 - 高橋君が駒を (2,1) に動かす。 - 青木君が駒を動かさない。 - 高橋君が駒を (3,1) に動かす。 - 青木君が駒を動かさない。 - 高橋君が駒を動かさない。 この場合は高橋君は $ 3 $ 回の行動を行いますが、 両者が最適に行動すれば $ 2 $ 回しか高橋君は行動せずにゲームが終了します。

## 样例 #1

### 输入

```
3 3 1

3 2
```

### 输出

```
2
```

## 样例 #2

### 输入

```
10 10 14

4 3

2 2

7 3

9 10

7 7

8 1

10 10

5 4

3 4

2 8

6 4

4 4

5 8

9 2
```

### 输出

```
6
```

## 样例 #3

### 输入

```
100000 100000 0
```

### 输出

```
100000
```



---

---
title: "[AGC034B] ABC"
layout: "post"
diff: 普及+/提高
pid: AT_agc034_b
tag: ['贪心']
---

# [AGC034B] ABC

## 题目描述

[problemUrl]: https://atcoder.jp/contests/agc034/tasks/agc034_b

`A`,`B`,`C` からなる文字列 $ s $ が与えられます。

すぬけ君は $ s $ に対して次の操作をできるだけ多く行おうとしています。

- $ s $ の連続した部分文字列であって `ABC` であるようなものをひとつ選び、 `BCA` に書き換える。

操作回数の最大値を求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ s $

## 输出格式

操作回数の最大値を出力せよ。

## 说明/提示

### 制約

- $ 1\ ≦\ |s|\ ≦\ 200000 $
- $ s $ の各文字は `A`,`B`,`C` のいずれか

### Sample Explanation 1

`ABCABC` → `BCAABC` → `BCABCA` → `BCBCAA` とすることで $ 3 $ 回操作可能で、これが最大です。

## 样例 #1

### 输入

```
ABCABC
```

### 输出

```
3
```

## 样例 #2

### 输入

```
C
```

### 输出

```
0
```

## 样例 #3

### 输入

```
ABCACCBABCBCAABCB
```

### 输出

```
6
```



---

---
title: "[AGC041B] Voting Judges"
layout: "post"
diff: 普及+/提高
pid: AT_agc041_b
tag: ['贪心', '排序']
---

# [AGC041B] Voting Judges

## 题目描述

[problemUrl]: https://atcoder.jp/contests/agc041/tasks/agc041_b

あるコンテストの開催に向けて $ N $ 問の問題が提案されました。はじめ、問題 $ i $ のスコアは整数 $ A_i $ です。

これから、$ M $ 人のジャッジが好きな問題に投票します。各ジャッジは、他のジャッジとは独立にちょうど $ V $ 問を選び、それらの問題のスコアを $ 1 $ ずつ上げます。

$ M $ 人のジャッジ全員が投票を行ったあと、$ N $ 問の問題がスコアの降順に並べられ、最初の $ P $ 問がコンテストの問題セットに採用されます。 同スコアの問題間の順序は、ジャッジ長が任意に決定します。

$ N $ 問のうち、問題セットに採用される可能性を持つ問題は何問あるでしょうか？

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ M $ $ V $ $ P $ $ A_1 $ $ A_2 $ $ ... $ $ A_N $

## 输出格式

問題セットに採用される可能性を持つ問題の数を出力せよ。

## 说明/提示

### 制約

- $ 2\ \le\ N\ \le\ 10^5 $
- $ 1\ \le\ M\ \le\ 10^9 $
- $ 1\ \le\ V\ \le\ N\ -\ 1 $
- $ 1\ \le\ P\ \le\ N\ -\ 1 $
- $ 0\ \le\ A_i\ \le\ 10^9 $

### Sample Explanation 1

$ 1 $ 人しかいないジャッジが問題 $ 2,5 $ に投票した場合、各問のスコアは $ 2 $ $ 2 $ $ 1 $ $ 3 $ $ 1 $ $ 2 $ となり、問題 $ 4 $、そして問題 $ 1,2,6 $ のうちの $ 1 $ 問が採用されます。 ジャッジが問題 $ 3,4 $ に投票した場合、各問のスコアは $ 2 $ $ 1 $ $ 2 $ $ 4 $ $ 0 $ $ 2 $ となり、問題 $ 4 $、そして問題 $ 1,3,6 $ のうちの $ 1 $ 問が採用されます。 よって、問題 $ 1,2,3,4,6 $ には採用される可能性があります。一方で、問題 $ 5 $ には採用される可能性はありません。

### Sample Explanation 2

採用される可能性があるのは問題 $ 1,4,6 $ のみです。

## 样例 #1

### 输入

```
6 1 2 2

2 1 1 3 0 2
```

### 输出

```
5
```

## 样例 #2

### 输入

```
6 1 5 2

2 1 1 3 0 2
```

### 输出

```
3
```

## 样例 #3

### 输入

```
10 4 8 5

7 2 3 6 1 6 5 4 6 5
```

### 输出

```
8
```



---

---
title: "[AGC053B] Taking the middle"
layout: "post"
diff: 普及+/提高
pid: AT_agc053_b
tag: ['贪心', '优先队列']
---

# [AGC053B] Taking the middle

## 题目描述

[problemUrl]: https://atcoder.jp/contests/agc053/tasks/agc053_b

$ 2N $ 枚のカードがあり、それぞれには $ 1 $ から $ 2N $ までの番号が付いています。カード $ i $ の価値は $ V_i $ です。 高橋君と青木君は以下の手順を $ N $ 回繰り返し、カードを $ N $ 枚ずつに分配します。

- まず、高橋君がまだ選ばれてないカードの中から $ 1 $ 枚選び、自分のものとする。 その後、青木君はまだ選ばれてないカードのうち **番号** が中央値であるものを選び、自分のものとする。

高橋君が最終的に持っているカードの価値の総和として考えられる最大の値を求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ V_1 $ $ V_2 $ $ \cdots $ $ V_{2N} $

## 输出格式

答えを出力せよ。

## 说明/提示

### 制約

- $ 1\leq\ N\leq\ 2\times\ 10^5 $
- $ 0\leq\ V_i\leq\ 10^9 $
- $ V_i $ は整数

### Sample Explanation 1

以下のような手順で、高橋君はカード $ 4,5,6 $ を手にすることができます。 - まず、高橋君はカード $ 6 $ を選ぶ。そして、青木君はカード $ 3 $ を選ぶ。 - 次に、高橋君はカード $ 5 $ を選ぶ。そして、青木君はカード $ 2 $ を選ぶ。 - 最後に、高橋君はカード $ 4 $ を選ぶ。そして、青木君はカード $ 1 $ を選ぶ。

## 样例 #1

### 输入

```
3

1 2 3 4 5 6
```

### 输出

```
15
```

## 样例 #2

### 输入

```
4

1 4 5 8 7 6 3 2
```

### 输出

```
20
```



---

---
title: "[AGC057A] Antichain of Integer Strings"
layout: "post"
diff: 普及+/提高
pid: AT_agc057_a
tag: ['贪心']
---

# [AGC057A] Antichain of Integer Strings

## 题目描述

[problemUrl]: https://atcoder.jp/contests/agc057/tasks/agc057_a

正整数からなる集合 $ A $ は次の条件を満たすとき、**良い集合**であるといいます。

- 任意の相異なる $ 2 $ 要素 $ a,\ b\ \in\ A $ に対して、$ a $ を $ 10 $ 進法表記した文字列は、$ b $ を $ 10 $ 進法表記した文字列の部分文字列**ではない**。
 
 部分文字列とは？ 部分文字列とは連続する部分列のことを指します。例えば `1`, `12`, `23` は `123` の部分文字列ですが、`21` や `13` は `123` の部分文字列ではありません。 正整数 $ L,\ R $ が与えられます。$ L $ 以上 $ R $ 以下の整数からなる良い集合 $ A $ の要素数の最大値を求めてください。

$ T $ 個のテストケースが与えられるので、それぞれについて答えを求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられます。

> $ T $ $ \text{case}_1 $ $ \vdots $ $ \text{case}_T $

各テストケースは以下の形式で与えられます。

> $ L $ $ R $

## 输出格式

$ T $ 行出力してください。$ i $ 行目には、$ \text{case}_i $ に対する答えを出力してください。

## 说明/提示

### 制約

- $ 1\leq\ T\leq\ 10^4 $
- $ 1\leq\ L\leq\ R\leq\ 10^{9} $

### Sample Explanation 1

はじめの $ 2 $ つのテストケースについて、例えば次の $ A $ が要素数が最大であるような良い集合となります。 - $ 1 $ つめのテストケース：$ A=\{3,4,5,6,7,8\} $. - $ 2 $ つめのテストケース：$ A=\{3,4,6,8,9,10,11,12,15,17\} $.

## 样例 #1

### 输入

```
3

3 8

3 18

1 1000
```

### 输出

```
6

10

900
```



---

---
title: "[ARC060E] 高橋君とホテル"
layout: "post"
diff: 普及+/提高
pid: AT_arc060_c
tag: ['贪心', '倍增', '分块']
---

# [ARC060E] 高橋君とホテル

## 题目描述

[problemUrl]: https://atcoder.jp/contests/arc060/tasks/arc060_c

$ N $ 軒のホテルが一直線上に並んでいます。$ i\ \,\ (1\ \leq\ i\ \leq\ N) $ 番目のホテルは、座標 $ x_i $ に位置しています。

旅行者である高橋君には、次の $ 2 $ つの信念があります。

- 高橋君の $ 1 $ 日の移動距離は $ L $ を超えない。
- 高橋君は野宿をしない。すなわち、$ 1 $ 日の終わりには必ずいずれかのホテルにいなければならない。

$ Q $ 個のクエリが与えられます。$ j\,(1\ \leq\ j\ \leq\ Q) $ 番目のクエリとして、異なる $ 2 $ つの整数 $ a_j,\,b_j $ が与えられます。 各クエリについて、前述の信念をともに守った上で、高橋君が $ a_j $ 番目のホテルから $ b_j $ 番目のホテルに移動するために必要な最小日数を求めてください。 なお、高橋君が $ a_j $ 番目のホテルから $ b_j $ 番目のホテルに移動できることは保証されます。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ x_1 $ $ x_2 $ $ ... $ $ x_N $ $ L $ $ Q $ $ a_1 $ $ b_1 $ $ a_2 $ $ b_2 $ : $ a_Q $ $ b_Q $

## 输出格式

出力は $ Q $ 行からなる。 $ j\ \,\ (1\ \leq\ j\ \leq\ Q) $ 行目には、高橋君が $ a_j $ 番目のホテルから $ b_j $ 番目のホテルに移動するために必要な最小日数を表す整数を出力せよ。

## 说明/提示

### 制約

- $ 2\ \leq\ N\ \leq\ 10^5 $
- $ 1\ \leq\ L\ \leq\ 10^9 $
- $ 1\ \leq\ Q\ \leq\ 10^5 $
- $ 1\ \leq\ x_i\ <\ x_2\ <\ ...\ <\ x_N\ \leq\ 10^9 $
- $ x_{i+1}\ -\ x_i\ \leq\ L $
- $ 1\ \leq\ a_j,b_j\ \leq\ N $
- $ a_j\ \neq\ b_j $
- $ N,\,L,\,Q,\,x_i,\,a_j,\,b_j $ はいずれも整数である

### 部分点

- $ N\ \leq\ 10^3 $ および $ Q\ \leq\ 10^3 $ を満たすデータセットに正解した場合は、$ 200 $ 点が与えられる。

### Sample Explanation 1

$ 1 $ つ目のクエリでは、次のように行動することで、$ 1 $ 番目のホテルから $ 8 $ 番目のホテルへ $ 4 $ 日間で移動することができます。 - $ 1 $ 日目には、$ 1 $ 番目のホテルから $ 2 $ 番目のホテルへ移動する。この日の移動距離は $ 2 $ である。 - $ 2 $ 日目には、$ 2 $ 番目のホテルから $ 4 $ 番目のホテルへ移動する。この日の移動距離は $ 10 $ である。 - $ 3 $ 日目には、$ 4 $ 番目のホテルから $ 7 $ 番目のホテルへ移動する。この日の移動距離は $ 6 $ である。 - $ 4 $ 日目には、$ 7 $ 番目のホテルから $ 8 $ 番目のホテルへ移動する。この日の移動距離は $ 10 $ である。

## 样例 #1

### 输入

```
9

1 3 6 13 15 18 19 29 31

10

4

1 8

7 3

6 7

8 5
```

### 输出

```
4

2

1

2
```



---

---
title: "[ARC121C] Odd Even Sort"
layout: "post"
diff: 普及+/提高
pid: AT_arc121_c
tag: ['贪心', '枚举', '排序', '构造']
---

# [ARC121C] Odd Even Sort

## 题目描述

[problemUrl]: https://atcoder.jp/contests/arc121/tasks/arc121_c

$ (1,2,\ \ldots,\ N) $ を並び替えた数列 $ p $ が与えられます。 はじめ、$ p $ の第 $ n $ 項は $ p_{n} $ です。

あなたの目的は $ N^2 $ 回以下 *操作* を行い $ p $ を昇順に並び替えることです。 あなたは操作により以下のように $ p $ を変更することができます。

- **奇数** 回目の操作では $ 1 $ 以上 $ N-1 $ 以下の **奇数** $ n $ を選んで $ p_n $ と $ p_{n+1} $ を入れ替えます。
- **偶数** 回目の操作では $ 2 $ 以上 $ N-1 $ 以下の **偶数** $ n $ を選んで $ p_n $ と $ p_{n+1} $ を入れ替えます。

この問題の制約下で必ず目的を達成できることが証明できます。 そのような操作列を $ 1 $ つ求めてください。

$ T $ 個のテストケースが与えられるのでそれぞれについて答えを求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ T $ $ \mathrm{case}_{1} $ $ \vdots $ $ \mathrm{case}_{T} $

各テストケースは以下の形式で与えられる。

> $ N $ $ p_1 $ $ \cdots $ $ p_N $

## 输出格式

$ T $ 個のテストケースについて与えられた順番に以下の形式で答えを出力せよ。

> $ M $ $ a_1 $ $ \cdots $ $ a_M $

$ M $ は操作列の長さを表し、$ a_i $ は $ i $ 回目の操作で選んだ整数を表す。

全てのテストケースにおいて目的が達成される操作列が出力されたならば正解となる。

## 说明/提示

### 制約

- 与えられる入力は全て整数
- $ 1\ \leq\ T\ \leq\ 250 $
- $ 2\ \leq\ N\ \leq\ 500 $
- $ 1\ \leq\ p_i\ \leq\ N $
- $ p $ は $ (1,2,\ldots,N) $ を並び替えて得られる。
- $ 1 $ つの入力ファイルにおいて $ N $ の総和は $ 500 $ を超えない。

### Sample Explanation 1

\- $ 1 $ つ目のテストケースについて説明します。 - $ 1 $ 回目の操作で $ 1 $ を選ぶと $ p $ は $ (1,2,3,5,4) $ となります。 - $ 2 $ 回目の操作で $ 4 $ を選ぶと $ p $ は $ (1,2,3,4,5) $ となります。 - $ (1,4) $ は操作列として正しいですが、$ (4,1) $ は操作列として正しくないことに注意してください。 - 操作を $ 1 $ 度も行わなくともよいこと、操作回数を最小にする必要はないことに注意してください。

## 样例 #1

### 输入

```
2

5

2 1 3 5 4

2

1 2
```

### 输出

```
2

1 4

0
```



---

---
title: "[ARC130C] Digit Sum Minimization"
layout: "post"
diff: 普及+/提高
pid: AT_arc130_c
tag: ['贪心', '枚举', '分类讨论']
---

# [ARC130C] Digit Sum Minimization

## 题目描述

[problemUrl]: https://atcoder.jp/contests/arc130/tasks/arc130_c

正の整数 $ a,\ b $ が与えられます。ただし、$ a,\ b $ のどの桁も $ 0 $ ではありません。

$ a+b $ の各桁の和が最小になるように、$ a $, $ b $ のそれぞれの桁を並べ替えてください。

## 输入格式

入力は以下の形式で標準入力から与えられます。

> $ a $ $ b $

## 输出格式

$ a+b $ の各桁の和が最小になるように $ a $, $ b $ のそれぞれの桁を並べ替えて、$ 1 $ 行目に $ a $ を、$ 2 $ 行目に $ b $ を出力してください。

答が複数考えられる場合には、そのどれを出力しても正解となります。

## 说明/提示

### 制約

- $ 1\leq\ a,\ b\ <\ 10^{100000} $
- $ a,\ b $ のどの桁も $ 0 $ ではない

### Sample Explanation 1

$ 532\ +\ 268\ =\ 800 $ で、その各桁の和は $ 8+0+0=8 $ となります。 他にも、$ (a,\ b)\ =\ (325,\ 682) $ を出力しても正解となります。

### Sample Explanation 2

$ 435+565=1000 $ で、その各桁の和は $ 1+0+0+0=1 $ となります。

### Sample Explanation 3

$ 312\ +\ 799788\ =\ 800100 $ で、その各桁の和は $ 8+0+0+1+0+0=9 $ となります。

## 样例 #1

### 输入

```
253

286
```

### 输出

```
532

268
```

## 样例 #2

### 输入

```
345

556
```

### 输出

```
435

565
```

## 样例 #3

### 输入

```
123

987987
```

### 输出

```
312

799788
```

## 样例 #4

### 输入

```
11111111111111111111

111111111111111111111111111111
```

### 输出

```
11111111111111111111

111111111111111111111111111111
```



---

---
title: "[ARC157B] XYYYX"
layout: "post"
diff: 普及+/提高
pid: AT_arc157_b
tag: ['贪心']
---

# [ARC157B] XYYYX

## 题目描述

[problemUrl]: https://atcoder.jp/contests/arc157/tasks/arc157_b

`X`, `Y` からなる長さ $ N $ の文字列 $ S $ が与えられます． $ S $ 中の相異なる位置にある $ K $ 文字を選び，選んだ文字が `X` であれば `Y` に，`Y` であれば `X` にそれぞれ置き換えます． 置き換えた後の文字列中で `Y` 同士が隣り合う箇所は最大でいくつになるかを求めてください．

## 输入格式

入力は以下の形式で標準入力から与えられる．

> $ N $ $ K $ $ S $

## 输出格式

置き換えた後の文字列中で `Y` 同士が隣り合う箇所の個数の最大値を出力せよ．

## 说明/提示

### 制約

- $ 1\ \leq\ N\ \leq\ 2\ \times\ 10^5 $
- $ 0\ \leq\ K\ \leq\ N $
- $ S $ は `X`, `Y` からなる長さ $ N $ の文字列である．
 
### Sample Explanation 1

選ぶのは $ 1 $ 文字だけです． - $ 1 $ 文字目を選ぶと，置き換えた後の文字列は `YYXYX` となり，$ 1,\ 2 $ 文字目の $ 1 $ 箇所で `Y` 同士が隣り合っています． - $ 2 $ 文字目を選ぶと，置き換えた後の文字列は `XXXYX` となり，`Y` 同士が隣り合っている箇所はありません． - $ 3 $ 文字目を選ぶと，置き換えた後の文字列は `XYYYX` となり，$ 2,\ 3 $ 文字目と $ 3,\ 4 $ 文字目の $ 2 $ 箇所で `Y` 同士が隣り合っています． - $ 4 $ 文字目を選ぶと，置き換えた後の文字列は `XYXXX` となり，`Y` 同士が隣り合っている箇所はありません． - $ 5 $ 文字目を選ぶと，置き換えた後の文字列は `XYXYY` となり，$ 4,\ 5 $ 文字目の $ 1 $ 箇所で `Y` 同士が隣り合っています． 以上より，求める最大値は $ 2 $ です．

### Sample Explanation 2

$ 1,\ 2,\ 3,\ 5 $ 文字目を選んで `YXYYY` とするか，$ 1,\ 3,\ 4,\ 5 $ 文字目を選んで `YYYXY` とするのが最適です． 同じ位置にある文字を複数回選ぶことはできないことに注意してください．

## 样例 #1

### 输入

```
5 1

XYXYX
```

### 输出

```
2
```

## 样例 #2

### 输入

```
5 4

XYXYX
```

### 输出

```
2
```



---

---
title: "[ARC161D] Everywhere is Sparser than Whole (Construction)"
layout: "post"
diff: 普及+/提高
pid: AT_arc161_d
tag: ['图论', '贪心', '构造']
---

# [ARC161D] Everywhere is Sparser than Whole (Construction)

## 题目描述

[problemUrl]: https://atcoder.jp/contests/arc161/tasks/arc161_d

頂点集合が空でない単純無向グラフの**密度**を $ \displaystyle\frac{(辺数)}{(頂点数)} $ と定義します．

正整数 $ N,\ D $ が与えられます． $ N $ 頂点 $ DN $ 辺の単純無向グラフ $ G $ であって，以下の条件を満たすものが存在するかどうかを判定し，存在するならそのようなグラフを $ 1 $ つ求めてください．

**条件:** $ G $ の頂点集合を $ V $ とする． $ V $ の任意の空でない**真**部分集合 $ X $ に対して，$ X $ による $ G $ の誘導部分グラフの密度は $ D $ **未満**である．

 誘導部分グラフとは

 グラフ $ G $ の頂点部分集合 $ X $ に対して，$ X $ による $ G $ の**誘導部分グラフ**とは，「頂点集合が $ X $ であり，辺集合が『 $ G $ の辺であって $ X $ 内の $ 2 $ 頂点を結ぶもの全体』であるグラフ」を指します． 上記の条件では，頂点部分集合として空集合でも全体でもないもののみを考えていることに注意してください．

## 输入格式

入力は以下の形式で標準入力から与えられる．

> $ N $ $ D $

## 输出格式

条件を満たす単純無向グラフが存在するなら `Yes` を，存在しないなら `No` を出力せよ． さらに，`Yes` の場合には，続く $ DN $ 行に条件を満たすグラフを以下の形式で出力せよ． 条件を満たすグラフが複数存在する場合，そのようなグラフのうちどれを出力しても正答と見なされる．

> $ A_1 $ $ B_1 $ $ A_2 $ $ B_2 $ $ \vdots $ $ A_{DN} $ $ B_{DN} $

- $ 1\ \leq\ A_i,\ B_i\ \leq\ N\ (1\ \leq\ i\ \leq\ DN) $
- $ A_i\ \neq\ B_i\ (1\ \leq\ i\ \leq\ DN) $
- $ \{A_i,\ B_i\}\ \neq\ \{A_j,\ B_j\}\ (1\ \leq\ i\ <\ j\ \leq\ DN) $
- グラフの頂点には $ 1 $ から $ N $ までの番号が付いているものとする．
- $ i $ 行目の出力は，$ i $ 番目の辺が頂点 $ A_i $ と頂点 $ B_i $ を結んでいることを表す．
- 辺の順番（どの辺を何番目に出力するか）や頂点の順番（各辺についてどちらの端点を先に出力するか）は自由である．

## 说明/提示

### 制約

- $ N\ \geq\ 1 $
- $ D\ \geq\ 1 $
- $ DN\ \leq\ 5\ \times\ 10^4 $
 
### Sample Explanation 1

出力されたグラフの頂点集合は $ \{1,\ 2,\ 3\} $，辺集合は $ \{(1,\ 2),\ (1,\ 3),\ (2,\ 3)\} $ であり，単純です． 頂点集合の空でない真部分集合 $ X $ としては $ \{1\},\ \{2\},\ \{3\},\ \{1,\ 2\},\ \{1,\ 3\},\ \{2,\ 3\} $ の $ 6 $ 通りが考えられ， - $ X\ =\ \{1\},\ \{2\},\ \{3\} $ のとき，$ X $ による誘導部分グラフの辺集合は空集合であり，その密度は $ \displaystyle\frac{0}{1}\ =\ 0 $， - $ X\ =\ \{1,\ 2\},\ \{1,\ 3\},\ \{2,\ 3\} $ のとき，$ X $ による誘導部分グラフの辺集合はそれぞれ $ \{(1,\ 2)\},\ \{(1,\ 3)\},\ \{(2,\ 3)\} $ であり，いずれも密度は $ \displaystyle\frac{1}{2} $ です． 全ての場合に対して誘導部分グラフの密度は $ D\ =\ 1 $ 未満であり，このグラフは条件を満たします．

### Sample Explanation 2

$ 4 $ 頂点 $ 8 $ 辺の単純無向グラフは存在しません．

## 样例 #1

### 输入

```
3 1
```

### 输出

```
Yes

1 2

1 3

2 3
```

## 样例 #2

### 输入

```
4 2
```

### 输出

```
No
```



---

---
title: "[ARC162C] Mex Game on Tree"
layout: "post"
diff: 普及+/提高
pid: AT_arc162_c
tag: ['贪心', '博弈论']
---

# [ARC162C] Mex Game on Tree

## 题目描述

[problemUrl]: https://atcoder.jp/contests/arc162/tasks/arc162_c

頂点に $ 1 $ から $ N $ の番号がついた $ N $ 頂点の根付き木が与えられます。頂点 $ 1 $ が根であり、頂点 $ i\ (2\leq\ i\ \leq\ N) $ の親は $ P_i $ です。

根付き木の何個かの頂点には $ 0 $ 以上 $ N $ 以下の整数が書かれています。この情報は数列 $ A=(A_1,A_2,\ldots,A_N) $ で与えられ、$ A_i\ \neq\ -1 $ の場合頂点 $ i $ に整数 $ A_i $ が書かれており、$ A_i=-1 $ の場合頂点 $ i $ には整数が書かれていないことを意味しています。

Alice と Bob でゲームをします。Alice が先手で、全ての頂点に整数が書かれるまで以下の操作を交互に繰り返します。

- 整数が書かれていない頂点を $ 1 $ 個選び、 $ 0 $ 以上 $ N $ 以下の整数を書く。
 
操作終了後の各頂点 $ v $ に対して、 $ f(v) $ を「頂点 $ v $ の部分木に含まれるどの頂点（$ v $ 含む）にも書かれていないような最小の非負整数」と定めます。

$ f(v)\ =\ K $ を満たす頂点 $ v $ が存在する場合 Alice の勝利、そうでない場合 Bob の勝利となります。両者が最適な行動を行う場合、どちらが勝つか判定してください。

$ T $ 個のテストケースが与えられるので、それぞれについて答えてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ T $ $ \mathrm{case}_1 $ $ \vdots $ $ \mathrm{case}_T $

各ケースは以下の形式で与えられる。

> $ N $ $ K $ $ P_2 $ $ P_3 $ $ \ldots $ $ P_N $ $ A_1 $ $ A_2 $ $ \ldots $ $ A_N $

## 输出格式

$ T $ 行出力せよ。$ i\ (1\leq\ i\ \leq\ T) $ 行目には、 $ i $ 番目のテストケースについて、両者が最適な行動を行う場合 Alice が勝つならば `Alice` を、Bob が勝つならば `Bob` を出力せよ。

## 说明/提示

### 制約

- $ 1\ \leq\ T\ \leq\ 10^3 $
- $ 2\ \leq\ N\ \leq\ 10^3 $
- $ 0\ \leq\ K\ \leq\ N $
- $ 1\ \leq\ P_i\ <\ i\ (2\leq\ i\leq\ N) $
- $ -1\ \leq\ A_i\ \leq\ N\ (1\leq\ i\leq\ N) $
- 入力される数値は全て整数
- $ 1 $ つの入力に含まれるテストケースについて、$ N $ の総和は $ 2\times\ 10^3 $ 以下
 
### Sample Explanation 1

$ 1 $ 番目のテストケースについては、Alice が頂点 $ 2 $ に $ 0 $ を書き込むと、Bob の操作に依らず $ f(2)\ =\ 2 $ となります。そのため、Alice は勝つことができます。 $ 2 $ 番目のテストケースについては、Bob が上手く書き込む整数を選ぶことで、 $ f(v)\ =\ 4 $ なる頂点が存在しないようにできます。

## 样例 #1

### 输入

```
2

4 2

1 1 2

-1 -1 3 1

6 4

1 2 2 1 3

-1 -1 -1 -1 -1 -1
```

### 输出

```
Alice

Bob
```



---

---
title: "[ARC164C] Reversible Card Game"
layout: "post"
diff: 普及+/提高
pid: AT_arc164_c
tag: ['贪心', '博弈论']
---

# [ARC164C] Reversible Card Game

## 题目描述

[problemUrl]: https://atcoder.jp/contests/arc164/tasks/arc164_c

両面に数が書かれた $ N $ 枚のカードがあり、$ i $ 枚目のカードには片方の面に赤い数字で $ A_i $ が、もう片方の面には青い数字で $ B_i $ が書かれています。初め、全てのカードは赤い数字が書かれた面を表にして置かれており、Alice と Bob は次のような手順を繰り返すゲームをします。

- まず、Alice が残っているカードの中から $ 1 $ 枚を選び、裏返す。次に、Bob が残っているカードの中から $ 1 $ 枚を取り除く。このとき、取り除いたカードの表側の面に書かれていた数の分だけ Bob は得点を得る。
 
残っているカードが $ 0 $ 枚になった時、ゲームを終了します。

Alice はゲーム終了時の Bob の得点を最小にしようとし、Bob はこれを最大にしようとします。両者が最善の手順を取ったとき、ゲーム終了時の Bob の得点は何点でしょうか。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ A_1 $ $ B_1 $ $ A_2 $ $ B_2 $ $ \vdots $ $ A_N $ $ B_N $

## 输出格式

答えを整数で出力せよ。

## 说明/提示

### 制約

- $ 1\leq\ N\leq\ 2\times\ 10^5 $
- $ 1\leq\ A_i,\ B_i\leq\ 10^9 $ $ (1\leq\ i\ \leq\ N) $
- 入力される値はすべて整数である
 
### Sample Explanation 1

初めの状態では、表側の面に書かれた数はそれぞれ $ 6,2,5 $ です。ここから、例えば次のような進行が考えられます。 1. Alice は $ 1 $ 枚目のカードを裏返す。このとき、表側の面に書かれた数は $ 4,2,5 $ となる。Bob は $ 3 $ 枚目のカードを取り除き、$ 5 $ 点を得る。 2. Alice は $ 2 $ 枚目のカードを裏返す。このとき、表側の面に書かれた数は $ 4,1 $ となる。Bob は $ 2 $ 枚目のカードを取り除き、$ 1 $ 点を得る。 3. Alice は最後に残った $ 1 $ 枚目のカードを裏返す。このとき、表側の面に書かれた数は $ 6 $ となる。Bob はこれを取り除き、$ 6 $ 点を得る。 この場合、Bob が最終的に得る得点は $ 12 $ 点です。実は、この進行は双方の最善手の一例であり、答えは $ 12 $ となります。

## 样例 #1

### 输入

```
3

6 4

2 1

5 3
```

### 输出

```
12
```

## 样例 #2

### 输入

```
5

166971716 552987438

219878198 619875818

918378176 518975015

610749017 285601372

701849287 307601390
```

### 输出

```
3078692091
```



---

---
title: "[ARC165B] Sliding Window Sort 2"
layout: "post"
diff: 普及+/提高
pid: AT_arc165_b
tag: ['贪心', '二分']
---

# [ARC165B] Sliding Window Sort 2

## 题目描述

[problemUrl]: https://atcoder.jp/contests/arc165/tasks/arc165_b

$ 1 $ から $ N $ までの整数からなる順列 $ P=(P_1,P_2,\dots,P_N) $ と整数 $ K $ が与えられます。

順列 $ P $ に対して以下のような操作を考えます。

- $ 1\ \leq\ i\ \leq\ N-K+1 $ を満たす整数 $ i $ を $ 1 $ つ選び、 $ P_i,P_{i+1},\dots,P_{i+K-1} $ を昇順に並び替える。すなわち、$ P_i,P_{i+1},\dots,P_{i+K-1} $ を小さい方から順に並べたものを $ (x_1,x_2,\dots,x_K) $ としたとき、各 $ 1\ \leq\ j\ \leq\ K $ に対して $ P_{i+j-1} $ を $ x_j $ で置き換える。
 
$ P $ に対して上記の操作をちょうど $ 1 $ 回行うことで得られる順列のうち、辞書式順序最大のものを求めてください。

  数列の辞書順とは？数列 $ S\ =\ (S_1,S_2,\ldots,S_{|S|}) $ が数列 $ T\ =\ (T_1,T_2,\ldots,T_{|T|}) $ より**辞書順で小さい**とは、下記の 1. と 2. のどちらかが成り立つことを言います。 ここで、$ |S|,\ |T| $ はそれぞれ $ S,\ T $ の長さを表します。

1. $ |S|\ \lt\ |T| $ かつ $ (S_1,S_2,\ldots,S_{|S|})\ =\ (T_1,T_2,\ldots,T_{|S|}) $。
2. ある整数 $ 1\ \leq\ i\ \leq\ \min\lbrace\ |S|,\ |T|\ \rbrace $ が存在して、下記の $ 2 $ つがともに成り立つ。 
  - $ (S_1,S_2,\ldots,S_{i-1})\ =\ (T_1,T_2,\ldots,T_{i-1}) $
  - $ S_i $ が $ T_i $ より（数として）小さい。

## 输入格式

入力は以下の形式で標準入力から与えられます。

> $ N $ $ K $ $ P_1 $ $ P_2 $ $ \dots $ $ P_N $

## 输出格式

$ P $ に対して操作をちょうど $ 1 $ 回行うことで得られる順列のうち、辞書式順序で最大のものを空白区切りで出力してください。

## 说明/提示

### 制約

- $ 1\ \leq\ K\ \leq\ N\ \leq\ 2\ \times\ 10^5 $
- $ 1\ \leq\ P_i\ \leq\ N $
- $ (P_1,P_2,\dots,P_N) $ は $ 1 $ から $ N $ までの整数からなる順列
- 入力される値はすべて整数
 
### Sample Explanation 1

$ i=1 $ として操作を行うと $ (P_1,P_2,P_3)=(2,1,4) $ であり、これを昇順に並び替えると $ (1,2,4) $ となります。よって操作によって $ P_1,P_2,P_3 $ はそれぞれ $ 1,2,4 $ に置き換えられ、 $ P=(1,2,4,3) $ となります。同様に $ i=2 $ として操作を行うと $ P $ は $ (2,1,3,4) $ となります。 これらのうち辞書式順序で大きいのは $ (2,1,3,4) $ であるため、答えは $ (2,1,3,4) $ となります。

## 样例 #1

### 输入

```
4 3

2 1 4 3
```

### 输出

```
2 1 3 4
```

## 样例 #2

### 输入

```
5 1

3 1 4 2 5
```

### 输出

```
3 1 4 2 5
```

## 样例 #3

### 输入

```
20 7

9 4 3 1 11 12 13 15 17 7 2 5 6 20 19 18 8 16 14 10
```

### 输出

```
9 4 3 1 11 12 13 15 17 7 2 5 6 8 18 19 20 16 14 10
```



---

---
title: "[ARC165C] Social Distance on Graph"
layout: "post"
diff: 普及+/提高
pid: AT_arc165_c
tag: ['贪心', '二分', '生成树', '二分图']
---

# [ARC165C] Social Distance on Graph

## 题目描述

[problemUrl]: https://atcoder.jp/contests/arc165/tasks/arc165_c

頂点に $ 1 $ から $ N $ の番号が付いた $ N $ 頂点からなる単純連結無向グラフがあります。グラフには重みを持つ辺が $ M $ 本あり、$ i $ 番目の辺は頂点 $ A_i,B_i $ を結ぶ重みが $ W_i $ の辺です。また、$ 2 $ 頂点を結ぶ単純パスの重みを、単純パスが含む辺の重みの総和とします。

各頂点に対し赤、青のいずれかの色を塗ります。以下の条件を満たす塗り分け方が存在するような整数 $ X $ の最大値を求めてください。

- 同じ色で塗られた相異なる $ 2 $ 頂点を結ぶどの単純パスについても、単純パスの重みは $ X $ 以上である。
 
  単純パスとは グラフ $ G $ 上の頂点 $ X,Y $ に対して、頂点列 $ v_1,v_2,\ \ldots,\ v_k $ であって、 $ v_1=X $, $ v_k=Y $ かつ、$ 1\leq\ i\leq\ k-1 $ に対して $ v_i $ と $ v_{i+1} $ が辺で結ばれているようなものを頂点 $ X $ から頂点 $ Y $ への **ウォーク** と呼びます。 さらに、$ v_1,v_2,\ \ldots,\ v_k $ がすべて異なるようなものを頂点 $ X $ から頂点 $ Y $ への **単純パス** (あるいは単に **パス**) と呼びます。

## 输入格式

入力は以下の形式で標準入力から与えられます。

> $ N $ $ M $ $ A_1 $ $ B_1 $ $ W_1 $ $ A_2 $ $ B_2 $ $ W_2 $ $ \vdots $ $ A_M $ $ B_M $ $ W_M $

## 输出格式

答えを出力してください。

## 说明/提示

### 制約

- $ 3\ \leq\ N\ \leq\ 2\ \times\ 10^5 $
- $ N-1\ \leq\ M\ \leq\ \min(\frac{N(N-1)}{2},2\ \times\ 10^5) $
- $ 1\ \leq\ A_i\ <\ B_i\ \leq\ N $
- $ 1\ \leq\ W_i\ \leq\ 10^9 $
- 与えられるグラフは単純連結無向グラフ
- 入力される値はすべて整数
 
### Sample Explanation 1

$ X=11 $ としたときに条件を満たす色の塗り方が存在するか考えます。頂点 $ 1,3 $ を赤、頂点 $ 2 $ を青で塗った場合、同じ色の頂点を結ぶ単純パス $ 1-2-3 $ の重みが $ 5+6=11 $ となります。これが同じ色の頂点を結ぶ単純パスの重みの最小値となるのでこの塗り分け方は条件を満たしています。 $ X $ が $ 12 $ 以上のとき、条件を満たす塗り分け方が存在しないことが示せます。よって答えは $ 11 $ となります。

## 样例 #1

### 输入

```
3 3

1 2 5

2 3 6

1 3 12
```

### 输出

```
11
```

## 样例 #2

### 输入

```
10 20

7 10 982219000

3 10 968366179

2 4 992330437

5 6 984414664

2 8 897295423

7 9 155604979

6 8 958833005

2 3 973209957

3 7 985173062

6 10 963895817

2 10 986243534

4 5 721724794

1 3 657562445

1 6 566370694

1 4 988050146

1 9 967817807

4 9 796531581

5 9 983960054

1 10 964450079

8 9 959369491
```

### 输出

```
952136560
```

## 样例 #3

### 输入

```
10 20

5 6 871895994

8 10 873709822

3 5 454175869

6 10 980782191

2 6 901290987

1 8 298092290

4 8 693116157

4 5 947939338

7 8 934395075

7 9 759563833

5 8 779870031

4 6 919637355

2 9 822858749

4 10 855497285

3 7 954942051

1 2 950411658

4 7 665939990

3 4 634533617

5 7 908372507

1 9 591466693
```

### 输出

```
759563833
```



---

---
title: "[ARC172A] Chocolate"
layout: "post"
diff: 普及+/提高
pid: AT_arc172_a
tag: ['贪心']
---

# [ARC172A] Chocolate

## 题目描述

你有一个大小为 $H \times W$ 的格子状矩形，你需要判断是否能把它从格子处分成 $N$ 个正方形，满足第 $i$ 个正方形的边长为 $2^{A_i}$，可以有剩余。

## 输入格式

第一行三个正整数 $H W N$，表示矩形的大小和需要分成的正方形的数量。

第二行 $N$ 个自然数，第 $i$ 个数为 $A_i$ 表示第 $i$ 个正方形的边长为 $2^{A_i}$。

## 输出格式

如果存在一种合法的方案，输出`Yes`，否则输出`No`。

## 样例 #1

### 输入

```
4 4 4

1 0 0 1
```

### 输出

```
Yes
```

## 样例 #2

### 输入

```
5 7 6

0 1 0 2 0 1
```

### 输出

```
Yes
```

## 样例 #3

### 输入

```
3 2 7

0 0 0 0 0 0 0
```

### 输出

```
No
```

## 样例 #4

### 输入

```
11 11 2

2 3
```

### 输出

```
No
```

## 样例 #5

### 输入

```
777 777 6

8 6 9 1 2 0
```

### 输出

```
Yes
```



---

---
title: "[ARC176A] 01 Matrix Again"
layout: "post"
diff: 普及+/提高
pid: AT_arc176_a
tag: ['贪心', '构造']
---

# [ARC176A] 01 Matrix Again

## 题目描述

给定一个 $N \times N$ 的矩阵，你需要向其中填入 $0$ 或 $1$，使其满足以下条件：

- $(A_1,B_1),(A_2,B_2),...,(A_M,B_M)$ 处的值为 $1$。
- 第 $i$ 行的所有数字之和为 $M$ $(1 \le i \le N)$。
- 第 $i$ 列的所有数字之和为 $M$ $(1 \le i \le N)$。

## 输入格式

第一行有两个整数 $N$ 和 $M$。

接下来有 $M$ 行，第 $i+1$ 行有两个整数 $A_i$ 和 $B_i$。

## 输出格式

第一行输出矩阵中 $1$ 的个数 $k$。

接下来有 $k$ 行，第 $i+1$ 行输出两个整数 $x_i$ 和 $y_i$，表示 $(x_i,y_i)$ 处的值为 $1$。（顺序任意）

## 样例 #1

### 输入

```
4 2

1 4

3 2
```

### 输出

```
8

1 2

1 4

2 1

2 4

3 2

3 3

4 1

4 3
```

## 样例 #2

### 输入

```
3 3

3 1

2 3

1 3
```

### 输出

```
9

1 1

1 2

1 3

2 1

2 2

2 3

3 1

3 2

3 3
```

## 样例 #3

### 输入

```
7 3

1 7

7 6

6 1
```

### 输出

```
21

1 6

2 4

4 1

7 3

3 6

4 5

6 1

1 7

7 6

3 5

2 2

6 3

6 7

5 4

5 2

2 5

5 3

1 4

7 1

4 7

3 2
```



---

---
title: "[ARC184A] Appraiser"
layout: "post"
diff: 普及+/提高
pid: AT_arc184_a
tag: ['数学', '贪心', '构造']
---

# [ARC184A] Appraiser

## 题目描述

[problemUrl]: https://atcoder.jp/contests/arc184/tasks/arc184_a

この問題は **インタラクティブ** な問題であり、 **ジャッジは適応的(adaptive)** です。詳しくは注意点を参照してください。  
**また、問題文中のパラメータは $ N=1000,M=10,Q=950 $ で固定されています。**

硬貨が $ N $ 枚あり、 $ 1,2,\dots,N $ の番号が付けられています。  
これらの硬貨のうち、丁度 $ M $ 枚が偽物です。

鑑定士は $ 1 $ 度の鑑定で $ 2 $ つの硬貨が同種か異種かを判定できます。厳密には、

- $ 2 $ つの硬貨が「双方とも本物」「双方とも偽物」のどちらかであれば、同種と判定する。
- そうでないとき、異種と判定する。

$ Q $ 回以下の鑑定で、全ての偽物の硬貨を特定してください。

### Input &amp; Output Format

この問題はインタラクティブな問題です。  
最初に、 $ N,M,Q $ を標準入力から受け取ってください。

> $ N $ $ M $ $ Q $

次に、以下の流れで鑑定を $ 0 $ 回以上 $ Q $ 回以下行ってください。

まず、次の形式で標準出力に出力することで、硬貨 $ x,y $ を鑑定することを表します。 (末尾に改行を入れること。)

> ? $ x $ $ y $

ここで、 $ x,y $ は $ 1 $ 以上 $ N $ 以下の相異なる整数である必要があります。

これに対するジャッジシステムの応答は、以下の $ 3 $ 通りです。

```
0
```

応答が `0` であるとき、硬貨 $ x,y $ が同種であることを表します。

```
1
```

応答が `1` であるとき、硬貨 $ x,y $ が異種であることを表します。

```
-1
```

応答が `-1` であるとき、不当な鑑定であることを表します。具体的には

- 出力した $ x,y $ が制約を満たさなかった
- $ Q $ 回を超えて鑑定が行われた

の少なくともひとつが満たされた際にこの応答を行います。  
この応答を受け取った場合、プログラムはすでに不正解とみなされています。直ちにプログラムを終了してください。

最後に、次の形式で標準出力に出力することで、硬貨 $ A_1,A_2,\dots,A_{M} $ が偽物であると解答します。 (末尾に改行を入れること。)

> ! $ A_1 $ $ A_2 $ $ \dots $ $ A_{M} $

ここで、 $ A_i $ は $ 1 $ 以上 $ N $ 以下の相異なる整数である必要があります。  
この出力の後、直ちにプログラムを終了してください。

なお、全ての出力について、出力が指定された形式を満たさなかった場合もプログラムが不正解とみなされます。 その後 `-1` が返答されるので、その場合も直ちにプログラムを終了してください。

## 说明/提示

### 制約

- $ \color{red}{N\ =\ 1000} $
- $ \color{red}{M\ =\ 10} $
- $ \color{red}{Q\ =\ 950} $

### 注意点

- **出力を行うたびに、末尾に改行を入れて標準出力を flush してください。** そうしなかった場合、ジャッジ結果が TLE や WA となる可能性があります。
- 解答を出力したら (または `-1` を受け取ったら) ただちにプログラムを終了してください。そうしない場合、ジャッジ結果は不定です。
- 余計な改行は不正なフォーマットの出力とみなされることに注意してください。
- **この問題のジャッジシステムは、適応的(adaptive)です。** つまり、ジャッジシステムは、任意のタイミングにおいて、整合性がとれる限り、偽物の硬貨として想定しているものを変更する可能性があります。詳しくは入出力例も参照してください。

### 入出力例

この入力では $ N=5,M=2,Q=10 $ であり、ジャッジシステムは最初硬貨 $ 1,2 $ が偽物であると想定しています。

なお、この例は制約を満たさないので、ジャッジには含まれないことに注意してください。

入力出力説明`5 2 10`$ N,M,Q $ が与えられます。`? 1 2`硬貨 $ 1,2 $ について鑑定を行います。`0`硬貨 $ 1,2 $ は同種だと判定します。`? 1 3`硬貨 $ 1,3 $ について鑑定を行います。`1`硬貨 $ 1,3 $ は異種だと判定します。`? 1 4`硬貨 $ 1,4 $ について鑑定を行います。`1`硬貨 $ 1,4 $ は異種だと判定します。`! 1 2`硬貨 $ 1,2 $ が偽物だと解答します。確かに硬貨 $ 1,2 $ は偽物だと想定されていますが、硬貨 $ 3,4 $ を偽物であると想定しても整合性が取れます。  
よって、ジャッジシステムは偽物の硬貨として想定しているものを硬貨 $ 3,4 $ に変更できます。  
これにより、ジャッジシステムは不正解の判定を下すこともあります。



---

---
title: "長いだけのネクタイ (Just Long Neckties)"
layout: "post"
diff: 普及+/提高
pid: AT_joi2020ho_a
tag: ['贪心']
---

# 長いだけのネクタイ (Just Long Neckties)

## 题目描述

[problemUrl]: https://atcoder.jp/contests/joi2020ho/tasks/joi2020ho_a

あなたは Just Odd Inventions 社を知っているだろうか？この会社の業務は「ただ奇妙な発明 (just odd inventions)」をすることである．ここでは略して JOI 社と呼ぶ．

JOI 社は新商品「長いだけのネクタイ」を開発した．ネクタイは $ N\ +\ 1 $ 種類あり，各種類には $ 1 $ から $ N\ +\ 1 $ までの番号がついている．$ i $ 番目 ($ 1\ \leqq\ i\ \leqq\ N\ +\ 1 $) の種類のネクタイの長さは $ A_i $ である．

JOI 社は社員を集め，ネクタイの試着会を行うことにした．試着会には $ N $ 人の社員が参加し，$ j $ 人目 ($ 1\ \leqq\ j\ \leqq\ N $) の社員がはじめに付けているネクタイの長さは $ B_j $ である．

試着会は以下の手順で行われる予定である．

1. まず，試着会で使わないネクタイを $ 1 $ 種類選ぶ．
2. 次に，各社員はそれ以外のネクタイから試着するネクタイを $ 1 $ 種類選ぶ．ただし，どの $ 2 $ 人も同じ種類のネクタイを選ばないようにする．
3. 最後に，各社員は今付けているネクタイを外し，先ほど選んだネクタイを試着する．

長さ $ b $ のネクタイを付けていた社員が，長さ $ a $ のネクタイを試着すると大きさ $ \max\{a\ −\ b,\ 0\} $ の奇妙さを感じる．(ここで，$ \max\{a\ −\ b,\ 0\} $ は，$ a\ -\ b $ と $ 0 $ のうち小さくない方を表す．) 試着会において各社員の感じる奇妙さの最大値を，その試着会の**奇妙さ**とする．

試着会で使わないネクタイが $ k $ 番目の種類のネクタイのとき，試着会の奇妙さとして考えられる最小の値を $ C_k $ とする．

各種類のネクタイの長さ，各社員がはじめに付けているネクタイの長さが与えられた時，$ C_1,\ C_2,\ \ldots,\ C_{N\ +\ 1} $ の値を求めるプログラムを作成せよ．

- - - - - -

## 输入格式

入力は以下の形式で標準入力から与えられる．入力される値はすべて整数である．

> $ N $ $ A_1 $ $ \cdots $ $ A_{N\ +\ 1} $ $ B_1 $ $ \cdots $ $ B_N $

## 输出格式

$ C_1,\ C_2,\ \ldots,\ C_{N\ +\ 1} $ の値を，空白区切りで標準出力に $ 1 $ 行で出力せよ．

- - - - - -

## 说明/提示

### 制約

- $ 1\ \leqq\ N\ \leqq\ 200\,000 $.
- $ 1\ \leqq\ A_i\ \leqq\ 1\,000\,000\,000 $ ($ 1\ \leqq\ i\ \leqq\ N\ +\ 1 $)．
- $ 1\ \leqq\ B_j\ \leqq\ 1\,000\,000\,000 $ ($ 1\ \leqq\ j\ \leqq\ N $)．

### 小課題

1. ($ 1 $ 点) $ N\ \leqq\ 10 $.
2. ($ 8 $ 点) $ N\ \leqq\ 2\,000 $.
3. ($ 91 $ 点) 追加の制約はない.

- - - - - -

### Sample Explanation 1

例えば，試着会は次のように行われる． - $ 4 $ 番目の種類のネクタイを使わないことにする． - 社員 $ 1 $ が $ 1 $ 番目の，社員 $ 2 $ が $ 2 $ 番目の，社員 $ 3 $ が $ 3 $ 番目の種類のネクタイを選ぶ． - 各社員が試着する． このとき，各社員が感じる奇妙さは順に $ 2,\ 0,\ 3 $ となるから，この試着会の奇妙さは $ 3 $ である． 社員が選ぶネクタイを変えることで、試着会の奇妙さを $ 1 $ にすることができる．例えば，試着会を次のように行うとする． - $ 4 $ 番目の種類のネクタイを使わないことにする． - 社員 $ 1 $ が $ 2 $ 番目の，社員 $ 2 $ が $ 3 $ 番目の，社員 $ 3 $ が $ 1 $ 番目の種類のネクタイを選ぶ． - 各社員が試着する． このとき，各社員が感じる奇妙さは順に $ 1,\ 1,\ 0 $ となるから，この試着会の奇妙さは $ 1 $ である． これが $ 4 $ 番目の種類のネクタイを使わない場合の試着会の奇妙さの最小値なので，$ C_4\ =\ 1 $ である． - - - - - -

## 样例 #1

### 输入

```
3
4 3 7 6
2 6 4
```

### 输出

```
2 2 1 1
```

## 样例 #2

### 输入

```
5
4 7 9 10 11 12
3 5 7 9 11
```

### 输出

```
4 4 3 2 2 2
```



---


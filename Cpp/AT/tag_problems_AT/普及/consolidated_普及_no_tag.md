---
title: "[ABC012D] バスと避けられない運命"
layout: "post"
diff: 普及/提高-
pid: AT_abc012_4
tag: []
---

# [ABC012D] バスと避けられない運命

## 题目描述

高桥君，不太喜欢公共汽车。

但是，一进入社会，就无法避免乘坐公共汽车的行为。

进入社会后，从自家到公司，必须坐公共汽车上班。高桥君还没拿到录取单，不知道要进入哪家公司，自然也就不知道公司在哪儿。高桥君经常想象乘坐巴士情况。他只想象时间最长、最坏的情况。我想把乘坐这个最坏情况的巴士的时间搬到让高桥君上班时间尽量缩短的地方。

PS：最坏的情况是指，乘坐巴士的时间合计最短，选择所乘坐的巴士时，是指在坐公共汽车的时间合计会变长的位置有公司的情况。

另外，从家中去公司时，可以选择高桥乘坐的巴士，高桥君选择乘坐巴士的时间合计最短的路径。各巴士在 $2$ 个公交车站来回行驶，去、回所需时间没有差别。随时都可以乘坐巴士，可以忽略转乘所花费的时间等。

另外，自家和公司与公共汽车站相邻，不能步行到其他巴士站，也不能通过巴士以外的方法进行移动。为高桥君找个搬家的地方，请输出搬到那里时，要坐公交车时间的最大值。

## 输入格式

在第一行，以空格分隔提供表示停靠站数的整数 $N(2\le N\le 300)$ 和表示路线数量的整数 $M(N-1\le M\le 44850)$。

接下来的第 $2$ 行到 $M$ 行表示总线的信息。在第 $i$ 行中，表示与总线的出发地点往返的 $2$ 个停靠站的编号 $a_i,b_i(1\le a_i,b_i\le N,b_{i+1}\le a_i,b_i\le N)$，和表示该移动需要多少分钟的数字 $t_i(1\le t_i\le 1000)$，分别由整数给出。保障了不存在的巴士站的对不存在。保证 $a_i\ne b_i$。

在某 $2$ 个停靠站上往返的路线只有 $1$ 个。

## 输出格式

如题，注意末尾要换行。

感谢 @longtaoxuan 提供的翻译。

## 样例 #1

### 输入

```
3 2

1 2 10

2 3 10
```

### 输出

```
10
```

## 样例 #2

### 输入

```
5 5

1 2 12

2 3 14

3 4 7

4 5 9

5 1 18
```

### 输出

```
26
```

## 样例 #3

### 输入

```
4 6

1 2 1

2 3 1

3 4 1

4 1 1

1 3 1

4 2 1
```

### 输出

```
1
```



---

---
title: "[ABC015C] 高橋くんのバグ探し"
layout: "post"
diff: 普及/提高-
pid: AT_abc015_3
tag: []
---

# [ABC015C] 高橋くんのバグ探し

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc015/tasks/abc015_3

高橋くんは上司からあるアンケートアプリにバグがあるかどうか調べて欲しいと頼まれました。

このアプリは、ユーザに選択肢が $ K $ 個ある質問を $ N $ 回答えさせることにより、ユーザの性格を判定します。 質問や選択肢はユーザの回答によって変わらず一定であり、ユーザは全ての質問にちょうど $ 1 $ つの選択肢を選ぶことで、結果を閲覧できます。

全ての選択肢はある整数値を持ちます。このアプリは、ユーザによって選ばれた、全ての回答がそれぞれ保持する整数値の排他的論理和（XOR）を使って結果を算出します。計算の最後でこの値が $ 0 $ になってしまうと、結果が表示されずバグが発生してしまいます。

あなたには全ての選択肢が持つ整数値が与えられるので、高橋くんの代わりに、ユーザの選択によってはバグが発生する可能性があるかどうかを判定してください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ K $ $ T_{1,1} $ $ T_{1,2} $ … $ T_{1,K} $ $ T_{2,1} $ $ T_{2,2} $ … $ T_{2,K} $ : $ T_{N,1} $ $ T_{N,2} $ … $ T_{N,K} $

- $ 1 $ 行目には、質問の個数を表す整数 $ N\ (1≦N≦5) $ と、それぞれの質問に対する選択肢の個数を表す整数 $ K\ (1≦K≦5) $ が、スペース区切りで与えられる。
- $ 2 $ 行目から $ N $ 行は、選択肢が保持する整数値が、スペース区切りで与えられる。 このうち、 $ i $ 行目の $ j $ 番目にある整数 $ T_{i,j}\ (0≦T_{i,j}≦127) $ は、 $ i $ 番目の質問に対する $ j $ 番目の選択肢が保持する整数値である。

## 输出格式

バグが発生することがある場合は`Found`、そうでなければ`Nothing`を $ 1 $ 行で出力せよ。出力の末尾には改行をいれること。

## 说明/提示

### Sample Explanation 1

$ 1 $ つ目の質問で $ 1 $ つ目の選択肢を、$ 2 $ つ目の質問で $ 3 $ つ目の選択肢を、 $ 3 $ つ目の質問で、$ 2 $ つ目の選択肢を選んだとします。 すると、対応する数字はそれぞれ、 $ 1,2,3 $ となり、これらのXORを取ると、$ 0 $ となります。 よって、バグが発生してしまうため、`Found`と出力します。

### Sample Explanation 2

バグの発生する回答の組み合わせはありません。

## 样例 #1

### 输入

```
3 4

1 3 5 17

2 4 2 3

1 3 2 9
```

### 输出

```
Found
```

## 样例 #2

### 输入

```
5 3

89 62 15

44 36 17

4 24 24

25 98 99

66 33 57
```

### 输出

```
Nothing
```



---

---
title: "[ABC016D] 一刀両断"
layout: "post"
diff: 普及/提高-
pid: AT_abc016_4
tag: []
---

# [ABC016D] 一刀両断

## 题目描述

# 一刀两断

高桥君是一位空手道练习者，现在他已经成为了一名大犇，用手劈木板就像劈空气一样（而且劈出的轨迹是一条线段）。

现在他找了一个多边形木桩，求他这一手下去可以把这个多边形木桩劈成几段。

## 输入格式

共N+2行,第一行四个整数Ax,Ay,Bx,By,分别表示线段（即他劈出的轨迹）的两个端点的坐标



第二行一个整数N，表示多边形顶点数



第三到n+2行，每行两个整数，表示一个顶点的横纵坐标



其中3≦N≦100，坐标的取值大于-1000小于1000

同时给出的多边形和线段具有以下性质：



给出的多边形的顶点是按逆时针方向排列的。



多边形的顶点与线段相隔0.1以上。



线段的端点与多边形相隔0.1以上。



线段的端点在多边形的外部。



多边形的连续的3个顶点不会排列在一条直线上



也就是说：如下面五张图，给出的数据不会有这些情况：

![](https://cdn.luogu.com.cn/upload/vjudge_pic/AT1020/98af351a3c771628dc4ac50aaf39554649a5b820.png)



图A,B:线段过多边形顶点（要不然手疼死了）



图C：线段的端点在多边形上



图D：线段和多边形的边重合



图E：线段的端点在多边形内部（卡里面了）

## 输出格式

一行，一个整数，输出末尾要加换行

## 样例 #1

### 输入

```
-2 0 2 0

4

1 1

-1 1

-1 -1

1 -1
```

### 输出

```
2
```

## 样例 #2

### 输入

```
-3 1 3 1

8

2 2

1 2

1 0

-1 0

-1 2

-2 2

-2 -1

2 -1
```

### 输出

```
3
```



---

---
title: "[ABC019D] 高橋くんと木の直径"
layout: "post"
diff: 普及/提高-
pid: AT_abc019_4
tag: []
---

# [ABC019D] 高橋くんと木の直径

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc019/tasks/abc019_4

高橋くんは木の直径を求めるのに夢中です。 木とは、頂点とそれを結ぶ辺からなる構造「グラフ」の $ 1 $ 種で、頂点の数を $ N $ 個とすると、辺は $ N-1 $ 本あり、どの頂点も他の全ての頂点に辺で間接・直接的につながっています。

 ![](https://cdn.luogu.com.cn/upload/vjudge_pic/AT_abc019_4/cfb0270dd13592a982ed72200a9f86b2a95a3a4d.png)

この問題では、辺には整数の重みがついています。2頂点の間の距離を、その2つの頂点をつなぐ辺の重みの和と定義します。

木の直径とは、最も離れた2つの頂点の間の距離です。

以下のような木を考えてみましょう。辺の側に書かれた数が、その辺の重みです。

 ![](https://cdn.luogu.com.cn/upload/vjudge_pic/AT_abc019_4/a33a3d0111cd3e05457375697b0a6985f92b86a4.png)

この場合、頂点 $ 1 $ と $ 2 $ の距離は $ 1 $、頂点 $ 2 $ と $ 4 $ の間の距離は $ 1+2=3 $ となります。頂点 $ 3 $ と $ 5 $ の間の距離は $ 3+4=7 $、頂点 $ 4 $ と $ 5 $ の間の距離も $ 2+1+4=7 $ で、この距離がこの木の頂点の間では最大なので、木の直径は $ 7 $ となります。

高橋くんは、頂点の数と $ 2 $ 頂点間の距離の情報から、木の直径を求めることに興味が出てきました。 この問題では、あなたは木の頂点の数 $ N $ を最初に与えられ、$ 2 $ 頂点の間の距離を尋ねる質問を何回か行い、木の直径を求めます。

ただし、$ 2 $ 頂点間の距離を聞く回数には制限があります。

制限された質問の回数以内で木の直径を求めるプログラムを書いてください。

### Input &amp; Output Format

まず，木の頂点の数 $ N $ が標準入力に与えられる。

> $ N $

続いて，あなたのプログラムは何回か応答プログラムに質問をする．質問のフォーマットは以下のとおりである。

> ? $ a $ $ b $

この質問で，$ a,b $ 間の距離が標準入力に1行で渡される。$ 1\ ≦\ a,\ b\ ≦\ N $ かつ $ a≠b $ を満たしていなければならない。

何回か質問を行った後、あなたは木の直径を当てる。木の直径を $ diameter $ とおくと、

> ! $ diameter $

というフォーマットで出力する。木の直径を出力した後、あなたのプログラムは直ちに終了しなければならない。終了しなかった場合のジャッジ結果は不定である。

また、これら以外のフォーマットで出力した場合のジャッジ結果も不定である。

この問題ではテストケースごとに質問回数の上限値が設定されており、プログラムの行った質問の回数がその上限値を上回ると誤答と判定される。

正答かどうかは木の直径の出力で判断される。木の直径を特定し得ない質問しかしていない場合でも、直径が正しければ正答となる。

- - - - - -

頂点 $ 1 $ と頂点 $ 2 $ の間の距離を質問し、$ dist $ という変数で結果を受け取る例をいくつかの言語について示す。

ただし、ここに書かれている方法以外で入出力を行っても良い。

出力した後に、出力をflushしなければならないことに注意せよ。flushしなかった場合、TLEとなることがある。

C

```
<pre class="prettyprint linenums" style="font-size: 12px; letter-spacing: 0;">
printf("? %d %d\n", 1, 2);
fflush(stdout);
scanf("%d", &dist);
```

C++

```
<pre class="prettyprint linenums" style="font-size: 12px; letter-spacing: 0;">
cout > dist;
```

Java

```
<pre class="prettyprint linenums" style="font-size: 12px; letter-spacing: 0;">
System.out.printf("? %d %d\n", 1, 2);
Scanner scanner = new Scanner(System.in);
dist = scanner.nextInt();
```

C#

```
<pre class="prettyprint linenums" style="font-size: 12px; letter-spacing: 0;">
Console.WriteLine("? {0} {1}", 1, 2);
dist = int.Parse(Console.ReadLine());
```

D

```
<pre class="prettyprint linenums" style="font-size: 12px; letter-spacing: 0;">
writeln("? ", 1, " ", 2);
stdout.flush();
dist = readln.chomp.to!int;
```

PHP

```
<pre class="prettyprint linenums" style="font-size: 12px; letter-spacing: 0;">
echo "? ", 1, " ", 2, PHP_EOL;
$ dist\ =\ trim(fgets(STDIN));





Python



print\ "?\ {0}\ {1}".format(1,\ 2)

sys.stdout.flush()

dist\ =\ int(raw_input())





Perl $|=1;
print "? ", 1, " ", 2, "\n";
$dist = ;
```

Ruby

```
<pre class="prettyprint linenums" style="font-size: 12px; letter-spacing: 0;">
print "? ", 1, " ", 2, "\n"
STDOUT.flush
dist = gets.to_i
```

## 说明/提示

### 制約

- $ 2\ ≦\ N\ ≦\ 50 $
- $ 1\ ≦\ (それぞれの辺の重み)\ ≦\ 10^6 $

### 部分点

この問題には部分点が設定されている。

- $ 20 $ 点分のテストケースにおいて、質問回数の上限値は 1300 回である。
- 別の $ 80 $ 点分のテストケースにおいて、質問回数の上限値は 100 回である。

### 入出力例

木が以下のような形状のとき、

 ![](https://cdn.luogu.com.cn/upload/vjudge_pic/AT_abc019_4/cee5f2e74e5e3c979be3ad1dfb861be11590dd76.png)

以下のような入出力が考えられる。

 プログラムへの入力 プログラムの出力 5     ? 1 2 5     ? 2 4 1     ? 4 5 2     ? 2 3 9     ? 1 5 8     ! 14これは入出力の一つの例であり、意味のある質問をしているとは限らない。



---

---
title: "[ABC021C] 正直者の高橋くん"
layout: "post"
diff: 普及/提高-
pid: AT_abc021_c
tag: []
---

# [ABC021C] 正直者の高橋くん

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc021/tasks/abc021_c

あなたと高橋君は、AtCoder 王国に住んでいます。AtCoder 王国には、$ N $ 個の町と、町どうしを結ぶ $ M $ 本の道路が存在し、それらは双方向に移動可能です。 $ N $ 個の町はそれぞれ 町 $ 1 $,町 $ 2 $,…,町 $ N $ と呼ばれています。 また、$ M $ 個の道路はそれぞれ 道路 $ 1 $,道路 $ 2 $,…,道路 $ M $ と呼ばれています。

高橋君はあなたの家に遊びに行くことにしました。そして、高橋君は町 $ a $ から出発して、AtCoder 王国のいくつかの町（$ 0 $ 個でも良い）を経由して町 $ b $ にあるあなたの家に到着しました。

高橋君は最短経路を辿ってきたと主張しています。 高橋君は正直なので、絶対に嘘をつきません。

そこで、あなたは町 $ a $ から町 $ b $ への最短経路が何通りあるかを数えることにしました。答えは非常に大きくなる可能性があるので、実際の答えを $ 1,000,000,007(=10^9+7) $ で割った余りを出力してください。

町 $ a $ から町 $ b $ への最短経路とは、町 $ a $ から町 $ b $ への移動経路において道路を通る回数が最小となるような経路のことを言います。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ a $ $ b $ $ M $ $ x_1 $ $ y_1 $ $ x_2 $ $ y_2 $ : $ x_M $ $ y_M $

- $ 1 $ 行目には、AtCoder 王国に存在する町の個数を表す整数 $ N(2≦N≦100) $ が与えられる。
- $ 2 $ 行目には、高橋君が出発する町とあなたの家がある町の番号を表す $ 2 $ つの整数 $ a,b(1≦a,b≦N,a≠b) $ が空白区切りで与えられる。
- $ 3 $ 行目には、AtCoder 王国に存在する道路の個数を表す整数 $ M(1≦M≦200) $ が与えられる。
- $ 4 $ 行目から $ M $ 行には、道路の情報が与えられる。そのうち $ i(1≦i≦M) $ 行目には道路 $ i $ が結んでいる $ 2 $ つの町の番号 $ x_i,y_i(1≦x_i,y_i≦N,x_i≠y_i) $ が空白区切りで与えられる。
- どの町からどの町へもいくつかの道を辿ることによって行くことができる。

## 输出格式

$ 1 $ 行目に、町 $ a $ から町 $ b $ への最短経路の個数を $ 1,000,000,007 $ で割った余りを出力してください。

末尾の改行を忘れないこと。

## 说明/提示

### Sample Explanation 1

この入力例に対する図は以下の通りで、最短経路として次の $ 4 $ 通りが考えられます。 - $ 1→2→4→5→7 $ - $ 1→3→4→5→7 $ - $ 1→2→4→6→7 $ - $ 1→3→4→6→7 $ !\[\](http://abc021.contest.atcoder.jp/img/abc/021/enJQfEfKt-baQEUDjCrVFLSw/C\_sample1.png)

### Sample Explanation 2

この入力例に対する図は以下の通りです。 !\[\](http://abc021.contest.atcoder.jp/img/abc/021/enJQfEfKt-baQEUDjCrVFLSw/C\_sample2.png)

## 样例 #1

### 输入

```
7

1 7

8

1 2

1 3

4 2

4 3

4 5

4 6

7 5

7 6
```

### 输出

```
4
```

## 样例 #2

### 输入

```
7

1 7

9

1 2

1 3

4 2

4 3

4 5

4 6

7 5

7 6

4 7
```

### 输出

```
2
```



---

---
title: "[ABC024C] 民族大移動"
layout: "post"
diff: 普及/提高-
pid: AT_abc024_c
tag: []
---

# [ABC024C] 民族大移動

## 题目描述

### 题意简述
高桥君的王国有 $N$ 个城市，每个城市用编号 $1$ ~ $N$ 表示。

高桥国有 $K$ 个民族居住，第 $i$ 个民族生活在编号为 $S_i$ 的城市。

高桥国有百年一度的所有民族共同习俗**民族大迁徙**，但由于交通拥堵，所以设置了**第 $i$ 天只能在编号在 $L_i$ 到 $R_i$ 的城市来来去去**的限制，并最多花费 $D$ 天进行。

每个民族都遵守这一行动限制，在经过几个城市的同时前往目的地城市。

第 $i$ 个民族的目的地是 $T_i$ ，每个民族都希望尽可能早的到达目的地。

求每个民族最早到达目的地的时间。

## 输入格式

第一行有 $3$ 个整数，分别为高桥国城市的个数 $N$ ，大迁徙的时间 $D$，高桥国所住的民族数 $K$。

接下来的 $D$ 行，有 $2$ 个整数 $L_i,R_i$，表示第 $i$ 天可来来去去的城市编号范围。

接下来的 $K$ 行，每行 $2$ 个整数 $S_i,T_i$，表示第 $i$ 个民族原本居住的城市编号和目的地城市编号。

## 输出格式

共 $K$ 行，每行一个整数表示第 $i$ 个民族到达目的地的最少天数。

数据保证每个民族 $D$ 天内能到达目的地。

## 样例 #1

### 输入

```
10 10 3

1 5

3 6

7 10

5 8

4 4

1 4

2 9

1 3

1 1

4 5

1 6

2 7

10 1
```

### 输出

```
2

4

8
```

## 样例 #2

### 输入

```
10 10 4

1 2

2 4

3 6

4 8

5 10

9 10

7 8

5 6

3 5

1 3

10 1

3 8

2 4

1 3
```

### 输出

```
10

4

2

2
```

## 样例 #3

### 输入

```
314159265 10 1

1 10000

500 12031

1414 113232

111111 777777

666661 23423423

12345678 123456789

111111111 314159265

112334 235235235

1 223445

314 1592

1 314159265
```

### 输出

```
7
```



---

---
title: "[ABC026C] 高橋君の給料"
layout: "post"
diff: 普及/提高-
pid: AT_abc026_c
tag: []
---

# [ABC026C] 高橋君の給料

## 题目描述

现在一个公司有 $n$ 名员工。保证 $n\le20$。

除了 $1$ 号员工以外，每个员工都有一个直属上司。保证上司的编号严格小于这个员工的编号。

没有下属的员工工资为 $1$。对于有下属的员工，他的工资是其直接下属中的最大工资和最小工资之和加上 $1$。

求出 $1$ 号员工的工资。

## 输入格式

第一行，一个整数 $n$，表示有 $n$ 名员工。

第 $2$ 至 $n$ 行，第 $i$ 行一个整数 $b_i$，表示第 $i$ 名员工的直属上司是第 $b_i$ 名员工。

## 样例 #1

### 输入

```
5

1

1

1

1
```

### 输出

```
3
```

## 样例 #2

### 输入

```
7

1

1

2

2

3

3
```

### 输出

```
7
```

## 样例 #3

### 输入

```
6

1

2

3

3

2
```

### 输出

```
11
```

## 样例 #4

### 输入

```
10

1

2

3

4

5

6

7

8

9
```

### 输出

```
1023
```



---

---
title: "[ABC027B] 島と橋"
layout: "post"
diff: 普及/提高-
pid: AT_abc027_b
tag: []
---

# [ABC027B] 島と橋

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc027/tasks/abc027_b

$ N $ 個の島が横一列に並んでいる。 $ 1≦i≦N-1 $ について、左から $ i $ 番目の島と $ i+1 $ 番目の島は隣り合っている。

はじめ、左から $ i $ ($ 1≦i≦N $) 番目の島には $ a_i $ 人の住人が住んでいる。 高橋君はすべての島に同じ人数の住人が住むようにしたいと考えている。

高橋君は隣り合う $ 2 $ つの島の間に橋を架けることができる。 また、直接的または間接的に橋で結ばれた複数の島の間で、住人を自由に移動させることができる。

すべての島に同じ人数の住人が住むようにするために、架ける必要のある橋の本数の最小値を求めよ。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ a_1 $ $ a_2 $ $ .. $ $ a_N $

- $ 1 $ 行目には、島の個数を表す整数 $ N $ ($ 2≦N≦100 $) が与えられる。
- $ 2 $ 行目には、整数 $ a_i $ ($ 0≦a_i≦100 $) が空白区切りで与えられる。これは、左から $ i $ 番目の島には $ a_i $ 人の住人が住んでいることを表す。

## 输出格式

すべての島に同じ人数の住人が住むようにするために、架ける必要のある橋の本数の最小値を $ 1 $ 行に出力せよ。 ただし、どのように橋を架けてもすべての島に同じ人数の住人が住むようにできないならば、代わりに `-1` を出力せよ。 出力の末尾には改行を入れること。

## 说明/提示

### Sample Explanation 1

図のように橋を架ければよい。 !\[\](https://abc027.contest.atcoder.jp/img/abc/027/kakofvcs22vft/bridge\_1.png)

### Sample Explanation 2

図のように橋を架ければよい。 !\[\](https://abc027.contest.atcoder.jp/img/abc/027/kakofvcs22vft/bridge\_2.png)

### Sample Explanation 3

どのように橋を架けてもすべての島に同じ人数の住人が住むようにできない。

### Sample Explanation 4

はじめからすべての島に同じ人数の住人が住んでいる。

## 样例 #1

### 输入

```
3

1 2 3
```

### 输出

```
2
```

## 样例 #2

### 输入

```
5

2 0 0 0 3
```

### 输出

```
3
```

## 样例 #3

### 输入

```
2

0 99
```

### 输出

```
-1
```

## 样例 #4

### 输入

```
4

0 0 0 0
```

### 输出

```
0
```



---

---
title: "[ABC030C] 飛行機乗り"
layout: "post"
diff: 普及/提高-
pid: AT_abc030_c
tag: []
---

# [ABC030C] 飛行機乗り

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc030/tasks/abc030_c

ウナギの高橋くんは飛行機に乗ることが趣味です。今回は空港Aと空港Bを往復することにしました。

空港Aから空港Bの飛行機には $ X $ 時間かかり、空港Bから空港Aへの飛行機には $ Y $ 時間かかります。 空港Aから空港Bへの飛行機は $ N $ 本あり、$ i $ 番目の便は $ a_i $ 時に出発します。 空港Bから空港Aへの飛行機は $ M $ 本あり、$ j $ 番目の便は $ b_j $ 時に出発します。

ある飛行機には、出発する空港に出発する時刻以前にいれば乗ることができます。出発する時刻ちょうどに到着した場合も、すぐに飛行機に乗って出発できます。 高橋くんははじめ空港Aに $ 0 $ 時にいます。 空港Aと空港Bの間を最大何往復できるか調べてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ M $ $ X $ $ Y $ $ a_1 $ $ a_2 $ .. $ a_N $ $ b_1 $ $ b_2 $ .. $ b_M $

- $ 1 $ 行目には、空港Aから空港Bへの本数 $ N\ (\ 1\ ≦\ N\ ≦\ 10^5) $、空港Bから空港Aへの本数 $ M\ (\ 1\ ≦\ M\ ≦\ 10^5) $ が空白区切りで与えられる。
- $ 2 $ 行目には、空港Aから空港Bへの飛行機にかかる時間 $ X\ (\ 1\ ≦\ X\ ≦\ 10^9) $、空港Bから空港Aへの飛行機にかかる時間 $ Y\ (\ 1\ ≦\ Y\ ≦\ 10^9) $ が空白区切りで与えられる。
- $ 3 $ 行目には、$ N $ 個の空港Aから飛行機が出発する時刻を表す整数 $ a_i $ が空白を区切りとして与えられる。
- $ 4 $ 行目には、$ M $ 個の空港Bから飛行機が出発する時刻を表す整数 $ b_j $ が空白を区切りとして与えられる。
- $ 1\ ≦\ a_i\ ≦\ 10^9\ (1\ ≦\ i\ ≦\ N) $ であることが保証される。
- $ 1\ ≦\ b_j\ ≦\ 10^9\ (1\ ≦\ j\ ≦\ M) $ であることが保証される。
- $ a_i\ <\ a_{i+1}\ (1\ ≦\ i\ ≦\ N-1) $ であることが保証される。
- $ b_i\ <\ b_{j+1}\ (1\ ≦\ j\ ≦\ M-1) $ であることが保証される。

## 输出格式

高橋くんが空港Aと空港Bの間を最大何往復できるかを $ 1 $ 行に出力せよ。

末尾の改行を忘れないこと。

## 说明/提示

### 部分点

この問題には部分点が設定されている。

- $ 30 $ 点分のテストケースにおいて、$ 1\ ≦\ a_i\ ≦\ 10^5,\ 1\ ≦\ b_j\ ≦\ 10^5\ (\ 1\ ≦\ i\ ≦\ N,\ 1\ ≦\ j\ ≦\ M) $ を満たす。

### Sample Explanation 1

$ 1 $ 時の空港Aを出発する飛行機に乗り、$ 3 $ 時に到着しますが、すぐに $ 3 $ 時の空港Bを出発する飛行機に乗り、$ 6 $ 時に空港Aに到着します。 次に、$ 7 $ 時の空港Aを出発する飛行機に乗り、$ 9 $ 時に到着、$ 12 $ 時の空港Bを出発する飛行機に乗ると、合計 $ 2 $ 往復できます。$ 3 $ 往復する手段はありません。

### Sample Explanation 2

空港Bに行くと空港Aに帰れないので、$ 1 $ 度も往復できません。

## 样例 #1

### 输入

```
3 4

2 3

1 5 7

3 8 12 13
```

### 输出

```
2
```

## 样例 #2

### 输入

```
1 1

1 1

1

1
```

### 输出

```
0
```

## 样例 #3

### 输入

```
6 7

5 3

1 7 12 19 20 26

4 9 15 23 24 31 33
```

### 输出

```
3
```



---

---
title: "[ABC031C] 数列ゲーム"
layout: "post"
diff: 普及/提高-
pid: AT_abc031_c
tag: []
---

# [ABC031C] 数列ゲーム

## 题目描述

高桥和青木用长度为N的数列S玩游戏。



游戏中，高桥和青木各进行一回合。



游戏按照以下规则进行：



	首先，高桥在数列中圈一个数字。

	然后，青木在高桥没圈的数字中圈一个。

	接着，留下圈中的数字以及它们之间的数字，去掉其它数字。留下的数列叫T。

	最后，在数列T中，从左开始奇数个数字的和为高桥的得分，偶数个数字为青木的得分。



青木在能圈的数字中，圈出能使他得到最多分数的数字。如果这样的数有多个，圈出最左的数字。



高桥知道青木的圈数方法。请求出高桥能得到的最大得分。

## 输入格式

按照以下标准格式输入。



	第一行输入整数N(2<=N<=50)，N是数列S的数字数量。

	第二行输入N个整数a1,a2,...,aN(-50<=ai<=50,1<=i<=50)，整数ai是数列S从左往右数第i个数字。

## 输出格式

用一行输出高桥的最大得分。



在输出的末尾加上换行

## 样例 #1

### 输入

```
6

1 -3 3 9 1 6
```

### 输出

```
6
```

## 样例 #2

### 输入

```
3

5 5 5
```

### 输出

```
10
```

## 样例 #3

### 输入

```
8

-1 10 -1 2 -1 10 -1 0
```

### 输出

```
-1
```



---

---
title: "[ABC033C] 数式の書き換え"
layout: "post"
diff: 普及/提高-
pid: AT_abc033_c
tag: []
---

# [ABC033C] 数式の書き換え

## 题目描述

给出满足以下限制的公式$S$。

1.运算符仅由+（加法）和*（乘法）组成。优先计算乘法；

2.不存在括号；

3.每一个数都是是$1$位数的整数。

例如，1+3*4*0、1+2+3+4+5等公式满足此条件，但12+3+5、4*6*7-3、（3+4）*5+2等公式不满足条件。

请您通过在公式中选几个数字并将其改为$0$，将此公式的最后结果变成$0$。求最少要改写几个数字。

## 输入格式

输入以下标准形式。
```
$ S $ 
```
一行一个字符串$S$，满足问题条件的数学式$S$（$S$的长度为$1$以上$100000$以下）。

## 输出格式

一行一个整数，表示必须改写为$0$的数字的个数的最小值。

输出的末尾也要另起一行$（ATcoder规范）$。

## 说明/提示

给出的公式是：$0+0+2*0=0$。因此，因此，不需要改写数字。


通过将输入的第一个字符和第五个字符改写为0，可以得到$0*1+0*2=0$，最终使运算结果变为0。

## 样例 #1

### 输入

```
0+0+2*0
```

### 输出

```
0
```

## 样例 #2

### 输入

```
3*1+1*2
```

### 输出

```
2
```

## 样例 #3

### 输入

```
3*1*4+0+2*0+5*2+9*8*6+1+3
```

### 输出

```
5
```



---

---
title: "[ABC035B] ドローン"
layout: "post"
diff: 普及/提高-
pid: AT_abc035_b
tag: []
---

# [ABC035B] ドローン

## 题目描述

### 题意翻译

有一个无限大的二维网格，在网格上有一架无人机，高桥先生在（ $0$ , $0$ ）处放飞无人机。
有一个字符串 $S$ 代表高桥先生发送给无人机的指令：

- ``L`` 代表无人机从（ $x$ , $y$ ）飞到（ $x-1$ , $y$ ）
- ``R`` 代表无人机从（ $x$ , $y$ ）飞到（ $x+1$ , $y$ ）
- ``U`` 代表无人机从（ $x$ , $y$ ）飞到（ $x$ , $y+1$ ）
- ``D`` 代表无人机从（ $x$ , $y$ ）飞到（ $x$ , $y-1$ ）


现在给出这个指令字符串 $S$ ，但这个字符串有些地方损坏了，损坏的地方用 ``?`` 表示，保证 ``?`` 只能为 ``L``、``R``、``U``、``D`` 之一。

无人机和高桥先生之间的距离为 $|x|+|y|$ 。

之后给出一个数 $T$ ，$T$ 保证只有如下两种情况：
- 当 $T=1$ 时，表示要输出的数是高桥先生和无人机距离的最大值。
- 当 $T=2$ 时，表示要输出的数是高桥先生和无人机距离的最小值。

----------

## 输入格式

- 第一行输入一个字符串 $S$ ，定义 $|S|$ 为字符串的长度$（1≤|S|≤10^5）$，表示高桥先生发给无人机的指令串，保证 $S$ 只含 ``L``、``R``、``U``、``D``、``？`` 五种字符。

- 第二行输入一个数 $T$ ，保证$（1≤T≤2）$。

-------------

## 输出格式

- 当 $T=1$ 时，输出无人机和高桥先生距离的最大值。

- 当 $T=2$ 时，输出无人机和高桥先生距离的最小值。

- 别忘最后输出换行符。

Translated by 2c_s

## 样例 #1

### 输入

```
UL?

1
```

### 输出

```
3
```

## 样例 #2

### 输入

```
UD?

1
```

### 输出

```
1
```

## 样例 #3

### 输入

```
UUUU?DDR?LLLL

1
```

### 输出

```
7
```

## 样例 #4

### 输入

```
UULL?

2
```

### 输出

```
3
```



---

---
title: "[ABC039D] 画像処理高橋君"
layout: "post"
diff: 普及/提高-
pid: AT_abc039_d
tag: []
---

# [ABC039D] 画像処理高橋君

## 题目描述

对一幅黑白图像进行“收缩”处理。

“收缩”是指，对于每个像素，如果在它周围（$8$个方向）有一个黑色的像素，即将该像素视为黑色。

给你一幅被收缩过的图像，判断是否有一幅图像可以通过收缩得到这幅图像。如果有，请复原其中之一。
图像是由 $H$ 行 $W $ 列字符组成的图形。

## 输入格式

第一行输入 $H$ 和  $W$ 。

第 $2  $ 到第 $H+1$ 行，每行 $W$ 个字符，共同表示了一幅图像。

## 输出格式

如果没有满足条件的图像，输出一行 impossible 。

否则，输出一行 possible 后，输出 $H$ 行 $W$ 列，由 . 和 # 构成的字符串，表示一副满足条件的图像。

对于每个字符，如其为 . 则为白色，如为 # 则是黑色

## 样例 #1

### 输入

```
4 4

##..

##..

..##

..##
```

### 输出

```
possible

#...

....

....

...#
```

## 样例 #2

### 输入

```
4 4

###.

####

..##

..##
```

### 输出

```
possible

##..

....

...#

...#
```

## 样例 #3

### 输入

```
4 4

###.

##.#

..##

..##
```

### 输出

```
impossible
```



---

---
title: "[ABC040C] 柱柱柱柱柱"
layout: "post"
diff: 普及/提高-
pid: AT_abc040_c
tag: []
---

# [ABC040C] 柱柱柱柱柱

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc040/tasks/abc040_c

$ N $ 本の木の柱が左から右へ一列に並んだアスレチックがあります。左から $ i $ 本目の柱の高さは $ a_i $ センチメートルです。

高橋君は左から $ 1 $ 本目の柱からスタートし、右へ柱を渡っていき $ N $ 本目の柱まで行こうとしています。

高橋君がある柱にいるとき、次には現在の柱から $ 1 $ 個もしくは $ 2 $ 個右にある柱のどちらかへ移動することができます。

移動するときには、現在いる柱の高さと、移動後の柱の高さの差の絶対値のぶんだけコストがかかります。

$ N $ 本目の柱まで行くとき、コストの合計の最小値はいくらになるでしょうか。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ a_1 $ $ a_2 $ ... $ a_N $

## 输出格式

$ 1 $ 本目の柱から $ N $ 本目の柱へ移動するまでに必要な合計コストの最小値を $ 1 $ 行に出力せよ。

## 说明/提示

### 制約

- $ 2\ ≦\ N\ ≦\ 100,000 $
- $ 0\ ≦\ a_i\ ≦\ 10,000 $
- $ a_i $ はすべて整数である。

### Sample Explanation 1

このケースでは以下のような移動によって最小コストを達成できる。 - $ 1 $ 本目の柱から $ 3 $ 本目の柱へ移動する。(コスト $ 30 $) - $ 3 $ 本目の柱から $ 4 $ 本目の柱へ移動する。(コスト $ 10 $) 合計コストは $ 40 $ となる。

### Sample Explanation 2

このケースでは以下のような移動によって最小コストを達成できる。 - $ 1 $ 本目の柱から $ 2 $ 本目の柱へ移動する。(コスト $ 25 $) - $ 2 $ 本目の柱から $ 4 $ 本目の柱へ移動する。(コスト $ 15 $) 合計コストは $ 40 $ となる。

## 样例 #1

### 输入

```
4

100 150 130 120
```

### 输出

```
40
```

## 样例 #2

### 输入

```
4

100 125 80 110
```

### 输出

```
40
```

## 样例 #3

### 输入

```
9

314 159 265 358 979 323 846 264 338
```

### 输出

```
310
```



---

---
title: "[ABC045B] 3人でカードゲームイージー"
layout: "post"
diff: 普及/提高-
pid: AT_abc045_b
tag: []
---

# [ABC045B] 3人でカードゲームイージー

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc045/tasks/abc045_b

A さん、B さん、C さんの $ 3 $ 人が以下のようなカードゲームをプレイしています。

- 最初、$ 3 $ 人はそれぞれ `a`、`b`、`c` いずれかの文字が書かれたカードを、何枚か持っている。これらは入力で与えられた順番に持っており、途中で並べ替えたりしない。
- $ A $ さんのターンから始まる。
- 現在自分のターンである人がカードを $ 1 $ 枚以上持っているならば、そのうち先頭のカードを捨てる。その後、捨てられたカードに書かれているアルファベットと同じ名前の人 (例えば、カードに `a` と書かれていたならば A さん) のターンとなる。
- 現在自分のターンである人がカードを $ 1 $ 枚も持っていないならば、その人がゲームの勝者となり、ゲームは終了する。

$ 3 $ 人が最初に持っているカードがそれぞれ先頭から順に与えられます。 具体的には、文字列 $ S_A $、$ S_B $、$ S_C $ が与えられます。文字列 $ S_A $ の $ i $ 文字目 ( $ 1\ \leq\ i\ \leq\ |S_A| $ ) に書かれている文字が、A さんの持っている中で先頭から $ i $ 番目のカードに 書かれている文字です。文字列 $ S_B $、 $ S_C $ についても同様です。

最終的に誰がこのゲームの勝者となるかを求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ S_A $ $ S_B $ $ S_C $

## 输出格式

A さんが勝つなら `A`、B さんが勝つなら `B`、C さんが勝つなら `C` と出力せよ。

## 说明/提示

### 制約

- $ 1\ \leq\ S_A\ \leq\ 100 $
- $ 1\ \leq\ S_B\ \leq\ 100 $
- $ 1\ \leq\ S_C\ \leq\ 100 $
- $ S_A $、$ S_B $、$ S_C $ に含まれる文字はそれぞれ `a`、`b`、`c` のいずれか

### Sample Explanation 1

ゲームは以下のように進行します。 - A さんが、持っている中で最初のカード `a` を捨てる。次は A さんの番となる。 - A さんが、持っている中で最初のカード `c` を捨てる。次は C さんの番となる。 - C さんが、持っている中で最初のカード `c` を捨てる。次は C さんの番となる。 - C さんが、持っている中で最初のカード `a` を捨てる。次は A さんの番となる。 - A さんが、持っている中で最初のカード `a` を捨てる。次は A さんの番となる。 - A さんはもう持っているカードがない。よって A さんの勝利となり、ゲームは終了する。

## 样例 #1

### 输入

```
aca

accc

ca
```

### 输出

```
A
```

## 样例 #2

### 输入

```
abcb

aacb

bccc
```

### 输出

```
C
```



---

---
title: "[ABC054B] Template Matching"
layout: "post"
diff: 普及/提高-
pid: AT_abc054_b
tag: []
---

# [ABC054B] Template Matching

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc054/tasks/abc054_b

縦 $ N $ 行、横 $ N $ 列に画素が並んだ画像Aと、縦 $ M $ 行、横 $ M $ 列に画素が並んだテンプレート画像Bが与えられます。   
 画素は画像を構成する最小単位であり、ここでは $ 1×1 $ の正方形とします。   
 また、与えられる画像は全て2値画像であり、各画素の色は白と黒の2種類で表されます。

入力において、全ての画素は文字で表されており、`.`は白色の画素、 `#` は黒色の画素に対応します。   
 画像Aは $ N $ 個の文字列 $ A_1,...,A_N $ で表されます。   
 文字列 $ A_i $ の $ j $ 文字目は、画像Aの上から $ i $ 番目、左から $ j $ 番目の画素に対応します。$ (1≦i,j≦N) $   
 同様に、テンプレート画像Bは $ M $ 個の文字列 $ B_1,...,B_M $ で表されます。   
 文字列 $ B_i $ の $ j $ 文字目は、テンプレート画像Bの上から $ i $ 番目、左から $ j $ 番目の画素に対応します。$ (1≦i,j≦M) $

画像の平行移動のみ許されるとき、テンプレート画像Bが画像Aの中に含まれているかを判定してください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ M $ $ A_1 $ $ A_2 $ $ : $ $ A_N $ $ B_1 $ $ B_2 $ $ : $ $ B_M $

## 输出格式

画像Aの中にテンプレート画像Bを含む場合は `Yes`、含まない場合は `No` を出力せよ。

## 说明/提示

### 制約

- $ 1≦M≦N≦50 $
- $ A_i $ は `#` と `.` からなる長さ $ N $ の文字列
- $ B_i $ は `#` と `.` からなる長さ $ M $ の文字列

### Sample Explanation 1

テンプレート画像Bが、画像A中の左上の $ 2\ ×\ 2 $ の部分画像と右下の $ 2\ ×\ 2 $ の部分画像に一致するため、`Yes` と出力します。

### Sample Explanation 2

画像Aは白色の画素、テンプレート画像Bは黒色の画素で構成されるため、含まれることはありません。

## 样例 #1

### 输入

```
3 2

#.#

.#.

#.#

#.

.#
```

### 输出

```
Yes
```

## 样例 #2

### 输入

```
4 1

....

....

....

....

#
```

### 输出

```
No
```



---

---
title: "[ABC054C] One-stroke Path"
layout: "post"
diff: 普及/提高-
pid: AT_abc054_c
tag: []
---

# [ABC054C] One-stroke Path

## 题目描述

给定一个没有重边和自环的 $N$ 个点 $M$ 条边的无权无向图，第 $i$ 条边连接顶点 $a _ i$ 和 $b _ i$。

求以顶点 $1$ 为起点，只访问 $1$ 次所有顶点的路径有多少条？特别地，起点和终点也视为被访问。

## 输入格式

第一行两个整数 $N, M$。

接下来 $m$ 行，其中第 $i$ 行两个整数 $a _ i, b _ i$。

$
N M \\
a _ 1 b _ 1 \\
a _ 2 b _ 2 \\
\kern {0.667 em} \vdots \\
a _ M b _ M
$

## 输出格式

输出满足条件的路径有多少。

## 说明/提示

$
2 \le N \le 8 \\
0 \le M \le N(N - 1) \\
1 \le a _ i < b _ i \le N
$

给定的无向图中不包含重边和自环。

## 样例 #1

### 输入

```
3 3

1 2

1 3

2 3
```

### 输出

```
2
```

## 样例 #2

### 输入

```
7 7

1 3

2 7

3 4

4 5

4 6

5 6

6 7
```

### 输出

```
1
```



---

---
title: "[ABC054D] Mixing Experiment"
layout: "post"
diff: 普及/提高-
pid: AT_abc054_d
tag: []
---

# [ABC054D] Mixing Experiment

## 题目描述

------------

有 $N$ 个物体，第 $i$ 个物体含有 $a_i$ 质量的 A 元素 和 $b_i$ 质量的 B 元素，代价为 $c_i$ 。

问能否取若干个物体，使 A 元素与 B 元素质量之比为 $M_a : M_b$ ，并使代价最小。

------------

## 输入格式

第一行3个整数 $N ,M_a ,M_b$

下面 $N$ 行，每行3个整数 $a_i ,b_i ,c_i$

$ N $   $ M_a $   $ M_b $   
$ a_1 $   $ b_1 $   $ c_1 $   
$ a_2 $   $ b_2 $   $ c_2 $ 

$ : $   
$ a_N $   $ b_N $   $ c_N $ 

------------

## 输出格式

若能满足条件则输出 **最小代价**。

否则输出 -1

------------

## 说明/提示

- $1\le N\le 40$

- $1\le a_i,b_i\le 10$

- $1\le c_i\le 100$

- $1\le M_a,M_b\le 10$

-  $gcd(M_a,M_b)=1$

- 输入都为整数。

------------

translated by @君のNOIP。

## 样例 #1

### 输入

```
3 1 1

1 2 1

2 1 2

3 3 10
```

### 输出

```
3
```

## 样例 #2

### 输入

```
1 1 10

10 10 10
```

### 输出

```
-1
```



---

---
title: "[ABC057B] Checkpoints"
layout: "post"
diff: 普及/提高-
pid: AT_abc057_b
tag: []
---

# [ABC057B] Checkpoints

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc057/tasks/abc057_b

$ xy $ 平面があり、その上に $ N $ 人の学生がいて、$ M $ 個のチェックポイントがあります。  
 $ i $ 番目の学生がいる座標は $ (a_i,b_i)\ (1≦i≦N) $ であり、番号 $ j $ のチェックポイントの座標は $ (c_j,d_j)\ (1≦j≦M) $ です。   
 これから合図があり、各学生はマンハッタン距離で一番近いチェックポイントに集合しなければなりません。   
 2つの地点 $ (x_1,y_1) $ と $ (x_2,y_2) $ 間のマンハッタン距離は $ |x_1-x_2|+|y_1-y_2| $ で表されます。  
 ここで、$ |x| $ は $ x $ の絶対値を表します。  
 ただし、一番近いチェックポイントが複数ある場合には、番号が最も小さいチェックポイントに移動することとします。  
 合図の後に、各学生がどのチェックポイントに移動するかを求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ M $ $ a_1 $ $ b_1 $ $ : $ $ a_N $ $ b_N $ $ c_1 $ $ d_1 $ $ : $ $ c_M $ $ d_M $

## 输出格式

解答を $ N $ 行に出力せよ。  
 $ i\ (1\ ≦i≦N) $ 番目の行には、$ i $ 番目の学生が訪れるチェックポイントの番号を出力せよ。

## 说明/提示

### 制約

- $ 1≦N,M≦50 $
- $ -10^8≦a_i,b_i,c_j,d_j≦10^8 $
- 入力は全て整数である。

### Sample Explanation 1

$ 1 $ 番目の学生と各チェックポイント間のマンハッタン距離は以下の通りです。 - 番号 $ 1 $ のチェックポイントへのマンハッタン距離は $ |2-(-1)|+|0-0|=3 $ - 番号 $ 2 $ のチェックポイントへのマンハッタン距離は $ |2-1|+|0-0|=1 $ したがって、最も近いチェックポイントの番号は $ 2 $ であるため、$ 1 $ 行目には $ 2 $ と出力します。 $ 2 $ 番目の学生と各チェックポイント間のマンハッタン距離は以下の通りです。 - 番号 $ 1 $ のチェックポイントへのマンハッタン距離は $ |0-(-1)|+|0-0|=1 $ - 番号 $ 2 $ のチェックポイントへのマンハッタン距離は $ |0-1|+|0-0|=1 $ 最も近いチェックポイントが複数ある場合は、番号が最も小さいチェックポイントに移動するため、$ 2 $ 行目には $ 1 $ と出力します。

### Sample Explanation 2

同じ座標に複数のチェックポイントが存在する場合もあります。

## 样例 #1

### 输入

```
2 2

2 0

0 0

-1 0

1 0
```

### 输出

```
2

1
```

## 样例 #2

### 输入

```
3 4

10 10

-10 -10

3 3

1 2

2 3

3 5

3 5
```

### 输出

```
3

1

2
```

## 样例 #3

### 输入

```
5 5

-100000000 -100000000

-100000000 100000000

100000000 -100000000

100000000 100000000

0 0

0 0

100000000 100000000

100000000 -100000000

-100000000 100000000

-100000000 -100000000
```

### 输出

```
5

4

3

2

1
```



---

---
title: "[ABC070C] Multiple Clocks"
layout: "post"
diff: 普及/提高-
pid: AT_abc070_c
tag: []
---

# [ABC070C] Multiple Clocks

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc070/tasks/abc070_c

$ N $ 台の時計があり、$ i(1≦i≦N) $ 番目の時計の針はちょうど $ T_i $ 秒で時計盤を $ 1 $ 周します。   
 最初、全ての時計の針は真っ直ぐ上に向いており、止まっています。   
 イルカは、全ての時計の針を同時に動かし始めました。   
 再び、全ての時計の針が真っ直ぐ上に向くのは何秒後でしょうか?

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ T_1 $ $ : $ $ T_N $

## 输出格式

時計の針を動かし始めてから、再び全ての時計の針が真っ直ぐ上に向くまでの秒数を出力せよ。

## 说明/提示

### 制約

- $ 1≦N≦100 $
- $ 1≦T_i≦10^{18} $
- 入力は全て整数である。
- 答えは $ 10^{18} $ 秒以内である。

### Sample Explanation 1

$ 2 $ つの時計があり、各時計の針が真っ直ぐ上に向くのは以下の時刻です。 - $ 1 $ 番目の時計の針: 時計の針を動かし始めてから、$ 2 $ 秒後、$ 4 $ 秒後、$ 6 $ 秒後、$ ... $ - $ 2 $ 番目の時計の針: 時計の針を動かし始めてから、$ 3 $ 秒後、$ 6 $ 秒後、$ 9 $ 秒後、$ ... $ したがって、$ 2 $ つの時計の針が真っ直ぐ上に向くのにかかる秒数は $ 6 $ 秒となります。

## 样例 #1

### 输入

```
2

2

3
```

### 输出

```
6
```

## 样例 #2

### 输入

```
5

2

5

10

1000000000000000000

1000000000000000000
```

### 输出

```
1000000000000000000
```



---

---
title: "[ABC075C] Bridge"
layout: "post"
diff: 普及/提高-
pid: AT_abc075_c
tag: []
---

# [ABC075C] Bridge

## 题目描述

给你一个$N$个点$M$条边无重边无自环的无向图。

求有几个桥（自行百度）。

## 输入格式

第一行两个正整数$N,M$，之后$M$行每行两个数$u,v$描述无向边。

## 输出格式

一个正整数代表图里有几个桥。

## 说明/提示

$1 \leq N \leq 50$

$N-1 \leq M \leq N(N-1)/2$

## 样例 #1

### 输入

```
7 7

1 3

2 7

3 4

4 5

4 6

5 6

6 7
```

### 输出

```
4
```

## 样例 #2

### 输入

```
3 3

1 2

1 3

2 3
```

### 输出

```
0
```

## 样例 #3

### 输入

```
6 5

1 2

2 3

3 4

4 5

5 6
```

### 输出

```
5
```



---

---
title: "[ABC076C] Dubious Document 2"
layout: "post"
diff: 普及/提高-
pid: AT_abc076_c
tag: []
---

# [ABC076C] Dubious Document 2

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc076/tasks/abc076_c

E869120 は、宝物が入ってそうな箱を見つけました。  
 しかし、これには鍵がかかっており、鍵を開けるためには英小文字からなる文字列 $ S $ が必要です。  
 彼は文字列 $ S' $ を見つけ、これは文字列 $ S $ の $ 0 $ 個以上 $ |S| $ 個以内の文字が `?` に置き換わった文字列であることも分かりました。  
 ただし、文字列 $ A $ に対して、$ |A| $ を「文字列 $ A $ の長さ」とします。

そこで、E869120 はヒントとなる紙を見つけました。

- 条件1：文字列 $ S $ の中に連続する部分文字列として英小文字から成る文字列 $ T $ が含まれている。
- 条件2：$ S $ は、条件1を満たす文字列の中で辞書順最小の文字列である。

そのとき、鍵となる文字列 $ S $ を出力しなさい。  
 ただし、そのような文字列 $ S $ が存在しない場合は代わりに `UNRESTORABLE` と出力しなさい。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ S' $ $ T $

## 输出格式

鍵となる文字列 $ S $ を出力しなさい。  
 ただし、そのような文字列 $ S $ が存在しない場合は、代わりに `UNRESTORABLE` と出力しなさい。

## 说明/提示

### 制約

- $ 1\ \leq\ |S'|,\ |T|\ \leq\ 50 $
- $ S' $ は英小文字と `?` から成る
- $ T $ は英小文字から成る

### Sample Explanation 1

条件1 を満たす文字列は `atcoder`, `btcoder`, `ctcoder`,..., `ztcoder` の $ 26 $ 個がありますが、その中で最も辞書順で小さいものは `atcoder` なので、$ S\ = $`atcoder` と特定できます。

### Sample Explanation 2

条件1を満たすような文字列 $ S $ が存在しないので、鍵となる文字列 $ S $ は存在しません。

## 样例 #1

### 输入

```
?tc????

coder
```

### 输出

```
atcoder
```

## 样例 #2

### 输入

```
??p??d??

abc
```

### 输出

```
UNRESTORABLE
```



---

---
title: "[ABC080C] Shopping Street"
layout: "post"
diff: 普及/提高-
pid: AT_abc080_c
tag: []
---

# [ABC080C] Shopping Street

## 题目描述

Joisino计划要在商店街开一家店。

这家店在周一到周五的$5$ 个工作日都有营业，其中每个工作日又被划分成上午和下午$2$ 个时间段，也就是共有$10$ 个时间段。当然，至少要有$1$ 个时间段这家店营业。

商店街原来有$N$ 个店铺，从$1$ 到$N$ 编号。

这些店铺的营业时间将以$F_{i,j,k}=1$ 的形式给出。如果$F_{i,j,k}=1$ ，第$i$ 家店将在第$j$ 天的第$k$ 个时间段营业。在这里，我们这样定义：第$1$ 天是周一，第$2$ 天是周二，第$3$ 天是周三，第$4$ 天是周四，第$5$ 天是周五。同样的，第$1$ 个时间段是上午，第$2$ 个时间段是下午。

设$c_i$ 为第$i$ 家店和Joisino的店同时营业的时间段数，则Joisino商店的收益将会是$P_{1,c1}+P_{2,c2}+...+P_{N,cN}$ 。

请决定Joisino在这$10$ 个时间段分别是否营业，并求出Joisino商店可能的最大收益，且保证它至少要有$1$ 个时间段营业。

## 输入格式

第一行，一个整数$N$ 。

接下来$N$ 行，第i行有10个整数，分别表示$F_{i,1,1}, F_{i,1,2}, ..., F_{i,5,1}, F_{i,5,2}$ 。

再接下来$N$ 行，第i行有11个整数，分别表示$P_{i,0}, ..., P_{i, 10}$ 。

## 输出格式

只有一行，一个整数，表示Joisino商店可能的最大收益。

## 说明/提示

### 样例解释1
如果商店仅在第$1$ 家店营业时营业，收益将会是$8$ ，这是可能的最大收益。

### 样例解释2
由于必须至少有一个时间段商店营业，所以收益可能会是负数。

- $1 \leq N \leq 100$ 
- $0 \leq F_{i,j,k} \leq 1$ 
- 对所有满足 $1 \leq i \leq N$ 的 $i$ , 总有一对$(j, k)$ 满足$F_{i,j,k}=1$ 。
- $-10^7 \leq P_{i,j} \leq 10^7$ 
- 所有输入数据均为整数。

by @月见之兔

## 样例 #1

### 输入

```
1

1 1 0 1 0 0 0 1 0 1

3 4 5 6 7 8 9 -2 -3 4 -2
```

### 输出

```
8
```

## 样例 #2

### 输入

```
2

1 1 1 1 1 0 0 0 0 0

0 0 0 0 0 1 1 1 1 1

0 -2 -2 -2 -2 -2 -1 -1 -1 -1 -1

0 -2 -2 -2 -2 -2 -1 -1 -1 -1 -1
```

### 输出

```
-2
```

## 样例 #3

### 输入

```
3

1 1 1 1 1 1 0 0 1 1

0 1 0 1 1 1 1 0 1 0

1 0 1 1 0 1 0 1 0 1

-8 6 -2 -8 -8 4 8 7 -6 2 2

-9 2 0 1 7 -5 0 -2 -6 5 5

6 -6 7 -9 6 -5 8 0 -9 -7 -7
```

### 输出

```
23
```



---

---
title: "[ABC088D] Grid Repainting"
layout: "post"
diff: 普及/提高-
pid: AT_abc088_d
tag: []
---

# [ABC088D] Grid Repainting

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc088/tasks/abc088_d

縦 $ H $ マス, 横 $ W $ マスに広がるマス目があり, 各マスは白または黒で塗られている. 上から $ i $ 番目で左から $ j $ 番目のマスを $ (i,\ j) $ で表す. すぬけ君は, このマス目を使って次のようなゲームをしたい. ゲームの開始時点ではマス $ (1,\ 1) $ にゲームキャラクター「けぬす君」がいる. プレイヤーはけぬす君を上下左右の $ 4 $ 方向のいずれかに $ 1 $ マスだけ動かすことを繰り返す. けぬす君が白いマスだけを通って $ (H,\ W) $ にたどり着けばゲームクリアとなる.  
 ゲームを開始する前に, すぬけ君はいくつかの白いマス目の色を黒に変えることができる. ただし, マス $ (1,\ 1) $ と $ (H,\ W) $ の色を変えることはできず, ゲームを開始するまでにすべての色の変更を行わなければならない.  
 ゲームをクリアしたとき, ゲームの開始前にマスの色を変えた回数がすぬけ君のスコアとなる. そのとき, すぬけ君が取る可能性のある最大のスコアを求めなさい.ただし, すぬけ君がどのようにマス目の色を変えてもけぬす君が $ (H,\ W) $ にたどり着くことが出来ない場合、$ -1 $ と出力しなさい.

ただし, 各マスの色の情報は文字 $ s_{i,\ j} $ として与えられる. マス $ (i,\ j) $ が最初白で塗られている場合 $ s_{i,\ j} $ は `.` であり, マス $ (i,\ j) $ が最初黒で塗られている場合 $ s_{i,\ j} $ は `#` である.

## 输入格式

入力は以下の形式で標準入力から与えられる.

> $ H $ $ W $ $ s_{1,\ 1}s_{1,\ 2}s_{1,\ 3}\ ...\ s_{1,\ W} $ $ s_{2,\ 1}s_{2,\ 2}s_{2,\ 3}\ ...\ s_{2,\ W} $ $ : $ $ : $ $ s_{H,\ 1}s_{H,\ 2}s_{H,\ 3}\ ...\ s_{H,\ W} $

## 输出格式

すぬけ君が取る可能性のある最大のスコアを出力しなさい. ただし, すぬけ君がどのようにマス目の色を変えてもけぬす君が $ (H,\ W) $ にたどり着くことが出来ない場合、$ -1 $ と出力しなさい.

## 说明/提示

### 制約

- $ H $ は $ 2 $ 以上 $ 50 $ 以下の整数
- $ W $ は $ 2 $ 以上 $ 50 $ 以下の整数
- $ s_{i,\ j} $ は `.` または `#` $ (1\ \leq\ i\ \leq\ H,\ 1\ \leq\ j\ \leq\ W) $
- $ s_{1,\ 1},\ s_{H,\ W} $ は `.` である

### Sample Explanation 1

下の図のようにマス目の色を変えれば, スコア $ 2 $ を達成できます. !\[Explanation of Sample 1\](https://img.atcoder.jp/abc088/bc944898899615e35f898654b68cd517.png)

## 样例 #1

### 输入

```
3 3

..#

#..

...
```

### 输出

```
2
```

## 样例 #2

### 输入

```
10 37

.....................................

...#...####...####..###...###...###..

..#.#..#...#.##....#...#.#...#.#...#.

..#.#..#...#.#.....#...#.#...#.#...#.

.#...#.#..##.#.....#...#.#.###.#.###.

.#####.####..#.....#...#..##....##...

.#...#.#...#.#.....#...#.#...#.#...#.

.#...#.#...#.##....#...#.#...#.#...#.

.#...#.####...####..###...###...###..

.....................................
```

### 输出

```
209
```



---

---
title: "[ABC089D] Practical Skill Test"
layout: "post"
diff: 普及/提高-
pid: AT_abc089_d
tag: []
---

# [ABC089D] Practical Skill Test

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc089/tasks/abc089_d

$ H $ 行 $ W $ 列のマス目があり、$ i $ 行目の $ j $ 列目のマスをマス $ (i,j) $ と呼びます。

このマス目には $ 1 $ から $ H×W $ までの整数が重複なく書かれており、マス $ (i,j) $ に書かれている整数は $ A_{i,j} $ です。

魔法少女であるあなたは、魔力 $ |x-i|+|y-j| $ を消費することでマス $ (i,j) $ に置かれた駒をマス $ (x,y) $ に瞬間移動させることができます。

あなたは、魔法少女としての能力を計るために、$ Q $ 回の実技試験を受けなければなりません。

$ i $ 回目の実技試験は、以下の手順で行われます。

- 初めに、駒が整数 $ L_i $ の書かれているマスに置かれている。
- 駒の置かれているマスに書かれている整数を $ x $ とする。$ x $ が $ R_i $ でない限り、駒を $ x+D $ の書かれているマスに移動することを繰り返す。$ x=R_i $ となったら終了する。
- ただし、$ R_i-L_i $ が $ D $ の倍数であることは保証される。

それぞれの実技試験に対し、あなたの消費する魔力の総和を求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ H $ $ W $ $ D $ $ A_{1,1} $ $ A_{1,2} $ $ ... $ $ A_{1,W} $ $ : $ $ A_{H,1} $ $ A_{H,2} $ $ ... $ $ A_{H,W} $ $ Q $ $ L_1 $ $ R_1 $ $ : $ $ L_Q $ $ R_Q $

## 输出格式

それぞれの実技試験に対し、あなたの消費する魔力の総和を出力せよ。

ただし、出力する順番は実技試験の行われる順とすること。

## 说明/提示

### 制約

- $ 1\ \leq\ H,W\ \leq\ 300 $
- $ 1\ \leq\ D\ \leq\ H×W $
- $ 1\ \leq\ A_{i,j}\ \leq\ H×W $
- $ A_{i,j}\ \neq\ A_{x,y}\ ((i,j)\ \neq\ (x,y)) $
- $ 1\ \leq\ Q\ \leq\ 10^5 $
- $ 1\ \leq\ L_i\ \leq\ R_i\ \leq\ H×W $
- $ (R_i-L_i) $ は $ D $ の倍数

### Sample Explanation 1

\- $ 4 $ が書かれたマスは、マス $ (1,2) $ です。 - $ 6 $ が書かれたマスは、マス $ (3,3) $ です。 - $ 8 $ が書かれたマスは、マス $ (3,1) $ です。 よって、$ 1 $ 回目の実技試験であなたの消費する魔力の総和は、$ (|3-1|+|3-2|)+(|3-3|+|1-3|)=5 $ です。

### Sample Explanation 2

駒を全く移動しない実技試験が存在する場合や、複数の実技試験の内容が同じ場合に注意してください。

## 样例 #1

### 输入

```
3 3 2

1 4 3

2 5 7

8 9 6

1

4 8
```

### 输出

```
5
```

## 样例 #2

### 输入

```
4 2 3

3 7

1 4

5 2

6 8

2

2 2

2 2
```

### 输出

```
0

0
```

## 样例 #3

### 输入

```
5 5 4

13 25 7 15 17

16 22 20 2 9

14 11 12 1 19

10 6 23 8 18

3 21 5 24 4

3

13 13

2 10

13 13
```

### 输出

```
0

5

0
```



---

---
title: "[ABC096D] Five, Five Everywhere"
layout: "post"
diff: 普及/提高-
pid: AT_abc096_d
tag: []
---

# [ABC096D] Five, Five Everywhere

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc096/tasks/abc096_d

以下の条件を満たす, 長さ $ N $ の数列 $ a_1,\ a_2,\ ...,\ a_N $ を $ 1 $ つ出力してください.

- $ a_i\ (1\ \leq\ i\ \leq\ N) $ は $ 55\ 555 $ 以下の素数である.
- $ a_1,\ a_2,\ ...,\ a_N $ の値はすべて異なる.
- $ a_1,\ a_2,\ ...,\ a_N $ からどの異なる $ 5 $ 個の整数を選んでも, この合計は合成数になる.

条件を満たす数列が複数個存在するとき、条件を満たすもののうちどのような数列を出力しても正解となります.

## 输入格式

入力は以下の形式で標準入力から与えられる.

> $ N $

## 输出格式

$ 1 $ 行に, $ N $ 個の数 $ a_1,\ a_2,\ a_3,\ ...,\ a_N $ を空白区切りで出力しなさい.

## 说明/提示

### 備考

$ 2 $ 以上の整数 $ N $ が, $ 1 $ と $ N $ 以外のどの正の整数でも割り切れなければ $ N $ は「素数」であり, そうでない場合 $ N $ は「合成数」である.

### 制約

- $ N $ は $ 5 $ 以上 $ 55 $ 以下の整数

### Sample Explanation 1

まず, $ 3 $, $ 5 $, $ 7 $, $ 11 $, $ 31 $ は全て異なり, 全て素数です. これらから $ 5 $ 個の整数を選ぶ方法は, 「全てを選ぶ」の 1 通りのみです. $ a_1+a_2+a_3+a_4+a_5=57 $ であり, この値は合成数なので問題文の条件を満たします. 他にも, `2 3 5 7 13` `11 13 17 19 31` `7 11 5 31 3` などを出力しても正解となります.

### Sample Explanation 2

\- $ 2 $, $ 3 $, $ 5 $, $ 7 $, $ 11 $, $ 13 $ は全て異なる素数です. - $ 2+3+5+7+11=28 $ であり, 合成数です. - $ 2+3+5+7+13=30 $ であり, 合成数です. - $ 2+3+5+11+13=34 $ であり, 合成数です. - $ 2+3+7+11+13=36 $ であり, 合成数です. - $ 2+5+7+11+13=38 $ であり, 合成数です. - $ 3+5+7+11+13=39 $ であり, 合成数です. よって, `2 3 5 7 11 13` は条件を満たす数列です.

## 样例 #1

### 输入

```
5
```

### 输出

```
3 5 7 11 31
```

## 样例 #2

### 输入

```
6
```

### 输出

```
2 3 5 7 11 13
```

## 样例 #3

### 输入

```
8
```

### 输出

```
2 5 7 13 19 37 67 79
```



---

---
title: "[ABC099C] Strange Bank"
layout: "post"
diff: 普及/提高-
pid: AT_abc099_c
tag: []
---

# [ABC099C] Strange Bank

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc099/tasks/abc099_c

ある銀行では、お金の引き出しを難しくするために、一回の操作で引き出せる金額が以下のいずれかとなっています。

- $ 1 $ 円
- $ 6 $ 円、$ 6^2(=36) $ 円、$ 6^3(=216) $ 円、$ ... $
- $ 9 $ 円、$ 9^2(=81) $ 円、$ 9^3(=729) $ 円、$ ... $

この銀行からちょうど $ N $ 円を引き出すには少なくとも何回の操作が必要か求めてください。

ただし、一度引き出したお金を再び預け入れてはならないとします。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $

## 输出格式

この銀行からちょうど $ N $ 円を引き出すのに少なくとも $ x $ 回の操作が必要な時、$ x $ を出力せよ。

## 说明/提示

### 制約

- $ 1\ \leq\ N\ \leq\ 100000 $
- $ N $ は整数

### Sample Explanation 1

$ 1 $ 円、$ 9 $ 円、$ 36(=6^2) $ 円、$ 81(=9^2) $ 円を引き出す操作をそれぞれ $ 1 $ 回ずつ行うことで、合計 $ 4 $ 回の操作で $ 127 $ 円を引き出すことができます。

### Sample Explanation 2

$ 1 $ 円を 引き出す操作を $ 3 $ 回 行うことで、合計 $ 3 $ 回の操作で $ 3 $ 円を引き出すことができます。

## 样例 #1

### 输入

```
127
```

### 输出

```
4
```

## 样例 #2

### 输入

```
3
```

### 输出

```
3
```

## 样例 #3

### 输入

```
44852
```

### 输出

```
16
```



---

---
title: "[ABC103C] Modulo Summation"
layout: "post"
diff: 普及/提高-
pid: AT_abc103_c
tag: []
---

# [ABC103C] Modulo Summation

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc103/tasks/abc103_c

$ N $ 個の正整数 $ a_1,\ a_2,\ ...,\ a_N $ が与えられます。

非負整数 $ m $ に対して、$ f(m)\ =\ (m\ mod\ a_1)\ +\ (m\ mod\ a_2)\ +\ ...\ +\ (m\ mod\ a_N) $ とします。

ここで、$ X\ mod\ Y $ は $ X $ を $ Y $ で割った余りを表します。

$ f $ の最大値を求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ a_1 $ $ a_2 $ $ ... $ $ a_N $

## 输出格式

$ f $ の最大値を出力せよ。

## 说明/提示

### 制約

- 入力は全て整数である
- $ 2\ \leq\ N\ \leq\ 3000 $
- $ 2\ \leq\ a_i\ \leq\ 10^5 $

### Sample Explanation 1

$ f(11)\ =\ (11\ mod\ 3)\ +\ (11\ mod\ 4)\ +\ (11\ mod\ 6)\ =\ 10 $ が $ f $ の最大値です。

## 样例 #1

### 输入

```
3

3 4 6
```

### 输出

```
10
```

## 样例 #2

### 输入

```
5

7 46 11 20 11
```

### 输出

```
90
```

## 样例 #3

### 输入

```
7

994 518 941 851 647 2 581
```

### 输出

```
4527
```



---

---
title: "[ABC103D] Islands War"
layout: "post"
diff: 普及/提高-
pid: AT_abc103_d
tag: []
---

# [ABC103D] Islands War

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc103/tasks/abc103_d

東西一列に並んだ $ N $ 個の島と $ N-1 $ 本の橋があります。

$ i $ 番目の橋は、西から $ i $ 番目の島と西から $ i+1 $ 番目の島を接続しています。

ある日、いくつかの島同士で争いが起こり、島の住人たちから $ M $ 個の要望がありました。

要望 $ i $: 西から $ a_i $ 番目の島と西から $ b_i $ 番目の島の間で争いが起こったために、これらの島をいくつかの橋を渡って行き来できないようにしてほしい

あなたは橋をいくつか取り除くことでこれら $ M $ 個の要望全てを叶えることにしました。

取り除く必要のある橋の本数の最小値を求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ M $ $ a_1 $ $ b_1 $ $ a_2 $ $ b_2 $ $ : $ $ a_M $ $ b_M $

## 输出格式

取り除く必要のある橋の本数の最小値を出力せよ。

## 说明/提示

### 制約

- 入力は全て整数である
- $ 2\ \leq\ N\ \leq\ 10^5 $
- $ 1\ \leq\ M\ \leq\ 10^5 $
- $ 1\ \leq\ a_i $
- 組 $ (a_i,\ b_i) $ は全て異なる

### Sample Explanation 1

西から $ 2 $ 番目の島と $ 3 $ 番目の島を接続する橋を取り除くことで達成できます。

## 样例 #1

### 输入

```
5 2

1 4

2 5
```

### 输出

```
1
```

## 样例 #2

### 输入

```
9 5

1 8

2 7

3 5

4 6

7 9
```

### 输出

```
2
```

## 样例 #3

### 输入

```
5 10

1 2

1 3

1 4

1 5

2 3

2 4

2 5

3 4

3 5

4 5
```

### 输出

```
4
```



---

---
title: "[ABC109D] Make Them Even"
layout: "post"
diff: 普及/提高-
pid: AT_abc109_d
tag: []
---

# [ABC109D] Make Them Even

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc109/tasks/abc109_d

縦 $ H $ 行横 $ W $ 列に区切られたマス目があり、上から $ i $ 番目、左から $ j $ 列目のマスをマス $ (i,\ j) $ と呼びます。

マス $ (i,\ j) $ には $ a_{ij} $ 枚のコインが置かれています。

あなたは以下の操作を何度でも行うことができます。

操作: まだ選んだことのないマスのうち $ 1 $ 枚以上のコインが置かれているマスを $ 1 $ つ選び、そのマスに置かれているコインのうち $ 1 $ 枚を上下左右に隣接するいずれかのマスに移動する

偶数枚のコインが置かれたマスの数を最大化してください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ H $ $ W $ $ a_{11} $ $ a_{12} $ $ ... $ $ a_{1W} $ $ a_{21} $ $ a_{22} $ $ ... $ $ a_{2W} $ $ : $ $ a_{H1} $ $ a_{H2} $ $ ... $ $ a_{HW} $

## 输出格式

偶数枚のコインが置かれたマスの数が最大となるような操作の列を次の形式で出力せよ。

> $ N $ $ y_1 $ $ x_1 $ $ y_1' $ $ x_1' $ $ y_2 $ $ x_2 $ $ y_2' $ $ x_2' $ $ : $ $ y_N $ $ x_N $ $ y_N' $ $ x_N' $

すなわち、$ 1 $ 行目には操作の回数を表す $ 0 $ 以上 $ H\ \times\ W $ 以下の整数 $ N $ を出力せよ。

$ i+1 $ ($ 1\ \leq\ i\ \leq\ N $) 行目には $ i $ 回目の操作を表す整数 $ y_i,\ x_i,\ y_i',\ x_i' $ ($ 1\ \leq\ y_i,\ y_i'\ \leq\ H $ かつ $ 1\ \leq\ x_i,\ x_i'\ \leq\ W $) を出力せよ。 ただし、これはマス $ (y_i,\ x_i) $ にあるコインのうち $ 1 $ 枚を上下左右に隣接するマス $ (y_i',\ x_i') $ に移動させる操作を表す。

問題文中の操作でないような操作が与えられた場合や、出力の形式が正しくない場合には *Wrong Answer* となるので注意せよ。

## 说明/提示

### 制約

- 入力はすべて整数である
- $ 1\ \leq\ H,\ W\ \leq\ 500 $
- $ 0\ \leq\ a_{ij}\ \leq\ 9 $

### Sample Explanation 1

次のように操作を行えば、全てのマスに置かれたコインの数を偶数にできます。 - マス $ (2,\ 2) $ に置かれているコインのうち $ 1 $ 枚をマス $ (2,\ 3) $ に移動します - マス $ (1,\ 1) $ に置かれているコインのうち $ 1 $ 枚をマス $ (1,\ 2) $ に移動します - マス $ (1,\ 3) $ に置かれているコインのうち $ 1 $ 枚をマス $ (1,\ 2) $ に移動します

## 样例 #1

### 输入

```
2 3

1 2 3

0 1 1
```

### 输出

```
3

2 2 2 3

1 1 1 2

1 3 1 2
```

## 样例 #2

### 输入

```
3 2

1 0

2 1

1 0
```

### 输出

```
3

1 1 1 2

1 2 2 2

3 1 3 2
```

## 样例 #3

### 输入

```
1 5

9 9 9 9 9
```

### 输出

```
2

1 1 1 2

1 3 1 4
```



---

---
title: "[ABC110C] String Transformation"
layout: "post"
diff: 普及/提高-
pid: AT_abc110_c
tag: []
---

# [ABC110C] String Transformation

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc110/tasks/abc110_c

英小文字のみからなる文字列 $ S $, $ T $ が与えられます。

文字列 $ S $ に対して、次の操作を何度でも行うことができます。

操作: 2つの異なる英小文字 $ c_1 $, $ c_2 $ を選び、$ S $ に含まれる全ての $ c_1 $ を $ c_2 $ に、$ c_2 $ を $ c_1 $ に置き換える

$ 0 $ 回以上操作を行って、$ S $ を $ T $ に一致させられるか判定してください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ S $ $ T $

## 输出格式

$ S $ を $ T $ に一致させられる場合は `Yes`、そうでない場合は `No` を出力せよ。

## 说明/提示

### 制約

- $ 1\ \leq\ |S|\ \leq\ 2\ \times\ 10^5 $
- $ |S|\ =\ |T| $
- $ S $, $ T $ は英小文字のみからなる

### Sample Explanation 1

次のように操作を行えば、`azzel` を `apple` にできます。 - $ c_1 $ として `e` を、$ c_2 $ として `l` を選ぶと、`azzel` が `azzle` になる - $ c_1 $ として `z` を、$ c_2 $ として `p` を選ぶと、`azzle` が `apple` になる

### Sample Explanation 2

どのように操作を行っても `chokudai` を `redcoder` にできません。

## 样例 #1

### 输入

```
azzel

apple
```

### 输出

```
Yes
```

## 样例 #2

### 输入

```
chokudai

redcoder
```

### 输出

```
No
```

## 样例 #3

### 输入

```
abcdefghijklmnopqrstuvwxyz

ibyhqfrekavclxjstdwgpzmonu
```

### 输出

```
Yes
```



---

---
title: "[ABC112C] Pyramid"
layout: "post"
diff: 普及/提高-
pid: AT_abc112_c
tag: []
---

# [ABC112C] Pyramid

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc112/tasks/abc112_c

古代すぬけ国では, AtCoder 社長「高橋君」の権威を高めるために, ピラミッドが建てられていた.  
 ピラミッドには **中心座標** $ (C_X,\ C_Y) $ と **高さ** $ H $ が定まっており, 座標 $ (X,\ Y) $ の高度は $ max(H\ -\ |X\ -\ C_X|\ -\ |Y\ -\ C_Y|,\ 0) $ であった.

探検家の青木君は, このピラミッドの中心座標と高さを求めるために調査を行った. その結果, 次のような情報が得られた.

- $ C_X,\ C_Y $ は $ 0 $ 以上 $ 100 $ 以下の整数で, $ H $ は $ 1 $ 以上の整数であった.
- 上記と別に $ N $ 個の情報が得られた. そのうち $ i $ 個目の情報は, 「座標 $ (x_i,\ y_i) $ の高度は $ h_i $ である」

この情報は, ピラミッドの中心座標と高さを特定するのに十分であった. 情報を手掛かりに, これらの値を求めなさい.

## 输入格式

入力は以下の形式で標準入力から与えられる.

> $ N $ $ x_1 $ $ y_1 $ $ h_1 $ $ x_2 $ $ y_2 $ $ h_2 $ $ x_3 $ $ y_3 $ $ h_3 $ $ : $ $ x_N $ $ y_N $ $ h_N $

## 输出格式

特定した中心座標と高さを表す整数 $ C_X,\ C_Y,\ H $ を空白区切りで, 1 行に出力しなさい.

## 说明/提示

### 制約

- $ N $ は $ 1 $ 以上 $ 100 $ 以下の整数
- $ x_i $, $ y_i $ は $ 0 $ 以上 $ 100 $ 以下の整数
- $ h_i $ は $ 0 $ 以上 $ 10^9 $ 以下の整数
- $ N $ 個の座標 $ (x_1,\ y_1),\ (x_2,\ y_2),\ (x_3,\ y_3),\ ...,\ (x_N,\ y_N) $ はすべて異なる
- ピラミッドの中心座標と高さをちょうど $ 1 $ つに特定することができる

### Sample Explanation 1

この場合, 中心座標は $ (2,\ 2) $, 高さは $ 6 $ と特定することができる.

### Sample Explanation 2

この場合, 中心座標は $ (0,\ 0) $, 高さは $ 100 $ と特定することができる. $ C_X,\ C_Y $ が $ 0 $ 以上 $ 100 $ 以下の整数であると分かっていることに注意せよ.

### Sample Explanation 3

この場合, 中心座標は $ (100,\ 0) $, 高さは $ 193 $ と特定することができる.

## 样例 #1

### 输入

```
4

2 3 5

2 1 5

1 2 5

3 2 5
```

### 输出

```
2 2 6
```

## 样例 #2

### 输入

```
2

0 0 100

1 1 98
```

### 输出

```
0 0 100
```

## 样例 #3

### 输入

```
3

99 1 191

100 1 192

99 0 192
```

### 输出

```
100 0 193
```



---

---
title: "[ABC112D] Partition"
layout: "post"
diff: 普及/提高-
pid: AT_abc112_d
tag: []
---

# [ABC112D] Partition

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc112/tasks/abc112_d

整数 $ N,\ M $ が与えられます。

$ a_1\ +\ a_2\ +\ ...\ +\ a_N $ = $ M $ となる正整数からなる長さ $ N $ の数列 $ a $ において、$ a_1,\ a_2,\ ...,\ a_N $ の最大公約数のとり得る最大値を求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ M $

## 输出格式

条件を満たす数列 $ a_1,\ a_2,\ ...,\ a_N $ の最大公約数のとり得る最大値を出力せよ。

## 说明/提示

### 制約

- 入力はすべて整数である
- $ 1\ \leq\ N\ \leq\ 10^5 $
- $ N\ \leq\ M\ \leq\ 10^9 $

### Sample Explanation 1

$ (a_1,\ a_2,\ a_3)\ =\ (2,\ 4,\ 8) $ としたときこれらの最大公約数が $ 2 $ となり最大です。

## 样例 #1

### 输入

```
3 14
```

### 输出

```
2
```

## 样例 #2

### 输入

```
10 123
```

### 输出

```
3
```

## 样例 #3

### 输入

```
100000 1000000000
```

### 输出

```
10000
```



---

---
title: "[ABC113C] ID"
layout: "post"
diff: 普及/提高-
pid: AT_abc113_c
tag: []
---

# [ABC113C] ID

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc113/tasks/abc113_c

Atcoder国には $ N $ 個の県があり、これらの県には合計で $ M $ 個の市が属しています。

市 $ i $ が誕生したのは $ Y_i $ 年であり、県 $ P_i $ に属しています。

ただし、同じ年に誕生した市が複数存在することはないとします。

それぞれの市に $ 12 $ 桁の認識番号を割り振ることとなりました。

市 $ i $ が 県 $ P_i $ に属する市の中で $ x $ 番目に誕生した市のとき、市 $ i $ の認識番号の上 $ 6 $ 桁は $ P_i $、下 $ 6 $ 桁は $ x $ となります。

ただし、$ P_i $ や $ x $ が $ 6 $ 桁に満たない場合は $ 6 $ 桁になるまで $ 0 $ を左に追加するものとします。

全ての市の認識番号を求めてください。

ただし、市が $ 1 $ つも属さない県がある場合に注意してください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ M $ $ P_1 $ $ Y_1 $ $ : $ $ P_M $ $ Y_M $

## 输出格式

全ての市の認識番号を市の番号の昇順に出力せよ。

## 说明/提示

### 制約

- $ 1\ \leq\ N\ \leq\ 10^5 $
- $ 1\ \leq\ M\ \leq\ 10^5 $
- $ 1\ \leq\ P_i\ \leq\ N $
- $ 1\ \leq\ Y_i\ \leq\ 10^9 $
- $ Y_i $ は全て異なる
- 入力は全て整数

### Sample Explanation 1

\- 市 $ 1 $ は県 $ 1 $ に属する市の中で $ 2 $ 番目に誕生したので、認識番号は $ 000001000002 $ となります。 - 市 $ 2 $ は県 $ 2 $ に属する市の中で $ 1 $ 番目に誕生したので、認識番号は $ 000002000001 $ となります。 - 市 $ 3 $ は県 $ 1 $ に属する市の中で $ 1 $ 番目に誕生したので、認識番号は $ 000001000001 $ となります。

## 样例 #1

### 输入

```
2 3

1 32

2 63

1 12
```

### 输出

```
000001000002

000002000001

000001000001
```

## 样例 #2

### 输入

```
2 3

2 55

2 77

2 99
```

### 输出

```
000002000001

000002000002

000002000003
```



---

---
title: "[ABC115D] Christmas"
layout: "post"
diff: 普及/提高-
pid: AT_abc115_d
tag: []
---

# [ABC115D] Christmas

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc115/tasks/abc115_d

とある世界では、今日はクリスマスです。

高羽氏のパーティで、彼は多次元バーガーを作ることにしました。*レベル $ L $ バーガー* ($ L $ は $ 0 $ 以上の整数) とは次のようなものです。

- レベル $ 0 $ バーガーとは、パティ $ 1 $ 枚である。
- レベル $ L $ バーガー $ (L\ \geq\ 1) $ とは、バン $ 1 $ 枚、レベル $ L-1 $ バーガー、パティ $ 1 $ 枚、レベル $ L-1 $ バーガー、バン $ 1 $ 枚、をこの順に下から積み重ねたものである。

例えば、パティを `P`、バンを `B` で表すと、レベル $ 1 $ バーガーは `BPPPB` (を $ 90 $ 度回転したもの)、レベル $ 2 $ バーガーは `BBPPPBPBPPPBB` といった見た目になります。

高羽氏が作るのはレベル $ N $ バーガーです。ダックスフンドのルンルンは、このバーガーの下から $ X $ 層を食べます (パティまたはバン $ 1 $ 枚を $ 1 $ 層とします)。ルンルンはパティを何枚食べるでしょうか？

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ X $

## 输出格式

レベル $ N $ バーガーの下から $ X $ 層に含まれるパティの枚数を出力せよ。

## 说明/提示

### 制約

- $ 1\ \leq\ N\ \leq\ 50 $
- $ 1\ \leq\ X\ \leq\ ( $ レベル $ N $ バーガーの層の総数 $ ) $
- $ N,\ X $ は整数である。

### Sample Explanation 1

レベル $ 2 $ バーガー (`BBPPPBPBPPPBB`) の下から $ 7 $ 層にはパティが $ 4 $ 枚含まれます。

### Sample Explanation 2

レベル $ 1 $ バーガーの一番下の層はバンです。

### Sample Explanation 3

レベル $ 50 $ バーガーは層の数が $ 32 $ ビット整数に収まらない程度に分厚いです。

## 样例 #1

### 输入

```
2 7
```

### 输出

```
4
```

## 样例 #2

### 输入

```
1 1
```

### 输出

```
0
```

## 样例 #3

### 输入

```
50 4321098765432109
```

### 输出

```
2160549382716056
```



---

---
title: "[ABC121D] XOR World"
layout: "post"
diff: 普及/提高-
pid: AT_abc121_d
tag: []
---

# [ABC121D] XOR World

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc121/tasks/abc121_d

$ f(A,\ B) $ を $ A,\ A+1,\ ...,\ B $ の排他的論理和としたとき、$ f(A,\ B) $ を求めてください。

排他的論理和とは

整数 $ c_1,\ c_2,\ ...,\ c_n $ のビットごとの排他的論理和 $ y $ は、以下のように定義されます。

- $ y $ を二進表記した際の $ 2^k $ ($ k\ \geq\ 0 $) の位の数は、$ c_1,\ c_2,\ ...,\ c_n $ のうち、二進表記した際の $ 2^k $ の位の数が $ 1 $ となるものが奇数個ならば $ 1 $、偶数個ならば $ 0 $ である。

例えば、$ 3 $ と $ 5 $ の排他的論理和は $ 6 $ です(二進数表記すると: `011` と `101` の排他的論理和は `110` です)。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ A $ $ B $

## 输出格式

$ f(A,\ B) $ を計算し、出力せよ。

## 说明/提示

### 制約

- 入力は全て整数である。
- $ 0\ \leq\ A\ \leq\ B\ \leq\ 10^{12} $

### Sample Explanation 1

$ 2,\ 3,\ 4 $ は $ 2 $ 進数でそれぞれ `010`, `011`, `100` です。 これらの排他的論理和は `101` であり、これを $ 10 $ 進数表記にすると $ 5 $ になります。

## 样例 #1

### 输入

```
2 4
```

### 输出

```
5
```

## 样例 #2

### 输入

```
123 456
```

### 输出

```
435
```

## 样例 #3

### 输入

```
123456789012 123456789012
```

### 输出

```
123456789012
```



---

---
title: "[ABC122C] GeT AC"
layout: "post"
diff: 普及/提高-
pid: AT_abc122_c
tag: []
---

# [ABC122C] GeT AC

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc122/tasks/abc122_c

`A`, `C`, `G`, `T` からなる長さ $ N $ の文字列 $ S $ が与えられます。以下の $ Q $ 個の問いに答えてください。

- 問 $ i $ ($ 1\ \leq\ i\ \leq\ Q $): 整数 $ l_i,\ r_i $ ($ 1\ \leq\ l_i\ <\ r_i\ \leq\ N $) が与えられる。$ S $ の先頭から $ l_i $ 文字目から $ r_i $ 文字目までの (両端含む) 部分文字列を考える。この文字列に `AC` は部分文字列として何回現れるか。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ Q $ $ S $ $ l_1 $ $ r_1 $ $ : $ $ l_Q $ $ r_Q $

## 输出格式

$ Q $ 行出力せよ。$ i $ 行目に問 $ i $ への答えを出力すること。

## 说明/提示

### 注記

文字列 $ T $ の部分文字列とは、$ T $ の先頭と末尾から $ 0 $ 文字以上を取り去って得られる文字列です。

例えば、`ATCODER` の部分文字列には `TCO`, `AT`, `CODER`, `ATCODER`, `` (空文字列) が含まれ、`AC` は含まれません。

### 制約

- $ 2\ \leq\ N\ \leq\ 10^5 $
- $ 1\ \leq\ Q\ \leq\ 10^5 $
- $ S $ は長さ $ N $ の文字列である。
- $ S $ の各文字は `A`, `C`, `G`, `T` のいずれかである。
- $ 1\ \leq\ l_i\ <\ r_i\ \leq\ N $

### Sample Explanation 1

\- 問 $ 1 $: $ S $ の先頭から $ 3 $ 文字目から $ 7 $ 文字目までの部分文字列は `ACTAC` です。この文字列に `AC` は部分文字列として $ 2 $ 回現れます。 - 問 $ 2 $: $ S $ の先頭から $ 2 $ 文字目から $ 3 $ 文字目までの部分文字列は `CA` です。この文字列に `AC` は部分文字列として $ 0 $ 回現れます。 - 問 $ 3 $: $ S $ の先頭から $ 1 $ 文字目から $ 8 $ 文字目までの部分文字列は `ACACTACG` です。この文字列に `AC` は部分文字列として $ 3 $ 回現れます。

## 样例 #1

### 输入

```
8 3

ACACTACG

3 7

2 3

1 8
```

### 输出

```
2

0

3
```



---

---
title: "[ABC124D] Handstand"
layout: "post"
diff: 普及/提高-
pid: AT_abc124_d
tag: []
---

# [ABC124D] Handstand

## 题目描述

有一个长为 $n$ 的字符串 $s$，只含 $0$ 和 $1$。  

你可以进行最多 $k$ 次如下操作（$0$ 次也可以）：



- 选择字符串 $s$ 的一个子串，将其中的字符反转（$0$ 变成 $1$，$1$ 变成 $0$）。



进行不超过 $k$ 次操作后，求最长的连续的 $1$ 的长度。

## 输入格式

第一行，$2$ 个正整数 $n,k$；  

第二行，字符串 $s$。

## 输出格式

输出不超过 $k$ 次操作后，最长的连续的 $1$ 的长度。



### 数据约定



对于 $100\%$ 的数据：$1 \le n, k \le 10^5$。  

字符串 $s$ 只由 $0$ 和 $1$ 组成，长度为 $n$。

## 样例 #1

### 输入

```
5 1

00010
```

### 输出

```
4
```

## 样例 #2

### 输入

```
14 2

11101010110011
```

### 输出

```
8
```

## 样例 #3

### 输入

```
1 1

1
```

### 输出

```
1
```



---

---
title: "[ABC125C] GCD on Blackboard"
layout: "post"
diff: 普及/提高-
pid: AT_abc125_c
tag: []
---

# [ABC125C] GCD on Blackboard

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc125/tasks/abc125_c

$ N $ 個の整数 $ A_1,\ A_2,\ ...,\ A_N $ が黒板に書かれています。

あなたはこの中から整数を $ 1 $ つ選んで、$ 1 $ 以上 $ 10^9 $ 以下の好きな整数に書き換えます。

元の整数と同じ整数に書き換えても構いません。

書き換えた後の $ N $ 個の整数の最大公約数の最大値を求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ A_1 $ $ A_2 $ $ ... $ $ A_N $

## 输出格式

書き換えた後の $ N $ 個の整数の最大公約数の最大値を出力せよ。

## 说明/提示

### 制約

- 入力は全て整数である。
- $ 2\ \leq\ N\ \leq\ 10^5 $
- $ 1\ \leq\ A_i\ \leq\ 10^9 $

### Sample Explanation 1

$ 7 $ を $ 4 $ に書き換えると $ 3 $ つの整数の最大公約数は $ 2 $ となり、これが最大です。

### Sample Explanation 3

元の整数と同じ整数に書き換えることも可能です。

## 样例 #1

### 输入

```
3

7 6 8
```

### 输出

```
2
```

## 样例 #2

### 输入

```
3

12 15 18
```

### 输出

```
6
```

## 样例 #3

### 输入

```
2

1000000000 1000000000
```

### 输出

```
1000000000
```



---

---
title: "[ABC125D] Flipping Signs"
layout: "post"
diff: 普及/提高-
pid: AT_abc125_d
tag: []
---

# [ABC125D] Flipping Signs

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc125/tasks/abc125_d

$ N $ 個の整数が並んでおり、順に $ A_1,\ A_2,\ ...,\ A_N $ です。

あなたはこの整数列に対して次の操作を好きなだけ行うことができます。

**操作**: $ 1\ \leq\ i\ \leq\ N-1 $ を満たす整数 $ i $ を選ぶ。$ A_i $ と $ A_{i+1} $ に $ -1 $ を乗算する。

操作終了後の整数列を $ B_1,\ B_2,\ ...,\ B_N $ とします。

$ B_1\ +\ B_2\ +\ ...\ +\ B_N $ の最大値を求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ A_1 $ $ A_2 $ $ ... $ $ A_N $

## 输出格式

$ B_1\ +\ B_2\ +\ ...\ +\ B_N $ の最大値を出力せよ。

## 说明/提示

### 制約

- 入力は全て整数である。
- $ 2\ \leq\ N\ \leq\ 10^5 $
- $ -10^9\ \leq\ A_i\ \leq\ 10^9 $

### Sample Explanation 1

次のように操作を行うと、$ B_1\ =\ 10,\ B_2\ =\ 5,\ B_3\ =\ 4 $ になり、このときの $ B_1\ +\ B_2\ +\ B_3\ =\ 10\ +\ 5\ +\ 4\ =\ 19 $ が最大です。 - $ i $ として $ 1 $ を選ぶ。操作により、整数列は $ 10,\ -5,\ -4 $ に変化する。 - $ i $ として $ 2 $ を選ぶ。操作により、整数列は $ 10,\ 5,\ 4 $ に変化する。

### Sample Explanation 3

出力が $ 32 $ ビット整数型に収まらない場合があります。

## 样例 #1

### 输入

```
3

-10 5 -4
```

### 输出

```
19
```

## 样例 #2

### 输入

```
5

10 -4 -8 -11 3
```

### 输出

```
30
```

## 样例 #3

### 输入

```
11

-1000000000 1000000000 -1000000000 1000000000 -1000000000 0 1000000000 -1000000000 1000000000 -1000000000 1000000000
```

### 输出

```
10000000000
```



---

---
title: "[ABC126D] Even Relation"
layout: "post"
diff: 普及/提高-
pid: AT_abc126_d
tag: []
---

# [ABC126D] Even Relation

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc126/tasks/abc126_d

$ N $ 頂点の木があります。 この木の $ i $ 番目の辺は頂点 $ u_i $ と頂点 $ v_i $ を結んでおり、その長さは $ w_i $ です。 あなたは以下の条件を満たすように、この木の頂点を白と黒の $ 2 $ 色で塗り分けたいです (すべての頂点を同じ色で塗っても構いません)。

- 同じ色に塗られた任意の $ 2 $ 頂点について、その距離が偶数である。

条件を満たす塗り分け方を $ 1 $ つ見つけて出力してください。この問題の制約下では、そのような塗り分け方が必ず $ 1 $ つは存在することが証明できます。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ u_1 $ $ v_1 $ $ w_1 $ $ u_2 $ $ v_2 $ $ w_2 $ $ . $ $ . $ $ . $ $ u_{N\ -\ 1} $ $ v_{N\ -\ 1} $ $ w_{N\ -\ 1} $

## 输出格式

題意の条件を満たすような頂点の塗り分け方を $ N $ 行に分けて出力せよ。 $ i $ 行目には、頂点 $ i $ を白く塗る場合は `0` を、黒く塗る場合は `1` を出力せよ。

条件を満たす塗り分け方が複数存在する場合、どれを出力してもよい。

## 说明/提示

### 制約

- 入力は全て整数である。
- $ 1\ \leq\ N\ \leq\ 10^5 $
- $ 1\ \leq\ u_i\ <\ v_i\ \leq\ N $
- $ 1\ \leq\ w_i\ \leq\ 10^9 $

## 样例 #1

### 输入

```
3

1 2 2

2 3 1
```

### 输出

```
0

0

1
```

## 样例 #2

### 输入

```
5

2 5 2

2 3 10

1 3 8

3 4 2
```

### 输出

```
1

0

1

0

1
```



---

---
title: "[ABC127D] Integer Cards"
layout: "post"
diff: 普及/提高-
pid: AT_abc127_d
tag: []
---

# [ABC127D] Integer Cards

## 题目描述

有一个长度为 $n$ 的序列 $A_{1},A_{2},\cdots,A_{n} $

你可以对这个序列依次进行 $m$ 次操作，第 $ i$ 次操作中，你可以选择至多 $B_{i}$ 个数（可以一个都不选），然后将这些数变成 $C_{i}$

问进行这 $m$ 次操作后，这个序列所有元素之和可能的最大值是多少

## 输入格式

第一行两个整数 $n,m$

第二行 $n$ 个整数，表示序列 $A$

接下来 $m$ 行，每行两个整数 $B_{i},C_{i}$ ，表示一次操作

## 输出格式

一行一个整数，表示答案

## 说明/提示

$1 \le n,m \le 10^5,1 \le A_{i},C{i} \le 10^9,1 \le B_{i} \le n$

## 样例 #1

### 输入

```
3 2

5 1 4

2 3

1 5
```

### 输出

```
14
```

## 样例 #2

### 输入

```
10 3

1 8 5 7 100 4 52 33 13 5

3 10

4 30

1 4
```

### 输出

```
338
```

## 样例 #3

### 输入

```
3 2

100 100 100

3 99

3 99
```

### 输出

```
300
```

## 样例 #4

### 输入

```
11 3

1 1 1 1 1 1 1 1 1 1 1

3 1000000000

4 1000000000

3 1000000000
```

### 输出

```
10000000001
```



---

---
title: "[ABC129D] Lamp"
layout: "post"
diff: 普及/提高-
pid: AT_abc129_d
tag: []
---

# [ABC129D] Lamp

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc129/tasks/abc129_d

縦 $ H $ 行横 $ W $ 列のグリッドが与えられます。このグリッドのうち、いくつかのマスには障害物が存在します。

すぬけ君は、障害物のないマスのうち一つを選び、そのマスに明かりを設置しようとしています。 設置されたマスから、上下左右の四方向にまっすぐに光線が伸びます。それぞれの方向について、最初に障害物が存在するマスにぶつかる、もしくはグリッドの端にぶつかる手前のマスまで照らされます。明かりを設置したマスも照らされますが、障害物が存在するマスは照らされません。

すぬけ君は明かりによって照らされるマスの個数を最大化したいです。

$ H $ 個の長さ $ W $ の文字列 $ S_i $ ($ 1\ <\ =\ i\ <\ =\ H $) が与えられます。$ S_i $ の $ j $ 文字目 ($ 1\ <\ =\ j\ <\ =\ W $) が `#` のとき、グリッドの上から $ i $ 行目で左から $ j $ 列目のマスには障害物があり、 `.` のときは障害物がありません。

照らされるマスの個数の最大値を求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ H $ $ W $ $ S_1 $ $ : $ $ S_H $

## 输出格式

照らされるマスの個数の最大値を出力せよ。

## 说明/提示

### 制約

- $ 1\ <\ =\ H\ <\ =\ 2,000 $
- $ 1\ <\ =\ W\ <\ =\ 2,000 $
- $ S_i $ は `#` と `.` のみからなる長さ $ W $ の文字列
- $ S_i $ ($ 1\ <\ =\ i\ <\ =\ H $) のうちいずれかに `.` は最低 $ 1 $ つ存在する

### Sample Explanation 1

すぬけ君が上から $ 2 $ 行目、左から $ 2 $ 列目のマスに明かりを設置すると、上から $ 2 $ 行目のうち左から $ 1 $ 〜 $ 5 $ 列目のマス、 左から $ 2 $ 列目のうち上から $ 1 $ 〜 $ 4 $ 列目のマス全てが照らされ、全部で $ 8 $ マスです。

## 样例 #1

### 输入

```
4 6

#..#..

.....#

....#.

#.#...
```

### 输出

```
8
```

## 样例 #2

### 输入

```
8 8

..#...#.

....#...

##......

..###..#

...#..#.

##....#.

#...#...

###.#..#
```

### 输出

```
13
```



---

---
title: "[ABC130D] Enough Array"
layout: "post"
diff: 普及/提高-
pid: AT_abc130_d
tag: []
---

# [ABC130D] Enough Array

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc130/tasks/abc130_d

長さ $ N $ の正整数列 $ A=a_1,a_2,…,a_{N} $ と整数 $ K $ が与えられます。$ A $ の連続する部分列であって、以下の条件を満たすようなものは何個あるでしょうか。

- (条件) 連続部分列に含まれる全ての要素の値の和は、$ K $ 以上である。

ただし、ある二つの連続部分列が列として同じでも、取り出された位置が異なるならそれらは別々に数えるものとします。

出力が $ 32bit $ 整数型に収まらない場合があることに注意してください。

## 输入格式

入力は以下の形式で標準入力から与えられます。

> $ N $ $ K $ $ a_1 $ $ a_2 $ $ ... $ $ a_N $

## 输出格式

条件を満たすような連続部分列の個数を出力してください。

## 说明/提示

### 制約

- $ 1\ \leqq\ a_i\ \leqq\ 10^5 $
- $ 1\ \leqq\ N\ \leqq\ 10^5 $
- $ 1\ \leqq\ K\ \leqq\ 10^{10} $

### Sample Explanation 1

\- $ A[1..4]=a_1,a_2,a_3,a_4 $ (要素の値の和は $ 16 $) - $ A[2..4]=a_2,a_3,a_4 $ (要素の値の和は $ 10 $) の二通りです。

### Sample Explanation 2

ある二つの連続部分列が列として同じでも、取り出された位置が異なるならそれらは別々に数えることに注意してください。

## 样例 #1

### 输入

```
4 10

6 1 2 7
```

### 输出

```
2
```

## 样例 #2

### 输入

```
3 5

3 3 3
```

### 输出

```
3
```

## 样例 #3

### 输入

```
10 53462

103 35322 232 342 21099 90000 18843 9010 35221 19352
```

### 输出

```
36
```



---

---
title: "[ABC133D] Rain Flows into Dams"
layout: "post"
diff: 普及/提高-
pid: AT_abc133_d
tag: []
---

# [ABC133D] Rain Flows into Dams

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc133/tasks/abc133_d

円形に $ N $ 個の山が連なっており、時計回りに山 $ 1 $, 山 $ 2 $, $ … $, 山 $ N $ と呼ばれます。$ N $ は**奇数**です。

これらの山の間に $ N $ 個のダムがあり、ダム $ 1 $, ダム $ 2 $, $ … $, ダム $ N $ と呼ばれます。ダム $ i $ ($ 1\ \leq\ i\ \leq\ N $) は山 $ i $ と山 $ i+1 $ の間にあります (山 $ N+1 $ は山 $ 1 $ のことを指します)。

山 $ i $ ($ 1\ \leq\ i\ \leq\ N $) に $ 2x $ リットルの雨が降ると、ダム $ i-1 $ とダム $ i $ にそれぞれ $ x $ リットルずつ水が溜まります (ダム $ 0 $ はダム $ N $ のことを指します)。

ある日、各山に非負の**偶数**リットルの雨が降りました。

その結果、ダム $ i $ ($ 1\ \leq\ i\ \leq\ N $) には合計で $ A_i $ リットルの水が溜まりました。

各山に降った雨の量を求めてください。この問題の制約下では解が一意に定まることが証明できます。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ A_1 $ $ A_2 $ $ ... $ $ A_N $

## 输出格式

山 $ 1 $, 山 $ 2 $, $ … $, 山 $ N $ に降った雨の量を表す $ N $ 個の整数をこの順に出力せよ。

## 说明/提示

### 制約

- 入力は全て整数である。
- $ 3\ \leq\ N\ \leq\ 10^5-1 $
- $ N $ は奇数である。
- $ 0\ \leq\ A_i\ \leq\ 10^9 $
- 入力が表す状況は、各山に非負の偶数リットルの雨が降った際に発生しうる。

### Sample Explanation 1

山 $ 1,\ 2,\ 3 $ に降った雨の量をそれぞれ $ 4 $ リットル, $ 0 $ リットル, $ 4 $ リットルとすると以下のように辻褄が合います。 - ダム $ 1 $ には $ \frac{4}{2}\ +\ \frac{0}{2}\ =\ 2 $ リットルの水が溜まります。 - ダム $ 2 $ には $ \frac{0}{2}\ +\ \frac{4}{2}\ =\ 2 $ リットルの水が溜まります。 - ダム $ 3 $ には $ \frac{4}{2}\ +\ \frac{4}{2}\ =\ 4 $ リットルの水が溜まります。

## 样例 #1

### 输入

```
3

2 2 4
```

### 输出

```
4 0 4
```

## 样例 #2

### 输入

```
5

3 8 7 5 5
```

### 输出

```
2 4 12 2 8
```

## 样例 #3

### 输入

```
3

1000000000 1000000000 0
```

### 输出

```
0 2000000000 0
```



---

---
title: "[ABC134D] Preparing Boxes"
layout: "post"
diff: 普及/提高-
pid: AT_abc134_d
tag: []
---

# [ABC134D] Preparing Boxes

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc134/tasks/abc134_d

$ N $ 個の空の箱が横一列に並んでいます。 左から $ i $ $ \ (1\ \leq\ i\ \leq\ N) $ 番目の箱には整数 $ i $ が書かれています。

すぬけさんは、それぞれの箱に対してボールを $ 1 $ 個入れるか何も入れないかを選ぶことができます。

ここで、以下の条件を満たすようなボールの入れ方を、いいボールの入れ方と定めます。

- $ 1 $ 以上 $ N $ 以下の任意の整数 $ i $ について、$ i $ の倍数が書かれた箱に入っているボールの個数の和を $ 2 $ で割った余りが $ a_i $ である。

いいボールの入れ方は存在するでしょうか。存在するならば $ 1 $ つ求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ a_1 $ $ a_2 $ ... $ a_N $

## 输出格式

いいボールの入れ方が存在しないなら `-1` を出力せよ。

存在するならば、そのような入れ方のうちの $ 1 $ つを以下の形式で出力せよ。

> $ M $ $ b_1 $ $ b_2 $ $ ... $ $ b_M $

ここで $ M $ はボールを入れる箱の個数を表し、$ b_1,\ b_2,\ ...,\ b_M $ はボールを入れる箱に書かれた整数を任意の順番に並べたものである。

## 说明/提示

### 制約

- 入力は全て整数である。
- $ 1\ \leq\ N\ \leq\ 2\ \times\ 10^5 $
- $ a_i $ は $ 0 $ または $ 1 $ である。

### Sample Explanation 1

$ 1 $ が書かれた箱だけにボールを入れることを考えます。 - $ 1 $ の倍数が書かれた箱は、$ 1 $ が書かれた箱、$ 2 $ が書かれた箱、$ 3 $ が書かれた箱の $ 3 $ 個です。これらの箱に入っているボールの個数の和は $ 1 $ です。 - $ 2 $ の倍数が書かれた箱は、$ 2 $ が書かれた箱の $ 1 $ 個だけです。これらの箱に入っているボールの個数の和は $ 0 $ です。 - $ 3 $ の倍数が書かれた箱は、$ 3 $ が書かれた箱の $ 1 $ 個だけです。これらの箱に入っているボールの個数の和は $ 0 $ です。 以上より、$ 1 $ が書かれた箱だけにボールを入れるのは、与えられた条件を満たすいいボールの入れ方です。

### Sample Explanation 2

ボールを $ 1 $ つも入れない入れ方が、いい入れ方になる場合もあります。

## 样例 #1

### 输入

```
3

1 0 0
```

### 输出

```
1

1
```

## 样例 #2

### 输入

```
5

0 0 0 0 0
```

### 输出

```
0
```



---

---
title: "[ABC134E] Sequence Decomposing"
layout: "post"
diff: 普及/提高-
pid: AT_abc134_e
tag: []
---

# [ABC134E] Sequence Decomposing

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc134/tasks/abc134_e

$ N $ 個の整数からなる数列 $ A\ =\ \{\ A_1,\ A_2,\ \cdots,\ A_N\ \} $ が与えられます。 $ N $ 個それぞれの整数に対して、色を $ 1 $ つ選んでその色を塗ります。 この時、以下の条件を満たす必要があります:

- $ A_i $ と $ A_j\ (i\ <\ j) $ が同じ色で塗られているならば $ A_i\ <\ A_j $ が成立する

条件を満たすように色を塗る時、用いる色の数の最小値を求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ A_1 $ $ : $ $ A_N $

## 输出格式

条件を満たすように色を塗る時、用いる色の数の最小値を出力せよ。

## 说明/提示

### 制約

- $ 1\ \leq\ N\ \leq\ 10^5 $
- $ 0\ \leq\ A_i\ \leq\ 10^9 $

### Sample Explanation 1

例えば、$ 2,\ 3 $ を赤色、$ 1,\ 4,\ 5 $ を青色で塗れば $ 2 $ 色で条件を満たす塗り方が出来ます。

### Sample Explanation 2

全ての整数を異なる色で塗るしかありません。

## 样例 #1

### 输入

```
5

2

1

4

5

3
```

### 输出

```
2
```

## 样例 #2

### 输入

```
4

0

0

0

0
```

### 输出

```
4
```



---

---
title: "[ABC135D] Digits Parade"
layout: "post"
diff: 普及/提高-
pid: AT_abc135_d
tag: []
---

# [ABC135D] Digits Parade

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc135/tasks/abc135_d

文字列 $ S $ が与えられます。$ S $ の各文字は、数字 (`0` ～ `9`) か `?` です。

`?` を数字に置き換えてできる整数のうち、$ 13 $ で割って $ 5 $ あまる数は何通りあるでしょうか？ただし、頭文字が $ 0 $ である場合も整数とみなすものとします。

答えは非常に大きくなる可能性があるため、$ 10^9+7 $ で割ったあまりを答えてください。

## 输入格式

入力は以下の形式で標準入力から与えられます。

> $ S $

## 输出格式

条件を満たす整数の個数を $ 10^9+7 $ で割ったあまりを出力してください。

## 说明/提示

### 制約

- $ S $ は数字 (`0` ～ `9`) と `?` からなる文字列。
- $ 1\ \leq\ |S|\ \leq\ 10^5 $

### Sample Explanation 1

たとえば $ 482305,\ 002865,\ 972665 $ などが条件を満たします。

### Sample Explanation 2

$ 044 $ のみが条件を満たします。

### Sample Explanation 3

条件を満たす整数を作ることが不可能な場合もあります。

## 样例 #1

### 输入

```
??2??5
```

### 输出

```
768
```

## 样例 #2

### 输入

```
?44
```

### 输出

```
1
```

## 样例 #3

### 输入

```
7?4
```

### 输出

```
0
```

## 样例 #4

### 输入

```
?6?42???8??2??06243????9??3???7258??5??7???????774????4?1??17???9?5?70???76???
```

### 输出

```
153716888
```



---

---
title: "[ABC137C] Green Bin"
layout: "post"
diff: 普及/提高-
pid: AT_abc137_c
tag: []
---

# [ABC137C] Green Bin

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc137/tasks/abc137_c

文字列 $ a $ に含まれる文字を何らかの順序で並べることで得られる文字列を $ a $ の *アナグラム* と呼びます。

例えば、`greenbin` は `beginner` のアナグラムです。このように、同じ文字が複数回現れるときはその文字をちょうどその回数だけ使わなければなりません。

$ N $ 個の文字列 $ s_1,\ s_2,\ \ldots,\ s_N $ が与えられます。それぞれの文字列は長さが $ 10 $ で英小文字からなり、またこれらの文字列はすべて異なります。二つの整数 $ i,\ j $ $ (1\ \leq\ i\ <\ j\ \leq\ N) $ の組であって、$ s_i $ が $ s_j $ のアナグラムであるようなものの個数を求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ s_1 $ $ s_2 $ $ : $ $ s_N $

## 输出格式

二つの整数 $ i,\ j $ $ (1\ \leq\ i\ <\ j\ \leq\ N) $ の組であって、$ s_i $ が $ s_j $ のアナグラムであるようなものの個数を出力せよ。

## 说明/提示

### 制約

- $ 2\ \leq\ N\ \leq\ 10^5 $
- $ s_i $ は長さ $ 10 $ の文字列である。
- $ s_i $ の各文字は英小文字である。
- $ s_1,\ s_2,\ \ldots,\ s_N $ はすべて異なる。

### Sample Explanation 1

$ s_1\ = $ `acornistnt` は $ s_3\ = $ `constraint` のアナグラムです。他に $ s_i $ が $ s_j $ のアナグラムであるような $ i,\ j $ の組はないため、答えは $ 1 $ です。

### Sample Explanation 2

$ s_i $ が $ s_j $ のアナグラムであるような $ i,\ j $ の組がないときは $ 0 $ と出力してください。

### Sample Explanation 3

ここにそのようなケースを置くことはできませんが、答えは $ 32 $ bit 整数型に収まらない可能性があるので注意してください。

## 样例 #1

### 输入

```
3

acornistnt

peanutbomb

constraint
```

### 输出

```
1
```

## 样例 #2

### 输入

```
2

oneplustwo

ninemodsix
```

### 输出

```
0
```

## 样例 #3

### 输入

```
5

abaaaaaaaa

oneplustwo

aaaaaaaaba

twoplusone

aaaabaaaaa
```

### 输出

```
4
```



---

---
title: "[ABC138D] Ki"
layout: "post"
diff: 普及/提高-
pid: AT_abc138_d
tag: []
---

# [ABC138D] Ki

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc138/tasks/abc138_d

$ 1 $ から $ N $ までの番号がついた $ N $ 個の頂点を持つ根付き木が与えられます。 この木の根は頂点 $ 1 $ で、$ i $ 番目の辺 $ (1\ \leq\ i\ \leq\ N\ -\ 1) $ は頂点 $ a_i $ と頂点 $ b_i $ を結びます。

各頂点にはカウンターが設置されており、はじめすべての頂点のカウンターの値は $ 0 $ です。

これから、以下のような $ Q $ 回の操作が行われます。

- 操作 $ j $ $ (1\ \leq\ j\ \leq\ Q) $: 頂点 $ p_j $ を根とする部分木に含まれるすべての頂点のカウンターの値に $ x_j $ を足す。

すべての操作のあとの各頂点のカウンターの値を求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ Q $ $ a_1 $ $ b_1 $ $ : $ $ a_{N-1} $ $ b_{N-1} $ $ p_1 $ $ x_1 $ $ : $ $ p_Q $ $ x_Q $

## 输出格式

すべての操作のあとの各頂点のカウンターの値を、頂点 $ 1,\ 2,\ \ldots,\ N $ の順に空白区切りで出力せよ。

## 说明/提示

### 制約

- $ 2\ \leq\ N\ \leq\ 2\ \times\ 10^5 $
- $ 1\ \leq\ Q\ \leq\ 2\ \times\ 10^5 $
- $ 1\ \leq\ a_i\ <\ b_i\ \leq\ N $
- $ 1\ \leq\ p_j\ \leq\ N $
- $ 1\ \leq\ x_j\ \leq\ 10^4 $
- 与えられるグラフは木である。
- 入力中の値はすべて整数である。

### Sample Explanation 1

この入力中の木は次のようなものです。 !\[図\](https://img.atcoder.jp/ghi/c771b2231be06af79a9994cbe6867552.png) 各操作で、頂点のカウンターの値は次のように変化します。 - 操作 $ 1 $: 頂点 $ 2 $ を根とする部分木に含まれるすべての頂点、すなわち頂点 $ 2,\ 3,\ 4 $ のカウンターの値に $ 10 $ を足す。頂点 $ 1,\ 2,\ 3,\ 4 $ のカウンターの値はそれぞれ $ 0,\ 10,\ 10,\ 10 $ となる。 - 操作 $ 2 $: 頂点 $ 1 $ を根とする部分木に含まれるすべての頂点、すなわち頂点 $ 1,\ 2,\ 3,\ 4 $ のカウンターの値に $ 100 $ を足す。頂点 $ 1,\ 2,\ 3,\ 4 $ のカウンターの値はそれぞれ $ 100,\ 110,\ 110,\ 110 $ となる。 - 操作 $ 3 $: 頂点 $ 3 $ を根とする部分木に含まれるすべての頂点、すなわち頂点 $ 3 $ のカウンターの値に $ 1 $ を足す。頂点 $ 1,\ 2,\ 3,\ 4 $ のカウンターの値はそれぞれ $ 100,\ 110,\ 111,\ 110 $ となる。

## 样例 #1

### 输入

```
4 3

1 2

2 3

2 4

2 10

1 100

3 1
```

### 输出

```
100 110 111 110
```

## 样例 #2

### 输入

```
6 2

1 2

1 3

2 4

3 6

2 5

1 10

1 10
```

### 输出

```
20 20 20 20 20 20
```



---

---
title: "[ABC140D] Face Produces Unhappiness"
layout: "post"
diff: 普及/提高-
pid: AT_abc140_d
tag: []
---

# [ABC140D] Face Produces Unhappiness

## 题目描述

有 $N$ 个人从东向西排成一排，每个人的状态用一个字符串 $S$ 表示，第i个字符 $s_i$

 表示从西边数起第 $i$ 个人的朝向```L```
表示面朝西， ```R``` 表示面朝东。

对于队伍中的每个人，如果自己面前的人的朝向和自己一样，那么这个人就会感到幸福。如果面前的人朝向和自己不一样，或者面前没有人，这个人就感到不幸福。

你可以进行以下操作最多 $K$ 次（也可以一次都不进行）：

选择整数$l,r（1≤l≤r≤N）$，让从西边数起第 $l,l+1,⋯,r$ 个人转身180度。

经过最多 $K$ 次操作后，感到幸福的人最多有多少人？

## 输入格式

第1行，2个正整数 $N,K$。

第2行，一个字符串 $S$ 。

## 输出格式

一行一个正数表示答案

## 样例 #1

### 输入

```
6 1

LRLRRL
```

### 输出

```
3
```

## 样例 #2

### 输入

```
13 3

LRRLRLRRLRLLR
```

### 输出

```
9
```

## 样例 #3

### 输入

```
10 1

LLLLLRRRRR
```

### 输出

```
9
```

## 样例 #4

### 输入

```
9 2

RRRLRLRLL
```

### 输出

```
7
```



---

---
title: "[ABC142D] Disjoint Set of Common Divisors"
layout: "post"
diff: 普及/提高-
pid: AT_abc142_d
tag: []
---

# [ABC142D] Disjoint Set of Common Divisors

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc142/tasks/abc142_d

正整数 $ A,\ B $ が与えられます。

$ A $ と $ B $ の正の公約数の中からいくつかを選びます。

ただし、選んだ整数の中のどの異なる $ 2 $ つの整数についても互いに素でなければなりません。

最大でいくつ選べるでしょうか。

 公約数とは整数 $ d $ が整数 $ x $ と整数 $ y $ の公約数であるとは、$ d $ が $ x $ と $ y $ をともに割り切ることをいいます。

 

互いに素とは整数 $ x,\ y $ が互いに素であるとは、$ x,\ y $ の正の公約数が $ 1 $ のみであることをいいます。

 

割り切るとは整数 $ x $ が整数 $ y $ を割り切るとは、$ y\ =\ \alpha\ x $ なる整数 $ \alpha $ が存在することをいいます。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ A $ $ B $

## 输出格式

条件を満たすように選べる整数の個数の最大値を出力せよ。

## 说明/提示

### 制約

- 入力は全て整数である。
- $ 1\ \leq\ A,\ B\ \leq\ 10^{12} $

### Sample Explanation 1

$ 12 $ と $ 18 $ の正の公約数は $ 1,\ 2,\ 3,\ 6 $ です。 $ 1 $ と $ 2 $、$ 2 $ と $ 3 $、$ 3 $ と $ 1 $ は互いに素なので、$ 1,\ 2,\ 3 $ を選ぶことができ、このときが最大です。

### Sample Explanation 3

$ 1 $ と $ 2019 $ の正の公約数は $ 1 $ しかありません。

## 样例 #1

### 输入

```
12 18
```

### 输出

```
3
```

## 样例 #2

### 输入

```
420 660
```

### 输出

```
4
```

## 样例 #3

### 输入

```
1 2019
```

### 输出

```
1
```



---

---
title: "[ABC144D] Water Bottle"
layout: "post"
diff: 普及/提高-
pid: AT_abc144_d
tag: []
---

# [ABC144D] Water Bottle

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc144/tasks/abc144_d

高橋君は、底面が $ 1 $ 辺 $ a~\mathrm{cm} $ の正方形であり、高さが $ b~\mathrm{cm} $ であるような直方体型の水筒を持っています。(水筒の厚みは無視できます。)

この水筒の中に体積 $ x~\mathrm{cm}^3 $ の水を入れ、底面の正方形の $ 1 $ 辺を軸として、この水筒を徐々に傾けます。

水を溢れさせずに水筒を傾けることができる最大の角度を求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ a $ $ b $ $ x $

## 输出格式

水を溢れさせずに水筒を傾けることができる最大の角度を度数法で出力せよ。 出力は、ジャッジの出力との絶対誤差または相対誤差が $ 10^{-6} $ 以下のとき正解と判定される。

## 说明/提示

### 制約

- 入力は全て整数
- $ 1\ <\ =\ a\ \leq\ 100 $
- $ 1\ <\ =\ b\ \leq\ 100 $
- $ 1\ <\ =\ x\ <\ =\ a^2b $

### Sample Explanation 1

水筒は立方体であり、水は半分まで入っています。この水筒を $ 45 $° より大きく傾けると水が溢れます。

### Sample Explanation 2

水筒はほぼ空であり、水が溢れるときにはほぼ水平になっています。

### Sample Explanation 3

水筒はほぼ満杯であり、ほぼ垂直の状態で水が溢れます。

## 样例 #1

### 输入

```
2 2 4
```

### 输出

```
45.0000000000
```

## 样例 #2

### 输入

```
12 21 10
```

### 输出

```
89.7834636934
```

## 样例 #3

### 输入

```
3 1 8
```

### 输出

```
4.2363947991
```



---

---
title: "[ABC144E] Gluttony"
layout: "post"
diff: 普及/提高-
pid: AT_abc144_e
tag: []
---

# [ABC144E] Gluttony

## 题目描述

高桥君参加大胃王比赛。比赛由 $N$ 人组成的团队为基本单位参赛，高桥君的队伍的队员从 $1\sim N$ 编号。第 $i$ 名队员的消化代价为 $A_i$。

比赛有 $N$ 种不同的食物，每位队员需要负责吃掉其中一种食物，不能有两名队员吃同一种食物，也不能让一名队员吃多与一种食物。第 $j$ 种食物的难吃程度为 $F_j$。 消化代价 $x$ 的队员吃完难吃程度 $y$ 的食物需要花费 $x\times y$ 秒。 整个队伍的成绩是 $N$ 名队员吃完食物花费时间的最大值。

比赛前，高桥君的队伍会进行修行。一次修行可以将一名消化代价大于 $0$ 的队员的消化代价减少 $1$。由于修行需要消耗庞大的食费，因此最多只能进行 $K$ 次修行。

通过修行和适当选择每位队员吃的食物，高桥队在比赛中能够获得的最好成绩是多少？

## 输入格式

第 $1$ 行，两个正整数 $N,K$。

第 $2$ 行，$N$ 个正整数 $A_1,A_2,\cdots,A_N$。

第 $3$ 行，$N$ 个正整数 $F_1,F_2,\cdots,F_N$。

## 输出格式

输出高桥队的最好成绩。

## 说明/提示

$1$ 号队员进行 $4$ 次修行，吃 $2$ 号食物，花费 $0$ 秒。

$2$ 号队员进行 $1$ 次修行，吃 $3$ 号食物，花费 $1$ 秒。

$3$ 号队员进行 $0$ 次修行，吃 $1$ 号食物，花费 $2$ 秒。

总成绩取最大值 $2$ 秒。


$1 \le N \le 2\times 10^5$

$0 \le K \le 10^{18}$

$1 \le A_i \le 10^6$

$1 \le F_i \le 10^6$

## 样例 #1

### 输入

```
3 5

4 2 1

2 3 1
```

### 输出

```
2
```

## 样例 #2

### 输入

```
3 8

4 2 1

2 3 1
```

### 输出

```
0
```

## 样例 #3

### 输入

```
11 14

3 1 4 1 5 9 2 6 5 3 5

8 9 7 9 3 2 3 8 4 6 2
```

### 输出

```
12
```



---

---
title: "[ABC145D] Knight"
layout: "post"
diff: 普及/提高-
pid: AT_abc145_d
tag: []
---

# [ABC145D] Knight

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc145/tasks/abc145_d

二次元グリッドの原点 $ (0,0) $ にチェスのナイトの駒があります。

ナイトの駒はマス $ (i,j) $ にあるとき $ (i+1,j+2) $ か $ (i+2,\ j+1) $ のどちらかのマスにのみ動かすことができます。

ナイトの駒をマス $ (X,Y) $ まで移動させる方法は何通りありますか？

$ 10^9+7 $ で割った余りを求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ X $ $ Y $

## 输出格式

ナイトの駒を $ (0,0) $ から $ (X,Y) $ まで移動させる方法の数を、$ 10^9+7 $ で割った余りを出力せよ。

## 说明/提示

### 制約

- $ 1\ \leq\ X\ \leq\ 10^6 $
- $ 1\ \leq\ Y\ \leq\ 10^6 $
- 入力中のすべての値は整数である。

### Sample Explanation 1

$ (0,0)\ \to\ (1,2)\ \to\ (3,3) $ と $ (0,0)\ \to\ (2,1)\ \to\ (3,3) $ の $ 2 $ 通りが考えられます。

### Sample Explanation 2

$ (2,2) $ にナイトの駒を移動させることはできません。

### Sample Explanation 3

方法の数を $ 10^9+7 $ で割った余りを出力してください。

## 样例 #1

### 输入

```
3 3
```

### 输出

```
2
```

## 样例 #2

### 输入

```
2 2
```

### 输出

```
0
```

## 样例 #3

### 输入

```
999999 999999
```

### 输出

```
151840682
```



---

---
title: "[ABC147C] HonestOrUnkind2"
layout: "post"
diff: 普及/提高-
pid: AT_abc147_c
tag: []
---

# [ABC147C] HonestOrUnkind2

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc147/tasks/abc147_c

$ 1 $ から $ N $ までの番号がついた $ N $ 人の人がいます。彼らはみな、必ず正しい証言を行う「正直者」か、真偽不明の証言を行う「不親切な人」のいずれかです。

人 $ i $ は $ A_i $ 個の証言を行っています。人 $ i $ の $ j $ 個目の証言は $ 2 $ つの整数 $ x_{ij} $ , $ y_{ij} $ で表され、$ y_{ij}\ =\ 1 $ のときは「人 $ x_{ij} $ は正直者である」という証言であり、$ y_{ij}\ =\ 0 $ のときは「人 $ x_{ij} $ は不親切な人である」という証言です。

この $ N $ 人の中には最大で何人の正直者が存在し得るでしょうか？

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ A_1 $ $ x_{11} $ $ y_{11} $ $ x_{12} $ $ y_{12} $ $ : $ $ x_{1A_1} $ $ y_{1A_1} $ $ A_2 $ $ x_{21} $ $ y_{21} $ $ x_{22} $ $ y_{22} $ $ : $ $ x_{2A_2} $ $ y_{2A_2} $ $ : $ $ A_N $ $ x_{N1} $ $ y_{N1} $ $ x_{N2} $ $ y_{N2} $ $ : $ $ x_{NA_N} $ $ y_{NA_N} $

## 输出格式

存在し得る正直者の最大人数を出力せよ。

## 说明/提示

### 制約

- 入力は全て整数
- $ 1\ <\ =\ N\ <\ =\ 15 $
- $ 0\ \leq\ A_i\ \leq\ N\ -\ 1 $
- $ 1\ \leq\ x_{ij}\ \leq\ N $
- $ x_{ij}\ \neq\ i $
- $ x_{ij_1}\ \neq\ x_{ij_2}\ (j_1\ \neq\ j_2) $
- $ y_{ij}\ =\ 0,\ 1 $

### Sample Explanation 1

人 $ 1 $ と人 $ 2 $ が正直者であり、人 $ 3 $ が不親切な人であると仮定すると、正直者は $ 2 $ 人であり、矛盾が生じません。これが存在し得る正直者の最大人数です。

### Sample Explanation 2

$ 1 $ 人でも正直者が存在すると仮定すると、直ちに矛盾します。

## 样例 #1

### 输入

```
3

1

2 1

1

1 1

1

2 0
```

### 输出

```
2
```

## 样例 #2

### 输入

```
3

2

2 1

3 0

2

3 1

1 0

2

1 1

2 0
```

### 输出

```
0
```

## 样例 #3

### 输入

```
2

1

2 0

1

1 0
```

### 输出

```
1
```



---

---
title: "[ABC147D] Xor Sum 4"
layout: "post"
diff: 普及/提高-
pid: AT_abc147_d
tag: []
---

# [ABC147D] Xor Sum 4

## 题目描述

给出 $n$ 个整数 $a_i$，请求出 $\sum_{i=1}^{n-1}\sum_{j=i+1}^{n}(a_i \operatorname{xor}a_j)$ 对 $10^9 + 7$ 取模的值。

## 输入格式

第一行为一个正整数 $n$。

第二行有 $n$ 个整数 $a_i$。

## 输出格式

输出 $\sum_{i=1}^{n-1}\sum_{j=i+1}^{n}(a_i \operatorname{xor}a_j)$ 对 $10^9 + 7$ 取模的值。

## 说明/提示

$2 \le n \le 3 \times 10 ^ 5, 0 \le a_i \le 2^{60}$。

## 样例 #1

### 输入

```
3

1 2 3
```

### 输出

```
6
```

## 样例 #2

### 输入

```
10

3 1 4 1 5 9 2 6 5 3
```

### 输出

```
237
```

## 样例 #3

### 输入

```
10

3 14 159 2653 58979 323846 2643383 27950288 419716939 9375105820
```

### 输出

```
103715602
```



---

---
title: "[ABC147E] Balanced Path"
layout: "post"
diff: 普及/提高-
pid: AT_abc147_e
tag: []
---

# [ABC147E] Balanced Path

## 题目描述

高桥君有一个 $H$ 行 $W$ 列的棋盘，第 $i$ 行 $j$ 列记为 ( $i$ , $j$ ),每个格子里有两个整数， $a_{i,j}$ 和 $b_{i,j}$。

高桥君从( 1,1 )出发要走到( $H$ , $W$ )。每一次只能向左或向下走一格，每一次走过的方格，高桥君会把它上面的数一个染成红色，一个染成蓝色，求做过路径中红色数字的总和减蓝色数字总和的绝对值的最小值。

## 输入格式

第一行两个整数 $H$ , $W$ 。

从2到 $H + 1$ 行每行 $W$ 个整数 ,第 $i$ 个是 $A_{i,j}$。

从 $H+2$ 到 $2H+1$ 行每行 $W$ 个整数，第 $i$ 个是 $B_{i,j}$。

## 输出格式

一行一个整数表示答案

## 样例 #1

### 输入

```
2 2

1 2

3 4

3 4

2 1
```

### 输出

```
0
```

## 样例 #2

### 输入

```
2 3

1 10 80

80 10 1

1 2 3

4 5 6
```

### 输出

```
2
```



---

---
title: "[ABC148E] Double Factorial"
layout: "post"
diff: 普及/提高-
pid: AT_abc148_e
tag: []
---

# [ABC148E] Double Factorial

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc148/tasks/abc148_e

$ 0 $ 以上の整数 $ n $ に対し、 $ f(n) $ を次のように定義します。

- $ f(n)\ =\ 1 $ ($ n\ <\ 2 $ のとき)
- $ f(n)\ =\ n\ f(n-2) $ ($ n\ >\ =\ 2 $ のとき)

整数 $ N $ が与えられます。$ f(N) $ を $ 10 $ 進法で表記した時に末尾に何個の $ 0 $ が続くかを求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $

## 输出格式

$ f(N) $ を $ 10 $ 進法で表記した時の末尾の $ 0 $ の個数を出力せよ。

## 说明/提示

### 制約

- $ 0\ <\ =\ N\ <\ =\ 10^{18} $

### Sample Explanation 1

$ f(12)\ =\ 12\ ×\ 10\ ×\ 8\ ×\ 6\ ×\ 4\ ×\ 2\ =\ 46080 $ なので、末尾の $ 0 $ の個数は $ 1 $ 個です。

### Sample Explanation 2

$ f(5)\ =\ 5\ ×\ 3\ ×\ 1\ =\ 15 $ なので、末尾の $ 0 $ の個数は $ 0 $ 個です。

## 样例 #1

### 输入

```
12
```

### 输出

```
1
```

## 样例 #2

### 输入

```
5
```

### 输出

```
0
```

## 样例 #3

### 输入

```
1000000000000000000
```

### 输出

```
124999999999999995
```



---

---
title: "[ABC149D] Prediction and Restriction"
layout: "post"
diff: 普及/提高-
pid: AT_abc149_d
tag: []
---

# [ABC149D] Prediction and Restriction

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc149/tasks/abc149_d

高橋君は、ゲームセンターで「じゃんけんバトル」というゲームをプレイすることにしました。このゲームのルールは以下の通りです。

- プレイヤーは筐体と $ N $ 回じゃんけんを行う (あいこの場合も $ 1 $ 回のジャンケンと数える)。
- プレイヤーがじゃんけんで勝った場合、プレイヤーは出した手に応じて以下のスコアを得る (あいこや負けは $ 0 $ 点)。
  - グーで勝った場合、 $ R $ 点
  - チョキで勝った場合、 $ S $ 点
  - パーで勝った場合、 $ P $ 点
- ただし、ちょうど $ K $ 回前のじゃんけんで出した手と同じ手を出すことはできない。( $ K $ 回目までのじゃんけんでは好きな手を出せる。)

筐体は、各回のジャンケンで出す手をゲーム開始前に決定します。能力者である高橋君は、ゲーム開始前にこれをすべて読み取りました。

高橋君が読み取った情報は文字列 $ T $ として与えられます。$ T $ の $ i(1\ \leq\ i\ \leq\ N) $ 文字目が `r` のときは $ i $ 回目のじゃんけんで筐体がグーを出すことを、`s` のときはチョキを出すことを、`p` のときはパーを出すことを表します。

高橋君が $ N $ 回のじゃんけんで出す手を最適に選んだとき、ゲーム終了までに最大で合計何点を得られるでしょうか。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ K $ $ R $ $ S $ $ P $ $ T $

## 输出格式

得られる最大の合計スコアを出力せよ。

## 说明/提示

### 制約

- $ 2\ \leq\ N\ \leq\ 10^5 $
- $ 1\ \leq\ K\ \leq\ N-1 $
- $ 1\ \leq\ R,S,P\ \leq\ 10^4 $
- $ N,K,R,S,P $ は全て整数である。
- $ |T|\ =\ N $
- $ T $ に含まれる文字は `r` , `s` , `p` のいずれかである。

### Sample Explanation 1

筐体は、{グー、チョキ、グー、パー、グー} と手を出します。 これに対して、例えば {パー、グー、グー、チョキ、パー} と出せば、$ 27 $ 点を獲得できます。 これより大きい点は獲得できないので、$ 27 $ を出力します。

## 样例 #1

### 输入

```
5 2

8 7 6

rsrpr
```

### 输出

```
27
```

## 样例 #2

### 输入

```
7 1

100 10 1

ssssppr
```

### 输出

```
211
```

## 样例 #3

### 输入

```
30 5

325 234 123

rspsspspsrpspsppprpsprpssprpsr
```

### 输出

```
4996
```



---

---
title: "[ABC152D] Handstand 2"
layout: "post"
diff: 普及/提高-
pid: AT_abc152_d
tag: []
---

# [ABC152D] Handstand 2

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc152/tasks/abc152_d

正の整数 $ N $ が与えられます。  
 $ N $ 以下の正の整数の組 $ (A,B) $ であって、次の条件を満たすものの個数を求めてください。

- $ A,B $ を先頭に $ 0 $ のつかない $ 10 $ 進数表記で表したときに、 $ A $ の末尾の桁が $ B $ の先頭の桁に等しく、 $ A $ の先頭の桁が $ B $ の末尾の桁に等しい

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $

## 输出格式

答えを出力せよ。

## 说明/提示

### 制約

- $ 1\ \leq\ N\ \leq\ 2\ \times\ 10^5 $
- 入力はすべて整数である。

### Sample Explanation 1

条件を満たす正の整数の組 $ (A,B) $ は、 $ (1,1) $, $ (1,11) $, $ (2,2) $, $ (2,22) $, $ (3,3) $, $ (4,4) $, $ (5,5) $, $ (6,6) $, $ (7,7) $, $ (8,8) $, $ (9,9) $, $ (11,1) $, $ (11,11) $, $ (12,21) $, $ (21,12) $, $ (22,2) $, $ (22,22) $ の $ 17 $ 個あります。

## 样例 #1

### 输入

```
25
```

### 输出

```
17
```

## 样例 #2

### 输入

```
1
```

### 输出

```
1
```

## 样例 #3

### 输入

```
100
```

### 输出

```
108
```

## 样例 #4

### 输入

```
2020
```

### 输出

```
40812
```

## 样例 #5

### 输入

```
200000
```

### 输出

```
400000008
```



---

---
title: "[ABC153E] Crested Ibis vs Monster"
layout: "post"
diff: 普及/提高-
pid: AT_abc153_e
tag: []
---

# [ABC153E] Crested Ibis vs Monster

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc153/tasks/abc153_e

トキはモンスターと戦っています。

モンスターの体力は $ H $ です。

トキは $ N $ 種類の魔法が使え、$ i $ 番目の魔法を使うと、モンスターの体力を $ A_i $ 減らすことができますが、トキの魔力を $ B_i $ 消耗します。

同じ魔法は何度でも使うことができます。魔法以外の方法でモンスターの体力を減らすことはできません。

モンスターの体力を $ 0 $ 以下にすればトキの勝ちです。

トキがモンスターに勝つまでに消耗する魔力の合計の最小値を求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ H $ $ N $ $ A_1 $ $ B_1 $ $ : $ $ A_N $ $ B_N $

## 输出格式

トキがモンスターに勝つまでに消耗する魔力の最小値を出力せよ。

## 说明/提示

### 制約

- $ 1\ \leq\ H\ \leq\ 10^4 $
- $ 1\ \leq\ N\ \leq\ 10^3 $
- $ 1\ \leq\ A_i\ \leq\ 10^4 $
- $ 1\ \leq\ B_i\ \leq\ 10^4 $
- 入力中のすべての値は整数である。

### Sample Explanation 1

最初に $ 1 $ 番目の魔法を使い、トキの魔力を $ 3 $ 消耗して、モンスターの体力を $ 8 $ 減らします。モンスターの体力は $ 1 $ になります。 次に $ 3 $ 番目の魔法を使い、トキの魔力を $ 1 $ 消耗して、モンスターの体力を $ 2 $ 減らします。モンスターの体力は $ -1 $ になります。 これにより、トキが消耗した魔力の合計は $ 4 $ になります。

### Sample Explanation 2

$ 1 $ 番目の魔法を $ 100 $ 回使うのが最適です。

## 样例 #1

### 输入

```
9 3

8 3

4 2

2 1
```

### 输出

```
4
```

## 样例 #2

### 输入

```
100 6

1 1

2 3

3 9

4 27

5 81

6 243
```

### 输出

```
100
```

## 样例 #3

### 输入

```
9999 10

540 7550

691 9680

700 9790

510 7150

415 5818

551 7712

587 8227

619 8671

588 8228

176 2461
```

### 输出

```
139815
```



---

---
title: "[ABC156D] Bouquet"
layout: "post"
diff: 普及/提高-
pid: AT_abc156_d
tag: []
---

# [ABC156D] Bouquet

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc156/tasks/abc156_d

あかりさんは $ n $ 種類の花を $ 1 $ 本ずつ持っています。

あかりさんは、これらの花から $ 1 $ 本以上を選び、花束を作ろうとしています。

ただし、あかりさんは $ a $ と $ b $ の $ 2 $ つの数を苦手としていて、いずれかと一致するような本数の花からなる花束は作ることができません。

あかりさんが作ることのできる花束は何種類あるでしょうか。

$ (10^9\ +\ 7) $ で割った余りを求めてください。

ここで $ 2 $ つの花束は、一方では使われているが、 もう一方では使われていない種類の花があるとき、別の種類の花束であるとみなします。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ n $ $ a $ $ b $

## 输出格式

あかりさんが作ることのできる花束の種類数を $ (10^9\ +\ 7) $ で割った余りを出力せよ。(そのような花束がないときは `0` と出力せよ。)

## 说明/提示

### 制約

- 入力は全て整数である。
- $ 2\ \leq\ n\ \leq\ 10^9 $
- $ 1\ \leq\ a\ <\ b\ \leq\ \textrm{min}(n,\ 2\ \times\ 10^5) $

### Sample Explanation 1

この場合、あかりさんは $ 2 $ 本または $ 4 $ 本の花を選んで花束を作ることができます。 $ 4 $ 本ある花の中から $ 2 $ 本を選ぶ方法は $ 6 $ 通り、$ 4 $ 本を選ぶ方法は $ 1 $ 通りあるので、 あかりさんが作ることができる花束の種類数は合わせて $ 7 $ 通りです。

### Sample Explanation 2

$ (10^9\ +\ 7) $ で割った余りを出力してください。

## 样例 #1

### 输入

```
4 1 3
```

### 输出

```
7
```

## 样例 #2

### 输入

```
1000000000 141421 173205
```

### 输出

```
34076506
```



---

---
title: "[ABC157D] Friend Suggestions"
layout: "post"
diff: 普及/提高-
pid: AT_abc157_d
tag: []
---

# [ABC157D] Friend Suggestions

## 题目描述

### 题目大意

某平台上有 $N$ 名用户，其中，有 $M$ 对用户是互相关注的，有 $K$ 对用户是互相拉黑的。

当用户 $i$ 和用户 $j$ 满足以下条件时，用户 $j$ 就是用户 $i$ 的“推荐用户”：

+ 用户 $i$ 可以与 用户 $j$ 通过若干对用户的互相关注关系连接起来。（比如用户 1 与用户 2，用户 2 与用户 3 都互相关注，则用户 1 和 用户 3 就可以通过他们的关系连接起来）
+ 用户 $i$ 与用户 $j$ 没有互相关注或互相拉黑。

求每位用户的“推荐用户”的数量。

数据保证不会存在一对用户既互相关注又互相拉黑。

## 输入格式

第一行输入三个正整数 $N,M,K$；

接下来 $M$ 行，每行两个正整数 $A_i,B_i$，表示一对互相关注的用户；

再接下来 $K$ 行，每行两个正整数 $C_i,D_i$，表示一对互相拉黑的用户。

## 输出格式

输出用空格隔开的 $N$ 个整数，第 $i$ 个数表示用户 $i$ 的“推荐用户”的数量。

## 说明/提示

$2 \le N \le 10^5, 0 \le M,K \le 10^5$。

翻译 by @CarroT1212

## 样例 #1

### 输入

```
4 4 1

2 1

1 3

3 2

3 4

4 1
```

### 输出

```
0 1 0 1
```

## 样例 #2

### 输入

```
5 10 0

1 2

1 3

1 4

1 5

3 2

2 4

2 5

4 3

5 3

4 5
```

### 输出

```
0 0 0 0 0
```

## 样例 #3

### 输入

```
10 9 3

10 1

6 7

8 2

2 5

8 4

7 3

10 9

6 4

5 8

2 6

7 5

3 1
```

### 输出

```
1 3 5 4 3 3 3 3 1 0
```



---

---
title: "[ABC158D] String Formation"
layout: "post"
diff: 普及/提高-
pid: AT_abc158_d
tag: []
---

# [ABC158D] String Formation

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc158/tasks/abc158_d

高橋君は、英小文字から成る文字列 $ S $ を持っています。

この $ S $ から始めて、ある与えられた手順に従って文字列を作ることにしました。

手順は $ Q $ 回の操作から成ります。操作 $ i(1\ \leq\ i\ \leq\ Q) $ では、まず整数 $ T_i $ が与えられます。

- $ T_i\ =\ 1 $ のとき : 文字列 $ S $ の前後を反転する。
- $ T_i\ =\ 2 $ のとき : 追加で整数 $ F_i $ と英小文字 $ C_i $ が与えられる。
  
  
  - $ F_i\ =\ 1 $ のとき : 文字列 $ S $ の先頭に $ C_i $ を追加する。
  - $ F_i\ =\ 2 $ のとき : 文字列 $ S $ の末尾に $ C_i $ を追加する。

高橋君のために、手順の後に最終的にできる文字列を求めてあげてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ S $ $ Q $ $ Query_1 $ $ : $ $ Query_Q $

$ 3 $ 行目から $ Q\ +\ 2 $ 行目の $ Query_i $ は、以下の $ 2 $ つのいずれかである。

> $ 1 $

$ T_i\ =\ 1 $ として操作を行うことを表す。

> $ 2 $ $ F_i $ $ C_i $

$ T_i\ =\ 2 $ として操作を行うことを表す。

## 输出格式

手順の後に最終的にできる文字列を出力せよ。

## 说明/提示

### 制約

- $ 1\ \leq\ |S|\ \leq\ 10^5 $
- $ S $ は英小文字から成る
- $ 1\ \leq\ Q\ \leq\ 2\ \times\ 10^5 $
- $ T_i\ =\ 1 $ または $ 2 $
- $ F_i\ =\ 1 $ または $ 2 $
- $ C_i $ は英小文字である

### Sample Explanation 1

$ Q\ =\ 4 $ 回の操作を行います。初め $ S $ は `a` です。 - 操作 $ 1 $ : $ S $ の先頭に `p` を追加する。$ S $ は `pa` となる。 - 操作 $ 2 $ : $ S $ の前後を反転する。$ S $ は `ap` となる。 - 操作 $ 3 $ : $ S $ の末尾に `c` を追加する。$ S $ は `apc` となる。 - 操作 $ 4 $ : $ S $ の前後を反転する。$ S $ は `cpa` となる。 よって最終的にできる文字列は `cpa` となります。

### Sample Explanation 2

$ Q\ =\ 6 $ 回の操作を行います。初め $ S $ は `a` です。 - 操作 $ 1 $ : $ S $ は `aa` となる。 - 操作 $ 2 $ : $ S $ は `baa` となる。 - 操作 $ 3 $ : $ S $ は `aab` となる。 - 操作 $ 4 $ : $ S $ は `aabc` となる。 - 操作 $ 5 $ : $ S $ は `cbaa` となる。 - 操作 $ 6 $ : $ S $ は `aabc` となる。 よって最終的にできる文字列は `aabc` となります。

## 样例 #1

### 输入

```
a

4

2 1 p

1

2 2 c

1
```

### 输出

```
cpa
```

## 样例 #2

### 输入

```
a

6

2 2 a

2 1 b

1

2 2 c

1

1
```

### 输出

```
aabc
```

## 样例 #3

### 输入

```
y

1

2 1 x
```

### 输出

```
xy
```



---

---
title: "[ABC161D] Lunlun Number"
layout: "post"
diff: 普及/提高-
pid: AT_abc161_d
tag: []
---

# [ABC161D] Lunlun Number

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc161/tasks/abc161_d

正の整数 $ X $ が以下の条件を満たすとき、 $ X $ はルンルン数であると言います。

- $ X $ を(leading zeroなしで)十進数表記した際に、隣り合うどの $ 2 $ つの桁の値についても、差の絶対値が $ 1 $ 以下

例えば、 $ 1234 $ , $ 1 $ , $ 334 $ などはルンルン数ですが、 $ 31415 $ , $ 119 $ , $ 13579 $ などはルンルン数ではありません。

正の整数 $ K $ が与えられます。小さい方から $ K $ 番目のルンルン数を求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ K $

## 输出格式

答えを出力せよ。

## 说明/提示

### 制約

- $ 1\ \leq\ K\ \leq\ 10^5 $
- 入力はすべて整数である。

### Sample Explanation 1

小さい方から $ 15 $ 番目までのルンルン数を順に並べると、 $ 1 $, $ 2 $, $ 3 $, $ 4 $, $ 5 $, $ 6 $, $ 7 $, $ 8 $, $ 9 $, $ 10 $, $ 11 $, $ 12 $, $ 21 $, $ 22 $, $ 23 $ ですので、答えは $ 23 $ です。

### Sample Explanation 4

答えが $ 32 $ ビット符号付き整数の範囲に収まらない可能性があるので注意してください。

## 样例 #1

### 输入

```
15
```

### 输出

```
23
```

## 样例 #2

### 输入

```
1
```

### 输出

```
1
```

## 样例 #3

### 输入

```
13
```

### 输出

```
21
```

## 样例 #4

### 输入

```
100000
```

### 输出

```
3234566667
```



---

---
title: "[ABC161E] Yutori"
layout: "post"
diff: 普及/提高-
pid: AT_abc161_e
tag: []
---

# [ABC161E] Yutori

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc161/tasks/abc161_e

高橋君は明日からの $ N $ 日間のうち $ K $ 日を選んで働くことにしました。

整数 $ C $ と文字列 $ S $ が与えられるので、次の $ 2 $ つの条件を満たすようにして働く日を選びます。

- ある日働いたら、その直後の $ C $ 日間は働かない
- $ S $ の $ i $ 文字目が `x` のとき、今日から $ i $ 日後には働かない

高橋君が必ず働く日をすべて求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ K $ $ C $ $ S $

## 输出格式

高橋君が必ず働く日を昇順に改行区切りですべて出力せよ。

## 说明/提示

### 制約

- $ 1\ \leq\ N\ \leq\ 2\ \times\ 10^5 $
- $ 1\ \leq\ K\ \leq\ N $
- $ 0\ \leq\ C\ \leq\ N $
- $ S $ の長さは $ N $
- $ S $ の各文字は `o` か `x`
- 問題文中の条件を満たすように働く日を選ぶことが可能

### Sample Explanation 1

高橋君は $ 11 $ 日間のうち $ 3 $ 日働こうとしています。ある日働いたらその後 $ 2 $ 日間は働きません。 働く日としてありえる組み合わせは「$ 1,6,10 $ 日目」「$ 1,6,11 $ 日目」「$ 2,6,10 $ 日目」「$ 2,6,11 $ 日目」の $ 4 $ 通りです。 したがって、$ 6 $ 日目に必ず働きます。

### Sample Explanation 2

働く日としてありえる組み合わせは「$ 1,5 $ 日目」のみです。

### Sample Explanation 3

必ず働く日が存在しないこともあります。

## 样例 #1

### 输入

```
11 3 2

ooxxxoxxxoo
```

### 输出

```
6
```

## 样例 #2

### 输入

```
5 2 3

ooxoo
```

### 输出

```
1

5
```

## 样例 #3

### 输入

```
5 1 0

ooooo
```

### 输出

```

```

## 样例 #4

### 输入

```
16 4 3

ooxxoxoxxxoxoxxo
```

### 输出

```
11

16
```



---

---
title: "[ABC162D] RGB Triplets"
layout: "post"
diff: 普及/提高-
pid: AT_abc162_d
tag: []
---

# [ABC162D] RGB Triplets

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc162/tasks/abc162_d

`R`, `G`, `B` のみからなる、長さ $ N $ の文字列 $ S $ があります。

以下の $ 2 $ つの条件をともに満たす組 $ (i,~j,~k)~(1\ \leq\ i\ <\ j\ <\ k\ \leq\ N) $ の数を求めてください。

- $ S_i\ \neq\ S_j $ かつ $ S_i\ \neq\ S_k $ かつ $ S_j\ \neq\ S_k $ である
- $ j\ -\ i\ \neq\ k\ -\ j $ である

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ S $

## 输出格式

題意を満たす組の数を出力せよ。

## 说明/提示

### 制約

- $ 1\ \leq\ N\ \leq\ 4000 $
- $ S $ は `R`, `G`, `B` のみからなる、長さ $ N $ の文字列である

### Sample Explanation 1

組 $ (1,~3,~4) $ だけが $ 2 $ つの条件をともに満たします。組 $ (2,~3,~4) $ は、$ 1 $ つ目の条件は満たしますが $ 2 $ つ目の条件を満たさないので不適です。

## 样例 #1

### 输入

```
4

RRGB
```

### 输出

```
1
```

## 样例 #2

### 输入

```
39

RBRBGRBGGBBRRGBBRRRBGGBRBGBRBGBRBBBGBBB
```

### 输出

```
1800
```



---

---
title: "[ABC162F] Select Half"
layout: "post"
diff: 普及/提高-
pid: AT_abc162_f
tag: []
---

# [ABC162F] Select Half

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc162/tasks/abc162_f

長さ $ N $ の整数列 $ A_1,...,A_N $ が与えられます。

この中からちょうど $ \left\lfloor\ \frac{N}{2}\ \right\rfloor $ 個の整数を、どの $ 2 $ 箇所も連続しないように選びます。

選んだ要素の和としてありえる最大値を求めてください。

ここで、$ \lfloor\ x\ \rfloor $ は、$ x $ を超えない最大の整数を表します。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ A_1 $ $ ... $ $ A_N $

## 输出格式

選ばれた要素の和としてありえる最大値を出力せよ。

## 说明/提示

### 制約

- $ 2\ \leq\ N\ \leq\ 2\times\ 10^5 $
- $ |A_i|\leq\ 10^9 $
- 入力は全て整数

### Sample Explanation 1

$ 2,4,6 $ を選ぶと和は $ 12 $ となり、これが最大です。

### Sample Explanation 2

$ -10,10 $ を選ぶと和は $ 0 $ となり、これが最大です。

### Sample Explanation 3

オーバーフローに注意してください。

## 样例 #1

### 输入

```
6

1 2 3 4 5 6
```

### 输出

```
12
```

## 样例 #2

### 输入

```
5

-1000 -100 -10 0 10
```

### 输出

```
0
```

## 样例 #3

### 输入

```
10

1000000000 1000000000 1000000000 1000000000 1000000000 1000000000 1000000000 1000000000 1000000000 1000000000
```

### 输出

```
5000000000
```

## 样例 #4

### 输入

```
27

18 -28 18 28 -45 90 -45 23 -53 60 28 -74 -71 35 -26 -62 49 -77 57 24 -70 -93 69 -99 59 57 -49
```

### 输出

```
295
```



---

---
title: "[ABC163D] Sum of Large Numbers"
layout: "post"
diff: 普及/提高-
pid: AT_abc163_d
tag: []
---

# [ABC163D] Sum of Large Numbers

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc163/tasks/abc163_d

$ 10^{100} $, $ 10^{100}+1 $, ..., $ 10^{100}+N $ の $ N+1 $ 個の数があります。

この中から $ K $ 個以上の数を選ぶとき、その和としてあり得るものの個数を $ \bmod\ (10^9+7) $ で求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ K $

## 输出格式

和としてあり得るものの個数を $ \bmod\ (10^9+7) $ で出力せよ。

## 说明/提示

### 制約

- $ 1\ \leq\ N\ \leq\ 2\times\ 10^5 $
- $ 1\ \leq\ K\ \leq\ N+1 $
- 入力は全て整数

### Sample Explanation 1

以下の $ 10 $ 通りが考えられます。 - $ (10^{100})+(10^{100}+1)=2\times\ 10^{100}+1 $ - $ (10^{100})+(10^{100}+2)=2\times\ 10^{100}+2 $ - $ (10^{100})+(10^{100}+3)=(10^{100}+1)+(10^{100}+2)=2\times\ 10^{100}+3 $ - $ (10^{100}+1)+(10^{100}+3)=2\times\ 10^{100}+4 $ - $ (10^{100}+2)+(10^{100}+3)=2\times\ 10^{100}+5 $ - $ (10^{100})+(10^{100}+1)+(10^{100}+2)=3\times\ 10^{100}+3 $ - $ (10^{100})+(10^{100}+1)+(10^{100}+3)=3\times\ 10^{100}+4 $ - $ (10^{100})+(10^{100}+2)+(10^{100}+3)=3\times\ 10^{100}+5 $ - $ (10^{100}+1)+(10^{100}+2)+(10^{100}+3)=3\times\ 10^{100}+6 $ - $ (10^{100})+(10^{100}+1)+(10^{100}+2)+(10^{100}+3)=4\times\ 10^{100}+6 $

### Sample Explanation 2

全てを選ぶしかないので $ 1 $ 通りです。

## 样例 #1

### 输入

```
3 2
```

### 输出

```
10
```

## 样例 #2

### 输入

```
200000 200001
```

### 输出

```
1
```

## 样例 #3

### 输入

```
141421 35623
```

### 输出

```
220280457
```



---

---
title: "[ABC164D] Multiple of 2019"
layout: "post"
diff: 普及/提高-
pid: AT_abc164_d
tag: []
---

# [ABC164D] Multiple of 2019

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc164/tasks/abc164_d

`1` から `9` までの数字のみからなる文字列 $ S $ が与えられます。

次のような条件を満たす整数の組 $ (i,j) $ ($ 1\ <\ =\ i\ <\ =\ j\ <\ =\ |S| $) の総数を求めてください。

条件: $ S $ の $ i $ 文字目から $ j $ 文字目までを $ 10 $ 進法の整数としてみると、この整数は $ 2019 $ の倍数である。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ S $

## 输出格式

条件を満たす整数の組 $ (i,j) $ ($ 1\ <\ =\ i\ <\ =\ j\ <\ =\ |S| $) の総数を出力せよ。

## 说明/提示

### 制約

- $ 1\ <\ =\ |S|\ <\ =\ 200000 $
- $ S $ は `1` から `9` までの数字のみからなる文字列

### Sample Explanation 1

条件を満たすのは $ (1,5),\ (5,9),\ (9,13) $ の $ 3 $ 個です。

### Sample Explanation 3

条件を満たす整数の組は存在しません。

## 样例 #1

### 输入

```
1817181712114
```

### 输出

```
3
```

## 样例 #2

### 输入

```
14282668646
```

### 输出

```
2
```

## 样例 #3

### 输入

```
2119
```

### 输出

```
0
```



---

---
title: "[ABC165C] Many Requirements"
layout: "post"
diff: 普及/提高-
pid: AT_abc165_c
tag: []
---

# [ABC165C] Many Requirements

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc165/tasks/abc165_c

正整数 $ N $ , $ M $ , $ Q $ と、$ 4 $ つの整数の組 ( $ a_i $ , $ b_i $ , $ c_i $ , $ d_i $ ) $ Q $ 組が与えられます。

以下の条件を満たす数列 $ A $ を考えます。

- $ A $ は、長さ $ N $ の正整数列である。
- $ 1\ \leq\ A_1\ \leq\ A_2\ \le\ \cdots\ \leq\ A_N\ \leq\ M $

この数列の得点を、以下のように定めます。

- $ A_{b_i}\ -\ A_{a_i}\ =\ c_i $ を満たすような $ i $ についての、 $ d_i $ の総和 (そのような $ i $ が存在しないときは $ 0 $)

$ A $ の得点の最大値を求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ M $ $ Q $ $ a_1 $ $ b_1 $ $ c_1 $ $ d_1 $ $ : $ $ a_Q $ $ b_Q $ $ c_Q $ $ d_Q $

## 输出格式

$ A $ の得点の最大値を出力せよ。

## 说明/提示

### 制約

- 入力は全て整数
- $ 2\ <\ =\ N\ <\ =\ 10 $
- $ 1\ \leq\ M\ \leq\ 10 $
- $ 1\ \leq\ Q\ \leq\ 50 $
- $ 1\ \leq\ a_i\ <\ b_i\ \leq\ N $ ( $ i\ =\ 1,\ 2,\ ...,\ Q $ )
- $ 0\ \leq\ c_i\ \leq\ M\ -\ 1 $ ( $ i\ =\ 1,\ 2,\ ...,\ Q $ )
- $ (a_i,\ b_i,\ c_i)\ \neq\ (a_j,\ b_j,\ c_j) $ ( $ i\ \neq\ j $ のとき)
- $ 1\ \leq\ d_i\ \leq\ 10^5 $ ( $ i\ =\ 1,\ 2,\ ...,\ Q $ )

### Sample Explanation 1

$ A\ =\ \{1,\ 3,\ 4\} $ のとき、この数列の得点は $ 110 $ となります。この条件の下では $ 110 $ より高い得点を持つ数列は存在しませんから、答えは $ 110 $ です。

## 样例 #1

### 输入

```
3 4 3

1 3 3 100

1 2 2 10

2 3 2 10
```

### 输出

```
110
```

## 样例 #2

### 输入

```
4 6 10

2 4 1 86568

1 4 0 90629

2 3 0 90310

3 4 1 29211

3 4 3 78537

3 4 2 8580

1 2 1 96263

1 4 2 2156

1 2 0 94325

1 4 3 94328
```

### 输出

```
357500
```

## 样例 #3

### 输入

```
10 10 1

1 10 9 1
```

### 输出

```
1
```



---

---
title: "[ABC166E] This Message Will Self-Destruct in 5s"
layout: "post"
diff: 普及/提高-
pid: AT_abc166_e
tag: []
---

# [ABC166E] This Message Will Self-Destruct in 5s

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc166/tasks/abc166_e

AtCoder 王国の優秀なエージェントであるあなたは、盗まれた極秘情報が AlDebaran 王国の手に渡ることを阻止するため、取引現場であるパーティに潜入しました。

パーティには $ N $ 人の参加者がおり、それぞれ $ 1 $ から $ N $ までの番号がついています。参加者 $ i $ の身長は $ A_i $ です。

あなたは事前の尋問によって、極秘情報を取引するのは以下の条件を満たす $ 2 $ 人組であることを知っています。

- $ 2 $ 人の持つ番号の差の絶対値が、$ 2 $ 人の身長の和に等しい。

$ N $ 人の参加者のうちから $ 2 $ 人を選んでペアにする方法は $ \frac{N(N-1)}{2} $ 通りありますが、このうち上の条件を満たすペアは何通りあるでしょう？

なお、極秘情報の内容が何であるかはあなたの知るところではありません。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ A_1 $ $ A_2 $ $ \dots $ $ A_N $

## 输出格式

条件を満たすペアの個数を出力せよ。

## 说明/提示

### 制約

- 入力はすべて整数
- $ 2\ \leq\ N\ \leq\ 2\ \times\ 10^5 $
- $ 1\ \leq\ A_i\ \leq\ 10^9\ (1\ \leq\ i\ \leq\ N) $

### Sample Explanation 1

\- $ A_1\ +\ A_4\ =\ 3 $ なので、参加者 $ 1,\ 4 $ のペアは条件を満たします。 - $ A_2\ +\ A_6\ =\ 4 $ なので、参加者 $ 2,\ 6 $ のペアは条件を満たします。 - $ A_4\ +\ A_6\ =\ 2 $ なので、参加者 $ 4,\ 6 $ のペアは条件を満たします。 その他に作れるペアはいずれも条件を満たさないので、$ 3 $ を出力します。

### Sample Explanation 2

条件を満たすペアが存在しないので、$ 0 $ を出力します。

## 样例 #1

### 输入

```
6

2 3 3 1 3 1
```

### 输出

```
3
```

## 样例 #2

### 输入

```
6

5 2 4 2 8 8
```

### 输出

```
0
```

## 样例 #3

### 输入

```
32

3 1 4 1 5 9 2 6 5 3 5 8 9 7 9 3 2 3 8 4 6 2 6 4 3 3 8 3 2 7 9 5
```

### 输出

```
22
```



---

---
title: "[ABC167D] Teleporter"
layout: "post"
diff: 普及/提高-
pid: AT_abc167_d
tag: []
---

# [ABC167D] Teleporter

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc167/tasks/abc167_d

高橋王国には $ N $ 個の町があります。町は $ 1 $ から $ N $ まで番号が振られています。

それぞれの町にはテレポーターが $ 1 $ 台ずつ設置されています。町 $ i\ (1\ \leq\ i\ \leq\ N) $ のテレポーターの転送先は町 $ A_i $ です。

高橋王は正の整数 $ K $ が好きです。わがままな高橋王は、町 $ 1 $ から出発してテレポーターをちょうど $ K $ 回使うと、どの町に到着するかが知りたいです。

高橋王のために、これを求めるプログラムを作成してください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ K $ $ A_1 $ $ A_2 $ $ \dots $ $ A_N $

## 输出格式

町 $ 1 $ から出発してテレポーターをちょうど $ K $ 回使ったとき到着する町の番号を出力せよ。

## 说明/提示

### 制約

- $ 2\ \leq\ N\ \leq\ 2\ \times\ 10^5 $
- $ 1\ \leq\ A_i\ \leq\ N $
- $ 1\ \leq\ K\ \leq\ 10^{18} $

### Sample Explanation 1

町 $ 1 $ から出発してテレポーターを $ 5 $ 回使うと、$ 1\ \to\ 3\ \to\ 4\ \to\ 1\ \to\ 3\ \to\ 4 $ と移動します。

## 样例 #1

### 输入

```
4 5

3 2 4 1
```

### 输出

```
4
```

## 样例 #2

### 输入

```
6 727202214173249351

6 5 2 5 3 2
```

### 输出

```
2
```



---

---
title: "[ABC168D] .. (Double Dots)"
layout: "post"
diff: 普及/提高-
pid: AT_abc168_d
tag: []
---

# [ABC168D] .. (Double Dots)

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc168/tasks/abc168_d

あるところに、洞窟があります。

洞窟には $ N $ 個の部屋と $ M $ 本の通路があり、部屋には $ 1 $ から $ N $ の、通路には $ 1 $ から $ M $ の番号がついています。通路 $ i $ は部屋 $ A_i $ と部屋 $ B_i $ を双方向につないでいます。どの $ 2 $ 部屋間も、通路をいくつか通って行き来できます。部屋 $ 1 $ は洞窟の入り口がある特別な部屋です。

洞窟の中は薄暗いので、部屋 $ 1 $ 以外の各部屋に $ 1 $ つずつ道しるべを設けることにしました。各部屋の道しるべは、その部屋と通路で直接つながっている部屋の $ 1 $ つを指すように置きます。

洞窟の中は危険なので、部屋 $ 1 $ 以外のどの部屋についても以下の条件を満たすことが目標です。

- その部屋から出発し、「いまいる部屋にある道しるべを見て、それが指す部屋に移動する」ことを繰り返すと、部屋 $ 1 $ に最小の移動回数でたどり着く。

目標を達成できる道しるべの配置が存在するか判定し、存在するならばそのような配置を $ 1 $ つ出力してください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ M $ $ A_1 $ $ B_1 $ $ : $ $ A_M $ $ B_M $

## 输出格式

目標を達成できる道しるべの配置が存在しなければ `No` を出力せよ。

存在する場合、$ N $ 行出力せよ。$ 1 $ 行目には `Yes` を、$ i\ (2\ \leq\ i\ \leq\ N) $ 行目には部屋 $ i $ の道しるべが指す部屋の番号を出力せよ。

## 说明/提示

### 制約

- 入力はすべて整数
- $ 2\ \leq\ N\ \leq\ 10^5 $
- $ 1\ \leq\ M\ \leq\ 2\ \times\ 10^5 $
- $ 1\ \leq\ A_i,\ B_i\ \leq\ N\ (1\ \leq\ i\ \leq\ M) $
- $ A_i\ \neq\ B_i\ (1\ \leq\ i\ \leq\ M) $
- どの $ 2 $ 部屋間も、通路をいくつか通って行き来できる

### Sample Explanation 1

出力例のように道しるべを置いたとき、 - 部屋 $ 2 $ から出発した場合 $ (2)\ \to\ 1 $ と $ 1 $ 回移動することになり、これが最小です。 - 部屋 $ 3 $ から出発した場合 $ (3)\ \to\ 2\ \to\ 1 $ と $ 2 $ 回移動することになり、これが最小です。 - 部屋 $ 4 $ から出発した場合 $ (4)\ \to\ 2\ \to\ 1 $ と $ 2 $ 回移動することになり、これが最小です。 したがって、出力例のように道しるべを置けば目標を達成できます。

### Sample Explanation 2

答えが複数あり得る場合、どれを出力してもかまいません。

## 样例 #1

### 输入

```
4 4

1 2

2 3

3 4

4 2
```

### 输出

```
Yes

1

2

2
```

## 样例 #2

### 输入

```
6 9

3 4

6 1

2 4

5 3

4 6

1 5

6 2

4 5

5 6
```

### 输出

```
Yes

6

5

5

1

1
```



---

---
title: "[ABC169D] Div Game"
layout: "post"
diff: 普及/提高-
pid: AT_abc169_d
tag: []
---

# [ABC169D] Div Game

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc169/tasks/abc169_d

正の整数 $ N $ が与えられます。 $ N $ に対して、以下の操作を繰り返し行うことを考えます。

- はじめに、以下の条件を全て満たす正の整数 $ z $ を選ぶ。
  - ある素数 $ p $ と正の整数 $ e $ を用いて、 $ z=p^e $ と表せる
  - $ N $ が $ z $ で割り切れる
  - 以前の操作で選んだどの整数とも異なる
- $ N $ を、$ N/z $ に置き換える

最大で何回操作を行うことができるか求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $

## 输出格式

答えを整数として出力せよ。

## 说明/提示

### 制約

- 入力はすべて整数である。
- $ 1\ \leq\ N\ \leq\ 10^{12} $

### Sample Explanation 1

例えば、次のように操作を行うことで、 $ 3 $ 回操作を行うことができます。 - $ z=2\ (=2^1) $ とする。( 操作後、 $ N=12 $ となる。) - $ z=3\ (=3^1) $ とする。( 操作後、 $ N=4 $ となる。 ) - $ z=4\ (=2^2) $ とする。( 操作後、 $ N=1 $ となる。 )

### Sample Explanation 2

一度も操作を行うことができません。

### Sample Explanation 3

例えば、次のように操作を行うことで、 $ 3 $ 回操作を行うことができます。 - $ z=2\ (=2^1) $ とする。( 操作後、 $ N=32 $ となる。) - $ z=4\ (=2^2) $ とする。( 操作後、 $ N=8 $ となる。 ) - $ z=8\ (=2^3) $ とする。( 操作後、 $ N=1 $ となる。 )

### Sample Explanation 4

例えば、次のように操作を行うことで、 $ 1 $ 回操作を行うことができます。 - $ z=1000000007\ (=1000000007^1) $ とする。( 操作後、 $ N=1 $ となる。 )

## 样例 #1

### 输入

```
24
```

### 输出

```
3
```

## 样例 #2

### 输入

```
1
```

### 输出

```
0
```

## 样例 #3

### 输入

```
64
```

### 输出

```
3
```

## 样例 #4

### 输入

```
1000000007
```

### 输出

```
1
```

## 样例 #5

### 输入

```
997764507000
```

### 输出

```
7
```



---

---
title: "[ABC170D] Not Divisible"
layout: "post"
diff: 普及/提高-
pid: AT_abc170_d
tag: []
---

# [ABC170D] Not Divisible

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc170/tasks/abc170_d

長さ $ N $ の数列 $ A $ が与えられます。

次の性質を満たす整数 $ i $ $ \left(1\ \leq\ i\ \leq\ N\ \right) $ の数を答えてください。

- $ i\ \neq\ j $ である任意の整数 $ j $ $ \left(1\ \leq\ j\ \leq\ N\right) $ について $ A_i $ は $ A_j $ で割り切れない

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ A_1 $ $ A_2 $ $ \cdots $ $ A_N $

## 输出格式

答えを出力せよ。

## 说明/提示

### 制約

- 入力は全て整数
- $ 1\ \leq\ N\ \leq\ 2\ \times\ 10^5 $
- $ 1\ \leq\ A_i\ \leq\ 10^6 $

### Sample Explanation 1

問の性質を満たすのは $ 2 $ , $ 3 $ , $ 4 $ です。

### Sample Explanation 2

同じ数が存在する場合に注意してください。

## 样例 #1

### 输入

```
5

24 11 8 3 16
```

### 输出

```
3
```

## 样例 #2

### 输入

```
4

5 5 5 5
```

### 输出

```
0
```

## 样例 #3

### 输入

```
10

33 18 45 28 8 19 89 86 2 4
```

### 输出

```
5
```



---

---
title: "[ABC171E] Red Scarf"
layout: "post"
diff: 普及/提高-
pid: AT_abc171_e
tag: []
---

# [ABC171E] Red Scarf

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc171/tasks/abc171_e

猫のすぬけくんが $ N\ (\textbf{偶数}) $ 匹います。各すぬけくんには $ 1,\ 2,\ \ldots,\ N $ の番号が振られています。

各すぬけくんは首に赤いスカーフを巻いており、スカーフにはそのすぬけくんが一番好きな非負整数が $ 1 $ つ書き込まれています。

すぬけくんたちは最近、整数の xor（排他的論理和）と呼ばれる演算を覚えました。

 xor とは $ n $ 個の非負整数 $ x_1,x_2,\ \ldots,\ x_n $ について、それらの xor、 $ x_1~\textrm{xor}~x_2~\textrm{xor}~\ldots~\textrm{xor}~x_n $ は以下のように定義されます。

- $ x_1~\textrm{xor}~x_2~\textrm{xor}~\ldots~\textrm{xor}~x_n $ を二進表記した際の $ 2^k(k\ \geq\ 0) $ の位の数は、$ x_1,x_2,\ \ldots,\ x_n $ のうち、二進表記した際の $ 2^k(k\ \geq\ 0) $ の位の数が $ 1 $ となるものの個数が奇数ならば $ 1 $、そうでなければ $ 0 $ となる。
 
 例えば、$ 3~\textrm{xor}~5\ =\ 6 $ となります。 早速この演算を使いたくなったすぬけくんたちは、自分以外のすぬけくんのスカーフに書かれた整数の xor を計算することにしました。

番号 $ i $ が振られたすぬけくんが計算した、自分以外のすぬけくんのスカーフに書かれた整数の xor が $ a_i $ であることが分かっています。 この情報を元に、各すぬけくんのスカーフに書かれた整数を特定してください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ a_1 $ $ a_2 $ $ \ldots $ $ a_N $

## 输出格式

$ 1 $ 行に $ N $ 個の整数を空白区切りで出力せよ。

このうち左から $ i $ 番目の整数は、番号 $ i $ が振られたすぬけくんのスカーフに書かれた整数を表すものとする。

与えられた条件を満たす解が複数存在する場合、どれを出力しても構わない。

## 说明/提示

### 制約

- 入力はすべて整数である
- $ 2\ \leq\ N\ \leq\ 200000 $
- $ N $ は$ \textbf{偶数} $
- $ 0\ \leq\ a_i\ \leq\ 10^9 $
- 与えられた情報と整合するようなスカーフ上の整数の組合せが存在する

### Sample Explanation 1

\- $ 5~\textrm{xor}~7~\textrm{xor}~22\ =\ 20 $ - $ 26~\textrm{xor}~7~\textrm{xor}~22\ =\ 11 $ - $ 26~\textrm{xor}~5~\textrm{xor}~22\ =\ 9 $ - $ 26~\textrm{xor}~5~\textrm{xor}~7\ =\ 24 $ より、この出力は与えられた情報と整合します。

## 样例 #1

### 输入

```
4

20 11 9 24
```

### 输出

```
26 5 7 22
```



---

---
title: "[ABC172C] Tsundoku"
layout: "post"
diff: 普及/提高-
pid: AT_abc172_c
tag: []
---

# [ABC172C] Tsundoku

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc172/tasks/abc172_c

二台の机 A, B があります。机 A には $ N $ 冊の本が、机 B には $ M $ 冊の本が、それぞれ縦に積まれています。

机 A に現在上から $ i $ 番目に積まれている本 $ (1\ \leq\ i\ \leq\ N) $ は読むのに $ A_i $ 分を要し、机 B に現在上から $ i $ 番目に積まれている本 $ (1\ \leq\ i\ \leq\ M) $ は読むのに $ B_i $ 分を要します。

次の行為を考えます。

- 本が残っている机を選び、その机の最も上に積まれた本を読んで机から取り除く。

合計所要時間が $ K $ 分を超えないようにこの行為を繰り返すとき、最大で何冊の本を読むことができるでしょうか。本を読むこと以外に要する時間は無視します。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ M $ $ K $ $ A_1 $ $ A_2 $ $ \ldots $ $ A_N $ $ B_1 $ $ B_2 $ $ \ldots $ $ B_M $

## 输出格式

読むことのできる本の最大数を表す整数を出力せよ。

## 说明/提示

### 制約

- $ 1\ \leq\ N,\ M\ \leq\ 200000 $
- $ 1\ \leq\ K\ \leq\ 10^9 $
- $ 1\ \leq\ A_i,\ B_i\ \leq\ 10^9 $
- 入力中の値はすべて整数である。

### Sample Explanation 1

この場合、机 A の上から $ 1,2,3 $ 番目の本はそれぞれ読むのに $ 60 $ 分、$ 90 $ 分、$ 120 $ 分を要し、机 B の上から $ 1,2,3,4 $ 番目の本はそれぞれ読むのに $ 80 $ 分、$ 150 $ 分、$ 80 $ 分、$ 150 $ 分を要します。 以下のようにすることで $ 230 $ 分で $ 3 $ 冊の本を読むことができ、これが $ 240 $ 分以内に読むことのできる本の最大数です。 - 机 A の最も上に積まれている本を $ 60 $ 分かけて読み、この本を机から取り除く。 - 机 B の最も上に積まれている本を $ 80 $ 分かけて読み、この本を机から取り除く。 - 机 A の最も上に積まれている本を $ 90 $ 分かけて読み、この本を机から取り除く。

### Sample Explanation 3

整数のオーバーフローに注意してください。

## 样例 #1

### 输入

```
3 4 240

60 90 120

80 150 80 150
```

### 输出

```
3
```

## 样例 #2

### 输入

```
3 4 730

60 90 120

80 150 80 150
```

### 输出

```
7
```

## 样例 #3

### 输入

```
5 4 1

1000000000 1000000000 1000000000 1000000000 1000000000

1000000000 1000000000 1000000000 1000000000
```

### 输出

```
0
```



---

---
title: "[ABC172D] Sum of Divisors"
layout: "post"
diff: 普及/提高-
pid: AT_abc172_d
tag: []
---

# [ABC172D] Sum of Divisors

## 题目描述

### 题意翻译
- $f(x)$ 表示正整数 $x$ 的因数个数
- 现在给你一个正整数 $ N $ ，让你求出 $  \sum_{K=1}^N\ K\times\ f(K) $  。
----------


-------------

## 输出格式

- 共一行，输出 $ \sum_{K=1}^N\ K\times\ f(K) $ 的结果
- 最后别忘了输出回车

## 说明/提示

-  $ 1\ \leq\ N\ \leq\ 10^7 $
- $f(1)=1 $ ,  $ f(2)=2 $ ,  $ f(3)=2 $ ,  $ f(4)=3 $ , 所以答案为  $ 1\times\ 1\ +\ 2\times\ 2\ +\ 3\times\ 2\ +\ 4\times\ 3\ =23 $ 。

 _Translated by qinmingze_

## 样例 #1

### 输入

```
4
```

### 输出

```
23
```

## 样例 #2

### 输入

```
100
```

### 输出

```
26879
```

## 样例 #3

### 输入

```
10000000
```

### 输出

```
838627288460105
```



---

---
title: "[ABC173D] Chat in a Circle"
layout: "post"
diff: 普及/提高-
pid: AT_abc173_d
tag: []
---

# [ABC173D] Chat in a Circle

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc173/tasks/abc173_d

あなたはオンラインゲーム「ATChat」のチュートリアルを終え、その場に居合わせたプレイヤー $ N $ 人で早速とある場所を訪ねることにしました。この $ N $ 人には $ 1 $ から $ N $ の番号が振られており、人 $ i\ (1\ \leq\ i\ \leq\ N) $ の **フレンドリーさ** は $ A_i $ です。

訪ねる際、$ N $ 人は好きな順番で $ 1 $ 人ずつ到着します。あなたたちは迷子にならないために、既に到着した人たちで環状に並び、新たに到着した人は好きな位置に割り込んで加わるというルールを決めました。

最初に到着した人以外の各人は、割り込んだ位置から到着した時点で「時計回りで最も近い人」と「反時計回りで最も近い人」のフレンドリーさのうち小さい方に等しい **心地よさ** を感じます。最初に到着した人の心地よさは $ 0 $ です。

$ N $ 人が到着する順番や割り込む位置を適切に決めたとき、$ N $ 人の心地よさの合計の最大値はいくらになるでしょう？

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ A_1 $ $ A_2 $ $ \dots $ $ A_N $

## 输出格式

$ N $ 人の心地よさの合計の最大値を出力せよ。

## 说明/提示

### 制約

- 入力はすべて整数
- $ 2\ \leq\ N\ \leq\ 2\ \times\ 10^5 $
- $ 1\ \leq\ A_i\ \leq\ 10^9 $

### Sample Explanation 1

人 $ 4,\ 2,\ 1,\ 3 $ がこの順に到着し、図のように輪に割り込むことで、心地よさの合計は $ 7 $ になります。 !\[図\](https://img.atcoder.jp/ghi/766a260a0019ea93e86e0588cc4db868.png) 心地よさの合計を $ 7 $ より大きくすることはできないので、$ 7 $ が答えになります。

## 样例 #1

### 输入

```
4

2 2 1 3
```

### 输出

```
7
```

## 样例 #2

### 输入

```
7

1 1 1 1 1 1 1
```

### 输出

```
6
```



---

---
title: "[ABC174E] Logs"
layout: "post"
diff: 普及/提高-
pid: AT_abc174_e
tag: []
---

# [ABC174E] Logs

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc174/tasks/abc174_e

丸太が $ N $ 本あり、それぞれ長さは $ A_1,A_2,\cdots,A_N $ です。

これらの丸太を合計 $ K $ 回まで切ることができます。 長さ $ L $ の丸太を片端から $ t\ (0\ <\ t\ <\ L) $ の位置で切ると、長さ $ t,L-t $ の丸太に分かれます。

丸太を合計 $ K $ 回まで切った後最も長い丸太の長さが最小でいくつになるか求め、小数点以下を切り上げた値を出力してください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ K $ $ A_1 $ $ A_2 $ $ \cdots $ $ A_N $

## 输出格式

答えとなる整数を出力せよ。

## 说明/提示

### 制約

- $ 1\ \leq\ N\ \leq\ 2\ \times\ 10^5 $
- $ 0\ \leq\ K\ \leq\ 10^9 $
- $ 1\ \leq\ A_i\ \leq\ 10^9 $
- 入力はすべて整数である。

### Sample Explanation 1

\- まず、長さ $ 7 $ の丸太を片端から $ 3.5 $ の位置で切り、長さ $ 3.5 $ の丸太二本に分けます。 - 次に、長さ $ 9 $ の丸太を片端から $ 3 $ の位置で切り、長さ $ 3 $ と $ 6 $ の丸太に分けます。 - 最後に、長さ $ 6 $ の丸太を片端から $ 3.3 $ の位置で切り、長さ $ 3.3 $ と $ 2.7 $ の丸太に分けます。 すると、最も長い丸太の長さは $ 3.5 $ になります。これが最小なので、小数点以下を切り上げた $ 4 $ を出力します。

## 样例 #1

### 输入

```
2 3

7 9
```

### 输出

```
4
```

## 样例 #2

### 输入

```
3 0

3 4 5
```

### 输出

```
5
```

## 样例 #3

### 输入

```
10 10

158260522 877914575 602436426 24979445 861648772 623690081 433933447 476190629 262703497 211047202
```

### 输出

```
292638192
```



---

---
title: "[ABC176D] Wizard in Maze"
layout: "post"
diff: 普及/提高-
pid: AT_abc176_d
tag: []
---

# [ABC176D] Wizard in Maze

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc176/tasks/abc176_d

縦 $ H $ マス、横 $ W $ マスの $ H\times\ W $ マスからなる迷路があります。

上から $ i $ 行目、左から $ j $ 列目のマス $ (i,j) $ は、$ S_{ij} $ が `#` のとき壁であり、`.`のとき道です。

マス $ (C_h,C_w) $ に魔法使いがいます。魔法使いは次の $ 2 $ 種類の方法で移動することができます。

- 移動A：現在いるマスと上下左右に隣接する道のマスへ歩いて移動する。
- 移動B：現在いるマスを中心とする $ 5\times\ 5 $ の範囲内にある道のマスへワープ魔法で移動する。

どちらの行動でも、迷路の外へ移動することはできません。

マス $ (D_h,D_w) $ まで移動するには、ワープ魔法を最低で何度使う必要があるでしょうか。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ H $ $ W $ $ C_h $ $ C_w $ $ D_h $ $ D_w $ $ S_{11}\ldots\ S_{1W} $ $ \vdots $ $ S_{H1}\ldots\ S_{HW} $

## 输出格式

ワープ魔法を使う最小回数を出力せよ。$ (D_h,D_w) $ に到達不可能な場合、かわりに `-1` と出力せよ。

## 说明/提示

### 制約

- $ 1\ \leq\ H,W\ \leq\ 10^3 $
- $ 1\ \leq\ C_h,D_h\ \leq\ H $
- $ 1\ \leq\ C_w,D_w\ \leq\ W $
- $ S_{ij} $ は `#` か `.`
- $ S_{C_h\ C_w} $ と $ S_{D_h\ D_w} $ は `.`
- $ (C_h,C_w)\ \neq\ (D_h,D_w) $

### Sample Explanation 1

例えば $ (2,2) $ まで歩いて移動し、$ (2,2) $ から $ (4,4) $ へワープ魔法で移動することで、ワープ魔法の使用回数を $ 1 $ 回にできます。 歩いて斜めに移動することはできません。

### Sample Explanation 2

現在地から動くことができません。

### Sample Explanation 3

ワープ魔法を使う必要はありません。

## 样例 #1

### 输入

```
4 4

1 1

4 4

..#.

..#.

.#..

.#..
```

### 输出

```
1
```

## 样例 #2

### 输入

```
4 4

1 4

4 1

.##.

####

####

.##.
```

### 输出

```
-1
```

## 样例 #3

### 输入

```
4 4

2 2

3 3

....

....

....

....
```

### 输出

```
0
```

## 样例 #4

### 输入

```
4 5

1 2

2 5

#.###

####.

#..##

#..##
```

### 输出

```
2
```



---

---
title: "[ABC176E] Bomber"
layout: "post"
diff: 普及/提高-
pid: AT_abc176_e
tag: []
---

# [ABC176E] Bomber

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc176/tasks/abc176_e

$ H\ \times\ W $ マスの二次元グリッドがあります。この中には $ M $ 個の爆破対象があります。 $ i $ 個目の爆破対象の位置は $ \left(h_i,\ w_i\ \right) $です。

高橋君は $ 1 $ つのマスを選び、そのマスに爆弾を設置し、起爆します。爆弾と同じ行または同じ列に存在する爆破対象が爆破されます。爆破対象が存在するマスに爆弾を設置することも出来ます。

高橋君は、爆破する爆破対象の数を最大化しようとしています。最大でいくつの爆破対象を爆破出来るか答えてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ H $ $ W $ $ M $ $ h_1 $ $ w_1 $ $ \vdots $ $ h_M $ $ w_M $

## 输出格式

答えを出力せよ。

## 说明/提示

### 制約

- 入力は全て整数
- $ 1\ \leq\ H,\ W\ \leq\ 3\ \times\ 10^5 $
- $ 1\ \leq\ M\ \leq\ \min\left(H\times\ W,\ 3\ \times\ 10^5\right) $
- $ 1\ \leq\ h_i\ \leq\ H $
- $ 1\ \leq\ w_i\ \leq\ W $
- $ \left(h_i,\ w_i\right)\ \neq\ \left(h_j,\ w_j\right)\ \left(i\ \neq\ j\right) $

### Sample Explanation 1

爆弾を $ \left(1,\ 2\right) $ に設置することで、全ての爆破対象を爆破することが出来ます。

## 样例 #1

### 输入

```
2 3 3

2 2

1 1

1 3
```

### 输出

```
3
```

## 样例 #2

### 输入

```
3 3 4

3 3

3 1

1 1

1 2
```

### 输出

```
3
```

## 样例 #3

### 输入

```
5 5 10

2 5

4 3

2 3

5 5

2 2

5 4

5 3

5 1

3 5

1 4
```

### 输出

```
6
```



---

---
title: "[ABC177D] Friends"
layout: "post"
diff: 普及/提高-
pid: AT_abc177_d
tag: []
---

# [ABC177D] Friends

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc177/tasks/abc177_d

人 $ 1 $ から 人 $ N $ までの $ N $ 人の人がいます。

「人 $ A_i $ と人 $ B_i $ は友達である」という情報が $ M $ 個与えられます。同じ情報が複数回与えられることもあります。

$ X $ と $ Y $ が友達、かつ、$ Y $ と $ Z $ が友達ならば、$ X $ と $ Z $ も友達です。また、$ M $ 個の情報から導くことができない友達関係は存在しません。

悪の高橋君は、この $ N $ 人をいくつかのグループに分け、全ての人について「同じグループの中に友達がいない」という状況を作ろうとしています。

最小でいくつのグループに分ければ良いでしょうか？

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ M $ $ A_1 $ $ B_1 $ $ \vdots $ $ A_M $ $ B_M $

## 输出格式

答えを出力せよ。

## 说明/提示

### 制約

- $ 2\ \leq\ N\ \leq\ 2\times\ 10^5 $
- $ 0\ \leq\ M\ \leq\ 2\times\ 10^5 $
- $ 1\leq\ A_i,B_i\leq\ N $
- $ A_i\ \neq\ B_i $

### Sample Explanation 1

例えば $ \{1,3\},\{2,4\},\{5\} $ という $ 3 $ つのグループに分けることで目的を達成できます。

## 样例 #1

### 输入

```
5 3

1 2

3 4

5 1
```

### 输出

```
3
```

## 样例 #2

### 输入

```
4 10

1 2

2 1

1 2

2 1

1 2

1 3

1 4

2 3

2 4

3 4
```

### 输出

```
4
```

## 样例 #3

### 输入

```
10 4

3 1

4 1

5 9

2 6
```

### 输出

```
3
```



---

---
title: "[ABC177E] Coprime"
layout: "post"
diff: 普及/提高-
pid: AT_abc177_e
tag: []
---

# [ABC177E] Coprime

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc177/tasks/abc177_e

$ N $ 個の整数があります。$ i $ 番目の数は $ A_i $ です。

「全ての $ 1\leq\ i\ <\ j\ \leq\ N $ について、$ GCD(A_i,A_j)=1 $」が成り立つとき、$ \{A_i\} $ は pairwise coprime であるといいます。

$ \{A_i\} $ が pairwise coprime ではなく、かつ、$ GCD(A_1,\ldots,A_N)=1 $ であるとき、$ \{A_i\} $ は setwise coprime であるといいます。

$ \{A_i\} $ が pairwise coprime、setwise coprime、そのどちらでもない、のいずれであるか判定してください。

ただし $ GCD(\ldots) $ は最大公約数を表します。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ A_1 $ $ \ldots $ $ A_N $

## 输出格式

$ \{A_i\} $ が pairwise coprime ならば `pairwise coprime`、setwise coprime ならば `setwise coprime`、そのどちらでもなければ `not coprime` と出力せよ。

## 说明/提示

### 制約

- $ 2\ \leq\ N\ \leq\ 10^6 $
- $ 1\ \leq\ A_i\leq\ 10^6 $

### Sample Explanation 1

$ GCD(3,4)=GCD(3,5)=GCD(4,5)=1 $ なので pairwise coprime です。

### Sample Explanation 2

$ GCD(6,10)=2 $ なので pairwise coprime ではありませんが、$ GCD(6,10,15)=1 $ なので setwise coprime です。

### Sample Explanation 3

$ GCD(6,10,16)=2 $ なので、pairwise coprime でも setwise coprime でもありません。

## 样例 #1

### 输入

```
3

3 4 5
```

### 输出

```
pairwise coprime
```

## 样例 #2

### 输入

```
3

6 10 15
```

### 输出

```
setwise coprime
```

## 样例 #3

### 输入

```
3

6 10 16
```

### 输出

```
not coprime
```



---

---
title: "[ABC178D] Redistribution"
layout: "post"
diff: 普及/提高-
pid: AT_abc178_d
tag: []
---

# [ABC178D] Redistribution

## 题目描述

给定整数 $ S $。请求出有几个序列，所有项都是 $ 3 $ 以上的整数，其总和是 $ S $。因为答案可能会非常大，所以请输出除以$ 1e9+7 $ 后的余数。

## 输入格式

一个整数$ S $

## 输出格式

答案除以$ 1e9+7 $后的余数

## 样例 #1

### 输入

```
7
```

### 输出

```
3
```

## 样例 #2

### 输入

```
2
```

### 输出

```
0
```

## 样例 #3

### 输入

```
1729
```

### 输出

```
294867501
```



---

---
title: "[ABC178E] Dist Max"
layout: "post"
diff: 普及/提高-
pid: AT_abc178_e
tag: []
---

# [ABC178E] Dist Max

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc178/tasks/abc178_e

二次元平面上に $ N $ 個の点があり、$ i $ 番目の点の座標は $ (x_i,y_i) $ です。 同じ座標に複数の点があることもあります。 異なる二点間のマンハッタン距離として考えられる最大の値はいくつでしょうか。

ただし、二点 $ (x_i,y_i) $ と $ (x_j,y_j) $ のマンハッタン距離は $ |x_i-x_j|+|y_i-y_j| $ のことをいいます。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ x_1 $ $ y_1 $ $ x_2 $ $ y_2 $ $ : $ $ x_N $ $ y_N $

## 输出格式

答えを出力せよ。

## 说明/提示

### 制約

- $ 2\ \leq\ N\ \leq\ 2\ \times\ 10^5 $
- $ 1\ \leq\ x_i,y_i\ \leq\ 10^9 $
- 入力はすべて整数

### Sample Explanation 1

$ 1 $ 番目の点と $ 2 $ 番目の点のマンハッタン距離は $ |1-2|+|1-4|=4 $ で、これが最大です。

## 样例 #1

### 输入

```
3

1 1

2 4

3 2
```

### 输出

```
4
```

## 样例 #2

### 输入

```
2

1 1

1 1
```

### 输出

```
0
```



---

---
title: "[ABC179D] Leaping Tak"
layout: "post"
diff: 普及/提高-
pid: AT_abc179_d
tag: []
---

# [ABC179D] Leaping Tak

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc179/tasks/abc179_d

一列に並んだ $ N $ マスから成るマス目があり、マスには左から順番に$ 1,\ 2,\ \ldots,\ N $ の番号がついています。

このマス目で暮らしている高橋君は、現在マス $ 1 $ にいて、後述の方法で移動を繰り返してマス $ N $ へ行こうとしています。

$ 10 $ 以下の整数 $ K $ と、共通部分を持たない $ K $ 個の区間 $ [L_1,\ R_1],\ [L_2,\ R_2],\ \ldots,\ [L_K,\ R_K] $ が与えられ、これらの区間の和集合を $ S $ とします。ただし、区間 $ [l,\ r] $ は $ l $ 以上 $ r $ 以下の整数の集合を表します。

- マス $ i $ にいるとき、$ S $ から整数を $ 1 $ つ選んで ($ d $ とする)、マス $ i\ +\ d $ に移動する。ただし、マス目の外に出るような移動を行ってはならない。

高橋君のために、マス $ N $ に行く方法の個数を $ 998244353 $ で割った余りを求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ K $ $ L_1 $ $ R_1 $ $ L_2 $ $ R_2 $ $ : $ $ L_K $ $ R_K $

## 输出格式

高橋くんがマス $ 1 $ からマス $ N $ に行く方法の個数を $ 998244353 $ で割った余りを出力せよ。

## 说明/提示

### 制約

- $ 2\ \leq\ N\ \leq\ 2\ \times\ 10^5 $
- $ 1 \leq\ K\ \leq\ \min(N,\ 10) $
- $ 1\ \leq\ L_i\ \leq\ R_i\ \leq\ N $
- $ [L_i,\ R_i] $ と $ [L_j,\ R_j] $ は共通部分を持たない ($ i\ \neq\ j $)
- 入力はすべて整数である

### Sample Explanation 1

集合 $ S $ は 区間 $ [1,\ 1] $ と区間 $ [3,\ 4] $ の和集合であり、$ S\ =\ \{\ 1,\ 3,\ 4\ \} $ です。 マス $ 5 $ へ移動する方法は次の $ 4 $ 通りが考えられます。 - マス $ 1,\ 2,\ 3,\ 4,\ 5 $ の順に移動する。 - マス $ 1,\ 2,\ 5 $ の順に移動する。 - マス $ 1,\ 4,\ 5 $ の順に移動する。 - マス $ 1,\ 5 $ の順に移動する。

### Sample Explanation 2

$ S\ =\ \{\ 3,\ 5\ \} $ であり、そもそもマス $ 5 $ にたどり着けないので $ 0 $ を出力してください。

### Sample Explanation 4

$ 998244353 $ で割った余りを出力することに注意してください。

## 样例 #1

### 输入

```
5 2

1 1

3 4
```

### 输出

```
4
```

## 样例 #2

### 输入

```
5 2

3 3

5 5
```

### 输出

```
0
```

## 样例 #3

### 输入

```
5 1

1 2
```

### 输出

```
5
```

## 样例 #4

### 输入

```
60 3

5 8

1 3

10 15
```

### 输出

```
221823067
```



---

---
title: "[ABC179E] Sequence Sum"
layout: "post"
diff: 普及/提高-
pid: AT_abc179_e
tag: []
---

# [ABC179E] Sequence Sum

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc179/tasks/abc179_e

$ x $ を $ m $ で割った余りを $ f(x,m) $ と表します。

初期値 $ A_1=X $ および漸化式 $ A_{n+1}=\ f(A_n^2,\ M) $ で定まる数列を $ A $ とします。$ \displaystyle{\sum_{i=1}^N\ A_i} $ を求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ X $ $ M $

## 输出格式

$ \displaystyle{\sum_{i=1}^N\ A_i} $ を出力せよ。

## 说明/提示

### 制約

- $ 1\ \leq\ N\ \leq\ 10^{10} $
- $ 0\ \leq\ X\ <\ M\ \leq\ 10^5 $
- 入力は全て整数

### Sample Explanation 1

数列 $ A $ は $ 2,4,16,256,471,620,\ldots $ となるので、答えは $ 2+4+16+256+471+620=1369 $ となります。

### Sample Explanation 2

数列 $ A $ は $ 2,4,0,0,\ldots $ となるので、答えは $ 6 $ となります。

## 样例 #1

### 输入

```
6 2 1001
```

### 输出

```
1369
```

## 样例 #2

### 输入

```
1000 2 16
```

### 输出

```
6
```

## 样例 #3

### 输入

```
10000000000 10 99959
```

### 输出

```
492443256176507
```



---

---
title: "[ABC180D] Takahashi Unevolved"
layout: "post"
diff: 普及/提高-
pid: AT_abc180_d
tag: []
---

# [ABC180D] Takahashi Unevolved

## 题目描述

Iroha 正在玩一个宠物养成的游戏。

Iroha 的宠物名字叫 Takahashi。初始，Takahashi 的 **STR** 值为 $X$，**EXP** 值为 $0$。Iroha 可以带宠物到以下任意一个 Gym 进行训练：

- Kakomon Gym：**STR** 值将会变为原来的 $A$ 倍，**EXP** 值将会加上 $1$。
- AtCoder Gym：**STR** 值将会加上 $B$，**EXP** 值将会加上 $1$。

当 Takahashi 的 **STR** 值大于等于 $Y$，Takahashi 会进化形态。

但是 Iroha 认为进化的 Takahashi 没那么可爱，于是 Iroha 想求出在保证 Takahashi 不进化的情况下，能达到的最大 **EXP** 值是多少。

## 输入格式

一行四个整数，$X\ Y\ A\ B$。

## 输出格式

一行一个表示最大 **EXP** 值的整数。

@[hellolin](/user/751017) 译

## 样例 #1

### 输入

```
4 20 2 10
```

### 输出

```
2
```

## 样例 #2

### 输入

```
1 1000000000000000000 10 1000000000
```

### 输出

```
1000000007
```



---

---
title: "[ABC180E] Traveling Salesman among Aerial Cities"
layout: "post"
diff: 普及/提高-
pid: AT_abc180_e
tag: []
---

# [ABC180E] Traveling Salesman among Aerial Cities

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc180/tasks/abc180_e

$ 3 $ 次元空間内に $ N $ 個の都市、都市 $ 1 $ から 都市 $ N $ があります。都市 $ i $ は座標 $ (X_i,Y_i,Z_i) $ にあります。

座標 $ (a,b,c) $ の都市から $ (p,q,r) $ の都市に移動する際には $ |p-a|+|q-b|+\max(0,r-c) $ のコストがかかります。

都市 $ 1 $ からスタートし、全ての都市を $ 1 $ 度以上巡って都市 $ 1 $ に戻るまでの最小コストを求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ X_1 $ $ Y_1 $ $ Z_1 $ $ \vdots $ $ X_N $ $ Y_N $ $ Z_N $

## 输出格式

都市 $ 1 $ からスタートし、全ての都市を $ 1 $ 度以上巡って都市 $ 1 $ に戻るまでの最小コストを出力せよ。

## 说明/提示

### 制約

- $ 2\ \leq\ N\ \leq\ 17 $
- $ -10^6\ \leq\ X_i,Y_i,Z_i\ \leq\ 10^6 $
- 同じ座標に複数の都市があることはない
- 入力は全て整数

### Sample Explanation 1

都市 $ 1 $ から都市 $ 2 $ へ向かう時には $ |1-0|+|2-0|+\max(0,3-0)=6 $ のコストがかかります。 都市 $ 2 $ から都市 $ 1 $ へ向かう時には $ |0-1|+|0-2|+\max(0,0-3)=3 $ のコストがかかります。 よって合計で $ 9 $ のコストがかかります。

### Sample Explanation 2

例えば 都市 $ 1 $, $ 2 $, $ 1 $, $ 3 $, $ 1 $ の順に移動するとコストが $ 10 $ になります。途中で都市 $ 1 $ に戻ってきても構いません。

## 样例 #1

### 输入

```
2

0 0 0

1 2 3
```

### 输出

```
9
```

## 样例 #2

### 输入

```
3

0 0 0

1 1 1

-1 -1 -1
```

### 输出

```
10
```

## 样例 #3

### 输入

```
17

14142 13562 373095

-17320 508075 68877

223606 -79774 9979

-24494 -89742 783178

26457 513110 -64591

-282842 7124 -74619

31622 -77660 -168379

-33166 -24790 -3554

346410 16151 37755

-36055 51275 463989

37416 -573867 73941

-3872 -983346 207417

412310 56256 -17661

-42426 40687 -119285

43588 -989435 -40674

-447213 -59549 -99579

45825 7569 45584
```

### 输出

```
6519344
```



---

---
title: "[ABC181E] Transformable Teacher"
layout: "post"
diff: 普及/提高-
pid: AT_abc181_e
tag: []
---

# [ABC181E] Transformable Teacher

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc181/tasks/abc181_e

$ N $ 人の児童がおり、 $ i $ 番目の児童の身長は $ H_i $ です。 $ N $ は奇数です。

今から、先生であるあなたを含めた $ N+1 $ 人で $ 2 $ 人 $ 1 $ 組を $ \large\frac{N+1}2 $ ペア組みます。

あなたの目標は、それぞれのペアの身長の差の合計を最小化することです。  
 すなわち、 $ i $ 番目のペアの身長の組を $ (x_i,\ y_i) $ としたとき、 $ \displaystyle\ \sum_{i=1}^{(N+1)/2}|x_i-y_i| $ を最小化したいです。

あなたには $ M $ 個の変身形態があり、 $ i $ 番目の変身形態での身長は $ W_i $ です。

あなたの変身形態とペアの組み方を工夫することで、それぞれのペアの身長の差の合計が最小でいくつにできるか求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ M $ $ H_1 $ $ \dots $ $ H_N $ $ W_1 $ $ \dots $ $ W_M $

## 输出格式

変身形態とペアの組み方を工夫したときの、それぞれのペアの身長の差の合計の最小値を出力せよ。

## 说明/提示

### 制約

- 入力はすべて整数
- $ 1\ \leq\ N,\ M\ \leq\ 2\ \times\ 10^5 $
- $ N $ は奇数
- $ 1\ \leq\ H_i\ \leq\ 10^9 $
- $ 1\ \leq\ W_i\ \leq\ 10^9 $

### Sample Explanation 1

身長 $ 8 $ の変身形態を選び、身長が $ (1,\ 2),\ (3,\ 4),\ (7,\ 8) $ のペアを作ると最小になります。

## 样例 #1

### 输入

```
5 3

1 2 3 4 7

1 3 8
```

### 输出

```
3
```

## 样例 #2

### 输入

```
7 7

31 60 84 23 16 13 32

96 80 73 76 87 57 29
```

### 输出

```
34
```

## 样例 #3

### 输入

```
15 10

554 525 541 814 661 279 668 360 382 175 833 783 688 793 736

496 732 455 306 189 207 976 73 567 759
```

### 输出

```
239
```



---

---
title: "[ABC182D] Wandering"
layout: "post"
diff: 普及/提高-
pid: AT_abc182_d
tag: []
---

# [ABC182D] Wandering

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc182/tasks/abc182_d

数列 $ A_1,\ A_2,\ A_3,\ \dots,\ A_N $ が与えられます。 この数列は負の要素を含むかもしれません。  
 数直線上の座標 $ 0 $ に置かれているロボットが、以下の動作を順に行います。

- 正の向きに $ A_1 $ 進む。
- 正の向きに $ A_1 $ 進み、正の向きに $ A_2 $ 進む。
- 正の向きに $ A_1 $ 進み、正の向きに $ A_2 $ 進み、正の向きに $ A_3 $ 進む。

$ \hspace{140pt}\ \vdots $

- 正の向きに $ A_1 $ 進み、正の向きに $ A_2 $ 進み、正の向きに $ A_3 $ 進み、$ \dots $ 、正の向きに $ A_N $ 進む。

動作開始時から終了時までのロボットの座標の最大値を求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ A_1\ \hspace{7pt}\ A_2\ \hspace{7pt}\ A_3\ \hspace{5pt}\ \dots\ \hspace{5pt}\ A_N $

## 输出格式

動作開始時から終了時までのロボットの座標の最大値を出力せよ。

## 说明/提示

### 制約

- $ 1\ \le\ N\ \le\ 200000 $
- $ -10^8\ \le\ A_i\ \le\ 10^8 $
- 入力はすべて整数

### Sample Explanation 1

ロボットは以下のように動きます。 - 正の向きに $ 2 $ 進み、座標が $ 2 $ になる。 - 正の向きに $ 2 $ 進み、座標が $ 4 $ になる。続けて正の向きに $ -1 $ 進み、座標が $ 3 $ になる。 - 正の向きに $ 2 $ 進み、座標が $ 5 $ になる。続けて正の向きに $ -1 $ 進み、座標が $ 4 $ になる。更に正の向きに $ -2 $ 進み、座標が $ 2 $ になる。 動作中の座標の最大値は $ 5 $ なので、 $ 5 $ を出力してください。

### Sample Explanation 3

この場合最初にいた座標 $ 0 $ が最大値です。

## 样例 #1

### 输入

```
3

2 -1 -2
```

### 输出

```
5
```

## 样例 #2

### 输入

```
5

-2 1 3 -1 -1
```

### 输出

```
2
```

## 样例 #3

### 输入

```
5

-1000 -1000 -1000 -1000 -1000
```

### 输出

```
0
```



---

---
title: "[ABC182E] Akari"
layout: "post"
diff: 普及/提高-
pid: AT_abc182_e
tag: []
---

# [ABC182E] Akari

## 题目描述

有一个 $H$ 行 $W$ 列的网格，定义 $(i,j)$ 是第 $i$ 行 $j$ 列的方格。

这个网格上有 $N$ 个灯泡和 $M$ 个障碍物，第 $i$ 个灯泡在 $(A_i,B_i)$ 处，第 $i$ 个障碍物在 $(C_i, D_i)$ 处。每个方格保证最多只有一个灯泡或障碍物。

每一个灯泡都会将光照向上下左右四个方向延伸，直至遇到障碍物或到达边界。灯泡所在的方格也会有光照。

请你计算，被光照照到且没有障碍物的方格有多少。

## 输入格式

第一行四个整数 $H$、$W$、$N$ 和 $M$。

接下来 $N$ 行，每行两个整数 $A_i$ 和 $B_i$ 表示第 $i$ 个灯泡的坐标。

接下来 $M$ 行，每行两个整数 $C_i$ 和 $D_i$ 表示第 $i$ 个障碍物的坐标。

## 输出格式

一行一个表示答案的整数。

@[hellolin](/user/751017) 译。

## 样例 #1

### 输入

```
3 3 2 1

1 1

2 3

2 2
```

### 输出

```
7
```

## 样例 #2

### 输入

```
4 4 3 3

1 2

1 3

3 4

2 3

2 4

3 2
```

### 输出

```
8
```

## 样例 #3

### 输入

```
5 5 5 1

1 1

2 2

3 3

4 4

5 5

4 2
```

### 输出

```
24
```



---

---
title: "[ABC183E] Queen on Grid"
layout: "post"
diff: 普及/提高-
pid: AT_abc183_e
tag: []
---

# [ABC183E] Queen on Grid

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc183/tasks/abc183_e

縦 $ H $ マス、横 $ W $ マスのグリッドがあります。 上から $ i $ 行目、左から $ j $ 列目のマス $ (i,j) $ は、$ S_{ij} $ が `#` のとき壁であり、`.` のとき道です。

マス $ (1,1) $ にチェスのクイーンの駒が置いてあります。 クイーンの駒は、今いる位置から右・下・右下方向に伸びる直線上にあり、壁を飛び越えずに到達できる道のマスに $ 1 $ 手で移動することができます。

クイーンの駒がマス $ (1,1) $ からマス $ (H,W) $ まで移動する方法は何通りありますか？ $ \bmod\ (10^9+7) $ で求めてください。

ただし、移動する方法が異なるとは、ある $ i $ が存在して、$ i $ 手目の移動の後にクイーンの駒があるマスの位置が異なることを指します。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ H $ $ W $ $ S_{11}\ldots\ S_{1W} $ $ \vdots $ $ S_{H1}\ldots\ S_{HW} $

## 输出格式

クイーンの駒がマス $ (1,1) $ から $ (H,W) $ まで移動する方法の数を $ \mod\ (10^9+7) $ で出力せよ。

## 说明/提示

### 制約

- $ 2\ \leq\ H,W\ \leq\ 2000 $
- $ S_{ij} $ は `#` か `.`
- $ S_{11} $ と $ S_{HW} $ は `.`

### Sample Explanation 1

移動方法として次の $ 10 $ 通りが考えられます。 - $ (1,1)\to\ (1,2)\to\ (1,3)\to\ (2,3)\to\ (3,3) $ - $ (1,1)\to\ (1,2)\to\ (1,3)\to\ (3,3) $ - $ (1,1)\to\ (1,2)\to\ (2,3)\to\ (3,3) $ - $ (1,1)\to\ (1,3)\to\ (2,3)\to\ (3,3) $ - $ (1,1)\to\ (1,3)\to\ (3,3) $ - $ (1,1)\to\ (2,1)\to\ (3,1)\to\ (3,2)\to\ (3,3) $ - $ (1,1)\to\ (2,1)\to\ (3,1)\to\ (3,3) $ - $ (1,1)\to\ (2,1)\to\ (3,2)\to\ (3,3) $ - $ (1,1)\to\ (3,1)\to\ (3,2)\to\ (3,3) $ - $ (1,1)\to\ (3,1)\to\ (3,3) $

### Sample Explanation 2

$ (1,1) $ からは $ 1 $ 手で $ (1,2),(1,3),(2,1),(2,2),(3,1),(4,1) $ のいずれかへ移動することが出来ます。 $ (4,4) $ への移動経路として、例えば $ (1,1)\to\ (3,1)\to\ (3,2)\to\ (4,3)\to\ (4,4) $ などがあります。

### Sample Explanation 3

移動方法の数を $ \bmod\ (10^9+7) $ で求めてください。

## 样例 #1

### 输入

```
3 3

...

.#.

...
```

### 输出

```
10
```

## 样例 #2

### 输入

```
4 4

...#

....

..#.

....
```

### 输出

```
84
```

## 样例 #3

### 输入

```
8 10

..........

..........

..........

..........

..........

..........

..........

..........
```

### 输出

```
13701937
```



---

---
title: "[ABC184C] Super Ryuma"
layout: "post"
diff: 普及/提高-
pid: AT_abc184_c
tag: []
---

# [ABC184C] Super Ryuma

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc184/tasks/abc184_c

無限に広がる $ 2 $ 次元グリッドがあり、マス $ (r_1,\ c_1) $ に駒「超竜馬」が置かれています。  
 この駒は、 $ 1 $ 手で次のような動きができます。

![](https://cdn.luogu.com.cn/upload/vjudge_pic/AT_abc184_c/5bfa39c442ba1e792051275842c037db26123fff.png)

より正確には、超竜馬がマス $ (a,\ b) $ にあるとき、以下のいずれかの条件を満たすマス $ (c,\ d) $ に動かすことができます。

- $ a\ +\ b\ =\ c\ +\ d $
- $ a\ -\ b\ =\ c\ -\ d $
- $ |a\ -\ c|\ +\ |b\ -\ d|\ \le\ 3 $

超竜馬を $ (r_1,\ c_1) $ から $ (r_2,\ c_2) $ に動かすのに必要な最小手数を求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ r_1 $ $ c_1 $ $ r_2 $ $ c_2 $

## 输出格式

超竜馬を $ (r_1,\ c_1) $ から $ (r_2,\ c_2) $ に動かすのに必要な最小手数を出力せよ。

## 说明/提示

### 制約

- 入力は全て整数
- $ 1\ \le\ r_1,\ c_1,\ r_2,\ c_2\ \le\ 10^9 $

### Sample Explanation 1

例えば、 $ (1,\ 1)\ \rightarrow\ (5,\ 5)\ \rightarrow\ (5,\ 6) $ と動かすと $ 2 $ 手になります。

### Sample Explanation 2

例えば、 $ (1,\ 1)\ \rightarrow\ (100001,\ 100001)\ \rightarrow\ (1,\ 200001) $ と動かすと $ 2 $ 手になります。

### Sample Explanation 3

例えば、 $ (2,\ 3)\ \rightarrow\ (3,\ 3)\ \rightarrow\ (-247,\ 253)\ \rightarrow\ (998244353,\ 998244853) $ と動かすと $ 3 $ 手になります。

## 样例 #1

### 输入

```
1 1

5 6
```

### 输出

```
2
```

## 样例 #2

### 输入

```
1 1

1 200001
```

### 输出

```
2
```

## 样例 #3

### 输入

```
2 3

998244353 998244853
```

### 输出

```
3
```

## 样例 #4

### 输入

```
1 1

1 1
```

### 输出

```
0
```



---

---
title: "[ABC184D] increment of coins"
layout: "post"
diff: 普及/提高-
pid: AT_abc184_d
tag: []
---

# [ABC184D] increment of coins

## 题目描述

袋子里原本有金币 $ A $ 枚、银币 $ B $ 枚、铜币 $ C $ 枚。

直到袋子中有一种硬币达到 $100$ 枚之前，都会进行以下操作。

操作：每秒钟都有 $1$ 枚硬币被等概率地取出，然后向袋子中放入两枚相同的硬币。

求出操作次数的数学期望。

## 输入格式

输入为一行三个整数

> $ A $ $ B $ $ C $

## 输出格式

一行一个浮点数，为操作次数的数学期望。若与标准答案的误差不超过 $ 10^{-6} $，则视为正确答案

## 说明/提示

- $ 0\ \leq\ A,B,C\ \leq\ 99 $
- $ A+B+C\ \geq\ 1 $

### 【样例解释1】 

不论第一次操作取出哪种硬币，袋中都会出现 $ 100 $ 枚该种硬币。

### 【样例解释2】 

我们只会在第一次取出金币的情况下进行第二次操作，操作次数的数学期望为 $ 2\times\ \frac{98}{98+99+99}+1\times\ \frac{99}{98+99+99}+1\times\ \frac{99}{98+99+99}=1.331081081\ldots $。

### 【样例解释3】 

每次操作只会取出铜币

## 样例 #1

### 输入

```
99 99 99
```

### 输出

```
1.000000000
```

## 样例 #2

### 输入

```
98 99 99
```

### 输出

```
1.331081081
```

## 样例 #3

### 输入

```
0 0 1
```

### 输出

```
99.000000000
```

## 样例 #4

### 输入

```
31 41 59
```

### 输出

```
91.835008202
```



---

---
title: "[ABC185F] Range Xor Query"
layout: "post"
diff: 普及/提高-
pid: AT_abc185_f
tag: []
---

# [ABC185F] Range Xor Query

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc185/tasks/abc185_f

長さ $ N $ の整数列 $ A $ があります。  
 あなたは今からこの数列について $ Q $ 個のクエリを処理します。$ i $ 番目のクエリでは、 $ T_i,\ X_i,\ Y_i $ が与えられるので、以下の処理をしてください。

- $ T_i\ =\ 1 $ のとき  
   $ A_{X_i} $ を $ A_{X_i}\ \oplus\ Y_i $ で置き換える
- $ T_i\ =\ 2 $ のとき  
   $ A_{X_i}\ \oplus\ A_{X_i\ +\ 1}\ \oplus\ A_{X_i\ +\ 2}\ \oplus\ \dots\ \oplus\ A_{Y_i} $ を出力する

ただし $ a\ \oplus\ b $ は $ a $ と $ b $ のビット単位 xor を表します。  
 ビット単位 xor とは  整数 $ A,\ B $ のビット単位 xor 、$ A\ \oplus\ B $ は、以下のように定義されます。

\- $ A\ \oplus\ B $ を二進表記した際の $ 2^k $ ($ k\ \geq\ 0 $) の位の数は、$ A,\ B $ を二進表記した際の $ 2^k $ の位の数のうち一方のみが $ 1 $ であれば $ 1 $、そうでなければ $ 0 $ である。
 
 例えば、$ 3\ \oplus\ 5\ =\ 6 $ となります (二進表記すると: $ 011\ \oplus\ 101\ =\ 110 $)。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ Q $ $ A_1\ \hspace{7pt}\ A_2\ \hspace{7pt}\ A_3\ \hspace{5pt}\ \dots\ \hspace{5pt}\ A_N $ $ T_1 $ $ X_1 $ $ Y_1 $ $ T_2 $ $ X_2 $ $ Y_2 $ $ T_3 $ $ X_3 $ $ Y_3 $ $ \hspace{22pt}\ \vdots $ $ T_Q $ $ X_Q $ $ Y_Q $

## 输出格式

$ T_i\ =\ 2 $ であるような各クエリについて、答えを $ 1 $ 行に $ 1 $ つずつ、順に出力せよ。

## 说明/提示

### 制約

- $ 1\ \le\ N\ \le\ 300000 $
- $ 1\ \le\ Q\ \le\ 300000 $
- $ 0\ \le\ A_i\ \lt\ 2^{30} $
- $ T_i $ は $ 1 $ または $ 2 $
- $ T_i\ =\ 1 $ なら $ 1\ \le\ X_i\ \le\ N $ かつ $ 0\ \le\ Y_i\ \lt\ 2^{30} $
- $ T_i\ =\ 2 $ なら $ 1\ \le\ X_i\ \le\ Y_i\ \le\ N $
- 入力は全て整数

### Sample Explanation 1

$ 1 $ 個目のクエリでは $ 1\ \oplus\ 2\ \oplus\ 3\ =\ 0 $ を出力します。 $ 2 $ 個目のクエリでは $ 2\ \oplus\ 3\ =\ 1 $ を出力します。 $ 3 $ 個目のクエリでは $ A_2 $ が $ 2\ \oplus\ 3\ =\ 1 $ で置き換えられます。 $ 4 $ 個目のクエリでは $ 1\ \oplus\ 3\ =\ 2 $ を出力します。

## 样例 #1

### 输入

```
3 4

1 2 3

2 1 3

2 2 3

1 2 3

2 2 3
```

### 输出

```
0

1

2
```

## 样例 #2

### 输入

```
10 10

0 5 3 4 7 0 0 0 1 0

1 10 7

2 8 9

2 3 6

2 1 6

2 1 10

1 9 4

1 6 1

1 6 3

1 1 7

2 3 5
```

### 输出

```
1

0

5

3

0
```



---

---
title: "[ABC188D] Snuke Prime"
layout: "post"
diff: 普及/提高-
pid: AT_abc188_d
tag: []
---

# [ABC188D] Snuke Prime

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc188/tasks/abc188_d

株式会社すぬけは様々なサービスを提供しています。  
 この会社は、すぬけプライムという支払いプランを用意しています。  
 すぬけプライムへの加入中は、$ 1 $ 日あたり $ C $ 円を支払うことで、提供される全てのサービスを追加料金の支払いなしに利用することができます。  
 すぬけプライムへの加入および脱退は、それぞれ $ 1 $ 日の始めおよび終わりに自由に行うことができます。

高橋くんは、この会社のサービスのうち $ N $ 個を利用しようとしています。  
 そのうち $ i $ 個目のサービスは、今日を $ 1 $ 日目として、$ a_i $ 日目の始めから $ b_i $ 日目の終わりまで利用する予定です。  
 すぬけプライムに加入していない期間中は、$ i $ 個目のサービスを利用する際に $ 1 $ 日あたり $ c_i $ 円を支払う必要があります。

サービスを利用するために高橋くんが支払う必要のある最小の合計金額を求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ C $ $ a_1 $ $ b_1 $ $ c_1 $ $ \vdots $ $ a_N $ $ b_N $ $ c_N $

## 输出格式

高橋くんが支払う必要のある最小の合計金額を出力せよ。

## 说明/提示

### 制約

- $ 1\ \leq\ N\ \leq\ 2\ \times\ 10^5 $
- $ 1\ \leq\ C\ \leq\ 10^9 $
- $ 1\ \leq\ a_i\ \leq\ b_i\ \leq\ 10^9 $
- $ 1\ \leq\ c_i\ \leq\ 10^9 $
- 入力に含まれる値は全て整数

### Sample Explanation 1

$ 1 $ 番目のサービスは $ 1 $ 日目と $ 2 $ 日目に、 $ 2 $ 番目のサービスは $ 2 $ 日目に利用します。 $ 2 $ 日目のみすぬけプライムに加入すると、 $ 1 $ 日目に $ 4 $ 円、 $ 2 $ 日目に $ 6 $ 円がかかるため、高橋くんが支払う合計金額は $ 10 $ 円です。 高橋くんが支払う金額を $ 10 $ 円より少なくすることはできないため、 $ 10 $ を出力します。

### Sample Explanation 2

すぬけプライムに全く加入しないのが最適です。

## 样例 #1

### 输入

```
2 6

1 2 4

2 2 4
```

### 输出

```
10
```

## 样例 #2

### 输入

```
5 1000000000

583563238 820642330 44577

136809000 653199778 90962

54601291 785892285 50554

5797762 453599267 65697

468677897 916692569 87409
```

### 输出

```
163089627821228
```

## 样例 #3

### 输入

```
5 100000

583563238 820642330 44577

136809000 653199778 90962

54601291 785892285 50554

5797762 453599267 65697

468677897 916692569 87409
```

### 输出

```
88206004785464
```



---

---
title: "[ABC188E] Peddler"
layout: "post"
diff: 普及/提高-
pid: AT_abc188_e
tag: []
---

# [ABC188E] Peddler

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc188/tasks/abc188_e

高橋国には、町 $ 1 $ から町 $ N $ までの $ N $ 個の町があります。  
 また、この国には道 $ 1 $ から道 $ M $ までの $ M $ 本の道があります。道 $ i $ を使うと、町 $ X_i $ から町 $ Y_i $ へ移動することができます。逆向きへは移動できません。ここで $ X_i\ <\ Y_i $ であることが保証されます。  
 この国では金の取引が盛んであり、町 $ i $ では、金 $ 1\,\mathrm{kg} $ を $ A_i $ 円で売ったり買ったりすることができます。

旅商人である高橋君は、高橋国内のある町で金を $ 1\,\mathrm{kg} $ だけ買い、いくつかの道を使った後、**買った町とは別の町で**金を $ 1\,\mathrm{kg} $ だけ売ろうと考えています。  
 このとき、高橋君の利益 (すなわち $ ( $金を売った価格$ )\ -\ ( $金を買った価格$ ) $) として考えられる最大値を求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ M $ $ A_1 $ $ A_2 $ $ A_3 $ $ \dots $ $ A_N $ $ X_1 $ $ Y_1 $ $ X_2 $ $ Y_2 $ $ X_3 $ $ Y_3 $ $ \hspace{15pt}\ \vdots $ $ X_M $ $ Y_M $

## 输出格式

答えを出力せよ。

## 说明/提示

### 制約

- $ 2\ \le\ N\ \le\ 2\ \times\ 10^5 $
- $ 1\ \le\ M\ \le\ 2\ \times\ 10^5 $
- $ 1\ \le\ A_i\ \le\ 10^9 $
- $ 1\ \le\ X_i\ \lt\ Y_i\ \le\ N $
- $ (X_i,\ Y_i)\ \neq\ (X_j,\ Y_j)\ (i\ \neq\ j) $
- 入力に含まれる値は全て整数

### Sample Explanation 1

以下のようにして利益 $ 3 $ 円を達成できます。 - 町 $ 1 $ で $ 2 $ 円で金 $ 1\,\mathrm{kg} $ を買う - 道 $ 2 $ を使って町 $ 2 $ に移動する - 道 $ 1 $ を使って町 $ 4 $ に移動する - 町 $ 4 $ で $ 5 $ 円で金 $ 1\,\mathrm{kg} $ を売る

### Sample Explanation 2

以下のようにして利益 $ 10 $ 円を達成できます。 - 町 $ 2 $ で $ 8 $ 円で金 $ 1\,\mathrm{kg} $ を買う - 道 $ 1 $ を使って町 $ 4 $ に移動する - 道 $ 3 $ を使って町 $ 5 $ に移動する - 町 $ 5 $ で $ 18 $ 円で金 $ 1\,\mathrm{kg} $ を売る

### Sample Explanation 3

金を買った町で売ることはできないため、答えが負になる可能性があることに注意してください。

## 样例 #1

### 输入

```
4 3

2 3 1 5

2 4

1 2

1 3
```

### 输出

```
3
```

## 样例 #2

### 输入

```
5 5

13 8 3 15 18

2 4

1 2

4 5

2 3

1 3
```

### 输出

```
10
```

## 样例 #3

### 输入

```
3 1

1 100 1

2 3
```

### 输出

```
-99
```



---

---
title: "[ABC189D] Logical Expression"
layout: "post"
diff: 普及/提高-
pid: AT_abc189_d
tag: []
---

# [ABC189D] Logical Expression

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc189/tasks/abc189_d

$ N $ 個の文字列 $ S_1,\ldots,S_N $ が与えられます。各文字列は `AND` または `OR` です。

値が $ \text{True} $ または $ \text{False} $ であるような $ N+1 $ 個の変数の組 $ (x_0,\ldots,x_N) $ であって、 以下のような計算を行った際に、$ y_N $ が $ \text{True} $ となるようなものの個数を求めてください。

- $ y_0=x_0 $
- $ i\geq\ 1 $ のとき、$ S_i $ が `AND` なら $ y_i=y_{i-1}\ \land\ x_i $、$ S_i $ が `OR` なら $ y_i=y_{i-1}\ \lor\ x_i $

$ a\ \land\ b $ は $ a $ と $ b $ の論理積を表し、$ a\ \lor\ b $ は $ a $ と $ b $ の論理和を表します。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ S_1 $ $ \vdots $ $ S_N $

## 输出格式

答えを出力せよ。

## 说明/提示

### 制約

- $ 1\ \leq\ N\ \leq\ 60 $
- $ S_i $ は `AND` または `OR`

### Sample Explanation 1

例えば $ (x_0,x_1,x_2)=(\text{True},\text{False},\text{True}) $ のとき - $ y_0=x_0=\text{True} $ - $ y_1=y_0\ \land\ x_1\ =\ \text{True}\ \land\ \text{False}=\text{False} $ - $ y_2=y_1\ \lor\ x_2\ =\ \text{False}\ \lor\ \text{True}=\text{True} $ となり、$ y_2 $ は $ \text{True} $ になります。 $ y_2 $ が $ \text{True} $ となるような $ (x_0,x_1,x_2) $ の組み合わせは、 - $ (\text{True},\text{True},\text{True}) $ - $ (\text{True},\text{True},\text{False}) $ - $ (\text{True},\text{False},\text{True}) $ - $ (\text{False},\text{True},\text{True}) $ - $ (\text{False},\text{False},\text{True}) $ の $ 5 $ 通りで全てです。

### Sample Explanation 2

全てが $ \text{False} $ のときを除く $ 2^6-1 $ 通りで $ y_5 $ は $ \text{True} $ になります。

## 样例 #1

### 输入

```
2

AND

OR
```

### 输出

```
5
```

## 样例 #2

### 输入

```
5

OR

OR

OR

OR

OR
```

### 输出

```
63
```



---

---
title: "[ABC190D] Staircase Sequences"
layout: "post"
diff: 普及/提高-
pid: AT_abc190_d
tag: []
---

# [ABC190D] Staircase Sequences

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc190/tasks/abc190_d

整数からなる公差 $ 1 $ の等差数列のうち、総和が $ N $ であるものはいくつあるでしょうか？

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $

## 输出格式

答えを出力せよ。

## 说明/提示

### 制約

- $ 1\ <\ =\ N\ <\ =\ 10^{12} $
- $ N $ は整数

### Sample Explanation 1

\- $ [12] $ - $ [3,\ 4,\ 5] $ - $ [-2,\ -1,\ 0,\ 1,\ 2,\ 3,\ 4,\ 5] $ - $ [-11,\ -10,\ -9,\ \dots,\ 10,\ 11,\ 12] $ の $ 4 $ 個です。

### Sample Explanation 2

\- $ [1] $ - $ [0,\ 1] $ の $ 2 $ 個です。

## 样例 #1

### 输入

```
12
```

### 输出

```
4
```

## 样例 #2

### 输入

```
1
```

### 输出

```
2
```

## 样例 #3

### 输入

```
963761198400
```

### 输出

```
1920
```



---

---
title: "[ABC191C] Digital Graffiti"
layout: "post"
diff: 普及/提高-
pid: AT_abc191_c
tag: []
---

# [ABC191C] Digital Graffiti

## 题目描述

有一个 $H$ 行 $W$ 列的表格，格子要么为黑色，用‘#’表示，要么为白色，用‘.’表示。第一行和最后一行，第一列和最后一列都是白色格子。 考虑黑色部分组成的多边形，问多边形有多少条边？ 保证表格中，黑色部分为四联通区域，白色部分也为四联通区域。所谓四联通，即通过上、下、左、右四个方向，可以访问所有格子。 表格中至少存在一个黑色格子。

## 输入格式

第一行两个整数 $H$ , $W$ . 接下来 $H$ 行，每行一个长度为 $W$ 的字符串，由'#'或'.'组成。

## 输出格式

一个整数，表示答案

## 说明/提示

$3 \leq H \leq 10, 3 \leq W \leq 10$

## 样例 #1

### 输入

```
5 5

.....

.###.

.###.

.###.

.....
```

### 输出

```
4
```



---

---
title: "[ABC192E] Train"
layout: "post"
diff: 普及/提高-
pid: AT_abc192_e
tag: []
---

# [ABC192E] Train

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc192/tasks/abc192_e

AtCoder国には $ 1 $ から $ N $ の番号がついた $ N $ 個の都市と、$ 1 $ から $ M $ の番号がついた $ M $ 本の鉄道があります。

鉄道 $ i $ は都市 $ A_i $ と都市 $ B_i $ の間を結んでおり、時刻が $ K_i $ の倍数になる毎に、双方の都市からそれぞれ他方の都市への列車が発車します。この列車は出発から到着までに $ T_i $ の時間がかかります。

あなたはいま都市 $ X $ にいます。時刻 $ 0 $ またはそれ以降に都市 $ X $ を発車する列車に乗って移動を開始するとき、都市 $ Y $ には最速でいつたどり着けるか求めてください。都市 $ Y $ にたどり着くことが出来ない場合はそのことを報告してください。  
 ただし、乗り換えにかかる時間は無視できるため、どの都市においても、あなたの乗っている列車の到着時刻と同時に発車する別の列車に乗り換えることが可能であるとします。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ M $ $ X $ $ Y $ $ A_1 $ $ B_1 $ $ T_1 $ $ K_1 $ $ \vdots $ $ A_M $ $ B_M $ $ T_M $ $ K_M $

## 输出格式

都市 $ Y $ にたどり着くことができる最も早い時刻を出力せよ。ただし、都市 $ Y $ にたどり着くことが出来ない場合はかわりに `-1` と出力せよ。

## 说明/提示

### 制約

- $ 2\ \leq\ N\ \leq\ 10^5 $
- $ 0\ \leq\ M\ \leq\ 10^5 $
- $ 1\ \leq\ X,Y\ \leq\ N $
- $ X\ \neq\ Y $
- $ 1\ \leq\ A_i,B_i\ \leq\ N $
- $ A_i\ \neq\ B_i $
- $ 1\ \leq\ T_i\ \leq\ 10^9 $
- $ 1\ \leq\ K_i\ \leq\ 10^9 $
- 入力は全て整数

### Sample Explanation 1

まず、時刻 $ 0 $ に鉄道 $ 1 $ に乗って、都市 $ 1 $ から都市 $ 2 $ へ移動します。都市 $ 2 $ には時刻 $ 2 $ に到着します。 その後、時刻 $ 4 $ に鉄道 $ 2 $ に乗って、都市 $ 2 $ から都市 $ 3 $ へ移動します。都市 $ 3 $ には時刻 $ 7 $ に到着します。 これより早く都市 $ 3 $ に着く方法はありません。

### Sample Explanation 2

まず、時刻 $ 0 $ に鉄道 $ 2 $ に乗って、都市 $ 3 $ から都市 $ 2 $ へ移動します。都市 $ 2 $ には時刻 $ 3 $ に到着します。 その後、時刻 $ 3 $ に鉄道 $ 1 $ に乗って、都市 $ 2 $ から都市 $ 1 $ へ移動します。都市 $ 1 $ には時刻 $ 5 $ に到着します。

## 样例 #1

### 输入

```
3 2 1 3

1 2 2 3

2 3 3 4
```

### 输出

```
7
```

## 样例 #2

### 输入

```
3 2 3 1

1 2 2 3

2 3 3 4
```

### 输出

```
5
```

## 样例 #3

### 输入

```
3 0 3 1
```

### 输出

```
-1
```

## 样例 #4

### 输入

```
9 14 6 7

3 1 4 1

5 9 2 6

5 3 5 8

9 7 9 3

2 3 8 4

6 2 6 4

3 8 3 2

7 9 5 2

8 4 1 9

7 1 6 9

3 9 9 3

7 5 1 5

8 2 9 7

4 9 4 4
```

### 输出

```
26
```



---

---
title: "[ABC193D] Poker"
layout: "post"
diff: 普及/提高-
pid: AT_abc193_d
tag: []
---

# [ABC193D] Poker

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc193/tasks/abc193_d

$ 1,\ 2,\ \dots,\ 9 $ が表に書かれたカードが $ K $ 枚ずつ、計 $ 9K $ 枚のカードがあります。  
 これらのカードをランダムにシャッフルして、高橋くんと青木くんにそれぞれ、$ 4 $ 枚を表向きに、$ 1 $ 枚を裏向きにして配りました。  
 高橋くんに配られたカードが文字列 $ S $ として、青木くんに配られたカードが文字列 $ T $ として与えられます。  
 $ S,\ T $ は $ 5 $ 文字の文字列で、先頭 $ 4 $ 文字は `1`, `2`, $ \dots $, `9` からなり、表向きのカードに書かれた数を表します。 末尾 $ 1 $ 文字は `#` であり、裏向きのカードであることを表します。  
 $ 5 $ 枚の手札の点数を、$ c_i $ をその手札に含まれる $ i $ の枚数として、$ \displaystyle\ \sum_{i=1}^9\ i\ \times\ 10^{c_i} $ で定義します。  
 高橋くんが青木くんより点数の高い手札を持っていたら高橋くんの勝ちです。  
 高橋くんの勝つ確率を求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ K $ $ S $ $ T $

## 输出格式

高橋くんの勝つ確率を小数で出力せよ。  
 想定解答との絶対誤差または相対誤差が $ 10^{-5} $ 以下であれば正解と判定される。

## 说明/提示

### 制約

- $ 2\ <\ = K\ <\ =\ 10^5 $
- $ |S|\ =\ |T|\ =\ 5 $
- $ S,\ T $ の $ 1 $ 文字目から $ 4 $ 文字目は `1`, `2`, $ \dots $, `9` のいずれか
- `1`, `2`, $ \dots $, `9` はそれぞれ、$ S $ と $ T $ に合計 $ K $ 回までしか出現しない
- $ S,\ T $ の $ 5 $ 文字目は `#`

### Sample Explanation 1

例えば、高橋くんの手札が `11449` 、青木くんの手札が `22338` の場合、高橋くんの点数は $ 100+2+3+400+5+6+7+8+90=621 $ 、青木くんの点数は $ 1+200+300+4+5+6+7+80+9=612 $ で、高橋くんの勝ちになります。 裏向きのカードの大小によって勝敗が決まるので、高橋くんの勝つ確率は $ \frac49 $ です。

### Sample Explanation 3

高橋くんの手札が `11222` 、青木くんの手札が `22281` の場合にのみ高橋くんの勝ちになります。 高橋くんの勝つ確率は $ \frac2{1035} $ です。

## 样例 #1

### 输入

```
2

1144#

2233#
```

### 输出

```
0.4444444444444444
```

## 样例 #2

### 输入

```
2

9988#

1122#
```

### 输出

```
1.0
```

## 样例 #3

### 输入

```
6

1122#

2228#
```

### 输出

```
0.001932367149758454
```

## 样例 #4

### 输入

```
100000

3226#

3597#
```

### 输出

```
0.6296297942426154
```



---

---
title: "[ABC194D] Journey"
layout: "post"
diff: 普及/提高-
pid: AT_abc194_d
tag: []
---

# [ABC194D] Journey

## 题目描述

在一张有 $n$ 个节点的图上，高桥站在节点 $1$ 处。现在的图没有任何连边。

高桥在图连通之前，会重复执行下列操作：

- 随机选择一个点，每个点被选中的概率在每一次都是相等的，都是 $\frac{1}{n}$。
- 从当前点连一条边到选中的点。图允许重边和自环。然后，去到那个选中的点。

求出其期望操作次数。你的答案与标准答案的误差不超过 $10^{-6}$ 即可被判为通过。

## 输入格式

一行一个整数 $n$（$2\le n\le 10^5$）。

## 输出格式

一行一个实数，期望操作次数。

## 样例 #1

### 输入

```
2
```

### 输出

```
2.00000000000
```

## 样例 #2

### 输入

```
3
```

### 输出

```
4.50000000000
```



---

---
title: "[ABC194E] Mex Min"
layout: "post"
diff: 普及/提高-
pid: AT_abc194_e
tag: []
---

# [ABC194E] Mex Min

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc194/tasks/abc194_e

$ \mathrm{mex}(x_1,\ x_2,\ x_3,\ \dots,\ x_k) $ を、$ x_1,\ x_2,\ x_3,\ \dots,\ x_k $ に含まれない最小の非負整数と定義します。  
 長さ $ N $ の整数列 $ A\ =\ (A_1,\ A_2,\ A_3,\ \dots,\ A_N) $ が与えられます。  
 $ 0\ \le\ i\ \le\ N\ -\ M $ を満たす全ての整数 $ i $ について $ \mathrm{mex}(A_{i\ +\ 1},\ A_{i\ +\ 2},\ A_{i\ +\ 3},\ \dots,\ A_{i\ +\ M}) $ を計算したとき、この $ N\ -\ M\ +\ 1 $ 個の値のうちの最小値を求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ M $ $ A_1 $ $ A_2 $ $ A_3 $ $ \cdots $ $ A_N $

## 输出格式

答えを出力せよ。

## 说明/提示

### 制約

- $ 1\ \le\ M\ \le\ N\ \le\ 1.5\ \times\ 10^6 $
- $ 0\ \le\ A_i\ \lt\ N $
- 入力に含まれる値は全て整数

### Sample Explanation 1

\- $ i\ =\ 0 $ のとき : $ \mathrm{mex}(A_{i\ +\ 1},\ A_{i\ +\ 2})\ =\ \mathrm{mex}(0,\ 0)\ =\ 1 $ - $ i\ =\ 1 $ のとき : $ \mathrm{mex}(A_{i\ +\ 1},\ A_{i\ +\ 2})\ =\ \mathrm{mex}(0,\ 1)\ =\ 2 $ よって $ 1 $ と $ 2 $ のうちの最小値である $ 1 $ が答えです。

### Sample Explanation 2

\- $ i\ =\ 0 $ のとき : $ \mathrm{mex}(A_{i\ +\ 1},\ A_{i\ +\ 2})\ =\ \mathrm{mex}(1,\ 1)\ =\ 0 $ - $ i\ =\ 1 $ のとき : $ \mathrm{mex}(A_{i\ +\ 1},\ A_{i\ +\ 2})\ =\ \mathrm{mex}(1,\ 1)\ =\ 0 $ となります。

### Sample Explanation 3

\- $ i\ =\ 0 $ のとき : $ \mathrm{mex}(A_{i\ +\ 1},\ A_{i\ +\ 2})\ =\ \mathrm{mex}(0,\ 1)\ =\ 2 $ - $ i\ =\ 1 $ のとき : $ \mathrm{mex}(A_{i\ +\ 1},\ A_{i\ +\ 2})\ =\ \mathrm{mex}(1,\ 0)\ =\ 2 $ となります。

## 样例 #1

### 输入

```
3 2

0 0 1
```

### 输出

```
1
```

## 样例 #2

### 输入

```
3 2

1 1 1
```

### 输出

```
0
```

## 样例 #3

### 输入

```
3 2

0 1 0
```

### 输出

```
2
```

## 样例 #4

### 输入

```
7 3

0 0 1 2 0 1 0
```

### 输出

```
2
```



---

---
title: "[ABC195D] Shipping Center"
layout: "post"
diff: 普及/提高-
pid: AT_abc195_d
tag: []
---

# [ABC195D] Shipping Center

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc195/tasks/abc195_d

$ 1 $ から $ N $ の番号がついた $ N $ 個の荷物と、$ 1 $ から $ M $ の番号がついた $ M $ 個の箱があります。

荷物 $ i $ の大きさは $ W_i $ で、価値は $ V_i $ です。

箱 $ i $ には大きさが $ X_i $ 以下の荷物を入れることができます。$ 1 $ つの箱に $ 2 $ つ以上の荷物を入れることはできません。

$ Q $ 個のクエリが与えられます。各クエリでは $ 2 $ つの整数 $ L,R $ が与えられるので、次の問題を解いてください。

- 問題：$ M $ 個の箱のうち、箱 $ L,L+1,\ldots,R $ の $ R-L+1 $ 個の箱が使えなくなってしまいました。 残りの箱の中に同時に入れることができる荷物の価値の合計の最大値を求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ M $ $ Q $ $ W_1 $ $ V_1 $ $ \vdots $ $ W_N $ $ V_N $ $ X_1 $ $ \ldots $ $ X_M $ $ \mathrm{Query}_1 $ $ \vdots $ $ \mathrm{Query}_Q $

各クエリは以下の形式で与えられる。

> $ L $ $ R $

## 输出格式

$ Q $ 行出力せよ。

$ i $ 行目には、$ \mathrm{Query}_i $ に対応する問題の答えを出力せよ。

## 说明/提示

### 制約

- $ 1\ \leq\ N\ \leq\ 50 $
- $ 1\ \leq\ M\ \leq\ 50 $
- $ 1\ \leq\ Q\ \leq\ 50 $
- $ 1\ \leq\ W_i\ \leq\ 10^6 $
- $ 1\ \leq\ V_i\ \leq\ 10^6 $
- $ 1\ \leq\ X_i\ \leq\ 10^6 $
- $ 1\ \leq\ L\ \leq\ R\ \leq\ M $
- 入力は全て整数

### Sample Explanation 1

$ 1 $ 番目のクエリでは箱 $ 4 $ が使えません。 箱 $ 1 $ に荷物 $ 1 $ を、箱 $ 2 $ に荷物 $ 3 $ を、箱 $ 3 $ に荷物 $ 2 $ を入れることで、 全ての荷物を箱の中に入れることができ、箱の中の荷物の価値の合計を $ 20 $ にすることができます。 $ 2 $ 番目のクエリでは全ての箱が使えません。したがって、答えは $ 0 $ です。 $ 3 $ 番目のクエリでは、箱 $ 4 $ だけが使えます。箱 $ 4 $ に荷物 $ 1 $ を入れることで、箱の中の荷物の価値の合計は $ 9 $ となり、これが最大です。

## 样例 #1

### 输入

```
3 4 3

1 9

5 3

7 8

1 8 6 9

4 4

1 4

1 3
```

### 输出

```
20

0

9
```



---

---
title: "[ABC196D] Hanjo"
layout: "post"
diff: 普及/提高-
pid: AT_abc196_d
tag: []
---

# [ABC196D] Hanjo

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc196/tasks/abc196_d

縦 $ H $ メートル、横 $ W $ メートルの長方形の部屋があります。  
 この部屋に $ 2 $ メートル $ × $ $ 1 $ メートルの区別できない畳 (長方形のタイル) $ A $ 枚と、$ 1 $ メートル $ × $ $ 1 $ メートルの区別できない半畳 (正方形のタイル) $ B $ 枚を敷き詰めます。 $ 2 $ メートル $ × $ $ 1 $ メートルの畳は縦長にも横長にも使うことができます。  
 敷き詰める方法は何通りあるでしょうか？  
 なお、$ 2A\ +\ B\ =\ HW $ であることが保証されます。 また、回転や反転を行うことで初めて一致するような敷き詰め方は区別します。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ H $ $ W $ $ A $ $ B $

## 输出格式

答えを出力せよ。

## 说明/提示

### 制約

- 入力は全て整数
- $ 1\ <\ =\ H,\ W $
- $ HW\ <\ =\ 16 $
- $ 0\ <\ =\ A,\ B $
- $ 2A\ +\ B\ =\ HW $

### Sample Explanation 1

以下の $ 4 $ つです。 !\[\](https://img.atcoder.jp/ghi/d01b63c75c91bd87a73e9a4cc43dda28.png)

### Sample Explanation 2

以下の $ 6 $ つと、これらを回転させたものが含まれます。 !\[\](https://img.atcoder.jp/ghi/b7a492abe22e30683e8f9a7b309acd52.png)

## 样例 #1

### 输入

```
2 2 1 2
```

### 输出

```
4
```

## 样例 #2

### 输入

```
3 3 4 1
```

### 输出

```
18
```

## 样例 #3

### 输入

```
4 4 8 0
```

### 输出

```
36
```



---

---
title: "[ABC197C] ORXOR"
layout: "post"
diff: 普及/提高-
pid: AT_abc197_c
tag: []
---

# [ABC197C] ORXOR

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc197/tasks/abc197_c

長さ $ N $ の数列 $ A $ が与えられます。  
 この数列を、$ 1 $ つ以上の空でない連続した区間に分けます。  
 その後、分けた各区間で、区間内の数のビット単位 $ \mathrm{OR} $ を計算します。  
 こうして得られた全ての値のビット単位 $ \mathrm{XOR} $ として考えられる最小値を求めてください。

  ビット単位 $ \mathrm{OR} $ 演算とは  整数 $ A,\ B $ のビット単位 $ \mathrm{OR} $、$ A\ \mathrm{OR}\ B $ は以下のように定義されます。

- $ A\ \mathrm{OR}\ B $ を二進表記した際の $ 2^k $ ($ k\ \geq\ 0 $) の位の数は、$ A,\ B $ を二進表記した際の $ 2^k $ の位の数のうち少なくとも片方が $ 1 $ であれば $ 1 $、そうでなければ $ 0 $ である。
 
 例えば、$ 3\ \mathrm{OR}\ 5\ =\ 7 $ となります (二進表記すると: $ 011\ \mathrm{OR}\ 101\ =\ 111 $)。  
 一般に $ k $ 個の整数 $ p_1,\ p_2,\ p_3,\ \dots,\ p_k $ のビット単位 $ \mathrm{OR} $ は $ (\dots\ ((p_1\ \mathrm{OR}\ p_2)\ \mathrm{OR}\ p_3)\ \mathrm{OR}\ \dots\ \mathrm{OR}\ p_k) $ と定義され、これは $ p_1,\ p_2,\ p_3,\ \dots\ p_k $ の順番によらないことが証明できます。  ビット単位 $ \mathrm{XOR} $ 演算とは  整数 $ A,\ B $ のビット単位 $ \mathrm{XOR} $ 、$ A\ \mathrm{XOR}\ B $ は、以下のように定義されます。

- $ A\ \mathrm{XOR}\ B $ を二進表記した際の $ 2^k $ ($ k\ \geq\ 0 $) の位の数は、$ A,\ B $ を二進表記した際の $ 2^k $ の位の数のうち一方のみが $ 1 $ であれば $ 1 $、そうでなければ $ 0 $ である。
 
 例えば、$ 3\ \mathrm{XOR}\ 5\ =\ 6 $ となります (二進表記すると: $ 011\ \mathrm{XOR}\ 101\ =\ 110 $)。  
 一般に $ k $ 個以上の整数 $ p_1,\ p_2,\ p_3,\ \dots,\ p_k $ のビット単位 $ \mathrm{XOR} $ は $ (\dots\ ((p_1\ \mathrm{XOR}\ p_2)\ \mathrm{XOR}\ p_3)\ \mathrm{XOR}\ \dots\ \mathrm{XOR}\ p_k) $ と定義され、これは $ p_1,\ p_2,\ p_3,\ \dots\ p_k $ の順番によらないことが証明できます。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ A_1 $ $ A_2 $ $ A_3 $ $ \dots $ $ A_N $

## 输出格式

答えを出力せよ。

## 说明/提示

### 制約

- $ 1\ \le\ N\ \le\ 20 $
- $ 0\ \le\ A_i\ \lt\ 2^{30} $
- 入力に含まれる値は全て整数である

### Sample Explanation 1

$ [1,\ 5,\ 7] $ を $ [1,\ 5] $ と $ [7] $ の $ 2 $ つの区間に分けると、それぞれの区間内の数のビット単位 $ \mathrm{OR} $ は $ 5,\ 7 $ となり、その $ \mathrm{XOR} $ は $ 2 $ です。 これより小さくすることはできないので、$ 2 $ を出力します。

### Sample Explanation 2

$ [10] $ と $ [10,\ 10] $ に分けるとよいです。

### Sample Explanation 3

$ [1,\ 3] $ と $ [3,\ 1] $ に分けるとよいです。

## 样例 #1

### 输入

```
3

1 5 7
```

### 输出

```
2
```

## 样例 #2

### 输入

```
3

10 10 10
```

### 输出

```
0
```

## 样例 #3

### 输入

```
4

1 3 3 1
```

### 输出

```
0
```



---

---
title: "[ABC197D] Opposite"
layout: "post"
diff: 普及/提高-
pid: AT_abc197_d
tag: []
---

# [ABC197D] Opposite

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc197/tasks/abc197_d

$ \mathrm{x} $ 軸の正の向きを右、$ \mathrm{y} $ 軸の正の向きを上とする $ 2 $ 次元座標平面上に、$ p_0,\ p_1,\ p_2,\ \dots,\ p_{N\ -\ 1} $ の $ N $ 個の頂点からなる正 $ N $ 角形があります。  
 ここで $ N $ は偶数であることが保証され、頂点 $ p_0,\ p_1,\ p_2,\ \dots,\ p_{N\ -\ 1} $ はこの順に反時計回りに並んでいます。  
 $ p_i $ の座標を $ (x_i,\ y_i) $ とします。  
 $ x_0,\ y_0,\ x_{\frac{N}{2}},\ y_{\frac{N}{2}} $ が与えられるので、$ x_1,\ y_1 $ を求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ x_0 $ $ y_0 $ $ x_{\frac{N}{2}} $ $ y_{\frac{N}{2}} $

## 输出格式

$ x_1,\ y_1 $ をこの順に空白区切りで出力せよ。  
 出力されたそれぞれの値について、想定解答との絶対誤差または相対誤差が $ 10^{-5} $ 以下であれば正解と判定される。

## 说明/提示

### 制約

- $ 4\ \le\ N\ \le\ 100 $
- $ N $ は偶数
- $ 0\ \le\ x_0,\ y_0\ \le\ 100 $
- $ 0\ \le\ x_{\frac{N}{2}},\ y_{\frac{N}{2}}\ \le\ 100 $
- $ (x_0,\ y_0)\ \neq\ (x_{\frac{N}{2}},\ y_{\frac{N}{2}}) $
- 入力に含まれる値は全て整数である

### Sample Explanation 1

$ p_0\ =\ (1,\ 1),\ p_2\ =\ (2,\ 2) $ という情報が与えられています。 $ p_0,\ p_1,\ p_2,\ p_3 $ が正方形をなし、反時計回りに並んでいるという情報から残りの頂点の座標は一意に定まり、以下のようになります。 - $ p_1\ =\ (2,\ 1) $ - $ p_3\ =\ (1,\ 2) $

## 样例 #1

### 输入

```
4

1 1

2 2
```

### 输出

```
2.00000000000 1.00000000000
```

## 样例 #2

### 输入

```
6

5 3

7 4
```

### 输出

```
5.93301270189 2.38397459622
```



---

---
title: "[ABC198D] Send More Money"
layout: "post"
diff: 普及/提高-
pid: AT_abc198_d
tag: []
---

# [ABC198D] Send More Money

## 题目描述

给你三个由小写字母组成的字符串 $ S_1, S_2, S_3 $。请解出这道覆面算：$ S_1 + S_2 = S_3 $。

具体来说，要求你确定是否存在一组符合以下条件的正整数 $ N_1, N_2, N_3 $，如果存在，请输出其中一个组合：

1. $ N_1, N_2, N_3 $ 分别表示的十进制数字串 $ N'_1, N'_2, N'_3 $ 的长度与对应的字符串 $ S_1, S_2, S_3 $ 的长度相同，并且不含前导零。
2. 满足 $ N_1 + N_2 = N_3 $。
3. 如果 $ S_i $ 的第 $ x $ 个字符和 $ S_j $ 的第 $ y $ 个字符相同，那么 $ N'_i $ 的第 $ x $ 个数字和 $ N'_j $ 的第 $ y $ 个数字也必须相同。

## 输入格式

输入为一行，其中包含三个字符串 $ S_1, S_2, S_3 $。

## 输出格式

如果存在符合条件的正整数组合 $ N_1, N_2, N_3 $，则每行输出其中一个可能的组合。如果没有满足条件的组合，则输出 `UNSOLVABLE`。

## 说明/提示

- $ S_1, S_2, S_3 $ 是长度在 $ 1 $ 到 $ 10 $ 之间的小写字母字符串。

### 示例解释

在示例 1 中，输出 $ (N_1, N_2, N_3) = (4, 5, 9) $ 是正确的组合，而 $ (1, 1, 2) $ 因不满足条件 3 （例如，字符 `a` 和 `b` 都对应 $ 1 $）因此是错误的。

在示例 2 中，输出 $ (N_1, N_2, N_3) = (3, 3, 6) $ 是一个正确的答案，而 $ (1, 2, 3) $ 因为未满足条件 3（例如，数字 $ 1 $ 和 $ 2 $ 在对应字符 `x` 时不一致）是错误的。

 **本翻译由 AI 自动生成**

## 样例 #1

### 输入

```
a

b

c
```

### 输出

```
1

2

3
```

## 样例 #2

### 输入

```
x

x

y
```

### 输出

```
1

1

2
```

## 样例 #3

### 输入

```
p

q

p
```

### 输出

```
UNSOLVABLE
```

## 样例 #4

### 输入

```
abcd

efgh

ijkl
```

### 输出

```
UNSOLVABLE
```

## 样例 #5

### 输入

```
send

more

money
```

### 输出

```
9567

1085

10652
```



---

---
title: "[ABC198E] Unique Color"
layout: "post"
diff: 普及/提高-
pid: AT_abc198_e
tag: []
---

# [ABC198E] Unique Color

## 题目描述

给定一棵以 $1$ 节点为根的树。每个节点上都被染了一种颜色，不同颜色用不同整数表示。问：有多少个节点，它们到根节点的路径上的所有点（除了自己）的颜色都与自己的颜色不同。

## 输入格式

第一行输入整数 $n$（$2\le n\le 10^5$）。

第二行输入 $n$ 个整数，第 $i$ 个整数表示节点 $i$ 的颜色。（$1\le$ 每个节点的颜色 $\le 10^5$）

最后 $(n-1)$ 行：每行两个数 $a_i$,$b_i$，表示一条树边。

## 输出格式

一行一个整数，题目所求。

## 样例 #1

### 输入

```
6

2 7 1 8 2 8

1 2

3 6

3 2

4 3

2 5
```

### 输出

```
1

2

3

4

6
```

## 样例 #2

### 输入

```
10

3 1 4 1 5 9 2 6 5 3

1 2

2 3

3 4

4 5

5 6

6 7

7 8

8 9

9 10
```

### 输出

```
1

2

3

5

6

7

8
```



---

---
title: "[ABC200D] Happy Birthday! 2"
layout: "post"
diff: 普及/提高-
pid: AT_abc200_d
tag: []
---

# [ABC200D] Happy Birthday! 2

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc200/tasks/abc200_d

$ N $ 個の正整数からなる数列 $ A\ =\ (A_1,\ A_2,\ \dots,\ A_N) $ が与えられます。 以下の条件を全て満たす $ 2 $ つの数列 $ B\ =\ (B_1,\ B_2,\ \dots,\ B_x),\ C\ =\ (C_1,\ C_2,\ \dots,\ C_y) $ が存在するか判定し、存在する場合はひとつ出力してください。

- $ 1\ <\ = x,\ y\ <\ =\ N $
- $ 1\ \le\ B_1\ <\ B_2\ <\ \dots\ <\ B_{x}\ \le\ N $
- $ 1\ \le\ C_1\ <\ C_2\ <\ \dots\ <\ C_{y}\ \le\ N $
- $ B $ と $ C $ は、異なる数列である。
  - $ x\ ≠\ y $ のとき、または、ある整数 $ i\ (1\ <\ = i\ <\ = \min(x,\ y)) $ が存在して $ B_i\ ≠\ C_i $ であるとき、$ B $ と $ C $ は異なるものとする。
- $ A_{B_1}\ +\ A_{B_2}\ +\ \dots\ +\ A_{B_x} $ を $ 200 $ で割った余りと $ A_{C_1}\ +\ A_{C_2}\ +\ \dots\ +\ A_{C_y} $ を $ 200 $ で割った余りが等しい。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ A_1 $ $ A_2 $ $ \dots $ $ A_N $

## 输出格式

条件を満たす数列の組 $ B,C $ が存在しない場合、$ 1 $ 行に `No` と出力せよ。 存在する場合、以下の形式で $ B,C $ を出力せよ。

> Yes $ x $ $ B_1 $ $ B_2 $ $ \dots $ $ B_x $ $ y $ $ C_1 $ $ C_2 $ $ \dots $ $ C_y $

なお、正誤判定器は英大文字と英小文字を区別せず、どちらも受理する。

## 说明/提示

### 制約

- 入力はすべて整数
- $ 2\ \le\ N\ \le\ 200 $
- $ 1\ \le\ A_i\ \le\ 10^9 $

### Sample Explanation 1

$ B=(1),C=(3,4) $ とすると、$ A_1\ =\ 180,\ A_3\ +\ A_4\ =\ 380 $ となり、この $ 2 $ つを $ 200 $ で割った余りは等しくなります。 他にも、以下のような出力も正答として扱われます。 ``` yEs 4 2 3 4 5 3 1 2 5 ```

### Sample Explanation 3

条件を満たす数列の組が存在しない場合、$ 1 $ 行に `No` と出力してください。

## 样例 #1

### 输入

```
5

180 186 189 191 218
```

### 输出

```
Yes

1 1

2 3 4
```

## 样例 #2

### 输入

```
2

123 523
```

### 输出

```
Yes

1 1

1 2
```

## 样例 #3

### 输入

```
6

2013 1012 2765 2021 508 6971
```

### 输出

```
No
```



---

---
title: "[ABC202D] aab aba baa"
layout: "post"
diff: 普及/提高-
pid: AT_abc202_d
tag: []
---

# [ABC202D] aab aba baa

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc202/tasks/abc202_d

$ A $ 個の `a` と $ B $ 個の `b` からなる長さ $ A\ +\ B $ の文字列のうち、辞書順で $ K $ 番目のものを求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ A $ $ B $ $ K $

## 输出格式

答えを出力せよ。

## 说明/提示

### 制約

- $ 1\ \leq\ A,\ B\ \leq\ 30 $
- $ A $ 個の `a` と $ B $ 個の `b` からなる長さ $ A\ +\ B $ の文字列の総数を $ S $ 個とおいたとき、$ 1\ \leq\ K\ \leq\ S $
- 入力は全て整数である。

### Sample Explanation 1

$ 2 $ 個の `a` と $ 2 $ 個の `b` からなる文字列を辞書順に並べると、`aabb`、`abab`、`abba`、`baab`、`baba`、`bbaa` となります。 よって、$ 4 $ 番目である `baab` を出力します。

### Sample Explanation 2

$ K $ の値は $ 32 $ bit 整数に収まらないことがあります。

## 样例 #1

### 输入

```
2 2 4
```

### 输出

```
baab
```

## 样例 #2

### 输入

```
30 30 118264581564861424
```

### 输出

```
bbbbbbbbbbbbbbbbbbbbbbbbbbbbbbaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa
```



---

---
title: "[ABC204D] Cooking"
layout: "post"
diff: 普及/提高-
pid: AT_abc204_d
tag: []
---

# [ABC204D] Cooking

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc204/tasks/abc204_d

高橋君は料理 $ 1 $ から $ N $ の $ N $ 品の料理を作ろうとしています。

料理 $ i $ はオーブンを連続した $ T_i $ 分間使うことで作れます。$ 1 $ つのオーブンを $ 2 $ つ以上の料理のために同時に使うことはできません。

$ 2 $ つのオーブンを使えるとき、$ N $ 品の料理を全て作るまでに最短で何分かかりますか？ なお、オーブンを使う時間以外は無視できるものとします。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ T_1 $ $ \ldots $ $ T_N $

## 输出格式

答えを出力せよ。

## 说明/提示

### 制約

- $ 1\ \leq\ N\ \leq\ 100 $
- $ 1\ \leq\ T_i\ \leq\ 10^3 $
- 入力に含まれる値は全て整数である

### Sample Explanation 1

例えば $ 2 $ つのオーブンを次のように使うことで、$ 13 $ 分で全ての料理を作ることができます。 - $ 1 $ つ目のオーブン：料理 $ 5,1 $ を順に作る。 - $ 2 $ つ目のオーブン：料理 $ 2,4,3 $ を順に作る。

## 样例 #1

### 输入

```
5

8 3 7 2 5
```

### 输出

```
13
```

## 样例 #2

### 输入

```
2

1000 1
```

### 输出

```
1000
```

## 样例 #3

### 输入

```
9

3 14 15 9 26 5 35 89 79
```

### 输出

```
138
```



---

---
title: "[ABC205D] Kth Excluded"
layout: "post"
diff: 普及/提高-
pid: AT_abc205_d
tag: []
---

# [ABC205D] Kth Excluded

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc205/tasks/abc205_d

長さ $ N $ の正整数列 $ A\ =\ (A_1,\ A_2,\ \dots,\ A_N) $ と $ Q $ 個のクエリが与えられます。

$ i\ \,\ (1\ \leq\ i\ \leq\ Q) $ 番目のクエリでは、正整数 $ K_i $ が与えられるので、$ A_1,\ A_2,\ \dots,\ A_N $ のいずれとも異なる正整数のうち、小さい方から数えて $ K_i $ 番目のものを求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ Q $ $ A_1 $ $ A_2 $ $ \ldots $ $ A_N $ $ K_1 $ $ K_2 $ $ \vdots $ $ K_Q $

## 输出格式

$ Q $ 行出力せよ。$ i $ 行目には $ i $ 番目のクエリに対する答えを出力せよ。

## 说明/提示

### 制約

- $ 1\ \leq\ N,\ Q\ \leq\ 10^5 $
- $ 1\ \leq\ A_1\ <\ A_2\ <\ \dots\ <\ A_N\ \leq\ 10^{18} $
- $ 1\ \leq\ K_i\ \leq\ 10^{18} $
- 入力は全て整数である。

### Sample Explanation 1

$ 3,\ 5,\ 6,\ 7 $ のいずれとも異なる正整数を小さい順に並べると $ 1,\ 2,\ 4,\ 8,\ 9,\ 10,\ 11,\ \dots $ となります。 小さい方から $ 2 $ 番目、$ 5 $ 番目、$ 3 $ 番目はそれぞれ $ 2,\ 9,\ 4 $ です。

## 样例 #1

### 输入

```
4 3

3 5 6 7

2

5

3
```

### 输出

```
2

9

4
```

## 样例 #2

### 输入

```
5 2

1 2 3 4 5

1

10
```

### 输出

```
6

15
```



---

---
title: "[ABC206D] KAIBUNsyo"
layout: "post"
diff: 普及/提高-
pid: AT_abc206_d
tag: []
---

# [ABC206D] KAIBUNsyo

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc206/tasks/abc206_d

$ N $ 項からなる正整数列 $ A=(A_1,A_2,\ \dots\ A_N) $ が与えられます。  
 以下の操作を $ 0 $ 回以上何度でも行える時、操作を最小何回行えば、$ A $ を回文にすることができますか？

- ある正整数の組 $ (x,y) $ を選ぶ。その後、現在 $ A $ に含まれる $ x $ をすべて $ y $ に置き換える。

なお、この問題では、全ての整数 $ i $ ($ 1\ \le\ i\ \le\ N $) について、$ A_i=A_{N+1-i} $ が成り立つとき、またその時に限って、$ A $ が回文であると言います。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ A_1 $ $ A_2 $ $ \dots $ $ A_N $

## 输出格式

答えを整数として出力せよ。

## 说明/提示

### 制約

- 入力は全て整数
- $ 1\ \le\ N\ \le\ 2\ \times\ 10^5 $
- $ 1\ \le\ A_i\ \le\ 2\ \times\ 10^5 $

### Sample Explanation 1

\- はじめ、$ A=(1,5,3,2,5,2,3,1) $ です。 - $ A $ に含まれる $ 3 $ を全て $ 2 $ に置き換えると、$ A=(1,5,2,2,5,2,2,1) $ となります。 - $ A $ に含まれる $ 2 $ を全て $ 5 $ に置き換えると、$ A=(1,5,5,5,5,5,5,1) $ となります。 以上の操作を行うと、$ A $ を $ 2 $ 回の操作で回文にすることができ、これが最小です。

### Sample Explanation 3

$ A $ がはじめから回文である可能性もあります。

## 样例 #1

### 输入

```
8

1 5 3 2 5 2 3 1
```

### 输出

```
2
```

## 样例 #2

### 输入

```
7

1 2 3 4 1 2 3
```

### 输出

```
1
```

## 样例 #3

### 输入

```
1

200000
```

### 输出

```
0
```



---

---
title: "[ABC211D] Number of Shortest paths"
layout: "post"
diff: 普及/提高-
pid: AT_abc211_d
tag: []
---

# [ABC211D] Number of Shortest paths

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc211/tasks/abc211_d

AtCoder 国には $ 1 $ から $ N $ の番号がついた $ N $ 個の都市と、$ 1 $ から $ M $ の番号がついた $ M $ 個の道路があります。

道路 $ i $ を通ると都市 $ A_i $ と都市 $ B_i $ の間を双方向に $ 1 $ 時間で移動することができます。

都市 $ 1 $ から都市 $ N $ へ最も早く移動することができる経路は何通りありますか？  
 答えは非常に大きくなる可能性があるので $ (10^9+7) $ で割ったあまりを求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ M $ $ A_1 $ $ B_1 $ $ \vdots $ $ A_M $ $ B_M $

## 输出格式

答えを出力せよ。  
 都市 $ 1 $ から都市 $ N $ へ移動することが出来ない場合は $ 0 $ と出力せよ。

## 说明/提示

### 制約

- $ 2\ \leq\ N\ \leq\ 2\times\ 10^5 $
- $ 0\ \leq\ M\ \leq\ 2\times\ 10^5 $
- $ 1\ \leq\ A_i\ <\ B_i\ \leq\ N $
- $ (A_i,B_i) $ は相異なる
- 入力に含まれる値は全て整数である

### Sample Explanation 1

都市 $ 1 $ から都市 $ 4 $ へは最短 $ 2 $ 時間で移動することができ、それを実現する経路は $ 1\ \to\ 2\ \to\ 4 $ と $ 1\ \to\ 3\ \to\ 4 $ の $ 2 $ つです。

### Sample Explanation 2

都市 $ 1 $ から都市 $ 4 $ へは最短 $ 3 $ 時間で移動することができ、それを実現する経路は $ 1\ \to\ 3\ \to\ 2\ \to\ 4 $ の $ 1 $ つです。

### Sample Explanation 3

都市 $ 1 $ から都市 $ 2 $ に移動することはできません。この場合 $ 0 $ を出力してください。

## 样例 #1

### 输入

```
4 5

2 4

1 2

2 3

1 3

3 4
```

### 输出

```
2
```

## 样例 #2

### 输入

```
4 3

1 3

2 3

2 4
```

### 输出

```
1
```

## 样例 #3

### 输入

```
2 0
```

### 输出

```
0
```

## 样例 #4

### 输入

```
7 8

1 3

1 4

2 3

2 4

2 5

2 6

5 7

6 7
```

### 输出

```
4
```



---

---
title: "[ABC212D] Querying Multiset"
layout: "post"
diff: 普及/提高-
pid: AT_abc212_d
tag: []
---

# [ABC212D] Querying Multiset

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc212/tasks/abc212_d

高橋君は何も書かれていないたくさんのボールと $ 1 $ つの袋を持っています。 最初、袋は空で、高橋君は $ Q $ 回の操作を行います。 それぞれの操作は以下の $ 3 $ 種類のうちのいずれかです。

- 操作 $ 1 $ : まだ何も書かれていないボール $ 1 $ つに整数 $ X_i $ を書き込み、袋に入れる。
- 操作 $ 2 $ : 袋に入っているすべてのボールについて、そこに書かれている数を、それに $ X_i $ を加えたものに書き換える。
- 操作 $ 3 $ : 袋に入っているボールのうち書かれている数が最小のもの（複数ある場合はそのうちの $ 1 $ つ）を取り出し、そこに書かれている数を記録する。その後、そのボールを捨てる。

$ 1\leq\ i\leq\ Q $ について $ i $ 回目の操作の種類 $ P_i $ および操作 $ 1 $ , $ 2 $ における $ X_i $ の値が与えられるので、操作 $ 3 $ において記録された数を順に出力してください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ Q $ $ query_1 $ $ query_2 $ $ : $ $ query_Q $

$ 2 $ 行目から $ Q+1 $ 行目の各 $ query_i $ は次のいずれかの形で与えられる。

> $ 1 $ $ X_i $

> $ 2 $ $ X_i $

> $ 3 $

まず、$ 1\leq\ P_i\leq\ 3 $ が与えられる。これは操作の種類を表す。 $ P_i=1 $ または $ P_i=2 $ ならば、その後に空白区切りで $ X_i $ が与えられる。

## 输出格式

$ Q $ 回の操作のうち操作の種類が $ P_i=3 $ であるような各操作について、記録された数を改行区切りで出力せよ。

## 说明/提示

### 制約

- $ 1\ \leq\ Q\ \leq\ 2\times\ 10^5 $
- $ 1\ \leq\ P_i\ \leq\ 3 $
- $ 1\ \leq\ X_i\ \leq\ 10^9 $
- 入力は全て整数である。
- $ P_i=3 $ であるような $ i $ が $ 1 $ つ以上存在する。
- $ P_i=3 $ であるとき、 $ i $ 回目の操作の直前の時点で、袋には $ 1 $ つ以上のボールが入っている。

### Sample Explanation 1

高橋君は次のように操作を行います。 - $ 3 $ の書かれたボールを袋に入れる。 - $ 5 $ の書かれたボールを袋に入れる。 - 今、袋には $ 3 $ の書かれたボールと $ 5 $ の書かれたボールが入っているため、このうち小さい $ 3 $ の書かれたボールを取り出し、 $ 3 $ を記録した後に捨てる。 - 今、袋には $ 5 $ の書かれたボールのみが入っているため、この数を $ 5+2=7 $ に書き換える。 - 今、袋には $ 7 $ の書かれたボールのみが入っているため、このボールを取り出し、 $ 7 $ を記録した後に捨てる。 よって、記録された順に $ 3 $ , $ 7 $ を出力します。

### Sample Explanation 2

答えが $ 32 $ bit整数に収まらないことがある事に注意してください。

## 样例 #1

### 输入

```
5

1 3

1 5

3

2 2

3
```

### 输出

```
3

7
```

## 样例 #2

### 输入

```
6

1 1000000000

2 1000000000

2 1000000000

2 1000000000

2 1000000000

3
```

### 输出

```
5000000000
```



---

---
title: "[ABC213D] Takahashi Tour"
layout: "post"
diff: 普及/提高-
pid: AT_abc213_d
tag: []
---

# [ABC213D] Takahashi Tour

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc213/tasks/abc213_d

AtCoder 国には $ 1 $ から $ N $ の番号がついた $ N $ 個の都市と、$ 1 $ から $ N-1 $ の番号がついた $ N-1 $ 個の道路があります。  
 道路 $ i $ を通ると都市 $ A_i $ と都市 $ B_i $ の間を相互に移動することができます。全ての都市は道路を使って互いに行き来できることが保証されます。

高橋くんは都市 $ 1 $ を出発し、次のルールで旅をします。

- いまいる都市と道路で直接つながっている都市のうち、まだ訪れたことがない都市が存在するとき、そのような都市のうち番号が最も小さい都市へ移動する
- そのような都市が存在しないとき
  - いまいる都市が都市 $ 1 $ なら旅を終了する
  - そうでないなら、いまいる都市を初めて訪れたときに直前にいた都市へ移動する

高橋くんが旅の過程で訪れる都市を順に答えてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ A_1 $ $ B_1 $ $ \vdots $ $ A_{N-1} $ $ B_{N-1} $

## 输出格式

高橋くんが訪れる都市を、旅の開始時及び終了時の都市 $ 1 $ も含めて順に空白区切りで出力せよ。

## 说明/提示

### 制約

- $ 2\ \leq\ N\ \leq\ 2\times\ 10^5 $
- $ 1\leq\ A_i,B_i\ \leq\ N $
- 全ての都市は道路を使って互いに行き来できる

### Sample Explanation 1

高橋くんの旅は次のようになります。 - 最初都市 $ 1 $ にいます。 - 都市 $ 1 $ から道路で直接つながっている都市のうち未訪問なのは都市 $ 2,3 $ です。番号が小さい都市 $ 2 $ へ移動します。 - 都市 $ 2 $ から道路で直接つながっている都市のうち未訪問なのは都市 $ 4 $ です。都市 $ 4 $ へ移動します。 - 都市 $ 4 $ から道路で直接つながっている都市のうち未訪問の都市はありません。直前にいた都市 $ 2 $ へ移動します。 - 都市 $ 2 $ から道路で直接つながっている都市のうち未訪問の都市はありません。初めて都市 $ 2 $ に来る直前にいた都市 $ 1 $ へ移動します。 - 都市 $ 1 $ から道路で直接つながっている都市のうち未訪問なのは都市 $ 3 $ です。都市 $ 3 $ へ移動します。 - 都市 $ 3 $ から道路で直接つながっている都市のうち未訪問の都市はありません。直前にいた都市 $ 1 $ へ移動します。 - 都市 $ 1 $ から道路で直接つながっている都市のうち未訪問の都市はありません。旅を終了します。

## 样例 #1

### 输入

```
4

1 2

4 2

3 1
```

### 输出

```
1 2 4 2 1 3 1
```

## 样例 #2

### 输入

```
5

1 2

1 3

1 4

1 5
```

### 输出

```
1 2 1 3 1 4 1 5 1
```



---

---
title: "[ABC215D] Coprime 2"
layout: "post"
diff: 普及/提高-
pid: AT_abc215_d
tag: []
---

# [ABC215D] Coprime 2

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc215/tasks/abc215_d

長さ $ N $ の正整数列 $ A=(A_1,A_2,\dots,A_N) $ が与えられるので、以下の条件を満たす $ 1 $ 以上 $ M $ 以下の整数 $ k $ を全て求めてください。

- 全ての $ 1\ \le\ i\ \le\ N $ を満たす整数 $ i $ について、 $ \gcd(A_i,k)=1 $ である。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ M $ $ A_1 $ $ A_2 $ $ \dots $ $ A_N $

## 输出格式

$ 1 $ 行目に、出力する整数の数 $ x $ を出力せよ。  
 続く $ x $ 行に、答えとなる整数を小さい方から順に $ 1 $ 行に $ 1 $ つずつ出力せよ。

## 说明/提示

### 制約

- 入力は全て整数
- $ 1\ \le\ N,M\ \le\ 10^5 $
- $ 1\ \le\ A_i\ \le\ 10^5 $

### Sample Explanation 1

例えば、 $ 7 $ は $ \gcd(6,7)=1,\gcd(1,7)=1,\gcd(5,7)=1 $ を満たすので答えとなる整数の集合に含まれます。 一方、 $ 9 $ は $ \gcd(6,9)=3 $ となるため、答えとなる整数の集合に含まれません。 条件を満たす $ 1 $ 以上 $ 12 $ 以下の整数は $ 1,7,11 $ の $ 3 $ つです。これらを小さい方から出力することに注意してください。

## 样例 #1

### 输入

```
3 12

6 1 5
```

### 输出

```
3

1

7

11
```



---

---
title: "[ABC216D] Pair of Balls"
layout: "post"
diff: 普及/提高-
pid: AT_abc216_d
tag: []
---

# [ABC216D] Pair of Balls

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc216/tasks/abc216_d

$ 2N $ 個のボールがあります。各ボールには $ 1 $ 以上 $ N $ 以下の整数によって表される色が塗られており、各色で塗られたボールはちょうど $ 2 $ 個ずつ存在します。

これらのボールが、底が地面と平行になるように置かれた $ M $ 本の筒に入れられています。はじめ、$ i\ (1\ \leq\ i\ \leq\ M) $ 本目の筒には $ k_i $ 個のボールが入っており、上から $ j\ (1\ \leq\ j\ \leq\ k_i) $ 番目のボールの色は $ a_{i,\ j} $ です。

あなたの目標は、以下の操作を繰り返すことで $ M $ 本の筒全てを空にすることです。

- 異なる $ 2 $ 本の空でない筒を選び、それぞれの筒の一番上にあるボールを取り出して捨てる。ここで、取り出して捨てた $ 2 $ つのボールは同じ色で塗られている必要がある。

目標が達成可能かを判定してください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ M $ $ k_1 $ $ a_{1,1} $ $ a_{1,2} $ $ \ldots $ $ a_{1,k_1} $ $ k_2 $ $ a_{2,1} $ $ a_{2,2} $ $ \ldots $ $ a_{2,k_2} $ $ \hspace{2.1cm}\vdots $ $ k_M $ $ a_{M,1} $ $ a_{M,2} $ $ \ldots $ $ a_{M,k_M} $

## 输出格式

目標が達成可能なら `Yes` を、達成不可能なら `No` を出力せよ。

## 说明/提示

### 制約

- $ 1\ \leq\ N\ \leq\ 2\ \times\ 10^5 $
- $ 2\ \leq\ M\ \leq\ 2\ \times\ 10^5 $
- $ 1\ \leq\ k_i\ (1\ \leq\ i\ \leq\ M) $
- $ 1\ \leq\ a_{i,j}\ \leq\ N\ (1\ \leq\ i\ \leq\ M,1\ \leq\ j\ \leq\ k_i) $
- $ \sum_{i=1}^{M}\ k_i\ =\ 2N $
- 全ての $ x\ (1\ \leq\ x\ \leq\ N) $ について、$ 1\ \leq\ i\ \leq\ M $ かつ $ 1\ \leq\ j\ \leq\ k_i $ かつ $ a_{i,j}=x $ なる整数の組 $ (i,j) $ はちょうど $ 2 $ つ存在する
- 入力は全て整数

### Sample Explanation 1

以下のように操作を行えばよいです。 1. $ 1 $ つ目の筒と $ 2 $ つ目の筒を選び、それぞれの筒の一番上にあるボールを取り出して捨てる。捨てられるボールの色は共に $ 1 $ であり等しいので、この操作は有効である。 2. $ 1 $ つ目の筒と $ 2 $ つ目の筒を選び、それぞれの筒の一番上にあるボールを取り出して捨てる。捨てられるボールの色は共に $ 2 $ であり等しいので、この操作は有効である。

### Sample Explanation 2

そもそも一度も操作を行うことができないため、目標を達成する、すなわち $ M $ 本の筒全てを空にすることは不可能です。

## 样例 #1

### 输入

```
2 2

2

1 2

2

1 2
```

### 输出

```
Yes
```

## 样例 #2

### 输入

```
2 2

2

1 2

2

2 1
```

### 输出

```
No
```



---

---
title: "[ABC216E] Amusement Park"
layout: "post"
diff: 普及/提高-
pid: AT_abc216_e
tag: []
---

# [ABC216E] Amusement Park

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc216/tasks/abc216_e

髙橋君は遊園地に遊びに行きました。  
 この遊園地には $ N $ 個のアトラクションがあり、$ i $ 個目のアトラクションの「楽しさ」の初期値は $ A_i $ です。

髙橋君が $ i $ 個目のアトラクションに乗ると、以下の現象が順番に起きます。

- 髙橋君の「満足度」に、$ i $ 個目のアトラクションの現在の「楽しさ」が加算される。
- $ i $ 個目のアトラクションの「楽しさ」が、$ 1 $ 減少する。

髙橋君の「満足度」の初期値は $ 0 $ です。髙橋君はアトラクションに合計 $ K $ 回まで乗ることができます。  
 最終的な髙橋君の「満足度」の最大値はいくつですか？

なお、髙橋君の「満足度」はアトラクションに乗ること以外で変化しません。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ K $ $ A_1 $ $ A_2 $ $ \dots $ $ A_N $

## 输出格式

最終的な髙橋君の「満足度」の最大値を出力せよ。

## 说明/提示

### 制約

- $ 1\ \leq\ N\ \leq\ 10^5 $
- $ 1\ \leq\ K\ \leq\ 2\ \times\ 10^9 $
- $ 1\ \leq\ A_i\ \leq\ 2\ \times\ 10^9 $
- 入力は全て整数

### Sample Explanation 1

$ 1 $ 個目のアトラクションに $ 2 $ 回、$ 3 $ 個目のアトラクションに $ 3 $ 回乗ります。 最終的な「満足度」は、$ (100+99)+(102+101+100)=502 $ です。 「満足度」を $ 503 $ 以上にする方法はないので、$ 502 $ が答えになります。

### Sample Explanation 2

アトラクションに乗る合計回数は、$ K $ 回より少なくても構いません。

## 样例 #1

### 输入

```
3 5

100 50 102
```

### 输出

```
502
```

## 样例 #2

### 输入

```
2 2021

2 3
```

### 输出

```
9
```



---

---
title: "[ABC217D] Cutting Woods"
layout: "post"
diff: 普及/提高-
pid: AT_abc217_d
tag: []
---

# [ABC217D] Cutting Woods

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc217/tasks/abc217_d

長さ $ L $ メートルの直線状の木材があります。  
 $ x\ =\ 1,\ 2,\ \dots,\ L\ -\ 1 $ に対して、木材の左端から $ x $ メートルの地点には目印として線 $ x $ が引かれています。

$ Q $ 個のクエリが与えられます。 $ i $ 番目のクエリは数の組 $ (c_i,\ x_i) $ によって表されます。  
 以下の説明に従ってクエリを $ i $ の昇順に処理してください。

- $ c_i\ =\ 1 $ のとき : 線 $ x_i $ がある地点で木材を $ 2 $ つに切る。
- $ c_i\ =\ 2 $ のとき : 線 $ x_i $ を含む木材を選び、その長さを出力する。

ただし $ c_i\ =\ 1,\ 2 $ の両方に対して、線 $ x_i $ はクエリを処理する時点で切られていないことが保証されます。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ L $ $ Q $ $ c_1 $ $ x_1 $ $ c_2 $ $ x_2 $ $ \vdots $ $ c_Q $ $ x_Q $

## 输出格式

$ c_i\ =\ 2 $ を満たすクエリの回数と等しい行数だけ出力せよ。 $ j $ 行目では $ j $ 番目のそのようなクエリに対する答えを出力せよ。

## 说明/提示

### 制約

- $ 1\ \leq\ L\ \leq\ 10^9 $
- $ 1\ \leq\ Q\ \leq\ 2\ \times\ 10^5 $
- $ c_i\ =\ 1,\ 2 $ $ (1\ \leq\ i\ \leq\ Q) $
- $ 1\ \leq\ x_i\ \leq\ L\ -\ 1 $ $ (1\ \leq\ i\ \leq\ Q) $
- 全ての $ i $ $ (1\ \leq\ i\ \leq\ Q) $ に対して次が成り立つ: $ 1\ \leq\ j\ \lt\ i $ かつ $ (c_j,x_j)\ =\ (1,\ x_i) $ を満たす $ j $ は存在しない。
- 入力は全て整数である。

### Sample Explanation 1

$ 1 $ 番目のクエリ時点では木材は一度も切られていないので、線 $ 2 $ を含む木材の長さは $ 5 $ メートルです。よって $ 5 $ を出力します。 $ 2 $ 番目のクエリによって、木材は $ 3 $ メートルの木材と $ 2 $ メートルの木材に分割されます。 $ 3 $ 番目のクエリ時点では 線 $ 2 $ を含む木材の長さは $ 3 $ メートルなので、$ 3 $ を出力します。

## 样例 #1

### 输入

```
5 3

2 2

1 3

2 2
```

### 输出

```
5

3
```

## 样例 #2

### 输入

```
5 3

1 2

1 4

2 3
```

### 输出

```
2
```

## 样例 #3

### 输入

```
100 10

1 31

2 41

1 59

2 26

1 53

2 58

1 97

2 93

1 23

2 84
```

### 输出

```
69

31

6

38

38
```



---

---
title: "[ABC217E] Sorting Queries"
layout: "post"
diff: 普及/提高-
pid: AT_abc217_e
tag: []
---

# [ABC217E] Sorting Queries

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc217/tasks/abc217_e

空の列 $ A $ があります。クエリが $ Q $ 個与えられるので、与えられた順番に処理してください。  
 クエリは次の $ 3 $ 種類のいずれかです。

- `1 x` : $ A $ の最後尾に $ x $ を追加する。
- `2` : $ A $ の最初の要素を出力する。その後、その要素を削除する。このクエリが与えられるとき、$ A $ は空でないことが保証される。
- `3` : $ A $ を昇順にソートする。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ Q $ $ \mathrm{query}\ 1 $ $ \mathrm{query}\ 2 $ $ \vdots $ $ \mathrm{query}\ Q $

$ i $ 番目のクエリ $ \mathrm{query}\ i $ では、まずクエリの種類 $ c_i $（ $ 1,\ 2,\ 3 $ のいずれか）が与えられる。 $ c_i\ =\ 1 $ の場合はさらに整数 $ x $ が追加で与えられる。

すなわち、各クエリは以下に示す $ 3 $ つの形式のいずれかである。

> $ 1 $ $ x $

> $ 2 $

> $ 3 $

## 输出格式

$ c_i\ =\ 2 $ を満たすクエリの回数を $ q $ として $ q $ 行出力せよ。  
 $ j $ $ (1\ \leq\ j\ \leq\ q) $ 行目では $ j $ 番目のそのようなクエリに対する答えを出力せよ。

## 说明/提示

### 制約

- $ 1\ \leq\ Q\ \leq\ 2\ \times\ 10^5 $
- $ 0\ \leq\ x\ \leq\ 10^9 $
- クエリ `2` が与えられるとき、$ A $ は空でない。
- 入力は全て整数である。

### Sample Explanation 1

入力例 $ 1 $ において、 $ i $ 番目のクエリを処理した後の $ A $ の状態を $ i $ 行目に示すと以下のようになります。 - $ (4) $ - $ (4,\ 3) $ - $ (4,\ 3,\ 2) $ - $ (4,\ 3,\ 2,\ 1) $ - $ (1,\ 2,\ 3,\ 4) $ - $ (2,\ 3,\ 4) $ - $ (2,\ 3,\ 4,\ 0) $ - $ (3,\ 4,\ 0) $

### Sample Explanation 2

入力例 $ 2 $ において、 $ i $ 番目のクエリを処理した後の $ A $ の状態を $ i $ 行目に示すと以下のようになります。 - $ (5) $ - $ (5,\ 5) $ - $ (5,\ 5,\ 3) $ - $ (5,\ 3) $ - $ (3,\ 5) $ - $ (5) $ - $ (5,\ 6) $ - $ (5,\ 6) $ - $ (6) $

## 样例 #1

### 输入

```
8

1 4

1 3

1 2

1 1

3

2

1 0

2
```

### 输出

```
1

2
```

## 样例 #2

### 输入

```
9

1 5

1 5

1 3

2

3

2

1 6

3

2
```

### 输出

```
5

3

5
```



---

---
title: "[ABC218C] Shapes"
layout: "post"
diff: 普及/提高-
pid: AT_abc218_c
tag: []
---

# [ABC218C] Shapes

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc218/tasks/abc218_c

$ 2 $ 次元グリッド上に $ 2 $ つの図形 $ S $ と $ T $ があります。グリッドは正方形のマスからなります。

$ S $ は $ N $ 行 $ N $ 列のグリッド内にあり、$ S_{i,j} $ が `#` であるようなマス全体からなります。  
 $ T $ も $ N $ 行 $ N $ 列のグリッド内にあり、$ T_{i,j} $ が `#` であるようなマス全体からなります。

$ S $ と $ T $ を $ 90 $ 度回転及び平行移動の繰り返しによって一致させることができるか判定してください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ S_{1,1}S_{1,2}\ldots\ S_{1,N} $ $ \vdots $ $ S_{N,1}S_{N,2}\ldots\ S_{N,N} $ $ T_{1,1}T_{1,2}\ldots\ T_{1,N} $ $ \vdots $ $ T_{N,1}T_{N,2}\ldots\ T_{N,N} $

## 输出格式

$ S $ と $ T $ を$ 90 $ 度回転及び平行移動の繰り返しによって一致させることができるとき `Yes` を、そうでないとき `No` を出力せよ。

## 说明/提示

### 制約

- $ 1\ \leq\ N\ \leq\ 200 $
- $ S,T $ は `#` と `.` のみからなる
- $ S,T $ は $ 1 $ つ以上 `#` を含む

### Sample Explanation 1

$ S $ を左回りに $ 90 $ 度回転させ、平行移動することで $ T $ に一致させることができます。

### Sample Explanation 2

$ 90 $ 度回転と平行移動の繰り返しによって一致させることはできません。

### Sample Explanation 3

$ S $ 及び $ T $ は連結とは限りません。

### Sample Explanation 4

回転や移動の操作は連結成分ごとにできるわけではなく、$ S,T $ 全体に対して行うことに注意してください。

## 样例 #1

### 输入

```
5

.....

..#..

.###.

.....

.....

.....

.....

....#

...##

....#
```

### 输出

```
Yes
```

## 样例 #2

### 输入

```
5

#####

##..#

#..##

#####

.....

#####

#..##

##..#

#####

.....
```

### 输出

```
No
```

## 样例 #3

### 输入

```
4

#...

..#.

..#.

....

#...

#...

..#.

....
```

### 输出

```
Yes
```

## 样例 #4

### 输入

```
4

#...

.##.

..#.

....

##..

#...

..#.

....
```

### 输出

```
No
```



---

---
title: "[ABC218D] Rectangles"
layout: "post"
diff: 普及/提高-
pid: AT_abc218_d
tag: []
---

# [ABC218D] Rectangles

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc218/tasks/abc218_d

$ 2 $ 次元平面上に $ N $ 個の相異なる点があり、$ 1,2,\ldots\ ,N $ の番号がついています。点 $ i\,(1\ \leq\ i\ \leq\ N) $ の座標は $ (x_i,y_i) $ です。

これらの点のうち $ 4 $ つを頂点とし、全ての辺が $ x $ 軸または $ y $ 軸に平行であるような長方形はいくつありますか？

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ x_1 $ $ y_1 $ $ x_2 $ $ y_2 $ $ \vdots $ $ x_N $ $ y_N $

## 输出格式

答えを出力せよ。

## 说明/提示

### 制約

- $ 4\ \leq\ N\ \leq\ 2000 $
- $ 0\ \leq\ x_i,\ y_i\ \leq\ 10^9 $
- $ (x_i,y_i)\ \neq\ (x_j,y_j) $ $ (i\ \neq\ j) $
- 入力は全て整数である。

### Sample Explanation 1

点 $ 1 $ 、点 $ 2 $ 、点 $ 3 $ 、点 $ 4 $ を頂点とする長方形、 点 $ 1 $ 、点 $ 2 $ 、点 $ 5 $ 、点 $ 6 $ を頂点とする長方形、 点 $ 3 $ 、点 $ 4 $ 、点 $ 5 $ 、点 $ 6 $ を頂点とする長方形 の合計 $ 3 $ つです。

## 样例 #1

### 输入

```
6

0 0

0 1

1 0

1 1

2 0

2 1
```

### 输出

```
3
```

## 样例 #2

### 输入

```
4

0 1

1 2

2 3

3 4
```

### 输出

```
0
```

## 样例 #3

### 输入

```
7

0 1

1 0

2 0

2 1

2 2

3 0

3 2
```

### 输出

```
1
```



---

---
title: "[ABC218E] Destruction"
layout: "post"
diff: 普及/提高-
pid: AT_abc218_e
tag: []
---

# [ABC218E] Destruction

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc218/tasks/abc218_e

$ N $ 頂点 $ M $ 辺の連結無向グラフがあります。  
 頂点には $ 1 $ から $ N $ の番号が、辺には $ 1 $ から $ M $ の番号がついており、辺 $ i $ は頂点 $ A_i $ と $ B_i $ を結んでいます。

高橋君は、このグラフから $ 0 $ 個以上の辺を取り除こうとしています。

辺 $ i $ を取り除くと、$ C_i\ \geq\ 0 $ のとき $ C_i $ の報酬を得、$ C_i\ <\ 0 $ のとき $ |C_i| $ の罰金を払います。

辺を取り除いたあともグラフが連結でなければならないとき、高橋君が得られる報酬の最大値を求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ M $ $ A_1 $ $ B_1 $ $ C_1 $ $ A_2 $ $ B_2 $ $ C_2 $ $ \vdots $ $ A_M $ $ B_M $ $ C_M $

## 输出格式

答えを出力せよ。

## 说明/提示

### 制約

- $ 2\ \leq\ N\ \leq\ 2\times\ 10^5 $
- $ N-1\ \leq\ M\ \leq\ 2\times\ 10^5 $
- $ 1\ \leq\ A_i,B_i\ \leq\ N $
- $ -10^9\ \leq\ C_i\ \leq\ 10^9 $
- 与えられるグラフは連結である
- 入力に含まれる値は全て整数である

### Sample Explanation 1

辺 $ 4,5 $ を取り除くことで合計 $ 4 $ の報酬を得られます。これより多くの報酬を得ることはできないため、答えは $ 4 $ となります。

### Sample Explanation 2

報酬が負であるような辺が存在することもあります。

### Sample Explanation 3

多重辺や自己ループが存在することもあります。

## 样例 #1

### 输入

```
4 5

1 2 1

1 3 1

1 4 1

3 2 2

4 2 2
```

### 输出

```
4
```

## 样例 #2

### 输入

```
3 3

1 2 1

2 3 0

3 1 -1
```

### 输出

```
1
```

## 样例 #3

### 输入

```
2 3

1 2 -1

1 2 2

1 1 3
```

### 输出

```
5
```



---

---
title: "[ABC219D] Strange Lunchbox"
layout: "post"
diff: 普及/提高-
pid: AT_abc219_d
tag: []
---

# [ABC219D] Strange Lunchbox

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc219/tasks/abc219_d

$ N $ 種類の弁当が、それぞれ $ 1 $ 個ずつ売られています。  
 $ i\ =\ 1,\ 2,\ \ldots,\ N $ について、$ i $ 種類目の弁当には $ A_i $ 個のたこ焼きと $ B_i $ 個のたい焼きが入っています。

高橋君は、 $ X $ 個以上のたこ焼きと $ Y $ 個以上のたい焼きを食べたいです。  
 高橋君がいくつかの弁当を選んで買うことで、 $ X $ 個以上のたこ焼きと $ Y $ 個以上のたい焼きを手に入れることが可能かどうか判定して下さい。また、可能な場合はそのために高橋君が購入しなければならない弁当の個数の最小値を求めて下さい。

各種類の弁当は $ 1 $ 個しか売られていないため、同じ種類の弁当を $ 2 $ 個以上購入することは出来ないことに注意して下さい。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ X $ $ Y $ $ A_1 $ $ B_1 $ $ A_2 $ $ B_2 $ $ \vdots $ $ A_N $ $ B_N $

## 输出格式

高橋君が $ X $ 個以上のたこ焼きと $ Y $ 個以上のたい焼きを手に入れることが不可能な場合は $ -1 $ を出力し、 可能な場合はそのために高橋君が購入しなければならない弁当の個数の最小値を出力せよ。

## 说明/提示

### 制約

- $ 1\ \leq\ N\ \leq\ 300 $
- $ 1\ \leq\ X,\ Y\ \leq\ 300 $
- $ 1\ \leq\ A_i,\ B_i\ \leq\ 300 $
- 入力はすべて整数

### Sample Explanation 1

高橋君は、$ 5 $ 個以上のたこ焼きと $ 6 $ 個以上のたい焼きを食べたいです。 高橋君は $ 2 $ 種類目の弁当と $ 3 $ 種類目の弁当を買うことで、 たこ焼きを $ 3\ +\ 2\ =\ 5 $ 個、たい焼きを $ 4\ +\ 3\ =\ 7 $ 個手に入れることができます。

### Sample Explanation 2

高橋君がたとえすべての弁当を買ったとしても、高橋君は $ 8 $ 個以上のたこ焼きと $ 8 $ 個以上のたい焼きを手に入れることが出来ません。 よって、$ -1 $ を出力します。

## 样例 #1

### 输入

```
3

5 6

2 1

3 4

2 3
```

### 输出

```
2
```

## 样例 #2

### 输入

```
3

8 8

3 4

2 3

2 1
```

### 输出

```
-1
```



---

---
title: "[ABC221D] Online games"
layout: "post"
diff: 普及/提高-
pid: AT_abc221_d
tag: []
---

# [ABC221D] Online games

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc221/tasks/abc221_d

あるオンラインゲームがあり、 $ N $ 人のプレイヤーが登録しています。  
 サービス開始日から $ 10^{100} $ 日を迎えた今日、 開発者である高橋君がログイン履歴を調べたところ、 $ i $ 番目のプレイヤーはサービス開始日を $ 1 $ 日目として、 $ A_i $ 日目から $ B_i $ 日間連続でログインし、 それ以外の日はログインしていなかったことが判明しました。 すなわち、$ i $ 番目のプレイヤーはサービス開始日から、$ A_i $ , $ A_i+1 $ , $ \ldots $ , $ A_i+B_i-1 $ 日目に、 かつそれらの日にのみログインしていたことが分かりました。  
 $ 1\leq\ k\leq\ N $ をみたす各整数 $ k $ について、 サービス開始日から今日までの間で、ちょうど $ k $ 人がログインしていた日数を答えてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ A_1 $ $ B_1 $ $ A_2 $ $ B_2 $ $ : $ $ A_N $ $ B_N $

## 输出格式

次のように空白区切りで $ N $ 個の整数を出力せよ。

> $ D_1 $ $ D_2 $ $ \cdots $ $ D_N $

ただし、 $ D_i $ はちょうど $ i $ 人がゲームにログインしていた日数を表す。

## 说明/提示

### 制約

- $ 1\ \leq\ N\ \leq\ 2\times\ 10^5 $
- $ 1\ \leq\ A_i\ \leq\ 10^9 $
- $ 1\ \leq\ B_i\ \leq\ 10^9 $
- 入力は全て整数である。

### Sample Explanation 1

$ 1 $ 番目のプレイヤーは $ 1 $ 日目と $ 2 $ 日目に、 $ 2 $ 番目のプレイヤーは $ 2 $ 日目と $ 3 $ 日目と $ 4 $ 日目に、 $ 3 $ 番目のプレイヤーは $ 3 $ 日目だけにログインしています。 よって、$ 1 $, $ 4 $ 日目には $ 1 $ 人が、$ 2 $, $ 3 $ 日目には $ 2 $ 人がログインしており、 それ以外の日は誰もログインしていない事が分かります。 答えはちょうど $ 1 $ 人がログインした日数が $ 2 $ 日、 ちょうど $ 2 $ 人がログインした日数が $ 2 $ 日、 ちょうど $ 3 $ 人がログインした日数が $ 0 $ 日となります。

### Sample Explanation 2

$ 2 $ 人以上のプレイヤーがちょうど同じ期間にログインしていることもあり得ます。

## 样例 #1

### 输入

```
3

1 2

2 3

3 1
```

### 输出

```
2 2 0
```

## 样例 #2

### 输入

```
2

1000000000 1000000000

1000000000 1000000000
```

### 输出

```
0 1000000000
```



---

---
title: "[ABC222D] Between Two Arrays"
layout: "post"
diff: 普及/提高-
pid: AT_abc222_d
tag: []
---

# [ABC222D] Between Two Arrays

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc222/tasks/abc222_d

長さ $ n $ の数列 $ S\ =\ (s_1,\ s_2,\ \dots,\ s_n) $ がすべての $ i $ $ (1\ \leq\ i\ \leq\ n\ -\ 1) $ に対して $ s_i\ \leq\ s_{i+1} $ を満たすとき、かつそのときに限り「数列 $ S $ は広義単調増加である」と呼びます。

広義単調増加な長さ $ N $ の整数列 $ A\ =\ (a_1,\ a_2,\ \dots,\ a_N),\ B\ =\ (b_1,\ b_2,\ \dots,\ b_N) $ が与えられます。  
 このとき、次の条件を満たす広義単調増加な長さ $ N $ の整数列 $ C\ =\ (c_1,\ c_2,\ \dots,\ c_N) $ を考えます。

- すべての $ i $ $ (1\ \leq\ i\ \leq\ N) $ に対して $ a_i\ \leq\ c_i\ \leq\ b_i $ が成り立つ。

整数列 $ C $ としてあり得る数列の個数を $ 998244353 $ で割ったあまりを求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ a_1 $ $ a_2 $ $ \dots $ $ a_N $ $ b_1 $ $ b_2 $ $ \dots $ $ b_N $

## 输出格式

$ C $ としてあり得る数列の個数を $ 998244353 $ で割ったあまりを出力せよ。

## 说明/提示

### 制約

- $ 1\ \leq\ N\ \leq\ 3000 $
- $ 0\ \leq\ a_i\ \leq\ b_i\ \leq\ 3000 $ $ (1\ \leq\ i\ \leq\ N) $
- 整数列 $ A,B $ は広義単調増加である。
- 入力はすべて整数である。

### Sample Explanation 1

$ C $ としてあり得る数列は次の $ 5 $ 個です。 - $ (1,\ 1) $ - $ (1,\ 2) $ - $ (1,\ 3) $ - $ (2,\ 2) $ - $ (2,\ 3) $ 数列 $ (2,\ 1) $ は広義単調増加でないため条件を満たさないことに注意してください。

### Sample Explanation 2

$ C $ としてあり得る数列は次の $ 1 $ 個です。 - $ (2,\ 2,\ 2) $

### Sample Explanation 3

個数を $ 998244353 $ で割ったあまりを求めることに注意してください。

## 样例 #1

### 输入

```
2

1 1

2 3
```

### 输出

```
5
```

## 样例 #2

### 输入

```
3

2 2 2

2 2 2
```

### 输出

```
1
```

## 样例 #3

### 输入

```
10

1 2 3 4 5 6 7 8 9 10

1 4 9 16 25 36 49 64 81 100
```

### 输出

```
978222082
```



---

---
title: "[ABC223D] Restricted Permutation"
layout: "post"
diff: 普及/提高-
pid: AT_abc223_d
tag: []
---

# [ABC223D] Restricted Permutation

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc223/tasks/abc223_d

$ (1,\ 2,\ \dots,\ N) $ を並び替えて得られる数列 $ P $ であって以下の条件を満たすもののうち、辞書順で最小のものを求めてください。

- $ i\ =\ 1,\ \dots,\ M $ に対し、$ P $ において $ A_i $ は $ B_i $ よりも先に現れる。

ただし、そのような $ P $ が存在しない場合は `-1` と出力してください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ M $ $ A_1 $ $ B_1 $ $ \vdots $ $ A_M $ $ B_M $

## 输出格式

答えを出力せよ。

## 说明/提示

### 制約

- $ 2\ \leq\ N\ \leq\ 2\ \times\ 10^5 $
- $ 1\ \leq\ M\ \leq\ 2\ \times\ 10^5 $
- $ 1\ \leq\ A_i,\ B_i\ \leq\ N $
- $ A_i\ \neq\ B_i $
- 入力は全て整数である。

### Sample Explanation 1

条件を満たす $ P $ は $ (2,\ 1,\ 3,\ 4),\ (2,\ 3,\ 1,\ 4),\ (2,\ 3,\ 4,\ 1),\ (3,\ 2,\ 1,\ 4),\ (3,\ 2,\ 4,\ 1) $ の $ 5 $ つです。これらのうち辞書順で最小のものは $ (2,\ 1,\ 3,\ 4) $ です。

### Sample Explanation 2

条件を満たす $ P $ は存在しません。

## 样例 #1

### 输入

```
4 3

2 1

3 4

2 4
```

### 输出

```
2 1 3 4
```

## 样例 #2

### 输入

```
2 3

1 2

1 2

2 1
```

### 输出

```
-1
```



---

---
title: "[ABC225D] Play Train"
layout: "post"
diff: 普及/提高-
pid: AT_abc225_d
tag: []
---

# [ABC225D] Play Train

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc225/tasks/abc225_d

高橋君は電車のおもちゃを連結させたり分離させたりして遊んでいます。  
 電車は $ N $ 個あり、電車 $ 1 $ 、電車 $ 2 $ 、$ \ldots $ 、電車 $ N $ と名前がついています。  
 はじめ電車どうしは連結しておらず全てバラバラです。

クエリが $ Q $ 個与えられるので、与えられた順番に処理してください。  
 クエリは次の $ 3 $ 種類のいずれかです。

- `1 x y` ：電車 $ x $ の後部と、電車 $ y $ の前部を連結させる。  
   以下のことが保証されます。
  
  
  - $ x\ \neq\ y $
  - クエリを処理する直前に、電車 $ x $ の後部と連結している電車は存在しない
  - クエリを処理する直前に、電車 $ y $ の前部と連結している電車は存在しない
  - クエリを処理する直前に、電車 $ x $ と電車 $ y $ は異なる連結成分に属する
- `2 x y` ：電車 $ x $ の後部と、電車 $ y $ の前部を分離させる。  
   以下のことが保証されます。
  
  
  - $ x\ \neq\ y $
  - クエリを処理する直前に、電車 $ x $ の後部と電車 $ y $ の前部は直接連結している
- `3 x` ：電車 $ x $ が含まれる連結成分に属する電車の番号を、**先頭から順番に**全て出力する。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ Q $ $ \mathrm{query}_1 $ $ \mathrm{query}_2 $ $ \vdots $ $ \mathrm{query}_Q $

$ i $ 番目のクエリ $ \mathrm{query}_i $ では、まずクエリの種類 $ c_i $（ $ 1,\ 2,\ 3 $ のいずれか）が与えられる。  
 $ c_i\ =\ 1,2 $ の場合は $ x,y $ が追加で与えられ、$ c_i\ =3 $ の場合は $ x $ が追加で与えられる。

すなわち、各クエリは以下に示す $ 3 $ つの形式のいずれかである。

> $ 1 $ $ x $ $ y $

> $ 2 $ $ x $ $ y $

> $ 3 $ $ x $

## 输出格式

ある $ c_i\ =\ 3 $ のタイプのクエリにおいて、出力すべき値が $ j_1,\ j_2,\ \ldots\ ,\ j_M $ であるとする。  
 このとき以下の形式で $ 1 $ 行に出力せよ。

> $ M $ $ j_1 $ $ j_2 $ $ \ldots $ $ j_M $

$ c_i\ =\ 3 $ のタイプのクエリの数を $ q $ として、$ q $ 行出力せよ。  
 $ k\ (1\ \leq\ k\ \leq\ q) $ 行目では $ k $ 番目のそのようなクエリに対する答えを出力せよ。

## 说明/提示

### 制約

- $ 2\ \leq\ N\ \leq\ 10^5 $
- $ 1\ \leq\ Q\ \leq\ 10^5 $
- $ 1\ \leq\ x\ \leq\ N $
- $ 1\ \leq\ y\ \leq\ N $
- 入力は全て整数
- クエリは全て問題文の条件を満たす
- `3 x` の形式のクエリで出力する電車の番号の個数の合計は $ 10^6 $ 以下

### Sample Explanation 1

$ \mathrm{query}_5 $ まで処理した時、電車は以下のようになっています。 この時、たとえば電車 $ 2 $ は、電車 $ 3,5,6,7 $ と同じ連結成分に属していますが、電車 $ 1,4 $ とは同じ連結成分に属していません。 !\[\](https://img.atcoder.jp/ghi/dbfd2666776e351752bba67e9b65fafa.png) $ \mathrm{query}_{11} $ まで処理した時、電車は以下のようになっています。 !\[\](https://img.atcoder.jp/ghi/dad814ca77ec58f31cb88c62b9825bef.png)

## 样例 #1

### 输入

```
7 14

1 6 3

1 4 1

1 5 2

1 2 7

1 3 5

3 2

3 4

3 6

2 3 5

2 4 1

1 1 5

3 2

3 4

3 6
```

### 输出

```
5 6 3 5 2 7

2 4 1

5 6 3 5 2 7

4 1 5 2 7

1 4

2 6 3
```



---

---
title: "[ABC226D] Teleportation"
layout: "post"
diff: 普及/提高-
pid: AT_abc226_d
tag: []
---

# [ABC226D] Teleportation

## 题目描述

AtCoder国家位于无限多的笛卡尔坐标上。

AtCoder国家有 $N$ 个城镇，编号为 $1,2,...,N$。

镇i位于点$(x_i,y_i)$，没有两个不同编号的镇可以在同一坐标上。
AtCoder国家有过渡魔法 (以下简称魔法）。

魔法由一对整数 $(a,b)$ 标识，如果你在点 $(x,y)$ 并使用魔法 $(a,b)$，你可以穿越到 $(x+a，y+b)$。

有一个伟大的魔术师（以下简称魔法师），他可以选择任何一对整数 $(a,b)$ 并学习魔术 $(a,b)$。 魔法师还可以学习任何数量的不同种类的魔法。

当他想用魔法从一个城市移动到另一个城市时，他决定学习一些魔法，这样他就可以对所有一对 $(i,j)$ 不同的城市进行以下操作。

在你所学的魔法中只选择一种类型的魔法时，就只能重复使用所选的魔法，从城市 $i$ 移动到城市 $j$。

为了满足上述条件，魔法师至少要学会多少种不同的魔法？

## 输入格式

第 1 行输入一个数 $N$.

第 2 行至第 N+1 行每行输入两个数 $x_i,y_i$

## 输出格式

输出大魔法师至少需要学习的魔法数。

## 样例 #1

### 输入

```
3

1 2

3 6

7 4
```

### 输出

```
6
```

## 样例 #2

### 输入

```
3

1 2

2 2

4 2
```

### 输出

```
2
```

## 样例 #3

### 输入

```
4

0 0

0 1000000000

1000000000 0

1000000000 1000000000
```

### 输出

```
8
```



---

---
title: "[ABC227C] ABC conjecture"
layout: "post"
diff: 普及/提高-
pid: AT_abc227_c
tag: []
---

# [ABC227C] ABC conjecture

## 题目描述

给出正整数 $ N $。

求 $ A\leq\ B\leq\ C $ 并且 $ ABC\leq\ N $ 的正整数对 $ (A,B,C) $ 的个数。

注意，在限制的条件下，保证答案小于 $ 2^{63}$。

## 输入格式

输入按以下格式：

> $ N $

## 输出格式

输出答案。

## 说明/提示

条件

- $ 1\ \leq\ N\ \leq\ 10^{11} $
- $ N $是整数

样例解释 $1$：

满足条件的组有 $5$ 组：$(1,1,1),(1,1,2),(1,1,3),(1,1,4),(1,2,2)$。

## 样例 #1

### 输入

```
4
```

### 输出

```
5
```

## 样例 #2

### 输入

```
100
```

### 输出

```
323
```

## 样例 #3

### 输入

```
100000000000
```

### 输出

```
5745290566750
```



---

---
title: "[ABC228D] Linear Probing"
layout: "post"
diff: 普及/提高-
pid: AT_abc228_d
tag: []
---

# [ABC228D] Linear Probing

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc228/tasks/abc228_d

$ N\ =\ 2^{20} $ 項からなる数列 $ A\ =\ (A_0,\ A_1,\ \dots,\ A_{N\ -\ 1}) $ があります。はじめ、全ての要素は $ -1 $ です。

$ Q $ 個のクエリを順番に処理してください。$ i\ \,\ (1\ \leq\ i\ \leq\ Q) $ 個目のクエリは $ t_i\ =\ 1 $ または $ t_i\ =\ 2 $ を満たす整数 $ t_i $ および整数 $ x_i $ で表され、内容は以下の通りです。

- $ t_i\ =\ 1 $ のとき、以下の処理を順番に行う。
  1. 整数 $ h $ を $ h\ =\ x_i $ で定める。
  2. $ A_{h\ \bmod\ N}\ \neq\ -1 $ である間、$ h $ の値を $ 1 $ 増やすことを繰り返す。この問題の制約下でこの操作が有限回で終了することは証明できる。
  3. $ A_{h\ \bmod\ N} $ の値を $ x_i $ で書き換える。
- $ t_i\ =\ 2 $ のとき、その時点での $ A_{x_i\ \bmod\ N} $ の値を出力する。

なお、整数 $ a,\ b $ に対し、$ a $ を $ b $ で割った余りを $ a\ \bmod\ b $ と表します。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ Q $ $ t_1 $ $ x_1 $ $ \vdots $ $ t_{Q} $ $ x_{Q} $

## 输出格式

$ t_i\ =\ 2 $ であるようなクエリに対し、それぞれ答えを $ 1 $ 行に出力せよ。そのようなクエリが $ 1 $ つ以上存在することは保証される。

## 说明/提示

### 制約

- $ 1\ \leq\ Q\ \leq\ 2\ \times\ 10^5 $
- $ t_i\ \in\ \{\ 1,\ 2\ \}\ \,\ (1\ \leq\ i\ \leq\ Q) $
- $ 0\ \leq\ x_i\ \leq\ 10^{18}\ \,\ (1\ \leq\ i\ \leq\ Q) $
- $ t_i\ =\ 2 $ であるような $ i\ \,\ (1\ \leq\ i\ \leq\ Q) $ が $ 1 $ つ以上存在する。
- 入力は全て整数である。

### Sample Explanation 1

$ x_1\ \bmod\ N\ =\ 1 $ であるので、$ 1 $ 番目のクエリによって $ A_1\ =\ 1048577 $ となります。 $ 2 $ 番目のクエリにおいて、はじめ $ h\ =\ x_2 $ ですが、$ A_{h\ \bmod\ N}\ =\ A_{1}\ \neq\ -1 $ であるので $ h $ の値を $ 1 $ 増やします。すると $ A_{h\ \bmod\ N}\ =\ A_{2}\ =\ -1 $ となるので、このクエリによって $ A_2\ =\ 1 $ となります。 $ 3 $ 番目のクエリにおいて、$ A_{x_3\ \bmod\ N}\ =\ A_{1}\ =\ 1048577 $ を出力します。 $ 4 $ 番目のクエリにおいて、$ A_{x_4\ \bmod\ N}\ =\ A_{3}\ =\ -1 $ を出力します。 この問題において $ N\ =\ 2^{20}\ =\ 1048576 $ は定数であり、入力では与えられないことに注意してください。

## 样例 #1

### 输入

```
4

1 1048577

1 1

2 2097153

2 3
```

### 输出

```
1048577

-1
```



---

---
title: "[ABC229D] Longest X"
layout: "post"
diff: 普及/提高-
pid: AT_abc229_d
tag: []
---

# [ABC229D] Longest X

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc229/tasks/abc229_d

`X` と `.` からなる文字列 $ S $ が与えられます。

$ S $ に対して、次の操作を $ 0 $ 回以上 $ K $ 回以下行うことができます。

- `.` を `X` に置き換える

操作後に、`X` を最大で何個連続させることができますか？

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ S $ $ K $

## 输出格式

答えを出力せよ。

## 说明/提示

### 制約

- $ 1\ \leq\ |S|\ \leq\ 2\ \times\ 10^5 $
- $ S $ の各文字は `X` または `.` である
- $ 0\ \leq\ K\ \leq\ 2\ \times\ 10^5 $
- $ K $ は整数である

### Sample Explanation 1

$ S $ の $ 7 $ 文字目と $ 9 $ 文字目の `.` を `X` に置き換えて `XX...XXXXX.` とすると、$ 6 $ 文字目から $ 10 $ 文字目で `X` が $ 5 $ 個連続しています。 `X` を $ 6 $ 個以上連続させることはできないので、答えは $ 5 $ です。

### Sample Explanation 2

操作を行う回数は $ 0 $ 回でも構いません。

## 样例 #1

### 输入

```
XX...X.X.X.

2
```

### 输出

```
5
```

## 样例 #2

### 输入

```
XXXX

200000
```

### 输出

```
4
```



---

---
title: "[ABC229E] Graph Destruction"
layout: "post"
diff: 普及/提高-
pid: AT_abc229_e
tag: []
---

# [ABC229E] Graph Destruction

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc229/tasks/abc229_e

$ N $ 頂点 $ M $ 辺の単純な無向グラフが与えられます。  
 辺 $ i $ は、頂点 $ A_i $ と $ B_i $ を結んでいます。

頂点 $ 1,2,\ldots,N $ を順番に消していきます。  
 なお、頂点 $ i $ を消すとは、頂点 $ i $ と、頂点 $ i $ に接続する全ての辺をグラフから削除することです。

$ i=1,2,\ldots,N $ について、頂点 $ i $ まで消した時にグラフはいくつの連結成分に分かれていますか？

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ M $ $ A_1 $ $ B_1 $ $ A_2 $ $ B_2 $ $ \vdots $ $ A_M $ $ B_M $

## 输出格式

$ N $ 行出力せよ。  
 $ i $ 行目には、頂点 $ i $ まで消した時のグラフの連結成分の数を出力せよ。

## 说明/提示

### 制約

- $ 1\ \leq\ N\ \leq\ 2\ \times\ 10^5 $
- $ 0\ \leq\ M\ \leq\ \min(\frac{N(N-1)}{2}\ ,\ 2\ \times\ 10^5\ ) $
- $ 1\ \leq\ A_i\ \lt\ B_i\ \leq\ N $
- $ i\ \neq\ j $ ならば $ (A_i,B_i)\ \neq\ (A_j,B_j) $
- 入力は全て整数である

### Sample Explanation 1

!\[\](https://img.atcoder.jp/ghi/3320212a9093132a80105bf02feeb195.png) グラフは上図のように変化していきます。

### Sample Explanation 2

はじめからグラフが非連結なこともあります。

## 样例 #1

### 输入

```
6 7

1 2

1 4

1 5

2 4

2 3

3 5

3 6
```

### 输出

```
1

2

3

2

1

0
```

## 样例 #2

### 输入

```
8 7

7 8

3 4

5 6

5 7

5 8

6 7

6 8
```

### 输出

```
3

2

2

1

1

1

1

0
```



---

---
title: "[ABC230D] Destroyer Takahashi"
layout: "post"
diff: 普及/提高-
pid: AT_abc230_d
tag: []
---

# [ABC230D] Destroyer Takahashi

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc230/tasks/abc230_d

$ N $ 行 $ 10^9 $ 列の格子状の区画に区切られた街に $ N $ 枚の壁があり、$ 1 $ から $ N $ までの番号が割り振られています。  
 壁 $ i $ は上から $ i $ 行目、左から $ L_i $ 列目から $ R_i $ 列目の範囲にあります。(入出力例 $ 1 $ の図も参考にしてください。)

高橋君は $ N $ 枚の壁をすべて破壊することにしました。  
 超人的な腕力を持つ高橋君は、$ 1 $ 回のパンチで連続する $ D $ 列にまとめてダメージを与えることができます。

- より厳密に言い換えると、$ 1 $ 以上 $ 10^9\ -\ D\ +\ 1 $ 以下の **整数** $ x $ を選んで、$ x $ 列目から $ x\ +\ D\ -\ 1 $ 列目に (一部でも) 存在するすべての破壊されていない壁にパンチによるダメージを与えることができます。

壁は一部分でもダメージを受けると、パンチの衝撃波により全体が木っ端みじんに破壊されてしまいます。  
 (入出力例 $ 1 $ の説明も参考にしてください。)

高橋君がすべての壁を破壊するには、少なくとも何回のパンチを放つ必要がありますか？

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ D $ $ L_1 $ $ R_1 $ $ L_2 $ $ R_2 $ $ \vdots $ $ L_N $ $ R_N $

## 输出格式

すべての壁を破壊するのに必要なパンチの最少回数を出力せよ。

## 说明/提示

### 制約

- $ 1\ \leq\ N\ \leq\ 2\ \times\ 10^5 $
- $ 1\ \leq\ D\ \leq\ 10^9 $
- $ 1\ \leq\ L_i\ \leq\ R_i\ \leq\ 10^9 $
- 入力はすべて整数である。

### Sample Explanation 1

入力例 $ 1 $ に対応する壁の配置を図示したものが下図です。 !\[image\](https://img.atcoder.jp/ghi/b7b9e6741514f51c6c0aac924589c9d2.png) たとえば次のようにパンチを放つことで、 $ 2 $ 回のパンチですべての壁を破壊することができます。(以下の説明では、$ a $ 列目から $ b $ 列目までの範囲を $ \lbrack\ a,\ b\ \rbrack $ と表記します。) - まず、 $ \lbrack\ 2,\ 4\ \rbrack $ にパンチを放つ。 $ \lbrack\ 2,\ 4\ \rbrack $ に存在する壁である壁 $ 1 $ と壁 $ 2 $ はダメージを受け、破壊される。 - 次に $ \lbrack\ 5,\ 7\rbrack $ にパンチを放つ。$ \lbrack\ 5,\ 7\rbrack $ に存在する壁 $ 3 $ はダメージを受け、破壊される。 また、次の方法でもすべての壁を $ 2 $ 回のパンチで破壊することができます。 - まず、$ \lbrack\ 7,\ 9\ \rbrack $ にパンチを放ち、壁 $ 2 $ と壁 $ 3 $ を破壊する。 - 次に、$ \lbrack\ 1,\ 3\ \rbrack $ にパンチを放ち、壁 $ 1 $ を破壊する。

### Sample Explanation 2

入出力例 $ 1 $ と比べると、壁 $ 3 $ の範囲が $ \lbrack\ 5,\ 9\ \rbrack $ から $ \lbrack\ 4,\ 9\ \rbrack $ に変わりました。 この場合は $ \lbrack\ 2,\ 4\ \rbrack $ にパンチを放つことで $ 1 $ 回ですべての壁を破壊できます。

## 样例 #1

### 输入

```
3 3

1 2

4 7

5 9
```

### 输出

```
2
```

## 样例 #2

### 输入

```
3 3

1 2

4 7

4 9
```

### 输出

```
1
```

## 样例 #3

### 输入

```
5 2

1 100

1 1000000000

101 1000

9982 44353

1000000000 1000000000
```

### 输出

```
3
```



---

---
title: "[ABC230E] Fraction Floor Sum"
layout: "post"
diff: 普及/提高-
pid: AT_abc230_e
tag: []
---

# [ABC230E] Fraction Floor Sum

## 题目描述

求 $\large{\sum\limits_{i=1}^N ⌊\frac{N}{i}⌋}$ 的值

## 输入格式

一行一个整数 $N$

## 输出格式

一行一个整数，你的答案

## 样例 #1

### 输入

```
3
```

### 输出

```
5
```

## 样例 #2

### 输入

```
10000000000
```

### 输出

```
231802823220
```



---

---
title: "[ABC231D] Neighbors"
layout: "post"
diff: 普及/提高-
pid: AT_abc231_d
tag: []
---

# [ABC231D] Neighbors

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc231/tasks/abc231_d

$ 1 $ から $ N $ の番号がついた $ N $ 人を横一列に並べる方法のうち、以下の形式の $ M $ 個の条件全てを満たすものが存在するか判定してください。

- 条件：人 $ A_i $ と人 $ B_i $ は隣り合っている

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ M $ $ A_1 $ $ B_1 $ $ \vdots $ $ A_M $ $ B_M $

## 输出格式

条件を満たす並べ方が存在するなら `Yes`、存在しないなら `No` と出力せよ。

## 说明/提示

### 制約

- $ 2\ \leq\ N\ \leq\ 10^5 $
- $ 0\ \leq\ M\ \leq\ 10^5 $
- $ 1\leq\ A_i\ <\ B_i\ \leq\ N $
- $ (A_i,B_i) $ は相異なる

### Sample Explanation 1

例えば $ 4,1,3,2 $ の順に並べることで全ての条件を満たすことができます。

### Sample Explanation 2

どのように並べても全ての条件を満たすことはできません。

## 样例 #1

### 输入

```
4 2

1 3

2 3
```

### 输出

```
Yes
```

## 样例 #2

### 输入

```
4 3

1 4

2 4

3 4
```

### 输出

```
No
```



---

---
title: "[ABC233D] Count Interval"
layout: "post"
diff: 普及/提高-
pid: AT_abc233_d
tag: []
---

# [ABC233D] Count Interval

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc233/tasks/abc233_d

長さ $ N $ の数列 $ A=(A_1,A_2,\ldots,A_N) $ と、整数 $ K $ が与えられます。

$ A $ の連続部分列のうち、要素の和が $ K $ になるものはいくつありますか？  
 すなわち、以下の条件を全て満たす整数の組 $ (l,r) $ はいくつありますか？

- $ 1\leq\ l\leq\ r\leq\ N $
- $ \displaystyle\sum_{i=l}^{r}A_i\ =\ K $

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ K $ $ A_1 $ $ A_2 $ $ \ldots $ $ A_N $

## 输出格式

答えを出力せよ。

## 说明/提示

### 制約

- $ 1\leq\ N\ \leq\ 2\times\ 10^5 $
- $ |A_i|\ \leq\ 10^9 $
- $ |K|\ \leq\ 10^{15} $
- 入力に含まれる値は全て整数である

### Sample Explanation 1

$ (l,r)=(1,2),(3,3),(2,6) $ の $ 3 $ 組が条件を満たします。

### Sample Explanation 2

条件を満たす $ (l,r) $ の組が $ 1 $ つも存在しないこともあります。

## 样例 #1

### 输入

```
6 5

8 -3 5 7 0 -4
```

### 输出

```
3
```

## 样例 #2

### 输入

```
2 -1000000000000000

1000000000 -1000000000
```

### 输出

```
0
```



---

---
title: "[ABC233E] Σ[k=0..10^100]floor(X／10^k)"
layout: "post"
diff: 普及/提高-
pid: AT_abc233_e
tag: []
---

# [ABC233E] Σ[k=0..10^100]floor(X／10^k)

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc233/tasks/abc233_e

$ \displaystyle\ \sum_{k=0}^{10^{100}}\ \left\ \lfloor\ \frac{X}{10^k}\ \right\ \rfloor $ を求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ X $

## 输出格式

答えを整数として出力せよ。  
 但し、たとえ答えが大きな整数であっても、求める答えを正確に整数として出力する必要がある。たとえば、 `2.33e+21` のような指数表記や、 `0523` のような先頭に不要な $ 0 $ を付けたような表記は許されない。

## 说明/提示

### 注釈

$ \lfloor\ A\ \rfloor $ は、 $ A $ の小数点以下を切り捨てた値を指します。

### 制約

- $ X $ は整数
- $ 1\ \le\ X\ <\ 10^{500000} $

### Sample Explanation 1

求める値は、 $ 1225+122+12+1+0+0+\dots+0=1360 $ となります。

### Sample Explanation 2

繰り上がりに注意してください。

### Sample Explanation 3

入力される値も出力すべき値も非常に大きくなる場合があります。

## 样例 #1

### 输入

```
1225
```

### 输出

```
1360
```

## 样例 #2

### 输入

```
99999
```

### 输出

```
111105
```

## 样例 #3

### 输入

```
314159265358979323846264338327950288419716939937510
```

### 输出

```
349065850398865915384738153697722542688574377708317
```



---

---
title: "[ABC234E] Arithmetic Number"
layout: "post"
diff: 普及/提高-
pid: AT_abc234_e
tag: []
---

# [ABC234E] Arithmetic Number

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc234/tasks/abc234_e

以下の条件を満たす正の整数 $ n $ を、 **等差数** と呼びます。

- ($ n $ を先頭に余計な $ 0 $ を付けずに $ 10 $ 進法で表記した際、) $ n $ の上から $ i $ 桁目を $ d_i $ とする。このとき、 $ n $ が $ k $ 桁の整数であったとすると、 $ (d_2-d_1)=(d_3-d_2)=\dots=(d_k-d_{k-1}) $ が成立する。
  - この条件は、「 数列 $ (d_1,d_2,\dots,d_k) $ が等差数列である」と言い換えることができる。
  - 但し、 $ n $ が $ 1 $ 桁の整数である時、 $ n $ は等差数であるものとする。

たとえば、 $ 234,369,86420,17,95,8,11,777 $ は等差数ですが、 $ 751,919,2022,246810,2356 $ は等差数ではありません。

等差数のうち、 $ X $ 以上で最小のものを求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ X $

## 输出格式

答えを整数として出力せよ。

## 说明/提示

### 制約

- $ X $ は $ 1 $ 以上 $ 10^{17} $ 以下の整数である

### Sample Explanation 1

$ 152 $ 以上で最小の等差数は $ 159 $ です。

### Sample Explanation 2

$ X $ 自身が等差数である場合もあります。

## 样例 #1

### 输入

```
152
```

### 输出

```
159
```

## 样例 #2

### 输入

```
88
```

### 输出

```
88
```

## 样例 #3

### 输入

```
8989898989
```

### 输出

```
9876543210
```



---

---
title: "[ABC235D] Multiply and Rotate"
layout: "post"
diff: 普及/提高-
pid: AT_abc235_d
tag: []
---

# [ABC235D] Multiply and Rotate

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc235/tasks/abc235_d

正の整数 $ a $ があります。また、黒板に $ 1 $ 個の数が $ 10 $ 進表記で書かれています。  
 黒板に現在書かれている数を $ x $ としたとき、高橋君は次のいずれかの操作を行い、黒板に書かれている数を変化させることができます。

- $ x $ を消し、 $ x $ を $ a $ 倍した数を $ 10 $ 進表記で新たに書きこむ。
- $ x $ を文字列とみなして、列の末尾の数字を文字列の先頭に移動させる。  
   ただし、この操作は $ x\ \geq\ 10 $ かつ $ x $ が $ 10 $ で割り切れないときにしか行えない。

たとえば $ a\ =\ 2,\ x\ =\ 123 $ であるとき、高橋君は次のいずれかの操作を行うことができます。

- $ x $ を消して、 $ x\ \times\ a\ =\ 123\ \times\ 2\ =\ 246 $ を新たに書きこむ。
- $ x $ を文字列とみなして、`123` の末尾の数字である `3` を先頭に移動させる。黒板に書かれている数は $ 123 $ から $ 312 $ に変化する。

はじめ、黒板には $ 1 $ が書かれています。書かれている数を $ N $ に変化させるには最小で何回の操作が必要ですか？ただし、どのように操作しても書かれている数を $ N $ に変化させられない場合は $ -1 $ を出力してください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ a $ $ N $

## 输出格式

答えを出力せよ。

## 说明/提示

### 制約

- $ 2\ \leq\ a\ \lt\ 10^6 $
- $ 2\ \leq\ N\ \lt\ 10^6 $
- 入力はすべて整数である。

### Sample Explanation 1

以下に説明する操作を行うことで、 黒板に書かれている数を $ 4 $ 回で $ 1 $ から $ 72 $ に変化させることができます。 - $ 1 $ つ目の操作を行う。黒板に書かれている数は $ 1\ \to\ 3 $ に変わる。 - $ 1 $ つ目の操作を行う。黒板に書かれている数は $ 3\ \to\ 9 $ に変わる。 - $ 1 $ つ目の操作を行う。黒板に書かれている数は $ 9\ \to\ 27 $ に変わる。 - $ 2 $ つ目の操作を行う。黒板に書かれている数は $ 27\ \to\ 72 $ に変わる。 $ 3 $ 回以下の操作で $ 72 $ に変化させることはできないため、答えは $ 4 $ になります。

### Sample Explanation 2

どのように操作しても黒板に書かれている数を $ 5 $ に変化させることはできません。

### Sample Explanation 3

適切に操作を選ぶことで、 $ 1\ \to\ 2\ \to\ 4\ \to\ 8\ \to\ 16\ \to\ 32\ \to\ 64\ \to\ 46\ \to\ 92\ \to\ 29\ \to\ 58\ \to\ 116\ \to\ 611 $ と $ 12 $ 回の操作で黒板に書かれている数を $ 611 $ に変化させることができ、これが最小です。

## 样例 #1

### 输入

```
3 72
```

### 输出

```
4
```

## 样例 #2

### 输入

```
2 5
```

### 输出

```
-1
```

## 样例 #3

### 输入

```
2 611
```

### 输出

```
12
```

## 样例 #4

### 输入

```
2 767090
```

### 输出

```
111
```



---

---
title: "[ABC236D] Dance"
layout: "post"
diff: 普及/提高-
pid: AT_abc236_d
tag: []
---

# [ABC236D] Dance

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc236/tasks/abc236_d

$ 1,\ 2,\ \ldots,\ 2N $ と番号づけられた $ 2N $ 人の人が舞踏会に参加します。 彼らは $ N $ 個の $ 2 $ 人組にわかれてダンスを踊ります。

$ 2 $ 人組を構成する人のうち、番号の小さい方の人が人 $ i $ 、番号の大きい方の人が人 $ j $ のとき、 その $ 2 $ 人組の「相性」は $ A_{i,\ j} $ です。  
 $ N $ 個の $ 2 $ 人組の相性がそれぞれ $ B_1,\ B_2,\ \ldots,\ B_N $ であるとき、 「舞踏会全体の楽しさ」はそれらのビットごとの排他的論理和である $ B_1\ \oplus\ B_2\ \oplus\ \cdots\ \oplus\ B_N $ です。

「 $ 2N $ 人の参加者が $ N $ 個の $ 2 $ 人組に分かれる方法」を自由に選べるとき、「舞踏会全体の楽しさ」としてあり得る最大値を出力してください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ A_{1,\ 2} $ $ A_{1,\ 3} $ $ A_{1,\ 4} $ $ \cdots $ $ A_{1,\ 2N} $ $ A_{2,\ 3} $ $ A_{2,\ 4} $ $ \cdots $ $ A_{2,\ 2N} $ $ A_{3,\ 4} $ $ \cdots $ $ A_{3,\ 2N} $ $ \vdots $ $ A_{2N-1,\ 2N} $

## 输出格式

舞踏会全体の楽しさとしてあり得る最大値を出力せよ。

## 说明/提示

### 制約

- $ 1\ \leq\ N\ \leq\ 8 $
- $ 0\ \leq\ A_{i,\ j}\ <\ 2^{30} $
- 入力はすべて整数

### Sample Explanation 1

人 $ i $ と人 $ j $ からなる $ 2 $ 人組を $ \lbrace\ i,\ j\rbrace $ で表します。 $ 4 $ 人が $ 2 $ 個の $ 2 $ 人組にわかれる方法は下記の $ 3 $ 通りです。 - $ \lbrace\ 1,\ 2\rbrace,\ \lbrace\ 3,\ 4\rbrace $ という $ 2 $ 組にわかれる。 このとき、舞踏会全体の楽しさは $ A_{1,\ 2}\ \oplus\ A_{3,\ 4}\ =\ 4\ \oplus\ 2\ =\ 6 $ です。 - $ \lbrace\ 1,\ 3\rbrace,\ \lbrace\ 2,\ 4\rbrace $ という $ 2 $ 組にわかれる。 このとき、舞踏会全体の楽しさは $ A_{1,\ 3}\ \oplus\ A_{2,\ 4}\ =\ 0\ \oplus\ 3\ =\ 3 $ です。 - $ \lbrace\ 1,\ 4\rbrace,\ \lbrace\ 2,\ 3\rbrace $ という $ 2 $ 組にわかれる。 このとき、舞踏会全体の楽しさは $ A_{1,\ 4}\ \oplus\ A_{2,\ 3}\ =\ 1\ \oplus\ 5\ =\ 4 $ です。 よって、舞踏会全体の楽しさとしてあり得る最大値は $ 6 $ です。

### Sample Explanation 2

人 $ 1 $ と人 $ 2 $ からなる $ 2 $ 人組のみが作られ、このときの舞踏会全体の楽しさは $ 5 $ です。

## 样例 #1

### 输入

```
2

4 0 1

5 3

2
```

### 输出

```
6
```

## 样例 #2

### 输入

```
1

5
```

### 输出

```
5
```

## 样例 #3

### 输入

```
5

900606388 317329110 665451442 1045743214 260775845 726039763 57365372 741277060 944347467

369646735 642395945 599952146 86221147 523579390 591944369 911198494 695097136

138172503 571268336 111747377 595746631 934427285 840101927 757856472

655483844 580613112 445614713 607825444 252585196 725229185

827291247 105489451 58628521 1032791417 152042357

919691140 703307785 100772330 370415195

666350287 691977663 987658020

1039679956 218233643

70938785
```

### 输出

```
1073289207
```



---

---
title: "[ABC237E] Skiing"
layout: "post"
diff: 普及/提高-
pid: AT_abc237_e
tag: []
---

# [ABC237E] Skiing

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc237/tasks/abc237_e

AtCoder スキー場には広場 $ 1 $ 、広場 $ 2 $ 、$ \ldots $ 、広場 $ N $ の $ N $ 個の広場があり、広場 $ i $ の標高は $ H_i $ です。 また、$ 2 $ つの広場を双方向に結ぶ $ M $ 本の坂があり、$ i $ $ (1\ \leq\ i\ \leq\ M) $ 本目の坂は広場 $ U_i $ と広場 $ V_i $ を双方向に結んでいます。どの $ 2 $ つの広場の間もいくつかの坂を使って移動することができます。

高橋君は坂を使うことによってのみ広場の間を移動でき、坂を通るごとに**楽しさ**が変化します。具体的には広場 $ X $ と広場 $ Y $ を直接結ぶ坂を使って広場 $ X $ から広場 $ Y $ まで移動したとき次のように楽しさが変化します。

- 広場 $ X $ が広場 $ Y $ より標高が真に高い場合、その標高差、すなわち $ H_X-H_Y $ だけ楽しさが**増加**する。
- 広場 $ X $ が広場 $ Y $ より標高が真に低い場合、その標高差の $ 2 $ 倍、すなわち $ 2(H_Y-H_X) $ だけ楽しさが**減少**する。
- 広場 $ X $ と広場 $ Y $ の標高が等しい場合、楽しさは変化しない。

楽しさは負の値になることもあります。

最初、高橋君は広場 $ 1 $ におり、楽しさは $ 0 $ です。 高橋君はいくつかの坂（ $ 0 $ 本でも良い）を移動した後に好きな広場で行動を終えることができるとしたとき、行動を終えた時点の高橋君の楽しさとしてありうる最大の値を求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ M $ $ H_1 $ $ H_2 $ $ \ldots $ $ H_N $ $ U_1 $ $ V_1 $ $ U_2 $ $ V_2 $ $ \vdots $ $ U_M $ $ V_M $

## 输出格式

答えを出力せよ。

## 说明/提示

### 制約

- $ 2\ \leq\ N\ \leq\ 2\times\ 10^5 $
- $ N-1\ \leq\ M\ \leq\ \min(\ 2\times\ 10^5,\frac{N(N-1)}{2}) $
- $ 0\ \leq\ H_i\leq\ 10^8 $ $ (1\ \leq\ i\ \leq\ N) $
- $ 1\ \leq\ U_i\ <\ V_i\ \leq\ N $ $ (1\ \leq\ i\ \leq\ M) $
- $ i\ \neq\ j $ ならば $ (U_i,V_i)\ \neq\ (U_j,\ V_j) $
- 入力はすべて整数である。
- どの $ 2 $ つの広場の間もいくつかの坂を使って移動することができる。

### Sample Explanation 1

広場 $ 1 $ $ \to $ 広場 $ 3 $ $ \to $ 広場 $ 4 $ と移動したとき、楽しさは次のように変化します。 - 広場 $ 1 $（標高 $ 10 $ ）から坂を使って広場 $ 3 $（標高 $ 12 $ ）へ移動します。楽しさは $ 2\times\ (12-10)=4 $ だけ減少し、$ 0-4=-4 $ になります。 - 広場 $ 3 $（標高 $ 12 $ ）から坂を使って広場 $ 4 $（標高 $ 5 $ ）へ移動します。楽しさは $ 12-5=7 $ だけ増加し、$ -4+7=3 $ になります。 ここで行動を終了したとき終了時の楽しさは $ 3 $ であり、このときが最大となります。

### Sample Explanation 2

一度も移動を行わない時、楽しさが最大となります。

## 样例 #1

### 输入

```
4 4

10 8 12 5

1 2

1 3

2 3

3 4
```

### 输出

```
3
```

## 样例 #2

### 输入

```
2 1

0 10

1 2
```

### 输出

```
0
```



---

---
title: "[ABC238D] AND and SUM"
layout: "post"
diff: 普及/提高-
pid: AT_abc238_d
tag: []
---

# [ABC238D] AND and SUM

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc238/tasks/abc238_d

$ T $ 個のテストケースについて、以下の問題を解いてください。

> 非負整数 $ a,s $ が与えられます。以下の条件を両方とも満たす非負整数の組 $ (x,y) $ は存在しますか？
> 
> - $ x\ \text{AND}\ y=a $
> - $ x+y=s $

 $ \text{AND} $ とは 非負整数 $ n,\ m $ の bit ごとの論理積 $ n\ \text{AND}\ m $ は、以下のように定義されます。

- $ n\ \text{AND}\ m $ を二進表記した際の $ 2^k\ \,\ (k\ \geq\ 0) $ の位の数は、$ n,\ m $ を二進表記した際の $ 2^k $ の位の数のうち**両方**が $ 1 $ であれば $ 1 $、そうでなければ $ 0 $ である。
 
 例えば、$ 4\ \text{AND}\ 6\ =\ 4 $ となります（二進表記すると: $ 100\ \text{AND}\ 110\ =\ 100 $）。

## 输入格式

入力は標準入力から与えられる。入力の $ 1 $ 行目は以下の形式である。

> $ T $

その後、 $ T $ 個のテストケースが続く。各テストケースは以下の形式で与えられる。

> $ a $ $ s $

## 输出格式

$ T $ 行出力せよ。$ i\ (1\ \leq\ i\ \leq\ T) $ 行目には、$ i $ 番目に与えられるテストケースについて問題文中の条件を両方とも満たす非負整数の組 $ (x,y) $ が存在するなら `Yes` を、存在しないなら `No` を出力せよ。

## 说明/提示

### 制約

- $ 1\ \leq\ T\ \leq\ 10^5 $
- $ 0\ \leq\ a,s\ \lt\ 2^{60} $
- 入力はすべて整数

### Sample Explanation 1

$ 1 $ 番目のテストケースにおいては、$ (x,y)=(3,5) $ などが条件を満たします。 $ 2 $ 番目のテストケースにおいては、条件を満たす非負整数の組 $ (x,y) $ は存在しません。

## 样例 #1

### 输入

```
2

1 8

4 2
```

### 输出

```
Yes

No
```

## 样例 #2

### 输入

```
4

201408139683277485 381410962404666524

360288799186493714 788806911317182736

18999951915747344 451273909320288229

962424162689761932 1097438793187620758
```

### 输出

```
No

Yes

Yes

No
```



---

---
title: "[ABC239E] Subtree K-th Max"
layout: "post"
diff: 普及/提高-
pid: AT_abc239_e
tag: []
---

# [ABC239E] Subtree K-th Max

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc239/tasks/abc239_e

$ N $ 頂点の根付き木があります。頂点には $ 1 $ から $ N $ の番号がついており、根は頂点 $ 1 $ です。  
 $ i $ 番目の辺は頂点 $ A_i $ と $ B_i $ を結んでいます。  
 頂点 $ i $ には整数 $ X_i $ が書かれています。

$ Q $ 個のクエリが与えられます。$ i $ 番目のクエリでは整数の組 $ (V_i,K_i) $ が与えられるので、次の問題に答えてください。

- 問題：頂点 $ V_i $ の部分木に含まれる頂点に書かれた整数のうち、大きい方から $ K_i $ 番目の値を求めよ

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ Q $ $ X_1 $ $ \ldots $ $ X_N $ $ A_1 $ $ B_1 $ $ \vdots $ $ A_{N-1} $ $ B_{N-1} $ $ V_1 $ $ K_1 $ $ \vdots $ $ V_Q $ $ K_Q $

## 输出格式

$ Q $ 行出力せよ。$ i $ 行目には $ i $ 番目のクエリに対する答えを出力せよ。

## 说明/提示

### 制約

- $ 2\ \leq\ N\ \leq\ 10^5 $
- $ 0\leq\ X_i\leq\ 10^9 $
- $ 1\leq\ A_i,B_i\leq\ N $
- $ 1\leq\ Q\ \leq\ 10^5 $
- $ 1\leq\ V_i\leq\ N $
- $ 1\leq\ K_i\leq\ 20 $
- 与えられるグラフは木である
- 頂点 $ V_i $ の部分木は頂点を $ K_i $ 個以上持つ
- 入力に含まれる値は全て整数である

### Sample Explanation 1

この入力において与えられる木は下図のようなものです。 !\[図\](https://img.atcoder.jp/ghi/e2bc1237d64f79f33181e6f54c9f7ce7.png) $ 1 $ 番目のクエリでは、頂点 $ 1 $ の部分木に含まれる頂点 $ 1,2,3,4,5 $ に書かれた数のうち大きい方から $ 2 $ 番目である $ 4 $ を出力します。 $ 2 $ 番目のクエリでは、頂点 $ 2 $ の部分木に含まれる頂点 $ 2,3,5 $ に書かれた数のうち大きい方から $ 1 $ 番目である $ 5 $ を出力します。

## 样例 #1

### 输入

```
5 2

1 2 3 4 5

1 4

2 1

2 5

3 2

1 2

2 1
```

### 输出

```
4

5
```

## 样例 #2

### 输入

```
6 2

10 10 10 9 8 8

1 4

2 1

2 5

3 2

6 4

1 4

2 2
```

### 输出

```
9

10
```

## 样例 #3

### 输入

```
4 4

1 10 100 1000

1 2

2 3

3 4

1 4

2 3

3 2

4 1
```

### 输出

```
1

10

100

1000
```



---

---
title: "[ABC240E] Ranges on Tree"
layout: "post"
diff: 普及/提高-
pid: AT_abc240_e
tag: []
---

# [ABC240E] Ranges on Tree

## 题目描述

### 题面简述

给出一个有 $N$ 个节点的树和其中的 $N-1$ 条树边（描述无向），其中我们规定节点编号为 $1,2,\cdots,N-1,N$，其中节点 $1$ 为树根。

你需要给予每一个节点 $i$ 一个闭区间 $[L_i,R_i]$，你需要保证一下性质。

- 虽然当 $L_i=R_i$ 的时候不满足闭区间书写规范，但是在本题中允许出现。

- $\forall_i,1\le L_i\le R_i$。

- 如果 $i$ 是 $j$ 的父亲节点，保证 $[L_j,R_j]\subseteq [L_i,R_i]$。

- 如果 $i,j$ 为兄弟节点（拥有相同的父亲节点），那么保证 $[L_i,R_i]\cap[L_j,R_j]=\varnothing$。

你需要保证你构造出的方案的 $\max\limits_{i=1}^{N} R_i$ 最小。

## 输入格式

如以下形式输入。

> $ N $ $ u_1 $ $ v_1 $ $ u_2 $ $ v_2 $ $ \vdots $ $ u_{N-1} $ $ v_{N-1} $

## 输出格式

如一下形式输出，对于每一组 $L_i$ 与 $R_i$ 之间需要空格，不同组之间用换行分开。

> $ L_1 $ $ R_1 $ $ L_2 $ $ R_2 $ $ \vdots $ $ L_N $ $ R_N $

@[_qingshu_](https://www.luogu.com.cn/user/602803) 译。

## 样例 #1

### 输入

```
3

2 1

3 1
```

### 输出

```
1 2

2 2

1 1
```

## 样例 #2

### 输入

```
5

3 4

5 4

1 2

1 4
```

### 输出

```
1 3

3 3

2 2

1 2

1 1
```

## 样例 #3

### 输入

```
5

4 5

3 2

5 2

3 1
```

### 输出

```
1 1

1 1

1 1

1 1

1 1
```



---

---
title: "[ABC241D] Sequence Query"
layout: "post"
diff: 普及/提高-
pid: AT_abc241_d
tag: []
---

# [ABC241D] Sequence Query

## 题目描述

# 题意简述
有一个空序列 $A$。给定 $Q$ 次操作，每次询问是以下三种之一：

>`1 x`：向 $A$ 中插入元素 $x$。
>
>`2 x k`：输出 $A$ 中所有 $\le x$ 的元素中的第 $k$ 大值。如果不存在输出 `-1`。
>
>`3 x k`：输出 $A$ 中所有 $\ge x$ 的元素中的第 $k$ 小值。如果不存在输出 `-1`。

## 输入格式

第一行包含一个整数 $Q$，接下来 $Q$ 行每行一次操作。
具体询问输入参考题意简述。

## 输出格式

对于操作 $2,3$，输出一个数表示答案。
Translated by @[tianbiandeshenghuo1](/user/714285)

## 说明/提示

>$1\le Q\le2\times10^5$。
>
>$1\le x\le10^{18}$。
>
>$1\le k\le5$。
>
>所有输入均为整数。

## 样例 #1

### 输入

```
11
1 20
1 10
1 30
1 20
3 15 1
3 15 2
3 15 3
3 15 4
2 100 5
1 1
2 100 5
```

### 输出

```
20
20
30
-1
-1
1
```



---

---
title: "[ABC241E] Putting Candies"
layout: "post"
diff: 普及/提高-
pid: AT_abc241_e
tag: []
---

# [ABC241E] Putting Candies

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc241/tasks/abc241_e

给你一个长度为 $ N $ 的数列$A $， $ A=(A_0,A_1,\ldots,A_{N-1}) $。 
 最初是空盘，高桥君会执行$K $次以下操作。

- 设盘子里有$ X $ 颗糖。每次在盘中放入$ A_{(X\bmod\ N)} $ 颗糖。 $ X\bmod\ N $ 表示 $ X $ 除以 $ N $ 的余数。

求$K$次后盘子里糖的颗数。

## 输入格式

输入以以下形式从标准输入给出:

> $ N $ $ K $ $ A_0 $ $ A_1 $ $ \ldots $ $ A_{N-1} $

## 输出格式

输出答案

## 说明/提示

### 制約

- $ 2\ \leq\ N\ \leq\ 2\times\ 10^5 $
- $ 1\ \leq\ K\ \leq\ 10^{12} $
- $ 1\ \leq\ A_i\leq\ 10^6 $
- 输入都是整数

## 样例 #1

### 输入

```
5 3

2 1 6 3 1
```

### 输出

```
11
```

## 样例 #2

### 输入

```
10 1000000000000

260522 914575 436426 979445 648772 690081 933447 190629 703497 47202
```

### 输出

```
826617499998784056
```



---

---
title: "[ABC242D] ABC Transform"
layout: "post"
diff: 普及/提高-
pid: AT_abc242_d
tag: []
---

# [ABC242D] ABC Transform

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc242/tasks/abc242_d

`A`, `B`, `C` のみからなる文字列 $ S $ が与えられます。

$ S^{(0)}:=S $ とし、$ i=1,2,3,\ldots $ について $ S^{(i)} $ を $ S^{(i-1)} $ の各文字を `A` → `BC`, `B` → `CA`, `C` → `AB` と同時に置き換えたものと定義します。

以下の $ Q $ 個のクエリに答えてください。$ i $ 個目のクエリの内容は以下の通りです。

- $ S^{(t_i)} $ の先頭から $ k_i $ 文字目を出力せよ。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ S $ $ Q $ $ t_1 $ $ k_1 $ $ t_2 $ $ k_2 $ $ \hspace{0.4cm}\vdots $ $ t_Q $ $ k_Q $

## 输出格式

$ Q $ 個のクエリを添字の昇順に、すなわち与えられる順に処理し、出力ごとに改行せよ。

## 说明/提示

### 制約

- $ S $ は `A`, `B`, `C` のみからなる長さ $ 1 $ 以上 $ 10^5 $ 以下の文字列
- $ 1\ \leq\ Q\ \leq\ 10^5 $
- $ 0\ \leq\ t_i\ \leq\ 10^{18} $
- $ 1\ \leq\ k_i\ \leq\ \min(10^{18},\ S^{(t_i)} $ の長さ$ ) $
- $ Q,\ t_i,\ k_i $ は整数

### Sample Explanation 1

$ S^{(0)}= $`ABC`, $ S^{(1)}= $`BCCAAB` です。 よって各クエリへの答えは順に `A`, `B`, `C`, `B` となります。

## 样例 #1

### 输入

```
ABC

4

0 1

1 1

1 3

1 6
```

### 输出

```
A

B

C

B
```

## 样例 #2

### 输入

```
CBBAACCCCC

5

57530144230160008 659279164847814847

29622990657296329 861239705300265164

509705228051901259 994708708957785197

176678501072691541 655134104344481648

827291290937314275 407121144297426665
```

### 输出

```
A

A

C

A

A
```



---

---
title: "[ABC243D] Moves on Binary Tree"
layout: "post"
diff: 普及/提高-
pid: AT_abc243_d
tag: []
---

# [ABC243D] Moves on Binary Tree

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc243/tasks/abc243_d

頂点数 $ 2^{10^{100}}-1 $ の完全二分木があり、頂点には $ 1,2,...,2^{10^{100}}-1 $ の番号がついています。  
 頂点 $ 1 $ が根であり、各 $ 1\leq\ i\ <\ 2^{10^{100}-1} $ について、頂点 $ i $ は 頂点 $ 2i $ を左の子、頂点 $ 2i+1 $ を右の子として持ちます。

高橋君は最初頂点 $ X $ におり、$ N $ 回移動を行います。移動は文字列 $ S $ により表され、$ i $ 回目の移動は次のように行います。

- $ S $ の $ i $ 番目の文字が `U` のとき、今いる頂点の親に移動する
- $ S $ の $ i $ 番目の文字が `L` のとき、今いる頂点の左の子に移動する
- $ S $ の $ i $ 番目の文字が `R` のとき、今いる頂点の右の子に移動する

$ N $ 回の移動後に高橋君がいる頂点の番号を求めてください。なお、答えが $ 10^{18} $ 以下になるような入力のみが与えられます。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ X $ $ S $

## 输出格式

答えを出力せよ。

## 说明/提示

### 制約

- $ 1\ \leq\ N\ \leq\ 10^6 $
- $ 1\ \leq\ X\ \leq\ 10^{18} $
- $ N,X $ は整数
- $ S $ は長さ $ N $ であり、`U`,`L`,`R` のみからなる
- 高橋君が根にいるとき、親に移動しようとすることはない
- 高橋君が葉にいるとき、子に移動しようとすることはない
- 高橋君が $ N $ 回の移動後にいる頂点の番号は $ 10^{18} $ 以下である

### Sample Explanation 1

完全二分木は次のような構造をしています。 !\[図\](https://img.atcoder.jp/ghi/9e199e154f481af436c8eaec9c487e2c.png) 各移動により、高橋君がいる頂点の番号は $ 2\ \to\ 1\ \to\ 3\ \to\ 6 $ と変化します。

### Sample Explanation 2

移動の途中過程において、高橋君がいる頂点の番号が $ 10^{18} $ を超えることもあります。

## 样例 #1

### 输入

```
3 2

URL
```

### 输出

```
6
```

## 样例 #2

### 输入

```
4 500000000000000000

RRUU
```

### 输出

```
500000000000000000
```

## 样例 #3

### 输入

```
30 123456789

LRULURLURLULULRURRLRULRRRUURRU
```

### 输出

```
126419752371
```



---

---
title: "[ABC244E] King Bombee"
layout: "post"
diff: 普及/提高-
pid: AT_abc244_e
tag: []
---

# [ABC244E] King Bombee

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc244/tasks/abc244_e

$ N $ 頂点 $ M $ 辺の単純無向グラフが与えられます。このグラフの頂点には $ 1 $ から $ N $ の番号が付けられており、辺には $ 1 $ から $ M $ の番号が付けられています。辺 $ i $ は頂点 $ U_i $ と頂点 $ V_i $ の間を結んでいます。

整数 $ K,\ S,\ T,\ X $ が与えられます。以下の条件を満たす数列 $ A\ =\ (A_0,\ A_1,\ \dots,\ A_K) $ は何通りありますか？

- $ A_i $ は $ 1 $ 以上 $ N $ 以下の整数
- $ A_0\ =\ S $
- $ A_K\ =\ T $
- 頂点 $ A_i $ と頂点 $ A_{i\ +\ 1} $ の間を直接結ぶ辺が存在する
- 数列 $ A $ の中に整数 $ X\ (X≠S,X≠T) $ は偶数回出現する ( $ 0 $ 回でも良い)

ただし、答えは非常に大きくなることがあるので、答えを $ 998244353 $ で割ったあまりを求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ M $ $ K $ $ S $ $ T $ $ X $ $ U_1 $ $ V_1 $ $ U_2 $ $ V_2 $ $ \vdots $ $ U_M $ $ V_M $

## 输出格式

答えを $ 998244353 $ で割ったあまりを出力せよ。

## 说明/提示

### 制約

- 入力は全て整数
- $ 2\ <\ =N\ <\ =2000 $
- $ 1\ <\ =M\ <\ =2000 $
- $ 1\ <\ =K\ <\ =2000 $
- $ 1\ <\ =S,T,X\ <\ =N $
- $ X≠S $
- $ X≠T $
- $ 1\ <\ =U_i\ <\ V_i\ <\ =N $
- $ i≠j $ ならば $ (U_i,\ V_i)≠(U_j,\ V_j) $

### Sample Explanation 1

\- $ (1,\ 2,\ 1,\ 2,\ 3) $ - $ (1,\ 2,\ 3,\ 2,\ 3) $ - $ (1,\ 4,\ 1,\ 4,\ 3) $ - $ (1,\ 4,\ 3,\ 4,\ 3) $ の $ 4 $ 個が条件を満たします。$ (1,\ 2,\ 3,\ 4,\ 3) $ や $ (1,\ 4,\ 1,\ 2,\ 3) $ は $ 2 $ が奇数回出現するため、条件を満たしません。

### Sample Explanation 2

グラフは連結であるとは限りません。

### Sample Explanation 3

$ 998244353 $ で割ったあまりを求めてください。

## 样例 #1

### 输入

```
4 4 4 1 3 2

1 2

2 3

3 4

1 4
```

### 输出

```
4
```

## 样例 #2

### 输入

```
6 5 10 1 2 3

2 3

2 4

4 6

3 6

1 5
```

### 输出

```
0
```

## 样例 #3

### 输入

```
10 15 20 4 4 6

2 6

2 7

5 7

4 5

2 4

3 7

1 7

1 4

2 9

5 10

1 3

7 8

7 9

1 6

1 2
```

### 输出

```
952504739
```



---

---
title: "[ABC245D] Polynomial division"
layout: "post"
diff: 普及/提高-
pid: AT_abc245_d
tag: []
---

# [ABC245D] Polynomial division

## 题目描述

现在有 $N$ 次多项式 $A（x）=A_Nx^N+A_{N-1}x^{N-1}+\cdots\ +A_1x+A_0$ 和 $M$ 次多项式 $B(x)=B_Mx^M+B_{M-1}x^{M-1}+\cdots\ +B_1x+B_0$。

其中，$A(x)、B(x)$ 中的每个系数都是绝对值小于等于 $100$ 的整数，并且最高的下一个系数不是 $0$。

定义它们的积为 $C(x)=A(x)B(x)=C_{N+M}x^{N+M}+C_{N+M-1}x^{N+M-1}+\cdots\ +C_1x+C_0$。

已知 $A_0,A_1,\ldots,\ A_N$ 和 $C_0,C_1,\ldots,\ C_{N+M}$，请求出 $B_0,B_1,\ldots,\ B_M$。

输入保证只有一种 $B_0,B_1,\ldots,\ B_M$。

## 输入格式

第一行输入 $N,M$；

第二行输入 $A_0,A_1,\ldots,A_{N-1}$；

第三行输入 $C_0,C_1,\ldots,C_{N+M}$。

## 输出格式

输出 $M+1$ 个整数 $B_0,B_1,\ldots,\ B_M$。

## 说明/提示

- $ 1\leq N<100 $

- $ 1\leq M<100 $

- $ |A_i|\leq100 $

- $ |C_i|\leq10^6 $

- $ A_N\neq0 $

- $ C_{N+M}\neq0 $

- 满足条件的 $B_0,B_1,\ldots,\ B_M$ 只有一个

## 样例 #1

### 输入

```
1 2

2 1

12 14 8 2
```

### 输出

```
6 4 2
```

## 样例 #2

### 输入

```
1 1

100 1

10000 0 -1
```

### 输出

```
100 -1
```



---

---
title: "[ABC246D] 2-variable Function"
layout: "post"
diff: 普及/提高-
pid: AT_abc246_d
tag: []
---

# [ABC246D] 2-variable Function

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc246/tasks/abc246_d

整数 $ N $ が与えられるので、以下の条件を全て満たす最小の整数 $ X $ を求めてください。

- $ X $ は $ N $ 以上である。
- 非負整数 $ (a,b) $ の組であって、 $ X=a^3+a^2b+ab^2+b^3 $ を満たすようなものが存在する。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $

## 输出格式

答えを整数として出力せよ。

## 说明/提示

### 制約

- $ N $ は整数
- $ 0\ \le\ N\ \le\ 10^{18} $

### Sample Explanation 1

$ 9\ \le\ X\ \le\ 14 $ であるようなどの整数 $ X $ についても、問題文中の条件を満たすような $ (a,b) $ は存在しません。 $ X=15 $ は $ (a,b)=(2,1) $ とすると問題文中の条件を満たします。

### Sample Explanation 2

$ N $ 自身が条件を満たすこともあります。

### Sample Explanation 3

入出力が $ 32 $bit 整数型に収まらない場合があります。

## 样例 #1

### 输入

```
9
```

### 输出

```
15
```

## 样例 #2

### 输入

```
0
```

### 输出

```
0
```

## 样例 #3

### 输入

```
999999999989449206
```

### 输出

```
1000000000000000000
```



---

---
title: "[ABC247E] Max Min"
layout: "post"
diff: 普及/提高-
pid: AT_abc247_e
tag: []
---

# [ABC247E] Max Min

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc247/tasks/abc247_e

長さ $ N $ の数列 $ A\ =\ (A_1,\ A_2,\ \dots,\ A_N) $ および整数 $ X,\ Y $ があります。 次の条件をすべて満たす整数の組 $ (L,\ R) $ の個数を求めてください。

- $ 1\ \leq\ L\ \leq\ R\ \leq\ N $
- $ A_L,\ A_{L+1},\ \dots,\ A_R $ の最大値は $ X $ であり、最小値は $ Y $ である。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ X $ $ Y $ $ A_1 $ $ A_2 $ $ \dots $ $ A_N $

## 输出格式

答えを出力せよ。

## 说明/提示

### 制約

- $ 1\ \leq\ N\ \leq\ 2\ \times\ 10^5 $
- $ 1\ \leq\ A_i\ \leq\ 2\ \times\ 10^5 $
- $ 1\ \leq\ Y\ \leq\ X\ \leq\ 2\ \times\ 10^5 $
- 入力される値はすべて整数である。

### Sample Explanation 1

条件を満たすのは $ (L,R)=(1,3),(1,4),(2,4),(3,4) $ の $ 4 $ 通りです。

### Sample Explanation 2

条件を満たす $ (L,R) $ は存在しません。

### Sample Explanation 3

$ X=Y $ である場合もあります。

## 样例 #1

### 输入

```
4 3 1
1 2 3 1
```

### 输出

```
4
```

## 样例 #2

### 输入

```
5 2 1
1 3 2 4 1
```

### 输出

```
0
```

## 样例 #3

### 输入

```
5 1 1
1 1 1 1 1
```

### 输出

```
15
```

## 样例 #4

### 输入

```
10 8 1
2 7 1 8 2 8 1 8 2 8
```

### 输出

```
36
```



---

---
title: "[ABC248C] Dice Sum"
layout: "post"
diff: 普及/提高-
pid: AT_abc248_c
tag: []
---

# [ABC248C] Dice Sum

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc248/tasks/abc248_c

長さ $ N $ の整数からなる数列 $ A=(A_1,\ldots,A_N) $ であって、以下の条件を全て満たすものは何通りありますか？

- $ 1\le\ A_i\ \le\ M $ $ (1\ \le\ i\ \le\ N) $
- $ \displaystyle\sum\ _{i=1}^N\ A_i\ \leq\ K $

ただし、答えは非常に大きくなることがあるので、答えを $ 998244353 $ で割った余りを求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ M $ $ K $

## 输出格式

答えを $ 998244353 $ で割った余りを出力せよ。

## 说明/提示

### 制約

- $ 1\ \leq\ N,\ M\ \leq\ 50 $
- $ N\ \leq\ K\ \leq\ NM $
- 入力は全て整数

### Sample Explanation 1

条件を満たす数列は以下の $ 6 $ つです。 - $ (1,1) $ - $ (1,2) $ - $ (1,3) $ - $ (2,1) $ - $ (2,2) $ - $ (3,1) $

### Sample Explanation 2

答えを $ 998244353 $ で割った余りを出力してください。

## 样例 #1

### 输入

```
2 3 4
```

### 输出

```
6
```

## 样例 #2

### 输入

```
31 41 592
```

### 输出

```
798416518
```



---

---
title: "[ABC248D] Range Count Query"
layout: "post"
diff: 普及/提高-
pid: AT_abc248_d
tag: []
---

# [ABC248D] Range Count Query

## 题目描述

给定一个长度为$N$的序列 $A=(A 
1
​	
 ,…,A 
N
​	
 )$ 
以及$Q$组询问，每组询问包括： $L,R,X$ 
三个整数。

请你求出在 $A 
L
​	
 , …,A 
R
​	
$
中，值等于 $X$ 的数有多少个。

## 输入格式

第一行一个正整数 $N$。

第二行一共 $N$ 个数，表示序列 $A$。

第三行一个正整数 $Q$。

之后$Q$行，每行$3$个整数 $L,R,X$。

## 输出格式

对于每一组询问，输出一个数 $ans$ 。

## 说明/提示

- $ 1\ \leq\ N\ \leq\ 2\times\ 10^5 $
- $ 1\ \leq\ A_i\ \leq\ N $
- $ 1\ \leq\ Q\ \leq\ 2\times\ 10^5 $
- 对于每一组询问， $ 1\le\ L\ \leq\ R\ \leq\ N,\ 1\ \leq\ X\ \leq\ N $
- 输入数据均为整数

## 样例 #1

### 输入

```
5
3 1 4 1 5
4
1 5 1
2 4 3
1 5 2
1 3 3
```

### 输出

```
2
0
0
1
```



---

---
title: "[ABC248E] K-colinear Line"
layout: "post"
diff: 普及/提高-
pid: AT_abc248_e
tag: []
---

# [ABC248E] K-colinear Line

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc248/tasks/abc248_e

座標平面上の $ N $ 個の点が与えられます。 $ 1\leq\ i\leq\ N $ について、$ i $ 番目の点の座標は $ (X_i,\ Y_i) $ です。

座標平面上の直線であって、$ N $ 個の点のうち $ K $ 個以上の点を通るものの個数を求めてください。  
ただし、そのようなものが無数に存在する場合は `Infinity` を出力してください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ K $ $ X_1 $ $ Y_1 $ $ X_2 $ $ Y_2 $ $ \vdots $ $ X_N $ $ Y_N $

## 输出格式

与えられた $ N $ 個の点のうち $ K $ 個以上の点を通る直線の数を出力せよ。ただし、そのようなものが無数に存在する場合は `Infinity` を出力せよ。

## 说明/提示

### 制約

- $ 1\ \leq\ K\ \leq\ N\ \leq\ 300 $
- $ \lvert\ X_i\ \rvert,\ \lvert\ Y_i\ \rvert\ \leq\ 10^9 $
- $ i\neq\ j $ ならば $ X_i\neq\ X_j $ または $ Y_i\neq\ Y_j $
- 入力はすべて整数

### Sample Explanation 1

$ x=0 $, $ y=0 $, $ y=x\pm\ 1 $, $ y=-x\pm\ 1 $ の $ 6 $ 本の直線が条件をみたします。 例えば、$ x=0 $ は、$ 1 $, $ 3 $, $ 5 $ 番目の $ 3 $ 個の点を通ります。 よって、$ 6 $ を出力します。

### Sample Explanation 2

原点を通る直線は無数に存在します。 よって、`Infinity` を出力します。

## 样例 #1

### 输入

```
5 2
0 0
1 0
0 1
-1 0
0 -1
```

### 输出

```
6
```

## 样例 #2

### 输入

```
1 1
0 0
```

### 输出

```
Infinity
```



---

---
title: "[ABC249D] Index Trio"
layout: "post"
diff: 普及/提高-
pid: AT_abc249_d
tag: []
---

# [ABC249D] Index Trio

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc249/tasks/abc249_d

長さ $ N $ の整数列 $ A\ =\ (A_1,\ \dots,\ A_N) $ が与えられます。

以下の条件を全て満たす整数の組 $ (i,\ j,\ k) $ の総数を求めてください。

- $ 1\ \leq\ i,\ j,\ k\ \leq\ N $
- $ \frac{A_i}{A_j}\ =\ A_k $

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ A_1 $ $ \ldots $ $ A_N $

## 输出格式

答えを出力せよ。

## 说明/提示

### 制約

- $ 1\ \leq\ N\ \leq\ 2\ \times\ 10^5 $
- $ 1\ \leq\ A_i\ \leq\ 2\ \times\ 10^5\ \,\ (1\ \leq\ i\ \leq\ N) $
- 入力は全て整数

### Sample Explanation 1

$ (i,\ j,\ k)\ =\ (1,\ 2,\ 3),\ (1,\ 3,\ 2) $ が条件を満たします。

## 样例 #1

### 输入

```
3
6 2 3
```

### 输出

```
2
```

## 样例 #2

### 输入

```
1
2
```

### 输出

```
0
```

## 样例 #3

### 输入

```
10
1 3 2 4 6 8 2 2 3 7
```

### 输出

```
62
```



---

---
title: "[ABC250D] 250-like Number"
layout: "post"
diff: 普及/提高-
pid: AT_abc250_d
tag: []
---

# [ABC250D] 250-like Number

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc250/tasks/abc250_d

以下の条件を満たす整数 $ k $ を「 $ 250 $ に似た数」と呼びます。

- $ k $ が素数 $ p\ <\ q $ を使って $ k=p\ \times\ q^3 $ と表される。

$ N $ 以下の「 $ 250 $ に似た数」は全部でいくつありますか？

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $

## 输出格式

答えを整数として出力せよ。

## 说明/提示

### 制約

- $ N $ は $ 1 $ 以上 $ 10^{18} $ 以下の整数

### Sample Explanation 1

\- $ 54\ =\ 2\ \times\ 3^3 $ なので、「 $ 250 $ に似た数」です。 - $ 250\ =\ 2\ \times\ 5^3 $ なので、「 $ 250 $ に似た数」です。 $ 250 $ 以下の「 $ 250 $ に似た数」は、以上の $ 2 $ つです。

## 样例 #1

### 输入

```
250
```

### 输出

```
2
```

## 样例 #2

### 输入

```
1
```

### 输出

```
0
```

## 样例 #3

### 输入

```
123456789012345
```

### 输出

```
226863
```



---

---
title: "[ABC252D] Distinct Trio"
layout: "post"
diff: 普及/提高-
pid: AT_abc252_d
tag: []
---

# [ABC252D] Distinct Trio

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc252/tasks/abc252_d

長さ $ N $ の数列 $ A=(A_1,A_2,\ldots,A_N) $ が与えられます。  
 以下の $ 2 $ 条件をともに満たすような整数の組 $ (i,j,k) $ の個数を求めてください。

- $ 1\leq\ i\ \lt\ j\ \lt\ k\ \leq\ N $
- $ A_i,A_j,A_k $ は相異なる

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ A_1 $ $ A_2 $ $ \ldots $ $ A_N $

## 输出格式

答えを出力せよ。

## 说明/提示

### 制約

- $ 3\ \leq\ N\ \leq\ 2\times\ 10^5 $
- $ 1\ \leq\ A_i\ \leq\ 2\times\ 10^5 $
- 入力に含まれる値は全て整数である

### Sample Explanation 1

条件を満たす整数の組 $ (i,j,k) $ は $ (1,2,3),(1,3,4) $ の $ 2 $ つです。

## 样例 #1

### 输入

```
4

3 1 4 1
```

### 输出

```
2
```

## 样例 #2

### 输入

```
10

99999 99998 99997 99996 99995 99994 99993 99992 99991 99990
```

### 输出

```
120
```

## 样例 #3

### 输入

```
15

3 1 4 1 5 9 2 6 5 3 5 8 9 7 9
```

### 输出

```
355
```



---

---
title: "[ABC254D] Together Square"
layout: "post"
diff: 普及/提高-
pid: AT_abc254_d
tag: []
---

# [ABC254D] Together Square

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc254/tasks/abc254_d

整数 $ N $ が与えられます。以下の条件を満たす $ N $ 以下の正整数の組 $ (i,j) $ の個数を求めてください。

- $ i\ \times\ j $ は平方数である。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $

## 输出格式

答えを出力せよ。

## 说明/提示

### 制約

- $ 1\ \le\ N\ \le\ 2\ \times\ 10^5 $
- $ N $ は整数である。

### Sample Explanation 1

$ (1,1),(1,4),(2,2),(3,3),(4,1),(4,4) $ の $ 6 $ 個が条件を満たします。 $ (2,3) $ は $ 2\ \times\ 3\ =6 $ が平方数でないため条件を満たしません。

## 样例 #1

### 输入

```
4
```

### 输出

```
6
```

## 样例 #2

### 输入

```
254
```

### 输出

```
896
```



---

---
title: "[ABC255D] ±1 Operation 2"
layout: "post"
diff: 普及/提高-
pid: AT_abc255_d
tag: []
---

# [ABC255D] ±1 Operation 2

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc255/tasks/abc255_d

長さ $ N $ の数列 $ A=(A_1,A_2,\dots,A_N) $ が与えられます。この $ A $ に以下を施すことを「操作」と呼びます。

- まず、 $ 1\ \le\ i\ \le\ N $ を満たす整数 $ i $ を選択する。
- 次に、以下の $ 2 $ つのうちどちらかを選択し、実行する。
  - $ A_i $ に $ 1 $ を加算する。
  - $ A_i $ から $ 1 $ を減算する。

$ Q $ 個の質問に答えてください。  
$ i $ 個目の質問は以下です。

- 「操作」を $ 0 $ 回以上何度でも使って $ A $ の要素を全て $ X_i $ にする時、必要な「操作」の最小回数を求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ Q $ $ A_1 $ $ A_2 $ $ \dots $ $ A_N $ $ X_1 $ $ X_2 $ $ \vdots $ $ X_Q $

## 输出格式

$ Q $ 行にわたって出力せよ。  
出力のうち $ i $ 行目には、 $ i $ 個目の質問に対する答えを整数として出力せよ。

## 说明/提示

### 制約

- 入力は全て整数
- $ 1\ \le\ N,Q\ \le\ 2\ \times\ 10^5 $
- $ 0\ \le\ A_i\ \le\ 10^9 $
- $ 0\ \le\ X_i\ \le\ 10^9 $

### Sample Explanation 1

$ A=(6,11,2,5,5) $ であり、この入力には $ 3 $ つの質問が含まれます。 $ 1 $ つ目の質問について、 $ A $ に以下のように $ 10 $ 回の「操作」を施すことで、 $ A $ の要素を全て $ 5 $ にすることができます。 - $ A_1 $ から $ 1 $ 減算する。 - $ A_2 $ から $ 1 $ 減算することを $ 6 $ 度繰り返す。 - $ A_3 $ に $ 1 $ 加算することを $ 3 $ 度繰り返す。 $ 9 $ 回以下の「操作」で $ A $ の要素を全て $ 5 $ にすることはできません。 $ 2 $ つ目の質問について、 $ A $ に $ 71 $ 回の「操作」を施すことで、 $ A $ の要素を全て $ 20 $ にすることができます。 $ 3 $ つ目の質問について、 $ A $ に $ 29 $ 回の「操作」を施すことで、 $ A $ の要素を全て $ 0 $ にすることができます。

### Sample Explanation 2

出力が $ 32 $bit 整数に収まらない場合もあります。

## 样例 #1

### 输入

```
5 3
6 11 2 5 5
5
20
0
```

### 输出

```
10
71
29
```

## 样例 #2

### 输入

```
10 5
1000000000 314159265 271828182 141421356 161803398 0 777777777 255255255 536870912 998244353
555555555
321654987
1000000000
789456123
0
```

### 输出

```
3316905982
2811735560
5542639502
4275864946
4457360498
```



---

---
title: "[ABC257D] Jumping Takahashi 2"
layout: "post"
diff: 普及/提高-
pid: AT_abc257_d
tag: []
---

# [ABC257D] Jumping Takahashi 2

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc257/tasks/abc257_d

高橋君が住んでいる二次元平面上の街には $ N $ 個のジャンプ台があります。$ i $ 番目のジャンプ台は点 $ (x_i,\ y_i) $ にあり、ジャンプ台のパワーは $ P_i $ です。また高橋君のジャンプ力は $ S $ で表され、はじめ $ S=0 $ です。高橋君が訓練を $ 1 $ 回行う度に $ S $ は $ 1 $ 増えます。

高橋君は以下の条件を満たす場合に限り、$ i $ 番目のジャンプ台から $ j $ 番目のジャンプ台にジャンプすることができます。

- $ P_iS\geq\ |x_i\ -\ x_j|\ +|y_i\ -\ y_j| $

高橋君の目的は、適切に始点とするジャンプ台を決めることで、そのジャンプ台からどのジャンプ台にも何回かのジャンプで移動できるようにすることです。

目的を達成するためには高橋君は最低で何回訓練を行う必要があるでしょうか？

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ x_1 $ $ y_1 $ $ P_1 $ $ \vdots $ $ x_N $ $ y_N $ $ P_N $

## 输出格式

答えを出力せよ。

## 说明/提示

### 制約

- $ 2\ \leq\ N\ \leq\ 200 $
- $ -10^9\ \leq\ x_i,y_i\ \leq\ 10^9 $
- $ 1\ \leq\ P_i\ \leq\ 10^9 $
- $ (x_i,\ y_i)\ \neq\ (x_j,y_j)\ (i\neq\ j) $
- 入力は全て整数

### Sample Explanation 1

高橋君が $ 2 $ 回訓練したとすると、 $ S=2 $ です。 このとき、$ 2 $ 番目のジャンプ台から全てのジャンプ台に移動することができます。 例えば、$ 4 $ 番目のジャンプ台へは以下の方法で移動ができます。 - $ 2 $ 番目のジャンプ台から $ 3 $ 番目のジャンプ台へジャンプする。（ $ P_2\ S\ =\ 10,\ |x_2-x_3|\ +\ |y_2-y_3|\ =\ 10 $ であり、 $ P_2\ S\ \geq\ |x_2-x_3|\ +\ |y_2-y_3| $ を満たす。） - $ 3 $ 番目のジャンプ台から $ 4 $ 番目のジャンプ台へジャンプする。（ $ P_3\ S\ =\ 2,\ |x_3-x_4|\ +\ |y_3-y_4|\ =\ 1 $ であり、 $ P_3\ S\ \geq\ |x_3-x_4|\ +\ |y_3-y_4| $ を満たす。）

## 样例 #1

### 输入

```
4

-10 0 1

0 0 5

10 0 1

11 0 1
```

### 输出

```
2
```

## 样例 #2

### 输入

```
7

20 31 1

13 4 3

-10 -15 2

34 26 5

-2 39 4

0 -50 1

5 -20 2
```

### 输出

```
18
```



---

---
title: "[ABC259D] Circumferences"
layout: "post"
diff: 普及/提高-
pid: AT_abc259_d
tag: []
---

# [ABC259D] Circumferences

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc259/tasks/abc259_d

$ xy $ -平面上の $ N $ 個の円が与えられます。 $ i\ =\ 1,\ 2,\ \ldots,\ N $ について、$ i $ 番目の円は点 $ (x_i,\ y_i) $ を中心とする半径 $ r_i $ の円です。

$ N $ 個の円のうち少なくとも $ 1 $ つ以上の円の円周上にある点のみを通って、点 $ (s_x,\ s_y) $ から点 $ (t_x,\ t_y) $ に行くことができるかどうかを判定してください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ s_x $ $ s_y $ $ t_x $ $ t_y $ $ x_1 $ $ y_1 $ $ r_1 $ $ x_2 $ $ y_2 $ $ r_2 $ $ \vdots $ $ x_N $ $ y_N $ $ r_N $

## 输出格式

点 $ (s_x,\ s_y) $ から点 $ (t_x,\ t_y) $ に行くことができる場合は `Yes` を、そうでない場合は `No` を出力せよ。 ジャッジは英小文字と英大文字を厳密に区別することに注意せよ。

## 说明/提示

### 制約

- $ 1\ \leq\ N\ \leq\ 3000 $
- $ -10^9\ \leq\ x_i,\ y_i\ \leq\ 10^9 $
- $ 1\ \leq\ r_i\ \leq\ 10^9 $
- $ (s_x,\ s_y) $ は $ N $ 個の円のうち少なくとも $ 1 $ つ以上の円の円周上にある
- $ (t_x,\ t_y) $ は $ N $ 個の円のうち少なくとも $ 1 $ つ以上の円の円周上にある
- 入力はすべて整数

### Sample Explanation 1

!\[\](https://img.atcoder.jp/abc259/7b850385b9d67dc150435ffc7818bd94.png) 例えば、下記の経路で点 $ (0,\ -2) $ から点 $ (3,\ 3) $ へ行くことができます。 - 点 $ (0,\ -2) $ から $ 1 $ つ目の円の円周上を反時計回りに通って点 $ (1,\ -\sqrt{3}) $ へ行く。 - 点 $ (1,\ -\sqrt{3}) $ から $ 2 $ つ目の円の円周上を時計回りに通って点 $ (2,\ 2) $ へ行く。 - 点 $ (2,\ 2) $ から $ 3 $ つ目の円の円周上を反時計回りに通って点 $ (3,\ 3) $ へ行く。 よって、`Yes` を出力します。

### Sample Explanation 2

!\[\](https://img.atcoder.jp/abc259/924efa40ff28e5d7125841da2710d012.png) 少なくとも $ 1 $ つ以上の円の円周上にある点のみを通って点 $ (0,\ 1) $ から点 $ (0,\ 3) $ に行くことはできないので `No` を出力します。

## 样例 #1

### 输入

```
4
0 -2 3 3
0 0 2
2 0 2
2 3 1
-3 3 3
```

### 输出

```
Yes
```

## 样例 #2

### 输入

```
3
0 1 0 3
0 0 1
0 0 2
0 0 3
```

### 输出

```
No
```



---

---
title: "[ABC260D] Draw Your Cards"
layout: "post"
diff: 普及/提高-
pid: AT_abc260_d
tag: []
---

# [ABC260D] Draw Your Cards

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc260/tasks/abc260_d

$ 1 $ から $ N $ が書かれた $ N $ 枚のカードが裏向きで積まれた山札があり、上から $ i $ 枚目のカードには整数 $ P_i $ が書かれています。

この山札を使って、以下の行動を $ N $ ターン繰り返します。

- 山札の一番上のカードを引いて、そこに書かれた整数を $ X $ とする。
- 場に見えている表向きのカードであって書かれた整数が $ X $ 以上であるもののうち、書かれた整数が最小のものの上に、引いたカードを表向きで重ねる。もし場にそのようなカードがなければ、引いたカードをどれにも重ねずに表向きで場に置く。
- その後、表向きのカードが $ K $ 枚重ねられた山が場にあればその山のカードを全て食べる。食べられたカードは全て場から消滅する。

各カードについて、何ターン目に食べられるか、あるいは最後まで食べられないかを求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ K $ $ P_1 $ $ P_2 $ $ \dots $ $ P_N $

## 输出格式

$ N $ 行出力せよ。  
 そのうち $ i $ ($ 1\ \le\ i\ \le\ N $) 行目には、整数 $ i $ が書かれたカードについて、以下のように出力せよ。

- もし $ i $ が書かれたカードが食べられるなら、それが何ターン目であるかを整数として出力せよ。
- そうでないなら $ -1 $ と出力せよ。

## 说明/提示

### 制約

- 入力は全て整数
- $ 1\ \le\ K\ \le\ N\ \le\ 2\ \times\ 10^5 $
- $ P $ は $ (1,2,\dots,N) $ の順列 ( $ (1,2,\dots,N) $ を並べ替えて得られる列 ) である

### Sample Explanation 1

この入力では、 $ P=(3,5,2,1,4),K=2 $ です。 - $ 1 $ ターン目に、 $ 3 $ が書かれたカードが他のカードに重ねられずに表向きで場に置かれます。 - $ 2 $ ターン目に、 $ 5 $ が書かれたカードが他のカードに重ねられずに表向きで場に置かれます。 - $ 3 $ ターン目に、 $ 2 $ が書かれたカードが $ 3 $ が書かれたカードの上に表向きで重ねられます。 - この時点で上から $ 2,3 $ が書かれたカードが表向きで重ねられた山が $ K=2 $ 枚に達したので、両カードは食べられます。 - $ 4 $ ターン目に、 $ 1 $ が書かれたカードが $ 5 $ が書かれたカードの上に表向きで重ねられます。 - この時点で上から $ 1,5 $ が書かれたカードが表向きで重ねられた山が $ K=2 $ 枚に達したので、両カードは食べられます。 - $ 5 $ ターン目に、 $ 4 $ が書かれたカードが他のカードに重ねられずに表向きで場に置かれます。 - $ 4 $ が書かれたカードは、最後まで食べられませんでした。

### Sample Explanation 2

$ K=1 $ である場合、全てのカードは場に置かれたターンに食べられます。

## 样例 #1

### 输入

```
5 2

3 5 2 1 4
```

### 输出

```
4

3

3

-1

4
```

## 样例 #2

### 输入

```
5 1

1 2 3 4 5
```

### 输出

```
1

2

3

4

5
```

## 样例 #3

### 输入

```
15 3

3 14 15 9 2 6 5 13 1 7 10 11 8 12 4
```

### 输出

```
9

9

9

15

15

6

-1

-1

6

-1

-1

-1

-1

6

15
```



---

---
title: "[ABC261D] Flipping and Bonus"
layout: "post"
diff: 普及/提高-
pid: AT_abc261_d
tag: []
---

# [ABC261D] Flipping and Bonus

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc261/tasks/abc261_d

高橋君が $ N $ 回コイントスを行います。 また、高橋君はカウンタを持っており、最初カウンタの数値は $ 0 $ です。

$ i $ 回目のコイントスで表裏のどちらが出たかによって、次のことが起こります。

- 表が出たとき：高橋君はカウンタの数値を $ 1 $ 増やし、$ X_i $ 円もらう。
- 裏が出たとき：高橋君はカウンタの数値を $ 0 $ に戻す。お金をもらうことは出来ない。

また、$ M $ 種類の連続ボーナスがあり、$ i $ 種類目の連続ボーナスではカウンタの数値が $ C_i $ になる**たびに** $ Y_i $ 円もらうことができます。

高橋君は最大で何円もらうことができるかを求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ M $ $ X_1 $ $ X_2 $ $ \ldots $ $ X_N $ $ C_1 $ $ Y_1 $ $ C_2 $ $ Y_2 $ $ \vdots $ $ C_M $ $ Y_M $

## 输出格式

高橋君がもらうことのできる金額の最大値を整数で出力せよ。

## 说明/提示

### 制約

- $ 1\leq\ M\leq\ N\leq\ 5000 $
- $ 1\leq\ X_i\leq\ 10^9 $
- $ 1\leq\ C_i\leq\ N $
- $ 1\leq\ Y_i\leq\ 10^9 $
- $ C_1,C_2,\ldots,C_M $ はすべて異なる。
- 入力はすべて整数

### Sample Explanation 1

順に 表, 表, 裏, 表, 表, 表 が出た時、もらえる金額は次のようになります。 - $ 1 $ 回目のコイントスで表が出る。カウンタの数値を $ 0 $ から $ 1 $ にして、$ 2 $ 円もらう。 - $ 2 $ 回目のコイントスで表が出る。カウンタの数値を $ 1 $ から $ 2 $ にして、$ 7 $ 円もらう。さらに、連続ボーナスとして $ 10 $ 円もらう。 - $ 3 $ 回目のコイントスで裏が出る。カウンタの数値を $ 2 $ から $ 0 $ にする。 - $ 4 $ 回目のコイントスで表が出る。カウンタの数値を $ 0 $ から $ 1 $ にして、$ 8 $ 円もらう。 - $ 5 $ 回目のコイントスで表が出る。カウンタの数値を $ 1 $ から $ 2 $ にして、$ 2 $ 円もらう。さらに、連続ボーナスとして $ 10 $ 円もらう。 - $ 6 $ 回目のコイントスで表が出る。カウンタの数値を $ 2 $ から $ 3 $ にして、$ 8 $ 円もらう。さらに、連続ボーナスとして $ 1 $ 円もらう。 このとき高橋君は合計で $ 2+(7+10)+0+8+(2+10)+(8+1)=48 $ 円もらうことができ、このときが最大です。 連続ボーナスはカウンタの数値が $ C_i $ になるたびに何度でももらえることに注意してください。 ちなみに、$ 6 $ 回のコイントスで全部表が出た時は $ 2+(7+10)+(1+1)+8+(2+5)+8=44 $ 円しかもらうことが出来ず、この時は最大ではありません。

### Sample Explanation 2

答えが $ 32 $ bit 整数型に収まらないこともあることに注意してください。

## 样例 #1

### 输入

```
6 3
2 7 1 8 2 8
2 10
3 1
5 5
```

### 输出

```
48
```

## 样例 #2

### 输入

```
3 2
1000000000 1000000000 1000000000
1 1000000000
3 1000000000
```

### 输出

```
5000000000
```



---

---
title: "[ABC262D] I Hate Non-integer Number"
layout: "post"
diff: 普及/提高-
pid: AT_abc262_d
tag: []
---

# [ABC262D] I Hate Non-integer Number

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc262/tasks/abc262_d

項数が $ N $ の正整数列 $ A=(a_1,\ldots,a_N) $ が与えられます。  
 $ A $ の項を $ 1 $ 個以上選ぶ方法は $ 2^N-1 $ 通りありますが、そのうち選んだ項の平均値が整数であるものが何通りかを $ 998244353 $ で割った余りを求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ a_1 $ $ \ldots $ $ a_N $

## 输出格式

答えを出力せよ。

## 说明/提示

### 制約

- $ 1\ \leq\ N\ \leq\ 100 $
- $ 1\ \leq\ a_i\ \leq\ 10^9 $
- 入力はすべて整数

### Sample Explanation 1

$ A $ の項を選ぶ方法それぞれに対する平均値は以下のようになります。 - $ a_1 $ のみを選んだ場合、平均値は $ \frac{a_1}{1}=\frac{2}{1}\ =\ 2 $ であり、整数である。 - $ a_2 $ のみを選んだ場合、平均値は $ \frac{a_2}{1}=\frac{6}{1}\ =\ 6 $ であり、整数である。 - $ a_3 $ のみを選んだ場合、平均値は $ \frac{a_3}{1}=\frac{2}{1}\ =\ 2 $ であり、整数である。 - $ a_1 $ と $ a_2 $ を選んだ場合、平均値は $ \frac{a_1+a_2}{2}=\frac{2+6}{2}\ =\ 4 $ であり、整数である。 - $ a_1 $ と $ a_3 $ を選んだ場合、平均値は $ \frac{a_1+a_3}{2}=\frac{2+2}{2}\ =\ 2 $ であり、整数である。 - $ a_2 $ と $ a_3 $ を選んだ場合、平均値は $ \frac{a_2+a_3}{2}=\frac{6+2}{2}\ =\ 4 $ であり、整数である。 - $ a_1 $ と $ a_2 $ と $ a_3 $ を選んだ場合、平均値は $ \frac{a_1+a_2+a_3}{3}=\frac{2+6+2}{3}\ =\ \frac{10}{3} $ であり、整数ではない。 以上より、$ 6 $ 通りの選び方が条件を満たします。

### Sample Explanation 2

どのように $ A $ の項を $ 1 $ 個以上選んでも平均値が $ 5 $ になります。

## 样例 #1

### 输入

```
3

2 6 2
```

### 输出

```
6
```

## 样例 #2

### 输入

```
5

5 5 5 5 5
```

### 输出

```
31
```



---

---
title: "[ABC263D] Left Right Operation"
layout: "post"
diff: 普及/提高-
pid: AT_abc263_d
tag: []
---

# [ABC263D] Left Right Operation

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc263/tasks/abc263_d

長さ $ N $ の整数列 $ A=(A_1,A_2,\ldots,A_N) $ が与えられます。

あなたは以下の連続する操作をちょうど一度だけ行います。

- 整数 $ x\ (0\leq\ x\ \leq\ N) $ を選ぶ。$ x $ として $ 0 $ を選んだ場合何もしない。 $ x $ として $ 1 $ 以上の整数を選んだ場合、$ A_1,A_2,\ldots,A_x $ をそれぞれ $ L $ で置き換える。
- 整数 $ y\ (0\leq\ y\ \leq\ N) $ を選ぶ。$ y $ として $ 0 $ を選んだ場合何もしない。 $ y $ として $ 1 $ 以上の整数を選んだ場合、$ A_{N},A_{N-1},\ldots,A_{N-y+1} $ をそれぞれ $ R $ で置き換える。

操作後の $ A $ の要素の総和として考えられる最小値を求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ L $ $ R $ $ A_1 $ $ A_2 $ $ \ldots $ $ A_N $

## 输出格式

答えを出力せよ。

## 说明/提示

### 制約

- $ 1\ \leq\ N\ \leq\ 2\times\ 10^5 $
- $ -10^9\ \leq\ L,\ R\leq\ 10^9 $
- $ -10^9\ \leq\ A_i\leq\ 10^9 $
- 入力は全て整数

### Sample Explanation 1

$ x=2,y=2 $ として操作をすると、数列 $ A\ =\ (4,4,0,3,3) $ となり、要素の総和は $ 14 $ になります。 これが達成可能な最小値です。

### Sample Explanation 2

$ x=0,y=0 $ として操作をすると、数列 $ A\ =\ (1,2,3,4) $ となり、要素の総和は $ 10 $ になります。 これが達成可能な最小値です。

### Sample Explanation 3

$ L,R,A_i $ は負であることがあります。

## 样例 #1

### 输入

```
5 4 3

5 5 0 6 3
```

### 输出

```
14
```

## 样例 #2

### 输入

```
4 10 10

1 2 3 4
```

### 输出

```
10
```

## 样例 #3

### 输入

```
10 -5 -3

9 -6 10 -1 2 10 -1 7 -15 5
```

### 输出

```
-58
```



---

---
title: "[ABC264C] Matrix Reducing"
layout: "post"
diff: 普及/提高-
pid: AT_abc264_c
tag: []
---

# [ABC264C] Matrix Reducing

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc264/tasks/abc264_c

$ H_1 $ 行 $ W_1 $ 列の行列 $ A $ と、$ H_2 $ 行 $ W_2 $ 列の行列 $ B $ が与えられます。

- $ 1\ \leq\ i\ \leq\ H_1 $ かつ $ 1\ \leq\ j\ \leq\ W_1 $ を満たす整数の組 $ (i,\ j) $ について、行列 $ A $ の $ i $ 行目 $ j $ 列目の要素は $ A_{i,\ j} $ です。
- $ 1\ \leq\ i\ \leq\ H_2 $ かつ $ 1\ \leq\ j\ \leq\ W_2 $ を満たす整数の組 $ (i,\ j) $ について、行列 $ B $ の $ i $ 行目 $ j $ 列目の要素は $ B_{i,\ j} $ です。

行列 $ A $ に対して、下記の $ 2 $ つの操作のうちどちらかを行うことを、好きなだけ（ $ 0 $ 回でも良い）繰り返すことができます。

- $ A $ の行を任意に $ 1 $ つ選んで削除する。
- $ A $ の列を任意に $ 1 $ つ選んで削除する。

行列 $ A $ を行列 $ B $ に一致させることができるかどうかを判定して下さい。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ H_1 $ $ W_1 $ $ A_{1,\ 1} $ $ A_{1,\ 2} $ $ \ldots $ $ A_{1,\ W_1} $ $ A_{2,\ 1} $ $ A_{2,\ 2} $ $ \ldots $ $ A_{2,\ W_1} $ $ \vdots $ $ A_{H_1,\ 1} $ $ A_{H_1,\ 2} $ $ \ldots $ $ A_{H_1,\ W_1} $ $ H_2 $ $ W_2 $ $ B_{1,\ 1} $ $ B_{1,\ 2} $ $ \ldots $ $ B_{1,\ W_2} $ $ B_{2,\ 1} $ $ B_{2,\ 2} $ $ \ldots $ $ B_{2,\ W_2} $ $ \vdots $ $ B_{H_2,\ 1} $ $ B_{H_2,\ 2} $ $ \ldots $ $ B_{H_2,\ W_2} $

## 输出格式

行列 $ A $ を行列 $ B $ に一致させることができる場合は `Yes` を、 一致させることができない場合は `No` を出力せよ。 ジャッジは英小文字と英大文字を厳密に区別することに注意せよ。

## 说明/提示

### 制約

- $ 1\ \leq\ H_2\ \leq\ H_1\ \leq\ 10 $
- $ 1\ \leq\ W_2\ \leq\ W_1\ \leq\ 10 $
- $ 1\ \leq\ A_{i,\ j}\ \leq\ 10^9 $
- $ 1\ \leq\ B_{i,\ j}\ \leq\ 10^9 $
- 入力中の値はすべて整数

### Sample Explanation 1

初期状態の行列 $ A $ から $ 2 $ 列目を削除すると、行列 $ A $ は ``` 1 3 4 5 6 8 9 10 11 13 14 15 16 18 19 20 ``` となります。そこからさらに $ 3 $ 行目を削除すると、行列 $ A $ は ``` 1 3 4 5 6 8 9 10 16 18 19 20 ``` となります。そこからさらに $ 1 $ 行目を削除すると、行列 $ A $ は ``` 6 8 9 10 16 18 19 20 ``` となります。そこからさらに $ 4 $ 列目を削除すると、行列 $ A $ は ``` 6 8 9 16 18 19 ``` となります。これは行列 $ B $ と一致します。 操作の繰り返しによって行列 $ A $ を行列 $ B $ に一致させることができるので `Yes` を出力します。

### Sample Explanation 2

どのように操作を行っても、 行列 $ A $ を行列 $ B $ に一致させることはできません。 よって、`No` を出力します。

## 样例 #1

### 输入

```
4 5

1 2 3 4 5

6 7 8 9 10

11 12 13 14 15

16 17 18 19 20

2 3

6 8 9

16 18 19
```

### 输出

```
Yes
```

## 样例 #2

### 输入

```
3 3

1 1 1

1 1 1

1 1 1

1 1

2
```

### 输出

```
No
```



---

---
title: "[ABC265D] Iroha and Haiku (New ABC Edition)"
layout: "post"
diff: 普及/提高-
pid: AT_abc265_d
tag: []
---

# [ABC265D] Iroha and Haiku (New ABC Edition)

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc265/tasks/abc265_d

長さ $ N $ の数列 $ A=(A_0,\ldots,A_{N-1}) $ があります。  
次の条件を全て満たす整数の組 $ (x,y,z,w) $ が存在するか判定してください。

- $ 0\ \leq\ x\ <\ y\ <\ z\ <\ w\ \leq\ N $
- $ A_x\ +\ A_{x+1}\ +\ \ldots\ +\ A_{y-1}\ =\ P $
- $ A_y\ +\ A_{y+1}\ +\ \ldots\ +\ A_{z-1}\ =\ Q $
- $ A_z\ +\ A_{z+1}\ +\ \ldots\ +\ A_{w-1}\ =\ R $

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ P $ $ Q $ $ R $ $ A_0 $ $ A_1 $ $ \ldots $ $ A_{N-1} $

## 输出格式

条件を満たす組が存在するなら `Yes`、存在しないなら `No` を出力せよ。

## 说明/提示

### 制約

- $ 3\ \leq\ N\ \leq\ 2\times\ 10^5 $
- $ 1\ \leq\ A_i\ \leq\ 10^9 $
- $ 1\ \leq\ P,Q,R\ \leq\ 10^{15} $
- 入力に含まれる値は全て整数である

### Sample Explanation 1

$ (x,y,z,w)=(1,3,6,8) $ が条件を満たします。

## 样例 #1

### 输入

```
10 5 7 5
1 3 2 2 2 3 1 4 3 2
```

### 输出

```
Yes
```

## 样例 #2

### 输入

```
9 100 101 100
31 41 59 26 53 58 97 93 23
```

### 输出

```
No
```

## 样例 #3

### 输入

```
7 1 1 1
1 1 1 1 1 1 1
```

### 输出

```
Yes
```



---

---
title: "[ABC266C] Convex Quadrilateral"
layout: "post"
diff: 普及/提高-
pid: AT_abc266_c
tag: []
---

# [ABC266C] Convex Quadrilateral

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc266/tasks/abc266_c

$ 2 $ 次元座標平面があります。$ x $ 軸正方向を右向き、$ y $ 軸正方向を上向きとします。

この平面上に自己交差のない四角形があります。  
 $ 4 $ つの頂点の座標は反時計回りに $ (A_x,A_y),(B_x,B_y),(C_x,C_y),(D_x,D_y) $ です。

この四角形が凸であるか判定してください。

なお、四角形の $ 4 $ つの内角が全て $ 180 $ 度未満であるとき、かつ、その時に限り、その四角形は凸であるといいます。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ A_x $ $ A_y $ $ B_x $ $ B_y $ $ C_x $ $ C_y $ $ D_x $ $ D_y $

## 输出格式

与えられる四角形が凸なら `Yes`、凸でないなら `No` を出力せよ。

## 说明/提示

### 制約

- $ -100\ \leq\ A_x,A_y,B_x,B_y,C_x,C_y,D_x,D_y\ \leq\ 100 $
- 入力に含まれる値は全て整数である
- 与えられる $ 4 $ 点は四角形の $ 4 $ 頂点を反時計回りに並べたものである
- 与えられる $ 4 $ 点のなす四角形は自己交差がなく退化していない。すなわち
  - どの $ 2 $ 頂点も同じ座標にない
  - どの $ 3 $ 頂点も同一直線上にない
  - 隣接しない $ 2 $ 辺は共有点を持たない

### Sample Explanation 1

与えられた四角形は正方形であり、$ 4 $ つの内角は全て $ 90 $ 度です。したがって、この四角形は凸です。 !\[図\](https://img.atcoder.jp/abc266/cda66d9b9f4291781d1ce47f59f29ab0.png)

### Sample Explanation 2

角 $ A $ が $ 270 $ 度です。したがって、この四角形は凸ではありません。 !\[図\](https://img.atcoder.jp/abc266/2927f9f67e2cb7c35aeab05269b6fcc2.png)

## 样例 #1

### 输入

```
0 0

1 0

1 1

0 1
```

### 输出

```
Yes
```

## 样例 #2

### 输入

```
0 0

1 1

-1 0

1 -1
```

### 输出

```
No
```



---

---
title: "[ABC266D] Snuke Panic (1D)"
layout: "post"
diff: 普及/提高-
pid: AT_abc266_d
tag: []
---

# [ABC266D] Snuke Panic (1D)

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc266/tasks/abc266_d

高橋君はすぬけ君たちを捕まえようとしています。

数直線上の座標 $ 0,1,2,3,4 $ の $ 5 $ 箇所に穴があり、すぬけ君たちの巣につながっています。

これから $ N $ 匹のすぬけ君が穴から出てきます。$ i $ 番目のすぬけ君は時刻 $ T_i $ に座標 $ X_i $ の穴から出てきて、大きさは $ A_i $ であることがわかっています。

高橋君は時刻 $ 0 $ に座標 $ 0 $ におり、数直線上を単位時間あたり $ 1 $ 以下の速さで移動することができます。  
すぬけ君が穴から出てきたのと同じ時刻に同じ座標に高橋君がいるとき、かつ、そのときに限り、高橋君はすぬけ君を捕まえることができます。  
すぬけ君を捕まえるのにかかる時間は無視できます。

高橋君が適切に行動したとき、捕まえることができるすぬけ君の大きさの合計の最大値を求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ T_1 $ $ X_1 $ $ A_1 $ $ T_2 $ $ X_2 $ $ A_2 $ $ \vdots $ $ T_N $ $ X_N $ $ A_N $

## 输出格式

答えを整数として出力せよ。

## 说明/提示

### 制約

- $ 1\ \leq\ N\ \leq\ 10^5 $
- $ 0\ <\ T_1\ <\ T_2\ <\ \ldots\ <\ T_N\ \leq\ 10^5 $
- $ 0\ \leq\ X_i\ \leq\ 4 $
- $ 1\ \leq\ A_i\ \leq\ 10^9 $
- 入力に含まれる値は全て整数である

### Sample Explanation 1

次のように行動するのが最適です。 - 座標 $ 0 $ で待機し、時刻 $ 1 $ に $ 1 $ 番目のすぬけ君を捕まえる - 座標 $ 4 $ へ移動し、時刻 $ 5 $ に $ 3 $ 番目のすぬけ君を捕まえる $ 1 $ 番目と $ 2 $ 番目のすぬけ君を両方とも捕まえることはできないので、これが最大です。

### Sample Explanation 2

高橋君はすぬけ君を $ 1 $ 匹も捕まえることができません。

## 样例 #1

### 输入

```
3
1 0 100
3 3 10
5 4 1
```

### 输出

```
101
```

## 样例 #2

### 输入

```
3
1 4 1
2 4 1
3 4 1
```

### 输出

```
0
```

## 样例 #3

### 输入

```
10
1 4 602436426
2 1 623690081
3 3 262703497
4 4 628894325
5 3 450968417
6 1 161735902
7 1 707723857
8 2 802329211
9 0 317063340
10 2 125660016
```

### 输出

```
2978279323
```



---

---
title: "[ABC266E] Throwing the Die"
layout: "post"
diff: 普及/提高-
pid: AT_abc266_e
tag: []
---

# [ABC266E] Throwing the Die

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc266/tasks/abc266_e

サイコロを使ったゲームをします。ゲームは最大 $ N $ 回のターンからなり、各ターンは次のように進行します。

- $ 1,\ldots,6 $ の目が等確率で出る $ 6 $ 面ダイスを振り、出目を $ X $ とする(出目は各ターンで独立とする)。
- 現在が $ N $ ターン目なら、**スコア** を $ X $ とし、ゲームを終了する。
- そうでないとき、ゲームを続行するか終了するか選択する。
  - ゲームを終了する場合、スコアを $ X $ とし、残りのターンは行わずにゲームを終了する。

スコアの期待値が最大になるように行動したとき、スコアの期待値を求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $

## 输出格式

答えを出力せよ。  
 なお、真の解との絶対誤差または相対誤差が $ 10^{-6} $ 以下であれば正解として扱われる。

## 说明/提示

### 制約

- $ 1\ \leq\ N\ \leq\ 100 $

## 样例 #1

### 输入

```
1
```

### 输出

```
3.5000000000
```

## 样例 #2

### 输入

```
2
```

### 输出

```
4.2500000000
```

## 样例 #3

### 输入

```
10
```

### 输出

```
5.6502176688
```



---

---
title: "[ABC267D] Index × A(Not Continuous ver.)"
layout: "post"
diff: 普及/提高-
pid: AT_abc267_d
tag: []
---

# [ABC267D] Index × A(Not Continuous ver.)

## 题目描述

有一个长度为 $N$ 整数数列 $A=(A_1,A_2,...,A_N)$ 。

现在假设有一个长度为 $M$ 的序列 $B$ ,并且 $B$ 是 $A$ 的**子序列**。请找到 $\sum_{i=1}^M i\times B_i$ 的最大值。

## 输入格式

输入按照下面的标准格式给出：

> $ N\ M \newline A_1 \ A_2 \ \dots\  A_N $

## 输出格式

一个整数，表示$\sum_{i=1}^M i\times B_i$ 的最大值。

## 说明/提示

#### 注意事项
若序列 $S$ 是长度为 $L$ 的数列 $T$ 的**子序列**，则 $S$ 是数列 $T$ 删除任意 $i\ (i\in [0,L])$ 个元素得到的。

比如说， $(10,30)$ 是 $(10,20,30)$ 的字串，但是 $(20,10)$ 不是。


+ $1\le M\le N\le 2000$
+ $-2\times 10^5\le A_i\le 2\times 10^5$
+ 所有输入数据均为整数

#### 样例解释
对于**样例一**，当 $B=(A_1,A_4)$ 时，$\sum_{i=1}^M i\times B_i=1\times 5+2\times 8=21$ 。因为不可能达到 $22$ 或者更大的值，所以答案是 $21$ 。

## 样例 #1

### 输入

```
4 2

5 4 -1 8
```

### 输出

```
21
```

## 样例 #2

### 输入

```
10 4

-3 1 -4 1 -5 9 -2 6 -5 3
```

### 输出

```
54
```



---

---
title: "[ABC269E] Last Rook"
layout: "post"
diff: 普及/提高-
pid: AT_abc269_e
tag: []
---

# [ABC269E] Last Rook

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc269/tasks/abc269_e

**この問題はインタラクティブな問題**（あなたの作成したプログラムとジャッジプログラムが入出力を介して対話を行う形式の問題）です。

縦横 $ N $ マスのチェス盤と $ N $ 個のルークの駒があります。以下では上から $ i $ 行目、左から $ j $ 列目のマスを $ (i,\ j) $ と表します。  
 チェス盤のマスにルークを置くことを考えます。ただし、あなたは次の条件をすべて満たすようにルークをチェス盤に置く必要があります。

- 1 つの行に $ 2 $ 個以上のルークが存在しない。
- 1 つの列に $ 2 $ 個以上のルークが存在しない。

今、チェス盤に $ N-1 $ 個のルークが上の条件をすべて満たした状態で置かれています。あなたはルークが置かれていないマスを 1 つ選び、そのマスにルークを置くことにしました。(上の条件をすべて満たすようにルークを置くことができるマスは少なくとも 1 つ以上存在することが証明できます。)

ただし、あなたはチェス盤のどのマスにルークが置かれているかを直接知ることはできません。  
 そのかわりに、ジャッジシステムに対して以下の質問を $ 20 $ 回まで行うことができます。

- 整数 $ A,\ B,\ C,\ D $ を $ 1\ \leq\ A\ \leq\ B\ \leq\ N,\ 1\ \leq\ C\ \leq\ D\ \leq\ N $ を満たすように選ぶ。そして、$ A\ \leq\ i\ \leq\ B,\ C\ \leq\ j\ \leq\ D $ を満たすマス $ (i,\ j) $ からなる長方形領域に置かれているルークの個数を聞く。

ルークを置くことができるマスを見つけてください。

### Input &amp; Output Format

この問題はインタラクティブな問題（あなたの作成したプログラムとジャッジプログラムが入出力を介して対話を行う形式の問題）です。

最初に、チェス盤のサイズ $ N $ を標準入力から受け取ってください。

> $ N $

次に、ルークを置くことができるマスが見つかるまで質問を繰り返してください。  
 質問は、以下の形式で標準出力に出力してください。

> $ ? $ $ A $ $ B $ $ C $ $ D $

これに対する応答は、次の形式で標準入力から与えられます。

> $ T $

ここで、$ T $ は質問に対する答えです。ただし、不正な質問を行った、あるいは質問の回数が $ 20 $ 回を超えた場合は $ T $ は `-1` となります。

ジャッジが `-1` を返した場合、提出はすでに不正解とみなされています。この場合、ただちにプログラムを終了してください。

ルークを置くことができるマスを見つけたら、そのマスを $ (X,\ Y) $ として、解答を以下の形式で出力してください。その後、ただちにプログラムを終了してください。

> $ ! $ $ X $ $ Y $

答えが複数ある場合、どれを出力しても正解とみなされます。

## 说明/提示

### 制約

- $ 2\ \leq\ N\ \leq\ 10^3 $
- $ N $ は整数

### 注意点

- **出力を行うたびに、末尾に改行を入れて標準出力を flush してください。そうしなかった場合、ジャッジ結果が TLE となる可能性があります。**
- **対話の途中で不正な出力を行った場合のジャッジ結果は不定です。**
- 解答を出力したらただちにプログラムを終了してください。そうしない場合、ジャッジ結果は不定です。

### 入出力例

以下は、$ N=3 $ で $ (1,\ 2),\ (2,\ 1) $ にルークが置かれている場合の入出力例です。

 入力 出力 説明 `3`  まず整数 $ N $ が与えられます。  `? 1 2 1 3`  $ (A,B,C,D)=(1,2,1,3) $ として質問を行います。 `2`  質問の答えは $ 2 $ なので、ジャッジはその値を返します。  `? 2 3 1 1` $ (A,B,C,D)=(2,3,1,1) $ として質問を行います。 `1`  質問の答えは $ 1 $ なので、ジャッジはその値を返します。  `? 1 3 3 3` $ (A,B,C,D)=(1,3,3,3) $ として質問を行います。 `0`  質問の答えは $ 0 $ なので、ジャッジはその値を返します。  `! 3 3` 答えは $ (3,\ 3) $ だとわかったので、それを出力します。



---

---
title: "[ABC270E] Apple Baskets on Circle"
layout: "post"
diff: 普及/提高-
pid: AT_abc270_e
tag: []
---

# [ABC270E] Apple Baskets on Circle

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc270/tasks/abc270_e

$ 1,2,\ldots,N $ の番号がついた $ N $ 個のかごが円状に置かれています。  
 $ 1\leq\ i\ \leq\ N-1 $ についてかご $ i $ の右隣にはかご $ i+1 $ があり、かご $ N $ の右隣にはかご $ 1 $ があります。

かご $ i $ の中には $ A_i $ 個りんごが入っています。

高橋君は最初かご $ 1 $ の前におり、以下の行動を繰り返します。

- 目の前にあるかごの中にりんごがあれば $ 1 $ 個かごから取り出して食べる。その後、りんごを食べたかどうかにかかわらず、右隣のかごの前に移動する。

高橋君がちょうど $ K $ 個のりんごを食べた時点で、各かごの中に残っているりんごの個数を求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ K $ $ A_1 $ $ A_2 $ $ \ldots $ $ A_N $

## 输出格式

$ N $ 個の整数を空白区切りで出力せよ。  
 $ i $ 番目には、高橋君がちょうど $ K $ 個のりんごを食べた時点で、かご $ i $ の中に残っているりんごの個数を出力せよ。

## 说明/提示

### 制約

- $ 1\ \leq\ N\ \leq\ 10^5 $
- $ 0\ \leq\ A_i\ \leq\ 10^{12} $
- $ 1\ \leq\ K\ \leq\ 10^{12} $
- りんごは全部で $ K $ 個以上ある。すなわち、$ \sum_{i=1}^{N}A_i\geq\ K $
- 入力に含まれる値は全て整数である

### Sample Explanation 1

高橋君は次のように行動します。 - 目の前にあるかご $ 1 $ の中にりんごがあるので $ 1 $ 個かごから取り出して食べる。その後、かご $ 2 $ の前に移動する。この時点で各かごの中のりんごの個数は $ (0,3,0) $ である。 - 目の前にあるかご $ 2 $ の中にりんごがあるので $ 1 $ 個かごから取り出して食べる。その後、かご $ 3 $ の前に移動する。この時点で各かごの中のりんごの個数は $ (0,2,0) $ である。 - 目の前にあるかご $ 3 $ の中にりんごはない。かご $ 1 $ の前に移動する。この時点で各かごの中のりんごの個数は $ (0,2,0) $ である。 - 目の前にあるかご $ 1 $ の中にりんごはない。かご $ 2 $ の前に移動する。この時点で各かごの中のりんごの個数は $ (0,2,0) $ である。 - 目の前にあるかご $ 2 $ の中にりんごがあるので $ 1 $ 個かごから取り出して食べる。その後、かご $ 3 $ の前に移動する。この時点で各かごの中のりんごの個数は $ (0,1,0) $ である。

## 样例 #1

### 输入

```
3 3

1 3 0
```

### 输出

```
0 1 0
```

## 样例 #2

### 输入

```
2 1000000000000

1000000000000 1000000000000
```

### 输出

```
500000000000 500000000000
```



---

---
title: "[ABC271C] Manga"
layout: "post"
diff: 普及/提高-
pid: AT_abc271_c
tag: []
---

# [ABC271C] Manga

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc271/tasks/abc271_c

高橋君は全 $ 10^9 $ 巻の漫画『すぬけ君』を読むことにしました。  
 初め、高橋君は『すぬけ君』の単行本を $ N $ 冊持っています。$ i $ 番目の単行本は $ a_i $ 巻です。

高橋君は『すぬけ君』を**読み始める前に限り**次の操作を $ 0 $ 回以上何度でも繰り返せます。

- 現在持っている単行本が $ 1 $ 冊以下の場合、何もしない。そうでない場合、現在持っている単行本から $ 2 $ 冊を選んで売り、代わりに好きな巻を選んで $ 1 $ 冊買う

その後、高橋君は『すぬけ君』を $ 1 $ 巻、$ 2 $ 巻、$ 3 $ 巻、$ \ldots $ と順番に読みます。ただし、次に読むべき巻を持っていない状態になった場合、(他の巻を持っているかどうかに関わらず)その時点で『すぬけ君』を読むのをやめます。

高橋君が『すぬけ君』を最大で何巻まで読めるかを求めてください。ただし、$ 1 $ 巻を読めない場合の答えは $ 0 $ とします。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ a_1 $ $ \ldots $ $ a_N $

## 输出格式

答えを出力せよ。

## 说明/提示

### 制約

- $ 1\ \leq\ N\ \leq\ 3\ \times\ 10^5 $
- $ 1\ \leq\ a_i\ \leq\ 10^9 $
- 入力はすべて整数

### Sample Explanation 1

『すぬけ君』を読み始める前に「$ 7 $ 巻と $ 271 $ 巻を選んで売り、代わりに $ 3 $ 巻を選んで $ 1 $ 冊買う」という内容で操作をすると、高橋君は $ 1 $ 巻、$ 2 $ 巻、$ 3 $ 巻、$ 4 $ 巻、$ 6 $ 巻を $ 1 $ 冊ずつ持っている状態になります。 この状態から『すぬけ君』を読み始めると、高橋君は $ 1 $ 巻、$ 2 $ 巻、$ 3 $ 巻、$ 4 $ 巻を読み、続いて $ 5 $ 巻を読もうとしますが持っていないためこの時点で『すぬけ君』を読むのをやめます。 操作の方法を変えても $ 5 $ 巻を読むことは出来ないため、$ 4 $ が答えです。

### Sample Explanation 2

高橋君は同じ巻を $ 2 $ 冊以上持っているかもしれません。 この入力に対しては以下のように $ 4 $ 回操作をしてから『すぬけ君』を読み始めることで $ 5 $ 巻まで読むことが出来、これが最大です。 - $ 1 $ 巻を $ 2 $ 冊選んで売り、代わりに $ 2 $ 巻を選んで $ 1 $ 冊買う - $ 1 $ 巻を $ 2 $ 冊選んで売り、代わりに $ 3 $ 巻を選んで $ 1 $ 冊買う - $ 1 $ 巻を $ 2 $ 冊選んで売り、代わりに $ 4 $ 巻を選んで $ 1 $ 冊買う - $ 1 $ 巻を $ 2 $ 冊選んで売り、代わりに $ 5 $ 巻を選んで $ 1 $ 冊買う

### Sample Explanation 3

高橋君は $ 1 $ 巻を読めません。

## 样例 #1

### 输入

```
6

1 2 4 6 7 271
```

### 输出

```
4
```

## 样例 #2

### 输入

```
10

1 1 1 1 1 1 1 1 1 1
```

### 输出

```
5
```

## 样例 #3

### 输入

```
1

5
```

### 输出

```
0
```



---

---
title: "[ABC272D] Root M Leaper"
layout: "post"
diff: 普及/提高-
pid: AT_abc272_d
tag: []
---

# [ABC272D] Root M Leaper

## 题目描述

有一个大小为 $N\times N$ 的方格图（网格）。在本题中，我们所说的方格 $(i,j)$ 指网格从上往下数第 $i$ 行，从左往右数第 $j$ 列。

最开始，有一个棋子位于方格 $(1,1)$ 。现在你可以进行下面这个操作若干次：

+ 当前棋子位于 $(i,j)$ ，那么移动它到一个距离它刚好 $\sqrt{M}$ 的点（不超出网格）。

本题中的“**距离**”，指欧几里得距离。即方格 $(i,j)$ 与 $(k,l)$ 的距离是 $\sqrt{(i-k)^2+(j-l)^2}$ 。

现在对于整个网格，请你确定棋子能否到达方格 $(i,j)$ 。如果可以，输出到达它的最少操作次数；如果不行，输出 ```-1``` 。

## 输入格式

输入两个正整数 $N$ ， $M$ 。
>$N\ M$

## 输出格式

输出共 $N$ 行。 第 $i$ 行包含 $N$ 个整数，中间以一个空格隔开。如果棋子可以到达方格 $(i,j)$ ，第 $i$ 行第 $j$ 列应输出到达它的最少操作次数；如果不行，输出 ```-1``` 。

## 说明/提示

- $ 1\ \le\ N\ \le\ 400 $
- $ 1\ \le\ M\ \le\ 10^6 $
- 输入全为整数


对于**样例1**，你可以把棋子通过一定次数的操作挪到这个方格图的任意位置。

比如说，我们可以通过如下操作把棋子移到 $(2,2)$ ：

1. 开始棋子在 $(1,1)$ 。 $(1,1)$ 到 $(1,2)$ 的距离刚好是 $\sqrt 1$ ，所以我们把它移到 $(1,2)$ 。
1. 现在棋子在 $(1,2)$ 了。$(1,2)$ 到 $(2,2)$的距离也刚好是 $\sqrt 1$ ，所以我们就把它移到了 $(2,2)$ 。

## 样例 #1

### 输入

```
3 1
```

### 输出

```
0 1 2

1 2 3

2 3 4
```

## 样例 #2

### 输入

```
10 5
```

### 输出

```
0 3 2 3 2 3 4 5 4 5

3 4 1 2 3 4 3 4 5 6

2 1 4 3 2 3 4 5 4 5

3 2 3 2 3 4 3 4 5 6

2 3 2 3 4 3 4 5 4 5

3 4 3 4 3 4 5 4 5 6

4 3 4 3 4 5 4 5 6 5

5 4 5 4 5 4 5 6 5 6

4 5 4 5 4 5 6 5 6 7

5 6 5 6 5 6 5 6 7 6
```



---

---
title: "[ABC273D] LRUD Instructions"
layout: "post"
diff: 普及/提高-
pid: AT_abc273_d
tag: []
---

# [ABC273D] LRUD Instructions

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc273/tasks/abc273_d

$ H $ 行 $ W $ 列のグリッドがあります。上から $ i $ 行目、左から $ j $ 列目にあるマスをマス $ (i,\ j) $ で表します。  
 $ N $ 個のマス $ (r_1,\ c_1),\ (r_2,\ c_2),\ \ldots,\ (r_N,\ c_N) $ は壁になっています。

はじめ、高橋君はマス $ (r_\mathrm{s},\ c_\mathrm{s}) $ にいます。

高橋君に $ Q $ 個の指示が与えられます。 $ i\ =\ 1,\ 2,\ \ldots,\ Q $ について、$ i $ 番目の指示は文字 $ d_i $ と正整数 $ l_i $ の組で表されます。$ d_i $ は `L` 、`R` 、`U` 、`D` のいずれかの文字であり、それぞれ左、右、上、下の方向を表します。

$ i $ 番目の指示に対して高橋君は下記の行動を $ l_i $ 回繰り返します。

> 現在いるマスに対して、$ d_i $ が表す向きに壁のないマスが隣接しているなら、そのマスに移動する。 そのようなマスが存在しない場合は、何もしない。

$ i\ =\ 1,\ 2,\ \ldots,\ Q $ について、$ i $ 番目までの指示を実行した直後に高橋君がいるマスを出力してください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ H $ $ W $ $ r_\mathrm{s} $ $ c_\mathrm{s} $ $ N $ $ r_1 $ $ c_1 $ $ r_2 $ $ c_2 $ $ \vdots $ $ r_N $ $ c_N $ $ Q $ $ d_1 $ $ l_1 $ $ d_2 $ $ l_2 $ $ \vdots $ $ d_Q $ $ l_Q $

## 输出格式

$ Q $ 行出力せよ。 下記の形式にしたがい、$ i\ =\ 1,\ 2,\ \ldots,\ Q $ について、$ i $ 番目までの指示を実行した直後に高橋君がいるマス $ (R_i,\ C_i) $ を $ i $ 行目に出力せよ。

> $ R_1 $ $ C_1 $ $ R_2 $ $ C_2 $ $ \vdots $ $ R_Q $ $ C_Q $

## 说明/提示

### 制約

- $ 2\ \leq\ H,\ W\ \leq\ 10^9 $
- $ 1\ \leq\ r_\mathrm{s}\ \leq\ H $
- $ 1\ \leq\ c_\mathrm{s}\ \leq\ W $
- $ 0\ \leq\ N\ \leq\ 2\ \times\ 10^5 $
- $ 1\ \leq\ r_i\ \leq\ H $
- $ 1\ \leq\ c_i\ \leq\ W $
- $ i\ \neq\ j\ \Rightarrow\ (r_i,\ c_i)\ \neq\ (r_j,\ c_j) $
- すべての $ i\ =\ 1,\ 2,\ \ldots,\ N $について、$ (r_\mathrm{s},\ c_\mathrm{s})\ \neq\ (r_i,\ c_i) $
- $ 1\ \leq\ Q\ \leq\ 2\ \times\ 10^5 $
- $ d_i $ は `L` 、`R` 、`U` 、`D` のいずれかの文字
- $ 1\ \leq\ l_i\ \leq\ 10^9 $
- $ d_i $ 以外の入力値は整数

### Sample Explanation 1

与えられるグリッドと高橋君の初期位置は下記の通りです。 ここで、`#` は壁のマスを、`T` は高橋君がいるマスを表し、`.` がその他のマスを表します。 ``` ...#. .#... ..... ...T. ..#.. ``` $ 1 $ つ目の指示に対して高橋君は、左に $ 2 $ マス移動し、高橋君の位置は下記の通り、マス $ (4,\ 2) $ になります。 ``` ...#. .#... ..... .T... ..#.. ``` $ 2 $ つ目の指示に対して高橋君は、上に $ 1 $ マスに移動した後、次の移動先が壁であるために「何もしない」を $ 2 $ 回行います。その結果、高橋君の位置は下記の通り、マス $ (3,\ 2) $ になります。 ``` ...#. .#... .T... ..... ..#.. ``` $ 3 $ つ目の指示に対して高橋君は、左に $ 1 $ マス移動した後、次の移動先となるマスが存在しないために「何もしない」を $ 1 $ 回行います。その結果、高橋君の位置は下記の通り、マス $ (3,\ 1) $ になります。 ``` ...#. .#... T.... ..... ..#.. ``` $ 4 $ つ目の指示に対して高橋君は、右に $ 4 $ マス移動し、高橋君の位置は下記の通り、マス $ (3,\ 5) $ になります。 ``` ...#. .#... ....T ..... ..#.. ```

## 样例 #1

### 输入

```
5 5 4 4

3

5 3

2 2

1 4

4

L 2

U 3

L 2

R 4
```

### 输出

```
4 2

3 2

3 1

3 5
```

## 样例 #2

### 输入

```
6 6 6 3

7

3 1

4 3

2 6

3 4

5 5

1 1

3 2

10

D 3

U 3

L 2

D 2

U 3

D 3

U 3

R 3

L 3

D 1
```

### 输出

```
6 3

5 3

5 1

6 1

4 1

6 1

4 1

4 2

4 1

5 1
```



---

---
title: "[ABC274D] Robot Arms 2"
layout: "post"
diff: 普及/提高-
pid: AT_abc274_d
tag: []
---

# [ABC274D] Robot Arms 2

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc274/tasks/abc274_d

長さ $ N $ の正整数列 $ A\ =\ (A_1,\ A_2,\ \dots,\ A_N) $ および整数 $ x,\ y $ が与えられます。  
次の条件をすべて満たすように、$ xy $ 座標平面上に $ N+1 $ 個の点 $ p_1,\ p_2,\ \dots,\ p_N,\ p_{N+1} $ を配置することができるか判定してください。(同じ座標に $ 2 $ 個以上の点を配置してもよいです。)

- $ p_1\ =\ (0,\ 0) $
- $ p_2\ =\ (A_1,\ 0) $
- $ p_{N+1}\ =\ (x,\ y) $
- 点 $ p_i $ と点 $ p_{i+1} $ の距離は $ A_i $ ($ 1\ \leq\ i\ \leq\ N $)
- 線分 $ p_i\ p_{i+1} $ と線分 $ p_{i+1}\ p_{i+2} $ のなす角は $ 90 $ 度 ($ 1\ \leq\ i\ \leq\ N\ -\ 1 $)

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ x $ $ y $ $ A_1 $ $ A_2 $ $ \dots $ $ A_N $

## 输出格式

問題文の条件をすべて満たすように $ p_1,\ p_2,\ \dots,\ p_N,\ p_{N+1} $ を配置することができる場合は `Yes` を、そうでない場合は `No` を出力せよ。

## 说明/提示

### 制約

- $ 2\ \leq\ N\ \leq\ 10^3 $
- $ 1\ \leq\ A_i\ \leq\ 10 $
- $ |x|,\ |y|\ \leq\ 10^4 $
- 入力される値はすべて整数

### Sample Explanation 1

$ xy $ 座標平面に $ p_1\ =\ (0,\ 0),\ p_2\ =\ (2,\ 0),\ p_3\ =\ (2,\ 1),\ p_4\ =\ (-1,\ 1) $ として点を配置したのが以下の図です。これは問題文の条件をすべて満たしています。 !\[\](https://img.atcoder.jp/ghi/9e66a2e8cd081f011d3baba22dbe64fa.jpg)

### Sample Explanation 2

$ p_1\ =\ (0,\ 0),\ p_2\ =\ (2,\ 0),\ p_3\ =\ (2,\ 2),\ p_4\ =\ (0,\ 2),\ p_5\ =\ (0,\ 0),\ p_6\ =\ (2,\ 0) $ とすれば問題文の条件をすべて満たすことができます。同じ座標に複数の点を置いてもよいのに注意してください。

## 样例 #1

### 输入

```
3 -1 1
2 1 3
```

### 输出

```
Yes
```

## 样例 #2

### 输入

```
5 2 0
2 2 2 2 2
```

### 输出

```
Yes
```

## 样例 #3

### 输入

```
4 5 5
1 2 3 4
```

### 输出

```
No
```

## 样例 #4

### 输入

```
3 2 7
2 7 4
```

### 输出

```
No
```

## 样例 #5

### 输入

```
10 8 -7
6 10 4 1 5 9 8 6 5 1
```

### 输出

```
Yes
```



---

---
title: "[ABC275C] Counting Squares"
layout: "post"
diff: 普及/提高-
pid: AT_abc275_c
tag: []
---

# [ABC275C] Counting Squares

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc275/tasks/abc275_c

二次元平面があります。$ 1 $ 以上 $ 9 $ 以下の整数 $ r,c $ について、$ S_{r} $ の $ c $ 番目の文字が `#` であるとき座標 $ (r,c) $ にポーンが置いてあり、$ S_{r} $ の $ c $ 番目の文字が `.` であるとき座標 $ (r,c) $ に何も置かれていません。

この平面上の正方形であって、$ 4 $ 頂点全てにポーンが置いてあるものの個数を求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ S_1 $ $ S_2 $ $ \vdots $ $ S_9 $

## 输出格式

答えを出力せよ。

## 说明/提示

### 制約

- $ S_1,\ldots,S_9 $ はそれぞれ `#` と `.` からなる長さ $ 9 $ の文字列

### Sample Explanation 1

座標 $ (1,1),(1,2),(2,2),(2,1) $ を頂点とする正方形は、$ 4 $ 頂点全てにポーンが置かれています。 座標 $ (4,8),(5,6),(7,7),(6,9) $ を頂点とする正方形も、$ 4 $ 頂点全てにポーンが置かれています。 よって答えは $ 2 $ です。

## 样例 #1

### 输入

```
##.......
##.......
.........
.......#.
.....#...
........#
......#..
.........
.........
```

### 输出

```
2
```

## 样例 #2

### 输入

```
.#.......
#.#......
.#.......
.........
....#.#.#
.........
....#.#.#
........#
.........
```

### 输出

```
3
```



---

---
title: "[ABC275E] Sugoroku 4"
layout: "post"
diff: 普及/提高-
pid: AT_abc275_e
tag: []
---

# [ABC275E] Sugoroku 4

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc275/tasks/abc275_e

高橋君は双六で遊んでいます。

この双六には $ 0 $ から $ N $ の番号がついた $ N+1 $ 個のマスがあります。 高橋君はマス $ 0 $ からスタートし、マス $ N $ を目指します。

この双六では、$ 1 $ から $ M $ までの $ M $ 種類の目が等確率で出るルーレットを使います。 高橋君はルーレットを回して出た目の数だけ進みます。もし、マス $ N $ を超えて進むことになる場合、マス $ N $ を超えた分だけ引き返します。

例えば、 $ N=4 $ で高橋君がマス $ 3 $ にいるとき、ルーレットを回して出た目が $ 4 $ の場合は、マス $ 4 $ を $ 3+4-4=3 $ マス超えてしまいます。そのため、 $ 3 $ マスだけマス $ 4 $ から引き返し、マス $ 1 $ に移動します。

高橋君がマス $ N $ に到達するとゴールとなり、双六を終了します。

高橋君がルーレットを $ K $ 回まで回す時、ゴールできる確率を $ \text{mod\ }\ 998244353 $ で求めてください。

 確率 $ \text{mod\ }\ 998244353 $ の定義この問題で求める確率は必ず有理数になることが証明できます。 また、この問題の制約下では、求める確率を既約分数 $ \frac{y}{x} $ で表したときに $ x $ が $ 998244353 $ で割り切れないことが保証されます。

このとき $ xz\ \equiv\ y\ \pmod{998244353} $ を満たすような $ 0 $ 以上 $ 998244352 $ 以下の整数 $ z $ が一意に定まります。この $ z $ を答えてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ M $ $ K $

## 输出格式

答えを出力せよ。

## 说明/提示

### 制約

- $ M\ \leq\ N\ \leq\ 1000 $
- $ 1\ \leq\ M\ \leq\ 10 $
- $ 1\ \leq\ K\ \leq\ 1000 $
- 入力は全て整数

### Sample Explanation 1

$ 1 $ 回ルーレットを回してゴールできるのは、ルーレットで $ 2 $ が出るときです。よってゴールできる確率は $ \frac{1}{2} $ です。 このとき、$ 2\times\ 499122177\ \equiv\ 1\ \pmod{998244353} $ が成り立つので、答えとして $ 499122177 $ を出力してください。

## 样例 #1

### 输入

```
2 2 1
```

### 输出

```
499122177
```

## 样例 #2

### 输入

```
10 5 6
```

### 输出

```
184124175
```

## 样例 #3

### 输入

```
100 1 99
```

### 输出

```
0
```



---

---
title: "[ABC276D] Divide by 2 or 3"
layout: "post"
diff: 普及/提高-
pid: AT_abc276_d
tag: []
---

# [ABC276D] Divide by 2 or 3

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc276/tasks/abc276_d

正整数列 $ A=(a_1,a_2,\ldots,a_N) $ が与えられます。  
 あなたは以下の操作のうち $ 1 $ つを選んで行うことを $ 0 $ 回以上何度でも繰り返せます。

- $ 1\ \leq\ i\ \leq\ N $ かつ $ a_i $ が $ 2 $ の倍数であるような整数 $ i $ を選び、$ a_i $ を $ \frac{a_i}{2} $ に置き換える
- $ 1\ \leq\ i\ \leq\ N $ かつ $ a_i $ が $ 3 $ の倍数であるような整数 $ i $ を選び、$ a_i $ を $ \frac{a_i}{3} $ に置き換える

あなたの目標は $ A $ が $ a_1=a_2=\ldots=a_N $ を満たす状態にすることです。  
 目標を達成するために必要な操作の回数の最小値を求めてください。ただし、どのように操作を行っても目標を達成できない場合、代わりに `-1` と出力してください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ a_1 $ $ a_2 $ $ \ldots $ $ a_N $

## 输出格式

答えを出力せよ。

## 说明/提示

### 制約

- $ 2\ \leq\ N\ \leq\ 1000 $
- $ 1\ \leq\ a_i\ \leq\ 10^9 $
- 入力はすべて整数

### Sample Explanation 1

次のように操作をすると $ 3 $ 回で目標を達成でき、これが最小の回数です。 - $ a_i $ が $ 2 $ の倍数であるような整数 $ i $ として $ 2 $ を選び、$ a_2 $ を $ \frac{a_2}{2} $ に置き換える。$ A $ は $ (1,2,3) $ となる。 - $ a_i $ が $ 2 $ の倍数であるような整数 $ i $ として $ 2 $ を選び、$ a_2 $ を $ \frac{a_2}{2} $ に置き換える。$ A $ は $ (1,1,3) $ となる。 - $ a_i $ が $ 3 $ の倍数であるような整数 $ i $ として $ 3 $ を選び、$ a_3 $ を $ \frac{a_3}{3} $ に置き換える。$ A $ は $ (1,1,1) $ となる。

### Sample Explanation 2

どのように操作を行っても目標を達成できません。

## 样例 #1

### 输入

```
3

1 4 3
```

### 输出

```
3
```

## 样例 #2

### 输入

```
3

2 7 6
```

### 输出

```
-1
```

## 样例 #3

### 输入

```
6

1 1 1 1 1 1
```

### 输出

```
0
```



---

---
title: "[ABC276E] Round Trip"
layout: "post"
diff: 普及/提高-
pid: AT_abc276_e
tag: []
---

# [ABC276E] Round Trip

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc276/tasks/abc276_e

縦 $ H $ 行、横 $ W $ 列のマス目があり、上から $ i\ \,\ (1\ \leq\ i\ \leq\ H) $ 行目、左から $ j\ \,\ (1\ \leq\ j\ \leq\ W) $ 列目のマスを $ (i,\ j) $ と表します。

各マスは「始点」「道」「障害物」のいずれかです。  
マス $ (i,\ j) $ の状態は文字 $ C_{i,\ j} $ で表され、$ C_{i,\ j}\ = $ `S` なら始点、$ C_{i,\ j}\ = $ `.` なら道、$ C_{i,\ j}\ = $ `#` なら障害物です。始点のマスはただ一つ存在します。

始点のマスを出発し、上下または左右に隣接するマスに移動することを繰り返して、障害物のマスを通らずに始点のマスへ戻ってくるような長さ $ 4 $ 以上の経路であって、最初と最後を除き同じマスを通らないようなものが存在するか判定してください。  
より厳密には、以下の条件を満たす整数 $ n $ およびマスの列 $ (x_0,\ y_0),\ (x_1,\ y_1),\ \dots,\ (x_n,\ y_n) $ が存在するか判定してください。

- $ n\ \geq\ 4 $
- $ C_{x_0,\ y_0}\ =\ C_{x_n,\ y_n}\ = $ `S`
- $ 1\ \leq\ i\ \leq\ n\ -\ 1 $ ならば $ C_{x_i,\ y_i}\ = $ `.`
- $ 1\ \leq\ i\ \lt\ j\ \leq\ n\ -\ 1 $ ならば $ (x_i,\ y_i)\ \neq\ (x_j,\ y_j) $
- $ 0\ \leq\ i\ \leq\ n\ -\ 1 $ ならばマス $ (x_i,\ y_i) $ とマス $ (x_{i+1},\ y_{i+1}) $ は上下または左右に隣接する

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ H $ $ W $ $ C_{1,\ 1}\ \ldots\ C_{1,\ W} $ $ \vdots $ $ C_{H,\ 1}\ \ldots\ C_{H,\ W} $

## 输出格式

問題文の条件を満たす経路が存在するならば `Yes` を、存在しないならば `No` を出力せよ。

## 说明/提示

### 制約

- $ 4\ \leq\ H\ \times\ W\ \leq\ 10^6 $
- $ H,\ W $ は $ 2 $ 以上の整数
- $ C_{i,\ j} $ は `S`、`.`、`#` のいずれか
- $ C_{i,\ j}\ = $ `S` となる $ (i,\ j) $ がただ一つ存在する

### Sample Explanation 1

$ (3,\ 2)\ \rightarrow\ (2,\ 2)\ \rightarrow\ (1,\ 2)\ \rightarrow\ (1,\ 3)\ \rightarrow\ (1,\ 4)\ \rightarrow\ (2,\ 4)\ \rightarrow\ (3,\ 4)\ \rightarrow\ (3,\ 3)\ \rightarrow\ (3,\ 2) $ という経路が条件を満たします。

## 样例 #1

### 输入

```
4 4
....
#.#.
.S..
.##.
```

### 输出

```
Yes
```

## 样例 #2

### 输入

```
2 2
S.
.#
```

### 输出

```
No
```

## 样例 #3

### 输入

```
5 7
.#...#.
..#.#..
...S...
..#.#..
.#...#.
```

### 输出

```
No
```



---

---
title: "[ABC277D] Takahashi's Solitaire"
layout: "post"
diff: 普及/提高-
pid: AT_abc277_d
tag: []
---

# [ABC277D] Takahashi's Solitaire

## 题目描述

【题面翻译】

给定 $n$ 张牌，每张牌上有一个数字 $a_i$。

你要先选一张牌放在桌子上。假设当前最后一张放置的牌为 $x$，接下来，你每次只能放写着 $x$ 或 $(x + 1) \bmod m$ 的牌。

一直操作下去。你需要让你手上剩下的牌的总和**最小**。

translated by @[liangbowen](https://www.luogu.com.cn/user/367488).

## 输入格式

第一行两个数 $n$，$m$。

接下来 $n$ 个数，表示卡牌上的数字 $a_i$。

## 输出格式

输出最小和值。

## 说明/提示

$1 \le n \le 2 \times 10^5$

$2 \le m \le 10^9$

保证 $0 \le a_i < m$。

## 样例 #1

### 输入

```
9 7

3 0 2 5 5 3 0 6 3
```

### 输出

```
11
```

## 样例 #2

### 输入

```
1 10

4
```

### 输出

```
0
```

## 样例 #3

### 输入

```
20 20

18 16 15 9 8 8 17 1 3 17 11 9 12 11 7 3 2 14 3 12
```

### 输出

```
99
```



---

---
title: "[ABC278D] All Assign Point Add"
layout: "post"
diff: 普及/提高-
pid: AT_abc278_d
tag: []
---

# [ABC278D] All Assign Point Add

## 题目描述

【题目翻译】

给定长度为 $n$ 的数组 $a$，每次有三种操作：

+ $op_i = 1$，表示将 $a$ 数组全部元素替换成 $k$。
+ $op_i = 2$，表示 $a_i \gets a_i + k$。
+ $op_i = 3$，表示查询 $a_i$ 的值。

对于每个 $op_i = 3$，输出结果。

translated by @[liangbowen](https://www.luogu.com.cn/user/367488).

## 输入格式

第一行一个数 $n$。

接下来 $n$ 个数，表示 $a$ 数组。

第三行一个数 $q$。$q$ 表示操作次数。

接下来 $q$ 行，每行表示一次操作：

+ $op_i = 1$，则再读入一个数 $k$。
+ $op_i = 2$，则再读入两个数 $i$，$k$。
+ $op_i = 3$，则再读入一个数 $i$。

## 输出格式

对于每个 $op_i = 3$，输出结果。

## 说明/提示

$1 \le n, q \le 2 \times 10^5$

保证 $1 \le i \le n$，$1 \le a_i, k \le 10^9$。

## 样例 #1

### 输入

```
5

3 1 4 1 5

6

3 2

2 3 4

3 3

1 1

2 3 4

3 3
```

### 输出

```
1

8

5
```

## 样例 #2

### 输入

```
1

1000000000

8

2 1 1000000000

2 1 1000000000

2 1 1000000000

2 1 1000000000

2 1 1000000000

2 1 1000000000

2 1 1000000000

3 1
```

### 输出

```
8000000000
```

## 样例 #3

### 输入

```
10

1 8 4 15 7 5 7 5 8 0

20

2 7 0

3 7

3 8

1 7

3 3

2 4 4

2 4 9

2 10 5

1 10

2 4 2

1 10

2 3 1

2 8 11

2 3 14

2 1 9

3 8

3 8

3 1

2 6 5

3 7
```

### 输出

```
7

5

7

21

21

19

10
```



---

---
title: "[ABC278E] Grid Filling"
layout: "post"
diff: 普及/提高-
pid: AT_abc278_e
tag: []
---

# [ABC278E] Grid Filling

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc278/tasks/abc278_e

縦 $ H $ 行、横 $ W $ 列のグリッドがあります。 上から $ i $ 行目、左から $ j $ 列目のマスを $ (i,j) $ で表します。 $ (i,j)\ (1\leq\ i\leq\ H,1\leq\ j\leq\ W) $ には $ 1 $ 以上 $ N $ 以下の整数 $ A\ _\ {i,j} $ が書かれています。

整数 $ h,w $ が与えられます。$ 0\leq\ k\leq\ H-h,0\leq\ l\leq\ W-w $ を満たすすべての $ (k,l) $ の組について、次の問題を解いてください。

- $ k\lt\ i\leq\ k+h,l\lt\ j\leq\ l+w $ を満たす $ (i,j) $ を塗りつぶしたとき、塗りつぶされていないマスに書かれている数が何種類あるか求めよ。
 
ただし、問題を解く際に実際にマスを塗りつぶすことはない（各問題が独立である）ことに注意してください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ H $ $ W $ $ N $ $ h $ $ w $ $ A\ _\ {1,1} $ $ A\ _\ {1,2} $ $ \dots $ $ A\ _\ {1,W} $ $ A\ _\ {2,1} $ $ A\ _\ {2,2} $ $ \dots $ $ A\ _\ {2,W} $ $ \vdots $ $ A\ _\ {H,1} $ $ A\ _\ {H,2} $ $ \dots $ $ A\ _\ {H,W} $

## 输出格式

$ (k,l) $ に対する答えを $ \operatorname{ans}_{k,l} $ として、以下の形式で出力せよ。

> $ \operatorname{ans}\ _\ {0,0} $ $ \operatorname{ans}\ _\ {0,1} $ $ \dots $ $ \operatorname{ans}\ _\ {0,W-w} $ $ \operatorname{ans}\ _\ {1,0} $ $ \operatorname{ans}\ _\ {1,1} $ $ \dots $ $ \operatorname{ans}\ _\ {1,W-w} $ $ \vdots $ $ \operatorname{ans}\ _\ {H-h,0} $ $ \operatorname{ans}\ _\ {H-h,1} $ $ \dots $ $ \operatorname{ans}\ _\ {H-h,W-w} $

## 说明/提示

### 制約

- $ 1\ \leq\ H,W,N\ \leq\ 300 $
- $ 1\ \leq\ h\ \leq\ H $
- $ 1\ \leq\ w\ \leq\ W $
- $ (h,w)\neq(H,W) $
- $ 1\ \leq\ A\ _\ {i,j}\ \leq\ N\ (1\leq\ i\leq\ H,1\leq\ j\leq\ W) $
- 入力される値はすべて整数
 
### Sample Explanation 1

与えられた盤面は下の図のようになります。 !\[\](https://img.atcoder.jp/abc278/d3542563ea2e11fda78c3307c0a2b0fe.png) 例えば、$ (k,l)=(0,0) $ のときは塗りつぶされていないマスに書かれている数は $ 1,3,4,5 $ の $ 4 $ 種類なので、$ 4 $ が答えになります。

## 样例 #1

### 输入

```
3 4 5 2 2

2 2 1 1

3 2 5 3

3 4 4 3
```

### 输出

```
4 4 3

5 3 4
```

## 样例 #2

### 输入

```
5 6 9 3 4

7 1 5 3 9 5

4 5 4 5 1 2

6 1 6 2 9 7

4 7 1 5 8 8

3 4 3 3 5 3
```

### 输出

```
8 8 7

8 9 7

8 9 8
```

## 样例 #3

### 输入

```
9 12 30 4 7

2 2 2 2 2 2 2 2 2 2 2 2

2 2 20 20 2 2 5 9 10 9 9 23

2 29 29 29 29 29 28 28 26 26 26 15

2 29 29 29 29 29 25 25 26 26 26 15

2 29 29 29 29 29 25 25 8 25 15 15

2 18 18 18 18 1 27 27 25 25 16 16

2 19 22 1 1 1 7 3 7 7 7 7

2 19 22 22 6 6 21 21 21 7 7 7

2 19 22 22 22 22 21 21 21 24 24 24
```

### 输出

```
21 20 19 20 18 17

20 19 18 19 17 15

21 19 20 19 18 16

21 19 19 18 19 18

20 18 18 18 19 18

18 16 17 18 19 17
```



---

---
title: "[ABC279D] Freefall"
layout: "post"
diff: 普及/提高-
pid: AT_abc279_d
tag: []
---

# [ABC279D] Freefall

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc279/tasks/abc279_d

スーパーマンである高橋くんは、地上で困っている人を助けるため、あるビルの屋上から飛び降りようとしています。 高橋くんがいる星には重力の大きさを表す $ g $ という値が定まっており、 高橋くんが落下を開始してから地面に到達するまでにかかる時間は $ \frac{A}{\sqrt{g}} $ です。

現在の時刻は $ 0 $ であり、$ g\ =\ 1 $ が成り立ちます。 高橋くんは、今から次の操作を好きな回数（$ 0 $ 回でもよい）行います。

- 超能力により $ g $ の値を $ 1 $ 増やす。時間が $ B $ 経過する。
 
その後、高橋くんはビルから飛び降ります。落下を開始した後は $ g $ の値を変えることはできません。 また、操作によって経過する時間と落下にかかる時間以外は考えないものとします。

高橋くんが地面に到達できる最も早い時刻を求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ A $ $ B $

## 输出格式

高橋くんが地面に到達できる最も早い時刻を出力せよ。 出力は、真の値との絶対誤差または相対誤差が $ 10^{-6} $ 以下のとき正解と判定される。

## 说明/提示

### 制約

- $ 1\ \leq\ A\ \leq\ 10^{18} $
- $ 1\ \leq\ B\ \leq\ 10^{18} $
- 入力は全て整数
 
### Sample Explanation 1

\- 操作を $ 0 $ 回行うとき、地面に到達する時刻は $ 1\times\ 0+\frac{10}{\sqrt{1}}\ =\ 10 $ です。 - 操作を $ 1 $ 回行うとき、地面に到達する時刻は $ 1\times\ 1+\frac{10}{\sqrt{2}}\ \fallingdotseq\ 8.07 $ です。 - 操作を $ 2 $ 回行うとき、地面に到達する時刻は $ 1\times\ 2+\frac{10}{\sqrt{3}}\ \fallingdotseq\ 7.77 $ です。 - 操作を $ 3 $ 回行うとき、地面に到達する時刻は $ 1\times\ 3+\frac{10}{\sqrt{4}}\ =\ 8 $ です。 操作を $ 4 $ 回以上行っても、地面への到達時刻は遅くなるのみです。 よって、操作を $ 2 $ 回行ってから飛び降りるのが最適で、答えは $ 2+\frac{10}{\sqrt{3}} $ です。

### Sample Explanation 2

操作を $ 1 $ 回も行わないのが最適です。

## 样例 #1

### 输入

```
10 1
```

### 输出

```
7.7735026919
```

## 样例 #2

### 输入

```
5 10
```

### 输出

```
5.0000000000
```

## 样例 #3

### 输入

```
1000000000000000000 100
```

### 输出

```
8772053214538.5976562500
```



---

---
title: "[ABC280D] Factorial and Multiple"
layout: "post"
diff: 普及/提高-
pid: AT_abc280_d
tag: []
---

# [ABC280D] Factorial and Multiple

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc280/tasks/abc280_d

$ 2 $ 以上の整数 $ K $ が与えられます。  
正の整数 $ N $ であって、$ N! $ が $ K $ の倍数となるようなもののうち最小のものを求めてください。

ただし、$ N! $ は $ N $ の階乗を表し、問題の制約下で、そのような $ N $ が必ず存在することが証明できます。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ K $

## 输出格式

$ N! $ が $ K $ の倍数となるような最小の正整数 $ N $ を出力せよ。

## 说明/提示

### 制約

- $ 2\leq\ K\leq\ 10^{12} $
- $ K $ は整数

### Sample Explanation 1

\- $ 1!=1 $ - $ 2!=2\times\ 1=2 $ - $ 3!=3\times\ 2\times\ 1=6 $ - $ 4!=4\times\ 3\times\ 2\times\ 1=24 $ - $ 5!=5\times\ 4\times\ 3\times\ 2\times\ 1=120 $ より、$ N! $ が $ 30 $ の倍数となる最小の正整数 $ N $ は $ 5 $ です。よって、$ 5 $ を出力します。

## 样例 #1

### 输入

```
30
```

### 输出

```
5
```

## 样例 #2

### 输入

```
123456789011
```

### 输出

```
123456789011
```

## 样例 #3

### 输入

```
280
```

### 输出

```
7
```



---

---
title: "[ABC280E] Critical Hit"
layout: "post"
diff: 普及/提高-
pid: AT_abc280_e
tag: []
---

# [ABC280E] Critical Hit

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc280/tasks/abc280_e

最初、体力が $ N $ であるモンスターが $ 1 $ 体います。  
 高橋君はモンスターに対し、モンスターの体力が $ 1 $ 以上残っている限り繰り返し攻撃を行います。

高橋君は $ 1 $ 回の攻撃で、$ \frac{P}{100} $ の確率でモンスターの体力を $ 2 $ 減らし、 $ 1-\frac{P}{100} $ の確率でモンスターの体力を $ 1 $ 減らします。

モンスターの体力が $ 0 $ 以下になるまでに行う攻撃回数の期待値を $ \text{mod\ }\ 998244353 $ で出力してください（注記参照）。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ P $

## 输出格式

高橋君の攻撃回数の期待値を $ \text{mod\ }\ 998244353 $ で出力せよ。

## 说明/提示

### 注記

求める期待値は必ず有限値かつ有理数となることが証明できます。また、この問題の制約下では、その値を互いに素な $ 2 $ つの整数 $ P $, $ Q $ を用いて $ \frac{P}{Q} $ と表したとき、$ R\ \times\ Q\ \equiv\ P\pmod{998244353} $ かつ $ 0\ \leq\ R\ \lt\ 998244353 $ を満たす整数 $ R $ がただ一つ存在することが証明できます。この $ R $ を出力してください。

### 制約

- $ 1\ \leq\ N\ \leq\ 2\times\ 10^5 $
- $ 0\ \leq\ P\ \leq\ 100 $
- 入力は全て整数
 
### Sample Explanation 1

高橋君は $ 1 $ 回の攻撃で、 $ \frac{10}{100}=\frac{1}{10} $ の確率でモンスターの体力を $ 2 $ 減らし、 $ 1-\frac{10}{100}=\frac{9}{10} $ の確率でモンスターの体力を $ 1 $ 減らします。 - 最初、モンスターの体力は $ 3 $ です。 - $ 1 $ 回目の攻撃の後、$ \frac{9}{10} $の確率でモンスターの体力は $ 2 $、$ \frac{1}{10} $の確率でモンスターの体力は $ 1 $ となります。 - $ 2 $ 回目の攻撃の後、$ \frac{81}{100} $の確率でモンスターの体力は $ 1 $、$ \frac{18}{100} $ の確率でモンスターの体力は $ 0 $、$ \frac{1}{100} $ の確率でモンスターの体力は $ -1 $ となります。 $ \frac{18}{100}+\frac{1}{100}=\frac{19}{100} $ の確率で体力は $ 0 $ 以下となり、高橋君は $ 2 $ 回で攻撃をやめます。 - $ 2 $ 回目の攻撃の後で体力が $ 1 $ 残っている場合、$ 3 $ 回目の攻撃の後でモンスターの体力は必ず $ 0 $ 以下となり、高橋君は $ 3 $ 回で攻撃をやめます。 よって、期待値は $ 2\times\ \frac{19}{100}+3\times\left(1-\frac{19}{100}\right)=\frac{281}{100} $ となります。$ 229596204\ \times\ 100\ \equiv\ 281\pmod{998244353} $ であるため、$ 229596204 $ を出力します。

### Sample Explanation 2

高橋君は $ 1 $ 回の攻撃で、つねにモンスターの体力を $ 2 $ 減らします。 $ 2 $ 回目の攻撃が終わった時点では体力が $ 5-2\times\ 2=1 $ 残っているため、$ 3 $ 回目の攻撃を行う必要があります。

## 样例 #1

### 输入

```
3 10
```

### 输出

```
229596204
```

## 样例 #2

### 输入

```
5 100
```

### 输出

```
3
```

## 样例 #3

### 输入

```
280 59
```

### 输出

```
567484387
```



---

---
title: "[ABC287D] Match or Not"
layout: "post"
diff: 普及/提高-
pid: AT_abc287_d
tag: []
---

# [ABC287D] Match or Not

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc287/tasks/abc287_d

英小文字と `?` からなる文字列 $ S,T $ が与えられます。ここで、$ |S|\ \gt\ |T| $ が成り立ちます(文字列 $ X $ に対し、 $ |X| $ で $ X $ の長さを表します)。

また、$ |X|=|Y| $ を満たす文字列 $ X,Y $ は、次の条件を満たすとき及びそのときに限り**マッチする**といいます。

- $ X,Y $ に含まれる `?` をそれぞれ独立に好きな英小文字に置き換えることで $ X $ と $ Y $ を一致させることができる
 
$ x=0,1,\ldots,|T| $ に対して次の問題を解いてください。

- $ S $ の先頭の $ x $ 文字と末尾の $ |T|-x $ 文字を順番を保ったまま連結することで得られる長さ $ |T| $ の文字列を $ S' $ とする。$ S' $ と $ T $ がマッチするならば `Yes` と、そうでなければ `No` と出力せよ。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ S $ $ T $

## 输出格式

$ |T|+1 $ 行出力せよ。  
 $ i $ 行目には $ x=i-1 $ に対する出力をせよ。

## 说明/提示

### 制約

- $ S,T $ は英小文字と `?` からなる文字列
- $ 1\ \leq\ |T|\ \lt\ |S|\ \leq\ 3\ \times\ 10^5 $
 
### Sample Explanation 1

$ x=0 $ の場合、$ S' $ は `?c` となります。ここで、$ S' $ の $ 1 $ 文字目の `?` を `b` に、$ T $ の $ 2 $ 文字目の `?` を `c` に置き換えることで $ S' $ と $ T $ を一致させることができるため、$ S' $ と $ T $ はマッチします。このため、$ 1 $ 行目の出力は `Yes` です。 $ x=1,2 $ の場合は $ S' $ はそれぞれ `ac`、`a?` であり、$ T $ とマッチしません。このため、$ 2,3 $ 行目の出力は `No` です。

## 样例 #1

### 输入

```
a?c

b?
```

### 输出

```
Yes

No

No
```

## 样例 #2

### 输入

```
atcoder

?????
```

### 输出

```
Yes

Yes

Yes

Yes

Yes

Yes
```

## 样例 #3

### 输入

```
beginner

contest
```

### 输出

```
No

No

No

No

No

No

No

No
```



---

---
title: "[ABC287E] Karuta"
layout: "post"
diff: 普及/提高-
pid: AT_abc287_e
tag: []
---

# [ABC287E] Karuta

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc287/tasks/abc287_e

英小文字からなる文字列が $ N $ 個与えられます。$ i\ \,\ (i\ =\ 1,\ 2,\ \dots,\ N) $ 番目のものを $ S_i $ と表します。

二つの文字列 $ x,\ y $ に対し、以下の条件を全て満たす最大の整数 $ n $ を $ \mathrm{LCP}(x,\ y) $ と表します。

- $ x,\ y $ の長さはいずれも $ n $ 以上
- $ 1 $ 以上 $ n $ 以下の全ての整数 $ i $ に対し、$ x $ の $ i $ 文字目と $ y $ の $ i $ 文字目が等しい
 
全ての $ i\ =\ 1,\ 2,\ \dots,\ N $ に対し、以下の値を求めてください。

- $ \displaystyle\ \max_{i\ \neq\ j}\ \mathrm{LCP}(S_i,\ S_j) $

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ S_1 $ $ S_2 $ $ \vdots $ $ S_N $

## 输出格式

$ N $ 行出力せよ。$ i\ \,\ (i\ =\ 1,\ 2,\ \dots,\ N) $ 行目には、$ \displaystyle\ \max_{i\ \neq\ j}\ \mathrm{LCP}(S_i,\ S_j) $ を出力せよ。

## 说明/提示

### 制約

- $ 2\ \leq\ N\ \leq\ 5\ \times\ 10^5 $
- $ N $ は整数
- $ S_i $ は英小文字からなる長さ $ 1 $ 以上の文字列 $ (i\ =\ 1,\ 2,\ \dots,\ N) $
- $ S_i $ の長さの総和は $ 5\ \times\ 10^5 $ 以下
 
### Sample Explanation 1

$ \mathrm{LCP}(S_1,\ S_2)\ =\ 2,\ \mathrm{LCP}(S_1,\ S_3)\ =\ 1,\ \mathrm{LCP}(S_2,\ S_3)\ =\ 1 $ です。

## 样例 #1

### 输入

```
3

abc

abb

aac
```

### 输出

```
2

2

1
```

## 样例 #2

### 输入

```
11

abracadabra

bracadabra

racadabra

acadabra

cadabra

adabra

dabra

abra

bra

ra

a
```

### 输出

```
4

3

2

1

0

1

0

4

3

2

1
```



---

---
title: "[ABC289E] Swap Places"
layout: "post"
diff: 普及/提高-
pid: AT_abc289_e
tag: []
---

# [ABC289E] Swap Places

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc289/tasks/abc289_e

頂点に $ 1 $ から $ N $ までの、辺に $ 1 $ から $ M $ までの番号がついた $ N $ 頂点 $ M $ 辺の単純無向グラフがあります。 辺 $ i $ は頂点 $ u_i $ と頂点 $ v_i $ を結んでいます。  
 また、全ての頂点は赤か青のいずれか一方で塗られています。頂点 $ i $ の色は $ C_i $ で表されて、$ C_i $ が $ 0 $ ならば頂点 $ i $ は赤く、$ 1 $ ならば頂点 $ i $ は青く塗られています。

今、高橋君が頂点 $ 1 $ に、青木君が頂点 $ N $ にいます。  
 2 人は次の行動を $ 0 $ 回以上好きな回数繰り返します。

- 2 人が同時に、今いる頂点に隣接している頂点のいずれか 1 個に移動する。  
   ただし、高橋君の移動先の頂点の色と、青木君の移動先の頂点の色は異なる必要がある。
 
上記の行動を繰り返すことで、高橋君が頂点 $ N $ に、青木君が頂点 $ 1 $ にいる状態にできますか？  
 可能である場合は必要な行動回数の最小値を答えてください。不可能である場合は `-1` を出力してください。

入力のはじめに $ T $ が与えられるので、$ T $ 個のテストケースについて問題を解いてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。ここで $ \text{test}_i $ は $ i $ 番目のテストケースを意味する。

> $ T $ $ \text{test}_1 $ $ \text{test}_2 $ $ \vdots $ $ \text{test}_T $

各テストケースは以下の形式で与えられる。

> $ N $ $ M $ $ C_1 $ $ C_2 $ $ \dots $ $ C_N $ $ u_1 $ $ v_1 $ $ u_2 $ $ v_2 $ $ \vdots $ $ u_M $ $ v_M $

## 输出格式

$ T $ 行出力せよ。$ i $ 行目には $ i $ 番目のテストケースに対する答えを出力せよ。  
 各テストケースでは、高橋君が頂点 $ N $ に、青木君が頂点 $ 1 $ にいる状態にできる場合は必要な行動回数の最小値を、できない場合は `-1` を出力せよ。

## 说明/提示

### 制約

- $ 1\ \leq\ T\ \leq\ 1000 $
- $ 2\ \leq\ N\ \leq\ 2000 $
- $ 1\ \leq\ M\ \leq\ \min(\frac{N(N-1)}{2},\ 2000) $
- $ C_i\ \in\ \lbrace\ 0,\ 1\ \rbrace $
- $ 1\ \leq\ u_i,\ v_i\ \leq\ N $
- 入力で与えられるグラフは単純
- 入力される値は全て整数
- 全てのテストケースに対する $ N $ の総和は $ 2000 $ を超えない。
- 全てのテストケースに対する $ M $ の総和は $ 2000 $ を超えない。
 
### Sample Explanation 1

1 番目のテストケースでは、高橋君と青木君は以下のように行動することで、 $ 3 $ 回の行動で目的の状態を達成することができて、これが最小です。 - 高橋君が頂点 $ 3 $ に、青木君が頂点 $ 2 $ に移動する。 - 高橋君が頂点 $ 2 $ に、青木君が頂点 $ 3 $ に移動する。 - 高橋君が頂点 $ 4 $ に、青木君が頂点 $ 1 $ に移動する。 ここで、$ 1 $ 回目の移動で高橋君と青木君がともに頂点 $ 2 $ に移動することはできないのに注意してください。(なぜならば、高橋君の移動先の頂点の色と青木君の移動先の頂点の色は異なる必要があるからです。) 2 番目のテストケースでは、2 人はどのように行動しても目的の状態を達成することはできません。

## 样例 #1

### 输入

```
3

4 4

0 1 0 1

1 2

2 3

1 3

2 4

3 3

0 1 0

1 2

2 3

1 3

6 6

0 0 1 1 0 1

1 2

2 6

3 6

4 6

4 5

2 4
```

### 输出

```
3

-1

3
```



---

---
title: "[ABC290D] Marking"
layout: "post"
diff: 普及/提高-
pid: AT_abc290_d
tag: []
---

# [ABC290D] Marking

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc290/tasks/abc290_d

$ 0 $ から $ N-1 $ までの番号がつけられた $ N $ 個のマスが並んでいます。 今から、すぬけくんが以下の手順に従って全てのマスに印をつけていきます。

1. マス $ 0 $ に印をつける。
2. 次の i - iii の手順を $ N−1 $ 回繰り返す。 
  1. 最後に印をつけたマスの番号を $ A $ としたとき、変数 $ x $ を $ (A+D)\ \bmod\ N $ で初期化する。
  2. マス $ x $ に印が付いている限り、 $ x $ を $ (x+1)\ \bmod\ N $ に更新することを繰り返す。
  3. マス $ x $ に印をつける。

すぬけくんが $ K $ 番目に印をつけるマスの番号を求めてください。

$ T $ 個のテストケースが与えられるので、それぞれについて答えを求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。ここで、$ \mathrm{test}_i $ は $ i $ 番目のテストケースを意味する。

> $ T $ $ \mathrm{test}_1 $ $ \mathrm{test}_2 $ $ \vdots $ $ \mathrm{test}_T $

各テストケースは以下の形式で与えられる。

> $ N $ $ D $ $ K $

## 输出格式

$ T $ 行出力せよ。

$ i\ (1\leq\ i\ \leq\ T) $ 行目には、$ i $ 番目のテストケースに対する答えを出力せよ。

## 说明/提示

### 制約

- $ 1\leq\ T\ \leq\ 10^5 $
- $ 1\leq\ K\leq\ N\ \leq\ 10^9 $
- $ 1\leq\ D\ \leq\ 10^9 $
- 入力は全て整数

### Sample Explanation 1

$ N=4,D=2 $ のとき、すぬけくんは以下のように印をつけていきます。 1. マス $ 0 $ に印をつける。 2. (1回目) $ x=(0+2)\bmod\ 4=2 $ と初期化する。マス $ 2 $ は印がついていないので、印をつける。 (2回目) $ x=(2+2)\bmod\ 4=0 $ と初期化する。マス $ 0 $ は印がついているので、$ x=(0+1)\bmod\ 4=1 $ と更新する。マス $ 1 $ は印がついていないので、印をつける。 (3回目) $ x=(1+2)\bmod\ 4=3 $ と初期化する。マス $ 3 $ は印がついていないので、印をつける。

## 样例 #1

### 输入

```
9
4 2 1
4 2 2
4 2 3
4 2 4
5 8 1
5 8 2
5 8 3
5 8 4
5 8 5
```

### 输出

```
0
2
1
3
0
3
1
4
2
```



---

---
title: "[ABC291D] Flip Cards"
layout: "post"
diff: 普及/提高-
pid: AT_abc291_d
tag: []
---

# [ABC291D] Flip Cards

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc291/tasks/abc291_d

$ 1 $ から $ N $ までの番号がついた $ N $ 枚のカードが一列に並んでいて、各 $ i\ (1\leq\ i\ <\ N) $ に対してカード $ i $ とカード $ i+1 $ が隣り合っています。 カード $ i $ の表には $ A_i $ が、裏には $ B_i $ が書かれており、最初全てのカードは表を向いています。

今から、$ N $ 枚のカードのうち好きな枚数 ($ 0 $ 枚でも良い) を選んで裏返すことを考えます。 裏返すカードの選び方は $ 2^N $ 通りありますが、そのうち以下の条件を満たすものの数を $ 998244353 $ で割った余りを求めてください。

- 選んだカードを裏返した後、どの隣り合う $ 2 $ 枚のカードについても、向いている面に書かれた数が相異なる。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ A_1 $ $ B_1 $ $ A_2 $ $ B_2 $ $ \vdots $ $ A_N $ $ B_N $

## 输出格式

答えを整数として出力せよ。

## 说明/提示

### 制約

- $ 1\leq\ N\ \leq\ 2\times\ 10^5 $
- $ 1\leq\ A_i,B_i\ \leq\ 10^9 $
- 入力は全て整数

### Sample Explanation 1

裏返すカードの番号の集合を $ S $ とします。 例えば $ S=\{2,3\} $ を選ぶと、向いている面に書かれた数はカード $ 1 $ から順に $ 1,2,4 $ となるため条件を満たします。 一方 $ S=\{3\} $ を選ぶと、向いている面に書かれた数はカード $ 1 $ から順に $ 1,4,4 $ となり、カード $ 2 $ とカード $ 3 $ の数が一致するため条件を満たしません。 条件を満たす $ S $ は $ \{\},\{1\},\{2\},\{2,3\} $ の $ 4 $ 通りです。

## 样例 #1

### 输入

```
3
1 2
4 2
3 4
```

### 输出

```
4
```

## 样例 #2

### 输入

```
4
1 5
2 6
3 7
4 8
```

### 输出

```
16
```

## 样例 #3

### 输入

```
8
877914575 602436426
861648772 623690081
476190629 262703497
971407775 628894325
822804784 450968417
161735902 822804784
161735902 822804784
822804784 161735902
```

### 输出

```
48
```



---

---
title: "[ABC291E] Find Permutation"
layout: "post"
diff: 普及/提高-
pid: AT_abc291_e
tag: []
---

# [ABC291E] Find Permutation

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc291/tasks/abc291_e

$ 1,\ldots,N $ の並び替えである長さ $ N $ の数列 $ A=(A_1,\ldots,A_N) $ があります。

あなたは $ A $ を知りませんが、$ M $ 個の整数の組 $ (X_i,Y_i) $ について、$ A_{X_i}\ <\ A_{Y_i} $ が成り立つことを知っています。

$ A $ を一意に特定できるかどうか判定し、できるなら $ A $ を求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ M $ $ X_1 $ $ Y_1 $ $ \vdots $ $ X_M $ $ Y_M $

## 输出格式

$ A $ を一意に特定できるとき、1行目に `Yes` と出力し、2行目に $ A_1,\ldots,A_N $ をこの順に空白区切りで出力せよ。

$ A $ を一意に特定できないとき、`No` とのみ出力せよ。

## 说明/提示

### 制約

- $ 2\ \leq\ N\ \leq\ 2\times\ 10^5 $
- $ 1\ \leq\ M\ \leq\ 2\times\ 10^5 $
- $ 1\leq\ X_i,Y_i\ \leq\ N $
- 入力は全て整数である
- 入力に矛盾しない $ A $ が存在する

### Sample Explanation 1

$ A=(3,1,2) $ であると一意に特定できます。

### Sample Explanation 2

$ A $ として $ (2,3,1),(3,2,1) $ の $ 2 $ 通りが考えられます。

## 样例 #1

### 输入

```
3 2
3 1
2 3
```

### 输出

```
Yes
3 1 2
```

## 样例 #2

### 输入

```
3 2
3 1
3 2
```

### 输出

```
No
```

## 样例 #3

### 输入

```
4 6
1 2
1 2
2 3
2 3
3 4
3 4
```

### 输出

```
Yes
1 2 3 4
```



---

---
title: "[ABC292E] Transitivity"
layout: "post"
diff: 普及/提高-
pid: AT_abc292_e
tag: []
---

# [ABC292E] Transitivity

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc292/tasks/abc292_e

頂点に $ 1 $ から $ N $ の番号が、辺に $ 1 $ から $ M $ の番号がついた $ N $ 頂点 $ M $ 辺の単純有向グラフが与えられます。辺 $ i $ は頂点 $ u_i $ から頂点 $ v_i $ への有向辺です。

また、あなたは次の操作を $ 0 $ 回以上何度でも行えます。

- 相異なる頂点 $ x,y $ であって頂点 $ x $ から頂点 $ y $ への有向辺が存在しないようなものを選ぶ。そして、頂点 $ x $ から頂点 $ y $ への有向辺を追加する。

このグラフが次の条件を満たす状態にするために最小で何回操作を行う必要があるかを求めてください。

- 相異なる頂点 $ a,b,c $ すべてについて、頂点 $ a $ から頂点 $ b $ への有向辺と頂点 $ b $ から頂点 $ c $ への有向辺がともに存在するならば頂点 $ a $ から頂点 $ c $ への有向辺も存在する。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ M $ $ u_1 $ $ v_1 $ $ \vdots $ $ u_M $ $ v_M $

## 输出格式

答えを出力せよ。

## 说明/提示

### 制約

- $ 3\ \leq\ N\ \leq\ 2000 $
- $ 0\ \leq\ M\ \leq\ 2000 $
- $ 1\ \leq\ u_i\ ,v_i\ \leq\ N $
- $ u_i\ \neq\ v_i $
- $ i\ \neq\ j $ ならば $ (u_i,v_i)\ \neq\ (u_j,v_j) $
- 入力はすべて整数

### Sample Explanation 1

初め、一例として頂点 $ 2,4,3 $ について、頂点 $ 2 $ から頂点 $ 4 $ への有向辺と頂点 $ 4 $ から頂点 $ 3 $ への有向辺がともに存在するにもかかわらず、頂点 $ 2 $ から頂点 $ 3 $ への有向辺は存在せず、条件を満たさない状態です。 そこで、以下の $ 3 $ 本の有向辺を追加すると条件を満たす状態になります。 - 頂点 $ 2 $ から頂点 $ 3 $ への有向辺 - 頂点 $ 2 $ から頂点 $ 1 $ への有向辺 - 頂点 $ 4 $ から頂点 $ 1 $ への有向辺 一方、$ 3 $ 本未満の追加で条件を満たす状態には出来ないため、答えは $ 3 $ です。

## 样例 #1

### 输入

```
4 3
2 4
3 1
4 3
```

### 输出

```
3
```

## 样例 #2

### 输入

```
292 0
```

### 输出

```
0
```

## 样例 #3

### 输入

```
5 8
1 2
2 1
1 3
3 1
1 4
4 1
1 5
5 1
```

### 输出

```
12
```



---

---
title: "[ABC293D] Tying Rope"
layout: "post"
diff: 普及/提高-
pid: AT_abc293_d
tag: []
---

# [ABC293D] Tying Rope

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc293/tasks/abc293_d

一方の端が赤に塗られており、もう一方の端が青に塗られているロープが $ N $ 本あります。ロープには $ 1 $ から $ N $ までの番号がつけられています。

これからロープの端を結ぶ操作を $ M $ 回行います。$ i $ 回目の操作ではロープ $ A_i $ の色 $ B_i $ の端とロープ $ C_i $ の色 $ D_i $ の端を結びます。ただし、色 `R` は赤を意味し、色 `B` は青を意味します。各ロープについて、同じ色の端が複数回結ばれることはありません。

すべての操作を終えた後に、ひとつながりになっているロープの組について環状になっているものとそうでないものの個数を出力してください。

ただし、ひとつながりになっているロープの組 $ \lbrace\ v_0,\ v_1,\ \ldots,\ v_{x-1}\ \rbrace $ が環状になっているとは、$ v $ の要素の順序を適切に入れ替えることで各 $ 0\ \leq\ i\ <\ x $ についてロープ $ v_i $ とロープ $ v_{(i+1)\ \bmod\ x} $ が結ばれているようにできることをいいます。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ M $ $ A_1 $ $ B_1 $ $ C_1 $ $ D_1 $ $ A_2 $ $ B_2 $ $ C_2 $ $ D_2 $ $ \vdots $ $ A_M $ $ B_M $ $ C_M $ $ D_M $

## 输出格式

ひとつながりになっているロープの組について、環状になっているものの個数を $ X $、そうでないものの個数を $ Y $ として $ X $ と $ Y $ をこの順に空白区切りで出力せよ。

## 说明/提示

### 制約

- $ 1\ \leq\ N\ \leq\ 2\ \times\ 10^5 $
- $ 0\ \leq\ M\ \leq\ 2\ \times\ 10^5 $
- $ 1\ \leq\ A_i,\ C_i\ \leq\ N $
- $ (A_i,\ B_i)\ \neq\ (A_j,\ B_j),\ (C_i,\ D_i)\ \neq\ (C_j,\ D_j) $ $ (i\ \neq\ j) $
- $ (A_i,\ B_i)\ \neq\ (C_j,\ D_j) $
- $ N,\ M,\ A_i,\ C_i $ は整数
- $ B_i,\ D_i $ は `R` か `B` のいずれか
 
### Sample Explanation 1

ひとつながりになっているロープの組は $ \lbrace\ 1\ \rbrace $、$ \lbrace\ 2,4\ \rbrace $、$ \lbrace\ 3,5\ \rbrace $ の $ 3 $ つです。 ロープ $ \lbrace\ 3,5\ \rbrace $ の組は環状になっており、ロープ $ \lbrace\ 1\ \rbrace $ と $ \lbrace\ 2,4\ \rbrace $ の組は環状になっていません。したがって、$ X\ =\ 1,\ Y\ =\ 2 $ です。

## 样例 #1

### 输入

```
5 3

3 R 5 B

5 R 3 B

4 R 2 B
```

### 输出

```
1 2
```

## 样例 #2

### 输入

```
7 0
```

### 输出

```
0 7
```

## 样例 #3

### 输入

```
7 6

5 R 3 R

7 R 4 R

4 B 1 R

2 R 3 B

2 B 5 B

1 B 7 B
```

### 输出

```
2 1
```



---

---
title: "[ABC294E] 2xN Grid"
layout: "post"
diff: 普及/提高-
pid: AT_abc294_e
tag: []
---

# [ABC294E] 2xN Grid

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc294/tasks/abc294_e

$ 2 $ 行 $ L $ 列のマス目があります。 上から $ i $ 行目 $ (i\in\lbrace1,2\rbrace) $、左から $ j $ 列目 $ (1\leq\ j\leq\ L) $のマス目を $ (i,j) $ で表します。 $ (i,j) $ には整数 $ x\ _\ {i,j} $ が書かれています。

$ x\ _\ {1,j}=x\ _\ {2,j} $ であるような整数 $ j $ の個数を求めてください。

ただし、$ x\ _\ {i,j} $ の情報は $ (x\ _\ {1,1},x\ _\ {1,2},\ldots,x\ _\ {1,L}) $ と $ (x\ _\ {2,1},x\ _\ {2,2},\ldots,x\ _\ {2,L}) $ をそれぞれ連長圧縮した、長さ $ N\ _\ 1 $ の列 $ ((v\ _\ {1,1},l\ _\ {1,1}),\ldots,(v\ _\ {1,N\ _\ 1},l\ _\ {1,N\ _\ 1})) $ と長さ $ N\ _\ 2 $ の列 $ ((v\ _\ {2,1},l\ _\ {2,1}),\ldots,(v\ _\ {2,N\ _\ 2},l\ _\ {2,N\ _\ 2})) $ として与えられます。

ここで、列 $ A $ の連長圧縮とは、$ A $ の要素 $ v\ _\ i $ と正整数 $ l\ _\ i $ の組 $ (v\ _\ i,l\ _\ i) $ の列であって、次の操作で得られるものです。

1. $ A $ を異なる要素が隣り合っている部分で分割する。
2. 分割した各列 $ B\ _\ 1,B\ _\ 2,\ldots,B\ _\ k $ に対して、$ v\ _\ i $ を $ B\ _\ i $ の要素、$ l\ _\ i $ を $ B\ _\ i $ の長さとする。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ L $ $ N\ _\ 1 $ $ N\ _\ 2 $ $ v\ _\ {1,1} $ $ l\ _\ {1,1} $ $ v\ _\ {1,2} $ $ l\ _\ {1,2} $ $ \vdots $ $ v\ _\ {1,N\ _\ 1} $ $ l\ _\ {1,N\ _\ 1} $ $ v\ _\ {2,1} $ $ l\ _\ {2,1} $ $ v\ _\ {2,2} $ $ l\ _\ {2,2} $ $ \vdots $ $ v\ _\ {2,N\ _\ 2} $ $ l\ _\ {2,N\ _\ 2} $

## 输出格式

答えを $ 1 $ 行で出力せよ。

## 说明/提示

### 制約

- $ 1\leq\ L\leq\ 10\ ^\ {12} $
- $ 1\leq\ N\ _\ 1,N\ _\ 2\leq\ 10\ ^\ 5 $
- $ 1\leq\ v\ _\ {i,j}\leq\ 10\ ^\ 9\ (i\in\lbrace1,2\rbrace,1\leq\ j\leq\ N\ _\ i) $
- $ 1\leq\ l\ _\ {i,j}\leq\ L\ (i\in\lbrace1,2\rbrace,1\leq\ j\leq\ N\ _\ i) $
- $ v\ _\ {i,j}\neq\ v\ _\ {i,j+1}\ (i\in\lbrace1,2\rbrace,1\leq\ j\lt\ N\ _\ i) $
- $ l\ _\ {i,1}+l\ _\ {i,2}+\cdots+l\ _\ {i,N\ _\ i}=L\ (i\in\lbrace1,2\rbrace) $
- 入力はすべて整数
 
### Sample Explanation 1

マス目は以下の図のようになっています。 !\[\](https://img.atcoder.jp/abc294/14f38720983c464a322b504738344f24.png) $ x\ _\ {1,j}=x\ _\ {2,j} $ となるような整数 $ j $ は、$ j=1,2,5,8 $ の $ 4 $ つなので、出力すべき値は $ 4 $ です。

### Sample Explanation 2

答えが $ 32\operatorname{bit} $ 整数に収まらない場合があることに注意してください。

## 样例 #1

### 输入

```
8 4 3

1 2

3 2

2 3

3 1

1 4

2 1

3 3
```

### 输出

```
4
```

## 样例 #2

### 输入

```
10000000000 1 1

1 10000000000

1 10000000000
```

### 输出

```
10000000000
```

## 样例 #3

### 输入

```
1000 4 7

19 79

33 463

19 178

33 280

19 255

33 92

34 25

19 96

12 11

19 490

33 31
```

### 输出

```
380
```



---

---
title: "[ABC295D] Three Days Ago"
layout: "post"
diff: 普及/提高-
pid: AT_abc295_d
tag: []
---

# [ABC295D] Three Days Ago

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc295/tasks/abc295_d

`20230322` は並べ替えると `02320232` となり、これは `0232` を $ 2 $ 度繰り返しています。  
 このように、数字のみからなる文字列であって、適切に文字を並び替える (そのままでもよい) ことによって同じ列を $ 2 $ 度繰り返すようにできるものを **嬉しい列** と呼びます。  
 数字のみからなる文字列 $ S $ が与えられるので、以下の条件を全て満たす整数の組 $ (l,r) $ はいくつあるか求めてください。

- $ 1\ \le\ l\ \le\ r\ \le\ |S| $ ( $ |S| $ は $ S $ の長さ)
- $ S $ の $ l $ 文字目から $ r $ 文字目までの (連続する) 部分文字列は嬉しい列である。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ S $

## 输出格式

答えを整数として出力せよ。

## 说明/提示

### 制約

- $ S $ は数字のみからなる長さ $ 1 $ 以上 $ 5\ \times\ 10^5 $ 以下の文字列
 
### Sample Explanation 1

$ S= $ `20230322` です。 条件を満たす整数組 $ (l,r) $ は $ (1,6),(1,8),(2,7),(7,8) $ の $ 4 $ つです。

### Sample Explanation 2

$ S $ の先頭が `0` である場合もあります。

## 样例 #1

### 输入

```
20230322
```

### 输出

```
4
```

## 样例 #2

### 输入

```
0112223333444445555556666666777777778888888889999999999
```

### 输出

```
185
```

## 样例 #3

### 输入

```
3141592653589793238462643383279502884197169399375105820974944
```

### 输出

```
9
```



---

---
title: "[ABC296D] M<=ab"
layout: "post"
diff: 普及/提高-
pid: AT_abc296_d
tag: []
---

# [ABC296D] M<=ab

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc296/tasks/abc296_d

正整数 $ N,M $ が与えられます。  
 次の条件をともにみたす最小の正整数 $ X $ を求めてください。 ただし、そのようなものが存在しない場合は $ -1 $ を出力してください。

- $ X $ は $ 1 $ 以上 $ N $ 以下の整数 $ a,b $ の積として表される。ここで、$ a $ と $ b $ は同じ整数でも良い。
- $ X $ は $ M $ 以上である。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ M $

## 输出格式

問題文の条件をともにみたす最小の正整数 $ X $ を出力せよ。そのようなものが存在しない場合は $ -1 $ を出力せよ。

## 说明/提示

### 制約

- $ 1\leq\ N\leq\ 10^{12} $
- $ 1\leq\ M\leq\ 10^{12} $
- $ N,M $ は整数
 
### Sample Explanation 1

まず、$ 7 $ を $ 1 $ 以上 $ 5 $ 以下の整数 $ 2 $ つの積として表すことはできません。 次に、$ 8 $ は $ 8=2\times\ 4 $ などとして、$ 1 $ 以上 $ 5 $ 以下の整数 $ 2 $ つの積として表すことができます。 よって、$ 8 $ を出力します。

### Sample Explanation 2

$ 1\times\ 1=1 $、$ 1\times\ 2=2 $、$ 2\times\ 1=2 $、$ 2\times\ 2=4 $ より、 $ 1 $ 以上 $ 2 $ 以下の整数 $ 2 $ つの積として表す事ができるのは $ 1,2,4 $ のみであるため、 $ 5 $ 以上の数はそのような整数 $ 2 $ つの積として表すことができません。 よって、$ -1 $ を出力します。

### Sample Explanation 3

$ a=b=100000 $ $ (=10^5) $とした時、$ a,b $ の積は $ 10000000000 $ $ (=10^{10}) $ となり、これが答えとなります。 答えが $ 32 $ bit 整数型に収まらない場合があることに注意してください。

## 样例 #1

### 输入

```
5 7
```

### 输出

```
8
```

## 样例 #2

### 输入

```
2 5
```

### 输出

```
-1
```

## 样例 #3

### 输入

```
100000 10000000000
```

### 输出

```
10000000000
```



---

---
title: "[ABC296E] Transition Game"
layout: "post"
diff: 普及/提高-
pid: AT_abc296_e
tag: []
---

# [ABC296E] Transition Game

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc296/tasks/abc296_e

長さ $ N $ の数列 $ A=(A_1,A_2,\ldots,A_N) $ が与えられます。ここで、各 $ A_i $ $ (1\leq\ i\leq\ N) $ は $ 1\leq\ A_i\ \leq\ N $ をみたします。

高橋君と青木君が $ N $ 回ゲームを行います。$ i=1,2,\ldots,N $ 回目のゲームは次のようにして行われます。

1. 青木君が正整数 $ K_i $ を指定する。
2. 青木君の指定した $ K_i $ を聞いた後、高橋君は $ 1 $ 以上 $ N $ 以下の整数 $ S_i $ を選び、黒板に書く。
3. その後、 $ K_i $ 回次の操作を繰り返す。
  
  
  - 黒板に $ x $ が書かれているとき、それを消し、$ A_x $ を新しく書く。

$ K_i $ 回の操作の後で黒板に書かれている整数が $ i $ ならば $ i $ 回目のゲームは高橋君の勝ち、そうでないならば青木君の勝ちとなります。  
ここで、$ K_i,S_i $ は $ i=1,2,\ldots,N $ に対して独立に選ぶ事ができます。

両者が、自身が勝つために最善の行動をとったとき、$ N $ 回のゲームのうち高橋君が勝つ回数を求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ A_1 $ $ A_2 $ $ \ldots $ $ A_N $

## 输出格式

両者が最善の行動をとったとき、$ N $ 回のゲームのうち高橋君が勝つ回数を出力せよ。

## 说明/提示

### 制約

- $ 1\leq\ N\leq\ 2\times\ 10^5 $
- $ 1\leq\ A_i\leq\ N $
- 入力はすべて整数

### Sample Explanation 1

$ 1 $ 回目のゲームにおいて、青木君が $ K_1=2 $ を指定したとき、高橋君は $ S_1 $ として、$ 1,2,3 $ のいずれを選んでも勝つことはできません。 例えば、高橋君が最初に黒板に $ S_1=1 $ と書いたとすると、$ 2 $ 回の操作で黒板に書かれている数は順に $ 1\to\ 2(=A_1) $ 、$ 2\to\ 2(=A_2) $ と変化し、 最終的に黒板に書かれている数は $ 2(\neq\ 1) $ であるため、青木君の勝ちとなります。 一方、$ 2,3 $ 回目のゲームにおいては、青木君の指定した $ K_i $ の値によらず、高橋君はそれぞれ $ 2,3 $ を最初に黒板に書くことで勝つ事ができます。 よって、両者が、自分が勝つために最善の行動をとったとき、高橋君が勝つゲームは $ 2,3 $ 回目の $ 2 $ 回であるため、$ 2 $ を出力します。

### Sample Explanation 2

$ 1 $ 回目のゲームにおいて、高橋君は、青木君が指定した $ K_1 $ が奇数のときは $ 2 $、偶数のときは $ 1 $ を最初に黒板に書く事で勝つ事ができます。 同様に $ 2 $ 回目のゲームにおいても勝つ方法が存在するため、$ 1,2 $ 回目のゲームのいずれでも高橋君は勝利する事ができ、$ 2 $ が答えとなります。

## 样例 #1

### 输入

```
3
2 2 3
```

### 输出

```
2
```

## 样例 #2

### 输入

```
2
2 1
```

### 输出

```
2
```



---

---
title: "[ABC297E] Kth Takoyaki Set"
layout: "post"
diff: 普及/提高-
pid: AT_abc297_e
tag: []
---

# [ABC297E] Kth Takoyaki Set

## 题目描述

AtCoder 王国出售 $N$ 种类的章鱼烧。第 $i$ 种章鱼烧的价格是 $A_i$ 日元。
高桥一共买了 $1$ 个以上的章鱼烧。这个时候，也允许买多个同样的章鱼烧。
高桥君可以支付的金额中，请从便宜的一方寻求第 $K$ 的金额。但是，如果存在多个支付相同金额的方法，则只计算$ 1 $个。

## 输入格式

输入以以下形式由标准输入给出。
> $ N $ $ K $ $ A_1 $ $ A_2 $ $ \dots $ $ A_N $

## 输出格式

把答案作为整数输出。
### 示例#1
### 样例输入#1
```
4 6
20 25 30 100
```
### 样例输出#1
```
50
```
## 示例#2
### 样例输入#2
```
2 10
2 1
```
### 样例输出#2
```
10
```
## 样例#3
### 样例输入#3
```
10 200000
955277671 764071525 871653439 819642859 703677532 515827892 127889502 881462887 330802980 503797872
```
### 样例输出#3
```
5705443819
```

## 说明/提示

### 约束条件
- $ 1\ \le\ N\ \le\ 10 $
- $ 1\ \le\ K\ \le\ 2\ \times\ 10^5 $
- $ 1\ \le\ A_i\ \le\ 10^9 $
- 所有输入均为整数
### Sample Explanation 1
AtCoder王国出售的4个种类的章鱼烧，分别是$ 20 $日元、$ 25 $日元、$ 30 $日元、$ 100 $日元。高桥君支付的金额可能是，从便宜的一方列举$ 6 $个的话，$ 20 $日元，$ 25 $日元，$ 30 $日元，$ 40 $日元，$ 45 $日元，$ 50 $日元。因此，答案是$ 50 $个日元。请注意总共需要买$ 1 $个以上的章鱼烧。
### Sample Explanation 2
请注意，即使有几种相同金额的购买方法，也不要重复计算。

## 样例 #1

### 输入

```
4 6

20 25 30 100
```

### 输出

```
50
```

## 样例 #2

### 输入

```
2 10

2 1
```

### 输出

```
10
```

## 样例 #3

### 输入

```
10 200000

955277671 764071525 871653439 819642859 703677532 515827892 127889502 881462887 330802980 503797872
```

### 输出

```
5705443819
```



---

---
title: "[ABC298D] Writing a Numeral"
layout: "post"
diff: 普及/提高-
pid: AT_abc298_d
tag: []
---

# [ABC298D] Writing a Numeral

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc298/tasks/abc298_d

文字列 $ S $ があり、初め $ S= $ `1` です。  
以下の形式のクエリが $ Q $ 個与えられるので順に処理してください。

- `1 x` : $ S $ の末尾に数字 $ x $ を追加する
- `2` : $ S $ の先頭の数字を削除する
- `3` : $ S $ を十進数表記の数とみなした値を $ 998244353 $ で割った余りを出力する

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ Q $ $ \mathrm{query}_1 $ $ \vdots $ $ \mathrm{query}_Q $

ただし $ \mathrm{query}_i $ は $ i $ 番目のクエリを表し、以下のいずれかの形式である。

> $ 1 $ $ x $

> $ 2 $

> $ 3 $

## 输出格式

$ 3 $ 番目の形式のクエリの個数を $ q $ として、$ q $ 行出力せよ。$ i $ $ (1\ \leq\ i\ \leq\ q) $ 行目には $ i $ 番目の $ 3 $ 番目の形式のクエリに対する出力をせよ。

## 说明/提示

### 制約

- $ 1\ \leq\ Q\ \leq\ 6\ \times\ 10^5 $
- $ 1 $ 番目の形式のクエリについて、$ x\ \in\ \{1,2,3,4,5,6,7,8,9\} $
- $ 2 $ 番目の形式のクエリは $ S $ が $ 2 $ 文字以上の時にのみ与えられる
- $ 3 $ 番目の形式のクエリが $ 1 $ 個以上存在する

### Sample Explanation 1

$ 1 $ 番目のクエリにおいて、$ S $ は `1` なので ( $ 1 $ を $ 998244353 $ で割った余りに等しい) $ 1 $ を出力します。 $ 2 $ 番目のクエリにおいて、$ S $ は `12` になります。 $ 3 $ 番目のクエリにおいて、$ S $ は `12` なので ( $ 12 $ を $ 998244353 $ で割った余りに等しい) $ 12 $ を出力します。

### Sample Explanation 3

出力されるべき値は $ 998244353 $ で割った余りであることに注意してください。

## 样例 #1

### 输入

```
3
3
1 2
3
```

### 输出

```
1
12
```

## 样例 #2

### 输入

```
3
1 5
2
3
```

### 输出

```
5
```

## 样例 #3

### 输入

```
11
1 9
1 9
1 8
1 2
1 4
1 4
1 3
1 5
1 3
2
3
```

### 输出

```
0
```



---

---
title: "[ABC299D] Find by Query"
layout: "post"
diff: 普及/提高-
pid: AT_abc299_d
tag: []
---

# [ABC299D] Find by Query

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc299/tasks/abc299_d

この問題は **インタラクティブな問題**（あなたが作成したプログラムとジャッジプログラムが標準入出力を介して対話を行う形式の問題）です。

ジャッジが $ 0 $ と $ 1 $ のみからなる長さ $ N $ の文字列 $ S\ =\ S_1S_2\ldots\ S_N $ を持っています。 文字列 $ S $ は、$ S_1\ =\ 0 $ および $ S_N\ =\ 1 $ を満たします。

あなたには $ S $ の長さ $ N $ が与えられますが、$ S $ 自体は与えられません。 その代わり、あなたはジャッジに対して以下の質問を $ 20 $ 回まで行うことができます。

- $ 1\ \leq\ i\ \leq\ N $ を満たす整数 $ i $ を選び、$ S_i $ の値を尋ねる。
 
$ 1\ \leq\ p\ \leq\ N-1 $ かつ $ S_p\ \neq\ S_{p+1} $ を満たす整数 $ p $ を $ 1 $ 個出力してください。  
 なお、本問題の条件下でそのような整数 $ p $ が必ず存在することが示せます。

### Input &amp; Output Format

最初に、文字列 $ S $ の長さ $ N $ を標準入力から受け取ってください。

> $ N $

次に、あなたはジャッジに対して問題文中の質問を $ 20 $ 回まで繰り返すことができます。

質問は、以下の形式で標準出力に出力してください。 ここで、$ i $ は $ 1\ \leq\ i\ \leq\ N $ を満たす整数でなければなりません。

> ? $ i $

これに対する応答として、$ S_i $ の値が次の形式で標準入力から与えられます。

> $ S_i $

ここで、$ S_i $ は $ 0 $ または $ 1 $ です。

問題文中の条件を満たす整数 $ p $ を見つけたら、解答を以下の形式で出力してください。 その後、ただちにプログラムを終了してください。

> ! $ p $

答えが複数ある場合、どれを出力しても正解とみなされます。

## 说明/提示

### 制約

- $ 2\ \leq\ N\ \leq\ 2\ \times\ 10^5 $
 
### 注意点

- **出力を行うたびに、末尾に改行を入れて標準出力を flush してください。そうしなかった場合、ジャッジ結果が TLE となる可能性があります。**
- **対話の途中で不正な出力を行った、あるいはプログラムが途中で終了した場合のジャッジ結果は不定です。**
- 解答を出力したらただちにプログラムを終了してください。そうしない場合、ジャッジ結果は不定です。
- 文字列 $ S $ はあなたとジャッジの対話の開始時に固定され、あなたが行った質問などに応じて変更されることはありません。
 
### 入出力例

以下は、$ N\ =\ 7,\ S\ =\ 0010011 $ の場合の入出力例です。

    入力 出力 説明     `7`  $ N $ が与えられます。    `? 1` $ S_1 $ が何かをジャッジに質問します。     `0`  質問に対する答えとして $ S_1\ =\ 0 $ がジャッジから返されます。    `? 6` $ S_6 $ が何かをジャッジに質問します。     `1`  質問に対する答えとして $ S_6\ =\ 1 $ がジャッジから返されます。    `? 5` $ S_5 $ が何かをジャッジに質問します。     `0`  質問に対する答えとして $ S_5\ =\ 0 $ がジャッジから返されます。    `! 5` 問題文中の条件を満たす整数 $ p $ として、$ p\ =\ 5 $ を解答します。    解答した $ p\ =\ 5 $ について、$ 1\ \leq\ p\ \leq\ N-1 $ かつ $ S_p\ \neq\ S_{p+1} $ が成り立ちます。 よって、この後ただちにプログラムを終了することで、正解と判定されます。



---

---
title: "[ABC299E] Nearest Black Vertex"
layout: "post"
diff: 普及/提高-
pid: AT_abc299_e
tag: []
---

# [ABC299E] Nearest Black Vertex

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc299/tasks/abc299_e

$ N $ 個の頂点と $ M $ 本の辺からなる、単純（自己ループおよび多重辺を含まない）かつ連結な無向グラフが与えられます。  
$ i\ =\ 1,\ 2,\ \ldots,\ M $ について、$ i $ 番目の辺は頂点 $ u_i $ と頂点 $ v_i $ を結ぶ無向辺です。

各頂点を白または黒で塗る方法であって、下記の $ 2 $ つの条件をともに満たすものが存在するかを判定し、存在する場合はその一例を示してください。

- $ 1 $ 個以上の頂点が黒で塗られている。
- すべての $ i\ =\ 1,\ 2,\ \ldots,\ K $ について、下記の条件が成り立つ。
  - 頂点 $ p_i $ と「黒で塗られた頂点のうち頂点 $ p_i $ からの距離が最小であるもの」の距離がちょうど $ d_i $ である。

ここで、頂点 $ u $ と頂点 $ v $ の距離は、$ u $ と $ v $ を結ぶパスの辺の本数としてあり得る最小値として定義されます。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ M $ $ u_1 $ $ v_1 $ $ u_2 $ $ v_2 $ $ \vdots $ $ u_M $ $ v_M $ $ K $ $ p_1 $ $ d_1 $ $ p_2 $ $ d_2 $ $ \vdots $ $ p_K $ $ d_K $

## 输出格式

問題文中の条件を満たすように各頂点を白または黒で塗る方法が存在しない場合は、`No` を出力せよ。  
存在する場合は、下記の形式の通り、$ 1 $ 行目に `Yes` と出力し、$ 2 $ 行目に各頂点を塗る方法を表す文字列 $ S $ を出力せよ。 ここで、$ S $ は長さ $ N $ の文字列であり、$ i\ =\ 1,\ 2,\ \ldots,\ N $ について $ S $ の $ i $ 文字目は、頂点 $ i $ を黒で塗るとき $ 1 $ 、白で塗るとき $ 0 $ である。

> Yes $ S $

答えが複数ある場合、どれを出力しても正解とみなされる。

## 说明/提示

### 制約

- $ 1\ \leq\ N\ \leq\ 2000 $
- $ N-1\ \leq\ M\ \leq\ \min\lbrace\ N(N-1)/2,\ 2000\ \rbrace $
- $ 1\ \leq\ u_i,\ v_i\ \leq\ N $
- $ 0\ \leq\ K\ \leq\ N $
- $ 1\ \leq\ p_1\ \lt\ p_2\ \lt\ \cdots\ \lt\ p_K\ \leq\ N $
- $ 0\ \leq\ d_i\ \leq\ N $
- 与えられるグラフは単純かつ連結
- 入力はすべて整数

### Sample Explanation 1

例えば、頂点 $ 1,\ 3 $ を黒に、頂点 $ 2,\ 4,\ 5 $ を白に塗るという方法が、問題文中の条件を満たします。 実際、$ i\ =\ 1,\ 2,\ 3,\ 4,\ 5 $ について、頂点 $ i $ と「黒で塗られた頂点のうち頂点 $ i $ からの距離が最小であるもの」の距離を $ A_i $ で表すと、 $ (A_1,\ A_2,\ A_3,\ A_4,\ A_5)\ =\ (0,\ 1,\ 0,\ 1,\ 2) $ であり、特に、$ A_1\ =\ 0,\ A_5\ =\ 2 $ が成り立ちます。

### Sample Explanation 2

問題文中の条件を満たすように各頂点を白または黒で塗る方法が存在しないため、`No` を出力します。

## 样例 #1

### 输入

```
5 5
1 2
2 3
3 1
3 4
4 5
2
1 0
5 2
```

### 输出

```
Yes
10100
```

## 样例 #2

### 输入

```
5 5
1 2
2 3
3 1
3 4
4 5
5
1 1
2 1
3 1
4 1
5 1
```

### 输出

```
No
```

## 样例 #3

### 输入

```
1 0
0
```

### 输出

```
Yes
1
```



---

---
title: "[ABC301D] Bitmask"
layout: "post"
diff: 普及/提高-
pid: AT_abc301_d
tag: []
---

# [ABC301D] Bitmask

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc301/tasks/abc301_d

`0`, `1`, `?` からなる文字列 $ S $ および整数 $ N $ が与えられます。 $ S $ に含まれる `?` をそれぞれ `0` または `1` に置き換えて $ 2 $ 進整数とみなしたときに得られる値の集合を $ T $ とします。 たとえば、$ S= $ `?0?` のとき、 $ T=\lbrace\ 000_{(2)},001_{(2)},100_{(2)},101_{(2)}\rbrace=\lbrace\ 0,1,4,5\rbrace $ です。

$ T $ に含まれる $ N $ 以下の値のうち最大のものを ($ 10 $ 進整数として) 出力してください。 $ N $ 以下の値が $ T $ に含まれない場合は、代わりに `-1` を出力してください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ S $ $ N $

## 输出格式

答えを出力せよ。

## 说明/提示

### 制約

- $ S $ は `0`, `1`, `?` からなる文字列
- $ S $ の長さは $ 1 $ 以上 $ 60 $ 以下
- $ 1\leq\ N\ \leq\ 10^{18} $
- $ N $ は整数

### Sample Explanation 1

問題文中で例示したとおり、$ T=\lbrace\ 0,1,4,5\rbrace $ です。 $ T $ に含まれる $ N $ 以下の値は $ 0 $ と $ 1 $ なので、そのうちの最大である $ 1 $ を出力します。

### Sample Explanation 2

$ T=\lbrace\ 5\rbrace $ であるため、$ N $ 以下の値は $ T $ に含まれません。

## 样例 #1

### 输入

```
?0?
2
```

### 输出

```
1
```

## 样例 #2

### 输入

```
101
4
```

### 输出

```
-1
```

## 样例 #3

### 输入

```
?0?
1000000000000000000
```

### 输出

```
5
```



---

---
title: "[ABC302E] Isolation"
layout: "post"
diff: 普及/提高-
pid: AT_abc302_e
tag: []
---

# [ABC302E] Isolation

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc302/tasks/abc302_e

最初 $ N $ 頂点 $ 0 $ 辺の無向グラフがあり、各頂点には $ 1 $ から $ N $ まで番号がついています。  
 $ Q $ 個のクエリが与えられるので、順に処理し、各クエリの後における「他のどの頂点とも辺で結ばれていない頂点」の数を出力してください。

$ i $ 個目のクエリは $ \mathrm{query}_i $ であり、各クエリは次の $ 2 $ 種類いずれかです。

- `1 u v`: 頂点 $ u $ と頂点 $ v $ を辺で結ぶ。このクエリが与えられる直前の時点で、頂点 $ u $ と頂点 $ v $ は辺で結ばれていない事が保証される。
- `2 v` : 頂点 $ v $ と他の頂点を結ぶ辺をすべて削除する。（頂点 $ v $ 自体は削除しない。）

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ Q $ $ \mathrm{query}_1 $ $ \mathrm{query}_2 $ $ \vdots $ $ \mathrm{query}_Q $

## 输出格式

$ Q $ 行出力せよ。  
 $ i $ 行目 $ (1\leq\ i\leq\ Q) $ には、$ i $ 個目のクエリを処理した後の「他のどの頂点とも辺で結ばれていない頂点」の数を出力せよ。

## 说明/提示

### 制約

- $ 2\ \leq\ N\leq\ 3\times\ 10^5 $
- $ 1\ \leq\ Q\leq\ 3\times\ 10^5 $
- $ 1 $ 番目の種類のクエリにおいて、$ 1\leq\ u,v\leq\ N $, $ u\neq\ v $
- $ 2 $ 番目の種類のクエリにおいて、$ 1\leq\ v\leq\ N $
- $ 1 $ 番目の種類のクエリの直前の時点で、そのクエリの $ u,v $ について頂点 $ u $ と頂点 $ v $ は辺で結ばれていない。
- 入力はすべて整数
 
### Sample Explanation 1

$ 1 $ 個目のクエリの後で、頂点 $ 1 $ と頂点 $ 2 $ は互いに結ばれており、頂点 $ 3 $ のみが他のどの頂点とも辺で結ばれていません。 よって、$ 1 $ 行目には $ 1 $ を出力します。 また、$ 3 $ 個目のクエリの後でどの相異なる $ 2 $ 頂点の間も辺で結ばれていますが、$ 4 $ 個目のクエリによって、 頂点 $ 1 $ と他の頂点を結ぶ辺、すなわち 頂点 $ 1 $ と頂点 $ 2 $ を結ぶ辺および頂点 $ 1 $ と頂点 $ 3 $ を結ぶ辺が削除されます。 この結果として、頂点 $ 2 $ と頂点 $ 3 $ は互いに結ばれているが、頂点 $ 1 $ は他のどの頂点とも辺で結ばれていない状態となります。 よって、$ 3 $ 行目には $ 0 $ を、$ 4 $ 行目には $ 1 $ を出力します。

### Sample Explanation 2

$ 2 $ 番目の種類のクエリを行う直前の時点で、すでにその頂点と他の頂点を結ぶ辺が $ 1 $ 本も存在しないこともあります。

## 样例 #1

### 输入

```
3 7

1 1 2

1 1 3

1 2 3

2 1

1 1 2

2 2

1 1 2
```

### 输出

```
1

0

0

1

0

3

1
```

## 样例 #2

### 输入

```
2 1

2 1
```

### 输出

```
2
```



---

---
title: "[ABC303D] Shift vs. CapsLock"
layout: "post"
diff: 普及/提高-
pid: AT_abc303_d
tag: []
---

# [ABC303D] Shift vs. CapsLock

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc303/tasks/abc303_d

あなたのパソコンのキーボードには、a キー・Shift キー・CapsLock キーの $ 3 $ 種類のキーがあります。また、CapsLock キーにはランプが付いています。 初め、CapsLock キーのランプは OFF であり、パソコンの画面には空文字列が表示されています。

あなたは、以下の $ 3 $ 種類の操作のうち $ 1 $ つを選んで実行するということを $ 0 $ 回以上何度でも行うことができます。

- $ X $ ミリ秒かけて a キーのみを押す。CapsLock キーのランプが OFF ならば画面の文字列の末尾に `a` が付け足され、ON ならば `A` が付け足される。
- $ Y $ ミリ秒かけて Shift キーと a キーを同時に押す。CapsLock キーのランプが OFF ならば画面の文字列の末尾に `A` が付け足され、 ON ならば `a` が付け足される。
- $ Z $ ミリ秒かけて CapsLock キーを押す。CapsLock キーのランプが OFF ならば ON に、ON ならば OFF に切り替わる。

`A` と `a` からなる文字列 $ S $ が与えられます。画面の文字列を $ S $ に一致させるのに必要な最短の時間は何ミリ秒かを求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ X $ $ Y $ $ Z $ $ S $

## 输出格式

答えを出力せよ。

## 说明/提示

### 制約

- $ 1\ \leq\ X,Y,Z\ \leq\ 10^9 $
- $ X,Y,Z $ は整数
- $ 1\ \leq\ |S|\ \leq\ 3\ \times\ 10^5 $
- $ S $ は `A` と `a` からなる文字列

### Sample Explanation 1

以下のように操作を行うと $ 9 $ ミリ秒で画面の文字列を `AAaA` に一致させられます。これが最短の時間です。 - $ Z(=3) $ ミリ秒かけて CapsLock キーを押す。CapsLock キーのランプが ON になる。 - $ X(=1) $ ミリ秒かけて a キーを押す。`A` が画面の文字列の末尾に付け足される。 - $ X(=1) $ ミリ秒かけて a キーを押す。`A` が画面の文字列の末尾に付け足される。 - $ Y(=3) $ ミリ秒かけて Shift キーと a キーを同時に押す。`a` が画面の文字列の末尾に付け足される。 - $ X(=1) $ ミリ秒かけて a キーを押す。`A` が画面の文字列の末尾に付け足される。

## 样例 #1

### 输入

```
1 3 3
AAaA
```

### 输出

```
9
```

## 样例 #2

### 输入

```
1 1 100
aAaAaA
```

### 输出

```
6
```

## 样例 #3

### 输入

```
1 2 4
aaAaAaaAAAAaAaaAaAAaaaAAAAA
```

### 输出

```
40
```



---

---
title: "[ABC303E] A Gift From the Stars"
layout: "post"
diff: 普及/提高-
pid: AT_abc303_e
tag: []
---

# [ABC303E] A Gift From the Stars

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc303/tasks/abc303_e

以下の条件を満たす $ k+1 $ 頂点 $ k $ 辺のグラフをレベル $ k\ (k\geq\ 2) $ の星と呼びます。

- ある $ 1 $ つの頂点が、他の $ k $ 個の頂点と $ 1 $ 本ずつ辺で結ばれている。それ以外の辺は存在しない。
 
高橋君は、はじめ何個かの星からなるグラフを持っていました。そして、以下の手続きを全てのグラフの頂点が連結になるまでくり返し行いました。

- 持っているグラフの頂点から二つの頂点を選ぶ。このとき、選んだ二つの頂点の次数は共に $ 1 $ であり、かつ選んだ二つの頂点は非連結である必要がある。選んだ二つの頂点を結ぶ辺を張る。
 
その後、高橋君は手続きが終了した後のグラフの頂点に、適当に $ 1 $ から $ N $ の番号を付けました。このグラフは木となっており、これを $ T $ と呼びます。$ T $ には $ N-1 $ 本の辺があり、 $ i $ 番目の辺は $ u_i $ と $ v_i $ を結んでいました。

その後高橋君は、はじめ持っていた星の個数とレベルを忘れてしまいました。$ T $ の情報からはじめ持っていた星の個数とレベルを求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ u_1 $ $ v_1 $ $ \vdots $ $ u_{N-1} $ $ v_{N-1} $

## 输出格式

高橋君が持っていた星が $ M $ 個であり、星のレベルがそれぞれ $ L=(L_1,L_2,\ldots,L_M) $ であったとする。 このとき、$ L $ を昇順に並び替え空白区切りで出力せよ。

なお、この問題では常に解が一意に定まることが証明できる。

## 说明/提示

### 制約

- $ 3\leq\ N\leq\ 2\times\ 10^5 $
- $ 1\leq\ u_i,\ v_i\leq\ N $
- 与えられるグラフは、問題文中の手続きによって得られる $ N $ 頂点の木
- 入力は全て整数
 
### Sample Explanation 1

以下の図のように、$ 2 $ つのレベル $ 2 $ の星から $ T $ は得られます。 !\[\](https://img.atcoder.jp/abc303/59ab8e04c23d5f727300be7544b1df7e.png)

## 样例 #1

### 输入

```
6

1 2

2 3

3 4

4 5

5 6
```

### 输出

```
2 2
```

## 样例 #2

### 输入

```
9

3 9

7 8

8 6

4 6

4 1

5 9

7 3

5 2
```

### 输出

```
2 2 2
```

## 样例 #3

### 输入

```
20

8 3

8 18

2 19

8 20

9 17

19 7

8 7

14 12

2 15

14 10

2 13

2 16

2 1

9 5

10 15

14 6

2 4

2 11

5 12
```

### 输出

```
2 3 4 7
```



---

---
title: "[ABC304D] A Piece of Cake"
layout: "post"
diff: 普及/提高-
pid: AT_abc304_d
tag: []
---

# [ABC304D] A Piece of Cake

## 题目描述

在 $xy$-平面上，一块带有一些草莓的蛋糕占据了一块矩形区域 $\{(x,y):0\le x\le W,0\le y\le H\}$。

蛋糕上有 $N$ 个草莓，第 $i$ 个草莓的坐标是 $(p_i,q_i)$。现在，高桥要用小刀按照以下规则将蛋糕切成小块。

- 首先，沿着平行于 $y$ 轴的 $A$ 条直线：直线 $x=a_1$、直线 $x=a_2$、……、直线 $x=a_A$，将蛋糕切开。
- 接着，沿着平行于 $x$ 轴的 $Y$ 条直线：直线 $y=b_1$、直线 $y=b_2$、……、直线 $y=b_B$，将蛋糕切开。

到了最后，蛋糕会被切成 $(A+1)(B+1)$ 块长方形，现在高桥要选择其中一块，求他选择的蛋糕上草莓个数可能的最大值和最小值。

保证切割的边缘线上没有草莓，具体请参照数据范围。

## 输入格式

输入共 $(6+N)$ 行。

第一行两个整数 $W,H$。

第二行一个整数 $N$。

第 $3\sim N+2$ 行，第 $i+2$ 行两个整数 $p_i,q_i$。

第 $N+3$ 行，一个整数 $A$。

接下来一行 $A$ 个整数 $a_1$，$a_2$，……，$a_A$。

第 $N+5$ 行，一个整数 $B$。

接下来一行 $B$ 个整数 $b_1$，$b_2$，……，$b_B$。

以上变量含义均参考题意。

## 输出格式

共一行用空格隔开的两个整数，第一个表示可能的最少的草莓数量，第二个表示可能的最多的草莓数量。

## 样例 #1

### 输入

```
7 6
5
6 1
3 1
4 2
1 5
6 2
2
2 5
2
3 4
```

### 输出

```
0 2
```

## 样例 #2

### 输入

```
4 4
4
1 1
3 1
3 3
1 3
1
2
1
2
```

### 输出

```
1 1
```



---

---
title: "[ABC304E] Good Graph"
layout: "post"
diff: 普及/提高-
pid: AT_abc304_e
tag: []
---

# [ABC304E] Good Graph

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc304/tasks/abc304_e

$ N $ 頂点 $ M $ 辺の無向グラフ $ G $ が与えられます。 $ i\ =\ 1,\ 2,\ \ldots,\ M $ について、$ i $ 番目の辺は頂点 $ u_i $ と頂点 $ v_i $ を結ぶ無向辺です。

$ N $ 頂点のグラフは、すべての $ i\ =\ 1,\ 2,\ \ldots,\ K $ について下記の条件が成り立つとき、**良いグラフ**と呼ばれます。

- $ G $ 上で頂点 $ x_i $ と頂点 $ y_i $ を結ぶパスが存在しない。
 
与えられるグラフ $ G $ は良いグラフです。

$ Q $ 個の独立な質問が与えられるので、それらすべてに答えてください。 $ i\ =\ 1,\ 2,\ \ldots,\ Q $ について、$ i $ 番目の質問は

- 入力で与えられたグラフ $ G $ に頂点 $ p_i $ と頂点 $ q_i $ を結ぶ無向辺を $ 1 $ 本追加して得られるグラフ $ G^{(i)} $ は良いグラフですか？
 
という質問です。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ M $ $ u_1 $ $ v_1 $ $ u_2 $ $ v_2 $ $ \vdots $ $ u_M $ $ v_M $ $ K $ $ x_1 $ $ y_1 $ $ x_2 $ $ y_2 $ $ \vdots $ $ x_K $ $ y_K $ $ Q $ $ p_1 $ $ q_1 $ $ p_2 $ $ q_2 $ $ \vdots $ $ p_Q $ $ q_Q $

## 输出格式

$ Q $ 行出力せよ。 $ i\ =\ 1,\ 2,\ \ldots,\ Q $ について、$ i $ 行目には $ i $ 番目の質問に対する答えを出力せよ。 具体的には、グラフ $ G^{(i)} $ が良いグラフである場合は `Yes` を、良いグラフでない場合は `No` を出力せよ。

## 说明/提示

### 制約

- $ 2\ \leq\ N\ \leq\ 2\ \times\ 10^5 $
- $ 0\ \leq\ M\ \leq\ 2\ \times\ 10^5 $
- $ 1\ \leq\ u_i,\ v_i\ \leq\ N $
- $ 1\ \leq\ K\ \leq\ 2\ \times\ 10^5 $
- $ 1\ \leq\ x_i,\ y_i\ \leq\ N $
- $ x_i\ \neq\ y_i $
- $ i\ \neq\ j\ \implies\ \lbrace\ x_i,\ y_i\ \rbrace\ \neq\ \lbrace\ x_j,\ y_j\ \rbrace $
- すべての $ i\ =\ 1,\ 2,\ \ldots,\ K $ について次が成り立つ：頂点 $ x_i $ と頂点 $ y_i $ を結ぶパスは存在しない。
- $ 1\ \leq\ Q\ \leq\ 2\ \times\ 10^5 $
- $ 1\ \leq\ p_i,\ q_i\ \leq\ N $
- $ p_i\ \neq\ q_i $
- 入力はすべて整数
 
### Sample Explanation 1

\- $ 1 $ 番目の質問に関して、グラフ $ G^{(1)} $ は良いグラフではありません。なぜなら、頂点 $ x_1\ =\ 1 $ と頂点 $ y_1\ =\ 5 $ を結ぶパス $ 1\ \rightarrow\ 2\ \rightarrow\ 5 $ を持つからです。よって、`No` と出力します。 - $ 2 $ 番目の質問に関して、グラフ $ G^{(2)} $ は良いグラフではありません。なぜなら、頂点 $ x_2\ =\ 2 $ と頂点 $ y_2\ =\ 6 $ を結ぶパス $ 2\ \rightarrow\ 6 $ を持つからです。よって、`No` と出力します。 - $ 3 $ 番目の質問に関して、グラフ $ G^{(3)} $ は良いグラフです。よって、`Yes` と出力します。 - $ 4 $ 番目の質問に関して、グラフ $ G^{(4)} $ は良いグラフです。よって、`Yes` と出力します。 この入力例のように、与えられるグラフ $ G $ が自己ループや多重辺を持つ場合があることに注意してください。

## 样例 #1

### 输入

```
6 6

1 2

2 3

2 3

3 1

5 4

5 5

3

1 5

2 6

4 3

4

2 5

2 6

5 6

5 4
```

### 输出

```
No

No

Yes

Yes
```



---

---
title: "[ABC305D] Sleep Log"
layout: "post"
diff: 普及/提高-
pid: AT_abc305_d
tag: []
---

# [ABC305D] Sleep Log

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc305/tasks/abc305_d

高橋くんは睡眠記録をつけています。 睡眠記録は奇数長の数列 $ A=(A\ _\ 1(=0),\ A\ _\ 2,\ldots,A\ _\ N) $ で表され、奇数番目は起床時刻を、偶数番目は就寝時刻を表しています。 より厳密には、睡眠記録をつけている間に高橋くんは次のような睡眠をとりました。

- すべての $ 1\leq\ i\leq\dfrac{N-1}2 $ を満たす整数 $ i $ について、睡眠記録をつけ始めてから $ A\ _\ {2i} $ 分後ちょうどに寝て、$ A\ _\ {2i+1} $ 分後ちょうどに起きた。
- それ以外の時間に寝ることも起きることもなかった。
 
次の $ Q $ 個の質問に答えてください。 $ i $ 番目の質問では、$ 0\leq\ l\ _\ i\leq\ r\ _\ i\leq\ A\ _\ N $ を満たす整数の組 $ (l\ _\ i,r\ _\ i) $ が与えられます。

- 睡眠記録をつけ始めてから $ l\ _\ i $ 分後ちょうどから $ r\ _\ i $ 分後ちょうどまでの $ r\ _\ i-l\ _\ i $ 分のうち、高橋くんが寝ていたのは何分間ですか？

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ A\ _\ 1 $ $ A\ _\ 2 $ $ \ldots $ $ A\ _\ N $ $ Q $ $ l\ _\ 1 $ $ r\ _\ 1 $ $ l\ _\ 2 $ $ r\ _\ 2 $ $ \vdots $ $ l\ _\ Q $ $ r\ _\ Q $

## 输出格式

答えを $ Q $ 行で出力せよ。 $ i $ 行目には $ i $ 番目の質問の答えを整数として出力せよ。

## 说明/提示

### 制約

- $ 3\leq\ N\lt2\times10^5 $
- $ N $ は奇数
- $ 0=A\ _\ 1\lt\ A\ _\ 2\lt\cdots\lt\ A\ _\ N\leq10^9 $
- $ 1\leq\ Q\leq2\times10^5 $
- $ 0\leq\ l\ _\ i\leq\ r\ _\ i\leq\ A\ _\ N\ (1\leq\ i\leq\ Q) $
- 入力はすべて整数
 
### Sample Explanation 1

高橋くんは、以下の図のように睡眠をとりました。 ![](https://img.atcoder.jp/abc305/fe8152a63de7fea649d1d02197649a6a.png) それぞれの質問の答えは以下のようになります。 - 睡眠記録をつけ始めてから $ 480 $ 分後から $ 1920 $ 分後の間、高橋くんは $ 480 $ 分後から $ 720 $ 分後、$ 1320 $ 分後から $ 1440 $ 分後、$ 1800 $ 分後から $ 1920 $ 分後の $ 3 $ つの睡眠をとりました。睡眠時間の合計は $ 240+120+120=480 $ 分です。 - 睡眠記録をつけ始めてから $ 720 $ 分後から $ 1200 $ 分後の間、高橋くんは睡眠をとりませんでした。睡眠時間の合計は $ 0 $ 分です。 - 睡眠記録をつけ始めてから $ 0 $ 分後から $ 2160 $ 分後の間、高橋くんは $ 240 $ 分後から $ 720 $ 分後、$ 1320 $ 分後から $ 1440 $ 分後、$ 1800 $ 分後から $ 2160 $ 分後の $ 3 $ つの睡眠をとりました。睡眠時間の合計は $ 480+120+360=960 $ 分です。 よって、それぞれの行に $ 480,0,960 $ と出力してください。

## 样例 #1

### 输入

```
7

0 240 720 1320 1440 1800 2160

3

480 1920

720 1200

0 2160
```

### 输出

```
480

0

960
```

## 样例 #2

### 输入

```
21

0 20 62 192 284 310 323 324 352 374 409 452 486 512 523 594 677 814 838 946 1000

10

77 721

255 541

478 970

369 466

343 541

42 165

16 618

222 592

730 983

338 747
```

### 输出

```
296

150

150

49

89

20

279

183

61

177
```



---

---
title: "[ABC305E] Art Gallery on Graph"
layout: "post"
diff: 普及/提高-
pid: AT_abc305_e
tag: []
---

# [ABC305E] Art Gallery on Graph

## 题目描述

### 题面

给定一张 $N$ 个点（编号为 $1 \sim N$），$M$ 条边的无向图，保证无重边无自环。现在有 $K$ 个被标记的点，其中第 $i$ 个被标记的点的编号为 $p_i$，任何从 $p_i$ 出发经过不超过 $h_i$ 条边能到达的点都会被染色（包括 $p_i$ 自身）。你需要求出这张图最终有哪些点被染色。


接下来 $M$ 行，每行两个正整数 $a_i,b_i$，表示编号为 $a_i,b_i$ 的点连有一条无向边。

## 输出格式

第一行一个数字 $G$，表示被染色的点的个数。

第二行 $G$ 个数字，表示被染色的点，按照从小到大的顺序输出。

## 说明/提示

$1 \le N \le 2 \times 10^5$，$0 \le M \le 2 \times 10^5$，$1 \le K,a_i,b_i,p_i,h_i \le N$，$p_i$ 互不相同。

保证给定的图无重边，无自环。

## 样例 #1

### 输入

```
5 5 2

1 2

2 3

2 4

3 5

1 5

1 1

5 2
```

### 输出

```
4

1 2 3 5
```

## 样例 #2

### 输入

```
3 0 1

2 3
```

### 输出

```
1

2
```

## 样例 #3

### 输入

```
10 10 2

2 1

5 1

6 1

2 4

2 5

2 10

8 5

8 6

9 6

7 9

3 4

8 2
```

### 输出

```
7

1 2 3 5 6 8 9
```



---

---
title: "[ABC306E] Best Performances"
layout: "post"
diff: 普及/提高-
pid: AT_abc306_e
tag: []
---

# [ABC306E] Best Performances

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc306/tasks/abc306_e

長さ $ N $ の数列 $ A=(A_1,A_2,\dots,A_N) $ があり、最初全ての項が $ 0 $ です。  
 入力で与えられる整数 $ K $ を用いて関数 $ f(A) $ を以下のように定義します。

- $ A $ を降順に (広義単調減少となるように) ソートしたものを $ B $ とする。
- このとき、 $ f(A)=B_1\ +\ B_2\ +\ \dots\ +\ B_K $ とする。
 
この数列に合計 $ Q $ 回の更新を行うことを考えます。  
 数列 $ A $ に対し以下の更新を $ i=1,2,\dots,Q $ の順に行い、各更新ごとにその時点での $ f(A) $ の値を出力してください。

- $ A_{X_i} $ を $ Y_i $ に変更する。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ K $ $ Q $ $ X_1 $ $ Y_1 $ $ X_2 $ $ Y_2 $ $ \vdots $ $ X_Q $ $ Y_Q $

## 输出格式

全体で $ Q $ 行出力せよ。そのうち $ i $ 行目には $ i $ 回目の更新を終えた時点での $ f(A) $ の値を整数として出力せよ。

## 说明/提示

### 制約

- 入力は全て整数
- $ 1\ \le\ K\ \le\ N\ \le\ 5\ \times\ 10^5 $
- $ 1\ \le\ Q\ \le\ 5\ \times\ 10^5 $
- $ 1\ \le\ X_i\ \le\ N $
- $ 0\ \le\ Y_i\ \le\ 10^9 $
 
### Sample Explanation 1

この入力では $ N=4,K=2 $ です。 $ Q=10 $ 回の更新を行います。 - $ 1 $ 回目の更新を受けて $ A=(5,0,0,0) $ となります。このとき $ f(A)=5 $ です。 - $ 2 $ 回目の更新を受けて $ A=(5,1,0,0) $ となります。このとき $ f(A)=6 $ です。 - $ 3 $ 回目の更新を受けて $ A=(5,1,3,0) $ となります。このとき $ f(A)=8 $ です。 - $ 4 $ 回目の更新を受けて $ A=(5,1,3,2) $ となります。このとき $ f(A)=8 $ です。 - $ 5 $ 回目の更新を受けて $ A=(5,10,3,2) $ となります。このとき $ f(A)=15 $ です。 - $ 6 $ 回目の更新を受けて $ A=(0,10,3,2) $ となります。このとき $ f(A)=13 $ です。 - $ 7 $ 回目の更新を受けて $ A=(0,10,3,0) $ となります。このとき $ f(A)=13 $ です。 - $ 8 $ 回目の更新を受けて $ A=(0,10,1,0) $ となります。このとき $ f(A)=11 $ です。 - $ 9 $ 回目の更新を受けて $ A=(0,0,1,0) $ となります。このとき $ f(A)=1 $ です。 - $ 10 $ 回目の更新を受けて $ A=(0,0,0,0) $ となります。このとき $ f(A)=0 $ です。

## 样例 #1

### 输入

```
4 2 10

1 5

2 1

3 3

4 2

2 10

1 0

4 0

3 1

2 0

3 0
```

### 输出

```
5

6

8

8

15

13

13

11

1

0
```



---

---
title: "[ABC307C] Ideal Sheet"
layout: "post"
diff: 普及/提高-
pid: AT_abc307_c
tag: []
---

# [ABC307C] Ideal Sheet

## 题目描述

高桥有两张由方格组成的薄片，每个方格可能是透明的或黑色的。第一张的高 $H_A$ 宽 $W_A$ 个格子, 第二张高 $H_B$ 宽 $W_B$ 个格子。现在高桥将它们通过平移重叠在一起（不能旋转翻转），相对位置任意，想要得到图形 $X$ (高宽$H_X$,$W_X$)，请输出是否可能。用`.`表示透明格子，`#`表示黑色格子。

## 输入格式

第一行两个整数 $H_A$ , $W_A$
接下来 $H_A$ 行字符，表示薄片 $A$。
同理输入薄片 $B$ , $X$。

## 输出格式

一行，`Yes`表示可能，`No`表示不可能得到 $X$。

## 说明/提示

$1\leq$ 所有薄片高、宽 $\leq 10$ 
### 样例解释
Sample Explanation $2$ 
不能旋转薄片，因此不能得到 $X$ 。

## 样例 #1

### 输入

```
3 5
#.#..
.....
.#...
2 2
#.
.#
5 3
...
#.#
.#.
.#.
...
```

### 输出

```
Yes
```

## 样例 #2

### 输入

```
2 2
#.
.#
2 2
#.
.#
2 2
##
##
```

### 输出

```
No
```

## 样例 #3

### 输入

```
1 1
#
1 2
##
1 1
#
```

### 输出

```
No
```

## 样例 #4

### 输入

```
3 3
###
...
...
3 3
#..
#..
#..
3 3
..#
..#
###
```

### 输出

```
Yes
```



---

---
title: "[ABC307D] Mismatched Parentheses"
layout: "post"
diff: 普及/提高-
pid: AT_abc307_d
tag: []
---

# [ABC307D] Mismatched Parentheses

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc307/tasks/abc307_d

英小文字および `(`, `)` からなる長さ $ N $ の文字列 $ S $ が与えられます。  
 以下の操作を可能な限り繰り返したあとの $ S $ を出力してください。

- $ S $ の連続部分文字列であって、最初の文字が `(` かつ 最後の文字が `)` かつ 最初と最後以外に `(` も `)` も含まないものを自由に $ 1 $ つ選び削除する
 
なお、操作を可能な限り繰り返したあとの $ S $ は操作の手順によらず一意に定まることが証明できます。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ S $

## 输出格式

答えを出力せよ。

## 说明/提示

### 制約

- $ 1\ \leq\ N\ \leq\ 2\ \times\ 10^5 $
- $ N $ は整数である
- $ S $ は英小文字および `(`, `)` からなる長さ $ N $ の文字列である
 
### Sample Explanation 1

例えば、以下の手順により操作後の $ S $ が `ac` となります。 - $ S $ の $ 4 $ 文字目から $ 6 $ 文字目までからなる部分文字列 `(d)` を削除する。$ S $ は `a(b)c` となる。 - $ S $ の $ 2 $ 文字目から $ 4 $ 文字目までからなる部分文字列 `(b)` を削除する。$ S $ は `ac` となる。 - これ以上操作を行うことはできない。

### Sample Explanation 3

操作後の $ S $ は空文字列になる可能性があります。

## 样例 #1

### 输入

```
8

a(b(d))c
```

### 输出

```
ac
```

## 样例 #2

### 输入

```
5

a(b)(
```

### 输出

```
a(
```

## 样例 #3

### 输入

```
2

()
```

### 输出

```

```

## 样例 #4

### 输入

```
6

)))(((
```

### 输出

```
)))(((
```



---

---
title: "[ABC307E] Distinct Adjacent"
layout: "post"
diff: 普及/提高-
pid: AT_abc307_e
tag: []
---

# [ABC307E] Distinct Adjacent

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc307/tasks/abc307_e

$ 1 $ から $ N $ の番号がついた $ N $ 人の人が輪になってならんでいます。人 $ 1 $ の右隣には人 $ 2 $ が、人 $ 2 $ の右隣には人 $ 3 $ が、……、人 $ N $ の右隣には人 $ 1 $ がいます。

$ N $ 人の人にそれぞれ $ 0 $ 以上 $ M $ 未満の整数を $ 1 $ つずつ渡します。  
$ M^N $ 通りの渡し方のうち、どの隣り合う $ 2 $ 人が渡された数も異なるものの数を、$ 998244353 $ で割ったあまりを求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ M $

## 输出格式

答えを出力せよ。

## 说明/提示

### 制約

- $ 2\ \leq\ N,M\ \leq\ 10^6 $
- $ N,M $ は整数である

### Sample Explanation 1

人 $ 1,2,3 $ に渡す整数がそれぞれ $ (0,1,2),(0,2,1),(1,0,2),(1,2,0),(2,0,1),(2,1,0) $ のときの $ 6 $ 通りです。

### Sample Explanation 2

人 $ 1,2,3,4 $ に渡す整数がそれぞれ $ (0,1,0,1),(1,0,1,0) $ のときの $ 2 $ 通りです。

### Sample Explanation 3

$ 998244353 $ で割ったあまりを求めてください。

## 样例 #1

### 输入

```
3 3
```

### 输出

```
6
```

## 样例 #2

### 输入

```
4 2
```

### 输出

```
2
```

## 样例 #3

### 输入

```
987654 456789
```

### 输出

```
778634319
```



---

---
title: "[ABC308D] Snuke Maze"
layout: "post"
diff: 普及/提高-
pid: AT_abc308_d
tag: []
---

# [ABC308D] Snuke Maze

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc308/tasks/abc308_d

$ H $ 行 $ W $ 列のグリッドがあります。 以下、上から $ i $ 行目、左から $ j $ 列目のマスを $ (i,j) $ と表記します。 グリッドの各マスには英小文字が書かれており、$ (i,j) $ に書かれた文字は与えられる文字列 $ S_i $ の $ j $ 文字目と一致します。

すぬけくんは、辺で隣接するマスに移動することを繰り返して $ (1,1) $ から $ (H,W) $ まで移動しようと思っています。 訪れるマス （最初の $ (1,1) $ と 最後の $ (H,W) $ を含む）に書かれた文字が、 訪れる順に `s` $ \rightarrow $ `n` $ \rightarrow $ `u` $ \rightarrow $ `k` $ \rightarrow $ `e` $ \rightarrow $ `s` $ \rightarrow $ `n` $ \rightarrow\ \dots $ となるような経路が存在するか判定してください。 なお、$ 2 $ つのマス $ (i_1,j_1),(i_2,j_2) $ は $ |i_1-i_2|+|j_1-j_2|\ =\ 1 $ を満たすとき、またそのときに限り「辺で隣接する」といいます。

より厳密には、マスの列 $ ((i_1,j_1),(i_2,j_2),\dots,(i_k,j_k)) $ であって以下の条件を全て満たすものが存在するか判定してください。

- $ (i_1,j_1)\ =\ (1,1),(i_k,j_k)\ =\ (H,W) $
- すべての $ t\ (1\ \leq\ t\ <\ k) $ について、$ (i_t,j_t) $ と $ (i_{t+1},j_{t+1}) $ は辺で隣接する
- すべての $ t\ (1\ \leq\ t\ \leq\ k) $ について、$ (i_t,j_t) $ に書かれた文字は `snuke` の $ ((t-1)\ \bmod\ 5)\ +\ 1 $ 文字目と一致する

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ H $ $ W $ $ S_1 $ $ S_2 $ $ \vdots $ $ S_H $

## 输出格式

問題文中の条件を満たす経路が存在するならば `Yes` を、存在しないならば `No` を出力せよ。

## 说明/提示

### 制約

- $ 2\leq\ H,W\ \leq\ 500 $
- $ H,W $ は整数
- $ S_i $ は英小文字からなる長さ $ W $ の文字列
 
### Sample Explanation 1

$ (1,1)\ \rightarrow\ (1,2)\ \rightarrow\ (2,2)\ \rightarrow\ (2,3) $ という経路は、訪れたマスに書かれた文字が訪れた順に `s` $ \rightarrow $ `n` $ \rightarrow $ `u` $ \rightarrow $ `k` となるため条件を満たします。

## 样例 #1

### 输入

```
2 3

sns

euk
```

### 输出

```
Yes
```

## 样例 #2

### 输入

```
2 2

ab

cd
```

### 输出

```
No
```

## 样例 #3

### 输入

```
5 7

skunsek

nukesnu

ukeseku

nsnnesn

uekukku
```

### 输出

```
Yes
```



---

---
title: "[ABC309D] Add One Edge"
layout: "post"
diff: 普及/提高-
pid: AT_abc309_d
tag: []
---

# [ABC309D] Add One Edge

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc309/tasks/abc309_d

$ N_1+N_2 $ 頂点 $ M $ 辺の無向グラフがあります。$ i=1,2,\ldots,M $ に対し、$ i $ 番目の辺は頂点 $ a_i $ と頂点 $ b_i $ を結びます。  
 また、以下を満たすことが保障されます。

- $ 1\ \leq\ u,v\ \leq\ N_1 $ を満たす整数 $ u,v $ に対し、頂点 $ u $ と頂点 $ v $ は連結
- $ N_1+1\ \leq\ u,v\ \leq\ N_1+N_2 $ を満たす整数 $ u,v $ に対し、頂点 $ u $ と頂点 $ v $ は連結
- 頂点 $ 1 $ と頂点 $ N_1+N_2 $ は非連結
 
次の操作をちょうど $ 1 $ 回行います。

- $ 1\ \leq\ u\ \leq\ N_1 $ を満たす整数 $ u $ と $ N_1+1\ \leq\ v\ \leq\ N_1+N_2 $ を満たす整数 $ v $ を選び、頂点 $ u $ と頂点 $ v $ を結ぶ辺を追加する
 
操作後のグラフにおいて、頂点 $ 1 $ と頂点 $ N_1+N_2 $ は必ず連結であることが示せます。そこで、頂点 $ 1 $ と頂点 $ N_1+N_2 $ を結ぶ経路の長さ(辺の本数)の最小値を $ d $ とします。

操作で追加する辺を適切に選んだ時にありえる $ d $ の最大値を求めてください。

  連結とは？ 無向グラフの頂点 $ u,v $ が連結であるとは、頂点 $ u $ と頂点 $ v $ を結ぶ経路が存在することをいいます。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N_1 $ $ N_2 $ $ M $ $ a_1 $ $ b_1 $ $ \vdots $ $ a_M $ $ b_M $

## 输出格式

答えを出力せよ。

## 说明/提示

### 制約

- $ 1\ \leq\ N_1,N_2\ \leq\ 1.5\ \times\ 10^5 $
- $ 0\ \leq\ M\ \leq\ 3\ \times\ 10^5 $
- $ 1\ \leq\ a_i\ \leq\ b_i\ \leq\ N_1+N_2 $
- $ i\ \neq\ j $ ならば $ (a_i,b_i)\ \neq\ (a_j,b_j) $
- $ 1\ \leq\ u,v\ \leq\ N_1 $ を満たす整数 $ u,v $ に対し、頂点 $ u $ と頂点 $ v $ は連結
- $ N_1+1\ \leq\ u,v\ \leq\ N_1+N_2 $ を満たす整数 $ u,v $ に対し、頂点 $ u $ と頂点 $ v $ は連結
- 頂点 $ 1 $ と頂点 $ N_1+N_2 $ は非連結
- 入力はすべて整数
 
### Sample Explanation 1

$ u=2,v=5 $ として操作することで $ d=5 $ と出来ます。これが最大値です。 !\[\](https://img.atcoder.jp/abc309/a64d8034b08cfa7d1f655767cc164653.png)

## 样例 #1

### 输入

```
3 4 6

1 2

2 3

4 5

4 6

1 3

6 7
```

### 输出

```
5
```

## 样例 #2

### 输入

```
7 5 20

10 11

4 5

10 12

1 2

1 5

5 6

2 4

3 5

9 10

2 5

1 4

11 12

9 12

8 9

5 7

3 7

3 6

3 4

8 12

9 11
```

### 输出

```
4
```



---

---
title: "[ABC309E] Family and Insurance"
layout: "post"
diff: 普及/提高-
pid: AT_abc309_e
tag: []
---

# [ABC309E] Family and Insurance

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc309/tasks/abc309_e

人 $ 1 $、人 $ 2 $、$ \ldots $、人 $ N $ からなる家系があります。$ i\geq\ 2 $ に対し、人 $ i $ の親は人 $ p_i $ です。

この家系の人たちは $ M $ 回保険に加入しました。$ i=1,2,\ldots,M $ に対し、$ i $ 番目の保険の加入者は人 $ x_i $ で、本人及びその $ y_i $ 代先までの子たちが補償対象者です。

$ 1 $ 個以上の保険の補償対象者になっている人が何人いるかを求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ M $ $ p_2 $ $ \ldots $ $ p_N $ $ x_1 $ $ y_1 $ $ \vdots $ $ x_M $ $ y_M $

## 输出格式

答えを出力せよ。

## 说明/提示

### 制約

- $ 2\ \leq\ N\ \leq\ 3\ \times\ 10^5 $
- $ 1\ \leq\ M\ \leq\ 3\ \times\ 10^5 $
- $ 1\ \leq\ p_i\ \leq\ i-1 $
- $ 1\ \leq\ x_i\ \leq\ N $
- $ 1\ \leq\ y_i\ \leq\ 3\ \times\ 10^5 $
- 入力はすべて整数
 
### Sample Explanation 1

$ 1 $ 番目の保険について、人 $ 1 $ の $ 1 $ 代先の子たちは人 $ 2 $ と人 $ 4 $ なので人 $ 1,2,4 $ が補償対象者です。 $ 2 $ 番目の保険について、人 $ 1 $ の $ 1 $ 代先の子たちは人 $ 2 $ と人 $ 4 $、$ 2 $ 代先の子は人 $ 3 $ なので人 $ 1,2,3,4 $ が補償対象者です。 $ 3 $ 番目の保険について、人 $ 4 $ の $ 1,2,3 $ 代先の子は存在しないので人 $ 4 $ が補償対象者です。 以上より、$ 1 $ 個以上の保険の補償対象者になっている人は人 $ 1,2,3,4 $ の $ 4 $ 人です。

## 样例 #1

### 输入

```
7 3

1 2 1 3 3 3

1 1

1 2

4 3
```

### 输出

```
4
```

## 样例 #2

### 输入

```
10 10

1 1 3 1 2 3 3 5 7

2 1

5 1

4 3

6 3

2 1

7 3

9 2

1 2

6 2

8 1
```

### 输出

```
10
```



---

---
title: "[ABC324D] Square Permutation"
layout: "post"
diff: 普及/提高-
pid: AT_abc324_d
tag: []
---

# [ABC324D] Square Permutation

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc324/tasks/abc324_d

数字のみからなる、長さ $ N $ の文字列 $ S $ が与えられます。

$ S $ を並べ替えてできる文字列を十進法の整数として解釈したもののうち、平方数であるようなものがいくつあるか求めてください。

より厳密には、次のようになります。

$ S $ の先頭から $ i $ 番目 $ (1\leq\ i\leq\ N) $ の数字に対応する数を $ s\ _\ i $ とします。

$ (1,\ \ldots,\ N) $ の順列 $ P=(p\ _\ 1,p\ _\ 2,\ldots,p\ _\ N) $ によって $ \displaystyle\ \sum\ _\ {i=1}\ ^\ N\ s\ _\ {p\ _\ i}10\ ^\ {N-i} $ と書ける整数のうち、平方数であるようなものがいくつあるか求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ S $

## 输出格式

答えを $ 1 $ 行で出力せよ。

## 说明/提示

### 制約

- $ 1\leq\ N\leq\ 13 $
- $ S $ は数字のみからなる長さ $ N $ の文字列
- $ N $ は整数
 
### Sample Explanation 1

$ P=(4,2,3,1) $ とすると、$ s\ _\ 4\times10\ ^\ 3+s\ _\ 2\times10\ ^\ 2+s\ _\ 3\times10\ ^\ 1+s\ _\ 1=324=18\ ^\ 2 $ となります。 $ P=(3,2,4,1) $ とすると、$ s\ _\ 3\times10\ ^\ 3+s\ _\ 2\times10\ ^\ 2+s\ _\ 4\times10\ ^\ 1+s\ _\ 1=2304=48\ ^\ 2 $ となります。 これら以外の並べ替え方では平方数にならないため、$ 2 $ を出力してください。

### Sample Explanation 2

$ P=(1,3,2) $ もしくは $ P=(3,1,2) $ とすると、$ \displaystyle\sum\ _\ {i=1}\ ^\ Ns\ _\ {p\ _\ i}10\ ^\ {N-i}=1=1\ ^\ 2 $ となります。 $ P=(2,1,3) $ もしくは $ P=(2,3,1) $ とすると、$ \displaystyle\sum\ _\ {i=1}\ ^\ Ns\ _\ {p\ _\ i}10\ ^\ {N-i}=100=10\ ^\ 2 $ となります。 これら以外の並べ替え方では平方数にならないため、$ 2 $ を出力してください。 異なる並べ替え方でも、並べ替えた結果の数が同じなら $ 1 $ つと数えることに注意してください。

## 样例 #1

### 输入

```
4

4320
```

### 输出

```
2
```

## 样例 #2

### 输入

```
3

010
```

### 输出

```
2
```

## 样例 #3

### 输入

```
13

8694027811503
```

### 输出

```
840
```



---

---
title: "[ABC324E] Joint Two Strings"
layout: "post"
diff: 普及/提高-
pid: AT_abc324_e
tag: []
---

# [ABC324E] Joint Two Strings

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc324/tasks/abc324_e

英小文字からなる $ N $ 個の文字列 $ S_1,\ S_2,\ \ldots,\ S_N $ 、および、英小文字からなる文字列 $ T $ が与えられます。

$ 1 $ 以上 $ N $ 以下の $ 2 $ つの整数からなる組 $ (i,\ j) $ は $ N^2 $ 個ありますが、そのうち下記の条件を満たすものの個数を出力してください。

- $ S_i $ と $ S_j $ をこの順に連結して得られる文字列は、$ T $ を（連続とは限らない）部分列として含む。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ T $ $ S_1 $ $ S_2 $ $ \vdots $ $ S_N $

## 输出格式

答えを出力せよ。

## 说明/提示

### 制約

- $ N $ は整数
- $ 1\ \leq\ N\ \leq\ 5\ \times\ 10^5 $
- $ S_i $ および $ T $ は英小文字からなる長さ $ 1 $ 以上 $ 5\ \times\ 10^5 $ 以下の文字列
- $ S_1,\ S_2,\ \ldots,\ S_N $ の長さの総和は $ 5\ \times\ 10^5 $ 以下
 
### Sample Explanation 1

問題文中の条件を満たす組 $ (i,\ j) $ は、下記に示す $ 3 $ 個の組 $ (1,\ 2),\ (1,\ 3),\ (2,\ 3) $ です。 - $ (i,\ j)\ =\ (1,\ 2) $ について、$ S_1 $ と $ S_2 $ をこの順に連結して得られる文字列 `abbabcb` は `bac` を部分列として含みます。 - $ (i,\ j)\ =\ (1,\ 3) $ について、$ S_1 $ と $ S_3 $ をこの順に連結して得られる文字列 `abbaaaca` は `bac` を部分列として含みます。 - $ (i,\ j)\ =\ (2,\ 3) $ について、$ S_2 $ と $ S_3 $ をこの順に連結して得られる文字列 `bcbaaca` は `bac` を部分列として含みます。

## 样例 #1

### 输入

```
3 bac

abba

bcb

aaca
```

### 输出

```
3
```

## 样例 #2

### 输入

```
5 xx

x

x

x

x

x
```

### 输出

```
25
```

## 样例 #3

### 输入

```
1 y

x
```

### 输出

```
0
```

## 样例 #4

### 输入

```
10 ms

mkgn

m

hlms

vmsle

mxsm

nnzdhi

umsavxlb

ffnsybomr

yvmm

naouel
```

### 输出

```
68
```



---

---
title: "[ABC326D] ABC Puzzle"
layout: "post"
diff: 普及/提高-
pid: AT_abc326_d
tag: []
---

# [ABC326D] ABC Puzzle

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc326/tasks/abc326_d

整数 $ N $ と `A`, `B`, `C` からなる長さ $ N $ の文字列 $ R,C $ が与えられるので、以下の問題を解いてください。

$ N\ \times\ N $ のマス目があり、最初全てのマスは空きマスです。  
 各マスに `A`, `B`, `C` のうち高々 $ 1 $ 文字を書き込みます。( 空きマスのままにすることも許されます )

以下の条件を全て満たすことが可能であるか判定し、可能であれば書き込み方を $ 1 $ つ出力して下さい。

- 各行 / 各列 に `A`, `B`, `C` がちょうど $ 1 $ 個ずつ含まれる
- $ i $ 行目に書かれた文字の中で最も左にある文字は $ R $ の $ i $ 文字目と一致する
- $ i $ 列目に書かれた文字の中で最も上にある文字は $ C $ の $ i $ 文字目と一致する

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ R $ $ C $

## 输出格式

問題文中の条件を満たす書き込み方が存在しない場合、 `No` と $ 1 $ 行に出力してください。  
 そうでない場合、以下の形式に従い書き込み方を出力してください。

> Yes $ A_1 $ $ A_2 $ $ \vdots $ $ A_N $

まず、 $ 1 $ 行目に `Yes` と出力してください。 続く $ N $ 行のうちの $ i $ 行目に、長さ $ N $ の文字列である $ A_i $ を出力してください。

- $ A_i $ の $ j $ 文字目が `.` であるとき、上から $ i $ 行目、左から $ j $ 列目のマスは空きマスであることを示します。
- $ A_i $ の $ j $ 文字目が `A` であるとき、上から $ i $ 行目、左から $ j $ 列目のマスに `A` が書き込まれたことを示します。
- $ A_i $ の $ j $ 文字目が `B` であるとき、上から $ i $ 行目、左から $ j $ 列目のマスに `B` が書き込まれたことを示します。
- $ A_i $ の $ j $ 文字目が `C` であるとき、上から $ i $ 行目、左から $ j $ 列目のマスに `C` が書き込まれたことを示します。
 
正しい書き込み方が複数存在する場合、どれを出力しても構いません。

## 说明/提示

### 制約

- $ N $ は $ 3 $ 以上 $ 5 $ 以下の整数
- $ R,C $ は `A`, `B`, `C` からなる長さ $ N $ の文字列
 
### Sample Explanation 1

出力例のマス目は以下の条件を全て満たすため、正解として扱われます。 - 全ての行に `A`, `B`, `C` がちょうど $ 1 $ 個ずつ含まれる - 全ての列に `A`, `B`, `C` がちょうど $ 1 $ 個ずつ含まれる - 各行に書かれた最も左の文字は上から順に `A`, `B`, `C`, `B`, `C` である - 各列に書かれた最も上の文字は左から順に `A`, `C`, `A`, `A`, `B` である

### Sample Explanation 2

この入力では、条件を満たす書き込み方は存在しません。

## 样例 #1

### 输入

```
5

ABCBC

ACAAB
```

### 输出

```
Yes

AC..B

.BA.C

C.BA.

BA.C.

..CBA
```

## 样例 #2

### 输入

```
3

AAA

BBB
```

### 输出

```
No
```



---

---
title: "[ABC327D] Good Tuple Problem"
layout: "post"
diff: 普及/提高-
pid: AT_abc327_d
tag: []
---

# [ABC327D] Good Tuple Problem

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc327/tasks/abc327_d

$ N $ 以下の正整数からなる長さ $ M $ の数列の組 $ (S,\ T)\ =\ ((S_1,\ S_2,\ \dots,\ S_M),\ (T_1,\ T_2,\ \dots,\ T_M)) $ が **良い数列の組である** とは、$ (S,\ T) $ が次の条件を満たすことを言います。

- $ 0,1 $ からなる長さ $ N $ の数列 $ X\ =\ (X_1,\ X_2,\ \dots,\ X_N) $ であって次の条件を満たすものが存在する。
  - $ i=1,\ 2,\ \dots,\ M $ それぞれについて、$ X_{S_i}\ \neq\ X_{T_i} $ が成立する。
 
$ N $ 以下の正整数からなる長さ $ M $ の数列の組 $ (A,\ B)\ =\ ((A_1,\ A_2,\ \dots,\ A_M),\ (B_1,\ B_2,\ \dots,\ B_M)) $ が与えられます。$ (A,\ B) $ が良い数列の組である場合は `Yes` を、そうでない場合は `No` を出力してください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ M $ $ A_1 $ $ A_2 $ $ \dots $ $ A_M $ $ B_1 $ $ B_2 $ $ \dots $ $ B_M $

## 输出格式

$ (A,\ B) $ が良い数列の組である場合は `Yes` を、そうでない場合は `No` を出力せよ。

## 说明/提示

### 制約

- $ 1\ \leq\ N,\ M\ \leq\ 2\ \times\ 10^5 $
- $ 1\ \leq\ A_i,\ B_i\ \leq\ N $
- 入力される値は全て整数
 
### Sample Explanation 1

$ X=(0,1,0) $ とすると、$ X $ は $ 0,1 $ からなる長さ $ N $ の数列で、 $ X_{A_1}\ \neq\ X_{B_1} $ かつ $ X_{A_2}\ \neq\ X_{B_2} $ を満たします。 よって、$ (A,B) $ は良い数列の組としての条件を満たしています。

### Sample Explanation 2

条件を満たすような数列 $ X $ は存在しないので、$ (A,\ B) $ は良い数列の組ではありません。

## 样例 #1

### 输入

```
3 2

1 2

2 3
```

### 输出

```
Yes
```

## 样例 #2

### 输入

```
3 3

1 2 3

2 3 1
```

### 输出

```
No
```

## 样例 #3

### 输入

```
10 1

1

1
```

### 输出

```
No
```

## 样例 #4

### 输入

```
7 8

1 6 2 7 5 4 2 2

3 2 7 2 1 2 3 3
```

### 输出

```
Yes
```



---

---
title: "[ABC329F] Colored Ball"
layout: "post"
diff: 普及/提高-
pid: AT_abc329_f
tag: []
---

# [ABC329F] Colored Ball

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc329/tasks/abc329_f

$ 1,\ 2,\ \ldots,\ N $ の番号がついた $ N $ 個の箱があり、はじめ箱 $ i $ には色 $ C_i $ のボールが $ 1 $ つ入っています。

$ Q $ 個のクエリが与えられるので、これらを順に処理してください。

各クエリは整数の組 $ (a,b) $ によって与えられ、その内容は以下の通りです。

- 箱 $ a $ のボールをすべて箱 $ b $ に移し、その後箱 $ b $ に何種類の色のボールが入っているかを出力する。
 
ただし、箱 $ a $ や箱 $ b $ が空の場合もあることに注意してください。

## 输入格式

入力は以下の形式で標準入力から与えられる。ここで、 $ \text{query}_i $ は $ i $ 番目のクエリを意味する。

> $ N $ $ Q $ $ C_1 $ $ C_2 $ $ \ldots $ $ C_N $ $ \text{query}_1 $ $ \text{query}_2 $ $ \vdots $ $ \text{query}_Q $

各クエリは次の形式で与えられる。

> $ a $ $ b $

## 输出格式

$ Q $ 行出力せよ。 $ i $ 行目には $ i $ 番目のクエリに対する答えを出力せよ。

## 说明/提示

### 制約

- $ 1\ \leq\ N,\ Q\ \leq\ 200000 $
- $ 1\ \leq\ C_i\ \leq\ N $
- $ 1\ \leq\ a,\ b\ \leq\ N $
- $ a\ \neq\ b $
- 入力される数値はすべて整数
 
### Sample Explanation 1

\- $ 1 $ 番目のクエリでは、箱 $ 1 $ のボールをすべて箱 $ 2 $ に移します。箱 $ 2 $ には色 $ 1 $ のボールが $ 2 $ つ入っている状態となるため、$ 1 $ を出力します。 - $ 2 $ 番目のクエリでは、箱 $ 6 $ のボールをすべて箱 $ 4 $ に移します。箱 $ 4 $ には色 $ 2 $ のボールが $ 1 $ つ、色 $ 3 $ のボールが $ 1 $ つ入っている状態となるため、$ 2 $ を出力します。 - $ 3 $ 番目のクエリでは、箱 $ 5 $ のボールをすべて箱 $ 1 $ に移します。箱 $ 1 $ には色 $ 2 $ のボールが $ 1 $ つ入っている状態となるため、$ 1 $ を出力します。 - $ 4 $ 番目のクエリでは、箱 $ 3 $ のボールをすべて箱 $ 6 $ に移します。箱 $ 6 $ には色 $ 1 $ のボールが $ 1 $ つ入っている状態となるため、$ 1 $ を出力します。 - $ 5 $ 番目のクエリでは、箱 $ 4 $ のボールをすべて箱 $ 6 $ に移します。箱 $ 6 $ には色 $ 1 $ のボールが $ 1 $ つ、色 $ 2 $ のボールが $ 1 $ つ、色 $ 3 $ のボールが $ 1 $ つ入っている状態となるため、$ 3 $ を出力します。

## 样例 #1

### 输入

```
6 5

1 1 1 2 2 3

1 2

6 4

5 1

3 6

4 6
```

### 输出

```
1

2

1

1

3
```

## 样例 #2

### 输入

```
5 3

2 4 2 4 2

3 1

2 5

3 2
```

### 输出

```
1

2

0
```



---

---
title: "[ABC330E] Mex and Update"
layout: "post"
diff: 普及/提高-
pid: AT_abc330_e
tag: []
---

# [ABC330E] Mex and Update

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc330/tasks/abc330_e

長さ $ N $ の数列 $ A=(A_1,A_2,\dots,A_N) $ が与えられます。  
 以下の $ Q $ 個のクエリに、与えられる順番で対応してください。

$ k $ 番目のクエリは以下の形式で与えられます。

> $ i_k $ $ x_k $

- まず、 $ A_{i_k}\ =\ x_k $ と変更する。この変更は以降のクエリにも引き継がれる。
- その後、 $ A $ の $ \rm{mex} $ を出力する。
  - $ A $ の $ \rm{mex} $ とは、 $ A $ に含まれない最小の非負整数を指す。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ Q $ $ A_1 $ $ A_2 $ $ \dots $ $ A_N $ $ i_1 $ $ x_1 $ $ i_2 $ $ x_2 $ $ \vdots $ $ i_Q $ $ x_Q $

## 输出格式

全体で $ Q $ 行出力せよ。  
 そのうち $ k $ 行目には $ k $ 番目のクエリに対する答えを整数として出力せよ。

## 说明/提示

### 制約

- 入力は全て整数
- $ 1\ \le\ N,Q\ \le\ 2\ \times\ 10^5 $
- $ 0\ \le\ A_i\ \le\ 10^9 $
- $ 1\ \le\ i_k\ \le\ N $
- $ 0\ \le\ x_k\ \le\ 10^9 $
 
### Sample Explanation 1

最初、数列 $ A $ は $ (2,0,2,2,1,1,2,5) $ です。 この入力では、 $ 5 $ つのクエリを処理します。 - $ 1 $ 番目のクエリで $ A_4\ =\ 3 $ と変更し、 $ A=(2,0,2,3,1,1,2,5) $ となりました。 - この時点で、 $ A $ の $ \rm{mex} $ は $ 4 $ です。 - $ 2 $ 番目のクエリで $ A_4\ =\ 4 $ と変更し、 $ A=(2,0,2,4,1,1,2,5) $ となりました。 - この時点で、 $ A $ の $ \rm{mex} $ は $ 3 $ です。 - $ 3 $ 番目のクエリで $ A_6\ =\ 3 $ と変更し、 $ A=(2,0,2,4,1,3,2,5) $ となりました。 - この時点で、 $ A $ の $ \rm{mex} $ は $ 6 $ です。 - $ 4 $ 番目のクエリで $ A_8\ =\ 1000000000 $ と変更し、 $ A=(2,0,2,4,1,3,2,1000000000) $ となりました。 - この時点で、 $ A $ の $ \rm{mex} $ は $ 5 $ です。 - $ 5 $ 番目のクエリで $ A_2\ =\ 1 $ と変更し、 $ A=(2,1,2,4,1,3,2,1000000000) $ となりました。 - この時点で、 $ A $ の $ \rm{mex} $ は $ 0 $ です。

## 样例 #1

### 输入

```
8 5

2 0 2 2 1 1 2 5

4 3

4 4

6 3

8 1000000000

2 1
```

### 输出

```
4

3

6

5

0
```



---

---
title: "[ABC331D] Tile Pattern"
layout: "post"
diff: 普及/提高-
pid: AT_abc331_d
tag: []
---

# [ABC331D] Tile Pattern

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc331/tasks/abc331_d

縦横 $ 10^9 $ マスのグリッドがあります。上から $ i\ +\ 1 $ 行目、左から $ j\ +\ 1 $ 列目 $ (0\ \leq\ i,\ j\ \lt\ 10^9) $ にあるマスを $ (i,\ j) $ と呼びます。(通常と異なる index の割り当て方に注意してください。)  
 各マスは黒マスか白マスのいずれかです。マス $ (i,\ j) $ の色は文字 $ P[i\ \bmod\ N][j\ \bmod\ N] $ によって表されて、`B` ならばマス $ (i,\ j) $ は黒マス、`W` ならば白マスです。ここで $ a\ \bmod\ b $ は $ a $ を $ b $ で割った余りを意味します。

$ Q $ 個のクエリが与えられるので順に処理してください。  
 各クエリでは $ 4 $ つの整数 $ A,\ B,\ C,\ D $ が与えられるので、$ (A,\ B) $ を左上隅、$ (C,\ D) $ を右下隅とする長方形領域に含まれる黒マスの個数を求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。ここで $ \text{query}_i $ は $ i $ 番目に処理するクエリである。

> $ N $ $ Q $ $ P[0][0]P[0][1]\dots\ P[0][N-1] $ $ P[1][0]P[1][1]\dots\ P[1][N-1] $ $ \vdots $ $ P[N-1][0]P[N-1][1]\dots\ P[N-1][N-1] $ $ \text{query}_1 $ $ \text{query}_2 $ $ \vdots $ $ \text{query}_Q $

各クエリは以下の形式で与えられる。

> $ A $ $ B $ $ C $ $ D $

## 输出格式

問題文の指示に従ってクエリへの答えを改行区切りで出力せよ。

## 说明/提示

### 制約

- $ 1\ \leq\ N\ \leq\ 1000 $
- $ P[i][j] $ は `W` または `B`
- $ 1\ \leq\ Q\ \leq\ 2\ \times\ 10^5 $
- $ 0\ \leq\ A\ \leq\ C\ \lt\ 10^9 $
- $ 0\ \leq\ B\ \leq\ D\ \lt\ 10^9 $
- $ N,\ Q,\ A,\ B,\ C,\ D $ は全て整数
 
### Sample Explanation 1

グリッドの左上部分を図示すると次の図のようになります。 !\[image\](https://img.atcoder.jp/abc331/2c3ff3c4018817a0839f1fbe0e7c431d.jpg) $ 1 $ 番目のクエリについて、$ (1,\ 2) $ を左上隅、$ (3,\ 4) $ を右下隅とする長方形領域は図の赤い枠線に囲まれた部分で、領域に含まれる黒マスの個数は $ 4 $ 個です。 $ 2 $ 番目のクエリについて、$ (0,\ 3) $ を左上隅、$ (4,\ 5) $ を右下隅とする長方形領域は図の青い枠線に囲まれた部分で、領域に含まれる黒マスの個数は $ 7 $ 個です。

## 样例 #1

### 输入

```
3 2

WWB

BBW

WBW

1 2 3 4

0 3 4 5
```

### 输出

```
4

7
```

## 样例 #2

### 输入

```
10 5

BBBWWWBBBW

WWWWWBBBWB

BBBWBBWBBB

BBBWWBWWWW

WWWWBWBWBW

WBBWBWBBBB

WWBBBWWBWB

WBWBWWBBBB

WBWBWBBWWW

WWWBWWBWWB

5 21 21 93

35 35 70 43

55 72 61 84

36 33 46 95

0 0 999999999 999999999
```

### 输出

```
621

167

44

344

500000000000000000
```



---

---
title: "[ABC331E] Set Meal"
layout: "post"
diff: 普及/提高-
pid: AT_abc331_e
tag: []
---

# [ABC331E] Set Meal

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc331/tasks/abc331_e

AtCoder 食堂では主菜と副菜からなる定食が販売されています。  
 主菜は $ N $ 種類あり、順に主菜 $ 1 $, 主菜 $ 2 $, $ \dots $, 主菜 $ N $ と呼びます。主菜 $ i $ の価格は $ a_i $ 円です。  
 副菜は $ M $ 種類あり、順に副菜 $ 1 $, 副菜 $ 2 $, $ \dots $, 副菜 $ M $ と呼びます。副菜 $ i $ の価格は $ b_i $ 円です。

定食は主菜と副菜を $ 1 $ 種類ずつ選んで構成されます。定食の価格は選んだ主菜の価格と副菜の価格の和です。   
 ただし、$ L $ 個の相異なる組 $ (c_1,\ d_1),\ \dots,\ (c_L,\ d_L) $ について、主菜 $ c_i $ と副菜 $ d_i $ からなる定食は食べ合わせが悪いため提供されていません。  
 つまり、提供されている定食は $ NM\ -\ L $ 種類あることになります。(提供されている定食が少なくとも $ 1 $ 種類存在することが制約によって保証されています。)

提供されている定食のうち、最も価格の高い定食の価格を求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ M $ $ L $ $ a_1 $ $ a_2 $ $ \dots $ $ a_N $ $ b_1 $ $ b_2 $ $ \dots $ $ b_M $ $ c_1 $ $ d_1 $ $ c_2 $ $ d_2 $ $ \vdots $ $ c_L $ $ d_L $

## 输出格式

提供されている定食のうち、最も価格の高い定食が何円であるかを出力せよ。

## 说明/提示

### 制約

- $ 1\ \leq\ N,\ M\ \leq\ 10^5 $
- $ 0\ \leq\ L\ \leq\ \min(10^5,\ N\ M\ -\ 1) $
- $ 1\ \leq\ a_i,\ b_i\ \leq\ 10^9 $
- $ 1\ \leq\ c_i\ \leq\ N $
- $ 1\ \leq\ d_j\ \leq\ M $
- $ i\ \neq\ j $ ならば $ (c_i,\ d_i)\ \neq\ (c_j,\ d_j) $
- 入力される値は全て整数
 
### Sample Explanation 1

提供されている定食、及びその価格は次の $ 3 $ 種類です。 - 主菜 $ 1 $ と副菜 $ 1 $ からなる定食。価格は $ 2\ +\ 10\ =\ 12 $ 円である。 - 主菜 $ 1 $ と副菜 $ 3 $ からなる定食。価格は $ 2\ +\ 20\ =\ 22 $ 円である。 - 主菜 $ 2 $ と副菜 $ 2 $ からなる定食。価格は $ 1\ +\ 30\ =\ 31 $ 円である。 この中で最も高い定食は $ 3 $ 番目の定食です。よって $ 31 $ を出力してください。

## 样例 #1

### 输入

```
2 3 3

2 1

10 30 20

1 2

2 1

2 3
```

### 输出

```
31
```

## 样例 #2

### 输入

```
2 1 0

1000000000 1

1000000000
```

### 输出

```
2000000000
```

## 样例 #3

### 输入

```
10 10 10

47718 21994 74148 76721 98917 73766 29598 59035 69293 29127

7017 46004 16086 62644 74928 57404 32168 45794 19493 71590

1 3

2 6

4 5

5 4

5 5

5 6

5 7

5 8

5 10

7 3
```

### 输出

```
149076
```



---

---
title: "[ABC332D] Swapping Puzzle"
layout: "post"
diff: 普及/提高-
pid: AT_abc332_d
tag: []
---

# [ABC332D] Swapping Puzzle

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc332/tasks/abc332_d

$ H $ 行 $ W $ 列の $ 2 $ つのグリッド A, B が与えられます。

$ 1\ \leq\ i\ \leq\ H $ と $ 1\ \leq\ j\ \leq\ W $ を満たす各整数の組 $ (i,\ j) $ について、 $ i $ 行目 $ j $ 列目にあるマスをマス $ (i,\ j) $ と呼ぶとき、 グリッド A の マス $ (i,\ j) $ には整数 $ A_{i,\ j} $ が、 グリッド B の マス $ (i,\ j) $ には整数 $ B_{i,\ j} $ がそれぞれ書かれています。

あなたは「下記の $ 2 $ つのうちのどちらか $ 1 $ つを行う」という操作を好きな回数（ $ 0 $ 回でもよい）だけ繰り返します。

- $ 1\ \leq\ i\ \leq\ H-1 $ を満たす整数 $ i $ を選び、グリッド A の $ i $ 行目と $ (i+1) $ 行目を入れ替える。
- $ 1\ \leq\ i\ \leq\ W-1 $ を満たす整数 $ i $ を選び、グリッド A の $ i $ 列目と $ (i+1) $ 列目を入れ替える。

上記の操作の繰り返しによって、グリッド A をグリッド B に一致させることが可能かどうかを判定してください。 さらに、一致させることが可能な場合は、そのために行う操作回数の最小値を出力してください。

ここで、グリッド A とグリッド B が一致しているとは、 $ 1\ \leq\ i\ \leq\ H $ と $ 1\ \leq\ j\ \leq\ W $ を満たす全ての整数の組 $ (i,\ j) $ について、 グリッド A の マス $ (i,\ j) $ とグリッド B の マス $ (i,\ j) $ に書かれた整数が等しいこととします。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ H $ $ W $ $ A_{1,\ 1} $ $ A_{1,\ 2} $ $ \cdots $ $ A_{1,\ W} $ $ A_{2,\ 1} $ $ A_{2,\ 2} $ $ \cdots $ $ A_{2,\ W} $ $ \vdots $ $ A_{H,\ 1} $ $ A_{H,\ 2} $ $ \cdots $ $ A_{H,\ W} $ $ B_{1,\ 1} $ $ B_{1,\ 2} $ $ \cdots $ $ B_{1,\ W} $ $ B_{2,\ 1} $ $ B_{2,\ 2} $ $ \cdots $ $ B_{2,\ W} $ $ \vdots $ $ B_{H,\ 1} $ $ B_{H,\ 2} $ $ \cdots $ $ B_{H,\ W} $

## 输出格式

グリッド A をグリッド B に一致させることが不可能な場合は `-1` を、 可能な場合はグリッド A をグリッド B に一致させるために行う操作回数の最小値を出力せよ。

## 说明/提示

### 制約

- 入力される値は全て整数
- $ 2\ \leq\ H,\ W\ \leq\ 5 $
- $ 1\ \leq\ A_{i,\ j},\ B_{i,\ j}\ \leq\ 10^9 $

### Sample Explanation 1

初期状態のグリッド A の $ 4 $ 列目と $ 5 $ 列目を入れ替えると、グリッド A は下記の通りになります。 ``` 1 2 3 5 4 6 7 8 10 9 11 12 13 15 14 16 17 18 20 19 ``` 続けて、グリッド A の $ 2 $ 行目と $ 3 $ 行目を入れ替えると、グリッド A は下記の通りになります。 ``` 1 2 3 5 4 11 12 13 15 14 6 7 8 10 9 16 17 18 20 19 ``` 最後に、グリッド A の $ 2 $ 列目と $ 3 $ 列目を入れ替えると、グリッド A は下記の通りになり、グリッド B に一致します。 ``` 1 3 2 5 4 11 13 12 15 14 6 8 7 10 9 16 18 17 20 19 ``` 上に述べた $ 3 $ 回の操作でグリッド A をグリッド B に一致させることができ、 これより少ない回数の操作でグリッド A をグリッド B に一致させることはできないため、 $ 3 $ を出力します。

### Sample Explanation 2

問題文中の操作をどのように行ってもグリッド A をグリッド B に一致させることは不可能であるため `-1` を出力します。

### Sample Explanation 3

グリッド A ははじめからグリッド B に一致しています。

## 样例 #1

### 输入

```
4 5
1 2 3 4 5
6 7 8 9 10
11 12 13 14 15
16 17 18 19 20
1 3 2 5 4
11 13 12 15 14
6 8 7 10 9
16 18 17 20 19
```

### 输出

```
3
```

## 样例 #2

### 输入

```
2 2
1 1
1 1
1 1
1 1000000000
```

### 输出

```
-1
```

## 样例 #3

### 输入

```
3 3
8 1 6
3 5 7
4 9 2
8 1 6
3 5 7
4 9 2
```

### 输出

```
0
```

## 样例 #4

### 输入

```
5 5
710511029 136397527 763027379 644706927 447672230
979861204 57882493 442931589 951053644 152300688
43971370 126515475 962139996 541282303 834022578
312523039 506696497 664922712 414720753 304621362
325269832 191410838 286751784 732741849 806602693
806602693 732741849 286751784 191410838 325269832
304621362 414720753 664922712 506696497 312523039
834022578 541282303 962139996 126515475 43971370
152300688 951053644 442931589 57882493 979861204
447672230 644706927 763027379 136397527 710511029
```

### 输出

```
20
```



---

---
title: "[ABC337E] Bad Juice"
layout: "post"
diff: 普及/提高-
pid: AT_abc337_e
tag: []
---

# [ABC337E] Bad Juice

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc337/tasks/abc337_e

この問題は **インタラクティブな問題**（あなたが作成したプログラムとジャッジプログラムが標準入出力を介して対話を行う形式の問題）です。

$ 1 $ から $ N $ の番号がついた $ N $ 本のジュースがあります。 このうちちょうど $ 1 $ 本が腐っていることが判明しました。 そのジュースを微量でも飲むと、翌日お腹を壊してしまいます。

高橋君は翌日までに腐ったジュースを特定しなければなりません。 高橋君はそのために**必要な最小の数**の友人を呼び、それぞれに $ N $ 本のジュースのうちの一部を振る舞うことにしました。 各友人には何本でもジュースを与えることができ、各ジュースは何人の友人にでも与えることができます。

呼ぶ友人の数とジュースの与え方を出力して、翌日に各友人がお腹を壊したかどうかの情報を受け取り、腐ったジュースの番号を出力してください。

### Input &amp; Output Format

この問題はインタラクティブな問題（あなたが作成したプログラムとジャッジプログラムが標準入出力を介して対話を行う形式の問題）です。

対話を行う前にジャッジは、腐ったジュースの番号 $ X $ として $ 1 $ 以上 $ N $ 以下の整数を秘密裏に選択します。 $ X $ の値はあなたには与えられません。また、**対話の途中で $ X $ の値が制約および以前の出力に矛盾しない範囲で変わる場合があります。**

まず、ジャッジから $ N $ が入力から与えられます。

> $ N $

あなたは呼ぶ友人の数 $ M $ を出力し改行してください。

> $ M $

さらに、あなたは次に述べる $ M $ 回の出力からなる手続きを行ってください。 $ i\ =\ 1,\ 2,\ \ldots,\ M $ について $ i $ 回目の出力では、 $ i $ 番目の友人に飲ませるジュースの本数 $ K_i $ および、それら $ K_i $ 本のジュースの番号を**昇順に**並べた列 $ A_{i,\ 1},\ A_{i,\ 2},\ \ldots,\ A_{i,\ K_i} $ を下記の形式で空白区切りで出力し、改行してください。

> $ K_i $ $ A_{i,\ 1} $ $ A_{i,\ 2} $ $ \ldots $ $ A_{i,\ K_i} $

その後ジャッジから、各友人が翌日にお腹を壊したかどうかの情報が、`0` と `1` のみからなる長さ $ M $ の文字列 $ S $ として与えられます。

> $ S $

$ i\ =\ 1,\ 2,\ \ldots,\ M $ について、$ S $ の $ i $ 文字目が `1` のとき、かつそのときに限り、$ i $ 番目の友人がお腹を壊したことを表します。

それに対し、あなたは腐ったジュースの番号 $ X' $ を出力し、改行してください。

> $ X' $

その後、直ちにプログラムを終了してください。

あなたが出力した $ M $ が $ N $ 本のジュースから腐ったジュースを特定するために**必要な最小の**友人の数であり、かつ、あなたが出力した $ X' $ が腐ったジュースの番号 $ X $ と一致していれば、正解となります。

## 说明/提示

### 制約

- $ N $ は整数
- $ 2\ \leq\ N\ \leq\ 100 $
 
### 注意点

- **出力を行うたびに、末尾に改行を入れて標準出力を flush してください。そうしなかった場合、ジャッジ結果が TLE となる可能性があります。**
- **対話の途中で不正な出力を行った、あるいはプログラムが途中で終了した場合のジャッジ結果は不定です。** 特に、プログラムの実行中に実行時エラーが起こった場合に、ジャッジ結果が RE ではなく WA や TLE になる可能性があることに注意してください。
- $ X' $ を出力したらただちにプログラムを終了してください。そうしない場合、ジャッジ結果は不定です。
- **この問題のジャッジはアダプティブです。つまり、制約および以前の出力に矛盾しない範囲で $ X $ の値が変わる場合があります。**
 
### 入出力例

以下は、$ N\ =\ 3 $ の場合の入出力例です。

    入力 出力 説明     `3`  ジュースの本数 $ N $ が与えられます。    `2` 呼ぶ友人の数 $ M $ を出力します。    `2 1 2` $ 1 $ 人目の友人にジュース $ 1 $ とジュース $ 2 $ を与えます。     `1 2` $ 2 $ 人目の友人に、ジュース $ 2 $ を与えます。     `10`  翌日に各友人がお腹を壊したかどうかを表す文字列 $ S $ が与えられます。    `1` 腐ったジュースの番号を出力します。



---

---
title: "[ABC346E] Paint"
layout: "post"
diff: 普及/提高-
pid: AT_abc346_e
tag: []
---

# [ABC346E] Paint

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc346/tasks/abc346_e

$ H $ 行 $ W $ 列のグリッドがあり、はじめすべてのマスは色 $ 0 $ で塗られています。

これから $ i\ =\ 1,\ 2,\ \ldots,\ M $ の順で以下の操作を行います。

- $ T_i\ =\ 1 $ のとき、$ A_i $ **行目**のマスをすべて色 $ X_i $ に塗り替える
- $ T_i\ =\ 2 $ のとき、$ A_i $ **列目**のマスをすべて色 $ X_i $ に塗り替える

すべての操作を終えたとき、最終的に色 $ i $ で塗られたマスが存在するような各色 $ i $ についてその色で塗られたマスの個数を求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ H $ $ W $ $ M $ $ T_1 $ $ A_1 $ $ X_1 $ $ T_2 $ $ A_2 $ $ X_2 $ $ \vdots $ $ T_M $ $ A_M $ $ X_M $

## 输出格式

色 $ i $ で塗られたマスが存在するような整数 $ i $ の個数を $ K $ として、$ K\ +\ 1 $ 行出力せよ。

$ 1 $ 行目には $ K $ の値を出力せよ。

$ 2 $ 行目以降には色 $ i $ で塗られたマスが存在するような各色 $ i $ について、色の番号およびその色で塗られたマスの個数を出力せよ。

具体的には、$ i\ +\ 1 $ $ (1\ \leq\ i\ \leq\ K) $ 行目には色の番号 $ c_i $ と色 $ c_i $ で塗られたマスの個数 $ x_i $ をこの順に空白区切りで出力せよ。

ただし、色の番号は**昇順で**出力せよ。すなわち、$ c_1\ <\ c_2\ <\ \ldots\ <\ c_K $ を満たすように出力せよ。また、$ x_i\ >\ 0 $ が必要であることに注意せよ。

## 说明/提示

### 制約

- $ 1\ \leq\ H,\ W,\ M\ \leq\ 2\ \times\ 10^5 $
- $ T_i\ \in\ \lbrace\ 1,\ 2\ \rbrace $
- $ T_i\ =\ 1 $ なる $ i $ に対して $ 1\ \leq\ A_i\ \leq\ H $
- $ T_i\ =\ 2 $ なる $ i $ に対して $ 1\ \leq\ A_i\ \leq\ W $
- $ 0\ \leq\ X_i\ \leq\ 2\ \times\ 10^5 $
- 入力される値はすべて整数

### Sample Explanation 1

操作によってグリッドの各マスの色は以下のように変化します。 ``` 0000 0000 0000 0000 0000 0000 → 5555 → 5550 → 5550 → 5550 0000 0000 0000 3333 2222 ``` 最終的に色 $ 0 $ で塗られたマスは $ 5 $ つ、色 $ 2 $ で塗られたマスは $ 4 $ つ、色 $ 5 $ で塗られたマスは $ 3 $ つです。

## 样例 #1

### 输入

```
3 4 4
1 2 5
2 4 0
1 3 3
1 3 2
```

### 输出

```
3
0 5
2 4
5 3
```

## 样例 #2

### 输入

```
1 1 5
1 1 1
1 1 10
2 1 100
1 1 1000
2 1 10000
```

### 输出

```
1
10000 1
```

## 样例 #3

### 输入

```
5 5 10
1 1 1
1 2 2
1 3 3
1 4 4
1 5 5
2 1 6
2 2 7
2 3 8
2 4 9
2 5 10
```

### 输出

```
5
6 5
7 5
8 5
9 5
10 5
```



---

---
title: "[ABC348F] Oddly Similar"
layout: "post"
diff: 普及/提高-
pid: AT_abc348_f
tag: []
---

# [ABC348F] Oddly Similar

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc348/tasks/abc348_f

$ N $ 個の長さ $ M $ の数列 $ A_1,\ A_2,\ \ldots,\ A_N $ があります。$ i $ 番目の数列は $ M $ 個の整数 $ A_{i,1},\ A_{i,2},\ \ldots,\ A_{i,M} $ で表されます。

それぞれの長さが $ M $ の数列 $ X,Y $ について、$ X_i\ =\ Y_i $ となるような $ i(1\ \leq\ i\ \leq\ M) $ の個数が奇数であるときに、$ X $ と $ Y $ は似ていると言います。

$ 1\ \leq\ i\ <\ j\ \leq\ N $ を満たす整数の組 $ (i,j) $ のうち、$ A_i $ と $ A_j $ が似ているものの個数を求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ M $ $ A_{1,1} $ $ A_{1,2} $ $ \ldots $ $ A_{1,M} $ $ A_{2,1} $ $ A_{2,2} $ $ \ldots $ $ A_{2,M} $ $ \vdots $ $ A_{N,1} $ $ A_{N,2} $ $ \ldots $ $ A_{N,M} $

## 输出格式

答えを整数として出力せよ。

## 说明/提示

### 制約

- $ 1\ \leq\ N\ \leq\ 2000 $
- $ 1\ \leq\ M\ \leq\ 2000 $
- $ 1\ \leq\ A_{i,j}\ \leq\ 999 $
- 入力は全て整数である。
 
### Sample Explanation 1

$ (i,j)\ =\ (1,2) $ は条件を満たします。なぜならば、$ A_{1,k}\ =\ A_{2,k} $ となるような $ k $ は $ k=1 $ の $ 1 $ 個だけだからです。 $ (i,j)\ =\ (1,3)\ ,(2,3) $ は条件を満たさないため、条件を満たす $ (i,j) $ の組は $ (1,2) $ だけです。

## 样例 #1

### 输入

```
3 3

1 2 3

1 3 4

2 3 4
```

### 输出

```
1
```

## 样例 #2

### 输入

```
6 5

8 27 27 10 24

27 8 2 4 5

15 27 26 17 24

27 27 27 27 27

27 7 22 11 27

19 27 27 27 27
```

### 输出

```
5
```



---

---
title: "[ABC357D] 88888888"
layout: "post"
diff: 普及/提高-
pid: AT_abc357_d
tag: ['逆元']
---

# [ABC357D] 88888888

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc357/tasks/abc357_d

正整数 $ N $ に対して、$ N $ を $ N $ 個つなげた整数を $ V_N $ とします。  
 より厳密には、$ N $ を文字列とみなしたものを $ N $ 個連結し、 それを再度整数とみなしたものを $ V_N $ とします。  
 例えば、$ V_3=333 $, $ V_{10}=10101010101010101010 $ です。

$ V_N $ を $ 998244353 $ で割った余りを求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $

## 输出格式

$ V_N $ を $ 998244353 $ で割った余りを出力せよ。

## 说明/提示

### 制約

- $ 1\leq\ N\leq\ 10^{18} $
- $ N $ は整数
 
### Sample Explanation 1

$ V_5=55555 $ を $ 998244353 $ で割った余りは $ 55555 $ です。

### Sample Explanation 2

$ V_9=999999999 $ を $ 998244353 $ で割った余りは $ 1755646 $ です。

### Sample Explanation 3

入力が $ 32 $ bit 整数型に収まらない可能性があることに注意してください。

## 样例 #1

### 输入

```
5
```

### 输出

```
55555
```

## 样例 #2

### 输入

```
9
```

### 输出

```
1755646
```

## 样例 #3

### 输入

```
10000000000
```

### 输出

```
468086693
```



---

---
title: "[ABC387D] Snaky Walk"
layout: "post"
diff: 普及/提高-
pid: AT_abc387_d
tag: []
---

# [ABC387D] Snaky Walk

## 题目描述

给你一张地图，图中只包含起点```S```，终点```G```，障碍```#```，道路```.```。从起点出发，第一步方向任意，但之后的每一步都不能与之前相同。以这样的移动方式，求出到达终点的最少步数。

## 输入格式

输入按照如下格式由标准输入给出。
>$H$,$W$     
$S_1$     
$S_2$  
.      
.     
.     
$S_H$

## 输出格式

求出到达终点的最少步数。如不能到达，输出-1。

## 说明/提示

#### 约定
- $1\le H,W\le 1000$
- $H,W$均为整数
- $S_i$均为```S```，```G```，```#```，```.```组成的长为$W$的字符串。
- 每行，每列字符均相邻
#### 样例解释 1
![](https://img.atcoder.jp/abc387/6ef2f123adae6bc6bb157af8f30afe89.png)
如左图，路线为$(1,2)\rightarrow (2,2)\rightarrow (2,3)\rightarrow (3,3)\rightarrow (3,4)\rightarrow (2,4)\rightarrow (2,5)\rightarrow (1,5)$，移动7次即可到达终点。6次以下均不能到达终点，所以答案是7。       
请注意，如右图，不能走连续横向的路径（或走连续纵向的路径）。
#### 样例解释 2
模拟一下，明显到不了。

## 样例 #1

### 输入

```
3 5

.S#.G

.....

.#...
```

### 输出

```
7
```

## 样例 #2

### 输入

```
3 5

..#.G

.....

S#...
```

### 输出

```
-1
```

## 样例 #3

### 输入

```
8 63

...............................................................

..S...#............................#####..#####..#####..####G..

..#...#................................#..#...#......#..#......

..#####..####...####..####..#..#...#####..#...#..#####..#####..

..#...#..#..#...#..#..#..#..#..#...#......#...#..#..........#..

..#...#..#####..####..####..####...#####..#####..#####..#####..

................#.....#........#...............................

................#.....#........#...............................
```

### 输出

```
148
```



---

---
title: "[ABC389D] Squares in Circle"
layout: "post"
diff: 普及/提高-
pid: AT_abc389_d
tag: []
---

# [ABC389D] Squares in Circle

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc389/tasks/abc389_d

二次元座標平面上に $ 1\times\ 1 $ の正方形が無限に敷き詰められています。

ある正方形の中心を中心として、半径 $ R $ の円を描いたとき、円に完全に内包される正方形は何個あるでしょうか？

より厳密には、整数組 $ (i,j) $ であって、$ 4 $ 点 $ (i+0.5,j+0.5),(i+0.5,j-0.5),(i-0.5,j+0.5),(i-0.5,j-0.5) $ 全てが原点との距離が $ R $ 以下という条件を満たすものの個数を求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ R $

## 输出格式

答えを出力せよ。

## 说明/提示

### 制約

- $ 1\leq\ R\leq\ 10^{6} $
- 入力される数値は全て整数
 
### Sample Explanation 1

正方形の中心が円の中心と一致するような正方形、及びその正方形に隣接する正方形 $ 4 $ 個の、合計 $ 5 $ 個の正方形が円に完全に内包されています。

## 样例 #1

### 输入

```
2
```

### 输出

```
5
```

## 样例 #2

### 输入

```
4
```

### 输出

```
37
```

## 样例 #3

### 输入

```
26
```

### 输出

```
2025
```



---

---
title: "[ABC390E] Vitamin Balance"
layout: "post"
diff: 普及/提高-
pid: AT_abc390_e
tag: []
---

# [ABC390E] Vitamin Balance

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc390/tasks/abc390_e

$ N $ 個の食べ物があり、それぞれの食べ物にはビタミン $ 1,2,3 $ のうちちょうど $ 1 $ つのみが含まれています。  
具体的には、$ i $ 個目の食べ物を食べると、ビタミン $ V_i $ が $ A_i $ だけ摂取でき、またカロリーが $ C_i $ だけ摂取されます。

高橋君は、摂取するカロリーが合計で $ X $ 以下となるように、$ N $ 個の食べ物のうちいくつか（$ 0 $ 個でも良い）を選んで食べることができます。  
このとき、「ビタミン $ 1,2,3 $ のうちもっとも摂取量が少ないものの摂取量」としてあり得る最大の値を求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ X $ $ V_1 $ $ A_1 $ $ C_1 $ $ V_2 $ $ A_2 $ $ C_2 $ $ \vdots $ $ V_N $ $ A_N $ $ C_N $

## 输出格式

高橋君が摂取カロリーの合計が $ X $ 以下となるように食べ物を食べたとき、「ビタミン $ 1,2,3 $ のうちもっとも摂取量が少ないものの摂取量」としてあり得る最大の値を出力せよ。

## 说明/提示

### 制約

- $ 1\leq\ N\ \leq\ 5000 $
- $ 1\leq\ X\ \leq\ 5000 $
- $ 1\leq\ V_i\leq\ 3 $
- $ 1\leq\ A_i\leq\ 2\times\ 10^5 $
- $ 1\leq\ C_i\leq\ X $
- 入力はすべて整数

### Sample Explanation 1

それぞれの食べ物を食べると高橋君は次のものを摂取します。 - $ 1 $ 個目の食べ物を食べると、ビタミン $ 1 $ を $ 8 $ とカロリーを $ 5 $ だけ摂取する。 - $ 2 $ 個目の食べ物を食べると、ビタミン $ 2 $ を $ 3 $ とカロリーを $ 5 $ だけ摂取する。 - $ 3 $ 個目の食べ物を食べると、ビタミン $ 2 $ を $ 7 $ とカロリーを $ 10 $ だけ摂取する。 - $ 4 $ 個目の食べ物を食べると、ビタミン $ 3 $ を $ 2 $ とカロリーを $ 5 $ だけ摂取する。 - $ 5 $ 個目の食べ物を食べると、ビタミン $ 3 $ を $ 3 $ とカロリーを $ 10 $ だけ摂取する。 高橋君が $ 1 $, $ 2 $, $ 4 $, $ 5 $ 個目の食べ物を食べると、 高橋君はビタミン $ 1 $ を $ 8 $、ビタミン $ 2 $ を $ 3 $、ビタミン $ 3 $ を $ 5 $、そしてカロリーを $ 25 $ だけ摂取します。 このとき、「ビタミン $ 1,2,3 $ のうちもっとも摂取量が少ないもの」はビタミン $ 2 $ であり、その摂取量は $ 3 $ です。 どのように食べ物を選んで食べても、摂取カロリーの合計が $ 25 $ 以下となるようにビタミン $ 1,2,3 $ すべてを $ 4 $ 以上摂取することはできないため、$ 3 $ を出力します。

## 样例 #1

### 输入

```
5 25
1 8 5
2 3 5
2 7 10
3 2 5
3 3 10
```

### 输出

```
3
```

## 样例 #2

### 输入

```
2 5000
1 200000 1
2 200000 1
```

### 输出

```
0
```



---

---
title: "[ABC391D] Gravity"
layout: "post"
diff: 普及/提高-
pid: AT_abc391_d
tag: []
---

# [ABC391D] Gravity

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc391/tasks/abc391_d

$ 10^9 $ 行 $ W $ 列のグリッドがあります。左から $ x $ 列目、**下から** $ y $ 行目のマスを $ (x,y) $ と表します。

$ N $ 個のブロックがあります。各ブロックは $ 1\ \times\ 1 $ の正方形で、ブロック $ i $ $ (1\ \leq\ i\ \leq\ N) $ は時刻 $ 0 $ にマス $ (X_i,Y_i) $ にあります。

時刻 $ t=1,2,\dots,10^{100} $ に、以下のルールに従ってブロックを動かします。

- グリッドの下から $ 1 $ 行目がすべてブロックで埋まっているならば、下から $ 1 $ 行目にあるブロックをすべて消滅させる。
- 残っているブロックについて、下にあるブロックから順番に、以下の操作を行う。
  - ブロックが一番下の行にある、またはそのブロックの $ 1 $ つ下のマスにもブロックがあるならば、何もしない
  - そうでなければ、ブロックを $ 1 $ つ下のマスに動かす。

$ Q $ 個の質問が与えられます。$ j $ 番目 $ (1\ \leq\ j\ \leq\ Q) $ の質問では、時刻 $ T_j+0.5 $ にブロック $ A_j $ が存在するかどうか答えてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ W $ $ X_1 $ $ Y_1 $ $ X_2 $ $ Y_2 $ $ \vdots $ $ X_N $ $ Y_N $ $ Q $ $ T_1 $ $ A_1 $ $ T_2 $ $ A_2 $ $ \vdots $ $ T_Q $ $ A_Q $

## 输出格式

$ Q $ 行出力せよ。$ i $ 行目には、時刻 $ T_i+0.5 $ にブロック $ A_i $ が存在するならば `Yes` を、存在しないならば `No` を出力せよ。

## 说明/提示

### 制約

- $ 1\ \leq\ N\ \leq\ 2\ \times\ 10^5 $
- $ 1\ \leq\ W\ \leq\ N $
- $ 1\ \leq\ X_i\ \leq\ W $
- $ 1\ \leq\ Y_i\ \leq\ 10^9 $
- $ i\ \neq\ j $ なら $ (X_i,Y_i)\ \neq\ (X_j,Y_j) $
- $ 1\ \leq\ Q\ \leq\ 2\ \times\ 10^5 $
- $ 1\ \leq\ T_j\ \leq\ 10^9 $
- $ 1\ \leq\ A_j\ \leq\ N $
- 入力はすべて整数

### Sample Explanation 1

ブロックの位置は以下のように変化します。 ![](https://img.atcoder.jp/abc391/4a6590753edcbad7ea1e8ce7f172902a.png) - 質問 $ 1 $: 時刻 $ 1.5 $ にブロック $ 1 $ は存在するので、答えは `Yes` です。 - 質問 $ 2 $: 時刻 $ 1.5 $ にブロック $ 2 $ は存在するので、答えは `Yes` です。 - 質問 $ 3 $: ブロック $ 3 $ は時刻 $ 2 $ に消滅します。よって、時刻 $ 2.5 $ にブロック $ 3 $ は存在しないので、答えは `No` です。

## 样例 #1

### 输入

```
5 3
1 1
1 2
2 2
3 2
2 3
6
1 1
1 2
2 3
2 5
3 4
3 5
```

### 输出

```
Yes
Yes
No
Yes
No
Yes
```

## 样例 #2

### 输入

```
3 2
1 1
2 1
1 2
4
1 1
1 2
1 3
2 3
```

### 输出

```
No
No
Yes
Yes
```



---

---
title: "[ABC409D] String Rotation"
layout: "post"
diff: 普及/提高-
pid: AT_abc409_d
tag: []
---

# [ABC409D] String Rotation

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc409/tasks/abc409_d

给定一个长度为 $N$ 的由小写字母组成的字符串 $S=S_1S_2\dots S_N$。你需要对 $S$ 执行恰好一次以下操作：

- 选择 $S$ 的一个长度至少为 1 的连续子串，将其向左循环移位 1 次。具体来说，选择整数 $1 \leq \ell \leq r \leq N$，将 $S$ 的第 $\ell$ 个字符插入到第 $r$ 个字符的右侧，然后删除 $S$ 的第 $\ell$ 个字符。

请找出所有可能的操作后 $S$ 中字典序最小的字符串。

共有 $T$ 个测试用例，请对每个测试用例给出答案。

## 输入格式

输入通过标准输入给出，格式如下：

> $T$  
> $\mathrm{case}_1$  
> $\mathrm{case}_2$  
> $\vdots$  
> $\mathrm{case}_T$

每个测试用例 $\mathrm{case}_i$（$1 \leq i \leq T$）的格式如下：

> $N$  
> $S$


## 输出格式

输出 $T$ 行。第 $i$ 行（$1 \leq i \leq T$）输出 $\mathrm{case}_i$ 对应的答案。


## 说明/提示

### 约束条件

- $1 \leq T \leq 10^5$
- $1 \leq N \leq 10^5$
- $S$ 是由小写字母组成的长度为 $N$ 的字符串
- $T$ 和 $N$ 为整数
- 单个输入文件中所有测试用例的 $N$ 之和不超过 $10^5$

### 样例解释 1

- 对于第 1 个测试用例，选择第 2 到第 7 个字符进行循环移位，得到 `acodert` 是字典序最小的结果。
- 对于第 2 个测试用例，无论如何操作都只能得到 `x`。
- 对于第 3 个测试用例，选择第 1 到第 2 个字符进行循环移位，得到 `nsuke` 是字典序最小的结果。

翻译由 DeepSeek V3 完成

## 样例 #1

### 输入

```
3
7
atcoder
1
x
5
snuke
```

### 输出

```
acodert
x
nsuke
```



---

---
title: "[ABC409E] Pair Annihilation"
layout: "post"
diff: 普及/提高-
pid: AT_abc409_e
tag: []
---

# [ABC409E] Pair Annihilation

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc409/tasks/abc409_e

给定一棵包含 $N$ 个顶点的树。顶点编号为 $1,2,\dots,N$，边编号为 $1,2,\dots,N-1$。边 $j$ 双向连接顶点 $u_j$ 和 $v_j$，其权重为 $w_j$。此外，顶点 $i$ 上有一个整数 $x_i$：若 $x_i > 0$，表示该顶点有 $x_i$ 个正电子；若 $x_i < 0$，表示有 $-x_i$ 个电子；若 $x_i = 0$，则该顶点没有粒子。题目保证 $\sum_{i=1}^N x_i = 0$。

每次可以沿边 $j$ 移动 1 个正电子或电子，消耗能量 $w_j$。当正电子和电子位于同一顶点时，它们会相互抵消（数量相等时完全消失）。

求使所有正电子和电子完全消失所需的最小总能量。

## 输入格式

输入通过标准输入给出，格式如下：

> $N$  
> $x_1$ $x_2$ $\dots$ $x_N$  
> $u_1$ $v_1$ $w_1$  
> $u_2$ $v_2$ $w_2$  
> $\vdots$  
> $u_{N-1}$ $v_{N-1}$ $w_{N-1}$

## 输出格式

输出答案。

## 说明/提示

### 约束条件

- $2 \leq N \leq 10^5$
- $|x_i| \leq 10^4$
- $\sum_{i=1}^N x_i = 0$
- $1 \leq u_j < v_j \leq N$
- $0 \leq w_j \leq 10^4$
- 给定的图是一棵树
- 输入均为整数

### 样例解释 1

初始状态 $x=(-3,+2,+2,-1)$。通过以下操作可以用最小能量 $9$ 使所有粒子消失：
1. 将顶点 $1$ 的 1 个电子移动到顶点 $2$，消耗能量 $2$，$x=(-2,+1,+2,-1)$；
2. 将顶点 $2$ 的 1 个正电子移动到顶点 $1$，消耗能量 $2$，$x=(-1,0,+2,-1)$；
3. 将顶点 $4$ 的 1 个电子移动到顶点 $1$，消耗能量 $3$，$x=(-2,0,+2,0)$；
4. 将顶点 $1$ 的 1 个电子移动到顶点 $3$，消耗能量 $1$，$x=(-1,0,+1,0)$；
5. 将顶点 $1$ 的 1 个电子移动到顶点 $3$，消耗能量 $1$，$x=(0,0,0,0)$。

无法用 $8$ 或更少能量完成目标，因此答案为 $9$。

### 样例解释 2

初始状态已满足条件时，输出 $0$。

翻译由 DeepSeek V3 完成

## 样例 #1

### 输入

```
4
-3 2 2 -1
1 2 2
1 3 1
1 4 3
```

### 输出

```
9
```

## 样例 #2

### 输入

```
2
0 0
1 2 1
```

### 输出

```
0
```

## 样例 #3

### 输入

```
5
-2 -8 10 -2 2
3 5 1
1 3 5
2 5 0
3 4 6
```

### 输出

```
28
```



---

---
title: "[AGC002C] Knot Puzzle"
layout: "post"
diff: 普及/提高-
pid: AT_agc002_c
tag: []
---

# [AGC002C] Knot Puzzle

## 题目描述

[problemUrl]: https://atcoder.jp/contests/agc002/tasks/agc002_c





---

---
title: "[AGC003B] Simplified mahjong"
layout: "post"
diff: 普及/提高-
pid: AT_agc003_b
tag: []
---

# [AGC003B] Simplified mahjong

## 题目描述

[problemUrl]: https://atcoder.jp/contests/agc003/tasks/agc003_b

高橋君は $ 1 $ から $ N $ までの整数のうちのどれかが書かれたカードをたくさん持っています。 高橋君は整数 $ i $ が書かれたカードを $ A_i $ 枚持っています。

$ 2 $ 枚のカードについて、それらに書かれた整数の差の絶対値が $ 1 $ 以下のとき、これらをペアにすることができます。

高橋君は、同じカードが複数のペアに使われないように、できるだけ多くのペアを作りたいです。高橋君が作れるペアの個数の最大値を求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ A_1 $ : $ A_N $

## 输出格式

高橋君が作れるペアの個数の最大値を出力せよ。

## 说明/提示

### 制約

- $ 1\ ≦\ N\ ≦\ 10^5 $
- $ 0\ ≦\ A_i\ ≦\ 10^9\ (1\ ≦\ i\ ≦\ N) $
- 入力はすべて整数である。

### Sample Explanation 1

一例として、$ (1,1),(1,1),(3,4),(3,4) $ の $ 4 $ つのペアをつくることができます。

## 样例 #1

### 输入

```
4

4

0

3

2
```

### 输出

```
4
```

## 样例 #2

### 输入

```
8

2

0

1

6

0

8

2

1
```

### 输出

```
9
```



---

---
title: "[AGC008A] Simple Calculator"
layout: "post"
diff: 普及/提高-
pid: AT_agc008_a
tag: []
---

# [AGC008A] Simple Calculator

## 题目描述

[problemUrl]: https://atcoder.jp/contests/agc008/tasks/agc008_a

すぬけ君は電卓を持っています。 この電卓にはディスプレイと $ 2 $ 個のボタンが付いています。

最初、ディスプレイの値は整数 $ x $ です。 すぬけ君の目標は、ディスプレイの値を整数 $ y $ にすることです。 そのために、すぬけ君は次の $ 2 $ 個のボタンを好きな順番で何回か押すことができます。

- ボタン A : ディスプレイの値を $ 1 $ 増やす。
- ボタン B : ディスプレイの値の符号を反転する。

目標を達成するためにすぬけ君がボタンを押す回数の最小値を求めてください。 なお、整数 $ x $, $ y $ の値によらず、必ず目標を達成できることが示せます。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ x $ $ y $

## 输出格式

目標を達成するためにすぬけ君がボタンを押す回数の最小値を出力せよ。

## 说明/提示

### 制約

- $ x $, $ y $ は整数である。
- $ |x|,\ |y|\ <\ =\ 10^9 $
- $ x $, $ y $ は相異なる。

### Sample Explanation 1

ボタン A を $ 10 $ 回押せばよいです。

### Sample Explanation 2

ボタン B を $ 1 $ 回押せばよいです。

### Sample Explanation 3

次の順でボタンを押せばよいです。 - ボタン B を $ 1 $ 回押す。 - ボタン A を $ 10 $ 回押す。 - ボタン B を $ 1 $ 回押す。

## 样例 #1

### 输入

```
10 20
```

### 输出

```
10
```

## 样例 #2

### 输入

```
10 -10
```

### 输出

```
1
```

## 样例 #3

### 输入

```
-10 -20
```

### 输出

```
12
```



---

---
title: "[AGC009A] Multiple Array"
layout: "post"
diff: 普及/提高-
pid: AT_agc009_a
tag: []
---

# [AGC009A] Multiple Array

## 题目描述

[problemUrl]: https://atcoder.jp/contests/jrex2017/tasks/agc009_a

$ N $ 項からなる数列 $ A_1,...,A_N $ があり、$ N $ 個のボタンがあります。 $ i(1\ ≦\ i\ ≦\ N) $ 個目のボタンを押すと、数列 $ A $ の $ 1 $ 項目から $ i $ 項目までの値が $ 1 $ ずつ増加します。

数列 $ B_1,...,B_N $ が与えられます。高橋君は、これらのボタンを何回か押して、すべての $ i $ に対し、$ A_i $ が $ B_i $ の倍数になるようにします。

高橋君がボタンを押す回数の最小値を求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ A_1 $ $ B_1 $ : $ A_N $ $ B_N $

## 输出格式

高橋君がボタンを押す回数の最小値を表す整数を出力せよ。

## 说明/提示

### 制約

- 入力はすべて整数である。
- $ 1\ ≦\ N\ ≦\ 10^5 $
- $ 0\ ≦\ A_i\ ≦\ 10^9(1\ ≦\ i\ ≦\ N) $
- $ 1\ ≦\ B_i\ ≦\ 10^9(1\ ≦\ i\ ≦\ N) $

### Sample Explanation 1

$ 1 $ つめのボタンを $ 2 $ 回、$ 2 $ つめのボタンを $ 2 $ 回、$ 3 $ つめのボタンを $ 3 $ 回押せばよいです。

## 样例 #1

### 输入

```
3

3 5

2 7

9 4
```

### 输出

```
7
```

## 样例 #2

### 输入

```
7

3 1

4 1

5 9

2 6

5 3

5 8

9 7
```

### 输出

```
22
```



---

---
title: "[AGC011A] Airport Bus"
layout: "post"
diff: 普及/提高-
pid: AT_agc011_a
tag: []
---

# [AGC011A] Airport Bus

## 题目描述

[problemUrl]: https://atcoder.jp/contests/agc011/tasks/agc011_a

高橋空港には，毎日飛行機で $ N $ 人の乗客が到着します． $ i $ 番目の乗客は時刻 $ T_i $ に到着します．

高橋空港に到着する乗客は全員バスで市内へ移動します．どのバスも定員は $ C $ 人であり，$ C $ 人以下の乗客を乗せることができます． 飛行機の乗客は，飛行機の到着時刻よりも早く出発するバスには乗ることができません． また，飛行機の到着時刻から $ K $ の時間が経過した後にもバスに乗れていないと，怒り出してしまいます． そのため，$ i $ 番目の乗客は，出発時刻が $ T_i $ 以上 $ T_i\ +\ K $ 以下であるようなバスに乗れるようにしないといけません．

この条件のもとで，うまくバスの出発時刻を定めるとき，必要なバスの数の最小値を求めてください． ただし，バスの出発時刻は必ずしも整数である必要はなく，同じ時刻に出発するバスが複数あってもかまいません．

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ C $ $ K $ $ T_1 $ $ T_2 $ $ : $ $ T_N $

## 输出格式

必要なバスの数の最小値を出力せよ．

## 说明/提示

### 制約

- $ 2\ \leq\ N\ \leq\ 100000 $
- $ 1\ \leq\ C\ \leq\ 10^9 $
- $ 1\ \leq\ K\ \leq\ 10^9 $
- $ 1\ \leq\ T_i\ \leq\ 10^9 $
- $ C,\ K,\ T_i $ は整数

### Sample Explanation 1

例えば，時刻 $ 4.5 $, $ 6 $, $ 12 $ にバスを出発させ，次のように乗客をバスに乗せるとよいです． - 時刻 $ 4.5 $ に出発するバスには，時刻 $ 2,\ 3 $ に到着する乗客を乗せる． - 時刻 $ 6 $ に出発するバスには，時刻 $ 1,\ 6 $ に到着する乗客を乗せる． - 時刻 $ 12 $ に出発するバスには，時刻 $ 12 $ に到着する乗客を乗せる．

## 样例 #1

### 输入

```
5 3 5

1

2

3

6

12
```

### 输出

```
3
```

## 样例 #2

### 输入

```
6 3 3

7

6

2

8

10

6
```

### 输出

```
3
```



---

---
title: "[AGC011B] Colorful Creatures"
layout: "post"
diff: 普及/提高-
pid: AT_agc011_b
tag: []
---

# [AGC011B] Colorful Creatures

## 题目描述

[problemUrl]: https://atcoder.jp/contests/agc011/tasks/agc011_b

すぬけ君は，$ N $ 匹の変わった生き物を見つけました． それぞれの生き物には色と大きさが定まっており，$ i $ 番目の生き物の色は $ i $，大きさは $ A_i $ で表されます．

どの生き物も，大きさが自分の $ 2 $ 倍以下であるような他の生き物を吸収することができます． 大きさ $ A $，色 $ B $ の生き物が大きさ $ C $，色 $ D $ の生き物を吸収すると ($ C\ \leq\ 2\ \times\ A $)，合体して大きさ $ A+C $，色 $ B $ の生き物になります． ここで，$ 2 $ 匹の生き物の大きさによっては，どちらも他方を吸収することが可能な場合があります．

すぬけ君がこの生き物たちを観察していると，合体を繰り返して，最終的に $ 1 $ 匹になりました． このとき，残った生き物の色として考えられるものは何種類あるかを求めてください．

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ A_1 $ $ A_2 $ … $ A_N $

## 输出格式

この生き物たちが合体を繰り返して，最終的に $ 1 $ 匹になったとき，残った生き物の色として考えられるものは何通りあるかを出力せよ．

## 说明/提示

### 制約

- $ 2\ \leq\ N\ \leq\ 100000 $
- $ 1\ \leq\ A_i\ \leq\ 10^9 $
- $ A_i $ は整数

### Sample Explanation 1

最終的に残った生き物の色としては色 $ 1 $, $ 3 $ が考えられます． 例えば，色 $ 3 $ の生き物が色 $ 2 $ の生き物を吸収し，次に色 $ 1 $ の生き物が色 $ 3 $ の生き物と合体すると，色 $ 1 $ の生き物のみが残ります．

### Sample Explanation 2

同じ大きさの生き物が複数いる場合もあります．

## 样例 #1

### 输入

```
3

3 1 4
```

### 输出

```
2
```

## 样例 #2

### 输入

```
5

1 1 1 1 1
```

### 输出

```
5
```

## 样例 #3

### 输入

```
6

40 1 30 2 7 20
```

### 输出

```
4
```



---

---
title: "[AGC012A] AtCoder Group Contest"
layout: "post"
diff: 普及/提高-
pid: AT_agc012_a
tag: []
---

# [AGC012A] AtCoder Group Contest

## 题目描述

[problemUrl]: https://atcoder.jp/contests/agc012/tasks/agc012_a

AtCoder Group Contestの参加者に $ 3N $ 人が参加します。 $ i $ 番目の参加者の *強さ* は整数 $ a_i $ で表されます。 参加者が $ 3 $ 人 $ 1 $ 組となるようにチームを $ N $ 組作ることにしました。$ 1 $ 人の参加者が複数のチームに所属することはできません。

チームの強さはチームメンバーの強さのうち $ 2 $ 番目に大きい値で表されます。 例えば、強さが $ 1,5,2 $ のメンバーからなるチームの強さは $ 2 $ になり、強さが $ 3,2,3 $ のメンバーからなるチームの強さは $ 3 $ になります。

$ N $ 組のチームの強さの和としてありうる値のうち、最大の値を求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ a_1 $ $ a_2 $ $ ... $ $ a_{3N} $

## 输出格式

答えを出力せよ。

## 说明/提示

### 制約

- $ 1\ ≦\ N\ ≦\ 10^5 $
- $ 1\ ≦\ a_i\ ≦\ 10^{9} $
- $ a_i $ は整数

### Sample Explanation 1

例えば以下のようにチームを作ったとき、チームの強さの和が最大となります。 - チーム $ 1 $：$ 1,4,5 $ 番目の参加者からなる。 - チーム $ 2 $：$ 2,3,6 $ 番目の参加者からなる。

### Sample Explanation 2

チームの強さの和は非常に大きくなることがあります。

## 样例 #1

### 输入

```
2

5 2 8 5 1 5
```

### 输出

```
10
```

## 样例 #2

### 输入

```
10

1000000000 1000000000 1000000000 1000000000 1000000000 1000000000 1000000000 1000000000 1000000000 1000000000 1000000000 1000000000 1000000000 1000000000 1000000000 1000000000 1000000000 1000000000 1000000000 1000000000 1000000000 1000000000 1000000000 1000000000 1000000000 1000000000 1000000000 1000000000 1000000000 1000000000
```

### 输出

```
10000000000
```



---

---
title: "[AGC013A] Sorted Arrays"
layout: "post"
diff: 普及/提高-
pid: AT_agc013_a
tag: []
---

# [AGC013A] Sorted Arrays

## 题目描述

## 题目翻译

给出长度为N的数列A，你需要把A划分成几个连续子串，要求每个子串都为单调不降子串或单调不升子串，求子串的最少个数。

## 输入格式

第一行一个数N，第2行为数列A

## 输出格式

一个数，代表子串的最小个数

## 样例 #1

### 输入

```
6

1 2 3 2 2 1
```

### 输出

```
2
```

## 样例 #2

### 输入

```
9

1 2 1 2 1 2 1 2 1
```

### 输出

```
5
```

## 样例 #3

### 输入

```
7

1 2 3 2 1 999999999 1000000000
```

### 输出

```
3
```



---

---
title: "[AGC013B] Hamiltonish Path"
layout: "post"
diff: 普及/提高-
pid: AT_agc013_b
tag: []
---

# [AGC013B] Hamiltonish Path

## 题目描述

[problemUrl]: https://atcoder.jp/contests/agc013/tasks/agc013_b

$ N $ 頂点 $ M $ 辺の、連結な単純無向グラフが与えられます。 頂点には $ 1 $ から $ N $ までの番号がついており、辺には $ 1 $ から $ M $ までの番号がついています。 辺 $ i $ は、頂点 $ A_i $ と頂点 $ B_i $ を結んでいます。 次の条件を満たすパスを $ 1 $ つ見つけて、出力してください。

- $ 2 $ 個以上の頂点を通る
- 同じ頂点を $ 2 $ 度以上通らない
- パスの少なくとも一方の端点と直接辺で結ばれている頂点は、必ずパスに含まれる

ただし、この問題の制約の下で、このようなパスが必ず存在することが証明できます。 また、あり得る答えのうちどれを出力しても構いません。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ M $ $ A_1 $ $ B_1 $ $ A_2 $ $ B_2 $ $ : $ $ A_M $ $ B_M $

## 输出格式

条件を満たすパスを $ 1 $ つ見つけて出力せよ。 出力の $ 1 $ 行目には、パスに含まれる頂点の個数を出力せよ。 出力の $ 2 $ 行目には、パスに含まれる頂点の番号を、パスを形成するような順序で、空白区切りにして出力せよ。

## 说明/提示

### 制約

- $ 2\ \leq\ N\ \leq\ 10^5 $
- $ 1\ \leq\ M\ \leq\ 10^5 $
- $ 1\ \leq\ A_i\ <\ B_i\ \leq\ N $
- 与えられるグラフは連結かつ単純（どの $ 2 $ 頂点を直接結ぶ辺も高々 $ 1 $ つ）である

### Sample Explanation 1

頂点 $ 2 $ と直接辺で結ばれている頂点は、頂点 $ 3 $ と $ 4 $ です。 頂点 $ 4 $ と直接辺で結ばれている頂点は、頂点 $ 1 $ と $ 2 $ です。 なので、$ 2 $ → $ 3 $ → $ 1 $ → $ 4 $ というパスは条件を満たします。

## 样例 #1

### 输入

```
5 6

1 3

1 4

2 3

1 5

3 5

2 4
```

### 输出

```
4

2 3 1 4
```

## 样例 #2

### 输入

```
7 8

1 2

2 3

3 4

4 5

5 6

6 7

3 5

2 6
```

### 输出

```
7

1 2 3 4 5 6 7
```

## 样例 #3

### 输入

```
12 18

3 5

4 12

9 11

1 10

2 5

6 10

8 11

1 3

4 10

2 4

3 7

2 10

3 12

3 9

1 7

2 3

2 11

10 11
```

### 输出

```
8

12 4 2 5 3 9 11 8
```



---

---
title: "[AGC015B] Evilator"
layout: "post"
diff: 普及/提高-
pid: AT_agc015_b
tag: []
---

# [AGC015B] Evilator

## 题目描述

[problemUrl]: https://atcoder.jp/contests/agc015/tasks/agc015_b

すけぬ君は、$ N $ 階建てのビルを建てました。ビルにはエレベーターが $ 1 $ 基あり、すべての階に止まります。

すけぬ君は、各階に上下の方向ボタンを設置しましたが、うっかりしていたため、どの階にも上向きか下向きの片方のボタンしかありません。 そのため、どの階からも上か下のどちらかにしか進むことができません。 $ S_i $ が `U` のとき $ i $ 階には上向きのボタンしかなく、上にしか進めないことを、`D` のとき下向きのボタンしかなく、 下にしか進めないことを表します。

ある階から目的の階へと移動したい住民は、仕方がないので必要があれば他の階を経由して目的の階へと向かうことにしました。 全ての階の順序対 $ (i,j) $ についての、$ i $ 階から $ j $ 階へ行くときのエレベーターに乗る回数の最小値の合計を求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ S_1S_2...S_{|S|} $

## 输出格式

全ての階の順序対 $ (i,j) $ についての、$ i $ 階から $ j $ 階へ行くときのエレベーターに乗る回数の最小値の合計を出力せよ。

## 说明/提示

### 制約

- $ 2\ ≦\ |S|\ ≦\ 10^5 $
- $ S_i $ は `U` または `D` である
- $ S_1 $ は `U` である
- $ S_{|S|} $ は `D` である

### Sample Explanation 1

$ 1 $ 階から $ 2 $ 階までは、$ 1 $ 回エレベーターに乗れば行くことができます。 $ 1 $ 階から $ 3 $ 階までは、$ 1 $ 回エレベーターに乗れば行くことができます。 $ 2 $ 階から $ 1 $ 階までは、$ 2 $ 回エレベーターに乗れば行くことができます。 $ 2 $ 階から $ 3 $ 階までは、$ 1 $ 回エレベーターに乗れば行くことができます。 $ 3 $ 階から $ 1 $ 階までは、$ 1 $ 回エレベーターに乗れば行くことができます。 $ 3 $ 階から $ 2 $ 階までは、$ 1 $ 回エレベーターに乗れば行くことができます。 これらの合計は $ 7 $ なので、$ 7 $ を出力します。

## 样例 #1

### 输入

```
UUD
```

### 输出

```
7
```

## 样例 #2

### 输入

```
UUDUUDUD
```

### 输出

```
77
```



---

---
title: "[AGC016A] Shrinking"
layout: "post"
diff: 普及/提高-
pid: AT_agc016_a
tag: []
---

# [AGC016A] Shrinking

## 题目描述

[problemUrl]: https://atcoder.jp/contests/agc016/tasks/agc016_a

すぬけ君は、次のルールに従い、長さ $ N $ の文字列 $ t $ を長さ $ N\ -\ 1 $ の文字列 $ t' $ へ変えることができます。

- 各 $ i $ ($ 1\ <\ =\ i\ <\ =\ N\ -\ 1 $) について、$ t' $ の $ i $ 文字目は $ t $ の $ i $, $ i\ +\ 1 $ 文字目のどちらかである。

英小文字のみからなる文字列 $ s $ があります。 すぬけ君の目標は、$ s $ に上記の操作を繰り返し行い、$ s $ が単一の文字のみからなるようにすることです。 目標を達成するために必要な操作回数の最小値を求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ s $

## 输出格式

目標を達成するために必要な操作回数の最小値を出力せよ。

## 说明/提示

### 制約

- $ 1\ <\ =\ |s|\ <\ =\ 100 $
- $ s $ は英小文字のみからなる。

### Sample Explanation 1

例えば、`serval` → `srvvl` → `svvv` → `vvv` と変えればよいです。

### Sample Explanation 2

例えば、`jackal` → `aacaa` → `aaaa` と変えればよいです。

### Sample Explanation 3

最初から $ s $ が単一の文字のみからなっています。

### Sample Explanation 4

$ 8 $ 回の操作によって、$ s $ を `rrrrrrrrrrrrrrrrrr` へ変えることができます。

## 样例 #1

### 输入

```
serval
```

### 输出

```
3
```

## 样例 #2

### 输入

```
jackal
```

### 输出

```
2
```

## 样例 #3

### 输入

```
zzz
```

### 输出

```
0
```

## 样例 #4

### 输入

```
whbrjpjyhsrywlqjxdbrbaomnw
```

### 输出

```
8
```



---

---
title: "[AGC019B] Reverse and Compare"
layout: "post"
diff: 普及/提高-
pid: AT_agc019_b
tag: []
---

# [AGC019B] Reverse and Compare

## 题目描述

[problemUrl]: https://atcoder.jp/contests/agc019/tasks/agc019_b

英小文字からなる文字列 $ A\ =\ A_1\ A_2\ ...\ A_n $ があります。

あなたは $ 1\ \leq\ i\ \leq\ j\ \leq\ n $ であるような任意の二つの添字 $ i,\ j $ を選び、$ A $ のうち部分文字列 $ A_i\ A_{i+1}\ ...\ A_j $ を反転することができます。

この操作は一回まで行うことができます。

これによって得られる文字列は何通りあるでしょうか？

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ A $

## 输出格式

$ A $ のうち任意の部分文字列を一回まで反転することによって、何通りの文字列が得られるか出力せよ。

## 说明/提示

### 制約

- $ 1\ \leq\ |A|\ \leq\ 200,000 $
- $ A $ は英小文字からなる。

### Sample Explanation 1

得られる文字列は `aatt`（何もしない）、`atat`（$ A[2..3] $ を反転）、`atta`（$ A[2..4] $ を反転）、`ttaa`（$ A[1..4] $ を反転）、`taat`（$ A[1..3] $ を反転）です。

### Sample Explanation 2

どの部分文字列を反転しても、結果は `xxxxxxxxxx` です。

## 样例 #1

### 输入

```
aatt
```

### 输出

```
5
```

## 样例 #2

### 输入

```
xxxxxxxxxx
```

### 输出

```
1
```

## 样例 #3

### 输入

```
abracadabra
```

### 输出

```
44
```



---

---
title: "[AGC021A] Digit Sum 2"
layout: "post"
diff: 普及/提高-
pid: AT_agc021_a
tag: []
---

# [AGC021A] Digit Sum 2

## 题目描述

[problemUrl]: https://atcoder.jp/contests/agc021/tasks/agc021_a

$ N $ 以下の正の整数の $ 10 $ 進法での各桁の和の最大値を求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $

## 输出格式

$ N $ 以下の正の整数の $ 10 $ 進法での各桁の和の最大値を出力せよ。

## 说明/提示

### 制約

- $ 1\leq\ N\ \leq\ 10^{16} $
- $ N $ は整数である

### Sample Explanation 1

例えば $ 99 $ の各桁の和は $ 18 $ で、これが求める最大値となります。

### Sample Explanation 2

例えば $ 9989 $ の各桁の和は $ 35 $ で、これが求める最大値となります。

## 样例 #1

### 输入

```
100
```

### 输出

```
18
```

## 样例 #2

### 输入

```
9995
```

### 输出

```
35
```

## 样例 #3

### 输入

```
3141592653589793
```

### 输出

```
137
```



---

---
title: "[AGC022A] Diverse Word"
layout: "post"
diff: 普及/提高-
pid: AT_agc022_a
tag: []
---

# [AGC022A] Diverse Word

## 题目描述

[problemUrl]: https://atcoder.jp/contests/agc022/tasks/agc022_a

ゴトウは辞書をもらいました。ところが、その辞書は知らない言語で書かれていました。 分析した結果、その辞書にはありうるすべての **多彩** な単語が辞書順に載っていることがわかりました。

単語は、それが英小文字からなる空でない文字列であって、単語内の文字がすべて異なる場合、そしてその場合に限って **多彩** であると呼ばれます。例えば、`atcoder`、`zscoder`、`agc` は多彩な単語ですが、`gotou`、`connect` は多彩な単語ではありません。

多彩な単語 $ S $ が与えられるので、この辞書で $ S $ の次に載っている単語、すなわち、$ S $ より辞書順で大きいような、辞書順で最小の多彩な単語を求めてください。あるいは、そのような単語は存在しないと判定してください。

なお、$ X\ =\ x_{1}x_{2}...x_{n} $、$ Y\ =\ y_{1}y_{2}...y_{m} $ を二つの異なる文字列とするとき、$ Y $ が $ X $ の接頭辞であるか、$ j $ を $ x_{j}\ \neq\ y_{j} $ であるような最小の整数として $ x_{j}\ >\ y_{j} $ である場合、そしてその場合に限って $ X $ は $ Y $ より辞書順で大きいといいます。

## 输入格式

入力は標準入力から以下の形式で与えられる。

> $ S $

## 输出格式

辞書で $ S $ の次に載っている単語を出力せよ。ただし、そのような単語が存在しない場合は `-1` と出力せよ。

## 说明/提示

### 制約

- $ 1\ \leq\ |S|\ \leq\ 26 $
- $ S $ は多彩な単語である。

### Sample Explanation 1

`atcoder` より辞書順で大きいような、辞書順で最小の多彩な単語は `atcoderb` です。`atcoderb` は `b` より辞書順で小さいことに注意してください。

### Sample Explanation 3

これが辞書順で最も大きい多彩な単語なので、答えは `-1` です。

## 样例 #1

### 输入

```
atcoder
```

### 输出

```
atcoderb
```

## 样例 #2

### 输入

```
abc
```

### 输出

```
abcd
```

## 样例 #3

### 输入

```
zyxwvutsrqponmlkjihgfedcba
```

### 输出

```
-1
```

## 样例 #4

### 输入

```
abcdefghijklmnopqrstuvwzyx
```

### 输出

```
abcdefghijklmnopqrstuvx
```



---

---
title: "[AGC023A] Zero-Sum Ranges"
layout: "post"
diff: 普及/提高-
pid: AT_agc023_a
tag: []
---

# [AGC023A] Zero-Sum Ranges

## 题目描述

[problemUrl]: https://atcoder.jp/contests/agc023/tasks/agc023_a

長さ $ N $ の整数列 $ A $ があります。

$ A $ の **空でない** **連続する** 部分列であって、その総和が $ 0 $ になるものの個数を求めてください。 ただし、ここで数えるのは **部分列の取り出し方** であることに注意してください。 つまり、ある $ 2 $ つの部分列が列として同じでも、取り出した位置が異なるならば、それらは別々に数えるものとします。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ A_1 $ $ A_2 $ $ ... $ $ A_N $

## 输出格式

$ A $ の空でない連続する部分列であって、その総和が $ 0 $ になるものの個数を出力せよ。

## 说明/提示

### 制約

- $ 1\ \leq\ N\ \leq\ 2\ \times\ 10^5 $
- $ -10^9\ \leq\ A_i\ \leq\ 10^9 $
- 入力はすべて整数である。

### Sample Explanation 1

空でない連続した部分列であって、その総和が $ 0 $ になるのは、$ (1,3,-4) $, $ (-4,2,2) $, $ (2,-2) $ の $ 3 $ つです。

### Sample Explanation 2

この例では、列として同じだが取り出す位置の異なる部分列が複数回数えられています。 例えば、$ (1,-1) $ は $ 3 $ 回数えられています。

### Sample Explanation 3

空でない連続した部分列であって、その総和が $ 0 $ になるものはありません。

## 样例 #1

### 输入

```
6

1 3 -4 2 2 -2
```

### 输出

```
3
```

## 样例 #2

### 输入

```
7

1 -1 1 -1 1 -1 1
```

### 输出

```
12
```

## 样例 #3

### 输入

```
5

1 -2 3 -4 5
```

### 输出

```
0
```



---

---
title: "Alternating Path"
layout: "post"
diff: 普及/提高-
pid: AT_aising2019_c
tag: []
---

# Alternating Path

## 题目描述

[problemUrl]: https://atcoder.jp/contests/aising2019/tasks/aising2019_c

$ H $ 行 $ W $ 列のマス目があり、各マスは黒または白に塗られています。

各マスの色を表す $ H $ 個の長さ $ W $ の文字列 $ S_1,\ S_2,\ ...,\ S_H $ が与えられます。 マス目の上から $ i $ 番目、左から $ j $ 番目 ($ 1\ \leq\ i\ \leq\ H,\ 1\ \leq\ j\ \leq\ W $) のマスが黒く塗られているとき 文字列 $ S_i $ の $ j $ 文字目は `#` となっており、白く塗られているとき文字列 $ S_i $ の $ j $ 文字目は `.` となっています。

黒く塗られたマス $ c_1 $ と白く塗られたマス $ c_2 $ の組であって、以下の条件を満たすものの個数を求めてください。

- 上下左右に隣り合うマスへの移動を繰り返してマス $ c_1 $ からマス $ c_2 $ へ行く方法であって、通るマスの色が黒、白、黒、白・・・と交互になっているものが存在する。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ H $ $ W $ $ S_1 $ $ S_2 $ $ : $ $ S_H $

## 输出格式

答えを出力せよ。

## 说明/提示

### 制約

- $ 1\ \leq\ H,\ W\ \leq\ 400 $
- $ |S_i|\ =\ W $ ($ 1\ \leq\ i\ \leq\ H $)
- 各 $ i $ ($ 1\ \leq\ i\ \leq\ H $) に対して、文字列 $ S_i $ は文字 `#` と文字 `.` だけからなる。

### Sample Explanation 1

上から $ i $ 行目、左から $ j $ 列目のマスを $ (i,\ j) $ と書くとき、条件を満たすマスの組として $ ((1,\ 2),\ (3,\ 3)) $ や $ ((3,\ 1),\ (3,\ 2)) $ などがあります。

## 样例 #1

### 输入

```
3 3

.#.

..#

#..
```

### 输出

```
10
```

## 样例 #2

### 输入

```
2 4

....

....
```

### 输出

```
0
```

## 样例 #3

### 输入

```
4 3

###

###

...

###
```

### 输出

```
6
```



---

---
title: "Two Arrays"
layout: "post"
diff: 普及/提高-
pid: AT_apc001_b
tag: []
---

# Two Arrays

## 题目描述

[problemUrl]: https://atcoder.jp/contests/apc001/tasks/apc001_b

長さ $ N $ の数列 $ a_1,a_2,..,a_N $ と $ b_1,b_2,..,b_N $ が与えられます。 以下の操作を $ 0 $ 回以上好きなだけ繰り返して、数列 $ a $ と $ b $ を一致させられるか判定してください。

操作： $ 1 $ 以上 $ N $ 以下の整数 $ i,j $ (一致していてもよい)を選び、次の2つのことを**同時に**行う。

- $ a_i $ に $ 2 $ を足す
- $ b_j $ に $ 1 $ を足す

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ a_1 $ $ a_2 $ $ .. $ $ a_N $ $ b_1 $ $ b_2 $ $ .. $ $ b_N $

## 输出格式

操作を $ 0 $ 回以上繰り返して数列 $ a $ と $ b $ を一致させられるなら `Yes` を、 そうでないなら `No` を出力せよ。

## 说明/提示

### 制約

- $ 1\ <\ =\ N\ <\ =\ 10,000 $
- $ 0\ <\ =\ a_i,b_i\ <\ =\ 10^9 $ ($ 1\ <\ =\ i\ <\ =\ N $)
- 入力は全て整数

### Sample Explanation 1

例えば、次のように $ 3 $ 回操作すればよいです。 - $ 1 $ 回目： $ i=1,j=2 $. これによって $ a\ =\ \{3,2,3\} $, $ b\ =\ \{5,3,2\} $ となります。 - $ 2 $ 回目： $ i=1,j=2 $. これによって $ a\ =\ \{5,2,3\} $, $ b\ =\ \{5,4,2\} $ となります。 - $ 3 $ 回目： $ i=2,j=3 $. これによって $ a\ =\ \{5,4,3\} $, $ b\ =\ \{5,4,3\} $ となります。

## 样例 #1

### 输入

```
3

1 2 3

5 2 2
```

### 输出

```
Yes
```

## 样例 #2

### 输入

```
5

3 1 4 1 5

2 7 1 8 2
```

### 输出

```
No
```

## 样例 #3

### 输入

```
5

2 7 1 8 2

3 1 4 1 5
```

### 输出

```
No
```



---

---
title: "Vacant Seat"
layout: "post"
diff: 普及/提高-
pid: AT_apc001_c
tag: []
---

# Vacant Seat

## 题目描述

[problemUrl]: https://atcoder.jp/contests/apc001/tasks/apc001_c

**これはインタラクティブな問題です。**

$ N $ を $ 3 $ 以上の奇数とします。

$ N $ 個の席が円状に並んでいます。 席には $ 0 $ から $ N\ -\ 1 $ まで番号が振られています。 各 $ i $ ($ 0\ <\ =\ i\ <\ =\ N\ -\ 2 $) について、席 $ i $ と席 $ i\ +\ 1 $ は隣り合っています。 また、席 $ N\ -\ 1 $ と席 $ 0 $ は隣り合っています。

各席の状態は「空席」「男性が座っている」「女性が座っている」のどれかです。 ただし、同性どうしが隣り合う席に座っていることはありません。 $ N $ が $ 3 $ 以上の奇数の場合、空席が少なくとも $ 1 $ つは存在することが示せます。

あなたには $ N $ のみが与えられ、各席の状態は与えられません。 あなたの目標は、どれか $ 1 $ つの空席の番号を当てることです。 そのために、あなたは次のクエリを繰り返し送ることができます。

- 整数 $ i $ ($ 0\ <\ =\ i\ <\ =\ N\ -\ 1 $) を選ぶ。 席 $ i $ が空席ならば、正答となる。 そうでなければ、席 $ i $ に座っている人の性別が知らされる。

クエリを高々 $ 20 $ 回まで送ることで、どれか $ 1 $ つの空席の番号を当ててください。

### Input &amp; Output Format

最初に、$ N $ が次の形式で標準入力から与えられる。

> $ N $

次に、クエリを繰り返し送る。 クエリは次の形式で標準出力へ出力する。 行末には改行を出力せよ。

> $ i $

これに対するクエリの答えは、次の形式で標準入力から与えられる。

> $ s $

$ s $ は `Vacant`, `Male`, `Female` のどれかである。 これらはそれぞれ、席 $ i $ の状態が「空席」「男性が座っている」「女性が座っている」であることを表す。

## 说明/提示

### 制約

- $ N $ は奇数である。
- $ 3\ <\ =\ N\ <\ =\ 99,999 $

### 注意

- 出力の度に標準出力を flush せよ。 そうしない場合、`TLE` の可能性がある。
- $ s $ が `Vacant` の場合、すぐにプログラムを終了せよ。 そうしない場合、ジャッジ結果は不定である。
- クエリ回数が $ 20 $ を超えた場合、およびクエリの形式が正しくない場合、ジャッジ結果は不定である。

### 入出力例 1

このサンプルでは、$ N\ =\ 3 $ であり、席 $ 0 $, $ 1 $, $ 2 $ の状態はそれぞれ「男性が座っている」「女性が座っている」「空席」である。

 InputOutput30Male1Female2Vacant



---

---
title: "[ARC004C] 平均値太郎の憂鬱 ( The melancholy of Taro Heikinchi )"
layout: "post"
diff: 普及/提高-
pid: AT_arc004_3
tag: []
---

# [ARC004C] 平均値太郎の憂鬱 ( The melancholy of Taro Heikinchi )

## 题目描述

太郎在计算1到n的平均数时漏加了一个m，给定算错的平均数，求正确的N和M

## 输入格式

仅1行，格式为X/Y，（1<=X<=10^18且1<=Y<=10^9），表示错误的平均数为Y分之X，X/Y不一定为最简分数

## 输出格式

一行两个整数N，M，中间以一个空格隔开，如果输出答案有多组，按N从小到大的顺序在1行输出，如果没有可行答案则输出"Impossible"



---

---
title: "[ARC006C] 積み重ね"
layout: "post"
diff: 普及/提高-
pid: AT_arc006_3
tag: []
---

# [ARC006C] 積み重ね

## 题目描述

[problemUrl]: https://atcoder.jp/contests/arc006/tasks/arc006_3

 高橋君はもう大人なので、親元を離れて一人暮らしをすることにしました。トラックから引越し先の部屋へと荷物のダンボールを運びたいのですが、部屋の床がダンボールで埋まってしまうと、今日高橋君が寝るための布団がひけません。  
 そこで、$ 1 $ 箱ずつ広げて置くのではなく、ある程度ダンボールを積み重ねた山を作ることにしました。しかし、ダンボールには重さが決まっており、下にあるダンボールよりも重いダンボールを上に積み重ねると下のダンボールが潰れてしまいます。

 ![](https://cdn.luogu.com.cn/upload/vjudge_pic/AT_arc006_3/330a155330da3a362b0b8091145394d207d35d61.png)図：下にあるダンボールは上にあるダンボール以上の重さでなければならない

 

   
 トラックから運ぶ順にダンボールの重さが与えられるので、ダンボールを潰さないような積み重ね方を考えなさい。そして、その積み重ねた山の個数が最小となる場合の山の個数を求めなさい。 入力は以下の形式で標準入力から与えられる。 > $ N $ $ w_1 $ $ w_2 $ : : $ w_N $

- 入力は $ N+1 $ 行ある。
- $ 1 $ 行目には、ダンボールの個数を表す整数 $ N(1≦N≦50) $ が与えられる。
- $ 2 $ 行目からの $ N $ 行には、$ i+1(1≦i≦N) $ 行目に $ i $ 番目に運ぶダンボールの重さを表す整数 $ w_i(1≦w_i≦100,000) $ が与えられる。

 ダンボールを順番に運び、上のダンボールが下のダンボールと同じ重さまたはそれよりも軽くなるように積み重ねたときに、できるダンボールの山の数の最小値を標準出力に $ 1 $ 行で出力せよ。  
 なお、最後には改行を出力せよ。 ```

5
4
3
1
2
1
```

 ```

2
```

- 下図の例の順に積み重ねると、$ 2 $ つのダンボールの山ができる。
- $ 3 $ 番目のダンボールの次に重さ $ 2 $ のダンボールをその上に重ねることはできないので $ 1 $ つの山にすることはできず、最小は $ 2 $ となる。

 ![](https://cdn.luogu.com.cn/upload/vjudge_pic/AT_arc006_3/5cdad1a3c2b4df6c6e3065e4cf34b9c2180d2f93.png)

 ```

7
93
249
150
958
442
391
25
```

 ```

3
```

- 下図の形に積み重ねると、山の数は $ 3 $ となる。
訂正：下図の225のダンボールは25の誤りです。申し訳ありません。


 ![](https://cdn.luogu.com.cn/upload/vjudge_pic/AT_arc006_3/87e99baa40b995194b9f08a6b6727576d861b3de.png)

 ```

4
100
100
100
100
```

 ```

1
```

- 同じ重さのダンボールは積み重ねられるので、$ 1 $ つの山にすることができる。
 
```

6
5
10
15
20
25
30
```

 ```

6
```

- どのダンボールも前に運んだダンボールの上に重ねられないので、$ 1 $ つも積み重ねることができない。
- したがって、$ 6 $ つの山が最小となる。
 
```

15
3
1
4
1
5
9
2
6
5
3
5
8
9
7
9
```

 ```

6
```

- 下図のように積み重ねると最小となる。

 ![](https://cdn.luogu.com.cn/upload/vjudge_pic/AT_arc006_3/6ff699ef802388c8a1126c225e6825673732bcea.png)



---

---
title: "[ARC007C] 節約生活"
layout: "post"
diff: 普及/提高-
pid: AT_arc007_3
tag: []
---

# [ARC007C] 節約生活

## 题目描述

[problemUrl]: https://atcoder.jp/contests/arc007/tasks/arc007_3

 高橋君は有料の衛星放送を見ようとしています。有料衛星放送はお金を払わないと見ることが出来ませんが、高橋君はその契約を行なっていません。  
 しかし、有料衛星放送はどのような内容を放送しているか視聴者がわかるように、無料でも視聴可能な時間が定期的に存在し、視聴可能な時間とできない時間が交互に繰り返されます。このような視聴可能な時間とそうでない時間を視聴パターンと呼ぶことにします。  
 視聴パターンは `o` と `x` から成り立っており、図 $ 1 $ で示すように視聴可能な時間を `o` の個数、視聴できない時間を `x` の個数で表しています。

 ![](https://cdn.luogu.com.cn/upload/vjudge_pic/AT_arc007_3/c5eb5a21de826083a4af9ac1eec2edaa30369137.png)図 $ 1 $:視聴パターンの例(入力は10文字以下なので、この入力はテストに存在しません)

 

 一度テレビを点けると途切れることなくこの視聴パターンが繰り返される。また、テレビは一度点けると消すことはできません。  
 高橋君は複数のテレビを点けるタイミングをずらして並行して利用することで、無料でも常にいずれかのテレビで視聴ができる方法を思いつきました。  
 例えば図 $ 1 $ の視聴パターンの場合は図 $ 2 $ で示すように $ 5 $ 分後にもう $ 1 $ 台テレビを点ければ常に視聴ができます。  ![](https://cdn.luogu.com.cn/upload/vjudge_pic/AT_arc007_3/517dbd3c013b729576e4fa4fb70355deef1c50c3.png)図 $ 2 $:$ 2 $ 台のテレビで常に視聴する例

 

 その場合高橋君が用意しなければいけない最低限のテレビの台数を答えなさい。  
 なお、必要なテレビを全て点け終えるまでの間には視聴できない時間があっても構いませんが、全てのテレビを点けてからは常にいずれかのテレビで視聴ができないといけません。  
 入力は以下の形式で標準入力から与えられる。 > $ c_0c_1 $‥‥$ c_{N-1} $

- 入力は $ 1 $ 行のみで視聴パターンを表す長さ $ N(1≦N≦10) $ の文字列が与えられる。
- 視聴パターンは `o` と `x` から成り、$ i+1(0≦i≦N-1) $ 番目の文字 $ c_i $ はテレビを点けてから $ i $ 分から $ i+1 $ 分の間はテレビが以下の状態であることを意味する。 
  - `o`:視聴可能である。
  - `x`:視聴できない。
- 視聴パターンは少なくとも $ 1 $ つの `o` を含む。
- テレビは最初にテレビをつけてから $ j(j\ : $正の整数) 分後にのみ点けることができる。



 常にいずれかのテレビが視聴可能であるために用意しなければいけないテレビの台数の最小値を標準出力に $ 1 $ 行で出力せよ。  
 必要なテレビを全て点け終えるまでの間は視聴できない時間があっても構わないが、全てのテレビを点けてからは常にいずれかのテレビが視聴できないといけない。  
 なお、最後には改行を出力せよ。 ```

oxoxx
```

 ```

3
```

- 以下の図のタイミングでテレビを点けることで $ 3 $ 台のテレビで常に視聴ができます。

 ![](https://cdn.luogu.com.cn/upload/vjudge_pic/AT_arc007_3/0ec6f675c53f19a2dd17db5988b73005b245d24c.png)

 ```

oxxxxoooo
```

 ```

2
```

- $ 1 $ 台目のテレビを点けてから $ 4 $ 分目に $ 2 $ 台目のテレビを点けることで $ 1 $ 分目から $ 5 $ 分目直前までは視聴が不可能だが、$ 5 $ 分目以降は視聴が可能になります。
 
```

ox
```

 ```

2
```

- $ 1 $ 台目のテレビを点けてから $ 1 $ 分後に $ 2 $ 台目のテレビを点けることで $ 2 $ 台で視聴可能です。
 
```

o
```

 ```

1
```

- 視聴パターンに視聴できない時間が含まれない場合もあります。
 
```

xxxoxo
```

 ```

4
```



---

---
title: "[ARC010B] 超大型連休"
layout: "post"
diff: 普及/提高-
pid: AT_arc010_2
tag: []
---

# [ARC010B] 超大型連休

## 题目描述

[problemUrl]: https://atcoder.jp/contests/arc010/tasks/arc010_2

$ 2011 $ 年、$ AtCoder $ 国の高橋首相はある重大な決定を行った。  
 その決定とは...法改正である。国民の祝日に関する法律を変更し、休日を増やすことにした!!  
 国民の創造性を尊重するその決定が、霞が関を魔境へと変えたッ！  
  
 あなたは霞が関の国土交通省に勤務する職員であり、この法改正により上司から新たな任務を与えられた。  
 その任務とは、$ 2012 $ 年の「連休の最大日数」を計算することである。  
 連休の大きさを事前に計算することで国民の行動を予想し、高速道路の部分的な値下げを行い、経済を活性させるためだ。  
 したがって、あなたに失敗することは許されない。国民の行動を正確に予想できなくなるからだ。  
  
 以下に、「連休」の定義と諸注意を記す。

1. $ AtCoder $ 国が使用する暦は[グレゴリオ暦](http://ja.wikipedia.org/wiki/%E3%82%B0%E3%83%AC%E3%82%B4%E3%83%AA%E3%82%AA%E6%9A%A6)に従う。
2. 「連休」とは、「休日」が連続して続くことである。
3. 「土曜日」「日曜日」「祝日」「振替休日」が「休日」に相当する。
4. 「祝日」が他の休日と同じ日に指定されていた場合、「振替休日」を必ず設置する。
5. 「振替休日」は祝日の時系列順に決定していき、その祝日以降最も近い平日（休日を除いた日）となる。
6. $ 2012 $ 年 $ 1 $ 月 $ 1 $ 日は日曜日である。
 
 入力は以下の形式で標準入力から与えられる。 > $ N $ $ m_{1} $/$ d_{1} $ $ m_{2} $/$ d_{2} $ $ : $ $ : $ $ m_{n} $/$ d_{n} $

- $ 1 $ 行目には祝日の日数を表す整数 $ N $ が与えられ、 $ 0≦N≦366 $ を満たす。
- $ 2 $ 行目から $ N+1 $ 行目までの $ N $ 行で祝日の日付が与えられる。

1. $ m_{i} $ は $ i(1≦i≦366) $ 番目に与えられる祝日の月で、 $ 1≦m_{i}≦12 $ を満たす。
2. $ d_{i} $ は $ i(1≦i≦366) $ 番目に与えられる祝日の日で、
1. $ m_{i}\ =\ 2 $ のとき、 $ 1≦d_{i}≦29 $ を満たす。
2. $ m_{i}\ =\ (4,\ 6,\ 9,\ 11) $ のとき、 $ 1≦d_{i}≦30 $ を満たす。
3. $ m_{i}\ =\ (1,\ 3,\ 5,\ 7,\ 8,\ 10,\ 12) $ のとき、 $ 1≦d_{i}≦31 $ を満たす。

4. $ m_{i} $ と $ d_{i} $ はともに整数である。
5. $ m_{i} $ と $ d_{i} $ は必ず`/`で区切られて与えられる。
6. 祝日は時系列順に与えられるとは限らないことに注意せよ。ただし、同じ日付が複数与えられないことは保証されている。
 
 法改正後における $ 2012 $ 年の連休の最大日数を出力せよ。  
 出力は標準出力におこない、末尾には改行をいれること。  
```

1
1/9
```

 ```

3
```

- 1/7(土),1/8(日),1/9(月)の $ 3 $ 連休が最長です。
 
```

1
1/10
```

 ```

2
```

- 1/10(火)が祝日となり、1/7(土),1/8(日)などの $ 2 $ 連休が最長です。
 
```

1
1/7
```

 ```

3
```

- 1/7は土曜日なので、以降で最も近い平日である1/9が振替休日になります。
- よって、1/7(土)、1/8(日)、1/9(月)の3連休が最長です。
 
```

2
1/7
1/9
```

 ```

4
```

- 1/7は土曜日なので振替休日を以降に設定したく、1/9が祝日なので1/10が振替休日になります。
- よって、1/7(土)、1/8(日)、1/9(月)、1/10(火)の4連休が最長です。



---

---
title: "[ARC011B] ルイス・キャロルの記憶術"
layout: "post"
diff: 普及/提高-
pid: AT_arc011_2
tag: []
---

# [ARC011B] ルイス・キャロルの記憶術

## 题目描述

例如，莫扎特的生卒年可以通过记忆句子 `Mozart plays magic.` 来记住。其中，词 $ plays $ 转换成 $ 756 $，词 $ magic $ 转换成 $ 791 $，从而得到 $ 1756 $ 年至 $ 1791 $ 年。你的任务是，编写一个程序，根据输入的记忆句子，从左到右逐个词进行转换，输出转换得到的数字。

## 输入格式

输入包括以下内容：
- 第一行是一个整数 $ N (1 \leq N \leq 1000) $，表示有多少个单词。
- 第二行是 $ N $ 个单词，每个单词由字母、句点或逗号组成，单词之间用空格分隔。

## 输出格式

输出转换后的数字，每个数字之间用一个空格隔开。如果转换后的数字以 `0` 开头，也输出 `0`。最后请输出一个换行符。

## 示例

输入：
```
3
Mozart plays magic.
```

输出：
```
7003 756 791
```

- `Mozart`：`M` 转换为 $ 7 $，`z` 转换为 $ 0 $，`r` 转换为 $ 0 $，`t` 转换为 $ 3 $，结果为 $ 7003 $。
- 类似地，`plays` 转换为 $ 756 $，`magic` 转换为 $ 791 $。

输入：
```
3
Columbus found USA.
```

输出：
```
15716 492 6
```

- `Columbus` 转换为 $ 15716 $。
- `found` 转换为 $ 492 $。
- `USA` 转换为 $ 6 $。

输入：
```
7
I have a scissors for right hand.
```

输出：
```
85 616606 40 0983 892
```

- `I` 和 `a` 完全由元音组成，因此被忽略，结果输出 $ 5 $ 个整数。

输入：
```
4
abc ab aa aiueo
```

输出：
```
11 1
```

- 输出时不能有多余的空格。

修订：2013.01.19 21:16 第一行的 $ 5 $ 是错误的，已更正为 $ 4 $。

输入：
```
4
aaa aa a aa
```

输出：
```
```

- 因为所有单词都只含元音字母，所以仅输出一个换行符。

 **本翻译由 AI 自动生成**



---

---
title: "[ARC013B] 引越しできるかな？"
layout: "post"
diff: 普及/提高-
pid: AT_arc013_2
tag: []
---

# [ARC013B] 引越しできるかな？

## 题目描述

### 题意

给出 $C$ 个长方体的长、宽、高。

求一个最小体积的纸箱可以放入每一个长方体。

## 输入格式

第一行一个整数 $C$ 表示有 $C$ 个长方体。

接下来 $C$ 行每行三个整数 $N_i, M_i, L_i$ 表示每个长方体的长、宽、高。

$1 \le C \le 100$

$1 \le N_i,M_i,L_i \le 100$

## 输出格式

一个整数表示最小纸箱的体积。



---

---
title: "[ARC014B] あの日したしりとりの結果を僕達はまだ知らない。"
layout: "post"
diff: 普及/提高-
pid: AT_arc014_2
tag: []
---

# [ARC014B] あの日したしりとりの結果を僕達はまだ知らない。

## 题目描述

高桥君会分身之术。

今天高桥君想做个单词接龙，但是不巧附近没有朋友，所以决定分身出一个自己来陪自己完。

为了方便起见，高桥君将原本就存在的高桥君称为高桥君。

那么，高桥君和高桥分身君充分享受了单词接龙的乐趣，可悲的是，因为他们不知道单词接龙的规则，所以无法分出胜负。

可是这样的事怎么能忍?

于是高桥君们决定录下自己的发言以得到说过的单词的清单。

单词接龙的规则极其简单。只是遵循以下条件说单词:

1.当前词的开头字母是上一个词的结尾字母。(第一个单词不限)

2.不能使用曾经使用过的单词。

先违反这个规则的一方就输了,所以请你帮高桥君们来判定比赛的胜负。

## 输入格式

>第一排一个N,表示回合数
>
>接下来N行表示双方说的单词
>
>第一个单词是高桥君说的,第二个单词是分身说的,依此类推

## 输出格式

>高桥君先违反规则就输出LOSE
>
>分身先违反规则就输出WIN
>
>如果结束时双方都未违反规则就输出DRAW



---

---
title: "[ARC014C] 魂の還る場所"
layout: "post"
diff: 普及/提高-
pid: AT_arc014_3
tag: []
---

# [ARC014C] 魂の還る場所

## 题目描述

[problemUrl]: https://atcoder.jp/contests/arc014/tasks/arc014_3

高橋君が大好きなプラスチック製の円筒と不思議な赤青緑$ 3 $色のボールがある。  
 このボールはぎりぎり円筒に入れることができる大きさである。  
 円筒の両端を便宜上、右と左と呼ぶことにすると、左右好きな方からボールを入れることができる。  
 このボールは同じ色のボールと接触すると消える性質を持っている。  
 さらに、これら $ 3 $ 色の複数個のボールを入れる順番のみが決まっている時、それぞれのボールを左右のどちらから入れるかによって全てのボールを入れ終わった後に残るボールの数が変化する。  
  
 $ 3 $ 色の複数個のボールを入れる順番のみが与えられ、最後に円筒に残るボールの数が最小になるよう計画したとき、円筒に残るボール数の最小値を答えよ。  
 入力は以下の形式で標準入力から与えられる。

> $ N $ $ S $

1. $ 1 $ 行目にはボールの数を表す整数 $ N(1≦N≦50) $ が与えられる。
2. $ 2 $ 行目には入れるボールの順番 $ S $ が与えられ、 $ R $ は赤、 $ G $ は緑、 $ B $ は青色のボールを表す。 $ S $ は $ R,\ G,\ B $ の $ 3 $ 種類の文字のみが $ N $ 文字で構成される。

- $ 1≦N≦15 $ を満たす入力にのみ正解した場合、部分点として $ 30 $ 点が与えられる。
 
 最後に残るボールの数が最小になるように計画を行った時、その残る最小の数を $ 1 $ 行で出力すること。  
 また、出力の最後には改行をいれること。 ```
<pre class="prettyprint linenums">
9
RGBGGBGBR
```

 ```
<pre class="prettyprint linenums">
1
```

- まず $ R $ を入れる。 $ R $
- 次に $ G $ を左から入れる。 $ GR $
- $ B $ を右から入れる。 $ GRB $
- $ G $ を右から入れる。 $ GRBG $
- $ G $ を右から入れる。 $ GRBGG $
- この時 $ G $ が揃うので消える。 $ GRB $

- $ B $ を右から入れる。 $ GRBB $
- この時 $ B $ が揃うので消える。 $ GR $

- $ G $ を左から入れる。 $ GGR $
- この時 $ G $ が揃うので消える。 $ R $

- $ B $ を左から入れる。 $ BR $
- $ R $ を右から入れる。 $ BRR $
- この時 $ R $ が揃うので消える。 $ B $

- よって $ B $ が$ 1 $つ残るので、答えは$ 1 $である。

```
<pre class="prettyprint linenums">
6
RGBRGB
```

 ```
<pre class="prettyprint linenums">
0
```



---

---
title: "[ARC017B] 解像度が低い。"
layout: "post"
diff: 普及/提高-
pid: AT_arc017_2
tag: []
---

# [ARC017B] 解像度が低い。

## 题目描述

[problemUrl]: https://atcoder.jp/contests/arc017/tasks/arc017_2

大変なことになってしまった！！

なんと、我が社の次の決算報告会の発表者に僕が選ばれてしまったのだ！我が社のイメージのためにも、そして社内での僕の地位のためにも、なんとしても好印象を与える発表をせねばならない。

我が社の直近の業績は $ N $ 個の数からなる数列で表される。これを発表したいところだけれど……、あいにく、我が社の業績はそこまで良いとは言えないのが実情だ。一体どうすればいいんだろうか……。

途方に暮れた僕は、とりあえず発表会場の設備を調査した。なんと、これが僕の生まれ持った強運か、プロジェクターの解像度がとても低く、画面には一度に $ K $ 個の数を表示するのが限界であることがわかった。業績の数列のうちの連続する $ K $ 個をうまく選べれば、我が社の業績がうなぎのぼりであるように見せかけられるのではないだろうか？

これは最高のアイデアだと思ったが、聴衆から「それって業績の一部ですよね？他の部分も見せて頂けませんか？」と言われたらジ・エンドだ。そこで用意周到な僕は、業績の数列のうち、プロジェクターで映したときに業績が常に上昇しているように見せられるような箇所がいくつあるのか、事前に調べておくことにした。

常に成長を続ける企業であるとアピールするためには、ある値はその前の値より真に大きくなくてはいけない。つまり $ 100,\ 200,\ 300 $ という列は常に上昇していると考えるが、 $ 100,\ 200,\ 200 $ という列は常に上昇しているとは考えない。

※この問題文はフィクションです。業績はきちんと発表しましょう。

入力は以下の形式で標準入力から与えられる。

> $ N $ $ K $ $ A_1 $ $ A_2 $ : $ A_N $

- $ 1 $ 行目には、業績を表す数列の要素数 $ N\ (1\ \leq\ N\ \leq\ 300,000) $、プロジェクターで一度に表示できる数の個数 $ K\ (1\ \leq\ K\ \leq\ N) $ が半角空白区切りで与えられる。
- $ 2 $ 行目から $ N $ 行では、業績を表す数列が与えられる。このうち $ i $ 行目が $ i $ 番目の業績を表す整数 $ A_i\ (1\ \leq\ A_i\ \leq\ 300,000) $ である。

**注意:** この問題では最大で $ 300,000 $ 行ほどの入力を読み込む必要がある。ほとんどの言語では問題ないが、**Python 2.x で `input()` を使うと時間制限に間に合わないおそれがあるので、かわりに整数を読み込む際には `int(raw_input())` を使うこと。**

 業績を表す数列のうち、プロジェクターで画面に映せるような $ K $ 個の連続した部分で、その部分だけ見ると業績が常に上昇しているように見えるものの個数を標準出力に１行で出力せよ。 ```
<pre class="prettyprint linenums">
10 4
100
300
600
700
800
400
500
800
900
900
```

 ```
<pre class="prettyprint linenums">
3
```

 業績を表す $ 10 $ 個の数列から、連続する $ 4 $ 個を抜き出してみると、 - $ (100,\,\ 300,\,\ 600,\,\ 700) $ は常に上昇しているように見える
- $ (300,\,\ 600,\,\ 700,\,\ 800) $ は常に上昇しているように見える
- $ (600,\,\ 700,\,\ 800,\,\ 400) $ は常に上昇しているように見えない
- $ (700,\,\ 800,\,\ 400,\,\ 500) $ は常に上昇しているように見えない
- $ (800,\,\ 400,\,\ 500,\,\ 800) $ は常に上昇しているように見えない
- $ (400,\,\ 500,\,\ 800,\,\ 900) $ は常に上昇しているように見える
- $ (500,\,\ 800,\,\ 900,\,\ 900) $ は常に上昇しているように見えない
 
 となるので、答えは $ 3 $ であることがわかる。 ```
<pre class="prettyprint linenums">
10 3
10
40
50
80
90
30
20
40
90
95
```

 ```
<pre class="prettyprint linenums">
5
```

 この場合、常に上昇しているように見える箇所は以下の画像に矢印で示された 5 箇所となる。  
 ![](https://cdn.luogu.com.cn/upload/vjudge_pic/AT_arc017_2/fb99d046b6e768145edbb7e1ae5398f78b193ad8.png)

 ```
<pre class="prettyprint linenums">
8 4
1
2
3
4
5
6
7
8
```

 ```
<pre class="prettyprint linenums">
5
```

 元々の業績が常に上昇しているので、どこをプロジェクターに映しても大丈夫である。 ```
<pre class="prettyprint linenums">
8 2
100000
90000
50000
30000
10000
4000
200
1
```

 ```
<pre class="prettyprint linenums">
0
```

 元々の業績があまりに良くない場合、どこを映しても業績を右肩上がりに見せかけられないことがある。



---

---
title: "[ARC018B] 格子点と整数"
layout: "post"
diff: 普及/提高-
pid: AT_arc018_2
tag: []
---

# [ARC018B] 格子点と整数

## 题目描述

[problemUrl]: https://atcoder.jp/contests/arc018/tasks/arc018_2

諸君、私は整数が好きだ。  
 私は格子点が好きだ。  
 私は面積が好きだ。  
 私は三角形が好きだ。  
 私は座標平面上の、頂点が全て格子点上にある、面積が整数の三角形が大好きだ。  
 格子点の集合をみたとき、その中の任意の $ 3 $ 点を選んで作ることができる面積が整数の三角形の個数を数えるときは心が踊る。  
 心が踊るが、格子点が多いと数えるのが面倒臭い。  
 ぜひ有能なプログラマーである諸君に私の代わりに数えてほしい。  
 $ N $ 個の格子点を与えるので、その中の任意の $ 3 $ 点を選んで作ることができる、面積が整数の三角形の個数を数えるプログラムを作って欲しい。面積が $ 0 $ の三角形は三角形とは認めん！  
 ちなみに、格子点というのは座標平面上の点 $ (x,y) $ のうち $ x $ も $ y $ も整数である点のことである。

入力は以下の形式で標準入力から与えられる。

> $ N $ $ x_1 $ $ y_1 $ $ x_2 $ $ y_2 $ : $ x_N $ $ y_N $

- $ 1 $ 行目には、格子点の個数を表す整数 $ N\ (3\ ≦\ N\ ≦\ 100) $ が与えられる。
- $ 2 $ 行目から $ N $ 行では、2つの整数が空白区切りで与えられる。 $ (x_i,\ y_i)　(1\ ≦\ x_i,\ y_i\ ≦\ 10^9) $ は $ i $ 番目の格子点の位置である。同じ格子点が二度与えられることはない。( $ i\ \neq\ j $ ならば $ (x_i,\ y_i)\ \neq\ (x_j,\ y_j) $ )
 
 $ N $ 個の格子点のうち $ 3 $ つを選んで作ることができる面積が正の整数である三角形の個数を一行で出力せよ。  
 なお、出力の最後には改行を入れること。 ```
<pre class="prettyprint linenums">
3
1 1
1 2
3 1
```

 ```
<pre class="prettyprint linenums">
1
```

 $ (1,1),\ (1,\ 2),\ (3,\ 1) $ の面積が $ 1 $ の三角形が一つだけ作れる。 ```
<pre class="prettyprint linenums">
3
1 1
1 2
2 1
```

 ```
<pre class="prettyprint linenums">
0
```

 三角形 $ (1,\ 1)\ (1,\ 2)\ (2,\ 1) $ の面積は $ 0.5 $ で整数ではない。これ以外に三角形は作ることができない。 ```
<pre class="prettyprint linenums">
3
1 1
2 2
3 3
```

 ```
<pre class="prettyprint linenums">
0
```

 $ 3 $ 点は一直線上に並ぶので、三角形を作ることができない。 ```
<pre class="prettyprint linenums">
8
3 1
4 1
5 9
2 6
5 3
5 8
9 7
9 3
```

 ```
<pre class="prettyprint linenums">
38
```



---

---
title: "[ARC019B] こだわりの名前"
layout: "post"
diff: 普及/提高-
pid: AT_arc019_2
tag: []
---

# [ARC019B] こだわりの名前

## 题目描述

给定一个字符串 $A$（仅包含大写字母），求出 $A$ 修改一个字符后**不是**回文串的情况有多少种。

## 输入格式

一个字符串，表示给定的字符串 $A$。

## 输出格式

一个数，表示 $A$ 修改一个字符后**不是**回文串的情况有多少种。

## 说明/提示

$1 \le |A| \le 3 \times 10^5$。

样例解释：
- 样例 1：如果修改第一个字符，那么有 $24$ 种改法（除了字符串是`CRC`的情况其他全部）；如果修改第二个字符，有 $25$ 种改法；如果修改第三个字符，有 $24$ 种改法（除了字符串是`ARA`的情况其他全部），总共有 $24 + 25 + 24 = 73$ 种。
- 样例 2：只有 $1$ 个字符，无论怎么改都是回文串。

## 样例 #1

### 输入

```
ARC
```

### 输出

```
73
```

## 样例 #2

### 输入

```
S
```

### 输出

```
0
```

## 样例 #3

### 输入

```
NOLEMONNOMELON
```

### 输出

```
350
```



---

---
title: "[ARC020B] 縞模様"
layout: "post"
diff: 普及/提高-
pid: AT_arc020_2
tag: []
---

# [ARC020B] 縞模様

## 题目描述

小学生的高桥喜欢条纹图案。现在，Takahashi正在寻找从左到右直线排列的n*n的彩色绘图纸。由于Takahashi非常喜欢条纹图案，所以我想通过用一种带涂料的新颜色重新绘制一些绘图纸来使它看起来像条纹一样。

作为条纹的整体观察意味着整体中使用的颜色仅为2 2并且其旁边的绘图纸的颜色与其旁边的绘图纸的颜色不同。

你的工作是给已经放置的建筑纸的数量nn和油漆的成本cc用另一种颜色替换一张绘图纸所以实现条纹的最低成本它是创建一个输出值的程序。就此而言，为方便起见，每种颜色为1~10这10个数字。可用于重新涂漆的涂料颜色也只有1~10这10种。

## 输入格式

```cpp

$ n　c $

a1 a_1 a1​

a2 a_2 a2​

:

an a_n an​

```

- 在第一行，数字n（2≤ n ≤ 100）n（2≤n≤100）表示绘图纸的数量和重绘一张建筑纸所需的油漆成本c （1 ≤ c ≤ 1000）给出c（1≤c≤1000）。

- 在第2行到第nn行中，分别给出了已经排列的绘图纸的颜色。 在这些i i行中，整数a_i （1 ≤ a _ i ≤ 10）表示在直线a上对齐的绘图纸左边的第i种颜色

## 输出格式

输出在第1行中实现条纹图案所需的总成本的最小值,并 在结尾输出一个回车。

## 样例 #1

### 输入

```
3 10

3

2

1
```

### 输出

```
10
```

## 样例 #2

### 输入

```
4 100

1

1

1

1
```

### 输出

```
200
```

## 样例 #3

### 输入

```
10 1000

1

2

3

4

5

6

7

8

9

10
```

### 输出

```
8000
```



---

---
title: "[ARC023B] 謎の人物X"
layout: "post"
diff: 普及/提高-
pid: AT_arc023_2
tag: []
---

# [ARC023B] 謎の人物X

## 题目描述

[problemUrl]: https://atcoder.jp/contests/arc023/tasks/arc023_2

高橋君は謎の人物Xに連れ去られてしまい、謎の施設に閉じ込められてしまいました。この施設の床には $ R $ 行 $ C $ 列 のマス目が書かれていて、それぞれのマスには $ 1 $ つずつ数字が書かれています。高橋君はこのマス目の $ 1 $ 行目の $ 1 $ 列目のマスにいます。

長い時間閉じ込められていたので、高橋君はお腹が減ってきました。謎の人物Xによると、「隣のマスに移動する」ということをちょうど $ D $ 回行った後に高橋君がいるマスに書いてある数字と同じ値段のたこ焼きを用意してくれるそうです。あるマスの「隣のマス」とは、そのマスと辺を共有するマスのことを指します。高橋君は出来るだけ値段の高いたこ焼きが食べたいと思ったので、最大でいくらのたこ焼きを食べることが出来るかを考えることにしました。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ R $ $ C $ $ D $ $ A_{1,1} $ $ A_{1,2} $ ... $ A_{1,C} $ $ A_{2,1} $ $ A_{2,2} $ ... $ A_{2,C} $ : $ A_{R,1} $ $ A_{R,2} $ ... $ A_{R,C} $

- $ 1 $ 行目には、マス目の行数を表した整数 $ R\ (2\ ≦\ R\ ≦\ 1,000) $ と、マス目の列数を表した整数 $ C\ (2\ ≦\ C\ ≦\ 1,000) $ と、高橋君が移動しなければならない回数を表した整数 $ D\ (1\ ≦\ D\ ≦\ 2,000) $ が空白区切りで与えられる。
- 続く $ R $ 行には、マス目に書かれている数字の情報が与えられる。このうちの $ i $ 番目の行には $ C $ 個の整数が空白区切りで与えられる。このうち $ j $ 番目の整数 $ A_{i,j}\ (1\ ≦\ A_{i,j}\ ≦\ 999) $ は、$ i $ 行目の $ j $ 列目のマスに書かれている数字が $ A_{i,j} $ であることを表す。

## 输出格式

高橋君が食べることができるたこ焼きの値段の最大値を $ 1 $ 行に出力せよ。出力の末尾に改行をいれること。

## 说明/提示

### 部分点

この問題には部分点が設定されている。

- $ R\ ≦\ 100 $ かつ $ C\ ≦\ 100 $ かつ $ D\ ≦\ 200 $ を満たすテストケースすべてに正解した場合は $ 60 $ 点が与えられる。

### Sample Explanation 1

ちょうど $ 1 $ 回移動することで行くことが出来るマスは、$ 1 $ 行目の $ 2 $ 列目のマスか $ 2 $ 行目の $ 1 $ 列目のマスだけです。このケースでは、高橋君は最大で $ 5 $ 円のたこ焼きを食べることが出来ます。

### Sample Explanation 2

このケースでは、高橋君はどのように移動しても $ 999 $ 円のたこ焼きを食べることが出来ます。

### Sample Explanation 3

このケースでは、高橋君はどのように移動しても $ 198 $ 円のたこ焼きしか食べることが出来ません。

## 样例 #1

### 输入

```
3 2 1

9 5

3 1

8 9
```

### 输出

```
5
```

## 样例 #2

### 输入

```
4 4 100

999 999 999 999

999 999 999 999

999 999 999 999

999 999 999 999
```

### 输出

```
999
```

## 样例 #3

### 输入

```
3 4 5

700 198 700 198

198 700 198 700

700 198 700 198
```

### 输出

```
198
```



---

---
title: "[ARC030B] ツリーグラフ"
layout: "post"
diff: 普及/提高-
pid: AT_arc030_2
tag: []
---

# [ARC030B] ツリーグラフ

## 题目描述

### 题目大意

给定一棵 $n$ 无权树，树上每个结点有 $0$ 或 $1$ 个宝石，求从结点 $x$ 出发拿到所有宝石再回到 $x$ 的最短路径。

## 输入格式

第一行输入两个整数 $n\ (1\le n\le 100)$ 和 $x\ (1\le x\le n)$，表示有 $n$ 个节点，起点为 $x$。

第二行输入 $n$ 个整数 $h_i\ (0\le h_i\le1)$，表示节点 $i$ 上有 $h_i$ 个宝石。

第三行至第 $n$ 行，每行输入两个整数 $u_i$ 和 $v_i$，表示连接节点 $u_i$ 和 $v_i$ 之间的一条边。

## 输出格式

一行一个整数表示最短路径的长度。

## 样例 #1

### 输入

```
5 1

1 0 1 0 1

1 2

2 3

2 4

1 5
```

### 输出

```
6
```

## 样例 #2

### 输入

```
3 2

0 1 0

1 2

2 3
```

### 输出

```
0
```



---

---
title: "[ARC031B] 埋め立て"
layout: "post"
diff: 普及/提高-
pid: AT_arc031_2
tag: []
---

# [ARC031B] 埋め立て

## 题目描述

很久很久以前，某地曾有一个岛国。这个岛国由一些岛屿组成。现在，这个岛国决定填海造陆，但还没有决定填海造陆的位置。政府希望填海造陆工程能够将所有岛屿连接起来，成为一个岛屿。



给出 $10$ 格 $×10$ 格的该国地图，请判断：能否仅将一格海洋变成陆地，使该国所有岛屿连接成一个岛屿。另外，地图中表示陆地的格子上下左右互相连接的区域称为一个岛屿。

## 输入格式

输入按以下形式：

$$ A_{1,1} \space A_{1,2} \space \dots \space A_{1,10} $$

$$ A_{2,1} \space A_{2,2} \space \dots \space A_{2,10} $$

$$ : $$

$$ A_{10,1} \space A_{10,2} \space \dots \space A_{10,10} $$ 



- 岛国的地图一定为 $10$ 行。

- 每行一定由 $10$ 个字符组成，每个字符为 'o'（表示陆地）或 'x'（表示海洋）

- 保证至少有一格为陆地。

- 保证至少有一格为海洋。

## 输出格式

如果能将 $1$ 个格子的海洋变成陆地使得整个岛国只含一个岛屿，则输出'YES'，否则输出'NO'。输出结尾请换行。

（如果本来就只有一个岛，也输出'YES'）



## 样例1解释

将红色方框处的格子变成陆地，就能将两个岛屿合并为一个。

![](https://arc031.contest.atcoder.jp/img/arc/031/2-1.png)

## 样例 #1

### 输入

```
xxxxxxxxxx

xoooooooxx

xxoooooxxx

xxxoooxxxx

xxxxoxxxxx

xxxxxxxxxx

xxxxoxxxxx

xxxoooxxxx

xxoooooxxx

xxxxxxxxxx
```

### 输出

```
YES
```

## 样例 #2

### 输入

```
xxxxxxxxxx

xoooooooxx

xxoooooxxx

xxxoooxxxx

xxxxxxxxxx

xxxxxxxxxx

xxxxxxxxxx

xxxoooxxxx

xxoooooxxx

xxxxxxxxxx
```

### 输出

```
NO
```

## 样例 #3

### 输入

```
xxxxoxxxxx

xxxxoxxxxx

xxxxoxxxxx

xxxxoxxxxx

ooooxooooo

xxxxoxxxxx

xxxxoxxxxx

xxxxoxxxxx

xxxxoxxxxx

xxxxoxxxxx
```

### 输出

```
YES
```



---

---
title: "[ARC032B] 道路工事"
layout: "post"
diff: 普及/提高-
pid: AT_arc032_2
tag: []
---

# [ARC032B] 道路工事

## 题目描述

[problemUrl]: https://atcoder.jp/contests/arc032/tasks/arc032_2

大工のチョーさん(Daiku Cho)の町では道路の建設が進んでいます。チョーさんの町には $ N $ 個の交差点と $ M $ 個の道路があり、道路は異なる2つの交差点を双方向に結んでいます。 不便なことに、ある交差点から別の交差点まで道路を使って行き来できるとは限りません。

チョーさんの建設会社は、異なる交差点を結ぶいくつかの道路を作って、$ N $ 個のどの交差点からも道路を使って他のどの交差点へも行けるようにしたいと思っています。

どの交差点からも道路を使って別のどの交差点にも行けるようにするには最小で何本の道路を建設する必要があるかを答えてください。ただし、すでにある道路でどの交差点からも別のどの交差点へ行けるとき、$ 0 $ を出力してください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ M $ $ a_1 $ $ b_1 $ $ a_2 $ $ b_2 $ : $ a_M $ $ b_M $

- $ 1 $ 行目には、チョーさんの町の交差点の数と、既にある道路の数を表す $ 2 $ つの整数 $ N\ (1\ ≦\ N\ ≦\ 100,000) $ と $ M\ (0\ ≦\ M\ ≦\ 100,000) $ がスペース区切りで与えられる。
- $ 2 $ 行目から $ M $ 行には、既にある道路の情報が与えられる。そのうち $ i $ 行目には、$ i $ 番目の道路がつなぐ $ 2 $ つの交差点を表す $ 2 $ つの整数 $ a_i,\ b_i\ (1\ ≦\ a_i\ がスペース区切りで与えられる。 $
- 同じ交差点をつなぐ道路が与えられることはない。すなわち、$ i,j\ (1≦i,j≦M) $ に対し、$ i≠j $ ならば $ a_i≠a_j $ または $ b_i≠b_j $ が成り立つ。

## 输出格式

新たに建設する道路の最小の本数を1行目に出力せよ。

末尾の改行を忘れないこと。

## 说明/提示

### Sample Explanation 1

交差点 $ 1 $、$ 2 $、$ 3 $ は互いに道路でつながっているが、交差点 $ 4 $ はつながっていない。例えば、交差点 $ 1 $ と $ 4 $ を結ぶ道路を作れば十分である。 !\[\](http://arc032.contest.atcoder.jp/img/arc/032/B1.png)

## 样例 #1

### 输入

```
4 2

1 2

1 3
```

### 输出

```
1
```

## 样例 #2

### 输入

```
6 4

1 2

2 3

1 3

5 6
```

### 输出

```
2
```



---

---
title: "[ARC033B] メタ構文変数"
layout: "post"
diff: 普及/提高-
pid: AT_arc033_2
tag: []
---

# [ARC033B] メタ構文変数

## 题目描述

[problemUrl]: https://atcoder.jp/contests/arc033/tasks/arc033_2

「$ foo $」や「$ bar $」「$ hoge $」などの、特に意味を持たない変数の名前に使用される文字列のことを「メタ構文変数」と呼びます。

高橋君は今、メタ構文変数について調べています。メタ構文変数には色々な種類があることが分かり、見つけたメタ構文変数にそれぞれに番号をつけました。高橋君はアリの $ Ant $ さんと $ Bug $ くんのソースコードを読み、それぞれのソースコードに現れるメタ構文変数の番号を列挙しました。そして、$ Ant $ さんと $ Bug $ くんの使うメタ構文変数の集合がどれくらい似ているのかを調べるために「$ Jaccard $ 係数」を計算することにしました。$ Ant $ さんのソースコードに現れるメタ構文変数の集合を $ S_A $、$ Bug $ くんのソースコードに現れるメタ構文変数の集合を $ S_B $ とするとこれらの集合の $ Jaccard $ 係数は、

- $ ||S_{A}\ ∩\ S_{B}||\ /\ ||S_{A}\ ∪\ S_{B}|| $

という式で計算できます。ここで、$ ||S|| $ は集合 $ S $ の要素数を表すものとします。別の言い方をすると、

- 「$ S_{A} $ と $ S_{B} $ の両方に現れる要素の個数」$ / $「$ S_{A} $ と $ S_{B} $ の少なくともどちらか一方には現れる要素の個数」

となります。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N_A $ $ N_B $ $ A_1 $ $ A_2 $ ... $ A_{N_A} $ $ B_1 $ $ B_2 $ ... $ B_{N_B} $

- $ 1 $ 行目には、$ 2 $ つの整数 $ N_A\ (1\ ≦\ N_A\ ≦\ 10^5),\ N_B\ (1\ ≦\ N_B\ ≦\ 10^5) $ が空白区切りで与えられる。これは、$ Ant $ さんのソースコードに $ N_A $ 個、$ Bug $ くんのソースコードに $ N_B $ 個のメタ構文変数が現れたということを表す。
- $ 2 $ 行目には、$ Ant $ さんのソースコードに現れたメタ構文変数の番号を表す $ N_A $ 個の整数が空白区切りで与えられる。このうち $ i $ 番目の整数 $ A_i\ (1\ ≦\ A_i\ ≦\ 10^9) $ は、$ Ant $ さんのソースコードに $ A_i $ 番のメタ構文変数が現れることを表す。ただし、$ p\ \neq\ q $ のとき $ A_p\ \neq\ A_q $ であることが保証される。
- $ 3 $ 行目には、$ Bug $ くんのソースコードに現れたメタ構文変数の番号を表す $ N_B $ 個の整数が空白区切りで与えられる。このうち $ i $ 番目の整数 $ B_i\ (1\ ≦\ B_i\ ≦\ 10^9) $ は、$ Bug $ さんのソースコードに $ B_i $ 番のメタ構文変数が現れることを表す。ただし、$ p\ \neq\ q $ のとき $ B_p\ \neq\ B_q $ であることが保証される。

## 输出格式

$ Ant $ さんと $ Bug $ くんのソースコードに現れるメタ構文変数の集合の $ Jaccard $ 係数を $ 1 $ 行に出力せよ。小数点以下何桁でも出力してよいが、$ 10^{-6} $ を超える絶対誤差を含んではならない。出力の末尾に改行を入れること。

## 说明/提示

### 部分点

この問題には部分点が設定されている。

- $ N_A,N_B\ ≦\ 1000 $ と $ A_i,B_i\ ≦\ 10^5 $ を満たすテストケース全てに正解した場合は、$ 40 $ 点が与えられる。
- $ A_i,B_i\ ≦\ 10^5 $ を満たすテストケース全てに正解した場合は、$ 70 $ 点が与えられる。

### Sample Explanation 1

$ Ant $ さんと $ Bug $ くんのソースコードの両方に現れるメタ構文変数は $ 1 $ 番のみで、$ Ant $ さんと $ Bug $ くんのソースコードの少なくともどちらか一方には現れるメタ構文変数は $ 1,2,3,5 $ 番の $ 4 $ つです。 よって、$ Jaccard $ 係数は $ 1/4 $ となります。

## 样例 #1

### 输入

```
3 2

1 3 5

1 2
```

### 输出

```
0.2500000000
```

## 样例 #2

### 输入

```
9 10

11 2 33 4 55 6 77 8 99

10 11 14 19 55 1000000000 4 5 7 8
```

### 输出

```
0.2666666667
```



---

---
title: "[ARC035B] アットコーダー王国のコンテスト事情"
layout: "post"
diff: 普及/提高-
pid: AT_arc035_b
tag: []
---

# [ARC035B] アットコーダー王国のコンテスト事情

## 题目描述

[problemUrl]: https://atcoder.jp/contests/arc035/tasks/arc035_b

高橋くん様は、アットコーダー王国の王様です。

プログラミングコンテスト好きな彼が統治するアットコーダー王国では、年に一度コンテストが開催されます。

このコンテストでは $ N $ 問の問題が出題されます。また、順位を付ける際の $ 1 $ つの要素としてペナルティというものが存在します。 ある問題を正解したとき、コンテスト開始から経過した時間分だけのペナルティが、各問題ごとに発生します。そして、その発生したペナルティの総和がコンテストペナルティとなります。ARCのペナルティとは異なるルールであることに注意してください。

非常に優秀な国民である貴方には、全ての問題を解く力があります。 しかも、全ての問題について、その問題を正解するためにどれだけ時間をかければよいのかを知っており、ちょうどその時間取り組むと必ず正解することができます。

貴方は、自由な順番で問題を解くことができるので、コンテストペナルティが最小となるように解こうと思いました。

全ての問題を解くときのコンテストペナルティの最小値と、そのような解き方が何通りあるかを $ 1,000,000,007(10^9+7) $ で割った余りを答えて下さい。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ T_1 $ $ T_2 $ : $ T_N $

- $ 1 $ 行目には、コンテストでの問題数を表す整数 $ N\ (1\ ≦\ N\ ≦\ 10,000) $ がスペース区切りで与えられる。
- $ 2 $ 行目からの $ N $ 行には、各問題を解くのにかかる時間の情報が与えられる。そのうち $ i\ (1≦i≦N) $ 行目には、整数 $ T_i\ (1≦T_i≦10,000) $ が書かれており、$ i $ 番目の問題を解くのに $ T_i $ 分かかることを示す。

## 输出格式

出力は以下の形式で標準出力に出力せよ。

- $ 1 $ 行目には、コンテストペナルティの最小値を出力せよ。32bit整数型ではオーバーフローする可能性があることに気をつけること。
- $ 2 $ 行目には、コンテストペナルティが最小となるような解き方の数を $ 1,000,000,007(10^9+7) $ で割った余りを出力せよ。

## 说明/提示

### 部分点

この問題には部分点が存在する。

- $ 100 $ 点中 $ 50 $ 点分のテストケースにおいて、コンテストペナルティが最小となるような解き方の数は $ 1 $ 通りである。

### Sample Explanation 1

$ 2 $ 番目の問題を解いてから $ 1 $ 番目の問題を解くのがよい。 - コンテストが開始する(時刻：$ 0 $ 分)。 - $ 10 $ 分後、$ 2 $ 番目の問題に正解する(時刻：$ 10 $ 分)。この時点で発生するペナルティは $ 10 $ 分である。 - その $ 20 $ 分後、$ 1 $ 番目の問題に正解する(時刻： $ 30 $ 分)。この時点で発生するペナルティは $ 30 $ 分である。 コンテストペナルティは $ 40(=10+30) $ 分となる。

### Sample Explanation 3

どのような順番で解いても良い。余りを取るのを忘れないこと。

## 样例 #1

### 输入

```
2

20

10
```

### 输出

```
40

1
```

## 样例 #2

### 输入

```
5

2

1

2

1

2
```

### 输出

```
21

12
```

## 样例 #3

### 输入

```
13

1

1

1

1

1

1

1

1

1

1

1

1

1
```

### 输出

```
91

227020758
```



---

---
title: "[ARC036B] 山のデータ"
layout: "post"
diff: 普及/提高-
pid: AT_arc036_b
tag: []
---

# [ARC036B] 山のデータ

## 题目描述

现在，有 $N$ 个地点。从西起第 $i(1 \le i \le N)$ 个地点的高度为 $h_i$。

这样，就有了一个三元组 $(s，t，u)$，$(1 \le s \le t \le u \le N)$。

那么，这一个三元组是山，当且仅当：

对于满足 $s \le i \le t-1$ 的任意整数中的 $i$，满足 $h_i < h_{i+1}$ 且在对于满足 $t \le i \le u-1$ 的任意整数中的 $i$，满足 $h_i > h_{i+1}$。

现在，需要找出山的**最大**长度。（定义山的长度为 $u - s + 1$）。

## 输入格式

第一行，一个整数 $N$。

第二行到第 $N + 1$ 行，每行一个整数 $h_i$。表示第 $i$ 个地点的高度。

## 输出格式

一个整数，表示山的**最大**长度。（定义山的长度为 $u - s + 1$）。

## 说明/提示

$1 \le N \le 3 \times 10^5, 1 \le h_i \le 10^9$。

每一个 $h_i$ 互不相同（即对于 $1 \le i < j \le N$，$h_i \ne h_j$）。

## 样例 #1

### 输入

```
6

4

5

1

6

9

7
```

### 输出

```
4
```

## 样例 #2

### 输入

```
7

90

70

50

30

20

10

5
```

### 输出

```
7
```



---

---
title: "[ARC037B] バウムテスト"
layout: "post"
diff: 普及/提高-
pid: AT_arc037_b
tag: []
---

# [ARC037B] バウムテスト

## 题目描述

给出由 $N$ 个顶点和 $M$ 条边构成的无向图表。求出该图表中的像树一样的部分，即不具有闭路的部分的个数。

## 输入格式

第 $1$ 行表示无向图表中包含的顶点数 $N$ 和边的数量 $M$。

接下来的第 $2$ 行到第 $M+1$ 行，第 $i$ 行输入连接两个顶点的编号 $u_i$ 与 $v_i$。

## 输出格式

一行，输出无向图表的树的个数。

## 说明/提示

($ 2 $ $ ≦ $ $ N $ $ ≦ $ $ 100 $) 

($ 1 $ $ ≦ $ $ M $ $ ≦ $ $ N×(N-1)/2 $)

($ 1 $ $ ≦ $ $ i $ $ ≦ $ $ M $)

($ 1 $ $ ≦ $ $ u_i $ $ ＜ $ $ v_i $ $ ≦ $ $ N $) 

值得注意的是：对于任何两个顶点，直接连接它们的边最多只有一条。

## 样例 #1

### 输入

```
8 7

1 2

2 3

2 4

5 6

6 7

6 8

7 8
```

### 输出

```
1
```

## 样例 #2

### 输入

```
5 1

1 2
```

### 输出

```
4
```

## 样例 #3

### 输入

```
11 11

1 2

1 3

2 4

3 5

4 6

5 7

6 8

7 9

8 10

9 11

10 11
```

### 输出

```
0
```



---

---
title: "[ARC040B] 直線塗り"
layout: "post"
diff: 普及/提高-
pid: AT_arc040_b
tag: []
---

# [ARC040B] 直線塗り

## 题目描述

[problemUrl]: https://atcoder.jp/contests/arc040/tasks/arc040_b

イカの高橋君は床を塗るのが大好きです。床は $ N $ 個のマスが左右に $ 1 $ 列に並んでいるような形をしています。左から $ i $ 個目のマスをマス $ i $ と呼ぶことにします。すでにいくつかのマスは塗られていますが、いくつかのマスは塗られていません。高橋君はインクを発射できる射程が $ R $ の銃を使って全てのマスを塗ろうとしています。高橋君は最初マス $ 1 $ にいます。そして、$ 1 $ 秒の間に以下のいずれか $ 1 $ つの行動が行えます。

- $ 1 $ つ右のマスに移動する。すなわち、マス $ i $ からマス $ i+1 $ に移動する。ただし、マス $ N $ にいるときは行えない。
- 銃を撃って床を塗る。マス $ i $ にいるときに銃を撃つと、マス $ i $ からマス $ i+R-1 $ までのマスを全て塗ることができる。ただし、$ i+R-1 $ が $ N $ より大きい場合は、マス $ i $ からマス $ N $ までのマスが塗られる。

高橋君が全てのマスを塗るためにかかる時間の最小値を求めてください。

## 输入格式

入力はイカの形式で標準入力から与えられる。

> $ N $ $ R $ $ S $

- $ 1 $ 行目には、マス目の個数を表す整数 $ N\ (1\ ≦\ N\ ≦\ 100) $ と銃の射程を表す整数 $ R\ (1\ ≦\ R\ ≦\ N) $ が空白区切りで与えられる。
- $ 2 $ 行目には、長さ $ N $ の文字列 $ S $ が与えられる。このうち $ i\ (1\ ≦\ i\ ≦\ N) $ 文字目は、マス $ i $ の情報を以下のように表す。 
  - `.` の場合：このマスがまだ塗られていないことを表す。
  - `o` の場合：このマスがすでに塗られていることを表す。

## 输出格式

高橋君が全てのマスを塗るためにかかる時間の最小値を $ 1 $ 行に出力せよ。出力の末尾に改行を入れること。

## 说明/提示

### Sample Explanation 1

銃を撃つ → $ 4 $ 歩前進 → 銃を撃つ、という行動をとると時間が最小となります。

### Sample Explanation 2

銃を撃つ → $ 1 $ 歩前進 → 銃を撃つ、という行動をとると時間が最小となります。

### Sample Explanation 3

最初から全てのマスが塗られています。

## 样例 #1

### 输入

```
7 3

...o.o.
```

### 输出

```
6
```

## 样例 #2

### 输入

```
8 4

...o.ooo
```

### 输出

```
3
```

## 样例 #3

### 输入

```
4 4

oooo
```

### 输出

```
0
```



---

---
title: "[ARC040C] Z塗り"
layout: "post"
diff: 普及/提高-
pid: AT_arc040_c
tag: []
---

# [ARC040C] Z塗り

## 题目描述

[problemUrl]: https://atcoder.jp/contests/arc040/tasks/arc040_c

イカの高橋君は床を塗るのが大好きです。床は $ N\ \times\ N $ のマス目状に区切られており、すでにいくつかのマスは塗られています。$ i $ 行目 $ j $ 列目のマスをマス $ (i,j) $ と呼ぶことにします。高橋君は特殊なインク発射装置を用いて床を塗ろうとしています。この装置を使うと、以下のように床を塗ることができます。

- 任意の整数 $ r,\ c $ を入力して装置のボタンを押すと、「$ i\ =\ r $ かつ $ j\ ≦\ c $」または「$ i\ =\ r+1 $ かつ $ j\ ≧\ c $」を満たすようなすべてのマス $ (i,j) $ を塗ることができる。

高橋君は、全てのマスをこの装置で塗ろうと思っています。このとき、装置を使う必要のある回数の最小値を求めてください。

## 输入格式

入力はイカの形式で標準入力から与えられる。

> $ N $ $ S_1 $ $ S_2 $ : $ S_N $

- $ 1 $ 行目には、マス目の $ 1 $ 辺の個数を表す整数 $ N\ (1\ ≦\ N\ ≦\ 100) $ が与えられる。
- $ 2 $ 行目からの $ N $ 行には、マス目の情報が与えられる。このうち $ i\ (1\ ≦\ i\ ≦\ N) $ 行目には、長さ $ N $ の文字列 $ S_i $ が与えられる。このうち $ j\ (1\ ≦\ j\ ≦\ N) $ 文字目は、マス $ (i,j) $ の情報を以下のように表す。 
  - `.` の場合：このマスがまだ塗られていないことを表す。
  - `o` の場合：このマスがすでに塗られていることを表す。

## 输出格式

装置を使う回数の最小値を $ 1 $ 行に出力せよ。出力の末尾に改行を入れること。

## 说明/提示

### Sample Explanation 1

インク発射装置はこの入力のような形を綺麗に塗ることができます。

### Sample Explanation 3

はじめから全て塗られていることもあります。

## 样例 #1

### 输入

```
7

...oooo

oo.....

ooooooo

ooooooo

.....oo

oooo...

ooooooo
```

### 输出

```
2
```

## 样例 #2

### 输入

```
4

.oo.

..oo

o..o

oo..
```

### 输出

```
3
```

## 样例 #3

### 输入

```
1

o
```

### 输出

```
0
```



---

---
title: "[ARC041B] アメーバ"
layout: "post"
diff: 普及/提高-
pid: AT_arc041_b
tag: []
---

# [ARC041B] アメーバ

## 题目描述

[problemUrl]: https://atcoder.jp/contests/arc041/tasks/arc041_b

縦 $ N $ マス、横 $ M $ マスの盤面がある。 上から $ i $ ($ 1≦i≦N $) マス目、左から $ j $ ($ 1≦j≦M $) マス目の位置を $ (i,j) $ と表す。

はじめ、マス $ (i,j) $ には $ a_{ij} $ 匹のアメーバがいた。 ただし、盤面の端にアメーバはいなかった。 すなわち、$ i=1,N $ または $ j=1,M $ ならば $ a_{ij}=0 $ である。

高橋君が大声を出すと、アメーバたちは驚いてそれぞれ次の行動をとった。

- $ 1 $ 匹のアメーバが $ 4 $ 匹に分裂し、上下左右のマスへ $ 1 $ 匹ずつ移動した。

その結果、マス $ (i,j) $ には $ b_{ij} $ 匹のアメーバがいることになった。

今のアメーバの配置 $ (b_{ij}) $ が与えられるので、はじめのアメーバの配置 $ (a_{ij}) $ を $ 1 $ つ求めよ。 ただし、$ (a_{ij}) $ は少なくとも $ 1 $ つ存在する。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ M $ $ b_{11} $$ b_{12} $$ .. $$ b_{1M} $ $ b_{21} $$ b_{22} $$ .. $$ b_{2M} $ $ : $ $ b_{N1} $$ b_{N2} $$ .. $$ b_{NM} $

- $ 1 $ 行目には、盤面の縦のマス数 $ N $ ($ 3≦N≦500 $) と横のマス数 $ M $ ($ 3≦M≦500 $) が空白区切りで与えられる。
- $ 2 $ 行目からの $ N $ 行には、今のアメーバの配置が与えられる。このうち $ i $ 行目の $ j $ 文字目の数字が $ b_{ij} $ ($ 0≦b_{ij}≦9 $) を表す。

## 输出格式

はじめのアメーバの配置を 1 つ、以下の形式で $ N $ 行に出力せよ。 ただし、$ i $ 行目の $ j $ 文字目の数字が $ a_{ij} $ を表す。 出力の末尾に改行を入れること。

> $ a_{11} $$ a_{12} $$ .. $$ a_{1M} $ $ a_{21} $$ a_{22} $$ .. $$ a_{2M} $ $ : $ $ a_{N1} $$ a_{N2} $$ .. $$ a_{NM} $

## 样例 #1

### 输入

```
3 3

010

101

010
```

### 输出

```
000

010

000
```

## 样例 #2

### 输入

```
3 4

0230

2323

0230
```

### 输出

```
0000

0230

0000
```

## 样例 #3

### 输入

```
5 5

00100

03040

20903

05060

00300
```

### 输出

```
00000

00100

02030

00300

00000
```



---

---
title: "[ARC042B] アリの高橋くん"
layout: "post"
diff: 普及/提高-
pid: AT_arc042_b
tag: []
---

# [ARC042B] アリの高橋くん

## 题目描述

阿里的高桥在凸多边形的木板上。高桥一直朝着对面的方向走，但是不知道朝着哪个方向。高桥君一走到木板周围就掉下来了。因为高桥君的位置和构成板子的凸多边形的顶点的位置被给予，所以请求高桥君从板子上掉下来之前走的最短距离。位置全部以二维坐标给出。

## 输入格式

输入以以下形式由标准输入给出。

> $ x $ $ y $ $ N $ $ x_1 $ $ y_1 $ $ x_2 $ $ y_2 $ : $ x_N $ $ y_N $

- 第1行是表示以空格分隔的高桥所在位置坐标的整数 $ x,\ y\ (-100\ ≦\ x\ ≦\ 100,\ -100\ ≦\ y\ ≦\ 100) $
- 第二行给出表示构成板的凸多边形的顶点数的整数$N$。 $ \ (3\ ≦\ N\ ≦\ 10) $
- 第$N$行是表示板顶点坐标的整数 $ x_i\ y_i\ (-100\ ≦\ x_i\ ≦\ 100,\ -100\ ≦\ y_i\ ≦\ 100) $以空格分隔。但是，板的顶点按逆时针方向的顺序给出。
- 高桥所在的位置是不包括周围的板子的内部。
- 保证板为凸多边形。

## 输出格式

把高桥从木板上掉下来之前走的最短距离输出到$1$行。如果绝对误差或相对误差的至少一方为$10^{-6}$以下，则输出被允许

### 翻译 说明/提示

## 说明/提示

如果你垂直走到哪一边，你只需走100步就从木板上掉下来。


------------

翻译者：[Eric1030](https://www.luogu.com.cn/user/995571)

## 样例 #1

### 输入

```
0 0

4

100 100

-100 100

-100 -100

100 -100
```

### 输出

```
100
```

## 样例 #2

### 输入

```
10 10

3

0 100

-100 -100

100 -100
```

### 输出

```
31.3049516850
```

## 样例 #3

### 输入

```
34 6

7

-43 -65

-23 -99

54 -68

65 92

16 83

-18 43

-39 2
```

### 输出

```
25.0284205314
```



---

---
title: "[ARC043A] 点数変換"
layout: "post"
diff: 普及/提高-
pid: AT_arc043_a
tag: []
---

# [ARC043A] 点数変換

## 题目描述

[problemUrl]: https://atcoder.jp/contests/arc043/tasks/arc043_a

$ N $ 人がテストを受けた。$ i $ 番目の人の得点は $ S_i $ である。

得点に偏りがあったので、平均が $ A $、最大値と最小値の差が $ B $ となるように得点を変換したい。

得点の変換は適切な実数 $ P,\ Q $ を選んで行う。$ i $ 番目の人の変換後の得点は $ P×S_i\ +\ Q $である。

適切な $ P,Q $ があるかどうか判断し、もしあるならばそれを出力せよ。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ A $ $ B $ $ S_1 $ $ S_2 $ : $ S_N $

- $ 1 $ 行目にはテストを受けた人数を表す整数 $ N\ (2\ ≦\ N\ ≦\ 10^5) $、変換後の平均を表す整数 $ A\ (1\ ≦\ A\ ≦\ 10^9) $、変換後の最大値と最小値の差を表す整数 $ B\ (1\ ≦\ B\ ≦\ 10^9) $ が空白区切りで与えられる。
- $ 2 $ 行目からの $ N $ 行のうち $ i $ 行目には $ i $ 番目の人の得点を表す整数 $ S_i\ (0\ ≦\ S_i\ ≦\ 10^9) $ が与えられる。

## 输出格式

もし適切な変換が存在しないならば $ -1 $ を $ 1 $ 行に出力せよ。

適切な変換が存在するならば、$ P,\ Q $ を空白区切りで $ 1 $ 行に出力せよ。 出力は絶対誤差あるいは相対誤差の少なくとも片方が $ 10^{-6} $ 以下であれば許容される。

出力の末尾に改行を入れること。

## 说明/提示

### Sample Explanation 1

$ P\ =\ 0.5,\ Q=-1 $とすると得点は順に $ 0,\ 1,\ 2,\ 3,\ 4 $ となり平均が $ 2 $, 最大値と最小値の差が $ 4 $になる。

## 样例 #1

### 输入

```
5 2 4

2

4

6

8

10
```

### 输出

```
0.5 -1
```

## 样例 #2

### 输入

```
13 29 31

3

1

4

1

5

9

2

6

5

3

5

8

9
```

### 输出

```
3.875 10.8173076
```

## 样例 #3

### 输入

```
5 1 2

34

34

34

34

34
```

### 输出

```
-1
```



---

---
title: "[ARC043B] 難易度"
layout: "post"
diff: 普及/提高-
pid: AT_arc043_b
tag: []
---

# [ARC043B] 難易度

## 题目描述

cdcq想出一场模拟赛  
作为暴力选手，cdcq出的题自然是要有明显的梯度，来让更多的选手拿到自己的分数  
现在cdcq的idea库里有$ N(4\leq N\leq 10^5) $个idea，并且他给每个idea评估了一个难度值  
他要从中选择4个idea来出题，并且这些idea需要满足如下三个条件：  
第二道题的难度值必须大于等于第一道题的两倍  
第三道题的难度值必须大于等于第二道题的两倍  
第四道题的难度值必须大于等于第三道题的两倍  
现在cdcq想考考你他总共能组出多少套题  
因为答案太大，所以你需要对$ 1,000,000,007(10^9+7) $取模

## 输入格式

第一行是一个正整数N  
接下来有N行，第i行是一个正整数$ D_i(1\leq D_i \leq 10^5) $,表示第i个idea的难度值

## 输出格式

一行一个整数，表示你的答案  
输出的末尾需要换行

## 说明/提示

部分点  
有50分满足$ 4\leq N \leq 3,000 $  
剩下的50分满足$ N(4\leq N\leq 10^5) $，共计100分  
Sample Explanation 1  
$ 1,2,3,5 $和$ 1,2,4,5 $都是可行的题目组合  
Sample Explanation 2  
没有任何一种组合满足题目条件  

感谢 @cdcq 提供的翻译

## 样例 #1

### 输入

```
5

1

2

4

5

10
```

### 输出

```
2
```

## 样例 #2

### 输入

```
10

11

12

13

14

15

16

17

18

19

20
```

### 输出

```
0
```

## 样例 #3

### 输入

```
20

1

2

3

4

5

6

7

8

9

10

11

12

13

14

15

16

17

18

19

20
```

### 输出

```
94
```



---

---
title: "[ARC045B] ドキドキデート大作戦高橋君"
layout: "post"
diff: 普及/提高-
pid: AT_arc045_b
tag: []
---

# [ARC045B] ドキドキデート大作戦高橋君

## 题目描述

# 高桥君的心跳约会大作战

高桥君在读的学校即将进行一次大扫除。学校中有N个教室，分别编号为 $1,2,3, \dots ,N$ 。这些教室排成了一排。

高桥君的学校中共有含高桥君在内的 $M$ 个学生，需要扫除的连续教室区间（称为扫除区间）有 $M$ 个。但是，还没有决定由哪个学生来负责哪个扫除区间。不同的学生负责不同的扫除区间，每个学生必须打扫被分配到的所有教室。 $1$ 个教室可能被多个扫除区间包含。

高桥君突然发现，大扫除当天他正好与女同学有约会。无论怎么样高桥君都不想毁掉这次约会，所以只能把大扫除翘掉了。但是高桥君很在意自己会不会暴露：高桥君负责的教室中如果有任何教室没有被打扫，高桥君就会暴露。

你的任务是：替高桥君找出就算翘掉扫除也不会暴露的所有扫除区间。

另外，这所学校里的学生们都非常勤奋努力，故假定除高桥君外的所有人都不会缺席大扫除。

## 输入格式

输入按以下标准：
$$ N \space M $$
$$ s_1 \space t_1 $$
$$ s_2 \space t_3 $$
$$ : $$
$$ s_M \space t_M $$

- 第一行为两个整数 $N(1 \leq N \leq 300,000)$ 和 $M(1 \leq M \leq 100,000)$ ，分别表示学校的教室数和学生数。
- 接下来的 $M$ 行，分别给出 $M$ 个扫除区间。这其中的第 $i(1 \leq i \leq M)$ 行给出表示第 $i$ 个扫除区间的整数 $s_i,t_i(1 \leq s_i \leq t_i \leq N)$ 。这表示某个学生需要打扫从 $s_i$ 到 $t_i$ 的所有教室。
- 可能有多个完全相同的区间。
- 任意教室至少被一个扫除区间包含。

## 输出格式

第一行：输出即使翘掉扫除也不会暴露的扫除区间个数 $k$ 。
接下来 $k$ 行，输出这些区间的编号（升序排列）。最后一行的末尾需换行。

## 部分分
对于 $30\%$ 的数据：
- 对于任意的教室 $i(1 \leq i \leq N)$ ，包含这个教室的扫除区间的个数最大为 $2$ 。

## 样例1解释
当高桥君负责第 $2,5$ 个扫除区间时不会暴露。具体来说：
- 当高桥君负责第 $2$ 个扫除区间时，第 $5$ 个扫除区间包含了教室 $5$ 所以不会暴露。
- 当高桥君负责第 $5$ 个扫除区间时，第 $2$ 个扫除区间包含了教室 $5$ ，且第 $3$ 个扫除区间包含了教室 $6$ ，所以不会暴露。

然而，当高桥君负责第 $1,3,4$ 个扫除区间时，会暴露。具体来说：
- 当高桥君负责第 $1$ 个扫除区间时，教室 $1,2,3,4$ 没有被扫除，故暴露了。
- 当高桥君负责第 $3$ 个扫除区间时，教室 $7,8$ 没有被扫除，故暴露了。
- 当高桥君负责第 $4$ 个扫除区间时，教室 $9,10$ 没有被扫除，故暴露了。

（个人认为第 $2,3$ 个样例解释是没有必要的）

## 样例 #1

### 输入

```
10 5

1 4

5 5

6 8

9 10

5 6
```

### 输出

```
2

2

5
```

## 样例 #2

### 输入

```
3 6

1 1

1 1

2 2

2 2

3 3

3 3
```

### 输出

```
6

1

2

3

4

5

6
```

## 样例 #3

### 输入

```
10 3

1 4

2 6

6 10
```

### 输出

```
0
```



---

---
title: "[ARC048B] AtCoderでじゃんけんを"
layout: "post"
diff: 普及/提高-
pid: AT_arc048_b
tag: []
---

# [ARC048B] AtCoderでじゃんけんを

## 题目描述

### 题意翻译

有 $n$ 个人在猜拳，每个人有一个 AtCoder 值 $r_i$，出拳出的是 $h_i$（这里规定 $1$ 是石头，$2$ 是剪刀，$3$ 是布）。

- 如果他们的 AtCoder 值不相等，AtCoder 值高的获胜。
- 如果他们的 AtCoder 值相等，猜拳赢的获胜。
- 否则平局。

现在每个人都与 $n-1$ 个人猜过了拳，求出最后的结果。

## 输入格式

第一行一个整数 $n$。

第二行到第 $n+1$ 行：每行两个整数 $r_i,h_i$。

## 输出格式

输出 $n$ 行，每行按输入顺序输出对应的胜、负、平局。

## 说明/提示

$1 \le n,r_i \le 10^5,h_i \in[1,2,3]$。

## 样例 #1

### 输入

```
6

2 1

2 2

3 2

5 3

2 2

3 3
```

### 输出

```
2 3 0

0 4 1

4 1 0

5 0 0

0 4 1

3 2 0
```

## 样例 #2

### 输入

```
2

1999 3

2000 1
```

### 输出

```
0 1 0

1 0 0
```

## 样例 #3

### 输入

```
8

3200 2

2800 3

2800 2

2700 1

2800 2

3200 1

2700 1

3200 3
```

### 输出

```
6 1 0

2 5 0

3 3 1

0 6 1

3 3 1

6 1 0

0 6 1

6 1 0
```



---

---
title: "[ARC053B] 回文分割"
layout: "post"
diff: 普及/提高-
pid: AT_arc053_b
tag: []
---

# [ARC053B] 回文分割

## 题目描述

[problemUrl]: https://atcoder.jp/contests/arc053/tasks/arc053_b





---

---
title: "[ARC054A] 動く歩道"
layout: "post"
diff: 普及/提高-
pid: AT_arc054_a
tag: []
---

# [ARC054A] 動く歩道

## 题目描述

[problemUrl]: https://atcoder.jp/contests/arc054/tasks/arc054_a

高梁空港には、周長 $ L $ の円形の動く歩道があり、その床面は $ 1 $ 秒間に距離 $ X $ 進む速度で時計回りに動いています。 動く歩道のある円周上の点の位置は、その中で最も北にある点から時計回りに測った距離 ( $ 0 $ 以上 $ L $ 未満) であらわされます。 動く歩道の外周の位置 $ D $ の点には出口があり、そこから動く歩道の外に出ることができるようになっています。 それ以外の外周と内周には手すりがあるため、高橋君は出口以外の場所から外に出ることはできません。

高橋君は動く歩道の床面に対して $ 1 $ 秒間に距離 $ Y $ 進む速度で時計回りまたは反時計回りに歩くことができ、動く歩道上の位置 $ S $ の点に乗っています。

高橋君が出口にたどり着くまでにかかる最小の時間を求めてください。

なお、出口の $ 1 $ 箇所しかない動く歩道にわざわざ乗るような物好きな人は高橋君以外にはいないので、動く歩道を逆走しても誰にも迷惑をかけることはありません。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ L $ $ X $ $ Y $ $ S $ $ D $

## 输出格式

高橋君が出口にたどり着くまでにかかる最小の時間を $ 1 $ 行に出力せよ。絶対誤差あるいは相対誤差が $ 10^{-6} $ 以下のとき正答と認められる。

出力の最後には改行を忘れないこと。

## 说明/提示

### 制約

- $ 1\ ≦\ L,X,Y\ ≦\ 10^9,\ 0\ ≦\ S,D\ ≦\ L-1 $
- 入力はすべて整数である。

### Sample Explanation 1

時計回りに歩き続けると $ 0.8 $ 秒で出口にたどり着くことができます。

### Sample Explanation 2

反時計回りに歩き続けると $ 0.25 $ 秒で出口にたどり着くことができます。

## 样例 #1

### 输入

```
6 2 3 1 5
```

### 输出

```
0.8000000000
```

## 样例 #2

### 输入

```
6 2 10 1 5
```

### 输出

```
0.2500000000
```

## 样例 #3

### 输入

```
6 3 1 5 3
```

### 输出

```
1.0000000000
```

## 样例 #4

### 输入

```
10 7 7 6 0
```

### 输出

```
0.2857142857
```



---

---
title: "[ARC054B] ムーアの法則"
layout: "post"
diff: 普及/提高-
pid: AT_arc054_b
tag: []
---

# [ARC054B] ムーアの法則

## 题目描述

原题网址:[link](https://atcoder.jp/contests/arc054/tasks/arc054_b)



高橋君对塔卡哈什曼函数感兴趣。高桥君想计算$T（334）$的值（$T$表示塔卡哈什曼函数[译者注:可能是暗示了哈克曼函数:`Ackermann`，可能是解题方法的暗示]），但由于现代计算机需要$P$年，所以很难计算。

高橋君几乎放弃了一半的计算，知道了世界上有摩尔法则这个法则。根据摩尔法则，我们发现计算机的速度是每$1.5$年翻倍的速度，呈指数增长。

更准确地说，$x$年后计算机的速度将是现代的$2^{x/1.5}$倍。

高桥君想通过在适当的时机开始计算，并尽快结束$T（334）$的计算。当然，因为在计算过程中不能改变计算机，所以计算结束之前的时间是（开始计算之前的时间）+（开始计算时的计算机计算$T（334）$所需的时间）。

请计算结束前的最短时间$m$。

## 输入格式

输入$P$，即计算机计算时间。

## 输出格式

输出$m$，即结束前的最短时间。  
输出最后一行可以换行。

## 说明/提示

- $0<P\leqslant10^{18}$  
- $P$是实数，保留小数点后$4$位输出。

## 样例 #1

### 输入

```
3.0000
```

### 输出

```
2.8708930019
```

## 样例 #2

### 输入

```
0.0400
```

### 输出

```
0.0400000000
```

## 样例 #3

### 输入

```
1000000000000000000.0000
```

### 输出

```
90.1855078128
```



---

---
title: "[ARC059D] アンバランス"
layout: "post"
diff: 普及/提高-
pid: AT_arc059_b
tag: []
---

# [ARC059D] アンバランス

## 题目描述

[problemUrl]: https://atcoder.jp/contests/arc059/tasks/arc059_b

文字列 $ t $ について、$ t $ の長さが $ 2 $ 以上であり、かつ $ t $ の中の文字のうち過半数が同じ文字であるとき、$ t $ を*アンバランス*であると呼ぶことにします。例えば、`voodoo` や `melee` はアンバランスであり、`noon` や `a` はアンバランスではありません。

小文字のアルファベットからなる文字列 $ s $ が与えられます。$ s $ にアンバランスな (連続する) 部分文字列が存在するか判定してください。存在する場合は、$ s $ の中でそのような部分文字列が存在する位置を一つ示してください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ s $

## 输出格式

$ s $ にアンバランスな部分文字列が存在しない場合は、`-1 -1` と出力せよ。

$ s $ にアンバランスな部分文字列が存在する場合は、そのような部分文字列の一つを $ s_a\ s_{a+1}\ ...\ s_{b} $ $ (1\ ≦\ a\ <\ b\ ≦\ |s|) $ として、`$ a $ $ b $` と出力せよ。そのような部分文字列が複数存在する場合は、いずれも正解とみなされる。

## 说明/提示

### 制約

- $ 2\ ≦\ |s|\ ≦\ 10^5 $
- $ s $ は小文字のアルファベットのみからなる。

### 部分点

- $ 2\ ≦\ |s|\ ≦\ 100 $ を満たすデータセットに正解した場合は、$ 200 $ 点が与えられる。

### Sample Explanation 1

文字列 $ s_2\ s_3\ s_4\ s_5 $ $ = $ `eede` はアンバランスな文字列です。他にもアンバランスな部分文字列は存在し、例えば `2 6` と出力しても正解となります。

### Sample Explanation 2

文字列 `atcoder` はアンバランスな部分文字列を持ちません。

## 样例 #1

### 输入

```
needed
```

### 输出

```
2 5
```

## 样例 #2

### 输入

```
atcoder
```

### 输出

```
-1 -1
```



---

---
title: "[ABC044C] 高橋君とカード"
layout: "post"
diff: 普及/提高-
pid: AT_arc060_a
tag: []
---

# [ABC044C] 高橋君とカード

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc044/tasks/arc060_a

高橋君は、$ N $ 枚のカードを持っています。 $ i\ \,\ (1\ \leq\ i\ \leq\ N) $ 番目のカードには、整数 $ x_i $ が書かれています。 高橋君は、これらのカードの中から $ 1 $ 枚以上を選び、 選んだカードに書かれた整数の平均をちょうど $ A $ にしたいと考えています。 そのようなカードの選び方が何通りあるか求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ A $ $ x_1 $ $ x_2 $ $ ... $ $ x_N $

## 输出格式

書かれた整数の平均がちょうど $ A $ となるようなカードの選び方の総数を出力せよ。

## 说明/提示

### 制約

- $ 1\ \leq\ N\ \leq\ 50 $
- $ 1\ \leq\ A\ \leq\ 50 $
- $ 1\ \leq\ x_i\ \leq\ 50 $
- $ N,\,A,\,x_i $ はいずれも整数である

### 部分点

- $ 1\ \leq\ N\ \leq\ 16 $ を満たすデータセットに正解した場合は、$ 200 $ 点が与えられる。

### Sample Explanation 1

\- 平均が $ 8 $ となるカードの選び方は、以下の $ 5 $ 通りです。 - $ 3 $ 枚目のカードのみを選ぶ。 - $ 1 $ 枚目と $ 2 $ 枚目のカードを選ぶ。 - $ 1 $ 枚目と $ 4 $ 枚目のカードを選ぶ。 - $ 1 $ 枚目、$ 2 $ 枚目および $ 3 $ 枚目のカードを選ぶ。 - $ 1 $ 枚目、$ 3 $ 枚目および $ 4 $ 枚目のカードを選ぶ。

### Sample Explanation 4

\- 答えは $ 32 $ ビット整数型に収まらない場合があります。

## 样例 #1

### 输入

```
4 8

7 9 8 9
```

### 输出

```
5
```

## 样例 #2

### 输入

```
3 8

6 6 9
```

### 输出

```
0
```

## 样例 #3

### 输入

```
8 5

3 6 2 8 7 6 5 9
```

### 输出

```
19
```

## 样例 #4

### 输入

```
33 3

3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3
```

### 输出

```
8589934591
```



---

---
title: "[ABC045C] たくさんの数式"
layout: "post"
diff: 普及/提高-
pid: AT_arc061_a
tag: []
---

# [ABC045C] たくさんの数式

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc045/tasks/arc061_a

`1` 以上 `9` 以下の数字のみからなる文字列 $ S $ が与えられます。 この文字列の中で、あなたはこれら文字と文字の間のうち、いくつかの場所に `+` を入れることができます。 一つも入れなくてもかまいません。 ただし、`+` が連続してはいけません。

このようにして出来る全ての文字列を数式とみなし、和を計算することができます。

ありうる全ての数式の値を計算し、その合計を出力してください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ S $

## 输出格式

ありうる全ての数式の値の総和を $ 1 $ 行に出力せよ。

## 说明/提示

### 制約

- $ 1\ \leq\ &#124;S&#124;\ \leq\ 10 $
- $ S $ に含まれる文字は全て `1` 〜 `9` の数字

### Sample Explanation 1

考えられる数式としては、 `125`、`1+25`、`12+5`、`1+2+5` の $ 4 $ 通りがあります。それぞれの数式を計算すると、 - $ 125 $ - $ 1+25=26 $ - $ 12+5=17 $ - $ 1+2+5=8 $ となり、これらの総和は $ 125+26+17+8=176 $ となります。

## 样例 #1

### 输入

```
125
```

### 输出

```
176
```

## 样例 #2

### 输入

```
9999999999
```

### 输出

```
12656242944
```



---

---
title: "[ABC048C] Boxes and Candies"
layout: "post"
diff: 普及/提高-
pid: AT_arc064_a
tag: []
---

# [ABC048C] Boxes and Candies

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc048/tasks/arc064_a

$ N $ 個の箱が横一列に並んでいます。 最初、左から $ i $ 番目の箱には $ a_i $ 個のキャンディが入っています。

すぬけ君は次の操作を好きな回数だけ行うことができます。

- キャンディが $ 1 $ 個以上入っている箱をひとつ選び、その箱のキャンディを $ 1 $ 個食べる。

すぬけ君の目標は次の通りです。

- どの隣り合う $ 2 $ つの箱を見ても、それらの箱に入っているキャンディの個数の総和が $ x $ 以下である。

目標を達成するために必要な操作回数の最小値を求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ x $ $ a_1 $ $ a_2 $ $ ... $ $ a_N $

## 输出格式

目標を達成するために必要な操作回数の最小値を出力せよ。

## 说明/提示

### 制約

- $ 2\ <\ =\ N\ <\ =\ 10^5 $
- $ 0\ <\ =\ a_i\ <\ =\ 10^9 $
- $ 0\ <\ =\ x\ <\ =\ 10^9 $

### Sample Explanation 1

$ 2 $ 番目の箱のキャンディを $ 1 $ 個食べればよいです。 すると、各箱のキャンディの個数は $ (2,\ 1,\ 2) $ となります。

### Sample Explanation 2

たとえば、$ 2 $ 番目の箱のキャンディを $ 6 $ 個食べ、$ 4 $ 番目の箱のキャンディを $ 2 $ 個食べ、$ 6 $ 番目の箱のキャンディを $ 3 $ 個食べればよいです。 すると、各箱キャンディの個数は $ (1,\ 0,\ 1,\ 0,\ 0,\ 1) $ となります。

### Sample Explanation 3

最初から目標が達成されているので、操作を行う必要はありません。

### Sample Explanation 4

すべてのキャンディを食べなければなりません。

## 样例 #1

### 输入

```
3 3

2 2 2
```

### 输出

```
1
```

## 样例 #2

### 输入

```
6 1

1 6 1 2 0 4
```

### 输出

```
11
```

## 样例 #3

### 输入

```
5 9

3 1 4 1 5
```

### 输出

```
0
```

## 样例 #4

### 输入

```
2 0

5 5
```

### 输出

```
10
```



---

---
title: "[ABC049C] 白昼夢"
layout: "post"
diff: 普及/提高-
pid: AT_arc065_a
tag: []
---

# [ABC049C] 白昼夢

## 题目描述

# 题目大意
输入一个以英文小写字母组成的字符串S，规定一个空的字符串T，现在你可对字符串T进行你喜欢的操作，问是否能让字符串T变为字符串S？

**喜欢的操作如下 ：**

在字符串T的末尾加入
“dream”或“dreamer”或“erase”或“eraser”。

------------

## 输入格式

一个字符串S

## 输出格式

若可以输出**YES**,否则输出**NO**。

## 样例 #1

### 输入

```
erasedream
```

### 输出

```
YES
```

## 样例 #2

### 输入

```
dreameraser
```

### 输出

```
YES
```

## 样例 #3

### 输入

```
dreamerer
```

### 输出

```
NO
```



---

---
title: "[ABC049D] 連結"
layout: "post"
diff: 普及/提高-
pid: AT_arc065_b
tag: []
---

# [ABC049D] 連結

## 题目描述

有$N$个城市，$K$条道路（指地面上的道路）和$L$条地铁。道路和地铁都是无向的。对于每个点，请你求出它只通过道路**和**只通过地铁都能到达的点的个数。道路和地铁之间不能换乘，你只能**完全**通过地铁到达某个点，或者**完全**通过道路到达某个点。

## 输入格式

第一行三个正整数$N,K,L$
($N\le2\times 10^5,K,L\le10^5$)  
然后$K$行，每行两个数$p,q$，表示城市$p$和城市$q$通过道路连接。   
然后$L$行，每行两个数$r,s$，表示城市$r$和城市$s$通过地铁连接。

## 输出格式

一行$N$个正整数，表示每个点只通过道路和只通过地铁都能到达的点的个数。

## 样例 #1

### 输入

```
4 3 1

1 2

2 3

3 4

2 3
```

### 输出

```
1 2 2 1
```

## 样例 #2

### 输入

```
4 2 2

1 2

2 3

1 4

2 3
```

### 输出

```
1 2 2 1
```

## 样例 #3

### 输入

```
7 4 4

1 2

2 3

2 5

6 7

3 5

4 5

3 4

6 7
```

### 输出

```
1 1 2 1 2 2 2
```



---

---
title: "[ABC050C] Lining Up"
layout: "post"
diff: 普及/提高-
pid: AT_arc066_a
tag: []
---

# [ABC050C] Lining Up

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc050/tasks/arc066_a

$ 1～N $ までの番号がついた、$ N $ 人の人がいます。 彼らは昨日、ある順番で左右一列に並んでいましたが、今日になってその並び方が分からなくなってしまいました。 しかし、彼らは全員、「自分の左に並んでいた人数と自分の右に並んでいた人数の差の絶対値」を覚えています。 彼らの報告によると、人 $ i $ の、「自分の左に並んでいた人数と自分の右に並んでいた人数の差の絶対値」は $ A_i $ です。

彼らの報告を元に、元の並び方が何通りあり得るかを求めてください。 ただし、答えは非常に大きくなることがあるので、$ 10^9+7 $ で割った余りを出力してください。 また、彼らの報告が間違っており、ありうる並び方がないこともありえます。 その際は $ 0 $ を出力してください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ A_1 $ $ A_2 $ $ ... $ $ A_N $

## 输出格式

元の並び順としてありうるものが何通りあるか求め、$ 10^9+7 $ で割った余りを出力せよ。

## 说明/提示

### 制約

- $ 1≦N≦10^5 $
- $ 0≦A_i≦N-1 $

### Sample Explanation 1

ありうる並び方は、人の番号で書くと、 - $ 2,1,4,5,3 $ - $ 2,5,4,1,3 $ - $ 3,1,4,5,2 $ - $ 3,5,4,1,2 $ の $ 4 $ 通りです。

### Sample Explanation 2

どのような並び方でも、報告と矛盾するので、$ 0 $ が答えになります。

## 样例 #1

### 输入

```
5

2 4 4 0 2
```

### 输出

```
4
```

## 样例 #2

### 输入

```
7

6 4 0 2 4 0 2
```

### 输出

```
0
```

## 样例 #3

### 输入

```
8

7 5 1 1 7 3 5 3
```

### 输出

```
16
```



---

---
title: "[ABC052D] Walk and Teleport"
layout: "post"
diff: 普及/提高-
pid: AT_arc067_b
tag: []
---

# [ABC052D] Walk and Teleport

## 题目描述

在东西方向延伸的直线上，有N个城市。城市坐标按从西到东递增。

你现在在某个城市里，想去其他所有的城市。移动的方法有以下两种。

一，在直线上按东西方向平移，每移动一个单位距离疲劳值加A

二，直接瞬移到某个坐标，并且疲劳值加B

请使用以上两种方式直到去完其他所有的城市，并求出最小的疲劳值。

## 输入格式

第一行三个数,即N,A,B,

第二行N个数，即X[1],X[2]...,X[N]。

## 输出格式

输出最小的疲劳值。

## 说明/提示

2<=N<=1e5

1<=Xi,A,B<=1e9且X(i)<X(i+1)

## 样例 #1

### 输入

```
4 2 5

1 2 5 7
```

### 输出

```
11
```

## 样例 #2

### 输入

```
7 1 100

40 43 45 105 108 115 124
```

### 输出

```
84
```

## 样例 #3

### 输入

```
7 1 2

24 35 40 68 72 99 103
```

### 输出

```
12
```



---

---
title: "[ABC058D] 井井井"
layout: "post"
diff: 普及/提高-
pid: AT_arc071_b
tag: []
---

# [ABC058D] 井井井

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc058/tasks/arc071_b

$ 2 $ 次元平面上に $ x $ 軸と平行な直線が $ m $ 本と $ y $ 軸と平行な直線が $ n $ 本引いてあります。 $ x $ 軸と平行な直線のうち下から $ i $ 番目は $ y\ =\ y_i $ で表せます。 $ y $ 軸と平行な直線のうち左から $ i $ 番目は $ x\ =\ x_i $ で表せます。

この中に存在しているすべての長方形についてその面積を求め、 合計を $ 10^9+7 $ で割ったあまりを出力してください。

つまり、$ 1\leq\ i\ <\ j\leq\ n $ と $ 1\leq\ k\ <\ l\leq\ m $ を満たすすべての組 $ (i,j,k,l) $ について、  直線 $ x=x_i $, $ x=x_j $, $ y=y_k $, $ y=y_l $ で囲まれる 長方形の面積を求め、合計を $ 10^9+7 $ で割ったあまりを出力してください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ n $ $ m $ $ x_1 $ $ x_2 $ $ ... $ $ x_n $ $ y_1 $ $ y_2 $ $ ... $ $ y_m $

## 输出格式

長方形の面積の合計を $ 10^9+7 $ で割ったあまりを $ 1 $ 行に出力せよ。

## 说明/提示

### 制約

- $ 2\ \leq\ n,m\ \leq\ 10^5 $
- $ -10^9\ \leq\ x_1\ <\ ...\ <\ x_n\ \leq\ 10^9 $
- $ -10^9\ \leq\ y_1\ <\ ...\ <\ y_m\ \leq\ 10^9 $
- $ x_i,\ y_i $ は整数である。

### Sample Explanation 1

この入力を図にすると、以下のようになります。 !\[sample1-1\](https://atcoder.jp/img/arc071/aec4d5cc2e5c73dbee455be237a649a5.png) 長方形 A,B,...,I それぞれの面積を合計すると $ 60 $ になります。 !\[sample1-2\](https://atcoder.jp/img/arc071/f0771c0f7e68af2b00e7513186f585ff.png)

## 样例 #1

### 输入

```
3 3

1 3 4

1 3 6
```

### 输出

```
60
```

## 样例 #2

### 输入

```
6 5

-790013317 -192321079 95834122 418379342 586260100 802780784

-253230108 193944314 363756450 712662868 735867677
```

### 输出

```
835067060
```



---

---
title: "[ARC071E] TrBBnsformBBtion"
layout: "post"
diff: 普及/提高-
pid: AT_arc071_c
tag: []
---

# [ARC071E] TrBBnsformBBtion

## 题目描述

考虑对一个只含 `A`，`B` 的字符串的如下操作：

1. 将一个 `A` 替换成 `BB`，或将一个 `B` 替换成 `AA`

2. 将三个连续相同的字符（`AAA` 或 `BBB`）消掉

例如说，串 `ABA` 可以通过第一个操作变成 `BBBA`，串 `BBBAAAA` 可以通过第二个操作变成 `BBBA`.

这些操作可以以任意顺序，不限次数地进行。

给出两个串 $S$ 和 $T$，以及 $q$ 次询问 $a_i, b_i, c_i, d_i$，每次询问你需要回答 $S_{a_i...b_i}$ 这一子串是否能通过这两个操作变成 $T_{c_i...d_i}$.

## 输入格式

将从标准输入输出输入以下格式：
```
$ S $ 
$ T $ 
$ q $ 
$ a_1 $   $ b_1 $   $ c_1 $   $ d_1 $ 
$ ... $ 
$ a_q $   $ b_q $   $ c_q $   $ d_q $ 
```

## 输出格式

输出 $q$ 行，每行包含一个询问的答案。若第 $i$ 个询问 $S_{a_i...b_i}$ 这一子串能通过这两个操作变成 $T_{c_i...d_i}$，则输出 `YES`，否则输出 `NO`.

## 样例 #1

### 输入

```
BBBAAAABA

BBBBA

4

7 9 2 5

7 9 1 4

1 7 2 5

1 7 2 4
```

### 输出

```
YES

NO

YES

NO
```

## 样例 #2

### 输入

```
AAAAABBBBAAABBBBAAAA

BBBBAAABBBBBBAAAAABB

10

2 15 2 13

2 13 6 16

1 13 2 20

4 20 3 20

1 18 9 19

2 14 1 11

3 20 3 15

6 16 1 17

4 18 8 20

7 20 3 14
```

### 输出

```
YES

YES

YES

YES

YES

YES

NO

NO

NO

NO
```



---

---
title: "[ABC060D] Simple Knapsack"
layout: "post"
diff: 普及/提高-
pid: AT_arc073_b
tag: []
---

# [ABC060D] Simple Knapsack

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc060/tasks/arc073_b

あなたは $ N $ 個の物と、強度 $ W $ のバッグを持っています。 $ i $ 個目の物は、重さが $ w_i $ で価値が $ v_i $ です。

あなたは、物のうちいくつかを選び、バッグに入れます。 ただし、選んだ物の重さの和は $ W $ 以下でなくてはいけません。

あなたは、バッグに入れた物の価値の総和を最大化したいです。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ W $ $ w_1 $ $ v_1 $ $ w_2 $ $ v_2 $ : $ w_N $ $ v_N $

## 输出格式

価値の総和の最大値を出力する。

## 说明/提示

### 制約

- $ 1\ ≦\ N\ ≦\ 100 $
- $ 1\ ≦\ W\ ≦\ 10^9 $
- $ 1\ ≦\ w_i\ ≦\ 10^9 $
- すべての $ i\ =\ 2,3,...,N $ について、$ w_1\ ≦\ w_i\ ≦\ w_1\ +\ 3 $
- $ 1\ ≦\ v_i\ ≦\ 10^7 $
- $ W,\ w_i,\ v_i $ はすべて整数である

### Sample Explanation 1

$ 1,\ 3 $ 個目の物を選ぶと良いです。

### Sample Explanation 2

$ 2,\ 4 $ 個目の物を選ぶと良いです。

### Sample Explanation 3

すべての物が選べます。

### Sample Explanation 4

$ 1 $ 個も物が選べません。

## 样例 #1

### 输入

```
4 6

2 1

3 4

4 10

3 4
```

### 输出

```
11
```

## 样例 #2

### 输入

```
4 6

2 1

3 7

4 10

3 6
```

### 输出

```
13
```

## 样例 #3

### 输入

```
4 10

1 100

1 100

1 100

1 100
```

### 输出

```
400
```

## 样例 #4

### 输入

```
4 1

10 100

10 100

10 100

10 100
```

### 输出

```
0
```



---

---
title: "[ABC062C] Chocolate Bar"
layout: "post"
diff: 普及/提高-
pid: AT_arc074_a
tag: []
---

# [ABC062C] Chocolate Bar

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc062/tasks/arc074_a

縦 $ H $ ブロック、横 $ W $ ブロックの板チョコがあります。 すぬけ君は、この板チョコをちょうど $ 3 $ つのピースに分割しようとしています。 ただし、各ピースはブロックの境目に沿った長方形でなければなりません。

すぬけ君は、$ 3 $ つのピースの面積 (ブロック数) をできるだけ均等にしようとしています。 具体的には、$ 3 $ つのピースの面積の最大値を $ S_{max} $、最小値を $ S_{min} $ としたとき、$ S_{max}\ -\ S_{min} $ を最小化しようとしています。 $ S_{max}\ -\ S_{min} $ の最小値を求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ H $ $ W $

## 输出格式

$ S_{max}\ -\ S_{min} $ の最小値を出力せよ。

## 说明/提示

### 制約

- $ 2\ <\ =\ H,\ W\ <\ =\ 10^5 $

### Sample Explanation 1

次図のように分割すると、$ S_{max}\ -\ S_{min}\ =\ 5\ -\ 5\ =\ 0 $ となります。 !\[2a9b2ef47b750c0b7ba3e865d4fb4203.png\](https://atcoder.jp/img/arc074/2a9b2ef47b750c0b7ba3e865d4fb4203.png)

### Sample Explanation 2

次図のように分割すると、$ S_{max}\ -\ S_{min}\ =\ 8\ -\ 6\ =\ 2 $ となります。 !\[a42aae7aaaadc4640ac5cdf88684d913.png\](https://atcoder.jp/img/arc074/a42aae7aaaadc4640ac5cdf88684d913.png)

### Sample Explanation 3

次図のように分割すると、$ S_{max}\ -\ S_{min}\ =\ 10\ -\ 6\ =\ 4 $ となります。 !\[eb0ad0cb3185b7ae418e21c472ff7f26.png\](https://atcoder.jp/img/arc074/eb0ad0cb3185b7ae418e21c472ff7f26.png)

## 样例 #1

### 输入

```
3 5
```

### 输出

```
0
```

## 样例 #2

### 输入

```
4 5
```

### 输出

```
2
```

## 样例 #3

### 输入

```
5 5
```

### 输出

```
4
```

## 样例 #4

### 输入

```
100000 2
```

### 输出

```
1
```

## 样例 #5

### 输入

```
100000 100000
```

### 输出

```
50000
```



---

---
title: "[ABC062D] 3N Numbers"
layout: "post"
diff: 普及/提高-
pid: AT_arc074_b
tag: []
---

# [ABC062D] 3N Numbers

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc062/tasks/arc074_b

$ N $ を $ 1 $ 以上の整数とします。

長さ $ 3N $ の数列 $ a\ =\ (a_1,\ a_2,\ ...,\ a_{3N}) $ があります。 すぬけ君は、$ a $ からちょうど $ N $ 個の要素を取り除き、残った $ 2N $ 個の要素を元の順序で並べ、長さ $ 2N $ の数列 $ a' $ を作ろうとしています。 このとき、$ a' $ のスコアを $ (a'\ の前半\ N\ 要素の総和)\ -\ (a'\ の後半\ N\ 要素の総和) $ と定義します。

$ a' $ のスコアの最大値を求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ a_1 $ $ a_2 $ $ ... $ $ a_{3N} $

## 输出格式

$ a' $ のスコアの最大値を出力せよ。

## 说明/提示

### 制約

- $ 1\ <\ =\ N\ <\ =\ 10^5 $
- $ a_i $ は整数である。
- $ 1\ <\ =\ a_i\ <\ =\ 10^9 $

### 部分点

- $ 300 $ 点分のテストケースでは、$ N\ <\ =\ 1,000 $ が成り立つ。

### Sample Explanation 1

$ a_2 $, $ a_6 $ を取り除くと、$ a'\ =\ (3,\ 4,\ 1,\ 5) $ となり、スコアは $ (3\ +\ 4)\ -\ (1\ +\ 5)\ =\ 1 $ となります。

### Sample Explanation 2

例えば、$ a_1 $ を取り除くと、$ a'\ =\ (2,\ 3) $ となり、スコアは $ 2\ -\ 3\ =\ -1 $ となります。

### Sample Explanation 3

例えば、$ a_2 $, $ a_3 $, $ a_9 $ を取り除くと、$ a'\ =\ (8,\ 7,\ 4,\ 6,\ 5,\ 3) $ となり、スコアは $ (8\ +\ 7\ +\ 4)\ -\ (6\ +\ 5\ +\ 3)\ =\ 5 $ となります。

## 样例 #1

### 输入

```
2

3 1 4 1 5 9
```

### 输出

```
1
```

## 样例 #2

### 输入

```
1

1 2 3
```

### 输出

```
-1
```

## 样例 #3

### 输入

```
3

8 2 2 7 4 6 5 3 8
```

### 输出

```
5
```



---

---
title: "[ABC065C] Reconciled?"
layout: "post"
diff: 普及/提高-
pid: AT_arc076_a
tag: []
---

# [ABC065C] Reconciled?

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc065/tasks/arc076_a

すぬけ君は、犬を $ N $ 匹と猿を $ M $ 匹飼っています。すぬけ君は、この $ N+M $ 匹を一列に並べようと思っています。

文字通り犬猿の仲の犬たちと猿たちを仲直りさせたいすぬけ君は、犬同士、または猿同士が隣り合うところができないように並べようと思っています。

このような並べ方は何通りあるでしょうか。犬と猿は $ 10^9+7 $ 以上の数を理解できないので、並べ方の個数を $ 10^9+7 $ で割ったあまりを求めてください。 ただし、犬同士、また猿同士は互いに区別します。また、左右が反転しただけの列も異なる列とみなします。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ M $

## 输出格式

並べ方の個数を $ 10^9+7 $ で割ったあまりを出力せよ。

## 说明/提示

### 制約

- $ 1\ ≦\ N,M\ ≦\ 10^5 $

### Sample Explanation 1

犬をそれぞれ `A`,`B` とし、猿をそれぞれ `C`,`D` とすると、`ACBD`,`ADBC`,`BCAD`,`BDAC`,`CADB`,`CBDA`,`DACB`,`DBCA` の $ 8 $ 通りの並べ方があります。

## 样例 #1

### 输入

```
2 2
```

### 输出

```
8
```

## 样例 #2

### 输入

```
3 2
```

### 输出

```
12
```

## 样例 #3

### 输入

```
1 8
```

### 输出

```
0
```

## 样例 #4

### 输入

```
100000 100000
```

### 输出

```
530123477
```



---

---
title: "[ABC069D] Grid Coloring"
layout: "post"
diff: 普及/提高-
pid: AT_arc080_b
tag: []
---

# [ABC069D] Grid Coloring

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc069/tasks/arc080_b

縦 $ H $ 行、横 $ W $ 列のマス目があります。 すぬけ君は、このマス目を色 $ 1 $, $ 2 $, $ ... $, $ N $ で塗り分けようとしています。 このとき、次の条件が成り立つようにします。

- 各 $ i $ ($ 1\ <\ =\ i\ <\ =\ N $) について、色 $ i $ のマスはちょうど $ a_i $ 個存在する。 ただし、$ a_1\ +\ a_2\ +\ ...\ +\ a_N\ =\ H\ W $ である。
- 各 $ i $ ($ 1\ <\ =\ i\ <\ =\ N $) について、色 $ i $ のマスは上下左右に連結である。 すなわち、どの色 $ i $ のマスからどの色 $ i $ のマスへも、上下左右に隣り合う色 $ i $ のマスのみを辿って行き来できる。

条件を満たす塗り分け方をひとつ求めてください。 解は必ず存在することが示せます。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ H $ $ W $ $ N $ $ a_1 $ $ a_2 $ $ ... $ $ a_N $

## 输出格式

条件を満たす塗り分け方をひとつ出力せよ。 塗り分け方は次のフォーマットで出力せよ。 ただし、$ c_{i\ j} $ は、上から $ i $ 行目、左から $ j $ 列目のマスの色である。

> $ c_{1\ 1} $ $ ... $ $ c_{1\ W} $ $ : $ $ c_{H\ 1} $ $ ... $ $ c_{H\ W} $

## 说明/提示

### 制約

- $ 1\ <\ =\ H,\ W\ <\ =\ 100 $
- $ 1\ <\ =\ N\ <\ =\ H\ W $
- $ a_i\ >\ =\ 1 $
- $ a_1\ +\ a_2\ +\ ...\ +\ a_N\ =\ H\ W $

### Sample Explanation 1

例えば、次の塗り分け方は条件を満たしません。 色 $ 1 $ のマスが上下左右に連結でないからです。 ``` 1 2 3 1 ```

## 样例 #1

### 输入

```
2 2

3

2 1 1
```

### 输出

```
1 1

2 3
```

## 样例 #2

### 输入

```
3 5

5

1 2 3 4 5
```

### 输出

```
1 4 4 4 3

2 5 4 5 3

2 5 5 5 3
```

## 样例 #3

### 输入

```
1 1

1

1
```

### 输出

```
1
```



---

---
title: "[ABC071D] Coloring Dominoes"
layout: "post"
diff: 普及/提高-
pid: AT_arc081_b
tag: []
---

# [ABC071D] Coloring Dominoes

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc071/tasks/arc081_b

$ 2\ \times\ N $ のマス目があります． すぬけ君は，このマス目に $ N $ 個のドミノを，重ならないように敷き詰めました． ここで，ドミノは，$ 1\ \times\ 2 $ または $ 2\ \times\ 1 $ のマス目を覆うことができます．

すぬけ君は，赤色，水色，緑色の $ 3 $ 色を使って，これらのドミノを塗ることにしました． このとき，辺で接しているドミノは異なる色で塗るようにします． ここで，必ずしも $ 3 $ 色すべてを使う必要はありません．

このような塗り方が何通りあるかを mod $ 1000000007 $ で求めてください．

ただし，ドミノの敷き詰め方は，文字列 $ S_1,\ S_2 $ を用いて，次のようにして与えられます．

- 各ドミノは，それぞれ異なる英小文字または英大文字で表される．
- $ S_i $ の $ j $ 文字目は，マス目の上から $ i $ 番目，左から $ j $ 番目のマスにどのドミノがあるかを表す．

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ S_1 $ $ S_2 $

## 输出格式

ドミノを塗る方法の数を mod $ 1000000007 $ で出力せよ．

## 说明/提示

### 制約

- $ 1\ \leq\ N\ \leq\ 52 $
- $ |S_1|\ =\ |S_2|\ =\ N $
- $ S_1,\ S_2 $ は英小文字または英大文字からなる
- $ S_1,\ S_2 $ は正しいドミノの敷き詰め方を表している

### Sample Explanation 1

次の $ 6 $ 通りあります． !\[\](https://atcoder.jp/img/arc081/899673bd23529f4fb5e41c6e7d5bc372.png)

### Sample Explanation 2

必ずしもすべての色を使わなくてもよいことに注意してください．

## 样例 #1

### 输入

```
3

aab

ccb
```

### 输出

```
6
```

## 样例 #2

### 输入

```
1

Z

Z
```

### 输出

```
3
```

## 样例 #3

### 输入

```
52

RvvttdWIyyPPQFFZZssffEEkkaSSDKqcibbeYrhAljCCGGJppHHn

RLLwwdWIxxNNQUUXXVVMMooBBaggDKqcimmeYrhAljOOTTJuuzzn
```

### 输出

```
958681902
```



---

---
title: "[ABC074C] Sugar Water"
layout: "post"
diff: 普及/提高-
pid: AT_arc083_a
tag: []
---

# [ABC074C] Sugar Water

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc074/tasks/arc083_a

すぬけ君はビーカーに砂糖水を作ろうとしています。 最初ビーカーは空です。すぬけ君は以下の $ 4 $ 種類の操作をそれぞれ何回でも行うことができます。一度も行わない操作があっても構いません。

- 操作 1: ビーカーに水を $ 100A $ \[g\] 入れる。
- 操作 2: ビーカーに水を $ 100B $ \[g\] 入れる。
- 操作 3: ビーカーに砂糖を $ C $ \[g\] 入れる。
- 操作 4: ビーカーに砂糖を $ D $ \[g\] 入れる。

すぬけ君の実験環境下では、水 $ 100 $ \[g\] あたり砂糖は $ E $ \[g\] 溶けます。

すぬけ君はできるだけ濃度の高い砂糖水を作りたいと考えています。

ビーカーに入れられる物質の質量 (水の質量と砂糖の質量の合計) が $ F $ \[g\] 以下であり、 ビーカーの中に砂糖を溶け残らせてはいけないとき、 すぬけ君が作る砂糖水の質量と、それに溶けている砂糖の質量を求めてください。 答えが複数ある場合はどれを答えても構いません。

水 $ a $ \[g\] と砂糖 $ b $ \[g\] を混ぜた砂糖水の濃度は $ \frac{100b}{a\ +\ b} $ \[%\]です。 また、この問題では、砂糖が全く溶けていない水も濃度 $ 0 $ \[%\] の砂糖水と考えることにします。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ A $ $ B $ $ C $ $ D $ $ E $ $ F $

## 输出格式

整数を空白区切りで $ 2 $ つ出力せよ。 $ 1 $ つ目は求める砂糖水の質量、$ 2 $ つ目はそれに溶けている砂糖の質量とせよ。

## 说明/提示

### 制約

- $ 1\ ≦\ A\ <\ B\ ≦\ 30 $
- $ 1\ ≦\ C\ <\ D\ ≦\ 30 $
- $ 1≦\ E\ ≦\ 100 $
- $ 100A\ ≦\ F\ ≦\ 3,000 $
- $ A,\ B,\ C,\ D,\ E,\ F $ はすべて整数である。

### Sample Explanation 1

この入力例の状況では、水 $ 100 $ \\\[g\\\] あたり砂糖は $ 15 $ \\\[g\\\] 溶けます。 また、ビーカーに物質を $ 200 $ \\\[g\\\] まで入れることができます。 操作 1 と操作 3 を $ 1 $ 回ずつ行うことで $ 110 $ \\\[g\\\] の砂糖水を作ることができます。 また、これ以上濃度の高い砂糖水を作ることはできません。 たとえば、以下のような操作は条件を満たしません。 - 操作 1 と操作 4 を $ 1 $ 回ずつ行うと、ビーカーに砂糖が溶け残ってしまいます。 - 操作 2 を $ 1 $ 回と操作 3 を $ 3 $ 回行うと、ビーカーの中の物質の量が $ 200 $ \\\[g\\\] を超えてしまいます。

### Sample Explanation 2

ほかに、たとえば以下の出力も正解となります。 ``` 400 200 ``` 一方、以下の出力は不正解となります。 ``` 300 150 ``` なぜなら、砂糖が $ 150 $ \\\[g\\\] 溶けた $ 300 $ \\\[g\\\] の砂糖水を作るにはビーカーに水をちょうど $ 150 $ \\\[g\\\] 入れる必要がありますが、そのようなことは不可能だからです。

## 样例 #1

### 输入

```
1 2 10 20 15 200
```

### 输出

```
110 10
```

## 样例 #2

### 输入

```
1 2 1 2 100 1000
```

### 输出

```
200 100
```

## 样例 #3

### 输入

```
17 19 22 26 55 2802
```

### 输出

```
2634 934
```



---

---
title: "[ABC078D] ABS"
layout: "post"
diff: 普及/提高-
pid: AT_arc085_b
tag: []
---

# [ABC078D] ABS

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc078/tasks/arc085_b

$ N $ 枚のカードからなる山札があります。カードにはそれぞれ数が書かれており， 上から $ i $ 枚目には $ a_i $ が書かれています。

この山札を使い，X さんと Y さんが $ 2 $ 人でゲームをします。 X, Y さんは最初，$ Z,\ W $ が書かれたカードを持っています。 そして X さんから交互に以下を行います。

- 山札から何枚かカードを引く。そして今持っているカードを捨て，最後に引いたカードを代わりに持つ。ただし，必ず $ 1 $ 枚は引かなくてはならない。

山札がなくなるとゲームは終了で，$ 2 $ 人の持っているカードに書かれた数の差の絶対値がこのゲームのスコアになります。

X さんはスコアを最大化するように，Y さんはスコアを最小化するようにゲームをプレイした時， スコアはいくつになるでしょうか？

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ Z $ $ W $ $ a_1 $ $ a_2 $ $ ... $ $ a_N $

## 输出格式

求めたスコアを出力してください。

## 说明/提示

### 制約

- 入力は全て整数
- $ 1\ \leq\ N\ \leq\ 2000 $
- $ 1\ \leq\ Z,\ W,\ a_i\ \leq\ 10^9 $

### Sample Explanation 1

X さんが最初に $ 2 $ 枚カードを引くと，次に Y さんが最後のカードを引き，スコアは $ |1000\ -\ 100|\ =\ 900 $ になります。

### Sample Explanation 2

X さんが最初に全てのカードを引くと，スコアは $ |100\ -\ 1000|\ =\ 900 $ になります。

## 样例 #1

### 输入

```
3 100 100

10 1000 100
```

### 输出

```
900
```

## 样例 #2

### 输入

```
3 100 1000

10 100 100
```

### 输出

```
900
```

## 样例 #3

### 输入

```
5 1 1

1 1 1 1 1
```

### 输出

```
0
```

## 样例 #4

### 输入

```
1 1 1

1000000000
```

### 输出

```
999999999
```



---

---
title: "[ABC083D] Wide Flip"
layout: "post"
diff: 普及/提高-
pid: AT_arc088_b
tag: []
---

# [ABC083D] Wide Flip

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc083/tasks/arc088_b

`0` と `1` からなる文字列 $ S $ が与えられます。 以下の操作を好きな回数繰り返すことで $ S $ の要素をすべて `0` にできるような、$ |S| $ 以下の最大の整数 $ K $ を求めてください。

- $ S $ の長さ $ K $ 以上の連続する区間 $ [l,r] $ を選ぶ(すなわち、$ r-l+1\geq\ K $ が満たされる必要がある)。$ l\leq\ i\leq\ r $ なるすべての整数 $ i $ に対し、$ S_i $ が `0` なら $ S_i $ を `1` に、$ S_i $ が `1` なら $ S_i $ を `0` に置き換える。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ S $

## 输出格式

操作を好きな回数繰り返すことで $ S $ の要素をすべて `0` にできるような *最大の* (21:08 JST 修正) 整数 $ K $ を出力せよ。

## 说明/提示

### 制約

- $ 1\leq\ |S|\leq\ 10^5 $
- $ S_i(1\leq\ i\leq\ N) $ は `0` または `1` である

### Sample Explanation 1

以下の操作で、$ S $ の要素をすべて `0` にできます。 - 長さ $ 3 $ の区間 $ [1,3] $ に操作を行う。$ S $ は `101` になる。 - 長さ $ 2 $ の区間 $ [1,2] $ に操作を行う。$ S $ は `011` になる。 - 長さ $ 2 $ の区間 $ [2,3] $ に操作を行う。$ S $ は `000` になる。

## 样例 #1

### 输入

```
010
```

### 输出

```
2
```

## 样例 #2

### 输入

```
100000000
```

### 输出

```
8
```

## 样例 #3

### 输入

```
00001111
```

### 输出

```
4
```



---

---
title: "[ABC090D] Remainder Reminder"
layout: "post"
diff: 普及/提高-
pid: AT_arc091_b
tag: []
---

# [ABC090D] Remainder Reminder

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc090/tasks/arc091_b

高橋君は、$ N $ 以下の正の整数の $ 2 $ つ組 $ (a,b) $ を持っていましたが、忘れてしまいました。 高橋君は、$ a $ を $ b $ で割ったあまりが $ K $ 以上であったことを覚えています。 高橋君が持っていた組としてあるうるものの個数を求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ K $

## 输出格式

高橋君が持っていた組としてあるうるものの個数を出力せよ。

## 说明/提示

### 制約

- $ 1\ \leq\ N\ \leq\ 10^5 $
- $ 0\ \leq\ K\ \leq\ N-1 $
- 入力は全て整数である

### Sample Explanation 1

ありうる組は、$ (2,3),(5,3),(2,4),(3,4),(2,5),(3,5),(4,5) $ の $ 7 $ 組です。

## 样例 #1

### 输入

```
5 2
```

### 输出

```
7
```

## 样例 #2

### 输入

```
10 0
```

### 输出

```
100
```

## 样例 #3

### 输入

```
31415 9265
```

### 输出

```
287927211
```



---

---
title: "[ABC091C] 2D Plane 2N Points"
layout: "post"
diff: 普及/提高-
pid: AT_arc092_a
tag: []
---

# [ABC091C] 2D Plane 2N Points

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc091/tasks/arc092_a

二次元平面に，赤い点と青い点が $ N $ 個ずつあります。 $ i $ 個目の赤い点の座標は $ (a_i,\ b_i) $ で，$ i $ 個目の青い点の座標は $ (c_i,\ d_i) $ です。

赤い点と青い点は，赤い点の $ x $ 座標が青い点の $ x $ 座標より小さく， また赤い点の $ y $ 座標も青い点の $ y $ 座標より小さいとき，仲良しペアになれます。

あなたは最大で何個の仲良しペアを作ることができますか？ ただし，$ 1 $ つの点が複数のペアに所属することはできません。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ a_1 $ $ b_1 $ $ a_2 $ $ b_2 $ $ : $ $ a_N $ $ b_N $ $ c_1 $ $ d_1 $ $ c_2 $ $ d_2 $ $ : $ $ c_N $ $ d_N $

## 输出格式

仲良しペアの個数の最大値を出力せよ。

## 说明/提示

### 制約

- 入力は全て整数
- $ 1\ \leq\ N\ \leq\ 100 $
- $ 0\ \leq\ a_i,\ b_i,\ c_i,\ d_i\ <\ 2N $
- $ a_1,\ a_2,\ ...,\ a_N,\ c_1,\ c_2,\ ...,\ c_N $ はすべて異なる
- $ b_1,\ b_2,\ ...,\ b_N,\ d_1,\ d_2,\ ...,\ d_N $ はすべて異なる

### Sample Explanation 1

例えば， $ (2,\ 0) $ と $ (4,\ 2) $ をペアにし， $ (3,\ 1) $ と $ (5,\ 5) $ をペアにすればよいです。

### Sample Explanation 2

例えば， $ (0,\ 0) $ と $ (2,\ 3) $ をペアにし， $ (1,\ 1) $ と $ (3,\ 4) $ をペアにすればよいです。

### Sample Explanation 3

一つもペアが作れない場合もあります。

## 样例 #1

### 输入

```
3

2 0

3 1

1 3

4 2

0 4

5 5
```

### 输出

```
2
```

## 样例 #2

### 输入

```
3

0 0

1 1

5 2

2 3

3 4

4 5
```

### 输出

```
2
```

## 样例 #3

### 输入

```
2

2 2

3 3

0 0

1 1
```

### 输出

```
0
```

## 样例 #4

### 输入

```
5

0 0

7 3

2 2

4 8

1 6

8 5

6 9

5 4

9 1

3 7
```

### 输出

```
5
```

## 样例 #5

### 输入

```
5

0 0

1 1

5 5

6 6

7 7

2 2

3 3

4 4

8 8

9 9
```

### 输出

```
4
```



---

---
title: "[ABC094D] Binomial Coefficients"
layout: "post"
diff: 普及/提高-
pid: AT_arc095_b
tag: []
---

# [ABC094D] Binomial Coefficients

## 题目描述

从 $n$ 个物品中不考虑顺序地选出 $r$ 个的情况数记为 ${\rm comb}(n, r)$。请从 $n$ 个非负整数 $a _ 1, a _ 2, \ldots, a _ n$ 中选择 $2$ 个数 $a _ i > a _ j$，使得 ${\rm comb}(a _ i, a _ j)$ 最大化。如果有多个组合可以达到最大值，可以选择任意一个。

## 输入格式

输入以以下格式从标准输入中提供：

> $n$  
> $a _ 1$ $a _ 2$ $\ldots$ $a _ n$

## 输出格式

请输出选出的两个数，以空格分隔，并按降序排列。

### 限制条件

- $2 \leq n \leq 10 ^ 5$
- $0 \leq a _ i \leq 10 ^ 9$
- $a _ 1, a _ 2, \ldots, a _ n$ 互不相同
- 所有输入均为整数

### 样例解释 1

逐个计算如下：

- ${\rm comb}(4, 2) = 6$
- ${\rm comb}(6, 2) = 15$
- ${\rm comb}(6, 4) = 15$
- ${\rm comb}(9, 2) = 36$
- ${\rm comb}(9, 4) = 126$
- ${\rm comb}(9, 6) = 84$
- ${\rm comb}(11, 2) = 55$
- ${\rm comb}(11, 4) = 330$
- ${\rm comb}(11, 6) = 462$
- ${\rm comb}(11, 9) = 55$

因此，应输出 $11$ 和 $6$。

---

Translated by User 735713.

## 样例 #1

### 输入

```
5

6 9 4 2 11
```

### 输出

```
11 6
```

## 样例 #2

### 输入

```
2

100 0
```

### 输出

```
100 0
```



---

---
title: "[ABC097C] K-th Substring"
layout: "post"
diff: 普及/提高-
pid: AT_arc097_a
tag: []
---

# [ABC097C] K-th Substring

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc097/tasks/arc097_a

文字列 $ s $ が与えられます。 $ s $ の**異なる** substring のうち、辞書順で $ K $ 番目に小さいものを出力してください。

ただし、$ s $ の substring とは、 $ s $ の空でない連続した部分を取り出してできる文字列とします。 例えば、 $ s $ $ = $ `ababc` とすると、 `a`, `bab`, `ababc` は $ s $ の substring ですが、 `ac`, `z`, 空文字列 は $ s $ の substring ではありません。 また、substring が異なるとは、文字列として異なることを指します。

なお、$ X\ =\ x_{1}x_{2}...x_{n}, $ $ Y\ =\ y_{1}y_{2}...y_{m} $ を二つの異なる文字列とするとき、$ Y $ が $ X $ の接頭辞であるか、$ j $ を $ x_{j}\ \neq\ y_{j} $ であるような最小の整数として $ x_{j}\ >\ y_{j} $ である場合、そしてその場合に限って $ X $ は $ Y $ より辞書順で大きいといいます。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ s $ $ K $

## 输出格式

辞書順で $ K $ 番目に小さい $ s $ の substring を出力せよ。

## 说明/提示

### 制約

- $ 1 $ $ <\ = $ $ |s| $ $ <\ = $ $ 5000 $
- $ s $ は英小文字からなる
- $ 1 $ $ <\ = $ $ K $ $ <\ = $ $ 5 $
- $ s $ は異なる substring を $ K $ 個以上持つ

### 部分点

- $ |s| $ $ <\ = $ $ 50 $ を満たすデータセットに正解した場合は、部分点として $ 200 $ 点が与えられる。

### Sample Explanation 1

$ s $ の substring は `a`, `b`, `ab`, `ba`, `aba` の $ 5 $ つです。 このうち $ 4 $ 番目に小さい `b` を出力してください。 `a` を $ 2 $ 回カウントしないことに注意してください。

## 样例 #1

### 输入

```
aba

4
```

### 输出

```
b
```

## 样例 #2

### 输入

```
atcoderandatcodeer

5
```

### 输出

```
andat
```

## 样例 #3

### 输入

```
z

1
```

### 输出

```
z
```



---

---
title: "[ABC097D] Equals"
layout: "post"
diff: 普及/提高-
pid: AT_arc097_b
tag: []
---

# [ABC097D] Equals

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc097/tasks/arc097_b

$ 1 $ から $ N $ までの整数を並び替えた順列 $ p_1 $, $ p_2 $, .., $ p_N $ があります。 また、 $ 1 $ 以上 $ N $ 以下の整数のペアが $ M $ 個与えられます。 これらは $ (x_1,y_1) $, $ (x_2,y_2) $, .., $ (x_M,y_M) $ で表されます。 シカの AtCoDeer くんは順列 $ p $ に次の操作を好きなだけ行って、 $ p_i\ =\ i $ となる $ i $ ($ 1 $ $ <\ = $ $ i $ $ <\ = $ $ N $) の数を最大にしようと考えています。

- $ 1 $ $ <\ = $ $ j $ $ <\ = $ $ M $ なる $ j $ を選び、 $ p_{x_j} $ と $ p_{y_j} $ をスワップする

操作後の $ p_i\ =\ i $ となる $ i $ の数として考えうる最大値を求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ M $ $ p_1 $ $ p_2 $ $ .. $ $ p_N $ $ x_1 $ $ y_1 $ $ x_2 $ $ y_2 $ $ : $ $ x_M $ $ y_M $

## 输出格式

操作後の $ p_i\ =\ i $ となる $ i $ ($ 1 $ $ <\ = $ $ i $ $ <\ = $ $ N $) の数として考えうる最大値を出力せよ。

## 说明/提示

### 制約

- $ 2 $ $ <\ = $ $ N $ $ <\ = $ $ 10^5 $
- $ 1 $ $ <\ = $ $ M $ $ <\ = $ $ 10^5 $
- $ p $ は $ 1 $ から $ N $ までの整数を並び替えた順列
- $ 1 $ $ <\ = $ $ x_j,y_j $ $ <\ = $ $ N $
- $ x_j $ $ ≠ $ $ y_j $
- $ i $ $ ≠ $ $ j $ なら、 $ \{x_i,y_i\} $ $ ≠ $ $ \{x_j,y_j\} $
- 入力は全て整数

### Sample Explanation 1

$ j=1 $ を選んで操作すると、 $ p $ は `1 3 5 4 2` となり、これがベストなので答えは $ 2 $ です。

### Sample Explanation 2

例えば $ j=1 $, $ j=2 $, $ j=1 $ の順に操作すると、 $ p $ は `1 2 3` となり明らかにこれがベストです。 同じ $ j $ を何回選んでもいいことに注意してください。

### Sample Explanation 4

操作をする必要はありません。

## 样例 #1

### 输入

```
5 2

5 3 1 4 2

1 3

5 4
```

### 输出

```
2
```

## 样例 #2

### 输入

```
3 2

3 2 1

1 2

2 3
```

### 输出

```
3
```

## 样例 #3

### 输入

```
10 8

5 3 6 8 7 10 9 1 2 4

3 1

4 1

5 9

2 5

6 5

3 5

8 9

7 9
```

### 输出

```
8
```

## 样例 #4

### 输入

```
5 1

1 2 3 4 5

1 5
```

### 输出

```
5
```



---

---
title: "[ABC098D] Xor Sum 2"
layout: "post"
diff: 普及/提高-
pid: AT_arc098_b
tag: []
---

# [ABC098D] Xor Sum 2

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc098/tasks/arc098_b

長さ $ N $ の整数列 $ A $ があります。

次の条件を満たす整数 $ l $, $ r $ ( $ 1\ \leq\ l\ \leq\ r\ \leq\ N $ ) の組の個数を求めてください。

- $ A_l\ xor\ A_{l+1}\ xor\ ...\ xor\ A_r\ =\ A_l\ +\ A_{l+1}\ +\ ...\ +\ A_r $

xorの説明

整数 $ c_1,\ c_2,\ ...,\ c_m $ の $ xor $ は以下のように定義されます。

- $ xor $ の値を $ X $ とおく。$ X $ を $ 2 $ 進数表記したときの $ 2^k $ ( $ 0\ \leq\ k $, $ k $ は整数 ) の位の値は、$ c_1,\ c_2,\ ...c_m $ のうち、$ 2 $ 進数表記したときの $ 2^k $ の位の値が $ 1 $ となるものが奇数個ならば $ 1 $、偶数個ならば $ 0 $ となる。

例えば、$ 3 $ と $ 5 $ の $ xor $ の値は、$ 3 $ の $ 2 $ 進数表記が $ 011 $、$ 5 $ の $ 2 $ 進数表記が $ 101 $ のため、$ 2 $ 進数表記が $ 110 $ の $ 6 $ となります。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ A_1 $ $ A_2 $ $ ... $ $ A_N $

## 输出格式

条件を満たす整数 $ l $, $ r $ ( $ 1\ \leq\ l\ \leq\ r\ \leq\ N $ ) の組の個数を出力せよ。

## 说明/提示

### 制約

- $ 1\ \leq\ N\ \leq\ 2\ \times\ 10^5 $
- $ 0\ \leq\ A_i $
- 入力はすべて整数である

### Sample Explanation 1

明らかに、$ (l,r)=(1,1),(2,2),(3,3),(4,4) $ は条件を満たします。 また、$ (l,r)=(1,2) $ の場合、$ A_1\ xor\ A_2\ =\ A_1\ +\ A_2\ =\ 7 $ となるので、これも条件を満たします。 ほかに条件を満たす組はないので、答えは $ 5 $ になります。

## 样例 #1

### 输入

```
4

2 5 4 6
```

### 输出

```
5
```

## 样例 #2

### 输入

```
9

0 0 0 0 0 0 0 0 0
```

### 输出

```
45
```

## 样例 #3

### 输入

```
19

885 8 1 128 83 32 256 206 639 16 4 128 689 32 8 64 885 969 1
```

### 输出

```
37
```



---

---
title: "[ABC101C] Minimization"
layout: "post"
diff: 普及/提高-
pid: AT_arc099_a
tag: []
---

# [ABC101C] Minimization

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc101/tasks/arc099_a

長さ $ N $ の数列 $ A_1,\ A_2,\ ...,\ A_N $ があります．最初，この数列の要素は $ 1,\ 2,\ ...,\ N $ を並び替えたものになっています．

スヌケ君は，この数列に対して次の操作を行うことができます．

- 数列のうち，連続した $ K $ 個の要素を選ぶ．その後，選んだ要素それぞれの値を，選んだ要素の中の最小値で置き換える．

スヌケ君は，上の操作を何回か繰り返すことで，この数列の要素をすべて等しくしたいです． 必要な操作の回数の最小値を求めてください． この問題の制約の下，このようなことは必ず可能であることが証明できます．

## 输入格式

入力は以下の形式で標準入力から与えられる．

> $ N $ $ K $ $ A_1 $ $ A_2 $ $ ... $ $ A_N $

## 输出格式

必要な操作の回数の最小値を出力せよ．

## 说明/提示

### 制約

- $ 2\ \leq\ K\ \leq\ N\ \leq\ 100000 $
- $ A_1,\ A_2,\ ...,\ A_N $ は $ 1,\ 2,\ ...,\ N $ の並び替え

### Sample Explanation 1

例えば，次のようにするとよいです： - $ 1 $ 回目の操作では，$ 1,\ 2,\ 3 $ 番目の要素を選ぶ．すると，数列 $ A $ は $ 1,\ 1,\ 1,\ 4 $ になる． - $ 2 $ 回目の操作では，$ 2,\ 3,\ 4 $ 番目の要素を選ぶ．すると，数列 $ A $ は $ 1,\ 1,\ 1,\ 1 $ になる．

## 样例 #1

### 输入

```
4 3

2 3 1 4
```

### 输出

```
2
```

## 样例 #2

### 输入

```
3 3

1 2 3
```

### 输出

```
1
```

## 样例 #3

### 输入

```
8 3

7 3 1 8 4 6 2 5
```

### 输出

```
4
```



---

---
title: "[ABC107C] Candles"
layout: "post"
diff: 普及/提高-
pid: AT_arc101_a
tag: []
---

# [ABC107C] Candles

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc107/tasks/arc101_a

数直線上に $ N $ 本のろうそくが置かれています。 左から $ i $ 番目のろうそくは座標 $ x_i $ に置かれています。 ただし、$ x_1\ <\ x_2\ <\ ...\ <\ x_N $ が成り立ちます。

最初、どのろうそくにも火が付いていません。 すぬけ君は、$ N $ 本のうち $ K $ 本のろうそくに火を付けることにしました。

今、すぬけ君は座標 $ 0 $ にいます。 すぬけ君は、数直線上を左右に速度 $ 1 $ で移動することができます。 また、自分と同じ座標のろうそくに火を付けることができます。 このとき、火を付けるのに掛かる時間は無視できます。

$ K $ 本のろうそくに火を付けるのに必要な最小の時間を求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ K $ $ x_1 $ $ x_2 $ $ ... $ $ x_N $

## 输出格式

$ K $ 本のろうそくに火を付けるのに必要な最小の時間を出力せよ。

## 说明/提示

### 制約

- $ 1\ \leq\ N\ \leq\ 10^5 $
- $ 1\ \leq\ K\ \leq\ N $
- $ x_i $ は整数である。
- $ |x_i|\ \leq\ 10^8 $
- $ x_1\ <\ x_2\ <\ ...\ <\ x_N $

### Sample Explanation 1

次のように移動しながらろうそくに火を付ければよいです。 - 座標 $ 0 $ から $ -10 $ へ移動する。 - 左から $ 2 $ 番目のろうそくに火を付ける。 - 座標 $ -10 $ から $ 10 $ へ移動する。 - 左から $ 3 $ 番目のろうそくに火を付ける。 - 座標 $ 10 $ から $ 20 $ へ移動する。 - 左から $ 4 $ 番目のろうそくに火を付ける。

### Sample Explanation 3

座標 $ 0 $ にろうそくが置かれていることもあります。

## 样例 #1

### 输入

```
5 3

-30 -10 10 20 50
```

### 输出

```
40
```

## 样例 #2

### 输入

```
3 2

10 20 30
```

### 输出

```
20
```

## 样例 #3

### 输入

```
1 1

0
```

### 输出

```
0
```

## 样例 #4

### 输入

```
8 5

-9 -7 -4 -3 1 2 3 4
```

### 输出

```
10
```



---

---
title: "[ABC108C] Triangular Relationship"
layout: "post"
diff: 普及/提高-
pid: AT_arc102_a
tag: []
---

# [ABC108C] Triangular Relationship

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc108/tasks/arc102_a

整数 $ N,K $ が与えられます。$ N $ 以下の正の整数の組 $ (a,b,c) $ であって、$ a+b,b+c,c+a $ がすべて $ K $ の倍数であるようなものの個数を求めてください。 ただし、$ a,b,c $ の順番を入れ替えただけの組も異なるものとして数えます。また、$ a,b,c $ の中に同じものがあっても構いません。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ K $

## 输出格式

$ N $ 以下の正の整数の組 $ (a,b,c) $ であって、$ a+b,b+c,c+a $ がすべて $ K $ の倍数であるようなものの個数を出力せよ。

## 说明/提示

### 制約

- $ 1\ \leq\ N,K\ \leq\ 2\times\ 10^5 $
- $ N,K $ は整数である

### Sample Explanation 1

$ (1,1,1),(1,1,3),(1,3,1),(1,3,3),(2,2,2),(3,1,1),(3,1,3),(3,3,1),(3,3,3) $ が条件を満たします。

## 样例 #1

### 输入

```
3 2
```

### 输出

```
9
```

## 样例 #2

### 输入

```
5 3
```

### 输出

```
1
```

## 样例 #3

### 输入

```
31415 9265
```

### 输出

```
27
```

## 样例 #4

### 输入

```
35897 932
```

### 输出

```
114191
```



---

---
title: "[ABC111C] /\/\/\/"
layout: "post"
diff: 普及/提高-
pid: AT_arc103_a
tag: []
---

# [ABC111C] /\/\/\/

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc111/tasks/arc103_a

数列 $ a_1,a_2,...\ ,a_n $ が以下の条件を満たすとき、 /\\/\\/\\/ と呼ぶことにします。

- 各 $ i\ =\ 1,2,...,\ n-2 $ について、$ a_i\ =\ a_{i+2} $
- 数列に現れる数はちょうど $ 2 $ 種類

偶数長の数列 $ v_1,v_2,...,v_n $ が与えられます。 要素をいくつか書き換えることでこの数列を /\\/\\/\\/ にしたいです。 書き換える要素の数は最小でいくつになるか求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ n $ $ v_1 $ $ v_2 $ $ ... $ $ v_n $

## 输出格式

書き換える要素数の最小値を出力してください。

## 说明/提示

### 制約

- $ 2\ \leq\ n\ \leq\ 10^5 $
- $ n $ は偶数
- $ 1\ \leq\ v_i\ \leq\ 10^5 $
- $ v_i $ は整数

### Sample Explanation 1

数列 $ 3,1,3,2 $ は /\\\\/\\\\/\\\\/ ではありませんが、$ 1 $ 要素書き換えることで /\\\\/\\\\/\\\\/ にすることができます。 例えば、$ 4 $ 要素目を書き換えて $ 3,1,3,1 $ とすればよいです。

### Sample Explanation 2

数列 $ 105,119,105,119,105,119 $ は /\\\\/\\\\/\\\\/ です。

### Sample Explanation 3

数列 $ 1,1,1,1 $ は $ 1 $ 種類の数からなる数列であるため、 /\\\\/\\\\/\\\\/ ではありません。

## 样例 #1

### 输入

```
4

3 1 3 2
```

### 输出

```
1
```

## 样例 #2

### 输入

```
6

105 119 105 119 105 119
```

### 输出

```
0
```

## 样例 #3

### 输入

```
4

1 1 1 1
```

### 输出

```
2
```



---

---
title: "[ARC106B] Values"
layout: "post"
diff: 普及/提高-
pid: AT_arc106_b
tag: []
---

# [ARC106B] Values

## 题目描述

有一个由 $N$ 顶点和 $M$ 边构成的简单无向图。第 $i$ 条边连接顶点 $c_i$ 和顶点 $d_i$。

开始时，顶点 $i$ 的值为 $a_i$。您希望通过执行以下操作(至少一次)，使操作后的每个顶点的值分别为 $b_1,b_2,⋯⋯,b_N$。

您每次可选 $1$ 条边。当选择的边连接顶点 $x$ 和顶点 $y$ 时，可进行以下任意一个操作。

让 $a_x-1,a_y+1$，或者让 $a_x+1,a_y-1$

确定是否有操作可以达到您的目的。

## 输入格式

第 $1$ 行：输入 $N,M$。

第 $2$ 行输入 $N$ 个数，$a_1,a_2,⋯⋯,a_N$。
第 3 行输入 $M$ 个数，$b_1,b_2,⋯⋯,b_M$。
第 4 至 $M+3$ 行，每行输入 $2$ 个数，$c_i,d_i$。

## 输出格式

如果可以，输出 "Yes"，否则，输出 "No"。

## 样例 #1

### 输入

```
3 2

1 2 3

2 2 2

1 2

2 3
```

### 输出

```
Yes
```

## 样例 #2

### 输入

```
1 0

5

5
```

### 输出

```
Yes
```

## 样例 #3

### 输入

```
2 1

1 1

2 1

1 2
```

### 输出

```
No
```

## 样例 #4

### 输入

```
17 9

-905371741 -999219903 969314057 -989982132 -87720225 -175700172 -993990465 929461728 895449935 -999016241 782467448 -906404298 578539175 9684413 -619191091 -952046546 125053320

-440503430 -997661446 -912471383 -995879434 932992245 -928388880 -616761933 929461728 210953513 -994677396 648190629 -530944122 578539175 9684413 595786809 -952046546 125053320

2 10

6 12

9 11

11 5

7 6

3 15

3 1

1 9

10 4
```

### 输出

```
Yes
```



---

---
title: "[ARC106C] Solutions"
layout: "post"
diff: 普及/提高-
pid: AT_arc106_c
tag: []
---

# [ARC106C] Solutions

## 题目描述

[problemUrl]: https://atcoder.jp/contests/arc106/tasks/arc106_c

$ 2 $ つの区間 $ [L_1:R_1],\ [L_2:R_2] $ について, $ L_1\ \leq\ R_2 $ かつ $ L_2\ \leq\ R_1 $ であるとき, この $ 2 $ つの区間が*交わる*と定義します。

以下の問題 $ P $ を考えます。

> 入力: $ N $ 個の区間 $ [L_1:\ R_1],\ \cdots,\ [L_N:R_N] $ $ L_1,\ L_2,\ \cdots,\ L_N,\ R_1,\ R_2,\ \cdots,\ R_N $は全て異なる。 出力: どの $ 2 $ つの区間も交わらないように選べる区間の最大数

高橋君は、以下のように動作するプログラムを実装しました。

> $ R_i $ の値が昇順となるように, 入力された区間を $ [L_{p_1}:R_{p_1}],\ [L_{p_2}:R_{p_2}],\ \cdots\ ,\ [L_{p_N}:R_{p_N}] $ と並び替える。 $ i\ =\ 1,\ 2,\ \cdots\ ,\ N $ について、以下を行う。 これまでに選んだどの区間とも交わらないならば、 $ [L_{p_i}:R_{p_i}] $ を選ぶ。 選んだ区間の数を出力する。

一方、青木君は、以下のように動作するプログラムを実装しました。

> $ L_i $ の値が昇順となるように, 入力された区間を $ [L_{p_1}:R_{p_1}],\ [L_{p_2}:R_{p_2}],\ \cdots\ ,\ [L_{p_N}:R_{p_N}] $ と並び替える。 $ i\ =\ 1,\ 2,\ \cdots\ ,\ N $ について、以下を行う。 これまでに選んだどの区間とも交わらないならば、 $ [L_{p_i}:R_{p_i}] $ を選ぶ。 選んだ区間の数を出力する。

整数 $ N,\ M $が与えられます。 $ N $ 個の区間から成る問題 $ P $ の入力であって、

$ $

(高橋君のプログラムが出力する値)\ -\ (青木君のプログラムが出力する値)\ =\ M $$

となるものを構築してください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ M $

## 输出格式

条件を満たす $ N $ 個の区間が存在しない場合は `-1` と出力せよ。

存在する場合は、 以下のように $ N $ 行出力せよ。

> $ L_1 $ $ R_1 $ $ L_2 $ $ R_2 $ $ \vdots $ $ L_N $ $ R_N $

ただし, $ [L_1:R_1],\ \cdots,\ [L_N:R_N] $は以下の条件を満たさなければならない。

- $ 1\ \leq\ L_i\ <\ R_i\ \leq\ 10^9 $
- $ L_i\ \neq\ L_j $ ($ i\ \neq\ j $)
- $ R_i\ \neq\ R_j $ ($ i\ \neq\ j $)
- $ L_i\ \neq\ R_j $
- $ L_1,\ \cdots\ ,\ L_N\ ,\ R_1,\ \cdots\ ,\ R_N $ は整数 (21:46 追記)

答えが複数存在する場合は、どれを出力しても構わない。

出力の最後には必ず改行を行うこと。

## 说明/提示

### 制約

- 入力は全て整数
- $ 1\ \leq\ N\ \leq\ 2\ \times\ 10^5 $
- $ -N\ \leq\ M\ \leq\ N $

### Sample Explanation 1

$ 5 $ つの区間を順に区間 $ 1 $ 、区間 $ 2 $ 、$ \cdots $ 、区間 $ 5 $ と名付けます。 高橋君のプログラムは以下のように動作します。 &gt; 区間を区間 $ 5 $ 、区間 $ 1 $ 、区間 $ 2 $ 、区間 $ 4 $ 、区間 $ 3 $ と並び替えます。 区間 $ 5 $ を選びます。 区間 $ 1 $ は選びません。(区間 $ 5 $ と交わっている為) 区間 $ 2 $ を選びます。 区間 $ 4 $ は選びません。 (区間 $ 2 $ と交わっている為) 区間 $ 3 $ を選びます。 以上より、高橋君のプログラムが出力する値は $ 3 $ となります。 青木君のプログラムは以下のように動作します。 &gt; 区間を区間 $ 1 $ 、区間 $ 5 $ 、区間 $ 2 $ 、区間 $ 4 $ 、区間 $ 3 $ と並び替えます。 区間 $ 1 $ を選びます。 区間 $ 5 $ は選びません。(区間 $ 1 $ と交わっている為) 区間 $ 2 $ は選びません。 (区間 $ 1 $ と交わっている為) 区間 $ 4 $ を選びます。 区間 $ 3 $ は選びません。 (区間 $ 4 $ と交わっている為) 以上より、青木君のプログラムが出力する値は $ 2 $ となります。 このとき、 $ 3\ -\ 2\ =\ 1\ \left(=\ M\ \right) $ であり、この $ 5 $ つの区間は条件を満たします。

## 样例 #1

### 输入

```
5 1
```

### 输出

```
1 10

8 12

13 20

11 14

2 4
```

## 样例 #2

### 输入

```
10 -10
```

### 输出

```
-1
```



---

---
title: "[ARC109C] Large RPS Tournament"
layout: "post"
diff: 普及/提高-
pid: AT_arc109_c
tag: []
---

# [ARC109C] Large RPS Tournament

## 题目描述

[problemUrl]: https://atcoder.jp/contests/arc109/tasks/arc109_c

最強のじゃんけんの手を決めるため、トーナメント形式のじゃんけん大会が開催されます。 大会の参加者は $ 2^k $ 人で、それぞれ $ 0 $ 以上 $ 2^k $ 未満の整数が振られています。どの参加者もそれぞれ得意な手を持っていて、毎試合得意な手のみを出します。

参加者の得意な手は、長さ $ n $ の `R`, `P`, `S` からなる文字列 $ s $ によって表されます。 具体的には、番号 $ i $ の参加者の得意な手は $ s $ の $ (i\text{\ mod\ }\ n)\ +\ 1 $ 文字目の文字で表されます。ここで、`R` はグー、`P` はパー、`S` はチョキを表します。

$ r-l $ が $ 2 $ のべき乗であるような $ l,\ r $ について、番号が $ l $ 以上 $ r $ 未満の参加者による大会を開いたとき、勝者は次のようにして決定されます。

- $ r-l=1 $ であるとき（つまり、参加者がただ一人であるとき）、勝者は $ l $ とする。
- $ r-l\geq\ 2 $ であるとき、$ m=(l+r)/2 $ として、$ l $ 以上 $ m $ 未満の参加者による大会と、$ m $ 以上 $ r $ 未満の参加者による大会を開催する。それぞれの勝者が $ a,\ b $ であるとき、$ a $ と $ b $ がじゃんけんをして勝ったほうを勝者とする。あいこの場合 $ a $ を勝者とする。

番号が $ 0 $ 以上 $ 2^k $ 未満の参加者による大会の勝者の得意な手を求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ n $ $ k $ $ s $

## 输出格式

大会の勝者の得意な手を `R` か `P` か `S` で出力せよ。

## 说明/提示

### 注意

- $ a\text{\ mod\ }\ b $ は $ a $ を $ b $ で割ったあまりを表す
- じゃんけんの勝敗は次のように決められる
  - 同じ手同士はあいこである
  - `R` は `S` に勝つ
  - `P` は `R` に勝つ
  - `S` は `P` に勝つ

### 制約

- $ 1\ \leq\ n,k\ \leq\ 100 $
- $ s $ は `R`, `P`, `S` のみからなる長さ $ n $ の文字列

### Sample Explanation 1

\- 番号が $ 0 $ 以上 $ 2 $ 未満の参加者による大会の勝者の得意な手は `P` です。 - 番号が $ 2 $ 以上 $ 4 $ 未満の参加者による大会の勝者の得意な手は `R` です。 - 番号が $ 0 $ 以上 $ 4 $ 未満の参加者による大会の勝者の得意な手は `P` です。 よって、答えは `P` となります。 ``` P ┌─┴─┐ P R ┌┴┐ ┌┴┐ R P S R ```

## 样例 #1

### 输入

```
3 2

RPS
```

### 输出

```
P
```

## 样例 #2

### 输入

```
11 1

RPSSPRSPPRS
```

### 输出

```
P
```

## 样例 #3

### 输入

```
1 100

S
```

### 输出

```
S
```



---

---
title: "[ARC110C] Exoswap"
layout: "post"
diff: 普及/提高-
pid: AT_arc110_c
tag: []
---

# [ARC110C] Exoswap

## 题目描述

[problemUrl]: https://atcoder.jp/contests/arc110/tasks/arc110_c

$ 1,\ 2,\ \ldots,\ N $ を並び替えた数列 $ P\ =\ P_1,\ P_2,\ \ldots,\ P_N $ があります。

あなたは $ P $ に対して、以下の $ N\ -\ 1 $ 種類の操作を、任意の順番で**ちょうど $ 1 $ 回ずつ**行わなければなりません。

- $ P_1 $ と $ P_2 $ を入れ替える
- $ P_2 $ と $ P_3 $ を入れ替える
  
  $ \vdots $
- $ P_{N\ -\ 1} $ と $ P_N $ を入れ替える

操作の順番を適切に決めることで、$ P $ を昇順に並び替えてください。 もしそれが不可能な場合、`-1` を出力してください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ P_1 $ $ P_2 $ $ \ldots $ $ P_N $

## 输出格式

どのような順番で操作しても $ P $ を昇順に並び替えることができない場合、`-1` を出力せよ。

$ P $ を昇順に並び替えることができる場合、そのような操作列を $ N\ -\ 1 $ 行使って出力せよ。 $ i\ ~\ (1\ \leq\ i\ \leq\ N\ -\ 1) $ 行目には、$ i $ 回目の操作で $ P_j $ と $ P_{j\ +\ 1} $ を入れ替えるとして、$ j $ を出力せよ。

$ P $ を昇順に並び替える操作列が複数存在する場合、どれを出力しても構わない。

## 说明/提示

### 制約

- 入力は全て整数
- $ 2\ \leq\ N\ \leq\ 2\ \times\ 10^5 $
- $ P $ は $ 1,\ 2,\ \ldots,\ N $ を並び替えた数列

### Sample Explanation 1

以下のような操作列が $ P $ を昇順に並び替えます。 - まず $ P_4 $ と $ P_5 $ を入れ替える。$ P $ は $ 2,\ 4,\ 1,\ 3,\ 5 $ になる - 次に $ P_2 $ と $ P_3 $ を入れ替える。$ P $ は $ 2,\ 1,\ 4,\ 3,\ 5 $ になる - 次に $ P_3 $ と $ P_4 $ を入れ替える。$ P $ は $ 2,\ 1,\ 3,\ 4,\ 5 $ になる - 次に $ P_1 $ と $ P_2 $ を入れ替える。$ P $ は $ 1,\ 2,\ 3,\ 4,\ 5 $ になる

## 样例 #1

### 输入

```
5

2 4 1 5 3
```

### 输出

```
4

2

3

1
```

## 样例 #2

### 输入

```
5

5 4 3 2 1
```

### 输出

```
-1
```



---

---
title: "[ARC111A] Simple Math 2"
layout: "post"
diff: 普及/提高-
pid: AT_arc111_a
tag: []
---

# [ARC111A] Simple Math 2

## 题目描述

[problemUrl]: https://atcoder.jp/contests/arc111/tasks/arc111_a

正整数 $ N,\ M $ が与えられます。$ \lfloor\ \frac{10^N}{M}\ \rfloor $ を $ M $ で割った余りを求めてください。

  $ \lfloor\ x\ \rfloor $ について $ \lfloor\ x\ \rfloor $ は、 $ x $ を超えない最大の整数を表します。例としては次のようになります。 - $ \lfloor\ 2.5\ \rfloor\ =\ 2 $
- $ \lfloor\ 3\ \rfloor\ =\ 3 $
- $ \lfloor\ 9.9999999\ \rfloor\ =\ 9 $
- $ \lfloor\ \frac{100}{3}\ \rfloor\ =\ \lfloor\ 33.33...\ \rfloor\ =\ 33 $

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ M $

## 输出格式

答えを出力せよ。

## 说明/提示

### 制約

- $ 1\ \leq\ N\ \leq\ 10^{18} $
- $ 1\ \leq\ M\ \leq\ 10000 $

### Sample Explanation 1

$ \lfloor\ \frac{10^1}{2}\ \rfloor\ =\ 5 $ なので、$ 5 $ を $ 2 $ で割った余りの $ 1 $ を出力します。

## 样例 #1

### 输入

```
1 2
```

### 输出

```
1
```

## 样例 #2

### 输入

```
2 7
```

### 输出

```
0
```

## 样例 #3

### 输入

```
1000000000000000000 9997
```

### 输出

```
9015
```



---

---
title: "[ARC112B] -- - B"
layout: "post"
diff: 普及/提高-
pid: AT_arc112_b
tag: []
---

# [ARC112B] -- - B

## 题目描述

[problemUrl]: https://atcoder.jp/contests/arc112/tasks/arc112_b

すぬけくんは、整数 $ B $ を持って整数やさんを訪れました。 整数やさんでは、お金を払うことで、持っている整数を別の整数にしてもらうことができます。

具体的には、次の $ 2 $ 種類のサービスを好きな順で好きなだけ購入することができます。

- $ 1 $ 円を払い、持っている整数を $ -1 $ 倍する。
- $ 2 $ 円を払い、持っている整数から $ 1 $ を引く。

すぬけくんが $ C $ 円以内で作ることのできる整数は何通りありますか？

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ B $ $ C $

## 输出格式

答えを出力せよ。

## 说明/提示

### 制約

- $ -10^{18}\le\ B\ \le\ 10^{18} $
- $ 1\le\ C\ \le\ 10^{18} $
- 入力はすべて整数

### Sample Explanation 1

以下のように、$ -11,10,11 $ の $ 3 $ 通りの数を作ることができます。 - 何もしないとき、$ 0 $ 円を使って $ 11 $ を作ることができる - $ 11 $ を $ -1 $ 倍すると、$ 1 $ 円を使って $ -11 $ を作ることができる - $ 11 $ から $ 1 $ を引くと、$ 2 $ 円を使って $ 10 $ を作ることができる

### Sample Explanation 2

以下のように、$ -2,-1,0,1 $ の $ 4 $ 通りの数を作ることができます。 - 何もしないとき、$ 0 $ 円を使って $ 0 $ を作ることができる - $ 0 $ から $ 1 $ を引くと、$ 2 $ 円を使って $ -1 $ を作ることができる - $ 0 $ から $ 1 $ を引いて $ -1 $ 倍すると、$ 3 $ 円を使って $ 1 $ を作ることができる - $ 0 $ から $ 1 $ を引いて $ 1 $ を引くと、$ 4 $ 円を使って $ -2 $ を作ることができる

## 样例 #1

### 输入

```
11 2
```

### 输出

```
3
```

## 样例 #2

### 输入

```
0 4
```

### 输出

```
4
```

## 样例 #3

### 输入

```
112 20210213
```

### 输出

```
20210436
```

## 样例 #4

### 输入

```
-211 1000000000000000000
```

### 输出

```
1000000000000000422
```



---

---
title: "[ARC113C] String Invasion"
layout: "post"
diff: 普及/提高-
pid: AT_arc113_c
tag: []
---

# [ARC113C] String Invasion

## 题目描述

[problemUrl]: https://atcoder.jp/contests/arc113/tasks/arc113_c

長さ $ N $ の文字列 $ S $ が与えられます。$ S $ の $ i $ 文字目を $ s_i $ で表します。以下の操作を繰り返せる回数の最大値を求めてください。

- 連続する $ 3 $ 文字 $ s_i,s_{i+1},s_{i+2}\quad\ (1\leq\ i\leq\ |S|-2) $ であって、$ s_i=s_{i+1}\neq\ s_{i+2} $ であるものを選ぶ。$ s_{i+2} $ を $ s_i $ で置き換える。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ S $

## 输出格式

操作を繰り返せる回数の最大値を出力せよ。

## 说明/提示

### 制約

- $ 3\ \leq\ |S|\ \leq\ 2\times\ 10^5 $
- $ S $ は英小文字からなる

### Sample Explanation 1

以下のように $ 3 $ 回の操作を行うことができます。 - $ i=2 $ に対して操作を行う。操作後の文字列は `acccpt` になる。 - $ i=3 $ に対して操作を行う。操作後の文字列は `acccct` になる。 - $ i=4 $ に対して操作を行う。操作後の文字列は `accccc` になる。

## 样例 #1

### 输入

```
accept
```

### 输出

```
3
```

## 样例 #2

### 输入

```
atcoder
```

### 输出

```
0
```

## 样例 #3

### 输入

```
anerroroccurred
```

### 输出

```
16
```



---

---
title: "[ARC114A] Not coprime"
layout: "post"
diff: 普及/提高-
pid: AT_arc114_a
tag: []
---

# [ARC114A] Not coprime

## 题目描述

[problemUrl]: https://atcoder.jp/contests/arc114/tasks/arc114_a

$ N $ 個の $ 2 $ 以上 $ 50 $ 以下の整数 $ X_1,\ X_2,\ \cdots,\ X_N $ が与えられます．全ての $ i\ =\ 1,\ 2,\ \cdots,\ N $ について次の条件を満たす正の整数 $ Y $ のうち，最小のものを求めてください．

- $ X_i $ と $ Y $ は互いに素でない

## 输入格式

入力は以下の形式で標準入力から与えられる．

> $ N $ $ X_1 $ $ X_2 $ $ \ldots $ $ X_N $

## 输出格式

条件を満たす最小の正の整数を出力せよ．

## 说明/提示

### 制約

- $ 1\ \leq\ N\ \leq\ 49 $
- $ 2\ \leq\ X_i\ \leq\ 50 $
- $ X_i\ \neq\ X_j\ (i\ \neq\ j) $
- 入力は全て整数

### Sample Explanation 1

$ 4 $ と互いに素でないためには偶数である必要があり，$ 3 $ と互いに素でないためには $ 3 $ の倍数である必要があります．

## 样例 #1

### 输入

```
2

4 3
```

### 输出

```
6
```

## 样例 #2

### 输入

```
1

47
```

### 输出

```
47
```

## 样例 #3

### 输入

```
7

3 4 6 7 8 9 10
```

### 输出

```
42
```



---

---
title: "[ARC114B] Special Subsets"
layout: "post"
diff: 普及/提高-
pid: AT_arc114_b
tag: []
---

# [ARC114B] Special Subsets

## 题目描述

[problemUrl]: https://atcoder.jp/contests/arc114/tasks/arc114_b

$ 1 $ 以上 $ N $ 以下の整数すべてから成る集合を $ S $ とします．

$ f $ は $ S $ から $ S $ への関数であり，$ f(1),\ f(2),\ \cdots,\ f(N) $ の値が $ f_1,\ f_2,\ \cdots,\ f_N $ として与えられます．

$ S $ の空でない部分集合 $ T $ であって，次の両方の条件を満たすものの個数を $ 998244353 $ で割った余りを求めてください．

- 全ての $ a\ \in\ T $ について $ f(a)\ \in\ T $ である．
- 全ての $ a,\ b\ \in\ T $ について $ a\ \neq\ b $ ならば $ f(a)\ \neq\ f(b) $ である．

## 输入格式

入力は以下の形式で標準入力から与えられる．

> $ N $ $ f_1 $ $ f_2 $ $ \ldots $ $ f_N $

## 输出格式

$ S $ の空でない部分集合であって，両方の条件を満たすものの個数を $ 998244353 $ で割った余りを出力せよ．

## 说明/提示

### 制約

- $ 1\ \leq\ N\ \leq\ 2\ \times\ 10^5 $
- $ 1\ \leq\ f_i\ \leq\ N $
- 入力は全て整数

### Sample Explanation 1

$ f(1)\ =\ 2,\ f(2)\ =\ 1 $ です．$ f(1)\ \neq\ f(2) $ であるため条件の $ 2 $ つ目は常に満たしますが，$ 1 $ つ目の条件より $ 1,\ 2 $ は同時に $ T $ に入っている必要があります．

### Sample Explanation 2

$ f(1)\ =\ f(2)\ =\ 1 $ です．$ 1 $ つ目の条件のため $ 1 $ は $ T $ に属する必要があり，さらに $ 2 $ つ目の条件により $ 2 $ は $ T $ に属することはできません．

### Sample Explanation 3

$ f(1)\ =\ 1,\ f(2)\ =\ 2,\ f(3)\ =\ 3 $ です．$ 1 $ つ目の条件も $ 2 $ つ目の条件も常に満たされるため，$ S $ の空でない部分集合全てが条件を満たします．

## 样例 #1

### 输入

```
2

2 1
```

### 输出

```
1
```

## 样例 #2

### 输入

```
2

1 1
```

### 输出

```
1
```

## 样例 #3

### 输入

```
3

1 2 3
```

### 输出

```
7
```



---

---
title: "[ARC115C] ℕ Coloring"
layout: "post"
diff: 普及/提高-
pid: AT_arc115_c
tag: []
---

# [ARC115C] ℕ Coloring

## 题目描述

[problemUrl]: https://atcoder.jp/contests/arc115/tasks/arc115_c

整数 $ N $ が与えられます。以下の条件を満たす長さ $ N $ の正の整数の列 $ A_1,A_2,\ldots,A_N $ であって、数列に現れる値の最大値が最小になるものを一つ出力してください。

- $ i $ が $ j $ の約数ならば、$ A_i\ \neq\ A_j $ $ (1\ \leq\ i\ <\ j\ \leq\ N) $

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $

## 输出格式

数列の各要素を空白で区切って一行に出力せよ。

条件を満たす解が複数存在する場合は、どれを出力してもよい。

> $ A_1 $ $ A_2 $ $ \ldots $ $ A_N $

## 说明/提示

### 制約

- $ 1\ \leq\ N\ \leq\ 10^5 $

### Sample Explanation 1

この出力は以下の条件をすべて満たします。 - $ A_1\ \neq\ A_2 $ - $ A_1\ \neq\ A_3 $ - $ A_1\ \neq\ A_4 $ - $ A_2\ \neq\ A_4 $ また、登場する値の最大値が $ 2 $ 以下である数列であって、これらの条件をすべて満たすものは存在しないので、この出力は適当です。

## 样例 #1

### 输入

```
4
```

### 输出

```
1 2 2 3
```



---

---
title: "[ARC116B] Products of Min-Max"
layout: "post"
diff: 普及/提高-
pid: AT_arc116_b
tag: []
---

# [ARC116B] Products of Min-Max

## 题目描述

[problemUrl]: https://atcoder.jp/contests/arc116/tasks/arc116_b

長さ $ N $ の整数列 $ A $ が与えられます。$ A $ の空でない部分列 $ B $ は $ 2^N\ -\ 1 $ 個あります。これらについて $ \max\left(B\right)\ \times\ \min\left(B\right) $ の値を計算し、その総和を答えてください。

ただし、答えは非常に大きくなる場合があるので、 $ 998244353 $ で割った余りを答えてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ A_1 $ $ A_2 $ $ \cdots $ $ A_N $

## 输出格式

答えを出力せよ。

## 说明/提示

### 制約

- 入力は全て整数
- $ 1\ \leq\ N\ \leq\ 2\ \times\ 10^5 $
- $ 0\ \leq\ A_i\ \leq\ 998244352 $

### Sample Explanation 1

$ B $ として、以下の $ 7 $ つが考えられます。 - $ B\ =\ \left(2\right) $ : $ \max\left(B\right)\ \times\ \min\left(B\right)\ =\ 4 $ - $ B\ =\ \left(4\right) $ : $ \max\left(B\right)\ \times\ \min\left(B\right)\ =\ 16 $ - $ B\ =\ \left(3\right) $ : $ \max\left(B\right)\ \times\ \min\left(B\right)\ =\ 9 $ - $ B\ =\ \left(2,\ 4\right) $ : $ \max\left(B\right)\ \times\ \min\left(B\right)\ =\ 8 $ - $ B\ =\ \left(2,\ 3\right) $ : $ \max\left(B\right)\ \times\ \min\left(B\right)\ =\ 6 $ - $ B\ =\ \left(4,\ 3\right) $ : $ \max\left(B\right)\ \times\ \min\left(B\right)\ =\ 12 $ - $ B\ =\ \left(2,\ 4,\ 3\right) $ : $ \max\left(B\right)\ \times\ \min\left(B\right)\ =\ 8 $ 以上の $ 7 $ つの値を足した値 $ 63 $ が答えです。

## 样例 #1

### 输入

```
3

2 4 3
```

### 输出

```
63
```

## 样例 #2

### 输入

```
1

10
```

### 输出

```
100
```

## 样例 #3

### 输入

```
7

853983 14095 543053 143209 4324 524361 45154
```

### 输出

```
206521341
```



---

---
title: "[ARC118B] Village of M People"
layout: "post"
diff: 普及/提高-
pid: AT_arc118_b
tag: []
---

# [ARC118B] Village of M People

## 题目描述

[problemUrl]: https://atcoder.jp/contests/arc118/tasks/arc118_b

ARC 国には $ N $ 人の国民がおり、全国民が競技プログラミングのプレイヤーです。各国民にはその競技プログラミングの実力によって、$ 1,\ 2,\ \ldots,\ K $ のいずれかひとつの段位が与えられています。

ARC 国では国勢調査が行われて、その結果、段位 $ i $ の国民はちょうど $ A_i $ 人居ることが分かりました。ARC 国の国王はこの統計データをより理解しやすい形にするために、なるべく各段位の人数の割合を保ったまま、ARC 国の状況を $ M $ 人の村に例えることにしました。

$ M $ 人の村における段位 $ i $ の村民の人数 $ B_i $ を上手く定めることで、$ \max_i\left|\frac{B_i}{M}\ -\ \frac{A_i}{N}\right| $ を最小にしてください。ただし、次が成り立つ必要があります。

- 各 $ B_i $ は非負整数で、$ \sum_{i=1}^K\ B_i\ =\ M $ を満たす

そのような $ B\ =\ (B_1,\ B_2,\ \ldots,\ B_K) $ の定め方を、ひとつ出力してください。

## 输入格式

入力は以下の形式で標準入力から与えられます。

> $ K $ $ N $ $ M $ $ A_1 $ $ A_2 $ $ \ldots $ $ A_K $

## 输出格式

条件を満たす整数列 $ B $ の各要素を、空白で区切って $ 1 $ 行で出力してください。

> $ B_1 $ $ B_2 $ $ \ldots $ $ B_K $

条件を満たす整数列が複数存在する場合は、どれを出力しても正解となります。

## 说明/提示

### 制約

- $ 1\leq\ K\leq\ 10^5 $
- $ 1\leq\ N,\ M\leq\ 10^9 $
- 各 $ A_i $ は非負整数で、$ \sum_{i=1}^K\ A_i\ =\ N $ を満たす

### Sample Explanation 1

この出力において、$ \max_i\left|\frac{B_i}{M}\ -\ \frac{A_i}{N}\right|\ =\ \max\left(\left|\frac{3}{20}-\frac{1}{7}\right|,\ \left|\frac{6}{20}-\frac{2}{7}\right|,\ \left|\frac{11}{20}-\frac{4}{7}\right|\right)\ =\ \max\left(\frac{1}{140},\ \frac{1}{70},\ \frac{3}{140}\right)\ =\ \frac{3}{140} $ となっています。

### Sample Explanation 2

和を $ M\ =\ 100 $ にしなければならないので、$ B_1\ =\ B_2\ =\ B_3\ =\ 33 $ では 条件が満たされないことに注意してください。 なおこの例においては、`34 33 33` の他、`33 34 33` や `33 33 34` という出力も正解となります。

## 样例 #1

### 输入

```
3 7 20

1 2 4
```

### 输出

```
3 6 11
```

## 样例 #2

### 输入

```
3 3 100

1 1 1
```

### 输出

```
34 33 33
```

## 样例 #3

### 输入

```
6 10006 10

10000 3 2 1 0 0
```

### 输出

```
10 0 0 0 0 0
```

## 样例 #4

### 输入

```
7 78314 1000

53515 10620 7271 3817 1910 956 225
```

### 输出

```
683 136 93 49 24 12 3
```



---

---
title: "[ARC118C] Coprime Set"
layout: "post"
diff: 普及/提高-
pid: AT_arc118_c
tag: []
---

# [ARC118C] Coprime Set

## 题目描述

[problemUrl]: https://atcoder.jp/contests/arc118/tasks/arc118_c

正の整数 $ N $ が与えられます。整数列 $ A\ =\ (A_1,\ A_2,\ \ldots,\ A_N) $ であって、次の条件をすべて満たすものをひとつ出力してください。

- $ 1\leq\ A_i\leq\ 10000 $
- $ i\neq\ j $ に対して、$ A_i\neq\ A_j $ かつ $ \gcd(A_i,\ A_j)\ >\ 1 $
- $ \gcd(A_1,\ A_2,\ \ldots,\ A_N)\ =\ 1 $

なお、この問題の制約のもとで、条件を満たす整数列が存在することが証明できます。

## 输入格式

入力は以下の形式で標準入力から与えられます。

> $ N $

## 输出格式

条件を満たす整数列 $ A $ の各要素を、空白で区切って $ 1 $ 行で出力してください。

> $ A_1 $ $ A_2 $ $ \ldots $ $ A_N $

条件を満たす整数列が複数存在する場合は、どれを出力しても正解となります。

## 说明/提示

### 制約

- $ 3\leq\ N\leq\ 2500 $

### Sample Explanation 1

\- $ \gcd(84,60)\ =\ 12 $ - $ \gcd(84,105)\ =\ 21 $ - $ \gcd(84,70)\ =\ 14 $ - $ \gcd(60,105)\ =\ 15 $ - $ \gcd(60,70)\ =\ 10 $ - $ \gcd(105,70)\ =\ 35 $ - $ \gcd(84,60,105,70)\ =\ 1 $ が成り立ち、すべての条件が満たされていることが確認できます。

## 样例 #1

### 输入

```
4
```

### 输出

```
84 60 105 70
```



---

---
title: "[ARC119B] Electric Board"
layout: "post"
diff: 普及/提高-
pid: AT_arc119_b
tag: []
---

# [ARC119B] Electric Board

## 题目描述

[problemUrl]: https://atcoder.jp/contests/arc119/tasks/arc119_b

いま、電光掲示板に `0` と `1` から成る長さ $ N $ の文字列 $ S $ が表示されています。

あなたは次の操作を何回でも行うことができます。なお、ここでは電光掲示板に表示されている文字列の $ i $ $ (1\ \leq\ i\ \leq\ N) $ 文字目を $ S_i $ と表します。

> **操作** 整数 $ (l,\ r) $ $ (1\ \leq\ l\ <\ r\ \leq\ N) $ であって、次の条件のうちいずれかを満たすものを $ 1 $ 組選び、$ S_l $ と $ S_r $ を入れ替える。
> 
> - $ S_l= $ `0` かつ $ S_{l+1}=\cdots=S_r= $ `1` を満たす。
> - $ S_{l}=\cdots=S_{r-1}= $ `1` かつ $ S_r= $ `0` を満たす。

電光掲示板に表示されている文字列を $ T $ に一致させることができるか判定し、可能な場合は操作回数として考えられる最小の値を求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられます。

> $ N $ $ S $ $ T $

## 输出格式

電光掲示板に表示されている文字列を $ T $ にすることが不可能な場合は、`-1` を出力してください。

可能な場合は、操作回数として考えられる最小の値を出力してください。

## 说明/提示

### 制約

- $ 2\ \leq\ N\ \leq\ 500000 $
- $ S $ は `0` と `1` からなる長さ $ N $ の文字列である
- $ T $ は `0` と `1` からなる長さ $ N $ の文字列である

### Sample Explanation 1

例えば以下のように操作を行えば、$ 2 $ 回の操作で電光掲示板に表示されている文字列を `1010111` にすることができます。 - $ (l,\ r)\ =\ (2,\ 4) $ を選んで操作を行う。そのとき、電光掲示板の文字列は `1110110` から `1011110` に変化する。 - $ (l,\ r)\ =\ (4,\ 7) $ を選んで操作を行う。そのとき、電光掲示板の文字列は `1011110` から `1010111` に変化する。

### Sample Explanation 2

操作を行う前の時点で、電光掲示板に表示されている文字列が $ T $ であるため、答えは $ 0 $ となります。

### Sample Explanation 3

どのように操作を行っても、電光掲示板に文字列 $ T $ を表示させることが不可能な場合は、`-1` と出力してください。

## 样例 #1

### 输入

```
7

1110110

1010111
```

### 输出

```
2
```

## 样例 #2

### 输入

```
20

11111000000000011111

11111000000000011111
```

### 输出

```
0
```

## 样例 #3

### 输入

```
6

111100

111000
```

### 输出

```
-1
```

## 样例 #4

### 输入

```
119

10101111011101001011111000111111101011110011010111111111111111010111111111111110111111110111110111101111111111110111011

11111111111111111111111111011111101011111011110111110010100101001110111011110111111111110010011111101111111101110111011
```

### 输出

```
22
```



---

---
title: "[ARC120B] Uniformly Distributed"
layout: "post"
diff: 普及/提高-
pid: AT_arc120_b
tag: []
---

# [ARC120B] Uniformly Distributed

## 题目描述

给定一个大小为 $H \times W$ 的网格图，每个格子可以被染成红色（R）、蓝色（B）或为空（.）。记空格数量为 $k$，将所有空格依次染成红色或蓝色，总共有 $2^k$ 种染色方案。

现在要求在从 $(1,1)$ 出发，向下或向右移动一格到达 $(H,W)$ 的过程中，所有经过的格子（包括起点和终点）中被染成红色的格子数目相等。求有多少种方案满足条件。答案对 $998244353$ 取模。

## 输入格式

第一行包含两个整数 $H$ 和 $W$。接下来 $H$ 行，每行包含一个长度为 $W$ 的字符串，表示该行格子的染色情况。

## 输出格式

输出一个整数，表示满足条件的染色方案数对 $998244353$ 取模的结果。

## 说明/提示

$1 \leq H,W \leq 500$

## 样例 #1

### 输入

```
2 2

B.

.R
```

### 输出

```
2
```

## 样例 #2

### 输入

```
3 3

R.R

BBR

...
```

### 输出

```
0
```

## 样例 #3

### 输入

```
2 2

BB

BB
```

### 输出

```
1
```



---

---
title: "[ARC121B] RGB Matching"
layout: "post"
diff: 普及/提高-
pid: AT_arc121_b
tag: []
---

# [ARC121B] RGB Matching

## 题目描述

[problemUrl]: https://atcoder.jp/contests/arc121/tasks/arc121_b

すぬけ君は $ 1 $ から $ 2N $ の番号がついた $ 2N $ 匹の犬を飼っています。

犬 $ i $ のかわいさは $ a_i $ です。 それぞれの犬の体色は赤、緑、青のいずれかで、犬 $ i $ の体色は $ c_i $ です。 $ c_i $ は `R`, `G`, `B` のいずれかであり、`R` ならばその犬の体色が赤であることを、`G` ならば緑であることを、`B` ならば青であることを表します。

すぬけ君は $ N $ 棟の犬小屋を持っており、それぞれの犬小屋に $ 2 $ 匹の犬を住まわせようとしています。 どの犬もちょうど一つの犬小屋に住んでいるように住まわせる必要があることに注意してください。

$ 2 $ 匹の犬を同じ犬小屋に住まわせるとその小屋には *不満* が生じます。 不満の度合いは整数で表され、犬 $ i,j $ が同じ小屋にいるとき生じる不満は $ c_i\ =\ c_j $ ならば $ 0 $、そうでなければ $ |a_i\ -\ a_j| $ です。

$ N $ 棟の犬小屋に犬を $ 2 $ 匹ずつ住まわせた結果生じる不満の総和としてありうる値の最小値を求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ a_{1} $ $ c_{1} $ $ \vdots $ $ a_{2N} $ $ c_{2N} $

## 输出格式

$ N $ 棟の犬小屋に犬を $ 2 $ 匹ずつ住まわせた結果生じる不満の総和としてありうる値の最小値を出力せよ。

## 说明/提示

### 制約

- $ 1\ \leq\ N\ \leq\ 10^{5} $
- $ 1\ \leq\ a_i\ \leq\ 10^{15} $
- $ a_i $ は整数
- $ c_i $ は `R`, `G`, `B` のいずれか

### Sample Explanation 1

\- 犬 $ 1 $ のかわいさは $ 1 $、犬 $ 2 $ のかわいさは $ 2 $ です。 - $ c_1\ \neq\ c_2 $ より、不満は $ 1 $ となります。

### Sample Explanation 2

\- 犬 $ 1 $ のかわいさは $ 1 $、犬 $ 2 $ のかわいさは $ 2 $ です。 - $ c_1\ =\ c_2 $ より、不満は $ 0 $ となります。

## 样例 #1

### 输入

```
1

1 R

2 G
```

### 输出

```
1
```

## 样例 #2

### 输入

```
1

1 B

2 B
```

### 输出

```
0
```

## 样例 #3

### 输入

```
10

585 B

293 B

788 B

222 B

772 G

841 B

115 R

603 G

450 B

325 R

851 B

205 G

134 G

651 R

565 R

548 B

391 G

19 G

808 B

475 B
```

### 输出

```
0
```



---

---
title: "[ARC122A] Many Formulae"
layout: "post"
diff: 普及/提高-
pid: AT_arc122_a
tag: []
---

# [ARC122A] Many Formulae

## 题目描述

[problemUrl]: https://atcoder.jp/contests/arc122/tasks/arc122_a

長さ $ N $ の非負整数列 $ A_1,A_2,\cdots,A_N $ が与えられます．

この数列の隣接する $ 2 $ 項の間に `+` または `-` を入れて，一つの式を作ることを考えます．

式を作る方法は $ 2^{N-1} $ 通りありますが，この中でも以下の条件を満たす式を，**良い式**と呼ぶことにします．

- `-` が $ 2 $ 回以上連続で登場しない．

全ての良い式の値を足し合わせた値を求めて下さい． なお，この値はかならず非負整数となることが証明できます． そこで，この値を $ 10^9+7 $ で割った余りを出力してください．

## 输入格式

入力は以下の形式で標準入力から与えられる．

> $ N $ $ A_1 $ $ A_2 $ $ \cdots $ $ A_N $

## 输出格式

答えを $ 10^9+7 $ で割った余りを出力せよ．

## 说明/提示

### 制約

- $ 1\ \leq\ N\ \leq\ 10^5 $
- $ 1\ \leq\ A_i\ \leq\ 10^9 $
- 入力される値はすべて整数である

### Sample Explanation 1

以下の $ 3 $ 通りの良い式が考えられます． - $ 3+1+5=9 $ - $ 3+1-5=-1 $ - $ 3-1+5=7 $ $ 3-1-5 $ は `-` が $ 2 $ 回以上連続で登場するため，良い式ではありません． よって，答えは $ 9+(-1)+7=15 $ となります．

### Sample Explanation 2

以下の $ 5 $ 通りの良い式が考えられます． - $ 1+1+1+1=4 $ - $ 1+1+1-1=2 $ - $ 1+1-1+1=2 $ - $ 1-1+1+1=2 $ - $ 1-1+1-1=0 $ よって答えは $ 4+2+2+2+0=10 $ となります．

### Sample Explanation 3

答えを $ 10^9+7 $ で割った余りを出力してください．

## 样例 #1

### 输入

```
3

3 1 5
```

### 输出

```
15
```

## 样例 #2

### 输入

```
4

1 1 1 1
```

### 输出

```
10
```

## 样例 #3

### 输入

```
10

866111664 178537096 844917655 218662351 383133839 231371336 353498483 865935868 472381277 579910117
```

### 输出

```
279919144
```



---

---
title: "[ARC122B] Insurance"
layout: "post"
diff: 普及/提高-
pid: AT_arc122_b
tag: []
---

# [ARC122B] Insurance

## 题目描述

[problemUrl]: https://atcoder.jp/contests/arc122/tasks/arc122_b

すぬけくんは明日の運勢を占いました． その結果，$ N $ 個のシナリオのうちどれか一つが等確率で発生し，そのうち $ i $ 番目のシナリオでは $ A_i $ 円を失うことを知りました．

そこですぬけくんは，今日保険に入ることにしました． 保険会社に $ x $ 円を支払ったとすると，$ A_i $ 円を失った場合には $ \min(A_i,2x) $ 円が補填されます． ここで，$ x $ として任意の非負**実数**を選ぶことができます．

すぬけくんは，最終的に自分が失う金額（$ =x+A_i-\min(A_i,2x) $）の期待値を最小化したいです． この最小値を求めてください．

## 输入格式

入力は以下の形式で標準入力から与えられる．

> $ N $ $ A_1 $ $ A_2 $ $ \cdots $ $ A_N $

## 输出格式

答えを出力せよ． 絶対誤差または相対誤差が $ 10^{-6} $ 以下ならば，正解と判定される．

## 说明/提示

### 制約

- $ 1\ \leq\ N\ \leq\ 10^5 $
- $ 1\ \leq\ A_i\ \leq\ 10^9 $
- 入力される値はすべて整数である

### Sample Explanation 1

$ x=1.5 $ とするのが最適です． $ 1.5 $ 円支払ったあと，以下の $ 3 $ つのシナリオが等確率で起こります． - シナリオ $ 1 $: $ 3 $ 円失ったあと，$ \min(3,2x)=3 $ 円が補填される． 最終的にすぬけくんが失う金額は，$ x+A_1-\min(A_1,2x)=1.5+3-3=1.5 $ 円である． - シナリオ $ 2 $: $ 1 $ 円失ったあと，$ \min(1,2x)=1 $ 円が補填される． 最終的にすぬけくんが失う金額は，$ x+A_2-\min(A_2,2x)=1.5+1-1=1.5 $ 円である． - シナリオ $ 3 $: $ 4 $ 円失ったあと，$ \min(4,2x)=3 $ 円が補填される． 最終的にすぬけくんが失う金額は，$ x+A_3-\min(A_3,2x)=1.5+4-3=2.5 $ 円である． よって，失う金額の期待値は，$ (1.5+1.5+2.5)/3=1.833333\cdots $ です．

## 样例 #1

### 输入

```
3

3 1 4
```

### 输出

```
1.83333333333333333333
```

## 样例 #2

### 输入

```
10

866111664 178537096 844917655 218662351 383133839 231371336 353498483 865935868 472381277 579910117
```

### 输出

```
362925658.10000000000000000000
```



---

---
title: "[ARC124B] XOR Matching 2"
layout: "post"
diff: 普及/提高-
pid: AT_arc124_b
tag: []
---

# [ARC124B] XOR Matching 2

## 题目描述

[problemUrl]: https://atcoder.jp/contests/arc124/tasks/arc124_b

非負整数のみからなる長さ $ N $ の数列 $ a,b $ が与えられます。$ a,b $ の $ i $ 番目の要素はそれぞれ $ a_i,\ b_i $ です。

非負整数 $ x $ が以下の条件を満たすとき、$ x $ を **よい数** と呼びます。

- 条件：$ b $ を並べ替えて、$ 1\ \leq\ i\ \leq\ N $ を満たすどの整数 $ i $ についても $ a_i\ \text{\ XOR\ }\ b_i\ =\ x $ が成立するようにすることができる。ここで、$ \text{XOR\ } $ はビットごとの排他的論理和である。

よい数を小さい方からすべて列挙してください。

 $ \text{\ XOR\ } $ とは 整数 $ x,\ y $ のビットごとの排他的論理和 $ x\ \text{\ XOR\ }\ y $ は、以下のように定義されます。

- $ x\ \text{\ XOR\ }\ y $ を二進表記した際の $ 2^k $ ($ k\ \geq\ 0 $) の位の数は、$ x,\ y $ を二進表記した際の $ 2^k $ の位の数のうち一方のみが $ 1 $ であれば $ 1 $、そうでなければ $ 0 $ である。
 
 例えば、$ 3\ \text{\ XOR\ }\ 5\ =\ 6 $ となります (二進表記すると: $ 011\ \text{\ XOR\ }\ 101\ =\ 110 $)。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ a_1 $ $ \cdots $ $ a_N $ $ b_1 $ $ \cdots $ $ b_N $

## 输出格式

$ 1 $ 行目によい数の個数 $ K $ を出力せよ。 続けて $ K $ 行出力せよ。続く $ K $ 行の $ i $ 行目には小さい方から $ i $ 番目のよい数を出力せよ。

## 说明/提示

### 制約

- 与えられる入力は全て整数
- $ 1\ \leq\ N\ \leq\ 2000 $
- $ 0\ \leq\ a_i,\ b_i\ <\ 2^{30} $

### Sample Explanation 1

\- $ b $ を $ (4,\ 7,\ 6) $ と並び替えたとき、$ a_1\ \text{\ XOR\ }\ b_1\ =\ a_2\ \text{\ XOR\ }\ b_2\ =\ a_3\ \text{\ XOR\ }\ b_3\ =\ 5 $ となるため、$ 5 $ はよい数です。他によい数はありません。

## 样例 #1

### 输入

```
3

1 2 3

6 4 7
```

### 输出

```
1

5
```

## 样例 #2

### 输入

```
2

0 1

0 2
```

### 输出

```
0
```

## 样例 #3

### 输入

```
24

14911005 70152939 282809711 965900047 168465665 337027481 520073861 20800623 934711525 944543101 522277111 580736275 468493313 912814743 99651737 439502451 365446123 198473587 285587229 253330309 591640417 761745547 247947767 750367481

805343020 412569406 424258892 329301584 123050452 1042573510 1073384116 495212986 158432830 145726540 623594202 836660574 380872916 722447664 230460104 718360386 620079272 109804454 60321058 38178640 475708360 207775930 393038502 310271010
```

### 输出

```
8

107543995

129376201

139205201

160626723

312334911

323172429

481902037

493346727
```



---

---
title: "[ARC125B] Squares"
layout: "post"
diff: 普及/提高-
pid: AT_arc125_b
tag: []
---

# [ARC125B] Squares

## 题目描述

[problemUrl]: https://atcoder.jp/contests/arc125/tasks/arc125_b

整数 $ N $ が与えられます． 以下の条件を満たす整数の組 $ (x,y) $ の個数を $ 998244353 $ で割った余りを求めてください．

- $ 1\ \leq\ x,y\ \leq\ N $
- $ x^2-y $ は平方数である．（特に，$ 0 $ も平方数とする．）

## 输入格式

入力は以下の形式で標準入力から与えられる．

> $ N $

## 输出格式

答えを出力せよ．

## 说明/提示

### 制約

- $ 1\ \leq\ N\ \leq\ 10^{12} $
- 入力される値はすべて整数である

### Sample Explanation 1

以下の $ 2 $ 通りが考えられます． - $ x=1,y=1 $ - $ x=2,y=3 $

## 样例 #1

### 输入

```
3
```

### 输出

```
2
```

## 样例 #2

### 输入

```
10
```

### 输出

```
8
```

## 样例 #3

### 输入

```
10000000000
```

### 输出

```
52583544
```



---

---
title: "[ARC127A] Leading 1s"
layout: "post"
diff: 普及/提高-
pid: AT_arc127_a
tag: []
---

# [ARC127A] Leading 1s

## 题目描述

[problemUrl]: https://atcoder.jp/contests/arc127/tasks/arc127_a

整数 $ x $ を $ 10 $ 進表記した時，先頭に並ぶ $ 1 $ の個数を $ f(x) $ で表すことにします． 例えば，$ f(1)=1,f(2)=0,f(10)=1,f(11)=2,f(101)=1 $ です．

整数 $ N $ が与えられるので，$ f(1)+f(2)+\cdots+f(N) $ の値を求めてください．

## 输入格式

入力は以下の形式で標準入力から与えられる．

> $ N $

## 输出格式

答えを出力せよ．

## 说明/提示

### 制約

- $ 1\ \leq\ N\ \leq\ 10^{15} $
- 入力される値はすべて整数である

### Sample Explanation 1

$ f(2)=f(3)=\cdots\ =f(9)=0 $ です． 答えは，$ f(1)+f(10)+f(11)=4 $ です．

## 样例 #1

### 输入

```
11
```

### 输出

```
4
```

## 样例 #2

### 输入

```
120
```

### 输出

```
44
```

## 样例 #3

### 输入

```
987654321
```

### 输出

```
123456789
```



---

---
title: "[ARC128B] Balls of Three Colors"
layout: "post"
diff: 普及/提高-
pid: AT_arc128_b
tag: []
---

# [ARC128B] Balls of Three Colors

## 题目描述

[problemUrl]: https://atcoder.jp/contests/arc128/tasks/arc128_b

$ R $ 個の赤いボール，$ G $ 個の緑のボール，$ B $ 個の青いボールがあります． あなたは，以下の操作を好きな回数繰り返すことができます．

- 色の異なる $ 2 $ つのボールを選び，それら両方を残るもう一つの色のボールに変える．

例えば，赤いボールと青いボールを選んだ際は，それら両方を緑のボールに変えます．

あなたの目標は，すべてのボールを同じ色にすることです． 目標が達成可能であるか判定し，また可能であるなら，必要な操作回数の最小値を求めてください．

$ 1 $ つの入力ファイルにつき，$ T $ 個のテストケースを解いてください．

## 输入格式

入力は以下の形式で標準入力から与えられる．

> $ T $ $ case_1 $ $ case_2 $ $ \vdots $ $ case_T $

各ケースは以下の形式で与えられる．

> $ R $ $ G $ $ B $

## 输出格式

各ケースについて，目標が達成不可能な場合は `-1` を，そうでなければ必要な操作回数の最小値を出力せよ．

## 说明/提示

### 制約

- $ 1\ \leq\ T\ \leq\ 100 $
- $ 1\ \leq\ R,G,B\ \leq\ 10^8 $
- 入力される値はすべて整数である

### Sample Explanation 1

例えば，$ case_3 $ については，以下のように操作を行えばよいです． - 緑のボールと青いボールを選び，それら両方を赤いボールに変える - 赤いボールと青いボールを選び，それら両方を緑のボールに変える - 赤いボールと青いボールを選び，それら両方を緑のボールに変える - 赤いボールと青いボールを選び，それら両方を緑のボールに変える

## 样例 #1

### 输入

```
3

1 2 2

1 2 3

1 2 4
```

### 输出

```
2

-1

4
```



---

---
title: "[ARC129A] Smaller XOR"
layout: "post"
diff: 普及/提高-
pid: AT_arc129_a
tag: []
---

# [ARC129A] Smaller XOR

## 题目描述

[problemUrl]: https://atcoder.jp/contests/arc129/tasks/arc129_a

整数 $ N,L,R $ が与えられます． 以下の条件を両方満たす整数 $ x $ の個数を数えてください．

- $ L\ \leq\ x\ \leq\ R $
- $ (x\ \oplus\ N)\ <\ N $ （ここで $ \oplus $ はビット単位 $ \mathrm{XOR} $ 演算を表す）
 
 ビット単位 $ \mathrm{XOR} $ 演算とは  整数 $ A,\ B $ のビット単位 $ \mathrm{XOR} $ 、$ A\ \oplus\ B $ は、以下のように定義されます。

- $ A\ \oplus\ B $ を二進表記した際の $ 2^k $ ($ k\ \geq\ 0 $) の位の数は、$ A,\ B $ を二進表記した際の $ 2^k $ の位の数のうち一方のみが $ 1 $ であれば $ 1 $、そうでなければ $ 0 $ である。
 
 例えば、$ 3\ \oplus\ 5\ =\ 6 $ となります (二進表記すると: $ 011\ \oplus\ 101\ =\ 110 $)。

## 输入格式

入力は以下の形式で標準入力から与えられる．

> $ N $ $ L $ $ R $

## 输出格式

答えを出力せよ．

## 说明/提示

### 制約

- $ 1\ \leq\ N\ \leq\ 10^{18} $
- $ 1\ \leq\ L\ \leq\ R\ \leq\ 10^{18} $
- 入力される値はすべて整数である

### Sample Explanation 1

$ x=1 $ の場合，$ L\ \leq\ x\ \leq\ R $ は満たしますが，$ (x\ \oplus\ N)\ <\ N $ は満たしません． $ x=2 $ の場合，両方の条件を満たします． 他に条件を満たす $ x $ は存在しません．

## 样例 #1

### 输入

```
2 1 2
```

### 输出

```
1
```

## 样例 #2

### 输入

```
10 2 19
```

### 输出

```
10
```

## 样例 #3

### 输入

```
1000000000000000000 1 1000000000000000000
```

### 输出

```
847078495393153025
```



---

---
title: "[ARC129B] Range Point Distance"
layout: "post"
diff: 普及/提高-
pid: AT_arc129_b
tag: []
---

# [ARC129B] Range Point Distance

## 题目描述

对于一组整数 $l,r,x$，其中 $l \le r$，定义 $dist(l,r,x)$ 为：

- 若 $x < l$，则 $dist(l,r,x) = l - x$
- 若 $l \le x \le r$，则 $dist(l,r,x) = 0$
- 若 $x >r$，则 $dist(l,r,x) = x - r$ 

可以简要理解为 $x$ 在数轴上到区间 $[l,r]$ 的距离。

现在给定 $N$ 对整数，第 $i$ 对整数形如 $(L_i, R_i)$。对于 $k=1,2,\dots,N$，分别求解下面的问题：

- 自由选择一个整数 $x$，计算 $max_{i=1}^k dist(L_i,R_i,x)$，求其可能的最小值。

## 输入格式

第一行一个整数 $N$，表示给定 $N$ 对整数。

接下来 $N$ 行每行两个整数 $L_i,R_i$。

## 输出格式

共 $N$ 行，**依次输出** $k=1,2,\dots,N$ 时的答案，输出一个答案换一行。

## 说明/提示

- $1 \le N \le 2 \times 10^5$
- $1 \le L_i \le R_i \le 10^9$
- 所有输入均为整数。

## 样例 #1

### 输入

```
3

1 3

2 4

5 6
```

### 输出

```
0

0

1
```

## 样例 #2

### 输入

```
10

64 96

30 78

52 61

18 28

9 34

42 86

11 49

1 79

13 59

70 95
```

### 输出

```
0

0

2

18

18

18

18

18

18

21
```



---

---
title: "[ARC131C] Zero XOR"
layout: "post"
diff: 普及/提高-
pid: AT_arc131_c
tag: []
---

# [ARC131C] Zero XOR

## 题目描述

[problemUrl]: https://atcoder.jp/contests/arc131/tasks/arc131_c

机の上に $ N $ 枚のクッキーがあります。クッキーの表面にはそれぞれ正の整数 $ A_1,\ A_2,\ \dots,\ A_N $ が書かれており、これらはすべて異なります。

このクッキーを使って 2 人でゲームを行います。このゲームでは、各プレイヤーは次の行動を交互に行います。

> 机にあるクッキーを 1 枚選んで食べる。  
>  その際に、机に残ったクッキーに書かれた整数の $ \mathrm{XOR} $ が $ 0 $ になったならば、そのプレイヤーは勝利し、ゲームは終了する。

あなたは E869120 君に対戦を申し込みました。あなたは先手で、E869120 君は後手です。さて、両者が最適に行動したときに、あなたは E869120 君に勝ちますか？

  $ \mathrm{XOR} $ とは  整数 $ A,\ B $ のビット単位 XOR、$ A\ \mathrm{XOR}\ B $ は、以下のように定義されます。

- $ A\ \mathrm{XOR}\ B $ を二進表記した際の $ 2^k $ ($ k\ \geq\ 0 $) の位の数は、$ A,\ B $ を二進表記した際の $ 2^k $ の位の数のうち一方のみが $ 1 $ であれば $ 1 $、そうでなければ $ 0 $ である。
 
 例えば、$ 3\ \mathrm{XOR}\ 5\ =\ 6 $ となります (二進表記すると: $ 011\ \mathrm{XOR}\ 101\ =\ 110 $)。  
 一般に、$ k $ 個の整数 $ p_1,\ p_2,\ p_3,\ \dots,\ p_k $ のビット単位 XOR は $ (\dots\ ((p_1\ \mathrm{XOR}\ p_2)\ \mathrm{XOR}\ p_3)\ \mathrm{XOR}\ \dots\ \mathrm{XOR}\ p_k) $ と定義され、これは $ p_1,\ p_2,\ p_3,\ \dots\ p_k $ の順番によらないことが証明できます。特に $ k\ =\ 0 $ の場合、$ \mathrm{XOR} $ は $ 0 $ となります。

## 输入格式

入力は以下の形式で標準入力から与えられます。

> $ N $ $ A_1 $ $ A_2 $ $ \cdots $ $ A_N $

## 输出格式

両者が最適に行動したときにあなたが勝つなら `Win`、負けるなら `Lose` と出力してください。

## 说明/提示

### 制約

- $ 1\ \leq\ N\ \leq\ 400000 $
- $ 1\ \leq\ A_i\ \leq\ 10^9\ (1\ \leq\ i\ \leq\ N) $
- $ A_1,\ A_2,\ \dots,\ A_N $ はすべて異なる
- $ A_1,\ A_2,\ \dots,\ A_N $ の $ \mathrm{XOR} $ は $ 0 $ ではない
- 入力はすべて整数

### Sample Explanation 1

この例では、あなたがどんな方法を使っても、E869120 君が最適に行動し続ければ負けてしまいます。 例えば、最初に $ 11 $ が書かれたクッキーを食べるとしましょう。すると、次に E869120 君が $ 9 $ が書かれたクッキーを食べることで、残ったクッキーに書かれた数 $ 14,\ 3,\ 5,\ 8 $ の $ \mathrm{XOR} $ が $ 0 $ になるので、E869120 君が勝ちます。 それ以外の行動をとっても、最終的には E869120 君が勝ちます。

### Sample Explanation 2

この例では、あなたは最初のターンで $ 131 $ が書かれたクッキーを食べることしかできません。すると、机の上からクッキーがなくなるので、残ったクッキーに書かれた数の $ \mathrm{XOR} $ は $ 0 $ になります。したがって、E869120 君が何もできないまま、あなたが勝ちます。

## 样例 #1

### 输入

```
6

9 14 11 3 5 8
```

### 输出

```
Lose
```

## 样例 #2

### 输入

```
1

131
```

### 输出

```
Win
```

## 样例 #3

### 输入

```
8

12 23 34 45 56 78 89 98
```

### 输出

```
Win
```



---

---
title: "[ARC132B] Shift and Reverse"
layout: "post"
diff: 普及/提高-
pid: AT_arc132_b
tag: []
---

# [ARC132B] Shift and Reverse

## 题目描述

[problemUrl]: https://atcoder.jp/contests/arc132/tasks/arc132_b

$ 1,\dots,\ n $ の順列 $ p_1,\dots,p_n $ が与えられます。 この順列に対して以下の操作を、好きな順で何度でも行えます。

- 全体をひっくりかえす。つまり、$ p_1,p_2,\dots,p_n $ を $ p_n,p_{n-1},\dots,p_1 $ に並び替える。
- 先頭の項を末尾に移動させる。つまり、$ p_1,\ p_2,\ \dots,p_n $ を $ p_2,\dots,\ p_n,\ p_1 $ に並び替える。

順列を昇順に並び替えるのに必要な操作回数の最小値を求めてください。 ただし、与えられる入力について、これらの操作によって順列を昇順に並び替えられることが保証されています。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ n $ $ p_1 $ $ \dots $ $ p_n $

## 输出格式

順列を昇順に並び替えるのに必要な操作回数の最小値を出力せよ。

## 说明/提示

### 制約

- $ 2\ \leq\ n\ \leq\ 10^5 $
- $ p_1,\dots,p_n $ は $ 1,\dots,n $ の順列
- 問題文中の操作によって $ p_1,\dots,p_n $ を昇順に並び替えられる

### Sample Explanation 1

次のように操作すると $ 2 $ 回で昇順に並び替えできます。 1. 先頭の項を末尾に移動させ、 $ 3,\ 2,\ 1 $ に並び替える。 2. 全体をひっくりかえし、$ 1,\ 2,\ 3 $ に並び替える。 $ 2 $ 回未満の操作で昇順に並び替えることはできないため、答えは $ 2 $ です。

### Sample Explanation 2

どちらの操作をしても $ 1 $ 回で昇順に並び替えできます。 $ 1 $ 回未満の操作で昇順に並び替えることはできないため、答えは $ 1 $ です。

### Sample Explanation 3

次のように操作すると $ 3 $ 回で昇順に並び替えできます。 1. 全体をひっくりかえし、$ 1,10,9,8,7,6,5,4,3,2 $ に並び替える。 2. 先頭の項を末尾に移動させ、 $ 10,9,8,7,6,5,4,3,2,1 $ に並び替える。 3. 全体をひっくりかえし、 $ 1,2,3,4,5,6,7,8,9,10 $ に並び替える。 $ 3 $ 回未満の操作で昇順に並び替えることはできないため、答えは $ 3 $ です。

### Sample Explanation 4

一度も操作する必要がありません。

## 样例 #1

### 输入

```
3

1 3 2
```

### 输出

```
2
```

## 样例 #2

### 输入

```
2

2 1
```

### 输出

```
1
```

## 样例 #3

### 输入

```
10

2 3 4 5 6 7 8 9 10 1
```

### 输出

```
3
```

## 样例 #4

### 输入

```
12

1 2 3 4 5 6 7 8 9 10 11 12
```

### 输出

```
0
```



---

---
title: "[ARC134B] Reserve or Reverse"
layout: "post"
diff: 普及/提高-
pid: AT_arc134_b
tag: []
---

# [ARC134B] Reserve or Reverse

## 题目描述

[problemUrl]: https://atcoder.jp/contests/arc134/tasks/arc134_b

長さ $ N $ の文字列 $ s $ が与えられます。 $ s $ の $ i $ 文字目は $ s_i $ と表します。

すぬけ君は以下の手順で $ s $ を変化させます。

- $ (1,2,\ \ldots,\ N) $ の長さが**偶数の**（連続するとは限らない）部分列 $ x=(x_1,\ x_2,\ \ldots,\ x_{2k}) $ を選ぶ($ k=0 $ でも構わない)。
- $ s_{x_1} $ と $ s_{x_{2k}} $ を入れ替える。
- $ s_{x_2} $ と $ s_{x_{2k-1}} $ を入れ替える。
- $ s_{x_3} $ と $ s_{x_{2k-2}} $ を入れ替える。
- $ \vdots $
- $ s_{x_{k}} $ と $ s_{x_{k+1}} $ を入れ替える。

すぬけ君が手順を終えたあとの $ s $ としてありうる文字列のうち、辞書順最小のものを求めてください。

 辞書順とは？ 辞書順とは簡単に説明すると「単語が辞書に載っている順番」を意味します。より厳密な説明として、相異なる文字列 $ S $ と文字列 $ T $ の大小を判定するアルゴリズムを以下に説明します。

以下では「 $ S $ の $ i $ 文字目の文字」を $ S_i $ のように表します。また、 $ S $ が $ T $ より辞書順で小さい場合は $ S\ \lt\ T $ 、大きい場合は $ S\ \gt\ T $ と表します。

1. $ S $ と $ T $ のうち長さが短い方の文字列の長さを $ L $ とします。$ i=1,2,\dots,L $ に対して $ S_i $ と $ T_i $ が一致するか調べます。
2. $ S_i\ \neq\ T_i $ である $ i $ が存在する場合、そのような $ i $ のうち最小のものを $ j $ とします。そして、$ S_j $ と $ T_j $ を比較して、 $ S_j $ がアルファベット順で $ T_j $ より小さい場合は $ S\ \lt\ T $ 、大きい場合は $ S\ \gt\ T $ と決定して、アルゴリズムを終了します。
3. $ S_i\ \neq\ T_i $ である $ i $ が存在しない場合、 $ S $ と $ T $ の長さを比較して、$ S $ が $ T $ より短い場合は $ S\ \lt\ T $ 、長い場合は $ S\ \gt\ T $ と決定して、アルゴリズムを終了します。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ s $

## 输出格式

すぬけ君が手順を終えたあとの $ s $ としてありうる文字列のうち、辞書順最小のものを出力せよ。

## 说明/提示

### 制約

- $ 1\ \leq\ N\ \leq\ 2\ \times\ 10^5 $
- $ s $ は長さ $ N $ の英小文字のみからなる文字列

### Sample Explanation 1

\- $ x=(1,3) $ のとき、$ s_{1} $ と $ s_{3} $ のみが入れ替わります。 - 手順を終えたあとの $ s $ は `acdb` となり辞書順最小です。

### Sample Explanation 2

\- $ x=() $ のとき、手順を終えたあとの $ s $ は `ab` となり辞書順最小です。 - $ x $ の長さが $ 0 $ でもよいことに注意してください。

## 样例 #1

### 输入

```
4

dcab
```

### 输出

```
acdb
```

## 样例 #2

### 输入

```
2

ab
```

### 输出

```
ab
```

## 样例 #3

### 输入

```
16

cabaaabbbabcbaba
```

### 输出

```
aaaaaaabbbbcbbbc
```

## 样例 #4

### 输入

```
17

snwfpfwipeusiwkzo
```

### 输出

```
effwpnwipsusiwkzo
```



---

---
title: "[ARC135B] Sum of Three Terms"
layout: "post"
diff: 普及/提高-
pid: AT_arc135_b
tag: []
---

# [ARC135B] Sum of Three Terms

## 题目描述

[problemUrl]: https://atcoder.jp/contests/arc135/tasks/arc135_b

項数 $ N $ の整数列 $ S\ =\ (S_1,\ \ldots,\ S_N) $ が与えられます。 項数 $ N+2 $ の整数列 $ A\ =\ (A_1,\ \ldots,\ A_{N+2}) $ であって、次の条件を満たすものが存在するか否かを判定してください。

- 任意の $ i $ ($ 1\leq\ i\leq\ N+2 $) に対して $ 0\leq\ A_i $ が成り立つ。
- 任意の $ i $ ($ 1\leq\ i\leq\ N $) に対して、$ S_i\ =\ A_{i}\ +\ A_{i+1}\ +\ A_{i+2} $ が成り立つ。

存在する場合には、そのようなものをひとつ出力してください。

## 输入格式

入力は以下の形式で標準入力から与えられます。

> $ N $ $ S_1 $ $ \ldots $ $ S_N $

## 输出格式

問題の条件を満たす整数列 $ A $ が存在するならば `Yes` を、そうでなければ `No` を出力してください。 `Yes` の場合には、$ 2 $ 行目にそのような整数列 $ A $ の各要素を、空白で区切って $ 1 $ 行で出力してください。

> $ A_1 $ $ \ldots $ $ A_{N+2} $

条件を満たす整数列が複数存在する場合は、どれを出力しても正解となります。

## 说明/提示

### 制約

- $ 1\leq\ N\leq\ 3\times\ 10^5 $
- $ 0\leq\ S_i\leq\ 10^9 $

### Sample Explanation 1

以下のように、任意の $ i $ ($ 1\leq\ i\leq\ N $) に対して $ S_i\ =\ A_i\ +\ A_{i+1}\ +\ A_{i+2} $ が成り立つことが確認できます。 - $ 6\ =\ 0\ +\ 4\ +\ 2 $。 - $ 9\ =\ 4\ +\ 2\ +\ 3 $。 - $ 6\ =\ 2\ +\ 3\ +\ 1 $。 - $ 6\ =\ 3\ +\ 1\ +\ 2 $。 - $ 5\ =\ 1\ +\ 2\ +\ 2 $。

## 样例 #1

### 输入

```
5

6 9 6 6 5
```

### 输出

```
Yes

0 4 2 3 1 2 2
```

## 样例 #2

### 输入

```
5

0 1 2 1 0
```

### 输出

```
No
```

## 样例 #3

### 输入

```
1

10
```

### 输出

```
Yes

0 0 10
```



---

---
title: "[ARC137B] Count 1's"
layout: "post"
diff: 普及/提高-
pid: AT_arc137_b
tag: []
---

# [ARC137B] Count 1's

## 题目描述

[problemUrl]: https://atcoder.jp/contests/arc137/tasks/arc137_b

$ 0,1 $ からなる長さ $ N $ の整数列 $ A=(A_1,A_2,\cdots,A_N) $ が与えられます．

あなたはこれから，次の操作をちょうど $ 1 $ 回行います．

- $ A $ の**連続する**部分列を選び，そこに含まれる要素を flip する．つまり，$ 0 $ ならば $ 1 $ に変え，$ 1 $ ならば $ 0 $ に変える． なお，ここで選ぶ部分列は空であることも許され，その場合 $ A $ の要素は全く変化しない．

あなたのスコアは，$ A $ に含まれる $ 1 $ の個数です． あなたが取るスコアとしてあり得る値が何通りあるか求めてください．

## 输入格式

入力は以下の形式で標準入力から与えられる．

> $ N $ $ A_1 $ $ A_2 $ $ \cdots $ $ A_N $

## 输出格式

答えを出力せよ．

## 说明/提示

### 制約

- $ 1\ \leq\ N\ \leq\ 3\ \times\ 10^5 $
- $ 0\ \leq\ A_i\ \leq\ 1 $
- 入力される値はすべて整数

### Sample Explanation 1

スコアとしてあり得る値は，$ 0,1,2,3 $ の $ 4 $ 通りです． 例えば，$ A $ の $ 2 $ 番目から $ 4 $ 番目までの要素を flip すると，$ A=(0,0,0,1) $ となり，スコアは $ 1 $ になります．

## 样例 #1

### 输入

```
4

0 1 1 0
```

### 输出

```
4
```

## 样例 #2

### 输入

```
5

0 0 0 0 0
```

### 输出

```
6
```

## 样例 #3

### 输入

```
6

0 1 0 1 0 1
```

### 输出

```
3
```



---

---
title: "[ARC138A] Larger Score"
layout: "post"
diff: 普及/提高-
pid: AT_arc138_a
tag: []
---

# [ARC138A] Larger Score

## 题目描述

[problemUrl]: https://atcoder.jp/contests/arc138/tasks/arc138_a

長さ $ N $ の整数列 $ A=(A_1,A_2,\cdots,A_N) $ があります． 以降この問題では，$ A $ の先頭 $ K $ 項の和を **スコア** と呼ぶことにします． また，入力で与えられた $ A $ のスコアを $ s $ と置くことにします．

あなたは，以下の操作を好きな回数繰り返すことができます．

- $ A $ のある隣接する $ 2 $ 要素を選び，それらの値を入れ替える．

あなたの目標は，スコアを $ s+1 $ 以上にすることです． 目標が達成可能であるかどうか判定し，また可能であるなら必要な最小の操作回数を求めてください．

## 输入格式

入力は以下の形式で標準入力から与えられる．

> $ N $ $ K $ $ A_1 $ $ A_2 $ $ \cdots $ $ A_N $

## 输出格式

目標が達成可能でない場合，`-1` を出力せよ． 可能である場合，必要な最小の操作回数を出力せよ．

## 说明/提示

### 制約

- $ 2\ \leq\ N\ \leq\ 4\ \times\ 10^5 $
- $ 1\ \leq\ K\ \leq\ N-1 $
- $ 1\ \leq\ A_i\ \leq\ 10^9 $
- 入力される値はすべて整数

### Sample Explanation 1

まず，$ s=2+1=3 $ です． 以下のように操作することで，スコアを $ 4 $ 以上にすることができます． - $ (2,1,1,2)\ \to\ (A_3 $ と $ A_4 $ の値を入れ替える $ )\to\ (2,1,2,1)\ \to\ (A_2 $ と $ A_3 $ の値を入れ替える $ )\to\ (2,2,1,1) $ $ 1 $ 回の操作では目標を達成できないため，必要な最小の操作回数は $ 2 $ になります．

## 样例 #1

### 输入

```
4 2

2 1 1 2
```

### 输出

```
2
```

## 样例 #2

### 输入

```
3 1

3 2 1
```

### 输出

```
-1
```

## 样例 #3

### 输入

```
20 13

90699850 344821203 373822335 437633059 534203117 523743511 568996900 694866636 683864672 836230375 751240939 942020833 865334948 142779837 22252499 197049878 303376519 366683358 545670804 580980054
```

### 输出

```
13
```



---

---
title: "[ARC138B] 01 Generation"
layout: "post"
diff: 普及/提高-
pid: AT_arc138_b
tag: []
---

# [ARC138B] 01 Generation

## 题目描述

[problemUrl]: https://atcoder.jp/contests/arc138/tasks/arc138_b

すぬけくんは，$ 0 $ と $ 1 $ からなる長さ $ N $ の整数列を作ろうとしています． 今すぬけ君は空の数列 $ x $ を持っており，これから以下の $ 2 $ 種類の操作を好きな順番で $ N $ 回行います．

- 操作A: $ x $ の要素をすべて flip する．つまり，$ 0 $ ならば $ 1 $ に変え，$ 1 $ ならば $ 0 $ に変える． その後，$ x $ の先頭に $ 0 $ を追加する．
- 操作B: $ x $ の末尾に $ 0 $ を追加する．

$ 0 $ と $ 1 $ からなる長さ $ N $ の整数列 $ A=(A_1,A_2,\cdots,A_N) $ が与えられます． $ x $ を $ A $ に一致させることが可能かどうか判定してください．

## 输入格式

入力は以下の形式で標準入力から与えられる．

> $ N $ $ A_1 $ $ A_2 $ $ \cdots $ $ A_N $

## 输出格式

$ x $ を $ A $ に一致させることが可能ならば `Yes` を，不可能ならば `No` を出力せよ．

## 说明/提示

### 制約

- $ 1\ \leq\ N\ \leq\ 2\ \times\ 10^5 $
- $ 0\ \leq\ A_i\ \leq\ 1 $
- 入力される値はすべて整数

### Sample Explanation 1

以下のように操作すればよいです． - 始状態：$ x=() $ - 操作Aを行う．$ x=(0) $ となる． - 操作Bを行う．$ x=(0,0) $ となる． - 操作Aを行う．$ x=(0,1,1) $ となる． - 操作Bを行う．$ x=(0,1,1,0) $ となる．

## 样例 #1

### 输入

```
4

0 1 1 0
```

### 输出

```
Yes
```

## 样例 #2

### 输入

```
4

1 0 0 0
```

### 输出

```
No
```

## 样例 #3

### 输入

```
4

0 0 0 1
```

### 输出

```
No
```



---

---
title: "[ARC140A] Right String"
layout: "post"
diff: 普及/提高-
pid: AT_arc140_a
tag: []
---

# [ARC140A] Right String

## 题目描述

[problemUrl]: https://atcoder.jp/contests/arc140/tasks/arc140_a

英小文字からなる文字列 $ T $ に対して次の問題を考え、その答えを $ f(T) $ とします。

> $ T $ の先頭の文字を削除し末尾に追加する操作を任意の回数行うことによって作ることのできる文字列の種類数を求めてください。

英小文字からなる長さ $ N $ の文字列 $ S $ が与えられます。あなたは以下の操作を $ K $ 回以下行うことが出来ます。($ 1 $ 回も行わなくてもよいです。)

- $ S $ の文字を $ 1 $ 個選び、任意の英小文字に変更する。

操作終了後の $ f(S) $ の値としてあり得る最小値を求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ K $ $ S $

## 输出格式

答えを出力せよ。

## 说明/提示

### 制約

- $ 1\ \le\ N\ \le\ 2000 $
- $ 0\ \le\ K\ \le\ N $
- $ S $ は英小文字からなる長さ $ N $ の文字列である。
- $ N,K $ は整数である。

### Sample Explanation 1

$ 1 $ 回目の操作で $ 4 $ 文字目を `c` から `b` に変更すると $ S= $ `abab` となり、$ f(S)=2 $ となります。 $ f(S) $ を $ 1 $ 回以下の操作で $ 1 $ 以下にすることはできないため、答えは $ 2 $ です。

## 样例 #1

### 输入

```
4 1

abac
```

### 输出

```
2
```

## 样例 #2

### 输入

```
10 0

aaaaaaaaaa
```

### 输出

```
1
```

## 样例 #3

### 输入

```
6 1

abcaba
```

### 输出

```
3
```



---

---
title: "[ARC140B] Shorten ARC"
layout: "post"
diff: 普及/提高-
pid: AT_arc140_b
tag: []
---

# [ARC140B] Shorten ARC

## 题目描述

---

给出一个仅由 $A,R,C$ 组成的长度为 $n$ $(1\le n\le 2\times 10^5)$ 的字符串 $S$，您可以进行操作：

- 如果进行第奇数次操作，您需要用 $R$ 替换一次 $S$ 中的任意一个子串 $ARC$

- 如果进行第偶数次操作，您需要用 $AC$ 替换一次 $S$ 中的任意一个子串 $ARC$

最多能进行多少次操作？

翻译 by wukaichen888

## 输入格式

输入共两行，第一行含一个正整数 $n$。

第二行包括一个长度为 $n$ 的字符串 $S$。

## 输出格式

一行，表示答案。

## 样例 #1

### 输入

```
6

AARCCC
```

### 输出

```
2
```

## 样例 #2

### 输入

```
5

AAAAA
```

### 输出

```
0
```

## 样例 #3

### 输入

```
9

ARCARCARC
```

### 输出

```
3
```



---

---
title: "[ARC141A] Periodic Number"
layout: "post"
diff: 普及/提高-
pid: AT_arc141_a
tag: []
---

# [ARC141A] Periodic Number

## 题目描述

[problemUrl]: https://atcoder.jp/contests/arc141/tasks/arc141_a

正整数 $ n $ に対し、$ n $ を十進法表記した文字列を $ \mathrm{str}(n) $ で表します。

正整数 $ n $ について、ある正整数 $ m $ が存在して $ \mathrm{str}(n) $ が $ \mathrm{str}(m) $ を $ 2 $ 個以上連結したものになっているとき、 $ n $ は「周期的な数」であるといいます。たとえば $ 11,\ 1212,\ 123123123 $ は「周期的な数」です。

$ 11 $ 以上の正整数 $ N $ が与えられます。 $ N $ 以下の「周期的な数」の最大値を求めてください。 $ N $ 以下の「周期的な数」は $ 1 $ つ以上存在することが示せます。

$ T $ 個のテストケースが与えられるので、それぞれについて答えを求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられます。

> $ T $ $ \mathrm{case}_1 $ $ \vdots $ $ \mathrm{case}_T $

各ケースは以下の形式で与えられます。

> $ N $

## 输出格式

$ T $ 行出力してください。$ i $ 行目には $ i $ 番目のテストケースに対する答えを出力してください。

## 说明/提示

### 制約

- $ 1\ \leq\ T\ \leq\ 10^4 $
- $ 11\ \leq\ N\ <\ 10^{18} $
- 入力される値はすべて整数

### Sample Explanation 1

$ 1 $ 個目のテストケースについて、 $ 1412 $ 以下の「周期的な数」にはたとえば $ 11,\ 222,\ 1212,\ 1313 $ などが考えられますが、このうち最大のものは $ 1313 $ です。

## 样例 #1

### 输入

```
3

1412

23

498650499498649123
```

### 输出

```
1313

22

498650498650498650
```



---

---
title: "[ARC141B] Increasing Prefix XOR"
layout: "post"
diff: 普及/提高-
pid: AT_arc141_b
tag: []
---

# [ARC141B] Increasing Prefix XOR

## 题目描述

[problemUrl]: https://atcoder.jp/contests/arc141/tasks/arc141_b

正整数 $ N,\ M $ が与えられます。

長さ $ N $ の正整数列 $ A=(A_1,\ A_2,\ \dots,\ A_N) $ であって、以下の条件を満たすものの個数を $ 998244353 $ で割った余りを求めてください。

- $ 1\ \leq\ A_1\ <\ A_2\ <\ \dots\ <\ A_N\ \leq\ M $
- $ B_i\ =\ A_1\ \oplus\ A_2\ \oplus\ \dots\ \oplus\ A_i $ としたとき、 $ B_1\ <\ B_2\ <\ \dots\ <\ B_N $

ただしここで、 $ \oplus $ はビット単位 $ \mathrm{XOR} $ 演算を表します。

  ビット単位 $ \mathrm{XOR} $ 演算とは  非負整数 $ A,\ B $ のビット単位 $ \mathrm{XOR} $ 、$ A\ \oplus\ B $ は、以下のように定義されます。

- $ A\ \oplus\ B $ を二進表記した際の $ 2^k $ ($ k\ \geq\ 0 $) の位の数は、$ A,\ B $ を二進表記した際の $ 2^k $ の位の数のうち一方のみが $ 1 $ であれば $ 1 $、そうでなければ $ 0 $ である。
 
 例えば、$ 3\ \oplus\ 5\ =\ 6 $ となります (二進表記すると: $ 011\ \oplus\ 101\ =\ 110 $)。  
 一般に $ k $ 個の非負整数 $ p_1,\ p_2,\ p_3,\ \dots,\ p_k $ のビット単位 $ \mathrm{XOR} $ は $ (\dots\ ((p_1\ \oplus\ p_2)\ \oplus\ p_3)\ \oplus\ \dots\ \oplus\ p_k) $ と定義され、これは $ p_1,\ p_2,\ p_3,\ \dots,\ p_k $ の順番によらないことが証明できます。

## 输入格式

入力は以下の形式で標準入力から与えられます。

> $ N $ $ M $

## 输出格式

答えを出力してください。

## 说明/提示

### 制約

- $ 1\ \leq\ N\ \leq\ M\ <\ 2^{60} $
- 入力される値はすべて整数

### Sample Explanation 1

例えば $ (A_1,\ A_2)=(1,\ 3) $ とすると $ A_1\ <\ A_2 $ であり、$ B_1=A_1=1,\ B_2=A_1\oplus\ A_2=2 $ より $ B_1\ <\ B_2 $ が成り立つので条件を満たします。 この他には $ (A_1,\ A_2)=(1,\ 2),\ (1,\ 4),\ (2,\ 4),\ (3,\ 4) $ が条件を満たします。

## 样例 #1

### 输入

```
2 4
```

### 输出

```
5
```

## 样例 #2

### 输入

```
4 4
```

### 输出

```
0
```

## 样例 #3

### 输入

```
10 123456789
```

### 输出

```
205695670
```



---

---
title: "[ARC144B] Gift Tax"
layout: "post"
diff: 普及/提高-
pid: AT_arc144_b
tag: []
---

# [ARC144B] Gift Tax

## 题目描述

[problemUrl]: https://atcoder.jp/contests/arc144/tasks/arc144_b

$ a\leq\ b $ を満たす正整数 $ a,\ b $ および，正整数列 $ A\ =\ (A_1,\ A_2,\ \ldots,\ A_N) $ が与えられます．

あなたはこの数列に対して，以下の操作を何度でも行うことができます（$ 0 $ 回でもよいです）：

- 相異なる添字 $ i,\ j $ ($ 1\leq\ i,\ j\ \leq\ N $) を選ぶ．$ A_i $ に $ a $ を加え，$ A_j $ から $ b $ を引く．

操作後の $ \min(A_1,\ A_2,\ \ldots,\ A_N) $ としてありうる最大値を求めてください．

## 输入格式

入力は以下の形式で標準入力から与えられます．

> $ N $ $ a $ $ b $ $ A_1 $ $ A_2 $ $ \ldots $ $ A_N $

## 输出格式

操作後の $ \min(A_1,\ A_2,\ \ldots,\ A_N) $ としてありうる最大値を出力してください．

## 说明/提示

### 制約

- $ 2\leq\ N\leq\ 3\times\ 10^5 $
- $ 1\leq\ a\leq\ b\leq\ 10^9 $
- $ 1\leq\ A_i\leq\ 10^{9} $

### Sample Explanation 1

例えば次のように操作を行うことで， $ \min(A_1,\ A_2,\ A_3)\ =\ 5 $ を達成できます． - $ i\ =\ 1,\ j\ =\ 3 $ として操作を行う．$ A $ は $ (3,\ 5,\ 7) $ に変化する． - $ i\ =\ 1,\ j\ =\ 3 $ として操作を行う．$ A $ は $ (5,\ 5,\ 5) $ に変化する．

### Sample Explanation 2

例えば次のように操作を行うことで， $ \min(A_1,\ A_2,\ A_3)\ =\ 3 $ を達成できます． - $ i\ =\ 1,\ j\ =\ 3 $ として操作を行う．$ A $ は $ (13,\ 1,\ -1) $ に変化する． - $ i\ =\ 2,\ j\ =\ 1 $ として操作を行う．$ A $ は $ (10,\ 3,\ -1) $ に変化する． - $ i\ =\ 3,\ j\ =\ 1 $ として操作を行う．$ A $ は $ (7,\ 3,\ 1) $ に変化する． - $ i\ =\ 3,\ j\ =\ 1 $ として操作を行う．$ A $ は $ (4,\ 3,\ 3) $ に変化する．

### Sample Explanation 3

一度も操作を行わないことにより， $ \min(A_1,\ A_2,\ A_3)\ =\ 5 $ を達成できます．

## 样例 #1

### 输入

```
3 2 2

1 5 9
```

### 输出

```
5
```

## 样例 #2

### 输入

```
3 2 3

11 1 2
```

### 输出

```
3
```

## 样例 #3

### 输入

```
3 1 100

8 5 6
```

### 输出

```
5
```

## 样例 #4

### 输入

```
6 123 321

10 100 1000 10000 100000 1000000
```

### 输出

```
90688
```



---

---
title: "[ARC145B] AB Game"
layout: "post"
diff: 普及/提高-
pid: AT_arc145_b
tag: []
---

# [ARC145B] AB Game

## 题目描述

[problemUrl]: https://atcoder.jp/contests/arc145/tasks/arc145_b

以下のゲームをゲーム $ n $ と呼びます。

> Alice と Bob でゲームをします。はじめ $ n $ 個の石があります。
> 
> Alice から始めて、交互に次の操作を行い、操作を行えなくなった方が負けとなります。
> 
> - もし Alice が操作を行うなら、石を $ A $ の正の倍数の個数取り除く。
> - もし Bob が操作を行うなら、石を $ B $ の正の倍数の個数取り除く。

ゲーム $ 1 $、ゲーム $ 2 $、…、ゲーム $ N $ のうち、二人が最適に行動したとき Alice が勝つゲームは何個あるか求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ A $ $ B $

## 输出格式

答えを出力せよ。

## 说明/提示

### 制約

- $ 1\ \leq\ N\ ,A,B\ \leq\ 10^{18} $
- 入力は全て整数

### Sample Explanation 1

ゲーム $ 1 $ では、Alice は操作を行えないため Alice の負けとなります。 ゲーム $ 2 $ では、Alice が石を $ 2 $ 個取ることで Bob は操作を行えなくなり、Alice の勝ちとなります。 ゲーム $ 3 $ では、Alice が石を $ 2 $ 個取り、Bob が石を $ 1 $ 個取るとAlice は操作を行えないため Alice の負けとなります。 ゲーム $ 4 $ では、Alice が石を $ 2\ \times\ 2\ =\ 4 $ 個取ることで Bob は操作を行えなくなり、Alice の勝ちとなります。 以上より、ゲーム $ 1,2,3,4 $ のうちAlice が勝つゲームは $ 2 $ 個です。

## 样例 #1

### 输入

```
4 2 1
```

### 输出

```
2
```

## 样例 #2

### 输入

```
27182818284 59045 23356
```

### 输出

```
10752495144
```



---

---
title: "[ARC146A] Three Cards"
layout: "post"
diff: 普及/提高-
pid: AT_arc146_a
tag: []
---

# [ARC146A] Three Cards

## 题目描述

[problemUrl]: https://atcoder.jp/contests/arc146/tasks/arc146_a

$ N $ 枚のカードがあります。カードには $ 1 $ から $ N $ の番号がついています。

カード $ i $ には正整数 $ A_i $ が書かれています。

この中から $ 3 $ 枚のカードを選び、好きな順で書かれている整数を連結し新しく整数を作ります。例えば、$ 1,23,4 $ が書かれたカードを選んだとき、$ 1234 $ や $ 4231 $ を作ることができます。

作ることのできる整数の最大値を求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ A_1 $ $ A_2 $ $ \dots $ $ A_N $

## 输出格式

答えを出力せよ。

## 说明/提示

### 制約

- $ 3\ \le\ N\ \le\ 2\ \times\ 10^5 $
- $ 1\ \le\ A_i\ <\ 10^6 $
- 入力は全て整数である。

### Sample Explanation 1

$ 4,5,8 $ が書かれたカードを選んだ場合、$ 458,485,548,584,845,854 $ を作ることができます。 $ 855 $ 以上の整数を作ることはできないので解は $ 854 $ です。

## 样例 #1

### 输入

```
5

1 4 3 5 8
```

### 输出

```
854
```

## 样例 #2

### 输入

```
8

813 921 481 282 120 900 555 409
```

### 输出

```
921900813
```



---

---
title: "[ARC147B] Swap to Sort"
layout: "post"
diff: 普及/提高-
pid: AT_arc147_b
tag: []
---

# [ARC147B] Swap to Sort

## 题目描述

现有一个$1$到$N$的排列$ P=(P_1,P_2,\ldots,P_N) $ 。你可以重复执行以下两种操作来使$P$从小到大排序。

- 操作$A:$选择一个整数$i$满足$1\ \leq\ i\ \leq\ N-1$，然后交换$P_i$和$P_{i+1}$。
- 操作$B:$选择一个整数$i$满足$1\ \leq\ i\ \leq\ N-2$，然后交换$P_i$和$P_{i+2}$。

请找出一个满足以下要求的操作序列
* 操作$A$的数量最少
* 操作的总数不超过$10^5$

在题目条件的约束下，我们可以证明合法的解总是存在的

## 输入格式

#### $ N $     
$ P_1 $ $ P_2 $ $ \ldots $ $ P_N $

## 输出格式

设你的答案中的操作次数为$S$。输出有$S+1$行。

第一行包含整数$S$

第$(s+1)(1≤s≤S)$行中应包含以下内容。

- 如果第$s$个操作为$A$,输出`A i`，$i$为此次操作选择的整数
- 如果第$s$个操作为$B$,输出`B i`，$i$为此次操作选择的整数

如果有多个合法解，输出一个即可。

## 样例 #1

### 样例输入 #1

```
4
3 2 4 1
```

### 样例输出 #1

```
4
A 3
B 1
B 2
B 2
```

## 样例 #2

### 样例输入 #2

```
3
1 2 3
```

### 样例输出 #2

```
0
```

## 样例 #3

### 样例输入 #3

```
6
2 1 4 3 6 5
```

### 样例输出 #3

```
3
A 1
A 3
A 5
```

## 说明/提示

- $ 2\ \leq\ N\ \leq\ 400 $
- $ 1\ \leq\ P_i\ \leq\ N\ \,(1\ \leq\ i\ \leq\ N) $
- $ P_i\ \neq\ P_j\ \,(1\ \leq\ i\ <\ j\ \leq\ N) $
- 输入均为正数

## 样例 #1

### 输入

```
4

3 2 4 1
```

### 输出

```
4

A 3

B 1

B 2

B 2
```

## 样例 #2

### 输入

```
3

1 2 3
```

### 输出

```
0
```

## 样例 #3

### 输入

```
6

2 1 4 3 6 5
```

### 输出

```
3

A 1

A 3

A 5
```



---

---
title: "[ARC148B] dp"
layout: "post"
diff: 普及/提高-
pid: AT_arc148_b
tag: []
---

# [ARC148B] dp

## 题目描述

[problemUrl]: https://atcoder.jp/contests/arc148/tasks/arc148_b

`d` と `p` からなる長さ $ L $ の文字列 $ T $ に対して、$ T $ を $ 180 $ 度回転した文字列を $ f(T) $ と表します。より厳密には、$ f(T) $ を次の条件を満たす文字列として定めます。

- $ f(T) $ は `d` と `p` からなる長さ $ L $ の文字列である。
- $ 1\ \leq\ i\ \leq\ L $ であるすべての整数 $ i $ について、$ f(T) $ の $ i $ 文字目は $ T $ の $ L\ +\ 1\ -\ i $ 文字目と異なる。

例えば $ T\ = $ `ddddd` のとき $ f(T)\ = $ `ppppp`, $ T\ = $ `dpdppp` のとき $ f(T)= $ `dddpdp` です。

`d` と `p` からなる長さ $ N $ の文字列 $ S $ が与えられます。  
 あなたは次の操作を **$ 0 $ 回以上 $ 1 $ 回以下**行うことができます。

- $ 1\ \leq\ L\ \leq\ R\ \leq\ N $ である整数の組 $ (L,\ R) $ を $ 1 $ つ選び、$ S $ の $ L $ 文字目から $ R $ 文字目までからなる部分文字列を $ T $ とする。そして、$ S $ の $ L $ 文字目から $ R $ 文字目までを $ f(T) $ に置き換える。

例えば $ S= $ `dpdpp`, $ (L,R)=(2,4) $ の場合、$ T= $ `pdp`, $ f(T)= $ `dpd` なので $ S $ は `ddpdp` に変化します。

最終的な $ S $ としてあり得る文字列のうち辞書順最小のものを出力してください。

  辞書順とは？文字列 $ S\ =\ S_1S_2\ldots\ S_{|S|} $ が文字列 $ T\ =\ T_1T_2\ldots\ T_{|T|} $ より**辞書順で小さい**とは、下記の 1. と 2. のどちらかが成り立つことを言います。 ここで、$ |S|,\ |T| $ はそれぞれ $ S,\ T $ の長さを表します。

1. $ |S|\ \lt\ |T| $ かつ $ S_1S_2\ldots\ S_{|S|}\ =\ T_1T_2\ldots\ T_{|S|} $。
2. ある整数 $ 1\ \leq\ i\ \leq\ \min\lbrace\ |S|,\ |T|\ \rbrace $ が存在して、下記の $ 2 $ つがともに成り立つ。 
  - $ S_1S_2\ldots\ S_{i-1}\ =\ T_1T_2\ldots\ T_{i-1} $
  - $ S_i $ が $ T_i $ よりアルファベット順で小さい文字である。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ S $

## 输出格式

答えを出力せよ。

## 说明/提示

### 制約

- $ 1\ \leq\ N\ \leq\ 5000 $
- $ S $ は `d` と `p` からなる長さ $ N $ の文字列
- $ N $ は整数

### Sample Explanation 1

$ (L,\ R)\ =\ (2,\ 5) $ とします。$ T\ = $ `pdpp`, $ f(T)\ = $ `ddpd` なので、操作後の $ S $ は `dddpdd` になります。 得られる文字列のうち `dddpdd` が辞書順最小なので、これを出力します。

### Sample Explanation 2

操作を行わないことが最適な場合もあります。

## 样例 #1

### 输入

```
6

dpdppd
```

### 输出

```
dddpdd
```

## 样例 #2

### 输入

```
3

ddd
```

### 输出

```
ddd
```

## 样例 #3

### 输入

```
11

ddpdpdppddp
```

### 输出

```
ddddpdpdddp
```



---

---
title: "[ARC150A] Continuous 1"
layout: "post"
diff: 普及/提高-
pid: AT_arc150_a
tag: []
---

# [ARC150A] Continuous 1

## 题目描述

[problemUrl]: https://atcoder.jp/contests/arc150/tasks/arc150_a

`0`, `1`, `?` のみからなる長さ $ N $ の文字列 $ S=S_1S_2\dots\ S_N $ が与えられます。

これから $ S $ に含まれるすべての `?` を `0`, `1` のいずれかに置き換えることで、以下の条件がすべて満たされるようにしたいです。

- $ S $ は `1` をちょうど $ K $ 個含む。
- $ K $ 個の `1` は連続している。すなわち、ある $ i\ (1\ \leq\ i\ \le\ N-K+1) $ があって、$ S_i=S_{i+1}=\dots=S_{i+K-1}= $ `1` が成り立つ。

条件を満たすような `?` の置き換え方がちょうど $ 1 $ 通りであるか判定してください。

$ T $ 個のテストケースが与えられるので、それぞれについて答えを求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられます。

> $ T $ $ \mathrm{case}_1 $ $ \vdots $ $ \mathrm{case}_T $

各ケースは以下の形式で与えられます。

> $ N $ $ K $ $ S $

## 输出格式

$ T $ 行出力してください。$ i $ 行目には $ i $ 番目のテストケースについて、条件を満たすような `?` の置き換え方がちょうど $ 1 $ 通りである場合は `Yes` を、そうでない場合は `No` を出力してください。

## 说明/提示

### 制約

- $ 1\ \leq\ T\ \leq\ 10^5 $
- $ 1\ \leq\ K\ <\ N\ \leq\ 3\ \times\ 10^5 $
- $ S $ は `0`, `1`, `?` のみからなる長さ $ N $ の文字列
- 全テストケースに対する $ N $ の総和は $ 3\ \times\ 10^5 $ 以下

### Sample Explanation 1

$ 1 $ 個目のテストケースについて、例えば $ S $ を `101` に変えることができますが、この場合は `1` が連続していないため、条件を満たしません。 $ S $ が条件を満たすようにするには $ S $ を `110` に変えるしかありません。 $ 2 $ 個目のテストケースについて、 $ S $ が条件を満たすようにするには $ S $ を `1100`, または `0110` に変えればよく、条件を満たすような `?` の置き換え方は $ 2 $ 通りあります。 $ 3 $ 個目のテストケースについて、$ S $ が条件を満たすよう `?` を置き換える方法は存在しません。

## 样例 #1

### 输入

```
4

3 2

1??

4 2

?1?0

6 3

011?1?

10 5

00?1???10?
```

### 输出

```
Yes

No

No

Yes
```



---

---
title: "[ARC182A] Chmax Rush!"
layout: "post"
diff: 普及/提高-
pid: AT_arc182_a
tag: ['分类讨论']
---

# [ARC182A] Chmax Rush!

## 题目描述

[problemUrl]: https://atcoder.jp/contests/arc182/tasks/arc182_a

長さ $ N $ の整数列 $ S $ があります。はじめ、$ S $ の要素はすべて $ 0 $ です。

また、長さ $ Q $ の整数列 $ P=(P_1,P_2,\dots,P_Q) $ と $ V=(V_1,V_2,\dots,V_Q) $ が与えられます。

すぬけ君は、数列 $ S $ に $ Q $ 回の操作を順に行いたいです。$ i $ 回目の操作は以下です。

- 以下のどちらかの操作を行う。
  - $ S_1,S_2,\dots,S_{P_i} $ をすべて $ V_i $ に置き換える。ただし、この操作の前に $ S_1,S_2,\dots,S_{P_i} $ の中に $ V_i $ より真に大きい要素がある場合、すぬけ君は泣き出す。
  - $ S_{P_i},S_{P_i+1},\dots,S_N $ をすべて $ V_i $ に置き換える。ただし、この操作の前に $ S_{P_i},S_{P_i+1},\dots,S_N $ の中に $ V_i $ より真に大きい要素がある場合、すぬけ君は泣き出す。

すぬけ君が泣き出さないように $ Q $ 回の操作をすべて行うことのできるような操作列の個数を $ 998244353 $ で割った余りを求めてください。

ただし、$ 2 $ つの操作列が異なるとは、ある $ 1\leq\ i\leq\ Q $ が存在して、$ i $ 番目の操作でどちらの操作を選択したかが異なることを指します。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ Q $ $ P_1 $ $ V_1 $ $ P_2 $ $ V_2 $ $ \vdots $ $ P_Q $ $ V_Q $

## 输出格式

答えを整数として出力せよ。

## 说明/提示

### 制約

- $ 2\ \leq\ N\ \leq\ 5000 $
- $ 1\ \leq\ Q\ \leq\ 5000 $
- $ 1\ \leq\ P_i\ \leq\ N $
- $ 1\ \leq\ V_i\ \leq\ 10^9 $
- 入力はすべて整数

### Sample Explanation 1

以下のようにするとすぬけ君が泣き出さないように $ 3 $ 回の操作を行うことができます。 - $ S_1 $ を $ 8 $ に置き換える。 - $ S_8 $ を $ 1 $ に置き換える。 - $ S_2,S_3,\dots,S_8 $ を $ 1 $ に置き換える。 これ以外に条件を満たす操作列はないので、$ 1 $ が答えです。例えば、$ 1 $ 回目の操作で $ S_1,S_2,\dots,S_8 $ を $ 8 $ に置き換えると、$ 2 $ 回目の操作でどちらを選んでもすぬけ君が泣き出してしまいます。

### Sample Explanation 2

$ 2 $ 回目までの操作をどのように行っても $ 3 $ 回目の操作ですぬけ君が泣き出してしまいます。

### Sample Explanation 3

$ 998244353 $ で割った余りを求めることを忘れないでください。

## 样例 #1

### 输入

```
8 3
1 8
8 1
2 1
```

### 输出

```
1
```

## 样例 #2

### 输入

```
8 3
8 1
1 8
1 2
```

### 输出

```
0
```

## 样例 #3

### 输入

```
241 82
190 3207371
229 3639088
61 4428925
84 17258698
34 42692503
207 59753183
180 67198566
78 99285033
60 102449991
234 122146510
111 126959145
141 152331579
78 159855439
11 169658471
22 189991287
37 204602946
73 209329065
72 215363269
152 236450854
175 237822921
22 261431608
144 252550201
54 268889550
238 276997357
69 313065279
226 330144323
6 335788783
126 345410019
220 348318997
166 365778763
142 382251905
200 406191336
234 392702679
83 409660987
183 410908761
142 445707116
205 470279207
230 486436406
156 494269002
113 495687706
200 500005738
162 505246499
201 548652987
86 449551554
62 459527873
32 574001635
230 601073337
175 610244315
174 613857555
181 637452273
158 637866397
148 648101378
172 646898076
144 682578257
239 703460335
192 713255331
28 727075136
196 730768166
111 751850547
90 762445737
204 762552166
72 773170159
240 803415865
32 798873367
195 814999380
72 842641864
125 851815348
116 858041919
200 869948671
195 873324903
5 877767414
105 877710280
150 877719360
9 884707717
230 880263190
88 967344715
49 977643789
167 979463984
70 981400941
114 991068035
94 991951735
141 995762200
```

### 输出

```
682155965
```



---

---
title: "[ARC191A] Replace Digits"
layout: "post"
diff: 普及/提高-
pid: AT_arc191_a
tag: []
---

# [ARC191A] Replace Digits

## 题目描述

给出长度为 $ N $ 的字符串 $ S $ 和长度为 $ M $ 的字符串 $ T $。$ S $ 和 $ T $ 都由 `1` 到 `9` 的数字组成。

您将按照 $ k = 1,2, \dots ,M $ 的顺序执行以下操作。
* 选择满足 $ 1 \le i \le N $ 的整数 $ i $。然后用 $ T $ 的第 $ k $ 个字母替换 $ S $ 的第 $ i $ 个字母。

求 $ M $ 次操作结束后的字符串 $ S $ 作为整数的最大值。

## 输入格式

输入以以下形式从标准输入给出：
> $ N $ $ M $ $ S $ $ T $

## 输出格式

输出 $ M $ 次操作结束后的字符串 $ S $ 作为整数的最大值。

## 说明/提示

#### 制约

- $ 1\le\ N,M\le\ 10^6 $
- $ N,M $ 是整数
- $ S $ 是长度 $ N $ 的字符串，由 `1` 到 `9` 的数字组成。
- $ T $ 是长度为 $ M $ 的字符串，由 `1` 到 `9` 的数字组成。


以下操作方法是最佳的。
- 当 $k = 1$ 时，选择 $i = 3$。这时$S = $ `193`。
- 当 $k = 2$ 时，选择 $i = 1$。这时$S = $ `293`。
- 当 $k = 3$ 时，选择 $i = 1$。这时$S = $ `593`。

在这种情况下，$ S $ 作为整数的值是 $ 593 $，这是最大值。

## 样例 #1

### 输入

```
3 3
191
325
```

### 输出

```
593
```

## 样例 #2

### 输入

```
3 9
191
998244353
```

### 输出

```
993
```

## 样例 #3

### 输入

```
11 13
31415926535
2718281828459
```

### 输出

```
98888976555
```



---

---
title: "[ARC191B] XOR = MOD"
layout: "post"
diff: 普及/提高-
pid: AT_arc191_b
tag: []
---

# [ARC191B] XOR = MOD

## 题目描述

[problemUrl]: https://atcoder.jp/contests/arc191/tasks/arc191_b

正整数 $ N,K $ が与えられます。 以下の条件を満たす正整数 $ X $ を **$ N $ と相性の良い数** と呼びます。

- $ X $ と $ N $ の排他的論理和は、$ X $ を $ N $ で割ったあまりと等しい。

$ N $ と相性の良い数が $ K $ 個以上存在するか判定し、存在する場合は $ N $ と相性の良い数のうち $ K $ 番目に小さい値を求めてください。

$ T $ 個のテストケースが与えられるので、それぞれについて答えを求めてください。

  排他的論理和とは  非負整数 $ A,\ B $ の排他的論理和、$ A\ \mathrm{XOR}\ B $ は、以下のように定義されます。

- $ A\ \mathrm{XOR}\ B $ を二進表記した際の $ 2^k $ ($ k\ \geq\ 0 $) の位の数は、$ A,\ B $ を二進表記した際の $ 2^k $ の位の数のうち一方のみが $ 1 $ であれば $ 1 $、そうでなければ $ 0 $ である。
 
 例えば、$ 3\ \mathrm{XOR}\ 5\ =\ 6 $ となります (二進表記すると: $ 011\ \mathrm{XOR}\ 101\ =\ 110 $)。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ T $ $ \text{case}_1 $ $ \text{case}_2 $ $ \vdots $ $ \text{case}_T $

ここで、 $ \text{case}_i $ は $ i $ 番目のテストケースを意味する。

各テストケースは以下の形式で与えられる。

> $ N $ $ K $

## 输出格式

それぞれのテストケースについて、$ N $ と相性の良い数が $ K $ 個以上存在するならば $ K $ 番目に小さい値を、存在しないならば $ -1 $ を出力せよ。

## 说明/提示

### 制約

- $ 1\le\ T\le\ 2\times\ 10^5 $
- $ 1\le\ N,K\le\ 10^9 $
- 入力される値は全て整数

### Sample Explanation 1

$ N=2 $ の場合について考えます。 - $ X=1 $ のとき、 $ X $ と $ N $ の排他的論理和は $ 3 $ 、$ X $ を $ N $ で割ったあまりは $ 1 $ です。したがって、 $ 1 $ は $ N $ と相性の良い数ではありません。 - $ X=2 $ のとき、 $ X $ と $ N $ の排他的論理和は $ 0 $ 、$ X $ を $ N $ で割ったあまりは $ 0 $ です。したがって、 $ 2 $ は $ N $ と相性の良い数です。 - $ X=3 $ のとき、 $ X $ と $ N $ の排他的論理和は $ 1 $ 、$ X $ を $ N $ で割ったあまりは $ 1 $ です。したがって、 $ 3 $ は $ N $ と相性の良い数です。 よって、 $ 2 $ と相性の良い数のうち $ 1 $ 番目に小さい正整数は $ 2 $ 、$ 2 $ 番目に小さい正整数は $ 3 $ です。したがって、 $ \text{case}_1 $ の答えは $ 2 $ 、 $ \text{case}_2 $ の答えは $ 3 $ です。

## 样例 #1

### 输入

```
4
2 1
2 2
1 7
20250126 191
```

### 输出

```
2
3
-1
20381694
```



---

---
title: "A + B"
layout: "post"
diff: 普及/提高-
pid: AT_birthday0410_a
tag: []
---

# A + B

## 题目描述

### 问题描述

> ### A + B 问题
> 
> #### 问题描述
> 
> 编写一个程序来计算两个整数 $A, B$ 的和。
> 
> 保证 $A, B, A + B$ 都能用 $32$ 位有符号整数表示。
>

## 输入格式

> 
> > $A _ 1$ $B _ 1$  
> > $A _ 2$ $B _ 2$  
> > $\dots$  
> > $0$ $0$  
>
> 输入包括最多 $100$ 个测试用例。每个测试用例在一行中给出两个整数 $A$ 和 $B$，用空格分隔。
> 
> 输入以一行 $A = B = 0$ 结束，这一行不需要处理。
> 

> $t$

只有一行包含一个整数 $t$，表示需要找到击败第 $t$ 个回答的测试用例。


### 限制

所有输入数据满足以下限制条件：

- $1 \le t \le 3$

### 评分标准

总共有 3 个测试用例：

- 如果 $t = 1$ 的测试用例正确，将获得 **33 分**。
- 如果 $t = 2$ 的测试用例正确，将获得 **33 分**。
- 如果 $t = 3$ 的测试用例正确，将获得 **34 分**。

---

Translated by User 735713.

## 输出格式

> 
> 对于每个测试用例，输出 $A + B$ 的值，每个结果占一行。

一场比赛的问题 A 已经完成，现在正进入测试阶段。然而，由于疲劳的原因，不幸的是 JAPLJ 在 A + B 问题中出现了 Bug。大学生丸桥，这个比赛的负责人，提出了解决条件……

丸桥说：“你要把错误的源代码改正确，快点！”

你需要为 JAPLJ 的三个错误程序各找出一个能够击败它们的测试用例，并输出这些测试用例。

### 课题

针对 A + B 问题（请参阅问题描述），下面有三个用 C++ 编写的错误程序。为每个错误程序找到一个可以击败它们的测试用例。

更准确地说，对于每个错误程序，请编写一个满足 A + B 问题的描述和输入部分约束的测试用例。当将这个测试用例输入到错误程序中时，该程序将输出错误的答案。编写一个程序来输出这样的测试用例。

回答 1 的源代码:

```cpp
#include <iostream>

using namespace std;

int main()
{
  int A, B;

  while(cin >> A >> B, A+B!=0) {
    cout << A+B << endl;
  }

  return 0;
}
```

回答 2 的源代码：

```cpp
#include <iostream>

using namespace std;

int myAbs(int n)
{
  if(n < 0) return -n;
  else return n;
}

int main()
{
  int A, B;

  while(cin >> A >> B, (A|B) != 0) {
    while(myAbs(A) >= 100000) {
      if(A > 0) {
        B += 100000;
        A -= 100000;
      } else {
        B -= 100000;
        A += 100000;
      }
    }

    if(A > 0) {
      for(int i=0; i<A; ++i) {
        B++;
      }
    } else {
      for(int i=0; i<-A; ++i) {
        B--;
      }
    }

    cout << B << endl;
  }

  return 0;
}
```

回答 3 的源代码：

```cpp
#include<iostream>

using namespace std;

int C[3][32];

int main()
{
  int A, B;

  while(cin >> A >> B, A!=0 || B!=0) {
    for(int i=0; i<32; ++i) {
      C[0][i] = (A >> i) & 1;
      C[1][i] = (B >> i) & 1;
    }

    for(int i=0; i<32; ++i) {
      if(C[0][i] + C[1][i] >= 2) {
        C[C[1][i-1] & 1][i+1]++;
        C[0][i]--;
        C[1][i]--;
      }
      C[2][i] = C[0][i] + C[1][i];
    }

    int R = 0;
    for(int i=0; i<32; ++i) {
      R |= C[2][i] << i;
    }

    cout << R << endl;
  }

  return 0;
}
```


输出一个能够击败第 $t$ 个回答的测试用例。



---

---
title: "Product and GCD"
layout: "post"
diff: 普及/提高-
pid: AT_caddi2018_a
tag: []
---

# Product and GCD

## 题目描述

[problemUrl]: https://atcoder.jp/contests/caddi2018b/tasks/caddi2018_a

$ N $ 個の $ 1 $ 以上の整数 $ a_1,\ a_2,\ ...,\ a_N $ があります． $ a_1,\ a_2,\ ...,\ a_N $ の値はわかりませんが，$ a_1\ \times\ a_2\ \times\ ...\ \times\ a_N\ =\ P $ がわかっています．

$ a_1,\ a_2,\ ...,\ a_N $ の最大公約数として考えられるもののうち，最も大きいものを求めてください．

## 输入格式

入力は以下の形式で標準入力から与えられる．

> $ N $ $ P $

## 输出格式

答えを出力せよ．

## 说明/提示

### 制約

- $ 1\ \leq\ N\ \leq\ 10^{12} $
- $ 1\ \leq\ P\ \leq\ 10^{12} $

### Sample Explanation 1

例えば $ a_1=2,\ a_2=6,\ a_3=2 $ の場合，最大公約数は $ 2 $ となります．

### Sample Explanation 2

$ a_i $ は正の整数なので，$ a_1\ =\ a_2\ =\ a_3\ =\ a_4\ =\ a_5\ =\ 1 $ 以外にはありえません．

## 样例 #1

### 输入

```
3 24
```

### 输出

```
2
```

## 样例 #2

### 输入

```
5 1
```

### 输出

```
1
```

## 样例 #3

### 输入

```
1 111
```

### 输出

```
111
```

## 样例 #4

### 输入

```
4 972439611840
```

### 输出

```
206
```



---

---
title: "Harlequin"
layout: "post"
diff: 普及/提高-
pid: AT_caddi2018_b
tag: []
---

# Harlequin

## 题目描述

[problemUrl]: https://atcoder.jp/contests/caddi2018b/tasks/caddi2018_b

一本のりんごの木があり、$ N $ 色のりんごが実っています。これらのりんごの $ N $ 種類の色には $ 1 $ から $ N $ までの番号が振られており、$ i $ 番の色のりんごは $ a_i $ 個あります。

あなたとダックスフンドのルンルンは、以下の行動を交互に行います (あなたから始めます)。

- 木から $ 1 $ 個以上のりんごを選んで食べる。ただし、一度に選ぶりんごは全て異なる色でなければならない。

木から最後のりんごを食べた者を勝者とします。あなたとルンルンがともに最善を尽くすとき、どちらが勝つでしょうか？

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ a_1 $ $ a_2 $ $ : $ $ a_N $

## 输出格式

あなたが勝つなら `first`、ルンルンが勝つなら `second` と出力せよ。

## 说明/提示

### 制約

- $ 1\ <\ =\ N\ <\ =\ 10^5 $
- $ 1\ <\ =\ a_i\ <\ =\ 10^9 $
- 入力中の値はすべて整数である。

### Sample Explanation 1

$ 1 $ 番の色を赤、$ 2 $ 番の色を青とします。この例では、木には赤いりんご $ 1 $ 個と青いりんご $ 2 $ 個が実っています。 あなたは最初の手番で赤いりんごを食べるべきです。すると、ルンルンは青いりんごのうち片方を食べるほかなく、次の手番であなたがもう片方を食べて勝つことができます。 なお、あなたは最初の手番で両方の色のりんごを $ 1 $ 個ずつ食べることもできます (勝ちには繋がりませんが)。

## 样例 #1

### 输入

```
2

1

2
```

### 输出

```
first
```

## 样例 #2

### 输入

```
3

100000

30000

20000
```

### 输出

```
second
```



---

---
title: "Palindrome-phobia"
layout: "post"
diff: 普及/提高-
pid: AT_cf17_final_b
tag: []
---

# Palindrome-phobia

## 题目描述

[problemUrl]: https://atcoder.jp/contests/cf17-final/tasks/cf17_final_b

すぬけ君は `a`、`b`、`c` の $ 3 $ 種類の文字のみからなる文字列 $ S $ を持っています。

回文恐怖症のすぬけ君は $ S $ の文字を自由に並び替えて、$ 2 $ 文字以上の回文を部分文字列として含まないようにしようと思いました。 これが可能かどうかを判定して下さい。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ S $

## 输出格式

可能な場合は `YES`、不可能な場合は `NO` を出力せよ。

## 说明/提示

### 制約

- $ 1\ \leq\ |S|\ \leq\ 10^5 $
- $ S $ は `a`、`b`、`c` 以外の文字を含まない。

### Sample Explanation 1

このままだと `aba` という回文を含みますが、例えば `acba` のように並び替えると $ 2 $ 文字以上の回文を含まなくなります。

## 样例 #1

### 输入

```
abac
```

### 输出

```
YES
```

## 样例 #2

### 输入

```
aba
```

### 输出

```
NO
```

## 样例 #3

### 输入

```
babacccabab
```

### 输出

```
YES
```



---

---
title: "Time Gap"
layout: "post"
diff: 普及/提高-
pid: AT_cf17_final_c
tag: []
---

# Time Gap

## 题目描述

### 题目大意
给定$n$个数$d$，每个$d$都可以选择变成$24-d$或者保留数值，求任意两个数之间差的最小值中的最大值。

## 输入格式

第一行：$n$\
第二行：$d_1$,$d_2$……$d_n$

## 输出格式

任意两个数之间差的最小值中的最大值。

## 说明/提示

1$\leq$$n$$\leq$50\
0$\leq$$d_i$$\leq$12

## 样例 #1

### 输入

```
3

7 12 8
```

### 输出

```
4
```

## 样例 #2

### 输入

```
2

11 11
```

### 输出

```
2
```

## 样例 #3

### 输入

```
1

0
```

### 输出

```
0
```



---

---
title: "次のアルファベット"
layout: "post"
diff: 普及/提高-
pid: AT_codefestival_2016_qualA_c
tag: []
---

# 次のアルファベット

## 题目描述

# 题意翻译
高桥君有一个仅由小写字母组成的字符串s。高桥君对s执行以下操作正好是k次。在所需位置从字符串s中选择一个字母并将该字母更改为下一个字母。但是,z后面的字母是a。例如，如果选择字符串aaz的第2个字符并执行操作aaz → abz。 然后，如果选择abz的 第3个字符并执行操作，则它变为aba。高桥君 希望在k操作后，按字典顺序使字符串s尽可能小。仅在k次操作后，按字典顺序输出最小的字符串s。

## 输入格式

第一行一个字符串s，第二行一个整数k。

## 输出格式

k次操作后字典顺序最小的字符串s.
# 输入输出样例
## 输入#1
xyz          
4
## 输出#1
aya
## 输入#2
a   
25
## 输出#2
z
## 输入#3
codefestival   
100
## 输出#3
aaaafeaaivap

## 说明/提示

设字符串s的长度为n  
+ 1≤n≤100000
+ 1≤k≤1000000000

## 样例 #1

### 输入

```
xyz

4
```

### 输出

```
aya
```

## 样例 #2

### 输入

```
a

25
```

### 输出

```
z
```

## 样例 #3

### 输入

```
codefestival

100
```

### 输出

```
aaaafeaaivap
```



---

---
title: "K個のケーキ"
layout: "post"
diff: 普及/提高-
pid: AT_codefestival_2016_qualC_b
tag: []
---

# K個のケーキ

## 题目描述

[problemUrl]: https://atcoder.jp/contests/code-festival-2016-qualc/tasks/codefestival_2016_qualC_b

$ K $ 個のケーキがあります。高橋君は、1日に一つずつ、$ K $ 日かけてこれらのケーキを食べようと考えています。

ケーキは$ T $ 種類あり、種類$ i\ (1≦i≦T) $ のケーキは$ a_i $ 個あります。

二日連続で同じ種類のケーキを食べると飽きてしまうため、高橋君は、うまくケーキを食べる順番を決めて、前日と同じ種類のケーキを食べる日数を最小にしようと考えました。

高橋君のために前日と同じ種類のケーキを食べる日数の最小値を求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ K $ $ T $ $ a_1 $ $ a_2 $ $ ... $ $ a_T $

## 输出格式

前日と同じ種類のケーキを食べる日数の最小値を出力せよ。

## 说明/提示

### 制約

- $ 1≦K≦10000,\ 1≦T≦100 $
- $ 1≦a_i≦100 $
- $ a_1+a_2+ $...$ +a_T\ =\ K $

### Sample Explanation 1

ケーキは$ 7 $個あります。例えば種類$ 2,1,2,3,1,3,1 $の順で食べると一度も前日と同じ種類のケーキを食べなくてすみます。

### Sample Explanation 2

ケーキは$ 6 $個あります。種類$ 2,3,2,2,1,2 $の順で食べると4日目だけ前日と同じ種類$ 2 $のケーキを食べることになり、これが最小になるので答えは$ 1 $です。

### Sample Explanation 3

高橋君は一種類のケーキしか持っていないため、2日目以降は毎日前日と同じ種類のケーキを食べるしかありません。

## 样例 #1

### 输入

```
7 3

3 2 2
```

### 输出

```
0
```

## 样例 #2

### 输入

```
6 3

1 4 1
```

### 输出

```
1
```

## 样例 #3

### 输入

```
100 1

100
```

### 输出

```
99
```



---

---
title: "fLIP"
layout: "post"
diff: 普及/提高-
pid: AT_code_festival_2017_quala_b
tag: []
---

# fLIP

## 题目描述

[problemUrl]: https://atcoder.jp/contests/code-festival-2017-quala/tasks/code_festival_2017_quala_b

$ N $ 行 $ M $ 列のマス目があり、最初は全てのマスが白いです。

各行各列には $ 1 $ つずつボタンがあります。 ある行のボタンを押すと、その行のマスの色が全て反転します。すなわち、白なら黒、黒なら白に色が変わります。 また、ある列のボタンを押すと、その列のマスの色が全て反転します。

高橋君は、ボタンを押す操作を好きな回数行うことができます。黒く塗られたマスの個数をちょうど $ K $ 個にすることができるかどうか判定してください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ M $ $ K $

## 输出格式

黒く塗られたマスの個数をちょうど $ K $ 個にできるなら `Yes` を、そうでないなら `No` を出力せよ。

## 说明/提示

### 制約

- $ 1\ \leq\ N,M\ \leq\ 1000 $
- $ 0\ \leq\ K\ \leq\ NM $

### Sample Explanation 1

$ 1 $ 行目、 $ 1 $ 列目の順にボタンを押せばよいです。

### Sample Explanation 3

$ 1 $ 列目、$ 3 $ 列目、$ 2 $ 行目、$ 5 $ 列目の順にボタンを押せばよいです。

## 样例 #1

### 输入

```
2 2 2
```

### 输出

```
Yes
```

## 样例 #2

### 输入

```
2 2 1
```

### 输出

```
No
```

## 样例 #3

### 输入

```
3 5 8
```

### 输出

```
Yes
```

## 样例 #4

### 输入

```
7 9 20
```

### 输出

```
No
```



---

---
title: "Inserting &#39;x&#39;"
layout: "post"
diff: 普及/提高-
pid: AT_code_festival_2017_qualc_c
tag: []
---

# Inserting &#39;x&#39;

## 题目描述

输入一个字符串S，您可以重复执行以下操作：

在S的任意位置（包含开头和结尾），插入一个小写字母 x ， 使其变成回文的字符串。

请输出所需的最少操作次数 ，如果不能变为回文 ，输出 -1 。

## 输入格式

输入文件仅有一行，一个仅包含小写字母的字符串S。

## 输出格式

如果目标可实现 ，则输出所需的最少操作次数。如果不行，请输出-1。

## 样例 #1

### 输入

```
xabxa
```

### 输出

```
2
```

## 样例 #2

### 输入

```
ab
```

### 输出

```
-1
```

## 样例 #3

### 输入

```
a
```

### 输出

```
0
```

## 样例 #4

### 输入

```
oxxx
```

### 输出

```
3
```



---

---
title: "Lock"
layout: "post"
diff: 普及/提高-
pid: AT_code_festival_china_a
tag: []
---

# Lock

## 题目描述

[problemUrl]: https://atcoder.jp/contests/code-festival-2014-china-open/tasks/code_festival_china_a



## 输入格式

Input is given in the following format.

> $ n $

- On the first line, you will be given $ n\ (1\ \leq\ n\ \leq\ 5) $, the number of digits of the dial lock.

## 输出格式

On the first line, output $ m $, the minimum number of procedures to try all combinations of digits.

On the following $ m+1 $ lines, output the combination of digits that appears during the trial in order. If there are more than $ 1 $ possible answer, you may choose any one of them. Make sure to insert a line break at the end of the last line.

## 说明/提示

### Problem

Alice has a box locked with $ n $ digits dial lock. Each dial of the lock can be set to a digit from $ 0 $ to $ 9 $. Unfortunately, she forgot the passcode (of $ n $ digits). Now she will try all possible combinations of digits to unlock the key.

She can do one of the following procedure each time.

- Choose $ 1 $ dial and add $ 1 $ to that digit. (If the digit chosen was $ 9 $, it will be $ 0 $).
- Choose $ 1 $ dial and subtract $ 1 $ from that digit. (If the digit chosen was $ 0 $, it will be $ 9 $).

Curiously, she wants to try all combinations even if she found the correct passcode during the trials. But it is a hard work to try all the $ 10^n $ combinations. Help her by showing the way how to make the procedure less as possible.

Initially, the combination of digits of the lock is set to $ 00..0 $.

Calculate $ m $, the minimum number of procedures to try all combinations of digits, and show the $ m+1 $ combinations of digits after each procedures, including the initial combination $ 00..0 $. If there are more than one possible answer, you may choose any one of them.

Checking if the current combination of digits matches the passcode doesn't count as a procedure.

### Sample Explanation 1

Don't forget to output the minimum number of procedures $ 9 $ on the first line. On the following lines, note that you have to output $ m+1 $ lines including the initial combination $ 0 $.

## 样例 #1

### 输入

```
1
```

### 输出

```
9

0

1

2

3

4

5

6

7

8

9
```

## 样例 #2

### 输入

```
2
```

### 输出

```
99

00

01

02

03

04

05

06

07

08

09

19

18

17

16

15

14

13

12

11

10

20

21

22

23

24

25

26

27

28

29

39

38

37

36

35

34

33

32

31

30

40

41

42

43

44

45

46

47

48

49

59

58

57

56

55

54

53

52

51

50

60

61

62

63

64

65

66

67

68

69

79

78

77

76

75

74

73

72

71

70

80

81

82

83

84

85

86

87

88

89

99

98

97

96

95

94

93

92

91

90
```



---

---
title: "常ならずグラフ"
layout: "post"
diff: 普及/提高-
pid: AT_code_festival_final_e
tag: []
---

# 常ならずグラフ

## 题目描述

[problemUrl]: https://atcoder.jp/contests/code-festival-2014-final/tasks/code_festival_final_e

Tさんは，諸行無常をモットーにいろいろなことに挑戦しています． Tさんはあるコンテストに長期的に参加していますが，そのコンテストにはレーティング機能があり，一度参加する毎にレーティングが変動します．それらの変動はグラフにまとめられています．

今，Tさんは彼のレーティング変動がプロットされたグラフを眺めています．彼はふと，グラフから一部の点を取り除いてそれらを結び，常に上下に変動しているような折れ線グラフ，名付けて「常ならずグラフ」を作りたくなりました． さらに，グラフに含まれる点の数が最も多いものに興味があります．

さて，あなたはTさんのために，彼のレーティング変動がプロットされたグラフから作ることのできる「常ならずグラフ」の中での最大の点の数を求めてあげることにしました．

あなたには，Tさんのあるコンテスト参加後でのレーティングが，$ N $ 個，時系列で与えられます．その中からいくつかの点を取り除き「常ならずグラフ」を作るとき，ありうる点の最大数を求めなさい．常ならずグラフが作れないときは $ 0 $ を出力しなさい．

あるグラフ $ X=\{x_1,x_2,x_3,..x_n\} $ が「常ならずグラフ」であるとは， $ |X| $ が $ 3 $ 以上かつ， $ x_1＜x_2＞x_3＜x_4＞... $ もしくは $ x_1＞x_2＜x_3＞x_4\ <\ ...$ が成り立つことを意味します．
つまり，含まれる頂点数が $ 3 $ 未満のとき，「常ならずグラフ」ではありません．

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ R_1 $ $ R_2 $ … $ R_N $

- $ 1 $ 行目には，Tさんのコンテスト参加回数を表す整数 $ N\ (1\ ≦\ N\ ≦\ 3000) $ が与えられる．
- $ 2 $ 行目には, Tさんが $ i\ (1\ ≦\ i\ ≦\ N) $ 番目のコンテストに参加した直後のレーティング $ R_i\ (-10^5\ ≦\ R_i\ ≦\ 10^5) $ が空白切りで与えられる．

## 输出格式

与えられたグラフからいくつかの点を取り除き「常ならずグラフ」を作るとき，ありうる点の最大数を求め，$ 1 $ 行に出力しなさい．末尾の改行を忘れないこと．

## 样例 #1

### 输入

```
4

1 2 5 1
```

### 输出

```
3
```

## 样例 #2

### 输入

```
5

1 2 3 4 5
```

### 输出

```
0
```



---

---
title: "ループを探せ"
layout: "post"
diff: 普及/提高-
pid: AT_code_festival_relay_f
tag: []
---

# ループを探せ

## 题目描述

# 寻找环


众所周知，顶点数和边数均为 $n$ 的无向图仅包含一个环。

给出一个这样的图，求出图中包含的环的长度。

## 输入格式

* 对于第一行，给出表示图的顶点数的整数 $ n $ ( $ 3\ \leq\ n\ \leq\ 100{,}000 $ ) 。
* 随后的 $n$ 行给出图的边的信息。
* 每个顶点都有从 $1$ 到 $n$ 的编号， $ x_i,\ y_i $ ( $ 1\ \leq\ x_i,y_i\ \leq\ n $ ) 表示顶点 $x_i$ 和 $y_i$ 通过第 $i$ 条边连接。
* 保证所给出的图是连通图，保证不包含自身边或多重边。

## 输出格式

输出图中包含的环的长度。

最后换行，不包含多余的文字或空行。

## 样例 #1

### 输入

```
4

1 2

2 3

3 1

1 4
```

### 输出

```
3
```

## 样例 #2

### 输入

```
4

1 2

2 3

3 4

4 1
```

### 输出

```
4
```



---

---
title: "100個の円"
layout: "post"
diff: 普及/提高-
pid: AT_code_formula_2014_final_f
tag: []
---

# 100個の円

## 题目描述

[problemUrl]: https://atcoder.jp/contests/code-formula-2014-final/tasks/code_formula_2014_final_f

$ 100 $ 個の円があります。 このうち $ k $ 番目の円の半径は $ k $ であることがわかっています。

これを、$ 1500 $ × $ 1500 $ の正方形の中に敷き詰めることにしました。

敷き詰め方の一例を出力してください。

なお、円の中心の座標は、$ x $ 座標、 $ y $ 座標ともに、整数でないといけないことに注意してください。

## 输入格式

入力は与えられない。

## 输出格式

出力形式は、以下のようなものである。

> $ X_1 $ $ Y_1 $ $ X_2 $ $ Y_2 $ : $ X_{100} $ $ Y_{100} $

円の情報を $ 100 $ 行で出力せよ。

$ k $ 行目には、$ k $ 番目の円の中心の $ x $ 座標と $ y $ 座標を表す $ X_k,\ Y_k $ を、スペース区切りで $ 1 $ 行で出力せよ。

なお、出力は整数しか認められず、全ての円が、座標 $ (0,0) $ と $ (1500,1500) $ を結ぶ線分を対角線とする正方形の内部に収まっている必要がある。

円や正方形が接していても良いが、重なることは許されない。

## 说明/提示

### Sample Explanation 1

以上の例では、半径 $ 1 $ の円を座標 $ (1,1) $ に、半径 $ 2 $ の円を座標 $ (5,10) $ に、半径 $ 3 $ の円を座標 $ (500,30) $ に置いています。 上記のような形で、 $ 100 $ 行出力するのが、今回の課題です。

## 样例 #1

### 输入

```
None
```

### 输出

```
1 1

5 10

500 30

:
```



---

---
title: "暴露"
layout: "post"
diff: 普及/提高-
pid: AT_code_thanks_festival_2015_d
tag: []
---

# 暴露

## 题目描述

[problemUrl]: https://atcoder.jp/contests/code-thanks-festival-2015-open/tasks/code_thanks_festival_2015_d

$ 1 $ から $ N $ までの番号が付けられた $ N $ 人の生徒からなるある学園で期末試験が行われた。試験は $ 100 $ 点満点で、どの生徒も非負の整数の得点を獲得した。

この学園ではどの生徒も自分の得点と全受験者の合計点を通知されるが、それ以外の情報は通知されない。

しかしながらどの生徒も他の生徒の得点が気になる。そのため生徒は他の生徒から得点を聞き出し、それらの値を基に他の生徒の得点を予想することにしている。

学園の教師であり、生徒が他の生徒の得点をどれくらい正確に把握しているのかが気になったあなたは、生徒の行動によってどのくらい得点が特定できているのかを調査することにした。

具体的には、以下に示す $ M $ 個の情報クエリあるいは質問クエリを番号の昇順に処理した際の質問クエリの答えを計算することにした。

- クエリには $ 1 $ から $ M $ までの番号が付けられている。どのクエリも $ 3 $ つの整数 $ a_i\ (0\ ≦\ a_i\ ≦\ 1) $, $ b_i\ (1\ ≦\ b_i\ ≦\ N) $, $ c_i\ (1\ ≦\ c_i\ ≦\ N,\ b_i≠c_i) $ によって定められる。
- $ a_i $ = $ 0 $ のとき、クエリ $ i $ は情報クエリである。これは、生徒 $ b_i $ が生徒 $ c_i $ の得点を知ったことを表す。
- $ a_i $ = $ 1 $ のとき、クエリ $ i $ は質問クエリである。これは、生徒 $ b_i $ がクエリ $ i $ までの情報クエリと元々知っている情報のみで、生徒 $ c_i $ の得点が何点以上何点以下であると判定できるのかを答えなければならないことを表す。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ s_1 $ $ s_2 $ : $ s_N $ $ M $ $ a_1 $ $ b_1 $ $ c_1 $ $ a_2 $ $ b_2 $ $ c_2 $ : $ a_M $ $ b_M $ $ c_M $

- $ 1 $ 行目には、学園の生徒数 $ N\ (2\ ≦\ N\ ≦\ 50) $ が与えられる。
- $ 2 $ 行目から $ N $ 行には、生徒の得点が与えられる。$ N $ 行のうち $ i\ (1\ ≦\ i\ ≦\ N) $ 行目には、生徒 $ i $ が獲得した得点 $ s_i\ (0\ ≦\ s_i\ ≦\ 100) $ が与えられる。
- $ N+2 $ 行目には、クエリ数 $ M\ (1\ ≦\ M\ ≦\ 5,000) $ が与えられる。
- $ N+3 $ 行目から $ M $ 行には、クエリの情報が与えられる。$ M $ 行のうち $ i\ (1\ ≦\ i\ ≦\ M) $ 行目には、クエリ $ i $ を定める $ 3 $ つの整数 $ a_i\ (0\ ≦\ a_i\ ≦\ 1) $, $ b_i\ (1\ ≦\ b_i\ ≦\ N) $, $ c_i\ (1\ ≦\ c_i\ ≦\ N,\ b_i≠c_i) $ が空白区切りで与えられる。
- $ 1\ ≦\ i\ ＜\ j\ ≦\ M $ となる整数 $ i $, $ j $ に対して、$ a_i $ = $ a_j $ = $ 0 $ ならば、$ b_i $ ≠ $ b_j $ または $ c_i $ ≠ $ c_j $ が成り立ちます。
- 入力では $ 1\ ≦\ i\ ≦\ M $ を満たすある整数 $ i $ において $ a_i $ = $ 1 $ であること (すなわち少なくとも $ 1 $ つは質問クエリがあること) が保証されています。

## 输出格式

$ M $ 個のクエリ中の質問クエリ数を $ Q $ 個としたとき、出力は $ Q $ 行からなる。$ Q $ 行のうち $ i\ (1\ ≦\ i\ ≦\ Q) $ 行目には、$ i $ 番目の質問クエリに対する答えを出力せよ。$ i $ 番目の質問クエリに対する答えが、$ x $ 点以上 $ y $ 点以下であるという答えならば、$ x $ と $ y $ をこの順に空白区切りで出力せよ。出力の末尾にも改行を入れること。

## 说明/提示

### Sample Explanation 1

生徒は $ 4 $ 人であり、クエリは $ 6 $ 個ある。 - クエリ $ 1 $ は情報クエリである。生徒 $ 2 $ は生徒 $ 3 $ の得点が $ 70 $ 点であることを知る。 - クエリ $ 2 $ は情報クエリである。生徒 $ 4 $ は生徒 $ 2 $ の得点が $ 90 $ 点であることを知る。 - クエリ $ 3 $ は質問クエリである。この時点で生徒 $ 2 $ は合計点が $ 80+90+70+100=340 $ 点であること、生徒 $ 2 $ の得点が $ 90 $ 点であること、生徒 $ 3 $ の得点が $ 70 $ 点であることを知っているので、生徒 $ 4 $ の得点は $ 80 $ 点以上 $ 100 $ 点以下であることがわかる。よって出力の $ 1 $ 行目は `80 100` となる。 - クエリ $ 4 $ は情報クエリである。生徒 $ 2 $ は生徒 $ 4 $ の得点が $ 100 $ 点であることを知る。 - クエリ $ 5 $ は質問クエリである。この時点で生徒 $ 2 $ は合計点および生徒 $ 1 $ 以外すべての生徒の得点を知っているので、生徒 $ 1 $ の得点はちょうど $ 80 $ 点であることがわかる。よって出力の $ 2 $ 行目は `80 80` となる。 - クエリ $ 6 $ は質問クエリである。この時点で生徒 $ 4 $ は合計点が $ 340 $ 点であること、生徒 $ 2 $ の得点が $ 90 $ 点であること、生徒 $ 4 $ の得点が $ 100 $ 点であることを知っているので、生徒 $ 1 $ の得点は $ 50 $ 点以上 $ 100 $ 点以下であることがわかる。よって出力の $ 3 $ 行目は `50 100` となる。

### Sample Explanation 2

既に得点を知っている相手に対して質問クエリが飛んで来る場合もあります。

## 样例 #1

### 输入

```
4

80

90

70

100

6

0 2 3

0 4 2

1 2 4

0 2 4

1 2 1

1 4 1
```

### 输出

```
80 100

80 80

50 100
```

## 样例 #2

### 输入

```
3

25

12

31

3

1 1 2

0 1 2

1 1 2
```

### 输出

```
0 43

12 12
```

## 样例 #3

### 输入

```
7

32

19

22

25

23

17

18

11

0 1 2

0 4 5

0 1 4

0 2 3

0 2 7

1 1 5

1 2 7

1 2 1

0 4 3

1 4 2

1 6 7
```

### 输出

```
0 80

18 18

0 97

0 86

0 100
```



---

---
title: "Concatenated Palindrome"
layout: "post"
diff: 普及/提高-
pid: AT_code_thanks_festival_2017_b
tag: []
---

# Concatenated Palindrome

## 题目描述

[problemUrl]: https://atcoder.jp/contests/code-thanks-festival-2017/tasks/code_thanks_festival_2017_b

英小文字からなる文字列 $ S $ が与えられます。   
 $ S $ の後ろに英小文字からなる任意の文字列 $ T $ (空文字列も含む)を連結することで、回文にしたいです。   
 条件を満たす文字列 $ T $ のうち、$ T $ の最小の長さを求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ S $

## 输出格式

条件を満たす文字列 $ T $ の最小の長さを求めよ。

## 说明/提示

### 制約

- $ 1≦|S|≦50 $ ($ |S| $ は文字列 $ S $ の長さ)
- 文字列 $ S $ は英小文字から成る。

### Sample Explanation 1

$ T="dcba" $ とすると、文字列 $ S $ と 文字列 $ T $ を順番に連結した文字列は回文になります。 この文字列 $ T $ は条件を満たす中で最小の長さであるため、答えは $ 4 $ です。

### Sample Explanation 2

文字列 $ S $ は回文であるため、文字列 $ T $ は空文字列でも条件を満たします。 空文字列の長さは $ 0 $ であるため、答えは $ 0 $ です。

## 样例 #1

### 输入

```
abcde
```

### 输出

```
4
```

## 样例 #2

### 输入

```
level
```

### 输出

```
0
```

## 样例 #3

### 输入

```
codethanksfestival
```

### 输出

```
17
```

## 样例 #4

### 输入

```
abcdefghijklmnopqrstuvwxyzyxwvutsrqponmlkjihgfedcb
```

### 输出

```
1
```



---

---
title: "Bus Tour"
layout: "post"
diff: 普及/提高-
pid: AT_code_thanks_festival_2017_d
tag: []
---

# Bus Tour

## 题目描述

[problemUrl]: https://atcoder.jp/contests/code-thanks-festival-2017/tasks/code_thanks_festival_2017_d

あなたはバスツアーを計画しています。

バスツアーの参加者は必ず $ 1 $ グループ $ N $ 人で申し込みます。運転手を除いた各バスの定員は必ず $ M $ 人です。  
 このバスツアーは、全ての参加者がバスに乗り切れるようなバスの最小台数で行います。   
 同じグループに属する人が必ずしも同じバスに乗り込む必要はありません。

このバスツアーに参加するグループ数には上限がないため、申し込みを締め切るまでバスツアーに参加するグループ数は分かりません。   
 したがって、参加者の申し込み具合によってはバスに空席が生じてしまいます。   
 最大で何席の空席ができるでしょうか?

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ M $

## 输出格式

バスツアーにおける空席の最大数を出力せよ。

## 说明/提示

### 制約

- $ 1≦N≦10^9 $
- $ 1≦M≦10^9 $
- $ N $ と $ M $ は整数である。

### Sample Explanation 1

申し込みが $ 1 $ グループだった場合、参加者 $ 5 $ 人に対して定員 $ 4 $ 名のバス $ 2 $ 台で バスツアーを行うため、$ 3 $ 席の空席が生じます。

### Sample Explanation 2

申し込みグループ数に関わらず、常にバスが満員である場合もあります。

## 样例 #1

### 输入

```
5 4
```

### 输出

```
3
```

## 样例 #2

### 输入

```
1000000 10
```

### 输出

```
0
```

## 样例 #3

### 输入

```
500000000 1000000000
```

### 输出

```
500000000
```



---

---
title: "Two Piles"
layout: "post"
diff: 普及/提高-
pid: AT_cpsco2019_s2_d
tag: []
---

# Two Piles

## 题目描述

[problemUrl]: https://atcoder.jp/contests/cpsco2019-s2/tasks/cpsco2019_s2_d

 $ A $ 枚のコインがある $ 1 $ つの山と、 $ B $ 枚のコインがある $ 1 $ つの山があります。 この$ 2 $つの山を使ってAliceとBobがゲームをします。

Aliceを先手として、$ 2 $ 人は以下の操作を交互に繰り返します。

- $ 1 $ 枚以上のコインがある山を $ 1 $ つ選ぶ。そこにあるコインの枚数を $ X $ とする。
- その後、$ 2 $ つの山からそれぞれ $ 0 $ 枚以上のコインを取り除く。
- ただし、取り除くコインの枚数の合計は $ X $ でなければならない。

 どの山にもコインがなくなった時点で終了し、最後に操作した人が勝ちます。

$ 2 $ 人が最適に行動したとき、Aliceが勝つかどうか判定してください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ A $ $ B $

## 输出格式

Aliceが勝つなら `Yes` を、Bobが勝つなら `No` を出力せよ。

## 说明/提示

### 制約

- $ 1\ \leq\ A\ \leq\ 10^5 $
- $ 1\ \leq\ B\ \leq\ 10^5 $
- 入力はすべて整数である。

### Sample Explanation 1

Aliceがそれぞれの山から $ 1 $ 枚ずつコインを取って $ (1,\ 1) $ にすると、Bobは残りのどちらか $ 1 $ 枚を取って $ (1,\ 0) $ にするしかなく、残りの $ 1 $ 枚をAliceが取って勝利します。

## 样例 #1

### 输入

```
2 2
```

### 输出

```
Yes
```

## 样例 #2

### 输入

```
3 3
```

### 输出

```
No
```



---

---
title: "正方形のチップ"
layout: "post"
diff: 普及/提高-
pid: AT_ddcc_2016_final_a
tag: []
---

# 正方形のチップ

## 题目描述

[problemUrl]: https://atcoder.jp/contests/ddcc2016-final/tasks/ddcc_2016_final_a

半径 $ R $ cmの*ウェーハ*に*ダイシング*という操作を行い、正方形のチップをいくつか作成することにしました。 作成される正方形のチップの個数を求めてください。

ウェーハとは、ある部品を作るのに使われる薄い円盤状の物体です。 ダイシングという操作は、ウェーハの中心から $ C $ cm間隔で水平方向と垂直方向に切れ目を入れてウェーハを分割する操作です。

例として、$ R=15,\ \,\ C=4 $ の例を示します。 破線で示されるようなマス目状に分割がなされ、緑色の領域で示されるような $ 32 $ 個の正方形のチップを作成することができます。

 ![3b83484e97d59df50e3ee39c4a3cbca7.png](https://cdn.luogu.com.cn/upload/vjudge_pic/AT_ddcc_2016_final_a/4884165f81392986b1bb775c3cf1b058de7f8e4a.png)

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ R $ $ C $

## 输出格式

作成される正方形のチップの個数を $ 1 $ 行に出力せよ。

## 说明/提示

### 制約

- $ 1\ ≦\ R,\ \,\ C\ ≦\ 100 $
- $ R,\ \,\ C $ はいずれも整数

### Sample Explanation 1

\- 問題文中で示した通りです。

### Sample Explanation 2

\- ウェーハの中心を $ (0,0) $ としたとき $ (2,3),(3,3),(2,4),(3,4) $ の $ 4 $ 点で表される正方形のチップは $ (3,4) $ がウェーハの周上にありますが、このようなチップも作成することが可能です。

## 样例 #1

### 输入

```
15 4
```

### 输出

```
32
```

## 样例 #2

### 输入

```
5 1
```

### 输出

```
60
```



---

---
title: "C-Filter"
layout: "post"
diff: 普及/提高-
pid: AT_digitalarts_1
tag: []
---

# C-Filter

## 题目描述

[problemUrl]: https://atcoder.jp/contests/digitalarts2012/tasks/digitalarts_1

セキュリティに興味がある高橋君は、デジタルアーツ株式会社に就職したい青年です。  
 彼は、面接で自分をアピールするために、得意なプログラミングでフィルタリングソフト「C-Filter」を作ろうと考えています。  
 「C-Filter」は、与えられた文字列 $ s $ に、あらかじめ登録しておいた「NGワード」と一致する文字列が存在する場合、その文字列の長さと等しい数の `*`に置き換えて出力するソフトウェアです。この文字列を置き換える処理をフィルタリングと呼びます。  
 「NGワード」とは、半角英小文字と`*`から構成されます。`*`はすべての半角英小文字 $ 1 $ 文字と一致します。  
 例えば `myonmyon` は、NGワード`myo*myon`と一致します。  
 ただし、NGワードは単語ごとに適用されるため、`myo myon` はNGワード `myo*myon`とは一致しません。  
 また、NGワードはある単語に対して完全に一致する必要があります。  
 例えば、`abcde`は、NGワード`abc`や`bcd`、`cde`に一致しません。   
  
 文字列 $ s $ と、NGワードが与えられるので、C-Filterの出力する文字列を答えてください。  
 入力は以下の形式で標準入力から与えられる。

> $ s $ $ N $ $ t_{1} $ : : $ t_{N} $

1. 入力は $ N+2 $ 行からなる。
2. $ 1 $ 行目には $ 1 $ 文字以上 $ 1,000 $ 文字以下の文字列 $ s $ が与えられる。

- $ s $ はフィルタリングする対象の文字列を半角スペースで区切って繋げた文字列である。

5. $ 2 $ 行目にはNGワードの個数を表す整数 $ N(0≦N≦50) $ が与えられる。
6. $ 3 $ 行目から $ N+2 $ 行目までNGワードを表す文字列 $ t_{i}(1≦i≦N) $が与えられる。
- 文字列 $ t_{i} $ は半角英小文字と `*` から構成される。
- 文字列 $ t_{i} $ の長さは $ 1 $ 文字以上、 $ 20 $ 文字以下である。
- 文字列 $ t_{i} $ に含まれる `*` は、半角スペースを除くすべての半角英小文字 $ 1 $ 文字をフィルタリングの対象とします。
 
 入力された文字列 $ s $ をC-Filterでフィルタリングした結果を $ 1 $ 行で出力せよ。  
 なお、最後には改行を出力せよ。 ```

abc aaa ababa abcba abc
2
abc
**a**
```

 ```

*** aaa ***** abcba ***
```

- NGワードには`abc`と`**a**`の $ 2 $ つの文字列が登録されています。
- $ 1 $ 番目と $ 5 $ 番目に入力される`abc`はNGワード`abc`に一致するので、`***`と出力されます。
- $ 3 $ 番目に入力される`ababa`はNGワード`**a**`に一致するので、`*****`と出力されます。
 
```

aaaa aaa aaaaaa aaaa
3
a
aa
aaa
```

 ```

aaaa *** aaaaaa aaaa
```

- 完全一致のパターンだけを考慮すれば良いため、`aaaa` や `aaaaa` は変える必要がありません。
 
```

i have a pen
1
*
```

 ```

* have * pen
```

- １文字の単語だけNGワードとして認識されます。
 
```

digital arts
1
digital*arts
```

 ```

digital arts
```

- 半角スペースは`*`にマッチしません。



---

---
title: "Picking Up"
layout: "post"
diff: 普及/提高-
pid: AT_diverta2019_2_b
tag: []
---

# Picking Up

## 题目描述

[problemUrl]: https://atcoder.jp/contests/diverta2019-2/tasks/diverta2019_2_b

$ 2 $ 次元平面上に $ N $ 個のボールがあり、$ i $ 番目のボールは $ (x_i,\ y_i) $ にあります。

まず、$ p\ \neq\ 0 $ または $ q\ \neq\ 0 $ を満たす $ 2 $ つの整数 $ p,\ q $ を決め、その後以下の操作を繰り返してボールを全て回収します。

- 残っているボールを $ 1 $ つ選んで回収する。このボールの座標を $ (a,\ b) $ とする。この時、直前に選んだボールの座標が $ (a\ -\ p,\ b\ -\ q) $ である時コスト $ 0 $ 、そうでない時コスト $ 1 $ かかる。ただし、$ 1 $ つ目に選んだボールについては必ずコスト $ 1 $ かかる。

$ p,\ q $ を最適に選んだ場合にボールを全て回収するのにかかるコストの和の最小値を計算してください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ x_1 $ $ y_1 $ $ : $ $ x_N $ $ y_N $

## 输出格式

ボールを全て回収するのにかかるコストの和の最小値を出力せよ。

## 说明/提示

### 制約

- $ 1\ \leq\ N\ \leq\ 50 $
- $ |x_i|,\ |y_i|\ \leq\ 10^9 $
- $ x_i\ \neq\ x_j $ または $ y_i\ \neq\ y_j\ (i\ \neq\ j) $
- 入力は全て整数である

### Sample Explanation 1

$ p\ =\ 1,\ q\ =\ 1 $ とすると、$ (1,\ 1) $ のボール、$ (2,\ 2) $ のボールの順に選ぶことでコスト $ 1 $ でボールを全て回収することができます。

### Sample Explanation 2

$ p\ =\ -3,\ q\ =\ -2 $ とすると、$ (7,\ 8) $ のボール、$ (4,\ 6) $ のボール、$ (1,\ 4) $ のボールの順に選ぶことでコスト $ 1 $ でボールを全て回収することができます。

## 样例 #1

### 输入

```
2

1 1

2 2
```

### 输出

```
1
```

## 样例 #2

### 输入

```
3

1 4

4 6

7 8
```

### 输出

```
1
```

## 样例 #3

### 输入

```
4

1 1

1 2

2 1

2 2
```

### 输出

```
2
```



---

---
title: "Successive Subtraction"
layout: "post"
diff: 普及/提高-
pid: AT_diverta2019_2_c
tag: []
---

# Successive Subtraction

## 题目描述

[problemUrl]: https://atcoder.jp/contests/diverta2019-2/tasks/diverta2019_2_c

黒板に $ A_1,\ A_2,\ ...,\ A_N $ の $ N $ 個の整数が書かれています。

以下の操作を $ N-1 $ 回繰り返して黒板にただ $ 1 $ つの整数が書かれているようにします。

- $ 2 $ 個の整数 $ x,\ y $ を選んで消し、新たに $ 1 $ 個の整数 $ x-y $ を書く。

ただ $ 1 $ つ残る整数としてありうる値の最大値と、その最大値を達成する操作列を求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ A_1 $ $ A_2 $ $ ... $ $ A_N $

## 输出格式

ただ $ 1 $ つ残る整数としてありうる値の最大値 $ M $ と、その最大値を達成する操作列 $ x_i,\ y_i $ を以下の形式に従って出力せよ。

ただし、$ x_i,\ y_i $ は $ i $ 回目の操作で選ぶ $ x,\ y $ を表す。

また、最大値を達成する操作列が複数存在する場合は、そのうちどれを出力しても良い。

> $ M $ $ x_1 $ $ y_1 $ $ : $ $ x_{N-1} $ $ y_{N-1} $

## 说明/提示

### 制約

- $ 2\ \leq\ N\ \leq\ 10^5 $
- $ -10^4\ \leq\ A_i\ \leq\ 10^4 $
- 入力は全て整数である

### Sample Explanation 1

$ 1 $ 回目の操作で $ x $ として $ -1 $、$ y $ として$ 1 $ を選ぶと、黒板に書かれている整数は $ (-2,\ 2) $ になります。 $ 2 $ 回目の操作で $ x $ として $ 2 $、$ y $ として$ -2 $ を選ぶと、黒板に書かれている整数は $ (4) $ になります。 よって $ 4 $ がただ $ 1 $ つ残り、$ 5 $ 以上の整数がただ $ 1 $ つ残ることはないので、これが最大です。

## 样例 #1

### 输入

```
3

1 -1 2
```

### 输出

```
4

-1 1

2 -2
```

## 样例 #2

### 输入

```
3

1 1 1
```

### 输出

```
1

1 1

1 0
```



---

---
title: "AB Substrings"
layout: "post"
diff: 普及/提高-
pid: AT_diverta2019_c
tag: []
---

# AB Substrings

## 题目描述

[problemUrl]: https://atcoder.jp/contests/diverta2019/tasks/diverta2019_c

すぬけ君は $ N $ 個の文字列を持っています。$ i $ 番目の文字列は $ s_i $ です。

これらの文字列を好きな順序で並べたあと、連結して $ 1 $ つの文字列を作ることを考えます。 作った文字列に `AB` という部分文字列が含まれる個数としてありうる値のうち、最大値を求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ s_1 $ $ \vdots $ $ s_N $

## 输出格式

答えを出力せよ。

## 说明/提示

### 制約

- $ 1\ \leq\ N\ \leq\ 10^{4} $
- $ 2\ \leq\ |s_i|\ \leq\ 10 $
- $ s_i $ は英大文字のみからなる

### Sample Explanation 1

\- 例えば、`ABCA`, `BAD`, `XBAZ` の順で連結して `ABCABADXBAZ` を作ったとき、`AB` という部分文字列は $ 2 $ つ含まれます。

## 样例 #1

### 输入

```
3

ABCA

XBAZ

BAD
```

### 输出

```
2
```

## 样例 #2

### 输入

```
9

BEWPVCRWH

ZZNQYIJX

BAVREA

PA

HJMYITEOX

BCJHMRMNK

BP

QVFABZ

PRGKSPUNA
```

### 输出

```
4
```

## 样例 #3

### 输入

```
7

RABYBBE

JOZ

BMHQUVA

BPA

ISU

MCMABAOBHZ

SZMEHMA
```

### 输出

```
4
```



---

---
title: "DivRem Number"
layout: "post"
diff: 普及/提高-
pid: AT_diverta2019_d
tag: []
---

# DivRem Number

## 题目描述

[problemUrl]: https://atcoder.jp/contests/diverta2019/tasks/diverta2019_d

すぬけ君は高橋君から正の整数 $ N $ をもらいました。 正の整数 $ m $ が以下の条件を満たすとき、 *お気に入りの数* と呼ばれます。

- $ N $ を $ m $ で割った商とあまりが等しい、すなわち $ \lfloor\ \frac{N}{m}\ \rfloor\ =\ N\ \bmod\ m $ が成立する

お気に入りの数を全て求め、その総和を出力してください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $

## 输出格式

答えを出力せよ。

## 说明/提示

### 制約

- 入力は全て整数
- $ 1\ \leq\ N\ \leq\ 10^{12} $

### Sample Explanation 1

\- お気に入りの数は $ 3 $ と $ 7 $ の $ 2 $ つです。これらの総和である $ 10 $ を出力してください。

### Sample Explanation 2

\- オーバーフローに注意してください。

## 样例 #1

### 输入

```
8
```

### 输出

```
10
```

## 样例 #2

### 输入

```
1000000000000
```

### 输出

```
2499686339916
```



---

---
title: "Tokyo 7th シスターズ"
layout: "post"
diff: 普及/提高-
pid: AT_donuts_2015_2
tag: []
---

# Tokyo 7th シスターズ

## 题目描述

[problemUrl]: https://atcoder.jp/contests/donuts-2015/tasks/donuts_2015_2

[![](https://cdn.luogu.com.cn/upload/vjudge_pic/AT_donuts_2015_2/74c2b3e1b85ca8314470521a99add6ad2f49176a.png)](http://t7s.jp/)[《东京 7th Sisters》](https://mzh.moegirl.org.cn/%E4%B8%9C%E4%BA%AC_7th_Sisters)是一款集成了偶像育成、音乐节奏和文字冒险三大要素的手机网络社交游戏，可以在 iPhone 和 Android 设备上玩。 您正在考虑某些游戏规格的简化版本。


在这款简化规格的游戏中，可以从众多偶像中选择九个不同的偶像，组成一个单位进行节奏游戏和舞台对战。在这种情况下，游戏中使用的单位的基本能力值由所选偶像的能力值总和决定。

游戏还有一个连击系统，玩家可以通过满足连击要求获得连击奖励。如果一个单位有三个或三个以上的成员满足组合规定的条件，该单位就会获得该组合的奖励。对于每个组合，你都可以提前知道哪些偶像将满足指定条件。

单位的最终能力值是单位的基础能力值加上所有组合奖励的总和。

我们希望通过组合偶像来尽可能提高单位的最终能力值。 找出最大最终能力值。

请注意，本题中的单位组合和组合是简化规格，与《东京 7th Sisters》的规格略有不同。

## 输入格式

输入通过如下标准格式输入

> $ N $ $ M $ $ A_1 $ $ A_2 $ ．．． $ A_N $ $ B_1 $ $ C_1 $ $ I_{1,1} $ $ I_{1,2} $ ．．． $ I_{1,C_1} $ $ B_2 $ $ C_2 $ $ I_{2,1} $ $ I_{2,2} $ ．．． $ I_{2,C_2} $ : $ B_M $ $ C_M $ $ I_{M,1} $ $ I_{M,2} $ ．．． $ I_{M,C_M} $

- 第$ 1 $ 行给出了可选偶像的数量 $ N\ (9≦N≦16) $ ，以及仅使用可选偶像生成的组合数 $ M\ (0≦M≦50) $ ，中间用空格隔开。
- 第$ 2 $ 行中有 $ N $ 个整数，用空格隔开。 第 $ i $ 个整数代表第 $ i $ 个偶像的基本能力值 $A_i(1≤A_i≤10,000)$。
- 在 $ 3 $ 至 $ M $ 行中，给出了各自组合的信息。 其中，$ i $(1≤i≤M) 行给出了 $ i $ 个组合的信息，用空格分隔。 组合信息由几个整数组成，其中第一个整数 $ B_i（1≤ B_i≤10,000）$代表第 $ i $ 个组合的组合奖金。第二个整数 $ C_i(3≤C_i≤N)$，代表满足该组合条件的偶像数量。 随后的第三个整数 $ j\ (1≤j≤C_i) $ ，代表有多少偶像满足条件 $ I_{i,j}(1≤I_{i,j}≤N) $。 如果 $ j≠k $ 满足条件，那么 $ I_{i,j}≠ I_{i,k} $ 满足条件。

## 输出格式

在一行上输出单位的最大最终能力值。

### 样例 #1

#### 样例输入 #1

```
10 1
100 200 300 400 500 600 700 800 900 1000
1000 3 1 2 3
```

#### 样例输出 #1

```
6100
```

### 样例 #2

#### 样例输入 #2

```
12 10
1000 1000 1000 1000 1000 1000 1000 1000 1000 1000 1000 1000
1000 4 1 2 4 7
1000 4 1 9 11 12
1000 4 3 5 8 9
1000 4 6 10 11 12
1000 4 2 4 7 10
1000 4 1 8 9 10
1000 3 1 9 12
1000 4 3 8 11 12
1000 4 1 2 3 4
1000 4 7 8 9 10
```

#### 样例输出 #2

```
19000
```

### 样例 #3

#### 样例输入 #3

```
13 8
328 781 104 102 132 108 100 102 104 108 168 102 100
184 4 10 11 3 4
190 4 9 6 2 5
282 6 9 1 3 12 10 8
205 8 13 10 1 12 7 2 8 11
122 8 13 5 4 3 8 9 12 10
112 7 11 6 12 8 2 13 5
102 4 4 13 6 12
109 6 7 2 13 1 8 6
```

#### 样例输出 #3

```
3239
```

## 样例 #1

### 输入

```
10 1

100 200 300 400 500 600 700 800 900 1000

1000 3 1 2 3
```

### 输出

```
6100
```

## 样例 #2

### 输入

```
12 10

1000 1000 1000 1000 1000 1000 1000 1000 1000 1000 1000 1000

1000 4 1 2 4 7

1000 4 1 9 11 12

1000 4 3 5 8 9

1000 4 6 10 11 12

1000 4 2 4 7 10

1000 4 1 8 9 10

1000 3 1 9 12

1000 4 3 8 11 12

1000 4 1 2 3 4

1000 4 7 8 9 10
```

### 输出

```
19000
```

## 样例 #3

### 输入

```
13 8

328 781 104 102 132 108 100 102 104 108 168 102 100

184 4 10 11 3 4

190 4 9 6 2 5

282 6 9 1 3 12 10 8

205 8 13 10 1 12 7 2 8 11

122 8 13 5 4 3 8 9 12 10

112 7 11 6 12 8 2 13 5

102 4 4 13 6 12

109 6 7 2 13 1 8 6
```

### 输出

```
3239
```



---

---
title: "サバゲー"
layout: "post"
diff: 普及/提高-
pid: AT_donuts_live2014_4
tag: []
---

# サバゲー

## 题目描述

[problemUrl]: https://atcoder.jp/contests/donuts-live2014/tasks/donuts_live2014_4

パンチくんが運営している会社では、サバイバルゲームが大流行りです。

通常のサバイバルゲームはチームが $ 2 $ つですが、パンチくんは普通のゲームに飽きてしまったため、多くのチームで対戦することにしました。

参加人数と、チームの数が与えられるので、チームの分け方が何パターンあるか求めて下さい。

ただし、各参加者は必ずどれか $ 1 $ つだけのチームに所属するものとし、また $ 0 $ 人のチームがあってはならないものとします。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ M $

- サバイバルゲームに参加する人数 $ N\ (2\ ≦\ N\ ≦\ 1000) $ と、チームの数 $ M\ (2\ ≦\ M\ ≦\ N) $ が与えられる。

## 输出格式

チームの分け方のパターン数を $ 1000000007(\ =\ 1,000,000,007) $ で割った余りを出力せよ。出力の末尾には改行をいれること。

## 说明/提示

### 部分点

$ M\ =\ 2 $ を満たすテストケースに正解した場合、部分点として $ 40 $ 点が与えられる。

### Sample Explanation 1

$ 2 $ 人を $ 2 $ チームに分ける分け方は、 $ 1 $ 通りしかありません。

### Sample Explanation 2

$ 3 $ 人を $ 2 $ チームに分ける分け方は、 - { $ A,\ B $ }, { $ C $ } - { $ A,\ C $ }, { $ B $ } - { $ A $ }, { $ B,\ C $ } の $ 3 $ 通りです。 参加者は互いに区別がつきますが、チームは区別がつかないことに注意して下さい。 { $ A,\ B $ }, { $ C $ }と、{ $ C $ }, { $ A,\ B $ } は同じものとしてカウントします。

## 样例 #1

### 输入

```
2 2
```

### 输出

```
1
```

## 样例 #2

### 输入

```
3 2
```

### 输出

```
3
```

## 样例 #3

### 输入

```
500 2
```

### 输出

```
695241506
```

## 样例 #4

### 输入

```
20 10
```

### 输出

```
584923236
```



---

---
title: "Knapsack 2"
layout: "post"
diff: 普及/提高-
pid: AT_dp_e
tag: []
---

# Knapsack 2

## 题目描述

$N$ 个物品被编号为 $1, 2, \ldots, N$。对于 $1 \leq i \leq N$，物品 $i$ 的重量是 $w _ i$，价值是 $v _ i$。

太郎君决定从 $N$ 个物品中选择一些放入背包中带回家。背包的容量为 $W$，带回的物品的总重量不能超过 $W$。

请计算太郎君能带回的物品的最大总价值。

## 输入格式

输入以以下格式从标准输入中提供：

> $N$ $W$  
> $w _ 1$ $v _ 1$  
> $w _ 2$ $v _ 2$  
> $\ldots$  
> $w _ N$ $v _ N$

## 输出格式

输出太郎君能带回的物品的最大总价值。

### 限制条件

- 所有输入均为整数。
- $1 \leq N \leq 100$
- $1 \leq W \leq 10 ^ 9$
- $1 \leq w _ i \leq W$
- $1 \leq v _ i \leq 10 ^ 3$

### 样例解释 1

可以选择物品 $1$ 和 $3$。这样，总重量为 $3 + 5 = 8$，总价值为 $30 + 60 = 90$。

### 样例解释 3

可以选择物品 $2, 4, 5$。这样，总重量为 $5 + 6 + 3 = 14$，总价值为 $6 + 6 + 5 = 17$。

---

Translated by User 735713.

## 样例 #1

### 输入

```
3 8

3 30

4 50

5 60
```

### 输出

```
90
```

## 样例 #2

### 输入

```
1 1000000000

1000000000 10
```

### 输出

```
10
```

## 样例 #3

### 输入

```
6 15

6 5

5 6

6 4

6 6

3 5

7 2
```

### 输出

```
17
```



---

---
title: "LCS"
layout: "post"
diff: 普及/提高-
pid: AT_dp_f
tag: []
---

# LCS

## 题目描述

给定一个字符串 $s$ 和一个字符串 $t$ ，输出 $s$ 和 $t$ 的最长公共子序列。

## 输入格式

两行，第一行输入 $s$ ，第二行输入 $t$ 。

## 输出格式

输出 $s$ 和 $t$ 的最长公共子序列。如果有多种答案，输出任何一个都可以。

## 说明/提示

数据保证 $s$ 和 $t$ 仅含英文小写字母，并且 $s$ 和 $t$ 的长度小于等于3000。

## 样例 #1

### 输入

```
axyb

abyxb
```

### 输出

```
axb
```

## 样例 #2

### 输入

```
aa

xayaz
```

### 输出

```
aa
```

## 样例 #3

### 输入

```
a

z
```

### 输出

```

```

## 样例 #4

### 输入

```
abracadabra

avadakedavra
```

### 输出

```
aaadara
```



---

---
title: "Longest Path"
layout: "post"
diff: 普及/提高-
pid: AT_dp_g
tag: []
---

# Longest Path

## 题目描述

[problemUrl]: https://atcoder.jp/contests/dp/tasks/dp_g

$ N $ 頂点 $ M $ 辺の有向グラフ $ G $ があります。 頂点には $ 1,\ 2,\ \ldots,\ N $ と番号が振られています。 各 $ i $ ($ 1\ \leq\ i\ \leq\ M $) について、$ i $ 番目の有向辺は頂点 $ x_i $ から $ y_i $ へ張られています。 $ G $ は**有向閉路を含みません**。

$ G $ の有向パスのうち、最長のものの長さを求めてください。 ただし、有向パスの長さとは、有向パスに含まれる辺の本数のことです。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ M $ $ x_1 $ $ y_1 $ $ x_2 $ $ y_2 $ $ : $ $ x_M $ $ y_M $

## 输出格式

$ G $ の有向パスのうち、最長のものの長さを出力せよ。

## 说明/提示

### 制約

- 入力はすべて整数である。
- $ 2\ \leq\ N\ \leq\ 10^5 $
- $ 1\ \leq\ M\ \leq\ 10^5 $
- $ 1\ \leq\ x_i,\ y_i\ \leq\ N $
- ペア $ (x_i,\ y_i) $ はすべて相異なる。
- $ G $ は**有向閉路を含まない**。

### Sample Explanation 1

次図の赤い有向パスが最長です。 ![](https://img.atcoder.jp/dp/longest_0_muffet.png)

### Sample Explanation 2

次図の赤い有向パスが最長です。 ![](https://img.atcoder.jp/dp/longest_1_muffet.png)

### Sample Explanation 3

例えば、次図の赤い有向パスが最長です。 ![](https://img.atcoder.jp/dp/longest_2_muffet.png)

## 样例 #1

### 输入

```
4 5

1 2

1 3

3 2

2 4

3 4
```

### 输出

```
3
```

## 样例 #2

### 输入

```
6 3

2 3

4 5

5 6
```

### 输出

```
2
```

## 样例 #3

### 输入

```
5 8

5 3

2 3

2 4

5 2

5 1

1 4

4 3

1 3
```

### 输出

```
3
```



---

---
title: "Stones"
layout: "post"
diff: 普及/提高-
pid: AT_dp_k
tag: []
---

# Stones

## 题目描述

$N$ 个正整数组成的集合 $A = \{ a _ 1, a _ 2, \ldots, a _ N \}$。太郎君和次郎君将用以下游戏进行对决。

首先，准备一个有 $K$ 个石子的堆。两人依次进行以下操作。太郎君先手。

- 从集合 $A$ 中选择一个元素 $x$，从石堆中恰好移除 $x$ 个石子。

不能进行操作的人输掉游戏。当两人都按照最优策略行动时，判断谁会获胜。

## 输入格式

输入以以下格式从标准输入中提供：

> $N$ $K$  
> $a_1$ $a_2$ $\ldots$ $a_N$

## 输出格式

如果先手太郎君获胜，输出 `First`；如果后手次郎君获胜，输出 `Second`。

### 限制条件

- 所有输入均为整数。
- $1 \leq N \leq 100$
- $1 \leq K \leq 10^5$
- $1 \leq a _ 1 < a _ 2 < \cdots < a _ N \leq K$

### 样例解释 1

先手取走 $3$ 个石子，后手无法进行操作。因此，先手获胜。

### 样例解释 2

无论先手如何操作，后手总能获胜：

- 如果先手取走 $2$ 个石子，后手取走 $3$ 个石子，先手将无法进行操作。
- 如果先手取走 $3$ 个石子，后手取走 $2$ 个石子，先手将无法进行操作。

### 样例解释 3

先手可以取走 $2$ 个石子。之后，无论后手如何操作，先手都能获胜：

- 如果后手取走 $2$ 个石子，先手取走 $3$ 个石子，后手将无法进行操作。
- 如果后手取走 $3$ 个石子，先手取走 $2$ 个石子，后手将无法进行操作。

---

Translated by User 735713.

## 样例 #1

### 输入

```
2 4

2 3
```

### 输出

```
First
```

## 样例 #2

### 输入

```
2 5

2 3
```

### 输出

```
Second
```

## 样例 #3

### 输入

```
2 7

2 3
```

### 输出

```
First
```

## 样例 #4

### 输入

```
3 20

1 2 3
```

### 输出

```
Second
```

## 样例 #5

### 输入

```
3 21

1 2 3
```

### 输出

```
First
```

## 样例 #6

### 输入

```
1 100000

1
```

### 输出

```
Second
```



---

---
title: "Deque"
layout: "post"
diff: 普及/提高-
pid: AT_dp_l
tag: []
---

# Deque

## 题目描述

[problemUrl]: https://atcoder.jp/contests/dp/tasks/dp_l

太郎君と次郎君が次のゲームで勝負します。

最初に、数列 $ a\ =\ (a_1,\ a_2,\ \ldots,\ a_N) $ が与えられます。 $ a $ が空になるまで、二人は次の操作を交互に行います。 先手は太郎君です。

- $ a $ の先頭要素または末尾要素を取り除く。 取り除いた要素を $ x $ とすると、操作を行った人は $ x $ 点を得る。

ゲーム終了時の太郎君の総得点を $ X $、次郎君の総得点を $ Y $ とします。 太郎君は $ X\ -\ Y $ を最大化しようとし、次郎君は $ X\ -\ Y $ を最小化しようとします。

二人が最適に行動すると仮定したとき、$ X\ -\ Y $ を求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ a_1 $ $ a_2 $ $ \ldots $ $ a_N $

## 输出格式

二人が最適に行動すると仮定したとき、$ X\ -\ Y $ を出力せよ。

## 说明/提示

### 制約

- 入力はすべて整数である。
- $ 1\ \leq\ N\ \leq\ 3000 $
- $ 1\ \leq\ a_i\ \leq\ 10^9 $

### Sample Explanation 1

二人が最適に行動すると、次のように操作が行われます。 操作対象の要素を太字で表しています。 - 先手: (10, 80, 90, \*\*30\*\*) → (10, 80, 90) - 後手: (10, 80, \*\*90\*\*) → (10, 80) - 先手: (10, \*\*80\*\*) → (10) - 後手: (\*\*10\*\*) → () このとき、$ X\ =\ 30\ +\ 80\ =\ 110 $, $ Y\ =\ 90\ +\ 10\ =\ 100 $ となります。

### Sample Explanation 2

二人が最適に行動すると、例えば次のように操作が行われます。 - 先手: (\*\*10\*\*, 100, 10) → (100, 10) - 後手: (\*\*100\*\*, 10) → (10) - 先手: (\*\*10\*\*) → () このとき、$ X\ =\ 10\ +\ 10\ =\ 20 $, $ Y\ =\ 100 $ となります。

### Sample Explanation 4

答えは 32-bit 整数型に収まらない場合があります。

### Sample Explanation 5

二人が最適に行動すると、例えば次のように操作が行われます。 - 先手: (4, 2, 9, 7, 1, \*\*5\*\*) → (4, 2, 9, 7, 1) - 後手: (\*\*4\*\*, 2, 9, 7, 1) → (2, 9, 7, 1) - 先手: (2, 9, 7, \*\*1\*\*) → (2, 9, 7) - 後手: (2, 9, \*\*7\*\*) → (2, 9) - 先手: (2, \*\*9\*\*) → (2) - 後手: (\*\*2\*\*) → () このとき、$ X\ =\ 5\ +\ 1\ +\ 9\ =\ 15 $, $ Y\ =\ 4\ +\ 7\ +\ 2\ =\ 13 $ となります。

## 样例 #1

### 输入

```
4

10 80 90 30
```

### 输出

```
10
```

## 样例 #2

### 输入

```
3

10 100 10
```

### 输出

```
-80
```

## 样例 #3

### 输入

```
1

10
```

### 输出

```
10
```

## 样例 #4

### 输入

```
10

1000000000 1 1000000000 1 1000000000 1 1000000000 1 1000000000 1
```

### 输出

```
4999999995
```

## 样例 #5

### 输入

```
6

4 2 9 7 1 5
```

### 输出

```
2
```



---

---
title: "Slimes"
layout: "post"
diff: 普及/提高-
pid: AT_dp_n
tag: []
---

# Slimes

## 题目描述

[problemUrl]: https://atcoder.jp/contests/dp/tasks/dp_n

$ N $ 匹のスライムが横一列に並んでいます。 最初、左から $ i $ 番目のスライムの大きさは $ a_i $ です。

太郎君は、すべてのスライムを合体させて $ 1 $ 匹のスライムにしようとしています。 スライムが $ 1 $ 匹になるまで、太郎君は次の操作を繰り返し行います。

- 左右に隣り合う $ 2 $ 匹のスライムを選び、それらを合体させて新しい $ 1 $ 匹のスライムにする。 合体前の $ 2 $ 匹のスライムの大きさを $ x $ および $ y $ とすると、合体後のスライムの大きさは $ x\ +\ y $ となる。 このとき、太郎君は $ x\ +\ y $ のコストを支払う。 なお、合体の前後でスライムたちの位置関係は変わらない。

太郎君が支払うコストの総和の最小値を求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ a_1 $ $ a_2 $ $ \ldots $ $ a_N $

## 输出格式

太郎君が支払うコストの総和の最小値を出力せよ。

## 说明/提示

### 制約

- 入力はすべて整数である。
- $ 2\ \leq\ N\ \leq\ 400 $
- $ 1\ \leq\ a_i\ \leq\ 10^9 $

### Sample Explanation 1

次のように操作を行えばよいです。 操作対象のスライムを太字で表しています。 - (\*\*10\*\*, \*\*20\*\*, 30, 40) → (\*\*30\*\*, 30, 40) - (\*\*30\*\*, \*\*30\*\*, 40) → (\*\*60\*\*, 40) - (\*\*60\*\*, \*\*40\*\*) → (\*\*100\*\*)

### Sample Explanation 2

例えば、次のように操作を行えばよいです。 - (\*\*10\*\*, \*\*10\*\*, 10, 10, 10) → (\*\*20\*\*, 10, 10, 10) - (20, \*\*10\*\*, \*\*10\*\*, 10) → (20, \*\*20\*\*, 10) - (20, \*\*20\*\*, \*\*10\*\*) → (20, \*\*30\*\*) - (\*\*20\*\*, \*\*30\*\*) → (\*\*50\*\*)

### Sample Explanation 3

答えは 32-bit 整数型に収まらない場合があります。

### Sample Explanation 4

例えば、次のように操作を行えばよいです。 - (7, 6, 8, 6, \*\*1\*\*, \*\*1\*\*) → (7, 6, 8, 6, \*\*2\*\*) - (7, 6, 8, \*\*6\*\*, \*\*2\*\*) → (7, 6, 8, \*\*8\*\*) - (\*\*7\*\*, \*\*6\*\*, 8, 8) → (\*\*13\*\*, 8, 8) - (13, \*\*8\*\*, \*\*8\*\*) → (13, \*\*16\*\*) - (\*\*13\*\*, \*\*16\*\*) → (\*\*29\*\*)

## 样例 #1

### 输入

```
4

10 20 30 40
```

### 输出

```
190
```

## 样例 #2

### 输入

```
5

10 10 10 10 10
```

### 输出

```
120
```

## 样例 #3

### 输入

```
3

1000000000 1000000000 1000000000
```

### 输出

```
5000000000
```

## 样例 #4

### 输入

```
6

7 6 8 6 1 1
```

### 输出

```
68
```



---

---
title: "すべては1になる"
layout: "post"
diff: 普及/提高-
pid: AT_fuka_insider
tag: []
---

# すべては1になる

## 题目描述

[problemUrl]: https://atcoder.jp/contests/fuka5/tasks/fuka_insider





---

---
title: "流れ"
layout: "post"
diff: 普及/提高-
pid: AT_fuka_liquid
tag: []
---

# 流れ

## 题目描述

有一个$w\times h$的网格，网格上的每个格子都有对应的高度。

现在，往方格上倒水。

当某个方格内有水，而相邻的方格又比此方格低时，水就会向相邻的方格扩散。

两个方格在有同一条边时被认为是相邻的。

求一格水扩散的方格数量。

## 输入格式

输入文件有多组数据，输入三个$0$表示结束。

对于每组数据，用以下形式给出。

$w\;h\;p$

$Z_{0,0}\;Z_{0,1}\cdots\!Z_{0,w-1}$\
$Z_{1,0}\;Z_{1,1}\cdots\!Z_{1,w-1}$\
$\cdots$\
$Z_{h-1,0},Z_{h-1,1}\cdots\!Z_{h-1,w-1}$

$X_{1} Y_{1}$\
$\cdots$\
$X_{p} Y_{p}$

其中每组数据的第一行为$3$个整数$w,h,p$，

其中$w,h$表示网格的边长，$p$表示倒水的次数。

接下来$h$行，每行$w$个整数$Z_{i,j}$，

表示第$i$行第$j$列的方格的高度。

接下来$p$行，每行$2$个整数$X_{i},Y_{i}$，

表示在第$X_{i}$行第$Y_{i}$列的方格倒水。

数据存在往倒过水的方格再次倒水的情况。

测试数据不超过$20$个。

## 输出格式

对于每组测试数据，输出一行一个整数，表示水扩散到的方格数量。
### 输入样例
```
2 2 1
1 0
0 1
1 0
2 2 1
1 0
0 1
1 1
1 1 0
100
5 5 2
5 4 5 5 5
5 3 5 1 5
5 2 1 2 5
5 3 5 3 5
5 5 5 5 5
0 0
2 2
0 0 0
```
### 输出样例
```
1
3
0
5
```

## 说明/提示

$1\leq w,h\leq 20$\
$0\leq p\leq w \times h$\
$0\leq Z_{i,j}\leq 100$\
$0\leq X_{i}<w$\
$0\leq Y_{i}<h$



---

---
title: "国際情報オリンピック日本代表プログラミングコンテスト (Welcome to IJPC)"
layout: "post"
diff: 普及/提高-
pid: AT_ijpc_ijpc
tag: []
---

# 国際情報オリンピック日本代表プログラミングコンテスト (Welcome to IJPC)

## 题目描述

[problemUrl]: https://atcoder.jp/contests/ijpc2012pr/tasks/ijpc_ijpc





---

---
title: "Table Tennis"
layout: "post"
diff: 普及/提高-
pid: AT_indeednow_2015_finala_a
tag: []
---

# Table Tennis

## 题目描述

[problemUrl]: https://atcoder.jp/contests/indeednow-finala-open/tasks/indeednow_2015_finala_a

 Indeed 社のオフィスには卓球台がある。  
 $ n $ 人の社員が卓球のダブルスで試合をすることにした。  
 $ 2 $ 人ずつのペアを作ることにしたが、みんなが楽しめるようにできるだけ各ペアの強さを均等にしたいと考えている。  
 $ i $ 番目の人の卓球の強さは $ a_i $ で表され、ペアの強さは $ 2 $ 人の強さの和で決まる。  
 一番強いペアと一番弱いペアの強さの差が最小になるようにペアを作ったときに、その差はいくつになるだろうか。

## 输入格式

入力は以下の形式で与えられる。

> $ n $ $ a_1 $ $ a_2 $ $ ... $ $ a_n $

- $ 1 $ 行目には、社員の数を表す整数 $ n $ ($ 4\ \leq\ n\ \leq\ 100 $, $ n $ は偶数) が与えられる。
- $ 2 $ 行目には、社員の卓球の強さを表す整数 $ a_i $ ($ 1\ \leq\ a_i\ \leq\ 1{,}000 $) がスペース区切りで $ n $ 個与えられる。

## 输出格式

求める値を一行で出力せよ。

## 说明/提示

### Sample Explanation 1

{$ (1,3),\ (4,10) $}, {$ (1,4),\ (3,\ 10) $}, {$ (1,10),\ (3,4) $} の $ 3 $ 通りのチーム分けが考えられる。 このうち、もっともペアの強さの差が小さいものは {$ (1,10),\ (3,4) $} であり、その差は $ 4 $ である

## 样例 #1

### 输入

```
4

1 3 4 10
```

### 输出

```
4
```

## 样例 #2

### 输入

```
4

1 3 4 4
```

### 输出

```
2
```



---

---
title: "How are you?"
layout: "post"
diff: 普及/提高-
pid: AT_indeednow_2015_finalb_b
tag: []
---

# How are you?

## 题目描述

[problemUrl]: https://atcoder.jp/contests/indeednow-finalb-open/tasks/indeednow_2015_finalb_b

Indeed 社には $ N $ 人の社員がいます。社員 $ i\ (1\ ≦\ i\ ≦\ N) $ は時刻 $ S_i $ に出社し、時刻 $ T_i $ に退社します。各社員は、自分がオフィスにいる間に出社してきた社員に対して "How are you?" と聞きます。すなわち、$ S_i\ <\ S_j\ <\ T_i $ を満たすとき、社員 $ i $ は社員 $ j $ に対して "How are you?" と聞きます。

あなたは、それぞれの社員が何人に対して "How are you?" と聞くかを計算することにしました。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ S_1 $ $ T_1 $ $ S_2 $ $ T_2 $ : $ S_N $ $ T_N $

- $ 1 $ 行目には、社員の人数を表す整数 $ N\ (1\ ≦\ N\ ≦\ 10^5) $ が与えられる。
- $ 2 $ 行目からの $ N $ 行には、社員の出社時刻と退社時刻の情報が与えられる。このうち $ i $ 行目には、$ 2 $ つの整数 $ S_i,\ T_i\ (1\ ≦\ S_i\ <\ T_i\ ≦\ N*2) $ が空白区切りで与えられる。これは、社員 $ i $ が時刻 $ S_i $ に出社し、時刻 $ T_i $ に退社することを表す。ただし、$ S_i\ =\ S_j $ または $ S_i\ =\ T_j $ を満たすような $ i,j\ (1\ ≦\ i\ <\ j\ ≦\ N) $ は存在しないことが保証される。(16:18削除)
- 与えられる出社時刻と退社時刻は全て相異なる。つまり、$ S_1,…,S_N,T_1,…,T_N $ は全て異なる。(16:18追加)

## 输出格式

出力は $ N $ 行からなる。このうち $ i $ 行目には、社員 $ i $ が "How are you?" と聞く社員の人数を表す $ 1 $ つの整数を出力せよ。出力の末尾にも改行を入れること。

## 说明/提示

### 部分点

この問題には部分点が設定されている。

- $ N\ ≦\ 2000 $ を満たすデータセット $ 1 $ に正解した場合は、$ 30 $ 点が与えられる。
- 全てのテストケースに正解した場合は、上記とは別に $ 70 $ 点が与えられる。

### Sample Explanation 1

この入力例では、 - 社員 $ 1 $ は、社員 $ 2 $ と 社員 $ 3 $ と社員 $ 4 $ に対して "How are you?" と聞きます。 - 社員 $ 2 $ は、社員 $ 3 $ に対して "How are you?" と聞きます。 - 社員 $ 3 $ は、社員 $ 4 $ に対して "How are you?" と聞きます。 - 社員 $ 4 $ は、誰にも "How are you?" と聞きません。

## 样例 #1

### 输入

```
4

1 6

2 4

3 7

5 8
```

### 输出

```
3

1

1

0
```

## 样例 #2

### 输入

```
7

5 12

10 11

1 2

6 13

4 7

3 8

9 14
```

### 输出

```
3

0

0

2

2

3

1
```



---

---
title: "高橋くんと数列"
layout: "post"
diff: 普及/提高-
pid: AT_indeednow_2015_qualb_4
tag: []
---

# 高橋くんと数列

## 题目描述

[problemUrl]: https://atcoder.jp/contests/indeednow-qualb/tasks/indeednow_2015_qualb_4

高橋くんは長さ $ N $ の $ 1 $ から $ C $ の整数からなる数列 $ \{a_N\}\ =\ \{a_1,a_2,\ ...,a_N\} $ を受け取って、 $ 1 $ 以上 $ C $ 以下のそれぞれの整数について、その数を1つでも含む連続する部分列の数を返す機械です。

より正確には、 $ 1 $ 以上 $ C $ 以下の整数 $ k $ について、 $ 1\ ≦\ l\ ≦\ r\ ≦\ N $ となるような $ l,r $ で、 $ a_i\ =\ k $ かつ $ l≦\ i\ ≦\ r $ を満たすものが存在するような $ (l,r) $ の組の数を高橋くんは求めます。

連続する部分列の中身が同じでも、$ (l,r) $ の組が異なれば異なるものとして認識することに注意してください。 高橋くんの動作を確認するためのプログラムを書いてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ C $ $ a_1 $ $ a_2 $ … $ a_N $

- $ 1 $ 行目には、数列の長さ $ N\ (1\ ≦\ N\ ≦\ 10^5) $ と数列の要素の最大値 $ C\ (1\ ≦\ C\ ≦\ N) $ がスペース区切りで与えられる。
- $ 2 $ 行目には、高橋くんが受け取った数列の要素の数を表す $ N $ 個の数が空白区切りで与えられる。$ 1\ ≦\ a_i\ ≦\ C $ であることが保証される。また、$ 1 $ 以上 $ C $ 以下のすべての整数 $ k $ に対し、 $ a_i\ =\ k $を満たす $ i $ が存在することが保証される。

## 输出格式

$ i\ (1\ ≦\ i\ ≦\ C) $ 行目には、$ \{a_N\} $ のうち $ i $ を含む連続する部分列の数を出力せよ。

末尾の改行を忘れないこと。また、それぞれの行の末尾に余計な空白を付け加えないこと。

## 说明/提示

### 部分点

この問題には部分点が設定されている。

- $ 30 $ 点分のテストケースにおいて、$ 1≦C≦20 $ を満たす。

### Sample Explanation 1

$ 1 $ を含む連続する部分列として当てはまるものは、 $ (l,r)=(1,1),(1,2),(1,3),(1,4),(2,4),(3,4),(4,4) $ $ 2 $ を含む連続する部分列として当てはまるものは、 $ (l,r)=(1,2),(1,3),(1,4),(2,2),(2,3),(2,4),(3,3),(3,4) $ です。

## 样例 #1

### 输入

```
4 2

1 2 2 1
```

### 输出

```
7

8
```

## 样例 #2

### 输入

```
4 4

1 4 2 3
```

### 输出

```
4

6

4

6
```

## 样例 #3

### 输入

```
5 1

1 1 1 1 1
```

### 输出

```
15
```



---

---
title: "木"
layout: "post"
diff: 普及/提高-
pid: AT_indeednow_2015_qualc_3
tag: []
---

# 木

## 题目描述

[problemUrl]: https://atcoder.jp/contests/indeednow-qualb/tasks/indeednow_2015_qualc_3

木とは、頂点とそれを結ぶ辺からなる構造「グラフ」の $ 1 $ 種で、頂点の数を $ N $ 個とすると、辺は $ N-1 $ 本あり、どの頂点も他の全ての頂点に辺で間接・直接的につながっています。

 ![](https://cdn.luogu.com.cn/upload/vjudge_pic/AT_indeednow_2015_qualc_3/db302ed5e6211ee095f87c2aa4b931b136442faf.png)

この問題では、頂点は $ N $ 個あり、$ 1 $ から $ N $ まで番号付けられています。

木が与えられたとき、以下の操作で作られる数列のうち、辞書順で最小のものを出力してください。

1. 頂点1を選ぶ。
2. 今まで選ばれた頂点と辺で結ばれている頂点のうち、まだ選ばれていない頂点を1つ選ぶ、という操作を選ばれていない頂点が無くなるまで繰り返す。
3. 頂点の番号を選ばれた順に並べた数列を作る。

ただし、長さ $ N $ の列 $ A=\{a_1,a_2,\ ...,a_N\} $ と $ B=\{b_1,b_2,\ ...,b_N\} $ に対し、辞書順で $ A $ が $ B $ より小さいとは、

- $ i\ で\ a_i $=$ b_i $
- $ i\ =\ k $ で $ a_i $b\_i

となるような $ k(1≦k≦N) $ が存在するということです。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ a_1 $ $ b_1 $ $ a_2 $ $ b_2 $ ： $ a_{N-1} $ $ b_{N-1} $

- $ 1 $ 行目には、木の頂点の数を表す整数 $ N\ (2\ ≦\ N\ ≦\ 10^5) $ が与えられる。
- $ 2 $ 行目から $ N-1 $ 行には、木の辺の情報が与えられる。このうち $ i\ (1\ ≦\ i\ ≦\ N-1) $ 行目には頂点 $ a_i $ と頂点 $ b_i $ を結ぶ辺があることを表す $ 2 $ つの整数 $ a_i $ , $ b_i $ が与えられる。
- $ N-1 $ 本の辺で結ばれる $ N $ 個の頂点は木を成すことが保障される。

## 输出格式

$ 1 $ 行目に、与えられた木から作られる辞書順で最小の数列を空白区切りで出力せよ。

行末の改行を忘れないこと。また，行末に余分な空白を入れてはならない。

## 说明/提示

### 部分点

この問題には部分点が設定されている。

- $ 50 $ 点分のテストケースにおいて、 $ 1\ ≦\ N\ ≦\ 3,000 $ を満たす。

### Sample Explanation 1

問題文中の図の木です。 まず、初めに頂点 $ 1 $ を選びます。 !\[\](http://indeednow-qualb.contest.atcoder.jp/img/other/indeednow-qualb/C\_sample2.png) 次に、頂点 $ 3 $ を選びます。頂点 $ 2 $ は今まで選んだ頂点(この場合、頂点 $ 1 $ のみ)と辺で結ばれていないので、選ぶことができないことに注意してください。 !\[\](http://indeednow-qualb.contest.atcoder.jp/img/other/indeednow-qualb/C\_sample3.png) 次に、頂点 $ 2 $ を選びます。 !\[\](http://indeednow-qualb.contest.atcoder.jp/img/other/indeednow-qualb/C\_sample4.png) 次に、頂点 $ 4 $ を選びます。 !\[\](http://indeednow-qualb.contest.atcoder.jp/img/other/indeednow-qualb/C\_sample5.png) 頂点の番号を選んだ順に並べると、$ 1 $ $ 3 $ $ 2 $ $ 4 $ となります。この列より辞書順で小さい選び方は存在しません。

## 样例 #1

### 输入

```
4

1 3

1 4

2 3
```

### 输出

```
1 3 2 4
```

## 样例 #2

### 输入

```
6

1 2

2 3

2 6

6 4

1 5
```

### 输出

```
1 2 3 5 6 4
```

## 样例 #3

### 输入

```
7

1 5

5 2

5 3

5 7

5 6

6 4
```

### 输出

```
1 5 2 3 6 4 7
```



---

---
title: "Not Say "NO""
layout: "post"
diff: 普及/提高-
pid: AT_iroha2019_day3_c
tag: []
---

# Not Say "NO"

## 题目描述

[problemUrl]: https://atcoder.jp/contests/iroha2019-day3/tasks/iroha2019_day3_c

まず、以下の問題を読んでください。

> $ 1,2,\dots,N $ の番号のついた $ N $ 人の子供がいて、**互いに価値の異なる**プレゼントが $ K $ 個ある。 $ i $ 個目のプレゼントの価値は $ V_i $ である。 全てのプレゼントを子供たちに分けるとき、全ての子供が最終的に合計で同じ価値のプレゼントを得るようにできるだろうか? 可能なら`YES`と出力し、分け方の一例を示してください。 不可能なら`NO`と出力してください。
> 
> ### 制約
> 
> - $ 1\ \le\ N\ \le\ 100 $
> - $ 2\times\ N-1\ \le\ K\ \le\ 10^4 $
> - $ 1\ \le\ V_i\ \le\ 10^{14}(1\ \le\ i\ \le\ K) $
> - $ V_i\ \neq\ V_j(1\ \le\ i\ <\ j\ \le\ K) $

 $ N,K $ が与えられるので、この問題のテストケースを解の一例とともに生成してください。 ただし、解が`NO`となるケースを生成してはいけません。 なお、この問題においてこの制約のもとでどんな入力でも解が存在することが示せます。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N\ K $

## 输出格式

以下の形式で出力せよ。

> $ V_1\ V_2\ \cdots\ V_K $ $ S $ $ R_1\ R_2\ \cdots\ R_K $

まず、 $ 1 $ 行目に生成したテストケース $ V_i $ を出力してください。

次に、テストケースの解である $ S $ を出力してください。 $ S $ は`YES`か`NO`である必要がありますが、解が`NO`となるケースを生成してはいけません。

最後に、 $ S $ が`YES`の場合、分け方の一例を示してください。 $ R_i=X(1\le\ X\ \le\ N) $ の場合、 $ i $ 番目のプレゼントが $ R_i $ 番の子供に渡されたことを表します。

## 说明/提示

### 解説

 [Not Say "NO" - 解説](https://img.atcoder.jp/iroha2019-day3/editorial-C.pdf)

## 样例 #1

### 输入

```
3 6
```

### 输出

```
3 5 2 6 4 1

YES

3 2 2 1 3 1
```

## 样例 #2

### 输入

```
2 5
```

### 输出

```
100 10 20 30 40

YES

2 1 1 1 1
```



---

---
title: "共通部分文字列"
layout: "post"
diff: 普及/提高-
pid: AT_joi2008ho_b
tag: []
---

# 共通部分文字列

## 题目描述

[problemUrl]: https://atcoder.jp/contests/joi2008ho/tasks/joi2008ho_b





---

---
title: "JOIOI の塔 (Tower of JOIOI)"
layout: "post"
diff: 普及/提高-
pid: AT_joi2013ho4
tag: []
---

# JOIOI の塔 (Tower of JOIOI)

## 题目描述

JOIOI 塔是一种单人游戏。

这个游戏要用到一些写有 `J`, `O`, `I` 中任一文字的圆盘。这些圆盘的直径互不相同。游戏开始时，这些圆盘按照直径大的在下面的规则堆叠。你需要用这些圆盘做尽量多的迷你 JOIOI 塔。迷你 JOIOI 塔由 $3$ 个圆盘构成，从直径较小的圆盘开始分别为 `J`, `O`, `I` 或分别为 `I`, `O`, `I` 。不过，每个圆盘最多只能使用一次。

给出长为 $N$ 的字符串 $S$ ，表示直径从小到大的圆盘上的文字。请编写程序求出使用这些圆盘能够做出的迷你 JOIOI 塔个数的最大值。

## 输入格式

第一行为一个整数 $N$ ，表示字符串 $S$ 的长度。

第二行是一个字符串 $S$ 。

## 输出格式

一行一个整数：表示能够做出的迷你 JOIOI 塔数量的最大值。

### 输入输出样例解释

#### 样例 1

`JOIIOI` 分别含子串 `JOI` 和子串 `IOI` 各一个，故可以做出 2 个迷你 JOIOI 塔。

#### 样例 2

虽然 `JOIOI` 也分别含子串 `JOI` 和子串 `IOI` 各一个，但每个字符不能被使用两次或以上。

#### 样例 3

## 说明/提示

对于所有数据，$1\leq N \leq 10^6$。

| 子任务 |     分值      |   $N\le$    |
| :----: | :-----------: | :---------: |
|  $1$   |     $10$      | $N \leq 15$ |
|  $2$   |     $20$      | $N \leq 50$ |
|  $3$   | $N \leq 3000$ | $N\leq3000$ |
|  $4$   |     $50$      | $N\leq10^6$ |

## 样例 #1

### 输入

```
6
JOIIOI
```

### 输出

```
2
```

## 样例 #2

### 输入

```
5
JOIOI
```

### 输出

```
1
```

## 样例 #3

### 输入

```
6
JOIOII
```

### 输出

```
2
```

## 样例 #4

### 输入

```
15
JJOIIOOJOJIOIIO
```

### 输出

```
4
```



---

---
title: "シルクロード (Silk Road)"
layout: "post"
diff: 普及/提高-
pid: AT_joi2015yo_d
tag: []
---

# シルクロード (Silk Road)

## 题目描述

商人JOI先生带着货物，从0号城市出发，丝绸之路包括起点和终点一共有N+1个城市。要求不超过M天内必须到达终点。一天的时间可以从一个城市到连续的下一个城市。从i-1城市到i城市距离是Di。

JOI先生在一个城市时，可以有以下选择：

移动：向下一个城市进发

休息：呆在原来的城市不动

沙漠天气变化无常，在天气很不好时，前进会遇到很多困难。我们把M天的第j(1<=j<=M)天的气候恶劣值记为Cj。从i-1城市移动到i城市在第j天进发时，需要耗费Di*Cj的疲劳度。

不过JOI先生还是有选择权的，可以避开比较恶劣的天气，休息是不会消耗疲劳值的。现在他想知道整个行程最少要消耗多少疲劳值。

## 输入格式

第一行2个整数N，M

连续N行每行一个整数Dj

连续M行每行一个整数Cj

## 输出格式

一个整数，表示最小疲劳度

## 样例 #1

### 输入

```
3 5
10
25
15
50
30
15
40
30
```

### 输出

```
1125
```

## 样例 #2

### 输入

```
2 6
99
20
490
612
515
131
931
1000
```

### 输出

```
31589
```



---

---
title: "オレンジの出荷 (Oranges)"
layout: "post"
diff: 普及/提高-
pid: AT_joi2016ho_a
tag: []
---

# オレンジの出荷 (Oranges)

## 题目描述

CXR决定将收获的$n$个橙子分装进一些箱子内。在NXY的工厂中，橙子排列在输送带上，依次编号为$1...n$。橙子$i(1\leq i\leq n$)的大小为$A_i$。由于分拣不方便，同一个箱子内，橙子的编号必须连续。



一个箱子内最多可以装$m$个橙子。在一个箱子内装一些橙子的成本为$k+s\times (a-b)$。$k$是箱子本身的成本，所有箱子的成本一样。$s$是该箱子中橙子的数目。 $a$是该箱子中最大橙子的大小，$b$是该箱子中最小橙子的大小。



求包装这$n$个橙子所需的最小成本。

## 输入格式

第一行有三个整数$n,m,k$，用空格分隔。



在接下来的$n$行中，第$i$行$(1\leq i\leq n)$有一个整数$A_i$。

## 输出格式

输出一个整数，表示包装这$n$个橙子所需的最小成本。



## 输入样例 1

```

6 3 6

1

2

3

1

2

1

```

## 输出样例 1

```

21

```



## 输入样例 2

```

16 4 12

3

10

13

10

19

9

12

16

11

2

19

9

13

2

13

19

```

## 输出样例 2

```

164

```



## 样例输入 3

```

16 6 14

19

7

2

15

17

7

14

12

3

14

5

10

17

20

19

12

```

## 样例输出 3

```

177

```

## 样例输入 4

```

10 1 1000000000

1

1

1

1

1

1

1

1

1

1

```

## 样例输出 4

```

10000000000

```

## 样例解释 4



答案可能会爆$int$。

## 说明/提示

- 1≤N≤20 000

- 1≤M≤1 000

- 0≤K≤1 000 000 000

- 1≤A_i≤1 000 000 000 (1≤i≤N)

- M≤N



本题：JOI 2016 Final T1「オレンジの出荷」

## 样例 #1

### 输入

```
6 3 6
1
2
3
1
2
1
```

### 输出

```
21
```

## 样例 #2

### 输入

```
16 4 12
3
10
13
10
19
9
12
16
11
2
19
9
13
2
13
19
```

### 输出

```
164
```

## 样例 #3

### 输入

```
16 6 14
19
7
2
15
17
7
14
12
3
14
5
10
17
20
19
12
```

### 输出

```
177
```

## 样例 #4

### 输入

```
10 1 1000000000
1
1
1
1
1
1
1
1
1
1
```

### 输出

```
10000000000
```



---

---
title: "美術展 (Art Exhibition)"
layout: "post"
diff: 普及/提高-
pid: AT_joi2018ho_b
tag: []
---

# 美術展 (Art Exhibition)

## 题目描述

[problemUrl]: https://atcoder.jp/contests/joi2018ho/tasks/joi2018ho_b

JOI 国で美術展が行われることになった．美術展では，国中から集まった様々な美術品が展示される予定である．

展示される美術品の候補として，$ N $ 点の美術品が集まった．これらの美術品には $ 1,\ 2,\ \ldots,\ N $ の番号が付けられている．それぞれの美術品には大きさと価値と呼ばれる値が定まっている．美術品 $ i $ ($ 1\ \leqq\ i\ \leqq\ N $) の大きさは $ A_i $，価値は $ B_i $ である．

美術展では，これらの美術品のうちから $ 1 $ 点以上を選んで展示する．美術展の会場は十分に広く，$ N $ 点の美術品すべてを展示することも可能である．しかし，JOI 国の人々の美的感覚のため，美術品の間で大きさの差があまり大きくならないように展示する美術品を選びたい．一方，できるだけ価値の大きい美術品を多く展示したい．そのため，次の条件を満たすように展示する美術品を選ぶことにした：

- 選んだ美術品の中で，大きさが最大のものの大きさを $ A_{\mathrm{max}} $，最小のものの大きさを $ A_{\mathrm{min}} $ とする．また，選んだ美術品の価値の総和を $ S $ とする．
- このとき，$ S\ -\ (A_{\mathrm{max}}\ -\ A_{\mathrm{min}} $) を最大化する．

## 输入格式

標準入力から以下の入力を読み込め．

- $ 1 $ 行目には，整数 $ N $ が書かれている．これは，展示される美術品の候補の個数を表す．
- 続く $ N $ 行のうちの $ i $ 行目 ($ 1\ \leqq\ i\ \leqq\ N $) には，$ 2 $ 個の整数 $ A_i,\ B_i $ が空白を区切りとして書かれている．これらは，美術品 $ i $ の大きさが $ A_i $，価値が $ B_i $ であることを表す．

## 输出格式

標準出力に，$ S\ -\ (A_{\mathrm{max}}\ -\ A_{\mathrm{min}}) $ の最大値を $ 1 $ 行で出力せよ．

- - - - - -

## 说明/提示

### 課題

展示される美術品の候補の個数と，それぞれの美術品の大きさと価値が与えられたとき，$ S\ -\ (A_{\mathrm{max}}\ -\ A_{\mathrm{min}}) $ の最大値を求めよ．

- - - - - -

### 制限

すべての入力データは以下の条件を満たす．

- $ 2\ \leqq\ N\ \leqq\ 500\,000 $．
- $ 1\ \leqq\ A_i\ \leqq\ 1\,000\,000\,000\,000\,000\ =\ 10^{15} $ ($ 1\ \leqq\ i\ \leqq\ N $)．
- $ 1\ \leqq\ B_i\ \leqq\ 1\,000\,000\,000 $ ($ 1\ \leqq\ i\ \leqq\ N $)．

### 小課題

#### 小課題 1 \[10 点\]

- $ N\ \leqq\ 16 $ を満たす．

#### 小課題 2 \[20 点\]

- $ N\ \leqq\ 300 $ を満たす．

#### 小課題 3 \[20 点\]

- $ N\ \leqq\ 5\,000 $ を満たす．

#### 小課題 4 \[50 点\]

- 追加の制限はない．

- - - - - -

### Sample Explanation 1

この入力例では，展示される美術品の候補が $ 3 $ 点ある．それぞれの美術品の大きさ，価値は次の通りである． - 美術品 $ 1 $ の大きさは $ 2 $，価値は $ 3 $ である． - 美術品 $ 2 $ の大きさは $ 11 $，価値は $ 2 $ である． - 美術品 $ 3 $ の大きさは $ 4 $，価値は $ 5 $ である． この場合，美術品 $ 1 $ と美術品 $ 3 $ を展示するために選ぶと，次のようにして $ S\ -\ (A_{\mathrm{max}}\ -\ A_{\mathrm{min}})\ =\ 6 $ となる． - 選んだ中で大きさが最大の美術品は，美術品 $ 3 $ である．よって，$ A_{max}\ =\ 4 $ である． - 選んだ中で大きさが最小の美術品は，美術品 $ 1 $ である．よって，$ A_{min}\ =\ 2 $ である． - 選んだ美術品の価値の総和は $ 3\ +\ 5\ =\ 8 $ であるから，$ S\ =\ 8 $ である． $ S\ -\ (A_{max}\ -\ A_{min}) $ を $ 7 $ 以上にすることは不可能なので，$ 6 $ を出力する． - - - - - -

### Sample Explanation 2

\- - - - - -

## 样例 #1

### 输入

```
3
2 3
11 2
4 5
```

### 输出

```
6
```

## 样例 #2

### 输入

```
6
4 1
1 5
10 3
9 1
4 2
5 3
```

### 输出

```
7
```

## 样例 #3

### 输入

```
15
1543361732 260774320
2089759661 257198921
1555665663 389548466
4133306295 296394520
2596448427 301103944
1701413087 274491541
2347488426 912791996
2133012079 444074242
2659886224 656957044
1345396764 259870638
2671164286 233246973
2791812672 585862344
2996614635 91065315
971304780 488995617
1523452673 988137562
```

### 输出

```
4232545716
```



---

---
title: "勇者ビ太郎 (Bitaro the Brave)"
layout: "post"
diff: 普及/提高-
pid: AT_joi2019ho_a
tag: []
---

# 勇者ビ太郎 (Bitaro the Brave)

## 题目描述

[problemUrl]: https://atcoder.jp/contests/joi2019ho/tasks/joi2019ho_a

![2019-ho-t1-fig01.jpg](https://cdn.luogu.com.cn/upload/vjudge_pic/AT_joi2019ho_a/09009490d7383ad8a773f434baef49f70d623222.png)

勇者のビ太郎は，魔王と対峙することとなった．

ビ太郎は，縦 $ H $ 行，横 $ W $ 列のマス目上に宝石 (Jewel)，オーブ (Orb)，金塊 (Ingot) を配置し，魔法を発動することによって魔王に攻撃をしようとしている．以下，マス目のうち上から $ i $ 行目 ($ 1\ \leqq\ i\ \leqq\ H $)，左から $ j $ 列目 ($ 1\ \leqq\ j\ \leqq\ W $) のマスを，マス $ (i,\ j) $ と表す．

ビ太郎は今，それぞれのマスにこれら $ 3 $ 種類のうち $ 1 $ 個を配置した．今から魔法を発動しようとしているが，この魔法の威力はマス目上の宝石，オーブ，金塊の配置によって決まる．具体的には，次の条件を満たす整数 $ (i,\ j,\ k,\ l) $ ($ 1\ \leqq\ i\ <\ k\ \leqq\ H $，$ 1\ \leqq\ j\ <\ l\ \leqq\ W $) の組の個数が，魔法の威力である．

条件：マス $ (i,\ j) $ には宝石が，マス $ (i,\ l) $ にはオーブが，マス $ (k,\ j) $ には金塊が置かれている．

ビ太郎は，この魔法の威力が気になっている．

マス目上の宝石，オーブ，金塊の配置が与えられたとき，ビ太郎が発動する魔法の威力を求めるプログラムを作成せよ．

- - - - - -

## 输入格式

入力は以下の形式で標準入力から与えられる．

> $ H $ $ W $ $ S_1 $ $ \vdots $ $ S_H $

$ S_i $ ($ 1\ \leqq\ i\ \leqq\ H $) は長さ $ W $ の文字列で，その $ j $ 文字目 ($ 1\ \leqq\ j\ \leqq\ W $) が `J` のときはマス $ (i,\ j) $ に宝石が，`O` のときはマス $ (i,\ j) $ にオーブが，`I` のときはマス $ (i,\ j) $ に金塊が置かれていることを表す．

## 输出格式

標準出力に，魔法の威力を表す整数を $ 1 $ 行で出力せよ．

- - - - - -

## 说明/提示

### 制約

- $ 2\ \leqq\ H\ \leqq\ 3\,000 $．
- $ 2\ \leqq\ W\ \leqq\ 3\,000 $．
- $ S_i $ は長さ $ W $ の文字列である ($ 1\ \leqq\ i\ \leqq\ H $)．
- $ S_i $ の各文字は `J`，`O`，`I` のいずれかである ($ 1\ \leqq\ i\ \leqq\ H $)．

### 小課題

1. ($ 20 $ 点) $ H\ \leqq\ 100 $，$ W\ \leqq\ 100 $．
2. ($ 30 $ 点) $ H\ \leqq\ 500 $，$ W\ \leqq\ 500 $．
3. ($ 50 $ 点) 追加の制約はない．

- - - - - -

### Sample Explanation 1

この入力例では，$ (i,\ j,\ k,\ l)\ =\ (1,\ 1,\ 3,\ 2),\ (2,\ 1,\ 3,\ 3),\ (2,\ 1,\ 3,\ 4) $ の $ 3 $ 個の組が条件を満たすので，答えは $ 3 $ である． - - - - - -

## 样例 #1

### 输入

```
3 4
JOIJ
JIOO
IIII
```

### 输出

```
3
```

## 样例 #2

### 输入

```
4 4
JJOO
JJOO
IIJO
IIIJ
```

### 输出

```
17
```



---

---
title: "とてもたのしい家庭菜園 (Growing Vegetables is Fun 4)"
layout: "post"
diff: 普及/提高-
pid: AT_joi2021ho_a
tag: []
---

# とてもたのしい家庭菜園 (Growing Vegetables is Fun 4)

## 题目描述

[problemUrl]: https://atcoder.jp/contests/joi2021ho/tasks/joi2021ho_a

家庭菜園が趣味のビ太郎は自宅の庭でビバ草という植物を育てている．庭には $ N $ 株のビバ草が東西方向に一列に植えられており，西側から順に $ 1 $ から $ N $ までの番号が付いている．現在，ビバ草 $ i $ ($ 1\ \leqq\ i\ \leqq\ N $) の背丈は $ A_i $ である．

育てているビバ草は特別な品種改良の結果，水を与えるたびに背丈が $ 1 $ 伸びる．ビ太郎は庭の見栄えを良くするために水やりを複数回行い，以下の条件を満たすようにしたいと考えている．

- すべての水やりを行った後のビバ草 $ i $ ($ 1\ \leqq\ i\ \leqq\ N $) の背丈を $ B_i $ とする．このとき，「$ 1\ \leqq\ j\ \leqq\ k\ -\ 1 $ に対し $ B_j\ <\ B_{j\ +\ 1} $」かつ「$ k\ \leqq\ j\ \leqq\ N\ -\ 1 $ に対し $ B_j\ >\ B_{j\ +\ 1} $」を満たすような整数 $ k $ ($ 1\ \leqq\ k\ \leqq\ N $) が存在する．

ただし，ビ太郎は不器用なため，$ 1 $ 回の水やりにおいて，ある区間上のビバ草に一斉に水を与えることしかできない．すなわち，水やりを行うたびにある整数 $ L,\ R $ ($ 1\ \leqq\ L\ \leqq\ R\ \leqq\ N $) を選び，ビバ草 $ L,\ L\ +\ 1,\ \ldots,\ R $ に水を与える．

ビ太郎は水やりの回数をできるだけ少なくしたい．

ビバ草の数と現在の背丈の情報が与えられたとき，条件を満たすのに必要な水やりの回数の最小値を求めるプログラムを作成せよ．

- - - - - -

## 输入格式

入力は以下の形式で標準入力から与えられる．入力される値はすべて整数である．

> $ N $ $ A_1 $ $ \cdots $ $ A_N $

## 输出格式

必要な水やりの回数の最小値を，標準出力に $ 1 $ 行で出力せよ．

- - - - - -

## 说明/提示

### 制約

- $ 2\ \leqq\ N\ \leqq\ 200\,000 $．
- $ 1\ \leqq\ A_i\ \leqq\ 1\,000\,000\,000 $ ($ 1\ \leqq\ i\ \leqq\ N $)．

### 小課題

1. ($ 40 $ 点) $ N\ \leqq\ 2\,000 $．
2. ($ 60 $ 点) 追加の制約はない．

- - - - - -

### Sample Explanation 1

以下のように水やりを $ 3 $ 回行うことで条件を満たすことができる． - $ L=2 $，$ R=5 $ として，ビバ草 $ 2,\ 3,\ 4,\ 5 $ に水を与える．ビバ草の背丈は西から順に $ 3,\ 3,\ 3,\ 4,\ 2 $ となる． - $ L=2 $，$ R=3 $ として，ビバ草 $ 2,\ 3 $ に水を与える．ビバ草の背丈は西から順に $ 3,\ 4,\ 4,\ 4,\ 2 $ となる． - $ L=3 $，$ R=3 $ として，ビバ草 $ 3 $ に水を与える．ビバ草の背丈は西から順に $ 3,\ 4,\ 5,\ 4,\ 2 $ となる． $ 2 $ 回以下の水やりで条件を満たすことは不可能なので，必要な水やりの回数の最小値は $ 3 $ である． - - - - - -

### Sample Explanation 2

すでに条件を満たしているため，必要な水やりの回数の最小値は $ 0 $ である． - - - - - -

### Sample Explanation 3

1 回の水やりで条件を満たすためには，$ L\ =\ 1 $，$ R\ =\ 1 $ としてビバ草 $ 1 $ に水を与えるか，または，$ L\ =\ 2 $，$ R\ =\ 2 $ としてビバ草 $ 2 $ に水を与えればよい． - - - - - -

## 样例 #1

### 输入

```
5
3 2 2 3 1
```

### 输出

```
3
```

## 样例 #2

### 输入

```
5
9 7 5 3 1
```

### 输出

```
0
```

## 样例 #3

### 输入

```
2
2021 2021
```

### 输出

```
1
```

## 样例 #4

### 输入

```
8
12 2 34 85 4 91 29 85
```

### 输出

```
93
```



---

---
title: "自習 (Self Study)"
layout: "post"
diff: 普及/提高-
pid: AT_joi2022ho_b
tag: []
---

# 自習 (Self Study)

## 题目描述

在 JOI 高中高一的第三个学期的 $M$ 个星期的时间内，有 $N$ 门课，编号为 $1 \sim N$。每个星期有 $N$ 个课时，第 $i$ 个课时上课程 $i$ 的一节课。

比太郎是一位高一学生。对于 $N \times M$ 个课时中的每一个，他会选择如下行动中的一个：

- 行动 1：比太郎去上课。如果他去上了课程 $i$ 的一节课，那么他对课程 $i$ 的理解程度会增加 $A_i$。
- 行动 2：比太郎不去上课。他转而选择任意一门课，并且自学选中的那门课。如果他选中了课程 $i$ 进行了时长为一课时的自学，那么他对课程 $i$ 的理解程度会增加 $B_i$。

一开始，对每门课的理解程度都为 $0$。由于比太郎想要在课后练习算法竞赛，他在非上课时间内不会学习。当第三个学期的所有课时结束后，期末考就会举行。

比太郎不想挂科。所以他想要最大化在期末考时对每门课的理解程度的最小值。

给定学期的长度，课程的数量，以及对理解程度的提升数值，请写一个程序计算在期末考时对每门课的理解程度的最小值的最大可能值。

## 输入格式

第一行，两个正整数 $N, M$。

第二行，$N$ 个正整数 $A_1, A_2, \ldots, A_N$。

第三行，$N$ 个正整数 $B_1, B_2, \ldots, B_N$。

## 输出格式

输出一行，一个数，表示在期末考时对每门课的理解程度的最小值的最大可能值。

## 样例 #1

### 样例输入 #1

```
3 3
19 4 5
2 6 2
```

### 样例输出 #1

```
18
```

## 样例 #2

### 样例输入 #2

```
2 1
9 7
2 6
```

### 样例输出 #2

```
7
```

## 样例 #3

### 样例输入 #3

```
5 60000
630510219 369411957 874325200 990002527 567203997
438920902 634940661 593780254 315929832 420627496
```

### 样例输出 #3

```
41397427274960
```

## 样例 #4

### 样例输入 #4

```
4 25
1 2 3 4
1 2 3 4
```

### 样例输出 #4

```
48
```

## 说明/提示

**【样例解释 \#1】**

举个例子，如果比太郎按如下方式学习，则他对课程 $1, 2, 3$ 的理解程度将分别为 $19, 18, 19$。

- 第一周课程 $1$ 的课：自学课程 $2$；
- 第一周课程 $2$ 的课：自学课程 $2$；
- 第一周课程 $3$ 的课：去上课程 $3$ 的课；
- 第二周课程 $1$ 的课：去上课程 $1$ 的课；
- 第二周课程 $2$ 的课：自学课程 $3$；
- 第二周课程 $3$ 的课：去上课程 $3$ 的课；
- 第三周课程 $1$ 的课：自学课程 $3$；
- 第三周课程 $2$ 的课：自学课程 $2$；
- 第三周课程 $3$ 的课：去上课程 $3$ 的课。

由于对每门课的最小的理解程度不能大于等于 $19$，输出 $18$。

这个样例满足子任务 $3, 5$ 的限制。

**【样例解释 \#2】**

这个样例满足子任务 $1, 3, 5$ 的限制。

**【样例解释 \#3】**

这个样例满足子任务 $3, 5$ 的限制。

**【样例解释 \#4】**

这个样例满足子任务 $2, 3, 4, 5$ 的限制。

----


**本题采用捆绑测试。**

对于 $100 \%$ 的数据，$1 \le N \le 3 \times {10}^5$，$1 \le M \le {10}^9$，$1 \le A_i, B_i \le {10}^9$。

- 子任务 $1$（$10$ 分）：$M = 1$。
- 子任务 $2$（$25$ 分）：$N \cdot M \le 3 \times {10}^5$，$A_i = B_i$。
- 子任务 $3$（$27$ 分）：$N \cdot M \le 3 \times {10}^5$。
- 子任务 $4$（$29$ 分）：$A_i = B_i$。
- 子任务 $5$（$9$ 分）：无特殊限制。

----

**译自 [JOI 2022 Final](https://www.ioi-jp.org/joi/2021/2022-ho/index.html) T2「[自習](https://www.ioi-jp.org/joi/2021/2022-ho/2022-ho-t2.pdf) / [Self Study](https://www.ioi-jp.org/joi/2021/2022-ho/2022-ho-t2-en.pdf)」**

## 样例 #1

### 输入

```
3 3
19 4 5
2 6 2
```

### 输出

```
18
```

## 样例 #2

### 输入

```
2 1
9 7
2 6
```

### 输出

```
7
```

## 样例 #3

### 输入

```
5 60000
630510219 369411957 874325200 990002527 567203997
438920902 634940661 593780254 315929832 420627496
```

### 输出

```
41397427274960
```

## 样例 #4

### 输入

```
4 25
1 2 3 4
1 2 3 4
```

### 输出

```
48
```



---

---
title: "ラーメンの食べ比べ"
layout: "post"
diff: 普及/提高-
pid: AT_joisc2014_d
tag: []
---

# ラーメンの食べ比べ

## 题目描述

**这是一道交互题。**

#### 背景

JOI 君和 IOI 酱都喜欢吃拉面。JOI 君喜欢吃清汤拉面，而 IOI 酱喜欢吃浓汤拉面，在 JOI 君和 IOI 酱居住的城镇里，共有 $N$ 家拉面馆，编号为 $0$ 到 $N-1$。

我们不知道每家拉面馆卖的是清汤拉面还是浓汤拉面，因此，JOI 君和 IOI 酱决定去附近的一些拉面馆寻找最好吃的清汤和浓汤拉面。

JOI 君和 IOI 酱到附近的拉面馆，分别确定两家拉面馆拉面的浓厚度，浓厚度是一个大于等于 $0$ 小于等于 $N-1$ 的整数，每家面馆拉面的浓厚度两两不同。JOI 君和 IOI 酱每天每人去一家拉面馆，通过品尝味道，可以比较出两家拉面馆哪一家浓厚度更高。

出于健康因素考虑，JOI 君和 IOI 酱最多吃 $600$ 天拉面。

#### 任务

给定城镇里拉面馆数 $N$，请在最多吃 $600$ 天拉面的情况下确定浓厚度最高的拉面馆和浓厚度最低的拉面馆。

#### 实现细节

你需要用一个程序实现上述任务。该程序必须实现以下函数：

```cpp
void Ramen(int N)
```

- 对于每个测试用例，该函数**仅调用一次**。
- 参数 $N$ 表示城镇里的拉面馆数。

你可以且仅可以在该函数中调用以下两个函数：

```cpp
int Compare(int X, int Y)
```

- 该函数用来比较两家拉面馆 $X,Y$ 的浓厚程度。
- 参数 $X,Y$ 表示用来比较的两家拉面馆的编号，其**必须是大于等于 $0$ 小于等于 $N-1$ 的整数**。如果不满足该条件，会被判为 `Wrong Answer [1]`。
- 如果拉面馆 $X$ 的浓厚程度大于拉面馆 $Y$ 的浓厚程度，该函数的返回值为 $1$，否则为 $-1$。
- 如果该函数被调用超过 $600$ 次，会被判为 `Wrong Answer [2]`。

```cpp
int Answer(int X, int Y)
```

- 该函数用来回答哪家拉面馆的浓厚程度最低和哪家拉面馆的浓厚程度最高。其中 $X$ 表示浓厚程度**最低**的拉面馆的编号，$Y$ 表示浓厚程度**最高**的拉面馆的编号。$X,Y$ **必须是大于等于 $0$ 小于等于 $N-1$ 的整数**。如果不满足该条件，会被判为 `Wrong Answer [4]`。
- **`Ramen` 函数必须调用该函数来结束**，否则会被判为 `Wrong Answer [3]`。
- 可以保证，与调用 `Compare` 函数的结果一致的答案是唯一的。如果与答案不一致，则会被判为 `Wrong Answer [5]`，一致则会被判为 `Accepted`。
- 调用此函数后，程序结束。

**编译与运行方法**

本体提供了 ramen.h、grader.c 和 grader.cpp 三个文件。可前往 [LOJ](https://loj.ac/p/2875/files) 下载本题的附加文件。

若你编写的程序名称为 ramen.c 或 ramen.cpp，请运行以下命令来编译：

- 对于 C 语言：`gcc -O2 -lm -o grader grader.c ramen.c`
- 对于 C++ 语言：`g++ -O2 -o grader grader.cpp ramen.cpp`

当命令成功时，会产生一个可执行文件 grader。

注意实际评测时的程序与下发的样例评测程序并不相同。实际的 ramen.h 函数实现将通过标准输入/输出与单独运行的交互器进行交互。

## 输入格式

样例评测程序将从标准输入读入以下数据：

第一行两个整数 $N,T$，用一个空格隔开。$N$ 表示拉面馆数，评测程序只会处理 $T=1$ 的数据。  
接下来 $N$ 行，第 $i$ 行表示拉面馆 $i$ 的浓厚度 。

## 输出格式

样例评测程序将向标准输出输出以下信息。

- 判为正确时，输出 `Accepted`；
- 运行过程中被判为错误时，以 `Wrong Answer [x]` 的格式报告并退出。

**样例输入**

```
3 1
1
2
0
```

**样例交互示例**

| 调用函数 | 返回值 |
| :----------: | :----------: |
| `Compare(0, 1)` | -1 |
| `Compare(0, 2)` | 1 |
| `Answer(2, 1)` | / |

## 说明/提示

对于所有数据，$1\leqslant N\leqslant 400$。

翻译来源自 LOJ。



---

---
title: "Kleene Inversion"
layout: "post"
diff: 普及/提高-
pid: AT_jsc2019_qual_b
tag: []
---

# Kleene Inversion

## 题目描述

[problemUrl]: https://atcoder.jp/contests/jsc2019-qual/tasks/jsc2019_qual_b

長さ $ N $ の整数列 $ A~=~A_0,~A_1,~...,~A_{N\ -\ 1} $ があります。

$ A $ を $ K $ 回繰り返した長さ $ K\ \times\ N $ の整数列を $ B $ とします。たとえば $ A~=~1,~3,~2 $、$ K~=~2 $ のとき、 $ B~=~1,~3,~2,~1,~3,~2 $ です。

$ B $ の転倒数を $ 10^9\ +\ 7 $ で割った余りを求めてください。

ここで $ B $ の転倒数は、整数の順序対 $ (i,~j)~(0\ \leq\ i\ <\ j\ \leq\ K\ \times\ N\ -\ 1) $ であって $ B_i\ >\ B_j $ を満たすものの個数として定義されます。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ K $ $ A_0 $ $ A_1 $ $ ... $ $ A_{N\ -\ 1} $

## 输出格式

$ B $ の転倒数を $ 10^9\ +\ 7 $ で割った余りを出力せよ。

## 说明/提示

### 制約

- 入力は全て整数である。
- $ 1\ \leq\ N\ \leq\ 2000 $
- $ 1\ \leq\ K\ \leq\ 10^9 $
- $ 1\ \leq\ A_i\ \leq\ 2000 $

### Sample Explanation 1

このケースでは $ B~=~2,~1,~2,~1 $ です。 - $ B_0\ >\ B_1 $ - $ B_0\ >\ B_3 $ - $ B_2\ >\ B_3 $ であり、$ B $ の転倒数は $ 3 $ です。

### Sample Explanation 2

$ A $ は同じ数を複数含むこともあります。

### Sample Explanation 3

$ 10^9\ +\ 7 $ で割った余りを出力することに注意してください。

## 样例 #1

### 输入

```
2 2

2 1
```

### 输出

```
3
```

## 样例 #2

### 输入

```
3 5

1 1 1
```

### 输出

```
0
```

## 样例 #3

### 输入

```
10 998244353

10 9 8 7 5 6 3 4 2 1
```

### 输出

```
185297239
```



---

---
title: "Nowhere P"
layout: "post"
diff: 普及/提高-
pid: AT_jsc2021_d
tag: []
---

# Nowhere P

## 题目描述

给你一个大于或等于 $2$ 的整数 $P$。 

如果一个整数序列 $A_1, A_2, ..., A_N$ 满足以下条件，那么它被称为一个非常好的序列。

对于 $1$ 到 $N$ 之间的任何整数 $i$，$A_1+A_2+\dots+A_i$ 不是 $P$ 的倍数

总共有 $(P-1)^N$ 个长度为 $N$ 的整数序列，其中每个元素都在 $1$ 和 $P-1$ 之间，这些序列中有多少个是非常好的？

答案可能非常大，所以输出对 $10^9+7$ 取模后的答案。

## 输入格式

一行，输入 $N$，$P$。

## 输出格式

输出对 $10^9+7$ 取模后的答案

## 样例 #1

### 输入

```
3 3
```

### 输出

```
2
```

## 样例 #2

### 输入

```
3 2
```

### 输出

```
0
```

## 样例 #3

### 输入

```
45108 2571593
```

### 输出

```
224219544
```



---

---
title: "ブロックの移動(Blocks)"
layout: "post"
diff: 普及/提高-
pid: AT_k4pc_a
tag: []
---

# ブロックの移動(Blocks)

## 题目描述

给出长度为 $n$ 的序列 $a$，每次操作可以任选 $i, j$ 让 $a_i = a_i - 1, a_j = a_j + 1$，求使整个序列满足 $a_i = i$ 所需要的最少操作步数。题目满足一定有解。

## 输入格式

第一行为一个数 $n$。

接下来 $n$ 行为序列 $a$。

## 输出格式

输出一个数，为所需要的最少操作数。

## 说明/提示

$1 \le n \le 100$。

## 样例 #1

### 输入

```
3

3

2

1
```

### 输出

```
2
```

## 样例 #2

### 输入

```
4

3

1

5

1
```

### 输出

```
4
```

## 样例 #3

### 输入

```
5

7

8

0

0

0
```

### 输出

```
12
```



---

---
title: "Wikipedia"
layout: "post"
diff: 普及/提高-
pid: AT_kupc2012pr_1
tag: []
---

# Wikipedia

## 题目描述

PA君某天在维基百科上看到了阿克曼函数。根据维基百科上的解释，阿克曼函数按以下函数进行递归。
- $A(0,n)=n+1(n≥0)$
- $A(m,0)=A(m-1,1)(m≥1)$
- $A(m,n)=A(m-1,A(m,n-1))(m,n≥1)$

阿克曼函数以它随给定参数爆炸式增长而著名。PA君试着手算了一下阿克曼函数的值，但这实在是太毒瘤了因此他很快便放弃了。你的任务就是帮PA君计算阿克曼函数的值。

## 输入格式

输入遵从以下形式
```
m n
```
m和n各为阿克曼函数的第一个和第二个参数。

## 输出格式

输出一行A(m,n)的值。
## 样例
### 输入1
```
2 3
```
### 输出1
```
9
```
### 输入2
```
3 45
```
### 输出2
```
281474976710653
```

## 说明/提示

- $0≤m≤3$
- $0≤n≤60$
- 输入都为整数。

注：亲测答案在long long范围内。

感谢@ミク 提供的翻译



---

---
title: "GUARDIANS"
layout: "post"
diff: 普及/提高-
pid: AT_kupc2015_b
tag: []
---

# GUARDIANS

## 题目描述

[problemUrl]: https://atcoder.jp/contests/kupc2015/tasks/kupc2015_b

あなたは幾多の試練を乗り越えた凄腕の冒険者であり，冒険で数々の宝物を手にした．これらを隠しダンジョンの奥にある宝物庫に保管し，*番犬*と妖怪*鎖頭*に守ってもらうことにした．隠しダンジョンは以下のような $ 10\ \times\ 10 $ の空間であり，一番左の $ 10 $ マス全てがダンジョンの入り口とつながっていて，一番右の $ 10 $ マス全てが宝物庫へとつながっている．

 ```

..........
..........
..........
..........
..........
..........
..........
..........
..........
..........
```

 現在，隠しダンジョンには何も置かれていない．宝を狙う命知らずな侵入者は一番左のいずれかのマスから侵入し，一番右のいずれかのマスを目指す． 侵入者が隠しダンジョンに入ると同時に*番犬*が左から侵入者を追いかけるので，**侵入者は右上，右，右下のいずれかのマスにしか移動できない．** また，$ 10\ \times\ 10 $ の空間の外に出ることもできない． あなたは隠しダンジョンに*鎖頭*をたくさん配置して侵入者を阻むことにした．*鎖頭*は以下の特徴をもつ．

- *鎖頭*は移動することができない．
- *鎖頭*は縦横斜めの好きな方向に自分がいるマスから2マス先まで頭を投げつける一撃必殺の攻撃を放つ．

*鎖頭*がいる場所を `C` とすると，その *鎖頭* の攻撃可能な範囲は以下の `X` で表される．侵入者は以下の`C`, `X`が書かれた範囲に立ち入ると，再起不能となる． ```

.......
.X.X.X.
..XXX..
.XXCXX.
..XXX..
.X.X.X.
.......
```

隠しダンジョンを*鎖頭*で埋め尽くしてしまうと全ての侵入者を排除できるが，それでは面白くないと感じたあなたは，侵入者が*鎖頭*に攻撃されずにスタートからゴールへたどり着けるルートが**ただひとつだけ**存在するように*鎖頭*を配置し，見事突破した侵入者にはその知略を称えて宝物の一部を差し出すことにした．

*鎖頭*を雇うには大金がかかる．あなたは倹約家でもあり，雇う*鎖頭*の数はなるべく少ないほうが良い．多くても誤答とはならないが，満点が得られるとは限らない．詳しくは部分点の制約を確認してほしい．経路が一通りに定まる配置をひとつ出力せよ．

## 输入格式

この問題に入力は存在しない．

## 输出格式

$ 10\ \times\ 10 $ の隠しダンジョンの盤面を出力せよ．`C`はそこに*鎖頭*が配置されることを表し，`.`はそこには何もないことを表す．**追記: `C`は大文字であることに注意せよ．** 出力にこれら2種類の文字と改行以外が含まれている場合，出力は問題の条件を満たしていないものとみなされるので注意せよ．

## 说明/提示

### 部分点

 この問題には部分点が存在する．配点は以下の通りである．

- 盤面が問題文中の左端から右端への経路をただ一通りに定める場合，*Accepted* と判定され， $ N $ 体の*鎖頭* を配置した時，$ floor(400 $ $ ／ $ $ (max(4,\ N-1))) $ 点が与えられる．
- そうでない場合，*Wrong Answer* と判定され，点数は得られない．
- **システムの都合上，*Accepted* で $ X $ 点を獲得した場合，それまでに提出した *Accepted* な解法のうち，$ X $ 点 未満のものは全て誤答としてカウントされ，ペナルティが発生するので注意すること．**

### ヒント

- $ N\ =\ 5 $ の解でも満点が得られるが， $ N\ =\ 4 $ の解も存在する．

### Sample Explanation 1

左端から右端までの経路が一通りのみ存在し，配置した\*鎖頭\*は $ 50 $ 体である．この盤面を提出した場合，$ 8 $ 点が得られる．

### Sample Explanation 2

左端から右端までの経路が一通りのみ存在し，配置した\*鎖頭\*は $ 44 $ 体である．この盤面を提出した場合，$ 9 $ 点が得られる．

### Sample Explanation 3

この盤面では，左端から右端への道がただ一通りに定まらない．左から右へ直進するルートと，一度右下に移動した後に右上に移動するルートがある．提出した場合， \*Wrong Answer\* と判定され，点は得られない．

### Sample Explanation 4

この盤面では，左端から右端への道が存在しない．侵入者は`C`のマスにも立ち入れず，$ 10\ \times\ 10 $ の空間の外に出ることもできない点に注意せよ．提出した場合， \*Wrong Answer\* と判定され，点は得られない．

## 样例 #1

### 输入

```
None
```

### 输出

```
CCCCCCCCCC

CCCCCCCCCC

..........

..........

..........

..........

..........

CCCCCCCCCC

CCCCCCCCCC

CCCCCCCCCC
```

## 样例 #2

### 输入

```
None
```

### 输出

```
CCCCC.C...

CCCC.C....

CCC.C.....

CC.C.....C

C.C.....C.

.C.....C.C

C.....C.CC

.....C.CCC

....C.CCCC

...C.CCCCC
```

## 样例 #3

### 输入

```
None
```

### 输出

```
CCCCCCCCCC

CCCCCCCCCC

..........

..........

..........

..........

..........

CC.....CCC

CCCCCCCCCC

CCCCCCCCCC
```

## 样例 #4

### 输入

```
None
```

### 输出

```
CCCCCCCCCC

..........

..........

..........

.C........

..........

..........

.C........

..........

..........
```



---

---
title: "ナップサック問題"
layout: "post"
diff: 普及/提高-
pid: AT_kupc2019_b
tag: []
---

# ナップサック問題

## 题目描述

[problemUrl]: https://atcoder.jp/contests/kupc2019/tasks/kupc2019_b

$ n $ 個の品物があり、$ 1 $ から $ n $ までの番号が付けられています。

各品物には価値と重さが定められていて、$ i $ 番目の品物の価値は $ v_i $、重さは $ w_i $ です。

あなたはこれらの品物から重さの総和が $ W $ を超えないようにいくつか選び、選んだ品物の価値の総和を最大化したいです。

ただし、$ m $ 個の条件があります。

$ j $ 番目の条件は $ (a_j,\ b_j) $ で表され、それぞれ「 $ a_j $ 番目の品物を選ぶならば $ b_j $ 番目の品物を選ばなければならず、$ b_j $ 番目の品物を選ぶならば $ a_j $ 番目の品物を選ばなければならない」 という意味です。

これらの条件を全て満たした上で、$ n $ 個の品物から重さの総和が $ W $ を超えないようにいくつか品物を選んだときの価値の総和の最大値を求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ n $ $ m $ $ W $ $ w_1 $ $ v_1 $ $ w_2 $ $ v_2 $ $ \vdots $ $ w_n $ $ v_n $ $ a_1 $ $ b_1 $ $ a_2 $ $ b_2 $ $ \vdots $ $ a_m $ $ b_m $

## 输出格式

$ m $ 個の条件を全て満たした上で、$ n $ 個の品物から重さの総和が $ W $ を超えないようにいくつか品物を選んだときの価値の総和の最大値を出力せよ。

## 说明/提示

### 制約

- 入力中の値は全て整数である。
- $ 1\ \leq\ n\ \leq\ 100 $
- $ 0\ \leq\ m\ \leq\ \frac\ {n(n-1)}{2} $
- $ 1\ \leq\ W\ \leq\ 10^4 $
- $ 1\ \leq\ w_i\ \leq\ W $
- $ 1\ \leq\ v_i\ \leq\ 10^7 $
- $ 1\ \leq\ a_i,\ b_i\ \leq\ n $
- $ a_i\ \neq\ b_i $
- $ i\ \neq\ j $ ならば、$ (a_i,\ b_i)\ \neq\ (a_j,\ b_j) $ かつ $ (a_i,\ b_i)\ \neq\ (b_j,\ a_j) $

### Sample Explanation 1

$ 1 $ 番目の品物と $ 2 $ 番目の品物を選ぶことで価値の総和を $ 6 $ にすることができ、これが最適です。 条件から、$ 2 $ 番目の品物と $ 3 $ 番目の品物だけを選ぶことはできないことに注意してください。

### Sample Explanation 2

全ての品物を選ぶことができます。

### Sample Explanation 3

一つも品物を選ぶことができません。

## 样例 #1

### 输入

```
3 1 10

3 2

5 4

3 3

1 2
```

### 输出

```
6
```

## 样例 #2

### 输入

```
4 0 10

1 1

2 2

3 3

4 4
```

### 输出

```
10
```

## 样例 #3

### 输入

```
3 3 6

2 5

3 8

3 4

1 2

2 3

3 1
```

### 输出

```
0
```

## 样例 #4

### 输入

```
1 0 10000

10000 10000000
```

### 输出

```
10000000
```



---

---
title: "ロボットアーム"
layout: "post"
diff: 普及/提高-
pid: AT_mujin_pc_2016_b
tag: []
---

# ロボットアーム

## 题目描述

想象一只机器人手臂，将其看作是二维的一条线 $O-A-B-C$，其中 $O$ 这个点固定在原点 $(0,0)$。

如下图所示。

![](https://mujin-pc-2016.contest.atcoder.jp/img/other/mujin2016/arm_01.png)

现在，你可以改变 $\angle O,\ \angle A$ 和 $\angle B$ 的角度，但不可以改变任何线段的长度。

现在给定各条线段的长度，你需要计算 $C$ 能到达的范围总面积。

## 输入格式

$$l_{OA}\ l_{AB}\ l_{BC}$$

## 输出格式

输出 $C$ 可以到达的范围面积，误差不超过 $10^{-6}$ 都会视作正确答案。

**在最后输出换行。**

### 样例数据

**样例 1**

```
1 1 1
```

```
28.2743338823
```

解释：

![](https://mujin-pc-2016.contest.atcoder.jp/img/other/mujin2016/arm_02.png)

**样例 2**

```
3 1 1
```

```
75.3982236862
```

解释：

![](https://mujin-pc-2016.contest.atcoder.jp/img/other/mujin2016/arm_03.png)

**样例 3**

```
16 2 27
```

```
6107.2561185786
```

## 说明/提示

$1\le l_{OA},\ l_{AB},\ l_{BC}\le 100$

### 翻译贡献

@[hellolin](https://www.luogu.com.cn/user/751017) 译。



---

---
title: "右折"
layout: "post"
diff: 普及/提高-
pid: AT_mujin_pc_2018_c
tag: []
---

# 右折

## 题目描述

[problemUrl]: https://atcoder.jp/contests/mujin-pc-2018/tasks/mujin_pc_2018_c

$ N $ 行 $ M $ 列のマス目があります。上から $ i $ 行目、左から $ j $ 列目にあるマスを $ (i,j) $ で表します。 特に、左上のマスは $ (1,1) $ であり、右下のマスは $ (N,M) $ です。 マス目の状態は 二次元配列 $ s $ で表され、$ s_{ij} $ が `#` のときマス $ (i,j) $ には障害物があり、`.` のとき障害物がないことを表します。

高橋君は、このマス目のいずれかのマスに、上下左右いずれかの方向を向けたロボットを置きました。 ロボットは向いている方向に $ 1 $ マス以上まっすぐ進んだ後、向きを右に $ 90 $ 度変え、再びまっすぐに $ 1 $ マス以上進んで停止しました。 この過程でロボットが通ったマス(置かれたマスおよび停止したマスを含む)のいずれにも障害物はなく、またロボットがマス目の外に出ることはありませんでした。

ロボットが置かれたマスと停止したマスの順序対としてありうるものの個数を求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ M $ $ s_{11}...s_{1M} $ $ : $ $ s_{N1}...s_{NM} $

## 输出格式

ロボットが置かれたマスと停止したマスの順序対としてありうるものの個数を出力せよ。

## 说明/提示

### 制約

- $ 2\ \leq\ N,M\ \leq\ 2\times\ 10^3 $
- $ s_{ij} $ は `#` または `.` である

### Sample Explanation 1

$ ((1,1),(2,2)),((1,1),(3,2)),((1,2),(2,1)),((2,1),(1,2)),((2,1),(3,2)),((2,2),(1,1)),((2,3),(1,2)),((2,3),(1,1)),((3,2),(2,3)) $ の $ 9 $ 個が条件を満たします。

## 样例 #1

### 输入

```
3 3

..#

...

#.#
```

### 输出

```
9
```

## 样例 #2

### 输入

```
2 5

.#.#.

..#..
```

### 输出

```
2
```

## 样例 #3

### 输入

```
6 8

#......#

##....##

#.#..#.#

#..##..#

#......#

#......#
```

### 输出

```
182
```



---

---
title: "Maximum Sum of Minimum"
layout: "post"
diff: 普及/提高-
pid: AT_m_solutions2019_d
tag: []
---

# Maximum Sum of Minimum

## 题目描述

[problemUrl]: https://atcoder.jp/contests/m-solutions2019/tasks/m_solutions2019_d

$ N $ 個の頂点 $ 1,2,\ldots,N $ からなる木 $ T $ と正の整数 $ c_1,c_2,\ldots,c_N $ が与えられます。 $ i(1\ \leq\ i\ \leq\ N-1) $ 番目の辺は頂点 $ a_i $ と頂点 $ b_i $ をつなぐ辺です。

$ T $ の各頂点に正の整数を書き込んだとき、以下のようにしてスコアを計算します。

- 各辺に、$ 2 $ つの端点に書き込まれた整数のうち小さい方を書き込む。
- 各辺に書き込まれた整数の総和をスコアとする。

$ T $ の各頂点に $ c_1,c_2,\ldots,c_N $ を $ 1 $ つずつ書き込んだときのスコアの最大値を求め、 それを達成する正の整数の書き込み方を $ 1 $ つ構成してください。

$ c_1,c_2,\ldots,c_N $ に複数回現れる整数があるときは、 その整数はその回数だけ使わなければならないことに注意してください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ a_1 $ $ b_1 $ $ : $ $ a_{N-1} $ $ b_{N-1} $ $ c_1 $ $ \ldots $ $ c_N $

## 输出格式

次の形式で出力せよ。

> $ M $ $ d_1 $ $ \ldots $ $ d_N $

$ M $ はスコアの最大値を表す。 $ d_i $ は頂点 $ i $ に書き込むべき整数を表す。 $ d_1,d_2,\ldots,d_N $ は $ c_1,c_2,\ldots,c_N $ の並べ替えでなければならない。

最大のスコアを達成する方法が複数個あるときは、 そのうちのどれを出力してもよい。

## 说明/提示

### 制約

- $ 1\ \leq\ N\ \leq\ 10000 $
- $ 1\ \leq\ a_i,b_i\ \leq\ N $
- $ 1\ \leq\ c_i\ \leq\ 10^5 $
- 与えられるグラフは木である

### Sample Explanation 1

頂点 $ 1,2,3,4,5 $ にそれぞれ $ 1,2,3,4,5 $ を書き込むと、 $ 4 $ つの辺にはそれぞれ $ 1,2,3,4 $ が書き込まれるので、スコアは $ 10 $ になります。 これが最大のスコアです。

### Sample Explanation 2

$ c_1,c_2,\ldots,c_N $ は互いに異なるとは限りません。

## 样例 #1

### 输入

```
5

1 2

2 3

3 4

4 5

1 2 3 4 5
```

### 输出

```
10

1 2 3 4 5
```

## 样例 #2

### 输入

```
5

1 2

1 3

1 4

1 5

3141 59 26 53 59
```

### 输出

```
197

59 26 3141 59 53
```



---

---
title: "Counting of Trees"
layout: "post"
diff: 普及/提高-
pid: AT_nikkei2019_2_qual_b
tag: []
---

# Counting of Trees

## 题目描述

[problemUrl]: https://atcoder.jp/contests/nikkei2019-2-qual/tasks/nikkei2019_2_qual_b

$ N $ 要素からなる整数列 $ D_1,...,D_N $ が与えられます。頂点に $ 1 $ から $ N $ の番号が付けられた $ N $ 頂点からなる木であって、 以下の条件をみたすものの個数を $ 998244353 $ で割ったあまりを求めてください。

- $ 1 $ 以上 $ N $ 以下の任意の整数 $ i $ に対して、頂点 $ 1 $ と頂点 $ i $ の距離が $ D_i $ である。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ D_1 $ $ D_2 $ $ ... $ $ D_N $

## 输出格式

答えを出力せよ。

## 说明/提示

### 注記

- $ N $ 頂点の木とは $ N $ 頂点 $ N-1 $ 辺からなる連結無向グラフのことであり、$ 2 $ 頂点の距離とは一方から他方への最短路に用いられる辺の個数を指します。
- $ 2 $ つの木が異なるとは、ある $ 2 $ 頂点 $ x $, $ y $ が存在して、$ x $ と $ y $ の間に一方の木では辺が存在し、 もう一方の木では辺が存在しないことを指します。

### 制約

- $ 1\ ≦\ N\ ≦\ 10^5 $
- $ 0\ ≦\ D_i\ ≦\ N-1 $

### Sample Explanation 1

例えば、$ (1,2) $, $ (1,3) $, $ (2,4) $ の間に辺があるような木が条件をみたします。

## 样例 #1

### 输入

```
4

0 1 1 2
```

### 输出

```
2
```

## 样例 #2

### 输入

```
4

1 1 1 1
```

### 输出

```
0
```

## 样例 #3

### 输入

```
7

0 3 2 1 2 2 1
```

### 输出

```
24
```



---

---
title: "Different Strokes"
layout: "post"
diff: 普及/提高-
pid: AT_nikkei2019_qual_c
tag: []
---

# Different Strokes

## 题目描述

[problemUrl]: https://atcoder.jp/contests/nikkei2019-qual/tasks/nikkei2019_qual_c

高橋くんと青木さんの前に $ N $ 皿の料理が置かれています。 便宜上、これらの料理を料理 $ 1 $、料理 $ 2 $、…、料理 $ N $ と呼びます。

高橋くんが料理 $ i $ を食べると彼は $ A_i $ ポイントの *幸福度* を得ます。 また、青木さんが料理 $ i $ を食べると彼女は $ B_i $ ポイントの幸福度を得ます。

彼らは、高橋くんから始めて交互に、料理を $ 1 $ 皿ずつ選んで食べることを料理が尽きるまで続けます。 ただし、彼らはともに、「最終的に自分が得る幸福度の総和」から「最終的に相手が得る幸福度の総和」を引いた値を最大化するように料理を選びます。

このとき、「最終的に高橋くんが得る幸福度の総和」から「最終的に青木さんが得る幸福度の総和」を引いた値はいくつになるでしょうか？

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ A_1 $ $ B_1 $ $ : $ $ A_N $ $ B_N $

## 输出格式

「最終的に高橋くんが得る幸福度の総和」から「最終的に青木さんが得る幸福度の総和」を引いた値を出力せよ。

## 说明/提示

### 制約

- $ 1\ \leq\ N\ \leq\ 10^5 $
- $ 1\ \leq\ A_i\ \leq\ 10^9 $
- $ 1\ \leq\ B_i\ \leq\ 10^9 $
- 入力される値はすべて整数である。

### Sample Explanation 1

この例では、二人のどちらも、料理 $ 1 $ を食べると $ 10 $ ポイント、料理 $ 2 $ を食べると $ 20 $ ポイント、料理 $ 3 $ を食べると $ 30 $ ポイントの幸福度を得ます。 この場合、高橋くんと青木さんの「好み」が一致しているため、彼らは毎回残っている料理のうち最も幸福度を多く得られる料理を選びます。よって、最初に高橋くんは料理 $ 3 $ を選び、次に青木さんは料理 $ 2 $ を選び、最後に高橋くんが料理 $ 1 $ を選ぶため、答えは $ (30\ +\ 10)\ -\ 20\ =\ 20 $ です。

### Sample Explanation 2

この例では、高橋くんは料理 $ 1,2,3 $ のいずれを食べても $ 20 $ ポイントの幸福度を得ますが、青木さんは料理 $ 1 $ を食べると $ 10 $ ポイント、料理 $ 2 $ を食べると $ 20 $ ポイント、料理 $ 3 $ を食べると $ 30 $ ポイントの幸福度を得ます。 今回は、青木さんのみに料理の好き嫌いがあるため、彼らは毎回残っている料理のうち青木さんが最も幸福度を多く得られる料理を選びます。よって、最初に高橋くんは料理 $ 3 $ を選び、次に青木さんは料理 $ 2 $ を選び、最後に高橋くんが料理 $ 1 $ を選ぶため、答えは $ (20\ +\ 20)\ -\ 20\ =\ 20 $ です。

### Sample Explanation 3

答えは $ 32 $ ビット整数に収まらない可能性があります。

## 样例 #1

### 输入

```
3

10 10

20 20

30 30
```

### 输出

```
20
```

## 样例 #2

### 输入

```
3

20 10

20 20

20 30
```

### 输出

```
20
```

## 样例 #3

### 输入

```
6

1 1000000000

1 1000000000

1 1000000000

1 1000000000

1 1000000000

1 1000000000
```

### 输出

```
-2999999997
```



---

---
title: "Folia"
layout: "post"
diff: 普及/提高-
pid: AT_nomura2020_c
tag: []
---

# Folia

## 题目描述

[问题网址](https://atcoder.jp/contests/nomura2020/tasks/nomura2020_c)

给定一个长度为 $N+1$ 的非负整数序列 $A_0,A_1,A_2,\cdots,A_N$。问是否存在一棵深度为 $N$ 的二叉树，对于每一个 $d=0,1,2,\cdots,N$，使得在深度 $d$ 处正好有 $A_d$ 个叶子结点。如果存在，则输出此类二叉树的最大顶点数量，如果不存在，则输出 $-1$。

## 输入格式

> $N$   
> $A_0$ $A_1$ $A_2$ $\cdots$ $A_N$

## 输出格式

$1$ 行 $1$ 个整数，代表答案。

## 说明/提示

### 注释

- 二叉树是一棵有根树，每个结点最多有两个子结点。
- 二叉树中的叶子是没有子结点的结点。
- 二叉树中结点 $v$ 的深度是从根结点到 $v$ 的距离（根结点的深度为 $0$）。
- 二叉树的深度是树中结点的最大深度。


- $0\le N\le 10^5$
- $0\leq A_i\le 10^8$（$0\le i\le N$）
- $A_N\ge 1$
- 所有输入均为非负整数。


对于样例 $1$，以下是一种可能的答案：  
![0d8d99d13df036f23b0c9fcec52b842b.png](https://img.atcoder.jp/nomura2020/0d8d99d13df036f23b0c9fcec52b842b.png)   
翻译@[ans_mod998244353](https://www.luogu.com.cn/user/582360)。

## 样例 #1

### 输入

```
3

0 1 1 2
```

### 输出

```
7
```

## 样例 #2

### 输入

```
4

0 0 1 0 2
```

### 输出

```
10
```

## 样例 #3

### 输入

```
2

0 3 1
```

### 输出

```
-1
```

## 样例 #4

### 输入

```
1

1 1
```

### 输出

```
-1
```

## 样例 #5

### 输入

```
10

0 0 1 1 2 3 5 8 13 21 34
```

### 输出

```
264
```



---

---
title: "文字列の書き換え"
layout: "post"
diff: 普及/提高-
pid: AT_nyc2015_3
tag: []
---

# 文字列の書き換え

## 题目描述

作为新年礼物，溜君收到了字串s。通过重复下面的操作，判断能否跳过s，成为你喜欢的文字列t。



操作：从s中选择一个字符，然后插入一个与紧接着选择的字符不同的字符。

1 ≤ ∣s∣ ≤ ∣t∣ < = 5000

## 输入格式

第一行输入s

第二行输入t

## 输出格式

请输出“是”或“否”。



---

---
title: "パ研軍旗"
layout: "post"
diff: 普及/提高-
pid: AT_pakencamp_2019_day3_d
tag: []
---

# パ研軍旗

## 题目描述

[problemUrl]: https://atcoder.jp/contests/pakencamp-2019-day3/tasks/pakencamp_2019_day3_d

筑駒パ研は，近い将来，パ研戦争に臨むことになりました．そのために，軍旗を作ることになりました．

旗のデザインは縦に $ 5 $ 個，横に $ N $ 個に分かれた $ 5\ \times\ N $ のマス目で表されます．上から $ i $ 行目，左から $ j $ 列目のマスを，$ (i,\ j) $ で表すことにします．

現在，旗のそれぞれのマスは赤・青・白・黒のいずれかで塗られています．より具体的には，マス $ (i,\ j) $ は色 $ S_{i,\ j} $ で塗られています．ただし，$ S_{i,\ j} $ は `R`, `B`, `W`, `#` のいずれかで，それぞれ赤・青・白・黒で塗られていることを表しています．

E869120 君は，パ研軍旗を、次の条件を満たすように青・白・赤で塗り替えたいです．

- $ N $ 個の列すべてにおいて，その列の $ 5 $ マスが「全部青」「全部白」「全部赤」のいずれかである
- どの隣り合った $ 2 $ つの列も，色が異なる

ただし，黒いマスがあったら条件を満たさないことに注意してください．

以下が，条件を満たす旗と条件を満たさない旗の例です．

![ ](https://cdn.luogu.com.cn/upload/vjudge_pic/AT_pakencamp_2019_day3_d/6f1da94e1beb878e9f99f1bce0627c77a75d904e.png)

- 例 $ 1 $ は条件を満たします．
- 例 $ 2 $ は，例えば左から $ 2 $ 番目の列で青と白のマスがあり，$ 5 $ つ全部同じになっている必要があるという条件を満たしません．
- 例 $ 3 $ は，例えば左から $ 3 $ 番目の列と左から $ 4 $ 番目の列の色が同じなので，条件を満たしません．
- 例 $ 4 $ は，例えば左から $ 5 $ 番目の色が黒になっているので，条件を満たしません．

E869120 君は，旗の作成時間を短くするため，できるだけ塗り替えるマスの個数を少なくしたいです．  
 最小でいくつのマスを塗り替える必要があるか求めるプログラムを書いてください．

## 输入格式

入力は以下の形式で標準入力から与えられます．  
 ただし、旗のそれぞれの行の色の情報 $ S_{i,\ 1},\ S_{i,\ 2},\ S_{i,\ 3},\ \dots,\ S_{i,\ N} $ は，これがつながった $ N $ 文字の文字列として入力されることに注意してください．

> $ N $ $ S_{1,\ 1}\ S_{1,\ 2}\ S_{1,\ 3}\ \cdots\ S_{1,\ N} $ $ S_{2,\ 1}\ S_{2,\ 2}\ S_{2,\ 3}\ \cdots\ S_{2,\ N} $ $ S_{3,\ 1}\ S_{3,\ 2}\ S_{3,\ 3}\ \cdots\ S_{3,\ N} $ $ S_{4,\ 1}\ S_{4,\ 2}\ S_{4,\ 3}\ \cdots\ S_{4,\ N} $ $ S_{5,\ 1}\ S_{5,\ 2}\ S_{5,\ 3}\ \cdots\ S_{5,\ N} $

## 输出格式

パ研軍旗を作るときに塗り替える必要のあるマスの個数の最小値を，$ 1 $ 行で出力してください．

## 说明/提示

### 制約

すべての入力データは，以下の制約を満たす．

- $ N $ は $ 1\ \leq\ N\ \leq\ 999 $ をみたす整数
- $ S_{i,\ j} $ は `R`, `B`, `W`, `#` のいずれか

### 部分点

この問題はいくつかの小課題に分けられ，その小課題のすべてのテストケースに正解した場合に「この小課題に正解した」とみなされます．  
 提出したソースコードの得点は，正解した小課題の点数の合計となります．

1. (11 点) $ N\ =\ 1 $ である．
2. (13 点) $ N\ =\ 3 $ である．
3. (29 点) $ N\ \leq\ 10 $ である．
4. (22 点) $ 5 $ つの行すべてにおいて，その行の $ N $ 個のマスがすべて同じ色である．
5. (25 点) 追加の制約はない．

**ただし，小課題 $ 4 $ について，「$ N $ 個の列すべてにおいて，その列の $ 5 $ 個のマスがすべて同じ色である」のような読み間違えをしないように注意してください．**

### Sample Explanation 1

以下の $ 3 $ 通りのパ研軍旗を作ることができます． - すべてのマスを赤にする．そのとき，マス $ (1,\ 1),\ (3,\ 1),\ (4,\ 1),\ (5,\ 1) $ の $ 4 $ マスを塗り替える必要がある． - すべてのマスを青にする．そのとき，マス $ (2,\ 1),\ (3,\ 1),\ (4,\ 1) $ の $ 3 $ マスを塗り替える必要がある． - すべてのマスを白にする．そのとき，マス $ (1,\ 1),\ (2,\ 1),\ (3,\ 1),\ (5,\ 1) $ の $ 4 $ マスを塗り替える必要がある． その中では，「すべてのマスを青」にするのが最適です．そのとき，塗り替えるマスの個数は $ 3 $ 個になります． ちなみに，これは $ N\ =\ 1 $ なので，小課題 $ 1 $ の制約をみたします．

### Sample Explanation 2

$ 1 $ 列目を青、$ 2 $ 列目を白、$ 3 $ 列目を赤にすると，塗り替えるマスの個数を $ 10 $ 個にできて，これが最適です． !\[ \](https://img.atcoder.jp/pakencamp-2019-day3/7607c1554c09d7d875918ccf09d65f78.png) (ここでは，「★」は塗り替えられたマスを表します) ちなみに，これは $ N\ =\ 3 $ なので，小課題 $ 2 $ の制約をみたします．

### Sample Explanation 3

次の図のように塗り替えるのが最適です．塗り替えるマスの数は $ 28 $ 個となります．(ここでは，「★」は塗り替えられたマスを表します) !\[ \](https://img.atcoder.jp/pakencamp-2019-day3/a660d84b5614953bf2b4e7ee8342fabd.png)

### Sample Explanation 4

次の図のように塗り替えるのが最適です．塗り替えるマスの数は $ 21 $ 個となります．(ここでは，「★」は塗り替えられたマスを表します) !\[ \](https://img.atcoder.jp/pakencamp-2019-day3/cb86f987229c1ab46e30411860964c19.png)

## 样例 #1

### 输入

```
1

B

R

#

W

B
```

### 输出

```
3
```

## 样例 #2

### 输入

```
3

WWR

#RW

BW#

##B

RBR
```

### 输出

```
10
```

## 样例 #3

### 输入

```
8

RRRRRRRR

########

BBBBBBBB

RRRRRRRR

WWWWWWWW
```

### 输出

```
28
```

## 样例 #4

### 输入

```
7

BR#WB#R

RWW#WRB

##WBR#W

WB#B#RW

BRW##BB
```

### 输出

```
21
```



---

---
title: "整地"
layout: "post"
diff: 普及/提高-
pid: AT_past201912_n
tag: []
---

# 整地

## 题目描述

坐标轴上有 $n$ 个区间，每个区间均在左端点为 $0$，右端点为 $w$ 的线段内。第 $i$ 个区间的左右端点表示的数字分别为 $l_i$ 和 $r_i$。

现在你要去掉一部分区间，使得有一段长度为 $c$ 的线段没有被任何区间覆盖。第 $i$ 个区间删去的代价为 $p_i$。请输出你所花费的最小代价。

## 输入格式

第一行为三个整数 $n,w,c$。

接下来 $n$ 行，每行三个整数 $l_i,r_i,p_i$。

## 输出格式

一行一个整数，最小代价。（若不需要删去任何一个区间，输出`0`即可。）

### 数据规模与约定

$1 \le n \le 100000$，$10 \le w \le 10^9$，$1 \le c \le w$，$0 \le l_i \lt r_i \le w$，$1 \le p_i \le 10^9$。

## 样例 #1

### 输入

```
3 10 5

1 3 100

8 10 123

4 6 3
```

### 输出

```
3
```

## 样例 #2

### 输入

```
22 30 10

0 30 1000000000

0 30 1000000000

0 30 1000000000

7 30 261806

6 19 1

5 18 1238738

12 28 84

10 14 5093

9 20 9

15 26 8739840

6 8 240568

14 19 198

2 4 1102

1 29 5953283

9 20 183233

9 13 44580

6 23 787237159

12 14 49

28 29 9020727

14 20 318783

2 19 9862194

9 30 166652
```

### 输出

```
3805189325
```



---

---
title: "行列操作"
layout: "post"
diff: 普及/提高-
pid: AT_past202005_i
tag: []
---

# 行列操作

## 题目描述

有一个满足以下条件的一个 $n \times n$ 的矩阵 $a$。若将该数列上起第 $i$ 行，左起第 $j$ 列上的数记为 $a_{i,j}$，则：

- 当 $1 \le i,j \le n$ 时，$a_{i,j}=n \times (i-1)+j-1$。

## 输入格式

- `1 x y`：对于所有满足 $1 \le i \le n$ 的 $i$，交换 $a_{x,i}$ 与 $a_{y,i}$ 的值。
- `2 x y`：对于所有满足 $1 \le i \le n$ 的 $i$，交换 $a_{i,x}$ 与 $a_{i,y}$ 的值。
- `3`：转置矩阵 $a$，即对于所有满足 $1 \le i,j \le n$ 的 $i$ 和 $j$，将原来 $a_{i,j}$ 的值改为 $a_{j,i}$ 的值。
- `4 x y`：输出当前矩阵中 $a_{x,y}$ 的值并换行。

请注意，在进行 $1$ 操作和 $2$ 操作时，如果 $x=y$，则矩阵在操作后无变化。

## 输出格式

对于形如`4 x y`形式的操作，输出 $a_{x,y}$ 的值并换行。请注意， $32$ 位整数类型可能不适合。

## 说明/提示

**数据规模与约定**

对于全部测试点，数据保证：

- $1 \le n,q \le 10^5$；
- $1 \le x,y \le n$；
- 保证至少存在一个形如`4 x y`格式的查询；
- 输入中的所有数值均为整数。

## 样例 #1

### 输入

```
2

19

4 1 1

4 1 2

4 2 1

4 2 2

3

4 1 1

4 1 2

4 2 1

4 2 2

1 1 2

4 1 1

4 1 2

4 2 1

4 2 2

2 2 1

4 1 1

4 1 2

4 2 1

4 2 2
```

### 输出

```
0

1

2

3

0

2

1

3

1

3

0

2

3

1

2

0
```

## 样例 #2

### 输入

```
3

9

2 2 3

3

1 2 1

2 3 2

1 1 3

3

4 1 1

4 2 2

4 2 3
```

### 输出

```
1

6

8
```



---

---
title: "べき表現"
layout: "post"
diff: 普及/提高-
pid: AT_past202107_g
tag: []
---

# べき表現

## 题目描述

给定一个整数 $n(1\le n\le 10^{15})$，请输出一个长为 $m(1\le m\le 100)$ 的整数数列 $a$，满足：

- $\sum a_i=n$；
- $|a_i|\le 10^{18}$，且当 $i\neq j$ 时，$|a_i|\neq|a_j|$；
- 对于每一个满足 $1\le i\le m$ 的整数 $i$，$|a_i|=3^x$，其中 $x$ 为自然数。

数据保证，在本题数据范围下，数列 $a$ 一定存在。若有多解，输出任一解即可。

## 输入格式

一行一个整数 $n$。

## 输出格式

两行，第一行输出整数 $m$，第二行输出 $m$ 个整数，表示数列 $a$。

## 样例 #1

### 输入

```
6
```

### 输出

```
2

9 -3
```

## 样例 #2

### 输入

```
9193
```

### 输出

```
9

2187 27 1 -243 3 9 -81 6561 729
```

## 样例 #3

### 输入

```
10120190919012
```

### 输出

```
16

-1594323 9 -177147 -531441 1162261467 -4782969 387420489 -6561 -2187 2541865828329 -27 7625597484987 3486784401 10460353203 -94143178827 31381059609
```



---

---
title: "数列の反転"
layout: "post"
diff: 普及/提高-
pid: AT_past202109_j
tag: []
---

# 数列の反転

## 题目描述

维护一个长度为 $2n$ 的序列 $a$。开始时，对于每个满足 $1 \le a \le 2n$ 的整数 $i$，都有 $a_i=i$。

给出 $q$ 次操作，每次操作都为以下两种形式中的一种：

- `1 k`：输出 $a_k$ 的值并换行。保证 $1 \le k \le 2n$。
- `2 k`：反转 $[n-k+1,n+k]$ 这个区间。反转后，原来的第 $p$ 个元素被换到了第 $2n-p+1$ 个元素的位置。保证 $1 \le k \le n$。

请按顺序执行操作。

## 输入格式

第一行输入两个整数 $n,q$。

接下来 $q$ 行，每行两个整数 $t_i$ 和 $k_i$。$t_i$ 为操作类型，$k_i$ 为操作参数。

## 输出格式

对于每个操作 $1$，输出此时 $a_k$ 的值并换行。

## 说明/提示

#### 数据规模与约定

$1 \le n,q \le 2 \times10^5$，$1 \le t_i \le 2$。

## 样例 #1

### 输入

```
3 2

2 2

1 4
```

### 输出

```
3
```

## 样例 #2

### 输入

```
3 3

2 3

1 3

1 1
```

### 输出

```
4

6
```

## 样例 #3

### 输入

```
5 6

2 2

2 1

2 1

2 3

1 2

2 3
```

### 输出

```
2
```



---

---
title: "回転と反転"
layout: "post"
diff: 普及/提高-
pid: AT_past202112_j
tag: []
---

# 回転と反転

## 题目描述

有一个 $n$ 行 $n$ 列的网格图，开始时全部被涂为白色。

给出 $q$ 次操作，每次操作的格式及内容如下：

- `1 x y`：若上起第 $x$ 行左起第 $y$ 列的网格为白色，将其涂黑；若为黑色，将其涂白。
- `2 c`：若 $c$ 为`Ａ`，将整张图顺时针旋转 $90°$；否则，将整张图逆时针旋转 $90°$。
- `3 c`：若 $c$ 为`Ａ`，垂直翻转整张图；否则，水平翻转整张图。

请在全部操作完成后输出每一个格子的颜色。

## 输入格式

第一行：两个整数 $n,q$。

## 输出格式

输出一个 $n\times n$ 的字符图，其中第 $i$ 行第 $j$ 列的字符表示了第 $i$ 行第 $j$ 个格子的颜色。用`0`表示白色，`1`表示黑色。

## 说明/提示

#### 样例 #1 说明

将 $(1,1)$ 涂黑，然后顺时针旋转 $90°$。

#### 数据规模与约定

$100\%$ 的数据保证：

- $1 \le n\le 300$；
- $1 \le q\le 2 \times 10^5$；
- $1 \le x,y \le n$；
- $c$ 为 `A` 或 `B`。

## 样例 #1

### 输入

```
3 2

1 1 1

2 A
```

### 输出

```
001

000

000
```

## 样例 #2

### 输入

```
3 3

1 1 1

3 A

3 B
```

### 输出

```
000

000

001
```

## 样例 #3

### 输入

```
4 8

2 A

1 4 2

2 A

1 2 2

3 B

3 B

3 A

1 3 1
```

### 输出

```
0000

0000

0100

0000
```



---

---
title: "Capture"
layout: "post"
diff: 普及/提高-
pid: AT_relay2_f
tag: []
---

# Capture

## 题目描述

# 题目大意

在东西方向延伸的细长的森林里栖息着 $N$ 只动物。从森林的最左端到 $p$ 米的地点称为地点 $p$ 。若第i头动物到森林最左端的距离为 $x$（1≤i≤N）那么它就在地点 $x_i$ ，若捕获的话你可以以 $s_i$ 日元卖出。

选择两个整数 $L$ 和 $R$（L≤R），那么，从 $L$ 到 $R$ 范围内的动物就会全部被捕获。但是，买网要花费 $R$-$L$日元，所以你的利益=(被捕获的所有的除物i的合计)-($R$-$L$)日元。

若你只放一次网，得到的最大利益是多少呢？

## 输入格式

$x_1$ $s_1$

$x_2$ $s_2$

$:$

$x_N$ $s_N$

## 输出格式

输出最大利益X

## 说明/提示

1 ≤ $N$ ≤ 2 × $10_5$

1 ≤ x1 < x2 < ... < $x_N$ ≤ $10_15$

1 ≤ $s_i$ ≤ $10_9$

所有输入数据皆为整数.

## 样例 #1

### 输入

```
5

10 20

40 50

60 30

70 40

90 10
```

### 输出

```
90
```

## 样例 #2

### 输入

```
5

10 2

40 5

60 3

70 4

90 1
```

### 输出

```
5
```

## 样例 #3

### 输入

```
4

1 100

3 200

999999999999999 150

1000000000000000 150
```

### 输出

```
299
```



---

---
title: "何通りの分割方法がある？"
layout: "post"
diff: 普及/提高-
pid: AT_s8pc_2_c
tag: []
---

# 何通りの分割方法がある？

## 题目描述

[problemUrl]: https://atcoder.jp/contests/s8pc-2/tasks/s8pc_2_c

$ square1001 $の部分文字列である「$ 1001 $」は、各位の数字の和が$ 1+0+0+1=2 $と非常に少なく、

しかも「1001」を分割しても{$ 1,0,01 $}や{$ 1,001 $}のようにすると和がそれぞれ$ 1+0+1=2,1+1=2 $と非常に少なくなります。

$ 1001 $はとても不思議な数です。それについて、彼は考えてみることにしました。

整数$ n $を分割するとき、その和が$ D $以下にならなければなりません。

ここでいう「分割」の定義は以下のようになります。

- 整数$ N $を文字列と考えられる。これを$ S $と置く。
- $ S $をいくつかのパーツに分ける。
- 例えば「$ "1234567" $」だと{$ "1","234567" $}や{$ "12","34","56","7" $}や{$ "1234567" $}など、というように分けることができる。
- 分けたパーツをそれぞれ数字としてとらえるようにする。
- 例えば、"1234"は$ 1234 $という数字ととらえることができる。
- ただし、各パーツは$ 0 $から始まってもよい。

例えば、「1355」を和が50以下になるように分割する方法は、以下の$ 3 $通りがあります。

 分割方法合計1+3+5+51413+5+5231+35+541何通りの分け方があるか数え上げましょう。$ 1,000,000,007 $で割った余りを求めなさい。

- 問題文中の例と同じである。

- 以下の5通りの条件を満たす分け方がある。

分割方法合計2+4+3+91824+3+9362+4+39452+43+95424+3963

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ D $

- $ 1 $ 行目には、分割されるもののもととなる整数 $ N $ が与えられる。
- $ 2 $ 行目には、数の合計の上限 $ D $が与えられる。

## 输出格式

出力は以下の形式で標準出力に従うこと。

- 分割の通り数を$ 1,000,000,007 $で割った余りを $ 1 $ 行で出力せよ。

## 说明/提示

### 制約

- $ 1≦N≦{10}^{100} $
- $ 1≦D≦100,000 $

### 小課題

小課題 $ 1 $ \[ $ 10 $ 点 \]

- 解は全て$ 1 $通り以下である。

小課題 $ 2 $ \[ $ 30 $ 点 \]

- $ 1≦N≦10,000,000,000 $を満たす。

小課題 $ 3 $ \[ $ 60 $ 点 \]

- 追加の制約はない。

## 样例 #1

### 输入

```
1355

50
```

### 输出

```
3
```

## 样例 #2

### 输入

```
2439

100
```

### 输出

```
5
```

## 样例 #3

### 输入

```
1225

20
```

### 输出

```
2
```

## 样例 #4

### 输入

```
123456

10000
```

### 输出

```
29
```



---

---
title: "Emblem"
layout: "post"
diff: 普及/提高-
pid: AT_s8pc_5_b
tag: []
---

# Emblem

## 题目描述

在一个坐标平面上有 $N$ 个给定的圆心和半径的圆，和 $M$ 个给定圆心但不给定半径的圆，请问如何设置这 $M$ 个圆的半径，使得这些圆中没有两两相交或内含的两个圆。求出所有方法中，半径最小的圆的半径的最大值。

## 输入格式

第 $1$ 行，两个整数 $N,M$ 用空格隔开。

第 $2\sim N+1$ 行，每行三个整数 $x_i,y_i,r_i$ 表示给定圆的圆心坐标和半径。（$i=1,2,\cdots,N$）

第 $N+2\sim N+M+1$ 行，每行两个整数 $x_i,y_i$ 表示没给定半径的圆的圆心坐标。（$i=N+1,N+2,\cdots,N+M$）

## 输出格式

一个浮点数表示答案，误差不超过 $10^{-6}$ 可以判为正确。

### 样例解释

**对于样例 #1：**

将这两个圆的半径设置为 $\dfrac{\sqrt{17}}{2}$ 满足题意，使得最小的圆的半径最大。

![](https://img.atcoder.jp/s8pc-5/9428c9380834bcaccb9efc3fd8004a8c.png)

**对于样例 #2：**

![](https://img.atcoder.jp/s8pc-5/ffba20c8caa71e91f1a68bc0436797b7.png)

**对于样例 #3：**

没有没给定半径的圆，则半径最小的圆一定是给定圆中半径最小的，最小值一定为 $2$。

**对于样例 #4：**

可以设置半径为 $3\sqrt{5}-5$。

![](https://img.atcoder.jp/s8pc-5/4b66f305d185ab848356d4d62e951182.png)

## 说明/提示

- $N,M\in[0,100]$。
- $N+M\ge 2$。
- $x_i,y_i\in[-100,100]$。（$1\le i\le N+M$）
- $r_i\in[1,100]$。（$1\le i\le N$）
- $\forall i,j\in[1,N+M]$ 且 $i\neq j$ 满足 $(x_i,y_i)\neq(x_j,y_j)$。
- $\forall i,j\in[1,N]$ 且 $i\neq j$ 满足第 $i$ 个圆与第 $j$ 个圆不相交或内含。
- $\forall i\in[1,N],j\in[N+1,M]$ 满足 $(x_j,y_j)$ 不在第 $i$ 个圆上。

## 样例 #1

### 输入

```
0 2

6 3

2 4
```

### 输出

```
2.061552812808830
```

## 样例 #2

### 输入

```
0 5

8 6

9 1

2 0

1 0

0 1
```

### 输出

```
0.500000000000000
```

## 样例 #3

### 输入

```
3 0

5 2 3

-1 0 2

2 -6 4
```

### 输出

```
2.000000000000000
```

## 样例 #4

### 输入

```
1 1

0 0 5

6 -3
```

### 输出

```
1.708203932499369
```



---

---
title: "Lucky PIN"
layout: "post"
diff: 普及/提高-
pid: AT_sumitb2019_d
tag: []
---

# Lucky PIN

## 题目描述

[problemUrl]: https://atcoder.jp/contests/sumitrust2019/tasks/sumitb2019_d

AtCoder 社は、オフィスの入り口に $ 3 $ 桁の暗証番号を設定することにしました。

AtCoder 社には $ N $ 桁のラッキーナンバー $ S $ があります。社長の高橋君は、$ S $ から $ N-3 $ 桁を消して残りの $ 3 $ 桁を左から読んだものを暗証番号として設定することにしました。

このとき、設定されうる暗証番号は何種類あるでしょうか？

ただし、ラッキーナンバーや暗証番号はいずれも $ 0 $ から始まっても良いものとします。

## 输入格式

入力は以下の形式で標準入力から与えられます。

> $ N $ $ S $

## 输出格式

設定されうる暗証番号の種類数を出力してください。

## 说明/提示

### 制約

- $ 4\ \leq\ N\ \leq\ 30000 $
- $ S $ は半角数字からなる長さ $ N $ の文字列

### Sample Explanation 1

高橋君には以下の選択肢があります。 - $ S $ の $ 1 $ 桁目を消し、暗証番号を `224` とする。 - $ S $ の $ 2 $ 桁目を消し、暗証番号を `024` とする。 - $ S $ の $ 3 $ 桁目を消し、暗証番号を `024` とする。 - $ S $ の $ 4 $ 桁目を消し、暗証番号を `022` とする。 よって、設定されうる暗証番号は `022`, `024`, `224` の $ 3 $ 種類です。

## 样例 #1

### 输入

```
4

0224
```

### 输出

```
3
```

## 样例 #2

### 输入

```
6

123123
```

### 输出

```
17
```

## 样例 #3

### 输入

```
19

3141592653589793238
```

### 输出

```
329
```



---

---
title: "Colorful Hats 2"
layout: "post"
diff: 普及/提高-
pid: AT_sumitb2019_e
tag: []
---

# Colorful Hats 2

## 题目描述

[problemUrl]: https://atcoder.jp/contests/sumitrust2019/tasks/sumitb2019_e

$ N $ 人の人が一列に並んでおり、前から順に $ 1,\ 2,\ 3,\ ...,\ N $ と番号が付けられています。それぞれの人は、赤色・青色・緑色のいずれかの帽子を被っています。

さて、番号 $ i $ の人は以下の発言をしました。

- 「自分より前に、自分と同じ色の帽子を被っている人はちょうど $ A_i $ 人いる。」

すべての人の発言が正しいとして、$ N $ 人の人の帽子の色の組合せとして考えられるものが何通りあるか求めてください。

ただし、答えがとても大きくなる場合があるので、代わりに $ 1000000007 $ で割った余りを計算してください。

## 输入格式

入力は以下の形式で標準入力から与えられます。

> $ N $ $ A_1 $ $ A_2 $ $ A_3 $ $ ... $ $ A_N $

## 输出格式

$ N $ 人の帽子の色の組合せとして考えられるものの個数を $ 1000000007 $ で割った余りを出力してください。

## 说明/提示

### 制約

- $ 1\ \leq\ N\ \leq\ 100000 $
- $ 0\ \leq\ A_i\ \leq\ N-1 $
- 入力中の値はすべて整数

### Sample Explanation 1

以下の $ 3 $ 通りの組合せが考えられます。 - 赤, 赤, 赤, 赤, 赤, 赤 - 青, 青, 青, 青, 青, 青 - 緑, 緑, 緑, 緑, 緑, 緑

## 样例 #1

### 输入

```
6

0 1 2 3 4 5
```

### 输出

```
3
```

## 样例 #2

### 输入

```
3

0 0 0
```

### 输出

```
6
```

## 样例 #3

### 输入

```
54

0 0 1 0 1 2 1 2 3 2 3 3 4 4 5 4 6 5 7 8 5 6 6 7 7 8 8 9 9 10 10 11 9 12 10 13 14 11 11 12 12 13 13 14 14 15 15 15 16 16 16 17 17 17
```

### 输出

```
115295190
```



---

---
title: "ロイヤルストレートフラッシュ"
layout: "post"
diff: 普及/提高-
pid: AT_tenka1_2012_10
tag: []
---

# ロイヤルストレートフラッシュ

## 题目描述

### 题目大意



有一副牌，花色是 $S,H,D,C$ 共4种，点数是 $A,2,3,4,5,6,7,8,9,10,J,Q,K$ 共13种。



任务是凑成一副同花顺 $10,J,Q,K,A$，注意必须同花且必须是 $10,J,Q,K,A$ 这5张牌。

## 输入格式

一行字符串，表示牌堆中的牌。

## 输出格式

一行字符串，表示你在摸到的最后一张凑成同花顺的牌之前舍弃的牌。如果前5张就可以凑成同花顺，请输出一个‘0’（不含引号）。



注意换行。



---

---
title: "camel_case"
layout: "post"
diff: 普及/提高-
pid: AT_tenka1_2012_6
tag: []
---

# camel_case

## 题目描述

在编程中，我们常用到两种字符串格式：「驼峰命名法」和「下划线分隔」。它们的定义如下：

- **单词**：一个以小写字母开头的字符串，由小写字母和数字构成。
- **驼峰命名法字符串**：由一个或多个单词连接而成，除了第一个单词外，其他单词首字母需大写。
- **下划线分隔字符串**：由一个或多个单词通过下划线连接形成。

这些字符串可能会在头尾被加上多余的下划线。

给定一个字符串，若它符合驼峰命名法或下划线分隔格式，要求将其互相转换，否则直接输出原字符串。同时，若某个字符串既符合驼峰命名法又符合下划线分隔，保证无论哪种解释方式，转换结果都是一致的。

输入格式如下：
> $ c_1c_2…c_N $

- 输入为一行字符串。
- 字符串长度 $ N $ 满足 $ 1 \leq N \leq 50 $。
- 字符 $ c_i $ 可以是大写字母（`A` 到 `Z`）、小写字母（`a` 到 `z`）、数字（`0` 到 `9`）或下划线（`_`）。

请将输入的字符串进行转换，结果以一行形式输出，并保证以换行符结尾。

## 输入格式

输入包含一行字符串。

## 输出格式

输出转换后的字符串结果，并在行末附加换行符。

## 说明/提示

字符串长度 $ N $ 满足 $ 1 \leq N \leq 50 $。

 **本翻译由 AI 自动生成**

## 样例 #1

### 输入

```
lower_camel_case
```

### 输出

```
lowerCamelCase
```

## 样例 #2

### 输入

```
_snakeCase_
```

### 输出

```
_snake_case_
```

## 样例 #3

### 输入

```
KLab
```

### 输出

```
KLab
```

## 样例 #4

### 输入

```
_
```

### 输出

```
_
```

## 样例 #5

### 输入

```
a_bc_9a_b
```

### 输出

```
a_bc_9a_b
```



---

---
title: "ぶんたん"
layout: "post"
diff: 普及/提高-
pid: AT_tenka1_2012_final_a
tag: []
---

# ぶんたん

## 题目描述

[problemUrl]: https://atcoder.jp/contests/tenka1-2012-final/tasks/tenka1_2012_final_a

 フィボナッチ数列は、以下のような漸化式で表される数列 $ F_0,\ F_1,\ F_2,\ …\ (=0,\ 1,\ 1,\ 2,\ 3,\ 5,\ 8,\ 13,\ …) $ であり、フィボナッチ数はこの数列に現れる数 $ F_i\ (i\ \geq\ 0) $ です。

- $ F_{0}\ =\ 0 $
- $ F_{1}\ =\ 1 $
- $ F_{i+2}\ =\ F_{i}\ +\ F_{i+1} $ ($ i\ \geq\ 0 $)

 ある正整数 $ n $ をいくつかのフィボナッチ数の和として表すことを考えます。  
 このとき、和が正整数 $ n $ となるフィボナッチ数の個数として考えられる最小の値を答えなさい。  
 ただし、同じフィボナッチ数を複数回用いることもできるものとし、複数回用いた場合はそれぞれ別々に数えるものとします。

 入力は以下の形式で標準入力から与えられる。 > $ n $

- 正整数 $ n $ ($ 1\ \leq\ n\ \leq\ 10^{10} $) が $ 1 $ 行で与えられる。
 
 与えられる数が小さい入力 ($ 1\ \leq\ N\ \leq\ 10^5 $) のみ正解すると、$ 100 $ 点満点に対して部分点として $ 50 $ 点が与えられる。 和が正整数 $ n $ となるフィボナッチ数の個数として考えられる最小の値を $ 1 $ 行で出力せよ。  
 なお、行の終端には改行が必要である。



---

---
title: "エターナルスタティックファイナル"
layout: "post"
diff: 普及/提高-
pid: AT_tenka1_2014_qualB_b
tag: []
---

# エターナルスタティックファイナル

## 题目描述

## 题意
小A通过组合他所学的短语来吟唱咒语。

同一个短语可以在诵读咒语的过程中使用多次。

例如，如果你记住了 $aaa$、$bbb$ 和 $ccc$ 三个短语，你就可以念出 $aaaccc$、$aaabbb$ 和 $cccaaaaaa$ 这样的咒语。

小A不确定他是否能够通过组合他所记住的短语来吟唱他所要学习的新咒语。

为小A创建一个程序，计算有多少种短语的排列组合可以构建他所要学习的新咒语。

变化的数量可能很大，所以输出对 $10^9+7$ 取模后的结果。

## 输入格式

在第一行中，给出小A已经记住的短语的数量 $N$（$1 \le N \le 100$）。

在第二行，给出小A想记住的咒语 $S$。

$S$ 的长度，$|S|$，满足 $1 \le |S| \le 1000$ 且 $S$ 由小写字母组成。

第 $3$ 至第 $N$ 行给出了智明已经记住的短语 $T_i$。

$T_i$ 的长度，$|T_i|$，满足 $1 \le |T_i| \le 1000$ 且 $T_i$ 由小写字母组成。

PS：如果 $i \neq j$，则 $Ti \neq Tj$。

## 输出格式

用这 $n$ 个短语构成的 $S$ 的方案数，对 $10^9+7$ 取模

## 样例 #1

### 输入

```
3

eternalstaticfinal

eternal

static

final
```

### 输出

```
1
```

## 样例 #2

### 输入

```
5

eternalstaticfinal

eternal

static

final

fin

al
```

### 输出

```
2
```

## 样例 #3

### 输入

```
5

abcdef

abc

def

abcdef

d

ef
```

### 输出

```
3
```

## 样例 #4

### 输入

```
5

aaaa

a

aa

aaa

aaaa

b
```

### 输出

```
8
```

## 样例 #5

### 输入

```
10

aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa

a

aa

aaa

aaaa

aaaaa

aaaaaa

aaaaaaa

aaaaaaaa

aaaaaaaaa

aaaaaaaaaa
```

### 输出

```
146491918
```



---

---
title: "天下一リテラル"
layout: "post"
diff: 普及/提高-
pid: AT_tenka1_2015_qualB_b
tag: []
---

# 天下一リテラル

## 题目描述

一种脚本语言 hnw 有 $3$ 种类型，分别是整数（integer）、字典（dict）和非空集合（set）。其组成如下：
```
dict={expr:expr{,expr:expr}}或{}；
set={expr{,expr}}；
expr=dict或set或integer。
（内层大括号内的元素为可继续添加的元素的类型）
```
现在输入一段脚本，请判断它是字典型脚本还是非空集合型脚本？

## 输入格式

一行一个字符串 $s$，即输入的脚本，其必为字典型或非空集合型。输入不含空格。

## 输出格式

输出一行一个字符串，表示输入的脚本的类型。如果是字典型请输出`dict`，是非空集合型请输出`set`。**输出完毕请换行。**

## 说明/提示

**数据规模与约定**

所有输入数据保证：

- $s$ 的长度不大于 $50000$；

## 样例 #1

### 输入

```
{1:2}
```

### 输出

```
dict
```

## 样例 #2

### 输入

```
{1,2}
```

### 输出

```
set
```

## 样例 #3

### 输入

```
{}
```

### 输出

```
dict
```



---

---
title: "PackDrop"
layout: "post"
diff: 普及/提高-
pid: AT_tenka1_2016_qualA_b
tag: []
---

# PackDrop

## 题目描述

# PackDrop


[问题链接](https://atcoder.jp/contests/tenka1-2016-quala/tasks/tenka1_2016_qualA_b)

山本同学发明了一种名为 PackDrop 的设备，它有 $0.01$ 的概率丢弃数据包，用于在通信环境不佳的网络中验证应用程序的运行。

山本同学需要在由 $N$ 台设备组成的网络中安装一些 PackDrop，以满足以下条件。并且，他希望使用的 PackDrop 的数量最少。

这个网络中的每个设备都有一个从 $0$ 到 $N-1$ 的编号。

除设备 $0$ 外，每个设备都有一个父设备，设备 $i$ 的父设备是设备 $P_i$。设备 $P_i$ 被称为设备 $i$ 的子设备。

直接具有父子关系的设备可以直接连接，或者通过串联几个 PackDrop 来连接。

当父设备和子设备之间有 $n$ 个 PackDrop 时，从父设备到子设备的数据包到达率为 $0.99^n$。换句话说，直接连接时，数据包到达率为 $1$。

设设备 $x$ 到设备 $y$ 的数据包到达率为 $p$，设备 $y$ 到设备 $z$ 的数据包到达率为 $q$，则设备 $x$ 到设备 $z$ 的数据包到达率为 $p × q$。

除了 PackDrop 丢弃数据包外，没有其他因素会影响数据包的到达率。

没有子设备的设备共有 $M$ 台，它们的编号为 $B_0, B_1, \ldots, B_{M-1}$。对于每个 $i$ ($0 \leq i \leq N-1$)，当希望设备 $0$ 到设备 $B_i$ 的到达率为 $0.99^{C_i}$ 时，求出最少需要的 PackDrop 数量。

## 输入格式

输入的格式如下所示：

> $N\ M\ P_1 : P_{N-1}\ B_0\ C_0 : B_{M-1}\ C_{M-1}$

## 输出格式

输出最少的 PackDrop 数量。

## 说明/提示

### 约束条件

- $2 \leq N \leq 1000$
- $1 \leq M \leq N - 1$
- $0 \leq P_i \leq i - 1$
- $1 \leq B_i \leq N - 1$
- $1 \leq C_i \leq 100000$
- 如果 $i \neq j$，则 $B_i \neq B_j$。
- 存在 $i, j$ 使得 $P_i = B_j$。
- 整数 $k$ ($1 \leq k \leq N - 1$) 如果不在 $P_1, P_2, \ldots, P_{N-1}$ 中，则它一定在 $B_0, B_1, \ldots, B_{M-1}$ 中。
- $N, M, P_i, B_i, C_i$ 均为整数。

## 样例 #1

### 输入

```
3 2
0
0
1 5
2 10
```

### 输出

```
15
```

## 样例 #2

### 输入

```
5 3
0
1
0
1
2 5
3 3
4 7
```

### 输出

```
10
```

## 样例 #3

### 输入

```
7 4
0
0
2
2
3
3
1 3
4 2
5 8
6 6
```

### 输出

```
11
```



---

---
title: "山田山本問題"
layout: "post"
diff: 普及/提高-
pid: AT_tenka1_2016_qualA_c
tag: []
---

# 山田山本問題

## 题目描述

[problemUrl]: https://atcoder.jp/contests/tenka1-2016-quala/tasks/tenka1_2016_qualA_c

天下一株式会社に勤務するワタナベくんは、社内のコミュニケーションにチャットツールを使っています。 チャットツールには補完機能があり、@で始まるアカウント名を入力しようとすると、プレフィックスの一致するアカウント名の一覧を辞書順で補完候補として表示してくれます。

ところが、ワタナベくんは補完候補の中から @yamamoto を選ぼうとした時に、間違って @yamada を選択してしまうことが多々あります。 @yamada は @yamamoto より辞書順で小さく、 `@yama` まで入力した際に、候補の先頭に表示されてしまうためです。

ワタナベくんは不思議な特技を持っていて、アルファベットの順番を自由に並べ替えることができます。 例えば、ワタナベくんが特技を使ってアルファベットの順番を abcefghijklmdnopqrstuvwxyz にすると、 `m` は `d` より小さくなり、 @yamamoto を @yamada より辞書順で小さくすることができます。

アカウント名 $ A_i $ をアカウント名 $ B_i $ より辞書順で小さくしたいという要求が $ N $ 個与えられます。 与えられた要求をすべて満たすような、ワタナベくんの特技によって並べ替えられたアルファベットの順番を求めてください。 条件を満たすようなアルファベットの順番が複数存在する場合は、並べ替えられる前のアルファベットの順番での辞書順最小の順番を求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ A_1 $ $ B_1 $ $ A_2 $ $ B_2 $ : $ A_N $ $ B_N $

## 输出格式

条件を満たすようなアルファベットの順番のうち、辞書順最小のものを1行に出力せよ。  
そのようなアルファベットの順番が存在しない場合は、-1を出力せよ。

## 说明/提示

### 制約

- $ 1\ \leq\ N\ \leq\ 1000 $
- $ A_i\ \neq\ B_i $
- $ 1\ \leq\ |A_i|,\ |B_i|\ \leq\ 1000 $
- $ A_i,B_i $は英小文字で構成される

## 样例 #1

### 输入

```
1
yamamoto yamada
```

### 输出

```
abcefghijklmdnopqrstuvwxyz
```

## 样例 #2

### 输入

```
3
xx xy
z w
v w
```

### 输出

```
abcdefghijklmnopqrstuvxyzw
```

## 样例 #3

### 输入

```
2
a b
b a
```

### 输出

```
-1
```

## 样例 #4

### 输入

```
1
yamamoto yama
```

### 输出

```
-1
```



---

---
title: "天下一魔力発電"
layout: "post"
diff: 普及/提高-
pid: AT_tenka1_2016_qualB_b
tag: []
---

# 天下一魔力発電

## 题目描述

## 题目翻译：天下一魔力发电

天下一魔力发电厂能够通过神奇的魔法生成电力。

用于魔力发电的燃料是一串由字符 `(` 和 `)` 组成的字符串 $S$，并且字符串的长度是偶数。

当我们将字符串 $S$ 转换成“匹配的括号字符串”时，魔力发电就会成功。

所谓的“匹配的括号字符串”满足以下条件：

- `()` 是一个匹配的括号字符串。
- 如果 $T$ 是一个匹配的括号字符串，那么 `(T)` 也是一个匹配的括号字符串。
- 如果 $T$ 和 $U$ 都是匹配的括号字符串，那么 $TU$ 也是匹配的括号字符串。

天下一魔力发电厂的文本处理器提供了四种操作方式：

1. 将光标向右移动（如果光标已经指向最后一个字符，则无法继续右移）。
2. 将光标向左移动（如果光标已经指向第一个字符，则无法继续左移）。
3. 如果光标指向的字符是 `(`，可以将其改为 `)`。
4. 如果光标指向的字符是 `)`，可以将其改为 `(`。

例如，给定字符串 $S$ 为：

```
())(()))
```

通过适当的第 1 和第 4 种操作，可以将其转换为：

```
(()(()))
```

这时，字符串变成了一个匹配的括号字符串。

作为发电厂的负责人，Fude-kun 想要通过最少的操作次数将字符串 $S$ 转换为匹配的括号字符串。

请你计算出将字符串 $S$ 转换为匹配的括号字符串所需的最少操作次数。

## 输入格式

输入包含一个字符串 $S$。

## 输出格式

输出将字符串 $S$ 转换为匹配的括号字符串所需的最少操作次数，最后需要换行符。

## 样例 #1

### 输入 #1

```
())(()))
```

### 输出 #1

```
2
```

## 样例 #2

### 输入 #2

```
((((
```

### 输出 #2

```
5
```

## 样例 #3

### 输入 #3

```
)))(((
```

### 输出 #3

```
9
```

## 说明/提示

- 字符串 $S$ 的长度 $|S|$ 是偶数。
- $2 \leq |S| \leq 100$

## 样例 #1

### 输入

```
())(()))
```

### 输出

```
2
```

## 样例 #2

### 输入

```
((((
```

### 输出

```
5
```

## 样例 #3

### 输入

```
)))(((
```

### 输出

```
9
```



---

---
title: "4/N"
layout: "post"
diff: 普及/提高-
pid: AT_tenka1_2017_c
tag: []
---

# 4/N

## 题目描述

[problemUrl]: https://atcoder.jp/contests/tenka1-2017/tasks/tenka1_2017_c

整数 $ N $ が与えられる。

$ 4/N\ =\ 1/h\ +\ 1/n\ +\ 1/w $ を満たす正整数 $ h,\ n,\ w $ を求めよ。

条件を満たす解が複数ある場合、どれを出力しても良い。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $

## 输出格式

条件を満たす正整数 $ h,\ n,\ w $ の組を空白区切りで１つ出力せよ。

 ```
h n w
```

## 说明/提示

### 制約

- $ N $ に対して $ h,\ n,\ w\ \leq\ 3500 $ となる解が存在することが保証される。

### Sample Explanation 1

$ 4/2\ =\ 1/1\ +\ 1/2\ +\ 1/2 $である。

## 样例 #1

### 输入

```
2
```

### 输出

```
1 2 2
```

## 样例 #2

### 输入

```
3485
```

### 输出

```
872 1012974 1539173474040
```

## 样例 #3

### 输入

```
4664
```

### 输出

```
3498 3498 3498
```



---

---
title: "Align"
layout: "post"
diff: 普及/提高-
pid: AT_tenka1_2018_c
tag: []
---

# Align

## 题目描述

[problemUrl]: https://atcoder.jp/contests/tenka1-2018/tasks/tenka1_2018_c

整数が $ N $ 個与えられます。$ i $ 個目の整数は $ A_i $ です。 これらを好きな順に一列に並べるとき、隣り合う要素の差の合計の最大値を求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ A_1 $ $ : $ $ A_N $

## 输出格式

与えられた整数たちを好きな順に一列に並べるとき、隣り合う要素の差の合計の最大値を出力せよ。

## 说明/提示

### 制約

- $ 2\ \leq\ N\ \leq\ 10^5 $
- $ 1\ \leq\ A_i\ \leq\ 10^9 $
- 入力はすべて整数である

### Sample Explanation 1

$ 3,8,1,6,2 $ の順に並べたとき、隣り合う要素の差の合計は $ 21 $ になり、 これが達成できる最大の値です。

## 样例 #1

### 输入

```
5

6

8

1

2

3
```

### 输出

```
21
```

## 样例 #2

### 输入

```
6

3

1

4

1

5

9
```

### 输出

```
25
```

## 样例 #3

### 输入

```
3

5

5

1
```

### 输出

```
8
```



---

---
title: "Stones"
layout: "post"
diff: 普及/提高-
pid: AT_tenka1_2019_c
tag: []
---

# Stones

## 题目描述

[problemUrl]: https://atcoder.jp/contests/tenka1-2019/tasks/tenka1_2019_c

$ N $ 個の石が一列に並んでおり、すべての石は白か黒で塗られています。 石の状態は長さ $ N $ の文字列 $ S $ で表され、$ S $ の $ i $ 文字目が `.` のとき左から $ i $ 個目の石が白であり、`#` のとき左から $ i $ 個目の石が黒であることを表します。

高橋君は、$ 0 $ 個以上の石の色を黒または白に変更し、黒い石のすぐ右に白い石があるような箇所がないようにしたいです。 色を変更する必要のある石の個数の最小値を求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ S $

## 输出格式

色を変更する必要のある石の個数の最小値を出力せよ。

## 说明/提示

### 制約

- $ 1\ \leq\ N\ \leq\ 2\times\ 10^5 $
- $ S $ は `.`, `#` のみからなる長さ $ N $ の文字列である

### Sample Explanation 1

例えば、$ 1 $ 個目の石の色を白に変更すればよいです。

## 样例 #1

### 输入

```
3

#.#
```

### 输出

```
1
```

## 样例 #2

### 输入

```
5

#.##.
```

### 输出

```
2
```

## 样例 #3

### 输入

```
9

.........
```

### 输出

```
0
```



---

---
title: "超大型連休"
layout: "post"
diff: 普及/提高-
pid: AT_test001_d
tag: []
---

# 超大型連休

## 题目描述

[problemUrl]: https://atcoder.jp/contests/language-test-ver1/tasks/test001_d

$ 2011 $ 年、$ AtCoder $ 国の高橋首相はある重大な決定を行った。  
 その決定とは...法改正である。国民の祝日に関する法律を変更し、休日を増やすことにした!!  
 国民の創造性を尊重するその決定が、霞が関を魔境へと変えたッ！  
  
 あなたは霞が関の国土交通省に勤務する職員であり、この法改正により上司から新たな任務を与えられた。  
 その任務とは、$ 2012 $ 年の「連休の最大日数」を計算することである。  
 連休の大きさを事前に計算することで国民の行動を予想し、高速道路の部分的な値下げを行い、経済を活性させるためだ。  
 したがって、あなたに失敗することは許されない。国民の行動を正確に予想できなくなるからだ。  
  
 以下に、「連休」の定義と諸注意を記す。

1. $ AtCoder $ 国が使用する暦は[グレゴリオ暦](http://ja.wikipedia.org/wiki/%E3%82%B0%E3%83%AC%E3%82%B4%E3%83%AA%E3%82%AA%E6%9A%A6)に従う。
2. 「連休」とは、「休日」が連続して続くことである。
3. 「土曜日」「日曜日」「祝日」「振替休日」が「休日」に相当する。
4. 「祝日」が他の休日と同じ日に指定されていた場合、「振替休日」を必ず設置する。
5. 「振替休日」は祝日の時系列順に決定していき、その祝日以降最も近い平日（休日を除いた日）となる。
6. $ 2012 $ 年 $ 1 $ 月 $ 1 $ 日は日曜日である。
 
 入力は以下の形式で標準入力から与えられる。 > $ N $ $ m_{1} $/$ d_{1} $ $ m_{2} $/$ d_{2} $ $ : $ $ : $ $ m_{n} $/$ d_{n} $

- $ 1 $ 行目には祝日の日数を表す整数 $ N $ が与えられ、 $ 0≦N≦366 $ を満たす。
- $ 2 $ 行目から $ N+1 $ 行目までの $ N $ 行で祝日の日付が与えられる。

1. $ m_{i} $ は $ i(1≦i≦366) $ 番目に与えられる祝日の月で、 $ 1≦m_{i}≦12 $ を満たす。
2. $ d_{i} $ は $ i(1≦i≦366) $ 番目に与えられる祝日の日で、
1. $ m_{i}\ =\ 2 $ のとき、 $ 1≦d_{i}≦29 $ を満たす。
2. $ m_{i}\ =\ (4,\ 6,\ 9,\ 11) $ のとき、 $ 1≦d_{i}≦30 $ を満たす。
3. $ m_{i}\ =\ (1,\ 3,\ 5,\ 7,\ 8,\ 10,\ 12) $ のとき、 $ 1≦d_{i}≦31 $ を満たす。

4. $ m_{i} $ と $ d_{i} $ はともに整数である。
5. $ m_{i} $ と $ d_{i} $ は必ず`/`で区切られて与えられる。
6. 祝日は時系列順に与えられるとは限らないことに注意せよ。ただし、同じ日付が複数与えられないことは保証されている。
 
 法改正後における $ 2012 $ 年の連休の最大日数を出力せよ。  
 出力は標準出力におこない、末尾には改行をいれること。  
```

1
1/9
```

 ```

3
```

- 1/7(土),1/8(日),1/9(月)の $ 3 $ 連休が最長です。
 
```

1
1/10
```

 ```

2
```

- 1/10(火)が祝日となり、1/7(土),1/8(日)などの $ 2 $ 連休が最長です。
 
```

1
1/7
```

 ```

3
```

- 1/7は土曜日なので、以降で最も近い平日である1/9が振替休日になります。
- よって、1/7(土)、1/8(日)、1/9(月)の3連休が最長です。
 
```

2
1/7
1/9
```

 ```

4
```

- 1/7は土曜日なので振替休日を以降に設定したく、1/9が祝日なので1/10が振替休日になります。
- よって、1/7(土)、1/8(日)、1/9(月)、1/10(火)の4連休が最長です。



---

---
title: "Lamps"
layout: "post"
diff: 普及/提高-
pid: AT_tokiomarine2020_c
tag: []
---

# Lamps

## 题目描述

# Lamps


[problemUrl]: https://atcoder.jp/contests/tokiomarine2020/tasks/tokiomarine2020_c

给定 $ N $ 个灯泡，其亮度分别为 $ A_i $。每个灯泡的作用范围为 $ i-A_i-0.5$ 到 $ i+A_i+0.5 $。

有 $ K $ 轮操作。

每轮操作使得每个灯泡的亮度更改为照亮它的灯泡的个数。

## 输入格式

> $ N $ 
> $ K $ 
> $ A_i $

## 输出格式

输出更改后的 $ A_i $ 

> $ A{'}_1 $ $ A{'}_2 $ $ \ldots $ $ A{'}_N $

## 样例 #1

### 样例输入 #1

```
5 1
1 0 0 1 0
```

### 样例输出 #1

```
1 2 2 1 2
```

## 样例 #2

### 样例输入 #2

```
5 2
1 0 0 1 0
```

### 样例输出 #2

```
3 3 4 4 3
```

## 说明/提示

- $ 1\ \leqq\ N\ \leqq\ 2\ \times\ 10^5 $
- $ 1\ \leqq\ K\ \leqq\ 2\ \times\ 10^5 $
- $ 0\ \leqq\ A_i\ \leqq\ N $

### 样例1解释 

$ 1 $ 号数只有第 $ 1 $ 个数本身作用 ，第 $ 2 $ 个数有第 $ 1 $ 和 第 $ 2 $ 个数作用，以此类推。

## 样例 #1

### 输入

```
5 1

1 0 0 1 0
```

### 输出

```
1 2 2 1 2
```

## 样例 #2

### 输入

```
5 2

1 0 0 1 0
```

### 输出

```
3 3 4 4 3
```



---

---
title: "一変数方程式"
layout: "post"
diff: 普及/提高-
pid: AT_tricky_2
tag: []
---

# 一変数方程式

## 题目描述

求解关于 $x$ 的方程 $ax^2 + bx + c=0$ 所有实数解。

## 输入格式

包含 $T$ 组数据。

对于每组数据，包含三个整数 $a,b,c$ ，使用半角符号进行分割。

## 输出格式

一行一组数据。
 
对于每组数据，输出解的数量后从小到大输出解，解的数量与解使用空格隔开。

若无解输出 `0` ，若有三个及以上的解只需输出 `3` ，与标准答案相差小于 $10^{-9}$ 次方即视为正确。

## 说明/提示

$0 \le T \le 2\times 10^5 , -2^{31} \le a,b,c < 2^{31}$

Translated By @Ferm_Tawn



---

---
title: "titech分離"
layout: "post"
diff: 普及/提高-
pid: AT_ttpc2015_g
tag: []
---

# titech分離

## 题目描述

[problemUrl]: https://atcoder.jp/contests/ttpc2015/tasks/ttpc2015_g

英小文字(a-z)からなる文字列$ S $が与えられる。

$ S $をいくつかの(連続とは限らない)部分文字列に分解する。 つまり、$ S $の各文字がちょうど1つの部分文字列に含まれるように、$ S $から複数の部分文字列を選ぶ。

分解した結果の部分文字列が全て`titech`になるような分解方法があるかどうか判定せよ。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ S $

- $ 1 $ 行目に文字列$ S(1\ ≦\ |\ S\ |\ ≦\ 100) $が与えられる。

## 输出格式

分解が可能なら`Yes`、不可能なら`No`を出力せよ。 出力の末尾に改行を入れること。

## 说明/提示

### Sample Explanation 1

1つの`titech`に分解できる。

### Sample Explanation 2

例えば、1,2,5,6,7,8文字目と3,4,9,10,11,12文字目に分解すれば2つの`titech`に分解できる。

### Sample Explanation 4

3つの`titech`に分解できる。

## 样例 #1

### 输入

```
titech
```

### 输出

```
Yes
```

## 样例 #2

### 输入

```
tititechtech
```

### 输出

```
Yes
```

## 样例 #3

### 输入

```
titecg
```

### 输出

```
No
```

## 样例 #4

### 输入

```
tttiiittteeeccchhh
```

### 输出

```
Yes
```



---

---
title: "Union Find"
layout: "post"
diff: 普及/提高-
pid: AT_unionfind_a
tag: []
---

# Union Find

## 题目描述

[problemUrl]: https://atcoder.jp/contests/atc001/tasks/unionfind_a

この問題は、講座用問題です。ページ下部に解説が掲載されています。

$ N $ 頂点の、単純とは限らない無向グラフを考えます。 初期状態では、頂点のみが存在し、辺は全く存在せず、全ての頂点が孤立しているとします。 以下の $ 2 $ 種類のクエリが、$ Q $ 回与えられます。

- 連結クエリ： 頂点 $ A $ と、頂点 $ B $ を繋ぐ辺を追加します。
- 判定クエリ： 頂点 $ A $ と、頂点 $ B $ が、連結であるかどうか判定します。連結であれば `Yes`、そうでなければ `No` を出力します。

クエリを順番に処理し、判定クエリへの回答を出力して下さい。 この際、同じ辺が何度も追加されることや、自分自身への辺が追加されることもある事に注意してください。

連結であるとは、頂点 $ A $ から頂点 $ B $ まで辺をたどって到達可能であることを意味します。 $ A $ と $ B $ が同じ頂点の場合、連結であると定義します。 グラフは無向であるため、連結クエリによって頂点 $ A,\ B $ 間の辺が追加されると、$ A $ から $ B $ へも $ B $ から $ A $ へも辿れるようになります。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ Q $ $ P_1 $ $ A_1 $ $ B_1 $ $ P_2 $ $ A_2 $ $ B_2 $ : $ P_Q $ $ A_Q $ $ B_Q $

- $ 1 $ 行目には、頂点の個数を表す整数 $ N\ (1≦N≦100,000) $ と、クエリの個数を表す整数 $ Q\ (1\ ≦\ Q\ ≦\ 200,000) $ が、スペース区切りで与えられる。
- $ 2 $ 行目からの $ Q $ 行のうち $ i $ 行目には、$ i $ 番目のクエリの種類を表す整数 $ P_i\ (0\ ≦\ P_i\ ≦\ 1) $ と、クエリの対象となる頂点の番号を表す整数 $ A_i,\ B_i\ (0\ ≦\ A_i,\ B_i\ ≦\ N\ -\ 1) $ が、 スペース区切りで与えられる。 
  - $ P_i\ =\ 0 $ の時、そのクエリが連結クエリであることを表す。
  - $ P_i\ =\ 1 $ の時、そのクエリが判定クエリであることを表す。

## 输出格式

各判定クエリに対し、出力をおこなって下さい。 毎回の出力の後に改行を行うこと。

## 说明/提示

### 解説

  **[Union find(素集合データ構造)](https://www.slideshare.net/secret/CIWAduFPvzGrrE "Union find(素集合データ構造)")**  from **[AtCoder Inc.](http://www.slideshare.net/chokudai)** 

### Sample Explanation 1

以下のような手順で実行されます。 - $ 1 $ つ目のクエリで、頂点 $ 1 $ と頂点 $ 2 $ を繋ぎます。 - $ 2 $ つ目のクエリで、頂点 $ 3 $ と頂点 $ 2 $ を繋ぎます。 - $ 3 $ つ目のクエリで、頂点 $ 1 $ と頂点 $ 3 $ の連結判定を行います。連結しているので、`Yes`と出力します。 - $ 4 $ つ目のクエリで、頂点 $ 1 $ と頂点 $ 4 $ の連結判定を行います。連結していないので、`No`と出力します。 - $ 5 $ つ目のクエリで、頂点 $ 2 $ と頂点 $ 4 $ を繋ぎます。 - $ 6 $ つ目のクエリで、頂点 $ 4 $ と頂点 $ 1 $ の連結判定を行います。連結しているで、`Yes`と出力します。 - $ 7 $ つ目のクエリで、頂点 $ 4 $ と頂点 $ 2 $ を繋ぎます。これらは既に繋がれていますが、多重辺が出来ることもあります。 - $ 8 $ つ目のクエリで、頂点 $ 0 $ と頂点 $ 0 $ を繋ぎます。これらは同じ頂点ですが、自己ループが出来ることもあります。 - $ 9 $ つ目のクエリで、頂点 $ 0 $ と頂点 $ 0 $ の連結判定を行います。同じ頂点は常に連結していると見做せるので、`Yes`と出力します。

## 样例 #1

### 输入

```
8 9

0 1 2

0 3 2

1 1 3

1 1 4

0 2 4

1 4 1

0 4 2

0 0 0

1 0 0
```

### 输出

```
Yes

No

Yes

Yes
```



---

---
title: "Row of Tents"
layout: "post"
diff: 普及/提高-
pid: AT_utpc2020_a
tag: []
---

# Row of Tents

## 题目描述

[problemUrl]: https://atcoder.jp/contests/utpc2020/tasks/utpc2020_a

 UT 大学にはテント列というサークル紹介イベントがあります。長さ $ L $ の道があり、 umg くんは位置 $ 0 $ から位置 $ L $ まで一方通行で歩きます。 umg くんには気力というパラメータがあり、その初期値を $ T $ とします。ここで、$ T $ は整数値とします。 umg くんは、距離 $ 1 $ 歩くごとに、気力が $ T $ 未満である場合は 気力が $ 1 $ 回復します。気力が $ T $ である場合は回復しません。

道上には $ N $ 個のテントがあり、$ i $ 番目のテントは位置 $ X_i $ にあります。 umg くんは $ i $ 番目のテントに着くとサークル勧誘にあい、気力が $ A_i $ 減少します。もしここで気力が $ 0 $ 未満になると、 umg くんはその場で倒れてしまいます。

 umg くんが途中で倒れずに位置 $ L $ までたどり着くのに必要な、気力の初期値 $ T $ の最小値を求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ L $ $ X_1 $ $ A_1 $ $ X_2 $ $ A_2 $ $ \vdots $ $ X_N $ $ A_N $

## 输出格式

答えを $ 1 $ 行に出力せよ。

## 说明/提示

### 制約

- 入力は全て整数である。
- $ 1\ \leq\ N\ \leq\ 2\times\ 10^5 $
- $ N\ \lt\ L\ \leq\ 10^9 $
- $ 0\lt\ X_1\ \lt\ X_2\ \lt\ \cdots\ \lt\ X_N\ \lt\ L $
- $ 1\ \leq\ A_i\ \leq\ 10^9\ (1\leq\ i\ \leq\ N) $

### Sample Explanation 1

気力の初期値 $ T=6 $ でスタートした場合は以下のような気力の変動になります。 - $ 1 $ 番目のテントにたどり着いて気力が $ 5 $ 減少し、気力が $ 1 $ になる。 - $ 2 $ 番目のテントにたどり着くまでに気力が $ 3 $ 回復し、気力が $ 4 $ になる。 - $ 2 $ 番目のテントにたどり着いて気力が $ 4 $ 減少し、気力が $ 0 $ になる。 - 位置 $ 7 $ にたどり着くまでに気力が $ 3 $ 回復し、気力 $ 3 $ の状態でテント列を終える。 気力の初期値 $ T=5 $ でスタートすると、$ 2 $ 番目のテントで気力が $ 0 $ 未満になってしまうので、答えは $ 6 $ となります。

## 样例 #1

### 输入

```
2 7

1 5

4 4
```

### 输出

```
6
```

## 样例 #2

### 输入

```
8 11

2 6

3 10

4 8

5 7

7 7

8 1

9 9

10 2
```

### 输出

```
42
```



---

---
title: "自宅からの脱出"
layout: "post"
diff: 普及/提高-
pid: AT_wupc2012_3
tag: []
---

# 自宅からの脱出

## 题目描述

一张地图用一些字符串来描述。地图上的位置代表对应的平面坐标。

上端表示北方。西北角为坐标 $(1,1)$，东南角为坐标 $(M,N)$。坐标 $(x,y)$ 表示第 $y$ 行的第 $x$ 个字符。

- `.` 空地
- `C` 笔记本电脑
- `S` 出发地
- `G` 门

你可以在 $1$ 个单位时间内从当前位置，移动到 $(x+1,y),(x,y+1),(x-1,y),(x,y-1)$ 中的任意一个。

特别的，还有一些不能移动到的要求：

- 不能移动到墙壁（`#`）所在的地方。

- 移动到计算机所在地之后立刻拿上电脑，不用考虑此动作所花的时间。

- 到达家的门口时，如果此时没有拿上笔记本电脑，那么什么也不会发生。

请求出拿上电脑并到达门口的所花的最短时间。

![](https://cdn.luogu.org/upload/pic/23163.png)

## 输入格式

第一行两个以空格隔开的正整数 $n$ 和 $m$，代表房间的大小为 $n$ 行 $m$ 列。

第二行至第 $n+1$ 行，每行一个字符串，为房间的平面图。

## 输出格式

输出拿上电脑并到达门口的所花的最短时间。

如果不能达到目标，则输出 `-1`。

## 说明/提示

对于 $100\%$ 的数据，$5\le n\le 500$，$5\le m\le 500$。

保证数据中墙壁围成了一个封闭图形。 

保证每行的首字符与末字符都为 `#`。

翻译 by @[159号程序员](https://www.luogu.com.cn/user/334586)



---

---
title: "最後の問題"
layout: "post"
diff: 普及/提高-
pid: AT_wupc2012_6
tag: []
---

# 最後の問題

## 题目描述

[problemUrl]: https://atcoder.jp/contests/wupc2012/tasks/wupc2012_6

 いよいよコンテスト当日，僕は早稲田大学・西早稲田キャンパスに到着した．しかも，到達時間は4でも7でも割り切れる数字であった．とても縁起がいい．今ならどんな問題だって解ける気がする．  
 会場の教室には既に数十名の学生が集まっていた．運営チームがジャッジシステム，AtCoderの説明を終え，もうあと数分でコンテストが始まろうとしているところだった．僕は持ってきたノートブック型計算機を広げ，高鳴る心臓を抑えつつコンテストに備える．  
  
 *(それでは，始めてください！)*  
  
 そして，コンテストが始まった．  
  
 挑戦はどんな結果だったのか，そして，コンテストを通じて僕は何を得たのだろうか… しかし，これはまた別の話．機会があれば語ることにしよう．ところで，このコンテストに出題された最後の問題は，次のようなものであった．  
 二次元の座標平面上に格子点が $ N $ 個与えられる．それらの点の中から $ 4 $ 点を選んで長方形を作る時，その最大面積を求めるプログラムを作成せよ．ただし，長方形は以下の条件を満たす必要がある．

- 長方形の各辺は $ x $ 軸または $ y $ 軸と並行になっていなければならない．
- 長方形の内部(辺は含まない)に他の点を含んではならない．
 
 長方形を構成する4点以外の点が辺の上にある時は，内部にはないと考えるものとする．また，条件を満たす長方形が一つも作れない時は，$ 0 $ を出力してほしい．  
 入力は以下の形式で標準入力から与えられる． > $ N $ $ x_{1}　y_{1} $ $ x_{2}　y_{2} $ $ ... $ $ x_{i}　y_{i} $ $ ... $ $ x_{N}　y_{N} $

- $ 1 $ 行目に点の数を表す $ N $($ 4\ ≦\ N\ ≦\ 10000 $)が与えられる．
- $ 2 $ 行目〜$ N+1 $行目にはそれぞれの点の $ x $ 座標と $ y $ 座標が半角スペース区切りで与えられる．
- 各 $ i $ について $ 0\ ≦\ x_{i}\ ≦\ 999 $ かつ $ 0\ ≦\ y_{i}\ ≦\ 999 $ を満たす．
- $ N $ 点の座標はすべて異なる．
 
 与えられた点を使って条件を満たすような長方形を作る時，その最大面積を一行に出力せよ．もし，条件を満たす長方形が一つも作れない場合は，$ 0 $ を出力せよ．  
 なお，最後には改行を出力せよ． 100点満点中，10点分については，$ N\ ≦\ 100 $ を満たす．  
 また，別の20点分については，$ N\ ≦\ 1000 $ を満たす．



---

---
title: "String Problem"
layout: "post"
diff: 普及/提高-
pid: AT_xmascon17_e
tag: []
---

# String Problem

## 题目描述

[problemUrl]: https://atcoder.jp/contests/xmascon17/tasks/xmascon17_e

$ 2 $ つの文字列 $ S,\ T $ が与えられます。 以下のような操作を好きな順番で好きなだけ行うことで $ S $ を $ T $ にできるかどうかを判定してください。

- 操作 $ A $：$ S $ に含まれる文字 `A` を $ 1 $ つ削除する。
- 操作 $ B $：$ S $ の好きな位置に文字 `B` を $ 1 $ つ挿入する。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ S $ $ T $

## 输出格式

可能な場合は `YES` を、不可能な場合は `NO` を出力せよ。

## 说明/提示

### 制約

- $ 1\ \leq\ |S|,\ |T|\ \leq\ 1000 $
- $ S,\ T $ は大文字アルファベットのみからなる

### 部分点

- $ |S|\ \leq\ 10 $ を満たすデータセットに正解した場合は、$ 50 $ 点が与えられる。
- 追加制約のないデータセットに正解した場合は、上記とは別に $ 50 $ 点が与えられる。

### Sample Explanation 1

例えば `XMAS` → `XBMAS` → `XBMS` のように操作すれば良いです。

### Sample Explanation 2

例えば `AABABA` → `ABABA` → `BABABA` → `BABABAB` → `BABBABAB` のように操作すれば良いです。

## 样例 #1

### 输入

```
XMAS

XBMS
```

### 输出

```
YES
```

## 样例 #2

### 输入

```
AABABA

BABBABAB
```

### 输出

```
YES
```

## 样例 #3

### 输入

```
AB

AA
```

### 输出

```
NO
```

## 样例 #4

### 输入

```
ATCODER

CONTEST
```

### 输出

```
NO
```



---

---
title: "宇宙人からのメッセージ"
layout: "post"
diff: 普及/提高-
pid: AT_zone2021_d
tag: []
---

# 宇宙人からのメッセージ

## 题目描述

给出密文 $S$，解读方法如下：

- 设 $T$ 为空字符串；
- $i=1,2,...,|S|$ 以下按顺序进（$|S|$ 表示 $S$ 的长度）；
    - 当 $S$ 的第 $i$ 字母是 $R$ 时，将 $T$ 反转；
   - 当 $S$ 的第 $i$ 个字母不是 $R$ 时，在 $T$ 的末尾加上该字母。
- 然后，如果 $T$ 中连续出现了两个相同的字母，就去掉这两个字母。尽可能地继续这个操作(可以证明最终得到的字符串不会取决于去除的顺序)。

请输出通过以上操作得到的字符串 $T$。

## 输入格式

共一行，一个字符串 $S$。

## 输出格式

共一行，一个字符串 $T$。

## 说明/提示

- 字符串 $S$ 由英文小写字母和R组成；
- $1 \le |S| \le 5 × 10^5 $。

### 样例 1 解释

- 最初，$T$ 是空字符串。
- 在 $T$ 的末尾加上 `o`，$T$ 变成了 `o`。
- 在 $T$ 的末尾加上 `z`，$T$ 变成了 `oz`。
- $T$ 反转，$T$ 变成了 `zo`。
- 在 $T$ 的末尾加上 `n`，$T$ 变成了 `zon`。
- 在 $T$ 的末尾加上 `o`，$T$ 变成了 `zono`。
- 在 $T$ 的末尾加上 `n`，$T$ 变成了 `zonon`。
- 在 $T$ 的末尾加上 `n`，$T$ 变成了 `zononn`。
- 在 $T$ 的末尾加上 `o`，$T$ 变成了 `zononno`。
- 在 $T$ 的末尾加上 `e`，$T$ 变成了 `zononnoe`。
- 删除连续排列的 `n`，$T$ 变成了 `zonooe`。
- 删除连续排列的 `o`，$T$ 变成了 `zone`。

### 样例 2 解释
空串有时也会成为答案。

## 样例 #1

### 输入

```
ozRnonnoe
```

### 输出

```
zone
```

## 样例 #2

### 输入

```
hellospaceRhellospace
```

### 输出

```

```



---


---
title: "[ABC035C] オセロ"
layout: "post"
diff: 普及/提高-
pid: AT_abc035_c
tag: ['线段树', '树状数组', '前缀和', '差分']
---

# [ABC035C] オセロ

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc035/tasks/abc035_c

黒の面に`0`、白の面に`1`が書かれた $ N $ 個のオセロの駒が、どの駒も黒の面が上を向くように一列に並べられています。その後、ある区間にある駒を全て裏返すという操作が $ Q $ 回だけ行なわれました。 具体的には $ i $ 回目の操作においては、左から $ l_i $ 番目の駒から $ r_i $ 番目の駒までの駒全てが裏返されました。

最終的な盤面を求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ Q $ $ l_1 $ $ r_1 $ . . . $ l_Q $ $ r_Q $

- $ 1 $ 行目に駒の数と操作回数を表す $ 2 $ つの整数 $ N,Q\ (1≦N,Q≦200,000) $ が空白区切りで与えられる。
- $ 2 $ 行目から続く $ Q $ 行のうち $ i $ 行目においては、 $ i $ 回目の操作の範囲を表す $ 2 $ つの整数 $ l_i,\ r_i\ (1≦l_i≦r_i≦N) $ が空白区切りで与えられる。

## 输出格式

最終的な盤面を表す文字列 $ S $ を $ 1 $ 行に出力せよ。 $ S $ の左から $ i $ 文字目は左から $ i $ 番目の駒の上向きの面に書かれた数字となる。改行を忘れないこと。

## 说明/提示

### 部分点

この問題には部分点が設定されている。

- $ 1≦N,Q≦2,000 $ を満たすデータセットに正解した場合、 $ 60 $ 点が与えられる。
- 追加制約のないデータセットに正解した場合は、追加で $ 40 $ 点が与えられ、合計 $ 100 $ 点が得られる。

### Sample Explanation 1

\- 盤面ははじめ`00000`です。 - $ 1 $ 回目の操作により、 盤面は`11110`となります。 - $ 2 $ 回目の操作により、 盤面は`10001`となります。 - $ 3 $ 回目の操作により、 盤面は`10101`となります。 - $ 4 $ 回目の操作により、 盤面は`01010`となります。 - 最終的な盤面である`01010`が求める答えです。 - このケースは部分点の追加制約を満たします。

### Sample Explanation 2

\- このケースは部分点の追加制約を満たします。

## 样例 #1

### 输入

```
5 4

1 4

2 5

3 3

1 5
```

### 输出

```
01010
```

## 样例 #2

### 输入

```
20 8

1 8

4 13

8 8

3 18

5 20

19 20

2 7

4 9
```

### 输出

```
10110000011110000000
```



---

---
title: "[ABC037C] 総和"
layout: "post"
diff: 普及/提高-
pid: AT_abc037_c
tag: ['模拟', '枚举', '前缀和']
---

# [ABC037C] 総和

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc037/tasks/abc037_c

長さ $ N $ の数列 $ \{a_i\} $ と$ 1 $ 以上 $ N $ 以下の整数 $ K $ が与えられます。 この数列には長さ $ K $ の連続する部分列が $ N-K+1 $ 個あります。これらのそれぞれ部分列に含まれる値の合計の総和を求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ K $ $ a_1 $ .. $ a_N $

## 输出格式

部分列に含まれる値の合計 $ N-K+1 $ 個の総和を出力せよ。

## 说明/提示

### 制約

- $ 1\ \leq\ K\ \leq\ N\ \leq\ 10^5 $
- $ 0\ \leq\ a_i\ \leq\ 10^8 $
- $ a_i $ は整数である。

### 部分点

- 50 点分のテストケースでは、 $ N\ \leq\ 10^3 $ である。

### Sample Explanation 1

$ (1+2+4)+(2+4+8)+(4+8+16)=49 $ なので、答えは $ 49 $ です。

### Sample Explanation 2

オーバーフローに注意してください。

## 样例 #1

### 输入

```
5 3

1 2 4 8 16
```

### 输出

```
49
```

## 样例 #2

### 输入

```
20 10

100000000 100000000 98667799 100000000 100000000 100000000 100000000 99986657 100000000 100000000 100000000 100000000 100000000 98995577 100000000 100000000 99999876 100000000 100000000 99999999
```

### 输出

```
10988865195
```



---

---
title: "[ABC105D] Candy Distribution"
layout: "post"
diff: 普及/提高-
pid: AT_abc105_d
tag: ['前缀和']
---

# [ABC105D] Candy Distribution

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc105/tasks/abc105_d

$ N $ 個の箱が左右一列に並んでおり、左から $ i $ 番目の箱には $ A_i $ 個のお菓子が入っています。

あなたは、連続したいくつかの箱からお菓子を取り出して $ M $ 人の子供たちに均等に配りたいと考えています。

そこで、以下を満たす組 $ (l,\ r) $ の総数を求めてください。

- $ l,\ r $ はともに整数であり $ 1\ \leq\ l\ \leq\ r\ \leq\ N $ を満たす
- $ A_l\ +\ A_{l+1}\ +\ ...\ +\ A_r $ は $ M $ の倍数である

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ M $ $ A_1 $ $ A_2 $ $ ... $ $ A_N $

## 输出格式

条件を満たす組 $ (l,\ r) $ の総数を出力せよ。

出力の際には、出力が $ 32 $ ビットの整数型に収まらない可能性があることに注意せよ。

## 说明/提示

### 制約

- 入力は全て整数である
- $ 1\ \leq\ N\ \leq\ 10^5 $
- $ 2\ \leq\ M\ \leq\ 10^9 $
- $ 1\ \leq\ A_i\ \leq\ 10^9 $

### Sample Explanation 1

各組 $ (l,\ r) $ に対する和 $ A_l\ +\ A_{l+1}\ +\ ...\ +\ A_r $ は次のとおりであり、このうち $ 3 $ つが $ 2 $ の倍数です。 - $ (1,\ 1) $ に対する和: $ 4 $ - $ (1,\ 2) $ に対する和: $ 5 $ - $ (1,\ 3) $ に対する和: $ 10 $ - $ (2,\ 2) $ に対する和: $ 1 $ - $ (2,\ 3) $ に対する和: $ 6 $ - $ (3,\ 3) $ に対する和: $ 5 $

## 样例 #1

### 输入

```
3 2

4 1 5
```

### 输出

```
3
```

## 样例 #2

### 输入

```
13 17

29 7 5 7 9 51 7 13 8 55 42 9 81
```

### 输出

```
6
```

## 样例 #3

### 输入

```
10 400000000

1000000000 1000000000 1000000000 1000000000 1000000000 1000000000 1000000000 1000000000 1000000000 1000000000
```

### 输出

```
25
```



---

---
title: "[ABC253E] Distance Sequence"
layout: "post"
diff: 普及/提高-
pid: AT_abc253_e
tag: ['动态规划 DP', '前缀和']
---

# [ABC253E] Distance Sequence

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc253/tasks/abc253_e

長さ $ N $ の整数からなる数列 $ A=(A_1,\ldots,A_N) $ であって、以下の条件を全て満たすものは何通りありますか？

- $ 1\le\ A_i\ \le\ M $ $ (1\ \le\ i\ \le\ N) $
- $ |A_i\ -\ A_{i+1}|\ \geq\ K $ $ (1\ \le\ i\ \le\ N\ -\ 1) $

ただし、答えは非常に大きくなることがあるので、答えを $ 998244353 $ で割った余りを求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ M $ $ K $

## 输出格式

答えを $ 998244353 $ で割った余りを出力せよ。

## 说明/提示

### 制約

- $ 2\ \leq\ N\ \leq\ 1000 $
- $ 1\ \leq\ M\ \leq\ 5000 $
- $ 0\ \leq\ K\ \leq\ M-1 $
- 入力は全て整数

### Sample Explanation 1

条件を満たす数列は以下の $ 6 $ つです。 - $ (1,2) $ - $ (1,3) $ - $ (2,1) $ - $ (2,3) $ - $ (3,1) $ - $ (3,2) $

### Sample Explanation 2

条件を満たす数列は以下の $ 2 $ つです。 - $ (1,3,1) $ - $ (3,1,3) $

### Sample Explanation 3

答えを $ 998244353 $ で割った余りを出力してください。

## 样例 #1

### 输入

```
2 3 1
```

### 输出

```
6
```

## 样例 #2

### 输入

```
3 3 2
```

### 输出

```
2
```

## 样例 #3

### 输入

```
100 1000 500
```

### 输出

```
657064711
```



---

---
title: "[ABC308E] MEX"
layout: "post"
diff: 普及/提高-
pid: AT_abc308_e
tag: ['枚举', '前缀和']
---

# [ABC308E] MEX

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc308/tasks/abc308_e

$ 0,1,2 $ からなる長さ $ N $ の数列 $ A=(A_1,A_2,\dots,A_N) $ と、 `M`, `E`, `X` からなる長さ $ N $ の文字列 $ S=S_1S_2\dots\ S_N $ が与えられます。

$ 1\ \leq\ i\ <\ j\ <\ k\ \leq\ N $ かつ $ S_iS_jS_k= $ `MEX` を満たす全ての整数の組 $ (i,j,k) $ に対する $ \text{mex}(A_i,A_j,A_k) $ の総和を求めてください。 ここで、$ \text{mex}(A_i,A_j,A_k) $ は $ A_i,A_j,A_k $ のいずれとも一致しない最小の非負整数を意味します。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ A_1 $ $ A_2 $ $ \dots $ $ A_N $ $ S $

## 输出格式

答えを整数として出力せよ。

## 说明/提示

### 制約

- $ 3\leq\ N\ \leq\ 2\times\ 10^5 $
- $ N $ は整数
- $ A_i\ \in\ \lbrace\ 0,1,2\rbrace $
- $ S $ は `M`, `E`, `X` からなる長さ $ N $ の文字列
 
### Sample Explanation 1

$ S_iS_jS_k $ = `MEX` となる $ i,j,k\ (1\ \leq\ i\ <\ j\ <\ k\ \leq\ N) $ の組は $ (i,j,k)=(1,2,4),(1,3,4) $ の $ 2 $ つです。 $ \text{mex}(A_1,A_2,A_4)=\text{mex}(1,1,2)=0,\text{mex}(A_1,A_3,A_4)=\text{mex}(1,0,2)=3 $ より答えは $ 0+3=3 $ です。

## 样例 #1

### 输入

```
4

1 1 0 2

MEEX
```

### 输出

```
3
```

## 样例 #2

### 输入

```
3

0 0 0

XXX
```

### 输出

```
0
```

## 样例 #3

### 输入

```
15

1 1 2 0 0 2 0 2 0 0 0 0 0 2 2

EXMMXXXEMEXEXMM
```

### 输出

```
13
```



---

---
title: "[ABC338D] Island Tour"
layout: "post"
diff: 普及/提高-
pid: AT_abc338_d
tag: ['前缀和']
---

# [ABC338D] Island Tour

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc338/tasks/abc338_d

AtCoder 諸島は $ N $ 個の島からなり、これらの島々は $ N $ 本の橋によって結ばれています。 島には $ 1 $ から $ N $ までの番号が付けられていて、$ i\ (1\leq\ i\leq\ N-1) $ 本目の橋は島 $ i $ と島 $ i+1 $ を、$ N $ 本目の橋は島 $ N $ と島 $ 1 $ を双方向に結んでいます。 橋を渡る以外に島の間を行き来する方法は存在しません。

AtCoder 諸島では、島 $ X_1 $ から始めて島 $ X_2,X_3,\dots,X_M $ を順に訪れる**ツアー**が定期的に催行されています。 移動の過程で訪れる島とは別の島を経由することもあり、ツアー中に橋を通る回数の合計がツアーの**長さ**と定義されます。

厳密には、**ツアー**とは以下の条件を全て満たす $ l+1 $ 個の島の列 $ a_0,a_1,\dots,a_l $ のことであり、その**長さ** は $ l $ として定義されます。

- 全ての $ j\ (0\leq\ j\leq\ l-1) $ について、島 $ a_j $ と島 $ a_{j+1} $ は橋で直接結ばれている
- ある $ 0\ ＝\ y_1\ <\ y_2\ <\ \dots\ <\ y_M\ =\ l $ が存在して、全ての $ k\ (1\leq\ k\leq\ M) $ について $ a_{y_k}\ =\ X_k $

財政難に苦しむ AtCoder 諸島では、維持費削減のため橋を $ 1 $ 本封鎖することになりました。 封鎖する橋をうまく選んだとき、ツアーの長さの最小値がいくつになるか求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ M $ $ X_1 $ $ X_2 $ $ \dots $ $ X_M $

## 输出格式

答えを整数として出力せよ。

## 说明/提示

### 制約

- $ 3\leq\ N\ \leq\ 2\times\ 10^5 $
- $ 2\leq\ M\ \leq\ 2\times\ 10^5 $
- $ 1\leq\ X_k\leq\ N $
- $ X_k\neq\ X_{k+1}\ (1\leq\ k\leq\ M-1) $
- 入力は全て整数

### Sample Explanation 1

\- $ 1 $ 本目の橋を封鎖した場合：通る島の列として $ (a_0,a_1,a_2)=(1,3,2) $ を取ることで島 $ 1,3,2 $ を順に訪れることができ、長さ $ 2 $ のツアーが催行できます。これより短いツアーは存在しません。 - $ 2 $ 本目の橋を封鎖した場合：通る島の列として $ (a_0,a_1,a_2,a_3)=(1,3,1,2) $ を取ることで島 $ 1,3,2 $ を順に訪れることができ、長さ $ 3 $ のツアーが催行できます。これより短いツアーは存在しません。 - $ 3 $ 本目の橋を封鎖した場合：通る島の列として $ (a_0,a_1,a_2,a_3)=(1,2,3,2) $ を取ることで島 $ 1,3,2 $ を順に訪れることができ、長さ $ 3 $ のツアーが催行できます。これより短いツアーは存在しません。 よって、封鎖する橋をうまく選んだときのツアーの長さの最小値は $ 2 $ です。 以下の図は左から順に橋 $ 1,2,3 $ を封鎖した場合を表し、数字の書かれた丸が島、丸同士を結ぶ線が橋、青い矢印が最短のツアーの経路を表します。 !\[\](https://img.atcoder.jp/abc338/ad4a27665d9da939ab495acd3d05181a.png)

### Sample Explanation 2

$ X_1,X_2,\dots,X_M $ の中に同じ島が複数回現れることもあります。

## 样例 #1

### 输入

```
3 3
1 3 2
```

### 输出

```
2
```

## 样例 #2

### 输入

```
4 5
2 4 2 4 2
```

### 输出

```
8
```

## 样例 #3

### 输入

```
163054 10
62874 19143 77750 111403 29327 56303 6659 18896 64175 26369
```

### 输出

```
390009
```



---

---
title: "[ABC347E] Set Add Query"
layout: "post"
diff: 普及/提高-
pid: AT_abc347_e
tag: ['前缀和']
---

# [ABC347E] Set Add Query

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc347/tasks/abc347_e

全ての要素が $ 0 $ で初期化された長さ $ N $ の整数列 $ A=(A_1,A_2,\ldots,A_N) $ があります。また、集合 $ S $ があります。はじめ $ S $ は空です。

以下の $ Q $ 個のクエリを順に行います。$ Q $ 個のクエリを全て処理した後の数列 $ A $ の各要素の値を求めてください。 $ i $ 番目のクエリは以下の形式です。

- 整数 $ x_i $ が与えられる。整数 $ x_i $ が $ S $ に含まれる場合、$ S $ から $ x_i $ を削除する。そうでない場合、$ S $ に $ x_i $ を追加する。次に、$ j=1,2,\ldots,N $ について、$ j\in\ S $ ならば $ A_j $ に $ |S| $ を加算する。

なお、$ |S| $ は集合 $ S $ の要素数を意味します。例えば $ S=\lbrace\ 3,4,7\rbrace $ のとき、$ |S|=3 $ です。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ Q $ $ x_1 $ $ x_2 $ $ \ldots $ $ x_Q $

## 输出格式

クエリを全て処理した後の数列 $ A $ を以下の形式で出力せよ。

> $ A_1 $ $ A_2 $ $ \ldots $ $ A_N $

## 说明/提示

### 制約

- $ 1\leq\ N,Q\leq\ 2\times10^5 $
- $ 1\leq\ x_i\leq\ N $
- 入力される数値は全て整数

### Sample Explanation 1

$ 1 $ 番目のクエリでは、$ S $ に $ 1 $ を追加し、$ S=\lbrace\ 1\rbrace $ となります。その後、$ A_1 $ に $ |S|=1 $ を加算します。$ A=(1,0,0) $ となります。 $ 2 $ 番目のクエリでは、$ S $ に $ 3 $ を追加し、$ S=\lbrace\ 1,3\rbrace $ となります。その後、$ A_1,A_3 $ に $ |S|=2 $ を加算します。$ A=(3,0,2) $ となります。 $ 3 $ 番目のクエリでは、$ S $ から $ 3 $ を削除し、$ S=\lbrace\ 1\rbrace $ となります。その後、$ A_1 $ に $ |S|=1 $ を加算します。$ A=(4,0,2) $ となります。 $ 4 $ 番目のクエリでは、$ S $ に $ 2 $ を追加し、$ S=\lbrace\ 1,2\rbrace $ となります。その後、$ A_1,A_2 $ に $ |S|=2 $ を加算します。$ A=(6,2,2) $ となります。 最終的に、$ A=(6,2,2) $ となります。

## 样例 #1

### 输入

```
3 4
1 3 3 2
```

### 输出

```
6 2 2
```

## 样例 #2

### 输入

```
4 6
1 2 3 2 4 2
```

### 输出

```
15 9 12 7
```



---

---
title: "[ABC353D] Another Sigma Problem"
layout: "post"
diff: 普及/提高-
pid: AT_abc353_d
tag: ['数学', '前缀和']
---

# [ABC353D] Another Sigma Problem

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc353/tasks/abc353_d

正整数 $ x,y $ に対して $ f(x,y) $ を以下で定義します。

- 十進表記の $ x,y $ をそれぞれ文字列として解釈しこの順に連結して得られる文字列を $ z $ とする。$ z $ を十進表記の整数として解釈したときの値を $ f(x,y) $ とする。
 
例えば $ f(3,14)=314,\ f(100,1)=1001 $ です。

長さ $ N $ の正整数列 $ A=(A_1,\ldots,A_N) $ が与えられます。次の式の値を $ 998244353 $ で割ったあまりを求めてください。

$ \displaystyle\ \sum_{i=1}^{N-1}\sum_{j=i+1}^N\ f(A_i,A_j) $

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ A_1 $ $ \ldots $ $ A_N $

## 输出格式

答えを出力せよ。

## 说明/提示

### 制約

- $ 2\leq\ N\leq\ 2\times\ 10^5 $
- $ 1\leq\ A_i\ \leq\ 10^9 $
- 入力される数値は全て整数
 
### Sample Explanation 1

\- $ f(A_1,A_2)=314 $ - $ f(A_1,A_3)=315 $ - $ f(A_2,A_3)=1415 $ なので、答えは $ f(A_1,A_2)+f(A_1,A_3)+f(A_2,A_3)\ =\ 2044 $ です。

### Sample Explanation 2

式の値を $ 998244353 $ で割ったあまりを求めることに注意してください。

## 样例 #1

### 输入

```
3

3 14 15
```

### 输出

```
2044
```

## 样例 #2

### 输入

```
5

1001 5 1000000 1000000000 100000
```

### 输出

```
625549048
```



---

---
title: "[ABC366D] Cuboid Sum Query"
layout: "post"
diff: 普及/提高-
pid: AT_abc366_d
tag: ['前缀和']
---

# [ABC366D] Cuboid Sum Query

## 题目描述

给定一个正整数 $N$ 和满足 $1 \leq x, y, z \leq N$ 的整数组 $(x, y, z)$，对于每个组合都有一个整数 $A_{x, y, z}$。

现在给出 $Q$ 个查询，每个查询要求如下：

对于第 $i$ 个查询 $ (1 \leq i \leq Q) $，给出一组整数 $ (Lx_i, Rx_i, Ly_i, Ry_i, Lz_i, Rz_i) $，其中 $1 \leq Lx_i \leq Rx_i \leq N,\ 1 \leq Ly_i \leq Ry_i \leq N, 1 \leq Lz_i \leq Rz_i \leq N$。要求计算并输出以下求和结果：

$$
\sum_{x=Lx_i}^{Rx_i}\ \sum_{y=Ly_i}^{Ry_i}\ \sum_{z=Lz_i}^{Rz_i}\ A_{x,y,z}
$$

## 输入格式

输入以以下形式从标准输入提供。

> $N$ $A_{1,1,1}$ $A_{1,1,2}$ $\ldots$ $A_{1,1,N}$ $A_{1,2,1}$ $A_{1,2,2}$ $\ldots$ $A_{1,2,N}$ $\vdots$ $A_{1,N,1}$ $A_{1,N,2}$ $\ldots$ $A_{1,N,N}$ $A_{2,1,1}$ $A_{2,1,2}$ $\ldots$ $A_{2,1,N}$ $A_{2,2,1}$ $A_{2,2,2}$ $\ldots$ $A_{2,2,N}$ $\vdots$ $A_{2,N,1}$ $A_{2,N,2}$ $\ldots$ $A_{2,N,N}$ $\vdots$ $A_{N,1,1}$ $A_{N,1,2}$ $\ldots$ $A_{N,1,N}$ $A_{N,2,1}$ $A_{N,2,2}$ $\ldots$ $A_{N,2,N}$ $\vdots$ $A_{N,N,1}$ $A_{N,N,2}$ $\ldots$ $A_{N,N,N}$ $Q$ $Lx_1$ $Rx_1$ $Ly_1$ $Ry_1$ $Lz_1$ $Rz_1$ $Lx_2$ $Rx_2$ $Ly_2$ $Ry_2$ $Lz_2$ $Rz_2$ $\vdots$ $Lx_Q$ $Rx_Q$ $Ly_Q$ $Ry_Q$ $Lz_Q$ $Rz_Q$

## 输出格式

输出 $Q$ 行，每行对应一个查询的结果，第 $i$ 行输出第 $i$ 个查询的答案。

## 说明/提示

### 约束条件

- $1 \leq N \leq 100$
- $1 \leq Q \leq 2 \times 10^{5}$
- $0 \leq A_{x,y,z} \leq 999\ (1 \leq x, y, z \leq N)$
- $1 \leq Lx_i \leq Rx_i \leq N$ $ (1 \leq i \leq Q) $
- $1 \leq Ly_i \leq Ry_i \leq N$ $ (1 \leq i \leq Q) $
- $1 \leq Lz_i \leq Rz_i \leq N$ $ (1 \leq i \leq Q) $
- 所有输入均为整数

### 样例解释 1

对于第 $1$ 个查询，需要求和的值为 $A_{1,2,1} + A_{2,2,1} = 3 + 7 = 10$，因此输出 $10$。对于第 $2$ 个查询，需要求和的值为 $A_{2,1,1} + A_{2,1,2} + A_{2,2,1} + A_{2,2,2} = 5 + 6 + 7 + 8 = 26$，因此输出 $26$。

## 样例 #1

### 输入

```
2

1 2

3 4

5 6

7 8

2

1 2 2 2 1 1

2 2 1 2 1 2
```

### 输出

```
10

26
```

## 样例 #2

### 输入

```
3

733 857 714

956 208 257

123 719 648

840 881 245

245 112 746

306 942 694

58 870 849

13 208 789

687 906 783

8

3 3 3 3 1 1

1 3 2 3 3 3

2 2 2 3 1 1

1 3 1 1 1 1

2 3 2 3 2 3

1 2 1 1 1 2

3 3 2 2 1 3

1 2 2 3 2 3
```

### 输出

```
687

3917

551

1631

5180

3311

1010

4326
```



---

---
title: "[ABC367D] Pedometer"
layout: "post"
diff: 普及/提高-
pid: AT_abc367_d
tag: ['数论', '前缀和']
---

# [ABC367D] Pedometer

## 题目描述

一个湖泊周围有 $N$ 个休憩所。这些休憩所按顺时针方向被标记为 $1, 2, \ldots, N$。从休憩所 $i$ 到休憩所 $i+1$（其中休憩所 $N+1$ 指的是休憩所 $1$）顺时针行走需要 $A_i$ 步。已知从某个休憩所 $s$ 到另一个不同的休憩所 $t$ 顺时针行走的最短步数是 $M$ 的倍数。我们需要计算所有可能的 $(s,t)$ 组合的数量。

## 输入格式

输入数据以以下格式从标准输入给出：

> $N$ $M$ $A_1$ $A_2$ $\ldots$ $A_N$

## 输出格式

输出答案作为一个整数。

## 说明/提示

#### 制约条件

- 所有输入数据都是整数。
- $2 \le N \le 2 \times 10^5$
- $1 \le A_i \le 10^9$
- $1 \le M \le 10^6$

#### 示例解释 1

- 从休憩所 $1$ 到休憩所 $2$ 顺时针行走的最短步数是 $2$ 步，这不是 $3$ 的倍数。
- 从休憩所 $1$ 到休憩所 $3$ 顺时针行走的最短步数是 $3$ 步，这是 $3$ 的倍数。
- 从休憩所 $1$ 到休憩所 $4$ 顺时针行走的最短步数是 $7$ 步，这不是 $3$ 的倍数。
- 从休憩所 $2$ 到休憩所 $3$ 顺时针行走的最短步数是 $1$ 歩，这不是 $3$ 的倍数。
- 从休憩所 $2$ 到休憩所 $4$ 顺时针行走的最短步数是 $5$ 步，这不是 $3$ 的倍数。
- 从休憩所 $2$ 回到休憩所 $1$ 顺时针行走的最短步数是 $8$ 步，这不是 $3$ 的倍数。
- 从休憩所 $3$ 到休憩所 $4$ 顺时针行走的最短步数是 $4$ 步，这不是 $3$ 的倍数。
- 从休憩所 $3$ 回到休憩所 $1$ 顺时针行走的最短步数是 $7$ 步，这不是 $3$ 的倍数。
- 从休憩所 $3$ 回到休憩所 $2$ 顺时针行走的最短步数是 $9$ 步，这是 $3$ 的倍数。
- 从休憩所 $4$ 回到休憩所 $1$ 顺时针行走的最短步数是 $3$ 步，这是 $3$ 的倍数。
- 从休憩所 $4$ 回到休憩所 $2$ 顺时针行走的最短步数是 $5$ 步，这不是 $3$ 的倍数。
- 从休憩所 $4$ 回到休憩所 $3$ 顺时针行走的最短步数是 $6$ 步，这是 $3$ 的倍数。

因此，符合条件的 $(s,t)$ 组合数量为 $4$。

## 样例 #1

### 输入

```
4 3

2 1 4 3
```

### 输出

```
4
```

## 样例 #2

### 输入

```
2 1000000

1 1
```

### 输出

```
0
```

## 样例 #3

### 输入

```
9 5

9 9 8 2 4 4 3 5 3
```

### 输出

```
11
```



---

---
title: "[ABC371D] 1D Country"
layout: "post"
diff: 普及/提高-
pid: AT_abc371_d
tag: ['离散化', '前缀和', '差分']
---

# [ABC371D] 1D Country

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc371/tasks/abc371_d

数直線上に $ N $ 個の村があります。$ i $ 番目の村は座標 $ X_i $ にあり、$ P_i $ 人の村人がいます。

$ Q $ 個のクエリに答えてください。$ i $ 番目のクエリは以下の形式です。

- 整数 $ L_i,R_i $ が与えられる。座標が $ L_i $ 以上 $ R_i $ 以下の村に住んでいる村人の人数の総数を求めよ。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ X_1 $ $ \ldots $ $ X_N $ $ P_1 $ $ \ldots $ $ P_N $ $ Q $ $ L_1 $ $ R_1 $ $ \vdots $ $ L_Q $ $ R_Q $

## 输出格式

$ Q $ 行出力せよ。

$ i\ (1\leq\ i\ \leq\ Q) $ 行目には、$ i $ 番目のクエリに対する答えを出力せよ。

## 说明/提示

### 制約

- $ 1\leq\ N,Q\leq\ 2\times\ 10^5 $
- $ -10^9\leq\ X_1\ <\ X_2\ <\ \ldots\ <\ X_N\ \leq\ 10^9 $
- $ 1\leq\ P_i\leq\ 10^9 $
- $ -10^9\leq\ L_i\ \leq\ R_i\ \leq\ 10^9 $
- 入力される数値は全て整数

### Sample Explanation 1

$ 1 $ 番目のクエリについて考えます。座標が $ 1 $ 以上 $ 1 $ 以下の村は、座標 $ 1 $ にある村で、村人は $ 1 $ 人います。よって答えは $ 1 $ です。 $ 2 $ 番目のクエリについて考えます。座標が $ 2 $ 以上 $ 6 $ 以下の村は、座標 $ 3 $ にある村と座標 $ 5 $ にある村で、村人はそれぞれ $ 2 $ 人と $ 3 $ 人います。よって答えは $ 2+3=5 $ です。

## 样例 #1

### 输入

```
4
1 3 5 7
1 2 3 4
4
1 1
2 6
0 10
2 2
```

### 输出

```
1
5
10
0
```

## 样例 #2

### 输入

```
7
-10 -5 -3 -1 0 1 4
2 5 6 5 2 1 7
8
-7 7
-1 5
-10 -4
-8 10
-5 0
-10 5
-8 7
-8 -3
```

### 输出

```
26
15
7
26
18
28
26
11
```



---

---
title: "[ABC384D] Repeated Sequence"
layout: "post"
diff: 普及/提高-
pid: AT_abc384_d
tag: ['二分', '前缀和', '双指针 two-pointer']
---

# [ABC384D] Repeated Sequence

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc384/tasks/abc384_d

周期 $ N $ をもつ無限数列 $ A=(A\ _\ 1,A\ _\ 2,A\ _\ 3,\dotsc) $ の先頭 $ N $ 項 $ A\ _\ 1,A\ _\ 2,\dotsc,A\ _\ N $ が与えられます。

この数列の空でない連続する部分列のうち、和が $ S $ となるものが存在するか判定してください。

ただし、無限数列 $ A $ が周期 $ N $ をもつとは、$ i\gt\ N $ を満たすすべての整数 $ i $ に対して $ A\ _\ i=A\ _\ {i-N} $ が成り立つことをいいます。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ S $ $ A\ _\ 1 $ $ A\ _\ 2 $ $ \dotsc $ $ A\ _\ N $

## 输出格式

$ A $ の連続する部分列 $ (A\ _\ l,A\ _\ {l+1},\dotsc,A\ _\ r) $ であって、$ A\ _\ l+A\ _\ {l+1}+\dotsb+A\ _\ r=S $ となるものが存在するならば `Yes` を、そうでないならば `No` を出力せよ。

## 说明/提示

### 制約

- $ 1\leq\ N\leq2\times10\ ^\ 5 $
- $ 1\leq\ A\ _\ i\leq\ 10\ ^\ 9 $
- $ 1\leq\ S\leq\ 10\ ^\ {18} $
- 入力はすべて整数
 
### Sample Explanation 1

数列 $ A $ は $ (3,8,4,3,8,4,3,8,4,\dotsc) $ のようになります。 $ A $ の部分列 $ (A\ _\ 2,A\ _\ 3,A\ _\ 4,A\ _\ 5,A\ _\ 6,A\ _\ 7,A\ _\ 8,A\ _\ 9)=(8,4,3,8,4,3,8,4) $ について $ 8+4+3+8+4+3+8+4=42 $ が成り立つので、`Yes` を出力してください。

### Sample Explanation 2

$ A $ の要素はすべて $ 3 $ 以上なので、$ A $ の空でない連続する部分列の総和は $ 3 $ 以上です。 よって、総和が $ 1 $ となるような部分列は存在しないため、`No` を出力してください。

## 样例 #1

### 输入

```
3 42

3 8 4
```

### 输出

```
Yes
```

## 样例 #2

### 输入

```
3 1

3 8 4
```

### 输出

```
No
```

## 样例 #3

### 输入

```
20 83298426

748 169 586 329 972 529 432 519 408 587 138 249 656 114 632 299 984 755 404 772
```

### 输出

```
Yes
```

## 样例 #4

### 输入

```
20 85415869

748 169 586 329 972 529 432 519 408 587 138 249 656 114 632 299 984 755 404 772
```

### 输出

```
No
```



---

---
title: "[ABC388D] Coming of Age Celebration"
layout: "post"
diff: 普及/提高-
pid: AT_abc388_d
tag: ['前缀和', '差分']
---

# [ABC388D] Coming of Age Celebration

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc388/tasks/abc388_d

ある星には $ N $ 人の宇宙人がおり、全員未成年です。

$ i $ 人目の宇宙人は現在 $ A_i $ 個の石を所持しており、ちょうど $ i $ 年後に成人します。

この星では誰かが成人するとき、石を $ 1 $ 個以上所持している**成人**全員が、成人する宇宙人に成人祝いとして石を $ 1 $ 個渡します。

$ N $ 年後に各宇宙人が所持している石の個数を求めてください。

ただし、今後新たな宇宙人は産まれないものとします。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ A_1 $ $ A_2 $ $ \ldots $ $ A_N $

## 输出格式

$ N $ 年後に $ i $ 人目の宇宙人が所持している石の個数を $ B_i $ として $ B_1,\ B_2,\ \ldots,\ B_N $ をこの順に空白区切りで出力せよ。

## 说明/提示

### 制約

- $ 1\ \leq\ N\ \leq\ 5\ \times\ 10^5 $
- $ 0\ \leq\ A_i\ \leq\ 5\ \times\ 10^5 $
- 入力される値はすべて整数
 
### Sample Explanation 1

$ i $ 人目の宇宙人が持っている石の個数を $ C_i $ で表します。 はじめ $ (C_1,\ C_2,\ C_3,\ C_4)\ =\ (5,\ 0,\ 9,\ 3) $ です。 $ 1 $ 年後には $ (C_1,\ C_2,\ C_3,\ C_4)\ =\ (5,\ 0,\ 9,\ 3) $ となります。 $ 2 $ 年後には $ (C_1,\ C_2,\ C_3,\ C_4)\ =\ (4,\ 1,\ 9,\ 3) $ となります。 $ 3 $ 年後には $ (C_1,\ C_2,\ C_3,\ C_4)\ =\ (3,\ 0,\ 11,\ 3) $ となります。 $ 4 $ 年後には $ (C_1,\ C_2,\ C_3,\ C_4)\ =\ (2,\ 0,\ 10,\ 5) $ となります。

## 样例 #1

### 输入

```
4

5 0 9 3
```

### 输出

```
2 0 10 5
```

## 样例 #2

### 输入

```
5

4 6 7 2 5
```

### 输出

```
0 4 7 4 9
```

## 样例 #3

### 输入

```
10

2 9 1 2 0 4 6 7 1 5
```

### 输出

```
0 2 0 0 0 4 7 10 4 10
```



---

---
title: "~"
layout: "post"
diff: 普及/提高-
pid: AT_abc406_c
tag: ['前缀和']
---

# ~

## 题目描述

对于一个长为 $M$ 的数列 $A=(A_1,A_2,\cdots,A_N)$，$A$ 是波浪序列当且仅当以下条件被满足：
- $M\ge4$；
- $A_1<A_2$；
- 恰好存在一个 $2\le i<N$，满足 $A_{i-1}<A_i>A_{i+1}$；
- 恰好存在一个 $2\le i<N$，满足 $A_{i-1}>A_i<A_{i+1}$。

给定一个长为 $N$ 的排列 $P$，求 $P$ 有多少个连续子串是波浪序列。

## 输入格式

第一行一个整数 $N(4\le N\le 3\times 10^5)$。\
第二行 $N$ 个整数 $P_1,P_2,\cdots,P_N$，保证 $P$ 是 $1$ 到 $N$ 的排列。

## 输出格式

一行一个整数表示答案。

## 说明/提示

### 样例 1 解释

$(1,3,6,4,2,5)$ 的连续子串中有两个波浪数列，为 $(3, 6,4,2,5)$ 和 $(1,3,6,4,2,5)$。

By @[chenxi2009](/user/1020063)

## 样例 #1

### 输入

```
6
1 3 6 4 2 5
```

### 输出

```
2
```

## 样例 #2

### 输入

```
6
1 2 3 4 5 6
```

### 输出

```
0
```

## 样例 #3

### 输入

```
12
11 3 8 9 5 2 10 4 1 6 12 7
```

### 输出

```
4
```



---

---
title: "JJOOII 2 (JJOOII 2)"
layout: "post"
diff: 普及/提高-
pid: AT_joi2020ho_b
tag: ['二分', '枚举', '前缀和']
---

# JJOOII 2 (JJOOII 2)

## 题目描述

[problemUrl]: https://atcoder.jp/contests/joi2020ho/tasks/joi2020ho_b

ビ太郎は友人のビバ子から誕生日プレゼントに `J`，`O`，`I` の $ 3 $ 種類の文字からなる長さ $ N $ の文字列 $ S $ をもらった．

$ K $ を $ 1 $ 以上の整数とする．$ K $ 個の文字 `J`，$ K $ 個の文字 `O`，$ K $ 個の文字 `I` をこの順に並べた文字列を**レベル $ K $ の JOI 文字列**と呼ぶことにする．例えば，`JJOOII` はレベル $ 2 $ の JOI 文字列である．

ビ太郎はレベル $ K $ の JOI 文字列が好きなので，以下の $ 3 $ 種類の操作を任意の回数，任意の順番で行うことで，文字列 $ S $ をレベル $ K $ の JOI 文字列に変換することにした．

- **操作 $ 1 $** 文字列 $ S $ の先頭の文字を消す．
- **操作 $ 2 $** 文字列 $ S $ の末尾の文字を消す．
- **操作 $ 3 $** 文字列 $ S $ の先頭でも末尾でもない文字を消す．

操作 $ 3 $ を行うのは面倒なので，操作 $ 3 $ を行う回数をできるだけ少なくして，文字列 $ S $ をレベル $ K $ の JOI 文字列に変換したい．

長さ $ N $ の文字列 $ S $ と $ 1 $ 以上の整数 $ K $ が与えられたとき，文字列 $ S $ をレベル $ K $ の JOI 文字列に変換するのに必要な操作 $ 3 $ の回数の最小値を出力するプログラムを作成せよ．ただし，どのように操作を行っても文字列 $ S $ をレベル $ K $ の JOI 文字列に変換できない場合は，代わりに $ −1 $ を出力せよ．

- - - - - -

## 输入格式

入力は以下の形式で標準入力から与えられる．$ N,\ K $ は整数である．$ S $ は文字列である．

> $ N $ $ K $ $ S $

## 输出格式

文字列 $ S $ をレベル $ K $ の JOI 文字列に変換するのに必要な操作 $ 3 $ の回数の最小値を $ 1 $ 行で出力せよ．ただし，どのように操作を行っても文字列 $ S $ をレベル $ K $ の JOI 文字列に変換できない場合は，代わりに $ -1 $ を出力せよ．

- - - - - -

## 说明/提示

### 制約

- $ 3\ \leqq\ N\ \leqq\ 200\,000 $．
- $ 1\ \leqq\ K\ \leqq\ \frac{N}{3} $．
- $ S $ は `J`，`O`，`I` の $ 3 $ 種類の文字からなる長さ $ N $ の文字列である．

### 小課題

1. ($ 1 $ 点) $ N\ \leqq\ 21 $.
2. ($ 12 $ 点) $ N\ \leqq\ 3\,000 $.
3. ($ 87 $ 点) 追加の制約はない.

- - - - - -

### Sample Explanation 1

次のように操作を行うことで，文字列 $ S $ をレベル $ K $ のJOI文字列に変換できる． 1. まず操作 $ 1 $ を行う．文字列 $ S $ は `JIJOIOIIJ` になる． 2. 次に操作 $ 2 $ を行う．文字列 $ S $ は `JIJOIOII` になる． 3. 次に操作 $ 3 $ を行い，先頭から $ 2 $ 文字目を消す．文字列 $ S $ は `JJOIOII` になる． 4. 最後に操作 $ 3 $ を行い，先頭から $ 4 $ 文字目を消す．文字列 $ S $ は `JJOOII` になる． $ 2 $ 回未満の操作 $ 3 $ で変換することは不可能なので，$ 2 $ を出力する． - - - - - -

### Sample Explanation 2

操作を行わなくてもよい． - - - - - -

### Sample Explanation 3

この入力例では，どのように操作を行っても文字列 $ S $ をレベル $ 1 $ の JOI 文字列に変換できない．

## 样例 #1

### 输入

```
10 2
OJIJOIOIIJ
```

### 输出

```
2
```

## 样例 #2

### 输入

```
9 3
JJJOOOIII
```

### 输出

```
0
```

## 样例 #3

### 输入

```
9 1
IIIOOOJJJ
```

### 输出

```
-1
```



---


---
title: "[ABC251E] Takahashi and Animals"
layout: "post"
diff: 普及/提高-
pid: AT_abc251_e
tag: ['动态规划 DP']
---

# [ABC251E] Takahashi and Animals

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc251/tasks/abc251_e

高橋君と $ N $ 匹の動物がいます。 $ N $ 匹の動物はそれぞれ動物 $ 1 $ 、動物 $ 2 $ 、$ \ldots $ 、動物 $ N $ と呼ばれます。

高橋君は下記の $ N $ 種類の行動をそれぞれ好きな回数だけ（ $ 0 $ 回でも良い）行います。

- $ A_1 $ 円払い、動物 $ 1 $ と動物 $ 2 $ に餌をあげる。
- $ A_2 $ 円払い、動物 $ 2 $ と動物 $ 3 $ に餌をあげる。
- $ A_3 $ 円払い、動物 $ 3 $ と動物 $ 4 $ に餌をあげる。
- $ \cdots $
- $ A_i $ 円払い、動物 $ i $ と動物 $ (i+1) $ に餌をあげる。
- $ \cdots $
- $ A_{N-2} $ 円払い、動物 $ (N-2) $ と動物 $ (N-1) $ に餌をあげる。
- $ A_{N-1} $ 円払い、動物 $ (N-1) $ と動物 $ N $ に餌をあげる。
- $ A_N $ 円払い、動物 $ N $ と動物 $ 1 $ に餌をあげる。

上記の $ N $ 種類目の行動では、「動物 $ N $ と動物 $ 1 $ に」餌をあげることに注意してください。

すべての動物にそれぞれ $ 1 $ 回以上餌をあげるまでにかかる費用の合計として考えられる最小値を出力してください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ A_1 $ $ A_2 $ $ \ldots $ $ A_N $

## 输出格式

すべての動物にそれぞれ $ 1 $ 回以上餌をあげるまでにかかる費用の合計として考えられる最小値を出力せよ。

## 说明/提示

### 制約

- $ 2\ \leq\ N\ \leq\ 3\ \times\ 10^5 $
- $ 1\ \leq\ A_i\ \leq\ 10^9 $
- 入力はすべて整数

### Sample Explanation 1

高橋君が $ 1 $ 種類目、$ 3 $ 種類目、$ 4 $ 種類目の行動をそれぞれ $ 1 $ 回ずつ行うと、 動物 $ 1 $ に $ 1 $ 回、動物 $ 2 $ に $ 1 $ 回、動物 $ 3 $ に $ 1 $ 回、動物 $ 4 $ に $ 2 $ 回、動物 $ 5 $ に $ 1 $ 回餌をあげることになり、すべての動物にそれぞれ $ 1 $ 回以上餌をあげることができます。 このときにかかる費用の合計は $ A_1\ +\ A_3\ +\ A_4\ =\ 2\ +\ 3\ +\ 2\ =\ 7 $ 円であり、これが考えられる最小値です。

## 样例 #1

### 输入

```
5

2 5 3 2 5
```

### 输出

```
7
```

## 样例 #2

### 输入

```
20

29 27 79 27 30 4 93 89 44 88 70 75 96 3 78 39 97 12 53 62
```

### 输出

```
426
```



---

---
title: "[ABC253E] Distance Sequence"
layout: "post"
diff: 普及/提高-
pid: AT_abc253_e
tag: ['动态规划 DP', '前缀和']
---

# [ABC253E] Distance Sequence

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc253/tasks/abc253_e

長さ $ N $ の整数からなる数列 $ A=(A_1,\ldots,A_N) $ であって、以下の条件を全て満たすものは何通りありますか？

- $ 1\le\ A_i\ \le\ M $ $ (1\ \le\ i\ \le\ N) $
- $ |A_i\ -\ A_{i+1}|\ \geq\ K $ $ (1\ \le\ i\ \le\ N\ -\ 1) $

ただし、答えは非常に大きくなることがあるので、答えを $ 998244353 $ で割った余りを求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ M $ $ K $

## 输出格式

答えを $ 998244353 $ で割った余りを出力せよ。

## 说明/提示

### 制約

- $ 2\ \leq\ N\ \leq\ 1000 $
- $ 1\ \leq\ M\ \leq\ 5000 $
- $ 0\ \leq\ K\ \leq\ M-1 $
- 入力は全て整数

### Sample Explanation 1

条件を満たす数列は以下の $ 6 $ つです。 - $ (1,2) $ - $ (1,3) $ - $ (2,1) $ - $ (2,3) $ - $ (3,1) $ - $ (3,2) $

### Sample Explanation 2

条件を満たす数列は以下の $ 2 $ つです。 - $ (1,3,1) $ - $ (3,1,3) $

### Sample Explanation 3

答えを $ 998244353 $ で割った余りを出力してください。

## 样例 #1

### 输入

```
2 3 1
```

### 输出

```
6
```

## 样例 #2

### 输入

```
3 3 2
```

### 输出

```
2
```

## 样例 #3

### 输入

```
100 1000 500
```

### 输出

```
657064711
```



---

---
title: "[ABC271D] Flip and Adjust"
layout: "post"
diff: 普及/提高-
pid: AT_abc271_d
tag: ['动态规划 DP', '背包 DP']
---

# [ABC271D] Flip and Adjust

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc271/tasks/abc271_d

両面に整数が書かれたカードが $ N $ 枚あり、$ i\ \,\ (1\ \leq\ i\ \leq\ N) $ 枚目のカードの表には $ a_i $ が、裏には $ b_i $ が書かれています。

あなたは、それぞれのカードについて、表を上に向けて置くか裏を上に向けて置くかを自由に決めることができます。

上に向けられた面に書かれた整数の総和がちょうど $ S $ となるようにカードを置くことができるか判定し、可能ならそのようなカードの置き方の一例を求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ S $ $ a_1 $ $ b_1 $ $ \vdots $ $ a_N $ $ b_N $

## 输出格式

まず、上に向けられた面に書かれた整数の総和がちょうど $ S $ となるようにカードを置くことができるならば `Yes` を、できなければ `No` を出力し、改行せよ。

さらに、そのようにカードを置くことができるならば、カードの置き方を表す `H` および `T` のみからなる長さ $ N $ の文字列を出力せよ。  
 この文字列の $ i\ \,\ (1\ \leq\ i\ \leq\ N) $ 文字目は、$ i $ 枚目のカードを表を上に向けて置くなら `H`、裏を上に向けて置くなら `T` でなければならない。  
 条件を満たすカードの置き方が複数考えられる場合、どれを出力しても正解となる。

## 说明/提示

### 制約

- $ 1\ \leq\ N\ \leq\ 100 $
- $ 1\ \leq\ S\ \leq\ 10000 $
- $ 1\ \leq\ a_i,\ b_i\ \leq\ 100\ \,\ (1\ \leq\ i\ \leq\ N) $
- 入力は全て整数

### Sample Explanation 1

例えば次のように置くことで、上に向けられた面に書かれた整数の総和がちょうど $ S\ (=\ 11) $ となります。 - $ 1 $ 枚目は表、$ 2 $ 枚目は裏、$ 3 $ 枚目は裏を上に向けて置く。 - $ 1 $ 枚目は裏、$ 2 $ 枚目は表、$ 3 $ 枚目は表を上に向けて置く。 よって、`HTT` や `THH` といった出力が正解となります。

### Sample Explanation 2

上に向けられた面に書かれた整数の総和がちょうど $ S\ (=\ 25) $ となるようにカードを置くことはできません。

## 样例 #1

### 输入

```
3 11

1 4

2 3

5 7
```

### 输出

```
Yes

THH
```

## 样例 #2

### 输入

```
5 25

2 8

9 3

4 11

5 1

12 6
```

### 输出

```
No
```



---

---
title: "[ABC281D] Max Multiple"
layout: "post"
diff: 普及/提高-
pid: AT_abc281_d
tag: ['动态规划 DP', '数论']
---

# [ABC281D] Max Multiple

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc281/tasks/abc281_d

非負整数列 $ A=(a_1,a_2,\ldots,a_N) $ が与えられます。

$ A $ の(添え字が相異なる) $ K $ 個の項の和として考えられる非負整数の集合を $ S $ とします。

$ S $ に含まれる $ D $ の倍数の最大値を求めてください。ただし、$ S $ に $ D $ の倍数が含まれない場合、代わりに `-1` と出力してください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ K $ $ D $ $ a_1 $ $ \ldots $ $ a_N $

## 输出格式

答えを出力せよ。

## 说明/提示

### 制約

- $ 1\ \leq\ K\ \leq\ N\ \leq\ 100 $
- $ 1\ \leq\ D\ \leq\ 100 $
- $ 0\ \leq\ a_i\ \leq\ 10^9 $
- 入力はすべて整数
 
### Sample Explanation 1

$ A $ から $ 2 $ 個の項を選ぶ方法を列挙すると - $ a_1 $ と $ a_2 $ を選ぶ。選ばれた項の和は $ 1+2=3 $ となる。 - $ a_1 $ と $ a_3 $ を選ぶ。選ばれた項の和は $ 1+3=4 $ となる。 - $ a_1 $ と $ a_4 $ を選ぶ。選ばれた項の和は $ 1+4=5 $ となる。 - $ a_2 $ と $ a_3 $ を選ぶ。選ばれた項の和は $ 2+3=5 $ となる。 - $ a_2 $ と $ a_4 $ を選ぶ。選ばれた項の和は $ 2+4=6 $ となる。 - $ a_3 $ と $ a_4 $ を選ぶ。選ばれた項の和は $ 3+4=7 $ となる。 となり、$ S=\{3,4,5,6,7\} $ となります。$ S $ に含まれる $ 2 $ の倍数のうち最大のものは $ 6 $ なので、$ 6 $ と出力します。

### Sample Explanation 2

この例では $ S=\{1,3,5\} $ です。$ S $ に含まれる非負整数はいずれも $ 2 $ の倍数でないため、`-1` と出力します。

## 样例 #1

### 输入

```
4 2 2

1 2 3 4
```

### 输出

```
6
```

## 样例 #2

### 输入

```
3 1 2

1 3 5
```

### 输出

```
-1
```



---

---
title: "[ABC312D] Count Bracket Sequences"
layout: "post"
diff: 普及/提高-
pid: AT_abc312_d
tag: ['动态规划 DP']
---

# [ABC312D] Count Bracket Sequences

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc312/tasks/abc312_d

空でない文字列 $ S $ が与えられます。$ S $ の各文字は `(`, `)`, `?` のいずれかです。  
 $ S $ に含まれる `?` の個数を $ x $ とすると、`?` を `(` あるいは `)` に置き換えて新しい文字列を作る方法は $ 2^x $ 通りありますが、このうち新しくできた文字列が**括弧列**となるような置き換え方の数を $ 998244353 $ で割った余りを求めてください。

ただし、括弧列とは以下のいずれかの条件を満たす文字列のことです。

- 空文字列
- ある括弧列 $ A $ が存在して、`(`, $ A $, `)` をこの順に連結した文字列
- ある空でない括弧列 $ A,\ B $ が存在して、$ A,\ B $ をこの順に連結した文字列

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ S $

## 输出格式

答えを出力せよ。

## 说明/提示

### 制約

- $ S $ は長さ $ 3000 $ 以下の `(`, `)`, `?` からなる空でない文字列
 
### Sample Explanation 1

$ S $ を `()()()` あるいは `(())()` に置き換えると括弧列となります。 他の置き換え方で新しくできた文字列が括弧列となることはないので、$ 2 $ を出力します。

### Sample Explanation 3

$ 998244353 $ で割った余りを出力してください。

## 样例 #1

### 输入

```
(???(?
```

### 输出

```
2
```

## 样例 #2

### 输入

```
)))))
```

### 输出

```
0
```

## 样例 #3

### 输入

```
??????????????(????????(??????)?????????(?(??)
```

### 输出

```
603032273
```



---

---
title: "[ABC318D] General Weighted Max Matching"
layout: "post"
diff: 普及/提高-
pid: AT_abc318_d
tag: ['动态规划 DP', '搜索', '状态合并']
---

# [ABC318D] General Weighted Max Matching

## 题目描述

**题意简述**

有一个无向图，$i$ 到 $j$ 的距离为 $D_{i,j}$。你可以选择一些边，使得这些边连接的所有顶点互不相同。求这些边总长度的最大值。

## 输入格式

以以下格式输入：

> $N$\
> $D_{1,2},D_{1,3},\ldots,D_{1,N}$\
> $D_{2,3},\ldots,D_{2,N}$\
> $\vdots$\
> $D_{N-1,N}$

## 输出格式

$1$ 个整数。如题意。

## 说明/提示

- $2 \le N \le 16$
- $1 \le D_{i,j} \le 10^9$

**样例一解释**

选择 $D_{1,3},D_{2,4}$，总和为$5+8=13$。

## 样例 #1

### 输入

```
4

1 5 4

7 8

6
```

### 输出

```
13
```

## 样例 #2

### 输入

```
3

1 2

3
```

### 输出

```
3
```

## 样例 #3

### 输入

```
16

5 6 5 2 1 7 9 7 2 5 5 2 4 7 6

8 7 7 9 8 1 9 6 10 8 8 6 10 3

10 5 8 1 10 7 8 4 8 6 5 1 10

7 4 1 4 5 4 5 10 1 5 1 2

2 9 9 7 6 2 2 8 3 5 2

9 10 3 1 1 2 10 7 7 5

10 6 1 8 9 3 2 4 2

10 10 8 9 2 10 7 9

5 8 8 7 5 8 2

4 2 2 6 8 3

2 7 3 10 3

5 7 10 3

8 5 7

9 1

4
```

### 输出

```
75
```



---

---
title: "[ABC321F] #(subset sum = K) with Add and Erase"
layout: "post"
diff: 普及/提高-
pid: AT_abc321_f
tag: ['动态规划 DP', '背包 DP']
---

# [ABC321F] #(subset sum = K) with Add and Erase

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc321/tasks/abc321_f

箱を用意します。最初、箱は空です。  
この箱に対して、以下の $ 2 $ 種類の操作を合計 $ Q $ 個、入力で与えられた順に施します。

> \+ $ x $

タイプ $ 1 $ : 箱の中に整数 $ x $ の書かれたボールを $ 1 $ つ追加する。

> \- $ x $

タイプ $ 2 $ : 箱の中にある、整数 $ x $ の書かれたボールを $ 1 $ つ取り除く。  
**但し、取り除く前の時点で箱の中に整数 $ x $ が書かれたボールが含まれることが保証されます。**

各操作後の箱に関して、以下の問題を解いてください。

> 箱からボールをいくつか取り出して、ボールに書かれた整数の総和を $ K $ とする方法の総数を $ 998244353 $ で割った余りを求めてください。  
> 但し、箱の中に入っている全てのボールは区別可能です。

## 输入格式

入力は以下の形式で標準入力から与えられる。  
但し、 $ \rm{Query} $$ _{i} $ は $ i $ 個目の操作を表す。

> $ Q $ $ K $ $ \rm{Query} $$ _{1} $ $ \rm{Query} $$ _{2} $ $ \vdots $ $ \rm{Query} $$ _{Q} $

## 输出格式

全体で $ Q $ 行出力せよ。  
そのうち $ i $ 行目には、 $ i $ 個目までの操作を終えた時点での答えを出力せよ。

## 说明/提示

### 制約

- 入力は全て整数
- $ 1\ \le\ Q\ \le\ 5000 $
- $ 1\ \le\ K\ \le\ 5000 $
- タイプ $ 1 $ の操作に関して、 $ 1\ \le\ x\ \le\ 5000 $
- 全ての操作は問題文中の条件を満たす。

### Sample Explanation 1

この入力には、操作が $ 15 $ 個含まれます。 最後の操作の後、箱の中に入ったボールは $ (5,10,1,3,1,7,4) $ となります。 総和を $ 10 $ にする方法は以下の $ 5 $ 通りです。 - $ 5+1+3+1 $ ( $ 1,3,4,5 $ 番目のボールを取り出す ) - $ 5+1+4 $ ( $ 1,3,7 $ 番目のボールを取り出す ) - $ 5+1+4 $ ( $ 1,5,7 $ 番目のボールを取り出す ) - $ 10 $ ( $ 2 $ 番目のボールを取り出す ) - $ 3+7 $ ( $ 4,6 $ 番目のボールを取り出す )

## 样例 #1

### 输入

```
15 10
+ 5
+ 2
+ 3
- 2
+ 5
+ 10
- 3
+ 1
+ 3
+ 3
- 5
+ 1
+ 7
+ 4
- 3
```

### 输出

```
0
0
1
0
1
2
2
2
2
2
1
3
5
8
5
```



---

---
title: "[ABC323E] Playlist"
layout: "post"
diff: 普及/提高-
pid: AT_abc323_e
tag: ['动态规划 DP', '概率论']
---

# [ABC323E] Playlist

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc323/tasks/abc323_e

高橋君は $ N $ 曲からなるプレイリストを持っています。 曲 $ i $ $ (1\ \leq\ i\ \leq\ N) $ の長さは $ T_i $ 秒です。  
高橋君は時刻 $ 0 $ にプレイリストのランダム再生を開始しました。

ランダム再生では、$ N $ 曲の中から等確率で $ 1 $ つを選びその曲を最後まで再生することが繰り返されます。 ここで、曲の再生は休みなく行われ、$ 1 $ つの曲が終わったらすぐに次に選ばれた曲が始まります。 また、同じ曲が連続して選ばれる事もあります。

時刻 $ 0 $ から $ (X+0.5) $ 秒後に曲 $ 1 $ が再生されている確率を $ \text{mod}998244353 $ で求めてください。

確率 $ \text{mod\ }\ 998244353 $ の定義この問題で求める確率は必ず有理数になることが証明できます。 また、この問題の制約下では、求める確率を既約分数 $ \frac{y}{x} $ で表したときに $ x $ が $ 998244353 $ で割り切れないことが保証されます。

このとき $ xz\ \equiv\ y\ \pmod{998244353} $ を満たすような $ 0 $ 以上 $ 998244352 $ 以下の整数 $ z $ が一意に定まります。この $ z $ を答えてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ X $ $ T_1 $ $ T_2 $ $ \ldots $ $ T_N $

## 输出格式

時刻 $ 0 $ から $ (X+0.5) $ 秒後にプレイリストの $ 1 $ 番目の曲が再生されている確率を $ \text{mod}998244353 $ で出力せよ。

## 说明/提示

### 制約

- $ 2\ \leq\ N\leq\ 10^3 $
- $ 0\ \leq\ X\leq\ 10^4 $
- $ 1\ \leq\ T_i\leq\ 10^4 $
- 入力はすべて整数

### Sample Explanation 1

時刻 $ 0 $ から $ 6.5 $ 秒後に曲 $ 1 $ が流れているパターンとしてあり得るのは、 - 曲 $ 1 $ $ \to $ 曲 $ 1 $ $ \to $ 曲 $ 1 $ - 曲 $ 2 $ $ \to $ 曲 $ 1 $ - 曲 $ 3 $ $ \to $ 曲 $ 1 $ の順で音楽が再生された場合であり、これらのいずれかが起こる確率は $ \frac{7}{27} $ となります。 $ 369720131\times\ 27\equiv\ 7\ \pmod{998244353} $ であるため、$ 369720131 $ を出力します。

### Sample Explanation 2

時刻 $ 0 $ から $ 0.5 $ 秒後には最初に再生された曲が再生されているため、求める確率は $ \frac{1}{5} $ となります。 同じ長さの異なる曲が存在することがあることに注意してください。

## 样例 #1

### 输入

```
3 6
3 5 6
```

### 输出

```
369720131
```

## 样例 #2

### 输入

```
5 0
1 2 1 2 1
```

### 输出

```
598946612
```

## 样例 #3

### 输入

```
5 10000
1 2 3 4 5
```

### 输出

```
586965467
```



---

---
title: "[ABC327E] Maximize Rating"
layout: "post"
diff: 普及/提高-
pid: AT_abc327_e
tag: ['动态规划 DP', '背包 DP']
---

# [ABC327E] Maximize Rating

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc327/tasks/abc327_e

高橋君は $ N $ 回コンテストに参加し、$ i $ 回目に参加したコンテストにおいてパフォーマンス $ P_i $ を獲得しました。  
高橋君はこの中から ($ 1 $ つ以上) いくつかのコンテストを選び、それらの結果から計算される高橋君のレートを最大にしたいと考えています。

コンテストをうまく選んだとき、高橋君のレートとしてあり得る最大の値を求めてください。

ただし、高橋君のレート $ R $ は、高橋君の選んだコンテストの数が $ k $ 個であり、 選んだコンテストにおけるパフォーマンスが **参加した順に** それぞれ $ (Q_1,Q_2,\ldots,Q_k) $ であるとき、

$ \displaystyle\ R=\frac{\sum_{i=1}^k\ (0.9)^{k-i}Q_i}{\sum_{i=1}^k\ (0.9)^{k-i}}-\frac{1200}{\sqrt{k}} $ によって計算されます。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ P_1 $ $ P_2 $ $ \ldots $ $ P_N $

## 输出格式

高橋君のレートとしてあり得る最大の値を出力せよ。  
出力は、真の値との絶対誤差または相対誤差が $ 10^{-6} $ 以下のとき正解と判定される。

## 说明/提示

### 制約

- $ 1\leq\ N\leq\ 5000 $
- $ 1\leq\ P_i\leq\ 5000 $
- 入力はすべて整数

### Sample Explanation 1

高橋君が $ 1 $ 回目と $ 3 $ 回目のコンテストを選んだ時、レートは、 $ \displaystyle\ R=\frac{0.9\times\ 1000+\ 1.0\times\ 1200}{0.9+1.0}-\frac{1200}{\sqrt{2}}=256.73502... $ となり、この時レートが最大となります。

### Sample Explanation 2

$ 1,2,3 $ 回目のコンテストすべてを選んだとき、レートが最大となります。

### Sample Explanation 3

レートは負になることもあります。

## 样例 #1

### 输入

```
3
1000 600 1200
```

### 输出

```
256.735020470879931
```

## 样例 #2

### 输入

```
3
600 1000 1200
```

### 输出

```
261.423219407873376
```

## 样例 #3

### 输入

```
1
100
```

### 输出

```
-1100.000000000000000
```



---

---
title: "[ABC336D] Pyramid"
layout: "post"
diff: 普及/提高-
pid: AT_abc336_d
tag: ['动态规划 DP']
---

# [ABC336D] Pyramid

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc336/tasks/abc336_d

正の整数 $ k $ について、サイズ $ k $ の **ピラミッド数列** とは、長さ $ (2k-1) $ の数列であって各項の値が順に $ 1,2,\ldots,k-1,k,k-1,\ldots,2,1 $ であるようなものをさします。

長さ $ N $ の数列 $ A=(A_1,A_2,\ldots,A_N) $ が与えられます。  
 $ A $ に対して、次の操作のうち一方を選んで行うことを繰り返して ($ 0 $ 回でも良い) 得ることのできるピラミッド数列のサイズの最大値を求めてください。

- 数列の項を $ 1 $ つ選び、その項の値を $ 1 $ 減少させる。
- 先頭または末尾の項を削除する。
 
なお、問題の制約のもとで、操作を繰り返すことで必ず $ 1 $ 種類以上のピラミッド数列を得ることができることが証明できます。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ A_1 $ $ A_2 $ $ \ldots $ $ A_N $

## 输出格式

数列 $ A $ に問題文の操作を繰り返して得ることのできるピラミッド数列のサイズの最大値を出力せよ。

## 说明/提示

### 制約

- $ 1\leq\ N\leq\ 2\times\ 10^5 $
- $ 1\leq\ A_i\leq\ 10^9 $
- 入力はすべて整数
 
### Sample Explanation 1

$ A=(2,2,3,1,1) $ から始めて、 次のようにして数列 $ A $ からサイズ $ 2 $ のピラミッド数列を作る事ができます。 - 第 $ 3 $ 項を選び、$ 1 $ 減少させる。数列は $ A=(2,2,2,1,1) $ となる。 - 先頭を削除する。数列は $ A=(2,2,1,1) $ となる。 - 末尾を削除する。数列は $ A=(2,2,1) $ となる。 - 第 $ 1 $ 項を選び、$ 1 $ 減少させる。数列は $ A=(1,2,1) $ となる。 $ (1,2,1) $ はサイズ $ 2 $ のピラミッド数列です。 一方、どのように操作を行ってもサイズ $ 3 $ 以上のピラミッド数列を作ることはできないため $ 2 $ を出力します。

## 样例 #1

### 输入

```
5

2 2 3 1 1
```

### 输出

```
2
```

## 样例 #2

### 输入

```
5

1 2 3 4 5
```

### 输出

```
3
```

## 样例 #3

### 输入

```
1

1000000000
```

### 输出

```
1
```



---

---
title: "[ABC344D] String Bags"
layout: "post"
diff: 普及/提高-
pid: AT_abc344_d
tag: ['动态规划 DP', '背包 DP']
---

# [ABC344D] String Bags

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc344/tasks/abc344_d

あなたは最初、空文字列 $ S $ を持っています。  
 さらに、文字列がいくつか入った袋 $ 1,2,\dots,N $ があります。  
 袋 $ i $ には $ A_i $ 個の文字列 $ S_{i,1},S_{i,2},\dots,S_{i,A_i} $ が入っています。

これから、以下の手順を $ i=1,2,\dots,N $ について繰り返します。

- 以下のふたつの行動のうち、どちらかを選択して行う。
  - $ 1 $ 円を支払い、袋 $ i $ からちょうどひとつの文字列を選択して $ S $ の末尾に連結する。
  - 何もしない。
 
文字列 $ T $ が与えられるとき、最終的に $ S $ と $ T $ を一致させるために必要な最小の金額を求めてください。  
 但し、どのようにしても最終的な $ S $ を $ T $ に一致させることができない場合、 `-1` と出力してください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ T $ $ N $ $ A_1 $ $ S_{1,1} $ $ S_{1,2} $ $ \dots $ $ S_{1,A_1} $ $ A_2 $ $ S_{2,1} $ $ S_{2,2} $ $ \dots $ $ S_{2,A_2} $ $ \vdots $ $ A_N $ $ S_{N,1} $ $ S_{N,2} $ $ \dots $ $ S_{N,A_N} $

## 输出格式

答えを整数として出力せよ。

## 说明/提示

### 制約

- $ T $ は長さ $ 1 $ 以上 $ 100 $ 以下の英小文字からなる文字列
- $ N $ は $ 1 $ 以上 $ 100 $ 以下の整数
- $ A_i $ は $ 1 $ 以上 $ 10 $ 以下の整数
- $ S_{i,j} $ は長さ $ 1 $ 以上 $ 10 $ 以下の英小文字からなる文字列
 
### Sample Explanation 1

例えば、以下のようにすると $ 2 $ 円で最終的な $ S $ と $ T $ を一致させることができ、これが必要な金額の最低値であることが示せます。 - $ i=1 $ について、袋 $ 1 $ から `abc` を選択し $ S $ の末尾に連結する。 $ S= $ `abc` となる。 - $ i=2 $ について、何もしない。 - $ i=3 $ について、袋 $ 3 $ から `de` を選択し $ S $ の末尾に連結する。 $ S= $ `abcde` となる。

### Sample Explanation 2

どのようにしても最終的な $ S $ と $ T $ を一致させることができないので、 `-1` と出力してください。

## 样例 #1

### 输入

```
abcde

3

3 ab abc abcd

4 f c cd bcde

2 e de
```

### 输出

```
2
```

## 样例 #2

### 输入

```
abcde

3

2 ab abc

3 f c bcde

1 e
```

### 输出

```
-1
```

## 样例 #3

### 输入

```
aaabbbbcccc

6

2 aa aaa

2 dd ddd

2 ab aabb

4 bbaa bbbc bbb bbcc

2 cc bcc

3 ccc cccc ccccc
```

### 输出

```
4
```



---

---
title: "[ABC346D] Gomamayo Sequence"
layout: "post"
diff: 普及/提高-
pid: AT_abc346_d
tag: ['动态规划 DP']
---

# [ABC346D] Gomamayo Sequence

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc346/tasks/abc346_d

`0`, `1` からなる長さ $ N $ の文字列 $ S $ が与えられます。

`0`, `1` からなる長さ $ N $ の文字列 $ T $ は以下の条件を満たすとき、またそのときに限り **良い文字列** であると定義します。

- $ 1\ \leq\ i\ \leq\ N\ -\ 1 $ を満たす整数 $ i $ であって、$ T $ の $ i $ 文字目と $ i\ +\ 1 $ 文字目が一致するようなものがちょうど $ 1 $ つ存在する。
 
$ i\ =\ 1,2,\ldots,\ N $ について以下の操作を $ 1 $ 度行うか行わないか選ぶことができます。

- $ S $ の $ i $ 文字目が `0` であるとき $ S $ の $ i $ 文字目を `1` に、そうでないとき $ S $ の $ i $ 文字目を `0` に置き換える。操作を行った場合、$ C_i $ のコストがかかる。
 
$ S $ を良い文字列にするために必要なコストの総和の最小値を求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ S $ $ C_1 $ $ C_2 $ $ \ldots $ $ C_N $

## 输出格式

答えを出力せよ。

## 说明/提示

### 制約

- $ 2\ \leq\ N\ \leq\ 2\ \times\ 10^5 $
- $ S $ は長さ $ N $ の `0`,`1` からなる文字列
- $ 1\ \leq\ C_i\ \leq\ 10^9 $
- $ N,\ C_i $ は整数
 
### Sample Explanation 1

$ i\ =\ 1,\ 5 $ に対して操作を行い、$ i\ =\ 2,\ 3,\ 4 $ に対して操作を行わないことで $ S\ = $ `10010` となり、$ S $ は良い文字列となります。このときかかるコストは $ 7 $ であり、コスト $ 7 $ 未満で $ S $ を良い文字列にすることはできないため、$ 7 $ を出力します。

## 样例 #1

### 输入

```
5

00011

3 9 2 6 4
```

### 输出

```
7
```

## 样例 #2

### 输入

```
4

1001

1 2 3 4
```

### 输出

```
0
```

## 样例 #3

### 输入

```
11

11111100111

512298012 821282085 543342199 868532399 690830957 973970164 928915367 954764623 923012648 540375785 925723427
```

### 输出

```
2286846953
```



---

---
title: "[ABC365D] AtCoder Janken 3"
layout: "post"
diff: 普及/提高-
pid: AT_abc365_d
tag: ['动态规划 DP']
---

# [ABC365D] AtCoder Janken 3

## 题目描述

高桥和青木玩了 $N$ 次石头剪刀布。注：在这个游戏中，石头赢剪刀，剪刀赢纸，纸赢石头。

青木的动作由长度为 $N$ 的字符串 $S$ 表示，字符串由 `R`、`P` 和 `S` 组成。$S$ 中的第 $i$ 个字符表示青木在第 $i$ 盘棋局中的棋步：`R` 表示石头，`P` 表示 纸，`S` 表示剪刀。

高桥的棋步满足以下条件：

- 高桥从未输给过青木。
- 对于 $i=1,2,…,N−1$，高桥在第 $i$ 对局中的棋步与他在第 $i+1$ 对局中的棋步不同。

求高桥可能赢的最大对局数。

可以保证存在一个满足上述条件的高桥下棋顺序。

## 输入格式

输入共有 $2$ 行

第一行 $1$ 个整数 $N$

第二行为 $1$ 个只包含 `R`、`P` 和 `S` 的长度为 $N$ 字符串 $S$

## 输出格式

输出只有 $1$ 行，为高桥可能赢的最大对局数

## 说明/提示

$1 \le n \le 2\times 10^5$

## 样例 #1

### 输入

```
6

PRSSRS
```

### 输出

```
5
```

## 样例 #2

### 输入

```
10

SSSSSSSSSS
```

### 输出

```
5
```

## 样例 #3

### 输入

```
24

SPRPSRRRRRPPRPRPSSRSPRSS
```

### 输出

```
18
```



---

---
title: "[ABC369D] Bonus EXP"
layout: "post"
diff: 普及/提高-
pid: AT_abc369_d
tag: ['动态规划 DP']
---

# [ABC369D] Bonus EXP

## 题目描述

高桥君遇到了 $N$ 只怪物，依次遇到每一只怪物，第 $i$ 只怪物的强度为 $A_i$。

高桥君可以选择对每只怪物是放走还是击败。  
高桥君通过以下的方式获得经验值：

- 如果选择放走怪物，获得的经验值为 $0$。
- 如果击败强度为 $X$ 的怪物，他可以获得 $X$ 的经验值。但是，如果这是他第偶数次击败怪物（即第 $2$ 次、第 $4$ 次、……），他将额外获得 $X$ 的经验值。

请计算高桥君通过击败怪物可以获得的最大总经验值。

## 输入格式

输入从标准输入中读取，格式如下：

> $N$ $A_1$ $A_2$ $A_N$

## 输出格式

输出高桥君可能获得的最大总经验值。

## 说明/提示

### 约束条件

- $1 \leq N \leq 2 \times 10^5$
- $1 \leq A_i \leq 10^9$
- 输入的所有数值均为整数

### 样例解释 1

在击败第 1、2、3、5 只怪物并放走第 4 只怪物时，高桥君可以按如下方式获得经验值： 
- 击败强度为 $A_1=1$ 的怪物，获得 $1$ 的经验值。
- 击败强度为 $A_2=5$ 的怪物，获得 $5$ 的经验值。这是高桥君第 2 次击败怪物，因此额外获得 $5$ 的经验值。
- 击败强度为 $A_3=3$ 的怪物，获得 $3$ 的经验值。
- 放走第 4 只怪物，高桥君不获得经验值。
- 击败强度为 $A_5=7$ 的怪物，获得 $7$ 的经验值。这是高桥君第 4 次击败怪物，因此额外获得 $7$ 的经验值。

因此，总共获得的经验值为 $1+(5+5)+3+0+(7+7)=28$。  
由于无论如何行动，总经验值都不会超过 $28$，所以输出 $28$。

请注意，如果击败所有怪物，获得的经验值为 $1+(5+5)+3+(2+2)+7=25$。

### 样例解释 2

请注意，答案可能会超过 32 位整数型的范围。

## 样例 #1

### 输入

```
5

1 5 3 2 7
```

### 输出

```
28
```

## 样例 #2

### 输入

```
2

1000000000 1000000000
```

### 输出

```
3000000000
```



---

---
title: "[ABC370E] Avoid K Partition"
layout: "post"
diff: 普及/提高-
pid: AT_abc370_e
tag: ['动态规划 DP']
---

# [ABC370E] Avoid K Partition

## 题目描述

给出长度为 $N$ 的序列 $A=(A_1,A_2,\dots,A_N)$ 以及一个整数 $K$。

存在 $2^{N-1}$ 种方法将 $A$ 分成若干个连续子区间。有多少划分方法满足没有任何一个划分出的子区间元素和为 $K$？请输出这个值模 $998244353$ 的结果。

这里，“将 $A$ 分成若干个连续子区间”的含义如下：

- 随意选择一个整数 $k\space 1\le k\le N$ 作为序列长度，并且随意选择一个满足条件 $1=i_1<i_2<\dots<i_k<i_{k+1}=N+1$ 的整数序列 $(i_1,i_2,\dots,i_k,i_{k+1})$。
- 对于每个满足 $1\le n\le k$ 的整数 $n$，第 $n$ 个被划分出来的子区间是由提取序列 $A$ 中的第 $i_n$ 到第 $(i_{n+1}-1)$ 个元素得到的。

举个例子，以下是序列 $A=(1,2,3,4,5)$ 的若干可行划分方案：

- $(1,2,3),(4),(5)$
- $(1,2),(3,4,5)$
- $(1,2,3,4,5)$

## 输入格式

从标准输入输出流输入，格式如下：

> $ N \space K $
>
> $ A_1 \space A_2 \space \dots \space A_N $

## 输出格式

请输出答案模 $998244353$ 的结果。

## 说明/提示

- $1 \leq N \leq 2 \times 10^5$
- $-10^{15} \leq K \leq 10^{15}$
- $-10^9 \leq A_i \leq 10^9$
- 全部输入为整数

#### 对样例 1 的解释

以下是符合题目要求的 $2$ 种划分方案。

- $(1),(2,3)$
- $(1,2,3)$

Author: [Redshift_Shine](/user/475403)

## 样例 #1

### 输入

```
3 3

1 2 3
```

### 输出

```
2
```

## 样例 #2

### 输入

```
5 0

0 0 0 0 0
```

### 输出

```
0
```

## 样例 #3

### 输入

```
10 5

-5 -1 -7 6 -6 -2 -5 10 2 -10
```

### 输出

```
428
```



---

---
title: "[ABC375E] 3 Team Division"
layout: "post"
diff: 普及/提高-
pid: AT_abc375_e
tag: ['动态规划 DP']
---

# [ABC375E] 3 Team Division

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc375/tasks/abc375_e

$ N $ 人の人がおり、$ 3 $ つのチームに分かれています。

人には $ 1,\ 2,\ \ldots,\ N $ の番号、チームには $ 1,\ 2,\ 3 $ の番号がついており、現在人 $ i $ はチーム $ A_i $ に所属しています。

各人には**強さ**という値が定まっており、人 $ i $ の強さは $ B_i $ です。また、チームの**強さ**をチームに所属する人の強さの和として定めます。

$ 0 $ 人以上の人が所属するチームを変更することですべてのチームの強さが等しくなるようにできるか判定してください。すべてのチームの強さが等しくなるようにできる場合は所属するチームを変更する人数として考えられる最小値を求めてください。

ただし、チーム $ 1,\ 2,\ 3 $ の他に新たにチームを作ることはできません。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ A_1 $ $ B_1 $ $ A_2 $ $ B_2 $ $ \vdots $ $ A_N $ $ B_N $

## 输出格式

すべてのチームの強さが等しくなるようにできる場合は所属するチームを変更する人数として考えられる最小値を出力せよ。そうでない場合は $ -1 $ を出力せよ。

## 说明/提示

### 制約

- $ 3\ \leq\ N\ \leq\ 100 $
- $ A_i\ \in\ \lbrace\ 1,\ 2,\ 3\ \rbrace $
- 各 $ x\ \in\ \lbrace\ 1,\ 2,\ 3\ \rbrace $ に対し、ある $ i $ が存在して $ A_i\ =\ x $
- $ 1\ \leq\ B_i $
- $ \displaystyle\sum_{i\ =\ 1}^{N}\ B_i\ \leq\ 1500 $
- 入力される値はすべて整数
 
### Sample Explanation 1

人 $ 1 $ がチーム $ 3 $、人 $ 4 $ がチーム $ 2 $ へと所属するチームを変更することですべてのチームの強さが $ 8 $ となります。

## 样例 #1

### 输入

```
6

1 2

2 5

1 5

3 3

1 3

3 6
```

### 输出

```
2
```

## 样例 #2

### 输入

```
4

1 1

1 2

2 3

3 4
```

### 输出

```
-1
```

## 样例 #3

### 输入

```
3

1 1

2 1

3 1
```

### 输出

```
0
```

## 样例 #4

### 输入

```
12

2 5

1 4

3 3

2 3

3 9

1 2

2 2

3 9

2 6

1 9

1 1

3 1
```

### 输出

```
3
```



---

---
title: "[ABC381D] 1122 Substring"
layout: "post"
diff: 普及/提高-
pid: AT_abc381_d
tag: ['动态规划 DP', '双指针 two-pointer']
---

# [ABC381D] 1122 Substring

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc381/tasks/abc381_d

正整数からなる（空でも良い）数列 $ X=(X_1,X_2,\ldots) $ が以下の $ 3 $ つの条件をすべてみたすとき、かつそのときに限り、$ X $ を **1122 数列** と呼びます。  
（1122 数列の定義はF問題と共通です。）

- $ \lvert\ X\ \rvert $ は偶数である。ここで、$ \lvert\ X\ \rvert $ は $ X $ の長さを表す。
- $ 1\leq\ i\leq\ \frac{\lvert\ X\ \rvert}{2} $ をみたす整数 $ i $ について、$ X_{2i-1} $ と $ X_{2i} $ は等しい。
- 各正整数は $ X $ に現れないか、ちょうど $ 2 $ 回現れるかのどちらかである。すなわち、$ X $ に含まれる正整数は $ X $ にちょうど $ 2 $ 回ずつ登場する。

正整数からなる長さ $ N $ の数列 $ A=(A_1,A_2,\ldots,A_N) $ が与えられるので、$ A $ の **連続する部分列** であって、1122 数列であるようなもののうち最長のものの長さを出力してください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ A_1 $ $ A_2 $ $ \ldots $ $ A_N $

## 输出格式

$ A $ の連続する部分列であって、1122 数列であるようなもののうち最長のものの長さを出力せよ。

## 说明/提示

### 制約

- $ 1\leq\ N\ \leq\ 2\times\ 10^5 $
- $ 1\leq\ A_i\ \leq\ N $
- 入力はすべて整数

### Sample Explanation 1

例えば $ A $ の $ 3 $ 項目から $ 6 $ 項目までの連続部分列をとると $ (1,1,2,2) $ となりますが、これは長さが $ 4 $ の 1122 数列となっています。 これより長い部分列であって、1122 数列の条件をみたすようなものは存在しないため、$ 4 $ を出力します。

### Sample Explanation 3

項数が $ 0 $ の列も 1122 数列の条件をみたしていることに注意してください。

## 样例 #1

### 输入

```
8
2 3 1 1 2 2 1 1
```

### 输出

```
4
```

## 样例 #2

### 输入

```
3
1 2 2
```

### 输出

```
2
```

## 样例 #3

### 输入

```
1
1
```

### 输出

```
0
```



---

---
title: "[ABC403D] Forbidden Difference"
layout: "post"
diff: 普及/提高-
pid: AT_abc403_d
tag: ['动态规划 DP', '数学']
---

# [ABC403D] Forbidden Difference

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc403/tasks/abc403_d

给定一个长度为 $N$ 的整数序列 $A=(A_1,A_2,\dots,A_N)$ 和一个非负整数 $D$。我们需要通过删除 $A$ 中的若干元素，得到一个新序列 $B$，使其满足以下条件：

- 对于所有 $i,j\ \ (1 \leq i < j \leq |B|)$，都有 $|B_i - B_j| \neq D$。

求最少需要删除多少个元素才能满足条件。

## 输入格式

输入通过标准输入给出，格式如下：

> $N$ $D$  
> $A_1$ $A_2$ $\dots$ $A_N$


## 输出格式

输出需要删除的最少元素数量。


## 说明/提示

### 约束条件

- $1 \leq N \leq 2 \times 10^5$
- $0 \leq D \leq 10^6$
- $0 \leq A_i \leq 10^6$
- 输入中的所有值均为整数

### 样例解释 #1

删除 $A_1=3$，得到 $B=(1,4,1,5)$，此时对于所有 $i<j$，都有 $|B_i - B_j| \neq 2$。

### 样例解释 #2

原始序列 $A$ 已经满足条件，因此不需要删除任何元素。

翻译由 DeepSeek V3 完成

## 样例 #1

### 输入

```
5 2
3 1 4 1 5
```

### 输出

```
1
```

## 样例 #2

### 输入

```
4 3
1 6 1 8
```

### 输出

```
0
```

## 样例 #3

### 输入

```
10 3
1 6 2 10 2 3 2 10 6 4
```

### 输出

```
2
```



---

---
title: "[ABC408D] Flip to Gather"
layout: "post"
diff: 普及/提高-
pid: AT_abc408_d
tag: ['动态规划 DP', '贪心']
---

# [ABC408D] Flip to Gather

## 题目描述

给你一个长度为 $N$ 的、由 $0$ 和 $1$ 构成的字符串 $S$。

你可以执行以下操作若干次：
- 选择一个整数 $1\le i\le N$，$S_i\leftarrow 1-S_i$。

你的目标是让 $S$ 中的 $1$ 连续或 $S$ 中不存在 $1$。请找出需要的最小的操作次数。

多组数据。

## 输入格式

多组数据。第一行一个整数 $T(1\le T\le 2\times 10^4)$，表示数据组数。

对于每组数据：\
第一行一个整数 $N(1\le N\le 2\times 10^5)$。\
第二行一个长为 $N$ 的字符串 $S$。$S$ 由 $0$ 和 $1$ 构成。

保证单个测试点中 $\sum N\le 2\times 10^5$。

## 输出格式

对于每组数据，输出一行一个整数表示答案。

## 说明/提示

**样例 1 解释**

对于第一组数据，我们选择 $i=1$ 进行一次操作即可。

第二、三组数据不需要执行任何操作。

By @[chenxi2009](/user/1020063)

## 样例 #1

### 输入

```
3
5
10011
10
1111111111
7
0000000
```

### 输出

```
1
0
0
```

## 样例 #2

### 输入

```
5
2
01
10
1000010011
12
111100010011
3
111
8
00010101
```

### 输出

```
0
2
3
0
2
```



---

---
title: "[ABC410E] Battles in a Row"
layout: "post"
diff: 普及/提高-
pid: AT_abc410_e
tag: ['动态规划 DP', '背包 DP']
---

# [ABC410E] Battles in a Row

## 题目描述

高桥在玩游戏，他要**按顺序**对战 $N$ 只怪兽，初始时，高桥有 $H$ 点体力和 $M$ 点魔力。

对于第 $i$ 只怪兽，高桥可以选择：
- 使用体力战斗，当且仅当高桥当前体力 $\ge A_i$ 时可以选择，高桥花费 $A_i$ 点体力击败第 $i$ 只怪兽。
- 使用魔力战斗，当且仅当高桥当前魔力 $\ge B_i$ 时可以选择，高桥花费 $B_i$ 点魔力击败第 $i$ 只怪兽。

当高桥面对某只怪兽时无法进行上述任意一种战斗或所有 $N$ 只怪兽均被击败时，游戏结束。求他最多能击败多少只怪兽。

## 输入格式

第一行三个整数 $N,H,M(1\le N,H,M\le 3000)$。\
接下来 $N$ 行，每行两个整数 $A_i,B_i(1\le A_i,B_i\le 3000)$ 描述高桥要击败的第 $i$ 只怪兽。

## 输出格式

输出一行一个整数表示答案。

## 说明/提示

**样例 1 解释**

高桥可以击败 $3$ 只怪兽，一种可能的进程如下：
- 初始时，高桥有 $10$ 点体力和 $14$ 点魔力。
- 对于第一只怪兽，高桥使用体力战斗，剩余 $5$ 点体力和 $14$ 点魔力。
- 对于第二只怪兽，高桥使用体力战斗，剩余 $0$ 点体力和 $14$ 点魔力。
- 对于第三只怪兽，高桥使用魔力战斗，剩余 $5$ 点体力和 $5$ 点魔力。
- 对于第四只怪兽，高桥无法进行战斗，游戏结束。

**样例 2 解释**

高桥可以击败所有的 $N$ 只怪兽。

By @[chenxi2009](/user/1020063)

## 样例 #1

### 输入

```
4 10 14

5 8

5 6

7 9

99 99
```

### 输出

```
3
```

## 样例 #2

### 输入

```
3 3000 3000

3 3

3 3

3 3
```

### 输出

```
3
```

## 样例 #3

### 输入

```
10 8 8

2 2

2 3

2 2

1 2

2 3

1 2

3 3

3 2

3 1

3 2
```

### 输出

```
9
```



---

---
title: "[AGC043A] Range Flip Find Route"
layout: "post"
diff: 普及/提高-
pid: AT_agc043_a
tag: ['动态规划 DP', '广度优先搜索 BFS']
---

# [AGC043A] Range Flip Find Route

## 题目描述

[problemUrl]: https://atcoder.jp/contests/agc043/tasks/agc043_a

$ H $ 行 $ W $ 列のマス目を考えます。上から $ r $ 番目、左から $ c $ 番目のマスを $ (r,\ c) $ と表すことにします。 全てのマスはそれぞれ白か黒のどちらかの色に塗られています。

次のような経路が存在するとき、このマス目を"良い"状態と呼びます。

- 常に白いマスの上にいながら、$ (1,\ 1) $ から、一つ **右か下** のマスに移動することを繰り返し、 $ (H,\ W) $ へ移動する。

ここで、"良い"状態ならば $ (1,\ 1) $ や $ (H,\ W) $ が必ず白いことに注意してください。

あなたの仕事は、以下の操作を繰り返し、マス目を"良い"状態にすることです。最小で何回操作を行う必要があるか求めてください。なお、有限回の操作で必ず"良い"状態に出来ることが証明可能です。

- $ 4 $ つの整数 $ r_0,\ c_0,\ r_1,\ c_1(1\ \leq\ r_0\ \leq\ r_1\ \leq\ H,\ 1\ \leq\ c_0\ \leq\ c_1\ \leq\ W) $ を選ぶ。$ r_0\ \leq\ r\ \leq\ r_1,\ c_0\ \leq\ c\ \leq\ c_1 $ を満たす全ての $ r,\ c $ について、$ (r,\ c) $ の色を変更する。つまり、白色ならば黒色にし、黒色ならば白色にする。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ H $ $ W $ $ s_{11}\ s_{12}\ \cdots\ s_{1W} $ $ s_{21}\ s_{22}\ \cdots\ s_{2W} $ $ \vdots $ $ s_{H1}\ s_{H2}\ \cdots\ s_{HW} $

ここで、$ s_{rc} $ は `#` か `.` であり、`#` は $ (r,\ c) $ が黒色、`.` は白色であることを表す。

## 输出格式

最小の操作回数を出力せよ。

## 说明/提示

### 制約

- $ 2\ \leq\ H,\ W\ \leq\ 100 $

### Sample Explanation 1

$ (r_0,\ c_0,\ r_1,\ c_1)\ =\ (2,\ 2,\ 2,\ 2) $、つまりマス $ (2,\ 2) $ のみ色を変更すれば良いです。

### Sample Explanation 3

操作が必要ない場合も存在します。

## 样例 #1

### 输入

```
3 3

.##

.#.

##.
```

### 输出

```
1
```

## 样例 #2

### 输入

```
2 2

#.

.#
```

### 输出

```
2
```

## 样例 #3

### 输入

```
4 4

..##

#...

###.

###.
```

### 输出

```
0
```

## 样例 #4

### 输入

```
5 5

.#.#.

#.#.#

.#.#.

#.#.#

.#.#.
```

### 输出

```
4
```



---

---
title: "[ARC166B] Make Multiples"
layout: "post"
diff: 普及/提高-
pid: AT_arc166_b
tag: ['动态规划 DP', '数学', '数论', '标签464']
---

# [ARC166B] Make Multiples

## 题目描述

[problemUrl]: https://atcoder.jp/contests/arc166/tasks/arc166_b

整数列 $ A=(A_1,\ldots,A_N) $ および，正整数 $ a,b,c $ が与えられます．

あなたはこの数列に対して，以下の操作を（$ 0 $ 回を含め）何回でも行うことができます．

- $ 1\leq\ i\leq\ N $ となる整数 $ i $ をひとつ選ぶ．$ A_i $ を $ A_i+1 $ で置き換える．
 
あなたの目的は，数列 $ A $ の中に，$ a $ の倍数，$ b $ の倍数，$ c $ の倍数がいずれもひとつ以上存在するようにすることです． 目的を達成するために必要な操作回数の最小値を求めてください．

## 输入格式

入力は以下の形式で標準入力から与えられます．

> $ N $ $ a $ $ b $ $ c $ $ A_1 $ $ \cdots $ $ A_N $

## 输出格式

目的を達成するために必要な操作回数の最小値を出力してください．

## 说明/提示

### 制約

- $ 1\leq\ N\leq\ 2\times\ 10^5 $
- $ 1\leq\ a,\ b,\ c\ \leq\ 10^6 $
- $ 1\leq\ A_i\leq\ 10^{18} $
 
### Sample Explanation 1

操作を $ 2 $ 回行い $ A\ =\ (8,10,12) $ とすることで目的を達成できます．

### Sample Explanation 2

操作を $ 1 $ 回行い $ A\ =\ (14,11,60) $ とすることで目的を達成できます．

### Sample Explanation 3

操作を $ 3 $ 回行い $ A\ =\ (8,17,5,30,40,13) $ とすることで目的を達成できます．

### Sample Explanation 4

操作を $ 876537210887543205 $ 回行い $ A\ =\ (999994000010999994) $ とすることで目的を達成できます．

## 样例 #1

### 输入

```
3 3 4 5

8 9 11
```

### 输出

```
2
```

## 样例 #2

### 输入

```
3 3 4 5

14 11 59
```

### 输出

```
1
```

## 样例 #3

### 输入

```
6 10 20 30

8 17 5 28 39 13
```

### 输出

```
3
```

## 样例 #4

### 输入

```
1 999997 999998 999999

123456789123456789
```

### 输出

```
876537210887543205
```



---

---
title: "LIS"
layout: "post"
diff: 普及/提高-
pid: AT_chokudai_S001_h
tag: ['线段树', '树状数组', '动态规划优化']
---

# LIS

## 题目描述

[problemUrl]: https://atcoder.jp/contests/chokudai_S001/tasks/chokudai_S001_h

数列 $ a $ から好きな整数を好きなだけ取り除き、単調増加な数列を作るとき、その数列の長さの最大値を求めなさい。

## 说明/提示

### 制約

- $ 1\ \leq\ N\ \leq\ 100,000 $

## 样例 #1

### 输入

```
5

3 1 5 4 2
```

### 输出

```
2
```

## 样例 #2

### 输入

```
6

1 2 3 4 5 6
```

### 输出

```
6
```

## 样例 #3

### 输入

```
7

7 6 5 4 3 2 1
```

### 输出

```
1
```

## 样例 #4

### 输入

```
20

19 11 10 7 8 9 17 18 20 4 3 15 16 1 5 14 6 2 13 12
```

### 输出

```
6
```



---

---
title: "haruki の覚醒め"
layout: "post"
diff: 普及/提高-
pid: AT_code_festival_relay_g
tag: ['动态规划 DP', '枚举', '背包 DP']
---

# haruki の覚醒め

## 题目描述

[problemUrl]: https://atcoder.jp/contests/code-festival-2014-relay/tasks/code_festival_relay_g

haruki さんは朝に弱いことで有名です。haruki さんの家には目覚まし時計が $ n $ 個あり、$ i $ 番目の目覚まし時計の音量は $ a_i $ です。

   
haruki さんは鳴っている目覚まし時計の音量の合計が $ m $ 以上にならない限り、目を覚ますことはありません。しかしながら、必要以上に目覚まし時計をセットすると、うるさくて近所迷惑になってしまいます。

   
そこで、合計の音量が $ m $ 以上でかつ最小となるように目覚まし時計を選んだとき、その合計の音量を求めてください。

## 输入格式

入力は以下の形式で与えられる。

> $ n $ $ m $ $ a_1 $ $ a_2 $ $ ... $ $ a_n $

- $ 1 $ 行目には、目覚まし時計の数を表す整数 $ n $ ($ 1\ \leq\ n\ \leq\ 50 $) と、目を覚ます最小の音量を表す整数 $ m $ ($ 1\ \leq\ m\ \leq\ 10{,}000 $) が与えられる。
- 続く $ n $ 行には、それぞれの目覚まし時計の音量を表す整数 $ a_i $ ($ 1\ \leq\ a_i\ \leq\ 10{,}000 $) が与えられる。

## 输出格式

合計の音量が $ m $ 以上でかつ最小となるときの合計の音量を $ 1 $ 行で出力せよ。

また、合計の音量が $ m $ に達しない場合は、`-1` を $ 1 $ 行で出力せよ。

最後は改行し、余計な文字、空行を含まないこと。

## 样例 #1

### 输入

```
3 30

25

10

23
```

### 输出

```
33
```

## 样例 #2

### 输入

```
4 101

10

20

30

40
```

### 输出

```
-1
```



---

---
title: "Vacation"
layout: "post"
diff: 普及/提高-
pid: AT_dp_c
tag: ['动态规划 DP']
---

# Vacation

## 题目描述

暑假有 $N$ 天。对于每一天 $i$（$1 \leq i \leq N$），太郎君可以选择以下活动之一：

- A：在海里游泳，获得幸福度 $a _ i$。
- B：在山上抓虫，获得幸福度 $b _ i$。
- C：在家做作业，获得幸福度 $c _ i$。

由于太郎君容易厌倦，他不能连续两天及以上做同样的活动。

请计算太郎君可以获得的最大总幸福度。

## 输入格式

输入以以下格式从标准输入中提供：

> $N$  
> $a _ 1$ $b _ 1$ $c _ 1$  
> $a _ 2$ $b _ 2$ $c _ 2$  
> $\ldots$  
> $a _ N$ $b _ N$ $c _ N$

## 输出格式

输出太郎君可以获得的最大总幸福度。

### 限制条件

- 所有输入均为整数。
- $1 \leq N \leq 10 ^ 5$
- $1 \leq a _ i, b _ i, c _ i \leq 10 ^ 4$

### 样例解释 1

按顺序选择活动 C, B, C，可以获得的总幸福度为 $70 + 50 + 90 = 210$。

### 样例解释 3

按顺序选择活动 C, A, B, A, C, B, A 可以获得最大总幸福度。

---

Translated by User 735713.

## 样例 #1

### 输入

```
3

10 40 70

20 50 80

30 60 90
```

### 输出

```
210
```

## 样例 #2

### 输入

```
1

100 10 1
```

### 输出

```
100
```

## 样例 #3

### 输入

```
7

6 7 8

8 8 3

2 5 2

7 8 6

4 6 8

2 3 4

7 5 1
```

### 输出

```
46
```



---

---
title: "Neutralize"
layout: "post"
diff: 普及/提高-
pid: AT_soundhound2018_summer_final_b
tag: ['动态规划 DP']
---

# Neutralize

## 题目描述

[problemUrl]: https://atcoder.jp/contests/soundhound2018-summer-final/tasks/soundhound2018_summer_final_b

$ N $ 個の薬品が横一列に並んでいます。それぞれの薬品には *効用* という整数値が定まっており、左から $ i $ 番目の薬品の現在の効用は $ b_i $ です。これらの値は正とは限りません。

Kenkoooo さんは、横長の特殊な装置を用いて次の操作を何回でも行えます（行わなくても構いません）。

- 連続して並ぶ $ K $ 個の薬品を選ぶ。選ばれた薬品の効用はすべて $ 0 $ となる。

なお、薬品を移動させることは危険を伴うためできません。

その後、Kenkoooo さんは $ N $ 個の薬品すべてを飲み干します。その前に、$ N $ 個の薬品の効用の和を可能な限り大きくしておきたいです。操作後のこの和の最大値を求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ K $ $ b_1 $ $ : $ $ b_N $

## 输出格式

操作後の $ N $ 個の薬品の効用の和の最大値を出力せよ。

## 说明/提示

### 制約

- $ 1\ <\ =\ K\ <\ =\ N\ <\ =\ 2\ ×\ 10^5 $
- $ -10^9\ <\ =\ b_i\ <\ =\ 10^9 $
- 入力中の値はすべて整数である。

### Sample Explanation 1

最適な手順の例を示します。 - $ 1 $ 回目の操作: 左から $ 1,\ 2,\ 3 $ 番目の薬品を選ぶ。 - $ 2 $ 回目の操作: 左から $ 6,\ 7,\ 8 $ 番目の薬品を選ぶ。 - $ 3 $ 回目の操作: 左から $ 7,\ 8,\ 9 $ 番目の薬品を選ぶ。 このとき、$ 9 $ 個の薬品の効用の和は $ 0\ +\ 0\ +\ 0\ +\ 4\ +\ 5\ +\ 0\ +\ 0\ +\ 0\ +\ 0\ =\ 9 $ となります。

### Sample Explanation 2

何もせずこのまま薬品を飲み干すべきです。

## 样例 #1

### 输入

```
9 3

-1

-2

-3

4

5

-6

-7

-8

-9
```

### 输出

```
9
```

## 样例 #2

### 输入

```
5 4

-1

-1

5

-1

-1
```

### 输出

```
1
```

## 样例 #3

### 输入

```
9 5

30

-20

40

60

-90

50

-40

10

70
```

### 输出

```
120
```

## 样例 #4

### 输入

```
10 1

1000000000

-1000000000

1000000000

-1000000000

1000000000

-1000000000

1000000000

-1000000000

1000000000

-1000000000
```

### 输出

```
5000000000
```



---

---
title: "ゲーム"
layout: "post"
diff: 普及/提高-
pid: AT_tdpc_game
tag: ['动态规划 DP']
---

# ゲーム

## 题目描述

Alice 和 Bob 在玩游戏。初始时有两座山，左边的山上有 $A$ 个物品，从上到下的第 $i$ 个价值为 $a_i$；右边的山上有 $B$ 个物品，从上到下的第 $i$ 个价值为 $b_i$。Alice 先手，Alice 和 Bob 交替进行操作，可行的操作如下：

- 如果两座山都空了，游戏结束。
- 如果只有某一座山空了，取走另一座山上的最上面的物品。
- 如果两座山都没有空，选择任意一座山，并取走其最上面的物品。

假设两人都采取最优策略，请求出 Alice 能取得的物品的价值总和。

## 输入格式

第一行共两个整数 $A$ 和 $B$，分别表示两座山的物品个数。

第二行共 $A$ 个整数，相邻两数间用一个空格隔开，第 $i$ 个整数为 $a_i$，表示左边的山第 $i$ 个物品的价值。

第三行共 $B$ 个整数，相邻两数间用一个空格隔开，第 $i$ 个整数为 $b_i$，表示右边的山第 $i$ 个物品的价值。

## 输出格式

输出共一行一个整数，表示两人都采取最优策略下 Alice 能取得的物品的价值总和。

## 说明/提示

- $1 \le A, B \le 1000$
- $1 \le a_i, b_i \le 1000$



---


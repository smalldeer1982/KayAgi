---
title: "[ABC320D] Relative Position"
layout: "post"
diff: 普及/提高-
pid: AT_abc320_d
tag: ['图遍历']
---

# [ABC320D] Relative Position

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc320/tasks/abc320_d

座標平面上に $ 1 $ から $ N $ の番号がついた $ N $ 人の人がいます。  
 人 $ 1 $ は原点にいます。

次の形式の情報が $ M $ 個与えられます。

- 人 $ A_i $ から見て、人 $ B_i $ は、$ x $ 軸正方向に $ X_i $、$ y $ 軸正方向に $ Y_i $ 離れた位置にいる
 
それぞれの人がいる座標を求めてください。一意に定まらないときはそのことを報告してください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ M $ $ A_1 $ $ B_1 $ $ X_1 $ $ Y_1 $ $ \vdots $ $ A_M $ $ B_M $ $ X_M $ $ Y_M $

## 输出格式

$ N $ 行出力せよ。  
 人 $ i $ のいる座標が一意に定まらないとき、$ i $ 行目には `undecidable` と出力せよ。  
 人 $ i $ のいる座標が $ (s_i,t_i) $ と一意に定まるとき、$ i $ 行目には $ s_i,t_i $ をこの順に空白区切りで出力せよ。

## 说明/提示

### 制約

- $ 1\ \leq\ N\ \leq\ 2\times\ 10^5 $
- $ 0\ \leq\ M\ \leq\ 2\times\ 10^5 $
- $ 1\leq\ A_i,\ B_i\ \leq\ N $
- $ A_i\ \neq\ B_i $
- $ -10^9\ \leq\ X_i,Y_i\ \leq\ 10^9 $
- 入力は全て整数である
- 与えられる情報は矛盾しない
 
### Sample Explanation 1

$ 3 $ 人の位置関係は下図のようになっています。 !\[図\](https://img.atcoder.jp/abc320/787d69ac49af24e80723e88b4f954f44.png)

### Sample Explanation 2

$ 3 $ 人の位置関係は下図のようになっています。 !\[図\](https://img.atcoder.jp/abc320/5dde7e83dd268b5b5fc322ddcb44eb86.png)

### Sample Explanation 3

同じ情報が複数回与えられたり、同じ座標に複数の人がいることもあります。

## 样例 #1

### 输入

```
3 2

1 2 2 1

1 3 -1 -2
```

### 输出

```
0 0

2 1

-1 -2
```

## 样例 #2

### 输入

```
3 2

2 1 -2 -1

2 3 -3 -3
```

### 输出

```
0 0

2 1

-1 -2
```

## 样例 #3

### 输入

```
5 7

1 2 0 0

1 2 0 0

2 3 0 0

3 1 0 0

2 1 0 0

3 2 0 0

4 5 0 0
```

### 输出

```
0 0

0 0

0 0

undecidable

undecidable
```



---

---
title: "[ABC328E] Modulo MST"
layout: "post"
diff: 普及/提高-
pid: AT_abc328_e
tag: ['图遍历', '生成树']
---

# [ABC328E] Modulo MST

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc328/tasks/abc328_e

頂点に $ 1 $ から $ N $ の番号が、辺に $ 1 $ から $ M $ の番号がついた $ N $ 頂点 $ M $ 辺の重み付き単純連結無向グラフと正整数 $ K $ が与えられます。  
辺 $ i\ (1\leq\ i\leq\ M) $ は頂点 $ u\ _\ i $​ と頂点 $ v\ _\ i $ を結んでおり、重みは $ w\ _\ i $ です。

このグラフの全域木 $ T $ に対して、$ T $ のコストを $ T $ に含まれる辺の重みの総和を $ K $ で割ったあまりで定めます。 このグラフの全域木のコストの最小値を求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ M $ $ K $ $ u\ _\ 1 $ $ v\ _\ 1 $ $ w\ _\ 1 $ $ u\ _\ 2 $ $ v\ _\ 2 $ $ w\ _\ 2 $ $ \vdots $ $ u\ _\ M $ $ v\ _\ M $ $ w\ _\ M $

## 输出格式

答えを出力せよ。

## 说明/提示

### 制約

- $ 2\leq\ N\leq8 $
- $ N-1\leq\ M\leq\dfrac{N(N-1)}2 $
- $ 1\leq\ K\leq10^{15} $
- $ 1\leq\ u\ _\ i\lt\ v\ _\ i\leq\ N\ (1\leq\ i\leq\ M) $
- $ 0\leq\ w\ _\ i\lt\ K\ (1\leq\ i\leq\ M) $
- 与えられるグラフは単純かつ連結
- 入力はすべて整数

### Sample Explanation 1

与えられるグラフは次のようになります。 !\[\](https://img.atcoder.jp/abc328/67d2cc2b93ec47687a733cd379c3c07c.png) 辺 $ 1,3,5,6 $ の $ 4 $ 本を含む全域木のコストは $ (99+86+81+95)\bmod{328}=361\bmod{328}=33 $ となります。 このグラフの全域木のコストはすべて $ 33 $ 以上であるため、$ 33 $ を出力してください。

### Sample Explanation 2

このグラフのただ一つの全域木のコスト $ 325437688 $ を出力してください。

### Sample Explanation 3

入力や答えが $ 32\operatorname{bit} $ 整数に収まらない場合があることに注意してください。

## 样例 #1

### 输入

```
5 6 328
1 2 99
1 3 102
2 3 86
2 4 94
2 5 95
3 4 81
```

### 输出

```
33
```

## 样例 #2

### 输入

```
6 5 998244353
1 2 337361568
1 6 450343304
2 3 61477244
2 5 745383438
4 5 727360840
```

### 输出

```
325437688
```

## 样例 #3

### 输入

```
8 28 936294041850197
1 2 473294720906780
1 3 743030800139244
1 4 709363019414774
1 5 383643612490312
1 6 557102781022861
1 7 623179288538138
1 8 739618599410809
2 3 857687812294404
2 4 893923168139714
2 5 581822471860662
2 6 740549363586558
2 7 307226438833222
2 8 447399029952998
3 4 636318083622768
3 5 44548707643622
3 6 307262781240755
3 7 12070267388230
3 8 700247263184082
4 5 560567890325333
4 6 704726113717147
4 7 588263818615687
4 8 549007536393172
5 6 779230871080408
5 7 825982583786498
5 8 713928998174272
6 7 751331074538826
6 8 449873635430228
7 8 11298381761479
```

### 输出

```
11360716373
```



---

---
title: "[ABC373D] Hidden Weights"
layout: "post"
diff: 普及/提高-
pid: AT_abc373_d
tag: ['搜索', '图遍历']
---

# [ABC373D] Hidden Weights

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc373/tasks/abc373_d

$ N $ 頂点 $ M $ 辺の有向グラフが与えられます。$ j $ 番目の有向辺は頂点 $ u_j $ から頂点 $ v_j $ に向かっており、重み $ w_j $ を持っています。

各頂点に $ -10^{18} $ 以上 $ 10^{18} $ 以下の整数を書き込む方法であって、次の条件を満たすものを $ 1 $ つ見つけてください。

- 頂点 $ i $ に書き込まれている値を $ x_i $ とする。すべての辺 $ j=1,2,\dots,M $ について、$ x_{v_j}\ -\ x_{u_j}\ =\ w_j $ が成り立つ。

与えられる入力について、条件を満たす書き込み方が少なくとも $ 1 $ つ存在することが保証されます。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ M $ $ u_1 $ $ v_1 $ $ w_1 $ $ u_2 $ $ v_2 $ $ w_2 $ $ \vdots $ $ u_M $ $ v_M $ $ w_M $

## 输出格式

頂点 $ i $ に書き込む整数を $ x_i $ として、$ x_1,x_2,\dots,x_N $ をこの順に空白区切りで $ 1 $ 行で出力せよ。答えが複数ある場合、どれを出力しても良い。

## 说明/提示

### 制約

- $ 2\ \leq\ N\ \leq\ 2\ \times\ 10^5 $
- $ 1\ \leq\ M\ \leq\ \min\{2\ \times\ 10^5,N(N-1)/2\} $
- $ 1\ \leq\ u_j,\ v_j\ \leq\ N $
- $ u_j\ \neq\ v_j $
- $ i\ \neq\ j $ なら $ (u_i,v_i)\ \neq\ (u_j,v_j) $ かつ $ (u_i,v_i)\ \neq\ (v_j,u_j) $
- $ |w_j|\ \leq\ 10^9 $
- 入力はすべて整数
- 条件を満たす書き込み方が少なくとも $ 1 $ つ存在する

### Sample Explanation 1

$ x=(3,5,2) $ とすることで、$ x_2-x_1=w_1=2,x_2-x_3=w_2=3,x_3-x_1=w_3=-1 $ となり、条件を満たします。 他にも、たとえば $ x=(-1,1,-2) $ としても正解となります。

### Sample Explanation 2

他にも、たとえば $ x=(0,-5,4,1) $ や $ x=(5,0,4,1) $ としても正解となります。

## 样例 #1

### 输入

```
3 3
1 2 2
3 2 3
1 3 -1
```

### 输出

```
3 5 2
```

## 样例 #2

### 输入

```
4 2
2 1 5
3 4 -3
```

### 输出

```
5 0 6 3
```

## 样例 #3

### 输入

```
5 7
2 1 18169343
3 1 307110901
4 1 130955934
2 3 -288941558
2 5 96267410
5 3 -385208968
4 3 -176154967
```

### 输出

```
200401298 182231955 -106709603 69445364 278499365
```



---

---
title: "[ABC376D] Cycle"
layout: "post"
diff: 普及/提高-
pid: AT_abc376_d
tag: ['搜索', '广度优先搜索 BFS', '图遍历']
---

# [ABC376D] Cycle

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc376/tasks/abc376_d

頂点に $ 1 $ から $ N $ の番号がついた $ N $ 頂点 $ M $ 辺の単純有向グラフがあります。$ i $ 番目の辺 $ (1\ \leq\ i\ \leq\ M) $ は頂点 $ a_i $ から頂点 $ b_i $ へ伸びる辺です。  
 頂点 $ 1 $ を含む閉路が存在するか判定して、存在する場合はそのような閉路のうち辺数が最小の閉路の辺数を求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ M $ $ a_1 $ $ b_1 $ $ a_2 $ $ b_2 $ $ \vdots $ $ a_M $ $ b_M $

## 输出格式

頂点 $ 1 $ を含む閉路が存在する場合は、そのような閉路のうち辺数が最小の閉路の辺数を出力せよ。そうでない場合は `-1` を出力せよ。

## 说明/提示

### 制約

- $ 2\ \leq\ N\ \leq\ 2\ \times\ 10^5 $
- $ 1\ \leq\ M\ \leq\ \min\ \left(\ \frac{N(N-1)}{2},\ 2\ \times\ 10^5\ \right) $
- $ 1\ \leq\ a_i\ \leq\ N $
- $ 1\ \leq\ b_i\ \leq\ N $
- $ a_i\ \neq\ b_i $
- $ i\ \neq\ j $ ならば $ (a_i,\ b_i)\ \neq\ (a_j,\ b_j) $ かつ $ (a_i,\ b_i)\ \neq\ (b_j,\ a_j) $
- 入力される値は全て整数
 
### Sample Explanation 1

頂点 $ 1 $ $ \to $ 頂点 $ 2 $ $ \to $ 頂点 $ 3 $ $ \to $ 頂点 $ 1 $ は辺数が $ 3 $ の閉路で、これが頂点 $ 1 $ を含む唯一の閉路です。

## 样例 #1

### 输入

```
3 3

1 2

2 3

3 1
```

### 输出

```
3
```

## 样例 #2

### 输入

```
3 2

1 2

2 3
```

### 输出

```
-1
```

## 样例 #3

### 输入

```
6 9

6 1

1 5

2 6

2 1

3 6

4 2

6 4

3 5

5 4
```

### 输出

```
4
```



---


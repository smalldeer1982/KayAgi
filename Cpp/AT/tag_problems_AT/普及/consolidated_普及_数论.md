---
title: "[ABC281D] Max Multiple"
layout: "post"
diff: 普及/提高-
pid: AT_abc281_d
tag: ['动态规划 DP', '数论']
---

# [ABC281D] Max Multiple

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc281/tasks/abc281_d

非負整数列 $ A=(a_1,a_2,\ldots,a_N) $ が与えられます。

$ A $ の(添え字が相異なる) $ K $ 個の項の和として考えられる非負整数の集合を $ S $ とします。

$ S $ に含まれる $ D $ の倍数の最大値を求めてください。ただし、$ S $ に $ D $ の倍数が含まれない場合、代わりに `-1` と出力してください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ K $ $ D $ $ a_1 $ $ \ldots $ $ a_N $

## 输出格式

答えを出力せよ。

## 说明/提示

### 制約

- $ 1\ \leq\ K\ \leq\ N\ \leq\ 100 $
- $ 1\ \leq\ D\ \leq\ 100 $
- $ 0\ \leq\ a_i\ \leq\ 10^9 $
- 入力はすべて整数
 
### Sample Explanation 1

$ A $ から $ 2 $ 個の項を選ぶ方法を列挙すると - $ a_1 $ と $ a_2 $ を選ぶ。選ばれた項の和は $ 1+2=3 $ となる。 - $ a_1 $ と $ a_3 $ を選ぶ。選ばれた項の和は $ 1+3=4 $ となる。 - $ a_1 $ と $ a_4 $ を選ぶ。選ばれた項の和は $ 1+4=5 $ となる。 - $ a_2 $ と $ a_3 $ を選ぶ。選ばれた項の和は $ 2+3=5 $ となる。 - $ a_2 $ と $ a_4 $ を選ぶ。選ばれた項の和は $ 2+4=6 $ となる。 - $ a_3 $ と $ a_4 $ を選ぶ。選ばれた項の和は $ 3+4=7 $ となる。 となり、$ S=\{3,4,5,6,7\} $ となります。$ S $ に含まれる $ 2 $ の倍数のうち最大のものは $ 6 $ なので、$ 6 $ と出力します。

### Sample Explanation 2

この例では $ S=\{1,3,5\} $ です。$ S $ に含まれる非負整数はいずれも $ 2 $ の倍数でないため、`-1` と出力します。

## 样例 #1

### 输入

```
4 2 2

1 2 3 4
```

### 输出

```
6
```

## 样例 #2

### 输入

```
3 1 2

1 3 5
```

### 输出

```
-1
```



---

---
title: "[ABC367D] Pedometer"
layout: "post"
diff: 普及/提高-
pid: AT_abc367_d
tag: ['数论', '前缀和']
---

# [ABC367D] Pedometer

## 题目描述

一个湖泊周围有 $N$ 个休憩所。这些休憩所按顺时针方向被标记为 $1, 2, \ldots, N$。从休憩所 $i$ 到休憩所 $i+1$（其中休憩所 $N+1$ 指的是休憩所 $1$）顺时针行走需要 $A_i$ 步。已知从某个休憩所 $s$ 到另一个不同的休憩所 $t$ 顺时针行走的最短步数是 $M$ 的倍数。我们需要计算所有可能的 $(s,t)$ 组合的数量。

## 输入格式

输入数据以以下格式从标准输入给出：

> $N$ $M$ $A_1$ $A_2$ $\ldots$ $A_N$

## 输出格式

输出答案作为一个整数。

## 说明/提示

#### 制约条件

- 所有输入数据都是整数。
- $2 \le N \le 2 \times 10^5$
- $1 \le A_i \le 10^9$
- $1 \le M \le 10^6$

#### 示例解释 1

- 从休憩所 $1$ 到休憩所 $2$ 顺时针行走的最短步数是 $2$ 步，这不是 $3$ 的倍数。
- 从休憩所 $1$ 到休憩所 $3$ 顺时针行走的最短步数是 $3$ 步，这是 $3$ 的倍数。
- 从休憩所 $1$ 到休憩所 $4$ 顺时针行走的最短步数是 $7$ 步，这不是 $3$ 的倍数。
- 从休憩所 $2$ 到休憩所 $3$ 顺时针行走的最短步数是 $1$ 歩，这不是 $3$ 的倍数。
- 从休憩所 $2$ 到休憩所 $4$ 顺时针行走的最短步数是 $5$ 步，这不是 $3$ 的倍数。
- 从休憩所 $2$ 回到休憩所 $1$ 顺时针行走的最短步数是 $8$ 步，这不是 $3$ 的倍数。
- 从休憩所 $3$ 到休憩所 $4$ 顺时针行走的最短步数是 $4$ 步，这不是 $3$ 的倍数。
- 从休憩所 $3$ 回到休憩所 $1$ 顺时针行走的最短步数是 $7$ 步，这不是 $3$ 的倍数。
- 从休憩所 $3$ 回到休憩所 $2$ 顺时针行走的最短步数是 $9$ 步，这是 $3$ 的倍数。
- 从休憩所 $4$ 回到休憩所 $1$ 顺时针行走的最短步数是 $3$ 步，这是 $3$ 的倍数。
- 从休憩所 $4$ 回到休憩所 $2$ 顺时针行走的最短步数是 $5$ 步，这不是 $3$ 的倍数。
- 从休憩所 $4$ 回到休憩所 $3$ 顺时针行走的最短步数是 $6$ 步，这是 $3$ 的倍数。

因此，符合条件的 $(s,t)$ 组合数量为 $4$。

## 样例 #1

### 输入

```
4 3

2 1 4 3
```

### 输出

```
4
```

## 样例 #2

### 输入

```
2 1000000

1 1
```

### 输出

```
0
```

## 样例 #3

### 输入

```
9 5

9 9 8 2 4 4 3 5 3
```

### 输出

```
11
```



---

---
title: "[ABC383D] 9 Divisors"
layout: "post"
diff: 普及/提高-
pid: AT_abc383_d
tag: ['数论', '素数判断,质数,筛法']
---

# [ABC383D] 9 Divisors

## 题目描述

找出不大于 $N$ 且恰好有 $9$ 个因数的正整数的个数。

## 输入格式

只有一行，一个整数 $N$。

## 输出格式

一行一个整数，表示答案。

## 说明/提示

- $1 \leq N \leq 4 \times 10^{12}$

- 所有输入值均为整数。

样例一解释：

三个正整数 $36,100,196$ 满足条件。

## 样例 #1

### 输入

```
200
```

### 输出

```
3
```

## 样例 #2

### 输入

```
4000000000000
```

### 输出

```
407073
```



---

---
title: "[ABC393E] GCD of Subset"
layout: "post"
diff: 普及/提高-
pid: AT_abc393_e
tag: ['数论']
---

# [ABC393E] GCD of Subset

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc393/tasks/abc393_e

给定一个长度为 $ N $ 的数列 $ A=(A_1,A_2,\dots,A_N) $ 和一个不超过 $ N $ 的正整数 $ K $。  
对于每个 $ i=1,2,\dots,N $，请解决以下问题：

- 从 $ A $ 中选出包含 $ A_i $ 的 $ K $ 个元素时，求这些元素的最大公约数 (GCD) 可能达到的最大值。

## 输入格式

输入通过标准输入给出，格式如下：

> $ N $ $ K $  
> $ A_1 $ $ A_2 $ $ \dots $ $ A_N $

## 输出格式

输出 $ N $ 行。第 $ j $ 行应输出 $ i=j $ 时的答案。

## 说明/提示

### 约束条件

- $ 1 \leq K \leq N \leq 1.2 \times 10^6 $
- $ 1 \leq A_i \leq 10^6 $
- 输入中所有值均为整数

### 样例解释 1

- 当 $ i=1 $ 时，选择 $ A_1 $ 和 $ A_3 $，最大公约数为 $\gcd(\{3, 6\}) = 3$，这是最大值。
- 当 $ i=2 $ 时，选择 $ A_2 $ 和 $ A_5 $，最大公约数为 $\gcd(\{4, 12\}) = 4$，这是最大值。
- 当 $ i=3 $ 时，选择 $ A_3 $ 和 $ A_5 $，最大公约数为 $\gcd(\{6, 12\}) = 6$，这是最大值。
- 当 $ i=4 $ 时，选择 $ A_4 $ 和 $ A_2 $，最大公约数为 $\gcd(\{7, 4\}) = 1$，这是最大值。
- 当 $ i=5 $ 时，选择 $ A_5 $ 和 $ A_3 $，最大公约数为 $\gcd(\{12, 6\}) = 6$，这是最大值。

翻译由 DeepSeek R1 完成

## 样例 #1

### 输入

```
5 2

3 4 6 7 12
```

### 输出

```
3

4

6

1

6
```

## 样例 #2

### 输入

```
3 3

6 10 15
```

### 输出

```
1

1

1
```

## 样例 #3

### 输入

```
10 3

414003 854320 485570 52740 833292 625990 909680 885153 435420 221663
```

### 输出

```
59

590

590

879

879

590

20

879

590

59
```



---

---
title: "[ARC166B] Make Multiples"
layout: "post"
diff: 普及/提高-
pid: AT_arc166_b
tag: ['动态规划 DP', '数学', '数论', '标签464']
---

# [ARC166B] Make Multiples

## 题目描述

[problemUrl]: https://atcoder.jp/contests/arc166/tasks/arc166_b

整数列 $ A=(A_1,\ldots,A_N) $ および，正整数 $ a,b,c $ が与えられます．

あなたはこの数列に対して，以下の操作を（$ 0 $ 回を含め）何回でも行うことができます．

- $ 1\leq\ i\leq\ N $ となる整数 $ i $ をひとつ選ぶ．$ A_i $ を $ A_i+1 $ で置き換える．
 
あなたの目的は，数列 $ A $ の中に，$ a $ の倍数，$ b $ の倍数，$ c $ の倍数がいずれもひとつ以上存在するようにすることです． 目的を達成するために必要な操作回数の最小値を求めてください．

## 输入格式

入力は以下の形式で標準入力から与えられます．

> $ N $ $ a $ $ b $ $ c $ $ A_1 $ $ \cdots $ $ A_N $

## 输出格式

目的を達成するために必要な操作回数の最小値を出力してください．

## 说明/提示

### 制約

- $ 1\leq\ N\leq\ 2\times\ 10^5 $
- $ 1\leq\ a,\ b,\ c\ \leq\ 10^6 $
- $ 1\leq\ A_i\leq\ 10^{18} $
 
### Sample Explanation 1

操作を $ 2 $ 回行い $ A\ =\ (8,10,12) $ とすることで目的を達成できます．

### Sample Explanation 2

操作を $ 1 $ 回行い $ A\ =\ (14,11,60) $ とすることで目的を達成できます．

### Sample Explanation 3

操作を $ 3 $ 回行い $ A\ =\ (8,17,5,30,40,13) $ とすることで目的を達成できます．

### Sample Explanation 4

操作を $ 876537210887543205 $ 回行い $ A\ =\ (999994000010999994) $ とすることで目的を達成できます．

## 样例 #1

### 输入

```
3 3 4 5

8 9 11
```

### 输出

```
2
```

## 样例 #2

### 输入

```
3 3 4 5

14 11 59
```

### 输出

```
1
```

## 样例 #3

### 输入

```
6 10 20 30

8 17 5 28 39 13
```

### 输出

```
3
```

## 样例 #4

### 输入

```
1 999997 999998 999999

123456789123456789
```

### 输出

```
876537210887543205
```



---

---
title: "[ARC167B] Product of Divisors"
layout: "post"
diff: 普及/提高-
pid: AT_arc167_b
tag: ['数论']
---

# [ARC167B] Product of Divisors

## 题目描述

[problemUrl]: https://atcoder.jp/contests/arc167/tasks/arc167_b

$ A^{B} $ の正の約数の総積は $ A $ で最大何回割り切れますか。

制約から割り切れる回数が有限回であることが示せるので、その答えを $ 998244353 $ で割ったあまりを求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられます。

> $ A $ $ B $

## 输出格式

答えを出力してください。

## 说明/提示

### 制約

- $ 2\leq\ A\leq\ 10^{12} $
- $ 0\leq\ B\leq\ 10^{18} $
- 入力は全て整数
 
### Sample Explanation 1

$ A^{B}=8 $ の正の約数は $ 1,2,4,8 $ で、その総積は $ 64 $ となります。 $ 64 $ は $ 2 $ で $ 6 $ 回割り切れるので、$ 6 $ を出力します。

## 样例 #1

### 输入

```
2 3
```

### 输出

```
6
```

## 样例 #2

### 输入

```
924 167
```

### 输出

```
867046524
```

## 样例 #3

### 输入

```
167167167167 0
```

### 输出

```
0
```



---


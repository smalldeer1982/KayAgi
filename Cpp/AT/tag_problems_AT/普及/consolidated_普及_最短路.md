---
title: "[ABC079D] Wall"
layout: "post"
diff: 普及/提高-
pid: AT_abc079_d
tag: ['图论', '最短路']
---

# [ABC079D] Wall

## 题目描述

## 【题目大意】

你面前有一堵墙，墙上有数字，你需要将墙上的数字都变成 ```1``` 。  
现在给出一个 $W\times H$ 的矩阵 $A$ 表示墙上数字的情况。  
其中若 $A_{i,j}=-1$ ，则表示位置 $(i,j)$ 上没有数字，否则 $A_{i,j}$ 的值表示墙上 $(i,j)$ 位置的数字。  
当然，你还有一张 $10\times 10$ 的表 $C$，其中 $C_{i,j}$ 表示把数字 $i$ 转化成数字 $j$ 所需要的花费。  
求花费的最小值。

## 输入格式

先输入两个数字 $H$ , $W$ 。  
接下来输入表 $C$。  
最后输入矩阵 $A$。

## 输出格式

一行，代表答案。

## 说明/提示

$1\le H,W\le200$  
$1\le C_{i,j}\le 10^3 (i\neq j)$  
$C_{i,j}=0(i=j)$  
$-1\le A_{i,j}\le 9$
所有数据保证在 ```int``` 范围以内。

## 样例 #1

### 输入

```
2 4

0 9 9 9 9 9 9 9 9 9

9 0 9 9 9 9 9 9 9 9

9 9 0 9 9 9 9 9 9 9

9 9 9 0 9 9 9 9 9 9

9 9 9 9 0 9 9 9 9 2

9 9 9 9 9 0 9 9 9 9

9 9 9 9 9 9 0 9 9 9

9 9 9 9 9 9 9 0 9 9

9 9 9 9 2 9 9 9 0 9

9 2 9 9 9 9 9 9 9 0

-1 -1 -1 -1

8 1 1 8
```

### 输出

```
12
```

## 样例 #2

### 输入

```
5 5

0 999 999 999 999 999 999 999 999 999

999 0 999 999 999 999 999 999 999 999

999 999 0 999 999 999 999 999 999 999

999 999 999 0 999 999 999 999 999 999

999 999 999 999 0 999 999 999 999 999

999 999 999 999 999 0 999 999 999 999

999 999 999 999 999 999 0 999 999 999

999 999 999 999 999 999 999 0 999 999

999 999 999 999 999 999 999 999 0 999

999 999 999 999 999 999 999 999 999 0

1 1 1 1 1

1 1 1 1 1

1 1 1 1 1

1 1 1 1 1

1 1 1 1 1
```

### 输出

```
0
```

## 样例 #3

### 输入

```
3 5

0 4 3 6 2 7 2 5 3 3

4 0 5 3 7 5 3 7 2 7

5 7 0 7 2 9 3 2 9 1

3 6 2 0 2 4 6 4 2 3

3 5 7 4 0 6 9 7 6 7

9 8 5 2 2 0 4 7 6 5

5 4 6 3 2 3 0 5 4 3

3 6 2 3 4 2 4 0 8 9

4 6 5 4 3 5 3 2 0 8

2 1 3 4 5 7 8 6 4 0

3 5 2 6 1

2 5 3 2 1

6 9 2 5 6
```

### 输出

```
47
```



---

---
title: "[ABC252E] Road Reduction"
layout: "post"
diff: 普及/提高-
pid: AT_abc252_e
tag: ['图论', '最短路', '生成树']
---

# [ABC252E] Road Reduction

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc252/tasks/abc252_e

AtCoder 王国には都市 $ 1,2,\ldots,N $ の $ N $ 個の都市と、道路 $ 1,2,\ldots,M $ の $ M $ 本の道路があります。  
道路 $ i $ は都市 $ A_i $ と $ B_i $ を双方向に結び、距離は $ C_i $ です。  
どの都市間もいくつかの道路を通って行き来することができます。

財政難である王国は、どの都市間もいくつかの道路を通って行き来できるという条件を満たすように $ N-1 $ 本の道路を保守し、それ以外の道路を廃道にすることにしました。

保守する道路のみを通って都市 $ 1 $ から都市 $ i $ へ移動するときの距離を $ d_i $ とするとき、保守する道路の選び方であって、$ d_2+d_3+\ldots+d_N $ を最小化するようなものを $ 1 $ つ出力してください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ M $ $ A_1 $ $ B_1 $ $ C_1 $ $ A_2 $ $ B_2 $ $ C_2 $ $ \vdots $ $ A_M $ $ B_M $ $ C_M $

## 输出格式

保守するような道路の番号を空白区切りで出力せよ。出力の順序は問わない。  
答えが複数存在する場合、どれを出力しても正解とみなされる。

## 说明/提示

### 制約

- $ 2\ \leq\ N\ \leq\ 2\times\ 10^5 $
- $ N-1\ \leq\ M\ \leq\ 2\times\ 10^5 $
- $ 1\ \leq\ A_i\ <\ B_i\ \leq\ N $
- $ i\neq\ j $ のとき、$ (A_i,B_i)\neq(A_j,B_j) $
- $ 1\leq\ C_i\ \leq\ 10^9 $
- どの都市間もいくつかの道路を通って行き来することができる
- 入力に含まれる値は全て整数である

### Sample Explanation 1

保守する道路の選び方と $ d_i $ の値は次のようになります。 - 道路 $ 1,2 $ を保守するとき、$ d_2=1 $, $ d_3=3 $ - 道路 $ 1,3 $ を保守するとき、$ d_2=1 $, $ d_3=10 $ - 道路 $ 2,3 $ を保守するとき、$ d_2=12 $, $ d_3=10 $ よって、道路 $ 1,2 $ を保守するときに $ d_2+d_3 $ が最小になります。

## 样例 #1

### 输入

```
3 3
1 2 1
2 3 2
1 3 10
```

### 输出

```
1 2
```

## 样例 #2

### 输入

```
4 6
1 2 1
1 3 1
1 4 1
2 3 1
2 4 1
3 4 1
```

### 输出

```
3 1 2
```



---

---
title: "[ABC286E] Souvenir"
layout: "post"
diff: 普及/提高-
pid: AT_abc286_e
tag: ['最短路']
---

# [ABC286E] Souvenir

## 题目描述

从前有 $n$ 座岛，每个岛上有 $a_i$ 个金币，各个岛间有若干条单向航线相连。

你从某个岛开始旅行，经过一个岛（包括最开始所在的岛）就会拿走上面的金币。

现在问你 $q$ 个问题：从岛 $u_i$ 旅行到岛 $v_i$，最少要走几条航线，以及恰好走这么多条航线最多能获得多少金币。如果根本无法到达 $v_i$，输出 `Impossible`。

询问之间相互独立。

## 输入格式

输入第一行一个整数 $n$ 表示岛的数量。

接下来一行 $n$ 个整数表示每个岛上的金币数。

接下来 $n$ 行每行一个长为 $n$ 的字符串，第 $i$ 行字符串的第 $j$ 个字符若为 `Y` 则表示岛 $i$ 和 $j$ 间有单向航线，否则表示没有。

接下来一行一个整数 $q$ 表示询问次数。

最后 $q$ 行每行两个整数 $u_i,v_i$，询问你从岛 $u_i$ 旅行到岛 $v_i$ 最少要走几条航线，以及恰好走这么多条航线最多能获得多少金币。

## 输出格式

对于每个询问输出一行：

- 若 $u_i$ 不能到达 $v_i$，输出 `Impossible`；
- 否则，输出从岛 $u_i$ 旅行到岛 $v_i$ 最少要走几条航线，以及恰好走这么多条航线最多能获得多少金币。

#### 样例解释 1

这些岛的结构如下：

![](https://cdn.luogu.com.cn/upload/image_hosting/61s6gh7q.png)

- 对于第 $1$ 个询问，因为岛 $1$ 有一条航线通往岛 $3$，显然最少航线为 $1$ 条，此时能拿到岛 $1$ 和岛 $3$ 上的金币共 $30+70=100$ 个。
- 对于第 $2$ 个询问，可以证明最少航线为 $2$ 条，有两种方案 $3 \rarr 4 \rarr 1$ 和 $3 \rarr 5 \rarr 1$，总金币分别为 $70+20+30=120$ 和 $70+60+30=160$，故最多金币为 $160$。
- 对于第 $3$ 个询问，只有一种方案 $4 \rarr 1 \rarr 3 \rarr 5$ 可以使航线数最少为 $3$，所得金币为 $20+30+70+60=180$。

#### 样例解释 2

笑死，连航线都没有。

#### 数据范围与约定

对于 $100\%$ 的数据，$2\le n\le 300,1\le a_i\le 10^9,1\le q\le n(n-1),1\le u_i,v_i\le n$，且询问中的 $u_i,v_i$ 各不相同。

翻译者：[not_Rick_Astley](https://www.luogu.com.cn/user/689673)

## 样例 #1

### 输入

```
5

30 50 70 20 60

NYYNN

NNYNN

NNNYY

YNNNN

YNNNN

3

1 3

3 1

4 5
```

### 输出

```
1 100

2 160

3 180
```

## 样例 #2

### 输入

```
2

100 100

NN

NN

1

1 2
```

### 输出

```
Impossible
```



---

---
title: "[ABC325E] Our clients, please wait a moment"
layout: "post"
diff: 普及/提高-
pid: AT_abc325_e
tag: ['枚举', '最短路']
---

# [ABC325E] Our clients, please wait a moment

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc325/tasks/abc325_e

ある国には都市が $ N $ 個あります。  
あなたは、都市 $ 1 $ にある営業所から $ 0 $ 個以上の都市を経由して都市 $ N $ にある訪問先へ移動しようとしています。  
移動手段は社用車と電車の $ 2 $ 種類があります。都市 $ i $ から都市 $ j $ へ移動するときの所要時間は以下の通りです。

- 社用車を使った場合 : $ D_{i,j}\ \times\ A $ 分
- 電車を使った場合 : $ D_{i,j}\ \times\ B\ +\ C $ 分

ただし、社用車から電車に乗り換えることはできますが、電車から社用車に乗り換えることはできません。  
また、乗り換えは各都市のみで行え、乗り換えに時間はかかりません。

都市 $ 1 $ から都市 $ N $ に移動するのにかかる時間は最短で何分ですか？

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ A $ $ B $ $ C $ $ D_{1,1} $ $ D_{1,2} $ $ \ldots $ $ D_{1,N} $ $ D_{2,1} $ $ D_{2,2} $ $ \ldots $ $ D_{2,N} $ $ \vdots $ $ D_{N,1} $ $ D_{N,2} $ $ \ldots $ $ D_{N,N} $

## 输出格式

答えを整数として出力せよ。

## 说明/提示

### 制約

- $ 2\ \leq\ N\ \leq\ 1000 $
- $ 1\ \leq\ A,\ B,\ C\ \leq\ 10^6 $
- $ D_{i,j}\ \leq\ 10^6 $
- $ D_{i,i}\ =\ 0 $
- $ D_{i,j}\ =\ D_{j,i}\ >\ 0 $ $ (i\ \neq\ j) $
- 入力される数値はすべて整数

### Sample Explanation 1

以下のように移動することで合計 $ 78 $ 分で都市 $ 1 $ から都市 $ 4 $ に移動することができます。 - 都市 $ 1 $ から都市 $ 3 $ まで社用車で移動する。この移動には $ 2\ \times\ 8\ =\ 16 $ 分かかる。 - 都市 $ 3 $ から都市 $ 2 $ まで社用車で移動する。この移動には $ 3\ \times\ 8\ =\ 24 $ 分かかる。 - 都市 $ 2 $ から都市 $ 4 $ まで電車で移動する。この移動には $ 5\ \times\ 5\ +\ 13\ =\ 38 $ 分かかる。 $ 78 $ 分未満の時間で都市 $ 1 $ から都市 $ 4 $ に移動することはできません。

## 样例 #1

### 输入

```
4 8 5 13
0 6 2 15
6 0 3 5
2 3 0 13
15 5 13 0
```

### 输出

```
78
```

## 样例 #2

### 输入

```
3 1 1000000 1000000
0 10 1
10 0 10
1 10 0
```

### 输出

```
1
```

## 样例 #3

### 输入

```
5 954257 954213 814214
0 84251 214529 10017 373342
84251 0 91926 32336 164457
214529 91926 0 108914 57762
10017 32336 108914 0 234705
373342 164457 57762 234705 0
```

### 输出

```
168604826785
```



---

---
title: "[ABC340D] Super Takahashi Bros."
layout: "post"
diff: 普及/提高-
pid: AT_abc340_d
tag: ['最短路']
---

# [ABC340D] Super Takahashi Bros.

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc340/tasks/abc340_d

高橋君はゲームをプレイしています。

ゲームは $ 1,2,\ldots,N $ の番号がついた $ N $ 個のステージからなり、現在はステージ $ 1 $ のみを遊ぶことができます。

各ステージ $ i $ ( $ 1\leq\ i\ \leq\ N-1 $ )が遊べるとき、ステージ $ i $ では以下の $ 2 $ つのどちらかの行動を行えます。

- $ A_i $ 秒掛けてステージ $ i $ をクリアする。ステージ $ i+1 $ を遊べるようになる。
- $ B_i $ 秒掛けてステージ $ i $ をクリアする。ステージ $ X_i $ を遊べるようになる。
 
各ステージをクリアするためにかかる時間以外は無視できるとき、ステージ $ N $ を遊べるようになるのは最短で何秒後ですか？

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ A_1 $ $ B_1 $ $ X_1 $ $ A_2 $ $ B_2 $ $ X_2 $ $ \vdots $ $ A_{N-1} $ $ B_{N-1} $ $ X_{N-1} $

## 输出格式

答えを出力せよ。

## 说明/提示

### 制約

- $ 2\ \leq\ N\ \leq\ 2\times\ 10^5 $
- $ 1\ \leq\ A_i,\ B_i\ \leq\ 10^9 $
- $ 1\ \leq\ X_i\ \leq\ N $
- 入力は全て整数
 
### Sample Explanation 1

次のように行動することで、$ 350 $ 秒でステージ $ 5 $ を遊べるようになります。 - $ 100 $ 秒掛けてステージ $ 1 $ をクリアし、ステージ $ 2 $ を遊べるようになる。 - $ 50 $ 秒掛けてステージ $ 2 $ をクリアし、ステージ $ 3 $ を遊べるようになる。 - $ 200 $ 秒掛けてステージ $ 3 $ をクリアし、ステージ $ 5 $ を遊べるようになる。

## 样例 #1

### 输入

```
5

100 200 3

50 10 1

100 200 5

150 1 2
```

### 输出

```
350
```

## 样例 #2

### 输入

```
10

1000 10 9

1000 10 10

1000 10 2

1000 10 3

1000 10 4

1000 10 5

1000 10 6

1000 10 7

1000 10 8
```

### 输出

```
90
```

## 样例 #3

### 输入

```
6

1000000000 1000000000 1

1000000000 1000000000 1

1000000000 1000000000 1

1000000000 1000000000 1

1000000000 1000000000 1
```

### 输出

```
5000000000
```



---

---
title: "[ABC362D] Shortest Path 3"
layout: "post"
diff: 普及/提高-
pid: AT_abc362_d
tag: ['最短路']
---

# [ABC362D] Shortest Path 3

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc362/tasks/abc362_d

$ N $ 頂点 $ M $ 辺の単純連結無向グラフが与えられます。頂点 $ i\,(1\leq\ i\ \leq\ N) $ は重み $ A_i $ を持ちます。また、辺 $ j\,(1\leq\ j\ \leq\ M) $ は頂点 $ U_j,V_j $ を双方向に結び、重み $ B_j $ を持ちます。

このグラフ上のパスの重みを、パス上に現れる頂点の重みと辺の重みの総和と定義します。

各 $ i=2,3,\dots,N $ について、以下の問題を解いてください。

- 頂点 $ 1 $ から頂点 $ i $ までのパスであって、重みが最小となるものの重みを求めよ。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ M $ $ A_1 $ $ A_2 $ $ \dots $ $ A_N $ $ U_1 $ $ V_1 $ $ B_1 $ $ U_2 $ $ V_2 $ $ B_2 $ $ \vdots $ $ U_M $ $ V_M $ $ B_M $

## 输出格式

$ i=2,3,\dots,N $ に対する答えを、この順に空白区切りで一行で出力せよ。

## 说明/提示

### 制約

- $ 2\ \leq\ N\ \leq\ 2\ \times\ 10^5 $
- $ N-1\ \leq\ M\ \leq\ 2\ \times\ 10^5 $
- $ 1\ \leq\ U_j\ <\ V_j\ \leq\ N $
- $ i\neq\ j $ なら $ (U_i,V_i)\ \neq\ (U_j,V_j) $
- グラフは連結である
- $ 0\ \leq\ A_i\ \leq\ 10^9 $
- $ 0\ \leq\ B_j\ \leq\ 10^9 $
- 入力はすべて整数
 
### Sample Explanation 1

頂点 $ 1 $ から頂点 $ 2 $ へのパスを考えます。 パス $ 1\ \to\ 2 $ の重みは $ A_1+B_1+A_2=1+1+2=4 $、パス $ 1\ \to\ 3\ \to\ 2 $ の重みは $ A_1+B_2+A_3+B_3+A_2=1+6+3+2+2=14 $ であり、最小の重みは $ 4 $ です。 頂点 $ 1 $ から頂点 $ 3 $ へのパスを考えます。 パス $ 1\ \to\ 3 $ の重みは $ A_1+B_2+A_3=1+6+3=10 $、パス $ 1\ \to\ 2\ \to\ 3 $ の重みは $ A_1+B_1+A_2+B_3+A_3=1+1+2+2+3=9 $ であり、最小の重みは $ 9 $ です。

### Sample Explanation 3

答えが 32-bit 整数に収まらないことがあることに注意してください。

## 样例 #1

### 输入

```
3 3

1 2 3

1 2 1

1 3 6

2 3 2
```

### 输出

```
4 9
```

## 样例 #2

### 输入

```
2 1

0 1

1 2 3
```

### 输出

```
4
```

## 样例 #3

### 输入

```
5 8

928448202 994752369 906965437 942744902 907560126

2 5 975090662

1 2 908843627

1 5 969061140

3 4 964249326

2 3 957690728

2 4 942986477

4 5 948404113

1 3 988716403
```

### 输出

```
2832044198 2824130042 4696218483 2805069468
```



---

---
title: "[ABC400D] Takahashi the Wall Breaker"
layout: "post"
diff: 普及/提高-
pid: AT_abc400_d
tag: ['图论', '广度优先搜索 BFS', '最短路']
---

# [ABC400D] Takahashi the Wall Breaker

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc400/tasks/abc400_d

高桥君想去鱼店买鳗鱼。

高桥君居住的城镇由 $H$ 行 $W$ 列的网格状区域构成，每个区域是道路或墙壁。  
以下，将从上往下第 $i$ 行（$1 \leq i \leq H$）、从左往右第 $j$ 列（$1 \leq j \leq W$）的区域表示为区域 $(i, j)$。  
各区域的信息由 $H$ 个长度为 $W$ 的字符串 $S_1, S_2, \ldots, S_H$ 给出。具体来说，当 $S_i$ 的第 $j$ 个字符（$1 \leq i \leq H$，$1 \leq j \leq W$）为 `.` 时，区域 $(i, j)$ 是道路；当为 `#` 时，区域 $(i, j)$ 是墙壁。

高桥君可以按任意顺序重复执行以下两种操作：

- 移动到上下左右相邻的、位于城镇内且为道路的区域。
- 选择一个上下左右方向，进行**前踢**。  
  当高桥君进行前踢时，可以将当前区域在该方向上 **前 1 格** 和 **前 2 格** 的区域（如果它们是墙壁）变为道路。  
  注意：即使前 1 格或前 2 格位于城镇外，仍然可以进行前踢操作，但城镇外的区域不会发生变化。

高桥君最初位于区域 $(A, B)$，想要到达位于区域 $(C, D)$ 的鱼店。  
保证高桥君初始所在的区域及鱼店所在的区域是道路。  
请计算高桥君到达鱼店所需的最小**前踢次数**。

## 输入格式

输入通过标准输入给出，格式如下：

> $H$ $W$  
> $S_1$  
> $S_2$  
> $\vdots$  
> $S_H$  
> $A$ $B$ $C$ $D$

## 输出格式

输出高桥君到达鱼店所需的最小**前踢次数**。


## 说明/提示

### 约束条件

- $1 \leq H \leq 1000$
- $1 \leq W \leq 1000$
- $S_i$ 是仅由 `.` 和 `#` 组成的长度为 $W$ 的字符串
- $1 \leq A, C \leq H$
- $1 \leq B, D \leq W$
- $(A, B) \neq (C, D)$
- $H, W, A, B, C, D$ 均为整数
- 高桥君初始所在的区域及鱼店所在的区域保证是道路

### 样例解释 1

高桥君最初位于区域 $(1, 1)$。通过反复移动到道路区域，可以到达区域 $(7, 4)$。在区域 $(7, 4)$ 向左方向进行前踢后，区域 $(7, 3)$ 和 $(7, 2)$ 会从墙壁变为道路。之后，通过反复移动（包括新变为道路的区域）即可到达位于区域 $(7, 1)$ 的鱼店。此时前踢次数为 $1$ 次，且无法在不使用前踢的情况下到达鱼店，因此输出 $1$。

### 样例解释 2

高桥君最初位于区域 $(1, 1)$。向右方向进行前踢后，区域 $(1, 2)$ 会从墙壁变为道路（向右前 2 格超出城镇范围，因此无变化）。之后可以从区域 $(1, 1)$ 移动到区域 $(1, 2)$，再到达区域 $(2, 2)$ 的鱼店。此时前踢次数为 $1$ 次，且无法在不使用前踢的情况下到达鱼店，因此输出 $1$。

### 样例解释 3

前踢操作可能影响包含鱼店所在区域的区画，但鱼店所在区域原本就是道路，因此不会发生变化。特别是前踢操作不会破坏鱼店。

翻译由 DeepSeek R1 完成

## 样例 #1

### 输入

```
10 10

..........

#########.

#.......#.

#..####.#.

##....#.#.

#####.#.#.

.##.#.#.#.

###.#.#.#.

###.#.#.#.

#.....#...

1 1 7 1
```

### 输出

```
1
```

## 样例 #2

### 输入

```
2 2

.#

#.

1 1 2 2
```

### 输出

```
1
```

## 样例 #3

### 输入

```
1 3

.#.

1 1 1 3
```

### 输出

```
1
```

## 样例 #4

### 输入

```
20 20

####################

##...##....###...###

#.....#.....#.....##

#..#..#..#..#..#..##

#..#..#....##..#####

#.....#.....#..#####

#.....#..#..#..#..##

#..#..#.....#.....##

#..#..#....###...###

####################

####################

##..#..##...###...##

##..#..#.....#.....#

##..#..#..#..#..#..#

##..#..#..#..#..#..#

##.....#..#..#..#..#

###....#..#..#..#..#

#####..#.....#.....#

#####..##...###...##

####################

3 3 18 18
```

### 输出

```
3
```



---

---
title: "[ARC177C] Routing"
layout: "post"
diff: 普及/提高-
pid: AT_arc177_c
tag: ['广度优先搜索 BFS', '最短路']
---

# [ARC177C] Routing

## 题目描述

有一个 $N$ 行 $N$ 列（用 $(i, j)$ 表示矩阵第 $i$ 行第 $j$ 列的元素）的矩阵被刷满了红色和蓝色。现在要矩阵的一些格子刷上紫色，使得矩阵**同时**满足以下两个条件：
- 从 $(1, 1)$ 走到 $(N, N)$，保证存在一条路径使其只经过红色和紫色；
- 从 $(1, N)$ 走到 $(N, 1)$，保证存在一条路径使其只经过蓝色和紫色

注意，**行动时他可以往任何一个方向前进。**

那么，问题来了，至少要将多少格子刷成紫色才能使以上两个条件成立呢？

## 输入格式

输入共 $N+1$ 行。

第一行，读入 $N$;

接下来 $N$ 行，读入这个矩阵。其中以 `R`  代表红色，以 `B` 代表蓝色。

## 输出格式

输出仅一行，为最少刷成紫色的格子数。

**【约定】**

- $ 3\ \leq\ N\ \leq\ 500 $；
- 保证任意一个格子一定为 `R` 或 `B` 中的一个；
- 保证 $(1, 1)$ 和 $(N, N)$ 为红色；
- 保证 $(1, N)$ 和 $(N, 1)$ 为蓝色；
- 保证 $N$ 是一个整数。

**【样例解释】**

【样例 $1$ 解释】  
如下图，将 $ (1, 3),(3, 2),(4, 5) $ 三个格子刷成紫色可以达成目标。
![](https://cdn.luogu.com.cn/upload/image_hosting/zu2dn557.png)

【样例 $2$ 解释】  
如下图，将 $ (1, 2), (2, 2), (2, 3), (3, 3), (3, 4), (4, 4), (4, 5) $ 这 $7$ 个格子刷成紫色可以达成目标。
![](https://cdn.luogu.com.cn/upload/image_hosting/290k2d8o.png)

## 样例 #1

### 输入

```
5

RBRBB

RBRRR

RRRBR

RBBRB

BBRBR
```

### 输出

```
3
```

## 样例 #2

### 输入

```
5

RBBBB

BBBBB

BBBBB

BBBBB

BBBBR
```

### 输出

```
7
```

## 样例 #3

### 输入

```
10

RRBBBBBBBB

BRRBBBBBBB

BBRRBBBBBB

BBBRRBBBBB

BBBBRRBBBB

BBBBBRRBBB

BBBBBBRRBB

BBBBBBBRRB

BBBBBBBBRR

BBBBBBBBBR
```

### 输出

```
2
```

## 样例 #4

### 输入

```
17

RBBRRBRRRRRBBBBBB

BBRBRBRRBRRBRRBBR

BRBRBBBRBBRBBRBBB

RBRRBBBBBBRRBRRRR

RRRRRBRBRRRBBRBBR

RRRRRBRRBRBBRRRBB

BBBRRRBRBRBBRRRBB

BBRRRBRBBBRBRRRBR

RRBBBBBBBBBBBRBRR

RRRBRRBRBRBRBRBBB

RRBRRRRBRBRRBRBBR

RRRBBRBRBBBRBBRBR

BBRBBRRBRRRBBRBBB

BBBRBRRRRRRRBBRBB

RRRRRBRBRBBRRBRRR

BRRRRBBBRRRBRRBBB

BBRRBBRRRBBBRBBBR
```

### 输出

```
8
```



---

---
title: "最短経路"
layout: "post"
diff: 普及/提高-
pid: AT_past202109_h
tag: ['最短路']
---

# 最短経路

## 题目描述

有一张 $n$ 点 $n-1$ 边的无向图，第 $i$ 条边连接点 $a_i$ 和点 $b_i$，长度为 $c_i$。请求出是否有至少一对整数 $(i,j)$ 满足：从点 $i$ 到点 $j$ 的最短路径长度恰好为 $x$？如果是，请输出`Yes`，否则请输出`No`。

## 输入格式

第一行两个整数 $n,x$。

第二行到第 $n$ 行，每行三个整数 $a_i,b_i,c_i$。

## 输出格式

输出`Yes`或`No`。

## 说明/提示

#### 数据规模与约定

- $2 \le n \le 3000$
- $1 \le a_i \lt b_i \le n$
- $1 \le c_i \le 10^5$
- $1 \le x \le 10^9$
- 保证图联通

## 样例 #1

### 输入

```
3 5

1 2 3

1 3 2
```

### 输出

```
Yes
```

## 样例 #2

### 输入

```
3 4

1 2 3

1 3 2
```

### 输出

```
No
```

## 样例 #3

### 输入

```
10 15

3 8 3

5 9 3

6 7 1

7 8 1

2 8 5

2 4 5

4 9 3

1 4 5

1 10 2
```

### 输出

```
Yes
```



---


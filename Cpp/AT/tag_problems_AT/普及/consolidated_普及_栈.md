---
title: "[ABC333E] Takahashi Quest"
layout: "post"
diff: 普及/提高-
pid: AT_abc333_e
tag: ['贪心', '栈']
---

# [ABC333E] Takahashi Quest

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc333/tasks/abc333_e

高橋くんは冒険に出ようとしています。

冒険では、$ N $ 個の出来事が起こります。 $ i $ 番目 $ (1\leq\ i\leq\ N) $ の出来事は整数の組 $ (t\ _\ i,x\ _\ i) $ $ (1\leq\ t\ _\ i\leq\ 2,1\leq\ x\ _\ i\leq\ N) $ で表され、次のような出来事です。

- $ t\ _\ i=1 $ のとき、タイプ $ x\ _\ i $ のポーションを $ 1 $ つ発見する。高橋くんは、発見したポーションを拾うか捨てるかのどちらかを選択する。
- $ t\ _\ i=2 $ のとき、タイプ $ x\ _\ i $ のモンスター $ 1 $ 体と遭遇する。高橋くんがタイプ $ x\ _\ i $ のポーションを持っている場合、それを $ 1 $ つ消費することでモンスターを撃退することができる。モンスターを撃退しなかった場合、高橋くんは敗北する。
 
高橋くんが敗北することなく全てのモンスターを撃退することができるか判定してください。

高橋くんが全てのモンスターを撃退することができない場合、`-1` を出力してください。

高橋くんが全てのモンスターを撃退することができる場合、高橋君が冒険の途中で持っているポーションの個数の最大値を $ K $ とします。 高橋くんが敗北しないような戦略全体にわたる $ K $ の最小値を $ K\ _\ {\min} $ とします。 $ K\ _\ {\min} $ の値と、$ K\ _\ {\min} $ を達成する高橋くんの行動を出力してください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ t\ _\ 1 $ $ x\ _\ 1 $ $ t\ _\ 2 $ $ x\ _\ 2 $ $ \vdots $ $ t\ _\ N $ $ x\ _\ N $

## 输出格式

高橋くんが全てのモンスターを撃退することができない場合、`-1` を出力せよ。 高橋くんが全てのモンスターを撃退することができる場合、$ 1 $ 行目には $ K\ _\ {\min} $ の値を、$ 2 $ 行目には $ t\ _\ i=1 $ であるような $ i $ すべてについて昇順に、$ i $ 番目の出来事で発見したポーションを拾うなら `1` を、拾わないなら `0` を空白区切りで出力せよ。 $ K\ _\ {\min} $ を達成し、高橋くんが敗北せず冒険を終えられるような行動が複数ある場合、どれを出力しても構わない。

## 说明/提示

### 制約

- $ 1\leq\ N\leq2\times10^5 $
- $ 1\leq\ t\ _\ i\leq2\ (1\leq\ i\leq\ N) $
- $ 1\leq\ x\ _\ i\leq\ N\ (1\leq\ i\leq\ N) $
- 入力はすべて整数
 
### Sample Explanation 1

出力例は、次のような行動に対応しています。 - タイプ $ 2,3,1 $ のポーションをこの順に発見する。これらのポーションをすべて拾う。 - タイプ $ 3,2 $ のポーションをこの順に発見する。これらのポーションをいずれも拾わない。 - タイプ $ 3 $ のモンスターと遭遇する。持っているタイプ $ 3 $ のポーションを $ 1 $ つ消費してモンスターを撃退する。 - タイプ $ 3 $ のポーションを発見する。このポーションを拾う。 - タイプ $ 3 $ のポーションを発見する。このポーションを拾わない。 - タイプ $ 3 $ のモンスターと遭遇する。持っているタイプ $ 3 $ のポーションを $ 1 $ つ消費してモンスターを撃退する。 - タイプ $ 3 $ のポーションを発見する。このポーションを拾う。 - タイプ $ 2 $ のモンスターと遭遇する。持っているタイプ $ 2 $ のポーションを $ 1 $ つ消費してモンスターを撃退する。 - タイプ $ 3 $ のモンスターと遭遇する。持っているタイプ $ 3 $ のポーションを $ 1 $ つ消費してモンスターを撃退する。 - タイプ $ 1 $ のモンスターと遭遇する。持っているタイプ $ 1 $ のポーションを $ 1 $ つ消費してモンスターを撃退する。 この行動では、$ K $ の値は $ 3 $ となります。 $ K\leq\ 2 $ として敗北しない方法はないので、求める $ K\ _\ {\min} $ の値は $ 3 $ です。 $ K=3 $ を満たして高橋くんが敗北しない行動は複数ありますが、どれを出力しても構いません。

### Sample Explanation 2

高橋くんはかならず最初に遭遇するモンスターに敗北してしまいます。

## 样例 #1

### 输入

```
13

1 2

1 3

1 1

1 3

1 2

2 3

1 3

1 3

2 3

1 3

2 2

2 3

2 1
```

### 输出

```
3

1 1 1 0 0 1 0 1
```

## 样例 #2

### 输入

```
4

2 3

1 4

2 1

1 2
```

### 输出

```
-1
```

## 样例 #3

### 输入

```
30

1 25

1 2

1 10

1 18

2 18

1 11

2 11

1 21

1 6

2 2

2 10

1 11

1 24

1 11

1 3

1 2

1 18

2 25

1 8

1 10

1 11

2 18

2 10

1 10

2 2

1 24

1 10

2 10

1 25

2 6
```

### 输出

```
4

1 1 1 1 1 0 1 0 0 0 0 1 1 0 1 0 1 0 0 0
```



---

---
title: "[ABC359E] Water Tank"
layout: "post"
diff: 普及/提高-
pid: AT_abc359_e
tag: ['单调栈']
---

# [ABC359E] Water Tank

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc359/tasks/abc359_e

長さ $ N $ の正整数列 $ H=(H\ _\ 1,H\ _\ 2,\dotsc,H\ _\ N) $ が与えられます。

長さ $ N+1 $ の非負整数列 $ A=(A\ _\ 0,A\ _\ 1,\dotsc,A\ _\ N) $ があります。 はじめ、$ A\ _\ 0=A\ _\ 1=\dotsb=A\ _\ N=0 $ です。

$ A $ に対して、次の操作を繰り返します。

1. $ A\ _\ 0 $ の値を $ 1 $ 増やす。
2. $ i=1,2,\ldots,N $ に対して、この順に次の操作を行う。
  - $ A\ _\ {i-1}\gt\ A\ _\ i $ かつ $ A\ _\ {i-1}\gt\ H\ _\ i $ のとき、$ A\ _\ {i-1} $ の値を $ 1 $ 減らし、$ A\ _\ i $ の値を $ 1 $ 増やす。
 
$ i=1,2,\ldots,N $ のそれぞれに対して、初めて $ A\ _\ i\ >\ 0 $ が成り立つのは何回目の操作の後か求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ H\ _\ 1 $ $ H\ _\ 2 $ $ \dotsc $ $ H\ _\ N $

## 输出格式

$ i=1,2,\ldots,N $ に対する答えを、空白を区切りとして $ 1 $ 行に出力せよ。

## 说明/提示

### ストーリー

> 長い水槽があり、高さの異なる板が等間隔に配置されています。 高橋くんは、この水槽の端へ水を注いでいったとき、板で区切られたそれぞれの領域に水が到達する時刻が知りたいです。

### 制約

- $ 1\leq\ N\leq2\times10\ ^\ 5 $
- $ 1\leq\ H\ _\ i\leq10\ ^\ 9\ (1\leq\ i\leq\ N) $
- 入力はすべて整数
 
### Sample Explanation 1

はじめ $ 5 $ 回の操作では以下のようになります。 それぞれの行が一回の操作に対応し、左端が $ 1 $ 番の操作を、それ以外が $ 2 $ 番の操作に対応します。 !\[\](https://img.atcoder.jp/abc359/570466412318b9902952c408a421be0c.png) この図から、$ A\ _\ 1\gt0 $ が初めて成り立つのは $ 4 $ 回目の操作の後、$ A\ _\ 2\gt0 $ が初めて成り立つのは $ 5 $ 回目の操作の後です。 同様にして、$ A\ _\ 3,A\ _\ 4,A\ _\ 5 $ に対する答えは $ 13,14,26 $ です。 よって、`4 5 13 14 26` を出力してください。

### Sample Explanation 2

出力すべき値が $ 32\operatorname{bit} $ 整数に収まらない場合があることに注意してください。

## 样例 #1

### 输入

```
5

3 1 4 1 5
```

### 输出

```
4 5 13 14 26
```

## 样例 #2

### 输入

```
6

1000000000 1000000000 1000000000 1000000000 1000000000 1000000000
```

### 输出

```
1000000001 2000000001 3000000001 4000000001 5000000001 6000000001
```

## 样例 #3

### 输入

```
15

748 169 586 329 972 529 432 519 408 587 138 249 656 114 632
```

### 输出

```
749 918 1921 2250 4861 5390 5822 6428 6836 7796 7934 8294 10109 10223 11373
```



---

---
title: "[ABC372D] Buildings"
layout: "post"
diff: 普及/提高-
pid: AT_abc372_d
tag: ['单调栈']
---

# [ABC372D] Buildings

## 题目描述

这里有 $N$ 栋房子，从 $1$ 到 $N$ 依次编号。它们按照顺序排成一排。第 $i(1\le i\le N)$ 的房子的高度为 $H_i$。 

对于每一个 $i=1,2,\dots,N$，找到满足以下条件的整数 $j(i<j\le N)$ 的数量：

- 没有一栋在 $i$ 和 $j$ 之间的房子比 $j$ 要高。

## 输入格式

第一行，一个整数 $N$。

第二行，有 $N$ 个整数，表示每栋房子的高度。

## 输出格式

对于每一个 $i=1,2,\dots,n$，令 $c_i$ 为满足条件的 $j$ 的数量。输出 $N$ 个整数 $c_1,c_2,\dots,c_N$。 

### 样例 1 解释

当 $i=1$ 时，满足条件的 $j$ 有 $2,3$ 和 $5$，一共 $3$ 个。（在第 $1$ 栋房子和第 $4$ 栋房子之间，房子 $3$ 比房子 $4$ 高，所以 $j=4$ 不满足条件。）所以第一个数输出 $3$。

## 说明/提示

- $1\le N\le 2\times 10^5$
- $1\le H_i\le N$
- $H_i\not=H_j(i\not= j)$
- 所有输入都为整数

## 样例 #1

### 输入

```
5

2 1 4 3 5
```

### 输出

```
3 2 2 1 0
```

## 样例 #2

### 输入

```
4

1 2 3 4
```

### 输出

```
3 2 1 0
```

## 样例 #3

### 输入

```
10

1 9 6 5 2 7 10 4 8 3
```

### 输出

```
2 3 3 3 2 1 2 1 1 0
```



---


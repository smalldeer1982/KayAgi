---
title: "[ABC028D] 乱数生成"
layout: "post"
diff: 普及/提高-
pid: AT_abc028_d
tag: ['模拟', '分块']
---

# [ABC028D] 乱数生成

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc028/tasks/abc028_d

$ 2 $ つの整数 $ N $、$ K $ が与えられます。

$ 1 $ 以上 $ N $ 以下の整数のなかからどれか $ 1 $ つ、等確率に選ぶ機械を考えます。

その機械を $ 3 $ 回動かした時、選ばれた $ 3 $ つの数の中央値が $ K $ となる確率を求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ K $

$ 1 $ 行目には整数 $ N(1\ ≦\ N\ ≦\ 10^6) $、$ K(1\ ≦\ K\ ≦\ N) $ が空白区切りで与えられる。

## 输出格式

出力の中央値が $ K $ となる確率を出力せよ。出力は標準出力に行い、末尾に改行を入れること。

なお、想定解との絶対誤差または相対誤差が $ 10^{-9} $ 以下であれば、正解として扱われる。

## 说明/提示

### Sample Explanation 1

中央値が $ 2 $ となるのは、( $ 1 $ 回目の出力, $ 2 $ 回目の出力, $ 3 $ 回目の出力) が - (1, 2, 3) - (1, 3, 2) - (2, 1, 3) - (2, 3, 1) - (3, 1, 2) - (3, 2, 1) - (1, 2, 2) - (2, 1, 2) - (2, 2, 1) - (3, 2, 2) - (2, 3, 2) - (2, 2, 3) - (2, 2, 2) となる場合で、このいずれかが出る確率は $ 13/27\ =\ 0.481481481... $ です

## 样例 #1

### 输入

```
3 2
```

### 输出

```
0.48148148148148148148
```

## 样例 #2

### 输入

```
3 1
```

### 输出

```
0.25925925925925925926
```

## 样例 #3

### 输入

```
765 573
```

### 输出

```
0.00147697396984624371
```



---

---
title: "[ABC037C] 総和"
layout: "post"
diff: 普及/提高-
pid: AT_abc037_c
tag: ['模拟', '枚举', '前缀和']
---

# [ABC037C] 総和

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc037/tasks/abc037_c

長さ $ N $ の数列 $ \{a_i\} $ と$ 1 $ 以上 $ N $ 以下の整数 $ K $ が与えられます。 この数列には長さ $ K $ の連続する部分列が $ N-K+1 $ 個あります。これらのそれぞれ部分列に含まれる値の合計の総和を求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ K $ $ a_1 $ .. $ a_N $

## 输出格式

部分列に含まれる値の合計 $ N-K+1 $ 個の総和を出力せよ。

## 说明/提示

### 制約

- $ 1\ \leq\ K\ \leq\ N\ \leq\ 10^5 $
- $ 0\ \leq\ a_i\ \leq\ 10^8 $
- $ a_i $ は整数である。

### 部分点

- 50 点分のテストケースでは、 $ N\ \leq\ 10^3 $ である。

### Sample Explanation 1

$ (1+2+4)+(2+4+8)+(4+8+16)=49 $ なので、答えは $ 49 $ です。

### Sample Explanation 2

オーバーフローに注意してください。

## 样例 #1

### 输入

```
5 3

1 2 4 8 16
```

### 输出

```
49
```

## 样例 #2

### 输入

```
20 10

100000000 100000000 98667799 100000000 100000000 100000000 100000000 99986657 100000000 100000000 100000000 100000000 100000000 98995577 100000000 100000000 99999876 100000000 100000000 99999999
```

### 输出

```
10988865195
```



---

---
title: "[ABC057C] Digits in Multiplication"
layout: "post"
diff: 普及/提高-
pid: AT_abc057_c
tag: ['模拟', '字符串', '搜索']
---

# [ABC057C] Digits in Multiplication

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc057/tasks/abc057_c

整数 $ N $ が与えられます。   
 ここで、$ 2 $ つの正の整数 $ A,B $ に対して、$ F(A,B) $ を「$ 10 $ 進表記における、$ A $ の桁数と $ B $ の桁数のうち大きい方」と定義します。   
 例えば、$ F(3,11) $ の値は、$ 3 $ は $ 1 $ 桁、$ 11 $ は $ 2 $ 桁であるため、$ F(3,11)=2 $ となります。   
 $ 2 $ つの正の整数の組 $ (A,B) $ が $ N=A×B $ を満たすように動くとき、$ F(A,B) $ の最小値を求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $

## 输出格式

$ 2 $ つの正の整数の組 $ (A,B) $ が $ N=A×B $ を満たすように動くときの $ F(A,B) $ の最小値を出力せよ。

## 说明/提示

### 制約

- $ 1≦N≦10^{10} $
- $ N $ は整数である。

### Sample Explanation 1

$ (A,B)=(100,100) $ のときに $ F(A,B) $ は最小値をとるため、$ F(100,100)=3 $ を出力します。

### Sample Explanation 2

条件を満たす $ (A,B) $ の組は $ (1,1000003) $ と $ (1000003,1) $ の $ 2 $ 通りで、$ F(1,1000003)=F(1000003,1)=7 $ です。

## 样例 #1

### 输入

```
10000
```

### 输出

```
3
```

## 样例 #2

### 输入

```
1000003
```

### 输出

```
7
```

## 样例 #3

### 输入

```
9876543210
```

### 输出

```
6
```



---

---
title: "[ABC085D] Katana Thrower"
layout: "post"
diff: 普及/提高-
pid: AT_abc085_d
tag: ['模拟', '贪心', '排序']
---

# [ABC085D] Katana Thrower

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc085/tasks/abc085_d

あなたが散歩していると、突然一体の魔物が出現しました。幸い、あなたは $ N $ 本の刀、刀 $ 1 $、刀 $ 2 $、$ … $、刀 $ N $ を持っていて、次の二種類の攻撃を自由な順番で行うことができます。

- 持っている刀のうち一本を振る。刀 $ i $ $ (1\ <\ =\ i\ <\ =\ N) $ を振ると、魔物は $ a_i $ ポイントのダメージを受ける。同じ刀を何度振ることもできる。
- 持っている刀のうち一本を投げつける。刀 $ i $ $ (1\ <\ =\ i\ <\ =\ N) $ を投げつけると、魔物は $ b_i $ ポイントのダメージを受け、あなたはその刀を失う。すなわち、あなたは以後その刀を振ることも投げつけることもできなくなる。

魔物は、受けたダメージの合計が $ H $ ポイント以上になると消滅します。魔物を消滅させるには、最小で合計何回の攻撃が必要でしょうか。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ H $ $ a_1 $ $ b_1 $ $ : $ $ a_N $ $ b_N $

## 输出格式

魔物を消滅させるために必要な最小の合計攻撃回数を出力せよ。

## 说明/提示

### 制約

- $ 1\ <\ =\ N\ <\ =\ 10^5 $
- $ 1\ <\ =\ H\ <\ =\ 10^9 $
- $ 1\ <\ =\ a_i\ <\ =\ b_i\ <\ =\ 10^9 $
- 入力値はすべて整数である。

### Sample Explanation 1

あなたは $ 1 $ 本の刀を持っていて、振ると $ 3 $ ポイントのダメージ、投げつけると $ 5 $ ポイントのダメージを与えられます。刀を $ 2 $ 回振ってから投げつけると $ 3\ +\ 3\ +\ 5\ =\ 11 $ ポイントのダメージを与え、合計 $ 3 $ 回の攻撃で魔物が消滅します。

### Sample Explanation 2

先ほどの刀に加えてもう $ 1 $ 本別の刀もあり、こちらは振ると $ 2 $ ポイントのダメージ、投げつけると $ 6 $ ポイントのダメージを与えられます。両方の刀を投げつけると $ 5\ +\ 6\ =\ 11 $ ポイントのダメージを与え、$ 2 $ 回の攻撃で魔物が消滅します。

## 样例 #1

### 输入

```
1 10

3 5
```

### 输出

```
3
```

## 样例 #2

### 输入

```
2 10

3 5

2 6
```

### 输出

```
2
```

## 样例 #3

### 输入

```
4 1000000000

1 1

1 10000000

1 30000000

1 99999999
```

### 输出

```
860000004
```

## 样例 #4

### 输入

```
5 500

35 44

28 83

46 62

31 79

40 43
```

### 输出

```
9
```



---

---
title: "[ABC314D] LOWER"
layout: "post"
diff: 普及/提高-
pid: AT_abc314_d
tag: ['模拟']
---

# [ABC314D] LOWER

## 题目描述

给定一个由英文字母大写和小写字母组成的长度为 $N$ 的字符串 $S$。

接下来，将对字符串 $S$ 进行 $Q$ 次操作。第 $i$ 次操作（$1 \le i \le Q$）由两个整数和一个字符组成的三元组 $(t _ i, x _ i, c _ i)$ 表示，每种操作的含义如下：

- 当 $t _ i = 1$ 时，将 $S$ 的第 $x _ i$ 个字符修改为 $c _ i$。
- 当 $t _ i = 2$ 时，将 $S$ 中的所有大写字母全部转为小写（$x _ i$ 和 $c _ i$ 在此操作中不使用）。
- 当 $t _ i = 3$ 时，将 $S$ 中的所有小写字母全部转为大写（$x _ i$ 和 $c _ i$ 在此操作中不使用）。

输出经过 $Q$ 次操作后的字符串 $S$。

## 输入格式

输入以以下格式从标准输入中提供。

> $ N $  
> $ S $  
> $ Q $  
> $t _ 1$ $x _ 1$ $c _ 1$  
> $t _ 2$ $x _ 2$ $c _ 2$  
> $\vdots$  
> $t _ Q$ $x _ Q$ $c _ Q$

## 输出格式

在 $1$ 行中输出答案。

### 限制条件

- $1 \leq N \leq 5 \times 10 ^ 5$
- $S$ 是由大写字母和小写字母组成的长度为 $N$ 的字符串
- $1 \leq Q \leq 5 \times 10 ^ 5$
- $1 \leq t _ i \leq 3 \ (1 \leq i \leq Q)$
- 如果 $t _ i = 1$，则 $1 \leq x _ i \leq N \ (1 \leq i \leq Q)$
- $c _ i$ 是大写字母或小写字母
- 如果 $t _ i \neq 1$，则 $x _ i = 0$ 且 $c _ i = $ `'a'`
- $N, Q, t _ i, x _ i$ 均为整数

### 样例解释 1

初始时，字符串 $S$ 是 `AtCoder`。

- 第 $1$ 次操作，将第 $4$ 个字符修改为 `i`。修改后的 $S$ 是 `AtCider`。
- 第 $2$ 次操作，将所有小写字母转换为大写字母。修改后的 $S$ 是 `ATCIDER`。
- 第 $3$ 次操作，将第 $5$ 个字符修改为 `b`。修改后的 $S$ 是 `ATCIbER`。
- 第 $4$ 次操作，将所有大写字母转换为小写字母。修改后的 $S$ 是 `atciber`。
- 第 $5$ 次操作，将第 $4$ 个字符修改为 `Y`。修改后的 $S$ 是 `atcYber`。

所有操作结束后，字符串 $S$ 是 `atcYber`，因此输出 `atcYber`。

---

Translated by User 735713.

## 样例 #1

### 输入

```
7
AtCoder
5
1 4 i
3 0 a
1 5 b
2 0 a
1 4 Y
```

### 输出

```
atcYber
```

## 样例 #2

### 输入

```
35
TheQuickBrownFoxJumpsOverTheLazyDog
10
2 0 a
1 19 G
1 13 m
1 2 E
1 21 F
2 0 a
1 27 b
3 0 a
3 0 a
1 15 i
```

### 输出

```
TEEQUICKBROWMFiXJUGPFOVERTBELAZYDOG
```



---

---
title: "[ABC317E] Avoid Eye Contact"
layout: "post"
diff: 普及/提高-
pid: AT_abc317_e
tag: ['模拟', '广度优先搜索 BFS']
---

# [ABC317E] Avoid Eye Contact

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc317/tasks/abc317_e

$ H $ 行 $ W $ 列のグリッド状に分割されたフィールドがあります。  
北 (上側) から $ i $ 行目、西 (左側) から $ j $ 列目のマスは文字 $ A_{i,\ j} $ で表されます。各文字の意味は次の通りです。

- `.` : 空きマス。進入できる。
- `#` : 障害物。進入できない。
- `>`, `v`, `<`, `^` : それぞれ東・南・西・北を向いている人がいるマス。進入できない。人の視線は $ 1 $ マス分の幅を持ち、人が向いている方向にまっすぐ伸び、障害物や別の人に遮られる。(入出力例 $ 1 $ にある説明も参考にしてください。)
- `S` : スタート地点。進入できる。ちょうど $ 1 $ ヵ所だけ存在する。人の視線に入っていないことが保証される。
- `G` : ゴール地点。進入できる。ちょうど $ 1 $ ヵ所だけ存在する。人の視線に入っていないことが保証される。

ナオヒロくんはスタート地点にいて、東西南北への $ 1 $ マス分の移動を好きな回数行えます。ただし、進入できないマスへの移動やフィールドの外への移動はできません。  
彼が人の視線に一度も入らずにゴール地点に到達できるか判定して、できる場合はそのために最小で何回の移動が必要か求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ H $ $ W $ $ A_{1,1}A_{1,2}\dots\ A_{1,W} $ $ A_{2,1}A_{2,2}\dots\ A_{2,W} $ $ \vdots $ $ A_{H,1}A_{H,2}\dots\ A_{H,W} $

## 输出格式

ナオヒロ君が人の視線に一度も入らずにゴール地点に到達できる場合は、そのために必要な(最小の)移動回数を出力せよ。できない場合は `-1` を出力せよ。

## 说明/提示

### 制約

- $ 2\ \leq\ H,\ W\ \leq\ 2000 $
- $ A_{i,j} $ は `.`, `#`, `>`, `v`, `<`, `^`, `S`, `G` のいずれかである
- `S`, `G` は $ A_{i,\ j} $ の中にちょうど $ 1 $ 回ずつ現れる
- スタート地点・ゴール地点はともに人の視線に入っていない

### Sample Explanation 1

入力例 $ 1 $ について、$ 1 $ 人以上の視線に入っている空きマスを `!` で表すと次の図のようになります。 !\[image2\](https://img.atcoder.jp/abc317/8a40fc4c621cfef326cc25a1f69c0300.jpg) いくつかのマスについて具体的に説明すると次のようになります。(ここで、北から $ i $ 行目、西から $ j $ 列目のマスを $ (i,\ j) $ と表します。) - $ (2,\ 4) $ は $ (2,\ 2) $ にいる東を向いている人からの視線に入っているマスである。 - $ (2,\ 6) $ は $ (2,\ 2) $ にいる東を向いている人と $ (1,\ 6) $ にいる南を向いている人の $ 2 $ 人の視線に入っているマスである。 - $ (4,\ 5) $ は誰の視線にも入っていないマスである。$ (4,\ 7) $ にいる西を向いている人の視線は $ (4,\ 6) $ の障害物に遮られていて、$ (4,\ 1) $ にいる東を向いている人の視線は $ (4,\ 4) $ の人に遮られている。 ナオヒロ君は進入できないマス・視線に入っているマスのどちらも通らずにゴール地点へ行く必要があります。

### Sample Explanation 2

ナオヒロ君がゴール地点に到達できない場合は `-1` を出力してください。

## 样例 #1

### 输入

```
5 7
....Sv.
.>.....
.......
>..<.#<
^G....>
```

### 输出

```
15
```

## 样例 #2

### 输入

```
4 3
S..
.<.
.>.
..G
```

### 输出

```
-1
```



---

---
title: "[ABC319C] False Hope"
layout: "post"
diff: 普及/提高-
pid: AT_abc319_c
tag: ['模拟']
---

# [ABC319C] False Hope

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc319/tasks/abc319_c

$ 3\times3 $ のマス目に $ 1 $ から $ 9 $ までの数字が書き込まれており、上から $ i $ 行目、左から $ j $ 列目 $ (1\leq\ i\leq3,1\leq\ j\leq3) $ に書き込まれている数字は $ c\ _\ {i,j} $ です。

異なるマスに同じ数字が書き込まれている場合もありますが、同じ数字が縦・横・斜めに $ 3 $ つ連続して書き込まれていることはありません。 より厳密には、$ c\ _\ {i,j} $ について次の条件のすべてが成り立っていることが保証されます。

- どの $ 1\leq\ i\leq3 $ についても、$ c\ _\ {i,1}=c\ _\ {i,2}=c\ _\ {i,3} $ ではない
- どの $ 1\leq\ j\leq3 $ についても、$ c\ _\ {1,j}=c\ _\ {2,j}=c\ _\ {3,j} $ ではない
- $ c\ _\ {1,1}=c\ _\ {2,2}=c\ _\ {3,3} $ ではない
- $ c\ _\ {3,1}=c\ _\ {2,2}=c\ _\ {1,3} $ ではない
 
高橋くんは、それぞれのマスに書かれている数字をランダムな順番で知ります。 高橋くんは、縦・横・斜めの列のうちの $ 1 $ つでも次の条件を満たしたとき**がっかり**します。

- はじめに知ったほうの $ 2 $ マスに書かれた数字が同じであり、最後に知ったマスに書かれた数字がそれと異なる。
 
高橋くんががっかりせずにすべてのマスに書かれた数字を知る確率を求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ c\ _\ {1,1} $ $ c\ _\ {1,2} $ $ c\ _\ {1,3} $ $ c\ _\ {2,1} $ $ c\ _\ {2,2} $ $ c\ _\ {2,3} $ $ c\ _\ {3,1} $ $ c\ _\ {3,2} $ $ c\ _\ {3,3} $

## 输出格式

高橋くんががっかりせずにすべてのマスに書かれた数字を知る確率を $ 1 $ 行で出力せよ。 真の値からの絶対誤差が $ 10\ ^\ {-8} $ 以下であるとき、正答と判定される。

## 说明/提示

### 制約

- $ c\ _\ {i,j}\in\lbrace1,2,3,4,5,6,7,8,9\rbrace\ (1\leq\ i\leq3,1\leq\ j\leq3) $
- $ c\ _\ {i,1}=c\ _\ {i,2}=c\ _\ {i,3} $ ではない $ (1\leq\ i\leq3) $
- $ c\ _\ {1,j}=c\ _\ {2,j}=c\ _\ {3,j} $ ではない $ (1\leq\ j\leq3) $
- $ c\ _\ {1,1}=c\ _\ {2,2}=c\ _\ {3,3} $ ではない
- $ c\ _\ {1,3}=c\ _\ {2,2}=c\ _\ {3,1} $ ではない
 
### Sample Explanation 1

例えば、高橋くんが $ c\ _\ {3,1}=2,c\ _\ {2,1}=2,c\ _\ {1,1}=3 $ の順に知った場合、高橋くんはがっかりしてしまいます。 !\[\](https://img.atcoder.jp/abc319/d4635a227bbb8db7143f4bbee77a9979.png) 対して、高橋くんが $ c\ _\ {1,1},c\ _\ {1,2},c\ _\ {1,3},c\ _\ {2,1},c\ _\ {2,2},c\ _\ {2,3},c\ _\ {3,1},c\ _\ {3,2},c\ _\ {3,3} $ の順に数字を知った場合、がっかりすることなくすべての数字を知ることができます。 高橋くんががっかりすることなくすべての数字を知ることができる確率は $ \dfrac\ 23 $ です。 絶対誤差が $ 10\ ^\ {-8} $ 以下であれば正答と判定されるため、$ 0.666666657 $ や $ 0.666666676 $ のように出力しても正解になります。

## 样例 #1

### 输入

```
3 1 9

2 5 6

2 7 1
```

### 输出

```
0.666666666666666666666666666667
```

## 样例 #2

### 输入

```
7 7 6

8 6 8

7 7 6
```

### 输出

```
0.004982363315696649029982363316
```

## 样例 #3

### 输入

```
3 6 7

1 9 7

5 7 5
```

### 输出

```
0.4
```



---

---
title: "[ABC320C] Slot Strategy 2 (Easy)"
layout: "post"
diff: 普及/提高-
pid: AT_abc320_c
tag: ['模拟']
---

# [ABC320C] Slot Strategy 2 (Easy)

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc320/tasks/abc320_c

> この問題は G 問題の簡易版です。

$ 3 $ 個のリールからなるスロットがあります。  
 $ i $ 番目のリールの配列は文字列 $ S_i $ によって表されます。ここで、$ S_i $ は数字のみからなる長さ $ M $ の文字列です。

それぞれのリールには対応するボタンがついています。高橋君は各非負整数 $ t $ について、スロットが回り始めてからちょうど $ t $ 秒後にボタンを $ 1 $ つ選んで押す、または何もしないことができます。  
 スロットが回り始めてから $ t $ 秒後に $ i $ 番目のリールに対応するボタンを押すと、$ i $ 番目のリールは $ S_i $ の $ (t\ \bmod\ M)+1 $ 文字目を表示して止まります。  
 ただし、$ t\ \bmod\ M $ で $ t $ を $ M $ で割ったあまりを表します。

高橋君は全てのリールを止めた上で、表示されている文字が全て同じであるようにしたいです。  
 高橋君が目標を達成できるように全てのリールを止めるまでに、スロットが回り始めてから最小で何秒かかるかを求めてください。  
 そのようなことが不可能であればそのことを報告してください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ M $ $ S_1 $ $ S_2 $ $ S_3 $

## 输出格式

全てのリールを止めた上で、表示されている文字が全て同じであるようにすることができないなら `-1` を出力せよ。  
 できるなら、スロットが回り始めてからそのような状態にするまでに最小で何秒かかるか出力せよ。

## 说明/提示

### 制約

- $ 1\ \leq\ M\ \leq\ 100 $
- $ M $ は整数
- $ S_i $ は数字のみからなる長さ $ M $ の文字列
 
### Sample Explanation 1

高橋君は次のようにそれぞれのリールを止めることでスロットが回り始めてから $ 6 $ 秒後にリールに表示される文字を `8` で揃えることができます。 - スロットの回転開始から $ 0 $ 秒後に $ 2 $ 番目のリールに対応するボタンを押します。$ 2 $ 番目のリールは $ S_2 $ の $ (0\ \bmod\ 10)+1=1 $ 文字目である `8` を表示して止まります。 - スロットの回転開始から $ 2 $ 秒後に $ 3 $ 番目のリールに対応するボタンを押します。$ 3 $ 番目のリールは $ S_3 $ の $ (2\ \bmod\ 10)+1=3 $ 文字目である `8` を表示して止まります。 - スロットの回転開始から $ 6 $ 秒後に $ 1 $ 番目のリールに対応するボタンを押します。$ 1 $ 番目のリールは $ S_1 $ の $ (6\ \bmod\ 10)+1=7 $ 文字目である `8` を表示して止まります。 $ 5 $ 秒以下で全てのリールに表示されている文字を揃える方法はないため、$ 6 $ を出力します。

### Sample Explanation 2

全てのリールを止めた上で、表示されている文字を揃える必要がある事に注意してください。

### Sample Explanation 3

表示されている文字が全て同じであるようにリールを止めることはできません。 このとき `-1` を出力してください。

## 样例 #1

### 输入

```
10

1937458062

8124690357

2385760149
```

### 输出

```
6
```

## 样例 #2

### 输入

```
20

01234567890123456789

01234567890123456789

01234567890123456789
```

### 输出

```
20
```

## 样例 #3

### 输入

```
5

11111

22222

33333
```

### 输出

```
-1
```



---

---
title: "[ABC320E] Somen Nagashi"
layout: "post"
diff: 普及/提高-
pid: AT_abc320_e
tag: ['模拟', '优先队列']
---

# [ABC320E] Somen Nagashi

## 题目描述

现有 $N$ 个人排成一队，编号从 $1$ 到 $N$，玩一个叫做“流水面条”的游戏，该游戏共有 $M$ 个事件，每个事件含三个变量 $T_i,W_i,S_i$，事件的规则如下：

- 在 $T_i$ 时刻，有 $W_i$ 根面条流了下来，队头的人拿走这些面条，并离开队列，然后于第 $T_i+S_i$ 时刻返回队列，然后返回他的原始位置。

若队列为空，则该事件忽略。

注意：若他于第 $X$ 时刻返回队列，则视为他第 $X$ 时刻在队列。

一开始每个人都有 $0$ 根面条，现要你求出这 $N$ 个人每个人获得了多少面条。

## 输入格式

共 $M+1$ 行。

第 $1$ 行，共两个正整数，分别代表 $N,M$。

第 $2\sim M+1$ 行，第 $i+1$ 行三个正整数，分别代表 $T_i,W_i,S_i$。

## 输出格式

共 $N$ 行，第 $i$ 行代表第 $i$ 个人获得的面条。

## 说明/提示

#### 样例#1说明：
第 $1$ 个人于 $1$ 时刻拿走 $1$ 根面条，将于 $4$ 时刻返回队列。

第 $2$ 个人于 $2$ 时刻拿走 $10$ 根面条，将于 $102$ 时刻返回队列。

第 $1$ 个人于 $4$ 时刻归队，返回第 $1$ 位，此时他处于队头，然后拿走 $100$ 根面条，将于 $10004$ 时刻返回队列。

第 $3$ 个人于 $10$ 时刻拿走 $1000$ 根面条，将于第 $1000000010$ 时刻归队。

第 $100$ 时刻，队内无人。

最终，这 $3$ 个人分别有 $101,10,1000$ 根面条。

## 样例 #1

### 输入

```
3 5

1 1 3

2 10 100

4 100 10000

10 1000 1000000000

100 1000000000 1
```

### 输出

```
101

10

1000
```

## 样例 #2

### 输入

```
3 1

1 1 1
```

### 输出

```
1

0

0
```

## 样例 #3

### 输入

```
1 8

1 1 1

2 2 2

3 3 3

4 4 4

5 5 5

6 6 6

7 7 7

8 8 8
```

### 输出

```
15
```



---

---
title: "[ABC370D] Cross Explosion"
layout: "post"
diff: 普及/提高-
pid: AT_abc370_d
tag: ['模拟']
---

# [ABC370D] Cross Explosion

## 题目描述

有一个网格，网格中有 $H$ 行和 $W$ 列。让 $(i, j)$ 表示从上往下第 $i$ 行，从左往上第 $j$ 列的单元格。  
最初，每个单元格中都有一面墙。  
按照下面给出的顺序处理 $Q$ 个查询后，求剩余墙的数量。

在第 $q$ 次查询中，我们给出了两个整数 $R_q$ 和 $C_q$ 。  
您在 $(R_q, C_q)$ 处放置了一枚炸弹来摧毁墙壁。结果会发生以下过程。

- 如果在 $(R_q, C_q)$ 处有一堵墙，则摧毁这堵墙并结束进程。
- 如果 $(R_q, C_q)$ 处没有墙壁，则摧毁从 $(R_q, C_q)$ 向上、向下、向左、向右观察时出现的第一面墙壁。更确切地说，以下四个过程是同时进行的：
    - 如果存在一个 $i \lt R_q$ ，使得在 $(i, C_q)$ 处有一堵墙，而在所有 $i \lt k \lt R_q$ 的 $(k, C_q)$ 处都没有墙，则摧毁 $(i, C_q)$ 处的墙。
    - 如果存在一个 $i \gt R_q$ ，使得在 $(i, C_q)$ 处有一堵墙，而在所有 $R_q \lt k \lt i$ 的 $(k, C_q)$ 处都没有墙，则破坏 $(i, C_q)$ 处的墙。
    - 如果存在一个 $j \lt C_q$ ，使得在所有 $j \lt k \lt C_q$ 中， $(R_q, j)$ 处有一堵墙，而 $(R_q, k)$ 处没有墙，则破坏 $(R_q, j)$ 处的墙。
    - 如果存在一个 $j \gt C_q$ ，使得在 $(R_q, j)$ 处有一堵墙，而在所有 $C_q \lt k \lt j$ 的 $(R_q, k)$ 处没有墙，则破坏 $(R_q, j)$ 处的墙。

## 输入格式

第一行 $3$ 个整数 $H,W,Q$。

接下来每行 $2$ 个整数 $R,C$，表示在坐标 $R,C$ 出放置了一枚炸弹。

## 输出格式

输出一个整数，表示最后剩下多少堵墙。

## 说明/提示

- $1 \leq H, W$
- $H \times W \leq 4 \times 10^5$
- $1 \leq Q \leq 2 \times 10^5$
- $1 \leq R_q \leq H$
- $1 \leq C_q \leq W$
- 所有输入值均为整数。

Translate by DeepL,Manually verified.

## 样例 #1

### 输入

```
2 4 3
1 2
1 2
1 3
```

### 输出

```
2
```

## 样例 #2

### 输入

```
5 5 5
3 3
3 3
3 2
2 2
1 2
```

### 输出

```
10
```

## 样例 #3

### 输入

```
4 3 10
2 2
4 1
1 1
4 2
2 1
3 1
1 3
1 2
4 3
4 2
```

### 输出

```
2
```



---

---
title: "[ABC375C] Spiral Rotation"
layout: "post"
diff: 普及/提高-
pid: AT_abc375_c
tag: ['模拟']
---

# [ABC375C] Spiral Rotation

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc375/tasks/abc375_c

$ N $ 行 $ N $ 列のグリッドが与えられます。ここで、$ N $ は偶数です。グリッドの上から $ i $ 行目、左から $ j $ 列目のマスをマス $ (i,\ j) $ と表記します。

グリッドの各マスは黒か白のいずれかで塗られており、$ A_{i,\ j}\ = $ `#` のときマス $ (i,\ j) $ は黒、$ A_{i,\ j}\ = $ `.` のときマス $ (i,\ j) $ は白で塗られています。

$ i\ =\ 1,\ 2,\ \ldots,\ \frac{N}{2} $ の順に以下の操作を行った後のグリッドの各マスの色を求めてください。

- $ i $ 以上 $ N\ +\ 1\ -\ i $ 以下の整数 $ x,\ y $ について、マス $ (y,\ N\ +\ 1\ -\ x) $ の色をマス $ (x,\ y) $ の色で置き換える。この置き換えは**条件を満たすすべての整数 $ x,\ y $ について同時に行う**。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ A_{1,\ 1} $$ A_{1,\ 2} $$ \ldots $$ A_{1,\ N} $ $ A_{2,\ 1} $$ A_{2,\ 2} $$ \ldots $$ A_{2,\ N} $ $ \vdots $ $ A_{N,\ 1} $$ A_{N,\ 2} $$ \ldots $$ A_{N,\ N} $

## 输出格式

すべての操作を終えた後、マス $ (i,\ j) $ の色が黒であるとき $ B_{i,\ j}\ = $ `#`、マス $ (i,\ j) $ の色が白であるとき $ B_{i,\ j}\ = $ `.` として以下の形式で出力せよ。

> $ B_{1,\ 1} $$ B_{1,\ 2} $$ \ldots $$ B_{1,\ N} $ $ B_{2,\ 1} $$ B_{2,\ 2} $$ \ldots $$ B_{2,\ N} $ $ \vdots $ $ B_{N,\ 1} $$ B_{N,\ 2} $$ \ldots $$ B_{N,\ N} $

## 说明/提示

### 制約

- $ N $ は $ 2 $ 以上 $ 3000 $ 以下の偶数
- $ A_{i,\ j} $ は `#` または `.`
 
### Sample Explanation 1

操作によってグリッドの各マスの色は以下のように変化します。 
``` 
.......#
.......#
.####..#
.####..#
.##....#
.##....#
.#######
.#######

.......#   ........   ........   ........   ........
.......#   ######..   #######.   #######.   #######.
.####..#   ######..   #....##.   #.....#.   #.....#.
.####..# ->##..##..-> #....##.-> #.##..#.-> #.###.#.
.##....#   ##..##..   #..####.   #.##..#.   #.#...#.
.##....#   ##......   #..####.   #.#####.   #.#####.
.#######   ##......   #.......   #.......   #.......
.#######   ########   ########   ########   ########```

## 样例 #1

### 输入

```
8

.......#

.......#

.####..#

.####..#

.##....#

.##....#

.#######

.#######
```

### 输出

```
........

#######.

#.....#.

#.###.#.

#.#...#.

#.#####.

#.......

########
```

## 样例 #2

### 输入

```
6

.#.#.#

##.#..

...###

###...

..#.##

#.#.#.
```

### 输出

```
#.#.#.

.#.#.#

#.#.#.

.#.#.#

#.#.#.

.#.#.#
```

## 样例 #3

### 输入

```
12

.......#.###

#...#...#..#

###.#..#####

..#.#.#.#...

.#.....#.###

.......#.#..

#...#..#....

#####.......

...#...#.#.#

..###..#..##

#..#.#.#.#.#

.####.......
```

### 输出

```
.#..##...##.

#.#.#.#.#...

###.##..#...

#.#.#.#.#...

#.#.##...##.

............

............

.###.###.###

...#...#.#..

.###...#.###

...#...#...#

.###...#.###
```



---

---
title: "[ARC175A] Spoon Taking Problem"
layout: "post"
diff: 普及/提高-
pid: AT_arc175_a
tag: ['模拟']
---

# [ARC175A] Spoon Taking Problem

## 题目描述

[problemUrl]: https://atcoder.jp/contests/arc175/tasks/arc175_a

$ N $ 人が円卓に座っており，各人は反時計回りに順に $ 1,\ \ldots,\ N $ と番号付けられています．各人はそれぞれ左右どちらか一方の利き手を持っています．

円卓上には $ 1,\ \ldots,\ N $ と番号付けられた計 $ N $ 本のスプーンが，隣り合う二人の間に $ 1 $ 本ずつ置いてあります．各 $ 1\ \leq\ i\ \leq\ N $ について，人 $ i $ の左側，右側にはそれぞれスプーン $ i $，スプーン $ (i+1) $ があります．ここで，スプーン $ (N+1) $ はスプーン $ 1 $ のことを指します．

$ N\ =\ 4 $ での模式図を以下に示します．

![](https://cdn.luogu.com.cn/upload/vjudge_pic/AT_arc175_a/e6f0a6024a199111c69d24084c2b3068c72489fd.png)

$ (1,\ \dots,\ N) $ の順列 $ (P_1,\ \dots,\ P_N) $ が与えられます．$ i=1,\dots,N $ の順に，人 $ P_i $ が以下のように行動します．

- 自分の右側または左側にスプーンが残っているならば，そのうち $ 1 $ つを取る． 
  - このとき自分の両側にスプーンが残っているならば，自分の利き手の側のスプーンを取る．
- そうでないならば何もしない．
 
`L`, `R`, `?` からなる長さ $ N $ の文字列 $ S $ が与えられます．$ N $ 人の利き手の組み合わせは $ 2^N $ 通りありますが，そのうち以下の条件を全て満たすような組み合わせの数を $ 998244353 $ で割った余りを求めてください．

- $ S $ の $ i $ 番目の文字が `L` ならば，人 $ i $ は左利きである．
- $ S $ の $ i $ 番目の文字が `R` ならば，人 $ i $ は右利きである．
- 全員の行動が終了したとき，全員がスプーンを取っている．

## 输入格式

入力は以下の形式で標準入力から与えられる．

> $ N $ $ P_1 $ $ \dots $ $ P_N $ $ S $

## 输出格式

答えを $ 1 $ 行に出力せよ．

## 说明/提示

### 制約

- 入力される数値は全て整数
- $ 2\ \leq\ N\ \leq\ 2\ \times\ 10^5 $
- $ (P_1,\ \dots,\ P_N) $ は $ (1,\ \dots,\ N) $ の順列
- $ S $ は `L`, `R`, `?` からなる長さ $ N $ の文字列
 
### Sample Explanation 1

人 $ 1,2,3 $ がそれぞれ左利き，左利き，右利きのとき，以下のように行動が行われます． - 人 $ 1 $ が行動を開始する．人 $ 1 $ の両側にスプーンが残っているので，人 $ 1 $ の利き手と同じ左側のスプーン $ 1 $ を取る． - 人 $ 2 $ が行動を開始する．人 $ 2 $ の両側にスプーンが残っているので，人 $ 2 $ の利き手と同じ左側のスプーン $ 2 $ を取る． - 人 $ 3 $ が行動を開始する．人 $ 3 $ の右側にはスプーンが残っておらず，左側にはスプーン $ 3 $ が残っているので，スプーン $ 3 $ を取る．全員の行動が終了し，このとき全員がスプーンを取っている． この利き手の組み合わせは条件を満たします．他には人 $ 1,2,3 $ がそれぞれ左利き，左利き，左利きの場合も条件を満たします．

### Sample Explanation 2

条件を満たす利き手の組み合わせが存在しません．

## 样例 #1

### 输入

```
3

1 2 3

L??
```

### 输出

```
2
```

## 样例 #2

### 输入

```
3

1 3 2

R?L
```

### 输出

```
0
```

## 样例 #3

### 输入

```
12

6 2 9 3 1 4 11 5 12 10 7 8

????????????
```

### 输出

```
160
```



---

---
title: "ヘイホー君と最終試験"
layout: "post"
diff: 普及/提高-
pid: AT_cf_2015_morning_easy_c
tag: ['模拟']
---

# ヘイホー君と最終試験

## 题目描述

[problemUrl]: https://atcoder.jp/contests/code-festival-2015-morning-easy/tasks/cf_2015_morning_easy_c

Codefes大学の競技プログラミングの授業では、成績評価のために、$ N $ 回の試験を行うことにしています。 各試験での成績は、$ 0 $ 以上 $ M $ 以下の整数値です。 $ N $ 個の試験成績のうち、上位 $ K $ 個の平均が $ R $ 点以上であれば、めでたく単位が認定されます。 上位 $ K $ 個の平均が $ R $ 点未満の場合には不合格となり、単位は認定されません。

$ N-1 $ 回の試験を終えたヘイホー君は、最終試験に臨もうとしています。 最終試験を除く $ N-1 $ 回の試験におけるヘイホー君の成績は、それぞれ $ S_1 $, $ S_2 $, …, $ S_{N-1} $ 点でした。 ヘイホー君は、最終試験で何点以上取れば単位が認定されるでしょうか？

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ K $ $ M $ $ R $ $ S_1 $ $ S_2 $ : $ S_{N-1} $

- $ 1 $ 行目には、整数 $ N\ (1\ ≦\ N\ ≦\ 100) $, $ K\ (1\ ≦\ K\ ≦\ N) $, $ M\ (1\ ≦\ M\ ≦\ 10^9) $, $ R\ (0\ ≦\ R\ ≦\ M) $ が、空白区切りで与えられる。 ここで、$ N $ は試験の回数、$ K $ は成績評価に用いる試験の個数、$ M $ は各試験の満点、$ R $ は単位認定に必要な平均点を表す。
- $ 2 $ 行目以降の $ N-1 $ 行には、整数 $ S_i\ (0\ ≦\ S_i\ ≦\ M) $ が与えられる。これは $ i $ 回目の試験におけるヘイホー君の成績を表す。
- $ S_N $ が与えられないことに注意せよ。

## 输出格式

出力は $ 1 $ 行からなる。

- 最終試験の結果が何点であってもヘイホー君に単位が認定されるならば、$ 0 $ を出力せよ。
- 最終試験の結果が何点であってもヘイホー君に単位が認定されないならば、$ -1 $ を出力せよ。
- どちらでもない場合、ヘイホー君が最終試験で取る必要のある最低点を出力せよ。

いずれの場合も、出力の末尾には改行をいれること。

## 说明/提示

### Sample Explanation 1

ヘイホー君が最終試験で $ 45 $ 点を取った場合、上位 $ 3 $ 個の平均は $ (86+49+45)/3=60 $ となり、単位が認定されます。 もちろん、$ 46 $ 点以上取っても単位は認定されます。 一方、$ 44 $ 点以下の場合には単位が認定されません。

### Sample Explanation 2

最終試験で $ 0 $ 点でも単位が認定されます。

### Sample Explanation 3

残念ながら、最終試験が満点でも単位は認定されません。

### Sample Explanation 4

大きな数が入力されることもあります。オーバーフローに注意しましょう。

## 样例 #1

### 输入

```
5 3 100 60

86

23

49

39
```

### 输出

```
45
```

## 样例 #2

### 输入

```
5 3 100 60

92

100

95

99
```

### 输出

```
0
```

## 样例 #3

### 输入

```
5 3 100 60

18

42

29

31
```

### 输出

```
-1
```

## 样例 #4

### 输入

```
13 10 1000000000 645245296

492014535

611893452

729291030

392019922

293849201

474839528

702912832

341845861

102495671

908590572

812912432

129855439
```

### 输出

```
986132796
```



---

---
title: "電子レンジ (Microwave)"
layout: "post"
diff: 普及/提高-
pid: AT_joi2017yo_a
tag: ['模拟']
---

# 電子レンジ (Microwave)

## 题目描述

[problemUrl]: https://atcoder.jp/contests/joi2017yo/tasks/joi2017yo_a

JOI 君は食事の準備のため，$ A $ ℃の肉を電子レンジで $ B $ ℃まで温めようとしている．肉は温度が $ 0 $ ℃未満のとき凍っている．また，温度が $ 0 $ ℃より高いとき凍っていない．温度がちょうど $ 0 $ ℃のときの肉の状態は，凍っている場合と，凍っていない場合の両方があり得る．

JOI 君は，肉の加熱にかかる時間は以下のようになると仮定して，肉を温めるのにかかる時間を見積もることにした．

- 肉が凍っていて，その温度が $ 0 $ ℃より小さいとき： $ C $ 秒で $ 1 $ ℃温まる．
- 肉が凍っていて，その温度がちょうど $ 0 $ ℃のとき： $ D $ 秒で肉が解凍され，凍っていない状態になる．
- 肉が凍っていないとき： $ E $ 秒で $ 1 $ ℃温まる．

この見積もりにおいて，肉を $ B $ ℃にするのに何秒かかるかを求めよ．

- - - - - -

## 输入格式

入力は $ 5 $ 行からなり，$ 1 $ 行に $ 1 $ 個ずつ整数が書かれている．

$ 1 $ 行目には，もともとの肉の温度 $ A $ が書かれている．  
$ 2 $ 行目には，目的の温度 $ B $ が書かれている．  
$ 3 $ 行目には，凍った肉を $ 1 $ ℃温めるのにかかる時間 $ C $ が書かれている．  
$ 4 $ 行目には，凍った肉を解凍するのにかかる時間 $ D $ が書かれている．  
$ 5 $ 行目には，凍っていない肉を $ 1 $ ℃温めるのにかかる時間 $ E $ が書かれている．

もともとの温度 $ A $ は $ -100 $ 以上 $ 100 $ 以下，目的の温度 $ B $ は $ 1 $ 以上 $ 100 $ 以下であり，$ A\ \neq\ 0 $ および $ A\ <\ B $ を満たす．

## 输出格式

肉を $ B $ ℃にするのにかかる秒数を $ 1 $ 行で出力せよ．

- - - - - -

## 说明/提示

### Sample Explanation 1

入出力例 $ 1 $ では，もともとの肉は $ -10 $ ℃で凍っている．かかる時間は以下のようになる． - $ -10 $ ℃から $ 0 $ ℃まで温めるのに $ 5\ \times\ 10\ =\ 50 $ 秒． - $ 0 $ ℃の肉を解凍するのに $ 10 $ 秒． - $ 0 $ ℃から $ 20 $ ℃まで温めるのに $ 3\ \times\ 20\ =\ 60 $ 秒． したがって，かかる時間の合計は $ 120 $ 秒である． - - - - - -

### Sample Explanation 2

入出力例 $ 2 $ では，もともとの肉は凍っていない．したがって，肉を $ 35 $ ℃から $ 92 $ ℃まで温めるのにかかる時間は $ 627 $ 秒である．

## 样例 #1

### 输入

```
-10
20
5
10
3
```

### 输出

```
120
```

## 样例 #2

### 输入

```
35
92
31
50
11
```

### 输出

```
627
```



---

---
title: "コピー&ペースト 2"
layout: "post"
diff: 普及/提高-
pid: AT_joisc2015_a
tag: ['模拟', '字符串', '2015', 'JOI（日本）']
---

# コピー&ペースト 2

## 题目描述

### 题意描述

最初 JOI 君给了你一个字符串 $s$，现在对这个字符串进行 $n$ 次操作，每次操作使得位置 $a_i$ 到 $b_i$ 的子串挪到位置 $c_i$。这里的位置可以这样理解：第 $i$ 个位置就是这个字符串的第 $i$ 个字符与第 $i+1$ 个字符之间的空隙。

但是，JOI 君怕复制的东西太多，所以他觉得如果字符数超过 $m$ 个就清除第 $m$ 个字符之后的所有字符。

现在，JOI 君想知道通过这样的复制粘贴得到的最终的字符串的前 $k$ 个字符。

对于 $100\%$ 的数据，$1\le k\le 200$，$1\le m\le 10^9$，$k\le |s|\le \min\{m,2\times 10^5\}$，$1\le n\le 2\times 10^5$。

## 输入格式

第一行两个空格分隔的正整数 $K$ 和 $M$，表示最终输出的文字数量和字符串长度的上限。
第二行一个字符串 $S$，表示初始的字符串。
第三行一个整数 $N$，表示操作的次数。
接下来 $N$ 行，第 $i$ 行包含三个空格分隔的整数 $A_i,B_i,C_i$，表示第 $i$ 次操作将位置 $A_i$ 到 $B_i$ 之间的字符串复制，然后粘贴到位置 $C_i$。

## 输出格式

输出一行一个长度为K的字符串，表示最终的字符串的长度为 $K$ 的前缀。

### 样例解释

初始的字符串为 `copypaste`。

- 第一次操作将从位置 $3$ 到位置 $6$ 的字符串 `ypa` 复制，插入位置 $8$，得到字符串 `copypastypae`；
- 第二次操作将从位置 $1$ 到位置 $5$ 的字符串 `opyp` 复制，插入位置 $2$，得到字符串 `coopyppypastypae`；
- 第三次操作将从位置 $4$ 到位置 $12$ 的字符串 `yppypast` 复制，插入位置 $1$，得到字符串 `cyppypastoopyppypastypae`，由于长度超过了 $M=18$，删除超过的部分，得到 `cyppypastoopyppypa`。
- 第四次操作将从位置 $17$ 到位置 $18$ 的字符串 `a` 复制，插入位置 $0$，得到字符串 `acyppypastoopyppypa`，删除超过 $18$ 的部分得到 `acyppypastoopyppyp`。

最后输出长度为 $2$ 的前缀 `ac` 即为答案。

## 说明/提示

- 对于 $40\%$ 的数据，$1\le N,M\le 2000$；
- 对于 $100\%$ 的数据，$1\le K\le 200$，$1\le M\le 10^9$，$S$ 的每个字符都是小写英文字母，$K\le |S|<=\min(M,2\times 10^5)$，$1\le N\le 2\times 10^5$，设第 $i$ 次操作前的字符串长度为 $L_i$，那么 $0\le A_i<B_i\le L_i$ 且 $0\le C_i\le L_i\ (1\le i\le N)$。



---

---
title: "紅茶(Tea)"
layout: "post"
diff: 普及/提高-
pid: AT_k2pc001_h1
tag: ['模拟']
---

# 紅茶(Tea)

## 题目描述

一天，$\mathrm{kagamiz}$ 一边喝红茶，一边尝试解答如下的问题：

当由两个正整数所组成的正整数组以如下方式排列时，$(m,n)$ 是这个数列里的第几组？

$$(1,1),(2,1),(1,2),(3,1),(2,2),(1,3),(4,1),(3,2),(2,3),(1,4),(5,1),\cdots$$

这个问题对他来说太简单了，所以他更深入地考虑了以下这个问题：

当上述数列中的 $i$ 个组为 $(a_i,b_i)$，第 $j$ 个组为 $(a_j,b_j)$ 时，$(a_i+a_j,b_i+b_j)$ 是这个数列里的第几组？

你的任务就是帮助他解答这个问题。

## 输入格式

输入仅一行，为两个**正**整数 $i,j$。

## 输出格式

输出为一个正整数，表示当上述数列中的第 $i$ 个组为 $(a_i,b_i)$，第 $j$ 个组为 $(a_j,b_j)$ 时，$(a_i+a_j,b_i+b_j)$ 是这个数列里的第几组。

## 说明/提示

对于所有测试数据，$1\leq i,j\leq10^8$，且 $i,j$ 可能相等。



---

---
title: "停止問題"
layout: "post"
diff: 普及/提高-
pid: AT_utpc2011_4
tag: ['模拟', '广度优先搜索 BFS', '深度优先搜索 DFS']
---

# 停止問題

## 题目描述

Defunge 程序由一个 $R$ 行 $C$ 列的字符数组组成。下面是一个 Defunge 程序的例子：

```plain
6>--v.
.^--_@
```

Defunge 程序从程序的左上角（即第一行第一列）开始执行。**它的执行方向一开始为"右"**，每次朝着执行方向走一步，**如果走出界了，要跳到另一边**。每走到一个格子上，就要执行这个格子上的命令。 Defunge 程序还有一个存储器，这个存储器只能存储 $[0,15]$ 的一个整数，**存储器一开始存储** $\bold{0}$。

在 Defunge 程序中，有且只有 $11+10=21$ 种命令，下面是它们各自的含义：

- `<`：把执行方向设置为"左"。
- `>`：把执行方向设置为"右"。
- `^`：把执行方向设置为"上"。
- `v`：把执行方向设置为"下"。
- `_`：如果存储器存储的数字是 $0$，就把执行方向设置为"右"，否则设置为"左"。
- `|`：如果存储器存储的数字是 $0$，就把执行方向设置为"下"，否则设置为"上"。
- `?`：把执行方向设置为"上下左右"中的**任意**一个（类似于 dfs 把四个方向全搜一遍）。
- `.`：什么也不做。
- `@`：停止程序。
- `0`-`9`：把存储器设置为这个字符表示的数值。
- `+`：让存储器的数值加 $1$。注意当存储器的数值为 $15$ 时要把它设为 $0$。
- `-`：让存储器的数值减 $1$。注意当存储器的数值为 $0$ 时要把它设为 $15$。

现在，给你一个 Defunge 程序，请判断这个程序是否能停止（即执行到命令`@`）。如果能，输出`YES`，否则输出`NO`。

## 输入格式

第一行两个正整数 $R,C$，表示这个 Defunge 程序有 $R$ 行 $C$ 列。

接下来 $R$ 行，每行有 $C$ 个字符，描述这个 Defunge 程序。

## 输出格式

一行字符串`YES`或`NO`，表示这个程序是否能停止。

【样例】

样例输入 $1$：

```plain
2 6
6>--v.
.^--_@
```

样例输出 $1$：

```plain
YES
```

样例输入 $2$：

```plain
2 6
5>--v.
.^--_@
```

样例输出 $2$：

```plain
NO
```

样例输入 $3$：

```plain
2 6
.>--v.
.^--?@
```

样例输出 $3$：

```plain
YES
```

## 说明/提示

$1\leq R,C\leq 20$，保证程序里只有上文提到的 $21$ 种命令。



---


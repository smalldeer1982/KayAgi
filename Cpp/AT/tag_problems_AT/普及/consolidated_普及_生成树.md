---
title: "[ABC252E] Road Reduction"
layout: "post"
diff: 普及/提高-
pid: AT_abc252_e
tag: ['图论', '最短路', '生成树']
---

# [ABC252E] Road Reduction

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc252/tasks/abc252_e

AtCoder 王国には都市 $ 1,2,\ldots,N $ の $ N $ 個の都市と、道路 $ 1,2,\ldots,M $ の $ M $ 本の道路があります。  
道路 $ i $ は都市 $ A_i $ と $ B_i $ を双方向に結び、距離は $ C_i $ です。  
どの都市間もいくつかの道路を通って行き来することができます。

財政難である王国は、どの都市間もいくつかの道路を通って行き来できるという条件を満たすように $ N-1 $ 本の道路を保守し、それ以外の道路を廃道にすることにしました。

保守する道路のみを通って都市 $ 1 $ から都市 $ i $ へ移動するときの距離を $ d_i $ とするとき、保守する道路の選び方であって、$ d_2+d_3+\ldots+d_N $ を最小化するようなものを $ 1 $ つ出力してください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ M $ $ A_1 $ $ B_1 $ $ C_1 $ $ A_2 $ $ B_2 $ $ C_2 $ $ \vdots $ $ A_M $ $ B_M $ $ C_M $

## 输出格式

保守するような道路の番号を空白区切りで出力せよ。出力の順序は問わない。  
答えが複数存在する場合、どれを出力しても正解とみなされる。

## 说明/提示

### 制約

- $ 2\ \leq\ N\ \leq\ 2\times\ 10^5 $
- $ N-1\ \leq\ M\ \leq\ 2\times\ 10^5 $
- $ 1\ \leq\ A_i\ <\ B_i\ \leq\ N $
- $ i\neq\ j $ のとき、$ (A_i,B_i)\neq(A_j,B_j) $
- $ 1\leq\ C_i\ \leq\ 10^9 $
- どの都市間もいくつかの道路を通って行き来することができる
- 入力に含まれる値は全て整数である

### Sample Explanation 1

保守する道路の選び方と $ d_i $ の値は次のようになります。 - 道路 $ 1,2 $ を保守するとき、$ d_2=1 $, $ d_3=3 $ - 道路 $ 1,3 $ を保守するとき、$ d_2=1 $, $ d_3=10 $ - 道路 $ 2,3 $ を保守するとき、$ d_2=12 $, $ d_3=10 $ よって、道路 $ 1,2 $ を保守するときに $ d_2+d_3 $ が最小になります。

## 样例 #1

### 输入

```
3 3
1 2 1
2 3 2
1 3 10
```

### 输出

```
1 2
```

## 样例 #2

### 输入

```
4 6
1 2 1
1 3 1
1 4 1
2 3 1
2 4 1
3 4 1
```

### 输出

```
3 1 2
```



---

---
title: "[ABC328E] Modulo MST"
layout: "post"
diff: 普及/提高-
pid: AT_abc328_e
tag: ['图遍历', '生成树']
---

# [ABC328E] Modulo MST

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc328/tasks/abc328_e

頂点に $ 1 $ から $ N $ の番号が、辺に $ 1 $ から $ M $ の番号がついた $ N $ 頂点 $ M $ 辺の重み付き単純連結無向グラフと正整数 $ K $ が与えられます。  
辺 $ i\ (1\leq\ i\leq\ M) $ は頂点 $ u\ _\ i $​ と頂点 $ v\ _\ i $ を結んでおり、重みは $ w\ _\ i $ です。

このグラフの全域木 $ T $ に対して、$ T $ のコストを $ T $ に含まれる辺の重みの総和を $ K $ で割ったあまりで定めます。 このグラフの全域木のコストの最小値を求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ M $ $ K $ $ u\ _\ 1 $ $ v\ _\ 1 $ $ w\ _\ 1 $ $ u\ _\ 2 $ $ v\ _\ 2 $ $ w\ _\ 2 $ $ \vdots $ $ u\ _\ M $ $ v\ _\ M $ $ w\ _\ M $

## 输出格式

答えを出力せよ。

## 说明/提示

### 制約

- $ 2\leq\ N\leq8 $
- $ N-1\leq\ M\leq\dfrac{N(N-1)}2 $
- $ 1\leq\ K\leq10^{15} $
- $ 1\leq\ u\ _\ i\lt\ v\ _\ i\leq\ N\ (1\leq\ i\leq\ M) $
- $ 0\leq\ w\ _\ i\lt\ K\ (1\leq\ i\leq\ M) $
- 与えられるグラフは単純かつ連結
- 入力はすべて整数

### Sample Explanation 1

与えられるグラフは次のようになります。 !\[\](https://img.atcoder.jp/abc328/67d2cc2b93ec47687a733cd379c3c07c.png) 辺 $ 1,3,5,6 $ の $ 4 $ 本を含む全域木のコストは $ (99+86+81+95)\bmod{328}=361\bmod{328}=33 $ となります。 このグラフの全域木のコストはすべて $ 33 $ 以上であるため、$ 33 $ を出力してください。

### Sample Explanation 2

このグラフのただ一つの全域木のコスト $ 325437688 $ を出力してください。

### Sample Explanation 3

入力や答えが $ 32\operatorname{bit} $ 整数に収まらない場合があることに注意してください。

## 样例 #1

### 输入

```
5 6 328
1 2 99
1 3 102
2 3 86
2 4 94
2 5 95
3 4 81
```

### 输出

```
33
```

## 样例 #2

### 输入

```
6 5 998244353
1 2 337361568
1 6 450343304
2 3 61477244
2 5 745383438
4 5 727360840
```

### 输出

```
325437688
```

## 样例 #3

### 输入

```
8 28 936294041850197
1 2 473294720906780
1 3 743030800139244
1 4 709363019414774
1 5 383643612490312
1 6 557102781022861
1 7 623179288538138
1 8 739618599410809
2 3 857687812294404
2 4 893923168139714
2 5 581822471860662
2 6 740549363586558
2 7 307226438833222
2 8 447399029952998
3 4 636318083622768
3 5 44548707643622
3 6 307262781240755
3 7 12070267388230
3 8 700247263184082
4 5 560567890325333
4 6 704726113717147
4 7 588263818615687
4 8 549007536393172
5 6 779230871080408
5 7 825982583786498
5 8 713928998174272
6 7 751331074538826
6 8 449873635430228
7 8 11298381761479
```

### 输出

```
11360716373
```



---

---
title: "[ABC352E] Clique Connect"
layout: "post"
diff: 普及/提高-
pid: AT_abc352_e
tag: ['生成树']
---

# [ABC352E] Clique Connect

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc352/tasks/abc352_e

$ N $ 頂点からなる重み付き無向グラフ $ G $ があります。 $ G $ の各頂点には $ 1 $ から $ N $ までの番号が付けられています。 最初、$ G $ には辺が $ 1 $ 本も存在しません。

今から、$ M $ 回の操作を行うことによって $ G $ に辺を追加していきます。 $ i\ (1\leq\ i\leq\ M) $ 回目の操作は以下の通りです。

- $ K_i $ 頂点からなる頂点の部分集合 $ S_i=\lbrace\ A_{i,1},A_{i,2},\dots,A_{i,K_i}\rbrace $ が与えられる。 $ u,v\in\ S_i $ かつ $ u\ <\ v $ を満たす全ての $ u,v $ について、頂点 $ u $ と頂点 $ v $ の間に重み $ C_i $ の辺を追加する。

$ M $ 回の操作を全て行ったとき $ G $ が連結になるか判定し、連結になるならば $ G $ の最小全域木に含まれる辺の重みの総和を求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ M $ $ K_1 $ $ C_1 $ $ A_{1,1} $ $ A_{1,2} $ $ \dots $ $ A_{1,K_1} $ $ K_2 $ $ C_2 $ $ A_{2,1} $ $ A_{2,2} $ $ \dots $ $ A_{2,K_2} $ $ \vdots $ $ K_M $ $ C_M $ $ A_{M,1} $ $ A_{M,2} $ $ \dots $ $ A_{M,K_M} $

## 输出格式

$ M $ 回の操作を全て行ったとき $ G $ が連結にならないならば `-1` を、連結になるならば $ G $ の最小全域木に含まれる辺の重みの総和を出力せよ。

## 说明/提示

### 制約

- $ 2\leq\ N\ \leq\ 2\times\ 10^5 $
- $ 1\leq\ M\ \leq\ 2\times\ 10^5 $
- $ 2\leq\ K_i\ \leq\ N $
- $ \displaystyle\ \sum_{i=1}^{M}\ K_i\ \leq\ 4\times\ 10^5 $
- $ 1\leq\ A_{i,1}\ <\ A_{i,2}\ <\ \dots\ <\ A_{i,K_i}\leq\ N $
- $ 1\leq\ C_i\leq\ 10^9 $
- 入力は全て整数

### Sample Explanation 1

!\[\](https://img.atcoder.jp/abc352/b54e4b0cfe2f7e5974a2b95be370953a.png) 左の図は $ M $ 回の操作を全て行ったあとの $ G $ を、右の図はその最小全域木の $ 1 $ つを表しています（辺の横に書かれた数はその辺の重みを示します）。 最小全域木に含まれる辺の重みの総和は $ 3+2+4=9 $ です。

### Sample Explanation 2

$ M $ 回の操作を全て行っても $ G $ は連結になりません。

## 样例 #1

### 输入

```
4 3
3 3
1 2 3
2 2
1 2
3 4
1 3 4
```

### 输出

```
9
```

## 样例 #2

### 输入

```
3 2
2 1
1 2
2 1
1 2
```

### 输出

```
-1
```

## 样例 #3

### 输入

```
10 5
6 158260522
1 3 6 8 9 10
10 877914575
1 2 3 4 5 6 7 8 9 10
4 602436426
2 6 7 9
6 24979445
2 3 4 5 8 10
4 861648772
2 4 8 9
```

### 输出

```
1202115217
```



---


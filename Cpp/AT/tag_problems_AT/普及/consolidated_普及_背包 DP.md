---
title: "[ABC271D] Flip and Adjust"
layout: "post"
diff: 普及/提高-
pid: AT_abc271_d
tag: ['动态规划 DP', '背包 DP']
---

# [ABC271D] Flip and Adjust

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc271/tasks/abc271_d

両面に整数が書かれたカードが $ N $ 枚あり、$ i\ \,\ (1\ \leq\ i\ \leq\ N) $ 枚目のカードの表には $ a_i $ が、裏には $ b_i $ が書かれています。

あなたは、それぞれのカードについて、表を上に向けて置くか裏を上に向けて置くかを自由に決めることができます。

上に向けられた面に書かれた整数の総和がちょうど $ S $ となるようにカードを置くことができるか判定し、可能ならそのようなカードの置き方の一例を求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ S $ $ a_1 $ $ b_1 $ $ \vdots $ $ a_N $ $ b_N $

## 输出格式

まず、上に向けられた面に書かれた整数の総和がちょうど $ S $ となるようにカードを置くことができるならば `Yes` を、できなければ `No` を出力し、改行せよ。

さらに、そのようにカードを置くことができるならば、カードの置き方を表す `H` および `T` のみからなる長さ $ N $ の文字列を出力せよ。  
 この文字列の $ i\ \,\ (1\ \leq\ i\ \leq\ N) $ 文字目は、$ i $ 枚目のカードを表を上に向けて置くなら `H`、裏を上に向けて置くなら `T` でなければならない。  
 条件を満たすカードの置き方が複数考えられる場合、どれを出力しても正解となる。

## 说明/提示

### 制約

- $ 1\ \leq\ N\ \leq\ 100 $
- $ 1\ \leq\ S\ \leq\ 10000 $
- $ 1\ \leq\ a_i,\ b_i\ \leq\ 100\ \,\ (1\ \leq\ i\ \leq\ N) $
- 入力は全て整数

### Sample Explanation 1

例えば次のように置くことで、上に向けられた面に書かれた整数の総和がちょうど $ S\ (=\ 11) $ となります。 - $ 1 $ 枚目は表、$ 2 $ 枚目は裏、$ 3 $ 枚目は裏を上に向けて置く。 - $ 1 $ 枚目は裏、$ 2 $ 枚目は表、$ 3 $ 枚目は表を上に向けて置く。 よって、`HTT` や `THH` といった出力が正解となります。

### Sample Explanation 2

上に向けられた面に書かれた整数の総和がちょうど $ S\ (=\ 25) $ となるようにカードを置くことはできません。

## 样例 #1

### 输入

```
3 11

1 4

2 3

5 7
```

### 输出

```
Yes

THH
```

## 样例 #2

### 输入

```
5 25

2 8

9 3

4 11

5 1

12 6
```

### 输出

```
No
```



---

---
title: "[ABC317D] President"
layout: "post"
diff: 普及/提高-
pid: AT_abc317_d
tag: ['背包 DP']
---

# [ABC317D] President

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc317/tasks/abc317_d

高橋君と青木君が選挙で戦っています。  
 選挙区は $ N $ 個あります。$ i $ 番目の選挙区には $ X_i\ +\ Y_i $ 人の有権者がいて、そのうち $ X_i $ 人が高橋派、$ Y_i $ 人が青木派です。($ X_i\ +\ Y_i $ はすべて奇数です)  
 それぞれの区では、多数派がその区の $ Z_i $ 議席を全て獲得します。そして、$ N $ 個の選挙区全体として過半数の議席を獲得した方が選挙に勝利します。($ \displaystyle\ \sum_{i=1}^N\ Z_i $ は奇数です)  
 高橋君が選挙で勝利するには最低で何人を青木派から高橋派に鞍替えさせる必要がありますか？

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ X_1 $ $ Y_1 $ $ Z_1 $ $ X_2 $ $ Y_2 $ $ Z_2 $ $ \vdots $ $ X_N $ $ Y_N $ $ Z_N $

## 输出格式

答えを出力せよ。

## 说明/提示

### 制約

- $ 1\ \leq\ N\ \leq\ 100 $
- $ 0\ \leq\ X_i,\ Y_i\ \leq\ 10^9 $
- $ X_i\ +\ Y_i $ は奇数
- $ 1\ \leq\ Z_i $
- $ \displaystyle\ \sum_{i=1}^N\ Z_i\ \leq\ 10^5 $
- $ \displaystyle\ \sum_{i=1}^N\ Z_i $ は奇数
 
### Sample Explanation 1

選挙区が $ 1 $ 個しかないので、$ 1 $ 番目の選挙区で議席を獲得した人が選挙に勝利します。 $ 1 $ 番目の選挙区の青木派 $ 3 $ 人を高橋派に鞍替えさせると、$ 1 $ 番目の選挙区にいる有権者のうち高橋派は $ 6 $ 人、青木派は $ 5 $ 人になり、高橋君は議席を獲得できます。

### Sample Explanation 2

$ 1 $ 番目の選挙区の議席数よりも $ 2 $ 番目の選挙区の議席数の方が多いため、高橋君が選挙に勝つには $ 2 $ 番目の選挙区で高橋派を多数派にする必要があります。 $ 2 $ 番目の選挙区の青木派の $ 4 $ 人を鞍替えさせると高橋君は $ 5 $ 議席を獲得できます。このとき青木君の獲得する議席は $ 2 $ 議席なので、高橋君は選挙に勝利できます。

### Sample Explanation 3

青木派から高橋派に鞍替えする人が $ 0 $ 人でも高橋君が選挙で勝つ場合は $ 0 $ 人が答えになります。

## 样例 #1

### 输入

```
1

3 8 1
```

### 输出

```
3
```

## 样例 #2

### 输入

```
2

3 6 2

1 8 5
```

### 输出

```
4
```

## 样例 #3

### 输入

```
3

3 4 2

1 2 3

7 2 6
```

### 输出

```
0
```

## 样例 #4

### 输入

```
10

1878 2089 16

1982 1769 13

2148 1601 14

2189 2362 15

2268 2279 16

2394 2841 18

2926 2971 20

3091 2146 20

3878 4685 38

4504 4617 29
```

### 输出

```
86
```



---

---
title: "[ABC321F] #(subset sum = K) with Add and Erase"
layout: "post"
diff: 普及/提高-
pid: AT_abc321_f
tag: ['动态规划 DP', '背包 DP']
---

# [ABC321F] #(subset sum = K) with Add and Erase

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc321/tasks/abc321_f

箱を用意します。最初、箱は空です。  
この箱に対して、以下の $ 2 $ 種類の操作を合計 $ Q $ 個、入力で与えられた順に施します。

> \+ $ x $

タイプ $ 1 $ : 箱の中に整数 $ x $ の書かれたボールを $ 1 $ つ追加する。

> \- $ x $

タイプ $ 2 $ : 箱の中にある、整数 $ x $ の書かれたボールを $ 1 $ つ取り除く。  
**但し、取り除く前の時点で箱の中に整数 $ x $ が書かれたボールが含まれることが保証されます。**

各操作後の箱に関して、以下の問題を解いてください。

> 箱からボールをいくつか取り出して、ボールに書かれた整数の総和を $ K $ とする方法の総数を $ 998244353 $ で割った余りを求めてください。  
> 但し、箱の中に入っている全てのボールは区別可能です。

## 输入格式

入力は以下の形式で標準入力から与えられる。  
但し、 $ \rm{Query} $$ _{i} $ は $ i $ 個目の操作を表す。

> $ Q $ $ K $ $ \rm{Query} $$ _{1} $ $ \rm{Query} $$ _{2} $ $ \vdots $ $ \rm{Query} $$ _{Q} $

## 输出格式

全体で $ Q $ 行出力せよ。  
そのうち $ i $ 行目には、 $ i $ 個目までの操作を終えた時点での答えを出力せよ。

## 说明/提示

### 制約

- 入力は全て整数
- $ 1\ \le\ Q\ \le\ 5000 $
- $ 1\ \le\ K\ \le\ 5000 $
- タイプ $ 1 $ の操作に関して、 $ 1\ \le\ x\ \le\ 5000 $
- 全ての操作は問題文中の条件を満たす。

### Sample Explanation 1

この入力には、操作が $ 15 $ 個含まれます。 最後の操作の後、箱の中に入ったボールは $ (5,10,1,3,1,7,4) $ となります。 総和を $ 10 $ にする方法は以下の $ 5 $ 通りです。 - $ 5+1+3+1 $ ( $ 1,3,4,5 $ 番目のボールを取り出す ) - $ 5+1+4 $ ( $ 1,3,7 $ 番目のボールを取り出す ) - $ 5+1+4 $ ( $ 1,5,7 $ 番目のボールを取り出す ) - $ 10 $ ( $ 2 $ 番目のボールを取り出す ) - $ 3+7 $ ( $ 4,6 $ 番目のボールを取り出す )

## 样例 #1

### 输入

```
15 10
+ 5
+ 2
+ 3
- 2
+ 5
+ 10
- 3
+ 1
+ 3
+ 3
- 5
+ 1
+ 7
+ 4
- 3
```

### 输出

```
0
0
1
0
1
2
2
2
2
2
1
3
5
8
5
```



---

---
title: "[ABC327E] Maximize Rating"
layout: "post"
diff: 普及/提高-
pid: AT_abc327_e
tag: ['动态规划 DP', '背包 DP']
---

# [ABC327E] Maximize Rating

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc327/tasks/abc327_e

高橋君は $ N $ 回コンテストに参加し、$ i $ 回目に参加したコンテストにおいてパフォーマンス $ P_i $ を獲得しました。  
高橋君はこの中から ($ 1 $ つ以上) いくつかのコンテストを選び、それらの結果から計算される高橋君のレートを最大にしたいと考えています。

コンテストをうまく選んだとき、高橋君のレートとしてあり得る最大の値を求めてください。

ただし、高橋君のレート $ R $ は、高橋君の選んだコンテストの数が $ k $ 個であり、 選んだコンテストにおけるパフォーマンスが **参加した順に** それぞれ $ (Q_1,Q_2,\ldots,Q_k) $ であるとき、

$ \displaystyle\ R=\frac{\sum_{i=1}^k\ (0.9)^{k-i}Q_i}{\sum_{i=1}^k\ (0.9)^{k-i}}-\frac{1200}{\sqrt{k}} $ によって計算されます。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ P_1 $ $ P_2 $ $ \ldots $ $ P_N $

## 输出格式

高橋君のレートとしてあり得る最大の値を出力せよ。  
出力は、真の値との絶対誤差または相対誤差が $ 10^{-6} $ 以下のとき正解と判定される。

## 说明/提示

### 制約

- $ 1\leq\ N\leq\ 5000 $
- $ 1\leq\ P_i\leq\ 5000 $
- 入力はすべて整数

### Sample Explanation 1

高橋君が $ 1 $ 回目と $ 3 $ 回目のコンテストを選んだ時、レートは、 $ \displaystyle\ R=\frac{0.9\times\ 1000+\ 1.0\times\ 1200}{0.9+1.0}-\frac{1200}{\sqrt{2}}=256.73502... $ となり、この時レートが最大となります。

### Sample Explanation 2

$ 1,2,3 $ 回目のコンテストすべてを選んだとき、レートが最大となります。

### Sample Explanation 3

レートは負になることもあります。

## 样例 #1

### 输入

```
3
1000 600 1200
```

### 输出

```
256.735020470879931
```

## 样例 #2

### 输入

```
3
600 1000 1200
```

### 输出

```
261.423219407873376
```

## 样例 #3

### 输入

```
1
100
```

### 输出

```
-1100.000000000000000
```



---

---
title: "[ABC344D] String Bags"
layout: "post"
diff: 普及/提高-
pid: AT_abc344_d
tag: ['动态规划 DP', '背包 DP']
---

# [ABC344D] String Bags

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc344/tasks/abc344_d

あなたは最初、空文字列 $ S $ を持っています。  
 さらに、文字列がいくつか入った袋 $ 1,2,\dots,N $ があります。  
 袋 $ i $ には $ A_i $ 個の文字列 $ S_{i,1},S_{i,2},\dots,S_{i,A_i} $ が入っています。

これから、以下の手順を $ i=1,2,\dots,N $ について繰り返します。

- 以下のふたつの行動のうち、どちらかを選択して行う。
  - $ 1 $ 円を支払い、袋 $ i $ からちょうどひとつの文字列を選択して $ S $ の末尾に連結する。
  - 何もしない。
 
文字列 $ T $ が与えられるとき、最終的に $ S $ と $ T $ を一致させるために必要な最小の金額を求めてください。  
 但し、どのようにしても最終的な $ S $ を $ T $ に一致させることができない場合、 `-1` と出力してください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ T $ $ N $ $ A_1 $ $ S_{1,1} $ $ S_{1,2} $ $ \dots $ $ S_{1,A_1} $ $ A_2 $ $ S_{2,1} $ $ S_{2,2} $ $ \dots $ $ S_{2,A_2} $ $ \vdots $ $ A_N $ $ S_{N,1} $ $ S_{N,2} $ $ \dots $ $ S_{N,A_N} $

## 输出格式

答えを整数として出力せよ。

## 说明/提示

### 制約

- $ T $ は長さ $ 1 $ 以上 $ 100 $ 以下の英小文字からなる文字列
- $ N $ は $ 1 $ 以上 $ 100 $ 以下の整数
- $ A_i $ は $ 1 $ 以上 $ 10 $ 以下の整数
- $ S_{i,j} $ は長さ $ 1 $ 以上 $ 10 $ 以下の英小文字からなる文字列
 
### Sample Explanation 1

例えば、以下のようにすると $ 2 $ 円で最終的な $ S $ と $ T $ を一致させることができ、これが必要な金額の最低値であることが示せます。 - $ i=1 $ について、袋 $ 1 $ から `abc` を選択し $ S $ の末尾に連結する。 $ S= $ `abc` となる。 - $ i=2 $ について、何もしない。 - $ i=3 $ について、袋 $ 3 $ から `de` を選択し $ S $ の末尾に連結する。 $ S= $ `abcde` となる。

### Sample Explanation 2

どのようにしても最終的な $ S $ と $ T $ を一致させることができないので、 `-1` と出力してください。

## 样例 #1

### 输入

```
abcde

3

3 ab abc abcd

4 f c cd bcde

2 e de
```

### 输出

```
2
```

## 样例 #2

### 输入

```
abcde

3

2 ab abc

3 f c bcde

1 e
```

### 输出

```
-1
```

## 样例 #3

### 输入

```
aaabbbbcccc

6

2 aa aaa

2 dd ddd

2 ab aabb

4 bbaa bbbc bbb bbcc

2 cc bcc

3 ccc cccc ccccc
```

### 输出

```
4
```



---

---
title: "[ABC410E] Battles in a Row"
layout: "post"
diff: 普及/提高-
pid: AT_abc410_e
tag: ['动态规划 DP', '背包 DP']
---

# [ABC410E] Battles in a Row

## 题目描述

高桥在玩游戏，他要**按顺序**对战 $N$ 只怪兽，初始时，高桥有 $H$ 点体力和 $M$ 点魔力。

对于第 $i$ 只怪兽，高桥可以选择：
- 使用体力战斗，当且仅当高桥当前体力 $\ge A_i$ 时可以选择，高桥花费 $A_i$ 点体力击败第 $i$ 只怪兽。
- 使用魔力战斗，当且仅当高桥当前魔力 $\ge B_i$ 时可以选择，高桥花费 $B_i$ 点魔力击败第 $i$ 只怪兽。

当高桥面对某只怪兽时无法进行上述任意一种战斗或所有 $N$ 只怪兽均被击败时，游戏结束。求他最多能击败多少只怪兽。

## 输入格式

第一行三个整数 $N,H,M(1\le N,H,M\le 3000)$。\
接下来 $N$ 行，每行两个整数 $A_i,B_i(1\le A_i,B_i\le 3000)$ 描述高桥要击败的第 $i$ 只怪兽。

## 输出格式

输出一行一个整数表示答案。

## 说明/提示

**样例 1 解释**

高桥可以击败 $3$ 只怪兽，一种可能的进程如下：
- 初始时，高桥有 $10$ 点体力和 $14$ 点魔力。
- 对于第一只怪兽，高桥使用体力战斗，剩余 $5$ 点体力和 $14$ 点魔力。
- 对于第二只怪兽，高桥使用体力战斗，剩余 $0$ 点体力和 $14$ 点魔力。
- 对于第三只怪兽，高桥使用魔力战斗，剩余 $5$ 点体力和 $5$ 点魔力。
- 对于第四只怪兽，高桥无法进行战斗，游戏结束。

**样例 2 解释**

高桥可以击败所有的 $N$ 只怪兽。

By @[chenxi2009](/user/1020063)

## 样例 #1

### 输入

```
4 10 14

5 8

5 6

7 9

99 99
```

### 输出

```
3
```

## 样例 #2

### 输入

```
3 3000 3000

3 3

3 3

3 3
```

### 输出

```
3
```

## 样例 #3

### 输入

```
10 8 8

2 2

2 3

2 2

1 2

2 3

1 2

3 3

3 2

3 1

3 2
```

### 输出

```
9
```



---

---
title: "haruki の覚醒め"
layout: "post"
diff: 普及/提高-
pid: AT_code_festival_relay_g
tag: ['动态规划 DP', '枚举', '背包 DP']
---

# haruki の覚醒め

## 题目描述

[problemUrl]: https://atcoder.jp/contests/code-festival-2014-relay/tasks/code_festival_relay_g

haruki さんは朝に弱いことで有名です。haruki さんの家には目覚まし時計が $ n $ 個あり、$ i $ 番目の目覚まし時計の音量は $ a_i $ です。

   
haruki さんは鳴っている目覚まし時計の音量の合計が $ m $ 以上にならない限り、目を覚ますことはありません。しかしながら、必要以上に目覚まし時計をセットすると、うるさくて近所迷惑になってしまいます。

   
そこで、合計の音量が $ m $ 以上でかつ最小となるように目覚まし時計を選んだとき、その合計の音量を求めてください。

## 输入格式

入力は以下の形式で与えられる。

> $ n $ $ m $ $ a_1 $ $ a_2 $ $ ... $ $ a_n $

- $ 1 $ 行目には、目覚まし時計の数を表す整数 $ n $ ($ 1\ \leq\ n\ \leq\ 50 $) と、目を覚ます最小の音量を表す整数 $ m $ ($ 1\ \leq\ m\ \leq\ 10{,}000 $) が与えられる。
- 続く $ n $ 行には、それぞれの目覚まし時計の音量を表す整数 $ a_i $ ($ 1\ \leq\ a_i\ \leq\ 10{,}000 $) が与えられる。

## 输出格式

合計の音量が $ m $ 以上でかつ最小となるときの合計の音量を $ 1 $ 行で出力せよ。

また、合計の音量が $ m $ に達しない場合は、`-1` を $ 1 $ 行で出力せよ。

最後は改行し、余計な文字、空行を含まないこと。

## 样例 #1

### 输入

```
3 30

25

10

23
```

### 输出

```
33
```

## 样例 #2

### 输入

```
4 101

10

20

30

40
```

### 输出

```
-1
```



---


---
title: "[ABC349G] Palindrome Construction"
layout: "post"
diff: 省选/NOI-
pid: AT_abc349_g
tag: ['Manacher 算法']
---

# [ABC349G] Palindrome Construction

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc349/tasks/abc349_g

長さ $ M $ の正整数列 $ T=(T_1,T_2,\dots,T_M) $ が**回文**であるとは、各 $ i=1,2,\dots,M $ について $ T_i=T_{M-i+1} $ が成り立つこととします。

長さ $ N $ の非負整数列 $ A\ =\ (A_1,A_2,\dots,A_N) $ が与えられます。次の条件を満たす長さ $ N $ の正整数列 $ S=(S_1,S_2,\dots,S_N) $ が存在するか判定し、存在するならば条件を満たすもののうち辞書順最小のものを求めてください。

- 各 $ i=1,2,\dots,N $ に対して、次の両方が成り立つ
  - 列 $ (S_{i-A_i},S_{i-A_i+1},\dots,S_{i+A_i}) $ は回文である
  - $ 2\ \leq\ i-A_i $ かつ $ i+A_i\ \leq\ N-1 $ ならば、列 $ (S_{i-A_i-1},S_{i-A_i},\dots,S_{i+A_i+1}) $ は回文でない

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ A_1 $ $ A_2 $ $ \dots $ $ A_N $

## 输出格式

条件を満たす $ S $ が存在しなければ、 `No` を出力せよ。

条件を満たす $ S $ が存在するならば、そのうち辞書順最小のものを $ S' $ として、以下の形式で出力せよ。

> Yes $ S'_1 $ $ S'_2 $ $ \dots $ $ S'_N $

## 说明/提示

### 制約

- $ 1\ \leq\ N\ \leq\ 2\ \times\ 10^5 $
- $ 0\ \leq\ A_i\ \leq\ \min\{i-1,N-i\} $
- 入力はすべて整数
 
### Sample Explanation 1

$ S\ =\ (1,1,2,1,1,1,2) $ が条件を満たすことを確認します。 - $ i=1 $: $ (A_1)=(1) $ は回文です - $ i=2 $: $ (A_2)=(1) $ は回文であり、 $ (A_1,A_2,A_3)=(1,1,2) $ は回文ではありません - $ i=3 $: $ (A_1,A_2,\dots,A_5)=(1,1,2,1,1) $ は回文です - $ i=4 $: $ (A_4)=(1) $ は回文であり、 $ (A_3,A_4,A_5)=(2,1,1) $ は回文ではありません - $ i=5 $: $ (A_3,A_4,\dots,A_7)=(2,1,1,1,2) $ は回文です - $ i=6 $: $ (A_6)=(1) $ は回文であり、 $ (A_5,A_6,A_7)=(1,1,2) $ は回文ではありません - $ i=7 $: $ (A_7)=(2) $ は回文です 他にも $ S=(2,2,1,2,2,2,1) $ などが条件を満たしますが、そのうち辞書順最小のものである $ (1,1,2,1,1,1,2) $ を出力します。

## 样例 #1

### 输入

```
7

0 0 2 0 2 0 0
```

### 输出

```
Yes

1 1 2 1 1 1 2
```

## 样例 #2

### 输入

```
7

0 1 2 3 2 1 0
```

### 输出

```
Yes

1 1 1 1 1 1 1
```

## 样例 #3

### 输入

```
7

0 1 2 0 2 1 0
```

### 输出

```
No
```



---

---
title: "逆にする関数"
layout: "post"
diff: 省选/NOI-
pid: AT_nikkei2019_2_final_h
tag: ['Manacher 算法']
---

# 逆にする関数

## 题目描述

[problemUrl]: https://atcoder.jp/contests/nikkei2019-2-final/tasks/nikkei2019_2_final_h

$ 1,\ 2,\ \dots\ ,\ m $ からなる数列 $ (v_1,\ v_2,\ \dots,\ v_k) $ と 関数 $ f\colon\ \{1,\dots,m\}\ \to\ \{1,\dots,m\} $ について、 $ f $ が以下の条件を満たすとき、$ f $ が $ (v_1,\ v_2,\ \dots,\ v_k) $ を*逆にする* と言います。

- 数列 $ (f(v_1),\ f(v_2),\ \dots,\ f(v_k)) $ はもとの数列をひっくり返した数列 $ (v_k,\ v_{k-1},\ \dots,\ v_1) $ と一致する

$ 1,\ 2,\ \dots\ ,m $ からなる数列 $ (a_1,\ a_2,\ \dots,\ a_n) $ が与えられます。 この数列の空でない連続部分列は $ \frac{n(n+1)}{2} $ 通りありますが、 逆にする関数が何通り存在するかをこれら全てに対して数え上げて、その総和を $ 998244353 $ で割ったあまりを求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ n $ $ m $ $ a_1 $ $ a_2 $ $ \dots $ $ a_n $

## 输出格式

数列の各連続部分列についての逆にする関数の数の合計を $ 998244353 $ で割ったあまりを出力してください。

## 说明/提示

### 注意

- 関数 $ f $ と $ g $ について $ f(i)\neq\ g(i) $ となる $ i\in\ \{1,\dots,m\} $ が存在するとき $ f $ と $ g $ が異なる関数であるとみなす

### 制約

- $ 1\leq\ n,\ m\ \leq\ 3\times\ 10^5 $
- 各 $ i=1,\ 2,\ \dots,\ n $ について $ 1\leq\ a_i\ \leq\ m $
- 入力はすべて整数である

### Sample Explanation 1

数列 $ (1,\ 1,\ 2) $ の連続部分列は $ (1) $ と $ (1,\ 1) $ と $ (1,\ 1,\ 2) $ と $ (1) $ と $ (1,\ 2) $ と $ (2) $ です。 - 関数 $ f $ が数列 $ (1) $ を逆にするための必要十分条件は $ f(1)=1 $ で、この条件を満たす $ \{1,\ 2,\ 3\} $ 上の関数は $ 9 $ 通りあります。 - 関数 $ f $ が数列 $ (1,\ 1) $ を逆にするための必要十分条件は $ f(1)=1 $ で、この条件を満たす $ \{1,\ 2,\ 3\} $ 上の関数は $ 9 $ 通りあります。 - 関数 $ f $ が数列 $ (1,\ 1,\ 2) $ を逆にするための必要十分条件は $ f(1)=2 $ かつ $ f(1)=1 $ かつ $ f(2)=1 $ で、この条件を満たす関数はありません。 - 関数 $ f $ が数列 $ (1,\ 2) $ を逆にするための必要十分条件は $ f(1)=2 $ かつ $ f(2)=1 $ で、この条件を満たす $ \{1,\ 2,\ 3\} $ 上の関数は $ 3 $ 通りあります。 - 関数 $ f $ が数列 $ (2) $ を逆にするための必要十分条件は $ f(2)=2 $ で、この条件を満たす $ \{1,\ 2,\ 3\} $ 上の関数は $ 9 $ 通りあります。 よって、答えは $ 9\ +\ 9\ +\ 0\ +\ 9\ +\ 3\ +\ 9\ =\ 39 $ です。

### Sample Explanation 2

$ 998244353 $ で割ったあまりを取るのを忘れないようにしてください。

## 样例 #1

### 输入

```
3 3

1 1 2
```

### 输出

```
39
```

## 样例 #2

### 输入

```
20 20

1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20
```

### 输出

```
326566600
```

## 样例 #3

### 输入

```
46 128

109 98 111 106 103 46 51 46 58 50 49 51 106 102 108 108 106 111 48 116 117 116 102 117 111 112 100 48 113 107 47 115 102 101 112 100 117 98 48 48 59 116 113 117 117 105
```

### 输出

```
249064602
```



---

---
title: "ukuku"
layout: "post"
diff: 省选/NOI-
pid: AT_qupc2018_h
tag: ['Manacher 算法']
---

# ukuku

## 题目描述

给定一个长为 $n$ 的整数序列 $a$，表示一个字符串中从前往后数以第 $i$ 位为中心的回文串的最长长度。请输出任意一个满足条件的字符串。数据保证有解。

## 输入格式

第一行为整数 $n$；第二行为 $n$ 个整数，表示序列 $a$。

## 输出格式

输出任意一个长为 $n$ 且符合要求的小写英文字母串即可。

## 说明/提示

#### 数据规模与约定

$1 \le n \le 2 \times 10^5$，$1 \le a_i \le n$。

## 样例 #1

### 输入

```
5

1 3 5 3 1
```

### 输出

```
ukuku
```

## 样例 #2

### 输入

```
7

1 1 3 5 5 3 1
```

### 输出

```
ukekeke
```



---


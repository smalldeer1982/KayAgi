---
title: "[ABC134F] Permutation Oddness"
layout: "post"
diff: 省选/NOI-
pid: AT_abc134_f
tag: []
---

# [ABC134F] Permutation Oddness

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc134/tasks/abc134_f

{$ 1,\ 2,\ ...,\ n $} の順列 $ p $ = {$ p_1,\ p_2,\ ...,\ p_n $} の「奇妙さ」を $ \sum_{i\ =\ 1}^n\ |i\ -\ p_i| $ と定義します。

奇妙さが $ k $ であるような {$ 1,\ 2,\ ...,\ n $} の順列の個数を $ 10^9+7 $ で割った余りを求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ n $ $ k $

## 输出格式

奇妙さが $ k $ であるような {$ 1,\ 2,\ ...,\ n $} の順列の個数を $ 10^9+7 $ で 割った余りを出力せよ。

## 说明/提示

### 制約

- 入力は全て整数である。
- $ 1\ \leq\ n\ \leq\ 50 $
- $ 0\ \leq\ k\ \leq\ n^2 $

### Sample Explanation 1

{$ 1,\ 2,\ 3 $} の順列は $ 6 $ 個存在します。その中で奇妙さが $ 2 $ であるのは {$ 2,\ 1,\ 3 $} と {$ 1,\ 3,\ 2 $} の $ 2 $ つです。

## 样例 #1

### 输入

```
3 2
```

### 输出

```
2
```

## 样例 #2

### 输入

```
39 14
```

### 输出

```
74764168
```



---

---
title: "[ABC136F] Enclosed Points"
layout: "post"
diff: 省选/NOI-
pid: AT_abc136_f
tag: []
---

# [ABC136F] Enclosed Points

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc136/tasks/abc136_f

$ 2 $ 次元平面上の $ N $ 個の点からなる集合 $ S $ があり、$ i $ 番目の点の座標は $ (x_i,\ y_i) $ です。$ N $ 個の点の $ x $ 座標、$ y $ 座標はそれぞれ相異なります。

$ S $ の空でない部分集合 $ T $ に対して $ f(T) $ を、各辺が座標軸と平行であって $ T $ の点を全て含むような最小の長方形に含まれる点の個数として定義します。より正確には、

- $ f(T)\ :=\ T $ に含まれる点について $ x $ 座標の最小値と最大値を それぞれ $ a,\ b $, そして $ y $ 座標の最小値と最大値をそれぞれ $ c,\ d $ としたとき、$ a\ \leq\ x_i\ \leq\ b $ かつ $ c\ \leq\ y_i\ \leq\ d $ を満たす $ 1\ \leq\ i\ \leq\ N $ の個数

$ S $ の空でない全ての部分集合 $ T $ についての $ f(T) $ の和を計算してください。答えは非常に大きくなることがあるので、$ 998244353 $ で割った余りを出力してください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ x_1 $ $ y_1 $ $ : $ $ x_N $ $ y_N $

## 输出格式

$ S $ の空でない全ての部分集合 $ T $ についての $ f(T) $ の和を $ 998244353 $ で割った余りを出力せよ。

## 说明/提示

### 制約

- $ 1\ \leq\ N\ \leq\ 2\ \times\ 10^5 $
- $ -10^9\ \leq\ x_i,\ y_i\ \leq\ 10^9 $
- $ x_i\ \neq\ x_j\ (i\ \neq\ j) $
- $ y_i\ \neq\ y_j\ (i\ \neq\ j) $
- 入力は全て整数である

### Sample Explanation 1

$ 1,\ 2,\ 3 $ 番目の点をそれぞれ $ P_1,\ P_2,\ P_3 $ とします。$ S\ =\ \{P_1,\ P_2,\ P_3\} $ の空でない部分集合は $ 7 $ 個あり、それぞれに対する $ f $ の値は次の通りです。 - $ f(\{P_1\})\ =\ 1 $ - $ f(\{P_2\})\ =\ 1 $ - $ f(\{P_3\})\ =\ 1 $ - $ f(\{P_1,\ P_2\})\ =\ 2 $ - $ f(\{P_2,\ P_3\})\ =\ 2 $ - $ f(\{P_3,\ P_1\})\ =\ 3 $ - $ f(\{P_1,\ P_2,\ P_3\})\ =\ 3 $ これらの和は $ 13 $ です。

### Sample Explanation 3

和を $ 998244353 $ で割った余りを出力することに注意してください。

## 样例 #1

### 输入

```
3

-1 3

2 1

3 -2
```

### 输出

```
13
```

## 样例 #2

### 输入

```
4

1 4

2 1

3 3

4 2
```

### 输出

```
34
```

## 样例 #3

### 输入

```
10

19 -11

-3 -12

5 3

3 -15

8 -14

-9 -20

10 -9

0 2

-7 17

6 -6
```

### 输出

```
7222
```



---

---
title: "[ABC137F] Polynomial Construction"
layout: "post"
diff: 省选/NOI-
pid: AT_abc137_f
tag: []
---

# [ABC137F] Polynomial Construction

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc137/tasks/abc137_f

素数 $ p $ と、長さ $ p $ の $ 0 $ と $ 1 $ からなる整数列 $ a_0,\ \ldots,\ a_{p-1} $ が与えられます。

以下の条件を満たす $ p-1 $ 次以下の多項式 $ f(x)\ =\ b_{p-1}\ x^{p-1}\ +\ b_{p-2}\ x^{p-2}\ +\ \ldots\ +\ b_0 $ を一つ求めてください。

- 各 $ i $ $ (0\ \leq\ i\ \leq\ p-1) $ に対し、$ b_i $ は $ 0\ \leq\ b_i\ \leq\ p-1 $ なる整数
- 各 $ i $ $ (0\ \leq\ i\ \leq\ p-1) $ に対し、$ f(i)\ \equiv\ a_i\ \pmod\ p $

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ p $ $ a_0 $ $ a_1 $ $ \ldots $ $ a_{p-1} $

## 输出格式

条件を満たす多項式 $ f(x) $ の一つにおける $ b_0,\ b_1,\ \ldots,\ b_{p-1} $ の値をこの順に空白区切りで出力せよ。

なお、解は必ず存在することが示せる。複数の解が存在する場合は、そのうちのどれを出力してもよい。

## 说明/提示

### 制約

- $ 2\ \leq\ p\ \leq\ 2999 $
- $ p $ は素数である。
- $ 0\ \leq\ a_i\ \leq\ 1 $

### Sample Explanation 1

$ f(x)\ =\ x\ +\ 1 $ は以下のように条件を満たします。 - $ f(0)\ =\ 0\ +\ 1\ =\ 1\ \equiv\ 1\ \pmod\ 2 $ - $ f(1)\ =\ 1\ +\ 1\ =\ 2\ \equiv\ 0\ \pmod\ 2 $

### Sample Explanation 2

$ f(x)\ =\ 0 $ も有効な出力です。

## 样例 #1

### 输入

```
2

1 0
```

### 输出

```
1 1
```

## 样例 #2

### 输入

```
3

0 0 0
```

### 输出

```
0 0 0
```

## 样例 #3

### 输入

```
5

0 1 0 1 0
```

### 输出

```
0 2 0 1 3
```



---

---
title: "[ABC147F] Sum Difference"
layout: "post"
diff: 省选/NOI-
pid: AT_abc147_f
tag: []
---

# [ABC147F] Sum Difference

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc147/tasks/abc147_f

長さ $ N $ の整数列 $ A $ があり、$ A_1\ =\ X,\ A_{i+1}\ =\ A_i\ +\ D\ (1\ \leq\ i\ <\ N\ ) $ が成り立っています。

高橋君はこの整数列の要素をいくつか選んで取り、残り全てを青木君が取ります。$ 2 $ 人のどちらかが全てを取ることになっても構いません。

高橋君の取った数の和を $ S $, 青木君の取った数の和を $ T $ としたとき、$ S\ -\ T $ として考えられる値は何通りあるでしょうか。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ X $ $ D $

## 输出格式

$ S\ -\ T $ として考えられる値の種類数を出力せよ。

## 说明/提示

### 制約

- $ -10^8\ \leq\ X,\ D\ \leq\ 10^8 $
- $ 1\ \leq\ N\ \leq\ 2\ \times\ 10^5 $
- 入力は全て整数である

### Sample Explanation 1

$ A $ は $ (4,\ 6,\ 8) $ です。 (高橋君, 青木君) の取り方は、 $ ((),\ (4,\ 6,\ 8)),\ ((4),\ (6,\ 8)),\ ((6),\ (4,\ 8)),\ ((8),\ (4,\ 6))),\ ((4,\ 6),\ (8))),\ ((4,\ 8),\ (6))),\ ((6,\ 8),\ (4))),\ ((4,\ 6,\ 8),\ ()) $ の $ 8 $ 通りあります。 $ S\ -\ T $ はそれぞれ $ -18,\ -10,\ -6,\ -2,\ 2,\ 6,\ 10,\ 18 $ であるので、値の種類数は $ 8 $ です。

### Sample Explanation 2

$ A $ は $ (3,\ 0) $ であり、$ S\ -\ T $ として考えられる値は $ -3,\ 3 $ で、種類数は $ 2 $ です。

## 样例 #1

### 输入

```
3 4 2
```

### 输出

```
8
```

## 样例 #2

### 输入

```
2 3 -3
```

### 输出

```
2
```

## 样例 #3

### 输入

```
100 14 20
```

### 输出

```
49805
```



---

---
title: "[ABC155F] Perils in Parallel"
layout: "post"
diff: 省选/NOI-
pid: AT_abc155_f
tag: []
---

# [ABC155F] Perils in Parallel

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc155/tasks/abc155_f

AlDebaran 王国の侵攻によって、AtCoder 王国の各地に爆弾が仕掛けられてしまいました。

幸いにも AtCoder 王国 ABC 隊の健闘により制御装置の一部が手に入ったので、あなたはこれを使って解除を試みることにしました。

仕掛けられた爆弾は $ N $ 個あり、$ 1 $ から $ N $ の番号がついています。爆弾 $ i $ は座標 $ A_i $ にあり、電源は $ B_i=1 $ のときオンに、$ B_i=0 $ のときオフになっています。

制御装置には $ M $ 本のコードがあり、$ 1 $ から $ M $ の番号がついています。コード $ j $ を切ると、座標が $ L_j $ 以上 $ R_j $ 以下の全ての爆弾の電源のオン・オフが切り替わります。

切るコードをうまく選ぶことで全ての爆弾の電源をオフにできるか判定し、できるならばそのようなコードの組合せを $ 1 $ つ出力してください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ M $ $ A_1 $ $ B_1 $ : $ A_N $ $ B_N $ $ L_1 $ $ R_1 $ : $ L_M $ $ R_M $

## 输出格式

全ての爆弾の電源をオフにすることが不可能であれば `-1` と出力せよ。可能であれば、それを達成するコードの組合せを次のように出力せよ。

> $ k $ $ c_1 $ $ c_2 $ $ \dots $ $ c_k $

ここで、$ k $ は切るコードの本数 ($ 0 $ でもよい) である。

また、$ c_1,\ c_2,\ \dots,\ c_k $ は切るコードの番号であり、$ 1\ \leq\ c_1\ <\ c_2\ <\ \dots\ <\ c_k\ \leq\ M $ を満たす必要がある。

## 说明/提示

### 制約

- 入力はすべて整数
- $ 1\ \leq\ N\ \leq\ 10^5 $
- $ 1\ \leq\ A_i\ \leq\ 10^9\ (1\ \leq\ i\ \leq\ N) $
- $ A_i $ は互いに相異なる
- $ B_i $ は $ 0 $ か $ 1 $ のいずれか $ (1\ \leq\ i\ \leq\ N) $
- $ 1\ \leq\ M\ \leq\ 2\ \times\ 10^5 $
- $ 1\ \leq\ L_j\ \leq\ R_j\ \leq\ 10^9\ (1\ \leq\ j\ \leq\ M) $

### Sample Explanation 1

座標 $ 5,\ 10 $ に電源がオンの爆弾が、座標 $ 8 $ に電源がオフの爆弾があります。 コード $ 1 $ を切ると座標 $ 1 $ 以上 $ 10 $ 以下にある爆弾、つまり全ての爆弾の電源が切り替わります。 コード $ 4 $ を切ると座標 $ 8 $ 以上 $ 9 $ 以下にある爆弾、つまり爆弾 $ 3 $ のみの電源が切り替わります。 したがって、コード $ 1,\ 4 $ の $ 2 $ 本を切ることで全ての爆弾の電源がオフになります。

### Sample Explanation 2

切るコードをどう選んでも、全ての爆弾の電源をオフにすることは不可能です。

### Sample Explanation 3

はじめから全ての爆弾の電源がオフなので、コードを切る必要はありません。

### Sample Explanation 4

条件を満たすコードの組合せが複数あり得る場合、どれを出力しても構いません。

## 样例 #1

### 输入

```
3 4

5 1

10 1

8 0

1 10

4 5

6 7

8 9
```

### 输出

```
2

1 4
```

## 样例 #2

### 输入

```
4 2

2 0

3 1

5 1

7 0

1 4

4 7
```

### 输出

```
-1
```

## 样例 #3

### 输入

```
3 2

5 0

10 0

8 0

6 9

66 99
```

### 输出

```
0
```

## 样例 #4

### 输入

```
12 20

536130100 1

150049660 1

79245447 1

132551741 0

89484841 1

328129089 0

623467741 0

248785745 0

421631475 0

498966877 0

43768791 1

112237273 0

21499042 142460201

58176487 384985131

88563042 144788076

120198276 497115965

134867387 563350571

211946499 458996604

233934566 297258009

335674184 555985828

414601661 520203502

101135608 501051309

90972258 300372385

255474956 630621190

436210625 517850028

145652401 192476406

377607297 520655694

244404406 304034433

112237273 359737255

392593015 463983307

150586788 504362212

54772353 83124235
```

### 输出

```
5

1 7 8 9 11
```



---

---
title: "[ABC157F] Yakiniku Optimization Problem"
layout: "post"
diff: 省选/NOI-
pid: AT_abc157_f
tag: []
---

# [ABC157F] Yakiniku Optimization Problem

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc157/tasks/abc157_f

高橋君は二次元平面である網の上で $ N $ 枚の肉を焼こうとしています。 $ i $ 枚目の肉の位置は $ \left(x_i,\ y_i\right) $であり、火の通りにくさは $ c_i $ です。

高橋君は熱源を $ 1 $ つ持っています。熱源を位置 $ \left(X,\ Y\right) $ ($ X,\ Y $は実数)に置くと、 $ i $枚目の肉は、 焼けるまでに $ c_i\ \times\ \sqrt{\left(X\ -\ x_i\right)^2\ +\ \left(Y-y_i\right)^2} $ 秒掛かります。

高橋君は肉を $ K $ 枚食べたいと考えています。 $ K $ 枚以上の肉が焼けるまでに掛かる時間を最小化するように高橋君が熱源を配置したとき、その所要時間を求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ K $ $ x_1 $ $ y_1 $ $ c_1 $ $ \vdots $ $ x_N $ $ y_N $ $ c_N $

## 输出格式

答えを出力せよ。

なお、想定解答との絶対誤差または相対誤差が $ 10^{-6} $ 以下であれば正解として扱われる。

## 说明/提示

### 制約

- 入力は全て整数
- $ 1\ \leq\ N\ \leq\ 60 $
- $ 1\ \leq\ K\ \leq\ N $
- $ -1000\ \leq\ x_i\ ,\ y_i\ \leq\ 1000 $
- $ \left(x_i,\ y_i\right)\ \neq\ \left(x_j,\ y_j\right)\ \left(i\ \neq\ j\ \right) $
- $ 1\ \leq\ c_i\ \leq\ 100 $

### Sample Explanation 1

熱源を $ \left(-0.2,\ 0\right) $に置くと、 $ 2.4 $ 秒後までに $ 1,\ 2,\ 3 $ 枚目の肉が焼けます。これが最適な熱源の置き方です。

## 样例 #1

### 输入

```
4 3

-1 0 3

0 0 3

1 0 2

1 1 40
```

### 输出

```
2.4
```

## 样例 #2

### 输入

```
10 5

-879 981 26

890 -406 81

512 859 97

362 -955 25

128 553 17

-885 763 2

449 310 57

-656 -204 11

-270 76 40

184 170 16
```

### 输出

```
7411.2252
```



---

---
title: "[ABC163F] path pass i"
layout: "post"
diff: 省选/NOI-
pid: AT_abc163_f
tag: []
---

# [ABC163F] path pass i

## 题目描述

给定一棵 $n$ 个点的树，给第 $i$ 个点染上颜色 $c_i$，其中，$c_i$ 为 $[1,n]$ 的一个整数。

现在，对于每一种颜色 $k$，你要求出有多少条简单路径满足路径上至少有一个点的颜色为 $k$。

## 输入格式

第一行一个整数 $n$。

接下来一行 $n$ 个整数，表示 $c_i$。

接下来第 $3$ 到第 $n+1$ 行，每行两个整数 $u_i,v_i$，描述一条树边。

## 输出格式

输出 $n$ 行，一行一个整数，分别表示对于颜色 $1,2,...,n$ 的答案。

## 样例 #1

### 输入

```
3

1 2 1

1 2

2 3
```

### 输出

```
5

4

0
```

## 样例 #2

### 输入

```
1

1
```

### 输出

```
1
```

## 样例 #3

### 输入

```
2

1 2

1 2
```

### 输出

```
2

2
```

## 样例 #4

### 输入

```
5

1 2 3 4 5

1 2

2 3

3 4

3 5
```

### 输出

```
5

8

10

5

5
```

## 样例 #5

### 输入

```
8

2 7 2 5 4 1 7 5

3 1

1 2

2 7

4 5

5 6

6 8

7 8
```

### 输出

```
18

15

0

14

23

0

23

0
```



---

---
title: "[ABC164F] I hate Matrix Construction"
layout: "post"
diff: 省选/NOI-
pid: AT_abc164_f
tag: []
---

# [ABC164F] I hate Matrix Construction

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc164/tasks/abc164_f

整数 $ N $ 及び長さ $ N $ の配列 $ S $, $ T $, $ U $, $ V $ が与えられます。 以下の条件を満たすような $ N×N $ の行列 $ a $ をどれか $ 1 $ つ構築してください。

- $ a_{i,j} $ は整数である。
- $ 0\ \leq\ a_{i,j}\ \lt\ 2^{64} $
- $ S_{i}\ =\ 0 $ のとき $ i $ 行目の要素のビットごとの論理積は $ U_{i} $ である。
- $ S_{i}\ =\ 1 $ のとき $ i $ 行目の要素のビットごとの論理和は $ U_{i} $ である。
- $ T_{i}\ =\ 0 $ のとき $ i $ 列目の要素のビットごとの論理積は $ V_{i} $ である。
- $ T_{i}\ =\ 1 $ のとき $ i $ 列目の要素のビットごとの論理和は $ V_{i} $ である。

ただし、条件を満たす行列が存在しない場合もあるかもしれません。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ S_{1} $ $ S_{2} $ $ ... $ $ S_{N} $ $ T_{1} $ $ T_{2} $ $ ... $ $ T_{N} $ $ U_{1} $ $ U_{2} $ $ ... $ $ U_{N} $ $ V_{1} $ $ V_{2} $ $ ... $ $ V_{N} $

## 输出格式

条件を満たす行列が存在する場合は、そのような行列 $ 1 $ つを以下の形式で出力せよ。

> $ a_{1,1} $ $ ... $ $ a_{1,N} $ $ : $ $ a_{N,1} $ $ ... $ $ a_{N,N} $

条件を満たす行列なら何を出力してもいいことに注意せよ。

条件を満たす行列が存在しない場合は $ -1 $ を出力せよ。

## 说明/提示

### 制約

- 入力は全て整数
- $ 1\ \leq\ N\ \leq\ 500 $
- $ 0\ \leq\ S_{i}\ \leq\ 1 $
- $ 0\ \leq\ T_{i}\ \leq\ 1 $
- $ 0\ \leq\ U_{i}\ \lt\ 2^{64} $
- $ 0\ \leq\ V_{i}\ \lt\ 2^{64} $

### Sample Explanation 1

入力例 $ 1 $ では - $ 1 $ 行目の要素のビットごとの論理積が $ 1 $ - $ 2 $ 行目の要素のビットごとの論理和が $ 1 $ - $ 1 $ 列目の要素のビットごとの論理和が $ 1 $ - $ 2 $ 列目の要素のビットごとの論理積が $ 0 $ の条件を満たす行列を見つける必要があります。

## 样例 #1

### 输入

```
2

0 1

1 0

1 1

1 0
```

### 输出

```
1 1

1 0
```

## 样例 #2

### 输入

```
2

1 1

1 0

15 15

15 11
```

### 输出

```
15 11

15 11
```



---

---
title: "[ABC168F] . (Single Dot)"
layout: "post"
diff: 省选/NOI-
pid: AT_abc168_f
tag: []
---

# [ABC168F] . (Single Dot)

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc168/tasks/abc168_f

無限に広がる草原があります。

この草原上に、大きさが無視できるほど小さい $ 1 $ 頭の牛がいます。牛の今いる点から南に $ x\ \mathrm{cm} $、東に $ y\ \mathrm{cm} $ 移動した点を $ (x,\ y) $ と表します。牛自身のいる点は $ (0,\ 0) $ です。

また、草原には $ N $ 本の縦線と $ M $ 本の横線が引かれています。$ i $ 本目の縦線は点 $ (A_i,\ C_i) $ と点 $ (B_i,\ C_i) $ とを結ぶ線分、$ j $ 本目の横線は点 $ (D_j,\ E_j) $ と点 $ (D_j,\ F_j) $ とを結ぶ線分です。

牛が線分を(端点を含め)通らない限り自由に動き回れるとき、牛が動き回れる範囲の面積は何 $ \mathrm{cm^2} $ でしょうか。この範囲の面積が無限大である場合は代わりに `INF` と出力してください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ M $ $ A_1 $ $ B_1 $ $ C_1 $ $ : $ $ A_N $ $ B_N $ $ C_N $ $ D_1 $ $ E_1 $ $ F_1 $ $ : $ $ D_M $ $ E_M $ $ F_M $

## 输出格式

牛が動き回れる範囲の面積が無限大ならば `INF` を、そうでなければその面積を表す整数 (単位: $ \mathrm{cm^2} $) を出力せよ。

(この問題の制約下で、牛が動き回れる範囲の面積が有限である場合、その面積は必ず整数であることが示せる。)

## 说明/提示

### 制約

- 入力はすべて $ -10^9 $ 以上 $ 10^9 $ 以下の整数
- $ 1\ \leq\ N,\ M\ \leq\ 1000 $
- $ A_i\ <\ B_i\ (1\ \leq\ i\ \leq\ N) $
- $ E_j\ <\ F_j\ (1\ \leq\ j\ \leq\ M) $
- 点 $ (0,\ 0) $ はどの与えられた線分上にも位置しない

### Sample Explanation 1

牛が動き回れる範囲の面積は $ 13\ \mathrm{cm^2} $ です。 !\[Sample 1\](https://img.atcoder.jp/abc168/education.png "Sample 1")

### Sample Explanation 2

牛が動き回れる範囲の面積は無限大です。

## 样例 #1

### 输入

```
5 6

1 2 0

0 1 1

0 2 2

-3 4 -1

-2 6 3

1 0 1

0 1 2

2 0 2

-1 -4 5

3 -2 4

1 2 4
```

### 输出

```
13
```

## 样例 #2

### 输入

```
6 1

-3 -1 -2

-3 -1 1

-2 -1 2

1 4 -2

1 4 -1

1 4 1

3 1 4
```

### 输出

```
INF
```



---

---
title: "[ABC175F] Making Palindrome"
layout: "post"
diff: 省选/NOI-
pid: AT_abc175_f
tag: []
---

# [ABC175F] Making Palindrome

## 题目描述

### 题目大意

有 $N$ 个仅含小写字母的字符串 $S_1,S_2,\cdots,S_N$。你需要把从这些字符串中选择一些以任意顺序拼接起来，同一个字符串可以被选择多次。每选择一次 $S_i$，你都需要花费 $C_i$ 的代价，也就是说你选择 $S_i$ 所花费的代价为 $C_i$ 与 $S_i$ 被选择的次数之积。求使拼接得到的字符串为回文串所需的最小花费。若不管如何都无法拼接成回文串，输出 `-1`。

数据范围：$1 \le N \le 50$，$1 \le |S_i| \le 20$，$1 \le C_i \le 10^9$。

## 输入格式

第一行一个整数 $N$，接下来 $N$ 行每行一个字符串 $S_i$ 和一个整数 $C_i$。

## 输出格式

一个整数，为最小代价或 `-1`。

### 样例解释

样例 1：我们可以分别选择一次 `abc` 与 `ba`，拼接得到回文串 `abcba`，花费为 $(3+4=7)$，为最小值。

样例 2：选择一次 `abcab`，两次 `cba`，拼接得到回文串 `abcabcbacba`，花费为 $(5+3\times2=11)$，为最小值。

样例 3：选择 `ab` 与 `cba` 花费的代价比仅选择 `a` 更少。

样例 4：无法拼成回文串。

（翻译 by @CarroT1212）

## 样例 #1

### 输入

```
3

ba 3

abc 4

cbaa 5
```

### 输出

```
7
```

## 样例 #2

### 输入

```
2

abcab 5

cba 3
```

### 输出

```
11
```

## 样例 #3

### 输入

```
4

ab 5

cba 3

a 12

ab 10
```

### 输出

```
8
```

## 样例 #4

### 输入

```
2

abc 1

ab 2
```

### 输出

```
-1
```



---

---
title: "[ABC176F] Brave CHAIN"
layout: "post"
diff: 省选/NOI-
pid: AT_abc176_f
tag: []
---

# [ABC176F] Brave CHAIN

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc176/tasks/abc176_f

$ 1 $ 以上 $ N $ 以下の整数のうち一つが書かれた $ 3N $ 枚のカードが左右一列に並んでいます。 左から $ i $ 番目のカードに書かれた整数は $ A_i $ です。

以下の操作を $ N-1 $ 回繰り返します。

- 左から $ 5 $ 枚のカードを好きな順に並び替える。その後、左から $ 3 $ 枚のカードを取り除く。このとき、その $ 3 $ 枚のカードに書かれた整数がすべて等しければ $ 1 $ 点を得る。

$ N-1 $ 回の操作の後、残った $ 3 $ 枚のカードに書かれた整数がすべて等しければ追加で $ 1 $ 点を得ます。

得られる得点の最大値を求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ A_1 $ $ A_2 $ $ \cdots $ $ A_{3N} $

## 输出格式

得られる得点の最大値を出力せよ。

## 说明/提示

### 制約

- $ 1\ \leq\ N\ \leq\ 2000 $
- $ 1\ \leq\ A_i\ \leq\ N $

### Sample Explanation 1

左から $ 5 $ 枚のカードを並べ替え、カードに書かれた整数が左から順に $ 2\ 2\ 2\ 1\ 1\ 1 $ となるようにします。 左から $ 3 $ 枚のカードを取り除き、このときこれら $ 3 $ 枚のカードに書かれた整数はすべて $ 2 $ で等しいので $ 1 $ 点を得ます。 カードに書かれた整数は左から順に $ 1\ 1\ 1 $ となります。 残った $ 3 $ 枚のカードに書かれた整数はすべて $ 1 $ でこれも等しいので $ 1 $ 点を得ます。 合計得点は $ 2 $ 点となり、これが最高です。

## 样例 #1

### 输入

```
2

1 2 1 2 2 1
```

### 输出

```
2
```

## 样例 #2

### 输入

```
3

1 1 2 2 3 3 3 2 1
```

### 输出

```
1
```

## 样例 #3

### 输入

```
3

1 1 2 2 2 3 3 3 1
```

### 输出

```
3
```



---

---
title: "[ABC193F] Zebraness"
layout: "post"
diff: 省选/NOI-
pid: AT_abc193_f
tag: []
---

# [ABC193F] Zebraness

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc193/tasks/abc193_f

縦 $ N $ マス、横 $ N $ マスのマス目があります。  
 上から $ i $ 行目、左から $ j $ 列目のマスをマス $ (i,\ j) $ と表すことにします。 マス $ (i,\ j) $ の色の情報が文字 $ c_{i,j} $ により与えられます。  
`B` はマスが黒で塗られていることを、 `W` はマスが白で塗られていることを、 `?` はマスにまだ色が塗られていないことを表します。

高橋くんは、まだ色が塗られていないマスをそれぞれ黒または白で塗り、白黒のマス目を作ります。  
 マス目の **しまうま度** を、辺で接する黒マスと白マスの組の個数と定義します。  
 高橋くんが達成できるしまうま度の最大値を求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ c_{1,1}\ \dots\ c_{1,N} $ $ \hspace{20pt}\vdots $ $ c_{N,1}\ \dots\ c_{N,N} $

## 输出格式

答えを出力せよ。

## 说明/提示

### 制約

- $ 1\ <\ = N\ <\ =\ 100 $
- $ c_{i,\ j} $ は `B`, `W`, `?` のいずれか

### Sample Explanation 1

辺で接する黒マスと白マスの組は、マス $ (1,\ 2) $ とマス $ (2,\ 2) $ 、マス $ (2,\ 1) $ とマス $ (2,\ 2) $ の $ 2 $ 組あるので、しまうま度は $ 2 $ です。

### Sample Explanation 2

マス $ (3,\ 2) $ を白で塗ったときのしまうま度は $ 3 $ 、黒で塗ったときのしまうま度は $ 4 $ です。

## 样例 #1

### 输入

```
2

BB

BW
```

### 输出

```
2
```

## 样例 #2

### 输入

```
3

BBB

BBB

W?W
```

### 输出

```
4
```

## 样例 #3

### 输入

```
5

?????

?????

?????

?????

?????
```

### 输出

```
40
```



---

---
title: "[ABC196F] Substring 2"
layout: "post"
diff: 省选/NOI-
pid: AT_abc196_f
tag: []
---

# [ABC196F] Substring 2

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc196/tasks/abc196_f

`0`, `1` からなる文字列 $ S,\ T $ が与えられます。  
 $ T $ が $ S $ の部分文字列となるように、$ T $ のいくつかの文字を書き換えます。  
 少なくとも何文字書き換える必要がありますか？

 部分文字列とは？ $ S $ のある連続した部分を取り出してできる文字列が $ T $ と一致するとき、$ T $ は $ S $ の部分文字列であるといいます。 例えば、`000` は `10001` の部分文字列ですが、`11` は `10001` の部分文字列ではありません。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ S $ $ T $

## 输出格式

答えを出力せよ。

## 说明/提示

### 制約

- $ S,\ T $ は `0`, `1` からなる
- $ 1\ <\ = |T|\ <\ =\ |S|\ <\ =\ 10^6 $

### Sample Explanation 1

$ T $ を `001` と書き換えると、$ S $ の $ 2 $ 文字目から $ 4 $ 文字目が $ T $ と一致します。

## 样例 #1

### 输入

```
0001

101
```

### 输出

```
1
```

## 样例 #2

### 输入

```
0101010

1010101
```

### 输出

```
7
```

## 样例 #3

### 输入

```
10101000010011011110

0010011111
```

### 输出

```
1
```



---

---
title: "[ABC198F] Cube"
layout: "post"
diff: 省选/NOI-
pid: AT_abc198_f
tag: []
---

# [ABC198F] Cube

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc198/tasks/abc198_f

立方体の各面に $ 1 $ つずつ正の整数を書きます。書かれた $ 6 $ つの数の和が $ S $ になるような書き込み方は何通りありますか？

ただし、立方体を回転した時に一致するような書き込み方は区別しないものとします(数に向きはありません)。

答えは非常に大きくなる可能性があるので、$ 998244353 $ で割ったあまりを求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ S $

## 输出格式

答えを $ 998244353 $ で割った余りを出力せよ。

## 说明/提示

### 制約

- $ 6\ \leq\ S\ \leq\ 10^{18} $
- $ S $ は整数

### Sample Explanation 1

書かれた $ 6 $ つの数が $ (1,1,1,1,1,3) $ であるような書き込み方が $ 1 $ 通り、$ (1,1,1,1,2,2) $ であるような書き込み方が $ 2 $ 通り ($ 2 $ が書かれた面が隣り合うものと反対側に配置されるもの) の、計 $ 3 $ 通りの書き込み方があります。

### Sample Explanation 4

答えを $ 998244353 $ で割ったあまりを求めてください。

## 样例 #1

### 输入

```
8
```

### 输出

```
3
```

## 样例 #2

### 输入

```
9
```

### 输出

```
5
```

## 样例 #3

### 输入

```
50
```

### 输出

```
80132
```

## 样例 #4

### 输入

```
10000000000
```

### 输出

```
2239716
```



---

---
title: "[ABC200F] Minflip Summation"
layout: "post"
diff: 省选/NOI-
pid: AT_abc200_f
tag: []
---

# [ABC200F] Minflip Summation

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc200/tasks/abc200_f

`0`, `1`, `?` のみからなる文字列 $ S $ があります。この文字列を $ K $ 個連結したものを $ T $ とします。  
 この文字列の `?` を全て `0` か `1` に置き換えた文字列は、$ S $ の中に含まれる `?` の数を $ q $ 個とすると、全部で $ 2^{Kq} $ 通り考えられますが、その全てについて以下の問題を解いて、その答えの和を $ (10^9+7) $ で割った余りを求めてください。

> `?` を置き換えた後の文字列を $ T' $ とします。$ T' $ に以下の操作を繰り返し行うことで全ての文字を同じにするとき、必要な最小の操作回数は何回ですか？
> 
> - $ 1\ \le\ l\ \le\ r\ \le\ |T'| $ となる整数 $ l,r $ を選ぶ。そして、$ T' $ の $ l $ 文字目から $ r $ 文字目(両端含む)までの各文字を、`0` であれば `1` に、`1` であれば `0` に変更する。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ S $ $ K $

## 输出格式

答えを整数として出力せよ。

## 说明/提示

### 制約

- $ 1\ \le\ |S|\ \le\ 10^5 $
- $ 1\ \le\ K\ \le\ 10^9 $

### Sample Explanation 1

文字列 $ T= $ `101101` で、ここには `?` が含まれません。よって、考えられる唯一の $ T'= $ `101101` についての答えを求めればよいです。 例えば、`101101` $ \rightarrow $ `110011` $ \rightarrow $ `111111` と操作を行えば、 $ 2 $ 回で全ての文字列を同じにすることができます。 $ 1 $ 回以下の操作で全ての文字列を同じにすることはできません。

### Sample Explanation 2

文字列 $ T' $ として考えられるものは `000`, `001`, `100`, `101` の $ 4 $ 通りです。

### Sample Explanation 3

答えは非常に大きくなることがあるので、 $ (10^9+7) $ で割った余りを求めてください。

## 样例 #1

### 输入

```
101

2
```

### 输出

```
2
```

## 样例 #2

### 输入

```
?0?

1
```

### 输出

```
3
```

## 样例 #3

### 输入

```
10111?10??1101??1?00?1?01??00010?0?1??

998244353
```

### 输出

```
235562598
```



---

---
title: "[ABC201F] Insertion Sort"
layout: "post"
diff: 省选/NOI-
pid: AT_abc201_f
tag: []
---

# [ABC201F] Insertion Sort

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc201/tasks/abc201_f

$ 1 $ から $ N $ までの番号が振られた $ N $ 人の人が左右一列に並んでいます。はじめ、左から $ i $ 番目の人の番号は $ P_i $ です。

あなたの目標は、以下の $ 3 $ 種類の操作を繰り返すことで人々が左から番号の昇順で並んでいるようにすることです。これらの操作は、任意の順に何回でも（$ 0 $ 回でもよい）行うことができます。

- 整数 $ i\ (1\ \leq\ i\ \leq\ N) $ を選ぶ。コスト $ A_i $ を払い、人 $ i $ を好きな位置に移動させる。
- 整数 $ i\ (1\ \leq\ i\ \leq\ N) $ を選ぶ。コスト $ B_i $ を払い、人 $ i $ を左端に移動させる。
- 整数 $ i\ (1\ \leq\ i\ \leq\ N) $ を選ぶ。コスト $ C_i $ を払い、人 $ i $ を右端に移動させる。

目標を達成するまでに支払う合計コストを最小化してください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ P_1 $ $ P_2 $ $ \ldots $ $ P_N $ $ A_1 $ $ B_1 $ $ C_1 $ $ A_2 $ $ B_2 $ $ C_2 $ $ \vdots $ $ A_N $ $ B_N $ $ C_N $

## 输出格式

目標を達成するまでに支払う合計コストの最小値を出力せよ。

## 说明/提示

### 制約

- $ 1\ \leq\ N\ \leq\ 2\ \times\ 10^5 $
- $ 1\ \leq\ P_i\ \leq\ N $
- $ 1\ \leq\ A_i,B_i,C_i\ \leq\ 10^9 $
- $ P_i\ \neq\ P_j\ (i\ \neq\ j) $
- 入力は全て整数

### Sample Explanation 1

コスト $ C_3=6 $ を払って人 $ 3 $ を右端に動かすことで、人々を昇順に並び替えることができます。 これより合計コストが低い並び替え方は存在しないので、答えは $ 6 $ となります。

### Sample Explanation 2

以下の順に操作を行うことで最小値を達成可能です。 - コスト $ B_1=8 $ を払い、人 $ 1 $ を左端に移動させる。 - コスト $ C_5=5 $ を払い、人 $ 5 $ を右端に移動させる。 - コスト $ C_6=2 $ を払い、人 $ 6 $ を右端に移動させる。

## 样例 #1

### 输入

```
3

3 1 2

9 3 5

8 6 4

9 4 6
```

### 输出

```
6
```

## 样例 #2

### 输入

```
6

2 6 5 3 4 1

10 8 16

30 2 10

10 17 8

11 27 22

8 6 5

15 29 2
```

### 输出

```
15
```

## 样例 #3

### 输入

```
9

3 8 4 7 6 9 1 5 2

7976 3696 9706

768 8807 8521

1133 8683 7120

1189 3331 2259

900 7451 1159

6126 2639 7107

5540 8253 2891

8417 4220 9091

8732 1417 1540
```

### 输出

```
15865
```

## 样例 #4

### 输入

```
12

11 9 1 12 2 7 3 5 10 4 6 8

3960 3158 9029

6521 6597 7581

5688 2299 2123

4946 4298 9122

394 4350 9142

3098 7151 2039

8525 3758 6155

6970 3658 9353

9780 1778 3608

6065 5562 923

9701 5524 6482

9395 6016 705
```

### 输出

```
20637
```



---

---
title: "[ABC208F] Cumulative Sum"
layout: "post"
diff: 省选/NOI-
pid: AT_abc208_f
tag: []
---

# [ABC208F] Cumulative Sum

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc208/tasks/abc208_f

非負整数 $ n,\ m $ に対して関数 $ f(n,\ m) $ を正の整数 $ K $ を用いて次のように定めます。

$ \displaystyle\ f(n,\ m)\ =\ \begin{cases}\ 0\ &amp;\ (n\ =\ 0)\ \\ n^K\ &amp;\ (n\ \gt\ 0,\ m\ =\ 0)\ \\ f(n-1,\ m)\ +\ f(n,\ m-1)\ &amp;\ (n\ \gt\ 0,\ m\ \gt\ 0)\ \end{cases} $

$ N,\ M,\ K $ が与えられるので、$ f(N,\ M) $ を $ (10\ ^\ 9\ +\ 7) $ で割った余りを求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ M $ $ K $

## 输出格式

$ f(N,\ M) $ を $ (10\ ^\ 9\ +\ 7) $ で割った余りを出力せよ。

## 说明/提示

### 制約

- $ 0\ \leq\ N\ \leq\ 10^{18} $
- $ 0\ \leq\ M\ \leq\ 30 $
- $ 1\ \leq\ K\ \leq\ 2.5\ \times\ 10^6 $
- 入力は全て整数である。

### Sample Explanation 1

$ K\ =\ 2 $ の時、 $ n\ \leq\ 3,\ m\ \leq\ 4 $ における $ f(n,\ m) $ の値は次のようになります。 $ m\ =\ 0 $ $ m\ =\ 1 $ $ m\ =\ 2 $ $ m\ =\ 3 $ $ m\ =\ 4 $ $ n\ =\ 0 $ $ 0 $ $ 0 $ $ 0 $ $ 0 $ $ 0 $ $ n\ =\ 1 $ $ 1 $ $ 1 $ $ 1 $ $ 1 $ $ 1 $ $ n\ =\ 2 $ $ 4 $ $ 5 $ $ 6 $ $ 7 $ $ 8 $ $ n\ =\ 3 $ $ 9 $ $ 14 $ $ 20 $ $ 27 $ $ 35 $

## 样例 #1

### 输入

```
3 4 2
```

### 输出

```
35
```

## 样例 #2

### 输入

```
0 1 2
```

### 输出

```
0
```

## 样例 #3

### 输入

```
1000000000000000000 30 123456
```

### 输出

```
297085514
```



---

---
title: "[ABC210F] Coprime Solitaire"
layout: "post"
diff: 省选/NOI-
pid: AT_abc210_f
tag: []
---

# [ABC210F] Coprime Solitaire

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc210/tasks/abc210_f

テーブルの上に $ N $ 枚のカードが並んでいます。 $ i\ =\ 1,\ 2,\ \ldots,\ N $ について、$ i $ 枚目のカードの表には整数 $ A_i $ が、裏には整数 $ B_i $ が書かれています。  
 はじめ、すべてのカードは表が見えるように置かれています。

高橋君は好きな枚数（ $ 0 $ 枚でも良い）のカードを選んで裏返します。 その結果、以下の条件が満たされれば高橋君はうれしい気持ちになります。

- $ 1\ \leq\ i\ \lt\ j\ \leq\ N $ を満たす任意の整数のペア $ (i,\ j) $ について、$ i $ 枚目のカードの見えている面に書かれた整数と、$ j $ 枚目のカードの見えている面に書かれた整数が、互いに素である。

高橋君がうれしい気持ちになれる可能性があるかどうかを判定してください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ A_1 $ $ B_1 $ $ A_2 $ $ B_2 $ $ \vdots $ $ A_N $ $ B_N $

## 输出格式

高橋君がうれしい気持ちになれる可能性があるなら `Yes` を、可能性がないなら `No` を出力せよ。

## 说明/提示

### 制約

- $ 1\ \leq\ N\ \leq\ 3\ \times\ 10^4 $
- $ 1\ \leq\ A_i,\ B_i\ \leq\ 2\ \times\ 10^6 $
- 入力はすべて整数

### Sample Explanation 1

はじめ、見えている整数は $ 2,\ 10,\ 4 $ です。 $ 1 $ 枚目のカードと $ 2 $ 枚目のカードを裏返すと、見えている整数は $ 5,\ 9,\ 4 $ となり、高橋君はうれしい気持ちになります。よって `Yes` を出力します。

### Sample Explanation 2

どのようにカードを裏返しても、高橋君はうれしい気持ちになりません。よって `No` を出力します。

## 样例 #1

### 输入

```
3

2 5

10 9

4 8
```

### 输出

```
Yes
```

## 样例 #2

### 输入

```
2

10 100

1000 10000
```

### 输出

```
No
```



---

---
title: "[ABC212H] Nim Counting"
layout: "post"
diff: 省选/NOI-
pid: AT_abc212_h
tag: []
---

# [ABC212H] Nim Counting

## 题目描述

给定两个数 $N,K$，以及一个长度为 $K$ 的整数数组 $(A_1,A_2,\cdots, A_K)$。

两个人玩 [Nim 游戏](https://www.luogu.com.cn/problem/P2197)。

现在通过以下方式生成一个游戏：

> 任意选择一个 $1\le M\le N$，$M$ 表示石子堆数。
> 
> 对于每一堆，其石子数是 $A$ 中任意一个数。

对于 $\sum_{i=1}^N K^i$ 种游戏，求先手获胜的游戏数，答案对 $998244353$ 取模。

## 输入格式

第一行两个数 $N,K$。

第二行 $K$ 个数，第 $i$ 个数为 $A_i$。

## 输出格式

一行一个数，表示答案。

## 说明/提示

- $1\le N\le 2\times 10^5$

- $1\le A_i,K<2^{16}$。

- $A_i$ 两两不同。

### 样例 $1$ 解释

总共有 $6$ 种可能的游戏 $(1),(2),(1,2),(2,1),(1,1),(2,2)$。

其中先手赢的是 $(1),(2),(1,2),(2,1)$,一共 $4$ 种情况。


$\textsf{\textbf{Translated by @\color{5eb95e}nr0728}}.$

## 样例 #1

### 输入

```
2 2

1 2
```

### 输出

```
4
```

## 样例 #2

### 输入

```
100 3

3 5 7
```

### 输出

```
112184936
```



---

---
title: "[ABC213F] Common Prefixes"
layout: "post"
diff: 省选/NOI-
pid: AT_abc213_f
tag: []
---

# [ABC213F] Common Prefixes

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc213/tasks/abc213_f

$ 2 $ つの文字列 $ X,Y $ に対して、その**類似度** $ f(X,Y) $ を、$ X $ と $ Y $ を先頭から見て一致している文字数とします。  
 例えば `abc` と `axbc` の類似度は $ 1 $ 、`aaa` と `aaaa` の類似度は $ 3 $ です。

長さ $ N $ の文字列 $ S $ が与えられます。$ S $ の $ i $ 文字目以降からなる文字列を $ S_i $ とします。$ k=1,\ldots,N $ のそれぞれについて、$ f(S_k,S_1)+f(S_k,S_2)+\ldots+f(S_k,S_N) $ を求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ S $

## 输出格式

$ N $ 行出力せよ。

$ i $ 行目には $ k=i $ の問題の答えを出力せよ。

## 说明/提示

### 制約

- $ 1\ \leq\ N\ \leq\ 10^6 $
- $ S $ は英小文字のみからなる長さ $ N $ の文字列

### Sample Explanation 1

$ S_1,S_2,S_3 $ はそれぞれ `abb`, `bb`, `b` です。 - $ k=1 $ のとき $ f(S_1,S_1)+f(S_1,S_2)+f(S_1,S_3)=3+0+0=3 $ - $ k=2 $ のとき $ f(S_2,S_1)+f(S_2,S_2)+f(S_2,S_3)=0+2+1=3 $ - $ k=3 $ のとき $ f(S_3,S_1)+f(S_3,S_2)+f(S_3,S_3)=0+1+1=2 $

## 样例 #1

### 输入

```
3

abb
```

### 输出

```
3

3

2
```

## 样例 #2

### 输入

```
11

mississippi
```

### 输出

```
11

16

14

12

13

11

9

7

4

3

4
```



---

---
title: "[ABC213H] Stroll"
layout: "post"
diff: 省选/NOI-
pid: AT_abc213_h
tag: []
---

# [ABC213H] Stroll

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc213/tasks/abc213_h

高橋君は家の周りをあてもなく歩き回ることにしました。  
 散歩の間、高橋君は地点 $ 1 $, 地点 $ 2 $, $ \dots $, 地点 $ N $ の $ N $ か所の地点を歩き回ります。ここで、地点 $ 1 $ は自宅です。  
 地点間に道が存在するような地点の組は $ M $ 組あります。 $ i $ 番目の組を $ (a_i,\ b_i) $ とした時、地点 $ a_i $ と地点 $ b_i $ を双方向に結ぶ長さ $ d $ $ (1\ \leq\ d\ \leq\ T) $ キロメートルの道は $ p_{i,\ d} $ 本あります。

高橋君は自宅を出発して $ T $ キロメートル歩いて自宅に戻る散歩コースの本数が知りたくなりました。ここで、長さ $ T $ キロメートルの散歩コースは次のように定義されます。

- 地点と道を交互に並べた列 $ v_0\ =\ 1,\ e_0,\ v_1,\ \dots,e_{k-1},\ v_k\ =\ 1 $ であって、$ e_i $ $ (0\ \leq\ i\ \leq\ k-1) $ が $ v_i $ と $ v_{i+1} $ を結んでいて、 $ e_i $ の長さの和が $ T $ キロメートルである。

あなたは高橋君のかわりに条件を満たす散歩コースの本数を $ 998244353 $ で割ったあまりを求めてください。ただし、$ 2 $ つの散歩コースは列として異なるときに異なるとみなされます。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ M $ $ T $ $ a_1 $ $ b_1 $ $ p_{1,1} $ $ p_{1,2} $ $ \ldots $ $ p_{1,T} $ $ \vdots $ $ a_M $ $ b_M $ $ p_{M,1} $ $ p_{M,2} $ $ \ldots $ $ p_{M,T} $

## 输出格式

条件を満たす散歩コースの本数を $ 998244353 $ で割ったあまりを出力せよ。

## 说明/提示

### 制約

- $ 2\ \leq\ N\ \leq\ 10 $
- $ 1\ \leq\ M\ \leq\ \min\ \left(10,\ \frac{N(N-1)}{2}\ \right) $
- $ 1\ \leq\ T\ \leq\ 4\ \times\ 10^4 $
- $ 1\ \leq\ a_i\ \lt\ b_i\ \leq\ N $
- $ i\ \neq\ j $ ならば $ (a_i,\ b_i)\ \neq\ (a_j,\ b_j) $
- $ 0\ \leq\ p_{i,j}\ \lt\ 998244353 $

### Sample Explanation 1

高橋君の家の周りには、 - 地点 $ 1 $ と地点 $ 2 $ を結ぶ長さ $ 1 $ キロメートルの道が $ 1 $ 本 - 地点 $ 1 $ と地点 $ 3 $ を結ぶ長さ $ 1 $ キロメートルの道が $ 2 $ 本 あります。条件を満たすコースは - 地点 $ 1 $ $ \to $ 地点 $ 2 $ $ \to $ 地点 $ 1 $ の順に巡るコースが $ 1\ \times\ 1\ =\ 1 $ 通り - 地点 $ 1 $ $ \to $ 地点 $ 3 $ $ \to $ 地点 $ 1 $ の順に巡るコースが $ 2\ \times\ 2\ =\ 4 $ 通り の計 $ 5 $ 通りです。

### Sample Explanation 2

高橋君の家の周りには、 - 地点 $ 1 $ と地点 $ 2 $ を結ぶ長さ $ 1 $ キロメートルの道が $ 3 $ 本 - 地点 $ 1 $ と地点 $ 3 $ を結ぶ長さ $ 2 $ キロメートルの道が $ 1 $ 本 - 地点 $ 2 $ と地点 $ 3 $ を結ぶ長さ $ 1 $ キロメートルの道が $ 2 $ 本 あります。条件を満たすコースは、経由する地点を列挙すると - 地点 $ 1 $ $ \to $ 地点 $ 2 $ $ \to $ 地点 $ 1 $ $ \to $ 地点 $ 2 $ $ \to $ 地点 $ 1 $ - 地点 $ 1 $ $ \to $ 地点 $ 2 $ $ \to $ 地点 $ 3 $ $ \to $ 地点 $ 1 $ - 地点 $ 1 $ $ \to $ 地点 $ 2 $ $ \to $ 地点 $ 3 $ $ \to $ 地点 $ 2 $ $ \to $ 地点 $ 1 $ - 地点 $ 1 $ $ \to $ 地点 $ 3 $ $ \to $ 地点 $ 1 $ - 地点 $ 1 $ $ \to $ 地点 $ 3 $ $ \to $ 地点 $ 2 $ $ \to $ 地点 $ 1 $ の $ 5 $ パターンがあり、本数は上から順に $ 81 $ 通り、 $ 6 $ 通り、 $ 36 $ 通り、 $ 1 $ 通り、 $ 6 $ 通りとなります。

## 样例 #1

### 输入

```
3 2 2

1 2

1 0

1 3

2 0
```

### 输出

```
5
```

## 样例 #2

### 输入

```
3 3 4

1 2

3 0 0 0

1 3

0 1 0 0

2 3

2 0 0 0
```

### 输出

```
130
```

## 样例 #3

### 输入

```
2 1 5

1 2

31415 92653 58979 32384 62643
```

### 输出

```
844557977
```



---

---
title: "[ABC214G] Three Permutations"
layout: "post"
diff: 省选/NOI-
pid: AT_abc214_g
tag: []
---

# [ABC214G] Three Permutations

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc214/tasks/abc214_g

$ (1,\ \dots,\ N) $ の順列 $ p\ =\ (p_1,\ \dots,\ p_N),\ q\ =\ (q_1,\ \dots,\ q_N) $ が与えられます。

$ (1,\ \dots,\ N) $ の順列 $ r\ =\ (r_1,\ \dots,\ r_N) $ であって、全ての $ i\ \,\ (1\ \leq\ i\ \leq\ N) $ に対し $ r_i\ \neq\ p_i $ かつ $ r_i\ \neq\ q_i $ となるようなものの総数を $ (10^9\ +\ 7) $ で割った余りを求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ p_1 $ $ \ldots $ $ p_N $ $ q_1 $ $ \ldots $ $ q_N $

## 输出格式

答えを出力せよ。

## 说明/提示

### 制約

- $ 1\ \leq\ N\ \leq\ 3000 $
- $ 1\ \leq\ p_i,\ q_i\ \leq\ N $
- $ p_i\ \neq\ p_j\ \,\ (i\ \neq\ j) $
- $ q_i\ \neq\ q_j\ \,\ (i\ \neq\ j) $
- 入力は全て整数である。

### Sample Explanation 1

$ (3,\ 4,\ 1,\ 2),\ (3,\ 4,\ 2,\ 1),\ (4,\ 3,\ 1,\ 2),\ (4,\ 3,\ 2,\ 1) $ の $ 4 $ つが条件を満たします。

### Sample Explanation 2

答えが $ 0 $ になることもあります。

### Sample Explanation 3

$ (10^9\ +\ 7) $ で割った余りを出力することに注意してください。

## 样例 #1

### 输入

```
4

1 2 3 4

2 1 4 3
```

### 输出

```
4
```

## 样例 #2

### 输入

```
3

1 2 3

2 1 3
```

### 输出

```
0
```

## 样例 #3

### 输入

```
20

2 3 15 19 10 7 5 6 14 13 20 4 18 9 17 8 12 11 16 1

8 12 4 13 19 3 10 16 11 9 1 2 17 6 5 18 7 14 20 15
```

### 输出

```
803776944
```



---

---
title: "[ABC214H] Collecting"
layout: "post"
diff: 省选/NOI-
pid: AT_abc214_h
tag: []
---

# [ABC214H] Collecting

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc214/tasks/abc214_h

$ N $ 頂点 $ M $ 辺の有向グラフがあります。  
 頂点は $ 1,\ \dots,\ N $ と番号付けられており、$ i\ \,\ (1\ \leq\ i\ \leq\ M) $ 番目の辺は頂点 $ A_i $ から頂点 $ B_i $ に向けて張られています。

はじめ、頂点 $ i\ \,\ (\ 1\ \leq\ i\ \leq\ N) $ には $ X_i $ 個の落とし物があります。これらの落とし物を $ K $ 人で拾うことになりました。

$ K $ 人は $ 1 $ 人ずつグラフ上を移動します。各々は次のような行動をとります。

- 頂点 $ 1 $ から出発し、辺をたどって移動することを任意の有限回繰り返す。訪れた各頂点（頂点 $ 1 $ も含む）について、落とし物がまだ拾われていなければ、全て拾う。

合計で最大何個の落とし物を拾うことができるか求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ M $ $ K $ $ A_1 $ $ B_1 $ $ \vdots $ $ A_M $ $ B_M $ $ X_1 $ $ \ldots $ $ X_N $

## 输出格式

答えを出力せよ。

## 说明/提示

### 制約

- $ 2\ \leq\ N\ \leq\ 2\ \times\ 10^5 $
- $ 1\ \leq\ M\ \leq\ 2\ \times\ 10^5 $
- $ 1\ \leq\ K\ \leq\ 10 $
- $ 1\ \leq\ A_i,\ B_i\ \leq\ N $
- $ A_i\ \neq\ B_i $
- $ i\ \neq\ j $ ならば、$ A_i\ \neq\ A_j $ または $ B_i\ \neq\ B_j $
- $ 1\ \leq\ X_i\ \leq\ 10^9 $
- 入力は全て整数である。

### Sample Explanation 1

$ 2 $ 人がそれぞれ次のように行動することで、$ 18 $ 個の落とし物を拾うことができます。 - $ 1 $ 人目は、頂点 $ 1\ \rightarrow\ 2\ \rightarrow\ 3\ \rightarrow\ 2 $ の順に移動し、頂点 $ 1,\ 2,\ 3 $ にある落とし物を拾う。 - $ 2 $ 人目は、頂点 $ 1\ \rightarrow\ 5 $ の順に移動し、頂点 $ 5 $ にある落とし物を拾う。 $ 19 $ 個以上の落とし物を拾うことはできないので、$ 18 $ を出力します。

## 样例 #1

### 输入

```
5 5 2

1 2

2 3

3 2

1 4

1 5

1 4 5 2 8
```

### 输出

```
18
```

## 样例 #2

### 输入

```
3 1 10

2 3

1 100 100
```

### 输出

```
1
```



---

---
title: "[ABC217H] Snuketoon"
layout: "post"
diff: 省选/NOI-
pid: AT_abc217_h
tag: []
---

# [ABC217H] Snuketoon

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc217/tasks/abc217_h

AtCoder 社が開発したゲーム『スヌケトゥーン』は、プレイヤーがすぬけ君を操作して水鉄砲から飛んでくる水を回避するゲームです。

ゲームのステージは無限に続く数直線からなり、ゲーム開始時点ですぬけ君は地点 $ 0 $ にいます。  
 ゲーム開始直後から、すぬけ君は $ 1 $ 秒ごとに「 $ 1 $ 小さい地点に移動」「 $ 1 $ 大きい地点に移動」「動かない」の $ 3 $ 択から行動を選べます。より厳密には、すぬけ君がゲーム開始後 $ t $ 秒 $ (t\ \geq\ 0 $, $ t $ は整数$ ) $ の時点で地点 $ p $ にいるとき、 $ t+1 $ 秒の時点では地点 $ p-1 $ ・地点 $ p $ ・地点 $ p+1 $ の $ 3 $ ヵ所のいずれかに行くことができます。

すぬけ君は水鉄砲から発射された水を浴びるとダメージを受けてしまいます。水鉄砲は $ N $ 回発射されて、 $ i $ 回目の発射は $ T_i,\ D_i,\ X_i $ を用いて次のように表されます。

- ゲーム開始から $ T_i $ 秒後に左右いずれかから水が発射されます。すぬけ君が $ T_i $ 秒の時点でいる地点を $ p $ としたとき、ダメージを受ける範囲および値は次の通りです。 
  - $ D_i\ =\ 0 $ のとき、$ p\ \lt\ X_i $ の範囲にいると $ X_i\ -\ p $ のダメージを受ける。
  - $ D_i\ =\ 1 $ のとき、$ X_i\ \lt\ p $ の範囲にいると $ p\ -\ X_i $ のダメージを受ける。

プロゲーマーの高橋君は、攻略情報をツイートするために $ N $ 回目の水鉄砲の発射が終わった後のすぬけ君の合計ダメージを最小化することにしました。高橋君が合計ダメージを最小化するようにすぬけ君を操作したときの合計ダメージを求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ T_1 $ $ D_1 $ $ X_1 $ $ T_2 $ $ D_2 $ $ X_2 $ $ \vdots $ $ T_N $ $ D_N $ $ X_N $

## 输出格式

高橋君が合計ダメージを最小化するようにすぬけ君を操作したときの合計ダメージを出力せよ。

## 说明/提示

### 制約

- $ 1\ \leq\ N\ \leq\ 2\ \times\ 10^5 $
- $ 1\ \leq\ T_1\ \lt\ T_2\ \lt\ \dots\ \lt\ T_N\ \leq\ 10^9 $
- $ D_i $ $ (1\ \leq\ i\ \leq\ N) $ は $ 0 $ または $ 1 $
- $ -10^9\ \leq\ X_i\ \leq\ 10^9 $ $ (1\ \leq\ i\ \leq\ N) $
- 入力は全て整数である。

### Sample Explanation 1

便宜上 $ t $ をゲーム開始から経過した秒数を表す変数とします。全ての水鉄砲の発射が終了するまでのすぬけ君の最適な動きは以下の通りです。 - $ t\ =\ 0 $ のときすぬけ君は地点 $ 0 $ にいます。すぬけ君は $ 1 $ 大きい地点に移動します。 - $ t\ =\ 1 $ のときすぬけ君は地点 $ 1 $ にいて、 $ 1 $ 回目の水鉄砲の発射により $ 2 $ のダメージを受けます。すぬけ君は $ 1 $ 小さい地点に移動します。 - $ t\ =\ 2 $ のときすぬけ君は地点 $ 0 $ にいます。すぬけ君は移動しません。 - $ t\ =\ 3 $ のときすぬけ君は地点 $ 0 $ にいて、 $ 2 $ 回目の水鉄砲の発射によるダメージを受けません。すぬけ君は $ 1 $ 大きい地点に移動します。 - $ t\ =\ 4 $ のときすぬけ君は地点 $ 1 $ にいて、 $ 3 $ 回目の水鉄砲の発射により $ 5 $ のダメージを受けます。 このときすぬけ君は合計で $ 7 $ のダメージを受けるので、 $ 7 $ を出力します。

## 样例 #1

### 输入

```
3

1 0 3

3 1 0

4 0 6
```

### 输出

```
7
```

## 样例 #2

### 输入

```
3

1 0 1

6 1 1

8 0 -1
```

### 输出

```
0
```

## 样例 #3

### 输入

```
5

1 0 1000000000

2 1 -1000000000

3 0 1000000000

4 1 -1000000000

5 0 1000000000
```

### 输出

```
4999999997
```



---

---
title: "[ABC218H] Red and Blue Lamps"
layout: "post"
diff: 省选/NOI-
pid: AT_abc218_h
tag: []
---

# [ABC218H] Red and Blue Lamps

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc218/tasks/abc218_h

$ 1 $ から $ N $ の番号がついた $ N $ 個のランプが一列に並べられています。あなたはこのうち $ R $ 個を赤く、$ N-R $ 個を青く光らせようとしています。

各 $ i=1,\ldots,N-1 $ について、ランプ $ i $ とランプ $ i+1 $ が異なる色で光っているとき、あなたは $ A_i $ の報酬を得ます。

ランプの色を適切に定めたときに得られる報酬の合計の最大値を求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ R $ $ A_1 $ $ A_2 $ $ \ldots $ $ A_{N-1} $

## 输出格式

答えを出力せよ。

## 说明/提示

### 制約

- $ 2\ \leq\ N\ \leq\ 2\times\ 10^5 $
- $ 1\ \leq\ R\ \leq\ N-1 $
- $ 1\ \leq\ A_i\ \leq\ 10^9 $
- 入力に含まれる値は全て整数である

### Sample Explanation 1

ランプ $ 3,5 $ を赤く、ランプ $ 1,2,4,6 $ を青くすることで、$ A_2+A_3+A_4+A_5=11 $ の報酬を得ます。 これ以上の報酬を得ることはできないため、答えは $ 11 $ です。

### Sample Explanation 2

ランプ $ 1,2,3,4,5,7 $ を赤く、ランプ $ 6 $ を青くすることで、$ A_5+A_6=10 $ の報酬を得ます。

## 样例 #1

### 输入

```
6 2

3 1 4 1 5
```

### 输出

```
11
```

## 样例 #2

### 输入

```
7 6

2 7 1 8 2 8
```

### 输出

```
10
```

## 样例 #3

### 输入

```
11 7

12345 678 90123 45678901 234567 89012 3456 78901 23456 7890
```

### 输出

```
46207983
```



---

---
title: "[ABC219F] Cleaning Robot"
layout: "post"
diff: 省选/NOI-
pid: AT_abc219_f
tag: []
---

# [ABC219F] Cleaning Robot

## 题目描述

# [ABC219F] 清扫机器人

## **问题描述**

一个清扫机器人被放置在无限扩展的二维网格的方格 $(0, 0)$ 上。

给定了一个由四种类型的字符 `L`、`R`、`U`、`D` 组成的字符串程序。  
机器人根据给定的程序，依次读取每个字符，并针对每个字符采取以下行动：

1. 将机器人的当前位置设为方格 $(x, y)$
2. 根据读取的字符执行以下移动：
   - 当读取 `L` 时：向左移动到方格 $(x-1, y)$。
   - 当读取 `R` 时：向右移动到方格 $(x+1, y)$。
   - 当读取 `U` 时：向上移动到方格 $(x, y-1)$。
   - 当读取 `D` 时：向下移动到方格 $(x, y+1)$。

给定一个由 `L`、`R`、`U`、`D` 组成的字符串 $S$ 和整数 $K$。机器人执行的程序是将字符串 $S$ 重复连接 $K$ 次。

一旦机器人访问过的方格（包括机器人的初始位置 $(0, 0)$）就会被清扫。  
请输出在机器人执行程序结束后，被清扫的方格的数量。

## 输入格式

输入通过标准输入给出。

> $S$ $K$

## 输出格式

输出在机器人执行程序结束后，被清扫的方格的数量。

## **样例 #1**

**样例输入 #1**

```
RDRUL
2
```

**样例输出 #1**

```
7
```

**样例 #2**

**样例输入 #2**

```
LR
1000000000000
```

**样例输出 #2**

```
2
```

**样例 #3**

**样例输入 #3**

```
 UUURRDDDRRRUUUURDLLUURRRDDDDDDLLLLLLU
31415926535
```

**样例输出 #3**

```
219911485785
```

## 约束

- $S$是长度介于$1$和$2 \times 10^5$之间（包括$1$和$2 \times 10^5$）的字符串，由“l”、“R”、“u”和“d”组成。

- $1 \leq K \leq 10^{12}$



### 示例输出1

机器人将执行程序“rdrulrdrul”。它将从$(0, 0)$开始，按如下方式运行：

$(0, 0) \rightarrow (1, 0) \rightarrow (1, 1) \rightarrow (2, 1) \rightarrow (2, 0) \rightarrow (1, 0) \rightarrow (2, 0) \rightarrow (2, 1) \rightarrow (3, 1) \rightarrow (3, 0) \rightarrow (2, 0)$. 

最后，七个方块将被清理：$(0, 0), (1, 0), (1, 1), (2, 0), (2, 1), (3, 0), (3, 1)$。

​

## 样例 #1

### 输入

```
RDRUL

2
```

### 输出

```
7
```

## 样例 #2

### 输入

```
LR

1000000000000
```

### 输出

```
2
```

## 样例 #3

### 输入

```
UUURRDDDRRRUUUURDLLUURRRDDDDDDLLLLLLU

31415926535
```

### 输出

```
219911485785
```



---

---
title: "[ABC219H] Candles"
layout: "post"
diff: 省选/NOI-
pid: AT_abc219_h
tag: []
---

# [ABC219H] Candles

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc219/tasks/abc219_h

無限に伸びる数直線の上に $ N $ 本のろうそくが置かれています。 $ i $ 番目のろうそくは座標 $ X_i $ にあり、時刻 $ 0 $ には長さは $ A_i $ で、火がついています。 火のついたろうそくは $ 1 $ 分あたり長さが $ 1 $ 短くなり、長さが $ 0 $ になると燃え尽きてそれ以降長さは変わりません。また、火を消されたろうそくの長さは変わりません。

高橋君は時刻 $ 0 $ に座標 $ 0 $ にいて、毎分 $ 1 $ 以下の距離を移動することができます。高橋君は自分がいる座標と同じ座標にろうそくがある場合、そのろうそくの火を消すことができます。（同じ座標に複数ある場合はまとめて消すことができます。）ここで、ろうそくの火を消すのにかかる時間は無視できます。

高橋君が適切に行動したとき、時刻 $ 0 $ から $ 10^{100} $ 分後に残っているろうそくの長さの総和としてあり得る最大の値を求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ X_1 $ $ A_1 $ $ X_2 $ $ A_2 $ $ : $ $ X_N $ $ A_N $

## 输出格式

答えを出力せよ。

## 说明/提示

### 制約

- $ 1\ \leq\ N\ \leq\ 300 $
- $ -10^9\ \leq\ X_i\ \leq\ 10^9 $
- $ 1\ \leq\ A_i\ \leq\ 10^9 $
- 入力は全て整数である。

### Sample Explanation 1

$ 3 $ 番目のろうそくは座標 $ 12 $ にあるため、高橋君の行動に関わらず火を消すより先に燃え尽きてしまいます。 残りの $ 2 $ 本について、まず座標 $ -2 $ へ $ 2 $ 分かけて移動して $ 1 $ 本目のろうそくの火を消し、その後 $ 5 $ 分かけて座標 $ 3 $ へ移動して $ 2 $ 本目のろうそくの火を消すと、これ以降ろうそくの長さが変化することはありません。 それぞれのろうそくの長さは $ 10-2=8 $ と $ 10-2-5=3 $ 残り、このとき残った長さの総和は $ 8+3=11 $ となって、このときが最大です。 よって、 $ 11 $ を出力します。

### Sample Explanation 2

同じ座標に $ 2 $ つ以上のろうそくが存在する可能性があること、答えが $ 32 $ bit整数に収まらないことがあることに注意してください。

## 样例 #1

### 输入

```
3

-2 10

3 10

12 10
```

### 输出

```
11
```

## 样例 #2

### 输入

```
5

0 1000000000

0 1000000000

1 1000000000

2 1000000000

3 1000000000
```

### 输出

```
4999999994
```



---

---
title: "[ABC220G] Isosceles Trapezium"
layout: "post"
diff: 省选/NOI-
pid: AT_abc220_g
tag: []
---

# [ABC220G] Isosceles Trapezium

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc220/tasks/abc220_g

$ xy $ 平面上に $ N $ 個の点があり、それぞれの点に重みがついています。  
 $ i $ 個目の点の座標は $ (X_i,Y_i) $ で、重みは $ C_i $ です。

$ N $ 点の中から $ 4 $ 点を選んで、それらを頂点とする面積が正の等脚台形を作ります。  
 このとき、選んだ $ 4 $ 点の重みの和の最大値はいくつですか？

等脚台形を作ることができないときは `-1` と出力してください。

なお、等脚台形とは以下の条件を全て満たす四角形のことです。

- 台形である
- 平行な $ 2 $ つの辺のうち、$ 1 $ つの辺の両端の角が等しい

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ X_1 $ $ Y_1 $ $ C_1 $ $ X_2 $ $ Y_2 $ $ C_2 $ $ \vdots $ $ X_N $ $ Y_N $ $ C_N $

## 输出格式

答えを出力せよ。

## 说明/提示

### 制約

- $ 4\ \leq\ N\ \leq\ 1000 $
- $ -10^9\ \leq\ X_i,Y_i\ \leq\ 10^9 $
- $ 1\ \leq\ C_i\ \leq\ 10^9 $
- $ i\ \neq\ j $ ならば $ (X_i,Y_i)\ \neq\ (X_j,Y_j) $
- 入力は全て整数

### Sample Explanation 1

!\[\](https://img.atcoder.jp/ghi/950d55e5491c25b5776d4bec170f313a.png) 点 $ 1,2,3,5 $ を選ぶことで等脚台形を作ることができ、点の重みの和は $ 40 $ です。 それ以外の点の選び方では等脚台形を作ることはできません。

### Sample Explanation 2

!\[\](https://img.atcoder.jp/ghi/5b2010c444d75d8220a5b19a356a3ee9.png) 正方形や長方形も等脚台形に含まれることに注意してください。

### Sample Explanation 3

等脚台形を作ることはできません。

## 样例 #1

### 输入

```
5

0 3 10

3 3 10

-1 0 10

2 0 10000

4 0 10
```

### 输出

```
40
```

## 样例 #2

### 输入

```
6

0 1 1

1 4 20

2 7 300

5 6 4000

4 3 50000

3 0 600000
```

### 输出

```
650021
```

## 样例 #3

### 输入

```
7

-3 0 1

-2 0 1

-1 0 1

0 0 1

1 0 1

2 0 1

3 0 1
```

### 输出

```
-1
```



---

---
title: "[ABC221G] Jumping sequence"
layout: "post"
diff: 省选/NOI-
pid: AT_abc221_g
tag: []
---

# [ABC221G] Jumping sequence

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc221/tasks/abc221_g

無限に広がる $ 2 $ 次元の座標平面を考えます。 高橋君は最初 $ (0,0) $ に立っており、今から上下左右いずれかの方向を選んでジャンプすることを $ N $ 回行います。 それぞれのジャンプで移動する距離は定まっており、具体的には $ i $ 回目のジャンプでは距離 $ D_i $ を移動します。 $ N $ 回のジャンプの後で、ちょうど位置 $ (A,B) $ にいるようにすることは可能か判定し、 可能ならばそのような移動方法を $ 1 $ つ示してください。

ただし、現在の位置が $ (X,Y) $ のときに、それぞれの方向を選んで距離 $ D $ のジャンプをしたときの着地地点はそれぞれ以下の通りです。

- 上方向 : $ (X,Y)\ \to\ (X,Y+D) $
- 下方向 : $ (X,Y)\ \to\ (X,Y-D) $
- 左方向 : $ (X,Y)\ \to\ (X-D,Y) $
- 右方向 : $ (X,Y)\ \to\ (X+D,Y) $

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ A $ $ B $ $ D_1 $ $ D_2 $ $ \ldots $ $ D_N $

## 输出格式

条件をみたす移動方法が存在するならば `Yes` 、そうでないならば `No` を $ 1 $ 行目に出力せよ。  
`Yes` の場合は $ 2 $ 行目に条件をみたす移動方法を、`U` , `D` , `L` , `R` からなる長さ $ N $ の文字列 $ S $ として出力せよ。  
 ただし、$ S $ の $ i $ 文字目が

- `U` のとき、 $ i $ 回目のジャンプでは上方向に移動する
- `D` のとき、 $ i $ 回目のジャンプでは下方向に移動する
- `L` のとき、 $ i $ 回目のジャンプでは左方向に移動する
- `R` のとき、 $ i $ 回目のジャンプでは右方向に移動する

ことを指す。

## 说明/提示

### 制約

- $ 1\ \leq\ N\ \leq\ 2000 $
- $ \lvert\ A\rvert,\ \lvert\ B\rvert\ \leq\ 3.6\times\ 10^6 $
- $ 1\ \leq\ D_i\ \leq\ 1800 $
- 入力は全て整数である。

### Sample Explanation 1

$ 1 $ 回目のジャンプで左方向に、$ 2 $ 回目のジャンプで下方向に、$ 3 $ 回目のジャンプで右方向にジャンプすると、 $ (0,0)\to(-1,0)\to(-1,-2)\to(2,-2) $ と高橋君は動き、 最終的に $ (2,-2) $ に到達しているためこれは条件をみたしています。

### Sample Explanation 2

$ 2 $ 回のジャンプの後でちょうど $ (1,0) $ にいるようにすることはできません。

## 样例 #1

### 输入

```
3 2 -2

1 2 3
```

### 输出

```
Yes

LDR
```

## 样例 #2

### 输入

```
2 1 0

1 6
```

### 输出

```
No
```

## 样例 #3

### 输入

```
5 6 7

1 3 5 7 9
```

### 输出

```
Yes

LRLUR
```



---

---
title: "[ABC221H] Count Multiset"
layout: "post"
diff: 省选/NOI-
pid: AT_abc221_h
tag: []
---

# [ABC221H] Count Multiset

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc221/tasks/abc221_h

正の整数 $ N $, $ M $ が与えられます。

$ k=1,2,\ldots,N $ について以下の値を求め、$ 998244353 $ で割ったあまりをそれぞれ出力してください。

- $ k $ 個の正整数からなる多重集合 $ A $ のうち、以下の $ 2 $ つの条件をすべて満たすものの個数
  - $ A $ に含まれる要素の総和は $ N $
  - 任意の正整数 $ x $ について、$ A $ は $ x $ を高々 $ M $ 個しか含まない

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ M $

## 输出格式

$ N $ 行に渡って出力せよ。$ i\ (1\ \leq\ i\ \leq\ N) $ 行目には、$ k=i $ の場合の答えを出力すること。

## 说明/提示

### 制約

- $ 1\ \leq\ M\ \leq\ N\ \leq\ 5000 $
- 入力はすべて整数

### Sample Explanation 1

\- $ k=1 $ のとき、問題文中の条件を満たすような多重集合 $ A $ は $ \{4\} $ の $ 1 $ 通りです。 - $ k=2 $ のとき、問題文中の条件を満たすような多重集合 $ A $ は $ \{1,3\} $ と $ \{2,2\} $ の $ 2 $ 通りです。 - $ k=3 $ のとき、問題文中の条件を満たすような多重集合 $ A $ は $ \{1,1,2\} $ の $ 1 $ 通りです。 - $ k=4 $ のとき、問題文中の条件を満たすような多重集合 $ A $ は $ 1 $ つも存在しません。

## 样例 #1

### 输入

```
4 2
```

### 输出

```
1

2

1

0
```

## 样例 #2

### 输入

```
7 7
```

### 输出

```
1

3

4

3

2

1

1
```



---

---
title: "[ABC223H] Xor Query"
layout: "post"
diff: 省选/NOI-
pid: AT_abc223_h
tag: []
---

# [ABC223H] Xor Query

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc223/tasks/abc223_h

長さ $ N $ の正整数列 $ A\ =\ (A_1,\ \dots,\ A_N) $ が与えられます。

$ Q $ 個のクエリを処理してください。$ i\ \,\ (1\ \leq\ i\ \leq\ Q) $ 番目のクエリでは、$ A_{L_i},\ A_{L_i\ +\ 1},\ \dots,\ A_{R_i} $ から $ 1 $ つ以上の要素を選び、それらの排他的論理和を $ X_i $ にできるかどうか判定してください。

 排他的論理和とは 整数 $ a,\ b $ のビットごとの排他的論理和 $ a\ \mathrm{xor}\ b $ は、以下のように定義されます。

- $ a\ \mathrm{xor}\ b $ を二進表記した際の $ 2^k\ \,\ (k\ \geq\ 0) $ の位の数は、$ a,\ b $ を二進表記した際の $ 2^k $ の位の数のうち一方のみが $ 1 $ であれば $ 1 $、そうでなければ $ 0 $ である。
 
 例えば、$ 3\ \mathrm{xor}\ 5\ =\ 6 $ となります（二進表記すると: $ 011\ \mathrm{xor}\ 101\ =\ 110 $）。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ Q $ $ A_1 $ $ \ldots $ $ A_N $ $ L_1 $ $ R_1 $ $ X_1 $ $ \vdots $ $ L_Q $ $ R_Q $ $ X_Q $

## 输出格式

$ Q $ 行にわたって出力せよ。$ i\ \,\ (1\ \leq\ i\ \leq\ Q) $ 行目には、$ A_{L_i},\ A_{L_i\ +\ 1},\ \dots,\ A_{R_i} $ から $ 1 $ つ以上の要素を選び、それらの排他的論理和を $ X_i $ にできるならば `Yes` と、できないならば `No` と出力せよ。

## 说明/提示

### 制約

- $ 1\ \leq\ N\ \leq\ 4\ \times\ 10^5 $
- $ 1\ \leq\ Q\ \leq\ 2\ \times\ 10^5 $
- $ 1\ \leq\ A_i\ \lt\ 2^{60} $
- $ 1\ \leq\ L_i\ \leq\ R_i\ \leq\ N $
- $ 1\ \leq\ X_i\ \lt\ 2^{60} $
- 入力は全て整数である。

### Sample Explanation 1

$ 1 $ つ目のクエリでは、$ A_1,\ A_3 $ を選ぶことで排他的論理和を $ 7 $ にすることができます。 $ 2 $ つ目のクエリでは、どのように要素を選んでも排他的論理和を $ 7 $ にすることはできません。

## 样例 #1

### 输入

```
5 2

3 1 4 1 5

1 3 7

2 5 7
```

### 输出

```
Yes

No
```

## 样例 #2

### 输入

```
10 10

8 45 56 9 38 28 33 5 15 19

10 10 53

3 8 60

1 10 29

5 7 62

3 7 51

8 8 52

1 4 60

6 8 32

4 8 58

5 9 2
```

### 输出

```
No

No

Yes

No

Yes

No

No

No

Yes

Yes
```



---

---
title: "[ABC224H] Security Camera 2"
layout: "post"
diff: 省选/NOI-
pid: AT_abc224_h
tag: []
---

# [ABC224H] Security Camera 2

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc224/tasks/abc224_h

左側に $ L $ 個、右側に $ R $ 個の頂点を有する二部グラフがあります。  
 高橋君は、この二部グラフの各頂点にカメラを設置することにしました。  
 カメラは $ 1 $ 個設置するごとに以下に示す金額のコストが掛かります。

- $ i $ $ (1\ \le\ i\ \le\ L) $ 番目の左側頂点に $ 1 $ 個のカメラを設置するのに $ A_i $ 円
- $ j $ $ (1\ \le\ j\ \le\ R) $ 番目の右側頂点に $ 1 $ 個のカメラを設置するのに $ B_j $ 円

また、 $ 1 $ つの頂点に複数個のカメラを設置してもよいです。

高橋君が以下の条件を満たすようにカメラを設置する時、必要な最小金額を求めてください。

- $ 1\ \le\ i\ \le\ L,\ 1\ \le\ j\ \le\ R $ を満たす全ての整数組 $ (i,j) $ について、 $ i $ 番目の左側頂点と $ j $ 番目の右側頂点にカメラが合計で $ C_{i,j} $ 個以上設置されている。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ L $ $ R $ $ A_1 $ $ A_2 $ $ \dots $ $ A_L $ $ B_1 $ $ B_2 $ $ \dots $ $ B_R $ $ C_{1,1} $ $ C_{1,2} $ $ \dots $ $ C_{1,R} $ $ C_{2,1} $ $ C_{2,2} $ $ \dots $ $ C_{2,R} $ $ \vdots $ $ C_{L,1} $ $ C_{L,2} $ $ \dots $ $ C_{L,R} $

## 输出格式

答えを整数として出力せよ。

## 说明/提示

### 制約

- 入力は全て整数である
- $ 1\ \le\ L,R\ \le\ 100 $
- $ 1\ \le\ A_i,B_i\ \le\ 10 $
- $ 0\ \le\ C_{i,j}\ \le\ 100 $

### Sample Explanation 1

以下のようにカメラを設置することで金額 $ 37 $ 円を達成することができ、これが最小です。 - $ 1 $ 番目の左側頂点にカメラを $ 2 $ つ設置する。 - $ 2 $ 番目の左側頂点にカメラを $ 3 $ つ設置する。 - $ 3 $ 番目の左側頂点にカメラを $ 2 $ つ設置する。 - $ 1 $ 番目の右側頂点にカメラを $ 1 $ つ設置する。 - $ 3 $ 番目の右側頂点にカメラを $ 1 $ つ設置する。

### Sample Explanation 2

$ 1 $ つもカメラを設置する必要がないケースもあります。

## 样例 #1

### 输入

```
3 4

4 3 6

5 2 3 4

1 2 3 2

2 1 2 3

3 2 1 2
```

### 输出

```
37
```

## 样例 #2

### 输入

```
1 1

10

10

0
```

### 输出

```
0
```

## 样例 #3

### 输入

```
5 6

3 2 6 7 5

4 9 8 6 2 3

2 0 2 1 1 0

2 3 2 1 0 0

2 2 4 0 2 2

4 1 0 3 0 2

1 0 0 2 2 5
```

### 输出

```
79
```



---

---
title: "[ABC225F] String Cards"
layout: "post"
diff: 省选/NOI-
pid: AT_abc225_f
tag: []
---

# [ABC225F] String Cards

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc225/tasks/abc225_f

カードが $ N $ 枚あり、$ i $ 番目のカードには文字列 $ S_i $ が書かれています。

この中からちょうど $ K $ 枚選び、好きな順序で繋げてできる文字列のうち辞書順最小のものを求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ K $ $ S_1 $ $ S_2 $ $ \vdots $ $ S_N $

## 输出格式

答えを出力せよ。

## 说明/提示

### 制約

- $ 1\ \leq\ K\ \leq\ N\ \leq\ 50 $
- $ 1\ \leq\ |S_i|\ \leq\ 50 $
- $ S_i $ は英小文字からなる

### Sample Explanation 1

カードの中に書かれている文字を、反転させたり並び替えたりすることはできません。 たとえば $ 1 $ 枚目のカードに書かれている `ode` を、`edo` や `deo` のように使うことはできません。

### Sample Explanation 2

$ S_i\ =\ S_j $ を満たす $ i,j(i\neq\ j) $ の組が存在することもあります。

## 样例 #1

### 输入

```
4 3

ode

zaaa

r

atc
```

### 输出

```
atcoder
```

## 样例 #2

### 输入

```
5 2

z

z

zzz

z

zzzzzz
```

### 输出

```
zz
```



---

---
title: "[ABC225G] X"
layout: "post"
diff: 省选/NOI-
pid: AT_abc225_g
tag: []
---

# [ABC225G] X

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc225/tasks/abc225_g

縦 $ H $ 行、横 $ W $ 列のグリッドがあります。各マスには整数が書かれており、上から $ i $ 行目、左から $ j $ 列目のマス $ (i,j) $ には $ A_{i,j} $ が書かれています。

これから高橋くんが、$ H\ \times\ W $ 個あるマスから $ 0 $ 個以上を選び、バツ印を付けます。$ 1 $ つのバツ印は、書かれるマスの左上の角と右下の角を結ぶ線分、および右上の角と左下の角を結ぶ線分の $ 2 $ 本からなります。

高橋くんのスコアを、$ ( $バツ印を付けられたマスに書かれた整数の総和$ )-\ C\ \times\ ( $バツ印を書くために必要な線分の本数の最小値$ ) $ と定義しましょう。

ここで、高橋くんは斜めに隣接するマスのバツ印を続けて書くことができます。

例えば、マス $ (1,1) $ とマス $ (2,2) $ にバツ印を付けるとき、高橋くんは

- マス $ (1,1) $ の左上の角とマス $ (2,2) $ の右下の角を結ぶ $ 1 $ 本の線分
- マス $ (1,1) $ の右上の角とマス $ (1,1) $ の左下の角を結ぶ $ 1 $ 本の線分
- マス $ (2,2) $ の右上の角とマス $ (2,2) $ の左下の角を結ぶ $ 1 $ 本の線分

の計 $ 3 $ 本によってバツ印を書くことができます。

高橋くんのスコアの最大値を求めてください。なお、**バツ印を付けないマスには何も書いてはいけないことに注意してください。**

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ H $ $ W $ $ C $ $ A_{1,1} $ $ A_{1,2} $ $ \ldots $ $ A_{1,W} $ $ A_{2,1} $ $ A_{2,2} $ $ \ldots $ $ A_{2,W} $ $ \hspace{1.5cm}\vdots $ $ A_{H,1} $ $ A_{H,2} $ $ \ldots $ $ A_{H,W} $

## 输出格式

高橋くんのスコアの最大値を出力せよ。

## 说明/提示

### 制約

- $ 1\ \leq\ H,W\ \leq\ 100 $
- $ 1\ \leq\ C\ \leq\ 10^9 $
- $ 1\ \leq\ A_{i,j}\ \leq\ 10^9 $
- 入力はすべて整数

### Sample Explanation 1

マス $ (1,2) $ とマス $ (2,1) $ にバツ印を付ける場合、高橋くんは - マス $ (1,2) $ の左上の角とマス $ (1,2) $ の右下の角を結ぶ $ 1 $ 本の線分 - マス $ (2,1) $ の左上の角とマス $ (2,1) $ の右下の角を結ぶ $ 1 $ 本の線分 - マス $ (1,2) $ の右上の角とマス $ (2,1) $ の左下の角を結ぶ $ 1 $ 本の線分 の計 $ 3 $ 本によってバツ印を書くことができます。故にこの場合の高橋くんのスコアは $ 10+8-2\ \times\ 3=12 $ です。 これよりも真にスコアが大きくなるバツ印の付け方は存在しないため、答えは $ 12 $ となります。

### Sample Explanation 2

どのマスにもバツ印を付けないのが最善です。

## 样例 #1

### 输入

```
2 2 2

2 10

8 3
```

### 输出

```
12
```

## 样例 #2

### 输入

```
3 3 100

1 1 1

1 1 1

1 1 1
```

### 输出

```
0
```

## 样例 #3

### 输入

```
8 9 970861213

1313462 943495812 203775264 839015475 115668311 14701110 819458175 827176922 236492592

843915104 786367010 344840288 618248834 824858165 549189141 120648070 805825275 933750119

709330492 38579914 890555497 75314343 238373458 854061807 637519536 53226153 627677130

671706386 380984116 221773266 787763728 639374738 298691145 359138139 183373508 524415106

716502263 150803008 390520954 913021901 553285119 876389099 952721235 46809105 635239775

355621458 511843148 117663063 37274476 891025941 832254337 346436418 783134705 488516288

383723241 322408013 948364423 409068145 120813872 697127655 968230339 988041557 222591780

712959990 233114128 210373172 798667159 568746366 579461421 923556823 777007925 422249456
```

### 输出

```
9785518299
```



---

---
title: "[ABC228G] Digits on Grid"
layout: "post"
diff: 省选/NOI-
pid: AT_abc228_g
tag: []
---

# [ABC228G] Digits on Grid

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc228/tasks/abc228_g

縦 $ H $ 行、横 $ W $ 列のマス目があり、それぞれのマスには $ 1 $ から $ 9 $ のいずれかの数字が書かれています。 $ 1\ \leq\ i\ \leq\ H $ かつ $ 1\ \leq\ j\ \leq\ W $ を満たす整数の組 $ (i,\ j) $ それぞれについて、上から $ i $ 行目、 左から $ j $ 列目のマスに書かれた数字は $ c_{i,\ j} $ です。

高橋君と青木君はこのマス目を使って $ 2 $ 人で遊びます。 まず、高橋君がいずれか $ 1 $ つのマスを選び、そのマスにコマを置きます。その後、$ 2 $ 人は下記の手順 1. から 4. を $ N $ 回繰り返します。

1. 高橋君が次の $ 2 $ つのうちどちらか一方を行う。
  - 現在コマが置かれているマスと**同じ行**にある別のマスに、コマを移動する。
  - 何もしない。
2. 高橋君が、現在コマが置かれているマスに書かれた数字を黒板に書く。
3. 青木君が次の $ 2 $ つのうちどちらか一方を行う。
  - 現在コマが置かれているマスと**同じ列**にある別のマスに、コマを移動する。
  - 何もしない。
4. 青木君が、現在コマが置かれているマスに書かれた数字を黒板に書く。

その後、黒板には $ 2N $ 個の数字が書かれています。それらの数字を黒板に書かれたのが早い順番に並べたものを $ d_1,\ d_2,\ \ldots,\ d_{2N} $ とします。 $ 2 $ 人は $ 2N $ 個の数字をこの順番で繋げて $ 2N $ 桁の整数 $ X\ :=\ d_1d_2\ldots\ d_{2N} $ を作ります。

整数 $ X $ としてあり得るものが何通りあるかを、$ 998244353 $ で割った余りを出力してください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ H $ $ W $ $ N $ $ c_{1,\ 1} $$ c_{1,\ 2} $$ \cdots $$ c_{1,\ W} $ $ c_{2,\ 1} $$ c_{2,\ 2} $$ \cdots $$ c_{2,\ W} $ $ \vdots $ $ c_{H,\ 1} $$ c_{H,\ 2} $$ \cdots $$ c_{H,\ W} $

## 输出格式

整数 $ X $ としてあり得るものが何通りあるかを、$ 998244353 $ で割った余りを出力せよ。

## 说明/提示

### 制約

- $ 2\ \leq\ H,\ W\ \leq\ 10 $
- $ 1\ \leq\ N\ \leq\ 300 $
- $ 1\ \leq\ c_{i,\ j}\ \leq\ 9 $
- 入力はすべて整数

### Sample Explanation 1

例えば、以下の進行が考えられます。 - まず高橋君がマス $ (1,\ 2) $ にコマを置く。 - 高橋君がコマをマス $ (1,\ 2) $ からマス $ (1,\ 1) $ に動かす。その後、マス $ (1,\ 1) $ に書かれた数字 $ 3 $ を黒板に書く。 - 青木君がコマをマス $ (1,\ 1) $ からマス $ (2,\ 1) $ に動かす。その後、マス $ (2,\ 1) $ に書かれた数字 $ 4 $ を黒板に書く。 この場合、$ X\ =\ 34 $ となります。 他の例として、以下の進行も考えられます。 - まず高橋君がマス $ (2,\ 2) $ にコマを置く。 - 高橋君がコマをマス $ (2,\ 2) $ から動かさず、マス $ (2,\ 2) $ に書かれた数字 $ 1 $ を黒板に書く。 - 青木君がコマをマス $ (2,\ 2) $ からマス $ (1,\ 2) $ に動かす。その後、マス $ (1,\ 2) $ に書かれた数字 $ 1 $ を黒板に書く。 この場合、$ X\ =\ 11 $ となります。 $ X $ としてあり得る整数は、上記の例で示した $ 34,\ 11 $ の他にも $ 33,\ 44,\ 43 $ があります。また、それら以外の整数が $ X $ となることはありえません。 $ X $ としてあり得る整数の個数は $ 5 $ 個であるので $ 5 $ を出力します。

### Sample Explanation 2

整数 $ X $ としてあり得るのは、$ 77777777 $ のみです。

### Sample Explanation 3

$ 998244353 $ で割った余りを出力することに注意して下さい。

## 样例 #1

### 输入

```
2 2 1

31

41
```

### 输出

```
5
```

## 样例 #2

### 输入

```
2 3 4

777

777
```

### 输出

```
1
```

## 样例 #3

### 输入

```
10 10 300

3181534389

4347471911

4997373645

5984584273

1917179465

3644463294

1234548423

6826453721

5892467783

1211598363
```

### 输出

```
685516949
```



---

---
title: "[ABC228H] Histogram"
layout: "post"
diff: 省选/NOI-
pid: AT_abc228_h
tag: []
---

# [ABC228H] Histogram

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc228/tasks/abc228_h

長さ $ N $ の整数列 $ A\ =\ (A_1,\ \dots,\ A_N) $ および $ C\ =\ (C_1,\ \dots,\ C_N) $ が与えられます。

あなたは以下の操作を好きな回数（$ 0 $ 回でもよい）行うことができます。

- $ 1\ \leq\ i\ \leq\ N $ を満たす整数 $ i $ を選び、$ A_i $ の値を $ 1 $ 増やす。このとき、$ C_i $ 円の費用を支払う。

好きな回数の操作を行ったあと、$ A $ の要素の種類数を $ K $ として、$ K\ \times\ X $ 円を支払わなければなりません。

支払う金額の合計は最小で何円ですか？

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ X $ $ A_1 $ $ C_1 $ $ \vdots $ $ A_N $ $ C_N $

## 输出格式

答えを表す数値を出力せよ。

## 说明/提示

### 制約

- $ 1\ \leq\ N\ \leq\ 2\ \times\ 10^5 $
- $ 1\ \leq\ X\ \leq\ 10^6 $
- $ 1\ \leq\ A_i,\ C_i\ \leq\ 10^6\ \,\ (1\ \leq\ i\ \leq\ N) $
- 入力は全て整数である。

### Sample Explanation 1

$ A_1 $ に $ 1 $ 加算すると $ A $ の要素の種類数は $ 2 $ になり、支払う金額の合計は $ C_1\ +\ 2\ \times\ X\ =\ 12 $ 円となります。支払う金額をこれより少なくすることはできません。

## 样例 #1

### 输入

```
3 5

3 2

2 4

4 3
```

### 输出

```
12
```

## 样例 #2

### 输入

```
1 1

1 1
```

### 输出

```
1
```

## 样例 #3

### 输入

```
7 7

3 2

1 7

4 1

1 8

5 2

9 8

2 1
```

### 输出

```
29
```



---

---
title: "[ABC230G] GCD Permutation"
layout: "post"
diff: 省选/NOI-
pid: AT_abc230_g
tag: []
---

# [ABC230G] GCD Permutation

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc230/tasks/abc230_g

<!-- 

$ 1 $ 以上 $ N $ 以下の整数の並び替え $ P=(P_1,P_2,\ldots,P_N) $ が与えられます。

次の条件をみたす整数の組 $ (i,j) $ $ (1\leq\ i\leq\ j\leq\ N) $ の個数を求めてください。



- $ GCD(i,j)\neq\ 1 $ かつ $ GCD(P_i,P_j)\neq\ 1 $



ただし、正整数 $ x $, $ y $ に対して、$ GCD(x,y) $ で $ x $ と $ y $ の最大公約数を表します。

-->$ 1 $ 以上 $ N $ 以下の整数の並び替え $ P=(P_1,P_2,\ldots,P_N) $ が与えられます。

$ 1\leq\ i\leq\ j\leq\ N $ をみたす整数の組 $ (i,j) $ であって、$ GCD(i,j)\neq\ 1 $ かつ $ GCD(P_i,P_j)\neq\ 1 $ をみたすものの個数を求めてください。  
 ただし、正整数 $ x $, $ y $ に対して、$ GCD(x,y) $ で $ x $ と $ y $ の最大公約数を表します。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ P_1 $ $ P_2 $ $ \ldots $ $ P_N $

## 输出格式

答えを出力せよ。

## 说明/提示

### 制約

- $ 1\ \leq\ N\ \leq\ 2\times\ 10^5 $
- $ (P_1,P_2,\ldots,P_N) $ は $ (1,2,\ldots,N) $ の並び替えである。
- 入力は全て整数である。

### Sample Explanation 1

条件をみたす組は $ (3,3) $, $ (3,6) $, $ (4,4) $, $ (4,6) $, $ (5,5) $, $ (6,6) $ の $ 6 $ つです。 よって、 $ 6 $ を出力します。

## 样例 #1

### 输入

```
6

5 1 3 2 4 6
```

### 输出

```
6
```

## 样例 #2

### 输入

```
12

1 2 3 4 5 6 7 8 9 10 11 12
```

### 输出

```
32
```



---

---
title: "[ABC231G] Balls in Boxes"
layout: "post"
diff: 省选/NOI-
pid: AT_abc231_g
tag: []
---

# [ABC231G] Balls in Boxes

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc231/tasks/abc231_g

$ 1 $ から $ N $ の番号がついた $ N $ 個の箱があります。最初、箱 $ i $ には $ A_i $ 個のボールが入っています。

あなたは次の操作を $ K $ 回繰り返します。

- $ N $ 個の箱の中から等確率で $ 1 $ 個選ぶ(この選択は操作ごとに独立である)。選んだ箱にボールを $ 1 $ 個追加する。

$ K $ 回の操作が終了した後で箱 $ i $ に入っているボールの個数を $ B_i $ とするとき、**スコア**はボールの個数の総積 $ \prod_{i=1}^{N}B_i $ になります。

スコアの期待値を $ \bmod\ 998244353 $ で求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ K $ $ A_1 $ $ \ldots $ $ A_N $

## 输出格式

答えを出力せよ。

## 说明/提示

### 注意

求める期待値が既約分数 $ p/q $ で表されるとき、$ rq\equiv\ p\ \pmod{998244353} $ かつ $ 0\leq\ r\ <\ 998244353 $ を満たす整数 $ r $ がこの問題の制約のもとで一意に定まります。この $ r $ が求める値です。

### 制約

- $ 1\ \leq\ N\ \leq\ 1000 $
- $ 1\ \leq\ K\ \leq\ 10^9 $
- $ 0\ \leq\ A_i\ \leq\ 10^9 $

### Sample Explanation 1

操作の結果、スコアは次のようになります。 - 操作で箱 $ 1 $ を選んだとき、$ 2\times\ 2\times\ 3=12 $ - 操作で箱 $ 2 $ を選んだとき、$ 1\times\ 3\times\ 3=9 $ - 操作で箱 $ 3 $ を選んだとき、$ 1\times\ 2\times\ 4=8 $ したがって、求める期待値は $ \frac{1}{3}(12+9+8)=\frac{29}{3} $ となります。これを $ \bmod\ 998244353 $ で表すと $ 665496245 $ になります。

### Sample Explanation 2

操作の結果、スコアは次のようになります。 - $ 1 $ 回目の操作で箱 $ 1 $ を選び、$ 2 $ 回目の操作で箱 $ 1 $ を選んだとき、$ 3\times\ 2=6 $ - $ 1 $ 回目の操作で箱 $ 1 $ を選び、$ 2 $ 回目の操作で箱 $ 2 $ を選んだとき、$ 2\times\ 3=6 $ - $ 1 $ 回目の操作で箱 $ 2 $ を選び、$ 2 $ 回目の操作で箱 $ 1 $ を選んだとき、$ 2\times\ 3=6 $ - $ 1 $ 回目の操作で箱 $ 2 $ を選び、$ 2 $ 回目の操作で箱 $ 2 $ を選んだとき、$ 1\times\ 4=4 $ したがって、求める期待値は $ \frac{1}{4}(6+6+6+4)=\frac{11}{2} $ となります。

## 样例 #1

### 输入

```
3 1

1 2 3
```

### 输出

```
665496245
```

## 样例 #2

### 输入

```
2 2

1 2
```

### 输出

```
499122182
```

## 样例 #3

### 输入

```
10 1000000000

998244350 998244351 998244352 998244353 998244354 998244355 998244356 998244357 998244358 998244359
```

### 输出

```
138512322
```



---

---
title: "[ABC231H] Minimum Coloring"
layout: "post"
diff: 省选/NOI-
pid: AT_abc231_h
tag: []
---

# [ABC231H] Minimum Coloring

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc231/tasks/abc231_h

$ H $ 行 $ W $ 列のグリッドがあります。上から $ i $ 行目、左から $ j $ 列目のマスをマス $ (i,j) $ と表します。

グリッド上には $ 1 $ から $ N $ の番号がついた $ N $ 個の白い駒が置かれています。駒 $ i $ が置かれているマスは $ (A_i,B_i) $ です。

あなたはコストを $ C_i $ 払うことで、駒 $ i $ を黒い駒に変えることができます。

どの行どの列にも黒い駒が $ 1 $ 個以上ある状態にするために必要なコストの和の最小値を求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ H $ $ W $ $ N $ $ A_1 $ $ B_1 $ $ C_1 $ $ \hspace{23pt}\ \vdots $ $ A_N $ $ B_N $ $ C_N $

## 输出格式

答えを出力せよ。

## 说明/提示

### 制約

- $ 1\ \leq\ H,W\ \leq\ 10^3 $
- $ 1\ \leq\ N\ \leq\ 10^3 $
- $ 1\ \leq\ A_i\ \leq\ H $
- $ 1\ \leq\ B_i\ \leq\ W $
- $ 1\ \leq\ C_i\ \leq\ 10^9 $
- $ (A_i,B_i) $ は相異なる
- 全ての行、全ての列に $ 1 $ 個以上の白い駒が置かれている
- 入力に含まれる値は全て整数である

### Sample Explanation 1

コスト $ 1110 $ を払い駒 $ 2,3,4 $ を黒い駒に変えることで、どの行どの列にも黒い駒がある状態にすることができます。

## 样例 #1

### 输入

```
2 3 6

1 1 1

1 2 10

1 3 100

2 1 1000

2 2 10000

2 3 100000
```

### 输出

```
1110
```

## 样例 #2

### 输入

```
1 7 7

1 2 200000000

1 7 700000000

1 4 400000000

1 3 300000000

1 6 600000000

1 5 500000000

1 1 100000000
```

### 输出

```
2800000000
```

## 样例 #3

### 输入

```
3 3 8

3 2 1

3 1 2

2 3 1

2 2 100

2 1 100

1 3 2

1 2 100

1 1 100
```

### 输出

```
6
```



---

---
title: "[ABC232G] Modulo Shortest Path"
layout: "post"
diff: 省选/NOI-
pid: AT_abc232_g
tag: []
---

# [ABC232G] Modulo Shortest Path

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc232/tasks/abc232_g

$ N $ 頂点の有向グラフがあります。$ N $ 個の頂点はそれぞれ頂点 $ 1 $、頂点 $ 2 $、$ \ldots $、頂点 $ N $ と呼ばれます。

$ 1\ \leq\ i,\ j\ \leq\ N $ かつ $ i\ \neq\ j $ を満たす整数の組 $ (i,\ j) $ それぞれに対して、 頂点 $ i $ を始点、頂点 $ j $ を終点とする重み $ (A_i\ +\ B_j)\ \bmod\ M $ の有向辺があります。 （ただし、$ x\ \bmod\ y $ は $ x $ を $ y $ で割ったあまりを表します。）

上記のほかに辺はありません。

頂点 $ 1 $ から頂点 $ N $ への最短距離、すなわち、頂点 $ 1 $ から頂点 $ N $ へのパス上の辺の重みの総和として考えられる最小値を出力してください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ M $ $ A_1 $ $ A_2 $ $ \ldots $ $ A_N $ $ B_1 $ $ B_2 $ $ \ldots $ $ B_N $

## 输出格式

頂点 $ 1 $ から頂点 $ N $ へのパス上の辺の重みの総和として考えられる最小値を出力せよ。

## 说明/提示

### 制約

- $ 2\ \leq\ N\ \leq\ 2\ \times\ 10^5 $
- $ 2\ \leq\ M\ \leq\ 10^9 $
- $ 0\ \leq\ A_i,\ B_j\ <\ M $
- 入力はすべて整数

### Sample Explanation 1

以下では、頂点 $ i $ を始点、頂点 $ j $ を終点とする有向辺を $ i\ \rightarrow\ j $ で表します。 $ 1 $ $ \rightarrow $ $ 3 $ $ \rightarrow $ $ 2 $ $ \rightarrow $ $ 4 $ というパスを考えると、 - 辺 $ 1\ \rightarrow\ 3 $ の重みは、$ (A_1\ +\ B_3)\ \bmod\ M\ =\ (10\ +\ 4)\ \bmod\ 12\ =\ 2 $ であり、 - 辺 $ 3\ \rightarrow\ 2 $ の重みは、$ (A_3\ +\ B_2)\ \bmod\ M\ =\ (6\ +\ 7)\ \bmod\ 12\ =\ 1 $ であり、 - 辺 $ 2\ \rightarrow\ 4 $ の重みは、$ (A_2\ +\ B_4)\ \bmod\ M\ =\ (11\ +\ 1)\ \bmod\ 12\ =\ 0 $ です。 よって、このパスの辺の重みの総和は $ 2\ +\ 1\ +\ 0\ =\ 3 $ です。 これが頂点 $ 1 $ から頂点 $ N $ へのパス上の辺の重みの総和として考えられる最小値となります。

## 样例 #1

### 输入

```
4 12

10 11 6 0

8 7 4 1
```

### 输出

```
3
```

## 样例 #2

### 输入

```
10 1000

785 934 671 520 794 168 586 667 411 332

363 763 40 425 524 311 139 875 548 198
```

### 输出

```
462
```



---

---
title: "[ABC232H] King's Tour"
layout: "post"
diff: 省选/NOI-
pid: AT_abc232_h
tag: []
---

# [ABC232H] King's Tour

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc232/tasks/abc232_h

縦横 $ H\ \times\ W $ のチェス盤と $ 1 $ 個のキングの駒があります。  
 チェス盤のマスのうち、上から $ i $ 行目 $ (1\ \leq\ i\ \leq\ H) $ で左から $ j $ 行目 $ (1\ \leq\ j\ \leq\ W) $ のマスを $ (i,\ j) $ と表します。  
 キングは置かれているマスから周囲 $ 1 $ マスに動かすことができます。より厳密には、チェス盤のマス目の組 $ (i,\ j) $, $ (k,\ l) $ が $ \max(|i-k|,|j-l|)\ =\ 1 $ を満たすとき、かつその時に限り $ (i,j) $ に置かれているキングを $ (k,\ l) $ に動かすことができます。

次の条件を満たすようにキングを縦横 $ H\ \times\ W $ のチェス盤上で動かすことを「ツアー」と定めます。

- はじめ、$ (1,\ 1) $ にキングを置く。そのあと、キングが全てのマスにちょうど $ 1 $ 回ずつ置かれるようにキングを動かす。

たとえば、$ H\ =\ 2,\ W\ =\ 3 $ のとき、$ (1,1)\ \to\ (1,2)\ \to\ (1,\ 3)\ \to\ (2,\ 3)\ \to\ (2,\ 2)\ \to\ (2,\ 1) $ の順にキングを動かしたものは条件を満たします。

チェス盤上の $ (1,1) $ 以外のマス $ (a,\ b) $ が与えられます。ツアーのうち最後にキングが置かれているマスが $ (a,b) $ となるものを $ 1 $ つ構成して出力してください。この問題の制約下において解は必ず存在することが証明できます。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ H $ $ W $ $ a $ $ b $

## 输出格式

$ HW $ 行出力せよ。$ i $ 行目には $ i $ 番目にキングが置かれたマス $ (h_i,\ w_i) $ を以下の形式で出力せよ。

> $ h_i $ $ w_i $

ここで、$ 1 $ 行目は $ (1,\ 1) $ 、$ HW $ 行目は $ (a,\ b) $ を出力する必要がある点に注意せよ。

## 说明/提示

### 制約

- $ 2\ \leq\ H\ \leq\ 100 $
- $ 2\ \leq\ W\ \leq\ 100 $
- $ 1\ \leq\ a\ \leq\ H $
- $ 1\ \leq\ b\ \leq\ W $
- $ (a,\ b)\ \neq\ (1,\ 1) $
- 入力はすべて整数である。

### Sample Explanation 1

キングは $ (1,\ 1)\ \to\ (1,\ 2)\ \to\ (2,\ 1)\ \to\ (2,\ 2)\to\ (3,\ 1)\ \to\ (3,\ 2) $ と移動して、これは確かに $ (3,2) $ を終点とするツアーとなっています。 条件を満たすツアーは他にもいくつかあり、たとえば以下の $ 3 $ つの移動が挙げられます。 - $ (1,\ 1)\ \to\ (1,\ 2)\ \to\ (2,\ 2)\ \to\ (2,\ 1)\ \to\ (3,\ 1)\ \to\ (3,\ 2) $ - $ (1,\ 1)\ \to\ (2,\ 1)\ \to\ (1,\ 2)\ \to\ (2,\ 2)\ \to\ (3,\ 1)\ \to\ (3,\ 2) $ - $ (1,\ 1)\ \to\ (2,\ 2)\ \to\ (1,\ 2)\ \to\ (2,\ 1)\ \to\ (3,\ 1)\ \to\ (3,\ 2) $

## 样例 #1

### 输入

```
3 2 3 2
```

### 输出

```
1 1

1 2

2 1

2 2

3 1

3 2
```



---

---
title: "[ABC233Ex] Manhattan Christmas Tree"
layout: "post"
diff: 省选/NOI-
pid: AT_abc233_h
tag: []
---

# [ABC233Ex] Manhattan Christmas Tree

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc233/tasks/abc233_h

$ 2 $ 次元平面上にクリスマスツリーが $ N $ 個あり、$ i $ 個目のクリスマスツリーは座標 $ (x_i,y_i) $ にあります。

以下の $ Q $ 個のクエリに答えてください。

> クエリ $ i $ ： $ (a_i,b_i) $ からマンハッタン距離で $ K_i $ 番目に近いクリスマスツリーまでの距離はいくつですか？

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ x_1 $ $ y_1 $ $ \vdots $ $ x_N $ $ y_N $ $ Q $ $ a_1 $ $ b_1 $ $ K_1 $ $ \vdots $ $ a_Q $ $ b_Q $ $ K_Q $

## 输出格式

$ Q $ 行に出力せよ。  
 $ i $ 行目には、クエリ $ i $ に対する答えを出力せよ。

## 说明/提示

### 制約

- $ 1\leq\ N\ \leq\ 10^5 $
- $ 0\leq\ x_i\leq\ 10^5 $
- $ 0\leq\ y_i\leq\ 10^5 $
- $ i\neq\ j $ ならば $ (x_i,y_i)\ \neq\ (x_j,y_j) $
- $ 1\leq\ Q\ \leq\ 10^5 $
- $ 0\leq\ a_i\leq\ 10^5 $
- $ 0\leq\ b_i\leq\ 10^5 $
- $ 1\leq\ K_i\leq\ N $
- 入力に含まれる値は全て整数である

### Sample Explanation 1

$ (3,5) $ から $ 1,2,3,4 $ 個目のクリスマスツリーまでのマンハッタン距離は、それぞれ $ 2,2,5,1 $ です。 よって、最初の $ 4 $ つのクエリの答えはそれぞれ $ 1,2,2,5 $ です。

## 样例 #1

### 输入

```
4

3 3

4 6

7 4

2 5

6

3 5 1

3 5 2

3 5 3

3 5 4

100 200 3

300 200 1
```

### 输出

```
1

2

2

5

293

489
```



---

---
title: "[ABC234Ex] Enumerate Pairs"
layout: "post"
diff: 省选/NOI-
pid: AT_abc234_h
tag: []
---

# [ABC234Ex] Enumerate Pairs

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc234/tasks/abc234_h

$ 1 $ から $ N $ までの番号のついた $ N $ 個の整数の組 $ (x_i,y_i) $ と、整数 $ K $ が与えられます。  
 以下の条件を満たす整数の組 $ (p,q) $ を「出力」で指定する形式に従ってすべて列挙してください。

- $ 1\ \le\ p\ <\ q\ \le\ N $
- $ \sqrt{(x_p-x_q)^2+(y_p-y_q)^2}\ \le\ K $

ただし、そのような整数の組が $ 4\ \times\ 10^5 $ 組以下であることは保証されます。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ K $ $ x_1 $ $ y_1 $ $ x_2 $ $ y_2 $ $ \vdots $ $ x_N $ $ y_N $

## 输出格式

以下の形式で出力せよ。

> $ M $ $ p_1 $ $ q_1 $ $ p_2 $ $ q_2 $ $ \vdots $ $ p_M $ $ q_M $

まず、 $ 1 $ 行目に整数 $ M $ を出力せよ。 $ M $ は出力する整数の組の個数を表す。  
 続く $ M $ 行に、列挙するべき整数の組 $ (p_i,q_i) $ を $ 1 $ 行に $ 1 $ つずつ空白区切りで、 **辞書順で** 出力せよ。  
 ただし、整数の組 $ (a,b),(c,d) $ が以下の条件のどちらかを満たすとき、またその時に限り、 整数の組 $ (a,b) $ が整数の組 $ (c,d) $ より辞書順で前であるとする。

- $ a\ <\ c $ である。
- $ a=c $ であり、かつ $ b\ <\ d $ である。

## 说明/提示

### 制約

- 入力はすべて整数
- $ 1\ \le\ N\ \le\ 2\ \times\ 10^5 $
- $ 1\ \le\ K\ \le\ 1.5\ \times\ 10^9 $
- $ 0\ \le\ x_i,y_i\ \le\ 10^9 $
- 列挙すべき整数の組は $ 4\ \times\ 10^5 $ 組以下である

### Sample Explanation 1

条件を満たす整数の組は以下の $ 9 $ 個なので、これを出力形式に従って出力して下さい。 $ (1,2),(1,3),(1,4),(2,3),(2,4),(2,5),(3,4),(3,5),(5,6) $

### Sample Explanation 2

条件を満たす整数の組が $ 0 $ 組である場合もあります。

### Sample Explanation 3

$ x_i=x_j $ かつ $ y_i=y_j $ であるような整数の組 $ (i,j) $ ($ i\ <\ j $) が存在する場合もあります。

## 样例 #1

### 输入

```
6 5

2 0

2 2

3 4

0 0

5 5

8 3
```

### 输出

```
9

1 2

1 3

1 4

2 3

2 4

2 5

3 4

3 5

5 6
```

## 样例 #2

### 输入

```
2 1414213562

0 0

1000000000 1000000000
```

### 输出

```
0
```

## 样例 #3

### 输入

```
10 150

300 300

300 400

300 500

400 300

400 400

400 400

400 500

500 300

500 400

500 500
```

### 输出

```
29

1 2

1 4

1 5

1 6

2 3

2 4

2 5

2 6

2 7

3 5

3 6

3 7

4 5

4 6

4 8

4 9

5 6

5 7

5 8

5 9

5 10

6 7

6 8

6 9

6 10

7 9

7 10

8 9

9 10
```



---

---
title: "[ABC236G] Good Vertices"
layout: "post"
diff: 省选/NOI-
pid: AT_abc236_g
tag: []
---

# [ABC236G] Good Vertices

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc236/tasks/abc236_g

$ N $ 頂点の有向グラフがあります。$ N $ 個の頂点はそれぞれ頂点 $ 1 $ 、頂点 $ 2 $ 、$ \ldots $、頂点 $ N $ と呼ばれます。 時刻 $ 0 $ には、このグラフには辺がありません。

$ t\ =\ 1,\ 2,\ \ldots,\ T $ について、時刻 $ t $ に頂点 $ u_t $ から頂点 $ v_t $ への有向辺が追加されます。 （追加される辺が自己ループである場合、すなわち $ u_t\ =\ v_t $ の場合もあります。）

頂点 $ 1 $ から始め「現在いる頂点からちょうど $ 1 $ 本の有向辺をたどって到達できる頂点を $ 1 $ つ選び、選んだ頂点に移動する」ことを**ちょうど** $ L $ 回繰り返して到達できる頂点を「良い頂点」と呼びます。

$ i\ =\ 1,\ 2,\ \ldots,\ N $ について、頂点 $ i $ が良い頂点となる最小の時刻を出力してください。ただし、頂点 $ i $ が良い頂点となる時刻が存在しない場合は、代わりに $ -1 $ を出力してください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ T $ $ L $ $ u_1 $ $ v_1 $ $ u_2 $ $ v_2 $ $ \vdots $ $ u_T $ $ v_T $

## 输出格式

下記の形式の通り、$ i\ =\ 1,\ 2,\ \ldots,\ N $ について、頂点 $ i $ が良い頂点となる最小の時刻 $ X_i $ を出力せよ。ただし、頂点 $ i $ が良い頂点となる時刻が存在しない場合は、$ X_i\ =\ -1 $ とせよ。

> $ X_1 $ $ X_2 $ $ \ldots $ $ X_N $

## 说明/提示

### 制約

- $ 2\ \leq\ N\ \leq\ 100 $
- $ 1\ \leq\ T\ \leq\ N^2 $
- $ 1\ \leq\ L\ \leq\ 10^9 $
- $ 1\ \leq\ u_t,\ v_t\ \leq\ N $
- $ i\ \neq\ j\ \Rightarrow\ (u_i,\ v_i)\ \neq\ (u_j,\ v_j) $
- 入力はすべて整数

### Sample Explanation 1

時刻 $ 0 $ ではグラフは辺を持ちません。その後、以下の通りに辺の追加が行われます。 - 時刻 $ 1 $ に、頂点 $ 2 $ から頂点 $ 3 $ への有向辺が追加されます。 - 時刻 $ 2 $ に、頂点 $ 3 $ から頂点 $ 4 $ への有向辺が追加されます。 - 時刻 $ 3 $ に、頂点 $ 1 $ から頂点 $ 2 $ への有向辺が追加されます。これによって、頂点 $ 1 $ から頂点 $ 4 $ に $ 1\ \rightarrow\ 2\ \rightarrow\ 3\ \rightarrow\ 4 $ とちょうど $ 3 $ 回の移動で到達できるようになり、頂点 $ 4 $ は良い頂点に変わります。 - 時刻 $ 4 $ に、頂点 $ 3 $ から頂点 $ 2 $ への有向辺が追加されます。これによって、頂点 $ 1 $ から頂点 $ 2 $ に $ 1\ \rightarrow\ 2\ \rightarrow\ 3\ \rightarrow\ 2 $ とちょうど $ 3 $ 回の移動で到達できるようになり、頂点 $ 2 $ は良い頂点に変わります。 - 時刻 $ 5 $ に、頂点 $ 2 $ から頂点 $ 2 $ への有向辺（自己ループ）が追加されます。これによって、頂点 $ 1 $ から頂点 $ 3 $ に $ 1\ \rightarrow\ 2\ \rightarrow\ 2\ \rightarrow\ 3 $ とちょうど $ 3 $ 回の移動で到達できるようになり、頂点 $ 3 $ は良い頂点に変わります。 頂点 $ 1 $ が良い頂点となることはありません。

## 样例 #1

### 输入

```
4 5 3

2 3

3 4

1 2

3 2

2 2
```

### 输出

```
-1 4 5 3
```

## 样例 #2

### 输入

```
2 1 1000000000

1 2
```

### 输出

```
-1 -1
```



---

---
title: "[ABC236Ex] Distinct Multiples"
layout: "post"
diff: 省选/NOI-
pid: AT_abc236_h
tag: []
---

# [ABC236Ex] Distinct Multiples

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc236/tasks/abc236_h

正整数 $ N,\ M $ および正整数列 $ D\ =\ (D_1,\ \dots,\ D_N) $ が与えられます。

以下の条件を満たす正整数列 $ A\ =\ (A_1,\ \dots,\ A_N) $ の総数を $ 998244353 $ で割った余りを求めてください。

- $ 1\ \leq\ A_i\ \leq\ M\ \,\ (1\ \leq\ i\ \leq\ N) $
- $ A_i\ \neq\ A_j\ \,\ (1\ \leq\ i\ \lt\ j\ \leq\ N) $
- 各 $ i\ \,\ (1\ \leq\ i\ \leq\ N) $ について、$ A_i $ は $ D_i $ の倍数

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ M $ $ D_1 $ $ \ldots $ $ D_N $

## 输出格式

答えを出力せよ。

## 说明/提示

### 制約

- $ 2\ \leq\ N\ \leq\ 16 $
- $ 1\ \leq\ M\ \leq\ 10^{18} $
- $ 1\ \leq\ D_i\ \leq\ M\ \,\ (1\ \leq\ i\ \leq\ N) $
- 入力は全て整数である。

### Sample Explanation 1

条件を満たす $ A $ は $ (2,\ 3,\ 4),\ (2,\ 6,\ 4),\ (6,\ 3,\ 4) $ の $ 3 $ 通りです。

### Sample Explanation 2

条件を満たす $ A $ は存在しません。

### Sample Explanation 3

$ 998244353 $ で割った余りを求めることに注意してください。

## 样例 #1

### 输入

```
3 7

2 3 4
```

### 输出

```
3
```

## 样例 #2

### 输入

```
3 3

1 2 2
```

### 输出

```
0
```

## 样例 #3

### 输入

```
6 1000000000000000000

380214083 420492929 929717250 666796775 209977152 770361643
```

### 输出

```
325683519
```



---

---
title: "[ABC237G] Range Sort Query"
layout: "post"
diff: 省选/NOI-
pid: AT_abc237_g
tag: []
---

# [ABC237G] Range Sort Query

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc237/tasks/abc237_g

$ 1,2,\ldots,N $ を並び替えた長さ $ N $ の順列 $ P=(P_1,P_2,\ldots,P_N) $ と整数 $ X $ が与えられます。

また、$ Q $ 個のクエリが与えられます。 $ i $ 番目のクエリは $ 3 $ つの数の組 $ (C_i,L_i,R_i) $ で表されます。各クエリでは順列 $ P $ に対して次の操作を行います。

- $ C_i=1 $ のとき : $ P_{L_i},P_{L_i+1},\ldots,P_{R_i} $ を昇順に並び替える。
- $ C_i=2 $ のとき : $ P_{L_i},P_{L_i+1},\ldots,P_{R_i} $ を降順に並び替える。

クエリを $ 1 $ 番目から順に最後まで処理したとき、最終的な順列において $ P_i=X $ となる $ i $ を求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ Q $ $ X $ $ P_1 $ $ P_2 $ $ \ldots $ $ P_N $ $ C_1 $ $ L_1 $ $ R_1 $ $ C_2 $ $ L_2 $ $ R_2 $ $ \vdots $ $ C_Q $ $ L_Q $ $ R_Q $

## 输出格式

答えを出力せよ。

## 说明/提示

### 制約

- $ 1\ \leq\ N\ \leq\ 2\times\ 10^5 $
- $ 1\ \leq\ Q\ \leq\ 2\times\ 10^5 $
- $ 1\ \leq\ X\ \leq\ N $
- $ (P_1,P_2,\ldots,P_N) $ は $ (1,2,\ldots,N) $ の並び替えである。
- $ 1\ \leq\ C_i\ \leq\ 2 $
- $ 1\ \leq\ L_i\ \leq\ R_i\ \leq\ N $
- 入力は全て整数である。

### Sample Explanation 1

最初、順列は $ P=[1,4,5,2,3] $ です。 これはクエリによって次のように変化します。 - $ 1 $ つめのクエリでは $ 3 $ 番目から $ 5 $ 番目の要素を昇順にソートします。順列は $ P=[1,4,2,3,5] $ となります。 - $ 2 $ つめのクエリでは $ 1 $ 番目から $ 3 $ 番目の要素を降順にソートします。順列は $ P=[4,2,1,3,5] $ となります。 最終的な順列において $ P_3=1 $ であるので、$ 3 $ を出力します。

### Sample Explanation 2

最終的な順列は $ P=[1,2,6,5,7,4,3] $ となります。

## 样例 #1

### 输入

```
5 2 1

1 4 5 2 3

1 3 5

2 1 3
```

### 输出

```
3
```

## 样例 #2

### 输入

```
7 3 3

7 5 3 1 2 4 6

1 1 7

2 3 6

2 5 7
```

### 输出

```
7
```



---

---
title: "[ABC237Ex] Hakata"
layout: "post"
diff: 省选/NOI-
pid: AT_abc237_h
tag: []
---

# [ABC237Ex] Hakata

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc237/tasks/abc237_h

英小文字からなる文字列 $ S $ があります。  
 毎日回文のことばかりを考えている高橋博多くんは、$ S $ の部分文字列のうち回文となっているものをいくつか選び、小倉楽子さんに教えることにしました。

小倉楽子さんは、教えられた回文のうち $ 2 $ つであって、一方が他方の部分文字列になっているようなものが存在すると、怒ります。

小倉楽子さんが怒らないという条件のもとで、高橋博多くんは最大でいくつの回文を選ぶことができますか？

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ S $

## 输出格式

答えを出力せよ。

## 说明/提示

### 注記

$ S $ の**部分文字列**とは、$ S $ の先頭から $ 0 $ 文字以上、末尾から $ 0 $ 文字以上削除して得られる文字列のことをいいます。  
 例えば、`ab` は `abc` の部分文字列ですが、`ac` は `abc` の部分文字列ではありません。

### 制約

- $ 1\ \leq\ |S|\ \leq\ 200 $
- $ S $ は英小文字からなる

### Sample Explanation 1

`aba` 、`bab` 、`bb` の $ 3 $ つの回文を選ぶことができます。

### Sample Explanation 2

`x` 、`y` 、`z` の $ 3 $ つの回文を選ぶことができます。

## 样例 #1

### 输入

```
ababb
```

### 输出

```
3
```

## 样例 #2

### 输入

```
xyz
```

### 输出

```
3
```

## 样例 #3

### 输入

```
xxxxxxxxxx
```

### 输出

```
1
```



---

---
title: "[ABC239G] Builder Takahashi"
layout: "post"
diff: 省选/NOI-
pid: AT_abc239_g
tag: []
---

# [ABC239G] Builder Takahashi

## 题目描述

给定一张 $n$ 个点 $m$ 条边的连通无向图，要求在某些点（不能为 $1$ 号点或者 $n$ 号点）设立障碍，在 $i$ 号点建立障碍的费用为 $c_i$，要使得 $1$ 号点和 $n$ 号点不连通，求最小花费的方案。

## 输入格式

第一行两个整数 $n,m(3\leq n\leq 100,n−1\leq m\leq \frac{n(n−1)}{2}−1)$。

接下来 $m$ 行，每行两个数 $a_i,b_i(1\leq ai < bi\leq n)$，保证没有重边自环，并且 $1$ 与 $n$ 不直接相连。

接下来一行 $n$ 个整数 $c_1,c_2,…,c_n(0\le ci\le 10^9)$，保证 $c_1=c_n=0$。

## 输出格式

第一行输出一个数，表示最小的花费。

接下来输出一个数 $k$，表示建立障碍的个数。接下来一行 $k$ 个数，表示建立障碍的 $k$ 个点。

## 样例 #1

### 输入

```
5 5

1 2

2 3

3 5

2 4

4 5

0 8 3 4 0
```

### 输出

```
7

2

3 4
```

## 样例 #2

### 输入

```
3 2

1 2

2 3

0 1 0
```

### 输出

```
1

1

2
```

## 样例 #3

### 输入

```
5 9

1 2

1 3

1 4

2 3

2 4

2 5

3 4

3 5

4 5

0 1000000000 1000000000 1000000000 0
```

### 输出

```
3000000000

3

2 3 4
```



---

---
title: "[ABC239Ex] Dice Product 2"
layout: "post"
diff: 省选/NOI-
pid: AT_abc239_h
tag: []
---

# [ABC239Ex] Dice Product 2

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc239/tasks/abc239_h

すぬけ君は $ 1 $ 以上 $ N $ 以下の整数が等確率で出るサイコロと整数 $ 1 $ を持っています。  
 すぬけ君は持っている数が $ M $ 以下である間、次の操作を繰り返します。

- サイコロを振り、出た目を $ x $ とする。持っている数に $ x $ を掛ける。

操作を終了するまでにすぬけ君がサイコロを振った回数の期待値を $ \text{mod\ }\ 10^9+7 $ で求めてください。

 期待値 $ \pmod{10^9+7} $ の定義 求める期待値は必ず有理数になることが証明できます。また、この問題の制約のもとでは、その値を既約分数 $ \frac{P}{Q} $ で表した時、$ Q\ \not\equiv\ 0\ \pmod{10^9+7} $ となることも証明できます。よって、$ R\ \times\ Q\ \equiv\ P\ \pmod{10^9+7},\ 0\ \leq\ R\ \lt\ 10^9+7 $ を満たす整数 $ R $ が一意に定まります。 この $ R $ を答えてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ M $

## 输出格式

答えを出力せよ。

## 说明/提示

### 制約

- $ 2\ \leq\ N\ \leq\ 10^9 $
- $ 1\ \leq\ M\ \leq\ 10^9 $

### Sample Explanation 1

答えはサイコロで $ 2 $ が出るまでにサイコロを振る回数の期待値になります。よって $ 2 $ を出力します。

### Sample Explanation 2

答えはサイコロで $ 2 $ が $ 6 $ 回出るまでにサイコロを振る回数の期待値になります。よって $ 12 $ を出力します。

### Sample Explanation 3

答えは $ \frac{9}{4} $ です。$ 4\ \times\ 250000004\ \equiv\ 9\ \pmod{10^9+7} $ なので $ 250000004 $ を出力します。 $ \bf{10^9\ +\ 7\ =\ 1000000007} $ で $ \mathrm{mod} $ を取る必要があるのに注意してください。

## 样例 #1

### 输入

```
2 1
```

### 输出

```
2
```

## 样例 #2

### 输入

```
2 39
```

### 输出

```
12
```

## 样例 #3

### 输入

```
3 2
```

### 输出

```
250000004
```

## 样例 #4

### 输入

```
2392 39239
```

### 输出

```
984914531
```

## 样例 #5

### 输入

```
1000000000 1000000000
```

### 输出

```
776759630
```



---

---
title: "[ABC240G] Teleporting Takahashi"
layout: "post"
diff: 省选/NOI-
pid: AT_abc240_g
tag: []
---

# [ABC240G] Teleporting Takahashi

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc240/tasks/abc240_g

高橋君は無限に広がる三次元グリッドのマス $ (0,\ 0,\ 0) $ にいます。

高橋君は瞬間移動によってマスからマスへ移動する能力を持っています。 マス $ (x,\ y,\ z) $ にいるとき、瞬間移動を $ 1 $ 回行うと $ (x+1,\ y,\ z),\ (x-1,\ y,\ z),\ (x,\ y+1,\ z),\ (x,\ y-1,\ z),\ (x,\ y,\ z+1),\ (x,\ y,\ z-1) $ のいずれかのマスに移動します。（マス $ (x,\ y,\ z) $ にとどまることは出来ないことに注意してください。）

ちょうど $ N $ 回の瞬間移動を行った後にマス $ (X,\ Y,\ Z) $ にいるような高橋君の移動経路が何通りあるかを求めてください。

すなわち、整数の $ 3 $ つ組を $ N+1 $ 個並べた列 $ \big(\ (x_0,\ y_0,\ z_0),\ (x_1,\ y_1,\ z_1),\ (x_2,\ y_2,\ z_2),\ \ldots,\ (x_N,\ y_N,\ z_N)\big) $ であって、下記の $ 3 $ つの条件をすべて満たすものの個数を求めてください。

- $ (x_0,\ y_0,\ z_0)\ =\ (0,\ 0,\ 0) $
- $ (x_N,\ y_N,\ z_N)\ =\ (X,\ Y,\ Z) $
- $ i\ =\ 1,\ 2,\ \ldots,\ N $ について、$ |x_i-x_{i-1}|\ +\ |y_i-y_{i-1}|\ +\ |z_i-z_{i-1}|\ =\ 1 $

ただし、答えは非常に大きくなることがあるので、答えを $ 998244353 $ で割った余りを出力してください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ X $ $ Y $ $ Z $

## 输出格式

答えを $ 998244353 $ で割った余りを出力せよ。

## 说明/提示

### 制約

- $ 1\ \leq\ N\ \leq\ 10^7 $
- $ -10^7\ \leq\ X,\ Y,\ Z\ \leq\ 10^7 $
- $ N,\ X,\ Y,\ Z $ は整数

### Sample Explanation 1

ちょうど $ 3 $ 回の瞬間移動を行った後にマス $ (2,\ 0,\ -1) $ にいるような高橋君の移動経路は、下記の $ 3 $ 通り存在します。 - $ (0,\ 0,\ 0)\ \rightarrow\ (1,\ 0,\ 0)\ \rightarrow\ (2,\ 0,\ 0)\ \rightarrow(2,\ 0,\ -1) $ - $ (0,\ 0,\ 0)\ \rightarrow\ (1,\ 0,\ 0)\ \rightarrow\ (1,\ 0,\ -1)\ \rightarrow(2,\ 0,\ -1) $ - $ (0,\ 0,\ 0)\ \rightarrow\ (0,\ 0,\ -1)\ \rightarrow\ (1,\ 0,\ -1)\ \rightarrow(2,\ 0,\ -1) $

### Sample Explanation 2

ちょうど $ N $ 回の瞬間移動を行わなければならないことと、瞬間移動の際には移動せずにその場にとどまることは出来ないことに注意してください。

### Sample Explanation 3

答えを $ 998244353 $ で割った余りを出力することに注意してください。

## 样例 #1

### 输入

```
3 2 0 -1
```

### 输出

```
3
```

## 样例 #2

### 输入

```
1 0 0 0
```

### 输出

```
0
```

## 样例 #3

### 输入

```
314 15 92 65
```

### 输出

```
106580952
```



---

---
title: "[ABC240Ex] Sequence of Substrings"
layout: "post"
diff: 省选/NOI-
pid: AT_abc240_h
tag: []
---

# [ABC240Ex] Sequence of Substrings

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc240/tasks/abc240_h

$ 0 $ と $ 1 $ のみからなる長さ $ N $ の文字列 $ S\ =\ s_1\ s_2\ \ldots\ s_N $ が与えられます。

整数の $ 2 $ つ組を $ K $ 個並べた列 $ \big((L_1,\ R_1),\ (L_2,\ R_2),\ \ldots,\ (L_K,\ R_K)\big) $ であって以下の $ 3 $ つの条件をすべて満たすものが存在するような最大の整数 $ K $ を出力してください。

- $ i\ =\ 1,\ 2,\ \ldots,\ K $ について、$ 1\ \leq\ L_i\ \leq\ R_i\ \leq\ N $
- $ i\ =\ 1,\ 2,\ \ldots,\ K-1 $ について、$ R_i\ \lt\ L_{i+1} $
- $ i\ =\ 1,\ 2,\ \ldots,\ K-1 $ について、文字列 $ s_{L_i}s_{L_i+1}\ \ldots\ s_{R_i} $ は文字列 $ s_{L_{i+1}}s_{L_{i+1}+1}\ldots\ s_{R_{i+1}} $ より**辞書順で真に小さい**

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ S $

## 输出格式

答えを出力せよ。

## 说明/提示

### 制約

- $ 1\ \leq\ N\ \leq\ 2.5\ \times\ 10^4 $
- $ N $ は整数
- $ S $ は $ 0 $ と $ 1 $ のみからなる長さ $ N $ の文字列

### Sample Explanation 1

$ K\ =\ 3 $ のとき、例えば $ (L_1,\ R_1)\ =\ (1,\ 1),\ (L_2,\ R_2)\ =\ (3,\ 5),\ (L_3,\ R_3)\ =\ (6,\ 7) $ が問題文中の条件を満たします。 実際、$ s_1\ =\ 0 $ は $ s_3s_4s_5\ =\ 010 $ より辞書順で真に小さく、$ s_3s_4s_5\ =\ 010 $ は $ s_6s_7\ =\ 10 $ より辞書順で真に小さいです。 $ K\ \geq\ 4 $ のときは、問題文中の条件を満たす $ \big((L_1,\ R_1),\ (L_2,\ R_2),\ \ldots,\ (L_K,\ R_K)\big) $ は存在しません。

## 样例 #1

### 输入

```
7

0101010
```

### 输出

```
3
```

## 样例 #2

### 输入

```
30

000011001110101001011110001001
```

### 输出

```
9
```



---

---
title: "[ABC241G] Round Robin"
layout: "post"
diff: 省选/NOI-
pid: AT_abc241_g
tag: []
---

# [ABC241G] Round Robin

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc241/tasks/abc241_g

$ 1 $ から $ N $ までの番号がついた $ N $ 人が総当たり戦をしています。  
 すなわち、全ての組 $ (i,j)\ (1\leq\ i\ \lt\ j\ \leq\ N) $ について、人 $ i $ と人 $ j $ は $ 1 $ 回試合をするので、試合は合計で $ \frac{N(N-1)}{2} $ 試合行われます。  
 なお、試合は必ず一方が勝者、もう一方が敗者となり、引き分けとなることはありません。

既に $ M $ 試合が終了しており、$ i $ 試合目では人 $ W_i $ が人 $ L_i $ に勝ちました。

総当たり戦が終了したとき、単独優勝をする可能性のある人を列挙してください。  
 ただし単独優勝とは、その人の勝利数が、他のどの人の勝利数よりも多いことを言います。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ M $ $ W_1 $ $ L_1 $ $ W_2 $ $ L_2 $ $ \vdots $ $ W_M $ $ L_M $

## 输出格式

単独優勝をする可能性のある人の番号の集合を $ A=(A_1,A_2,\dots,A_K)\ (A_1\lt\ A_2\ \lt\ \dots\ \lt\ A_K) $ として、$ A $ を昇順に空白区切りで出力せよ。  
 すなわち、以下の形式で出力せよ。

> $ A_1 $ $ A_2 $ $ \dots $ $ A_K $

## 说明/提示

### 制約

- $ 2\leq\ N\ \leq\ 50 $
- $ 0\leq\ M\ \leq\ \frac{N(N-1)}{2} $
- $ 1\leq\ W_i,L_i\leq\ N $
- $ W_i\ \neq\ L_i $
- $ i\neq\ j $ ならば、$ (W_i,L_i)\ \neq\ (W_j,L_j) $
- $ (W_i,L_i)\ \neq\ (L_j,W_j) $
- 入力は全て整数である

### Sample Explanation 1

人 $ 2,4 $ は単独優勝する可能性があり、人 $ 1,3 $ は単独優勝する可能性がありません。 なお、`4 2` などの出力は不正解となることに注意してください。

### Sample Explanation 2

単独優勝する可能性のある人がいないこともあります。

## 样例 #1

### 输入

```
4 2

2 1

2 3
```

### 输出

```
2 4
```

## 样例 #2

### 输入

```
3 3

1 2

2 3

3 1
```

### 输出

```

```

## 样例 #3

### 输入

```
7 9

6 5

1 2

3 4

5 3

6 2

1 5

3 2

6 4

1 4
```

### 输出

```
1 3 6 7
```



---

---
title: "[ABC241Ex] Card Deck Score"
layout: "post"
diff: 省选/NOI-
pid: AT_abc241_h
tag: []
---

# [ABC241Ex] Card Deck Score

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc241/tasks/abc241_h

$ N $ 個の整数のうちいずれか $ 1 $ つが書かれたカードが何枚かあり、 具体的には、$ A_i $ が書かれたカードが $ B_i $ 枚あります。  
次に、この $ B_1+B_2\cdots\ +B_N $ 枚の中から $ M $ 枚のカードを選ぶ方法について、 その選んだカードに書かれた $ M $ 個の整数の積をその選び方のスコアとして定めます。  
同じ整数が書かれたカードは区別できないとしたとき、$ M $ 枚の選び方としてあり得る すべての選び方についてスコアを足し合わせた値を $ 998244353 $ で割った余りを求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ M $ $ A_1 $ $ B_1 $ $ A_2 $ $ B_2 $ $ \vdots $ $ A_N $ $ B_N $

## 输出格式

答えを出力せよ。

## 说明/提示

### 制約

- $ 1\ \leq\ N\ \leq\ 16 $
- $ 1\ \leq\ M\ \leq\ 10^{18} $
- $ 1\ \leq\ A_i\ <\ 998244353 $
- $ 1\ \leq\ B_i\ \leq\ 10^{17} $
- $ i\neq\ j $ ならば $ A_i\ \neq\ A_j $
- $ M\leq\ B_1+B_2+\cdots\ B_N $
- 入力は全て整数である。

### Sample Explanation 1

$ 3 $ 枚を選ぶ方法としては次の $ 6 $ 通りが考えられます。 - $ 3 $ と書かれたカードを $ 1 $ 枚、$ 5 $ と書かれたカードを $ 2 $ 枚選ぶ。 - $ 3 $ と書かれたカードを $ 1 $ 枚、$ 5 $ と書かれたカードを $ 1 $ 枚、$ 6 $ と書かれたカードを $ 1 $ 枚選ぶ。 - $ 3 $ と書かれたカードを $ 1 $ 枚、$ 6 $ と書かれたカードを $ 2 $ 枚選ぶ。 - $ 5 $ と書かれたカードを $ 2 $ 枚、$ 6 $ と書かれたカードを $ 1 $ 枚選ぶ。 - $ 5 $ と書かれたカードを $ 1 $ 枚、$ 6 $ と書かれたカードを $ 2 $ 枚選ぶ。 - $ 6 $ と書かれたカードを $ 3 $ 枚選ぶ。 スコアは順に $ 75 $, $ 90 $, $ 108 $, $ 150 $, $ 180 $, $ 216 $ であり、これらの総和は $ 819 $ となります。

### Sample Explanation 2

「 $ 1 $ と $ 25 $ の書かれたカードを $ 1 $ 枚ずつ選ぶ」選び方と 「 $ 5 $ の書かれたカードを $ 2 $ 枚選ぶ」選び方は、いずれもスコアは $ 25 $ ですが、 カードの選び方としては異なるものとして数えられます。

### Sample Explanation 3

$ 998244353 $ で割った余りを出力することに注意してください。

## 样例 #1

### 输入

```
3 3
3 1
5 2
6 3
```

### 输出

```
819
```

## 样例 #2

### 输入

```
3 2
1 1
5 2
25 1
```

### 输出

```
180
```

## 样例 #3

### 输入

```
10 232657150901347497
139547946 28316250877914575
682142538 78223540024979445
110643588 74859962623690081
173455495 60713016476190629
271056265 85335723211047202
801329567 48049062628894325
864844366 54979173822804784
338794337 69587449430302156
737638908 15812229161735902
462149872 49993004923078537
```

### 输出

```
39761306
```



---

---
title: "[ABC242Ex] Random Painting"
layout: "post"
diff: 省选/NOI-
pid: AT_abc242_h
tag: []
---

# [ABC242Ex] Random Painting

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc242/tasks/abc242_h

$ 1 $ から $ N $ までの番号が振られた $ N $ 個のマスがあり、始めすべてのマスは白く塗られています。

また、箱の中に $ 1 $ から $ M $ までの番号が振られた $ M $ 個のボールが入っています。

以下の操作を、$ N $ 個のマスがすべて黒く塗られるまで繰り返します。

1. 箱から $ 1 $ つボールを取り出す。取り出し方は完全ランダムであり、各ボールは等確率で選ばれる。
2. 取り出したボールの番号を $ x $ として、マス $ L_x,\ L_x+1,\ \ldots,\ R_x $ を黒く塗る。
3. 取り出したボールを箱に戻す。

操作回数の期待値を $ \text{mod\ }\ 998244353 $ で求めてください（注記参照）。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ M $ $ L_1 $ $ R_1 $ $ L_2 $ $ R_2 $ $ \hspace{0.5cm}\vdots $ $ L_M $ $ R_M $

## 输出格式

求めた期待値を $ \text{mod\ }\ 998244353 $ で出力せよ。

## 说明/提示

### 注記

求める期待値は必ず有理数となることが証明できます。またこの問題の制約下では、その値を互いに素な $ 2 $ つの整数 $ P $, $ Q $ を用いて $ \frac{P}{Q} $ と表したとき、$ R\ \times\ Q\ \equiv\ P\pmod{998244353} $ かつ $ 0\ \leq\ R\ \lt\ 998244353 $ を満たす整数 $ R $ がただ一つ存在することが証明できます。この $ R $ を求めてください。

### 制約

- $ 1\ \leq\ N,M\ \leq\ 400 $
- $ 1\ \leq\ L_i\ \leq\ R_i\ \leq\ N $
- すべてのマス $ i $ についてある整数 $ j $ が存在し、$ L_j\ \leq\ i\ \leq\ R_j $
- 入力はすべて整数

### Sample Explanation 1

求める期待値は $ \frac{7}{2} $ です。 $ 499122180\ \times\ 2\ \equiv\ 7\pmod{998244353} $ なので、$ 499122180 $ を出力します。

## 样例 #1

### 输入

```
3 3

1 1

1 2

2 3
```

### 输出

```
499122180
```

## 样例 #2

### 输入

```
13 10

3 5

5 9

3 12

1 13

9 11

12 13

2 4

9 12

9 11

7 11
```

### 输出

```
10
```

## 样例 #3

### 输入

```
100 11

22 43

84 93

12 71

49 56

8 11

1 61

13 80

26 83

23 100

80 85

9 89
```

### 输出

```
499122193
```



---

---
title: "[ABC244Ex] Linear Maximization"
layout: "post"
diff: 省选/NOI-
pid: AT_abc244_h
tag: []
---

# [ABC244Ex] Linear Maximization

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc244/tasks/abc244_h

$ 2 $ 次元平面上の点の集合 $ S $ があります。$ S $ ははじめ空です。

$ i\ =\ 1,\ 2,\ \dots,\ Q $ の順に、以下のクエリを処理してください。

- 整数 $ X_i,\ Y_i,\ A_i,\ B_i $ が与えられる。$ S $ に点 $ (X_i,\ Y_i) $ を追加した後、$ \displaystyle\ \max_{(x,y)\ \in\ S}\left\{A_ix\ +\ B_iy\right\} $ を求める。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ Q $ $ X_1 $ $ Y_1 $ $ A_1 $ $ B_1 $ $ X_2 $ $ Y_2 $ $ A_2 $ $ B_2 $ $ \vdots $ $ X_Q $ $ Y_Q $ $ A_Q $ $ B_Q $

## 输出格式

$ Q $ 行出力せよ。$ i $ 行目には、$ i $ 個目のクエリに対する答えを出力せよ。

## 说明/提示

### 制約

- 入力は全て整数
- $ 1\ <\ =Q\ <\ =2\ \times\ 10^5 $
- $ |X_i|,\ |Y_i|,\ |A_i|,\ |B_i|\ <\ =10^9 $
- $ i\ ≠\ j $ ならば $ (X_i,\ Y_i)≠(X_j,\ Y_j) $

### Sample Explanation 1

\- $ i\ =\ 1 $ のとき : $ S $ に点 $ (1,\ 0) $ を追加し、$ S\ =\ \{(1,\ 0)\} $ とします。$ (x,\ y)\ =\ (1,\ 0) $ のとき $ -x\ -\ y\ =\ -1 $ となり、これが最大値を取ります。 - $ i\ =\ 2 $ のとき : $ S $ に点 $ (0,\ 1) $ を追加し、$ S\ =\ \{(0,\ 1),\ (1,\ 0)\} $ とします。$ (x,\ y)\ =\ (1,\ 0) $ のとき $ 2x\ =\ 2 $ となり、これが最大値を取ります。 - $ i\ =\ 3 $ のとき : $ S $ に点 $ (-1,\ 0) $ を追加し、$ S\ =\ \{(-1,\ 0),\ (0,\ 1),\ (1,\ 0)\} $ とします。$ (x,\ y)\ =\ (1,\ 0) $ または $ (x,\ y)\ =\ (0,\ 1) $ のとき $ x\ +\ y\ =\ 1 $ となり、これが最大値を取ります。 - $ i\ =\ 4 $ のとき : $ S $ に点 $ (0,\ -1) $ を追加し、$ S\ =\ \{(-1,\ 0),\ (0,\ -1),\ (0,\ 1),\ (1,\ 0)\} $ とします。$ (x,\ y)\ =\ (0,\ -1) $ のとき $ x\ -\ 2y\ =\ 2 $ となり、これが最大値を取ります。

## 样例 #1

### 输入

```
4

1 0 -1 -1

0 1 2 0

-1 0 1 1

0 -1 1 -2
```

### 输出

```
-1

2

1

2
```

## 样例 #2

### 输入

```
9

-1 4 -8 -2

9 -9 -7 7

4 1 6 7

-4 -1 -4 -5

-9 3 -2 -6

-1 0 -8 5

-8 -5 0 0

8 3 0 -4

2 -5 2 5
```

### 输出

```
0

35

31

21

36

87

0

36

31
```



---

---
title: "[ABC247Ex] Rearranging Problem"
layout: "post"
diff: 省选/NOI-
pid: AT_abc247_h
tag: []
---

# [ABC247Ex] Rearranging Problem

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc247/tasks/abc247_h

人 $ 1 $, 人 $ 2 $, $ \dots $, 人 $ N $ の $ N $ 人の人がいて、前から $ (1,2,\dots,N) $ の順に一列に並んでいます。人 $ i $ は色 $ c_i $ の服を着ています。  
 高橋君は任意の $ 2 $ 人 $ i,j $ を選んで人 $ i $ と人 $ j $ の位置を入れ替える操作を $ K $ 回繰り返しました。  
 $ K $ 回の操作を終了した時点で、$ 1\ \leq\ i\ \leq\ N $ を満たすすべての整数 $ i $ に対して、前から $ i $ 番目の人が着ている服の色は $ c_i $ と一致しました。  
 $ K $ 回の操作を終了した後にあり得る人の並び方は何通りありますか？ 答えを $ 998244353 $ で割ったあまりを求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ K $ $ c_1 $ $ c_2 $ $ \dots $ $ c_N $

## 输出格式

答えを出力せよ。

## 说明/提示

### 制約

- $ 2\ \leq\ N\ \leq\ 200000 $
- $ 1\ \leq\ K\ \leq\ 10^9 $
- $ 1\ \leq\ c_i\ \leq\ N $
- 入力される値はすべて整数である。

### Sample Explanation 1

高橋君の操作、および操作後の列としてあり得るものをすべて挙げると次のようになります。 - 人 $ 1 $ と人 $ 2 $ の位置を入れ替える。操作後の並び方は $ (2,\ 1,\ 3,\ 4) $ となる。 - 人 $ 1 $ と人 $ 4 $ の位置を入れ替える。操作後の並び方は $ (4,\ 2,\ 3,\ 1) $ となる。 - 人 $ 2 $ と人 $ 4 $ の位置を入れ替える。操作後の並び方は $ (1,\ 4,\ 3,\ 2) $ となる。

### Sample Explanation 2

あり得る高橋君の操作の例を 1 つ挙げると次のようになります。 - $ 1 $ 回目の操作で人 $ 1 $ と人 $ 3 $ の位置を入れ替える。操作後の並び方は $ (3,\ 2,\ 1) $ となる。 $ 2 $ 回目の操作で人 $ 2 $ と人 $ 3 $ の位置を入れ替える。操作後の並び方は $ (2,\ 3,\ 1) $ となる。 $ 3 $ 回目の操作で人 $ 1 $ と人 $ 3 $ の位置を入れ替える。操作後の並び方は $ (2,\ 1,\ 3) $ となる。 操作の途中においては、前から $ i $ 番目の人の服の色が $ c_i $ と必ずしも一致しなくてもよいのに注意してください。

## 样例 #1

### 输入

```
4 1

1 1 2 1
```

### 输出

```
3
```

## 样例 #2

### 输入

```
3 3

1 1 2
```

### 输出

```
1
```

## 样例 #3

### 输入

```
10 4

2 7 1 8 2 8 1 8 2 8
```

### 输出

```
132
```



---

---
title: "[ABC248G] GCD cost on the tree"
layout: "post"
diff: 省选/NOI-
pid: AT_abc248_g
tag: []
---

# [ABC248G] GCD cost on the tree

## 题目描述

给定一颗树有 $n$ 个结点，每个结点上有一个权值 $a_i$, 对于每条**至少包含两个点**的**简单路径**，它的贡献为 路径上点的数量(包括端点)$\times$路径上所有点的 $a_i$ 
的最大公约数(gcd)。  
求所有简单路径的贡献之和，对 $998244353$ 取模。

## 输入格式

第一行输入 $n$，随后一行 $n$ 个正整数$a_i$ 。  
然后 $n-1$ 行每行一条边 $(u_i,v_i)$ 表示这棵树。

## 输出格式

输出答案所求，$\bmod \ 998244353$ 。

##### 样例解释 #1
记 $C(i,j)$ 表示从 $i$ 到 $j$ 的路径的贡献。  
$C(1,2)=2\times \gcd(24,30)=12$  
$C(1,3)=2\times \gcd(24,28)=8$  
$C(1,4)=3\times \gcd(24,28,7)=3$  
$C(2,3)=3\times \gcd(30,24,28)=6$  
$C(2,4)=4\times \gcd(30,24,28,7)=4$  
$C(3,4)=2\times \gcd(28,7)=14$  
总和为 $\displaystyle\sum_{i=1}^{3}\sum_{j=i+1}^4 
 C(i,j)=(12+8+3)+(6+4)+14=47$.

## 说明/提示

$2 \le n \le 10^5$  
$1 \le a_i \le 10^5$

## 样例 #1

### 输入

```
4
24 30 28 7
1 2
1 3
3 4
```

### 输出

```
47
```

## 样例 #2

### 输入

```
10
180 168 120 144 192 200 198 160 156 150
1 2
2 3
2 4
2 5
5 6
4 7
7 8
7 9
9 10
```

### 输出

```
1184
```



---

---
title: "[ABC248Ex] Beautiful Subsequences"
layout: "post"
diff: 省选/NOI-
pid: AT_abc248_h
tag: []
---

# [ABC248Ex] Beautiful Subsequences

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc248/tasks/abc248_h

$ (1,\ldots,N) $ を並び替えて得られる長さ $ N $ の順列 $ P=(P_1,\ldots,P_N) $、及び整数 $ K $ が与えられます。

以下の条件を全て満たす整数組 $ (L,R) $ の個数を求めてください。

- $ 1\ \leq\ L\ \leq\ R\ \leq\ N $
- $ \mathrm{max}(P_L,\ldots,P_R)\ -\ \mathrm{min}(P_L,\ldots,P_R)\ \leq\ R\ -\ L\ +\ K $

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ K $ $ P_1 $ $ P_2 $ $ \ldots $ $ P_N $

## 输出格式

答えを出力せよ。

## 说明/提示

### 制約

- $ 1\ \leq\ N\ \leq\ 1.4\times\ 10^5 $
- $ P $ は $ (1,\ldots,N) $ を並び替えて得られる順列
- $ 0\ \leq\ K\ \leq\ 3 $
- 入力は全て整数

### Sample Explanation 1

条件を満たす組 $ (L,R) $ は以下の $ 9 $ 個です。 - $ (1,1) $ - $ (1,3) $ - $ (1,4) $ - $ (2,2) $ - $ (2,3) $ - $ (2,4) $ - $ (3,3) $ - $ (3,4) $ - $ (4,4) $ $ (L,R)\ =\ (1,2) $ は $ \mathrm{max}(A_1,A_2)\ -\mathrm{min}(A_1,A_2)\ =\ 4-1\ =\ 3 $ 、$ R-L+K=2-1+1\ =\ 2 $ となるので、条件を満たしません。

## 样例 #1

### 输入

```
4 1

1 4 2 3
```

### 输出

```
9
```

## 样例 #2

### 输入

```
2 0

2 1
```

### 输出

```
3
```

## 样例 #3

### 输入

```
10 3

3 7 10 1 9 5 4 8 6 2
```

### 输出

```
37
```



---

---
title: "[ABC249G] Xor Cards"
layout: "post"
diff: 省选/NOI-
pid: AT_abc249_g
tag: []
---

# [ABC249G] Xor Cards

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc249/tasks/abc249_g

$ N $ 枚のカードがあり、$ 1,\ \dots,\ N $ の番号が付けられています。カード $ i\ \,\ (1\ \leq\ i\ \leq\ N) $ の表には整数 $ A_i $、裏には整数 $ B_i $ が書かれています。

選んだカードの表に書かれた整数の排他的論理和が $ K $ 以下となるように $ 1 $ 枚以上の好きな枚数のカードを選ぶとき、選んだカードの裏に書かれた整数の排他的論理和としてあり得る最大値を求めてください。

 排他的論理和とは 整数 $ a,\ b $ の排他的論理和 $ a\ \oplus\ b $ は、以下のように定義されます。 - $ a\ \oplus\ b $ を二進表記した際の $ 2^k\ \,\ (k\ \geq\ 0) $ の位の数は、$ a,\ b $ を二進表記した際の $ 2^k $ の位の数のうち一方のみが $ 1 $ であれば $ 1 $、そうでなければ $ 0 $ である。

 例えば、$ 3\ \oplus\ 5\ =\ 6 $ となります（二進表記すると $ 011\ \oplus\ 101\ =\ 110 $）。  
 一般に $ k $ 個の整数 $ p_1,\ \dots,\ p_k $ の排他的論理和は $ (\cdots\ ((p_1\ \oplus\ p_2)\ \oplus\ p_3)\ \oplus\ \cdots\ \oplus\ p_k) $ と定義され、これは $ p_1,\ \dots,\ p_k $ の順番によらないことが証明できます。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ K $ $ A_1 $ $ B_1 $ $ \vdots $ $ A_N $ $ B_N $

## 输出格式

問題文中の条件を満たすようにカードを選ぶとき、選んだカードの裏に書かれた整数の排他的論理和としてあり得る最大値を出力せよ。ただし、条件を満たすようにカードを選ぶことができないときは $ -1 $ と出力せよ。

## 说明/提示

### 制約

- $ 1\ \leq\ N\ \leq\ 1000 $
- $ 0\ \leq\ K\ \lt\ 2^{30} $
- $ 0\ \leq\ A_i,\ B_i\ \lt\ 2^{30}\ \,\ (1\ \leq\ i\ \leq\ N) $
- 入力は全て整数

### Sample Explanation 1

カード $ 1,\ 2 $ を選ぶことで、表に書かれた整数の排他的論理和は $ 2 $、裏に書かれた整数の排他的論理和は $ 3 $ となり、これが最大です。

### Sample Explanation 2

条件を満たすようにカードを選ぶことはできません。

## 样例 #1

### 输入

```
4 2

1 1

3 2

2 2

0 1
```

### 输出

```
3
```

## 样例 #2

### 输入

```
1 2

3 4
```

### 输出

```
-1
```

## 样例 #3

### 输入

```
10 326872757

487274679 568989827

267359104 968688210

669234369 189421955

1044049637 253386228

202278801 233212012

436646715 769734012

478066962 376960084

491389944 1033137442

214977048 1051768288

803550682 1053605300
```

### 输出

```
1064164329
```



---

---
title: "[ABC250Ex] Trespassing Takahashi"
layout: "post"
diff: 省选/NOI-
pid: AT_abc250_h
tag: []
---

# [ABC250Ex] Trespassing Takahashi

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc250/tasks/abc250_h

$ 1 $ から $ N $ までの番号がついた $ N $ 個の地点と $ M $ 本の道があります。 $ i\ \,\ (1\ \leq\ i\ \leq\ M) $ 番目の道は地点 $ a_i $ と地点 $ b_i $ を双方向に結んでいて、通過に $ c_i $ 分かかります。すべての地点同士は道を何本か通って行き来出来ます。また、地点 $ 1,\ldots,\ K $ には家があります。

$ i=1,\ldots,Q $ に対し、次の問題を解いてください。

> 地点 $ x_i $ の家にいる高橋君が地点 $ y_i $ の家に移動しようとしている。  
>  高橋君は最後に睡眠を取ってから道の移動にかかった時間が $ t_i $ 分を超えると移動が出来なくなる。  
>  睡眠を取れる場所は家がある地点のみであるが、回数に制限は無い。  
>  高橋君が地点 $ x_i $ から地点 $ y_i $ まで移動出来るならば `Yes` と、出来ないならば `No` と出力せよ。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ M $ $ K $ $ a_1 $ $ b_1 $ $ c_1 $ $ \vdots $ $ a_M $ $ b_M $ $ c_M $ $ Q $ $ x_1 $ $ y_1 $ $ t_1 $ $ \vdots $ $ x_Q $ $ y_Q $ $ t_Q $

## 输出格式

$ Q $ 行出力せよ。 $ i $ 行目には、$ i $ 番目の問題に対する出力をせよ。

## 说明/提示

### 制約

- $ 2\ \leq\ K\ \leq\ N\ \leq\ 2\ \times\ 10^5 $
- $ N-1\ \leq\ M\ \leq\ \min\ (2\ \times\ 10^5,\ \frac{N(N-1)}{2}) $
- $ 1\ \leq\ a_i\ \lt\ b_i\ \leq\ N $
- $ i\ \neq\ j $ ならば $ (a_i,b_i)\ \neq\ (a_j,b_j) $
- $ 1\ \leq\ c_i\ \leq\ 10^9 $
- すべての地点同士は道を何本か通って行き来出来る
- $ 1\ \leq\ Q\ \leq\ 2\ \times\ 10^5 $
- $ 1\ \leq\ x_i\ \lt\ y_i\ \leq\ K $
- $ 1\ \leq\ t_1\ \leq\ \ldots\ \leq\ t_Q\ \leq\ 10^{15} $
- 入力は全て整数

### Sample Explanation 1

$ 3 $ 番目の問題において、地点 $ 1 $ から地点 $ 3 $ に直接向かうと $ 13 $ 分以上かかります。しかし、 $ 12 $ 分かけて地点 $ 2 $ に移動し、そこにある家で睡眠を取ってから地点 $ 3 $ に移動することが出来ます。よって、答えは `Yes` となります。

## 样例 #1

### 输入

```
6 6 3

1 4 1

4 6 4

2 5 2

3 5 3

5 6 5

1 2 15

3

2 3 4

2 3 5

1 3 12
```

### 输出

```
No

Yes

Yes
```



---

---
title: "[ABC251G] Intersection of Polygons"
layout: "post"
diff: 省选/NOI-
pid: AT_abc251_g
tag: []
---

# [ABC251G] Intersection of Polygons

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc251/tasks/abc251_g

$ xy $ -平面上の凸 $ N $ 角形 $ P $ の頂点が、**反時計回り**に $ (x_1,\ y_1),\ (x_2,\ y_2),\ \ldots,\ (x_N,\ y_N) $ として与えられます。（ただし、$ x $ 軸の正の方向を右向き、$ y $ 軸の正の方向を上向きとします。）

この多角形 $ P $ に対して、$ M $ 個の凸 $ N $ 多角形 $ P_1,\ P_2,\ \ldots,\ P_M $ を考えます。  
 $ i\ =\ 1,\ 2,\ \ldots,\ M $ について多角形 $ P_i $ は、 多角形 $ P $ を $ x $ 軸の正の方向に $ u_i $ 、$ y $ 軸の正の方向に $ v_i $ だけ平行移動して得られる多角形です。すなわち、$ P_i $ は $ N $ 個の点 $ (x_1+u_i,\ y_1+v_i),\ (x_2+u_i,\ y_2+v_i),\ \ldots,\ (x_N+u_i,\ y_N+v_i) $ を頂点とする凸 $ N $ 角形です。

$ Q $ 個の点 $ (a_1,\ b_1),\ (a_2,\ b_2),\ \ldots,\ (a_Q,\ b_Q) $ のそれぞれについて、 「その点が $ M $ 個の多角形 $ P_1,\ P_2,\ \ldots,\ P_M $ のすべてに含まれるか」を判定してください。

ただし、点が多角形の境界上にある場合も、その点はその多角形に含まれるとみなします。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ x_1 $ $ y_1 $ $ x_2 $ $ y_2 $ $ \vdots $ $ x_N $ $ y_N $ $ M $ $ u_1 $ $ v_1 $ $ u_2 $ $ v_2 $ $ \vdots $ $ u_M $ $ v_M $ $ Q $ $ a_1 $ $ b_1 $ $ a_2 $ $ b_2 $ $ \vdots $ $ a_Q $ $ b_Q $

## 输出格式

$ Q $ 行出力せよ。$ i\ =\ 1,\ 2,\ \ldots,\ Q $ について、$ i $ 行目には点 $ (a_i,\ b_i) $ が $ M $ 個の多角形 $ P_1,\ P_2,\ \ldots,\ P_M $ のすべてに含まれる場合は `Yes` を、そうでない場合は `No` を出力せよ。

## 说明/提示

### 制約

- $ 3\ \leq\ N\ \leq\ 50 $
- $ 1\ \leq\ M\ \leq\ 2\ \times\ 10^5 $
- $ 1\ \leq\ Q\ \leq\ 2\ \times\ 10^5 $
- $ -10^8\ \leq\ x_i,\ y_i\ \leq\ 10^8 $
- $ -10^8\ \leq\ u_i,\ v_i\ \leq\ 10^8 $
- $ -10^8\ \leq\ a_i,\ b_i\ \leq\ 10^8 $
- 入力はすべて整数
- $ (x_1,\ y_1),\ (x_2,\ y_2),\ \ldots,\ (x_N,\ y_N) $ は反時計回りに凸多角形をなす
- 多角形 $ P $ のそれぞれの内角の大きさは $ 180 $ 度未満

### Sample Explanation 1

多角形 $ P $ は $ (-2,\ -3),\ (0,\ -2),\ (1,\ 0),\ (0,\ 2),\ (-2,\ 1) $ を頂点とする $ 5 $ 角形です。 - 多角形 $ P_1 $ は、$ P $ を $ x $ 軸の正の方向に $ 0 $ 、$ y $ 軸の正の方向に $ 1 $ だけ平行移動させた、$ (-2,\ -2),\ (0,\ -1),\ (1,\ 1),\ (0,\ 3),\ (-2,\ 2) $ を頂点とする $ 5 $ 角形です。 - 多角形 $ P_2 $ は、$ P $ を $ x $ 軸の正の方向に $ 1 $ 、$ y $ 軸の正の方向に $ 0 $ だけ平行移動させた、$ (-1,\ -3),\ (1,\ -2),\ (2,\ 0),\ (1,\ 2),\ (-1,\ 1) $ を頂点とする $ 5 $ 角形です。 よって、下記の通りに $ 6 $ 行出力します。 - $ (a_1,\ b_1)\ =\ (0,\ 0) $ は $ P_1 $ と $ P_2 $ の両方に含まれるので、$ 1 $ 行目には `Yes` を出力します。 - $ (a_2,\ b_2)\ =\ (1,\ 0) $ は $ P_2 $ には含まれますが $ P_1 $ には含まれないので、$ 2 $ 行目には `No` を出力します。 - $ (a_3,\ b_3)\ =\ (0,\ 1) $ は $ P_1 $ と $ P_2 $ の両方に含まれるので、$ 3 $ 行目には `Yes` を出力します。 - $ (a_4,\ b_4)\ =\ (1,\ 1) $ は $ P_1 $ と $ P_2 $ の両方に含まれるので、$ 4 $ 行目には `Yes` を出力します。 - $ (a_5,\ b_5)\ =\ (-1,\ -1) $ は $ P_1 $ と $ P_2 $ の両方に含まれるので、$ 5 $ 行目には `Yes` を出力します。 - $ (a_6,\ b_6)\ =\ (-1,\ -2) $ は $ P_2 $ には含まれますが $ P_1 $ には含まれないので、$ 6 $ 行目には `No` を出力します。 多角形の境界上にある点も多角形に含まれるとみなすことに注意してください。 !\[\](https://img.atcoder.jp/abc251/8216bd194340d2648ce000e9ac9a203e.png)

## 样例 #1

### 输入

```
5

-2 -3

0 -2

1 0

0 2

-2 1

2

0 1

1 0

6

0 0

1 0

0 1

1 1

-1 -1

-1 -2
```

### 输出

```
Yes

No

Yes

Yes

Yes

No
```

## 样例 #2

### 输入

```
10

45 100

-60 98

-95 62

-95 28

-78 -41

-54 -92

-8 -99

87 -94

98 23

87 91

5

-57 -40

-21 -67

25 39

-30 25

39 -20

16

4 5

-34 -8

-63 53

78 84

19 -16

64 9

-13 7

13 53

-20 4

2 -7

3 18

-12 10

-69 -93

2 9

27 64

-92 -100
```

### 输出

```
Yes

Yes

No

No

Yes

No

Yes

No

Yes

Yes

Yes

Yes

No

Yes

No

No
```



---

---
title: "[ABC253Ex] We Love Forest"
layout: "post"
diff: 省选/NOI-
pid: AT_abc253_h
tag: []
---

# [ABC253Ex] We Love Forest

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc253/tasks/abc253_h

頂点に $ 1 $ から $ N $ の番号がついた $ N $ 頂点 $ 0 $ 辺のグラフ $ G $ があります。また、長さ $ M $ の数列 $ u=(u_1,u_2,\ldots,u_M),v=(v_1,v_2,\ldots,v_M) $ が与えられます。

あなたは以下の操作を $ N-1 $ 回行います。

- $ i $ $ (1\ \leq\ i\ \leq\ M) $ を一様ランダムに選ぶ。 $ G $ に頂点 $ u_i $ と頂点 $ v_i $ を結ぶ無向辺を追加する。

すでに $ G $ に $ u_i $ と $ v_i $ を結ぶ辺があった場合も、新たに辺を追加する操作を行うことに注意してください。すなわち、操作後の $ G $ には多重辺が存在する可能性があります。

$ K=1,2,\ldots,N-1 $ について、$ K $ 回の操作後に $ G $ が森になっている確率を $ \bmod\ 998244353 $ で求めてください。

 森とは？閉路を含まない無向グラフのことを森と呼びます。森は連結でなくても構いません。

 確率 $ \bmod\ 998244353 $ の定義この問題で求める確率は必ず有理数になることが証明できます。 また、この問題の制約下では、求める確率を既約分数 $ \frac{y}{x} $ で表したときに $ x $ が $ 998244353 $ で割り切れないことが保証されます。

このとき $ xz\ \equiv\ y\ \pmod{998244353} $ を満たすような $ 0 $ 以上 $ 998244352 $ 以下の整数 $ z $ が一意に定まります。この $ z $ を答えてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ M $ $ u_1 $ $ v_1 $ $ \vdots $ $ u_M $ $ v_M $

## 输出格式

$ N-1 $ 行出力せよ。$ i $ 行目には $ i $ 回の操作後に $ G $ が森になっている確率を $ \bmod\ 998244353 $ で出力せよ。

## 说明/提示

### 制約

- $ 2\ \leq\ N\ \leq\ 14 $
- $ N-1\ \leq\ M\ \leq\ 500 $
- $ 1\ \leq\ u_i,v_i\ \leq\ N $
- $ u_i\neq\ v_i $
- 入力は全て整数

### Sample Explanation 1

頂点 $ u $ と頂点 $ v $ を結ぶ辺を $ (u,v) $ と書きます。 操作を $ 1 $ 回行った後の $ G $ は以下のようになります。 - $ 1/2 $ の確率で、辺 $ (1,\ 2) $ が存在する。 - $ 1/2 $ の確率で、辺 $ (2,\ 3) $ が存在する。 どちらの場合も $ G $ は森なので、 $ K=1 $ の場合の答えは $ 1 $ です。 操作を $ 2 $ 回行った後の $ G $ は以下のようになります。 - $ 1/4 $ の確率で、辺 $ (1,\ 2),(1,2) $ が存在する。 - $ 1/4 $ の確率で、辺 $ (2,\ 3),(2,3) $ が存在する。 - $ 1/2 $ の確率で、辺 $ (1,\ 2),(2,3) $ が存在する。 辺 $ (1,2),(2,3) $ が存在するときのみ $ G $ は森となっています。よって求める確率は $ 1/2 $ であり、これを $ \bmod\ 998244353 $ で表した $ 499122177 $ を出力してください。

## 样例 #1

### 输入

```
3 2

1 2

2 3
```

### 输出

```
1

499122177
```

## 样例 #2

### 输入

```
4 5

1 2

1 2

1 4

2 3

2 4
```

### 输出

```
1

758665709

918384805
```



---

---
title: "[ABC254G] Elevators"
layout: "post"
diff: 省选/NOI-
pid: AT_abc254_g
tag: []
---

# [ABC254G] Elevators

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc254/tasks/abc254_g

$ N $ 棟の $ 10^9 $ 階建てのビルからなる建物があります。ビルには $ 1 $ から $ N $ の番号がついています。

任意の異なるビルの同じ階は連絡通路で結ばれているため $ 1 $ 分で移動可能です。

また、$ M $ 基のエレベーターがあります。$ i $ 個目のエレベーターはビル $ A_i $ の $ B_i $ 階から $ C_i $ 階を結ぶものです。このエレベーターを使うと、$ B_i\ \le\ x,y\ \le\ C_i $ を満たす全ての整数の組 $ x,y $ に対し、ビル $ A_i $ の $ x $ 階から $ y $ 階に $ |x-y| $ 分で移動することができます。

以下の $ Q $ 個のクエリに答えてください。

- ビル $ X_i $ の $ Y_i $ 階からビル $ Z_i $ の $ W_i $ 階に移動することが可能か判定し、可能な場合は移動時間の最小値を求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ M $ $ Q $ $ A_1 $ $ B_1 $ $ C_1 $ $ A_2 $ $ B_2 $ $ C_2 $ $ \vdots $ $ A_M $ $ B_M $ $ C_M $ $ \mathrm{query}_1 $ $ \mathrm{query}_2 $ $ \vdots $ $ \mathrm{query}_Q $

各クエリは以下の形式で与えられる。

> $ X_i $ $ Y_i $ $ Z_i $ $ W_i $

## 输出格式

$ Q $ 行出力せよ。$ i $ 行目には $ \mathrm{query}_i $ について、移動することが不可能であれば `-1` を、そうでないならば移動時間の最小値を出力せよ。

## 说明/提示

### 制約

- $ 1\ \le\ N,M,Q\ \le\ 2\ \times\ 10^5 $
- $ 1\ \le\ A_i\ \le\ N $
- $ 1\ \le\ B_i\ <\ C_i\ \le\ 10^9 $
- $ 1\ \le\ X_i,Z_i\ \le\ N $
- $ 1\ \le\ Y_i,W_i\ \le\ 10^9 $
- 入力はすべて整数である。

### Sample Explanation 1

$ 1 $ 番目のクエリについては、以下のようにすることで $ 12 $ 分で移動が可能です。 - エレベーター $ 1 $ を使い、ビル $ 1 $ の $ 3 $ 階から $ 9 $ 階へ移動する。この移動には $ 6 $ 分かかる。 - $ 9 $ 階の連絡通路を使い、ビル $ 1 $ からビル $ 3 $ へ移動する。この移動には $ 1 $ 分かかる。 - エレベーター $ 3 $ を使い、ビル $ 3 $ の $ 9 $ 階から $ 14 $ 階で移動する。この移動には $ 5 $ 分かかる。 また、$ 3 $ 番目のクエリについては、移動することが不可能であるため `-1` を出力します。

## 样例 #1

### 输入

```
3 4 3
1 2 10
2 3 7
3 9 14
3 1 3
1 3 3 14
3 1 2 7
1 100 1 101
```

### 输出

```
12
7
-1
```

## 样例 #2

### 输入

```
1 1 1
1 1 2
1 1 1 2
```

### 输出

```
1
```



---

---
title: "[ABC254Ex] Multiply or Divide by 2"
layout: "post"
diff: 省选/NOI-
pid: AT_abc254_h
tag: []
---

# [ABC254Ex] Multiply or Divide by 2

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc254/tasks/abc254_h

$ N $ 個の非負整数からなる多重集合 $ A=\{\ a_1,\ldots,a_N\ \},\ B=\{\ b_1,\ldots,b_N\ \} $ が与えられます。  
あなたは以下の操作を好きな順番で何度でも行えます。

- $ A $ に含まれている非負整数を $ 1 $ つ選び、$ x $ とする。 $ A $ から $ x $ を $ 1 $ つ削除し、代わりに $ 2x $ を $ 1 $ つ追加する。
- $ A $ に含まれている非負整数を $ 1 $ つ選び、$ x $ とする。 $ A $ から $ x $ を $ 1 $ つ削除し、代わりに $ \left\lfloor\ \frac{x}{2}\ \right\rfloor $ を $ 1 $ つ追加する。($ \lfloor\ x\ \rfloor $ は $ x $ を超えない最大の整数)

あなたの目的は $ A $ と $ B $ を(多重集合として)一致させることです。  
目的を達成することが出来るかどうかを判定し、出来る場合は必要な操作回数の最小値を求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ a_1 $ $ \ldots $ $ a_N $ $ b_1 $ $ \ldots $ $ b_N $

## 输出格式

目的を達成出来る場合は必要な操作回数の最小値を出力せよ。出来ない場合は `-1` を出力せよ。

## 说明/提示

### 制約

- $ 1\ \leq\ N\ \leq\ 10^5 $
- $ 0\ \leq\ a_1\ \leq\ \ldots\ \leq\ a_N\ \leq\ 10^9 $
- $ 0\ \leq\ b_1\ \leq\ \ldots\ \leq\ b_N\ \leq\ 10^9 $
- 入力はすべて整数

### Sample Explanation 1

次のようにして $ 2 $ 回の操作で目的を達成できます。 - $ x=3 $ とし、$ A $ から $ x\,\ (=3) $ を $ 1 $ つ削除し代わりに $ 2x\,\ (=6) $ を $ 1 $ つ追加する。これによって $ A=\{4,5,6\} $ となる。 - $ x=5 $ とし、$ A $ から $ x\,\ (=5) $ を $ 1 $ つ削除し代わりに $ \left\lfloor\ \frac{x}{2}\ \right\rfloor\ \,\ (=2) $ を $ 1 $ つ追加する。これによって $ A=\{2,4,6\} $ となる。

### Sample Explanation 2

$ \{\ 0\ \} $ を $ \{\ 1\ \} $ にすることは出来ません。

## 样例 #1

### 输入

```
3
3 4 5
2 4 6
```

### 输出

```
2
```

## 样例 #2

### 输入

```
1
0
1
```

### 输出

```
-1
```



---

---
title: "[ABC255G] Constrained Nim"
layout: "post"
diff: 省选/NOI-
pid: AT_abc255_g
tag: []
---

# [ABC255G] Constrained Nim

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc255/tasks/abc255_g

高橋君と青木君が、いくつかの石からなる $ N $ 個の山を用いて石とりゲームで対戦します。

はじめ、$ i\ =\ 1,\ 2,\ \ldots,\ N $ について、$ i $ 番目の山は $ A_i $ 個の石からなります。 高橋君からはじめ、$ 2 $ 人は交互に次の行動をくりかえします。

> 石が $ 1 $ 個以上残っている山を $ 1 $ つ選び、その山から $ 1 $ 個以上の石を取り除く。

ただし、このゲームには $ M $ 種類の禁じ手があり、禁じ手に該当する行動を行うことはできません。  
 $ i\ =\ 1,\ 2,\ \ldots,\ M $ について、$ i $ 種類目の禁じ手は「ちょうど $ X_i $ 個の石からなる山からちょうど $ Y_i $ 個の石を取り除くこと」です。

先に行動を行うことができなくなった方のプレイヤーの負けとなり、負けなかった方のプレイヤーの勝ちとなります。 両者が自身が勝つために最適な戦略をとるとき、どちらのプレイヤーが勝つかを答えてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ M $ $ A_1 $ $ A_2 $ $ \ldots $ $ A_N $ $ X_1 $ $ Y_1 $ $ X_2 $ $ Y_2 $ $ \vdots $ $ X_M $ $ Y_M $

## 输出格式

両者が自身が勝つために最適な戦略をとるとき、高橋君が勝つならば `Takahashi` と、青木君が勝つならば `Aoki` と出力せよ。

## 说明/提示

### 制約

- $ 1\ \leq\ N\ \leq\ 2\ \times\ 10^5 $
- $ 1\ \leq\ M\ \leq\ 2\ \times\ 10^5 $
- $ 1\ \leq\ A_i\ \leq\ 10^{18} $
- $ 1\ \leq\ Y_i\ \leq\ X_i\ \leq\ 10^{18} $
- $ i\ \neq\ j\ \Rightarrow\ (X_i,\ Y_i)\ \neq\ (X_j,\ Y_j) $
- 入力はすべて整数

### Sample Explanation 1

$ i\ =\ 1,\ 2,\ 3 $ について、$ i $ 番目の山にある石の個数を $ A'_i $ とし、 それぞれの山にある石の個数を数列 $ A'\ =\ (A'_1,\ A'_2,\ A'_3) $ を用いて表すことにします。 ゲームが始まる前の時点では、$ A'\ =\ (1,\ 2,\ 4) $ です。ゲームの進行の一例として次のものがあります。 - まず、高橋君が $ 3 $ 番目の山から石を $ 1 $ 個取り除く。その結果、$ A'\ =\ (1,\ 2,\ 3) $ となる。 - 次に、青木君が $ 2 $ 番目の山から石を $ 2 $ 個取り除く。その結果、$ A'\ =\ (1,\ 0,\ 3) $ となる。 - さらに、高橋君が $ 3 $ 番目の山から石を $ 2 $ 個取り除く。その結果、$ A'\ =\ (1,\ 0,\ 1) $ となる。 その後の時点で、$ 1 $ 番目と $ 3 $ 番目の山にはまだ石が $ 1 $ 個ずつ残っていますが、ちょうど $ 1 $ 個の石からなる山からちょうど $ 1 $ 個の石を取り除くことは $ 4 $ 種類目の禁じ手に該当するため、青木君は行動を行うことができません。したがって、高橋君の勝ちとなります。

## 样例 #1

### 输入

```
3 4

1 2 4

2 1

3 3

3 1

1 1
```

### 输出

```
Takahashi
```

## 样例 #2

### 输入

```
1 5

5

5 1

5 2

5 3

5 4

5 5
```

### 输出

```
Aoki
```



---

---
title: "[ABC255Ex] Range Harvest Query"
layout: "post"
diff: 省选/NOI-
pid: AT_abc255_h
tag: []
---

# [ABC255Ex] Range Harvest Query

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc255/tasks/abc255_h

$ N $ 本の木があります。$ 0 $ 日目にはどの木にも実は一つもなっていません。  
 $ 1 $ 日目以降の毎朝、それぞれの $ i\ =\ 1,\ 2,\ \ldots,\ N $ について、$ i $ 番目の木に $ i $ 個の実が増えます。

高橋君は $ Q $ 回の収穫作業をします。 $ i\ =\ 1,\ 2,\ \ldots,\ Q $ について、$ i $ 回目の収穫作業は $ D_i $ 日目の夜に行われ、その時点で $ L_i $ 番目から $ R_i $ 番目の木になっているすべての実を収穫します。

$ Q $ 回の収穫作業のそれぞれについて、高橋君が収穫する実の個数を $ 998244353 $ で割ったあまりを出力してください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ Q $ $ D_1 $ $ L_1 $ $ R_1 $ $ D_2 $ $ L_2 $ $ R_2 $ $ \vdots $ $ D_Q $ $ L_Q $ $ R_Q $

## 输出格式

$ Q $ 行出力せよ。 $ i\ =\ 1,\ 2,\ \ldots,\ Q $ について、$ i $ 行目には高橋君が $ i $ 回目の収穫作業で収穫する実の個数を $ 998244353 $ で割ったあまりを出力せよ。

## 说明/提示

### 制約

- $ 1\ \leq\ N\ \leq\ 10^{18} $
- $ 1\ \leq\ Q\ \leq\ 2\ \times\ 10^5 $
- $ 1\ \leq\ D_1\ \lt\ D_2\ \lt\ \cdots\ \lt\ D_Q\ \leq\ 10^{18} $
- $ 1\ \leq\ L_i\ \leq\ R_i\ \leq\ N $
- 入力はすべて整数

### Sample Explanation 1

$ i\ =\ 1,\ 2,\ 3,\ 4,\ 5 $ について、$ i $ 番目の木になっている実の個数を $ A_i $ とし、 それぞれの木になっている実の個数を数列 $ A\ =\ (A_1,\ A_2,\ A_3,\ A_4,\ A_5) $ を用いて表すことにします。 - $ 0 $ 日目、$ A\ =\ (0,\ 0,\ 0,\ 0,\ 0) $ です。 - $ 1 $ 日目の朝、それぞれの木に新たに実がなり、$ A\ =\ (1,\ 2,\ 3,\ 4,\ 5) $ となります。 - $ 2 $ 日目の朝、それぞれの木に新たに実がなり、$ A\ =\ (2,\ 4,\ 6,\ 8,\ 10) $ となります。 - $ 2 $ 日目の夜、高橋君は $ 1 $ 回目の収穫を行います。$ 4\ +\ 6\ =\ 10 $ 個の木の実を収穫し、$ A\ =\ (2,\ 0,\ 0,\ 8,\ 10) $ となります。 - $ 3 $ 日目の朝、それぞれの木に新たに実がなり、$ A\ =\ (3,\ 2,\ 3,\ 12,\ 15) $ となります。 - $ 3 $ 日目の夜、高橋君は $ 2 $ 回目の収穫を行います。$ 3\ +\ 12\ =\ 15 $ 個の木の実を収穫し、$ A\ =\ (3,\ 2,\ 0,\ 0,\ 15) $ となります。 - $ 4 $ 日目の朝、それぞれの木に新たに実がなり、$ A\ =\ (4,\ 4,\ 3,\ 4,\ 20) $となります。 - $ 5 $ 日目の朝、それぞれの木に新たに実がなり、$ A\ =\ (5,\ 6,\ 6,\ 8,\ 25) $となります。 - $ 5 $ 日目の夜、高橋君は $ 3 $ 回目の収穫を行います。$ 5\ +\ 6\ +\ 6\ +\ 8\ +\ 25\ =\ 50 $ 個の木の実を収穫し、$ A\ =\ (0,\ 0,\ 0,\ 0,\ 0) $ となります。

### Sample Explanation 2

$ 998244353 $ で割ったあまりを出力することに注意してください。

## 样例 #1

### 输入

```
5 3

2 2 3

3 3 4

5 1 5
```

### 输出

```
10

15

50
```

## 样例 #2

### 输入

```
711741968710511029 1

82803157126515475 516874290286751784 588060532191410838
```

### 输出

```
603657470
```



---

---
title: "[ABC256Ex] I like Query Problem"
layout: "post"
diff: 省选/NOI-
pid: AT_abc256_h
tag: []
---

# [ABC256Ex] I like Query Problem

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc256/tasks/abc256_h

$ N,\ Q $ および $ A\ =\ (a_1,\ a_2,\ \dots,\ a_N) $ が与えられます。  
 以下で説明されるクエリを $ Q $ 個処理してください。クエリは次の $ 3 $ 種類のいずれかです。

- `1 L R x` : $ i=L,L+1,\dots,R $ について $ a_i $ の値を $ \displaystyle\ \left\lfloor\ \frac{a_i}{x}\ \right\rfloor $ に更新する。
- `2 L R y` : $ i=L,L+1,\dots,R $ について $ a_i $ の値を $ y $ に更新する。
- `3 L R` : $ \displaystyle\sum_{i=L}^R\ a_i $ を出力する。

## 输入格式

入力は以下の形式で標準入力から与えられる。ここで$ \text{query}_i $ は $ i $ 番目に処理するクエリである。

> $ N $ $ Q $ $ a_1 $ $ a_2 $ $ \dots $ $ a_N $ $ \text{query}_1 $ $ \text{query}_2 $ $ \vdots $ $ \text{query}_Q $

各クエリは以下の $ 3 $ 種類のいずれかの形式で与えられる。

> $ 1 $ $ L $ $ R $ $ x $

> $ 2 $ $ L $ $ R $ $ y $

> $ 3 $ $ L $ $ R $

## 输出格式

問題文の指示に従ってクエリへの答えを改行区切りで出力せよ。

## 说明/提示

### 制約

- $ 1\ \leq\ N\ \leq\ 5\ \times\ 10^5 $
- $ 1\ \leq\ Q\ \leq\ 10^5 $
- $ 1\ \leq\ L\ \leq\ R\ \leq\ N $
- $ 1\ \leq\ a_i\ \leq\ 10^5 $
- $ 2\ \leq\ x\ \leq\ 10^5 $
- $ 1\ \leq\ y\ \leq\ 10^5 $
- 入力される値はすべて整数

### Sample Explanation 1

はじめ、$ A\ =\ (2,\ 5,\ 6) $ です。よって $ 1 $ 番目のクエリの答えは $ a_1\ +\ a_2\ +\ a_3\ =\ 2\ +\ 5\ +\ 6\ =\ 13 $ になります。 $ 2 $ 番目のクエリを処理した直後は $ A\ =\ (2,\ 2,\ 3) $ です。よって $ 3 $ 番目のクエリの答えは $ a_1\ +\ a_2\ =\ 2\ +\ 2\ =\ 4 $ になります。 $ 4 $ 番目のクエリを処理した直後は $ A\ =\ (3,\ 3,\ 3) $ です。よって $ 5 $ 番目のクエリの答えは $ a_1\ +\ a_2\ +\ a_3\ =\ 3\ +\ 3\ +\ 3\ =\ 9 $ になります。

## 样例 #1

### 输入

```
3 5

2 5 6

3 1 3

1 2 3 2

3 1 2

2 1 2 3

3 1 3
```

### 输出

```
13

4

9
```

## 样例 #2

### 输入

```
6 11

10 3 5 20 6 7

3 1 6

1 2 4 3

3 1 3

2 1 4 10

3 3 6

1 3 6 2

2 1 4 5

3 1 6

2 1 3 100

1 2 5 6

3 1 4
```

### 输出

```
51

12

33

26

132
```



---

---
title: "[ABC258Ex] Odd Steps"
layout: "post"
diff: 省选/NOI-
pid: AT_abc258_h
tag: []
---

# [ABC258Ex] Odd Steps

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc258/tasks/abc258_h

以下の条件を全て満たす数列 $ X $ の総数を $ 998244353 $ で割った余りを求めてください。

- $ X $ の全ての項は正の**奇数**である。
- $ X $ の各項の総和は $ S $ に等しい。
- $ X $ の累積和には $ A_1,\ \dots,\ A_N $ のいずれも現れない。厳密には、各 $ i\ \,\ (1\ \leq\ i\ \leq\ |X|) $ に対して $ Y_i\ =\ X_1\ +\ \dots\ +\ X_i $ と定めたとき、$ 1\ \leq\ i\ \leq\ |X|,\ 1\ \leq\ j\ \leq\ N $ を満たす全ての整数 $ i,\ j $ に対して $ Y_i\ \neq\ A_j $ が成り立つ。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ S $ $ A_1 $ $ \ldots $ $ A_N $

## 输出格式

答えを出力せよ。

## 说明/提示

### 制約

- $ 1\ \leq\ N\ \leq\ 10^5 $
- $ 1\ \leq\ A_1\ \lt\ A_2\ \lt\ \dots\ \lt\ A_N\ \lt\ S\ \leq\ 10^{18} $
- 入力は全て整数

### Sample Explanation 1

以下の $ 3 $ 通りが条件を満たします。 - $ (1,\ 5,\ 1) $ - $ (3,\ 3,\ 1) $ - $ (7) $

## 样例 #1

### 输入

```
3 7

2 4 5
```

### 输出

```
3
```

## 样例 #2

### 输入

```
5 60

10 20 30 40 50
```

### 输出

```
37634180
```

## 样例 #3

### 输入

```
10 1000000000000000000

1 2 4 8 16 32 64 128 256 512
```

### 输出

```
75326268
```



---

---
title: "[ABC259G] Grid Card Game"
layout: "post"
diff: 省选/NOI-
pid: AT_abc259_g
tag: []
---

# [ABC259G] Grid Card Game

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc259/tasks/abc259_g

$ H\ \times\ W $ 枚のカードが $ H $ 行 $ W $ 列のグリッド上に並んでいます。 $ 1\ \leq\ i\ \leq\ H,\ 1\ \leq\ j\ \leq\ W $ を満たす整数の組 $ (i,\ j) $ について、$ i $ 行目 $ j $ 列目にあるカードには整数 $ A_{i,\ j} $ が書かれています。

高橋君と青木君が $ 2 $ 人で協力ゲームをします。具体的には、下記の手順を行います。

- まず、高橋君が $ H $ 個の行のうちいくつか（ $ 0 $ 行でも $ H $ 行すべてでも良い）を選び、選んだ行にあるそれぞれのカードの上に赤いトークンを $ 1 $ 個ずつ置きます。
- 続いて、青木君が $ W $ 個の列のうちいくつか（ $ 0 $ 列でも $ W $ 列すべてでも良い）を選び、選んだ列にあるそれぞれのカードの上に青いトークンを $ 1 $ 個ずつ置きます。
- その後、$ 2 $ 人は以下の通りに得点を計算します。
  - もし、負の整数が書かれたカードであって上に赤いトークンと青いトークンがともに置かれているものが $ 1 $ 枚でも存在するならば、ゲームの結果は「大失敗」となり、得点は $ -10^{100} $ 点です。
  - そうでない場合、$ 2 $ 人は上にトークンが $ 1 $ 個以上置かれているカードをすべて獲得します。獲得したカードに書かれた整数の合計が得点です。

得点としてあり得る最大値を求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ H $ $ W $ $ A_{1,\ 1} $ $ A_{1,\ 2} $ $ \ldots $ $ A_{1,\ W} $ $ A_{2,\ 1} $ $ A_{2,\ 2} $ $ \ldots $ $ A_{2,\ W} $ $ \vdots $ $ A_{H,\ 1} $ $ A_{H,\ 2} $ $ \ldots $ $ A_{H,\ W} $

## 输出格式

答えを出力せよ。

## 说明/提示

### 制約

- $ 1\ \leq\ H,\ W\ \leq\ 100 $
- $ -10^9\ \leq\ A_{i,\ j}\ \leq\ 10^9 $
- 入力はすべて整数

### Sample Explanation 1

高橋君が $ 2 $ 行目のみを選び青木君が $ 3 $ 列目のみを選ぶとき、 $ 2 $ 人は $ 4 $ 枚のカードを獲得し、得点は $ 6\ +\ (-2)\ +\ 1\ +\ 4\ =\ 9 $ 点となります。 これが考えられる最大値です。

## 样例 #1

### 输入

```
2 3

-9 5 1

6 -2 4
```

### 输出

```
9
```

## 样例 #2

### 输入

```
15 20

-14 74 -48 38 -51 43 5 37 -39 -29 80 -44 -55 59 17 89 -37 -68 38 -16

14 31 43 -73 49 -7 -65 13 -40 -45 36 88 -54 -43 99 87 -94 57 -22 31

-85 67 -46 23 95 68 55 17 -56 51 -38 64 32 -19 65 -62 76 66 -53 -16

35 -78 -41 35 -51 -85 24 -22 45 -53 82 -30 39 19 -52 -3 -11 -67 -33 71

-75 45 -80 -42 -31 94 59 -58 39 -26 -94 -60 98 -1 21 25 0 -86 37 4

-41 66 -53 -55 55 98 23 33 -3 -27 7 -53 -64 68 -33 -8 -99 -15 50 40

66 53 -65 5 -49 81 45 1 33 19 0 20 -46 -82 14 -15 -13 -65 68 -65

50 -66 63 -71 84 51 -91 45 100 76 -7 -55 45 -72 18 40 -42 73 69 -36

59 -65 -30 89 -10 43 7 72 93 -70 23 86 81 16 25 -63 73 16 34 -62

22 -88 27 -69 82 -54 -92 32 -72 -95 28 -25 28 -55 97 87 91 17 21 -95

62 39 -65 -16 -84 51 62 -44 -60 -70 8 69 -7 74 79 -12 62 -86 6 -60

-72 -6 -79 -28 39 -42 -80 -17 -95 -28 -66 66 36 86 -68 91 -23 70 58 2

-19 -20 77 0 65 -94 -30 76 55 57 -8 59 -43 -6 -15 -83 8 29 16 34

79 40 86 -92 88 -70 -94 -21 50 -3 -42 -35 -79 91 96 -87 -93 -6 46 27

-94 -49 71 37 91 47 97 1 21 32 -100 -4 -78 -47 -36 -84 -61 86 -51 -9
```

### 输出

```
1743
```



---

---
title: "[ABC259Ex] Yet Another Path Counting"
layout: "post"
diff: 省选/NOI-
pid: AT_abc259_h
tag: []
---

# [ABC259Ex] Yet Another Path Counting

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc259/tasks/abc259_h

縦 $ N $ 行横 $ N $ 列のマス目があり、上から $ i $ 行目、左から $ j $ 列目のマスには整数のラベル $ a_{i,j} $ が付けられています。  
 いずれかのマスから始めて**右または下**に隣接するマスへの移動を $ 0 $ 回以上繰り返すことで得られる経路のうち、始点と終点のラベルが同じものの個数を $ 998244353 $ で割った余りを求めてください。  
 なお、$ 2 $ つの経路は通ったマス(始点・終点含む)の集合が異なる場合に区別します。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ a_{1,1} $ $ \ldots $ $ a_{1,N} $ $ \vdots $ $ a_{N,1} $ $ \ldots $ $ a_{N,N} $

## 输出格式

答えを出力せよ。

## 说明/提示

### 制約

- $ 1\ \leq\ N\ \leq\ 400 $
- $ 1\ \leq\ a_{i,j}\ \leq\ N^2 $
- 入力はすべて整数

### Sample Explanation 1

条件を満たす経路は以下の $ 6 $ 個です。(上から $ i $ 行目、左から $ j $ 列目のマスを $ (i,j) $ として、各経路で通るマスを順に示しています) - $ (1,1) $ - $ (1,1) $ → $ (1,2) $ → $ (2,2) $ - $ (1,1) $ → $ (2,1) $ → $ (2,2) $ - $ (1,2) $ - $ (2,1) $ - $ (2,2) $

## 样例 #1

### 输入

```
2

1 3

3 1
```

### 输出

```
6
```



---

---
title: "[ABC261G] Replace"
layout: "post"
diff: 省选/NOI-
pid: AT_abc261_g
tag: []
---

# [ABC261G] Replace

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc261/tasks/abc261_g

英小文字のみからなる $ 2 $ つの文字列 $ S,T $ が与えられます。

高橋君は文字列 $ S $ から始めて、 次の $ K $ 種類の操作のうち $ 1 $ つを選んで行う事を 好きなだけ繰り返す事ができます。  
 $ i $ 番目の操作は次の形で与えられます。

> コストを $ 1 $ 支払う。 その後、文字列中に**文字** $ C_i $ が含まれるとき、そのうちの $ 1 $ つを選び、**文字列** $ A_i $ に置き換える。 含まれないならば何も行わない。

文字列を $ T $ と一致させるために必要な最小コストを求めてください。 ただし、$ T $ と一致させることが不可能な場合は $ -1 $ を出力してください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ S $ $ T $ $ K $ $ C_1 $ $ A_1 $ $ C_2 $ $ A_2 $ $ \vdots $ $ C_K $ $ A_K $

## 输出格式

$ S $ を $ T $ と一致させるために必要な最小コストを出力せよ。 ただし、$ T $ と一致させることが不可能な場合は $ -1 $ を出力せよ。

## 说明/提示

### 制約

- $ 1\leq\ |S|\leq\ |T|\leq\ 50 $
- $ 1\leq\ K\leq\ 50 $
- $ C_i $ は `a`, `b`,$ \ldots $, `z` のいずれか
- $ 1\leq\ |A_i|\leq\ 50 $
- $ S,T,A_i $ は英小文字のみからなる文字列
- $ C_i $ を長さ $ 1 $ の文字列としてみた時、$ C_i\neq\ A_i $
- $ (C_i,A_i) $ はすべて異なる。

### Sample Explanation 1

高橋君は $ S= $`ab` から始めて、次のように $ 4 $ 回操作を行う事で、 $ T= $`cbca` を作ることができます。 - `ab` の $ 1 $ 文字目 `a` を選んで `b` に置き換える ( $ 1 $ 番目の操作) 。文字列は `bb` となる。 - `bb` の $ 2 $ 文字目 `b` を選んで `ca` に置き換える ( $ 2 $ 番目の操作) 。文字列は `bca` となる。 - `bca` の $ 1 $ 文字目 `b` を選んで `ca` に置き換える ( $ 2 $ 番目の操作) 。文字列は `caca` となる。 - `caca` の $ 2 $ 文字目 `a` を選んで `b` に置き換える ( $ 1 $ 番目の操作) 。文字列は `cbca` となる。 各操作においてコストが $ 1 $ かかるため、必要なコストは $ 4 $ となり、このときが最小です。

### Sample Explanation 2

`a`$ \to $`aaa`$ \to $`aaaaa` とした時、必要なコストは $ 2 $ となり、 このときが最小です。

### Sample Explanation 3

どのように操作を行っても、$ S= $`a` から $ T= $`z` を作る事は出来ません。

## 样例 #1

### 输入

```
ab

cbca

3

a b

b ca

a efg
```

### 输出

```
4
```

## 样例 #2

### 输入

```
a

aaaaa

2

a aa

a aaa
```

### 输出

```
2
```

## 样例 #3

### 输入

```
a

z

1

a abc
```

### 输出

```
-1
```



---

---
title: "[ABC261Ex] Game on Graph"
layout: "post"
diff: 省选/NOI-
pid: AT_abc261_h
tag: []
---

# [ABC261Ex] Game on Graph

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc261/tasks/abc261_h

$ N $ 頂点 $ M $ 辺の有向グラフがあります。辺 $ i $ は頂点 $ A_i $ から $ B_i $ への有向辺で、重みが $ C_i $ です。

最初、頂点 $ v $ に駒が置かれています。高橋君と青木君が交互に次のように駒を動かすゲームを行います。

- 駒が置かれている頂点から出る辺が存在しないとき、ゲームを終了する。
- 駒が置かれている頂点から出る辺が存在するとき、そのうちいずれかの辺を選び、選んだ辺に沿って駒を移動する。

ゲームは高橋君から始め、高橋君はゲームが終了するまでに通った辺の重みの和を小さくしようとし、青木君は大きくしようとします。  
 $ 2 $ 人が目指すものはより厳密には、次の通りです。  
 高橋君は、ゲームを有限回の操作で終了させることを最優先し、それが可能ならば、ゲームが終了するまでに通る辺の重みの和を小さくしようとします。  
 青木君は、ゲームを有限回の操作で終了させないことを最優先し、それが不可能ならば、ゲームが終了するまでに通る辺の重みの和を大きくしようとします。  
 （駒が同じ辺を複数回通った場合は、重みはその回数だけ加算されるものとします。）

$ 2 $ 人が最善を尽くしたときゲームが有限回の操作で終了するか判定し、終了するならば、ゲームが終了するまでに通る辺の重みの和を求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ M $ $ v $ $ A_1 $ $ B_1 $ $ C_1 $ $ A_2 $ $ B_2 $ $ C_2 $ $ \vdots $ $ A_M $ $ B_M $ $ C_M $

## 输出格式

$ 2 $ 人が最善を尽くしたとき、ゲームが有限回の操作で終了しないならば `INFINITY` と出力せよ。  
 有限回の操作で終了するならば、ゲームが終了するまでに通る辺の重みの和を出力せよ。

## 说明/提示

### 制約

- $ 1\ \leq\ N\ \leq\ 2\times\ 10^5 $
- $ 0\ \leq\ M\ \leq\ 2\times\ 10^5 $
- $ 1\ \leq\ v\ \leq\ N $
- $ 1\ \leq\ A_i,B_i\ \leq\ N $
- 多重辺は存在しない。すなわち $ i\neq\ j $ のとき $ (A_i,B_i)\neq(A_j,B_j) $
- 自己辺は存在しない。すなわち $ A_i\neq\ B_i $
- $ 0\ \leq\ C_i\ \leq\ 10^9 $
- 入力に含まれる値は全て整数

### Sample Explanation 1

まず高橋君は頂点 $ 3 $ に駒を動かし、次に青木君が頂点 $ 7 $ に駒を動かし、ゲームが終了します。 ゲームが終了するまでに通る辺の重みの和は $ 10+30=40 $ になります。

### Sample Explanation 2

有限回の操作でゲームは終了しません。

### Sample Explanation 3

$ 1\to\ 2\ \to\ 3\ \to\ 1\ \to\ 2\to\ 4 $ と駒は動かされます。

## 样例 #1

### 输入

```
7 6 1

1 2 1

1 3 10

2 4 100

2 5 102

3 6 20

3 7 30
```

### 输出

```
40
```

## 样例 #2

### 输入

```
3 6 3

1 2 1

2 1 2

2 3 3

3 2 4

3 1 5

1 3 6
```

### 输出

```
INFINITY
```

## 样例 #3

### 输入

```
4 4 1

1 2 1

2 3 1

3 1 1

2 4 1
```

### 输出

```
5
```



---

---
title: "[ABC264Ex] Perfect Binary Tree"
layout: "post"
diff: 省选/NOI-
pid: AT_abc264_h
tag: []
---

# [ABC264Ex] Perfect Binary Tree

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc264/tasks/abc264_h

頂点に $ 1,2,\dots,N $ の番号が付いた、 $ N $ 頂点の根付き木があります。  
 根は頂点 $ 1 $ であり、頂点 $ i\ \ge\ 2 $ について、その親は $ P_i(\ <\ i) $ です。  
 整数 $ k=1,2,\dots,N $ に対し次の問題を解いてください。

番号が $ 1 $ 以上 $ k $ 以下の頂点を、頂点 $ 1 $ を含むようにいくつか選ぶ方法は $ 2^{k-1} $ 通りあります。  
 そのうち、選ばれた頂点集合から誘導される部分グラフの形状が頂点 $ 1 $ を根とする (頂点数がある正整数 $ d $ を用いて $ 2^d-1 $ と表せるような) 完全二分木になるような頂点の選び方はいくつですか?  
 答えは非常に大きくなる場合があるので、$ 998244353 $ で割った余りを求めてください。

 誘導される部分グラフとは?

あるグラフ $ G $ から、一部の頂点を選んだ集合を $ S $ とします。この頂点集合 $ S $ から誘導される部分グラフ $ H $ は以下のように構成されます。

- $ H $ の頂点集合は $ S $ と一致させます。
- その後、 $ H $ に以下のように辺を追加します。
- $ i,j\ \in\ S,\ i\ を満たす全ての頂点対\ (i,j) $ について、 $ G $ 中に $ i,j $ を結ぶ辺が存在すれば、 $ H $ にも $ i,j $ を結ぶ辺を追加する。
 

完全二分木とは? 完全二分木とは、以下の全ての条件を満たす根付き木です。 - 葉以外の全ての頂点が、ちょうど $ 2 $ つの子を持つ。
- 全ての葉が根から等距離にある。
 
 ただし、頂点が $ 1 $ つで辺が $ 0 $ 本のグラフも完全二分木であるものとします。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ P_2 $ $ P_3 $ $ \dots $ $ P_N $

## 输出格式

$ N $ 行出力せよ。 そのうち $ i $ ( $ 1\ \le\ i\ \le\ N $ ) 行目には $ k=i $ についての答えを整数として出力せよ。

## 说明/提示

### 制約

- 入力は全て整数
- $ 1\ \le\ N\ \le\ 3\ \times\ 10^5 $
- $ 1\ \le\ P_i\ <\ i $

### Sample Explanation 1

\- $ k\ \ge\ 1 $ であるとき $ \{1\} $ - $ k\ \ge\ 3 $ であるとき $ \{1,2,3\} $ - $ k\ \ge\ 5 $ であるとき $ \{1,2,5\},\{1,3,5\} $ - $ k\ \ge\ 8 $ であるとき $ \{1,2,4,5,6,7,8\} $ - $ k\ \ge\ 9 $ であるとき $ \{1,2,4,5,6,7,9\},\{1,2,4,5,6,8,9\} $ - $ k\ =\ 10 $ であるとき $ \{1,2,10\},\{1,3,10\},\{1,5,10\} $ が数えるべき頂点の選び方となります。

### Sample Explanation 2

$ N=1 $ である場合、入力の $ 2 $ 行目は空行です。

## 样例 #1

### 输入

```
10

1 1 2 1 2 5 5 5 1
```

### 输出

```
1

1

2

2

4

4

4

5

7

10
```

## 样例 #2

### 输入

```
1
```

### 输出

```
1
```

## 样例 #3

### 输入

```
10

1 2 3 4 5 6 7 8 9
```

### 输出

```
1

1

1

1

1

1

1

1

1

1
```

## 样例 #4

### 输入

```
13

1 1 1 2 2 2 3 3 3 4 4 4
```

### 输出

```
1

1

2

4

4

4

4

4

7

13

13

19

31
```



---

---
title: "[ABC266Ex] Snuke Panic (2D)"
layout: "post"
diff: 省选/NOI-
pid: AT_abc266_h
tag: []
---

# [ABC266Ex] Snuke Panic (2D)

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc266/tasks/abc266_h

高橋君はすぬけ君たちを捕まえようとしています。

$ 2 $ 次元座標平面上にいくつか穴があいており、すぬけ君たちの巣につながっています。

これから $ N $ 匹のすぬけ君が穴から出てきます。$ i $ 番目のすぬけ君は時刻 $ T_i $ に座標 $ (X_i,Y_i) $ の穴から出てきて、大きさは $ A_i $ であることがわかっています。

高橋君は時刻 $ 0 $ に座標 $ (0,0) $ におり、以下の $ 2 $ 種類の移動ができます。

- $ x $ 軸方向に単位時間あたり $ 1 $ 以下の速さで移動する
- $ y $ 軸**正**方向に単位時間あたり $ 1 $ 以下の速さで移動する

$ y $ 軸負方向に移動することはできません。

すぬけ君が穴から出てきたのと同じ時刻に同じ座標に高橋君がいるとき、かつ、そのときに限り、高橋君はすぬけ君を捕まえることができます。  
すぬけ君を捕まえるのにかかる時間は無視できます。

高橋君が適切に行動したとき、捕まえることができるすぬけ君の大きさの合計の最大値を求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ T_1 $ $ X_1 $ $ Y_1 $ $ A_1 $ $ T_2 $ $ X_2 $ $ Y_2 $ $ A_2 $ $ \vdots $ $ T_N $ $ X_N $ $ Y_N $ $ A_N $

## 输出格式

答えを整数として出力せよ。

## 说明/提示

### 制約

- $ 1\ \leq\ N\ \leq\ 10^5 $
- $ 1\ \leq\ T_i\ \leq\ 10^9 $
- $ 0\ \leq\ X_i,Y_i\ \leq\ 10^9 $
- $ 1\ \leq\ A_i\ \leq\ 10^9 $
- $ (T_i,X_i,Y_i) $ は相異なる
- 入力に含まれる値は全て整数である

### Sample Explanation 1

\- 座標 $ (0,0) $ で待機し、時刻 $ 1 $ に $ 1 $ 番目のすぬけ君を捕まえる - 座標 $ (3,1) $ へ移動し、時刻 $ 5 $ に $ 3 $ 番目のすぬけ君を捕まえる $ 1 $ 番目と $ 2 $ 番目のすぬけ君を両方とも捕まえることはできないので、これが最大です。

### Sample Explanation 2

$ y $ 軸負方向には移動できないため、$ 1 $ 番目のすぬけ君を捕まえた後、$ 2 $ 番目のすぬけ君を捕まえることはできません。

## 样例 #1

### 输入

```
3
1 0 0 100
3 2 1 10
5 3 1 1
```

### 输出

```
101
```

## 样例 #2

### 输入

```
2
100 0 1 1
200 1 0 10
```

### 输出

```
10
```

## 样例 #3

### 输入

```
10
797829355 595605750 185676190 353195922
913575467 388876063 395940406 533206504
810900084 201398242 159760440 87027328
889089200 220046203 85488350 325976483
277429832 161055688 73308100 940778720
927999455 429014248 477195779 174616807
673419335 415891345 81019893 286986530
989248231 147792453 417536200 219371588
909664305 22150727 414107912 317441890
988670052 140275628 468278658 67181740
```

### 输出

```
1553741733
```



---

---
title: "[ABC267G] Increasing K Times"
layout: "post"
diff: 省选/NOI-
pid: AT_abc267_g
tag: []
---

# [ABC267G] Increasing K Times

## 题目描述

给定一个正整数序列 $A=(a_1,a_2,\ldots,a_n)$，问有多少个 $1\sim n$ 的排列 $P=(p_1,p_2,\ldots,p_n)$ 满足：

- 存在恰好 $k$ 个整数 $i(1\leqslant i\leqslant n-1)$ 满足 $a_{p_i}<a_{p_{i+1}}$

对 $998244353$ 取模。

## 输入格式

第一行两个整数 $n,k$，含义如题意所示。

第二行 $n$ 个整数，第 $i$ 个整数表示 $a_i$。

## 输出格式

输出一个整数，表示满足条件的排列 $P$ 个数。

## 说明/提示

$2\leqslant n\leqslant 5000,0\leqslant k\leqslant n-1,1\leqslant a_i\leqslant n$

**样例解释**

只有四个排列 $P$ 满足条件，分别是 $(1,3,2,4),(1,4,2,3),(2,3,1,4),(2,4,1,3)$。

## 样例 #1

### 输入

```
4 2

1 1 2 2
```

### 输出

```
4
```

## 样例 #2

### 输入

```
10 3

3 1 4 1 5 9 2 6 5 3
```

### 输出

```
697112
```



---

---
title: "[ABC267Ex] Odd Sum"
layout: "post"
diff: 省选/NOI-
pid: AT_abc267_h
tag: []
---

# [ABC267Ex] Odd Sum

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc267/tasks/abc267_h

長さ $ N $ の整数列 $ A=(A_1,A_2,\dots,A_N) $ が与えられます。

$ A $ から要素を奇数個選ぶ方法のうち、選んだ要素の総和が $ M $ になるものの個数を $ 998244353 $ で割ったあまりを求めてください。

ただし、$ 2 $ つの選び方が異なるとは、ある整数 $ i\ (1\ \le\ i\ \le\ N) $ が存在して、一方の選び方では $ A_i $ を選び、もう一方では選んでいないことを言います。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ M $ $ A_1 $ $ A_2 $ $ \dots $ $ A_N $

## 输出格式

答えを出力せよ。

## 说明/提示

### 制約

- $ 1\ \le\ N\ \le\ 10^5 $
- $ 1\ \le\ M\ \le\ 10^6 $
- $ 1\ \le\ A_i\ \le\ 10 $
- 入力は全て整数。

### Sample Explanation 1

条件を満たす選び方は以下の $ 3 $ 通りです。 - $ A_1,A_2,A_3 $ を選ぶ。 - $ A_1,A_2,A_4 $ を選ぶ。 - $ A_5 $ を選ぶ。 $ A_3,A_4 $ を選んだ場合、総和は $ 6 $ ですが選んだ要素の個数が奇数個でないため条件を満たしません。

## 样例 #1

### 输入

```
5 6

1 2 3 3 6
```

### 输出

```
3
```

## 样例 #2

### 输入

```
10 23

1 2 3 4 5 6 7 8 9 10
```

### 输出

```
18
```



---

---
title: "[ABC268Ex] Taboo"
layout: "post"
diff: 省选/NOI-
pid: AT_abc268_h
tag: []
---

# [ABC268Ex] Taboo

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc268/tasks/abc268_h

文字列 $ S $ が与えられます。また、高橋君は次の操作を $ 0 $ 回以上行うことが出来ます。

- $ 1\ \leq\ i\ \leq\ |S| $ なる整数 $ i $ を選び、$ S $ の $ i $ 文字目を `*` に変える。

高橋君の目的は、$ S $ の**部分文字列として** $ N $ 個の文字列 $ T_1,T_2,\ldots,T_N $ がいずれも現れないようにすることです。  
 これを達成するために必要な操作の回数の最小値を求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ S $ $ N $ $ T_1 $ $ T_2 $ $ \vdots $ $ T_N $

## 输出格式

答えを出力せよ。

## 说明/提示

### 制約

- $ 1\ \leq\ |S|\ \leq\ 5\ \times\ 10^5 $
- $ 1\ \leq\ N $
- $ N $ は整数
- $ 1\ \leq\ |T_i| $
- $ \sum{|T_i|}\ \leq\ 5\ \times\ 10^5 $
- $ i\ \neq\ j $ ならば $ T_i\ \neq\ T_j $
- $ S,\ T_i $ は英小文字のみからなる文字列

### Sample Explanation 1

$ i $ として $ 1 $ と $ 9 $ を選んで操作をすると $ S $ は `\*bcdefgh\*jklmn` となり、`abcd`、`ijk`、`ghi` がいずれも部分文字列として現れなくなります。

### Sample Explanation 2

操作をする必要がありません。

## 样例 #1

### 输入

```
abcdefghijklmn

3

abcd

ijk

ghi
```

### 输出

```
2
```

## 样例 #2

### 输入

```
atcoderbeginnercontest

1

abc
```

### 输出

```
0
```

## 样例 #3

### 输入

```
aaaaaaaaa

2

aa

xyz
```

### 输出

```
4
```



---

---
title: "[ABC269G] Reversible Cards 2"
layout: "post"
diff: 省选/NOI-
pid: AT_abc269_g
tag: []
---

# [ABC269G] Reversible Cards 2

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc269/tasks/abc269_g

$ 1 $ から $ N $ までの番号がついた $ N $ 枚のカードがあります。  
 カード $ i $ の表には整数 $ A_i $, 裏には整数 $ B_i $ が書いてあります。 また、$ \sum_{i=1}^N\ (A_i\ +\ B_i)\ =\ M $ です。  
 $ k=0,1,2,...,M $ について次の問題を解いてください。

> $ N $ 枚のカードがすべて表側が見える状態で並べられています。あなたは $ 0 $ 枚以上 $ N $ 枚以下のカードを選び、それらを裏返すことができます。  
>  見えている数の和が $ k $ になるには最小で何枚のカードを裏返す必要がありますか？枚数を出力してください。  
>  ただし、どのようにカードを裏返しても見えている数の和が $ k $ にならない場合は $ -1 $ を出力してください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ M $ $ A_1 $ $ B_1 $ $ A_2 $ $ B_2 $ $ \vdots $ $ A_N $ $ B_N $

## 输出格式

$ M+1 $ 行出力せよ。$ i $ 行目には $ k=i-1 $ のときの答えを出力せよ。

## 说明/提示

### 制約

- $ 1\ \leq\ N\ \leq\ 2\ \times\ 10^5 $
- $ 0\ \leq\ M\ \leq\ 2\ \times\ 10^5 $
- $ 0\ \leq\ A_i,\ B_i\ \leq\ M $
- $ \sum_{i=1}^N\ (A_i\ +\ B_i)\ =\ M $
- 入力される値はすべて整数

### Sample Explanation 1

例えば $ k=0 $ のときは、カード $ 2 $ のみを裏返せば見えている数の和を $ 0+0+0=0 $ にすることができて、これが最適です。 また、$ k=5 $ のときは、すべてのカードを裏返せば見えている数の和を $ 2+0+3=5 $ にすることができて、これが最適です。

## 样例 #1

### 输入

```
3 6

0 2

1 0

0 3
```

### 输出

```
1

0

2

1

1

3

2
```

## 样例 #2

### 输入

```
2 3

1 1

0 1
```

### 输出

```
-1

0

1

-1
```

## 样例 #3

### 输入

```
5 12

0 1

0 3

1 0

0 5

0 2
```

### 输出

```
1

0

1

1

1

2

1

2

2

2

3

3

4
```



---

---
title: "[ABC270Ex] add 1"
layout: "post"
diff: 省选/NOI-
pid: AT_abc270_h
tag: []
---

# [ABC270Ex] add 1

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc270/tasks/abc270_h

$ A_1=0 $ かつ $ A_N\ >\ 0 $ であるような、$ N $ 個の非負整数の組 $ A=(A_1,A_2,\ldots,A_N) $ が与えられます。

高橋君は $ N $ 個のカウンターを持っており、最初、全てのカウンターの値は $ 0 $ です。  
高橋君は、全ての $ 1\leq\ i\leq\ N $ について $ i $ 番目のカウンターの値が $ A_i $ 以上となるまで次の操作を繰り返します。

> $ N $ 個のカウンターの中から $ 1 $ つを等確率に選び、その値を $ 0 $ にする。（選択は毎回独立に行う。）  
> 選んだカウンター **以外** のカウンターの値を $ 1 $ 増加させる。

高橋君の操作回数の期待値を $ \mathrm{mod} $ $ 998244353 $ で出力してください（注記参照）。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ A_1 $ $ A_2 $ $ \ldots $ $ A_N $

## 输出格式

高橋君の操作回数の期待値を $ \mathrm{mod} $ $ 998244353 $ で出力せよ。

## 说明/提示

### 注記

求める期待値は必ず有限値かつ有理数となることが証明できます。また、この問題の制約下では、その値を互いに素な $ 2 $ つの整数 $ P $, $ Q $ を用いて $ \frac{P}{Q} $ と表したとき、$ R\ \times\ Q\ \equiv\ P\pmod{998244353} $ かつ $ 0\ \leq\ R\ \lt\ 998244353 $ を満たす整数 $ R $ がただ一つ存在することが証明できます。この $ R $ を求めてください。

### 制約

- $ 2\leq\ N\leq\ 2\times\ 10^5 $
- $ 0=A_1\leq\ A_2\leq\ \cdots\ \leq\ A_N\leq\ 10^{18} $
- $ A_N\ >\ 0 $
- 入力は全て整数

### Sample Explanation 1

$ i $ 番目のカウンターの値を $ C_i $ で表します。 高橋君の操作が終了するまでの一連の流れの例は次の通りです。 - $ 1 $ 番目のカウンターの値を $ 0 $ にした後、それ以外のカウンターの値を $ 1 $ 増加させる。 $ (C_1,C_2)=(0,1) $ となる。 - $ 2 $ 番目のカウンターの値を $ 0 $ にした後、それ以外のカウンターの値を $ 1 $ 増加させる。 $ (C_1,C_2)=(1,0) $ となる。 - $ 1 $ 番目のカウンターの値を $ 0 $ にした後、それ以外のカウンターの値を $ 1 $ 増加させる。 $ (C_1,C_2)=(0,1) $ となる。 - $ 1 $ 番目のカウンターの値を $ 0 $ にした後、それ以外のカウンターの値を $ 1 $ 増加させる。 $ (C_1,C_2)=(0,2) $ となる。 この場合の操作回数は $ 4 $ となります。 $ 1,2,3,4,5,\ldots $ 回で操作が終了する確率はそれぞれ $ 0,\frac{1}{4},\ \frac{1}{8},\ \frac{1}{8},\ \frac{3}{32},\ldots $ であり、 期待値は $ 2\times\frac{1}{4}+3\times\frac{1}{8}+4\times\frac{1}{8}+5\times\frac{3}{32}+\dots=6 $ となります。 よって、 $ 6 $ を出力します。

## 样例 #1

### 输入

```
2
0 2
```

### 输出

```
6
```

## 样例 #2

### 输入

```
5
0 1 3 10 1000000000000000000
```

### 输出

```
874839568
```



---

---
title: "[ABC272F] Two Strings"
layout: "post"
diff: 省选/NOI-
pid: AT_abc272_f
tag: []
---

# [ABC272F] Two Strings

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc272/tasks/abc272_f

長さ $ N $ の英小文字からなる文字列 $ S,T $ が与えられます。

文字列 $ X $ と整数 $ i $ に対し、$ f(X,i) $ を $ X $ に対して以下の操作を $ i $ 回行い得られる文字列とします。

- $ X $ の先頭の文字を削除し、同じ文字を $ X $ の末尾に挿入する。

$ 0\ \le\ i,j\ \le\ N-1 $ を満たす非負整数の組 $ (i,j) $ のうち、辞書順で $ f(S,i) $ が $ f(T,j) $ より小さいか同じであるものの個数を求めてください。

 辞書順とは？ 辞書順とは簡単に説明すると「単語が辞書に載っている順番」を意味します。より厳密な説明として、英小文字からなる相異なる文字列 $ S,\ T $ の大小を判定するアルゴリズムを以下に説明します。

以下では「 $ S $ の $ i $ 文字目の文字」を $ S_i $ のように表します。また、 $ S $ が $ T $ より辞書順で小さい場合は $ S\ \lt\ T $ 、大きい場合は $ S\ \gt\ T $ と表します。

1. $ S,\ T $ のうち長さが大きくない方の文字列の長さを $ L $ とします。$ i=1,2,\dots,L $ に対して $ S_i $ と $ T_i $ が一致するか調べます。
2. $ S_i\ \neq\ T_i $ である $ i $ が存在する場合、そのような $ i $ のうち最小のものを $ j $ とします。そして、$ S_j $ と $ T_j $ を比較して、$ S_j $ が $ T_j $ よりアルファベット順で小さい場合は $ S\ \lt\ T $ 、そうでない場合は $ S\ \gt\ T $ と決定して、アルゴリズムを終了します。
3. $ S_i\ \neq\ T_i $ である $ i $ が存在しない場合、$ S $ と $ T $ の長さを比較して、$ S $ が $ T $ より短い場合は $ S\ \lt\ T $ 、長い場合は $ S\ \gt\ T $ と決定して、アルゴリズムを終了します。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ S $ $ T $

## 输出格式

答えを出力せよ。

## 说明/提示

### 制約

- $ 1\ \le\ N\ \le\ 2\ \times\ 10^5 $
- $ S,T $ は英小文字からなる長さ $ N $ の文字列
- $ N $ は整数

### Sample Explanation 1

条件を満たす $ (i,j) $ の組は $ (0,0),(0,2),(2,0),(2,2) $ の $ 4 $ 個があります。 $ (i,j)=(1,2) $ は、$ f(S,i)= $`dba`$ ,f(T,j)= $`bca` であるため条件を満たしません。

## 样例 #1

### 输入

```
3

adb

cab
```

### 输出

```
4
```

## 样例 #2

### 输入

```
10

wsiuhwijsl

pwqoketvun
```

### 输出

```
56
```



---

---
title: "[ABC275G] Infinite Knapsack"
layout: "post"
diff: 省选/NOI-
pid: AT_abc275_g
tag: []
---

# [ABC275G] Infinite Knapsack

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc275/tasks/abc275_g

$ N $ 種類の品物がそれぞれ無限個あります。 $ i $ 種類目の品物は重さが $ A_i $ 、体積が $ B_i $ 、価値が $ C_i $ です。

レベル $ X $ の高橋君は、重さの合計が $ X $ 以下かつ体積の合計が $ X $ 以下になるように品物を持つことができます。ここで、高橋君は条件を満たすならば同じ種類の品物を何個でも持つことが可能であり、また選ばない種類の品物があっても構いません。

レベル $ X $ の高橋君が持てる品物の価値の合計の最大値を $ f(X) $ とするとき、極限 $ \displaystyle\lim_{X\to\ \infty}\ \frac{f(X)}{X} $ が存在することが証明できます。この値を求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ A_1 $ $ B_1 $ $ C_1 $ $ A_2 $ $ B_2 $ $ C_2 $ $ \vdots $ $ A_N $ $ B_N $ $ C_N $

## 输出格式

答えを出力せよ。なお、想定解答との絶対誤差または相対誤差が $ 10^{-6} $ 以下であれば正解として扱われる。

## 说明/提示

### 制約

- $ 1\leq\ N\leq\ 2\times\ 10^5 $
- $ 10^8\leq\ A_i,B_i,C_i\ \leq\ 10^9 $
- 入力は全て整数

### Sample Explanation 1

$ X=300000000 $ のとき、高橋君は重さの合計が $ 300000000 $ 以下かつ体積の合計が $ 300000000 $ 以下になるように品物を持つことができます。 持ち方の一例として、高橋君は $ 1 $ 番目の品物と $ 2 $ 番目の品物を $ 1 $ 個ずつ持つことができます。このとき、品物の価値の合計は $ 100000000+100000000=200000000 $ であり、これが達成可能な価値の最大値なので、$ \dfrac{f(300000000)}{300000000}=\dfrac{2}{3} $ です。 また、この入力では極限 $ \displaystyle\lim_{X\to\ \infty}\ \dfrac{f(X)}{X} $ も $ \dfrac{2}{3} $ に一致することが証明できます。よって答えは $ 0.6666666... $ です。

## 样例 #1

### 输入

```
2
100000000 200000000 100000000
200000000 100000000 100000000
```

### 输出

```
0.6666666666666667
```

## 样例 #2

### 输入

```
1
500000000 300000000 123456789
```

### 输出

```
0.2469135780000000
```



---

---
title: "[ABC276G] Count Sequences"
layout: "post"
diff: 省选/NOI-
pid: AT_abc276_g
tag: []
---

# [ABC276G] Count Sequences

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc276/tasks/abc276_g

以下の条件を満たす項数 $ N $ の整数列 $ A=(a_1,a_2,\ldots,a_N) $ の個数を $ 998244353 $ で割った余りを求めてください。

- $ 0\ \leq\ a_1\ \leq\ a_2\ \leq\ \ldots\ \leq\ a_N\ \leq\ M $
- $ i=1,2,\ldots,N-1 $ それぞれについて、「$ a_i $ を $ 3 $ で割った余り」と「$ a_{i+1} $ を $ 3 $ で割った余り」が異なる

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ M $

## 输出格式

答えを出力せよ。

## 说明/提示

### 制約

- $ 2\ \leq\ N\ \leq\ 10^7 $
- $ 1\ \leq\ M\ \leq\ 10^7 $
- 入力はすべて整数

### Sample Explanation 1

以下の $ 8 $ 個が条件を満たします。 - $ (0,1,2) $ - $ (0,1,3) $ - $ (0,2,3) $ - $ (0,2,4) $ - $ (1,2,3) $ - $ (1,2,4) $ - $ (1,3,4) $ - $ (2,3,4) $

### Sample Explanation 2

個数を $ 998244353 $ で割った余りを求めてください。

## 样例 #1

### 输入

```
3 4
```

### 输出

```
8
```

## 样例 #2

### 输入

```
276 10000000
```

### 输出

```
909213205
```



---

---
title: "[ABC277F] Sorting a Matrix"
layout: "post"
diff: 省选/NOI-
pid: AT_abc277_f
tag: []
---

# [ABC277F] Sorting a Matrix

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc277/tasks/abc277_f

非負整数を要素とする $ H $ 行 $ W $ 列の行列 $ A $ が与えられます。 $ 1\ \leq\ i\ \leq\ H $ かつ $ 1\ \leq\ j\ \leq\ W $ を満たす整数の組 $ (i,\ j) $ について、 $ A $ の $ i $ 行目 $ j $ 列目の要素を $ A_{i,\ j} $ で表します。

$ A $ に対して以下の手順を行います。

- まず、$ A $ の要素のうち $ 0 $ であるものそれぞれを、任意の**正の整数**で置き換える（ $ 0 $ である要素が複数ある場合、それぞれを異なる正の整数で置き換えることもできます）。
- その後、「下記の $ 2 $ つの操作のどちらかを行うこと」を好きな回数（ $ 0 $ 回でも良い）だけ行う。
  
  
  - $ 1\ \leq\ i\ \lt\ j\ \leq\ H $ を満たす整数の組 $ (i,\ j) $ を選び、$ A $ の $ i $ 行目と $ j $ 行目を入れ替える。
  - $ 1\ \leq\ i\ \lt\ j\ \leq\ W $ を満たす整数の組 $ (i,\ j) $ を選び、$ A $ の $ i $ 列目と $ j $ 列目を入れ替える。

$ A $ が次の条件を満たすようにすることができるかどうかを判定してください。

- $ A_{1,\ 1}\ \leq\ A_{1,\ 2}\ \leq\ \cdots\ \leq\ A_{1,\ W}\ \leq\ A_{2,\ 1}\ \leq\ A_{2,\ 2}\ \leq\ \cdots\ \leq\ A_{2,\ W}\ \leq\ A_{3,\ 1}\ \leq\ \cdots\ \leq\ A_{H,\ 1}\ \leq\ A_{H,\ 2}\ \leq\ \cdots\ \leq\ A_{H,\ W} $
- 言い換えると、$ 1\ \leq\ i,\ i'\ \leq\ H $ および $ 1\ \leq\ j,\ j'\ \leq\ W $ を満たす任意の $ 2 $ つの整数の組 $ (i,\ j) $ と $ (i',\ j') $ について、下記の $ 2 $ つの条件がともに成り立つ。
  
  
  - $ i\ \lt\ i' $ ならば $ A_{i,\ j}\ \leq\ A_{i',\ j'} $
  - 「 $ i\ =\ i' $ かつ $ j\ \lt\ j' $ 」ならば $ A_{i,\ j}\ \leq\ A_{i',\ j'} $

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ H $ $ W $ $ A_{1,\ 1} $ $ A_{1,\ 2} $ $ \ldots $ $ A_{1,\ W} $ $ A_{2,\ 1} $ $ A_{2,\ 2} $ $ \ldots $ $ A_{2,\ W} $ $ \vdots $ $ A_{H,\ 1} $ $ A_{H,\ 2} $ $ \ldots $ $ A_{H,\ W} $

## 输出格式

$ A $ が問題文中の条件を満たすようにできる場合は `Yes` を、できない場合は `No` を出力せよ。

## 说明/提示

### 制約

- $ 2\ \leq\ H,\ W $
- $ H\ \times\ W\ \leq\ 10^6 $
- $ 0\ \leq\ A_{i,\ j}\ \leq\ H\ \times\ W $
- 入力はすべて整数

### Sample Explanation 1

以下の手順で操作を行うことで、$ A $ が問題文中の条件を満たすようにすることができるため、`Yes` を出力します。 - まず、$ A $ の $ 0 $ である要素を下記の通りに置き換える。 ``` 9 6 8 5 4 4 3 1 3 ``` - $ 2 $ 列目と $ 3 $ 列目を入れ替える。その結果、$ A $ は下記の通りとなる。 ``` 9 8 6 5 4 4 3 3 1 ``` - $ 1 $ 行目と $ 3 $ 行目を入れ替える。その結果、$ A $ は下記の通りとなる。 ``` 3 3 1 5 4 4 9 8 6 ``` - $ 1 $ 列目と $ 3 $ 列目を入れ替える。その結果、$ A $ は下記の通りとなり、問題文中の条件を満たすようになる。 ``` 1 3 3 4 4 5 6 8 9 ```

### Sample Explanation 2

どのように操作を行っても $ A $ が問題文中の条件を満たすようにすることはできないため、`No` を出力します。

## 样例 #1

### 输入

```
3 3
9 6 0
0 4 0
3 0 3
```

### 输出

```
Yes
```

## 样例 #2

### 输入

```
2 2
2 1
1 2
```

### 输出

```
No
```



---

---
title: "[ABC279G] At Most 2 Colors"
layout: "post"
diff: 省选/NOI-
pid: AT_abc279_g
tag: []
---

# [ABC279G] At Most 2 Colors

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc279/tasks/abc279_g

$ 1\ \times\ N $ のマス目があり、マスには左から $ 1,2,\dots,N $ の番号が付いています。

高橋君は $ C $ 色の絵の具を用意し、各マスを $ C $ 色のいずれかで塗りました。  
 すると、どの連続する $ K $ マスを見ても高々 $ 2 $ 色しか現れませんでした。  
 厳密には、 $ 1\ \le\ i\ \le\ N-K+1 $ を満たす全ての整数 $ i $ について、マス $ i,i+1,\dots,i+K-1 $ には高々 $ 2 $ 色しか現れませんでした。

高橋君の色の塗り方として考えられるものは何通りですか？  
 この数は非常に大きくなる場合があるので、 $ 998244353 $ で割った余りを求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ K $ $ C $

## 输出格式

答えを整数として出力せよ。

## 说明/提示

### 制約

- 入力は全て整数
- $ 2\ \le\ K\ \le\ N\ \le\ 10^6 $
- $ 1\ \le\ C\ \le\ 10^9 $
 
### Sample Explanation 1

この入力では、マス目は $ 1\ \times\ 3 $ です。 連続する $ 3 $ マスの中で高々 $ 2 $ 色しか現れないように塗る方法は、考えうる全ての塗り方 $ 27 $ 通りから全てのマスを異なる色で塗る $ 6 $ 通りを引いた $ 21 $ 通りです。

### Sample Explanation 2

$ C=2 $ なので、どのように塗っても連続する $ K $ マスには高々 $ 2 $ 色しか含まれません。

### Sample Explanation 3

$ 998244353 $ で割った余りを出力してください。

## 样例 #1

### 输入

```
3 3 3
```

### 输出

```
21
```

## 样例 #2

### 输入

```
10 5 2
```

### 输出

```
1024
```

## 样例 #3

### 输入

```
998 244 353
```

### 输出

```
952364159
```



---

---
title: "[ABC288G] 3^N Minesweeper"
layout: "post"
diff: 省选/NOI-
pid: AT_abc288_g
tag: []
---

# [ABC288G] 3^N Minesweeper

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc288/tasks/abc288_g

位置 $ 0,\ 1,\ 2,\ \ldots,\ 3^N-1 $ にそれぞれ $ 0 $ 個あるいは $ 1 $ 個の爆弾があります。  
 また、位置 $ x $ と位置 $ y $ は $ i=0,1,\ \ldots,\ N-1 $ すべてに対し以下の条件を満たすとき、またそのときに限り**近い位置**であるとします。

- $ x,\ y $ を $ 3 $ 進表記したときの $ 3^i $ の位の数字をそれぞれ $ x',\ y' $ として、$ |x'\ -\ y'|\ \leq\ 1 $ が成立する。
 
位置 $ i $ と近い位置にある爆弾の個数が $ A_i $ 個であるとわかっているとき、爆弾の配置としてありえるものを $ 1 $ つ出力してください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ A_0 $ $ A_1 $ $ \ldots $ $ A_{3^N-1} $

## 输出格式

位置 $ i $ に爆弾がないとき $ B_i\ =\ 0 $ 、位置 $ i $ に爆弾があるとき $ B_i\ =\ 1 $ として $ B_0,\ B_1,\ \ldots,\ B_{3^N-1} $ を空白区切りで出力せよ。

## 说明/提示

### 制約

- $ 1\ \leq\ N\ \leq\ 12 $
- $ A_0,\ A_1,\ \ldots,\ A_{3^N-1} $ に対応する爆弾の配置が存在する
- 入力はすべて整数
 
### Sample Explanation 1

$ 0 $ と近い位置は $ 0 $ と $ 1 $ で、位置 $ 0 $ と位置 $ 1 $ に爆弾は合計で $ 0 $ 個あります。 $ 1 $ と近い位置は $ 0 $ と $ 1 $ と $ 2 $ で、位置 $ 0 $ と位置 $ 1 $ と位置 $ 2 $ に爆弾は合計で $ 1 $ 個あります。 $ 2 $ と近い位置は $ 1 $ と $ 2 $ で、位置 $ 1 $ と位置 $ 2 $ に爆弾は合計で $ 1 $ 個あります。 $ 2 $ にのみ爆弾があるような配置は上の条件を全て満たすため、正答となります。

## 样例 #1

### 输入

```
1

0 1 1
```

### 输出

```
0 0 1
```

## 样例 #2

### 输入

```
2

2 3 2 4 5 3 3 4 2
```

### 输出

```
0 1 0 1 0 1 1 1 0
```

## 样例 #3

### 输入

```
2

0 0 0 0 0 0 0 0 0
```

### 输出

```
0 0 0 0 0 0 0 0 0
```



---

---
title: "[ABC291G] OR Sum"
layout: "post"
diff: 省选/NOI-
pid: AT_abc291_g
tag: []
---

# [ABC291G] OR Sum

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc291/tasks/abc291_g

長さ $ N $ の数列 $ A=(A_0,A_1,\ldots,A_{N-1}) $ と $ B=(B_0,B_1,\ldots,B_{N-1}) $ が与えられます。  
 また、高橋君は数列 $ A $ に対して、次の操作を好きな回数 ( $ 0 $ 回でもよい) 行う事ができます。

- $ A $ を $ 1 $ つ左にシフトする、すなわち、$ A $ を、$ A'_i=A_{(i+1)\%\ N} $ で定義される $ A' $ で置き換える。ただし、$ x\%\ N $ で、$ x $ を $ N $ で割った余りを表す。
 
高橋君の目的は $ \displaystyle\sum_{i=0}^{N-1}\ (A_i|B_i) $ を最大化することです。ただし、$ x|y $ で $ x $ と $ y $ のビット毎の論理和(bitwise OR)を表します。

$ \displaystyle\sum_{i=0}^{N-1}\ (A_i|B_i) $ の値としてあり得る最大の値を求めてください。

  ビット毎の論理和(bitwise OR)とは $ 1 $ ビットの数字 ($ 0 $ または $ 1 $) の組に対して下の表で定義される演算を**論理和**（またはOR演算）といいます。  
 ビット毎に論理和を適用する演算を**ビット毎の論理和（bitwise OR）**といいます。     $ x $  $ y $  $ x|y $     $ 0 $ $ 0 $ $ 0 $   $ 0 $ $ 1 $ $ 1 $   $ 1 $ $ 0 $ $ 1 $   $ 1 $ $ 1 $ $ 1 $   論理和ではビット $ x $, $ y $ の少なくとも一方が $ 1 $ の場合に結果が $ 1 $ となります。 逆に言うと、共に $ 0 $ の場合のみ結果が $ 0 $ となります。

##### 具体例

 ```
0110 | 0101 = 0111
```

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ A_0 $ $ A_1 $ $ \ldots $ $ A_{N-1} $ $ B_0 $ $ B_1 $ $ \ldots $ $ B_{N-1} $

## 输出格式

$ \displaystyle\sum_{i=0}^{N-1}\ (A_i|B_i) $ の値としてあり得る最大の値を出力せよ。

## 说明/提示

### 制約

- $ 2\ \leq\ N\ \leq\ 5\times\ 10^5 $
- $ 0\leq\ A_i,B_i\ \leq\ 31 $
- 入力はすべて整数
 
### Sample Explanation 1

高橋君が一度も操作を行わなかった時、$ A $ は $ (0,1,3) $ のままであり、$ \displaystyle\sum_{i=0}^{N-1}\ (A_i|B_i)=(0|0)+(1|2)+(3|3)=0+3+3=6 $, 高橋君が $ 1 $ 回操作を行った時、$ A=(1,3,0) $ となり、$ \displaystyle\sum_{i=0}^{N-1}\ (A_i|B_i)=(1|0)+(3|2)+(0|3)=1+3+3=7 $, 高橋君が $ 2 $ 回操作を行った時、$ A=(3,0,1) $ となり、$ \displaystyle\sum_{i=0}^{N-1}\ (A_i|B_i)=(3|0)+(0|2)+(1|3)=3+2+3=8 $ となります。$ 3 $ 回以上操作を行った時、 $ A $ は上記のいずれかの形になるため、$ \displaystyle\sum_{i=0}^{N-1}\ (A_i|B_i) $ の最大値は $ 8 $ であり、$ 8 $ を出力します。

### Sample Explanation 2

最大となるのは高橋君が $ 3 $ 回操作を行った時であり、この時 $ A=(4,3,1,6,1) $ となり、 $ \displaystyle\sum_{i=0}^{N-1}\ (A_i|B_i)=(4|0)+(3|6)+(1|4)+(6|0)+(1|1)=4+7+5+6+1=23 $ となります。

## 样例 #1

### 输入

```
3

0 1 3

0 2 3
```

### 输出

```
8
```

## 样例 #2

### 输入

```
5

1 6 1 4 3

0 6 4 0 1
```

### 输出

```
23
```



---

---
title: "[ABC291Ex] Balanced Tree"
layout: "post"
diff: 省选/NOI-
pid: AT_abc291_h
tag: []
---

# [ABC291Ex] Balanced Tree

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc291/tasks/abc291_h

$ N $ 頂点の木 $ T $ が与えられます。$ i $ 番目の辺は頂点 $ A_i $ と $ B_i $ を結んでいます。

次の条件をともに満たす $ N $ 頂点の根付き木 $ R $ を $ 1 $ つ求めてください。

- $ 1\ \leq\ x\ <\ y\ \leq\ N $ を満たす全ての整数の組 $ (x,y) $ に対し次が成り立つ
  - $ R $ における頂点 $ x,y $ の最小共通祖先が頂点 $ z $ であるとき、$ T $ において 頂点 $ x,y $ を結ぶ単純パス上に頂点 $ z $ が存在する
- $ R $ において、根以外の全ての頂点 $ v $ に対し、$ v $ を根とする部分木の頂点数の $ 2 $ 倍は、 $ v $ の親を根とする部分木の頂点数以下である
 
なお、この条件を満たす根付き木は必ず存在することが証明できます。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ A_1 $ $ B_1 $ $ \vdots $ $ A_{N-1} $ $ B_{N-1} $

## 输出格式

問題文中の条件を満たす根付き木を $ R $ とする。$ R $ における頂点 $ i $ の親を頂点 $ p_i $ とする（ただし、$ i $ が根のときは $ p_i=-1 $ と定める）。  
 $ N $ 個の整数 $ p_1,\ldots,p_N $ をこの順に空白区切りで出力せよ。

## 说明/提示

### 制約

- $ 1\ \leq\ N\ \leq\ 10^5 $
- $ 1\leq\ A_i,B_i\ \leq\ N $
- 入力は全て整数である
- 与えられるグラフは木である
 
### Sample Explanation 1

例えば、$ R $ における頂点 $ 1,3 $ の最小共通祖先は頂点 $ 2 $ であり、$ T $ において、頂点 $ 1,3 $ を結ぶ単純パス上に頂点 $ 2 $ が存在します。 また、例えば、$ R $ における頂点 $ 4 $ を根とする部分木の頂点数は $ 2 $ であり、その $ 2 $ 倍は、頂点 $ 2 $ を根とする部分木の頂点数 $ 4 $ 以下です。 !\[図\](https://img.atcoder.jp/abc291/7c68a1da41dbfff60a08aad4fe182376.png)

## 样例 #1

### 输入

```
4

1 2

2 3

3 4
```

### 输出

```
2 -1 4 2
```

## 样例 #2

### 输入

```
5

1 2

1 3

1 4

1 5
```

### 输出

```
-1 1 1 1 1
```



---

---
title: "[ABC293Ex] Optimal Path Decomposition"
layout: "post"
diff: 省选/NOI-
pid: AT_abc293_h
tag: []
---

# [ABC293Ex] Optimal Path Decomposition

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc293/tasks/abc293_h

$ N $ 頂点の木が与えられます。頂点には $ 1 $ から $ N $ までの番号がついており、$ i $ 番目の辺は頂点 $ A_i $ と頂点 $ B_i $ を結んでいます。

各頂点に以下の条件を満たすように色を塗ることができる整数 $ K $ の最小値を求めてください。ただし、使える色の種類数に制限はありません。

- 各色について、その色で塗られた頂点の集合は連結で単純パスをなす
- 任意の木上の単純パスについて、そのパス内に含まれる頂点に塗られた色の種類数は $ K $ 以下

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ A_1 $ $ B_1 $ $ \vdots $ $ A_{N-1} $ $ B_{N-1} $

## 输出格式

答えを出力せよ。

## 说明/提示

### 制約

- $ 1\ \leq\ N\ \leq\ 2\ \times\ 10^5 $
- $ 1\ \leq\ A_i,\ B_i\ \leq\ N $
- 与えられるグラフは木
- 入力はすべて整数

### Sample Explanation 1

$ K\ =\ 3 $ のとき、頂点 $ 1,2,3,4,5 $ を色 $ 1 $、頂点 $ 6 $ を色 $ 2 $、頂点 $ 7 $ を色 $ 3 $ で塗るなどの方法で条件を満たすことができます。 $ K\ \leq\ 2 $ とすると条件を満たす色の塗り方は存在しないので答えは $ 3 $ です。

## 样例 #1

### 输入

```
7
3 4
1 5
4 5
1 2
7 4
1 6
```

### 输出

```
3
```

## 样例 #2

### 输入

```
6
3 5
6 4
6 3
4 2
1 5
```

### 输出

```
1
```

## 样例 #3

### 输入

```
9
1 3
9 5
8 7
2 1
5 2
5 8
4 8
6 1
```

### 输出

```
3
```



---

---
title: "[ABC295Ex] E or m"
layout: "post"
diff: 省选/NOI-
pid: AT_abc295_h
tag: []
---

# [ABC295Ex] E or m

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc295/tasks/abc295_h

$ N $ 行 $ M $ 列のグリッド $ A $ があり、はじめ全てのマスに $ 0 $ が書き込まれています。  
 ここに以下の操作を行います。

- $ 1\ \le\ i\ \le\ N $ を満たす各整数 $ i $ に対して、 $ A $ の $ i $ 行目の左から $ 0 $ 個以上のマスの数字を $ 1 $ にする。
- $ 1\ \le\ j\ \le\ M $ を満たす各整数 $ j $ に対して、 $ A $ の $ j $ 列目の上から $ 0 $ 個以上のマスの数字を $ 1 $ にする。
 
この手続きによって作ることのできる $ A $ の集合を $ S $ とします。

`0`, `1`, `?` からなる $ N $ 行 $ M $ 列のグリッド $ X $ が与えられます。  
 `?` を `0` か `1` に置き換えて得られるグリッドは $ X $ に含まれる `?` の総数を $ q $ とすると $ 2^q $ 個ありますが、このうち $ S $ の要素であるものはいくつありますか？  
 答えは非常に大きくなる場合があるので、 $ 998244353 $ で割った余りを求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ M $ $ X_{1,1}\ X_{1,2}\ \dots\ X_{1,M} $ $ X_{2,1}\ X_{2,2}\ \dots\ X_{2,M} $ $ \vdots $ $ X_{N,1}\ X_{N,2}\ \dots\ X_{N,M} $

## 输出格式

答えを整数として出力せよ。

## 说明/提示

### 制約

- $ N,M $ は整数
- $ 1\ \le\ N,M\ \le\ 18 $
- $ X $ は `0`, `1`, `?` からなる $ N $ 行 $ M $ 列のグリッド
 
### Sample Explanation 1

条件を満たすグリッドは以下の $ 6 $ つです。 ``` 011 011 001 010 011 110 001 011 011 111 110 111 ```

### Sample Explanation 2

$ X $ に `?` が存在しない場合も、答えが $ 0 $ である場合もあります。

### Sample Explanation 3

答えを $ 998244353 $ で割った余りを求めることに注意してください。

## 样例 #1

### 输入

```
2 3

0?1

?1?
```

### 输出

```
6
```

## 样例 #2

### 输入

```
5 3

101

010

101

010

101
```

### 输出

```
0
```

## 样例 #3

### 输入

```
18 18

??????????????????

??????????????????

??????????????????

??????????????????

??????????????????

??????????????????

??????????????????

??????????????????

??????????????????

??????????????????

??????????????????

??????????????????

??????????????????

??????????????????

??????????????????

??????????????????

??????????????????

??????????????????
```

### 输出

```
462237431
```



---

---
title: "[ABC296Ex] Unite"
layout: "post"
diff: 省选/NOI-
pid: AT_abc296_h
tag: []
---

# [ABC296Ex] Unite

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc296/tasks/abc296_h

$ N $ 行 $ M $ 列のマス目があり、各マスは黒または白で塗られています。 ここで、少なくとも $ 1 $ つのマスが黒く塗られています。  
 最初のマス目の状態は $ N $ 個の長さ $ M $ の文字列 $ S_1,S_2,\ldots,S_N $ で与えられます。  
 マス目の上から $ i $ 行目 $ (1\leq\ i\leq\ N) $ かつ左から $ j $ 列目 $ (1\leq\ j\leq\ M) $ のマスは、 $ S_i $ の $ j $ 文字目が `#` であるとき黒く、`.` であるとき白く塗られています。

高橋君の目標は白く塗られたいくつかのマス ($ 0 $ 個でもよい ) を新しく黒く塗ることによって、黒く塗られたマス全体が **連結** になるようにすることです。 高橋君が目標を達成するために**新しく塗る必要のある**マスの個数としてあり得る最小値を求めてください。

ただし、黒く塗られたマス全体が **連結** であるとは、黒く塗られたどの $ 2 $ つのマスの組 $ (S,T) $ についても、 正整数 $ K $ と長さ $ K $ の黒く塗られたマスの列 $ X=(x_1,x_2,\ldots,x_K) $ であって、$ x_1=S $, $ x_K=T $ かつ任意の $ 1\leq\ i\leq\ K-1 $ について $ x_i $ と $ x_{i+1} $ が辺を共有しているようなものが存在することをいいます。  
 なお、問題の制約下でつねに、高橋君が目標を達成するような塗り方が存在することが証明できます。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ M $ $ S_1 $ $ S_2 $ $ \vdots $ $ S_N $

## 输出格式

黒く塗られたマス全体が連結になるようにするために、新しく塗る必要のあるマスの個数としてあり得る最小値を出力せよ。

## 说明/提示

### 制約

- $ 1\ \leq\ N\ \leq\ 100 $
- $ 1\leq\ M\ \leq\ 7 $
- $ N,M $ は整数
- $ S_i $ は `#` と `.` のみからなる長さ $ M $ の文字列
- 与えられるマス目において、黒く塗られたマスが $ 1 $ つ以上存在する。
 
### Sample Explanation 1

最初、マス目の状態は次のようになっています。ここで、上から $ i $ 行目、左から $ j $ 列目のマスを $ (i,j) $ で表しています。 !\[\](https://img.atcoder.jp/abc296/d5b5d945798a02840b8add26271fe2a5.png) ここで、例えば、高橋君が $ (2,3),(2,4),(3,4) $ の $ 3 $ つのマス(下図の赤いマス)を新しく黒く塗ったとします。 !\[\](https://img.atcoder.jp/abc296/d2d0f1745af0dc309341f96dbd83e717.png) このとき、最初から黒く塗られていたマスと新しく黒く塗られたマスは合わせて次のようになり、黒く塗られたマス全体は連結となります。 !\[\](https://img.atcoder.jp/abc296/76bebc05c2d7c5240151b534ba30f29b.png) $ 2 $ つ以下のマスを新しく黒く塗ることで黒く塗られたマス全体を連結にすることはできないため、$ 3 $ が答えとなります。 白く塗られたマス全体を連結にする必要はないことに注意してください。

### Sample Explanation 2

最初から全てのマスが黒く塗られている可能性もあります。

## 样例 #1

### 输入

```
3 5

...#.

.#...

....#
```

### 输出

```
3
```

## 样例 #2

### 输入

```
3 3

###

###

###
```

### 输出

```
0
```

## 样例 #3

### 输入

```
10 1

.

#

.

.

.

.

.

.

#

.
```

### 输出

```
6
```



---

---
title: "[ABC297Ex] Diff Adjacent"
layout: "post"
diff: 省选/NOI-
pid: AT_abc297_h
tag: []
---

# [ABC297Ex] Diff Adjacent

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc297/tasks/abc297_h

正整数列のうち、全ての隣接している $ 2 $ 項が異なるものを**素晴らしい整数列**と定めます。

要素の総和が $ N $ の素晴らしい整数列全てに対する長さの総和を $ 998244353 $ で割ったあまりを求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $

## 输出格式

答えを出力せよ。

## 说明/提示

### 制約

- $ 1\ \le\ N\ \le\ 2\ \times\ 10^5 $
- 入力はすべて整数
 
### Sample Explanation 1

要素の総和が $ 4 $ の素晴らしい整数列は、$ (4),(1,3),(3,1),(1,2,1) $ の $ 4 $ 個です。なので、答えはこれらの長さの総和の $ 1+2+2+3=8 $ です。 $ (2,2) $ や $ (1,1,2) $ は総和が $ 4 $ ですが、両方 $ 1 $ 項目と $ 2 $ 項目が等しいため条件を満たしません。

## 样例 #1

### 输入

```
4
```

### 输出

```
8
```

## 样例 #2

### 输入

```
297
```

### 输出

```
475867236
```

## 样例 #3

### 输入

```
123456
```

### 输出

```
771773807
```



---

---
title: "[ABC298G] Strawberry War"
layout: "post"
diff: 省选/NOI-
pid: AT_abc298_g
tag: []
---

# [ABC298G] Strawberry War

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc298/tasks/abc298_g

長方形のケーキがあります。このケーキは $ H $ 行 $ W $ 列に並ぶ区画に分かれていて、上から $ i $ 行目、左から $ j $ 列目の区画にはイチゴが $ s_{i,j} $ 個載っています。

あなたは $ T $ 回の切断を行ってケーキを $ T+1 $ 切れに分割することにしました。各回の切断は、次のいずれかの方法で行います。

- 現存するケーキであって、区画の行の数が $ 2 $ 以上であるものを選ぶ。さらに、そのケーキから隣接する $ 2 $ 行を選び、その境界でケーキを切断してより小さなケーキ $ 2 $ 切れに分割する。
- 現存するケーキであって、区画の列の数が $ 2 $ 以上であるものを選ぶ。さらに、そのケーキから隣接する $ 2 $ 列を選び、その境界でケーキを切断してより小さなケーキ $ 2 $ 切れに分割する。
 
あなたの目標は、分割後のケーキに載ったイチゴの数をできるだけ均等にすることです。  
 分割後の $ T+1 $ 切れのケーキに載ったイチゴの個数を $ x_1,x_2,\ldots,x_{T+1} $ として、そのうち最大のものを $ M $、最小のものを $ m $ とするとき、$ M－m $ がとりうる最小値を求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ H $ $ W $ $ T $ $ s_{1,1} $ $ \ldots $ $ s_{1,W} $ $ \vdots $ $ s_{H,1} $ $ \ldots $ $ s_{H,W} $

## 输出格式

答えを出力せよ。

## 说明/提示

### 制約

- $ 1\ \leq\ H,W\ \leq\ 6 $
- $ 1\ \leq\ T\ \leq\ HW-1 $
- $ 0\ \leq\ s_{i,j}\ \leq\ 10^{16} $
- 入力はすべて整数
 
### Sample Explanation 1

下のように切り分けると左上のケーキに $ 2 $ 個、左下のケーキに $ 4 $ 個、中央のケーキに $ 4 $ 個、右上のケーキに $ 4 $ 個、右下のケーキに $ 3 $ 個のイチゴが載った状態になり、イチゴの個数の最大値と最小値の差は $ 4-2=2 $ となります。差をこれよりも小さくすることは出来ないため、$ 2 $ が答えとなります。 !\[\](https://img.atcoder.jp/abc298/6d6a4c5fc7ac2723af8e8b30e48957da.png)

## 样例 #1

### 输入

```
2 3 4

2 3 4

4 1 3
```

### 输出

```
2
```

## 样例 #2

### 输入

```
2 2 3

0 0

0 0
```

### 输出

```
0
```



---

---
title: "[ABC298Ex] Sum of Min of Length"
layout: "post"
diff: 省选/NOI-
pid: AT_abc298_h
tag: []
---

# [ABC298Ex] Sum of Min of Length

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc298/tasks/abc298_h

$ N $ 頂点の木が与えられます。頂点には $ 1 $ から $ N $ までの番号がついており、$ i $ 番目の辺は頂点 $ A_i $ と頂点 $ B_i $ を結んでいます。

また、この木における頂点 $ x $ と頂点 $ y $ の距離を $ d(x,y) $ で表します。ただし、頂点 $ x $ と頂点 $ y $ の距離とは、頂点 $ x $ から頂点 $ y $ までの最短パス上の辺の本数のことをいいます。

$ Q $ 個のクエリが与えられるので、順番に答えてください。$ i $ 番目のクエリは以下で説明されます。

- 整数 $ L_i,\ R_i $ が与えられます。 $ \displaystyle\sum_{j\ =\ 1}^{N}\ \min(d(j,\ L_i),\ d(j,\ R_i)) $ の値を求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ A_1 $ $ B_1 $ $ \vdots $ $ A_{N-1} $ $ B_{N-1} $ $ Q $ $ L_1 $ $ R_1 $ $ \vdots $ $ L_Q $ $ R_Q $

## 输出格式

$ Q $ 行出力せよ。$ i $ 行目には $ i $ 番目のクエリに対する答えを出力せよ。

## 说明/提示

### 制約

- $ 1\ \leq\ N,\ Q\ \leq\ 2\ \times\ 10^5 $
- $ 1\ \leq\ A_i,\ B_i,\ L_i,\ R_i\ \leq\ N $
- 与えられるグラフは木
- 入力はすべて整数
 
### Sample Explanation 1

$ 1 $ 番目のクエリについて説明します。 $ d(1,\ 4)\ =\ 2 $、$ d(1,\ 1)\ =\ 0 $ より $ \min(d(1,\ 4),\ d(1,\ 1))\ =\ 0 $ です。 $ d(2,\ 4)\ =\ 2 $、$ d(2,\ 1)\ =\ 2 $ より $ \min(d(2,\ 4),\ d(2,\ 1))\ =\ 2 $ です。 $ d(3,\ 4)\ =\ 1 $、$ d(3,\ 1)\ =\ 3 $ より $ \min(d(3,\ 4),\ d(3,\ 1))\ =\ 1 $ です。 $ d(4,\ 4)\ =\ 0 $、$ d(4,\ 1)\ =\ 2 $ より $ \min(d(4,\ 4),\ d(4,\ 1))\ =\ 0 $ です。 $ d(5,\ 4)\ =\ 1 $、$ d(5,\ 1)\ =\ 1 $ より $ \min(d(5,\ 4),\ d(5,\ 1))\ =\ 1 $ です。 $ 0\ +\ 2\ +\ 1\ +\ 0\ +\ 1\ =\ 4 $ であるため、$ 4 $ を出力します。

## 样例 #1

### 输入

```
5

3 4

4 5

2 5

1 5

3

4 1

1 2

5 3
```

### 输出

```
4

6

3
```

## 样例 #2

### 输入

```
8

4 2

4 1

5 6

6 1

7 6

8 1

3 7

7

8 4

4 4

7 2

4 4

5 3

4 4

6 1
```

### 输出

```
14

16

10

16

14

16

8
```



---

---
title: "[ABC301F] Anti-DDoS"
layout: "post"
diff: 省选/NOI-
pid: AT_abc301_f
tag: []
---

# [ABC301F] Anti-DDoS

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc301/tasks/abc301_f

英大文字・英小文字からなる長さ $ 4 $ の文字列で、以下の $ 2 $ 条件をともに満たすものを `DDoS` 型文字列と呼ぶことにします。

- $ 1,2,4 $ 文字目が英大文字で、$ 3 $ 文字目が英小文字である
- $ 1,2 $ 文字目が等しい

例えば `DDoS`, `AAaA` は `DDoS` 型文字列であり、`ddos`, `IPoE` は `DDoS` 型文字列ではありません。

英大文字・英小文字および `?` からなる文字列 $ S $ が与えられます。 $ S $ に含まれる `?` を独立に英大文字・英小文字に置き換えてできる文字列は、$ S $ に含まれる `?` の個数を $ q $ として $ 52^q $ 通りあります。 このうち `DDoS` 型文字列を部分列に含まないものの個数を $ 998244353 $ で割ったあまりを求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ S $

## 输出格式

答えを出力せよ。

## 说明/提示

### 注記

文字列の**部分列**とは、文字列から $ 0 $ 個以上の文字を取り除いた後、残りの文字を元の順序で連結して得られる文字列のことをいいます。  
例えば、`AC` は `ABC` の部分列であり、`RE` は `ECR` の部分列ではありません。

### 制約

- $ S $ は英大文字・英小文字および `?` からなる
- $ S $ の長さは $ 4 $ 以上 $ 3\times\ 10^5 $ 以下

### Sample Explanation 1

`?` の少なくとも一方が英小文字のとき、`DDoS` 型文字列を部分列に含みます。

### Sample Explanation 2

$ 998244353 $ で割ったあまりを求めてください。

## 样例 #1

### 输入

```
DD??S
```

### 输出

```
676
```

## 样例 #2

### 输入

```
????????????????????????????????????????
```

### 输出

```
858572093
```

## 样例 #3

### 输入

```
?D??S
```

### 输出

```
136604
```



---

---
title: "[ABC301Ex] Difference of Distance"
layout: "post"
diff: 省选/NOI-
pid: AT_abc301_h
tag: []
---

# [ABC301Ex] Difference of Distance

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc301/tasks/abc301_h

頂点には $ 1 $ から $ N $ の番号が、辺には $ 1 $ から $ M $ の番号がついた $ N $ 頂点 $ M $ 辺の連結無向グラフがあります。 辺 $ i $ は頂点 $ U_i $ と頂点 $ V_i $ を結んでおり、重みとして整数 $ W_i $ が定められています。 ここで、$ 1\leq\ s,t\ \leq\ N,\ s\neq\ t $ に対して $ d(s,t) $ を以下で定義します。

- 頂点 $ s $ と頂点 $ t $ を結ぶすべてのパスに対する「パス上の辺の重みの最大値」の最小値
 
今から与えられる $ Q $ 個のクエリにそれぞれ答えてください。$ j $ 番目のクエリは以下の通りです。

- $ A_j,S_j,T_j $ が与えられる。辺 $ A_j $ の重みを $ 1 $ 増やすと $ d(S_j,T_j) $ がいくつ変化するか求めよ。
 
なお、各クエリにおいて実際には辺の重みは変更しないことに注意してください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ M $ $ U_1 $ $ V_1 $ $ W_1 $ $ \vdots $ $ U_M $ $ V_M $ $ W_M $ $ Q $ $ A_1 $ $ S_1 $ $ T_1 $ $ \vdots $ $ A_Q $ $ S_Q $ $ T_Q $

## 输出格式

$ Q $ 行出力せよ。 $ j\ (1\leq\ j\ \leq\ Q) $ 行目には、$ j $ 番目のクエリに対する答えを出力せよ。

## 说明/提示

### 制約

- $ 2\leq\ N\ \leq\ 2\times\ 10^5 $
- $ N-1\leq\ M\ \leq\ 2\times\ 10^5 $
- $ 1\ \leq\ U_i,V_i\ \leq\ N $
- $ U_i\ \neq\ V_i $
- $ 1\ \leq\ W_i\ \leq\ M $
- 与えられるグラフは連結
- $ 1\leq\ Q\ \leq\ 2\times\ 10^5 $
- $ 1\ \leq\ A_j\ \leq\ M $
- $ 1\ \leq\ S_j,T_j\ \leq\ N $
- $ S_j\neq\ T_j $
- 入力は全て整数
 
### Sample Explanation 1

![image of the given graph](https://img.atcoder.jp/abc301/00609898872063e16f2e7b43c6436c6d.png) 上の図においては、辺の番号を黒字で、辺の重みを青字で表記しています。 $ 1 $ 番目から $ 6 $ 番目のクエリについて説明します。 まず与えられたグラフにおける $ d(4,6) $ について考えます。 $ 4\ \rightarrow\ 1\ \rightarrow\ 2\ \rightarrow\ 6 $ というパス上の辺の重みの最大値は $ 5 $ ですが、 これは頂点 $ 4 $ と頂点 $ 6 $ を結ぶパスの中での最小値であるため、$ d(4,6)=5 $ です。 次に、辺 $ x\ (1\ \leq\ x\ \leq\ 6) $ の重みを $ 1 $ 増やすと $ d(4,6) $ がいくつ変化するか考えます。 $ x=6 $ のとき $ d(4,6)=6 $ となるため変化量は $ 1 $ ですが、$ x\ \neq\ 6 $ のときは $ d(4,6)=5 $ となるため変化量は $ 0 $ です。 たとえば $ x=3 $ のとき、$ 4\ \rightarrow\ 1\ \rightarrow\ 2\ \rightarrow\ 6 $ というパス上の辺の重みの最大値は $ 6 $ になりますが、 $ 4\ \rightarrow\ 3\ \rightarrow\ 1\ \rightarrow\ 2\ \rightarrow\ 6 $ というパス上の辺の重みの最大値が $ 5 $ であるため $ d(4,6) $ は変わらず $ 5 $ のままです。

### Sample Explanation 2

与えられるグラフは多重辺を含むこともあります。

## 样例 #1

### 输入

```
6 6

1 2 1

3 1 5

4 1 5

3 4 3

5 6 4

2 6 5

7

1 4 6

2 4 6

3 4 6

4 4 6

5 4 6

6 4 6

5 6 5
```

### 输出

```
0

0

0

0

0

1

1
```

## 样例 #2

### 输入

```
2 2

1 2 1

1 2 1

1

1 1 2
```

### 输出

```
0
```



---

---
title: "[ABC302Ex] Ball Collector"
layout: "post"
diff: 省选/NOI-
pid: AT_abc302_h
tag: []
---

# [ABC302Ex] Ball Collector

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc302/tasks/abc302_h

$ N $ 頂点の木があります。$ i(1\ \le\ i\ \le\ N-1) $ 本目の辺は、頂点 $ U_i $ と $ V_i $ を結ぶ無向辺です。頂点 $ i(1\ \le\ i\ \le\ N) $ には、$ A_i $ が書かれたボールと $ B_i $ が書かれたボールが $ 1 $ 個ずつあります。

$ v\ =\ 2,3,\dots,N $ に対して、以下の問題を解いてください。(各問題は独立です。)

- 頂点 $ 1 $ から頂点 $ v $ まで最短経路で移動します。このとき、通った各頂点(頂点 $ 1,v $ も含む)において、ボールを $ 1 $ 個ずつ選んで取ります。最終的に持っているボールに書かれている整数の種類数の最大値を求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ A_1 $ $ B_1 $ $ A_2 $ $ B_2 $ $ \vdots $ $ A_N $ $ B_N $ $ U_1 $ $ V_1 $ $ U_2 $ $ V_2 $ $ \vdots $ $ U_{N-1} $ $ V_{N-1} $

## 输出格式

$ v=2,3,\dots,N $ に対して、答えを空白区切りで出力せよ。

## 说明/提示

### 制約

- $ 2\ \le\ N\ \le\ 2\ \times\ 10^5 $
- $ 1\ \le\ A_i,B_i\ \le\ N $
- 与えられるグラフは木である。
- 入力は全て整数である。
 
### Sample Explanation 1

例えば、$ v=4 $ のときは通る頂点は $ 1,2,3,4 $ であり、それぞれ $ A_1,B_2,B_3,B_4(=1,3,1,2) $ が書かれているボールを選ぶと種類数が $ 3 $ となり、これが最大となります。

## 样例 #1

### 输入

```
4

1 2

2 3

3 1

1 2

1 2

2 3

3 4
```

### 输出

```
2 3 3
```

## 样例 #2

### 输入

```
10

2 5

2 2

8 8

4 3

6 10

8 1

9 10

1 7

9 3

5 10

9 3

1 9

3 6

4 1

3 8

10 9

5 4

7 2

9 7
```

### 输出

```
4 3 2 3 4 3 4 2 3
```



---

---
title: "[ABC303Ex] Constrained Tree Degree"
layout: "post"
diff: 省选/NOI-
pid: AT_abc303_h
tag: []
---

# [ABC303Ex] Constrained Tree Degree

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc303/tasks/abc303_h

整数 $ N $ 及び $ 1 $ 以上 $ N-1 $ 以下の整数からなる集合 $ S=\lbrace\ S_1,S_2,\ldots,S_K\rbrace $ が与えられます。

頂点に $ 1 $ から $ N $ の番号がついた $ N $ 頂点の木 $ T $ のうち、以下の条件を満たすものの個数を $ 998244353 $ で割った余りを答えてください。

- 任意の $ i\ (1\leq\ i\ \leq\ N) $ について、$ T $ の頂点 $ i $ の次数を $ d_i $ としたとき、 $ d_i\in\ S $

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ K $ $ S_1 $ $ \ldots $ $ S_K $

## 输出格式

条件を満たす木 $ T $ の個数を $ 998244353 $ で割った余りを出力せよ。

## 说明/提示

### 制約

- $ 2\leq\ N\ \leq\ 2\times\ 10^5 $
- $ 1\leq\ K\ \leq\ N-1 $
- $ 1\leq\ S_1\ <\ S_2\ <\ \ldots\ <\ S_K\ \leq\ N-1 $
- 入力は全て整数

### Sample Explanation 1

ある $ 1 $ つの頂点の次数が $ 3 $ であり、ほかの頂点の次数が $ 1 $ であるような木が条件を満たします。よって答えは $ 4 $ 個です。

### Sample Explanation 3

個数を $ 998244353 $ で割った余りを出力してください。

## 样例 #1

### 输入

```
4 2
1 3
```

### 输出

```
4
```

## 样例 #2

### 输入

```
10 5
1 2 3 5 6
```

### 输出

```
68521950
```

## 样例 #3

### 输入

```
100 5
1 2 3 14 15
```

### 输出

```
888770956
```



---

---
title: "[ABC304Ex] Constrained Topological Sort"
layout: "post"
diff: 省选/NOI-
pid: AT_abc304_h
tag: []
---

# [ABC304Ex] Constrained Topological Sort

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc304/tasks/abc304_h

$ N $ 頂点 $ M $ 辺の有向グラフが与えられます。 $ i\ =\ 1,\ 2,\ \ldots,\ M $ について、$ i $ 番目の辺は頂点 $ s_i $ から頂点 $ t_i $ への有向辺です。

$ (1,\ 2,\ \ldots,\ N) $ の順列 $ P\ =\ (P_1,\ P_2,\ \ldots,\ P_N) $ であって下記の $ 2 $ つの条件をともに満たすものが存在するかを判定し、存在する場合はその一例を示してください。

- すべての $ i\ =\ 1,\ 2,\ \ldots,\ M $ について、$ P_{s_i}\ \lt\ P_{t_i} $
- すべての $ i\ =\ 1,\ 2,\ \ldots,\ N $ について、$ L_i\ \leq\ P_i\ \leq\ R_i $

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ M $ $ s_1 $ $ t_1 $ $ s_2 $ $ t_2 $ $ \vdots $ $ s_M $ $ t_M $ $ L_1 $ $ R_1 $ $ L_2 $ $ R_2 $ $ \vdots $ $ L_N $ $ R_N $

## 输出格式

条件を満たす $ P $ が存在しない場合は、`No` と出力せよ。存在する場合は、下記の形式の通り、$ 1 $ 行目に `Yes` と出力し、 $ 2 $ 行目に $ P $ の各要素を空白区切りで出力せよ。 条件を満たす $ P $ が複数存在する場合は、そのうちのどれを出力しても正解となる。

> Yes $ P_1 $ $ P_2 $ $ \ldots $ $ P_N $

## 说明/提示

### 制約

- $ 2\ \leq\ N\ \leq\ 2\ \times\ 10^5 $
- $ 0\ \leq\ M\ \leq\ \min\lbrace\ 4\ \times\ 10^5,\ N(N-1)\ \rbrace $
- $ 1\ \leq\ s_i,\ t_i\ \leq\ N $
- $ s_i\ \neq\ t_i $
- $ i\ \neq\ j\ \implies\ (s_i,\ t_i)\ \neq\ (s_j,\ t_j) $
- $ 1\ \leq\ L_i\ \leq\ R_i\ \leq\ N $
- 入力はすべて整数
 
### Sample Explanation 1

$ P\ =\ (3,\ 1,\ 4,\ 2,\ 5) $ が条件を満たします。実際、 - $ 1 $ 番目の辺 $ (s_1,\ t_1)\ =\ (1,\ 5) $ について、$ P_1\ =\ 3\ \lt\ 5\ =\ P_5 $ - $ 2 $ 番目の辺 $ (s_2,\ t_2)\ =\ (2,\ 1) $ について、$ P_2\ =\ 1\ \lt\ 3\ =\ P_1 $ - $ 3 $ 番目の辺 $ (s_3,\ t_3)\ =\ (2,\ 5) $ について、$ P_2\ =\ 1\ \lt\ 5\ =\ P_5 $ - $ 4 $ 番目の辺 $ (s_4,\ t_4)\ =\ (4,\ 3) $ について、$ P_4\ =\ 2\ \lt\ 4\ =\ P_3 $ が成り立ちます。また、 - $ L_1\ =\ 1\ \leq\ P_1\ =\ 3\ \leq\ R_1\ =\ 5 $ - $ L_2\ =\ 1\ \leq\ P_2\ =\ 1\ \leq\ R_2\ =\ 3 $ - $ L_3\ =\ 3\ \leq\ P_3\ =\ 4\ \leq\ R_3\ =\ 4 $ - $ L_4\ =\ 1\ \leq\ P_4\ =\ 2\ \leq\ R_4\ =\ 3 $ - $ L_5\ =\ 4\ \leq\ P_5\ =\ 5\ \leq\ R_5\ =\ 5 $ も成り立ちます。

### Sample Explanation 2

条件を満たす $ P $ が存在しないので、`No` を出力します。

## 样例 #1

### 输入

```
5 4

1 5

2 1

2 5

4 3

1 5

1 3

3 4

1 3

4 5
```

### 输出

```
Yes

3 1 4 2 5
```

## 样例 #2

### 输入

```
2 2

1 2

2 1

1 2

1 2
```

### 输出

```
No
```



---

---
title: "[ABC306G] Return to 1"
layout: "post"
diff: 省选/NOI-
pid: AT_abc306_g
tag: []
---

# [ABC306G] Return to 1

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc306/tasks/abc306_g

$ N $ 頂点 $ M $ 辺の有向グラフがあります。 頂点には $ 1 $ から $ N $ までの番号が付けられていて、$ i $ 番目の辺は頂点 $ U_i $ から頂点 $ V_i $ に向かって伸びています。

あなたは今頂点 $ 1 $ にいます。 以下の行動をちょうど $ 10^{10^{100}} $ 回繰り返して頂点 $ 1 $ に戻ってくることが可能かどうか判定してください。

- 今いる頂点から伸びている辺を $ 1 $ つ選び、その辺が伸びている先の頂点に移動する。

$ T $ 個のテストケースが与えられるので、それぞれについて解いてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。 ここで $ \text{test}_i $ は $ i $ 番目のテストケースを意味する。

> $ T $ $ \text{test}_1 $ $ \text{test}_2 $ $ \vdots $ $ \text{test}_T $

各テストケースは以下の形式で与えられる。

> $ N $ $ M $ $ U_1 $ $ V_1 $ $ U_2 $ $ V_2 $ $ \vdots $ $ U_M $ $ V_M $

## 输出格式

$ T $ 行出力せよ。

$ i\ (1\leq\ i\ \leq\ T) $ 行目には、 $ i $ 番目のテストケースにおいて問題文中の行動をちょうど $ 10^{10^{100}} $ 回繰り返して頂点 $ 1 $ に戻ってくることが可能ならば `Yes` を、 そうでないならば `No` を出力せよ。

## 说明/提示

### 制約

- 入力は全て整数
- $ 1\leq\ T\ \leq\ 2\times\ 10^5 $
- $ 2\leq\ N\ \leq\ 2\times\ 10^5 $
- $ 1\leq\ M\ \leq\ 2\times\ 10^5 $
- 全てのテストケースにおける $ N $ の総和は $ 2\ \times\ 10^5 $ 以下
- 全てのテストケースにおける $ M $ の総和は $ 2\ \times\ 10^5 $ 以下
- $ 1\ \leq\ U_i,\ V_i\ \leq\ N $
- $ U_i\ \neq\ V_i $
- $ i\neq\ j $ ならば $ (U_i,V_i)\ \neq\ (U_j,V_j) $

### Sample Explanation 1

$ 1 $ 番目のテストケースについて、 - 頂点 $ 1\ \rightarrow\ 2\ \rightarrow\ 1\ \rightarrow\ \dots $ という移動を繰り返す以外の選択肢はありません。 このとき、$ 10^{10^{100}} $ 回の移動をした時点で頂点 $ 1 $ にいるので、答えは `Yes` です。 $ 2 $ 番目のテストケースについて、 - 頂点 $ 1\ \rightarrow\ 2\ \rightarrow\ 3\ \rightarrow\ 1\ \rightarrow\ \dots $ という移動を繰り返す以外の選択肢はありません。 このとき、$ 10^{10^{100}} $ 回の移動をした時点で頂点 $ 2 $ にいるので、答えは `No` です。

## 样例 #1

### 输入

```
4
2 2
1 2
2 1
3 3
1 2
2 3
3 1
7 10
1 6
6 3
1 4
5 1
7 1
4 5
2 1
4 7
2 7
4 3
7 11
1 6
6 3
1 4
5 1
7 1
4 5
2 1
4 7
2 7
4 3
3 7
```

### 输出

```
Yes
No
No
Yes
```



---

---
title: "[ABC307Ex] Marquee"
layout: "post"
diff: 省选/NOI-
pid: AT_abc307_h
tag: []
---

# [ABC307Ex] Marquee

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc307/tasks/abc307_h

英大文字および英小文字からなる長さ $ L $ の文字列 $ S $ が幅 $ W $ の電光掲示板に表示されており、$ S $ が右から左へ $ 1 $ 文字分の幅ずつスクロールするように切り替わっています。

表示は、$ S $ の最後の文字が左端から消えると同時に $ S $ の最初の文字が右端から現れる、$ L+W-1 $ 周期での繰り返しとなっています。

例えば $ W=5 $、$ S= $ `ABC` のとき、電光掲示板の表示は

- `ABC..`
- `BC...`
- `C....`
- `....A`
- `...AB`
- `..ABC`
- `.ABC.`

の $ 7 $ つの状態を繰り返します。（`.` は文字が表示されていないことを表します）

より厳密には、各 $ k=0,\ldots,L+W-2 $ に対して、表示が次のようになっている相異なる状態が定まります。

- $ x $ を $ L+W-1 $ で割ったあまりを $ f(x) $ と表す。電光掲示板の左から $ (i+1) $ 番目の位置には、$ f(i+k)\ <\ L $ のとき $ S $ の $ f(i+k)+1 $ 番目の文字が表示され、そうでないとき何も表示されていない。

英大文字, 英小文字, `.`, `_` からなる長さ $ W $ の文字列 $ P $ が与えられます。  
電光掲示板の $ L+W-1 $ 種類の状態のうち、`_` の箇所を除いて $ P $ と一致するものの個数を求めてください。  
より厳密には、以下の条件を満たす状態の個数を求めてください。

- 全ての $ i=1,\ldots,W $ に対して次のいずれかが成立する
  - $ P $ の $ i $ 文字目は `_` である
  - 電光掲示板の左から $ i $ 番目に表示されている文字が $ P $ の $ i $ 文字目と等しい
  - 電光掲示板の左から $ i $ 番目には何も表示されておらず、かつ、$ P $ の $ i $ 文字目は `.` である

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ L $ $ W $ $ S $ $ P $

## 输出格式

答えを出力せよ。

## 说明/提示

### 制約

- $ 1\ \leq\ L\ \leq\ W\ \leq\ 3\times\ 10^5 $
- $ L,W $ は整数である
- $ S $ は英大文字および英小文字のみからなる長さ $ L $ の文字列である
- $ P $ は英大文字, 英小文字, `.`, `_` のみからなる長さ $ W $ の文字列である

### Sample Explanation 1

電光掲示板の表示が `....A`, `...AB`, `..ABC` であるときの $ 3 $ 状態が該当します。

## 样例 #1

### 输入

```
3 5
ABC
..___
```

### 输出

```
3
```

## 样例 #2

### 输入

```
11 15
abracadabra
__.._________ab
```

### 输出

```
2
```

## 样例 #3

### 输入

```
20 30
abaababbbabaabababba
__a____b_____a________________
```

### 输出

```
2
```

## 样例 #4

### 输入

```
1 1
a
_
```

### 输出

```
1
```



---

---
title: "[ABC308Ex] Make Q"
layout: "post"
diff: 省选/NOI-
pid: AT_abc308_h
tag: []
---

# [ABC308Ex] Make Q

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc308/tasks/abc308_h

$ N $ 頂点 $ M $ 辺の単純無向グラフがあり、最初全ての辺は白く塗られています。 頂点には $ 1 $ から $ N $ までの番号が、辺には $ 1 $ から $ M $ までの番号がそれぞれ付けられています。 辺 $ i $ は頂点 $ A_i $ と頂点 $ B_i $ を結んでおり、この辺を黒く塗るのにかかるコストは $ C_i $ です。

$ 4 $ 本以上の辺を黒く塗ることで以下の条件を全て満たすようにすることを「Q を作る」といいます。

- 黒く塗られた辺のうちある $ 1 $ 本以外は、$ 1 $ つの単純サイクルをなす。
- 黒く塗られた辺のうち上記のサイクルに含まれない $ 1 $ 本は、そのサイクルに含まれる頂点と含まれない頂点を結ぶ。
 
Q を作ることが可能かどうか判定し、可能ならば Q を作るのに必要な最小の総コストを求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ M $ $ A_1 $ $ B_1 $ $ C_1 $ $ A_2 $ $ B_2 $ $ C_2 $ $ \vdots $ $ A_M $ $ B_M $ $ C_M $

## 输出格式

Q を作ることが可能ならば Q を作るのに必要な最小の総コストを、不可能ならば $ -1 $ を出力せよ。

## 说明/提示

### 制約

- $ 4\leq\ N\ \leq\ 300 $
- $ 4\leq\ M\ \leq\ \frac{N(N-1)}{2} $
- $ 1\ \leq\ A_i\ <\ B_i\ \leq\ N $
- $ i\ \neq\ j $ ならば $ (A_i,B_i)\ \neq\ (A_j,B_j) $
- $ 1\ \leq\ C_i\ \leq\ 10^5 $
- 入力は全て整数
 
### Sample Explanation 1

辺 $ 2,3,4,5,6 $ を黒く塗ると、 - 辺 $ 2,4,5,6 $ が $ 1 $ つの単純サイクルをなす - 辺 $ 3 $ が頂点 $ 3 $（上記のサイクルに含まれる）と頂点 $ 1 $（上記のサイクルに含まれない）を結ぶ ため、総コスト $ 4+5+3+2+1=15 $ で Q を作ることができます。 他の方法で Q を作っても総コストは $ 15 $ 以上かかるため、答えは $ 15 $ です。

## 样例 #1

### 输入

```
5 6

1 2 6

2 3 4

1 3 5

2 4 3

4 5 2

3 5 1
```

### 输出

```
15
```

## 样例 #2

### 输入

```
4 4

1 2 1

2 3 1

3 4 1

1 4 1
```

### 输出

```
-1
```

## 样例 #3

### 输入

```
6 15

2 6 48772

2 4 36426

1 6 94325

3 6 3497

2 3 60522

4 5 63982

4 6 4784

1 2 14575

5 6 68417

1 5 7775

3 4 33447

3 5 90629

1 4 47202

1 3 90081

2 5 79445
```

### 输出

```
78154
```



---

---
title: "[ABC309G] Ban Permutation"
layout: "post"
diff: 省选/NOI-
pid: AT_abc309_g
tag: []
---

# [ABC309G] Ban Permutation

## 题目描述

求长为 $N(N\leq 100)$ 且满足以下条件的排列 $P=(P_1,P_2,...,P_N)$ 的个数：

- $\forall 1\leq i\leq N$，$|P_i-i|\geq X(X\leq 5)$。

## 输入格式

一行两个整数 $N$ 和 $X$，用空格隔开。

## 输出格式

一行一个整数，表示满足条件的排列个数，对 $998244353$ 取模。

## 样例 #1

### 输入

```
3 1
```

### 输出

```
2
```

## 样例 #2

### 输入

```
5 2
```

### 输出

```
4
```

## 样例 #3

### 输入

```
98 5
```

### 输出

```
809422418
```



---

---
title: "[ABC310G] Takahashi And Pass-The-Ball Game"
layout: "post"
diff: 省选/NOI-
pid: AT_abc310_g
tag: []
---

# [ABC310G] Takahashi And Pass-The-Ball Game

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc310/tasks/abc310_g

高橋くんが $ N $ 人います。

$ i $ 番目の高橋くんは、整数 $ A\ _\ i $ とボール $ B\ _\ i $ 個を持っています。

高橋くんたちは $ 1 $ 以上 $ K $ 以下の整数 $ x $ を一様ランダムに選び、次の操作を $ x $ 回繰り返します。

- すべての $ i $ について、$ i $ 番目の高橋くんは $ A\ _\ i $ 番目の高橋くんに自分が持っているボールをすべて渡す。
 
操作は $ N $ 人によって同時に行われることに注意してください。

$ i=1,2,\ldots,N $ について、一連の操作が終了したとき $ i $ 番目の高橋くんが持っているボールの個数の期待値を $ {}\bmod{998244353} $ で求めてください。

 期待値 $ {}\bmod{998244353} $ の定義 この問題で求める期待値は必ず有理数になることが証明できます。 また、この問題の制約下では、求める期待値を既約分数 $ \frac\ yx $ で表したときに $ x $ が $ 998244353 $ で割り切れないことが保証されます。 このとき、$ y\equiv\ xz\pmod{998244353} $ を満たす $ 0\leq\ z\lt998244353 $ がただ一つ存在するので、$ z $ を出力してください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ K $ $ A\ _\ 1 $ $ A\ _\ 2 $ $ \cdots $ $ A\ _\ N $ $ B\ _\ 1 $ $ B\ _\ 2 $ $ \cdots $ $ B\ _\ N $

## 输出格式

$ i=1,2,\ldots,N $ について、操作が終了したとき $ i $ 番目の高橋くんが持っているボールの個数の期待値を空白区切りで $ 1 $ 行に出力せよ。

## 说明/提示

### 制約

- $ 1\leq\ N\leq\ 2\times10^5 $
- $ 1\leq\ K\leq\ 10^{18} $
- $ K $ は $ 998244353 $ の倍数でない
- $ 1\leq\ A\ _\ i\leq\ N\ (1\leq\ i\leq\ N) $
- $ 0\leq\ B\ _\ i\lt998244353\ (1\leq\ i\leq\ N) $
- 入力はすべて整数
 
### Sample Explanation 1

操作を $ 2 $ 回行うと、それぞれの高橋くんが持っているボールは以下のようになります。 !\[\](https://img.atcoder.jp/abc310/eeca44e66744660173a72967840e158a.png) $ x=1 $ が選ばれた場合、それぞれの高橋くんが持っているボールの数は $ 4,0,1,2,5 $ 個です。 $ x=2 $ が選ばれた場合、それぞれの高橋くんが持っているボールの数は $ 2,0,4,1,5 $ 個です。 よって、求める期待値はそれぞれ $ 3,0,\dfrac52,\dfrac32,5 $ です。 $ {}\bmod{998244353} $ での値を求めるとそれぞれ $ 3,0,499122179,499122178,5 $ となるので、これらを順に空白区切りで出力してください。

### Sample Explanation 2

$ 1 $ 回以上操作すると、すべてのボールを $ 1 $ 番目の高橋くんが持つことになります。

## 样例 #1

### 输入

```
5 2

3 1 4 1 5

1 1 2 3 5
```

### 输出

```
3 0 499122179 499122178 5
```

## 样例 #2

### 输入

```
3 1000

1 1 1

1 10 100
```

### 输出

```
111 0 0
```

## 样例 #3

### 输入

```
16 1000007

16 12 6 12 1 8 14 14 5 7 6 5 9 6 10 9

719092922 77021920 539975779 254719514 967592487 476893866 368936979 465399362 342544824 540338192 42663741 165480608 616996494 16552706 590788849 221462860
```

### 输出

```
817852305 0 0 0 711863206 253280203 896552049 935714838 409506220 592088114 0 413190742 0 363914270 0 14254803
```

## 样例 #4

### 输入

```
24 100000000007

19 10 19 15 1 20 13 15 8 23 22 16 19 22 2 20 12 19 17 20 16 8 23 6

944071276 364842194 5376942 671161415 477159272 339665353 176192797 2729865 676292280 249875565 259803120 103398285 466932147 775082441 720192643 535473742 263795756 898670859 476980306 12045411 620291602 593937486 761132791 746546443
```

### 输出

```
918566373 436241503 0 0 0 455245534 0 356196743 0 906000633 0 268983266 21918337 0 733763572 173816039 754920403 0 273067118 205350062 0 566217111 80141532 0
```



---

---
title: "[ABC320G] Slot Strategy 2 (Hard)"
layout: "post"
diff: 省选/NOI-
pid: AT_abc320_g
tag: []
---

# [ABC320G] Slot Strategy 2 (Hard)

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc320/tasks/abc320_g

> この問題は C 問題の強化版です。リールの個数が $ 3 $ 個から $ N $ 個になり、$ M $ の上限が大きくなっています。

$ N $ 個のリールからなるスロットがあります。  
$ i $ 番目のリールの配列は文字列 $ S_i $ によって表されます。ここで、$ S_i $ は数字のみからなる長さ $ M $ の文字列です。

それぞれのリールには対応するボタンがついています。高橋君は各非負整数 $ t $ について、スロットが回り始めてからちょうど $ t $ 秒後にボタンを $ 1 $ つ選んで押す、または何もしないことができます。  
スロットが回り始めてから $ t $ 秒後に $ i $ 番目のリールに対応するボタンを押すと、$ i $ 番目のリールは $ S_i $ の $ (t\ \bmod\ M)+1 $ 文字目を表示して止まります。  
ただし、$ t\ \bmod\ M $ で $ t $ を $ M $ で割ったあまりを表します。

高橋君は全てのリールを止めた上で、表示されている文字が全て同じであるようにしたいです。  
高橋君が目標を達成できるように全てのリールを止めるまでに、スロットが回り始めてから最小で何秒かかるかを求めてください。  
そのようなことが不可能であればそのことを報告してください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ M $ $ S_1 $ $ \vdots $ $ S_N $

## 输出格式

全てのリールを止めた上で、表示されている文字が全て同じであるようにすることができないなら `-1` を出力せよ。  
できるなら、スロットが回り始めてからそのような状態にするまでに最小で何秒かかるか出力せよ。

## 说明/提示

### 制約

- $ 1\ \leq\ N\ \leq\ 100 $
- $ 1\ \leq\ M\ \leq\ 10^5 $
- $ N,M $ は整数
- $ S_i $ は数字のみからなる長さ $ M $ の文字列

### Sample Explanation 1

高橋君は次のようにそれぞれのリールを止めることでスロットが回り始めてから $ 6 $ 秒後にリールに表示される文字を `8` で揃えることができます。 - スロットの回転開始から $ 0 $ 秒後に $ 2 $ 番目のリールに対応するボタンを押します。$ 2 $ 番目のリールは $ S_2 $ の $ (0\ \bmod\ 10)+1=1 $ 文字目である `8` を表示して止まります。 - スロットの回転開始から $ 2 $ 秒後に $ 3 $ 番目のリールに対応するボタンを押します。$ 3 $ 番目のリールは $ S_3 $ の $ (2\ \bmod\ 10)+1=3 $ 文字目である `8` を表示して止まります。 - スロットの回転開始から $ 6 $ 秒後に $ 1 $ 番目のリールに対応するボタンを押します。$ 1 $ 番目のリールは $ S_1 $ の $ (6\ \bmod\ 10)+1=7 $ 文字目である `8` を表示して止まります。 $ 5 $ 秒以下で全てのリールに表示されている文字を揃える方法はないため、$ 6 $ を出力します。

### Sample Explanation 2

全てのリールを止めた上で、表示されている文字を揃える必要がある事に注意してください。

### Sample Explanation 3

表示されている文字が全て同じであるようにリールを止めることはできません。 このとき `-1` を出力してください。

## 样例 #1

### 输入

```
3 10
1937458062
8124690357
2385760149
```

### 输出

```
6
```

## 样例 #2

### 输入

```
10 20
01234567890123456789
01234567890123456789
01234567890123456789
01234567890123456789
01234567890123456789
01234567890123456789
01234567890123456789
01234567890123456789
01234567890123456789
01234567890123456789
```

### 输出

```
90
```

## 样例 #3

### 输入

```
5 10
0000000000
1111111111
2222222222
3333333333
4444444444
```

### 输出

```
-1
```

## 样例 #4

### 输入

```
10 20
14159265358979323846
26433832795028841971
69399375105820974944
59230781640628620899
86280348253421170679
82148086513282306647
09384460955058223172
53594081284811174502
84102701938521105559
64462294895493038196
```

### 输出

```
11
```



---

---
title: "[ABC322G] Two Kinds of Base"
layout: "post"
diff: 省选/NOI-
pid: AT_abc322_g
tag: []
---

# [ABC322G] Two Kinds of Base

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc322/tasks/abc322_g

非負整数列 $ S=(S_1,S_2,\dots,S_k) $ と整数 $ a $ に対して、以下のように関数 $ f(S,a) $ を定義します。

- $ f(S,a)\ =\ \sum_{i=1}^{k}\ S_i\ \times\ a^{k\ -\ i} $
 
例えば、$ f((1,2,3),4)\ =\ 1\ \times\ 4^2\ +\ 2\ \times\ 4^1\ +\ 3\ \times\ 4^0\ =\ 27,f((1,1,1,1),10)\ =\ 1\ \times\ 10^3\ +\ 1\ \times\ 10^2\ +\ 1\ \times\ 10^1\ +\ 1\ \times\ 10^0\ =\ 1111 $ です。

正整数 $ N,X $ が与えられます。以下の条件を全て満たす非負整数列 $ S=(S_1,S_2,\dots,S_k) $ と正整数 $ a,b $ の組 $ (S,a,b) $ の個数を $ 998244353 $ で割ったあまりを求めてください。

- $ k\ \ge\ 1 $
- $ a,b\ \le\ N $
- $ S_1\ \neq\ 0 $
- $ S_i\ <\ \min(10,a,b)(1\ \le\ i\ \le\ k) $
- $ f(S,a)\ -\ f(S,b)\ =\ X $

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ X $

## 输出格式

条件を満たす非負整数列 $ S $ と正整数 $ a,b $ の組 $ (S,a,b) $ の個数を $ 998244353 $ で割ったあまりを出力せよ。

## 说明/提示

### 制約

- $ 1\ \le\ N\ \le\ 10^9 $
- $ 1\ \le\ X\ \le\ 2\ \times\ 10^5 $
- 入力は全て整数
 
### Sample Explanation 1

$ (S,a,b)=((1,0),4,2),((1,1),4,2),((2,0),4,3),((2,1),4,3),((2,2),4,3) $ の $ 5 $ 通りが条件を満たします。

## 样例 #1

### 输入

```
4 2
```

### 输出

```
5
```

## 样例 #2

### 输入

```
9 30
```

### 输出

```
31
```

## 样例 #3

### 输入

```
322322322 200000
```

### 输出

```
140058961
```



---

---
title: "[ABC324G] Generate Arrays"
layout: "post"
diff: 省选/NOI-
pid: AT_abc324_g
tag: []
---

# [ABC324G] Generate Arrays

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc324/tasks/abc324_g

高橋くんは、長さ $ N $ の数列 $ A=(A\ _\ 1,A\ _\ 2,\ldots,A\ _\ N) $ を持っています。 $ A $ は $ (1,2,\ldots,N) $ の順列です。

高橋くんは、操作を $ Q $ 回行って、$ 1+Q $ 個の数列を作ろうとしています。 **$ 0 $ 番の数列を $ A $ として**、高橋くんは一連の操作を始めます。 $ i $ 回目 $ (1\leq\ i\leq\ Q) $ の操作は、整数の $ 3 $ つ組 $ (t\ _\ i,s\ _\ i,x\ _\ i) $ を用いて表され、次のような操作に対応します（ 入出力例の説明も参考にしてください）。

- $ t\ _\ i=1 $ のとき、高橋くんは $ s\ _\ i $ 番 $ (0\leq\ s\ _\ i\lt\ i) $ の数列から $ x\ _\ i $ 個目より後の要素を取り除き、取り除いた要素を順序を保って新しく $ i $ 番の数列とする。
- $ t\ _\ i=2 $ のとき、高橋くんは $ s\ _\ i $ 番 $ (0\leq\ s\ _\ i\lt\ i) $ の数列から値が $ x\ _\ i $ より大きい要素を取り除き、取り除いた要素を順序を保って新しく $ i $ 番の数列とする。

ただし、長さ $ L $ の数列 $ X $ について、$ X $ のどの要素も「$ 0 $ 個目より後の要素」です。 また、$ L\leq\ l $ を満たす任意の $ l $ について $ X $ のどの要素も「$ l $ 個目より後の要素」ではありません。

$ i=1,2,\ldots,Q $ について、$ i $ 回目の操作が終わった**直後**の $ i $ 番の数列の長さを求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ A\ _\ 1 $ $ A\ _\ 2 $ $ \ldots $ $ A\ _\ N $ $ Q $ $ t\ _\ 1 $ $ s\ _\ 1 $ $ x\ _\ 1 $ $ t\ _\ 2 $ $ s\ _\ 2 $ $ x\ _\ 2 $ $ \vdots $ $ t\ _\ Q $ $ s\ _\ Q $ $ x\ _\ Q $

## 输出格式

答えを $ Q $ 行で出力せよ。 $ i $ 行目 $ (1\leq\ i\leq\ Q) $ には、$ i $ 回目の操作が終わった直後における $ i $ 番の列の長さを出力せよ。

## 说明/提示

### 制約

- $ 1\leq\ N\leq2\times10^5 $
- $ 1\leq\ A\ _\ i\leq\ N\ (1\leq\ i\leq\ N) $
- $ A\ _\ i\neq\ A\ _\ j\ (1\leq\ i\lt\ j\leq\ N) $
- $ 1\leq\ Q\leq2\times10^5 $
- $ t\ _\ i=1,2\ (1\leq\ i\leq\ Q) $
- $ 0\leq\ s\ _\ i\lt\ i\ (1\leq\ i\leq\ Q) $
- $ 0\leq\ x\ _\ i\leq\ N\ (1\leq\ i\leq\ Q) $
- 入力はすべて整数

### Sample Explanation 1

はじめ、高橋くんは長さ $ 10 $ の数列 $ A=(1,8,7,4,5,6,3,2,9,10) $ を持っています。 高橋くんは、$ 0 $ 番の数列を $ A=(1,8,7,4,5,6,3,2,9,10) $ として一連の操作を開始します。 $ 1 $ 回目の操作では、$ 0 $ 番の数列の $ 4 $ より大きな要素 $ 8,7,5,6,9,10 $ を取り除き、これらを新しく $ 1 $ 番の数列にします。この操作が終わったとき、$ 0,1 $ 番の数列はそれぞれ $ (1,4,3,2),(8,7,5,6,9,10) $ になります。 $ 2 $ 回目の操作では、$ 1 $ 番の数列の $ 2 $ 個目より後の要素 $ 5,6,9,10 $ を取り除き、これらを新しく $ 2 $ 番の数列にします。この操作が終わったとき、$ 0,1,2 $ 番の数列はそれぞれ $ (1,4,3,2),(8,7),(5,6,9,10) $ になります。 $ 3 $ 回目以降の操作について、$ i $ 回目の操作が終わったときの $ 0,1,2,\ldots,i $ 番の数列はそれぞれ以下のようになります。 - $ (1,2),(8,7),(5,6,9,10),(4,3) $ - $ (1,2),(8,7),(5),(4,3),(6,9,10) $ - $ (1),(8,7),(5),(4,3),(6,9,10),(2) $ $ i=1,2,\ldots,5 $ 回目の操作が終わったときの $ i $ 番の数列の長さはそれぞれ $ 6,4,2,3,1 $ なので、これらをそれぞれの行に出力してください。

### Sample Explanation 2

操作の結果、空の数列が生じることもあります。

## 样例 #1

### 输入

```
10
1 8 7 4 5 6 3 2 9 10
5
2 0 4
1 1 2
2 0 2
2 2 5
1 0 1
```

### 输出

```
6
4
2
3
1
```

## 样例 #2

### 输入

```
8
6 7 8 4 5 1 3 2
5
2 0 0
1 1 0
2 2 0
1 3 8
2 2 3
```

### 输出

```
8
8
8
0
0
```

## 样例 #3

### 输入

```
30
20 6 13 11 29 30 9 10 16 5 8 25 1 19 12 18 7 2 4 27 3 22 23 24 28 21 14 26 15 17
10
1 0 22
1 0 21
2 0 15
1 0 9
1 3 6
2 3 18
1 6 2
1 0 1
2 5 20
2 7 26
```

### 输出

```
8
1
8
4
2
5
3
8
1
1
```



---

---
title: "[ABC326G] Unlock Achievement"
layout: "post"
diff: 省选/NOI-
pid: AT_abc326_g
tag: []
---

# [ABC326G] Unlock Achievement

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc326/tasks/abc326_g

$ 1 $ から $ N $ の番号がついた $ N $ 種類のスキルと、$ 1 $ から $ M $ の番号がついた $ M $ 種類のアチーブメントがあります。

各スキルには正整数のレベルが定まっており、最初全てのスキルのレベルは $ 1 $ です。

$ C_i $ 円のコストを払うことでスキル $ i $ のレベルを $ 1 $ 上げることができます。これは何度でも行なえます。

アチーブメント $ i $ は、$ j=1,\ldots,N $ の全てについて以下の条件を満たすと達成となり、$ A_i $ 円の報酬をもらえます。

- 条件：スキル $ j $ のレベルが $ L_{i,j} $ 以上である
 
スキルのレベルの上げ方を適切に選ぶとき、得られる報酬の合計から必要なコストの合計を引いた値の最大値を求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ M $ $ C_1 $ $ \ldots $ $ C_N $ $ A_1 $ $ \ldots $ $ A_M $ $ L_{1,1} $ $ \ldots $ $ L_{1,N} $ $ \vdots $ $ L_{M,1} $ $ \ldots $ $ L_{M,N} $

## 输出格式

答えを整数として出力せよ。

## 说明/提示

### 制約

- $ 1\ \leq\ N,M\ \leq\ 50 $
- $ 1\ \leq\ L_{i,j}\ \leq\ 5 $
- $ 1\ \leq\ A_i,C_i\ \leq\ 10^6 $
- 入力は全て整数である
 
### Sample Explanation 1

$ 2 $ 種類のスキルがあります。スキル $ 1 $ はレベルを上げるために $ 10 $ 円、スキル $ 2 $ は $ 20 $ 円かかります。 $ 2 $ 種類のアチーブメントがあります。 アチーブメント $ 1 $ は「スキル $ 1 $ をレベル $ 3 $ 以上、かつ、スキル $ 2 $ をレベル $ 1 $ 以上」にすると達成となり $ 100 $ 円もらえ、 アチーブメント $ 2 $ は「スキル $ 1 $ をレベル $ 1 $ 以上、かつ、スキル $ 2 $ をレベル $ 4 $ 以上」にすると達成となり $ 50 $ 円もらえます。 スキル $ 1 $ をレベル $ 3 $ に、スキル $ 2 $ をレベル $ 1 $ にすることで、報酬が $ 100 $ 円、コストが $ 20 $ 円となり、その差は $ 80 $ 円となります。

### Sample Explanation 2

スキル $ 1 $ をレベル $ 3 $ に、スキル $ 2 $ をレベル $ 4 $ にすることで、報酬が $ 150 $ 円、コストが $ 80 $ 円となり、その差は $ 70 $ 円となります。

## 样例 #1

### 输入

```
2 2

10 20

100 50

3 1

1 4
```

### 输出

```
80
```

## 样例 #2

### 输入

```
2 2

10 20

100 50

3 2

1 4
```

### 输出

```
70
```

## 样例 #3

### 输入

```
10 10

10922 23173 32300 22555 29525 16786 3135 17046 11245 20310

177874 168698 202247 31339 10336 14825 56835 6497 12440 110702

2 1 4 1 3 4 4 5 1 4

2 3 4 4 5 3 5 5 2 3

2 3 5 1 4 2 2 2 2 5

3 5 5 3 5 2 2 1 5 4

3 1 1 4 4 1 1 5 3 1

1 2 3 2 4 2 4 3 3 1

4 4 4 2 5 1 4 2 2 2

5 3 1 2 3 4 2 5 2 2

5 4 3 4 3 1 5 1 5 4

2 3 2 5 2 3 1 2 2 4
```

### 输出

```
66900
```



---

---
title: "[ABC327G] Many Good Tuple Problems"
layout: "post"
diff: 省选/NOI-
pid: AT_abc327_g
tag: []
---

# [ABC327G] Many Good Tuple Problems

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc327/tasks/abc327_g

> この問題における良い数列の組の定義は D 問題と同じです。

$ N $ 以下の正整数からなる長さ $ M $ の数列の組 $ (S,\ T)\ =\ ((S_1,\ S_2,\ \dots,\ S_M),\ (T_1,\ T_2,\ \dots,\ T_M)) $ が **良い数列の組である** とは、$ (S,\ T) $ が次の条件を満たすことを言います。

- $ 0,1 $ からなる長さ $ N $ の数列 $ X\ =\ (X_1,\ X_2,\ \dots,\ X_N) $ であって次の条件を満たすものが存在する。
  - $ i=1,\ 2,\ \dots,\ M $ それぞれについて、$ X_{S_i}\ \neq\ X_{T_i} $ が成立する。
 
$ N $ 以下の正整数からなる長さ $ M $ の数列の組 $ (A,\ B)\ =\ ((A_1,\ A_2,\ \dots,\ A_M),\ (B_1,\ B_2,\ \dots,\ B_M)) $ としてあり得るものは $ N^{2M} $ 通りありますが、そのような数列の組のうち良い数列の組であるものの個数を $ 998244353 $ で割った余りを求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ M $

## 输出格式

$ N $ 以下の正整数からなる長さ $ M $ の数列の組のうち、良い数列の組であるものの個数を $ 998244353 $ で割った余りを出力せよ。

## 说明/提示

### 制約

- $ 1\ \leq\ N\ \leq\ 30 $
- $ 1\ \leq\ M\ \leq\ 10^9 $
- $ N,\ M $ は整数
 
### Sample Explanation 1

例えば $ A=(1,2),\ B=(2,3) $ のとき $ (A,\ B) $ は良い数列の組です。$ X=(0,1,0) $ とすると、$ X $ は $ 0,1 $ からなる長さ $ N $ の数列で、 $ X_{A_1}\ \neq\ X_{B_1} $ かつ $ X_{A_2}\ \neq\ X_{B_2} $ を満たします。よって、$ (A,B) $ は良い数列の組としての条件を満たしています。 良い数列の組は全部で $ 36 $ 個あるので、これを出力します。

## 样例 #1

### 输入

```
3 2
```

### 输出

```
36
```

## 样例 #2

### 输入

```
3 3
```

### 输出

```
168
```

## 样例 #3

### 输入

```
12 34
```

### 输出

```
539029838
```

## 样例 #4

### 输入

```
20 231104
```

### 输出

```
966200489
```



---

---
title: "[ABC332G] Not Too Many Balls"
layout: "post"
diff: 省选/NOI-
pid: AT_abc332_g
tag: []
---

# [ABC332G] Not Too Many Balls

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc332/tasks/abc332_g

いくつかのボールがあります。 各ボールは色 $ 1 $ 、色 $ 2 $ 、$ \ldots $ 、色 $ N $ のうちのいずれかであり、 $ i\ =\ 1,\ 2,\ \ldots,\ N $ について、色 $ i $ のボールは全部で $ A_i $ 個あります。

また、$ M $ 個の箱があります。 $ j\ =\ 1,\ 2,\ \ldots,\ M $ について、$ j $ 番目の箱には合計で $ B_j $ 個までのボールを入れることができます。

ただし、$ 1\ \leq\ i\ \leq\ N $ と $ 1\ \leq\ j\ \leq\ M $ を満たすすべての整数の組 $ (i,\ j) $ について、 色 $ i $ のボールを $ j $ 番目の箱に入れる個数は $ (i\ \times\ j) $ 個以下でなければなりません。

$ M $ 個の箱の中に入れることができるボールの合計個数の最大値を出力してください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ M $ $ A_1 $ $ A_2 $ $ \ldots $ $ A_N $ $ B_1 $ $ B_2 $ $ \ldots $ $ B_M $

## 输出格式

答えを出力せよ。

## 说明/提示

### 制約

- 入力される値は全て整数
- $ 1\ \leq\ N\ \leq\ 500 $
- $ 1\ \leq\ M\ \leq\ 5\ \times\ 10^5 $
- $ 0\ \leq\ A_i,\ B_i\ \leq\ 10^{12} $
 
### Sample Explanation 1

下記の通りにボールを箱に入れることで、問題文中の条件を満たした上で合計 $ 14 $ 個のボールを箱に入れることができます。 - 色 $ 1 $ のボールを、$ 1 $ 番目の箱に $ 1 $ 個、$ 2 $ 番目の箱に $ 1 $ 個、$ 3 $ 番目の箱に $ 3 $ 個入れる。 - 色 $ 2 $ のボールを、$ 1 $ 番目の箱に $ 2 $ 個、$ 2 $ 番目の箱に $ 2 $ 個、$ 3 $ 番目の箱に $ 5 $ 個入れる。

## 样例 #1

### 输入

```
2 3

8 10

4 3 8
```

### 输出

```
14
```

## 样例 #2

### 输入

```
1 1

1000000000000

0
```

### 输出

```
0
```

## 样例 #3

### 输入

```
10 12

59 168 130 414 187 236 330 422 31 407

495 218 351 105 351 414 198 230 345 297 489 212
```

### 输出

```
2270
```



---

---
title: "[ABC335G] Discrete Logarithm Problems"
layout: "post"
diff: 省选/NOI-
pid: AT_abc335_g
tag: []
---

# [ABC335G] Discrete Logarithm Problems

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc335/tasks/abc335_g

$ N $ 個の整数 $ A_1,\ldots,A_N $ と素数 $ P $ が与えられます。 次の条件をともに満たす整数の組 $ (i,j) $ の個数を求めてください。

- $ 1\ \leq\ i,j\ \leq\ N $
- ある正整数 $ k $ が存在し、$ A_i^k\ \equiv\ A_j\ \bmod\ P $

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ P $ $ A_1 $ $ \ldots $ $ A_N $

## 输出格式

答えを出力せよ。

## 说明/提示

### 制約

- $ 2\ \leq\ N\ \leq\ 2\ \times\ 10^5 $
- $ 1\ \leq\ A_i\ <\ P $
- $ 2\ \leq\ P\ \leq\ 10^{13} $
- $ P $ は素数
- 入力は全て整数
 
### Sample Explanation 1

$ (1,1),(1,2),(1,3),(2,2),(3,3) $ の $ 5 $ 組が条件を満たします。 例えば $ (1,3) $ については、$ k=9 $ とすると $ A_1^9\ =\ 512\ \equiv\ 5\ =\ A_3\ \bmod\ 13 $ となります。

## 样例 #1

### 输入

```
3 13

2 3 5
```

### 输出

```
5
```

## 样例 #2

### 输入

```
5 2

1 1 1 1 1
```

### 输出

```
25
```

## 样例 #3

### 输入

```
10 9999999999971

141592653589 793238462643 383279502884 197169399375 105820974944 592307816406 286208998628 34825342117 67982148086 513282306647
```

### 输出

```
63
```



---

---
title: "[ABC336G] 16 Integers"
layout: "post"
diff: 省选/NOI-
pid: AT_abc336_g
tag: []
---

# [ABC336G] 16 Integers

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc336/tasks/abc336_g

$ 16 $ 個の非負整数 $ X_{i,\ j,\ k,\ l} $ $ (i,\ j,\ k,\ l\ \in\ \lbrace\ 0,\ 1\ \rbrace) $ が $ (i,\ j,\ k,\ l) $ の昇順に与えられます。  
 また、$ N\ =\ \displaystyle\ \sum_{i=0}^1\ \sum_{j=0}^1\ \sum_{k=0}^1\ \sum_{l=0}^1\ X_{i,j,k,l} $ とします。  
 $ 0 $ または $ 1 $ からなる長さ $ N\ +\ 3 $ の数列 $ (A_1,\ A_2,\ ...,\ A_{N+3}) $ のうち、次の条件を満たすものの個数を $ 998244353 $ で割った余りを求めてください。

- 整数の $ 4 $ つ組 $ (i,\ j,\ k,\ l) $ $ (i,\ j,\ k,\ l\ \in\ \lbrace\ 0,\ 1\ \rbrace) $ 全てについて、次の条件を満たす $ 1 $ 以上 $ N $ 以下の整数 $ s $ はちょうど $ X_{i,j,k,l} $ 個存在する。
  - $ A_s\ =\ i,\ A_{s\ +\ 1}\ =\ j,\ A_{s\ +\ 2}\ =\ k,\ A_{s\ +\ 3}\ =\ l $ である。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ X_{0,0,0,0} $ $ X_{0,0,0,1} $ $ X_{0,0,1,0} $ $ X_{0,0,1,1} $ $ X_{0,1,0,0} $ $ X_{0,1,0,1} $ $ X_{0,1,1,0} $ $ X_{0,1,1,1} $ $ X_{1,0,0,0} $ $ X_{1,0,0,1} $ $ X_{1,0,1,0} $ $ X_{1,0,1,1} $ $ X_{1,1,0,0} $ $ X_{1,1,0,1} $ $ X_{1,1,1,0} $ $ X_{1,1,1,1} $

## 输出格式

問題文の条件を満たす数列の個数を $ 998244353 $ で割った余りを出力せよ。

## 说明/提示

### 制約

- $ X_{i,\ j,\ k,\ l} $ は全て非負整数
- $ 1\ \leq\ \displaystyle\ \sum_{i=0}^1\ \sum_{j=0}^1\ \sum_{k=0}^1\ \sum_{l=0}^1\ X_{i,j,k,l}\ \leq\ 10^6 $
 
### Sample Explanation 1

この入力は、 $ X_{1,\ 0,\ 1,\ 0} $ と $ X_{1,\ 1,\ 0,\ 1} $ が $ 1 $ でそれ以外は $ 0 $ であるような入力です。 このとき、条件を満たす数列は $ (1,\ 1,\ 0,\ 1,\ 0) $ の $ 1 $ 通りのみです。

## 样例 #1

### 输入

```
0 0 0 0 0 0 0 0 0 0 1 0 0 1 0 0
```

### 输出

```
1
```

## 样例 #2

### 输入

```
1 1 2 0 1 2 1 1 1 1 1 2 1 0 1 0
```

### 输出

```
16
```

## 样例 #3

### 输入

```
21 3 3 0 3 0 0 0 4 0 0 0 0 0 0 0
```

### 输出

```
2024
```

## 样例 #4

### 输入

```
62 67 59 58 58 69 57 66 67 50 68 65 59 64 67 61
```

### 输出

```
741536606
```



---

---
title: "[ABC338G] evall"
layout: "post"
diff: 省选/NOI-
pid: AT_abc338_g
tag: []
---

# [ABC338G] evall

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc338/tasks/abc338_g

文字列 $ S $ が与えられます。$ S $ の各文字は `123456789+*` のいずれかで、$ S $ の先頭と末尾の文字は数字であり、$ S $ の中で数字でない文字どうしが隣接することはありません。

整数の組 $ i,\ j $（$ 1\ \leq\ i\ \leq\ j\ \leq\ |S| $）に対して、$ \mathrm{eval}(S_{i..j}) $ を以下のように定義します。

- $ S $ の $ i $ 文字目と $ j $ 文字目がともに数字であれば、$ \mathrm{eval}(S_{i..j}) $ は $ S $ の $ i $ 文字目から $ j $ 文字目まで（両端含む）を通常の数式として評価した結果とする（`*` は乗算とする）。例えば、$ S\ = $ `1+2*151` のとき、$ \mathrm{eval}(S_{1..6})\ =\ 1\ +\ 2\ \times\ 15\ =\ 31 $ である。
- そうでなければ、$ \mathrm{eval}(S_{i..j}) $ は $ 0 $ とする。
 
$ {\displaystyle\ \sum_{i=1}^{|S|}\ \sum_{j=i}^{|S|}\ \mathrm{eval}(S_{i..j})} $ を $ 998244353 $ で割ったあまりを求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ S $

## 输出格式

$ {\displaystyle\ \sum_{i=1}^{|S|}\ \sum_{j=i}^{|S|}\ \mathrm{eval}(S_{i..j})} $ を $ 998244353 $ で割ったあまりを出力せよ。

## 说明/提示

### 制約

- $ 1\ \leq\ |S|\ \leq\ 10^6 $
- $ S $ の各文字は `123456789+*` のいずれかである。
- $ S $ の先頭と末尾の文字は数字である。
- $ S $ の中で数字でない文字どうしが隣接することはない。
 
### Sample Explanation 1

$ \mathrm{eval}(S_{i..j}) $ が $ 0 $ でない場合は以下の通りです。 - $ \mathrm{eval}(S_{1..1})\ =\ 1 $ - $ \mathrm{eval}(S_{1..3})\ =\ 1\ +\ 2\ =\ 3 $ - $ \mathrm{eval}(S_{1..5})\ =\ 1\ +\ 2\ \times\ 3\ =\ 7 $ - $ \mathrm{eval}(S_{1..6})\ =\ 1\ +\ 2\ \times\ 34\ =\ 69 $ - $ \mathrm{eval}(S_{3..3})\ =\ 2 $ - $ \mathrm{eval}(S_{3..5})\ =\ 2\ \times\ 3\ =\ 6 $ - $ \mathrm{eval}(S_{3..6})\ =\ 2\ \times\ 34\ =\ 68 $ - $ \mathrm{eval}(S_{5..5})\ =\ 3 $ - $ \mathrm{eval}(S_{5..6})\ =\ 34 $ - $ \mathrm{eval}(S_{6..6})\ =\ 4 $ 以上の合計は $ 1+3+7+69+2+6+68+3+34+4\ =\ 197 $ です。

## 样例 #1

### 输入

```
1+2*34
```

### 输出

```
197
```

## 样例 #2

### 输入

```
338*3338*33338*333338+3333338*33333338+333333338
```

### 输出

```
527930018
```



---

---
title: "[ABC351G] Hash on Tree"
layout: "post"
diff: 省选/NOI-
pid: AT_abc351_g
tag: ['O2优化']
---

# [ABC351G] Hash on Tree

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc351/tasks/abc351_g

頂点に $ 1 $ から $ N $ の番号がついた $ N $ 頂点の根付き木があります。  
 頂点 $ 1 $ が根で、頂点 $ i $ $ (2\ \leq\ i\ \leq\ N) $ の親は頂点 $ p_i $ です。$ (p_i\ \lt\ i) $  
 また、数列 $ A\ =\ (A_1,\ A_2,\ \dots,\ A_N) $ があります。

根付き木の **ハッシュ値** を次の手順によって得られる値とします。

- $ f(n) $ $ (1\ \leq\ n\ \leq\ N) $ を $ n\ =\ N,\ N-1,\ \dots,\ 2,\ 1 $ の順に次の計算をすることで得られる値とする。
  - 頂点 $ n $ が葉の場合、$ f(n)\ =\ A_n $ とする。
  - 頂点 $ n $ が葉でない場合、$ n $ の子からなる集合を $ C(n) $ として $ \displaystyle\ f(n)\ =\ A_n\ +\ \prod_{c\ \in\ C(n)}\ f(c) $ とする。
- $ f(1)\ \bmod{998244353} $ を根付き木のハッシュ値とする。
 
$ Q $ 個のクエリを与えられる順に処理してください。  
 各クエリでは $ v,\ x $ が与えられるので、$ A_v $ の値を $ x $ に更新した後、根付き木のハッシュ値を求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。ここで $ \mathrm{query}_i $ は $ i $ 番目のクエリを意味する。

> $ N $ $ Q $ $ p_2 $ $ p_3 $ $ \dots $ $ p_N $ $ A_1 $ $ A_2 $ $ \dots $ $ A_N $ $ \mathrm{query}_1 $ $ \mathrm{query}_2 $ $ \vdots $ $ \mathrm{query}_Q $

各クエリは次の形式で与えられる。

> $ v $ $ x $

## 输出格式

$ Q $ 行出力せよ。$ i $ 行目には $ i $ 番目のクエリの答えを出力せよ。

## 说明/提示

### 制約

- $ 2\ \leq\ N\ \leq\ 2\ \times\ 10^5 $
- $ 1\ \leq\ Q\ \leq\ 2\ \times\ 10^5 $
- $ 1\ \leq\ p_i\ \lt\ i $
- $ 0\ \leq\ A_i\ \lt\ 998244353 $
- $ 1\ \leq\ v\ \leq\ N $
- $ 0\ \leq\ x\ \lt\ 998244353 $
- 入力される値は全て整数
 
### Sample Explanation 1

はじめ、$ A\ =\ (3,\ 5,\ 1) $ です。 $ 1 $ 番目のクエリは次のように処理されます。 - $ A_3 $ を $ 4 $ に更新する。$ A\ =\ (3,\ 5,\ 4) $ となる。 - 根付き木のハッシュ値は以下の手順により $ 23 $ となるので、これを出力する。 - 頂点 $ 3 $ は子を持たない。よって $ f(3)\ =\ 4 $ である。 - 頂点 $ 2 $ は子を持たない。よって $ f(2)\ =\ 5 $ である。 - 頂点 $ 1 $ は頂点 $ 2,\ 3 $ を子に持つ。よって $ f(1)\ =\ 3\ +\ 5\ \times\ 4\ =\ 23 $ である。 - $ f(1)\ \bmod{998244353}\ =\ 23 $ を根付き木のハッシュ値とする。 $ 2 $ 番目のクエリは次のように処理されます。 - $ A_2 $ を $ 1 $ に更新する。$ A\ =\ (3,\ 1,\ 4) $ となる。 - 根付き木のハッシュ値は以下の手順により $ 7 $ となるので、これを出力する。 - 頂点 $ 3 $ は子を持たない。よって $ f(3)\ =\ 4 $ である。 - 頂点 $ 2 $ は子を持たない。よって $ f(2)\ =\ 1 $ である。 - 頂点 $ 1 $ は頂点 $ 2,\ 3 $ を子に持つ。よって $ f(1)\ =\ 3\ +\ 1\ \times\ 4\ =\ 7 $ である。 - $ f(1)\ \bmod{998244353}\ =\ 7 $ を根付き木のハッシュ値とする。

## 样例 #1

### 输入

```
3 2

1 1

3 5 1

3 4

2 1
```

### 输出

```
23

7
```

## 样例 #2

### 输入

```
5 4

1 1 2 2

2 5 4 4 1

3 3

5 0

4 5

5 2
```

### 输出

```
29

17

17

47
```

## 样例 #3

### 输入

```
10 10

1 2 1 2 5 6 3 5 1

766294629 440423913 59187619 725560240 585990756 965580535 623321125 550925213 122410708 549392044

1 21524934

9 529970099

6 757265587

8 219853537

5 687675301

5 844033519

8 780395611

2 285523485

6 13801766

3 487663184
```

### 输出

```
876873846

952166813

626349486

341294449

466546009

331098453

469507939

414882732

86695436

199797684
```



---

---
title: "[ABC387G] Prime Circuit"
layout: "post"
diff: 省选/NOI-
pid: AT_abc387_g
tag: []
---

# [ABC387G] Prime Circuit

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc387/tasks/abc387_g

頂点に $ 1 $ から $ N $ までの番号がついた $ N $ 頂点の単純無向連結グラフ $ G $ のうち次の条件を満たすものの個数を $ 998244353 $ で割った余りを求めてください。

- $ G $ に含まれる任意の回路の辺数が素数である。  
   ここで回路とは、同じ頂点を $ 2 $ 回以上通ってもよい閉路を意味する。(同じ辺を $ 2 $ 回以上通ってはならない)

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $

## 输出格式

問題文の条件を満たす単純無向連結グラフ $ G $ の個数を $ 998244353 $ で割った余りを出力せよ。

## 说明/提示

### 制約

- $ N $ は $ 1 $ 以上 $ 2.5\ \times\ 10^5 $ 以下の整数

### Sample Explanation 1

条件を満たすグラフ $ G $ は以下の $ 4 $ 個です。 - $ (1,\ 2),\ (1,\ 3) $ を辺集合に持つグラフ - $ (1,\ 2),\ (2,\ 3) $ を辺集合に持つグラフ - $ (1,\ 3),\ (2,\ 3) $ を辺集合に持つグラフ - $ (1,\ 2),\ (1,\ 3),\ (2,\ 3) $ を辺集合に持つグラフ

## 样例 #1

### 输入

```
3
```

### 输出

```
4
```

## 样例 #2

### 输入

```
2025
```

### 输出

```
879839321
```

## 样例 #3

### 输入

```
61261
```

### 输出

```
202537766
```



---

---
title: "[ABC389G] Odd Even Graph"
layout: "post"
diff: 省选/NOI-
pid: AT_abc389_g
tag: []
---

# [ABC389G] Odd Even Graph

## 题目描述

给你一个正偶数 $N$ 和一个质数 $P$，对于 $M=N-1,\dots,\frac{N(N-1)}{2}$，回答以下问题：

+ 有多少个 $N$ 个点 $M$ 条边的连通无向图（点编号 $1$ 至 $N$），满足到 $1$ 号点最短路径长度为偶数的点个数与到 $1$ 号点最短路径长度为奇数的点个数相等，结果对 $P$ 取模。

## 输入格式

一行两个整数，表示 $N$ 和 $P$。

## 输出格式

一行若干个整数，分别表示 $M=N-1,\dots,\frac{N(N-1)}{2}$ 的答案。

## 说明/提示

$2\le N\le 30$，$10^8\le P\le 10^9$，且 $N$ 为偶数，$P$ 为质数。

## 样例 #1

### 输入

```
4 998244353
```

### 输出

```
12 9 3 0
```

## 样例 #2

### 输入

```
6 924844033
```

### 输出

```
810 2100 3060 3030 2230 1210 450 100 10 0 0
```

## 样例 #3

### 输入

```
10 433416647
```

### 输出

```
49218750 419111280 321937732 107111441 372416570 351559278 312484809 334285827 317777667 211471846 58741385 422156135 323887465 54923551 121645733 94354149 346849276 72744827 385773306 163421544 351691775 59915863 430096957 166653801 346330874 185052506 245426328 47501118 7422030 899640 79380 4536 126 0 0 0 0
```



---

---
title: "[ABC390G] Permutation Concatenation"
layout: "post"
diff: 省选/NOI-
pid: AT_abc390_g
tag: []
---

# [ABC390G] Permutation Concatenation

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc390/tasks/abc390_g

正整数 $ N $ が与えられます。

長さ $ N $ の正整数列 $ A=(A_1,A_2,\ldots,A_N) $ に対し $ f(A) $ を次の手順で得られる整数とします。

- $ S $ を空文字列とする。
- $ i=1,2,\ldots,N $ の順番で以下の操作を行う。
  - $ A_i $ を先頭に余分な $ 0 $ を付けない十進数の文字列としてみたものを $ T $ とする。
  - $ S $ の末尾に $ T $ を連結する。
- $ S $ を十進数の整数としてみた値を $ f(A) $ とする。
 
例えば $ A=(1,20,34) $ に対し $ f(A)=12034 $ です。

$ (1,2,\ldots,N) $ の順列 $ P $ は全部で $ N! $ 通りありますが、それら全てに対する $ f(P) $ の総和を $ 998244353 $ で割ったあまりを求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $

## 输出格式

答えを出力せよ。

## 说明/提示

### 制約

- $ 1\le\ N\le\ 2\times\ 10^5 $
- 入力される値は全て整数
 
### Sample Explanation 1

長さ $ 3 $ の順列は $ P=(1,2,3),(1,3,2),(2,1,3),(2,3,1),(3,1,2),(3,2,1) $ の $ 6 $ 通りありますが、それらに対する $ f(P) $ の値はそれぞれ $ f(P)=123,132,213,231,312,321 $ です。よって、 $ 123+132+213+231+312+321=1332 $ を出力してください。

### Sample Explanation 2

$ 998244353 $ で割ったあまりを出力してください。

## 样例 #1

### 输入

```
3
```

### 输出

```
1332
```

## 样例 #2

### 输入

```
390
```

### 输出

```
727611652
```

## 样例 #3

### 输入

```
79223
```

### 输出

```
184895744
```



---

---
title: "Heights and Pairs"
layout: "post"
diff: 省选/NOI-
pid: AT_abl_f
tag: []
---

# Heights and Pairs

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abl/tasks/abl_f

$ 2N $ 人の人 ($ 1 $ 番から $ 2N $ 番まで) がいます。 人 $ i $ の身長は $ h_i $ です。

以下の条件を満たすように、$ N $ 個の人のペアを作る方法は何通りありますか？ 答えを modulo $ 998,244,353 $ で求めてください。

- どの人もちょうど一つのペアに含まれる。
- どのペアも、そのペアに属する二人の人の身長が異なる。

ある $ p $ と $ q $ に対し、人 $ p $ と人 $ q $ がペアになったかどうかが異なる場合、異なる方法であるとみなします。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ h_1 $ $ : $ $ h_{2N} $

## 输出格式

答えを出力せよ。

## 说明/提示

### 制約

- $ 1\ \leq\ N\ \leq\ 50,000 $
- $ 1\ \leq\ h_i\ \leq\ 100,000 $
- 入力は全て整数である。

### Sample Explanation 1

二通りあります: - ペア (人 $ 1 $, 人 $ 3 $) とペア (人 $ 2 $, 人 $ 4 $) を作る。 - ペア (人 $ 1 $, 人 $ 4 $) とペア (人 $ 2 $, 人 $ 3 $) を作る。

## 样例 #1

### 输入

```
2

1

1

2

3
```

### 输出

```
2
```

## 样例 #2

### 输入

```
5

30

10

20

40

20

10

10

30

50

60
```

### 输出

```
516
```



---

---
title: "Keep Distances"
layout: "post"
diff: 省选/NOI-
pid: AT_acl1_d
tag: []
---

# Keep Distances

## 题目描述

[problemUrl]: https://atcoder.jp/contests/acl1/tasks/acl1_d

数直線上に $ N $ 個の点があり，そのうち $ i $ 番目の点は座標 $ X_i $ にあります． これらの点は座標の昇順に番号がついています． つまり，すべての $ i $ ($ 1\ \leq\ i\ \leq\ N-1 $) について，$ X_i\ <\ X_{i+1} $ が成り立ちます. また，整数 $ K $ が与えられます．

$ Q $ 個のクエリを処理してください．

$ i $ 番目のクエリでは，整数 $ L_i,R_i $ が与えられます． ここで，点の集合 $ s $ が**よい**集合であるとは，以下の条件をすべて満たすことを意味します． よい集合の定義がクエリごとに変わることに注意してください．

- $ s $ に含まれる点は，$ X_{L_i},X_{L_i+1},\ldots,X_{R_i} $ のいずれかである．
- $ s $ に含まれるどの異なる $ 2 $ 点についても，その間の距離が $ K $ 以上である．
- $ s $ のサイズは，上記の条件を満たす集合の中で最大である．

各クエリごとに，すべてのよい集合の和集合のサイズを求めてください．

## 输入格式

入力は以下の形式で標準入力から与えられる．

> $ N $ $ K $ $ X_1 $ $ X_2 $ $ \cdots $ $ X_N $ $ Q $ $ L_1 $ $ R_1 $ $ L_2 $ $ R_2 $ $ \vdots $ $ L_Q $ $ R_Q $

## 输出格式

各クエリごとに，すべてのよい集合の和集合のサイズを一行に出力せよ．

## 说明/提示

### 制約

- $ 1\ \leq\ N\ \leq\ 2\ \times\ 10^5 $
- $ 1\ \leq\ K\ \leq\ 10^9 $
- $ 0\ \leq\ X_1\ <\ X_2\ <\ \cdots\ <\ X_N\ \leq\ 10^9 $
- $ 1\ \leq\ Q\ \leq\ 2\ \times\ 10^5 $
- $ 1\ \leq\ L_i\ \leq\ R_i\ \leq\ N $
- 入力は全て整数である．

### Sample Explanation 1

$ 1 $ つめのクエリでは，最大 $ 3 $ つの点を集合に含めることができます． よい集合は，$ \{1,4,7\} $ と $ \{1,4,8\} $ の $ 2 $ つです． よって，すべてのよい集合の和集合のサイズは $ |\{1,4,7,8\}|=4 $ です． $ 2 $ つめのクエリでは，最大 $ 1 $ つの点を集合に含めることができます． よい集合は，$ \{1\} $ と $ \{2\} $ の $ 2 $ つです． よって，すべてのよい集合の和集合のサイズは $ |\{1,2\}|=2 $ です．

## 样例 #1

### 输入

```
5 3

1 2 4 7 8

2

1 5

1 2
```

### 输出

```
4

2
```

## 样例 #2

### 输入

```
15 220492538

4452279 12864090 23146757 31318558 133073771 141315707 263239555 350278176 401243954 418305779 450172439 560311491 625900495 626194585 891960194

5

6 14

1 8

1 13

7 12

4 12
```

### 输出

```
4

6

11

2

3
```



---

---
title: "Shuffle Window"
layout: "post"
diff: 省选/NOI-
pid: AT_acl1_e
tag: []
---

# Shuffle Window

## 题目描述

[problemUrl]: https://atcoder.jp/contests/acl1/tasks/acl1_e

$ (1,\ 2,\ ...,\ N) $ の順列 $ p_1,\ p_2,\ \dots,\ p_N $ と整数 $ K $ が与えられます。 maroonくんは $ i\ =\ 1,\ 2,\ \dots,\ N\ -\ K\ +\ 1 $ について、次の操作を順番に行います。

- $ p_i,\ p_{i\ +\ 1},\ \dots,\ p_{i\ +\ K\ -\ 1} $ を一様ランダムにシャッフルする。

すべての操作の後の数列の転倒数の期待値を求め、$ \bmod\ 998244353 $ で出力してください。

より正確には、期待値が有理数、つまりある既約分数 $ \frac{P}{Q} $ で表せること、更に $ R\ \times\ Q\ \equiv\ P\ \pmod{998244353},\ 0\ \leq\ R\ <\ 998244353 $ を満たす整数 $ R $ が一意に定まることがこの問題の制約より証明できます。よって、この $ R $ を出力してください。

また、数列 $ a_1,\ a_2,\ \dots,\ a_N $ の転倒数とは、$ i\ <\ j,\ a_i\ >\ a_j $ を満たす順序対 $ (i,\ j) $ の個数とします。

## 输入格式

> $ N $ $ K $ $ p_1 $ $ p_2 $ ... $ p_N $

## 输出格式

期待値を $ \bmod\ 998244353 $ で出力せよ。

## 说明/提示

### 制約

- $ 2\ \leq\ N\ \leq\ 200,000 $
- $ 2\ \leq\ K\ \leq\ N $
- $ (p_1,\ p_2,\ \dots,\ p_N) $ は $ (1,\ 2,\ \dots,\ N) $ の並び替え
- 入力される数は全て整数である．

### Sample Explanation 1

$ (1,\ 2,\ 3) $, $ (2,\ 1,\ 3) $, $ (1,\ 3,\ 2) $, $ (2,\ 3,\ 1) $ が、それぞれ $ \frac{1}{4} $ の確率で最終的な数列になります。 これらの転倒数は $ 0,\ 1,\ 1,\ 2 $ なので、期待値は $ 1 $ です。

## 样例 #1

### 输入

```
3 2

1 2 3
```

### 输出

```
1
```

## 样例 #2

### 输入

```
10 3

1 8 4 9 2 3 7 10 5 6
```

### 输出

```
164091855
```



---

---
title: "[AGC001E] BBQ Hard"
layout: "post"
diff: 省选/NOI-
pid: AT_agc001_e
tag: []
---

# [AGC001E] BBQ Hard

## 题目描述

[problemUrl]: https://atcoder.jp/contests/agc001/tasks/agc001_e

高橋君はバーベキューをしようとしています。 バーベキューでは $ 2 $ 本の串にいくつかの具材を刺した*串焼き*を $ 1 $ 個作る予定です。

串焼きセットが $ N $ 個あり、$ i $ 番目のセットには串が $ 1 $ 本、肉が $ A_i $ 個、野菜が $ B_i $ 個入っています。

セットを $ 2 $ 個選び、セット $ 2 $ つに含まれる全ての具材を好きな順番で串 $ 2 $ 本に刺すことを考えます。 このとき、作ることの出来る串焼きは何通り考えられるでしょうか？ ただし、串どうしは区別でき、肉どうしや野菜どうしは区別できないものとします。 答えは非常に大きな数になる可能性があるので、$ 10^9+7 $ で割った余りを求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ A_1 $ $ B_1 $ $ A_2 $ $ B_2 $ : $ A_N $ $ B_N $

## 输出格式

作ることの出来る串焼きの種類数を $ 10^9+7 $ で割った余りを出力せよ。

## 说明/提示

### 制約

- $ 2≦N≦200,000 $
- $ 1≦A_i≦2000,\ 1≦B_i≦2000 $

### Sample Explanation 1

図のような $ 26 $ 通りの串焼きを作ることが出来ます。 灰色の棒は串を表しており、串に書かれた数はその串が含まれていたセットの番号を表しています。 また、茶色の長方形は肉、緑色の長方形は野菜を表しています。 !\[ebbq.png\](https://agc001.contest.atcoder.jp/img/agc/001/Gg9pvPKw/ebbq.png)

## 样例 #1

### 输入

```
3

1 1

1 1

2 1
```

### 输出

```
26
```



---

---
title: "[AGC002F] Leftmost Ball"
layout: "post"
diff: 省选/NOI-
pid: AT_agc002_f
tag: []
---

# [AGC002F] Leftmost Ball

## 题目描述

[problemUrl]: https://atcoder.jp/contests/agc002/tasks/agc002_f





---

---
title: "[AGC005F] Many Easy Problems"
layout: "post"
diff: 省选/NOI-
pid: AT_agc005_f
tag: []
---

# [AGC005F] Many Easy Problems

## 题目描述

[problemUrl]: https://atcoder.jp/contests/agc005/tasks/agc005_f

高橋君はある日青木君から以下の様な問題を貰いました。

- $ N $ 頂点の木と、整数 $ K $ が与えられる。木の頂点は $ 1,2,...,N $ と番号がついているものとし、辺は $ (a_i,\ b_i) $ で表す。
- 頂点の集合 $ S $ について $ f(S) $ を、$ S $ をすべて含む部分木の頂点数の最小値とする
- 木から $ K $ 個の頂点を選ぶ方法は $ _NC_K $ 通りあるが、それぞれについて選んだ頂点を $ S $ とし、 $ f(S) $ の総和を求める
- 答えは大きくなることがあるので、$ 924844033 $(素数) で割ったあまりを出力する

高橋君にとってこの問題は簡単すぎました。なので $ K\ =\ 1,2,...,N $ 全てについてこの問題を解くことにしました。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ a_1 $ $ b_1 $ $ a_2 $ $ b_2 $ : $ a_{N-1} $ $ b_{N-1} $

## 输出格式

$ N $ 行出力する。$ i $ 行目には、$ K=i $ の時の問題の答えを $ 924844033 $ で割ったあまりを出力する。

## 说明/提示

### 制約

- $ 2\ ≦\ N\ ≦\ 200,000 $
- $ 1\ ≦\ a_i,\ b_i\ ≦\ N $
- 与えられるグラフは木である

### Sample Explanation 1

!\[\](https://atcoder.jp/img/agc005/44e2fd5d5e0fe66d1d238ee502639e4e.png) 上図は、$ K=2 $ の場合を図示している。ピンク色の頂点が選んだ頂点で、赤く囲われたのが頂点数最小の部分木である。

## 样例 #1

### 输入

```
3

1 2

2 3
```

### 输出

```
3

7

3
```

## 样例 #2

### 输入

```
4

1 2

1 3

1 4
```

### 输出

```
4

15

13

4
```

## 样例 #3

### 输入

```
7

1 2

2 3

2 4

4 5

4 6

6 7
```

### 输出

```
7

67

150

179

122

45

7
```



---

---
title: "[AGC006F] Blackout"
layout: "post"
diff: 省选/NOI-
pid: AT_agc006_f
tag: []
---

# [AGC006F] Blackout

## 题目描述

我们有一个 $N$ 行 $N$ 列的矩阵。第 $i$ 行第 $j$ 列的格子表示为 $(i,j)$。

开始时，有 $M$ 个格子是黑色，其他格子都是白色。特别地，开始时格子 $(a_{1},b_{1}),(a_{2},b_{2}),\cdots, (a_{M},b_{M})$ 是黑色。

スヌケ君会按照以下的规则尽可能多的将白色格子涂成黑色：

- 对于整数 $1\le x,y,z\le N$，如果 $(x,y)$ 和 $(y,z)$ 都是黑色，那么就把 $(z,x)$ 涂黑。

请计算出当再也没有白色格子能被涂黑时，黑色格子的个数。

## 输入格式

从标准输入输入，格式见下：

第一行包含两个整数 $N$ 和 $M$；

从第二行开始的 $M$ 行，每行有两个以空格隔开的整数 $a_{i}$ 和 $b_{i}$，表示第 $i$ 个黑色格子的坐标。

## 输出格式

输出一个整数到标准输出，表示当スヌケ君尽可能多的把格子涂黑之后，黑色格子的个数。

## 样例解释

#### 样例 1 解释

可以按这样的方法涂黑一个格子：

- 因为格子 $(1,2)$ 和 $(2,3)$ 都是黑色而 $(3,1)$ 是白色，把 $(3,1)$ 涂黑。

#### 样例 2 解释

可以按这样的方法涂黑两个格子：

- 因为格子 $(1,1)$ 和 $(1,2)$ 都是黑色而 $(2,1)$ 是白色，把 $(2,1)$ 涂黑。

- 因为格子 $(2,1)$ 和 $(1,2)$ 都是黑色而 $(2,2)$ 是白色，把 $(2,2)$ 涂黑。

#### 样例 3 解释

很遗憾，没有任何白色格子能被涂黑。

## 说明/提示

- $1\le N \le 10^{5}$
- $1\le M \le 10^{5}$
- $1\le a_{i},b_{i} \le N$
- 各黑格坐标互不相同

## 样例 #1

### 输入

```
3 2

1 2

2 3
```

### 输出

```
3
```

## 样例 #2

### 输入

```
2 2

1 1

1 2
```

### 输出

```
4
```

## 样例 #3

### 输入

```
4 3

1 2

1 3

4 4
```

### 输出

```
3
```



---

---
title: "[AGC009C] Division into Two"
layout: "post"
diff: 省选/NOI-
pid: AT_agc009_c
tag: []
---

# [AGC009C] Division into Two

## 题目描述

[problemUrl]: https://atcoder.jp/contests/jrex2017/tasks/agc009_c

相異なる整数 $ N $ 個からなる集合があります。この集合の $ i $ 番目に小さい要素は $ S_i $ です。この集合を $ X,Y $ の $ 2 $ つの集合に分割し、

- $ X $ に属するどの相異なる $ 2 $ つの要素も、その差の絶対値が $ A $ 以上
- $ Y $ に属するどの相異なる $ 2 $ つの要素も、その差の絶対値が $ B $ 以上

になるようにしたいです。このような分割としてありうるものの個数を $ 10^9\ +\ 7 $ で割ったあまりを求めてください。ただし、$ X,Y $ のうち一方が空となるような分割も数えます。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ A $ $ B $ $ S_1 $ : $ S_N $

## 输出格式

条件を満たす分割の個数を $ 10^9\ +\ 7 $ で割ったあまりを出力せよ。

## 说明/提示

### 制約

- 入力はすべて整数である。
- $ 1\ ≦\ N\ ≦\ 10^5 $
- $ 1\ ≦\ A\ ,\ B\ ≦\ 10^{18} $
- $ 0\ ≦\ S_i\ ≦\ 10^{18}(1\ ≦\ i\ ≦\ N) $
- $ S_i\ <\ S_{i+1}(1\ ≦\ i\ ≦\ N\ -\ 1) $

### Sample Explanation 1

次の $ 5 $ 通りの分割方法があります。 - $ X= ${$ 1,6,9,12 $}, $ Y= ${$ 3 $} - $ X= ${$ 1,6,9 $}, $ Y= ${$ 3,12 $} - $ X= ${$ 3,6,9,12 $}, $ Y= ${$ 1 $} - $ X= ${$ 3,6,9 $}, $ Y= ${$ 1,12 $} - $ X= ${$ 3,6,12 $}, $ Y= ${$ 1,9 $}

## 样例 #1

### 输入

```
5 3 7

1

3

6

9

12
```

### 输出

```
5
```

## 样例 #2

### 输入

```
7 5 3

0

2

4

7

8

11

15
```

### 输出

```
4
```

## 样例 #3

### 输入

```
8 2 9

3

4

5

13

15

22

26

32
```

### 输出

```
13
```

## 样例 #4

### 输入

```
3 3 4

5

6

7
```

### 输出

```
0
```



---

---
title: "[AGC010D] Decrementing"
layout: "post"
diff: 省选/NOI-
pid: AT_agc010_d
tag: []
---

# [AGC010D] Decrementing

## 题目描述

[problemUrl]: https://atcoder.jp/contests/agc010/tasks/agc010_d

黒板に $ N $ 個の整数が書かれています。$ i $ 番目の整数は $ A_i $ であり、これらの最大公約数は $ 1 $ です。

高橋君と青木君はこの数を使ってゲームをします。ゲームでは高橋君から始めて交互に以下の操作を繰り返します。

- 黒板の中から $ 2 $ 以上の数を $ 1 $ つ選び、その数から $ 1 $ を引く。
- その後、黒板に書かれた数の最大公約数を $ g $ として、すべての数を $ g $ で割る。

黒板に書かれた数が全て $ 1 $ となっていて、操作が行えない人の負けです。 二人が最適に行動したとき、どちらが勝つか求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ A_1 $ $ A_2 $ … $ A_N $

## 输出格式

先手の高橋君が勝つなら `First` を、後手の青木君が勝つなら `Second` を出力せよ。

## 说明/提示

### 制約

- $ 1\ ≦\ N\ ≦\ 10^5 $
- $ 1\ ≦\ A_i\ ≦\ 10^9 $
- $ A_1 $ から $ A_N $ の最大公約数は $ 1 $

### Sample Explanation 1

以下のようにすれば先手の高橋君が勝てます。 - 高橋君が $ 7 $ から $ 1 $ を引く。このとき、操作後は $ (1,2,2) $ となる。 - 青木君が $ 2 $ から $ 1 $ を引く。このとき、操作後は $ (1,1,2) $ となる。 - 高橋君が $ 2 $ から $ 1 $ を引く。このとき、操作後は $ (1,1,1) $ となる。

## 样例 #1

### 输入

```
3

3 6 7
```

### 输出

```
First
```

## 样例 #2

### 输入

```
4

1 2 4 8
```

### 输出

```
First
```

## 样例 #3

### 输入

```
5

7 8 8 8 8
```

### 输出

```
Second
```



---

---
title: "[AGC010F] Tree Game"
layout: "post"
diff: 省选/NOI-
pid: AT_agc010_f
tag: []
---

# [AGC010F] Tree Game

## 题目描述

[problemUrl]: https://atcoder.jp/contests/agc010/tasks/agc010_f

$ N $ 頂点からなる木があり、頂点には $ 1 $ から $ N $ の番号がついています。 また、$ N-1 $ 本の辺の内、$ i $ 番目の辺は頂点 $ a_i $ と頂点 $ b_i $ を結んでいます。

今、各頂点 $ i $ には $ A_i $ 個の石が置いてあります。 高橋君と青木君はこの木を使ってゲームをすることにしました。

まず、高橋君が一つの頂点を選び、そこに駒を置きます。 その後、高橋君から始めて以下の操作を交互に繰り返します。

- 今、駒がおいてある頂点から石を一つ取り除く。
- その後、その頂点に隣接する頂点を一つ選び、そこに駒を動かす。

駒が置いてある頂点に石がなく、操作を行えない人が負けです。 高橋君がこのゲームに勝つために、最初に駒を置くことができる頂点をすべて求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ A_1 $ $ A_2 $ … $ A_N $ $ a_1 $ $ b_1 $ : $ a_{N-1} $ $ b_{N-1} $

## 输出格式

高橋君が最初に駒を置いて勝つことができる頂点の番号を昇順に一行に出力せよ。

## 说明/提示

### 制約

- $ 2\ ≦\ N\ ≦\ 3000 $
- $ 1\ ≦\ a_i,b_i\ ≦\ N $
- $ 0\ ≦\ A_i\ ≦\ 10^9 $
- 与えられるグラフは木である。

### Sample Explanation 1

高橋君が頂点 $ 2 $ に駒を置いたとき、例えば以下のようにゲームが進みます。 - 高橋君が駒を頂点 $ 1 $ に動かす。このとき、各頂点にある石の個数は $ (1,1,3) $ である。 - 青木君が駒を頂点 $ 2 $ に動かす。このとき、各頂点にある石の個数は $ (0,1,3) $ である。 - 高橋君が駒を頂点 $ 1 $ に動かす。このとき、各頂点にある石の個数は $ (0,0,3) $ である。 - 青木君が石を取れないため、高橋君の勝ちとなる。

### Sample Explanation 3

題意を満たす頂点が存在しない場合があることに注意してください。

## 样例 #1

### 输入

```
3

1 2 3

1 2

2 3
```

### 输出

```
2
```

## 样例 #2

### 输入

```
5

5 4 1 2 3

1 2

1 3

2 4

2 5
```

### 输出

```
1 2
```

## 样例 #3

### 输入

```
3

1 1 1

1 2

2 3
```

### 输出

```

```



---

---
title: "[AGC011D] Half Reflector"
layout: "post"
diff: 省选/NOI-
pid: AT_agc011_d
tag: []
---

# [AGC011D] Half Reflector

## 题目描述

[problemUrl]: https://atcoder.jp/contests/agc011/tasks/agc011_d

高橋君は，ある特殊な装置をたくさん持っています． この装置は筒状で，左右からボールを入れることができます． また，この装置には $ 2 $ 種類の状態 A, B があります． 各状態について，装置にボールを入れたときの動作は次のようになっています．

- 状態 A の装置にボールを入れると，入れた側と同じ側からボールが飛び出してきて，その後すぐに装置の状態は B に変化します．
- 状態 B の装置にボールを入れると，入れた側と反対側からボールが飛び出してきて，その後すぐに装置の状態は A に変化します．

装置の状態の変化はとても速いので，$ 1 $ つの装置にボールを入れた後，次にボールが入ってくるまでの間には必ず状態の変化は終わっています．

高橋君は，この装置を $ N $ 個つなげたものを作りました．つまり，

- 左から $ i $ ($ 1\ \leq\ i\ \leq\ N-1 $) 番目の装置の右端から飛び出したボールは，すぐに左から $ i+1 $ 番目の装置に左端から入ります．
- 左から $ i $ ($ 2\ \leq\ i\ \leq\ N $) 番目の装置の左端から飛び出したボールは，すぐに左から $ i-1 $ 番目の装置に右端から入ります．

左から $ i $ 番目の装置の最初の状態は，文字列 $ S $ の $ i $ 番目の文字で表されます． 次に高橋君は，一番左の装置の左端からボールを入れ，ボールがどちらかの端から出てくるまで待つということを $ K $ 回行いました． ここで，ボールがいつまで経っても出てこないということは起きないことが証明できます． $ K $ 回ボールを入れた後の各装置の状態を求めてください．

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ K $ $ S $

## 输出格式

ボールを入れる操作を $ K $ 回行った後の，各装置の状態を表す文字列を出力せよ． この文字列は $ N $ 文字からなり，$ i $ 番目の文字は左から $ i $ 番目の装置の状態と同じでなければならない．

## 说明/提示

### 制約

- $ 1\ \leq\ N\ \leq\ 200,000 $
- $ 1\ \leq\ K\ \leq\ 10^9 $
- $ |S|=N $
- $ S $ の各文字は `A` または `B` である

### Sample Explanation 1

この入力では，一番左の装置の左端からボールを入れると，同じところからボールが出てきます．

## 样例 #1

### 输入

```
5 1

ABAAA
```

### 输出

```
BBAAA
```

## 样例 #2

### 输入

```
5 2

ABAAA
```

### 输出

```
ABBBA
```

## 样例 #3

### 输入

```
4 123456789

AABB
```

### 输出

```
BABA
```



---

---
title: "[AGC012C] Tautonym Puzzle"
layout: "post"
diff: 省选/NOI-
pid: AT_agc012_c
tag: []
---

# [AGC012C] Tautonym Puzzle

## 题目描述

[problemUrl]: https://atcoder.jp/contests/agc012/tasks/agc012_c

文字列 $ x $ が以下の条件を満たすとき、$ x $ を *良い文字列* と呼びます。

- 条件：$ x $ はある長さ $ 1 $ 以上の文字列 $ y $ を $ 2 $ 回繰り返した文字列 $ yy $ で表すことができる。

例えば `aa`,`bubobubo` などは良い文字列ですが、空文字列、`a`,`abcabcabc`,`abba` などは良い文字列ではありません。

ワシとフクロウが良い文字列に関するパズルを作りました。 以下の条件を満たす文字列 $ s $ をどれか $ 1 $ つ求めてください。この問題の制約下で、そのような文字列が必ず存在することが証明できます。

- $ 1\ ≦\ |s|\ ≦\ 200 $
- $ s $ は $ 1 $ から $ 100 $ までの整数で表される $ 100 $ 種類の文字のみからなる。
- $ s $ の $ 2^{|s|} $ 個ある部分列のうち、良い文字列であるようなものは $ N $ 個ある。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $

## 输出格式

$ 1 $ 行目には $ s $ の長さ $ |s| $ を出力せよ。 $ 2 $ 行目に $ s $ の各要素を $ 1 $ 文字目から順に空白区切りで出力せよ。$ s $ が上記の条件を満たすならば正解となる。

## 说明/提示

### 制約

- $ 1\ ≦\ N\ ≦\ 10^{12} $

### Sample Explanation 1

$ s $ の部分列であって良い文字列となるようなものは (1,1) と (1,1,1,1) の $ 2 $ 種類があります。(1,1) であるような部分列は $ 6 $ 個、(1,1,1,1) であるような部分列は $ 1 $ 個あるため、合計 $ 7 $ 個です。

## 样例 #1

### 输入

```
7
```

### 输出

```
4

1 1 1 1
```

## 样例 #2

### 输入

```
299
```

### 输出

```
23

32 11 11 73 45 8 11 83 83 8 45 32 32 10 100 73 32 83 45 73 32 11 10
```



---

---
title: "[AGC012D] Colorful Balls"
layout: "post"
diff: 省选/NOI-
pid: AT_agc012_d
tag: []
---

# [AGC012D] Colorful Balls

## 题目描述

[problemUrl]: https://atcoder.jp/contests/agc012/tasks/agc012_d

すぬけくんは $ N $ 個の色が塗られたボールを一列に並べました。 左から $ i $ 番目のボールは色 $ c_i $ で塗られていて、その重さは $ w_i $ です。

すぬけくんは以下の $ 2 $ 種類の操作を任意の順序で何回でも繰り返してボールの配置を変更することができます。

- 操作 $ 1 $：色が同じであるような $ 2 $ つのボールを選ぶ。$ 2 $ つのボールの重さの和が $ X $ 以下なら、$ 2 $ つのボールの位置を入れ替える。
- 操作 $ 2 $：色が異なるような $ 2 $ つのボールを選ぶ。$ 2 $ つのボールの重さの和が $ Y $ 以下なら、$ 2 $ つのボールの位置を入れ替える。

最終的なボールの色の並びとしてありうるような数列の数を modulo $ 10^9\ +\ 7 $ で求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ X $ $ Y $ $ c_1 $ $ w_1 $ $ : $ $ c_N $ $ w_N $

## 输出格式

答えを出力せよ。

## 说明/提示

### 制約

- $ 1\ ≦\ N\ ≦\ 2\ ×\ 10^5 $
- $ 1\ ≦\ X,\ Y\ ≦\ 10^9 $
- $ 1\ ≦\ c_i\ ≦\ N $
- $ 1\ ≦\ w_i\ ≦\ 10^9 $
- $ X,Y,c_i,\ w_i $ はいずれも整数

### Sample Explanation 1

\- 操作 $ 2 $ により左から $ 1 $ 番目のボールの位置と左から $ 3 $ 番目のボールの位置を入れ替えることで、$ (2,4,3,4) $ という色の並びを作ることが可能です。 - 操作 $ 1 $ により左から $ 2 $ 番目のボールの位置と左から $ 4 $ 番目のボールの位置を入れ替えることも可能ですが、色の並びは変化しません。

## 样例 #1

### 输入

```
4 7 3

3 2

4 3

2 1

4 4
```

### 输出

```
2
```

## 样例 #2

### 输入

```
1 1 1

1 1
```

### 输出

```
1
```

## 样例 #3

### 输入

```
21 77 68

16 73

16 99

19 66

2 87

2 16

7 17

10 36

10 68

2 38

10 74

13 55

21 21

3 7

12 41

13 88

18 6

2 12

13 87

1 9

2 27

13 15
```

### 输出

```
129729600
```



---

---
title: "[AGC013C] Ants on a Circle"
layout: "post"
diff: 省选/NOI-
pid: AT_agc013_c
tag: []
---

# [AGC013C] Ants on a Circle

## 题目描述

[problemUrl]: https://atcoder.jp/contests/agc013/tasks/agc013_c

周の長さ $ L $ の円があります。 この円の周上には座標が設定されていて、座標の値は、ある基準点からどれだけ時計回りに進んだかを表しています。

この円周上に $ N $ 匹の蟻がいます。 蟻には、座標の小さいものから順に、$ 1 $ から $ N $ までの番号がついています。 $ i $ 番目の蟻は座標 $ X_i $ にいます。

これから、$ N $ 匹の蟻は一斉に動き出します。 $ i $ 匹目の蟻は、$ W_i $ が $ 1 $ なら時計回りに、$ W_i $ が $ 2 $ なら反時計回りに動き始めます。 全ての蟻の移動速度は常に、$ 1 $ 秒間にちょうど $ 1 $ の距離を進む速さです。 蟻が動いていくと、二つの蟻がぶつかることがあります。 その時はどちらの蟻も、ぶつかった瞬間に進む向きを反転して動き続けます。

蟻が動き始めてから $ T $ 秒後にそれぞれの蟻がいる位置を求めて下さい。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ L $ $ T $ $ X_1 $ $ W_1 $ $ X_2 $ $ W_2 $ $ : $ $ X_N $ $ W_N $

## 输出格式

出力は $ N $ 行からなる。 出力の $ i $ 行目には、$ i $ 番目の蟻が $ T $ 秒後にいる位置の座標を出力せよ。 なお、座標の値は $ 0 $ 以上 $ L $ 未満の値として出力せよ。

## 说明/提示

### 制約

- 入力は全て整数である
- $ 1\ \leq\ N\ \leq\ 10^5 $
- $ 1\ \leq\ L\ \leq\ 10^9 $
- $ 1\ \leq\ T\ \leq\ 10^9 $
- $ 0\ \leq\ X_1\ <\ X_2\ <\ ...\ <\ X_N\ \leq\ L\ -\ 1 $
- $ 1\ \leq\ W_i\ \leq\ 2 $

### Sample Explanation 1

蟻が動き始めてから $ 1.5 $ 秒後、蟻 $ 1 $ と 蟻 $ 2 $ が、座標 $ 1.5 $ の位置でぶつかります。 その $ 1 $ 秒後、蟻 $ 1 $ と蟻 $ 3 $ が、座標 $ 0.5 $ の位置ぶつかります。 その $ 0.5 $ 秒後、つまり蟻が動き始めてから $ 3 $ 秒後には、 蟻 $ 1 $ 、$ 2 $ 、$ 3 $ はそれぞれ座標 $ 1 $ 、$ 3 $ 、$ 0 $ にいます。

## 样例 #1

### 输入

```
3 8 3

0 1

3 2

6 1
```

### 输出

```
1

3

0
```

## 样例 #2

### 输入

```
4 20 9

7 2

9 1

12 1

18 1
```

### 输出

```
7

18

18

1
```



---

---
title: "[AGC013E] Placing Squares"
layout: "post"
diff: 省选/NOI-
pid: AT_agc013_e
tag: []
---

# [AGC013E] Placing Squares

## 题目描述

[problemUrl]: https://atcoder.jp/contests/agc013/tasks/agc013_e

joisinoお姉ちゃんは、長さ $ N $ の棒を持っています。 この棒には $ M $ 個の印がついています。 $ i $ 個目の印は、棒の左端から距離 $ X_i $ の位置についています。

joisinoお姉ちゃんは、この棒の上にいくつかの正方形を置くことにしました。 正方形を置くにあたって、以下のような条件があります。

- 辺の長さが整数の正方形しか置いてはならない。
- 全ての正方形は、底辺が棒と接するように置かなくてはならない。
- 正方形は、棒の上に敷き詰められている必要がある。 つまり、正方形が棒からはみ出したり、上に正方形が乗っていないような棒の部分が存在したりしてはならない。
- 棒の印がついている部分の真上は、$ 2 $ つの正方形の境目であってはならない。

 ![](https://cdn.luogu.com.cn/upload/vjudge_pic/AT_agc013_e/60c8a1a1423174de467baae2e3cd9946ad507a48.png)条件を満たす配置とそうでない配置の例

 

ある正方形の配置の美しさとは、置かれている正方形の面積をすべて**掛け合わせた**値です。 joisinoお姉ちゃんは、上の条件を満たすような正方形の配置全てについて、その美しさを求め、その総和を知りたくなりました。 あなたの仕事は、joisinoお姉ちゃんの代わりにこれを求めるプログラムを作ることです。 なお、答えは非常に大きくなることがあるので、$ 10^9+7 $ で割った余りを出力してください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ M $ $ X_1 $ $ X_2 $ $ ... $ $ X_{M-1} $ $ X_M $

## 输出格式

あり得る正方形の配置全てについて、その美しさを求め、その総和を $ 10^9+7 $ で割った余りを出力せよ。

## 说明/提示

### 制約

- 入力は全て整数である
- $ 1\ \leq\ N\ \leq\ 10^9 $
- $ 0\ \leq\ M\ \leq\ 10^5 $
- $ 1\ \leq\ X_1\ <\ X_2\ <\ ...\ <\ X_{M-1}\ <\ X_M\ \leq\ N-1 $

### Sample Explanation 1

可能な配置は、 - 一辺の長さ $ 1 $ の正方形を左に、一辺の長さ $ 2 $ の正方形を右に置く - 一辺の長さ $ 3 $ の正方形を置く の $ 2 $ 通りで、その美しさの合計は、$ (1\ \times\ 1\ \times\ 2\ \times\ 2)\ +\ (3\ \times\ 3)\ =\ 13 $ となります。

## 样例 #1

### 输入

```
3 1

2
```

### 输出

```
13
```

## 样例 #2

### 输入

```
5 2

2 3
```

### 输出

```
66
```

## 样例 #3

### 输入

```
10 9

1 2 3 4 5 6 7 8 9
```

### 输出

```
100
```

## 样例 #4

### 输入

```
1000000000 0
```

### 输出

```
693316425
```



---

---
title: "[AGC014D] Black and White Tree"
layout: "post"
diff: 省选/NOI-
pid: AT_agc014_d
tag: []
---

# [AGC014D] Black and White Tree

## 题目描述

[problemUrl]: https://atcoder.jp/contests/agc014/tasks/agc014_d

$ N $ 頂点からなる木があり、頂点には $ 1 $ から $ N $ の番号がついています。 また、 $ N-1 $ 本の辺の内、$ i $ 本目の辺は頂点 $ a_i $ と頂点 $ b_i $ を結んでいます。

はじめ、どの頂点にも色がついていません。

高橋君と青木君は各頂点に色を塗ってゲームをします。ゲームでは高橋君から始めて交互に以下の操作を繰り返します。

- 頂点の中から、まだ色がついていない頂点を一つ選ぶ。
- その後、高橋君ならその頂点を白色に、青木君ならその頂点を黒色に塗る。

次にすべての頂点に色がついた後、高橋君と青木君は以下の手順を一度だけ行います。

- 黒色の頂点に隣接している白色の頂点をすべて黒色に塗りかえる。

ただし、この操作はある頂点から順に操作を行っていくわけではなく、当該頂点すべてに対して同時に行うことに注意してください。

最終的に白色の頂点が残っていれば高橋君の勝ちであり、全て黒色の頂点であれば青木君の勝ちです。 二人が最適に行動したとき、どちらが勝つか求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ a_1 $ $ b_1 $ : $ a_{N-1} $ $ b_{N-1} $

## 输出格式

先手の高橋君が勝つなら `First` を、後手の青木君が勝つなら `Second` を出力せよ。

## 说明/提示

### 制約

- $ 2\ ≦\ N\ ≦\ 10^5 $
- $ 1\ ≦\ a_i,b_i\ ≦\ N $
- $ a_i\ ≠\ b_i $
- 入力で与えられるグラフは木である。

### Sample Explanation 1

ゲームの一例を示す。 - 高橋君がまず頂点 $ 2 $ を白色に塗る。 - その後、青木君が頂点 $ 1 $ を黒色に塗る。 - 最後に高橋君が頂点 $ 3 $ を白色に塗る。 このように進んだ場合、最後の操作で頂点 $ 1,2,3 $ の色がそれぞれ黒、黒、白となるので、高橋君の勝ちとなる。

## 样例 #1

### 输入

```
3

1 2

2 3
```

### 输出

```
First
```

## 样例 #2

### 输入

```
4

1 2

2 3

2 4
```

### 输出

```
First
```

## 样例 #3

### 输入

```
6

1 2

2 3

3 4

2 5

5 6
```

### 输出

```
Second
```



---

---
title: "[AGC015D] A or...or B Problem"
layout: "post"
diff: 省选/NOI-
pid: AT_agc015_d
tag: []
---

# [AGC015D] A or...or B Problem

## 题目描述

[problemUrl]: https://atcoder.jp/contests/agc015/tasks/agc015_d

ぬけす君は、$ A $ 以上 $ B $ 以下の整数から $ 1 $ 個以上選んで、それらの整数の bitwise or を取ってできる整数を持っています。 ぬけす君が持っている整数としてありうるものは何通りあるでしょうか。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ A $ $ B $

## 输出格式

ぬけす君が持っている整数としてありうるものの個数を出力せよ。

## 说明/提示

### 制約

- $ 1\ ≦\ A\ ≦\ B\ <\ 2^{60} $
- $ A,B $ は整数である

### Sample Explanation 1

$ 7,8,9 $ のうちの $ 1 $ 個以上の整数の bitwise or で書ける整数は、$ 7,8,9,15 $ の $ 4 $ つです。

## 样例 #1

### 输入

```
7

9
```

### 输出

```
4
```

## 样例 #2

### 输入

```
65

98
```

### 输出

```
63
```

## 样例 #3

### 输入

```
271828182845904523

314159265358979323
```

### 输出

```
68833183630578410
```



---

---
title: "[AGC015E] Mr.Aoki Incubator"
layout: "post"
diff: 省选/NOI-
pid: AT_agc015_e
tag: []
---

# [AGC015E] Mr.Aoki Incubator

## 题目描述

[problemUrl]: https://atcoder.jp/contests/agc015/tasks/agc015_e

数直線上に $ N $ 人の高橋君が並んでおり、$ 1 $ から $ N $ までの番号がついています。 $ i $ 人目の高橋君は、時刻 $ 0 $ に位置 $ X_i $ にいて、速度 $ V_i $ で正の方向に歩き始めます。

けすぬ君は、時刻 $ 0 $ に高橋君たちのうちの何人かを選んで青木君にすることができます。 高橋君が青木君になっても歩く速度は変化しません。 それ以降、もしある瞬間に高橋君と青木君が同じ座標にいたなら、高橋君は青木君になります。

けすぬ君が時刻 $ 0 $ に高橋君を青木君にする $ 2^N $ 通りの方法のうち、 十分な時間が経過した後、高橋君が全員青木君になっているような方法の数を $ 10^9+7 $ で割ったあまりを求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ X_1 $ $ V_1 $ : $ X_N $ $ V_N $

## 输出格式

十分な時間が経過した後、高橋君が全員青木君になっているような方法の数を $ 10^9+7 $ で割ったあまりを出力せよ。

## 说明/提示

### 制約

- $ 1\ ≦\ N\ ≦\ 200000 $
- $ 1\ ≦\ X_i,V_i\ ≦\ 10^9(1\ ≦\ i\ ≦\ N) $
- $ X_i,V_i $ は整数である
- $ X_i $ たちはすべて異なる
- $ V_i $ たちはすべて異なる

### Sample Explanation 1

けすぬ君が $ (2),(3),(1,2),(1,3),(2,3),(1,2,3) $ 番目の高橋君を青木君にしたとき、十分な時間が経過した後にすべての高橋君が青木君になっています。

## 样例 #1

### 输入

```
3

2 5

6 1

3 7
```

### 输出

```
6
```

## 样例 #2

### 输入

```
4

3 7

2 9

8 16

10 8
```

### 输出

```
9
```



---

---
title: "[AGC016D] XOR Replace"
layout: "post"
diff: 省选/NOI-
pid: AT_agc016_d
tag: []
---

# [AGC016D] XOR Replace

## 题目描述

[problemUrl]: https://atcoder.jp/contests/agc016/tasks/agc016_d

長さ $ N $ の数列 $ a\ =\ (a_1,\ a_2,\ ...,\ a_N) $ があります。 ただし、各 $ a_i $ は $ 0 $ 以上の整数です。

すぬけ君は次の操作を繰り返し行うことができます。

- $ a $ のすべての要素の XOR を $ x $ とする。 整数 $ i $ ($ 1\ <\ =\ i\ <\ =\ N $) をひとつ選び、$ a_i $ を $ x $ に置き換える。

すぬけ君の目標は、$ a $ を数列 $ b\ =\ (b_1,\ b_2,\ ...,\ b_N) $ に一致させることです。 ただし、各 $ b_i $ は $ 0 $ 以上の整数です。

目標が達成可能か判定し、達成可能ならば必要な操作回数の最小値を求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ a_1 $ $ a_2 $ $ ... $ $ a_N $ $ b_1 $ $ b_2 $ $ ... $ $ b_N $

## 输出格式

目標が達成可能ならば、必要な操作回数の最小値を出力せよ。 達成不可能ならば、代わりに `-1` を出力せよ。

## 说明/提示

### 制約

- $ 2\ <\ =\ N\ <\ =\ 10^5 $
- $ a_i $, $ b_i $ は整数である。
- $ 0\ <\ =\ a_i,\ b_i\ <\ 2^{30} $

### Sample Explanation 1

最初、$ a $ のすべての要素の XOR は $ 3 $ です。 $ a_1 $ を選んで $ 3 $ に置き換えると、$ a\ =\ (3,\ 1,\ 2) $ となります。 次に、$ a $ のすべての要素の XOR は $ 0 $ です。 $ a_3 $ を選んで $ 0 $ に置き換えると、$ a\ =\ (3,\ 1,\ 0) $ となり、$ b $ に一致します。

## 样例 #1

### 输入

```
3

0 1 2

3 1 0
```

### 输出

```
2
```

## 样例 #2

### 输入

```
3

0 1 2

0 1 2
```

### 输出

```
0
```

## 样例 #3

### 输入

```
2

1 1

0 0
```

### 输出

```
-1
```

## 样例 #4

### 输入

```
4

0 1 2 3

1 0 3 2
```

### 输出

```
5
```



---

---
title: "[AGC017C] Snuke and Spells"
layout: "post"
diff: 省选/NOI-
pid: AT_agc017_c
tag: []
---

# [AGC017C] Snuke and Spells

## 题目描述

[problemUrl]: https://atcoder.jp/contests/agc017/tasks/agc017_c

$ N $ 個のボールが一列に並んでいます． 左から $ i $ 番目のボールには，最初整数 $ A_i $ が書かれています．

すぬけ君が魔法を唱えると，これらのボールは次のようにして消滅します：

- ボールがちょうど $ k $ 個あるとき，$ k $ が書かれているボールすべてが同時に消滅する．

すぬけ君の目標は，魔法を何回か唱えることでボールをすべて消滅させることです． これは不可能な場合があるので，すぬけ君はできるだけ少ない個数のボールに書かれている整数を変更することで，この目標を達成できるようにしたいです．

これらのボールは，書かれている整数が全部で $ M $ 回自然に変化することがわかっています． $ j $ 回目の変化においては，左から $ X_j $ 番目のボールに書かれている整数が $ Y_j $ に変わります．

各変化の後の状態で，次の変化が起こる前にすぬけ君が目標を達成しようとするとき，少なくとも何個のボールに書かれている整数を変更する必要があるかを求めてください．すぬけ君は整数の変更を十分速く行うことができるものとします．ただし，すぬけ君は実際には整数の変更を行わないことに注意してください．

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ M $ $ A_1 $ $ A_2 $ ... $ A_N $ $ X_1 $ $ Y_1 $ $ X_2 $ $ Y_2 $ : $ X_M $ $ Y_M $

## 输出格式

$ M $ 行出力せよ． $ j $ 行目には，$ j $ 回目の変化の後で，すぬけ君が目標を達成するためには，少なくとも何個のボールに書かれている整数を変更する必要があるかを出力せよ．

## 说明/提示

### 制約

- $ 1\ \leq\ N\ \leq\ 200000 $
- $ 1\ \leq\ M\ \leq\ 200000 $
- $ 1\ \leq\ A_i\ \leq\ N $
- $ 1\ \leq\ X_j\ \leq\ N $
- $ 1\ \leq\ Y_j\ \leq\ N $

### 部分点

- $ 500 $ 点分のテストケースでは，$ N\ \leq\ 200 $ および $ M\ \leq\ 200 $ が成り立つ．

### Sample Explanation 1

\- $ 1 $ 回目の変化の後，ボールに書かれている整数は左のボールから順に $ 2,\ 1,\ 3,\ 4,\ 5 $ になります．この状態ですぬけ君が $ 5 $ 回魔法を唱えると，すべてのボールが消滅します．そのため，$ 0 $ 個のボールに書かれている整数を変更すればよいです． - $ 2 $ 回目の変化の後，ボールに書かれている整数は左のボールから順に $ 2,\ 5,\ 3,\ 4,\ 5 $ になります．この場合，少なくとも $ 1 $ 個のボールに書かれている整数を変更する必要があります．例えば，左から $ 5 $ 番目のボールに書かれている整数を $ 2 $ に変更した後，すぬけ君が $ 4 $ 回魔法を唱えればよいです． - $ 3 $ 回目の変化の後，ボールに書かれている整数は左のボールから順に $ 2,\ 5,\ 3,\ 4,\ 4 $ になります．この場合，少なくとも $ 1 $ 個のボールに書かれている整数を変更する必要があります．例えば，左から $ 3 $ 番目のボールに書かれている整数を $ 2 $ に変更した後，すぬけ君が $ 3 $ 回魔法を唱えればよいです．

## 样例 #1

### 输入

```
5 3

1 1 3 4 5

1 2

2 5

5 4
```

### 输出

```
0

1

1
```

## 样例 #2

### 输入

```
4 4

4 4 4 4

4 1

3 1

1 1

2 1
```

### 输出

```
0

1

2

3
```

## 样例 #3

### 输入

```
10 10

8 7 2 9 10 6 6 5 5 4

8 1

6 3

6 2

7 10

9 7

9 9

2 4

8 1

1 8

7 7
```

### 输出

```
1

0

1

2

2

3

3

3

3

2
```



---

---
title: "[AGC017D] Game on Tree"
layout: "post"
diff: 省选/NOI-
pid: AT_agc017_d
tag: []
---

# [AGC017D] Game on Tree

## 题目描述

有一棵 $N$ 个节点的树，节点标号为 $1,2,⋯,N$，边用 $(x_i,y_i)$表示。 Alice 和 Bob 在这棵树上玩一个游戏，Alice先手，两人轮流操作：


选择一条树上存在的边，把它断开使树变成两个连通块。然后把不包含 $1$ 号点的联通块删除


当一个玩家不能操作时输，你需要算出：假如两人都按最优策略操作，谁将获胜。

## 输入格式

$N$

$x_1$ $y_1$

$x_2$ $y_2$

$...$

$x_{n-1}$ $y_{n-1}$

## 输出格式

若Alice获胜，输出```Alice```

否则输出```Bob```

## 说明/提示

$1 \leq N \leq 100000$

$1\leq x_i,y_i \leq N$

保证给出的是一棵树

## 样例 #1

### 输入

```
5

1 2

2 3

2 4

4 5
```

### 输出

```
Alice
```

## 样例 #2

### 输入

```
5

1 2

2 3

1 4

4 5
```

### 输出

```
Bob
```

## 样例 #3

### 输入

```
6

1 2

2 4

5 1

6 3

3 2
```

### 输出

```
Alice
```

## 样例 #4

### 输入

```
7

1 2

3 7

4 6

2 3

2 4

1 5
```

### 输出

```
Bob
```



---

---
title: "[AGC018C] Coins"
layout: "post"
diff: 省选/NOI-
pid: AT_agc018_c
tag: []
---

# [AGC018C] Coins

## 题目描述

[problemUrl]: https://atcoder.jp/contests/agc018/tasks/agc018_c

$ 1 $ から $ X+Y+Z $ までの番号のついた、$ X+Y+Z $ 人の人がいます。 人 $ i $ は、金のコインを $ A_i $ 枚、銀のコインを $ B_i $ 枚、銅のコインを $ C_i $ 枚持っています。

すぬけ君は、彼らのうち $ X $ 人から金のコイン、$ Y $ 人から銀のコイン、$ Z $ 人から銅のコインをもらおうと考えています。 どの人からも、$ 2 $ 種類以上のコインをもらうことはできません。 また、どの人も、指定された色のコインをすべてあなたに渡してくれます。

すぬけ君は、最終的に持っている全ての色のコインの枚数の合計を最大化したいです。 すぬけ君が最終的に持っている全ての色のコインの枚数の合計の最大値を求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ X $ $ Y $ $ Z $ $ A_1 $ $ B_1 $ $ C_1 $ $ A_2 $ $ B_2 $ $ C_2 $ $ : $ $ A_{X+Y+Z} $ $ B_{X+Y+Z} $ $ C_{X+Y+Z} $

## 输出格式

すぬけ君が最終的に持っている全ての色のコインの枚数の合計の最大値を出力せよ。

## 说明/提示

### 制約

- $ 1\ \leq\ X $
- $ 1\ \leq\ Y $
- $ 1\ \leq\ Z $
- $ X+Y+Z\ \leq\ 10^5 $
- $ 1\ \leq\ A_i\ \leq\ 10^9 $
- $ 1\ \leq\ B_i\ \leq\ 10^9 $
- $ 1\ \leq\ C_i\ \leq\ 10^9 $

### Sample Explanation 1

人 $ 1 $ から銀のコインを、人 $ 2 $ から銀のコインを、人 $ 3 $ から銅のコインを、人 $ 4 $ から金のコインをもらうと、 コインの枚数の合計は、$ 4+2+7+5=18 $ になります。 $ 19 $ 枚以上のコインを得る方法はないので、この例の答えは $ 18 $ になります。

## 样例 #1

### 输入

```
1 2 1

2 4 4

3 2 1

7 6 7

5 2 3
```

### 输出

```
18
```

## 样例 #2

### 输入

```
3 3 2

16 17 1

2 7 5

2 16 12

17 7 7

13 2 10

12 18 3

16 15 19

5 6 2
```

### 输出

```
110
```

## 样例 #3

### 输入

```
6 2 4

33189 87907 277349742

71616 46764 575306520

8801 53151 327161251

58589 4337 796697686

66854 17565 289910583

50598 35195 478112689

13919 88414 103962455

7953 69657 699253752

44255 98144 468443709

2332 42580 752437097

39752 19060 845062869

60126 74101 382963164
```

### 输出

```
3093929975
```



---

---
title: "[AGC019C] Fountain Walk"
layout: "post"
diff: 省选/NOI-
pid: AT_agc019_c
tag: []
---

# [AGC019C] Fountain Walk

## 题目描述

[problemUrl]: https://atcoder.jp/contests/agc019/tasks/agc019_c

都市ネバーモアには、$ 10^8 $ 本の東西方向の通りと $ 10^8 $ 本の南北方向の通りがあり、どちらにも $ 0 $ から $ 10^8-1 $ の番号が付けられています。隣接する二本の東西方向の通りの間の距離はちょうど $ 100 $ メートルで、隣接する二本の南北方向の通りの間の距離もちょうど $ 100 $ メートルです。

すべての東西方向の通りは、すべての南北方向の通りと交わります。すべての交差点は、交差する南北方向の通りの番号を $ x $、東西方向の通りの番号を $ y $ として組 $ (x,\ y) $ で表されます。

この都市には $ N $ 個の噴水があり、交差点 $ (X_i,\ Y_i) $ に設置されています。 通常の交差点と異なり、これらの交差点には交差点を中心とした半径 $ 10 $ メートルの円が噴水の外周として描かれており、その内部に道路はありません。

下の図に、都市の一角の道路や噴水の光景の例を示します。

 ![1f931bf0c98ec6f07e612b0282cdb094.png](https://cdn.luogu.com.cn/upload/vjudge_pic/AT_agc019_c/8ed452b1f7546ae320f6bcf912b66ca869baab8b.png)

市長たちは、同じ通りを歩いている間に噴水を二回以上見たくありません。ですから、どの東西方向の通りにも噴水は一つまでしか設置されていませんし、南北方向の通りについても同様です。

市民が通行できるのは東西、南北方向の通りと噴水の外周です。交差点 $ (x_1,\ y_1) $ から $ (x_2,\ y_2) $ に移動するには、最短で何メートル歩く必要があるでしょうか？

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ x_1 $ $ y_1 $ $ x_2 $ $ y_2 $ $ N $ $ X_1 $ $ Y_1 $ $ X_2 $ $ Y_2 $ $ : $ $ X_N $ $ Y_N $

## 输出格式

交差点 $ (x_1,\ y_1) $ から $ (x_2,\ y_2) $ に移動するために歩くべき最短距離をメートル単位で出力せよ。出力は、絶対誤差または相対誤差が $ 10^{-11} $ を超えなければ正答とみなされる。

## 说明/提示

### 制約

- $ 0\ \leq\ x_1,\ y_1,\ x_2,\ y_2\ <\ 10^8 $
- $ 1\ \leq\ N\ \leq\ 200,000 $
- $ 0\ \leq\ X_i,\ Y_i\ <\ 10^8 $
- $ i\ \neq\ j $ のとき $ X_i\ \neq\ X_j $
- $ i\ \neq\ j $ のとき $ Y_i\ \neq\ Y_j $
- 交差点 $ (x_1,\ y_1),\ (x_2,\ y_2) $ は異なり、これらの位置に噴水は設置されていない。
- 入力値はすべて整数である。

### Sample Explanation 1

最短経路の一つを下の図に示します。スタート地点は青の点、ゴール地点は紫の点、途中経路は赤の線です。 !\[c49e52b9b79003f61b8a6efa5dad8ba3.png\](https://img.atcoder.jp/agc019/c49e52b9b79003f61b8a6efa5dad8ba3.png)

### Sample Explanation 2

!\[f9090ab734c89424c413f3b583376990.png\](https://img.atcoder.jp/agc019/f9090ab734c89424c413f3b583376990.png)

### Sample Explanation 3

!\[4b76416161f27cad20333a9ac636e00f.png\](https://img.atcoder.jp/agc019/4b76416161f27cad20333a9ac636e00f.png)

## 样例 #1

### 输入

```
1 1 6 5

3

3 2

5 3

2 4
```

### 输出

```
891.415926535897938
```

## 样例 #2

### 输入

```
3 5 6 4

3

3 2

5 3

2 4
```

### 输出

```
400.000000000000000
```

## 样例 #3

### 输入

```
4 2 2 2

3

3 2

5 3

2 4
```

### 输出

```
211.415926535897938
```



---

---
title: "[AGC019D] Shift and Flip"
layout: "post"
diff: 省选/NOI-
pid: AT_agc019_d
tag: []
---

# [AGC019D] Shift and Flip

## 题目描述

[problemUrl]: https://atcoder.jp/contests/agc019/tasks/agc019_d

$ 0 $ と $ 1 $ からなる同じ長さの二つの文字列 $ A\ =\ A_1\ A_2\ ...\ A_n $ と $ B\ =\ B_1\ B_2\ ...\ B_n $ があります。

あなたは、以下の操作を任意の順序で何度でも行って $ A $ を変化させることができます。

- $ A $ を一文字左にシフトする（すなわち、$ A\ =\ A_1\ A_2\ ...\ A_n $ として $ A $ を $ A_2\ A_3\ ...\ A_n\ A_1 $ に置き換える）。
- $ A $ を一文字右にシフトする（すなわち、$ A\ =\ A_1\ A_2\ ...\ A_n $ として $ A $ を $ A_n\ A_1\ A_2\ ...\ A_{n-1} $ に置き換える）。
- $ B_i\ =\ 1 $ であるような $ i $ をいずれか一つ選び、$ A_i $ を反転する（すなわち、$ A_i\ =\ 1\ -\ A_i $ とする）。

あなたの目標は文字列 $ A,\ B $ を一致させることです。

これに必要な最小の操作回数を出力してください。ただし、これが不可能である場合は $ -1 $ と出力してください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ A $ $ B $

## 输出格式

文字列 $ A,\ B $ を一致させるために必要な最小の操作回数を出力せよ。ただし、これが不可能である場合は $ -1 $ と出力せよ。

## 说明/提示

### 制約

- $ 1\ \leq\ |A|\ =\ |B|\ \leq\ 2,000 $
- $ A,\ B $ は $ 0 $ と $ 1 $ からなる。

### Sample Explanation 1

目標を達成する最短の操作列を一つ示します。 - $ A_1 $ を反転: $ A\ =\ 0010 $ - $ A $ を左にシフト: $ A\ =\ 0100 $ - $ A_1 $ を再度反転: $ A\ =\ 1100 $

### Sample Explanation 2

$ A $ の唯一のビットを反転させる方法はありません。

### Sample Explanation 3

目標を達成する最短の操作列を一つ示します。 - $ A $ を右にシフト: $ A\ =\ 01101 $ - $ A_5 $ を反転: $ A\ =\ 01100 $ - $ A $ を左にシフト: $ A\ =\ 11000 $ - $ A $ を再度左にシフト: $ A\ =\ 10001 $

### Sample Explanation 4

$ A_1 $, $ A_3 $, $ A_4 $, $ A_6 $, $ A_7 $ を任意の順序で反転すればよいです。

## 样例 #1

### 输入

```
1010

1100
```

### 输出

```
3
```

## 样例 #2

### 输入

```
1

0
```

### 输出

```
-1
```

## 样例 #3

### 输入

```
11010

10001
```

### 输出

```
4
```

## 样例 #4

### 输入

```
0100100

1111111
```

### 输出

```
5
```



---

---
title: "[AGC020D] Min Max Repetition"
layout: "post"
diff: 省选/NOI-
pid: AT_agc020_d
tag: []
---

# [AGC020D] Min Max Repetition

## 题目描述

[problemUrl]: https://atcoder.jp/contests/agc020/tasks/agc020_d

$ A $ と $ B $ を正の整数として、$ f(A,\ B) $ を以下の条件を満たす文字列と定めます。

- $ f(A,\ B) $ の長さは $ A\ +\ B $ である。
- $ f(A,\ B) $ はちょうど $ A $ 個の `A` とちょうど $ B $ 個の `B` を含む。
- $ f(A,\ B) $ の部分文字列であって同じ文字からなるもの（例: `AAAAA`、`BBBB`）のうち最長のものの長さは、上記の二つの条件が満たされるという前提のもとで最小である。
- $ f(A,\ B) $ は、上記の三つの条件が満たされるという前提のもとで辞書順最小の文字列である。

例えば、$ f(2,\ 3) $ = `BABAB`、$ f(6,\ 4) $ = `AABAABAABB` となります。

次の $ Q $ 個のクエリに答えてください。「$ f(A_i,\ B_i) $ の $ C_i $ 文字目から $ D_i $ 文字目までの部分文字列（最初の文字を $ 1 $ 文字目とする）を求めよ。」

## 输入格式

入力は標準入力から以下の形式で与えられる。

> $ Q $ $ A_1 $ $ B_1 $ $ C_1 $ $ D_1 $ $ A_2 $ $ B_2 $ $ C_2 $ $ D_2 $ $ : $ $ A_Q $ $ B_Q $ $ C_Q $ $ D_Q $

## 输出格式

入力で与えられた順に、各クエリ $ i $ について、$ f(A_i,\ B_i) $ の $ C_i $ 文字目から $ D_i $ 文字目までの部分文字列（最初の文字を $ 1 $ 文字目とする）を個別の行に出力せよ。

## 说明/提示

### 制約

- $ 1\ \leq\ Q\ \leq\ 10^3 $
- $ 1\ \leq\ A_i,\ B_i\ \leq\ 5\ \times\ 10^8 $
- $ 1\ \leq\ C_i\ \leq\ D_i\ \leq\ A_i\ +\ B_i $
- $ D_i\ -\ C_i\ +\ 1\ \leq\ 100 $
- 入力値はすべて整数である。

### 部分点

- $ 1\ \leq\ A_i,\ B_i\ \leq\ 10^3 $ を満たすデータセットに正答すると、$ 500 $ 点が与えられる。

## 样例 #1

### 输入

```
5

2 3 1 5

6 4 1 10

2 3 4 4

6 4 3 7

8 10 5 8
```

### 输出

```
BABAB

AABAABAABB

A

BAABA

ABAB
```



---

---
title: "[AGC021D] Reversed LCS"
layout: "post"
diff: 省选/NOI-
pid: AT_agc021_d
tag: []
---

# [AGC021D] Reversed LCS

## 题目描述

[problemUrl]: https://atcoder.jp/contests/agc021/tasks/agc021_d

高橋君はお母さんに文字列をプレゼントすることにしました。

文字列 $ T $ の価値とは、$ T $ を逆から読んだものを $ T' $ として、$ T $ と $ T' $ の最長共通部分列の長さです。 すなわち、(連続するとは限らない)部分列として $ T $ と $ T' $ の両方に現れるものの最大長です。

高橋君は、文字列 $ S $ を持っています。お母さんにできるだけ価値の高い文字列をプレゼントしたい高橋君は、 $ S $ の文字を $ K $ 箇所まで任意に変更して、できるだけ価値の高い文字列を作りたいです。

達成できる価値の最大値を求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ S $ $ K $

## 输出格式

達成できる価値の最大値を出力せよ。

## 说明/提示

### 制約

- $ 1\ \leq\ |S|\ \leq\ 300 $
- $ 0\ \leq\ K\ \leq\ |S| $
- $ S $ は英小文字からなる
- $ K $ は整数である

### Sample Explanation 1

$ 1 $ 文字目を `c` に変更すると、文字列は `cbcabcabc` になります。 できた文字列を $ T $ とおけば、長さ $ 7 $ の文字列 `cbabcbc` が $ T $ と $ T' $ の最長共通部分列の一例となります。

## 样例 #1

### 输入

```
abcabcabc

1
```

### 输出

```
7
```

## 样例 #2

### 输入

```
atcodergrandcontest

3
```

### 输出

```
15
```



---

---
title: "[AGC023F] 01 on Tree"
layout: "post"
diff: 省选/NOI-
pid: AT_agc023_f
tag: []
---

# [AGC023F] 01 on Tree

## 题目描述

[problemUrl]: https://atcoder.jp/contests/agc023/tasks/agc023_f

すぬけ君は、$ N $ 頂点からなる根付き木を持っています。 頂点には $ 1 $ から $ N $ までの番号が振られています。 頂点 $ 1 $ はこの木の根です。 頂点 $ i $ ( $ 2\leq\ i\ \leq\ N $ ) の親は頂点 $ P_i $ ( $ P_i\ <\ i $ ) です。 各頂点には、$ 0 $ または $ 1 $ が書かれていて、頂点 $ i $ に書かれている数は $ V_i $ です。

すぬけ君は、この木の頂点を横一列に並べたいと考えています。 その際、どの頂点についても、その頂点より右側にその頂点の先祖となる頂点がないようにします。

頂点を並べ終えたあと、頂点に書かれている数を頂点の並び順に沿って並べた数列を $ X $ とします。 すぬけ君は、$ X $ の転倒数 ( ※ ) を最小化したいです。 $ X $ の転倒数の最小値を求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ P_2 $ $ P_3 $ $ ... $ $ P_N $ $ V_1 $ $ V_2 $ $ ... $ $ V_N $

## 输出格式

数列 $ X $ の転倒数の最小値を出力せよ。

## 说明/提示

### 注釈

ある長さ $ N $ の数列 $ Z $ の転倒数とは、整数 $ i,\ j $ ( $ 1\ \leq\ i\ <\ j\ \leq\ N $ ) の組であって、$ Z_i\ >\ Z_j $ を満たすものの個数を意味します。

### 制約

- $ 1\ \leq\ N\ \leq\ 2\ \times\ 10^5 $
- $ 1\ \leq\ P_i\ <\ i $ ( $ 2\ \leq\ i\ \leq\ N $ )
- $ 0\ \leq\ V_i\ \leq\ 1 $ ( $ 1\ \leq\ i\ \leq\ N $ )
- 入力はすべて整数である。

### Sample Explanation 1

頂点を $ 1,\ 3,\ 5,\ 6,\ 2,\ 4 $ の順に並べると、$ X\ =\ (0,\ 1,\ 0,\ 0,\ 1,\ 0) $ となり、 転倒数は $ 4 $ になります。 これ以上転倒数を小さくすることは出来ないので、$ 4 $ を出力します。

### Sample Explanation 2

$ X\ =\ (0) $ で、転倒数は $ 0 $ です。

## 样例 #1

### 输入

```
6

1 1 2 3 3

0 1 1 0 0 0
```

### 输出

```
4
```

## 样例 #2

### 输入

```
1



0
```

### 输出

```
0
```

## 样例 #3

### 输入

```
15

1 2 3 2 5 6 2 2 9 10 1 12 13 12

1 1 1 0 1 1 0 0 1 0 0 1 1 0 0
```

### 输出

```
31
```



---

---
title: "[AGC024D] Isomorphism Freak"
layout: "post"
diff: 省选/NOI-
pid: AT_agc024_d
tag: []
---

# [AGC024D] Isomorphism Freak

## 题目描述

[problemUrl]: https://atcoder.jp/contests/agc024/tasks/agc024_d

木 $ G $ の頂点を何色かで塗り分ける方法が *良い彩色* であるとは、同じ色で塗られたどの $ 2 $ つの頂点 $ u,v $ に対しても、 $ G $ を $ u $ を根とする根付き木として見た木と $ v $ を根とする根付き木として見た木が同型であることを指します。

また、$ G $ の *カラフルさ* とは、$ G $ の良い彩色で使われる色の種類数の最小値を指します。

$ N $ 頂点の木が与えられます。頂点には $ 1 $ から $ N $ までの番号がついており、$ i $ 本目の辺は頂点 $ a_i $ と頂点 $ b_i $ を結んでいます。 この木に以下の操作を何度か繰り返し施し、木 $ T $ を作ります。

- 新たな頂点を $ 1 $ つ作る。現在の木の頂点をひとつ選び、その頂点と新しく作った頂点を辺で結ぶ。

$ T $ としてありうるもののカラフルさの最小値を求めてください。 さらに、その最小値を達成する木 $ T $ の葉(次数 $ 1 $ の頂点)の数の最小値を出力してください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ a_1 $ $ b_1 $ : $ a_{N-1} $ $ b_{N-1} $

## 输出格式

整数 $ 2 $ つを空白区切りで出力せよ。 まずはじめに、作ることのできる木 $ T $ の中での、カラフルさの最小値を出力せよ。 その後、その時の木の葉の数の最小値を出力せよ。

なお、この問題の制約の下で、出力すべき値は $ 64 $ ビット符号付き整数に収まることが示せる。

## 说明/提示

### ノート

$ G $ を $ u $ を根とする根付き木として見た木と $ v $ を根とする根付き木として見た木が同型であるとは、 $ G $ の頂点集合からそれ自身への全単射な写像 $ f_{uv} $ であって、以下を満たすものが存在することを指します。

- $ f_{uv}(u)=v $
- どの $ 2 $ 頂点の組 $ (a,b) $ についても、$ (a,b) $ 辺があることと $ (f_{uv}(a),f_{uv}(b)) $ 辺があることが同値である

### 制約

- $ 2\ \leq\ N\ \leq\ 100 $
- $ 1\ \leq\ a_i,b_i\ \leq\ N(1\leq\ i\leq\ N-1) $
- 与えられるグラフは木である

### Sample Explanation 1

頂点 $ 6 $ を用意し、頂点 $ 2 $ と結んだとき、頂点 $ (1,4,5,6) $ を赤で、頂点 $ (2,3) $ を青で塗る彩色は良い彩色です。 $ 1 $ 色で全頂点を塗る彩色は良い彩色ではないので、作った木のカラフルさは $ 2 $ となることが分かります。 この場合が最適であり、葉は $ 4 $ つあるので、$ 2 $ と $ 4 $ を出力します。

## 样例 #1

### 输入

```
5

1 2

2 3

3 4

3 5
```

### 输出

```
2 4
```

## 样例 #2

### 输入

```
8

1 2

2 3

4 3

5 4

6 7

6 8

3 6
```

### 输出

```
3 4
```

## 样例 #3

### 输入

```
10

1 2

2 3

3 4

4 5

5 6

6 7

3 8

5 9

3 10
```

### 输出

```
4 6
```

## 样例 #4

### 输入

```
13

5 6

6 4

2 8

4 7

8 9

3 2

10 4

11 10

2 4

13 10

1 8

12 1
```

### 输出

```
4 12
```



---

---
title: "[AGC024E] Sequence Growing Hard"
layout: "post"
diff: 省选/NOI-
pid: AT_agc024_e
tag: []
---

# [AGC024E] Sequence Growing Hard

## 题目描述

[problemUrl]: https://atcoder.jp/contests/agc024/tasks/agc024_e

次の条件を満たす数列の組 $ (A_0,A_1,...,A_N) $ としてありうるものの個数を $ M $ で割ったあまりを求めてください。

- 全ての $ i(0\leq\ i\leq\ N) $ に対し、$ A_i $ は $ 1 $ 以上 $ K $ 以下の整数からなる長さ $ i $ の数列である
- 全ての $ i(1\leq\ i\leq\ N) $ に対し、$ A_{i-1} $ は $ A_i $ の部分列である。すなわち、ある $ 1\leq\ x_i\leq\ i $ が存在し、$ A_i $ の $ x_i $ 文字目を取り除いてできる数列が $ A_{i-1} $ に一致する
- 全ての $ i(1\leq\ i\leq\ N) $ に対し、$ A_i $ は辞書順で $ A_{i-1} $ より大きい

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ K $ $ M $

## 输出格式

数列の組 $ (A_0,A_1,...,A_N) $ としてありうるものの個数を $ M $ で割ったあまりを出力せよ。

## 说明/提示

### 制約

- $ 1\ \leq\ N,K\ \leq\ 300 $
- $ 2\ \leq\ M\ \leq\ 10^9 $
- $ N,K,M $ は整数である

### Sample Explanation 1

以下の $ 5 $ つの組が条件を満たします。 - $ (),(1),(1,1) $ - $ (),(1),(1,2) $ - $ (),(1),(2,1) $ - $ (),(2),(2,1) $ - $ (),(2),(2,2) $

## 样例 #1

### 输入

```
2 2 100
```

### 输出

```
5
```

## 样例 #2

### 输入

```
4 3 999999999
```

### 输出

```
358
```

## 样例 #3

### 输入

```
150 150 998244353
```

### 输出

```
186248260
```



---

---
title: "[AGC025D] Choosing Points"
layout: "post"
diff: 省选/NOI-
pid: AT_agc025_d
tag: []
---

# [AGC025D] Choosing Points

## 题目描述

[problemUrl]: https://atcoder.jp/contests/agc025/tasks/agc025_d

高橋君は平面上の点集合について研究しています。 高橋君にとって、座標平面上の点の集合 $ S $ が *いい集合* であるとは、$ S $ が以下の条件をともに満たすことを指します。

- $ S $ に属するどの $ 2 $ 点間の距離も $ \sqrt{D_1} $ でない。
- $ S $ に属するどの $ 2 $ 点間の距離も $ \sqrt{D_2} $ でない。

ただし、$ D_1,D_2 $ は高橋君の定めた正整数の定数です。

ここで、$ X $ を座標平面上の格子点 $ (i,j) $ であって $ 0\ ≦\ i,j\ <\ 2N $ を満たす点 $ (i,j) $ 全体からなる集合としましょう。 研究者の高橋君は、$ D_1,D_2 $ をどのように選んでも、$ X $ からうまく $ N^2 $ 個の点を選ぶことで、それらがいい集合をなすことを示しました。 しかし、実際にどのように選べばいい集合になるかは分かっていません。 そこで、高橋君の代わりに、$ X $ のサイズ $ N^2 $ の部分集合であって、いい集合となるものを見つけてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ D_1 $ $ D_2 $

## 输出格式

条件を満たすように選んだ相異なる $ N^2 $ 個の点を以下の形式で出力せよ。

> $ x_1 $ $ y_1 $ $ x_2 $ $ y_2 $ : $ x_{N^2} $ $ y_{N^2} $

ただし、$ (x_i,y_i) $ は選んだ点の $ i $ 番目の点を表し、$ x_i,y_i $ は整数かつ $ 0\ ≦\ x_i,y_i\ <\ 2N $ を満たす必要がある。 また、点はどのような順番で出力しても構わず、解が複数ある場合は、いかなるものを出力しても構わないことに注意せよ。

## 说明/提示

### 制約

- $ 1\ ≦\ N\ ≦\ 300 $
- $ 1\ ≦\ D_1\ ≦\ 2×10^5 $
- $ 1\ ≦\ D_2\ ≦\ 2×10^5 $
- 入力される値は全て整数である

### Sample Explanation 1

この場合 $ 2 $ 点間の距離としてありうる値は $ 2 $ と $ 2\sqrt{2} $ のみであるから、確かに条件を満たします。

## 样例 #1

### 输入

```
2 1 2
```

### 输出

```
0 0

0 2

2 0

2 2
```

## 样例 #2

### 输入

```
3 1 5
```

### 输出

```
0 0

0 2

0 4

1 1

1 3

1 5

2 0

2 2

2 4
```



---

---
title: "[AGC026D] Histogram Coloring"
layout: "post"
diff: 省选/NOI-
pid: AT_agc026_d
tag: []
---

# [AGC026D] Histogram Coloring

## 题目描述

[problemUrl]: https://atcoder.jp/contests/agc026/tasks/agc026_d

高さ $ 10^9 $ マス，幅 $ N $ マスのグリッドを考え，左から $ i(1\ \leq\ i\ \leq\ N) $ 番目，下から $ j(1\ \leq\ j\ \leq\ 10^9) $ 番目のマス目を $ (i,\ j) $ と表すことにします。

すぬけ君は各 $ i\ =\ 1,\ 2,\ ...,\ N $ について，左から $ i $ 列目のマスたちを，下から $ h_i $ 個を残すように切り取りました。 そして赤，青の絵の具を使い，マス目を絵の具で塗ります。 以下の条件を満たすような塗り分け方は何通りか求めて下さい。ただし答えは非常に大きくなるので，$ 10^9+7 $ で割った余りを出力して下さい。

- 全ての(切り取った後に残された)マスたちは，赤，青のどちらかの色に塗られている。
- 全ての $ 1\ \leq\ i\ \leq\ N-1 $, $ 1\ \leq\ j\ \leq\ min(h_i,\ h_{i+1})-1 $ について，$ (i,\ j),\ (i,\ j+1),\ (i+1,\ j),\ (i+1,\ j+1) $ の4マスのなかにちょうど $ 2 $ 個ずつ赤色と青色のマスが存在する。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ h_1 $ $ h_2 $ $ ... $ $ h_N $

## 输出格式

塗り分け方の個数を $ 10^9+7 $ で割った余りを出力せよ。

## 说明/提示

### 制約

- $ 1\ \leq\ N\ \leq\ 100 $
- $ 1\ \leq\ h_i\ \leq\ 10^9 $

### Sample Explanation 1

以下に塗り分け方の一例を示します。 ``` \# \#\# \# \#\#\# \#\#\#\#\# \#\#\#\#\#\#\#\#\#\#\#\#```

### Sample Explanation 2

以下の $ 6 $ 通りの塗り分け方が存在します。 ``` \#\# \#\# \#\# \#\# \#\# \#\#\#\# \#\# \#\# \#\# \#\# \#\#```

### Sample Explanation 3

どのような塗り分け方も条件を満たします。

### Sample Explanation 4

塗り分け方の個数を $ 10^9\ +\ 7 $ で割った余りを出力することに注意して下さい。

## 样例 #1

### 输入

```
9

2 3 5 4 1 2 4 2 1
```

### 输出

```
12800
```

## 样例 #2

### 输入

```
2

2 2
```

### 输出

```
6
```

## 样例 #3

### 输入

```
5

2 1 2 1 2
```

### 输出

```
256
```

## 样例 #4

### 输入

```
9

27 18 28 18 28 45 90 45 23
```

### 输出

```
844733013
```



---

---
title: "[AGC026E] Synchronized Subsequence"
layout: "post"
diff: 省选/NOI-
pid: AT_agc026_e
tag: []
---

# [AGC026E] Synchronized Subsequence

## 题目描述

[problemUrl]: https://atcoder.jp/contests/agc026/tasks/agc026_e

$ N $ 個の `a` と $ N $ 個の `b` からなる，長さ $ 2N $ の文字列 $ S $ が与えられます。

あなたは $ S $ からいくつかの文字を選びます。ただし各 $ i\ =\ 1,2,...,N $ について，$ S $ で $ i $ 番目に出現する `a` と $ i $ 番目に出現する `b` から片方だけ選ぶことは出来ません。 そして選んだ文字たちを( $ S $ での順番通りに)結合します。

こうして得られる文字列のうち，辞書順で最大のものを求めて下さい。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ S $

## 输出格式

条件を満たす $ T $ のうち，辞書順で最大のものを出力して下さい。

## 说明/提示

### 制約

- $ 1\ \leq\ N\ \leq\ 3000 $
- $ S $ は $ N $ 個の `a` と `b` からなる，長さ $ 2N $ の文字列である。

### Sample Explanation 1

$ S $ の $ 1,\ 3,\ 4,\ 6 $ 番目の文字からなる部分列 $ T $ は，条件を満たします。

### Sample Explanation 2

全ての文字を選ぶことも可能です。

## 样例 #1

### 输入

```
3

aababb
```

### 输出

```
abab
```

## 样例 #2

### 输入

```
3

bbabaa
```

### 输出

```
bbabaa
```

## 样例 #3

### 输入

```
6

bbbaabbabaaa
```

### 输出

```
bbbabaaa
```

## 样例 #4

### 输入

```
9

abbbaababaababbaba
```

### 输出

```
bbaababababa
```



---

---
title: "[AGC027B] Garbage Collector"
layout: "post"
diff: 省选/NOI-
pid: AT_agc027_b
tag: []
---

# [AGC027B] Garbage Collector

## 题目描述

[problemUrl]: https://atcoder.jp/contests/agc027/tasks/agc027_b

すぬけ君は掃除ロボットを使って部屋を掃除することにしました。

数直線上に $ N $ 個のゴミが落ちています。 左から $ i $ 番目のゴミは位置 $ x_i $ にあります。 これらのゴミを位置 $ 0 $ にあるゴミ箱に入れたいです。

ゴミの位置に関して、$ 0\ <\ x_1\ <\ x_2\ <\ ...\ <\ x_{N}\ \leq\ 10^{9} $ が成立します。

掃除ロボットははじめ位置 $ 0 $ にいます。ロボットは数直線上を自由に動くことができ、ゴミのある位置にいくとゴミを拾うことができます。 ゴミは同時に何個でも運ぶことでき、ゴミ箱の位置に行くとゴミをゴミ箱に入れることができます。ゴミをゴミ箱以外の場所に置くことは許されません。

ロボットがゴミを拾う、あるいは($ 1 $ 個以上の)ゴミをゴミ箱に入れるとき $ X $ だけエネルギーを消費します。ゴミをゴミ箱に入れるときに消費するエネルギーはゴミの個数にかかわらず $ X $ です。 また、ロボットが $ k $ 個のゴミを運んでいるとき、距離 $ 1 $ だけ移動するのに $ (k+1)^{2} $ だけエネルギーを消費します。

$ N $ 個のゴミを全てゴミ箱に入れるために必要なエネルギーの最小値を求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ X $ $ x_1 $ $ x_2 $ $ ... $ $ x_{N} $

## 输出格式

答えを出力せよ。

## 说明/提示

### 制約

- $ 1\ \leq\ N\ \leq\ 2\ \times\ 10^{5} $
- $ 0\ <\ x_1\ <\ ...\ <\ x_N\ \leq\ 10^9 $
- $ 1\ \leq\ X\ \leq\ 10^9 $
- 与えられる入力は全て整数

### 部分点

- $ N\ \leq\ 2000 $ を満たすデータセットに正解した場合、$ 400 $ 点が与えられる。

### Sample Explanation 1

\- $ 10 $ のエネルギーを消費して、位置 $ 10 $ に移動する - $ 100 $ のエネルギーを消費して、ゴミを取る - $ 36 $ のエネルギーを消費して、位置 $ 1 $ に移動する - $ 100 $ のエネルギーを消費して、ゴミを取る - $ 9 $ のエネルギーを消費して、位置 $ 0 $ に移動する - $ 100 $ のエネルギーを消費して、$ 2 $ つのゴミをゴミ箱に入れる このように行動したとき、消費したエネルギーは $ 10+100+36+100+9+100=355 $ となります。

## 样例 #1

### 输入

```
2 100

1 10
```

### 输出

```
355
```

## 样例 #2

### 输入

```
5 1

1 999999997 999999998 999999999 1000000000
```

### 输出

```
19999999983
```

## 样例 #3

### 输入

```
10 8851025

38 87 668 3175 22601 65499 90236 790604 4290609 4894746
```

### 输出

```
150710136
```

## 样例 #4

### 输入

```
16 10

1 7 12 27 52 75 731 13856 395504 534840 1276551 2356789 9384806 19108104 82684732 535447408
```

### 输出

```
3256017715
```



---

---
title: "[AGC027D] Modulo Matrix"
layout: "post"
diff: 省选/NOI-
pid: AT_agc027_d
tag: []
---

# [AGC027D] Modulo Matrix

## 题目描述

[problemUrl]: https://atcoder.jp/contests/agc027/tasks/agc027_d

整数 $ N $ が与えられます。

以下の条件を満たすような $ N\ \times\ N $ 行列 $ a $ をどれか $ 1 $ つ構成してください。この問題の制約下で、必ず解が存在することが証明できます。

- $ 1\ \leq\ a_{i,j}\ \leq\ 10^{15} $
- $ a_{i,j} $ は相異なる整数である
- ある正の整数 $ m $ が存在して、上下左右に隣接する $ 2 $ つの数 $ x,y $ をどこから取り出しても、$ {\rm\ max}(x,y) $ を $ {\rm\ min}(x,y) $ で割ったあまりは $ m $ となる

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $

## 输出格式

答えを以下の形式で出力せよ。

> $ a_{1,1} $ $ ... $ $ a_{1,N} $ $ : $ $ a_{N,1} $ $ ... $ $ a_{N,N} $

## 说明/提示

### 制約

- $ 2\ \leq\ N\ \leq\ 500 $

### Sample Explanation 1

\- どの隣接した $ 2 $ つの数についても、大きい方の数を小さい数で割ったあまりが $ 3 $ となっています

## 样例 #1

### 输入

```
2
```

### 输出

```
4 7

23 10
```



---

---
title: "[AGC028B] Removing Blocks"
layout: "post"
diff: 省选/NOI-
pid: AT_agc028_b
tag: []
---

# [AGC028B] Removing Blocks

## 题目描述

[problemUrl]: https://atcoder.jp/contests/agc028/tasks/agc028_b

$ N $ 個のブロックが一列に並んでおり、左から右へ順に $ 1 $ から $ N $ の番号がついています。 それぞれのブロックには重さが定まっており、ブロック $ i $ の重さは $ A_i $ です。 すぬけ君は、これらのブロックに対して次の操作を $ N $ 回行います。

- まだ取り除かれていないブロックを $ 1 $ つ選んで取り除く。 この操作のコストは、取り除くブロックと連結なブロック（取り除くブロック自身も含む）の重さの総和となる。 $ 2 $ つのブロック $ x $, $ y $ ( $ x\ \leq\ y $ ) が連結であるとは、すべての $ z $ ( $ x\ \leq\ z\ \leq\ y $ ) について、ブロック $ z $ が取り除かれていないことを意味する。

ブロックを取り除く順番はちょうど $ N! $ 通りあります。 $ N! $ 通りのすべての順番について $ N $ 回の操作のコストの合計を求め、その総和を求めてください。 ただし、答えは非常に大きくなることがあるので、$ 10^9+7 $ で割った余りを求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ A_1 $ $ A_2 $ $ ... $ $ A_N $

## 输出格式

$ N! $ 通りのすべての順番について $ N $ 回の操作のコストの合計を求め、その総和を $ 10^9+7 $ で割った余りを出力せよ。

## 说明/提示

### 制約

- $ 1\ \leq\ N\ \leq\ 10^5 $
- $ 1\ \leq\ A_i\ \leq\ 10^9 $
- 入力はすべて整数である。

### Sample Explanation 1

ブロック $ 1 $, $ 2 $ の順で取り除く場合を考えます。 まず、最初の操作では、ブロック $ 1 $ と $ 2 $ が連結なので、操作のコストは $ 1+2=3 $ です。 次の操作では、ブロック $ 2 $ しか残っていないので、操作のコストは $ 2 $ です。 よって、この順で取り除く場合のコストの合計は $ 3+2=5 $ です。 ブロック $ 2 $, $ 1 $ の順で取り除く場合を考えます。 まず、最初の操作では、ブロック $ 1 $ と $ 2 $ が連結なので、操作のコストは $ 1+2=3 $ です。 次の操作では、ブロック $ 1 $ しか残っていないので、操作のコストは $ 1 $ です。 よって、この順で取り除く場合のコストの合計は $ 3+1=4 $ です。 上記より、答えは $ 5+4=9 $ となります。

## 样例 #1

### 输入

```
2

1 2
```

### 输出

```
9
```

## 样例 #2

### 输入

```
4

1 1 1 1
```

### 输出

```
212
```

## 样例 #3

### 输入

```
10

1 2 4 8 16 32 64 128 256 512
```

### 输出

```
880971923
```



---

---
title: "[AGC028C] Min Cost Cycle"
layout: "post"
diff: 省选/NOI-
pid: AT_agc028_c
tag: []
---

# [AGC028C] Min Cost Cycle

## 题目描述

[problemUrl]: https://atcoder.jp/contests/agc028/tasks/agc028_c

$ N $ 頂点の重み付き有向グラフがあります。 各頂点には $ 2 $ つの整数が書かれており、頂点 $ i $ には $ A_i $ と $ B_i $ が書かれています。

このグラフには、任意の $ 1\ \leq\ x,y\ \leq\ N $ について 頂点 $ x $ から頂点 $ y $ へ向かう辺があり、その重みは $ {\rm\ min}(A_x,B_y) $ です。

このグラフの有向サイクルであって、すべての頂点をちょうど $ 1 $ 度ずつ通るものを考えます。 そのようなサイクルの辺の重みの総和の最小値を求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ A_1 $ $ B_1 $ $ A_2 $ $ B_2 $ $ : $ $ A_N $ $ B_N $

## 输出格式

すべての頂点をちょうど $ 1 $ 度ずつ通るサイクルの辺の重みの総和の最小値を出力せよ。

## 说明/提示

### 制約

- $ 2\ \leq\ N\ \leq\ 10^5 $
- $ 1\ \leq\ A_i\ \leq\ 10^9 $
- $ 1\ \leq\ B_i\ \leq\ 10^9 $
- 入力はすべて整数である。

### Sample Explanation 1

頂点 $ 1→3→2→1 $ というサイクルを考えると、その辺の重みは、$ {\rm\ min}(A_1,B_3)=1 $, $ {\rm\ min}(A_3,B_2)=2 $, $ {\rm\ min}(A_2,B_1)=4 $ となり、 その総和は $ 7 $ になります。 辺の重みの総和を $ 7 $ より小さくすることは出来ないので、答えは $ 7 $ になります。

## 样例 #1

### 输入

```
3

1 5

4 2

6 3
```

### 输出

```
7
```

## 样例 #2

### 输入

```
4

1 5

2 6

3 7

4 8
```

### 输出

```
10
```

## 样例 #3

### 输入

```
6

19 92

64 64

78 48

57 33

73 6

95 73
```

### 输出

```
227
```



---

---
title: "[AGC029E] Wandering TKHS"
layout: "post"
diff: 省选/NOI-
pid: AT_agc029_e
tag: []
---

# [AGC029E] Wandering TKHS

## 题目描述

[problemUrl]: https://atcoder.jp/contests/agc029/tasks/agc029_e

高橋君の会社は $ N $ 個の部屋からなり、各部屋には $ 1 $ から $ N $ の番号が割り振られています。 また、$ N-1 $ 本の通路があり、$ i $ 番目の通路は部屋 $ a_i $ と部屋 $ b_i $ を繋いでいます。 どの $ 2 $ つの部屋の間もこれらの通路のみを通って移動できることが分かっています。

今高橋君はある部屋に迷い込んでしまいました。この部屋を $ r $ とします。 そこで、高橋君は自分の部屋である部屋 $ 1 $ に戻るために、以下の方法で移動することを繰り返すことにしました。

- 今まで訪れた部屋に隣接する部屋の中でまだ訪れていない部屋の内、番号が一番小さい部屋に移動する。

部屋 $ 1 $ に戻るまでに行う必要のある移動の回数を $ c_r $ とします。 $ c_2,c_3,...,c_N $ をすべて求めてください。 ただし、$ 1 $ 回の移動でいくつの通路を通るとしても、移動は $ 1 $ 回として数えられることに注意してください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ a_1 $ $ b_1 $ $ : $ $ a_{N-1} $ $ b_{N-1} $

## 输出格式

各 $ r $ に対して $ c_r $ を以下の形式に従って出力せよ。

> $ c_2 $ $ c_3 $ $ ... $ $ c_N $

## 说明/提示

### 制約

- $ 2\ \leq\ N\ \leq\ 2\times\ 10^5 $
- $ 1\ \leq\ a_i,b_i\ \leq\ N $
- $ a_i\ \neq\ b_i $
- 入力で与えられるグラフは木である。

### Sample Explanation 1

例えば部屋 $ 2 $ に迷い込んでいた場合、高橋君は以下のように移動します。 - 部屋 $ 6 $ に移動する。 - 部屋 $ 3 $ に移動する。 - 部屋 $ 4 $ に移動する。 - 部屋 $ 5 $ に移動する。 - 部屋 $ 1 $ に移動する。

## 样例 #1

### 输入

```
6

1 5

5 6

6 2

6 3

6 4
```

### 输出

```
5 5 5 1 5
```

## 样例 #2

### 输入

```
6

1 2

2 3

3 4

4 5

5 6
```

### 输出

```
1 2 3 4 5
```

## 样例 #3

### 输入

```
10

1 5

5 6

6 10

6 4

10 3

10 8

8 2

4 7

4 9
```

### 输出

```
7 5 3 1 3 4 7 4 5
```



---

---
title: "[AGC030C] Coloring Torus"
layout: "post"
diff: 省选/NOI-
pid: AT_agc030_c
tag: []
---

# [AGC030C] Coloring Torus

## 题目描述

[problemUrl]: https://atcoder.jp/contests/agc030/tasks/agc030_c

$ n\ \times\ n $ のマス目に対して，上から $ r+1 $ 行目，左から $ c+1 $ 列目にあるマスを $ (r,\ c) $ で表します． このマス目の $ K $ 色でのよい塗り方とは，次のような塗り方を言います：

- それぞれのマスは $ K $ 色のいずれかで塗られている．
- $ K $ 色のうちすべての色が，いずれかのマスに塗られている．
- $ K $ 色にそれぞれ $ 1,\ 2,\ ...,\ K $ の番号をつける．任意の色 $ i,\ j $ ($ 1\ \leq\ i\ \leq\ K,\ 1\ \leq\ j\ \leq\ K $) に対して，色 $ i $ のマスに接している色 $ j $ のマスの個数は，色 $ i $ のマスの選び方によらず等しい．ここで，マス $ (r,\ c) $ に接しているマスは，$ ((r-1)\;\ mod\;\ n,\ c),\ ((r+1)\;\ mod\;\ n,\ c),\ (r,\ (c-1)\;\ mod\;\ n),\ (r,\ (c+1)\;\ mod\;\ n) $ とする (これら $ 4 $ つの中に同じマスが複数回現れる場合は，そのマスの色は重複している回数だけ数えるものとする)．

$ K $ が与えられたとき，**$ 1 $ 以上 $ 500 $ 以下の $ n $** を自由に選んで，$ n\ \times\ n $ のマス目の $ K $ 色でのよい塗り方を構成してください． この問題の制約の下，これは常に可能であることが証明できます．

## 输入格式

入力は以下の形式で標準入力から与えられる．

> $ K $

## 输出格式

次の形式で出力せよ．

> $ n $ $ c_{0,0} $ $ c_{0,1} $ $ ... $ $ c_{0,n-1} $ $ c_{1,0} $ $ c_{1,1} $ $ ... $ $ c_{1,n-1} $ $ : $ $ c_{n-1,0} $ $ c_{n-1,1} $ $ ... $ $ c_{n-1,n-1} $

$ n $ はマス目の大きさを表す．$ 1\ \leq\ n\ \leq\ 500 $ でなければならない． $ c_{r,c} $ はマス $ (r,\ c) $ をどの色で塗るべきかを表す $ 1\ \leq\ c_{r,c}\ \leq\ K $ なる整数である．

## 说明/提示

### 制約

- $ 1\ \leq\ K\ \leq\ 1000 $

### Sample Explanation 1

\- どの色 $ 1 $ のマスも，$ 3 $ 個の色 $ 1 $ のマス，$ 1 $ 個の色 $ 2 $ のマスと接しています． - どの色 $ 2 $ のマスも，$ 2 $ 個の色 $ 1 $ のマス，$ 2 $ 個の色 $ 2 $ のマスと接しています． 次のような出力は不正解となります： ``` 2 1 2 2 2 ``` ``` 3 1 1 1 1 1 1 1 1 1 ```

## 样例 #1

### 输入

```
2
```

### 输出

```
3

1 1 1

1 1 1

2 2 2
```

## 样例 #2

### 输入

```
9
```

### 输出

```
3

1 2 3

4 5 6

7 8 9
```



---

---
title: "[AGC030D] Inversion Sum"
layout: "post"
diff: 省选/NOI-
pid: AT_agc030_d
tag: []
---

# [AGC030D] Inversion Sum

## 题目描述

[problemUrl]: https://atcoder.jp/contests/agc030/tasks/agc030_d

長さ $ N $ の整数列 $ A_1,A_2,...,A_N $ が与えられます。$ Q $ 回の操作を順に行います。 $ i $ 回目の操作は $ 2 $ つの整数 $ X_i,Y_i $ を用いて表され、以下の $ 2 $ つの操作からちょうど片方を選んで行います。

- $ A_{X_i} $ と $ A_{Y_i} $ の値を入れ替える
- 何もしない

操作の行い方は $ 2^Q $ 通りあります。これらすべての操作の行い方に対する最終的な数列の反転数をすべて足し合わせたものを $ 10^9+7 $ で割ったあまりを求めてください。

ただし、数列 $ P_1,P_2,...,P_M $ の反転数とは、$ 1\leq\ i\ <\ j\leq\ M $ かつ $ P_i\ >\ P_j $ を満たすような整数の組 $ (i,j) $ の個数です。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ Q $ $ A_1 $ $ : $ $ A_N $ $ X_1 $ $ Y_1 $ $ : $ $ X_Q $ $ Y_Q $

## 输出格式

最終的な数列の反転数の総和を $ 10^9+7 $ で割ったあまりを出力せよ。

## 说明/提示

### 制約

- $ 1\ \leq\ N\ \leq\ 3000 $
- $ 0\ \leq\ Q\ \leq\ 3000 $
- $ 0\ \leq\ A_i\ \leq\ 10^9(1\leq\ i\leq\ N) $
- $ 1\ \leq\ X_i,Y_i\ \leq\ N(1\leq\ i\leq\ Q) $
- $ X_i\neq\ Y_i(1\leq\ i\leq\ Q) $
- 入力はすべて整数である

### Sample Explanation 1

操作の行い方としてありうるものは次の $ 4 $ 通りです。 - $ 1 $ 回目も $ 2 $ 回目は何もしない。最終的な数列は $ 1,2,3 $ であり、反転数は $ 0 $ である。 - $ 1 $ 回目は何もせず、$ 2 $ 回目は入れ替えを行う。最終的な数列は $ 3,2,1 $ であり、反転数は $ 3 $ である。 - $ 1 $ 回目は入れ替えを行い、$ 2 $ 回目は何もしない。最終的な数列は $ 2,1,3 $ であり、反転数は $ 1 $ である。 - $ 1 $ 回目も $ 2 $ 回目も入れ替えを行う。最終的な数列は $ 3,1,2 $ であり、反転数は $ 2 $ である。 これらの反転数の総和である、$ 0+3+1+2=6 $ を出力します。

## 样例 #1

### 输入

```
3 2

1

2

3

1 2

1 3
```

### 输出

```
6
```

## 样例 #2

### 输入

```
5 3

3

2

3

1

4

1 5

2 3

4 2
```

### 输出

```
36
```

## 样例 #3

### 输入

```
9 5

3

1

4

1

5

9

2

6

5

3 5

8 9

7 9

3 2

3 8
```

### 输出

```
425
```



---

---
title: "[AGC038D] Unique Path"
layout: "post"
diff: 省选/NOI-
pid: AT_agc038_d
tag: ['分类讨论']
---

# [AGC038D] Unique Path

## 题目描述

[problemUrl]: https://atcoder.jp/contests/agc038/tasks/agc038_d

すぬけ君は、$ 0 $ から $ N-1 $ までの番号のついた $ N $ 個の頂点と、$ M $ 本の辺からなる無向グラフをお母さんにもらいました。 このグラフは連結で、また、多重辺や自己ループは存在しませんでした。

ある日、すぬけ君はこのグラフを壊してしまいました。 しかし、すぬけ君はこのグラフについて、$ Q $ 個の情報を覚えています。 $ i $ ($ 0\ \leq\ i\ \leq\ Q-1 $) 番目の情報は整数 $ A_i,B_i,C_i $ で表され、次のことを意味します。

- $ C_i=0 $ の時: 頂点 $ A_i $ から $ B_i $ に向かう単純パス（同じ頂点を $ 2 $ 度通らないパス）が、$ 1 $ つしか存在しない。
- $ C_i=1 $ の時: 頂点 $ A_i $ から $ B_i $ に向かう単純パスが $ 2 $ つ以上存在する。

すぬけ君は自分の記憶に自信がないので、これら $ Q $ 個の情報に合致するグラフが存在するのかどうか心配になりました。 すぬけくんの記憶に合致するグラフが存在するかどうか判定してください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ M $ $ Q $ $ A_0 $ $ B_0 $ $ C_0 $ $ A_1 $ $ B_1 $ $ C_1 $ $ \vdots $ $ A_{Q-1} $ $ B_{Q-1} $ $ C_{Q-1} $

## 输出格式

すぬけくんの記憶に合致するグラフが存在する場合は `Yes`、そうでない場合は `No` と出力せよ。

## 说明/提示

### 制約

- $ 2\ \leq\ N\ \leq\ 10^5 $
- $ N-1\ \leq\ M\ \leq\ N\ \times\ (N-1)/2 $
- $ 1\ \leq\ Q\ \leq\ 10^5 $
- $ 0\ \leq\ A_i,B_i\ \leq\ N-1 $
- $ A_i\ \neq\ B_i $
- $ 0\ \leq\ C_i\ \leq\ 1 $
- 入力される値はすべて整数である。

### Sample Explanation 1

例えば、辺集合が $ (0,1),(1,2),(1,4),(2,3),(2,4) $ であるグラフを考えると、これは条件を満たします。

## 样例 #1

### 输入

```
5 5 3

0 1 0

1 2 1

2 3 0
```

### 输出

```
Yes
```

## 样例 #2

### 输入

```
4 4 3

0 1 0

1 2 1

2 3 0
```

### 输出

```
No
```

## 样例 #3

### 输入

```
10 9 9

7 6 0

4 5 1

9 7 0

2 9 0

2 3 0

4 1 0

8 0 0

9 1 0

3 0 0
```

### 输出

```
No
```



---

---
title: "Attack to a Tree"
layout: "post"
diff: 省选/NOI-
pid: AT_aising2019_e
tag: []
---

# Attack to a Tree

## 题目描述

一棵有 $N$ 个节点的树，节点编号 $1$ 到 $N$。$(N-1)$ 条边中的第 $i$ 条连接节点 $U_i$ 和节点 $V_i$。点 $v$ 有非零点权 $A_v$。

现在要删去一部分边，使得各个连通块均满足以下两个条件之一：

- 连通块内点的点权均为正数；
- 连通块内点的点权和为负数。

请求出删去的边数的最小值。

## 输入格式

第一行输入单个整数 $N$。

第二行输入 $N$ 个整数，依次表示 $A_1$ 到 $A_N$。

最后 $(N-1)$ 行，第 $i$ 行输入两个整数 $U_i$ 和 $V_i$。

## 输出格式

一行一个整数表示答案。

## 说明/提示

#### 样例 #1 解释

切断第 $1,2$ 条边即可。

#### 数据规模与约定

对于全部测试数据，保证：

- $1\le N\le 5000$；
- 当 $1\le i\le N$ 时，$1\le |A_i|\le 10^9$。
- 当 $1\le i\le N-1$ 时，$1\le U_i,V_i\le N$，$U_i\neq V_i$。

## 样例 #1

### 输入

```
7

-2 7 5 6 -8 3 4

1 2

2 3

2 4

1 5

5 6

5 7
```

### 输出

```
1
```

## 样例 #2

### 输入

```
4

1 2 3 4

1 2

1 3

1 4
```

### 输出

```
0
```

## 样例 #3

### 输入

```
6

10 -1 10 -1 10 -1

1 2

2 3

3 4

4 5

5 6
```

### 输出

```
5
```

## 样例 #4

### 输入

```
8

-2 3 6 -2 -2 -5 3 2

3 4

7 6

6 2

8 2

5 3

1 8

3 7
```

### 输出

```
3
```

## 样例 #5

### 输入

```
10

3 4 9 6 1 5 -1 10 -10 -10

7 4

5 6

8 1

9 5

7 1

10 3

2 8

4 10

9 2
```

### 输出

```
3
```



---

---
title: "Two Snuke"
layout: "post"
diff: 省选/NOI-
pid: AT_aising2020_f
tag: []
---

# Two Snuke

## 题目描述

给你一个整数 $N$。你的任务是选择整数 $s_1, s_2, n_1, n_2, u_1, u_2, k_1, k_2, e_1, e_2$，这些整数需要满足以下六个条件：

1. $0 \leq s_1 < s_2$
2. $0 \leq n_1 < n_2$
3. $0 \leq u_1 < u_2$
4. $0 \leq k_1 < k_2$
5. $0 \leq e_1 < e_2$
6. $s_1 + s_2 + n_1 + n_2 + u_1 + u_2 + k_1 + k_2 + e_1 + e_2 \leq N$

对于所有满足以上条件的 $(s_1, s_2, n_1, n_2, u_1, u_2, k_1, k_2, e_1, e_2)$ 组合，计算 $(s_2 - s_1)(n_2 - n_1)(u_2 - u_1)(k_2 - k_1)(e_2 - e_1)$ 的值，并将这些结果的总和对 $10^9 + 7$ 取模。

问题涉及 $T$ 个测试用例，请分别计算每个测试用例的结果。

## 输入格式

输入以以下形式通过标准输入提供：

> $T$  
> $\mathrm{case}_1$  
> $\vdots$  
> $\mathrm{case}_T$

每个测试用例由一个整数 $N$ 组成。

## 输出格式

输出结果为 $T$ 行。每一行对应一个测试用例的答案。

## 说明/提示

- 所有输入均为整数。
- $1 \leq T \leq 100$
- $1 \leq N \leq 10^9$

### 示例解释

- 当 $N = 4$ 时，没有满足条件的整数组合，因此结果为 $0$。
- 当 $N = 6$ 时，满足条件的整数组合有以下 $6$ 种：
  - $(0, 1, 0, 1, 0, 1, 0, 1, 0, 1)$
  - $(0, 2, 0, 1, 0, 1, 0, 1, 0, 1)$
  - $(0, 1, 0, 2, 0, 1, 0, 1, 0, 1)$
  - $(0, 1, 0, 1, 0, 2, 0, 1, 0, 1)$
  - $(0, 1, 0, 1, 0, 1, 0, 2, 0, 1)$
  - $(0, 1, 0, 1, 0, 1, 0, 1, 0, 2)$

其中，$(s_2 - s_1)(n_2 - n_1)(u_2 - u_1)(k_2 - k_1)(e_2 - e_1)$ 的结果为 $1$ 的组合有 $1$ 种，结果为 $2$ 的组合有 $5$ 种，故答案为 $11$。

注意结果需对 $10^9 + 7$ 取模。

 **本翻译由 AI 自动生成**

## 样例 #1

### 输入

```
4

4

6

10

1000000000
```

### 输出

```
0

11

4598

257255556
```



---

---
title: "Antennas on Tree"
layout: "post"
diff: 省选/NOI-
pid: AT_apc001_e
tag: []
---

# Antennas on Tree

## 题目描述

[problemUrl]: https://atcoder.jp/contests/apc001/tasks/apc001_e

$ N $ 頂点の木があります。 頂点には $ 0 $ から $ N\ -\ 1 $ まで番号が振られています。 また、$ i $ ($ 0\ <\ =\ i\ <\ N\ -\ 1 $) 番目の辺は頂点 $ a_i $ と $ b_i $ を結んでいます。 各頂点対 $ u $, $ v $ ($ 0\ <\ =\ u,\ v\ <\ N $) に対して、距離 $ d(u,\ v) $ を「パス $ u $-$ v $ に含まれる辺の本数」と定義します。

近い将来、いずれか $ 1 $ 個の頂点に宇宙人が襲来することが予想されています。 すぬけ君は、宇宙人が襲来したときにその頂点をすぐに特定したいと考えています。 そのために、あらかじめいくつかの頂点にアンテナを設置しておくことにしました。

まず、アンテナの個数 $ K $ ($ 1\ <\ =\ K\ <\ =\ N $) を自由に決めます。 そして、すべて相異なる $ K $ 個の頂点 $ x_0 $, $ x_1 $, ..., $ x_{K\ -\ 1} $ を自由に選び、各頂点にアンテナ $ 0 $, $ 1 $, ..., $ K\ -\ 1 $ を設置します。 頂点 $ v $ に宇宙人が襲来すると、アンテナ $ k $ ($ 0\ <\ =\ k\ <\ K $) は距離 $ d(x_k,\ v) $ を出力します。 すぬけ君は、これら $ K $ 個の出力結果をもとに、宇宙人が襲来した頂点を特定します。 よって、どの頂点に宇宙人が襲来してもその頂点を一意に特定するためには、次の条件が成り立つ必要があります。

- 各頂点 $ u $ ($ 0\ <\ =\ u\ <\ N $) に対してベクトル $ (d(x_0,\ u),\ ...,\ d(x_{K\ -\ 1},\ u)) $ を考えたとき、これら $ N $ 通りのベクトルはすべて相異なる。

条件を満たすようにアンテナを設置するとき、アンテナの個数 $ K $ の最小値を求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ a_0 $ $ b_0 $ $ a_1 $ $ b_1 $ $ : $ $ a_{N\ -\ 2} $ $ b_{N\ -\ 2} $

## 输出格式

条件を満たすようにアンテナを設置するとき、アンテナの個数 $ K $ の最小値を出力せよ。

## 说明/提示

### 制約

- $ 2\ <\ =\ N\ <\ =\ 10^5 $
- $ 0\ <\ =\ a_i,\ b_i\ <\ N $
- 与えられるグラフは木である。

### Sample Explanation 1

例えば、頂点 $ 1 $, $ 3 $ にアンテナを設置すればよいです。 このとき、次の $ 5 $ 通りのベクトルはすべて相異なります。 - $ (d(1,\ 0),\ d(3,\ 0))\ =\ (1,\ 1) $ - $ (d(1,\ 1),\ d(3,\ 1))\ =\ (0,\ 2) $ - $ (d(1,\ 2),\ d(3,\ 2))\ =\ (2,\ 2) $ - $ (d(1,\ 3),\ d(3,\ 3))\ =\ (2,\ 0) $ - $ (d(1,\ 4),\ d(3,\ 4))\ =\ (3,\ 1) $

### Sample Explanation 2

例えば、頂点 $ 0 $ にアンテナを設置すればよいです。

### Sample Explanation 3

例えば、頂点 $ 0 $, $ 4 $, $ 9 $ にアンテナを設置すればよいです。

## 样例 #1

### 输入

```
5

0 1

0 2

0 3

3 4
```

### 输出

```
2
```

## 样例 #2

### 输入

```
2

0 1
```

### 输出

```
1
```

## 样例 #3

### 输入

```
10

2 8

6 0

4 1

7 6

2 3

8 6

6 9

2 4

5 8
```

### 输出

```
3
```



---

---
title: "[ARC002D] ボードゲーム"
layout: "post"
diff: 省选/NOI-
pid: AT_arc002_4
tag: []
---

# [ARC002D] ボードゲーム

## 题目描述

高桥君创造了一个游戏。
格状长盘上最左一列为o的阵地，最右一列为x的阵地。
使用随机排列的棋子o和x。
棋子只能一步一步向前走，不能退和斜着走，被对方吃掉的棋子要从棋盘中拿开，另外不能吃掉自己的棋子。
满足以下条件就是胜利：
    a) 把对方的棋子全部吃掉；
    b) 1个自己的棋子到达对方的阵地。
o先走，第一回合不能吃对手也不允许取胜！
为了高桥君获胜，请判断o和x哪个赢。

## 输入格式

共H+1行。
第1行是棋盘的高度H(1≦H≦ 2,000)和棋盘的宽度W(3≦W≦2,000)。
接下来的H行每行有W个c[i,j]，代表棋盘中每个方格上的棋子，如没有棋子，则由“.”代替。

## 输出格式

输出一行，o或x，代表谁赢。
另外最后要换行。

感谢@MarshalKen  提供的翻译



---

---
title: "[ARC003D] シャッフル席替え"
layout: "post"
diff: 省选/NOI-
pid: AT_arc003_4
tag: []
---

# [ARC003D] シャッフル席替え

## 题目描述

[problemUrl]: https://atcoder.jp/contests/arc003/tasks/arc003_4

高橋君が働くAtCoder社では、いつも $ 1 $ つの円形のテーブルの周囲に社員全員で座ってミーティングを行います。  
 それぞれお気に入りの席があるのでいつも席は同じなのですが、今日は席替えをすることにしました。  
 高橋君がランダムに $ 2 $ 人を選び場所を入れ替える動作を決められた回数行った後の席配置が新しい席配置になります。  
 しかし、残念なことにAtCoder社には隣り合わせにしてしまうとミーティング中におしゃべりをしてミーティングを邪魔してしまう $ 2 $ 人組が存在します。  
 高橋君は真面目なので、ミーティングが滞りなく行われるようにそのような $ 2 $ 人組は $ 1 $ 組も隣り合わせにしたくないと思っています。  
 席替えを行った後に、隣り合わせにしてはいけない $ 2 $ 人組が $ 1 $ 組も隣り合わない確率を求めなさい。 入力は以下の形式で与えられる。

> $ N $ $ M $ $ K $ $ A_{1} $ $ B_{1} $ $ A_{2} $ $ B_{2} $ : : : : $ A_{M} $ $ B_{M} $

- $ 1 $ 行目は、社員の総数として整数 $ N\ (2\ ≦\ N\ ≦11 $)、隣り合わせにしてはいけない $ 2 $ 人組の組数として整数 $ M\ (0\ ≦\ M\ ≦\ 10) $、入れ替える回数として整数 $ K\ (0\ ≦\ K\ ≦\ 20) $ が空白で区切られて与えられる。
- $ 2 $ 行目から $ M $ 行は、$ 1 $ 行に $ 1 $ 組ずつ隣り合わせにしてはいけない $ 2 $ 人が空白で区切られて与えられる。
- $ i+1 $ 行目の整数 $ A_{i} $ と整数 $ B_{i} $ ($ 0\ ≦\ A_{i}\ )\ は、隣り合わせにしてはいけない\ 2 $ 人を表し、それぞれ高橋君から見て右に何人目であるかを表す。
- なお $ A_i\ =\ 0 $ または、$ B_i\ =\ 0 $ の場合は高橋君自身を表す。
 
 ちょうど $ K $ 回の入れ替えを行った後に、隣同士にしてはいけない $ 2 $ 人組が $ 1 $ 組も隣り合っていない確率を標準出力に $ 1 $ 行で出力せよ。  
 誤差は絶対誤差あるいは相対誤差の少なくとも片方が **$ 2e−3 $** 以下であれば許容する。  
 なお、最後には改行を出力せよ。 ```
<pre class="prettyprint linenums">
4 1 1
0 3
```

 ```
<pre class="prettyprint linenums">
0.333333333333
```

- 席替えを行う前は、$ 4 $ 人の配置は下図のようになっています。
 ![](https://cdn.luogu.com.cn/upload/vjudge_pic/AT_arc003_4/61f407bc249a62aa28587ddc10de70ed39cd35f8.png)

- $ 1 $ 回入れ替えるという席変えを行った時、$ 0 $ と $ 3 $ の $ 2 $ 人が隣合わないようにするには、
- $ 0 $ と $ 1 $ を入れ替える。
 ![](https://cdn.luogu.com.cn/upload/vjudge_pic/AT_arc003_4/b19286769fe6c7ecb9a5050f87e1e287f00c5c8a.png)

- $ 2 $ と $ 3 $ を入れ替える。
 ![](https://cdn.luogu.com.cn/upload/vjudge_pic/AT_arc003_4/61d023ca1bef08a0e0342606ed3ec6d425200be6.png)


- の $ 2 $ 通りです。$ 4 $ 人から $ 2 $ 人を選ぶ方法は $ 6 $ 通り存在するので、条件を満たす確率は $ 2/6 $ となり答えは $ 1/3 $ です。
 
```
<pre class="prettyprint linenums">
5 4 20
0 1
0 2
0 3
0 4
```

 ```
<pre class="prettyprint linenums">
0
```

- 高橋君以外の $ 4 $ 人のうち、高橋君と隣り合うことのできる人が $ 1 $ 人も存在しないので、条件を満たすことはありません。
 
```
<pre class="prettyprint linenums">
5 1 2
0 3
```

 ```
<pre class="prettyprint linenums">
0.52
```

- $ 2 $ 回の入れ替えの後、$ 0 $ と $ 3 $ が隣り合わない入れ替え方法は $ 52 $通りあります。
- $ 5 $ 人から $ 2 $ 人を選ぶことを $ 2 $ 回行うと全ての組み合わせは $ (_5C_2)^2\ =\ 10^2\ =\ 100 $ 通りになります。
- したがって、答えは $ 52÷100\ =\ 0.52 $ です。



---

---
title: "[ARC009D] 覚醒ノ高橋君"
layout: "post"
diff: 省选/NOI-
pid: AT_arc009_4
tag: []
---

# [ARC009D] 覚醒ノ高橋君

## 题目描述

在 AtCoder 国，有很多城镇。为了便于管理，这些城镇被划分为若干市。在每个市内部，城镇间通过公路相连，确保市内的所有城镇都能互相到达。然而，这些公路并不能连接不同的市。因此，为了让所有市之间都可以通达，AtCoder 国允许某些城镇被多个市共享管理。

由于多个市共同管理一个城镇会增加管理难度，因此，这类共享的城镇数量应该尽量减少。具体地说，如果有 $N$ 个市，各市共享的城镇数为 $S_k$，则满足关系 $\sum(S_k \times (k-1)) = N-1$。

高桥君是 AtCoder 国的国土交通大臣，他希望尽可能降低公路整备的总成本。但为了确保计划的可行性，他希望至少制定出前 $k$ 个最佳的整备计划。

整备计划的要求是：
- 无论从哪个城镇到另一个城镇的路线，都应当是唯一的，且不经过重复的城镇。
- "整备公路"意味减少城镇间的道路。

高桥君发现有多种计划可以满足这些条件。因此每一个计划的成本被定义为整备所有公路所花费的总费用。成本越小，计划就越好。

请计算出第 $k$ 好的计划的总成本。如果不存在这样的计划，则输出 `-1`。

### 输入格式

- 第一行包含三个整数：市的数量 $A (1 \le A \le 77)$、总城镇数 $T (1 \le T \le A \times 7)$ 和整数 $k (1 \le k \le 7,777,777)$。
- 接下来是 $2 \times A$ 行，每两个连续的行描述一个市的信息。
  - 第 $2i-1$ 行的整数 $N_i (2 \le N_i \le 7)$ 表示第 $i$ 个市拥有的城镇数量。
  - 第 $2i$ 行的 $N_i$ 个整数 $C_{ij} (1 \le C_{ij} \le T)$ 表示这些城镇的编号。
- 紧接着的是 $M$ 行，每行描述一条公路的信息。
  - 每行三个整数 $city_{i1}$、$city_{i2}$ 和 $cost_i (1 \le cost_i \le 77)$，表示连接城镇 $city_{i1}$ 和 $city_{i2}$ 的公路以及其整备费用。

### 输出格式

- 输出一个整数，表示第 $k$ 好的计划的总整备成本。如果不存在这样的计划，则输出 `-1`。

### 示例输入

```
3 7 1
3
1 2 3
3
3 4 5
3
5 6 7
9
1 2 1
1 3 2
2 3 3
3 4 3
3 5 6
4 5 9
5 6 9
5 7 18
6 7 27
```

### 示例输出

```
13
```

### 数据范围与提示

- 市数量 $A$ 在 1 到 77 之间。
- 城镇数量 $T$ 不超过 $A \times 7$。
- 整备计划的数量 $k$ 在 1 到 7,777,777 之间。
- 每个市的城镇数量 $N_i$ 至少为 2，且最多为 7。
- 每条公路的整备成本 $cost_i$ 为正数，且不超过 77。


 **本翻译由 AI 自动生成**



---

---
title: "[ARC011D] きつねさんからの挑戦状"
layout: "post"
diff: 省选/NOI-
pid: AT_arc011_4
tag: []
---

# [ARC011D] きつねさんからの挑戦状

## 题目描述

狐狸格雷正计划在城市里建造一个秘密的武器工厂。为了不让人类发现工厂的位置，他想把工厂建在这些人居住较少的偏僻地区。你是某国家派去阻止格雷活动的特工，并拿到了一张城市地图。城市由道路和住宅构成，这些都在地图上标示。地图可以看作一个二维平面，直线表示道路，坐标表示住宅。

现在，你收到另一名特工的情报，了解到了关于格雷选择工厂位置的标准：

1. 格雷认为工厂位置的`难以发现度`取决于工厂到最近道路和最近住宅的距离。
2. 假设武器工厂的坐标为 $ (x, y) $，
   - 到最近道路的距离为 $ dist_{road}(x, y) $，
   - 到最近住宅的距离为 $ dist_{point}(x, y) $，
   - 那么`难以发现度`评价函数 $ f(x, y) $ 可以表达为 $ f(x, y) = dist_{road}(x, y) + (dist_{point}(x, y))^2 $。
3. 格雷会选择那个使得评价函数 $ f(x, y) $ 最大的坐标 $ (x, y) $ 来建造工厂。
4. 工厂的坐标 $ (x, y) $ 要满足 $ -R \le x, y \le R $。
5. 这些坐标 $ (x, y) $ 是实数。

你需要根据这些信息和地图，找出格雷可能计划建造工厂的位置，并计算出评价函数 $ f(x, y) $ 的最大值。

### 输入格式

输入首先包括一行三个整数 $ N $、$ M $ 和 $ R $，用空格分隔。
- $ N $ 表示道路的数量，$ 1 \le N \le 16 $。
- $ M $ 表示住宅的数量，$ 1 \le M \le 16 $。
- $ R $ 表示工厂坐标 $ (x, y) $ 的限制条件，$ 1 \le R \le 1,000 $。

接下来有 $ N $ 行，每行三个整数 $ a_i $、$ b_i $、$ c_i $，代表第 $ i $ 条道路的方程 $ a_ix + b_iy + c_i = 0 $。
- 其中 $ a_i、b_i、c_i $ 的值为 $ -1,000 \le a_i, b_i, c_i \le 1,000 $。
- 不存在 $ a_i = 0 $ 且 $ b_i = 0 $ 的情况。

然后接下来有 $ M $ 行，每行两个整数 $ p_j $、$ q_j $，代表第 $ j $ 个住宅的坐标 $ (p_j, q_j) $。
- 对于 $ p_j、q_j $，有 $ -1,000 \le p_j, q_j \le 1,000 $。

注意：可能存在多个相同的直线或坐标。

### 输出格式

请输出在 $ -R \le x, y \le R $ 范围内，`难以发现度`评价函数 $ f(x, y) $ 的最大值。你的结果只要绝对或相对误差不大于 $ 10^{-6} $ 即可。请在输出末尾加换行。

### 数据范围与提示

- $ 1 \le N \le 16 $
- $ 1 \le M \le 16 $
- $ 1 \le R \le 1,000 $
- $ -1,000 \le a_i, b_i, c_i \le 1,000 $
- $ -1,000 \le p_j, q_j \le 1,000 $

 **本翻译由 AI 自动生成**



---

---
title: "[ARC012D] Don't worry. Be Together"
layout: "post"
diff: 省选/NOI-
pid: AT_arc012_4
tag: []
---

# [ARC012D] Don't worry. Be Together

## 题目描述

[problemUrl]: https://atcoder.jp/contests/arc012/tasks/arc012_4

$ N $ 人の人間が、二次元平面上の格子点にいます。  
 各ターンごとに、各自が上下左右いずれかの方向へちょうど $ 1 $ だけ進みます。  
 これを繰り返し、$ T $ ターンの終了時に全員が同時に原点 $ (0,0) $ へ集まるようにしたいです。  
 その時の各自の進み方の組み合わせが何通りあるかを、 $ modulo $ で割った余りを出力してください。  
 どのようにしても全員が同時に原点に集まることができない場合は、 $ 0 $ を出力してください。  
 入力は以下の形式で標準入力から与えられる。

> $ N $ $ T $ $ modulo $ $ x_1 $ $ y_1 $ $ x_2 $ $ y_2 $ : : $ x_N $ $ y_N $

- $ 1 $ 行目に、人間の数を表す整数 $ N(1≦N≦100,000) $ 、移動ターン数を表す整数 $ T(1≦T≦100,000) $ 、正整数 $ modulo $ が、空白区切りで与えられる。
- $ 2 $ 行目から $ N $ 行間における $ i+1(1≦i≦N) $ 行目には、$ i $ 番目の人がいる座標を表す整数 $ x_i,\ y_i $ が、空白区切りで与えられる。
 
 テストデータには以下の $ 3 $ 種類のテストデータセットのいずれかに含まれており、それぞれのデータセットに含まれているテストデータは、以下に示すように与えられる整数 $ modulo,\ x_i,\ y_i $ の範囲が異なっている。  
 あるテストデータセットに含まれているテストデータ全てに対して正しい解を出力できると、それ以外のテストデータセットで不正解を出力しても以下のように部分点が与えられる。  
- part1 ( $ 40 $ 点) : $ modulo=1,000,000,007 $、$ -1,000,000≦x_i,\ y_i≦1,000,000 $
- part2 ( $ 30 $ 点) : $ 1≦modulo≦1,000,000,007 $、$ -100≦x_i,\ y_i≦100 $
- part3 ( $ 30 $ 点) : $ 1≦modulo≦1,000,000,007 $、$ -1,000,000≦x_i,\ y_i≦1,000,000 $
 
 ちょうど $ T $ ターン後に全員が原点に集まるための進み方が何通りあるかを、$ modulo $で割った余りを出力せよ。  
 どのようにしても全員が同時に原点に集まることができない場合は、$ 0 $ を出力せよ。  
 出力は標準出力におこない、末尾には改行をいれること。  
```

2 2 1000000007
1 1
-1 -1
```

 ```

4
```

- $ x $ 座標が正の方向を右、$ y $ 座標が正の方向を上とします。
- $ 2 $ ターン目に二人が原点に辿り着く方法は、以下の $ 4 $ 通りとなります。
- $ 1 $人目が、下・右の順に移動し、$ 2 $人目が、上・左の順に移動する。
- $ 1 $人目が、下・右の順に移動し、$ 2 $人目が、左・上の順に移動する。
- $ 1 $人目が、右・下の順に移動し、$ 2 $人目が、上・左の順に移動する。
- $ 1 $人目が、右・下の順に移動し、$ 2 $人目が、左・上の順に移動する。
 

```

4 4 1000000007
0 4
4 0
-4 0
0 -4
```

 ```

1
```

- それぞれ、まっすぐ原点に向かって進むパターン以外存在しないので、答えは $ 1 $ 通りとなります。
 
```

1 6 10
0 0
```

 ```

0
```

- $ 6 $ ターンで原点から原点に戻ってくる方法は $ 400 $ 通りあるので、 $ 10 $ で割った余りの $ 0 $ を出力します。
 
```

3 7 12345
2 3
0 1
-2 -1
```

 ```

11415
```



---

---
title: "[ARC015D] きんいろクッキー"
layout: "post"
diff: 省选/NOI-
pid: AT_arc015_4
tag: []
---

# [ARC015D] きんいろクッキー

## 题目描述

高桥君的工作是在一座饼干工厂里，专门点击金色饼干。这个工厂具有以下特点：

- 每秒钟会产生普通饼干和金色饼干，生产的时间是整数秒。
- 正常情况下，每秒会生成 1 块普通饼干。
- 每秒还可能以概率 $P$ 生成 1 块金色饼干。
- 当金色饼干被点击时，它会消失，并触发一种随机效果。
- 共有 $N$ 种效果可以随机触发。对于每种效果 $i$，其出现概率为 $q_i$。当效果触发时，会在之后的 $t_i$ 秒内，使正常生成的饼干数量增加 $x_i$ 倍。
- 效果可以叠加。例如，若在同一秒内，效果 $i$ 出现了两次，效果 $j$ 出现了一次，则该秒生成饼干的总数为 $x_i^2 \times x_j$。

举个例子：在第 $0$ 秒点击的金色饼干具有持续 $3$ 秒、倍率为 $2$ 的效果，而在第 $1$ 秒点击的金色饼干具有持续 $1$ 秒、倍率为 $3$ 的效果，那么生成的普通饼干数量如下：

| 时间（秒） | 0 | 1 | 2 | 3 | 4 | 5 |
|------------|---|---|---|---|---|---|
| 饼干数量   | 1 | 2 | 6 | 2 | 1 | 1 |

现在，高桥君想知道：如果从第 $0$ 秒开始，他点击了每一个出现的金色饼干，那么在第 $T-1$ 秒结束后，生成的普通饼干总数的期望值是多少？

输入如下格式：
```
T N P
q_1 x_1 t_1
q_2 x_2 t_2
...
q_N x_N t_N
```

## 输入格式

- 第一行包含三个整数：生成饼干的总时间 $T\ (1 \le T \le 100,000)$，效果的种类数 $N\ (1 \le N \le 10,000)$，以及金色饼干出现的概率 $P\ (0 \le P \le 1)$。
- 接下来的 $N$ 行描述每种效果：
  - $q_i$: 效果 $i$ 的出现概率 $(0 \le q_i \le 1)$
  - $x_i$: 效果的倍率 $(1 \le x_i \le 1,000)$
  - $t_i$: 效果的持续时间 $(1 \le t_i \le 100,000)$。

- 所有 $q_i$ 的总和为 $1$。

## 输出格式

输出在第 $T-1$ 秒结束后所生成普通饼干总数的期望值。结果精确到小数点后至少三位，并确保绝对误差或相对误差不超过 $10^{-3}$。

## 说明/提示

- $1 \le T \le 100,000$
- $1 \le N \le 10,000$
- $0 \le P \le 1$
- $\sum_{i=1}^{N} q_i = 1$
- 所有输入的小数精度不超过小数点后第六位
- 正确输出不会超过 $10^{100}$

 **本翻译由 AI 自动生成**



---

---
title: "[ARC018D] 僕は友達が少ない"
layout: "post"
diff: 省选/NOI-
pid: AT_arc018_4
tag: []
---

# [ARC018D] 僕は友達が少ない

## 题目描述

[problemUrl]: https://atcoder.jp/contests/arc018/tasks/arc018_4

高橋君の通う大学は、毎年 $ N $ 人の新入生を迎え入れています。 $ N $ 人の新入生には $ 1 $ から $ N $ の学籍番号が順番に振られていて、高橋君の学籍番号は $ 1 $ です。 さて、4月から大学に通う高橋君は他の $ N-1 $ 人の新入生全員と友達になりたいと思っています。しかし、それを達成するには非常に費用が掛かることが知られています。 高橋君にとって、"x君と友達である"というのは高橋君の友達の友達の...というふうに交友関係を辿って、x君にたどり着くことが可能な状態のことを指します。 現在、新入生同士はお互いを全く知らず、互いに友達であるような学生はいません。当然、高橋君にも全く友達がいません。しかし、高橋君は特定の2人の学生(高橋君も含むことがあります)について、「少なくともどちらか一方が高橋君の友達もしくは高橋君自身であるような、学籍番号が $ A $ の学生と 学籍番号が $ B $ の学生を、$ C $ 円使って友達同士にする」という形式の手段を $ M $ 種類知っています。また、学生によって必要となる費用はバラバラであるため、同じ費用である手段の数はそこまで偏っていません。 最初、高橋君を含めた新入生に友達は全くおらず、高橋君は上記の手段を活用し、新入生全員と友達になることを考えています。また、高橋君はそれ以外の方法で友達を作ることはできません。しかし、高橋君の資金力にも限りがあり、出来るだけ少ない費用で新入生全員と友達になりたいと考えています。高橋君は忙しいので、プログラマーであるあなたに、この企てについての仕事を依頼することにしました。 高橋君からあなたに与えられた仕事を説明します。 まず、あなたには、大学に在籍する高橋君を含む新入生の数 $ N $ 、手段の数 $ M $ と、 $ M $ 種類の手段の情報が与えられます。 $ N $ 人の新入生には $ 1 $ から $ N $ の学籍番号が順番に振られていて、高橋君の学籍番号は $ 1 $ です。 あなたの仕事は、高橋君が新入生全員と友達になるために必要な合計の費用と、最小限の費用を達成する手段の選び方が何通りあるかを出力することです。手段を実行する順番のみが異なるものは同じ手段の選び方とみなします。正確には、選び方の数は非常に大きくなってしまうことがあるので、選び方の数を $ 1,000,000,007 $ で割った余りを出力してください。 この問題には部分点が設定されている。

- 下記の条件を満たすテストケースのみで構成された、 $ 10 $ 点分のセットがある。
- 手段に必要な費用は全て相異なる。つまり 、 $ i,j\ (1≦i,j≦M) $ において、 $ i\ \neq\ j $ なら $ C_i\ \neq\ C_j $ が成立する。

- 上記のセットを含む全てのテストケースに正解することで、残りの $ 90 $ 点を得られる。
 
 高橋君が新入生全員と友達となるために必要な最小の費用と、最小の費用を達成する手段の選び方の数を $ 1,000,000,007 $ で割った余りを、半角スペース区切りで一行に出力せよ。  
 なお、出力の最後には改行を入れること。 ```
<pre class="prettyprint linenums">
4 4
1 2 4000
2 3 3000
3 4 2000
1 4 1000
```

 ```
<pre class="prettyprint linenums">
6000 1
```

 この入力は「手段に必要な費用は全て相異なる」という部分点( $ 10 $ 点分)の制約を満たしている。 $ 1 $ 番目～ $ 4 $ 番目の合計 $ 4 $ 種類の手段が存在する。高橋君が全ての新入生と友達になるために必要な最小費用は $ 6,000 $ 円で、それを達成する手段の組み合わせは次の $ 1 $ 通りである。 8. $ 2,3,4 $ 番目の手段を適切な順番で用いる。
 具体的に、どのようにして高橋君が学生全員と友達になるのかを説明する。 1. まず最初に、高橋君には友達がいないので、高橋君(学籍番号 $ 1 $)が含まれる手段しか用いることができない。したがって、手段 $ 4 $ を使い、高橋君(学籍番号 $ 1 $)と学籍番号 $ 4 $ の学生を友達同士にする。
2. 次に、この時点で学籍番号 $ 4 $ の学生は既に高橋君の友達であるため、手段 $ 3 $ を用いることができる。したがって、手段 $ 3 $ を用いて、学籍番号 $ 3 $ の学生と学籍番号 $ 4 $ の学生を友達同士にする。
3. 最後に、手段 $ 2 $ を用いて、学籍番号 $ 2 $ の学生と学籍番号 $ 3 $ の学生を友達同士にする。
 
 以上の順番で手段を用いれば、高橋君は $ 6,000 $ 円の費用で新入生全員と友達になることができる。 ```
<pre class="prettyprint linenums">
4 5
1 2 1000
1 3 1000
2 3 2000
2 4 1000
3 4 1000
```

 ```
<pre class="prettyprint linenums">
3000 4
```

 $ 1 $ 番目～ $ 5 $ 番目の合計 $ 5 $ 種類の手段が存在する。高橋君が全ての新入生と友達になるために必要な最小費用は $ 3,000 $ 円で、それを達成する手段の組み合わせは次の $ 4 $ 通りである。 15. $ 2,4,5 $ 番目の手段を適切な順番で用いる。
16. $ 1,4,5 $ 番目の手段を適切な順番で用いる。
17. $ 1,2,5 $ 番目の手段を適切な順番で用いる。
18. $ 2,2,4 $ 番目の手段を適切な順番で用いる。
 以下の図は、入力例2と、その答えを視覚的に表したものである。新入生同士を結ぶ線が手段に対応する。  ![](https://cdn.luogu.com.cn/upload/vjudge_pic/AT_arc018_4/1ae08b331d772113bcdb6b0bac2f8c19e25b54e2.png)

 考えられる手段の選び方は、以下の $ 4 $ 通りである。  ![](https://cdn.luogu.com.cn/upload/vjudge_pic/AT_arc018_4/f09f6b005d46336b65b2d472c9843326c7c841c7.png)

 ```
<pre class="prettyprint linenums">
6 8
1 3 1
1 2 1
2 3 1
2 4 2
3 4 2
3 6 2
4 5 2
5 6 1
```

 ```
<pre class="prettyprint linenums">
7 15
```

 ```
<pre class="prettyprint linenums">
12 66
1 2 1
1 3 1
1 4 1
1 5 1
1 6 1
1 7 1
1 8 1
1 9 1
1 10 1
1 11 1
1 12 1
2 3 1
2 4 1
2 5 1
2 6 1
2 7 1
2 8 1
2 9 1
2 10 1
2 11 1
2 12 1
3 4 1
3 5 1
3 6 1
3 7 1
3 8 1
3 9 1
3 10 1
3 11 1
3 12 1
4 5 1
4 6 1
4 7 1
4 8 1
4 9 1
4 10 1
4 11 1
4 12 1
5 6 1
5 7 1
5 8 1
5 9 1
5 10 1
5 11 1
5 12 1
6 7 1
6 8 1
6 9 1
6 10 1
6 11 1
6 12 1
7 8 1
7 9 1
7 10 1
7 11 1
7 12 1
8 9 1
8 10 1
8 11 1
8 12 1
9 10 1
9 11 1
9 12 1
10 11 1
10 12 1
11 12 1
```

 ```
<pre class="prettyprint linenums">
11 917363797
```

## 说明/提示

### 部分点

入力は以下の形式で標準入力から与えられる。

> $ N　M $ $ A_1 $ $ B_1 $ $ C_1 $ $ A_2 $ $ B_2 $ $ C_2 $ : $ A_M $ $ B_M $ $ C_M $

- $ 1 $ 行目には、大学に在籍する高橋君を含む新入生の数 $ N\ (2\ ≦\ N\ ≦\ 10,000) $ と、手段の数 $ M\ (1\ ≦\ M\ ≦\ 100,000) $ が与えられる。
- $ 2 $ 行目から $ M $ 行では、手段の情報が与えられる。このうち $ i\ (1\ ≦\ i\ ≦\ M) $ 行目では、$ i $ 番目の手段における 2 人の学生の学籍番号とその費用を表す 3 つの整数 $ A_i,B_i,C_i\ (1\ ≦\ A_i\ が空白区切りで与えられる。M $ 個の手段は以下の条件を満たす。 
  - ある学生の組を直接友達にする手段は1つ以下である。つまり、 $ i\ \neq\ j $ ならば $ (A_i,\ B_i)\ \neq\ (A_j,\ B_j) $ である。
  - 任意の費用 $ K $ について、 $ (C_i\ =\ K\ であるような手段の数)\ ≦\ 100 $ が成り立つ。
  - 高橋君が新入生全員と友達になる方法は必ず存在する。

  この問題には部分点が設定されている。 - 下記の条件を満たすテストケースのみで構成された、 $ 10 $ 点分のセットがある。
- 手段に必要な費用は全て相異なる。つまり 、 $ i,j\ (1≦i,j≦M) $ において、 $ i\ \neq\ j $ なら $ C_i\ \neq\ C_j $ が成立する。

- 上記のセットを含む全てのテストケースに正解することで、残りの $ 90 $ 点を得られる。



---

---
title: "[ARC019C] 最後の森"
layout: "post"
diff: 省选/NOI-
pid: AT_arc019_3
tag: []
---

# [ARC019C] 最後の森

## 题目描述

魔王的城堡坐落在名为「最后的森林」的地方。这个森林由 $R$ 行 $C$ 列的网格构成，每个格子可能是以下几种类型：

- 平地：可以自由通行。
- 树木：此格子不能通行。
- 强敌：有凶恶的强敌阻挡，需要特定条件才能通过。
- 村庄：玩家的起始位置，可以自由通行。
- 神殿：存放传说之剑 Link-Cut Sword，可以自由通行。
- 魔王的城堡：魔王所在位置，可以自由通行。

村庄、神殿和魔王的城堡各自只有一个。

我们称第 $i$ 行第 $j$ 列的格子为 $(i, j)$。如果两个格子相邻，意味着它们共享一个边，即以下两种情况之一成立：
- 在同一行，两列相邻。
- 在同一列，两行相邻。

玩家初始位置在村庄。玩家可以执行以下两种操作：
- 移动到相邻的格子，前提是该格子允许通行。
- 与相邻格子中的强敌战斗。战胜敌人后，该格子可以通行。

在与魔王对峙之前，玩家需要提升自己的装备（道具）。取得神殿中的传说之剑是战胜魔王的必要条件。因此，玩家需要先获取传说之剑，然后前往魔王的城堡。即便不拿剑，也可以路过魔王的城堡，但最多只能与 $K$ 次强敌交锋。

由于森林中弥漫着魔王的剧毒雾气，玩家需要尽可能减少移动时间。请编写程序，计算出满足条件的最短路径的移动次数。如果没有符合条件的路径，输出 `-1`。

### 输入格式
第一行为三个整数 $R, C, K$，分别表示森林的行数、列数和允许战斗的最大次数。

接下来 $R$ 行，每行包含一个长度为 $C$ 的字符串，描述森林的格子种类。其中：
- `.` 表示平地
- `T` 表示树木
- `E` 表示强敌
- `S` 表示村庄
- `C` 表示神殿
- `G` 表示魔王的城堡

### 输出格式
输出满足条件的最短路径的移动次数。如果没有符合条件的路径，则输出 `-1`。

### 示例
#### 输入例 1
```
5 7 3
GET..ET
..T....
.TEST..
.E.T.ET
...ETC.
```

#### 输出例 1
```
19
```

#### 输入例 2
```
5 7 2
GET..ET
..T....
.TEST..
.E.T.ET
...ETC.
```

#### 输出例 2
```
21
```

#### 输入例 3
```
5 7 1
GET..ET
..T....
.TEST..
.E.T.ET
...ETC.
```

#### 输出例 3
```
-1
```

#### 输入例 4
```
6 35 4
T...TT.....TT...TTT...TTT..TTG.....
..T..T.TTT.T..T..E..T..E...TTT.TTT.
.TTT.T.....E.TTTTT.TTT.TTT.TTT.....
.....T.TT.TT.TTTTT.TTT.TTT.TTTTTTT.
.TTT.T.TT..T..T..S..T..TTT.TTTTTTT.
.CTT.E.TTT.TT...TTT...TT.....E.....
```

#### 输出例 4
```
94
```

 **本翻译由 AI 自动生成**



---

---
title: "[ARC019D] ほんとうのたたかい"
layout: "post"
diff: 省选/NOI-
pid: AT_arc019_4
tag: []
---

# [ARC019D] ほんとうのたたかい

## 题目描述

终于击败了魔王，世界终于迎来和平！

然而，我的战斗还没有结束！每个月，我还需要与妹妹竞赛以争夺高级甜点！

不为人知的是，我的妹妹非常擅长竞技编程，每次都在这些比赛中击败我并夺走了高级甜点！

（毕竟，我家世代都参加竞技编程，家里的规矩是竞技编程成绩决定高级甜点的归属，这也是没办法的事。）

每次输给妹妹，长期以来都尝不到高级甜点，作为姐姐的自尊心也受到了打击。因此，我一直在偷练编程技巧，希望有一天能够反败为胜！为了提升自己，我一直在玩最近的《Ancient Royal Coders》游戏。

这次，我们又要在一场较量中争夺高级甜点。

这次比赛的规则是：创建一个满足以下条件的 $N \times N$ 的网格提交参赛：

- $N$ 必须是整数，且满足 $2 \le N \le 150$。
- 每个格子要么是有一个 `O`，要么是空的。
- 对于任何一个边平行于行或列的长方形，其四个角的格子中至少有一个格子是空的。换句话说，对于满足 $1 \le i, j, k, l \le N$ 的任意四个整数，下面的条件必须成立：
  - 定义第 $p$ 行第 $q$ 列的格子为 $(p, q)$，那么在 $(i, j)$, $(i, l)$, $(k, j)$, $(k, l)$ 中至少有一个格子是空的。

在这些满足条件的网格中，填入 `O` 数量最多的将获胜。

本月的奖励是传说中的布丁。这几年，我都没有尝过这种布丁。顺便一提，这些年正是从妹妹开始学习竞技编程开始算起，这一点可是秘密。

幸运的是，这次的布丁是可以共享的，因此我提议让我们根据比赛表现分享布丁，这个提议顺利通过。这样做是为了避免我拿走妹妹的甜点让她伤心，当然，我只是想分一点点而已。

无论如何，这次我有信心胜利。现在是展示我在《Ancient Royal Coders》中磨练出的编程技能的时候了！

**注意：此题没有输入。**问题设置了一些得分规则。

- 根据你的输出，设输出网格中 `O` 的个数为 $S$，奖金得分标准如下：
  - 输出不满足条件或 $S \le 294$，可惜得不到布丁，得分为 $0$。
  - 输出满足条件且 $295 \le S \le 399$，可以微量分享布丁，得分为 $5$。
  - 输出满足条件且 $400 \le S \le 899$，可以获得一口布丁，得分为 $10$。
  - 输出满足条件且 $900 \le S \le 1299$，可以获得一口半布丁，得分为 $20$。
  - 输出满足条件且 $1300 \le S \le 1499$，可以获得两口布丁，得分为 $30$。
  - 输出满足条件且 $1500 \le S \le 1699$，可以获得四分之一的布丁，得分为 $50$。
  - 输出满足条件且 $S \ge 1700$，可以获得一半布丁，得分为 $100$。

**输出格式：**

- 第一行输出一个整数 $N$，$2 \le N \le 150$。
- 接下来的 $N$ 行，每行输出一个长度为 $N$ 的字符串，每个字符是 `O` 或 `.`。

- 最后要注意在输出的最后加上一个换行符。如果没有换行，即使其他部分正确也会被判为 `WA`。特别是在提交后的结果页面可能不容易判断最后一行是否有换行。

- 你可以在源代码的地方写下你想输出的内容，然后选择 `Text (cat)` 语言进行提交，这样内容会直接当做输出进行提交。当然也可以使用其他编程语言生成并输出内容，但务必符合时间和内存的限制。

判题系统中的 `AC` 和 `WA` 含义特别：

- `AC` 表示输出满足条件，不论最后得分如何。
- `WA` 表示输出不满足条件。

即便显示 `AC`，你实际得分仍可能是 $0$ 分。

 **本翻译由 AI 自动生成**



---

---
title: "[ARC020D] お菓子の国の旅行"
layout: "post"
diff: 省选/NOI-
pid: AT_arc020_4
tag: []
---

# [ARC020D] お菓子の国の旅行

## 题目描述

糖果国是一个狭长的国度，拥有 $N$ 个城镇，这些城镇沿直线排列，编号从 $1$ 到 $N$。相邻城镇之间有道路连接，城镇 $i$ 和城镇 $i+1$ 之间的路长为 $D_i$。在糖果国，出行只能通过这些道路进行。对于城镇 $a$ 和 $b$（$a < b$），从城镇 $a$ 到城镇 $b$ 的距离，以及从城镇 $b$ 到城镇 $a$ 的距离，都是从 $D_a$ 到 $D_{b-1}$ 之间道路长度的总和。每个城镇都有一个独特的糖果专卖店，每家店只出售一种独特的糖果。当访问某个城镇时，必须购买该店出售的糖果。

住在蚂蚁王国的 Ant 先生非常喜爱甜食和数字 $M$。他计划在糖果国旅行，并恰好购买 $K$ 种不同的糖果。为了选择访问顺序，他想先计算一下，总的移动距离是 $M$ 的倍数的旅行方案有多少种。需要注意的是，旅行过程中不允许绕远路，并且可以选择任何城镇作为起始和结束点。同一个城镇不能重复访问。此外，移动过程中经过而不驻留的城镇不算作访问过。

请为 Ant 先生编写一个程序，计算移动距离总和为 $M$ 倍数的旅行方案数量。因为结果可能非常大，请输出对 $1000000007(10^9+7)$ 取模的结果。

## 输入格式

输入以以下格式给出：

> $N$ $M$ $K$ $D_1$ $D_2$ ... $D_{N-1}$

- 第一行输入三个整数：表示城镇数量的 $N\ (2 \leq N \leq 100)$，Ant 先生钟爱的数字 $M\ (1 \leq M \leq 30)$，以及他计划购买的糖果种类数 $K\ (2 \leq K \leq 10$ 且 $K \leq N)$。
- 接下来的 $N-1$ 行，每行一个整数 $D_i\ (1 \leq D_i \leq M)$，表示城镇 $i$ 到城镇 $i+1$ 的道路长度。

## 输出格式

输出满足条件的旅行方案数量，对 $1000000007(10^9+7)$ 取模。输出结果末尾应有换行。

## 说明/提示

### 部分分数

有部分分数可得：

- 如果所有满足 $N \leq 12$ 的测试用例均正确，则可获得 $30$ 分。

### 示例解释 1

有以下 $6$ 种方案：

- 城镇 $1 \rightarrow 3 \rightarrow 2$ 的访问顺序。
- 城镇 $2 \rightarrow 3 \rightarrow 1$ 的访问顺序。
- 城镇 $2 \rightarrow 1 \rightarrow 4$ 的访问顺序。
- 城镇 $4 \rightarrow 1 \rightarrow 2$ 的访问顺序。
- 城镇 $2 \rightarrow 3 \rightarrow 4$ 的访问顺序。
- 城镇 $4 \rightarrow 3 \rightarrow 2$ 的访问顺序。

### 示例解释 2

因为结果可能很大，记得对 $1000000007(10^9+7)$ 取模。

 **本翻译由 AI 自动生成**

## 样例 #1

### 输入

```
4 4 3

2

1

3
```

### 输出

```
6
```

## 样例 #2

### 输入

```
15 5 10

5

5

5

5

5

5

5

5

5

5

5

5

5

5
```

### 输出

```
897286330
```



---

---
title: "[ARC024D] バス停"
layout: "post"
diff: 省选/NOI-
pid: AT_arc024_4
tag: []
---

# [ARC024D] バス停

## 题目描述

高桥国的高桥王为了改善国内交通，决定设置几个公交站。高桥国的道路只有两种走向：东西向和南北向。从某个基准点向东 $i$ 公里修建了第 $i$ 条南北向的公路，而在北 $j$ 公里修建了第 $j$ 条东西向公路。第 $i$ 条南北路和第 $j$ 条东西路的交点表示为 $(i, j)$。因为道路是无限延伸的，所以任何相交的两条路都有交点。公交站只能设置在这些交点上，并且一个交点至多只能有一个公交站。

目前已经设置了 $N$ 个公交站。但此时高桥王发现了个严重的问题：由于道路太窄，公交车无法转弯，每条线路只能沿一个方向行驶，这样一来，某些公交站之间就成了孤立的，无法互相流通。这是非常不便的，因此需要增设一些公交站，使得任意两个公交站之间，即使需要换乘也能到达，而换乘后的总距离应等于它们之间的曼哈顿距离。也就是说，对于每对公交站 $(a, b)$ 和 $(c, d)$，必须存在一条换乘路径，使总移动距离为 $|a - c| + |b - d|$ 公里。

受预算限制，总共只能设立 $10,000$ 个公交站，也就是说，还可以再增设 $10,000 - N$ 个公交站。在满足上述条件情况下，找出应该增设的公交站位置。如果有多种方案，任选其一即可。

## 输入格式

输入使用以下格式：

> $N$  
> $x_1$ $y_1$  
> $x_2$ $y_2$  
> ...  
> $x_N$ $y_N$

- 第 1 行是一个整数 $N\ (2 \leq N \leq 1,000)$，表示已经设置好的公交站数量。
- 接下来的 $N$ 行，每行两个整数 $x_i\ (1 \leq x_i \leq 1,000)$ 和 $y_i\ (1 \leq y_i \leq 1,000)$，这表示第 $i$ 个公交站位于交叉点 $(x_i, y_i)$。
- 对于所有 $i \neq j$，都有 $(x_i, y_i) \neq (x_j, y_j)$。
- 至少存在一个可行解。

## 输出格式

输出应该新增的公交站位置，格式如下：

> $M$  
> $x_1$ $y_1$  
> $x_2$ $y_2$  
> ...  
> $x_M$ $y_M$

- 第 1 行是一个整数 $M\ (0 \leq M \leq 10,000 - N)$，表示新增公交站的数量。
- 接下来的 $M$ 行，每行两个整数 $x_i\ (1 \leq x_i \leq 1,000)$ 和 $y_i\ (1 \leq y_i \leq 1,000)$，表示第 $i$ 个新增站位于交叉点 $(x_i, y_i)$。
- 对于所有 $i \neq j$，都有 $(x_i, y_i) \neq (x_j, y_j)$。
- 新增站不能与已有站重合。
- 在总共的 $N+M$ 个公交站中，任意两站之间的最短距离必须等于它们之间的曼哈顿距离。

## 说明/提示

### 部分分数

题目包含部分分数：

- 如果能正确解决所有 $2 \leq N \leq 100$ 的测试用例，得 $10$ 分。
- 如果能正确解决所有 $2 \leq N \leq 1,000$ 的测试用例，额外得 $90$ 分，总计 $100$ 分。

### 示例解释 1

经过公交站 $(1, 1)$ 的公交车只能驶向 $(i, 1)$ 或 $(1, j)$（其中 $i, j$ 是任意整数）。同理，经过站点 $(2, 2)$ 的公交车只能驶向 $(i, 2)$ 或 $(2, j)$。如果增设站点 $(1, 2)$，可以使任何两个站点可达。同样增设站点 $(2, 1)$ 也可以，甚至同时增设这两处也行。

### 示例解释 2

请注意，新增加的站点之间也必须满足最短路径等于曼哈顿距离的条件。

 **本翻译由 AI 自动生成**

## 样例 #1

### 输入

```
2

1 1

2 2
```

### 输出

```
1

1 2
```

## 样例 #2

### 输入

```
4

1 1

2 2

3 4

4 3
```

### 输出

```
4

1 2

3 2

3 3

4 4
```

## 样例 #3

### 输入

```
7

2 4

3 2

4 6

5 1

6 5

7 3

8 7
```

### 输出

```
15

3 6

8 5

2 2

7 5

2 5

6 6

3 1

5 6

6 2

6 1

7 1

7 2

2 3

6 7

2 6
```



---

---
title: "[ARC025D] コンセント"
layout: "post"
diff: 省选/NOI-
pid: AT_arc025_4
tag: []
---

# [ARC025D] コンセント

## 题目描述

Anti Real Corporation 公司致力于以一种独特的方法来丰富每个人的日常生活。

公司的插座插孔形状特殊，与众不同，由 $H$ 行 $W$ 列的小孔组成。插头可以占用相邻的两个未使用小孔，这两个小孔可以是上下邻接或左右邻接。具体来说，如果我们标记第 $i$ 行第 $j$ 列的小孔为 ($i$, $j$)，那么：

- 可以选择 ($i$, $j$) 和 ($i+1$, $j$) 的两个小孔（$1 \leq i \leq H-1$，$1 \leq j \leq W$）。
- 可以选择 ($i$, $j$) 和 ($i$, $j+1$) 的两个小孔（$1 \leq i \leq H$，$1 \leq j \leq W-1$）。

插头在插入时不能与已用的小孔或已经插上插孔盖的小孔重叠。

某一天，总裁为增加插头插入的趣味性，决定在接下来的 $N$ 天中，每天在营业开始时执行以下两个操作中的一个：

- 选中一个未使用的小孔，安装插孔盖。
- 选中一个已安装插孔盖的小孔，移除插孔盖，使其变为未使用状态。

初始状态下，所有的小孔都是未使用的。

总裁要求部门经理在这 $N$ 天中每天记录可能的插头组合方式数，并在最后一天报告结果。在考虑组合方式时，不区分不同的插头间以及不同的插孔盖间的差异，即使不使用任何插头也算作一种组合方式。

然而，经理直到截止时间前才想起来这件事。幸运的是，他发现了插孔盖的历史记录，通过这些记录尝试确定每一天可能的组合方式。

由于显然无法逐一检查所有组合，开发团队的你被委派编写一个程序，来有效地解决这个问题。

## 输入格式

输入以以下格式从标准输入给出：

> $H$ $W$ $N$ $S_1$ $T_1$ $S_2$ $T_2$ ... $S_N$ $T_N$

- 第一行包含两个整数 $H$ 和 $W$（$1 \leq H \leq 2$，$1 \leq W \leq 10^{11}$），描述插座的形状为 $H$ 行 $W$ 列。
- 第二行包含一个整数 $N$（$1 \leq N \leq 20,000$），表示操作的天数。
- 接下来的 $N$ 行中，每行包含两个整数 $S_i$ 和 $T_i$（$1 \leq S_i \leq H$，$1 \leq T_i \leq W$），表示在第 $i$ 天的操作：如果在当天营业开始前 ($S_i$, $T_i$) 是未使用状态，则安装插孔盖；否则，移除插孔盖。

## 输出格式

输出 $N$ 行。第 $i$ 行输出在第 $i$ 天营业开始后的操作后，所有可能的插头组合总数对 $1000000007\ (=\ 1,000,000,007)$ 取模的结果。

## 说明/提示

### 部分得分

本题有部分得分设定。

- 对满足 $W \leq 5,000$ 且 $N \leq 3,000$ 的数据集 $1$，正确解答可得 $10$ 分。
- 对满足 $W \leq 100,000$ 且 $N \leq 3,000$ 的数据集 $2$，除了上述得分外，再得 $30$ 分。
- 对于无限制的数据集 $3$，除了上述得分外，额外得到 $60$ 分。

### 示例说明 1

在第 $1$ 天的操作后，插孔的状态如下图所示。图中六边形表示插孔盖的位置。共有以下 $10$ 种可能的配置。

 **本翻译由 AI 自动生成**

## 样例 #1

### 输入

```
2 3

3

1 1

2 3

1 1
```

### 输出

```
10

5

10
```

## 样例 #2

### 输入

```
2 4

5

1 2

1 1

2 2

2 1

1 4
```

### 输出

```
27

17

7

7

3
```



---

---
title: "[ARC027D] ぴょんぴょんトレーニング"
layout: "post"
diff: 省选/NOI-
pid: AT_arc027_4
tag: []
---

# [ARC027D] ぴょんぴょんトレーニング

## 题目描述

[problemUrl]: https://atcoder.jp/contests/arc027/tasks/arc027_4

跡鼓駄 (あとこだ) 町には ARC 珈琲店があり、競技プログラミング喫茶店として知られている。

高橋君は ARC 珈琲店でアルバイトをしている。

高橋君は ARC 珈琲店に行く際にいつも精進通りという道を通る。精進通りは、高橋君の家と ARC 珈琲店とを結んでいる。

精進通りは $ N $ 個の石で構成されている石畳の道である。石には、高橋君の家がある側から順に $ 1 $ から $ N $ まで番号がつけられている。

高橋君は足腰を鍛えるため、$ D $ 日間精進通りでトレーニングをすることにした。

$ i $ 日目のトレーニングは、以下の要領で行われる。

- トレーニング中、石 $ x $ にいる場合、石 $ x $ からは石 $ x\ +\ 1 $, $ x\ +\ 2 $, … , $ x\ +\ h_x $ に跳んで移動することができる。$ h_x $ はトレーニングの日によらず一定である。
- トレーニング開始時点では石 $ s_i $ にいる。
- トレーニングでは、石 $ s_i $ からジャンプを繰り返して石 $ t_i $ に移動する。途中で石 $ t_i $ より大きな番号の石に跳べたとしても、$ t_i $ より大きな番号の石に移動してはならない。
- トレーニングは石 $ t_i $ に到達した時点で終了する。

高橋君は、石 $ s_i $ から石 $ t_i $ までジャンプで移動する組み合わせが全部で何通りあるのかが気になった。ジャンプで移動する組み合わせというのは、ジャンプで移動する際に使用する石の組み合わせの総数である。高橋君はすべての組み合わせについて自力で跳んで確かめるつもりである。

同僚の青木君は、高橋君を止めるために、石 $ s_i $ から石 $ t_i $ までジャンプで移動する方法が全部で何通りあるのかを前もって調べ、結果を高橋君に伝えることにした。

それぞれの日について、石 $ s_i $ から石 $ t_i $ までジャンプで移動する方法が全部で何通りあるのかを求めるプログラムを作成せよ。 なお、 $ 2 $ つの移動方法が異なるとは、途中で通った石の組み合わせが異なることである。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ h_1 $ $ h_2 $ ... $ h_N $ $ D $ $ s_1 $ $ t_1 $ $ s_2 $ $ t_2 $ : $ s_D $ $ t_D $

- $ 1 $ 行目には、石の個数を表す整数 $ N\ (2\ ≦\ N\ ≦\ 300,000) $ が書かれている。
- $ 2 $ 行目には、$ N $ 個の整数が空白区切りで書かれている。これらの整数のうち左から $ i\ (1\ ≦\ i\ ≦\ N) $ 番目の整数 $ h_i\ (1\ ≦\ h_i\ ≦\ 10) $ は、石 $ i $ からは石 $ i\ +\ 1 $, $ i\ +\ 2 $, … , $ i\ +\ h_i $ に跳べることを表す。この入力では、$ i\ +\ h_i\ ＞\ N $ となる場合も入っている点に注意せよ。
- $ 3 $ 行目には、トレーニングの日数を表す整数 $ D\ (1\ ≦\ D\ ≦\ 5,000) $ が与えられる。
- $ 4 $ 行目から $ D $ 行には、トレーニングに関する情報が書かれている。これら $ D $ 行のうち上から $ i\ (1\ ≦\ i\ ≦\ D) $ 行目には $ 2 $ つの整数 $ s_i,\ t_i\ (1\ ≦\ s_i\ ＜\ t_i\ ≦\ N) $ が空白区切りで与えられる。これは、$ i $ 日目のトレーニングでは、石 $ s_i $ から開始して、石 $ t_i $ で終了することを表す。

## 输出格式

$ D $ 行にわたって出力せよ。$ D $ 行のうち $ i $ 行目には、$ i $ 日目におけるジャンプで移動する組み合わせ数を $ 1000000007\ (=\ 1,000,000,007) $ で割った余りを出力せよ。出力の末尾にも改行を入れること。

## 说明/提示

### 部分点

この問題には部分点が設定されている。

- $ N\ ≦\ 500 $ を満たすデータセット $ 1 $ に正解した場合は、$ 30 $ 点が与えられる。
- 追加制約のないデータセット $ 2 $ に正解した場合は、上記とは別に $ 70 $ 点が与えられる。

### Sample Explanation 1

$ 1 $ 日目のトレーニングでは、石 $ 2 $ から石 $ 6 $ に移動します。この入力では、($ h_2 $, $ h_3 $, $ h_4 $, $ h_5 $, $ h_6 $) =($ 2 $, $ 3 $, $ 2 $, $ 2 $, $ 1 $) です。ジャンプによる移動としては、以下の $ 6 $ 通りが考えられます。 !\[\](/img/arc/027/4-1.png)

## 样例 #1

### 输入

```
7

1 2 3 2 2 1 1

3

2 6

5 7

1 7
```

### 输出

```
6

2

9
```

## 样例 #2

### 输入

```
11

3 1 4 1 5 9 2 6 5 3 5

4

3 7

2 9

1 10

1 11
```

### 输出

```
6

22

90

175
```



---

---
title: "[ARC029D] 高橋君と木のおもちゃ"
layout: "post"
diff: 省选/NOI-
pid: AT_arc029_4
tag: []
---

# [ARC029D] 高橋君と木のおもちゃ

## 题目描述

给定一棵大小为 $N$，根为 $1$ 的树，并指定树上边的方向为编号大的指向编号小的。给定树上点 $i$ 的权值为 $s_i$。

现在给定 $M$ 个操作。每个操作依次进行。对于每个操作 $i$，有参数 $t_i$，可以选择：

- 不进行操作
- 在树上任意选定一个节点 $u$ 。并对原树进行参数为 $t_i$ 的**上移操作**。

参数为 $t_i$ 的上移操作就是将原图中 $u$ 以及它的所有祖先（除了根）的权值向父亲节点上移一位（根节点权值被删除），然后再将 $s_u$ 设为 $t_i$。

求在经历 $M$ 次操作之后，最终整棵树的权值和最大是多少。

## 输入格式

第一行一个整数 $N$，表示树的大小。

接下来 $N$ 行，每行一个整数 $s_i$，表示 $i$ 点的权值。

再接下来的 $N-1$ 行，每行两个整数 $a_i, b_i$，表示 $a_i$ 和 $b_i$ 之间有一条边。

第 $2N$ 行一个整数 $M$，表示操作的次数。

再接下来的 $M$ 行，每行一个整数 $t_i$。

## 输出格式

一个整数，表示操作后整棵树的权值和的最大值。

## 样例 #1

### 输入

```
7

4

7

5

1

5

2

4

1 2

1 3

1 4

2 5

2 6

6 7

8

2

8

1

3

6

3

7

5
```

### 输出

```
40
```

## 样例 #2

### 输入

```
6

21

5

5

5

5

5

1 2

1 3

1 4

1 5

1 6

5

8

8

8

8

8
```

### 输出

```
46
```



---

---
title: "[ARC031D] 買い物上手"
layout: "post"
diff: 省选/NOI-
pid: AT_arc031_4
tag: []
---

# [ARC031D] 買い物上手

## 题目描述

高桥君沉迷于一款游戏。在这款游戏中，玩家可以通过购买并组合一些物品来获取经验值。给定每种物品的价格以及通过指定物品组合获得的经验值列表，要求你选择购买的物品，使得「获得的经验值 ÷ 花费的金钱」最大化。需要注意的是，至少购买一种物品，而且每种物品只需要购买一个就可以获得相应的经验值。

## 输入格式

输入以如下格式提供：

- 第一行包含两个整数 $N$ 和 $M$，分别表示可获得经验值的组合数和物品种类数，其中 $1 \le N \le 100$，$1 \le M \le 100$。
- 第二行包含 $N$ 个整数，表示每个组合中可获得的经验值大小。
- 第三行包含 $M$ 个整数，表示每种物品的价格。
- 接下来的 $N$ 行，每行描述一个经验值组合。具体来说，每行的开头是一个整数，表示该组合中包含的物品种类数量。接着是若干整数，表示该组合所需的物品编号，编号以递增的顺序给出，并且不重复。

## 输出格式

输出使「获得的经验值 ÷ 花费的金钱」最大化的结果。结果的绝对误差或相对误差不超过 $10^{-4}$ 即可被接受。输出结果末尾需换行。

## 说明/提示

在本问题中共有两个数据集，每个数据集的具体条件如下：

- 如果在数据集中 $N \le 10$ 的情况下提供正确答案，可以得到 $50$ 分。
- 在没有额外限制的情况下提供正确答案，可以在前述数据集之外额外得到 $50$ 分。

 **本翻译由 AI 自动生成**

## 样例 #1

### 输入

```
3 4

4 3 2

4 2 1 10

2 1 2

2 1 3

3 2 3 4
```

### 输出

```
1
```

## 样例 #2

### 输入

```
5 5

7 1 3 6 6

6 3 2 6 5

1 2

2 2 3

4 1 2 4 5

2 2 4

2 2 3
```

### 输出

```
2.8
```



---

---
title: "[ARC032D] アットコーダーモンスターズ"
layout: "post"
diff: 省选/NOI-
pid: AT_arc032_4
tag: []
---

# [ARC032D] アットコーダーモンスターズ

## 题目描述

[problemUrl]: https://atcoder.jp/contests/arc032/tasks/arc032_4

アットコーダーモンスターズと言うゲームは、モンスターのチームを編成してバトルするゲームです。

あなたはモンスターを売っているお店にいます。 このお店では、$ N $ 匹のモンスターが横一列に並べられています。そして、各モンスター $ A_i\ (1\ ≦\ i\ ≦N) $ には以下に示す $ 2 $ つの能力値が存在しています。

- モンスター $ M_i $ のこうげきの能力を表す値 $ {M_i}_{ATK} $
- モンスター $ M_i $ のぼうぎょの能力を表す値 $ {M_i}_{DEF} $

いま、$ N $ 匹のモンスターの中から異なるちょうど $ K $ 匹のモンスターを選んで購入し、それらでチームを編成しようとしています。 しかし、ある能力値について、それらがかけ離れたモンスター同士がいるとチームとして安定しないことが分かっているので、できるだけ安定したチームを作りたいと思っています。

より厳密に、チームに含まれる $ 2 $ 匹のモンスター $ X $ と $ Y $ についてその不安定度 $ S_{X,Y} $ を、

- $ S_{X,Y} $ = max{ $ |X_{ATK}\ -\ Y_{ATK}| $, $ |X_{DEF}\ -\ Y_{DEF}| $ }

と定義したとき、チームの不安定度は、チームに含まれる全てのモンスターのペアについて計算して得られる不安定度の最大値です。 チームに含まれるモンスターが $ 1 $ 匹の時、チームの不安定度は $ 0 $ です。

あなたは、チームの不安定度を最小化するような異なる $ K $ 匹のモンスターを購入しようと思っています。 さらに、チームの不安定度を最小とするようなモンスターの選び方の総数も求めたいと思っています。

あなたは、達成できるチームの不安定度の最小値と、それを達成するモンスターの選び方の総数を $ 1,000,000,007 $ で割った余りを出力しなければなりません。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ K $ $ {M_1}_{ATK} $ $ {M_1}_{DEF} $ $ {M_2}_{ATK} $ $ {M_2}_{DEF} $ : $ {M_N}_{ATK} $ $ {M_N}_{DEF} $

- $ 1 $ 行目には、お店に並んでいるモンスターの数と購入したいモンスターの数を表す $ 2 $ つの整数 $ N\ (1\ ≦\ N\ ≦\ 100,000) $ と $ K\ (1\ ≦\ K\ ≦\ N) $ がスペース区切りで与えられる.
- $ 2 $ 行目から $ N $ 行には、お店に並んでいるモンスターの能力値の情報が与えられる。そのうち $ i $ 行目には、$ i $ 番目のモンスターの能力値を表す $ 2 $ つの整数 $ {M_i}_{ATK},\ {M_i}_{DEF}\ (0\ ≦\ {M_i}_{ATK},\ {M_i}_{DEF}\ ≦\ 3000) $ がスペース区切りで与えられる。

## 输出格式

$ 1 $ 行目には、達成できるチームの不安定度の最小値を出力せよ。

$ 2 $ 行目には、チームの不安定度を最小化するようなモンスターの選び方の総数を $ 1000000007 $ で割った余りを出力せよ。

末尾の改行を忘れないこと。

## 说明/提示

### 部分点

この問題には部分点が設定されている。

- $ 10 $ 点分のテストケースにおいて、$ 1≦N≦20 $ を満たす。

### Sample Explanation 1

モンスターは以下のように並んでおり、$ 3 $ 匹を選ぶときの不安定度の最小値は $ 2 $ である。また、選び方は $ 2 $ 通りある。 !\[\](http://arc032.contest.atcoder.jp/img/arc/032/D\_sample1.png)

## 样例 #1

### 输入

```
4 3

0 0

1 1

3 3

2 2
```

### 输出

```
2

2
```

## 样例 #2

### 输入

```
4 2

1 1000

10 100

100 10

1000 1
```

### 输出

```
90

1
```

## 样例 #3

### 输入

```
3 1

1 1

2 2

3 3
```

### 输出

```
0

3
```

## 样例 #4

### 输入

```
40 18

0 0

0 0

0 0

0 0

3000 3000

3000 3000

3000 3000

3000 3000

3000 3000

3000 3000

3000 3000

3000 3000

3000 3000

3000 3000

3000 3000

3000 3000

3000 3000

3000 3000

3000 3000

3000 3000

3000 3000

3000 3000

3000 3000

3000 3000

3000 3000

3000 3000

3000 3000

3000 3000

3000 3000

3000 3000

3000 3000

3000 3000

3000 3000

3000 3000

3000 3000

3000 3000

3000 3000

3000 3000

3000 3000

3000 3000
```

### 输出

```
0

75135237
```



---

---
title: "[ARC034D] インフレゲーム"
layout: "post"
diff: 省选/NOI-
pid: AT_arc034_4
tag: []
---

# [ARC034D] インフレゲーム

## 题目描述

有 $ A + B + C $ 张不同卡片放在一起。其中，$ A $ 张卡片上用红色数字写着一个整数，$ B $ 张卡片上用蓝色数字写着一个整数，剩下的 $ C $ 张卡片上用文字写着“汤婆子”。高桥君会利用这些卡片进行一个游戏。

游戏规则如下：

1. 先把 $ A + B + C $ 张卡片一起洗牌，均匀放置于桌上，形成一个牌堆。
2. 高桥君开始时的得分为 0。
3. 高橋君从牌堆顶端取出一张卡片：
   - 如果卡片上红色数字写有整数 $ a $，他的得分就增加 $ a $。
   - 如果卡片上蓝色数字写有整数 $ b $，他的得分乘以 $ b $。
   - 如果卡片上写着“汤婆子”，那么游戏立即结束，此时的分数就成为他的最终得分（不会执行后续步骤）。
4. 高橋君丢掉这张卡片，回到步骤 3 继续抽卡。

你的任务是计算高桥君最终得分的期望值。

## 输入格式

从标准输入读取以下格式的数据：

- 第一行包含三个整数 $ A, B, C $（$ 1 \leq A, B, C \leq 50 $）。它们分别表示红色数字卡片的数量、蓝色数字卡片的数量以及“汤婆子”卡片的数量。注意，因为 $ C \geq 1 $，所以游戏必定会在遇到“汤婆子”卡片时结束。
- 第二行给出 $ A $ 个整数 $ a_1, a_2, \ldots, a_A $，分别表示每张红色数字卡片上的整数（$ 1 \leq a_i \leq 100 $）。
- 第三行给出 $ B $ 个整数 $ b_1, b_2, \ldots, b_B $，分别表示每张蓝色数字卡片上的整数（$ 1 \leq b_i \leq 100 $）。

## 输出格式

输出高桥君最终得分的期望值。答案允许的绝对误差或相对误差不超过 $ 10^{-6} $。可以使用指数记法输出。

请勿忘记在输出后加上换行。

## 说明/提示

### 部分得分

- 满足 $ 1 \leq A, B, C \leq 3 $ 的数据提供 5 分。
- 满足 $ 1 \leq A, B, C \leq 8 $ 的数据提供 15 分。
- 满足 $ 1 \leq A, C \leq 50 $, $ 1 \leq B \leq 8 $ 的数据提供 20 分。

### 示例解释

考虑一种情况：有一张红色数字为 10 的卡片、一张蓝色数字为 2 的卡片和一张“汤婆子”卡片，这样总共有 3 张卡片。它们被平均洗牌后组成牌堆。如果顺序为“红-蓝-汤婆子”，最终得分为 $(0 + 10) \times 2 = 20$，概率是 $1/6$。如果顺序为“红-汤婆子-蓝”或“蓝-红-汤婆子”，最终得分分别为 $10$，总概率为 $1/6 + 1/6 = 2/6$。其他顺序下得分为 0。因此最终得分期望为 $20 \times 1/6 + 10 \times 2/6 = 20/3$。

 **本翻译由 AI 自动生成**

## 样例 #1

### 输入

```
1 1 1

10

2
```

### 输出

```
6.666666666666666667
```

## 样例 #2

### 输入

```
4 1 1

1 1 1 3

2
```

### 输出

```
4
```

## 样例 #3

### 输入

```
7 2 2

1 1 1 1 5 5 5

5 5
```

### 输出

```
29.13333333333333333
```

## 样例 #4

### 输入

```
20 8 3

1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20

1 2 3 4 5 6 7 8
```

### 输出

```
19030.73484848484849
```

## 样例 #5

### 输入

```
15 15 1

100 100 100 100 100 100 100 100 100 100 100 100 100 100 100

100 100 100 100 100 100 100 100 100 100 100 100 100 100 100
```

### 输出

```
5.626676749671402077e+030
```



---

---
title: "[ARC038C] 茶碗と豆"
layout: "post"
diff: 省选/NOI-
pid: AT_arc038_c
tag: []
---

# [ARC038C] 茶碗と豆

## 题目描述

[problemUrl]: https://atcoder.jp/contests/arc038/tasks/arc038_c

$ N $ 個の大きな茶碗が横 $ 1 $ 列に並んでいます。左から $ i\ (0\ ≦\ i\ ≦\ N-1) $ 番目の茶碗を茶碗 $ i $ と呼ぶことにします。茶碗 $ i\ (1\ ≦\ i\ ≦\ N-1) $ には整数 $ C_i $ が書かれており、中には $ A_i $ 個の豆が入っています。茶碗 $ 0 $ には整数は書かれておらず、豆も入っていません。ゲーム好きな兄妹がこれらの茶碗と豆を使って以下のようなゲームをしようとしています。

- プレイヤーは自分のターンに、茶碗 $ 0 $ 以外の茶碗に入っている豆 $ 1 $ つ選んで取り出す。
- 茶碗 $ i $ から豆を取り出したときは、茶碗 $ i\ -\ C_i $, 茶碗 $ i\ -\ C_i\ +\ 1 $, ..., 茶碗 $ i-1 $ のいずれかの茶碗に豆を入れなければならない。
- 交互にターンを繰り返し、自分のターンに選べる豆がなくなったプレイヤーの負けとなる（もう一方のプレイヤーが勝ちとなる）。

$ 2 $ 人ともが勝ちを目指して最適な戦略をとったとき、先手と後手のどちらが勝つでしょうか？

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ C_1 $ $ A_1 $ $ C_2 $ $ A_2 $ : $ C_{N-1} $ $ A_{N-1} $

- $ 1 $ 行目には、茶碗の個数を表す整数 $ N\ (2\ ≦\ N\ ≦\ 10^5) $ が与えられる。
- $ 2 $ 行目からの $ N-1 $ 行には、茶碗の情報が与えられる。このうち $ i\ (1\ ≦\ i\ ≦\ N-1) $ 行目には、$ 2 $ つの整数 $ C_i\ (1\ ≦\ C_i\ ≦\ i),\ A_i\ (0\ ≦\ A_i\ ≦\ 10^9) $ が与えられる。これは、茶碗 $ i $ に書かれた整数が $ C_i $ であり、中に $ A_i $ 個の豆が入っていることを表す。ただし、いずれかの茶碗には豆が入っていること、すなわち $ A_i $ の合計が $ 0 $ でないことが保証される。

## 输出格式

先手が勝つ場合は `First` を、後手が勝つ場合は `Second` を $ 1 $ 行に出力せよ。出力の末尾に改行を入れること。

## 说明/提示

### 部分点

この問題には部分点が設定されている。

- $ N\ ≦\ 100 $ かつ $ A_i\ ≦\ 10 $ を満たすデータセット $ 1 $ に正解した場合は、$ 80 $ 点が与えられる。
- $ N\ ≦\ 100 $ を満たすデータセット $ 2 $ に正解した場合は、上記とは別に $ 20 $ 点が与えられる。
- 全てのテストケースに正解した場合は、上記とは別に $ 4 $ 点が与えられる。

### Sample Explanation 1

ゲームは、例えば以下のように進行します。 - $ 1 $ ターン目：先手が茶碗 $ 2 $ の豆を選んで取り出し、茶碗 $ 1 $ に豆を入れる - $ 2 $ ターン目：後手が茶碗 $ 1 $ の豆を選んで取り出し、茶碗 $ 0 $ に豆を入れる - $ 3 $ ターン目：豆を選ぶことができないため、先手の負けとなる この例の場合、各プレイヤーの行動の選択肢はどのターンにも $ 1 $ つしかないため必ずこのような結果となります。

### Sample Explanation 2

ゲームは、例えば以下のように進行します。 - $ 1 $ ターン目：先手が茶碗 $ 5 $ の豆を選んで取り出し、茶碗 $ 4 $ に豆を入れる - $ 2 $ ターン目：後手が茶碗 $ 4 $ の豆を選んで取り出し、茶碗 $ 2 $ に豆を入れる - $ 3 $ ターン目：先手が茶碗 $ 2 $ の豆を選んで取り出し、茶碗 $ 1 $ に豆を入れる - $ 4 $ ターン目：後手が茶碗 $ 1 $ の豆を $ 1 $ つ選んで取り出し、茶碗 $ 0 $ に豆を入れる - $ 5 $ ターン目：先手が茶碗 $ 1 $ の豆を選んで取り出し、茶碗 $ 0 $ に豆を入れる - $ 6 $ ターン目：豆を選ぶことができないため、後手の負けとなる その他の進行でも、後手がどのような行動をとっても先手が適切な行動をとることによって勝つことができます。

## 样例 #1

### 输入

```
3

1 0

1 1
```

### 输出

```
Second
```

## 样例 #2

### 输入

```
7

1 1

2 0

1 0

2 0

4 1

3 0
```

### 输出

```
First
```

## 样例 #3

### 输入

```
7

1 1

2 0

1 9

2 10

4 3

3 5
```

### 输出

```
Second
```



---

---
title: "[ARC038D] 有向グラフと数"
layout: "post"
diff: 省选/NOI-
pid: AT_arc038_d
tag: []
---

# [ARC038D] 有向グラフと数

## 题目描述

有一有向图，带有 $N$ 个顶点和 $M$ 条边。图中的每个顶点上都写有整数，第 $i$ 个顶点上的整数是 $X_{i}$ 。一对喜欢玩游戏的兄妹用一枚象棋“马”在上面玩游戏。



- 游戏开始时，马位于 $1$ 号顶点。

- 在自己的回合，玩家必须在下述操作中恰好选择一项：

	+ **移动**：将马沿着边，从其当前所在的顶点移动至相邻顶点。必须恰好移动 $1$ 次；

    + **结束**：使游戏结束。

- 两名玩家轮流进入自己的回合。当有玩家执行“结束”操作时、或者在后手恰好移动 $10^{9}$ 次后，游戏立即结束。此时，游戏的**分数**就是马所在的顶点上写着的整数。



先手会采取行动使得分数尽可能地大，后手会采取行动使得分数尽可能地小。你知道游戏分数最后会是多少吗？

## 输入格式

输入数据以下述格式从标准输入给出。



- 第一行中的两个整数 $N$ 和 $M$ 分别表示图的顶点数和边数，以空格分隔。其中，$1 \le N \le 100,000$，$1 \le M \le 200,000$；

- 第二行中的 $N$ 个整数，依次对应各顶点上写着的整数，以空格分隔。其中，第 $i$ 个整数 $X_{i} $对应 $i$ 号顶点，$1\le i\le N$，$0 \le X_{i} \le 10^{9}$；

- 从第三行起，包括第三行在内的 $M$ 行，每一行给出以空格分隔的两个整数 $A_{i}$，$B_{i}$ ，表示从顶点  $A_{i}$ 到顶点 $B_{i}$  存在一条有向边，其中，$1 \le i \le M,$$1\le A_{i}\le N,$$1\le B_{i}\le N,$$A_{i} \neq B_{i}$。输入数据中不含有相同的边，即，当$p \neq q$ 时，$A_{p} \neq A_{q}$ 或者 $B_{p} \neq B_{q}$ 成立。

## 输出格式

一行，输出游戏的分数，行末输出换行符。

## 说明/提示

## 分部计分

此题分部计分。

- 数据集 $1$ 满足 $N \le 1000,$$M \le 2000$，解答正确者计 $30$ 分；

- 全部正确者，在上述 $30$ 分的基础上再计 $70$ 分。



此例中，游戏以下述过程进行：

- 先手将马从顶点 1 移至顶点 2 ；

- 后手将马从顶点 2 移至顶点 3 ；

- 先手结束游戏。



此时游戏结束，分数为2。在后手采取最优策略的情况下，先手不论采取何种策略，都不可能使分数大于2；且，在先手采取最优策略的情况下，后手不论采取何种策略，都不可能使分数小于2。



此例中，游戏以下述过程进行：

- 先手将马从顶点 1 移至顶点 2 ；

- 后手将马从顶点 2 移至顶点 4 ；

- 先手将马从顶点 4 移至顶点 3 ；

- 后手将马从顶点 3 移至顶点 1 ；

- （上述过程重复）

- 后手的第 $10^{9}$ 次移动，将马从顶点 3 移至顶点 1。



此时游戏结束，分数为1。在后手采取最优策略的情况下，先手不论采取何种策略，都不可能使分数大于1；且，在先手采取最优策略的情况下，后手不论采取何种策略，都不可能使分数小于1。

## 样例 #1

### 输入

```
3 3

1 3 2

1 2

2 3

3 1
```

### 输出

```
2
```

## 样例 #2

### 输入

```
4 5

1 3 2 1

1 2

2 3

3 1

2 4

4 3
```

### 输出

```
1
```



---

---
title: "[ARC039D] 旅行会社高橋君"
layout: "post"
diff: 省选/NOI-
pid: AT_arc039_d
tag: []
---

# [ARC039D] 旅行会社高橋君

## 题目描述

[problemUrl]: https://atcoder.jp/contests/arc039/tasks/arc039_d

高橋君とあなたはTK国でHS会社という旅行会社を経営しています。 TK国は $ N $ 個の頂点と $ M $ 本の辺からなる連結な単純無向グラフです。各頂点にはそれぞれ $ 1 $ から $ N $ の番号が振られています。

HS会社では、顧客ごとに旅行計画を立てて提供するサービスを行っています。 これまでは、旅行計画を温もりのある手作業で作成していました。 ですが突然の旅行ブームがTK国に訪れ、ナウでヤングな若者は皆旅行をするようになりました。もちろん会社は大忙し、とうとうコンピューターに頼ることにしました。

HS会社では、顧客から始点、中継点、終点という $ 3 $ つの頂点を与えられるので、始点から中継点を通り終点へと到着するような旅行計画を提供しています。 ただし、顧客が退屈しないように、同じ辺を複数回通るような旅行計画は提供しないようにしています。同じ頂点を複数回通る事に制限はありません。つまり旅行計画は、始点から中継点を通り終点に到着するトレイルです。

あなたはとりあえず、顧客ごとにそのような旅行計画は存在するのかどうかだけを判別するプログラムを書くことにしました。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ M $ $ X_1 $ $ Y_1 $ $ X_2 $ $ Y_2 $ : $ X_M $ $ Y_M $ $ Q $ $ A_1 $ $ B_1 $ $ C_1 $ $ A_2 $ $ B_2 $ $ C_2 $ : $ A_Q $ $ B_Q $ $ C_Q $

- $ 1 $ 行目は $ 2 $ つの整数 $ N(3\ ≦\ N\ ≦\ 100,000) $、$ M(1\ ≦\ M\ ≦\ 200,000) $ が空白区切りで与えられ、これはTK国の頂点数と辺数を表す。
- $ 2 $ 行目からの $ M $ 行は辺の情報を表す。そのうち $ i $ 行目には $ 2 $ つの整数 $ X_i $、$ Y_i $ が空白区切りで与えられ、これは $ i $ 番目の辺が 頂点 $ X_i(1\ ≦\ X_i\ ≦\ N) $ と頂点 $ Y_i(1\ ≦\ Y_i\ ≦\ N) $ を結んでいることを表す。
- $ 2+M $ 行目には、 $ 1 $ つの整数 $ Q(1\ ≦\ Q\ ≦\ 100,000) $ が与えられる。これはプログラムに旅行計画が存在するかを判定させたい顧客が $ Q $ 人いることを表す。
- $ 3+M $ 行目からの $ Q $ 行は顧客の情報を表す。そのうち $ i $ 行目は $ 3 $ つの整数 $ A_i $、$ B_i $、$ C_i $ が空白区切りで与えられ、これは $ i $ 番目の顧客に与えられた始点、中継点、終点がそれぞれ頂点 $ A_i(1\ ≦\ A_i\ ≦\ N) $、頂点 $ B_i(1\ ≦\ B_i\ ≦\ N) $、頂点 $ C_i(1\ ≦\ C_i\ ≦\ N) $ であることを表す。
- TK国は連結なグラフである。
- TK国は単純なグラフである、つまり多重辺や自己辺は存在しない。
- $ A_i $、$ B_i $、$ C_i $ は互いに異なる。

## 输出格式

$ Q $ 行出力せよ。そのうち $ i $ 行目は $ i $ 番目の顧客の旅行計画が存在するなら `OK`、存在しないならば `NG` である。出力は標準出力に行い、末尾に改行を入れること。

## 说明/提示

### Sample Explanation 1

以下にこの入力でのTK国を図示する。 !\[\](http://arc039.contest.atcoder.jp/img/arc/039/vn240wsdnl23fn4zd0i/D\_sample1.png) 一例として、 - $ 1 $ 番目の顧客には $ 1\ -\ 2\ -\ 3 $ - $ 3 $ 番目の顧客には $ 2\ -\ 3\ -\ 5\ -\ 4\ -\ 3 $ - $ 4 $ 番目の顧客には $ 3\ -\ 4\ -\ 5 $ という旅行計画が提供できる。 また、 $ 2 $ 番目の顧客に提供できる旅行計画は存在しない。

### Sample Explanation 2

以下にこの入力でのTK国を図示する。 !\[\](http://arc039.contest.atcoder.jp/img/arc/039/vn240wsdnl23fn4zd0i/D\_sample2.png)

### Sample Explanation 3

以下にこの入力でのTK国を図示する。 !\[\](http://arc039.contest.atcoder.jp/img/arc/039/vn240wsdnl23fn4zd0i/D\_sample3.png)

## 样例 #1

### 输入

```
5 5

1 2

2 3

3 4

4 5

5 3

4

1 2 3

1 3 2

2 4 3

3 4 5
```

### 输出

```
OK

NG

OK

OK
```

## 样例 #2

### 输入

```
7 7

4 7

1 7

2 6

2 4

3 4

3 5

3 7

11

3 5 6

6 4 7

5 7 3

4 7 2

4 3 6

2 7 6

1 2 4

2 7 3

7 1 4

3 2 5

2 6 7
```

### 输出

```
NG

OK

OK

OK

OK

NG

NG

OK

NG

NG

NG
```

## 样例 #3

### 输入

```
7 8

2 5

5 4

4 2

2 1

1 6

6 3

3 7

7 6

10

3 6 2

1 4 5

1 5 6

6 2 4

5 2 6

3 1 7

7 2 6

5 4 2

6 7 5

2 5 1
```

### 输出

```
OK

OK

NG

OK

OK

NG

NG

OK

OK

OK
```



---

---
title: "[ARC043C] 転倒距離"
layout: "post"
diff: 省选/NOI-
pid: AT_arc043_c
tag: []
---

# [ARC043C] 転倒距離

## 题目描述

[problemUrl]: https://atcoder.jp/contests/arc043/tasks/arc043_c

$ 1 $ から $ N $ の整数を並び替えた数列をサイズ $ N $ の順列と呼ぶ。

同じサイズの順列 $ X,\ Y $ があるとき、$ X $ と $ Y $ で順序が入れ替わっている数字の組の数を $ X $ と $ Y $ の転倒距離と呼ぶ。

例えば $ [3,\ 1,\ 4,\ 2,\ 5] $ と $ [2,\ 5,\ 3,\ 4,\ 1] $ では以下の $ 7 $ 個の組の順序が入れ替わっているので転倒距離は $ 7 $ である。

- $ (1,\ 2),\ (1,\ 4),\ (1,\ 5),\ (2,\ 3),\ (2,\ 4),\ (3,\ 5),\ (4,\ 5) $

サイズ $ N $ の順列 $ A,\ B $ が与えられる。

$ A $ とも $ B $ とも転倒距離が等しいサイズ $ N $ の順列があるか判断し、あるならば $ 1 $ つ挙げよ。

答えが複数通りある場合はどれを挙げても良い。

## 输入格式

入力は以下の形式で標準入力から与えられる

> $ N $ $ A_1 $ $ A_2 $ .. $ A_N $ $ B_1 $ $ B_2 $ .. $ B_N $

- $ 1 $ 行目には与えられる順列のサイズを表す整数 $ N\ (1\ ≦\ N\ ≦\ 10^5) $ が与えられる。
- $ 2 $ 行目には順列 $ A $ の要素を表す整数が $ N $ 個、空白区切りで与えられる。 $ i $ 番目の整数は $ A $ の $ i $ 番目の要素 $ A_i(1\ ≦\ A_i\ ≦\ N) $ である。
- $ 3 $ 行目には順列 $ B $ の要素を表す整数が $ N $ 個、空白区切りで与えられる。 $ i $ 番目の整数は $ B $ の $ i $ 番目の要素 $ B_i(1\ ≦\ B_i\ ≦\ N) $ である。
- $ i\ ≠\ j $ ならば $ A_i\ ≠\ A_j $ と $ B_i\ ≠\ B_j $ が成り立つ。

## 输出格式

もし条件を満たす順列が存在しなければ $ -1 $ を $ 1 $ 行に出力せよ。 存在するならば、その要素を空白区切りで $ 1 $ 行に出力せよ。

## 说明/提示

### 部分点

この問題には部分点が設定されている。

- $ 1\ ≦\ N\ ≦\ 3,000 $ を満たすデータセットに正解した場合は $ 30 $ 点が与えられる。
- $ 1\ ≦\ N\ ≦\ 10^5 $ を満たすデータセットに正解した場合はさらに $ 70 $ 点が与えられる。合計で $ 100 $ 点となる。

### Sample Explanation 1

出力した順列を $ C $ とすると、$ A $ と $ C $の転倒距離も $ B $ と $ C $ の転倒距離も $ 5 $ である。

### Sample Explanation 2

$ A $ とも $ B $ とも同じ転倒距離の順列は存在しません。

## 样例 #1

### 输入

```
5

1 2 3 4 5

5 4 3 2 1
```

### 输出

```
5 2 1 3 4
```

## 样例 #2

### 输入

```
5

1 2 3 4 5

1 2 4 3 5
```

### 输出

```
-1
```

## 样例 #3

### 输入

```
9

3 1 4 2 5 9 7 6 8

2 1 8 3 5 7 9 4 6
```

### 输出

```
3 1 2 8 4 5 7 9 6
```



---

---
title: "[ARC046D] うさぎとマス目"
layout: "post"
diff: 省选/NOI-
pid: AT_arc046_d
tag: []
---

# [ARC046D] うさぎとマス目

## 题目描述

[题目链接]: https://atcoder.jp/contests/arc046/tasks/arc046_d

## 说明/提示

该题目的具体内容请访问[题目链接]查看。在此链接中，你将了解问题的详细描述，包括要求实现的算法逻辑，以及可能的输入输出方式。题目可能涉及复杂的数学公式和编程概念，请确保链接能够正常访问以获得完整信息。

 **本翻译由 AI 自动生成**

## 样例 #1

### 输入

```
2 2
```

### 输出

```
2
```

## 样例 #2

### 输入

```
6 3
```

### 输出

```
3
```

## 样例 #3

### 输入

```
3 4
```

### 输出

```
0
```

## 样例 #4

### 输入

```
10 10
```

### 输出

```
260
```

## 样例 #5

### 输入

```
200 300
```

### 输出

```
551887980
```



---

---
title: "[ARC047B] 同一円周上"
layout: "post"
diff: 省选/NOI-
pid: AT_arc047_b
tag: []
---

# [ARC047B] 同一円周上

## 题目描述

[problemUrl]: https://atcoder.jp/contests/arc047/tasks/arc047_b

座標平面上に $ N $ 個の点があります。

これらの点は全て、$ x $ 座標 と $ y $ 座標の値が共に整数です。つまり格子点上にあります。

そのうえ、これらの点は全て、ある点 $ P $ とのマンハッタン距離が同じであることがわかっています。ここで、マンハッタン距離とは、 $ 2 $ つの点の座標がそれぞれ $ (a,\ b),\ (c,\ d) $ であるとき、 $ |\ a-c\ |\ +\ |\ b-d\ | $ で計算される距離のことです。

そして、点 $ P $ も格子点上にあります。

点 $ P $ としてあり得る点を $ 1 $ つ挙げてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ x_1 $ $ y_1 $ $ x_2 $ $ y_2 $ : $ x_N $ $ y_N $

- $ 1 $ 行目には点の個数を表す整数 $ N\ (1\ ≦\ N\ ≦\ 10^5) $ が与えられる。
- $ 2 $ 行目からの $ N $ 行のうち $ i $ 行目には $ i $ 番目の点の座標を表す $ 2 $ つの整数 $ x_i,\ y_i(-10^9\ ≦\ x_i,\ y_i\ ≦\ 10^9) $が与えられる。
- $ i $ ≠ $ j $ ならば $ (x_i,\ y_i)\ ≠\ (x_j,\ y_j) $ が成り立つ。
- $ N $ 個の点は必ずある点からのマンハッタン距離が等しい。

## 输出格式

点 $ P $ としてあり得る点の $ x $ 座標の値 $ Px $と $ y $ 座標の値 $ Py $ を順に空白区切りで1行に出力せよ。

このとき $ -10^9\ ≦\ Px,\ Py\ ≦\ 10^9 $ が成り立ってなければならない(そのような解が存在することは保証される)。

出力の末尾に改行を入れること。

## 说明/提示

### Sample Explanation 1

与えられた点は全て点 $ (2,\ 3) $ からのマンハッタン距離が $ 2 $ です。

### Sample Explanation 2

$ y\ ≦\ 0 $ であるような点 $ (0,\ y) $ は全て、点 $ P $ としての条件を満たします。 この場合 $ -10^9\ ≦\ y $ であるかぎり、どれを出力しても構いません。

## 样例 #1

### 输入

```
3

1 2

3 4

2 5
```

### 输出

```
2 3
```

## 样例 #2

### 输入

```
3

0 1

1 0

-1 0
```

### 输出

```
0 -2016
```



---

---
title: "[ARC047D] ナナメクエリ"
layout: "post"
diff: 省选/NOI-
pid: AT_arc047_d
tag: []
---

# [ARC047D] ナナメクエリ

## 题目描述

有一个 $N \times N$ 的方格纸。

我们将方格纸的最左上角定义为格子 $(0, 0)$，最右下角为格子 $(N-1, N-1)$。对任意格子 $(X, Y)$，其表示从最左上角格子向下移动 $X$ 格，向右移动 $Y$ 格所到达的位置。

初始时，所有格子的值均为 $0$。

现在，需要对这张方格纸进行 $Q$ 次操作。操作类型共有三种，描述如下：

1. `1 A B C`：对所有满足 $A \leq X+Y \leq B$ 的格子 $(X, Y)$，将其值增加 $C$。保证 $0 \leq A \leq B \leq 2N-2$ 且 $-10^5 \leq C \leq 10^5$。
2. `2 A B C`：对所有满足 $A \leq X-Y \leq B$ 的格子 $(X, Y)$，将其值增加 $C$。保证 $1-N \leq A \leq B \leq N-1$ 且 $-10^5 \leq C \leq 10^5$。
3. `3 A B C D`：在所有满足 $A \leq X \leq B$ 且 $C \leq Y \leq D$ 的格子中，找出最大值 $M$，并计算这些格子中写有 $M$ 的个数。保证 $0 \leq A \leq B \leq N-1$ 且 $0 \leq C \leq D \leq N-1$。

你的任务是编写程序，依次处理这些查询操作。

## 输入格式

输入包含以下内容：

- 第一行是两个整数 $N$ 和 $Q$，分别表示方格纸的大小和查询的数量。保证 $1 \leq N \leq 5000$ 且 $1 \leq Q \leq 5000$。
- 接下来的 $Q$ 行，每行对应一个查询操作。格式如同题目描述。
- 至少有一个查询是类型为 `3` 的。

## 输出格式

输出的行数应与类型为 `3` 的查询数量相等。对于第 $i$ 个类型为 `3` 的查询，请输出其结果。结果需包括该范围内的最大值 $M$ 和该值的出现次数，格式为 "$M\ C$"（中间用空格分隔）。注意，每行末尾需要有一个换行符。

## 说明/提示

### 部分得分

本题有设置部分得分：

- 如果正确解答 $1 \leq N \leq 50$ 的数据集，可以获得 $10$ 分。
- 如果正确解答 $1 \leq N \leq 500$ 的数据集，可以额外获得 $20$ 分，总分达到 $30$ 分。
- 如果正确解答 $1 \leq N \leq 5000$ 的数据集，可以再获得 $70$ 分，总分 $100$ 分。

 **本翻译由 AI 自动生成**

## 样例 #1

### 输入

```
4 4

1 1 4 2

3 0 1 2 3

2 -2 1 3

3 0 3 1 3
```

### 输出

```
2 4

5 7
```

## 样例 #2

### 输入

```
50 20

2 5 40 6

1 69 94 5

3 8 39 31 32

2 -29 -21 -10

2 20 43 3

2 -37 36 -10

2 -18 45 5

2 30 39 -2

3 0 1 19 33

3 27 47 0 43

3 0 1 28 39

1 90 97 0

2 -46 31 7

1 81 81 4

1 11 54 3

3 10 29 26 30

1 39 45 3

1 70 97 -4

3 24 46 14 34

3 1 18 48 48
```

### 输出

```
11 5

-5 1

14 8

0 3

5 82

16 2

10 5
```



---

---
title: "[ARC048D] たこ焼き屋とQ人の高橋君"
layout: "post"
diff: 省选/NOI-
pid: AT_arc048_d
tag: []
---

# [ARC048D] たこ焼き屋とQ人の高橋君

## 题目描述

[problemUrl]: https://atcoder.jp/contests/arc048/tasks/arc048_d

AtCoder市には $ 1 $ から $ N $ までの番号のついた $ N $ 個の町があり、それらは $ N-1 $ 本の双方向に通行可能な距離 $ 1 $ の道路によって結ばれています。 どの町からどの町へも、いくつかの道を経由してたどり着くことが出来ます。

AtCoder市には高橋君が $ Q $ 人おり、$ i $ 人目の高橋君は町 $ s_i $ から町 $ t_i $ に行きたいです。

AtCoder市のいくつかの町にはたこ焼き屋があります。高橋君たちはみな、$ 2 $ 秒間に距離 $ 1 $ 進む速度で歩きますが、たこ焼き屋のある町でたこ焼きを食べたあとは歩く速度が $ 1 $ 秒間に距離 $ 1 $ 進む速度になります。 また高橋君たちはみな小食なので、たこ焼きを複数回食べることはしません。もちろん、たこ焼き屋のある町をたこ焼きを食べずに通過することは可能です。 また、たこ焼きを食べずに町 $ t_i $ に到着してもかまいません。

AtCoder市の町の接続関係が与えられるので、 $ Q $ 人の高橋君すべてに対し、最適に行動したときの町 $ s_i $ から町 $ t_i $への移動に費やされる時間の最小値を求めてください。 高橋君たちはみなたこ焼きのプロなので、たこ焼きを食べるのにかかる時間は無視できるものとします。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ Q $ $ A_1 $ $ B_1 $ . . . $ A_{N-1} $ $ B_{N-1} $ $ S $ $ s_1 $ $ t_1 $ . . . $ s_Q $ $ t_Q $

- $ 1 $ 行目には、整数 $ N(1\ ≦\ N\ ≦\ 100000) $ と $ Q(1\ ≦\ Q\ ≦\ 100000) $ が空白を区切りとして与えられる。
- 続く $ N-1 $ 行には、 $ i $ 番目の道の情報を表す整数 $ A_i,\ B_i(1\ ≦\ A_i\ ≦\ N,\ 1\ ≦\ B_i\ ≦\ N,\ A_i\ ≠\ B_i) $ が空白を区切りとして与えられる。これは、町 $ A_i $ と町 $ B_i $ を結ぶ道があることを表す。
- 続く行には、$ 0 $ と $ 1 $ のみからなる長さ $ N $ の文字列が与えられる。この $ i $ 文字目が $ 0 $ のとき町 $ i $ にはたこ焼き屋がないことを、$ 1 $ のとき町 $ i $ にはたこ焼き屋があることを表す。
- 続く $ Q $ 行には、$ i $ 人目の高橋君の移動の始点と目的地を表す整数 $ s_i,t_i(1\ ≦\ s_i\ ≦\ N,\ 1\ ≦\ t_i\ ≦\ N) $ が与えられる。

## 输出格式

出力は $ Q $ 行からなる。

$ i $ 行目には、$ i $ 人目の高橋君が最適に行動したときの移動にかかる時間の最小値を $ 1 $ 行に出力せよ。

出力の最後には改行を忘れないこと。

## 说明/提示

### Sample Explanation 1

最初のクエリでは、町 $ 1,2,4,5 $ を順に訪れる場合が最善となります。 $ 2 $ 番目のクエリでは、町 $ 1,2,3,2,4,5,6,7 $ と順に訪れ、途中町 $ 3 $ のたこ焼き屋に寄る場合が最善となります。

## 样例 #1

### 输入

```
7 4

1 2

2 3

2 4

4 5

5 6

6 7

0010000

1 5

1 7

6 1

3 3
```

### 输出

```
6

9

8

0
```

## 样例 #2

### 输入

```
5 2

3 2

2 4

1 4

2 5

00000

1 5

2 3
```

### 输出

```
6

2
```

## 样例 #3

### 输入

```
12 10

1 2

2 3

2 4

10 12

1 5

3 11

5 6

9 10

5 7

3 9

8 7

000100100010

1 2

1 4

8 3

6 12

12 8

8 12

6 8

8 6

1 12

5 12
```

### 输出

```
2

4

6

11

14

9

5

4

9

9
```



---

---
title: "[ARC050D] Suffix Concat"
layout: "post"
diff: 省选/NOI-
pid: AT_arc050_d
tag: []
---

# [ARC050D] Suffix Concat

## 题目描述

[problemUrl]: https://atcoder.jp/contests/arc050/tasks/arc050_d





---

---
title: "[ARC051D] 長方形"
layout: "post"
diff: 省选/NOI-
pid: AT_arc051_d
tag: []
---

# [ARC051D] 長方形

## 题目描述

给定一个长度为 $W$ 的数列 $a_1, a_2, \ldots, a_W$ 和一个长度为 $H$ 的数列 $b_1, b_2, \ldots, b_H$。

现在，我们构造一个 $W \times H$ 的矩阵。矩阵中第 $i$ 列第 $j$ 行的格子的值为 $a_i + b_j$。

接下来有 $Q$ 个查询，每个查询要求如下：

- 给定两个参数 $A$ 和 $B$，请在左上角 $A$ 列以内和 $B$ 行以内的所有格子中选择一些格子，要求这些格子组成一个矩形，并求出这些格子的值之和的最大值。注意，至少需要选择一个格子。

## 输入格式

输入从标准输入读取，格式如下：

> $W\ H\ a_1\ a_2\ \ldots\ a_W\ b_1\ b_2\ \ldots\ b_H\ Q\ A_1\ B_1\ A_2\ B_2\ \ldots\ A_Q\ B_Q$

其中，$A_i$ 和 $B_i$ 分别是第 $i$ 个查询的参数 $A$ 和 $B$。

## 输出格式

输出 $Q$ 行，每行一个整数，对应每个查询的最大值结果。结果按照查询给出的顺序输出。

## 数据范围
- $1 \leq W, H \leq 2000$
- $1 \leq Q \leq 2000$
- $1 \leq A \leq W$
- $1 \leq B \leq H$
- $-100,000 \leq a_i, b_i \leq 100,000$

 **本翻译由 AI 自动生成**

## 样例 #1

### 输入

```
2 2

0 10

0 -1

4

1 1

1 2

2 1

2 2
```

### 输出

```
0

0

10

19
```

## 样例 #2

### 输入

```
3 3

1 10 100

1000 10000 100000

9

1 1

1 2

1 3

2 1

2 2

2 3

3 1

3 2

3 3
```

### 输出

```
1001

11002

111003

2011

22022

222033

3111

33222

333333
```

## 样例 #3

### 输入

```
10 8

2 -4 0 0 -1 4 5 0 -3 0

2 0 0 -3 -5 -5 -4 -4

10

2 6

1 4

1 2

5 7

1 5

7 6

7 4

1 5

3 5

10 7
```

### 输出

```
8

8

6

8

8

34

34

8

8

36
```



---

---
title: "[ARC052D] 9"
layout: "post"
diff: 省选/NOI-
pid: AT_arc052_d
tag: []
---

# [ARC052D] 9

## 题目描述

[problemUrl]: https://atcoder.jp/contests/arc052/tasks/arc052_d

整数の $ 9 $ には面白い性質があります。 どのような非負整数 $ N $ を選んでも $ N $ を $ 9 $ で割った余りと、 $ N $ を $ 10 $ 進法で表記した時の各桁の数字の和を $ 9 $ で割った余りが一致するのです。

高橋君はこのような性質を持つ整数が他にないか気になりました。しかし、残念なことにこのような性質をもつ整数は $ 9 $ と $ 3 $ と $ 1 $ くらいしか見つかりませんでした。 そこで、「どのような非負整数 $ N $ を選んでも・・・」ではなくて「できるだけ多くの非負整数 $ N $ に対して・・・」というふうに性質の条件を落として探してみることにしてみました。

高橋君は非負整数 $ K $ がどれくらい多くの非負整数 $ N $ に対して上のような条件をみたすのかが知りたいです。

高橋君を手伝うために以下の問いに答えてください。

- $ 1\ ≦\ N\ ≦\ M $ となる整数 $ N $ のうち $ K $ で割った余りと、$ N $ を $ 10 $ 進法表記した時の各桁の数字の和を $ K $ で割った余りが一致するような $ N $ の個数を求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ K $ $ M $

## 输出格式

問題文で挙げた条件に一致する非負整数の個数を $ 1 $ 行で出力せよ。

## 说明/提示

### 制約

- 与えられる数字はすべて整数
- $ 1\ ≦\ K\ ≦\ M\ ≦\ 10^{10} $

### 部分点

この問題には部分点が設定されている。

- $ 1\ ≦\ M\ ≦\ 10^5 $ を満たすデータセットに正解した場合は $ 10 $ 点が与えられる。
- $ 1\ ≦\ M\ ≦\ 10^{10} $を満たすデータセットに正解した場合はさらに $ 90 $ 点が与えられる。合計で$ 100 $点となる。

### Sample Explanation 1

$ 1 $桁の整数はかならず条件を満たします。 そのほかに $ 50\ ≦\ N\ ≦\ 59 $ を満たす整数は全て条件を満たします。 これら以外に条件を満たす整数は $ 100 $ 以下の範囲にはありません。 よって $ 19 $ を出力します。

## 样例 #1

### 输入

```
5 100
```

### 输出

```
19
```

## 样例 #2

### 输入

```
112 32279
```

### 输出

```
309
```

## 样例 #3

### 输入

```
108 3141592653
```

### 输出

```
261799999
```

## 样例 #4

### 输入

```
9 10000000000
```

### 输出

```
10000000000
```



---

---
title: "[ARC055B] せんべい"
layout: "post"
diff: 省选/NOI-
pid: AT_arc055_b
tag: []
---

# [ARC055B] せんべい

## 题目描述

[problemUrl]: https://atcoder.jp/contests/arc055/tasks/arc055_b





---

---
title: "[ARC056D] サケノミ"
layout: "post"
diff: 省选/NOI-
pid: AT_arc056_d
tag: []
---

# [ARC056D] サケノミ

## 题目描述

[problemUrl]: https://atcoder.jp/contests/arc056/tasks/arc056_d

あなたは風変わりなバーに来ています。このバーでは、$ N $種類のドリンクがあり、あなたは初めに$ N $個のグラスを与えられます。$ i $番目のグラスは$ i $番目のドリンクに対応しており、$ i $番目のドリンクのみが注がれます。また、それぞれのドリンクに対し、美味しさ$ w_i $が定まっています。初めに、全てのグラスは空です。

それぞれのドリンクは、何回か決まった時刻に補充されます。 すなわち、 時間$ t_{i,j}(1≦j≦M_i) $に$ i $番目のグラスが空ならば、$ i $番目のグラスに$ i $番目のドリンクが注がれます。

あなたは、好きな奇数時刻に、全てのグラスに入っているドリンクを全て飲み干すことができます。一部のドリンクのみを飲む行為は禁止されています。 飲んだドリンクの美味しさの総和の最大値を求めるプログラムを書いてください。ただし、同じドリンクを複数回飲んだときも、美味しさは重複して計算されることに注意してください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ w_1 $ ... $ w_N $ $ M_1 $ $ t_{1,1} $ ... $ t_{1,M_1} $ : $ M_N $ $ t_{N,1} $ ... $ t_{N,M_N} $

## 输出格式

$ 1 $行目に、美味しさの総和を出力せよ。

## 说明/提示

### 制約

- $ 1\ ≦\ N\ ≦\ 5*10^5 $
- $ 2\ ≦\ t_{i,j}\ ≦\ 10^6 $
- $ t_{i,j}\ <\ t_{i,j+1} $
- $ t_{i,j} $は偶数である
- $ Σ\ M_i\ ≦\ 5*10^5 $
- $ 1\ ≦\ M_i $
- $ -10^9\ ≦\ w_i\ ≦\ 10^9 $

### 部分点

- $ t_{i,j}\ ≦\ 1,000 $ かつ $ N\ ≦\ 1,000 $ を満たすテストケース全てに正解した場合、部分点として$ 30 $点が与えられる。

### Sample Explanation 1

時刻$ 9 $と$ 11 $にグラスにあるドリンクを全て飲み干します。 時刻$ 9 $では、$ 3 $つ全てドリンクが注がれているため、美味しさ$ 2+5-6=1 $を得ます。 時刻$ 11 $では、$ 2 $番目のドリンクのみ注がれているため、美味しさ$ 5 $を得ます。合計$ 6 $となります。

## 样例 #1

### 输入

```
3

2 5 -6

1 2

2 4 10

2 4 8
```

### 输出

```
6
```

## 样例 #2

### 输入

```
3

2 5 -6

2 2 8

2 4 10

2 4 10
```

### 输出

```
3
```

## 样例 #3

### 输入

```
3

3 5 -4

2 2 8

4 4 6 10 12

4 2 4 8 10
```

### 输出

```
18
```

## 样例 #4

### 输入

```
3

-2 -2 -2

2 2 8

4 4 6 10 12

4 2 4 8 10
```

### 输出

```
0
```



---

---
title: "[ARC057C] 2乗根"
layout: "post"
diff: 省选/NOI-
pid: AT_arc057_c
tag: []
---

# [ARC057C] 2乗根

## 题目描述

给定$\sqrt{N}$小数形式的前$k$位$a_1a_2...a_k$，你需要求出满足这样条件的$N$。



特别指明，小数形式的前$k$位是用十进制表示的，并且中间的小数点和最前面的0都不会表示出来，题中所给出的数据会从第一个非0的位数开始。举个例子：$\sqrt{2}$的前5位为$14142$，而$\sqrt{100}$的前6位为$100000$。

## 输入格式

只有一行，按照$a_1a_2...a_k$的形式给出。

## 输出格式

只有一行，输出前k位数字为$a_1a_2...a_k$的最小的正整数$N$。

## 说明/提示

限制条件：



- $1 \leq k \leq 1000$

- $a_1 \neq 0$

## 样例 #1

### 输入

```
1414
```

### 输出

```
2
```

## 样例 #2

### 输入

```
316
```

### 输出

```
10
```

## 样例 #3

### 输入

```
31415926535897932384626433
```

### 输出

```
9869604401089358618834491
```



---

---
title: "[ARC060F] 最良表現"
layout: "post"
diff: 省选/NOI-
pid: AT_arc060_d
tag: []
---

# [ARC060F] 最良表現

## 题目描述

[problemUrl]: https://atcoder.jp/contests/arc060/tasks/arc060_d

$ x $ を長さ $ 1 $ 以上の文字列とします。 いかなる文字列 $ y $ および $ 2 $ 以上の整数 $ k $ に対しても、 $ y $ を $ k $ 回繰り返した文字列が $ x $ と異なるならば、 $ x $ を*良い文字列*であると呼ぶことにします。 例えば、`a`, `bbc`, `cdcdc` などは良い文字列ですが、 `aa`, `bbbb`, `cdcdcd` などは良い文字列ではありません。

$ w $ を長さ $ 1 $ 以上の文字列とします。 $ m $ 項からなる列 $ F=(\,f_1,\,f_2,\,...,\,f_m) $ について、 次の条件がともに満たされるならば、$ F $ を $ w $ の*良い表現*と呼ぶことにします。

- すべての $ i\ \,\ (1\ \leq\ i\ \leq\ m) $ について、$ f_i $ は良い文字列である。
- $ f_1,\,f_2,\,...,\,f_m $ をこの順に連結すると $ w $ になる。

例えば、$ w= $`aabb` の場合、$ w $ の良い表現は次の $ 5 $ つとなります。

- $ ( $`aabb`$ ) $
- $ ( $`a`$ , $`abb`$ ) $
- $ ( $`aab`$ , $`b`$ ) $
- $ ( $`a`$ , $`ab`$ , $`b`$ ) $
- $ ( $`a`$ , $`a`$ , $`b`$ , $`b`$ ) $

文字列 $ w $ の良い表現のうち、項数 $ m $ が最小であるものを、 $ w $ の*最良表現*と呼ぶことにします。 例えば、$ w= $`aabb` の最良表現は $ ( $`aabb`$ ) $ の $ 1 $ つのみとなります。

文字列 $ w $ が与えられます。次の $ 2 $ つを求めてください。

- $ w $ の最良表現の項数
- $ w $ の最良表現の総数を $ 1000000007\ \,\ (=10^9+7) $ で割った余り

なお、$ w $ に対し、良い表現が存在することは保証されます。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ w $

## 输出格式

出力は $ 2 $ 行からなる。

- $ 1 $ 行目に、$ w $ の最良表現の項数を出力せよ。
- $ 2 $ 行目に、$ w $ の最良表現の総数を $ 1000000007 $ で割った余りを出力せよ。

## 说明/提示

### 制約

- $ 1\ \leq\ |w|\ \leq\ 500000\ \,\ (=5\ \times\ 10^5) $
- $ w $ は英小文字 (`a`-`z`) のみからなる文字列である

### 部分点

- $ 1\ \leq\ |w|\ \leq\ 4000 $ を満たすデータセットに正解した場合は、$ 400 $ 点が与えられる。

### Sample Explanation 2

\- この入力に対しては、項数が $ 2 $ の最良表現が以下の $ 3 $ 通り存在します。 - $ ( $`b`$ , $`cbc`$ ) $ - $ ( $`bc`$ , $`bc`$ ) $ - $ ( $`bcb`$ , $`c`$ ) $

## 样例 #1

### 输入

```
aab
```

### 输出

```
1

1
```

## 样例 #2

### 输入

```
bcbc
```

### 输出

```
2

3
```

## 样例 #3

### 输入

```
ddd
```

### 输出

```
3

1
```



---

---
title: "[ARC064F] Rotated Palindromes"
layout: "post"
diff: 省选/NOI-
pid: AT_arc064_d
tag: []
---

# [ARC064F] Rotated Palindromes

## 题目描述

[problemUrl]: https://atcoder.jp/contests/arc064/tasks/arc064_d

高橋君と青木君が協力して数列を作ることになりました。

まず、高橋君が次の条件をすべて満たす数列 $ a $ を用意します。

- $ a $ は長さ $ N $ である。
- $ a $ の各要素は $ 1 $ 以上 $ K $ 以下の整数である。
- $ a $ は回文である。 すなわち、$ a $ を逆順にした数列は元の $ a $ と一致する。

次に、青木君が次の操作を好きな回数だけ繰り返します。

- $ a $ の先頭要素を末尾へ移動する。

以上の手続きにより、最終的な $ a $ が得られます。

最終的な $ a $ として考えられるものは何通りあるでしょうか？ $ 10^9+7 $ で割った余りを求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ K $

## 输出格式

最終的な $ a $ として考えられるものは何通りあるか？ $ 10^9+7 $ で割った余りを出力せよ。

## 说明/提示

### 制約

- $ 1\ <\ =N\ <\ =10^9 $
- $ 1\ <\ =K\ <\ =10^9 $

### Sample Explanation 1

次の $ 6 $ 通りです。 - $ (1,\ 1,\ 1,\ 1) $ - $ (1,\ 1,\ 2,\ 2) $ - $ (1,\ 2,\ 2,\ 1) $ - $ (2,\ 2,\ 1,\ 1) $ - $ (2,\ 1,\ 1,\ 2) $ - $ (2,\ 2,\ 2,\ 2) $

## 样例 #1

### 输入

```
4 2
```

### 输出

```
6
```

## 样例 #2

### 输入

```
1 10
```

### 输出

```
10
```

## 样例 #3

### 输入

```
6 3
```

### 输出

```
75
```

## 样例 #4

### 输入

```
1000000000 1000000000
```

### 输出

```
875699961
```



---

---
title: "[ARC065F] シャッフル"
layout: "post"
diff: 省选/NOI-
pid: AT_arc065_d
tag: []
---

# [ARC065F] シャッフル

## 题目描述

[problemUrl]: https://atcoder.jp/contests/arc065/tasks/arc065_d

長さ $ N $ の `0`、`1` からなる文字列 $ S $ があります。あなたは、以下の操作を各 $ 1≦i≦M $ に対し $ i $ の昇順に行います。

- $ S $ のうち、左から $ l_i $ 文字目から $ r_i $ 文字目までの部分文字列を自由な順番で並び替える。

ただし、$ l_i $ は非減少です。

$ M $ 回の操作後の $ S $ としてありうるものの数を $ 1000000007(=\ 10^9+7) $ で割った余りを求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ M $ $ S $ $ l_1 $ $ r_1 $ : $ l_M $ $ r_M $

## 输出格式

$ M $ 回の操作後の $ S $ としてありうるものの数を $ 1000000007 $ で割った余りを出力してください。

## 说明/提示

### 制約

- $ 2≦N≦3000 $
- $ 1≦M≦3000 $
- $ S $ は`0`, `1` からなる。
- $ S $ の長さは $ N $ と等しい。
- $ 1≦l_i\ <\ r_i≦N $
- $ l_i\ ≦\ l_{i+1} $

### Sample Explanation 1

$ 1 $回目の操作後の $ S $ としてありうるものは、 `01001`, `00101`, `00011` の $ 3 $ つです。 $ 2 $回目の操作後の $ S $ としてありうるものは、 `01100`, `01010`, `01001`, `00011`, `00101`, `00110` の $ 6 $ つです。

## 样例 #1

### 输入

```
5 2

01001

2 4

3 5
```

### 输出

```
6
```

## 样例 #2

### 输入

```
9 3

110111110

1 4

4 6

6 9
```

### 输出

```
26
```

## 样例 #3

### 输入

```
11 6

00101000110

2 4

2 3

4 7

5 6

6 10

10 11
```

### 输出

```
143
```



---

---
title: "[ARC066E] Addition and Subtraction Hard"
layout: "post"
diff: 省选/NOI-
pid: AT_arc066_c
tag: []
---

# [ARC066E] Addition and Subtraction Hard

## 题目描述

[problemUrl]: https://atcoder.jp/contests/arc066/tasks/arc066_c

joisinoお姉ちゃんは、$ N $ 項から成る式、$ A_1 $ $ op_1 $ $ A_2 $ $ ... $ $ op_{N-1} $ $ A_N $ を持っています。 ここで、$ A_i $ は整数で、$ op_i $ は、`+` または `-` の記号です。 joisinoお姉ちゃんは大きい数が好きなので、括弧を好きな数だけ( $ 0 $ 個でもよい)挿入することで、計算の順番を変え、式の値を最大化したいです。 開き括弧は数の直前、閉じ括弧は数の直後にのみ、挿入することが許されます。 同じ場所に挿入する括弧の個数に制限はありません。 あなたの仕事は、式に括弧をいくつか挿入した際に、式の値としてありうるものの最大値を求めるプログラムを作ることです。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ A_1 $ $ op_1 $ $ A_2 $ $ ... $ $ op_{N-1} $ $ A_N $

## 输出格式

括弧をいくつか挿入してできる式の値としてありうるものの最大値を出力せよ。

## 说明/提示

### 制約

- $ 1≦N≦10^5 $
- $ 1≦A_i≦10^9 $
- $ op_i $ は、`+` または `-` の記号である。

### Sample Explanation 1

$ 5\ -\ (1\ -\ 3)\ =\ 7 $ となり、これが最大なので、$ 7 $ を出力します。

### Sample Explanation 2

$ 1\ -\ (2\ +\ 3\ -\ 4)\ +\ 5\ =\ 5 $ となり、これが最大なので、$ 5 $ を出力します。

### Sample Explanation 3

$ 1\ -\ (20\ -\ (13\ +\ 14)\ -\ 5)\ =\ 13 $ となり、これが最大なので、$ 13 $ を出力します。

## 样例 #1

### 输入

```
3

5 - 1 - 3
```

### 输出

```
7
```

## 样例 #2

### 输入

```
5

1 - 2 + 3 - 4 + 5
```

### 输出

```
5
```

## 样例 #3

### 输入

```
5

1 - 20 - 13 + 14 - 5
```

### 输出

```
13
```



---

---
title: "[ARC067F] Yakiniku Restaurants"
layout: "post"
diff: 省选/NOI-
pid: AT_arc067_d
tag: []
---

# [ARC067F] Yakiniku Restaurants

## 题目描述

有编号从 $ 1 $ 到 $ N $ 的 $ N $ 家烧烤店，烧烤店在一条线上按照编号顺序排序，第 $ i $ 家烧烤店与第 $ i + 1 $ 家烧烤店的距离是 $ A_i $ 。   
你有编号从 $ 1 $ 到 $ M $ 的 $ M $ 张烧烤券，不管是在哪一家烧烤店都可用烧烤券来吃烧烤，在第 $ i $ 家烧烤店用烧烤券 $ j $ 可以吃到一顿美味度为 $ B_{i,j} $ 的烧烤，每一张烧烤券只能使用一次，但是在一家烧烤店你可以使用任意多张烧烤券。  
你想从自己选择的一家烧烤店开始（随意选择一个开始），然后不断地用未使用的烧烤券去另一家烧烤店。你最终的幸福值是所吃所有烧烤的美味度减去所走的总路程。求最大可能的最终幸福值（ $ M $ 张券必须用完）。

## 输入格式

第一行两个整数 $ N $ , $ M $ ;
第二行有 $ N - 1 $ 个整数， $ A_1 , A_2 , ... , A_{n-1} $ ；
接下来的 $ N $ 行，每行 $ M $ 个整数，第 $ i $ 行第 $ j $ 列的整数是 $ B_{i,j} $ ；

## 说明/提示

输入的数字都是整数
$ 2 \leq N \leq 5 \times 10^3 $
$ 1 \leq M \leq 200 $
$ 1 \leq A_i \leq 10^9 $
$ 1 \leq B_{i,j} \leq 10^9 $
样例解释：
样例1：
在第一家烧烤店开始，使用第1张和第3张券，然后去第二家烧烤店，使用第2张和第4张券。

## 样例 #1

### 输入

```
3 4

1 4

2 2 5 1

1 3 3 2

2 2 5 1
```

### 输出

```
11
```

## 样例 #2

### 输入

```
5 3

1 2 3 4

10 1 1

1 1 1

1 10 1

1 1 1

1 1 10
```

### 输出

```
20
```



---

---
title: "[ARC068E] Snuke Line"
layout: "post"
diff: 省选/NOI-
pid: AT_arc068_c
tag: []
---

# [ARC068E] Snuke Line

## 题目描述

[problemUrl]: https://atcoder.jp/contests/arc068/tasks/arc068_c

すぬけくんは鉄道会社を運営するゲームで遊ぶことにしました。すぬけ鉄道には $ M+1 $ 個の駅があり、 $ 0 $ から $ M $ までの番号がついています。 すぬけ鉄道の列車は駅 $ 0 $ から $ d $ 駅ごとに停車します。 例えば $ d\ =\ 3 $ のとき駅 $ 0 $,駅 $ 3 $,駅 $ 6 $,駅 $ 9 $, $ ... $ に停車します。

すぬけ鉄道が走っている地域には $ N $ 種類の名産品があり、種類 $ i $ の名産品は 駅 $ l_i $,駅 $ l_i+1 $,駅 $ l_i+2 $, $ ... $, 駅 $ r_i $ のいずれかに列車が停車したとき購入することが可能です。

列車が停車する間隔 $ d $ は $ 1,\ 2,\ 3,\ ...,\ M $ の $ M $ 種類が存在しています。 $ M $ 種類の列車それぞれについて、その列車に駅 $ 0 $ で乗車した場合に購入可能な名産品の種類数を求めなさい。 なお、列車から別の列車への乗り換えは許されないものとします。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ M $ $ l_1 $ $ r_1 $ $ : $ $ l_{N} $ $ r_{N} $

## 输出格式

答えを $ M $ 行に出力せよ。 $ i $ 行目では $ i $ 駅ごとに停車する列車に乗った場合に購入可能な名産品の種類数を出力せよ。

## 说明/提示

### 制約

- $ 1\ ≦\ N\ ≦\ 3\ ×\ 10^{5} $
- $ 1\ ≦\ M\ ≦\ 10^{5} $
- $ 1\ ≦\ l_i\ ≦\ r_i\ ≦\ M $

### Sample Explanation 1

\- $ 1 $ 駅ごとに停車する列車に乗った場合、種類 $ 1,2,3 $ の $ 3 $ 種類の名産品を購入することが可能です。 - $ 2 $ 駅ごとに停車する列車に乗った場合、種類 $ 1,2 $ の $ 2 $ 種類の名産品を購入することが可能です。 - $ 3 $ 駅ごとに停車する列車に乗った場合、種類 $ 2,3 $ の $ 2 $ 種類の名産品を購入することが可能です。

## 样例 #1

### 输入

```
3 3

1 2

2 3

3 3
```

### 输出

```
3

2

2
```

## 样例 #2

### 输入

```
7 9

1 7

5 9

5 7

5 9

1 1

6 8

3 4
```

### 输出

```
7

6

6

5

4

5

5

3

2
```



---

---
title: "[ARC070E] NarrowRectangles"
layout: "post"
diff: 省选/NOI-
pid: AT_arc070_c
tag: []
---

# [ARC070E] NarrowRectangles

## 题目描述

[problemUrl]: https://atcoder.jp/contests/arc070/tasks/arc070_c

シカのAtCoDeerくんは縦の長さが $ 1 $ の細長い長方形が $ N $ 個机に置いてあるのを見つけました。 机を二次元平面とみなすと、以下の図のように、$ i(1≦i≦N) $ 個目の長方形は、縦は $ [i-1,i] $ の範囲を、横は $ [l_i,r_i] $ の範囲を占めています。

![](https://cdn.luogu.com.cn/upload/vjudge_pic/AT_arc070_c/48c83ba23abe08ae2a1cfd9ab3b077e4e13af8a7.png)

AtCoDeerくんはこの長方形をそれぞれ横に動かすことで、全ての長方形を連結にしようと考えました。 各長方形は横に距離 $ x $ 動かすのに $ x $ のコストがかかります。 全ての長方形を連結にするのに必要なコストの最小値を求めてください。 問題の制約のもとでこの値は整数になることが証明できます。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ l_1 $ $ r_1 $ $ l_2 $ $ r_2 $ : $ l_N $ $ r_N $

## 输出格式

必要なコストの最小値を出力せよ。

## 说明/提示

### 制約

- 入力は全て整数である。
- $ 1≦N≦10^5 $
- $ 1≦l_i\ <\ r_i≦10^9 $

### 部分点

- $ 1≦N≦400 $, $ 1≦l_i\ <\ r_i≦400 $ を満たすデータセットに正解した場合は、部分点として $ 300 $ 点が与えられる。

### Sample Explanation 1

$ 2 $ 個目の長方形を左に $ 2 $ 動かすのが最小です。

### Sample Explanation 2

はじめから連結になっているため、動かす必要はありません。

## 样例 #1

### 输入

```
3

1 3

5 7

1 3
```

### 输出

```
2
```

## 样例 #2

### 输入

```
3

2 5

4 6

1 4
```

### 输出

```
0
```

## 样例 #3

### 输入

```
5

999999999 1000000000

1 2

314 315

500000 500001

999999999 1000000000
```

### 输出

```
1999999680
```

## 样例 #4

### 输入

```
5

123456 789012

123 456

12 345678901

123456 789012

1 23
```

### 输出

```
246433
```

## 样例 #5

### 输入

```
1

1 400
```

### 输出

```
0
```



---

---
title: "[ARC072E] Alice in linear land"
layout: "post"
diff: 省选/NOI-
pid: AT_arc072_c
tag: []
---

# [ARC072E] Alice in linear land

## 题目描述

[problemUrl]: https://atcoder.jp/contests/arc072/tasks/arc072_c

Aliceは数直線の上に住んでいます。今日はある不思議な乗り物に乗って目的地まで行くことを考えました。 はじめ、Aliceは目的地から $ D $ 離れたところにいます。Aliceが乗り物にある数 $ x $ を入力すると、現在地から目的地に向かって $ x $ 進んだところが現在地より目的地に近いとき移動し、そうでないときは動きません。現在地から目的地までの距離が $ x $ 未満のとき、$ x $ 進んだところは目的地を通りすぎていることに注意してください。また、目的地を通り過ぎると進行方向が変わること、進行方向は何度も変わることがあることに注意してください。

Aliceは乗り物に $ N $ 回だけ数を入力し、$ i $ 番目に入力する数は $ d_i $ の予定でした。Aliceは入力する予定数の書かれたリストを作っておき、その数を $ 1 $ つずつ入力します。

しかしイタズラ好きの魔法使いが現れ、Aliceが $ N $ 回の入力による移動を終えても目的地にたどり着かないよう、リストの数を $ 1 $ つだけ書き換えることを考えました。

魔法使いはイタズラの実行のため以下の $ Q $ 個の計画を考えています。

- $ q_i $ 回目に入力する数のみをある正整数に変更することで、Aliceが目的地にたどり着かないようにする

$ Q $ 個の計画それぞれが実行可能であるか答えるプログラムを書いてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ D $ $ d_1 $ $ d_2 $ $ ... $ $ d_N $ $ Q $ $ q_1 $ $ q_2 $ $ ... $ $ q_Q $

## 输出格式

$ i $ 番目の計画が実行可能なら`YES`、そうでないなら`NO`と $ i $ 行目に出力せよ。

## 说明/提示

### 制約

- $ 1≦\ N\ ≦\ 5*10^5 $
- $ 1≦\ Q\ ≦\ 5*10^5 $
- $ 1≦\ D\ ≦\ 10^9 $
- $ 1≦\ d_i\ ≦\ 10^9(1≦i≦N) $
- $ 1≦\ q_i\ ≦\ N(1≦i≦Q) $
- $ d_i,\ D $は整数である

### Sample Explanation 1

$ 3 $ 番目までの入力でAliceはすでに目的地にたどり着いているため、$ 1 $ 番目の計画の答えは`NO`です。 例えば、$ 3 $ 番目の入力を $ 5 $ にすると、Aliceは以下のような移動をし、目的地にたどり着くことはできないため、$ 2 $ 番目の計画の答えは`YES`です。 !\[\](https://atcoder.jp/img/arc072/f6a4307ef86847bc8fa68d0952f7127c.png)

### Sample Explanation 2

もともと入力する予定のままでもAliceは目的地にたどり着けないため、すべての計画は実行可能です。

## 样例 #1

### 输入

```
4 10

3 4 3 3

2

4 3
```

### 输出

```
NO

YES
```

## 样例 #2

### 输入

```
5 9

4 4 2 3 2

5

1 4 2 3 5
```

### 输出

```
YES

YES

YES

YES

YES
```

## 样例 #3

### 输入

```
6 15

4 3 5 4 2 1

6

1 2 3 4 5 6
```

### 输出

```
NO

NO

YES

NO

NO

YES
```



---

---
title: "[ARC073E] Ball Coloring"
layout: "post"
diff: 省选/NOI-
pid: AT_arc073_c
tag: []
---

# [ARC073E] Ball Coloring

## 题目描述

[problemUrl]: https://atcoder.jp/contests/arc073/tasks/arc073_c

$ 2 $ 個の白いボールが入った袋が $ N $ 個あります。$ i $ 個目の袋にはそれぞれ整数 $ x_i $ と $ y_i $ が書かれたボールが $ 1 $ 個ずつ入っています。

あなたはこの袋それぞれについて、片方のボールを赤く塗り、もう片方を青く塗ります。

そのあと $ 2N $ 個のボールを、塗られた色で分類します。

そして

- 赤く塗られたボールに書かれた整数の最大値を $ R_{max} $
- 赤く塗られたボールに書かれた整数の最小値を $ R_{min} $
- 青く塗られたボールに書かれた整数の最大値を $ B_{max} $
- 青く塗られたボールに書かれた整数の最小値を $ B_{min} $

としたときに、$ (R_{max}\ -\ R_{min})\ \times\ (B_{max}\ -\ B_{min}) $ の最小値を求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ x_1 $ $ y_1 $ $ x_2 $ $ y_2 $ : $ x_N $ $ y_N $

## 输出格式

問題の答えを出力する。

## 说明/提示

### 制約

- $ 1\ ≦\ N\ ≦\ 200,000 $
- $ 1\ ≦\ x_i,\ y_i\ ≦\ 10^9 $

### Sample Explanation 1

$ x_1 $, $ x_2 $, $ y_3 $ の書かれたボールを赤色に塗り、 $ y_1 $, $ y_2 $, $ x_3 $ の書かれたボールを青色に塗ると最適解になります。

## 样例 #1

### 输入

```
3

1 2

3 4

5 6
```

### 输出

```
15
```

## 样例 #2

### 输入

```
3

1010 10

1000 1

20 1020
```

### 输出

```
380
```

## 样例 #3

### 输入

```
2

1 1

1000000000 1000000000
```

### 输出

```
999999998000000001
```



---

---
title: "[ARC074E] RGB Sequence"
layout: "post"
diff: 省选/NOI-
pid: AT_arc074_c
tag: []
---

# [ARC074E] RGB Sequence

## 题目描述

[problemUrl]: https://atcoder.jp/contests/arc074/tasks/arc074_c

$ N $ 個のマスが横一列に並んでいます。 マスには左から順に $ 1 $, $ 2 $, $ ... $, $ N $ と番号が振られています。

すぬけ君は、各マスを 赤 / 緑 / 青 のどれかの色で塗ろうとしています。 すぬけ君の美的感覚によると、次の $ M $ 個の条件がすべて成り立つ必要があるそうです。 $ i $ 番目の条件は次のようなものです。

- マス $ l_i $, $ l_i\ +\ 1 $, $ ... $, $ r_i $ の色の種類数がちょうど $ x_i $ である。

条件がすべて成り立つようなマスの配色は何通りでしょうか？ $ 10^9+7 $ で割った余りを求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ M $ $ l_1 $ $ r_1 $ $ x_1 $ $ l_2 $ $ r_2 $ $ x_2 $ $ : $ $ l_M $ $ r_M $ $ x_M $

## 输出格式

条件がすべて成り立つようなマスの配色は何通りか？ $ 10^9+7 $ で割った余りを出力せよ。

## 说明/提示

### 制約

- $ 1\ <\ =\ N\ <\ =\ 300 $
- $ 1\ <\ =\ M\ <\ =\ 300 $
- $ 1\ <\ =\ l_i\ <\ =\ r_i\ <\ =\ N $
- $ 1\ <\ =\ x_i\ <\ =\ 3 $

### Sample Explanation 1

次の $ 6 $ 通りです。 - RGB - RBG - GRB - GBR - BRG - BGR ただし、R / G / B はそれぞれ 赤 / 緑 / 青 のマスを表します。

### Sample Explanation 2

次の $ 6 $ 通りです。 - RRRG - RRRB - GGGR - GGGB - BBBR - BBBG

### Sample Explanation 3

次の $ 0 $ 通りです。

## 样例 #1

### 输入

```
3 1

1 3 3
```

### 输出

```
6
```

## 样例 #2

### 输入

```
4 2

1 3 1

2 4 2
```

### 输出

```
6
```

## 样例 #3

### 输入

```
1 3

1 1 1

1 1 2

1 1 3
```

### 输出

```
0
```

## 样例 #4

### 输入

```
8 10

2 6 2

5 5 1

3 5 2

4 7 3

4 4 1

2 3 1

7 7 1

1 5 2

1 7 3

3 4 2
```

### 输出

```
108
```



---

---
title: "[ARC074F] Lotus Leaves"
layout: "post"
diff: 省选/NOI-
pid: AT_arc074_d
tag: []
---

# [ARC074F] Lotus Leaves

## 题目描述

[problemUrl]: https://atcoder.jp/contests/arc074/tasks/arc074_d

長方形の池があります。 池は縦 $ H $ 行、横 $ W $ 列のマス目状に分割されています。 上から $ i $ 行目、左から $ j $ 列目のマスを $ (i,\ j) $ と表します。

池のいくつかのマスには蓮 (はす) の葉が浮かんでいます。 ある葉 $ S $ にはカエルが乗っており、別の葉 $ T $ まで移動しようとしています。 マス $ (i,\ j) $ の情報は、文字 $ a_{ij} $ によって次のように表されます。

- `.` : 葉が浮かんでいないマスである。
- `o` : 葉が浮かんでいるマスである。
- `S` : 葉 $ S $ が浮かんでいるマスである。
- `T` : 葉 $ T $ が浮かんでいるマスである。

カエルは「今乗っている葉と同じ行または同じ列に浮かんでいる葉へジャンプする」ことを繰り返し行い、葉 $ T $ まで移動しようとしています。

すぬけ君の目標は、あらかじめ葉 $ S $, $ T $ 以外の葉を何枚か取り除いておくことで、カエルが葉 $ T $ まで移動できないようにすることです。 この目標が達成可能か判定し、可能ならば取り除く葉の枚数の最小値を求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ H $ $ W $ $ a_{11} $ $ ... $ $ a_{1W} $ $ : $ $ a_{H1} $ $ ... $ $ a_{HW} $

## 输出格式

目標が達成可能ならば、取り除く葉の枚数の最小値を出力せよ。 そうでなければ、代わりに `-1` を出力せよ。

## 说明/提示

### 制約

- $ 2\ <\ =\ H,\ W\ <\ =\ 100 $
- $ a_{ij} $ は `.`, `o`, `S`, `T` のどれかである。
- $ a_{ij} $ のうち `S` はちょうど $ 1 $ 個存在する。
- $ a_{ij} $ のうち `T` はちょうど $ 1 $ 個存在する。

### Sample Explanation 1

右上と左下の葉を取り除けばよいです。

## 样例 #1

### 输入

```
3 3

S.o

.o.

o.T
```

### 输出

```
2
```

## 样例 #2

### 输入

```
3 4

S...

.oo.

...T
```

### 输出

```
0
```

## 样例 #3

### 输入

```
4 3

.S.

.o.

.o.

.T.
```

### 输出

```
-1
```

## 样例 #4

### 输入

```
10 10

.o...o..o.

....o.....

....oo.oo.

..oooo..o.

....oo....

..o..o....

o..o....So

o....T....

....o.....

........oo
```

### 输出

```
5
```



---

---
title: "[ARC078F] Mole and Abandoned Mine"
layout: "post"
diff: 省选/NOI-
pid: AT_arc078_d
tag: []
---

# [ARC078F] Mole and Abandoned Mine

## 题目描述

[problemUrl]: https://atcoder.jp/contests/arc078/tasks/arc078_d

モグラは $ 1 $ から $ N $ の番号がついた $ N $ 個の頂点と $ M $ 本の辺からなる単純連結無向グラフで表されるような廃坑に住むことにしました。 $ i $ 番目の辺は頂点 $ a_i $ と $ b_i $ をつないでおり、取り除くために $ c_i $ 円かかります。

モグラはいくつかの辺を取り除いて、頂点 $ 1 $ から頂点 $ N $ へ同じ頂点を $ 2 $ 回以上訪れないように移動する経路がただ $ 1 $ 通りのみ存在するようにしたいです。これを達成するために必要な資金の最小値を求めなさい。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ M $ $ a_1 $ $ b_1 $ $ c_1 $ $ : $ $ a_M $ $ b_M $ $ c_M $

## 输出格式

答えを出力せよ。

## 说明/提示

### 制約

- $ 2\ \leq\ N\ \leq\ 15 $
- $ N-1\ \leq\ M\ \leq\ N(N-1)/2 $
- $ 1\ \leq\ a_i,\ b_i\ \leq\ N $
- $ 1\ \leq\ c_i\ \leq\ 10^{6} $
- 与えられるグラフに多重辺や自己ループは存在しない
- 与えられるグラフは連結

### Sample Explanation 1

以下の図において、赤い破線で表されている辺は取り除かれた辺です。以下の図のように $ 2 $ つの辺を取り除くことで $ 200 $ 円で達成することが可能です。 !\[45c15676bb602ca3b762561fc014ecd0.png\](https://atcoder.jp/img/arc078/45c15676bb602ca3b762561fc014ecd0.png)

### Sample Explanation 2

はじめから、頂点 $ 1 $ から頂点 $ N $ へのパスが $ 1 $ 通りしかないこともあります。

## 样例 #1

### 输入

```
4 6

1 2 100

3 1 100

2 4 100

4 3 100

1 4 100

3 2 100
```

### 输出

```
200
```

## 样例 #2

### 输入

```
2 1

1 2 1
```

### 输出

```
0
```

## 样例 #3

### 输入

```
15 22

8 13 33418

14 15 55849

7 10 15207

4 6 64328

6 9 86902

15 7 46978

8 14 53526

1 2 8720

14 12 37748

8 3 61543

6 5 32425

4 11 20932

3 12 55123

8 2 45333

9 12 77796

3 9 71922

12 15 70793

2 4 25485

11 6 1436

2 7 81563

7 11 97843

3 1 40491
```

### 输出

```
133677
```



---

---
title: "[ARC079F] Namori Grundy"
layout: "post"
diff: 省选/NOI-
pid: AT_arc079_d
tag: []
---

# [ARC079F] Namori Grundy

## 题目描述

高桥君有一个$N$个点$N$条边的有向图，点的的编号从$1$到$N$

高桥君的图有$N$条边，形如：$(p_1,1),(p_2,2),...,(p_N,N)$，保证图是弱连通的。其中，$(u,v)$表示一条从点$u$到$v$的单向边。“弱连通”是指：假如所有的边都是双向边，则图是连通图

高桥君为每个点设置了一个权值，$a_i$表示点$i$的权值。他希望图满足如下性质：

所有$a_i$都是非负整数

对于每条边$(i,j)$，满足$a_i≠a_j$

对于所有$i,x(0\le x\lt a_i)$，存在一条边$(i,j)$满足$x=a_j$

请你帮高桥君判断一下，这样图是否存在呢？

## 输入格式

$N$

$p_1$ $p_2$ $p_3$ $...$ $p_N$

## 输出格式

如果存在这样的图，输出```POSSIBLE```

否则输出```IMPOSSIBLE```

## 说明/提示

$2 \leq N \leq 200000$

$1 \leq p_i \leq N$

$p_i \ne i$

保证给定的图是弱联通的

## 样例 #1

### 输入

```
4

2 3 4 1
```

### 输出

```
POSSIBLE
```

## 样例 #2

### 输入

```
3

2 3 1
```

### 输出

```
IMPOSSIBLE
```

## 样例 #3

### 输入

```
4

2 3 1 1
```

### 输出

```
POSSIBLE
```

## 样例 #4

### 输入

```
6

4 5 6 5 6 4
```

### 输出

```
IMPOSSIBLE
```



---

---
title: "[ARC081F] Flip and Rectangles"
layout: "post"
diff: 省选/NOI-
pid: AT_arc081_d
tag: []
---

# [ARC081F] Flip and Rectangles

## 题目描述

[problemUrl]: https://atcoder.jp/contests/arc081/tasks/arc081_d

$ H\ \times\ W $ のマス目があります． マス目の各マスは黒か白かに塗られており，上から $ i $ 番目，左から $ j $ 番目のマスは，$ S_i $ の $ j $ 文字目が `#` のとき黒マス，`.` のとき白マスです．

すぬけ君は，マス目に対して次の操作を好きな回数行うことができます．

- マス目の任意の行または列を選び，その行または列のすべてのマスの色を反転する (すなわち，黒で塗られたマスを白に，白で塗られたマスを黒に塗り替える)．

操作の後，すぬけ君はマス目に沿った長方形を $ 1 $ 個選びます．このとき，選んだ長方形に含まれるすべてのマスは黒で塗られていなければなりません．

うまく操作を行うとき，すぬけ君が選ぶことができる最大の長方形の面積を求めてください．

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ H $ $ W $ $ S_1 $ $ S_2 $ $ : $ $ S_H $

## 输出格式

すぬけ君が選ぶことができる最大の長方形の面積を出力せよ．

## 说明/提示

### 制約

- $ 2\ \leq\ H\ \leq\ 2000 $
- $ 2\ \leq\ W\ \leq\ 2000 $
- $ |S_i|\ =\ W $
- $ S_i $ は `#`, `.` のみからなる．

### Sample Explanation 1

下図のように，上から $ 1 $ 行目，左から $ 3 $ 列目を反転させると，$ 2\ \times\ 3 $ の長方形を選ぶことができます． !\[\](https://atcoder.jp/img/arc081/2995c3921ed4dffc8ee528b63b9c6118.png)

## 样例 #1

### 输入

```
3 3

..#

##.

.#.
```

### 输出

```
6
```

## 样例 #2

### 输入

```
4 4

....

....

....

....
```

### 输出

```
16
```

## 样例 #3

### 输入

```
10 8

##...#.#

##...#.#

..###.#.

#.##.#.#

.#..#.#.

..##.#.#

##.#.#..

...#.#..

###.#.##

###..###
```

### 输出

```
27
```



---

---
title: "[ARC082E] ConvexScore"
layout: "post"
diff: 省选/NOI-
pid: AT_arc082_c
tag: []
---

# [ARC082E] ConvexScore

## 题目描述

[problemUrl]: https://atcoder.jp/contests/arc082/tasks/arc082_c

二次元平面上に配置された $ N $ 個の点 $ (x_i,y_i) $ が与えられます。 $ N $ 点の部分集合 $ S $ であって、凸多角形をなすものを考えます。 ここで点集合$ S $が凸多角形をなすとは、 頂点の集合が $ S $ と一致するような正の面積の凸多角形が存在することとします。ただし、凸多角形の内角は全て $ 180° $ 未満である必要があります。

例えば下図では、$ S $ として {$ A,C,E $}, {$ B,D,E $} などは認められますが、{$ A,C,D,E $}, {$ A,B,C,E $}, {$ A,B,C $}, {$ D,E $}, {} などは認められません。

 ![cddb0c267926c2add885ca153c47ad8a.png](https://cdn.luogu.com.cn/upload/vjudge_pic/AT_arc082_c/39667580a7bb2e28230ac88d6c9a69f608395d83.png)

$ S $ に対し、$ N $ 個の点のうち $ S $ の凸包の内部と境界 (頂点も含む) に含まれる点の個数を $ n $ とおき、 $ S $ のスコアを、$ 2^{n-|S|} $ と定義します。

凸多角形をなすような考えうる全ての $ S $ に対してスコアを計算し、これらを足し合わせたものを求めてください。

ただし答えはとても大きくなりうるので、$ 998244353 $ で割った余りをかわりに求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ x_1 $ $ y_1 $ $ x_2 $ $ y_2 $ $ : $ $ x_N $ $ y_N $

## 输出格式

スコアの総和を $ 998244353 $ で割った余りを出力せよ。

## 说明/提示

### 制約

- $ 1\ <\ =N\ <\ =200 $
- $ 0\ <\ =x_i,y_i\ <\ 10^4\ (1\ <\ =i\ <\ =N) $
- $ i≠j $ なら $ x_i≠x_j $ または $ y_i≠y_j $
- $ x_i,y_i $ は整数

### Sample Explanation 1

$ S $ として三角形（をなす点集合）が $ 4 $ つと四角形が $ 1 $ つとれます。どれもスコアは $ 2^0=1 $ となるので、答えは $ 5 $ です。

### Sample Explanation 2

スコア $ 1 $ の三角形が $ 3 $ つ、スコア $ 2 $ の三角形が$ 2 $つ、スコア $ 4 $ の三角形が $ 1 $ つあるので、答えは $ 11 $ です。

### Sample Explanation 3

$ S $ として考えられるものがないので、答えは $ 0 $ です。

## 样例 #1

### 输入

```
4

0 0

0 1

1 0

1 1
```

### 输出

```
5
```

## 样例 #2

### 输入

```
5

0 0

0 1

0 2

0 3

1 1
```

### 输出

```
11
```

## 样例 #3

### 输入

```
1

3141 2718
```

### 输出

```
0
```



---

---
title: "[ARC085E] MUL"
layout: "post"
diff: 省选/NOI-
pid: AT_arc085_c
tag: []
---

# [ARC085E] MUL

## 题目描述

有 $N$ 个宝石，编号为 $1, 2, .., N$

你可以进行任意次以下操作（可以一次也不做）

- 选择一个正整数 $x$，将所有编号为 $x$ 的倍数的宝石打碎

最后，对于每个没有被打碎的宝石 $i$，你可以获得 $a_i$ 円。要注意的是，有些 $a_i$ 是负值，这意味着你要倒贴钱。

在最好的情况下，你能获得多少円呢？

## 输入格式

第一行一个整数 $N$，代表共有 $N$ 个宝石

第二行 $N$ 个整数，分别代表 $a_1, a_2, ..., a_N$

## 输出格式

一行一个整数，表示你最多可以得到的钱

翻译提供者：魔塔哈奇

## 说明/提示

所有输入的数都是整数

$1 \leq N \leq 100$

$ |a_i| \leq 10^9$

## 样例 #1

### 输入

```
6

1 2 -6 4 5 3
```

### 输出

```
12
```

## 样例 #2

### 输入

```
6

100 -100 -100 -100 100 -100
```

### 输出

```
200
```

## 样例 #3

### 输入

```
5

-1 -2 -3 -4 -5
```

### 输出

```
0
```

## 样例 #4

### 输入

```
2

-1000 100000
```

### 输出

```
99000
```



---

---
title: "[ARC085F] NRE"
layout: "post"
diff: 省选/NOI-
pid: AT_arc085_d
tag: []
---

# [ARC085F] NRE

## 题目描述

个全为0的数组a，给一个数组b和q个操作，每个操作将数组a指定区间改成1，问合理选择部分操作后使得两个数组的∑ ai≠bi 最小。

## 输入格式

$ N $   
 $ b_1 $   $ b_2 $   $ ... $   $ b_N $   
 $ Q $   
 $ l_1 $   $ r_1 $   
 $ l_2 $   $ r_2 $   
 $ : $   
 $ l_Q $   $ r_Q $

## 输出格式

即为最小的∑ ai≠bi

## 样例 #1

### 输入

```
3

1 0 1

1

1 3
```

### 输出

```
1
```

## 样例 #2

### 输入

```
3

1 0 1

2

1 1

3 3
```

### 输出

```
0
```

## 样例 #3

### 输入

```
3

1 0 1

2

1 1

2 3
```

### 输出

```
1
```

## 样例 #4

### 输入

```
5

0 1 0 1 0

1

1 5
```

### 输出

```
2
```

## 样例 #5

### 输入

```
9

0 1 0 1 1 1 0 1 0

3

1 4

5 8

6 7
```

### 输出

```
3
```

## 样例 #6

### 输入

```
15

1 1 0 0 0 0 0 0 1 0 1 1 1 0 0

9

4 10

13 14

1 7

4 14

9 11

2 6

7 8

3 12

7 13
```

### 输出

```
5
```

## 样例 #7

### 输入

```
10

0 0 0 1 0 0 1 1 1 0

7

1 4

2 5

1 3

6 7

9 9

1 5

7 9
```

### 输出

```
1
```



---

---
title: "[ARC089E] GraphXY"
layout: "post"
diff: 省选/NOI-
pid: AT_arc089_c
tag: []
---

# [ARC089E] GraphXY

## 题目描述

给出一个$A \times B$的矩阵，其中第$i$行第$j$列元素为$d_{i,j}$。试构造一个有向图，满足：

1、有向图点数$\leq 300$；

2、图中没有自环和重边；

3、图中边有边权，边权为 $[0,100]$ 中的整数，或者是未知数`X`或`Y`；

4、对于所有$x \in [1,A] , y \in[1,B]$，满足当未知数$X = x$，$Y = y$时，图中$S$到$T$的最短路为$d_{x,y}$。

## 输入格式

第一行两个正整数$A,B(1 \leq A , B \leq 10)$

接下来一个$A \times B$的矩阵描述$d$。保证对于$\forall i \in [1,A] , j \in [1,B] , d_{i,j} \in [1,100]$

## 输出格式

如果不存在满足条件的有向图，输出一行`Impossible`

否则第一行输出`Possible`，第二行输出有向图的点数$n$和边数$m$，接下来$m$行每行输出$u,v,x$描述一条从$u$到$v$、边权为$x$的有向边，最后一行两个正整数$S,T$。

## 样例 #1

### 输入

```
2 3

1 2 2

1 2 3
```

### 输出

```
Possible

3 4

1 2 X

2 3 1

3 2 Y

1 3 Y

1 3
```

## 样例 #2

### 输入

```
1 3

100 50 1
```

### 输出

```
Impossible
```



---

---
title: "[ARC090F] Number of Digits"
layout: "post"
diff: 省选/NOI-
pid: AT_arc090_d
tag: []
---

# [ARC090F] Number of Digits

## 题目描述

[problemUrl]: https://atcoder.jp/contests/arc090/tasks/arc090_d

正の整数 $ n $ に対し、$ f(n) $ を $ n $ の $ 10 $ 進法での桁数と定めます。

整数 $ S $ が与えられます。 正の整数の組 $ (l,\ r) $ ($ l\ \leq\ r $) であって、$ f(l)\ +\ f(l\ +\ 1)\ +\ ...\ +\ f(r)\ =\ S $ を満たすものの個数を $ 10^9\ +\ 7 $ で割ったあまりを求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ S $

## 输出格式

答えを出力せよ。

## 说明/提示

### 制約

- $ 1\ \leq\ S\ \leq\ 10^8 $

### Sample Explanation 1

条件を満たす $ (l,\ r) $ の組は $ (1,\ 1) $, $ (2,\ 2) $, $ ... $, $ (9,\ 9) $ の $ 9 $ 個あります。

### Sample Explanation 2

条件を満たす $ (l,\ r) $ の組は $ (1,\ 2) $ や $ (33,\ 33) $ など $ 98 $ 個あります。

## 样例 #1

### 输入

```
1
```

### 输出

```
9
```

## 样例 #2

### 输入

```
2
```

### 输出

```
98
```

## 样例 #3

### 输入

```
123
```

### 输出

```
460191684
```

## 样例 #4

### 输入

```
36018
```

### 输出

```
966522825
```

## 样例 #5

### 输入

```
1000
```

### 输出

```
184984484
```



---

---
title: "[ARC091F] Strange Nim"
layout: "post"
diff: 省选/NOI-
pid: AT_arc091_d
tag: []
---

# [ARC091F] Strange Nim

## 题目描述

[problemUrl]: https://atcoder.jp/contests/arc091/tasks/arc091_d

高橋君と青木君は、石取りゲームをしています。最初、山が $ N $ 個あり、$ i $ 個目の山には $ A_i $ 個の石があり、整数 $ K_i $ が定まっています。

高橋君と青木君は、高橋君から始めて、交互に以下の操作を繰り返します。

- 山を $ 1 $ つ選ぶ。$ i $ 個目の山を選び、その山に $ X $ 個の石が残っている場合、$ 1 $ 個以上 $ floor(X/K_i) $ 個以下の任意の個数の石を $ i $ 個目の山から取り除く。

先に操作ができなくなったプレイヤーが負けです。両者最善を尽くしたとき、どちらのプレイヤーが勝つか判定してください。 ただし、$ floor(x) $ で $ x $ 以下の最大の整数を表します。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ A_1 $ $ K_1 $ $ : $ $ A_N $ $ K_N $

## 输出格式

高橋君が勝つなら `Takahashi` を、青木君が勝つなら `Aoki` を出力せよ。

## 说明/提示

### 制約

- $ 1\ \leq\ N\ \leq\ 200 $
- $ 1\ \leq\ A_i,K_i\ \leq\ 10^9 $
- 入力はすべて整数である

### Sample Explanation 1

最初、$ 1 $ 個目の山からは $ floor(5/2)=2 $ 個まで、$ 2 $ 個目の山からは $ floor(3/3)=1 $ 個までの石を一度に取り除くことができます。 - 高橋君が最初に $ 1 $ 個目の山から $ 2 $ 個の石を取ると、$ 1 $ 個目の山からは $ floor(3/2)=1 $ 個まで、$ 2 $ 個目の山からは $ floor(3/3)=1 $ 個までの石を一度に取り除くことができるようになります。 - 次に、青木君が $ 2 $ 個目の山から $ 1 $ 個の石を取ると、$ 1 $ 個目の山からは $ floor(3/2)=1 $ 個までの石を取り除くことができ、$ 2 $ 個目の山からは ($ floor(2/3)=0 $ より) 石を取り除くことができなくなります。 - 次に、高橋君が $ 1 $ 個目の山から $ 1 $ 個の石を取ると、$ 1 $ 個目の山からは $ floor(2/2)=1 $ 個までの石を一度に取り除くことができるようになります。$ 2 $ 個目の山からは石を取り除くことはできません。 - 次に、青木君が $ 1 $ 個目の山から $ 1 $ 個の石を取ると、$ 1 $ 個目の山からは $ floor(1/2)=0 $ 個までの石を一度に取り除くことができるようになります。$ 2 $ 個目の山からは石を取り除くことはできません。 これ以上の操作はできないため、青木君の勝ちです。高橋君がそれ以外の行動をした場合も、青木君はうまく行動を選ぶことで勝つことができます。

## 样例 #1

### 输入

```
2

5 2

3 3
```

### 输出

```
Aoki
```

## 样例 #2

### 输入

```
3

3 2

4 3

5 1
```

### 输出

```
Takahashi
```

## 样例 #3

### 输入

```
3

28 3

16 4

19 2
```

### 输出

```
Aoki
```

## 样例 #4

### 输入

```
4

3141 59

26535 897

93 23

8462 64
```

### 输出

```
Takahashi
```



---

---
title: "[ARC092F] Two Faced Edges"
layout: "post"
diff: 省选/NOI-
pid: AT_arc092_d
tag: []
---

# [ARC092F] Two Faced Edges

## 题目描述

[problemUrl]: https://atcoder.jp/contests/arc092/tasks/arc092_d

$ N $ 頂点 $ M $ 辺の単純な有向グラフが与えられます。 頂点には $ 1,\ 2,\ ...,\ N $ の番号が，辺には $ 1,\ 2,\ ...,\ M $ の番号が付いています。 辺 $ i $ は頂点 $ a_i $ から頂点 $ b_i $ へ伸びています。

それぞれの辺について，もしその辺を反転させたらグラフの強連結成分の個数が変わるかどうかを求めてください。

なお，辺 $ i $ を反転させるとは，グラフから辺 $ i $ を削除し， 新たに頂点 $ b_i $ から頂点 $ a_i $ へ伸びる辺を追加する操作を意味します。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ M $ $ a_1 $ $ b_1 $ $ a_2 $ $ b_2 $ $ : $ $ a_M $ $ b_M $

## 输出格式

$ M $ 行出力せよ。$ i $ 行目には，辺 $ i $ を反転させたらグラフの強連結成分の個数が変わる場合 `diff`，変わらない場合 `same` と出力せよ。

## 说明/提示

### 制約

- $ 2\ \leq\ N\ \leq\ 1000 $
- $ 1\ \leq\ M\ \leq\ 200,000 $
- $ 1\ \leq\ a_i,\ b_i\ \leq\ N $
- $ a_i\ \neq\ b_i $
- $ i\ \neq\ j $ ならば $ a_i\ \neq\ a_j $ または $ b_i\ \neq\ b_j $

### Sample Explanation 1

辺を反転させない場合強連結成分の個数は $ 3 $ 個ですが，辺 $ 2 $ を反転させると強連結成分の個数は $ 1 $ 個になります。

### Sample Explanation 2

辺を反転させた結果，グラフに多重辺が生じる場合もあります。

## 样例 #1

### 输入

```
3 3

1 2

1 3

2 3
```

### 输出

```
same

diff

same
```

## 样例 #2

### 输入

```
2 2

1 2

2 1
```

### 输出

```
diff

diff
```

## 样例 #3

### 输入

```
5 9

3 2

3 1

4 1

4 2

3 5

5 3

3 4

1 2

2 5
```

### 输出

```
same

same

same

same

same

diff

diff

diff

diff
```



---

---
title: "[ARC093E] Bichrome Spanning Tree"
layout: "post"
diff: 省选/NOI-
pid: AT_arc093_c
tag: []
---

# [ARC093E] Bichrome Spanning Tree

## 题目描述

[problemUrl]: https://atcoder.jp/contests/arc093/tasks/arc093_c

$ N $ 頂点 $ M $ 辺からなる重み付き無向グラフがあります。 グラフの $ i $ 番目の辺は頂点 $ U_i $ と頂点 $ V_i $ を結んでおり、重みは $ W_i $ です。 さらに、整数 $ X $ が与えられます。

このグラフの各辺を白または黒に塗る方法であって、以下の条件を満たすものの個数を $ 10^9\ +\ 7 $ で割ったあまりを求めてください。

- 白く塗られた辺と黒く塗られた辺をともに含む全域木が存在する。さらに、そのような全域木のうち最も重みが小さいものの重みは $ X $ である。

ただし、全域木の重みとは、その全域木に含まれる辺の重みの和を表します。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ M $ $ X $ $ U_1 $ $ V_1 $ $ W_1 $ $ U_2 $ $ V_2 $ $ W_2 $ $ : $ $ U_M $ $ V_M $ $ W_M $

## 输出格式

答えを出力せよ。

## 说明/提示

### 制約

- $ 1\ \leq\ N\ \leq\ 1,000 $
- $ 1\ \leq\ M\ \leq\ 2,000 $
- $ 1\ \leq\ U_i,\ V_i\ \leq\ N $ ($ 1\ \leq\ i\ \leq\ M $)
- $ 1\ \leq\ W_i\ \leq\ 10^9 $ ($ 1\ \leq\ i\ \leq\ M $)
- $ i\ \neq\ j $ のとき、$ (U_i,\ V_i)\ \neq\ (U_j,\ V_j) $ かつ $ (U_i,\ V_i)\ \neq\ (V_j,\ U_j) $
- $ U_i\ \neq\ V_i $ ($ 1\ \leq\ i\ \leq\ M $)
- 与えられるグラフは連結である。
- $ 1\ \leq\ X\ \leq\ 10^{12} $
- 入力値はすべて整数である。

## 样例 #1

### 输入

```
3 3

2

1 2 1

2 3 1

3 1 1
```

### 输出

```
6
```

## 样例 #2

### 输入

```
3 3

3

1 2 1

2 3 1

3 1 2
```

### 输出

```
2
```

## 样例 #3

### 输入

```
5 4

1

1 2 3

1 3 3

2 4 6

2 5 8
```

### 输出

```
0
```

## 样例 #4

### 输入

```
8 10

49

4 6 10

8 4 11

5 8 9

1 8 10

3 8 128773450

7 8 10

4 2 4

3 4 1

3 1 13

5 2 2
```

### 输出

```
4
```



---

---
title: "[ARC095E] Symmetric Grid"
layout: "post"
diff: 省选/NOI-
pid: AT_arc095_c
tag: []
---

# [ARC095E] Symmetric Grid

## 题目描述

[problemUrl]: https://atcoder.jp/contests/arc095/tasks/arc095_c

$ H $ 行 $ W $ 列のマス目があり，各マスには英小文字が書かれています． 具体的には，上から $ i $ 行，左から $ j $ 列目のマスに書かれている文字は，文字列 $ S_i $ の $ j $ 文字目に等しいです．

すぬけ君は，このマス目に対して次の操作を好きな回数行うことができます：

- $ 2 $ つの異なる行を選び，入れ替える．または，$ 2 $ つの異なる列を選び，入れ替える．

すぬけ君は，このマス目が点対称的になるようにしたいです． すなわち，任意の $ 1\ \leq\ i\ \leq\ H $, $ 1\ \leq\ j\ \leq\ W $ に対して，マス目の上から $ i $ 行，左から $ j $ 列目に書かれている文字と，マス目の上から $ H\ +\ 1\ -\ i $ 行，左から $ W\ +\ 1\ -\ j $ 列目に書かれている文字が等しくなるようにしたいです．

すぬけくんがこの目標を達成することが可能かどうか判定してください．

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ H $ $ W $ $ S_1 $ $ S_2 $ $ : $ $ S_H $

## 输出格式

マス目を点対称的にできるなら `YES` を，できないなら `NO` を出力せよ．

## 说明/提示

### 制約

- $ 1\ \leq\ H\ \leq\ 12 $
- $ 1\ \leq\ W\ \leq\ 12 $
- $ |S_i|\ =\ W $
- $ S_i $ は英小文字のみからなる

### Sample Explanation 1

下の画像に示すように，左から $ 2 $ 列目と $ 3 $ 列目を入れ替えると，マス目が点対称的になります． !\[\](https://img.atcoder.jp/arc095/2b61caf45e7c5c7311e3944f3418b0bb.png)

## 样例 #1

### 输入

```
2 3

arc

rac
```

### 输出

```
YES
```

## 样例 #2

### 输入

```
3 7

atcoder

regular

contest
```

### 输出

```
NO
```

## 样例 #3

### 输入

```
12 12

bimonigaloaf

faurwlkbleht

dexwimqxzxbb

lxdgyoifcxid

ydxiliocfdgx

nfoabgilamoi

ibxbdqmzxxwe

pqirylfrcrnf

wtehfkllbura

yfrnpflcrirq

wvcclwgiubrk

lkbrwgwuiccv
```

### 输出

```
YES
```



---

---
title: "[ARC095F] Permutation Tree"
layout: "post"
diff: 省选/NOI-
pid: AT_arc095_d
tag: []
---

# [ARC095F] Permutation Tree

## 题目描述

[problemUrl]: https://atcoder.jp/contests/arc095/tasks/arc095_d

高橋くんには $ (1,2,...,n) $ の順列 $ (p_1,p_2,...,p_n) $ を使い、 次の手順で木を作る能力があります。

頂点 $ 1 $、頂点 $ 2 $、 $ ... $、 頂点 $ n $ を用意する。 各 $ i=1,2,...,n $ について次の操作を行う。

- $ p_i\ =\ 1 $ である場合、何もしない。
- $ p_i\ \neq\ 1 $ である場合、$ p_j\ <\ p_i $ であるような $ j $ のうち最大のものを $ j' $ とする。 頂点 $ i $ と 頂点 $ j' $ の間に辺を貼る。

高橋くんはこの能力を使ってお気に入りの木を作ろうとしています。 高橋くんのお気に入りの木は 頂点 $ 1 $ から頂点 $ n $ の $ n $ 頂点からなり、 $ i $ 番目の辺は頂点 $ v_i $ と $ w_i $ を結んでいます。 適切な順列を使うことで、高橋くんのお気に入りの木と同型な木を作ることが可能か 判定して下さい。 可能な場合、そのような順列のうち辞書順で最も小さいものを求めて下さい。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ n $ $ v_1 $ $ w_1 $ $ v_2 $ $ w_2 $ $ : $ $ v_{n-1} $ $ w_{n-1} $

## 输出格式

高橋くんのお気に入りの木と同型な木を作ることのできる順列が存在しない場合は `-1` を出力せよ。 存在する場合は、辞書順で最小の順列を空白区切りで出力せよ。

## 说明/提示

### 注意

木が同型であることの定義は[wikipedia](https://ja.wikipedia.org/wiki/%E3%82%B0%E3%83%A9%E3%83%95%E5%90%8C%E5%9E%8B)を参照して下さい。 直感的には、木と木が同型であるとは、頂点の番号を無視すると同じ木になることを言います。

### 制約

- $ 2\ \leq\ n\ \leq\ 10^5 $
- $ 1\ \leq\ v_i,\ w_i\ \leq\ n $
- 与えられるグラフは木である

### Sample Explanation 1

$ (1,\ 2,\ 4,\ 5,\ 3,\ 6) $ という順列を使って木を作ると、次の図のようになります。 !\[\](https://img.atcoder.jp/arc095/db000b879402aed649a1516620eb1e21.png) これは入力のグラフと同型です。

## 样例 #1

### 输入

```
6

1 2

1 3

1 4

1 5

5 6
```

### 输出

```
1 2 4 5 3 6
```

## 样例 #2

### 输入

```
6

1 2

2 3

3 4

1 5

5 6
```

### 输出

```
1 2 3 4 5 6
```

## 样例 #3

### 输入

```
15

1 2

1 3

2 4

2 5

3 6

3 7

4 8

4 9

5 10

5 11

6 12

6 13

7 14

7 15
```

### 输出

```
-1
```



---

---
title: "[ARC096E] Everything on It"
layout: "post"
diff: 省选/NOI-
pid: AT_arc096_c
tag: []
---

# [ARC096E] Everything on It

## 题目描述

[problemUrl]: https://atcoder.jp/contests/arc096/tasks/arc096_c

ラーメン店「高橋屋」のメニューは基本的には「ラーメン」の一つだけですが、$ N $ 種類のトッピングも提供されています。客がラーメンを注文するとき、それぞれの種類のトッピングを「乗せる」か「乗せない」かを選ぶことができます。乗せるトッピングの数に制限はなく、すべてのトッピングを乗せることも、トッピングを一つも乗せないこともできます。つまり、トッピングの組み合わせを考慮すると $ 2^N $ 通りのラーメンを注文できます。

赤木さんが高橋屋に入店しました。彼女は、次の二つの条件をともに満たすようにラーメンを何杯か注文しようと考えています。

- トッピングの組み合わせがまったく同じラーメンを複数杯注文しない。
- $ N $ 種類のトッピングそれぞれが、注文したラーメンのうち $ 2 $ 杯以上に乗っている。

$ N $ と素数 $ M $ が与えられます。これらの条件を満たすようなラーメンの組み合わせの数を $ M $ で割ったあまりを求めてください。ラーメンの順番は考慮しません。また、赤木さんは極限の空腹状態にあるため、ラーメンを何杯注文しても問題ありません。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ M $

## 输出格式

条件を満たすようなラーメンの組み合わせの数を $ M $ で割ったあまりを出力せよ。

## 说明/提示

### 制約

- $ 2\ \leq\ N\ \leq\ 3000 $
- $ 10^8\ \leq\ M\ \leq\ 10^9\ +\ 9 $
- $ N $ は整数である。
- $ M $ は素数である。

### 部分点

- $ N\ <\ =\ 50 $ を満たすテストセットに正解すると、$ 600 $ 点が与えられる。

### Sample Explanation 1

$ 2 $ 種類のトッピングを A, B とします。注文できるラーメンは「トッピングなし」「A 乗せ」「B 乗せ」「A, B 乗せ」の $ 4 $ 通りです。条件を満たすラーメンの組み合わせは次の $ 2 $ 通りです。 - 「A 乗せ」「B 乗せ」「A, B 乗せ」の $ 3 $ 杯 - 全通りのラーメン $ 1 $ 杯ずつ、合計 $ 4 $ 杯

### Sample Explanation 2

$ 3 $ 種類のトッピングを A, B, C とします。入出力例 1 で述べた $ 4 $ 通りのラーメンに加えて、それらに C を付け足した $ 4 $ 通りのラーメンも注文できます。条件を満たすラーメンの組み合わせは $ 118 $ 通りありますが、そのうちのいくつかを挙げます。 - 「A, B 乗せ」「A, C 乗せ」「B, C 乗せ」の $ 3 $ 杯 - 「トッピングなし」「A 乗せ」「A, B 乗せ」「B, C 乗せ」「A, B, C 乗せ」の $ 5 $ 杯 - 全通りのラーメン $ 1 $ 杯ずつ、合計 $ 8 $ 杯 なお、「『A 乗せ』『B 乗せ』『A, B 乗せ』の $ 3 $ 杯」は条件を満たしません。C がどのラーメンにも乗っていないためです。

### Sample Explanation 3

組み合わせの数を $ M $ で割ったあまりを出力することをお忘れなく。なお、以上の三つの入力例は、部分点のためのテストセットに含まれます。

### Sample Explanation 4

この入力例は、部分点のためのテストセットに含まれません。

## 样例 #1

### 输入

```
2 1000000007
```

### 输出

```
2
```

## 样例 #2

### 输入

```
3 1000000009
```

### 输出

```
118
```

## 样例 #3

### 输入

```
50 111111113
```

### 输出

```
1456748
```

## 样例 #4

### 输入

```
3000 123456791
```

### 输出

```
16369789
```



---

---
title: "[ARC097F] Monochrome Cat"
layout: "post"
diff: 省选/NOI-
pid: AT_arc097_d
tag: []
---

# [ARC097F] Monochrome Cat

## 题目描述

[problemUrl]: https://atcoder.jp/contests/arc097/tasks/arc097_d

頂点に $ 1 $ から $ N $ の番号がついた $ N $ 頂点からなる木があります。 $ i $ 番目の辺は頂点 $ x_i $ と $ y_i $ を結んでいます。 各頂点は、白か黒のいずれかの色で塗られています。 初期状態では、頂点 $ i $ の色は $ c_i $ で表されます。 $ c_i $ $ = $ `W` のとき 頂点が白いことを、$ c_i $ $ = $ `B` のとき 頂点が黒いことを表します。

この木の頂点の上を猫が移動していきます。 具体的には、$ 1 $ 秒間に次の動作のどちらかを行なうことを繰り返します。

- 現在いる頂点と隣接した頂点をひとつ選びその頂点に移動する。その後、移動先の頂点の色を反転する。
- 現在いる頂点の色を反転する。

猫の目標はすべての頂点を黒で塗ることです。どの頂点から動作をはじめても、どの頂点で動作を終えてもかまいません。 最短何秒で目標を達成できるでしょうか?

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ x_1 $ $ y_1 $ $ x_2 $ $ y_2 $ $ : $ $ x_{N-1} $ $ y_{N-1} $ $ c_1c_2..c_N $

## 输出格式

目標を達成するために必要な秒数の最小値を出力せよ。

## 说明/提示

### 制約

- $ 1 $ $ <\ = $ $ N $ $ <\ = $ $ 10^5 $
- $ 1 $ $ <\ = $ $ x_i,y_i $ $ <\ = $ $ N $ ($ 1 $ $ <\ = $ $ i $ $ <\ = $ $ N-1 $)
- 与えられるグラフは木
- $ c_i $ $ = $ `W` または $ c_i $ $ = $ `B`

### Sample Explanation 1

例えば、次のように行動すると $ 5 $ 秒で達成できます。 - 頂点 $ 1 $ からはじめる。 頂点 $ 1 $ の色を黒に変更する。 - 頂点 $ 2 $ に移動し、頂点 $ 2 $ の色を白に変更する。 - 頂点 $ 2 $ の色を黒に変更する。 - 頂点 $ 4 $ に移動し、頂点 $ 4 $ の色を黒に変更する。 - 頂点 $ 5 $ に移動し、頂点 $ 5 $ の色を黒に変更する。

## 样例 #1

### 输入

```
5

1 2

2 3

2 4

4 5

WBBWW
```

### 输出

```
5
```

## 样例 #2

### 输入

```
6

3 1

4 5

2 6

6 1

3 4

WWBWBB
```

### 输出

```
7
```

## 样例 #3

### 输入

```
1

B
```

### 输出

```
0
```

## 样例 #4

### 输入

```
20

2 19

5 13

6 4

15 6

12 19

13 19

3 11

8 3

3 20

16 13

7 14

3 17

7 8

10 20

11 9

8 18

8 2

10 1

6 13

WBWBWBBWWWBBWWBBBBBW
```

### 输出

```
21
```



---

---
title: "[ARC099E] Independence"
layout: "post"
diff: 省选/NOI-
pid: AT_arc099_c
tag: []
---

# [ARC099E] Independence

## 题目描述

[problemUrl]: https://atcoder.jp/contests/arc099/tasks/arc099_c

AtCoder 連邦の高橋州には，$ N $ 個の都市があります．都市は $ 1,\ 2,\ ...,\ N $ と番号付けされています． これらの都市の間は，$ M $ 本の両方向に行き来可能な道で結ばれています． $ i $ 番目の道は都市 $ A_i $ と都市 $ B_i $ の間を結んでいます． どの道も，異なる都市間を結んでいます． また，どの都市間にも，それらを直接結ぶ道は高々 $ 1 $ 本しか存在しません．

ある時，高橋州は高州と橋州の $ 2 $ つの州に分かれることになりました． 高橋州の各都市は，分離後は高州もしくは橋州のいずれか片方に属することになります． ここで，すべての都市が高州，または橋州の一方のみに属してしまっても構わないことにします． このとき，次の条件を満たすようにしたいです：

- 高州，橋州のいずれにおいても，同じ州内では，どの $ 2 $ つの都市も **直接** 道で結ばれている．

両端の都市が同じ州内に属しているような道の本数として考えられるもののうち，最小のものを求めてください． ただし，条件を満たすように都市を高州，橋州に分けることが不可能なら，`-1` を出力してください．

## 输入格式

入力は以下の形式で標準入力から与えられる．

> $ N $ $ M $ $ A_1 $ $ B_1 $ $ A_2 $ $ B_2 $ $ : $ $ A_M $ $ B_M $

## 输出格式

答えを出力せよ．

## 说明/提示

### 制約

- $ 2\ \leq\ N\ \leq\ 700 $
- $ 0\ \leq\ M\ \leq\ N(N-1)/2 $
- $ 1\ \leq\ A_i\ \leq\ N $
- $ 1\ \leq\ B_i\ \leq\ N $
- $ A_i\ \neq\ B_i $
- $ i\ \neq\ j $ のとき，$ A_i\ \neq\ A_j $ または $ B_i\ \neq\ B_j $ の少なくとも片方が成立
- $ i\ \neq\ j $ のとき，$ A_i\ \neq\ B_j $ または $ B_i\ \neq\ A_j $ の少なくとも片方が成立

### Sample Explanation 1

例えば，高州に都市 $ 1,\ 2 $ を，橋州に都市 $ 3,\ 4,\ 5 $ を割り当てると，条件を満たします． このとき，両端の都市が同じ州内に属しているような道の本数は $ 4 $ になります．

### Sample Explanation 2

この例では，どのように都市を割り当てても，条件を満たすことができません．

## 样例 #1

### 输入

```
5 5

1 2

1 3

3 4

3 5

4 5
```

### 输出

```
4
```

## 样例 #2

### 输入

```
5 1

1 2
```

### 输出

```
-1
```

## 样例 #3

### 输入

```
4 3

1 2

1 3

2 3
```

### 输出

```
3
```

## 样例 #4

### 输入

```
10 39

7 2

7 1

5 6

5 8

9 10

2 8

8 7

3 10

10 1

8 10

2 3

7 4

3 9

4 10

3 4

6 1

6 7

9 5

9 7

6 9

9 4

4 6

7 5

8 3

2 5

9 2

10 7

8 6

8 9

7 3

5 3

4 5

6 3

2 10

5 10

4 2

6 2

8 4

10 6
```

### 输出

```
21
```



---

---
title: "[ARC099F] Eating Symbols Hard"
layout: "post"
diff: 省选/NOI-
pid: AT_arc099_d
tag: []
---

# [ARC099F] Eating Symbols Hard

## 题目描述

[problemUrl]: https://atcoder.jp/contests/arc099/tasks/arc099_d

高橋君は，いつも頭の中に，長さ $ 2\ \times\ 10^9\ +\ 1 $ の整数列 $ A\ =\ (A_{-10^9},\ A_{-10^9\ +\ 1},\ ...,\ A_{10^9\ -\ 1},\ A_{10^9}) $ と，整数 $ P $ を思い浮かべています．

はじめ，高橋君が思い浮かべている整数列 $ A $ のすべての要素は $ 0 $ です． また，整数 $ P $ の値は $ 0 $ です．

高橋君は，`+`, `-`, `>`, `<` の記号を食べると，それぞれ次のように思い浮かべている整数列 $ A $，整数 $ P $ が変化します：

- `+` を食べた場合，$ A_P $ の値が $ 1 $ 大きくなる．
- `-` を食べた場合，$ A_P $ の値が $ 1 $ 小さくなる．
- `>` を食べた場合，$ P $ の値が $ 1 $ 大きくなる．
- `<` を食べた場合，$ P $ の値が $ 1 $ 小さくなる．

高橋君は，長さ $ N $ の文字列 $ S $ を持っています．$ S $ の各文字は `+`, `-`, `>`, `<` の記号のいずれかです． 高橋君は，$ 1\ \leq\ i\ \leq\ j\ \leq\ N $ なる整数の組 $ (i,\ j) $ を選んで，$ S $ の $ i,\ i+1,\ ...,\ j $ 文字目の記号をこの順に食べました． 高橋君が記号を食べ終わった後，高橋君が思い浮かべている整数列 $ A $ は，高橋君が $ S $ のすべての記号を $ 1 $ 文字目から順に食べた場合と等しくなったといいます． このような $ (i,\ j) $ として考えられるものは何通りあるか求めてください．

## 输入格式

入力は以下の形式で標準入力から与えられる．

> $ N $ $ S $

## 输出格式

答えを出力せよ．

## 说明/提示

### 制約

- $ 1\ \leq\ N\ \leq\ 250000 $
- $ |S|\ =\ N $
- $ S $ の各文字は `+`, `-`, `>`, `<` のいずれか

### Sample Explanation 1

高橋君が $ S $ のすべての記号を食べた場合，$ A_1\ =\ 1 $ で，$ A $ の他の要素はすべて $ 0 $ になります． $ A $ がこれと等しくなるような $ (i,\ j) $ は次の通りです： - $ (1,\ 5) $ - $ (2,\ 3) $ - $ (2,\ 4) $

### Sample Explanation 2

高橋君が $ S $ のすべての記号を食べた場合と $ P $ が異なっていてもかまわないことに注意してください．

## 样例 #1

### 输入

```
5

+>+<-
```

### 输出

```
3
```

## 样例 #2

### 输入

```
5

+>+-<
```

### 输出

```
5
```

## 样例 #3

### 输入

```
48

-+><<><><><>>>+-<<>->>><<><<-+<>><+<<>+><-+->><<
```

### 输出

```
475
```



---

---
title: "[ARC101E] Ribbons on Tree"
layout: "post"
diff: 省选/NOI-
pid: AT_arc101_c
tag: []
---

# [ARC101E] Ribbons on Tree

## 题目描述

[problemUrl]: https://atcoder.jp/contests/arc101/tasks/arc101_c

$ N $ を偶数とします。

$ N $ 頂点の木があります。 頂点には $ 1,\ 2,\ ...,\ N $ と番号が振られています。 各 $ i $ ($ 1\ \leq\ i\ \leq\ N\ -\ 1 $) について、$ i $ 番目の辺は頂点 $ x_i $ と $ y_i $ を結んでいます。

すぬけ君は、次のようにして木をリボンで飾りつけようと思っています。

まず、$ N $ 個の頂点を $ N\ /\ 2 $ 組のペアに分けます。 このとき、各頂点はちょうど $ 1 $ つのペアに属さなければなりません。 次に、各ペア $ (u,\ v) $ について、$ 1 $ 本のリボンを $ u $-$ v $ 間の最短パスに含まれるすべての辺を通るように張ります。

すぬけ君はペアの分け方を工夫し、「どの辺にも少なくとも $ 1 $ 本のリボンが張られている」という条件が成り立つようにしようとしています。 条件が成り立つようなペアの分け方は何通りでしょうか？ $ 10^9\ +\ 7 $ で割った余りを求めてください。 ただし、$ 2 $ 通りのペアの分け方が異なるとは、あるペアが一方には含まれるが他方には含まれないことを言います。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ x_1 $ $ y_1 $ $ x_2 $ $ y_2 $ $ : $ $ x_{N\ -\ 1} $ $ y_{N\ -\ 1} $

## 输出格式

条件が成り立つようなペアの分け方は何通りか？ $ 10^9\ +\ 7 $ で割った余りを出力せよ。

## 说明/提示

### 制約

- $ N $ は偶数である。
- $ 2\ \leq\ N\ \leq\ 5000 $
- $ 1\ \leq\ x_i,\ y_i\ \leq\ N $
- 与えられるグラフは木である。

### Sample Explanation 1

ペアの分け方は次図の $ 3 $ 通りであり、右側の $ 2 $ 通りが条件を満たします。 !\[\](https://img.atcoder.jp/arc101/2d7584d2e0736f746aa9d54e1bf31e28.png)

### Sample Explanation 2

ペアの分け方は次図の $ 3 $ 通りであり、すべて条件を満たします。 !\[\](https://img.atcoder.jp/arc101/2de530ed2e64d0161ee6b989d1946261.png)

## 样例 #1

### 输入

```
4

1 2

2 3

3 4
```

### 输出

```
2
```

## 样例 #2

### 输入

```
4

1 2

1 3

1 4
```

### 输出

```
3
```

## 样例 #3

### 输入

```
6

1 2

1 3

3 4

1 5

5 6
```

### 输出

```
10
```

## 样例 #4

### 输入

```
10

8 5

10 8

6 5

1 5

4 8

2 10

3 6

9 2

1 7
```

### 输出

```
672
```



---

---
title: "[ARC101F] Robots and Exits"
layout: "post"
diff: 省选/NOI-
pid: AT_arc101_d
tag: []
---

# [ARC101F] Robots and Exits

## 题目描述

[problemUrl]: https://atcoder.jp/contests/arc101/tasks/arc101_d

数直線上に $ N $ 体のロボットと $ M $ 個の出口があります。 これらの $ N\ +\ M $ 個の座標はすべて整数であり、すべて相異なります。 各 $ i $ ($ 1\ \leq\ i\ \leq\ N $) について、左から $ i $ 番目のロボットの座標は $ x_i $ です。 また、各 $ j $ ($ 1\ \leq\ j\ \leq\ M $) について、左から $ j $ 番目の出口の座標は $ y_j $ です。

すぬけ君は、次の $ 2 $ 種類の操作を好きな順序で繰り返し行い、ロボットを一斉に動かすことができます。

- 数直線上のすべてのロボットの座標を $ -1 $ する。
- 数直線上のすべてのロボットの座標を $ +1 $ する。

各ロボットは、いずれかの出口と重なった瞬間、その出口を通って数直線上から消えます。 すぬけ君は、すべてのロボットが消えるまで操作を行い続けます。

すべてのロボットが消えた後、各ロボットがどの出口を通ったかという組合せは何通りありうるでしょうか？ $ 10^9\ +\ 7 $ で割った余りを求めてください。 ただし、$ 2 $ 通りの組合せが異なるとは、あるロボットが存在し、そのロボットの通った出口が異なることを言います。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ M $ $ x_1 $ $ x_2 $ $ ... $ $ x_N $ $ y_1 $ $ y_2 $ $ ... $ $ y_M $

## 输出格式

すべてのロボットが消えた後、各ロボットがどの出口を通ったかという組合せは何通りありうるか？ $ 10^9\ +\ 7 $ で割った余りを出力せよ。

## 说明/提示

### 制約

- $ 1\ \leq\ N,\ M\ \leq\ 10^5 $
- $ 1\ \leq\ x_1\ <\ x_2\ <\ ...\ <\ x_N\ \leq\ 10^9 $
- $ 1\ \leq\ y_1\ <\ y_2\ <\ ...\ <\ y_M\ \leq\ 10^9 $
- 与えられる座標はすべて整数である。
- 与えられる座標はすべて相異なる。

### Sample Explanation 1

左から $ i $ 番目のロボットをロボット $ i $ と呼び、左から $ j $ 番目の出口を出口 $ j $ と呼びます。 $ ( $ロボット $ 1 $ が通った出口$ , $ ロボット $ 2 $ が通った出口$ ) $ の組合せとしてありうるものは、次の $ 3 $ 通りです。 - $ ( $出口 $ 1 $$ , $ 出口 $ 1 $$ ) $ - $ ( $出口 $ 1 $$ , $ 出口 $ 2 $$ ) $ - $ ( $出口 $ 2 $$ , $ 出口 $ 2 $$ ) $

### Sample Explanation 2

各ロボットごと独立に通る出口を決められるので、組合せは $ 2^3\ =\ 8 $ 通りです。

### Sample Explanation 3

どのロボットも出口 $ 1 $ を通ります。

## 样例 #1

### 输入

```
2 2

2 3

1 4
```

### 输出

```
3
```

## 样例 #2

### 输入

```
3 4

2 5 10

1 3 7 13
```

### 输出

```
8
```

## 样例 #3

### 输入

```
4 1

1 2 4 5

3
```

### 输出

```
1
```

## 样例 #4

### 输入

```
4 5

2 5 7 11

1 3 6 9 13
```

### 输出

```
6
```

## 样例 #5

### 输入

```
10 10

4 13 15 18 19 20 21 22 25 27

1 5 11 12 14 16 23 26 29 30
```

### 输出

```
22
```



---

---
title: "[ARC102E] Stop. Otherwise..."
layout: "post"
diff: 省选/NOI-
pid: AT_arc102_c
tag: []
---

# [ARC102E] Stop. Otherwise...

## 题目描述

[problemUrl]: https://atcoder.jp/contests/arc102/tasks/arc102_c

高橋君は、互いに区別できない $ K $ 面サイコロを $ N $ 個振ります。なお、$ K $ 面サイコロとは、$ 1 $ 以上 $ K $ 以下のすべての整数の目の出る可能性のあるサイコロのことを指します。 各 $ i=2,3,...,2K $ に対し、以下の値を $ 998244353 $ で割ったあまりをそれぞれ求めてください。

- どの異なる $ 2 $ つのサイコロの出目の和も $ i $ にならないような出目の組の場合の数

なお、サイコロ同士は区別しないことに注意してください。したがって、$ 2 $ つの出目の組が異なるとは、ある目 $ k $ が存在し、出目 $ k $ の個数が異なることを指します。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ K $ $ N $

## 输出格式

$ 2K-1 $ 個の整数を出力せよ。$ t(1\leq\ t\leq\ 2K-1) $ 個目には、$ i=t+1 $ のときの答えを出力せよ。

## 说明/提示

### 制約

- $ 1\ \leq\ K\ \leq\ 2000 $
- $ 2\ \leq\ N\ \leq\ 2000 $
- $ K,N $ は整数である

### Sample Explanation 1

\- $ i=2 $ のとき、出目の組 $ (1,2,2),(1,2,3),(1,3,3),(2,2,2),(2,2,3),(2,3,3),(3,3,3) $ が条件を満たすので、このときの答えは $ 7 $ です。 - $ i=3 $ のとき、出目の組 $ (1,1,1),(1,1,3),(1,3,3),(2,2,2),(2,2,3),(2,3,3),(3,3,3) $ が条件を満たすので、このときの答えは $ 7 $ です。 - $ i=4 $ のとき、出目の組 $ (1,1,1),(1,1,2),(2,3,3),(3,3,3) $ が条件を満たすので、このときの答えは $ 4 $ です。

## 样例 #1

### 输入

```
3 3
```

### 输出

```
7

7

4

7

7
```

## 样例 #2

### 输入

```
4 5
```

### 输出

```
36

36

20

20

20

36

36
```

## 样例 #3

### 输入

```
6 1000
```

### 输出

```
149393349

149393349

668669001

668669001

4000002

4000002

4000002

668669001

668669001

149393349

149393349
```



---

---
title: "[ABC111D] Robot Arms"
layout: "post"
diff: 省选/NOI-
pid: AT_arc103_b
tag: []
---

# [ABC111D] Robot Arms

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc111/tasks/arc103_b

すぬけ君の工場では，次のような特徴を持つ **ロボットアーム** を導入することになりました：

- ロボットアームは，$ m $ 個の **腕** と $ m+1 $ 個の **関節** からなる．腕には $ 1 $, $ 2 $, ..., $ m $ で，関節には $ 0 $, $ 1 $, ..., $ m $ で番号が付けられている．腕 $ i $ は関節 $ i-1 $ と関節 $ i $ をつなぐ．腕 $ i $ の長さは $ d_i $ である．
- 各腕には，それぞれ独立に **モード** を指定することができる．モードは `L`, `R`, `D`, `U` のいずれかであり，腕のモードはその腕の向きを指定する．工場を座標平面とみなすと，関節 $ i $ の座標 $ (x_i,\ y_i) $ は次のように定まる：
  - $ (x_0,\ y_0)\ =\ (0,\ 0) $．
  - 腕 $ i $ のモードが `L` のとき，$ (x_i,\ y_i)\ =\ (x_{i-1}\ -\ d_{i},\ y_{i-1}) $．
  - 腕 $ i $ のモードが `R` のとき，$ (x_i,\ y_i)\ =\ (x_{i-1}\ +\ d_{i},\ y_{i-1}) $．
  - 腕 $ i $ のモードが `D` のとき，$ (x_i,\ y_i)\ =\ (x_{i-1},\ y_{i-1}\ -\ d_{i}) $．
  - 腕 $ i $ のモードが `U` のとき，$ (x_i,\ y_i)\ =\ (x_{i-1},\ y_{i-1}\ +\ d_{i}) $．

すぬけ君は，腕のモードをうまく指定することにより，$ N $ 個の点 $ (X_1,\ Y_1),\ (X_2,\ Y_2),\ ...,\ (X_N,\ Y_N) $ のいずれにもロボットアームの関節 $ m $ をちょうど一致させられるようなロボットアームを導入したいです． このようなことは可能でしょうか？ 可能ならば，条件を満たすロボットアームおよび，各点 $ (X_j,\ Y_j) $ にそのロボットアームの関節 $ m $ を到達させるためのモードの指定方法を求めてください．

## 输入格式

入力は以下の形式で標準入力から与えられる．

> $ N $ $ X_1 $ $ Y_1 $ $ X_2 $ $ Y_2 $ $ : $ $ X_N $ $ Y_N $

## 输出格式

条件を満たすことが可能なら，次の形式で出力せよ．不可能な場合は `-1` を出力せよ．

> $ m $ $ d_1 $ $ d_2 $ $ ... $ $ d_m $ $ w_1 $ $ w_2 $ $ : $ $ w_N $

$ m $ および $ d_i $ はロボットアームの情報を表す．それぞれの変数の意味は問題文を参照せよ． ここで，$ 1\ \leq\ m\ \leq\ 40 $, $ 1\ \leq\ d_i\ \leq\ 10^{12} $ かつ $ m,\ d_i $ はすべて整数でなければならない．

$ w_j $ は $ m $ 文字からなる文字列であり，点 $ (X_j,\ Y_j) $ にロボットアームの関節 $ m $ を到達させる方法を表す． $ w_j $ の $ i $ 文字目は `L`, `R`, `D`, `U` のいずれかの文字であり，腕 $ i $ のモードを表す．

## 说明/提示

### 制約

- 入力はすべて整数である
- $ 1\ \leq\ N\ \leq\ 1000 $
- $ -10^9\ \leq\ X_i\ \leq\ 10^9 $
- $ -10^9\ \leq\ Y_i\ \leq\ 10^9 $

### 部分点

- $ 300 $ 点分のテストケースでは，$ -10\ \leq\ X_i\ \leq\ 10 $ および $ -10\ \leq\ Y_i\ \leq\ 10 $ が成り立つ．

### Sample Explanation 1

それぞれの $ (X_j,\ Y_j) $ にロボットアームの関節 $ m $ を到達させる方法において，各関節の位置は次のようになります． - $ (X_1,\ Y_1)\ =\ (-1,\ 0) $ に到達させる方法では，まず関節 $ 0 $ の位置は $ (x_0,\ y_0)\ =\ (0,\ 0) $ です．腕 $ 1 $ のモードが `R` なので，関節 $ 1 $ の位置は $ (x_1,\ y_1)\ =\ (1,\ 0) $ です．腕 $ 2 $ のモードが `L` なので，関節 $ m=2 $ の位置は $ (x_2,\ y_2)\ =\ (-1,\ 0) $ です． - $ (X_2,\ Y_2)\ =\ (0,\ 3) $ に到達させる方法では，$ (x_0,\ y_0)\ =\ (0,\ 0),\ (x_1,\ y_1)\ =\ (0,\ 1),\ (x_2,\ y_2)\ =\ (0,\ 3) $ です． - $ (X_3,\ Y_3)\ =\ (2,\ -1) $ に到達させる方法では，$ (x_0,\ y_0)\ =\ (0,\ 0),\ (x_1,\ y_1)\ =\ (0,\ -1),\ (x_2,\ y_2)\ =\ (2,\ -1) $ です．

### Sample Explanation 3

$ (X_j,\ Y_j) $ の中に同じ点が含まれることもあります．

## 样例 #1

### 输入

```
3

-1 0

0 3

2 -1
```

### 输出

```
2

1 2

RL

UU

DR
```

## 样例 #2

### 输入

```
5

0 0

1 0

2 0

3 0

4 0
```

### 输出

```
-1
```

## 样例 #3

### 输入

```
2

1 1

1 1
```

### 输出

```
2

1 1

RU

UR
```

## 样例 #4

### 输入

```
3

-7 -3

7 3

-3 -7
```

### 输出

```
5

3 1 4 1 5

LRDUL

RDULR

DULRD
```



---

---
title: "[ARC103F] Distance Sums"
layout: "post"
diff: 省选/NOI-
pid: AT_arc103_d
tag: []
---

# [ARC103F] Distance Sums

## 题目描述

[problemUrl]: https://atcoder.jp/contests/arc103/tasks/arc103_d

長さ $ N $ の数列 $ D_1,\ D_2,\ ...,\ D_N $ が与えられます。 **$ D_i $ の値はすべて異なります**。 以下の条件を満たす $ N $ 頂点の木は存在するでしょうか？

- 各頂点には $ 1,2,...,\ N $ の番号が付けられている
- 各辺には $ 1,2,...,\ N-1 $ の番号が付けられていて、$ i $ 番目の辺は頂点 $ u_i $ と $ v_i $ をつないでいる
- 各頂点 $ i $ に対して、$ i $ から他の頂点までの距離の和は $ D_i $ である。ただし、各辺の長さは $ 1 $ であるものとする。

条件を満たす木が存在する場合、$ 1 $ つ構築してください。

## 输入格式

入力は以下の形式で標準入力から与えられる．

> $ N $ $ D_1 $ $ D_2 $ $ : $ $ D_N $

## 输出格式

条件を満たす $ N $ 頂点の木が存在しない場合、`-1` と出力してください。

条件を満たす $ N $ 頂点の木が存在する場合、$ N-1 $ 行出力してください。 $ i $ 行目には $ u_i,v_i $ を空白区切りで出力してください。 複数の木が条件を満たす場合、どれを出力しても構いません。

## 说明/提示

### 制約

- $ 2\ \leq\ N\ \leq\ 100000 $
- $ 1\ \leq\ D_i\ \leq\ 10^{12} $
- $ D_i $ はすべて異なる

### Sample Explanation 1

次のような木が条件を満たします。 !\[\](https://img.atcoder.jp/arc103/92920696862ead4cacf3755c3c8135e0.png)

## 样例 #1

### 输入

```
7

10

15

13

18

11

14

19
```

### 输出

```
1 2

1 3

1 5

3 4

5 6

6 7
```

## 样例 #2

### 输入

```
2

1

2
```

### 输出

```
-1
```

## 样例 #3

### 输入

```
15

57

62

47

45

42

74

90

75

54

50

66

63

77

87

51
```

### 输出

```
1 10

1 11

2 8

2 15

3 5

3 9

4 5

4 10

5 15

6 12

6 14

7 13

9 12

11 13
```



---

---
title: "[ARC104E] Random LIS"
layout: "post"
diff: 省选/NOI-
pid: AT_arc104_e
tag: []
---

# [ARC104E] Random LIS

## 题目描述

[problemUrl]: https://atcoder.jp/contests/arc104/tasks/arc104_e

長さ $ N $ の整数列 $ A_1,\ A_2,\ \cdots,\ A_N $ が与えられます。

同じく長さ $ N $ の整数列 $ X $ は、 各 $ i\ (1\ \leq\ i\ \leq\ N) $ について独立に、 $ 1\ \leq\ X_i\ \leq\ A_i $ を満たす整数の一様分布からランダムに選ばれます。

このとき、$ X $ の最長増加部分列の長さの期待値を mod $ 1000000007 $ で計算してください。

より正確には、期待値が有理数、つまりある既約分数 $ \frac{P}{Q} $ で表せること、更に $ R\ \times\ Q\ \equiv\ P\ \pmod\ {1000000007} $, $ 0\ \leq\ R\ <\ 1000000007 $ を満たす整数 $ R $ が一意に定まることがこの問題の制約より証明できますので、この $ R $ を出力してください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ A_1 $ $ A_2 $ $ \cdots $ $ A_N $

## 输出格式

期待値を mod $ 1000000007 $ で出力せよ。

## 说明/提示

### 注釈

列 $ X $ の部分列とは $ X $ の要素をいくつか抜き出して元の順に並べてできる列のことを指し、また、列 $ X $ の最長増加部分列とは、$ X $ の狭義単調増加な部分列の中で列の長さが最大のものを指します。

### 制約

- $ 1\ \leq\ N\ \leq\ 6 $
- $ 1\ \leq\ A_i\ \leq\ 10^9 $
- 入力は全て整数である

### Sample Explanation 1

$ X $ はそれぞれ確率 $ 1/6 $ で次のいずれかになります。 - $ X\ =\ (1,1,1) $ のとき、最長増加部分列の長さは $ 1 $ です。 - $ X\ =\ (1,1,2) $ のとき、最長増加部分列の長さは $ 2 $ です。 - $ X\ =\ (1,1,3) $ のとき、最長増加部分列の長さは $ 2 $ です。 - $ X\ =\ (1,2,1) $ のとき、最長増加部分列の長さは $ 2 $ です。 - $ X\ =\ (1,2,2) $ のとき、最長増加部分列の長さは $ 2 $ です。 - $ X\ =\ (1,2,3) $ のとき、最長増加部分列の長さは $ 3 $ です。 よって、最長増加部分列の長さの期待値は $ (1\ +\ 2\ +\ 2\ +\ 2\ +\ 2\ +\ 3)\ /\ 6\ \equiv\ 2\ \pmod\ {1000000007} $ です。

### Sample Explanation 2

$ X $ はそれぞれ確率 $ 1/4 $ で次のいずれかになります。 - $ X\ =\ (1,1,1) $ のとき、最長増加部分列の長さは $ 1 $ です。 - $ X\ =\ (1,1,2) $ のとき、最長増加部分列の長さは $ 2 $ です。 - $ X\ =\ (2,1,1) $ のとき、最長増加部分列の長さは $ 1 $ です。 - $ X\ =\ (2,1,2) $ のとき、最長増加部分列の長さは $ 2 $ です。 よって、最長増加部分列の長さの期待値は $ (1\ +\ 2\ +\ 1\ +\ 2)\ /\ 4\ =\ 3\ /\ 2 $ ですが、$ 2\ \times\ 500000005\ \equiv\ 3\ \pmod\ {1000000007} $ であるので、$ 500000005 $ を出力してください。

## 样例 #1

### 输入

```
3

1 2 3
```

### 输出

```
2
```

## 样例 #2

### 输入

```
3

2 1 2
```

### 输出

```
500000005
```

## 样例 #3

### 输入

```
6

8 6 5 10 9 14
```

### 输出

```
959563502
```



---

---
title: "[ARC104F] Visibility Sequence"
layout: "post"
diff: 省选/NOI-
pid: AT_arc104_f
tag: []
---

# [ARC104F] Visibility Sequence

## 题目描述

[problemUrl]: https://atcoder.jp/contests/arc104/tasks/arc104_f

一列に並んだ $ N $ 棟のビルが建設中であり、ビルには左から順番に $ 1,\ 2,\ \ldots,\ N $ の番号がついています。

長さ $ N $ の整数列 $ X $ が与えられ、ビル $ i $ の高さ $ H_i $ は、$ 1 $ 以上 $ X_i $ 以下の整数のいずれかにすることができます。

$ 1\ \leq\ i\ \leq\ N $ に対して、$ P_i $ を次のように定めます。

- $ H_j\ >\ H_i $ を満たすような整数 $ j\ (1\ \leq\ j\ <\ i) $ が存在する場合はそのような $ j $ の最大値、存在しない場合は $ -1 $ とする

全てのビルの高さの組み合わせを考えるとき、 $ P $ としてありうる整数列の個数を $ 1000000007 $ で割った余りを求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ X_1 $ $ X_2 $ $ \cdots $ $ X_N $

## 输出格式

全てのビルの高さの組み合わせを考えるとき、 $ P $ としてありうる整数列の個数を $ 1000000007 $ で割った余りを出力せよ。

## 说明/提示

### 制約

- $ 1\ \leq\ N\ \leq\ 100 $
- $ 1\ \leq\ X_i\ \leq\ 10^5 $
- 入力は全て整数である

### Sample Explanation 1

$ H $ としては、次の $ 6 $ 通りが考えられます。 - $ H\ =\ (1,\ 1,\ 1) $ のとき、$ P $ は $ (-1,\ -1,\ -1) $ である - $ H\ =\ (1,\ 2,\ 1) $ のとき、$ P $ は $ (-1,\ -1,\ 2) $ である - $ H\ =\ (2,\ 1,\ 1) $ のとき、$ P $ は $ (-1,\ 1,\ 1) $ である - $ H\ =\ (2,\ 2,\ 1) $ のとき、$ P $ は $ (-1,\ -1,\ 2) $ である - $ H\ =\ (3,\ 1,\ 1) $ のとき、$ P $ は $ (-1,\ 1,\ 1) $ である - $ H\ =\ (3,\ 2,\ 1) $ のとき、$ P $ は $ (-1,\ 1,\ 2) $ である よって、$ P $ としてありうる整数列は $ (-1,\ -1,\ -1),\ (-1,\ -1,\ 2),\ (-1,\ 1,\ 1),\ (-1,\ 1,\ 2) $ の $ 4 $ 個です。

### Sample Explanation 2

$ H $ としては、次の $ 2 $ 通りが考えられます。 - $ H\ =\ (1,\ 1,\ 1) $ のとき、$ P $ は $ (-1,\ -1,\ -1) $ である - $ H\ =\ (1,\ 1,\ 2) $ のとき、$ P $ は $ (-1,\ -1,\ -1) $ である よって、$ P $ としてありうる整数列は $ 1 $ 個です。

## 样例 #1

### 输入

```
3

3 2 1
```

### 输出

```
4
```

## 样例 #2

### 输入

```
3

1 1 2
```

### 输出

```
1
```

## 样例 #3

### 输入

```
5

2 2 2 2 2
```

### 输出

```
16
```

## 样例 #4

### 输入

```
13

3 1 4 1 5 9 2 6 5 3 5 8 9
```

### 输出

```
31155
```



---

---
title: "[ARC105E] Keep Graph Disconnected"
layout: "post"
diff: 省选/NOI-
pid: AT_arc105_e
tag: []
---

# [ARC105E] Keep Graph Disconnected

## 题目描述

[problemUrl]: https://atcoder.jp/contests/arc105/tasks/arc105_e

$ 1 $ から $ N $ の番号がついた $ N $ 個の頂点と、$ 1 $ から $ M $ の番号がついた $ M $ 本の辺からなる無向グラフ $ G $ が与えられます。 辺 $ i $ は頂点 $ a_i $ と頂点 $ b_i $ を双方向につないでいます。

$ G $ が以下の条件の両方を満たすとき、$ G $ は *よいグラフ* であるといいます。はじめ、$ G $ はよいグラフであることが保証されます。

- 頂点 $ 1 $ と $ N $ が非連結
- 自己ループや多重辺が存在しない

先手太郎君と後手次郎君が対戦ゲームをします。 先手太郎君と後手次郎君の手番が交互に訪れます。先手太郎君が先手です。 それぞれのプレイヤーは、手番において以下の操作が可能です。

操作：頂点 $ u,v $ を選んで $ u $ と $ v $ を双方向につなぐ辺を $ G $ に追加する。

辺を追加した結果、$ G $ がよいグラフでなくなった人の負けです。$ 2 $ 人が最適に行動したときに勝つのはどちらかを判定してください。

$ T $ 個のテストケースが与えられるので、それぞれについて答えを求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ T $ $ \mathrm{case}_1 $ $ \vdots $ $ \mathrm{case}_T $

各ケースは以下の形式で与えられる。

> $ N $ $ M $ $ a_1 $ $ b_1 $ $ \vdots $ $ a_M $ $ b_M $

## 输出格式

$ T $ 行出力せよ。$ i $ 行目には $ i $ 番目のテストケースの勝者が先手太郎君ならば `First`、後手次郎君ならば `Second` を出力せよ。

## 说明/提示

### 制約

- 与えられる入力は全て整数
- $ 1\ \leq\ T\ \leq\ 10^5 $
- $ 2\ \leq\ N\ \leq\ 10^{5} $
- $ 0\ \leq\ M\ \leq\ \min(N(N-1)/2,10^{5}) $
- $ 1\ \leq\ a_i,b_i\ \leq\ N $
- 与えられるグラフはよいグラフ
- $ 1 $ つの入力ファイルにおいて、$ N $ の総和、$ M $ の総和はどちらも $ 2\ \times\ 10^5 $ を超えない。

### Sample Explanation 1

\- テストケース $ 1 $ では先手太郎君が勝利します。以下はそのような $ 2 $ 人の行動の例です。 - 先手太郎君の手番で頂点 $ 1,2 $ をつなぐ辺を追加する。辺を追加したあとのグラフもよいグラフです。 - 後手次郎君はどの $ 2 $ つの頂点の間に辺を追加したとしても、グラフがよいグラフではなくなってしまいます。 - よって、勝者は先手太郎君です。

## 样例 #1

### 输入

```
3

3 0

6 2

1 2

2 3

15 10

12 14

8 3

10 1

14 6

12 6

1 9

13 1

2 5

3 9

7 2
```

### 输出

```
First

Second

First
```



---

---
title: "[ARC105F] Lights Out on Connected Graph"
layout: "post"
diff: 省选/NOI-
pid: AT_arc105_f
tag: []
---

# [ARC105F] Lights Out on Connected Graph

## 题目描述

[problemUrl]: https://atcoder.jp/contests/arc105/tasks/arc105_f

$ 1 $ から $ N $ の番号がついた $ N $ 個の頂点と、$ 1 $ から $ M $ の番号がついた $ M $ 本の辺からなる無向グラフ $ G $ が与えられます。$ G $ は連結で、自己ループや多重辺が存在しないことが保証されます。 辺 $ i $ は頂点 $ a_i $ と頂点 $ b_i $ を双方向につなぐ辺です。 それぞれの辺は赤か青のどちらかの色で塗ることができます。はじめ、全ての辺は赤で塗られています。

$ G $ から $ 0 $ 本以上の辺を取り除き新しいグラフ $ G^{\prime} $ を作ることを考えます。 $ G^{\prime} $ としてありうるグラフは $ 2^M $ 通りありますが、これらのうちよいグラフ(後述)であるようなものの個数を $ 998244353 $ で割ったあまりを求めてください。

$ G^{\prime} $ が以下の条件の両方を満たすとき、$ G^{\prime} $ は *よいグラフ* であるといいます。

- $ G^{\prime} $ は連結
- 以下の操作を $ 0 $ 回以上繰り返すことで、全ての辺の色を青色にできる
  - 頂点を $ 1 $ つ選び、その頂点に接続する全ての辺の色を変化させる。すなわち、辺の色が赤ならば青へ、青ならば赤へ変化させる。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ M $ $ a_1 $ $ b_1 $ $ \vdots $ $ a_M $ $ b_M $

## 输出格式

$ G^{\prime} $ としてありうるグラフのうち、よいグラフであるものの個数を $ 998244353 $ で割ったあまりを出力せよ。

## 说明/提示

### 制約

- 与えられる入力は全て整数
- $ 1\ \leq\ N\ \leq\ 17 $
- $ N-1\ \leq\ M\ \leq\ N(N-1)/2 $
- $ G $ は連結で、自己ループや多重辺が存在しない

### Sample Explanation 1

\- 辺 $ 1 $、辺 $ 2 $ のどちらも取り除かない場合のみ条件を満たします。 - 例えば、頂点 $ 2 $ に対して操作を行うことで、全ての辺を青色にすることが可能です。 - それ以外の場合はグラフが非連結になるため、条件を満たしません。

### Sample Explanation 3

\- $ 998244353 $ で割ったあまりを求めるのを忘れずに。

## 样例 #1

### 输入

```
3 2

1 2

2 3
```

### 输出

```
1
```

## 样例 #2

### 输入

```
4 6

1 2

1 3

1 4

2 3

2 4

3 4
```

### 输出

```
19
```

## 样例 #3

### 输入

```
17 50

16 17

10 9

16 10

5 17

6 15

5 9

15 11

16 1

8 13

6 17

15 3

16 15

11 3

7 6

1 4

11 13

10 6

10 12

3 16

7 3

16 5

13 3

12 13

7 11

3 12

13 10

1 12

9 15

11 14

4 6

13 2

6 1

15 2

1 14

15 17

2 11

14 13

16 9

16 8

8 17

17 12

1 11

6 12

17 2

8 1

14 6

9 7

11 10

5 14

17 7
```

### 输出

```
90625632
```



---

---
title: "[ARC106E] Medals"
layout: "post"
diff: 省选/NOI-
pid: AT_arc106_e
tag: []
---

# [ARC106E] Medals

## 题目描述

[problemUrl]: https://atcoder.jp/contests/arc106/tasks/arc106_e

あなたは $ N $ 人の従業員を持つ店の店長です。 各従業員は一定の周期で出勤します。 より正確には、$ i $ 番目の従業員は今日から「$ A_i $ 日連続で働いた後 $ A_i $ 日連続で休む」ことを繰り返します。

あなたは今日から毎日出勤し、その日に出勤している従業員の中から $ 1 $ 人選び、メダルを $ 1 $ 枚配ります。（その日に出勤している従業員が $ 1 $ 人もいなければ何もしません）

全ての従業員に $ K $ 枚以上のメダルを配るためには、最短で何日かかるでしょうか。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ K $ $ A_1 $ $ A_2 $ $ \cdots $ $ A_N $

## 输出格式

答えを出力せよ。

## 说明/提示

### 制約

- 入力は全て整数
- $ 1\ \le\ N\ \le\ 18 $
- $ 1\ \le\ K\ \le\ 10^5 $
- $ 1\ \le\ A_i\ \le\ 10^5 $

### Sample Explanation 1

例えば、以下のようにメダルを配ることができます。 - $ 1 $ 番目の従業員には、$ 1,\ 5,\ 9 $ 日目にメダルを配る - $ 2 $ 番目の従業員には、$ 2,\ 6,\ 10 $ 日目にメダルを配る - $ 3 $ 番目の従業員には、$ 3,\ 7,\ 8 $ 日目にメダルを配る $ 4 $ 日目には出勤している従業員が $ 1 $ 人もいないため、これは最短となる配り方の $ 1 $ つです。

## 样例 #1

### 输入

```
3 3

1 2 3
```

### 输出

```
10
```

## 样例 #2

### 输入

```
10 10

1 1 1 1 1 1 1 1 1 1
```

### 输出

```
199
```

## 样例 #3

### 输入

```
2 5

1234 5678
```

### 输出

```
10
```



---

---
title: "[ARC106F] Figures"
layout: "post"
diff: 省选/NOI-
pid: AT_arc106_f
tag: []
---

# [ARC106F] Figures

## 题目描述

[problemUrl]: https://atcoder.jp/contests/arc106/tasks/arc106_f

高橋君はフィギュアを組み立てようとしています。このフィギュアは、 $ N $ 個の部品(部品 $ 1 $ , 部品 $ 2 $ , ..., 部品 $ N $ )と、 $ N-1 $ 個の接続用部品から成ります。部品同士は区別が出来ますが、接続用部品同士は区別が出来ません。

部品 $ i $ には、$ d_i $ 個の接続用部品を挿す穴(穴 $ 1 $ , 穴 $ 2 $ , ..., 穴 $ d_i $ )が空いています。各部品の穴同士は区別が出来ます。 各接続用部品は、 $ 2 $ 個の部品の穴に挿し込まれ、それら $ 2 $ 個の部品を接続します。 $ 1 $ つの穴に複数の接続用部品を挿し込むことは出来ません。

以下の性質を満たすフィギュアのことを、完成形と呼びます。

- $ N-1 $ 個の接続用部品が全て部品の接続に使われている。
- 部品を頂点とし、 接続用部品で接続された部品に対応する頂点組に辺が存在する $ N $ 頂点 $ N-1 $ 辺の無向グラフを考えた際に、このグラフは連結である。

$ 2 $ つの完成形について、全ての穴の組についてその $ 2 $ つを接続する接続用部品が存在するか否かが一致するとき、$ 2 $ つの完成形が同じであると見なします。

完成形が何種類あるかを答えてください。 ただし、答えは非常に大きくなることがあるので、 $ 998244353 $ で割った余りを出力してください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ d_1 $ $ d_2 $ $ \cdots $ $ d_N $

## 输出格式

答えを出力せよ。

## 说明/提示

### 制約

- 入力は全て整数
- $ 2\ \leq\ N\ \leq\ 2\ \times\ 10^5 $
- $ 1\ \leq\ d_i\ <\ 998244353 $

### Sample Explanation 1

例えば、部品 $ 1 $ の穴 $ 1 $ と部品 $ 3 $ の穴 $ 3 $ を接続し、部品 $ 2 $ の穴 $ 1 $ と部品 $ 3 $ の穴 $ 1 $ を接続したフィギュアは、完成形として認められます。

## 样例 #1

### 输入

```
3

1 1 3
```

### 输出

```
6
```

## 样例 #2

### 输入

```
3

1 1 1
```

### 输出

```
0
```

## 样例 #3

### 输入

```
6

7 3 5 10 6 4
```

### 输出

```
389183858
```

## 样例 #4

### 输入

```
9

425656 453453 4320 1231 9582 54336 31435436 14342 423543
```

### 输出

```
667877982
```



---

---
title: "[ARC107E] Mex Mat"
layout: "post"
diff: 省选/NOI-
pid: AT_arc107_e
tag: []
---

# [ARC107E] Mex Mat

## 题目描述

[problemUrl]: https://atcoder.jp/contests/arc107/tasks/arc107_e

$ N\ \times\ N $ の行列を考えます。この行列の $ i $ 行目、$ j $ 列目の値を $ a_{i,\ j} $ とします。$ i\ =\ 1 $ か $ j\ =\ 1 $ を満たす $ a_{i,\ j} $ については $ 0 $, $ 1 $, $ 2 $ のいずれかの値が入力で与えられます。残りの値は以下の規則に従い定めます。

- $ a_{i,j}\ =\ \mathrm{mex}(a_{i-1,j},\ a_{i,j-1})\ (2\ \leq\ i,\ j\ \leq\ N) $。ただし $ \mathrm{mex}(x,\ y) $ は次の表に従う。
 
$ \mathrm{mex}(x,\ y) $ $ y=0 $ $ y=1 $ $ y=2 $ $ x=0 $ $ 1 $ $ 2 $ $ 1 $ $ x=1 $ $ 2 $ $ 0 $ $ 0 $ $ x=2 $ $ 1 $ $ 0 $ $ 0 $行列の要素のうち、値が $ 0,\ 1,\ 2 $ であるものはそれぞれ何個でしょうか？

## 输入格式

入力は以下の形式で標準入力から与えられる．

> $ N $ $ a_{1,\ 1} $ $ a_{1,\ 1} $ $ ... $ $ a_{1,\ N} $ $ a_{2,\ 1} $ $ : $ $ a_{N,\ 1} $

## 输出格式

$ 0 $ の個数、$ 1 $ の個数、$ 2 $ の個数を空白区切りで出力せよ。

## 说明/提示

### 制約

- $ 1\ \leq\ N\ \leq\ 500{,}000 $
- 入力される $ a_{i,\ j} $ の値はすべて $ 0,\ 1,\ 2 $ のいずれか

### Sample Explanation 1

行列は以下のようになります。 ``` 1 2 0 2 0 1 2 0 0 2 0 1 0 1 2 0 ```

## 样例 #1

### 输入

```
4

1 2 0 2

0

0

0
```

### 输出

```
7 4 5
```



---

---
title: "[ARC108E] Random IS"
layout: "post"
diff: 省选/NOI-
pid: AT_arc108_e
tag: []
---

# [ARC108E] Random IS

## 题目描述

[problemUrl]: https://atcoder.jp/contests/arc108/tasks/arc108_e

$ N $ 脚のイスが左から右に並んでいます。 左から $ i $ 番目のイスのIDは $ a_i $ です。ここで、$ a_i $ がすべて相異なることが保証されます。

すぬけ君は何脚かのイスに印をつけ、印をつけたイス以外を捨てることにしました。はじめ、どのイスにも印はついていません。 印のついたイスたちのIDが左から右に単調増加になっているような印のつけ方を *よい印のつけ方* と呼びます。

すぬけ君は以下の手続きに従って印をつけることにしました。

1. イス $ x $ に新たに印をつけても印のつけ方がよい印のつけ方のままであるとき、イス $ x $ を *良いイス* とする。現在の良いイスの脚数を $ k $ とする
2. $ k=0 $ なら印のついていないイスを取り除き手続きを終了する。そうでないなら、$ k $ 脚の良いイスから等確率で $ 1 $ つを選んで印をつけ手順 1 へ戻る

手続き終了時に残るイスの脚数の期待値が有理数になることが証明できます。その値を $ P/Q $ (既約分数)とします。また $ M=10^{9}+7 $ とします。このとき、$ 0 $ 以上 $ M-1 $ 以下の整数 $ R $ がただ一つ存在して $ P\ \equiv\ Q\ \times\ R\ \pmod{M} $ となることが証明でき、その値は $ P\ \times\ Q^{-1}\ \pmod{M} $ と等しくなります。ここで、$ Q^{-1} $ はモジュラ逆数です。$ R $ を求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ a_1 $ $ a_2 $ $ \cdots $ $ a_N $

## 输出格式

$ R $ を出力せよ。

## 说明/提示

### 制約

- 与えられる入力は全て整数
- $ 1\ \leq\ N\ \leq\ 2000 $
- $ 1\ \leq\ a_i\ \leq\ N $
- $ a_i $ はすべて相異なる

### Sample Explanation 1

\- はじめにイス $ 1 $(IDが $ 1 $ のイスです) に印がついたとき、最終的に残るイスはイス $ 1,2 $ の $ 2 $ 脚です。 - はじめにイス $ 2 $ に印がついたとき、最終的に残るイスはイス $ 1,2 $ の $ 2 $ 脚です。 - はじめにイス $ 3 $ に印がついたとき、最終的に残るイスはイス $ 3 $ の $ 1 $ 脚です。 - イスは等確率で選ばれるので手続き終了時に残るイスの脚数の期待値は $ \frac{5}{3} $ となります。$ 5\ \equiv\ 3\ \times\ 666666673\ \pmod{M} $ より、$ R=666666673 $ です。

## 样例 #1

### 输入

```
3

3 1 2
```

### 输出

```
666666673
```

## 样例 #2

### 输入

```
30

26 16 28 30 23 11 29 18 22 15 20 13 27 9 21 7 5 25 4 19 8 3 1 24 10 14 17 12 2 6
```

### 输出

```
297703424
```



---

---
title: "[ARC108F] Paint Tree"
layout: "post"
diff: 省选/NOI-
pid: AT_arc108_f
tag: []
---

# [ARC108F] Paint Tree

## 题目描述

[problemUrl]: https://atcoder.jp/contests/arc108/tasks/arc108_f

$ 1 $ から $ N $ の番号がついた $ N $ 個の頂点と、$ 1 $ から $ N-1 $ の番号がついた $ N-1 $ 本の辺からなる木が与えられます。 辺 $ i $ は頂点 $ a_i $ と頂点 $ b_i $ を双方向につなぐ長さ $ 1 $ の辺です。

すぬけ君はそれぞれの頂点を白か黒のどちらかで塗ります。 塗り方の *良さ* は、白色の頂点同士の距離の最大値を $ X $、黒色の頂点同士の距離の最大値を $ Y $ として $ \max(X,Y) $ です。 ここで、その色の頂点が存在しない場合の距離の最大値は $ 0 $ とすることにします。

頂点への色の塗り方は $ 2^N $ 通りあります。それぞれの塗り方について良さを計算し、その総和を $ 10^{9}+7 $ で割ったあまりを求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ a_1 $ $ b_1 $ $ \vdots $ $ a_{N-1} $ $ b_{N-1} $

## 输出格式

それぞれの塗り方について良さを計算し、その総和を $ 10^{9}+7 $ で割ったあまりを出力せよ。

## 说明/提示

### 制約

- 与えられる入力は全て整数
- $ 2\ \leq\ N\ \leq\ 2\ \times\ 10^{5} $
- $ 1\ \leq\ a_i,\ b_i\ \leq\ N $
- 与えられるグラフは木

### Sample Explanation 1

\- 頂点 $ 1,2 $ の両方を同じ色で塗ったときの良さは $ 1 $ で、異なる色で塗ったときの良さは $ 0 $ です。 - 塗り方の良さの総和は $ 2 $ となります。

### Sample Explanation 3

\- $ 10^{9}+7 $ で割ったあまりを求めるのを忘れずに。

## 样例 #1

### 输入

```
2

1 2
```

### 输出

```
2
```

## 样例 #2

### 输入

```
6

1 2

2 3

3 4

4 5

3 6
```

### 输出

```
224
```

## 样例 #3

### 输入

```
35

25 4

33 7

11 26

32 4

12 7

31 27

19 6

10 22

17 12

28 24

28 1

24 15

30 24

24 11

23 18

14 15

4 29

33 24

15 34

11 3

4 35

5 34

34 2

16 19

7 18

19 31

22 8

13 26

20 6

20 9

4 33

4 8

29 19

15 21
```

### 输出

```
298219707
```



---

---
title: "[ARC109E] 1D Reversi Builder"
layout: "post"
diff: 省选/NOI-
pid: AT_arc109_e
tag: []
---

# [ARC109E] 1D Reversi Builder

## 题目描述

[problemUrl]: https://atcoder.jp/contests/arc109/tasks/arc109_e

黒石さんと白石さんは、一列に並んだ $ n $ 個のマスからなる盤面を使って遊んでいます。 マスにはそれぞれ $ 1 $ から $ n $ の整数が順番に振られていて、マス $ s $ に印がつけられています。

まず、黒石さんは、各マスについて独立に、黒か白を等確率で選んで塗ります。その後、マス $ s $ にマスの色と同じ色の石を置きます。

黒石さんと白石さんは、この盤面と無限個の黒い石と白い石を使ったゲームをします。このゲームでは、黒石さんから始めて、黒石さんと白石さんが交互に次の手順で石を置いていきます。

1. 石が置かれているマスと隣接している空きマスをひとつ選ぶ。マス $ i $ を選んだとする。
2. マス $ i $ に、マスと同じ色の石をおく。
3. 置いた石と同じ色の石がマス $ i $ 以外に置かれているとき、そのうちマス $ i $ に最も近い石と、マス $ i $ の間にあるすべての石の色をマス $ i $ の色に変更する

空きマスが存在しなくなったときにゲームが終了します。

黒石さんはゲーム終了時の黒い石の個数を最大化するために最適な行動をし、白石さんはゲーム終了時の白い石の個数を最大化するために最適な行動をします。

$ s=1,\dots,n $ それぞれの場合について、ゲーム終了時の黒い石の個数の期待値を $ \text{mod\ }998244353 $ で求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ n $

## 输出格式

$ n $ 個の値を出力せよ。 $ i $ 個目には、$ s=i $ としたときのゲーム終了時の黒い石の個数の期待値を $ \text{mod\ }998244353 $ で出力せよ。

## 说明/提示

### 注意

求める期待値が既約分数 $ p/q $ で表されるとき、$ rq\equiv\ p\ ~(\text{mod\ }\ 998244353) $ かつ $ 0\ \leq\ r\ \lt\ 998244353 $ を満たす整数 $ r $ がこの問題の制約のもとで一意に定まります。この $ r $ が求める値です。

### 制約

- $ 1\ \leq\ n\ \leq\ 2\times\ 10^5 $

### Sample Explanation 1

黒マスを `b` で、白マスを `w` で表すことにします。 盤面として、`www`, `wwb`, `wbw`, `wbb`, `bww`, `bwb`, `bbw`, `bbb` の $ 8 $ 通りがあり、これらから等確率に $ 1 $ つが選ばれます。 $ s $ によらず、それぞれの盤面について、ゲーム終了時の黒い石の個数は $ 0,1,0,2,1,3,2,3 $ となります。 よって、期待値は $ (0+1+0+2+1+3+2+3)/8\ =\ 3/2 $ となるため、答えは $ 2r\ \equiv\ 3\ ~(\text{mod\ }\ 998244353) $ かつ $ 0\ \leq\ r\ \lt\ 998244353 $ を満たす $ r\ =\ 499122178 $ となります。

## 样例 #1

### 输入

```
3
```

### 输出

```
499122178

499122178

499122178
```

## 样例 #2

### 输入

```
10
```

### 输出

```
5

5

992395270

953401350

735035398

735035398

953401350

992395270

5

5
```

## 样例 #3

### 输入

```
19
```

### 输出

```
499122186

499122186

499110762

499034602

498608106

496414698

485691370

434999274

201035754

138645483

201035754

434999274

485691370

496414698

498608106

499034602

499110762

499122186

499122186
```



---

---
title: "[ARC110F] Esoswap"
layout: "post"
diff: 省选/NOI-
pid: AT_arc110_f
tag: []
---

# [ARC110F] Esoswap

## 题目描述

[problemUrl]: https://atcoder.jp/contests/arc110/tasks/arc110_f

$ 0,\ 1,\ \ldots,\ N\ -\ 1 $ を並び替えた数列 $ P\ =\ P_0,\ P_1,\ \ldots,\ P_{N\ -\ 1} $ があります。

あなたは $ P $ に対して、以下の操作を最大 $ 2\ \times\ 10^5 $ 回まで行うことができます。

- 整数 $ i\ ~\ (0\ \leq\ i\ \leq\ N\ -\ 1) $ を宣言する。$ P_i $ と $ P_{(i\ +\ P_i)\ \textrm{\ mod\ }\ N} $ を入れ替える

適切に操作を行うことで、$ P $ を昇順に並び替えてください。もしそれが不可能な場合、`-1` を出力してください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ P_0 $ $ P_1 $ $ \ldots $ $ P_{N\ -\ 1} $

## 输出格式

$ 2\ \times\ 10^5 $ 回以下の操作で $ P $ を昇順に並び替えることが不可能な場合、`-1` を出力せよ。

$ 2\ \times\ 10^5 $ 回以下の操作で $ P $ を昇順に並び替えることが可能な場合、$ K $ 回操作を行うとして、以下の形式で $ K\ +\ 1 $ 行出力せよ。

- $ 1 $ 行目は整数 $ K $
- $ 1\ +\ i~(1\ \leq\ i\ \leq\ K) $ 行目は、$ i $ 回目の操作で宣言する整数 $ j\ ~\ (0\ \leq\ j\ \leq\ N\ -\ 1) $

操作回数を最小化する必要はない。 また、$ 2\ \times\ 10^5 $ 回以下の操作で $ P $ を昇順に並び替える操作列が複数存在する場合、どれを出力しても構わない。

## 说明/提示

### 制約

- 入力は全て整数
- $ 2\ \leq\ N\ \leq\ 100 $
- $ P $ は $ 0,\ 1,\ \ldots,\ N\ -\ 1 $ を並び替えた数列

### Sample Explanation 1

この操作列は、以下のように $ P $ を昇順に並び替えます。 - まず $ i $ として $ 6 $ を宣言し、$ P_6\ (=\ 5) $ と $ P_{(6\ +\ 5)\ \textrm{\ mod\ }\ 8}\ =\ P_3\ (=\ 6) $ を入れ替える。$ P $ は $ 7,\ 1,\ 2,\ 5,\ 4,\ 0,\ 6,\ 3 $ になる - 次に $ i $ として $ 0 $ を宣言し、$ P_0\ (=\ 7) $ と $ P_{(0\ +\ 7)\ \textrm{\ mod\ }\ 8}\ =\ P_7\ (=\ 3) $ を入れ替える。$ P $ は $ 3,\ 1,\ 2,\ 5,\ 4,\ 0,\ 6,\ 7 $ になる - 次に $ i $ として $ 3 $ を宣言し、$ P_3\ (=\ 5) $ と $ P_{(3\ +\ 5)\ \textrm{\ mod\ }\ 8}\ =\ P_0\ (=\ 3) $ を入れ替える。$ P $ は $ 5,\ 1,\ 2,\ 3,\ 4,\ 0,\ 6,\ 7 $ になる - 次に $ i $ として $ 0 $ を宣言し、$ P_0\ (=\ 5) $ と $ P_{(0\ +\ 5)\ \textrm{\ mod\ }\ 8}\ =\ P_5\ (=\ 0) $ を入れ替える。$ P $ は $ 0,\ 1,\ 2,\ 3,\ 4,\ 5,\ 6,\ 7 $ になる

## 样例 #1

### 输入

```
8

7 1 2 6 4 0 5 3
```

### 输出

```
4

6

0

3

0
```



---

---
title: "[ARC111E] Simple Math 3"
layout: "post"
diff: 省选/NOI-
pid: AT_arc111_e
tag: []
---

# [ARC111E] Simple Math 3

## 题目描述

[problemUrl]: https://atcoder.jp/contests/arc111/tasks/arc111_e

この問題では一つの入力につきテストケースが $ T $ 個与えられます。

整数 $ A $, $ B $, $ C $, $ D $ が与えられます。次の条件を満たす正整数 $ i $ はいくつあるか求めてください。

- $ A\ +\ B\ \times\ i $ 以上 $ A\ +\ C\ \times\ i $ 以下の整数はいずれも、$ D $ の倍数ではない。

なお、制約より答えが有限であることが証明できます。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ T $ $ A_1 $ $ B_1 $ $ C_1 $ $ D_1 $ $ : $ $ A_T $ $ B_T $ $ C_T $ $ D_T $

## 输出格式

$ T $ 行出力せよ。

$ i $ 行目には、$ i $ ケース目 ($ A_i $, $ B_i $, $ C_i $, $ D_i $) の答えを出力せよ。

## 说明/提示

### 制約

- $ 1\ \leq\ T\ \leq\ 10{,}000 $
- $ 1\ \leq\ A\ <\ D $
- $ 0\ \leq\ B\ <\ C\ <\ D $
- $ 2\ \leq\ D\ \leq\ 10^8 $

### Sample Explanation 1

$ 1 $ ケース目の $ (A\ +\ B\ \times\ i,\ A\ +\ C\ \times\ i) $ を列挙すると次のようになります。 $ i\ =\ 3 $ のみ条件を満たすことがわかります。 - $ i\ =\ 1:\ (4,\ 5) $ - $ i\ =\ 2:\ (5,\ 7) $ - $ i\ =\ 3:\ (6,\ 9) $ - $ i\ =\ 4:\ (7,\ 11) $ - $ i\ =\ 5:\ (8,\ 13) $ - :

## 样例 #1

### 输入

```
2

3 1 2 5

99 101 103 105
```

### 输出

```
1

25
```



---

---
title: "[ARC111F] Do you like query problems?"
layout: "post"
diff: 省选/NOI-
pid: AT_arc111_f
tag: []
---

# [ARC111F] Do you like query problems?

## 题目描述

[problemUrl]: https://atcoder.jp/contests/arc111/tasks/arc111_f

yosupoくんはクエリの問題が大好きなので、次のような問題を作りました。

- - - - - -

> **A Query Problem**
> 
> 長さ $ N $ の整数列 $ a_1,\ldots,a_N $ があります。はじめは $ a_i\ =\ 0\ (1\ \leq\ i\ \leq\ N) $ です。 また、$ ans $ という変数があり、はじめは $ ans\ =\ 0 $ です。 ここに、次の形式のクエリが $ Q $ 個来ます。
> 
> - クエリ1:
>   
>   
>   - $ t_i\ (=1) $ $ l_i $ $ r_i $ $ v_i $
>   - 各 $ j\ =\ l_i,\ldots,r_i $ に対して、$ a_j\ :=\ \min(a_j,v_i) $
> - クエリ2:
>   
>   
>   - $ t_i\ (=2) $ $ l_i $ $ r_i $ $ v_i $
>   - 各 $ j\ =\ l_i,\ldots,r_i $ に対して、$ a_j\ :=\ \max(a_j,v_i) $
> - クエリ3:
>   
>   
>   - $ t_i\ (=3) $ $ l_i $ $ r_i $
>   - $ a_{l_i}\ +\ \ldots\ +\ a_{r_i} $ を計算して、$ ans $ に足す
> 
> 最終的な $ ans $ の値を出力してください。
> 
> ただし、各クエリについて、$ 1 $ $ \leq $ $ l_i $ $ \leq $ $ r_i $ $ \leq $ $ N $ が、さらにクエリ1,2については $ 0 $ $ \leq $ $ v_i $ $ \leq $ $ M-1 $ が成立する。

- - - - - -

この問題を見たmaroonくんは簡単すぎると感じたため、次の問題を考えました。

- - - - - -

> **Query Problems**
> 
> 正整数 $ N,M,Q $ が与えられます。問題 "A Query Problem" に対する入力は $ (\ \frac{(N+1)N}{2}\ \cdot\ (M+M+1)\ )^Q $ 通りありますが、それらに対する出力のすべての和を $ 998{,}244{,}353 $ で割った余りを求めてください。

- - - - - -

求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ M $ $ Q $

## 输出格式

答えを出力せよ。

## 说明/提示

### 制約

- $ 1\ \leq\ N,M,Q\ \leq\ 200000 $
- 入力される数はすべて整数

### Sample Explanation 1

ありうる入力は $ 25 $ 通りありますが、そのうち $ ans $ が正になるような入力は、次の一通りです: $ t_1\ =\ 2,\ l_1\ =\ 1,\ r_1\ =\ 1,\ v_1\ =\ 1,\ t_2\ =\ 3,\ l_2\ =\ 1,\ r_2\ =\ 1 $ このとき $ ans $ は $ 1 $ になるので、答えは $ 1 $ です。

## 样例 #1

### 输入

```
1 2 2
```

### 输出

```
1
```

## 样例 #2

### 输入

```
3 1 4
```

### 输出

```
0
```

## 样例 #3

### 输入

```
111 112 113
```

### 输出

```
451848306
```



---

---
title: "[ARC112E] Cigar Box"
layout: "post"
diff: 省选/NOI-
pid: AT_arc112_e
tag: []
---

# [ARC112E] Cigar Box

## 题目描述

[problemUrl]: https://atcoder.jp/contests/arc112/tasks/arc112_e

数列 $ (1,2,\dots,n) $ に対して、以下の操作をちょうど $ m $ 回繰り返したところ、$ (a_1,\dots\ ,a_n) $ になりました。

- 項を $ 1 $ つ選んで消す。その後、消した項を数列の先頭か末尾に付け加える。

$ m $ 回の操作列としてありうるものの数を $ 998244353 $ で割ったあまりを求めてください。

ただし、$ 2 $ つの操作列が同じであるとは、「どの操作についても、選んだ項と付け加えた位置がどちらも等しいこと」とします。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ n $ $ m $ $ a_1 $ $ \dots $ $ a_n $

## 输出格式

操作列としてありうるものの数を $ 998244353 $ で割ったあまりを出力せよ。

## 说明/提示

### 制約

- $ 2\le\ n\ \le\ 3000 $
- $ 1\le\ m\ \le\ 3000 $
- $ a_1,\dots\ ,a_n $ は $ 1,\dots,n $ の順列

### Sample Explanation 1

以下の $ 5 $ 通りの操作列がありえます。 - $ 1 $ を消して先頭に付け加える。数列は $ (1,2,3,4,5) $ となる。その後、$ 3 $ を消して末尾に付け加える。数列は $ (1,2,4,5,3) $ となる。 - $ 3 $ を消して先頭に付け加える。数列は $ (3,1,2,4,5) $ となる。その後、$ 3 $ を消して末尾に付け加える。数列は $ (1,2,4,5,3) $ となる。 - $ 3 $ を消して末尾に付け加える。数列は $ (1,2,4,5,3) $ となる。その後、$ 1 $ を消して先頭に付け加える。数列は $ (1,2,4,5,3) $ となる。 - $ 3 $ を消して末尾に付け加える。数列は $ (1,2,4,5,3) $ となる。その後、$ 3 $ を消して末尾に付け加える。数列は $ (1,2,4,5,3) $ となる。 - $ 5 $ を消して末尾に付け加える。数列は $ (1,2,3,4,5) $ となる。その後、$ 3 $ を消して末尾に付け加える。数列は $ (1,2,4,5,3) $ となる。

### Sample Explanation 2

$ 4 $ 種類の操作のうち、$ 2 $ 種類では数列が全く変わらず、もう $ 2 $ 種類では $ 2 $ 項が入れ替わります。 このことから、全ての操作列のうち半分である $ 4^m/2\ =\ 2^{31}\ =\ 2147483648 $ が求める操作列の数であることが示せます。 よって、$ 2147483648 $ を $ 998244353 $ で割ったあまりである $ 150994942 $ が答えです。

## 样例 #1

### 输入

```
5 2

1 2 4 5 3
```

### 输出

```
5
```

## 样例 #2

### 输入

```
2 16

1 2
```

### 输出

```
150994942
```

## 样例 #3

### 输入

```
10 3000

3 7 10 1 9 5 4 8 6 2
```

### 输出

```
129989699
```



---

---
title: "[ARC113E] Rvom and Rsrev"
layout: "post"
diff: 省选/NOI-
pid: AT_arc113_e
tag: []
---

# [ARC113E] Rvom and Rsrev

## 题目描述

给定只由$a$,$b$组成的一个字符串$S$，你可以做以下操作任意次，使最终的字符串字典序最大。

- 选择$S$的两个相同的字符，将它们之间的字符串翻转，并删掉所选择的两个字符。

比如在$S$中选择两个位置$i,j(s_i=s_j,i<j)$，你可以将字符串$S$替换为$s_1\dots s_{i-1}s_{j-1}s_{j-2}\dots s_{i+2}s_{i+1}s_{j+1}s_{j+2}\dots s_{|S|}$

有$T$组数据

## 输入格式

第一行一个整数$T$.
接下来$T$行，每行一个字符串$S$.

## 输出格式

$T$行，一行一个字符串，对每一组测试数据，输出字典序最大的字符串。

## 说明/提示

$
1\le T\le 2\times 10^5\\
1\le |S_i|(i=1,2\dots ,T)\\
1\le |S_1|+|S_2|+\dots +|S_T|\le 2\times 10^5
$

## 样例 #1

### 输入

```
20

abbaa

babbb

aabbabaa

aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa

bbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbb

bbabaaaaabbaababaaabbabbbbbaaaaa

babbbaaaabaababbbabaabaaaaababaa

bbaababababbbaaabaabababaabbabab

abaabbabaabaaaaabaaaabbaabaaaaab

aabababbabbabbabbaaaabbabbbabaab

aabababbabbbbaaaabbaaaaabbaaaabb

abbbbaabaaabababaaaababababbaabb

aaaaaaaaaaaaaaaaaaaaaaabbbbbbbbb

aaaaaaaaaabbbbbbbbbbbbbbbbbbbbbb

abababaaababaaabbbbbaaaaaaabbbbb

aabbaaaaababaabbbbbbbbbaabaaabbb

babababbababbbababbbbbababbbabbb

bbbbababbababbbabababbabbabbbbbb

aaaaaaaaaaaaaaaaababababbbabbbbb

aabababbabbabababababababbbbabbb
```

### 输出

```
bba

bba

bbba

aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa

bbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbb

bbbbbbbbbbbbbbaaaaaaaa

bbbbbbbbbbbbbaaaaaaa

bbbbbbbbbbbbbbbb

bbbbbbbbbb

bbbbbbbbbbbbbbbbab

bbbbbbbbbbbbbb

bbbbbbbbbbbbbabb

abbbbbbbbb

bbbbbbbbbbbbbbbbbbbbbb

bbbbbbbbbbbbbaaaaaaaaa

bbbbbbbbbbbbbbbaaaaa

bbbbbbbbbbbbbbbbbbbbbb

bbbbbbbbbbbbbbbbbbbbba

bbbbbbbbbaaaaaaaaaaaaaaa

bbbbbbbbbbbbbbbbba
```



---

---
title: "[ARC114D] Moving Pieces on Line"
layout: "post"
diff: 省选/NOI-
pid: AT_arc114_d
tag: []
---

# [ARC114D] Moving Pieces on Line

## 题目描述

[problemUrl]: https://atcoder.jp/contests/arc114/tasks/arc114_d

$ X\ =\ 10^{100} $ として，各整数 $ -X\ \leq\ i\ \leq\ X $ に対応する頂点があり，$ -X\ \leq\ i\ \leq\ X-1 $ について頂点 $ i,\ i\ +\ 1 $ を結ぶ無向辺 (以降，辺 $ \{\ i,\ i\ +\ 1\ \} $ と呼ぶ) があるグラフがあります．

このグラフの辺は初めすべて赤く塗られています．また，$ N $ 個 のコマがあり，$ i $ 個目のコマは頂点 $ a_i $ に置かれています．

maroon 君は次の操作を行うことができます．

- コマを $ 1 $ つ選ぶ． このコマが頂点 $ i $ にあるとき，コマを頂点 $ i-1 $ または頂点 $ i+1 $ に動かし，通った辺を，現在の色が赤なら青，青なら赤に塗り替える．

操作の過程で，同じ頂点に複数のコマが存在しても構いません．

maroon 君はこれから上記の操作を $ 0 $ 回以上繰り返して，辺の色の組合せを目的の状態にしたいと思っています．目的の状態は 偶数 $ K $ と，$ K $ 個の整数 $ t_1\ <\ t_2\ <\ \cdots\ <\ t_K $ で表され，$ i\ <\ t_1 $ について辺 $ \{\ i,\ i\ +\ 1\ \} $ は赤，$ t_1\ \leq\ i\ <\ t_2 $ について辺 $ \{\ i,\ i\ +\ 1\ \} $ は青，$ \cdots,\ t_K\ \leq\ i $ について辺 $ \{\ i,\ i\ +\ 1\ \} $ は赤 という状態です．より正確には，各奇数 $ j\ =\ 1,\ 3,\ \cdots,\ K-1 $ に対して，$ t_j\ \leq\ i\ <\ t_{j+1} $ を満たす $ i $ について辺 $ \{\ i,\ i\ +\ 1\ \} $ は青で，それ以外の辺はすべて赤です．

maroon 君が辺の色の組合せを目的の状態にするために必要な操作回数の最小値を求めてください．また，そのような操作が不可能であるなら $ -1 $ を出力してください．

## 输入格式

入力は以下の形式で標準入力から与えられる．

> $ N $ $ K $ $ a_1 $ $ a_2 $ $ \cdots $ $ a_N $ $ t_1 $ $ t_2 $ $ \cdots $ $ t_K $

## 输出格式

maroon 君が辺の色の組合せを目的の状態にするために必要な操作回数の最小値を出力せよ．また，そのような操作が不可能であるなら $ -1 $ を出力せよ．

## 说明/提示

### 制約

- $ 1\ \leq\ N\ \leq\ 5000 $
- $ 2\ \leq\ K\ \leq\ 5000 $
- $ K $ は偶数
- $ |a_i|\ \leq\ 10^9 $
- $ |t_i|\ \leq\ 10^9 $
- $ t_i\ <\ t_{i+1} $
- 入力は全て整数

### Sample Explanation 1

例えば以下のように $ 4 $ 回の操作で目的の状態にでき，$ 4 $ 本の辺の色を変える必要があるのでこれが最適です． これは初めの状態です．便宜上 $ -3 $ より左と $ 3 $ より右の辺は省いています． !\[0\](https://img.atcoder.jp/arc114/cfe333a77072f2bb54812c06d62de656.png) $ -1 $ にあるコマを $ -2 $ に動かすと次の状態になります． !\[1\](https://img.atcoder.jp/arc114/93c2fca818e0d1a8069b70919a043d21.png) $ 2 $ にあるコマを $ 1 $ に動かすと次の状態になります． !\[2\](https://img.atcoder.jp/arc114/f7520729ea3f02659eef7df2d17c1363.png) $ 1 $ にあるコマを $ 0 $ に動かすと次の状態になります． !\[3\](https://img.atcoder.jp/arc114/fa295d290a5de5c01f66934899fb6280.png) $ 0 $ にあるコマを $ -1 $ に動かすと次の状態になり，これが目的の状態です． !\[last\](https://img.atcoder.jp/arc114/eab39d19d0973644aa27e8c695ab5812.png)

### Sample Explanation 2

初めから同じ頂点に複数のコマがある場合もあります．

## 样例 #1

### 输入

```
2 2

2 -1

-2 2
```

### 输出

```
4
```

## 样例 #2

### 输入

```
2 2

2 2

5 8
```

### 输出

```
9
```

## 样例 #3

### 输入

```
3 4

1 3 5

0 2 4 6
```

### 输出

```
-1
```

## 样例 #4

### 输入

```
4 4

3 4 5 6

3 4 5 6
```

### 输出

```
2
```



---

---
title: "[ARC114E] Paper Cutting 2"
layout: "post"
diff: 省选/NOI-
pid: AT_arc114_e
tag: []
---

# [ARC114E] Paper Cutting 2

## 题目描述

[problemUrl]: https://atcoder.jp/contests/arc114/tasks/arc114_e

$ H\ \times\ W $ のマス目に区切られた長方形の紙があり，このうちちょうど $ 2 $ マスが黒く，残りの部分は白く塗られています．マス目の $ i $ 行目，$ j $ 列目にあるマスを $ (i,\ j) $ で表すと，黒く塗られているのはマス $ (h_1,\ w_1) $ とマス $ (h_2,\ w_2) $ です．

maroon 君はこれから以下の手順で紙を切断する操作を繰り返します．

- 現在の紙のマス目が $ h\ \times\ w $ の時，紙の辺に平行でマスの境界を通るような直線には，$ (h\ -\ 1) $ 本の横線と $ (w\ -\ 1) $ 本の縦線がある．この中から $ 1 $ 本を一様ランダムに選んで，その直線に沿って紙を $ 2 $ 枚に切断する．このとき，
  - $ 2 $ つの黒いマスが同じ紙に存在するとき，もう片方の紙を捨て，操作を続ける
  - そうでなければ，操作を終了する

maroon 君が操作を終了するまでに紙を切断する回数の期待値を $ {\bmod}\ 998244353 $ で求めてください．

## 输入格式

入力は以下の形式で標準入力から与えられる．

> $ H $ $ W $ $ h_1 $ $ w_1 $ $ h_2 $ $ w_2 $

## 输出格式

maroon 君が操作を終了するまでに紙を切断する回数の期待値を $ {\bmod}\ 998244353 $ で出力せよ．

## 说明/提示

### 注記

求める期待値は必ず有理数になることが証明できます．またこの問題の制約のもとでは，その値を既約分数 $ \frac{P}{Q} $ で表した時，$ Q\ \not\ \equiv\ 0\ \pmod{998244353} $ となることも証明できます．よって，$ R\ \times\ Q\ \equiv\ P\ \pmod{998244353},\ 0\ \leq\ R\ <\ 998244353 $ を満たす整数 $ R $ が一意に定まります．この $ R $ を答えてください．

### 制約

- $ 1\ \leq\ H,\ W\ \leq\ 10^5 $
- $ H\ \times\ W\ \geq\ 2 $
- $ 1\ \leq\ h_1,\ h_2\ \leq\ H $
- $ 1\ \leq\ w_1,\ w_2\ \leq\ W $
- $ (h_1,\ w_1)\ \neq\ (h_2,\ w_2) $
- 入力は全て整数

### Sample Explanation 1

まず，$ 1 $ 回目の切断で確率 $ 2/3 $ で操作が終了します．残りの $ 1/3 $ については，次の切断で操作が終了します． よって，紙を切断する回数の期待値は，$ 1\ \times\ 2/3\ +\ 2\ \times\ 1/3\ =\ 4/3 $ です．

### Sample Explanation 3

操作は $ 1 $ 回の切断で必ず終了します．

## 样例 #1

### 输入

```
2 3

2 2 1 1
```

### 输出

```
332748119
```

## 样例 #2

### 输入

```
1 5

1 2 1 3
```

### 输出

```
332748120
```

## 样例 #3

### 输入

```
2 1

2 1 1 1
```

### 输出

```
1
```

## 样例 #4

### 输入

```
10 10

3 4 5 6
```

### 输出

```
831078040
```



---

---
title: "[ARC115F] Migration"
layout: "post"
diff: 省选/NOI-
pid: AT_arc115_f
tag: []
---

# [ARC115F] Migration

## 题目描述

[problemUrl]: https://atcoder.jp/contests/arc115/tasks/arc115_f

$ N $ 頂点の木が与えられます。頂点には $ 1,\ \ldots,N $ の番号がついており、$ i $ 番目の辺は頂点 $ u_i $ と頂点 $ v_i $ をつないでいます。また、頂点 $ i $ には整数 $ h_i $ が書かれています。  
 駒が $ K $ 個あり、$ i $ 番目の駒ははじめ頂点 $ s_i $ に置かれています。あなたはこれから「一つ駒を選び、それが現在置かれている頂点に隣接するいずれかの頂点に移動させる」という操作を繰り返します。 各駒 $ i $ が頂点 $ t_i $ に置かれている状態になったら操作を終了します。各駒 $ i $ を頂点 $ s_i $ から頂点 $ t_i $ へ最短経路で移動させる必要は**ありません**。  
 ある駒の配置に対して、それぞれの駒が置かれている頂点に書かれた整数を足し合わせた値を**ポテンシャル**と呼ぶことにします。ただし、同じ頂点に複数の駒がある場合、その頂点の整数はその駒の個数だけ足し合わせるものとします。  
 操作を通してのポテンシャルの最大値は最小でいくつになるか求めてください。ただし、はじめの状態と終わりの状態も考えるものとします。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ h_1 $ $ h_2 $ $ \ldots $ $ h_N $ $ u_1 $ $ v_1 $ $ u_2 $ $ v_2 $ $ : $ $ u_{N-1} $ $ v_{N-1} $ $ K $ $ s_1 $ $ t_1 $ $ s_2 $ $ t_2 $ $ : $ $ s_K $ $ t_K $

## 输出格式

答えを出力せよ。

## 说明/提示

### 制約

- $ 1\ \leq\ N,K\ \leq\ 2000 $
- $ 1\ \leq\ u_i,v_i\ \leq\ N $
- $ 1\ \leq\ h_i\ \leq\ 10^9 $
- $ 1\ \leq\ s_i,t_i\ \leq\ N $
- 与えられるグラフは木

### Sample Explanation 1

以下のように操作をすることで操作を通してのポテンシャルの最大値は $ 4 $ となります。 - はじめ、ポテンシャルは $ 3 $。 - 駒 $ 2 $ を頂点 $ 2 $ に移動させる。ポテンシャルは $ 4 $ になる。 - 駒 $ 2 $ を頂点 $ 1 $ に移動させる。ポテンシャルは $ 2 $ になる。 - 駒 $ 1 $ を頂点 $ 2 $ に移動させる。ポテンシャルは $ 4 $ になる。 - 駒 $ 1 $ を頂点 $ 3 $ に移動させる。ポテンシャルは $ 3 $ になる。 ポテンシャルの最大値が $ 4 $ より小さくなるような操作の方法は存在しないため、$ 4 $ が答えです。

## 样例 #1

### 输入

```
3

1 3 2

1 2

2 3

2

1 3

3 1
```

### 输出

```
4
```

## 样例 #2

### 输入

```
7

100 101 1 100 101 1 1000

1 2

2 3

4 5

5 6

1 7

4 7

2

1 3

4 6
```

### 输出

```
201
```

## 样例 #3

### 输入

```
5

2 1 100 5 6

1 2

2 3

3 4

3 5

2

2 2

4 5
```

### 输出

```
101
```

## 样例 #4

### 输入

```
4

1 2 3 100

1 4

2 4

3 4

9

1 1

1 2

1 3

2 1

2 2

2 3

3 1

3 2

3 3
```

### 输出

```
115
```

## 样例 #5

### 输入

```
6

1 100 1 1 10 1000

1 2

2 3

4 5

1 6

4 6

3

1 3

5 5

5 5
```

### 输出

```
102
```



---

---
title: "[ARC118D] Hamiltonian Cycle"
layout: "post"
diff: 省选/NOI-
pid: AT_arc118_d
tag: []
---

# [ARC118D] Hamiltonian Cycle

## 题目描述

[problemUrl]: https://atcoder.jp/contests/arc118/tasks/arc118_d

素数 $ P $ および正の整数 $ a,\ b $ が与えられます。 $ P $ 項からなる整数列 $ A\ =\ (A_1,\ A_2,\ \ldots,\ A_P) $ であって、次の条件をすべて満たすものが存在するかを判定してください。 存在する場合には、そのようなものをひとつ出力してください。

- $ 1\leq\ A_i\leq\ P\ -\ 1 $
- $ A_1\ =\ A_P\ =\ 1 $
- $ (A_1,\ A_2,\ \ldots,\ A_{P-1}) $ は、$ (1,\ 2,\ \ldots,\ P-1) $ を並べ替えたものである
- 任意の $ 2\leq\ i\leq\ P $ に対して、次のうち少なくともひとつが成り立つ：
  - $ A_{i}\ \equiv\ aA_{i-1}\pmod{P} $
  - $ A_{i-1}\ \equiv\ aA_{i}\pmod{P} $
  - $ A_{i}\ \equiv\ bA_{i-1}\pmod{P} $
  - $ A_{i-1}\ \equiv\ bA_{i}\pmod{P} $

## 输入格式

入力は以下の形式で標準入力から与えられます。

> $ P $ $ a $ $ b $

## 输出格式

問題の条件を満たす整数列 $ A $ が存在するならば `Yes` を、そうでなければ `No` を出力してください。 `Yes` の場合には、$ 2 $ 行目にそのような整数列 $ A $ の各要素を、空白で区切って 1 行で出力してください。

> $ A_1 $ $ A_2 $ $ \ldots $ $ A_P $

条件を満たす整数列が複数存在する場合は、どれを出力しても正解となります。

## 说明/提示

### 制約

- $ 2\leq\ P\leq\ 10^5 $
- $ P $ は素数
- $ 1\leq\ a,\ b\ \leq\ P\ -\ 1 $

### Sample Explanation 1

$ P\ =\ 13 $ を法として、 - $ A_2\equiv\ 5A_1 $ - $ A_2\equiv\ 4A_3 $ - $ \vdots $ - $ A_{13}\equiv\ 4A_{12} $ が成り立ち、この整数列は条件を満たすことが確認できます。

## 样例 #1

### 输入

```
13 4 5
```

### 输出

```
Yes

1 5 11 3 12 9 7 4 6 8 2 10 1
```

## 样例 #2

### 输入

```
13 1 2
```

### 输出

```
Yes

1 2 4 8 3 6 12 11 9 5 10 7 1
```

## 样例 #3

### 输入

```
13 9 3
```

### 输出

```
No
```

## 样例 #4

### 输入

```
13 1 1
```

### 输出

```
No
```



---

---
title: "[ARC119D] Grid Repainting 3"
layout: "post"
diff: 省选/NOI-
pid: AT_arc119_d
tag: []
---

# [ARC119D] Grid Repainting 3

## 题目描述

[problemUrl]: https://atcoder.jp/contests/arc119/tasks/arc119_d

$ H $ 行 $ W $ 列のマス目で表されるキャンバスがあり、上から $ i $ $ (1\ \leq\ i\ \leq\ H) $ 行目・左から $ j $ $ (1\ \leq\ j\ \leq\ W) $ 列目のマスを $ (i,\ j) $ と表します。最初、マス $ (i,\ j) $ は $ s_{i,\ j}= $ `R` のとき赤色で、$ s_{i,\ j}= $ `B` のとき青色で塗られています。

あなたは「次の $ 2 $ つのうち一方を選んで操作すること」を何回でも行うことができます。

> **操作X** 赤色で塗られているマスを $ 1 $ つ選び、そのマスと同じ行にあるすべてのマス（自分自身を含む）を白色に塗り替える。  
> **操作Y** 赤色で塗られているマスを $ 1 $ つ選び、そのマスと同じ列にあるすべてのマス（自分自身を含む）を白色に塗り替える。

最終的に白色で塗られたマスの個数を最大にするような、操作手順の一例を示してください。

## 输入格式

入力は以下の形式で標準入力から与えられます。

> $ H $ $ W $ $ s_{1,\ 1} $$ s_{1,\ 2} $$ s_{1,\ 3} $$ \cdots $$ s_{1,\ W} $ $ s_{2,\ 1} $$ s_{2,\ 2} $$ s_{2,\ 3} $$ \cdots $$ s_{2,\ W} $ $ s_{3,\ 1} $$ s_{3,\ 2} $$ s_{3,\ 3} $$ \cdots $$ s_{3,\ W} $ $ \vdots $ $ s_{H,\ 1} $$ s_{H,\ 2} $$ s_{H,\ 3} $$ \cdots $$ s_{H,\ W} $

## 输出格式

以下の形式で、標準出力に出力してください。

> $ n $ $ t_1 $ $ r_1 $ $ c_1 $ $ t_2 $ $ r_2 $ $ c_2 $ $ t_3 $ $ r_3 $ $ c_3 $ $ \vdots $ $ t_n $ $ r_n $ $ c_n $

ここで、$ n $ は操作を行う回数、$ t_i,\ r_i,\ c_i $ $ (1\ \leq\ i\ \leq\ n) $ は「$ i $ 回目にはマス $ (r_i,\ c_i) $ を選び操作 $ t_i $ を行うこと」を表しています。  
 $ t_i $ は `X` または `Y` でなければなりません。  
 なお、複数通りの答えが考えられる場合は、そのどれを出力しても構いません。

## 说明/提示

### 制約

- $ 1\ \leq\ H\ \leq\ 2500 $
- $ 1\ \leq\ W\ \leq\ 2500 $
- $ s_{i,\ j} $ は `R` または `B` である $ (1\ \leq\ i\ \leq\ H,\ 1\ \leq\ j\ \leq\ W) $
- $ H,\ W $ は整数

### Sample Explanation 1

たとえば次のように操作を行うことで、$ 10 $ 個のマスを白色にすることができます。 - まず、マス $ (1,\ 1) $ を選び、\*\*操作X\*\*を行う。 - 次に、マス $ (4,\ 3) $ を選び、\*\*操作Y\*\*を行う。 - 次に、マス $ (4,\ 1) $ を選び、\*\*操作X\*\*を行う。 なお、$ 11 $ 個以上のマスを白色にする方法は存在しません。 !\[ \](https://img.atcoder.jp/arc119/b0fde87f879b9dc90ca8788945f21bf2.png)

### Sample Explanation 2

すべてのマスを白色に塗り替えることができます。

### Sample Explanation 3

赤色のマスが $ 1 $ つも存在しないため、そもそも操作を行うことができません。

## 样例 #1

### 输入

```
4 4

RBBB

BBBB

BBBB

RBRB
```

### 输出

```
3

X 1 1

Y 4 3

X 4 1
```

## 样例 #2

### 输入

```
1 119

BBBRBBBBBBRBBBBBBRBBBBBBRBBBBBBRBBBBBBRBBBBBBRBBBBBBRBBBBBBRBBBBBBRBBBBBBRBBBBBBRBBBBBBRBBBBBBRBBBBBBRBBBBBBRBBBBBBRBBB
```

### 输出

```
4

Y 1 60

Y 1 109

Y 1 46

X 1 11
```

## 样例 #3

### 输入

```
10 10

BBBBBBBBBB

BBBBBBBBBB

BBBBBBBBBB

BBBBBBBBBB

BBBBBBBBBB

BBBBBBBBBB

BBBBBBBBBB

BBBBBBBBBB

BBBBBBBBBB

BBBBBBBBBB
```

### 输出

```
0
```



---

---
title: "[ARC119E] Pancakes"
layout: "post"
diff: 省选/NOI-
pid: AT_arc119_e
tag: []
---

# [ARC119E] Pancakes

## 题目描述

[problemUrl]: https://atcoder.jp/contests/arc119/tasks/arc119_e

$ N $ 枚のパンケーキが積み重なった「パンケーキタワー」があります。最初、上から $ i $ 番目 $ (1\ \leq\ i\ \leq\ N) $ のパンケーキの大きさは $ A_i $ です。シェフである高橋君は、このパンケーキタワーに対して次の操作を最大 $ 1 $ 回行うことができます。

- 整数 $ l,\ r $ $ (1\ \leq\ l\ \lt\ r\ \leq\ N) $ を選び、上から $ l,\ l+1,\ \dots,\ r $ 番目のパンケーキの並び方を反転させる。

ここで、**見栄えの悪さ**を次のように定義するとき、操作後の見栄えの悪さとして考えられる最小の値を求めてください。

> 隣り合うパンケーキの大きさの差の総和。  
>  すなわち、上から $ i $ 番目のパンケーキの大きさを $ A^{\prime}_i $ とするときの、$ |A^{\prime}_1\ -\ A^{\prime}_2|\ +\ |A^{\prime}_2\ -\ A^{\prime}_3|\ +\ \cdots\ +\ |A^{\prime}_{N-1}\ -\ A^{\prime}_N| $ の値。

## 输入格式

入力は以下の形式で標準入力から与えられます。

> $ N $ $ A_1 $ $ A_2 $ $ \cdots $ $ A_N $

## 输出格式

見栄えの悪さとして考えられる最小の値を出力してください。

## 说明/提示

### 制約

- $ 2\ \leq\ N\ \leq\ 300000 $
- $ 1\ \leq\ A_i\ \leq\ 10^9 $
- 入力はすべて整数

### Sample Explanation 1

$ l\ =\ 2,\ r\ =\ 5 $ を選んで操作をすると、操作後のパンケーキの大きさは上から順に $ 7,\ 6,\ 2,\ 12,\ 14 $ となります。 このときの見栄えの悪さは $ |7-6|\ +\ |6-2|\ +\ |2-12|\ +\ |12-14|\ =\ 1\ +\ 4\ +\ 10\ +\ 2\ =\ 17 $ です。これが最小値となり、他のどんな方法を使ってもこれより見栄えの悪さを小さくすることはできません。

### Sample Explanation 2

この入力例では、操作をしないことで見栄えの悪さを最小にすることができます。 このとき、パンケーキの大きさは上から順に $ 111,\ 119,\ 999 $ となり、見栄えの悪さは $ |111-119|\ +\ |119-999|\ =\ 8\ +\ 880\ =\ 888 $ となります。

### Sample Explanation 3

$ l\ =\ 3,\ r\ =\ 5 $ を選んで操作をすると、操作後のパンケーキの大きさは上から順に $ 12,\ 15,\ 15,\ 4,\ 3,\ 7 $ となります。 このときの見栄えの悪さは $ |12-15|\ +\ |15-15|\ +\ |15-4|\ +\ |4-3|\ +\ |3-7|\ =\ 3\ +\ 0\ +\ 11\ +\ 1\ +\ 4\ =\ 19 $ で、これが最小値となります。

### Sample Explanation 4

$ l\ =\ 2,\ r\ =\ 4 $ を選んで操作をすると、操作後のパンケーキの大きさは上から順に $ 100,\ 400,\ 500,\ 800,\ 900,\ 300,\ 700 $ となり、このときの見栄えの悪さは $ 1800 $ となります。

## 样例 #1

### 输入

```
5

7 14 12 2 6
```

### 输出

```
17
```

## 样例 #2

### 输入

```
3

111 119 999
```

### 输出

```
888
```

## 样例 #3

### 输入

```
6

12 15 3 4 15 7
```

### 输出

```
19
```

## 样例 #4

### 输入

```
7

100 800 500 400 900 300 700
```

### 输出

```
1800
```

## 样例 #5

### 输入

```
10

535907999 716568837 128214817 851750025 584243029 933841386 159109756 502477913 784673597 603329725
```

### 输出

```
2576376600
```



---

---
title: "[ARC119F] AtCoder Express 3"
layout: "post"
diff: 省选/NOI-
pid: AT_arc119_f
tag: []
---

# [ARC119F] AtCoder Express 3

## 题目描述

[problemUrl]: https://atcoder.jp/contests/arc119/tasks/arc119_f

AtCoder 鉄道には $ N+1 $ 個の駅があり、駅には $ 0 $ から $ N $ までの番号が付けられています。ここではかつて、各 $ i $ $ (0\ \leq\ i\ \leq\ N-1) $ に対して駅 $ i $ と駅 $ i+1 $ の間を双方向に $ 1 $ 分で走行する **普通列車** のみが運行されていました。

しかし、ある日鉄道会社は「光速派」と「準急派」の $ 2 $ つのグループに分裂し、駅 $ 0 $ と駅 $ N $ を除く各駅は光速派と準急派のうち片方が管理することになりました。駅 $ j $ $ (1\ \leq\ j\ \leq\ N-1) $ を管理するグループは文字 $ c_j $ で表され、`A` は光速派が、`B` は準急派が管理すること、`?` はまだ決まっていないことを表します。駅 $ 0 $ と駅 $ N $ は重要な駅なので、両方が管理します。

ここで、光速派と準急派は、普通列車に加えて新たに $ 2 $ 種類の鉄道路線を作ることにしました。

> **光速列車**：光速派が管理する駅の番号を昇順に $ a_0,\ a_1,\ \dots,\ a_s $ として、各 $ k $ に対して駅 $ a_k $ と駅 $ a_{k+1} $ の間を双方向に $ 1 $ 分で走行する。
> 
> **準急列車**：準急派が管理する駅の番号を昇順に $ b_0,\ b_1,\ \dots,\ b_t $ として、各 $ k $ に対して駅 $ b_k $ と駅 $ b_{k+1} $ の間を双方向に $ 1 $ 分で走行する。

`?` の個数を $ q $ として、作られる鉄道路線は $ 2^q $ 通り考えられます。その中で、$ K $ 分以内の乗車で駅 $ 0 $ から駅 $ N $ に行けるようになるものは何通りあるでしょうか？これを $ 10^9+7 $ で割った余りを求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられます。

> $ N $ $ K $ $ c_1 $$ c_2 $$ \cdots $$ c_{N-1} $

## 输出格式

答えを $ 10^9+7 $ で割った余りを出力してください。

## 说明/提示

### 制約

- $ 2\ \leq\ N\ \leq\ 4000 $
- $ 1\ \leq\ K\ \leq\ \frac{N+1}{2} $
- $ N,\ K $ は整数
- $ c_1,\ c_2,\ \dots,\ c_{N-1} $ はそれぞれ `A`、`B`、`?` のいずれか

### Sample Explanation 1

ここでは $ 2^3\ =\ 8 $ 通りの鉄道路線がありえますが、そのうち以下の $ 4 $ 通りについて、$ 3 $ 分以内の乗車で駅 $ 0 $ から駅 $ 8 $ に行くことが可能です。 - 駅 $ 2,\ 3,\ 6 $ を光速派が管理する場合：駅 $ 0\ \rightarrow\ 5\ \rightarrow\ 7\ \rightarrow\ 8 $ と移動する（下図の #1 に対応） - 駅 $ 2,\ 3 $ を光速派が、駅 $ 6 $ を準急派が管理する場合：駅 $ 0\ \rightarrow\ 5\ \rightarrow\ 4\ \rightarrow\ 8 $ と移動する（下図の #2 に対応） - 駅 $ 2 $ を光速派が、駅 $ 3,\ 6 $ を準急派が管理する場合：駅 $ 0\ \rightarrow\ 3\ \rightarrow\ 4\ \rightarrow\ 8 $ と移動する（下図の #4 に対応） - 駅 $ 2,\ 3,\ 6 $ を準急派が管理する場合：駅 $ 0\ \rightarrow\ 1\ \rightarrow\ 4\ \rightarrow\ 8 $ と移動する（下図の #8 に対応） したがって、答えは $ 4 $ 通りとなります。これを図で表すと、以下のようになります。下図においては、赤色が光速派のみが管理する駅や光速列車の路線、青色が準急派のみが管理する駅や準急列車の路線を表すものとします。 !\[ \](https://img.atcoder.jp/arc119/db3f88315c456535f7ce57116009c126.png)

### Sample Explanation 2

ここでは、$ 2^8\ =\ 256 $ 通りの組み合わせすべてについて、駅 $ 0 $ から駅 $ 11 $ まで $ 6 $ 分以内の乗車で行くことが可能です。

### Sample Explanation 3

以下の図に示される $ 10 $ 通りの組み合わせについて、駅 $ 0 $ から駅 $ 16 $ まで $ 5 $ 分以内の乗車で行くことが可能です。 !\[ \](https://img.atcoder.jp/arc119/4b879e19b8c1cd7eac9d52eb0ea58e5c.png)

### Sample Explanation 4

条件を満たすものは $ 1623310324709451 $ 通りありますが、これを $ 10^9\ +\ 7 $ で割った余りである $ 313346281 $ を出力してください。

## 样例 #1

### 输入

```
8 3

A??AB?B
```

### 输出

```
4
```

## 样例 #2

### 输入

```
11 6

???B??A???
```

### 输出

```
256
```

## 样例 #3

### 输入

```
16 5

?A?B?A?B?A?B?A?
```

### 输出

```
10
```

## 样例 #4

### 输入

```
119 15

????????A?????????????????????????BA????????????????????????AB???????A???????????B?????????????????????????????A??????
```

### 输出

```
313346281
```



---

---
title: "[ARC120E] 1D Party"
layout: "post"
diff: 省选/NOI-
pid: AT_arc120_e
tag: []
---

# [ARC120E] 1D Party

## 题目描述

有 $ N $ 个人打算开派对，他们均分布在数轴上，编号从 $1$ 到 $N$，第 $i$ 个人位于 $ a_i $ 点。初始是他们都位于数轴上不同的点。具体的，所有人所在的点都是偶数点，且有 $ a_1 < a_2 < a_3 <\cdots< a_n$。

派对计划进行 $k$ 秒，每个人每秒钟可以在数轴上向左或者向右移动一个单位长度，也可以不移动。

我们都知道，开派对至少要两个人。所以派对成功举行的条件是，对于任意的某个人 $j (1≤j<N)$，经过一系列移动过程，在派对进行中至少有一瞬间（包括派对结束的那一刻）使得 $a_j = a_{j+1}$（以当前那一秒结束时的位置为准）。

请计算能够使得派对成功举行的最小的 $k$。

能够证明在题目限定条件下答案一定存在。

## 输入格式

第一行一个正整数 $N$。  
第二行包含 $ N $ 个正整数表示 $a_i$。

## 输出格式

一行一个整数，表示满足条件的最小 $k$ 值。

### 样例解释

#### 样例 1 解释

我们依次把 $3$ 个人记为 $A,B,C$，在 $5$ 秒内，每个人可以进行如下方式的移动：

- $A$ 一直向右移动； 
- $B$ 前 $2$ 秒向右移动，后 $3$ 秒向左移动； 
- $C$ 一直向左移动。

这样 $B$ 和 $C$ 在第 $2$ 秒结束时到达同一个位置，$A$ 和 $B$ 在第 $5$ 秒结束时到达同一个位置。

#### 样例 2 解释

我们依次把 $5$ 个人记为 $A,B,C,D,E$。

- $A$ 一直向右移动；
- $B$ 前 $2$ 秒向右移动，后 $1$ 秒向左移动；
- $C$ 一直保持不动；
- $D$ 前 $2$ 秒向左移动，后 $1$ 秒向右移动； 
- $E$ 一直向左移动；

这样 $(B,C),(C,D)$ 同时在第 $2$ 秒结束时到达同一个位置，$(A,B),(D,E)$ 分别在第 $3$ 秒结束时到达同一个位置。

## 样例 #1

### 输入

```
3

0 6 10
```

### 输出

```
5
```

## 样例 #2

### 输入

```
5

0 2 4 6 8
```

### 输出

```
3
```

## 样例 #3

### 输入

```
10

0 2 4 6 8 92 94 96 98 100
```

### 输出

```
44
```



---

---
title: "[ARC120F] Wine Thief"
layout: "post"
diff: 省选/NOI-
pid: AT_arc120_f
tag: []
---

# [ARC120F] Wine Thief

## 题目描述

[problemUrl]: https://atcoder.jp/contests/arc120/tasks/arc120_f

**問題 F と問題 F2 は同じ問題ですが、制約と実行時間制限が異なります。**

高橋君の倉庫には $ N $ 本のワインがあり、左右方向 $ 1 $ 列に並んでいます。左から $ i $ 番目のワインの美味しさは $ A_i $ です。  
 青木君は今からこの $ N $ 本のうち、ちょうど $ K $ 本を選んで盗みます。しかし、高橋君は注意深いので、以下の条件が満たされると盗まれたことに気付いてしまいます。

- 連続で並ぶ $ D $ 本のワインであって、そのうち $ 2 $ 本以上盗まれているようなものが存在する (この問題では $ D\ =\ 2 $ です)

高橋君に気付かれないような全ての盗み方について、盗んだワインの美味しさの和を求め、それを足し合わせた値を求めてください。  
 なお、答えは非常に大きくなることがあるので、$ 998244353 $ で割った余りを出力してください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ K $ $ D $ $ A_1 $ $ A_2 $ $ A_3 $ $ \dots $ $ A_N $

## 输出格式

答えを $ 998244353 $ で割った余りを出力せよ。

## 说明/提示

### 制約

- $ D\ =\ 2 $
- $ 2\ \le\ N\ \le\ 3\ \times\ 10^5 $
- $ 1\ \le\ K\ \le\ \left\lceil\ \frac{N}{D}\ \right\rceil $ （$ \left\lceil\ x\ \right\rceil $ は $ x $ 以上の最小の整数を表す）
- $ 1\ \le\ A_i\ \lt\ 998244353 $
- 入力に含まれる値は全て整数

### Sample Explanation 1

盗み方と盗んだワインの美味しさの和は以下の通りです。 - 左から $ 1 $ 本目のワインと $ 3 $ 本目のワインを盗んだ場合 : 美味しさの和は $ 1\ +\ 2\ =\ 3 $ - 左から $ 1 $ 本目のワインと $ 4 $ 本目のワインを盗んだ場合 : 美味しさの和は $ 1\ +\ 3\ =\ 4 $ - 左から $ 2 $ 本目のワインと $ 4 $ 本目のワインを盗んだ場合 : 美味しさの和は $ 4\ +\ 3\ =\ 7 $ よって答えは $ 3\ +\ 4\ +\ 7\ =\ 14 $ となります。

### Sample Explanation 2

左から $ 1,\ 3,\ 5 $ 本目のワインを盗むほかありません。

## 样例 #1

### 输入

```
4 2 2

1 4 2 3
```

### 输出

```
14
```

## 样例 #2

### 输入

```
5 3 2

4 7 5 3 8
```

### 输出

```
17
```

## 样例 #3

### 输入

```
12 4 2

107367523 266126484 149762920 57456082 857431610 400422663 768881284 494753774 152155823 740238343 871191740 450057094
```

### 输出

```
136993014
```



---

---
title: "[ARC121D] 1 or 2"
layout: "post"
diff: 省选/NOI-
pid: AT_arc121_d
tag: []
---

# [ARC121D] 1 or 2

## 题目描述

你有 $n$ 个糖果，第 $i$ 个糖果的美味值为 $a_i$。

你需要吃糖，每次你可以选择吃 $1$ 个或 $2$ 个糖，并将你这一次吃的糖的总和写在黑板上。

你需要求出吃完所有糖果的所有可能的情况中，黑板上数字最大值和最小值之差最小是多少。

## 输入格式

如原文。

## 输出格式

如原文。

## 说明/提示

$1\leq n\leq 5\times 10^3,-10^9\leq a_i\leq 10^9$。

---

样例一：

第一次吃第一和第二个，第二次吃第三个，黑板上的数为 $\{3,4\}$，答案为 $1$。

样例二：

第一次全部吃完，黑板上的数为 $\{-150\}$，答案为 $0$。

Translate by Zek3L.

## 样例 #1

### 输入

```
3

1 2 4
```

### 输出

```
1
```

## 样例 #2

### 输入

```
2

-100 -50
```

### 输出

```
0
```

## 样例 #3

### 输入

```
20

-18 31 -16 12 -44 -5 24 17 -37 -31 46 -24 -2 11 32 16 0 -39 35 38
```

### 输出

```
13
```



---

---
title: "[ARC121E] Directed Tree"
layout: "post"
diff: 省选/NOI-
pid: AT_arc121_e
tag: []
---

# [ARC121E] Directed Tree

## 题目描述

[problemUrl]: https://atcoder.jp/contests/arc121/tasks/arc121_e

$ 1 $ から $ N $ の番号がついた $ N $ 頂点の有向木が与えられます。

頂点 $ 1 $ はこの木の根です。 $ 2\ \leq\ i\ \leq\ N $ を満たす整数 $ i $ について、頂点 $ p_i $ から $ i $ へ向かう有向辺が存在します。

$ a $ を $ (1,\ldots,N) $ を並び替えて得られる数列とします。また、$ a $ の $ i $ 番目の項を $ a_i $ とします。

$ a $ としてありうる数列は $ N! $ 通りあります。それらのうち、下記の条件を満たすものの個数を $ 998244353 $ で割ったあまりを求めてください。

- 条件：$ 1\ \leq\ i\ \leq\ N $ を満たす任意の整数 $ i $ について、頂点 $ a_i $ から **$ 1 $ 度以上**辺を辿って頂点 $ i $ へ到達することはできない。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ p_{2} $ $ \cdots $ $ p_N $

## 输出格式

$ (1,\ldots,N) $ の並び替え $ a $ のうち、問題文中の条件を満たすものの個数を $ 998244353 $ で割ったあまりを出力せよ。

## 说明/提示

### 制約

- 与えられる入力は全て整数
- $ 1\ \leq\ N\ \leq\ 2000 $
- $ 1\ \leq\ p_i\ <\ i $

### Sample Explanation 2

\- $ 998244353 $ で割ったあまりを出力するのを忘れずに。

## 样例 #1

### 输入

```
4

1 1 3
```

### 输出

```
4
```

## 样例 #2

### 输入

```
30

1 1 3 1 5 1 1 1 8 9 7 3 11 11 15 14 4 10 11 12 1 10 13 11 7 23 8 12 18
```

### 输出

```
746746186
```



---

---
title: "[ARC121F] Logical Operations on Tree"
layout: "post"
diff: 省选/NOI-
pid: AT_arc121_f
tag: []
---

# [ARC121F] Logical Operations on Tree

## 题目描述

[problemUrl]: https://atcoder.jp/contests/arc121/tasks/arc121_f

$ 1 $ から $ N $ の番号がついた $ N $ 頂点の木が与えられます。

$ i $ 番目の辺は頂点 $ a_i $ と $ b_i $ をつないでいます。

すぬけ君は頂点には `0` か `1` のラベルを、辺には `AND` か `OR` のラベルをつけることにしました。 頂点と辺へのラベルのつけ方は $ 2^{2N-1} $ 通りあります。それらのうち下記の条件を満たすものの個数を $ 998244353 $ で割ったあまりを求めてください。

条件：*操作* を $ N-1 $ 回行ったのち、残った頂点についているラベルが `1` になるような操作手順が存在する。操作は下記の手順からなる。

- 辺を $ 1 $ 本選んで縮約する(消された $ 2 $ 個の頂点に書かれていたラベルを $ x,y $、消された辺に書かれていたラベルを $ \mathrm{op} $ とする)。
- $ \mathrm{op} $ が `AND` ならば $ \mathrm{AND}(x,y) $ を、`OR` ならば $ \mathrm{OR}(x,y) $ を新たな頂点にラベルとしてつける。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ a_1 $ $ b_1 $ $ \vdots $ $ a_{N-1} $ $ b_{N-1} $

## 输出格式

問題文中の条件を満たすラベルのつけ方の個数を $ 998244353 $ で割ったあまりを出力せよ。

## 说明/提示

### 注記

- 演算 $ \mathrm{AND} $ の定義は次の通りです：$ \mathrm{AND}(0,0)=(0,1)=(1,0)=0,\mathrm{AND}(1,1)=1 $
- 演算 $ \mathrm{OR} $ の定義は次の通りです：$ \mathrm{OR}(1,1)=(0,1)=(1,0)=1,\mathrm{OR}(0,0)=0 $
- 頂点 $ s $ と頂点 $ t $ を結ぶ辺を縮約する際は、その辺を取り除くと同時に $ 2 $ 頂点を併合します。縮約後の木において、併合により生まれた頂点と頂点 $ u $ を結ぶ辺が存在するのは、縮約前の木において $ s $ と $ u $ を結ぶ辺または $ t $ と $ u $ を結ぶ辺が存在するときであり、またそのときに限られます。

### 制約

- 与えられる入力は全て整数
- $ 2\ \leq\ N\ \leq\ 10^{5} $
- $ 1\ \leq\ a_i,\ b_i\ \leq\ N $
- 与えられるグラフは木

### Sample Explanation 2

\- $ 998244353 $ で割ったあまりを出力するのを忘れずに。

## 样例 #1

### 输入

```
2

1 2
```

### 输出

```
4
```

## 样例 #2

### 输入

```
20

7 3

20 18

16 12

7 2

10 5

18 16

16 3

4 11

7 15

8 1

6 1

12 13

15 5

19 17

7 1

9 8

7 17

16 14

11 7
```

### 输出

```
283374562
```



---

---
title: "[ARC122E] Increasing LCMs"
layout: "post"
diff: 省选/NOI-
pid: AT_arc122_e
tag: []
---

# [ARC122E] Increasing LCMs

## 题目描述

[problemUrl]: https://atcoder.jp/contests/arc122/tasks/arc122_e

長さ $ N $ の正整数列 $ A_1,A_2,\cdots,A_N $ があります． あなたは，これらの整数を並び替えることで，正整数列 $ x_1,x_2,\cdots,x_N $ を作ろうとしています． この時，$ x $ は以下の条件を満たす必要があります．

- $ y_i=\operatorname{LCM}(x_1,x_2,\cdots,x_i) $ と定義する．ここで，$ \operatorname{LCM} $ は与えられた整数たちの最小公倍数を返す関数である．このとき，$ y $ は狭義単調増加である．つまり，$ y_1\ <\ y_2\ <\ \cdots\ <\ y_N $ が成り立つ．

条件を満たすような $ x $ が存在するか判定し，存在するなら一つ例を示してください．

## 输入格式

入力は以下の形式で標準入力から与えられる．

> $ N $ $ A_1 $ $ A_2 $ $ \cdots $ $ A_N $

## 输出格式

条件を満たすような $ x $ が存在する場合，以下の形式で答えを出力せよ．

> Yes $ x_1 $ $ x_2 $ $ \cdots $ $ x_N $

存在しない場合，`No` と出力せよ．

## 说明/提示

### 制約

- $ 1\ \leq\ N\ \leq\ 100 $
- $ 2\ \leq\ A_1\ <\ A_2\ \cdots\ <\ A_N\ \leq\ 10^{18} $
- 入力される値はすべて整数である

### Sample Explanation 1

$ x=(3,6,4) $ のとき， - $ y_1=\operatorname{LCM}(3)=3 $ - $ y_2=\operatorname{LCM}(3,6)=6 $ - $ y_3=\operatorname{LCM}(3,6,4)=12 $ となり，$ y_1\ <\ y_2\ <\ y_3 $ を満たします．

### Sample Explanation 2

どのように $ A $ を並び替えても条件を満たすことができません．

## 样例 #1

### 输入

```
3

3 4 6
```

### 输出

```
Yes

3 6 4
```

## 样例 #2

### 输入

```
3

2 3 6
```

### 输出

```
No
```

## 样例 #3

### 输入

```
10

922513 346046618969 3247317977078471 4638516664311857 18332844097865861 81706734998806133 116282391418772039 134115264093375553 156087536381939527 255595307440611247
```

### 输出

```
Yes

922513 346046618969 116282391418772039 81706734998806133 255595307440611247 156087536381939527 134115264093375553 18332844097865861 3247317977078471 4638516664311857
```



---

---
title: "[ARC123E] Training"
layout: "post"
diff: 省选/NOI-
pid: AT_arc123_e
tag: []
---

# [ARC123E] Training

## 题目描述

[problemUrl]: https://atcoder.jp/contests/arc123/tasks/arc123_e

$ X $ さんと $ Y $ さんの $ 2 $ 人のプログラマが、競技プログラミングを始めることになりました。

競技プログラミングの実力は、「レベル」と呼ばれる正の整数で表され、はじめ $ X $ さんのレベルは $ A_X $、$ Y $ さんのレベルは $ A_Y $ です。$ 2 $ 人はこれから練習メニューをこなすことで、レベルを上げていきます。

$ 2 $ 人のレベルの上がり方について、次のことが分かっています：

- $ X $ さんはちょうど $ B_X $ 個の練習メニューをこなすたびに、レベルがひとつ上がります。
- $ Y $ さんはちょうど $ B_Y $ 個の練習メニューをこなすたびに、レベルがひとつ上がります。

$ n\ =\ 1,\ 2,\ \ldots,\ N $ のうちで次を満たすものはいくつあるかを答えてください。

- $ 2 $ 人がちょうど $ n $ 個ずつの練習メニューをこなした場合、$ 2 $ 人の最終的なレベルは等しくなる。

一つの入力ファイルにつき、$ T $ 個のテストケースに答えてください。

## 输入格式

入力は以下の形式で標準入力から与えられます。

> $ T $ $ \text{case}_1 $ $ \text{case}_2 $ $ \vdots $ $ \text{case}_T $

各テストケースは以下の形式で与えられます。

> $ N $ $ A_X $ $ B_X $ $ A_Y $ $ B_Y $

## 输出格式

答えを出力してください。

## 说明/提示

### 制約

- $ 1\leq\ T\leq\ 2\times\ 10^5 $
- $ 1\leq\ N\leq\ 10^{9} $
- $ 1\leq\ A_X,\ B_X,\ A_Y,\ B_Y\ \leq\ 10^6 $

### Sample Explanation 1

ひとつめのテストケースについて説明します。 $ n\ =\ 1,\ 2,\ \ldots,\ 10 $ に対して、$ n $ 個の練習メニューをこなした場合の $ 2 $ 人のレベルは次のようになります： - $ X $ さんのレベル：$ 5,\ 5,\ 6,\ 6,\ 6,\ 7,\ 7,\ 7,\ 8,\ 8 $ - $ Y $ さんのレベル：$ 4,\ 5,\ 5,\ 6,\ 6,\ 7,\ 7,\ 8,\ 8,\ 9 $ $ 6 $ 個の $ n $ （$ n\ =\ 2,\ 4,\ 5,\ 6,\ 7,\ 9 $）の場合に $ 2 $ 人のレベルが等しくなります。したがって答えは $ 6 $ となります。

## 样例 #1

### 输入

```
5

10 5 3 4 2

5 5 3 4 2

100 5 3 4 2

10 5 3 4 3

10 5 10 5 9
```

### 输出

```
6

3

6

0

9
```



---

---
title: "[ARC125E] Snack"
layout: "post"
diff: 省选/NOI-
pid: AT_arc125_e
tag: []
---

# [ARC125E] Snack

## 题目描述

[problemUrl]: https://atcoder.jp/contests/arc125/tasks/arc125_e

$ 1 $ から $ N $ までの番号のついた $ N $ 種類のお菓子があります． お菓子 $ i $ は $ A_i $ 個あります．

$ 1 $ から $ M $ までの番号のついた $ M $ 人の子供がいます． この子供たちに，今からお菓子を配ります． ただし，お菓子を配る際には，次の条件を全て満たす必要があります．

- 子供 $ i $ は，どの種類のお菓子も $ B_i $ 個以下しかもらわない．
- 子供 $ i $ がもらうお菓子の個数の合計は $ C_i $ 以下である．

この条件のもとで，子どもたちに配るお菓子の個数の総和の最大値がいくらになるか求めてください．

## 输入格式

入力は以下の形式で標準入力から与えられる．

> $ N $ $ M $ $ A_1 $ $ A_2 $ $ \cdots $ $ A_N $ $ B_1 $ $ B_2 $ $ \cdots $ $ B_M $ $ C_1 $ $ C_2 $ $ \cdots $ $ C_M $

## 输出格式

答えを出力せよ．

## 说明/提示

### 制約

- $ 1\ \leq\ N\ \leq\ 2\ \times\ 10^5 $
- $ 1\ \leq\ M\ \leq\ 2\ \times\ 10^5 $
- $ 1\ \leq\ A_i\ \leq\ 10^{12} $
- $ 1\ \leq\ B_i\ \leq\ 10^7 $
- $ 1\ \leq\ C_i\ \leq\ 10^{12} $
- 入力される値はすべて整数である

### Sample Explanation 1

次のようにお菓子を配ればよいです． - 子供 $ 1 $ は，お菓子 $ 1,2,3 $ をそれぞれ $ 1,1,1 $ 個もらう． - 子供 $ 2 $ は，お菓子 $ 1,2,3 $ をそれぞれ $ 0,2,1 $ 個もらう． - 子供 $ 3 $ は，お菓子 $ 1,2,3 $ をそれぞれ $ 1,2,2 $ 個もらう．

## 样例 #1

### 输入

```
3 3

2 5 5

1 2 2

5 3 5
```

### 输出

```
11
```

## 样例 #2

### 输入

```
10 6

3 54 62 64 25 89 1 47 77 4

1 17 10 29 95 17

32 40 90 27 50 9
```

### 输出

```
211
```



---

---
title: "[ARC126E] Infinite Operations"
layout: "post"
diff: 省选/NOI-
pid: AT_arc126_e
tag: []
---

# [ARC126E] Infinite Operations

## 题目描述

[problemUrl]: https://atcoder.jp/contests/arc126/tasks/arc126_e

$ N $ 項からなる正整数列 $ A\ =\ (A_1,\ A_2,\ \ldots,\ A_N) $ と $ Q $ 個のクエリが与えられます。$ i $ 番目のクエリは、以下のようなものです：

- 整数 $ x_i,\ y_i $ （ただし $ 1\leq\ x_i\leq\ N $）が与えられる。$ A_{x_i} $ を $ y_i $ に変更する。

クエリで数列が変更されるたびに、以下の問題の答えを $ \mod\ 998244353 $ で求めてください（注記参照）。

> 数列 $ A $ に対して以下の操作を $ n $ 回行うとき、獲得できる総得点の最大値を $ f(n) $ とする。
> 
> - $ A_i\leq\ A_j $ となる $ i,\ j $ および $ A_i\ +\ 2x\ \leq\ A_j $ となる**非負実数** $ x $ を選ぶ。
> - $ A_i $ に $ x $ を加え、$ A_j $ から $ x $ を引く。
> - $ x $ 点を獲得する。
> 
> 極限 $ \displaystyle\ \lim_{n\to\infty}\ f(n) $ が存在することが証明できる。この値を求めよ。

## 输入格式

入力は以下の形式で標準入力から与えられます。

> $ N $ $ Q $ $ A_1 $ $ A_2 $ $ \ldots $ $ A_N $ $ x_1 $ $ y_1 $ $ \vdots $ $ x_Q $ $ y_Q $

## 输出格式

$ Q $ 行出力してください。$ i $ 行目には、$ i $ 番目のクエリで数列を変更した時点での、問題の答えを出力してください。

## 说明/提示

### 注記

求める極限は必ず有理数となることが証明できます。またこの問題の制約下では、その値を互いに素な $ 2 $ つの整数 $ P,\ Q $ を用いて $ \frac{P}{Q} $ と表したとき、$ R\times\ Q\equiv\ P\pmod{998244353} $ かつ $ 0\leq\ R\ <\ 998244353 $ を満たす整数 $ R $ がただ一つ存在することが証明できます。この $ R $ を求めてください。

### 制約

- $ 2\leq\ N\leq\ 3\times\ 10^5 $
- $ 1\leq\ Q\leq\ 3\times\ 10^5 $
- $ 1\leq\ A_i\ \leq\ 10^9 $
- $ 1\leq\ x_i\leq\ N $
- $ 1\leq\ y_i\leq\ 10^9 $

### Sample Explanation 1

$ 1 $ つめのクエリにより、数列は $ (5,\ 5,\ 5) $ へと変更されます。この場合任意の $ n $ に対して $ f(n)\ =\ 0 $ となり、答えは $ 0 $ となります。 $ 2 $ つめのクエリにより、数列は $ (5,6,5) $ へと変更されます。操作は例えば以下のように進行します。 - $ (i,j,x)\ =\ (3,2,0.4) $ と選ぶ。数列を $ (5,\ 5.6,\ 5.4) $ へ変更し、$ 0.4 $ 点を獲得する。 - $ (i,j,x)\ =\ (1,2,0.3) $ と選ぶ。数列を $ (5.3,\ 5.3,\ 5.4) $ へ変更し、$ 0.3 $ 点を獲得する。 上の方法では $ 2 $ 回の操作により $ 0.7 $ 点を獲得しており、$ f(2)\ \geq\ 0.7 $ であることがわかります。 この場合、獲得できる総得点は $ 1 $ を超えることはなく、操作回数を増やしていき最適な方法で操作を行うことで、獲得できる総得点を限りなく $ 1 $ に近づけることが可能であることが証明できます。したがって $ \displaystyle\ \lim_{n\to\infty}\ f(n)\ =\ 1 $ となります。

## 样例 #1

### 输入

```
3 4

7 5 5

1 5

2 6

1 7

3 5
```

### 输出

```
0

1

2

2
```

## 样例 #2

### 输入

```
2 4

1 2

2 5

1 3

1 2

2 3
```

### 输出

```
2

1

499122178

499122177
```



---

---
title: "[ARC127D] Sum of Min of Xor"
layout: "post"
diff: 省选/NOI-
pid: AT_arc127_d
tag: []
---

# [ARC127D] Sum of Min of Xor

## 题目描述

[problemUrl]: https://atcoder.jp/contests/arc127/tasks/arc127_d

長さ $ N $ の整数列 $ (A_1,A_2,\cdots,A_N) $ および $ (B_1,B_2,\cdots,B_N) $ が与えられます．

$ \sum_{1\ \leq\ i\ <\ j\ \leq\ N}\ \min(A_i\ \oplus\ A_j,\ B_i\ \oplus\ B_j) $ の値を求めてください． ただしここで，$ \oplus $ はビットごとの排他的論理和を表します．

## 输入格式

入力は以下の形式で標準入力から与えられる．

> $ N $ $ A_1 $ $ A_2 $ $ \cdots $ $ A_N $ $ B_1 $ $ B_2 $ $ \cdots $ $ B_N $

## 输出格式

答えを出力せよ．

## 说明/提示

### 制約

- $ 1\ \leq\ N\ \leq\ 250000 $
- $ 0\ \leq\ A_i,B_i\ <\ 2^{18} $
- 入力される値はすべて整数である

### Sample Explanation 1

\- $ \min(1\ \oplus\ 2,\ 4\ \oplus\ 5)=\min(3,1)=1 $ - $ \min(1\ \oplus\ 3,\ 4\ \oplus\ 6)=\min(2,2)=2 $ - $ \min(2\ \oplus\ 3,\ 5\ \oplus\ 6)=\min(1,3)=1 $ よって，答えは $ 1+2+1=4 $ になります．

## 样例 #1

### 输入

```
3

1 2 3

4 5 6
```

### 输出

```
4
```

## 样例 #2

### 输入

```
4

1 2 3 4

1 2 3 4
```

### 输出

```
24
```

## 样例 #3

### 输入

```
10

195247 210567 149398 9678 23694 46151 187762 17915 176476 249828

68649 128425 249346 62366 194119 117620 26327 161384 207 57656
```

### 输出

```
4019496
```



---

---
title: "[ARC127E] Priority Queue"
layout: "post"
diff: 省选/NOI-
pid: AT_arc127_e
tag: []
---

# [ARC127E] Priority Queue

## 题目描述

[problemUrl]: https://atcoder.jp/contests/arc127/tasks/arc127_e

長さ $ A+B $ の整数列 $ (X_1,X_2,\cdots,X_{A+B}) $ が与えられます． $ X $ はちょうど $ A $ 個の $ 1 $ とちょうど $ B $ 個の $ 2 $ を含みます．

すぬけくんは集合 $ s $ を持っており，最初 $ s $ は空です． 彼は今から，$ A+B $ 回の操作を行います． $ i $ 回目の操作は以下のような行動です．

- $ X_i=1 $ の時: $ 1\ \leq\ v\ \leq\ A $ を満たす整数 $ v $ を選び，$ s $ に追加する． ただし，今までの操作で選んだことのある整数は $ v $ として選べない．
- $ X_i=2 $ の時: $ s $ の中で最大値となる要素を削除する． なお，この操作の直前に $ s $ が空でないことは入力から保証される．

最終的な $ s $ としてありうる集合は何通りあるでしょうか？ 答えを $ 998244353 $ で割った余りを求めてください．

## 输入格式

入力は以下の形式で標準入力から与えられる．

> $ A $ $ B $ $ X_1 $ $ X_2 $ $ \cdots $ $ X_{A+B} $

## 输出格式

答えを $ 998244353 $ で割った余りを出力せよ．

## 说明/提示

### 制約

- $ 1\ \leq\ A\ \leq\ 5000 $
- $ 0\ \leq\ B\ \leq\ A-1 $
- $ 1\ \leq\ X_i\ \leq\ 2 $
- $ X_i=1 $ を満たす $ i $ がちょうど $ A $ 個存在する．
- $ X_i=2 $ を満たす $ i $ がちょうど $ B $ 個存在する．
- $ X_i=2 $ の操作を行う直前で $ s $ は空ではない．
- 入力される値はすべて整数である．

### Sample Explanation 1

最終的な $ s $ としてありうる状態は，$ s=\{1,2\},\{1,3\} $ の $ 2 $ 通りです． 例えば，以下のように操作すると，最終的に $ s=\{1,3\} $ となります． - $ i=1 $: $ s $ に $ 2 $ を追加する． - $ i=2 $: $ s $ に $ 1 $ を追加する． - $ i=3 $: $ s $ から $ 2 $ を削除する． - $ i=4 $: $ s $ に $ 3 $ を追加する．

## 样例 #1

### 输入

```
3 1

1 1 2 1
```

### 输出

```
2
```

## 样例 #2

### 输入

```
20 6

1 1 1 1 1 2 1 1 1 2 1 2 1 2 1 2 1 1 1 1 2 1 1 1 1 1
```

### 输出

```
5507
```



---

---
title: "[ARC128D] Neq Neq"
layout: "post"
diff: 省选/NOI-
pid: AT_arc128_d
tag: []
---

# [ARC128D] Neq Neq

## 题目描述

[problemUrl]: https://atcoder.jp/contests/arc128/tasks/arc128_d

$ N $ 個のボールが一列に並べられており，左から順に $ 1 $ から $ N $ までの番号がついています． ボール $ i $ には整数 $ A_i $ が書かれています．

あなたは，以下の操作を好きなだけ繰り返すことができます．

- 連続して並んでいる $ 3 $ つのボール $ x,y,z $ ($ 1\ \leq\ x\ <\ y\ <\ z\ \leq\ N $) を選ぶ． ただしこの時，$ A_x\ \neq\ A_y $ かつ $ A_y\ \neq\ A_z $ を満たす必要がある． その後，ボール $ y $ を食べる． なお，この操作の後，ボール $ x $ とボール $ z $ は列の中で連続しているとみなす．

最終的に残っているボールの集合としてありうるものの個数を $ 998244353 $ で割った余りを求めてください．

## 输入格式

入力は以下の形式で標準入力から与えられる．

> $ N $ $ A_1 $ $ A_2 $ $ \cdots $ $ A_N $

## 输出格式

答えを出力せよ．

## 说明/提示

### 制約

- $ 2\ \leq\ N\ \leq\ 200000 $
- $ 1\ \leq\ A_i\ \leq\ N $
- 入力される値はすべて整数である

### Sample Explanation 1

最終的に残っているボールの集合として考えられるのは，$ \{1,2,3,4\},\{1,2,4\},\{1,3,4\} $ の $ 3 $ 通りです．

### Sample Explanation 2

異なる操作方法でも，最終的に残るボールの集合が同じであれば区別しません．

### Sample Explanation 3

残るボールに書かれた整数を並べた列が同じでも，ボールの集合が異なる場合は区別されます．

## 样例 #1

### 输入

```
4

1 2 1 2
```

### 输出

```
3
```

## 样例 #2

### 输入

```
5

5 4 3 2 1
```

### 输出

```
8
```

## 样例 #3

### 输入

```
5

1 2 3 2 1
```

### 输出

```
8
```

## 样例 #4

### 输入

```
9

1 4 2 2 9 6 9 6 6
```

### 输出

```
14
```



---

---
title: "[ARC128E] K Different Values"
layout: "post"
diff: 省选/NOI-
pid: AT_arc128_e
tag: []
---

# [ARC128E] K Different Values

## 题目描述

[problemUrl]: https://atcoder.jp/contests/arc128/tasks/arc128_e

長さ $ N $ の整数列 $ A=(A_1,A_2,\cdots,A_N) $，及び整数 $ K $ が与えられます．

以下の条件を両方満たす整数列 $ x $ を作ることを考えます．

- 各整数 $ i $ ($ 1\ \leq\ i\ \leq\ N $) について，$ x $ はちょうど $ A_i $ 個の $ i $ を含む． また逆に，それ以外の整数を含まない．
- $ x $ の中で連続するどの $ K $ 個を見ても，その $ K $ 個の値はすべて異なる．

条件を満たす $ x $ を作ることが可能かどうか判定し，可能な場合は条件を満たす中で辞書順最小の $ x $ を求めてください．

## 输入格式

入力は以下の形式で標準入力から与えられる．

> $ N $ $ K $ $ A_1 $ $ A_2 $ $ \cdots $ $ A_N $

## 输出格式

条件を満たす数列 $ x $ が作ることが不可能な場合，`-1` と出力せよ． 可能な場合，辞書順最小の $ x $ を出力せよ．

## 说明/提示

### 制約

- $ 2\ \leq\ K\ \leq\ N\ \leq\ 500 $
- $ 1\ \leq\ A_i $
- $ \sum_{1\ \leq\ i\ \leq\ N}\ A_i\ \leq\ 200000 $
- 入力される値はすべて整数である

### Sample Explanation 1

$ x=(1,2,3,1,2),(2,1,3,2,1) $ の二つが条件を満たし，その中で辞書順最小の $ (1,2,3,1,2) $ が答えになります．

## 样例 #1

### 输入

```
3 3

2 2 1
```

### 输出

```
1 2 3 1 2
```

## 样例 #2

### 输入

```
3 2

2 1 2
```

### 输出

```
1 2 3 1 3
```

## 样例 #3

### 输入

```
3 3

1 3 3
```

### 输出

```
-1
```



---

---
title: "[ARC130D] Zigzag Tree"
layout: "post"
diff: 省选/NOI-
pid: AT_arc130_d
tag: []
---

# [ARC130D] Zigzag Tree

## 题目描述

[problemUrl]: https://atcoder.jp/contests/arc130/tasks/arc130_d

$ N $ 頂点からなる木が与えられます。頂点には $ 1 $ から $ N $ までの番号がついており、$ i $ 番目の辺は頂点 $ a_i $ と $ b_i $ を結んでいます。

正整数列 $ P\ =\ (P_1,\ P_2,\ \ldots,\ P_N) $ であって、以下の条件を満たすものの個数を $ 998244353 $ で割った余りを求めてください。

- $ 1\leq\ P_i\leq\ N $
- $ i\neq\ j $ ならば $ P_i\neq\ P_j $
- $ 1\leq\ a,\ b,\ c\leq\ N $ に対して頂点 $ a $ と 頂点 $ b $、頂点 $ b $ と頂点 $ c $ がともに隣接しているならば、$ P_a\ <\ P_b\ >\ P_c $ または $ P_a\ >\ P_b\ <\ P_c $ が成り立つ。

## 输入格式

入力は以下の形式で標準入力から与えられます。

> $ N $ $ a_1 $ $ b_1 $ $ a_2 $ $ b_2 $ $ \vdots $ $ a_{N-1} $ $ b_{N-1} $

## 输出格式

答えを出力してください。

## 说明/提示

### 制約

- $ 2\leq\ N\leq\ 3000 $
- $ 1\leq\ a_i,\ b_i\leq\ N $
- 入力されるグラフは木である

### Sample Explanation 1

条件を満たす $ P $ は以下の $ 4 $ 通りです。 - $ P\ =\ (1,\ 3,\ 2) $ - $ P\ =\ (2,\ 1,\ 3) $ - $ P\ =\ (2,\ 3,\ 1) $ - $ P\ =\ (3,\ 1,\ 2) $

## 样例 #1

### 输入

```
3

1 2

2 3
```

### 输出

```
4
```

## 样例 #2

### 输入

```
4

1 2

1 3

1 4
```

### 输出

```
12
```

## 样例 #3

### 输入

```
6

1 2

2 3

3 4

4 5

5 6
```

### 输出

```
122
```

## 样例 #4

### 输入

```
9

8 5

9 8

1 9

2 5

6 1

7 6

3 8

4 1
```

### 输出

```
19080
```



---

---
title: "[ARC133D] Range XOR"
layout: "post"
diff: 省选/NOI-
pid: AT_arc133_d
tag: []
---

# [ARC133D] Range XOR

## 题目描述

[problemUrl]: https://atcoder.jp/contests/arc133/tasks/arc133_d

整数 $ L,R,V $ が与えられます． 次の条件を両方満たす整数の組 $ (l,r) $ の個数を $ 998244353 $ で割った余りを求めてください．

- $ L\ \leq\ l\ \leq\ r\ \leq\ R $
- $ l\ \oplus\ (l+1)\ \oplus\ \cdots\ \oplus\ r=V $

ただしここで，$ \oplus $ はビット単位 $ \mathrm{XOR} $ 演算を表します．

  ビット単位 $ \mathrm{XOR} $ 演算とは  非負整数 $ A,\ B $ のビット単位 $ \mathrm{XOR} $ 、$ A\ \oplus\ B $ は、以下のように定義されます。

- $ A\ \oplus\ B $ を二進表記した際の $ 2^k $ ($ k\ \geq\ 0 $) の位の数は、$ A,\ B $ を二進表記した際の $ 2^k $ の位の数のうち一方のみが $ 1 $ であれば $ 1 $、そうでなければ $ 0 $ である。
 
 例えば、$ 3\ \oplus\ 5\ =\ 6 $ となります (二進表記すると: $ 011\ \oplus\ 101\ =\ 110 $)。  
 一般に $ k $ 個の非負整数 $ p_1,\ p_2,\ p_3,\ \dots,\ p_k $ のビット単位 $ \mathrm{XOR} $ は $ (\dots\ ((p_1\ \oplus\ p_2)\ \oplus\ p_3)\ \oplus\ \dots\ \oplus\ p_k) $ と定義され、これは $ p_1,\ p_2,\ p_3,\ \dots\ p_k $ の順番によらないことが証明できます。

## 输入格式

入力は以下の形式で標準入力から与えられる．

> $ L $ $ R $ $ V $

## 输出格式

答えを出力せよ．

## 说明/提示

### 制約

- $ 1\ \leq\ L\ \leq\ R\ \leq\ 10^{18} $
- $ 0\ \leq\ V\ \leq\ 10^{18} $
- 入力される値はすべて整数である

### Sample Explanation 1

条件を満たすのは，$ (l,r)=(1,2) $ と $ (l,r)=(3,3) $ の $ 2 $ つです．

## 样例 #1

### 输入

```
1 3 3
```

### 输出

```
2
```

## 样例 #2

### 输入

```
10 20 0
```

### 输出

```
6
```

## 样例 #3

### 输入

```
1 1 1
```

### 输出

```
1
```

## 样例 #4

### 输入

```
12345 56789 34567
```

### 输出

```
16950
```



---

---
title: "[ARC135D] Add to Square"
layout: "post"
diff: 省选/NOI-
pid: AT_arc135_d
tag: []
---

# [ARC135D] Add to Square

## 题目描述

[problemUrl]: https://atcoder.jp/contests/arc135/tasks/arc135_d

$ H\times\ W $ のマス目があり、各マスに整数がひとつずつ書き込まれています。 $ 1\leq\ i\leq\ H $, $ 1\leq\ j\leq\ W $ に対して、$ i $ 行目・$ j $ 列目のマスに書き込まれている整数を $ A_{i,j} $ で表します。

あなたは次の操作を、何度でも行うことができます（一度も行わなくてもよいです）。

- $ 1\leq\ i\leq\ H\ -\ 1 $ かつ $ 1\leq\ j\leq\ W\ -\ 1 $ を満たす整数 $ i,\ j $ を選ぶ。
- 整数 $ x $ をひとつ選ぶ。
- $ A_{i,j} $, $ A_{i,j+1} $, $ A_{i+1,j} $, $ A_{i+1,j+1} $ に $ x $ を加える。

操作後の $ \sum_{i=1}^H\ \sum_{j=1}^W\ |A_{i,j}| $ が最小となるように操作を行うとき、操作後の $ \sum_{i=1}^H\ \sum_{j=1}^W\ |A_{i,j}| $ の値および、そのときのマス目の状態を出力してください。

## 输入格式

入力は以下の形式で標準入力から与えられます。

> $ H $ $ W $ $ A_{1,1} $ $ \ldots $ $ A_{1,W} $ $ \vdots $ $ A_{H,1} $ $ \ldots $ $ A_{H,W} $

## 输出格式

$ H\ +\ 1 $ 行出力してください。 $ 1 $ 行目には、$ \sum_{i=1}^H\ \sum_{j=1}^W\ |A_{i,j}| $ の値を出力してください。 $ 2 $ 行目から $ H+1 $ 行目には、マス目の状態を以下の形式で出力してください。

> $ A_{1,1} $ $ \ldots $ $ A_{1,W} $ $ \vdots $ $ A_{H,1} $ $ \ldots $ $ A_{H,W} $

条件を満たすマス目の状態が複数存在する場合は、どれを出力しても正解となります。

## 说明/提示

### 制約

- $ 2\leq\ H,\ W\ \leq\ 500 $
- $ |A_{i,j}|\leq\ 10^9 $

### Sample Explanation 1

例えば次のように操作を行うと、出力例のマス目の状態になります。 - $ (i,\ j,\ x)\ =\ (1,\ 1,\ -1) $ として操作を行う。 - $ (i,\ j,\ x)\ =\ (1,\ 2,\ -4) $ として操作を行う。 このとき、$ \sum_{i=1}^H\ \sum_{j=1}^W\ |A_{i,j}|\ =\ 0\ +\ 3\ +\ 1\ +\ 3\ +\ 0\ +\ 2\ =\ 9 $ です。

### Sample Explanation 2

$ |A_{i,j}|\ >\ 10^9 $ となるような操作も認められています。

## 样例 #1

### 输入

```
2 3

1 2 3

4 5 6
```

### 输出

```
9

0 -3 -1

3 0 2
```

## 样例 #2

### 输入

```
2 2

1000000000 -1000000000

-1000000000 1000000000
```

### 输出

```
4000000000

2000000000 0

0 2000000000
```

## 样例 #3

### 输入

```
3 4

0 2 0 -2

-3 -1 2 0

-3 -3 2 2
```

### 输出

```
0

0 0 0 0

0 0 0 0

0 0 0 0
```



---

---
title: "[ARC136E] Non-coprime DAG"
layout: "post"
diff: 省选/NOI-
pid: AT_arc136_e
tag: []
---

# [ARC136E] Non-coprime DAG

## 题目描述

[problemUrl]: https://atcoder.jp/contests/arc136/tasks/arc136_e

$ N $ 頂点からなる有向グラフ $ G $ があり，頂点には $ 1 $ から $ N $ までの番号がついています．

二つの頂点 $ i,j $ ($ 1\ \leq\ i,j\ \leq\ N $, $ i\ \neq\ j $) の間には，以下の条件を両方満たす時，またその時のみ，辺 $ i\ \to\ j $ が存在します．

- $ i\ <\ j $
- $ \mathrm{gcd}(i,j)\ >\ 1 $

また，各頂点にはそれぞれ価値が定まっており，頂点 $ i $ の価値は $ A_i $ です．

以下の条件を満たすように頂点の集合 $ s $ を選ぶことを考えます．

- $ s $ に含まれるどの二つの異なる頂点の組 $ (x,y) $ ($ x\ <\ y $) についても，$ G $ 上で $ x $ から $ y $ には到達できない．

$ s $ に含まれる頂点の価値の総和としてあり得る最大値を求めてください．

## 输入格式

入力は以下の形式で標準入力から与えられる．

> $ N $ $ A_1 $ $ A_2 $ $ \cdots $ $ A_N $

## 输出格式

答えを出力せよ．

## 说明/提示

### 制約

- $ 1\ \leq\ N\ \leq\ 10^6 $
- $ 1\ \leq\ A_i\ \leq\ 10^9 $
- 入力される値はすべて整数

### Sample Explanation 1

$ s=\{1,2,3,5\} $ とすればよいです．

### Sample Explanation 2

$ s=\{1,5,6\} $ とすればよいです．

## 样例 #1

### 输入

```
6

1 1 1 1 1 1
```

### 输出

```
4
```

## 样例 #2

### 输入

```
6

1 2 1 3 1 6
```

### 输出

```
8
```

## 样例 #3

### 输入

```
20

40 39 31 54 27 31 80 3 62 66 15 72 21 38 74 49 15 24 44 3
```

### 输出

```
343
```



---

---
title: "[ARC139C] One Three Nine"
layout: "post"
diff: 省选/NOI-
pid: AT_arc139_c
tag: []
---

# [ARC139C] One Three Nine

## 题目描述

[problemUrl]: https://atcoder.jp/contests/arc139/tasks/arc139_c

正の整数 $ N,M $ が与えられます。

以下を満たす整数の組の列 $ ((X_1,Y_1),(X_2,Y_2),\dots,(X_K,Y_K)) $ を**素晴らしい整数の組の列**ということとします。

- $ 1\ \le\ X_i\ \le\ N $
- $ 1\ \le\ Y_i\ \le\ M $
- $ i\ \neq\ j $ ならば $ X_i+3Y_i\ \neq\ X_j+3Y_j $ かつ $ 3X_i+Y_i\ \neq\ 3X_j+Y_j $

素晴らしい整数の組の列のうち、長さ $ K $ が最大であるものを $ 1 $ 個構築してください。

## 输入格式

入力は以下の形式で標準入力から与えられます。

> $ N $ $ M $

## 输出格式

以下の形式で出力してください。

> $ K $ $ X_1 $ $ Y_1 $ $ X_2 $ $ Y_2 $ $ \vdots $ $ X_K $ $ Y_K $

ここで、$ K $ は素晴らしい整数の組の列の長さの最大値とします。そして、$ ((X_1,Y_1),(X_2,Y_2),\dots,(X_K,Y_K)) $ は素晴らしい整数の組の列である必要があります。 答えが複数存在する場合、どれを出力しても正解とみなされます。

## 说明/提示

### 制約

- $ 1\ \le\ N,M\ \le\ 10^5 $
- 入力は全て整数である。

### Sample Explanation 1

$ N=3,M=4 $ の時、長さ $ 11 $ 以上の素晴らしい整数の組の列は存在せず、かつ上記の出力は素晴らしい整数の組の列であるためこの出力は正当です。

## 样例 #1

### 输入

```
3 4
```

### 输出

```
10

1 1

1 2

1 3

2 1

2 2

2 3

3 1

3 2

3 3

3 4
```



---

---
title: "[ARC139D] Priority Queue 2"
layout: "post"
diff: 省选/NOI-
pid: AT_arc139_d
tag: []
---

# [ARC139D] Priority Queue 2

## 题目描述

[problemUrl]: https://atcoder.jp/contests/arc139/tasks/arc139_d

要素数が $ N $ の整数の多重集合 $ A=\lbrace\ A_1,A_2,...,A_N\ \rbrace $ が与えられます。$ A $ の要素は全て $ 1 $ 以上 $ M $ 以下であることが保証されています。

以下の操作を $ K $ 回繰り返します。

- $ 1 $ 以上 $ M $ 以下の整数を選び、$ A $ に追加する。その後、$ A $ の中で $ X $ 番目に小さい値を $ 1 $ 個削除する。

$ A $ の中で $ X $ 番目に小さい値とは、$ A $ の要素を単調非減少になるように一列に並べたとき、先頭から $ X $ 番目にくる値のことです。

$ 1 $ 以上 $ M $ 以下の値を $ K $ 回選ぶ方法は $ M^K $ 通りありますが、その全てに対して操作終了後の $ A $ の要素の総和を求めたとします。これらの $ M^K $ 個の値の総和を $ 998244353 $ で割ったあまりを求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられます。

> $ N $ $ M $ $ K $ $ X $ $ A_1 $ $ A_2 $ $ \dots $ $ A_N $

## 输出格式

答えを出力してください。

## 说明/提示

### 制約

- $ 1\ \le\ N,M,K\ \le\ 2000 $
- $ 1\ \le\ X\ \le\ N+1 $
- $ 1\ \le\ A_i\ \le\ M $
- 入力は全て整数である。

### Sample Explanation 1

初め $ A=\{1,3\} $ です。操作の例としては以下のようなものが考えられます。 - $ A $ に $ 4 $ を追加する。$ A=\{1,3,4\} $ となる。$ A $ の $ 1 $ 番目に小さい値を削除する。$ A=\{3,4\} $ となる。 - $ A $ に $ 3 $ を追加する。$ A=\{3,3,4\} $ となる。$ A $ の $ 1 $ 番目に小さい値を削除する。$ A=\{3,4\} $ となる。 この場合、操作後の $ A $ の要素の総和は $ 3+4=7 $ となります。

## 样例 #1

### 输入

```
2 4 2 1

1 3
```

### 输出

```
99
```

## 样例 #2

### 输入

```
5 9 6 3

3 7 1 9 9
```

### 输出

```
15411789
```



---

---
title: "[ARC140D] One to One"
layout: "post"
diff: 省选/NOI-
pid: AT_arc140_d
tag: []
---

# [ARC140D] One to One

## 题目描述

[problemUrl]: https://atcoder.jp/contests/arc140/tasks/arc140_d

全ての要素が $ 1 $ 以上 $ N $ 以下である長さ $ N $ の整数列 $ X=(X_1,X_2,\dots,X_N) $ に対して次の問題を考え、その答えを $ f(X) $ とします。

> $ N $ 頂点の無向グラフ $ G $ があります。($ G $ は多重辺や自己ループを含むことがあります。) $ G $ の辺は $ N $ 本あり、そのうち $ i $ 番目の辺は頂点 $ i $ と頂点 $ X_i $ を繋ぐ辺です。$ G $ の連結成分の個数を求めてください。

長さ $ N $ の整数列 $ A=(A_1,A_2,\dots,A_N) $ が与えられます。各 $ A_i $ は $ 1 $ 以上 $ N $ 以下の整数あるいは $ -1 $ です。

全ての要素が $ 1 $ 以上 $ N $ 以下である長さ $ N $ の整数列 $ X=(X_1,X_2,\dots,X_N) $ であって、$ A_i\ \neq\ -1\ \Rightarrow\ A_i\ =\ X_i $ を満たすものを考えます。そのような全ての $ X $ に対する $ f(X) $ の総和を $ 998244353 $ で割ったあまりを求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ A_1 $ $ A_2 $ $ \dots $ $ A_N $

## 输出格式

答えを出力せよ。

## 说明/提示

### 制約

- $ 1\ \le\ N\ \le\ 2000 $
- $ A_i $ は $ 1 $ 以上 $ N $ 以下あるいは $ -1 $ である。
- 入力は全て整数である。

### Sample Explanation 1

$ X $ として条件を満たすものは以下の $ 3 $ 通りがあります。 - $ X=(1,1,3) $ の時、問題の答えは $ 2 $ です。 - $ X=(2,1,3) $ の時、問題の答えは $ 2 $ です。 - $ X=(3,1,3) $ の時、問題の答えは $ 1 $ です。 よって答えは $ 2+2+1=5 $ です。

## 样例 #1

### 输入

```
3

-1 1 3
```

### 输出

```
5
```

## 样例 #2

### 输入

```
1

1
```

### 输出

```
1
```

## 样例 #3

### 输入

```
8

-1 3 -1 -1 8 -1 -1 -1
```

### 输出

```
433760
```



---

---
title: "[ARC140E] Not Equal Rectangle"
layout: "post"
diff: 省选/NOI-
pid: AT_arc140_e
tag: []
---

# [ARC140E] Not Equal Rectangle

## 题目描述

[problemUrl]: https://atcoder.jp/contests/arc140/tasks/arc140_e

$ N\ \times\ M $ のマス目があり、あなたはこれから全てのマスに $ 1 $ 以上 $ 25 $ 以下の整数を $ 1 $ つずつ書き込みます。上から $ i $ 行目、左から $ j $ 列目のマスに書き込む整数を $ a_{i,j} $ とします。

以下の条件を満たす整数の書き込み方を一つ求めてください。本問題の制約下で、条件を満たす整数の書き込み方が必ず存在することが証明できます。

- 任意の整数 $ 1\leq\ x_1\ <\ x_2\leq\ N,1\leq\ y_1\ <\ y_2\ \leq\ M $ について、$ a_{x_1,y_1},a_{x_1,y_2},a_{x_2,y_1},a_{x_2,y_2} $ が全て一致してはならない。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ M $

## 输出格式

条件を満たす書き込み方の $ 1 $ つを、以下の形式で出力せよ。

> $ a_{1,1} $ $ a_{1,2} $ $ \ldots $ $ a_{1,M} $ $ a_{2,1} $ $ a_{2,2} $ $ \ldots $ $ a_{2,M} $ $ \vdots $ $ a_{N,1} $ $ a_{N,2} $ $ \ldots $ $ a_{N,M} $

条件を満たす解が複数存在する場合、どれを出力しても正解とみなされる。

## 说明/提示

### 制約

- $ 2\ \leq\ N\ ,\ M\ \leq\ 500 $
- 入力は全て整数

### Sample Explanation 1

$ (x_1,x_2,y_1,y_2) $ の組として考えられるのは $ (1,2,1,2),(1,2,2,3),(1,2,1,3) $ の $ 3 $ つです。 どの組についても $ 4 $ マスに書かれた数字が全て一致してはいないので、この出力は条件を満たします。

## 样例 #1

### 输入

```
2 3
```

### 输出

```
1 1 1

1 2 3
```



---

---
title: "[ARC141D] Non-divisible Set"
layout: "post"
diff: 省选/NOI-
pid: AT_arc141_d
tag: []
---

# [ARC141D] Non-divisible Set

## 题目描述

[problemUrl]: https://atcoder.jp/contests/arc141/tasks/arc141_d

正整数からなる集合 $ S $ について、任意の $ a,\ b\ \in\ S\ (a\neq\ b) $ について $ b $ が $ a $ の倍数でないとき、 $ S $ を「良い集合」と呼びます。

$ N $ 個の $ 1 $ 以上 $ 2M $ 以下の整数からなる集合 $ S=\lbrace\ A_1,\ A_2,\ \dots,\ A_N\rbrace $ が与えられます。

各 $ i=1,\ 2,\ \dots,\ N $ に対し、$ A_i $ を含む $ S $ の部分集合であって、要素数が $ M $ である「良い集合」が存在するか判定してください。

## 输入格式

入力は以下の形式で標準入力から与えられます。

> $ N $ $ M $ $ A_1 $ $ A_2 $ $ \dots $ $ A_{N} $

## 输出格式

$ N $ 行出力してください。 $ i $ 行目には $ A_i $ を含む $ S $ の部分集合であって、要素数が $ M $ である「良い集合」が存在する場合 `Yes` を、存在しない場合 `No` を出力してください。

## 说明/提示

### 制約

- $ M\ \leq\ N\ \leq\ 2M $
- $ 1\ \leq\ M\ \leq\ 3\ \times\ 10^5 $
- $ 1\ \leq\ A_1\ <\ A_2\ <\ \dots\ <\ A_N\ \leq\ 2M $
- 入力される値はすべて整数

### Sample Explanation 1

$ A_1=1 $ を含む「良い集合」は明らかに $ \lbrace\ 1\rbrace $ しか存在せず、要素数は $ 1 $ しかないため、$ i=1 $ に対する答えは `No` です。 $ A_2=2 $ を含む「良い集合」としては例えば $ \lbrace\ 2,\ 3,\ 5\rbrace $ が考えられます。このことから $ i=2 $ に対する答えは `Yes` です。

## 样例 #1

### 输入

```
5 3

1 2 3 4 5
```

### 输出

```
No

Yes

Yes

Yes

Yes
```

## 样例 #2

### 输入

```
4 4

2 4 6 8
```

### 输出

```
No

No

No

No
```

## 样例 #3

### 输入

```
13 10

2 3 4 6 7 9 10 11 13 15 17 19 20
```

### 输出

```
No

No

Yes

Yes

Yes

Yes

Yes

Yes

Yes

Yes

Yes

Yes

No
```



---

---
title: "[ARC141E] Sliding Edge on Torus"
layout: "post"
diff: 省选/NOI-
pid: AT_arc141_e
tag: []
---

# [ARC141E] Sliding Edge on Torus

## 题目描述

[problemUrl]: https://atcoder.jp/contests/arc141/tasks/arc141_e

$ N^2 $ 頂点からなる無向グラフがあります。はじめ、グラフは辺を持ちません。 $ 0\ \leq\ i,\ j\ <\ N $ を満たす整数の組 $ (i,\ j) $ それぞれについて、それに対応する頂点がひとつ存在し、その頂点を $ (i,\ j) $ と呼びます。

$ Q $ 個のクエリが与えられます。$ i $ 番目のクエリでは $ 4 $ つの整数 $ a_i,\ b_i,\ c_i,\ d_i $ が与えられるので以下のように順番に処理してください。

- 各 $ k\ (0\ \leq\ k\ <\ N) $ について、$ 2 $ 頂点 $ ((a_i+k)\ \bmod\ N,\ (b_i+k)\ \bmod\ N),\ ((c_i+k)\ \bmod\ N,\ (d_i+k)\ \bmod\ N) $ 間に辺を追加してください。その後、グラフの連結成分数を出力してください。

## 输入格式

入力は以下の形式で標準入力から与えられます。

> $ N $ $ Q $ $ a_1 $ $ b_1 $ $ c_1 $ $ d_1 $ $ a_2 $ $ b_2 $ $ c_2 $ $ d_2 $ $ \vdots $ $ a_Q $ $ b_Q $ $ c_Q $ $ d_Q $

## 输出格式

$ Q $ 行出力してください。$ i $ 行目には $ i $ 番目のクエリにおけるグラフの連結成分数を出力してください。

## 说明/提示

### 制約

- $ 2\ \leq\ N\ \leq\ 2\ \times\ 10^5 $
- $ 1\ \leq\ Q\ \leq\ 2\ \times\ 10^5 $
- $ 0\ \leq\ a_i,\ b_i,\ c_i,\ d_i\ <\ N $
- $ (a_i,\ b_i)\ \neq\ (c_i,\ d_i) $
- 入力される値はすべて整数

### Sample Explanation 1

$ 1 $ 番目のクエリでは頂点 $ (0,\ 0),\ (1,\ 2) $ 間、$ (1,\ 1),\ (2,\ 0) $ 間、$ (2,\ 2),\ (0,\ 1) $ 間に辺が追加されます。これにより連結成分数は $ 9 $ から $ 6 $ に変化します。

### Sample Explanation 2

クエリ処理の結果、グラフは単純グラフではなくなることがあります。

## 样例 #1

### 输入

```
3 3

0 0 1 2

2 0 0 0

1 1 2 2
```

### 输出

```
6

4

4
```

## 样例 #2

### 输入

```
4 3

0 0 2 2

2 3 1 2

1 1 3 3
```

### 输出

```
14

11

11
```

## 样例 #3

### 输入

```
6 5

0 0 1 1

1 2 3 4

1 1 5 3

2 0 1 5

5 0 3 3
```

### 输出

```
31

27

21

21

19
```



---

---
title: "[ARC143E] Reversi"
layout: "post"
diff: 省选/NOI-
pid: AT_arc143_e
tag: []
---

# [ARC143E] Reversi

## 题目描述

[problemUrl]: https://atcoder.jp/contests/arc143/tasks/arc143_e

$ N $ 頂点からなる木があります． 各頂点には $ 1 $ から $ N $ までの番号がついており， $ i $ 番目の辺は頂点 $ A_i $ と頂点 $ B_i $ を結んでいます． また，各頂点にはリバーシの石が $ 1 $ つずつ置かれています． 各頂点に置かれている石の状態は文字列 $ S $ によって与えられ， $ S $ の $ i $ 番目の文字が `B` のとき，頂点 $ i $ に置かれている石の表は黒色， $ S $ の $ i $ 番目の文字が `W` のとき，頂点 $ i $ に置かれている石の表は白色です．

以下の操作を $ N $ 回行い，すべての頂点から石を取り除くことが可能かどうか判定してください． また可能ならば，列 $ P_1,P_2,\ldots,P_N $ であって，頂点 $ P_1,P_2,\ldots,P_N $ をこの順に選ぶことが可能なもののうち，辞書順で最小のものを求めてください．

- 表が白色の石が置かれている頂点を $ 1 $ つ選び，その頂点から石を取り除く． そして，その頂点と隣接する頂点に置かれている石をすべて裏返す．
 
リバーシの石について リバーシの石は一方の面が黒色，もう一方の面が白色になっており，裏返すと表の色が入れ替わります． 数列の辞書順とは？ 相異なる数列 $ S $ と数列 $ T $ の大小を判定するアルゴリズムを以下に説明します．

以下では $ S $ の $ i $ 番目の要素を $ S_i $ のように表します．また， $ S $ が $ T $ より辞書順で小さい場合は $ S\ \lt\ T $ ，大きい場合は $ S\ \gt\ T $ と表します．

1. $ S $ と $ T $ のうち長さが短い方の文字列の長さを $ L $ とします．$ i=1,2,\dots,L $ に対して $ S_i $ と $ T_i $ が一致するか調べます．
2. $ S_i\ \neq\ T_i $ である $ i $ が存在する場合，そのような $ i $ のうち最小のものを $ j $ とします．そして，$ S_j $ と $ T_j $ を比較して， $ S_j $ が $ T_j $ より（数として）小さい場合は $ S\ \lt\ T $ ，大きい場合は $ S\ \gt\ T $ と決定して，アルゴリズムを終了します．
3. $ S_i\ \neq\ T_i $ である $ i $ が存在しない場合， $ S $ と $ T $ の長さを比較して，$ S $ が $ T $ より短い場合は $ S\ \lt\ T $ ，長い場合は $ S\ \gt\ T $ と決定して，アルゴリズムを終了します．

## 输入格式

入力は以下の形式で標準入力から与えられる．

> $ N $ $ A_1 $ $ B_1 $ $ \vdots $ $ A_{N-1} $ $ B_{N-1} $ $ S $

## 输出格式

目標が達成可能でない場合，`-1` を出力せよ．可能である場合，以下の形式で答えを出力せよ．

> $ P_1 $ $ P_2 $ $ \cdots $ $ P_N $

## 说明/提示

### 制約

- $ 1\ \leq\ N\ \leq\ 2\times\ 10^5 $
- $ 1\ \leq\ A_i,\ B_i\ \leq\ N $
- 与えられるグラフは木である．
- $ S $ は `B` と `W` の文字からなる長さ $ N $ の文字列である．

### Sample Explanation 2

この場合，一度も操作を行うことができません．

## 样例 #1

### 输入

```
4

1 2

2 3

3 4

WBWW
```

### 输出

```
1 2 4 3
```

## 样例 #2

### 输入

```
4

1 2

2 3

3 4

BBBB
```

### 输出

```
-1
```



---

---
title: "[ARC144D] AND OR Equation"
layout: "post"
diff: 省选/NOI-
pid: AT_arc144_d
tag: []
---

# [ARC144D] AND OR Equation

## 题目描述

[problemUrl]: https://atcoder.jp/contests/arc144/tasks/arc144_d

正整数 $ N,\ K $ が与えられます．整数列 $ \bigl(f(0),\ f(1),\ \ldots,\ f(2^N-1)\bigr) $ であって，以下の条件をすべて満たすものの個数を $ 998244353 $ で割った余りを答えてください．

- 任意の非負整数 $ x $ ($ 0\leq\ x\ \leq\ 2^N-1 $) に対して $ 0\leq\ f(x)\leq\ K $.
- 任意の非負整数 $ x,\ y $ ($ 0\leq\ x,\ y\ \leq\ 2^N-1 $) に対して $ f(x)\ +\ f(y)\ =\ f(x\ \,\mathrm{AND}\,\ y)\ +\ f(x\ \,\mathrm{OR}\,\ y) $.

ただし，$ \mathrm{AND} $, $ \mathrm{OR} $ はそれぞれビットごとの論理積，論理和を表します．

## 输入格式

入力は以下の形式で標準入力から与えられます．

> $ N $ $ K $

## 输出格式

条件を満たす整数列の個数を $ 998244353 $ で割った余りを出力してください．

## 说明/提示

### 制約

- $ 1\leq\ N\leq\ 3\times\ 10^5 $
- $ 1\leq\ K\leq\ 10^{18} $

### Sample Explanation 1

条件を満たす整数列は以下の $ 6 $ 個です． - $ (0,0,0,0) $ - $ (0,1,0,1) $ - $ (0,0,1,1) $ - $ (1,0,1,0) $ - $ (1,1,0,0) $ - $ (1,1,1,1) $

## 样例 #1

### 输入

```
2 1
```

### 输出

```
6
```

## 样例 #2

### 输入

```
2 2
```

### 输出

```
19
```

## 样例 #3

### 输入

```
100 123456789123456789
```

### 输出

```
34663745
```



---

---
title: "[ARC146C] Even XOR"
layout: "post"
diff: 省选/NOI-
pid: AT_arc146_c
tag: []
---

# [ARC146C] Even XOR

## 题目描述

[problemUrl]: https://atcoder.jp/contests/arc146/tasks/arc146_c

$ 0 $ 以上 $ 2^N $ 未満の非負整数からなる集合 $ S $ のうち、以下の条件を満たすものの個数を $ 998244353 $ で割ったあまりを出力してください。

- $ S $ の空でない部分集合 $ T $ は以下のどちらかを満たす。
  - $ T $ の要素数が奇数
  - $ T $ の全要素の $ \mathrm{XOR} $ が $ 0 $ でない
 
 $ \mathrm{XOR} $ とは  非負整数 $ A,\ B $ のビット単位 $ \mathrm{XOR} $ 、$ A\ \oplus\ B $ は、以下のように定義されます。

- $ A\ \oplus\ B $ を二進表記した際の $ 2^k $ ($ k\ \geq\ 0 $) の位の数は、$ A,\ B $ を二進表記した際の $ 2^k $ の位の数のうち一方のみが $ 1 $ であれば $ 1 $、そうでなければ $ 0 $ である。
 
 例えば、$ 3\ \oplus\ 5\ =\ 6 $ となります (二進表記すると: $ 011\ \oplus\ 101\ =\ 110 $)。  
 一般に $ k $ 個の整数 $ p_1,\ p_2,\ p_3,\ \dots,\ p_k $ のビット単位 $ \mathrm{XOR} $ は $ (\dots\ ((p_1\ \oplus\ p_2)\ \oplus\ p_3)\ \oplus\ \dots\ \oplus\ p_k) $ と定義され、これは $ p_1,\ p_2,\ p_3,\ \dots\ p_k $ の順番によらないことが証明できます。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $

## 输出格式

答えを出力せよ。

## 说明/提示

### 制約

- $ 1\ \le\ N\ \le\ 2\ \times\ 10^5 $
- 入力は全て整数である。

### Sample Explanation 1

$ \lbrace\ 0,2,3\ \rbrace $ や $ \lbrace\ 1\ \rbrace $ や $ \lbrace\ \rbrace $ は条件を満たします。 $ \lbrace\ 0,1,2,3\ \rbrace $ は条件を満たしません。 なぜなら、$ \lbrace\ 0,1,2,3\ \rbrace $ は部分集合 $ \lbrace\ 0,1,2,3\ \rbrace $ が要素数が偶数であり、全要素の $ \mathrm{XOR} $ が $ 0 $ であるからです。

## 样例 #1

### 输入

```
2
```

### 输出

```
15
```

## 样例 #2

### 输入

```
146
```

### 输出

```
743874490
```



---

---
title: "[ARC146D] >=<"
layout: "post"
diff: 省选/NOI-
pid: AT_arc146_d
tag: []
---

# [ARC146D] >=<

## 题目描述

[problemUrl]: https://atcoder.jp/contests/arc146/tasks/arc146_d

長さ $ N $ かつ全要素が $ 1 $ 以上 $ M $ 以下の整数列 $ A=(A_1,A_2,\dots,A_N) $ であって、以下の条件を全て満たすものを「素晴らしい整数列」と呼びます。

- $ 1\ \le\ i\ \le\ K $ を満たす整数 $ i $ に対して、以下のうちのいずれかが成り立つ。
  - $ A_{P_i}\ <\ X_i $ かつ $ A_{Q_i}\ <\ Y_i $
  - $ A_{P_i}\ =\ X_i $ かつ $ A_{Q_i}\ =\ Y_i $
  - $ A_{P_i}\ >\ X_i $ かつ $ A_{Q_i}\ >\ Y_i $

「素晴らしい整数列」が存在するか判定し、存在するならば「素晴らしい整数列」の要素の総和としてあり得る最小値を求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ M $ $ K $ $ P_1 $ $ X_1 $ $ Q_1 $ $ Y_1 $ $ P_2 $ $ X_2 $ $ Q_2 $ $ Y_2 $ $ \vdots $ $ P_K $ $ X_K $ $ Q_K $ $ Y_K $

## 输出格式

「素晴らしい整数列」が存在する場合は「素晴らしい整数列」の要素の総和としてあり得る最小値を、「素晴らしい整数列」が存在しない場合は $ -1 $ を出力せよ。

## 说明/提示

### 制約

- $ 1\ \le\ N,M,K\ \le\ 2\ \times\ 10^5 $
- $ 1\ \le\ P_i,Q_i\ \le\ N $
- $ 1\ \le\ X_i,Y_i\ \le\ M $
- $ P_i\ \neq\ Q_i $
- 入力は全て整数である。

### Sample Explanation 1

$ A=(2,3,1) $ は全ての条件を満たすので「素晴らしい整数列」です。この場合要素の総和は $ 6 $ です。 要素の総和が $ 5 $ 以下の「素晴らしい整数列」は存在しないため、解は $ 6 $ です。

### Sample Explanation 2

「素晴らしい整数列」は存在しないため、$ -1 $ を出力します。

## 样例 #1

### 输入

```
3 4 3

3 1 1 2

1 1 2 2

3 4 1 4
```

### 输出

```
6
```

## 样例 #2

### 输入

```
2 2 2

1 1 2 2

2 1 1 2
```

### 输出

```
-1
```

## 样例 #3

### 输入

```
5 10 10

4 1 2 7

5 1 3 2

2 9 4 4

5 4 2 9

2 9 1 9

4 8 3 10

5 7 1 5

3 5 1 2

3 8 2 10

2 9 4 8
```

### 输出

```
12
```



---

---
title: "[ARC146E] Simple Speed"
layout: "post"
diff: 省选/NOI-
pid: AT_arc146_e
tag: []
---

# [ARC146E] Simple Speed

## 题目描述

[problemUrl]: https://atcoder.jp/contests/arc146/tasks/arc146_e

長さ $ N $ の正整数列 $ A=(A_1,A_2,\dots,A_N) $ が与えられます。

$ 1 $ 以上 $ N $ 以下の整数からなる整数列 $ B $ のうち、以下の条件を全て満たすものの個数を $ 998244353 $ で割ったあまりを出力してください。

- $ 1\ \le\ i\ \le\ N $ を満たす整数 $ i $ に対し、$ B $ の中に $ i $ はちょうど $ A_i $ 個存在する。
- $ 1\ \le\ i\ \le\ |B|-1 $ を満たす整数 $ i $ に対し、$ |B_i\ -\ B_{i+1}|=1 $ が成り立つ。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ A_1 $ $ A_2 $ $ \dots $ $ A_N $

## 输出格式

答えを出力せよ。

## 说明/提示

### 制約

- $ 1\ \le\ N\ \le\ 2\ \times\ 10^5 $
- $ 1\ \le\ A_i\ \le\ 2\ \times\ 10^5 $
- 入力はすべて整数である。

### Sample Explanation 1

$ B $ としてあり得るものは、以下の $ 6 $ 通りがあります。 - $ (1,2,1,2,3,2) $ - $ (1,2,3,2,1,2) $ - $ (2,1,2,1,2,3) $ - $ (2,1,2,3,2,1) $ - $ (2,3,2,1,2,1) $ - $ (3,2,1,2,1,2) $ よって、解は $ 6 $ です。

### Sample Explanation 2

条件を満たす $ B $ が存在しないこともあります。

## 样例 #1

### 输入

```
3

2 3 1
```

### 输出

```
6
```

## 样例 #2

### 输入

```
1

200000
```

### 输出

```
0
```

## 样例 #3

### 输入

```
6

12100 31602 41387 41498 31863 12250
```

### 输出

```
750337372
```



---

---
title: "[ARC147E] Examination"
layout: "post"
diff: 省选/NOI-
pid: AT_arc147_e
tag: []
---

# [ARC147E] Examination

## 题目描述

[problemUrl]: https://atcoder.jp/contests/arc147/tasks/arc147_e

$ 1,2,\ldots,N $ の番号のついた $ N $ 人の生徒が試験を受けました。人 $ i\,(1\ \leq\ i\ \leq\ N) $ の点数は $ A_i $ でしたが、$ B_i $ 点以上取らないと留年です。そこで誰も留年しないように、ある $ 2 $ 人の点数を入れ替える、という操作を任意の回数行うことにしました。

これが可能かを判定し、もし可能ならば一度も点数を入れ替えなかった人数の最大値を求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ A_1 $ $ B_1 $ $ A_2 $ $ B_2 $ $ \vdots $ $ A_N $ $ B_N $

## 输出格式

誰も留年しないように操作を行うことが可能な場合、一度も点数を入れ替えなかった人数の最大値を出力せよ。

不可能な場合は `-1` を出力せよ。

## 说明/提示

### 制約

- $ 2\ \leq\ N\ \leq\ 3\ \times\ 10^5 $
- $ 1\ \leq\ A_i,B_i\ \leq\ 10^9\,(1\ \leq\ i\ \leq\ N) $
- 入力はすべて整数

### Sample Explanation 1

人 $ 1 $ と人 $ 2 $ の点数を入れ替えると、誰も留年しません。このとき、一度も点数を入れ替えなかった人は人 $ 3 $ だけなので、$ 1 $ を出力します。

## 样例 #1

### 输入

```
3

1 2

3 1

3 3
```

### 输出

```
1
```

## 样例 #2

### 输入

```
2

100 1

100 1
```

### 输出

```
2
```

## 样例 #3

### 输入

```
6

3 2

1 6

4 5

1 3

5 5

9 8
```

### 输出

```
-1
```

## 样例 #4

### 输入

```
6

3 1

4 5

5 2

2 3

5 4

5 1
```

### 输出

```
3
```



---

---
title: "[ARC148E] ≥ K"
layout: "post"
diff: 省选/NOI-
pid: AT_arc148_e
tag: []
---

# [ARC148E] ≥ K

## 题目描述

给定长度为 $n$ 的数列 $\{a_i\}$ 和一个自然数 $K$, 可以将 $\{a_i\}$ 打乱顺序重排，问多少种结果序列满足 $\forall i \in [1,n), a'_i + a'_{i+1} \ge K$。 答案对 $998244353$ 取模。

## 输入格式

$n\ \ K$    
$a_1\ \ a_2\ ... \ a_n$

## 输出格式

一个整数，答案对 $998244353$ 取模的结果。
##### 样例解释1
共 $4$ 个：$ (1,\ 4,\ 2,\ 3) - (1,\ 4,\ 3,\ 2)- (2,\ 3,\ 4,\ 1) - (3,\ 2,\ 4,\ 1)$

## 说明/提示

$ 2 \le n \le 2 \times 10^5$  
$ 0 \le a_i, K \le 10^9$

## 样例 #1

### 输入

```
4 5

1 2 3 4
```

### 输出

```
4
```

## 样例 #2

### 输入

```
4 3

1 2 3 3
```

### 输出

```
12
```

## 样例 #3

### 输入

```
10 7

3 1 4 1 5 9 2 6 5 3
```

### 输出

```
108
```



---

---
title: "[ARC149D] Simultaneous Sugoroku"
layout: "post"
diff: 省选/NOI-
pid: AT_arc149_d
tag: []
---

# [ARC149D] Simultaneous Sugoroku

## 题目描述

[problemUrl]: https://atcoder.jp/contests/arc149/tasks/arc149_d

$ N $ 個のコマが数直線上の整数座標に置かれています．$ i $ 番目のコマは座標 $ X_i $ に置かれています．

これらのコマを，次のように $ M $ 回移動させます．

- $ i $ 回目の操作では，正整数 $ D_i $ が与えられ，各コマを次のように移動させる．
  - 座標が負の整数であるようなコマは，正の方向に距離 $ D_i $ 進んだ位置に移動させる．
  - 座標が $ 0 $ であるようなコマは動かさない．
  - 座標が正の整数であるようなコマは，負の方向に距離 $ D_i $ 進んだ位置に移動させる．

各コマが原点に到達するか否かを判定してください．原点に到達する場合には，はじめて原点に到達するのが何回目の移動によるものかを出力してください．原点に到達しない場合には，$ M $ 回の移動がすべて終了したときの座標を出力してください．

## 输入格式

入力は以下の形式で標準入力から与えられます．

> $ N $ $ M $ $ X_1 $ $ \ldots $ $ X_N $ $ D_1 $ $ \ldots $ $ D_M $

## 输出格式

$ N $ 行出力してください．$ i $ 行目には，$ i $ 番目のコマに対する答を，以下に述べる形式で出力してください．

コマが原点に到達する場合には，はじめて原点に到達するのが $ x $ 回目の移動であるとして

> Yes $ x $

と出力してください．コマが原点に到達しない場合には，$ M $ 回の移動がすべて終了したときの座標が $ x $ であるとして

> No $ x $

と出力してください．

## 说明/提示

### 制約

- $ 1\leq\ N\leq\ 3\times\ 10^5 $
- $ 1\leq\ M\leq\ 3\times\ 10^5 $
- $ 1\leq\ X_1\ <\ \cdots\ <\ X_N\ \leq\ 10^6 $
- $ 1\leq\ D_i\ \leq\ 10^6 $

### Sample Explanation 1

各コマの座標は次のように変化します． - $ 1 $ 番目のコマ：$ \phantom{0}2\quad\ \longmapsto\ \quad\ -6\quad\ \longmapsto\ \quad\ -4\quad\ \longmapsto\ \quad\ \phantom{-}1\ \quad\ \longmapsto\ \quad\ -6 $. - $ 2 $ 番目のコマ：$ \phantom{0}4\ \quad\ \longmapsto\ \quad\ -4\quad\ \longmapsto\ \quad\ -2\ \quad\ \longmapsto\ \quad\ \phantom{-}3\ \quad\ \longmapsto\ \quad\ -4 $. - $ 3 $ 番目のコマ：$ \phantom{0}6\ \quad\ \longmapsto\ \quad\ -2\quad\ \longmapsto\ \quad\ \phantom{-}0\ \quad\ \longmapsto\ \quad\ \phantom{-}0\ \quad\ \longmapsto\ \quad\ \phantom{-}0 $. - $ 4 $ 番目のコマ：$ \phantom{0}8\ \quad\ \longmapsto\ \quad\ \phantom{-}0\quad\ \longmapsto\ \quad\ \phantom{-}0\ \quad\ \longmapsto\ \quad\ \phantom{-}0\ \quad\ \longmapsto\ \quad\ \phantom{-}0 $. - $ 5 $ 番目のコマ：$ 10\ \quad\ \longmapsto\ \quad\ \phantom{-}2\quad\ \longmapsto\ \quad\ \phantom{-}0\ \quad\ \longmapsto\ \quad\ \phantom{-}0\ \quad\ \longmapsto\ \quad\ \phantom{-}0 $. - $ 6 $ 番目のコマ：$ 12\ \quad\ \longmapsto\ \quad\ \phantom{-}4\quad\ \longmapsto\ \quad\ \phantom{-}2\ \quad\ \longmapsto\ \quad\ -3\ \quad\ \longmapsto\ \quad\ \phantom{-}4 $.

## 样例 #1

### 输入

```
6 4

2 4 6 8 10 12

8 2 5 7
```

### 输出

```
No -6

No -4

Yes 2

Yes 1

Yes 2

No 4
```



---

---
title: "[ARC149E] Sliding Window Sort"
layout: "post"
diff: 省选/NOI-
pid: AT_arc149_e
tag: []
---

# [ARC149E] Sliding Window Sort

## 题目描述

[problemUrl]: https://atcoder.jp/contests/arc149/tasks/arc149_e

正整数 $ N,\ M,\ K $ が与えられます．正整数列 $ A\ =\ (A_0,\ \ldots,\ A_{N-1}) $ に対する次の操作を考えます．

- $ k=0,\ 1,\ \ldots,\ K-1 $ の順に次を行う．
  - $ A_{k\bmod\ N},\ A_{(k+1)\bmod\ N},\ \ldots,\ A_{(k+M-1)\bmod\ N} $ を昇順にソートする．つまり $ A_{k\bmod\ N},\ A_{(k+1)\bmod\ N},\ \ldots,\ A_{(k+M-1)\bmod\ N} $ を小さい方から順に並べたものを $ (x_0,\ \ldots,\ x_{M-1}) $ とするとき，各 $ 0\leq\ j\ <\ M $ に対して $ A_{(k+j)\bmod\ N} $ を $ x_j $ に置き換える．

$ 1 $ 以上 $ N $ 以下の整数からなる順列 $ B\ =\ (B_0,\ \ldots,\ B_{N-1}) $ が与えられます．正整数列 $ A $ であって，上記の操作を行った結果が $ B $ と一致するものの個数を $ 998244353 $ で割った余りを答えてください．

## 输入格式

入力は以下の形式で標準入力から与えられます．

> $ N $ $ M $ $ K $ $ B_0 $ $ \ldots $ $ B_{N-1} $

## 输出格式

正整数列 $ A $ であって，操作を行った結果が $ B $ と一致するものの個数を $ 998244353 $ で割った余りを出力してください．

## 说明/提示

### 制約

- $ 2\leq\ N\leq\ 3\times\ 10^5 $
- $ 2\leq\ M\leq\ N $
- $ 1\leq\ K\leq\ 10^9 $
- $ 1\leq\ B_i\leq\ N $
- $ i\neq\ j $ ならば $ B_i\neq\ B_j $

### Sample Explanation 1

例えば $ A\ =\ (4,1,5,6,2,3) $ が条件を満たします．この $ A $ に対して，操作は次のように進行します． - $ k=0 $ に対する操作により，$ A $ は $ (1,4,5,6,2,3) $ になる． - $ k=1 $ に対する操作により，$ A $ は $ (1,4,5,6,2,3) $ になる． - $ k=2 $ に対する操作により，$ A $ は $ (1,4,2,5,6,3) $ になる． - $ k=3 $ に対する操作により，$ A $ は $ (1,4,2,3,5,6) $ になる． - $ k=4 $ に対する操作により，$ A $ は $ (6,4,2,3,1,5) $ になり，$ B $ に一致する．

### Sample Explanation 2

条件を満たす $ A $ は存在しません．

### Sample Explanation 3

$ 1 $ 以上 $ 20 $ 以下の整数からなる順列がすべて条件を満たします．

## 样例 #1

### 输入

```
6 3 5

6 4 2 3 1 5
```

### 输出

```
18
```

## 样例 #2

### 输入

```
6 3 5

6 5 4 3 2 1
```

### 输出

```
0
```

## 样例 #3

### 输入

```
20 20 149

13 14 15 16 17 18 19 20 1 2 3 4 5 6 7 8 9 10 11 12
```

### 输出

```
401576539
```



---

---
title: "[ARC150D] Removing Gacha"
layout: "post"
diff: 省选/NOI-
pid: AT_arc150_d
tag: []
---

# [ARC150D] Removing Gacha

## 题目描述

[problemUrl]: https://atcoder.jp/contests/arc150/tasks/arc150_d

頂点に $ 1 $ から $ N $ の番号がついた $ N $ 頂点の根付き木があります。頂点 $ 1 $ はこの木の根であり、頂点 $ i\ (2\leq\ i) $ の親頂点は頂点 $ p_i $ です。

各頂点は白、黒の色を持っています。はじめすべて頂点の色は白です。

根付き木において、頂点 $ 1,\ i $ を結ぶ唯一の単純パス上の頂点 (頂点 $ 1,\ i $ 含む) の色がすべて黒であるとき、頂点 $ i $ を「よい頂点」といいます。また、「よい頂点」ではない頂点を「わるい頂点」といいます。

すべての頂点の色が黒になるまで「『わるい頂点』から一様ランダムに頂点を $ 1 $ つ選び、その頂点を黒色で上塗りする」という操作を行います。

操作を行う回数の期待値を $ \bmod\ 998244353 $ で求めてください。

 期待値 $ \text{mod\ }{998244353} $ の定義 求める期待値は必ず有理数になることが証明できます。 また、この問題の制約のもとでは、その値を既約分数 $ \frac{P}{Q} $ で表した時、$ Q\ \not\ \equiv\ 0\ \pmod{998244353} $ となることも証明できます。 よって、$ R\ \times\ Q\ \equiv\ P\ \pmod{998244353},\ 0\ \leq\ R\ &amp;lt\ 998244353 $ を満たす整数 $ R $ が一意に定まります。 この $ R $ を答えてください。

## 输入格式

入力は以下の形式で標準入力から与えられます。

> $ N $ $ p_2 $ $ p_3 $ $ \dots $ $ p_{N} $

## 输出格式

答えを出力してください。

## 说明/提示

### 制約

- $ 2\ \leq\ N\ \leq\ 2\ \times\ 10^5 $
- $ 1\ \leq\ p_i\ <\ i $
- 入力される値はすべて整数

### Sample Explanation 1

例えば $ 1,\ 2,\ 3 $ 回目の操作で順に頂点 $ 1,\ 2,\ 4 $ が選ばれた場合を考えます。このとき、頂点 $ 1,\ 2 $ は「よい頂点」ですが、頂点 $ 4 $ は祖先である頂点 $ 3 $ が白色であるため「わるい頂点」です。よって $ 4 $ 回目の操作で頂点を選ぶ際は頂点 $ 3,\ 4 $ の中から一様ランダムに選びます。 操作を行う回数の期待値は $ \displaystyle\ \frac{35}{6} $ になります。

## 样例 #1

### 输入

```
4

1 1 3
```

### 输出

```
831870300
```

## 样例 #2

### 输入

```
15

1 2 1 1 4 5 3 3 5 10 3 6 3 13
```

### 输出

```
515759610
```



---

---
title: "[ARC151E] Keep Being Substring"
layout: "post"
diff: 省选/NOI-
pid: AT_arc151_e
tag: []
---

# [ARC151E] Keep Being Substring

## 题目描述

[problemUrl]: https://atcoder.jp/contests/arc151/tasks/arc151_e

長さ $ N $ の整数列 $ A\ =\ (A_1,\ A_2,\ \ldots,\ A_N) $ が与えられます。 また、$ A $ の長さ $ P $ の連続な部分列 $ X\ =\ (X_1,\ X_2,\ \ldots,\ X_P) $ と、$ A $ の長さ $ Q $ の連続な部分列 $ Y\ =\ (Y_1,\ Y_2,\ \ldots,\ Y_Q) $ が与えられます。

$ X $ に対して、下記の $ 4 $ つのいずれかを行うという操作を、好きな回数（ $ 0 $ 回でも良い）だけ行うことができます。

- $ X $ の先頭に任意の整数を $ 1 $ つ追加する。
- $ X $ の先頭の要素を削除する。
- $ X $ の末尾に任意の整数を $ 1 $ つ追加する。
- $ X $ の末尾の要素を削除する。

ただし、各操作の前後において、$ X $ は $ A $ の**空でない**連続な部分列でなければなりません。 $ X $ を $ Y $ と一致させるために行う操作回数の最小値を求めてください。 なお、本問題の制約下において、操作の繰り返しによって $ X $ と $ Y $ を必ず一致させられることが証明できます。

 連続な部分列とは？ 数列 $ X\ =\ (X_1,\ X_2,\ \ldots,\ X_P) $ が数列 $ A\ =\ (A_1,\ A_2,\ \ldots,\ A_N) $ の**連続な部分列**であるとは、$ 1\ \leq\ l\ \leq\ N-P+1 $ を満たす整数 $ l $ が存在して、 すべての $ i\ =\ 1,\ 2,\ \ldots,\ P $ について、$ X_i\ =\ A_{l+i-1} $ が成り立つことです。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ A_1 $ $ A_2 $ $ \ldots $ $ A_N $ $ P $ $ X_1 $ $ X_2 $ $ \ldots $ $ X_P $ $ Q $ $ Y_1 $ $ Y_2 $ $ \ldots $ $ Y_Q $

## 输出格式

答えを出力せよ。

## 说明/提示

### 制約

- $ 1\ \leq\ N\ \leq\ 2\ \times\ 10^5 $
- $ 1\ \leq\ A_i\ \leq\ N $
- $ 1\ \leq\ P,\ Q\ \leq\ N $
- $ (X_1,\ X_2,\ \ldots,\ X_P) $ と $ (Y_1,\ Y_2,\ \ldots,\ Y_Q) $ は、$ (A_1,\ A_2,\ \ldots,\ A_N) $ の連続な部分列
- 入力はすべて整数

### Sample Explanation 1

下記の手順で操作すると、$ X $ が $ A $ の空でない連続な部分列であるという条件を満たしたまま、$ X $ を $ Y $ に一致させることが出来ます。 1. まず、$ X $ の先頭の要素を削除する。その結果、$ X\ =\ (1) $ となる。 2. 次に、$ X $ の末尾に $ 5 $ を追加する。その結果、$ X\ =\ (1,\ 5) $ となる。 3. さらに、$ X $ の 末尾に $ 7 $ を追加する。その結果、$ X\ =\ (1,\ 5,\ 7) $ となり、$ X $ は $ Y $ と一致する。 上記の手順の操作回数は $ 3 $ 回であり、これが考えられる最小の操作回数です。

## 样例 #1

### 输入

```
7

3 1 4 1 5 7 2

2

3 1

3

1 5 7
```

### 输出

```
3
```

## 样例 #2

### 输入

```
20

2 5 1 2 7 7 4 5 3 7 7 4 5 5 5 4 6 5 6 1

6

1 2 7 7 4 5

7

7 4 5 5 5 4 6
```

### 输出

```
7
```



---

---
title: "[ARC152E] Xor Annihilation"
layout: "post"
diff: 省选/NOI-
pid: AT_arc152_e
tag: []
---

# [ARC152E] Xor Annihilation

## 题目描述

[problemUrl]: https://atcoder.jp/contests/arc152/tasks/arc152_e

数直線上の $ x=1,2,3,...,2^N-1 $ の位置に $ 2^N-1 $ 個のボールが並んでおり、$ x=i $ にあるボールは $ w_i $ の重みを持っています。ただし、$ w_1,\ w_2,...,w_{2^N-1} $ は $ 1 $ から $ 2^N-1 $ までの整数を並び替えた数列です。 さらに、あなたは $ 2^N-1 $ 以下の負でない整数 $ Z $ を $ 1 $ つ選び、座標 $ x=\pm\ 100^{100^{100}} $ にそれぞれ $ Z $ の重みを固定します。 その後、各ボールは次の規則にしたがって、一斉に運動を始めます。

- 各時点で、ボールの存在している座標より真に右側にある座標・ボールの重みの総 $ \mathrm{XOR} $ を $ R $、真に左側にある座標・ボールの重みの総 $ \mathrm{XOR} $ を $ L $ とすると、このボールは $ R\ >\ L $ であれば右側に、$ L\ >\ R $ であれば左側に毎秒 $ 1 $ の速さで動き、$ L=R $ であれば静止する。
- 左右から来たボールが同じ座標に到達したときなど、同じ座標に同時に複数のボールが存在した場合、これらのボールは合体し、その重みは合体前の重みの総 $ \mathrm{XOR} $ となる。
 
このとき、$ 100^{100} $ 秒以内に全てのボールが静止するような $ Z $ はいくつあるでしょうか。

   $ \mathrm{XOR} $ とは  非負整数 $ A,\ B $ のビット単位 $ \mathrm{XOR} $ 、$ A\ \oplus\ B $ は、以下のように定義されます。

- $ A\ \oplus\ B $ を二進表記した際の $ 2^k $ ($ k\ \geq\ 0 $) の位の数は、$ A,\ B $ を二進表記した際の $ 2^k $ の位の数のうち一方のみが $ 1 $ であれば $ 1 $、そうでなければ $ 0 $ である。
 
 例えば、$ 3\ \oplus\ 5\ =\ 6 $ となります (二進表記すると: $ 011\ \oplus\ 101\ =\ 110 $)。  
 一般に $ k $ 個の非負整数 $ p_1,\ p_2,\ p_3,\ \dots,\ p_k $ のビット単位 $ \mathrm{XOR} $ は $ (\dots\ ((p_1\ \oplus\ p_2)\ \oplus\ p_3)\ \oplus\ \dots\ \oplus\ p_k) $ と定義され、これは $ p_1,\ p_2,\ p_3,\ \dots,\ p_k $ の順番によらないことが証明できます。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ w_1 $ $ w_2 $ $ \ldots $ $ w_{2^N-1} $

## 输出格式

答えを整数で出力せよ。

## 说明/提示

### 制約

- $ 2\leq\ N\leq\ 18 $
- $ 1\leq\ w_i\leq\ 2^N-1 $
- $ i\neq\ j $ のとき $ w_i\neq\ w_j $
- 入力される値はすべて整数である
 
### Sample Explanation 1

$ i $ の重みを持つボールを単に $ i $ と呼びます。 例えば $ Z=0 $ とした場合、はじめ $ 1 $ と $ 2 $ は右向きに、$ 3 $ は左向きに動きます。 すると $ 2 $ と $ 3 $ がぶつかって合体し、この瞬間から左向きに動き始めます。 そののち、$ 1 $ から $ 3 $ まで全てのボールが合体した瞬間に合体後のボールは静止します。 したがって、$ Z=0 $ は条件を満たします。 また、$ Z=3 $ とした場合、$ 1 $ と $ 2 $ は左向き、$ 3 $ は右向きに、固定した重みに向かって $ 100^{100^{100}} $ 秒程度動き続けることになります。 したがって、$ Z=3 $ は条件を満たしません。 実は $ Z=0 $ のみが条件を満たすため、$ 1 $ と答えてください。

## 样例 #1

### 输入

```
2

1 2 3
```

### 输出

```
1
```

## 样例 #2

### 输入

```
3

7 1 2 3 4 5 6
```

### 输出

```
2
```



---

---
title: "Unicyclic Graph Counting"
layout: "post"
diff: 省选/NOI-
pid: AT_asaporo2_f
tag: []
---

# Unicyclic Graph Counting

## 题目描述

### 题目大意
求有多少$N$个点的环套树，满足第$i$个点的度数为给定的$d_i$。答案对$10^9+7$取模。

环套树是一个$n$个点、$n$条边的简单（无重边、无自环）联通无向图。

## 输入格式

第一行一个正整数$N$，表示点的个数。

第二行有$N$个整数$d_i$，表示每个点的度数。

## 输出格式

输出仅一行一个整数为答案，答案对$10^9+7$取模。

## 说明/提示

- $3 \le N \le 300$
- $1 \le d_i \le N - 1$
- $\Sigma{d_i} = 2N$

翻译提供者：浮尘ii

## 样例 #1

### 输入

```
5

1 2 2 3 2
```

### 输出

```
6
```

## 样例 #2

### 输入

```
16

2 1 3 1 2 1 4 1 1 2 1 1 3 2 4 3
```

### 输出

```
555275958
```



---

---
title: "最適二分探索木"
layout: "post"
diff: 省选/NOI-
pid: AT_atc002_c
tag: []
---

# 最適二分探索木

## 题目描述

# 题描述
### 我想制作一个有 n叶的有序二叉树。该二叉树的成本定义如下。
![1](https://baiwhiter.github.io/images/FireShot%20Capture%20006%20-%20AT1358%20%E6%9C%80%E9%81%A9%E4%BA%8C%E5%88%86%E6%8E%A2%E7%B4%A2%E6%9C%A8%20-%20%E6%B4%9B%E8%B0%B7%20-%20%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%A7%91%E5%AD%A6%E6%95%99%E8%82%B2%E6%96%B0%E7%94%9F%E6%80%81%20-%20www.luogu.org.png)
------------
### 然而,depth(i),从在该二进制树的左表示第i片叶子的深度。W_i重量是作为输入给出的。请找到最低成本。

## 输入格式

### 输入由标准输入以下列形式给出：
```
n n n
w1 w_1 w1​ w2 w_2 w2​ ... wn w_n wn​
```
在第一行中，表示元素数量的整数 n （1≦n≦100,000 )
第二行显示元素的重量给出了 n个整数。 其中i(1≦i≦n) 表示第i个元素的权重 w_i（1≦w_i≦1,000)

## 输出格式

### 输出由标准输出一下格式给出：
输出满足条件的有序二叉树的最低成本。
### 输入输出样例
暂无测试点

## 说明/提示

### 部分测试点
```
n ≦ 1 0 0 如果你回答的数据集满意， 50分给出。
n ≦ 3,000 n ≦ 3，0 0 0 如果您在回答数据集令人满意的，除了50分中给出。
如果在没有其他约束的情况下更正数据集，则与上述分开 有一点是给出。
```
# 输入样例
```
6
1 2 3 4 9 3
```
# 输出样例
```
53
```
### 下图中显示的二叉树是最佳的。
![2](https://cdn.luogu.org/upload/vjudge_pic/AT1358/bade4c459cea1a03aea22be87f432e68bb065698.png)
### 等效于样本输入和输出的二叉树
### 如果你制作这样的二叉树，那么成本是53。



---

---
title: "U・N・C・O"
layout: "post"
diff: 省选/NOI-
pid: AT_autumn_fest_08
tag: []
---

# U・N・C・O

## 题目描述

[problemUrl]: https://atcoder.jp/contests/autumn_fest/tasks/autumn_fest_08





---

---
title: "Moving Slimes"
layout: "post"
diff: 省选/NOI-
pid: AT_awtf2024_a
tag: []
---

# Moving Slimes

## 题目描述

[problemUrl]: https://atcoder.jp/contests/awtf2024-open/tasks/awtf2024_a

数直線上に $ N $ 匹のスライムがおり，$ i $ 番目のスライムは座標 $ A_i $ にいます． これらの座標はすべて異なります． 各スライムの重さは $ 1 $ です． また整数 $ K $ が与えられます．

あなたはまず $ K $ 匹のスライムを選び，選ばなかったスライムを数直線上から取り除きます． その後，選ばれたスライムは時刻 $ 0 $ から以下のように移動を行います．

- 各スライムの移動: 自分より大きい座標にいるスライムの重さの総和を $ R $，自分より小さい座標にいるスライムの重さの総和を $ L $ とする． そして，速度 $ R-L $ で移動する．ここで，速度が符号付きであることに注意せよ．つまり，$ R-L\ <\ 0 $ のときスライムは数直線上を負の方向へ動くものとする．

$ 2 $ 匹以上のスライムが同時に同じ座標に到達したとき，それらのスライムは合体します． 合体後のスライムの重さは合体前のスライムの重さの総和です． また合体後のスライムは上と同じ規則にしたがって移動します．

$ K $ 匹のスライムは合体を繰り返し，いずれ $ 1 $ 匹のスライムになります． このスライムが誕生する瞬間を時刻 $ t $ とします． あなたの目標は，$ K $ 匹のスライムを上手に選び，この $ t $ を最大化することです． $ t $ の最大値を求めてください．

## 输入格式

入力は以下の形式で標準入力から与えられる．

> $ N $ $ K $ $ A_1 $ $ A_2 $ $ \cdots $ $ A_N $

## 输出格式

答えを実数として出力せよ． 絶対誤差または相対誤差が $ 10^{-9} $ 以下ならば，正解と判定される．

## 说明/提示

### 制約

- $ 2\ \leq\ K\ \leq\ N\ \leq\ 250000 $
- $ 0\ =\ A_1\ <\ A_2\ <\ \cdots\ <\ A_N\ \leq\ 10^9 $
- 入力される値はすべて整数

### Sample Explanation 1

\- $ 1 $ 番目と $ 2 $ 番目のスライムを選ぶと $ t=0.5 $ になります． - $ 1 $ 番目と $ 3 $ 番目のスライムを選ぶと $ t=1 $ になります． - $ 2 $ 番目と $ 3 $ 番目のスライムを選ぶと $ t=0.5 $ になります． よって答えは $ 1 $ です．

### Sample Explanation 2

$ 1,2,4 $ 番目のスライムを選んだ場合，スライムの移動の様子は以下のとおりです． - $ 1,2,4 $ 番目のスライムを便宜的に $ X,Y,Z $ と呼ぶことにする． - 時刻 $ 0 $ : $ X,Y,Z $ はそれぞれ速度 $ +2,0,-2 $ で移動を開始する． - 時刻 $ 1/2 $ : $ X $ と $ Y $ が座標 $ 1 $ で合体する．合体後のスライムを $ XY $ と呼ぶことにする．$ XY $ は速度 $ 1 $ で移動を開始する．$ Z $ はこのとき座標 $ 8 $ におり，速度は $ -2 $ のままである． - 時刻 $ 17/6 $ : $ XY $ と $ Z $ が座標 $ 10/3 $ で合体する．よって $ t=17/6 $ となる． $ t $ を $ 17/6 $ より大きくすることはできないので，これが答えになります．

## 样例 #1

### 输入

```
3 2
0 1 2
```

### 输出

```
1.00000000000000000000
```

## 样例 #2

### 输入

```
4 3
0 1 4 9
```

### 输出

```
2.83333333333333333333
```

## 样例 #3

### 输入

```
4 4
0 1 2 3
```

### 输出

```
0.50000000000000000000
```

## 样例 #4

### 输入

```
20 6
0 3441380 120768398 229897071 231209282 232046760 254924545 325399248 385631087 400098966 480503302 501372095 502644652 524585010 541761042 691400171 725009462 767549897 837806226 927396743
```

### 输出

```
135453315.33333333333333333333
```



---

---
title: "Square"
layout: "post"
diff: 省选/NOI-
pid: AT_caddi2018_d
tag: []
---

# Square

## 题目描述

[problemUrl]: https://atcoder.jp/contests/caddi2018/tasks/caddi2018_d

高橋君は、$ N $ 行 $ N $ 列のマス目を持っています。マス目の上から $ i $ 番目、左から $ j $ 番目のマスは $ (i,j) $ で表されます。 特に、マス目の左上のマスは $ (1,1) $ であり、右下のマスは $ (N,N) $ です。

高橋君の持っているマス目のうち $ M $ 個のマスには、$ 0 $ または $ 1 $ の整数が書き込まれています。 整数が書き込まれたマスのうち $ i $ 番目のマスの情報は $ 3 $ つの整数 $ a_i,b_i,c_i $ で表され、マス $ (a_i,b_i) $ に整数 $ c_i $ が書き込まれていることを表します。

高橋君は、以下の条件を満たすように残りのマスに $ 0 $ または $ 1 $ の整数を書き込むことにしました。 書き込み方としてありうるものの個数を $ 998244353 $ で割ったあまりを求めてください。

- 任意の $ 1\leq\ i\ <\ j\leq\ N $ に対し、$ (i,i) $ を左上のマスとし $ (j,j) $ を右下のマスとするような正方形領域に書き込まれた $ 1 $ の個数が偶数である

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ M $ $ a_1 $ $ b_1 $ $ c_1 $ $ : $ $ a_M $ $ b_M $ $ c_M $

## 输出格式

書き込み方としてありうるものの個数を $ 998244353 $ で割ったあまりを出力せよ。

## 说明/提示

### 制約

- $ 2\ \leq\ N\ \leq\ 10^5 $
- $ 0\ \leq\ M\ \leq\ min(5\ \times\ 10^4,N^2) $
- $ 1\ \leq\ a_i,b_i\ \leq\ N(1\leq\ i\leq\ M) $
- $ 0\ \leq\ c_i\ \leq\ 1(1\leq\ i\leq\ M) $
- $ i\ \neq\ j $ ならば $ (a_i,b_i)\ \neq\ (a_j,b_j) $ である
- 入力はすべて整数である

### Sample Explanation 1

例えば、以下のような書き込み方が条件を満たします。 ``` 101 111 011 111 000 011 ```

## 样例 #1

### 输入

```
3 3

1 1 1

3 1 0

2 3 1
```

### 输出

```
8
```

## 样例 #2

### 输入

```
4 5

1 3 1

2 4 0

2 3 1

4 2 1

4 4 1
```

### 输出

```
32
```

## 样例 #3

### 输入

```
3 5

1 3 1

3 3 0

3 1 0

2 3 1

3 2 1
```

### 输出

```
0
```

## 样例 #4

### 输入

```
4 8

1 1 1

1 2 0

3 2 1

1 4 0

2 1 1

1 3 0

3 4 1

4 4 1
```

### 输出

```
4
```

## 样例 #5

### 输入

```
100000 0
```

### 输出

```
342016343
```



---

---
title: "Water Distribution"
layout: "post"
diff: 省选/NOI-
pid: AT_cf16_exhibition_final_e
tag: []
---

# Water Distribution

## 题目描述

在一个二维平面上有$N$个城市， 第$i$个城市的坐标是$(x_i,y_i)$， 一开始拥有的水量是$a_i$。

现在你可以从一个城市向另一个城市运送任意数量的水， 但水在运输过程中会有损耗， 具体而言如果从$x$城市运$l$水到$y$城市，最终$y$城市得到的水量是$max(0,l-dis(x,y))$， 其中$dis(x,y)$指$x$和$y$城市间的欧几里得距离。 你可以多次进行这个操作。

你要使最终水量最少的城市水量尽量多， 求这个值。

## 输入格式

第一行一个正整数$N$。
以下$N$行， 每行三个整数$x_i,y_i,a_i$， 含义如上。

## 输出格式

一行一个实数$ans$表示最终水量最少的城市水量最多有多少。

## 样例 #1

### 输入

```
3

0 0 10

2 0 5

0 5 8
```

### 输出

```
6.500000000000
```

## 样例 #2

### 输入

```
15

335279264 849598327 822889311

446755913 526239859 548830120

181424399 715477619 342858071

625711486 448565595 480845266

647639160 467825612 449656269

160714711 336869678 545923679

61020590 573085537 816372580

626006012 389312924 135599877

547865075 511429216 605997004

561330066 539239436 921749002

650693494 63219754 786119025

849028504 632532642 655702582

285323416 611583586 211428413

990607689 590857173 393671555

560686330 679513171 501983447
```

### 输出

```
434666178.237122833729
```



---

---
title: "Zabuton"
layout: "post"
diff: 省选/NOI-
pid: AT_cf17_final_d
tag: []
---

# Zabuton

## 题目描述

[problemUrl]: https://atcoder.jp/contests/cf17-final/tasks/cf17_final_d

ある年のCODE FESTIVALの本戦には $ N $ 人の参加者が集まりました。 参加者 $ i $ は身長が $ H_i $ で力が $ P_i $ です。

りんごさんは参加者に座布団を積むゲームをしてもらおうとしています。

参加者は好きな順番で並び、$ 1 $ 人ずつ座布団を $ 1 $ 箇所に積んでいきます。 はじめ、座布団は $ 1 $ 枚も積まれていません。 参加者 $ i $ は、自分の番が回ってきた時にすでに積まれた座布団が $ H_i $ 枚以下の場合はちょうど $ P_i $ 枚の座布団を積みます。そうでない場合は諦めて $ 1 $ 枚も積みません。

りんごさんはできるだけ多くの参加者に座布団を積んで欲しいと思っています。 参加者の並び順を工夫することによって、最大で何人の参加者に座布団を積んでもらうことができるでしょうか？

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ H_1 $ $ P_1 $ $ H_2 $ $ P_2 $ $ : $ $ H_N $ $ P_N $

## 输出格式

座布団を積む参加者の人数の最大値を出力せよ。

## 说明/提示

### 制約

- $ 1\ \leq\ N\ \leq\ 5000 $
- $ 0\ \leq\ H_i\ \leq\ 10^9 $
- $ 1\ \leq\ P_i\ \leq\ 10^9 $

### Sample Explanation 1

入力の通りの順に参加者が並ぶと、$ 1,3 $ 番目の参加者が座布団を積むことができます。 また、$ 3 $ 人全員が座布団を積めるような並び順は存在しないため、答えは $ 2 $ 人となります。

### Sample Explanation 2

$ 2 $ 番、$ 3 $ 番、$ 1 $ 番の順で参加者が並ぶと、全員が座布団を積むことができます。

## 样例 #1

### 输入

```
3

0 2

1 3

3 4
```

### 输出

```
2
```

## 样例 #2

### 输入

```
3

2 4

3 1

4 1
```

### 输出

```
3
```

## 样例 #3

### 输入

```
10

1 3

8 4

8 3

9 1

6 4

2 3

4 2

9 2

8 3

0 1
```

### 输出

```
5
```



---

---
title: "Distribute Numbers"
layout: "post"
diff: 省选/NOI-
pid: AT_cf17_final_f
tag: []
---

# Distribute Numbers

## 题目描述

[problemUrl]: https://atcoder.jp/contests/cf17-final/tasks/cf17_final_f

$ 1000 $ 以上 $ 2000 $ 以下の好きな整数 $ N $ と $ 1 $ 以上の好きな整数 $ K $ を選び、以下の問題を解いてください。

#### 問題

$ N $ 枚の紙があります。 これらの紙に以下の条件を満たすように $ K $ 個ずつ整数を書いてください。

- 書く整数は $ 1 $ 以上 $ N $ 以下でなければならない。
- 同じ紙に書かれた $ K $ 個の整数は相異ならなければならない。
- $ 1 $ 〜 $ N $ の整数はいずれも $ K $ 枚ずつの紙に書かれていなければならない。
- どの $ 2 $ 枚の紙をとってきても、それらの紙に共通して書かれた整数がちょうど $ 1 $ つだけ存在する。

## 输入格式

この問題では入力は与えられない。

## 输出格式

$ 1 $ 行目に $ N $ と $ K $ を空白区切りで出力せよ。

$ 2 $ 行目からの $ N $ 行には、各紙に書く整数の情報を出力せよ。 このうち $ i $ 行目には $ i $ 枚目の紙に書く $ K $ 個の整数を空白区切りで出力せよ。

## 说明/提示

### Sample Explanation 1

$ N $ が $ 3 $ で $ K $ が $ 2 $ の例です。 ただし、$ N $ の制約を満たしていないためこの出力は不正解となります。

## 样例 #1

### 输入

```
None
```

### 输出

```
3 2

1 2

2 3

3 1
```



---

---
title: "Mancala"
layout: "post"
diff: 省选/NOI-
pid: AT_cf17_final_g
tag: []
---

# Mancala

## 题目描述

考虑以下游戏：

- 准备排成一列的 $N$ 个格子和大量石子。
- 初始时，在第 $i$ 个格子（$1 \leq i \leq N$）中放入 $a_i$ 个石子。
- 玩家可以重复进行以下操作：选择一个恰好有 $i$ 个石子的格子 $i$，将其中的所有石子取出，并在第 $1$ 到第 $i-1$ 个格子中各添加 $1$ 个石子。
- 最终剩余石子的总数即为得分。

对于长度为 $N$ 的数列 $a$，将该游戏进行后可能得到的最小得分记为 $f(a)$。

现在，对于所有长度为 $N$ 且每个元素在 $0$ 到 $K$ 之间的数列 $a$，求 $f(a)$ 的总和。由于答案可能非常大，请对 $1000000007$（即 $10^9+7$）取模。

## 输入格式

输入通过标准输入给出，格式如下：

> $N$ $K$

## 输出格式

输出 $f(a)$ 的总和对 $1000000007$ 取模后的结果。

## 说明/提示

### 约束条件

- $1 \leq N \leq 100$
- $1 \leq K \leq N$

### 样例解释 1

当 $N=2$ 且 $K=2$ 时，共有 $9$ 种可能的数列 $a$，各数列对应的 $f(a)$ 值及操作示例如下：
- $f(\{0,0\})$：$0$（无法操作）
- $f(\{0,1\})$：$1$（无法操作）
- $f(\{0,2\})$：$0$（依次操作格子 $2$ 和格子 $1$）
- $f(\{1,0\})$：$0$（选择格子 $1$）
- $f(\{1,1\})$：$1$（选择格子 $1$）
- $f(\{1,2\})$：$0$（依次操作格子 $1$、格子 $2$、格子 $1$）
- $f(\{2,0\})$：$2$（无法操作）
- $f(\{2,1\})$：$3$（无法操作）
- $f(\{2,2\})$：$3$（选择格子 $2$）

翻译由 DeepSeek R1 完成

## 样例 #1

### 输入

```
2 2
```

### 输出

```
10
```

## 样例 #2

### 输入

```
20 17
```

### 输出

```
983853488
```



---

---
title: "Tree MST"
layout: "post"
diff: 省选/NOI-
pid: AT_cf17_final_j
tag: []
---

# Tree MST

## 题目描述

[problemUrl]: https://atcoder.jp/contests/cf17-final/tasks/cf17_final_j

りんごさんは $ N $ 頂点の木を持っています。 この木の $ N-1 $ 本の辺のうち $ i $ 番目の辺は頂点 $ A_i $ と頂点 $ B_i $ を繋いでおり、重みは $ C_i $ です。 また、頂点 $ i $ には $ X_i $ の重みがついています。

ここで $ f(u,v) $ を、「頂点 $ u $ から頂点 $ v $ までの距離」と「$ X_u\ +\ X_v $」の和と定めます。

$ N $ 頂点の完全グラフ $ G $ を考えます。 頂点 $ u $ と頂点 $ v $ を繋ぐ辺のコストは $ f(u,v) $ です。 グラフ $ G $ の最小全域木を求めて下さい。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ X_1 $ $ X_2 $ $ ... $ $ X_N $ $ A_1 $ $ B_1 $ $ C_1 $ $ A_2 $ $ B_2 $ $ C_2 $ $ : $ $ A_{N-1} $ $ B_{N-1} $ $ C_{N-1} $

## 输出格式

グラフ $ G $ の最小全域木のコストを出力せよ。

## 说明/提示

### 制約

- $ 2\ \leq\ N\ \leq\ 200,000 $
- $ 1\ \leq\ X_i\ \leq\ 10^9 $
- $ 1\ \leq\ A_i,B_i\ \leq\ N $
- $ 1\ \leq\ C_i\ \leq\ 10^9 $
- 与えられるグラフは木である。
- 入力は全て整数である。

### Sample Explanation 1

頂点 $ 1 $ と $ 2 $、頂点 $ 1 $ と $ 4 $、頂点 $ 3 $ と $ 4 $ を繋ぐとそれぞれのコストは $ 5,8,9 $ となり、合計は $ 22 $ となります。

## 样例 #1

### 输入

```
4

1 3 5 1

1 2 1

2 3 2

3 4 3
```

### 输出

```
22
```

## 样例 #2

### 输入

```
6

44 23 31 29 32 15

1 2 10

1 3 12

1 4 16

4 5 8

4 6 15
```

### 输出

```
359
```

## 样例 #3

### 输入

```
2

1000000000 1000000000

2 1 1000000000
```

### 输出

```
3000000000
```



---

---
title: "立方体とペンキ"
layout: "post"
diff: 省选/NOI-
pid: AT_cf_2015_morning_hard_b
tag: []
---

# 立方体とペンキ

## 题目描述

[problemUrl]: https://atcoder.jp/contests/code-festival-2015-morning-middle/tasks/cf_2015_morning_hard_b

りんごさんは $ 1 $ 辺の長さが $ 1 $ の立方体を積んで遊んでいます。りんごさんは地面に $ 1 $ 辺の長さが $ 1 $ の正方形を横に並べて $ N $ 個描き、左から $ i $ 個目の正方形の上に立方体を $ A_i $ 個積みました。

りんごさんは立方体の表面にペンキを塗ることにしました。別の立方体や地面と接している面にはペンキを塗りません。しかし、りんごさんはペンキの量が足りるか不安になりました。そこで、$ K $ 個の立方体を取り除いてからペンキを塗ることにしました。このとき、いずれの正方形の上にも $ 1 $ 個以上の立方体がなければなりません。

りんごさんは必要なペンキの量をできるだけ少なくしたいです。ペンキを塗る面積の最小値を求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ K $ $ A_1 $ $ A_2 $ ... $ A_N $

- $ 1 $ 行目には、$ 2 $ つの整数 $ N\ (1\ ≦\ N\ ≦\ 10^5),\ K\ (1\ ≦\ K\ ≦\ 10^{14}) $ が空白区切りで与えられる。これは、地面に描いた正方形の個数が $ N $ 個、取り除く立方体の個数が $ K $ 個であることを表す。
- $ 2 $ 行目には、各正方形の上に積む立方体の個数を表す $ N $ 個の整数が空白区切りで与えられる。このうち $ i\ (1\ ≦\ i\ ≦\ N) $ 番目の整数 $ A_i\ (1\ ≦\ A_i\ ≦\ 10^9) $ は、左から $ i $ 個目の正方形の上に積む立方体の個数を表す。ただし、いずれの正方形の上にも $ 1 $ 個以上の立方体を残して $ K $ 個の立方体を取り除くことができること、すなわち $ Σ\ A_i\ ≧\ N+K $ が保証される。

## 输出格式

ペンキを塗る面積の最小値を $ 1 $ 行に出力せよ。出力の末尾に改行を入れること。

## 说明/提示

### Sample Explanation 1

下図は、はじめに積んだ立方体を正面から見たときの様子を表しています。 !\[figure1\](https://code-festival-2015-morning-hard.contest.atcoder.jp/img/other/code\_festival\_2015\_final/asa/tsumiki1.png)下図のように $ 6 $ 個の立方体を取り除くと、ペンキを塗る面積は $ 35 $ となります。 !\[figure2\](https://code-festival-2015-morning-hard.contest.atcoder.jp/img/other/code\_festival\_2015\_final/asa/tsumiki2.png)

## 样例 #1

### 输入

```
7 6

2 3 2 1 2 3 4
```

### 输出

```
35
```

## 样例 #2

### 输入

```
10 919924177

114777581 900857217 199708389 41623648 586160911 824291566 209849198 803644124 355106148 180322764
```

### 输出

```
9307626516
```



---

---
title: "Cookies"
layout: "post"
diff: 省选/NOI-
pid: AT_codefestival_2016_final_e
tag: []
---

# Cookies

## 题目描述

RNG正在烤饼干。

RNG开始时一秒可以烤一块饼干。

在烘焙过程中，当有$X$块饼干没有吃时，RNG可以选择吃那些饼干。在他吃完那些饼干之后，他每秒烘焙的饼干数量就变成了$X$。不管吃几块饼干，总是需要花费$A$秒的时间，并且在此期间不能烤新的饼干。另外，饼干总是需要烘烤1秒，也就是说不能用0.5秒烧$X/2$张的曲奇。

RNG想把$N$张饼干送给奶奶。请找出生产至少$N$个尚未吃过的饼干所需的最短时间。

## 输入格式

N A

## 输出格式

一行，生产至少N个尚未吃过的饼干所需的最短时间。

### 限制

- $1≦N≦10^{12}$

- $0≦A≦10^{12}$

- $A$是个整型变量

### 部分分数

通过测试集满足$N≦10^6$和$A≦10^6$将获得500分。
剩余的500分将会在通过全部的数据之后奖励给你

## 说明/提示

在7秒内可以生产8块饼干，如下：

1秒后：一个曲奇完成了。

2秒后，再做1个曲奇，总共2个。现在，RNG开始吃那2块饼干。

3秒钟后，他吃完饼干，现在他可以每秒烘烤两块饼干。

4秒后，完成2个曲奇。

5秒后，再做2个饼干，共计4个。

6秒后，再做2个饼干，共计6个。

7秒后，再做2个饼干，共计8个。

感谢@Sheffield 提供翻译

## 样例 #1

### 输入

```
8 1
```

### 输出

```
7
```

## 样例 #2

### 输入

```
1000000000000 1000000000000
```

### 输出

```
1000000000000
```

## 样例 #3

### 输入

```
123456 7
```

### 输出

```
78
```



---

---
title: "Tokaido"
layout: "post"
diff: 省选/NOI-
pid: AT_codefestival_2016_final_h
tag: []
---

# Tokaido

## 题目描述

[problemUrl]: https://atcoder.jp/contests/cf16-final/tasks/codefestival_2016_final_h

$ N $ 個のマスが一列に並んでおり、左から順に $ 1～N $ の番号が付けられています。 すぬけくんとりんごさんはこのマス目を使って、以下のようなボードゲームで遊ぼうとしています。

1. はじめに、すぬけくんがすべてのマスに $ 1 $ つずつ整数を書く。
2. $ 2 $ 人のプレイヤーはそれぞれ $ 1 $ つずつ駒を用意し、すぬけくんは自分の駒をマス $ 1 $ に、りんごさんは自分の駒をマス $ 2 $ に置く。
3. 自分の駒が相手の駒より左にあるプレイヤーが駒を動かす。駒を動かす先は、今自分の駒が置かれているマスよりも右にあってかつ相手の駒が置かれていないマスでなければならない。
4. *3.* を繰り返し、これ以上駒を動かすことができなくなるとゲームは終了となる。
5. ゲーム終了時までに自分の駒を置いたことのあるマスに書かれた整数の合計が、それぞれのプレイヤーのスコアとなる。

すぬけくんはすでにマス $ i\ (1≦i≦N-1) $ に整数 $ A_i $ を書きましたが、まだマス $ N $ には整数を書いていません。 すぬけくんは $ M $ 個の整数 $ X_1,X_2,...,X_M $ それぞれについて、その数をマス $ N $ に書いてゲームを行ったときに「（すぬけくんのスコア）ー（りんごさんのスコア）」がいくらになるのかを計算することにしました。 ただし、それぞれのプレイヤーは「（自分のスコア）ー（相手のスコア）」を最大化するように駒を動かすものとします。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ A_1 $ $ A_2 $ $ ... $ $ A_{N-1} $ $ M $ $ X_1 $ $ X_2 $ $ : $ $ X_M $

## 输出格式

$ X_1\ \dots\ X_M $ の $ M $ 個の整数それぞれに対し、その数をマス $ N $ に書いたときの「（すぬけくんのスコア）ー（りんごさんのスコア）」を $ 1 $ 行にひとつずつ出力せよ。

## 说明/提示

### 制約

- $ 3≦N≦200,000 $
- $ 0≦A_i≦10^6 $
- $ A_i $ の総和は $ 10^6 $ 以下である。
- $ 1≦M≦200,000 $
- $ 0≦X_i≦10^9 $

### 部分点

- $ M=1 $ を満たすデータセットに正解した場合は、$ 700 $ 点が与えられる。
- 追加制約のないデータセットに正解した場合は、上記とは別に $ 900 $ 点が与えられる。

### Sample Explanation 1

ゲームは下図のように進行します。Sはすぬけくんの駒、Rはりんごさんの駒を表しています。 !\[\](https://atcoder.jp/img/code-festival-2016-final/0c38db3b7902579a8bc2d0798b8dda27.png) スコアは $ 2 $ 人とも $ 10 $ となり、「（すぬけくんのスコア）ー（りんごさんのスコア）」は $ 0 $ となります。

## 样例 #1

### 输入

```
5

2 7 1 8

1

2
```

### 输出

```
0
```

## 样例 #2

### 输入

```
9

2 0 1 6 1 1 2 6

5

2016

1

1

2

6
```

### 输出

```
2001

6

6

7

7
```



---

---
title: "Lexicographical disorder"
layout: "post"
diff: 省选/NOI-
pid: AT_codefestival_2016_qualB_e
tag: []
---

# Lexicographical disorder

## 题目描述

[problemUrl]: https://atcoder.jp/contests/code-festival-2016-qualb/tasks/codefestival_2016_qualB_e

英小文字のみからなる文字列が$ N $個あります。$ i $番目の文字列は$ S_i $です。すべての文字列は相異なります。

次の$ Q $個のクエリに答えてください。$ i $番目のクエリは、以下のような形式です。

クエリ: 整数$ k_i $と、{'a','b',...,'z'}の並び替えである文字列$ p_{i,1}p_{i,2}...p_{i,26} $が与えられる。文字の順序が$ p_{i,1}\ のとき、文字列S_{k_i} $は$ N $個の文字列たちの中で辞書順で何番目か出力せよ。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ S_1 $ : $ S_N $ $ Q $ $ k_1 $ $ p_{1,1}p_{1,2}...p_{1,26} $ : $ k_Q $ $ p_{Q,1}p_{Q,2}...p_{Q,26} $

## 输出格式

$ Q $行出力せよ。

$ i $行目には、$ i $番目のクエリに対し、文字列$ S_{k_i} $は$ N $個の文字列たちの中で辞書順で何番目かを表す整数を出力せよ。

## 说明/提示

### 制約

- $ 1\ ≦\ N,Q\ ≦\ 100000 $
- $ 1\ ≦\ |\ S_i\ |\ (1\ ≦\ i\ ≦\ N) $
- $ S_i\ (1\ ≦\ i\ ≦\ N) $は英小文字のみからなる。
- $ |\ S_i\ | $たちの合計は$ 400000 $以下。
- $ S_i $たちはすべて相異なる。
- $ 1\ ≦\ k_i\ ≦\ N(1\ ≦\ i\ ≦\ Q) $
- すべての$ 1\ ≦\ i\ ≦\ Q $に対し、$ p_{i,1}p_{i,2}...p_{i,26} $は"abcd...z"の並び替えである。

### Sample Explanation 1

文字の順序が"a" 1,3,5番目のクエリにはそれぞれ$ 1,5,2 $と答えます。 また、文字の順序が"b" 2,4番目のクエリにはそれぞれ$ 2,4 $と答えます。

## 样例 #1

### 输入

```
5

aa

abbaa

abbba

aaab

aaaaaba

5

1 abcdefghijklmnopqrstuvwxyz

2 bacdefghijklmnopqrstuvwxyz

3 abcdefghijklmnopqrstuvwxyz

4 bacdefghijklmnopqrstuvwxyz

5 abcdefghijklmnopqrstuvwxyz
```

### 输出

```
1

2

5

4

2
```

## 样例 #2

### 输入

```
8

abrakatabra

abadaba

abracadabra

atcoder

grand

contest

ababa

a

6

3 abcdefghijklmnopqrstuvwxyz

6 qwertyuiopasdfghjklzxcvbnm

8 poiuytrewqlkjhgfdsamnbvcxz

2 qazwsxedcrfvtgbyhnujmikolp

1 plokmijnuhbygvtfcrdxeszwaq

4 mnbvcxzasdfghjklpoiuytrewq
```

### 输出

```
4

8

2

3

4

7
```



---

---
title: "順列辞書"
layout: "post"
diff: 省选/NOI-
pid: AT_codefestival_2016_qualC_e
tag: []
---

# 順列辞書

## 题目描述

[problemUrl]: https://atcoder.jp/contests/code-festival-2016-qualc/tasks/codefestival_2016_qualC_e

ある日高橋君は、$ 1 $~$ N $ からなる $ N! $ 個の順列全てが載っている辞書を拾いました。辞書は $ N! $ ページからなり、 $ i\ (1≦i≦N!) $ ページ目には辞書順 $ i $ 番目の順列が載っています。高橋君はこの辞書で長さ $ N $ のある順列を調べようとしましたが、順列の一部の数は忘れてしまいました。そのため、可能性のある順列全てをこの辞書で調べようとしています。高橋くんが調べる必要のあるページ番号の総和を $ 10^9+7 $ で割ったあまりを求めてください。

順列の情報は $ P_1 $,$ P_2 $,$ ... $,$ P_N $ で与えられます。$ P_i=0 $ の時は順列の $ i $ 番目の数を忘れてしまったことを、そうでない場合は順列の $ i $ 番目の数が $ P_i $ であることを意味します。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ P_1 $ $ P_2 $ $ ... $ $ P_N $

## 输出格式

高橋くんが調べる必要のあるページ番号の総和を $ 10^9+7 $ で割ったあまりを出力せよ。

## 说明/提示

### 制約

- $ 1≦N≦500000 $
- $ 0≦P_i≦N $
- $ i≠j\ (1≦i,j≦N) $ かつ $ P_i≠0 $ かつ $ P_j≠0 $ ならば、 $ P_i≠P_j $

### 部分点

- $ 1≦N≦3000 $ を満たすデータセットに正解すると、$ 500 $ 点が与えられる。

### Sample Explanation 1

ありうる順列は$ [1,2,3,4] $と$ [4,2,3,1] $です。前者は$ 1 $ページ目に、後者は$ 22 $ページ目に載っているため、答えは$ 23 $です。

### Sample Explanation 2

長さ$ 3 $の全ての順列がありうるので、答えは$ 1+2+3+4+5+6\ =\ 21 $ になります。

### Sample Explanation 3

高橋君は完全に順列を記憶しています。

### Sample Explanation 4

辞書は$ 1 $ページからなります。

## 样例 #1

### 输入

```
4

0 2 3 0
```

### 输出

```
23
```

## 样例 #2

### 输入

```
3

0 0 0
```

### 输出

```
21
```

## 样例 #3

### 输入

```
5

1 2 3 5 4
```

### 输出

```
2
```

## 样例 #4

### 输入

```
1

0
```

### 输出

```
1
```

## 样例 #5

### 输入

```
10

0 3 0 0 1 0 4 0 0 0
```

### 输出

```
953330050
```



---

---
title: "Four Coloring"
layout: "post"
diff: 省选/NOI-
pid: AT_code_festival_2017_quala_d
tag: []
---

# Four Coloring

## 题目描述

给定一个$H \times W$的网格，试给其中所有格子染`RYGB`四种颜色之一，使得网格上任意一对曼哈顿距离为$d$的格子颜色不同。

## 输入格式

一行两个正整数$H ,W , d$



$1 \leq H,W \leq 500 , 1 \leq d \leq H + W - 2$

## 输出格式

输出一个$H \times W$的字符矩阵表示染色方案

## 样例 #1

### 输入

```
2 2 1
```

### 输出

```
RY

GR
```

## 样例 #2

### 输入

```
2 3 2
```

### 输出

```
RYB

RGB
```



---

---
title: "101 to 010"
layout: "post"
diff: 省选/NOI-
pid: AT_code_festival_2017_qualb_d
tag: []
---

# 101 to 010

## 题目描述

[problemUrl]: https://atcoder.jp/contests/code-festival-2017-qualb/tasks/code_festival_2017_qualb_d

$ N $ 個のセルが一列に並んでいます。 何個かのセルはトークンを含んでいるかもしれません。 あなたは、 `0` と `1` からなる文字列 $ s $ が与えられます。 $ s $ の $ i $ 文字目が `1` のとき、(左から) $ i $ 番目のセルはトークンを一個含んでいます。 そうでないとき、トークンを含んでいません。

すぬけ君は、以下の操作をできる限り行いたいです。 各操作では、三個の連続するセルを選びます。 セルを左から $ X,\ Y,\ Z $ とします。 操作を行うためには、 $ X $ と $ Z $ の両方がトークンを含み、 $ Y $ はトークンを含んでいてはなりません。 次に、すぬけ君はこれらの二個のトークンを取り除き、新しいトークンを $ Y $ に一個置きます。

最適な操作の方法をしたとき、すぬけ君は何回操作を行えますか？

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ s $

## 输出格式

答えを出力せよ。

## 说明/提示

### 制約

- $ 1\ \leq\ N\ \leq\ 500,000 $
- $ |s|\ =\ N $
- $ s $ の各文字は `0` または `1` である。

### Sample Explanation 1

例えば、以下の方法で操作を二回行うことができます: - 最後の三個のセルに対し操作を行う。 トークンを表す文字列は `1010010` となる。 - 最初の三個のセルに対し操作を行う。 トークンを表す文字列は `0100010` となる。 操作の順番が重要であることに注意してください。 たとえば、最初に中央の三個のセルを選ぶと、それ以上操作を行えなくなります。

## 样例 #1

### 输入

```
7

1010101
```

### 输出

```
2
```

## 样例 #2

### 输入

```
50

10101000010011011110001001111110000101010111100110
```

### 输出

```
10
```



---

---
title: "Homework"
layout: "post"
diff: 省选/NOI-
pid: AT_code_festival_2018_final_i
tag: []
---

# Homework

## 题目描述

[problemUrl]: https://atcoder.jp/contests/code-festival-2018-final/tasks/code_festival_2018_final_i

高橋君は夏休みの宿題を片付けることにしました。

宿題は $ 1 $ から $ N $ までの番号がついた $ N $ 個の問題からなります。 問題 $ i $ は解くのに $ 2^{A_i} $ 秒かかり、$ B_i $ 点だけ得点が得られます。

高橋君は得られた得点の総和が $ K $ 以上になるように問題を解く必要があります。これを達成するために必要な時間の最小値を求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ K $ $ A_1 $ $ B_1 $ $ : $ $ A_{N} $ $ B_{N} $

## 输出格式

答えを出力せよ。

## 说明/提示

### 制約

- $ 1\ \leq\ N\ \leq\ 10^{5} $
- $ 0\ \leq\ A_i\ \leq\ 30 $
- $ 1\ \leq\ B_i\ \leq\ 10^{9} $
- $ 1\ \leq\ K\ \leq\ Σ{B_i} $
- 与えられる入力は全て整数

### Sample Explanation 1

\- 問題 $ 2,3,5 $ を解くと、$ 7 $ 秒間で $ 24 $ 点が得られ、これが最適です。

### Sample Explanation 3

\- 答えが大きくなりうることに注意してください

## 样例 #1

### 输入

```
6 24

1 5

0 4

1 9

2 10

2 11

3 15
```

### 输出

```
7
```

## 样例 #2

### 输入

```
13 105

0 1

3 8

5 28

0 1

0 2

4 17

5 26

5 33

3 8

4 19

3 7

2 4

4 17
```

### 输出

```
98
```

## 样例 #3

### 输入

```
5 5000000000

30 1000000000

30 1000000000

30 1000000000

30 1000000000

30 1000000000
```

### 输出

```
5368709120
```



---

---
title: "部屋割り"
layout: "post"
diff: 省选/NOI-
pid: AT_code_festival_final_h
tag: []
---

# 部屋割り

## 题目描述

[problemUrl]: https://atcoder.jp/contests/code-festival-2014-final/tasks/code_festival_final_h

高橋君たちは、合宿で、$ N $ 人で、$ K $ 個の部屋に泊まることになっています。

高橋君たちは、$ 1 $ から $ N $ までの数が書かれたくじを用意し、番号の小さい人から順番に、泊まる部屋を決めることにしました。

高橋君たちのグループは、静かな部屋が好きな人と、賑やかな部屋が好きな人の、$ 2 $ 種類の人がいます。

静かな部屋が好きな人は、出来るだけ人数の少ない部屋を好みます。今までの部屋割りで、最も人数が少ない部屋に泊まることにします。

賑やかな部屋が好きな人は、出来るだけ人数の多い部屋を好みます。今までの部屋割りで、最も人数が多い部屋に泊まることにします。

どちらのタイプの人も、もし条件を満たす部屋が複数ある場合は、条件を満たす部屋の中から、等確率で $ 1 $ つの部屋を選んで、その部屋に泊まります。

高橋君は、くじ引きが終わった後、実際に部屋割りを決める前の段階で、それぞれの参加者が、何人の人と同じ部屋で泊まることになるかを予測したいと思っています。

それぞれの参加者に対し、同じ部屋に泊まる人数の期待値を求めなさい。なお、同じ部屋に泊まる人数には、その人自身も含めることとする。

## 输入格式

入力は以下の形式で標準入力から与えられる

> $ N $ $ K $ $ S $

- $ 1 $ 行目には、合宿に参加する人数 $ N\ (1\ ≦\ N\ ≦\ 200,000) $ と、部屋の数 $ K\ (1\ ≦\ K\ ≦\ 200,000) $ が、空白区切りで与えられる。
- $ 2 $ 行目には、合宿参加者が、どのような人であるかの情報を表す文字列 $ S(|S|\ =\ N) $ が、 $ 1 $ 行で与えられる。
- $ S $ は、`0`、`1`のどちらかの文字のみで構成され、$ i $ 番目の文字 $ S_i $ が、くじが $ i $ 番目の人の情報を表す。もし $ S_i $ が`0`であれば、$ i $ 番目の人が、静かな部屋が好きな人であることを表し、 `1`であれば、賑やかな部屋が好きな人であることを表す。

## 输出格式

それぞれの参加者に対し、同じ部屋に泊まる人数の期待値を、$ 1 $ 行ずつ $ N $ 行で出力せよ。

$ i $ 行目には、くじが $ i $ の人の参加者の、同じ部屋に泊まる人数の期待値を出力せよ。

なお、誤差は、相対誤差または絶対誤差が $ 10^{-6} $ まで許容される。

## 说明/提示

### Sample Explanation 1

$ 1,2,3 $ 番目の人は、$ 1,2,4 $ 人部屋に等確率で泊まることになるため、期待値は $ 7/3 $ です。 $ 4,5 $ 番目の人は、 $ 2,4 $ 人部屋に等確率で泊まることになるため、期待値は $ 3 $ です。 $ 6,7 $ 番目の人は、 $ 4 $ 人部屋に泊まることになるため、期待値は $ 4 $ です。

## 样例 #1

### 输入

```
7 3

1000011
```

### 输出

```
2.33333333333333

2.33333333333333

2.33333333333333

3

3

4

4
```

## 样例 #2

### 输入

```
12 5

000000101101
```

### 输出

```
2.4

2.4

2.4

2.4

2.4

6

6

2

6

6

2

6
```



---

---
title: "Shapes"
layout: "post"
diff: 省选/NOI-
pid: AT_code_festival_final_i
tag: []
---

# Shapes

## 题目描述

在二维平面上有 $n$ 个图形，每个图形是由所有与某个点 $(x_i, y_i)$ 的曼哈顿距离正好为 $r_i$ 的点组成的。任意两个图形之间没有重叠区域。

接下来有 $m$ 个查询，要求计算从某个坐标点 $(x1, y1)$ 到另一个坐标点 $(x2, y2)$ 的最短路径上必须经过的点数。需要注意的是，查询中提供的坐标保证不在任何一个图形内。

移动过程中，可以经过任何实数坐标点。

## 输入格式

输入通过标准输入提供，格式如下：

> $ n $ $ x_1 $ $ y_1 $ $ r_1 $ $ x_2 $ $ y_2 $ $ r_2 $ : $ x_n $ $ y_n $ $ r_n $ $ m $ $ x1_1 $ $ y1_1 $ $ x2_1 $ $ y2_1 $ $ x1_2 $ $ y1_2 $ $ x2_2 $ $ y2_2 $ : $ x1_m $ $ y1_m $ $ x2_m $ $ y2_m $

- 第一行有一个整数 $n$，表示图形数量 $(1 \leq n \leq 10^5)$。
- 接下来的 $n$ 行中，每行有三个整数 $x_i, y_i, r_i$，描述每个图形的信息 $(-10^8 \leq x_i, y_i \leq 10^8, 1 \leq r_i \leq 10^8)$。这些图形之间没有重叠区域。
- 第 $n+1$ 行有一个整数 $m$，表示查询数目 $(1 \leq m \leq 10^5)$。
- 接下来的 $m$ 行中，每行有四个整数 $x1_i, y1_i, x2_i, y2_i$，描述每个查询的起点和终点。该坐标保证不在任何图形内 $(-10^8 \leq x1_i, y1_i, x2_i, y2_i \leq 10^8)$。

## 输出格式

对于每个查询，按输入顺序输出结果，每个结果占一行。即使是最后一行也需要包含换行符。

 **本翻译由 AI 自动生成**

## 样例 #1

### 输入

```
5

0 0 1

0 0 5

0 0 9

0 0 13

20 20 1

4

0 0 13 13

0 0 0 7

0 2 0 3

0 0 20 20
```

### 输出

```
4

2

0

5
```

## 样例 #2

### 输入

```
6

0 0 10

0 5 4

5 0 4

0 -5 4

-5 0 4

8 8 2

4

0 5 0 -5

6 0 10 10

-5 0 0 0

5 0 8 8
```

### 输出

```
2

2

1

3
```



---

---
title: "宝探し 2"
layout: "post"
diff: 省选/NOI-
pid: AT_code_festival_morning_hard_c
tag: []
---

# 宝探し 2

## 题目描述

**宝藏寻找 2**


太郎来到一个广场寻找宝藏。

这个广场被水平方向的 \( n \) 条线和垂直方向的 \( m \) 条线等间距地划分。相邻两条线之间的距离是 \( 1 \)。从上方数第 \( i \) 条水平线与从左侧数第 \( j \) 条垂直线相交的点的位置可以用坐标 (\( i \), \( j \)) 表示，在该点下埋藏着一种共 \( k \) 种之一的宝藏。

太郎拥有一台先进的机器，可以知道所有宝藏的埋藏位置和种类。因此，他打算调查广场上各种矩形区域内哪种宝藏的数量最多。

然而，次郎会时不时地恶作剧，将相邻的两个宝藏的位置交换。这里所说的相邻是指两处宝藏的埋藏点之间的距离恰好为 \( 1 \)。

请代替苦恼的太郎，对于给定的每个区域，找出其中数量最多的宝藏种类。

## 输入格式

输入以以下格式给出：

> \( n \) \( m \) \( k \) \( a_{1,1} \) \( a_{1,2} \) \( \ldots \) \( a_{1,m} \) \( \ldots \) \( a_{n,1} \) \( a_{n,2} \) \( \ldots \) \( a_{n,m} \) \( q \) \( t_1 \) \( x_{11} \) \( y_{11} \) \( x_{21} \) \( y_{21} \) \( \ldots \) \( t_q \) \( x_{1q} \) \( y_{1q} \) \( x_{2q} \) \( y_{2q} \)

* 第一行包含三个整数：表示广场上水平线条数的 \( n \)（\( 1 \leq n \leq 500 \)）、垂直线条数的 \( m \)（\( 1 \leq m \leq 500 \)）以及广场上宝藏种类数的 \( k \)（\( 1 \leq k \leq 100 \)）。
* 接下来的 \( n \) 行给出了广场上每个位置所埋藏的宝藏种类。
* \( a_{i,j} \)（\( 1 \leq a_{i,j} \leq k \)）表示广场上位置 (\( i \), \( j \)) 下所埋藏的宝藏种类。
* 在第 \( n + 2 \) 行有一个整数 \( q \)（\( 1 \leq q \leq 100,000 \)），表示查询的数量。
* 接下来的 \( q \) 行给出了每个查询的信息。
* \( t_i \)（\( 1 \leq t_i \leq 2 \)）表示第 \( i \) 个查询的类型。
* 当 \( t_i = 1 \) 时，表示第 \( i \) 个查询是由次郎发起的交换宝藏的查询，位置 (\( x_{1i} \), \( y_{1i} \)) 和位置 (\( x_{2i} \), \( y_{2i} \)) 上的宝藏会被交换。
* 当 \( t_i = 1 \) 时，位置 (\( x_{1i} \), \( y_{1i} \)) 和 (\( x_{2i} \), \( y_{2i} \)) 必定相邻。
* 当 \( t_i = 2 \) 时，表示第 \( i \) 个查询是调查当前宝藏状态的查询，需要统计位置 (\( x_{1i} \), \( y_{1i} \)) 和 (\( x_{2i} \), \( y_{2i} \)) 作为对角顶点的、与广场上的线条平行的矩形中的宝藏情况。
* 当 \( t_i = 2 \) 时，必定有 \( x_{1i} \leq x_{2i} \) 并且 \( y_{1i} \leq y_{2i} \)。
* 对于每个查询，都有 \( 1 \leq x_{1i}, x_{2i} \leq n \) 且 \( 1 \leq y_{1i}, y_{2i} \leq m \)。

## 输出格式

对于每个 \( t_i = 2 \) 的查询，输出该查询所表示的矩形区域内数量最多的宝藏种类及其数量，每组答案占一行。

如果数量最多的宝藏种类不止一种，则输出种类编号最大的那种。

最后不要有多余的字符或空行。

## 样例 #1

### 输入

```
3 3 3

1 1 1

2 2 2

3 3 3

5

2 1 1 2 3

1 2 2 3 2

2 1 1 2 3

1 1 3 2 3

2 2 2 3 3
```

### 输出

```
2 3

1 3

3 2
```

## 样例 #2

### 输入

```
2 4 5

1 2 3 3

2 5 1 1

4

2 1 1 1 1

1 1 3 1 2

1 2 3 1 3

2 2 1 2 4
```

### 输出

```
1 1

2 2
```



---

---
title: "ノイハの塔"
layout: "post"
diff: 省选/NOI-
pid: AT_code_formula_2014_final_g
tag: []
---

# ノイハの塔

## 题目描述

[problemUrl]: https://atcoder.jp/contests/code-formula-2014-final/tasks/code_formula_2014_final_g

「ハノイの塔」という有名なパズルがあります。 ハノイの塔は $ 3 $ つの杭と、中央に穴の空いたサイズが相異なる $ N $ 個の円盤からなるパズルです。 $ 3 $ つの杭には $ 1 $ から $ 3 $ の番号が付けられています。また、 $ i $ 番目に小さい円盤の半径は $ i $ センチメートルです。

初め、全ての円盤は杭 $ 1 $ に、サイズが大きい順に下から積み重ねられて、「塔」を形成しています。杭 $ 2,\ 3 $ には何も置いていません。 プレイヤーは $ 1 $ 回の操作で、ある杭の塔の一番上にある円盤を、他の杭に移動させて、移動先の杭の塔の一番上に積み重ねるという事ができます。 このとき、小さい円盤の上に大きい円盤を置くことはできません。 ハノイの塔のゴールはできるだけ少ない回数の操作で、高さ$ N $の塔を杭 $ 2 $ もしくは杭 $ 3 $ に移すことです。

高橋君は久しぶりにこのパズルを遊ぼうと思い、押し入れの奥からハノイの塔のおもちゃを探しだしました。 しかし、だれかがいたずらをしたようで、$ N $ 個全ての円盤がバラバラの順番で杭 $ 1 $ に積まれていました。 そこで高橋君はそのバラバラの状態から開始して、「小さい円盤の上に大きい円盤を置いてはならない」というルールを無視して操作し、いずれかの杭に全ての円盤がサイズが大きい順に下から積み重なるように移動させる、という別のパズルを遊ぶことにしました。

あらかじめ、杭 $ 1 $ に積み重ねられている円盤のサイズの情報が与えられるので、いずれかの杭(杭 $ 1 $ でもよい)に全ての円盤がサイズ順に積み重なるように移動させる操作をひとつ挙げてください。 ただし操作が多すぎるとパズルとして美しくないので $ 225,000 $ 回以内の操作で移動させてください。

## 输入格式

入力は以下の形式で標準入力から与えられる

> $ N $ $ r_1 $ $ r_2 $ : $ r_N $

- $ 1 $ 行目には円盤の個数 $ N\ (1\ ≦\ N\ ≦\ 10,000) $ が与えられる。
- $ 2 $ 行目からの $ N $ 行のうち $ i $ 行目には、初め杭 $ 1 $ に下から $ i $ 番目に置かれている円盤の半径 $ r_i\ (1\ ≦\ r_i\ ≦\ N) $が与えられる。
- $ x\ ≠\ y $ ならば $ r_x\ ≠\ r_y $ が成り立つ。

## 输出格式

出力形式は以下のようなものである。

> $ M $ $ from_1 $ $ to_1 $ $ from_2 $ $ to_2 $ : $ from_M $ $ to_M $

- $ 1 $ 行目には操作の回数 $ M $ を出力せよ。
- $ 2 $ 行目からの $ M $ 行のうち $ i $ 行目には$ i $番目の操作で動かす円盤の元あった杭の番号 $ from_i $ と動かす先の杭の番号 $ to_i $ を空白区切りで出力せよ。
- $ i $ 番目の操作の時に、杭 $ from_i $ に円盤が一つも存在しない場合、その操作は妥当でないとする。それ以外の操作は妥当であるとする。
- 本来のハノイの塔と異なり小さい円盤の上に大きい円盤を置くことが許されていることに注意せよ。
- $ M\ ≦\ 225,000 $ かつすべての操作が妥当であり、最後にいずれかの杭に全ての円盤がサイズの大きい順に下から積み重ねられていたときのみ、解答は正解とされる。

## 说明/提示

### 部分点

この問題には部分点が設定されている。

- $ 1\ ≦\ N\ ≦\ 400 $を満たすデータセットに正解した場合は $ 30 $ 点が与えられる。
- $ 1\ ≦\ N\ ≦\ 10,000 $を満たすデータセットに正解した場合はさらに $ 70 $ 点が与えられる。合計で$ 100 $点となる。

### Sample Explanation 1

初め、全ての円盤が逆順に杭 $ 1 $ に積み重ねられています。上から順番に杭 $ 2 $ に移動させれば、下から大きい順に並び替えられます。

### Sample Explanation 2

最後に全ての円盤が積み重ねられる杭は $ 1 $ でもかまいません。

## 样例 #1

### 输入

```
5

1

2

3

4

5
```

### 输出

```
5

1 2

1 2

1 2

1 2

1 2
```

## 样例 #2

### 输入

```
5

5

3

2

4

1
```

### 输出

```
8

1 2

1 2

1 3

1 3

2 1

3 1

3 1

2 1
```



---

---
title: "なめらかな木"
layout: "post"
diff: 省选/NOI-
pid: AT_ddcc2017_final_d
tag: []
---

# なめらかな木

## 题目描述

[problemUrl]: https://atcoder.jp/contests/ddcc2017-final/tasks/ddcc2017_final_d

$ N $ 頂点の木が与えられます。 頂点には番号 $ 1,\ 2,\ ...,\ N $ がついており、$ i $ 番目の辺は頂点 $ a_i,\ b_i $ をつないでいます。

木の頂点に整数 $ 1,\ 2,\ ...,\ N $ をそれぞれ $ 1 $ 個ずつ書き込むことを考えます。 頂点 $ i $ に書き込んだ値を $ c_i $ とします。

ただし、頂点 $ u,\ v $ が隣り合っている、つまり辺 $ (u,\ v) $ が存在するならば、 $ |c_u\ -\ c_v|\ ≦\ 2 $ を満たしていないといけません。(10:53)変数名を修正しました

このような書き込み方は何通りあるでしょうか、$ 1000000007\ =\ 10^9\ +\ 7 $ で割った余りを求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ a_1 $ $ b_1 $ $ a_2 $ $ b_2 $ $ : $ $ a_{N-1} $ $ b_{N-1} $

## 输出格式

求めた答えを出力してください。

## 说明/提示

### 制約

- $ 1\ ≦\ N\ ≦\ 50 $
- $ 1\ ≦\ a_i,\ b_i\ ≦\ N $
- 入力は木になっている

### Sample Explanation 1

頂点 $ 1 $ に $ 3 $ を書き込む必要があります。

## 样例 #1

### 输入

```
5

1 2

1 3

1 4

1 5
```

### 输出

```
24
```

## 样例 #2

### 输入

```
6

1 2

1 3

1 4

1 5

1 6
```

### 输出

```
0
```

## 样例 #3

### 输入

```
4

1 2

2 3

3 4
```

### 输出

```
12
```

## 样例 #4

### 输入

```
7

1 3

2 3

4 3

5 4

5 6

5 7
```

### 输出

```
48
```



---

---
title: "足のばし"
layout: "post"
diff: 省选/NOI-
pid: AT_ddcc2017_final_e
tag: []
---

# 足のばし

## 题目描述

[problemUrl]: https://atcoder.jp/contests/ddcc2017-final/tasks/ddcc2017_final_e

高橋君は $ N $ 頂点からなる木のぬいぐるみを持っています。 頂点には番号 $ 1,\ 2,\ ...,\ N $ がついています。

$ i $ 番目の辺は頂点 $ a_i,\ b_i $ をつないでおり、長さは $ 1 $ です。

$ {\rm\ dist}(u,\ v) $ を頂点 $ u $ から頂点 $ v $ への最短距離と定義します。すると木の直径は $ {\rm\ max}_{1\ ≦\ u\ <\ v\ ≦\ N}({\rm\ dist}(u,\ v)) $ となります。

青木君はこのぬいぐるみに対して、辺を $ 1 $ 本選んでその長さを $ 1 $ 増やす、というイタズラを何回か行いました。 イタズラの回数は $ K_1,\ K_2,\ ...,\ K_Q $ のどれかであることが分かっています。

また、青木君は直径の短い木のほうが好きなので、イタズラを全て終えた後の木の直径ができる限り短くなるように操作を行ったことが分かっています。

イタズラの回数が $ K_1,\ K_2,\ ...,\ K_Q $ の場合それぞれについて、イタズラを全て終えた後の木の直径を求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ a_1 $ $ b_1 $ $ a_2 $ $ b_2 $ $ : $ $ a_{N-1} $ $ b_{N-1} $ $ Q $ $ K_1 $ $ K_2 $ ... $ K_Q $

## 输出格式

$ Q $ 行出力してください。 $ i $ 行目には、イタズラの回数を $ K_i $ としたときの、木の直径を出力してください。

## 说明/提示

### 制約

- $ 3\ ≦\ N\ ≦\ 200,000 $
- $ 1\ ≦\ a_i,\ b_i\ ≦\ N $
- 入力は木になっている
- $ 1\ ≦\ Q\ ≦\ 200,000 $
- $ 0\ ≦\ K_1\ <\ K_2\ <\ ...\ <\ K_Q\ ≦\ 10^{18} $

## 样例 #1

### 输入

```
4

1 2

1 3

1 4

10

0 1 2 3 4 5 6 7 8 9
```

### 输出

```
2

3

4

4

5

6

6

7

8

8
```

## 样例 #2

### 输入

```
9

1 4

2 4

3 4

4 5

5 6

6 7

7 8

8 9

10

0 1 2 3 4 5 6 7 8 9
```

### 输出

```
6

7

7

7

8

8

8

9

9

9
```

## 样例 #3

### 输入

```
6

6 3

3 4

3 2

3 1

1 5

31

0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30
```

### 输出

```
3

4

4

4

5

6

6

6

7

8

8

8

9

10

10

10

11

12

12

12

13

14

14

14

15

16

16

16

17

18

18
```



---

---
title: "Majority of Balls"
layout: "post"
diff: 省选/NOI-
pid: AT_ddcc2020_qual_e
tag: []
---

# Majority of Balls

## 题目描述

[problemUrl]: https://atcoder.jp/contests/ddcc2020-qual/tasks/ddcc2020_qual_e

**これはインタラクティブな問題です。**

$ 2N $ 個のボールが一列に並べられており，左から順にボール $ 1,\ 2,\ 3,\ ...,\ 2N $ と番号づけられています．ここで，$ N $ は奇数です．この中には，$ N $ 個の赤いボールと $ N $ 個の青いボールが含まれています．

目隠しをされたあなたは，それぞれのボールの色を当てなければなりません．そのために，以下の質問を $ 210 $ 回まで行うことができます．

- $ 2N $ 個のボールから任意に $ N $ 個を選び，その中で赤いボールと青いボールのどちらの方が多いかを聞く．

では，始めましょう．

### Input &amp; Output Format

最初に，各色のボールの数 $ N $ を標準入力から受け取ってください．

> $ N $

次に，すべてのボールの色が分かるまで質問を繰り返してください．  
 質問は，以下の形式で標準出力に出力してください．

> ? $ A_1 $ $ A_2 $ $ A_3 $ $ ... $ $ A_N $

これは，あなたが $ N $ 個のボール $ A_1,\ A_2,\ A_3,\ ...,\ A_N $ を選んで質問することを意味します．  
 ただし，$ 1\ \leq\ A_i\ \leq\ 2N,\ A_i\ \neq\ A_j\ (i\ \neq\ j) $ を満たさなければなりません．

これに対する応答は，次の形式で標準入力から与えられます．

> $ T $

ここで，$ T $ は以下のいずれかの文字列です．

- `Red`: 選んだ $ N $ 個のボールの中では，青のボールより赤のボールの方が多い．
- `Blue`: 選んだ $ N $ 個のボールの中では，赤のボールより青のボールの方が多い．
- `-1`: あなたは不正な質問 (質問の回数が $ 210 $ 回を超えた場合を含む)，またはその他の不正な出力を行った．

ジャッジが応答 `-1` を返した場合，提出はすでに不正解とみなされています．この場合，プログラムをすぐに終了させてください．

すべてのボールの色が分かったら，解答を以下の形式で標準出力に出力してください．

> ! $ c_1 $$ c_2 $$ c_3 $$ ... $$ c_{2N} $

ここで，$ c_i $ はボール $ i $ の色を表す文字で，赤の場合は $ c_i= $`R`，青の場合は $ c_i= $`B` としてください．

## 说明/提示

### 制約

- $ 1\ \leq\ N\ \leq\ 99 $
- $ N $ は奇数

- - - - - -

### 注意

- **出力のたびに標準出力を flush してください．**そうしない場合、`TLE` の可能性があります．
- 解答を出力したら (または応答 `-1` を受け取ったら)，プログラムをすぐに終了してください．そうしない場合、ジャッジ結果は不定です。
- 不正な出力が行われた場合のジャッジ結果は不定です。

- - - - - -

### 入出力例

Input Output `3`   `? 1 2 3` `Red`   `? 2 4 6` `Blue`   `! RRBBRB`この例では $ N\ =\ 3 $ であり，ボール $ 1,\ 2,\ 3,\ 4,\ 5,\ 6 $ の色はそれぞれ赤，赤，青，青，赤，青です．

- $ 1 $ 回目の質問では，ボール $ 1,\ 2,\ 3 $ のうち赤は $ 2 $ 個，青は $ 1 $ 個であり，赤の方が多いのでジャッジは `Red` を返します．
- $ 2 $ 回目の質問では，ボール $ 2,\ 4,\ 6 $ のうち赤は $ 1 $ 個，青は $ 2 $ 個であり，青の方が多いのでジャッジは `Blue` を返します．



---

---
title: "ディスコ社内ツアーⅡ"
layout: "post"
diff: 省选/NOI-
pid: AT_discovery_2016_final_d
tag: []
---

# ディスコ社内ツアーⅡ

## 题目描述

给定一个 $N$ 个顶点， $M$ 条边的有向图，第 $i$ 条边会被记为 `O` 或 `E`。

遍历由顶点 $s$ 开始，至 $t$ 结束。

图中的边若被记为 `O` ：则该条边可以通过奇数次；
若被记为 `E` ：则该条边可以通过偶数次（可为 $0$ 次）。

询问遍历有多少种走法。

## 输入格式

格式如下：

第一行给出两个数 $N$，$M$ $(2 \le N \le 200，1\le M \le N(N-1))$。

接下来 $M$ 行，每行有两个数和一个字符 `O` 或 `E` ，分别表示起点 $s$ 和终点 $t$ ，和该边被标记的类型。

给出的图不含有重边和自环。

## 输出格式

输出答案表示方案总数。



**谢谢！**

## 样例 #1

### 输入

```
2 1

1 2 O
```

### 输出

```
1
```

## 样例 #2

### 输入

```
2 1

1 2 E
```

### 输出

```
2
```

## 样例 #3

### 输入

```
4 2

1 2 O

3 4 E
```

### 输出

```
1
```

## 样例 #4

### 输入

```
4 2

1 2 O

3 4 O
```

### 输出

```
0
```

## 样例 #5

### 输入

```
3 3

1 2 O

2 3 O

3 1 O
```

### 输出

```
3
```

## 样例 #6

### 输入

```
4 5

1 2 O

2 1 O

2 3 O

3 1 E

2 4 O
```

### 输出

```
1
```

## 样例 #7

### 输入

```
4 3

1 2 O

2 1 O

3 4 E
```

### 输出

```
2
```

## 样例 #8

### 输入

```
2 2

1 2 O

2 1 E
```

### 输出

```
2
```

## 样例 #9

### 输入

```
4 3

1 2 O

1 3 O

1 4 O
```

### 输出

```
0
```



---

---
title: "アメージングな文字列は、きみが作る！"
layout: "post"
diff: 省选/NOI-
pid: AT_discovery_2016_qual_c
tag: []
---

# アメージングな文字列は、きみが作る！

## 题目描述

你正在参加 DISCO 公司的面试，面试官给你布置了一项挑战：提供一个仅由小写字母组成的字符串 $S$，并要求你通过以下三种操作中的某一种，恰好进行 $K$ 次，改造该字符串，并生成一个在你的理解中“令人惊叹”的新字符串。

可选择的操作有：

1. 删除字符串 $S$ 中的第 $i$ 个字符（1 ≤ i ≤ |S|）。
2. 将字符串 $S$ 中的第 $i$ 个字符替换为另一小写字母（1 ≤ i ≤ |S|）。
3. 在字符串 $S$ 的第 $i$ 个位置插入一个小写字母（1 ≤ i ≤ |S|+1）。

你的目标是通过 $K$ 次操作，生成出字典序最小的字符串，以惊艳面试官。

对于字符串 $X$，$|X|$ 表示字符串 $X$ 的长度。  
对于两个字符串 $s = s_1s_2s_3\ldots s_n$ 和 $t = t_1t_2t_3\ldots t_m$，如果满足下列任一条件，则 $s$ 在字典序上小于 $t$：

- 对于某个整数 $i$（1 ≤ i ≤ min(n, m)），满足对于任何 $j$（1 ≤ j < i），有 $s_j = t_j$ 且 $s_i < t_i$。
- 对于任意整数 $i$（1 ≤ i ≤ min(n, m)），有 $s_i = t_i$ 且 $n < m$。

## 输入格式

输入包括两行：

- 第一行为给定的字符串 $S$，只包含小写字母，满足 2 ≤ |S| ≤ 300,000。
- 第二行为整数 $K$，表示必须进行的操作次数，满足 1 ≤ K ≤ |S| - 1。

## 输出格式

输出通过对 $S$ 进行 $K$ 次操作后生成的字典序最小的字符串，注意输出末尾应包含换行。

## 说明/提示

### 部分分数

本题设置了不同数据范围的部分分数。

- 如果满足条件 2 ≤ |S| ≤ 10，1 ≤ K ≤ min(|S|-1, 4)，则解答正确可得 10 分。
- 如果满足条件 2 ≤ |S| ≤ 200，则额外得 10 分。
- 如果满足条件 2 ≤ |S| ≤ 1,000，则额外得 20 分。
- 如果满足条件 2 ≤ |S| ≤ 300,000，则额外得 60 分，总共能得到 100 分。

### 示例解释 1
通过在 $S$ 开头插入一个字母 `a`，可以得到字符串 `aabc`，这是进行一次操作后可以获得的字典序最小的字符串。这一示例满足第一个部分分数的要求。

### 示例解释 2
通过删除 $S$ 的第 2 个和第 3 个字符，可以得到字符串 `a`，这是进行两次操作后可以获得的字典序最小的字符串。这一示例满足第一个部分分数的要求。

### 示例解释 3
通过替换 $S$ 的第 2 个字符，可以得到字符串 `aab`，这是进行一次操作后可以获得的字典序最小的字符串。这一示例满足第一个部分分数的要求。

 **本翻译由 AI 自动生成**

## 样例 #1

### 输入

```
abc

1
```

### 输出

```
aabc
```

## 样例 #2

### 输入

```
abc

2
```

### 输出

```
a
```

## 样例 #3

### 输入

```
acb

1
```

### 输出

```
aab
```



---

---
title: "Balanced Piles"
layout: "post"
diff: 省选/NOI-
pid: AT_diverta2019_2_e
tag: []
---

# Balanced Piles

## 题目描述

[problemUrl]: https://atcoder.jp/contests/diverta2019-2/tasks/diverta2019_2_e

$ N $ 個のマスが横一列に並んでおり、左から順に $ 1 $ から $ N $ までの番号がつけられています。高橋君はこれらのマスに積み木を積もうとしています。 まだそれぞれのマスには積み木が $ 1 $ つも積まれていません。

積み木をバランス良く積みたい高橋君は、以下の操作を繰り返して全てのマスに積み木がちょうど $ H $ 個ずつ積まれている状態にしようとしています。

- $ 1 $ マスに積まれている積み木の最大値を $ M $ 個、最小値を $ m $ 個とする。$ m $ 個の積み木が置かれているマスを $ 1 $ つ選び (複数ある場合はどれを選んでもよい)、そのマスに積まれた積み木が $ M $ 個以上 $ M\ +\ D $ 個以下になるように積み木を正の個数積む。

高橋君のために、この操作を繰り返して全てのマスに積み木がちょうど $ H $ 個積まれている状態にする方法が何通りあるか数えてあげてください。答えは非常に大きくなる場合があるので、$ 10^9+7 $ で割った余りを出力してください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ H $ $ D $

## 输出格式

全てのマスに積み木がちょうど $ H $ 個積まれている状態にする方法の個数を $ 10^9+7 $ で割った余りを出力せよ。

## 说明/提示

### 制約

- $ 2\ \leq\ N\ \leq\ 10^6 $
- $ 1\ \leq\ D\ \leq\ H\ \leq\ 10^6 $
- 入力は全て整数である

### Sample Explanation 1

(マス $ 1 $ に積まれた積み木の個数, マス $ 2 $ に積まれた積み木の個数) は次のように変化させることができます。 - $ (0,\ 0) $ -&gt; $ (0,\ 1) $ -&gt; $ (1,\ 1) $ -&gt; $ (1,\ 2) $ -&gt; $ (2,\ 2) $ - $ (0,\ 0) $ -&gt; $ (0,\ 1) $ -&gt; $ (1,\ 1) $ -&gt; $ (2,\ 1) $ -&gt; $ (2,\ 2) $ - $ (0,\ 0) $ -&gt; $ (0,\ 1) $ -&gt; $ (2,\ 1) $ -&gt; $ (2,\ 2) $ - $ (0,\ 0) $ -&gt; $ (1,\ 0) $ -&gt; $ (1,\ 1) $ -&gt; $ (1,\ 2) $ -&gt; $ (2,\ 2) $ - $ (0,\ 0) $ -&gt; $ (1,\ 0) $ -&gt; $ (1,\ 1) $ -&gt; $ (2,\ 1) $ -&gt; $ (2,\ 2) $ - $ (0,\ 0) $ -&gt; $ (1,\ 0) $ -&gt; $ (1,\ 2) $ -&gt; $ (2,\ 2) $ よって、全てのマスに積み木がちょうど $ 2 $ 個積まれている状態にする方法の個数は $ 6 $ 通りです。

### Sample Explanation 3

個数を $ 10^9+7 $ で割った余りを出力することに注意してください。

## 样例 #1

### 输入

```
2 2 1
```

### 输出

```
6
```

## 样例 #2

### 输入

```
2 30 15
```

### 输出

```
94182806
```

## 样例 #3

### 输入

```
31415 9265 3589
```

### 输出

```
312069529
```



---

---
title: "XOR Partitioning"
layout: "post"
diff: 省选/NOI-
pid: AT_diverta2019_e
tag: []
---

# XOR Partitioning

## 题目描述

[problemUrl]: https://atcoder.jp/contests/diverta2019/tasks/diverta2019_e

長さ $ n $ の数列 $ a $ の *美しさ* を $ a_1\ \oplus\ a_2\ \oplus\ \cdots\ \oplus\ a_{n} $ で定義します。ここで $ \oplus $ はビットごとの排他的論理和を表します。

長さ $ N $ の数列 $ A $ が与えられます。 すぬけ君は $ A $ に $ 0 $ 個以上の仕切りを入れて、いくつかの空でない連続する部分列に分割しようとしています。

仕切りを入れる方法は $ 2^{N-1} $ 通りあります。 それらのうち、分割された数列たちの美しさが全て等しくなるものの個数を $ 10^{9}+7 $ で割ったあまりを求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ A_1 $ $ A_2 $ $ \ldots $ $ A_{N} $

## 输出格式

答えを出力せよ。

## 说明/提示

### 制約

- 入力は全て整数
- $ 1\ \leq\ N\ \leq\ 5\ \times\ 10^5 $
- $ 0\ \leq\ A_i\ <\ 2^{20} $

### Sample Explanation 1

条件を満たす分割方法は以下の $ 3 $ 通りです。$ (1),(2),(3) $ と分割したときに限り、全ての美しさが等しくなりません。 - $ (1,2,3) $ - $ (1),(2,3) $ - $ (1,2),(3) $

### Sample Explanation 3

\- 条件を満たすものの個数を $ 10^{9}+7 $ で割ったあまりを求めてください。

## 样例 #1

### 输入

```
3

1 2 3
```

### 输出

```
3
```

## 样例 #2

### 输入

```
3

1 2 2
```

### 输出

```
1
```

## 样例 #3

### 输入

```
32

0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
```

### 输出

```
147483634
```

## 样例 #4

### 输入

```
24

1 2 5 3 3 6 1 1 8 8 0 3 3 4 6 6 4 0 7 2 5 4 6 2
```

### 输出

```
292
```



---

---
title: "Square Rotation"
layout: "post"
diff: 省选/NOI-
pid: AT_dwacon5th_prelims_d
tag: []
---

# Square Rotation

## 题目描述

[problemUrl]: https://atcoder.jp/contests/dwacon5th-prelims/tasks/dwacon5th_prelims_d

ドワンゴ社員のニワンゴくんはテレビちゃんが大好きなので、テレビちゃんのぬいぐるみを大量に集めて床に一面に並べていました。

ニワンゴくんはレアな黒いテレビちゃんのぬいぐるみを $ N $ 個持っていて、普通のテレビちゃんのぬいぐるみと一緒に並べていました。しかし、あちこちに置いておくと管理が難しいので近くにまとめることにしました。

無限に広い二次元平面上のすべての格子点上にぬいぐるみが置いてあります。$ N $ 個の黒いぬいぐるみの座標 $ (x_i,y_i) $ が与えられます。ぬいぐるみは点として扱います。

ニワンゴくんは以下の操作を任意の回数行うことができます。

- 辺が軸に平行な一辺の長さが $ D $ の正方形を、各頂点が格子点と重なるように任意の座標に置き、正方形の角の $ 4 $ 点を、そこにある $ 4 $ 個のぬいぐるみと一緒に $ 90 $ 度回転させる。つまり、正方形の左下の頂点を $ (x,y) $ とした場合、$ (x,y)\ \rightarrow\ (x+D,y)\ \rightarrow\ (x+D,y+D)\ \rightarrow\ (x,y+D)\ \rightarrow\ (x,y) $ の順に、$ 4 $ 点を同時に回転させる

配置の**乱雑さ**を、すべての黒いぬいぐるみを囲うのに必要な辺が軸に平行な正方形の一辺の長さの最小値とします。 ここで、正方形の辺上にあるぬいぐるみも正方形に囲われているものとします。

ニワンゴくんが何度か操作を行ったあとの乱雑さとしてありうる値のうち、最小値を求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ D $ $ x_1 $ $ y_1 $ $ : $ $ x_N $ $ y_N $

## 输出格式

答えを出力せよ。

## 说明/提示

### 制約

- $ 2\ \leq\ N\ \leq\ 10^5 $
- $ 1\ \leq\ D\ \leq\ 1000 $
- $ 0\ \leq\ x_i,\ y_i\ \leq\ 10^9 $
- 与えられる座標はすべて異なる
- 入力として与えられる数値はすべて整数である

### 部分点

- $ 1\ \leq\ D\ \leq\ 30 $ を満たすデータセットに正解すると、$ 500 $ 点が与えられる

## 样例 #1

### 输入

```
3 1

0 0

1 0

2 0
```

### 输出

```
1
```

## 样例 #2

### 输入

```
19 2

1 3

2 3

0 1

1 1

2 1

3 1

4 4

5 4

6 4

7 4

8 4

8 3

8 2

8 1

8 0

7 0

6 0

5 0

4 0
```

### 输出

```
4
```

## 样例 #3

### 输入

```
8 3

0 0

0 3

3 0

3 3

2 2

2 5

5 2

5 5
```

### 输出

```
4
```



---

---
title: "Cookie Distribution"
layout: "post"
diff: 省选/NOI-
pid: AT_dwacon6th_prelims_c
tag: []
---

# Cookie Distribution

## 题目描述

[problemUrl]: https://atcoder.jp/contests/dwacon6th-prelims/tasks/dwacon6th_prelims_c

$ N $ 人の子供たちがいます。子供たちには $ 1,2,\ldots,N $ と番号が振られています。 これから $ K $ 日間、子供たちにクッキーが配られることになりました。 $ i $ 日目には $ N $ 人の中から $ a_i $ 人の子供が等確率で選ばれ、選ばれた子供たちはそれぞれクッキーを $ 1 $ 枚受け取ります。($ K $ 回の子供の選択はすべて独立に行われます。)

$ K $ 日間で子供 $ i $ が受け取るクッキーの枚数を $ c_i $ として、子供たちの *うれしさ* を $ c_1\ \times\ c_2\ \times\ \ldots\ \times\ c_N $ で定義します。 うれしさの期待値に $ \binom{N}{a_1}\ \times\ \binom{N}{a_2}\ \times\ \ldots\ \times\ \binom{N}{a_K} $ をかけた値(これは整数となることが示せます)を $ 10^9+7 $ で割ったあまりを求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ K $ $ a_1 $ $ a_2 $ $ \ldots $ $ a_K $

## 输出格式

答えを出力せよ。

## 说明/提示

### 注記

$ \binom{n}{k} $ は異なる $ n $ 個の対象から $ k $ 個を選ぶ選び方の総数を表します。

### 制約

- $ 1\ \leq\ N\ \leq\ 1000 $
- $ 1\ \leq\ K\ \leq\ 20 $
- $ 1\ \leq\ a_i\ \leq\ N $

### Sample Explanation 1

\- $ 1 $ 日目では、子供 $ 1,2,3 $ のいずれもクッキーを受け取ります。 - $ 2 $ 日目では、子供 $ 1,2,3 $ のいずれか $ 1 $ 人がクッキーを受け取りません。 - どの場合もうれしさは $ 4 $ のため、うれしさの期待値は $ 4 $ となります。これに $ \binom{3}{3}\ \times\ \binom{3}{2} $ をかけた値である $ 12 $ を出力してください。

### Sample Explanation 2

\- 期待値の $ \binom{N}{a_1}\ \times\ \binom{N}{a_2}\ \times\ \ldots\ \times\ \binom{N}{a_K} $ 倍を $ 10^9+7 $ で割ったあまりを求めてください。

## 样例 #1

### 输入

```
3 2

3 2
```

### 输出

```
12
```

## 样例 #2

### 输入

```
856 16

399 263 665 432 206 61 784 548 422 313 848 478 827 26 398 63
```

### 输出

```
337587117
```



---

---
title: "Arrangement"
layout: "post"
diff: 省选/NOI-
pid: AT_dwacon6th_prelims_d
tag: []
---

# Arrangement

## 题目描述

[problemUrl]: https://atcoder.jp/contests/dwacon6th-prelims/tasks/dwacon6th_prelims_d

ニワンゴ君は $ N $ 枚のカードを持っています。カードには $ 1,2,\ldots,N $ と番号が振られています。 ニワンゴ君はこれらのカードを一列に並べることにしました。

ニワンゴ君は以下の $ N $ 個の条件の全てを満たすカードの並べ方が存在するかどうかを知りたいです。 ニワンゴ君のためにそのような並べ方が存在するかどうかを判定し、存在する場合は辞書順最小の並べ方を求めてください。

- カード $ 1 $ の右隣のカードは(存在するならば) $ a_1 $ でない
- カード $ 2 $ の右隣のカードは(存在するならば) $ a_2 $ でない
- $ \vdots $
- カード $ N $ の右隣のカードは(存在するならば) $ a_N $ でない

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ a_1 $ $ a_2 $ $ \ldots $ $ a_N $

## 输出格式

条件を満たす並べ方が存在しない場合は `-1` を、存在する場合は条件を満たす辞書順最小のカードの並びを下記のフォーマットで出力せよ。 ここで、$ b_i $ は左から $ i $ 番目のカードの番号である。

> $ b_1 $ $ b_2 $ $ \ldots $ $ b_N $

## 说明/提示

### 制約

- $ 2\ \leq\ N\ \leq\ 10^{5} $
- $ 1\ \leq\ a_i\ \leq\ N $
- $ a_i\ \neq\ i $

### Sample Explanation 1

\- $ (1,3,2,4) $ よりも辞書順で小さい並べ方は $ (1,2,3,4) $ がありますが、これはカード $ 1 $ の右隣のカードは $ 2 $ でない、という条件に反するため不適切です。

### Sample Explanation 2

\- 条件を満たす並べ方が存在しない場合は `-1` を出力してください。

## 样例 #1

### 输入

```
4

2 3 4 1
```

### 输出

```
1 3 2 4
```

## 样例 #2

### 输入

```
2

2 1
```

### 输出

```
-1
```

## 样例 #3

### 输入

```
13

2 3 4 5 6 7 8 9 10 11 12 13 12
```

### 输出

```
1 3 2 4 6 5 7 9 8 10 12 11 13
```



---

---
title: "コメント"
layout: "post"
diff: 省选/NOI-
pid: AT_dwango2015_finals_2
tag: []
---

# コメント

## 题目描述

### 题目背景

ニワンゴ君正在考虑动画网站弹幕显示方法的新方案。


在有 $N$ 条评论的视频中，评论将以每秒显示 $1$ 个字符的速度从屏幕左侧向右侧流动。在这些评论中，可以按照任意顺序每隔 $1$ 秒显示一条评论。换句话说，第 $i$ 条显示的评论将在最初显示的评论基础上向右移动 $i-1$ 个字符的位置。

ニワンゴ君希望创建出一种情况，即“ $N$ 条评论在同一位置的字符均相同”。也就是说对于所有 $i$，存在整数 $X$ 和字符 $Y$，使得第 $i$ 条显示的评论的第 $X-i$ 个字符为字符 $Y$。

## 输入格式

输入将从标准输入中给出。

> $ N $ $ S_1 $ $ S_2 $ : $ S_N $

- 第 $ 1 $ 行包含一个整数 $ N\ (2 \le N \le 200) $，表示评论数量。
- 接下来的 $N$ 行包含评论信息。第 $i$ 行包含一个字符串 $S_i$，表示第 $i$ 条评论。字符串 $S_i$ 仅包含小写字母，长度至少为 $1$。所有评论的总长度不超过 $10^5$。

## 输出格式

如果可以通过适当的显示顺序确定评论的流动顺序，使得至少创建一种“所有 $N$ 条评论在同一位置的字符均相同”的情况，则输出 `YES`；否则输出 `NO`。

## 样例 #1

### 输入

```
3

abcd

bdac

aca
```

### 输出

```
YES
```

## 样例 #2

### 输入

```
4

dwango

niconico

niwango

ginza
```

### 输出

```
NO
```



---

---
title: "タクシー"
layout: "post"
diff: 省选/NOI-
pid: AT_dwango2015_prelims_4
tag: []
---

# タクシー

## 题目描述

在某个星球上进行了一场编程竞赛的预选赛，名为「ドワンゴからの挑戦状」，预选赛的合格者将被邀请参加正赛。

这个星球上有一条长度为 $ L $ 的环形道路，环形道路上分布着 $ N $ 个城市。这些城市按顺时针方向从 $ 1 $ 到 $ N $ 编号，并且从城市 $ 1 $ 开始顺时针排列。

正赛将在一个或多个城市举行，每个会场都需要进行现场直播。

对于每个城市和会场，我们已经知道该城市的正赛选手有多少人居住，以及会场可以容纳的正赛选手人数。

所有会场的参赛者总数等于所有城市中需要参赛者总数的总和。

有些城市的居住的参赛者人数与需要达到的参赛者人数不一致，这时需要通过出租车在城市间转移参赛者。

出租车在环形道路上行驶，每转移一名参赛者的费用与他们的移动距离成正比。

请计算出使总转移成本最小的方案。

## 输入格式

输入通过标准输入给出，格式如下：

> $ N $ $ L $ $ a_1 $ $ b_1 $ $ c_1 $ $ a_2 $ $ b_2 $ $ c_2 $ : $ a_N $ $ b_N $ $ c_N $

- 第一行包含两个整数 $ N\ (2 \leq N \leq 100,000) $ 和 $ L\ (N \leq L \leq 10,000,000) $，分别代表城市数量和环形道路的长度。
- 接下来的 $ N $ 行，每行包括三个整数 $ a_i\ (0 \leq a_i \leq L - 1) $, $ b_i\ (0 \leq b_i \leq 100,000) $, $ c_i\ (0 \leq c_i \leq 100,000) $，分别表示第 $ i $ 个城市的相对位置，出发参赛者数量，以及该城市如果有会场可以接待的参赛者数量。
  - $ a_1 = 0 $ 表示城市 $ 1 $ 的起始位置，$ a_i > a_{i-1} $ 对于所有 $ i\ (2 \leq i \leq N) $ 都成立。
  - $ b_1 + \dots + b_N = c_1 + \dots + c_N $。
  - $ b_1 + \dots + b_N \geq 1 $。

## 输出格式

输出一行，表示可能的最小运输成本。确保输出行末有换行符。

## 说明/提示

### 部分评分

该题目有部分评分。根据不同的数据集限制，可以得到不同的分数：

- 约束 $ N \leq 5,000 $ 且 $ b_1 + \dots + b_N \leq 5,000 $ 的数据集 1，正确解答可得到 15 分。
- 约束 $ N \leq 5,000 $ 的数据集 2，正确解答可得到额外 30 分。
- 无额外限制的数据集 3，正确解答可得到额外 55 分，总计 100 分。

### 样例解释 1

考虑以下移动方案：
- 城市 $ 3 $ 的一名参赛者逆时针移动到城市 $ 1 $。移动成本为 $ 4 \times 1 = 4 $。
- 城市 $ 6 $ 的一名参赛者逆时针移动到城市 $ 4 $。移动成本为 $ 2 \times 1 = 2 $。
- 城市 $ 7 $ 的两名参赛者顺时针移动到城市 $ 1 $。移动成本为 $ 3 \times 2 = 6 $。

最终，所有有会场的城市，其参赛者人数与容纳能力一致，并且所有参赛者都能到达某个会场。总移动成本为 $ 4 + 2 + 6 = 12 $，这就是最小值。

 **本翻译由 AI 自动生成**

## 样例 #1

### 输入

```
7 30

0 3 6

1 2 2

4 5 4

19 0 1

20 4 4

21 1 0

27 3 1
```

### 输出

```
12
```

## 样例 #2

### 输入

```
6 25

0 10 1

3 0 1

9 0 2

12 0 3

13 0 2

21 0 1
```

### 输出

```
85
```



---

---
title: "花火"
layout: "post"
diff: 省选/NOI-
pid: AT_dwango2016qual_e
tag: []
---

# 花火

## 题目描述

## 0.前言

前来贡献翻译（改了题目主人公，管理如果不喜那就改回来吧）……

LSY最可爱，逃:)。

---

## 【题目背景】

烟花升起而后绽放犹如浮生沉浮，一个人孤寂地徘徊……

所以可爱的LSY很喜欢看烟花。（然而貌似没什么关联）

---


现在LSY在烟花长廊的起点，起点位置为$0$，终点位置为$L$。烟花长廊内总共有$n$束烟花要发射，其中第$i$束烟花要在$t[i]$时在$p[i]$发射。由于LSY十分喜欢烟花，所以LSY在烟花长廊中有非凡的速度使得LSY在$1$秒钟内可以前进任意距离（前进的长度不能为负数但是可以为$0$）。因为LSY视力不是很好，所以某一束烟花在绽放时离她越远的话她的不满值会升高，具体计算方法如下：

如果$t$时刻有一束烟花在$Pf$位置绽放并且LSY在$Pl$位置，那么LSY的不满值会上升$|Pf-Pl|$。

举个栗子：在1时刻，LSY在位置3，有一束烟花在位置4绽放，那么LSY的不满值将会上升1。

现在LSY找到了你，希望你能设计出一个程序使得她看完所有烟花后不满值最小。

---

## 输入格式

第一行两个数$n$，$L$。

接下来有$n$行

第$i$行将会有两个数$t$和$p$表示$t$时刻将会有一束烟花在$p$位置发射。

输入数据保证$t[i]≤t[i+1]$并且如果$t[i]=t[i+1]$那么保证$p[i]≤p[i+1]$。

注意，我们没有理由相信在相同时间相同位置只会发射一束烟花。

---

## 输出格式

一行一个数，表示最小的不满值。

---

## 【样例输入 1】

```
5 10
1 2
1 4
3 8
4 7
5 1
```

## 【样例输出 1】

```
9
```

---

## 【样例输入 2】

```
4 10
1 4
1 4
2 1
3 9
```

---

## 【样例输出 2】

```
3
```

---

## 【样例输入 3】

```
10 20
2 15
3 4
3 14
4 11
6 0
7 7
8 8
8 8
8 12
9 10
```

---

## 【样例输出 3】

```
33
```

---

## 【样例解释】

**输入样例 1**：

烟花长廊的长度为$10$，一共有$5$束烟花分别在时间$1$，$1$，$3$，$4$，$5$时在位置$2$，$4$，$8$，$7$，$1$发射。

**输出样例 1**：

在时间$1$时LSY可以移动到位置$3$，这是LSY的不满度将上升$2$，在时间$3$时LSY可以移动到位置$7$，这时LSY的不满度将会上升$1$，第$4$秒时LSY选择不移动，LSY的不满值不会上升，第$5$秒时，LSY的不满值将会上升$6$，最后LSY的总不满值为$9$，第$6$秒时LSY移动至位置$10$，输出$9$，可以证明$9$是最小值。

**输入样例 2**：

有两束烟花在第$1$秒时将同时在位置$4$绽放。

---

感谢@_YPC 提供的翻译

## 样例 #1

### 输入

```
5 10

1 2

1 4

3 8

4 7

5 1
```

### 输出

```
9
```

## 样例 #2

### 输入

```
4 10

1 4

1 4

2 1

3 9
```

### 输出

```
3
```

## 样例 #3

### 输入

```
10 20

2 15

3 4

3 14

4 11

6 0

7 7

8 8

8 8

8 12

9 10
```

### 输出

```
33
```



---

---
title: "Manga Market"
layout: "post"
diff: 省选/NOI-
pid: AT_hitachi2020_d
tag: []
---

# Manga Market

## 题目描述

[problemUrl]: https://atcoder.jp/contests/hitachi2020/tasks/hitachi2020_d

$ N $ 個の店があり、それぞれ店 $ 1 $、 店 $ 2 $ 、 $ \cdots $ 、店 $ N $ という名前が付けられています。高橋君は時刻 $ 0 $ に自宅にいて、これからいくつかの店を訪れる予定です。

高橋君が自宅から各店へ移動する際及び任意の $ 2 $ つの店の間を移動する際に要する時間は $ 1 $ 単位時間です。

高橋君が時刻 $ t $ に店 $ i $ に着いたとき、その店の列に並び、 $ a_i\ \times\ t\ +\ b_i $ 単位時間待つことにより、その店で買い物をすることが出来ます。(待ち時間以外の時間はかからないとします。)

全ての店の閉店時刻は $ T\ +\ 0.5 $ です。ある店で列に並んでいる途中に閉店時刻を迎えた場合、その店で買い物をすることは出来ません。

高橋君は同じ店で $ 2 $ 回以上買い物をしません。

高橋君が閉店時刻までに買い物を出来る店の数の最大値を答えてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ T $ $ a_1 $ $ b_1 $ $ a_2 $ $ b_2 $ $ \vdots $ $ a_N $ $ b_N $

## 输出格式

答えを出力せよ。

## 说明/提示

### 制約

- 入力は全て整数
- $ 1\ \leq\ N\ \leq\ 2\ \times\ 10^5 $
- $ 0\ \leq\ a_i\ \leq\ 10^9 $
- $ 0\ \leq\ b_i\ \leq\ 10^9 $
- $ 0\ \leq\ T\ \leq\ 10^9 $

### Sample Explanation 1

店の回り方の例を $ 1 $ つ示します。 - 時刻 $ 0 $ から時刻 $ 1 $ : 自宅から店 $ 1 $ へ $ 1 $ 単位時間掛けて移動します。 - 時刻 $ 1 $ から時刻 $ 3 $ : 店 $ 1 $ で $ 2 $ 単位時間待ち、買い物をします。 - 時刻 $ 3 $ から時刻 $ 4 $ : 店 $ 1 $ から店 $ 3 $ へ $ 1 $ 単位時間掛けて移動します。 - 時刻 $ 4 $ から時刻 $ 7 $ : 店 $ 3 $ で $ 3 $ 単位時間待ち、買い物をします。 以上の回り方では、時刻 $ 7.5 $ までに $ 2 $ 箇所の店で買い物を行うことが出来ます。

## 样例 #1

### 输入

```
3 7

2 0

3 2

0 3
```

### 输出

```
2
```

## 样例 #2

### 输入

```
1 3

0 3
```

### 输出

```
0
```

## 样例 #3

### 输入

```
5 21600

2 14

3 22

1 3

1 10

1 9
```

### 输出

```
5
```

## 样例 #4

### 输入

```
7 57

0 25

3 10

2 4

5 15

3 22

2 14

1 15
```

### 输出

```
3
```



---

---
title: "Odd Sum Rectangles"
layout: "post"
diff: 省选/NOI-
pid: AT_hitachi2020_e
tag: []
---

# Odd Sum Rectangles

## 题目描述

[problemUrl]: https://atcoder.jp/contests/hitachi2020/tasks/hitachi2020_e

$ (2^N\ -\ 1) $ 行 $ (2^M-1) $ 列のグリッドがあり、 あなたはこれからすべてのマスに $ 0,\ 1 $ のいずれかの数字を書き込みます。 上から $ i $ 行目、左から $ j $ 列目に書き込む数字を $ a_{i,j} $ とします。

$ 1\leq\ i_1\ \leq\ i_2\leq\ 2^N-1,\ 1\leq\ j_1\ \leq\ j_2\leq\ 2^M-1 $ をみたす整数の組 $ (i_1,\ i_2,\ j_1,\ j_2) $ に対し、 $ S(i_1,\ i_2,\ j_1,\ j_2)\ =\ \displaystyle\ \sum_{r=i_1}^{i_2}\sum_{c=j_1}^{j_2}a_{r,c} $ と定義し、 さらに、グリッドの「奇妙さ」を $ S(i_1,\ i_2,\ j_1,\ j_2) $ が奇数となるような $ (i_1,\ i_2,\ j_1,\ j_2) $ の個数 と定義します。

奇妙さが最大となるような数字の書き込み方を $ 1 $ つ求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ M $

## 输出格式

奇妙さが最大となる書き込み方の $ 1 $ つを、以下の形式で出力せよ。

> $ a_{1,1}a_{1,2}\cdots\ a_{1,2^M-1} $ $ a_{2,1}a_{2,2}\cdots\ a_{2,2^M-1} $ $ \vdots $ $ a_{2^N-1,1}a_{2^N-1,2}\cdots\ a_{2^N-1,2^M-1} $

## 说明/提示

### 制約

- $ N,\ M $ は $ 1 $ 以上 $ 10 $ 以下の整数

### Sample Explanation 1

$ S(1,\ 1,\ 1,\ 1) $、$ S(1,\ 1,\ 2,\ 2) $、$ S(1,\ 1,\ 3,\ 3) $、$ S(1,\ 1,\ 1,\ 3) $ が奇数となるため、このグリッドの奇妙さは $ 4 $ です。 奇妙さを $ 5 $ 以上にすることはできないため、これは奇妙さが最大となる書き込み方の $ 1 $ つです。

## 样例 #1

### 输入

```
1 2
```

### 输出

```
111
```



---

---
title: "Almost Same Substring"
layout: "post"
diff: 省选/NOI-
pid: AT_icpc2013summer_day3_h
tag: []
---

# Almost Same Substring

## 题目描述

[problemUrl]: https://atcoder.jp/contests/jag2013summer-day3/tasks/icpc2013summer_day3_h





---

---
title: "A + B"
layout: "post"
diff: 省选/NOI-
pid: AT_icpc2013summer_day3_j
tag: []
---

# A + B

## 题目描述

在编程比赛的集训中没有出现问题的想法而感到为难的甲，某一天和朋友商量了。



A: “如果不使用这种算法的话，我想提出一个无法解决的问题，怎么做~？”



朋友：“这种东西想想不就出来了吗？”（真NB）



就这样，那个朋友考虑了以下问题的草案。



给你两个二进制数A,B，做如下变换：



操作1：输出在二进制下1的个数最大的X;A<=X<=A+B;



操作2：将A从开始最下位翻转i位；



操作3：将B从开始最下位翻转i位；



注：i是从最下位到第0位表示最下位

## 输入格式

2~N+1行

Q表示查询，就是操作1；

A  i 表示操作2；

B  i 表示操作3；



---

---
title: "Reverse a Road II"
layout: "post"
diff: 省选/NOI-
pid: AT_icpc2014autumn_f
tag: []
---

# Reverse a Road II

## 题目描述

反转道路2

某个陌生的国度JAG中有N座城市，城市之间用M条单向道路连接。N座城市的编号为1~N。在这个王国里面，每一天ICPC（某国际特色产品的公司）将其产品从市S中的工厂到城市T的仓库。为了提高效率，每一次运输会使用多个卡车。一辆卡车通过单向道路网络从 s通过一些城市（直接或间接）到达T。为了减少交通拥堵以及发生交通事故的风险，没有卡车会走同样的路。

现在，ICPC想提高日常运输的效率，它想在在上面的条件的约束下派出尽可能多的卡车。JAG国，这个财政状况受ICPC影响的国家，认为改变为单向道路的方向可以使ICPC每天派出的卡车数量增加。但因为逆转太多道路会造成混乱，JAG国决定只反转一条单向道路。

如果没有路反转后使运输效率提高，JAG国可以不反转任何道路。你需要检查反转一条道路是否可以提高每天派出卡车的数量。如果是这样的话，计算ICPC公司最多能派出多少辆卡车，以及为了达到这个最大值有多少种方案。

## 输入格式

有多组输入，组数小于等于100。

第1行有四个整数N,M,S,T（2≤N≤1000，1≤M≤10000，1≤S，T≤N，S≠T），意思如题。

接下来M行，每行两个整数ai,bi（1≤ai，bi，≤N，a1≠bi）表示有一条道路从ai到bi。

输出以四个0结尾。

## 输出格式

对于每组数据，输出两个被空格隔开的整数：如果改变多条单向道路的方向能增大每日卡车的派出量，则第一个整数为反转道路后的最大派出量，第二个整数为方案数。若没有，则第一个整数为当前的最大派出量，第二个整数为0。

样例输入：
```
4 4 1 4
1 2
3 1
4 2
3 4
7 8 1 7
1 2
1 3
2 4
3 4
4 5
4 6
5 7
7 6
6 4 5 2
1 2
1 3
4 5
5 6
10 21 9 10
9 1
9 2
9 3
9 4
10 1
10 2
10 3
10 4
1 5
2 5
2 6
3 6
3 7
4 7
4 8
1 8
5 10
6 10
7 10
10 8
10 9
2 15 1 2
1 2
1 2
1 2
1 2
1 2
1 2
1 2
1 2
1 2
1 2
1 2
1 2
1 2
1 2
1 2
0 0 0 0
```

样例输出：
```
1 2
2 1
0 0
4 6
15 0
```

感谢@zhenglier 提供的翻译



---

---
title: "Balanced Paths"
layout: "post"
diff: 省选/NOI-
pid: AT_icpc2015spring_a
tag: []
---

# Balanced Paths

## 题目描述

[problemUrl]: https://atcoder.jp/contests/jag2015spring/tasks/icpc2015spring_a





---

---
title: "...好きです"
layout: "post"
diff: 省选/NOI-
pid: AT_iroha2019_day4_l
tag: []
---

# ...好きです

## 题目描述

在いろは界，有个著名的故事：いろはちゃん在数直线上放置或移除大量硬币。

起初，数轴上没有任何硬币。いろはちゃん会进行 $Q$ 次操作。操作共有三种类型：

- **添加硬币**：在坐标 $x$ 处放置一个面值为 $v$ 的硬币。保证此时该位置没有其他硬币。
- **移除硬币**：将坐标 $x$ 处的硬币移除。保证此时该位置有硬币。
- **取硬币**：将ひらきち君放置在坐标 $x$，并让他取走一个硬币。ひらきち君会选择“效率”最高的硬币。“效率”定义为 $\frac{w}{|c-x|}$，其中 $w$ 是硬币的面值，$c$ 是硬币的坐标。

例如，若坐标 $2$ 有一个面值为 $3$ 的硬币，坐标 $5$ 有一个面值为 $8$ 的硬币，不同情况下“效率”最高值为：

- ひらきち君若在坐标 $0$，会取走坐标 $5$ 的硬币，“效率”是 $1.6$。
- 若在坐标 $1$，会取走坐标 $2$ 的硬币，“效率”是 $3.0$。
- 若在坐标 $7$，会取走坐标 $5$ 的硬币，“效率”是 $4.0$。

**注意，虽然ひらきち君取走硬币，但此硬币随后会被还原，故同一硬币可被多次取走。**

对于每次“取硬币”操作，请输出ひらきち君能获取的最高“效率”值。若此时数轴上没有硬币则输出 $0$。

## 输入格式

从标准输入读入共 $Q + 1$ 行数据。

- 若是“添加硬币”，行格式是：$1$ $x$ $v$
- 若是“移除硬币”，行格式是：$2$ $x$
- 若是“取硬币”，行格式是：$3$ $x$

## 输出格式

对于每次“取硬币”操作，输出ひらきち君能获得的最高“效率”值。  
允许绝对或相对误差最多为 $10^{-5}$。

## 说明/提示

- 所有输入均为整数
- $1 \leq Q \leq 3 \times 10^5$
- $0 \leq x \leq 10^9$
- $0 \leq v \leq 10^9$
- 每次“添加硬币”时，该位置无其他硬币
- 每次“移除硬币”时，该位置有硬币
- 每次“取硬币”时，该位置无硬币

### 部分得分

- 通过所有满足 $Q \leq 120000$ 的测试用例可得 $1100$ 分。
- 通过所有测试用例，还可额外得 $300$ 分。

### 参考
[题目解析](https://img.atcoder.jp/iroha2019-day4/editorial-L.pdf)

 **本翻译由 AI 自动生成**

## 样例 #1

### 输入

```
11

1 2 3

3 10

1 5 8

3 0

3 1

3 7

2 2

1 7 9

3 3

3 6

3 10
```

### 输出

```
0.375000000000

1.600000000000

3.000000000000

4.000000000000

4.000000000000

9.000000000000

3.000000000000
```

## 样例 #2

### 输入

```
10

1 0 10

3 1

3 2

3 3

3 4

3 5

3 6

3 7

3 8

3 9
```

### 输出

```
10.000000000000

5.000000000000

3.333333333333

2.500000000000

2.000000000000

1.666666666667

1.428571428571

1.250000000000

1.111111111111
```



---

---
title: "ADD DIV MAX RESTORE"
layout: "post"
diff: 省选/NOI-
pid: AT_jag2018summer_day2_i
tag: []
---

# ADD DIV MAX RESTORE

## 题目描述

[problemUrl]: https://atcoder.jp/contests/jag2018summer-day2/tasks/jag2018summer_day2_i

You are given an integer sequence $ a_0,\ a_1,\ ...,\ a_{N-1} $.

You have to perform $ Q $ queries, each query is one of the following:

- `ADD QUERY(t=0 l r x)` : for each $ i $ between $ l $ and $ r $, inclusive, replace $ a_i $ with $ a_i\ +\ x $.
- `DIV QUERY(t=1 l r x)` : for each $ i $ between $ l $ and $ r $, inclusive, replace $ a_i $ with $ {\rm\ floor}(a_i\ /\ x) $, where $ {\rm\ floor}(y) $ is the biggest integer that is not greater than $ y $.
- `MAX QUERY(t=2 l r x=0)` : print $ {\rm\ max}(a_l,\ a_{l+1},\ ...,\ a_r) $.
- `RESTORE QUERY(t=3 l r x=0)` : for each $ i $ between $ l $ and $ r $, inclusive, set $ a_i $ to the initial value of $ a_i $, that is, the value given in the input.

## 输入格式

Input is given from Standard Input in the following format:

> $ N $ $ Q $ $ a_0 $ $ a_1 $ ... $ a_{N-1} $ $ t_1 $ $ l_1 $ $ r_1 $ $ x_1 $ $ t_2 $ $ l_2 $ $ r_2 $ $ x_2 $ : $ t_Q $ $ l_Q $ $ r_Q $ $ x_Q $

## 输出格式

For each `MAX QUERY`, print $ {\rm\ max}(a_l,\ a_{l+1},\ ...,\ a_r) $, one per line.

## 说明/提示

### Constraints

- All input values are integers.
- $ 1\ \leq\ N,\ Q\ \leq\ 200,000 $
- $ 0\ \leq\ a_i\ \leq\ 10^8 $
- $ t_i\ =\ 0,\ 1,\ 2,\ 3 $
- $ 0\ \leq\ l_i\ \leq\ r_i\ \leq\ N-1 $
- $ 1\ \leq\ x_i\ \leq\ 1000 $(when $ t_i\ \neq\ 2,\ 3 $)

### Sample Explanation 1

\- $ {\rm\ max}(1,\ 2,\ 3,\ 4,\ 5)\ =\ 5 $ - $ 1,\ 2,\ 3,\ 4,\ 5\ →\ 11,\ 12,\ 3,\ 4,\ 5 $ - $ {\rm\ max}(11,\ 12,\ 3,\ 4,\ 5)\ =\ 12 $ - $ {\rm\ max}(3)\ =\ 3 $ - $ 11,\ 12,\ 3,\ 4,\ 5\ →\ 2,\ 3,\ 3,\ 4,\ 5 $ - $ {\rm\ max}(2)\ =\ 2 $ - $ {\rm\ max}(3)\ =\ 3 $ - The array is restored to $ 1,\ 2,\ 3,\ 4,\ 5 $ - $ {\rm\ max}(1,\ 2)\ =\ 2 $

## 样例 #1

### 输入

```
5 9

1 2 3 4 5

2 0 4 0

0 0 1 10

2 0 4 0

2 2 2 0

1 0 1 4

2 0 0 0

2 1 1 0

3 0 4 0

2 0 1 0
```

### 输出

```
5

12

3

2

3

2
```

## 样例 #2

### 输入

```
4 7

0 1 0 1

2 0 3 0

0 0 3 1

1 0 3 2

2 0 3 0

0 0 3 1

1 0 3 2

2 0 3 0
```

### 输出

```
1

1

1
```

## 样例 #3

### 输入

```
10 23

13 1 22 8 28 18 23 9 22 27

1 3 4 5

1 8 8 8

0 3 9 5

0 2 6 3

3 0 4 0

1 1 3 7

2 2 2 0

2 3 5 0

0 1 4 2

3 0 9 0

2 0 1 0

0 3 9 8

2 1 9 0

0 8 9 5

1 5 7 7

0 3 5 7

0 7 9 7

3 3 6 0

2 1 6 0

0 1 1 7

1 4 8 10

2 0 9 0

1 5 6 1
```

### 输出

```
3

28

13

36

28

47
```



---

---
title: "バブルソート (Bubble Sort)"
layout: "post"
diff: 省选/NOI-
pid: AT_joi2013ho5
tag: []
---

# バブルソート (Bubble Sort)

## 题目描述

[problemUrl]: https://atcoder.jp/contests/joi2013ho/tasks/joi2013ho5

バブルソートとは，列をソートするアルゴリズムの $ 1 $ つである．長さ $ N $ の数列 $ A $ を昇順にソートしたいとしよう．バブルソートは，隣り合う $ 2 $ つの数で大小関係が崩れているものがあれば，それらの位置を交換する．これを，数列を前から順に走査しながら行う．すなわち，$ A_i\ >\ A_{i\ +\ 1} $ となっている場所があれば，その $ 2 $ 数を交換するということを，$ i\ =\ 1,\ 2,\ \ldots,\ N\ -\ 1 $ に対してこの順で行うのが $ 1 $ 回の走査である．この走査を $ N\ −\ 1 $ 回繰り返すことで，数列を昇順にソートできることが知られている．

数列 $ A $ のバブルソートによる交換回数とは，数列 $ A $ に上記のアルゴリズムを適用した時に，整数の交換が行われる回数である．（バブルソートとして知られるアルゴリズム及び実装には，ループの順番や範囲，及び終了条件など，細かな差異がある場合がある．ただし，同じ数列に適用した際の整数の交換回数はそれらの差異により変化しないことが知られている．）

例えば，以下のプログラムは長さ `n` の整数の配列 `a` をバブルソートによりソートする関数を C 言語で記述したものである．

```cpp
void bubble_sort(int *a, int n) {
  int i, j;
  for (i = 0; i < n - 1; ++i) {
    for (j = 0; j < n - 1; ++j) {
      if (a[j] > a[j + 1]) {
        /* 以下 3 行が 1 回の整数の交換に相当 */
        int x = a[j];
        a[j] = a[j + 1];
        a[j + 1] = x;
      }
    }
  }
}

```

## 输入格式

標準入力から以下のデータを読み込め．

- $ 1 $ 行目には，整数 $ N $ が書かれている．$ N $ は数列 $ A $ の長さを表す．
- 続く $ N $ 行のうちの $ i $ 行目 ($ 1\ \leqq\ i\ \leqq\ N $) には，整数 $ A_i $ が書かれている．これは数列 $ A $ の $ i $ 番目の整数を表す．

## 输出格式

標準出力に，数列 $ A' $ のバブルソートによる交換回数の最小値を表す整数を $ 1 $ 行で出力せよ．

## 说明/提示

### 課題

長さ $ N $ の数列 $ A $ が与えられる．数列 $ A $ の任意の場所の $ 2 $ つの整数を $ 1 $ 回だけ交換した数列 $ A' $ を作るとする．数列 $ A' $ のバブルソートによる交換回数の最小値を求めるプログラムを作成せよ．（最初に交換する $ 2 $ つの整数は必ずしも隣り合っている必要はないことに注意せよ．）

### 制限

$ 2\ \leqq\ N\ \leqq\ 100\,000 $ 数列 $ A $ の長さ$ 1\ \leqq\ A_i\ \leqq\ 1\,000\,000\,000 $ 数列 $ A $ に含まれる数字の大きさ（注）過去問移植時に制約を修正．

- - - - - -

### 採点基準

採点用データのうち，配点の $ 10 $ %分については，$ N\ \leqq\ 1\ 000 $ を満たし，任意の $ i,\ j $ ($ 1\ \leqq\ i\ <\ j\ \leqq\ N $) について $ A_i\ \neq\ A_j $ を満たす．

採点用データのうち，配点の $ 30 $ %分については，$ N\ \leqq\ 5\,000 $ を満たし，任意の $ i,\ j $ ($ 1\ \leqq\ i\ <\ j\ \leqq\ N $) について $ A_i\ \neq\ A_j $ を満たす．

採点用データのうち，配点の $ 80 $ %分については，任意の $ i,\ j $ ($ 1\ \leqq\ i\ <\ j\ \leqq\ N $) について $ A_i\ \neq\ A_j $ を満たす．

- - - - - -

### Sample Explanation 1

数列 $ A $ の最初の $ 10 $ と最後の $ 1 $ を交換することにすると，数列 $ A' $ はソート済みの列となり，バブルソートの交換回数は $ 0 $ となる． - - - - - -

### Sample Explanation 2

数列 $ A $ の $ 3 $ 番目の $ 7 $ と最後の $ 5 $ を交換することで，数列 $ A' $ は $ 3,\ 1,\ 5,\ 9,\ 7 $ となる．$ A' $ のバブルソートによる交換回数は $ 2 $ である． - - - - - -

### Sample Explanation 3

最初から数列 $ A $ がソートされている場合でも，数列 $ A' $ を作る際に交換を行わなければならない．

## 样例 #1

### 输入

```
5
10
3
6
8
1
```

### 输出

```
0
```

## 样例 #2

### 输入

```
5
3
1
7
9
5
```

### 输出

```
2
```

## 样例 #3

### 输入

```
3
1
2
3
```

### 输出

```
1
```



---

---
title: "切り取り線  (Cutting)"
layout: "post"
diff: 省选/NOI-
pid: AT_joi2014ho5
tag: []
---

# 切り取り線  (Cutting)

## 题目描述

[problemUrl]: https://atcoder.jp/contests/joi2014ho/tasks/joi2014ho5

JOI 君はペーパークラフトが趣味である．今日も JOI 君はペーパークラフトの作品を作ろうとしている．

まず，JOI 君は設計図にしたがって $ 1 $ 枚の長方形の紙に $ N $ 本の切り取り線を印刷した．各切り取り線は，紙の縦または横の辺に平行な線分である．紙を切り出してできるすべての部分は作品の中で何らかの部品として用いられる．当然のことながら，部品数の多い作品は製作が大変である．JOI 君は，すべての切り取り線にしたがって紙を切り出したとき，紙がいくつの部分に分かれるかを知りたい．

## 输入格式

標準入力から以下のデータを読み込め．

- $ 1 $ 行目には，整数 $ W,\ H,\ N $ が空白を区切りとして書かれている．$ W $ は紙の横の辺の長さを，$ H $ は紙の縦の辺の長さを，$ N $ は切り取り線の本数をそれぞれ表す．紙の左下，右下，左上，右上を，それぞれ座標 $ (0,\ 0),\ (W,\ 0),\ (0,\ H),\ (W,\ H) $ で表す．
- 続く $ N $ 行のうちの $ i $ 行目 ($ 1\ \leqq\ i\ \leqq\ N $) には，整数 $ A_i,\ B_i,\ C_i,\ D_i $ ($ 0\ \leqq\ A_i\ \leqq\ C_i\ \leqq\ W $，$ 0\ \leqq\ B_i\ \leqq\ D_i\ \leqq\ H $) が空白を区切りとして書かれている．これは $ i $ 番目の切り取り線が $ (A_i,\ B_i) $ と $ (C_i,\ D_i) $ を結ぶ線分であることを表す．この線分は紙のいずれかの辺に平行な線分である．すなわち，$ A_i\ =\ C_i $ と $ B_i\ =\ D_i $ のうちのちょうど $ 1 $ つが成り立つ．また，ある切り取り線と，それに平行な他の切り取り線が共有点を持つことはなく，ある切り取り線と，それに平行な紙の辺が共有点を持つこともない．

## 输出格式

標準出力に，紙がいくつの部分に分かれるかを表す整数を $ 1 $ 行で出力せよ．

- - - - - -

## 说明/提示

### 課題

紙の大きさと，$ N $ 本の切り取り線の情報が与えられる．これらの切り取り線にしたがって紙を切り分けたとき，紙がいくつの部分に分かれるかを求めるプログラムを作成せよ．

- - - - - -

### 制限

すべての入力データは以下の条件を満たす．

- $ 1\ \leqq\ W\ \leqq\ 1\,000\,000\,000 $．
- $ 1\ \leqq\ H\ \leqq\ 1\,000\,000\,000 $．
- $ 1\ \leqq\ N\ \leqq\ 100\,000 $．

### 小課題

#### 小課題 1 \[5 点\]

以下の条件を満たす．

- $ W\ \leqq\ 1\,000 $．
- $ H\ \leqq\ 1\,000 $．
- $ N\ \leqq\ 1\,000 $．

#### 小課題 2 \[5 点\]

以下の条件を満たす．

- $ N\ \leqq\ 1\,000 $．

#### 小課題 3 \[20 点\]

共有点を持つような異なる $ 2 $ つの切り取り線の組の個数は，$ 100\,000 $ 以下である．

#### 小課題 4 \[20 点\]

切り取り線上の任意の点から紙のある辺上の点まで，いくつかの切り取り線をたどって行くことができる．

#### 小課題 5 \[50 点\]

追加の制限はない．

- - - - - -

### Sample Explanation 1

この入力の場合，切り取り線は下図のようになる． !\[2014-ho-t5-fig01.png\](https://img.atcoder.jp/joi2014ho/2014-ho-t5-fig01.png) よって，切り取り線によって紙は $ 4 $ つの部分に分かれる．なお，この入力は小課題 $ 4 $ の条件を満たしている． - - - - - -

### Sample Explanation 2

この入力の場合，切り取り線は下図のようになる． !\[2014-ho-t5-fig02.png\](https://img.atcoder.jp/joi2014ho/2014-ho-t5-fig02.png) よって，切り取り線によって紙は $ 5 $ つの部分に分かれる．なお，この入力は小課題 $ 4 $ の条件を満たしていない．

## 样例 #1

### 输入

```
10 10 5
6 0 6 7
0 6 7 6
2 3 9 3
2 3 2 10
1 9 8 9
```

### 输出

```
4
```

## 样例 #2

### 输入

```
13 7 28
1 1 4 1
1 1 1 3
2 2 3 2
2 2 2 3
1 3 2 3
3 2 3 6
4 1 4 6
3 6 4 6
5 1 8 1
5 1 5 6
6 2 7 2
6 2 6 5
7 2 7 5
6 5 7 5
8 1 8 6
5 6 8 6
9 1 12 1
9 1 9 2
9 2 10 2
12 1 12 2
11 2 12 2
10 2 10 5
9 5 10 5
9 5 9 6
11 2 11 5
11 5 12 5
12 5 12 6
9 6 12 6
```

### 输出

```
5
```



---

---
title: "舞踏会 (Ball)"
layout: "post"
diff: 省选/NOI-
pid: AT_joi2015ho_d
tag: []
---

# 舞踏会 (Ball)

## 题目描述

[problemUrl]: https://atcoder.jp/contests/joi2015ho/tasks/joi2015ho_d

IOI 王国では，王女である JOI 姫の誕生日を祝って舞踏会が開かれることになった．

舞踏会には $ N $ 人の貴族が参加する予定である．$ N $ は奇数である．貴族には $ 1 $ から $ N $ までの番号が付けられている．それぞれの貴族には踊りのうまさという整数が定められており，貴族 $ i $ ($ 1\ \leqq\ i\ \leqq\ N $) の踊りのうまさは $ D_i $ である．

舞踏会では JOI 姫を含む $ N\ +\ 1 $ 人で $ 2 $ 人ずつ組を作って踊る．IOI 王国では，上級者が初級者を補助できるように，伝統的に以下の方法で踊りの組を決定している．

- 最初に，$ N $ 人の貴族が $ 1 $ 列に並ぶ．
- 列に並んでいる貴族が $ 1 $ 人になるまで，以下の操作を繰り返す．
  - 列の先頭から $ 3 $ 人の貴族の踊りのうまさを調べる．
  - その $ 3 $ 人の貴族の中で，最も踊りのうまさが大きい貴族を $ A $ とおく．ただし，複数いる場合は，最も踊りのうまさが大きい貴族の中で，最も番号の小さい貴族 を $ A $ とおく．
  - その $ 3 $ 人の貴族の中で，最も踊りのうまさが小さい貴族を $ B $ とおく．ただし，複数いる場合は，最も踊りのうまさが小さい貴族の中で，最も番号の大きい貴族 を $ B $ とおく．
  - $ A $ と $ B $ が列から抜けて組になる．
  - 残った $ 1 $ 人は列の最後尾に移動する．
- 最終的に残った $ 1 $ 人が JOI 姫と組になる．貴族 $ 1 $ から貴族 $ M $ ($ 1\ \leqq\ M\ \leqq\ N\ -\ 2 $) の $ M $ 人の貴族については，すでに初期状態で列の何番目に並ぶのかが決まっている．残りの $ N\ -\ M $ 人の貴族の並び方は国王が自由に決めることができる．

JOI 姫は踊りを学んだばかりなので，国王は JOI 姫と組になる貴族の踊りのうまさをできるだけ大きくしたいと考えている．JOI 姫と組になる貴族の踊りのうまさとして考えられる最大値を求めよ．

## 输入格式

標準入力から以下のデータを読み込め．

- $ 1 $ 行目には，$ 2 $ 個の整数 $ N,\ M $ が空白を区切りとして書かれている．これは舞踏会に貴族が $ N $ 人参加し，列に並ぶ場所がすでに決まっている貴族が $ M $ 人いることを表す．
- 続く $ M $ 行のうちの $ i $ 行目 ($ 1\ \leqq\ i\ \leqq\ M $) には，$ 2 $ 個の整数 $ D_i,\ P_i $ が空白を区切りとして書かれている．これは貴族 $ i $ の踊りのうまさが $ D_i $ で，貴族 $ i $ が初期状態で列の先頭から $ P_i $ 番目に並ぶことを表す．
- 続く $ N\ -\ M $ 行のうちの $ i $ 行目 ($ 1\ \leqq\ i\ \leqq\ N\ -\ M $) には，整数 $ D_{i\ +\ M} $ が書かれている．これは貴族 ($ i\ +\ M $) の踊りのうまさが $ D_{i\ +\ M} $ であることを表す．

## 输出格式

標準出力に，JOI 姫と組になる貴族の踊りのうまさとして考えられる最大値を表す整数を $ 1 $ 行で出力せよ．

- - - - - -

## 说明/提示

### 課題

それぞれの貴族の踊りのうまさと，$ M $ 人の貴族の初期状態で並ぶ場所が与えられたとき，JOI 姫と組になる貴族の踊りのうまさとして考えられる最大値を求めるプログラムを作成せよ．

- - - - - -

### 制限

すべての入力データは以下の条件を満たす．

- $ 3\ \leqq\ N\ \leqq\ 99\,999 $．
- $ N $ は奇数である．
- $ 1\ \leqq\ M\ \leqq\ N\ -\ 2 $．
- $ 1\ \leqq\ D_i\ \leqq\ 1\,000\,000\,000 $ ($ 1\ \leqq\ i\ \leqq\ N $)．
- $ 1\ \leqq\ P_i\ \leqq\ N $ ($ 1\ \leqq\ i\ \leqq\ M $)．
- $ P_i\ \neq\ P_j $ ($ 1\ \leqq\ i\ <\ j\ \leqq\ M $)．

### 小課題

#### 小課題 1 \[8 点\]

- $ N\ \leqq\ 9 $ を満たす．

#### 小課題 2 \[16 点\]

- $ N\ \leqq\ 19 $ を満たす．

#### 小課題 3 \[44 点\]

- $ N\ \leqq\ 1\,999 $ を満たす．

#### 小課題 4 \[32 点\]

追加の制限はない．

- - - - - -

### Sample Explanation 1

初期状態では $ 3 $ 人の貴族の並ぶ場所がすでに決まっている． !\[\](https://img.atcoder.jp/joi2015ho/d-1.png)括弧内の数字は踊りのうまさを表す．左端が列の先頭である． 例えば，先頭から順に貴族 $ 5 $，貴族 $ 1 $，貴族 $ 4 $，貴族 $ 6 $，貴族 $ 2 $，貴族 $ 3 $，貴族 $ 7 $ という順番に並んだ場合を考える． !\[\](https://img.atcoder.jp/joi2015ho/d-2.png)すべての貴族が並んだあとの配置 この場合，以下のように列が変化していく． - 列の先頭の $ 3 $ 人の貴族 (貴族 $ 5 $，貴族 $ 1 $，貴族 $ 4 $) 中で，最も踊りのうまさが大きい貴族 $ 4 $ と最も踊りのうまさが小さい貴族 $ 5 $ が組になり，残った貴族 $ 1 $ が最後尾に移動する． - 次に，列の先頭の $ 3 $ 人の貴族 (貴族 $ 6 $，貴族 $ 2 $，貴族 $ 3 $) の中で，最も踊りのうまさが大きい貴族は貴族 $ 6 $ と貴族 $ 3 $ の $ 2 $ 人であり，このうち番号の小さい貴族は貴族 $ 3 $ である．また，列の先頭の $ 3 $ 人の貴族のうち最も踊りのうまさが小さい貴族は貴族 $ 2 $ である．貴族 $ 3 $ と貴族 $ 2 $ が組になり，残った貴族 $ 6 $ が最後尾に移動する． - 次に，列の先頭の $ 3 $ 人の貴族 (貴族 $ 7 $，貴族 $ 1 $，貴族 $ 6 $) の中で，最も踊りのうまさが大きい貴族 $ 7 $ と最も踊りのうまさが小さい貴族 $ 1 $ が組になり，残った貴族 $ 6 $ が最後尾に移動する． - 最終的に貴族 $ 6 $ が残り，JOI 姫と組になる．貴族 $ 6 $ の踊りのうまさは $ 8 $ である．この値が JOI 姫と組になる貴族の踊りのうまさとして考えられる最大値である． !\[\](https://img.atcoder.jp/joi2015ho/d-3.png)列の変化の様子 - - - - - -

### Sample Explanation 2

どのような順番で並んでも，貴族 $ 2 $ と JOI 姫が組になる． - - - - - -

## 样例 #1

### 输入

```
7 3
5 2
5 5
8 6
6
2
8
9
```

### 输出

```
8
```

## 样例 #2

### 输入

```
3 1
5 3
5
5
```

### 输出

```
5
```

## 样例 #3

### 输入

```
7 2
32 4
27 6
37
41
41
30
27
```

### 输出

```
37
```



---

---
title: "サッカー (Soccer)"
layout: "post"
diff: 省选/NOI-
pid: AT_joi2017ho_d
tag: []
---

# サッカー (Soccer)

## 题目描述

平面直角坐标系上，有一个足球场，横坐标范围 $[0,X]$，纵坐标范围 $[0,Y]$。



开始时，球场上站了 $N$ 个球员，坐标分别为 $(x_i,y_i)$。



球在开始时 $1$ 号球员的位置上，你希望让这

个球到开始时 $N$  号球员的位置上。



你可以指挥任一球员进行下列某一操作，但某些操作会提升球员的疲劳度。指挥次数不限但应当有

明确的先后顺序。



已知每个球员有两种状态：控球和没有控球。

你可以指挥控球的球员进行如下操作：



• 踢球。在上下左右四个方向中任选一个，并指定一个正整数 $p$ ，该球员将球朝指定方向踢出恰好 $p$

个单位。该球员不会移动，且自动停止控球，疲劳度上升$A×p+B$。



• 运球。在上下左右四个方向中任选一个，该球员带球，朝指定方向移动 $1$ 个单位。疲劳度上升

$C$。



• 停止控球。该球员的疲劳度不改变。



你可以指挥没有控球的球员进行如下操作：



• 移动。在上下左右四个方向中任选一个，该球员朝指定方向移动 $1$ 个单位，疲劳度上升 $C$。



• 控球。如果该球员所在的位置恰好有球，且没有其他球员控球，该球员才能控球。该球员的疲劳

度不改变。



**球员和球有可能跑出场外，一个位置上可能有多个球员。

球员可视作质点，因此球滚动和运球时都不会因为碰到球员而停下。**



让球滚到指定位置的过程中，求所有球员上升的疲劳度之和的最小值。

## 输入格式

第一行两个整数 $X$ , $Y$  用空格分隔。

第二行三个整数 $A$ $B$ $C$，用空格分隔。

第三行一个整数 $N$。接下来的 $N$ 行，第 $i$ 行两个整数 $x_i$，$y_i$，用空格分隔。

## 输出格式

一行，一个整数，表示所有球员上升的疲劳度之和的最小值。

## 样例 #1

### 输入

```
6 5
1 3 6
3
1 1
0 4
6 5
```

### 输出

```
26
```

## 样例 #2

### 输入

```
3 3
0 50 10
2
0 0
3 3
```

### 输出

```
60
```

## 样例 #3

### 输入

```
4 3
0 15 10
2
0 0
4 3
```

### 输出

```
45
```

## 样例 #4

### 输入

```
4 6
0 5 1000
6
3 1
4 6
3 0
3 0
4 0
0 4
```

### 输出

```
2020
```



---

---
title: "定期券 (Commuter Pass)"
layout: "post"
diff: 省选/NOI-
pid: AT_joi2018ho_d
tag: []
---

# 定期券 (Commuter Pass)

## 题目描述

JOI 君居住的城市中有 $N$ 个车站，编号为 $1$ 到 $N$。同时，还有 $M$ 条铁路线，编号为 $1$ 到 $M$。每条铁路线 $i$ ($1 \leq i \leq M$) 连接车站 $A_i$ 和车站 $B_i$，票价为 $C_i$ 日元。

JOI 君住在车站 $S$ 附近，学校在车站 $T$ 附近，因此他计划购买一张从车站 $S$ 到车站 $T$ 的定期票。购买该定期票时，需要选择一条从 $S$ 到 $T$ 的最低票价路径。购票之后，他可以在这条指定路径上的所有铁路线自由通行。

此外，JOI 君还频繁访问车站 $U$ 和车站 $V$ 附近的书店。他希望选择的定期票能帮助他降低从车站 $U$ 到车站 $V$ 的出行费用。

从车站 $U$ 到车站 $V$ 时，若经过的铁路线 $i$ 包含在定期票所指定的路径中，则票价为 $0$ 日元；否则，票价为 $C_i$ 日元。我们的目标是找到一种选择定期票路径的方法，使得从车站 $U$ 到车站 $V$ 的总票价最小。

## 输入格式

从标准输入中读取：

- 第一行输入两个整数 $N$ 和 $M$，分别表示车站数量和铁路线数量。
- 第二行输入两个整数 $S$ 和 $T$，表示欲购买定期票的起点和终点车站。
- 第三行输入两个整数 $U$ 和 $V$，表示希望计算票价最小化的起点和终点车站。
- 接下来的 $M$ 行，每行包含三个整数 $A_i, B_i, C_i$，表示第 $i$ 条铁路线连接车站 $A_i$ 和车站 $B_i$，票价为 $C_i$ 日元。

## 输出格式

输出一个整数，表示通过合理选择定期票路径后，从车站 $U$ 到车站 $V$ 的最小票价。

## 说明/提示

### 限制

所有数据满足：

- $2 \leq N \leq 100,000$
- $1 \leq M \leq 200,000$
- $1 \leq S, T, U, V \leq N$
- $S \neq T$
- $U \neq V$
- $S \neq U$ 或 $T \neq V$
- 任意两个车站间至少有一条可行的铁路线
- 对于 $1 \leq i \neq j \leq M$，$A_i \neq A_j$ 或 $B_i \neq B_j$
- $1 \leq C_i \leq 1,000,000,000$

### 子任务

#### 子任务 1 [16 分]

- 满足 $S = U$。

#### 子任务 2 [15 分]

- 从车站 $S$ 到车站 $T$ 的最优路径唯一。

#### 子任务 3 [24 分]

- $N \leq 300$。

#### 子任务 4 [45 分]

- 无额外限制。

### 示例解释

在示例中，从车站 $1$ 到车站 $4$ 的最小票价路径是 $1 \to 2 \to 3 \to 5 \to 4$。在该路径上，除了 $5$ 号铁路线需支付 $2$ 日元外，其他路线均免费，总费用为 $2$ 日元。

 **本翻译由 AI 自动生成**

## 样例 #1

### 输入

```
6 6
1 6
1 4
1 2 1
2 3 1
3 5 1
2 4 3
4 5 2
5 6 1
```

### 输出

```
2
```

## 样例 #2

### 输入

```
6 5
1 2
3 6
1 2 1000000000
2 3 1000000000
3 4 1000000000
4 5 1000000000
5 6 1000000000
```

### 输出

```
3000000000
```

## 样例 #3

### 输入

```
8 8
5 7
6 8
1 2 2
2 3 3
3 4 4
1 4 1
1 5 5
2 6 6
3 7 7
4 8 8
```

### 输出

```
15
```

## 样例 #4

### 输入

```
5 5
1 5
2 3
1 2 1
2 3 10
2 4 10
3 5 10
4 5 10
```

### 输出

```
0
```

## 样例 #5

### 输入

```
10 15
6 8
7 9
2 7 12
8 10 17
1 3 1
3 8 14
5 7 15
2 3 7
1 10 14
3 6 12
1 5 10
8 9 1
2 9 7
1 4 1
1 8 1
2 4 7
5 6 16
```

### 输出

```
19
```



---

---
title: "毒蛇の脱走 (Snake Escaping)"
layout: "post"
diff: 省选/NOI-
pid: AT_joi2018ho_e
tag: []
---

# 毒蛇の脱走 (Snake Escaping)

## 题目描述

[problemUrl]: https://atcoder.jp/contests/joi2018ho/tasks/joi2018ho_e

JOI 研究所では $ 2^L $ 匹の毒蛇を飼っており，それぞれ $ 0,\ 1,\ \ldots,\ 2^L\ -\ 1 $ の番号が付けられている．すべての毒蛇は頭から順に $ L $ 個の部分に分かれており，それぞれの部分は青または赤である．毒蛇 $ i $ に対し，$ i $ を $ 2 $ 進表記して $ i\ =\ \sum_{k\ =\ 1}^{L}\ c_k\ 2^{L\ -\ k} $ ($ 0\ \leqq\ c_k\ \leqq\ 1 $) とおいたとき，

- $ c_k\ =\ 0 $ であれば，毒蛇 $ i $ の頭から数えて $ k $ 番目の部分は青であり，
- $ c_k\ =\ 1 $ であれば，毒蛇 $ i $ の頭から数えて $ k $ 番目の部分は赤である．

各毒蛇には毒性と呼ばれる $ 0 $ 以上 $ 9 $ 以下の整数値が定まっている．`0`，`1`，`2`，`3`，`4`，`5`，`6`，`7`，`8`，`9` からなる長さ $ 2^L $ の文字列 $ S $ が与えられ，その $ i $ 文字目 ($ 1\ \leqq\ i\ \leqq\ 2^L $) は毒蛇 $ i\ -\ 1 $ の毒性を表す．

毒蛇たちの動きは素早いので，JOI 研究所からは，よく毒蛇たちが脱走してしまう．JOI 研究所には脱走した毒蛇を目撃した周辺住民から苦情が寄せられる．

あなたには，$ Q $ 日間にわたる苦情の情報が与えられる．$ d $ 日目 ($ 1\ \leqq\ d\ \leqq\ Q $) に寄せられた苦情は `0`，`1`，`?` からなる長さ $ L $ の文字列 $ T_d $ として表され，

- $ T_d $ の $ j $ 文字目 ($ 1\ \leqq\ j\ \leqq\ L $) が `0` の場合は，$ d $ 日目に脱走したすべての毒蛇の頭から数えて $ j $ 番目の部分が青であることを表し，
- $ T_d $ の $ j $ 文字目 ($ 1\ \leqq\ j\ \leqq\ L $) が `1` の場合は，$ d $ 日目に脱走したすべての毒蛇の頭から数えて $ j $ 番目の部分が赤であることを表し，
- $ T_d $ の $ j $ 文字目 ($ 1\ \leqq\ j\ \leqq\ L $) が `?` の場合は，$ d $ 日目に脱走した毒蛇の頭から数えて $ j $ 番目の部分については，周辺住民からは情報が与えられなかったことを表す．

苦情はすべて正確な情報である．脱走した毒蛇は JOI 研究所の職員がその日のうちに捕獲する．捕獲された毒蛇が，翌日以降に再び脱走することはあり得る．

毒蛇の脱走によるリスクを見積もるために，JOI 研究所の K 理事長は脱走した可能性のある毒蛇の毒性の合計を知りたい．あなたの仕事は，$ Q $ 日間にわたる苦情の情報から，それぞれの日ごとに，その日に脱走した可能性のある毒蛇の毒性の合計を求めるプログラムを作成することである．

## 输入格式

標準入力から以下の入力を読み込め．

- $ 1 $ 行目には，整数 $ L,\ Q $ が空白を区切りとして書かれている．これらは順に，毒蛇の部分の個数と，苦情の寄せられる日数を表す．
- $ 2 $ 行目には，長さ $ 2^L $ の文字列 $ S $ が書かれている．この文字列は毒蛇の毒性を表す．
- 続く $ Q $ 行のうちの $ d $ 行目 ($ 1\ \leqq\ d\ \leqq\ Q $) には，長さ $ L $ の文字列 $ T_d $ が書かれている．この文字列は $ d $ 日目の苦情を表す．

## 输出格式

標準出力に $ Q $ 行で出力せよ．$ d $ 行目には，$ d $ 日目に脱走した可能性のある毒蛇の毒性の合計を表す整数を出力せよ．

- - - - - -

## 说明/提示

### 課題

毒蛇の毒性を表す文字列 $ S $ と，$ Q $ 日間の苦情の情報が与えられるので，それぞれの日ごとに，その日に脱走した可能性のある毒蛇の毒性の合計を求めるプログラムを作成せよ．

メモリ制限が小さいことに注意すること．

- - - - - -

### 制限

すべての入力データは以下の条件を満たす．

- $ 1\ \leqq\ L\ \leqq\ 20 $．
- $ 1\ \leqq\ Q\ \leqq\ 1\,000\,000 $．
- $ S $ は長さ $ 2^L $ の文字列である．
- 文字列 $ S $ は `0`，`1`，`2`，`3`，`4`，`5`，`6`，`7`，`8`，`9` からなる．
- $ T_d $ は長さ $ L $ の文字列である ($ 1\ \leqq\ d\ \leqq\ Q $)．
- 文字列 $ T_d $ は `0`，`1`，`?` からなる ($ 1\ \leqq\ d\ \leqq\ Q $)．

### 小課題

#### 小課題 1 \[5 点\]

以下の条件を満たす．

- $ L\ \leqq\ 10 $．
- $ Q\ \leqq\ 1\ 000 $．

#### 小課題 2 \[7 点\]

- $ L\ \leqq\ 10 $ を満たす．

#### 小課題 3 \[10 点\]

- $ L\ \leqq\ 13 $ を満たす．

#### 小課題 4 \[53 点\]

- $ Q\ \leqq\ 50\ 000 $ を満たす．

#### 小課題 5 \[25 点\]

- 追加の制限はない．

- - - - - -

### Sample Explanation 1

この入力例では，$ L\ =\ 3 $ である．$ 3 $ つの部分に分かれた毒蛇が，全部で $ 2^3\ =\ 8 $ 匹いる．苦情は $ 5 $ 日間にわたって寄せられる． - $ 1 $ 日目に脱走した可能性のある毒蛇は，毒蛇 $ 0 $ のみである．毒性の合計は $ 1 $ である． - $ 2 $ 日目に脱走した可能性のある毒蛇は，毒蛇 $ 0,\ 1,\ 2,\ 3 $ である．毒性の合計は $ 10 $ である． - $ 3 $ 日目に脱走した可能性のある毒蛇は，毒蛇 $ 4,\ 6 $ である．毒性の合計は $ 12 $ である． - $ 4 $ 日目に脱走した可能性のある毒蛇は，毒蛇 $ 3,\ 7 $ である．毒性の合計は $ 12 $ である． - $ 5 $ 日目に脱走した可能性のある毒蛇は，毒蛇 $ 0,\ 1,\ 2,\ 3,\ 4,\ 5,\ 6,\ 7 $ である．毒性の合計は $ 36 $ である． - - - - - -

## 样例 #1

### 输入

```
3 5
12345678
000
0??
1?0
?11
???
```

### 输出

```
1
10
12
12
36
```

## 样例 #2

### 输入

```
4 8
3141592653589793
0101
?01?
??1?
?0??
1?00
01?1
??10
????
```

### 输出

```
9
18
38
30
14
15
20
80
```



---

---
title: "珍しい都市 (Unique Cities)"
layout: "post"
diff: 省选/NOI-
pid: AT_joi2019ho_e
tag: []
---

# 珍しい都市 (Unique Cities)

## 题目描述

[problemUrl]: https://atcoder.jp/contests/joi2019ho/tasks/joi2019ho_e

JOI 国には $ N $ 個の都市があり，$ 1 $ から $ N $ までの番号がついている．これらの都市は $ N\ -\ 1 $ 本の道路で結ばれている．$ i $ 番目 ($ 1\ \leqq\ i\ \leqq\ N\ -\ 1 $) の道路は都市 $ A_i $ と都市 $ B_i $ を結んでおり，双方向に通行可能である．どの都市からどの都市へも何本かの道路を通行することで移動できる．

JOI 国にはいくつかの特産品が存在する．特産品には，種類を表す $ 1 $ 以上 $ M $ 以下の番号が付けられている (JOI 国で生産されている特産品に対応していない番号があるかもしれない)．各都市は $ 1 $ つの特産品を生産しており，都市 $ j $ ($ 1\ \leqq\ j\ \leqq\ N $) では特産品 $ C_j $ を生産している．複数の都市が同じ種類の特産品を生産することがあるかもしれない．

$ 2 $ つの都市の間の距離は，その間を移動するために通る道路の本数の最小値である．都市 $ x $ ($ 1\ \leqq\ x\ \leqq\ N $) から見て都市 $ y $ ($ 1\ \leqq\ y\ \leqq\ N,\ y\ \neq\ x $) が珍しい都市であるとは，すべての都市 $ z $ ($ 1\ \leqq\ z\ \leqq\ N,\ z\ \neq\ x,\ z\ \neq\ y $) について，都市 $ x $, $ y $ 間の距離と都市 $ x $, $ z $ 間の距離が異なることを意味する．

JOI 国の大臣である $ K $ 理事長は，すべての $ j $ ($ 1\ \leqq\ j\ \leqq\ N $) について，都市 $ j $ から見て珍しい都市で生産されている特産品が何種類あるかを知りたい．

JOI 国の道路の情報と，各都市で生産されている特産品の番号が与えられたとき，各都市ごとに，その都市から見て珍しい都市で生産されている特産品が何種類あるかを求めるプログラムを作成せよ．

- - - - - -

## 输入格式

入力は以下の形式で標準入力から与えられる．

> $ N $ $ M $ $ A_1 $ $ B_1 $ $ \vdots $ $ A_{N-1} $ $ B_{N-1} $ $ C_1 $ $ \cdots $ $ C_N $

## 输出格式

標準出力に $ N $ 行で出力せよ．$ j $ 行目 ($ 1\ \leqq\ j\ \leqq\ N $) には，都市 $ j $ から見て珍しい都市で生産されている特産品が何種類あるかを出力せよ．

- - - - - -

## 说明/提示

### 制約

- $ 2\ \leqq\ N\ \leqq\ 200\,000 $．
- $ 1\ \leqq\ M\ \leqq\ N $．
- $ 1\ \leqq\ A_i\ \leqq\ N $ ($ 1\ \leqq\ i\ \leqq\ N\ -\ 1 $)，$ 1\ \leqq\ B_i\ \leqq\ N $ ($ 1\ \leqq\ i\ \leqq\ N\ -\ 1 $)．
- $ A_i\ ,\ B_i\ (1\ \leqq\ i\ \leqq\ N\ -\ 1 $)．
- どの都市からどの都市へも何本かの道路を通行することで移動できる．
- $ 1\ \leqq\ C_j\ \leqq\ M $ ($ 1\ \leqq\ j\ \leqq\ N $)．

### 小課題

1. ($ 4 $ 点) $ N\ \leqq\ 2\,000 $．
2. ($ 32 $ 点) $ M\ =\ 1 $．
3. ($ 32 $ 点) $ M\ =\ N $，$ C_j\ =\ j $ ($ 1\ \leqq\ j\ \leqq\ N $)．
4. ($ 32 $ 点) 追加の制約はない．

- - - - - -

### Sample Explanation 1

都市 $ 1 $ から見て珍しい都市は都市 $ 2,\ 3 $ であり，そこで生産される特産品は特産品 $ 2,\ 1 $ なので，答えは $ 2 $種類である． 都市 $ 2 $ から見て珍しい都市は存在しないので，答えは $ 0 $ 種類である． 都市 $ 3 $ から見て珍しい都市は都市 $ 1 $ であり，そこで生産される特産品は特産品 $ 1 $ なので，答えは $ 1 $ 種類である． 都市 $ 4 $ から見て珍しい都市は都市 $ 1,\ 3 $ であり，どちらの都市においても生産される特産品は特産品 $ 1 $ なので，答えは $ 1 $ 種類である． 都市 $ 5 $ から見て珍しい都市は都市 $ 1,\ 3 $ であり，どちらの都市においても生産される特産品は特産品 $ 1 $ なので，答えは $ 1 $ 種類である． 番号 $ 3 $ の特産品は存在しないことに注意せよ． - - - - - -

### Sample Explanation 2

この入力例は小課題 $ 2 $ の制約を満たす． - - - - - -

### Sample Explanation 3

この入力例は小課題 $ 3 $ の制約を満たす． - - - - - -

## 样例 #1

### 输入

```
5 4
1 2
2 3
3 4
3 5
1 2 1 2 4
```

### 输出

```
2
0
1
1
1
```

## 样例 #2

### 输入

```
7 1
1 2
2 3
3 4
4 5
5 6
6 7
1 1 1 1 1 1 1
```

### 输出

```
1
1
1
0
1
1
1
```

## 样例 #3

### 输入

```
10 10
2 6
5 8
10 8
1 4
10 6
4 5
10 7
6 9
3 7
1 2 3 4 5 6 7 8 9 10
```

### 输出

```
4
3
4
2
0
2
2
0
3
2
```

## 样例 #4

### 输入

```
22 12
9 6
12 13
4 20
21 22
3 19
2 9
6 18
18 11
18 3
16 2
6 4
3 17
16 10
8 16
22 1
16 14
15 8
9 21
2 12
21 5
12 7
1 1 4 8 4 11 7 6 7 11 6 11 10 4 7 5 3 12 9 6 12 2
```

### 输出

```
2
0
1
1
1
1
1
0
0
1
2
0
1
1
2
0
2
1
2
3
0
0
```



---

---
title: "集合写真 (Group Photo)"
layout: "post"
diff: 省选/NOI-
pid: AT_joi2021ho_c
tag: []
---

# 集合写真 (Group Photo)

## 题目描述

有 $N$ 个人，这 $N$ 个人编号为 $1 \sim N$，第 $h$ 个人的身高为 $h$。

有 $N$ 个台阶，这 $N$ 个台阶从低到高编号为 $1 \sim N$，第 $i$ 级台阶比第 $i+1$ 个台阶低 $2$ 个单位高度。每个台阶上只能站一个人，第 $H_i$ 个人站在第 $i$ 个台阶上。

你可以进行无数次如下操作：

- 选择 $i \in [1,N-1]$，交换第 $i$ 个台阶上的人和第 $i+1$ 个台阶上的人。

假设第 $i$ 个台阶上站的人的高度为 $a_i$，你要满足：

- 对于任意 $i \in [1,N-1]$，都有 $a_i <a_{i+1}+2$。

求最少的操作次数。

## 输入格式

第一行一个整数 $N$ 代表人数。

第二行 $N$ 个整数 $H_i$ 代表第 $H_i$ 个人站在第 $i$ 个台阶上。

## 输出格式

一行一个整数代表最少的操作次数。

## 样例 #1

### 样例输入 #1

```
5
3 5 2 4 1
```

### 样例输出 #1

```
3
```

## 样例 #2

### 样例输入 #2

```
5
3 2 1 5 4
```

### 样例输出 #2

```
0
```

## 样例 #3

### 样例输入 #3

```
9
6 1 3 4 9 5 7 8 2
```

### 样例输出 #3

```
9
```

## 说明/提示

#### 样例 1 解释

设 $h_i$ 为第 $i$ 个台阶上站的人的身高：

- 交换第 $2$ 个人和第 $3$ 个人，$h_i=\{3,2,5,4,1\}$。
- 交换第 $4$ 个人和第 $5$ 个人，$h_i=\{3,2,5,1,4\}$。
- 交换第 $3$ 个人和第 $4$ 个人，$h_i=\{3,2,1,5,4\}$。

$3$ 步刚好满足要求。

#### 样例 2 解释

已经满足要求，不需要进行任何操作。

#### 数据规模与约定

**本题采用捆绑测试。**

- Subtask 1（5 pts）：$N \le 9$。
- Subtask 2（7 pts）：$N \le 20$。
- Subtask 3（32 pts）：$N \le 200$。
- Subtask 4（20 pts）：$N \le 800$。
- Subtask 5（36 pts）：无特殊限制。

对于 $100\%$ 的数据，$3 \le N \le 5000$，$1 \le H_i \le N$，$H_i$ 互不相等。


翻译自 [The 20th Japanese Olympiad in Informatics Final Round C 集合写真的英文翻译 Group Photo](https://www.ioi-jp.org/joi/2020/2021-ho/2021-ho-t3-en.pdf)。

## 样例 #1

### 输入

```
5
3 5 2 4 1
```

### 输出

```
3
```

## 样例 #2

### 输入

```
5
3 2 1 5 4
```

### 输出

```
0
```

## 样例 #3

### 输入

```
9
6 1 3 4 9 5 7 8 2
```

### 输出

```
9
```



---

---
title: "ロボット (Robot)"
layout: "post"
diff: 省选/NOI-
pid: AT_joi2021ho_d
tag: []
---

# ロボット (Robot)

## 题目描述

[problemUrl]: https://atcoder.jp/contests/joi2021ho/tasks/joi2021ho_d

IOI 町には $ N $ 個の交差点があり，$ 1 $ から $ N $ までの番号が付いている．また，$ M $ 本の道があり，$ 1 $ から $ M $ までの番号が付いている．それぞれの道は $ 2 $ 個の異なる交差点を双方向に結んでいる．道 $ i $ ($ 1\ \leqq\ i\ \leqq\ M $) は交差点 $ A_i $ と交差点 $ B_i $ を結んでいる．$ 2 $ 本の異なる道が同じ交差点の組を結ぶことはない．これらの道には $ 1 $ 以上 $ M $ 以下の整数で表される色が塗られており，道 $ i $ の現在の色は $ C_i $ である．複数の道が同じ色で塗られているかもしれない．

JOI 社は IOI 町の交差点を移動するロボットを開発した．あなたがこのロボットに道の色を指示すると，ロボットは指示された色の道を通り隣接した交差点に移動する．ただし，ロボットが現在いる交差点につながれた道のうちに，指示された色の道が $ 2 $ 本以上存在すると，次に進むべき道を判別できずに停止してしまう．

あなたの目的は，現在交差点 $ 1 $ にいるロボットに何回かの指示を出して，交差点 $ N $ に移動させることである．ただし，現在の道の色ではそれができるとは限らないため，何本かの道の色を**事前に**塗り替えることで， ロボットを交差点 $ N $ に移動させることができるようにしたい．道 $ i $ ($ 1\ \leqq\ i\ \leqq\ M $) は $ P_i $ 円をかけて，$ 1 $ 以上 $ M $ 以下の好きな整数の色に塗り替えることが出来る．

交差点と道の情報が与えられたとき，必要な金額の最小値を求めるプログラムを作成せよ．ただし，どのように道の色を塗り替えてもロボットを交差点 $ N $ に移動させることができない場合は，代わりに `-1` を出力せよ．

- - - - - -

## 输入格式

入力は以下の形式で標準入力から与えられる．入力される値はすべて整数である．

> $ N $ $ M $ $ A_1 $ $ B_1 $ $ C_1 $ $ P_1 $ $ \vdots $ $ A_M $ $ B_M $ $ C_M $ $ P_M $

## 输出格式

標準出力に必要な金額の最小値を $ 1 $ 行で出力せよ．ただし，どのように道の色を塗り替えてもロボットを交差点 $ N $ に移動させることができない場合は，代わりに `-1` を出力せよ．

- - - - - -

## 说明/提示

### 制約

- $ 2\ \leqq\ N\ \leqq\ 100\,000 $．
- $ 1\ \leqq\ M\ \leqq\ 200\,000 $．
- $ 1\ \leqq\ A_i\ <\ B_i\ \leqq\ N $ ($ 1\ \leqq\ i\ \leqq\ M $)．
- $ (A_i,\ B_i)\ \neq\ (A_j,\ B_j) $ ($ 1\ \leqq\ i\ <\ j\ \leqq\ M $)．
- $ 1\ \leqq\ C_i\ \leqq\ M $ ($ 1\ \leqq\ i\ \leqq\ M $)．
- $ 1\ \leqq\ P_i\ \leqq\ 1\,000\,000\,000 $ ($ 1\ \leqq\ i\ \leqq\ M $)．

### 小課題

1. ($ 34 $ 点) $ N\ \leqq\ 1\,000 $，$ M\ \leqq\ 2\,000 $．
2. ($ 24 $ 点) $ P_i\ =\ 1 $ ($ 1\ \leqq\ i\ \leqq\ M $)．
3. ($ 42 $ 点) 追加の制約はない．

- - - - - -

### Sample Explanation 1

$ 1 $ 円で道 $ 4 $ を色 $ 3 $ から色 $ 4 $ に塗り替え，$ 2 $ 円で道 $ 6 $ を色 $ 4 $ から色 $ 2 $ に塗り替える．合計 $ 3 $ 円かかる． この結果，交差点 $ 1 $ にいるロボットに色 $ 2 $ を指示することで，ロボットを交差点 $ 2 $ に移動させることができる．続けて，ロボットに色 $ 4 $ を指示することで，ロボットを交差点 $ 4 $ に移動させることができる． $ 2 $ 円以下でロボットを交差点 $ 4 $ に移動させることは不可能であるため，$ 3 $ を出力する． - - - - - -

### Sample Explanation 2

道をどのように塗り替えても，ロボットを交差点 $ 5 $ に移動させることはできない．したがって，$ -1 $ を出力する． - - - - - -

### Sample Explanation 3

この入力例は小課題 $ 2 $ の制約を満たす． - - - - - -

## 样例 #1

### 输入

```
4 6
1 4 4 4
3 4 1 3
1 3 4 4
2 4 3 1
2 3 3 2
1 2 4 2
```

### 输出

```
3
```

## 样例 #2

### 输入

```
5 2
1 4 1 2
3 5 1 4
```

### 输出

```
-1
```

## 样例 #3

### 输入

```
5 7
2 3 7 1
1 4 5 1
4 5 3 1
3 4 7 1
2 4 3 1
3 5 6 1
1 2 5 1
```

### 输出

```
1
```

## 样例 #4

### 输入

```
13 21
7 10 4 4
3 6 4 7
8 10 4 5
3 9 2 5
1 4 4 5
2 6 4 2
3 11 2 2
3 8 16 2
8 11 16 1
6 10 4 14
6 8 16 6
9 12 16 5
5 13 4 6
1 12 4 7
2 4 4 18
2 9 4 10
2 12 4 6
10 13 4 28
5 7 2 5
5 11 2 16
7 13 4 20
```

### 输出

```
7
```



---

---
title: "一流の団子職人 (Super Dango Maker)"
layout: "post"
diff: 省选/NOI-
pid: AT_joigsc2022_g
tag: []
---

# 一流の団子職人 (Super Dango Maker)

## 题目描述

有一个竞赛任务，请求你选出一组团子并判断某个二进制数组的状态。

### 输入格式

输入第一行提供整数 $N$ 和 $M$。

### 查询操作

我们设想有一个长度为 $N \times M$ 的数组 $A$。对于数组中的每一个团子，第 $i$ 个被选中时 $A[i] = 1$，未被选中时 $A[i] = 0$。

在进行查询操作时，输出字母 `Q`，紧接着无需空格直接输出数组 $A$ 的二进制表示，最后进行换行。

例如，假设 $A = (0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1, 0, 1, 1, 0, 0)$，在查询阶段你需要输出 `Q 4` 并换行。

查询返回结果将在接下来的输入行中给出。

### 回答操作

同样地，我们面对的是一个长度为 $N \times M$ 的数组 $A$，根据条件选取相应的团子。当选择第 $i$ 个团子时 $A[i] = 1$，否则 $A[i] = 0$。

此时输出字母 `A`，紧接着输出二进制数组 $A$ 的表示，最后换行。

之后将会读取到输入行中提供的数值 `0`。

### 其他说明

如果在输出过程中，格式不符合要求或者条件未达成，输入将变为 `-1`。此时你需要立即终止程序的运行。

完成 $M$ 次回答操作后，输出 `F`。

**请确保每次输出之后都刷新输出流，以确保内容被及时输出。**

 **本翻译由 AI 自动生成**



---

---
title: "招待"
layout: "post"
diff: 省选/NOI-
pid: AT_joisc2012_invitation
tag: []
---

# 招待

## 题目描述

[problemUrl]: https://atcoder.jp/contests/joisc2012/tasks/joisc2012_invitation





---

---
title: "カンガルー"
layout: "post"
diff: 省选/NOI-
pid: AT_joisc2012_kangaroo
tag: []
---

# カンガルー

## 题目描述

[problemUrl]: https://atcoder.jp/contests/joisc2012/tasks/joisc2012_kangaroo





---

---
title: "歴史の研究"
layout: "post"
diff: 省选/NOI-
pid: AT_joisc2014_c
tag: []
---

# 歴史の研究

## 题目描述

IOI 国历史研究的第一人——JOI 教授，最近获得了一份被认为是古代 IOI 国的住民写下的日记。JOI 教授为了通过这份日记来研究古代 IOI 国的生活，开始着手调查日记中记载的事件。

日记中记录了连续 $N$ 天发生的事件，大约每天发生一件。

事件有种类之分。第 $i$ 天发生的事件的种类用一个整数 $X_i$
表示，$X_i$ 越大，事件的规模就越大。

JOI 教授决定用如下的方法分析这些日记：

 - 选择日记中连续的几天 $[L,R]$ 作为分析的时间段；

 - 定义事件 $A$ 的重要度 $W_A$ 为 $A\times T_A$，其中 $T_A$ 为该事件在区间 $[L,R]$ 中出现的次数。

现在，您需要帮助教授求出所有事件中重要度最大的事件是哪个，**并输出其重要度**。

注意：教授有多组询问。

## 输入格式

第一行两个空格分隔的整数 $N$ 和 $Q$，表示日记一共记录了 $N$ 天，询问有 $Q$ 次。

接下来一行 $N$ 个空格分隔的整数表示每天的事件种类。

接下来 $Q$ 行，每行给出 $L,R$ 表示一组询问。

## 输出格式

输出共有 $Q$ 行，每行一个整数，表示对应的询问的答案。

## 说明/提示

对于 $100\%$ 的数据，$1\le Q,N\le 10^5$，$1\le X\le 10^9$，$1\le L\le R\le 10^5$。

## 样例 #1

### 输入

```
5 5
9 8 7 8 9
1 2
3 4
4 4
1 4
2 4
```

### 输出

```
9
8
8
16
16
```

## 样例 #2

### 输入

```
8 4
9 9 19 9 9 15 9 19
1 4
4 6
3 5
5 8
```

### 输出

```
27
18
19
19
```

## 样例 #3

### 输入

```
12 15
15 9 3 15 9 3 3 8 16 9 3 17
2 7
2 5
2 2
1 12
4 12
3 6
11 12
1 7
2 6
3 5
3 10
7 10
1 4
4 8
4 8
```

### 输出

```
18
18
9
30
18
15
17
30
18
15
18
16
30
15
15
```



---

---
title: "スタンプラリー"
layout: "post"
diff: 省选/NOI-
pid: AT_joisc2014_g
tag: []
---

# スタンプラリー

## 题目描述

[problemUrl]: https://atcoder.jp/contests/joisc2014/tasks/joisc2014_g





---

---
title: "電圧"
layout: "post"
diff: 省选/NOI-
pid: AT_joisc2014_j
tag: []
---

# 電圧

## 题目描述

[problemUrl]: https://atcoder.jp/contests/joisc2014/tasks/joisc2014_j





---

---
title: "二人の星座"
layout: "post"
diff: 省选/NOI-
pid: AT_joisc2014_k
tag: []
---

# 二人の星座

## 题目描述

[problemUrl]: https://atcoder.jp/contests/joisc2014/tasks/joisc2014_k





---

---
title: "合鍵"
layout: "post"
diff: 省选/NOI-
pid: AT_joisc2015_f
tag: []
---

# 合鍵

## 题目描述

## JOISC2015 Day2T2 锁


在 JOI 公司内共有 $N$ 个员工。在时刻 $0$ ，每一个员工均在公司内。公司只有一个大门用于进出公司，这个大门可以上锁。在公司内的人可以任意开锁或锁门，但在公司外只有拥有备用钥匙的人可以任意开锁或锁门。因为 JOI 公司的规定，在公司内的人除非要从公司出去，是不允许开门锁的。

现在员工 $i$ 会在 $S_i$ 时刻从公司出外出差，在 $T_i$ 时刻回到公司，保证在同一时刻没有两个或以上的员工同时进出大门，且在 $M$ 时刻所有员工均回到了公司，即 $T_i < M$ 。你可以让 $K$ 个员工拿到备用钥匙，为了不让钥匙丢失，备用钥匙不能给其他员工借用。

现在 JOI 公司的社长需要你求出：在所有员工到达公司时都能进入公司（即门没有上锁或者这个员工有备用钥匙）、拥有备用钥匙的员工不超过 $K$ 的情况下，在这 $M$ 个单位时间内门最多锁住多长时间。

## 输入格式

第一行三个正整数 $N,M,K$，接下来 $N$ 行每行两个正整数 $S_i , T_i$

## 输出格式

一行一个正整数表示最大的给门上锁的时间。

## 说明/提示

$1 \leq K \leq N \leq 2000$

$1 \leq M \leq 10^9$

$0 < S_i < T_i < M$，$S_i,T_i$ 两两不同

## 样例 #1

### 输入

```
4 20 2
3 11
5 15
6 10
12 18
```

### 输出

```
13
```



---

---
title: "マトリョーシカ人形"
layout: "post"
diff: 省选/NOI-
pid: AT_joisc2016_a
tag: []
---

# マトリョーシカ人形

## 题目描述

你开了一家卖套娃的店。因此，你向厂家订购了 $N$ 个套娃，这些娃娃被编号为 $1$ 到 $N$，其中第 $i$ 个套娃是一个的直径为 $R_i$ 高度为 $H_i$ 的圆柱体。每个套娃都只能套高和直径严格比它小的套娃。同时只要满足条件，套娃可以嵌套多次。\
有一天，你收到了厂家的来电，告诉你你预定的 $N$ 个娃娃不能一次性全部做完。所以第一批只会送达直径大于等于 $A$ 并且高度小于等于 $B$ 的所有套娃。你需要预先安排出一个方案，使送来的套娃经过若干次嵌套后，没有被套的套娃数量最小。\
由于厂家经常搞事情，所以他会改变 $A$ 和 $B$ 的值，总共 $Q$ 次，因此你需要对每对 $(A,B)$ 都作出回答，询问之间互不干扰。

## 输入格式

第一行有两个整数 $N$ 和 $Q$ ，表示套娃的个数和询问的次数；
之后的 $N$ 行，每行两个数 $R_i$ 与 $H_i$ 表示第 $i$ 个数的直径和高度；
之后的 $Q$ 行，每行两个数 $A_i$ 与 $B_i$ 表示第 $i$ 个 $(A,B)$。

## 输出格式

输出包括 $Q$ 行，每行包括一个数字，为送来的套娃经过若干次嵌套后，没有被套的套娃数量最小的个数。
### 输入样例1
```cpp
7 3
9 5
3 7
10 6
5 10
2 6
10 10
4 1
10 5
3 5
3 9
```
### 输出样例1
```cpp
0
1
2
```
### 样例解释1
- 对于第一个询问，没有直径大于等于 $10$ 且高度小于等于 $5$ 的套娃，所以是 $0$；
- 对于第二个询问，直径大于等于 $3$ 且高度小于等于 $5$ 的套娃有两个：第一个，第七个。第一个能套第七个，所以没被嵌套的只有第一个，答案为 $1$；
- 对于第三个询问，满足条件的套娃是$1,2,3,7$。其中 $3$ 可以装 $1$，$1$ 可以装 $7$，没有被嵌套的是 $2$ 和 $3$，答案为 $2$。
### 输入样例2
```cpp
10 8
14 19
9 16
11 2
7 18
20 16
9 5
10 9
20 6
4 17
13 8
7 14
9 3
9 13
4 19
12 4
19 16
18 10
7 14
```
### 输出样例2
```cpp
3
1
3
5
0
2
1
3
```

## 说明/提示

对于全部的数据，$1≤N,Q≤2×10^5,1≤Ri,Hi,Ai,Bi≤10^9$。\
具体子任务限制及得分情况如下表：
|编号|限制|
|-----------:|-----------:|
|1|$N≤10,Q=1$|
|2|$N≤100,Q=1$|
|3|$N,Q≤2000$|
|4|无追加限制|



---

---
title: "ソリティア"
layout: "post"
diff: 省选/NOI-
pid: AT_joisc2016_c
tag: []
---

# ソリティア

## 题目描述

[problemUrl]: https://atcoder.jp/contests/joisc2016/tasks/joisc2016_c





---

---
title: "雇用計画"
layout: "post"
diff: 省选/NOI-
pid: AT_joisc2016_d
tag: []
---

# 雇用計画

## 题目描述

JOI 社为了扩大业务而开始了新社员招募。社员有 $N$ 名候补者，编号从 $1$ 到 $N$， 每名候补者有称为评价值的一个确定整数。 评价值高于某一个值的候补者全部都将被聘用， 他们还将分为几个组别。如果 $a, b(a \lt b)$ 同时被聘用且 $c(a \le c\le b)$ 全部被聘用时，$a,b$ 进入同一组。

你要处理 $M$ 个查询，查询有以下两种：

- 评价值 $B_j$ 以上的候补者全部聘用时的组数；

- 将候补者 $C_j$ 的评价值更新为 $D_j$。

## 输入格式

第一行两个整数 $N, M$；
接下来 $N$ 行第 $i$ 行给出候补者评价值的初始值 $A_i$；
接下来 $M$ 行中，第 $j$ 行有一个整数 $T_j$：

- $T_j=1$ 时给出 $B_j$，意义如上；

- $T_j=2$ 时给出 $C_j, D_j$，意义如上。

## 输出格式

每行一个整数表示分组个数。

翻译提供者：@User_Unauthorized



---

---
title: "トイレ"
layout: "post"
diff: 省选/NOI-
pid: AT_joisc2016_f
tag: []
---

# トイレ

## 题目描述

JOI会场附近有两个厕所，一个是女性专用的，另外一个是男女混用的。女性可以用两种厕所，但是男性只能用男女混用的。   
比赛结束后，有$2N$个选手排成一列上厕所。排队的人有男的和女的。他们将按照下列规则排队上厕所。

- 如果当前是一个女生在队头，那么选择空的那个厕所进入。若两边都是空的，优先进入女性专用厕所。

- 如果当前是一个男生在队头，他会遵守以下规则。

	- 如果男女公用厕所是空的，他就会去男女共用的厕所。
    
   - 如果男女公用厕所不是空的但是女性专用厕所是空的，他会请队伍里面最前面的一个女生去女性专用厕所。
   
所有的选手都会用1分钟上厕所。你可以忽略选手出入厕所的时间。   
但是这样可能不会在$N$分钟之内上完厕所，于是我们希望能够改变选手排队的次序，进而保证所有选手能在$N$分钟之内上完厕所。   
排完次序之后，我们定义一个选手的不满度。

- 一个选手的不满度定义为排序之前在这个选手的后面但是排序后在该选手的前面的人数。

不满度与排队时进入厕所次序无关。

我们希望能够适当地排序后使得所有人能在$N$分钟之内上完厕所，并且不满度最小。

我们给定$2N$个选手的初始排队顺序，确定是否能够在$N$分钟内上完厕所。如果可以的话，写出一个程序，找到选手的不满度的最小值。

## 输入格式

- 第一行，输入一个$N$。表示有$2N$个人排序。

- 第二行，输入一个$M$。

- 接下来$M$行，有一个字符串$S_i$和整数$K_i$，并且以空格符间隔。这些数据表示用$K_i$个$S_i$依次接在后面。

我们以此定义出一个字符串$X$（即为上述初始排队队列）。$X$左起第$j(j \leq 2N)$个字符代表这个选手的性别。若这个字符是`M`，代表这个选手是男性，若这个字符是`F`，那么这个选手是女性。

## 输出格式

输出选手最小的可能不满度值。但是如果无论如何排序都无法在$N$分钟以内上完厕所，输出`-1`

## 说明/提示

输入数据满足以下数据。

- $1 \leq N \leq 10^{18}$。

- $1 \leq M \leq 100000$。

- $1 \leq K_i \leq 2N (1 \leq i \leq M)$。

- $1 \leq |S_i| \leq 2N (1 \leq i \leq M)$，其中$|S_i|$代表$S_i$的长度。

- $S_i (1 \leq i \leq M)$的所有字符都是`M`或者`F`。

- 通过$K_i$和$S_i$构造的字符串$X$，满足$X$长度为$2N$。

## 任务

#### 子任务1[14分]

满足以下条件。

- $N \leq 10$。

- $M=1$。

- $K_i=1$。

#### 子任务2[22分]

满足以下条件。

- $N \leq 100000$。

- $M=1$。

- $K_i=1$。

#### 子任务3[64分]

没有追加条件。

## 测试样例

#### 输入1

```
6
1
FFFMMMMMMFFF 1
```

#### 输出1

```
2
```

重排序列之后为`FMMFFMMMMFFF`。

#### 输入2

```
6
1
MMFFMMMMFFMF 1

```

#### 输出2

```
-1
```

无论如何排序都无法完成在$N$分钟之内完成。

#### 输入3

```
6
1
MFFFMFMMFFFM 1
```

#### 输出3

```
0
```

#### 输出4

```
6
4
M 1
F 2
FM 2
MFFFM 1
```

#### 输出4

```
0
```

输入样例3和4构造的字符串$X$是一样的，重排序列之后为`MFFFMFMMFFFM`。



---

---
title: "電報"
layout: "post"
diff: 省选/NOI-
pid: AT_joisc2016_i
tag: []
---

# 電報

## 题目描述

[problemUrl]: https://atcoder.jp/contests/joisc2016/tasks/joisc2016_i


给出 $N$ 个点，每个点的出度均为 $1$，给出这 $N$ 个点初始指向的点 $A_i$，和改变这个点指向的目标所需要的价值 $C_i$。

求让所有点强连通的最小花费。

## 输入格式


第一行输入一个数 $N$ 表示点的个数。
之后的 $N$ 行每行两个数 $A_i$ $C_i$ 表示第 $i$ 个点指向第 $A_i$ 个点，更改该点指向的点花费为 $C_i$。 


## 输出格式


共一行，为让所有点强连通的最小花费。



## 说明/提示

$2 \le N \le 10^5, 1 \le A_i \le N, A_i \ne i, 1 \le C_i \le 10^9$

## 样例 #1

### 输入

```
4
2 2
1 4
1 3
3 1
```

### 输出

```
4
```

## 样例 #2

### 输入

```
4
2 2
1 6
1 3
3 1
```

### 输出

```
5
```

## 样例 #3

### 输入

```
4
2 2
1 3
4 2
3 3
```

### 输出

```
4
```

## 样例 #4

### 输入

```
3
2 1
3 1
1 1
```

### 输出

```
0
```



---

---
title: "最悪の記者2"
layout: "post"
diff: 省选/NOI-
pid: AT_joisc2016_l
tag: []
---

# 最悪の記者2

## 题目描述

[problemUrl]: https://atcoder.jp/contests/joisc2016/tasks/joisc2016_l





---

---
title: "港湾設備 (Port Facility)"
layout: "post"
diff: 省选/NOI-
pid: AT_joisc2017_b
tag: []
---

# 港湾設備 (Port Facility)

## 题目描述

#「JOISC 2017 Day 1」港口设施


**题目译自 [JOISC 2017](https://www.ioi-jp.org/camp/2017/2017-sp-tasks/index.html) Day1 T2「[港湾設備](https://www.ioi-jp.org/camp/2017/2017-sp-tasks/2017-sp-d1.pdf)（[Port Facility](https://www.ioi-jp.org/camp/2017/2017-sp-tasks/2017-sp-d1-en.pdf)）」**

JOI 港口虽然很小，却非常繁忙。  
JOI 港口放置集装箱的结构可视为两个本质不同的栈。每天从船上卸下的集装箱会被压入某个栈，而被运出港口的集装箱则从栈顶弹出。  
今天 JOI 港口会迎来 $N$ 个集装箱，它们在今天内会被运出港口。今天出入口有 $2N$ 条记录，每条记录都表示一个集装箱到港或离港。  
第 $i$ 个集装箱 $(1\le i\le N)$ 的到港记录为 $A_i$，离港记录为 $B_i$。  
我们把 $N$ 个集装箱分别放在哪个栈称为一个方案。求放置集装箱的方案数$\bmod (10^9+7)$。

## 输入格式

第一行有一个整数 $N$。
在接下来的 $N$ 行中，第 $i$ 行 $(1\le i\le N)$ 有两个整数 $A_i, B_i$，用空格分隔。

## 输出格式

一个整数，表示放置集装箱的方案数$\bmod (10^9+7)$。

## 样例

#### 样例输入 1
```plain
4
1 3
2 5
4 8
6 7
```

#### 样例输出 1
```plain
4
```

## 说明/提示

为了方便叙述，将这两个栈分别称为 A 和 B 。  
四种方案分别为：ABAA（第 $1$ 个集装箱放在 A，第 $2$ 个集装箱放在 B，以此类推），ABAB，BABA，BABB。

#### 样例输入 2
```plain
3
1 4
2 5
3 6
```

#### 样例输出 2
```plain
0
```

#### 样例输入 3
```plain
5
1 4
2 10
6 9
7 8
3 5
```

#### 样例输出 3
```plain
8
```

#### 样例输入 4
```plain
8
1 15
2 5
3 8
4 6
14 16
7 9
10 13
11 12
```

#### 样例输出 4
```plain
16
```


对于所有数据，$1\le N\le 10^6, 1\le A_i, B_i\le 2N(1\le i\le N), A_1\ldots A_N$ 和 $B_1\ldots B_N$ 这 $2N$ 个整数互不相同。

感谢 Planet6174 提供的翻译



---

---
title: "手持ち花火 (Sparklers)"
layout: "post"
diff: 省选/NOI-
pid: AT_joisc2017_c
tag: []
---

# 手持ち花火 (Sparklers)

## 题目描述

#「JOISC 2017 Day 1」烟花棒


**题目译自 [JOISC 2017](https://www.ioi-jp.org/camp/2017/2017-sp-tasks/index.html) Day1 T3「[手持ち花火](https://www.ioi-jp.org/camp/2017/2017-sp-tasks/2017-sp-d1.pdf)（[Sparklers](https://www.ioi-jp.org/camp/2017/2017-sp-tasks/2017-sp-d1-en.pdf)）」**

![JOISC17D1T3.md.png](http://www.z4a.net/images/2018/02/19/JOISC17D1T3.md.png)

有 $N$ 人站在一条数轴上。他们人手一个烟花，每人手中的烟花都恰好能燃烧 $T$ 秒。每个烟花只能被点燃一次。  
$1$ 号站在原点，$i$ 号 $(1\le i\le N)$ 到 $1$ 号的距离为 $X_i$。保证 $X_1=0,$ $X_1, X_2, \dots, X_N$ **单调**递增（可能有人位置重叠）。  
开始时， $K$ 号的烟花刚开始燃烧,，其他人的烟花均未点燃。他们的点火工具坏了，只能用燃着的烟花将未点燃的烟花点燃。当两人位置重叠且其中一人手中的烟花燃着时，另一人手中的烟花就可以被点燃。忽略点火所需时间。  
求至少需要以多快的速度跑，才能点燃所有人的烟花（此时可能有些人的烟花已经熄灭了）。**速度必须是一个非负整数。**

## 输入格式

第一行有三个整数 $N,K,T$，用空格分隔。  
在接下来的 $N$ 行中，第 $i$ 行 $(1\le i\le N)$ 有一个整数 $X_i$。

## 输出格式

一个整数，表示要想点燃所有人的烟花，全程中最大速度的最小值。

## 样例

#### 样例输入 1
```plain
3 2 50
0
200
300
```

#### 样例输出 1
```plain
2
```

#### 样例解释 1
开始时，$1$ 号向右，$2$ 号向左，$3$ 号向左。  
$50$ 秒后，$2$ 号传火给 $1$ 号 ~~我真的不是黑魂玩家~~。随后，$1$ 号和 $3$ 号继续移动。  
又过了 $25$ 秒，$1$ 号传火给 $3$ 号。

#### 样例输入 2
```plain
3 2 10
0
200
300
```

#### 样例输出 2
```plain
8
```

#### 样例解释 2
开始时，$1$ 号向右，$2$ 号向右，$3$ 号向左。  
$3$ 秒后，$2$ 号停止移动。  
又过了 $6.5$ 秒，$3$ 号到达 $2$ 号所在位置，$3$ 号停止移动。  
又过了 $0.5$ 秒，$2$ 号传火给 $3$ 号。  
又过了 $9$ 秒，$3$ 号传火给 $1$ 号。

#### 样例输入 3
```plain
20 6 1
0
2
13
27
35
46
63
74
80
88
100
101
109
110
119
138
139
154
172
192
```

#### 样例输出 3
```plain
6
```

## 说明/提示

对于 $30\%$ 的数据，$N \le 20$。  
对于 $50\%$ 的数据，$N \le 1000$。  
对于 $100\%$ 的数据，$1\le K, N \le 10^5, 1\le T\le 10^9, 0\le X_i\le 10^9 (1\le i\le N), X_1 = 0, \{X_N\}$ 单调递增。

感谢 Planet6174 提供的翻译



---

---
title: "壊れた機器 (Broken Device)"
layout: "post"
diff: 省选/NOI-
pid: AT_joisc2017_e
tag: []
---

# 壊れた機器 (Broken Device)

## 题目描述

[problemUrl]: https://atcoder.jp/contests/joisc2017/tasks/joisc2017_e





---

---
title: "鉄道旅行 (Railway Trip)"
layout: "post"
diff: 省选/NOI-
pid: AT_joisc2017_f
tag: []
---

# 鉄道旅行 (Railway Trip)

## 题目描述

#「JOISC 2017 Day 2」火车旅行


**译者水平有限，跪求各位大佬提供更好的译文**

**题目译自 [JOISC 2017](https://www.ioi-jp.org/camp/2017/2017-sp-tasks/index.html) Day2 T3「[鉄道旅行](https://www.ioi-jp.org/camp/2017/2017-sp-tasks/2017-sp-d2.pdf)（[Railway Trip](https://www.ioi-jp.org/camp/2017/2017-sp-tasks/2017-sp-d2-en.pdf)）」**

某条铁路线（非环线）有 $N$ 站，依次编号为 $1\ldots N$。这条线路上跑着 $K$ 类列车，编号为 $1\ldots K$。每种列车都是双向运行的。  
这条铁路线上的每个车站都有个旅客流量，旅客流量是一个 $\le K$ 的正整数。车站 $i(1\le i\le N)$ 的旅客流量为 $L_i$，$L_1=L_N=K$。  
第 $j$ 类列车 $(1\le j\le N)$ 在且只在旅客流量 $\ge j$ 的车站停车。
现有 $Q$ 名旅客，依次编号为 $1\ldots Q$，旅客 $k(1\le k\le Q)$ 的起点是车站 $A_k$，终点是 $B_k$ $(1\le A_k, B_k\le N)$。假设这些旅客只能靠这条铁路线移动。  
对于每个旅客，求这名旅客的途中至少要**停几次站**（不含该旅客的起终点站）。保证同一名旅客的起点与终点不同。允许走回头路。

## 输入格式

第一行有三个整数 $N, K, Q$，用空格分隔。  
在接下来的 $N$ 行中，第 $i$ 行 $(1\le i\le N)$ 有一个整数 $L_i$。  
在接下来的 $Q$ 行中，第 $k$ 行 $(1\le k\le N)$ 有两个整数 $A_k,B_k$。

## 输出格式

输出共 $Q$ 行，每行一个整数，表示旅客 $k$ 最少的停站次数。

## 样例

#### 样例输入 1
```plain
9 3 3
3
1
1
1
2
2
2
3
3
2 4
4 9
6 7
```

#### 样例输出 1
```plain
1
3
0
```

#### 样例解释 1
旅客 $1$ 从车站 $2$ 出发，可以直接坐 $1$ 类车抵达车站 $4$。中途站只有车站 $3$。  
旅客 $2$ 从车站 $4$ 出发，可以先坐 $1$ 类车到车站 $5$，再换乘 $2$ 类车坐到车站 $1$，再换乘 $3$ 类车坐到车站 $9$。中途站为车站 $5,1,8$。  
旅客 $3$ 从车站 $6$ 出发，直接坐 $1$ 类车抵达车站 $7$。

#### 样例输入 2
```plain
5 2 1
2
1
1
1
2
1 4
```

#### 样例输出 2
```plain
1
```

#### 样例解释 2
注意可以走过目的地，再走回来。

#### 样例输入 3
```plain
15 5 15
5
4
1
2
3
1
1
2
4
5
4
1
5
3
5
8 1
11 1
5 3
6 11
9 12
15 14
15 2
3 12
2 1
4 8
15 5
12 6
1 13
13 8
14 9
```

#### 样例输出 3
```plain
2
1
1
3
2
0
3
4
0
1
3
4
1
2
2
```

## 说明/提示

对于所有数据，$2\le N\le 10^5, 1\le K\le N, 1\le Q\le 10^5, 1\le L_i\le K(1\le i\le N), 1\le A_k, B_k\le N, A_k\not=B_k(1\le k\le Q)$。


感谢 Planet6174 提供的翻译



---

---
title: "細長い屋敷 (Long Mansion)"
layout: "post"
diff: 省选/NOI-
pid: AT_joisc2017_h
tag: []
---

# 細長い屋敷 (Long Mansion)

## 题目描述

#「JOISC 2017 Day 3」幽深府邸


**题目译自 [JOISC 2017](https://www.ioi-jp.org/camp/2017/2017-sp-tasks/index.html) Day3 T2「[細長い屋敷](https://www.ioi-jp.org/camp/2017/2017-sp-tasks/2017-sp-d3.pdf)（[Long Mansion](https://www.ioi-jp.org/camp/2017/2017-sp-tasks/2017-sp-d3-en.pdf)）」**

$N$ 个房间排列在一条直线上，依次编号为 $1, 2, \ldots, N$。只有编号相邻的房间才相连。相连的房间之间有上锁的门。  
从房间 $i$ 进入房间 $i+1$，或者从房间 $i+1$ 进入房间 $i$，需要类型为 $C_i$ 的钥匙 $(1\le i\le N-1)$。  
进入房间 $i$ 可以捡起房间里的所有钥匙。房间 $i$ 有 $B_i$ 把钥匙，类型分别为 $A[i][1]\dots A[i][B_i]$ 保证对于同一个 $i$，没有两个 $A[i][j]$ 相同。钥匙可以重复使用。你可能会获得相同的钥匙，然并卵。  
现在有 $Q$ 组查询，每组查询用两个整数 $x, y$ 来描述 $(x≠y)$，表示：如果有人被丢进房间 $x$，手上没有任何钥匙，此人能否到达房间 $y$（当然，此人可以捡房间 $x$ 里的钥匙）。  
对于每组查询，如果此人能到达，输出 $\texttt{YES}$，否则输出 $\texttt{NO}$ 。

## 输入格式

第一行有一个整数 $N$。  
第二行有 $N-1$ 个整数 $C_1, C_2, \dots, C_{N-1}$，用空格分隔。  
在接下来的 $N$ 行中，第 $i$ 行 $(1\le i\le N)$ 的开头有一个整数 $B_i$，后面有 $B_i$ 个整数 $A[i][1]\dots A[i][B_i]$，这 $B_i+1$ 个整数用空格分隔。  
第 $N+2$ 行有一个整数 $Q$。  
在接下来的 $Q$ 行中，第 $k$ 行 $(1\le k\le Q)$ 有两个整数 $X_k, Y_k$，表示一组查询。

## 输出格式

输出共 $Q$ 行，每行一个字符串  $\texttt{YES}$ 或 $\texttt{NO}$ ，表示此人能否到达房间 $y$。

## 样例

#### 样例输入 1
```plain
5
1 2 3 4
2 2 3
1 1
1 1
1 3
1 4
4
2 4
4 2
1 5
5 3
```

#### 样例输出 1
```plain
YES
NO
NO
YES
```

#### 样例解释 1
查询 1：可行，此人应依次到 $2, 1, 2, 3, 4$ 号房间搜刮钥匙。  
查询 2：不可行，此人只能到达 $3,4$ 号房间，只能拿到 $1,3$ 号钥匙。  
查询 3：不可行，此人无法拿到 $4$ 号钥匙。  
查询 4：可行，此人应依次到 $5, 4, 3$ 号房间搜刮钥匙。

#### 样例输入 2
```plain
5
2 3 1 3
1 3
1 2
1 1
1 3
1 2
4
1 3
3 1
4 3
2 5
```

#### 样例输出 2
```plain
NO
YES
NO
YES
```

#### 样例输入 3
```plain
7
6 3 4 1 2 5
1 1
1 5
1 1
1 1
2 2 3
1 4
1 6
3
4 1
5 3
4 7
```

#### 样例输出 3
```plain
YES
NO
YES
```

## 说明/提示

对于所有数据，$2\le N\le 5\times 10^5,$ $1\le Q\le 5\times 10^5,$ $1\le \sum B_i \le 5\times 10^5,$ $1\le B_i, C_i, A[i][j], X_k, Y_k\le N,$ $X_k≠Y_k$。

|子任务 #|分值|$N$|$Q$|$\sum B_i$|$C_i, A[i][j]$|
|-|-|-|-|-|-|
|1|5|$N\le 5000$|$Q\le 5000$|$\sum B_i \le 5000$|.|
|2|5|$N\le 5000$|.|$\sum B_i \le 5000$|.|
|3|15|$N\le 10^5$|.|.|$C_i, A[i][j]\le 20$|
|4|75|.|.|.|.|

感谢 Planet6174 提供的翻译



---

---
title: "誘拐 2 (Abduction 2)"
layout: "post"
diff: 省选/NOI-
pid: AT_joisc2017_j
tag: []
---

# 誘拐 2 (Abduction 2)

## 题目描述

#「JOISC 2017 Day 4」绑架 2


**题目译自 [JOISC 2017](https://www.ioi-jp.org/camp/2017/2017-sp-tasks/index.html) Day4 T1「[誘拐 2](https://www.ioi-jp.org/camp/2017/2017-sp-tasks/2017-sp-d4.pdf)（[Abduction 2](https://www.ioi-jp.org/camp/2017/2017-sp-tasks/2017-sp-d4-en.pdf)）」**

某地的道路网可视为由 $H$ 条东西向道路与 $W$ 条南北向道路构成的网格，相邻的两条平行道路之间的距离为 $1 \:\textrm{km}$。东西向道路从北到南依次编号为 $ 1\ldots H $，南北向道路从西到东依次编号为 $ 1\ldots W $ 。   
东西向道路和南北向道路相交形成路口，规定 $ x $ 号南北向街道和 $ y $ 号东西向街道形成的路口的坐标是 $ (x, y) $ 。  
每条道路有一个车流指数。$i$ 号东西向道路 $(1\le i\le H)$ 的车流指数为 $A_{\;\!i}$ ，$j$ 号南北向道路 $(1\le j\le W)$ 的车流指数为 $B_j$ 。所有道路的车流指数互不相同。

给出 $Q$ 个互不相同的坐标 $(S_1, T_1), (S_2, T_2),\ldots,(S_Q, T_Q)$ 作为备选起点。对于每个备选起点，请计算：如果按照下述规则移动，最多可以移动多远。  
- 移动开始时，可以任意选择方向。
- 当到达十字路口时：
  * 如果 直行方向的道路的车流指数 比 该十字路口的另一条道路的车流指数 小，就转弯。你可以选择左转还是右转。但如果你在城市边界上，可能只能左转/右转。
  * 如果 直行方向的道路的车流指数 比 该十字路口的另一条道路的车流指数 大，就直行。但如果前面没路（比如到了城市边界），就只能停在此处。
  * 不能掉头。

## 输入格式

第一行有三个整数 $H, W, Q$ ，用空格分隔。  
第二行有 $H$ 个整数 $A_1 \ldots A_H$ ，用空格分隔。  
第三行有 $W$ 个整数 $B_1 \ldots B_W$ ，用空格分隔。  
在接下来的 $Q$ 行中，第 $k$ 行 $(1\le k\le Q)$ 有两个用空格分隔的整数 $S_k, T_k$ 。

## 输出格式

输出共 $Q$ 行，第 $i$ 行 $(1\le i\le Q)$ 有一个整数，表示以 $(S_i, T_i)$ 为起点，按照所给规则移动，最多可以移动多远。

## 样例

#### 样例输入 1
```plain
3 3 5
3 2 6
1 4 5
1 1
1 2
2 2
3 1
3 3
```

#### 样例输出 1
```plain
4
5
4
4
2
```

#### 样例解释 1
例如，对于 $(S_3, T_3) = (2, 2)$，最多可以移动 $4\:\textrm{km}$ 。
- 从 $(2, 2)$ 向东移动 $1 \:\textrm{km}$ ，到达 $(2, 3)$ 。
- 在 $(2, 3)$ 可以左转或右转。在 $(2, 3)$ 左转，向南移动 $1 \:\textrm{km}$ ，到达 $(3, 3)$ 。
- 在 $(3, 3)$ 只能右转。在 $(3, 3)$ 右转，向西移动 $1 \:\textrm{km}$ ，到达 $(3, 2)$ 。
- 在 $(3, 2)$ 只能直行。向西移动 $1 \:\textrm{km}$ ，到达 $(3, 1)$ 。
- 在 $(3, 1)$ 无法移动。

#### 样例输入 2
```plain
4 5 6
30 10 40 20
15 55 25 35 45
1 3
4 3
2 2
4 1
2 5
3 3
```

#### 样例输出 2
```plain
7
6
9
4
6
9
```

## 说明/提示

$2 \le H, W \le 5\times 10^4, 1\le Q\le 100,$ $1\le A_i, B_j\le 10^9(1\le i\le H, 1\le j\le W),$ $1\le S_k\le H, 1\le T_k\le W(1\le k\le Q)$ 。  
保证所有道路的车流指数互不相同，所有的备选起点互不相同。

|Subtask #|分值|$H,W$|$Q$|
|-|-|-|-|
|1|13|$H,W\le 8$|$Q=1$|
|2|10|$H,W\le 2000$|$Q=1$|
|3|17|$H, W \le 5\times 10^4$|$Q=1$|
|4|4|$H,W\le 2000$|$Q\le 100$|
|5|56|$H, W \le 5\times 10^4$|$Q\le 100$|

感谢 Planet6174 提供的翻译



---

---
title: "高速道路の建設 (Construction of Highway)"
layout: "post"
diff: 省选/NOI-
pid: AT_joisc2018_a
tag: []
---

# 高速道路の建設 (Construction of Highway)

## 题目描述

[problemUrl]: https://atcoder.jp/contests/joisc2018/tasks/joisc2018_a





---

---
title: "修行 (Asceticism)"
layout: "post"
diff: 省选/NOI-
pid: AT_joisc2018_d
tag: []
---

# 修行 (Asceticism)

## 题目描述

[problemUrl]: https://atcoder.jp/contests/joisc2018/tasks/joisc2018_d



---

---
title: "最悪の記者 3 (Worst Reporter 3)"
layout: "post"
diff: 省选/NOI-
pid: AT_joisc2018_f
tag: []
---

# 最悪の記者 3 (Worst Reporter 3)

## 题目描述

[problemUrl]: https://atcoder.jp/contests/joisc2018/tasks/joisc2018_f





---

---
title: "ビ太郎のパーティー (Bitaro&#39;s Party)"
layout: "post"
diff: 省选/NOI-
pid: AT_joisc2018_h
tag: []
---

# ビ太郎のパーティー (Bitaro&#39;s Party)

## 题目描述

## 题目背景

![](https://cdn.luogu.com.cn/upload/image_hosting/cqzxwjey.png)


给定含有 $n$ 个点 $m$ 条单向边的有向图，每条边的边权值都为 $1$。

给定 $q$ 次询问，第 $i$ 次询问给定一个点 $T_i$，其中有 $Y_i$ 个点无法前往 $T_i$；假定剩下的点都会前往 $T_i$，询问剩余的点中距离 $T_i$ 最远距离是多少。

## 输入格式

第 $1$ 行：包含 $3$ 个整数 $n,m,q$。

接下来 $m$ 行：第 $i$ 行包含 $2$ 个整数 $u_i,v_i$，表示 $u_i,v_i$ 之间有条权值为 $1$ 的单向边。

接下来 $q$ 行：第 $i$ 行前 $2$ 个整数为 $T_i,Y_i(T_i\in[1,n],Y_i\in[0,n])$，后面有 $Y_i$ 个整数 $C_{i,1},C_{i,2}\dots C_{i,Y_i}$，集合 $\{C_i\}$ 表示第 $i$ 组询问中无法前往 $T_i$ 的点。**询问之间相互独立**。

## 输出格式

共 $q$ 行：第 $i$ 行有 $1$ 个整数，代表剩余的点中距离 $T_i$ 的最远距离；若剩余的点中没有可以到达 $T_i$ 的点，输出 $-1$。

## 样例 #1

### 样例输入 #1

```
5 6 3
1 2
2 4
3 4
1 3
3 5
4 5
4 1 1
5 2 2 3
2 3 1 4 5
```

### 样例输出 #1

```
1
3
0
```

## 样例 #2

### 样例输入 #2

```
12 17 10
1 2
2 3
3 4
1 5
2 6
3 7
4 8
5 6
6 7
7 8
5 9
6 10
7 11
8 12
9 10
10 11
11 12
6 3 1 7 12
3 7 1 2 3 4 5 6 7
11 3 1 3 5
9 2 1 9
8 4 1 2 3 4
1 1 1
12 0
10 3 1 6 10
11 8 2 3 5 6 7 9 10 11
8 7 2 3 4 5 6 7 8
```

### 样例输出 #2

```
1
-1
3
1
3
-1
5
2
4
4
```

## 说明/提示

$1\leqslant{n}\leqslant10^5,0\leqslant{m}\leqslant2\times10^5,1\leqslant{q}\leqslant10^5,(\sum_{i=1}^{q}{Y_i})\leqslant10^5$。



---

---
title: "飴 (Candies)"
layout: "post"
diff: 省选/NOI-
pid: AT_joisc2018_j
tag: []
---

# 飴 (Candies)

## 题目描述

[problemUrl]: https://atcoder.jp/contests/joisc2018/tasks/joisc2018_j

桌子上有从 $1$ 到 $n$ 的糖排列着，每一块糖都有一个美味值 $a_{i}$，不能同时吃相邻的两颗糖，你需要求出当吃 $1,2,3……\left \lceil \frac{n}{2} \right \rceil $ 颗糖时能够得到的美味值的和的最大值。

## 输入格式

第一行为一个正整数 $n$。

接下来 $n$ 行，每行一个数，代表第 $i$ 颗糖的美味值 $a_{i}$。

## 输出格式

一共有 $\left \lceil \frac{n}{2} \right \rceil $ 行，分别表示当吃 $1,2,3……\left \lceil \frac{n}{2} \right \rceil $ 颗糖时美味值的和的最大值。

## 说明/提示

所有数据满足以下限制：

$1\le n\le 2\times 10^{5}$

$1\le a_{i}\le 10^{9}$

其中 $8\%$ 的数据满足：$1\le n\le 2000$

其余测试点无特殊限制。

**【样例解释 \#1】**

只吃一颗糖选第四个美味值为 $7$ 为最大值。

吃两颗糖选第二个和第四个最优，美味值为 $5+7=12$。

吃三颗糖由于不能吃相邻的两颗糖所以只能选第一个，第三个和第五个，美味值为 $3+1+6=10$。

## 样例 #1

### 输入

```
5
3
5
1
7
6
```

### 输出

```
7
12
10
```

## 样例 #2

### 输入

```
20
623239331
125587558
908010226
866053126
389255266
859393857
596640443
60521559
11284043
930138174
936349374
810093502
521142682
918991183
743833745
739411636
276010057
577098544
551216812
816623724
```

### 输出

```
936349374
1855340557
2763350783
3622744640
4439368364
5243250666
5982662302
6605901633
7183000177
7309502029
```



---

---
title: "図書館 (Library)"
layout: "post"
diff: 省选/NOI-
pid: AT_joisc2018_k
tag: []
---

# 図書館 (Library)

## 题目描述

[problemUrl]: https://atcoder.jp/contests/joisc2018/tasks/joisc2018_k

C++ を使用する場合は問題文の指示に従ってください．

このジャッジは C++ 以外にも対応しています．C++ 以外の言語を使用する場合，ジャッジとのやり取りには関数ではなく標準入出力を使用します．以下の指示に従ってください．

#### C++ 以外の言語の実装の詳細

まず，整数 $ N $ が標準入力により与えられます．

Query 関数を呼び出したい場合には，標準出力に `Query` と出力して改行したのち， $ N $ 個の整数を空白区切りで出力して改行してください．flush を忘れないでください．

Answer 関数を呼び出したい場合には，標準出力に `Answer` と出力して改行したのち， $ N $ 個の整数を空白区切りで出力して改行してください．flush を忘れないでください．

不正解 $ 1 $ は TLE ，不正解 $ 2 $ は WA ，不正解 $ 3 $ は WA ，不正解 $ 4 $ は TLE ，不正解 $ 5 $ は WA ，不正解 $ 6 $ は WA ，不正解 $ 8 $ は WA と判定されます．Answer 関数が呼び出されるとジャッジは終了するため， $ N $ 個の整数を出力したのちに余計なものを出力しても判定には影響しません．



---

---
title: "試験 (Examination)"
layout: "post"
diff: 省选/NOI-
pid: AT_joisc2019_a
tag: []
---

# 試験 (Examination)

## 题目描述

[problemUrl]: https://atcoder.jp/contests/joisc2019/tasks/joisc2019_a





---

---
title: "ビーバーの会合 (Meetings)"
layout: "post"
diff: 省选/NOI-
pid: AT_joisc2019_b
tag: []
---

# ビーバーの会合 (Meetings)

## 题目描述

[problemUrl]: https://atcoder.jp/contests/joisc2019/tasks/joisc2019_b

C++ を使用する場合は問題文の指示に従ってください．

このジャッジは C++ 以外にも対応しています．C++ 以外の言語を使用する場合，ジャッジとのやり取りには関数ではなく標準入出力を使用します．以下の指示に従ってください．

#### C++ 以外の言語の実装の詳細

まず， `Start` と出力して改行してください．flush を忘れないでください．

整数 $ N $ が標準入力により与えられます．

Query 関数を呼び出したい場合には，標準出力に `Query` と出力して改行したのち， $ 3 $ 個の整数を空白区切りで出力して改行してください．flush を忘れないでください．その後標準入力から戻り値を受け取ってください．

Bridge 関数を呼び出したい場合には，標準出力に `Bridge` と出力して改行したのち， $ 2 $ 個の整数を空白区切りで出力して改行してください．flush を忘れないでください．

最後に `End` と出力して改行してください．flush を忘れないでください．



---

---
title: "ナン (Naan)"
layout: "post"
diff: 省选/NOI-
pid: AT_joisc2019_c
tag: []
---

# ナン (Naan)

## 题目描述

**题目译自 [JOISC 2019](https://www.ioi-jp.org/camp/2019/2019-sp-tasks/index.html) Day1 T3「[ナン](https://www.ioi-jp.org/camp/2019/2019-sp-tasks/day1/naan.pdf) / [Naan](https://www.ioi-jp.org/camp/2019/2019-sp-tasks/day1/naan-en.pdf)」**

JOI 咖喱店以提供很长（？）的馕而闻名。它提供的馕有 $L$ 种口味，编号从 $1$ 到 $L$。「JOI 特色馕」是店内最受欢迎的一道菜。馕的总长度为 $L$ 厘米。我们定义「点 $X$」为馕上距离馕左端 $X$ 厘米处的点。对于 $1 \le j \le L$，点 $j-1$ 和点 $j$ 间的一段馕是第 $j$ 种口味的。

有 $N$ 个人来到了 JOI 咖喱店，他们每个人的偏好都不同，具体的说，第 $i$ 个人每吃一厘米的风味 $j$ 的馕，就会获得 $V_{i,j}$ 的快乐度。

他们只买了一个 JOI 特色馕，他们将用下面的方式分享馕：

1. 选择 $N-1$ 个分数 $X_1, \ldots, X_{N-1}$，满足 $0 < X_1 < X_2 < \ldots < X_{N-1} < L$。
2. 选择 $N$ 的一个排列 $P_1, \ldots P_N$。
3. 对于每一个 $k (1 \le k \le N-1)$，在点 $X_k$ 的位置切一刀，然后馕将被切成 $N$ 个部分。
4. 第 $k (1 \le k \le N)$ 个部分的左端点为 $X_{k-1}$，右端点为 $X_{k}$，这里我们认为 $X_0=0, X_N=L$。
5. 第 $P_i$ 个人将吃掉第 $i$ 个部分。

现在他们想公平的分配馕，他们认为一种分配方法是公平的，当且仅当每个人获得的快乐度都不小于他们独吞整个馕所获得的快乐度的 $\frac{1}{N}$。

现在给你 $N$ 个人的信息，你需要判断是否存在一种公平的分配方式，如果存在，输出一组分配方案。

## 输入格式

从标准输入中读取数据。

第一行两个整数 $N, L$。  
接下来 $N$ 行，每行 $L$ 个整数，第 $i$ 行第 $j$ 个数为 $V_{i,j}$。

## 输出格式

输出数据到标准输出中。

如果无解，输出一行 `-1`；

如果有解，首先输出 $N-1$ 行，第 $i$ 行两个整数 $A_i, B_i$，要求 $A_i, B_i$ 是一对满足 $X_i = \frac{A_i}{B_i} (1 \le i \le N)$ 的整数对。

接下来一行 $N$ 个整数，第 $i$ 个数表示 $P_i$。

你的输出需要满足：
* $1 \le B_i \le 10^9 (1 \le i \le N)$。
* $0 <  \frac{A_1}{B_1} < \frac{A_2}{B_2} < ... < \frac{A_{N-1}}{B_{N-1}} < L$。
* $P_1, ... ,P_N$ 是一个 $1, ..., N$ 的排列。
* 第 $i$ 个人获得的总快乐度不小于 $\frac{V_{i,1}+V_{i,2}+...+V_{i,L}}{N} (1 \le i \le N)$。
* $A_i, B_i$ 不必互质。

可以证明，如果输入数据有解，那么一定存在一组满足上述条件的解。

## 说明/提示

### 样例解释 1

在这组样例中，第一个人如果吃掉整个馕，会得到 $2+7+1+8+2=20​$ 的快乐度，第二个人如果吃掉整个馕，会获得 $3+1+4+1+5=14​$ 的快乐度。因此，如果第一个人获得不小于 $\frac{20}{2}=10​$ 的快乐度，且第二个人获得不小于 $\frac{14}{2}=7​$ 的快乐度，就是一组合法的解。

如果在点 $\frac{14}{5}$ 的位置切一刀，第一个人会获得 $1 \times \frac{1}{5} + 8 + 2 = \frac{51}{5}$ 的快乐度，第二个人会获得 $3+1+4 \times \frac{4}{5} = \frac{36}{5}$ 的快乐度。因此这是一组合法的解。

### 样例解释 2

在这组样例中，馕只有一种风味。只要把馕七等分，就是合法的方案，与 $P_1, ..., P_N$ 无关。

### 样例解释 3

注意 $A_i, B_i (1 \le i \le N)$ 不必互质。

### 数据范围

|Subtask #|分值| 数据规模 |
|-|-|-|
|1|5| $N = 2$ |
|2|24|$N \le 6,V_{i,j} \le 10 (1 \le i \le N,1 \le j \le L)$|
|3|71| 无特殊限制 |

对于所有输入数据，有 $1 \le N \le 2000,1 \le L \le 2000, 1 \le V_{i,j} \le 10^5 (1 \le i \le N,1 \le j \le L)$。

翻译来自于 [LibreOJ](https://loj.ac/p/3032)。

## 样例 #1

### 输入

```
2 5
2 7 1 8 2
3 1 4 1 5
```

### 输出

```
14 5
2 1
```

## 样例 #2

### 输入

```
7 1
1
2
3
4
5
6
7
```

### 输出

```
1 7
2 7
3 7
4 7
5 7
6 7
3 1 4 2 7 6 5
```

## 样例 #3

### 输入

```
5 3
2 3 1
1 1 1
2 2 1
1 2 2
1 2 1
```

### 输出

```
15 28
35 28
50 28
70 28
3 1 5 2 4
```



---

---
title: "ふたつの料理 (Two Dishes)"
layout: "post"
diff: 省选/NOI-
pid: AT_joisc2019_e
tag: []
---

# ふたつの料理 (Two Dishes)

## 题目描述

有两道菜 $A$ 和 $B$，分别有 $n$ 道和 $m$ 个步骤，时间从 $0$ 时刻开始。每个步骤都有三个参数 $t,e,c$ 表示该步骤需要 $t$ 时间完成，若其在 $e$ 时刻前完成，则你获得 $c$ 的分数，$c_i$ 可能为负。

你需要决策进行步骤的次序，每时每刻都只能进行一个步骤；每个步骤都必须连续进行，不能拆开；同时要求每道菜内部都必须按照顺序进行，两道菜菜之间互不影响，求最大分数和。

$1\le n,m\le 10^6$，$1\le t_i\le 10^9$，$1\le e_i\le 2\times 10^{15}$，$|c_i|\le 10^9$。

## 输入格式

第一行两个正整数 $n,m$。

接下来 $n$ 行，每行三个整数，第 $i$ 行三个正整数 $ta_i,ea_i,ca_i$，顺序描述 A 的步骤。

接下来 $m$ 行，每行三个整数，第 $i$ 行三个正整数 $tb_i,eb_i,cb_i$，顺序描述 B 的步骤。

## 输出格式

输出一行一个整数表示答案。

### 样例1

```
4 3
2 1 1
3 8 1
2 13 1
1 13 1
3 6 1
2 11 1
2 15 1
```

```
6
```

### 样例2

```
5 7
16 73 16
17 73 10
20 73 1
14 73 16
18 73 10
3 73 2
10 73 7
16 73 19
12 73 4
15 73 15
20 73 14
15 73 8
```

```
63
```

### 样例3

```
9 11
86 565 58
41 469 -95
73 679 28
91 585 -78
17 513 -63
48 878 -66
66 901 59
72 983 -70
68 1432 11
42 386 -87
36 895 57
100 164 10
96 812 -6
23 961 -66
54 193 51
37 709 82
62 148 -36
28 853 22
15 44 53
77 660 -19
```

```
99
```



---

---
title: "指定都市 (Designated Cities)"
layout: "post"
diff: 省选/NOI-
pid: AT_joisc2019_g
tag: []
---

# 指定都市 (Designated Cities)

## 题目描述

[problemUrl]: https://atcoder.jp/contests/joisc2019/tasks/joisc2019_g





---

---
title: "時をかけるビ太郎 (Bitaro, who Leaps through Time)"
layout: "post"
diff: 省选/NOI-
pid: AT_joisc2019_i
tag: []
---

# 時をかけるビ太郎 (Bitaro, who Leaps through Time)

## 题目描述

[problemUrl]: https://atcoder.jp/contests/joisc2019/tasks/joisc2019_i





---

---
title: "ケーキの貼り合わせ (Cake 3)"
layout: "post"
diff: 省选/NOI-
pid: AT_joisc2019_j
tag: []
---

# ケーキの貼り合わせ (Cake 3)

## 题目描述

[problemUrl]: https://atcoder.jp/contests/joisc2019/tasks/joisc2019_j



## 样例 #1

### 输入

```
5 3
2 1
4 2
6 4
8 8
10 16
```

### 输出

```
6
```

## 样例 #2

### 输入

```
8 4
112103441 501365808
659752417 137957977
86280801 257419447
902409188 565237611
965602301 689654312
104535476 646977261
945132881 114821749
198700181 915994879
```

### 输出

```
2323231661
```



---

---
title: "ジョイッターで友だちをつくろう (Making Friends on Joitter is Fun)"
layout: "post"
diff: 省选/NOI-
pid: AT_joisc2020_e
tag: []
---

# ジョイッターで友だちをつくろう (Making Friends on Joitter is Fun)

## 题目描述

Joitter 是一款社交软件，已经有 $n$ 个人正在使用，都没有互相关注。从现在起的 $m$ 天内，每天会有用户 ${A_i}$ 关注用户 $B_i$ 的事件。官方准备在这 $m$ 天中举办一个活动，此活动的内容是：如果存在 3 个用户 $x$ , $y$ , $z$ 其中 $x$ 关注了 $y$ 但没有关注 $z$ ，同时 $y$ 与 $z$ 互相关注，那么让用户 $x$ 关注用户 $z$ ，重复进行直到不再存在这样的用户。

------------
官方还没有开始举行这个活动，官方想知道 $\forall i \in [1,m] $ 若活动在第 $i$ 天开始，活动结束后每个用户关注其他用户数量和的最大值是多少。

------------

## 输入格式

第一行是两个整数 $n$ 和 $m$ ;
接下来 $m$ 行，每行输入两个整数 $A_i$ , $B_i$ 。

------------

## 输出格式

输出共 $m$ 行，第 $i$ 行输出若活动在第 $i$ 天开始，活动结束后每个用户关注其他用户数量和的最大值是多少。


------------

## 说明/提示

【数据约定】
对于所有数据， $1\le n \le 10^5$ , $1 \le m \le 3*10^5 $ ，保证 :

- $ 1 \le A_i , B_i \le n (1 \le i \le m) $;
- $ A_i \neq B_i (1 \le i \le m) $;
- $ (A_i , B_i) \neq ( A_j , B_j) (1 \le i \le m) $。



---

---
title: "星座 3 (Constellation 3)"
layout: "post"
diff: 省选/NOI-
pid: AT_joisc2020_g
tag: []
---

# 星座 3 (Constellation 3)

## 题目描述

[problemUrl]: https://atcoder.jp/contests/joisc2020/tasks/joisc2020_g





---

---
title: "迷い猫 (Stray Cat)"
layout: "post"
diff: 省选/NOI-
pid: AT_joisc2020_i
tag: []
---

# 迷い猫 (Stray Cat)

## 题目描述

[problemUrl]: https://atcoder.jp/contests/joisc2020/tasks/joisc2020_i

配布ファイルは [こちら](https://www.ioi-jp.org/camp/2020/2020-sp-tasks/index.html) ．

C++ を使用する場合，`stray.h` を include し，すべての関数を 1 つのファイル内で実装してください．AtCoder の仕様上グローバル変数の共有が可能ですが，自粛してください．

このジャッジは C++ 以外に対応していません．



---

---
title: "首都 (Capital City)"
layout: "post"
diff: 省选/NOI-
pid: AT_joisc2020_j
tag: []
---

# 首都 (Capital City)

## 题目描述

JOI 国拥有 $N$ 个城镇，编号为 $1$ 到 $N$，这些城镇由 $N-1$ 条双向道路连接。

JOI 国还拥有 $K$ 个城市，编号为 $1$ 到 $K$，第 $i$ 个城镇属于第 $C_i$ 个城市。

现在 JOI 国的总理 JOI 君 114514 世要挑选一个城市作为首都，从首都中的任一个城镇到达另一个首都中的城镇可以只经过首都中的城镇，但这明显是不合理的。

所以 JOI 君 114514 世要进行合并城市，合并城市 $x$ 和城市 $y$ 就会把城市 $y$ 里的所有小镇归为城市 $x$。

求能找到首都的最小合并次数。

## 输入格式

第一行两个整数 $N,K$ 代表城镇数和城市数。    
接下来 $N-1$ 行每行两个整数 $u,v$ 代表一条双向边。   
接下来 $N$ 行第 $i$ 行一个整数 $C_i$ 代表第 $i$ 个城镇属于第 $C_i$ 个城市。

## 输出格式

一行一个整数代表最小的合并次数。

### 样例 #1

#### 样例输入 #1

```
6 3
2 1
3 5
6 2
3 4
2 3
1
3
1
2
3
2
```

#### 样例输出 #1

```
1
```

### 样例 #2

#### 样例输入 #2

```
8 4
4 1
1 3
3 6
6 7
7 2
2 5
5 8
2
4
3
1
1
2
3
4
```

#### 样例输出 #2

```
1
```

### 样例 #3

#### 样例输入 #3

```
12 4
7 9
1 3
4 6
2 4
10 12
1 2
2 10
11 1
2 8
5 3
6 7
3
1
1
2
4
3
3
2
2
3
4
4
```

#### 样例输出 #3

```
2
```

## 说明/提示

#### 样例 1 解释

可以将城市 $1$ 和 $3$ 合并，然后选择城市 $1$ 作为首都。

#### 子任务

|子任务|特殊性质|分数|
|:-:|:-:|:-:|
|$1$|$N \le 20$|$1$|
|$2$|$N \le 2000$|$10$|
|$3$|每个城镇最多与两个城镇相连|$30$|
|$4$|无|$59$|

对于 $100\%$ 的数据，$1 \le K,u,v \le N \le 2 \times 10^5$，保证从任何一个城镇出发都能到达其他城镇，$1 \le C_i \le K$。


翻译自 [第１９回日本情報オリンピック　春季トレーニング合宿](https://www.ioi-jp.org/camp/2020/2020-sp-tasks/index.html) [Day4 A 首都](https://www.ioi-jp.org/camp/2020/2020-sp-tasks/day4/capital_city.pdf)。



---

---
title: "フードコート (Foodcourt)"
layout: "post"
diff: 省选/NOI-
pid: AT_joisc2021_c
tag: []
---

# フードコート (Foodcourt)

## 题目描述

translate from P7560，copied by @[Network_Error](https://www.luogu.com.cn/user/534654) 


有 $N$ 家书虫食品店，有 $M$ 个家庭来享受用书虫制作的美味食物。

因为食品店十分火爆，所以顾客需要排队，刚开始所有队列都是空的。

今天食品店又全部开张了，发生了 $Q$ 个事件：

- **加入事件**：编号位于区间 $[L,R]$ 内的所有食品店中，都有编号为 $C$ 的家庭加入队尾，每个满足要求的食品店队尾都加入了 $K$ 个人。
- **离开事件**：编号位于区间 $[L,R]$ 内的所有食品店中，如果队列有超过 $K$ 个人，那么队列的前 $K$ 个人离开队列，否则队列里的所有人离开队列。
- **白嫖事件**：如果编号为 $A$ 的食品店的队列中有大于等于 $B$ 个人，那么食品店就会赠送从队列开头开始数第 $B$ 个人一份秘制书虫，否则店员会吃掉书虫。

求每次 **白嫖事件** 是否有顾客被赠送了秘制书虫，如果有的话，求顾客所在的家庭。

## 输入格式

第一行三个整数 $N,M,Q$ 代表食品店个数，家庭个数和事件个数。

接下来 $Q$ 行，每行首先一个整数 $T$：

- $T=1$，接下来四个整数 $L,R,C,K$ 描述 **加入事件**。
- $T=2$，接下来三个整数 $L,R,K$ 描述 **离开事件**。
- $T=3$，接下来两个整数 $A,B$ 描述 **白嫖事件**。

## 输出格式

对于所有 **白嫖事件**，一行一个整数：

- 如果有顾客被送了秘制书虫，输出他所在的家庭。
- 如果店员吃掉了书虫，输出 $0$。

### 样例 #1

#### 样例输入 #1

```
3 5 7
1 2 3 5 2
1 1 2 2 4
3 2 3
2 1 3 3
3 1 2
1 2 3 4 2
3 3 2
```

#### 样例输出 #1

```
2
0
4
```

### 样例 #2

#### 样例输入 #2

```
3 4 7
1 1 2 1 1
1 1 3 4 1
2 2 3 1
2 1 3 1
1 1 2 2 1
3 1 1
3 3 2
```

#### 样例输出 #2

```
4
0
```

### 样例 #3

#### 样例输入 #3

```
183326 218318 22
1 106761 160918 151683 574906362
3 68709 1
1 29240 156379 22166 957318472
1 14054 181502 82845 97183925
2 112033 122908 587808357
2 57819 160939 215041262
3 36674 524274467
1 35854 69866 32334 322730299
1 1384 7230 115069 454256926
1 44192 158235 8750 84192710
3 54457 1077490708
2 10592 110384 979714505
2 44594 79244 311724477
3 160965 97183926
1 88748 101697 39148 373927458
3 41166 58039001
1 91501 137591 205480 958877326
2 77775 169655 135756956
1 12497 57047 60918 15666764
1 47839 51716 144688 732270998
3 114514 774994894
3 48645 169986425
```

#### 样例输出 #3

```
0
22166
32334
0
82845
8750
60918
```

## 说明/提示

#### 样例 1 解释

我们用 $Q_i(a_1,a_2,\cdots,a_k)$ 代表第 $i$ 个食品店的队列，$a_1$ 为队首，$a_k$ 为队尾，其中 $a_i=p$ 就代表第 $i$ 个位置的人来自第 $p$ 个家庭。特殊地，$Q_i()$ 就代表当前队列为空。

根据样例 1 的这几个事件：

- 第 $1$ 个 **加入事件**：

$$Q_1(),Q_2(5,5),Q_3(5,5)$$

- 第 $2$ 个 **加入事件**：

$$Q_1(2,2,2,2),Q_2(5,5,2,2,2,2),Q_3(5,5)$$

- 第 $3$ 个 **白嫖事件**，第 $2$ 个食品店的第 $3$ 个人（第 $2$ 个家庭）被送上秘制书虫。
- 第 $4$ 个 **离开事件**：

$$Q_1(2),Q_2(2,2,2),Q_3()$$

- 第 $5$ 个 **白嫖事件**，第 $1$ 个食品店不够 $2$ 个人，店员会吃掉书虫。
- 第 $6$ 个 **加入事件**：

$$Q_1(2),Q_2(2,2,2,4,4),Q_3(4,4)$$

- 第 $7$ 个 **白嫖事件**，第 $3$ 个食品店的第 $2$ 个人（第 $4$ 个家庭）被送上秘制书虫。

#### 数据规模与约定

对于 $100\%$ 的数据：

- $1 \le N,M,Q \le 25 \times 10^4$。
- $T \in \{1,2,3\}$。
- 对于所有 **加入事件**，$1 \le L \le R \le N$，$1 \le C \le M$，$1 \le K \le 10^9$。
- 对于所有 **离开事件**，$1 \le L \le R \le N$，$1 \le K \le 10^9$。
- 对于所有 **白嫖事件**，$1 \le A \le N$，$1 \le B \le 10^{15}$。
- 至少有一个 **白嫖事件**。

有以下若干个性质：

- 性质 A：对于所有 **加入事件** 和 **离开事件**，有 $K=1$。
- 性质 B：对于所有 **加入事件**，有 $R-L \le  10$ 和 $K=1$。
- 性质 C：只有 **加入事件** 和 **白嫖事件**。


翻译自 [第２０回日本情報オリンピック　春季トレーニング合宿](https://www.ioi-jp.org/camp/2021/2021-sp-tasks/index.html) [Day1 C フードコート (Food Court) 的英文版本](https://www.ioi-jp.org/camp/2021/2021-sp-tasks/day1/foodcourt-en.pdf)。



---

---
title: "道路の建設案 (Road Construction)"
layout: "post"
diff: 省选/NOI-
pid: AT_joisc2021_e
tag: []
---

# 道路の建設案 (Road Construction)

## 题目描述

JOI 国是一个 $x\times y$ 的二维平面，王国里有 $n$ 个城镇，分别编号为 $1, 2, \cdots, n$，其中第 $i$ 个城镇的 **坐标** 为 $(x_i, y_i)$。

在 JOI 国，正计划修建连接两座城镇的路（下文简称：**「修路的项目」**），路有 $k$ 条。连接两个不同的城镇 $a$ 和 $b$ 将花费 $|x_a − x_b| + |y_a − y_b|$ 元。若有一条连接 $c$，$d$ 的路，则不需要也不可以在建一条连接 $d$，$c$ 的路，因为它们是相同的。

你要管理这个「修路的项目」，为了计算花费情况，你得弄明白连接一些城镇所需的花费。在这 $\dfrac{n\cdot(n-1)}{2}$ 条道路中，你想了解最便宜的 $k$ 条道路的花费。

给你城镇的坐标以及 $k$，请计算最便宜的 $k$ 条路所需要的钱。


接下来的第 $2 \sim n+1$ 行，每行 $2$ 个正整数，分别是 $x_i$ 和 $y_i$，其中 $1\le i \le n$，表示第 $i$ 个城镇的坐标。

## 输入格式

输入数据共 $n+1$ 行。

## 输出格式

输入数据共 $k$ 行。

对于第 $k$ 行，有一个整数表示第 $k$ 便宜的路需要的日元。

## 样例 #1

### 样例输入 #1

```
3 2
-1 0
0 2
0 0
```

### 样例输出 #1

```
1
2
```

## 样例 #2

### 样例输入 #2

```
5 4
1 -1
2 0
-1 0
0 2
0 -2
```

### 样例输出 #2

```
2
2
3
3
```

## 样例 #3

### 样例输入 #3

```
4 6
0 0
1 0
3 0
4 0
```

### 样例输出 #3

```
1
1
2
3
3
4
```

## 样例 #4

### 样例输入 #4

```
10 10
10 -8
7 2
7 -8
-3 -6
-2 1
-8 6
8 -1
2 4
6 -6
2 -1
```

### 样例输出 #4

```
3
3
4
5
6
6
6
7
7
7
```

## 说明/提示

#### 样例 #1 解释
有 $\dfrac{3 \times 2}{2} = 3$ 种方案。

- 城镇 $1 \to$ 城镇 $2$，$|(-1)-0|+|0-2| = 3$ 日元。
- 城镇 $1 \to$ 城镇 $3$，$|(-1)-0|+|0-0| = 1$ 日元。
- 城镇 $2 \to$ 城镇 $3$，$|0-0|+|2-0| = 2$ 日元。

将其进行排序为 $1,2,3$，所以输出是 $1$ 和 $2$。

本样例满足 Subtask $1, 4, 5, 6$。

#### 样例 #2 解释

有 $\dfrac{5 \times 4}{2} = 10$ 种方案。

将钱数排序后是 $2, 2, 3, 3, 3, 3, 4, 4, 4, 4$。

本样例满足 Subtask $1, 4, 5, 6$。

#### 样例 #3 解释

本样例满足 Subtask $1, 2, 4, 5, 6$。

#### 样例 #4 解释

本样例满足 Subtask $1, 4, 5, 6$。

#### 数据范围与约定

对于 $100\%$ 的数据：
- $2 \le n \le 2.5 \times 10^5$；
- $1 \le k \le \min(2.5\times 10^5,\ \dfrac{n\cdot(n-1)}{2}$)；
- $-10^9 \le x_i, y_i \le 10^9$，且 $1 \le i \le n$；
- $(x_i,y_i)\not = (x_j, y_j)$ 且 $1 \le i < j \le n$。


本题译自 [第２０回日本情報オリンピック 2020/2021春季トレーニング合宿 -](https://www.ioi-jp.org/camp/2021/2021-sp-tasks/index.html) [競技 2 -](https://www.ioi-jp.org/camp/2021/2021-sp-tasks/day2/2021-sp-d2-notice.pdf) [T2 日文题面](https://www.ioi-jp.org/camp/2021/2021-sp-tasks/day2/road_construction.pdf)。



---

---
title: "ビーバーの会合 2 (Meetings 2)"
layout: "post"
diff: 省选/NOI-
pid: AT_joisc2021_j
tag: []
---

# ビーバーの会合 2 (Meetings 2)

## 题目描述

给出一棵大小为 $N$ 的树。

对于树上的一个点集 $S$，定义其权值为满足 $\sum\limits_{u\in S} dis(u,x)$ 取到最小值的 $x$ 的数量。

对于每一个 $1\le i \le N$，求出当点集大小为 $i$ 时的最大权值。

$1\le N \le 2\times 10^5$

## 输入格式

第一行一个正整数 $n$ 表示树的大小。

接下来 $n-1$ 行，每行两个数 $u,v$ 表示树的一条边。

## 输出格式

输出 $n$ 行，第 $i$ 行输出一个数表示当点集大小为 $i$ 时的最大权值。

## 样例 #1

### 输入

```
5
1 2
2 3
4 2
3 5
```

### 输出

```
1
4
1
2
1
```

## 样例 #2

### 输入

```
7
1 2
2 3
3 4
4 5
2 6
3 7
```

### 输出

```
1
5
1
3
1
2
1
```



---

---
title: "イベント巡り 2 (Event Hopping 2)"
layout: "post"
diff: 省选/NOI-
pid: AT_joisc2021_k
tag: []
---

# イベント巡り 2 (Event Hopping 2)

## 题目描述

IOI Park 将有 $n$ 场活动。

这些活动的编号从 $1$ 到 $n$。 活动 $i$ 从时间 $L_i+10^{-1}$ 到时间 $R_i-10^{-1}$ 举行。数据保证 $L_i$ 和 $R_i$ 是整数。

JOI 君决定参加其中的 $k$ 个活动。但是，JOI 君不能在中间加入或离开每个活动。**在两个活动场所间移动的时间忽略不计**。

JOI 君希望参加编号较小的活动。严格来说，JOI 君参加的 $k$ 个活动的编号依次为 $a_1,\cdots,a_k$，其中 $1 \le a_1 < \cdots < a_k \le n$。如果序列 $(a_1, \cdots, a_k)$ 的编号小于 $(b_1, \cdots, b_k)$，当且仅当存在 $j\ (1 \le j \le k)$ 满足在区间 $[1,j-1]$ 里的所有 $l$ 都有 $a_l=b_l$ 和 $a_j<b_j$。



给出每个活动的信息和 JOI 君参加的活动个数 $k$，判断 JOI 君是否可以参加 $k$ 个活动，如果可以，输出所有的 $k$ 个活动的编号。

## 输入格式

第一行，两个正整数 $n,k$。

第 $2 \sim n + 1$ 行，每行 $2$ 个正整数，$L_i, R_i$。

## 输出格式

如果 JOI 君可以参加 $k$ 个活动：
- 输出 $k$ 行。
- 我们设 JOI 君参与的 $k$ 个活动的编号为 $a_1, a_2, \cdots, a_k\ (1\le a1 < \cdots < a_k \le n）$，你需要在第 $j$ 行输出 $a_j\ (1\le j \le k)$。 请注意，序列 $(a_1, \cdots, a_k)$ 必须是 **最小字典序**。




如果 JOI 君无法参加 $k$ 个活动，输出 $\texttt{-1}$。

## 样例 #1

### 样例输入 #1

```
5 4
1 3
2 5
8 9
6 8
10 15
```

### 样例输出 #1

```
1
3
4
5
```

## 样例 #2

### 样例输入 #2

```
4 3
1 4
3 5
4 9
7 10
```

### 样例输出 #2

```
-1
```

## 样例 #3

### 样例输入 #3

```
10 6
77412002 93858605
244306432 318243514
280338037 358494212
439397354 492065507
485779890 529132783
571714810 632053254
659767854 709114867
718405631 733610573
786950301 815106357
878719468 899999649
```

### 样例输出 #3

```
1
2
4
6
7
8
```

## 样例 #4

### 样例输入 #4

```
20 16
250732298 258217736
26470443 34965880
252620676 260043105
692063405 697656580
497457675 504191511
391372149 397942668
858168758 867389085
235756850 241022021
585764751 593366541
207824318 217052204
661682908 671226688
886273261 892279963
770109416 778960597
264372562 270395107
176883483 186662376
509929119 519063796
109491630 118520141
162731982 168101507
662727316 668317158
757072772 765493222
```

### 样例输出 #4

```
1
2
4
5
6
7
8
9
10
11
12
13
14
15
16
17
```

## 说明/提示

#### 样例 #1 解释

有 $2$ 种方式可以参加正好 $4$ 个活动。

- 参加 $1, 3, 4, 5$；
- 参加 $2, 3, 4, 5$。

数列 $(1,3,4,5)$ 比数列 $(2, 3, 4, 5)$ 字典序小，所以输出 $1, 3, 4, 5$。

#### 样例 #2 解释

无论怎么选择都不可能正好参加 $3$ 个活动，所以输出 $\tt -1$。

#### 样例 #3 解释

本样例满足所有 Subtask 的条件。

#### 数据规模与约定

**因洛谷限制，本题不予评测每个 Subtask 的第 $1\sim 20$ 个测试点。**

**本题采用 Subtask 计分法。**

| Subtask | 分值占比百分率 | $n$ | $L_i$ |
| :----: | :----: | :----: | :----:|
| $1$ | $7\%$ | / | $L_i \le L_{i+1}\ (1 \le i \le n − 1)$ |
| $2$ | $1\%$ | $\le20$ | / |
| $3$ | $31\%$ | $\le 3 \times 10^3$ |/ |
| $4$ | $61\%$ | / | / |

**注：斜线表示无特殊限制。**

对于 $100\%$ 的数据：
- $1\le n\le 10^5$；
- $1 \le k \le n$；
- $1\le L_i \le R_i \le 10^9$，且 $1\le i \le n$。



本题译自 [第２０回日本情報オリンピック 2020/2021春季トレーニング合宿 -](https://www.ioi-jp.org/camp/2021/2021-sp-tasks/index.html) [競技 4 -](https://www.ioi-jp.org/camp/2021/2021-sp-tasks/day4/2021-sp-d4-notice.pdf) [T1 日文题面](https://www.ioi-jp.org/camp/2021/2021-sp-tasks/day4/event2.pdf)。



---

---
title: "刑務所 (Jail)"
layout: "post"
diff: 省选/NOI-
pid: AT_joisc2022_a
tag: []
---

# 刑務所 (Jail)

## 题目描述

在 JOI 王国，安保最严格的地方就是 IOI 监狱。IOI 监狱中有 $N$ 个房间，以 $1,\dots,N$ 编号。其中有 $N-1$ 条通道。第 $i$ $(1\le i\le N-1)$ 条通道双向地连接房间 $A_i$ 和 $B_i$。任意两个房间都可以相互到达。

IOI 监狱中有 $M$ 个囚犯，以 $1,\dots,M$ 编号。第 $j$ $(1\le j\le M)$ 个囚犯的卧室和工作室分别是房间 $S_j,T_j$。一个囚犯可能在另一个囚犯的卧室工作。然而，每个房间最多成为一个囚犯的卧室，一个囚犯的工作室。

一天早上，这 $M$ 个囚犯需要从他们的卧室移动到他们的工作室。典狱长 APIO 先生需要按如下方式指示囚犯移动：  
**指令**：选择一个囚犯，然后命令他从当前所在的房间移动到一个与该房间有直接连边的房间。为了避免囚犯交流，不允许将囚犯移动到有其他囚犯在的房间。

为了尽早开始工作，APIO 先生想知道，是否存在一种给出任意条指令的方案使得每个囚犯以**最短路径**从卧室到达工作室。

请编写一个程序，在给定如上房间、通道和罪犯的所有信息后判断是否存在满足条件的方案。

## 输入格式

每个测试数据包含多组测试用例。

第一行一个整数 $Q$，表示这个测试数据包含 $Q$ 组测试用例。

对于每组测试用例：  
第一行一个整数 $N$，表示房间个数。    
接下来 $N-1$ 行每行两个整数 $A_i,B_i$ 表示通道连接房间的编号。  
接下来一行一个整数 $M$ 表示囚犯个数。  
接下来 $M$ 行，每行两个整数 $S_i,T_i$ 表示囚犯的卧室和工作室。

## 输出格式

输出 $Q$ 行，第 $i$ 行表示对于第 $i$ 组测试用例，如果存在一种满足题意的方案，输出 `Yes`，否则输出 `No`。



---

---
title: "京都観光 (Sightseeing in Kyoto)"
layout: "post"
diff: 省选/NOI-
pid: AT_joisc2022_b
tag: []
---

# 京都観光 (Sightseeing in Kyoto)

## 题目描述

[problemUrl]: https://atcoder.jp/contests/joisc2022/tasks/joisc2022_b





---

---
title: "コピー & ペースト 3 (Copy and Paste 3)"
layout: "post"
diff: 省选/NOI-
pid: AT_joisc2022_d
tag: []
---

# コピー & ペースト 3 (Copy and Paste 3)

## 题目描述

[problemUrl]: https://atcoder.jp/contests/joisc2022/tasks/joisc2022_d





---

---
title: "一流の団子職人 (Super Dango Maker)"
layout: "post"
diff: 省选/NOI-
pid: AT_joisc2022_j
tag: []
---

# 一流の団子職人 (Super Dango Maker)

## 题目描述

# [JOISC2022] 一流团子师傅

## 题目背景

JOISC2022 D4T1

**特别提醒，由于洛谷交互机制的特殊性，你不能在程序中引用 `dango3.h`，而需要把 `dango3.h` 中的内容加入文件的开头。即，在程序中 `void Solve(int N, int M)` 的前面加入以下几行语句：**

```cpp
#include <vector>

void Solve(int N, int M);

int Query(const std::vector<int> &x);
void Answer(const std::vector<int> &a);
```


JOI 君是一位专业的团子师傅。在 JOI 君的店里，团子的颜色很有讲究。一共有 $N$ 种颜色，编号为 $1,2,\dots,N$。

**一流团子串**是 JOI 君的店里的招牌食品。制作一个一流团子串，需要将 $N$ 个**颜色不同**的团子串在一根竹签上。

对于每一种颜色，JOI 君都制作了 $M$ 个这种颜色的团子。因此，JOI 君总共有了 $NM$ 个团子。这些团子被编号为 $1,2,\dots,NM$。使用这些团子和 $M$ 根竹签，JOI 君希望串出 $M$ 个一流团子串。

为了避免在颜色上犯错误，JOI 君将会启用他的团子检测器。如果 JOI 君输入一些团子的编号，团子检测器会返回使用这些团子能制作的一流团子串的个数的最大值。当然，前提是充分使用竹签。

JOI 君希望能通过使用若干次团子检测器将 $NM$ 个团子分为 $M$ 组。其中，每一组包含 $N$ 个团子，且每种颜色的团子恰有一个。

JOI 君想在使用不超过 $50\,000$ 次团子检测器的前提下完成这件事。

请写一个程序，对于给定的团子的信息，实现 JOI 君使用不超过 $50\,000$ 次团子检测器来完成任务的策略。

---

**【实现细节】**

你的程序需要实现以下函数。

  - `void Solve(int N, int M)`。  
    对于每组测试数据，该函数会被调用恰好一次。
      - 参数 $\texttt N$ 是团子的颜色数 $N$。
      - 参数 $\texttt M$ 是 JOI 君想制作的一流团子串的个数 $M$。

你的程序可以调用以下函数。

  - `int Query(const std::vector<int> &x)`。  
    你的程序可以通过调用这个函数来使用团子检测器。
      - 参数 `x` 是输入给团子检测器的团子的编号列表。
      - 该函数返回使用 `x` 中的团子能制作的一流团子串的最大值。
      - `x` 中的每个元素都应当是 $[1,NM]$ 中的整数。否则你的程序会被判定为 **Wrong Answer [1]**。
      - `x` 中的元素应当互不相同。否则你的程序会被判定为 **Wrong Answer [2]**。
      - 你的程序不得调用该函数超过 $50\,000$ 次。否则你的程序会被判定为 **Wrong Answer [3]**。

  - `void Answer(const std::vector<int> &a)`。  
    你的程序可以通过调用这个程序来报告分组方案。
      - 参数 `a` 是你分出的一组团子的编号列表。
      - `a` 的长度应当为 $N$。否则你的程序会被判定为 **Wrong Answer [4]**。
      - `a` 中的每个元素都应当是 $[1,NM]$ 中的整数。否则你的程序会被判定为 **Wrong Answer [5]**。
      - 在整个过程中，同一个团子不能出现在参数中多于一次。否则你的程序会被判定为 **Wrong Answer [6]**。
      - 如果用 `a` 中的团子并不能制作一个一流团子串，你的程序会被判定为 **Wrong Answer [7]**。
      - 该函数应当被调用恰好 $M$ 次。否则你的程序会被判定为 **Wrong Answer [8]**。

## 输入格式

第一行，两个正整数 $N,M$。表示团子的颜色数和 JOI 君想制作的一流团子串的个数。

第二行，$N\times M$ 个正整数 $C_1,C_2,\dots,C_{NM}$。其中 $C_i$ 是一个 $[1,N]$ 内的正整数，表示第 $i$ 个团子的颜色。

## 输出格式

- 如果你的程序被判定为正确，样例评分器会输出调用 `Query` 的次数，如 “$\texttt{Accepted: 2022}$”。
- 如果你的程序被判定为任意一种 Wrong Answer，样例评分器会输出其类型，如 “$\texttt{Wrong Answer [4]}$”。

如果你的程序属于多种 Wrong Answer，样例评分器只会输出其中一种。

## 说明/提示

- 你的程序可以实现其他函数以供内部使用，或者使用全局变量。
  - 你的程序不得使用标准输入输出流，也不得以任何方式访问任何文件。然而，你可以输出调试信息到标准错误流。
  
**【编译与测试运行】**
  
你可以从「附加文件」中下载样例评分器来测试你的程序。「附加文件」中也提供了你应当提交的程序的一个样例。

样例评分器即 `grader.cpp`。为了测试你的程序，请将 `grader.cpp,dango3.cpp` 放置在同一个目录下，并执行如下命令来编译你的程序。

`g++ -std=gnu++17 -O2 -o grader grader.cpp dango3.cpp`

若编译成功，将会生成一个可执行文件 `grader`。

请注意，实际使用的评分器与下发的样例评分器不同。样例评分器仅会有单个进程，从标准输入中读取输入数据并将结果输出到标准输出。
  

**【样例交互】**

这里是样例评分器的一组样例输入和对应的交互过程。

```plain
3 2
3 3 1 2 1 2
```

|调用|调用|返回值|
|:-|:-|:-|
|$\texttt{Solve(3, 2)}$|||
||$\texttt{Query([])}$|$\texttt 0$|
||$\texttt{Query([4, 2, 1, 3])}$|$\texttt 1$|
||$\texttt{Query([3, 4, 5])}$|$\texttt 0$|
||$\texttt{Query([2, 6, 5])}$|$\texttt 1$|
||$\texttt{Query([6, 5, 4, 3, 2, 1])}$|$\texttt 2$|
||$\texttt{Answer([1, 6, 5])}$||
||$\texttt{Answer([2, 3, 4])}$||

注意，这组样例**不满足任意子任务的限制**。

从「附加文件」中可以下载到 $\texttt{sample-02.txt}$，其满足子任务 $1$ 的限制。


对于所有测试数据，满足：

- $1 \le C_i \le N$ $(1 \le i \le NM)$。
- 对于每个 $j$ $(1 \le j \le N)$，恰有 $M$ 个 $i$ $(1 \le i \le NM)$ 满足 $C_i = j$。  
- $N,M$ 是正整数。
- $C_i$ $(1 \le i \le NM)$ 是一个 $[1,N]$ 内的整数。

详细子任务附加限制及分值如下表所示：

|子任务编号|附加限制|分值|
|:-:|:-:|:-:|
|$1$|$N=M=4$|$2$|
|$2$|$N=100$，$M=10$|$5$|
|$3$|$N=200$，$M=25$|$15$|
|$4$|$N=400$，$M=25$|$78$|



---

---
title: "Minimize Maximum"
layout: "post"
diff: 省选/NOI-
pid: AT_jsc2019_final_d
tag: []
---

# Minimize Maximum

## 题目描述

[problemUrl]: https://atcoder.jp/contests/jsc2019-final/tasks/jsc2019_final_d

長さ $ N $ の整数列 $ A_0,A_1,\cdots,A_{N-1} $ と $ B_0,B_1,\cdots,B_{N-1} $ が与えられます。

全ての $ k $ ($ 2\ \leq\ k\ \leq\ N $) について、次の問題を解いてください。

- 整数列 $ C_0,C_1,\cdots,C_{k-1} $ をつくる。 ここで、全ての $ i $ ($ 0\ \leq\ i\ \leq\ k-1 $) について、$ A_i\ \leq\ C_i\ \leq\ B_i $ を満たさなくてはならない。 「$ C_{i+1}-C_i $ ($ 0\ \leq\ i\ \leq\ k-2 $) の最大値」としてありうる最小の値はいくらか。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ A_0 $ $ A_1 $ $ \cdots $ $ A_{N-1} $ $ B_0 $ $ B_1 $ $ \cdots $ $ B_{N-1} $

## 输出格式

$ N-1 $ 行出力せよ。$ i $ ($ 1\ \leq\ i\ \leq\ N-1 $) 行目には、$ k=i+1 $ のときの問題の答えを出力せよ。

## 说明/提示

### 制約

- $ 1\ \leq\ N\ \leq\ 2\ \times\ 10^5 $
- $ 0\ \leq\ A_i\ \leq\ B_i\ \leq\ 10^9 $
- 入力される値はすべて整数である。

### Sample Explanation 1

各 $ k $ について、「$ C_{i+1}-C_i $ の最大値」が最小になる整数列 $ C $ の例を示します。 - $ k=2 $: $ C=(2,0) $ - $ k=3 $: $ C=(1,1,1) $ - $ k=4 $: $ C=(1,1,1,2) $

## 样例 #1

### 输入

```
4

0 0 1 2

2 1 3 3
```

### 输出

```
-2

0

1
```

## 样例 #2

### 输入

```
10

24 8 6 8 13 25 4 1 4 7

100 89 65 46 66 58 22 16 11 10
```

### 输出

```
-92

-47

-30

-21

-10

-10

-10

-8

-4
```



---

---
title: "Nearest String"
layout: "post"
diff: 省选/NOI-
pid: AT_jsc2019_final_e
tag: []
---

# Nearest String

## 题目描述

[problemUrl]: https://atcoder.jp/contests/jsc2019-final/tasks/jsc2019_final_e

高橋くんは、文字列 $ a $ に対して、以下の $ 2 $ 種類の操作が行なえます。

- $ a $ の先頭、または末尾の $ 1 $ 文字を削除する。これには $ X $ のコストがかかる。
- $ a $ の末尾に、好きな $ 1 $ 文字を追加する。これには $ Y $ のコストがかかる。

高橋くんは今、$ N $ 個の文字列 $ S_0,S_1,\cdots,S_{N-1} $ を持っています。 高橋くんの友達の青木くんは、高橋くんに次の $ Q $ 個の質問を行います。

- 質問 $ i $ ($ 0\ \leq\ i\ \leq\ Q-1 $): 青木くんが文字列 $ T_i $ を見せる。 $ T_i $ に上記の操作を繰り返し行い、高橋くんの持っている $ N $ 個の文字列のいずれかに一致させるために必要なコストの最小値を求めよ。

多忙な高橋くんの代わりに、これらの質問に答えるプログラムを作成してください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ Q $ $ X $ $ Y $ $ S_0 $ $ S_1 $ $ \vdots $ $ S_{N-1} $ $ T_0 $ $ T_1 $ $ \vdots $ $ T_{Q-1} $

## 输出格式

$ Q $ 行出力せよ。 $ i+1 $ ($ 0\ \leq\ i\ \leq\ Q-1 $) 行目には、質問 $ i $ の答えを出力せよ。

## 说明/提示

### 制約

- $ 1\ \leq\ N\ \leq\ 10^5 $
- $ 1\ \leq\ Q\ \leq\ 10^5 $
- $ 1\ \leq\ X,Y\ \leq\ 10^9 $
- $ 1\ \leq\ |S_i| $
- $ \sum_{i=0}^{N-1}\ |S_i|\ \leq\ 5\ \times\ 10^5 $
- $ S_i\ \neq\ S_j $ ($ i\ \neq\ j $)
- $ 1\ \leq\ |T_i| $
- $ \sum_{i=0}^{Q-1}\ |T_i|\ \leq\ 5\ \times\ 10^5 $
- $ T_i\ \neq\ T_j $ ($ i\ \neq\ j $)
- 入力される数はすべて整数である。
- 入力される文字列はすべて英小文字からなる文字列である。

### Sample Explanation 1

例えば、質問 $ 2 $ について考えると、以下のように操作するのが最適です。 - `abc` の先頭の文字を削除して、`bc` を得る。コストが $ 4 $ かかる。 - `bc` の末尾に `d` を追加して、`bcd` を得る。コストが $ 2 $ かかる。

## 样例 #1

### 输入

```
3 3 4 2

b

bcd

cd

a

ab

abc
```

### 输出

```
6

4

6
```

## 样例 #2

### 输入

```
4 3 1 100

a

aaaa

aaaaaaa

aaaaaaaaaa

aaa

aaaaaa

aaaaaaaaa
```

### 输出

```
2

2

2
```

## 样例 #3

### 输入

```
10 10 86 69

bbabbaaaaa

babaababab

bbababbbba

aaaaaaaaab

bbbbbbaabb

aabbabbbba

babbbbbbaa

baaabbaaaa

aaaaababbb

ababaaaaaa

bbaabbbbaa

abbbbabbbb

abbaaabaaa

ababaaaaab

bbaabbaaaa

abbbbbbabb

aabbbabbba

aaabbbaaaa

abbbababab

babaaabbbb
```

### 输出

```
930

620

775

155

775

465

775

930

620

620
```



---

---
title: "Card Collector"
layout: "post"
diff: 省选/NOI-
pid: AT_jsc2019_qual_e
tag: []
---

# Card Collector

## 题目描述

[problemUrl]: https://atcoder.jp/contests/jsc2019-qual/tasks/jsc2019_qual_e

$ H $ 行 $ W $ 列に並んだマス目の上に合計 $ N $ 枚のカードが置かれています。

$ i $ 番目のカードには整数 $ A_i $ が書かれており、上から $ R_i $ 行目、左から $ C_i $ 列目のマスの上に置かれています。

同じマスに複数枚のカードが置かれていることもあります。

あなたは各行からそれぞれ $ 1 $ 枚までカードを選んで取ります。

次に、各列からそれぞれ $ 1 $ 枚までカードを選んで取ります。

取ったカードに書かれた整数の合計の最大値を求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ H $ $ W $ $ R_1 $ $ C_1 $ $ A_1 $ $ R_2 $ $ C_2 $ $ A_2 $ $ \vdots $ $ R_N $ $ C_N $ $ A_N $

## 输出格式

取ったカードに書かれた整数の合計の最大値を出力せよ。

## 说明/提示

### 制約

- 入力は全て整数である。
- $ 1\ \leq\ N\ \leq\ 10^5 $
- $ 1\ \leq\ H,\ W\ \leq\ 10^5 $
- $ 1\ \leq\ A_i\ \leq\ 10^5 $
- $ 1\ \leq\ R_i\ \leq\ H $
- $ 1\ \leq\ C_i\ \leq\ W $

### Sample Explanation 1

以下のように取ると、取ったカードに書かれた整数の合計は $ 28 $ になり、このときが最大です。 - $ 1 $ 行目から $ 4 $ 番目のカードを取ります。 - $ 2 $ 行目から $ 6 $ 番目のカードを取ります。 - $ 1 $ 列目から $ 2 $ 番目のカードを取ります。 - $ 2 $ 列目から $ 5 $ 番目のカードを取ります。

## 样例 #1

### 输入

```
6 2 2

2 2 2

1 1 8

1 1 5

1 2 9

1 2 7

2 1 4
```

### 输出

```
28
```

## 样例 #2

### 输入

```
13 5 6

1 3 35902

4 6 19698

4 6 73389

3 6 3031

3 1 4771

1 4 4784

2 1 36357

2 1 24830

5 6 50219

4 6 22645

1 2 30739

1 4 68417

1 5 78537
```

### 输出

```
430590
```

## 样例 #3

### 输入

```
1 100000 100000

1 1 1
```

### 输出

```
1
```



---

---
title: "Spanning Tree"
layout: "post"
diff: 省选/NOI-
pid: AT_jsc2021_g
tag: []
---

# Spanning Tree

## 题目描述

[problemUrl]: https://atcoder.jp/contests/jsc2021/tasks/jsc2021_g

$ N $ 頂点のグラフ $ G $ があり、頂点には $ 1,\ 2,\ \dots,\ N $ の番号がついています。はじめ、$ G $ には辺がありません。  
 これから $ G $ に何本か無向辺を追加します。ただし、辺を追加し終わった後、任意の $ i,\ j\,(i\ ≠\ j) $ について以下の条件を満たす必要があります。

- $ A_{i,\ j}\ =\ 1 $ のとき、頂点 $ i $ と頂点 $ j $ を直接結ぶ辺が存在する。
- $ A_{i,\ j}\ =\ 0 $ のとき、頂点 $ i $ と頂点 $ j $ を直接結ぶ辺が存在しない。
- $ A_{i,\ j}\ =\ -1 $ のとき、どちらでもよい。

辺を追加し終わった後の $ G $ としてあり得るもののうち、木であるものはいくつあるでしょうか？  
 ただし、答えは非常に大きくなることがあるので、答えを $ (10^9\ +\ 7) $ で割った余りを求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ A_{1,\ 1} $ $ \cdots $ $ A_{1,\ N} $ $ \vdots $ $ A_{N,\ 1} $ $ \cdots $ $ A_{N,\ N} $

## 输出格式

答えを $ (10^9\ +\ 7) $ で割った余りを出力せよ。

## 说明/提示

### 制約

- 入力は全て整数
- $ 2\ <\ =\ N\ <\ =\ 300 $
- $ -1\ <\ =\ A_{i,\ j}\ =\ A_{j,\ i}\ <\ =\ 1 $
- $ A_{i,\ i}\ =\ 0 $

### Sample Explanation 1

頂点 $ 1 $ と頂点 $ 2 $ の間には辺が必要で、頂点 $ 1 $ と頂点 $ 4 $ の間、頂点 $ 3 $ と頂点 $ 4 $ の間には辺を追加してはいけません。 したがって、以下の $ 2 $ 個が条件を満たします。 !\[\](https://img.atcoder.jp/ghi/0f55bf9e7a13aef4bddde12f87a23d5d.png)

### Sample Explanation 4

頂点を区別するとき、$ 11 $ 頂点の木は全部で $ 11^9 $ 個あります。

## 样例 #1

### 输入

```
4

0 1 -1 0

1 0 -1 -1

-1 -1 0 0

0 -1 0 0
```

### 输出

```
2
```

## 样例 #2

### 输入

```
3

0 1 1

1 0 1

1 1 0
```

### 输出

```
0
```

## 样例 #3

### 输入

```
3

0 0 0

0 0 0

0 0 0
```

### 输出

```
0
```

## 样例 #4

### 输入

```
11

0 -1 -1 -1 -1 -1 -1 -1 -1 -1 -1

-1 0 -1 -1 -1 -1 -1 -1 -1 -1 -1

-1 -1 0 -1 -1 -1 -1 -1 -1 -1 -1

-1 -1 -1 0 -1 -1 -1 -1 -1 -1 -1

-1 -1 -1 -1 0 -1 -1 -1 -1 -1 -1

-1 -1 -1 -1 -1 0 -1 -1 -1 -1 -1

-1 -1 -1 -1 -1 -1 0 -1 -1 -1 -1

-1 -1 -1 -1 -1 -1 -1 0 -1 -1 -1

-1 -1 -1 -1 -1 -1 -1 -1 0 -1 -1

-1 -1 -1 -1 -1 -1 -1 -1 -1 0 -1

-1 -1 -1 -1 -1 -1 -1 -1 -1 -1 0
```

### 输出

```
357947677
```



---

---
title: "Connecting Cities"
layout: "post"
diff: 省选/NOI-
pid: AT_keyence2019_e
tag: []
---

# Connecting Cities

## 题目描述

有 $n$ 个点排成一行，在第 $i,j$ 个点之间连边的代价为 $|i-j| \times D+A_i+A_j$，求将它们连成一棵树的最小代价。

$1 \leq n \leq 2\times 10^5$，$1 \leq D,A_i \leq 10^9$

## 输入格式

第一行两个整数 $n,D$。

第二行 $n$ 个整数 $A_1,A_2,\dots,A_n$。

## 输出格式

输出一个整数表示答案。

## 样例 #1

### 输入

```
3 1

1 100 1
```

### 输出

```
106
```

## 样例 #2

### 输入

```
3 1000

1 100 1
```

### 输出

```
2202
```

## 样例 #3

### 输入

```
6 14

25 171 7 1 17 162
```

### 输出

```
497
```

## 样例 #4

### 输入

```
12 5

43 94 27 3 69 99 56 25 8 15 46 8
```

### 输出

```
658
```



---

---
title: "Greedy Ant"
layout: "post"
diff: 省选/NOI-
pid: AT_keyence2021_e
tag: []
---

# Greedy Ant

## 题目描述

[problemUrl]: https://atcoder.jp/contests/keyence2021/tasks/keyence2021_e

数直線上に $ N $ 個の飴があります。左から $ i $ 番目の飴は位置 $ 2i $ にあり、美味しさ $ a_i $ の飴です。 ここで、飴の美味しさは相異なることが保証されます。

すぬけ君と蟻が交互に飴を一つずつ取り合うことにしました。 はじめに蟻が位置 $ 1,3,\ldots,\ 2N+1 $ の一つを選んでそこに立ち、取り合いを開始します。

すぬけ君が先に飴を取ります。 すぬけ君は、自分の手番において好きな飴を一つ選んで取ることができます。

蟻は、自分の手番において、自分がいる位置から左右それぞれの方向について最も近い位置にある飴のうち、美味しさが大きい方を選んで取ります。一方向にしか飴が存在しない場合は、その方向にある最も近い位置にある飴を取ります。

飴がなくなった時点で取り合いは終了します。 蟻がはじめに立つ位置が $ 1,\ 3,\ \ldots,\ 2N+1 $ の場合のそれぞれについて、すぬけ君が取る飴の美味しさの総和としてありうる値の最大値を求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ a_1 $ $ a_2 $ $ \ldots $ $ a_N $

## 输出格式

$ N+1 $ 行出力せよ。$ i $ 行目では、蟻がはじめに位置 $ 2i-1 $ に立ったときに、すぬけ君が取る飴の美味しさの総和としてありうる値の最大値を出力すること。

## 说明/提示

### 制約

- 与えられる入力は全て整数
- $ 1\ \leq\ N\ \leq\ 400 $
- $ 1\ \leq\ a_i\ \leq\ 10^{6} $
- $ a_i $ は相異なる

### Sample Explanation 1

\- 蟻がはじめに位置 $ 7 $ に立ったときのすぬけ君の最適な戦略の一例について説明します。 - すぬけ君は美味しさ $ 1 $ の飴を取ります。 - 蟻の左方向にある蟻に最も近い飴は美味しさ $ 3 $ の飴です。蟻の右方向にある蟻に最も近い飴は美味しさ $ 2 $ の飴です。蟻は美味しさが大きい方である美味しさ $ 3 $ の飴を取ります。 - すぬけ君は美味しさ $ 1000 $ の飴を取ります。 - 蟻の左方向にある蟻に最も近い飴は美味しさ $ 4 $ の飴です。蟻の右方向にある蟻に最も近い飴は美味しさ $ 2 $ の飴です。蟻は美味しさが大きい方である美味しさ $ 4 $ の飴を取ります。 - すぬけ君は美味しさ $ 2000 $ の飴を取ります。 - 蟻の左方向にある蟻に最も近い飴は存在しません。蟻の右方向にある蟻に最も近い飴は美味しさ $ 2 $ の飴です。蟻は美味しさ $ 2 $ の飴を取ります。 - すぬけ君は美味しさ $ 3000 $ の飴を取ります。 - すぬけ君の取った飴の美味しさの総和は $ 6001 $ です。これを超えるようなすぬけ君の飴の取り方は存在しません。

## 样例 #1

### 输入

```
7

4 3 1 2 1000 2000 3000
```

### 输出

```
6004

6004

6004

6001

5007

4007

4007

4007
```

## 样例 #2

### 输入

```
40

45651 92206 55173 24815 34809 73343 60978 57984 6919 89624 19693 30037 87070 6713 65976 37597 51929 93304 70911 7343 65414 38977 47998 52123 53590 35714 59319 50872 53850 40991 85668 8808 32846 70831 3416 42173 89538 73410 21502 69631
```

### 输出

```
1416699

1416699

1416699

1416699

1413888

1410894

1410894

1410894

1413888

1413888

1413888

1413888

1413888

1413888

1419943

1419943

1419943

1400961

1400961

1400961

1419943

1419943

1419943

1419749

1419749

1419749

1419749

1419749

1419749

1419749

1419749

1419749

1419943

1419943

1419943

1419943

1398462

1398462

1398462

1402241

1402241
```



---

---
title: "ティッシュ配り"
layout: "post"
diff: 省选/NOI-
pid: AT_kupc2016_i
tag: []
---

# ティッシュ配り

## 题目描述

[problemUrl]: https://atcoder.jp/contests/kupc2016/tasks/kupc2016_i

Eli- $ 1 $ さんは仕事時間が $ N $ 秒のティッシュ配りのバイトをすることにした. Eli- $ 1 $ さんは特殊能力である分身を利用してなるべく多くのティッシュを配ることにした. Eli- $ gen $ さんができる行動は次の 2 種類である.

- $ gen\ \times\ C $ ( $ C $ は分身にかかる時間の係数) 秒をかけてEli- $ gen $ さんとEli- $ (gen\ +\ 1) $ さんの 2 人に分身する.
- 世代( $ =\ gen $ )に関わらず $ 1 $ 秒をかけてちょうど $ 1 $ 個のティッシュを配る.

配りながら分身するということはできない. $ N $ , $ C $ が与えられたとき, Eli- $ 1 $ さんが分身と合計で最大何個のティッシュを配ることができるかを求めよ. ただし, 配れるティッシュの数は非常に大きくなることがあるため $ 1000000007 $ ($ =\ 10^9\ +\ 7 $) で割った余りを解答として出力せよ.

## 输入格式

入力は以下の形式で標準入力から与えられる．

> $ Q $ $ N_1 $ $ C_1 $ : $ N_Q $ $ C_Q $

入力は複数のクエリからなる. $ 1 $ 行目には, クエリの個数を表す整数 $ Q $ が与えられる.

続く $ Q $ 行に, それぞれ 1 個のクエリが与えられる. $ q $ ( $ 1\ \leq\ q\ \leq\ Q $ ) 番目のクエリでは, $ N_q $ と $ C_q $ が半角スペース区切りで与えられる. $ N_q $ と $ C_q $ は $ q $ 番目のクエリにおける, 仕事時間と分身にかかる時間の係数をそれぞれ表している.

## 输出格式

各クエリに対して, Eli- $ 1 $ さんが分身と合計で最大何個のティッシュを配ることができるかを 1 行で出力せよ. ただし, 配れるティッシュの数は非常に大きくなることがあるため $ 1000000007 $ ( $ =\ 10^9\ +\ 7 $ ) で割った余りを出力せよ.

## 说明/提示

### 制約

- $ 1\ \leq\ Q\ \leq\ 100000\ =\ 10^5 $
- $ 1\ \leq\ N_q\ \leq\ 100000\ =\ 10^5 $
- $ 1\ \leq\ C_q\ \leq\ 20000\ =\ 2\ \times\ 10^4 $

### 部分点

 $ Q\ =\ 1 $ を満たすデータセットに正解した場合は $ 30 $ 点の部分点が与えられる.

追加制約のないデータセットに正解した場合は追加で $ 270 $ 点が与えられ，合計で $ 300 $ 点が得られる.

### Sample Explanation 1

$ 1 $ つめのクエリでは, 分身しないと $ 20 $ 個しか配れないところを, 分身後 $ 2 $ 人が $ 12 $ 個ずつ配ることで $ 24 $ 個配ることができ, これが最大である. $ 2 $ つめのクエリでは, 分身しても $ 2 $ 人がそれぞれ $ 8 $ 個ずつしか配れないため, 分身せずに $ 20 $ 個配るほうがよい.

### Sample Explanation 2

以下の図のようにすればよい. 黒線は分身を表し, 赤線はティッシュを配ることを表している. !\[\](/img/other/kupc2016/sushi/sample2.png) このケースは部分点の追加制約を満たす.

### Sample Explanation 3

$ 1000000007 $ ( $ 10^9\ +\ 7 $ ) で割った余りを出力する必要があることに注意せよ. このケースは部分点の追加制約を満たす.

## 样例 #1

### 输入

```
2

20 8

20 12
```

### 输出

```
24

20
```

## 样例 #2

### 输入

```
1

20 3
```

### 输出

```
67
```

## 样例 #3

### 输入

```
1

200 1
```

### 输出

```
148322100
```



---

---
title: "光と闇の調和"
layout: "post"
diff: 省选/NOI-
pid: AT_kupc2018_k
tag: []
---

# 光と闇の調和

## 题目描述

现在你面前有 $N$ 个光之宝珠和 $M$ 个暗之宝珠。

每个光之宝珠的能量分别为 $a_1, a_2, \ldots, a_N$，对应的，每个暗之宝珠的能量为 $b_1, b_2, \ldots, b_M$。

对于每个光之宝珠 $i$（$1 \leq i \leq N$），它与暗之宝珠的结合范围是从第 $l_i$ 个到第 $r_i$ 个（即 $l_i \leq j \leq r_i$）。

你的任务是为这些宝珠设定等级，等级范围为 $1$ 到 $K$ 的整数。

设定等级后，每个宝珠只会与等级比自己低或相同的宝珠结合，那么仅与比自己等级高的宝珠结合的宝珠就会消失。

请你求出，在这种设定下，剩余宝珠的能量平均值的最大值。

## 输入格式

输入以以下格式从标准输入给出：

> $N$ $M$ $K$ $a_1$ $a_2$ $\ldots$ $a_N$ $b_1$ $b_2$ $\ldots$ $b_M$ $l_1$ $r_1$ $l_2$ $r_2$ $\ldots$ $l_N$ $r_N$

## 输出格式

请输出剩余宝珠能量平均值的最大值。允许的绝对误差或相对误差应不超过 $10^{-5}$。

## 说明/提示

### 约束条件

- 所有输入为整数。
- $1 \leq N, M \leq 3 \times 10^4$
- $2 \leq K \leq 3 \times 10^4$
- $1 \leq a_i, b_i \leq 10^5$
- $1 \leq l_i \leq r_i \leq M$
- 每个宝珠至少结合一个其他的宝珠。

### 部分分

- 当 $N, M, K \leq 300$ 时，正确解答可获得 $30$ 分。
- 对于没有额外约束的数据集，正确解答可获得 $370$ 分。

### 样例说明

例如，如果设定光之宝珠的等级为 $10$ 和 $8$，暗之宝珠的等级为 $7, 9, 9$，那么第 $2$ 个光之宝珠与第 $1$ 个暗之宝珠会消失。此时，剩下的宝珠能量平均值是 $(15 + 12 + 13) / 3 = 13.3333...$，这已是最大值。

 **本翻译由 AI 自动生成**

## 样例 #1

### 输入

```
2 3 10

15 10

11 12 13

1 2

2 3
```

### 输出

```
13.3333333333
```

## 样例 #2

### 输入

```
1 1 2

10

20

1 1
```

### 输出

```
20.0000000000
```

## 样例 #3

### 输入

```
10 10 5

97925 72167 60717 63438 89200 6986 16104 76483 23620 9806

24712 38409 16480 2643 28121 51951 23492 4420 28197 28607

1 2

3 10

2 5

9 9

6 7

2 8

3 5

2 3

4 10

5 9
```

### 输出

```
51672.4545454545
```



---

---
title: "One or All"
layout: "post"
diff: 省选/NOI-
pid: AT_kupc2019_k
tag: []
---

# One or All

## 题目描述

[problemUrl]: https://atcoder.jp/contests/kupc2019/tasks/kupc2019_k

アンジェは変数で遊ぶのが好きです。

今日は $ 3 $ つの変数 $ x,~y,~z $ を用意して、これらを使って遊ぶことにしました。 $ 3 $ つの変数は $ 0 $ で初期化されています。

アンジェは、これらの変数に対して、以下の操作のいずれかを選んで行うことを $ n $ 回繰り返すつもりです。

- 変数を $ 1 $ つ選ぶ。その変数の値を $ 1 $ 増やす、もしくは $ 1 $ 減らす。
- $ 3 $ つの変数全ての値を $ 1 $ ずつ増やす、もしくは $ 1 $ ずつ減らす。

$ n $ 回の操作を行ったあとに、$ x,~y,~z $ を $ m $ で割った余りがそれぞれ $ p,~q,~r $ であるとき、 アンジェは満足します。

アンジェは、自分が満足できるような $ n $ 回の操作列が何種類あるのかに興味を持ちました。 彼女の代わりに、そのような操作列の種類数を数えて、$ 998244353 $ で割った余りを出力してください。

ここで $ 2 $ つの操作列は、ある整数 $ i\ (1\ \leq\ i\ \leq\ n) $ が存在して、$ i $ 回目の操作後に $ 1 $ つ以上の変数の値が異なるとき、別の種類であるとみなします。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ n $ $ m $ $ p $ $ q $ $ r $

## 输出格式

アンジェが満足するような操作列の種類数を $ 998244353 $ で割った余りを出力せよ。

## 说明/提示

### 制約

- 入力は全て整数である。
- $ 1\ \leq\ n\ \leq\ 10^6 $
- $ 1\ \leq\ m\ \leq\ 10^6 $
- $ 0\ \leq\ p,\ q,\ r\ <\ m $

### Sample Explanation 1

$ 1 $ 回の操作で、ある $ 1 $ つの変数の値だけを $ 1 $ 増やし、残り $ 2 $ つの変数の値を $ 1 $ 減らすことはできません。

### Sample Explanation 2

まず、$ 3 $ つすべての変数の値を $ 1 $ 減らします。次に $ x $ の値だけを $ 1 $ 減らすことで、$ x $ の値は $ -2 $、 $ y $ の値は $ -1 $、$ z $ の値は $ -1 $ になります。 これらを $ 3 $ で割った余りはそれぞれ $ 1,~2,~2 $ であるため、アンジェはこの操作列に満足します。 アンジェが満足する操作列は、この操作列を含めて $ 2 $ 種類あります。

## 样例 #1

### 输入

```
1 3 1 2 2
```

### 输出

```
0
```

## 样例 #2

### 输入

```
2 3 1 2 2
```

### 输出

```
2
```

## 样例 #3

### 输入

```
1000000 4 1 2 3
```

### 输出

```
333551635
```



---

---
title: "Beans on the Grid"
layout: "post"
diff: 省选/NOI-
pid: AT_kupc2020_h
tag: []
---

# Beans on the Grid

## 题目描述

有一个 $H$ 行 $W$ 列的棋盘。在棋盘的格子中，有些格子上没有盘子，有些格子上则放着盘子。

在放盘子的格子中，有些还放有豆子。每个豆子都是不同的，一个盘子上可以放多个豆子。

Alice 和 Bob 准备在这个棋盘上进行一场游戏，规则如下：

- Alice 先手，之后双方轮流进行操作。
- 在每个回合中，玩家需要按照下面的「豆子移动规则」移动一个豆子。如果玩家不能移动任何豆子，那么该玩家立即输掉游戏，对手获胜。

请你判断，当双方都采用最佳策略时，谁将获胜。

## 输入格式

输入通过标准输入给出，格式如下：

> $H$ $W$ $c_{1,1}$ $\cdots$ $c_{1,W}$ $\vdots$ $c_{H,1}$ $\cdots$ $c_{H,W}$

其中 $c_{i,j}$ 表示棋盘上 $(i,j)$ 格子的状态：

- $c_{i,j} = \texttt{\#}$，表示 $(i,j)$ 没有盘子。
- $c_{i,j} = \texttt{.}$，表示 $(i,j)$ 有空盘子。
- $c_{i,j} = \texttt{B}$，表示 $(i,j)$ 上的盘子里有一个豆子。

## 输出格式

如果 Alice 获胜，输出 `Alice`；如果 Bob 获胜，输出 `Bob`。

## 说明/提示

### 豆子移动规则

对于棋盘上的坐标 $(i, j)$（1 ≤ i ≤ H, 1 ≤ j ≤ W）：

1. 从中选择一个豆子，假设该豆子当前在 $(i, j)$。
2. 根据以下三种方式之一进行移动，须满足所有条件：
   - 如果 $i + 1 \leq H$，则可以向下移动到 $(i+1, j)$。
   - 如果 $j = 1$，则可以水平循环到 $(i, W)$；否则，可以向左移动到 $(i, j-1)$。
   - 如果 $j = W$，则可以水平循环到 $(i, 1)$；否则，可以向右移动到 $(i, j+1)$。
3. 移动后的格子必须有盘子。
4. 该豆子从未到达过移动后的格子。

### 约束条件

- 1 ≤ H, W ≤ 1000
- H, W 是整数。

### 示例解释

初始时，豆子位于（1,1）。
- Alice 第一个回合只能将豆子移动到（1,2）。
- Bob 第一个回合只能将豆子移动到（2,2）。
- Alice 第二个回合只能将豆子移动到（2,3）。
- Bob 第二个回合无法移动豆子。
因此，Bob 落败，而 Alice 获胜。

 **本翻译由 AI 自动生成**

## 样例 #1

### 输入

```
2 3

B.#

#..
```

### 输出

```
Alice
```

## 样例 #2

### 输入

```
1 1

B
```

### 输出

```
Bob
```

## 样例 #3

### 输入

```
1 3

B#.
```

### 输出

```
Alice
```

## 样例 #4

### 输入

```
5 18

#.#..#.#..###..###

##...#.#..#.#..#..

#....#.#..###..#..

##...#.#..#....#..

#.#..###..#....###
```

### 输出

```
Bob
```



---

---
title: "Many Parentheses"
layout: "post"
diff: 省选/NOI-
pid: AT_kupc2020_m
tag: []
---

# Many Parentheses

## 题目描述

括号序列是由 `(` 和 `)` 组成的字符串。我们将满足以下任一条件的序列称为正确的括号序列：

- 空字符串
- 存在一个正确的括号序列 $A$，使得 `(`, $A$, `)` 按序连接构成新的序列
- 存在非空的正确括号序列 $S$ 和 $T$，使得 $S$, $T$ 连接形成新的序列

现在有 $N$ 个不同的盒子，你希望向每个盒子中放入一个正确的括号序列，但必须满足这两个条件：

1. 所有盒子中 `(` 的总个数为 $M$。
2. 长度恰为 $2 \times K$ 的括号序列不能放入任何盒子。

请计算满足条件的所有不同放置方法的总数，并输出其除以 $998244353$ 的余数。

在这里，我们认为两种放置方法不同当且仅当在某个盒子中放入的括号序列不同。

## 输入格式

输入由以下三个整数给出，代表盒子数量、左括号总数以及禁止的长度：

> $N$ $M$ $K$

## 输出格式

输出满足条件的放置方法总数对 $998244353$ 取模后的结果。

## 说明/提示

- $1 \leq N \leq 10^6$
- $1 \leq M \leq 10^6$
- $1 \leq K \leq M$

### 部分分

- 当 $1 \leq N, M \leq 2000$ 时，正确解答可得 $10$ 分。
- 无额外限制的数据集，正确解答可额外得到 $490$ 分。

### 示例解释

例如，对于以下组合：
- `(())` ，空
- `()()` ，空
- 空，`(())`
- 空，`()()`

共计 $4$ 种不同的放置方法。

 **本翻译由 AI 自动生成**

## 样例 #1

### 输入

```
2 2 1
```

### 输出

```
4
```

## 样例 #2

### 输入

```
1 1 1
```

### 输出

```
0
```

## 样例 #3

### 输入

```
24 120 30
```

### 输出

```
379268651
```



---

---
title: "括弧列"
layout: "post"
diff: 省选/NOI-
pid: AT_mujin_pc_2016_d
tag: []
---

# 括弧列

## 题目描述

[problemUrl]: https://atcoder.jp/contests/mujin-pc-2016/tasks/mujin_pc_2016_d





---

---
title: "Robot and String"
layout: "post"
diff: 省选/NOI-
pid: AT_mujin_pc_2017_c
tag: []
---

# Robot and String

## 题目描述

[problemUrl]: https://atcoder.jp/contests/mujin-pc-2017/tasks/mujin_pc_2017_c

あなたは、文字列を処理するロボットを開発しています。 英小文字のみからなる文字列 $ t $ をこのロボットに与えると、ロボットは次の手順に従って文字列を処理します。

1. $ t_i\ =\ t_{i\ +\ 1} $ であるような最小の $ i $ を選ぶ。 そのような $ i $ が存在しない場合、処理を終える。
2. $ t_i $ が `z` である場合、$ t_i $, $ t_{i\ +\ 1} $ を取り除く。 $ t_i $ が `z` でない場合、$ t_i $ の次のアルファベットを $ c $ として、$ t_i $, $ t_{i\ +\ 1} $ をまとめて$ 1 $ 文字の $ c $ へ置き換える。
3. 1. へ戻る。

例えば、文字列 `axxxxza` をロボットに与えると、文字列は `axxxxza` → `ayxxza` → `ayyza` → `azza` → `aa` → `b` と処理されます。

英小文字のみからなる文字列 $ s $ が与えられます。 $ s $ について $ Q $ 個の質問に答えてください。 $ i $ 番目の質問は次のようなものです。

- $ s $ の $ l_i $ 文字目から $ r_i $ 文字目までの連続した部分文字列をロボットに与えると、処理された後の文字列は空文字列になるか？

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ s $ $ Q $ $ l_1 $ $ r_1 $ $ l_2 $ $ r_2 $ $ : $ $ l_Q $ $ r_Q $

## 输出格式

$ Q $ 行出力せよ。 $ i $ 行目には、$ i $ 番目の質問に対する答えとして `Yes` または `No` を出力せよ。

## 说明/提示

### 制約

- $ 1\ <\ =\ |s|\ <\ =\ 5\ ×\ 10^5 $
- $ s $ は英小文字のみからなる。
- $ 1\ <\ =\ Q\ <\ =\ 10^5 $
- $ 1\ <\ =\ l_i\ <\ =\ r_i\ <\ =\ |s| $

### Sample Explanation 1

\- $ 1 $ 番目の質問では、文字列は `axxxxza` → `ayxxza` → `ayyza` → `azza` → `aa` → `b` と処理されます。 - $ 2 $ 番目の質問では、文字列は `xxxxz` → `yxxz` → `yyz` → `zz` → `` と処理されます。

## 样例 #1

### 输入

```
axxxxza

2

1 7

2 6
```

### 输出

```
No

Yes
```

## 样例 #2

### 输入

```
aabcdefghijklmnopqrstuvwxyz

1

1 27
```

### 输出

```
Yes
```

## 样例 #3

### 输入

```
yzyyyzyzyyyz

8

1 6

7 12

1 12

6 11

1 1

1 3

4 9

3 8
```

### 输出

```
Yes

Yes

Yes

Yes

No

No

No

No
```



---

---
title: "チーム分け"
layout: "post"
diff: 省选/NOI-
pid: AT_mujin_pc_2018_f
tag: []
---

# チーム分け

## 题目描述

[problemUrl]: https://atcoder.jp/contests/mujin-pc-2018/tasks/mujin_pc_2018_f

$ N $ 人を、それぞれの人がただ $ 1 $ つのチームに属するようにチーム分けを行います。

しかし、人によっては多くの人が属するチームに属したくないと考えています。

この条件は $ N $ 要素からなる整数列 $ a $ で表され、$ i $ 番目の人は $ a_{i} $ 人以下から成るチームに配属されることになります。

チーム分けをするに当たってこのようなチーム分けは何通り考えられるのかを計算したくなりました。答えは非常に大きくなることがあるので、$ 998244353 $ で割ったあまりを出力してください。ただし、$ 2 $ つのチーム分けが異なるとは、ある $ 2 $ 人が存在して、片方のチーム分けでは同じチームに属するがもう片方のチーム分けでは違うチームに属する、という場合を表します。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ a_1 $ $ a_2 $ ... $ a_{N-1} $ $ a_N $

## 输出格式

条件を満たすチーム分けの方法の場合の数を $ 998244353 $ で割ったあまりを出力せよ。

## 说明/提示

### 制約

- $ 1\ \leq\ N\ \leq\ 1000 $
- $ 1\ \leq\ a_i\ \leq\ N $
- 入力は全て整数である

### Sample Explanation 1

$ 1 $ 人をチーム分けする方法は $ 1 $ 通りです。

### Sample Explanation 2

条件を満たすチーム分けは、$ ((1),(2),(3)),\ ((1,2),(3)),\ ((1,3),(2)),\ ((2,3),(1)) $ の $ 4 $ 通りです。

## 样例 #1

### 输入

```
1

1
```

### 输出

```
1
```

## 样例 #2

### 输入

```
3

3 3 2
```

### 输出

```
4
```

## 样例 #3

### 输入

```
10

3 1 4 1 5 9 2 6 3 10
```

### 输出

```
1869
```



---

---
title: "移動"
layout: "post"
diff: 省选/NOI-
pid: AT_mujin_pc_2018_g
tag: []
---

# 移動

## 题目描述

本题给定 $ Q $ 个查询。对于第 $ i $ 个查询，提供 $ 7 $ 个整数：$ a_i, b_i, c_i, d_i, e_i, f_i, k_i $。根据这些整数设定以下变量：$ x_1 = a_i, y_1 = b_i, x_2 = c_i, y_2 = d_i, x_3 = e_i, y_3 = f_i, K = k_i $。我们需要解决如下问题并输出结果。

> 有一台机器人，初始时刻 $ t=0 $ 处于平面坐标点 $ (0,0) $。机器人可以使用三个向量 $ (x_1, y_1), (x_2, y_2), (x_3, y_3) $ 进行移动。这些向量不为 $ (0,0) $ 并且任意两个向量都不平行或反向。对于每个时刻 $ t $，若机器人当前位于点 $ (x, y) $，则下一个时刻 $ t+1 $，机器人可以选择移动到以下四个位置之一：$ (x, y), (x + x_1, y + y_1), (x + x_2, y + y_2), (x + x_3, y + y_3) $。

> 问：在时刻 $ K $ 时，机器人可能在的不同点的个数是多少？请将这个结果 mod $ 998244353 $ 并输出。

## 输入格式

输入数据包含以下格式：

> $ Q $ $ a_1 $ $ b_1 $ $ c_1 $ $ d_1 $ $ e_1 $ $ f_1 $ $ k_1 $ $ : $ $ a_Q $ $ b_Q $ $ c_Q $ $ d_Q $ $ e_Q $ $ f_Q $ $ k_Q $

## 输出格式

对于每一个查询，输出机器人在时刻 $ K $ 可能出现的不同位置总数对 $ 998244353 $ 取模后的结果。

## 说明/提示

### 约束条件

- $ 1 \leq Q \leq 10^4 $
- $ 0 \leq |a_i|, |b_i|, |c_i|, |d_i|, |e_i|, |f_i| \leq 10^9 $
- $ 0 \leq k_i \leq 10^9 $
- 对于每个 $ i $，向量 $ (a_i, b_i), (c_i, d_i), (e_i, f_i) $ 都不为零向量，并且任意两个向量之间既不平行也不反方向，具体来说，任何两个向量的外积都不为零。
- 所有输入数据均为整数。

### 样例解释

在第一个查询中，时刻 $ 3 $ 时机器人可以位于满足 $ (x, y) \ (0 \leq x, y \leq 3) $ 的共 $ 16 $ 个不同点。在第二个查询中，可能的位置共有 $ 19 $ 个，具体为：$ (-3, -3), (-2, -2), (-2, -1), (-1, -2), (-1, -1), (-1, 0), (-1, 1), (0, -1), (0, 0), (0, 1), (0, 2), (0, 3), (1, -1), (1, 0), (1, 1), (1, 2), (2, 0), (2, 1), (3, 0) $。

 **本翻译由 AI 自动生成**

## 样例 #1

### 输入

```
9

1 0 0 1 1 1 3

1 0 0 1 -1 -1 3

3 1 4 1 5 9 265

77162 -78112 -90809 -88927 99617 -89012 1000000000

123 456 789 -123 -456 -789 987654321

0 1 2 3 4 5 0

10000000 10000000 20000000 30000000 -50000000 -80000000 130000000

123456789 442514372 -902777152 -78816277 -887267123 667261667 908855261

1 2 3 4 5 6 7
```

### 输出

```
16

19

981646

677426955

667519055

1

233035917

508252191

64
```



---

---
title: "Random Tournament"
layout: "post"
diff: 省选/NOI-
pid: AT_m_solutions2019_f
tag: []
---

# Random Tournament

## 题目描述

[problemUrl]: https://atcoder.jp/contests/m-solutions2019/tasks/m_solutions2019_f

$ N $ 人の参加するじゃんけん大会を行います。 参加者は人 $ 1 $, 人 $ 2 $, $ \ldots $, 人 $ N $ と呼ばれます。 どの $ 2 $ 人についてもその $ 2 $ 人がじゃんけんをしたときにどちらが勝利するかが事前に決まっています。 この情報は正の整数 $ A_{i,j} $ ( $ 1\ \leq\ j\ <\ i\ \leq\ N $ ) によって表され、

- $ A_{i,j}\ =\ 0 $ のとき、人 $ i $ は人 $ j $ に負けること
- $ A_{i,j}\ =\ 1 $ のとき、人 $ i $ は人 $ j $ に勝つこと

をそれぞれ表します。

大会は次のようにして行われます。

- $ N $ 人の参加者を人 $ 1 $, 人 $ 2 $, $ \ldots $, 人 $ N $ の順に横一列に並べる。
- 列で連続している $ 2 $ 人をランダムに選んで、その $ 2 $ 人で試合を行い、負けた人を列から外す。 これを $ N-1 $ 回繰り返し、最後に残った $ 1 $ 人を優勝者とする。

優勝する可能性のある人の人数を求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ A_{2,1} $ $ A_{3,1} $$ A_{3,2} $ $ : $ $ A_{N,1} $$ \ldots $$ A_{N,N-1} $

## 输出格式

優勝する可能性のある人の人数を出力せよ。

## 说明/提示

### 制約

- $ 1\ \leq\ N\ \leq\ 2000 $
- $ A_{i,j} $ は $ 0 $ または $ 1 $

### Sample Explanation 1

人 $ 1 $ は人 $ 2 $ に勝ち、人 $ 2 $ は人 $ 3 $ に勝ち、人 $ 3 $ は人 $ 1 $ に勝ちます。 最初に人 $ 1 $ と人 $ 2 $ が試合をすると人 $ 3 $ が優勝し、 最初に人 $ 2 $ と人 $ 3 $ が試合をすると人 $ 1 $ が優勝します。

## 样例 #1

### 输入

```
3

0

10
```

### 输出

```
2
```

## 样例 #2

### 输入

```
6

0

11

111

1111

11001
```

### 输出

```
3
```



---

---
title: "木、"
layout: "post"
diff: 省选/NOI-
pid: AT_nikkei2019_2_final_d
tag: []
---

# 木、

## 题目描述

すけぬ君拥有一棵有 $n+1$ 个顶点的树 $T$。在树 $T$ 中，每个顶点都标有一个整数，分别为 $1, 2, \dots, n+1$。树 $T$ 有 $n$ 条边，每条边连接标有整数 $i$ 的顶点和标有整数 $v_i$ 的顶点。

在すけぬ君不注意的时候，ぬすけ君对树 $T$ 进行了如下改动：

1. 选择一个度为 $1$ 的叶子节点并移除，将该顶点数据保密；
2. 擦除剩余 $n$ 个顶点上的整数；
3. 在这 $n$ 个顶点上重新标上整数 $1, 2, \dots, n$。

修改过的树我们称之为 $T'$。树 $T'$ 只有 $n-1$ 条边，第 $i$ 条边连接的是标有整数 $i$ 的顶点和标有整数 $u_i$ 的顶点。

察觉到调皮的ぬすけ君的恶作剧后，すけぬ君想要猜出被藏起来的顶点上原本标记的数字。请找出所有可能的整数，并按升序输出。

## 输入格式

输入从标准输入给出，格式如下：

> $n$ $v_1$ $v_2$ $\dots$ $v_n$ $u_1$ $u_2$ $\dots$ $u_{n-1}$

## 输出格式

输出所有可能被藏起来的顶点上原有的整数，按升序排列，以空格分隔。

## 说明/提示

- $2 \leq n \leq 2 \times 10^5$
- 对于每个 $i = 1, 2, \dots, n$，有 $1 \leq v_i \leq n+1$
- 对于每个 $i = 1, 2, \dots, n-1$，有 $1 \leq u_i \leq n$
- 图 $T$（由边 $(1, v_1), (2, v_2), \dots, (n, v_n)$ 组成）构成一棵树
- 图 $T'$（由边 $(1, u_1), (2, u_2), \dots, (n-1, u_{n-1})$ 组成）也构成一棵树
- 至少存在一个可能被藏起来的顶点
- 所有输入为整数

## 样例解释（简化）

1. 在样例一中，度为 $1$ 的顶点是标有 $1, 3, 4, 5, 8, 11$ 的顶点。隐藏标有 $11$ 或 $8$ 的顶点后，重新标记后都可以得到树 $T'$。其他顶点不行，故答案为 `8 11`。
2. 在样例二中，标有 $2, 3, 4, 5, 6$ 的顶点任何一个被隐藏后都可以重构为树 $T'$，所以输出 `2 3 4 5 6`。
3. 在样例三中，只可能是标有 $1$ 的顶点被隐藏。

 **本翻译由 AI 自动生成**

## 样例 #1

### 输入

```
10

2 9 2 2 2 2 6 7 10 11

2 3 4 10 4 5 4 4 4
```

### 输出

```
8 11
```

## 样例 #2

### 输入

```
5

6 1 1 1 1

5 5 5 5
```

### 输出

```
2 3 4 5 6
```

## 样例 #3

### 输入

```
5

4 3 4 5 6

2 3 4 5
```

### 输出

```
1
```



---

---
title: "Flights"
layout: "post"
diff: 省选/NOI-
pid: AT_nikkei2019_final_f
tag: []
---

# Flights

## 题目描述

[problemUrl]: https://atcoder.jp/contests/nikkei2019-final/tasks/nikkei2019_final_f

$ 2 $ 次元平面上に、$ 1 $ から $ N $ までの番号のついた $ N $ 個の国があります。 国 $ i $ は座標 $ (X_i,Y_i) $ にあります。

それぞれの国には航空会社があります。 国 $ i $ の航空会社は、$ X_j\ \leq\ X_i $ かつ $ Y_j\ \leq\ Y_i $ を満たすすべての $ j $ ($ j\ \neq\ i $) について、 国 $ j $ との間に直通便を運航しています。 この直通便は双方向です。 つまり、国 $ i $ の航空会社の飛行機を利用して、国 $ i $ から国 $ j $ へ移動することも、 国 $ j $ から国 $ i $ へ移動することも可能です。 国 $ i $ の航空会社の飛行機は、$ 1 $ 度利用するたびに $ C_i $ 円の料金がかかります。

ケンさんは現在国 $ S $ にいて、国 $ T $ まで移動したいです。 飛行機を利用して移動するとき、飛行機の料金の合計の最小値を求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ S $ $ T $ $ X_1 $ $ Y_1 $ $ C_1 $ $ X_2 $ $ Y_2 $ $ C_2 $ $ \vdots $ $ X_N $ $ Y_N $ $ C_N $

## 输出格式

国 $ S $ から国 $ T $ へ移動する際の、飛行機の料金の合計の最小値を出力せよ。

## 说明/提示

### 制約

- $ 2\ \leq\ N\ \leq\ 10^5 $
- $ 0\ \leq\ X_i\ \leq\ 10^9 $
- $ 0\ \leq\ Y_i\ \leq\ 10^9 $
- $ 1\ \leq\ C_i\ \leq\ 10^9 $
- $ (X_i,Y_i)\ \neq\ (X_j,Y_j) $ ($ i\ \neq\ j $)
- $ 1\ \leq\ S\ \leq\ N $
- $ 1\ \leq\ T\ \leq\ N $
- $ S\ \neq\ T $
- 飛行機のみを利用して国 $ S $ から国 $ T $ まで移動することができる。
- 入力される値はすべて整数である。

### Sample Explanation 1

この例では、直通便は以下の $ 5 $ 種類が存在します。 - 国 $ 1 $ と国 $ 3 $ を結ぶ直通便。国 $ 1 $ の航空会社が運航しており、一度利用するのに $ 3 $ 円かかる。 - 国 $ 1 $ と国 $ 2 $ を結ぶ直通便。国 $ 2 $ の航空会社が運航しており、一度利用するのに $ 6 $ 円かかる。 - 国 $ 2 $ と国 $ 3 $ を結ぶ直通便。国 $ 2 $ の航空会社が運航しており、一度利用するのに $ 6 $ 円かかる。 - 国 $ 2 $ と国 $ 4 $ を結ぶ直通便。国 $ 2 $ の航空会社が運航しており、一度利用するのに $ 6 $ 円かかる。 - 国 $ 3 $ と国 $ 4 $ を結ぶ直通便。国 $ 4 $ の航空会社が運航しており、一度利用するのに $ 8 $ 円かかる。 国 $ 1 $ から国 $ 4 $ へ移動する場合は、国 $ 1→3→4 $ と移動すると料金の合計が $ 11 $ 円になり、これが最小です。

## 样例 #1

### 输入

```
4 1 4

0 1 3

1 1 6

0 0 4

1 0 8
```

### 输出

```
11
```

## 样例 #2

### 输入

```
9 3 6

2 3 9

1 4 2

0 4 16

1 3 77

3 3 12

4 0 96

4 2 41

2 1 17

3 4 45
```

### 输出

```
104
```



---

---
title: "Jewels"
layout: "post"
diff: 省选/NOI-
pid: AT_nikkei2019_qual_f
tag: []
---

# Jewels

## 题目描述

你有 $n$ 个物品，每个物品有一个颜色 $c_i (1 ≤ c_i ≤ K)$ 和权值 $v_i$。你需要选出 $x$ 个物品，满足若颜色 $i$ 的物品被选中，那么颜色 $i$ 至少存在两个物品被选中，并且最大化总权值和。你需要对 $x = 1\dots n$ 均求出答案。如果无解，则输出 $-1$ 。

## 输入格式

输入第一行两个  $n$，  $K$。

接下来 $n$ 行，每行两个整数 $c_i$， $u_i$。

## 输出格式

输出共 $n$ 行，每 $i$ 行表示 $x =$ i 时的答案。若无解，输出 $-1$。

## 说明/提示

对于所有数据， $1 ≤ n ≤ 2 \times 10^5, 1 ≤ K ≤\frac n 2,1\le c_i\le K, 0 \le v_i \le 10^9$   ,保证对于每种出现在了输入中的颜色，至少存在 $2$ 个该颜色的物品。

## 样例 #1

### 输入

```
5 2

1 1

1 2

1 3

2 4

2 5
```

### 输出

```
-1

9

6

14

15
```

## 样例 #2

### 输入

```
5 2

1 1

1 2

2 3

2 4

2 5
```

### 输出

```
-1

9

12

12

15
```

## 样例 #3

### 输入

```
8 4

3 2

2 3

4 5

1 7

3 11

4 13

1 17

2 19
```

### 输出

```
-1

24

-1

46

-1

64

-1

77
```

## 样例 #4

### 输入

```
15 5

3 87

1 25

1 27

3 58

2 85

5 19

5 39

1 58

3 12

4 13

5 54

4 100

2 33

5 13

2 55
```

### 输出

```
-1

145

173

285

318

398

431

491

524

576

609

634

653

666

678
```



---

---
title: "Urban Planning"
layout: "post"
diff: 省选/NOI-
pid: AT_nomura2020_d
tag: []
---

# Urban Planning

## 题目描述

[problemUrl]: https://atcoder.jp/contests/nomura2020/tasks/nomura2020_d

$ 1,\ 2,\ \cdots,\ N $ の番号がついた $ N $ 個の町があります。

現在、$ 2 $ つの相異なる町を双方向に結ぶ道をいくつか作ることが計画されています。現時点では、町を結ぶ道はありません。

この計画において、各町は他の町を $ 1 $ つ選んで、道を $ 1 $ 本以上使ってその町に移動できるように要請します。

$ N $ 個の町の要請は配列 $ P_1,\ P_2,\ \cdots,\ P_N $ で表され、町 $ i $ の要請は、$ P_i\ =\ -1 $ のときまだ決定されていないこと、$ 1\ \leq\ P_i\ \leq\ N $ であるとき町 $ P_i $ を選んだことを表します。

$ P_i\ =\ -1 $ である町の個数を $ K $ 個としたとき、全体では $ (N-1)^K $ 通りの要請方法が考えられます。それぞれの要請方法について、すべての町の要請を満たすために作る必要がある道の本数の最小値を求め、その総和を $ 10^9+7 $ で割った余りを出力してください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ P_1 $ $ P_2 $ $ \cdots $ $ P_N $

## 输出格式

それぞれの要請方法について、すべての町の要請を満たすために作る必要がある道の本数の最小値を求め、その総和を $ 10^9+7 $ で割った余りを出力せよ。

## 说明/提示

### 制約

- $ 2\ \leq\ N\ \leq\ 5000 $
- $ P_i\ =\ -1 $ または $ 1\ \leq\ P_i\ \leq\ N $
- $ P_i\ \neq\ i $
- 入力は全て整数である

### Sample Explanation 1

要請方法としては次の $ 3 $ 通りがあります。 - $ P_1\ =\ 2,\ P_2\ =\ 1,\ P_3\ =\ 1,\ P_4\ =\ 3 $ とする。このとき、例えば道 $ (1,2),(1,3),(3,4) $ の $ 3 $ つを作ることですべての町の要請を満たすことができ、これが最小です。 - $ P_1\ =\ 2,\ P_2\ =\ 1,\ P_3\ =\ 2,\ P_4\ =\ 3 $ とする。このとき、例えば道 $ (1,2),(1,3),(3,4) $ の $ 3 $ つを作ることですべての町の要請を満たすことができ、これが最小です。 - $ P_1\ =\ 2,\ P_2\ =\ 1,\ P_3\ =\ 4,\ P_4\ =\ 3 $ とする。このとき、例えば道 $ (1,2),(3,4) $ の $ 2 $ つを作ることですべての町の要請を満たすことができ、これが最小です。 必ずしも町 $ i $ と町 $ P_i $ が直接繋がっている必要がないことに注意してください。 よって、総和は $ 8 $ です。

### Sample Explanation 2

初めから要請が $ 1 $ 通りに決まっている場合もあります。

## 样例 #1

### 输入

```
4

2 1 -1 3
```

### 输出

```
8
```

## 样例 #2

### 输入

```
2

2 1
```

### 输出

```
1
```

## 样例 #3

### 输入

```
10

2 6 9 -1 6 9 -1 -1 -1 -1
```

### 输出

```
527841
```



---

---
title: "Binary Programming"
layout: "post"
diff: 省选/NOI-
pid: AT_nomura2020_e
tag: []
---

# Binary Programming

## 题目描述

[problemUrl]: https://atcoder.jp/contests/nomura2020/tasks/nomura2020_e

高橋くんは、空文字列 $ S $ と、$ 0 $ で初期化された変数 $ x $ を持っています。

また `0` および `1` のみからなる文字列 $ T $ があります。

高橋くんはこれから、以下の $ 2 $ ステップからなる操作を $ |T| $ 回繰り返します。

- $ S $ の好きな位置に `0` または `1` を挿入する。
- 次に、$ S $ の左から奇数番目に書かれた数字の総和を $ x $ に加算する。例えば現在 $ S $ が `01101` であるなら、$ S $ の左から奇数番目に書かれた数字は左から `0`, `1`, `1` なので、$ 2 $ を $ x $ に加算する。

最終的に $ S $ が $ T $ に一致するような操作列における、最終的な $ x $ の値の最大値を出力してください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ T $

## 输出格式

最終的に $ S $ が $ T $ に一致するような操作列における、最終的な $ x $ の値の最大値を出力せよ。

## 说明/提示

### 制約

- $ 1\ \leq\ |T|\ \leq\ 2\ \times\ 10^5 $
- $ T $ は `0` および `1` のみからなる。

### Sample Explanation 1

例えば以下のような操作列が、最終的な $ x $ の値を $ 5 $ に最大化します。 - $ S $ の先頭に `1` を挿入する。$ S $ は `1` になり、$ x $ に $ 1 $ を加算する。 - $ S $ の $ 1 $ 文字目の直後に `0` を挿入する。$ S $ は `10` になり、$ x $ に $ 1 $ を加算する。 - $ S $ の $ 2 $ 文字目の直後に `1` を挿入する。$ S $ は `101` になり、$ x $ に $ 2 $ を加算する。 - $ S $ の先頭に `1` を挿入する。$ S $ は `1101` になり、$ x $ に $ 1 $ を加算する。

## 样例 #1

### 输入

```
1101
```

### 输出

```
5
```

## 样例 #2

### 输入

```
0111101101
```

### 输出

```
26
```



---

---
title: "Multiple Swap"
layout: "post"
diff: 省选/NOI-
pid: AT_pakencamp_2021_day2_i
tag: []
---

# Multiple Swap

## 题目描述

[problemUrl]: https://atcoder.jp/contests/pakencamp-2021-day2/tasks/pakencamp_2021_day2_i

長さ $ N-1 $ の正整数 $ A=(A_2,A_3,\ldots,A_N),B=(B_2,B_3,\ldots,B_N) $ が与えられます。(添字が $ 2 $ から始まることに注意してください)

数列 $ A $ に対して以下の操作を $ 10^6 $ 回以下行って $ A=B $ にする方法があるか判定し、あるならば $ 1 $ つ構築してください。

- 整数 $ i\ (2\ \le\ i) $ とその倍数 $ j $ を選び、$ A_i $ の値と $ A_j $ の値を交換する。なお、このとき $ i=j $ であってもよい。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ A_2 $ $ A_3 $ $ \ldots $ $ A_N $ $ B_2 $ $ B_3 $ $ \ldots $ $ B_N $

## 输出格式

$ A=B $ とする方法が存在するならば、以下の形式で出力せよ。

> $ M $ $ I_1 $ $ J_1 $ $ I_2 $ $ J_2 $ $ \vdots $ $ I_M $ $ J_M $

ここで、 $ M\ (0\ \le\ M\ \le\ 10^6) $ は操作回数を表し、 $ I_k,J_k $ は $ k\ (1\ \le\ k\ \le\ M) $ 回目の操作で選ぶ $ i,j $ を表す。

$ A=B $ とする方法が存在しないならば、 `-1` と出力せよ。

## 说明/提示

### 制約

- $ 2\ \le\ N\ \le\ 50000 $
- $ 1\ \le\ A_i,B_i\ \le\ 50000\ (2\ \le\ i\ \le\ N) $
- 入力は全て整数

### Sample Explanation 3

原案: \[turtle0123\\\_\\\_\](https://atcoder.jp/users/turtle0123\_\_)

## 样例 #1

### 输入

```
4

3 2 4

4 2 3
```

### 输出

```
1

2 4
```

## 样例 #2

### 输入

```
2

3

4
```

### 输出

```
-1
```

## 样例 #3

### 输入

```
6

4 1 3 2 5

1 5 4 2 3
```

### 输出

```
3

3 6

2 4

2 6
```



---

---
title: "Fractal Shortest Path"
layout: "post"
diff: 省选/NOI-
pid: AT_panasonic2020_f
tag: []
---

# Fractal Shortest Path

## 题目描述

[problemUrl]: https://atcoder.jp/contests/panasonic2020/tasks/panasonic2020_f

非負整数 $ K $ に対し、以下のようにレベル $ K $ のフラクタルを定義します。

- レベル $ 0 $ のフラクタルとは、白いマス一個のみからなるグリッドである。
- $ K\ >\ 0 $ のとき、レベル $ K $ のフラクタルは $ 3^K\ \times\ 3^K $ のグリッドである。このグリッドを $ 3^{K-1}\ \times\ 3^{K-1} $ のブロック $ 9 $ 個に分割したとき、
  - 中央のブロックは全て黒マスからなる。
  - 他の $ 8 $ 個のブロックは、レベル $ K-1 $ のフラクタルになっている。

たとえば、レベル $ 2 $ のフラクタルは下図の通りです。

![レベル 2 のフラクタル](https://cdn.luogu.com.cn/upload/vjudge_pic/AT_panasonic2020_f/b750f0bcdb56d49489148f9973188d07d9333b40.png)

レベル $ 30 $ のフラクタルにおいて、上から $ r $ 番目、左から $ c $ 番目のマスを $ (r,\ c) $ と書きます。

$ Q $ 個の整数組 $ (a_i,\ b_i,\ c_i,\ d_i) $ が与えられます。 それぞれの組について、$ (a_i,\ b_i) $ から $ (c_i,\ d_i) $ への距離を求めてください。

ただし、$ (a,\ b) $ から $ (c,\ d) $ への距離とは、以下の条件を満たすような最小の $ n $ とします。

- ある白マスの列 $ (x_0,\ y_0),\ \ldots,\ (x_n,\ y_n) $ が存在して、以下の条件を満たす。
  - $ (x_0,\ y_0)\ =\ (a,\ b) $
  - $ (x_n,\ y_n)\ =\ (c,\ d) $
  - 任意の $ i\ (0\ \leq\ i\ \leq\ n-1) $ に対し、マス $ (x_i,\ y_i) $ と $ (x_{i+1},\ y_{i+1}) $ は辺で接する。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ Q $ $ a_1\ b_1\ c_1\ d_1 $ $ : $ $ a_Q\ b_Q\ c_Q\ d_Q $

## 输出格式

$ Q $ 行出力せよ。 $ i $ 行目には、$ (a_i,\ b_i) $ から $ (c_i,\ d_i) $ への距離を出力せよ。

## 说明/提示

### 制約

- $ 1\ \leq\ Q\ \leq\ 10000 $
- $ 1\ \leq\ a_i,\ b_i,\ c_i,\ d_i\ \leq\ 3^{30} $
- $ (a_i,\ b_i)\ \neq\ (c_i,\ d_i) $
- $ (a_i,\ b_i),\ (c_i,\ d_i) $ は白マスである。
- 入力は全て整数である。

### Sample Explanation 1

!\[\](https://img.atcoder.jp/panasonic2020/b590cee9850abdad4109ab940f9efe5a.png)

## 样例 #1

### 输入

```
2

4 2 7 4

9 9 1 9
```

### 输出

```
5

8
```



---

---
title: "Nice to Meet You"
layout: "post"
diff: 省选/NOI-
pid: AT_relay2_i
tag: []
---

# Nice to Meet You

## 题目描述

[problemUrl]: https://atcoder.jp/contests/cf17-relay-open/tasks/relay2_i

りんご海に $ N $ 個の島が浮かんでおり、$ M $ 社の業者がこれらの島を結ぶ船便を運行しています。便宜上、これらの島を島 $ 1, $ $ 2, $ $ …, $ $ N $ と呼び、これらの業者を業者 $ 1 $, $ 2 $, $ …, $ $ M $ と呼びます。

りんご海の海流は毎日大きく変わります。業者 $ i $ $ (1\ <\ =\ i\ <\ =\ M) $ は、その日の海の状況に応じて、島 $ a_i $ から $ b_i $ への便または島 $ b_i $ から $ a_i $ への便のどちらか一方のみを運行します。どちらの方向の便が運行されるかは、それぞれの業者について独立に、等確率で決定されるものとします。

いま、島 $ 1 $ に高橋くんが、島 $ 2 $ に低橋くんがいます。$ M $ 社の業者による船便を用いて、高橋くんと低橋くんがその日のうちに同じ島に移動することができる確率を $ P $ とします。ただし、船の所要時間などは無視します。このとき、$ P\ ×\ 2^M $ は整数となります。$ P\ ×\ 2^M $ を $ 10^9\ +\ 7 $ で割ったあまりを求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ M $ $ a_1 $ $ b_1 $ $ : $ $ a_M $ $ b_M $

## 输出格式

値 $ P\ ×\ 2^M $ を $ 10^9\ +\ 7 $ で割ったあまりを出力せよ。

## 说明/提示

### 制約

- $ 2\ <\ =\ N\ <\ =\ 15 $
- $ 1\ <\ =\ M\ <\ =\ N(N-1)/2 $
- $ 1\ <\ =\ a_i\ <\ b_i\ <\ =\ N $
- 組 $ (a_i,\ b_i) $ はすべて異なる。

### Sample Explanation 1

!\[36cba65088d9b1224a6ce9665aa44048.png\](https://img.atcoder.jp/relay2/36cba65088d9b1224a6ce9665aa44048.png) 上図に示した $ 2^M\ =\ 8 $ 通りの状況が等確率で発生し、そのうち高橋くんと低橋くんが同じ島で出会える状況は $ 6 $ 通りです。したがって、$ P\ =\ 6/2^M, $ $ P\ ×\ 2^M\ =\ 6 $ となります。

## 样例 #1

### 输入

```
4 3

1 3

2 3

3 4
```

### 输出

```
6
```

## 样例 #2

### 输入

```
5 5

1 3

2 4

3 4

3 5

4 5
```

### 输出

```
18
```

## 样例 #3

### 输入

```
6 6

1 2

2 3

3 4

4 5

5 6

1 6
```

### 输出

```
64
```



---

---
title: "Indifferent"
layout: "post"
diff: 省选/NOI-
pid: AT_relay2_j
tag: []
---

# Indifferent

## 题目描述

[problemUrl]: https://atcoder.jp/contests/cf17-relay-open/tasks/relay2_j

$ 2N $ 個の壺があります。このうち $ i $ 個目の壺 $ (1\ <\ =\ i\ <\ =\ 2N) $ の市場価格は $ p_i $ 円です。

これから、あなたとダックスフンドのルンルンは交互に壺を一つずつ取っていきます。あなたから始めて、すべての壺があなたかルンルンに取られるまで続けます。ルンルンは壺の市場価格がわからないので、毎回、残っている壺の中から無作為に等確率で一つを選びます。あなたはこのルンルンの行動と、壺の市場価格を知っています。

あなたの目的は、取る壺の市場価格の合計を $ S $ 円としたとき、$ S $ の期待値を最大化することです。最適な戦略を取ったときの $ S $ の期待値を求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ p_1 $ $ : $ $ p_{2N} $

## 输出格式

$ S $ の期待値を最大化する戦略を取ったときの $ S $ の期待値を出力せよ。出力は、ジャッジの出力からの絶対誤差または相対誤差が $ 10^{-9} $ 以下であれば正答とみなされる。

## 说明/提示

### 制約

- $ 1\ <\ =\ N\ <\ =\ 10^5 $
- $ 1\ <\ =\ p_i\ <\ =\ 2\ ×\ 10^5 $
- 入力値はすべて整数である。

### Sample Explanation 1

当然、$ 15 $ 万円の壺を選ぶべきです。

### Sample Explanation 2

あなたはまず、$ 10 $ 万円の壺のうち一つを取ります。もう一つの $ 10 $ 万円の壺は、次のルンルンの番で取られなければ手に入り、その確率は $ 2/3 $ です。もしその壺を取られてしまった場合は、$ 5 $ 万円の壺で我慢することになります。以上から、最適な戦略を取ったときの $ S $ の期待値は $ 2/3\ ×\ (100000\ +\ 100000)\ +\ 1/3\ ×\ (100000\ +\ 50000)\ =\ 183333.3333… $ となります。

## 样例 #1

### 输入

```
1

150000

108
```

### 输出

```
150000.0
```

## 样例 #2

### 输入

```
2

50000

50000

100000

100000
```

### 输出

```
183333.3333333333
```



---

---
title: "部分文字列"
layout: "post"
diff: 省选/NOI-
pid: AT_s8pc_2_e
tag: []
---

# 部分文字列

## 题目描述

[problemUrl]: https://atcoder.jp/contests/s8pc-2/tasks/s8pc_2_e

$ square1001 $「$ E869120 $は全て文字の$ character $が違うが、$ square1001 $は文字の$ character $が一致するものが$ 2 $個もある！」

$ E869120 $「ということは、部分文字列の種類数も違うのでは…」

$ square1001 $「たとえば$ 1001 $では、$ 2 $文字目だけの$ '0' $と$ 3 $文字目だけの$ '0' $が重複しているのではないか！($ '1' $もそうです)」

ということで、今回は文字列Sの部分文字列を全て列挙し、文字列の重複を$ 1 $つにまとめて数えたときのの文字数の合計を求めてください。

例えば、$ "aba" $のとき、{$ "a","b","a","ab","ba","aba" $}の$ 6 $通りが考えられますが、$ "a" $は重複しているので、

部分文字列としては$ 5 $種類が考えられます。

{$ "a","b","ab","ba","aba" $}の合計$ 1+1+2+2+3=\ 9 $文字となります。

注意：答えは$ 32 $ビット整数型に収まらない可能性があります。

- $ a,\ b,\ c,\ ab,\ bc,\ abc $ が $ abc $ の部分文字列であり, 合計は $ 10 $ 文字である。

- 重複があることに注意してください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ S $

- $ 1 $ 行目には, 調べる文字列$ S $ が与えられる。

## 输出格式

出力は以下の形式で標準出力に従うこと。

- 部分文字列として考えられる文字列$ ( $重複は$ 1 $つにまとめて数える$ ) $の合計の長さを$ 1 $行で出力してください。
- ただし、答えは$ 32 $ビット整数型に収まらない可能性があります。

## 说明/提示

### 制約

- $ 1 $ ≦ $ |S| $ ≦ $ 100,000 $
- 含まれる文字の種類はalphabetの小文字だけ

### 小課題

小課題 $ 1 $ \[ $ 15 $ 点 \]

- $ 1≦|S|≦100 $ を満たす。

小課題 $ 2 $ \[ $ 35 $ 点 \]

- $ 1≦|S|≦2,000 $ を満たす。

小課題 $ 3 $ \[ $ 50 $ 点 \]

- 追加の制約はない。

## 样例 #1

### 输入

```
abc
```

### 输出

```
10
```

## 样例 #2

### 输入

```
aaqqz
```

### 输出

```
33
```

## 样例 #3

### 输入

```
atcoder
```

### 输出

```
84
```



---

---
title: "Enormous Atcoder Railroad"
layout: "post"
diff: 省选/NOI-
pid: AT_s8pc_4_e
tag: []
---

# Enormous Atcoder Railroad

## 题目描述

[problemUrl]: https://atcoder.jp/contests/s8pc-4/tasks/s8pc_4_e



## 输入格式

> $ N $ $ K $ $ X $ $ S_0 $ $ S_1 $ $ S_2 $ ... $ S_{K-1} $

## 输出格式

通り数を $ 10^9\ +\ 7 $ で割った余りを1行に出力しなさい。  
 最後には改行を入れること。

## 说明/提示

### 制約

- $ 2\ <\ =\ K\ <\ =\ 2500 $.
- $ 1\ <\ =\ X\ <\ =\ 2500 $.
- $ S_0\ =\ 0,\ S_{K-1}\ =\ N $.
- $ 1\ <\ =\ S_{i\ +\ 1}\ -\ S_i\ <\ =\ 10000 $.

### 得点

 小課題1 \[$ 120 $ 点\]

- $ N,\ K,\ X\ <\ =\ 15 $.
 
 小課題2 \[$ 90 $ 点\]   
- K, X &lt;= 15
. - $ S_{i\ +\ 1}\ -\ S_i\ <\ =\ 15 $.
 
 小課題3 \[$ 260 $ 点\]   
- $ K,\ X\ <\ =\ 40 $.
- $ S_{i\ +\ 1}\ -\ S_i $ ≦ $ 40 $.
 
 小課題4 \[$ 160 $ 点\]   
- $ K,\ X\ <\ =\ 300 $.
- $ S_{i\ +\ 1}\ -\ S_i\ <\ =\ 300 $.
 
 小課題5 \[$ 370 $ 点\]   
- 追加の制約はない。

### Sample Explanation 1

目的を達成できない駅の集合は、$ [0,\ 7],\ [0,\ 1,\ 7],\ [0,\ 1,\ 2,\ 7],\ [0,\ 1,\ 6,\ 7],\ [0,\ 1,\ 2,\ 6,\ 7],\ [0,\ 1,\ 2,\ 3,\ 6,\ 7],\ [0,\ 1,\ 2,\ 5,\ 6,\ 7],\ [0,\ 1,\ 2,\ 3,\ 5,\ 6,\ 7],\ [0,\ 1,\ 2,\ 3,\ 4,\ 5,\ 6,\ 7] $ の $ 9 $ 個です。 よって、合計で $ 2^6\ -\ 9\ =\ 55 $ 個となります。

## 样例 #1

### 输入

```
7 2 3

0 7
```

### 输出

```
55
```



---

---
title: "Lunch Menu"
layout: "post"
diff: 省选/NOI-
pid: AT_s8pc_5_f
tag: []
---

# Lunch Menu

## 题目描述

[problemUrl]: https://atcoder.jp/contests/s8pc-5/tasks/s8pc_5_f

AtCoder カフェでは $ N $ 個の食事があり, 番号が $ 1 $ から $ N $ までつけられている. 食事 $ i\ (1\ \leq\ i\ \leq\ N) $ のおいしさは $ a_i $ である.  
 square1001 君は, $ Q $ 日間 AtCoder カフェで食事をする. $ i\ (1\ \leq\ i\ \leq\ Q) $ 日目の食事では, 番号が $ l_i $ 以上 $ r_i $ 以下の食事の中から最もおいしさの値が大きいものを選ぶ. また, そのような食事がない場合は食事をせずに帰る.

あなたは悪魔であり, 魔力で $ N $ 個中 $ M $ 個の食事をメニューからかき消して選べないようにすることができる. あなたの目的は square1001 君の選ぶ食事のおいしさの合計を最小化することである.  
 square1001 君の選ぶ食事のおいしさの合計の最小値を求めなさい.

## 输入格式

入力は以下の形式で標準入力から与えられる.

> $ N $ $ M $ $ Q $ $ a_1\ a_2\ a_3\ \cdots\ a_N $ $ l_1\ r_1 $ $ l_2\ r_2 $ $ l_3\ r_3 $ : : $ l_Q\ r_Q $

## 输出格式

square1001 の選ぶ食事のおいしさの合計の最小値を, 1 行で出力しなさい.

## 说明/提示

### 制約

- $ N $ は $ 1 $ 以上 $ 50 $ 以下の整数.
- $ M $ は $ 0 $ 以上 $ N $ 以下の整数.
- $ Q $ は $ 1 $ 以上 $ 50 $ 以下の整数.
- $ a_i\ (1\ \leq\ i\ \leq\ N) $ は $ 1 $ 以上 $ 1\ 000\ 000\ 000 $ 以下の整数.
- $ l_i,\ r_i $ は $ 1\ \leq\ l_i\ \leq\ r_i\ \leq\ N $ を満たす整数.

### 小課題

小課題 $ 1 $ \[$ 60 $ 点\]

- $ N\ \leq\ 15 $.
- $ Q\ =\ 1 $.

小課題 $ 2 $ \[$ 60 $ 点\]

- $ N\ \leq\ 15 $.

小課題 $ 3 $ \[$ 250 $ 点\]

- すべての $ i\ (1\ \leq\ i\ \leq\ N) $ に対して, $ a_i\ =\ 1 $.

小課題 $ 4 $ \[$ 630 $ 点\]

- 追加の制約はない.

### Sample Explanation 1

もしあなたが番号 $ 2 $, $ 3 $ の食事を消すと, それぞれの日の美味しさの最大値は $ 4 $, $ 3 $, $ 8 $, $ 4 $, $ 8 $ となり, 合計が $ 27 $ となる.

## 样例 #1

### 输入

```
5 2 5

4 9 6 3 8

1 3

2 4

3 5

1 4

2 5
```

### 输出

```
27
```

## 样例 #2

### 输入

```
5 0 4

8 6 9 1 2

1 3

4 5

2 5

4 4
```

### 输出

```
21
```

## 样例 #3

### 输入

```
8 5 3

1 1 1 1 1 1 1 1

2 5

1 3

6 8
```

### 输出

```
1
```



---

---
title: "Percepts of AtCoder 2"
layout: "post"
diff: 省选/NOI-
pid: AT_s8pc_6_h
tag: []
---

# Percepts of AtCoder 2

## 题目描述

[problemUrl]: https://atcoder.jp/contests/s8pc-6/tasks/s8pc_6_h

E869120 は square1001 に、今年から $ Q $ 年間誕生日に数列をプレゼントすることにしました。  
 square1001 は、「プレゼントする数列の長さが短い方がよりコンパクトで良い」と言ったので、プレゼントする数列は出来るだけ短くしたいです。また、古から伝わる AtCoder 社の教えに基づいて、プレゼントする数列を決める必要があります。

AtCoder 社の教えとは、以下のようなものです。

- 数列の要素は全て **異なる**。
- プレゼントする数列に部分列として出現する数列のうち、単調増加列であるようなものの種類数はちょうど、聖なる数 $ K $ 個である。

ここで、数列 $ A\ =\ (A_1,\ A_2,\ ...,\ A_N) $ の「部分列」とは、$ A $ から $ 0 $ 個以上 $ N $ 個以下の値を消して、残った値の順序を変えずにできる数列のことです。  
 また、数列 $ A\ =\ (A_1,\ A_2,\ ...,\ A_N) $ が「単調増加列」である条件は、$ A_1\ <\ A_2\ <\ ...\ <\ A_N $ であることです。

例えば、$ A\ =\ (3,\ 4,\ 1,\ 2) $ の時、部分列として出現する「単調増加列」は $ (),\ (1),\ (2),\ (3),\ (4),\ (1,\ 2),\ (3,\ 4) $ の $ 7 $ 個です。

AtCoder 社では、毎年「聖なる数」が変わります。具体的には、$ i $ 年目の聖なる数は $ K_i $ です。  
 E869120 君のために、$ i $ 年目にプレゼントするべき数列を求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられます。

> $ Q $ $ K_1 $ $ K_2 $ $ K_3 $ ... $ K_Q $

## 输出格式

以下のように $ Q $ 行に渡って出力してください。

> ($ 1 $ 年目の数列の情報) ($ 2 $ 年目の数列の情報) ($ 3 $ 年目の数列の情報) ... ($ Q $ 年目の数列の情報)

ただし、数列の情報は以下のように出力してください。

> $ N $ $ A_1 $ $ A_2 $ $ A_3 $ ... $ A_N $

出力する数列は、以下の条件を満たす必要があります。

- $ 0\ \leq\ N\ \leq\ 128 $
- $ 0\ \leq\ A_i\ \leq\ 999 $
- $ A_i\ \neq\ A_j\ (i\ \neq\ j) $

## 说明/提示

### 制約

- $ Q $ は $ 1 $ 以上 $ 1\ 000 $ 以下の整数
- $ K_i $ は $ 1 $ 以上 $ 5\ 000\ 000\ 000\ 000\ 000\ 000\ (=\ 5\ \times\ 10^{18}) $ 以下の整数

### 小課題・得点

1. (30 点)：$ K_i\ \leq\ 100 $ を満たす。
2. (70 点)：$ K_i\ \leq\ 1\ 500 $ を満たす。
3. (1400 点) : 追加の制約はない。

ただし、小課題 $ 3 $ について、以下のように得点が決定します。  
 ここでは、$ Q $ 年間における $ N $ の最大値を $ L $ とします。また、全てのテストケースにおける $ L $ の最大値を $ L' $ とします。

- $ 120\ \leq\ L'\ \leq\ 128 $ のとき、この小課題の得点は $ 125 $ 点
- $ 100\ \leq\ L'\ \leq\ 119 $ のとき、この小課題の得点は $ 1400\ \times\ 5^{-(L'\ -\ 99)\ /\ 20} $ 点
- $ 0\ \leq\ L'\ \leq\ 99 $ のとき、この小課題の得点は $ 1400 $ 点

### Sample Explanation 1

$ 1 $ 年目のプレゼントとして渡す数列は、$ (2,\ 3,\ 1) $ です。 この数列には、増加部分列が $ 5 $ 個あります。$ (),\ (1),\ (2),\ (3),\ (2,\ 3) $ です。

## 样例 #1

### 输入

```
2

5

10
```

### 输出

```
3 2 3 1

6 8 6 9 1 2 0
```

## 样例 #2

### 输入

```
3

20

100

869120
```

### 输出

```
9 9 7 3 6 5 8 4 1 2

10 0 5 9 3 6 1 4 2 7 8

72 47 45 28 9 41 50 33 61 27 15 38 54 52 22 57 7 30 12 46 21 19 8 71 20 23 6 18 26 17 39 4 53 44 3 31 68 29 42 62 37 69 67 40 65 2 55 36 35 11 49 24 25 43 48 0 1 16 10 70 66 64 32 5 51 60 63 58 56 59 13 14 34
```



---

---
title: "Snuke Density"
layout: "post"
diff: 省选/NOI-
pid: AT_snuke21_h
tag: []
---

# Snuke Density

## 题目描述

[problemUrl]: https://atcoder.jp/contests/snuke21/tasks/snuke21_h





---

---
title: "Convex Polygon"
layout: "post"
diff: 省选/NOI-
pid: AT_snuke21_i
tag: []
---

# Convex Polygon

## 题目描述

[problemUrl]: https://atcoder.jp/contests/snuke21/tasks/snuke21_i





---

---
title: "Drink Bar"
layout: "post"
diff: 省选/NOI-
pid: AT_snuke21_j
tag: []
---

# Drink Bar

## 题目描述

[problemUrl]: https://atcoder.jp/contests/snuke21/tasks/snuke21_j





---

---
title: "建物"
layout: "post"
diff: 省选/NOI-
pid: AT_soundhound2018_d
tag: []
---

# 建物

## 题目描述

[problemUrl]: https://atcoder.jp/contests/soundhound2018/tasks/soundhound2018_d

kenkooooさんはSoundHound社で働いています。建物は $ H $ 階建てで、$ 1 $ つのフロアは $ W $ 個の東西に直線上につながった部屋からなります。上から $ i $ 番目の階の、西から $ j $ 番目の部屋を部屋 $ (i,j) $ と呼ぶことにします。

いま、kenkooooさんは部屋 $ (1,1) $ にいます。kenkooooさんは以下の動作を繰り返すことで、地上階(上から $ H $ 番目の階)の部屋から建物を出ることにしました:

- 部屋 $ (i,j) $ にいるとき、存在するなら部屋 $ (i,j-1) $に移動する。
- 部屋 $ (i,j) $ にいるとき、存在するなら部屋 $ (i,j+1) $に移動する。
- 部屋 $ (i,j) $ にいるとき、存在するなら部屋 $ (i+1,j) $に移動する。

ただし、地上階にたどり着いてからも移動をしてもかまいません。

さらに、部屋 $ (i,j) $ には $ P_{i,j} $ 円が落ちており、その部屋に初めて入るときkenkooooさんはこれを拾います。

一方で、部屋 $ (i,j) $ に入るたびに、入室料として $ F_{i,j} $ 円を払う必要があります。

kenkooooさんはすでに十分大きい金額を今持っているため、途中で手持ちのお金がなくなってしまうことはありません。部屋 $ (H,j) $ から建物を出るとき、この建物で最大いくら得ることができるかをすべての $ 1≦j≦W $ について求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ H $ $ W $ $ P_{1,1} $ $ ... $ $ P_{1,W} $ $ : $ $ P_{H,1} $ $ ... $ $ P_{H,W} $ $ F_{1,1} $ $ ... $ $ F_{1,W} $ $ : $ $ F_{H,1} $ $ ... $ $ F_{H,W} $

## 输出格式

部屋 $ (H,j) $ から建物を出るとき、この建物で得ることのできる利益の最大値を $ j $ の昇順に出力してください。

## 说明/提示

### 制約

- $ 2≦H≦10 $
- $ 1≦W≦5×10^4 $
- $ 0≦P_{i,j}\ <\ 10^5 $
- $ 0≦F_{i,j}\ <\ 10^5 $

### Sample Explanation 1

例えば、部屋 $ (2,1) $ にたどり着くには、$ (1,1),(1,2),(1,3),(1,2),(2,2),(2,1) $ の順に訪れることで、$ 2+1+3+3 $ 円を手にしつつ、$ 2+2+5 $ 円を払うことで合計 $ 0 $ 円の利益を得ることができます。

### Sample Explanation 2

部屋 $ (1,1) $ でも入室料を取られること、地上にたどり着いた後も動いてよいこと、最終的な利益が負になることもあることに注意してください。

## 样例 #1

### 输入

```
2 4

2 1 3 0

0 3 0 3

0 2 0 0

5 0 5 0
```

### 输出

```
0

5

2

7
```

## 样例 #2

### 输入

```
2 4

2 0 3 5

1 3 1 3

1 3 2 1

0 0 0 10
```

### 输出

```
6

6

6

-1
```

## 样例 #3

### 输入

```
3 4

1 2 3 4

4 3 2 1

2 4 3 1

1 4 2 3

3 4 1 2

4 1 3 2
```

### 输出

```
2

4

3

2
```



---

---
title: "連結"
layout: "post"
diff: 省选/NOI-
pid: AT_tdpc_concatenation
tag: []
---

# 連結

## 题目描述

[problemUrl]: https://atcoder.jp/contests/tdpc/tasks/tdpc_concatenation

入力は以下の形式で標準入力から与えられる。

> $ N $ $ L $ $ w_1 $ $ ... $ $ w_N $

 答えを一行に出力せよ。 ```

4 10
00
01
10
11
```

```

1024
```

```

3 5
01
10
0
```

```

14
```

## 说明/提示

### Constraints

 $ N $ 個の 0, 1 からなる文字列 $ w_1 $, ..., $ w_N $ がある。すぬけ君は、この中から文字列をいくつか選び、好きな順番で連結して文字列を作ることにした (同じ文字列を複数回選んでもよい)。このようにして作ることのできる長さ $ L $ の文字列の個数を mod 1,000,000,007 で求めよ。ただし、文字列として同じであれば、連結のしかたが異なるものも同じであるとみなす。

- - - - - -

- $ 1\ <\ =\ N\ <\ =\ 510 $
- $ 1\ <\ =\ |w_i|\ <\ =\ 8 $
- $ 1\ <\ =\ L\ <\ =\ 100 $
- Each character in $ w_i $ will be either '0' or '1'.
- $ w_i $ are pairwise distinct.



---

---
title: "フィボナッチ"
layout: "post"
diff: 省选/NOI-
pid: AT_tdpc_fibonacci
tag: []
---

# フィボナッチ

## 题目描述

### 题目大意
已知一个数列 $a$ ，它的前 $K$ 项都等于 $1$，从第 $K+1$ 项开始，每一项等于它前 $K$ 项的和，求 $a_N$ 项是多少。

## 输入格式

一行，为两个数据，分别为 $K$ 与 $N$。

## 输出格式

一行，表示 $a_N \bmod 10^9+7$ 的值。



---

---
title: "グラフ"
layout: "post"
diff: 省选/NOI-
pid: AT_tdpc_graph
tag: []
---

# グラフ

## 题目描述

# 图
## 问题描述
有一个由 $ N $ 个结点组成的有向图。当 $ g_{i,j}\ =\ 1 $ 时，从结点 $ i $ 到结点 $ j $ 有一条有向边。最初，所有结点都涂成白色。 Sunuke 君可以执行两次以下操作。
选择一个结点并沿着该结点的有向边访问几个结点。同一个结点可以重复多次。
将所有多次通过的结点涂成黑色。
求出两次操作后，涂成黑色的顶点数的最大值。

## 输入格式

输入以以下格式给出：

 $ N $ 
 
 $ g_{1,1}\ \ \ ...\ \ \ g_{1,N} $ 
 
 $ ...\ \ \ \ \ \ ...\ \ \ \ \ ...$ 
 
 $ g_{N,1}\ \ \ ...\ \ \ g_{N,N} $

## 输出格式

将答案输出为一行。
## 数据限制
- $ 1\ \leq\ N\ \leq\ 300 $
- $ 0\ \leq\ g_{i,j}\ \leq\ 1 $
- $ g_{i,i}\ =\ 0 $



---

---
title: "マス目"
layout: "post"
diff: 省选/NOI-
pid: AT_tdpc_grid
tag: []
---

# マス目

## 题目描述

[problemUrl]: https://atcoder.jp/contests/tdpc/tasks/tdpc_grid

入力は以下の形式で標準入力から与えられる。

> $ H $ $ W $

 答えを一行に出力せよ。 ```

2 2
```

```

3
```

```

5 8
```

```

950397139
```

## 说明/提示

### Constraints

 すぬけ君は、$ H $ x $ W $ のマス目を白と黒に塗り分けることにした。

- 左上のマス目と右下のマス目は黒に塗る。
- 左上のマス目から、黒いますを上下左右にたどって、右下のマス目に行くことができる。
 
 条件を満たす塗り分け方の個数を mod 1,000,000,007 で求めよ。 - - - - - -

- $ 2\ <\ =\ H\ <\ =\ 6 $
- $ 2\ <\ =\ W\ <\ =\ 100 $



---

---
title: "辞書順"
layout: "post"
diff: 省选/NOI-
pid: AT_tdpc_lexicographical
tag: []
---

# 辞書順

## 题目描述

[problemUrl]: https://atcoder.jp/contests/tdpc/tasks/tdpc_lexicographical

入力は以下の形式で標準入力から与えられる。

> $ s $ $ K $

 答えを一行に出力せよ。 ```

eel
6
```

```

Eel
```

```

lexicographical
100
```

```

capal
```

## 说明/提示

### Constraints

 文字列 $ s $ の空でない部分列のうち、辞書順で $ K $ 番目のものを求めよ。そのようなものが存在しない場合は "Eel" (quotes for clarity) と出力せよ。   
 ただし、$ s $ から何文字か取り除き (0 文字でもよい)、残りの文字を順番を変えずにつなげたものを部分列という。たとえば、"aba" の部分列は "a", "b", "aa", "ab", "ba", "aba" の 6 個である。"a" は異なる場所に二回現れるが、文字列として同じであれば区別しないものとする。

- - - - - -

- $ 1\ <\ =\ |s|\ <\ =\ 1000000 $
- Each character in s will be a lowercase letter ('a'-'z').
- $ 1\ <\ =\ K\ <\ =\ 10^{18} $



---

---
title: "文字列"
layout: "post"
diff: 省选/NOI-
pid: AT_tdpc_string
tag: []
---

# 文字列

## 题目描述

[problemUrl]: https://atcoder.jp/contests/tdpc/tasks/tdpc_string

入力は以下の形式で標準入力から与えられる。

> $ freq_1 $ $ ... $ $ freq_{26} $

 答えを一行に出力せよ。 ```

1 0 2 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
```

```

6
```

```

1 1 1 1 1 1 1 1 1 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
```

```

3628800
```

## 说明/提示

### Constraints

 以下の条件を満たす文字列の個数を mod 1,000,000,007 で求めよ。

- a を $ freq_1 $ 個、b を $ freq_2 $ 個、... z を $ freq_{26} $ 個含む (他の文字は含まない)。
- 同じ文字が隣り合うことはない。

- - - - - -

- $ 0\ <\ =\ freq_i\ <\ =\ 10 $
- At least one of $ freq_i $ will be nonzero.



---

---
title: "大爆発"
layout: "post"
diff: 省选/NOI-
pid: AT_tenka1_2012_8
tag: []
---

# 大爆発

## 题目描述

[problemUrl]: https://atcoder.jp/contests/tenka1-2012-qualB/tasks/tenka1_2012_8

 マス目から成るステージが与えられ、そのステージに存在するブロックを爆弾を用いて全て壊すゲームを行います。  
 爆弾はブロックのないマスにのみ置くことができ、爆弾は置くとすぐに爆発し上下左右全てのブロックを破壊します。

 例えば、図 $ 1 $ のようなステージで座標 $ (1,3) $ に爆弾を置くと、上下左右 $ 5 $ つのブロックを破壊することができます。  
 以降の座標とはステージの左上のマスを $ (0,0) $ とし、$ 1 $ つ右のマスを $ (1,0) $、$ 1 $ つ下のマスを $ (0,1) $ とします。  
 この際、図 $ 1 $ における爆弾上部のブロックのように爆弾とブロックが隣接していなくても破壊され、ブロックがいくつ連続していても全て破壊されます。  
 また、爆弾右部のブロックのように各ブロックが隣接していなくても全て破壊されます。

 ![](https://cdn.luogu.com.cn/upload/vjudge_pic/AT_tenka1_2012_8/f1e2e278d6a1916ec0af40907a845b851be57aab.png)図 $ 1 $ : 爆弾がブロックを破壊する例

 

 ステージ上にある全てのブロックを破壊するために必要な爆弾の個数を答えなさい。  
 また、全てのブロックを破壊することが不可能な場合は `-1` と出力しなさい。

 入力は以下の形式で標準入力から与えられる。 > $ H $ $ W $ $ c_{(0,0)}c_{(1,0)} $‥‥$ c_{(W-1,0)} $ $ c_{(0,1)}c_{(1,1)} $‥‥$ c_{(W-1,1)} $ : : $ c_{(0,H-1)}c_{(1,H-1)} $‥‥$ c_{(W-1,H-1)} $

- 入力は $ H+1 $ 行ある。
- $ 1 $ 行目には、与えられるステージの縦の長さを表す整数 $ H(1\ <\ =H\ <\ =16) $ と 横の長さを表す整数 $ W(1\ <\ =W\ <\ =16) $ が空白を区切りとして与えられる。
- $ 2 $ 行目からの $ H $ 行には、各行にステージの各マス目に対するブロックの有無を表す状態 $ c_{(i,j)}(0\ <\ =i\ <\ =W-1 $, $ 0\ <\ =j\ <\ =H−1) $ が $ W $ 文字ずつ与えられる。 
  - $ c_{(i,j)} $ は下記のどちらかであり、それぞれ座標 $ (i,j) $ のマスが下記のような状態であることを表す。 
      - `.` : そのマスにブロックが無いことを表し、そのマスには爆弾を置くことができる。
      - `#` : そのマスにブロックがあることを表し、そのマスには爆弾を置くことができない。
 
 ステージのサイズが小さい入力 $ (1\ <\ =W\ <\ =5 $, $ 1\ <\ =H\ <\ =5) $ のみ正解すると、$ 100 $ 点満点に対して部分点として $ 50 $ 点が与えられる。 ステージ上にブロックが $ 1 $ つも存在しない状態にするために必要な爆弾の個数を標準出力に $ 1 $ 行で出力せよ。  
 また、ステージ上にブロックが存在しない状態にすることができない場合は `-1` と出力せよ。  
 なお、行の終端には改行が必要である。 ```

5 5
.#.#.
.#...
...#.
#.#.#
#...#
```

 ```

2
```

- 初期位置は図 $ 1 $ が示す形なので、まず座標 $ (1,3) $ に爆弾を置くと座標 $ (0,3),\ (1,0),\ (1,1),\ (2,3),\ (4,3) $ のブロックを破壊することができます。
- 次に座標 $ (3,4) $ の位置に爆弾を置くことで、残りのブロックを全て破壊できます。
- したがって、ブロックを全て破壊するために必要な爆弾の個数は $ 2 $ 個となります。

```

5 5
.#...
.#...
#####
.#...
.#...
```

 ```

3
```

- まず、座標 $ (0,1) $ に爆弾を置き、$ (0,2) $ と $ (1,1) $ のブロックを破壊します。
- 次に、座標 $ (1,1) $ に爆弾を置き、$ (1,0),\ (1,2),\ (1,3),\ (1,4) $ のブロックを破壊します。
- 最後に、座標 $ (1,2) $ に爆弾を置くことで、残りのブロックを全て破壊することができます。
- したがって、ブロックを全て破壊するために必要な爆弾の個数は $ 3 $ 個となります。

```

1 6
######
```

 ```

-1
```

- どのマスにも爆弾を置くことができないので、ブロックを破壊することができません。
 
```

3 2
..
..
..
```

 ```

0
```

- 与えられた時点でブロックが存在しない状態なので、爆弾は必要ありません。



---

---
title: "天下一展開"
layout: "post"
diff: 省选/NOI-
pid: AT_tenka1_2013_qualA_d
tag: []
---

# 天下一展開

## 题目描述

你需要为朋友タクヤ君编写一个程序，从他提供的特定方式压缩的字符串中获取展开后特定位置的子串。

压缩前的字符串仅由英文字母组成。压缩方法是将连续出现 $n$ 次的子串 $x$ 替换为 `($ x $)$ n $`。例如，`ABABABA` 可以被替换为 `(AB)3A`。其中，子串 $x$ 的长度 $|x| \geq 1$，重复次数 $n \geq 1$。

这种替换操作可以多次进行，例如，字符串 `AAABBAAABB` 可以被替换成 `(AAABB)2`，然后再被替换成 `((A)3BB)2` 或 `((A)3(B)2)2`。

因此，压缩后的字符串（即输入字符串）需要符合以下 [EBNF](http://ja.wikipedia.org/wiki/EBNF) 语法规范：

```
input = string, {string} ;
string = alphabet, {alphabet} | "(", input, ")", positive_number ;
alphabet = "A" | "B" | ... | "Z" | "a" | "b" | ... | "z" ;
positive_number = digit_excluding_zero, {digit} ;
digit_excluding_zero = "1" | "2" | ... | "9" ;
digit = "0" | digit_excluding_zero ;
```

输入格式如下：
- 第一行包含三个整数 $B$、$L$ 和 $N$，分别表示展开后需要引用的部分的起始位置 $B$（$-M \leq B < M$）、子串的长度 $L$（$1 \leq L \leq 10^5$）以及压缩后的字符串长度 $N$（$1 \leq N \leq 10^4$）。其中，$M$ 是压缩前字符串的长度。
- 第二行是压缩后的字符串 $S$。
- 如果 $B$ 是非负的，则从字符串开头（以 $0$ 为起点）开始计数；如果 $B$ 为负的，则从字符串末尾（以 $-1$ 为起点）向前计数。
- 不论 $B$ 的正负，子串都是从起始位置向末尾方向取 $L$ 个字符。题目保证这一定可以得到长度为 $L$ 的子串。

输出格式
- 输出展开后引用的子串，结果占一行，确保行的尾部有换行符。

### 样例输入 
```
0 7 6
(AB)3A
```

### 样例输出 
```
ABABABA
```

### 样例输入 
```
-6 5 11
((A)3(B)2)2
```

### 样例输出 
```
BAAAB
```

### 数据范围与提示
- 压缩前的字符串最大长度为 $10^{15}$
- 对于 $L, N \leq 100$ 且 $M \leq 1000$ 的情形，能够获得部分分数50分，总分130分。
- 对于 $L, N \leq 100$ 的情形，额外获取50分，总分130分。

 **本翻译由 AI 自动生成**



---

---
title: "天下一ジグソーパズル"
layout: "post"
diff: 省选/NOI-
pid: AT_tenka1_2013_qualA_e
tag: []
---

# 天下一ジグソーパズル

## 题目描述

[problemUrl]: https://atcoder.jp/contests/tenka1-2013-quala/tasks/tenka1_2013_qualA_e

 天下一プログラマーコンテストのモノクロポスターが、高橋君のいたずらにより、バラバラにされてしまいました。  
 ポスターは、H\*W個の正方形のタイルを、縦H個、横W個の長方形に敷き詰めて構成されていたのですが、高橋君によって、全てタイル４つで構成される、トの字型のピースに分解されてしまっています。  
 幸運なことに、元のデジタルデータは残っていましたが、残念なことに、印刷するための紙がありません。  
 仕方がないので、あなたはこのピースから、ポスターを修復しなければいけません。

 入力は以下の形式で標準入力から与えられる。

> $ H $ $ W $ $ S_1 $ $ S_2 $ : : $ S_H $ $ N $ $ P_1 $ $ P_2 $ : : $ P_n $

- $ 1 $ 行目には、ポスターの縦の長さ $ H $ と横の長さ$ W $($ 4\ \leq\ H,W\ \leq\ 12 $)が、スペースで区切られて、それぞれ整数で与えられる。
- $ H,\ W $はそれぞれ$ 4 $で必ず割り切れる。

- $ 2 $ 行目から$ H $行は、元のポスターを表す文字列 $ S_i $ が与えられる。この文字列は各行とも $ W $文字である。
- $ S_i $の$ j $文字目は、左上のタイルを$ (1,1) $とした座標$ (j,i) $における、タイルの色を表す。 '#'が黒いタイル、'.'が白いタイルを表す。

- $ H\ +\ 2 $行目には、ピースの数$ N $が与えられる。
- $ H\ +\ 3 $行目から$ N $($ N\ =\ H\ *\ W\ /\ 4 $)行には、与えられるピースの模様の種類$ P_i $($ 1\ \leq\ P_i\ \leq\ 16 $)が与えられる。模様の種類は以下の16種類である。
 
```
<pre class="prettyprint linenums">
.   #   .   #   .   #   .   #   .   #   .   #   .   #   .   #  
..  ..  #.  #.  .#  .#  ##  ##  ..  ..  #.  #.  .#  .#  ##  ## 
.   .   .   .   .   .   .   .   #   #   #   #   #   #   #   #  
1   2   3   4   5   6   7   8   9   10  11  12  13  14  15  16
```

- $ H,\ W\ \leq\ 4 $ の入力に正解すると、$ 150 $ 点満点に対して部分点として $ 30 $ 点が与えられる
- $ H,\ W\ \leq\ 8 $ の入力に正解すると、$ 150 $ 点満点に対して部分点として追加で $ 50 $ 点が与えられる

 パズルを修復する方法を $ n $ 行で出力してください。パズルが復元不可能である場合は、-1と出力してください。  
 i行目には、$ P_i $の置くべき$ X $座標、$ Y $座標、回転方向の3つの整数をスペース区切りで出力してください。 なお、回転方向は、下図のように時計回りに表し、ポスターの左上の座標を$ (1,\ 1) $とし、下記の図のAの位置の座標を出力するとします。

```
<pre class="prettyprint linenums">
A  DBA    D     
BC  C    CB  C  
D         A ABD 
0  1    2   3
```

 なお、行の終端には改行が必要です。答えが複数ある場合は、どれを出力しても構いません。 ```

4 4
#...
.#..
..##
..##
4
9
6
1
8
```

 ```

1 4 3
1 1 0
4 1 1
4 4 2
```

- 下記の図のように、元のポスターを修復することが可能である。

 ![](https://cdn.luogu.com.cn/upload/vjudge_pic/AT_tenka1_2013_qualA_e/9679bde5561ce2148ffc33728f9e8c1ceab2f0b5.png)図 $ 1 $：復元したポスター

 

 ```

4 4
#...
.#..
..##
..##
4
1
2
3
4
```

 ```

-1
```

- 与えられたピースから元のポスターがどうやっても復元できない場合は、-1を出力する。



---

---
title: "天下一ジグソーパズルふたたび"
layout: "post"
diff: 省选/NOI-
pid: AT_tenka1_2013_qualB_c
tag: []
---

# 天下一ジグソーパズルふたたび

## 题目描述

高桥君的恶作剧让天下一程序员大赛的海报被拆散，而翔平君受到启发，决定将这幅海报变成一个 $N \times M$ 的拼图。

每块拼图的相邻边要么是凸的，要么是凹的，外边缘则是直线。我们关心的是这样的一种拼图块：它的一边是直线，而其余三边都是凹的，我们称之为「特殊拼图块」。你的任务是，找出在满足以下条件的情况下，可以拼出最多的「特殊拼图块」：

- 至少要有 $A$ 个四边全是凹形的拼图块。
- 最多只能有 $B$ 个四边全是凸形的拼图块。

输入格式如下：
> $N\ M\ A\ B$

其中，$N$ 和 $M$ 是拼图的高度和宽度，$A$ 是四边凹形拼图块至少需要的数量，$B$ 是四边凸形拼图块最多允许的数量。所有这些数值用空格分隔。

请注意：
- $2 \leq N, M \leq 8$
- $A \geq 0$
- $B \geq 0$
- $A + B \leq (N-2) \times (M-2)$
- 至少存在一种满足条件的拼图构造方式。

特别提示：
- 当 $A = 0$ 且 $B = (N-2) \times (M-2)$ 时，若输入正确，将获得部分得分 30 分（满分120分）。
- 当 $M, N \leq 4$ 时，若输入正确，将获得部分得分 40 分。

请输出「特殊拼图块」的最大数量：

输入样例：
```
3 3 0 1
```
输出样例：
```
4
```

另一个输入样例：
```
3 4 1 1
```
输出样例：
```
3
```

 **本翻译由 AI 自动生成**



---

---
title: "パズルの移動"
layout: "post"
diff: 省选/NOI-
pid: AT_tenka1_2014_qualA_e
tag: []
---

# パズルの移動

## 题目描述

在天下一王国，一款拼图游戏大受欢迎。在这个游戏中，将若干 $1 \times 1$ 的小方块通过边缘相连构成的多边形称作拼图块。当你将给定的拼图块完美拼接成一个 $H \times W$ 的矩形时，拼图便完成了。

高桥君已经成功完成了这款拼图。但他产生了一个有趣的念头：想测试一下用一根食指最多能破坏多少个拼图块。具体来说，他会按住某个拼图块，并将其拖动到最下面。若某个拼图块包含了被按住的方块，这个拼图块的所有部分都会一起被拖动。而且，与被拖动的拼图块底部相连的拼图块也会因此一起被拖动。

高桥君想在进行这个拽动操作之前，预先知道会有多少个 $1 \times 1$ 的方块被卷入其中。

现在给出 $Q$ 个位置作为高桥君可能按住并拖动的选择。你需要对于每一个位置，输出最终被拖动的拼图块的数目。

## 输入格式

从标准输入读取数据，格式如下：

> $ H $ $ W $ $ c_{1,1} $ $ c_{1,2} $ ... $ c_{1,W} $ $ c_{2,1} $ $ c_{2,2} $ ... $ c_{2,W} $ : $ c_{H,1} $ $ c_{H,2} $ ... $ c_{H,W} $ $ Q $ $ x_1 $ $ y_1 $ $ x_2 $ $ y_2 $ : $ x_Q $ $ y_Q $

- 第一行包含两个整数 $H\ (1 \leq H \leq 20000)$ 和 $W\ (1 \leq W \leq 16)$，分别表示拼图的行数和列数。
- 接下来的 $H$ 行中，每行提供一个长度为 $W$ 的字符串，描述拼图的具体信息。字符串中的第 $j$ 个字符 $c_{i,j}$ 表示第 $i$ 行、第 $j$ 列位置的拼图块类型。若相邻（横向或纵向）的拼图块类型相同，则说明它们属于同一个拼图块。注意，$c_{i,j}$ 均为大写字母。
- 第 $H + 2$ 行包含整数 $Q\ (1 \leq Q \leq 100000)$，表示高桥君可能按压的拼图块位置的数量。
- 随后的 $Q$ 行中，每行包含两个整数 $x_i,\ y_i\ (1 \leq x_i \leq W,\ 1 \leq y_i \leq H)$，表示第 $i$ 个候选的按压位置。

## 输出格式

输出共 $Q$ 行，其中每行对应一个位置，表示从该位置开始拽动所能影响到的方块总数。每行输出结尾需换行。

## 说明/提示

###部分分数

若在所有 $Q=1$ 的测试用例中答案正确，可以获得 $30$ 分的部分分。

### 样例解释

1. 对于位置 $(1, 1)$，该方块是 A。拖动 A 后，所有方块都会被拖动。
2. 对于位置 $(2, 3)$，该方块是 D。拖动 D 后，会有 D, F, G, H 被拖动。

注意，即便使用相同字母，不同拼图块也可能为独立的拼图块，这可能影响结果。对于某些拼图，某一类的方块确保所有的拼图块都被拖动。

 **本翻译由 AI 自动生成**

## 样例 #1

### 输入

```
5 3

AAB

ABB

CDE

FFH

GHH

2

1 1

2 3
```

### 输出

```
15

7
```

## 样例 #2

### 输入

```
2 2

AB

BA

2

1 1

2 1
```

### 输出

```
2

2
```

## 样例 #3

### 输入

```
5 5

AABAA

ACDEA

AFGHA

AIJKA

AAAAA

1

3 1
```

### 输出

```
25
```



---

---
title: "天下一芸術"
layout: "post"
diff: 省选/NOI-
pid: AT_tenka1_2014_qualB_d
tag: []
---

# 天下一芸術

## 题目描述

[problemUrl]: https://atcoder.jp/contests/tenka1-2014-qualb/tasks/tenka1_2014_qualB_d



## 输入格式

> $ N $ $ A_1 $ $ A_2 $ : $ A_N $ $ H $ $ W $ $ B_{1,1} $ $ B_{1,2} $ ... $ B_{1,W} $ $ B_{2,1} $ $ B_{2,2} $ ... $ B_{2,W} $ : $ B_{H,1} $ $ B_{H,2} $ ... $ B_{H,W} $

- 1行目では、使用できるペンキの数を表す整数 $ N $ ($ 1\ \leq{}\ N\ \leq{}\ 17 $) が与えられる。
- 2行目から $ N $ 行では、各ペンキの濃さを表す整数 $ A_i $ ($ 0\ \leq{}\ A_i\ \leq{}\ 255 $) が与えられる。
- $ N+2 $ 行目では、設計図の高さを表す整数 $ H $ ($ 1\ \leq{}\ H\ \leq{}\ 200 $) と、設計図の幅を表す整数 $ W $ ($ 1\ \leq{}\ W\ \leq{}\ 200 $) が与えられる。
- $ N+3 $ 行目から $ H $ 行は設計図の情報が与えられる。そのうちの $ y $ ($ 1\ \leq{}\ y\ \leq{}\ H $) 行目には、各マスの番号がスペース区切りで $ W $ 個与えられる。$ y $ 行目の左側から $ x $ ($ 1\ \leq{}\ x\ \leq{}\ W $)番目に、設計図の上から $ y $ マス、左から $ x $ マスの位置のマス目の番号、整数 $ B_{y,x} $ ($ 0\ \leq{}\ B_{y,x}\ \leq{}\ N\ -\ 1 $) が与えられる。

## 输出格式

与えられたペンキで設計図どおりに塗ることが可能なら1、不可能なら0を1行で出力せよ。出力の末尾には改行をいれること。

## 说明/提示

### 部分点

- $ 1\ \leq{}\ N\ \leq{}\ 5 $ かつ $ 1\ \leq{}\ H,\ W\ \leq{}\ 5 $のすべてのテストケースに正解した場合、部分点として35点を与える
- $ 1\ \leq{}\ N\ \leq{}\ 9 $ のすべてのテストケースに正解した場合、部分点としてさらに40点を与える

### Sample Explanation 1

\### 出力例1 ```

```
<pre class="prettyprint linenums">1
```

与えられたペンキを上から順にA, B, C, D, Eとすると以下の順番で塗りわけることが可能です。

 ```
BBB
BBB
```

 ```
BBB
AAA
```

 ```
BCB
AAA
```

 ```
BCB
ADA
```

今回の塗り方ではEは使用しませんでした。<h3>Sample Explanation 2</h3><p>### 出力例2

 ```
</p><pre class="prettyprint linenums">0
```

与えられたペンキで塗ることはできません。<h3>Sample Explanation 3</h3><p>### 出力例3

 ```
</p><pre class="prettyprint linenums">0
```

与えられたペンキで塗ることはできません。<h3>Sample Explanation 4</h3><p>### 出力例4

 ```
</p><pre class="prettyprint linenums">1
```

与えられたペンキを上から順にA, B, C, D, Eとすると以下の順番で塗りわけることが可能です。

 ```
A A # # #
A A # # #
A A # # #
A A # # #
A A # # #
```

 ```
A A B B #
A A B B #
A A B B #
A A B B #
A A B B #
```

 ```
A A B B E
A A B B E
A A B B E
A A B B E
A A B B E
```

 ```
A D D D E
A D D D E
A D D D E
A A B B E
A A B B E
```

 ```
A D D D E
A D D C C
A D D C C
A A B C C
A A B B E
```
```

## 样例 #1

### 输入

```
5

4

0

4

10

4

2 3

3 1 3

0 2 0
```

### 输出

```
None
```

## 样例 #2

### 输入

```
5

4

0

4

10

4

2 4

3 1 2 3

0 1 2 0
```

### 输出

```
None
```

## 样例 #3

### 输入

```
2

1

2

2 2

0 1

1 0
```

### 输出

```
None
```

## 样例 #4

### 输入

```
5

1

1

66

30

1

5 5

3 4 4 4 2

3 4 4 0 0

3 4 4 0 0

3 3 1 0 0

3 3 1 1 2
```

### 输出

```
None
```



---

---
title: "ハシポン"
layout: "post"
diff: 省选/NOI-
pid: AT_tenka1_2015_qualA_d
tag: []
---

# ハシポン

## 题目描述

[problemUrl]: https://atcoder.jp/contests/tenka1-2015-quala/tasks/tenka1_2015_qualA_d

ある連結なグラフについて、取り除くとグラフが非連結になるような辺のことを橋と呼びます。

また、自己辺や多重辺を含まないグラフを単純グラフと呼びます。

ワタナベくんは橋をちょうど1本含む単純グラフをハシポングラフと名づけました。

連結な無向単純グラフが与えられるので、最小で何本の辺を追加したらハシポングラフになるかを求めてください。

ただし、ハシポングラフにすることが不可能な場合は`IMPOSSIBLE`を出力してください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ V $ $ E $ $ a_1 $ $ b_1 $ $ a_2 $ $ b_2 $ : $ a_E $ $ b_E $

- $ 1 $ 行目には与えられるグラフの頂点の数 $ V $ ( $ 1\ \leq\ V\ \leq\ 100,000 $ ) と辺の数 $ E $ ( $ 0\ \leq\ E\ \leq\ 150,000 $ ) が空白区切りで与えられる。
- 続く $ E $ 行には $ i $ 番目の辺がつなぐ頂点の番号 $ a_i $ と $ b_i $ ( $ 0\ \leq{}\ a_i,\ b_i\ \leq{}\ V-1 $ ) が空白区切りで与えられる。
- 与えられるグラフが連結な無向単純グラフであることは保証されている。

## 输出格式

最小の追加すべき辺の数、または`IMPOSSIBLE`を$ 1 $行に出力せよ。出力の末尾に改行を入れること。

## 说明/提示

### 配点

この問題には部分点が設定されている。

- $ V\ \leq\ 20 $ を満たすテストケース全てに正解した場合は、$ 35 $ 点が与えられる。
- $ V\ \leq\ 2000 $ を満たすテストケース全てに正解した場合は、$ 30 $ 点が与えられる。
- 全てのテストケースに正解した場合は、上記とは別に $ 55 $ 点が与えられる。

### Sample Explanation 1

与えられたグラフは既にハシポングラフです。

### Sample Explanation 2

例えば、頂点1と頂点4をつなぐ辺を追加するとハシポングラフにすることが出来ます。

### Sample Explanation 3

ハシポングラフは単純グラフでなければいけません。

## 样例 #1

### 输入

```
4 4

0 1

1 2

2 3

3 1
```

### 输出

```
0
```

## 样例 #2

### 输入

```
5 5

0 1

1 2

2 3

3 1

3 4
```

### 输出

```
1
```

## 样例 #3

### 输入

```
3 2

0 1

1 2
```

### 输出

```
IMPOSSIBLE
```

## 样例 #4

### 输入

```
1 0
```

### 输出

```
IMPOSSIBLE
```



---

---
title: "天下一電卓英作文"
layout: "post"
diff: 省选/NOI-
pid: AT_tenka1_2015_qualB_d
tag: []
---

# 天下一電卓英作文

## 题目描述

计算器上的数字倒过来可以看成字母，如下图所示。ヨシオ想利用这一现象在计算器上写英语作文。

$0.7734$

![](https://cdn.luogu.com.cn/upload/vjudge_pic/AT_tenka1_2015_qualB_d/c5f307fd05f014172339229869067134575b6ccf.png)

倒着看就是 ```hELLO```

![](https://cdn.luogu.com.cn/upload/vjudge_pic/AT_tenka1_2015_qualB_d/d22ec98ea12958915523edfd14f49fad2d1f3357.png)

ヨシオ对这抽象的写作方式非常喜欢，他甚至有一张对照表：

0→```O或D```
1→```I```
2→```Z```
3→```E```
4→```h```
5→```s```
6→```q```
7→```L```
8→```B```
9→```G```

这美妙的对应关系让他对字符串附上了**分值**——每个字符串的得分与它在计算器上正着看时的数值相同。

举个例子，```EGG```得分为 $993$ ，```ODDEGG```得分为 $993000$ 。

注意注意啦，和计算器一样，整数的最高位不能是 $0$ ；

末位字母如果是O或D，则以小数的形式输出（```hELLO```→$0.7734$）;

当然，如果得分的小数点后有多余的 $0$ 是允许的，也就是说```OLD```这样的单词是可以存在的，分数为 $0.7$。

现在你有一个能显示的最大字符串长为 $D$ 的计算器，以及含有 $N$ 个单词的本本，从其中的 $W_1,W_2,W_3......W_n$ 任意一个单词开始，选取不少于 $1$ 个单词随便连成一个字符串，求在最大长度 $D$ 下你能得到的最高分数。

## 输入格式

>$D$ $N$ $W_1$ $W_2$ $:$ $W_n$
- 第一行输入最大长度 $D$ ( $1\le D\le 200$ )
- 第二行输入本本里的单词数 $N$ ( $1\le N \le 10000$ )
- 第三行开始的 $N$ 行每行输入一个单词 $W_i$ ($1\le \left\vert W_i\right\vert  \le \min(32,D)$)，单词组成中不含表外的其他字母。
- 若 $i \ne j$ ，则 $W_i \ne W_j$

## 输出格式

$1$ 行，即最高得分。

若为小数则须删去末尾多余的零，小数部分均为零须以整数输出，且末尾需要换行。

## 说明/提示

此题有部分分。

- $N\le8$ 的样例过了给你 $45$ 分。
- 全过了的话给你 $75$ 分。


最高分的字符串是```hELLOhELL```

最高分的字符串是```OIOZO```

最高分的字符串是```BEDOLDDIEshEBELDOGDIGBIG```

如上图所示，小数点不占用显示位数，故在 $D=5$ 时位数为 $5$ 的小数是可能的。

## 样例 #1

### 输入

```
9

4

hELLO

hELL

EGG

ODD
```

### 输出

```
773407734
```

## 样例 #2

### 输入

```
5

3

ZO

OIO

IOIO
```

### 输出

```
0.201
```

## 样例 #3

### 输入

```
25

10

BED

BEL

BIG

DIE

DIG

DOG

OLD

shE

qED

ZOO
```

### 输出

```
918910900738345310070038
```

## 样例 #4

### 输入

```
5

1

hELLO
```

### 输出

```
0.7734
```



---

---
title: "たんごたくさん"
layout: "post"
diff: 省选/NOI-
pid: AT_tenka1_2016_final_c
tag: []
---

# たんごたくさん

## 题目描述

[problemUrl]: https://atcoder.jp/contests/tenka1-2016-final/tasks/tenka1_2016_final_c

文字列 $ S $ と、要素数 $ M $ の単語の集合 $ P=\{P_1,\ P_2,\ …,\ P_M\} $ が与えられます。単語 $ P_i $ は、整数の重み $ W_i $ を持っています。

文字列 $ S $ から、$ P $ に含まれる単語を重なり合わないように取り出すことを考えます。単語の重みの総和が最大値をとるように取り出すとき、その最大値はいくつでしょうか？

なお、同じ単語を複数回取り出した場合、それらの単語は別々に数えることとします。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ S $ $ M $ $ P_1 $ : $ P_M $ $ W_1 $ : $ W_M $

## 输出格式

単語の重みの総和の最大値を $ 1 $ 行に出力せよ。

## 说明/提示

### 制約

- $ 1\ \leq\ |S|\ \leq\ 200000 $
- $ 1\ \leq\ M\ \leq\ 5000 $
- $ 1\ \leq\ |P_i|\ \leq\ 200 $
- $ 1\ \leq\ W_i\ \leq\ 10000 $
- $ S $, $ P_i $ は英小文字からなる文字列である

## 样例 #1

### 输入

```
abcabcabc
3
ab
bc
ca
1
1
1
```

### 输出

```
4
```

## 样例 #2

### 输入

```
abracadabra
4
b
abra
cad
rac
1
10
50
100
```

### 输出

```
111
```

## 样例 #3

### 输入

```
abcd
2
ad
bc
1192
794
```

### 输出

```
794
```



---

---
title: "天下一数列にクエリを投げます"
layout: "post"
diff: 省选/NOI-
pid: AT_tenka1_2016_qualB_d
tag: []
---

# 天下一数列にクエリを投げます

## 题目描述

[problemUrl]: https://atcoder.jp/contests/tenka1-2016-qualb/tasks/tenka1_2016_qualB_d

モリタ君はプログラミングコンテストの商品として長さ $ N $ の数列 $ a_1,\ a_2,\ ...,\ a_N $ を貰いました。

まず、この数列に対し $ A $ 個の加算クエリを行います。$ i $ 個目の加算クエリは以下のとおりです。

- $ L_i,\ R_i,\ X_i $ が与えられるので、$ a_{L_i},\ a_{L_i+1},\ ...,\ a_{R_i} $ それぞれに $ X_i $ を足す

そのあと、$ B $ 個の調査クエリを行います。この調査クエリの結果を求めるのがあなたの仕事です。$ i $ 個目の調査クエリは以下のとおりです。

- $ S_i,\ T_i,\ K_i $ が与えられるので、$ S_i $ 個目の加算クエリを行う直前から、$ T_i $ 個目の加算クエリを行った直後までの間での $ a_{K_i} $ の最小値を求める

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ a_1 $ $ a_2 $ ... $ a_N $ $ A $ $ L_1 $ $ R_1 $ $ X_1 $ $ L_2 $ $ R_2 $ $ X_2 $ : $ L_A $ $ R_A $ $ X_A $ $ B $ $ S_1 $ $ T_1 $ $ K_1 $ $ S_2 $ $ T_2 $ $ K_2 $ : $ S_B $ $ T_B $ $ K_B $

## 输出格式

$ B $ 行出力する。 $ i $ 行目には $ i $ 個目の調査クエリの結果を出力する。 出力の末尾に改行を入れること。

## 说明/提示

### 制約

- $ 1\ ≦\ N\ ≦\ 10^5 $
- $ 1\ ≦\ A,\ B\ ≦\ 10^5 $
- $ |a_i|\ ≦\ 10^6 $
- $ 1\ ≦\ L_i\ ≦\ R_i\ ≦\ N $
- $ |X_i|\ ≦\ 10^6 $
- $ 1\ ≦\ S_i\ ≦\ T_i\ ≦\ A $
- $ 1\ ≦\ K_i\ ≦\ N $

### Sample Explanation 1

数列は以下のように変動します - \\\[0, 1, 2\\\] : 最初 - \\\[10, 11, 2\\\] : 1つめのクエリの後 - \\\[-10, -9, -18\\\] : 2つめのクエリの後 - \\\[-10, 11, 2\\\] : 3つめのクエリの後 調査クエリの出力は以下のとおりです - 1つめの調査クエリはmin(0, 10)=0を出力します - 2つめの調査クエリはmin(0, 10, -10)=-10(21:18修正)を出力します - 3つめの調査クエリはmin(-9, 11)=-9を出力します - 4つめの調査クエリはmin(1, 11)=1を出力します - 5つめの調査クエリはmin(2, 2)=2を出力します - 6つめの調査クエリはmin(2, 2, -18, 2)=-18を出力します

## 样例 #1

### 输入

```
3

0 1 2

3

1 2 10

1 3 -20

2 3 20

6

1 1 1

1 2 1

3 3 2

1 1 2

1 1 3

1 3 3
```

### 输出

```
0

-10

-9

1

2

-18
```

## 样例 #2

### 输入

```
3

454314 -698320 390858

7

1 3 -916798

1 2 -927828

2 2 537269

1 1 -765412

3 3 -299727

3 3 250850

3 3 526409

7

3 5 3

1 5 1

7 7 1

6 6 1

4 5 3

3 6 3

6 6 2
```

### 输出

```
-825667

-2155724

-2155724

-2155724

-825667

-825667

-2005677
```

## 样例 #3

### 输入

```
7

74567 -876079 911351 746764 -924924 713268 666931

7

6 7 -318557

5 6 -349441

2 4 -629716

3 7 595329

4 7 174594

5 5 -948318

2 6 -47210

8

2 4 4

1 5 3

3 5 5

1 3 3

4 7 5

1 7 1

5 5 5

6 7 2
```

### 输出

```
117048

281635

-1274365

281635

-1499970

74567

-679036

-1553005
```



---

---
title: "CARtesian Coodinate"
layout: "post"
diff: 省选/NOI-
pid: AT_tenka1_2017_e
tag: []
---

# CARtesian Coodinate

## 题目描述

[problemUrl]: https://atcoder.jp/contests/tenka1-2017/tasks/tenka1_2017_e

$ xy $ 平面上に直線が $ N $ 本あります。$ i $ 本目の直線は、$ A_ix+B_iy=C_i $ で表される直線です。 これら $ N $ 直線と、$ x $ 軸、$ y $ 軸を合わせた合計 $ N+2 $ 本の直線のうちどの相異なる $ 2 $ 本をとっても、ちょうど $ 1 $ 点で交わります。

全ての $ 1\ \leq\ i\ <\ j\ \leq\ N $ に対し、$ i $ 本目の直線と $ j $ 本目の直線の交点に車を配置します。 $ 3 $ 直線以上が一点で交わる場合も、各直線の組に対して独立に車を配置します。すなわち、$ k $ 本の直線の交点には、 $ k(k-1)/2 $ 台の車が配置されていることになります。

車は全てとても古くなっているため、各車は、$ x $ 軸または $ y $ 軸に平行な方向にのみ動くことができます。

骨董品の車の展覧会を開催したい高橋君は、$ xy $ 平面上に会場を $ 1 $ つ設けることになりました。 車マニアの高橋君は、今にも壊れそうな車たちをなるべく壊さないように、 全ての車を会場に移動するときの移動距離の合計が最も小さくなるような地点に会場を設けることにしました。 もしそのような地点が一意に定まらないなら、上の条件を満たす地点のうち $ x $ 座標の最も小さい地点に、 それでも一意に定まらないなら、上の $ 2 $ 条件に加えて $ y $ 座標も最も小さい地点に高橋君は会場を設けます。

高橋君が会場を設ける地点の座標を求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ A_1 $ $ B_1 $ $ C_1 $ : $ A_N $ $ B_N $ $ C_N $

## 输出格式

高橋君が会場を設ける地点の $ x $ 座標と $ y $ 座標を、順に空白区切りで出力せよ。絶対誤差あるいは相対誤差が $ 10^{-9} $ 以下の場合に正答と判断される。

## 说明/提示

### 制約

- $ 2\ ≦\ N\ ≦\ 4\ ×\ 10^4 $
- $ 1\ ≦\ |A_i|,|B_i|\ ≦\ 10^4(1\ ≦\ i\ ≦\ N) $
- $ 0\ ≦\ |C_i|\ ≦\ 10^4(1\ ≦\ i\ ≦\ N) $
- 与えられるどの $ 2 $ 直線も平行でない
- 入力は全て整数である

### Sample Explanation 1

!\[\](https://img.atcoder.jp/tenka1-2017/650fff486341589a0388efff446acf0a.png) 図の青丸の地点に一台ずつ車が存在します。求める座標は、図の紫丸の地点になります。

## 样例 #1

### 输入

```
3

1 1 1

2 -1 2

-1 2 2
```

### 输出

```
1.000000000000000 1.000000000000000
```

## 样例 #2

### 输入

```
4

1 1 2

1 -1 0

3 -1 -2

1 -3 4
```

### 输出

```
-1.000000000000000 -1.000000000000000
```

## 样例 #3

### 输入

```
7

1 7 8

-2 4 9

3 -8 -5

9 2 -14

6 7 5

-8 -9 3

3 8 10
```

### 输出

```
-1.722222222222222 1.325000000000000
```



---

---
title: "Equilateral"
layout: "post"
diff: 省选/NOI-
pid: AT_tenka1_2018_e
tag: []
---

# Equilateral

## 题目描述

[problemUrl]: https://atcoder.jp/contests/tenka1-2018/tasks/tenka1_2018_e

$ xy $ 平面上にコインがいくつかあります。 コインの配置は $ H $ 行 $ W $ 列のグリッドを用いて表され、グリッドの $ i $ 行 $ j $ 列目の文字 $ s_{ij} $ が `#` のとき座標 $ (i,j) $ にコインがひとつあることを、 `.` のとき座標 $ (i,j) $ にコインがないことを表します。 その他に $ xy $ 平面上にコインは存在しません。

相異なるコインの $ 3 $ つ組であって、以下の条件を満たすものの個数を求めてください。

- $ 3 $ つのうちどの $ 2 $ つのコインをとっても、それらの存在する座標の間のマンハッタン距離が一定である

ただし、座標 $ (x,y),(x',y') $ の間のマンハッタン距離は、$ |x-x'|+|y-y'| $ で表されます。 また、コインの順番を入れ替えただけの組は同じものとみなします。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ H $ $ W $ $ s_{11}...s_{1W} $ $ : $ $ s_{H1}...s_{HW} $

## 输出格式

条件を満たす組の個数を出力せよ。

## 说明/提示

### 制約

- $ 1\ \leq\ H,W\ \leq\ 300 $
- $ s_{ij} $ は `#` または `.` である

### Sample Explanation 1

$ ((1,1),(1,3),(2,2)),((1,1),(2,2),(3,1)),((1,3),(3,1),(4,4)) $ が条件を満たします。

## 样例 #1

### 输入

```
5 4

#.##

.##.

#...

..##

...#
```

### 输出

```
3
```

## 样例 #2

### 输入

```
13 27

......#.........#.......#..

#############...#.....###..

..............#####...##...

...#######......#...#######

...#.....#.....###...#...#.

...#######....#.#.#.#.###.#

..............#.#.#...#.#..

#############.#.#.#...###..

#...........#...#...#######

#..#######..#...#...#.....#

#..#.....#..#...#...#.###.#

#..#######..#...#...#.#.#.#

#..........##...#...#.#####
```

### 输出

```
870
```



---

---
title: "Circular"
layout: "post"
diff: 省选/NOI-
pid: AT_tenka1_2018_f
tag: []
---

# Circular

## 题目描述

[problemUrl]: https://atcoder.jp/contests/tenka1-2018/tasks/tenka1_2018_f

整数 $ N $ 個からなる列 $ A_1,A_2,...,A_N $ が与えられます。

$ 1,2,...,N $ の並び替え $ p_1,p_2,...,p_N $ であって、 次の操作を何度か行うことでこの列を $ A_1,A_2,...,A_N $ に変換できるようなものの個数を $ 998244353 $ で割ったあまりを求めてください。

- 各 $ 1\leq\ i\leq\ N $ に対し、$ q_i=min(p_{i-1},p_{i}) $ とする。ただし、$ p_0=p_N $ とする。列 $ p $ を列 $ q $ で置き換える。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ A_1 $ $ : $ $ A_N $

## 输出格式

条件を満たす列の個数を $ 998244353 $ で割ったあまりを出力せよ。

## 说明/提示

### 制約

- $ 1\ \leq\ N\ \leq\ 3\ ×\ 10^5 $
- $ 1\ \leq\ A_i\ \leq\ N $
- 入力はすべて整数である

### Sample Explanation 1

$ (2,3,1),(3,2,1) $ が条件を満たします。

## 样例 #1

### 输入

```
3

1

2

1
```

### 输出

```
2
```

## 样例 #2

### 输入

```
5

3

1

4

1

5
```

### 输出

```
0
```

## 样例 #3

### 输入

```
8

4

4

4

1

1

1

2

2
```

### 输出

```
24
```

## 样例 #4

### 输入

```
6

1

1

6

2

2

2
```

### 输出

```
0
```



---

---
title: "Polynomial Divisors"
layout: "post"
diff: 省选/NOI-
pid: AT_tenka1_2019_e
tag: []
---

# Polynomial Divisors

## 题目描述

[problemUrl]: https://atcoder.jp/contests/tenka1-2019/tasks/tenka1_2019_e

$ N $ 次の整数係数多項式 $ f(x)=a_Nx^N+a_{N-1}x^{N-1}+...+a_0 $ が与えられます。任意の整数 $ x $ に対して $ p $ が $ f(x) $ を割り切るような素数 $ p $ をすべて求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ a_N $ $ : $ $ a_0 $

## 输出格式

任意の整数 $ x $ に対して $ p $ が $ f(x) $ を割り切るような素数 $ p $ を小さい順にすべて出力せよ。

## 说明/提示

### 制約

- $ 0\ \leq\ N\ \leq\ 10^4 $
- $ |a_i|\ \leq\ 10^9(0\leq\ i\leq\ N) $
- $ a_N\ \neq\ 0 $
- 入力はすべて整数である

### Sample Explanation 1

$ 2,7 $ は例えば、$ f(1)=14 $ や $ f(2)=28 $ を割り切ります。

### Sample Explanation 2

条件を満たす素数がない場合もあります。

## 样例 #1

### 输入

```
2

7

-7

14
```

### 输出

```
2

7
```

## 样例 #2

### 输入

```
3

1

4

1

5
```

### 输出

```

```

## 样例 #3

### 输入

```
0

998244353
```

### 输出

```
998244353
```



---

---
title: "Banned X"
layout: "post"
diff: 省选/NOI-
pid: AT_tenka1_2019_f
tag: []
---

# Banned X

## 题目描述

[problemUrl]: https://atcoder.jp/contests/tenka1-2019/tasks/tenka1_2019_f

$ 0,1,2 $ のみからなる長さ $ N $ の数列であって、 どの連続する部分列に対してもそれに含まれる数の総和がちょうど $ X $ にはならないようなものの個数を $ 998244353 $ で割ったあまりを求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ X $

## 输出格式

条件を満たす数列の個数を $ 998244353 $ で割ったあまりを出力せよ。

## 说明/提示

### 制約

- $ 1\ \leq\ N\ \leq\ 3000 $
- $ 1\ \leq\ X\ \leq\ 2N $
- $ N,X $ は整数である

### Sample Explanation 1

$ (0,0,0),(0,0,1),(0,0,2),(0,1,0),(0,1,1),(0,2,0),(0,2,2),(1,0,0),(1,0,1),(1,1,0),(2,0,0),(2,0,2),(2,2,0),(2,2,2) $ の $ 14 $ 個の数列が条件を満たします。

## 样例 #1

### 输入

```
3 3
```

### 输出

```
14
```

## 样例 #2

### 输入

```
8 6
```

### 输出

```
1179
```

## 样例 #3

### 输入

```
10 1
```

### 输出

```
1024
```

## 样例 #4

### 输入

```
9 13
```

### 输出

```
18402
```

## 样例 #5

### 输入

```
314 159
```

### 输出

```
459765451
```



---

---
title: "O(rand)"
layout: "post"
diff: 省选/NOI-
pid: AT_tokiomarine2020_e
tag: []
---

# O(rand)

## 题目描述

[problemUrl]: https://atcoder.jp/contests/tokiomarine2020/tasks/tokiomarine2020_e

$ N $ 個の相異なる非負整数 $ A_1,A_2,\ldots,A_N $ が与えられます。 与えられた数の中から $ 1 $ 個以上 $ K $ 個以下の数を選ぶ方法であって、次の $ 2 $ つの条件を満たすような方法は何通りあるか求めてください。

- 選ばれた数のビットごとの論理積は $ S $ である。
- 選ばれた数のビットごとの論理和は $ T $ である。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ K $ $ S $ $ T $ $ A_1 $ $ A_2 $ $ ... $ $ A_N $

## 输出格式

答えを出力せよ。

## 说明/提示

### 制約

- $ 1\ \leqq\ N\ \leqq\ 50 $
- $ 1\ \leqq\ K\ \leqq\ N $
- $ 0\ \leqq\ A_i\ <\ 2^{18} $
- $ 0\ \leqq\ S\ <\ 2^{18} $
- $ 0\ \leqq\ T\ <\ 2^{18} $
- $ A_i\ \neq\ A_j $ ($ 1\ \leqq\ i\ <\ j\ \leqq\ N $)

### Sample Explanation 1

$ \{1,2\} $ もしくは $ \{1,2,3\} $ と数を選ぶと条件を満たします。

## 样例 #1

### 输入

```
3 3 0 3

1 2 3
```

### 输出

```
2
```

## 样例 #2

### 输入

```
5 3 1 7

3 4 9 1 5
```

### 输出

```
2
```

## 样例 #3

### 输入

```
5 4 0 15

3 4 9 1 5
```

### 输出

```
3
```



---

---
title: "Git Gud"
layout: "post"
diff: 省选/NOI-
pid: AT_toyota2023spring_final_g
tag: []
---

# Git Gud

## 题目描述

[problemUrl]: https://atcoder.jp/contests/toyota2023spring-final/tasks/toyota2023spring_final_g

プログラミング初心者のすぬけくんが，以下のようなコードを書きました．

```
N = read_integer()

parent = array(N, -1) //長さ N の配列 parent を作り，すべての要素を -1 で初期化

find(v):
    if parent[v] == -1:
        return v
    else:
        return find(parent[v])

union(a,b):
    parent[find(b)] = find(a)

for i = 0 to N-2:
    A_i = read_integer()
    B_i = read_integer()
    union(A_i,B_i)
```

これは，$ N $ 頂点の木の情報を受けとり，Union-Find で辺を結ぶだけのプログラムです．

プログラミングマスターのりんごさんは，このプログラムの欠陥に気が付きました． すなわち，Union-Find に一切の高速化が施されていないのです．

今，りんごさんは $ N $ 頂点からなる木 $ T $ を持っています． $ T $ の頂点には $ 0 $ から $ N-1 $ までの番号が，辺には $ 0 $ から $ N-2 $ までの番号がついています． 辺 $ i $ は頂点 $ A_i $ と頂点 $ B_i $ を結ぶ辺です．

りんごさんは，すぬけくんのプログラムに $ T $ を入力として与えようとしています． ただしその前に，$ T $ の辺の番号と，辺の端点の順番を自由に入れ替えることができます．

りんごさんは，すぬけくんのプログラムが非効率的であることを示すために，`find` 関数が呼ばれる回数を最大化したいです． `find` 関数が呼ばれる回数の最大値を求めてください．

## 输入格式

入力は以下の形式で標準入力から与えられる．

> $ N $ $ A_0 $ $ B_0 $ $ A_1 $ $ B_1 $ $ \vdots $ $ A_{N-2} $ $ B_{N-2} $

## 输出格式

答えを出力せよ．

## 说明/提示

### 制約

- $ 2\ \leq\ N\ \leq\ 2000 $
- $ 0\ \leq\ A_i,B_i\ \leq\ N-1 $
- $ A_i\ \neq\ B_i $
- 入力されるグラフは木である

### Sample Explanation 1

`find` 関数は必ず $ 2 $ 回呼ばれます．

### Sample Explanation 2

辺 $ 0 $ の端点の順番を入れ替え，以下のような入力を作ると，`find` 関数が $ 5 $ 回呼ばれます． ``` 3 1 0 0 2 ```

### Sample Explanation 3

辺の順番と辺の端点の順番を適切に入れ替え，以下のような入力を作ると，`find` 関数が $ 13 $ 回呼ばれます． ``` 5 3 0 4 3 1 0 0 2 ```

## 样例 #1

### 输入

```
2
0 1
```

### 输出

```
2
```

## 样例 #2

### 输入

```
3
0 1
0 2
```

### 输出

```
5
```

## 样例 #3

### 输入

```
5
0 1
0 2
0 3
3 4
```

### 输出

```
13
```

## 样例 #4

### 输入

```
20
6 16
10 6
16 8
1 5
9 4
5 3
13 16
19 10
12 2
14 10
12 18
0 2
15 16
12 7
11 14
1 10
6 4
17 8
12 1
```

### 输出

```
148
```



---

---
title: "Don&#39;t Detect Cycle"
layout: "post"
diff: 省选/NOI-
pid: AT_ttpc2024_1_a
tag: []
---

# Don&#39;t Detect Cycle

## 题目描述

有一个图 $G$，由 $N$ 个顶点组成，顶点编号为 $1, 2, \ldots, N$。起初，图中没有任何边。

接下来，我们将向图中添加 $M$ 条无向边。图中最终的边是预先确定的：第 $i$ 条边 $(1 \le i \le M)$ 连接顶点 $u_i$ 和 $v_i$。我们称其为边 $i$。添加后的图确保是简单图。

现在，你要判断是否存在一种排列 $(P_1, P_2, \ldots, P_M)$ 满足以下条件，并如满足条件则给出这样的一个实例。

**条件**：
- 按照索引顺序为 $i = 1, 2, \ldots, M$，依次执行以下操作：
  1. 如果当前图中包含 $u_{P_i}$ 或 $v_{P_i}$ 的环存在，则立即停止操作，此时条件不成立。
  2. 在图中添加边 $P_i$（即连接顶点 $u_{P_i}$ 和 $v_{P_i}$ 的无向边）。

共给出 $T$ 个测试用例，请分别解决每个测试用例。

**环的定义**：图 $G$ 中的环是指满足以下条件的顶点序列 $(v_0, \dots, v_{L-1})$ 和边序列 $(e_0, \dots, e_{L-1})$：
- $L \ge 1$
- 若 $i \neq j$，则 $v_i \neq v_j$ 且 $e_i \neq e_j$
- 对于 $0 \le i \le L-2$，边 $e_i$ 连接顶点 $v_i$ 和 $v_{i+1}$
- 边 $e_{L-1}$ 连接顶点 $v_{L-1}$ 和 $v_0$

**简单图的定义**：图 $G$ 被称作简单图，是因为没有自环和多重边。

## 输入格式

输入通过标准输入给出，格式如下：

> $T$  
> $\text{case}_1$  
> $\text{case}_2$  
> $\vdots$  
> $\text{case}_T$

每个 $\text{case}_i (1 \le i \le T)$ 对应一个测试用例，格式如下：

> $N$ $M$  
> $u_1$ $v_1$  
> $u_2$ $v_2$  
> $\vdots$  
> $u_M$ $v_M$

## 输出格式

对于每个测试用例，如果存在满足条件的排列 $(P_1, P_2, \ldots, P_M)$，则输出这样一个排列，元素之间用空格隔开；如果不存在，则输出 `-1`。

## 说明/提示

- 输入中所有的数值均为整数。
- $1 \le T \le 2000$
- 每个测试用例满足：
  - $2 \le N \le 4000$
  - $1 \le M \le 4000$
  - $1 \le u_i, v_i \le N$ （$1 \le i \le M$）
  - 添加所有给定的边后，图为简单图。
- 每份输入文件中，所有测试用例 $N, M$ 总和不超过 $4000$。

**部分评分**

若仅回答满足以下条件的数据集，可获得 $30$ 分：

- $T \le 50$
- 每个测试用例满足：
  - $N \le 100$
  - $M \le 100$
- 每份输入文件中，所有测试用例 $N, M$ 总和不超过 $100$

### 示例说明 1

给定图如下图所示：  
![图示](https://img.atcoder.jp/ttpc2024_1/efcd772696bd0c92c27611b554a4d94b.png)

按顺序 $P = (1, 2, 3, 4)$ 添加边后，图为如下图、符合条件：  
![图示](https://img.atcoder.jp/ttpc2024_1/f639f61a8c21e023b412bb9d1f8c4cca.png)  
![图示](https://img.atcoder.jp/ttpc2024_1/d6307590977040bdaea3733c0df34398.png)

因此，`1 2 3 4` 是一个正确的输出方案。若按顺序 $P = (2, 3, 4, 1)$ 添加边，则在添加边 $1$ 时会形成包含顶点 $2$ 的环，故不满足条件：  
![图示](https://img.atcoder.jp/ttpc2024_1/d7e2277adb8c0aace5f07f25a6cf2569.png)  
![图示](https://img.atcoder.jp/ttpc2024_1/11d01a954d01e5ea030492db5eefd3f8.png)

另外，像 $P = (1, 4, 3, 2)$ 或 $P = (2, 4, 1, 3)$ 的排列也符合条件。

### 示例说明 2

如果不存在满足条件的排列 $P$，则请输出 `-1`。注意，图不一定连通。

 **本翻译由 AI 自动生成**

## 样例 #1

### 输入

```
1

4 4

1 2

2 3

3 4

4 2
```

### 输出

```
2 4 1 3
```

## 样例 #2

### 输入

```
4

4 5

1 2

2 3

3 4

3 1

1 4

5 3

1 2

2 3

3 4

9 10

3 5

1 8

5 8

4 9

6 7

7 9

1 2

1 4

2 4

4 6

8 10

1 4

3 8

2 5

3 4

1 5

5 8

2 8

5 7

4 5

3 7
```

### 输出

```
-1

3 2 1

4 10 2 8 7 9 6 5 3 1

-1
```



---

---
title: "Self Checkout"
layout: "post"
diff: 省选/NOI-
pid: AT_ttpc2024_1_b
tag: []
---

# Self Checkout

## 题目描述

给你一个由数字 1, 2, 3 组成且长度为 $N$ 的数列 $S$。请找出所有由数字 1 和 2 组成的数列 $A$，使通过一定的操作后，生成的数列 $T$ 等于 $S$。我们要计算这样的数列 $A$ 的个数，并对结果取 $998244353$ 的余数。可以证明，符合要求的数列 $A$ 的个数是有限的。

> 操作描述如下：
>
> 1. 初始化变量 $C = 0$。
> 2. 如果数列 $A$ 中存在数字 1，将最前面的一个 1 移除，并将 $C$ 加 1。
> 3. 如果此时 $A$ 仍然不为空，移除 $A$ 的第一个元素 $x$，并将 $C$ 加上 $x$ 的值。
> 4. 将 $C$ 添加到数列 $T$ 的末尾。
> 5. 如果此时 $A$ 为空，操作结束；否则，返回步骤 1。

## 输入格式

输入包含两个部分：

- 一个整数 $N$，代表数列 $S$ 的长度。
- 接下来是 $N$ 个整数，分别是 $S_1, S_2, \dots, S_N$。

## 输出格式

输出满足条件的数列 $A$ 的个数，对 $998244353$ 取余的结果。

## 说明/提示

- 所有输入均为整数。
- $1 \le N \le 10^6$
- $1 \le S_i \le 3$

### 样例解释 1

如果 $S = (3, 2)$，则满足条件的数列 $A$ 有 $(1, 2, 2)$, $(2, 1, 2)$, $(2, 2, 1)$, $(2, 1, 1, 1)$ 和 $(1, 2, 1, 1)$，共 5 种。例如，对于 $A = (2, 1, 1, 1)$：

- 移除 $A$ 中首个 $1$，此时 $A = (2, 1, 1)$，$C = 1$。
- 移除 $A$ 的第一个元素 2，此时 $A = (1, 1)$，$C = 3$。
- 把 $C$ 加入 $T$，得到 $T = (3)$。
- 再移除 $A$ 中首个 $1$，此时 $A = (1)$，$C = 1$。
- 移除 $A$ 的第一个元素 1，$A$ 变为空，$C = 2$。
- 将 $C$ 加入 $T$，得到 $T = (3, 2)$。

### 样例解释 3

也有可能没有符合条件的数列 $A$，这种情况结果为 0。

 **本翻译由 AI 自动生成**

## 样例 #1

### 输入

```
2

3 2
```

### 输出

```
5
```

## 样例 #2

### 输入

```
6

3 2 2 3 2 1
```

### 输出

```
4
```

## 样例 #3

### 输入

```
5

3 2 1 3 2
```

### 输出

```
0
```



---

---
title: "Segment Tree"
layout: "post"
diff: 省选/NOI-
pid: AT_ttpc2024_1_c
tag: []
---

# Segment Tree

## 题目描述

给你一个无向图 $G$，它包含 $2^N + 1$ 个顶点和 $2^{N+1} - 1$ 条边。顶点的编号分别是 $0, 1, \dots, 2^N$，边的编号为 $1, 2, \dots, 2^{N+1}-1$。

图中的边分为 $N+1$ 种类型，从类型 $0$ 到类型 $N$。第 $i$ 种类型（$0 \le i \le N$）的边总共有 $2^i$ 条，编号依次为 $2^i + 0, 2^i + 1, \dots, 2^i + (2^i - 1)$。编号为 $2^i + j$ 的边（$0 \le j \le 2^i - 1$）连接顶点 $j \times 2^{N-i}$ 和顶点 $(j + 1) \times 2^{N-i}$，边的长度为 $C_{2^i + j}$。

例如，当 $N = 3$ 时，图 $G$ 如下图所示。

![](https://cdn.luogu.com.cn/upload/vjudge_pic/AT_ttpc2024_1_c/eeee648dd769ea41d1a8e76adff12eede55a57c5.png)

你需要处理 $Q$ 个查询，查询分为两种类型：

- `1 j x`：将编号为 $j$ 的边的长度更新为 $x$。
- `2 s t`：询问从顶点 $s$ 到顶点 $t$ 的最短路径长度。

## 输入格式

输入包括以下内容。注意，顶点编号从 $0$ 开始，而边的编号从 $1$ 开始。

> $N$ $C_1$ $C_2$ $\cdots$ $C_{2^{N+1}-1}$ $Q$ $\text{query}_1$ $\text{query}_2$ $\vdots$ $\text{query}_Q$

每个 $\text{query}_i$ 表示第 $i$ 个查询，查询有以下两种格式之一：

> 1 $j$ $x$

> 2 $s$ $t$

## 输出格式

对于每一个 `2 s t` 类型的查询，输出一行答案，共计 $m$ 行，其中 $m$ 是 `2 s t` 查询的数量。第 $i$ 行对应第 $i$ 个 `2 s t` 查询的结果。

## 说明/提示

- 输入的所有数值均为整数。
- $1 \le N \le 18$
- $1 \le C_j \le 10^7$，$ (1\le j\le 2^{N+1}-1$）
- $1 \le Q \le 2 \times 10^5$
- 对于 `1 j x` 类型的查询，$1 \le j \le 2^{N+1}-1$ 且 $1 \le x \le 10^7$
- 对于 `2 s t` 类型的查询，$0 \le s < t \le 2^N$
- 至少存在一个 `2 s t` 类型的查询

### 部分得分

如果在不包含 `1 j x` 类型查询的数据集上正确解答，可以获得 $30$ 分。

 **本翻译由 AI 自动生成**

## 样例 #1

### 输入

```
3

7 1 14 3 9 4 8 2 6 5 5 13 8 2 3

10

2 0 1

2 0 4

2 4 6

2 4 8

2 3 5

1 6 30

2 3 5

2 4 6

1 1 10000000

2 0 8
```

### 输出

```
2

1

4

8

17

18

13

15
```



---

---
title: "ReTravel"
layout: "post"
diff: 省选/NOI-
pid: AT_ttpc2024_1_e
tag: []
---

# ReTravel

## 题目描述

在 $xy$ 平面上的原点处，有一个机器人。你需要操控这个机器人按顺序访问编号为 $1, 2, \dots, N$ 的 $N$ 个点。第 $i$ 个点的坐标是 $(X_i, Y_i)$，其中 $1 \le i \le N$。

机器人初始位于原点，并带有一个空白字符串变量 $S$。你可以用以下四种操作来引导机器人的移动：

1. 将机器人的 $x$ 坐标增加 $1$，同时在字符串 $S$ 的末尾添加字符 `X`。这个操作的代价为 $1$。
2. 将机器人的 $y$ 坐标增加 $1$，同时在字符串 $S$ 的末尾添加字符 `Y`。这个操作的代价为 $1$。
3. 如果 $S$ 的末尾是 `X`，你可以减少机器人的 $x$ 坐标 $1$，并从 $S$ 中删除末尾的 `X`。这个操作无需任何代价。
4. 如果 $S$ 的末尾是 `Y`，你可以减少机器人的 $y$ 坐标 $1$，并从 $S$ 删除末尾的 `Y`。这个操作同样没有代价。

你需要计算机器人按顺序访问所有点 $1, 2, \ldots, N$ 所需的最小代价。这代价是指机器人在移动过程中，执行操作 $1$ 和操作 $2$ 的次数总和。

## 输入格式

输入包括多个整数，通过标准输入提供：

> $N$ $X_1$ $Y_1$ $X_2$ $Y_2$ $\ldots$ $X_N$ $Y_N$

## 输出格式

输出机器人访问所有指定点顺序所需的最小总代价。

## 数据范围与限制

- 输入均为整数
- $1 \le N \le 500$
- $0 \le X_i, Y_i \le 10^9$

### 示例说明

通过一次操作 $1$（增加 $x$）、三次操作 $2$（增加 $y$）、以及两次操作 $1$，机器人可以到达点 $1$。接着，通过两次操作 $3$（减少 $x$）、一次操作 $4$（减少 $y$），机器人可以到达点 $2$。这些操作的总代价是 $6$（操作 $1$ 和操作 $2$ 的总次数）。

 **本翻译由 AI 自动生成**

## 样例 #1

### 输入

```
2

3 3

1 2
```

### 输出

```
6
```

## 样例 #2

### 输入

```
3

2 2

3 3

1 3
```

### 输出

```
7
```



---

---
title: "Long Sequence Inversion 2"
layout: "post"
diff: 省选/NOI-
pid: AT_ttpc2024_1_l
tag: []
---

# Long Sequence Inversion 2

## 题目描述

在这道题目中，「长度为 $ K $ 的排列」指的是「从 $ 0 $ 到 $ K - 1 $ 的所有数字所组成的一个排列」。此外，我们用 $ X[k] $ 来表示数列 $ X $ 的第 $ k $ 个元素（从 $ 0 $ 开始计数）。

现在给你一个长度为 $ L $ 的排列 $ P $，以及 $ L $ 个分别长度为 $ B $ 的排列 $ V_{0}, V_{1}, \dots, V_{L-1} $。我们定义一个长度为 $ B^L $ 的数列 $ A $，定义方式如下：

> 对于每个 $ 0 \leq n < B^L $，将 $ n $ 用 $ B $ 进制表示为 $ L $ 位数，记每一位的值为 $ N[i] $，即 $ n = N[0] B^{L-1} + N[1] B^{L-2} + \cdots + N[L-1] B^0 $，那么
>
> $$ A[n] = \sum_{i=0}^{L-1} V_i[N[i]] \times B^{P[i]} $$

你的任务是计算数列 $ A $ 的逆序对个数，并输出其对 $ 998244353 $ 取模的结果。

## 输入格式

输入通过标准输入流给出，格式如下：

> $ L $ $ B $ $ P[0] $ $ P[1] $ $\cdots$ $ P[L-1] $ $ V_{0}[0] $ $ V_{0}[1] $ $\cdots$ $ V_{0}[B-1] $ $\vdots$ $ V_{L-1}[0] $ $ V_{L-1}[1] $ $\cdots$ $ V_{L-1}[B-1] $

## 输出格式

输出结果。

## 说明/提示

- 所有输入都是整数。
- $ 1 \leq L $
- $ 2 \leq B $
- $ L \times (B + 1) \leq 5 \times 10^5 $
- $ P $ 是长度为 $ L $ 的排列。
- 对每个 $ 0 \leq i < L $，$ V_i $ 是长度为 $ B $ 的排列。

### 示例解释 1

例如，当 $ n = 5 $ 时，其在 $ B = 2 $ 进制下的表示为三位数 $ (1, 0, 1) $，那么：
$$ A[5] = V_{0}[1] \times 2^{P[0]} + V_{1}[0] \times 2^{P[1]} + V_{2}[1] \times 2^{P[2]} = 3 $$
用相同的方法计算得到 $ A = (5, 1, 4, 0, 7, 3, 6, 2) $。然后，计算出数列 $ A $ 的逆序对数量为 $ 14 $，所以输出 $ 14 $。

### 示例解释 2

同理可以计算出 $ A = (9, 1, 13, 5, 10, 2, 14, 6, 11, 3, 15, 7, 8, 0, 12, 4) $。数列 $ A $ 的逆序对数量是 $ 60 $，所以输出 $ 60 $。

### 说明

记得计算结果需对 $ 998244353 $ 取模。

 **本翻译由 AI 自动生成**

## 样例 #1

### 输入

```
3 2

2 0 1

1 0

1 0

0 1
```

### 输出

```
14
```

## 样例 #2

### 输入

```
2 4

1 0

2 0 3 1

1 2 3 0
```

### 输出

```
60
```

## 样例 #3

### 输入

```
9 10

2 5 7 3 8 1 4 6 0

9 2 4 0 1 6 7 3 5 8

4 1 6 7 8 0 5 9 2 3

1 9 2 4 6 8 5 7 0 3

9 0 8 2 5 1 6 7 3 4

1 6 0 7 3 9 2 4 5 8

4 5 2 9 1 6 7 3 0 8

7 0 5 6 1 9 2 4 3 8

3 2 1 6 7 0 8 9 4 5

9 2 4 3 5 8 0 6 7 1
```

### 输出

```
138876070
```



---

---
title: "Cartesian Trees"
layout: "post"
diff: 省选/NOI-
pid: AT_ttpc2024_1_m
tag: []
---

# Cartesian Trees

## 题目描述

给定一个排列 $A = (A_1, A_2, \dots, A_N)$，其为 $1$ 到 $N$ 的数字重新排序所得。对于每个区间 $(l, r)$（满足 $1 \le l \le r \le N$），我们定义一种叫做 **Cartesian Tree** 的结构 $\text{C}(l, r)$，定义如下：

- $\text{C}(l, r)$ 是一个有根二叉树，包含 $r - l + 1$ 个节点。树的根节点记为 $\mathit{rt}$。
- 整数 $m$ 是唯一能使 $A_m = \min\{A_l, A_{l+1}, \dots, A_r\}$ 成立的值。
- 若 $l < m$，则 $\mathit{rt}$ 的左子树构造为 $\text{C}(l, m-1)$；否则，$\mathit{rt}$ 没有左子树。
- 若 $m < r$，则 $\mathit{rt}$ 的右子树构造为 $\text{C}(m+1, r)$；否则，$\mathit{rt}$ 没有右子树。

现在给出 $Q$ 个区间对 $(l_1, r_1), (l_2, r_2), \dots, (l_Q, r_Q)$，需要你判断这些区间内所构造的 Cartesian Tree 中，有多少种是不一样的。具体而言，两个 Cartesian Tree 被认为是相同的，当且仅当它们的结构完全相同。即：

- 如果 $X$ 的根节点 $\mathit{rt}_X$ 有左子树，那么 $Y$ 的根节点 $\mathit{rt}_Y$ 也必须有左子树，而且 $X$ 和 $Y$ 的左子树构造的 Cartesian Tree 要完全相同。
- 如果 $X$ 的根节点 $\mathit{rt}_X$ 没有左子树，那么 $Y$ 的根节点 $\mathit{rt}_Y$ 也不能有左子树。
- 如果 $X$ 的根节点 $\mathit{rt}_X$ 有右子树，那么 $Y$ 的根节点 $\mathit{rt}_Y$ 也必须有右子树，而且 $X$ 和 $Y$ 的右子树构造的 Cartesian Tree 要完全相同。
- 如果 $X$ 的根节点 $\mathit{rt}_X$ 没有右子树，那么 $Y$ 的根节点 $\mathit{rt}_Y$ 也不能有右子树。

## 输入格式

输入包含一行，以以下格式给出：

> $N$ $A_1$ $A_2$ $\ldots$ $A_N$ $Q$ $l_1$ $r_1$ $l_2$ $r_2$ $\vdots$ $l_Q$ $r_Q$

## 输出格式

输出一种整数，表示不一样的 Cartesian Tree 的数量。

## 说明/提示

- 所有输入均为整数。
- $1 \le N \le 4 \times 10^5$
- $A$ 是 $(1, 2, \dots, N)$ 经过重新排列得到的。
- $1 \le Q \le 4 \times 10^5$
- $1 \le l_i \le r_i \le N$，对所有 $1 \le i \le Q$ 成立。
- 对任意的 $i \ne j$，$(l_i, r_i) \ne (l_j, r_j)$。

 **本翻译由 AI 自动生成**

## 样例 #1

### 输入

```
6

1 4 2 6 3 5

3

1 4

2 5

3 6
```

### 输出

```
2
```

## 样例 #2

### 输入

```
4

1 2 3 4

10

1 1

2 2

3 3

4 4

1 2

2 3

3 4

1 3

2 4

1 4
```

### 输出

```
4
```

## 样例 #3

### 输入

```
10

3 8 4 7 2 5 9 10 1 6

13

5 8

2 6

7 9

3 8

3 5

2 4

4 6

1 9

3 7

6 9

2 10

4 9

3 9
```

### 输出

```
11
```



---

---
title: "プログラミングコンテストチャレンジブック"
layout: "post"
diff: 省选/NOI-
pid: AT_utpc2011_7
tag: []
---

# プログラミングコンテストチャレンジブック

## 题目描述

你有 $N$ 个木棒，第 $i$ 个木棒的长度为 $a_{i}$ 。从这 $N$ 根木棒中选取6根，组成两个三角形(要求每个三角形中是三根木棒**顺次首尾相连**)，你需要求出能组成的两个三角形的周长和的最大值。

## 输入格式

第一行一个正整数 $N$ 

接下来 $N$ 行，第 $i+1$ 行为一个正整数 $a_{i}$

## 输出格式

一行，为你所求出的答案，**注意文末换行**。

## 说明/提示

- 对于 $20\%$ 的数据， $1 \le N \le 10$ 

- 对于 $100\%$ 的数据， $1 \le N \le 10^{5}$ ， $1 \le a_{i} \le 10^{15}$ 

感谢@常暗踏阴 提供的翻译



---

---
title: "Magic"
layout: "post"
diff: 省选/NOI-
pid: AT_wtf19_a
tag: []
---

# Magic

## 题目描述

魔术师在表演，现在他有 $N(2 \leq N \leq 50)$ 个箱子，其中一个有宝藏。魔术师会随机打乱这些箱子，此后箱子顺序不变，你的任务是在这 $N$ 个箱子中找到有宝藏的那个。

但是，在你找宝藏的过程中，会有一些特殊的限制和操作：

- 你只能一个箱子一个箱子打开，且打开一个箱子后必须在打开另外一个之前关闭它。

- 每一个箱子最多能打开 $a_i(1 \leq a_i \leq 100)$ 次。

- 魔术师会在你找宝藏的过程中最多做 $K(1 \leq K \leq 50)$ 后文所述的操作：**除了在你正在打开箱子的时候**，他可能会将宝藏从一个箱子移动到另外一个箱子中。也就是说，他可能会在你打开一个箱子之前、关闭一个箱子并打开下一个中间这段时间这两种情况中移动宝藏位置。

请输出一种方案，确保你能找到宝藏，如果没有这样的方案，输出 `-1`。


否则，第一行输出一行一个正整数 $Q$ 表示打开箱子顺序的总长度（即你打开箱子的总次数）。

第二行输出一行 $Q$ 个正整数，表示你的打开箱子顺序。

## 输入格式

第一行两个正整数 $N$ 和 $K$ 分别表示箱子个数和魔术师能移动宝藏的次数。

第二行输入 $N$ 个正整数 $a_i$ 表示每个箱子你最多能打开的次数。

## 样例 #1

### 输入

```
2 1

5 5
```

### 输出

```
7

1 1 2 1 2 2 1
```

## 样例 #2

### 输入

```
3 50

5 10 15
```

### 输出

```
-1
```



---

---
title: "Triangular Lamps Easy"
layout: "post"
diff: 省选/NOI-
pid: AT_wtf19_c1
tag: []
---

# Triangular Lamps Easy

## 题目描述

[problemUrl]: https://atcoder.jp/contests/wtf19/tasks/wtf19_c1

以下のような、無限に広がる三角グリッドがあります。 座標がともに整数であるような点のそれぞれには、ランプがひとつ設置されています。

![](https://cdn.luogu.com.cn/upload/vjudge_pic/AT_wtf19_c1/49b2130f65c1769a41dbab659975767a4d56bcfb.png)

はじめ、$ (X,\ 0) $ のランプのみが点灯しており、その他のランプはすべて消灯していました。 この状態から、すぬけ君が次の操作を $ 0 $ 回以上行いました。

- $ 2 $ つの整数 $ x,\ y $ を選ぶ。 $ 3 $ つのランプ $ (x,\ y),\ (x,\ y+1),\ (x+1,\ y) $ の状態を切り替える (点灯していれば消灯させ、消灯していれば点灯させる)。

この操作のあと、$ N $ 個のランプ $ (x_1,\ y_1),\ \cdots,\ (x_N,\ y_N) $ が点灯しており、その他のランプはすべて消灯していました。 $ X $ を求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ x_1 $ $ y_1 $ $ : $ $ x_N $ $ y_N $

## 输出格式

$ X $ を出力せよ。

## 说明/提示

### 制約

- $ 1\ \leq\ N\ \leq\ 10^5 $
- $ -10^{17}\ \leq\ x_i,\ y_i\ \leq\ 10^{17} $
- $ (x_i,\ y_i) $ は互いに異なる。
- 入力は問題文と矛盾せず、$ X $ は一意に定まる。

### Sample Explanation 1

行われた操作の列として考えられるものをひとつ、以下の画像に示します。 !\[\](https://img.atcoder.jp/wtf19/cff6dc4d81e995e9300ccbaca5bf85de.png)

## 样例 #1

### 输入

```
4

-2 1

-2 2

0 1

1 0
```

### 输出

```
-1
```



---

---
title: "Ears"
layout: "post"
diff: 省选/NOI-
pid: AT_yahoo_procon2019_qual_d
tag: []
---

# Ears

## 题目描述

在一个数轴上，有 $L$ 堆石头，第 $i$ 堆石头的坐标是 $i-0.5$。 刚开始石头堆数为 $0$。

- 你可以从任何地方出发，在任何地方结束移动。（坐标为整数）

- 你每次只能向左或右移动 $1$。

- 你在经过一堆石头时会向其添加一块石头。

- 若坐标为 $x$，那么你必须保证 $0 \leq x \leq L$。

给定 $L,A_1,A_2,A_3,\cdots,A_L$，假设最后第 $i$ 堆石头数量为 $H_i$，求 ：

   $$ \min(\sum_{i=1}^{L} |A_i-H_i| )$$

---

## 输入格式

$L+1$ 行，为

$L\\A_1\\A_2\\A_3\\\cdots\\A_L$

---

## 输出格式

一行一个整数，

$$ \min(\sum_{i=1}^{L} |A_i-H_i| )$$

---

## 说明/提示

- $1 \leqslant L \leqslant 2\times 10^5$

- $0 \leqslant A_i \leqslant 10^9(1 \leqslant i \leqslant L)$

- 输入均为整数

---

$\textsf{Translate by @\color{5EB95E}nr0728}.$

## 样例 #1

### 输入

```
4

1

0

2

3
```

### 输出

```
1
```

## 样例 #2

### 输入

```
8

2

0

0

2

1

3

4

1
```

### 输出

```
3
```

## 样例 #3

### 输入

```
7

314159265

358979323

846264338

327950288

419716939

937510582

0
```

### 输出

```
1
```



---


---
title: "[ABC282Ex] Min + Sum"
layout: "post"
diff: 省选/NOI-
pid: AT_abc282_h
tag: ['二分', '分治']
---

# [ABC282Ex] Min + Sum

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc282/tasks/abc282_h

$ 2 $ つの長さ $ N $ の整数列 $ A\ =\ (A_1,\ A_2,\ \ldots,\ A_N) $ および $ B\ =\ (B_1,\ B_2,\ \ldots,\ B_N) $ が与えられます。

$ 1\ \leq\ l\ \leq\ r\ \leq\ N $ を満たす整数の組 $ (l,\ r) $ であって下記の条件を満たすものの個数を出力してください。

- $ \min\lbrace\ A_l,\ A_{l+1},\ \ldots,\ A_r\ \rbrace\ +\ (B_l\ +\ B_{l+1}\ +\ \cdots\ +\ B_r)\ \leq\ S $

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ S $ $ A_1 $ $ A_2 $ $ \ldots $ $ A_N $ $ B_1 $ $ B_2 $ $ \ldots $ $ B_N $

## 输出格式

答えを出力せよ。

## 说明/提示

### 制約

- $ 1\ \leq\ N\ \leq\ 2\ \times\ 10^5 $
- $ 0\ \leq\ S\ \leq\ 3\ \times\ 10^{14} $
- $ 0\ \leq\ A_i\ \leq\ 10^{14} $
- $ 0\ \leq\ B_i\ \leq\ 10^9 $
- 入力はすべて整数
 
### Sample Explanation 1

$ 1\ \leq\ l\ \leq\ r\ \leq\ N $ を満たす整数の組 $ (l,\ r) $ であって問題文中の条件を満たすものは、 $ (1,\ 1),\ (1,\ 2),\ (2,\ 2),\ (2,\ 3),\ (3,\ 3),\ (4,\ 4) $ の $ 6 $ 個です。

## 样例 #1

### 输入

```
4 15

9 2 6 5

3 5 8 9
```

### 输出

```
6
```

## 样例 #2

### 输入

```
15 100

39 9 36 94 40 26 12 26 28 66 73 85 62 5 20

0 0 7 7 0 5 5 0 7 9 9 4 2 5 2
```

### 输出

```
119
```



---

---
title: "[ABC285G] Tatami"
layout: "post"
diff: 省选/NOI-
pid: AT_abc285_g
tag: ['网络流', '二分图']
---

# [ABC285G] Tatami

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc285/tasks/abc285_g

縦 $ H $ マス、横 $ W $ マスのグリッドがあります。上から $ i $ 行目、左から $ j $ 列目のマスをマス $ (i,j) $ と呼びます。

このグリッドを縦 $ 1 $ マス $ \times $ 横 $ 1 $ マスのタイルと縦 $ 1 $ マス $ \times $ 横 $ 2 $ マスのタイルで、重ならないように、隙間ができないように覆います（タイルは回転してもよい）。

各マスには `1`, `2`, `?` のいずれかが書かれています。マス $ (i,j) $ に書かれている文字は $ c_{i,j} $ です。  
`1` が書かれたマスは $ 1\times\ 1 $ のタイルで、`2` が書かれたマスは $ 1\times\ 2 $ のタイルで覆わなければなりません。`?` が書かれたマスはどちらのタイルで覆っても構いません。

そのようなタイルの置き方があるかどうか判定してください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ H $ $ W $ $ c_{1,1}c_{1,2}\ldots\ c_{1,W} $ $ \vdots $ $ c_{H,1}c_{H,2}\ldots\ c_{H,W} $

## 输出格式

問題文中の条件を満たすタイルの置き方が存在するなら `Yes`、存在しないなら `No` と出力せよ。

## 说明/提示

### 制約

- $ 1\ \leq\ H,W\ \leq\ 300 $
- $ H,W $ は整数
- $ c_{i,j} $ は `1`, `2`, `?` のいずれか

### Sample Explanation 1

例えば以下のようなタイルの置き方で条件を満たすことができます。 !\[\](https://img.atcoder.jp/abc285/d984ec33355bac05ecebc41076d9a8df.png)

### Sample Explanation 2

条件を満たすようなタイルの置き方は存在しません。

## 样例 #1

### 输入

```
3 4
2221
?1??
2?21
```

### 输出

```
Yes
```

## 样例 #2

### 输入

```
3 4
2?21
??1?
2?21
```

### 输出

```
No
```

## 样例 #3

### 输入

```
5 5
11111
11111
11211
11111
11111
```

### 输出

```
No
```



---

---
title: "[ABC317G] Rearranging"
layout: "post"
diff: 省选/NOI-
pid: AT_abc317_g
tag: ['网络流', '二分图']
---

# [ABC317G] Rearranging

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc317/tasks/abc317_g

$ N $ 行 $ M $ 列のグリッドがあります。上から $ i $ 行目左から $ j $ 列目のマスには整数 $ A_{i,j} $ が書かれています。  
 ここで、グリッドのマスに書かれている計 $ NM $ 個の整数は $ 1,\ldots,N $ をちょうど $ M $ 個ずつ含みます。

あなたは次の手順でマスに書かれた数を入れ替える操作を行います。

- $ i=1,\ldots,N $ の順に次を行う。
  - $ i $ 行目に書かれた数を自由に並び替える。すなわち、$ 1,\ldots,M $ の並び替えである長さ $ M $ の数列 $ P=(P_{1},\ldots,P_{M}) $ を自由に選び、$ A_{i,1},\ldots,A_{i,M} $ を 同時に $ A_{i,P_{1}},\ldots,A_{i,P_{M}} $ に置き換える。
 
あなたの目的は、操作後に全ての列が $ 1,\ldots,N $ を $ 1 $ つずつ含むようにすることです。そのようなことが可能であるか判定し、可能であれば操作後のグリッドの状態を出力してください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ M $ $ A_{1,1} $ $ \ldots $ $ A_{1,M} $ $ \vdots $ $ A_{N,1} $ $ \ldots $ $ A_{N,M} $

## 输出格式

操作により全ての列が $ 1,\ldots,N $ を $ 1 $ つずつ含むようにするのが不可能ならば `No` と出力せよ。  
 可能であるとき、$ 1 $ 行目に `Yes` と出力し、続く $ N $ 行に、全ての列が $ 1,\ldots,N $ を $ 1 $ つずつ含むように操作したあとのグリッドの状態を次の形式で出力せよ。  
 グリッドの上から $ i $ 行目左から $ j $ 列目のマスに書かれた数を $ B_{i,j} $ とする。各 $ 1\leq\ i\ \leq\ N $ について $ i+1 $ 行目に $ B_{i,1},\ldots,B_{i,M} $ をこの順に空白区切りで出力せよ。

答えが複数存在する場合、どれを出力しても正解とみなされる。

## 说明/提示

### 制約

- $ 1\ \leq\ N,M\ \leq\ 100 $
- $ 1\ \leq\ A_{i,j}\ \leq\ N $
- 入力は全て整数である
- $ NM $ 個の数 $ A_{1,1},\ldots,A_{N,M} $ は $ 1,\ldots,N $ をそれぞれちょうど $ M $ 個ずつ含む
 
### Sample Explanation 1

この他、以下の出力も正解とみなされる。 ``` Yes 1 1 2 3 3 2 ```

## 样例 #1

### 输入

```
3 2

1 1

2 3

2 3
```

### 输出

```
Yes

1 1

3 2

2 3
```

## 样例 #2

### 输入

```
4 4

1 2 3 4

1 1 1 2

3 2 2 4

4 4 3 3
```

### 输出

```
Yes

1 4 3 2

2 1 1 1

4 2 2 3

3 3 4 4
```



---

---
title: "[ABC344G] Points and Comparison"
layout: "post"
diff: 省选/NOI-
pid: AT_abc344_g
tag: ['二分', '扫描线']
---

# [ABC344G] Points and Comparison

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc344/tasks/abc344_g

**特殊な入力形式に注意してください。**

$ xy $ 平面上に $ N $ 個の点 $ (X_i,Y_i) $ があります。これらの点の情報は入力から与えられます。

また、 $ Q $ 個の整数組 $ (A_j,B_j) $ が与えられます。  
 $ f(A_j,B_j) $ を $ Y_i\ \ge\ A_j\ \times\ X_i\ +\ B_j $ を満たす $ i $ の個数として定義します。

$ \displaystyle\ \sum^{Q}_{j=1}\ f(A_j,B_j) $ を求めてください。

但し、この問題では $ Q $ が非常に大きくなるため、 $ (A_j,B_j) $ は直接与えられません。  
 代わりに $ G_0,R_a,R_b $ が与えられ、 $ (A_j,B_j) $ は以下の方法で生成されます。

- まず、 $ n\ \ge\ 0 $ に対して、 $ G_{n+1}\ =\ (48271\ \times\ G_n)\ \mod\ (2^{31}-1) $ と定義します。
- $ j=1,2,\dots,Q $ に対して、 $ (A_j,B_j) $ を次のように生成します。
  - $ A_j\ =\ -R_a\ +\ (G_{3j\ -\ 2}\ \mod\ (2\ \times\ R_a\ +\ 1)\ ) $
  - $ B_j\ =\ -R_b\ +\ ((G_{3j\ -\ 1}\ \times\ (2^{31}-1)\ +\ G_{3\ j})\ \mod\ (2\ \times\ R_b\ +\ 1)\ ) $
 
この生成法から、 $ A_j,\ B_j $ は以下の制約を満たすことが示せます。

- $ -R_a\ \le\ A_j\ \le\ R_a $
- $ -R_b\ \le\ B_j\ \le\ R_b $

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ X_1 $ $ Y_1 $ $ X_2 $ $ Y_2 $ $ \vdots $ $ X_N $ $ Y_N $ $ Q $ $ G_0 $ $ R_a $ $ R_b $

## 输出格式

答えを整数として出力せよ。

## 说明/提示

### 制約

- 入力は全て整数
- $ 1\ \le\ N\ \le\ 5000 $
- $ 1\ \le\ Q\ \le\ 10^7 $
- $ |X_i|,\ |Y_i|\ \le\ 10^8 $
- $ (X_i,Y_i) $ は相異なる
- $ 0\ \le\ G_0\ <\ (2^{31}-1) $
- $ 0\ \le\ R_a\ \le\ 10^8 $
- $ 0\ \le\ R_b\ \le\ 10^{16} $
 
### Sample Explanation 1

この入力には $ 10 $ 個の質問が含まれます。 生成された $ (A_j,B_j) $ は $ (-2,4),(0,2),(-4,-2),(4,-5),(3,1),(-1,3),(2,-5),(3,-1),(3,5),(3,-2) $ です。

## 样例 #1

### 输入

```
7

2 -2

-1 -2

0 1

2 1

-2 2

1 2

0 -1

10

1 5 5
```

### 输出

```
36
```



---

---
title: "[ABC348G] Max (Sum - Max)"
layout: "post"
diff: 省选/NOI-
pid: AT_abc348_g
tag: ['线段树', '整体二分']
---

# [ABC348G] Max (Sum - Max)

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc348/tasks/abc348_g

長さ $ N $ の整数列 $ A,\ B $ が与えられます。$ k\ =\ 1,\ 2,\ \ldots\ ,N $ について、以下の問題を解いてください。

- $ 1 $ 以上 $ N $ 以下の相異なる整数 $ k $ 個を選ぶことを考える。選んだ整数の集合を $ S $ として、 $ \displaystyle\ (\sum_{i\ \in\ S}\ A_i)\ -\ \max_{i\ \in\ S}\ B_i $ としてあり得る値の最大値を求めよ。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ A_1 $ $ B_1 $ $ A_2 $ $ B_2 $ $ \vdots $ $ A_N $ $ B_N $

## 输出格式

$ N $ 行出力せよ。$ i $ 行目には、 $ k=i $ についての問題の答えを出力せよ。

## 说明/提示

### 制約

- $ 1\ \leq\ N\ \leq\ 2\ \times\ 10^5 $
- $ -10^9\ \leq\ A_i\ \leq\ 10^9 $
- $ -2\ \times\ 10^{14}\ \leq\ B_i\ \leq\ 2\ \times\ 10^{14} $
 
### Sample Explanation 1

以下の選び方がそれぞれ最適です。 - $ k\ =\ 1 $ : $ S\ =\ \{1\} $ - $ k\ =\ 2 $ : $ S\ =\ \{1,\ 3\} $ - $ k\ =\ 3 $ : $ S\ =\ \{1,\ 2,\ 3\} $

## 样例 #1

### 输入

```
3

4 1

5 6

3 2
```

### 输出

```
3

5

6
```

## 样例 #2

### 输入

```
2

0 1

0 1
```

### 输出

```
-1

-1
```

## 样例 #3

### 输入

```
6

9 7

2 4

7 1

-1000 0

3 4

8 5
```

### 输出

```
6

10

17

20

22

-978
```



---

---
title: "[ABC355G] Baseball"
layout: "post"
diff: 省选/NOI-
pid: AT_abc355_g
tag: ['动态规划 DP', '凸完全单调性（wqs 二分）']
---

# [ABC355G] Baseball

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc355/tasks/abc355_g

長さ $ N $ の数列 $ P=(P_1,P_2,\dots,P_N) $ が与えられます。高橋君と青木君が、数列 $ P $ を使ってゲームを行います。

まず、高橋君が、 $ 1,2,\dots,N $ から $ K $ 個の相異なる整数 $ x_1,x_2,\dots,x_K $ を選びます。

次に、青木君が、 $ 1,2,\dots,N $ から $ 1 $ つの整数 $ y $ を $ P_y $ に比例する確率で選びます。すなわち、整数 $ y $ が選ばれる確率は $ \dfrac{P_y}{\sum_{y'=1}^N\ P_{y'}} $ です。そして、青木君が $ \displaystyle\ \min_{i=1,2,\dots,K}\ |x_i-y| $ のスコアを得ます。

高橋君は、青木君が得るスコアの期待値を**最小化**したいです。高橋君が適切に $ x_1,x_2,\dots,x_K $ を選んだときに、青木君が得るスコアの期待値の最小値を $ \sum_{y'=1}^N\ P_{y'} $ 倍した値を求めてください。なお、出力すべき値は整数になることが証明できます。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ K $ $ P_1 $ $ P_2 $ $ \dots $ $ P_N $

## 输出格式

答えを出力せよ。

## 说明/提示

### 制約

- $ 1\ \leq\ N\ \leq\ 5\ \times\ 10^4 $
- $ 1\ \leq\ K\ \leq\ N $
- $ 0\ \leq\ P_i\ \leq\ 10^5 $
- $ 1\ \leq\ \sum_{y'=1}^N\ P_{y'}\ \leq\ 10^5 $
- 入力はすべて整数
 
### Sample Explanation 1

青木君が $ 1,2,\dots,N $ を選ぶ確率はすべて等しく $ \frac{1}{5} $ です。 高橋君が $ x_1=2,x_2=4 $ と選んだとすると、青木君が得るスコアの期待値は $ 1\ \times\ \frac{1}{5}\ +\ 0\ \times\ \frac{1}{5}\ +\ 1\ \times\ \frac{1}{5}\ +\ 0\ \times\ \frac{1}{5}\ +\ 1\ \times\ \frac{1}{5}\ =\ \frac{3}{5} $ です。 高橋君が $ x_1=2,x_2=3 $ と選んだとすると、青木君が得るスコアの期待値は $ 1\ \times\ \frac{1}{5}\ +\ 0\ \times\ \frac{1}{5}\ +\ 0\ \times\ \frac{1}{5}\ +\ 1\ \times\ \frac{1}{5}\ +\ 2\ \times\ \frac{1}{5}\ =\ \frac{4}{5} $ です。 高橋君が他の選び方をしても、青木君が得るスコアの期待値は $ \frac{3}{5} $ より小さくなりません。よって最小値は $ \frac{3}{5} $ であり、これを $ 5 $ 倍した $ 3 $ を出力します。

## 样例 #1

### 输入

```
5 2

1 1 1 1 1
```

### 输出

```
3
```

## 样例 #2

### 输入

```
5 1

0 0 1 0 0
```

### 输出

```
0
```

## 样例 #3

### 输入

```
1 1

100
```

### 输出

```
0
```

## 样例 #4

### 输入

```
20 7

4262 9522 2426 3823 7364 964 2743 2423 1955 5274 3684 847 363 35 278 3220 203 2904 6304 1928
```

### 输出

```
22809
```



---

---
title: "[ABC373G] No Cross Matching"
layout: "post"
diff: 省选/NOI-
pid: AT_abc373_g
tag: ['贪心', '分治', '二分图', '费用流']
---

# [ABC373G] No Cross Matching

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc373/tasks/abc373_g

$ 2 $ 次元平面上に $ P_1,P_2,\ldots,P_N,\ Q_1,Q_2,\ldots,Q_N $ の $ 2N $ 個の点があります。 $ P_i $ の座標は $ (A_i,B_i) $、$ Q_i $ の座標は $ (C_i,D_i) $ です。 同一直線上に異なる $ 3 $ 点が存在することはありません。

$ (1,2,\ldots,N) $ の順列であるような数列 $ R=(R_1,R_2,\ldots,R_N) $ であって以下の条件を満たすような $ R $ が存在するか判定し、存在する場合は $ 1 $ つ求めてください。

- $ 1 $ 以上 $ N $ 以下のすべての整数 $ i $ について 線分 $ i $ を $ P_i $ と $ Q_{R_i} $ を端点とする線分としたとき、どの線分 $ i $ と線分 $ j $ $ (1\ \leq\ i\ <\ j\ \leq\ N) $ も互いに交差しない。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ A_1 $ $ B_1 $ $ A_2 $ $ B_2 $ $ \vdots $ $ A_N $ $ B_N $ $ C_1 $ $ D_1 $ $ C_2 $ $ D_2 $ $ \vdots $ $ C_N $ $ D_N $

## 输出格式

条件を満たす $ R $ が存在しない場合は `-1` と出力せよ。

存在する場合は $ R_1,R_2,\ldots,R_N $ を空白区切りで出力せよ。答えが複数存在する場合はどれを出力してもかまわない。

## 说明/提示

### 制約

- $ 1\ \leq\ N\ \leq\ 300 $
- $ 0\ \leq\ A_i,B_i,C_i,D_i\ \leq\ 5000 $ $ (1\ \leq\ i\ \leq\ N) $
- $ (A_i,B_i)\ \neq\ (A_j,B_j) $ $ (1\ \leq\ i\ <\ j\ \leq\ N) $
- $ (C_i,D_i)\ \neq\ (C_j,D_j) $ $ (1\ \leq\ i\ <\ j\ \leq\ N) $
- $ (A_i,B_i)\ \neq\ (C_j,D_j) $ $ (1\ \leq\ i,j\ \leq\ N) $
- 同一直線上に異なる $ 3 $ 点が存在することはない
- 入力はすべて整数

### Sample Explanation 1

以下の図のように点が並んでいます。 !\[\](https://img.atcoder.jp/abc373/G-sample.png)$ R=(2,1,3) $ とすることで $ 3 $ 本の線分は互いに交差しません。また、 $ R $ を $ (1,2,3),(1,3,2),(2,3,1),(3,1,2) $ のいずれにしても正しい答えとなります。

## 样例 #1

### 输入

```
3
0 0
2 4
4 2
0 2
2 0
4 4
```

### 输出

```
2 1 3
```

## 样例 #2

### 输入

```
8
59 85
60 57
72 12
3 27
16 58
41 94
77 64
97 20
32 37
7 2
57 94
35 70
38 60
97 100
5 76
38 8
```

### 输出

```
3 5 8 2 7 4 6 1
```



---

---
title: "[ABC374G] Only One Product Name"
layout: "post"
diff: 省选/NOI-
pid: AT_abc374_g
tag: ['强连通分量', '二分图', '标签476']
---

# [ABC374G] Only One Product Name

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc374/tasks/abc374_g

キーエンスの商品名はすべて **英大文字 $ 2 $ 文字** からなります。  
 すでに $ N $ 個の商品名を使用しており、$ i $ 個目 $ (1\leq\ i\leq\ N) $ の商品名は $ S_i $ です。  
 一度使用した商品名は再び使うことができないので、過去に使用した商品名の一覧がすぐわかるように NG リストを作ることにしました。

NGリストは次の条件をみたす必要があります。

- $ 1 $ つ以上の文字列からなり、各文字列は英大文字のみからなる。
- すでに使用されている商品名それぞれについて、その商品名を（連続する）部分文字列として含む文字列が $ 1 $ つ以上存在する。
- リスト内のすべての文字列は、すでに使用されている商品名でない長さ $ 2 $ の文字列を（連続する）部分文字列として含まない。
 
NG リストの文字列の数としてあり得る最小の値を求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ S_1 $ $ S_2 $ $ \vdots $ $ S_N $

## 输出格式

NG リストの文字列の数としてあり得る最小の値を出力せよ。

## 说明/提示

### 制約

- $ 1\leq\ N\leq\ 26^2 $
- $ N $ は整数
- $ S_i $ は英大文字のみからなる長さ $ 2 $ の文字列
- $ S_1,S_2,\ldots,S_N $ はすべて異なる。
 
### Sample Explanation 1

条件をみたす NG リストとしては例えば次の $ 3 $ つの文字列からなるようなものが考えられます。 - `CABCDE` - `DF` - `XX` これは $ 3 $ つの文字列からなり、$ 2 $ つ以下の文字列からなり条件をみたす NG リストは存在しないため、 $ 3 $ を出力します。

### Sample Explanation 2

条件をみたす NG リストとしては例えば次の $ 2 $ つの文字列からなるようなものが考えられます。 - `ACDE` - `BCDF` すでに使用されている商品名は NG リスト内の複数の文字列に登場したり、同一文字列に複数回含まれたりしていても良いことに注意してください。

### Sample Explanation 3

例えば、`ABACBADB` のみからなる NG リストが条件をみたしています。

## 样例 #1

### 输入

```
7

AB

BC

CA

CD

DE

DF

XX
```

### 输出

```
3
```

## 样例 #2

### 输入

```
5

AC

BC

CD

DE

DF
```

### 输出

```
2
```

## 样例 #3

### 输入

```
6

AB

AC

CB

AD

DB

BA
```

### 输出

```
1
```



---

---
title: "[ABC397G] Maximize Distance"
layout: "post"
diff: 省选/NOI-
pid: AT_abc397_g
tag: ['二分', '网络流', '最小割']
---

# [ABC397G] Maximize Distance

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc397/tasks/abc397_g

给定一个包含 $N$ 个顶点和 $M$ 条边的有向图。顶点编号为 $1,2,\dots,N$，其中第 $j$ 条边（$j=1,2,\dots,M$）从顶点 $u_j$ 指向顶点 $v_j$。保证从顶点 $1$ 到顶点 $N$ 是可达的。

初始时，所有边的权重均为 $0$。当从 $M$ 条边中恰好选择 $K$ 条边并将其权重改为 $1$ 时，求修改后的图中顶点 $1$ 到顶点 $N$ 的最短距离的最大可能值。

## 输入格式

输入通过标准输入给出，格式如下：

> $N$ $M$ $K$   
> $u_1$ $v_1$   
> $u_2$ $v_2$   
> $\vdots$   
> $u_M$ $v_M$   


## 输出格式

输出答案。

## 说明/提示

### 约束条件

- $2 \leq N \leq 30$
- $1 \leq K \leq M \leq 100$
- $1 \leq u_j, v_j \leq N$
- $u_j \neq v_j$
- 给定图中，顶点 $1$ 到顶点 $N$ 是可达的
- 输入均为整数

### 样例解释 1

若选择边 $1$ 和 $3$，则顶点 $1$ 到顶点 $3$ 的最短距离为 $1$。由于不存在使最短距离达到 $2$ 或更大的选择方式，因此答案为 $1$。

### 样例解释 2

若选择边 $1$、$2$ 和 $4$，则顶点 $1$ 到顶点 $4$ 的最短距离为 $2$。由于不存在使最短距离达到 $3$ 或更大的选择方式，因此答案为 $2$。

### 样例解释 3

请注意图中可能存在多重边。

翻译由 DeepSeek R1 完成

## 样例 #1

### 输入

```
3 3 2

1 2

2 3

1 3
```

### 输出

```
1
```

## 样例 #2

### 输入

```
4 4 3

1 2

1 3

3 2

2 4
```

### 输出

```
2
```

## 样例 #3

### 输入

```
2 2 1

1 2

1 2
```

### 输出

```
0
```



---

---
title: "[AGC002D] Stamp Rally"
layout: "post"
diff: 省选/NOI-
pid: AT_agc002_d
tag: ['并查集', '栈', '整体二分']
---

# [AGC002D] Stamp Rally

## 题目描述

[problemUrl]: https://atcoder.jp/contests/agc002/tasks/agc002_d



## 输入格式

第一行两个正整数，代表 $N$ 和 $M$。

接下来 $M$ 行，第 $i$ 行有两个正整数 $a_i,b_i$，代表 $a_i$ 和 $b_i$ 之间有一条无向边。

接下来一行有一个正整数，代表 $Q$。

接下来 $Q$ 行，第 $i$ 行有三个整数 $x_i,y_i,z_i$，表示一种询问。

## 输出格式

对于每个询问，输出一行一个整数表示答案。

## 样例 #1

### 输入

```
5 6
2 3
4 5
1 2
1 3
1 4
1 5
6
2 4 3
2 4 4
2 4 5
1 3 3
1 3 4
1 3 5

```

### 输出

```
1
2
3
1
5
5

```



---

---
title: "[AGC006D] Median Pyramid Hard"
layout: "post"
diff: 省选/NOI-
pid: AT_agc006_d
tag: ['贪心', '二分', '枚举']
---

# [AGC006D] Median Pyramid Hard

## 题目描述

[problemUrl]: https://atcoder.jp/contests/agc006/tasks/agc006_d

$ N $ 段のピラミッドがあります。 段は上から順に $ 1 $, $ 2 $, $ ... $, $ N $ と番号が振られています。 各 $ 1\ <\ =i\ <\ =N $ について、$ i $ 段目には $ 2i-1 $ 個のブロックが横一列に並んでいます。 また、各段の中央のブロックに注目すると、これらは縦一列に並んでいます。

 ![](https://cdn.luogu.com.cn/upload/vjudge_pic/AT_agc006_d/a992c42b0e9b0597f104bf82a0adc1131324bb4f.png)$ N=4 $ 段のピラミッド

 

すぬけ君は $ N $ 段目のブロックに ($ 1 $, $ 2 $, $ ... $, $ 2N-1 $) を並べ替えたもの（順列）を書き込みました。 さらに、次のルールに従い、残りすべてのブロックに整数を書き込みました。

- あるブロックに書き込まれる整数は、そのブロックの左下、真下、右下のブロックに書き込まれた整数の中央値である。

 ![](https://cdn.luogu.com.cn/upload/vjudge_pic/AT_agc006_d/545e109d7af3caf92b1a8f9ac80715efa6c3d3db.png)ブロックに整数を書き込む例

 

その後、すぬけ君はすべてのブロックに書き込まれた整数を消してしまいました。 すぬけ君は、$ N $ 段目のブロックに書き込まれた順列が ($ a_1 $, $ a_2 $, $ ... $, $ a_{2N-1} $) であったことだけを覚えています。

$ 1 $ 段目のブロックに書き込まれた整数を求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ a_1 $ $ a_2 $ $ ... $ $ a_{2N-1} $

## 输出格式

$ 1 $ 段目のブロックに書き込まれた整数を出力せよ。

## 说明/提示

### 制約

- $ 2\ <\ =N\ <\ =10^5 $
- ($ a_1 $, $ a_2 $, $ ... $, $ a_{2N-1} $) は ($ 1 $, $ 2 $, $ ... $, $ 2N-1 $) の順列である。

### Sample Explanation 1

問題文中の図の例です。

## 样例 #1

### 输入

```
4

1 6 3 7 4 5 2
```

### 输出

```
4
```

## 样例 #2

### 输入

```
2

1 2 3
```

### 输出

```
2
```



---

---
title: "[AGC011E] Increasing Numbers"
layout: "post"
diff: 省选/NOI-
pid: AT_agc011_e
tag: ['贪心', '高精度', '二分']
---

# [AGC011E] Increasing Numbers

## 题目描述

[problemUrl]: https://atcoder.jp/contests/agc011/tasks/agc011_e

10 進法で表記したとき，桁同士が隣り合っているところではすべて，右にある桁の値のほうが左にある桁の値以上であるような $ 0 $ 以上の整数を，増加的と呼ぶことにします． たとえば，$ 1558 $ や $ 11 $ や $ 3 $ や $ 0 $ は増加的ですが，$ 10 $ や $ 20170312 $ は増加的ではありません．

すぬけ君は，整数 $ N $ を持っています． $ N $ が最小で何個の増加的な数の和として表されるかを求めてください．

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $

## 输出格式

$ N $ が最小で何個の増加的な数の和として表されるかを出力せよ．

## 说明/提示

### 制約

- $ 1\ \leq\ N\ \leq\ 10^{500000} $

### Sample Explanation 1

例えば，$ 80\ =\ 77\ +\ 3 $ として表すことができます．

### Sample Explanation 2

$ 123456789 $ はそれ自体が増加的なので，$ 1 $ 個の増加的な数の和で表すことができます．

## 样例 #1

### 输入

```
80
```

### 输出

```
2
```

## 样例 #2

### 输入

```
123456789
```

### 输出

```
1
```

## 样例 #3

### 输入

```
20170312
```

### 输出

```
4
```

## 样例 #4

### 输入

```
7204647845201772120166980358816078279571541735614841625060678056933503
```

### 输出

```
31
```



---

---
title: "[AGC032E] Modulo Pairing"
layout: "post"
diff: 省选/NOI-
pid: AT_agc032_e
tag: ['贪心', '二分']
---

# [AGC032E] Modulo Pairing

## 题目描述

[problemUrl]: https://atcoder.jp/contests/agc032/tasks/agc032_e

$ M $ を正整数とします。

$ 2\ N $ 個の整数 $ a_1,\ a_2,\ \ldots,\ a_{2\ N} $ が与えられます。 ここで、各 $ i $ について $ 0\ \leq\ a_i\ <\ M $ です。

$ 2\ N $ 個の整数を $ N $ 組のペアに分けることを考えます。 このとき、各整数はちょうど $ 1 $ つのペアに属さなければなりません。

ペア $ (x,\ y) $ の *醜さ* を $ (x\ +\ y)\ \mod\ M $ と定義します。 $ N $ 組のペアの醜さの最大値を $ Z $ としたとき、$ Z $ の最小値を求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ M $ $ a_1 $ $ a_2 $ $ \cdots $ $ a_{2N} $

## 输出格式

$ N $ 組のペアの醜さの最大値を $ Z $ としたとき、$ Z $ の最小値を出力せよ。

## 说明/提示

### 制約

- 入力はすべて整数である。
- $ 1\ \leq\ N\ \leq\ 10^5 $
- $ 1\ \leq\ M\ \leq\ 10^9 $
- $ 0\ \leq\ a_i\ <\ M $

### Sample Explanation 1

例えば、$ (0,\ 5),\ (2,\ 3),\ (4,\ 9) $ とペアを作ればよいです。 このとき、ペアの醜さはそれぞれ $ 5,\ 5,\ 3 $ となります。

### Sample Explanation 2

$ (1,\ 9),\ (1,\ 9) $ とペアを作ればよいです。 このとき、ペアの醜さはともに $ 0 $ です。

## 样例 #1

### 输入

```
3 10

0 2 3 4 5 9
```

### 输出

```
5
```

## 样例 #2

### 输入

```
2 10

1 9 1 9
```

### 输出

```
0
```



---

---
title: "[AGC034C] Tests"
layout: "post"
diff: 省选/NOI-
pid: AT_agc034_c
tag: ['数学', '贪心', '二分']
---

# [AGC034C] Tests

## 题目描述

[problemUrl]: https://atcoder.jp/contests/agc034/tasks/agc034_c

高橋くんと青木くんは $ 1 $ から $ N $ までの番号がついたテストを受けようとしています。 二人はこのテストの結果を使って勝負することにしました。 具体的には、次のようにして勝敗を決めます。

- 高橋くんが各テスト $ i $ について、その重要度 $ c_i $ を決める。ただしこの値は $ l_i $ 以上 $ u_i $ 以下の整数である必要がある。
- $ \sum_{i=1}^{N}\ c_i\ \times $ (高橋くんのテスト $ i $ の点数) を $ A $, $ \ $ $ \sum_{i=1}^{N}\ c_i\ \times $ (青木くんのテスト $ i $ の点数) を $ B $ とする。 $ A\ \geq\ B $ なら高橋くんの勝ち、$ A\ <\ B $ なら青木くんの勝ち。

高橋くんはエスパーなので、青木くんがテスト $ i $ で $ b_i $ 点をとることがわかっています。

高橋くんはこのままだとすべてのテストで $ 0 $ 点をとってしまいますが、 $ 1 $ 時間勉強するごとに、好きなテストの点数を $ 1 $ だけ上げることができます。($ 1 $ 時間単位でしか勉強できません。) ただしテストはすべて **$ X $ 点満点**なので、 $ X $ より大きい点数にすることはできません。

高橋くんが勝つために必要な最小の勉強時間を出力してください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ X $ $ b_1 $ $ l_1 $ $ u_1 $ $ b_2 $ $ l_2 $ $ u_2 $ $ : $ $ b_N $ $ l_N $ $ u_N $

## 输出格式

高橋くんが勝つために必要な最小の勉強時間を出力せよ。

## 说明/提示

### 制約

- $ 1\ ≦\ N\ ≦\ 10^5 $
- $ 1\ ≦\ X\ ≦\ 10^5 $
- $ 0\ ≦\ b_i\ ≦\ X $ $ (1\ \leq\ i\ \leq\ N) $
- $ 1\ ≦\ l_i\ ≦\ u_i\ ≦\ 10^5 $ $ (1\ \leq\ i\ \leq\ N) $
- 入力はすべて整数

### Sample Explanation 1

例えば次のようにするのが最適です。 - $ c_1\ =\ 3,\ c_2\ =\ 1 $ とする。 - テスト $ 1 $ で $ 100 $ 点、テスト $ 2 $ で $ 15 $ 点とるように勉強する。 このとき $ A\ =\ 3\ \times\ 100\ +\ 1\ \times\ 15\ =\ 315 $, $ B\ =\ 3\ \times\ 85\ +\ 1\ \times\ 60\ =\ 315 $ なので高橋くんが勝ちます。

## 样例 #1

### 输入

```
2 100

85 2 3

60 1 1
```

### 输出

```
115
```

## 样例 #2

### 输入

```
2 100

85 2 3

60 10 10
```

### 输出

```
77
```

## 样例 #3

### 输入

```
1 100000

31415 2718 2818
```

### 输出

```
31415
```

## 样例 #4

### 输入

```
10 1000

451 4593 6263

324 310 6991

378 1431 7068

71 1757 9218

204 3676 4328

840 6221 9080

684 1545 8511

709 5467 8674

862 6504 9835

283 4965 9980
```

### 输出

```
2540
```



---

---
title: "[AGC034D] Manhattan Max Matching"
layout: "post"
diff: 省选/NOI-
pid: AT_agc034_d
tag: ['二分图', '费用流']
---

# [AGC034D] Manhattan Max Matching

## 题目描述

[problemUrl]: https://atcoder.jp/contests/agc034/tasks/agc034_d

すぬけくんは、二次元平面上に赤いボールと青いボールを置いて遊んでいます。

すぬけくんはまず、赤いボールを置く操作を $ N $ 回行いました。 $ i $ 回目の操作では、座標 $ (RX_i,RY_i) $ に $ RC_i $ 個の赤いボールを置きました。 すぬけくんは次に、青いボールを置く操作を $ N $ 回行いました。 $ i $ 回目の操作では、座標 $ (BX_i,BY_i) $ に $ BC_i $ 個の青いボールを置きました。 ここで、すぬけくんが置いた赤いボールの個数の総和と青いボールの個数の総和は等しいです。 つまり、$ \sum_{i=1}^{N}\ RC_i\ =\ \sum_{i=1}^{N}\ BC_i $ です。 以後、この値を $ S $ とおきます。

すぬけくんはこれから、赤いボールと青いボールのペアを $ S $ 個作ろうとしています。 どのボールも、ちょうど $ 1 $ つのペアに属するようにします。 ここで、座標 $ (rx,ry) $ にある赤いボールと座標 $ (bx,by) $ にある青いボールのペアのスコアを、 $ |rx-bx|\ +\ |ry-by| $ と定義します。

すぬけくんは、ペアのスコアの総和を最大化したいです。 すぬけくんのために、ペアのスコアの総和の最大値を求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ RX_1 $ $ RY_1 $ $ RC_1 $ $ RX_2 $ $ RY_2 $ $ RC_2 $ $ \vdots $ $ RX_N $ $ RY_N $ $ RC_N $ $ BX_1 $ $ BY_1 $ $ BC_1 $ $ BX_2 $ $ BY_2 $ $ BC_2 $ $ \vdots $ $ BX_N $ $ BY_N $ $ BC_N $

## 输出格式

ペアのスコアの総和の最大値を出力せよ。

## 说明/提示

### 制約

- $ 1\ \leq\ N\ \leq\ 1000 $
- $ 0\ \leq\ RX_i,RY_i,BX_i,BY_i\ \leq\ 10^9 $
- $ 1\ \leq\ RC_i,BC_i\ \leq\ 10 $
- $ \sum_{i=1}^{N}\ RC_i\ =\ \sum_{i=1}^{N}\ BC_i $
- 入力される値はすべて整数である。

### Sample Explanation 1

座標 $ (0,0) $ に置いてある赤いボールと座標 $ (2,2) $ に置いてある青いボールをペアにすると、 そのスコアは $ |0-2|\ +\ |0-2|=4 $ です。 また、座標 $ (3,2) $ に置いてある赤いボールと座標 $ (5,0) $ に置いてある青いボールをペアにすると、 そのスコアは $ |3-5|\ +\ |2-0|=4 $ です。 この $ 2 $ つのペアを作ると、スコアの総和は $ 8 $ になり、これが最大です。

### Sample Explanation 2

同じ座標に複数回操作を行うこともあります。

## 样例 #1

### 输入

```
2

0 0 1

3 2 1

2 2 1

5 0 1
```

### 输出

```
8
```

## 样例 #2

### 输入

```
3

0 0 1

2 2 1

0 0 2

1 1 1

1 1 1

3 3 2
```

### 输出

```
16
```

## 样例 #3

### 输入

```
10

582463373 690528069 8

621230322 318051944 4

356524296 974059503 6

372751381 111542460 9

392867214 581476334 6

606955458 513028121 5

882201596 791660614 9

250465517 91918758 3

618624774 406956634 6

426294747 736401096 5

974896051 888765942 5

726682138 336960821 3

715144179 82444709 6

599055841 501257806 6

390484433 962747856 4

912334580 219343832 8

570458984 648862300 6

638017635 572157978 10

435958984 585073520 7

445612658 234265014 6
```

### 输出

```
45152033546
```



---

---
title: "[AGC037D] Sorting a Grid"
layout: "post"
diff: 省选/NOI-
pid: AT_agc037_d
tag: ['网络流', '二分图']
---

# [AGC037D] Sorting a Grid

## 题目描述

[problemUrl]: https://atcoder.jp/contests/agc037/tasks/agc037_d

$ N $ 行 $ M $ 列のマス目があります。 このマス目には $ 1 $ から $ NM $ までの整数がそれぞれ $ 1 $ つずつ書かれています。 上から $ i $ 行目、左から $ j $ 列目にあるマスに書かれている数は $ A_{ij} $ です。

あなたはこのマス目を以下の手順に従って並べ替える必要があります。

1. まず $ N $ 個の行それぞれに対して、その行に書かれている数を好きに並べ替える。
2. 次に $ M $ 個の列それぞれに対して、その列に書かれている数を好きに並べ替える。
3. 最後に $ N $ 個の行それぞれに対して、その行に書かれている数を好きに並べ替える。

最終的に上から $ i $ 行目、左から $ j $ 行目にあるマスに書かれている数が $ M\times\ (i-1)+j $ となるようにしたいです。 そのような並べ替え方を一つ構成してください。与えられた制約の下で、常に条件をみたすように並べ替えられることができることは保証されています。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ M $ $ A_{11} $ $ A_{12} $ $ ... $ $ A_{1M} $ $ : $ $ A_{N1} $ $ A_{N2} $ $ ... $ $ A_{NM} $

## 输出格式

以下の形式で並べ替え方を出力せよ。

> $ B_{11} $ $ B_{12} $ $ ... $ $ B_{1M} $ $ : $ $ B_{N1} $ $ B_{N2} $ $ ... $ $ B_{NM} $ $ C_{11} $ $ C_{12} $ $ ... $ $ C_{1M} $ $ : $ $ C_{N1} $ $ C_{N2} $ $ ... $ $ C_{NM} $

ただし、$ B_{ij} $ は手順 $ 1 $ を行った後に上から $ i $ 行目、左から $ j $ 行目にあるマスに書かれている数であり、 $ C_{ij} $ は手順 $ 2 $ を行った後に上から $ i $ 行目、左から $ j $ 行目にあるマスに書かれている数である。

## 说明/提示

### 制約

- $ 1\ ≦\ N,M\ ≦\ 100 $
- $ 1\ ≦\ A_{ij}\ ≦\ NM $
- $ A_{ij} $ は相異なる

## 样例 #1

### 输入

```
3 2

2 6

4 3

1 5
```

### 输出

```
2 6 

4 3 

5 1 

2 1 

4 3 

5 6
```

## 样例 #2

### 输入

```
3 4

1 4 7 10

2 5 8 11

3 6 9 12
```

### 输出

```
1 4 7 10 

5 8 11 2 

9 12 3 6 

1 4 3 2 

5 8 7 6 

9 12 11 10
```



---

---
title: "[AGC067A] Big Clique Everywhere"
layout: "post"
diff: 省选/NOI-
pid: AT_agc067_a
tag: ['二分图', 'Ad-hoc']
---

# [AGC067A] Big Clique Everywhere

## 题目描述

[problemUrl]: https://atcoder.jp/contests/agc067/tasks/agc067_a

$ 1 $ から $ N $ までの番号がついた $ N $ 頂点の単純無向グラフ $ G $ が与えられます。 $ G $ は $ M $ 本の辺を持ち、$ i $ 本目の辺は頂点 $ A_i $ と $ B_i $ を結びます。

$ G $ が次の条件を満たすか判定してください。

- 頂点集合 $ \{1,2,\cdots,N\} $ のすべての部分集合 $ X $ に対して、$ X $ の部分集合 $ Y $ であって $ |Y|\ge\ \frac{|X|}{2} $ かつ $ Y $ がクリークを形成するものが存在する。

解くべきテストケースは $ T $ 個あります。

## 输入格式

入力は標準入力から以下の形式で与えられる。

> $ T $ $ case_1 $ $ case_2 $ $ \vdots $ $ case_T $

各テストケースは以下の形式で与えられる。

> $ N $ $ M $ $ A_1 $ $ B_1 $ $ A_2 $ $ B_2 $ $ \vdots $ $ A_M $ $ B_M $

## 输出格式

各テストケースについて、$ G $ が条件を満たすなら `Yes`、そうでないなら `No` と出力せよ。  
`Yes` または `No` の出力において、各文字は大文字・小文字のいずれでもよい。

## 说明/提示

### 制約

- $ 1\le\ T\ \le\ 10^3 $
- $ 1\le\ N\ \le\ 10^5 $
- $ 0\ \le\ M\ \le\ 10^6 $
- $ 1\ \le\ A_i,B_i\ \le\ N $
- 与えられるグラフは自己辺も多重辺も含まない。
- ひとつの入力の中のテストケースすべてにわたる $ N $ の総和は $ 10^5 $ 以下である。
- ひとつの入力の中のテストケースすべてにわたる $ M $ の総和は $ 10^6 $ 以下である。
- すべての入力値は整数である。

### Sample Explanation 1

$ 1 $ 番目のテストケースについて、$ G $ は条件を満たします。 この場合、すべての部分集合 $ X $ がクリークであるため、単に $ Y=X $ とできます。 $ 2 $ 番目のテストケースについて、$ G $ は条件を満たします。 例えば、$ X=\{2,3\} $ に対しては、$ Y=\{2\} $ とできます。 $ 4 $ 番目のテストケースについて、$ G $ は条件を満たしません。 $ X=\{1,2,3\} $ とすると、条件を満たす $ X $ の部分集合 $ Y $ はありません。

## 样例 #1

### 输入

```
4
3 3
1 2
1 3
2 3
3 2
1 2
1 3
3 1
1 2
3 0
```

### 输出

```
Yes
Yes
Yes
No
```



---

---
title: "[AGC069B] Pair Guessing"
layout: "post"
diff: 省选/NOI-
pid: AT_agc069_b
tag: ['并查集', '二分图']
---

# [AGC069B] Pair Guessing

## 题目描述

[problemUrl]: https://atcoder.jp/contests/agc069/tasks/agc069_b

$ N $ 個の、長さ $ N $ の $ 01 $ 文字列 $ S_1,\ldots,S_N $ が与えられます。$ S_i $ の $ j $ 文字目を $ S_{i,j} $ と表します。ここで、$ S_{i,j}=\ $`1` を満たす整数組 $ (i,j) $ が少なくとも一つ存在することが制約より保証されています。

高橋君と青木君が以下のようなゲームを行います。

1. 高橋君が $ 1\ \leq\ i,j\ \leq\ N,\ S_{i,j}=\ $`1` を満たす整数組 $ (i,j) $ を $ 1 $ つ選ぶ。
2. $ 0 $ 回以上 $ N $ 回以下、青木君が高橋君に質問を行う。各質問では青木君が $ 1\leq\ i',j'\ \leq\ N $ を満たす整数組 $ (i',j') $ を選び、「$ i=i' $ と $ j=j' $ のうち少なくとも一方が成り立つ」の真偽を高橋君から教えてもらう。
3. 青木君が $ (i,j) $ を予想する。予想が当たっていれば青木君の勝ち、そうでなければ負けとなる。
 
青木君は高橋君が選ぶ $ (i,j) $ の候補、すなわち $ S_1,\ldots,S_N $ を知った状態でゲームを行います。また、上記2では以前の質問に対する返事を聞いたうえで $ (i',\ j') $ を選ぶことができます。

青木君が適切な戦略を取った場合、高橋君の $ (i,j) $ の選び方や運によらず必ずゲームに勝てるかどうかを判定してください。

$ 1 $ つの入力につきテストケースは $ T $ 個あります。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ T $ $ case_1 $ $ \vdots $ $ case_T $

各テストケースは以下の形式で与えられる。

> $ N $ $ S_1 $ $ \vdots $ $ S_N $

## 输出格式

各テストケースに対し、青木君が必ずゲームに勝てるならば `Yes` と、そうでなければ `No` と出力せよ。

## 说明/提示

### 制約

- $ 1\ \leq\ T\ \leq\ 2\ \times\ 10^5 $
- $ 1\ \leq\ N\ \leq\ 500 $
- $ 1 $ つの入力の中のテストケースすべてにわたる $ N^2 $ の総和は $ 500^2 $ 以下である
- $ S_i $ は長さ $ N $ の $ 01 $ 文字列
- $ S_{i,j}=\ $ `1` を満たす整数組 $ (i,j) $ が少なくとも一つ存在する
 
### Sample Explanation 1

$ 1 $ 番目のテストケースに対するゲームの一例を以下に示します。 1. 高橋君が $ S_{i,j}=\ $`1` を満たす $ (i,j) $ として $ (2,2) $ を選ぶ。 2. 青木君が $ 2 $ 回質問を行う。$ 1 $ 回目の質問では $ (i',j')=(1,1) $ として、高橋君から「$ i=1 $ と $ j=1 $ のうち少なくとも一方が成り立つ」が偽であると教えてもらう。$ 2 $ 回目の質問では $ (i',j')=(2,2) $ として、高橋君から「$ i=2 $ と $ j=2 $ の少なくとも一方が成り立つ」が真であると教えてもらう。 3. 青木君が $ (i,j)=(2,2) $ と予想する。この予想は当たっているため、青木君の勝ちである。 これはあくまでゲームの一例であり、青木君の戦略が適切とは限りません。しかし、青木君が適切な戦略を取った場合には必ず青木君がゲームに勝つため、$ 1 $ 番目のテストケースに対する出力は `Yes` になります。

## 样例 #1

### 输入

```
3

2

01

11

2

11

11

10

0101011110

1100100001

1101100000

0111101010

1000011001

1110101010

1110110100

1110000110

0000001011

1001111100
```

### 输出

```
Yes

No

Yes
```



---

---
title: "[ARC016D] 軍艦ゲーム"
layout: "post"
diff: 省选/NOI-
pid: AT_arc016_4
tag: ['动态规划 DP', '二分', '期望']
---

# [ARC016D] 軍艦ゲーム

## 题目描述

[problemUrl]: https://atcoder.jp/contests/arc016/tasks/arc016_4

高橋君は艦長である。  
 高橋艦長の任務は、鎮守府のある海域から最終目的地となる海域へ進軍することである。  
 高橋艦長は次の順序で行動する。

1. 航路選択

- 進軍する航路を選択する。現在の海域から異なる海域へ移動できる航路が $ 1 $ 本も存在しない場合、$ 4 $ の海域離脱を行う。
- また、現在の海域から異なる海域への航路が複数本存在する場合、何者かの陰謀によって等確率で航路が選択される。
- たとえば、鎮守府のある海域から、他の海域への航路が $ 4 $ 本存在する場合、それぞれ $ 25% $ の確率で選択されます。


4. 進軍
- 選択された航路によって、海域を移動する。

6. 戦闘
- 進軍先の海域 $ i $ には敵艦が待ち構えており、戦闘が発生する。
- 鎮守府から出港したとき、高橋艦長が率いる軍艦の体力は $ H $ であり、戦闘によって軍艦の体力は $ D_i $ だけ減少する。
- 軍艦の体力が $ 0 $ 以下になると、軍艦は沈没してしまう。
- 軍艦が沈没すると高橋艦長は失意のあまりこれ以上出撃することが出来なくなってしまうため、`絶対に沈没させてはいけない`。
- なお、鎮守府のある海域では戦闘は発生しないが、最終目的地である海域では必ず戦闘が発生する。

8. 海域離脱 or 航路選択に戻る
- 海域離脱とは、鎮守府のある海域へ戻ることを意味する。
- 海域離脱した際に、軍艦の残り体力が $ C $ であった場合、$ H-C $ だけ体力回復のために時間を消費する。
 
 上記`1`,`2`,`3`,`4`のサイクル1回につき時間を $ 1 $ だけ使う。  
- - - - - -

 海域と航路について - いま、$ N $ 個の海域と $ M $ 個の航路がある。
- これら $ M $ 個の航路は、すべて一方通行である。
 
 そのため、任意の異なる海域 $ A,B $ において、ある $ 1 $ 本の航路を利用して、海域 $ A $ から海域 $ B $ へ移動し、海域 $ B $ から海域 $ A $ へ移動することはできない。  
- - - - - -

 あなたは高橋艦長の参謀であり、高橋艦長が消費する時間を最小となるよう行動した場合、最終目的地における戦闘で生存するまでに経過する時間の期待値を求めることが仕事である。  
 どのようにしても高橋艦長が任務を完遂できない場合は`-1`と出力せよ。  
 ただし、出力する期待値が $ 10^6 $ より大きくなる入力は与えられない。 入力は以下の形式で標準入力から与えられる。 > $ N $ $ M $ $ H $ $ f_1 $ $ t_1 $ $ f_2 $ $ t_2 $ : $ f_M $ $ t_M $ $ D_1 $ $ D_2 $ : $ D_N $

1. $ 1 $ 行目は、海域数を表す整数 $ N\ (2≦N≦100) $、航路数を表す整数 $ M\ (0≦M≦N\ *\ (N\ -\ 1)\ /\ 2) $、出港時の艦隊の体力を表す整数 $ H\ (1≦H≦100) $ が半角空白区切りで与えられる。

- 鎮守府のある海域は $ 1 $ で、最終目的地である海域は $ N $ です。

32. $ 2 $ 行目から $ M $ 行は、 $ i $ 番目の航路を表す。移動元の海域を表す整数 $ f_i\ (1≦f_i≦N) $、移動先の海域を表す整数 $ t_i\ (1≦t_i≦N) $ が、スペース区切りで与えられる。
- $ f_i\ <\ t_i $ であることが保証されている。

34. $ 2+M $ 行目から $ N $ 行は、$ i $ 番目の海域での戦闘で受けるダメージを表す整数 $ D_i\ (0≦D_i≦100) $ が、一行で与えられる。
- $ D_1 $ の値は常に $ 0 $ である（鎮守府のある海域です）。

- 出力する期待値が $ 10^6 $ より大きくなる入力が与えられないことに留意せよ。
 
 高橋艦長が消費する時間が最小となるよう行動した場合、最終目的地における戦闘で生存するまでに経過する時間の期待値を出力せよ。  
 出力は絶対誤差あるいは相対誤差の少なくとも片方が $ 10^{-6} $ 以下であれば許容される。   
 また、どのようにしても高橋艦長が任務を完遂できない場合は`-1`と出力せよ。  
 なお、出力の最後には改行をいれること。  

- 鎮守府のある $ 1 $ から、最終目的地である $ 6 $ までは、$ 2 $ 通りの経路があります。

1. 1 -&gt; 2 -&gt; 4 -&gt; 6

- このルートが選択される確率は $ 50% $ です。
- このルートで軍艦が受けるダメージは $ 0+1+2+4=7 $ です。
- このルートで消費する時間は、サイクル $ 3 $ 回の時間のみなので、$ 3 $ です。

48. 1 -&gt; 3 -&gt; 5 -&gt; 6
- このルートが選択される確率は $ 50% $ です。
- このルートで軍艦が受けるダメージは $ 0+1+3+4=8 $ です。
- 出港時の軍艦の体力は $ 8 $ なので、このルートでは沈没してしまいます。
- 高橋艦長は、沈没を避けるため、海域 $ 3 $ の戦闘終了時に海域離脱を選択します。
- このルートで消費する時間は、サイクル $ 1 $ 回の時間 $ + $ 体力の回復にかかる時間 $ = $ $ 1+1=2 $ です。
 
 1 -&gt; 3 -&gt; 5 -&gt; 6 で `1` 度撤退してから 1-&gt; 2-&gt; 4 -&gt; 6 - $ 50% $ の確率で 1 -&gt; 3 -&gt; 5 -&gt; 6 が選択され、時間 $ 2 $ を使って鎮守府に戻る。
- その後、 $ 50% $ の確率で 1 -&gt; 2 -&gt; 4 -&gt; 6 が選択され、時間 $ 3 $ を使って最終目的地に到達する。
- つまり、$ 25% $ の確率で時間 $ 5 $ を使って最終目的地に到達。
 
 1 -&gt; 3 -&gt; 5 -&gt; 6 で `2` 度撤退してから 1-&gt; 2-&gt; 4 -&gt; 6 - $ 12.5% $ の確率で時間 $ 7 $ を使って最終目的地に到達。
 
 1 -&gt; 3 -&gt; 5 -&gt; 6 で `3` 度撤退してから 1-&gt; 2-&gt; 4 -&gt; 6 - $ 6.25% $ の確率で時間 $ 9 $ を使って最終目的地に到達。

62. 上記から、求める期待値は $ 3*0.5+5*0.25+7*0.125+...=5 $ となります。


## 样例 #1

### 输入

```
6 6 8
1 2
1 3
2 4
3 5
4 6
5 6
0
1
1
2
3
4
```

### 输出

```
5.0
```

## 样例 #2

### 输入

```
3 2 5
1 2
1 3
0
5
1
```

### 输出

```
-1
```

## 样例 #3

### 输入

```
3 2 6
1 2
1 3
0
5
1
```

### 输出

```
7
```

## 样例 #4

### 输入

```
9 13 4
1 2
1 3
2 4
2 5
2 7
3 5
3 6
4 7
5 8
6 8
7 8
7 9
8 9
0
1
1
1
1
1
1
1
1
```

### 输出

```
36.9999999999999
```



---

---
title: "[ARC168E] Subsegments with Large Sums"
layout: "post"
diff: 省选/NOI-
pid: AT_arc168_e
tag: ['动态规划 DP', '凸完全单调性（wqs 二分）']
---

# [ARC168E] Subsegments with Large Sums

## 题目描述

[problemUrl]: https://atcoder.jp/contests/arc168/tasks/arc168_e

長さ $ N $ の正整数列 $ A=(A_1,A_2,\cdots,A_N) $ が与えられます．

この数列を $ K $ 個の非空な連続部分列に分割することを考えます． この $ K $ 個の連続部分列のうち，要素の総和が $ S $ 以上であるものの個数を**スコア**と呼ぶことにします． スコアの最大値を求めてください．

## 输入格式

入力は以下の形式で標準入力から与えられる．

> $ N $ $ K $ $ S $ $ A_1 $ $ A_2 $ $ \cdots $ $ A_N $

## 输出格式

答えを出力せよ．

## 说明/提示

### 制約

- $ 1\ \leq\ K\ \leq\ N\ \leq\ 250000 $
- $ 1\ \leq\ A_i\ \leq\ 10^9 $
- $ 1\ \leq\ S\ \leq\ 10^{15} $
- 入力される値はすべて整数．
 
### Sample Explanation 1

数列を $ (1),(4,2),(8) $ と分割すると，スコアが $ 2 $ になります． これより大きいスコアは達成できないため，答えは $ 2 $ です．

## 样例 #1

### 输入

```
4 3 6

1 4 2 8
```

### 输出

```
2
```

## 样例 #2

### 输入

```
10 5 2

1 1 1 1 1 1 1 1 1 1
```

### 输出

```
5
```

## 样例 #3

### 输入

```
10 5 3

1 1 1 1 1 1 1 1 1 1
```

### 输出

```
2
```

## 样例 #4

### 输入

```
20 6 946667802

786820955 250480341 710671229 946667801 19271059 404902145 251317818 22712439 520643153 344670307 274195604 561032101 140039457 543856068 521915711 857077284 499774361 419370025 744280520 249168130
```

### 输出

```
6
```



---

---
title: "[ARC186A] Underclued"
layout: "post"
diff: 省选/NOI-
pid: AT_arc186_a
tag: ['动态规划 DP', '强连通分量', '二分图', '构造', '标签465']
---

# [ARC186A] Underclued

## 题目描述

[problemUrl]: https://atcoder.jp/contests/arc186/tasks/arc186_a

各成分が $ 0,1 $ である $ N $ 次正方行列 $ A,B $ について、以下の条件を満たしているとき $ A $ と $ B $ は **似ている** と言います。

- 各行の総和が等しい。つまり、どの $ i=1,\dots,N $ についても $ A_{i,1}\ +\ \dots\ +\ A_{i,N}\ =\ B_{i,1}\ +\ \dots\ +\ B_{i,N} $
- 各列の総和が等しい。つまり、どの $ j=1,\dots,N $ についても $ A_{1,j}\ +\ \dots\ +\ A_{N,j}\ =\ B_{1,j}\ +\ \dots\ +\ B_{N,j} $

また、各成分が $ 0,1 $ である $ N $ 次正方行列 $ A $ と整数 $ i,j $ ($ 1\ \leq\ i,j\ \leq\ N $) について、$ A $ と似ているどの行列 $ B $ についても $ A_{i,j}\ =\ B_{i,j} $ が成り立つとき、$ A $ の $ i $ 行 $ j $ 列成分は **固定されている** と言います。

以下の $ Q $ 個のクエリに答えてください。

- $ i $ 番目のクエリ：各成分が $ 0,1 $ である $ N $ 次正方行列であって、固定されている成分がちょうど $ K_i $ 個であるようなものが存在するなら `Yes`、そうでないなら `No` を出力せよ。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ Q $ $ K_1 $ $ K_2 $ $ \vdots $ $ K_Q $

## 输出格式

$ Q $ 行に出力せよ。 $ i\ (1\ \le\ i\ \le\ Q) $ 行目には $ i $ 番目のクエリの答えを出力せよ。

## 说明/提示

### 制約

- $ 2\ \le\ N\ \le\ 30 $
- $ 1\ \le\ Q\ \le\ N^2+1 $
- $ 0\ \le\ K_i\ \le\ N^2 $
- $ K_i\ \ne\ K_j\ (1\ \le\ i\ <\ j\ \le\ Q) $
- 入力はすべて整数

### Sample Explanation 1

$ 1 $ 番目のクエリ： 例えば、以下のような行列 $ X $ は、固定されている成分が $ 0 $ 個です。 ``` 1 0 0 0 1 0 0 0 1 ``` なぜなら、次のように列を循環シフトさせていったものはすべて $ X $ と似ており、どの成分も $ 0 $ にも $ 1 $ にもなりうるためです。 ``` 0 0 1 1 0 0 0 1 0 ``` ``` 0 1 0 0 0 1 1 0 0 ``` $ 2 $ 番目のクエリ： 例えば、以下のような行列 $ X $ は、固定されている成分が $ 9 $ 個です。 ``` 0 0 1 0 1 1 1 1 1 ``` なぜなら、似ている行列は $ X $ 以外に存在せず、すべての成分が固定されているためです。 $ 3 $ 番目のクエリ： 固定されている成分がちょうど $ 7 $ 個であるような行列は存在しません。

## 样例 #1

### 输入

```
3 3
0
9
7
```

### 输出

```
Yes
Yes
No
```

## 样例 #2

### 输入

```
29 6
186
681
18
108
123
321
```

### 输出

```
No
Yes
No
Yes
No
Yes
```



---


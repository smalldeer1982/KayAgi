---
title: "[ABC384G] Abs Sum"
layout: "post"
diff: 省选/NOI-
pid: AT_abc384_g
tag: ['莫队', '树状数组', '分块']
---

# [ABC384G] Abs Sum

## 题目描述

给定长度为$N$的整数序列$A,B$和长度为$K$的正整数序列$X,Y$，对于$k=1,2,3,...,K$，求$\sum_{i = 1}^{X_k} \sum_{j = 1}^{Y_k} |A_i-B_j|$。

## 输入格式

第一行输入一个整数$N$。  
第二行输入$N$个整数$A_1,A_2,A_3,...,A_N$。  
第三行输入$N$个整数$B_1,B_2,B_3,...,B_N$。  
第四行输入一个整数$K$。  
接下来共$K$行，每行两个整数，第$i$行输入的数为$X_i,Y_i$。

## 输出格式

输出共$K$行，每行一个整数，第$i$行表示当$k=i$时的结果。  
### 样例解释
#### 测试数据1
当$k=1$时，答案为$|A_1-B_1|=1$，因此第$1$行输出一个整数$1$。    
当$k=2$时，答案为$|A_1-B_1|+|A_1-B_2|=1+3=4$，因此第$2$行输出一个整数$4$。  
当$k=3$时，答案为$|A_1-B_1|+|A_2-B_1|=1+1=2$，因此第$3$行输出一个整数$2$。  
当$k=4$时，答案为$|A_1-B_1|+|A_1-B_2|+|A_2-B_1|+|A_2-B_2|=1+3+1+1=6$，因此第$4$行输出一个整数$6$。

## 样例 #1

### 输入

```
2
2 4
3 5
4
1 1
1 2
2 1
2 2
```

### 输出

```
1
4
2
6
```

## 样例 #2

### 输入

```
5
1163686 28892 1263085 2347878 520306
1332157 1202905 2437161 1291976 563395
5
5 3
1 5
2 3
1 2
5 5
```

### 输出

```
13331322
2209746
6366712
207690
20241215
```



---

---
title: "[ABC405G] Range Shuffle Query"
layout: "post"
diff: 省选/NOI-
pid: AT_abc405_g
tag: ['数学', '莫队', '分块']
---

# [ABC405G] Range Shuffle Query

## 题目描述

给你一个长为 $N$ 的数列 $A=(A_1,A_2,\cdots,A_N)$，你要回答 $Q$ 个询问。

每个询问有三个参数 $(L_i,R_i,X_i)$，你需要回答：

令 $B=(A_{L_i},A_{L_i+1},\cdots,A_{R_i})$，删除 $B$ 中 $\ge X_i$ 的所有元素后，通过重新排列 $B$ 的元素可以形成多少种不同的 $B$？

答案对 $998244353$ 取模。

## 输入格式

第一行两个整数 $N,Q(1\le N,Q\le 2.5\times 10^5)$。\
第二行 $N$ 个整数 $A_1,A_2,\cdots,A_N(1\le A_i\le N)$。\
之后 $Q$ 行，每行三个整数 $L_i,R_i,X_i(1\le L_i\le R_i\le N,1\le X_i\le N)$，表示一次询问。

## 输出格式

输出 $Q$ 行，每行一个整数，依次回答每个询问，答案对 $998244353$ 取模。

## 说明/提示

**样例 1 解释**

对于第一个询问，$B$ 的三种可能分别为：$B=(1,1,2),B=(1,2,1),B=(2,1,1)$。\
对于第二个询问，$B$ 的唯一可能为空串。

By @[chenxi2009](/user/1020063)

## 样例 #1

### 输入

```
5 3
1 2 3 3 1
1 5 3
3 4 1
1 3 4
```

### 输出

```
3
1
6
```

## 样例 #2

### 输入

```
8 6
6 2 4 1 5 1 8 6
5 6 3
1 5 7
1 4 6
4 7 8
4 8 2
5 8 6
```

### 输出

```
1
120
6
3
1
2
```



---

---
title: "[ARC069F] Flags"
layout: "post"
diff: 省选/NOI-
pid: AT_arc069_d
tag: ['线段树', '强连通分量', '分块']
---

# [ARC069F] Flags

## 题目描述

[problemUrl]: https://atcoder.jp/contests/arc069/tasks/arc069_d

すぬけくんは旗が好きです。

すぬけくんは $ N $ 本の旗を一直線上に並べることにしました。

$ i $ 番目の旗は座標 $ x_i $ か座標 $ y_i $ のどちらかに設置することができます。

すぬけくんは、$ 2 $ つの旗同士の距離の最小値 $ d $ が大きいほど、旗の並びの見栄えが良いと考えています。$ d $ としてありうる値の最大値を求めなさい。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ x_1 $ $ y_1 $ $ : $ $ x_N $ $ y_N $

## 输出格式

答えを出力せよ。

## 说明/提示

### 制約

- $ 2\ ≦\ N\ ≦\ 10^{4} $
- $ 1\ ≦\ x_i,\ y_i\ ≦\ 10^{9} $
- $ x_i,\ y_i $ は整数

### Sample Explanation 1

旗 $ 1 $ を座標 $ 1 $ に、旗 $ 2 $ を座標 $ 5 $ に、旗 $ 3 $ を座標 $ 9 $ に設置するのが最適であり、このとき旗同士の距離の最小値は $ 4 $ となります。

### Sample Explanation 2

旗の位置は重なることもあります。

## 样例 #1

### 输入

```
3

1 3

2 5

1 9
```

### 输出

```
4
```

## 样例 #2

### 输入

```
5

2 2

2 2

2 2

2 2

2 2
```

### 输出

```
0
```

## 样例 #3

### 输入

```
22

93 6440

78 6647

862 11

8306 9689

798 99

801 521

188 206

6079 971

4559 209

50 94

92 6270

5403 560

803 83

1855 99

42 504

75 484

629 11

92 122

3359 37

28 16

648 14

11 269
```

### 输出

```
17
```



---

---
title: "Distinct Integers"
layout: "post"
diff: 省选/NOI-
pid: AT_jsc2019_final_h
tag: ['线段树', '分块']
---

# Distinct Integers

## 题目描述

[problemUrl]: https://atcoder.jp/contests/jsc2019-final/tasks/jsc2019_final_h

長さ $ N $ の数列 $ A_0,A_1,\cdots,A_{N-1} $ があります。 $ Q $ 個のクエリに答えてください。 具体的には、クエリ $ i $ ($ 0\ \leq\ i\ \leq\ Q-1 $) では整数 $ T_i,X_i,Y_i $ が与えられるので、以下のことをしてください。

- $ T_i=0 $ の時: $ A_{X_i} $ を $ Y_i $ で置き換える。
- $ T_i=1 $ の時: 次の条件をみたす整数の組 $ l,r $ ($ X_i\ \leq\ l\ <\ r\ \leq\ Y_i $) の個数を答える。
  - $ A_{l},A_{l+1},\cdots,A_{r-1} $ が全て異なる。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ Q $ $ A_0 $ $ A_1 $ $ \cdots $ $ A_{N-1} $ $ T_0 $ $ X_0 $ $ Y_0 $ $ T_1 $ $ X_1 $ $ Y_1 $ $ \vdots $ $ T_{Q-1} $ $ X_{Q-1} $ $ Y_{Q-1} $

## 输出格式

$ T_i=1 $ となるクエリの答えを、クエリが与えられた順に、$ 1 $ 行ずつ出力せよ。

## 说明/提示

### 制約

- $ 1\ \leq\ N\ \leq\ 5\ \times\ 10^5 $
- $ 1\ \leq\ Q\ \leq\ 5\ \times\ 10^5 $
- $ 0\ \leq\ A_i\ \leq\ N-1 $
- $ 0\ \leq\ T_i\ \leq\ 1 $
- $ 0\ \leq\ X_i\ \leq\ N-1,\ 0\ \leq\ Y_i\ \leq\ N-1 $ ($ T_i=0 $)
- $ 0\ \leq\ X_i\ <\ Y_i\ \leq\ N $ ($ T_i=1 $)
- $ T_i=1 $ をみたす $ i $ が少なくとも $ 1 $ つ存在する。
- 入力される値はすべて整数である。

### Sample Explanation 1

例としてクエリ $ 4 $ を考えます。 このクエリが与えられた時、$ A=(0,1,4,3,4) $ です。 また、条件をみたす $ l,r $ の組は、$ (l,r)=(2,3),(2,4),(3,4),(3,5),(4,5) $ の $ 5 $ 個です。

## 样例 #1

### 输入

```
5 5

0 1 2 1 4

1 0 4

0 3 3

1 0 5

0 2 4

1 2 5
```

### 输出

```
8

15

5
```

## 样例 #2

### 输入

```
30 30

14 24 18 7 20 10 0 27 27 29 27 20 23 29 27 0 11 10 0 12 19 7 21 12 11 7 27 11 21 0

1 6 21

1 27 29

0 23 21

1 1 5

0 3 24

1 3 6

1 9 16

1 16 26

1 0 11

0 29 27

0 25 29

0 4 24

1 10 23

1 18 24

0 22 14

0 13 10

1 2 29

0 7 12

0 27 14

1 18 20

0 23 7

0 15 20

1 1 24

0 24 7

0 24 20

1 7 16

0 15 27

0 23 10

1 11 13

1 4 8
```

### 输出

```
53

3

10

6

23

34

31

57

16

116

3

94

28

3

10
```



---


---
title: "[ABC282Ex] Min + Sum"
layout: "post"
diff: 省选/NOI-
pid: AT_abc282_h
tag: ['二分', '分治']
---

# [ABC282Ex] Min + Sum

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc282/tasks/abc282_h

$ 2 $ つの長さ $ N $ の整数列 $ A\ =\ (A_1,\ A_2,\ \ldots,\ A_N) $ および $ B\ =\ (B_1,\ B_2,\ \ldots,\ B_N) $ が与えられます。

$ 1\ \leq\ l\ \leq\ r\ \leq\ N $ を満たす整数の組 $ (l,\ r) $ であって下記の条件を満たすものの個数を出力してください。

- $ \min\lbrace\ A_l,\ A_{l+1},\ \ldots,\ A_r\ \rbrace\ +\ (B_l\ +\ B_{l+1}\ +\ \cdots\ +\ B_r)\ \leq\ S $

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ S $ $ A_1 $ $ A_2 $ $ \ldots $ $ A_N $ $ B_1 $ $ B_2 $ $ \ldots $ $ B_N $

## 输出格式

答えを出力せよ。

## 说明/提示

### 制約

- $ 1\ \leq\ N\ \leq\ 2\ \times\ 10^5 $
- $ 0\ \leq\ S\ \leq\ 3\ \times\ 10^{14} $
- $ 0\ \leq\ A_i\ \leq\ 10^{14} $
- $ 0\ \leq\ B_i\ \leq\ 10^9 $
- 入力はすべて整数
 
### Sample Explanation 1

$ 1\ \leq\ l\ \leq\ r\ \leq\ N $ を満たす整数の組 $ (l,\ r) $ であって問題文中の条件を満たすものは、 $ (1,\ 1),\ (1,\ 2),\ (2,\ 2),\ (2,\ 3),\ (3,\ 3),\ (4,\ 4) $ の $ 6 $ 個です。

## 样例 #1

### 输入

```
4 15

9 2 6 5

3 5 8 9
```

### 输出

```
6
```

## 样例 #2

### 输入

```
15 100

39 9 36 94 40 26 12 26 28 66 73 85 62 5 20

0 0 7 7 0 5 5 0 7 9 9 4 2 5 2
```

### 输出

```
119
```



---

---
title: "[ABC313F] Flip Machines"
layout: "post"
diff: 省选/NOI-
pid: AT_abc313_f
tag: ['根号分治']
---

# [ABC313F] Flip Machines

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc313/tasks/abc313_f

$ 1 $ から $ N $ までの番号が付けられた $ N $ 枚のカードがあります。 カードのそれぞれの面には整数が書かれており、カード $ i $ の表には $ A_i $ が、裏には $ B_i $ が書かれています。 最初、全てのカードは表を向いています。

今ここに $ M $ 台のマシーンがあり、$ 1 $ から $ M $ までの番号が付けられています。 マシーン $ j $ は（相異なるとは限らない）$ 2 $ つの $ 1 $ 以上 $ N $ 以下の整数 $ X_j,Y_j $ を持っており、マシーン $ j $ が起動されると、 $ \frac{1}{2} $ の確率でカード $ X_j $ を、残りの $ \frac{1}{2} $ の確率でカード $ Y_j $ を裏返します。 この確率は各起動ごとに独立です。

すぬけくんは今から以下の操作を順に行います。

1. $ 1 $ 以上 $ M $ 以下の整数からなる集合 $ S $ を選ぶ。
2. $ S $ に含まれる番号のマシーンを、番号が小さい順に $ 1 $ 度ずつ起動する。
 
すぬけくんがうまく $ S $ を選んだとき、「すべての操作が終了した後に各カードが向いている面に書かれた整数の合計」の期待値が最大でいくつになるか求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ M $ $ A_1 $ $ B_1 $ $ \vdots $ $ A_N $ $ B_N $ $ X_1 $ $ Y_1 $ $ \vdots $ $ X_M $ $ Y_M $

## 输出格式

答えを出力せよ。 出力は、真の値との絶対誤差または相対誤差が $ 10^{-6} $ 以下のとき正解と判定される。

## 说明/提示

### 制約

- $ 1\leq\ N\ \leq\ 40 $
- $ 1\leq\ M\ \leq\ 10^5 $
- $ 1\leq\ A_i,B_i\ \leq\ 10^4 $
- $ 1\leq\ X_j,Y_j\ \leq\ N $
- 入力は全て整数
 
### Sample Explanation 1

$ S $ として空集合を選んだ場合、どのマシーンも起動されないので、「すべての操作が終了した後に各カードが向いている面に書かれた整数の合計」の期待値は $ 3+10+5=18 $ です。 $ S $ として $ \lbrace\ 1\ \rbrace $ を選んだ場合、マシーン $ 1 $ が起動され、 - カード $ X_1\ =\ 1 $ が裏返された場合、「すべての操作が終了した後に各カードが向いている面に書かれた整数の合計」は $ 10+10+5=25 $ - カード $ Y_1\ =\ 2 $ が裏返された場合、「すべての操作が終了した後に各カードが向いている面に書かれた整数の合計」は $ 3+6+5=14 $ なので、その期待値は $ \frac{25+14}{2}\ =\ 19.5 $ です。 よって、「すべての操作が終了した後に各カードが向いている面に書かれた整数の合計」の期待値の最大値は $ 19.5 $ です。

### Sample Explanation 2

同じ $ (X_j,Y_j) $ を持つマシーンが複数存在することもあります。

## 样例 #1

### 输入

```
3 1

3 10

10 6

5 2

1 2
```

### 输出

```
19.500000
```

## 样例 #2

### 输入

```
1 3

5 100

1 1

1 1

1 1
```

### 输出

```
100.000000
```

## 样例 #3

### 输入

```
8 10

6918 9211

16 1868

3857 8537

3340 8506

6263 7940

1449 4593

5902 1932

310 6991

4 4

8 6

3 5

1 1

4 2

5 6

7 5

3 3

1 5

3 1
```

### 输出

```
45945.000000
```



---

---
title: "[ABC315Ex] Typical Convolution Problem"
layout: "post"
diff: 省选/NOI-
pid: AT_abc315_h
tag: ['cdq 分治', '快速数论变换 NTT']
---

# [ABC315Ex] Typical Convolution Problem

## 题目描述

给定一个长为 $n$ 的序列 $a$，按如下方法计算 $f(x)$：

- $f(0)=1$;
- 当整数 $m\in[1,n]$ 时，$f(m)=a_m\times (\displaystyle\sum_{i+j\lt m} f(i)\times f(j))$。

对于每个整数 $i\in[1,n]$，计算 $f(i)$ $\bmod$ $998244353$ 的值。

## 输入格式

第一行为序列长度 $n$，第二行输入 $n$ 个整数表示序列 $a$。

## 输出格式

依次输出 $f(1)$，$f(2)$，…，$f(n)$ 对 $998244353$ 取模后的值，相邻两个数之间以单个空格隔开。

## 说明/提示

#### 数据规模与约定

$1\le n\le 2\times 10^5$，$a_i\in[0,998244352]$。

## 样例 #1

### 输入

```
5

1 2 3 4 5
```

### 输出

```
1 6 48 496 6240
```

## 样例 #2

### 输入

```
3

12345 678901 2345678
```

### 输出

```
12345 790834943 85679169
```



---

---
title: "[ABC373G] No Cross Matching"
layout: "post"
diff: 省选/NOI-
pid: AT_abc373_g
tag: ['贪心', '分治', '二分图', '费用流']
---

# [ABC373G] No Cross Matching

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc373/tasks/abc373_g

$ 2 $ 次元平面上に $ P_1,P_2,\ldots,P_N,\ Q_1,Q_2,\ldots,Q_N $ の $ 2N $ 個の点があります。 $ P_i $ の座標は $ (A_i,B_i) $、$ Q_i $ の座標は $ (C_i,D_i) $ です。 同一直線上に異なる $ 3 $ 点が存在することはありません。

$ (1,2,\ldots,N) $ の順列であるような数列 $ R=(R_1,R_2,\ldots,R_N) $ であって以下の条件を満たすような $ R $ が存在するか判定し、存在する場合は $ 1 $ つ求めてください。

- $ 1 $ 以上 $ N $ 以下のすべての整数 $ i $ について 線分 $ i $ を $ P_i $ と $ Q_{R_i} $ を端点とする線分としたとき、どの線分 $ i $ と線分 $ j $ $ (1\ \leq\ i\ <\ j\ \leq\ N) $ も互いに交差しない。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ A_1 $ $ B_1 $ $ A_2 $ $ B_2 $ $ \vdots $ $ A_N $ $ B_N $ $ C_1 $ $ D_1 $ $ C_2 $ $ D_2 $ $ \vdots $ $ C_N $ $ D_N $

## 输出格式

条件を満たす $ R $ が存在しない場合は `-1` と出力せよ。

存在する場合は $ R_1,R_2,\ldots,R_N $ を空白区切りで出力せよ。答えが複数存在する場合はどれを出力してもかまわない。

## 说明/提示

### 制約

- $ 1\ \leq\ N\ \leq\ 300 $
- $ 0\ \leq\ A_i,B_i,C_i,D_i\ \leq\ 5000 $ $ (1\ \leq\ i\ \leq\ N) $
- $ (A_i,B_i)\ \neq\ (A_j,B_j) $ $ (1\ \leq\ i\ <\ j\ \leq\ N) $
- $ (C_i,D_i)\ \neq\ (C_j,D_j) $ $ (1\ \leq\ i\ <\ j\ \leq\ N) $
- $ (A_i,B_i)\ \neq\ (C_j,D_j) $ $ (1\ \leq\ i,j\ \leq\ N) $
- 同一直線上に異なる $ 3 $ 点が存在することはない
- 入力はすべて整数

### Sample Explanation 1

以下の図のように点が並んでいます。 !\[\](https://img.atcoder.jp/abc373/G-sample.png)$ R=(2,1,3) $ とすることで $ 3 $ 本の線分は互いに交差しません。また、 $ R $ を $ (1,2,3),(1,3,2),(2,3,1),(3,1,2) $ のいずれにしても正しい答えとなります。

## 样例 #1

### 输入

```
3
0 0
2 4
4 2
0 2
2 0
4 4
```

### 输出

```
2 1 3
```

## 样例 #2

### 输入

```
8
59 85
60 57
72 12
3 27
16 58
41 94
77 64
97 20
32 37
7 2
57 94
35 70
38 60
97 100
5 76
38 8
```

### 输出

```
3 5 8 2 7 4 6 1
```



---

---
title: "[AGC003D] Anticube"
layout: "post"
diff: 省选/NOI-
pid: AT_agc003_d
tag: ['数论', '素数判断,质数,筛法', '根号分治']
---

# [AGC003D] Anticube

## 题目描述

[problemUrl]: https://atcoder.jp/contests/agc003/tasks/agc003_d

高橋君は誕生日にお母さんから正の整数 $ s_1,...,s_N $ をもらいました。ただし、要素の重複は許されます。 高橋君は、これらの$ N $個の整数のうちのいくつかを丸で囲みます。

高橋君は立方数が嫌いなので、$ s_i,s_j(i\ ≠\ j) $の両方が丸で囲まれているなら、その積$ s_is_j $は立方数とならないようにしたいです。 例えば、$ s_1=1,s_2=1,s_3=2,s_4=4 $のとき、$ s_1 $と$ s_2 $を同時に丸で囲むことはできません。また、$ s_3 $と$ s_4 $を同時に丸で囲むこともできません。

高橋君が丸で囲むことができる整数の個数の最大値を求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ s_1 $ : $ s_N $

## 输出格式

高橋君が丸で囲むことができる整数の個数の最大値を表す整数を出力せよ。

## 说明/提示

### 制約

- $ 1\ ≦\ N\ ≦\ 10^5 $
- $ 1\ ≦\ s_i\ ≦\ 10^{10} $
- 入力はすべて整数である。

### Sample Explanation 1

$ 1,2,3,5,6,7 $ を丸で囲むことができます。

## 样例 #1

### 输入

```
8

1

2

3

4

5

6

7

8
```

### 输出

```
6
```

## 样例 #2

### 输入

```
6

2

4

8

16

32

64
```

### 输出

```
3
```

## 样例 #3

### 输入

```
10

1

10

100

1000000007

10000000000

1000000009

999999999

999

999

999
```

### 输出

```
9
```



---

---
title: "[ARC158E] All Pair Shortest Paths"
layout: "post"
diff: 省选/NOI-
pid: AT_arc158_e
tag: ['分治', '扫描线']
---

# [ARC158E] All Pair Shortest Paths

## 题目描述

[problemUrl]: https://atcoder.jp/contests/arc158/tasks/arc158_e

$ 2 $ 行 $ N $ 列のマス目があります．上から $ i $ 行目，左から $ j $ 列目のマスを $ (i,j) $ で表します．$ (i,j) $ には正整数 $ x_{i,j} $ が書かれています．

$ 2 $ つのマスは，辺を共有するときに**隣接する**といいます．

マス $ X $ から $ Y $ への**パス**とは，相異なるマスからなる列 $ (P_1,\ \ldots,\ P_n) $ であって，$ P_1\ =\ X $, $ P_n\ =\ Y $ であり，任意の $ 1\leq\ i\ \leq\ n-1 $ に対して $ P_i $ と $ P_{i+1} $ が隣接するものをいいます．さらに，そのパスの**重み**を $ P_1,\ \ldots,\ P_n $ に書かれている整数の総和として定義します．

$ 2 $ つのマス $ X,\ Y $ に対して，$ X $ から $ Y $ へのパスの重みとしてありうる最小値を $ f(X,\ Y) $ と書くことにします．すべてのマスの $ 2 $ つ組 $ (X,Y) $ に対する $ f(X,\ Y) $ の総和を $ 998244353 $ で割った余りを求めてください．

## 输入格式

入力は以下の形式で標準入力から与えられます．

> $ N $ $ x_{1,1} $ $ \ldots $ $ x_{1,N} $ $ x_{2,1} $ $ \ldots $ $ x_{2,N} $

## 输出格式

すべてのマスの $ 2 $ つ組 $ (X,Y) $ に対する $ f(X,\ Y) $ の総和を $ 998244353 $ で割った余りを出力してください．

## 说明/提示

### 制約

- $ 1\leq\ N\leq\ 2\times\ 10^5 $
- $ 1\leq\ x_{i,j}\ \leq\ 10^9 $
 
### Sample Explanation 1

次の $ 4 $ 通りの値の総和を求めます． - $ X\ =\ (1,1),\ Y\ =\ (1,1) $ のとき：$ f(X,\ Y)\ =\ 3 $． - $ X\ =\ (1,1),\ Y\ =\ (2,1) $ のとき：$ f(X,\ Y)\ =\ 8 $． - $ X\ =\ (2,1),\ Y\ =\ (1,1) $ のとき：$ f(X,\ Y)\ =\ 8 $． - $ X\ =\ (2,1),\ Y\ =\ (2,1) $ のとき：$ f(X,\ Y)\ =\ 5 $．

## 样例 #1

### 输入

```
1

3

5
```

### 输出

```
24
```

## 样例 #2

### 输入

```
2

1 2

3 4
```

### 输出

```
76
```

## 样例 #3

### 输入

```
5

1 1000000000 1 1 1

1 1 1 1000000000 1
```

### 输出

```
66714886
```



---

---
title: "[ARC159F] Good Division"
layout: "post"
diff: 省选/NOI-
pid: AT_arc159_f
tag: ['动态规划 DP', 'cdq 分治']
---

# [ARC159F] Good Division

## 题目描述

[problemUrl]: https://atcoder.jp/contests/arc159/tasks/arc159_f

数列 $ X $ が次の条件を満たす時、$ X $ を**良い数列**と呼ぶことにします。

- 次の操作を $ 0 $ 回以上繰り返すことで $ X $ を空の列に出来る。
  - $ X $ の隣り合う $ 2 $ 要素 $ x_i,x_{i+1} $ であって $ x_i\ \neq\ x_{i+1} $ を満たすものを選び、削除する。
 
$ 2N $ 要素の数列 $ A=(a_1,\ldots,a_{2N}) $ が与えられます。  
 $ A $ を $ 1 $ 個以上の連続部分列に分割する方法は $ 2^{2N-1} $ 通りありますが、そのうち各連続部分列がすべて良い数列であるようなものが何通りあるかを $ 998244353 $ で割った余りを求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ a_1 $ $ \ldots $ $ a_{2N} $

## 输出格式

答えを出力せよ。

## 说明/提示

### 制約

- $ 1\ \leq\ N\ \leq\ 5\ \times\ 10^5 $
- $ 1\ \leq\ a_i\ \leq\ 2N $
- 入力はすべて整数
 
### Sample Explanation 1

以下の $ 2 $ 通りの分割方法が条件を満たします。 - $ (1,1,2,3,4,5) $ - $ (1,1,2,3),(4,5) $

## 样例 #1

### 输入

```
3

1 1 2 3 4 5
```

### 输出

```
2
```

## 样例 #2

### 输入

```
1

1 2
```

### 输出

```
1
```

## 样例 #3

### 输入

```
1

1 1
```

### 输出

```
0
```

## 样例 #4

### 输入

```
12

4 2 17 12 18 15 17 4 22 6 9 20 21 16 23 16 13 2 20 15 16 3 7 15
```

### 输出

```
2048
```



---

---
title: "[ARC190C] Basic Grid Problem with Updates"
layout: "post"
diff: 省选/NOI-
pid: AT_arc190_c
tag: ['动态规划 DP', '根号分治']
---

# [ARC190C] Basic Grid Problem with Updates

## 题目描述

给定一个 $H \times W$ 的网格。从上往下第 $h$ 行、从左往右第 $w$ 列的单元格记为 $(h, w)$，其中存储了一个非负整数 $A_{h,w}$。  

高桥君初始位于单元格 $(sh, sw)$，接下来将进行 $Q$ 次修改操作。第 $i$ 次修改由字符 $d_i$（取值为 `L`、`R`、`U`、`D` 之一）和非负整数 $a_i$ 描述，具体操作如下：  
- 向 $d_i$ 方向移动 $1$ 格（`L` 为左，`R` 为右，`U` 为上，`D` 为下），将移动后的单元格 $(h, w)$ 中的 $A_{h,w}$ 修改为 $a_i$。  
（保证每次移动操作合法）  

每次修改后，请计算以下问题的答案：  
> 定义**路径** $P = ((h_1, w_1), \ldots, (h_M, w_M))$ 为满足以下条件的单元格序列：  
> - 起点 $(h_1, w_1) = (1, 1)$，终点 $(h_M, w_M) = (H, W)$，且 $M = H + W - 1$  
> - 对于任意 $1 \leq i \leq M-1$，满足 $(h_{i+1}, w_{i+1}) = (h_i + 1, w_i)$ 或 $(h_{i+1}, w_{i+1}) = (h_i, w_i + 1)$  
>  
> 所有可能的路径共有 $\binom{H + W - 2}{H - 1}$ 条。定义 $f(P) = \prod_{1 \leq i \leq M} A_{h_i, w_i}$，求所有路径 $P$ 的 $f(P)$ 之和模 $998244353$ 的结果。  

## 输入格式

输入格式如下：  
> $H$ $W$  
> $A_{1,1}$ $\cdots$ $A_{1,W}$  
> $\vdots$  
> $A_{H,1}$ $\cdots$ $A_{H,W}$  
> $Q$  
> $sh$ $sw$  
> $d_1$ $a_1$  
> $\vdots$  
> $d_Q$ $a_Q$  

## 输出格式

输出 $Q$ 行，每行对应每次修改后的答案。  

## 说明/提示

### 约束条件  
- $2 \leq H, W \leq 2 \times 10^5$  
- $H \cdot W \leq 2 \times 10^5$  
- $0 \leq A_{h,w} < 998244353$  
- $1 \leq Q \leq 2 \times 10^5$  
- $1 \leq sh \leq H$, $1 \leq sw \leq W$  
- $0 \leq a_i < 998244353$  
- 保证每次移动操作合法  

### 样例解释 1  
- 初始时高桥君位于 $(2, 2)$。  
- **第一次操作**（向上移动并修改 $A_{1,2}$ 为 $7$）：  
  - $P=((1,1),(1,2),(1,3),(2,3))$: $f(P) = 1 \times 7 \times 3 \times 6 = 126$  
  - $P=((1,1),(1,2),(2,2),(2,3))$: $f(P) = 1 \times 7 \times 5 \times 6 = 210$  
  - $P=((1,1),(2,1),(2,2),(2,3))$: $f(P) = 1 \times 4 \times 5 \times 6 = 120$  
- **第二次操作**（向右移动并修改 $A_{1,3}$ 为 $8$）：  
  - $P=((1,1),(1,2),(1,3),(2,3))$: $f(P) = 1 \times 7 \times 8 \times 6 = 336$  
  - 其他路径的 $f(P)$ 保持不变（$210$ 和 $120$）。  
- **第三次操作**（向左移动并修改 $A_{1,2}$ 为 $9$）：  
  - $P=((1,1),(1,2),(1,3),(2,3))$: $f(P) = 1 \times 9 \times 8 \times 6 = 432$  
  - $P=((1,1),(1,2),(2,2),(2,3))$: $f(P) = 1 \times 9 \times 5 \times 6 = 270$  
  - $P=((1,1),(2,1),(2,2),(2,3))$: $f(P) = 1 \times 4 \times 5 \times 6 = 120$   

翻译由 DeepSeek R1 完成  

## 样例 #1

### 输入

```
2 3
1 2 3
4 5 6
3 2 2
U 7
R 8
L 9
```

### 输出

```
456
666
822
```

## 样例 #2

### 输入

```
5 4
147015809 294958521 852121867 499798308
790350368 404692331 645419803 290531806
275766153 896286651 239187926 945049742
340760022 236352314 926236110 223464913
287023679 590772036 340282357 521075891
6 3 1
U 344644511
R 45812235
D 260083498
R 781118585
L 156297846
L 411901560
```

### 输出

```
299123226
548055393
810247224
876210800
773990840
506814544
```



---

---
title: "かかし"
layout: "post"
diff: 省选/NOI-
pid: AT_joisc2014_i
tag: ['线段树', '单调队列', 'cdq 分治']
---

# かかし

## 题目描述

[problemUrl]: https://atcoder.jp/contests/joisc2014/tasks/joisc2014_i





---

---
title: "Repeat Strings"
layout: "post"
diff: 省选/NOI-
pid: AT_qupc2018_j
tag: ['差分', '根号分治']
---

# Repeat Strings

## 题目描述

给定一个由字符 `a` 和 `b` 组成的字符串 $S$，你可以依次进行若干次以下操作：

- 从字符串 $S$ 中选择一个连续的区间 $[l, r]$。对于该区间内满足 $l \leq k \leq r$ 的每个位置 $k$，如果 $S_k$ 是 `a`，就将其变为 `b`；如果 $S_k$ 是 `b`，就将其变为 `a`。

接下来，有 $Q$ 个字符串 $T_i$，每个也是由 `a` 和 `b` 构成。将每个 $T_i$ 重复 $10^{100}$ 次，截取长度为 $|S| + 1$ 的前缀，得到一个新的字符串 $T'_i$。

你的任务是，对于每一个字符串 $T'_i$，计算将字符串 $S$ 变为 $T'_i$ 最少需要多少次操作。

## 输入格式

输入以如下格式给出：

> $ S $ $ Q $ $ T_1 $ $ T_2 $ ... $ T_Q $

## 输出格式

输出 $Q$ 行。每行包含一个整数，表示将 $S$ 变为 $T'_i$ 所需的最小操作次数。

## 数据范围

- $1 \leq |S| \leq 2 \times 10^5$
- $1 \leq Q \leq 2 \times 10^5$
- $1 \leq |T_i| \leq 2 \times 10^5$
- 所有 $T_i$ 的长度总和不超过 $2 \times 10^5$
- $S$ 和 $T_i$ 仅包含字符 `a` 和 `b` 

### 示例解释

对于每个 $T'_i$ 的具体表现如下：
- $T'_1 = $ `abababababa`
- $T'_2 = $ `bbbbbbbbbbb`
- $T'_3 = $ `babaabbabab`
- $T'_4 = $ `aaaaaaaaaaa`

例如，将字符串 $S$ 变为 $T'_1$ 需要最少 $2$ 次操作。可以按以下步骤实现：`babaabbabab` → `ababbaababa` → `abababababa`。

 **本翻译由 AI 自动生成**

## 样例 #1

### 输入

```
babaabbabab

4

abab

b

babaabba

aaaaaaaaaaab
```

### 输出

```
2

4

0

5
```



---


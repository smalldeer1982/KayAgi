---
title: "[ABC278G] Generalized Subtraction Game"
layout: "post"
diff: 省选/NOI-
pid: AT_abc278_g
tag: ['博弈论', 'SG 函数']
---

# [ABC278G] Generalized Subtraction Game

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc278/tasks/abc278_g

この問題は **インタラクティブな問題**（あなたの作成したプログラムとジャッジプログラムが標準入出力を介して対話を行う形式の問題）です。

整数 $ N,\ L,\ R $ が与えられます。  
 あなたはジャッジシステムと次のゲームで対戦します。

> $ 1 $ から $ N $ までの番号がついた $ N $ 枚のカードが場に置かれています。  
>  先攻から交互に以下の操作を繰り返します。
> 
> - $ 1\ \leq\ x\ \leq\ N $, $ L\ \leq\ y\ \leq\ R $ かつカード $ x,\ x+1,\ \dots,\ x+y-1 $ の $ y $ 枚がすべて場に存在するような整数の組 $ (x,\ y) $ を 1 つ選び、カード $ x,\ x+1,\ \dots,\ x+y-1 $ を場から取り除く。
>  
> 先に操作が行えなくなった方が負けで、そうでない方が勝ちです。

あなたは先攻か後攻の一方を選んでください。そして、選んだ方の手番でジャッジシステムとゲームをして勝利してください。

### Input &amp; Output Format

この問題はインタラクティブな問題（あなたの作成したプログラムとジャッジプログラムが標準入出力を介して対話を行う形式の問題）です。

最初に、$ N,\ L,\ R $ が以下の形式で入力から与えられるので、これを受け取ってください。

> $ N $ $ L $ $ R $

まず、あなたは一方の手番を選びます。そして、選んだ手番が先攻ならば `First` を、後攻ならば `Second` を出力してください。

その後、あなたは出力した方の手番で、ジャッジシステムがそうでない方の手番でゲームが直ちに開始されます。あなたはゲームが終了するまで入出力を利用してジャッジシステムと対話をして、ゲームに勝利してください。

あなたは手番が回ってきたら、操作で選ぶ整数の組 $ (x,\ y) $ を次の形式で出力してください。ただし、選ぶことのできる $ (x,\ y) $ が存在しない場合は $ (x,\ y)\ =\ (0,\ 0) $ を出力してください。

> $ x $ $ y $

ジャッジシステムの手番では、ジャッジシステムが以下の形式で整数の組 $ (a,\ b) $ を出力します。

> $ a $ $ b $

ここで $ a,\ b $ は次の 3 種類のいずれかであることが保証されます。

- $ (a,\ b)\ =\ (0,\ 0) $ の場合：ジャッジシステムは操作を行えなくなったことを意味します。つまり、あなたはゲームに勝利しました。
- $ (a,\ b)\ =\ (-1,\ -1) $ の場合：あなたは 1 つ前に非合法な $ (x,\ y) $ を選んだか、あるいは $ (0,\ 0) $ を出力したことを意味します。つまり、あなたはゲームに敗北しました。
- それ以外の場合：ジャッジシステムは $ (x,y)\ =\ (a,b) $ として操作を行ったことを意味します。ここでジャッジシステムが選んだ $ (x,\ y) $ は合法であることが保証されます。
 
ジャッジが $ (a,b)=(0,0) $ または $ (a,b)=(-1,-1) $ を返した場合、ゲームはすでに終了しています。この場合、プログラムをただちに終了してください。

## 说明/提示

### 制約

- $ 1\ \leq\ N\ \leq\ 2000 $
- $ 1\ \leq\ L\ \leq\ R\ \leq\ N $
- $ N,\ L,\ R $ は整数
 
### 注意点

- **出力を行うたびに、末尾に改行を入れて標準出力を flush してください。そうしなかった場合、ジャッジ結果が TLE となる可能性があります。**
- **対話の途中で不正な出力を行った、あるいはプログラムが途中で終了した場合のジャッジ結果は不定です。** 特に、プログラムの実行中に実行時エラーが起こった場合に、ジャッジ結果が RE ではなく WA や TLE になる可能性があることに注意してください。
- ゲームが終了したらただちにプログラムを終了してください。そうしない場合、ジャッジ結果は不定です。
 
### 入出力例

以下は、$ N\ =\ 6,\ L\ =\ 1,\ R\ =\ 2 $ の場合の入出力例です。

    入力 出力 説明     `6 1 2`  まず整数 $ N,\ L,\ R $ が与えられます。    `First` 先攻を選び、ゲームを開始します。    `2 1` $ (x,\ y)\ =\ (2,\ 1) $ を選び、カード $ 2 $ を取り除きます。   `3 2`  $ (x,\ y)\ =\ (3,\ 2) $ を選び、カード $ 3,\ 4 $ を取り除きます。    `6 1` $ (x,\ y)\ =\ (6,\ 1) $ を選び、カード $ 6 $ を取り除きます。   `5 1`  $ (x,\ y)\ =\ (5,\ 1) $ を選び、カード $ 5 $ を取り除きます。    `1 1` $ (x,\ y)\ =\ (1,\ 1) $ を選び、カード $ 1 $ を取り除きます。   `0 0`  ジャッジシステムは操作を行うことができなくなったので、あなたの勝ちです。



---

---
title: "[AGC002E] Candy Piles"
layout: "post"
diff: 省选/NOI-
pid: AT_agc002_e
tag: ['模拟', '博弈论', '图论建模', '构造']
---

# [AGC002E] Candy Piles

## 题目描述

[problemUrl]: https://atcoder.jp/contests/agc002/tasks/agc002_e



## 样例 #1

### 输入

```
2
1 3

```

### 输出

```
First
```

## 样例 #2

### 输入

```
3
1 2 1

```

### 输出

```
First
```

## 样例 #3

### 输入

```
3
1 2 3

```

### 输出

```
Second
```



---

---
title: "[AGC005E] Sugigma: The Showdown"
layout: "post"
diff: 省选/NOI-
pid: AT_agc005_e
tag: ['博弈论']
---

# [AGC005E] Sugigma: The Showdown

## 题目描述

[problemUrl]: https://atcoder.jp/contests/agc005/tasks/agc005_e

しぐま君とすぎむ君はゲームをすることにしました。

このゲームは $ N $ 頂点のグラフの上で行います。頂点には $ 1,2,...,N $ と番号がついています。グラフには $ N-1 $ 本の赤い辺と $ N-1 $ 本の青い辺があり、どちらも木となっています。赤い辺は $ (a_i,\ b_i) $ で表し、青い辺は $ (c_i,\ d_i) $ で表します。

二人はそれぞれ駒を $ 1 $ 個ずつ持っており、しぐま君の駒の初期位置は頂点 $ X $、すぎむ君の駒の初期位置は頂点 $ Y $ です。

このゲームはターン制で、ターン $ 1 $, ターン $ 2 $, ターン $ 3 $, ... と進んでいきます。そして、ターン $ 1,\ 3,\ 5,\ ... $ はしぐま君、ターン $ 2,\ 4,\ 6,\ ... $ はすぎむ君の手番です。

二人は自分の手番では、自分の駒を動かすかパスをします。ただし動かせる頂点には制限があり、しぐま君は赤い辺、すぎむ君は青い辺で隣り合った頂点のみに駒を動かせます。

もし二つの駒が同じ頂点に来るとその時点でゲームは終了します。そしてターン $ i $ での操作の後にゲームが終了したならば、$ i $ を総ターン数とします。

しぐま君は総ターン数を出来る限り大きく、すぎむ君は出来る限り小さくしたいです。

二人はこの目的のもとで最適に行動をすると仮定したとき、ゲームは終了するかを判定し、終了する場合は総ターン数はいくつになるか求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ X $ $ Y $ $ a_1 $ $ b_1 $ $ a_2 $ $ b_2 $ : $ a_{N-1} $ $ b_{N-1} $ $ c_1 $ $ d_1 $ $ c_2 $ $ d_2 $ : $ c_{N-1} $ $ d_{N-1} $

## 输出格式

$ 1 $ 行に答えを出力する。 ただし、いつまでもゲームが終了しない場合は `-1` を出力する。

## 说明/提示

### 制約

- $ 2\ ≦\ N\ ≦\ 200,000 $
- $ 1\ ≦\ X,\ Y\ ≦\ N $
- $ X\ \neq\ Y $
- $ 1\ ≦\ a_i,\ b_i,\ c_i,\ d_i\ ≦\ N $
- 赤い辺と青い辺はそれぞれ木である

### Sample Explanation 1

!\[\](https://atcoder.jp/img/agc005/0f55f48518cb9031ee9f1cc30f686228.png)

### Sample Explanation 2

!\[\](https://atcoder.jp/img/agc005/df982a9959ce46d5d5f63800f8972bff.png)

### Sample Explanation 3

!\[\](https://atcoder.jp/img/agc005/11ce9a2283a853025b7075769439d745.png)

## 样例 #1

### 输入

```
4 1 2

1 2

1 3

1 4

2 1

2 3

1 4
```

### 输出

```
4
```

## 样例 #2

### 输入

```
3 3 1

1 2

2 3

1 2

2 3
```

### 输出

```
4
```

## 样例 #3

### 输入

```
4 1 2

1 2

3 4

2 4

1 2

3 4

1 3
```

### 输出

```
2
```

## 样例 #4

### 输入

```
4 2 1

1 2

3 4

2 4

1 2

3 4

1 3
```

### 输出

```
-1
```

## 样例 #5

### 输入

```
5 1 2

1 2

1 3

1 4

4 5

2 1

1 3

1 5

5 4
```

### 输出

```
6
```



---

---
title: "[AGC043C] Giant Graph"
layout: "post"
diff: 省选/NOI-
pid: AT_agc043_c
tag: ['博弈论', 'SG 函数']
---

# [AGC043C] Giant Graph

## 题目描述

[problemUrl]: https://atcoder.jp/contests/agc043/tasks/agc043_c

$ N $ 頂点の、それぞれ $ M_1 $, $ M_2 $, $ M_3 $ 辺の単純な無向グラフ $ X $, $ Y $, $ Z $ が与えられます。 頂点をそれぞれ $ x_1,\ x_2,\ \dots,\ x_N $, $ y_1,\ y_2,\ \dots,\ y_N $, $ z_1,\ z_2,\ \dots,\ z_N $ とします。 $ X $, $ Y $, $ Z $ の辺はそれぞれ $ (x_{a_i},\ x_{b_i}) $, $ (y_{c_i},\ y_{d_i}) $, $ (z_{e_i},\ z_{f_i}) $ です。

$ X,\ Y,\ Z $ を元に $ N^3 $ 頂点の無向グラフ $ W $ を作ります。 $ X,\ Y,\ Z $ から $ 1 $ つずつ頂点を選ぶ方法は $ N^3 $ 通りありますが、これがそれぞれ $ W $ の頂点と一対一に対応します。$ x_i,\ y_j,\ z_k $ を選ぶことに対応する頂点を $ (x_i,\ y_j,\ z_k) $ で表すこととします。

$ W $ の辺を、以下の手順に沿って張ります。

- $ X $ の各辺 $ (x_u,\ x_v) $、及び全ての $ w,\ l $ について、$ (x_u,\ y_w,\ z_l) $, $ (x_v,\ y_w,\ z_l) $ 間に辺を張る
- $ Y $ の各辺 $ (y_u,\ y_v) $、及び全ての $ w,\ l $ について、$ (x_w,\ y_u,\ z_l) $, $ (x_w,\ y_v,\ z_l) $ 間に辺を張る
- $ Z $ の各辺 $ (z_u,\ z_v) $、及び全ての $ w,\ l $ について、$ (x_w,\ y_l,\ z_u) $, $ (x_w,\ y_l,\ z_v) $ 間に辺を張る

そして、$ W $ の頂点 $ (x_i,\ y_j,\ z_k) $ の重みを $ 1,000,000,000,000,000,000^{(i\ +j\ +\ k)}\ =\ 10^{18(i\ +\ j\ +\ k)} $ とします。$ W $ の[独立集合](https://ja.wikipedia.org/wiki/%E7%8B%AC%E7%AB%8B%E9%9B%86%E5%90%88)のうち、頂点の重みの総和の最大値を求めてください。そしてそれを $ 998,244,353 $ で割った余りを出力してください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ M_1 $ $ a_1 $ $ b_1 $ $ a_2 $ $ b_2 $ $ \vdots $ $ a_{M_1} $ $ b_{M_1} $ $ M_2 $ $ c_1 $ $ d_1 $ $ c_2 $ $ d_2 $ $ \vdots $ $ c_{M_2} $ $ d_{M_2} $ $ M_3 $ $ e_1 $ $ f_1 $ $ e_2 $ $ f_2 $ $ \vdots $ $ e_{M_3} $ $ f_{M_3} $

## 输出格式

重みの総和の最大値を $ 998,244,353 $ で割った余りを出力せよ。

## 说明/提示

### 制約

- $ 2\ \leq\ N\ \leq\ 100,000 $
- $ 1\ \leq\ M_1,\ M_2,\ M_3\ \leq\ 100,000 $
- $ 1\ \leq\ a_i,\ b_i,\ c_i,\ d_i,\ e_i,\ f_i\ \leq\ N $
- $ X $, $ Y $, $ Z $ は単純、つまり自己ループや多重辺は存在しない

### Sample Explanation 1

$ (x_2,\ y_1,\ z_1) $, $ (x_1,\ y_2,\ z_1) $, $ (x_1,\ y_1,\ z_2) $, $ (x_2,\ y_2,\ z_2) $ を選ぶ場合が最適です。 答えは $ 3\ \times\ 10^{72}\ +\ 10^{108} $ を $ 998,244,353 $ で割ったあまりの $ 46,494,701 $ です。

## 样例 #1

### 输入

```
2

1

1 2

1

1 2

1

1 2
```

### 输出

```
46494701
```

## 样例 #2

### 输入

```
3

3

1 3

1 2

3 2

2

2 1

2 3

1

2 1
```

### 输出

```
883188316
```

## 样例 #3

### 输入

```
100000

1

1 2

1

99999 100000

1

1 100000
```

### 输出

```
318525248
```



---

---
title: "[ARC155D] Avoid Coprime Game"
layout: "post"
diff: 省选/NOI-
pid: AT_arc155_d
tag: ['博弈论', '莫比乌斯反演', 'SG 函数']
---

# [ARC155D] Avoid Coprime Game

## 题目描述

[problemUrl]: https://atcoder.jp/contests/arc155/tasks/arc155_d

$ 2 $ つの非負整数 $ x,\ y $ に対し $ \gcd(x,y) $ を $ x $ と $ y $ の最大公約数とします（ただし、 $ x=0 $ のときは $ \gcd(x,y)=\gcd(y,x)=y $ とします）。

黒板に $ N $ 個の整数が書かれており、そのうち $ i $ 番目の整数は $ A_i $ です。これら $ N $ 個の整数の最大公約数は $ 1 $ です。

高橋君と青木君が $ 2 $ 人で対戦ゲームをします。整数 $ G $ を $ G=0 $ で初期化した後、$ 2 $ 人は高橋君から始めて交互に以下の操作を繰り返します。

- 黒板に書かれている数のうち、$ \gcd(G,a)\neq\ 1 $ をみたす数 $ a $ を選んで消し、$ G $ を $ \gcd(G,a) $ で置き換える。
 
先に操作を行えなくなったほうが負けです。

各 $ i\ (1\leq\ i\ \leq\ N) $ について、高橋君が最初の手番で $ i $ 番目の整数を選んだ後、両者が最善を尽くした場合、どちらが勝つか判定してください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ A_1 $ $ A_2 $ $ \dots $ $ A_N $

## 输出格式

$ N $ 行出力せよ。$ i $ 行目には高橋君が最初の手番で $ i $ 番目の整数を選んだ後、両者が最善を尽くした場合、高橋君が勝つ場合は `Takahashi` を、青木君が勝つ場合は `Aoki` を出力せよ。

## 说明/提示

### 制約

- $ 2\ \leq\ N\ \leq\ 2\ \times\ 10^5 $
- $ 2\ \leq\ A_i\ \leq\ 2\ \times\ 10^5 $
- $ N $ 個の整数 $ A_i\ (1\leq\ i\ \leq\ N) $ の最大公約数は $ 1 $
- 与えられる入力はすべて整数
 
### Sample Explanation 1

例えば高橋君が最初の手番で $ 4 $ 番目の整数 $ A_4=6 $ を選んだ場合、青木君が $ 2 $ 番目の整数 $ A_2=3 $ を選ぶと $ G=3 $ となります。この後高橋君が選べる整数は存在しないので、青木君の勝利となります。よって $ 4 $ 行目には `Aoki` を出力します。

### Sample Explanation 2

黒板には同じ整数が複数個書かれていることがあります。

## 样例 #1

### 输入

```
4

2 3 4 6
```

### 输出

```
Takahashi

Aoki

Takahashi

Aoki
```

## 样例 #2

### 输入

```
4

2 155 155 155
```

### 输出

```
Takahashi

Takahashi

Takahashi

Takahashi
```

## 样例 #3

### 输入

```
20

2579 25823 32197 55685 73127 73393 74033 95252 104289 114619 139903 144912 147663 149390 155806 169494 175264 181477 189686 196663
```

### 输出

```
Takahashi

Aoki

Takahashi

Aoki

Takahashi

Takahashi

Takahashi

Takahashi

Aoki

Takahashi

Takahashi

Aoki

Aoki

Aoki

Aoki

Aoki

Takahashi

Takahashi

Aoki

Takahashi
```



---


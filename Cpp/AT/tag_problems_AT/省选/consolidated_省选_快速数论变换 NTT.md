---
title: "[ABC315Ex] Typical Convolution Problem"
layout: "post"
diff: 省选/NOI-
pid: AT_abc315_h
tag: ['cdq 分治', '快速数论变换 NTT']
---

# [ABC315Ex] Typical Convolution Problem

## 题目描述

给定一个长为 $n$ 的序列 $a$，按如下方法计算 $f(x)$：

- $f(0)=1$;
- 当整数 $m\in[1,n]$ 时，$f(m)=a_m\times (\displaystyle\sum_{i+j\lt m} f(i)\times f(j))$。

对于每个整数 $i\in[1,n]$，计算 $f(i)$ $\bmod$ $998244353$ 的值。

## 输入格式

第一行为序列长度 $n$，第二行输入 $n$ 个整数表示序列 $a$。

## 输出格式

依次输出 $f(1)$，$f(2)$，…，$f(n)$ 对 $998244353$ 取模后的值，相邻两个数之间以单个空格隔开。

## 说明/提示

#### 数据规模与约定

$1\le n\le 2\times 10^5$，$a_i\in[0,998244352]$。

## 样例 #1

### 输入

```
5

1 2 3 4 5
```

### 输出

```
1 6 48 496 6240
```

## 样例 #2

### 输入

```
3

12345 678901 2345678
```

### 输出

```
12345 790834943 85679169
```



---

---
title: "[ABC352G] Socks 3"
layout: "post"
diff: 省选/NOI-
pid: AT_abc352_g
tag: ['快速数论变换 NTT']
---

# [ABC352G] Socks 3

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc352/tasks/abc352_g

高橋君のタンスの中には様々な色の靴下が入っています。 靴下の色は $ 1 $ 以上 $ N $ 以下の整数として表され、色 $ i $ の靴下は $ A_i\ (\geq\ 2) $ 枚入っています。

高橋君は、以下の操作を行うことで今日履く靴下を選ぼうとしています。

- 今までに取り出した靴下の中で同じ色の靴下の $ 2 $ 枚組が作れるようになるまで、タンスの中からランダムに等確率で $ 1 $ 枚の靴下を取り出すことを繰り返す。 なお、一度取り出した靴下はタンスの中には戻さない。

高橋君がタンスから靴下を取り出す回数の期待値を $ \text{mod\ }\ 998244353 $ で求めてください。

期待値を $ \text{mod\ }\ 998244353 $ で求めるとは求める期待値は必ず有理数になることが証明できます。 また、この問題の制約下では、期待値を既約分数 $ \frac{y}{x} $ で表したときに $ x $ が $ 998244353 $ で割り切れないことが保証されます。 このとき $ xz\ \equiv\ y\ \pmod{998244353} $ を満たすような $ 0 $ 以上 $ 998244352 $ 以下の整数 $ z $ が一意に定まるので、この $ z $ を求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ A_1 $ $ A_2 $ $ \dots $ $ A_N $

## 输出格式

答えを出力せよ。

## 说明/提示

### 制約

- $ 1\leq\ N\ \leq\ 3\times\ 10^5 $
- $ 2\leq\ A_i\ \leq\ 3000 $
- 入力は全て整数

### Sample Explanation 1

例えば、以下のように操作を行うことが考えられます。 1. タンスの中から色 $ 1 $ の靴下を $ 1 $ 枚取り出す。タンスの中には色 $ 1 $ の靴下が $ 1 $ 枚と色 $ 2 $ の靴下が $ 2 $ 枚残っている。 2. タンスの中から色 $ 2 $ の靴下を $ 1 $ 枚取り出す。タンスの中には色 $ 1,2 $ の靴下が $ 1 $ 枚ずつ残っている。 3. タンスの中から色 $ 1 $ の靴下を $ 1 $ 枚取り出す。今までに取り出した靴下は色 $ 1 $ の靴下が $ 2 $ 枚と色 $ 2 $ の靴下が $ 1 $ 枚であり、この中で色 $ 1 $ の靴下の $ 2 $ 枚組が作れるので操作を終了する。 この例の場合、高橋君がタンスから靴下を取り出す回数は $ 3 $ 回です。 高橋君がタンスから靴下を取り出す回数は $ \frac{2}{3} $ の確率で $ 3 $ 回、$ \frac{1}{3} $ の確率で $ 2 $ 回なので、求める期待値は $ 3\times\ \frac{2}{3}\ +\ 2\times\ \frac{1}{3}\ =\ \frac{8}{3}\ \equiv\ 665496238\ \pmod\ {998244353} $ です。

## 样例 #1

### 输入

```
2
2 2
```

### 输出

```
665496238
```

## 样例 #2

### 输入

```
1
352
```

### 输出

```
2
```

## 样例 #3

### 输入

```
6
1796 905 2768 253 2713 1448
```

### 输出

```
887165507
```



---

---
title: "[ABC392G] Fine Triplets"
layout: "post"
diff: 省选/NOI-
pid: AT_abc392_g
tag: ['多项式', '快速傅里叶变换 FFT', '快速数论变换 NTT']
---

# [ABC392G] Fine Triplets

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc392/tasks/abc392_g

当三个整数 $A,B,C$（满足 $A < B < C$）满足 $B - A = C - B$ 时，称 $(A,B,C)$ 为**好的三元组**。  
给定一个包含 $N$ 个元素的正整数集合 $S = \{\ S_1, S_2, \dots, S_N\ \}$，求满足 $A,B,C \in S$ 的好的三元组的个数。

## 输入格式

输入通过标准输入给出，格式如下：

> $N$  
$S_1$ $S_2$ $\dots$ $S_N$

## 输出格式

输出答案作为整数。

## 说明/提示

### 约束条件

- 输入均为整数
- $1 \leq N \leq 10^6$
- $1 \leq S_i \leq 10^6$
- $S$ 中的元素互不相同

### 样例解释 1

$S = \{8,3,1,5,2\}$。符合条件的好的三元组有以下 $3$ 个：
- $(1,2,3)$
- $(1,3,5)$
- $(2,5,8)$

翻译由 DeepSeek R1 完成

## 样例 #1

### 输入

```
5
8 3 1 5 2
```

### 输出

```
3
```

## 样例 #2

### 输入

```
7
300000 100000 499998 499999 200000 400000 500000
```

### 输出

```
5
```

## 样例 #3

### 输入

```
10
13 1 16 15 12 4 7 10 2 19
```

### 输出

```
10
```



---

---
title: "[ARC185C] Sum of Three Integers"
layout: "post"
diff: 省选/NOI-
pid: AT_arc185_c
tag: ['多项式', '快速傅里叶变换 FFT', '快速数论变换 NTT']
---

# [ARC185C] Sum of Three Integers

## 题目描述

[problemUrl]: https://atcoder.jp/contests/arc185/tasks/arc185_c

整数列 $ A\ =\ (A_1,\ A_2,\ \dots,\ A_N) $ および整数 $ X $ が与えられます。  
 次の条件を全て満たす整数の組 $ (i,\ j,\ k) $ を $ 1 $ 組出力してください。条件を満たす組が存在しない場合はそのことを報告してください。

- $ 1\ \leq\ i\ \lt\ j\ \lt\ k\ \leq\ N $
- $ A_i\ +\ A_j\ +\ A_k\ =\ X $

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ X $ $ A_1 $ $ A_2 $ $ \dots $ $ A_N $

## 输出格式

条件を満たす整数の組 $ (i,\ j,\ k) $ が存在する場合、以下の形式で出力せよ。答えが複数ある場合はどれを出力しても良い。

> $ i $ $ j $ $ k $

条件を満たす整数の組が存在しない場合、`-1` を出力せよ。

## 说明/提示

### 制約

- $ 3\ \leq\ N\ \leq\ 10^6 $
- $ 1\ \leq\ X\ \leq\ 10^6 $
- $ 1\ \leq\ A_i\ \leq\ X $
- 入力される値は全て整数
 
### Sample Explanation 1

$ (i,\ j,\ k)\ =\ (1,\ 3,\ 4) $ は $ 1\ \leq\ i\ \lt\ j\ \lt\ k\ \leq\ N $ かつ $ A_i\ +\ A_j\ +\ A_k\ =\ 1\ +\ 5\ +\ 10\ =\ 16\ =\ X $ を満たします。

## 样例 #1

### 输入

```
5 16

1 8 5 10 13
```

### 输出

```
1 3 4
```

## 样例 #2

### 输入

```
5 20

1 8 5 10 13
```

### 输出

```
-1
```

## 样例 #3

### 输入

```
10 100000

73766 47718 74148 49218 76721 31902 21994 18880 29598 98917
```

### 输出

```
4 6 8
```



---


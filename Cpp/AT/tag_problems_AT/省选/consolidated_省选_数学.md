---
title: "[ABC180F] Unbranched"
layout: "post"
diff: 省选/NOI-
pid: AT_abc180_f
tag: ['动态规划 DP', '组合数学', '差分']
---

# [ABC180F] Unbranched

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc180/tasks/abc180_f

頂点にラベルが付き辺にはラベルが付いていない $ N $ 頂点 $ M $ 辺の単純とも連結とも限らないグラフであって、以下の条件を満たすものの個数を $ 10^9+7 $ で割ったあまりを求めてください。

- 自己ループを持たない
- すべての頂点の次数が $ 2 $ 以下である
- 各連結成分のサイズを並べたとき、その最大値がちょうど $ L $ である

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ M $ $ L $

## 输出格式

答えを出力せよ。

## 说明/提示

### 制約

- $ 2\ \leq\ N\ \leq\ 300 $
- $ 1\leq\ M\ \leq\ N $
- $ 1\ \leq\ L\ \leq\ N $
- 入力はすべて整数

### Sample Explanation 1

頂点に $ 1 $ から $ N $ の番号を付けたとき、以下の $ 3 $ 通りのグラフが条件を満たします。 - $ 1-2 $ 間と $ 2-3 $ 間に辺がある。 - $ 1-2 $ 間と $ 1-3 $ 間に辺がある。 - $ 1-3 $ 間と $ 2-3 $ 間に辺がある。

## 样例 #1

### 输入

```
3 2 3
```

### 输出

```
3
```

## 样例 #2

### 输入

```
4 3 2
```

### 输出

```
6
```

## 样例 #3

### 输入

```
300 290 140
```

### 输出

```
211917445
```



---

---
title: "[ABC273G] Row Column Sums 2"
layout: "post"
diff: 省选/NOI-
pid: AT_abc273_g
tag: ['动态规划 DP', '组合数学']
---

# [ABC273G] Row Column Sums 2

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc273/tasks/abc273_g

非負整数を要素とする $ N $ 次正方行列であって、下記の $ 2 $ つの条件をともに満たすものの個数を $ 998244353 $ で割ったあまりを出力してください。

- すべての $ i\ =\ 1,\ 2,\ \ldots,\ N $ について、$ i $ 行目の要素の和は $ R_i $ である。
- すべての $ i\ =\ 1,\ 2,\ \ldots,\ N $ について、$ i $ 列目の要素の和は $ C_i $ である。

入力で与えられる $ R_i $ および $ C_i $ は $ 0 $ 以上 $ 2 $ 以下の整数であることに注意してください（制約参照）。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ R_1 $ $ R_2 $ $ \ldots $ $ R_N $ $ C_1 $ $ C_2 $ $ \ldots $ $ C_N $

## 输出格式

答えを出力せよ。

## 说明/提示

### 制約

- $ 1\ \leq\ N\ \leq\ 5000 $
- $ 0\ \leq\ R_i\ \leq\ 2 $
- $ 0\ \leq\ C_i\ \leq\ 2 $
- 入力はすべて整数

### Sample Explanation 1

条件を満たす行列は下記の $ 3 $ つです。 ``` 0 1 0 0 0 1 0 0 1 ``` ``` 0 0 1 0 1 0 0 0 1 ``` ``` 0 0 1 0 0 1 0 1 0 ```

### Sample Explanation 3

$ 998244353 $ で割ったあまりを出力することに注意してください。

## 样例 #1

### 输入

```
3

1 1 1

0 1 2
```

### 输出

```
3
```

## 样例 #2

### 输入

```
3

1 1 1

2 2 2
```

### 输出

```
0
```

## 样例 #3

### 输入

```
18

2 0 1 2 0 1 1 2 1 1 2 0 1 2 2 1 0 0

1 1 0 1 1 1 1 1 1 1 1 1 2 1 1 0 2 2
```

### 输出

```
968235177
```



---

---
title: "[ABC354G] Select Strings"
layout: "post"
diff: 省选/NOI-
pid: AT_abc354_g
tag: ['网络流', '数学']
---

# [ABC354G] Select Strings

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc354/tasks/abc354_g

$ N $ 個の英小文字からなる文字列 $ S_1,S_2,\ldots,S_N $ と $ N $ 個の正整数 $ A_1,A_2,\ldots,A_N $ があります。

ある $ \lbrace\ 1,2,\ldots,N\ \rbrace $ の部分集合 $ T $ は $ i,j\ \in\ T\ (i\ \neq\ j) $ で $ S_i $ が $ S_j $ の部分文字列となるような $ i,j $ の組がないとき**良い集合**であるといいます。

良い集合 $ T $ を選んだ時 $ \displaystyle\ \sum_{i\ \in\ T}\ A_i $ としてありえる値の最大値を求めてください。

 部分文字列とは？ $ S $ の**部分文字列**とは、$ S $ の先頭から $ 0 $ 文字以上、末尾から $ 0 $ 文字以上削除して得られる文字列のことをいいます。 例えば、`ab` は `abc` の部分文字列ですが、`ac` は `abc` の部分文字列ではありません。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ S_1 $ $ S_2 $ $ \vdots $ $ S_N $ $ A_1 $ $ A_2 $ $ \ldots $ $ A_N $

## 输出格式

答えを出力せよ。

## 说明/提示

### 制約

- $ 1\ \leq\ N\ \leq\ 100 $
- $ S_i $ は英小文字からなる文字列である
- $ 1\ \leq\ |S_i| $
- $ |S_1|+|S_2|\ +\ \ldots\ +\ |S_N|\ \leq\ 5000 $
- $ 1\ \leq\ A_i\ \leq\ 10^9 $
 
### Sample Explanation 1

良い集合 としてありえる $ T $ とそれぞれに対する $ \displaystyle\ \sum_{i\ \in\ T}\ A_i $ は以下の通りです。 - $ T\ =\ \lbrace\ 1\ \rbrace $ のとき $ \displaystyle\ \sum_{i\ \in\ T}\ A_i\ =\ 5 $ - $ T\ =\ \lbrace\ 2\ \rbrace $ のとき $ \displaystyle\ \sum_{i\ \in\ T}\ A_i\ =\ 2 $ - $ T\ =\ \lbrace\ 3\ \rbrace $ のとき $ \displaystyle\ \sum_{i\ \in\ T}\ A_i\ =\ 3 $ - $ T\ =\ \lbrace\ 4\ \rbrace $ のとき $ \displaystyle\ \sum_{i\ \in\ T}\ A_i\ =\ 4 $ - $ T\ =\ \lbrace\ 2,3\ \rbrace $ のとき $ \displaystyle\ \sum_{i\ \in\ T}\ A_i\ =\ 5 $ - $ T\ =\ \lbrace\ 2,4\ \rbrace $ のとき $ \displaystyle\ \sum_{i\ \in\ T}\ A_i\ =\ 6 $ このうち最大値は $ 6 $ なので、$ 6 $ を出力します。

## 样例 #1

### 输入

```
4

atcoder

at

coder

code

5 2 3 4
```

### 输出

```
6
```

## 样例 #2

### 输入

```
10

abcd

abc

ab

a

b

c

d

ab

bc

cd

100 10 50 30 60 90 80 70 40 20
```

### 输出

```
260
```



---

---
title: "[ABC405G] Range Shuffle Query"
layout: "post"
diff: 省选/NOI-
pid: AT_abc405_g
tag: ['数学', '莫队', '分块']
---

# [ABC405G] Range Shuffle Query

## 题目描述

给你一个长为 $N$ 的数列 $A=(A_1,A_2,\cdots,A_N)$，你要回答 $Q$ 个询问。

每个询问有三个参数 $(L_i,R_i,X_i)$，你需要回答：

令 $B=(A_{L_i},A_{L_i+1},\cdots,A_{R_i})$，删除 $B$ 中 $\ge X_i$ 的所有元素后，通过重新排列 $B$ 的元素可以形成多少种不同的 $B$？

答案对 $998244353$ 取模。

## 输入格式

第一行两个整数 $N,Q(1\le N,Q\le 2.5\times 10^5)$。\
第二行 $N$ 个整数 $A_1,A_2,\cdots,A_N(1\le A_i\le N)$。\
之后 $Q$ 行，每行三个整数 $L_i,R_i,X_i(1\le L_i\le R_i\le N,1\le X_i\le N)$，表示一次询问。

## 输出格式

输出 $Q$ 行，每行一个整数，依次回答每个询问，答案对 $998244353$ 取模。

## 说明/提示

**样例 1 解释**

对于第一个询问，$B$ 的三种可能分别为：$B=(1,1,2),B=(1,2,1),B=(2,1,1)$。\
对于第二个询问，$B$ 的唯一可能为空串。

By @[chenxi2009](/user/1020063)

## 样例 #1

### 输入

```
5 3
1 2 3 3 1
1 5 3
3 4 1
1 3 4
```

### 输出

```
3
1
6
```

## 样例 #2

### 输入

```
8 6
6 2 4 1 5 1 8 6
5 6 3
1 5 7
1 4 6
4 7 8
4 8 2
5 8 6
```

### 输出

```
1
120
6
3
1
2
```



---

---
title: "[AGC034C] Tests"
layout: "post"
diff: 省选/NOI-
pid: AT_agc034_c
tag: ['数学', '贪心', '二分']
---

# [AGC034C] Tests

## 题目描述

[problemUrl]: https://atcoder.jp/contests/agc034/tasks/agc034_c

高橋くんと青木くんは $ 1 $ から $ N $ までの番号がついたテストを受けようとしています。 二人はこのテストの結果を使って勝負することにしました。 具体的には、次のようにして勝敗を決めます。

- 高橋くんが各テスト $ i $ について、その重要度 $ c_i $ を決める。ただしこの値は $ l_i $ 以上 $ u_i $ 以下の整数である必要がある。
- $ \sum_{i=1}^{N}\ c_i\ \times $ (高橋くんのテスト $ i $ の点数) を $ A $, $ \ $ $ \sum_{i=1}^{N}\ c_i\ \times $ (青木くんのテスト $ i $ の点数) を $ B $ とする。 $ A\ \geq\ B $ なら高橋くんの勝ち、$ A\ <\ B $ なら青木くんの勝ち。

高橋くんはエスパーなので、青木くんがテスト $ i $ で $ b_i $ 点をとることがわかっています。

高橋くんはこのままだとすべてのテストで $ 0 $ 点をとってしまいますが、 $ 1 $ 時間勉強するごとに、好きなテストの点数を $ 1 $ だけ上げることができます。($ 1 $ 時間単位でしか勉強できません。) ただしテストはすべて **$ X $ 点満点**なので、 $ X $ より大きい点数にすることはできません。

高橋くんが勝つために必要な最小の勉強時間を出力してください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ X $ $ b_1 $ $ l_1 $ $ u_1 $ $ b_2 $ $ l_2 $ $ u_2 $ $ : $ $ b_N $ $ l_N $ $ u_N $

## 输出格式

高橋くんが勝つために必要な最小の勉強時間を出力せよ。

## 说明/提示

### 制約

- $ 1\ ≦\ N\ ≦\ 10^5 $
- $ 1\ ≦\ X\ ≦\ 10^5 $
- $ 0\ ≦\ b_i\ ≦\ X $ $ (1\ \leq\ i\ \leq\ N) $
- $ 1\ ≦\ l_i\ ≦\ u_i\ ≦\ 10^5 $ $ (1\ \leq\ i\ \leq\ N) $
- 入力はすべて整数

### Sample Explanation 1

例えば次のようにするのが最適です。 - $ c_1\ =\ 3,\ c_2\ =\ 1 $ とする。 - テスト $ 1 $ で $ 100 $ 点、テスト $ 2 $ で $ 15 $ 点とるように勉強する。 このとき $ A\ =\ 3\ \times\ 100\ +\ 1\ \times\ 15\ =\ 315 $, $ B\ =\ 3\ \times\ 85\ +\ 1\ \times\ 60\ =\ 315 $ なので高橋くんが勝ちます。

## 样例 #1

### 输入

```
2 100

85 2 3

60 1 1
```

### 输出

```
115
```

## 样例 #2

### 输入

```
2 100

85 2 3

60 10 10
```

### 输出

```
77
```

## 样例 #3

### 输入

```
1 100000

31415 2718 2818
```

### 输出

```
31415
```

## 样例 #4

### 输入

```
10 1000

451 4593 6263

324 310 6991

378 1431 7068

71 1757 9218

204 3676 4328

840 6221 9080

684 1545 8511

709 5467 8674

862 6504 9835

283 4965 9980
```

### 输出

```
2540
```



---

---
title: "[AGC038C] LCMs"
layout: "post"
diff: 省选/NOI-
pid: AT_agc038_c
tag: ['数学', '莫比乌斯反演']
---

# [AGC038C] LCMs

## 题目描述

[problemUrl]: https://atcoder.jp/contests/agc038/tasks/agc038_c

長さ $ N $ の整数列 $ A_0,A_1,\cdots,A_{N-1} $ があります。 次式の値を求めてください。

- $ \sum_{i=0}^{N-2}\ \sum_{j=i+1}^{N-1}\ \mathrm{lcm}(A_i,A_j) $

ここで、$ \mathrm{lcm}(x,y) $ は、$ x $ と $ y $ の最小公倍数を意味します。 なお、答えは非常に大きくなることがあるので、$ 998244353 $ で割ったあまりを求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ A_0\ A_1\ \cdots\ A_{N-1} $

## 输出格式

$ \sum_{i=0}^{N-2}\ \sum_{j=i+1}^{N-1}\ \mathrm{lcm}(A_i,A_j) $ の値を $ 998244353 $ で割ったあまりを出力せよ。

## 说明/提示

### 制約

- $ 1\ \leq\ N\ \leq\ 200000 $
- $ 1\ \leq\ A_i\ \leq\ 1000000 $
- 入力される値はすべて整数である。

### Sample Explanation 1

$ \mathrm{lcm}(2,4)+\mathrm{lcm}(2,6)+\mathrm{lcm}(4,6)=4+6+12=22 $ です。

## 样例 #1

### 输入

```
3

2 4 6
```

### 输出

```
22
```

## 样例 #2

### 输入

```
8

1 2 3 4 6 8 12 12
```

### 输出

```
313
```

## 样例 #3

### 输入

```
10

356822 296174 484500 710640 518322 888250 259161 609120 592348 713644
```

### 输出

```
353891724
```



---

---
title: "[AGC039D] Incenters"
layout: "post"
diff: 省选/NOI-
pid: AT_agc039_d
tag: ['数学', '期望']
---

# [AGC039D] Incenters

## 题目描述

[problemUrl]: https://atcoder.jp/contests/agc039/tasks/agc039_d

$ xy $ 平面上の点 $ (0,0) $ を中心とする円周上に $ N $ 個の点が与えられます。 $ i $ 個目の点の座標は $ (\cos(\frac{2\pi\ T_i}{L}),\sin(\frac{2\pi\ T_i}{L})) $ です。

これら $ N $ 個の点の中から相異なる $ 3 $ 点を一様ランダムに選ぶとき、 選んだ $ 3 $ 点を結んでできる三角形の内接円の中心の $ x $ 座標、$ y $ 座標の期待値をそれぞれ求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ L $ $ T_1 $ $ : $ $ T_N $

## 输出格式

選んだ $ 3 $ 点を結んでできる三角形の内接円の中心の $ x $ 座標、$ y $ 座標の期待値をそれぞれ出力せよ。 絶対誤差あるいは相対誤差が $ 10^{-9} $ 以下のとき正答と判定される。

## 说明/提示

### 制約

- $ 3\ \leq\ N\ \leq\ 3000 $
- $ N\ \leq\ L\ \leq\ 10^9 $
- $ 0\ \leq\ T_i\ \leq\ L-1 $
- $ T_i\ <\ T_{i+1} $
- 入力はすべて整数である

### Sample Explanation 1

$ 3 $ 点の座標は $ (1,0) $, $ (0,1) $, $ (0,-1) $ であり、この $ 3 $ 点を結んでできる三角形の内接円の中心の座標は $ (\sqrt{2}-1,0) $ です。

## 样例 #1

### 输入

```
3 4

0

1

3
```

### 输出

```
0.414213562373095 -0.000000000000000
```

## 样例 #2

### 输入

```
4 8

1

3

5

6
```

### 输出

```
-0.229401949926902 -0.153281482438188
```

## 样例 #3

### 输入

```
10 100

2

11

35

42

54

69

89

91

93

99
```

### 输出

```
0.352886583546338 -0.109065017701873
```



---

---
title: "[AGC045B] 01 Unbalanced"
layout: "post"
diff: 省选/NOI-
pid: AT_agc045_b
tag: ['数学', '贪心', '前缀和']
---

# [AGC045B] 01 Unbalanced

## 题目描述

[problemUrl]: https://atcoder.jp/contests/agc045/tasks/agc045_b

文字列 $ S $ が与えられます． $ S $ の各文字は，`0`,`1`,`?` のいずれかです．

$ S $ に含まれる全ての `?` を `0` か `1` に変えて（`?` ごとに変換後の文字を選択できます），文字列 $ S' $ を作ることを考えます． ここで，$ S' $ のアンバランス度を，次のように定義します．

- $ S' $ のアンバランス度 $ =\ \max\ \{\ S' $ の $ l $ 文字目から $ r $ 文字目までに含まれる `0` の個数と `1` の個数の差の絶対値 $ :\ 1\ \leq\ l\ \leq\ r\ \leq\ |S|\} $

$ S' $ のアンバランス度としてありうる最小の値を求めてください．

## 输入格式

入力は以下の形式で標準入力から与えられる．

> $ S $

## 输出格式

$ S' $ のアンバランス度としてありうる最小の値を出力せよ．

## 说明/提示

### 制約

- $ 1\ \leq\ |S|\ \leq\ 10^6 $
- $ S $ の各文字は `0`,`1`,`?` のいずれかである．

### Sample Explanation 1

$ S'= $`010` とすれば，アンバランス度は $ 1 $ になり，これが最小です．

## 样例 #1

### 输入

```
0??
```

### 输出

```
1
```

## 样例 #2

### 输入

```
0??0
```

### 输出

```
2
```

## 样例 #3

### 输入

```
??00????0??0????0?0??00??1???11?1?1???1?11?111???1
```

### 输出

```
4
```



---

---
title: "[AGC055C] Weird LIS"
layout: "post"
diff: 省选/NOI-
pid: AT_agc055_c
tag: ['动态规划 DP', '数学', '排列组合']
---

# [AGC055C] Weird LIS

## 题目描述

[problemUrl]: https://atcoder.jp/contests/agc055/tasks/agc055_c

整数 $ N,\ M $ が与えられます。次の条件を満たす長さ $ N $ の列 $ A=[A_1,\ A_2,\ \ldots,\ A_N] $ の個数を求めてください。

- $ 2\ \le\ A_i\ \le\ M $ ($ 1\ \leq\ i\ \leq\ N $)
- $ 1 $ から $ N $ までの整数の順列 $ P=[P_1,P_2,\ldots,P_N] $ であって次の性質を持つものが存在する。
  - $ 1 $ から $ N $ までの各 $ i $ について、$ A_i $ は列 $ [P_1,\ P_2,\ \ldots,\ P_{i-1},\ P_{i+1},\ \ldots,\ P_{N-1},\ P_N] $ の最長増加部分列の長さに等しい。

この個数は非常に大きい可能性があるため、これを素数 $ Q $ で割った余りを出力してください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ M $ $ Q $

## 输出格式

答えを $ Q $ で割った余りを出力せよ。

## 说明/提示

### 制約

- $ 3\ \le\ N\ \le\ 5000 $
- $ 2\ \le\ M\ \le\ N-1 $
- $ 10^8\ \le\ Q\ \le\ 10^9 $
- $ Q $ は素数である。

### Sample Explanation 1

このような列は $ [2,\ 2,\ 2] $ のみです。ここで $ [1,\ 2,\ 3] $ という順列が存在して性質を満たします。

### Sample Explanation 2

このような列は次の $ 9 $ 個です: $ [2,\ 2,\ 2,\ 2] $, $ [2,\ 2,\ 2,\ 3] $, $ [2,\ 2,\ 3,\ 2] $, $ [2,\ 2,\ 3,\ 3] $, $ [2,\ 3,\ 2,\ 2] $, $ [2,\ 3,\ 3,\ 2] $, $ [3,\ 2,\ 2,\ 2] $, $ [3,\ 3,\ 2,\ 2] $, $ [3,\ 3,\ 3,\ 3] $。

### Sample Explanation 3

このような列は $ [2,\ 2,\ 2,\ 2,\ 2] $ のみです。

## 样例 #1

### 输入

```
3 2 686926217
```

### 输出

```
1
```

## 样例 #2

### 输入

```
4 3 354817471
```

### 输出

```
9
```

## 样例 #3

### 输入

```
5 2 829412599
```

### 输出

```
1
```

## 样例 #4

### 输入

```
5 3 975576997
```

### 输出

```
23
```

## 样例 #5

### 输入

```
69 42 925171057
```

### 输出

```
801835311
```



---

---
title: "[AGC060C] Large Heap"
layout: "post"
diff: 省选/NOI-
pid: AT_agc060_c
tag: ['动态规划 DP', '组合数学', '排列组合', '概率论']
---

# [AGC060C] Large Heap

## 题目描述

[problemUrl]: https://atcoder.jp/contests/agc060/tasks/agc060_c

$ (1,2,\cdots,2^N-1) $ の順列 $ P=(P_1,P_2,\cdots,P_{2^N-1}) $ を考えます． $ P $ が以下の条件をすべて満たすとき，それを**ヒープ的**な順列と呼ぶことにします．

- $ P_i\ <\ P_{2i} $ ($ 1\ \leq\ i\ \leq\ 2^{N-1}-1 $)
- $ P_i\ <\ P_{2i+1} $ ($ 1\ \leq\ i\ \leq\ 2^{N-1}-1 $)
 
整数 $ A,B $ が与えられます． $ U=2^A,\ V=2^{B+1}-1 $ とします．

ヒープ的な順列を一様ランダムに $ 1 $ つ選んだ際，$ P_U\ <\ P_V $ である確率を $ \text{mod\ }998244353 $ で求めてください．

確率 $ \text{mod\ }{998244353} $ の定義求める確率は必ず有理数になることが証明できます。 また、この問題の制約のもとでは、求める有理数を既約分数 $ \frac{P}{Q} $ で表した時、$ Q\ \neq\ 0\ \pmod{998244353} $ となることが証明できます。 よって、$ R\ \times\ Q\ \equiv\ P\ \pmod{998244353},\ 0\ \leq\ R\ \lt\ 998244353 $ を満たす整数 $ R $ が一意に定まります。 この $ R $ を答えてください。

## 输入格式

入力は以下の形式で標準入力から与えられる．

> $ N $ $ A $ $ B $

## 输出格式

答えを出力せよ．

## 说明/提示

### 制約

- $ 2\ \leq\ N\ \leq\ 5000 $
- $ 1\ \leq\ A,B\ \leq\ N-1 $
- 入力される数はすべて整数
 
### Sample Explanation 1

ヒープ的な順列は，$ P=(1,2,3),(1,3,2) $ の $ 2 $ つです． $ P_2\ <\ P_3 $ となる確率は $ 1/2 $ です．

## 样例 #1

### 输入

```
2 1 1
```

### 输出

```
499122177
```

## 样例 #2

### 输入

```
3 1 2
```

### 输出

```
124780545
```

## 样例 #3

### 输入

```
4 3 2
```

### 输出

```
260479386
```

## 样例 #4

### 输入

```
2022 12 25
```

### 输出

```
741532295
```



---

---
title: "[AGC065C] Avoid Half Sum"
layout: "post"
diff: 省选/NOI-
pid: AT_agc065_c
tag: ['数学', '构造', 'Ad-hoc']
---

# [AGC065C] Avoid Half Sum

## 题目描述

[problemUrl]: https://atcoder.jp/contests/agc065/tasks/agc065_c

長さ $ N $ の非負整数列 $ A=(A_1,A_2,\dots,A_N) $ が与えられます。ここで、 $ S=\sum_{i=1}^{N}\ A_i $ は偶数です。

以下の条件を満たす長さ $ N $ の非負整数列の組 $ B=(B_1,B_2,\dots,B_N),\ C=(C_1,C_2,\dots,C_N) $ が存在するか判定してください。

- $ i=1,2,\dots,N $ に対し $ B_i+C_i=A_i $ が成り立つ
- $ i=1,2,\dots,N $ に対し $ X_i=B_i $ または $ X_i=C_i $ が成り立つ任意の長さ $ N $ の整数列 $ X=(X_1,X_2,\dots,X_N) $ に対し、 $ \sum_{i=1}^{N}\ X_i\ \neq\ \frac{S}{2} $ である
 
$ T $ 個のテストケースについて答えてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ T $ $ \mathrm{case}_1 $ $ \vdots $ $ \mathrm{case}_T $

各ケースは以下の形式で与えられる。

> $ N $ $ A_1 $ $ A_2 $ $ \dots $ $ A_N $

## 输出格式

$ T $ 行出力せよ。$ i $ 行目には $ i $ 番目のテストケースについて、条件を満たすものが存在する場合は `Yes` を、存在しない場合は `No` を出力せよ。

## 说明/提示

### 制約

- $ 1\ \leq\ T $
- $ 1\ \leq\ N\ \leq\ 2\ \times\ 10^5 $
- $ 1\ \leq\ A_i\ \leq\ 10^9 $
- $ \sum_{i=1}^{N}\ A_i $ は偶数
- $ 1 $ つの入力に含まれるテストケースについて、 $ N $ の総和は $ 2\ \times\ 10^5 $ 以下
- 入力される値はすべて整数
 
### Sample Explanation 1

$ 1 $ つ目のテストケースについて、 $ B=(1,1,3),\ C=(0,1,0) $ とすると条件を満たします。 $ 2 $ つ目のテストケースについて、条件を満たす $ B,C $ の組は存在しません。

## 样例 #1

### 输入

```
3

3

1 2 3

6

1 1 2 2 3 3

4

1 1 1000000000 1000000000
```

### 输出

```
Yes

No

Yes
```



---

---
title: "[ARC061F] 3人でカードゲーム"
layout: "post"
diff: 省选/NOI-
pid: AT_arc061_d
tag: ['数学', '枚举', '逆元']
---

# [ARC061F] 3人でカードゲーム

## 题目描述

[problemUrl]: https://atcoder.jp/contests/arc061/tasks/arc061_d

A さん、B さん、C さんの $ 3 $ 人が以下のようなカードゲームをプレイしています。

- 最初、$ 3 $ 人はそれぞれ `a`、`b`、`c` いずれかの文字が書かれたカードを、A さんは $ N $ 枚、B さんは $ M $ 枚、C さんは $ K $ 枚持っている。$ 3 $ 人は、持っているカードを並べ替えることはできない。
- A さんのターンから始まる。
- 現在自分のターンである人がカードを $ 1 $ 枚以上持っているならば、そのうち先頭のカードを捨てる。その後、捨てられたカードに書かれているアルファベットと同じ名前の人 (例えば、カードに `a` と書かれていたならば A さん) のターンとなる。
- 現在自分のターンである人がカードを $ 1 $ 枚も持っていないならば、その人がゲームの勝者となり、ゲームは終了する。

$ 3 $ 人が最初に配られるカードに書いてある文字の並びは、全部で $ 3^{N+M+K} $ 通りの組み合わせがあります。このうち、A さんが勝者となってゲームが終了するのが何通りあるかを求めてください。

答えは大きくなる可能性があるので、$ 1\,000\,000\,007\ (=10^9+7) $ で割った余りを出力してください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ M $ $ K $

## 输出格式

答えを $ 1\,000\,000\,007\ (=10^9+7) $ で割った余りを出力せよ。

## 说明/提示

### 制約

- $ 1\ \leq\ N\ \leq\ 3×10^5 $
- $ 1\ \leq\ M\ \leq\ 3×10^5 $
- $ 1\ \leq\ K\ \leq\ 3×10^5 $

### 部分点

- $ 1\ \leq\ N\ \leq\ 1000 $、 $ 1\ \leq\ M\ \leq\ 1000 $、 $ 1\ \leq\ K\ \leq\ 1000 $ を満たすデータセットに正解した場合は、 $ 500 $ 点が与えられる。

### Sample Explanation 1

\- A さんが `a` を持っている場合は、他の $ 2 $ 人の持っているカードに関わらず A さんが勝ちます。これは $ 3×3=9 $ 通りあります。 - A さんが `b` を持っている場合は、B さんが `a` を持っているか、 B さんが `c` を持っていてかつ C さんが `a` を持っている場合に限り A さんが勝ちます。これは $ 3+1=4 $ 通りあります。 - A さんが `c` を持っている場合は、C さんが `a` を持っているか、 C さんが `b` を持っていてかつ B さんが `a` を持っている場合に限り A さんが勝ちます。これは $ 3+1=4 $ 通りあります。 合計すると、 $ 9+4+4=17 $ 通りとなります。

## 样例 #1

### 输入

```
1 1 1
```

### 输出

```
17
```

## 样例 #2

### 输入

```
4 2 2
```

### 输出

```
1227
```

## 样例 #3

### 输入

```
1000 1000 1000
```

### 输出

```
261790852
```



---

---
title: "[ARC157D] YY Garden"
layout: "post"
diff: 省选/NOI-
pid: AT_arc157_d
tag: ['数论', '组合数学']
---

# [ARC157D] YY Garden

## 题目描述

[problemUrl]: https://atcoder.jp/contests/arc157/tasks/arc157_d

$ H $ 行 $ W $ 列のマス目の各マスに `X`, `Y` のいずれかの文字が書かれています． 上から $ i $ 行目，左から $ j $ 列目のマスを $ (i,\ j) $ で表します． マス目に書かれている文字は $ H $ 個の文字列 $ S_1,\ S_2,\ \dots,\ S_H $ によって与えられ，$ S_i $ の $ j $ 文字目がマス $ (i,\ j) $ に書かれた文字を表します．

隣り合う各行および各列の間に，マス目全体を横断（縦断）するように柵を設置できます． 柵同士は交差しても構いません． 柵の設置後に，「あるマスから始めて上下左右に隣接するマスへの移動を繰り返すことで，柵を越えずに到達可能なマス全体」を**区画**と定義します． （出力例 1 の説明も参考にしてください．）

柵の設置方法は全部で $ 2^{H-1}\ \times\ 2^{W-1} $ 通りありますが，そのうち次の条件を満たすものの個数を $ 998244353 $ で割った余りを求めてください．

**条件:** 各区画には `Y` が書かれたマスがちょうど $ 2 $ 個含まれている．

## 输入格式

入力は以下の形式で標準入力から与えられる．

> $ H $ $ W $ $ S_1 $ $ S_2 $ $ \vdots $ $ S_H $

## 输出格式

条件を満たす柵の設置方法の総数を $ 998244353 $ で割った余りを出力せよ．

## 说明/提示

### 制約

- $ 1\ \leq\ H\ \leq\ 2000 $
- $ 1\ \leq\ W\ \leq\ 2000 $
- $ S_i\ (1\ \leq\ i\ \leq\ H) $ は `X`, `Y` からなる長さ $ W $ の文字列である．
 
### Sample Explanation 1

柵の設置方法として，以下の $ 8 $ 通りがあります． ``` X Y Y X|Y Y X Y|Y X|Y|Y | | | | Y X Y Y|X Y Y X|Y Y|X|Y X Y Y X|Y Y X Y|Y X|Y|Y ----- -+--- ---+- -+-+- Y X Y Y|X Y Y X|Y Y|X|Y ``` たとえば，$ 2,\ 3 $ 列目の間に柵を設置した場合，区画は ``` XY YX ``` ``` Y Y ``` であり，それぞれにちょうど $ 2 $ 個の `Y` が含まれているので，条件を満たします． また，$ 1,\ 2 $ 行目の間と $ 1,\ 2 $ 列目の間に柵を設置した場合，区画は ``` X ``` ``` YY ``` ``` Y ``` ``` XY ``` となり，$ 2 $ つ目の区画以外にはちょうど $ 2 $ 個の `Y` が含まれていないので，条件を満たしません．

### Sample Explanation 2

どのように柵を設置しても条件を満たしません．

### Sample Explanation 3

条件を満たす柵の設置方法の総数を $ 998244353 $ で割った余りを出力してください．

## 样例 #1

### 输入

```
2 3

XYY

YXY
```

### 输出

```
2
```

## 样例 #2

### 输入

```
2 3

XYX

YYY
```

### 输出

```
0
```

## 样例 #3

### 输入

```
2 58

YXXYXXYXXYXXYXXYXXYXXYXXYXXYXXYXXYXXYXXYXXYXXYXXYXXYXXYXXY

YXXYXXYXXYXXYXXYXXYXXYXXYXXYXXYXXYXXYXXYXXYXXYXXYXXYXXYXXY
```

### 输出

```
164036797
```



---

---
title: "[ARC160D] Mahjong"
layout: "post"
diff: 省选/NOI-
pid: AT_arc160_d
tag: ['组合数学', '容斥原理']
---

# [ARC160D] Mahjong

## 题目描述

找到可以通过以下两种操作，使得长度为 $N$、元素之和为 $M$ 的数列 $A$ 全为 $0$ 的 $A$ 的个数，再取模 $998244353$。

1. 在 $A$ 中选一个元素，将其减去 $K$。
2. 在 $A$ 中选取长度为 $K$ 的子串，子串中每个元素减去 $1$。

## 输入格式

输入一行整数，分别代表 $N~M~K$。

## 输出格式

输出答案。

## 说明/提示

- $1\le K\le N\le2000$
- $1\le M\le10^{18}$

## 样例 #1

### 输入

```
3 2 2
```

### 输出

```
5
```

## 样例 #2

### 输入

```
100 998244353 100
```

### 输出

```
0
```

## 样例 #3

### 输入

```
2000 545782618661124208 533
```

### 输出

```
908877889
```



---

---
title: "[ARC162E] Strange Constraints"
layout: "post"
diff: 省选/NOI-
pid: AT_arc162_e
tag: ['动态规划 DP', '组合数学']
---

# [ARC162E] Strange Constraints

## 题目描述

[problemUrl]: https://atcoder.jp/contests/arc162/tasks/arc162_e

$ 1 $ 以上 $ N $ 以下の整数からなる長さ $ N $ の数列 $ A=(A_1,A_2,\ldots,A_N) $ が与えられます。

$ 1 $ 以上 $ N $ 以下の整数からなる長さ $ N $ の数列 $ B=(B_1,B_2,\ldots,B_N) $ のうち、全ての $ i=1,2,\ldots,N $ に対して以下の条件を満たすものの個数を $ 998244353 $ で割ったあまりを求めてください。

- $ B $ の中に含まれる $ i $ の個数は $ A_i $ 個以下
- $ B $ の中に含まれる $ B_i $ の個数は $ A_i $ 個以下

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ A_1 $ $ A_2 $ $ \ldots $ $ A_N $

## 输出格式

答えを出力せよ。

## 说明/提示

### 制約

- $ 1\ \leq\ N\ \leq\ 500 $
- $ 1\ \leq\ A_i\ \leq\ N $
- 入力される数値は全て整数
 
### Sample Explanation 1

条件を満たす数列は以下の $ 10 $ 個です。 - $ (1,2,2) $ - $ (1,2,3) $ - $ (1,3,2) $ - $ (1,3,3) $ - $ (2,1,3) $ - $ (2,3,1) $ - $ (2,3,3) $ - $ (3,1,2) $ - $ (3,2,1) $ - $ (3,2,2) $

### Sample Explanation 2

条件を満たす数列は、$ 1 $ 以上 $ 4 $ 以下の整数からなる長さ $ 4 $ の数列全てで、その個数は $ 4^4=256 $ 個です。

### Sample Explanation 3

条件を満たす数列は、$ (1,2,3,4,5) $ を並び替えて得られる数列全てで、その個数は $ 5!=120 $ 個です。

### Sample Explanation 4

個数を $ 998244353 $ で割ったあまりを出力してください。

## 样例 #1

### 输入

```
3

1 2 3
```

### 输出

```
10
```

## 样例 #2

### 输入

```
4

4 4 4 4
```

### 输出

```
256
```

## 样例 #3

### 输入

```
5

1 1 1 1 1
```

### 输出

```
120
```

## 样例 #4

### 输入

```
14

6 5 14 3 6 7 3 11 11 2 3 7 8 10
```

### 输出

```
628377683
```



---

---
title: "[ARC163D] Sum of SCC"
layout: "post"
diff: 省选/NOI-
pid: AT_arc163_d
tag: ['动态规划 DP', '组合数学']
---

# [ARC163D] Sum of SCC

## 题目描述

[problemUrl]: https://atcoder.jp/contests/arc163/tasks/arc163_d

以下の条件を全て満たす頂点に $ 1 $ から $ N $ までの番号がついた $ N $ 頂点の有向グラフ $ G $ を考えます。

- $ G $ はトーナメントである。すなわち、$ G $ に多重辺や自己ループはなく、$ G $ のどの $ 2 $ 頂点 $ u,v $ に対しても、$ u\ \rightarrow\ v $ 辺または $ v\ \rightarrow\ u $ 辺のうちちょうど片方が存在する。
- $ G $ の辺のうち、頂点番号が小さい方から大きい方へ向けられた辺はちょうど $ M $ 本存在する。
 
そのような有向グラフ $ G $ 全てに対する強連結成分の個数の総和を $ 998244353 $ で割ったあまりを求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ M $

## 输出格式

答えを出力せよ。

## 说明/提示

### 制約

- $ 1\ \le\ N\ \le\ 30 $
- $ 0\ \le\ M\ \le\ \frac{N(N-1)}{2} $
 
### Sample Explanation 1

条件を満たす有向グラフ $ G $ は以下の $ 3 $ 個です。それぞれ強連結成分の個数は $ 3,1,3 $ であるため答えは $ 7 $ です。 ![](https://img.atcoder.jp/arc163/ee8acabc2a7d48164b3cc568e88f0840.png)

## 样例 #1

### 输入

```
3 1
```

### 输出

```
7
```

## 样例 #2

### 输入

```
6 2
```

### 输出

```
300
```

## 样例 #3

### 输入

```
25 156
```

### 输出

```
902739687
```



---

---
title: "[ARC167E] One Square in a Triangle"
layout: "post"
diff: 省选/NOI-
pid: AT_arc167_e
tag: ['数学', '构造', '标签482']
---

# [ARC167E] One Square in a Triangle

## 题目描述

[problemUrl]: https://atcoder.jp/contests/arc167/tasks/arc167_e

以下の条件を全て満たす $ xy $ 平面上の三角形 $ ABC $ を良い三角形とします。

- 頂点 $ A,B,C $ はいずれも、$ x $ 座標 $ \cdot $ $ y $ 座標がどちらも $ 0 $ 以上 $ 10^{8} $ 以下の格子点である。
- 全ての頂点が格子点である面積 $ 1 $ の正方形のうち、三角形 $ ABC $ の内部 (周上及び頂点を**含む**) に全体が含まれているものはちょうど $ 1 $ つ
 
正の整数 $ S $ が与えられます。

良い三角形のうち面積が $ \frac{S}{2} $ であるものが存在するか判定し、存在するなら $ 1 $ つ構築してください。

$ 1 $ つの入力ファイルにつき $ T $ 個のテストケースが与えられるので、それぞれについて解いてください。

## 输入格式

入力は以下の形式で標準入力から与えられます。

> $ T $ $ \text{case}_{1} $ $ \text{case}_{2} $ $ \vdots $ $ \text{case}_{T} $

各ケースは以下の形式で与えられます。

> $ S $

## 输出格式

各ケースに対し、面積 $ \frac{S}{2} $ の良い三角形が存在しない場合は `No` と、存在する場合は以下の形式で答えを出力してください。

> Yes $ AX $ $ AY $ $ BX $ $ BY $ $ CX $ $ CY $

ただし、 $ AX,BX,CX $ を $ A,B,C $ の $ x $ 座標、 $ AY,BY,CY $ を $ A,B,C $ の $ y $ 座標とします。

`Yes`, `No` を出力する際、各文字は英大文字・小文字のいずれでも良いです。 解が複数存在する場合はどれを出力しても正解とみなされます。

## 说明/提示

### 制約

- $ 1\leq\ T\leq\ 10^{5} $
- $ 1\leq\ S\leq\ 10^{8} $
- 入力は全て整数
 
### Sample Explanation 1

![](https://img.atcoder.jp/arc167/d6986726412312ca9a6e022bc8e722ce.png) 図の左側の三角形は $ 2 $ 番目のテストケース、右側の三角形は $ 3 $ 番目のテストケースに対応しています。

## 样例 #1

### 输入

```
3

1

4

15
```

### 输出

```
No

Yes

1 1 1 3 3 3

Yes

5 1 7 8 4 5
```



---

---
title: "[ARC169D] Add to Make a Permutation"
layout: "post"
diff: 省选/NOI-
pid: AT_arc169_d
tag: ['数学', '贪心', '数论']
---

# [ARC169D] Add to Make a Permutation

## 题目描述

[problemUrl]: https://atcoder.jp/contests/arc169/tasks/arc169_d

長さ $ N $ の整数列 $ A=(A_1,A_2,\cdots,A_N) $ が与えられます． $ A $ の各要素は $ 0 $ 以上 $ N-1 $ 以下の整数です．

あなたは以下の操作を $ 0 $ 回以上行うことができます．

- $ A $ の中からちょうど $ M $ 個の要素を選ぶ． そして，選んだ要素の値をそれぞれ $ 1 $ 増加させる． 増加させたあとに値が $ N $ になっている要素があれば，その値を $ 0 $ に変更する．
 
あなたの目標は $ A $ を $ (0,1,\cdots,N-1) $ の順列にすることです． 目標が達成可能か判定し，可能ならば必要な最小の操作回数を求めてください．

## 输入格式

入力は以下の形式で標準入力から与えられる．

> $ N $ $ M $ $ A_1 $ $ A_2 $ $ \cdots $ $ A_N $

## 输出格式

目標が達成不可能な場合，$ -1 $ を出力せよ． 可能な場合，必要な最小の操作回数を出力せよ．

## 说明/提示

### 制約

- $ 2\ \leq\ N\ \leq\ 250000 $
- $ 1\ \leq\ M\ \leq\ N-1 $
- $ 0\ \leq\ A_i\ \leq\ N-1 $
- 入力される値はすべて整数．
 
### Sample Explanation 1

以下のように操作すると $ 2 $ 回の操作で目標を達成できます． - 初期状態: $ A=(0,1,1) $ - $ 1 $ 回目の操作: $ A_1,A_2 $ を選んで操作を行い，$ A=(1,2,1) $ になる． - $ 2 $ 回目の操作: $ A_2,A_3 $ を選んで操作を行い，$ A=(1,0,2) $ になる． $ 2 $ 回未満の操作で目標を達成することはできないため，答えは $ 2 $ になります．

## 样例 #1

### 输入

```
3 2

0 1 1
```

### 输出

```
2
```

## 样例 #2

### 输入

```
5 2

0 4 2 3 1
```

### 输出

```
0
```

## 样例 #3

### 输入

```
4 2

0 0 1 2
```

### 输出

```
-1
```

## 样例 #4

### 输入

```
20 15

5 14 18 0 8 5 0 10 6 5 11 2 10 10 17 9 8 14 4 4
```

### 输出

```
10
```



---

---
title: "[ARC171E] Rookhopper's Tour"
layout: "post"
diff: 省选/NOI-
pid: AT_arc171_e
tag: ['数学', '组合数学']
---

# [ARC171E] Rookhopper's Tour

## 题目描述

[problemUrl]: https://atcoder.jp/contests/arc171/tasks/arc171_e

縦 $ N $ マス、横 $ N $ マスのグリッドがあります。グリッドの上から $ i $ 行目、左から $ j $ 列目のマスを $ (i,\ j) $ と呼びます。また、 $ 1 $ 個の黒石と $ M $ 個の白石があります。  
 あなたはこれらの道具を使って $ 1 $ 人でゲームをすることにしました。

ゲームのルールを説明します。はじめに、あなたは黒石を $ (A,\ B) $ に置きます。その後、 $ M $ 個の白石をグリッドのいずれかのマスに $ 1 $ 個ずつ置きます。ただし、

- $ (A,\ B) $ に白石は置けません。
- 白石は $ 1 $ つの行に高々 $ 1 $ 個しか置けません。
- 白石は $ 1 $ つの列に高々 $ 1 $ 個しか置けません。
 
その後、あなたは操作を行えなくなるまで以下の操作を行います。

- 黒石が $ (i,\ j) $ にあるとする。次の $ 4 $ 通りの操作のいずれかを行う。
  - $ (i,\ k) $ $ (j\ \lt\ k) $ に白石が置いてある時、その白石を取り除いて $ (i,\ k\ +\ 1) $ に黒石を動かす。
  - $ (i,\ k) $ $ (j\ \gt\ k) $ に白石が置いてある時、その白石を取り除いて $ (i,\ k\ -\ 1) $ に黒石を動かす。
  - $ (k,\ j) $ $ (i\ \lt\ k) $ に白石が置いてある時、その白石を取り除いて $ (k\ +\ 1,\ j) $ に黒石を動かす。
  - $ (k,\ j) $ $ (i\ \gt\ k) $ に白石が置いてある時、その白石を取り除いて $ (k\ -\ 1,\ j) $ に黒石を動かす。
      - ただし、黒石を動かす先のマスが存在しない場合はそのような動きは出来ない。
 
図で例示すると以下のようになります。ここで `B` は黒石、 `W` は白石、`.` は何もないマス、`O` は黒石を動かせるマスを意味します。

 ```
..O...
..W...
......
......
..B.WO
......
```

操作を終了した時点で以下の条件を全て満たしているとき、ゲームはあなたの勝利となります。そうでない場合は敗北となります。

- グリッドから白石が全て取り除かれている。
- 黒石が $ (A,\ B) $ に置かれている。
 
はじめの $ M $ 個の白石の配置としてあり得るもののうち、その後の操作をうまく行うことでゲームに勝利することが可能である配置は何通りありますか？答えを $ 998244353 $ で割った余りを求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ M $ $ A $ $ B $

## 输出格式

ゲームに勝利することが可能である白石の配置の個数を $ 998244353 $ で割った余りを出力せよ。

## 说明/提示

### 制約

- $ 2\ \leq\ M\ \leq\ N\ \leq\ 2\ \times\ 10^5 $
- $ 1\ \leq\ A\ \leq\ N $
- $ 1\ \leq\ B\ \leq\ N $
- $ N,\ M,\ A,\ B $ は整数
 
### Sample Explanation 1

例えば白石を以下の図のように配置したとします。 ``` ...... ..BW.. .....W ...... ..W... ....W. ``` このときあなたは次の手順で黒石を動かすことでゲームに勝利することが出来ます。 - $ (5,\ 3) $ にある白石を取り除いて $ (6,\ 3) $ に黒石を動かす。 - $ (6,\ 5) $ にある白石を取り除いて $ (6,\ 6) $ に黒石を動かす。 - $ (3,\ 6) $ にある白石を取り除いて $ (2,\ 6) $ に黒石を動かす。 - $ (2,\ 4) $ にある白石を取り除いて $ (2,\ 3) $ に黒石を動かす。 - グリッドから全ての白石を取り除き、かつ黒石が $ (A,\ B)\ =\ (2,\ 3) $ に置かれた状態になったので、あなたはゲームに勝利する。 ゲームに勝利することが可能である白石の配置は全部で $ 4 $ 通りあります。

## 样例 #1

### 输入

```
6 4 2 3
```

### 输出

```
4
```

## 样例 #2

### 输入

```
5 3 1 3
```

### 输出

```
0
```

## 样例 #3

### 输入

```
200000 47718 21994 98917
```

### 输出

```
146958602
```



---

---
title: "[ARC172D] Distance Ranking"
layout: "post"
diff: 省选/NOI-
pid: AT_arc172_d
tag: ['数学', '随机化', 'Ad-hoc']
---

# [ARC172D] Distance Ranking

## 题目描述

[problemUrl]: https://atcoder.jp/contests/arc172/tasks/arc172_d

$ N $ 次元空間上に $ N $ 個の点 $ p_1,\ p_2,\ \dots,\ p_N $ を以下の条件を満たすように配置してください。

> **条件 1** 点の座標は $ 0 $ 以上 $ 10^8 $ 以下の整数で構成される。
> 
> **条件 2** 入力で指定された $ (A_1,\ B_1),\ (A_2,\ B_2),\ \dots,\ (A_{N(N-1)/2},\ B_{N(N-1)/2}) $ について、$ d(p_{A_1},\ p_{B_1})\ <\ d(p_{A_2},\ p_{B_2})\ <\ \dots\ <\ d(p_{A_{N(N-1)/2}},\ p_{B_{N(N-1)/2}}) $ を満たす。ここで、$ d(x,\ y) $ は点 $ x,\ y $ のユークリッド距離を示す。

なお、本問題の制約下では答えが存在することが証明できます。また、答えが複数通りある場合でも、そのうち $ 1 $ つを出力すればよいです。

  ユークリッド距離とは $ n $ 次元空間上の点 $ x,\ y $ のユークリッド距離は、$ x $ の座標を $ (x_1,\ x_2,\ \dots,\ x_n) $、$ y $ の座標を $ (y_1,\ y_2,\ \dots,\ y_n) $ として、$ \sqrt{(x_1-y_1)^2\ +\ (x_2-y_2)^2\ +\ \dots\ +\ (x_n-y_n)^2} $ と計算されます。

## 输入格式

入力は以下の形式で標準入力から与えられます。

> $ N $ $ A_1 $ $ B_1 $ $ A_2 $ $ B_2 $ $ \vdots $ $ A_{N(N-1)/2} $ $ B_{N(N-1)/2} $

## 输出格式

点 $ p_i $ $ (1\ \leq\ i\ \leq\ N) $ の座標を $ (p_{i,\ 1},\ p_{i,\ 2},\ \dots,\ p_{i,\ N}) $ とするとき、以下の形式で出力してください。

> $ p_{1,\ 1} $ $ p_{1,\ 2} $ $ \cdots $ $ p_{1,\ N} $ $ p_{2,\ 1} $ $ p_{2,\ 2} $ $ \cdots $ $ p_{2,\ N} $ $ \vdots $ $ p_{N,\ 1} $ $ p_{N,\ 2} $ $ \cdots $ $ p_{N,\ N} $

## 说明/提示

### 制約

- $ 3\ \leq\ N\ \leq\ 20 $
- $ 1\ \leq\ A_i\ <\ B_i\ \leq\ N\ (1\ \leq\ i\ \leq\ \frac{N(N-1)}{2}) $
- $ (A_1,\ B_1),\ (A_2,\ B_2),\ \dots,\ (A_{N(N-1)/2},\ B_{N(N-1)/2}) $ はすべて異なる
 
### Sample Explanation 1

この出力例では座標の第 $ 3 $、第 $ 4 $ の成分がすべて $ 0 $ なので、以下の $ 2 $ 次元の図で表すことができます。 $ d(p_1,\ p_2)\ =\ \sqrt{37},\ d(p_1,\ p_3)\ =\ \sqrt{40},\ d(p_2,\ p_4)\ =\ \sqrt{49},\ d(p_3,\ p_4)\ =\ \sqrt{64},\ d(p_1,\ p_4)\ =\ \sqrt{72},\ d(p_2,\ p_3)\ =\ \sqrt{113} $ であり、正しい順番になっています。 !\[\](https://img.atcoder.jp/arc172/2df65ad4071e638a89d365f0aaecf25f.png)

## 样例 #1

### 输入

```
4

1 2

1 3

2 4

3 4

1 4

2 3
```

### 输出

```
3 2 0 0

9 1 0 0

1 8 0 0

9 8 0 0
```



---

---
title: "[ARC172E] Last 9 Digits"
layout: "post"
diff: 省选/NOI-
pid: AT_arc172_e
tag: ['数学', '数论']
---

# [ARC172E] Last 9 Digits

## 题目描述

[problemUrl]: https://atcoder.jp/contests/arc172/tasks/arc172_e

$ n^n $ を $ 10^9 $ で割った余りが $ X $ となるような正の整数 $ n $ が存在するか判定し、存在する場合は最小のものを求めてください。

$ Q $ 個のテストケースが与えられるので、それぞれに対して答えてください。

## 输入格式

入力は以下の形式で標準入力から与えられます。ただし、$ i $ 個目 $ (1\ \leq\ i\ \leq\ Q) $ のテストケースにおける $ X $ の値を $ X_i $ とします。

> $ Q $ $ X_1 $ $ X_2 $ $ \vdots $ $ X_Q $

## 输出格式

$ Q $ 行にわたって出力してください。$ i $ 行目には、$ i $ 個目のテストケースに対する答えを出力してください。ただし、条件を満たす $ n $ が存在しない場合は答えを $ -1 $ とします。

## 说明/提示

### 制約

- $ 1\ \leq\ Q\ \leq\ 10000 $
- $ 1\ \leq\ X\ \leq\ 10^9\ -\ 1 $
- $ X $ は $ 2 $ の倍数でも $ 5 $ の倍数でもない
- 入力はすべて整数
 
### Sample Explanation 1

この入力例は $ 2 $ 個のテストケースからなります。 - $ 1 $ 個目：$ 3^3\ =\ 27 $ を $ 10^9 $ で割った余りは $ 27 $ なので、$ n\ =\ 3 $ で条件を満たします。 - $ 2 $ 個目：$ 11^{11}\ =\ 285311670611 $ を $ 10^9 $ で割った余りは $ 311670611 $ なので、$ n\ =\ 11 $ で条件を満たします。

## 样例 #1

### 输入

```
2

27

311670611
```

### 输出

```
3

11
```



---

---
title: "[ARC174E] Existence Counting"
layout: "post"
diff: 省选/NOI-
pid: AT_arc174_e
tag: ['树状数组', '组合数学', '排列组合']
---

# [ARC174E] Existence Counting

## 题目描述

[problemUrl]: https://atcoder.jp/contests/arc174/tasks/arc174_e

整数 $ N,K $ が与えられます。このとき、以下の条件を全て満たす長さ $ K $ の数列 $ a=(a_1,a_2,\dots,a_K) $ を考えます。

- $ a_i $ は $ 1\ \le\ a_i\ \le\ N $ を満たす整数である
- $ a $ の全ての要素は相異なる
 
$ a $ として考えられる数列を辞書順に全て並べた 「数列の列」 を辞書 $ s $ とします。

辞書 $ s $ 中に存在する数列 $ P $ が与えられるので、整数 $ t=1,2,\dots,N $ に対して以下の質問に答えてください。

- 以下の条件を全て満たす数列 $ b $ の個数を $ 998244353 $ で割った余りを求めよ。
  - 数列 $ b $ は辞書 $ s $ 中に存在する。
  - 数列 $ b $ 中に整数 $ t $ が含まれる。
  - 数列 $ b $ は辞書順で数列 $ P $ 以下である。
 
  数列の辞書順とは？ 数列 $ A\ =\ (A_1,\ \ldots,\ A_{|A|}) $ が $ B\ =\ (B_1,\ \ldots,\ B_{|B|}) $ より**辞書順で真に小さい**とは、下記の 1. と 2. のどちらかが成り立つことを言います。 1. $ |A|\ かつ\ (A_{1},\ldots,A_{|A|})\ =\ (B_1,\ldots,B_{|A|}) $ である。
2. ある整数 $ 1\leq\ i\leq\ \min\{|A|,|B|\} $ が存在して、下記の $ 2 $ つがともに成り立つ。 
  - $ (A_{1},\ldots,A_{i-1})\ =\ (B_1,\ldots,B_{i-1}) $
  - $ A_i $

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ K $ $ P_1 $ $ P_2 $ $ \dots $ $ P_K $

## 输出格式

全体で $ N $ 行出力せよ。  
 このうち $ i $ 行目には、 $ t=i $ であるときの質問の答えを整数として出力せよ。

## 说明/提示

### 制約

- 入力は全て整数
- $ 1\ \le\ K\ \le\ N\ \le\ 3\ \times\ 10^5 $
- $ P $ は問題文中の条件を満たす。
 
### Sample Explanation 1

この入力では、 $ N=4,K=2 $ です。 このとき、辞書 $ s=((1,2),(1,3),(1,4),(2,1),(2,3),(2,4),(3,1),(3,2),(3,4),(4,1),(4,2),(4,3)) $ となります。 辞書 $ s $ に含まれ、かつ辞書順で $ (3,2) $ 以下である数列のうち、 - $ 1 $ が含まれるものは $ (1,2),(1,3),(1,4),(2,1),(3,1) $ の $ 5 $ 個 - $ 2 $ が含まれるものは $ (1,2),(2,1),(2,3),(2,4),(3,2) $ の $ 5 $ 個 - $ 3 $ が含まれるものは $ (1,3),(2,3),(3,1),(3,2) $ の $ 4 $ 個 - $ 4 $ が含まれるものは $ (1,4),(2,4) $ の $ 2 $ 個 です。

## 样例 #1

### 输入

```
4 2

3 2
```

### 输出

```
5

5

4

2
```

## 样例 #2

### 输入

```
18 13

5 13 11 2 18 1 10 15 17 4 12 7 3
```

### 输出

```
925879409

905921009

665544804

665544719

783035803

349952762

349952758

349952757

349952757

349921178

212092637

710350150

378895603

129113201

129111892

129098081

129096772

110181652
```



---

---
title: "[ARC184C] Mountain and Valley Folds"
layout: "post"
diff: 省选/NOI-
pid: AT_arc184_c
tag: ['动态规划 DP', '数学']
---

# [ARC184C] Mountain and Valley Folds

## 题目描述

[problemUrl]: https://atcoder.jp/contests/arc184/tasks/arc184_c

厚さを無視できる細長い紙があります。右端を持ち上げ、中央を折り目にして左端に合わせて折りたたむ操作を $ 100 $ 回行い、もとに戻します。このとき紙には折り目が $ 2^{100}\ -\ 1 $ 個あり、これらは山折り、谷折りの $ 2 $ 種類に分類できます。下の図は $ 2 $ 回操作を行った状態を表した図で、赤い実線は山折り、赤い点線は谷折りを表します。

山折り、谷折りとは- ある折り目が山折りであるとは、折り目が紙の裏面同士が重なる方向に折られたことをいいます。
- ある折り目が谷折りであるとは、折り目が紙の表面同士が重なる方向に折られたことをいいます。

![image of folds](https://cdn.luogu.com.cn/upload/vjudge_pic/AT_arc184_c/a6888c2d5e0c2b2f18956db7954caa4251b38be7.png)

長さ $ N $ の非負整数列 $ A\ =\ (A_1,\ A_2,\ \dots\ ,A_N) $ が与えられます。ここで $ 0\ =\ A_1\ <\ A_2\ <\ \dots\ <\ A_N\ \leq\ 10^{18} $ です。

$ 1 $ 以上 $ 2^{100}\ -\ A_N\ -\ 1 $ 以下の整数 $ i $ に対し、 $ f(i) $ を以下のように定義します。

- $ k\ =\ 1,\ 2,\ \dots\ ,N $ のうち、左から $ i\ +\ A_k $ 番目の折り目が山折りであるものの個数

$ f(1),\ f(2),\ \dots\ ,f(2^{100}\ -\ A_N\ -\ 1) $ の最大値を求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ A_1 $ $ A_2 $ $ \cdots $ $ A_N $

## 输出格式

答えを $ 1 $ 行に出力せよ。

## 说明/提示

### 制約

- $ 1\ \leq\ N\ \leq\ 10^3 $
- $ 0\ =\ A_1\ <\ A_2\ <\ \dots\ <\ A_N\ \leq\ 10^{18} $

### Sample Explanation 1

山折り、谷折りをそれぞれ `M`, `V` と表すことにすると、折り目には `MMVM` と連続する箇所が存在します。`MMMM` と連続する箇所は存在しないので、答えは $ 3 $ となります。

## 样例 #1

### 输入

```
4
0 1 2 3
```

### 输出

```
3
```

## 样例 #2

### 输入

```
6
0 2 3 5 7 8
```

### 输出

```
4
```



---

---
title: "[ARC186D] Polish Mania"
layout: "post"
diff: 省选/NOI-
pid: AT_arc186_d
tag: ['组合数学', '容斥原理']
---

# [ARC186D] Polish Mania

## 题目描述

[problemUrl]: https://atcoder.jp/contests/arc186/tasks/arc186_d

空でない非負整数列 $ (V_1,\ V_2,\ \dots,\ V_M) $ が **Polish** であることを、次のように再帰的に定義します。

- $ V_1 $ 個の Polish 数列 $ W_1,\ W_2,\ \dots,\ W_{V_1} $ が存在して、数列 $ (V_1),\ W_1,\ W_2,\ \dots,\ W_{V_1} $ をこの順に連結したものが数列 $ (V_1,\ V_2,\ \dots,\ V_M) $ と一致する

特に、数列 $ (0) $ は Polish です。

長さ $ N $ の非負整数列 $ (A_1,\ A_2,\ \dots,\ A_N) $ が与えられます。辞書順で $ (A_1,\ A_2,\ \dots,\ A_N) $ 以下である、長さ $ N $ の Polish 数列の数を $ 998244353 $ で割ったあまりを求めてください。

 数列の辞書順とは？数列 $ S\ =\ (S_1,S_2,\ldots,S_{|S|}) $ が数列 $ T\ =\ (T_1,T_2,\ldots,T_{|T|}) $ より**辞書順で小さい**とは、下記の 1. と 2. のどちらかが成り立つことを言います。 ここで、$ |S|,\ |T| $ はそれぞれ $ S,\ T $ の長さを表します。

1. $ |S|\ \lt\ |T| $ かつ $ (S_1,S_2,\ldots,S_{|S|})\ =\ (T_1,T_2,\ldots,T_{|S|}) $。
2. ある整数 $ 1\ \leq\ i\ \leq\ \min\lbrace\ |S|,\ |T|\ \rbrace $ が存在して、下記の $ 2 $ つがともに成り立つ。 
  - $ (S_1,S_2,\ldots,S_{i-1})\ =\ (T_1,T_2,\ldots,T_{i-1}) $
  - $ S_i $ が $ T_i $ より（数として）小さい。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ A_1 $ $ A_2 $ $ \dots $ $ A_N $

## 输出格式

条件を満たす数列の数を $ 998244353 $ で割ったあまりを出力せよ。

## 说明/提示

### 制約

- $ 1\leq\ N\ \leq\ 3\times\ 10^5 $
- $ 0\leq\ A_i\ \lt\ N $
- 入力はすべて整数

### Sample Explanation 1

$ (1,\ 1,\ 1,\ 1,\ 1,\ 0) $ と $ (1,\ 1,\ 1,\ 2,\ 0,\ 0) $ が条件を満たします。 $ (1,\ 1,\ 1,\ 2,\ 0,\ 0) $ が Polish であることは、次のように確認できます。 - 問題文中にあるとおり、$ (0) $ は Polish である - $ (2,\ 0,\ 0) $ は、 $ (2) $ と $ 2 $ つの Polilsh 数列 $ (0) $ と $ (0) $ をこの順に連結したものと一致するため、Polish である - $ (1,\ 2,\ 0,\ 0) $ は、 $ (1) $ と $ 1 $ つの Polilsh 数列 $ (2,\ 0,\ 0) $ をこの順に連結したものと一致するため、Polish である - $ (1,\ 1,\ 2,\ 0,\ 0) $ は、 $ (1) $ と $ 1 $ つの Polilsh 数列 $ (1,\ 2,\ 0,\ 0) $ をこの順に連結したものと一致するため、Polish である - $ (1,\ 1,\ 1,\ 2,\ 0,\ 0) $ は、 $ (1) $ と $ 1 $ つの Polilsh 数列 $ (1,\ 1,\ 2,\ 0,\ 0) $ をこの順に連結したものと一致するため、Polish である

## 样例 #1

### 输入

```
6
1 1 1 2 0 0
```

### 输出

```
2
```

## 样例 #2

### 输入

```
11
3 3 4 4 5 5 6 6 7 7 8
```

### 输出

```
13002
```

## 样例 #3

### 输入

```
19
18 18 18 18 18 18 18 18 18 18 18 18 18 18 18 18 18 18 18
```

### 输出

```
477638700
```

## 样例 #4

### 输入

```
4
1 1 0 0
```

### 输出

```
0
```



---

---
title: "Counting Amusing Numbers"
layout: "post"
diff: 省选/NOI-
pid: AT_icpc2015summer_day3_c
tag: ['动态规划 DP', '组合数学']
---

# Counting Amusing Numbers

## 题目描述

[problemUrl]: https://atcoder.jp/contests/jag2015summer-day3/tasks/icpc2015summer_day3_c





---

---
title: "テント  (Tents)"
layout: "post"
diff: 省选/NOI-
pid: AT_joisc2018_c
tag: ['动态规划 DP', '组合数学']
---

# テント  (Tents)

## 题目描述

[problemUrl]: https://atcoder.jp/contests/joisc2018/tasks/joisc2018_c





---


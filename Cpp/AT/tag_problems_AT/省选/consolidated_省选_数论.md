---
title: "[ABC315Ex] Typical Convolution Problem"
layout: "post"
diff: 省选/NOI-
pid: AT_abc315_h
tag: ['cdq 分治', '快速数论变换 NTT']
---

# [ABC315Ex] Typical Convolution Problem

## 题目描述

给定一个长为 $n$ 的序列 $a$，按如下方法计算 $f(x)$：

- $f(0)=1$;
- 当整数 $m\in[1,n]$ 时，$f(m)=a_m\times (\displaystyle\sum_{i+j\lt m} f(i)\times f(j))$。

对于每个整数 $i\in[1,n]$，计算 $f(i)$ $\bmod$ $998244353$ 的值。

## 输入格式

第一行为序列长度 $n$，第二行输入 $n$ 个整数表示序列 $a$。

## 输出格式

依次输出 $f(1)$，$f(2)$，…，$f(n)$ 对 $998244353$ 取模后的值，相邻两个数之间以单个空格隔开。

## 说明/提示

#### 数据规模与约定

$1\le n\le 2\times 10^5$，$a_i\in[0,998244352]$。

## 样例 #1

### 输入

```
5

1 2 3 4 5
```

### 输出

```
1 6 48 496 6240
```

## 样例 #2

### 输入

```
3

12345 678901 2345678
```

### 输出

```
12345 790834943 85679169
```



---

---
title: "[ABC329G] Delivery on Tree"
layout: "post"
diff: 省选/NOI-
pid: AT_abc329_g
tag: ['动态规划 DP', '数论', '前缀和', 'Ad-hoc']
---

# [ABC329G] Delivery on Tree

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc329/tasks/abc329_g

$ N $ 頂点の二分木が与えられます。 頂点には $ 1 $ から $ N $ までの番号が付けられており、頂点 $ 1 $ が根です。 $ i\ (1\leq\ i\ \leq\ N-1) $ 番目の辺は、頂点 $ i+1 $ と頂点 $ P_i\ (\leq\ i) $ を双方向に結んでいます。

この木の上には $ 1 $ 個のカゴと $ M $ 個のボールがあります。 ボールには $ 1 $ から $ M $ までの番号が付けられており、各ボール $ j $ について**スタート頂点** $ S_j $ と**ゴール頂点** $ T_j $ が定められています。 最初、カゴは空の状態で頂点 $ 1 $ に置かれており、ボールはそれぞれのスタート頂点に置かれています。

あなたは、以下の操作を好きな回数、好きな順序で行うことができます。

- 今カゴが置かれている頂点を $ v $ として、以下のいずれかを行う。
  - 頂点 $ v $ に繋がる辺を $ 1 $ つ選び、カゴをその辺に沿って動かして隣接する頂点に移動させる。 このとき、カゴの中に入っているボールも一緒に移動する。
  - スタート頂点が $ v $ であり、今もスタート頂点に置かれているようなボールを $ 1 $ つ選んで、カゴの中に入れる。 この操作は、元々カゴの中に入っているボールが $ K $ 個未満である場合にのみ行える（すなわち、カゴの中に $ K+1 $ 個以上のボールを入れることはできない）。
  - ゴール頂点が $ v $ であり、今カゴの中に入っているようなボールを $ 1 $ つ選んでカゴから取り出し、頂点 $ v $ に置く。
 
全ての操作が終了した時点で、カゴは空の状態で頂点 $ 1 $ に置かれており、ボールはそれぞれのゴール頂点に置かれているような操作列を**良い操作列**と呼びます。

カゴを何度も動かすのは疲れるので、カゴが動く経路は、全ての辺をちょうど $ 2 $ 回ずつ通り頂点 $ 1 $ に戻ってくるようなものに限定したいです。 そのような経路のうち、その経路に従ってカゴを動かす良い操作列が存在するようなものの数を $ 998244353 $ で割った余りを求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ M $ $ K $ $ P_1 $ $ P_2 $ $ \dots $ $ P_{N-1} $ $ S_1 $ $ T_1 $ $ S_2 $ $ T_2 $ $ \vdots $ $ S_M $ $ T_M $

## 输出格式

全ての辺をちょうど $ 2 $ 回ずつ通り頂点 $ 1 $ に戻ってくるような経路のうち、その経路に従ってカゴを動かす良い操作列が存在するようなものの数を $ 998244353 $ で割った余りを出力せよ。

## 说明/提示

### 制約

- $ 2\leq\ N\ \leq\ 10^4 $
- $ 1\leq\ M\ \leq\ 2\times\ 10^5 $
- $ 1\leq\ K\ \leq\ 10^3 $
- $ 1\leq\ P_i\ \leq\ i $
- 全ての $ v\ (1\leq\ v\ \leq\ N) $ について、$ P_i=v $ を満たす $ i $ の数は高々 $ 2 $ 個
- $ 1\leq\ S_j,\ T_j\ \leq\ N $
- $ S_j\ \neq\ T_j $
- 入力は全て整数
 
### Sample Explanation 1

与えられるグラフは以下の図の通りです。頂点の側に書かれた丸と四角は、それぞれその番号のボールのスタート頂点とゴール頂点を表します。 !\[\](https://img.atcoder.jp/abc329/afa9812169c0c570270c32e5aa1c814a.jpg) 全ての辺をちょうど $ 2 $ 回ずつ通り頂点 $ 1 $ に戻ってくるような経路のうち、その経路に従ってカゴを動かす良い操作列が存在するようなものは以下の $ 1 $ 通りのみです。 !\[\](https://img.atcoder.jp/abc329/b80e2b20635a90cf935fa4bbc89872fd.jpg) 具体的には、以下のような良い操作列を構成できます。 1. カゴを頂点 $ 2 $ に動かす。 2. ボール $ 1 $ をカゴに入れる。 3. カゴを頂点 $ 1 $ に動かす。 4. カゴを頂点 $ 3 $ に動かす。 5. カゴを頂点 $ 4 $ に動かす。 6. ボール $ 1 $ をカゴから出して頂点 $ 4 $ に置く。 7. カゴを頂点 $ 3 $ に動かす。 8. カゴを頂点 $ 5 $ に動かす。 9. ボール $ 2 $ をカゴに入れる。 10. カゴを頂点 $ 3 $ に動かす。 11. ボール $ 2 $ をカゴから出して頂点 $ 3 $ に置く。 12. カゴを頂点 $ 1 $ に動かす。

### Sample Explanation 2

入出力例 1 から $ K $ の値が $ 1 $ 増えています。 これにより、上述した経路に加えて、以下の経路についても良い操作列を構成できるようになります。 !\[\](https://img.atcoder.jp/abc329/31ce5331d578d5f2d0c0fe86751fd60d.jpg)

## 样例 #1

### 输入

```
5 2 1

1 1 3 3

2 4

5 3
```

### 输出

```
1
```

## 样例 #2

### 输入

```
5 2 2

1 1 3 3

2 4

5 3
```

### 输出

```
2
```

## 样例 #3

### 输入

```
15 4 2

1 2 1 4 2 3 4 7 3 7 5 9 11 8

14 12

5 4

13 15

5 12
```

### 输出

```
8
```



---

---
title: "[ABC352G] Socks 3"
layout: "post"
diff: 省选/NOI-
pid: AT_abc352_g
tag: ['快速数论变换 NTT']
---

# [ABC352G] Socks 3

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc352/tasks/abc352_g

高橋君のタンスの中には様々な色の靴下が入っています。 靴下の色は $ 1 $ 以上 $ N $ 以下の整数として表され、色 $ i $ の靴下は $ A_i\ (\geq\ 2) $ 枚入っています。

高橋君は、以下の操作を行うことで今日履く靴下を選ぼうとしています。

- 今までに取り出した靴下の中で同じ色の靴下の $ 2 $ 枚組が作れるようになるまで、タンスの中からランダムに等確率で $ 1 $ 枚の靴下を取り出すことを繰り返す。 なお、一度取り出した靴下はタンスの中には戻さない。

高橋君がタンスから靴下を取り出す回数の期待値を $ \text{mod\ }\ 998244353 $ で求めてください。

期待値を $ \text{mod\ }\ 998244353 $ で求めるとは求める期待値は必ず有理数になることが証明できます。 また、この問題の制約下では、期待値を既約分数 $ \frac{y}{x} $ で表したときに $ x $ が $ 998244353 $ で割り切れないことが保証されます。 このとき $ xz\ \equiv\ y\ \pmod{998244353} $ を満たすような $ 0 $ 以上 $ 998244352 $ 以下の整数 $ z $ が一意に定まるので、この $ z $ を求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ A_1 $ $ A_2 $ $ \dots $ $ A_N $

## 输出格式

答えを出力せよ。

## 说明/提示

### 制約

- $ 1\leq\ N\ \leq\ 3\times\ 10^5 $
- $ 2\leq\ A_i\ \leq\ 3000 $
- 入力は全て整数

### Sample Explanation 1

例えば、以下のように操作を行うことが考えられます。 1. タンスの中から色 $ 1 $ の靴下を $ 1 $ 枚取り出す。タンスの中には色 $ 1 $ の靴下が $ 1 $ 枚と色 $ 2 $ の靴下が $ 2 $ 枚残っている。 2. タンスの中から色 $ 2 $ の靴下を $ 1 $ 枚取り出す。タンスの中には色 $ 1,2 $ の靴下が $ 1 $ 枚ずつ残っている。 3. タンスの中から色 $ 1 $ の靴下を $ 1 $ 枚取り出す。今までに取り出した靴下は色 $ 1 $ の靴下が $ 2 $ 枚と色 $ 2 $ の靴下が $ 1 $ 枚であり、この中で色 $ 1 $ の靴下の $ 2 $ 枚組が作れるので操作を終了する。 この例の場合、高橋君がタンスから靴下を取り出す回数は $ 3 $ 回です。 高橋君がタンスから靴下を取り出す回数は $ \frac{2}{3} $ の確率で $ 3 $ 回、$ \frac{1}{3} $ の確率で $ 2 $ 回なので、求める期待値は $ 3\times\ \frac{2}{3}\ +\ 2\times\ \frac{1}{3}\ =\ \frac{8}{3}\ \equiv\ 665496238\ \pmod\ {998244353} $ です。

## 样例 #1

### 输入

```
2
2 2
```

### 输出

```
665496238
```

## 样例 #2

### 输入

```
1
352
```

### 输出

```
2
```

## 样例 #3

### 输入

```
6
1796 905 2768 253 2713 1448
```

### 输出

```
887165507
```



---

---
title: "[ABC392G] Fine Triplets"
layout: "post"
diff: 省选/NOI-
pid: AT_abc392_g
tag: ['多项式', '快速傅里叶变换 FFT', '快速数论变换 NTT']
---

# [ABC392G] Fine Triplets

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc392/tasks/abc392_g

当三个整数 $A,B,C$（满足 $A < B < C$）满足 $B - A = C - B$ 时，称 $(A,B,C)$ 为**好的三元组**。  
给定一个包含 $N$ 个元素的正整数集合 $S = \{\ S_1, S_2, \dots, S_N\ \}$，求满足 $A,B,C \in S$ 的好的三元组的个数。

## 输入格式

输入通过标准输入给出，格式如下：

> $N$  
$S_1$ $S_2$ $\dots$ $S_N$

## 输出格式

输出答案作为整数。

## 说明/提示

### 约束条件

- 输入均为整数
- $1 \leq N \leq 10^6$
- $1 \leq S_i \leq 10^6$
- $S$ 中的元素互不相同

### 样例解释 1

$S = \{8,3,1,5,2\}$。符合条件的好的三元组有以下 $3$ 个：
- $(1,2,3)$
- $(1,3,5)$
- $(2,5,8)$

翻译由 DeepSeek R1 完成

## 样例 #1

### 输入

```
5
8 3 1 5 2
```

### 输出

```
3
```

## 样例 #2

### 输入

```
7
300000 100000 499998 499999 200000 400000 500000
```

### 输出

```
5
```

## 样例 #3

### 输入

```
10
13 1 16 15 12 4 7 10 2 19
```

### 输出

```
10
```



---

---
title: "[AGC003D] Anticube"
layout: "post"
diff: 省选/NOI-
pid: AT_agc003_d
tag: ['数论', '素数判断,质数,筛法', '根号分治']
---

# [AGC003D] Anticube

## 题目描述

[problemUrl]: https://atcoder.jp/contests/agc003/tasks/agc003_d

高橋君は誕生日にお母さんから正の整数 $ s_1,...,s_N $ をもらいました。ただし、要素の重複は許されます。 高橋君は、これらの$ N $個の整数のうちのいくつかを丸で囲みます。

高橋君は立方数が嫌いなので、$ s_i,s_j(i\ ≠\ j) $の両方が丸で囲まれているなら、その積$ s_is_j $は立方数とならないようにしたいです。 例えば、$ s_1=1,s_2=1,s_3=2,s_4=4 $のとき、$ s_1 $と$ s_2 $を同時に丸で囲むことはできません。また、$ s_3 $と$ s_4 $を同時に丸で囲むこともできません。

高橋君が丸で囲むことができる整数の個数の最大値を求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ s_1 $ : $ s_N $

## 输出格式

高橋君が丸で囲むことができる整数の個数の最大値を表す整数を出力せよ。

## 说明/提示

### 制約

- $ 1\ ≦\ N\ ≦\ 10^5 $
- $ 1\ ≦\ s_i\ ≦\ 10^{10} $
- 入力はすべて整数である。

### Sample Explanation 1

$ 1,2,3,5,6,7 $ を丸で囲むことができます。

## 样例 #1

### 输入

```
8

1

2

3

4

5

6

7

8
```

### 输出

```
6
```

## 样例 #2

### 输入

```
6

2

4

8

16

32

64
```

### 输出

```
3
```

## 样例 #3

### 输入

```
10

1

10

100

1000000007

10000000000

1000000009

999999999

999

999

999
```

### 输出

```
9
```



---

---
title: "[AGC039C] Division by Two with Something"
layout: "post"
diff: 省选/NOI-
pid: AT_agc039_c
tag: ['数论', '位运算']
---

# [AGC039C] Division by Two with Something

## 题目描述

现在给你一个整数$N$和一个二进制数$X$，对$0 \sim X$之间的每个整数$K$在返回到其原始值之前，需要执行多少次下面的操作：

如果$K$是奇数
	
$K=(K-1) \div 2$
 
如果$K$是偶数

$K=(K \div 2)+2^{N-1}$

当 $K$ 不可能返回原始值不计入操作次数。

## 输入格式

第一行输入一个整数$N$，第二行输入一个$N$位的整数$X$。

## 输出格式

一个整数，表示$0 \sim X$之间的每个整数$K$在返回到其原始值之前，需要执行的操作次数的总和。

**由于答案可能过大,请对最终答案$mod \text{ 998244353}$。**

## 说明/提示

- $1 \le N \le 2 \times10^5$
- $0 \le X < 2^N$
- $X$是一个长度为$N$的二进制数($X$的数位不足$N$时用前导$0$补齐)
- 所有数字都是整数

例如,$K = 3$时，操作为：1，0，4，6，7，3，所以$K=3$时答案是$6$。

## 样例 #1

### 输入

```
3

111
```

### 输出

```
40
```

## 样例 #2

### 输入

```
6

110101
```

### 输出

```
616
```

## 样例 #3

### 输入

```
30

001110011011011101010111011100
```

### 输出

```
549320998
```



---

---
title: "[AGC047C] Product Modulo"
layout: "post"
diff: 省选/NOI-
pid: AT_agc047_c
tag: ['原根', '数论', '快速傅里叶变换 FFT']
---

# [AGC047C] Product Modulo

## 题目描述

[problemUrl]: https://atcoder.jp/contests/agc047/tasks/agc047_c

$ P $ を素数 $ 200\,003 $ とします。$ N $ 個の整数 $ A_1,\ A_2,\ \ldots,\ A_N $ が与えられるので、$ N\ \cdot\ (N-1)\ /\ 2 $ 個すべての非順序対 $ (A_i,\ A_j) $ ($ i\ <\ j $) に対する $ ((A_i\ \cdot\ A_j)\ \bmod\ P) $ の和を求めてください。

和を $ P $ で割った余りを求めるのではないことに注意してください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ A_1 $ $ A_2 $ $ \cdots $ $ A_N $

## 输出格式

一つの整数、すなわち $ ((A_i\ \cdot\ A_j)\ \bmod\ P) $ の和を出力せよ。

## 说明/提示

### 制約

- $ 2\ \leq\ N\ \leq\ 200\,000 $
- $ 0\ \leq\ A_i\ <\ P\ =\ 200\,003 $
- 入力中のすべての値は整数である。

### Sample Explanation 1

$ 0 $ でない積は以下の通りです。 - $ 2019\ \cdot\ 2020\ \bmod\ P\ =\ 78320 $ - $ 2019\ \cdot\ 200002\ \bmod\ P\ =\ 197984 $ - $ 2020\ \cdot\ 200002\ \bmod\ P\ =\ 197983 $ よって、答えは $ 0\ +\ 78320\ +\ 197984\ +\ 0\ +\ 0\ +\ 197983\ =\ 474287 $ となります。

## 样例 #1

### 输入

```
4

2019 0 2020 200002
```

### 输出

```
474287
```

## 样例 #2

### 输入

```
5

1 1 2 2 100000
```

### 输出

```
600013
```



---

---
title: "[AGC070A] Multiples in the String"
layout: "post"
diff: 省选/NOI-
pid: AT_agc070_a
tag: ['数论']
---

# [AGC070A] Multiples in the String

## 题目描述

本题为 **仅需输出** 类型的问题，所以没有输入数据。

请找出一对正整数 $X$ 和字符串 $S$，满足以下所有条件：

- $X$ 是一个大于等于 $10^{50}$ 且小于 $10^{5000}$ 的正整数。
- $S$ 是一个由数字 `0` 到 `9` 组成的字符串，长度不超过 $5000$。
- 对所有满足 $1 \leq i \leq 1000$ 的整数 $i$，都必须满足以下条件：
  - 对 $X$ 乘以 $i$ 后得到的十进制表示的数字，一定是 $S$ 的某个连续子串。

## 输出格式

请输出一组符合题目条件的 $(X, S)$。注意，至少存在一组这样的组合。
输出时，可以用带前导零的方式表示 $X$，但作为字符串的它的长度必须不超过 $5000$ 个字符。

> $X$ $S$

## 说明/提示

### 示例说明 1

以下是一个不符合条件的输出示例。这组数据不满足题目要求的原因有：
- $X$ 并不在题目设定的取值范围内。
- 当 $i = 1, 2$ 时，`5` 和 `10` 是 $S$ 的子串。然而，当 $i = 3$ 时，`15` 并不是 $S$ 的子串。因此，$(X, S)$ 不满足题目中的第三个条件。

 **本翻译由 AI 自动生成**

## 样例 #1

### 输入

```
None
```

### 输出

```
5

105
```



---

---
title: "[ARC157D] YY Garden"
layout: "post"
diff: 省选/NOI-
pid: AT_arc157_d
tag: ['数论', '组合数学']
---

# [ARC157D] YY Garden

## 题目描述

[problemUrl]: https://atcoder.jp/contests/arc157/tasks/arc157_d

$ H $ 行 $ W $ 列のマス目の各マスに `X`, `Y` のいずれかの文字が書かれています． 上から $ i $ 行目，左から $ j $ 列目のマスを $ (i,\ j) $ で表します． マス目に書かれている文字は $ H $ 個の文字列 $ S_1,\ S_2,\ \dots,\ S_H $ によって与えられ，$ S_i $ の $ j $ 文字目がマス $ (i,\ j) $ に書かれた文字を表します．

隣り合う各行および各列の間に，マス目全体を横断（縦断）するように柵を設置できます． 柵同士は交差しても構いません． 柵の設置後に，「あるマスから始めて上下左右に隣接するマスへの移動を繰り返すことで，柵を越えずに到達可能なマス全体」を**区画**と定義します． （出力例 1 の説明も参考にしてください．）

柵の設置方法は全部で $ 2^{H-1}\ \times\ 2^{W-1} $ 通りありますが，そのうち次の条件を満たすものの個数を $ 998244353 $ で割った余りを求めてください．

**条件:** 各区画には `Y` が書かれたマスがちょうど $ 2 $ 個含まれている．

## 输入格式

入力は以下の形式で標準入力から与えられる．

> $ H $ $ W $ $ S_1 $ $ S_2 $ $ \vdots $ $ S_H $

## 输出格式

条件を満たす柵の設置方法の総数を $ 998244353 $ で割った余りを出力せよ．

## 说明/提示

### 制約

- $ 1\ \leq\ H\ \leq\ 2000 $
- $ 1\ \leq\ W\ \leq\ 2000 $
- $ S_i\ (1\ \leq\ i\ \leq\ H) $ は `X`, `Y` からなる長さ $ W $ の文字列である．
 
### Sample Explanation 1

柵の設置方法として，以下の $ 8 $ 通りがあります． ``` X Y Y X|Y Y X Y|Y X|Y|Y | | | | Y X Y Y|X Y Y X|Y Y|X|Y X Y Y X|Y Y X Y|Y X|Y|Y ----- -+--- ---+- -+-+- Y X Y Y|X Y Y X|Y Y|X|Y ``` たとえば，$ 2,\ 3 $ 列目の間に柵を設置した場合，区画は ``` XY YX ``` ``` Y Y ``` であり，それぞれにちょうど $ 2 $ 個の `Y` が含まれているので，条件を満たします． また，$ 1,\ 2 $ 行目の間と $ 1,\ 2 $ 列目の間に柵を設置した場合，区画は ``` X ``` ``` YY ``` ``` Y ``` ``` XY ``` となり，$ 2 $ つ目の区画以外にはちょうど $ 2 $ 個の `Y` が含まれていないので，条件を満たしません．

### Sample Explanation 2

どのように柵を設置しても条件を満たしません．

### Sample Explanation 3

条件を満たす柵の設置方法の総数を $ 998244353 $ で割った余りを出力してください．

## 样例 #1

### 输入

```
2 3

XYY

YXY
```

### 输出

```
2
```

## 样例 #2

### 输入

```
2 3

XYX

YYY
```

### 输出

```
0
```

## 样例 #3

### 输入

```
2 58

YXXYXXYXXYXXYXXYXXYXXYXXYXXYXXYXXYXXYXXYXXYXXYXXYXXYXXYXXY

YXXYXXYXXYXXYXXYXXYXXYXXYXXYXXYXXYXXYXXYXXYXXYXXYXXYXXYXXY
```

### 输出

```
164036797
```



---

---
title: "[ARC158D] Equation"
layout: "post"
diff: 省选/NOI-
pid: AT_arc158_d
tag: ['数论', '随机化']
---

# [ARC158D] Equation

## 题目描述

[problemUrl]: https://atcoder.jp/contests/arc158/tasks/arc158_d

正整数 $ n $ および，$ 5 $ 以上の素数 $ p $ が与えられます．

次の条件をすべて満たす整数の組 $ (x,y,z) $ を 1 つ求めてください．

- $ 1\leq\ x\ <\ y\ <\ z\ \leq\ p\ -\ 1 $.
- $ (x+y+z)(x^n+y^n+z^n)(x^{2n}+y^{2n}+z^{2n})\ \equiv\ x^{3n}+y^{3n}+z^{3n}\pmod{p} $.
 
なお，このような組 $ (x,y,z) $ は必ず存在することが証明できます．

$ T $ 個のテストケースが与えられるので，それぞれについて答えを求めてください．

## 输入格式

入力は以下の形式で標準入力から与えられます．

> $ T $ $ \text{case}_1 $ $ \vdots $ $ \text{case}_T $

各テストケースは以下の形式で与えられます．

> $ n $ $ p $

## 输出格式

$ T $ 行出力してください．$ i $ 行目には $ i $ 番目のテストケースの解を $ (x,y,z) $ とするとき，$ x,y,z $ をこの順に空白区切りで出力してください．

解が複数存在する場合，どれを出力しても正解となります．

## 说明/提示

### 制約

- $ 1\leq\ T\leq\ 10^5 $
- $ 1\leq\ n\leq\ 10^9 $
- $ p $ は $ 5\leq\ p\leq\ 10^9 $ を満たす素数
 
### Sample Explanation 1

ひとつめのテストケースについて， - $ (x+y+z)(x^n+y^n+z^n)(x^{2n}+y^{2n}+z^{2n})\ =\ (1+4+6)(1+4+6)(1+16+36)\ =\ 6413 $ - $ x^{3n}+y^{3n}+z^{3n}\ =\ 1\ +\ 64\ +\ 216\ =\ 281 $ であり，$ 6413\equiv\ 281\pmod{7} $ なので，条件を満たしていることが確認できます．

## 样例 #1

### 输入

```
3

1 7

2 7

10 998244353
```

### 输出

```
1 4 6

1 2 5

20380119 21549656 279594297
```



---

---
title: "[ARC169D] Add to Make a Permutation"
layout: "post"
diff: 省选/NOI-
pid: AT_arc169_d
tag: ['数学', '贪心', '数论']
---

# [ARC169D] Add to Make a Permutation

## 题目描述

[problemUrl]: https://atcoder.jp/contests/arc169/tasks/arc169_d

長さ $ N $ の整数列 $ A=(A_1,A_2,\cdots,A_N) $ が与えられます． $ A $ の各要素は $ 0 $ 以上 $ N-1 $ 以下の整数です．

あなたは以下の操作を $ 0 $ 回以上行うことができます．

- $ A $ の中からちょうど $ M $ 個の要素を選ぶ． そして，選んだ要素の値をそれぞれ $ 1 $ 増加させる． 増加させたあとに値が $ N $ になっている要素があれば，その値を $ 0 $ に変更する．
 
あなたの目標は $ A $ を $ (0,1,\cdots,N-1) $ の順列にすることです． 目標が達成可能か判定し，可能ならば必要な最小の操作回数を求めてください．

## 输入格式

入力は以下の形式で標準入力から与えられる．

> $ N $ $ M $ $ A_1 $ $ A_2 $ $ \cdots $ $ A_N $

## 输出格式

目標が達成不可能な場合，$ -1 $ を出力せよ． 可能な場合，必要な最小の操作回数を出力せよ．

## 说明/提示

### 制約

- $ 2\ \leq\ N\ \leq\ 250000 $
- $ 1\ \leq\ M\ \leq\ N-1 $
- $ 0\ \leq\ A_i\ \leq\ N-1 $
- 入力される値はすべて整数．
 
### Sample Explanation 1

以下のように操作すると $ 2 $ 回の操作で目標を達成できます． - 初期状態: $ A=(0,1,1) $ - $ 1 $ 回目の操作: $ A_1,A_2 $ を選んで操作を行い，$ A=(1,2,1) $ になる． - $ 2 $ 回目の操作: $ A_2,A_3 $ を選んで操作を行い，$ A=(1,0,2) $ になる． $ 2 $ 回未満の操作で目標を達成することはできないため，答えは $ 2 $ になります．

## 样例 #1

### 输入

```
3 2

0 1 1
```

### 输出

```
2
```

## 样例 #2

### 输入

```
5 2

0 4 2 3 1
```

### 输出

```
0
```

## 样例 #3

### 输入

```
4 2

0 0 1 2
```

### 输出

```
-1
```

## 样例 #4

### 输入

```
20 15

5 14 18 0 8 5 0 10 6 5 11 2 10 10 17 9 8 14 4 4
```

### 输出

```
10
```



---

---
title: "[ARC172E] Last 9 Digits"
layout: "post"
diff: 省选/NOI-
pid: AT_arc172_e
tag: ['数学', '数论']
---

# [ARC172E] Last 9 Digits

## 题目描述

[problemUrl]: https://atcoder.jp/contests/arc172/tasks/arc172_e

$ n^n $ を $ 10^9 $ で割った余りが $ X $ となるような正の整数 $ n $ が存在するか判定し、存在する場合は最小のものを求めてください。

$ Q $ 個のテストケースが与えられるので、それぞれに対して答えてください。

## 输入格式

入力は以下の形式で標準入力から与えられます。ただし、$ i $ 個目 $ (1\ \leq\ i\ \leq\ Q) $ のテストケースにおける $ X $ の値を $ X_i $ とします。

> $ Q $ $ X_1 $ $ X_2 $ $ \vdots $ $ X_Q $

## 输出格式

$ Q $ 行にわたって出力してください。$ i $ 行目には、$ i $ 個目のテストケースに対する答えを出力してください。ただし、条件を満たす $ n $ が存在しない場合は答えを $ -1 $ とします。

## 说明/提示

### 制約

- $ 1\ \leq\ Q\ \leq\ 10000 $
- $ 1\ \leq\ X\ \leq\ 10^9\ -\ 1 $
- $ X $ は $ 2 $ の倍数でも $ 5 $ の倍数でもない
- 入力はすべて整数
 
### Sample Explanation 1

この入力例は $ 2 $ 個のテストケースからなります。 - $ 1 $ 個目：$ 3^3\ =\ 27 $ を $ 10^9 $ で割った余りは $ 27 $ なので、$ n\ =\ 3 $ で条件を満たします。 - $ 2 $ 個目：$ 11^{11}\ =\ 285311670611 $ を $ 10^9 $ で割った余りは $ 311670611 $ なので、$ n\ =\ 11 $ で条件を満たします。

## 样例 #1

### 输入

```
2

27

311670611
```

### 输出

```
3

11
```



---

---
title: "[ARC185C] Sum of Three Integers"
layout: "post"
diff: 省选/NOI-
pid: AT_arc185_c
tag: ['多项式', '快速傅里叶变换 FFT', '快速数论变换 NTT']
---

# [ARC185C] Sum of Three Integers

## 题目描述

[problemUrl]: https://atcoder.jp/contests/arc185/tasks/arc185_c

整数列 $ A\ =\ (A_1,\ A_2,\ \dots,\ A_N) $ および整数 $ X $ が与えられます。  
 次の条件を全て満たす整数の組 $ (i,\ j,\ k) $ を $ 1 $ 組出力してください。条件を満たす組が存在しない場合はそのことを報告してください。

- $ 1\ \leq\ i\ \lt\ j\ \lt\ k\ \leq\ N $
- $ A_i\ +\ A_j\ +\ A_k\ =\ X $

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ X $ $ A_1 $ $ A_2 $ $ \dots $ $ A_N $

## 输出格式

条件を満たす整数の組 $ (i,\ j,\ k) $ が存在する場合、以下の形式で出力せよ。答えが複数ある場合はどれを出力しても良い。

> $ i $ $ j $ $ k $

条件を満たす整数の組が存在しない場合、`-1` を出力せよ。

## 说明/提示

### 制約

- $ 3\ \leq\ N\ \leq\ 10^6 $
- $ 1\ \leq\ X\ \leq\ 10^6 $
- $ 1\ \leq\ A_i\ \leq\ X $
- 入力される値は全て整数
 
### Sample Explanation 1

$ (i,\ j,\ k)\ =\ (1,\ 3,\ 4) $ は $ 1\ \leq\ i\ \lt\ j\ \lt\ k\ \leq\ N $ かつ $ A_i\ +\ A_j\ +\ A_k\ =\ 1\ +\ 5\ +\ 10\ =\ 16\ =\ X $ を満たします。

## 样例 #1

### 输入

```
5 16

1 8 5 10 13
```

### 输出

```
1 3 4
```

## 样例 #2

### 输入

```
5 20

1 8 5 10 13
```

### 输出

```
-1
```

## 样例 #3

### 输入

```
10 100000

73766 47718 74148 49218 76721 31902 21994 18880 29598 98917
```

### 输出

```
4 6 8
```



---

---
title: "Exact Number of Drops"
layout: "post"
diff: 省选/NOI-
pid: AT_icpc2015summer_day3_e
tag: ['数论', '扩展欧几里德算法']
---

# Exact Number of Drops

## 题目描述

给定两个容量分别为 $a$ 滴水和 $b$ 滴水的杯子（开始时均为空），每步都做以下操作之一：

- 将某个杯子倒空；
- 将某个杯子装满；
- 将一个杯子的水倒到另一个杯子，直到第一个杯子倒空或者第二个杯子装满。   

求使得任意一个杯子装上恰好 $c$ 滴水的最少步数。

## 输入格式

**本题有多组数据**。   
第一行一个整数 $T (1 \leq T \leq 10^{5})$ ，表示数据组数。  
对于每组数据：

## 输出格式

对每组数据，输出一行一个整数，表示使得任意一个杯子装上恰好 $c$ 滴水的最少步数。  
如果无法做到，请输出 $-1$ 。



---


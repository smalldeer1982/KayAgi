---
title: "[AGC001D] Arrays and Palindrome"
layout: "post"
diff: 省选/NOI-
pid: AT_agc001_d
tag: ['图论', '构造']
---

# [AGC001D] Arrays and Palindrome

## 题目描述

高桥くん的母亲在高桥生日的时候送了他 $a, b$ 两个数列。因为 $a, b$ 满足了如下的所有性质， 所以他非常高兴：

* $a$ 数列的数字总和是 $N$；
* $b$ 数列的数字总和是 $N$；
* $a, b$ 中包含的数都是正整数； 
* 满足以下两个条件的数列， 所有元素必定是相同的。
  * 最开始的 $a_1$ 个元素, 接下来的 $a_2$ 个元素，更后面的 $a_3$ 个，等等，都是回文；
  * 最开始的 $b_1$ 个元素, 接下来的 $b_2$ 个元素，更后面的 $b_3$ 个，等等，都是回文。

但是有一天，高桥把把数列 $a$ 和 $b$ 都弄丢了， 幸运的是，他知道数列 $a$ 是另一个长度为 $M$ 的序列 $A$ 的排列。

为了让他再一次高兴起来， 他妈妈决定给他另一对数列使其满足如上性质。

## 输入格式

>
>第一行两个整数 $N, M$。
>
>之后一行，第 $i$ 个整数是 $A_i$。
>

## 输出格式

>
>如果存在解， 输出三行，第一行数列 $a$，第二行 $b$ 的长度，第三行数列 $b$。
>
>否则输出 `Impossible`（大小写敏感！）。

感谢 @ToBiChi 提供翻译。

## 说明/提示

- $1≤N≤10^5$；
- $1≤M≤100$；
- $1≤A_i≤10^5$。

数据保证 $A_i$ 的和是 $N$。

## 样例 #1

### 输入

```
3 2

2 1
```

### 输出

```
1 2

1

3
```

## 样例 #2

### 输入

```
6 1

6
```

### 输出

```
6

3

1 2 3
```

## 样例 #3

### 输入

```
55 10

1 2 3 4 5 6 7 8 9 10
```

### 输出

```
Impossible
```



---

---
title: "[AGC002E] Candy Piles"
layout: "post"
diff: 省选/NOI-
pid: AT_agc002_e
tag: ['模拟', '博弈论', '图论建模', '构造']
---

# [AGC002E] Candy Piles

## 题目描述

[problemUrl]: https://atcoder.jp/contests/agc002/tasks/agc002_e



## 样例 #1

### 输入

```
2
1 3

```

### 输出

```
First
```

## 样例 #2

### 输入

```
3
1 2 1

```

### 输出

```
First
```

## 样例 #3

### 输入

```
3
1 2 3

```

### 输出

```
Second
```



---

---
title: "[AGC003F] Fraction of Fractal"
layout: "post"
diff: 省选/NOI-
pid: AT_agc003_f
tag: ['矩阵乘法', '构造']
---

# [AGC003F] Fraction of Fractal

## 题目描述

[problemUrl]: https://atcoder.jp/contests/agc003/tasks/agc003_f

高橋君はお母さんからグリッドをもらいました。このグリッドは縦 $ H $ マス×横 $ W $ マスからなり、各マスは黒か白で塗られています。 黒いマス全体は、縦横にひとつながりになっています。

このグリッドの $ i $ 行 $ j $ 列 $ (1\ ≦\ i\ ≦\ H,\ 1\ ≦\ j\ ≦\ W) $ のマスの情報は、縦横に並んだ文字 $ s_{ij} $ であらわされ、 $ s_{ij} $ が `#` のときこのマスが黒く、 `.` のとき白く塗られていることを表します。少なくともひとつのマスが黒く塗られています。

レベル $ 0 $ のフラクタルとは黒いマスひとつからなる $ 1\ ×\ 1 $ のグリッドであり、 レベル $ k+1 $ のフラクタルとは、レベル $ k $ のフラクタルを、お母さんからもらったグリッドの全ての黒いマスに相当する位置に並べ、白いマスに相当する位置は白いマスで埋めたものを指します。

お母さんからもらったグリッドの情報と整数 $ K $ が与えられるので、レベル $ K $ のフラクタルに黒いマスからなる連結成分がいくつあるかを $ 10^9+7 $ で割ったあまりを求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ H $ $ W $ $ K $ $ s_{11}\ ..\ s_{1W} $ : $ s_{H1}\ ..\ s_{HW} $

## 输出格式

レベル $ K $ のフラクタルにある黒いマスからなる連結成分の個数を $ 10^9+7 $ で割ったあまりを一行に出力せよ。

## 说明/提示

### 制約

- $ 1\ ≦\ H,W\ ≦\ 1000 $
- $ 0\ ≦\ K\ ≦\ 10^{18} $
- $ s_{ij} $ は `#` か `.` のいずれかである。
- `#` のマス全体は縦横に連結である。
- `#` のマスは少なくともひとつ存在する。

### Sample Explanation 1

この入力例で作られるフラクタルは、以下のようなものです。この黒マスからなる連結成分の数は $ 20 $ なので、$ 20 $ を出力します。 ``` .............#............. ............###............ ............#.#............ ..........#..#..#.......... .........#########......... .........#.##.##.#......... ..........#.....#.......... .........###...###......... .........#.#...#.#......... ....#........#........#.... ...###......###......###... ...#.#......#.#......#.#... .#..#..#..#..#..#..#..#..#. ########################### #.##.##.##.##.##.##.##.##.# .#.....#..#.....#..#.....#. ###...######...######...### #.#...#.##.#...#.##.#...#.# ....#.................#.... ...###...............###... ...#.#...............#.#... .#..#..#...........#..#..#. #########.........######### #.##.##.#.........#.##.##.# .#.....#...........#.....#. ###...###.........###...### #.#...#.#.........#.#...#.# ```

## 样例 #1

### 输入

```
3 3 3

.#.

###

#.#
```

### 输出

```
20
```

## 样例 #2

### 输入

```
3 3 3

###

#.#

###
```

### 输出

```
1
```

## 样例 #3

### 输入

```
11 15 1000000000000000000

.....#.........

....###........

....####.......

...######......

...#######.....

..##.###.##....

..##########...

.###.....####..

.####...######.

###############

#.##..##..##..#
```

### 输出

```
301811921
```



---

---
title: "[AGC021C] Tiling"
layout: "post"
diff: 省选/NOI-
pid: AT_agc021_c
tag: ['构造']
---

# [AGC021C] Tiling

## 题目描述

[problemUrl]: https://atcoder.jp/contests/agc021/tasks/agc021_c

高橋君は、縦 $ N $ マス横 $ M $ マスのマス目を持っています。 次の条件をすべて満たすように、縦 $ 1 $ マス横 $ 2 $ マスのタイル $ A $ 枚と、縦 $ 2 $ マス横 $ 1 $ マスのタイル $ B $ 枚を マス目に置くことができるかどうかを判定し、可能なら置き方をひとつ構成してください。

- マス目の上に、全てのタイルを置かなければならない。
- タイルはマス目からはみ出してはならず、また異なるタイル同士が重なってはならない。
- マス目やタイルを回転させてはならない。
- 全てのタイルは、マス目のちょうど $ 2 $ マスを完全に覆う。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ M $ $ A $ $ B $

## 输出格式

タイルを全て置くことができない場合、`NO` を出力せよ。 そうでない場合、以下のように出力せよ。

> YES $ c_{11}...c_{1M} $ $ : $ $ c_{N1}...c_{NM} $

ただし、$ c_{ij} $ はマス目の $ i $ 行 $ j $ 列目の状態を表し、文字 `.`,`<`.`>`,`^`,`v` のいずれかでなければならない。

$ c_{ij} $ が、

- `.` のとき、マス目の $ i $ 行 $ j $ 列目はタイルで覆われていないことを、
- `<` のとき、マス目の $ i $ 行 $ j $ 列目は縦 $ 1 $ マス、横 $ 2 $ マスのタイルの左半分で覆われていることを、
- `>` のとき、マス目の $ i $ 行 $ j $ 列目は縦 $ 1 $ マス、横 $ 2 $ マスのタイルの右半分で覆われていることを、
- `^` のとき、マス目の $ i $ 行 $ j $ 列目は縦 $ 2 $ マス、横 $ 1 $ マスのタイルの上半分で覆われていることを、
- `v` のとき、マス目の $ i $ 行 $ j $ 列目は縦 $ 2 $ マス、横 $ 1 $ マスのタイルの下半分で覆われていることを、

それぞれ表す。

## 说明/提示

### 制約

- $ 1\ \leq\ N,M\ \leq\ 1000 $
- $ 0\ \leq\ A,B\ \leq\ 500000 $
- $ N,M,A,B $ は整数である

### Sample Explanation 1

縦 $ 3 $ マス横 $ 4 $ マスのマス目に、縦 $ 1 $ マス横 $ 2 $ マスのタイル $ 4 $ 枚と、縦 $ 2 $ マス横 $ 1 $ マスのタイル $ 2 $ 枚を置く方法の一例として、 出力例のようなものがあります。

## 样例 #1

### 输入

```
3 4 4 2
```

### 输出

```
YES

<><>

^<>^

v<>v
```

## 样例 #2

### 输入

```
4 5 5 3
```

### 输出

```
YES

<>..^

^.<>v

v<>.^

<><>v
```

## 样例 #3

### 输入

```
7 9 20 20
```

### 输出

```
NO
```



---

---
title: "[AGC031C] Differ by 1 Bit"
layout: "post"
diff: 省选/NOI-
pid: AT_agc031_c
tag: ['构造']
---

# [AGC031C] Differ by 1 Bit

## 题目描述

[problemUrl]: https://atcoder.jp/contests/agc031/tasks/agc031_c

整数 $ N,\ A,\ B $ が与えられます。 $ (0,\ 1,\ ...\ 2^N-1) $ の順列 $ (P_0,\ P_1,\ ...\ P_{2^N-1}) $ であって、 次の条件をすべて満たすものが存在するかどうか判定してください。 また、存在するなら $ 1 $ つ構成してください。

- $ P_0=A $
- $ P_{2^N-1}=B $
- すべての $ 0\ \leq\ i\ <\ 2^N-1 $ について、$ P_i $ と $ P_{i+1} $ は $ 2 $ 進数表記でちょうど $ 1 $ 桁だけ異なる。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ A $ $ B $

## 输出格式

条件を満たす順列が存在しないならば `NO` と出力せよ。

存在するならば、まず $ 1 $ 行目に `YES` と出力せよ。 そして $ 2 $ 行目に $ (P_0,\ P_1,\ ...\ P_{2^N-1}) $ を空白区切りで出力せよ。 なお、解が複数個存在する場合はどれを出力してもよい。

## 说明/提示

### 制約

- $ 1\ \leq\ N\ \leq\ 17 $
- $ 0\ \leq\ A\ \leq\ 2^N-1 $
- $ 0\ \leq\ B\ \leq\ 2^N-1 $
- $ A\ \neq\ B $
- 入力される値はすべて整数である。

### Sample Explanation 1

$ P=(1,0,2,3) $ を $ 2 $ 進数表記すると $ (01,00,10,11) $ となり、どの隣り合う $ 2 $ 要素もちょうど $ 1 $ 桁だけ異なります。

## 样例 #1

### 输入

```
2 1 3
```

### 输出

```
YES

1 0 2 3
```

## 样例 #2

### 输入

```
3 2 1
```

### 输出

```
NO
```



---

---
title: "[AGC035C] Skolem XOR Tree"
layout: "post"
diff: 省选/NOI-
pid: AT_agc035_c
tag: ['位运算', '构造']
---

# [AGC035C] Skolem XOR Tree

## 题目描述

[problemUrl]: https://atcoder.jp/contests/agc035/tasks/agc035_c

整数 $ N $ が与えられます。$ 1 $ から $ 2N $ までの番号がついた $ 2N $ 個の頂点を持つ木であって次の条件を満たすものが存在するか判定し、存在するならばその一例を示してください。

- $ 1 $ 以上 $ N $ 以下の各整数 $ i $ について、頂点 $ i,\ N+i $ の重みが $ i $ であるとする。このとき、$ 1 $ 以上 $ N $ 以下の各整数 $ i $ について、頂点 $ i,\ N+i $ 間のパス上にある頂点 (両端を含む) の重みのビットごとの排他的論理和が $ i $ である。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $

## 输出格式

問題文中の条件を満たす木が存在するならば `Yes` を、そうでなければ `No` を出力せよ。 その後、存在するならば続く $ 2N-1 $ 行にそのような木の $ 2N-1 $ 本の辺を以下の形式で出力せよ。

> $ a_{1} $ $ b_{1} $ $ \vdots $ $ a_{2N-1} $ $ b_{2N-1} $

ここで、各組 $ (a_i,\ b_i) $ は木に頂点 $ a_i,\ b_i $ を結ぶ辺が存在することを表す。辺は任意の順で出力して構わない。

## 说明/提示

### 制約

- 入力は全て整数
- $ 1\ \leq\ N\ \leq\ 10^{5} $

### Sample Explanation 1

\- 出力例は以下のグラフを表します。 !\[d004b05438497d50637b534e89f7a511.png\](https://img.atcoder.jp/agc035/d004b05438497d50637b534e89f7a511.png)

### Sample Explanation 2

\- 条件を満たす木が存在しません。

## 样例 #1

### 输入

```
3
```

### 输出

```
Yes

1 2

2 3

3 4

4 5

5 6
```

## 样例 #2

### 输入

```
1
```

### 输出

```
No
```



---

---
title: "[AGC050A] AtCoder Jumper"
layout: "post"
diff: 省选/NOI-
pid: AT_agc050_a
tag: ['构造', 'Ad-hoc']
---

# [AGC050A] AtCoder Jumper

## 题目描述

你有注意过 AtCoder 的这个部分吗？

![](https://img.atcoder.jp/agc050/2a140890f3297cce737744ff4d2f296d.png)

这里的序号，是在考虑了提高任意两个页面间跳转的速度和每个页面不显示太多的选项这两个因素，并精心考虑之后选出来的。在这个问题，你需要在每个页面只有 **两个链接** 的前提下实现类似的功能。

Snuke 制作了一个有 $N$ 个页面的网站，分别标号为 $1$ 到 $N$ 。对每个 $i(1\le i \le N)$ ，选出两个正整数 $a_i$ 和 $b_i(1\le a_i \le N)$ ，把通往第 $a_i$ 个页面和通往第 $b_i$ 个页面的链接加入页面 $i$ 。这个网站必须满足以下的要求：

- 你必须能够在最多点击 $10$ 个链接后从任意的一个页面跳转到任意的另一个页面。

在这个问题的限制条件下，我们可以证明这是一定可行的。

## 输入格式

一行一个整数 $N$，代表页面的个数。

## 输出格式

输出 $N$ 行，每行两个整数，第 $i$ 行的两个整数分别代表 $a_i$ 和 $b_i$ 。

如果有多个答案，你可以输出任意一个。

## 说明/提示

- $1 \le N \le 1000$

#### 样例解释 1

Snuke 做了一个只有一个页面的网站。这个页面的两个链接都指向它自己。

#### 样例解释 2

这样设置链接的话，不管哪个页面都有直接指向其他所有页面的链接。

## 样例 #1

### 输入

```
1
```

### 输出

```
1 1
```

## 样例 #2

### 输入

```
3
```

### 输出

```
2 3

1 3

1 2
```



---

---
title: "[AGC052B] Tree Edges XOR"
layout: "post"
diff: 省选/NOI-
pid: AT_agc052_b
tag: ['树的遍历', '位运算', '构造']
---

# [AGC052B] Tree Edges XOR

## 题目描述

[problemUrl]: https://atcoder.jp/contests/agc052/tasks/agc052_b

$ N $ 頂点の木が与えられます。ここで、$ N $ は **奇数** です。 木の頂点には $ 1 $ から $ N $ までの、辺には $ 1 $ から $ N-1 $ までの番号が付けられています。 辺 $ i $ は頂点 $ u_i,\ v_i $ を結び、初期状態での重みは $ w^1_i $ です。

あなたは、次の操作を何度でも行えます。

- 木から辺 $ (u,\ v) $ を選ぶ。この辺の現在の重みが $ w $ であるとする。$ u,\ v $ のいずれかちょうど一方に接続する各辺について、その重みを $ w $ との **XOR** に置き換える（操作前の辺の重みが $ w_1 $ であるとすると、操作後の重みは $ w_1\ \oplus\ w $ となる）。

あなたの目標は、各辺 $ i $ の重みを $ w^2_i $ とすることです。 上記の操作を何度でも行えるとして、目標の達成が可能か判定してください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ u_1 $ $ v_1 $ $ w^1_1 $ $ w^2_1 $ $ u_2 $ $ v_2 $ $ w^1_2 $ $ w^2_2 $ $ \vdots $ $ u_{N-1} $ $ v_{N-1} $ $ w^1_{N-1} $ $ w^2_{N-1} $

## 输出格式

目標とする重みの割り当てに初期状態から至ることが可能であれば `YES`、そうでなければ `NO` と出力せよ。 なお、正誤判定器は英大文字と英小文字を区別せず、どちらも受理する。

## 说明/提示

### 制約

- $ 1\ \le\ N\ \le\ 10^5 $
- $ N $ は奇数である。
- $ 1\le\ u_i,\ v_i\ \le\ N $
- $ u_i\ \neq\ v_i $
- $ 0\le\ w^1_i,\ w^2_i\ <\ 2^{30} $
- 入力中の値は全て整数である。
- 入力が表すグラフは木である。

### Sample Explanation 1

辺 $ 1 $ に対して操作を行うと、辺 $ 2 $ の重みが $ 8\ \oplus\ 1=9 $ となります。

## 样例 #1

### 输入

```
3

1 2 1 1

2 3 8 9
```

### 输出

```
YES
```

## 样例 #2

### 输入

```
5

1 2 0 3

1 3 1 0

1 4 2 1

1 5 0 0
```

### 输出

```
NO
```



---

---
title: "[AGC063C] Add Mod Operations"
layout: "post"
diff: 省选/NOI-
pid: AT_agc063_c
tag: ['构造']
---

# [AGC063C] Add Mod Operations

## 题目描述

[problemUrl]: https://atcoder.jp/contests/agc063/tasks/agc063_c

非負整数列 $ A\ =\ (A_1,\ \ldots,\ A_N) $ および $ B=(B_1,\ \ldots,\ B_N) $ が与えられます．

以下の操作を $ 0 $ 回以上 $ N $ 回以下行うことで，$ A $ を $ B $ に一致させることができるか否かを判定してください．

- 操作：$ 0\leq\ x\ <\ y\leq\ 10^{18} $ を満たす整数 $ x,y $ を選ぶ．すべての $ i $ に対して，$ A_i $ を $ (A_i+x)\bmod\ y $ に置き換える．
 
$ A $ を $ B $ に一致させることが可能な場合には，そのような手順をひとつ出力してください．

## 输入格式

入力は以下の形式で標準入力から与えられます．

> $ N $ $ A_1 $ $ \ldots $ $ A_N $ $ B_1 $ $ \ldots $ $ B_N $

## 输出格式

$ 0 $ 回以上 $ N $ 回以下の操作で $ A $ を $ B $ に一致させることが不可能な場合には，`No` と出力してください．

 ```
No
```

可能な場合には，操作手順を次の形式で出力してください．

> Yes $ K $ $ x_1 $ $ y_1 $ $ \vdots $ $ x_K $ $ y_K $

ここで $ K $ は操作回数で，$ x_i,\ y_i $ は $ i $ 回目の操作で選ぶ整数 $ x,y $ を表します．これらは次を満たす必要があります．

- $ 0\leq\ K\leq\ N $
- $ 0\leq\ x_i\ <\ y_i\ \leq\ 10^{18} $
 
条件を満たす操作手順が複数存在する場合には，そのどれを出力しても正解と見なされます．

## 说明/提示

### 制約

- $ 1\leq\ N\leq\ 1000 $
- $ 0\leq\ A_i\leq\ 10^9 $
- $ 0\leq\ B_i\leq\ 10^9 $
 
### Sample Explanation 1

次のようにして $ A $ を $ B $ に一致させることができます． - はじめ $ A\ =\ (7,2,4,5) $ です． - $ (x,y)\ =\ (3,5) $ として操作を行うと，$ A\ =\ (0,0,2,3) $ になります． - $ (x,y)\ =\ (3,6) $ として操作を行うと，$ A\ =\ (3,3,5,0) $ になります．

## 样例 #1

### 输入

```
4

7 2 4 5

3 3 5 0
```

### 输出

```
Yes

2

3 5

3 6
```

## 样例 #2

### 输入

```
1

5

3
```

### 输出

```
Yes

1

2 4
```

## 样例 #3

### 输入

```
2

3 1

3 1
```

### 输出

```
Yes

0
```

## 样例 #4

### 输入

```
2

0 0

1 2
```

### 输出

```
No
```



---

---
title: "[AGC065C] Avoid Half Sum"
layout: "post"
diff: 省选/NOI-
pid: AT_agc065_c
tag: ['数学', '构造', 'Ad-hoc']
---

# [AGC065C] Avoid Half Sum

## 题目描述

[problemUrl]: https://atcoder.jp/contests/agc065/tasks/agc065_c

長さ $ N $ の非負整数列 $ A=(A_1,A_2,\dots,A_N) $ が与えられます。ここで、 $ S=\sum_{i=1}^{N}\ A_i $ は偶数です。

以下の条件を満たす長さ $ N $ の非負整数列の組 $ B=(B_1,B_2,\dots,B_N),\ C=(C_1,C_2,\dots,C_N) $ が存在するか判定してください。

- $ i=1,2,\dots,N $ に対し $ B_i+C_i=A_i $ が成り立つ
- $ i=1,2,\dots,N $ に対し $ X_i=B_i $ または $ X_i=C_i $ が成り立つ任意の長さ $ N $ の整数列 $ X=(X_1,X_2,\dots,X_N) $ に対し、 $ \sum_{i=1}^{N}\ X_i\ \neq\ \frac{S}{2} $ である
 
$ T $ 個のテストケースについて答えてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ T $ $ \mathrm{case}_1 $ $ \vdots $ $ \mathrm{case}_T $

各ケースは以下の形式で与えられる。

> $ N $ $ A_1 $ $ A_2 $ $ \dots $ $ A_N $

## 输出格式

$ T $ 行出力せよ。$ i $ 行目には $ i $ 番目のテストケースについて、条件を満たすものが存在する場合は `Yes` を、存在しない場合は `No` を出力せよ。

## 说明/提示

### 制約

- $ 1\ \leq\ T $
- $ 1\ \leq\ N\ \leq\ 2\ \times\ 10^5 $
- $ 1\ \leq\ A_i\ \leq\ 10^9 $
- $ \sum_{i=1}^{N}\ A_i $ は偶数
- $ 1 $ つの入力に含まれるテストケースについて、 $ N $ の総和は $ 2\ \times\ 10^5 $ 以下
- 入力される値はすべて整数
 
### Sample Explanation 1

$ 1 $ つ目のテストケースについて、 $ B=(1,1,3),\ C=(0,1,0) $ とすると条件を満たします。 $ 2 $ つ目のテストケースについて、条件を満たす $ B,C $ の組は存在しません。

## 样例 #1

### 输入

```
3

3

1 2 3

6

1 1 2 2 3 3

4

1 1 1000000000 1000000000
```

### 输出

```
Yes

No

Yes
```



---

---
title: "[ARC160E] Make Biconnected"
layout: "post"
diff: 省选/NOI-
pid: AT_arc160_e
tag: ['双连通分量', '构造']
---

# [ARC160E] Make Biconnected

## 题目描述

[problemUrl]: https://atcoder.jp/contests/arc160/tasks/arc160_e

$ N $ 頂点の無向木 $ G $ が与えられます。**$ G $ の全ての頂点の次数は $ 3 $ 以下です。**   
 頂点には $ 1 $ から $ N $ の番号がついています。辺には $ 1 $ から $ N-1 $ までの番号がついていて、辺 $ i $ は頂点 $ u_i $ と頂点 $ v_i $ を結んでいます。  
 また、全ての頂点には重みが設定されていて、頂点 $ i $ の重みは $ W_i $ です。

あなたは $ G $ に $ 0 $ 本以上の辺を追加します。頂点 $ i $ と頂点 $ j $ の間に辺を追加すると $ W_i\ +\ W_j $ のコストがかかります。

次の条件を満たすように辺を追加する方法のうち、コストの総和が最小である方法を $ 1 $ つ出力してください。

- $ G $ は二重頂点連結である。つまり、$ G $ 内の任意の頂点 $ v $ について、$ G $ から頂点 $ v $ および $ v $ に隣接する辺を取り除いても $ G $ は連結な状態を保っている。
 
$ T $ 個のテストケースが与えられるので、それぞれについて答えてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。ここで、$ \mathrm{case}_i $ は $ i $ 番目のテストケースを意味する。

> $ T $ $ \mathrm{case}_1 $ $ \mathrm{case}_2 $ $ \vdots $ $ \mathrm{case}_N $

各テストケースは以下の形式で与えられる。

> $ N $ $ W_1 $ $ W_2 $ $ \dots $ $ W_N $ $ u_1 $ $ v_1 $ $ u_2 $ $ v_2 $ $ \vdots $ $ u_{N-1} $ $ v_{N-1} $

## 输出格式

各テストケースについて、以下の形式で答えを出力せよ。ここで、

- 追加する辺の本数は $ M $ 本で、
- $ i $ 本目の追加する辺は頂点 $ a_i $ と頂点 $ b_i $ を結んでいる
 
とする。

答えが複数ある場合は、どれを出力しても正答とみなされる。

> $ M $ $ a_1 $ $ b_1 $ $ a_2 $ $ b_2 $ $ \vdots $ $ a_M $ $ b_M $

## 说明/提示

### 制約

- $ 1\ \leq\ T\ \leq\ 2\ \times\ 10^5 $
- $ 3\ \leq\ N\ \leq\ 2\ \times\ 10^5 $
- $ 1\ \leq\ u_i,\ v_i\ \leq\ N $
- 入力で与えられるグラフは木
- 入力で与えられるグラフにおいて、全ての頂点は次数が $ 3 $ 以下
- $ 1\ \leq\ W_i\ \leq\ 10^9 $
- $ W_i $ は整数
- 全てのテストケースにおける $ N $ の総和は $ 2\ \times\ 10^5 $ 以下
 
### Sample Explanation 1

$ 1 $ 番目のテストケースでは、頂点 $ 1 $ と頂点 $ 3 $ を結ぶ辺を張ると $ G $ が問題文の条件を満たします。 この時、コストは $ W_1\ +\ W_3\ =\ 2\ +\ 5\ =\ 7 $ になります。 コストが $ 7 $ 未満で条件を満たす辺の張り方は存在しないため、これが答えになります。 $ 2 $ 番目のテストケースでは、コストの総和は $ (W_7\ +\ W_6)\ +\ (W_1\ +\ W_5)\ =\ 1100000\ +\ 10001\ =\ 1110001 $ になり、これが最小です。

## 样例 #1

### 输入

```
2

3

2 3 5

1 2

2 3

7

1 10 100 1000 10000 100000 1000000

1 2

2 3

2 4

3 5

3 6

4 7
```

### 输出

```
1

1 3

2

7 6

1 5
```



---

---
title: "[ARC167E] One Square in a Triangle"
layout: "post"
diff: 省选/NOI-
pid: AT_arc167_e
tag: ['数学', '构造', '标签482']
---

# [ARC167E] One Square in a Triangle

## 题目描述

[problemUrl]: https://atcoder.jp/contests/arc167/tasks/arc167_e

以下の条件を全て満たす $ xy $ 平面上の三角形 $ ABC $ を良い三角形とします。

- 頂点 $ A,B,C $ はいずれも、$ x $ 座標 $ \cdot $ $ y $ 座標がどちらも $ 0 $ 以上 $ 10^{8} $ 以下の格子点である。
- 全ての頂点が格子点である面積 $ 1 $ の正方形のうち、三角形 $ ABC $ の内部 (周上及び頂点を**含む**) に全体が含まれているものはちょうど $ 1 $ つ
 
正の整数 $ S $ が与えられます。

良い三角形のうち面積が $ \frac{S}{2} $ であるものが存在するか判定し、存在するなら $ 1 $ つ構築してください。

$ 1 $ つの入力ファイルにつき $ T $ 個のテストケースが与えられるので、それぞれについて解いてください。

## 输入格式

入力は以下の形式で標準入力から与えられます。

> $ T $ $ \text{case}_{1} $ $ \text{case}_{2} $ $ \vdots $ $ \text{case}_{T} $

各ケースは以下の形式で与えられます。

> $ S $

## 输出格式

各ケースに対し、面積 $ \frac{S}{2} $ の良い三角形が存在しない場合は `No` と、存在する場合は以下の形式で答えを出力してください。

> Yes $ AX $ $ AY $ $ BX $ $ BY $ $ CX $ $ CY $

ただし、 $ AX,BX,CX $ を $ A,B,C $ の $ x $ 座標、 $ AY,BY,CY $ を $ A,B,C $ の $ y $ 座標とします。

`Yes`, `No` を出力する際、各文字は英大文字・小文字のいずれでも良いです。 解が複数存在する場合はどれを出力しても正解とみなされます。

## 说明/提示

### 制約

- $ 1\leq\ T\leq\ 10^{5} $
- $ 1\leq\ S\leq\ 10^{8} $
- 入力は全て整数
 
### Sample Explanation 1

![](https://img.atcoder.jp/arc167/d6986726412312ca9a6e022bc8e722ce.png) 図の左側の三角形は $ 2 $ 番目のテストケース、右側の三角形は $ 3 $ 番目のテストケースに対応しています。

## 样例 #1

### 输入

```
3

1

4

15
```

### 输出

```
No

Yes

1 1 1 3 3 3

Yes

5 1 7 8 4 5
```



---

---
title: "[ARC183D] Keep Perfectly Matched"
layout: "post"
diff: 省选/NOI-
pid: AT_arc183_d
tag: ['贪心', '构造']
---

# [ARC183D] Keep Perfectly Matched

## 题目描述

[problemUrl]: https://atcoder.jp/contests/arc183/tasks/arc183_d

$ 1 $ から $ N $ までの番号のついた $ N $ 頂点からなる木があります． $ i $ 番目の辺は頂点 $ A_i $ と頂点 $ B_i $ を結ぶ辺です． ここで $ N $ は偶数で，さらにこの木は完全マッチングを持ちます． 具体的には，各 $ i $ ($ 1\ \leq\ i\ \leq\ N/2 $) に対し，$ A_i=i\ \times\ 2-1,B_i=i\ \times\ 2 $ が保証されます．

あなたは以下の操作を $ N/2 $ 回行います．

- 葉 (次数がちょうど $ 1 $ の頂点) を $ 2 $ つ選び，木から削除する． ただしここで，削除したあとの木も完全マッチングを持つ必要がある． なお，この問題では頂点が $ 0 $ 個の場合も木と呼ぶことにする．
 
各操作について，そのスコアを「選んだ $ 2 $ つの頂点の間の距離 (その $ 2 $ つの頂点を結ぶ単純パス上の辺の個数) 」とします．

スコアの合計を最大化するような手順を $ 1 $ つ示してください． なお，この問題の制約下で $ N/2 $ 回の操作を完了する手順が常に存在することが証明できます．

## 输入格式

入力は標準入力から以下の形式で与えられる。

> $ N $ $ A_1 $ $ B_1 $ $ A_2 $ $ B_2 $ $ \vdots $ $ A_{N-1} $ $ B_{N-1} $

## 输出格式

答えを以下の形式で出力せよ．

> $ X_1 $ $ Y_1 $ $ X_2 $ $ Y_2 $ $ \vdots $ $ X_{N/2} $ $ Y_{N/2} $

ここで，$ X_i,Y_i $ は $ i $ 回目の操作で選ぶ $ 2 $ つの頂点である． 解が複数存在する場合，どれを出力しても構わない．

## 说明/提示

### 制約

- $ 2\ \leq\ N\ \leq\ 250000 $
- $ N $ は偶数
- $ 1\ \leq\ A_i\ <\ B_i\ \leq\ N $ ($ 1\ \leq\ i\ \leq\ N-1 $)
- $ A_i=i\ \times\ 2\ -1,B_i=i\ \times\ 2 $ ($ 1\ \leq\ i\ \leq\ N/2 $)
- 与えられるグラフは木である
- 入力される値はすべて整数
 
### Sample Explanation 1

出力例の手順は以下の通りです． - $ 1 $ 回目の操作: 頂点 $ 4,1 $ を消す．残る木は頂点 $ 2,3 $ からなり，完全マッチングを持つ．操作のスコアは $ 3 $ である． - $ 2 $ 回目の操作: 頂点 $ 2,3 $ を消す．残る木は $ 0 $ 頂点からなり，完全マッチングを持つ．操作のスコアは $ 1 $ である． - スコアの合計は $ 3+1=4 $ になる． スコアの合計を $ 4 $ より大きくすることはできないので，この入力例はこの出力で正解できます．

## 样例 #1

### 输入

```
4

1 2

3 4

2 3
```

### 输出

```
4 1

2 3
```

## 样例 #2

### 输入

```
8

1 2

3 4

5 6

7 8

2 3

1 5

1 7
```

### 输出

```
4 8

7 6

5 3

2 1
```

## 样例 #3

### 输入

```
14

1 2

3 4

5 6

7 8

9 10

11 12

13 14

2 8

4 11

5 12

7 13

11 14

9 13
```

### 输出

```
1 6

5 2

8 12

3 7

10 4

11 9

13 14
```

## 样例 #4

### 输入

```
20

1 2

3 4

5 6

7 8

9 10

11 12

13 14

15 16

17 18

19 20

8 10

16 18

16 19

5 9

10 17

2 13

7 14

3 7

3 12
```

### 输出

```
6 1

2 15

20 13

14 19

16 4

11 18

17 12

3 5

9 7

8 10
```



---

---
title: "[ARC186A] Underclued"
layout: "post"
diff: 省选/NOI-
pid: AT_arc186_a
tag: ['动态规划 DP', '强连通分量', '二分图', '构造', '标签465']
---

# [ARC186A] Underclued

## 题目描述

[problemUrl]: https://atcoder.jp/contests/arc186/tasks/arc186_a

各成分が $ 0,1 $ である $ N $ 次正方行列 $ A,B $ について、以下の条件を満たしているとき $ A $ と $ B $ は **似ている** と言います。

- 各行の総和が等しい。つまり、どの $ i=1,\dots,N $ についても $ A_{i,1}\ +\ \dots\ +\ A_{i,N}\ =\ B_{i,1}\ +\ \dots\ +\ B_{i,N} $
- 各列の総和が等しい。つまり、どの $ j=1,\dots,N $ についても $ A_{1,j}\ +\ \dots\ +\ A_{N,j}\ =\ B_{1,j}\ +\ \dots\ +\ B_{N,j} $

また、各成分が $ 0,1 $ である $ N $ 次正方行列 $ A $ と整数 $ i,j $ ($ 1\ \leq\ i,j\ \leq\ N $) について、$ A $ と似ているどの行列 $ B $ についても $ A_{i,j}\ =\ B_{i,j} $ が成り立つとき、$ A $ の $ i $ 行 $ j $ 列成分は **固定されている** と言います。

以下の $ Q $ 個のクエリに答えてください。

- $ i $ 番目のクエリ：各成分が $ 0,1 $ である $ N $ 次正方行列であって、固定されている成分がちょうど $ K_i $ 個であるようなものが存在するなら `Yes`、そうでないなら `No` を出力せよ。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ Q $ $ K_1 $ $ K_2 $ $ \vdots $ $ K_Q $

## 输出格式

$ Q $ 行に出力せよ。 $ i\ (1\ \le\ i\ \le\ Q) $ 行目には $ i $ 番目のクエリの答えを出力せよ。

## 说明/提示

### 制約

- $ 2\ \le\ N\ \le\ 30 $
- $ 1\ \le\ Q\ \le\ N^2+1 $
- $ 0\ \le\ K_i\ \le\ N^2 $
- $ K_i\ \ne\ K_j\ (1\ \le\ i\ <\ j\ \le\ Q) $
- 入力はすべて整数

### Sample Explanation 1

$ 1 $ 番目のクエリ： 例えば、以下のような行列 $ X $ は、固定されている成分が $ 0 $ 個です。 ``` 1 0 0 0 1 0 0 0 1 ``` なぜなら、次のように列を循環シフトさせていったものはすべて $ X $ と似ており、どの成分も $ 0 $ にも $ 1 $ にもなりうるためです。 ``` 0 0 1 1 0 0 0 1 0 ``` ``` 0 1 0 0 0 1 1 0 0 ``` $ 2 $ 番目のクエリ： 例えば、以下のような行列 $ X $ は、固定されている成分が $ 9 $ 個です。 ``` 0 0 1 0 1 1 1 1 1 ``` なぜなら、似ている行列は $ X $ 以外に存在せず、すべての成分が固定されているためです。 $ 3 $ 番目のクエリ： 固定されている成分がちょうど $ 7 $ 個であるような行列は存在しません。

## 样例 #1

### 输入

```
3 3
0
9
7
```

### 输出

```
Yes
Yes
No
```

## 样例 #2

### 输入

```
29 6
186
681
18
108
123
321
```

### 输出

```
No
Yes
No
Yes
No
Yes
```



---

---
title: "ニワンゴくんとゲーム"
layout: "post"
diff: 省选/NOI-
pid: AT_dwacon2018_final_d
tag: ['进制', '向量', '构造']
---

# ニワンゴくんとゲーム

## 题目描述

[problemUrl]: https://atcoder.jp/contests/dwacon2018-final/tasks/dwacon2018_final_d

dwango社員のニワンゴくんは、あるゲームで遊んでいます。 このゲームでは、$ Q $ 体の敵が現れるので、プレイヤーをうまく操作して敵を倒す必要があります。 また、敵にはそれぞれ **体力** と呼ばれる値が定まっており、$ i $ 番目の敵の体力は $ N_i $ です。

ニワンゴくんの操作するプレイヤーには、**魔力** とよばれる値が定まっています。 敵と遭遇したとき、プレイヤーの魔力は $ 1 $ です。 この魔力は、敵と遭遇するたびに $ 1 $ に戻ることに注意してください。 ニワンゴくんは、毎ターン、次の操作のうちいずれかを行うことができます。

- 操作 $ 1 $: 魔力を $ 1 $ 増加させる。
- 操作 $ 2 $: 現在の魔力を $ x $ として、魔力を $ 2x $ に変更する。
- 操作 $ 3 $: 現在の魔力を $ x $ として、魔力を $ 2x\ +\ 1 $ に変更する。

プレイヤーの魔力がちょうど敵の体力に等しくなったとき、特殊な魔法が発動し、敵を倒すことができます。 ただし、魔力が敵の体力を超えてしまうと、もう敵を倒すことはできません。そのため、魔力が敵の体力を超えてしまうような操作を行ってはいけません。 プレイヤーの操作によって敵の体力が変化することはありません。

ニワンゴくんは、敵を倒すまでの操作の方法は何通りあるかが気になっています。 それぞれの敵に対して、ニワンゴくんが敵を倒すまでの操作の方法は何通りあるかを $ {\rm\ mod}\ 1,000,000,007 $ で求めてください。 ここで、途中で行う操作の番号が一回でも異なれば、途中の魔力の経過がまったく同じでも、異なる操作の方法として数えることに注意してください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ Q $ $ N_1 $ $ N_2 $ $ : $ $ N_Q $

## 输出格式

答えを $ Q $ 行で出力せよ。$ i $ 行目には、$ i $ 番目の敵を倒すまでの操作の方法は何通りあるかを $ {\rm\ mod}\ 1,000,000,007 $ で出力せよ。

## 说明/提示

### 制約

- $ 1\ \leq\ Q\ \leq\ 200 $
- $ 1\ \leq\ N_i\ \leq\ 10^{18} $ ($ 1\ \leq\ i\ \leq\ Q $)
- $ N_i $ は整数

### 部分点

- $ Q\ =\ 1,\ 1\ \leq\ N_1\ \leq\ 10^{14} $ を満たすデータセットに正答すると、$ 1300 $ 点が与えられる。

### Sample Explanation 1

$ 1 $ 番目の敵の体力は $ 4 $ です。 魔力をちょうど $ 4 $ にするまでの操作の方法としては、次の $ 5 $ 通りがあります。 - 操作 $ 1 $, 操作 $ 1 $, 操作 $ 1 $ の順に操作を行う。 - 操作 $ 1 $, 操作 $ 2 $ の順に操作を行う。 - 操作 $ 2 $, 操作 $ 1 $, 操作 $ 1 $ の順に操作を行う。 - 操作 $ 2 $, 操作 $ 2 $ の順に操作を行う。 - 操作 $ 3 $, 操作 $ 1 $ の順に操作を行う。 ここで、最初に操作 $ 1 $ を行っても、操作 $ 2 $ を行っても、魔力の変化の仕方は変わりませんが、この $ 2 $ つの操作は区別することに注意してください。

### Sample Explanation 2

$ 1 $ 番目の敵については、この敵を倒すまでの操作の方法は $ 2 $ 通りあります。 $ 2 $ 番目の敵については、一切操作を行わなくても最初からプレイヤーの魔力が敵の体力と等しくなっています。 ここで、プレイヤーの魔力は $ 2 $ 番目の敵と遭遇した際に $ 1 $ に戻ることに注意してください。

### Sample Explanation 3

$ {\rm\ mod}\ 1,000,000,007 $ で出力するのを忘れないようにしてください。

## 样例 #1

### 输入

```
1

4
```

### 输出

```
5
```

## 样例 #2

### 输入

```
2

2

1
```

### 输出

```
2

1
```

## 样例 #3

### 输入

```
3

1000

2000

3000
```

### 输出

```
415443858

630306535

766913460
```

## 样例 #4

### 输入

```
10

983102606006243867

653718290103598600

364611268624595444

114746989192634390

81304291426411017

931878752092058491

395809284336497545

633900034071891379

895817108011279740

92661392530626177
```

### 输出

```
893653300

150104699

232570112

922156483

361136690

103094234

245249617

912578727

399641917

820143308
```



---

---
title: "IOIOI カード占い"
layout: "post"
diff: 省选/NOI-
pid: AT_joisc2015_d
tag: ['2015', '最短路', '构造', '差分', 'JOI（日本）']
---

# IOIOI カード占い

## 题目描述

[problemUrl]: https://atcoder.jp/contests/joisc2015/tasks/joisc2015_d





---


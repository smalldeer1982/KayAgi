---
title: "[AGC002D] Stamp Rally"
layout: "post"
diff: 省选/NOI-
pid: AT_agc002_d
tag: ['并查集', '栈', '整体二分']
---

# [AGC002D] Stamp Rally

## 题目描述

[problemUrl]: https://atcoder.jp/contests/agc002/tasks/agc002_d



## 输入格式

第一行两个正整数，代表 $N$ 和 $M$。

接下来 $M$ 行，第 $i$ 行有两个正整数 $a_i,b_i$，代表 $a_i$ 和 $b_i$ 之间有一条无向边。

接下来一行有一个正整数，代表 $Q$。

接下来 $Q$ 行，第 $i$ 行有三个整数 $x_i,y_i,z_i$，表示一种询问。

## 输出格式

对于每个询问，输出一行一个整数表示答案。

## 样例 #1

### 输入

```
5 6
2 3
4 5
1 2
1 3
1 4
1 5
6
2 4 3
2 4 4
2 4 5
1 3 3
1 3 4
1 3 5

```

### 输出

```
1
2
3
1
5
5

```



---

---
title: "[AGC003E] Sequential operations on Sequence"
layout: "post"
diff: 省选/NOI-
pid: AT_agc003_e
tag: ['递归', '栈', '差分']
---

# [AGC003E] Sequential operations on Sequence

## 题目描述

[problemUrl]: https://atcoder.jp/contests/agc003/tasks/agc003_e

高橋君はお母さんから数列をもらいました。この数列の長さは $ N $ で、$ i(1\ ≦\ i\ ≦\ N) $ 項目の要素は $ i $ です。 高橋君は、この数列に以下の操作を合計で $ Q $ 回行いました。$ i $ 番目の操作は、パラメータ $ q_i $ であらわされ、以下のように行われます。

- いまの数列を無限回繰り返した数列の先頭 $ q_i $ 項をとって、新たな数列とする。

$ Q $ 回の操作後、この数列に $ 1 $ から $ N $ までの各々の数が何回ずつ現れるかを求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ Q $ $ q_1 $ : $ q_Q $

## 输出格式

$ N $ 行出力せよ。$ i(1\ ≦\ i\ ≦\ N) $ 行目には、$ Q $ 回の操作後の数列にあらわれる数 $ i $ の個数を表す整数ひとつを出力せよ。

## 说明/提示

### 制約

- $ 1\ ≦\ N\ ≦\ 10^5 $
- $ 0\ ≦\ Q\ ≦\ 10^5 $
- $ 1\ ≦\ q_i\ ≦\ 10^{18} $
- 入力はすべて整数である。

### Sample Explanation 1

$ 1 $ 回目の操作で、数列は $ 1,2,3,4,5,1 $ となります。 $ 2 $ 回目の操作で、数列は $ 1,2,3,4 $ となります。 $ 3 $ 回目の操作で、数列は $ 1,2,3,4,1,2,3,4,1,2,3 $ となります。 この数列には $ 1,2,3,4,5 $ がそれぞれ $ 3,3,3,2,0 $ 個含まれているので、上のように出力します。

## 样例 #1

### 输入

```
5 3

6

4

11
```

### 输出

```
3

3

3

2

0
```

## 样例 #2

### 输入

```
10 10

9

13

18

8

10

10

9

19

22

27
```

### 输出

```
7

4

4

3

3

2

2

2

0

0
```



---

---
title: "[ARC177D] Earthquakes"
layout: "post"
diff: 省选/NOI-
pid: AT_arc177_d
tag: ['线段树', '概率论', '单调栈']
---

# [ARC177D] Earthquakes

## 题目描述

[problemUrl]: https://atcoder.jp/contests/arc177/tasks/arc177_d

AtCoder 街道は、平らな地面の上に伸びる数直線で表される道路です。この道路上に $ N $ 個の高さ $ H $ の電柱が立っています。電柱には $ 1,\ 2,\ \dots,\ N $ の番号が古い順に付けられています。電柱 $ i\ (1\ \leq\ i\ \leq\ N) $ は座標 $ X_i $ に地面と垂直に立っています。**電柱の最下部は地面に固定されています。**ここで、電柱は十分に細いものとして考えます。

AtCoder 街道ではこれから $ N $ 回の地震が発生します。$ i $ 回目 $ (1\ \leq\ i\ \leq\ N) $ の地震では、以下のことが起こります。

1. 電柱 $ i $ がまだ倒れていない場合、それが数直線における左または右の方向に、それぞれ $ \frac{1}{2} $ ずつの確率で倒れる。
2. 倒れようとしている電柱が、まだ倒れていない電柱に衝突した場合（電柱の最下部に衝突した場合を含む）、この電柱も同じ方向に倒れる。場合によってはこれが連鎖的に起こる。
 
ここで、1. で電柱がどちら方向に倒れるかは、他の電柱がどちら方向に倒れたかに関係しません。

以下の図は一回の地震での電柱の倒れ方の一例です。

![ ](https://cdn.luogu.com.cn/upload/vjudge_pic/AT_arc177_d/2bf5e733d9f95c4209b1b2a6093b423312351960.png)

地震対策のため、$ t\ =\ 1,\ 2,\ \dots,\ N $ それぞれについて、ちょうど $ t $ 回目の地震ですべての電柱が倒れた状態になる確率を $ 2^N $ 倍した値を $ 998244353 $ で割った余りを求めてください。なお、出力すべき値は整数になることが証明できます。

## 输入格式

入力は以下の形式で標準入力から与えられます。

> $ N $ $ H $ $ X_1 $ $ X_2 $ $ \cdots $ $ X_N $

## 输出格式

$ t\ =\ 1,\ 2,\ \dots,\ N $ についての答えをその順番で空白区切りで出力してください。

## 说明/提示

### 制約

- $ 1\ \leq\ N\ \leq\ 2\ \times\ 10^5 $
- $ 1\ \leq\ H\ \leq\ 10^9 $
- $ 0\ \leq\ X_i\ \leq\ 10^9\ (1\ \leq\ i\ \leq\ N) $
- $ X_1,\ X_2,\ \dots,\ X_N $ はすべて異なる
- 入力はすべて整数
 
### Sample Explanation 1

以下の図は、この入力例における電柱の倒れ方の可能性を示しています。図中の分数はその状態になる確率を示しています。 !\[ \](https://img.atcoder.jp/arc177/1b1ec413ff3069cd13b19efd64b9c9d2.png) したがって、ちょうど $ 1,\ 2,\ 3 $ 回目の地震ですべての電柱が倒れた状態になる確率は、それぞれ $ \frac{1}{2},\ \frac{1}{4},\ \frac{1}{4} $ です。これを $ 8 $ 倍した $ 4,\ 2,\ 2 $ を出力しましょう。

### Sample Explanation 2

以下の図は、この入力例における電柱の倒れ方の可能性を示しています。図中の分数はその状態になる確率を示しています。 !\[ \](https://img.atcoder.jp/arc177/f2ce4d20221071c814e204d8a2adc60d.png) したがって、ちょうど $ 1,\ 2,\ 3,\ 4 $ 回目の地震ですべての電柱が倒れた状態になる確率は、それぞれ $ 0,\ \frac{1}{4},\ \frac{1}{4},\ \frac{1}{2} $ です。これを $ 16 $ 倍した $ 0,\ 4,\ 4,\ 8 $ を出力しましょう。

### Sample Explanation 3

ちょうど $ 1,\ 2,\ 3,\ 4,\ 5,\ 6,\ 7,\ 8 $ 回目の地震ですべての電柱が倒れた状態になる確率は、それぞれ $ 0,\ \frac{1}{4},\ \frac{1}{8},\ \frac{3}{16},\ \frac{3}{32},\ \frac{7}{64},\ \frac{7}{64},\ \frac{1}{8} $ です。

### Sample Explanation 4

$ 37 $ 回目の地震までにすべての電柱が倒れることはありません。ちょうど $ 38,\ 39,\ 40 $ 回目の地震ですべての電柱が倒れた状態になる確率は、それぞれ $ \frac{3}{8},\ \frac{3}{8},\ \frac{1}{4} $ です。

## 样例 #1

### 输入

```
3 2

0 3 1
```

### 输出

```
4 2 2
```

## 样例 #2

### 输入

```
4 10

10 55 20 45
```

### 输出

```
0 4 4 8
```

## 样例 #3

### 输入

```
8 1

5 0 6 3 8 1 7 2
```

### 输出

```
0 64 32 48 24 28 28 32
```

## 样例 #4

### 输入

```
40 20

695 793 11 502 114 861 559 4 212 609 894 435 429 94 91 258 161 45 33 605 673 634 629 163 283 826 409 84 507 548 31 248 588 340 357 168 926 949 322 912
```

### 输出

```
0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 41942627 41942627 360709869
```



---


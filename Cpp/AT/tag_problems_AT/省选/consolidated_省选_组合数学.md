---
title: "[ABC180F] Unbranched"
layout: "post"
diff: 省选/NOI-
pid: AT_abc180_f
tag: ['动态规划 DP', '组合数学', '差分']
---

# [ABC180F] Unbranched

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc180/tasks/abc180_f

頂点にラベルが付き辺にはラベルが付いていない $ N $ 頂点 $ M $ 辺の単純とも連結とも限らないグラフであって、以下の条件を満たすものの個数を $ 10^9+7 $ で割ったあまりを求めてください。

- 自己ループを持たない
- すべての頂点の次数が $ 2 $ 以下である
- 各連結成分のサイズを並べたとき、その最大値がちょうど $ L $ である

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ M $ $ L $

## 输出格式

答えを出力せよ。

## 说明/提示

### 制約

- $ 2\ \leq\ N\ \leq\ 300 $
- $ 1\leq\ M\ \leq\ N $
- $ 1\ \leq\ L\ \leq\ N $
- 入力はすべて整数

### Sample Explanation 1

頂点に $ 1 $ から $ N $ の番号を付けたとき、以下の $ 3 $ 通りのグラフが条件を満たします。 - $ 1-2 $ 間と $ 2-3 $ 間に辺がある。 - $ 1-2 $ 間と $ 1-3 $ 間に辺がある。 - $ 1-3 $ 間と $ 2-3 $ 間に辺がある。

## 样例 #1

### 输入

```
3 2 3
```

### 输出

```
3
```

## 样例 #2

### 输入

```
4 3 2
```

### 输出

```
6
```

## 样例 #3

### 输入

```
300 290 140
```

### 输出

```
211917445
```



---

---
title: "[ABC273G] Row Column Sums 2"
layout: "post"
diff: 省选/NOI-
pid: AT_abc273_g
tag: ['动态规划 DP', '组合数学']
---

# [ABC273G] Row Column Sums 2

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc273/tasks/abc273_g

非負整数を要素とする $ N $ 次正方行列であって、下記の $ 2 $ つの条件をともに満たすものの個数を $ 998244353 $ で割ったあまりを出力してください。

- すべての $ i\ =\ 1,\ 2,\ \ldots,\ N $ について、$ i $ 行目の要素の和は $ R_i $ である。
- すべての $ i\ =\ 1,\ 2,\ \ldots,\ N $ について、$ i $ 列目の要素の和は $ C_i $ である。

入力で与えられる $ R_i $ および $ C_i $ は $ 0 $ 以上 $ 2 $ 以下の整数であることに注意してください（制約参照）。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ R_1 $ $ R_2 $ $ \ldots $ $ R_N $ $ C_1 $ $ C_2 $ $ \ldots $ $ C_N $

## 输出格式

答えを出力せよ。

## 说明/提示

### 制約

- $ 1\ \leq\ N\ \leq\ 5000 $
- $ 0\ \leq\ R_i\ \leq\ 2 $
- $ 0\ \leq\ C_i\ \leq\ 2 $
- 入力はすべて整数

### Sample Explanation 1

条件を満たす行列は下記の $ 3 $ つです。 ``` 0 1 0 0 0 1 0 0 1 ``` ``` 0 0 1 0 1 0 0 0 1 ``` ``` 0 0 1 0 0 1 0 1 0 ```

### Sample Explanation 3

$ 998244353 $ で割ったあまりを出力することに注意してください。

## 样例 #1

### 输入

```
3

1 1 1

0 1 2
```

### 输出

```
3
```

## 样例 #2

### 输入

```
3

1 1 1

2 2 2
```

### 输出

```
0
```

## 样例 #3

### 输入

```
18

2 0 1 2 0 1 1 2 1 1 2 0 1 2 2 1 0 0

1 1 0 1 1 1 1 1 1 1 1 1 2 1 1 0 2 2
```

### 输出

```
968235177
```



---

---
title: "[AGC060C] Large Heap"
layout: "post"
diff: 省选/NOI-
pid: AT_agc060_c
tag: ['动态规划 DP', '组合数学', '排列组合', '概率论']
---

# [AGC060C] Large Heap

## 题目描述

[problemUrl]: https://atcoder.jp/contests/agc060/tasks/agc060_c

$ (1,2,\cdots,2^N-1) $ の順列 $ P=(P_1,P_2,\cdots,P_{2^N-1}) $ を考えます． $ P $ が以下の条件をすべて満たすとき，それを**ヒープ的**な順列と呼ぶことにします．

- $ P_i\ <\ P_{2i} $ ($ 1\ \leq\ i\ \leq\ 2^{N-1}-1 $)
- $ P_i\ <\ P_{2i+1} $ ($ 1\ \leq\ i\ \leq\ 2^{N-1}-1 $)
 
整数 $ A,B $ が与えられます． $ U=2^A,\ V=2^{B+1}-1 $ とします．

ヒープ的な順列を一様ランダムに $ 1 $ つ選んだ際，$ P_U\ <\ P_V $ である確率を $ \text{mod\ }998244353 $ で求めてください．

確率 $ \text{mod\ }{998244353} $ の定義求める確率は必ず有理数になることが証明できます。 また、この問題の制約のもとでは、求める有理数を既約分数 $ \frac{P}{Q} $ で表した時、$ Q\ \neq\ 0\ \pmod{998244353} $ となることが証明できます。 よって、$ R\ \times\ Q\ \equiv\ P\ \pmod{998244353},\ 0\ \leq\ R\ \lt\ 998244353 $ を満たす整数 $ R $ が一意に定まります。 この $ R $ を答えてください。

## 输入格式

入力は以下の形式で標準入力から与えられる．

> $ N $ $ A $ $ B $

## 输出格式

答えを出力せよ．

## 说明/提示

### 制約

- $ 2\ \leq\ N\ \leq\ 5000 $
- $ 1\ \leq\ A,B\ \leq\ N-1 $
- 入力される数はすべて整数
 
### Sample Explanation 1

ヒープ的な順列は，$ P=(1,2,3),(1,3,2) $ の $ 2 $ つです． $ P_2\ <\ P_3 $ となる確率は $ 1/2 $ です．

## 样例 #1

### 输入

```
2 1 1
```

### 输出

```
499122177
```

## 样例 #2

### 输入

```
3 1 2
```

### 输出

```
124780545
```

## 样例 #3

### 输入

```
4 3 2
```

### 输出

```
260479386
```

## 样例 #4

### 输入

```
2022 12 25
```

### 输出

```
741532295
```



---

---
title: "[ARC157D] YY Garden"
layout: "post"
diff: 省选/NOI-
pid: AT_arc157_d
tag: ['数论', '组合数学']
---

# [ARC157D] YY Garden

## 题目描述

[problemUrl]: https://atcoder.jp/contests/arc157/tasks/arc157_d

$ H $ 行 $ W $ 列のマス目の各マスに `X`, `Y` のいずれかの文字が書かれています． 上から $ i $ 行目，左から $ j $ 列目のマスを $ (i,\ j) $ で表します． マス目に書かれている文字は $ H $ 個の文字列 $ S_1,\ S_2,\ \dots,\ S_H $ によって与えられ，$ S_i $ の $ j $ 文字目がマス $ (i,\ j) $ に書かれた文字を表します．

隣り合う各行および各列の間に，マス目全体を横断（縦断）するように柵を設置できます． 柵同士は交差しても構いません． 柵の設置後に，「あるマスから始めて上下左右に隣接するマスへの移動を繰り返すことで，柵を越えずに到達可能なマス全体」を**区画**と定義します． （出力例 1 の説明も参考にしてください．）

柵の設置方法は全部で $ 2^{H-1}\ \times\ 2^{W-1} $ 通りありますが，そのうち次の条件を満たすものの個数を $ 998244353 $ で割った余りを求めてください．

**条件:** 各区画には `Y` が書かれたマスがちょうど $ 2 $ 個含まれている．

## 输入格式

入力は以下の形式で標準入力から与えられる．

> $ H $ $ W $ $ S_1 $ $ S_2 $ $ \vdots $ $ S_H $

## 输出格式

条件を満たす柵の設置方法の総数を $ 998244353 $ で割った余りを出力せよ．

## 说明/提示

### 制約

- $ 1\ \leq\ H\ \leq\ 2000 $
- $ 1\ \leq\ W\ \leq\ 2000 $
- $ S_i\ (1\ \leq\ i\ \leq\ H) $ は `X`, `Y` からなる長さ $ W $ の文字列である．
 
### Sample Explanation 1

柵の設置方法として，以下の $ 8 $ 通りがあります． ``` X Y Y X|Y Y X Y|Y X|Y|Y | | | | Y X Y Y|X Y Y X|Y Y|X|Y X Y Y X|Y Y X Y|Y X|Y|Y ----- -+--- ---+- -+-+- Y X Y Y|X Y Y X|Y Y|X|Y ``` たとえば，$ 2,\ 3 $ 列目の間に柵を設置した場合，区画は ``` XY YX ``` ``` Y Y ``` であり，それぞれにちょうど $ 2 $ 個の `Y` が含まれているので，条件を満たします． また，$ 1,\ 2 $ 行目の間と $ 1,\ 2 $ 列目の間に柵を設置した場合，区画は ``` X ``` ``` YY ``` ``` Y ``` ``` XY ``` となり，$ 2 $ つ目の区画以外にはちょうど $ 2 $ 個の `Y` が含まれていないので，条件を満たしません．

### Sample Explanation 2

どのように柵を設置しても条件を満たしません．

### Sample Explanation 3

条件を満たす柵の設置方法の総数を $ 998244353 $ で割った余りを出力してください．

## 样例 #1

### 输入

```
2 3

XYY

YXY
```

### 输出

```
2
```

## 样例 #2

### 输入

```
2 3

XYX

YYY
```

### 输出

```
0
```

## 样例 #3

### 输入

```
2 58

YXXYXXYXXYXXYXXYXXYXXYXXYXXYXXYXXYXXYXXYXXYXXYXXYXXYXXYXXY

YXXYXXYXXYXXYXXYXXYXXYXXYXXYXXYXXYXXYXXYXXYXXYXXYXXYXXYXXY
```

### 输出

```
164036797
```



---

---
title: "[ARC160D] Mahjong"
layout: "post"
diff: 省选/NOI-
pid: AT_arc160_d
tag: ['组合数学', '容斥原理']
---

# [ARC160D] Mahjong

## 题目描述

找到可以通过以下两种操作，使得长度为 $N$、元素之和为 $M$ 的数列 $A$ 全为 $0$ 的 $A$ 的个数，再取模 $998244353$。

1. 在 $A$ 中选一个元素，将其减去 $K$。
2. 在 $A$ 中选取长度为 $K$ 的子串，子串中每个元素减去 $1$。

## 输入格式

输入一行整数，分别代表 $N~M~K$。

## 输出格式

输出答案。

## 说明/提示

- $1\le K\le N\le2000$
- $1\le M\le10^{18}$

## 样例 #1

### 输入

```
3 2 2
```

### 输出

```
5
```

## 样例 #2

### 输入

```
100 998244353 100
```

### 输出

```
0
```

## 样例 #3

### 输入

```
2000 545782618661124208 533
```

### 输出

```
908877889
```



---

---
title: "[ARC162E] Strange Constraints"
layout: "post"
diff: 省选/NOI-
pid: AT_arc162_e
tag: ['动态规划 DP', '组合数学']
---

# [ARC162E] Strange Constraints

## 题目描述

[problemUrl]: https://atcoder.jp/contests/arc162/tasks/arc162_e

$ 1 $ 以上 $ N $ 以下の整数からなる長さ $ N $ の数列 $ A=(A_1,A_2,\ldots,A_N) $ が与えられます。

$ 1 $ 以上 $ N $ 以下の整数からなる長さ $ N $ の数列 $ B=(B_1,B_2,\ldots,B_N) $ のうち、全ての $ i=1,2,\ldots,N $ に対して以下の条件を満たすものの個数を $ 998244353 $ で割ったあまりを求めてください。

- $ B $ の中に含まれる $ i $ の個数は $ A_i $ 個以下
- $ B $ の中に含まれる $ B_i $ の個数は $ A_i $ 個以下

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ A_1 $ $ A_2 $ $ \ldots $ $ A_N $

## 输出格式

答えを出力せよ。

## 说明/提示

### 制約

- $ 1\ \leq\ N\ \leq\ 500 $
- $ 1\ \leq\ A_i\ \leq\ N $
- 入力される数値は全て整数
 
### Sample Explanation 1

条件を満たす数列は以下の $ 10 $ 個です。 - $ (1,2,2) $ - $ (1,2,3) $ - $ (1,3,2) $ - $ (1,3,3) $ - $ (2,1,3) $ - $ (2,3,1) $ - $ (2,3,3) $ - $ (3,1,2) $ - $ (3,2,1) $ - $ (3,2,2) $

### Sample Explanation 2

条件を満たす数列は、$ 1 $ 以上 $ 4 $ 以下の整数からなる長さ $ 4 $ の数列全てで、その個数は $ 4^4=256 $ 個です。

### Sample Explanation 3

条件を満たす数列は、$ (1,2,3,4,5) $ を並び替えて得られる数列全てで、その個数は $ 5!=120 $ 個です。

### Sample Explanation 4

個数を $ 998244353 $ で割ったあまりを出力してください。

## 样例 #1

### 输入

```
3

1 2 3
```

### 输出

```
10
```

## 样例 #2

### 输入

```
4

4 4 4 4
```

### 输出

```
256
```

## 样例 #3

### 输入

```
5

1 1 1 1 1
```

### 输出

```
120
```

## 样例 #4

### 输入

```
14

6 5 14 3 6 7 3 11 11 2 3 7 8 10
```

### 输出

```
628377683
```



---

---
title: "[ARC163D] Sum of SCC"
layout: "post"
diff: 省选/NOI-
pid: AT_arc163_d
tag: ['动态规划 DP', '组合数学']
---

# [ARC163D] Sum of SCC

## 题目描述

[problemUrl]: https://atcoder.jp/contests/arc163/tasks/arc163_d

以下の条件を全て満たす頂点に $ 1 $ から $ N $ までの番号がついた $ N $ 頂点の有向グラフ $ G $ を考えます。

- $ G $ はトーナメントである。すなわち、$ G $ に多重辺や自己ループはなく、$ G $ のどの $ 2 $ 頂点 $ u,v $ に対しても、$ u\ \rightarrow\ v $ 辺または $ v\ \rightarrow\ u $ 辺のうちちょうど片方が存在する。
- $ G $ の辺のうち、頂点番号が小さい方から大きい方へ向けられた辺はちょうど $ M $ 本存在する。
 
そのような有向グラフ $ G $ 全てに対する強連結成分の個数の総和を $ 998244353 $ で割ったあまりを求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ M $

## 输出格式

答えを出力せよ。

## 说明/提示

### 制約

- $ 1\ \le\ N\ \le\ 30 $
- $ 0\ \le\ M\ \le\ \frac{N(N-1)}{2} $
 
### Sample Explanation 1

条件を満たす有向グラフ $ G $ は以下の $ 3 $ 個です。それぞれ強連結成分の個数は $ 3,1,3 $ であるため答えは $ 7 $ です。 ![](https://img.atcoder.jp/arc163/ee8acabc2a7d48164b3cc568e88f0840.png)

## 样例 #1

### 输入

```
3 1
```

### 输出

```
7
```

## 样例 #2

### 输入

```
6 2
```

### 输出

```
300
```

## 样例 #3

### 输入

```
25 156
```

### 输出

```
902739687
```



---

---
title: "[ARC171E] Rookhopper's Tour"
layout: "post"
diff: 省选/NOI-
pid: AT_arc171_e
tag: ['数学', '组合数学']
---

# [ARC171E] Rookhopper's Tour

## 题目描述

[problemUrl]: https://atcoder.jp/contests/arc171/tasks/arc171_e

縦 $ N $ マス、横 $ N $ マスのグリッドがあります。グリッドの上から $ i $ 行目、左から $ j $ 列目のマスを $ (i,\ j) $ と呼びます。また、 $ 1 $ 個の黒石と $ M $ 個の白石があります。  
 あなたはこれらの道具を使って $ 1 $ 人でゲームをすることにしました。

ゲームのルールを説明します。はじめに、あなたは黒石を $ (A,\ B) $ に置きます。その後、 $ M $ 個の白石をグリッドのいずれかのマスに $ 1 $ 個ずつ置きます。ただし、

- $ (A,\ B) $ に白石は置けません。
- 白石は $ 1 $ つの行に高々 $ 1 $ 個しか置けません。
- 白石は $ 1 $ つの列に高々 $ 1 $ 個しか置けません。
 
その後、あなたは操作を行えなくなるまで以下の操作を行います。

- 黒石が $ (i,\ j) $ にあるとする。次の $ 4 $ 通りの操作のいずれかを行う。
  - $ (i,\ k) $ $ (j\ \lt\ k) $ に白石が置いてある時、その白石を取り除いて $ (i,\ k\ +\ 1) $ に黒石を動かす。
  - $ (i,\ k) $ $ (j\ \gt\ k) $ に白石が置いてある時、その白石を取り除いて $ (i,\ k\ -\ 1) $ に黒石を動かす。
  - $ (k,\ j) $ $ (i\ \lt\ k) $ に白石が置いてある時、その白石を取り除いて $ (k\ +\ 1,\ j) $ に黒石を動かす。
  - $ (k,\ j) $ $ (i\ \gt\ k) $ に白石が置いてある時、その白石を取り除いて $ (k\ -\ 1,\ j) $ に黒石を動かす。
      - ただし、黒石を動かす先のマスが存在しない場合はそのような動きは出来ない。
 
図で例示すると以下のようになります。ここで `B` は黒石、 `W` は白石、`.` は何もないマス、`O` は黒石を動かせるマスを意味します。

 ```
..O...
..W...
......
......
..B.WO
......
```

操作を終了した時点で以下の条件を全て満たしているとき、ゲームはあなたの勝利となります。そうでない場合は敗北となります。

- グリッドから白石が全て取り除かれている。
- 黒石が $ (A,\ B) $ に置かれている。
 
はじめの $ M $ 個の白石の配置としてあり得るもののうち、その後の操作をうまく行うことでゲームに勝利することが可能である配置は何通りありますか？答えを $ 998244353 $ で割った余りを求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ M $ $ A $ $ B $

## 输出格式

ゲームに勝利することが可能である白石の配置の個数を $ 998244353 $ で割った余りを出力せよ。

## 说明/提示

### 制約

- $ 2\ \leq\ M\ \leq\ N\ \leq\ 2\ \times\ 10^5 $
- $ 1\ \leq\ A\ \leq\ N $
- $ 1\ \leq\ B\ \leq\ N $
- $ N,\ M,\ A,\ B $ は整数
 
### Sample Explanation 1

例えば白石を以下の図のように配置したとします。 ``` ...... ..BW.. .....W ...... ..W... ....W. ``` このときあなたは次の手順で黒石を動かすことでゲームに勝利することが出来ます。 - $ (5,\ 3) $ にある白石を取り除いて $ (6,\ 3) $ に黒石を動かす。 - $ (6,\ 5) $ にある白石を取り除いて $ (6,\ 6) $ に黒石を動かす。 - $ (3,\ 6) $ にある白石を取り除いて $ (2,\ 6) $ に黒石を動かす。 - $ (2,\ 4) $ にある白石を取り除いて $ (2,\ 3) $ に黒石を動かす。 - グリッドから全ての白石を取り除き、かつ黒石が $ (A,\ B)\ =\ (2,\ 3) $ に置かれた状態になったので、あなたはゲームに勝利する。 ゲームに勝利することが可能である白石の配置は全部で $ 4 $ 通りあります。

## 样例 #1

### 输入

```
6 4 2 3
```

### 输出

```
4
```

## 样例 #2

### 输入

```
5 3 1 3
```

### 输出

```
0
```

## 样例 #3

### 输入

```
200000 47718 21994 98917
```

### 输出

```
146958602
```



---

---
title: "[ARC174E] Existence Counting"
layout: "post"
diff: 省选/NOI-
pid: AT_arc174_e
tag: ['树状数组', '组合数学', '排列组合']
---

# [ARC174E] Existence Counting

## 题目描述

[problemUrl]: https://atcoder.jp/contests/arc174/tasks/arc174_e

整数 $ N,K $ が与えられます。このとき、以下の条件を全て満たす長さ $ K $ の数列 $ a=(a_1,a_2,\dots,a_K) $ を考えます。

- $ a_i $ は $ 1\ \le\ a_i\ \le\ N $ を満たす整数である
- $ a $ の全ての要素は相異なる
 
$ a $ として考えられる数列を辞書順に全て並べた 「数列の列」 を辞書 $ s $ とします。

辞書 $ s $ 中に存在する数列 $ P $ が与えられるので、整数 $ t=1,2,\dots,N $ に対して以下の質問に答えてください。

- 以下の条件を全て満たす数列 $ b $ の個数を $ 998244353 $ で割った余りを求めよ。
  - 数列 $ b $ は辞書 $ s $ 中に存在する。
  - 数列 $ b $ 中に整数 $ t $ が含まれる。
  - 数列 $ b $ は辞書順で数列 $ P $ 以下である。
 
  数列の辞書順とは？ 数列 $ A\ =\ (A_1,\ \ldots,\ A_{|A|}) $ が $ B\ =\ (B_1,\ \ldots,\ B_{|B|}) $ より**辞書順で真に小さい**とは、下記の 1. と 2. のどちらかが成り立つことを言います。 1. $ |A|\ かつ\ (A_{1},\ldots,A_{|A|})\ =\ (B_1,\ldots,B_{|A|}) $ である。
2. ある整数 $ 1\leq\ i\leq\ \min\{|A|,|B|\} $ が存在して、下記の $ 2 $ つがともに成り立つ。 
  - $ (A_{1},\ldots,A_{i-1})\ =\ (B_1,\ldots,B_{i-1}) $
  - $ A_i $

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ K $ $ P_1 $ $ P_2 $ $ \dots $ $ P_K $

## 输出格式

全体で $ N $ 行出力せよ。  
 このうち $ i $ 行目には、 $ t=i $ であるときの質問の答えを整数として出力せよ。

## 说明/提示

### 制約

- 入力は全て整数
- $ 1\ \le\ K\ \le\ N\ \le\ 3\ \times\ 10^5 $
- $ P $ は問題文中の条件を満たす。
 
### Sample Explanation 1

この入力では、 $ N=4,K=2 $ です。 このとき、辞書 $ s=((1,2),(1,3),(1,4),(2,1),(2,3),(2,4),(3,1),(3,2),(3,4),(4,1),(4,2),(4,3)) $ となります。 辞書 $ s $ に含まれ、かつ辞書順で $ (3,2) $ 以下である数列のうち、 - $ 1 $ が含まれるものは $ (1,2),(1,3),(1,4),(2,1),(3,1) $ の $ 5 $ 個 - $ 2 $ が含まれるものは $ (1,2),(2,1),(2,3),(2,4),(3,2) $ の $ 5 $ 個 - $ 3 $ が含まれるものは $ (1,3),(2,3),(3,1),(3,2) $ の $ 4 $ 個 - $ 4 $ が含まれるものは $ (1,4),(2,4) $ の $ 2 $ 個 です。

## 样例 #1

### 输入

```
4 2

3 2
```

### 输出

```
5

5

4

2
```

## 样例 #2

### 输入

```
18 13

5 13 11 2 18 1 10 15 17 4 12 7 3
```

### 输出

```
925879409

905921009

665544804

665544719

783035803

349952762

349952758

349952757

349952757

349921178

212092637

710350150

378895603

129113201

129111892

129098081

129096772

110181652
```



---

---
title: "[ARC186D] Polish Mania"
layout: "post"
diff: 省选/NOI-
pid: AT_arc186_d
tag: ['组合数学', '容斥原理']
---

# [ARC186D] Polish Mania

## 题目描述

[problemUrl]: https://atcoder.jp/contests/arc186/tasks/arc186_d

空でない非負整数列 $ (V_1,\ V_2,\ \dots,\ V_M) $ が **Polish** であることを、次のように再帰的に定義します。

- $ V_1 $ 個の Polish 数列 $ W_1,\ W_2,\ \dots,\ W_{V_1} $ が存在して、数列 $ (V_1),\ W_1,\ W_2,\ \dots,\ W_{V_1} $ をこの順に連結したものが数列 $ (V_1,\ V_2,\ \dots,\ V_M) $ と一致する

特に、数列 $ (0) $ は Polish です。

長さ $ N $ の非負整数列 $ (A_1,\ A_2,\ \dots,\ A_N) $ が与えられます。辞書順で $ (A_1,\ A_2,\ \dots,\ A_N) $ 以下である、長さ $ N $ の Polish 数列の数を $ 998244353 $ で割ったあまりを求めてください。

 数列の辞書順とは？数列 $ S\ =\ (S_1,S_2,\ldots,S_{|S|}) $ が数列 $ T\ =\ (T_1,T_2,\ldots,T_{|T|}) $ より**辞書順で小さい**とは、下記の 1. と 2. のどちらかが成り立つことを言います。 ここで、$ |S|,\ |T| $ はそれぞれ $ S,\ T $ の長さを表します。

1. $ |S|\ \lt\ |T| $ かつ $ (S_1,S_2,\ldots,S_{|S|})\ =\ (T_1,T_2,\ldots,T_{|S|}) $。
2. ある整数 $ 1\ \leq\ i\ \leq\ \min\lbrace\ |S|,\ |T|\ \rbrace $ が存在して、下記の $ 2 $ つがともに成り立つ。 
  - $ (S_1,S_2,\ldots,S_{i-1})\ =\ (T_1,T_2,\ldots,T_{i-1}) $
  - $ S_i $ が $ T_i $ より（数として）小さい。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ A_1 $ $ A_2 $ $ \dots $ $ A_N $

## 输出格式

条件を満たす数列の数を $ 998244353 $ で割ったあまりを出力せよ。

## 说明/提示

### 制約

- $ 1\leq\ N\ \leq\ 3\times\ 10^5 $
- $ 0\leq\ A_i\ \lt\ N $
- 入力はすべて整数

### Sample Explanation 1

$ (1,\ 1,\ 1,\ 1,\ 1,\ 0) $ と $ (1,\ 1,\ 1,\ 2,\ 0,\ 0) $ が条件を満たします。 $ (1,\ 1,\ 1,\ 2,\ 0,\ 0) $ が Polish であることは、次のように確認できます。 - 問題文中にあるとおり、$ (0) $ は Polish である - $ (2,\ 0,\ 0) $ は、 $ (2) $ と $ 2 $ つの Polilsh 数列 $ (0) $ と $ (0) $ をこの順に連結したものと一致するため、Polish である - $ (1,\ 2,\ 0,\ 0) $ は、 $ (1) $ と $ 1 $ つの Polilsh 数列 $ (2,\ 0,\ 0) $ をこの順に連結したものと一致するため、Polish である - $ (1,\ 1,\ 2,\ 0,\ 0) $ は、 $ (1) $ と $ 1 $ つの Polilsh 数列 $ (1,\ 2,\ 0,\ 0) $ をこの順に連結したものと一致するため、Polish である - $ (1,\ 1,\ 1,\ 2,\ 0,\ 0) $ は、 $ (1) $ と $ 1 $ つの Polilsh 数列 $ (1,\ 1,\ 2,\ 0,\ 0) $ をこの順に連結したものと一致するため、Polish である

## 样例 #1

### 输入

```
6
1 1 1 2 0 0
```

### 输出

```
2
```

## 样例 #2

### 输入

```
11
3 3 4 4 5 5 6 6 7 7 8
```

### 输出

```
13002
```

## 样例 #3

### 输入

```
19
18 18 18 18 18 18 18 18 18 18 18 18 18 18 18 18 18 18 18
```

### 输出

```
477638700
```

## 样例 #4

### 输入

```
4
1 1 0 0
```

### 输出

```
0
```



---

---
title: "Counting Amusing Numbers"
layout: "post"
diff: 省选/NOI-
pid: AT_icpc2015summer_day3_c
tag: ['动态规划 DP', '组合数学']
---

# Counting Amusing Numbers

## 题目描述

[problemUrl]: https://atcoder.jp/contests/jag2015summer-day3/tasks/icpc2015summer_day3_c





---

---
title: "テント  (Tents)"
layout: "post"
diff: 省选/NOI-
pid: AT_joisc2018_c
tag: ['动态规划 DP', '组合数学']
---

# テント  (Tents)

## 题目描述

[problemUrl]: https://atcoder.jp/contests/joisc2018/tasks/joisc2018_c





---


---
title: "[AGC041D] Problem Scores"
layout: "post"
diff: 省选/NOI-
pid: AT_agc041_d
tag: ['动态规划 DP', '背包 DP']
---

# [AGC041D] Problem Scores

## 题目描述

[problemUrl]: https://atcoder.jp/contests/agc041/tasks/agc041_d

コンテストで使う $ N $ 問の問題がジャッジに選ばれ、各問に配点を付ける段階になりました。

問題 $ i $ の配点 $ A_i $ は、$ 1 $ 以上 $ N $ 以下の整数でなければなりません。 また、すでに問題は難易度順に並んでおり、$ A_1\ \le\ A_2\ \le\ \ldots\ \le\ A_N $ でなければなりません (複数問の配点が同じになるのは構いませんが)。

ICPC のファンであるあなたは、解いた問題数が多い参加者ほど上位となってほしいと考えています。 この理由から、任意の $ k $ ($ 1\ \le\ k\ \le\ N-1 $) に対して、任意の $ k $ 問の配点の合計が任意の $ k+1 $ 問の配点の合計より真に小さくなるようにしたい、とあなたは考えています。

このような配点の付け方は何通りあるでしょうか？この数を与えられた素数 $ M $ で割った余りを求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ M $

## 输出格式

配点の付け方の数を $ M $ で割った余りを出力せよ。

## 说明/提示

### 制約

- $ 2\ \leq\ N\ \leq\ 5000 $
- $ 9\ \times\ 10^8\ <\ M\ <\ 10^9 $
- $ M $ は素数である。
- 入力中のすべての値は整数である。

### Sample Explanation 1

可能な配点の付け方は $ (1,\ 1) $, $ (1,\ 2) $, $ (2,\ 2) $ です。

### Sample Explanation 2

可能な配点の付け方は $ (1,\ 1,\ 1) $, $ (1,\ 2,\ 2) $, $ (1,\ 3,\ 3) $, $ (2,\ 2,\ 2) $, $ (2,\ 2,\ 3) $, $ (2,\ 3,\ 3) $, $ (3,\ 3,\ 3) $ です。

## 样例 #1

### 输入

```
2 998244353
```

### 输出

```
3
```

## 样例 #2

### 输入

```
3 998244353
```

### 输出

```
7
```

## 样例 #3

### 输入

```
6 966666661
```

### 输出

```
66
```

## 样例 #4

### 输入

```
96 925309799
```

### 输出

```
83779
```



---

---
title: "[AGC049D] Convex Sequence"
layout: "post"
diff: 省选/NOI-
pid: AT_agc049_d
tag: ['背包 DP', '差分']
---

# [AGC049D] Convex Sequence

## 题目描述

[problemUrl]: https://atcoder.jp/contests/agc049/tasks/agc049_d

整数 $ N $ と $ M $ が与えられます． 長さ $ N $ の非負整数列 $ (A_1,A_2,\ldots,A_N) $ であって，次の条件を満たすものの個数を$ \bmod\ (10^9+7) $ で求めてください．

- $ A_1+A_2+\ldots\ +A_N\ =\ M $
- すべての $ i $ ($ 2\ \leq\ i\ \leq\ N-1 $) について，$ 2\ A_i\ \leq\ A_{i-1}\ +\ A_{i+1} $

## 输入格式

入力は以下の形式で標準入力から与えられる．

> $ N $ $ M $

## 输出格式

条件を満たす数列の個数を$ \bmod\ (10^9+7) $ で出力せよ．

## 说明/提示

### 制約

- $ 1\ \leq\ N\ \leq\ 10^5 $
- $ 1\ \leq\ M\ \leq\ 10^5 $
- 入力はすべて整数である．

### Sample Explanation 1

以下の $ 7 $ 個の数列が条件を満たします． - $ 0,0,3 $ - $ 0,1,2 $ - $ 1,0,2 $ - $ 1,1,1 $ - $ 2,0,1 $ - $ 2,1,0 $ - $ 3,0,0 $

## 样例 #1

### 输入

```
3 3
```

### 输出

```
7
```

## 样例 #2

### 输入

```
10 100
```

### 输出

```
10804516
```

## 样例 #3

### 输入

```
10000 100000
```

### 输出

```
694681734
```



---

---
title: "Count Permutations Many Times"
layout: "post"
diff: 省选/NOI-
pid: AT_jsc2019_final_f
tag: ['莫队', '多项式', '背包 DP', '容斥原理']
---

# Count Permutations Many Times

## 题目描述

[problemUrl]: https://atcoder.jp/contests/jsc2019-final/tasks/jsc2019_final_f

長さ $ N $ の数列 $ A_0,A_1,\cdots,A_{N-1} $ があります。 次の $ Q $ 個の質問に答えてください。

- 質問 $ i $ ($ 0\ \leq\ i\ \leq\ Q-1 $): 整数 $ L_i,R_i $ ($ 0\ \leq\ L_i\ <\ R_i\ \leq\ N $) が与えられる。 $ (0,1,\cdots,N-1) $ の順列 $ p_0,p_1,\cdots,p_{N-1} $ であって、次の条件をみたすものの個数を求めよ。
  - 全ての $ j $ ($ L_i\ \leq\ j\ <\ R_i $) について、$ p_j\ \neq\ A_j $ である。

ただし、答えは非常に大きくなることがあるので、$ 998244353 $ で割ったあまりを出力してください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ Q $ $ A_0 $ $ A_1 $ $ \cdots $ $ A_{N-1} $ $ L_0 $ $ R_0 $ $ L_1 $ $ R_1 $ $ \vdots $ $ L_{Q-1} $ $ R_{Q-1} $

## 输出格式

$ Q $ 行出力せよ。 $ i+1 $ ($ 0\ \leq\ i\ \leq\ Q-1 $) 行目には、質問 $ i $ の答えを $ 998244353 $ で割ったあまりを出力せよ。

## 说明/提示

### 制約

- $ 1\ \leq\ N\ \leq\ 2000 $
- $ 0\ \leq\ A_i\ \leq\ N-1 $
- $ 1\ \leq\ Q\ \leq\ 2000 $
- $ 0\ \leq\ L_i\ <\ R_i\ \leq\ N $
- 入力される値はすべて整数である。

### Sample Explanation 1

例えば質問 $ 0 $ について考えると、条件をみたす順列は $ (1,0,2),(1,2,0),(2,0,1),(2,1,0) $ の $ 4 $ 通りです。

## 样例 #1

### 输入

```
3 6

0 0 0

0 1

0 2

0 3

1 2

1 3

2 3
```

### 输出

```
4

2

0

4

2

4
```

## 样例 #2

### 输入

```
3 6

0 1 2

0 1

0 2

0 3

1 2

1 3

2 3
```

### 输出

```
4

3

2

4

3

4
```

## 样例 #3

### 输入

```
10 10

7 9 4 8 0 6 7 8 9 8

0 5

4 7

3 10

7 10

7 9

4 9

0 3

6 9

4 9

1 3
```

### 输出

```
2170680

2656080

1712520

2620800

2943360

2170680

2656080

2656080

2170680

2943360
```



---


---
title: "[ABC319F] Fighter Takahashi"
layout: "post"
diff: 省选/NOI-
pid: AT_abc319_f
tag: ['动态规划 DP', '贪心', '状态合并']
---

# [ABC319F] Fighter Takahashi

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc319/tasks/abc319_f

$ N $ 頂点の木があります。 $ 1 $ 番目の頂点が根であり、$ i $ 番目 $ (2\leq i\leq N) $ の頂点の親は $ p_ i\ (1\leq p _ i\lt\ i) $ です。

根でない頂点には、**敵**か**薬**のどちらか一方が配置されています。 高橋くんは、すべての敵を倒したいです。 はじめ、高橋くんの強さは $ 1 $ で、頂点 $ 1 $ にいます。 $ i=2,\ldots,N $ について、$ i $ 番目の頂点の情報は整数の組 $ (t _ i,s _ i,g _ i) $ を用いて次のように表されます。

- $ t _i=1 $ ならば $ i $ 番目の頂点には敵がいます。この頂点に高橋くんが初めて訪れたとき、高橋くんの強さが $ s _ i $ 未満だった場合高橋くんは敵に倒されて**敗北**し、高橋くんは他の頂点に移動できなくなります。そうでなかった場合、高橋くんは敵を倒し、強さが $ g _ i $ 上昇します。
- $ t _ i=2 $ ならば $ i $ 番目の頂点には薬があります。この頂点に高橋くんが初めて訪れたとき、高橋くんは薬を飲み、強さが $ g _ i $ 倍になります。（薬がある頂点では、$ s _ i=0 $ です。）
 
薬がある頂点はたかだか $ 10 $ 個です。

高橋くんは、隣接する頂点に移動することができます。 高橋くんがすべての敵を倒すことができるか判定してください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $   
> $ p _ 2 $ $ t _ 2 $ $ s _ 2 $ $ g _ 2 $   
> $ p _ 3 $ $ t _3 $ $ s _ 3 $ $ g _ 3 $  
> $ \vdots $   
> $ p _ N $ $ t _ N $ $ s _N $ $ g _ N $

## 输出格式

答え（`Yes` または `No`）を $ 1 $ 行で出力せよ。

## 说明/提示

### 制約

- $ 2\leq\ N\leq\ 500 $
- $ 1\leq\ p _ i\lt\ i\ (2\leq\ i\leq\ N) $
- $ t _ i\in\lbrace1,2\rbrace\ (2\leq\ i\leq\ N) $
- $ t _ i=1\implies1\leq\ s _ i\leq\ 10 ^ 9\ (2\leq\ i\leq\ N) $
- $ t _ i=2\implies\ s _ i=0\ (2\leq\ i\leq\ N) $
- $ 1\leq g _ i\leq\ 10 ^ 9\ (2\leq\ i\leq\ N) $
- $ t _ i=2 $ である頂点は $ 10 $ 個以下
- 入力はすべて整数
 
### Sample Explanation 1

はじめ、木は以下のようになっています。 ![](https://img.atcoder.jp/abc319/df876b93cd1181b6e7269d978c19632b.png) 高橋くんは、頂点 $ 1 $ から $ 2,3,2,1,6,7,6,1,4,5,8 $ の順に移動することで、すべての敵を倒すことができます。 このとき、高橋くんがいる頂点と高橋くんの強さは以下の図のように変化します（図では、すでに訪れたことのある頂点への移動は省略しています）。 ![](https://img.atcoder.jp/abc319/de96b59f8e4b180017fbd1aba73f4fb3.png) 例えば、頂点 $ 1 $ から $ 4,5,8 $ の順に移動すると、頂点 $ 8 $ に訪れた時点での強さが $ s _ 8=140 $ より小さいので高橋くんは敗北してしまい、すべての敵を倒すことができません。

## 样例 #1

### 输入

```
8

1 2 0 3

2 1 3 3

1 2 0 4

4 1 2 2

1 2 0 5

6 1 5 5

5 1 140 1
```

### 输出

```
Yes
```

## 样例 #2

### 输入

```
12

1 1 166 619

1 1 17 592

2 1 222 983

2 1 729 338

5 1 747 62

3 1 452 815

3 2 0 1

4 2 0 40

4 1 306 520

6 1 317 591

1 1 507 946
```

### 输出

```
No
```

## 样例 #3

### 输入

```
12

1 1 1 791

2 2 0 410

2 1 724 790

2 1 828 599

5 2 0 13

3 1 550 803

1 1 802 506

5 1 261 587

6 1 663 329

8 1 11 955

9 1 148 917
```

### 输出

```
Yes
```

## 样例 #4

### 输入

```
12

1 2 0 1000000000

2 2 0 1000000000

3 2 0 1000000000

4 2 0 1000000000

5 2 0 1000000000

6 2 0 1000000000

7 2 0 1000000000

8 2 0 1000000000

9 2 0 1000000000

10 2 0 1000000000

11 1 1 1
```

### 输出

```
Yes
```



---

---
title: "[ABC373G] No Cross Matching"
layout: "post"
diff: 省选/NOI-
pid: AT_abc373_g
tag: ['贪心', '分治', '二分图', '费用流']
---

# [ABC373G] No Cross Matching

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc373/tasks/abc373_g

$ 2 $ 次元平面上に $ P_1,P_2,\ldots,P_N,\ Q_1,Q_2,\ldots,Q_N $ の $ 2N $ 個の点があります。 $ P_i $ の座標は $ (A_i,B_i) $、$ Q_i $ の座標は $ (C_i,D_i) $ です。 同一直線上に異なる $ 3 $ 点が存在することはありません。

$ (1,2,\ldots,N) $ の順列であるような数列 $ R=(R_1,R_2,\ldots,R_N) $ であって以下の条件を満たすような $ R $ が存在するか判定し、存在する場合は $ 1 $ つ求めてください。

- $ 1 $ 以上 $ N $ 以下のすべての整数 $ i $ について 線分 $ i $ を $ P_i $ と $ Q_{R_i} $ を端点とする線分としたとき、どの線分 $ i $ と線分 $ j $ $ (1\ \leq\ i\ <\ j\ \leq\ N) $ も互いに交差しない。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ A_1 $ $ B_1 $ $ A_2 $ $ B_2 $ $ \vdots $ $ A_N $ $ B_N $ $ C_1 $ $ D_1 $ $ C_2 $ $ D_2 $ $ \vdots $ $ C_N $ $ D_N $

## 输出格式

条件を満たす $ R $ が存在しない場合は `-1` と出力せよ。

存在する場合は $ R_1,R_2,\ldots,R_N $ を空白区切りで出力せよ。答えが複数存在する場合はどれを出力してもかまわない。

## 说明/提示

### 制約

- $ 1\ \leq\ N\ \leq\ 300 $
- $ 0\ \leq\ A_i,B_i,C_i,D_i\ \leq\ 5000 $ $ (1\ \leq\ i\ \leq\ N) $
- $ (A_i,B_i)\ \neq\ (A_j,B_j) $ $ (1\ \leq\ i\ <\ j\ \leq\ N) $
- $ (C_i,D_i)\ \neq\ (C_j,D_j) $ $ (1\ \leq\ i\ <\ j\ \leq\ N) $
- $ (A_i,B_i)\ \neq\ (C_j,D_j) $ $ (1\ \leq\ i,j\ \leq\ N) $
- 同一直線上に異なる $ 3 $ 点が存在することはない
- 入力はすべて整数

### Sample Explanation 1

以下の図のように点が並んでいます。 !\[\](https://img.atcoder.jp/abc373/G-sample.png)$ R=(2,1,3) $ とすることで $ 3 $ 本の線分は互いに交差しません。また、 $ R $ を $ (1,2,3),(1,3,2),(2,3,1),(3,1,2) $ のいずれにしても正しい答えとなります。

## 样例 #1

### 输入

```
3
0 0
2 4
4 2
0 2
2 0
4 4
```

### 输出

```
2 1 3
```

## 样例 #2

### 输入

```
8
59 85
60 57
72 12
3 27
16 58
41 94
77 64
97 20
32 37
7 2
57 94
35 70
38 60
97 100
5 76
38 8
```

### 输出

```
3 5 8 2 7 4 6 1
```



---

---
title: "[ABC376G] Treasure Hunting"
layout: "post"
diff: 省选/NOI-
pid: AT_abc376_g
tag: ['贪心', '优先队列']
---

# [ABC376G] Treasure Hunting

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc376/tasks/abc376_g

頂点に $ 0 $ から $ N $ までの番号がついた $ N\ +\ 1 $ 頂点の根付き木があります。頂点 $ 0 $ は根で、頂点 $ i $ の親は頂点 $ p_i $ です。  
 頂点 $ 1 $, 頂点 $ 2 $, $ \dots $, 頂点 $ N $ のうちどこか $ 1 $ 頂点に宝が隠されています。頂点 $ i $ に宝がある確率は $ \frac{a_i}{\sum_{j=1}^N\ a_j} $ です。 また、各頂点には「探索済」と「未探索」のどちらか一方の状態を持ちます。はじめ頂点 $ 0 $ は探索済で、それ以外の頂点は未探索です。  
 あなたは、宝がある頂点が探索済になるまで以下の操作を行います。

- 親が探索済であるような未探索の頂点を選び、その頂点を探索済にする。
 
操作回数の期待値が最小になるように行動した時の操作回数の期待値を $ \text{mod\ }998244353 $ で求めてください。

$ T $ 個のテストケースが与えられるので、それぞれに対して答えを求めてください。

  期待値 $ \text{mod\ }{998244353} $ の定義 求める期待値は必ず有理数になることが証明できます。 また、この問題の制約のもとでは、その値を既約分数 $ \frac{P}{Q} $ で表した時、$ Q\ \not\ \equiv\ 0\ \pmod{998244353} $ となることも証明できます。このとき、$ R\ \times\ Q\ \equiv\ P\ \pmod{998244353},\ 0\ \leq\ R\ \lt\ 998244353 $ を満たす整数 $ R $ が一意に定まります。この $ R $ を答えてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。ここで $ \mathrm{case}_i $ は $ i $ 番目のテストケースを意味する。

> $ T $ $ \mathrm{case}_1 $ $ \mathrm{case}_2 $ $ \vdots $ $ \mathrm{case}_T $

各テストケースは以下の形式で与えられる。

> $ N $ $ p_1 $ $ p_2 $ $ \dots $ $ p_N $ $ a_1 $ $ a_2 $ $ \dots $ $ a_N $

## 输出格式

$ T $ 行出力せよ。$ i $ 行目には $ i $ 番目のテストケースの答えを出力せよ。

## 说明/提示

### 制約

- $ 1\ \leq\ T\ \leq\ 2\ \times\ 10^5 $
- $ 1\ \leq\ N\ \leq\ 2\ \times\ 10^5 $
- $ 0\ \leq\ p_i\ \lt\ i $
- $ 1\ \leq\ a_i $
- $ \sum_{i=1}^N\ a_i\ \leq\ 10^8 $
- 全てのテストケースに対する $ N $ の総和は $ 2\ \times\ 10^5 $ 以下
- 入力される値は全て整数
 
### Sample Explanation 1

$ 1 $ 番目のテストケースにおける操作回数の期待値は $ \frac{13}{6} $ です。

## 样例 #1

### 输入

```
3

3

0 0 1

1 2 3

5

0 1 0 0 0

8 6 5 1 7

10

0 1 1 3 3 1 4 7 5 4

43 39 79 48 92 90 76 30 16 30
```

### 输出

```
166374061

295776107

680203339
```



---

---
title: "[AGC006D] Median Pyramid Hard"
layout: "post"
diff: 省选/NOI-
pid: AT_agc006_d
tag: ['贪心', '二分', '枚举']
---

# [AGC006D] Median Pyramid Hard

## 题目描述

[problemUrl]: https://atcoder.jp/contests/agc006/tasks/agc006_d

$ N $ 段のピラミッドがあります。 段は上から順に $ 1 $, $ 2 $, $ ... $, $ N $ と番号が振られています。 各 $ 1\ <\ =i\ <\ =N $ について、$ i $ 段目には $ 2i-1 $ 個のブロックが横一列に並んでいます。 また、各段の中央のブロックに注目すると、これらは縦一列に並んでいます。

 ![](https://cdn.luogu.com.cn/upload/vjudge_pic/AT_agc006_d/a992c42b0e9b0597f104bf82a0adc1131324bb4f.png)$ N=4 $ 段のピラミッド

 

すぬけ君は $ N $ 段目のブロックに ($ 1 $, $ 2 $, $ ... $, $ 2N-1 $) を並べ替えたもの（順列）を書き込みました。 さらに、次のルールに従い、残りすべてのブロックに整数を書き込みました。

- あるブロックに書き込まれる整数は、そのブロックの左下、真下、右下のブロックに書き込まれた整数の中央値である。

 ![](https://cdn.luogu.com.cn/upload/vjudge_pic/AT_agc006_d/545e109d7af3caf92b1a8f9ac80715efa6c3d3db.png)ブロックに整数を書き込む例

 

その後、すぬけ君はすべてのブロックに書き込まれた整数を消してしまいました。 すぬけ君は、$ N $ 段目のブロックに書き込まれた順列が ($ a_1 $, $ a_2 $, $ ... $, $ a_{2N-1} $) であったことだけを覚えています。

$ 1 $ 段目のブロックに書き込まれた整数を求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ a_1 $ $ a_2 $ $ ... $ $ a_{2N-1} $

## 输出格式

$ 1 $ 段目のブロックに書き込まれた整数を出力せよ。

## 说明/提示

### 制約

- $ 2\ <\ =N\ <\ =10^5 $
- ($ a_1 $, $ a_2 $, $ ... $, $ a_{2N-1} $) は ($ 1 $, $ 2 $, $ ... $, $ 2N-1 $) の順列である。

### Sample Explanation 1

問題文中の図の例です。

## 样例 #1

### 输入

```
4

1 6 3 7 4 5 2
```

### 输出

```
4
```

## 样例 #2

### 输入

```
2

1 2 3
```

### 输出

```
2
```



---

---
title: "[AGC007F] Shik and Copying String"
layout: "post"
diff: 省选/NOI-
pid: AT_agc007_f
tag: ['贪心']
---

# [AGC007F] Shik and Copying String

## 题目描述

Shikk 的工作是复制。有一天，Shikk 从他的上司那里拿到了一个由小写英文字母组成的长度为 $N$ 的字符串 $S_{0}$（假设这天是第 $0$ 天）。这之后第 $i$ 天的工作是把 $S_{i-1}$ 复制到 $S_{i}$。下文中的 $S_{i}[j]$ 表示字符串 $S_{i}$ 的第 $j$ 个字母。

Shikk 还不怎么习惯这个工作。每天，当 Shikk 从第一个字母开始按顺序复制字符串时，他有可能会写下和刚刚写下的字母相同的字母，而不是本来应该写下的字母。也就是说，$S_{i}[j]$ 要么与 $S_{i-1}[j]$ 相同，要么与 $S_{i}[j-1]$ 相同。（特别地，字符串开头的字母不可能出错。也就是说，$S_{i}[1]$ 必然与 $S_{i-1}[1]$ 相同。）

输入两个字符串 $S_{0}$ 和 $T$，请求出使得 $S_{i}$ 有可能与 $T$ 相同的最小的整数 $i$。如果这样的 $i$ 不存在，请输出 $-1$。


## 样例解释

#### 样例 1 解释

一种可能的最佳方案：$S_{0}= \texttt{abcde}$，$S_{1} = \texttt{aaccc}$，$S_{2} = \texttt{aaacc}$。

## 输入格式

输入的第一行仅一个整数，即字符串长度 $N$；

第二行仅一个由小写英文字母组成的字符串，即 $S_{0}$；

第三行仅一个由小写英文字母组成的字符串，即 $T$。

## 说明/提示

- $1\le N\le 10 ^ 6$；
- $S_{0}$ 和 $T$ 的长度都等于 $N$；
- $S_{0}$ 和 $T$ 均只由小写英文字母组成。

## 样例 #1

### 输入

```
5

abcde

aaacc
```

### 输出

```
2
```

## 样例 #2

### 输入

```
5

abcde

abcde
```

### 输出

```
0
```

## 样例 #3

### 输入

```
4

acaa

aaca
```

### 输出

```
2
```

## 样例 #4

### 输入

```
5

abcde

bbbbb
```

### 输出

```
-1
```



---

---
title: "[AGC011E] Increasing Numbers"
layout: "post"
diff: 省选/NOI-
pid: AT_agc011_e
tag: ['贪心', '高精度', '二分']
---

# [AGC011E] Increasing Numbers

## 题目描述

[problemUrl]: https://atcoder.jp/contests/agc011/tasks/agc011_e

10 進法で表記したとき，桁同士が隣り合っているところではすべて，右にある桁の値のほうが左にある桁の値以上であるような $ 0 $ 以上の整数を，増加的と呼ぶことにします． たとえば，$ 1558 $ や $ 11 $ や $ 3 $ や $ 0 $ は増加的ですが，$ 10 $ や $ 20170312 $ は増加的ではありません．

すぬけ君は，整数 $ N $ を持っています． $ N $ が最小で何個の増加的な数の和として表されるかを求めてください．

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $

## 输出格式

$ N $ が最小で何個の増加的な数の和として表されるかを出力せよ．

## 说明/提示

### 制約

- $ 1\ \leq\ N\ \leq\ 10^{500000} $

### Sample Explanation 1

例えば，$ 80\ =\ 77\ +\ 3 $ として表すことができます．

### Sample Explanation 2

$ 123456789 $ はそれ自体が増加的なので，$ 1 $ 個の増加的な数の和で表すことができます．

## 样例 #1

### 输入

```
80
```

### 输出

```
2
```

## 样例 #2

### 输入

```
123456789
```

### 输出

```
1
```

## 样例 #3

### 输入

```
20170312
```

### 输出

```
4
```

## 样例 #4

### 输入

```
7204647845201772120166980358816078279571541735614841625060678056933503
```

### 输出

```
31
```



---

---
title: "[AGC018D] Tree and Hamilton Path"
layout: "post"
diff: 省选/NOI-
pid: AT_agc018_d
tag: ['贪心']
---

# [AGC018D] Tree and Hamilton Path

## 题目描述

[problemUrl]: https://atcoder.jp/contests/agc018/tasks/agc018_d

$ N $ 頂点の木があり、頂点には $ 1 $ から $ N $ の番号がついています。 この木の $ i $ 番目の辺は頂点 $ A_i $ と $ B_i $ を結んでいて、その長さは $ C_i $ です。

joisinoお姉ちゃんは、$ N $ 頂点の完全グラフを作りました。 なお、この完全グラフの頂点 $ u $ と $ v $ を結ぶ辺の長さは、木での頂点 $ u $ と $ v $ の最短距離になっています。

joisinoお姉ちゃんは、この完全グラフのハミルトンパス(※)のうち、最も長いものの長さを知りたくなりました。 joisinoお姉ちゃんの作った完全グラフのハミルトンパスのうち、最も長いものの長さを求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ A_1 $ $ B_1 $ $ C_1 $ $ A_2 $ $ B_2 $ $ C_2 $ $ : $ $ A_{N-1} $ $ B_{N-1} $ $ C_{N-1} $

## 输出格式

joisinoお姉ちゃんの作った完全グラフのハミルトンパスのうち、最も長いものの長さを出力せよ。

## 说明/提示

### 注釈

あるグラフのハミルトンパスとは、そのグラフのパスであって、すべての頂点をちょうど一度だけ通るようなものを指します。

### 制約

- $ 2\ \leq\ N\ \leq\ 10^5 $
- $ 1\ \leq\ A_i\ <\ B_i\ \leq\ N $
- 入力で与えられるグラフは木である。
- $ 1\ \leq\ C_i\ \leq\ 10^8 $
- 入力はすべて整数である。

### Sample Explanation 1

$ 5 $ → $ 3 $ → $ 1 $ → $ 4 $ → $ 2 $ というハミルトンパスを考えると、その長さは、 $ 5+8+15+10=38 $ となります。長さ $ 39 $ 以上のハミルトンパスは作れないので、この例の答えは $ 38 $ になります。

## 样例 #1

### 输入

```
5

1 2 5

3 4 7

2 3 3

2 5 2
```

### 输出

```
38
```

## 样例 #2

### 输入

```
8

2 8 8

1 5 1

4 8 2

2 5 4

3 8 6

6 8 9

2 7 12
```

### 输出

```
132
```



---

---
title: "[AGC032E] Modulo Pairing"
layout: "post"
diff: 省选/NOI-
pid: AT_agc032_e
tag: ['贪心', '二分']
---

# [AGC032E] Modulo Pairing

## 题目描述

[problemUrl]: https://atcoder.jp/contests/agc032/tasks/agc032_e

$ M $ を正整数とします。

$ 2\ N $ 個の整数 $ a_1,\ a_2,\ \ldots,\ a_{2\ N} $ が与えられます。 ここで、各 $ i $ について $ 0\ \leq\ a_i\ <\ M $ です。

$ 2\ N $ 個の整数を $ N $ 組のペアに分けることを考えます。 このとき、各整数はちょうど $ 1 $ つのペアに属さなければなりません。

ペア $ (x,\ y) $ の *醜さ* を $ (x\ +\ y)\ \mod\ M $ と定義します。 $ N $ 組のペアの醜さの最大値を $ Z $ としたとき、$ Z $ の最小値を求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ M $ $ a_1 $ $ a_2 $ $ \cdots $ $ a_{2N} $

## 输出格式

$ N $ 組のペアの醜さの最大値を $ Z $ としたとき、$ Z $ の最小値を出力せよ。

## 说明/提示

### 制約

- 入力はすべて整数である。
- $ 1\ \leq\ N\ \leq\ 10^5 $
- $ 1\ \leq\ M\ \leq\ 10^9 $
- $ 0\ \leq\ a_i\ <\ M $

### Sample Explanation 1

例えば、$ (0,\ 5),\ (2,\ 3),\ (4,\ 9) $ とペアを作ればよいです。 このとき、ペアの醜さはそれぞれ $ 5,\ 5,\ 3 $ となります。

### Sample Explanation 2

$ (1,\ 9),\ (1,\ 9) $ とペアを作ればよいです。 このとき、ペアの醜さはともに $ 0 $ です。

## 样例 #1

### 输入

```
3 10

0 2 3 4 5 9
```

### 输出

```
5
```

## 样例 #2

### 输入

```
2 10

1 9 1 9
```

### 输出

```
0
```



---

---
title: "[AGC034C] Tests"
layout: "post"
diff: 省选/NOI-
pid: AT_agc034_c
tag: ['数学', '贪心', '二分']
---

# [AGC034C] Tests

## 题目描述

[problemUrl]: https://atcoder.jp/contests/agc034/tasks/agc034_c

高橋くんと青木くんは $ 1 $ から $ N $ までの番号がついたテストを受けようとしています。 二人はこのテストの結果を使って勝負することにしました。 具体的には、次のようにして勝敗を決めます。

- 高橋くんが各テスト $ i $ について、その重要度 $ c_i $ を決める。ただしこの値は $ l_i $ 以上 $ u_i $ 以下の整数である必要がある。
- $ \sum_{i=1}^{N}\ c_i\ \times $ (高橋くんのテスト $ i $ の点数) を $ A $, $ \ $ $ \sum_{i=1}^{N}\ c_i\ \times $ (青木くんのテスト $ i $ の点数) を $ B $ とする。 $ A\ \geq\ B $ なら高橋くんの勝ち、$ A\ <\ B $ なら青木くんの勝ち。

高橋くんはエスパーなので、青木くんがテスト $ i $ で $ b_i $ 点をとることがわかっています。

高橋くんはこのままだとすべてのテストで $ 0 $ 点をとってしまいますが、 $ 1 $ 時間勉強するごとに、好きなテストの点数を $ 1 $ だけ上げることができます。($ 1 $ 時間単位でしか勉強できません。) ただしテストはすべて **$ X $ 点満点**なので、 $ X $ より大きい点数にすることはできません。

高橋くんが勝つために必要な最小の勉強時間を出力してください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ X $ $ b_1 $ $ l_1 $ $ u_1 $ $ b_2 $ $ l_2 $ $ u_2 $ $ : $ $ b_N $ $ l_N $ $ u_N $

## 输出格式

高橋くんが勝つために必要な最小の勉強時間を出力せよ。

## 说明/提示

### 制約

- $ 1\ ≦\ N\ ≦\ 10^5 $
- $ 1\ ≦\ X\ ≦\ 10^5 $
- $ 0\ ≦\ b_i\ ≦\ X $ $ (1\ \leq\ i\ \leq\ N) $
- $ 1\ ≦\ l_i\ ≦\ u_i\ ≦\ 10^5 $ $ (1\ \leq\ i\ \leq\ N) $
- 入力はすべて整数

### Sample Explanation 1

例えば次のようにするのが最適です。 - $ c_1\ =\ 3,\ c_2\ =\ 1 $ とする。 - テスト $ 1 $ で $ 100 $ 点、テスト $ 2 $ で $ 15 $ 点とるように勉強する。 このとき $ A\ =\ 3\ \times\ 100\ +\ 1\ \times\ 15\ =\ 315 $, $ B\ =\ 3\ \times\ 85\ +\ 1\ \times\ 60\ =\ 315 $ なので高橋くんが勝ちます。

## 样例 #1

### 输入

```
2 100

85 2 3

60 1 1
```

### 输出

```
115
```

## 样例 #2

### 输入

```
2 100

85 2 3

60 10 10
```

### 输出

```
77
```

## 样例 #3

### 输入

```
1 100000

31415 2718 2818
```

### 输出

```
31415
```

## 样例 #4

### 输入

```
10 1000

451 4593 6263

324 310 6991

378 1431 7068

71 1757 9218

204 3676 4328

840 6221 9080

684 1545 8511

709 5467 8674

862 6504 9835

283 4965 9980
```

### 输出

```
2540
```



---

---
title: "[AGC037E] Reversing and Concatenating"
layout: "post"
diff: 省选/NOI-
pid: AT_agc037_e
tag: ['贪心']
---

# [AGC037E] Reversing and Concatenating

## 题目描述

[problemUrl]: https://atcoder.jp/contests/agc037/tasks/agc037_e

高橋君は英小文字からなる長さ $ N $ の文字列 $ S $ を持っています。 高橋君は $ S $ に対して以下の操作を $ K $ 回行うことにしました。

- $ S $ を反転した文字列を $ T $ として、$ S $ と $ T $ をこの順に連結して得られる文字列を $ U $ とする。
- ある $ U $ の連続する長さ $ N $ の部分文字列を $ S' $ として、$ S $ を $ S' $ で置き換える。

最終的な $ S $ として考えられる文字列の内、辞書順で最小のものを求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ K $ $ S $

## 输出格式

最終的な $ S $ として考えられる文字列の内、辞書順で最小のものを出力せよ。

## 说明/提示

### 制約

- $ 1\ ≦\ N\ ≦\ 5000 $
- $ 1\ ≦\ K\ ≦\ 10^9 $
- $ |S|=N $
- $ S $ は英小文字からなる

### Sample Explanation 1

$ S= $`bacba`のとき、$ T= $`abcab`, $ U= $`bacbaabcab`であるので $ S'= $`aabca`とするのが最適です。

## 样例 #1

### 输入

```
5 1

bacba
```

### 输出

```
aabca
```

## 样例 #2

### 输入

```
10 2

bbaabbbaab
```

### 输出

```
aaaabbaabb
```



---

---
title: "[AGC045B] 01 Unbalanced"
layout: "post"
diff: 省选/NOI-
pid: AT_agc045_b
tag: ['数学', '贪心', '前缀和']
---

# [AGC045B] 01 Unbalanced

## 题目描述

[problemUrl]: https://atcoder.jp/contests/agc045/tasks/agc045_b

文字列 $ S $ が与えられます． $ S $ の各文字は，`0`,`1`,`?` のいずれかです．

$ S $ に含まれる全ての `?` を `0` か `1` に変えて（`?` ごとに変換後の文字を選択できます），文字列 $ S' $ を作ることを考えます． ここで，$ S' $ のアンバランス度を，次のように定義します．

- $ S' $ のアンバランス度 $ =\ \max\ \{\ S' $ の $ l $ 文字目から $ r $ 文字目までに含まれる `0` の個数と `1` の個数の差の絶対値 $ :\ 1\ \leq\ l\ \leq\ r\ \leq\ |S|\} $

$ S' $ のアンバランス度としてありうる最小の値を求めてください．

## 输入格式

入力は以下の形式で標準入力から与えられる．

> $ S $

## 输出格式

$ S' $ のアンバランス度としてありうる最小の値を出力せよ．

## 说明/提示

### 制約

- $ 1\ \leq\ |S|\ \leq\ 10^6 $
- $ S $ の各文字は `0`,`1`,`?` のいずれかである．

### Sample Explanation 1

$ S'= $`010` とすれば，アンバランス度は $ 1 $ になり，これが最小です．

## 样例 #1

### 输入

```
0??
```

### 输出

```
1
```

## 样例 #2

### 输入

```
0??0
```

### 输出

```
2
```

## 样例 #3

### 输入

```
??00????0??0????0?0??00??1???11?1?1???1?11?111???1
```

### 输出

```
4
```



---

---
title: "[AGC053C] Random Card Game"
layout: "post"
diff: 省选/NOI-
pid: AT_agc053_c
tag: ['贪心', '概率论', '期望']
---

# [AGC053C] Random Card Game

## 题目描述

[problemUrl]: https://atcoder.jp/contests/agc053/tasks/agc053_c

$ 2N $ 枚のカードがあり、それぞれには $ 1 $ から $ 2N $ までの番号が付いています。 このカードを用いて行う、次のゲームを考えます。

まず、ディーラーはそれぞれの山が $ N $ 枚のカードからなるように、カードを $ 2 $ つの山にランダムに分けます。 このとき、ディーラーは各山におけるカードの順序もランダムに定めます。 その後プレイヤーは、一方の山が空になるまで次の操作を繰り返し行い、最終的な操作回数がこのゲームのスコアとなります。

- ある正の整数 $ k $ を選び、一方の山の上から $ k $ 枚目のカードと、もう一方の山の上から $ k $ 枚目のカードを比較する。（ただし、$ k $ は各山のカード枚数を超えてはいけない。）そして、番号が小さい方のカードをそのカードを含む山から取り除く。

このゲームを *チーター* がプレイするとします。 つまり、各山の各カードの番号を常に把握できるプレイヤーがプレイするとします。 このプレイヤーがスコアを最小化するよう最適にプレイしたときの、スコアの期待値を $ \bmod\ 10^9+7 $ で求めてください（注記参照）。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $

## 输出格式

答えを出力せよ。

## 说明/提示

### 注記

- 求める期待値は有理数となります。期待値を分数 $ \frac{y}{x} $（$ x $ と $ y $ は互いに素な正の整数）で表したとき、$ x $ は $ P=10^9+7 $ と互いに素になるので、 $ xz\ \equiv\ y\ \pmod\ P $ なる $ 0 $ 以上 $ P-1 $ 以下の唯一の整数 $ z $ を出力してください。

### 制約

- $ 1\ \leq\ N\ \leq\ 10^6 $

## 样例 #1

### 输入

```
1
```

### 输出

```
1
```

## 样例 #2

### 输入

```
3
```

### 输出

```
486111118
```



---

---
title: "[ARC076F] Exhausted?"
layout: "post"
diff: 省选/NOI-
pid: AT_arc076_d
tag: ['贪心', '网络流', '排序']
---

# [ARC076F] Exhausted?

## 题目描述

[problemUrl]: https://atcoder.jp/contests/arc076/tasks/arc076_d

椅子が $ M $ 個数直線上に並んでおり、$ i $ 番目の椅子 $ (1\ ≦\ i\ ≦\ M) $ は座標 $ i $ にあります。

高橋君が $ N $ 人います。高橋君たちはゲームのやりすぎで全員腰を痛めたため、どこかの椅子に座る必要があります。 各々の高橋君たちが座る椅子にはこだわりがあって、$ i $ 人目の高橋君は座標 $ L_i $ 以下、もしくは座標 $ R_i $ 以上の椅子に座りたいです。当然ながら、同じ椅子には $ 1 $ 人しか座れません。

このままでは、高橋君たち全員を椅子に座らせることができないかもしれません。 高橋君たちの健康管理に気を遣っている青木君は、椅子をできるだけ少ない数追加することで、 高橋君たち全員のこだわりを満たすように高橋君たちを椅子に座らせることができるようにしたいです。

椅子は、任意の実数座標に追加できます。追加する必要のある椅子の最小の個数を求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ M $ $ L_1 $ $ R_1 $ $ : $ $ L_N $ $ R_N $

## 输出格式

追加する必要のある椅子の最小の個数を出力せよ。

## 说明/提示

### 制約

- $ 1\ ≦\ N,M\ ≦\ 2\ ×\ 10^5 $
- $ 0\ ≦\ L_i\ <\ R_i\ ≦\ M\ +\ 1(1\ ≦\ i\ ≦\ N) $
- 入力は全て整数である

### Sample Explanation 1

$ 4 $ 人の高橋君を順に座標 $ 3,2,1,4 $ にある椅子に座らせることができるため、椅子を追加する必要はありません。

### Sample Explanation 2

座標 $ 0 $ と $ 2.5 $ に椅子を追加すれば、$ 7 $ 人の高橋君を順に座標 $ 0,5,3,2,6,1,2.5 $ に座らせることができます。

## 样例 #1

### 输入

```
4 4

0 3

2 3

1 3

3 4
```

### 输出

```
0
```

## 样例 #2

### 输入

```
7 6

0 7

1 5

3 6

2 7

1 6

2 6

3 7
```

### 输出

```
2
```

## 样例 #3

### 输入

```
3 1

1 2

1 2

1 2
```

### 输出

```
2
```

## 样例 #4

### 输入

```
6 6

1 6

1 6

1 5

1 5

2 6

2 6
```

### 输出

```
2
```



---

---
title: "[ARC169D] Add to Make a Permutation"
layout: "post"
diff: 省选/NOI-
pid: AT_arc169_d
tag: ['数学', '贪心', '数论']
---

# [ARC169D] Add to Make a Permutation

## 题目描述

[problemUrl]: https://atcoder.jp/contests/arc169/tasks/arc169_d

長さ $ N $ の整数列 $ A=(A_1,A_2,\cdots,A_N) $ が与えられます． $ A $ の各要素は $ 0 $ 以上 $ N-1 $ 以下の整数です．

あなたは以下の操作を $ 0 $ 回以上行うことができます．

- $ A $ の中からちょうど $ M $ 個の要素を選ぶ． そして，選んだ要素の値をそれぞれ $ 1 $ 増加させる． 増加させたあとに値が $ N $ になっている要素があれば，その値を $ 0 $ に変更する．
 
あなたの目標は $ A $ を $ (0,1,\cdots,N-1) $ の順列にすることです． 目標が達成可能か判定し，可能ならば必要な最小の操作回数を求めてください．

## 输入格式

入力は以下の形式で標準入力から与えられる．

> $ N $ $ M $ $ A_1 $ $ A_2 $ $ \cdots $ $ A_N $

## 输出格式

目標が達成不可能な場合，$ -1 $ を出力せよ． 可能な場合，必要な最小の操作回数を出力せよ．

## 说明/提示

### 制約

- $ 2\ \leq\ N\ \leq\ 250000 $
- $ 1\ \leq\ M\ \leq\ N-1 $
- $ 0\ \leq\ A_i\ \leq\ N-1 $
- 入力される値はすべて整数．
 
### Sample Explanation 1

以下のように操作すると $ 2 $ 回の操作で目標を達成できます． - 初期状態: $ A=(0,1,1) $ - $ 1 $ 回目の操作: $ A_1,A_2 $ を選んで操作を行い，$ A=(1,2,1) $ になる． - $ 2 $ 回目の操作: $ A_2,A_3 $ を選んで操作を行い，$ A=(1,0,2) $ になる． $ 2 $ 回未満の操作で目標を達成することはできないため，答えは $ 2 $ になります．

## 样例 #1

### 输入

```
3 2

0 1 1
```

### 输出

```
2
```

## 样例 #2

### 输入

```
5 2

0 4 2 3 1
```

### 输出

```
0
```

## 样例 #3

### 输入

```
4 2

0 0 1 2
```

### 输出

```
-1
```

## 样例 #4

### 输入

```
20 15

5 14 18 0 8 5 0 10 6 5 11 2 10 10 17 9 8 14 4 4
```

### 输出

```
10
```



---

---
title: "[ARC177E] Wrong Scoreboard"
layout: "post"
diff: 省选/NOI-
pid: AT_arc177_e
tag: ['贪心', '状态合并']
---

# [ARC177E] Wrong Scoreboard

## 题目描述

[problemUrl]: https://atcoder.jp/contests/arc177/tasks/arc177_e

AtCoder World Tour Finals 2800 には $ N $ 人の選手が参加し、全 $ 5 $ 問の問題が出題されました。 各問題には $ 1 $ 点以上の整数の配点が付けられており、配点が**広義単調増加**になるように、問 $ 1 $ から問 $ 5 $ までの問題番号が付けられています。 ここで部分点はありません。 また、通常の AtCoder のルールと同様、以下の方法で順位付けが行われます。**なお、本問では合計得点もペナルティも同じという状況は考えないことにします。**

 順位付けの方法合計得点の高い方が上の順位となる。同点の場合は、ペナルティが $ 1 $ 秒でも少ない方が上の順位となる。さて、AtCoder World Tour Finals の取材を担当している青木記者は、以下の情報をメモしました。

1. 参加者数 $ N $。
2. 各選手がどの問題を解いたかの情報。$ A_{i,j}=1 $ のとき $ i $ 番目の選手 $ (1\ \leq\ i\ \leq\ N) $ は問 $ j $ を正解し、$ A_{i,j}=0 $ のとき正解しなかった。
3. 各選手の順位。$ i $ 番目の選手 $ (1\ \leq\ i\ \leq\ N) $ は $ R_i $ 位を獲得した。
 
しかし、記事を書き始めようとしたとき、彼は配点およびペナルティの情報をメモしていないことに気付きました。 さらに、メモした情報に矛盾があるかもしれないことにも気付きました。 そこで以下の問題を解いてください。

> メモ 1 およびメモ 2 が正しいと仮定する。 選手 $ i $ $ (1\ \leq\ i\ \leq\ N) $ の実際の順位を $ D_i $ とするとき、二乗誤差の合計 $ (D_1\ -\ R_1)^2\ +\ (D_2\ -\ R_2)^2\ +\ \dots\ +\ (D_N\ -\ R_N)^2 $ として考えられる最小値を求めよ。

$ T $ 個のテストケースが与えられるので、それぞれについて答えを求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられます。ここで $ \mathrm{case}_i $ は $ i $ 番目 $ (1\ \leq\ i\ \leq\ T) $ のテストケースを意味します。

> $ T $ $ \mathrm{case}_1 $ $ \mathrm{case}_2 $ $ \vdots $ $ \mathrm{case}_T $

各テストケースは、以下の形式で与えられます。

> $ N $ $ A_{1,1} $ $ A_{1,2} $ $ A_{1,3} $ $ A_{1,4} $ $ A_{1,5} $ $ A_{2,1} $ $ A_{2,2} $ $ A_{2,3} $ $ A_{2,4} $ $ A_{2,5} $ $ \vdots $ $ A_{N,1} $ $ A_{N,2} $ $ A_{N,3} $ $ A_{N,4} $ $ A_{N,5} $ $ R_1 $ $ R_2 $ $ \cdots $ $ R_N $

## 输出格式

答えを出力してください。

## 说明/提示

### 制約

- $ 1\ \leq\ T\ \leq\ 10^5 $
- $ 2\ \leq\ N\ \leq\ 3\ \times\ 10^5 $
- $ A_{i,1},\ A_{i,2},\ A_{i,3},\ A_{i,4},\ A_{i,5} $ は $ 0 $ または $ 1 $ $ (1\ \leq\ i\ \leq\ N) $
- $ A_{i,1},\ A_{i,2},\ A_{i,3},\ A_{i,4},\ A_{i,5} $ の合計は $ 1 $ 以上 $ (1\ \leq\ i\ \leq\ N) $
- $ 1\ \leq\ R_i\ \leq\ N $ $ (1\ \leq\ i\ \leq\ N) $
- $ R_1,\ R_2,\ \dots,\ R_N $ は相異なる
- すべてのテストケースにおける $ N $ の値の合計は $ 3\ \times\ 10^5 $ 以下
- 入力はすべて整数
 
### Sample Explanation 1

この入力には全部で $ 6 $ 個のテストケースがありますが、まずは $ 1 $ つ目のテストケースについて説明します。 &gt; 以下のような場合を考えます。 &gt; &gt; - $ 1,\ 2,\ 3,\ 4,\ 5 $ 問目の配点がそれぞれ $ 100 $ 点、$ 500 $ 点、$ 800 $ 点、$ 900 $ 点、$ 1300 $ 点である。 &gt; - $ 1,\ 2,\ 3,\ 4 $ 番目の参加者のペナルティがそれぞれ $ 90 $ 分、$ 80 $ 分、$ 70 $ 分、$ 60 $ 分である。 &gt; &gt; このとき、順位表は下表のようになり、二乗誤差の合計は $ (2-1)^2\ +\ (3-2)^2\ +\ (1-3)^2\ +\ (4-4)^2\ =\ 6 $ となります。二乗誤差の合計を $ 5 $ 以下にする方法は存在しないため、$ 6 $ が答えとなります。 &gt; &gt; 参加者 問 1 問 2 問 3 問 4 問 5 合計点 ペナルティ 順位 \*\*1 番目\*\* - 500 800 - - 1300 90 分 2 位 \*\*2 番目\*\* 100 - - 900 - 1000 80 分 3 位 \*\*3 番目\*\* 100 500 - 900 - 1500 70 分 1 位 \*\*4 番目\*\* 100 - 800 - - 900 60 分 4 位 - - - - - - 続いて、$ 2 $ つ目のテストケースについて説明します。 &gt; 以下のような場合を考えます。 &gt; &gt; - $ 1,\ 2,\ 3,\ 4,\ 5 $ 問目の配点がそれぞれ $ 1000 $ 点、$ 1400 $ 点、$ 2000 $ 点、$ 2000 $ 点、$ 2718 $ 点である。 &gt; - $ 1,\ 2,\ \dots,\ 8 $ 番目の参加者のペナルティがそれぞれ $ 295 $ 分、$ 286 $ 分、$ 242 $ 分、$ 236 $ 分、$ 277 $ 分、$ 288 $ 分、$ 187 $ 分、$ 299 $ 分である。 &gt; &gt; このとき、順位表は下表のようになります。どの $ i $ $ (1\ \leq\ i\ \leq\ N) $ についても $ i $ 番目の参加者の順位が $ R_i $ となっているため、二乗誤差の合計は $ 0 $ となります。 &gt; &gt; 参加者 問 1 問 2 問 3 問 4 問 5 合計点 ペナルティ 順位 \*\*1 番目\*\* - 1400 - - - 1400 295 分 7 位 \*\*2 番目\*\* 1000 1400 - 2000 - 4400 286 分 4 位 \*\*3 番目\*\* - 1400 2000 - 2718 6118 242 分 2 位 \*\*4 番目\*\* 1000 - - - - 1000 236 分 8 位 \*\*5 番目\*\* 1000 1400 - 2000 - 4400 277 分 3 位 \*\*6 番目\*\* - 1400 - - - 1400 288 分 6 位 \*\*7 番目\*\* - - - 2000 - 2000 187 分 5 位 \*\*8 番目\*\* - 1400 2000 2000 2718 8118 299 分 1 位

## 样例 #1

### 输入

```
6

4

0 1 1 0 0

1 0 0 1 0

1 1 0 1 0

1 0 1 0 0

1 2 3 4

8

0 1 0 0 0

1 1 0 1 0

0 1 1 0 1

1 0 0 0 0

1 1 0 1 0

0 1 0 0 0

0 0 0 1 0

0 1 1 1 1

7 4 2 8 3 6 5 1

6

1 1 0 0 0

0 0 1 0 0

1 1 1 0 0

0 0 0 1 0

1 1 1 1 0

0 0 0 0 1

1 2 3 4 5 6

6

1 1 0 0 0

0 0 1 0 0

1 1 1 0 0

0 0 0 1 0

1 1 1 1 0

0 0 0 0 1

6 5 4 3 2 1

20

0 0 0 0 1

0 0 1 0 0

1 1 0 0 1

1 0 1 0 1

0 0 0 1 1

0 0 1 1 1

1 1 1 1 0

1 1 0 1 0

0 0 1 1 0

1 0 1 0 0

0 1 0 0 1

0 1 1 1 1

1 1 1 1 1

0 1 0 1 0

1 0 0 0 1

1 1 1 0 0

0 1 1 1 0

0 0 0 1 0

1 1 1 0 1

1 1 0 1 1

7 18 3 5 19 11 13 2 4 10 14 15 17 6 16 9 8 12 1 20

15

0 0 1 1 0

0 0 0 1 0

0 0 0 0 1

0 0 1 1 1

1 1 0 0 1

0 1 1 1 0

1 1 1 1 1

0 1 1 0 1

1 1 0 1 0

1 0 0 1 1

1 0 1 0 0

1 1 0 1 1

0 1 0 1 0

1 1 0 0 0

0 1 0 0 1

1 2 3 4 5 6 7 8 9 10 11 12 13 14 15
```

### 输出

```
6

0

26

0

1054

428
```



---

---
title: "[ARC183D] Keep Perfectly Matched"
layout: "post"
diff: 省选/NOI-
pid: AT_arc183_d
tag: ['贪心', '构造']
---

# [ARC183D] Keep Perfectly Matched

## 题目描述

[problemUrl]: https://atcoder.jp/contests/arc183/tasks/arc183_d

$ 1 $ から $ N $ までの番号のついた $ N $ 頂点からなる木があります． $ i $ 番目の辺は頂点 $ A_i $ と頂点 $ B_i $ を結ぶ辺です． ここで $ N $ は偶数で，さらにこの木は完全マッチングを持ちます． 具体的には，各 $ i $ ($ 1\ \leq\ i\ \leq\ N/2 $) に対し，$ A_i=i\ \times\ 2-1,B_i=i\ \times\ 2 $ が保証されます．

あなたは以下の操作を $ N/2 $ 回行います．

- 葉 (次数がちょうど $ 1 $ の頂点) を $ 2 $ つ選び，木から削除する． ただしここで，削除したあとの木も完全マッチングを持つ必要がある． なお，この問題では頂点が $ 0 $ 個の場合も木と呼ぶことにする．
 
各操作について，そのスコアを「選んだ $ 2 $ つの頂点の間の距離 (その $ 2 $ つの頂点を結ぶ単純パス上の辺の個数) 」とします．

スコアの合計を最大化するような手順を $ 1 $ つ示してください． なお，この問題の制約下で $ N/2 $ 回の操作を完了する手順が常に存在することが証明できます．

## 输入格式

入力は標準入力から以下の形式で与えられる。

> $ N $ $ A_1 $ $ B_1 $ $ A_2 $ $ B_2 $ $ \vdots $ $ A_{N-1} $ $ B_{N-1} $

## 输出格式

答えを以下の形式で出力せよ．

> $ X_1 $ $ Y_1 $ $ X_2 $ $ Y_2 $ $ \vdots $ $ X_{N/2} $ $ Y_{N/2} $

ここで，$ X_i,Y_i $ は $ i $ 回目の操作で選ぶ $ 2 $ つの頂点である． 解が複数存在する場合，どれを出力しても構わない．

## 说明/提示

### 制約

- $ 2\ \leq\ N\ \leq\ 250000 $
- $ N $ は偶数
- $ 1\ \leq\ A_i\ <\ B_i\ \leq\ N $ ($ 1\ \leq\ i\ \leq\ N-1 $)
- $ A_i=i\ \times\ 2\ -1,B_i=i\ \times\ 2 $ ($ 1\ \leq\ i\ \leq\ N/2 $)
- 与えられるグラフは木である
- 入力される値はすべて整数
 
### Sample Explanation 1

出力例の手順は以下の通りです． - $ 1 $ 回目の操作: 頂点 $ 4,1 $ を消す．残る木は頂点 $ 2,3 $ からなり，完全マッチングを持つ．操作のスコアは $ 3 $ である． - $ 2 $ 回目の操作: 頂点 $ 2,3 $ を消す．残る木は $ 0 $ 頂点からなり，完全マッチングを持つ．操作のスコアは $ 1 $ である． - スコアの合計は $ 3+1=4 $ になる． スコアの合計を $ 4 $ より大きくすることはできないので，この入力例はこの出力で正解できます．

## 样例 #1

### 输入

```
4

1 2

3 4

2 3
```

### 输出

```
4 1

2 3
```

## 样例 #2

### 输入

```
8

1 2

3 4

5 6

7 8

2 3

1 5

1 7
```

### 输出

```
4 8

7 6

5 3

2 1
```

## 样例 #3

### 输入

```
14

1 2

3 4

5 6

7 8

9 10

11 12

13 14

2 8

4 11

5 12

7 13

11 14

9 13
```

### 输出

```
1 6

5 2

8 12

3 7

10 4

11 9

13 14
```

## 样例 #4

### 输入

```
20

1 2

3 4

5 6

7 8

9 10

11 12

13 14

15 16

17 18

19 20

8 10

16 18

16 19

5 9

10 17

2 13

7 14

3 7

3 12
```

### 输出

```
6 1

2 15

20 13

14 19

16 4

11 18

17 12

3 5

9 7

8 10
```



---

---
title: "[ARC186E] Missing Subsequence"
layout: "post"
diff: 省选/NOI-
pid: AT_arc186_e
tag: ['贪心']
---

# [ARC186E] Missing Subsequence

## 题目描述

[problemUrl]: https://atcoder.jp/contests/arc186/tasks/arc186_e

$ 1,\dots,K $ からなる長さ $ M $ の整数列 $ (X_1,\dots,X_M) $ が与えられます。

$ 1,\dots,K $ からなる長さ $ N $ の整数列 $ (A_1,\dots,A_N) $ のうち、以下の条件を満たすものの数を $ 998244353 $ で割ったあまりを求めてください。

- $ 1,\dots,K $ からなる長さ $ M $ の整数列のうち、$ (A_1,\dots,A_N) $ の（連続とは限らない）部分列として取れないものは $ (X_1,\dots,X_M) $ のみ

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ M $ $ K $ $ X_1 $ $ X_2 $ $ \dots $ $ X_M $

## 输出格式

条件を満たす数列の数を $ 998244353 $ で割ったあまりを出力せよ。

## 说明/提示

### 制約

- $ 2\le\ M,K\ \le\ N\ \le\ 400 $
- $ 1\le\ X_i\ \le\ K $
- 入力はすべて整数
 
### Sample Explanation 1

以下の $ 4 $ 通りが条件を満たします。 - $ (2,\ 3,\ 1,\ 2,\ 3) $ - $ (2,\ 3,\ 1,\ 3,\ 2) $ - $ (3,\ 2,\ 1,\ 2,\ 3) $ - $ (3,\ 2,\ 1,\ 3,\ 2) $

## 样例 #1

### 输入

```
5 2 3

1 1
```

### 输出

```
4
```

## 样例 #2

### 输入

```
400 3 9

1 8 6
```

### 输出

```
417833302
```

## 样例 #3

### 输入

```
29 3 10

3 3 3
```

### 输出

```
495293602
```

## 样例 #4

### 输入

```
29 3 10

3 3 4
```

### 输出

```
0
```



---


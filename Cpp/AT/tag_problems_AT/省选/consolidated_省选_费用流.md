---
title: "[ABC373G] No Cross Matching"
layout: "post"
diff: 省选/NOI-
pid: AT_abc373_g
tag: ['贪心', '分治', '二分图', '费用流']
---

# [ABC373G] No Cross Matching

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc373/tasks/abc373_g

$ 2 $ 次元平面上に $ P_1,P_2,\ldots,P_N,\ Q_1,Q_2,\ldots,Q_N $ の $ 2N $ 個の点があります。 $ P_i $ の座標は $ (A_i,B_i) $、$ Q_i $ の座標は $ (C_i,D_i) $ です。 同一直線上に異なる $ 3 $ 点が存在することはありません。

$ (1,2,\ldots,N) $ の順列であるような数列 $ R=(R_1,R_2,\ldots,R_N) $ であって以下の条件を満たすような $ R $ が存在するか判定し、存在する場合は $ 1 $ つ求めてください。

- $ 1 $ 以上 $ N $ 以下のすべての整数 $ i $ について 線分 $ i $ を $ P_i $ と $ Q_{R_i} $ を端点とする線分としたとき、どの線分 $ i $ と線分 $ j $ $ (1\ \leq\ i\ <\ j\ \leq\ N) $ も互いに交差しない。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ A_1 $ $ B_1 $ $ A_2 $ $ B_2 $ $ \vdots $ $ A_N $ $ B_N $ $ C_1 $ $ D_1 $ $ C_2 $ $ D_2 $ $ \vdots $ $ C_N $ $ D_N $

## 输出格式

条件を満たす $ R $ が存在しない場合は `-1` と出力せよ。

存在する場合は $ R_1,R_2,\ldots,R_N $ を空白区切りで出力せよ。答えが複数存在する場合はどれを出力してもかまわない。

## 说明/提示

### 制約

- $ 1\ \leq\ N\ \leq\ 300 $
- $ 0\ \leq\ A_i,B_i,C_i,D_i\ \leq\ 5000 $ $ (1\ \leq\ i\ \leq\ N) $
- $ (A_i,B_i)\ \neq\ (A_j,B_j) $ $ (1\ \leq\ i\ <\ j\ \leq\ N) $
- $ (C_i,D_i)\ \neq\ (C_j,D_j) $ $ (1\ \leq\ i\ <\ j\ \leq\ N) $
- $ (A_i,B_i)\ \neq\ (C_j,D_j) $ $ (1\ \leq\ i,j\ \leq\ N) $
- 同一直線上に異なる $ 3 $ 点が存在することはない
- 入力はすべて整数

### Sample Explanation 1

以下の図のように点が並んでいます。 !\[\](https://img.atcoder.jp/abc373/G-sample.png)$ R=(2,1,3) $ とすることで $ 3 $ 本の線分は互いに交差しません。また、 $ R $ を $ (1,2,3),(1,3,2),(2,3,1),(3,1,2) $ のいずれにしても正しい答えとなります。

## 样例 #1

### 输入

```
3
0 0
2 4
4 2
0 2
2 0
4 4
```

### 输出

```
2 1 3
```

## 样例 #2

### 输入

```
8
59 85
60 57
72 12
3 27
16 58
41 94
77 64
97 20
32 37
7 2
57 94
35 70
38 60
97 100
5 76
38 8
```

### 输出

```
3 5 8 2 7 4 6 1
```



---

---
title: "[ABC407G] Domino Covering SUM"
layout: "post"
diff: 省选/NOI-
pid: AT_abc407_g
tag: ['网络流', '费用流']
---

# [ABC407G] Domino Covering SUM

## 题目描述

给你一个 $H$ 行 $W$ 列的网格，第 $i$ 行第 $j$ 列的格子上写有数字 $A_{i,j}$。

你要在网格上摆放若干个多米诺骨牌，每个骨牌盖住相邻的两个格子。你要保证没有任何一个格子被多于一个骨牌盖住。

求摆放完骨牌之后，所有**没有**被骨牌盖住的格子上的数字之和的最大值。

## 输入格式

第一行两个整数 $H,W(H,W\ge 1,H\times W\le 2000)$。\
接下来 $H$ 行，每行 $W$ 个整数表示 $A(-10^{12}\le A_{i,j}\le 10^{12})$。

## 输出格式

一行一个整数表示答案。

## 说明/提示

**样例解释 1**

网格如下所示：

![](https://img.atcoder.jp/abc407/5381f1b744f7aeb5255628f8154a70be.png)

以下的摆放方式中未被盖住的数字之和为 $23$。

![](https://img.atcoder.jp/abc407/138df0fb001c8e55e88f41af1ca61d63.png)

可以证明此值无法达到 $24$ 或更大，故输出 $23$。

By @[chenxi2009](/user/1020063)

## 样例 #1

### 输入

```
3 4
3 -1 -4 1
-5 9 -2 -6
-5 3 -5 8
```

### 输出

```
23
```

## 样例 #2

### 输入

```
5 5
-70 11 -45 -54 -30
-99 39 -83 -69 -77
-48 -21 -43 -96 -24
-54 -65 21 -88 -44
-90 -33 -67 -29 -62
```

### 输出

```
39
```

## 样例 #3

### 输入

```
8 9
-74832 16944 58683 32965 97236 -52995 43262 -51959 40883
-58715 13846 24919 65627 -11492 -63264 29966 -98452 -75577
40415 77202 15542 -50602 83295 85415 -35304 46520 -38742
37482 56721 -38521 63127 55608 95115 42893 10484 70510
53019 40623 25885 -10246 70973 32528 -33423 19322 52097
79880 74931 -58277 -33783 91022 -53003 11085 -65924 -63548
78622 -77307 81181 46875 -81091 63881 11160 -82217 -55492
62770 39530 -95923 92440 -69899 77737 89392 -14281 84899
```

### 输出

```
2232232
```



---

---
title: "[AGC034D] Manhattan Max Matching"
layout: "post"
diff: 省选/NOI-
pid: AT_agc034_d
tag: ['二分图', '费用流']
---

# [AGC034D] Manhattan Max Matching

## 题目描述

[problemUrl]: https://atcoder.jp/contests/agc034/tasks/agc034_d

すぬけくんは、二次元平面上に赤いボールと青いボールを置いて遊んでいます。

すぬけくんはまず、赤いボールを置く操作を $ N $ 回行いました。 $ i $ 回目の操作では、座標 $ (RX_i,RY_i) $ に $ RC_i $ 個の赤いボールを置きました。 すぬけくんは次に、青いボールを置く操作を $ N $ 回行いました。 $ i $ 回目の操作では、座標 $ (BX_i,BY_i) $ に $ BC_i $ 個の青いボールを置きました。 ここで、すぬけくんが置いた赤いボールの個数の総和と青いボールの個数の総和は等しいです。 つまり、$ \sum_{i=1}^{N}\ RC_i\ =\ \sum_{i=1}^{N}\ BC_i $ です。 以後、この値を $ S $ とおきます。

すぬけくんはこれから、赤いボールと青いボールのペアを $ S $ 個作ろうとしています。 どのボールも、ちょうど $ 1 $ つのペアに属するようにします。 ここで、座標 $ (rx,ry) $ にある赤いボールと座標 $ (bx,by) $ にある青いボールのペアのスコアを、 $ |rx-bx|\ +\ |ry-by| $ と定義します。

すぬけくんは、ペアのスコアの総和を最大化したいです。 すぬけくんのために、ペアのスコアの総和の最大値を求めてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ RX_1 $ $ RY_1 $ $ RC_1 $ $ RX_2 $ $ RY_2 $ $ RC_2 $ $ \vdots $ $ RX_N $ $ RY_N $ $ RC_N $ $ BX_1 $ $ BY_1 $ $ BC_1 $ $ BX_2 $ $ BY_2 $ $ BC_2 $ $ \vdots $ $ BX_N $ $ BY_N $ $ BC_N $

## 输出格式

ペアのスコアの総和の最大値を出力せよ。

## 说明/提示

### 制約

- $ 1\ \leq\ N\ \leq\ 1000 $
- $ 0\ \leq\ RX_i,RY_i,BX_i,BY_i\ \leq\ 10^9 $
- $ 1\ \leq\ RC_i,BC_i\ \leq\ 10 $
- $ \sum_{i=1}^{N}\ RC_i\ =\ \sum_{i=1}^{N}\ BC_i $
- 入力される値はすべて整数である。

### Sample Explanation 1

座標 $ (0,0) $ に置いてある赤いボールと座標 $ (2,2) $ に置いてある青いボールをペアにすると、 そのスコアは $ |0-2|\ +\ |0-2|=4 $ です。 また、座標 $ (3,2) $ に置いてある赤いボールと座標 $ (5,0) $ に置いてある青いボールをペアにすると、 そのスコアは $ |3-5|\ +\ |2-0|=4 $ です。 この $ 2 $ つのペアを作ると、スコアの総和は $ 8 $ になり、これが最大です。

### Sample Explanation 2

同じ座標に複数回操作を行うこともあります。

## 样例 #1

### 输入

```
2

0 0 1

3 2 1

2 2 1

5 0 1
```

### 输出

```
8
```

## 样例 #2

### 输入

```
3

0 0 1

2 2 1

0 0 2

1 1 1

1 1 1

3 3 2
```

### 输出

```
16
```

## 样例 #3

### 输入

```
10

582463373 690528069 8

621230322 318051944 4

356524296 974059503 6

372751381 111542460 9

392867214 581476334 6

606955458 513028121 5

882201596 791660614 9

250465517 91918758 3

618624774 406956634 6

426294747 736401096 5

974896051 888765942 5

726682138 336960821 3

715144179 82444709 6

599055841 501257806 6

390484433 962747856 4

912334580 219343832 8

570458984 648862300 6

638017635 572157978 10

435958984 585073520 7

445612658 234265014 6
```

### 输出

```
45152033546
```



---


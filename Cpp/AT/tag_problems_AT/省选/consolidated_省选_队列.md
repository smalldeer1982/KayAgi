---
title: "[ABC376G] Treasure Hunting"
layout: "post"
diff: 省选/NOI-
pid: AT_abc376_g
tag: ['贪心', '优先队列']
---

# [ABC376G] Treasure Hunting

## 题目描述

[problemUrl]: https://atcoder.jp/contests/abc376/tasks/abc376_g

頂点に $ 0 $ から $ N $ までの番号がついた $ N\ +\ 1 $ 頂点の根付き木があります。頂点 $ 0 $ は根で、頂点 $ i $ の親は頂点 $ p_i $ です。  
 頂点 $ 1 $, 頂点 $ 2 $, $ \dots $, 頂点 $ N $ のうちどこか $ 1 $ 頂点に宝が隠されています。頂点 $ i $ に宝がある確率は $ \frac{a_i}{\sum_{j=1}^N\ a_j} $ です。 また、各頂点には「探索済」と「未探索」のどちらか一方の状態を持ちます。はじめ頂点 $ 0 $ は探索済で、それ以外の頂点は未探索です。  
 あなたは、宝がある頂点が探索済になるまで以下の操作を行います。

- 親が探索済であるような未探索の頂点を選び、その頂点を探索済にする。
 
操作回数の期待値が最小になるように行動した時の操作回数の期待値を $ \text{mod\ }998244353 $ で求めてください。

$ T $ 個のテストケースが与えられるので、それぞれに対して答えを求めてください。

  期待値 $ \text{mod\ }{998244353} $ の定義 求める期待値は必ず有理数になることが証明できます。 また、この問題の制約のもとでは、その値を既約分数 $ \frac{P}{Q} $ で表した時、$ Q\ \not\ \equiv\ 0\ \pmod{998244353} $ となることも証明できます。このとき、$ R\ \times\ Q\ \equiv\ P\ \pmod{998244353},\ 0\ \leq\ R\ \lt\ 998244353 $ を満たす整数 $ R $ が一意に定まります。この $ R $ を答えてください。

## 输入格式

入力は以下の形式で標準入力から与えられる。ここで $ \mathrm{case}_i $ は $ i $ 番目のテストケースを意味する。

> $ T $ $ \mathrm{case}_1 $ $ \mathrm{case}_2 $ $ \vdots $ $ \mathrm{case}_T $

各テストケースは以下の形式で与えられる。

> $ N $ $ p_1 $ $ p_2 $ $ \dots $ $ p_N $ $ a_1 $ $ a_2 $ $ \dots $ $ a_N $

## 输出格式

$ T $ 行出力せよ。$ i $ 行目には $ i $ 番目のテストケースの答えを出力せよ。

## 说明/提示

### 制約

- $ 1\ \leq\ T\ \leq\ 2\ \times\ 10^5 $
- $ 1\ \leq\ N\ \leq\ 2\ \times\ 10^5 $
- $ 0\ \leq\ p_i\ \lt\ i $
- $ 1\ \leq\ a_i $
- $ \sum_{i=1}^N\ a_i\ \leq\ 10^8 $
- 全てのテストケースに対する $ N $ の総和は $ 2\ \times\ 10^5 $ 以下
- 入力される値は全て整数
 
### Sample Explanation 1

$ 1 $ 番目のテストケースにおける操作回数の期待値は $ \frac{13}{6} $ です。

## 样例 #1

### 输入

```
3

3

0 0 1

1 2 3

5

0 1 0 0 0

8 6 5 1 7

10

0 1 1 3 3 1 4 7 5 4

43 39 79 48 92 90 76 30 16 30
```

### 输出

```
166374061

295776107

680203339
```



---

---
title: "[AGC014E] Blue and Red Tree"
layout: "post"
diff: 省选/NOI-
pid: AT_agc014_e
tag: ['线段树', '深度优先搜索 DFS', '队列']
---

# [AGC014E] Blue and Red Tree

## 题目描述

[problemUrl]: https://atcoder.jp/contests/agc014/tasks/agc014_e

$ N $ 頂点からなる木があり、頂点には $ 1 $ から $ N $ の番号がついています。 また、 $ N-1 $ 本の辺の内、$ i $ 番目の辺は頂点 $ a_i $ と頂点 $ b_i $ を結んでいます。

はじめ、各辺は青色に塗られています。 そこで、高橋君は以下の操作を $ N-1 $ 回行い、赤色の木に作り替えることにしました。

- 青色の辺のみからなるパスを一つ選び、そのパス上の辺を一つ取り除く。
- その後、初めに選んだパスの両端点間に赤色の辺を追加する。

最終的に、各 $ i $ に対し、頂点 $ c_i $ と頂点 $ d_i $ を結ぶ赤い辺が存在するような $ N $ 頂点の木に作り替えたいです。

これが可能であるかどうか判定してください。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ a_1 $ $ b_1 $ : $ a_{N-1} $ $ b_{N-1} $ $ c_1 $ $ d_1 $ : $ c_{N-1} $ $ d_{N-1} $

## 输出格式

高橋君が木を目標の木に作り替えられるならば `YES` を、作り替えられないならば `NO` を出力せよ。

## 说明/提示

### 制約

- $ 2\ ≦\ N\ ≦\ 10^5 $
- $ 1\ ≦\ a_i,b_i,c_i,d_i\ ≦\ N $
- $ a_i\ ≠\ b_i $
- $ c_i\ ≠\ d_i $
- 入力で与えられるグラフはどちらも木である。

### Sample Explanation 1

高橋君は以下の手順で目標の赤い木を作ることができます。 - まず、頂点 $ 1 $ と頂点 $ 3 $ を結ぶパスを選び、青い辺 $ 1-2 $ を削除する。そして、赤い辺 $ 1-3 $ を追加する。 - 次に、頂点 $ 2 $ と頂点 $ 3 $ を結ぶパスを選び、青い辺 $ 2-3 $ を削除する。そして、赤い辺 $ 2-3 $ を追加する。

## 样例 #1

### 输入

```
3

1 2

2 3

1 3

3 2
```

### 输出

```
YES
```

## 样例 #2

### 输入

```
5

1 2

2 3

3 4

4 5

3 4

2 4

1 4

1 5
```

### 输出

```
YES
```

## 样例 #3

### 输入

```
6

1 2

3 5

4 6

1 6

5 1

5 3

1 4

2 6

4 3

5 6
```

### 输出

```
NO
```



---

---
title: "[ARC072F] Dam"
layout: "post"
diff: 省选/NOI-
pid: AT_arc072_d
tag: ['单调队列', '概率论', '队列']
---

# [ARC072F] Dam

## 题目描述

[problemUrl]: https://atcoder.jp/contests/arc072/tasks/arc072_d

あなたはダムを管理しています。ダムは $ L $ リットルまで水を蓄えることができます。ダムははじめ干からびています。また、毎日夜に好きな量の水を排出することができます。毎日朝にはダムに水が流入しますが、その時水が溢れないようにする必要があります。

$ i $ 日目の朝には $ t_i $ 度の水が $ v_i $ リットル流入することがわかっています。 各日について、あなたはその日の昼にダムにちょうど $ L $ リットルの水がたまっているという条件のもと、その時点でのダムの水温を最大化しようとすると何度になるかふと気になりました。各 $ i $ について水温の最大値を求めてください。ここで、各最大化のための水の排出は独立に考えるものとします。すなわち、$ i $ 日目の水温の最大化のために排出する水の量は、$ j(≠i) $ 日目の水温の最大化のために排出する水の量と異なっていても構いません。

ただし、水温は流れてくる水以外の一切の影響を受けないものとします。特に、$ T_1 $ 度、$ V_1 $ リットルの水と $ T_2 $ 度、$ V_2 $ リットルの水が混ざると $ \frac{T_1*V_1+T_2*V_2}{V_1+V_2} $ 度、$ V_1+V_2 $ リットルの水となり、これ以外で水の体積・温度が変化することはありません。

## 输入格式

入力は以下の形式で標準入力から与えられる。

> $ N $ $ L $ $ t_1 $ $ v_1 $ $ t_2 $ $ v_2 $ : $ t_N $ $ v_N $

## 输出格式

$ i $ 日目の朝にダムに $ L $ リットル蓄えることのできる水温の最大値を $ i $ 行目に出力せよ。

答えは、相対誤差または絶対誤差が $ 10^{-6} $ 以下であれば許容される。

## 说明/提示

### 制約

- $ 1≦\ N\ ≦\ 5*10^5 $
- $ 1≦\ L\ ≦\ 10^9 $
- $ 0≦\ t_i\ ≦\ 10^9(1≦i≦N) $
- $ 1≦\ v_i\ ≦\ L(1≦i≦N) $
- $ v_1\ =\ L $
- $ L,\ v_i,\ t_i $ は整数である

### Sample Explanation 1

\- $ 1 $ 日目には $ 1 $ 日目に流れ込んだ水のみがあるので、必ず$ 10 $度です。 - $ 1 $ 日目の夜に水を $ 5 $ リットル捨て、$ 2 $ 日目に流入する水と混ざると $ 10 $ リットル、$ 15 $ 度の水が $ 2 $ 日目に蓄えられます。 - $ 1 $ 日目の夜に水を $ 8 $ リットル捨て、$ 2,\ 3 $ 日目に流入する水と混ざると $ 10 $ リットル、$ 13.2 $度の水が $ 3 $ 日目に蓄えられます。

### Sample Explanation 3

水温は $ 100 $ 度を超えることがありますが、蒸発については考えません。

## 样例 #1

### 输入

```
3 10

10 10

20 5

4 3
```

### 输出

```
10.0000000

15.0000000

13.2000000
```

## 样例 #2

### 输入

```
4 15

0 15

2 5

3 6

4 4
```

### 输出

```
0.0000000

0.6666667

1.8666667

2.9333333
```

## 样例 #3

### 输入

```
4 15

1000000000 15

9 5

8 6

7 4
```

### 输出

```
1000000000.0000000

666666669.6666666

400000005.0000000

293333338.8666667
```



---

---
title: "かかし"
layout: "post"
diff: 省选/NOI-
pid: AT_joisc2014_i
tag: ['线段树', '单调队列', 'cdq 分治']
---

# かかし

## 题目描述

[problemUrl]: https://atcoder.jp/contests/joisc2014/tasks/joisc2014_i





---


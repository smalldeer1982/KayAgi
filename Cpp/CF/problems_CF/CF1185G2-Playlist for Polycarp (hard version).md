---
title: "Playlist for Polycarp (hard version)"
layout: "post"
diff: 省选/NOI-
pid: CF1185G2
tag: []
---

# Playlist for Polycarp (hard version)

## 题目描述

### 题意简述

你现在正在选择歌曲。现在共有 $n$ 首歌，每首歌有一个时长 $t_i$ 和一个编号 $g_i$ 。   
您需要求出有多少种选出若干首歌排成一排的方案，使得任意相邻两首歌的编号不同，且所有歌的时长和恰好为 $T$ 。

## 输入格式

第一行是两个整数 $n,t  (1<=n<=50,1<=T<=2500)$。    
接下来 $n$ 行，每行两个正整数 $t_i , g_i$ ，表示第 $i$ 首歌曲的时长和编号。$(1\le t_i\le 50,1\le g_i\le 3)$

## 输出格式

输出一个整数表示方案数。 答案对 $10^9 + 7$ 取模。

## 样例 #1

### 输入

```
3 3
1 1
1 2
1 3

```

### 输出

```
6

```

## 样例 #2

### 输入

```
3 3
1 1
1 1
1 3

```

### 输出

```
2

```

## 样例 #3

### 输入

```
4 10
5 3
2 1
3 2
5 1

```

### 输出

```
10

```


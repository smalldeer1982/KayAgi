---
title: "Dynamic Diameter"
layout: "post"
diff: 省选/NOI-
pid: CF1192B
tag: []
---

# Dynamic Diameter

## 题目描述

有一个 $n$ 个点的带权无向树，$q$ 次操作，每次修改一条边的权值，要求在每次修改后，输出树的直径大小，强制在线。

## 输入格式

第一行，$3$ 个由空格分隔的整数 $n,q,w$,（$2\le n\le 10^5$, $1\le q\le 10^5$, $1\le w\le 2\times 10^{13}$），代表有 $n$ 个点，$q$ 次修改，操作过程中每条边的最大权值为 $w-1$。

之后 $n-1$ 行，每行3个整数 $a，b，c$（$1\le a,b\le n$, $0\le c<w$），表示最初树中有一条连接 $a$ 和 $b$，权值为 $c$ 的边。

之后 $q$ 行，每行 $2$ 个整数 $d,e$（$0\le d<n-1$, $0\le e<w$）,你需要通过一定的方法对数据进行解密：
- `D=(d+las) mod (n-1)`
- `E=(e+las) mod w`

其中 $las$ 为上一次输出的结果（初始 $las=0$），表示将第 $D+1$ 条边的权值改为 $E$。

## 输出格式

输出 $q$ 行，每行一个整数，表示这次修改后树的直径。
## 评分标准
子任务1（11分）$n,q\le 100,w\le 10000$

子任务2（13分）$n,q\le 5000,w\le 10000$

子任务3（7分）$w\le 10000$,树为以 $1$ 号点为中心的菊花图

子任务4（18分）$w\le 10000$,树为以 $1$ 号点为根的平衡二叉树

子任务5（24分）任意时刻存在一条树的直径经过 $1$ 号点

子任务6（27分）无特殊约定

## 样例 #1

### 输入

```
4 3 2000
1 2 100
2 3 1000
2 4 1000
2 1030
1 1020
1 890

```

### 输出

```
2030
2080
2050

```

## 样例 #2

### 输入

```
10 10 10000
1 9 1241
5 6 1630
10 5 1630
2 6 853
10 1 511
5 3 760
8 3 1076
4 10 1483
7 10 40
8 2051
5 6294
5 4168
7 1861
0 5244
6 5156
3 3001
8 5267
5 3102
8 3623

```

### 输出

```
6164
7812
8385
6737
6738
7205
6641
7062
6581
5155

```


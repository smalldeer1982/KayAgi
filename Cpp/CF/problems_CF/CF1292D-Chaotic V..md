---
title: "Chaotic V."
layout: "post"
diff: 省选/NOI-
pid: CF1292D
tag: []
---

# Chaotic V.

## 题目描述

设$x$是大于$1$的正整数，定义$f(x)$为$x$的最小质因子的值。

现在考虑构造一棵树$T$。其中节点均用从$1$开始的正整数编号，对于任意大于$1$的正整数$x$，节点$x$在树上的父亲是$\frac{x}{f(x)}$。

在这棵树上有$n$个关键节点，很特别地，这$n$个节点的编号均可以表示成一个非负整数的阶乘。更具体地，第$i$个节点$P_i$的编号为$k_i!=\prod_{j=1}^{k_i}j$。

定义$\text{DIS}(i,j)$表示树上$i,j$两点间最短路所包含的边数。现在你找出树上的一个节点$P$，最小化$\sum_{i=1}^n\text{DIS}(P,P_i)$的值。你只需要输出这个最小值即可。

## 输入格式

第一行一个正整数$n(1\leq n\leq 10^6)$，代表节点数。

第二行$n$个非负整数$k_i(0\leq k_i\leq 5\times 10^3)$，描述节点$P_i$的编号为$k_i!$。

## 输出格式

一行一个非负整数表示答案。

## 样例 #1

### 输入

```
3
2 1 4
```

### 输出

```
5
```

## 样例 #2

### 输入

```
4
3 1 4 4
```

### 输出

```
6
```

## 样例 #3

### 输入

```
4
3 1 4 1
```

### 输出

```
6
```

## 样例 #4

### 输入

```
5
3 1 4 1 5
```

### 输出

```
11
```


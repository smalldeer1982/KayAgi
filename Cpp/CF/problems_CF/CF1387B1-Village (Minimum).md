---
title: "Village (Minimum)"
layout: "post"
diff: 普及+/提高
pid: CF1387B1
tag: []
---

# Village (Minimum)

## 题目描述

### 题意

[最大值版本](https://www.luogu.com.cn/problem/CF1387B2)

村里 $n$ 个房子构成了一个 $n$ 点 $n-1$ 条边的**树**结构（下标从 $1$ 开始），每条边长度均为 $1$。一开始每个房子里分别有一个村民。

现在所有村民都需要搬家（改变自己所在的点），搬家后依然需要满足每个房子里**有且只有一个**村民。也就是说，如果原本位于点 $i$ 的村民搬到了点 $v_i$，那么应当满足：

- 对于任意点 $i$，有 $i \neq v_i$。

- 对于任意两个不同的点 $i$ 与 $j$，有 $v_i \neq v_j$。

村民 $i$ 搬家的花费是点 $i$ 到点 $v_i$ 的树上距离（即树上二点间相隔的边数），总花费为所有村民花费之和。求总花费的**最小值**及其方案。

## 输入格式

第一行一个正整数 $n$，表示树的点数。

接下来 $n-1$ 行每行二整数 $a$ 和 $b$，表示树上有一条连接 $a$ 和 $b$，长度为 $1$ 的边。

## 输出格式

第一行一个整数，表示总花费的**最小值**。

第二行 $n$ 个整数 $v_1 \dots v_n$，表示搬家的方案：如果原本位于点 $i$ 的村民搬到了点 $v_i$。

输出**任意一组**合法方案即可。

## 说明/提示

- $2 \leq n \leq 10^5$

- $1 \leq a,b \leq n$

## 样例 #1

### 输入

```
4
1 2
2 3
3 4
```

### 输出

```
4
2 1 4 3
```

## 样例 #2

### 输入

```
7
4 2
5 7
3 4
6 3
1 3
4 5
```

### 输出

```
8
3 4 6 2 7 1 5
```


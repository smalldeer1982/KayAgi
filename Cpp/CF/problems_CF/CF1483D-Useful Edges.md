---
title: "Useful Edges"
layout: "post"
diff: 提高+/省选-
pid: CF1483D
tag: []
---

# Useful Edges

## 题目描述

先有一 $n$ 个顶点的加权无向图，以及 $q$ 个三元组 （$u,v,l$）。其中每个三元组中 $u$ 与 $v$ 是顶点，$l$ 是一个正整数。如果至少有一个具有以下属性的三元组 $u,v,l$ 和一条路径（不一定是最简路径），则边 $e$ 被称为有用的边：

- $u$ 和 $v$ 是此路径的端点；

- $e$ 是这条路径的边之一；

- 此路径上的所有边的权重之和不超过 $l$；

请输出此图中有用边的数量。

## 输入格式

第一行两个整数 $n$ 与 $m$（$2\leq n\leq 600$，$0 \leq m \leq \dfrac{n(n-1)}{2}$）.

接下来 $m$ 行，每行三个整数 $u$，$v$ 与 $w$ （$1 \leq u$，$v \leq n$，$1 \leq w \leq 10^9$）。表示连接顶点 $u$ 和 $v$ 的边权重为 $w$。

接下来一行一个整数 $q$ （$1 \leq q \leq \dfrac{n(n-1)}{2} $），表示三元组的数量。

接下来 $q$ 行，每行三个整数 $u$，$v$ 与 $l$ （$1 \leq u$，$v \leq n$，$u \ne v$，$1 \leq l \leq 10^9$ ），表示三元组 $u,v,l$。

输入保证：

- 该图为一个简单图（不循环且不包含多重边）；

- 三元组中每对 $u,v$ 不重复。

## 输出格式

一个整数，为“有用边”的数量。

## 说明/提示

在第一个样例中，除了权重为 5 的边外，每条边都是有用边。

在第二个样例中，只有 1 和 2 之间的边是有用的，因为它属于路径 1-2 和 $10≤11$。3和4之间的边是没有用的。

在第三个样例中，两条边都是有用的，因为路径 $1-2-3-2$ 的长度正好为 5。 请注意，路径可能会多次通过一个顶点。

翻译者：[XiaoQuQu](https://www.luogu.com.cn/user/427623)

## 样例 #1

### 输入

```
4 6
1 2 1
2 3 1
3 4 1
1 3 3
2 4 3
1 4 5
1
1 4 4
```

### 输出

```
5
```

## 样例 #2

### 输入

```
4 2
1 2 10
3 4 10
6
1 2 11
1 3 11
1 4 11
2 3 11
2 4 11
3 4 9
```

### 输出

```
1
```

## 样例 #3

### 输入

```
3 2
1 2 1
2 3 2
1
1 2 5
```

### 输出

```
2
```


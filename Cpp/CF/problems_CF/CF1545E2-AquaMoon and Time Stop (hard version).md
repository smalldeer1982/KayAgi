---
title: "AquaMoon and Time Stop (hard version)"
layout: "post"
diff: NOI/NOI+/CTSC
pid: CF1545E2
tag: []
---

# AquaMoon and Time Stop (hard version)

## 题目描述

一个人走在步行街上。在时刻 $0$ 时，他位于坐标 $x$，并以每秒 $1$ 单位的速度移动。这个人受到了鬼的 $n$ 次诅咒，第 $i$ 次诅咒从 $tl_i-1+10^{-18}$ 开始，到 $tr_i+1-10^{-18}$ 结束（**不包含两端**），如果他走到了 $(l_i-1+10^{-18},r_i+1-10^{-18})$ 之间的位置，他就会死亡。为了拯救这个人，你可以可以在任意时刻 $t$ 停止时间，然后将他从当前坐标 $x$ 移动到任意坐标 $y$（**$t$、$x$ 和 $y$ 不一定是整数**），消耗了你 $\vert x-y\vert$ 能量。**注意：移动是连续的，所以如果在时间 $t$ 的点 $x$ 和点 $y$ 之间存在一段诅咒区域，那么这个人也会死亡。** 那么你最少要消耗多少能量呢？

## 输入格式

- 第一行包含一个整数 $n$，表示诅咒的次数。
- 第二行包含一个整数 $x$，表示此人的初始坐标。
- 以下 $n$ 行，每行四个整数 $tl_i$, $tr_i$，$l_i$，$r_i$，含义如题中所示。

## 输出格式

输出一个整数，表示你需要消耗的最小能量，四舍五入到整数。

## 说明/提示

对于 $100\%$ 的数据，$1 \le n \le 2\times 10^5$，$1 \le x \le 10^6$，$1\le tl_i\le tr_i\le 10^6$，$1\le l_i\le r_i\le 10^6$。

## 样例 #1

### 输入

```
2
1
1 2 1 2
2 3 2 3
```

### 输出

```
2
```

## 样例 #2

### 输入

```
3
4
1 4 1 2
1 4 4 15
6 7 1 4
```

### 输出

```
8
```

## 样例 #3

### 输入

```
4
3
1 5 1 1
4 10 1 4
1 2 3 13
1 10 7 19
```

### 输出

```
14
```

## 样例 #4

### 输入

```
7
5
78 96 76 91
6 16 18 37
53 63 40 56
83 88 21 38
72 75 17 24
63 63 53 60
34 46 60 60
```

### 输出

```
20
```


---
title: "Just Kingdom"
layout: "post"
diff: 省选/NOI-
pid: CF1578J
tag: []
---

# Just Kingdom

## 题目描述

有一棵 $n + 1$ 个点，以 $0$ 号点为根的树，每个节点需要 $m_i$ 的钱。任何一个节点 **在任何时候** 得到总共为 $v$ 的钱的时候，进行以下过程：

1. 查看所有儿子，若还有 $cnt$ 个儿子没有得到足够的钱，那么给每个这样的儿子分发 $\frac{v}{cnt}$ 的钱。

2. 若 $cnt = 0$，则利用 $v$ 的钱尽量满足自己的需要。

3. 如果在 2 中仍然剩下了 $w$ 的钱，全部分给父亲。

注意，当上述儿子或者父亲得到钱的时候，会再次进行这个过程，直到最终全局停止钱的转移。

现在，我们需要对每个 $1\leq i\leq n$，求出 $0$ 号节点一开始获得最少多少的钱，能在上述过程结束之后，满足 $i$ 号节点的需要，这里我们对其他节点不作限制。

## 输入格式

第一行一个整数 $n$。

接下来 $n$ 行，第 $i$ 行两个整数分别表示 $o_i$ 和 $m_i$，$o_i$ 表示第 $i$ 个节点的父亲。

$0\leq n \leq 3\times 10 ^ 5$，$1\leq m_i \leq 10 ^ 6$。

## 输出格式

输出 $n$ 行，第 $i$ 行表示节点 $i$ 的答案。

## 样例 #1

### 输入

```
5
0 2
1 2
0 1
1 1
0 5
```

### 输出

```
11
7
3
5
11
```


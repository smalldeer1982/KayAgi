---
title: "Algebra Flash"
layout: "post"
diff: 省选/NOI-
pid: CF1767E
tag: ['状态合并', '图论建模', '快速沃尔什变换 FWT', '折半搜索 meet in the middle']
---

# Algebra Flash

## 题目描述

### 题目背景

Algebra Flash 2.2 刚刚发布！

更新日志：

- 全新游戏模式！

感谢您一直以来对游戏的支持！

就这？你略带失望地启动游戏，点进新的游戏模式，上面写着 "彩色平台"。


有 $n$ 个平台排成一列，编号从 $1$ 到 $n$。平台有 $m$ 种颜色，编号从 $1$ 到 $m$。第 $i$ 个平台的颜色是 $c_i$。

你从 $1$ 号平台开始，想要跳到 $n$ 号平台。在一次移动中，你可以从某个平台 $i$ 跳到平台 $i + 1$ 或 $i + 2$。

所有平台最初都未激活（包括平台 $1$ 和 $n$）。对于每种颜色 $j$，你可以支付 $x_j$ 枚金币来激活所有颜色为 $j$ 的平台。

你希望激活一些平台，然后从已激活的平台 $1$ 开始，跳过一些已激活的平台，到达已激活的平台 $n$。

要实现这个目标，你最少花费多少金币？

## 输入格式

第一行两个整数 $n$ 和 $m$（$2 \le n \le 3 \times 10^5$ ; $1 \le m \le 40$），分别表示平台数和颜色数。

第二行 $n$ 个整数 $c_1, c_2, \dots, c_n$（$1 \le c_i \le m$）表示平台的颜色。

第三行 $m$ 个整数 $x_1, x_2, \dots, x_m$（$1 \le x_i \le 10^7$）表示激活每种颜色的所有平台花费的金币数量。

## 输出格式

一行一个整数，表示从激活的平台 $1$ 开始，跳过一些激活的平台，到达激活的平台 $n$ 需要花费的最小金币数量。

Translated by UID 781046.

## 样例 #1

### 输入

```
5 3
1 3 2 3 1
1 10 100
```

### 输出

```
11
```

## 样例 #2

### 输入

```
5 3
1 3 2 3 1
1 200 20
```

### 输出

```
21
```

## 样例 #3

### 输入

```
4 2
2 2 1 1
5 5
```

### 输出

```
10
```

## 样例 #4

### 输入

```
10 10
3 8 6 2 10 5 2 3 7 3
9 7 4 2 1 8 2 6 2 2
```

### 输出

```
15
```


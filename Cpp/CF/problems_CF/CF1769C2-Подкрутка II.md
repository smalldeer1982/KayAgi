---
title: "Подкрутка II"
layout: "post"
diff: 普及/提高-
pid: CF1769C2
tag: ['动态规划 DP', '贪心']
---

# Подкрутка II

## 题目描述

В этой версии задачи $ n \le 2 \cdot 10^5 $ и $ a_i \le 10^6 $ (а также есть ограничение на сумму $ n $ по наборам входных данных внутри одного теста).

Вика за время работы в компании VK уже сделала $ n $ коммитов в системе контроля версий. $ i $ -й коммит был сделан в $ a_i $ -й день работы Вики в компании. В некоторые дни Вика могла сделать несколько коммитов, а в другие — не сделать ни одного.

Вику интересуют такие отрезки подряд идущих дней, что в каждый из этих дней у неё есть хотя бы один коммит. Чем длиннее будет самый длинный такой отрезок, тем более продуктивным сотрудником она будет себя ощущать.

Недавно Вика нашла способ подкрутить время любого коммита вперёд, но не более чем на сутки. Таким образом, $ i $ -й коммит теперь может быть «сделан» либо в $ a_i $ -й, либо в $ (a_i + 1) $ -й день. Время каждого коммита можно подкрутить независимо от других — в частности, можно как оставить всем коммитам исходное время, так и перенести все коммиты ровно на день вперёд.

Найдите длину самого длинного возможного отрезка подряд идущих дней, в каждый из которых у Вики в профиле будет отображаться хотя бы один коммит, после возможной подкрутки времени некоторых коммитов.

## 输入格式

Каждый тест состоит из нескольких наборов входных данных. В первой строке находится одно целое число $ t $ ( $ 1 \le t \le 100 $ ) — количество наборов входных данных. Далее следует описание наборов входных данных.

Первая строка каждого набора входных данных содержит одно целое число $ n $ ( $ 1 \le n \le 2 \cdot 10^5 $ ) — число коммитов.

Вторая строка содержит $ n $ целых чисел $ a_1, a_2, \ldots, a_n $ в неубывающем порядке ( $ 1 \le a_1 \le a_2 \le \ldots \le a_n \le 10^6 $ ) — номера дней, в которые были сделаны коммиты.

Гарантируется, что сумма $ n $ по всем наборам входных данных не превосходит $ 2 \cdot 10^5 $ .

## 输出格式

Для каждого набора входных данных выведите одно целое число — максимальную возможную длину отрезка дней, в каждый из которых у Вики в профиле будет отображаться хотя бы один коммит, после возможной подкрутки времени некоторых коммитов вперёд не более чем на сутки.

## 样例 #1

### 输入

```
3
9
1 1 3 4 6 6 6 8 10
6
1 2 3 4 5 6
5
10 10 10 10 10
```

### 输出

```
5
6
2
```


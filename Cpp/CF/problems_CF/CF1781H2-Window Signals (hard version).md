---
title: "Window Signals (hard version)"
layout: "post"
diff: NOI/NOI+/CTSC
pid: CF1781H2
tag: []
---

# Window Signals (hard version)

## 题目描述

这是问题的加强版。在这个版本中，对 $h$ 和 $w$ 的约束更严格。

一座海边的房子有 $h$ 层楼，每层楼的高度相同。面向大海的一侧有 $w$ 个窗户，每扇窗户在每层楼上距离相等。因此，窗户的位置位于一个大小为 $h\times w$ 的矩形网格的单元格中。

除了给定的 $k$ 扇窗户（最多为 $2$ 个），在每个窗户中，可以将灯光设置为开启或关闭状态。给定的 $k$ 扇窗户中的灯光由于损坏无法打开。

在黑暗中，我们可以通过灯光开关的配置向海上的船只发送信号。然而，船只无法看出灯光相对于房子的位置。因此，如果一个配置可以通过平行移动转化为另一个配置，则认为这些配置是相等的。请注意，只允许平行移动，不能进行旋转或翻转。**此外，不考虑没有任何灯光的配置。**

找出船只可以接收到多少个不同的信号，并将结果对 $998244353$ 取模后输出。

### **简明题意**

给定一个 $h\times w$ 的矩阵，除了给定的 $k \ (k\le 2)$ 个单元格外(这 $k$ 个填 $0$)，每一格可以填 $0$ 或 $1$，求能产生多少种本质不同的图案，答案对 $998244353$ 取模。($0$ 视为空白)

## 输入格式

每个测试点包含多组测试数据。第一行读入一个整数 $t \ (1\le t\le 100)$，表示数据组数。随后是对每组数据的描述。

每组数据输入的第一行包含三个整数 $h$，$w$，和 $k$ $(1\le h,w\le 200;0\le k\le \min(h\cdot w,2))$ ，分别表示房子的高度，每层楼的窗户数量以及灯光损坏的窗户数量。

如果 $k>0$，接下来的 $k$ 行中，每行包含两个整数 $r_i$ 和 $c_i$ $(1\le r_i\le h;1\le c_i\le w)$ ，分别表示损坏灯光的窗户所在的楼层和窗户号码。楼层从底部到顶部依次编号为 $1$ 到 $h$，窗户从左到右依次编号为 $1$ 到 $w$。如果 $k=2$，则要么 $r_1\ne r_2$，要么 $c_1\ne c_2$。

保证所有测试用例中 $h\cdot w$ 的总和不超过 $40000$。

## 输出格式

对于每组数据，单独一行输出一个整数，代表船只可以接收到的本质不同的信号数量，对 $998244353$ 取模后输出。

### **说明/提示**

在样例的第一组数据中，船只可以接收到 $4$ 种不同的信号：全部打开，任意相邻的两个打开，最左边和最右边打开，以及任意一个打开。

## 样例 #1

### 输入

```
10
1 3 0
2 2 0
3 2 0
4 5 0
12 7 0
1 1 1
1 1
1 3 1
1 2
3 4 1
3 4
2 3 2
1 1
2 1
4 5 2
2 3
4 2
```

### 输出

```
4
10
44
954368
34903934
0
2
1696
10
253144
```


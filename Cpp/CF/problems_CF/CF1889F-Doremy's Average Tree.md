---
title: "Doremy's Average Tree"
layout: "post"
diff: NOI/NOI+/CTSC
pid: CF1889F
tag: []
---

# Doremy's Average Tree

## 题目描述

你有一棵大小为 $n$，根节点为 $r$ 的树，节点 $i$ 的权值是 $w_i$。你可以执行以下操作**至多** $k$ 次：

选择一个节点 $x$，令 $s$ 为 $x$ 子树内所有点权值的平均值，把 $x$ 子树内所有点的权值修改为 $s$。

你现在想让操作后的 $w$ 数组的字典序最小，请构造一种满足条件的方案。

## 输入格式

有多组测试数据。第一行一个整数 $t(1\leq t\leq 10^4)$，表示测试数据的组数。

每组数据第一行三个整数 $n,r,k(2\leq n\leq 5000,1\leq r \leq n,0\leq k\leq\min(500,n))$。

第二行有 $n$ 个正整数，第 $i$ 个表示点 $i$ 的初始权值，保证其不超过 $10^6$。

接下来 $n-1$ 行每行两个数 $u_i,v_i(1\leq u_i,v_i\leq n)$，表示有一条连接 $u_i,v_i$ 的边。

保证所有数据中 $n$ 的总和不超过 $5\times 10^4$，输入的是一棵树。

## 输出格式

每组数据两行，第一行表示你操作的次数 $k$，第二行 $k$ 个数，表示每次操作中你选择的 $x$。

如果有多种答案，你可以输出任意一种。

## 样例 #1

### 输入

```
4
6 1 1
1 9 2 6 1 8
1 2
1 3
2 4
3 6
3 5
7 7 2
3 1 3 3 1 1 2
7 1
7 2
7 4
1 5
2 3
4 6
6 5 1
3 1 3 1 1 3
5 3
5 1
5 6
3 4
1 2
3 2 1
1000000 999999 999997
2 1
1 3
```

### 输出

```
1
2
2
1 4
1
5
1
1
```


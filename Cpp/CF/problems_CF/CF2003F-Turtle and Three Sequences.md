---
title: "Turtle and Three Sequences"
layout: "post"
diff: 省选/NOI-
pid: CF2003F
tag: ['状态合并', '随机化']
---

# Turtle and Three Sequences

## 题目描述

小猪给了小乌龟 3 个长度为 $n \ (1 \le n\le3000)$ 的序列 $a,b,c$，乌龟要在 $1\sim n$ 中选出 $m \ (1 \le m ≤ 5)$ 个下标 $p_1 \sim p_m$，满足如下条件：

* $p$ 是 $1\sim n$ 的子序列。

* $\forall 1\le i\le n, a\large_{p_i} \small \normalsize\le a\large_{p_i + 1} $，即得到的 $a$ 序列严格不降。
* $\forall 1\le i, j\le n \ (i\ne j), b\large_{p_i}\normalsize \ne b\large_{p_j}$ ，即得到的 $b$ 序列两两不同。

你需要帮助小乌龟求出可能的 $\sum\limits^m_{i=1} c\large_{p_i}$ 的最大值，或者告诉他满足以上条件的子序列 $p$ 不存在 。

其中子序列的定义是，从原序列中删去若干 $(0\sim n)$ 个元素，则新的序列是原序列的子序列。

## 输入格式

第一行两个正整数 $n,m$ ，表示三个序列的长度和选出的子序列 $p$ 的长度。

第二、三、四行 $n$ 个正整数 分别表示 $a,b,c$ 三个序列，其中 $c_i\le 10^4$。

## 输出格式

输出一行一个正整数表示答案，如果不存在满足条件的子序列，输出 $-1$。

## 说明/提示

在第一个样例中，我们可以选择 $p=[1,2]$，则答案为 $1+4=5$。我们不能选择 $p=[2,4]$ 因为 $a_2>a_4$ ，不满足第一个条件。我们也不能选择 $p=[2,3]$ 因为 $b_2=b_3$ ，不满足第二个条件。我们可以选择 $p=[1,4]$，但答案为 $4$ ，不是最大的。

在第二个样例中 我们可以选择 $p=[4,6,7]$。

在第三个样例中，我们选不到满足条件的 $p$ 。

## 样例 #1

### 输入

```
4 2
2 3 4 2
1 3 3 2
1 4 2 3
```

### 输出

```
5
```

## 样例 #2

### 输入

```
7 3
1 4 5 2 3 6 7
1 2 2 1 1 3 2
1 5 6 7 3 2 4
```

### 输出

```
13
```

## 样例 #3

### 输入

```
5 3
1 2 3 4 5
1 1 2 1 2
5 4 3 2 1
```

### 输出

```
-1
```


---
title: "Resort"
layout: "post"
diff: 普及/提高-
pid: CF350B
tag: []
---

# Resort

## 题目描述

Valera 终于决定要去滑雪胜地了！

Valera 意识到自己可能会在新地方迷路，但是有位好心人告诉他胜地有 $n$ 个目的地（每个目的地的编号从 $1$ 到 $n$ ），目的地只会是酒店或雪山。

Valera 又发现胜地有多条雪道，并且对于每个目的地 $v$ 只可能存在一个出发点 $u$ （每个目的地只可能从另外**一个**目的地滑过来）。我们也知道没有雪道会以酒店作为出发点。

Valera 怕他会在胜地迷路，所以他想让你告诉他一条他可以滑行的路径。这条路径包含目的地 $v_1, v_2, ... , v_k (k>=1 )$ 并需要符合以下要求：

1. 目的地 $v_1, v_2, ... , v_{k-1}$ 都是雪山，只有 $v_k$ 是酒店。

2. 对于每个整数 $i (1 <= i <= k)$ ，只有一条以 $v_i$ 为出发点的雪道，也就是说目的地 $v_i$ 只对应**一个**目的地。

3. 这条路径经过尽可能多的目的地（ $k$ 为最大值）。

帮助 Valera，找到一条符合所有要求的路径吧！

## 输入格式

第一行包括一个整数$ n (1 <= n <= 10^5)$ ，为目的地总数。

第二行包括 $n$ 个 $0$ 或者 $1$ ，$0$ 代表第 $i$ 个目的地为雪山，$1$ 代表酒店。保证至少有**一个**酒店。

第三行包括 $n$ 个整数: $a_1, a_2, ... , a_n (0 <= a_i <= n)$ ，这是对于每个目的地 $i$ 的雪道描述。如果 $a_i$ 等于 $0$ ，则没有点可以到达 $i$ ，如果 $a_i$ 不等于 $0$ ，则有一条从目的地 $a_i$ 到 $i$ 的雪道。

## 输出格式

第一行包括一个整数 $k$ ，为最多可以经过的目的地。

第二行包括 $k$ 个整数 $v_1, v_2, ... , v_k$ ，为路径。如果有多个解，你可以输出任何一个。

## 样例 #1

### 输入

```
5
0 0 0 0 1
0 1 2 3 4

```

### 输出

```
5
1 2 3 4 5

```

## 样例 #2

### 输入

```
5
0 0 1 0 1
0 1 2 2 4

```

### 输出

```
2
4 5

```

## 样例 #3

### 输入

```
4
1 0 0 0
2 3 4 2

```

### 输出

```
1
1

```


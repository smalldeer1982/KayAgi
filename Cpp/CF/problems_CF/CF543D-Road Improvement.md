---
title: "Road Improvement"
layout: "post"
diff: 省选/NOI-
pid: CF543D
tag: ['动态规划 DP']
---

# Road Improvement

## 题目描述

这个国家有n座城市和n-1条双向道路，你可以沿道路从一个城市到任意一个其他城市。这些城市被编号为整数1到n。

所有的道路最初都是不良的，但是政府想要改善一些路的状况。我们认为如果从首都x城到其他城市的道路最多包含一条不良道路，市民会对此感到满意。
你的任务是——对于每一个可能的x，求出所有能够满足市民条件的改良道路的方式。因为结果可能很大，你需要输出mod 1000000007 ( 10^9+7 )后的结果。

## 输入格式

第一行有一个整数n ( 2<=n<=2⋅10^5 )——代表城市的数量。
第二行包括n-1个描述城市道路的整数p2,p3,p4,...,pn ( 1<=pi<=i−1 ) pi表示有一条连接城市pi和城市i 的道路。

## 输出格式

输出n个整数a1,a2,...,an ，ai表示在城市i为首都时，改良道路的方式mod 1000000007 ( 10^9+7 )后的结果。

## 样例 #1

### 输入

```
3
1 1

```

### 输出

```
4 3 3
```

## 样例 #2

### 输入

```
5
1 2 3 4

```

### 输出

```
5 8 9 8 5
```


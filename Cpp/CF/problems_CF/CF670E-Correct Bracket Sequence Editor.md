---
title: "Correct Bracket Sequence Editor"
layout: "post"
diff: 普及+/提高
pid: CF670E
tag: []
---

# Correct Bracket Sequence Editor

## 题目描述

`Polycarp`有一个长度为 $n$ 的括号串。

我们设 $pre_i$ 为字符串中第 $1$ 位到第 $i$ 位的左括号数量减去右括号数量，那么当每个 $1\leqslant i\leqslant n$ ， $pre_i\geqslant0$ 。同时 $pre_n=0$ 时，我们认为这个括号串合法。

现在`Polycarp`为合法括号串设计了一种编辑器，这个编辑器支持如下操作:

1. `L`，将光标左移一格
2. `R`，将光标右移一格
3. `D`，删除这个括号到与它对应的括号之间的所有字符，在删除之后，光标会跳到它右边的没有被删除的最左边的括号处，如果没有这样的括号了，那么光标会跳到它左边的没有被删除的最右边的括号处。

举个例子:

![](https://cdn.luogu.com.cn/upload/vjudge_pic/CF670E/08b0f9032003921a97680a954e716fd13a3de759.png)

上图中，在第一排左边的串使用`D`，使得 $[2,3]$ 全部被删掉了。

第二排中，使用`D`，删除了 $[4,7]$ ，因为第 $7$ 个括号的配对括号在 $4$ 处。

第三排也是一样。

`Polycarp`的编辑器不支持错误的操作，例如删掉整个字符串。

`Polycarp`对他的设计感到自豪，但是他不会实现这个编辑器，所以他想请你来帮他实现，你能帮他实现编辑器的功能吗？

## 输入格式

输入共三行。

第一行，三个整数 $n,m,p$ ，分别表示括号串长度，操作数量和光标的初始位置。

第二行，一个长度为 $n$ 的括号串。

第三行，一个长度为 $m$ 的字符串，表示操作序列。

## 输出格式

输出共一行。

第一行，一个括号串。表示原括号串进行了 $m$ 个操作过后的括号串。

## 说明/提示

$1\leqslant p\leqslant n\leqslant 5\times 10^5,1\leqslant m\leqslant 5\times 10^5$

## 样例 #1

### 输入

```
8 4 5
(())()()
RDLD

```

### 输出

```
()

```

## 样例 #2

### 输入

```
12 5 3
((()())(()))
RRDLD

```

### 输出

```
(()(()))

```

## 样例 #3

### 输入

```
8 8 8
(())()()
LLLLLLDD

```

### 输出

```
()()

```


---
title: "Palindromes in a Tree"
layout: "post"
diff: 省选/NOI-
pid: CF914E
tag: ['点分治', '分治', '状态合并']
---

# Palindromes in a Tree

## 题目描述

#### 题意

给你一颗 $n$ 个顶点的树（连通无环图）。顶点从 $1$ 到 $n$ 编号，并且每个顶点对应一个在 `a` 到 `t` 的字母。
树上的一条路径是回文是指至少有一个对应字母的排列为回文。

对于每个顶点，输出通过它的回文路径的数量。

注意：从 $u$ 到 $v$ 的路径与从 $v$ 到 $u$ 的路径视为相同，只计数一次。

## 输入格式

第一行包含一个整数 $n$（$2\leq n\leq 2\times 10^5$）。

接下来的 $n-1$ 行，每行包含两个整数 $u$ 和 $v$（$1\leq u,v\leq n,u\neq v$）表示一条连接 $u$ 和 $v$ 的边。保证给出的图是一棵树。
再下一行包含一个 $n$ 个字符的字符串，第 $i$ 个字符对应第 $i$ 个顶点。

## 输出格式

输出一行，包含 $n$ 个整数，第 $i$ 个数表示经过顶点 $i$ 的回文路径数量。

## 样例 #1

### 输入

```
5
1 2
2 3
3 4
3 5
abcbb

```

### 输出

```
1 3 4 3 3 

```

## 样例 #2

### 输入

```
7
6 2
4 3
3 7
5 2
7 2
1 4
afefdfs

```

### 输出

```
1 4 1 1 2 4 2 

```


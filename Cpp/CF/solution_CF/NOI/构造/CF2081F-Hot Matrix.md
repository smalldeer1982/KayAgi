# Hot Matrix

## 题目描述

Piggy Zhou 热爱矩阵，尤其是能让他感到兴奋的"热矩阵"。

一个大小为 $n \times n$ 的热矩阵定义如下。令 $a_{i, j}$ 表示第 $i$ 行第 $j$ 列的元素（$1 \le i, j \le n$）：

1. 矩阵的每一行和每一列都是 $0$ 到 $n-1$ 所有数字的一个排列。
2. 对于所有满足 $1 \le i, j \le n$ 的索引对 $(i, j)$，有 $a_{i, j} + a_{i, n - j + 1} = n - 1$。
3. 对于所有满足 $1 \le i, j \le n$ 的索引对 $(i, j)$，有 $a_{i, j} + a_{n - i + 1, j} = n - 1$。
4. 所有有序对 $\left(a_{i, j}, a_{i, j + 1}\right)$（其中 $1 \le i \le n$，$1 \le j < n$）必须互不相同。
5. 所有有序对 $\left(a_{i, j}, a_{i + 1, j}\right)$（其中 $1 \le i < n$，$1 \le j \le n$）必须互不相同。

现在，Piggy Zhou 给定你一个数字 $n$，你需要判断是否存在对应的热矩阵。若存在则构造一个符合要求的热矩阵，否则告知他无法构造。

## 说明/提示

第一个、第二个和第四个测试用例中，可以验证示例提供的矩阵满足题目所有条件。

第三个测试用例中，通过枚举所有可能的矩阵，可以证明不存在满足条件的热矩阵。

翻译由 DeepSeek R1 完成

## 样例 #1

### 输入

```
4
1
2
3
4```

### 输出

```
YES
0
YES
0 1
1 0
NO
YES
0 1 2 3
1 3 0 2
2 0 3 1
3 2 1 0```

# 题解

## 作者：zzzYheng (赞：15)

详细揭秘：如何用打表速通这道 *3300？

题目要求构造一个具有一些特殊性质的拉丁方，但是这个限制太诡异了导致根本无从下手，怎么办？打表！

注意打表程序也是要注重效率的，由于有行列都要旋转对称的限制，因此只需要搜索左上四分之一矩阵就可以唯一确定整个矩阵。

写完这个搜索可以得到 $n=1,2,4,6,8,10,12,\cdots$ 都是有解的，因此我们猜测 $n$ 为 $1$ 或偶数时才有解。

其实这也很容易证明，因为 $n$ 为奇数时每一行的 $\frac{n+1}{2}$ 位置必须为 $\frac{n-1}{2}$，那么在第 $\frac{n+1}{2}$ 列的值就会全部相同，因此 $n$ 为奇数时只有 $n=1$ 有解。

那 $n$ 为偶数时怎么构造？还是打表，我们可以打出每个 $n$ 的第一组解看一看：

```
0 1
1 0

0 1 2 3 
1 3 0 2 
2 0 3 1 
3 2 1 0

0 1 2 3 4 5 
1 3 0 5 2 4 
2 0 4 1 5 3 
3 5 1 4 0 2 
4 2 5 0 3 1 
5 4 3 2 1 0

0 1 2 3 4 5 6 7 
1 3 0 2 5 7 4 6 
2 7 3 6 1 4 0 5 
4 2 6 0 7 1 5 3 
3 5 1 7 0 6 2 4 
5 0 4 1 6 3 7 2 
6 4 7 5 2 0 3 1 
7 6 5 4 3 2 1 0 

0 1 2 3 4 5 6 7 8 9 
1 3 0 4 2 7 5 9 6 8 
2 0 5 8 3 6 1 4 9 7 
6 4 8 2 9 0 7 1 5 3 
4 7 3 9 1 8 0 6 2 5 
5 2 6 0 8 1 9 3 7 4 
3 5 1 7 0 9 2 8 4 6 
7 9 4 1 6 3 8 5 0 2 
8 6 9 5 7 2 4 0 3 1 
9 8 7 6 5 4 3 2 1 0
```

容易看出 $n=2,4,6$ 时的第一组解都长得特别有规律：四个条边上都是由 $\{0,1,2,\cdots\}$ 组成，且矩阵还沿两条对角线对称！

但是 $n=8$ 时就有一点点不一样了，$n=10$ 时就有很多不一样了！如果你尝试打出所有解，就会发现解的数量实在是太多了！因此我们很难找到具有相同规律的解！

那么可以考虑强化一下问题来缩小解空间以方便找规律，比如我们就强制要求矩阵沿对角线对称，容易发现这样还是能跑出解，打出表看一看：

```
0 1 
1 0

0 1 2 3 
1 3 0 2 
2 0 3 1 
3 2 1 0

0 1 2 3 4 5 
1 3 0 5 2 4 
2 0 4 1 5 3 
3 5 1 4 0 2 
4 2 5 0 3 1 
5 4 3 2 1 0

0 1 2 3 4 5 6 7 
1 3 0 5 2 7 4 6 
2 0 4 1 6 3 7 5 
3 5 1 7 0 6 2 4 
4 2 6 0 7 1 5 3 
5 7 3 6 1 4 0 2 
6 4 7 2 5 0 3 1 
7 6 5 4 3 2 1 0

0 1 2 3 4 5 6 7 8 9 
1 3 0 5 2 7 4 9 6 8 
2 0 4 1 6 3 8 5 9 7 
3 5 1 7 0 9 2 8 4 6 
4 2 6 0 8 1 9 3 7 5 
5 7 3 9 1 8 0 6 2 4 
6 4 8 2 9 0 7 1 5 3 
7 9 5 8 3 6 1 4 0 2 
8 6 9 4 7 2 5 0 3 1 
9 8 7 6 5 4 3 2 1 0
```

天哪这也太有规律了吧！每个 $n$ 的解都是在 $n-2$ 的解的基础上在中间插入三条斜行得到的。

且左右两条斜行都是：$\{n-2,n-1,n-2,n-1\cdots\}$，中间的斜行是：$\{n-1,n-4,n-5,n-8,n-9,\cdots,n-9,n-8,n-5,n-4,n-1\}$。

于是就做完了，时间复杂度 $\Theta(n^2)$。

---


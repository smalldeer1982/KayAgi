# Sereja and Cinema

## 题目描述

Sereja 的电影院有 $n$ 个座位在一个大屏幕前排成一行，在每个座位的左边和右边都有放置个人物品的凹槽，任何两个相邻的座位恰好有一个共享的凹槽，下图显示了 $n=4$ 的座位和凹槽的分布。

![](https://cdn.luogu.com.cn/upload/vjudge_pic/CF380D/5b4120dab28091fc001ad31ac47c14df226611e7.png)

今天是一部名为《 Dry Hard 》的电影的首映式，所有票都卖完了。所有人会排队一个一个地进入影厅。当一个人进入影厅，他立即占据他的座位和他旁边的所有空的凹槽。如果没有空的凹槽，他会非常沮丧，然后离开。

人们不是固定不变的，所以很难预测观众进入大厅的顺序。Sereja 知道坐在某些位置的观众排在队列的位置。其他人可能排在其余任何位置。

作为一个程序员和数学家，Sereja 想知道：有多少种方式可以使得没有人沮丧而离开。因为答案很大，输出模 $1000000007$。

## 样例 #1

### 输入

```
11
0 0 0 0 0 0 0 0 0 0 0
```

### 输出

```
1024
```

## 样例 #2

### 输入

```
6
0 3 1 0 0 0
```

### 输出

```
3
```

# 题解

## 作者：试试事实上吗 (赞：2)

一道有趣的组合题。

我们先考虑什么样的入座方式是合法的。

结论：一个入座方式是合法的，当且仅当任意时刻已经入座的人都是一个连通块。

证明很显然，假设有两个连通块，那么它们最终会相遇，在相遇的地方，一定有不合法的一个位置。

然后我们就可以做了。

我们先考虑第一个人的位置，如果已经确定了，那么我们就找到她的位置，如果没有确定，我们就枚举起点。

先对已经确定顺序的人排序。

模拟连通块的扩展，我们考虑记录当前连通块的左端点为l，右端点为r。

我们考虑下一个已经确定的人的入座位置在pos，如果$l\le pos \le r$，那么就不合法，返回0。

否则如果$pos<l$ （$pos>r$同理，不再讨论）

假设上一个入座的与这个人之间有x个人要入座，如果$x<l-pos-1$（即不够l到pos的座位），那么就不合法，返回0，否则考虑这x个人一部分可以坐左边，一部分可以坐右边，那么入座方法就有$C^{x}_{l-pos-1}$种，再扩展连通块，继续递推即可。

最后统计所有情况答案求和即可。



---


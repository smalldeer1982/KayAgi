# Huge Strings

## 题目描述

You are given $ n $ strings $ s_{1},s_{2},...,s_{n} $ consisting of characters $ 0 $ and $ 1 $ . $ m $ operations are performed, on each of them you concatenate two existing strings into a new one. On the $ i $ -th operation the concatenation $ s_{ai}s_{bi} $ is saved into a new string $ s_{n+i} $ (the operations are numbered starting from $ 1 $ ). After each operation you need to find the maximum positive integer $ k $ such that all possible strings consisting of $ 0 $ and $ 1 $ of length $ k $ (there are $ 2^{k} $ such strings) are substrings of the new string. If there is no such $ k $ , print $ 0 $ .

## 说明/提示

On the first operation, a new string "0110" is created. For $ k=1 $ the two possible binary strings of length $ k $ are "0" and "1", they are substrings of the new string. For $ k=2 $ and greater there exist strings of length $ k $ that do not appear in this string (for $ k=2 $ such string is "00"). So the answer is $ 1 $ .

On the second operation the string "01100" is created. Now all strings of length $ k=2 $ are present.

On the third operation the string "1111111111" is created. There is no zero, so the answer is $ 0 $ .

## 样例 #1

### 输入

```
5
01
10
101
11111
0
3
1 2
6 5
4 4
```

### 输出

```
1
2
0
```

# 题解

## 作者：Li2021 (赞：2)

## CF868D 题解

字符串。

这是本蒟蒻第二次写题解，写的不好多多谅解。欢迎喷我！

### $\texttt{problem}$

[Ta](https://www.luogu.com.cn/blog/yzy001633/solution-cf868d) 的题意写的不错，看 Ta 的吧。~~懒得写~~

### $\texttt{solution}$

乍一看，摆烂！但是，一想 $k$ 的最大值，列一个不等式 $9 \times 100 + 100 < 2^k$ ，其中 $100$ 为组合后的字符串的最大长度。我们很轻易地发现， $k \leq 9$ 。这题就变水了。

很简单的代码。

### $\texttt{code}$

```cpp
#include <iostream>
#include <cstdlib>
using namespace std;
int ans[1002];
string s[1002];
int func(int k){
	for(int i=1;i<=10;i++){
		for(int j=0;j<(i<<i);j++){
			string s2;
			for(int k=0;k<i;k++){
				if(j&(1<<k))  s2+="1";
				else  s2+="0";
			}
			if(s[k].find(s2)==-1)  return i-1;
		}
	}
	return 114514;
}
int main(){
	int n,m;
	cin>>n;
	for(int i=1;i<=n;i++)  cin>>s[i];
	cin>>m;
	for(int i=1;i<=m;i++){
		int a,b;
		cin>>a>>b;
		s[i+n]=s[a]+s[b];
		ans[i+n]=max(max(ans[a],ans[b]),func(i+n));
		if(s[i+n].size()>2000)  s[i+n]=s[i+n].substr(0,1000)+s[i+n].substr(s[i+n].length()-1000,1000);
		cout<<ans[i+n]<<endl;
	}
	return (rand()%1==0)?0:114514;
}

```

---

## 作者：chidor (赞：1)

### 题目大意
~~我语文不好~~
看看 [ta](https://www.luogu.com.cn/article/xlquz7q9) 的。
### 思路
由于所有字符串的长度和不超过 $ 100 $，所以可以列出不等式 $ 9 \times 100 + 100 \le 2^k $，得到  $ k ≤ 10 $。

可以列出所有不同 $ k $ 的 $ 01 $ 子串，保存下来（~~人称打表~~）。
### 代码
```cpp
#include<bits/stdc++.h>
using namespace std;
int n,m,ans[1005];
//存储不同k的所有01子串
string s[15][2005]={{"1","0",},{"11","10","01","00",},{"111","110","101","100","011","010","001","000",},{"1111","1110","1101","1100","1011","1010","1001","1000","0111","0110","0101","0100","0011","0010","0001","0000",},{"11111","11110","11101","11100","11011","11010","11001","11000","10111","10110","10101","10100","10011","10010","10001","10000","01111","01110","01101","01100","01011","01010","01001","01000","00111","00110","00101","00100","00011","00010","00001","00000",},{"111111","111110","111101","111100","111011","111010","111001","111000","110111","110110","110101","110100","110011","110010","110001","110000","101111","101110","101101","101100","101011","101010","101001","101000","100111","100110","100101","100100","100011","100010","100001","100000","011111","011110","011101","011100","011011","011010","011001","011000","010111","010110","010101","010100","010011","010010","010001","010000","001111","001110","001101","001100","001011","001010","001001","001000","000111","000110","000101","000100","000011","000010","000001","000000",},{"1111111","1111110","1111101","1111100","1111011","1111010","1111001","1111000","1110111","1110110","1110101","1110100","1110011","1110010","1110001","1110000","1101111","1101110","1101101","1101100","1101011","1101010","1101001","1101000","1100111","1100110","1100101","1100100","1100011","1100010","1100001","1100000","1011111","1011110","1011101","1011100","1011011","1011010","1011001","1011000","1010111","1010110","1010101","1010100","1010011","1010010","1010001","1010000","1001111","1001110","1001101","1001100","1001011","1001010","1001001","1001000","1000111","1000110","1000101","1000100","1000011","1000010","1000001","1000000","0111111","0111110","0111101","0111100","0111011","0111010","0111001","0111000","0110111","0110110","0110101","0110100","0110011","0110010","0110001","0110000","0101111","0101110","0101101","0101100","0101011","0101010","0101001","0101000","0100111","0100110","0100101","0100100","0100011","0100010","0100001","0100000","0011111","0011110","0011101","0011100","0011011","0011010","0011001","0011000","0010111","0010110","0010101","0010100","0010011","0010010","0010001","0010000","0001111","0001110","0001101","0001100","0001011","0001010","0001001","0001000","0000111","0000110","0000101","0000100","0000011","0000010","0000001","0000000",},{"11111111","11111110","11111101","11111100","11111011","11111010","11111001","11111000","11110111","11110110","11110101","11110100","11110011","11110010","11110001","11110000","11101111","11101110","11101101","11101100","11101011","11101010","11101001","11101000","11100111","11100110","11100101","11100100","11100011","11100010","11100001","11100000","11011111","11011110","11011101","11011100","11011011","11011010","11011001","11011000","11010111","11010110","11010101","11010100","11010011","11010010","11010001","11010000","11001111","11001110","11001101","11001100","11001011","11001010","11001001","11001000","11000111","11000110","11000101","11000100","11000011","11000010","11000001","11000000","10111111","10111110","10111101","10111100","10111011","10111010","10111001","10111000","10110111","10110110","10110101","10110100","10110011","10110010","10110001","10110000","10101111","10101110","10101101","10101100","10101011","10101010","10101001","10101000","10100111","10100110","10100101","10100100","10100011","10100010","10100001","10100000","10011111","10011110","10011101","10011100","10011011","10011010","10011001","10011000","10010111","10010110","10010101","10010100","10010011","10010010","10010001","10010000","10001111","10001110","10001101","10001100","10001011","10001010","10001001","10001000","10000111","10000110","10000101","10000100","10000011","10000010","10000001","10000000","01111111","01111110","01111101","01111100","01111011","01111010","01111001","01111000","01110111","01110110","01110101","01110100","01110011","01110010","01110001","01110000","01101111","01101110","01101101","01101100","01101011","01101010","01101001","01101000","01100111","01100110","01100101","01100100","01100011","01100010","01100001","01100000","01011111","01011110","01011101","01011100","01011011","01011010","01011001","01011000","01010111","01010110","01010101","01010100","01010011","01010010","01010001","01010000","01001111","01001110","01001101","01001100","01001011","01001010","01001001","01001000","01000111","01000110","01000101","01000100","01000011","01000010","01000001","01000000","00111111","00111110","00111101","00111100","00111011","00111010","00111001","00111000","00110111","00110110","00110101","00110100","00110011","00110010","00110001","00110000","00101111","00101110","00101101","00101100","00101011","00101010","00101001","00101000","00100111","00100110","00100101","00100100","00100011","00100010","00100001","00100000","00011111","00011110","00011101","00011100","00011011","00011010","00011001","00011000","00010111","00010110","00010101","00010100","00010011","00010010","00010001","00010000","00001111","00001110","00001101","00001100","00001011","00001010","00001001","00001000","00000111","00000110","00000101","00000100","00000011","00000010","00000001","00000000",},{"111111111","111111110","111111101","111111100","111111011","111111010","111111001","111111000","111110111","111110110","111110101","111110100","111110011","111110010","111110001","111110000","111101111","111101110","111101101","111101100","111101011","111101010","111101001","111101000","111100111","111100110","111100101","111100100","111100011","111100010","111100001","111100000","111011111","111011110","111011101","111011100","111011011","111011010","111011001","111011000","111010111","111010110","111010101","111010100","111010011","111010010","111010001","111010000","111001111","111001110","111001101","111001100","111001011","111001010","111001001","111001000","111000111","111000110","111000101","111000100","111000011","111000010","111000001","111000000","110111111","110111110","110111101","110111100","110111011","110111010","110111001","110111000","110110111","110110110","110110101","110110100","110110011","110110010","110110001","110110000","110101111","110101110","110101101","110101100","110101011","110101010","110101001","110101000","110100111","110100110","110100101","110100100","110100011","110100010","110100001","110100000","110011111","110011110","110011101","110011100","110011011","110011010","110011001","110011000","110010111","110010110","110010101","110010100","110010011","110010010","110010001","110010000","110001111","110001110","110001101","110001100","110001011","110001010","110001001","110001000","110000111","110000110","110000101","110000100","110000011","110000010","110000001","110000000","101111111","101111110","101111101","101111100","101111011","101111010","101111001","101111000","101110111","101110110","101110101","101110100","101110011","101110010","101110001","101110000","101101111","101101110","101101101","101101100","101101011","101101010","101101001","101101000","101100111","101100110","101100101","101100100","101100011","101100010","101100001","101100000","101011111","101011110","101011101","101011100","101011011","101011010","101011001","101011000","101010111","101010110","101010101","101010100","101010011","101010010","101010001","101010000","101001111","101001110","101001101","101001100","101001011","101001010","101001001","101001000","101000111","101000110","101000101","101000100","101000011","101000010","101000001","101000000","100111111","100111110","100111101","100111100","100111011","100111010","100111001","100111000","100110111","100110110","100110101","100110100","100110011","100110010","100110001","100110000","100101111","100101110","100101101","100101100","100101011","100101010","100101001","100101000","100100111","100100110","100100101","100100100","100100011","100100010","100100001","100100000","100011111","100011110","100011101","100011100","100011011","100011010","100011001","100011000","100010111","100010110","100010101","100010100","100010011","100010010","100010001","100010000","100001111","100001110","100001101","100001100","100001011","100001010","100001001","100001000","100000111","100000110","100000101","100000100","100000011","100000010","100000001","100000000","011111111","011111110","011111101","011111100","011111011","011111010","011111001","011111000","011110111","011110110","011110101","011110100","011110011","011110010","011110001","011110000","011101111","011101110","011101101","011101100","011101011","011101010","011101001","011101000","011100111","011100110","011100101","011100100","011100011","011100010","011100001","011100000","011011111","011011110","011011101","011011100","011011011","011011010","011011001","011011000","011010111","011010110","011010101","011010100","011010011","011010010","011010001","011010000","011001111","011001110","011001101","011001100","011001011","011001010","011001001","011001000","011000111","011000110","011000101","011000100","011000011","011000010","011000001","011000000","010111111","010111110","010111101","010111100","010111011","010111010","010111001","010111000","010110111","010110110","010110101","010110100","010110011","010110010","010110001","010110000","010101111","010101110","010101101","010101100","010101011","010101010","010101001","010101000","010100111","010100110","010100101","010100100","010100011","010100010","010100001","010100000","010011111","010011110","010011101","010011100","010011011","010011010","010011001","010011000","010010111","010010110","010010101","010010100","010010011","010010010","010010001","010010000","010001111","010001110","010001101","010001100","010001011","010001010","010001001","010001000","010000111","010000110","010000101","010000100","010000011","010000010","010000001","010000000","001111111","001111110","001111101","001111100","001111011","001111010","001111001","001111000","001110111","001110110","001110101","001110100","001110011","001110010","001110001","001110000","001101111","001101110","001101101","001101100","001101011","001101010","001101001","001101000","001100111","001100110","001100101","001100100","001100011","001100010","001100001","001100000","001011111","001011110","001011101","001011100","001011011","001011010","001011001","001011000","001010111","001010110","001010101","001010100","001010011","001010010","001010001","001010000","001001111","001001110","001001101","001001100","001001011","001001010","001001001","001001000","001000111","001000110","001000101","001000100","001000011","001000010","001000001","001000000","000111111","000111110","000111101","000111100","000111011","000111010","000111001","000111000","000110111","000110110","000110101","000110100","000110011","000110010","000110001","000110000","000101111","000101110","000101101","000101100","000101011","000101010","000101001","000101000","000100111","000100110","000100101","000100100","000100011","000100010","000100001","000100000","000011111","000011110","000011101","000011100","000011011","000011010","000011001","000011000","000010111","000010110","000010101","000010100","000010011","000010010","000010001","000010000","000001111","000001110","000001101","000001100","000001011","000001010","000001001","000001000","000000111","000000110","000000101","000000100","000000011","000000010","000000001","000000000",},{"1111111111","1111111110","1111111101","1111111100","1111111011","1111111010","1111111001","1111111000","1111110111","1111110110","1111110101","1111110100","1111110011","1111110010","1111110001","1111110000","1111101111","1111101110","1111101101","1111101100","1111101011","1111101010","1111101001","1111101000","1111100111","1111100110","1111100101","1111100100","1111100011","1111100010","1111100001","1111100000","1111011111","1111011110","1111011101","1111011100","1111011011","1111011010","1111011001","1111011000","1111010111","1111010110","1111010101","1111010100","1111010011","1111010010","1111010001","1111010000","1111001111","1111001110","1111001101","1111001100","1111001011","1111001010","1111001001","1111001000","1111000111","1111000110","1111000101","1111000100","1111000011","1111000010","1111000001","1111000000","1110111111","1110111110","1110111101","1110111100","1110111011","1110111010","1110111001","1110111000","1110110111","1110110110","1110110101","1110110100","1110110011","1110110010","1110110001","1110110000","1110101111","1110101110","1110101101","1110101100","1110101011","1110101010","1110101001","1110101000","1110100111","1110100110","1110100101","1110100100","1110100011","1110100010","1110100001","1110100000","1110011111","1110011110","1110011101","1110011100","1110011011","1110011010","1110011001","1110011000","1110010111","1110010110","1110010101","1110010100","1110010011","1110010010","1110010001","1110010000","1110001111","1110001110","1110001101","1110001100","1110001011","1110001010","1110001001","1110001000","1110000111","1110000110","1110000101","1110000100","1110000011","1110000010","1110000001","1110000000","1101111111","1101111110","1101111101","1101111100","1101111011","1101111010","1101111001","1101111000","1101110111","1101110110","1101110101","1101110100","1101110011","1101110010","1101110001","1101110000","1101101111","1101101110","1101101101","1101101100","1101101011","1101101010","1101101001","1101101000","1101100111","1101100110","1101100101","1101100100","1101100011","1101100010","1101100001","1101100000","1101011111","1101011110","1101011101","1101011100","1101011011","1101011010","1101011001","1101011000","1101010111","1101010110","1101010101","1101010100","1101010011","1101010010","1101010001","1101010000","1101001111","1101001110","1101001101","1101001100","1101001011","1101001010","1101001001","1101001000","1101000111","1101000110","1101000101","1101000100","1101000011","1101000010","1101000001","1101000000","1100111111","1100111110","1100111101","1100111100","1100111011","1100111010","1100111001","1100111000","1100110111","1100110110","1100110101","1100110100","1100110011","1100110010","1100110001","1100110000","1100101111","1100101110","1100101101","1100101100","1100101011","1100101010","1100101001","1100101000","1100100111","1100100110","1100100101","1100100100","1100100011","1100100010","1100100001","1100100000","1100011111","1100011110","1100011101","1100011100","1100011011","1100011010","1100011001","1100011000","1100010111","1100010110","1100010101","1100010100","1100010011","1100010010","1100010001","1100010000","1100001111","1100001110","1100001101","1100001100","1100001011","1100001010","1100001001","1100001000","1100000111","1100000110","1100000101","1100000100","1100000011","1100000010","1100000001","1100000000","1011111111","1011111110","1011111101","1011111100","1011111011","1011111010","1011111001","1011111000","1011110111","1011110110","1011110101","1011110100","1011110011","1011110010","1011110001","1011110000","1011101111","1011101110","1011101101","1011101100","1011101011","1011101010","1011101001","1011101000","1011100111","1011100110","1011100101","1011100100","1011100011","1011100010","1011100001","1011100000","1011011111","1011011110","1011011101","1011011100","1011011011","1011011010","1011011001","1011011000","1011010111","1011010110","1011010101","1011010100","1011010011","1011010010","1011010001","1011010000","1011001111","1011001110","1011001101","1011001100","1011001011","1011001010","1011001001","1011001000","1011000111","1011000110","1011000101","1011000100","1011000011","1011000010","1011000001","1011000000","1010111111","1010111110","1010111101","1010111100","1010111011","1010111010","1010111001","1010111000","1010110111","1010110110","1010110101","1010110100","1010110011","1010110010","1010110001","1010110000","1010101111","1010101110","1010101101","1010101100","1010101011","1010101010","1010101001","1010101000","1010100111","1010100110","1010100101","1010100100","1010100011","1010100010","1010100001","1010100000","1010011111","1010011110","1010011101","1010011100","1010011011","1010011010","1010011001","1010011000","1010010111","1010010110","1010010101","1010010100","1010010011","1010010010","1010010001","1010010000","1010001111","1010001110","1010001101","1010001100","1010001011","1010001010","1010001001","1010001000","1010000111","1010000110","1010000101","1010000100","1010000011","1010000010","1010000001","1010000000","1001111111","1001111110","1001111101","1001111100","1001111011","1001111010","1001111001","1001111000","1001110111","1001110110","1001110101","1001110100","1001110011","1001110010","1001110001","1001110000","1001101111","1001101110","1001101101","1001101100","1001101011","1001101010","1001101001","1001101000","1001100111","1001100110","1001100101","1001100100","1001100011","1001100010","1001100001","1001100000","1001011111","1001011110","1001011101","1001011100","1001011011","1001011010","1001011001","1001011000","1001010111","1001010110","1001010101","1001010100","1001010011","1001010010","1001010001","1001010000","1001001111","1001001110","1001001101","1001001100","1001001011","1001001010","1001001001","1001001000","1001000111","1001000110","1001000101","1001000100","1001000011","1001000010","1001000001","1001000000","1000111111","1000111110","1000111101","1000111100","1000111011","1000111010","1000111001","1000111000","1000110111","1000110110","1000110101","1000110100","1000110011","1000110010","1000110001","1000110000","1000101111","1000101110","1000101101","1000101100","1000101011","1000101010","1000101001","1000101000","1000100111","1000100110","1000100101","1000100100","1000100011","1000100010","1000100001","1000100000","1000011111","1000011110","1000011101","1000011100","1000011011","1000011010","1000011001","1000011000","1000010111","1000010110","1000010101","1000010100","1000010011","1000010010","1000010001","1000010000","1000001111","1000001110","1000001101","1000001100","1000001011","1000001010","1000001001","1000001000","1000000111","1000000110","1000000101","1000000100","1000000011","1000000010","1000000001","1000000000","0111111111","0111111110","0111111101","0111111100","0111111011","0111111010","0111111001","0111111000","0111110111","0111110110","0111110101","0111110100","0111110011","0111110010","0111110001","0111110000","0111101111","0111101110","0111101101","0111101100","0111101011","0111101010","0111101001","0111101000","0111100111","0111100110","0111100101","0111100100","0111100011","0111100010","0111100001","0111100000","0111011111","0111011110","0111011101","0111011100","0111011011","0111011010","0111011001","0111011000","0111010111","0111010110","0111010101","0111010100","0111010011","0111010010","0111010001","0111010000","0111001111","0111001110","0111001101","0111001100","0111001011","0111001010","0111001001","0111001000","0111000111","0111000110","0111000101","0111000100","0111000011","0111000010","0111000001","0111000000","0110111111","0110111110","0110111101","0110111100","0110111011","0110111010","0110111001","0110111000","0110110111","0110110110","0110110101","0110110100","0110110011","0110110010","0110110001","0110110000","0110101111","0110101110","0110101101","0110101100","0110101011","0110101010","0110101001","0110101000","0110100111","0110100110","0110100101","0110100100","0110100011","0110100010","0110100001","0110100000","0110011111","0110011110","0110011101","0110011100","0110011011","0110011010","0110011001","0110011000","0110010111","0110010110","0110010101","0110010100","0110010011","0110010010","0110010001","0110010000","0110001111","0110001110","0110001101","0110001100","0110001011","0110001010","0110001001","0110001000","0110000111","0110000110","0110000101","0110000100","0110000011","0110000010","0110000001","0110000000","0101111111","0101111110","0101111101","0101111100","0101111011","0101111010","0101111001","0101111000","0101110111","0101110110","0101110101","0101110100","0101110011","0101110010","0101110001","0101110000","0101101111","0101101110","0101101101","0101101100","0101101011","0101101010","0101101001","0101101000","0101100111","0101100110","0101100101","0101100100","0101100011","0101100010","0101100001","0101100000","0101011111","0101011110","0101011101","0101011100","0101011011","0101011010","0101011001","0101011000","0101010111","0101010110","0101010101","0101010100","0101010011","0101010010","0101010001","0101010000","0101001111","0101001110","0101001101","0101001100","0101001011","0101001010","0101001001","0101001000","0101000111","0101000110","0101000101","0101000100","0101000011","0101000010","0101000001","0101000000","0100111111","0100111110","0100111101","0100111100","0100111011","0100111010","0100111001","0100111000","0100110111","0100110110","0100110101","0100110100","0100110011","0100110010","0100110001","0100110000","0100101111","0100101110","0100101101","0100101100","0100101011","0100101010","0100101001","0100101000","0100100111","0100100110","0100100101","0100100100","0100100011","0100100010","0100100001","0100100000","0100011111","0100011110","0100011101","0100011100","0100011011","0100011010","0100011001","0100011000","0100010111","0100010110","0100010101","0100010100","0100010011","0100010010","0100010001","0100010000","0100001111","0100001110","0100001101","0100001100","0100001011","0100001010","0100001001","0100001000","0100000111","0100000110","0100000101","0100000100","0100000011","0100000010","0100000001","0100000000","0011111111","0011111110","0011111101","0011111100","0011111011","0011111010","0011111001","0011111000","0011110111","0011110110","0011110101","0011110100","0011110011","0011110010","0011110001","0011110000","0011101111","0011101110","0011101101","0011101100","0011101011","0011101010","0011101001","0011101000","0011100111","0011100110","0011100101","0011100100","0011100011","0011100010","0011100001","0011100000","0011011111","0011011110","0011011101","0011011100","0011011011","0011011010","0011011001","0011011000","0011010111","0011010110","0011010101","0011010100","0011010011","0011010010","0011010001","0011010000","0011001111","0011001110","0011001101","0011001100","0011001011","0011001010","0011001001","0011001000","0011000111","0011000110","0011000101","0011000100","0011000011","0011000010","0011000001","0011000000","0010111111","0010111110","0010111101","0010111100","0010111011","0010111010","0010111001","0010111000","0010110111","0010110110","0010110101","0010110100","0010110011","0010110010","0010110001","0010110000","0010101111","0010101110","0010101101","0010101100","0010101011","0010101010","0010101001","0010101000","0010100111","0010100110","0010100101","0010100100","0010100011","0010100010","0010100001","0010100000","0010011111","0010011110","0010011101","0010011100","0010011011","0010011010","0010011001","0010011000","0010010111","0010010110","0010010101","0010010100","0010010011","0010010010","0010010001","0010010000","0010001111","0010001110","0010001101","0010001100","0010001011","0010001010","0010001001","0010001000","0010000111","0010000110","0010000101","0010000100","0010000011","0010000010","0010000001","0010000000","0001111111","0001111110","0001111101","0001111100","0001111011","0001111010","0001111001","0001111000","0001110111","0001110110","0001110101","0001110100","0001110011","0001110010","0001110001","0001110000","0001101111","0001101110","0001101101","0001101100","0001101011","0001101010","0001101001","0001101000","0001100111","0001100110","0001100101","0001100100","0001100011","0001100010","0001100001","0001100000","0001011111","0001011110","0001011101","0001011100","0001011011","0001011010","0001011001","0001011000","0001010111","0001010110","0001010101","0001010100","0001010011","0001010010","0001010001","0001010000","0001001111","0001001110","0001001101","0001001100","0001001011","0001001010","0001001001","0001001000","0001000111","0001000110","0001000101","0001000100","0001000011","0001000010","0001000001","0001000000","0000111111","0000111110","0000111101","0000111100","0000111011","0000111010","0000111001","0000111000","0000110111","0000110110","0000110101","0000110100","0000110011","0000110010","0000110001","0000110000","0000101111","0000101110","0000101101","0000101100","0000101011","0000101010","0000101001","0000101000","0000100111","0000100110","0000100101","0000100100","0000100011","0000100010","0000100001","0000100000","0000011111","0000011110","0000011101","0000011100","0000011011","0000011010","0000011001","0000011000","0000010111","0000010110","0000010101","0000010100","0000010011","0000010010","0000010001","0000010000","0000001111","0000001110","0000001101","0000001100","0000001011","0000001010","0000001001","0000001000","0000000111","0000000110","0000000101","0000000100","0000000011","0000000010","0000000001","0000000000",}};
string str[1005];
int check(string c){//求出最大的k，使得所有长度为k的01串均被c包含
	for(int i=0;i<=9;i++){
		for(int j=0;j<(2<<i);j++){//长度为k的01串有2^k个
			if(c.find(s[i][j])==-1){//如果没找到
				return i;
			}
		}
	}
	return 10;
}
int main(){
	cin>>n;
	for(int i=1;i<=n;i++){
		cin>>str[i]; 
	}
	cin>>m;
	for(int i=1;i<=m;i++){
		int a,b;
		string c;
		cin>>a>>b;
		str[i+n]=str[a]+str[b];
		ans[i+n]=max(max(ans[a],ans[b]),check(str[i+n]));
		if(str[i+n].size()>2000)str[i+n]=str[i+n].substr(0,1000)+str[i+n].substr(str[i+n].length()-1000,1000);
		cout<<ans[i+n]<<endl;
	}
}
```

---

## 作者：沉石鱼惊旋 (赞：1)

# 题目翻译

给定 $n(n\leq 100)$ 个字符串 $s_i$，满足 $\sum |s_i|\leq 100$，再给出 $m(m\leq 100)$ 个新串，给定 $x,y$，新串为 $s_x+s_y$。对于这 $m$ 个串，找到最大的 $k$，使得所有长度为 $k$ 的 01 串均被其包含。

# 题目思路

设子串长度是 $L$，因为 $\sum |s_i|\leq 100$，因此长度为 $L$ 的互不相同的子串仅在原 $n$ 个串中也只会有 $100$ 个。$m\leq 100$，每次连接最多产生 $L-1$ 个本质不同的长度为 $L$ 的子串，所以长度为 $L$ 的不同子串最多只有 $(L-1)\times 100+100=100L$ 个。然而要满足包含所有长度为 $L$ 的子串，必要条件是 $100L\geq 2^{L}$。解得 $L\leq 9$，也就是说，我们不可能构造答案为 $10$ 的数据。

那么知道这个结论之后就很好做了。我们判断是否合法只需要暴力匹配。但是我们合并之后的字符串会很长，我们发现中间很大一部分是没有用的，我们前后保留 $900$ 个字符即可。

但这 $900$ 个字符只是我们认为的『可能得到的更优答案』，这样又导致我们可能答案产生在没有被我们保留的部分中，产生在了我们删除的部分之中。设我们每次拼接 $s_x,s_y$，这两个串的答案是 $ans_x,ans_y$，我们删除的部分答案只可能有 $\max\{ans_x,ans_y\}$。因此我们答案取 $\max\{ans_x,ans_y,k\}$ 即可。其中 $k$ 是我们合并之后的答案。

# 完整代码

```cpp
#include <bits/stdc++.h>
using namespace std;
template <typename T>
void chkmx(T &x, T y) { x = max(x, y); }
int n, m;
string s[520];
int ans[520];
int main()
{
    cin >> n;
    for (int i = 1; i <= n; i++)
        cin >> s[i];
    cin >> m;
    for (int i = n + 1; i <= n + m; i++)
    {
        int x, y;
        cin >> x >> y;
        s[i] = s[x] + s[y];
        ans[i] = max(ans[x], ans[y]);
        for (int k = 1; k <= 9; k++)
        {
            bool ok = 1;
            for (int S = 0; S < 1 << k; S++)
            {
                string t = "";
                for (int j = 0; j < k; j++)
                    t += char('0' + (S >> j & 1));
                if (s[i].find(t) == string::npos)
                    ok = 0;
            }
            if (!ok)
            {
                chkmx(ans[i], k - 1);
                break;
            }
        }
        if (s[i].size() > 1800)
            s[i] = s[i].substr(0, 900) + '-' + s[i].substr(s[i].size() - 900);
        cout << ans[i] << endl;
    }
    return 0;
}
```

---

## 作者：promise_ (赞：1)

## 题目意思
给出 $n$ 个 $01$ 串，有 $m$ 个询问 $a, b$，要求合并字符串 $a$ 和字符串 $b$，然后求出合并后字符串最大的 $k$。
## 思路
我们做这道题首先需要知道一个结论：$k$ 都非常小，最大不会超过 $10$。因为已经知道答案很小，就直接暴力就好了，~~可以各种乱搞，二分，SAM等等~~。本题解主要说一下这个结论的证明。

推导：

在前 $n$ 个字符串中，每个字符串的长度最大为 $100$。

因此在长度为 $k$ 的子串中最多也只能出现前 $100$ 个字符串（假设每个字符串都只包含 $k$ 长度的子串）。

在拼接的字符串中，由于每次拼接都会增加一个字符串的长度，假设目前的拼接字符串长度为 $L$，则其中可能包含的最长子串的长度为 $L-1$（或者说是最大 $L-1$ 长度的子串可能是拼接后字符串的子串）。

综合前面两个推理，可以得出 $L-1 \leq 100+(k-1) \times 100$。

解方程不等式，可以得出：$(k-1) \times 100 \leq L-1 \leq 100+(k-1) \times 100$。

化简后得：$k \leq 10$。

---

## 作者：Daniel_yao (赞：1)

## 题目翻译

给出 $n$ 个 01 字符串，有 $m$ 个询问 $a$, $b$，要求合并字符串 $a$ 和字符串 $b$，然后求出合并后字符串最大的 $k$。$k$ 要满足：长度为 $k$ 的字符串都是合并后字符串的子串。

## 具体思路

这题解法很多，前提是要知道一点：k 的范围不会很大，甚至不会超过 10。知道了答案范围这么小以后基本就可以瞎搞了，暴力，搜索，二分，STL 什么的都能上。

将字符串看成 2 进制数以后转成十进制，然后标记出来，每次两个字符串进行拼接的话只会在中间拼接的地方产生新串，因此对于超过一定长度的串，我们只保存其固定长度的前后缀就好了，并且对每个串标记一下是否是只保存了前后缀，还是保存了整串。

在k很小的情况下，暴力枚举全排列再判断就行。

但网上很多题解都写了 $2 \times k$，而且是 int，据我所知，这个肯定会爆

然而都 AC 了，说明有某种结论（或者数据太水）。

最后，~~代码就不上了~~。

[评测记录](https://www.luogu.com.cn/record/69704524)

---

## 作者：liuandwang (赞：0)

# 题目翻译
看看[ta](https://www.luogu.com.cn/blog/yzy001633/solution-cf868d)的。
# 具体思路
我们先思考 $k$ 的范围：

若 $k = 10$，由所有字符串的长度总和不超过 $100$，因此在初始的 $n$ 个串里，互不相同的长度为 $k$ 的子串不超过 $100$ 个。又由于每次连接最多能产生 $9$ 个新的长度为 $k$ 的子串（即横跨两个字符串之间的子串），因此互不相同的子串个数最多为 $9$。

那么我们可以列不等式 $9 \times 100 + 100 \le 2 ^ {k}$，解得 $k \le 10$。

既然 $k$ 的范围这么小，那这题就很简单了。
# Code
```cpp
#include <bits/stdc++.h>
using namespace std;
bool ss(string a,string b){  //判断是不是字串
	for(int i=0;i<a.size();i++){
		if(a[i]==b[0]){
			bool x=0;
			for(int j=0;j<b.size();j++){
				if(a[i+j]!=b[j]){
					x=1;
					break; 
				}
			} 
			if(x==0) return 0;
		} 
	}
	return 1;
}
int bfs(string s,string a,int k){    //进行枚举
	if(ss(s,a+"0")==0&&ss(s,a+"1")==0) return min(bfs(s,a+"0",k+1),bfs(s,a+"1",k+1));
	else return k-1;
}
int main(){
	int n,m;
	cin>>n;
	struct node{
		string s;
	}a[1000];
	for(int i=0;i<n;i++) cin>>a[i].s;
	cin>>m;
	int flag=n;
	for(int i=0;i<m;i++){
		int l,r;
		cin>>l>>r;
		l-=1;r-=1;
		string str=a[l].s+a[r].s,x;
		a[flag].s=str;
		flag++;
		cout<<bfs(str,x,1)<<endl;
	}
	return 0;
```

---


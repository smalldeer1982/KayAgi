# Cubeword

## 题目描述

立方填词是一种特殊的填词游戏。填词之前，你需要选择立方体的边长 $a$，然后你就可以建立一个有 $a^3$个单位立方体的立方体了。这个大立方体有 $12$ 条边。然后，你去掉所有没有接触大立方体边的单位立方体。下图展示了当 $a=6$ 时建立的最终立方体。
![](https://espresso.codeforces.com/743579208d31cd16eff004ef390b8dac9e629deb.png)
最后，你需要给剩下的每个单位立方体填上一个字母。对于这个立方体，填词之后，每条边上的单词都应该是有意义的。每条边都可以双向阅读，只要从一个方向读起来有意义即可。

下图展示了当 $a=6$ 时的一个立方体。一些单位立方体已经填上了字母。你已经可以沿这个大立方体的三条边读到 `SUBMIT`，`ACCEPT` 和 `TURING` 三个单词了。
![](https://espresso.codeforces.com/445fa4bb5fa3a176392f5a5a8932ea96dcad7e94.png)
给定一系列有意义的单词，每个单词可以在合法的立方体的任意一条边上出现。求可以构造多少种不同的立方体对 $998244353$ 取模。

如果一个立方体可以通过旋转和镜像操作变成另一个立方体，则认为这两个立方体是不同的。

## 样例 #1

### 输入

```
1
radar
```

### 输出

```
1
```

## 样例 #2

### 输入

```
1
robot
```

### 输出

```
2
```

## 样例 #3

### 输入

```
2
FLOW
WOLF
```

### 输出

```
2
```

## 样例 #4

### 输入

```
2
baobab
bob
```

### 输出

```
4097
```

## 样例 #5

### 输入

```
3
TURING
SUBMIT
ACCEPT
```

### 输出

```
162
```

## 样例 #6

### 输入

```
3
MAN1LA
MAN6OS
AN4NAS
```

### 输出

```
114
```


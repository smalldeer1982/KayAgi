# Gnomes of Might and Magic

## 题目描述

Vasya 最近正在玩一款叫作`迷你世界之侏儒魔法门`的游戏。

游戏中 Vasya 管理着迷你世界侏儒王国，王国中总共有 $n$ 个城堡，其中有 $m$ 个主要的城堡，中间用好路链接，第 $i$ 条好路连接着 $a_i$ 与 $a_{i+1}$，特别的，第 $m$ 条好路连接 $a_m$ 与 $a_1$，除了这 $m$ 条“好路”，城堡与城堡之间没有其他“好路”。

相应的，每条好路连接的两个端点都引出去一条坏路，这个坏路保证：

1. 坏路的开头和结尾一定是有好路连接的两个城堡。
2. 坏路除开头和结尾外的城堡都不是主要城堡。
3. 没有任何一个非主要城堡被两条坏路经过。
4. 每个城堡都在坏路上，其中有一些在好路上。

好路和坏路都是无向边。

每个时刻，都会有某一条道路上出现了张献忠，如果有人经过这条道路，那么张献忠就会把那个人图图了，Vasya 作为这个国家的领导人，发现这样不行，决定派出刘进忠从 $S$ 点前往 $T$ 点，刘进忠走到哪图到哪，他会选择一条从 $S$ 点到 $T$ 点的路径使得走这条路径图图的张献忠最少，如果有多条路径，选择长度最小的，如果有多条路径，选择字典序最小的。

注意：每次询问不独立。

## 样例 #1

### 输入

```
6 3
1 2 3
3 1 4 2
3 2 5 3
3 3 6 1
10
+ 1 2
+ 4 2
+ 1 3
+ 2 3
? 1 2
+ 2 5
? 1 2
? 1 2
+ 1 2
? 1 2
```

### 输出

```
0
1
0
1
```


# Bit Game (Easy Version)

## 题目描述

### 题面
**这是这个问题的简单版本。唯一不同的是，在这个版本中，您需要输出游戏的获胜者，而且每堆棋子的数量是固定的。您必须同时解出这两个版本才能破解**。

爱丽丝和鲍勃正在玩一个熟悉的游戏，他们轮流从 $n$ 堆中取出棋子。最初，在第 $i$ 堆中有 $x_i$ 颗棋子，它的相关值为 $a_i$ 。当且仅当以下两个条件都满足时，棋手才能从第 $i$ 堆中拿走 $d$ 颗棋子：

- $1 \le d \le a_i$ ，以及
- $x \ \&\  d = d$ ，其中 $x$ 是当前第 $i$ 中的棋子数量， $\&$ 表示[位和运算](https://en.wikipedia.org/wiki/Bitwise_operation#AND)。
 
无法下棋的棋手输棋，爱丽丝先下。

给你每堆棋子的 $a_i$ 和 $x_i$ 值，请判断如果双方都以最佳方式下棋，谁会赢。

## 样例 #1

### 输入

```
7
2
1 6
10 7
3
10 8 15
25 4 14
4
8 32 65 64
7 45 126 94
3
20 40 1
23 55 1
5
12345 9876 86419 8641 1
6789 54321 7532 97532 1
2
20 64
44 61
3
57 109 55
69 90 85```

### 输出

```
Bob
Bob
Bob
Bob
Bob
Alice
Alice```

# 题解

## 作者：ForgotMe (赞：4)

很有难度的 $\operatorname{SG}$ 函数题。

显然这是取石子游戏的变种，只要能够快速求出每堆石子的 $\operatorname{SG}$ 值，问题就得以解决。

首先定义 $\operatorname{SG}(a,x)$ 表示限制为 $a$ 当前有 $x$ 个石子的状态对应的 $\operatorname{SG}$ 值。如果你跟我一样，尝试写一个朴素的暴力去寻找规律，那么多半就死了。

这条路行不通的原因在于这个 $\operatorname{SG}$ 函数中有两个变量，非常难以发现其中的规律。于是一个非常大胆的想法是，能否将这个 $\operatorname{SG}$ 函数压成一个只有一个变量的函数呢？答案是可以的。

考虑对 $(a,x)$ 进行一些调整。注意到这个拿石子操作本质上是拿走 $x$ 二进制上的一些 $1$，那么将 $(a,x)$ 放在二进制上进行观察。首先有如下几个比较简单的调整：

- 设 $a$ 的最高位 $1$ 的位置在 $pos$，那么对于 $x$ 中位置在 $pos$ 之后的 $1$ 是一定取不了的，可以直接删除。

- 如果 $a,x$ 的第 $i$ 位都是 $0$，这一位没用都可以直接删除。

上面两个调整比较简单，不足以将 $\operatorname{SG}$ 函数压维。

考虑从高到底找到最大的 $i$ 满足 $a$ 的第 $i$ 位为 $1$，$x$ 的第 $i$ 位为 $0$，注意这一位本身就没有可以取的 $1$，那么相当于对于 $0\sim i-1$ 位，这些位是可以任取的，于是可以将该位删除并把 $a$ 的第 $0\sim i-1$ 全部变为 $1$。最后一步调整是如果 $p$ 满足 $p\in [0,i-1]$ 且 $x$ 的第 $p$ 位是 $0$，那么第 $p$ 位可以一并删掉。

设调整后的 $a,x$ 分别为 $a_2,x_2$，一个非常好的性质是，$x_2=2^k-1$，其中 $k$ 是最小的满足 $2^k-1\ge a_2$ 的整数，也就是说调整后 $x_2$ 二进制下一段前缀是 $1$，其余都是 $0$。

显然调整并不会对 $\operatorname{SG}$ 的值造成影响，那么现在需要计算 $\operatorname{SG}(a_2,x_2)$，由于 $a_2$ 决定了 $x_2$ 的值，将其记作 $g(a_2)$。

一维就好找规律多了，这里直接给出规律：

- $g(2^k-2)=0$，要求 $k\ge 1$。
- $g(2^k-1)=k$。
- $g(2^k)=k\oplus 1$。
- $g(2^k+1)=g(2^k+2)=...=g(2^{k+1}-3)=k+1$，要求 $k\ge 2$。

前三个比较好证明，在纸上画一画发现就是普通的取石子游戏。重点是第 $4$ 个性质，这个比较难证，首先要证明的是 $k+1$ 取不到，这个很好证，因为每取一次新的 $a_2$ 至少变为原来的 $\frac{1}{2}$，前面只有一个 $g(2^k)$ 可能取到 $k+1$，主要是证 $0\sim k $ 都出现了比较难，建议去看官方题解，不太容易说的清楚。

那么这个题就做完了，复杂度 $\mathcal{O}(n\log V)$。

代码：https://www.luogu.com.cn/paste/8f1ibti1

---


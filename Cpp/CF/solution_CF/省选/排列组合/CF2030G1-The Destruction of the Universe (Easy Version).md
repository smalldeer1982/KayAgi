# The Destruction of the Universe (Easy Version)

## 题目描述

这是问题的简单版本，满足 $ n \leq 5000 $。如果两个版本的问题都被解决，才可以进行挑战。

猩猩是强大的生物，它们只需要 $1$ 个单位时间就能摧毁宇宙中每一个脆弱的星球！

宇宙中有 $n$ 个星球。每个星球在一个区间 $[l, r]$ 内是脆弱的，期间随时可能被猩猩摧毁。猩猩可以把任意一个星球的脆弱区间扩展 $1$ 个单位。

具体来说，如果对某个星球 $p$ 的脆弱区间 $[l_p, r_p]$ 进行扩展，结果可以是 $[l_p - 1, r_p]$ 或 $[l_p, r_p + 1]$ 中的任一个。

给定一组星球，如果它们的所有脆弱区间中至少有一个共同点，那么这组星球就能被摧毁。我们把这样一组星球的“得分”定义为实现摧毁所需的最小扩展次数。

猩猩关注的是宇宙中所有非空星球子集的得分之和。由于可能结果非常大，请输出答案对 $998\,244\,353$ 取模后的结果。

## 说明/提示

以第一个测试用例为例，需考虑以下七个非空子集：

- 对于子集 $\{[1,1]\}, \{[2,3]\}, \{[3,3]\}$，得分为 $0$。
- 对于子集 $\{[2,3], [3,3]\}$，得分为 $0$，因为点 $3$ 已经位于这两个星球的脆弱区间之内。
- 对于子集 $\{[1,1], [2,3]\}$，得分为 $1$。通过一次操作，将第二个星球的脆弱区间改为 $[1,3]$，这样两个星球的脆弱区间都包含点 $1$。
- 对于子集 $\{[1,1], [3,3]\}$，得分为 $2$。通过两次操作，将第一个星球的脆弱区间改为 $[1,3]$，使得两个星球的区间都包含点 $3$。
- 对于子集 $\{[1,1], [2,3], [3,3]\}$，得分为 $2$。通过一次操作把第一个星球的区间改为 $[1,2]$，再用一次操作把第三个星球的区间改为 $[2,3]$，这样三个星球都包含点 $2$。

所以，第一个测试用例中，所有非空子集的得分之和为 $0 \times 4 + 1 \times 1 + 2 \times 2 = 5$。

 **本翻译由 AI 自动生成**

## 样例 #1

### 输入

```
3
3
1 1
2 3
3 3
4
1 4
2 3
2 4
1 1
5
1 2
2 3
3 4
4 5
1 5```

### 输出

```
5
6
24```

# 题解

## 作者：happybob (赞：2)

题意：

对于一个正整数区间集合 $S=\{[l_1,r_1],[l_2,r_2],\cdots,[l_n,r_n]\}$，定义其分数为最小的操作次数，使得这些区间交集非空。每次操作如下：

选择 $1 \leq i \leq k$，令 $[l_i,r_i]$ 变为 $[l_i-1,r_i]$ 或 $[l_i,r_i+1]$。

给定集合 $S$，求其所有子集的分数之和，对 $998244353$ 取模的结果。

$1 \leq n \leq 5000$，$1 \leq l_i \leq r_i \leq n$。

解法：

肯定先考虑一个集合的分数怎么计算。直接做就是枚举最终交点位置，计算次数然后取最小值，但这个式子有最小值，不容易计算。考虑贪心。对于集合 $S$，定义 $score(S)$ 表示其分数。选出 $l$ 最大的 $i$ 和 $r$ 最小的 $j$。若 $l_i \leq r_j$，则 $score(S)=0$，否则 $score(S)=l_i-r_j+score(S\setminus \{[l_i,r_i],[l_j,r_j]\})$。证明考虑归纳，左式大于等于右式显然成立。且按照这样做确实能取等。

现在考虑枚举两个区间 $[l_i,r_i]$ 和 $[l_j,r_j]$，如果他们有交，则不会产生贡献。否则，不妨假设 $r_i < l_j$，则贡献为 $l_j-r_i$ 乘上一个贡献系数。发现这两个区间会被选择，当且仅当所有 $l$ 大于 $l_j$ 的区间数量与 $r<r_i$ 的区间数量相同。令 $x$ 为 $l>l_j$ 区间数量，$y$ 为 $r<r_i$ 区间数量。则贡献系数形如 $\sum \limits_{i} \dbinom{x}{i}\dbinom{y}{i}2^{n-2-x-y}$。注意到 $\dbinom{x}{i}\dbinom{y}{i}$ 是范德蒙德卷积形式，最终可以直接变成一个组合数。这样得到了 $O(n^2)$ 的复杂度。

[Submission Link.](https://codeforces.com/contest/2030/submission/286862675)

---


# 题目信息

# Moving Both Hands

## 题目描述

Alice 在进行一个有向图上做游戏。有向图上共有 $n$ 个节点，$m$ 条有向边。Alice的手上有
一个红色球和一个蓝色球。
游戏开始时，Alice将红色球放在 $1$ 号节点上，将蓝色球放在 $i$ 号节点上。
长度为 $w$
的有向边表示可以通过一次操作将在 $v$ 的点转移
到 $u$ 
花费 $w$ 时间。
每局游戏中，Alice 要通过尽可能少的时间将两个球共同转移到任意同一个节点上。Alice 同一时间只能操作一个球。现在 Alice 想知道对于每个点 $2\le i \le n$
，每局游戏完成的最小时间是
多少。

## 样例 #1

### 输入

```
5 7
1 2 2
2 4 1
4 1 4
2 5 3
5 4 1
5 2 4
2 1 1```

### 输出

```
1 -1 3 4```

# AI分析结果

### 题目翻译
题目内容为中文，无需翻译。

### 算法分类
最短路

### 综合分析与结论
这些题解的核心思路都是通过建分层图来解决问题。将图分为两层，第一层为正图，第二层为反图，每个正图的点向对应的反图点连一条边权为 0 的边，这样就可以将原问题转化为在分层图上求从 1 号点到对应反图点的最短路问题。

各题解的算法要点基本一致，都是先建图（包括正图、反图和连接正图与反图的边），然后使用 Dijkstra 算法求最短路。

解决的难点在于如何将原问题转化为分层图上的最短路问题，以及如何正确地建图和跑最短路算法。

### 所选题解
- Hisaishi_Kanade（5 星）
    - 关键亮点：思路清晰，代码实现规范，对建图和最短路算法的处理都很详细。
- panyanppyy（5 星）
    - 关键亮点：不仅给出了分层图的解法，还提供了另一种思路，并且对分层图的概念解释得很清楚。
- Mariposa（4 星）
    - 关键亮点：简洁明了地阐述了建分层图的思路和步骤，代码实现也较为清晰。

### 重点代码
以 Hisaishi_Kanade 的题解为例，核心代码如下：
```cpp
// 建边函数
inline void work(int l,int r,int s){
    ++top;
    edge[top].l=pre[l];
    edge[top].r=r;
    edge[top].s=s;
    pre[l]=top;
}

// Dijkstra 算法
while(!q.empty()){
    now=q.top();
    q.pop();
    if(!v[now.id]){
        v[now.id]=true;
        for(int i=pre[now.id];i>0;i=edge[i].l){
            if(dis[edge[i].r]>dis[now.id]+edge[i].s){
                dis[edge[i].r]=dis[now.id]+edge[i].s;
                if(!v[edge[i].r])q.push((point){edge[i].r,dis[edge[i].r]});
            }
        }
    }
}
```
核心实现思想：先通过 `work` 函数建立分层图的边，然后使用优先队列实现 Dijkstra 算法求最短路。

### 关键思路或技巧
- **分层图思想**：将原问题转化为分层图上的最短路问题，通过建反图和连接正图与反图的边，将两个球的移动问题统一到一个图中求解。
- **Dijkstra 算法**：使用优先队列优化的 Dijkstra 算法求最短路，时间复杂度为 $O((n + m) \log n)$。

### 拓展思路
同类型题或类似算法套路：
- 涉及多状态或多条件的图论问题，如可以在图中进行有限次状态转换的最短路问题。
- 可以通过建分层图将不同状态或条件的图合并，然后使用最短路算法求解。

### 推荐题目
- [P4568 [JLOI2011]飞行路线](https://www.luogu.com.cn/problem/P4568)：可以使用分层图解决在一定次数免费飞行的情况下的最短路问题。
- [P4822 [BJWC2012]冻结](https://www.luogu.com.cn/problem/P4822)：类似的在一定次数可以减半花费的情况下求最短路的问题。
- [P2939 [USACO09FEB]Revamping Trails G](https://www.luogu.com.cn/problem/P2939)：在可以升级一定数量的边的情况下求最短路的问题。

### 个人心得
panyanppyy 提到自己赛时降智没有过这道题，说明在比赛中可能会因为紧张或其他原因出现思路不清晰的情况，需要在平时多练习，提高自己的解题能力和心理素质。

---
处理用时：31.95秒
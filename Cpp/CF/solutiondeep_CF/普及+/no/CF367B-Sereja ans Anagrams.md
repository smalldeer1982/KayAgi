# 题目信息

# Sereja ans Anagrams

## 题目描述

### 题目翻译

Sereja 有两个序列 $a$ 和 $b$，还有一个数字 $p$。$a$ 序列为 $a_1,a_2,a_3,\cdots,a_n$，$b$ 序列为 $b_1,b_2,b_3,\cdots,b_n$。

Sereja 像往常一样学习他的序列，今天他想要找到若干个正整数 $q$ 使得 $q+(m-1) \times p \le n$ 并且 $q \ge 1$，同时需要满足的是 $a_q,a_{q+p},a_{q+2 \times p},\cdots,a_{q+(m-1) \times p}$ 和 $b$ 序列一样。

定义这里的序列一样不需要每个位置上的数相同，只需要他们所包含的数值相同。

比如 $1,2,3$ 和 $1,3,2$ 是一样的，但是 $1,3,3$ 和 $1,3,2$ 是不一样的。

## 样例 #1

### 输入

```
5 3 1
1 2 3 2 1
1 2 3
```

### 输出

```
2
1 3
```

## 样例 #2

### 输入

```
6 3 2
1 3 2 2 3 1
1 2 3
```

### 输出

```
2
1 2
```

# AI分析结果

### 题目内容
# Sereja ans Anagrams

## 题目描述

### 题目翻译
Sereja 有两个序列 $a$ 和 $b$，还有一个数字 $p$。$a$ 序列为 $a_1,a_2,a_3,\cdots,a_n$，$b$ 序列为 $b_1,b_2,b_3,\cdots,b_n$。

Sereja 像往常一样学习他的序列，今天他想要找到若干个正整数 $q$ 使得 $q+(m - 1)\times p \leq n$ 并且 $q \geq 1$，同时需要满足的是 $a_q,a_{q + p},a_{q + 2\times p},\cdots,a_{q + (m - 1)\times p}$ 和 $b$ 序列一样。

定义这里的序列一样不需要每个位置上的数相同，只需要他们所包含的数值相同。

比如 $1,2,3$ 和 $1,3,2$ 是一样的，但是 $1,3,3$ 和 $1,3,2$ 是不一样的。

## 样例 #1
### 输入
```
5 3 1
1 2 3 2 1
1 2 3
```
### 输出
```
2
1 3
```

## 样例 #2
### 输入
```
6 3 2
1 3 2 2 3 1
1 2 3
```
### 输出
```
2
1 2
```

### 算法分类
无算法分类

### 综合分析与结论
题解通过用 `map` 维护序列中数的种类和个数来判断两个序列是否相同，利用队列优化枚举起点的过程，将序列按 $\bmod p$ 分层，减少重复枚举量，从而降低时间复杂度。代码实现时需注意当 `map` 中一种数的个数为 $0$ 时要将其 `erase`。

### 所选的题解
 - **星级**：4星
 - **关键亮点**：利用 `map` 方便地判断序列是否相同，通过队列优化枚举起点，按 $\bmod p$ 分层减少重复计算。
 - **个人心得**：无

### 重点代码及核心实现思想
```cpp
inline void solve(int x)
{
    cnt.clear();
    head = tail = 0;
    for (int i = x; i <= n; i += p)
    {
        q[++tail] = val[i];
        cnt[val[i]]++;
        if (tail - head == m)
        {
            if (B == cnt) ans.push_back(head * p + x);
            cnt[q[++head]]--;
            if (!cnt[q[head]]) cnt.erase(q[head]);
        }
    }
}
```
核心实现思想：从起点 `x` 开始，每次间隔 `p` 取数加入队列 `q` 并更新 `map` `cnt`，当队列长度达到 `m` 时，判断此时 `cnt` 与序列 `b` 对应的 `map` `B` 是否相等，若相等则记录该起点，然后将队头元素移除并更新 `cnt`。

### 通用建议与扩展思路
通用建议：在处理判断序列元素组成相同这类问题时，`map` 是一个很实用的数据结构。对于枚举问题，要善于发现枚举过程中的重复部分并进行优化。
扩展思路：同类型题可考虑进一步增加序列的维度，或者改变判断序列相同的条件。类似算法套路可以应用在其他需要判断子序列特征的场景，通过合理利用数据结构和优化枚举过程来解决问题。

### 洛谷相似题目
 - [P1085 不高兴的津津](https://www.luogu.com.cn/problem/P1085)
 - [P1164 小A点菜](https://www.luogu.com.cn/problem/P1164)
 - [P1217 [USACO1.5]回文质数 Prime Palindromes](https://www.luogu.com.cn/problem/P1217)

---
处理用时：31.06秒
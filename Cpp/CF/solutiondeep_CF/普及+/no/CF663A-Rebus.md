# 题目信息

# Rebus

## 题目描述

You are given a rebus of form ? + ? - ? + ? = n, consisting of only question marks, separated by arithmetic operation '+' and '-', equality and positive integer $ n $ . The goal is to replace each question mark with some positive integer from $ 1 $ to $ n $ , such that equality holds.

## 样例 #1

### 输入

```
? + ? - ? + ? + ? = 42
```

### 输出

```
Possible
9 + 13 - 39 + 28 + 31 = 42
```

## 样例 #2

### 输入

```
? - ? = 1
```

### 输出

```
Impossible
```

## 样例 #3

### 输入

```
? = 1000000
```

### 输出

```
Possible
1000000 = 1000000
```

# AI分析结果

### 题目内容
# 谜题

## 题目描述
给定一个谜题，形式为? +? -? +? = n，仅由问号、算术运算符“+”和“-”、等号以及正整数n组成。目标是用1到n之间的某个正整数替换每个问号，使等式成立。

## 样例 #1
### 输入
```
? +? -? +? +? = 42
```
### 输出
```
Possible
9 + 13 - 39 + 28 + 31 = 42
```

## 样例 #2
### 输入
```
? -? = 1
```
### 输出
```
Impossible
```

## 样例 #3
### 输入
```
? = 1000000
```
### 输出
```
Possible
1000000 = 1000000
```

### 算法分类
数学

### 题解综合分析与结论
Sharpsmile的题解思路清晰，通过数学分析确定等式结果的取值范围，以此判断是否有解，并在有解时通过贪心策略构造出解。其核心在于对等式中正负变量的分析，以及对等式值域边界的推导。

### 所选的题解
 - **Sharpsmile的题解**：
    - **星级**：4星
    - **关键亮点**：通过定义正负变量，推导出等式值域边界，利用贪心策略构造解。
    - **个人心得**：作者提到自己吃了两发罚时，暗示在解题过程中遇到了一些容易犯错的点，但未详细说明。

### 重点代码及核心实现思想
```cpp
	int NN=N,PP=P*n;//NN就是SN，PP就是SP，这里实现的时候是从高向低调整，是同理的
        while(PP-NN>n){
            if(PP==P)NN+=PP-NN-n;
            else PP-=min(PP-NN-n,PP-P);
        }
        while(N--){
            qN.push_back(min(NN-N,n));
            NN-=qN.back();//qN存储了所有的负变量
        }
        while(P--){
            qP.push_back(min(PP-P,n));
            PP-=qP.back();//qP存储的是所有的正变量
        }
```
核心实现思想：首先初始化正负变量和的目标值，然后通过循环调整正负变量和的差值，使其满足等式要求。接着分别为正负变量构造具体的值，构造时从高到低，优先满足较大值，保证每个变量在1到n之间。

### 最优关键思路或技巧
通过数学分析确定等式值域边界，利用贪心策略构造解。这种思路将复杂的等式求解问题转化为对变量和范围的分析与调整，简化了问题解决过程。

### 可拓展之处
同类型题可关注一些需要通过数学推导确定取值范围，并基于范围进行构造或判断的题目。类似算法套路是在遇到等式相关问题时，尝试分析等式中变量变化对结果的影响，从而确定解的存在性及求解方法。

### 洛谷相似题目推荐
 - [P1085 不高兴的津津](https://www.luogu.com.cn/problem/P1085)：通过对数据的分析和计算来确定结果，与本题通过分析等式确定解有相似之处。
 - [P1147 连续自然数和](https://www.luogu.com.cn/problem/P1147)：需要通过数学方法找出满足条件的连续自然数序列，与本题通过数学推导构造解思路类似。
 - [P1440 求m区间内的最小值](https://www.luogu.com.cn/problem/P1440)：通过对区间数据的分析和处理来求解，与本题对等式中变量分析处理有相似的思维方式。 

---
处理用时：32.81秒
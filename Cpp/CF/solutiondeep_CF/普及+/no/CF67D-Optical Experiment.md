# 题目信息

# Optical Experiment

## 题目描述

如图所示，有 $n$ 条光线从矩形上边的 $n$ 个洞射入矩形区域后从下边的 $n$ 个洞射出。



已知从第 $i$ 个洞射入的光线编号为 $x_i$，从第 $i$ 个洞射出的光线编号为 $y_i$，要求从这 $n$ 条光线中选出最多数量的光线，使得这些光线中任意两条都会在矩形区域内相交。

## 样例 #1

### 输入

```
5
1 4 5 2 3
3 4 2 1 5
```

### 输出

```
3
```

## 样例 #2

### 输入

```
3
3 1 2
2 3 1
```

### 输出

```
2
```

# AI分析结果

### 题目内容
# 光学实验

## 题目描述
如图所示，有 $n$ 条光线从矩形上边的 $n$ 个洞射入矩形区域后从下边的 $n$ 个洞射出。

已知从第 $i$ 个洞射入的光线编号为 $x_i$，从第 $i$ 个洞射出的光线编号为 $y_i$，要求从这 $n$ 条光线中选出最多数量的光线，使得这些光线中任意两条都会在矩形区域内相交。

## 样例 #1
### 输入
```
5
1 4 5 2 3
3 4 2 1 5
```
### 输出
```
3
```

## 样例 #2
### 输入
```
3
3 1 2
2 3 1
```
### 输出
```
2
```
### 算法分类
动态规划（通过求最长上升子序列解决问题，属于动态规划范畴）

### 综合分析与结论
两篇题解思路基本一致，都发现了当选出的光线按射入洞口编号排序后，其射出洞口编号应呈倒序，所以对射入洞口编号排序后，对射出洞口编号求最长上升（不下降）子序列就能得到结果。不同点在于代码实现细节，如快读函数写法、数据结构定义、初始化方式等。

### 所选的题解
- **作者：liuyongle（3星）**
    - **关键亮点**：思路清晰，通过排序和求最长上升子序列解决问题，代码实现中使用了快读优化输入。
    - **个人心得**：提到最大值最好开到 `0x3f3f3f3f`，避免使用 `typedef pair<int,int> pii;` 这种定义方式，否则编译器会报错，建议用 `define` 代替。
    - **重点代码简述**：定义结构体存储光线射入和射出信息，通过快读函数读取数据，对光线按射入洞口编号排序后，处理射出洞口编号数组，调用 `LIS` 函数求最长上升子序列。
    - **核心代码片段**：
```cpp
int LIS() {
    for(int i=1;i<n;++i)
        dp[i]=INF;
    dp[0]=a[0];
    int len=1;
    for(int i=1;i<n;++i)
        if(a[i]>dp[len-1])
            dp[len++]=a[i];
        else
            dp[lower_bound(dp,dp+n,a[i])-dp]=a[i]; 
    return len;
}
```
- **作者：ys_kylin__（3星）**
    - **关键亮点**：同样基于排序和最长不下降子序列解题，代码结构清晰，有输入输出优化函数。
    - **重点代码简述**：定义结构体存储光线信息，通过快读函数读取数据，对光线按射入洞口编号降序排序后，处理射出洞口编号数组，利用 `lower_bound` 函数求最长不下降子序列。
    - **核心代码片段**：
```cpp
for(int i=2;i<=n;i++) f[i]=0x3f3f3f3f;
f[1]=a[1];
int ans=1;
for(int i=2;i<=n;i++){
    int j=lower_bound(f+1,f+1+ans,a[i])-f;
    if(j==ans+1) 
        f[++ans]=a[i];
    else f[j]=a[i];
}
```

### 最优关键思路或技巧
利用光线相交的特性，将问题转化为对一组数据排序后求另一组数据的最长上升（不下降）子序列问题，通过 `lower_bound` 函数优化求最长上升子序列的时间复杂度至 $O(n\log n)$。

### 可拓展之处
此类问题属于通过发现问题本质特征，转化为经典算法问题求解的类型。类似套路可用于很多看似复杂的几何或组合问题，通过找到元素间的顺序关系，转化为排序、最长子序列等经典问题求解。

### 洛谷相似题目
- [P1020 导弹拦截](https://www.luogu.com.cn/problem/P1020)
- [P1439 【模板】最长公共子序列](https://www.luogu.com.cn/problem/P1439)
- [P3957 [NOIP2017 普及组] 跳房子](https://www.luogu.com.cn/problem/P3957)

---
处理用时：45.42秒
# 题目信息

# Nastya Studies Informatics

## 题目描述

$Nastya$  了解到  $GCD(a,\ b)$  用于表示  $a$  和  $b$  的最大公约数， $LCM(a,\ b)$  用于表示  $a$  和  $b$  的最小公倍数。

给出整数  $x$  和  $y$ ，请你帮她求出当  $l \leqslant a,\ b \leqslant r$  时，有多少对  $(a,\ b)$  能同时满足  $GCD(a,\ b) = x$  且  $LCM(a,\ b) = y$ 。注意，当  $a \neq b$  时， $(a,\ b)$  和  $(b,\ a)$  是不一样的。

## 说明/提示

- 第  $1$  组样例的解释：

满足要求的  $(a,\ b)$  有  $(1,\ 2)$  和  $(2,\ 1)$ 。

- 第  $2$  组样例的解释：

满足要求的  $(a,\ b)$  有  $(1,\ 12)$ ， $(12,\ 1)$ ， $(3,\ 4)$ ， $(4,\ 3)$ 。

- 第  $3$  组样例的解释：

没有满足要求的  $(a,\ b)$ 。虽然  $(3,\ 30)$  满足  $GCD(3,\ 30) = x$  和  $LCM(3,\ 30) = y$ ，但它们都不在指定范围内。

感谢@Sooke 提供翻译

## 样例 #1

### 输入

```
1 2 1 2
```

### 输出

```
2
```

## 样例 #2

### 输入

```
1 12 1 12
```

### 输出

```
4
```

## 样例 #3

### 输入

```
50 100 3 30
```

### 输出

```
0
```

# AI分析结果

### 题目内容
Nastya了解到GCD(a, b)用于表示a和b的最大公约数，LCM(a, b)用于表示a和b的最小公倍数。

给出整数x和y，请你帮她求出当l ≤ a, b ≤ r时，有多少对(a, b)能同时满足GCD(a, b) = x且LCM(a, b) = y。注意，当a ≠ b时，(a, b)和(b, a)是不一样的。

### 说明/提示
- 第1组样例的解释：
满足要求的(a, b)有(1, 2)和(2, 1)。
- 第2组样例的解释：
满足要求的(a, b)有(1, 12)，(12, 1)，(3, 4)，(4, 3)。
- 第3组样例的解释：
没有满足要求的(a, b)。虽然(3, 30)满足GCD(3, 30) = x和LCM(3, 30) = y，但它们都不在指定范围内。

### 样例 #1
#### 输入
```
1 2 1 2
```
#### 输出
```
2
```
### 样例 #2
#### 输入
```
1 12 1 12
```
#### 输出
```
4
```
### 样例 #3
#### 输入
```
50 100 3 30
```
#### 输出
```
0
```

### 算法分类
数学

### 综合分析与结论
所有题解都基于数学性质ab = xy（a、b为所求数，x为最大公约数，y为最小公倍数）来解题。部分题解直接枚举xy的因数；部分题解设a = nx，b = mx，通过枚举n、m相关值来求解。大部分题解利用sqrt优化枚举范围，以降低时间复杂度。各题解思路相近，主要差异在代码实现细节和优化程度。

### 所选的题解
- **作者：封禁用户 (5星)**
    - **关键亮点**：思路清晰，利用ab = xy性质，通过sqrt(y)优化枚举范围，代码简洁，注释清晰，考虑多种边界情况。
    - **重点代码**：
```cpp
bool range(long long p, int q) {
    return p >= l && p <= r && q >= l && q <= r;
}
void check(long long p) {
    if(__gcd(p, x * y / p) == x && range(p, x * y / p)) {
        ans++;
    }
    return;
}
//...
for(long long i = 1 ; i * i <= y ; i++) {
    if(y % i) {
        continue;
    }
    check(i);
    if(i * i!= y) {
        check(y / i);
    }
}
```
核心实现思想：定义range函数判断数对是否在范围内，check函数判断数对是否满足GCD条件并计数。主循环枚举y的因数i，调用check函数处理i及y/i。
- **作者：追风少年σχ (4星)**
    - **关键亮点**：详细分析多种算法及优化过程，从暴力枚举到利用数论性质优化，逻辑清晰，代码简洁，注释详细。
    - **重点代码**：
```cpp
for(int i=ceil(L*1.0/x);i*x<=R&&i*i<=k;i++) {
    if(k%i!=0)continue;
    int j=k/i;
    if(gcd(i,j)==1&&j*x>=L&&j*x<=R) {
       ans++;
       if(i!=j)ans++;
    }
}
```
核心实现思想：根据i * j = k（k = y/x），枚举k的约数i，计算j，判断(i, j)是否满足gcd为1且ax、bx在范围内，满足则计数，i≠j时答案加2。

### 最优关键思路或技巧
利用ab = xy这一数学性质，通过设a = nx，b = mx进一步推导得出nm = y/x ，然后枚举y/x的因数，同时结合sqrt优化枚举范围，降低时间复杂度。

### 可拓展之处
同类型题常围绕数论中最大公约数、最小公倍数性质展开，可能结合区间范围、数的整除性等条件。类似套路是利用数论公式化简问题，通过枚举因数、质因数分解等方法求解。

### 洛谷相似题目
- P1029 [NOIP2001 普及组] 最大公约数和最小公倍数问题
- P2568 GCD
- P1890 [USACO03NOV] 智慧的奶牛The Dairy Shuffle 

---
处理用时：56.52秒
# 题目信息

# Creative Snap

## 题目描述

灭霸要摧毁复仇者们的基地！  

我们可以将复仇者的基地看成一个序列，每个位置都有可能有多个复仇者；但是每个复仇者只能占据一个位置。  
他们基地的长度刚好是$2$的整数幂，灭霸想要用最少的能量摧毁它们。他在摧毁过程中，可以选择：  
- 如果这段基地长度$\ge 2$，他可以将其分为相等长度的两半。  
- 烧掉这段基地。如果这段基地中没有复仇者，他需要消耗$A$的能量；如果有，则需要消耗$B*x*l$的能量。其中$l$是这段基地长度，$x$是这段中的复仇者数量。  

输出一个整数，表示他摧毁全部基地需要的最少能量。  
接下来一行$k$个整数，$a_i$表示第$i$个复仇者所在的位置

## 说明/提示

### 样例解释  
对于样例1，直接烧区间$[1,4]$需要能量为$4*2*2=16$。  
但是，如果将其分为$4$段，分别烧掉，所需能量只有$2+1+2+1=6$。  
可以证明没有更优的方案，所以输出`6`。 
对于全部数据：  
$1\le n \le 30$  
$1\le k \le 10^5$  
$1\le A,B \le 10^4$  
$1\le a_i \le 2^n$

## 样例 #1

### 输入

```
2 2 1 2
1 3
```

### 输出

```
6
```

## 样例 #2

### 输入

```
3 2 1 2
1 7
```

### 输出

```
8
```

# AI分析结果



### 题目内容重写
见原始中文题目描述，无需重复。

---

### 题解综合分析
本题核心是递归分治+二分统计，关键点在于快速计算区间内的复仇者数量，并通过剪枝优化减少无效递归。最优解法均采用分治策略，时间复杂度为O(k log(2^n))。

---

### 精选题解

#### 1. 作者：GKxx（★★★★☆）
**关键亮点**  
- 使用二分查找统计区间内的复仇者数量  
- 采用剪枝策略：空区间直接返回A  
- 代码简洁，可读性极佳  

**核心代码**  
```cpp
LL solve(int l, int r) {
    LL cnt = count(l, r); // 二分统计复仇者数量
    if (!cnt) return A;
    if (l == r) return B * cnt;
    int mid = (l + r) >> 1;
    return min(1ll * cnt * B * (r - l + 1), solve(l, mid) + solve(mid + 1, r));
}
```

#### 2. 作者：Engulf（★★★★☆）
**关键亮点**  
- 使用STL的二分函数简化代码  
- 递归边界处理清晰  
- 函数命名和逻辑结构直观  

**核心代码**  
```cpp
int so1ve(int l, int r) {
    int avengers = upper_bound(a+1, a+k+1, r) - lower_bound(a+1, a+k+1, l);
    if (!avengers) return A;
    if (l == r) return B * avengers;
    int mid = l + r >> 1;
    return min(B * avengers * (r-l+1), so1ve(l,mid)+so1ve(mid+1,r));
}
```

#### 3. 作者：MornStar（★★★★☆）
**关键亮点**  
- 利用预排序+二分查找优化统计效率  
- 递归逻辑与数学公式直接对应题面  
- 变量命名清晰，便于理解  

**核心代码**  
```cpp
ll find(ll l, ll r) {
    ll la=lower_bound(in,in+k+2,l)-in, ra=upper_bound(in,in+k+2,r)-in-1;
    if(ra<la) return A;
    if(l==r) return B*(ra-la+1);
    return min(B*(ra-la+1)*(r-l+1), find(l,mid)+find(mid+1,r));
}
```

---

### 关键思路总结
1. **递归分治**：每个区间选择直接烧毁或继续分割，取最小值
2. **二分统计**：利用排序后的数组，通过`lower_bound`和`upper_bound`快速计算区间内的复仇者数量
3. **剪枝优化**：空区间直接返回固定值A，避免无效递归
4. **数学建模**：将烧毁代价建模为`B*x*l`，直接与分割后的子问题解比较

---

### 拓展思考
1. **同类问题**：区间统计问题（如逆序对计数）、最优分割问题（如矩阵链乘法）
2. **优化方向**：当k极大时可采用线段树维护区间信息，但本题k≤1e5时二分法已足够高效
3. **调试技巧**：验证二分边界条件，测试空区间和满区间极端情况

---

### 推荐习题
1. [P1908 逆序对](https://www.luogu.com.cn/problem/P1908) - 分治与二分的经典应用  
2. [P1886 滑动窗口](https://www.luogu.com.cn/problem/P1886) - 区间统计的优化技巧  
3. [P1047 校门外的树](https://www.luogu.com.cn/problem/P1047) - 区间覆盖与统计问题

---
处理用时：42.61秒
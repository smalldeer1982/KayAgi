# 题目信息

# Sakurako's Test

## 题目描述

Sakurako 即将参加一场考试，这场考试可用一个整数数组 $n$ 和一个相关任务来描述：

对于给定的整数 $x$，Sakurako 可以多次执行以下操作：

- 选择一个整数 $i$，其中 $1 \le i \le n$，且满足 $a_i \ge x$；
- 将 $a_i$ 的值减少 $x$，即改为 $a_i - x$。

通过这样的操作，她需要找到数组 $a$ 的最小可能中位数 $^{\text{∗}}$。

Sakurako 已知数组的内容，但不清楚整数 $x$ 的值。不过，有人透露在接下来的考试中，$x$ 的值会是给定的 $q$ 个值之一，因此她希望你能帮忙找出每一个可能的 $x$ 所对应的最小中位数。

$^{\text{∗}}$ 对于一个长度为 $n$ 的数组，若 $n$ 是偶数，则中位数是排序后数组中第 $\frac{n+2}{2}$ 个位置的元素；若 $n$ 是奇数，则为第 $\frac{n+1}{2}$ 个位置的元素。

## 样例 #1

### 输入

```
2
5 5
1 2 3 4 5
1
2
3
4
5
6 3
1 2 6 4 1 3
2
1
5```

### 输出

```
0 1 1 1 2 
1 0 2```

# AI分析结果



【题目翻译】
# Sakurako的测试

## 题目描述

Sakurako即将参加一场考试，该考试可以用一个整数数组$a$和一个相关任务来描述：

对于给定的整数$x$，Sakurako可以多次执行以下操作：
- 选择一个下标$i$（$1 \le i \le n$）满足$a_i \ge x$；
- 将$a_i$的值减少$x$，即变为$a_i - x$。

通过这样的操作，她需要找到数组$a$的最小可能中位数$^{\text{∗}}$。

已知数组内容，但$x$的值会是给定的$q$个候选值之一。请对每个可能的$x$，计算对应的最小中位数。

$^{\text{∗}}$对于长度为$n$的数组，中位数定义为排序后第$\lceil \frac{n}{2} \rceil$个元素（即$n$为偶数时取第$\frac{n}{2}+1$个元素，奇数时取第$\frac{n+1}{2}$个元素）。

---

### 综合题解分析

所有题解均采用**二分答案+区间统计**的核心思路。核心步骤：
1. **预处理**排序数组并建立前缀和数组
2. **二分搜索**最小中位数值mid
3. **区间统计**：计算所有满足$a_i \mod x \le mid$的元素数量
4. **记忆化优化**：对相同x的查询结果进行缓存

#### 关键技巧对比

| 题解 | 亮点 | 不足 | 评分 |
|------|------|------|-----|
| 沉石鱼惊旋 | 完整的前缀和边界处理，快读优化 | 代码结构稍复杂 | ★★★★☆ |
| Super_Cube | 代码简洁高效，直接维护答案数组 | 数学推导较少 | ★★★★★ |
| liugh_ | 详细数学推导，逻辑清晰 | 代码实现不完整 | ★★★★☆ |

---

### 最优题解推荐

#### 题解2：Super_Cube（★★★★★）
**核心思路**：
```cpp
int main(){
    // 预处理前缀和数组
    for(int i=1;i<=n;++i) a[i]+=a[i-1];
    // 记忆化处理
    if(~ans[x]) { printf("%d ",ans[x]); continue; }
    // 二分答案框架
    while(l<=r){
        int mid=l+r>>1, res=0;
        // 区间跳跃式统计
        for(int i=0,j=x-1; i<=n; i+=x,j+=x)
            res += a[min(i+mid,n)] - a[max(i-1,0)];
        if(res > (n>>1)) ans[x]=mid, r=mid-1;
        else l=mid+1;
    }
}
```
**亮点**：
- 简洁的代码实现，直接使用前缀和差值统计区间
- 利用整数除法特性实现区间跳跃遍历
- 记忆化数组优化重复查询

---

### 关键思路总结

1. **二分答案框架**：将中位数问题转化为可行性判断问题，时间复杂度O(log n)
2. **模数区间分解**：利用模运算性质将$a_i \mod x$转化为区间[kx, kx+mid]
3. **前缀和加速统计**：预处理排序后的前缀和数组，实现O(1)区间查询
4. **记忆化优化**：对相同x的查询结果进行缓存，避免重复计算

---

### 拓展应用

1. **同类问题**：涉及模运算的最值问题（如CF1526C2 Potions）
2. **算法套路**：二分答案与区间统计的结合（如LeetCode 410. Split Array Largest Sum）
3. **优化思路**：跳跃式区间遍历的复杂度控制技巧

---

### 相似题目推荐

1. [P4344 SHOI2015]脑洞治疗仪 - 二分答案+区间覆盖统计
2. [P2678 跳石头] - 经典二分答案与最短间隔控制
3. [P1182 数列分段 Section II] - 二分最大段和与区间划分

---

### 调试技巧摘录

沉石鱼惊旋题解中提到：  
> "注意前缀和边界问题，特别是当kx超过数组最大值时，取min(n, r)的操作避免越界"  
说明边界处理是本题调试的关键点，需特别注意区间端点的截断处理。

---
处理用时：61.55秒
# 题目信息

# Petya and Post

## 题目描述

### 题意翻译

有 $n$ 个邮局，在每个邮局都有一个加油站。（邮局编号从 $1$ 开始）

对于第 $i$ 个邮局，$a_i$ 表示位于这个邮局加油站最多能加多少油，$b_i$ 表示它到第 $i+1$ 个邮局会耗费多少油。特殊的，对于第 $n$ 个邮局，$b_n$ 表示它到第 $1$ 个邮局会耗费多少油。

现在可以任意选择一个邮局出发，开始的油量为 $0$。可以选择顺时针或者逆时针走动，一旦决定方向就不可以回头。 要求路途上任一时刻油量$\ge 0$。

## 样例 #1

### 输入

```
4
1 7 2 3
8 1 1 3
```

### 输出

```
2
2 4
```

## 样例 #2

### 输入

```
8
1 2 1 2 1 2 1 2
2 1 2 1 2 1 2 1
```

### 输出

```
8
1 2 3 4 5 6 7 8
```

# AI分析结果

### 题目内容重写

#### Petya and Post

**题目描述**

有 $n$ 个邮局，每个邮局都有一个加油站。（邮局编号从 $1$ 开始）

对于第 $i$ 个邮局，$a_i$ 表示位于这个邮局加油站最多能加多少油，$b_i$ 表示它到第 $i+1$ 个邮局会耗费多少油。特殊的，对于第 $n$ 个邮局，$b_n$ 表示它到第 $1$ 个邮局会耗费多少油。

现在可以任意选择一个邮局出发，开始的油量为 $0$。可以选择顺时针或者逆时针走动，一旦决定方向就不可以回头。要求路途上任一时刻油量 $\ge 0$。

**样例 #1**

**输入**

```
4
1 7 2 3
8 1 1 3
```

**输出**

```
2
2 4
```

**样例 #2**

**输入**

```
8
1 2 1 2 1 2 1 2
2 1 2 1 2 1 2 1
```

**输出**

```
8
1 2 3 4 5 6 7 8
```

### 题解综合分析与结论

本题的核心在于如何在环形结构中高效地判断从每个邮局出发是否能够完成一圈，且在任何时刻油量都不为负。各题解主要围绕如何优化这一判断过程展开，常见的优化手段包括单调队列、线段树、前后缀和等。

### 精选题解

#### 题解1：作者：Fireworks_Rise (4星)

**关键亮点：**
- 使用单调队列维护前缀和的最小值，时间复杂度为 $O(n)$。
- 通过破环成链的技巧，将环形问题转化为线性问题，简化了处理。

**核心代码：**
```cpp
for(int i=1;i<=n*2;i++) s[i]+=s[i-1];
q[++tail]=n*2+1;
for(int i=n*2;i>=0;i--) {
    if(q[head]>i+n) head++;
    if(i<n&&s[i]<=s[q[head]])
        flag[i+1]=1;
    while(head<=tail&&s[q[tail]]>=s[i]) tail--;
    q[++tail]=i;
}
```

**个人心得：**
- 通过单调队列维护前缀和的最小值，避免了复杂的线段树操作，代码简洁且高效。

#### 题解2：作者：xkcdjerry (4星)

**关键亮点：**
- 通过前后缀和优化，避免了单调队列的使用，代码更加简洁。
- 详细分析了从不同点出发的油量变化规律，利用全局加和单点赋值的性质进行优化。

**核心代码：**
```cpp
for(int i=1;i<=n;i++) {
    if(query_min()>=0) ans[i]=true;
    if(i!=1) add(1,i,-c[i]);
    if(i!=n) add(i,n,-c[i]);
    set(i,val[n]);
}
```

**个人心得：**
- 通过挖掘代码的性质，将单点赋值转化为单点加，简化了全局加的操作，提升了代码的可读性和效率。

#### 题解3：作者：_edge_ (4星)

**关键亮点：**
- 使用单调队列维护前缀和的最小值，时间复杂度为 $O(n)$。
- 详细解释了如何通过破环成链的技巧将环形问题转化为线性问题，并给出了清晰的代码实现。

**核心代码：**
```cpp
while (l1<=r1 && q1[l1]<x) l1++;
while (l1<=r1 && sum1[q1[r1]]>=sum1[n+x-1]) r1--;
q1[++r1]=n+x-1;
```

**个人心得：**
- 通过单调队列维护前缀和的最小值，避免了复杂的线段树操作，代码简洁且高效。

### 最优关键思路与技巧

1. **破环成链**：将环形问题转化为线性问题，简化了处理。
2. **单调队列**：用于维护前缀和的最小值，时间复杂度为 $O(n)$，避免了复杂的线段树操作。
3. **前后缀和优化**：通过前后缀和的计算，简化了从不同点出发的油量变化规律的判断。

### 可拓展之处

- 类似的问题可以应用单调队列、线段树等数据结构进行优化。
- 破环成链的技巧可以应用于其他环形结构的问题中。

### 推荐题目

1. [P1886 滑动窗口](https://www.luogu.com.cn/problem/P1886)
2. [P3372 线段树 1](https://www.luogu.com.cn/problem/P3372)
3. [P3373 线段树 2](https://www.luogu.com.cn/problem/P3373)

### 个人心得总结

- 通过单调队列维护前缀和的最小值，避免了复杂的线段树操作，代码简洁且高效。
- 破环成链的技巧在处理环形结构问题时非常有用，可以简化问题的复杂度。

---
处理用时：43.68秒
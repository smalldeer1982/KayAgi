# 题目信息

# Points on Plane

## 题目描述

给出 $N$ 个整点 $(x_i,y_i)$，求一个排列 $p$，使得 $\sum\limits_{i=2}^N (|x_{p_i} - x_{p_{i-1}}| + |y_{p_i} - y_{p_{i-1}}|) \leq 2.5 \times 10^9$。

## 样例 #1

### 输入

```
5
0 7
8 10
3 4
5 0
9 12
```

### 输出

```
4 3 1 2 5 
```

# AI分析结果



### 题目中文翻译
**题目名称**：平面上的点  
**题目描述**  
给定 $N$ 个整点 $(x_i, y_i)$，求一个排列 $p$，使得相邻点的曼哈顿距离之和 $\sum\limits_{i=2}^N (|x_{p_i} - x_{p_{i-1}}| + |y_{p_i} - y_{p_{i-1}}|) \leq 2.5 \times 10^9$。

**样例输入**  
```
5
0 7
8 10
3 4
5 0
9 12
```
**样例输出**  
```
4 3 1 2 5 
```

---

### 综合分析与结论
本题需构造排列使得曼哈顿距离总和满足上限，核心思路是 **分块排序+奇偶性优化**。关键点如下：
1. **莫队思想**：将二维点视为一维区间查询，通过分块排序控制指针移动总距离。
2. **奇偶排序优化**：块内根据奇偶性交替升序/降序，减少跨块时的指针跳跃。
3. **分块策略**：块大小设为 $\sqrt{10^6}$ 或固定值（如1000），平衡块内和块间移动。

---

### 高星题解推荐
#### 题解1：Plozia（★★★★☆）
**关键亮点**：  
- 将点视为莫队查询，块内奇偶性控制排序方向，代码简洁高效。  
- 详细分析反例场景，说明优化必要性。  
**核心代码**：
```cpp
struct node { int l, r, id, b; };
bool cmp(const node &fir, const node &sec) {
    if (fir.b != sec.b) return fir.b < sec.b;
    return (fir.b & 1) ? fir.r < sec.r : fir.r > sec.r;
}
// 排序后输出id
```

#### 题解2：灵茶山艾府（★★★★☆）
**关键亮点**：  
- 将平面划分为 $1000 \times 1000$ 的块，蛇形遍历避免长距离跳跃。  
- 块内处理时提取极值点优化路径，降低局部移动距离。  
**核心代码**：
```go
// 按块蛇形遍历
for i := 0; i < 1001; i++ {
    if i % 2 == 1 { j方向反向处理 }
    // 块内先输出minI，再输出中间点，最后maxI
}
```

#### 题解3：喵仔牛奶（★★★★☆）
**关键亮点**：  
- 直接套用莫队奇偶排序模板，代码简洁易实现。  
- 明确将曼哈顿距离转化为指针移动分析，直观易懂。  
**核心代码**：
```cpp
struct node { int l, r, id; };
bool operator < (const node& x) const {
    if (pos[l] != pos[x.l]) return l < x.l;
    return (pos[l] & 1) ? r < x.r : r > x.r;
}
```

---

### 关键思路与技巧
1. **分块排序**：将点按 $x$ 坐标分块，块内按 $y$ 坐标排序。
2. **奇偶性优化**：奇数块 $y$ 升序，偶数块 $y$ 降序，减少跨块移动。
3. **复杂度控制**：总移动距离为 $O(n \sqrt{n})$，满足题目约束。

**代码实现示例**：
```cpp
const int BLOCK = 1000;
struct Point { int x, y, id, block; };
bool compare(const Point &a, const Point &b) {
    if (a.block != b.block) return a.block < b.block;
    return (a.block & 1) ? a.y < b.y : a.y > b.y;
}
// 排序后输出id序列
```

---

### 拓展与相似题目
1. **莫队算法基础**：[小Z的袜子](https://www.luogu.com.cn/problem/P1494)
2. **分块优化应用**：[[AHOI2013] 作业](https://www.luogu.com.cn/problem/P4396)
3. **构造类题目**：[CF525B Pasha and String](https://www.luogu.com.cn/problem/CF525B)

---

### 题解中的个人心得
- **调试教训**：需注意块大小的选择，过大或过小均可能被极端数据卡掉（如 `zac2010` 提到块长需适配坐标范围）。  
- **顿悟点**：将二维曼哈顿距离问题转化为一维指针移动问题，是莫队思想的巧妙应用（`End1essSummer` 图示清晰）。

---
处理用时：58.11秒
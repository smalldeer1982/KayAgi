# 题目信息

# Fire

## 题目描述

某人的房子着火了，他想从大火中带走价值总和尽量多的物品，每次他只能带走一个，分别给出挽救某物品需要的时间 $t$，该物品开始燃烧的时间 $d$（从 $d$ 时间开始就不能再挽救该物品了），该物品的价值 $p$。

## 样例 #1

### 输入

```
3
3 7 4
2 6 5
3 7 6
```

### 输出

```
11
2
2 3 
```

## 样例 #2

### 输入

```
2
5 6 1
3 3 5
```

### 输出

```
1
1
1 
```

# AI分析结果



# Fire

## 题目描述

某人的房子着火了，他想从大火中带走价值总和尽量多的物品，每次他只能带走一个，分别给出挽救某物品需要的时间 $t$，该物品开始燃烧的时间 $d$（从 $d$ 时间开始就不能再挽救该物品了），该物品的价值 $p$。

## 样例 #1

### 输入

```
3
3 7 4
2 6 5
3 7 6
```

### 输出

```
11
2
2 3 
```

## 样例 #2

### 输入

```
2
5 6 1
3 3 5
```

### 输出

```
1
1
1 
```

---

### 综合分析与结论

本题本质是 01 背包的变种，核心难点在于时间顺序约束和路径记录。最优解法需满足以下要点：

**关键思路**
1. **按燃烧时间排序**：将物品按 $d$ 升序排列，确保无后效性
2. **时间维度背包设计**：状态定义 $f[j]$ 表示在时间 $j$ 时的最大价值，转移时需满足 $j \leq d_i-1$
3. **路径记录优化**：使用 vector 数组动态维护物品选择路径，避免递归回溯

---

### 高星题解推荐

#### 1. IGA_Indigo（4★）
**亮点**  
- 使用滚动数组优化空间复杂度
- 通过 vector 数组直接记录物品选择路径
- 代码简洁易读，路径处理高效

**核心代码**  
```cpp
vector<int> q[2005];
for (int j = a[i].d-1; j >= a[i].t; j--) {
    if (f[j] < f[j - a[i].t] + a[i].p) {
        f[j] = f[j - a[i].t] + a[i].p;
        q[j] = q[j - a[i].t]; // 复制历史路径
        q[j].push_back(a[i].id); // 添加当前物品
    }
}
```

#### 2. Dfkuaid（4★）
**亮点**  
- 二维状态设计清晰体现决策过程
- 使用前驱数组回溯路径，逻辑严谨
- 详细分析时间顺序约束的数学原理

**路径回溯实现**  
```cpp
void Path(int k, int t) {
    if (k <= 0) return;
    Path(k-1, g[k][t]);
    if (f[k][t] != f[k-1][t]) // 判断是否选择当前物品
        list[++cnt] = k;
}
```

#### 3. Bitter_Tea（4★）
**亮点**  
- 代码实现最简洁（仅 25 行）
- 使用结构体排序处理输入数据
- 路径记录与状态转移高度融合

**关键实现片段**  
```cpp
for (int j = e[i].d-1; j >= e[i].t; j--) {
    if (f[j - e[i].t] + e[i].v > f[j]) {
        f[j] = f[j - e[i].t] + e[i].v;
        q[j] = q[j - e[i].t]; 
        q[j].push_back(e[i].id);
    }
}
```

---

### 核心技巧总结

1. **时间约束处理**  
   按物品燃烧时间排序后，逆序枚举时间（从 $d_i-1$ 到 $t_i$），确保每个物品只能在有效时间窗内被选择

2. **路径记录优化**  
   使用 vector 数组直接关联每个时间点的物品选择序列，更新时复制历史路径并追加新物品，避免递归回溯

3. **状态转移设计**  
   状态转移方程：  
   $$f[j] = \max(f[j],\ f[j-t_i] + p_i) \quad (j \leq d_i-1)$$  
   其中 $j$ 表示抢救结束时间点

---

### 扩展训练推荐

1. [P1048 采药](https://www.luogu.com.cn/problem/P1048)  
   **标签**：基础 01 背包  
   **特点**：标准背包问题，无附加约束

2. [P1417 烹调方案](https://www.luogu.com.cn/problem/P1417)  
   **标签**：带时间衰减的背包  
   **特点**：需通过排序处理物品选择优先级

3. [P2854 [USACO06DEC]Cow Roller Coaster S](https://www.luogu.com.cn/problem/P2854)  
   **标签**：二维约束背包  
   **特点**：双维度限制（时间+空间），需结构体排序处理

---
处理用时：60.28秒
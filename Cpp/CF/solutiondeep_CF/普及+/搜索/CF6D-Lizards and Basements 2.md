# 题目信息

# Lizards and Basements 2

## 题目描述

有一队人，第 $i$ 个人的血量为 $h_{i}$，你可以用火球点某个人，会对当前的人造成 $a$ 点伤害，对旁边的人造成 $b$ 点伤害。

火球不能打 $1$ 号和 $n$ 号，求最少多少发火球烧死所有人。血量为负数才算死。

## 样例 #1

### 输入

```
3 2 1
2 2 2
```

### 输出

```
3
2 2 2 ```

## 样例 #2

### 输入

```
4 3 1
1 4 1 1
```

### 输出

```
4
2 2 3 3 ```

# AI分析结果



### 题目内容整理  
题目已为中文，无需翻译。保持原题描述不变。

---

### 题解综合分析  
各题解主要采用动态规划（DP）和DFS剪枝两种思路。DP通过三维状态转移精确计算最小火球数，DFS通过剪枝减少无效搜索路径。难点在于处理相邻伤害的叠加影响及路径记录。

---

### 精选题解（评分≥4星）  

#### 1. 作者：kczno1（★★★★★）  
**关键亮点**：  
- 三维DP状态设计 `dp[i][j][k]` 表示处理到第i人时前i-1人已死，记录i-1和i的攻击次数。  
- 通过后缀最小值优化将复杂度从 $O(nu^3)$ 降至 $O(nu^2)$，显著提升效率。  
- 代码通过反向递推和路径回溯实现最优解输出。  

**核心代码思想**：  
```cpp
// 状态转移核心逻辑
rep(i,0,U-1) need[i]=i/b+1;  // 预处理所需最小次数
per(i,n,1) {
    rep(j,0,U-1) {
        int v=h[i]-j*b;  // 计算剩余血量
        rep(k,0,U-1) {
            dp[i][j][k]=k+mn[i+1][k][v<0?0:need[v]];  // 取后缀最小值
        }
    }
}
```

#### 2. 作者：Fading（★★★★）  
**关键亮点**：  
- 通过多次状态设计迭代最终确定三维DP结构，明确转移条件。  
- 处理第n号人物的边界情况时单独计算补充攻击次数。  
- 记录转移路径实现方案输出。  

**调试心得**：  
> “状态设计时发现需要同时考虑直接击杀和间接击杀，最终通过`f[i][j][k]`的三维结构解决。”  

**核心代码思想**：  
```cpp
// 转移时计算剩余血量并枚举下一状态
ll rem=(x[i]-j*b-k*a)>=0?(x[i]-j*b-k*a)/b+1:0;
for(int l=max(0LL,rem);l<=16;l++) {
    if(f[i][j][k]+l<f[i+1][k][l]) {
        f[i+1][k][l]=f[i][j][k]+l;  // 更新最小次数
    }
}
```

#### 3. 作者：小闸蟹（★★★★）  
**关键亮点**：  
- DFS剪枝策略：当前累计次数超过已知最优解时直接返回。  
- 枚举攻击次数时根据相邻单位的剩余血量动态计算上限。  
- 通过临时数组记录路径，回溯时恢复状态。  

**核心代码思想**：  
```cpp
void DFS(int Now, int Sum) {
    if(Sum >= Ans) return;  // 剪枝
    if(Now == n-1) {
        if(所有单位死亡) 更新答案;  // 边界条件检查
    }
    for(int i=0; i<=动态计算上限; i++) {
        if(攻击i次后前一个单位死亡) {
            更新血量并递归;  // 进入下一层搜索
        }
    }
}
```

---

### 关键思路总结  
1. **DP状态设计**：通过三维状态 `dp[i][j][k]` 精确跟踪前驱攻击次数，解决相邻伤害叠加问题。  
2. **后缀最小值优化**：在DP中预处理后缀最小值，避免重复计算。  
3. **DFS剪枝策略**：通过提前终止无效分支（如当前次数≥最优解）大幅减少搜索空间。  

---

### 类似题目推荐  
1. [P1156 垃圾陷阱](https://www.luogu.com.cn/problem/P1156) - 动态规划状态转移与时间处理。  
2. [P1433 吃奶酪](https://www.luogu.com.cn/problem/P1433) - DFS剪枝与路径优化。  
3. [P3956 棋盘](https://www.luogu.com.cn/problem/P3956) - 状态转移中的条件分支与代价计算。  

---

### 题解心得摘录  
- **Fading**：“多次尝试状态设计后发现需同时考虑直接和间接伤害，最终通过三维结构解决。”  
- **小闸蟹**：“动态计算攻击次数上限是剪枝的关键，否则会TLE。”  
- **kczno1**：“通过反向DP和路径回溯，能高效处理输出方案。”

---
处理用时：61.28秒
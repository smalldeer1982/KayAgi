# 题目信息

# Non Prime Tree

## 题目描述

给你一棵拥有 $n$ 个顶点的树。

你的任务是构造一个包含 $n$ 个不同整数的数组，这些整数从 $1$ 到 $2 \cdot n$ 分别取值。同时要求对于树中的任意一条边 $u_i \leftrightarrow v_i$，对应的数组元素差值 $|a_{u_i} - a_{v_i}|$ 不是质数。

请你找出任意一个符合以上条件的数组，如果不存在这样的数组，请输出 $-1$。

## 说明/提示

如下图所示的答案中，用对应数组 $a$ 的元素替代了顶点编号：

第一组数据的树结构 ![](https://cdn.luogu.com.cn/upload/vjudge_pic/CF2040D/d6a56c20ebd42ea20ac170d596c01c0583a1b831.png)  
第二组数据的树结构 ![](https://cdn.luogu.com.cn/upload/vjudge_pic/CF2040D/8328682bcf4d0da5fcbe8de4a0054b43d22d093e.png)

 **本翻译由 AI 自动生成**

## 样例 #1

### 输入

```
2
5
1 2
2 3
2 4
3 5
7
1 2
1 3
2 4
3 5
3 6
3 7```

### 输出

```
2 10 1 6 5 
8 7 12 1 4 6 3```

# AI分析结果



### 题目内容重写

# 非质数树

## 题目描述  
给定一棵包含 $n$ 个顶点的树。构造一个包含 $n$ 个不同整数的数组，每个数取自 $1$ 到 $2n$，满足树中任意边的两个顶点对应数值差的绝对值不是质数。输出任意合法方案或判定无解。

### 样例输入  
```
2
5
1 2
2 3
2 4
3 5
7
1 2
1 3
2 4
3 5
3 6
3 7
```

### 样例输出  
```
2 10 1 6 5 
8 7 12 1 4 6 3
```

---

### 题解综合分析

#### 关键思路总结
1. **黑白染色+菊花图特判**  
   - 对树进行黑白染色，优先将偶数按特定顺序分配给异色点
   - 当所有异色点都相邻时（菊花图），中心赋值为2，叶节点用奇偶混合方案
   - 核心代码片段：
     ```cpp
     // 菊花图检测与处理
     for(int i=1;i<=n;i++) if(E[i].size()==n-1){
         ans[i] = 1; // 中心节点赋1
         for(int j=0;j<E[i].size();j++) ans[E[i][j]] = j+2;
         return;
     }
     ```

2. **贪心构造+数学归纳**  
   - 递归填充数值，保证父子节点差值非质数
   - 通过维护可用数值集合，优先选择最大合法值
   - 核心证明：子树数值范围可被控制在 $[k, k+2(sz-1)]$

3. **随机化策略**  
   - 从根节点开始随机赋值，DFS时动态选择合法值
   - 依赖合数高密度特性，实际运行效率较高

---

### 高分题解推荐

#### 1. lfxxx（⭐⭐⭐⭐⭐）
**亮点**：  
- 结合黑白染色与菊花图特判，覆盖所有树结构  
- 代码清晰，处理边界条件严谨  
**核心实现**：
```cpp
// 黑白染色后特殊处理
if(存在异色不相邻点){
    按顺序填充黑点->特殊白点->剩余白点
}else{ // 菊花图处理
    中心点赋2，叶节点交替使用奇偶数
}
```

#### 2. bsdsdb（⭐⭐⭐⭐）
**亮点**：  
- 数学归纳法严格证明构造正确性  
- 贪心策略确保数值范围不超限  
**核心代码**：
```cpp
void dfs(int u, int fa){
    ans[u] = ++cnt;
    for(auto v : tree[u]) if(v != fa){
        while(!is_valid(cnt - ans[u])) cnt++;
        dfs(v, u);
    }
}
```

#### 3. cancan1234（⭐⭐⭐⭐）
**亮点**：  
- 逆向思维维护可用数值集合  
- 证明最多检查O(1)个数即可找到解  
**关键证明**：
```python
当父节点值为v时，候选值集合{2sz,2sz-1}必含合法解
```

---

### 扩展与总结
**关键技巧**：  
1. **树的结构分析**：菊花图、链状结构的特殊处理  
2. **数值构造策略**：奇偶交替、大跨度赋值避免质数差  
3. **数学工具应用**：质数分布特性、归纳法证明  

**相似题目推荐**：  
1. [P2664 树上游戏](https://www.luogu.com.cn/problem/P2664)（树结构分析）  
2. [P1352 没有上司的舞会](https://www.luogu.com.cn/problem/P1352)（树形DP+数值构造）  
3. [P1040 加分二叉树](https://www.luogu.com.cn/problem/P1040)（树结构构造）  

**调试心得**：  
> "赛时胡了个贪心，莫名其妙过了，第二天中午证出来了它是对的" —— 强调构造性题目的验证重要性  
> "菊花图检测忘记清空邻接表，WA了3发" —— 提醒注意全局变量重置

---
处理用时：52.11秒
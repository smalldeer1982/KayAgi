# 题目信息

# Non Prime Tree

## 题目描述

给你一棵拥有 $n$ 个顶点的树。

你的任务是构造一个包含 $n$ 个不同整数的数组，这些整数从 $1$ 到 $2 \cdot n$ 分别取值。同时要求对于树中的任意一条边 $u_i \leftrightarrow v_i$，对应的数组元素差值 $|a_{u_i} - a_{v_i}|$ 不是质数。

请你找出任意一个符合以上条件的数组，如果不存在这样的数组，请输出 $-1$。

## 说明/提示

如下图所示的答案中，用对应数组 $a$ 的元素替代了顶点编号：

第一组数据的树结构 ![](https://cdn.luogu.com.cn/upload/vjudge_pic/CF2040D/d6a56c20ebd42ea20ac170d596c01c0583a1b831.png)  
第二组数据的树结构 ![](https://cdn.luogu.com.cn/upload/vjudge_pic/CF2040D/8328682bcf4d0da5fcbe8de4a0054b43d22d093e.png)

 **本翻译由 AI 自动生成**

## 样例 #1

### 输入

```
2
5
1 2
2 3
2 4
3 5
7
1 2
1 3
2 4
3 5
3 6
3 7```

### 输出

```
2 10 1 6 5 
8 7 12 1 4 6 3```

# AI分析结果

### 题目翻译
#### 非质数树

#### 题目描述
给你一棵拥有 $n$ 个顶点的树。

你的任务是构造一个包含 $n$ 个不同整数的数组，这些整数从 $1$ 到 $2 \cdot n$ 分别取值。同时要求对于树中的任意一条边 $u_i \leftrightarrow v_i$，对应的数组元素差值 $|a_{u_i} - a_{v_i}|$ 不是质数。

请你找出任意一个符合以上条件的数组，如果不存在这样的数组，请输出 $-1$。

#### 说明/提示
如下图所示的答案中，用对应数组 $a$ 的元素替代了顶点编号：

第一组数据的树结构![](https://cdn.luogu.com.cn/upload/vjudge_pic/CF2040D/d6a56c20ebd42ea20ac170d596c01c0583a1b831.png)  
第二组数据的树结构![](https://cdn.luogu.com.cn/upload/vjudge_pic/CF2040D/8328682bcf4d0da5fcbe8de4a0054b43d22d093e.png)

 **本翻译由 AI 自动生成**

#### 样例 #1
##### 输入
```
2
5
1 2
2 3
2 4
3 5
7
1 2
1 3
2 4
3 5
3 6
3 7
```

##### 输出
```
2 10 1 6 5 
8 7 12 1 4 6 3
```

### 综合分析与结论
这些题解的核心目标都是为树的每个节点分配 $1$ 到 $2n$ 之间的不同整数，使相邻节点的数值差不是质数。各题解思路和方法多样，主要有黑白染色、按深度分类、贪心构造、随机化等。

|作者|思路|算法要点|解决难点|评分|
| ---- | ---- | ---- | ---- | ---- |
|lfxxx|对树黑白染色，分存在不相邻异色点和不存在两种情况处理|黑白染色，根据不同情况赋值|处理菊花图和不相邻异色点的赋值|4星|
|naromil|按深度分类，根据深度不同调整赋值顺序|按深度分类，对不同深度情况分类讨论|处理不同深度下的赋值顺序|4星|
|bsdsdb|递归构造，保证子树权值范围|递归遍历，选择合法权值|证明权值落在 $[1, 2n]$ 内|4星|
|cancan1234|贪心构造，维护未用数集合|贪心选择合法权值|证明贪心的正确性|3星|
|BigSmall_En|归纳证明构造方案的可行性|归纳证明，合理赋值|证明构造方案满足条件|3星|
|OoXiao_QioO|随机化填数|预处理素数表，随机填数|随机填数的效率和正确性|2星|
|hgcnxn|与 lfxxx 思路相同，更详细|黑白染色，处理菊花图|详细处理菊花图的赋值|4星|
|tian720|分层并按 bfs 序赋值，调整最后一个点权|分层，bfs 序赋值，调整点权|处理最后一条边点权差为 2 的情况|3星|
|wmrqwq|解法一随机权值，解法二构造差为 1 和 4、6、8... 的形式|随机或构造赋值|证明构造权值不超过 $2n$|3星|
|xiaoyang222|从一点向下遍历，找最小合法数赋值|遍历找合法数|证明计数器不超过 $2n$|3星|

### 所选题解
- **lfxxx（4星）**
    - **关键亮点**：思路清晰，通过黑白染色和分类讨论解决问题，代码实现较为简洁。
    - **核心代码**：
```cpp
void dfs(int u,int cl,int lst){
    vec[cl].push_back(u);
    col[u]=cl;
    for(int v:E[u]){
        if(v!=lst) dfs(v,cl^1,u);
    }
}
```
核心实现思想：对树进行黑白染色，将节点按颜色分类存储。

- **naromil（4星）**
    - **关键亮点**：按深度分类讨论，逻辑清晰，能有效处理不同深度的树。
    - **核心代码**：
```cpp
void dfs(int u,int b){
    rot=u;
    dep[u]=dep[b]+1;
    for(auto v: c[u]){
        if(b==v) continue;
        dfs(v,u);
    }
}
```
核心实现思想：通过深度优先搜索计算节点深度，为后续按深度分类赋值做准备。

- **bsdsdb（4星）**
    - **关键亮点**：递归构造权值，通过数学证明保证权值范围，思路严谨。
    - **核心代码**：
```cpp
void srh(ll x, ll pr) {
    ans[x] = st++;
    for (ll i : e[x]) {
        if (i == pr) {
            continue;
        }
        while (st - ans[x]!= 1 && (((st - ans[x]) & 1) || st - ans[x] == 2)) {
            ++st;
        }
        srh(i, x);
    }
}
```
核心实现思想：递归遍历树，为每个节点选择合法的权值。

### 最优关键思路或技巧
- 利用偶数差不是质数的特性，优先使用偶数赋值，避免相邻节点差值为质数。
- 对树进行黑白染色或按深度分类，根据不同情况调整赋值顺序，解决特殊情况。
- 贪心或递归构造权值，通过数学证明保证权值落在 $[1, 2n]$ 内。

### 拓展思路
同类型题可能会改变树的结构或权值范围，类似算法套路可用于解决其他图的节点赋值问题，关键在于找到合适的赋值规则并证明其可行性。

### 推荐题目
- [P1330 封锁阳光大学](https://www.luogu.com.cn/problem/P1330)：涉及图的染色问题。
- [P1131 [ZJOI2007] 时态同步](https://www.luogu.com.cn/problem/P1131)：树的深度和路径相关问题。
- [P1273 有线电视网](https://www.luogu.com.cn/problem/P1273)：树的动态规划问题，可锻炼树的遍历和处理能力。

### 个人心得摘录与总结
- **wmrqwq**：赛时 10min 想出正解，但因数组名写错调试 15min。总结为编码时要仔细，避免低级错误。
- **cancan1234**：赛时贪心过题，第二天证明正确性。说明可先大胆尝试贪心思路，后续再严谨证明。 

---
处理用时：46.82秒
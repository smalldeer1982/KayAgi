# 题目信息

# Same Count One

## 题目描述

给定 $n$ 个长度为 $m$ 的，只包含 $0$ 和 $1$ 的数组，选择任意两个数组交换位置 $pos$ 上的数。在经过最少的操作后使得每个数组中的 $1$ 数量相等，并输出操作过程。

## 样例 #1

### 输入

```
3
3 4
1 1 1 0
0 0 1 0
1 0 0 1
4 3
1 0 0
0 1 1
0 0 1
0 0 0
2 2
0 0
0 1```

### 输出

```
1
2 1 1
1
4 2 2
-1```

# AI分析结果



### 题目内容重写

#### 题目描述

给定 $n$ 个长度为 $m$ 的只包含 $0$ 和 $1$ 的数组，选择任意两个数组交换某一位置上的数。要求用最少的操作次数使得每个数组中的 $1$ 的数量相等，并输出操作过程。若无法达成则输出 `-1`。

#### 输入格式

输入包含多组测试数据。每组数据第一行为两个整数 $n$ 和 $m$，接下来 $n$ 行每行 $m$ 个整数表示数组内容。

#### 输出格式

对于每组数据，若存在解，第一行输出操作次数 $k$，接下来 $k$ 行每行输出三个整数 $x, y, pos$，表示交换第 $x$ 和第 $y$ 个数组的第 $pos$ 位。若无解输出 `-1`。

---

### 题解分析与结论

#### 关键思路总结
1. **可行性判断**：若所有数组中 $1$ 的总数 $sum$ 不是 $n$ 的倍数，直接输出 `-1`。
2. **贪心策略**：逐列处理，每次交换将多余的 $1$ 从超过平均值的数组转移到不足的数组。
3. **动态维护**：维护每个数组的当前 $1$ 的数量（`cnt` 数组），并在交换后更新对应数组的值，确保后续操作正确性。
4. **双指针优化**：通过排序和双指针配对需要增减的数组，减少无效遍历。

#### 最优解法代码片段
以 **WaterSun 的代码**为例，核心实现如下：
```cpp
int num = 0;
n = read(), m = read();
bool vis[n + 10][m + 10]; // 维护数组当前值
vector<answer> ans;
for (int i = 1; i <= n; i++) {
    cnt[i] = 0;
    for (int j = 1; j <= m; j++) {
        int x = read();
        vis[i][j] = x; // 记录初始值
        cnt[i] += x;
        num += x;
    }
}
if (num % n) { puts("-1"); return; }
num /= n;

// 排序并配对处理
sort(del + 1, del + n + 1);
for (int i = 1, j = n; i < j;) {
    int p = del[i].snd, q = del[j].snd;
    for (int k = 1; k <= m; k++) {
        if (!vis[p][k] && vis[q][k]) { // 当前值判断
            swap(vis[p][k], vis[q][k]); // 更新数组值
            cnt[p]++, cnt[q]--;
            ans.push_back({p, q, k});
        }
    }
    // 更新指针
    if (cnt[p] == num) i++;
    if (cnt[q] == num) j--;
}
```

#### 评分较高的题解

1. **WaterSun（4星）**
   - **亮点**：通过排序和双指针高效配对，维护 `vis` 数组确保值正确性。
   - **代码可读性**：结构清晰，变量命名合理，注释明确。

2. **VinstaG173（4星）**
   - **亮点**：显式更新数组值，按列贪心处理，时间复杂度严格 $O(nm)$。
   - **关键代码**：
     ```cpp
     a[duo[idx] * m + i] = 0; // 更新数组值
     a[shao[idx] * m + i] = 1;
     ```

3. **Dream_weavers（3.5星）**
   - **亮点**：简洁的逐列处理逻辑，但未显式更新数组值，可能在极端情况下出错。

---

### 拓展与同类题目

1. **同类型技巧**：贪心匹配、动态维护状态、双指针优化。
2. **推荐题目**：
   - [P1968 均分数据](https://www.luogu.com.cn/problem/P1968)：类似均分思想。
   - [CF1490G Old Floppy Drive](https://www.luogu.com.cn/problem/CF1490G)：双指针与贪心结合。
   - [P2512 [HAOI2008]糖果传递](https://www.luogu.com.cn/problem/P2512)：环形均分问题。

---
处理用时：162.27秒
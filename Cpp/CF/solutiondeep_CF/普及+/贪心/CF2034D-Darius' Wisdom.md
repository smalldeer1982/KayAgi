# 题目信息

# Darius' Wisdom

## 题目描述

大流士一世正在建造 $ n $ 根石柱，每根石柱由一个底座和不超过两个铭文块构成。

在每次操作中，大流士可以选择两根石柱 $ u $ 和 $ v $，只要这两根石柱的铭文数量差恰好为 $ 1 $，就可以将一个铭文从较多的一根转移到较少的一根。可以保证至少有一根石柱含有正好 $ 1 $ 个铭文。

为使得石柱看起来更美观，大流士希望这些石柱的铭文数量按不减顺序排列。为了减少工人们的辛劳，他希望你制定一个操作序列，最多使用 $ n $ 次操作实现这一目标，不需要优化操作次数。

## 说明/提示

以下是几个测试用例的样例状态：

- 第一个测试用例：
  - 初始状态：$ 0, 2, 0, 1 $
  - 第一次操作后：$ 0, 1, 0, 2 $
  - 第二次操作后：$ 0, 0, 1, 2 $

- 第二个测试用例：
  - 初始状态：$ 1, 2, 0 $
  - 第一次操作后：$ 0, 2, 1 $
  - 第二次操作后：$ 0, 1, 2 $

- 在第三个测试用例中，石柱的铭文数量已经是按升序排列的。

 **本翻译由 AI 自动生成**

## 样例 #1

### 输入

```
3
4
0 2 0 1
3
1 2 0
6
0 1 1 2 2 2```

### 输出

```
2
2 4
2 3
2
3 1
2 3
0```

# AI分析结果



# Darius' Wisdom 的题解分析

## 题目重述
大流士一世建造了 $n$ 根石柱，每根石柱的铭文块数不超过两个。每次操作可选择两根铭文数相差 $1$ 的石柱，转移一个铭文。要求通过最多 $n$ 次操作使所有石柱的铭文数量非递减排列。

---

## 综合题解分析

### 最优题解（作者：__little__Cabbage__）
**评分：★★★★☆**  
**关键亮点：**
1. **分类讨论与贪心策略**：根据 $0$ 和 $2$ 的数量关系分情况处理，优先归位 $0$ 或 $2$，再处理剩余元素。
2. **时间复杂度 $O(n)$**：通过线性扫描和双指针调整，避免复杂数据结构操作。
3. **数学证明操作次数上界**：利用统计值 $c_0, c_1, c_2$ 推导操作次数不超过 $n$。

**核心代码实现思路：**
1. 统计 $0/1/2$ 的出现次数 $c_0, c_1, c_2$。
2. **当 $c_0 \le c_2$ 时**：
   - 将前 $c_0$ 个位置中的 $1$ 和 $2$ 与后续的 $0$ 交换。
   - 处理 $2$ 的情况需两次交换（先换为 $1$，再换为 $0$）。
   - 最后用双指针交换剩余的 $1$ 和 $2$。
3. **当 $c_0 > c_2$ 时**：类似逻辑反向处理 $2$ 的位置。

**关键代码片段：**
```cpp
if (c0 <= c2) {
    // 处理前 c0 个位置中的非法元素
    int j = c0 + 1;
    for (int i = 1; i <= c0; ++i) {
        while (a[j] != 0) ++j;
        if (a[i] == 1) opt(i, j);
    }
    // 处理 2 需要两次交换
    int p = -1;
    for (int i = c0 + 1; i <= n; ++i) 
        if (a[i] == 1) p = i;
    for (int i = 1; i <= c0; ++i) {
        if (a[i] == 2) {
            opt(i, p);   // 换为 1
            opt(i, j);   // 换为 0
            p = j;
        }
    }
    // 双指针处理剩余 1 和 2
    int i = c0 + 1, j = c0 + c1 + 1;
    while (i < c0 + c1 + 1 && j <= n) {
        if (a[i] == 2 && a[j] == 1) opt(i, j);
        // 移动指针...
    }
}
```

---

## 关键思路总结
1. **统计与分类**：根据元素分布分情况处理，优先固定数量较少的元素（$0$ 或 $2$）。
2. **双阶段调整**：第一阶段归位特定元素（如 $0$），第二阶段处理剩余元素（如 $1$ 和 $2$）。
3. **操作次数控制**：通过数学分析证明操作次数的上界，保证不超过 $n$。

---

## 类似题目推荐
1. **P1090 [NOIP2004 提高组] 合并果子**  
   - 贪心策略：每次合并最小两堆，用优先队列实现。
2. **P1177 【模板】快速排序**  
   - 分治思想：通过交换操作将元素归位。
3. **P1607 [USACO09FEB] Fair Shuttle G**  
   - 区间调度：通过贪心选择最优交换顺序。

---
处理用时：45.37秒
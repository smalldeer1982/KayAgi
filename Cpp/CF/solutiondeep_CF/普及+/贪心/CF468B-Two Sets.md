# 题目信息

# Two Sets

## 题目描述

> 给出 $n$ 个各不相同的数字，将它们分别放入 $A$ 和 $B$ 两个集合中，使它们满足：
> * 若数字 $x$ 在集合 $A$ 中，那么数字 $a-x$ 也在集合 $A$ 中；
> * 若数字 $x$ 在集合 $B$ 中，那么数字 $b-x$ 也在集合 $B$ 中。

## 样例 #1

### 输入

```
4 5 9
2 3 4 5
```

### 输出

```
YES
0 0 1 1
```

## 样例 #2

### 输入

```
3 3 4
1 2 4
```

### 输出

```
NO
```

# AI分析结果



# 题目中文翻译

## 题目描述

> 给出 $n$ 个各不相同的数字，将它们分别放入 $A$ 和 $B$ 两个集合中，使它们满足：
> * 若数字 $x$ 在集合 $A$ 中，那么数字 $a-x$ 也在集合 $A$ 中；
> * 若数字 $x$ 在集合 $B$ 中，那么数字 $b-x$ 也在集合 $B$ 中。

---

# 题解分析与结论

### 核心难点
1. **双向依赖关系**：每个元素的选择会强制其配对元素（a-x 或 b-x）进入同一集合
2. **冲突检测**：当元素同时满足两种配对条件时需保证逻辑一致性
3. **动态分组**：需要维护元素间复杂的关联关系

### 最优思路总结
**并查集+虚节点法**：
1. 用并查集维护元素间必须同组的关系
2. 引入两个虚节点分别表示必须属于A/B集合的情况
3. 通过最终检查虚节点的连通性判断可行性

---

# 高分题解精选

## 1. 作者：D_14134（★★★★☆）
**关键亮点**：
- 利用并查集统一处理强制配对关系
- 通过虚节点0和n+1表示必须属于B/A集合的边界条件
- 代码简洁高效（时间复杂度O(nα(n))）

**核心代码**：
```cpp
int main() {
    // 初始化并查集和哈希表
    for(int i=1;i<=n;i++){
        if(pre[a-val[i]]>0) hb(i,pre[a-val[i]]);
        else hb(i,n+1); // 无法满足A条件则连到虚节点n+1
        if(pre[b-val[i]]>0) hb(i,pre[b-val[i]]);
        else hb(i,0);   // 无法满足B条件则连到虚节点0
    }
    // 检查两个虚节点是否连通
    if(find(0) != find(n+1)) {
        // 根据连通性输出答案
    }
}
```

## 2. 作者：滑不拉稽（★★★★☆）
**关键亮点**：
- 清晰的边界条件处理
- 使用merge操作统一管理集合关系
- 通过预处理最大值的优化剪枝

**个人心得**：
> "并查集初始化中，将i=0与i=n+1也初始化。其中与0并在一起的默认为A集合，与n+1并在一起的默认为B集合"

**核心实现**：
```cpp
void solve() {
    for(int i=1;i<=n;++i) {
        if(pre[a-val[i]]) merge(i,pre[a-val[i]]);
        else merge(i,0);  // 无法满足A条件则归为B集合
        if(pre[b-val[i]]) merge(i,pre[b-val[i]]);
        else merge(i,n+1);// 无法满足B条件则归为A集合
    }
}
```

## 3. 作者：UnyieldingTrilobite（★★★☆☆）
**创新点**：
- 使用unordered_map优化查找效率
- 显式维护集合大小优化并查集
- 输出时的位运算简化

---

# 关键技巧总结
1. **虚节点技巧**：通过创建特殊节点表示集合的强制归属条件
2. **双向绑定**：当x必须与a-x同组时，建立双向的并查集连接
3. **冲突检测**：最终检查代表不同集合的虚节点是否连通来判断可行性
4. **预处理剪枝**：通过提前判断max(val)与max(a,b)的关系排除无解情况

---

# 拓展练习
1. [P1892 团伙](https://www.luogu.com.cn/problem/P1892) - 并查集处理敌对关系
2. [P4782 2-SAT问题](https://www.luogu.com.cn/problem/P4782) - 类似逻辑约束的建模
3. [P1525 关押罪犯](https://www.luogu.com.cn/problem/P1525) - 二分答案+并查集分组

---
处理用时：67.54秒
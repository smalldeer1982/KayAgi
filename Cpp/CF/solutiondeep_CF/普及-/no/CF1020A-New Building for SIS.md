# 题目信息

# New Building for SIS

## 题目描述

你正在研究夏季信息学院新建筑的楼层设计。因为你担任着英国秘密情报局的后勤物流任务，所以你十分在乎去往不同位置的路程耗时：了解从演讲室到食堂，或者从健身房到服务器机房的耗时是很重要的。



这个建筑由 $n$ 个塔楼组成，标号为 $1 - n$ ；每个塔楼有 $h$ 层，标号为 $1 - h$ 。任意两个相邻的塔楼间有一条通道（当 $1 \le i \le n - 1$ 时，塔楼 $i$ 与 $i - 1$ 相连）。在第 $x ( a \le x \le b)$ 层上，你可以在与第 $x$ 层相邻的2层移动，或如果第 $x$ 层与相邻的塔楼有通道连通也可移动至其上。离开建筑是不被允许的。



![img](https://cdn.luogu.com.cn/upload/vjudge_pic/CF1020A/f837e8e8bdf323146303fdec0eaae175f05c2066.png)



这个图片解释了 **输入 #1**



你将被给予 $k$ 对位置 $(t_a, f_a), (t_b, f_b)$ ：代表塔楼 $t_a$ 上的第 $f_a$ 层，塔楼  $t_b$ 上的第 $f_b$ 层。



对于每一对位置，你需要确定它们之间的最短耗时。

## 样例 #1

### 输入

```
3 6 2 3 3
1 2 1 3
1 4 3 4
1 2 2 3
```

### 输出

```
1
4
2
```

# AI分析结果



# New Building for SIS

## 题目描述

你正在研究夏季信息学院新建筑的楼层设计。由于你负责英国秘密情报局的后勤物流，因此了解不同位置间的移动耗时非常重要。

该建筑由 $n$ 个塔楼（编号 $1$ 到 $n$）组成，每个塔楼有 $h$ 层（编号 $1$ 到 $h$）。相邻塔楼之间在 $a$ 到 $b$ 层（含）设有通道。移动规则：
1. 在通道层（$a \le x \le b$）可水平移动到相邻塔楼
2. 在任何楼层可垂直移动相邻楼层

给定 $k$ 对位置 $(t_a, f_a)$ 和 $(t_b, f_b)$，求每对位置间的最短移动步数。

## 输入样例

```
3 6 2 3 3
1 2 1 3
1 4 3 4
1 2 2 3
```

## 输出样例

```
1
4
2
```

**算法分类**：模拟

---

### 题解综合分析

各题解核心思路一致：通过分类讨论处理垂直移动与水平移动的衔接。关键点在于：
1. 同塔楼直接计算垂直距离
2. 跨塔楼时，先将起点调整到最近的通道层（a或b层），再水平移动，最后调整到目标楼层

#### 最优题解亮点

1. **saixingzhe（5星）**
   - 代码最简洁，直接分三类处理跨塔楼情况
   - 公式推导清晰：总步数 = 垂直调整 + 水平移动 + 最终垂直调整
   - 示例代码：
```cpp
if(ta==tb) cout<<abs(fa-fb)<<'\n';
else {
    if(fa<a) cout<<a-fa+abs(ta-tb)+abs(a-fb)<<'\n';
    else if(fa>b) cout<<fa-b+abs(ta-tb)+abs(b-fb)<<'\n';
    else cout<<abs(fa-fb)+abs(ta-tb)<<'\n'; 
}
```

2. **_SkyLine_（4星）**
   - 详细注释说明各情况计算逻辑
   - 使用层叠式条件判断，可读性佳
   - 示例代码：
```cpp
if(ta==tb)
    cout<<abs(fa-fb)<<endl;
else {
    if(fa>b)
        cout<<fa-b+abs(ta-tb)+abs(b-fb)<<endl;
    else if(fa<a)
        cout<<a-fa+abs(ta-tb)+abs(a-fb)<<endl;
    else
        cout<<abs(fa-fb)+abs(ta-tb)<<endl; 
}
```

3. **Speech_less（4星）**
   - 数学公式表达完整，解释各情况的计算原理
   - 包含对最优路径选择的证明
   - 示例代码：
```cpp
if(ta==tb) sum=abs(fa-fb);
else {
    if(fa<a) sum=abs(ta-tb)+abs(fb-a)+(a-fa);
    else if(fa>b) sum=abs(ta-tb)+abs(fb-b)+(fa-b);
    else sum=abs(ta-tb)+abs(fa-fb);
}
```

---

### 关键思路总结

1. **通道层衔接策略**：跨塔移动必须经过通道层，选择最近通道层（a或b）能保证路径最短
2. **分治思想**：将问题分解为垂直移动和水平移动两个阶段处理
3. **数学优化**：直接通过绝对值计算距离，避免复杂路径枚举

---

### 同类题目推荐

1. [P1003 铺地毯](https://www.luogu.com.cn/problem/P1003) - 二维区域覆盖判断
2. [P1056 排座椅](https://www.luogu.com.cn/problem/P1056) - 通道选择优化
3. [P1062 简化路径](https://www.luogu.com.cn/problem/CF1C) - 路径规范化处理

---

### 调试心得摘录

1. **Speech_less**：通过数学证明通道层选择的最优性，避免陷入路径枚举的误区
2. **sjr3065335594**：强调当起点在通道层下方时，必须调整到a层才能保证后续最优
3. **Trilliverse**：建议先处理同塔楼特例，再处理跨塔楼的一般情况，简化逻辑分支

---
处理用时：46.54秒
# 题目信息

# Accordion

## 题目描述

题意简述

给出一个字符串，试在其中删除一些字符，使得最后的串变为满足以下条件的串且长度最大：

长度大于等于$4$；第一个字符为$'['$；最后一个字符为$']'$；第二个字符和倒数第二个字符为$':'$；其余字符全部为$'|'$．

## 样例 #1

### 输入

```
|[a:b:|]
```

### 输出

```
4
```

## 样例 #2

### 输入

```
|]:[|:]
```

### 输出

```
-1
```

# AI分析结果



### 题目重写
**题目名称：手风琴**

**题目描述**  
给定一个字符串，要求通过删除部分字符，使其满足以下条件且长度最大：  
1. 长度 ≥4  
2. 首字符为 `[`，尾字符为 `]`  
3. 第二个字符和倒数第二个字符为 `:`  
4. 其余字符全为 `|`  

若无法构造符合条件的字符串，输出 `-1`。

**输入样例 #1**  
```
|[a:b:|]
```
**输出样例 #1**  
```
4
```

**输入样例 #2**  
```
|]:[|:]
```
**输出样例 #2**  
```
-1
```

**算法分类**  
字符串、模拟  

---

### 题解综合分析

#### 核心思路
所有题解均基于**贪心策略**，分步骤定位关键字符：  
1. 找到最左侧的 `[` 和最右侧的 `]`  
2. 在 `[` 右侧找第一个 `:`，在 `]` 左侧找最后一个 `:`  
3. 统计两个 `:` 之间的 `|` 数量，加上固定结构的 4 个字符即为答案  

#### 关键优化点
- 通过**多轮线性扫描**确保结构合法性  
- 利用**反向查找**快速定位右侧字符  
- 提前判断非法情况减少无效计算  

---

### 精选题解

#### 1. zhy12138 的题解（⭐⭐⭐⭐⭐）  
**亮点**  
- 代码结构清晰，通过多个循环逐步定位关键字符  
- 变量命名直观（`l, r, bj` 等）  
- 边界处理完整（`l >= r` 时直接返回-1）  

**核心代码**  
```cpp
for(register int i=0;i<len;++i)
    if(s[i]=='[') { l=i; break; }
for(register int i=len-1;i>=0;--i)
    if(s[i]==']') { r=i; break; }
if(l>=r) { puts("-1"); return 0; }
```

#### 2. HoshizoraZ 的题解（⭐⭐⭐⭐）  
**亮点**  
- 使用**反向字符串**简化右侧字符定位  
- 逻辑紧凑，减少变量数量  
- 注释明确，便于理解索引转换  

**核心代码**  
```cpp
s2 = s; reverse(s.begin(), s.end()); swap(s, s2);
int l = s.find('['), r = len - s2.find(']') - 1;
if(l > r) return puts("-1"), 0;
```

#### 3. Micnation_AFO 的题解（⭐⭐⭐⭐）  
**亮点**  
- 使用双端队列动态维护字符范围  
- 分阶段处理结构，逻辑层次分明  
- 代码注释详细，可维护性强  

**核心代码**  
```cpp
while (!q.empty() && q.front() != '[') q.pop_front();
while (!q.empty() && q.back() != ']') q.pop_back();
if(q.size() < 4) { cout << -1; return 0; }
```

---

### 关键技巧总结
1. **分层验证结构**：先确定外层 `[]`，再处理内层 `::`  
2. **贪心定位**：尽可能保留最左 `[` 和最右 `]` 以最大化中间字符  
3. **索引转换**：通过反转字符串快速定位右侧字符  

---

### 拓展练习
1. [CF1178B](https://www.luogu.com.cn/problem/CF1178B) - 类似结构匹配问题  
2. [P1142](https://www.luogu.com.cn/problem/P1142) - 字符串模式构造  
3. [P1739](https://www.luogu.com.cn/problem/P1739) - 括号匹配与结构验证

---
处理用时：55.36秒
# 题目信息

# Funny Permutation

## 题目描述

如果一个长度为 $n$ 的数列满足恰好包含 $1$ 到 $n$ 的整数各一个，则我们称之为排列。例如，$[3,1,4,2]$、$[1]$ 和 $[2,1]$ 都是排列，但是 $[1,2,1]$、$[0,1]$ 和 $[1,3,4]$ 都不是。

给你一个 $n$，你需要构造一个长度为 $n$ 的排列 $p$，使得它同时满足以下两个要求：

1. $\forall 1 \leq i \leq n$，都至少有一个邻居（$p_i$ 的邻居为 $p_{i + 1}$ 和 $p_{i - 1}$），使其值为 $p_i + 1$ 或 $p_i - 1$。

2. $\forall 1 \leq i \leq n$，都有 $p_i \ne i$。

我们称同时符合以上两个要求的排列为“有趣的排列”。

例如，当 $n = 4$ 时，$[4,3,1,2]$ 是一个“有趣的排列”，因为：

* $p_2 = p_1 - 1 = 4 - 1 = 3$；
* $p_1 = p_2 + 1 = 3 + 1 = 4$；
* $p_4 = p_3 + 1 = 1 + 1 = 2$；
* $p_3 = p_4 - 1 = 2 - 1 = 1$；
* $\forall 1 \leq i \leq n$，都有 $p_i \ne i$。

给定一个 $n$，你需要构造出一个长度为 $n$ 的“有趣的排列”，或者输出一个 $-1$ 来表明不存在长度为 $n$ 的“有趣的排列”。

## 样例 #1

### 输入

```
5
4
3
7
5
2```

### 输出

```
3 4 2 1
-1
6 7 4 5 3 2 1
5 4 1 2 3
2 1```

# AI分析结果

### 题目内容
# 有趣的排列

## 题目描述
如果一个长度为 $n$ 的数列满足恰好包含 $1$ 到 $n$ 的整数各一个，则我们称之为排列。例如，$[3,1,4,2]$、$[1]$ 和 $[2,1]$ 都是排列，但是 $[1,2,1]$、$[0,1]$ 和 $[1,3,4]$ 都不是。

给你一个 $n$，你需要构造一个长度为 $n$ 的排列 $p$，使得它同时满足以下两个要求：
1. $\forall 1 \leq i \leq n$，都至少有一个邻居（$p_i$ 的邻居为 $p_{i + 1}$ 和 $p_{i - 1}$），使其值为 $p_i + 1$ 或 $p_i - 1$。
2. $\forall 1 \leq i \leq n$，都有 $p_i \ne i$。

我们称同时符合以上两个要求的排列为“有趣的排列”。

例如，当 $n = 4$ 时，$[4,3,1,2]$ 是一个“有趣的排列”，因为：
* $p_2 = p_1 - 1 = 4 - 1 = 3$；
* $p_1 = p_2 + 1 = 3 + 1 = 4$；
* $p_4 = p_3 + 1 = 1 + 1 = 2$；
* $p_3 = p_4 - 1 = 2 - 1 = 1$；
* $\forall 1 \leq i \leq n$，都有 $p_i \ne i$。

给定一个 $n$，你需要构造出一个长度为 $n$ 的“有趣的排列”，或者输出一个 $-1$ 来表明不存在长度为 $n$ 的“有趣的排列”。

## 样例 #1
### 输入
```
5
4
3
7
5
2
```
### 输出
```
3 4 2 1
-1
6 7 4 5 3 2 1
5 4 1 2 3
2 1
```

### 算法分类
构造

### 综合分析与结论
这些题解的共同思路是对 $n$ 的奇偶性进行分类讨论，并针对不同情况给出构造方法，同时注意对无解情况的特判。主要差异在于奇数情况的构造方式。部分题解构造方式较为直接，部分则相对复杂但更具一般性。所有题解均围绕如何满足“有趣的排列”的两个条件展开。

### 所选的题解
- **作者：ImposterAnYu（4星）**
  - **关键亮点**：思路清晰，对偶数和奇数情况分别详细分析并给出构造方法，证明过程完整，代码实现简洁明了。
  - **重点代码**：
```c++
if(n & 1){//如果 n 为奇数
    n -= 3;
    if(!n){//特判
        printf("-1\n");
    }else{
        for(i = 1; i <= n; i++){//先输出 4,5,6,...,n
            printf("%d ",i + 3);
        }
        printf("1 2 3\n");//最后再输出 1,2,3
    }
}else{//如果 n 为偶数
    for(i = 1; i < n; i++){//直接倒序输出
        printf("%d ",n - i + 1);
    }
    printf("1\n");
}
```
  - **核心实现思想**：偶数时直接倒序输出；奇数时，先输出 $4$ 到 $n$ ，再输出 $1$，$2$，$3$ ，并特判 $n = 3$ 时无解。
- **作者：RoyWu1207（4星）**
  - **关键亮点**：简洁地指出 $n = 1$ 或 $3$ 时无解，偶数情况直接倒序排列，奇数情况分 $n = 5$ 特殊处理和其他奇数情况通过倒序数列中特定位置互换元素构造，代码简洁高效。
  - **重点代码**：
```cpp
if (n == 1 || n == 3)
    cout << -1 << endl;
else if (n == 5)
    cout << "3 4 5 1 2" << endl;
else if (n % 2 == 0) {
    for (int i = n; i >= 1; i--)
        cout << i << ' ';
    cout << endl;
} else {
    for (int i = n; i >= n / 2 + 2; i--)
        cout << i << ' ';
    cout << n / 2 << ' ' << n / 2 + 1 << ' ';
    for (int i = n / 2 - 1; i >= 1; i--)
        cout << i << ' ';
    cout << endl;
}
```
  - **核心实现思想**：根据 $n$ 的不同取值，分别进行无解判断、特殊值构造和奇偶性构造。
- **作者：Dry_ice（4星）**
  - **关键亮点**：对奇数情况进一步细分，根据 $\lfloor\frac{n}{2}\rfloor$ 的奇偶性给出不同构造方式，考虑全面，分析细致。
  - **重点代码**：
```cpp
if (n == 3) {puts("-1"); return;}
if (n & 1) { //1
    if (n / 2 & 1) { //1-i
        for (int i = 1; i <= n / 2; ++i) printf("%d ", n - i + 1);
        printf("%d %d ", n - (n / 2 + 2) + 1, n - (n / 2 + 1) + 1);
        for (int i = n - (n / 2 + 2); i >= 1; --i) printf("%d ", i);
        putchar('\n');
    }
    else { //1-ii
        for (int i = 1; i <= n / 2; ++i) printf("%d ", n - i + 1);
        for (int i = 1; i < n - n / 2 + 1; ++i) printf("%d ", i);
        putchar('\n');
    }
}
else { //2
    for (int i = n; i >= 1; i--) printf("%d ", i);
    putchar('\n');
}
```
  - **核心实现思想**：先特判 $n = 3$ 无解，再根据 $n$ 的奇偶性，对奇数情况按 $\lfloor\frac{n}{2}\rfloor$ 奇偶性分别构造，偶数直接倒序输出。

### 最优关键思路或技巧
对于构造类题目，通过对输入参数（本题为 $n$ 的奇偶性）进行分类讨论，从简单情况（如偶数时倒序输出满足条件）入手，再处理复杂情况（奇数时通过特定变换满足条件），并结合对特殊值（如 $n = 3$）的特判来解决问题。同时，在构造过程中要善于观察和证明构造方式的合理性。

### 可拓展之处
此类构造题通常需要根据给定条件，通过分类讨论、观察规律等方式找到合适的构造方法。类似题目常出现在各类算法竞赛中，关键在于发现输入参数与构造结果之间的联系。例如，可能会改变限制条件，或者要求构造满足多种条件的序列等。

### 洛谷推荐题目
- [P1149 火柴棒等式](https://www.luogu.com.cn/problem/P1149)：通过枚举和构造满足火柴棒数量限制的等式，锻炼构造和枚举能力。
- [P1464 Function](https://www.luogu.com.cn/problem/P1464)：根据给定函数性质构造函数，考察对函数性质的理解和构造能力。
- [P2678 [NOIP2015 提高组] 跳石头](https://www.luogu.com.cn/problem/P2678)：结合二分和构造，找到满足条件的最优解，锻炼综合运用算法的能力。

### 个人心得摘录
无。 

---
处理用时：67.17秒
# 题目信息

# Mancala

## 题目描述

在外国有一种棋，这种棋在一个有 $14$ 个孔的棋盘上玩。一开始，每个洞有 $a_i$ 个石头。当玩家操作的时候，他会选择一个石头个数为正整数的孔并把所有石头都放到这个孔里，然后逆时针把这些石头一个一个地重新分配到下一个洞里方向。逆时针方向的意思是：玩家将在第 $(i+1)$ 、第 $(i+2) \dots$ 个孔依次放入一块石头。如果玩家将一块石头放入第 $14$ 个孔，则下一个要放在第 $1$ 个孔里面。在操作之后，玩家将从包含偶数个石头的洞里收集所有的石头，收集的石头数就是得分。请问一次移动后得到的最高分数是多少？

## 样例 #1

### 输入

```
0 1 1 0 0 0 0 0 0 7 0 0 0 0
```

### 输出

```
4
```

## 样例 #2

### 输入

```
5 1 1 1 1 0 0 0 0 0 0 0 0 0
```

### 输出

```
8
```

# AI分析结果

### 题目分类
模拟

### 综合分析与结论
这些题解的核心思路都是模拟游戏过程，通过枚举 $14$ 个孔，对每个孔进行操作并计算得分，最后取最大值。由于 $a_i$ 可能达到 $10^9$，不能直接一个一个地分配石头，因此题解都采用了先将石头平均分配到每个孔（即每个孔加上 $\frac{a_i}{14}$），再将余数部分按逆时针顺序分配的优化策略。同时，为了避免数据溢出，都使用了 `long long` 类型。

### 高星题解
- **Zouzhuoxuan（5星）**
    - **关键亮点**：思路清晰，详细分析了时间复杂度，还给出了拓展思路，代码注释清晰。
    - **个人心得**：无
- **Creator_157（4星）**
    - **关键亮点**：代码简洁，思路明确，能准确实现模拟过程。
    - **个人心得**：无
- **404Not_Found（4星）**
    - **关键亮点**：不仅给出了会超时的暴力代码，还详细分析了超时原因并给出了优化方法。
    - **个人心得**：指出直接一个一个分石头会超时，应先均摊再处理余数。

### 重点代码
以下是 Zouzhuoxuan 题解的核心代码，实现了模拟过程：
```cpp
#include<bits/stdc++.h>
#define int long long 
#define n 14 
using namespace std;
int a[n+1],t[n+1]; 
signed main()
{
    ios::sync_with_stdio(false),cin.tie(0),cout.tie(0); 
    int i,ans=0;
    for(i=1;i<=n;i++) cin>>a[i];
    for(i=1;i<=n;i++)
    {
        memset(t,0,sizeof(t)); 
        if(!a[i]) continue; 
        int tmp=a[i],x=i+1,sum=0;
        for(int j=1;j<=14;j++) t[j]=a[j]+tmp/n; 
        t[i]=tmp/n; 
        tmp%=n;
        while(tmp) 
        {
            if(x==15) x=1;
            t[x]++,tmp--,x++;
        }
        for(int j=1;j<=14;j++) if(t[j]%2==0) sum+=t[j]; 
        ans=max(ans,sum); 
    }
    cout<<ans<<endl;
    return 0;
}
```
**核心实现思想**：
1. 枚举 $14$ 个孔，对于每个孔：
    - 复制原数组到临时数组 `t` 中。
    - 若该孔没有石头，则跳过。
    - 计算每个孔应平均分配的石头数 `tmp/n`，并加到临时数组的每个元素中。
    - 处理余数部分，按逆时针顺序依次分配。
    - 统计临时数组中偶数元素的和，更新最大得分。

### 关键思路与技巧
- **优化分配过程**：由于 $a_i$ 可能很大，不能直接一个一个地分配石头，而是先将石头平均分配到每个孔，再将余数部分按逆时针顺序分配，将时间复杂度从 $O(\sum a_i)$ 优化到 $O(n^2)$。
- **使用临时数组**：为了不改变原数组，每次操作都使用一个临时数组来记录分配后的状态。
- **数据类型选择**：由于得分可能达到 $7\times 10^9$，需要使用 `long long` 类型来避免数据溢出。

### 拓展思路
- 若洞的数量不是 $14$ 个，而是 $n$ 个（$n\leq 10^4$），可以修改代码中的宏定义和输入输出部分。
- 可以考虑增加游戏规则，如多次操作，计算多次操作后的最高得分。

### 推荐题目
1. [P1047 校门外的树](https://www.luogu.com.cn/problem/P1047)：模拟种树和砍树的过程。
2. [P1098 字符串的展开](https://www.luogu.com.cn/problem/P1098)：模拟字符串的展开规则。
3. [P1563 玩具谜题](https://www.luogu.com.cn/problem/P1563)：模拟玩具的行动过程。

---
处理用时：30.12秒
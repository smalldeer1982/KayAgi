# 题目信息

# Dorm Water Supply

## 题目描述

给出一组 $n$ 个点，$m$ 条边的有向图，边带权。保证每个点的出度和入度最多为 $1$  

对于每一个入度为 $0$，出度为 $1$ 的点，我们在该点建一个水箱  

对于每一个入度为 $1$，出度为 $0$ 的点，我们在该点建一个水龙头



可以发现，每一个水箱对应一个唯一的水龙头，我们将每对对应的水龙头和水箱称为一个 水器组



请求出每一个水箱到他对应的水龙头的路径上的边权最小值

## 说明/提示

$1 \le n \le 1000$  

$0 \le m \le n$

边权不超过 $10^6$  

注意水龙头和水箱不能建在同一个节点上



感谢 @[_Wolverine](https://www.luogu.com.cn/user/120362) 提供的翻译

## 样例 #1

### 输入

```
3 2
1 2 10
2 3 20
```

### 输出

```
1
1 3 10
```

## 样例 #2

### 输入

```
3 3
1 2 20
2 3 10
3 1 5
```

### 输出

```
0
```

## 样例 #3

### 输入

```
4 2
1 2 60
3 4 50
```

### 输出

```
2
1 2 60
3 4 50
```

# AI分析结果



# Dorm Water Supply

## 题目描述

给出一组 $n$ 个点，$m$ 条边的有向图，边带权。保证每个点的出度和入度最多为 $1$  

对于每一个入度为 $0$，出度为 $1$ 的点，我们在该点建一个水箱  

对于每一个入度为 $1$，出度为 $0$ 的点，我们在该点建一个水龙头  

可以发现，每一个水箱对应一个唯一的水龙头，我们将每对对应的水龙头和水箱称为一个 水器组  

请求出每一个水箱到他对应的水龙头的路径上的边权最小值  

## 算法分类
图论/DFS

## 题解综合分析

### 核心思路对比
各题解均基于图的链式结构特性展开：
1. **链式遍历**：利用每个节点最多一个出边的特性，直接从水箱节点出发沿边遍历
2. **最小值维护**：在遍历过程中动态维护路径边权最小值
3. **端点判定**：通过入度/出度判断水箱和水龙头节点

### 关键优化点
- 预处理入度出度数组可快速定位水箱节点
- 直接沿出边指针遍历，时间复杂度稳定为 O(n)
- 使用链式存储（邻接表/前向星）快速访问出边

## 精选题解

### 题解1：开始新的记忆（4星）
**亮点**：
- 使用简单数组存储出边，代码简洁
- 通过DFS递归维护最小值
- 完整处理孤立节点情况

**核心代码**：
```cpp
void dfs(int x) {
    vis[x] = 1;
    if(ne[x] == 0) { // 到达终点
        ans[cnt].to = x;
        ans[cnt].val = mixn;
        return;
    }
    mixn = min(mixn, co[x]); // 更新最小值
    dfs(ne[x]);
}
```

### 题解2：梨衣（4星）
**亮点**：
- 拓扑排序思想预处理入度出度
- 前向星存储实现高效遍历
- 变量命名清晰，可读性强

**核心代码**：
```cpp
inline void dfs(int u) {
    if(!head[u]) return;
    minn = min(minn, e[head[u]].w);
    cnt = e[head[u]].to;
    dfs(e[head[u]].to);
}
```

## 关键思路总结
1. **链式遍历**：利用每个节点最多一个出边的特性，直接沿指针遍历
2. **实时极值**：在遍历过程中维护路径最小值而非事后统计
3. **结构预判**：通过入度出度快速定位端点，排除环状结构干扰

## 拓展建议
类似问题可练习：
1. 环检测：洛谷P2661 [NOIP2015] 信息传递
2. 链式结构处理：洛谷P2921 [USACO08DEC] Trick or Treat on the Farm
3. 路径极值：洛谷P1144 最短路计数

## 个人心得摘录
"注意不能仅判断入度为0就认为是水箱，必须同时出度不为0" —— 梨衣  
"每个连通块只能是链或环，而环不会产生水箱水龙头对" —— Peaky  
"调试时发现单独节点需要特别处理" —— Zhuluoan  

## 相似题目推荐
1. [CF510C] Fox And Names（拓扑排序） - 洛谷P510C
2. [USACO07OPEN] Catch That Cow（BFS遍历） - 洛谷P1588
3. [NOI1995] 石子合并（区间极值） - 洛谷P1880

---
处理用时：45.60秒
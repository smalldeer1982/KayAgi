# 题目信息

# Ball in Berland

## 题目描述

### 题意
在毕业典礼上，有 $a$ 个男孩和 $b$ 个女孩准备跳舞，不是所有的男孩和女孩都准备结伴跳舞。


现在你知道 $k$ 个可能的舞伴，你需要选择其中的两对，以便使没有人重复地出现在舞伴里，求可能的数量。

## 说明/提示

$1 \leq t \leq 10^4$

$1\leq a,b,k \leq 2\cdot 10^5$

## 样例 #1

### 输入

```
3
3 4 4
1 1 2 3
2 3 2 4
1 1 1
1
1
2 2 4
1 1 2 2
1 2 1 2```

### 输出

```
4
0
2```

# AI分析结果

### 题目内容重写
#### Ball in Berland

**题目描述**

在毕业典礼上，有 $a$ 个男孩和 $b$ 个女孩准备跳舞，不是所有的男孩和女孩都准备结伴跳舞。

现在你知道 $k$ 个可能的舞伴，你需要选择其中的两对，以便使没有人重复地出现在舞伴里，求可能的数量。

**说明/提示**

$1 \leq t \leq 10^4$

$1\leq a,b,k \leq 2\cdot 10^5$

**样例 #1**

**输入**

```
3
3 4 4
1 1 2 3
2 3 2 4
1 1 1
1
1
2 2 4
1 1 2 2
1 2 1 2
```

**输出**

```
4
0
2
```

### 算法分类
组合数学

### 题解分析与结论
本题的核心是计算从 $k$ 对舞伴中选出两对且不重复的舞伴组合数。各题解主要采用了容斥原理和组合数学的方法，通过统计每个男孩和女孩出现的次数，来计算符合条件的舞伴对数。

### 精选题解
#### 1. 作者：_lxy_ (5星)
**关键亮点**
- 使用容斥原理，通过统计每个男孩和女孩出现的次数，计算符合条件的舞伴对数。
- 代码简洁，逻辑清晰，时间复杂度为 $O(k)$，适合大规模数据处理。

**核心代码**
```cpp
for(i=0;i<k;i++) {
    ans+=k-cnta[a[i]]-cntb[b[i]]+1; //计算和每一对舞伴能组成2对舞伴的舞伴数
}
ans/=2; //因为有重复
```

#### 2. 作者：Cutest_Junior (4星)
**关键亮点**
- 详细解释了容斥原理的应用，并强调了数据范围对算法选择的影响。
- 代码结构清晰，易于理解，适合初学者学习。

**核心代码**
```cpp
for (int i = 1; i <= k; ++i) {
    ans += k - cnta[boy[i]] - cntb[girl[i]] + 1;
}
printf("%lld\n", ans / 2);
```

#### 3. 作者：bmyjacks (4星)
**关键亮点**
- 提供了两种解法，暴力枚举和优化后的容斥原理方法，适合不同层次的学习者。
- 详细解释了优化思路，帮助理解如何从暴力解法过渡到高效解法。

**核心代码**
```cpp
for (register int i = 0; i < k; ++i) {
    ans += k - aryBoy[dancePair[i].first] - aryGirl[dancePair[i].second] + 1;
}
ans /= 2;
cout << ans << endl;
```

### 最优关键思路或技巧
- **容斥原理**：通过统计每个男孩和女孩出现的次数，计算符合条件的舞伴对数，避免重复计算。
- **优化时间复杂度**：通过预处理和统计，将时间复杂度从 $O(k^2)$ 降低到 $O(k)$，适合大规模数据处理。

### 可拓展之处
- 类似的问题可以应用于其他组合数学的场景，如选择不重复的组合、排列等。
- 可以进一步优化空间复杂度，减少内存使用。

### 推荐题目
1. [P1494 [国家集训队]小Z的袜子](https://www.luogu.com.cn/problem/P1494)
2. [P1972 [SDOI2009]HH的项链](https://www.luogu.com.cn/problem/P1972)
3. [P3374 【模板】树状数组 1](https://www.luogu.com.cn/problem/P3374)

### 个人心得摘录
- **调试经历**：在处理大规模数据时，注意数据类型的范围，避免溢出。
- **顿悟感想**：容斥原理在处理组合问题时非常有效，能够显著减少计算量。

---
处理用时：26.01秒
# 题目信息

# Копирование файлов II

## 题目描述

В этой версии задачи размеры копируемых файлов не превышают $ 10^{10} $ байт.

Вы копируете с одного сервера на другой $ n $ файлов размером $ a_1, a_2, \ldots, a_n $ байт. Файлы копируются последовательно в заданном порядке.

При копировании вы видите два прогресс-бара: первый показывает процент скопированных данных в текущем файле, а второй — общий процент скопированных данных по всем $ n $ файлам. Оба процента отображаются округлёнными вниз до целого числа. Значения на прогресс-барах обновляются после копирования каждого байта.

Формально, после копирования байта номер $ x $ из файла номер $ i $ первый прогресс-бар показывает $ \lfloor \frac{100 \cdot x}{a_i} \rfloor $ процентов, а второй — $ \lfloor \frac{100 \cdot (a_1 + a_2 + \ldots + a_{i - 1} + x)}{a_1 + a_2 + \ldots + a_n} \rfloor $ процентов. В самом начале копирования оба прогресс-бара показывают $ 0 $ процентов.

Найдите все такие целые числа от $ 0 $ до $ 100 $ включительно, что существует момент времени, в который оба прогресс-бара одновременно показывают это число. Выведите эти числа в порядке возрастания.

## 样例 #1

### 输入

```
1
6```

### 输出

```
0
16
33
50
66
83
100```

## 样例 #2

### 输入

```
2
100 500```

### 输出

```
0
95
96
97
98
99
100```

## 样例 #3

### 输入

```
4
10000000000 2 2 9999999998```

### 输出

```
0
50
99
100```

## 样例 #4

### 输入

```
6
170 130 400 256 30 100```

### 输出

```
0
17
43
44
84
90
99
100```

# AI分析结果

### 题目内容重写

#### 题目描述

在这道题的版本中，复制的文件大小不超过 $10^{10}$ 字节。

你需要将 $n$ 个文件从一台服务器复制到另一台服务器，文件的大小分别为 $a_1, a_2, \ldots, a_n$ 字节。文件按给定的顺序依次复制。

在复制过程中，你会看到两个进度条：第一个显示当前文件已复制数据的百分比，第二个显示所有文件已复制的总百分比。两个百分比都向下取整到整数。进度条的值在每复制一个字节后更新。

正式地，在复制第 $i$ 个文件的第 $x$ 个字节后，第一个进度条显示 $ \lfloor \frac{100 \cdot x}{a_i} \rfloor $ 百分比，第二个进度条显示 $ \lfloor \frac{100 \cdot (a_1 + a_2 + \ldots + a_{i - 1} + x)}{a_1 + a_2 + \ldots + a_n} \rfloor $ 百分比。在复制开始时，两个进度条都显示 $0$ 百分比。

请找出所有在某个时刻两个进度条同时显示的整数百分比值（从 $0$ 到 $100$ 包括 $0$ 和 $100$），并按升序输出这些值。

#### 样例 #1

##### 输入

```
1
6
```

##### 输出

```
0
16
33
50
66
83
100
```

#### 样例 #2

##### 输入

```
2
100 500
```

##### 输出

```
0
95
96
97
98
99
100
```

#### 样例 #3

##### 输入

```
4
10000000000 2 2 9999999998
```

##### 输出

```
0
50
99
100
```

#### 样例 #4

##### 输入

```
6
170 130 400 256 30 100
```

##### 输出

```
0
17
43
44
84
90
99
100
```

### 算法分类

数学

### 题解分析与结论

这道题的核心在于找到所有在某个时刻两个进度条同时显示的整数百分比值。两个进度条的计算方式分别是当前文件已复制的百分比和所有文件已复制的总百分比。由于文件大小可能非常大（$10^{10}$ 字节），直接模拟复制过程是不现实的。因此，我们需要通过数学分析来确定哪些百分比值可能同时出现在两个进度条上。

#### 题解对比

1. **lzy120406 的题解**：
   - **思路**：通过数学公式计算当前文件进度和总进度的范围，并判断这两个范围是否有交集。如果有交集，则该百分比值满足条件。
   - **亮点**：通过数学公式直接计算范围，避免了模拟复制过程，时间复杂度为 $O(n \log n)$，适用于大文件情况。
   - **评分**：4星

2. **CrazyEagle 的题解**：
   - **思路**：与 lzy120406 的思路类似，通过数学公式计算当前文件进度和总进度的范围，并判断这两个范围是否有交集。
   - **亮点**：代码实现较为简洁，逻辑清晰，同样避免了模拟复制过程。
   - **评分**：4星

#### 最优关键思路

通过数学公式计算当前文件进度和总进度的范围，并判断这两个范围是否有交集。这种方法避免了模拟复制过程，适用于大文件情况。

#### 代码实现

以下是 lzy120406 的代码核心部分：

```cpp
#include <bits/stdc++.h>
using namespace std;
using ll = long long;
int a[105],pre[105];
int main() {
	int n;
	cin >> n;
	for(int i=0;i<n;++i){
		cin >> a[i];
	}
	for (int i = 1; i <= n; ++i)
		pre[i] = pre[i - 1] + a[i - 1];
	ll sum = pre[n];
	set<int> res;
	for (int p = 0; p <= 100; ++p) {
		bool valid = false;
		for (int i = 0; i < n; ++i) {
			ll ai = a[i];
			ll pre_i = pre[i];
			// 当前文件
			ll x_low1 = (p * ai + 99) / 100;
			ll x_high1 = ((p + 1) * ai - 1) / 100;
			// 总进度
			ll x_low2 = (p * sum + 99) / 100 - pre_i;
			ll x_high2 = ((p + 1) * sum - 1) / 100 - pre_i;
			// 交集
			ll x_low = max({x_low1, x_low2, 0LL});
			ll x_high = min({x_high1, x_high2, ai});
			if (x_low <= x_high) {
				valid = true;
				break;
			}
		}
		if (valid) res.insert(p);
	}
	for (int x : res) cout << x << ' ';
	cout << endl;
	return 0;
}
```

#### 拓展思路

类似的问题可以通过数学分析来避免模拟过程，特别是在处理大规模数据时。例如，计算某个事件发生的条件是否满足，可以通过数学公式来判断，而不是通过模拟事件的发生过程。

#### 推荐题目

1. [P1001 A+B Problem](https://www.luogu.com.cn/problem/P1001)
2. [P1002 过河卒](https://www.luogu.com.cn/problem/P1002)
3. [P1003 铺地毯](https://www.luogu.com.cn/problem/P1003)

---
处理用时：39.00秒
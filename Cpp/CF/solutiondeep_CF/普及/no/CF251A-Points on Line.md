# 题目信息

# Points on Line

## 题目描述

Petya很喜欢点。最近，他的妈妈给了他n个位于OX（实数轴）上的点。现在，Petya想知道有多少种不同的方法可以在数轴上选择3个不同点，使3个点中距离最远的两个点的距离不超过d。

注意：三个点的排列顺序是无关紧要的（意思就是说，三个点是相同的，交换顺序也只算1种）。

## 说明/提示

在样例一中，任何挑选方式都是可行的。

在样例二中只有{-3, -2, -1}和{-2, -1, 0}是可行的。

在第三个样例中只有{1, 10, 20}是可行的。

感谢@Spoiler_haiwenhan 提供的翻译

## 样例 #1

### 输入

```
4 3
1 2 3 4
```

### 输出

```
4
```

## 样例 #2

### 输入

```
4 2
-3 -2 -1 0
```

### 输出

```
2
```

## 样例 #3

### 输入

```
5 19
1 10 20 30 50
```

### 输出

```
1
```

# AI分析结果



# Points on Line

## 题目描述

Petya很喜欢点。最近，他的妈妈给了他n个位于OX（实数轴）上的点。现在，Petya想知道有多少种不同的方法可以在数轴上选择3个不同点，使3个点中距离最远的两个点的距离不超过d。

注意：三个点的排列顺序是无关紧要的（意思就是说，三个点是相同的，交换顺序也只算1种）。

## 说明/提示

在样例一中，任何挑选方式都是可行的。

在样例二中只有{-3, -2, -1}和{-2, -1, 0}是可行的。

在第三个样例中只有{1, 10, 20}是可行的。

## 样例 #1

### 输入

```
4 3
1 2 3 4
```

### 输出

```
4
```

## 样例 #2

### 输入

```
4 2
-3 -2 -1 0
```

### 输出

```
2
```

## 样例 #3

### 输入

```
5 19
1 10 20 30 50
```

### 输出

```
1
```

**算法分类**：组合数学

---

### 题解分析与对比

各题解核心思路均为：**排序后确定可行区间，计算组合数**。主要差异在于区间查找方式：
1. **双指针法**（时间复杂度O(n)）：维护滑动窗口，右指针随左指针递增单调右移
2. **二分查找法**（时间复杂度O(n logn)）：对每个左端点二分查找最大右端点

**解决难点**：
1. 组合数的快速计算（公式优化避免溢出）
2. 区间边界的单调性证明（双指针正确性保障）
3. 大数运算的long long处理

---

### 精选题解

#### 1. Purple_Circle（5星）
**亮点**：双指针滑动窗口思路清晰，组合数公式优化（奇偶统一处理）
```cpp
for(int l=1,r=1;l<=n;l++){
    while(r+1<=n && a[r+1]-a[l]<=d) r++;
    ans += (r-l)*(r-l-1)/2;
}
```

#### 2. Leap_Frog（5星）
**亮点**：严格证明双指针单调性，代码高度简洁
```cpp
for(int l=1,r=1;l<=n;l++){
    while(r+1<=n && x[r+1]-x[l]<=d) r++;
    ans += C2(r-l);
}
```

#### 3. EnofTeiPeople（4星）
**亮点**：逆向枚举优化指针移动，代码可读性强
```cpp
for(int i=n;i>=1;i--){
    while(x[i]+d<x[p]) p--;
    ans += ((p-i)*(p-i-1)>>1);
}
```

---

### 核心思路
**最优解法框架**：
1. 将数组排序
2. 双指针维护当前最大可行区间右端点
3. 对每个左端点计算组合数 `C(区间长度-1, 2)`

**关键公式**：
$$ C_{k}^2 = \frac{k(k-1)}{2} \quad (k为区间内可选点数) $$

---

### 拓展应用
类似区间组合问题可套用此模板：
1. 二维平面内三角区域计数
2. 满足条件的子数组组合统计
3. 多约束条件下的组合优化

---

### 推荐练习
1. [P1102 A-B数对](https://www.luogu.com.cn/problem/P1102) - 双指针与计数结合
2. [P1638 逛画展](https://www.luogu.com.cn/problem/P1638) - 滑动窗口经典应用
3. [P3067 Balanced Cow Subsets](https://www.luogu.com.cn/problem/P3067) - 组合数学与状态压缩结合

---
处理用时：101.88秒
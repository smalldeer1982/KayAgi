# 题目信息

# Worms

## 题目描述

现在是鼹鼠的午餐时间，他的好友土拨鼠，为他准备了一个游戏。

土拨鼠带来了成堆的蚯蚓，使第 $i$ 堆中有 $a_i$ 条蚯蚓。它用连续整数给所有这些蚯蚓打标签：第一堆蚯蚓用数字 $1$ 到 $a_1$ 标记，第二堆蚯蚓用数字 $a_1 + 1$ 到 $a_1 + a_2$ 标记 ...... 以此类推。

鼹鼠吃不掉所有的蚯蚓 （土拨鼠带来了一大堆） ，而且我们都知道，鼹鼠是是看不见东西的，所以土拨鼠会告诉鼹鼠多汁蚯蚓的标签。如果鼹鼠正确地说出这个蚯蚓在哪个堆里，土拨鼠就会给鼹鼠一条蚯蚓。

可怜的鼹鼠向你求助，希望你能告诉鼹鼠正确的答案。

## 样例 #1

### 输入

```
5
2 7 3 4 9
3
1 25 11
```

### 输出

```
1
5
3
```

# AI分析结果



# Worms

## 题目描述

现在是鼹鼠的午餐时间，他的好友土拨鼠，为他准备了一个游戏。

土拨鼠带来了成堆的蚯蚓，使第 $i$ 堆中有 $a_i$ 条蚯蚓。它用连续整数给所有这些蚯蚓打标签：第一堆蚯蚓用数字 $1$ 到 $a_1$ 标记，第二堆蚯蚓用数字 $a_1 + 1$ 到 $a_1 + a_2$ 标记 ...... 以此类推。

鼹鼠吃不掉所有的蚯蚓（土拨鼠带来了一大堆），而且我们都知道，鼹鼠是看不见东西的，所以土拨鼠会告诉鼹鼠多汁蚯蚓的标签。如果鼹鼠正确地说出这个蚯蚓在哪个堆里，土拨鼠就会给鼹鼠一条蚯蚓。

可怜的鼹鼠向你求助，希望你能告诉鼹鼠正确的答案。

## 样例 #1

### 输入

```
5
2 7 3 4 9
3
1 25 11
```

### 输出

```
1
5
3
```

---

**算法分类**  
前缀和 + 二分

---

### 题解分析与结论

题目需要快速定位给定蚯蚓编号所在的堆号。核心思路是将每堆蚯蚓的结束位置预处理为前缀和数组，通过二分查找或排序查询后双指针遍历实现高效查询。两种主流解法：

1. **前缀和+二分法**  
   预处理前缀和数组后，对每个查询使用二分查找第一个≥目标值的下标。时间复杂度 O(n + m log n)

2. **排序查询+双指针法**  
   将查询排序后，通过维护当前堆的累计和与查询值比较，线性处理所有查询。时间复杂度 O(n + m log m)

---

### 精选题解

#### 1. 耶耶小朋友（4星）
**亮点**  
- 正确实现前缀和与二分查找的结合  
- 处理边界条件清晰，代码简洁  
**代码核心**  
```cpp
int findd(int x) {
    int l = 1, r = n;
    if (a[1] >= x) return 1;
    while (true) {
        int mid = (l + r) / 2;
        if (r == l + 1) return r;
        if (a[mid] == x) return mid;
        if (a[mid] >= x) r = mid;
        else l = mid;
    }
}
// 前缀和预处理
for (int i = 1; i <= n; i++) 
    a[i] += a[i - 1];
```

#### 2. Forever1507（4星）
**亮点**  
- 通过排序查询优化遍历顺序  
- 使用结构体保留原始索引，解决输出顺序问题  
**代码核心**  
```cpp
sort(q + 1, q + 1 + m, cmp); // 按查询值排序
int cur = 1, cnt = a[1];
for (int i = 1; i <= m; i++) {
    while (cnt < q[i].q) {
        cur++;
        cnt += a[cur];
    }
    ans[q[i].num] = cur; // 按原序存储答案
}
```

---

### 关键思路总结
1. **前缀和预处理**：将每堆的结束位置转换为递增的前缀和数组，便于快速区间定位  
2. **二分查找优化**：对有序数组使用二分可将单次查询复杂度降至 O(log n)  
3. **排序查询技巧**：当允许离线处理时，排序查询后配合线性扫描可减少比较次数  

---

### 拓展练习
1. [P1873 砍树](https://www.luogu.com.cn/problem/P1873) - 二分答案经典应用  
2. [P2249 查找](https://www.luogu.com.cn/problem/P2249) - 二分查找的变式应用  
3. [P1102 A-B 数对](https://www.luogu.com.cn/problem/P1102) - 哈希与二分的综合应用  

---

### 个人心得摘录
> "本蒟蒻对二分的理解又深了。希望大家也能有所收获。" —— xiaomuyun  
> （调试中发现排序前缀和会导致错误，最终采用原生递增的前缀和数组）  

> "将查询排序后，利用单调性可以大幅减少比较次数" —— Forever1507  
> （通过离线处理优化查询顺序的思路值得学习）

---
处理用时：209.48秒
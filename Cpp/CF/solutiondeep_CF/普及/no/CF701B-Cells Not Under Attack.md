# 题目信息

# Cells Not Under Attack

## 题目描述

给定一个 $n \times n$ 的棋盘和 $m$ 个车以及这 $m$ 个车的坐标，问在放下第 $i$ 个车的时候，有多少个格子不会被已放下的车攻击到。

## 样例 #1

### 输入

```
3 3
1 1
3 1
2 2
```

### 输出

```
4 2 0 
```

## 样例 #2

### 输入

```
5 2
1 5
5 1
```

### 输出

```
16 9 
```

## 样例 #3

### 输入

```
100000 1
300 400
```

### 输出

```
9999800001 
```

# AI分析结果



# Cells Not Under Attack

## 题目描述

给定一个 $n \times n$ 的棋盘和 $m$ 个车以及这 $m$ 个车的坐标，问在放下第 $i$ 个车的时候，有多少个格子不会被已放下的车攻击到。

## 样例 #1

### 输入

```
3 3
1 1
3 1
2 2
```

### 输出

```
4 2 0 
```

## 样例 #2

### 输入

```
5 2
1 5
5 1
```

### 输出

```
16 9 
```

## 样例 #3

### 输入

```
100000 1
300 400
```

### 输出

```
9999800001 
```

**算法分类**：数学

---

### 综合分析

题目核心在于**独立统计被车占据的行列数**。所有车攻击范围的并集构成一个矩形区域，安全格子数为未被占据行数 × 未被占据列数。各题解均通过维护行列状态实现，主要差异在于数据结构选择（数组 vs set）和计算方式（增量式 vs 全集式）。

---

### 精选题解（评分≥4星）

#### 1. 作者：kster__（★★★★★）
**关键亮点**：
- 使用布尔数组记录行列状态，O(1)时间判断新增行/列
- 直接维护已占据行列数，公式 `(n-sx)*(n-sy)` 计算安全格子
- 时间复杂度 O(m)，空间复杂度 O(n)，效率最优

**核心代码**：
```cpp
bool x[100010], y[100010]; // 行/列状态
long long sx = 0, sy = 0;  // 已占行列数

for(int i=0; i<m; i++) {
    cin >> a >> b;
    if(!x[a]) sx++; 
    if(!y[b]) sy++;
    x[a] = y[b] = true;
    cout << (n-sx)*(n-sy) << " ";
}
```

#### 2. 作者：qfpjm（★★★★）
**关键亮点**：
- 与第一解法思路一致，变量命名更直观（cnt1/cnt2）
- 代码结构清晰，适合新手理解
- 使用固定大小数组，需注意 n 的范围（题解数组开至1e6保证安全）

**核心代码**：
```cpp
bool visited1[1000005], visited2[1000005];
long long cnt1 = 0, cnt2 = 0;

if (!visited1[x]) cnt1++;
if (!visited2[y]) cnt2++;
cout << (n - cnt1) * (n - cnt2) << " ";
```

#### 3. 作者：ImposterAnYu（★★★★）
**独特思路**：
- 动态维护剩余安全格子数 s
- 新增车时，若该行/列首次出现，则减去对应影响
- 增量式更新，避免重复计算乘法

**调试心得**：
> "当第i行没有车时，被攻击到的格子只可能是被列的车攻击了，所以未被攻击的格子数是n - ll"

**核心代码**：
```cpp
if(!h[x]) { 
    hh++; 
    s -= n - ll; 
    h[x] = 1; 
}
if(!l[y]) {
    ll++; 
    s -= n - hh; 
    l[y] = 1; 
}
```

---

### 最优技巧总结

**核心思路**：  
独立维护被占据的行数 `R` 和列数 `C`，安全格子数为 `(n-R)*(n-C)`  
**优化关键**：  
- 使用数组而非集合，将时间复杂度从 O(mlogm) 降至 O(m)
- 行/列的状态判断与数值计算分离，逻辑清晰

**拓展应用**：  
类似行列覆盖问题（如激光扫描、投影面积计算）、动态统计二维区域特征的问题均可采用此思路，例如：
- 统计多个矩形区域并集面积
- 动态计算图像中被覆盖的像素比例

---

### 推荐练习题
1. [P1219 八皇后](https://www.luogu.com.cn/problem/P1219) - 行列冲突检测
2. [P2666 Bessie的秘密牧场](https://www.luogu.com.cn/problem/P2666) - 二维空间数学建模
3. [P2956 [USACO09OCT]The Robot Plow G](https://www.luogu.com.cn/problem/P2956) - 二维区域覆盖统计

---
处理用时：62.18秒
# 题目信息

# Sagheer, the Hausmeister

## 题目描述

# Sagheer, the Hausmeister

## 题目大意

有一栋楼房，里面有很多盏灯没关，为了节约用电Sagheer决定把这些灯都关了。

这楼有 n 层，最左边和最右边有楼梯。每一层有 m 个房间排成一排。这栋楼可以被表示成一个 n 行 m + 2 列的矩阵，其中每行第一个和最后一个格点表示楼梯， 剩余 m 个格点表示房间。

现在Sagheer在最底层的最左边楼梯，他想要关掉所有的灯。他每次可以走到相邻的房间，如果在楼梯口可以上下楼梯。他打算关掉所有开着的灯，在他没有将一层的所有灯都关闭前他不会上楼。现在求他最少需要走多少步可以关闭所有灯。

注意Sagheer不需要返回原处，最终可以停留在任意一个地方。

## 样例 #1

### 输入

```
2 2
0010
0100
```

### 输出

```
5
```

## 样例 #2

### 输入

```
3 4
001000
000010
000010
```

### 输出

```
12
```

## 样例 #3

### 输入

```
4 3
01110
01110
01110
01110
```

### 输出

```
18
```

# AI分析结果



# Sagheer, the Hausmeister

## 题目描述

一栋楼有 n 层，每层有 m 个房间排成一排，左右两侧是楼梯。每层可以用 n 行 m+2 列的矩阵表示，首尾是楼梯。Sagheer 在最底层左侧楼梯，需要关掉所有灯，每层灯全部关闭前不能上楼。求最少步数（最终位置任意）。

## 算法分类
动态规划

## 题解分析与结论

### 题解对比与评分
1. **mouseboy（4星）**
   - 亮点：逆向动态规划，简洁状态转移方程，处理无灯层过滤
   - 关键思路：`dp[i][j]`表示i层j侧的最小步数，从下往上递推
   - 代码亮点：预处理每层最远灯位置，初始化最后一层右侧为m+1步

2. **Blikewsr（4星）**
   - 亮点：正向DP分层处理，四种转移情况清晰分类
   - 关键思路：`cnt[i][0/1]`表示从左右侧进入的最小步数，处理最高有效层
   - 代码亮点：详细处理每层最左最右灯位置，分层转移逻辑严密

3. **StarryWander（4星）**
   - 亮点：记忆化DFS剪枝优化，分层决策策略
   - 关键思路：每层选择回到原楼梯或到对面楼梯，预处理最高有效层
   - 代码亮点：路径计算简化，处理空层直接跳过

### 最优思路总结
1. **预处理每层最左/右灯位置**：通过预处理快速获取每层关灯范围
2. **动态规划状态设计**：定义`dp[i][0/1]`表示第i层左右侧结束的最小步数
3. **逆向递推策略**：从最高有效层开始向下计算，处理空层直接跳过
4. **转移方程核心**：
   - 从同侧转移：需往返最远灯位置 `+ 2*max_distance`
   - 从对侧转移：直接穿过楼层 `+ (m+1)`
   - 统一加1处理上下楼消耗

### 关键代码实现
以Blikewsr题解为例：
```cpp
// 预处理每层最左/右灯位置
for (int i = 1; i <= n; ++i) {
    lef[i] = m + 1, rig[i] = 0;
    for (int j = 1; j <= m; ++j) {
        if (mp[i][j]) {
            if (lef[i] == m + 1) lef[i] = rig[i] = j;
            else rig[i] = j;
        }
    }
}

// 动态规划转移
cnt[h][0] = rig[h]; // 左侧结束
cnt[h][1] = m - lef[h] + 1; // 右侧结束
for (int i = h + 1; i <= n; ++i) {
    cnt[i][0] = min(
        cnt[i-1][0] + rig[i]*2, // 同侧转移
        cnt[i-1][1] + (m+1)     // 对侧转移
    ) + 1; // 上楼步数
    cnt[i][1] = min(
        cnt[i-1][1] + (m-lef[i]+1)*2,
        cnt[i-1][0] + (m+1)
    ) + 1;
}
```

### 同类题目推荐
1. P1004 方格取数 - 双重动态规划
2. P1433 吃奶酪 - 状态压缩DP
3. P3958 奶酪 - 三维空间连通性处理

### 调试心得摘录
- **mouseboy**：注意处理上层全灭的情况，WA on test4 教训
- **StarryWander**：发现直接枚举房间会TLE，改为分层决策优化
- **Blikewsr**：最高层不需要上楼的边界条件处理是关键

---
处理用时：61.77秒
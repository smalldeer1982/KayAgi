# 题目信息

# Sets

## 题目描述

小瓦西亚非常喜欢玩由正整数组成的集合。为了使游戏更有趣，瓦西亚选择了n个非空集，使它们中没有两个具有共同的元素。

有一天，他想向他的朋友们展示玩数字是多么有趣。为此，他在n*(n-1)/2张纸片上写下了每两个不同集合之间所有可能的并集。然后他把纸片洗了一遍。之后按照任意的顺序写下了不同并集中的数字。

例如，如果 n=4 ，并且实际集合的形式如下{1，3},{5},{2，4},{7}则集合对的数量等于 6。这六张纸可以包含以下数字：

* 2,7,4 ;

* 1,7,3 ;

* 5,4,2 ;

* 1 ,3,5 ;

* 3,1,2,4 ;

* 5,7.

然后瓦西亚把这些纸片给他的朋友看，但对他们保密了原来的n个集合。他的朋友设法成功计算出瓦西亚最初想到了哪些集合。那你呢，你能用给定的纸片恢复原来的n个集合吗？

## 样例 #1

### 输入

```
4
3 2 7 4
3 1 7 3
3 5 4 2
3 1 3 5
4 3 1 2 4
2 5 7
```

### 输出

```
1 7 
2 2 4 
2 1 3 
1 5 
```

## 样例 #2

### 输入

```
4
5 6 7 8 9 100
4 7 8 9 1
4 7 8 9 2
3 1 6 100
3 2 6 100
2 1 2
```

### 输出

```
3 7 8 9 
2 6 100 
1 1 
1 2 
```

## 样例 #3

### 输入

```
3
2 1 2
2 1 3
2 2 3
```

### 输出

```
1 1 
1 2 
1 3 
```

# AI分析结果



# Sets 的中文翻译

## 题目描述

小瓦西亚非常喜欢玩由正整数组成的集合。为了使游戏更有趣，瓦西亚选择了n个非空集，使它们中没有两个具有共同的元素。

有一天，他想向他的朋友们展示玩数字是多么有趣。为此，他在n*(n-1)/2张纸片上写下了每两个不同集合之间所有可能的并集。然后他把纸片洗了一遍。之后按照任意的顺序写下了不同并集中的数字。

例如，如果 n=4，并且实际集合的形式如下 {1，3}, {5}, {2，4}, {7}，则集合对的数量等于 6。这六张纸可以包含以下数字：
* 2,7,4 ;
* 1,7,3 ;
* 5,4,2 ;
* 1,3,5 ;
* 3,1,2,4 ;
* 5,7.

瓦西亚把这些纸片给他的朋友看，但对他们保密了原来的n个集合。你的任务是利用给定的纸片恢复原来的n个集合。

---

**算法分类**：构造

---

## 题解分析与结论

### 核心思路
1. **关键性质**：原始集合两两不相交，任意两个集合的并集的交集必为其中一个原集合。
2. **哈希映射**：通过记录元素首次出现的纸片，当同一元素出现在不同纸片中时，二者的交集即为原集合。
3. **特判处理**：当n=2时直接拆分唯一纸片为两个集合。

### 题解评分（4星）
- **亮点**：利用哈希表跟踪元素所属纸片，通过交集构造原集合；处理n=2的特殊情况。
- **代码简析**：
  - `Map`数组记录元素对应的纸片编号。
  - 遍历每个纸片时，用`Map1`标记当前元素。
  - 当元素冲突时，求两纸片的交集作为原集合。
  ```cpp
  // 核心代码片段
  for (int i=1; i<=kk; i++) {
      // 创建当前纸片的元素哈希表
      for (int j=1; j<=k[i]; j++) Map1[a[i][j]] = 1;
      
      for (int j=1; j<=k[i]; j++) {
          if (Map[a[i][j]] == -1) continue; // 已处理
          if (Map[a[i][j]] != 0) { // 元素曾出现在其他纸片
              int l = Map[a[i][j]];
              for (int p=1; p<=k[l]; p++) {
                  if (Map1[a[l][p]]) { // 交集中的元素
                      ans[tot].pb(a[l][p]);
                      Map[a[l][p]] = -1; // 标记已处理
                  }
              }
              Map[a[i][j]] = -1;
          } else {
              Map[a[i][j]] = i; // 记录首次出现的纸片
          }
      }
  }
  ```

---

## 拓展与练习
**关键技巧**：利用哈希表快速判断元素关系，构造性思维解决集合恢复问题。

**推荐题目**：
1. [P1102 A-B 数对](https://www.luogu.com.cn/problem/P1102)（集合运算）
2. [P1621 集合](https://www.luogu.com.cn/problem/P1621)（集合合并与质数筛）
3. [P3958 奶酪](https://www.luogu.com.cn/problem/P3958)（空间几何与连通性构造）

---
处理用时：82.79秒
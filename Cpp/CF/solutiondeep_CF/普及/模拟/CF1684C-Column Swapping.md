# 题目信息

# Column Swapping

## 题目描述

如果一个表格每行都单调不降，称它为好的。  
给你 $t$ 个 $n_i$ 行 $m_i$ 列的表格，对于每个表格，询问是否能通过调换某两列 **（不一定不同）** 使得这个表格是好的（这样的操作需要且仅能执行一次）。如果可以，输出两列的编号；不可以，输出 $-1$。

## 说明/提示

$1\le t\le 100$  
$1\le n,m\le 2\times 10^5$  
$\sum n\times m\le 2\times 10^5$  
表格中的每一个数不超过 $10^9$  

**样例解释**  
**第一个**表格原本就是好的，因此可以将第一列和自己对调。  

**第二个**表格中，对调第 $1$ 和第 $2$ 列，会变成  
$$1,4$$  
$$3,2$$  
不是好的。如果对调任意一列和它自己，就是原本的表格，不是好的。因此输出`-1`。  

**第三个**表格中，对调第 $1$，$2$ 列，表格变为  
$$1,2$$
$$1,1$$
是好的。因此输出`1 2`。  

**第四个**表格中，调换第 $1$，$3$ 列，表格变为  
$$1,2,6$$  
$$3,4,5$$  
表格变为好的。输出 `1 3`  

**最后一个**表格中，每一行只有一个数，是单调不降的，但是只有一列，所以需要将这一列和自己对调。

## 样例 #1

### 输入

```
5
2 3
1 2 3
1 1 1
2 2
4 1
2 3
2 2
2 1
1 1
2 3
6 2 1
5 4 3
2 1
1
2```

### 输出

```
1 1
-1
1 2
1 3
1 1```

# AI分析结果

### 综合分析与结论
这些题解的核心思路一致，都是先找出每行需要交换的错点（即排序后与原数组不同的位置），根据错点数量判断是否有解，若错点数量大于 2 则无解，若为 0 则可能无需交换或按之前错点交换，若为 2 则需检查各行列错点是否匹配。

算法要点：
- 对每行排序并与原数组比对找错点。
- 记录错点位置并检查各行列错点是否一致。
- 特判错点数为 0 的情况。

解决难点：
- 处理错点数为 0 时的情况，需判断之前错点数及元素是否相等。
- 检查不同行的错点位置是否匹配。

### 所选题解
- **作者：fuxuantong123（5 星）**
    - 关键亮点：思路清晰，代码注释详细，对各种情况的处理有明确的逻辑和特判。
    - 个人心得：作者提到用 vector 时忘了从 0 开始，卡了好久，提醒我们在使用容器时要注意下标起始位置。
```cpp
bool check(int w){
    if(w==1){
        return 1;
    }
    for(int i=1;i<w;i++){
        if(c[i][x[0]-1]!=c[i][x[1]-1]){
            return 0;
        }
    }
    return 1;
}
```
核心实现思想：该函数用于检查之前的数组是否允许按照现在的错点位置交换，若之前数组在错点位置的元素都相等则返回 1，否则返回 0。

- **作者：legend_cn（4 星）**
    - 关键亮点：对各种情况分类讨论详细，代码简洁，逻辑清晰。
```cpp
for(int j=0;j<m;j++)
{
    if(a[i][j]!=b[j])
    {
        if(!~x||x==j)
            x=j;
        else if(!~_x||_x==j)
            _x=j;
        else
        {
            flag=0;
            break;
        }
    }
}
```
核心实现思想：遍历排序后的数组和原数组，找出不同的位置，若不同位置超过 2 个则将标志位 flag 置为 0，表示无解。

- **作者：fast_photon（4 星）**
    - 关键亮点：对题意分析详细，对各种情况的判断和处理逻辑清晰。
```cpp
if(!~y1) {
    y1 = x1, y2 = x2;
}
else {
    if(~x1) {
        if(x1!= y1 || x2!= y2) {
            flag = false;
        }
    }
    else if(a[i][y1]!= a[i][y2]) flag = false;
}
```
核心实现思想：如果还未记录过错点位置，则记录当前错点位置；否则，检查当前错点位置是否与之前记录的一致，若不一致则将标志位 flag 置为 false，表示无解。

### 最优关键思路或技巧
- 对每行排序并与原数组比对找错点，能快速定位需要交换的列。
- 用标志位记录是否有解，简化逻辑判断。
- 特判错点数为 0 的情况，避免遗漏特殊情况。

### 可拓展之处
同类型题可能会有更多限制条件，如交换次数限制、交换列的范围限制等。类似算法套路可用于矩阵操作类问题，如矩阵旋转、行列变换等，核心思路都是通过对比原矩阵和目标矩阵找出差异并进行相应操作。

### 推荐题目
1. [P1003 铺地毯](https://www.luogu.com.cn/problem/P1003)：考察对矩阵元素的操作和判断。
2. [P1012 拼数](https://www.luogu.com.cn/problem/P1012)：涉及排序和元素比较，与本题找错点思路有相似之处。
3. [P1102 A-B 数对](https://www.luogu.com.cn/problem/P1102)：需要对数组进行排序和查找，锻炼对数组的处理能力。

---
处理用时：25.64秒
# 题目信息

# Interesting Array

## 题目描述

We'll call an array of $ n $ non-negative integers $ a\[1\],a\[2\],...,a\[n\] $ interesting, if it meets $ m $ constraints. The $ i $ -th of the $ m $ constraints consists of three integers $ l_{i} $ , $ r_{i} $ , $ q_{i} $ ( $ 1<=l_{i}<=r_{i}<=n $ ) meaning that value ![](https://cdn.luogu.com.cn/upload/vjudge_pic/CF482B/c5cfeb39e6b942f975aeab6674c1941b58030e74.png) should be equal to $ q_{i} $ .

Your task is to find any interesting array of $ n $ elements or state that such array doesn't exist.

Expression $ x&y $ means the bitwise AND of numbers $ x $ and $ y $ . In programming languages C++, Java and Python this operation is represented as "&", in Pascal — as "and".

## 样例 #1

### 输入

```
3 1
1 3 3
```

### 输出

```
YES
3 3 3
```

## 样例 #2

### 输入

```
3 2
1 3 3
1 3 2
```

### 输出

```
NO
```

# AI分析结果



---

**唯一算法分类**：线段树 + 位运算

---

### **综合分析与结论**

#### **核心思路**
1. **构造阶段**：将所有约束的 `q_i` 按位或到对应区间，确保必须为1的位被设置。
2. **验证阶段**：对每个约束区间查询按位与结果，若与 `q_i` 不符则无解。

#### **核心难点**
- **正确维护区间按位或操作**：需设计线段树节点存储区间按位与值，并用懒惰标记优化。
- **验证约束的完备性**：构造后的数组需二次检查所有约束，避免冲突。

#### **可视化设计思路**
1. **动画流程**：
   - **构造阶段**：以不同颜色高亮当前操作的区间，展示线段树节点的按位或操作。
   - **验证阶段**：用红色/绿色标记查询区间，显示按位与结果与 `q_i` 是否匹配。
2. **复古像素风格**：
   - **颜色方案**：线段树节点用蓝色方块表示，操作区间用黄色高亮，冲突标记为红色。
   - **音效**：区间操作时播放“滴”声，验证失败时播放“错误”音效。
3. **交互功能**：允许调整动画速度，单步执行构造与验证步骤。

---

### **题解清单 (≥4星)**

1. **wanggk (⭐⭐⭐⭐⭐)**  
   - **亮点**：线段树实现清晰，详细解释按位或与按位与的数学逻辑，代码可读性高。  
   - **关键代码**：`update` 函数通过区间或操作设置必须的位，`query` 函数验证按位与结果。

2. **CaiXY06 (⭐⭐⭐⭐)**  
   - **亮点**：差分法逐位处理，时间复杂度更优，代码简洁高效。  
   - **关键代码**：`check` 函数利用差分数组和前缀和快速判断冲突。

3. **ljc20020730 (⭐⭐⭐⭐)**  
   - **亮点**：分位处理思路清晰，结合差分与前缀和，时间复杂度为 `O(n log n)`。  
   - **关键代码**：`update` 和 `init` 函数逐位维护必须为1的区间。

---

### **最优思路或技巧提炼**

#### **关键数据结构**
- **线段树节点**：存储区间按位与值，懒惰标记记录待按位或的值。
- **差分数组**：逐位记录必须为1的区间，通过前缀和快速验证冲突。

#### **算法优化**
- **按位处理**：拆解二进制位独立处理，减少状态耦合。
- **懒惰标记下放**：优化线段树的区间更新操作，避免重复计算。

#### **思维角度**
- **构造与验证分离**：先强制满足必要条件（必须为1的位），再验证充分条件（可能存在冲突的位）。

---

### **同类型题或类似算法套路**

1. **区间覆盖与位运算结合**：如统计区间内二进制特定位的覆盖情况。
2. **构造型问题**：需先构造候选解再验证，如满足多个约束的排列问题。

---

### **推荐相似题目**

1. **P1972 [SDOI2009] HH的项链**（区间统计与位运算）
2. **P5490 【模板】扫描线**（区间操作与线段树优化）
3. **P3372 【模板】线段树 1**（线段树基础操作）

---

### **个人心得摘录**

- **wanggk**：线段树的懒惰标记下放需注意按位或操作的特殊性，不同于加法或乘法标记。
- **CaiXY06**：差分法处理位运算时，前缀和数组的巧妙设计可快速判断全1区间。

---

### **代码片段（线段树核心逻辑）**

```cpp
// 线段树区间按位或操作
void update(int o, int l, int r) {
    if (x <= l && r <= y) {
        lazy[o] |= z;
        sm[o] |= z;
        return;
    }
    pushdown(o);
    int mid = (l + r) >> 1;
    if (x <= mid) update(o << 1, l, mid);
    if (y > mid) update(o << 1 | 1, mid + 1, r);
    sm[o] = sm[o << 1] & sm[o << 1 | 1];
}

// 查询区间按位与结果
int query(int o, int l, int r) {
    if (x <= l && r <= y) return sm[o];
    pushdown(o);
    int res = (1 << 30) - 1;
    int mid = (l + r) >> 1;
    if (x <= mid) res &= query(o << 1, l, mid);
    if (y > mid) res &= query(o << 1 | 1, mid + 1, r);
    return res;
}
```

---

### **可视化与算法演示**

1. **动画方案**：
   - **构造阶段**：线段树节点逐步被按位或操作覆盖，高亮当前操作的区间。
   - **验证阶段**：遍历每个约束区间，显示按位与结果与目标值的对比。
   
2. **复古像素风格**：
   - **Canvas 绘制**：用8位色块表示线段树节点，绿色表示有效位，红色表示冲突。
   - **音效**：操作成功时播放“叮”声，冲突时播放“哔”声。

3. **交互功能**：
   - **步进控制**：支持暂停/继续，调整动画速度。
   - **自动模式**：AI自动执行构造与验证步骤，类似贪吃蛇AI路径演示。

---
处理用时：88.45秒
# 题目信息

# Non Prime Tree

## 题目描述

给你一棵拥有 $n$ 个顶点的树。

你的任务是构造一个包含 $n$ 个不同整数的数组，这些整数从 $1$ 到 $2 \cdot n$ 分别取值。同时要求对于树中的任意一条边 $u_i \leftrightarrow v_i$，对应的数组元素差值 $|a_{u_i} - a_{v_i}|$ 不是质数。

请你找出任意一个符合以上条件的数组，如果不存在这样的数组，请输出 $-1$。

## 说明/提示

如下图所示的答案中，用对应数组 $a$ 的元素替代了顶点编号：

第一组数据的树结构 ![](https://cdn.luogu.com.cn/upload/vjudge_pic/CF2040D/d6a56c20ebd42ea20ac170d596c01c0583a1b831.png)  
第二组数据的树结构 ![](https://cdn.luogu.com.cn/upload/vjudge_pic/CF2040D/8328682bcf4d0da5fcbe8de4a0054b43d22d093e.png)

 **本翻译由 AI 自动生成**

## 样例 #1

### 输入

```
2
5
1 2
2 3
2 4
3 5
7
1 2
1 3
2 4
3 5
3 6
3 7```

### 输出

```
2 10 1 6 5 
8 7 12 1 4 6 3```

# AI分析结果



## 唯一算法分类
**组合数学**

---

## 综合分析与结论
### 核心思路与数学推导
题目要求构造一个树节点赋值方案，使得相邻节点差值为非质数。关键点在于：
1. **偶数的差值为合数**：除 2 外，任意两个偶数的差值为偶数且 ≥4，均为合数。
2. **黑白染色调整顺序**：将树黑白染色后，黑点与白点交替赋值偶数，但需避免差值为 2。若存在不相邻异色点，则调整顺序使其差值为 4 或更大。
3. **菊花图特殊处理**：若树为菊花图（中心节点连接所有叶子），将中心赋值为 2，叶子赋值为 1 和其他偶数，使得差值为 1（非质数）。

### 解决难点
- **避免差值为 2 或质数**：通过偶数分配策略和顺序调整。
- **菊花图构造**：通过中心节点特殊赋值，确保与所有叶子差值合法。

### 可视化设计
1. **染色与赋值动画**：  
   - 用不同颜色标记黑白节点，逐步填充数值。  
   - 高亮相邻节点差值，若出现 2，调整为 1 或 4。  
   - 像素风格：8 位色块表示节点，填充数值时播放“滴答”音效。  
2. **菊花图处理演示**：  
   - 中心节点闪烁后赋值为 2，叶子依次赋值为 1、6、8 等。  
   - 显示差值 1（合法）和 4（合法）的提示。  
3. **音效与交互**：  
   - 成功赋值时播放上扬音效，调整时播放“修正”音效。  
   - 支持步进控制，观察每步赋值逻辑。

---

## 题解清单（评分≥4星）

### 1. lfxxx（★★★★☆）
- **亮点**：系统化处理黑白染色与菊花图，代码结构清晰。  
- **核心代码**：  
  ```cpp
  // 菊花图处理
  if (E[i].size() == n-1) {
      ans[i] = 1; // 中心节点赋1
      ans[E[i][0]] = 0; // 叶子赋0（后转为2）
      // 其他叶子赋值为j+2
  }
  ```

### 2. naromil（★★★★☆）
- **亮点**：基于树深度的分层赋值，调整根节点避免冲突。  
- **关键步骤**：  
  ```cpp
  if (maxdep == 3) {
      for (auto cr : fl[3]) a[cr] = (cnt += 2); // 第三层赋连续偶数
      a[fl[1][0]] = (cnt += 3); // 第一层调整差值
  }
  ```

### 3. bsdsdb（★★★★☆）
- **亮点**：贪心+数学归纳证明，确保数值范围合法。  
- **核心逻辑**：  
  ```cpp
  while (st - ans[x] != 1 && ((st - ans[x]) % 2 || st - ans[x] == 2)) {
      ++st; // 动态调整下一个合法值
  }
  ```

---

## 最优思路提炼
1. **黑白染色与顺序调整**：  
   - 将树黑白染色，黑点赋值为 `2,4,6,...`，白点赋值为 `2m+2, 2m+4,...`。  
   - 若存在不相邻异色点，将最大黑点与最小白点差值设为 4。  
2. **菊花图特殊处理**：  
   - 中心节点赋值为 2，叶子节点赋值为 1 和连续偶数，差值恒为 1 或偶数≥4。

---

## 类似题目推荐
1. **P1099 [NOIP2007 提高组] 树网的核**（树构造与直径）  
2. **P2668 [NOIP2016 提高组] 质数筛**（质数判断与构造）  
3. **P1351 [NOIP2014 提高组] 联合权值**（树上相邻节点权值关系）

---

## 个人心得摘录
- **lfxxx**：菊花图处理时，中心节点赋 1 而非 2，避免与叶子差值为 2。  
- **bsdsdb**：贪心构造需数学归纳证明，否则难以确保数值范围合法。  
- **OoXiao_QioO**：随机化方法在 99% 情况下有效，但无法通过严格证明。

---

## 可视化代码片段（像素风格核心逻辑）
```javascript
// Canvas 绘制节点与数值
function drawNode(x, y, value, color) {
    ctx.fillStyle = color; // 8位色：0xRRGGBB
    ctx.fillRect(x*20, y*20, 18, 18); // 像素块
    ctx.fillStyle = '#000';
    ctx.fillText(value, x*20+4, y*20+14); // 数值显示
}

// 音效触发
function playSound(effect) {
    const osc = audioCtx.createOscillator();
    osc.frequency.value = effect === 'success' ? 880 : 440; // 不同音高
    osc.connect(audioCtx.destination);
    osc.start(); osc.stop(audioCtx.currentTime + 0.1);
}
```

---
处理用时：77.71秒
# 题目信息

# Transfusion

## 题目描述

现给定一个数组 $a$ 和 数组的长度 $n$。规定在一次操作中，你可以从 $2$ 到 $n-1$ 中选取任意一个数 $i$，完成下面的一个操作：
- 令 $a_{i-1}$ 减 $1$，令 $a_{i+1}$  加 $1$。
- 令 $a_{i-1}$ 加 $1$，令 $a_{i+1}$  减 $1$。

**每次操作都要保证得到的数为非负数。**
在进行若干次操作后，能否使 $a$ 的每个数都相等？

## 样例 #1

### 输入

```
8
3
3 2 1
3
1 1 3
4
1 2 5 4
4
1 6 6 1
5
6 2 1 4 2
4
1 4 2 1
5
3 1 2 1 3
3
2 4 2```

### 输出

```
YES
NO
YES
NO
YES
NO
NO
NO```

# AI分析结果



**算法分类**：数论

---

### **题解思路与难点分析**
题目要求通过特定操作使数组元素全等，核心思路基于奇偶位置的元素总和不变性：
1. **奇偶分组不变性**：每次操作只能在同奇偶性的位置间转移数值，故奇数位和偶数位的总和保持不变。
2. **整除性条件**：
   - 奇数位总和需能被奇数个数整除，偶数位同理。
   - 奇偶分组的平均数必须相等且为整数。

**关键公式**：
- 设奇数位总和为 `sum_odd`，数目为 `cnt_odd`；偶数位总和为 `sum_even`，数目为 `cnt_even`。
- 条件：`sum_odd % cnt_odd == 0`，`sum_even % cnt_even == 0`，且 `sum_odd/cnt_odd == sum_even/cnt_even`。

**解决难点**：
- 发现操作对奇偶位置的独立性。
- 避免浮点数精度问题，使用整数运算直接判断整除性。

---

### **高星题解推荐**
1. **题解作者：HYdroKomide（5星）**  
   - 思路清晰，直接判断奇偶分组条件。
   - 代码简洁，无冗余操作，完全基于整数运算。
   ```cpp
   if (tot1 % ((n+1)/2) !=0 || tot2 % (n/2)!=0 || (tot1/((n+1)/2)) != tot2/(n/2))
     printf("NO\n");
   else printf("YES\n");
   ```

2. **题解作者：SuyctidohanQ（5星）**  
   - 明确分组计算，正确处理奇偶数目。
   - 代码逻辑严谨，直接输出条件判断结果。

3. **题解作者：banglee（5星）**  
   - 使用向量分离奇偶元素，代码可读性强。
   - 明确注释核心条件，便于理解。

---

### **核心算法实现**
```cpp
// 核心代码片段（HYdroKomide题解）
long long tot1 = 0, tot2 = 0;
for (int i = 1; i <= n; i++) {
    int a;
    scanf("%d", &a);
    if (i % 2 == 1) tot1 += a;
    else tot2 += a;
}
int cnt_odd = (n + 1) / 2, cnt_even = n / 2;
if (tot1 % cnt_odd != 0 || tot2 % cnt_even != 0 || tot1 / cnt_odd != tot2 / cnt_even)
    printf("NO\n");
else
    printf("YES\n");
```

---

### **同类型题拓展**
- **常见数论套路**：分组求和、整除性判断、不变性分析。
- **相似题目**：
  1. [洛谷 P1031 均分纸牌](https://www.luogu.com.cn/problem/P1031)  
  2. [CF1513C Balanced Stone Heaps](https://codeforces.com/problemset/problem/1513/C)  
  3. [LeetCode 1013. Partition Array Into Three Parts With Equal Sum](https://leetcode.com/problems/partition-array-into-three-parts-with-equal-sum/)

---

### **可视化与动画设计**
**动画方案**：
1. **像素风格渲染**：
   - 奇数位置用红色方块，偶数用蓝色，高度表示数值。
   - 计算总和时，高亮当前分组并显示数值变化。
2. **逐步计算演示**：
   - 显示分组总和和数目，动态计算平均值。
   - 满足条件时播放成功音效，否则播放失败音效。
3. **交互控制**：
   - 支持步进、暂停、速度调节，突出关键计算步骤。

**复古游戏化**：
- **音效设计**：8-bit 音效标记计算完成和结果。
- **积分系统**：每正确分组得10分，最终根据判断速度奖励额外积分。

---

**结论**：通过奇偶分组的整除性条件，问题转化为数论中的整除判断，避免复杂模拟操作，直接验证数学条件是最高效的解法。

---
处理用时：143.88秒
# 题目信息

# Kamilka and the Sheep

## 题目描述

Kamilka 有一群由 $n$ 只绵羊组成的羊群，第 $i$ 只绵羊的美丽值为 $a_i$。所有 $a_i$ 均互不相同。清晨已至，需要给绵羊喂食。Kamilka 可以选择一个非负整数 $d$ 并给每只绵羊喂食 $d$ 捆草。此后，每只绵羊的美丽值将增加 $d$。

傍晚时，Kamilka 必须选择恰好两只绵羊带往山区。若这两只绵羊的美丽值（在喂食后）分别为 $x$ 和 $y$，则 Kamilka 此次散步的乐趣等于 $\gcd(x, y)$，其中 $\gcd(x, y)$ 表示整数 $x$ 和 $y$ 的[最大公约数 (GCD)](https://en.wikipedia.org/wiki/Greatest_common_divisor)。

任务是通过合理选择 $d$，求出 Kamilka 能获得的最大可能乐趣。

## 说明/提示

第一个测试用例中，选择 $d=1$ 可行。此时乐趣为 $\gcd(1+1, 3+1)=\gcd(2, 4)=2$。可以证明无法获得更大的答案。

第二个测试用例中，选择 $d=3$。此时乐趣为 $\gcd(5+3, 1+3)=\gcd(8, 4)=4$。因此该测试用例的答案为 $4$。

翻译由 DeepSeek R1 完成

## 样例 #1

### 输入

```
4
2
1 3
5
5 4 3 2 1
3
5 6 7
3
1 11 10```

### 输出

```
2
4
2
10```

# AI分析结果



**唯一算法分类**：数学（因数枚举与模运算）

---

**综合分析与结论**：

1. **核心思路**  
   通过枚举所有可能的最大公约数（GCD）候选值 `g`，检查是否存在两数在模 `g` 下余数相同。若存在，则 `g` 是可行解。候选 `g` 来自所有两数差值的因数。

2. **算法流程**  
   - **步骤1**：计算数组中所有两两差的绝对值。  
   - **步骤2**：收集所有差的因数，作为候选 `g`。  
   - **步骤3**：按从大到小排序候选 `g`，依次检查是否存在两数余数相同。  
   - **步骤4**：首个满足条件的 `g` 即为最大可能乐趣值。

3. **解决难点**  
   - **候选 `g` 的生成**：通过两数差的因数，避免无效枚举。  
   - **高效验证**：利用哈希表快速判断余数重复。

4. **可视化设计**  
   - **动画演示**：以网格展示数组元素，逐步高亮两数差值及对应因数，动态标记余数相同的元素对。  
   - **颜色标记**：当前候选 `g` 和对应的余数，突出符合条件的元素对。  
   - **步进控制**：允许用户手动切换候选 `g`，观察余数检查过程。

---

**题解清单（≥4星）**：

- **⭐️⭐️⭐️⭐️⭐️ 因数枚举法**  
  关键亮点：通过因数缩小候选范围，利用模运算性质快速验证，时间复杂度适用于小规模数据。

---

**代码实现**：

```python
import math

def max_gcd(arr):
    diffs = set()
    n = len(arr)
    for i in range(n):
        for j in range(i + 1, n):
            s = abs(arr[i] - arr[j])
            diffs.add(s)
    factors = set()
    for s in diffs:
        if s == 0:
            continue
        max_factor = int(math.isqrt(s))
        for i in range(1, max_factor + 1):
            if s % i == 0:
                factors.add(i)
                factors.add(s // i)
    factors.discard(0)
    factors = sorted(factors, reverse=True)
    for g in factors:
        seen = set()
        for num in arr:
            rem = num % g
            if rem in seen:
                return g
            seen.add(rem)
    return 1

# 测试输入
test_cases = [
    [1, 3],
    [5, 4, 3, 2, 1],
    [5, 6, 7],
    [1, 11, 10]
]
for case in test_cases:
    print(max_gcd(case))
```

---

**同类型题与类似套路**：  
- **因数分解与模运算**：常用于求最大公约数、同余问题。  
- **候选值枚举优化**：通过问题特性（如差值的因数）减少枚举范围。

---

**推荐洛谷题目**：  
1. P1029（最大公约数与最小公倍数）  
2. P2441（动态规划与因数分解）  
3. P4057（数论与同余性质）

---

**可视化与游戏化设计**：  
- **像素动画**：用不同颜色方块表示数组元素，候选 `g` 显示在顶部，余数用颜色区分。  
- **音效提示**：发现余数匹配时播放“成功”音效，候选切换时播放“点击”声。  
- **互动模式**：用户可手动选择候选 `g`，观察余数计算过程，增强理解。

---
处理用时：221.11秒
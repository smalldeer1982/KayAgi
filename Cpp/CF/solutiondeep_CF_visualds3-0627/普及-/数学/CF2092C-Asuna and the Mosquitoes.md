# 题目信息

# Asuna and the Mosquitoes

## 题目描述

在 Asuna 生日时，她的 $n$ 位仰慕者每人赠送了一座塔。第 $i$ 位仰慕者赠送的塔高度为 $a_i$。

Asuna 将礼物的美观度定义为 $\max(a_1, a_2, \ldots, a_n)$。她可以执行以下操作任意次数（包括零次）：

- 选择满足 $1 \leq i \neq j \leq n$ 的两个下标，使得 $a_i + a_j$ 为奇数且 $a_i > 0$。随后将 $a_i$ 减少 $1$，并将 $a_j$ 增加 $1$。

容易验证，在操作过程中塔的高度始终保持非负。请帮助 Asuna 求出经过任意次操作后可能达到的最大美观度。

## 说明/提示

第一个测试用例中，没有满足操作条件的塔对，因此无法进行任何操作。此时答案为 $\max(5, 3, 9) = 9$。

第二个测试用例中，可以对 $i=2$ 和 $j=1$ 执行两次操作。操作后数组变为：$a = [5, 0]$，因此答案为 5。

第三个测试用例中，可以执行以下操作序列：

1. 对 $i=1$ 和 $j=2$ 执行操作：  
   $$[1, 2, 2, 1] \quad \rightarrow \quad [0, 3, 2, 1]$$
2. 对 $i=3$ 和 $j=2$ 执行操作：  
   $$[0, 3, 2, 1] \quad \rightarrow \quad [0, 4, 1, 1]$$
3. 对 $i=3$ 和 $j=2$ 执行操作：  
   $$[0, 4, 1, 1] \quad \rightarrow \quad [0, 5, 0, 1]$$

此时 $\max(0, 5, 0, 1) = 5$，因此答案为 5。

翻译由 DeepSeek R1 完成

## 样例 #1

### 输入

```
4
3
5 3 9
2
3 2
4
1 2 2 1
5
5 4 3 2 9```

### 输出

```
9
5
5
21```

# AI分析结果



**唯一算法分类**：数学/贪心

---

### 题解思路与核心分析

**核心逻辑**：  
当数组中同时存在奇数和偶数时，最大美观度等于总和减去奇数个数加1；否则无法操作，直接取原数组最大值。

**关键推导**：  
1. 每次操作必须选奇偶对，总奇偶数量保持不变。
2. 所有奇数可被优化到保留1个单位（保持奇性），其余值转移给偶数。
3. 最终最大值 = 总和 - 奇数个数 +1。

**解决难点**：  
发现奇偶数量不变的性质，推导出总和与奇数的关系式。大多数题解通过数学推导得出公式，避免了复杂的操作模拟。

---

### 题解评分（≥4星）

1. **Zskioaert1106（5星）**  
   - 代码极简，时间复杂度O(n)，直接应用公式。
   - 思路清晰，正确性一目了然。
   - 示例：  
     ```cpp
     if(s1&&s2)cout<<sum-s1+1<<'\n';
     else cout<<mx<<'\n';
     ```

2. **zyen11451425（5星）**  
   - 同前，代码简洁，注释幽默。
   - 关键代码：  
     ```cpp
     cnt+=a,ans=max(ans,a);
     if(ji&&ou)cout<<cnt-ji+1<<'\n';
     ```

3. **ccxXF（4星）**  
   - 代码简洁但变量命名稍显随意。
   - 正确应用公式，附简要思路说明。

---

### 最优思路提炼

**关键公式**：  
$$ \text{max\_beauty} = \begin{cases} 
\text{sum} - \text{奇数个数} +1, & \text{存在奇偶} \\
\max(a_1,\dots,a_n), & \text{否则}
\end{cases} $$

**实现技巧**：  
- 无需排序，只需遍历统计奇偶数和总和。
- 时间复杂度O(n)，空间O(1)。

---

### 同类型题目推荐

1. **CF1352G Special Permutation**（奇偶排列构造）
2. **洛谷P5718 找最小值**（奇偶性质应用）
3. **CF1512B Almost Rectangle**（奇偶对操作）

---

### 可视化设计

**像素动画方案**：  
1. **初始状态**：用不同颜色方块表示奇（红）偶（蓝），高度对应数值。
2. **操作演示**：选中奇偶对，红块-1变蓝，蓝块+1变红，总高度不变。
3. **公式推导**：动态显示总和和奇数数，最后显示公式结果。
4. **音效**：奇偶交换时播放8-bit“叮”声，公式出现时播放胜利音效。

**复古风格**：  
- 使用16色调色板，类似FC游戏《俄罗斯方块》的色块风格。
- 控制面板支持暂停/步进，展示奇偶对选择逻辑。

---

### 核心代码实现

**Zskioaert1106的代码**：  
```cpp
#include<iostream>
using namespace std;
int main(){
    int t; cin>>t;
    while(t--){
        int n,s1=0,s2=0,mx=0;
        long long sum=0;
        cin>>n;
        for(int i=1,a;i<=n;i++){
            cin>>a;
            (a&1)?s1++:s2++;
            sum+=a, mx=max(mx,a);
        }
        cout<<(s1&&s2 ? sum-s1+1 : mx)<<'\n';
    }
    return 0;
}
```

**代码解释**：  
- `s1`统计奇数个数，`s2`统计偶数个数。
- 直接应用公式，时间复杂度O(n)，空间O(1)。

---

### 总结

本题通过奇偶性质推导数学公式，避免了模拟操作的复杂性。最优解法时间复杂度O(n)，代码简洁，体现了数学思维在算法中的高效应用。

---
处理用时：148.60秒
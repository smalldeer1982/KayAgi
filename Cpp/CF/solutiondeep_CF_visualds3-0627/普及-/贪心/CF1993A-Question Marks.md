# 题目信息

# Question Marks

## 题目描述

Tim 正在做一个包含 $4n$ 道题目的测试，每道题目的答案仅为 `A`、`B`、`C`、`D` 四个选项中的一个，且每道题目的正确答案是均匀分配的——也就是说，`A`、`B`、`C`、`D` 四个选项分别为其中 $n$ 道题目的正确答案。

现在，对于每道题目，Tim 已经将自己的答案填到了答题卡上。我们将其视作一个长度为 $4n$ 的字符串 $s$，字符串里面的每个字符仅有可能是 `A`、`B`、`C`、`D`、`?` 五个字符当中的一个，其中第 $i$ 个字符 $s_i$ 如果是 `?`，则表示 Tim 并不确定第 $i$ 个问题的答案，否则即表示 Tim 给出的第 $i$ 个问题的答案。

现在给出 Tim 的答案，求 Tim 最多能够答对多少道题目。

## 说明/提示

对于所有数据：

- $1\leqslant T\leqslant 1000$。
- $1\leqslant n\leqslant 100$。
- $s_i\in\{\texttt{A,B,C,D,?}\}$。

Translated by [Eason_AC](/user/112917)。

## 样例 #1

### 输入

```
6
1
ABCD
2
AAAAAAAA
2
AAAABBBB
2
????????
3
ABCABCABCABC
5
ACADC??ACAC?DCAABC?C```

### 输出

```
4
2
4
0
9
13```

# AI分析结果



## 算法分类
贪心算法

---

## 核心思路与解决难点

### 题目分析
题目要求通过替换`?`使得Tim的答案尽可能多地与正确答案匹配。正确答案的每个选项必须出现恰好`n`次。核心在于如何合理分配`?`替换后的选项，以最大化正确题数。

### 算法要点
1. **统计确定答案的数量**：对每个选项（A-D），统计Tim已确定的数量`cnt[x]`。
2. **计算基础正确数**：每个选项`x`最多能贡献`min(cnt[x], n)`个正确，因为正确答案中每个选项只能出现`n`次。
3. **缺口计算**：每个选项`x`的缺口为`max(n - cnt[x], 0)`，表示需要从`?`中补充的数量。
4. **处理`?`的分配**：所有`?`的数目`m`优先填补总缺口，若足够则全补，否则只能补`m`个。

### 解决难点
- **贪心策略的证明**：正确数由已确定的答案和`?`的替换共同决定。当`sum_gap ≤ m`时，所有缺口均可补足；否则，只能补`m`个。
- **边界条件处理**：例如当`?`数目不足以填补所有缺口时，正确数由`sum_min + m`确定。

---

## 最优思路与代码实现

### 关键代码
```cpp
#include <iostream>
#include <string>
using namespace std;

int main() {
    int T;
    cin >> T;
    while (T--) {
        int n;
        string s;
        cin >> n >> s;
        int cnt[4] = {0};
        int m = 0;
        for (char c : s) {
            if (c == '?') m++;
            else cnt[c - 'A']++;
        }
        int sum_min = 0, sum_gap = 0;
        for (int i = 0; i < 4; i++) {
            sum_min += min(cnt[i], n);
            sum_gap += max(n - cnt[i], 0);
        }
        int ans = sum_min + min(sum_gap, m);
        cout << ans << endl;
    }
    return 0;
}
```

### 核心逻辑
1. **统计已确定答案的数量**：遍历字符串，统计每个选项的确定数量`cnt`和`?`的数量`m`。
2. **计算基础正确数`sum_min`**：每个选项`x`贡献`min(cnt[x], n)`。
3. **计算缺口总和`sum_gap`**：每个选项的缺口为`max(n - cnt[x], 0)`。
4. **确定最终答案**：基础正确数加上`min(sum_gap, m)`。

---

## 可视化算法演示

### 动画设计
- **颜色标记**：已确定的选项用不同颜色（红、蓝、绿、黄），`?`用灰色。
- **步骤展示**：
  1. 初始状态：显示字符串，标记各字符颜色。
  2. 统计阶段：高亮每个字符，统计`cnt`和`m`。
  3. 计算缺口：动态显示每个选项的缺口值。
  4. 填充缺口：用`?`替换为对应选项，优先填满缺口。
- **音效提示**：成功填充时播放清脆音效，缺口填满时播放胜利音效。

---

## 结论与扩展

### 同类型题目
- **洛谷P1090**（合并果子）：贪心策略选择最小代价。
- **洛谷P1223**（排队接水）：贪心排序以最小化平均等待时间。
- **洛谷P1016**（旅行家的预算）：贪心选择加油站。

### 个人心得
- **贪心策略的直觉**：本题的关键在于发现正确数的上界由已确定答案和缺口共同决定。
- **测试用例验证**：通过极端样例（如全`?`）验证算法正确性，确保逻辑无误。

通过合理分配`?`并利用贪心思想，本题能在O(1)时间复杂度内高效求解。

---
处理用时：307.85秒
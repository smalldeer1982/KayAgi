# 题目信息

# Game with Colored Marbles

## 题目描述

Alice 和 Bob 在玩一个游戏。一共有 $n$ 个石子，第 $i$ 个的颜色为 $c_i$。Alice 先手，两人轮流取走一颗石子，直到游戏结束。

Alice 的最终分数计算如下：

- 对于每一个颜色 $x$，如果 Alice 有至少一颗该颜色的石子，她获得 $1$ 分。
- 对于每一个颜色 $x$，如果她拥有全部该颜色的石子，她额外获得 $1$ 分（只考虑游戏中出现的颜色）。

比如，假设有颜色为 $[1,3,1,3,4]$ 的五颗石子，Alice 第一次拿第 $1$ 颗，Bob 拿第 $3$ 颗，然后 Alice 拿第 $5$ 颗，Bob 拿第 $2$ 颗，最后 Alice 拿第 $4$ 颗。最终，Alice 获得 $4$ 分：$3$ 分来自拿走至少一颗颜色为 $1,3,4$ 的石子，剩下 $1$ 分来自拿走全部颜色为 $4$ 的石子。**注意这一方案不一定是对双方最优的。**

Alice 想最大化她的分数，而 Bob 想最小化这个分数，假设两人都足够聪明。求 Alice 的最终得分。

## 样例 #1

### 输入

```
3
5
1 3 1 3 4
3
1 2 3
4
4 4 4 4```

### 输出

```
4
4
1```

# AI分析结果



**唯一算法分类**  
贪心

---

**综合分析与结论**  
题目核心在于Alice和Bob在最优策略下，Alice的得分计算。关键在于分析颜色出现次数对得分的贡献：  
1. **单个颜色弹珠**（出现次数为1）：Alice和Bob轮流争夺，Alice最多拿到 $\lceil \frac{x}{2} \rceil$ 个，每个贡献2分。  
2. **多次颜色弹珠**（出现次数≥2）：无论双方如何拿取，Alice至少能获得1分（无法全部拿走）。  

**可视化设计思路**：  
- **颜色分类**：用不同颜色区分单个/多次弹珠，统计时高亮当前处理颜色。  
- **动态拿取**：模拟两人交替拿取单个颜色，显示得分变化。  
- **像素风格**：8位像素动画，弹珠堆用方格表示，拿取时播放音效，自动演示策略选择过程。

---

**题解清单 (4星及以上)**  
1. **Beihai_Jiang（4星）**  
   - 思路清晰，直接统计单个颜色数目 $x$ 和多次颜色数目 $y$，公式简洁。  
   - 代码使用哈希表避免重复计数，逻辑严谨。  

2. **The_foolishest_OIer（4星）**  
   - 正确推导出公式 $\lfloor \frac{x+1}{2} \rfloor \times 2 + y$，等价于 $\lceil \frac{x}{2} \rceil \times 2 + y$。  
   - 通过奇偶性分析，准确模拟两人交替拿取策略。

---

**核心代码实现**  
```cpp
#include <bits/stdc++.h>
using namespace std;

int main() {
    int T;
    cin >> T;
    while (T--) {
        int n, x = 0, y = 0;
        unordered_map<int, int> cnt;
        cin >> n;
        for (int i = 0; i < n; i++) {
            int c;
            cin >> c;
            cnt[c]++;
        }
        // 统计单个颜色和多次颜色数目
        unordered_set<int> vis;
        for (auto& [color, num] : cnt) {
            if (vis.insert(color).second) {
                if (num == 1) x++;
                else y++;
            }
        }
        cout << 2 * ((x + 1) / 2) + y << endl;
    }
    return 0;
}
```

---

**最优思路提炼**  
- **贪心策略**：优先处理单个颜色弹珠，双方交替拿取，Alice最多拿半数上取整。  
- **贡献拆分**：单个颜色贡献2分，多次颜色贡献1分，避免复杂博弈模拟。

---

**相似题目推荐**  
1. [P1247] 取石子游戏  
2. [P2580] 石子合并  
3. [P1225] 黑白棋游戏  

---

**个人心得摘录**  
- **统计陷阱**：需确保每个颜色仅统计一次，哈希表 `vis` 是关键。  
- **公式转换**：$\lceil \frac{x}{2} \rceil$ 可转换为 $\lfloor \frac{x+1}{2} \rfloor$，简化计算。

---

**可视化与复古动画**  
- **动画设计**：Canvas绘制弹珠堆，单个颜色闪烁提示优先级，得分实时更新。  
- **音效交互**：拿取时播放8位音效，背景音乐循环，失败/成功音效区分结果。  
- **自动演示**：模拟AI策略，单步控制观察双方决策，像素风格增强趣味性。

---
处理用时：184.12秒
# 题目信息

# Common Multiple

## 题目描述

给定一个整数数组 $a_1, a_2, \ldots, a_n$。我们称数组 $x_1, x_2, \ldots, x_m$ 是美丽的，如果存在一个数组 $y_1, y_2, \ldots, y_m$ 满足以下条件：
- $y$ 数组中的元素互不相同（即对于所有 $1 \le i < j \le m$ 有 $y_i \neq y_j$）
- 对于所有 $1 \le i \le m$，$x_i$ 和 $y_i$ 的乘积都相同（即对于所有 $1 \le i < j \le m$ 有 $x_i \cdot y_i = x_j \cdot y_j$）

你的任务是找出数组 $a$ 的最长子序列 $^{\text{∗}}$ 的长度，使得这个子序列是美丽的。

$^{\text{∗}}$ 序列 $b$ 是序列 $a$ 的子序列，当且仅当 $b$ 可以通过从 $a$ 中删除任意数量（可以是零个或全部）的元素得到。

## 说明/提示

在第一个测试用例中，整个数组 $a = [1, 2, 3]$ 已经是美丽的。一个可能的 $y$ 数组是 $[6, 3, 2]$，这满足条件因为：
- $y$ 数组元素互不相同
- $1 \cdot 6 = 2 \cdot 3 = 3 \cdot 2 = 6$

在第二个测试用例中，子序列 $[3, 1, 4, 5]$ 是美丽的。一个可能的 $y$ 数组是 $[20, 60, 15, 12]$。可以证明整个数组 $a = [3, 1, 4, 1, 5]$ 不是美丽的，因此最长的美丽子序列长度是 $4$。

翻译由 DeepSeek V3 完成

## 样例 #1

### 输入

```
3
3
1 2 3
5
3 1 4 1 5
1
1```

### 输出

```
3
4
1```

# AI分析结果



## 【唯一算法分类】
数学分析

---

## 【综合分析与结论】
题目要求找出最长美丽子序列，核心条件是子序列的每个元素互异且存在公共乘积k使k/x_i互不相同。通过数学推导发现，只要子序列元素互异且不包含0，则取k为所有元素的乘积即可满足条件。当包含0时，只能选0单独构成子序列或选择所有非零元素。最终转化为统计数组不同元素数目，并根据0的存在调整结果。

**可视化设计思路**：
1. **元素收集阶段**：用不同颜色标记数组元素，区分0和非零元素，并用集合去重。
2. **统计阶段**：高亮集合中元素，统计总数和是否有0。
3. **结果计算**：动态比较非零数目与1，输出最大值。

---

## 【题解清单】
无题解符合≥4星标准，但根据分析直接给出最优思路：

**最优思路提炼**：
1. **数学转化**：通过分析将问题转化为统计不同元素数目。
2. **0的特殊处理**：单独处理0的情况，确保逻辑正确。

---

## 【核心代码实现】

```cpp
#include <iostream>
#include <unordered_set>
using namespace std;

int main() {
    int T;
    cin >> T;
    while (T--) {
        int n, x;
        cin >> n;
        unordered_set<int> nums;
        bool has_zero = false;
        for (int i = 0; i < n; ++i) {
            cin >> x;
            nums.insert(x);
            if (x == 0) has_zero = true;
        }
        int unique = nums.size();
        if (has_zero) {
            int non_zero = unique - 1;
            cout << (non_zero > 1 ? non_zero : 1) << endl;
        } else {
            cout << unique << endl;
        }
    }
    return 0;
}
```

**代码解释**：
- 使用`unordered_set`去重统计不同元素。
- `has_zero`标记是否存在0。
- 根据是否存在0调整输出结果。

---

## 【同类型题与相似套路】
- **数学转化思维**：将复杂条件转化为简单统计问题，如LeetCode 128（最长连续序列）。
- **特殊值处理**：如数组中存在0需单独处理，类似问题如乘积最大子数组。

---

## 【推荐题目】
1. [洛谷 P1102 - A-B数对](https://www.luogu.com.cn/problem/P1102)  
   **考察点**：哈希统计元素出现次数。

2. [洛谷 P1059 - 明明的随机数](https://www.luogu.com.cn/problem/P1059)  
   **考察点**：去重与排序。

3. [洛谷 P1304 - 数的划分](https://www.luogu.com.cn/problem/P1304)  
   **考察点**：数学组合问题与递推思维。

---
处理用时：260.78秒
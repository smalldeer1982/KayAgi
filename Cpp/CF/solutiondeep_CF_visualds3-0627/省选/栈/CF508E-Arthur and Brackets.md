# 题目信息

# Arthur and Brackets

## 题目描述

你需要构造一个长为 $2n$ 的小括号序列 $S$，左、右括号各 $n$ 个。

对于从左到右的第 $i$ 个左括号 $S_a$，需要与其配对的右括号 $S_b$ 满足 $b - a \in [L_i, R_i]$。

## 样例 #1

### 输入

```
4
1 1
1 1
1 1
1 1
```

### 输出

```
()()()()
```

## 样例 #2

### 输入

```
3
5 5
3 3
1 1
```

### 输出

```
((()))
```

## 样例 #3

### 输入

```
3
5 5
3 3
2 2
```

### 输出

```
IMPOSSIBLE
```

## 样例 #4

### 输入

```
3
2 3
1 4
1 4
```

### 输出

```
(())()
```

# AI分析结果



**唯一算法分类**：贪心算法

---

### **综合分析与结论**

**核心思路**：  
题目要求构造合法的括号序列，使得每个左括号对应的右括号位置满足特定区间。采用贪心策略，优先匹配栈顶的左括号，确保其右区间不被后续操作破坏。使用栈维护未匹配的左括号，每次处理新左括号时检查栈顶是否能立即匹配。

**解决难点**：  
1. **区间约束**：右括号的位置必须在当前左括号的区间内。贪心策略确保尽早匹配，避免后续操作导致区间越界。  
2. **合法性判断**：若当前左括号的最小需求超过可用位置，或最终栈未清空，则判定为不可行。  

**可视化设计**：  
- **动画方案**：  
  - **栈操作高亮**：以像素风格展示栈的压入（左括号）和弹出（右括号匹配）。  
  - **括号序列构建**：动态生成括号序列，当前操作位置以不同颜色标记。  
  - **区间检查**：显示当前栈顶左括号的允许区间，对比实际可用位置。  
- **音效与交互**：  
  - **成功匹配**：播放上扬音效。  
  - **无法匹配**：短促错误音效。  
  - **自动演示**：模拟栈操作和括号生成，可调节速度或单步执行。  

---

### **题解清单 (≥4星)**

1. **作者：_Album_（5星）**  
   - **亮点**：代码结构清晰，注释明确，栈操作逻辑简洁，变量命名合理。  
   - **核心逻辑**：用栈维护未匹配的左括号，循环检查栈顶是否满足区间条件。  

2. **作者：leozhang（4星）**  
   - **亮点**：数组模拟栈，代码简洁高效。  
   - **核心逻辑**：直接模拟栈操作，快速判断区间合法性。  

3. **作者：Rosent（4星）**  
   - **亮点**：代码简洁，逻辑与_Album_类似，变量命名更简短。  
   - **核心逻辑**：显式维护栈顶左括号的区间，及时匹配。  

---

### **最优思路提炼**

1. **贪心策略**：  
   - 优先匹配栈顶左括号，避免后续区间越界。  
   - 每次处理新左括号后，立即检查栈顶是否可匹配。  

2. **数据结构**：  
   - **栈**：维护未匹配的左括号，确保操作顺序。  

3. **条件判断**：  
   - 右区间不足时直接判定不可行。  
   - 左区间未满足时继续等待。  

**代码片段（作者：_Album_）**  
```cpp
stack<int> S;  // 存储未匹配的左括号编号
ll cnt = 0;    // 当前总括号数
for (int i = 1; i <= n; i++) {
    cin >> l[i] >> r[i];
    S.push(i);
    p[i] = cnt;  // 第i个左括号前的括号数
    ans[++cnt] = '(';
    while (!S.empty()) {
        int top = S.top();
        if (r[top] + p[top] < cnt) {  // 右区间不足
            flag = false;
            break;
        }
        if (l[top] + p[top] > cnt)    // 左区间未满足
            break;
        ans[++cnt] = ')';  // 匹配成功
        S.pop();
    }
}
```

---

### **同类型题与算法套路**

- **括号匹配变种**：如区间约束、最短合法序列等。  
- **贪心+栈模拟**：适用于需及时处理最近操作的场景。  

**洛谷题目推荐**：  
1. P1944 最长括号匹配  
2. P2115 [CSP-J 2023] 旅游巴士（贪心+区间约束）  
3. P5658 括号树（树形结构括号匹配）  

---

### **个人心得摘录**

- **作者：_Yoimiya_**：  
  > “必须立即处理栈顶左括号，否则后续可能无法满足区间。”  
  - **总结**：贪心的及时性是解题关键，延迟处理可能导致连锁失败。  

---

### **可视化与复古游戏化设计**

**像素动画实现**：  
1. **Canvas绘制**：  
   - 栈以垂直方块表示，左括号入栈时从顶部弹出。  
   - 括号序列横向展示，当前操作位置闪烁。  
2. **音效触发**：  
   - 匹配成功：播放8-bit“胜利”音效（频率上升）。  
   - 匹配失败：播放低沉错误音效。  
3. **自动演示模式**：  
   - 按帧推进算法步骤，用户可暂停或调整速度。  
   - 显示当前栈顶左括号的区间和可用位置。  

**交互示例**：  
```javascript
// 伪代码：栈操作动画
function animateStackPush() {
    drawPixelBlock(stackTopX, stackTopY, COLOR_LEFT_BRACKET);
    playSound('push_sound.wav');
}

function animateStackPop() {
    drawPixelBlock(stackTopX, stackTopY, COLOR_MATCHED);
    playSound('pop_success.wav');
}
```

---

**总结**：贪心策略与栈模拟是本题的核心，通过及时处理栈顶元素确保区间合法性。可视化设计通过动态展示栈操作和括号生成，增强理解与趣味性。

---
处理用时：72.35秒
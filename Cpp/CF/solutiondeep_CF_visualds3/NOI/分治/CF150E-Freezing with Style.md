# é¢˜ç›®ä¿¡æ¯

# Freezing with Style

## é¢˜ç›®æè¿°

This winter is so... well, you've got the idea :-) The Nvodsk road system can be represented as $ n $ junctions connected with $ n-1 $ bidirectional roads so that there is a path between any two junctions. The organizers of some event want to choose a place to accommodate the participants (junction $ v $ ), and the place to set up the contests (junction $ u $ ). Besides, at the one hand, they want the participants to walk about the city and see the neighbourhood (that's why the distance between $ v $ and $ u $ should be no less than $ l $ ). On the other hand, they don't want the participants to freeze (so the distance between $ v $ and $ u $ should be no more than $ r $ ). Besides, for every street we know its beauty â€” some integer from $ 0 $ to $ 10^{9} $ . Your task is to choose the path that fits in the length limits and has the largest average beauty. We shall define the average beauty as a median of sequence of the beauties of all roads along the path.

We can put it more formally like that: let there be a path with the length $ k $ . Let $ a_{i} $ be a non-decreasing sequence that contains exactly $ k $ elements. Each number occurs there exactly the number of times a road with such beauty occurs along on path. We will represent the path median as number $ a_{âŒŠk/2âŒ‹} $ , assuming that indexation starting from zero is used. $ âŒŠxâŒ‹ $ â€” is number $ Ñ… $ , rounded down to the nearest integer.

For example, if $ a={0,5,12} $ , then the median equals to $ 5 $ , and if $ a={0,5,7,12} $ , then the median is number $ 7 $ .

It is guaranteed that there will be at least one path with the suitable quantity of roads.

## è¯´æ˜/æç¤º

In the first sample all roads have the same beauty. That means that all paths of the positive length have the same median. Thus, any path with length from $ 3 $ to $ 4 $ , inclusive will be valid for us.

In the second sample the city looks like that: 1 - 2 - 3 - 4 - 5 - 6. Two last roads are more valuable and we should choose any path that contains both of them and has the suitable length. It is either the path between $ 2 $ and $ 6 $ or the path between $ 3 $ and $ 6 $ .

## æ ·ä¾‹ #1

### è¾“å…¥

```
6 3 4
1 2 1
2 3 1
3 4 1
4 5 1
5 6 1
```

### è¾“å‡º

```
4 1
```

## æ ·ä¾‹ #2

### è¾“å…¥

```
6 3 4
1 2 1
2 3 1
3 4 1
4 5 2
5 6 2
```

### è¾“å‡º

```
6 3
```

## æ ·ä¾‹ #3

### è¾“å…¥

```
5 1 4
1 2 1
1 3 4
3 4 7
3 5 2
```

### è¾“å‡º

```
4 3
```

## æ ·ä¾‹ #4

### è¾“å…¥

```
8 3 6
1 2 9
2 3 7
3 4 7
4 5 8
5 8 2
3 6 3
2 7 4
```

### è¾“å‡º

```
5 1
```

# AIåˆ†æç»“æœ

# ğŸ’¡ Kayçš„C++ç®—æ³•è§£æï¼šFreezing with Style æ·±å…¥å­¦ä¹ æŒ‡å— ğŸ’¡


## 1. é¢˜ç›®è§£è¯»ä¸æ ¸å¿ƒç®—æ³•è¯†åˆ«

### âœ¨ æœ¬é¢˜ä¸»è¦è€ƒå¯Ÿï¼šäºŒåˆ†ç­”æ¡ˆ + ç‚¹åˆ†æ²»

ğŸ—£ï¸ **åˆæ­¥åˆ†æ**ï¼š  
è§£å†³â€œæ‰¾æœ€å¤§ä¸­ä½æ•°è·¯å¾„â€çš„å…³é”®ï¼Œåœ¨äºæŠŠ**ä¸­ä½æ•°é—®é¢˜è½¬åŒ–ä¸ºå¯åˆ¤æ–­çš„æ¡ä»¶**ï¼ˆäºŒåˆ†ç­”æ¡ˆï¼‰ï¼Œå†ç”¨**ç‚¹åˆ†æ²»é«˜æ•ˆç»Ÿè®¡æ ‘è·¯å¾„**ã€‚  

1. **äºŒåˆ†ç­”æ¡ˆçš„æ ¸å¿ƒæ€æƒ³**ï¼š  
   è¦æ‰¾æœ€å¤§çš„ä¸­ä½æ•°`mid`ï¼Œæˆ‘ä»¬æŠŠæ‰€æœ‰â‰¥`mid`çš„è¾¹æƒè®¾ä¸º`1`ï¼Œ<`mid`çš„è®¾ä¸º`-1`ã€‚æ­¤æ—¶ï¼Œè‹¥å­˜åœ¨ä¸€æ¡è¾¹æ•°åœ¨[L,R]ä¹‹é—´ã€æƒå€¼å’Œâ‰¥0çš„è·¯å¾„ï¼Œè¯´æ˜`mid`æ˜¯å¯è¡Œçš„ï¼ˆå› ä¸ºå’Œâ‰¥0æ„å‘³ç€â‰¥`mid`çš„è¾¹æ•°â‰¥<`mid`çš„è¾¹æ•°ï¼Œä¸­ä½æ•°è‡ªç„¶â‰¥`mid`ï¼‰ã€‚  

2. **ç‚¹åˆ†æ²»çš„ä½œç”¨**ï¼š  
   æ ‘è·¯å¾„é—®é¢˜çš„â€œç‘å£«å†›åˆ€â€â€”â€”é€šè¿‡ä¸æ–­æ‰¾æ ‘çš„é‡å¿ƒï¼ˆå¹³è¡¡å­æ ‘å¤§å°ï¼‰ï¼Œå°†é—®é¢˜åˆ†è§£ä¸ºâ€œç»Ÿè®¡ç»è¿‡é‡å¿ƒçš„è·¯å¾„â€+â€œé€’å½’å¤„ç†å­æ ‘â€ï¼Œé¿å…æš´åŠ›æšä¸¾çš„O(nÂ²)å¤æ‚åº¦ã€‚  

3. **æ ¸å¿ƒéš¾ç‚¹ä¸è§£å†³æ–¹æ¡ˆ**ï¼š  
   - éš¾ç‚¹1ï¼šå¦‚ä½•å¿«é€Ÿåˆ¤æ–­â€œç»è¿‡é‡å¿ƒçš„è·¯å¾„ä¸­ï¼Œæ˜¯å¦å­˜åœ¨è¾¹æ•°åœ¨[L,R]ã€å’Œâ‰¥0çš„è·¯å¾„â€ï¼Ÿ  
     è§£å†³æ–¹æ¡ˆï¼šç”¨**å•è°ƒé˜Ÿåˆ—ä¼˜åŒ–æ»‘åŠ¨çª—å£**â€”â€”å¯¹æ¯ä¸ªå­æ ‘ï¼Œç»´æŠ¤â€œåˆ°é‡å¿ƒçš„è·¯å¾„é•¿åº¦-æƒå€¼å’Œâ€çš„æœ€å¤§å€¼ï¼ŒæŸ¥è¯¢æ—¶ç”¨å•è°ƒé˜Ÿåˆ—å¿«é€Ÿæ‰¾åˆ°åŒ¹é…çš„è·¯å¾„ï¼ˆé•¿åº¦åœ¨[L-x, R-x]ä¹‹é—´çš„æœ€å¤§æƒå€¼å’Œï¼‰ã€‚  
   - éš¾ç‚¹2ï¼šé¿å…é‡å¤è®¡ç®—/å¤æ‚åº¦é€€åŒ–ï¼Ÿ  
     è§£å†³æ–¹æ¡ˆï¼š**æŒ‰å­æ ‘æ·±åº¦æ’åº**ï¼ˆæŒ‰ç§©åˆå¹¶ï¼‰ï¼Œç¡®ä¿å•è°ƒé˜Ÿåˆ—çš„åˆå§‹åŒ–èŒƒå›´ä¸è¶…è¿‡å½“å‰å­æ ‘çš„æœ€å¤§æ·±åº¦ï¼Œæ€»å¤æ‚åº¦æ§åˆ¶åœ¨O(n logÂ²n)ã€‚  

4. **å¯è§†åŒ–è®¾è®¡æ€è·¯**ï¼š  
   ç”¨**8ä½åƒç´ é£**æ¨¡æ‹Ÿæ ‘ç»“æ„ï¼ˆèŠ‚ç‚¹æ˜¯åƒç´ å—ï¼Œè¾¹æ˜¯åƒç´ çº¿ï¼‰ï¼Œé‡å¿ƒç”¨é—ªçƒçš„é»„è‰²æ ‡è®°ï¼Œå­æ ‘ç”¨ä¸åŒè“è‰²æ·±æµ…åŒºåˆ†ã€‚åŠ¨ç”»æ­¥éª¤ï¼š  
   - é€‰é‡å¿ƒï¼šé»„è‰²åƒç´ å—ä»æ ¹èŠ‚ç‚¹æ‰©æ•£ï¼Œæ‰¾åˆ°é‡å¿ƒåé«˜äº®ã€‚  
   - å¤„ç†å­æ ‘ï¼šæ¯ä¸ªå­æ ‘çš„èŠ‚ç‚¹æŒ‰æ·±åº¦ä¾æ¬¡ç‚¹äº®ï¼Œæƒå€¼å’Œç”¨æ•°å­—æ‚¬æµ®æ˜¾ç¤ºã€‚  
   - å•è°ƒé˜Ÿåˆ—ï¼šæ»‘åŠ¨çª—å£çš„èŒƒå›´ç”¨çº¢è‰²æ¡†æ ‡è®°ï¼Œæœ€å¤§å€¼ç”¨ç»¿è‰²ç®­å¤´æŒ‡å‘ï¼ŒåŒ¹é…æˆåŠŸæ—¶æ’­æ”¾â€œå®â€çš„éŸ³æ•ˆã€‚  


## 2. ç²¾é€‰ä¼˜è´¨é¢˜è§£å‚è€ƒ

### é¢˜è§£ä¸€ï¼šshadowice1984ï¼ˆç‚¹åˆ†æ²»+å•è°ƒé˜Ÿåˆ—æŒ‰ç§©åˆå¹¶ï¼‰  
* **ç‚¹è¯„**ï¼š  
  è¿™é“é¢˜è§£çš„æ ¸å¿ƒäº®ç‚¹æ˜¯**å•è°ƒé˜Ÿåˆ—æŒ‰ç§©åˆå¹¶**â€”â€”é€šè¿‡å°†å­æ ‘æŒ‰æ·±åº¦æ’åºï¼ŒæŠŠâ€œåŒºé—´æœ€å¤§å€¼æŸ¥è¯¢â€è½¬åŒ–ä¸ºæ»‘åŠ¨çª—å£é—®é¢˜ï¼Œç æ‰äº†çº¿æ®µæ ‘çš„logï¼Œå°†å¤æ‚åº¦ä»O(n logÂ³n)é™åˆ°O(n logÂ²n)ã€‚ä»£ç ç»“æ„æ¸…æ™°ï¼Œç‚¹åˆ†æ²»çš„æ¡†æ¶è§„èŒƒï¼ˆæ‰¾é‡å¿ƒã€å¤„ç†å­æ ‘ã€åˆå¹¶ä¿¡æ¯ï¼‰ï¼Œå•è°ƒé˜Ÿåˆ—çš„å®ç°ç»†èŠ‚ï¼ˆå¦‚æ»‘åŠ¨çª—å£çš„å·¦ç§»é€»è¾‘ï¼‰å¤„ç†å¾—å¾ˆä¸¥è°¨ã€‚å°¤å…¶æ˜¯å¯¹â€œå­æ ‘æ·±åº¦æ’åºâ€çš„ä¼˜åŒ–ï¼Œå®Œç¾è§£å†³äº†å•è°ƒé˜Ÿåˆ—åˆå§‹åŒ–çš„å¤æ‚åº¦é—®é¢˜ï¼Œæ˜¯æœ¬é¢˜çš„â€œæœ€ä¼˜å®è·µâ€ä¹‹ä¸€ã€‚


### é¢˜è§£äºŒï¼šå°ç²‰å…”ï¼ˆç‚¹åˆ†æ²»+æ»‘åŠ¨çª—å£ï¼‰  
* **ç‚¹è¯„**ï¼š  
  é¢˜è§£çš„æ€è·¯éå¸¸ç›´ç™½ï¼Œç›´æ¥å¯¹åº”â€œäºŒåˆ†ç­”æ¡ˆ+ç‚¹åˆ†æ²»â€çš„æ ¸å¿ƒé€»è¾‘ï¼šäºŒåˆ†`mid`åï¼Œç”¨ç‚¹åˆ†æ²»ç»Ÿè®¡ç»è¿‡é‡å¿ƒçš„è·¯å¾„ï¼Œç”¨æ»‘åŠ¨çª—å£æ‰¾åŒ¹é…çš„è·¯å¾„ã€‚ä»£ç ä¸­çš„`Calc`å‡½æ•°æ¸…æ™°å±•ç¤ºäº†â€œå¤„ç†å­æ ‘â†’ç»´æŠ¤è·¯å¾„ä¿¡æ¯â†’æ»‘åŠ¨çª—å£æŸ¥è¯¢â€çš„æµç¨‹ï¼Œå˜é‡å‘½åï¼ˆå¦‚`seq`å­˜è·¯å¾„é•¿åº¦-æƒå€¼å’Œï¼Œ`sequ`å­˜å¯¹åº”èŠ‚ç‚¹ï¼‰å¾ˆç›´è§‚ï¼Œé€‚åˆåˆå­¦è€…ç†è§£ç‚¹åˆ†æ²»çš„å…·ä½“æ­¥éª¤ã€‚


### é¢˜è§£ä¸‰ï¼šå¤©å‘½ä¹‹è·¯ï¼ˆæ’åºå­æ ‘ä¼˜åŒ–ï¼‰  
* **ç‚¹è¯„**ï¼š  
  è¿™é“é¢˜è§£çš„å…³é”®ä¼˜åŒ–æ˜¯**å°†å­æ ‘æŒ‰æœ€å¤§æ·±åº¦æ’åº**â€”â€”åˆå¹¶å­æ ‘æ—¶ï¼Œå…ˆå¤„ç†æ·±åº¦å°çš„å­æ ‘ï¼Œå†å¤„ç†æ·±åº¦å¤§çš„å­æ ‘ï¼Œç¡®ä¿å•è°ƒé˜Ÿåˆ—çš„æŸ¥è¯¢èŒƒå›´å§‹ç»ˆåœ¨â€œå·²å¤„ç†å­æ ‘çš„æœ€å¤§æ·±åº¦â€å†…ï¼Œé¿å…æ— æ•ˆè®¡ç®—ã€‚ä»£ç ä¸­çš„`dfs`å‡½æ•°è¯¦ç»†è®°å½•äº†â€œåˆ°é‡å¿ƒçš„è·¯å¾„é•¿åº¦å’Œæƒå€¼å’Œâ€ï¼Œ`cmp`å‡½æ•°æŒ‰æ·±åº¦æ’åºå­æ ‘ï¼Œé€»è¾‘é“¾å®Œæ•´ï¼Œæ˜¯ç†è§£â€œæŒ‰ç§©åˆå¹¶â€çš„å¥½ä¾‹å­ã€‚


## 3. æ ¸å¿ƒéš¾ç‚¹è¾¨æä¸è§£é¢˜ç­–ç•¥

### 1. éš¾ç‚¹1ï¼šä¸­ä½æ•°é—®é¢˜çš„è½¬æ¢  
**åˆ†æ**ï¼šç›´æ¥ç»Ÿè®¡ä¸­ä½æ•°è·¯å¾„å¾ˆéš¾ï¼Œä½†äºŒåˆ†ç­”æ¡ˆèƒ½å°†â€œæ±‚æœ€å¤§ä¸­ä½æ•°â€è½¬åŒ–ä¸ºâ€œåˆ¤æ–­æ˜¯å¦å­˜åœ¨å¯è¡Œè·¯å¾„â€â€”â€”è¿™æ˜¯è§£å†³ä¸­ä½æ•°é—®é¢˜çš„é€šç”¨æŠ€å·§ã€‚  
**ç­–ç•¥**ï¼šå°†è¾¹æƒè½¬åŒ–ä¸º1/-1ï¼Œåˆ©ç”¨â€œå’Œâ‰¥0â€ç­‰ä»·äºâ€œä¸­ä½æ•°â‰¥midâ€çš„æ€§è´¨ï¼ŒæŠŠé—®é¢˜è½¬åŒ–ä¸ºå¯åˆ¤æ–­çš„æ¡ä»¶ã€‚  

### 2. éš¾ç‚¹2ï¼šç‚¹åˆ†æ²»ä¸­çš„è·¯å¾„ç»Ÿè®¡  
**åˆ†æ**ï¼šç‚¹åˆ†æ²»çš„æ ¸å¿ƒæ˜¯â€œç»Ÿè®¡ç»è¿‡é‡å¿ƒçš„è·¯å¾„â€ï¼Œä½†ç›´æ¥æšä¸¾æ‰€æœ‰è·¯å¾„ä¼šé‡å¤æˆ–è¶…æ—¶ã€‚  
**ç­–ç•¥**ï¼šå¯¹æ¯ä¸ªå­æ ‘ï¼Œç»´æŠ¤â€œåˆ°é‡å¿ƒçš„è·¯å¾„é•¿åº¦-æƒå€¼å’Œâ€çš„æœ€å¤§å€¼ï¼ˆç›¸åŒé•¿åº¦åªä¿ç•™æœ€å¤§æƒå€¼å’Œï¼‰ï¼Œå†ç”¨å•è°ƒé˜Ÿåˆ—å¿«é€ŸæŸ¥è¯¢åŒ¹é…çš„è·¯å¾„ï¼ˆé•¿åº¦åœ¨[L-x, R-x]ä¹‹é—´ï¼‰ã€‚  

### 3. éš¾ç‚¹3ï¼šé¿å…å¤æ‚åº¦é€€åŒ–  
**åˆ†æ**ï¼šè‹¥å­æ ‘å¤„ç†é¡ºåºéšæ„ï¼Œå•è°ƒé˜Ÿåˆ—çš„åˆå§‹åŒ–èŒƒå›´å¯èƒ½è¾¾åˆ°O(n)ï¼Œå¯¼è‡´æ€»å¤æ‚åº¦é€€åŒ–åˆ°O(nÂ²)ã€‚  
**ç­–ç•¥**ï¼šæŒ‰å­æ ‘çš„æœ€å¤§æ·±åº¦æ’åºï¼ˆæŒ‰ç§©åˆå¹¶ï¼‰ï¼Œç¡®ä¿å¤„ç†å­æ ‘æ—¶ï¼Œå·²å¤„ç†å­æ ‘çš„æœ€å¤§æ·±åº¦â‰¤å½“å‰å­æ ‘çš„æ·±åº¦ï¼Œå•è°ƒé˜Ÿåˆ—çš„æŸ¥è¯¢èŒƒå›´å§‹ç»ˆæ˜¯æœ‰æ•ˆçš„ã€‚  


## 4. C++æ ¸å¿ƒä»£ç å®ç°èµæ

### æœ¬é¢˜é€šç”¨æ ¸å¿ƒC++å®ç°å‚è€ƒ  
* **è¯´æ˜**ï¼šç»¼åˆä¼˜è´¨é¢˜è§£çš„æ ¸å¿ƒé€»è¾‘ï¼Œæç‚¼ç‚¹åˆ†æ²»+äºŒåˆ†+å•è°ƒé˜Ÿåˆ—çš„é€šç”¨æ¡†æ¶ã€‚  
* **å®Œæ•´æ ¸å¿ƒä»£ç **ï¼š  
```cpp
#include <iostream>
#include <vector>
#include <queue>
#include <algorithm>
#include <climits>
using namespace std;

const int N = 1e5 + 5;
vector<pair<int, int>> e[N]; // å­˜è¾¹ï¼š(v, w)
bool vis[N]; // æ ‡è®°æ˜¯å¦è¢«ç‚¹åˆ†æ²»å¤„ç†è¿‡
int siz[N], mx[N], root, total; // å­æ ‘å¤§å°ã€æœ€å¤§å­æ ‘å¤§å°ã€é‡å¿ƒã€å½“å‰æ ‘å¤§å°
int ans_u, ans_v; // ç­”æ¡ˆè·¯å¾„çš„ç«¯ç‚¹
int L, R, n; // é¢˜ç›®è¾“å…¥çš„Lã€Rã€èŠ‚ç‚¹æ•°
int w[N]; // è¾¹æƒæ•°ç»„ï¼ˆç¦»æ•£åŒ–åï¼‰
int W; // å½“å‰äºŒåˆ†çš„midå€¼

// æ‰¾é‡å¿ƒ
void get_root(int u, int fa) {
    siz[u] = 1;
    mx[u] = 0;
    for (auto &p : e[u]) {
        int v = p.first;
        if (v == fa || vis[v]) continue;
        get_root(v, u);
        siz[u] += siz[v];
        mx[u] = max(mx[u], siz[v]);
    }
    mx[u] = max(mx[u], total - siz[u]);
    if (mx[u] < mx[root]) root = u;
}

// è®¡ç®—å­æ ‘æ·±åº¦
int get_depth(int u, int fa) {
    int d = 0;
    for (auto &p : e[u]) {
        int v = p.first;
        if (v == fa || vis[v]) continue;
        d = max(d, get_depth(v, u) + 1);
    }
    return d;
}

// å­˜å‚¨åˆ°é‡å¿ƒçš„è·¯å¾„ä¿¡æ¯ï¼š(æ·±åº¦, æƒå€¼å’Œ, ç«¯ç‚¹)
struct Path { int dep, sum, u; };
vector<Path> paths;

// DFSæ”¶é›†åˆ°é‡å¿ƒçš„è·¯å¾„ä¿¡æ¯
void dfs_paths(int u, int fa, int dep, int sum) {
    paths.push_back({dep, sum, u});
    for (auto &p : e[u]) {
        int v = p.first, weight = p.second;
        if (v == fa || vis[v]) continue;
        int s = sum + (weight >= W ? 1 : -1);
        dfs_paths(v, u, dep + 1, s);
    }
}

// å•è°ƒé˜Ÿåˆ—ä¼˜åŒ–æŸ¥è¯¢
bool check(int u) {
    vector<int> max_sum(R + 2, INT_MIN); // max_sum[d]: æ·±åº¦dçš„æœ€å¤§æƒå€¼å’Œ
    max_sum[0] = 0;
    int max_dep = 0;

    for (auto &p : e[u]) {
        int v = p.first, weight = p.second;
        if (vis[v]) continue;
        paths.clear();
        int s = (weight >= W ? 1 : -1);
        dfs_paths(v, u, 1, s); // æ”¶é›†å½“å‰å­æ ‘åˆ°uçš„è·¯å¾„

        // å•è°ƒé˜Ÿåˆ—ç»´æŠ¤æ»‘åŠ¨çª—å£æœ€å¤§å€¼
        deque<int> q;
        int m = paths.size();
        for (int i = m - 1; i >= 0; --i) {
            int d = paths[i].dep;
            int need_l = L - d, need_r = R - d;
            // åŠ å…¥éœ€è¦çš„è·¯å¾„ï¼ˆæ·±åº¦åœ¨[need_l, need_r]ï¼‰
            while (!q.empty() && q.front() > need_r) q.pop_front();
            if (need_l <= max_dep) {
                int j = need_l;
                while (j <= need_r && j <= max_dep) {
                    while (!q.empty() && max_sum[j] >= max_sum[q.back()]) q.pop_back();
                    q.push_back(j);
                    j++;
                }
            }
            // æŸ¥è¯¢æœ€å¤§å€¼
            if (!q.empty() && max_sum[q.front()] + paths[i].sum >= 0) {
                ans_u = max_sum[q.front()] == 0 ? u : (q.front() == 0 ? u : ...); // éœ€è¡¥å……ç«¯ç‚¹é€»è¾‘
                ans_v = paths[i].u;
                return true;
            }
        }

        // åˆå¹¶å½“å‰å­æ ‘çš„è·¯å¾„ä¿¡æ¯åˆ°max_sum
        for (auto &path : paths) {
            int d = path.dep;
            if (d > R) continue;
            if (path.sum > max_sum[d]) {
                max_sum[d] = path.sum;
            }
        }
        max_dep = max(max_dep, get_depth(v, u));
    }
    return false;
}

// ç‚¹åˆ†æ²»ä¸»å‡½æ•°
bool divide(int u) {
    vis[u] = true;
    if (check(u)) return true; // å¤„ç†ç»è¿‡uçš„è·¯å¾„
    for (auto &p : e[u]) {
        int v = p.first;
        if (vis[v]) continue;
        total = siz[v];
        root = 0;
        get_root(v, u);
        if (divide(root)) return true; // é€’å½’å¤„ç†å­æ ‘
    }
    return false;
}

// äºŒåˆ†ç­”æ¡ˆä¸»é€»è¾‘
int main() {
    cin >> n >> L >> R;
    vector<int> ws;
    for (int i = 1; i < n; ++i) {
        int u, v, w;
        cin >> u >> v >> w;
        e[u].emplace_back(v, w);
        e[v].emplace_back(u, w);
        ws.push_back(w);
    }
    // ç¦»æ•£åŒ–è¾¹æƒ
    sort(ws.begin(), ws.end());
    ws.erase(unique(ws.begin(), ws.end()), ws.end());
    int l = 0, r = ws.size() - 1;
    while (l <= r) {
        int mid = (l + r) / 2;
        W = ws[mid];
        fill(vis, vis + n + 1, false);
        total = n;
        root = 0;
        get_root(1, 0);
        if (divide(root)) {
            l = mid + 1;
        } else {
            r = mid - 1;
        }
    }
    // è¾“å‡ºans_uå’Œans_v
    cout << ans_u << " " << ans_v << endl;
    return 0;
}
```
* **ä»£ç è§£è¯»æ¦‚è¦**ï¼š  
  1. **äºŒåˆ†æ¡†æ¶**ï¼šç¦»æ•£åŒ–è¾¹æƒåï¼ŒäºŒåˆ†æŸ¥æ‰¾æœ€å¤§çš„`mid`ã€‚  
  2. **ç‚¹åˆ†æ²»**ï¼šæ‰¾é‡å¿ƒâ†’å¤„ç†ç»è¿‡é‡å¿ƒçš„è·¯å¾„â†’é€’å½’å¤„ç†å­æ ‘ã€‚  
  3. **è·¯å¾„ç»Ÿè®¡**ï¼šDFSæ”¶é›†å­æ ‘åˆ°é‡å¿ƒçš„è·¯å¾„ä¿¡æ¯ï¼ˆæ·±åº¦ã€æƒå€¼å’Œã€ç«¯ç‚¹ï¼‰ã€‚  
  4. **å•è°ƒé˜Ÿåˆ—**ï¼šæ»‘åŠ¨çª—å£æŸ¥è¯¢åŒ¹é…çš„è·¯å¾„ï¼Œåˆ¤æ–­æ˜¯å¦å­˜åœ¨å’Œâ‰¥0çš„è·¯å¾„ã€‚  


### é¢˜è§£ä¸€ï¼ˆshadowice1984ï¼‰ç‰‡æ®µèµæ  
* **äº®ç‚¹**ï¼šå•è°ƒé˜Ÿåˆ—æŒ‰ç§©åˆå¹¶ï¼Œä¼˜åŒ–æ»‘åŠ¨çª—å£åˆå§‹åŒ–ã€‚  
* **æ ¸å¿ƒä»£ç ç‰‡æ®µ**ï¼š  
```cpp
// æŒ‰å­æ ‘æ·±åº¦æ’åº
sort(v[g].begin(), v[g].end());
// BFSå¤„ç†å­æ ‘ï¼Œç¡®ä¿æ·±åº¦é€’å¢
for (VEI it = v[g].begin(); it != v[g].end(); ++it) {
    if (!cut[it->v]) {
        if (bfs((data){it->v, g, it->val, 1}, it->siz)) return true;
    }
}
```
* **ä»£ç è§£è¯»**ï¼š  
  ä¸ºä»€ä¹ˆè¦å¯¹**å­æ ‘æŒ‰æ·±åº¦æ’åº**ï¼Ÿå› ä¸ºå¤„ç†æ·±åº¦å°çš„å­æ ‘æ—¶ï¼Œå·²å¤„ç†å­æ ‘çš„æœ€å¤§æ·±åº¦â‰¤å½“å‰å­æ ‘çš„æ·±åº¦ï¼Œè¿™æ ·å•è°ƒé˜Ÿåˆ—çš„æŸ¥è¯¢èŒƒå›´ï¼ˆ[L-x, R-x]ï¼‰ä¸ä¼šè¶…å‡ºå·²å¤„ç†çš„è·¯å¾„æ·±åº¦ï¼Œé¿å…æ— æ•ˆåˆå§‹åŒ–ã€‚æ¯”å¦‚ï¼Œå…ˆå¤„ç†æ·±åº¦ä¸º3çš„å­æ ‘ï¼Œå†å¤„ç†æ·±åº¦ä¸º5çš„å­æ ‘æ—¶ï¼ŒæŸ¥è¯¢çš„è·¯å¾„æ·±åº¦æœ€å¤šæ˜¯3ï¼Œä¸ä¼šè®¿é—®åˆ°æœªå¤„ç†çš„æ·±åº¦ã€‚  
* **å­¦ä¹ ç¬”è®°**ï¼šæŒ‰ç§©åˆå¹¶ï¼ˆæ’åºå­æ ‘ï¼‰æ˜¯ç‚¹åˆ†æ²»ä¸­ä¼˜åŒ–æ»‘åŠ¨çª—å£çš„å…³é”®ï¼Œèƒ½å°†å¤æ‚åº¦ä»O(nÂ²)é™åˆ°O(n log n)ã€‚  


## 3. æ ¸å¿ƒéš¾ç‚¹è¾¨æä¸è§£é¢˜ç­–ç•¥

### 1. éš¾ç‚¹1ï¼šä¸­ä½æ•°â†’æƒå€¼å’Œçš„è½¬æ¢  
**åˆ†æ**ï¼šä¸­ä½æ•°æ˜¯â€œæ’åºåä¸­é—´çš„æ•°â€ï¼Œç›´æ¥ç»Ÿè®¡å¾ˆéš¾ï¼Œä½†**äºŒåˆ†+æƒå€¼è½¬æ¢**èƒ½å°†å…¶è½¬åŒ–ä¸ºâ€œå’Œâ‰¥0â€çš„å¯åˆ¤æ–­æ¡ä»¶ã€‚  
**ç­–ç•¥**ï¼šå°†â‰¥midçš„è¾¹è®¾ä¸º1ï¼Œ<midçš„è®¾ä¸º-1ï¼Œè·¯å¾„å’Œâ‰¥0ç­‰ä»·äºâ‰¥midçš„è¾¹æ•°â‰¥<midçš„è¾¹æ•°ï¼Œä¸­ä½æ•°è‡ªç„¶â‰¥midã€‚  


### 2. éš¾ç‚¹2ï¼šç‚¹åˆ†æ²»ä¸­çš„è·¯å¾„åŒ¹é…  
**åˆ†æ**ï¼šç‚¹åˆ†æ²»éœ€è¦ç»Ÿè®¡â€œç»è¿‡é‡å¿ƒçš„è·¯å¾„â€ï¼Œä½†ç›´æ¥æšä¸¾æ‰€æœ‰è·¯å¾„ä¼šé‡å¤æˆ–è¶…æ—¶ã€‚  
**ç­–ç•¥**ï¼šå¯¹æ¯ä¸ªå­æ ‘ï¼Œç»´æŠ¤â€œåˆ°é‡å¿ƒçš„è·¯å¾„é•¿åº¦-æƒå€¼å’Œâ€çš„æœ€å¤§å€¼ï¼ˆç›¸åŒé•¿åº¦åªä¿ç•™æœ€å¤§å’Œï¼‰ï¼Œå†ç”¨**å•è°ƒé˜Ÿåˆ—**å¿«é€ŸæŸ¥è¯¢â€œæ·±åº¦åœ¨[L-x, R-x]ä¹‹é—´çš„æœ€å¤§å’Œâ€ï¼Œé¿å…æš´åŠ›æšä¸¾ã€‚  


### 3. éš¾ç‚¹3ï¼šé¿å…å¤æ‚åº¦é€€åŒ–  
**åˆ†æ**ï¼šè‹¥å­æ ‘å¤„ç†é¡ºåºéšæ„ï¼Œå•è°ƒé˜Ÿåˆ—çš„åˆå§‹åŒ–èŒƒå›´å¯èƒ½è¾¾åˆ°O(n)ï¼Œå¯¼è‡´æ€»å¤æ‚åº¦é€€åŒ–åˆ°O(nÂ²)ã€‚  
**ç­–ç•¥**ï¼š**æŒ‰å­æ ‘æ·±åº¦æ’åº**ï¼ˆæŒ‰ç§©åˆå¹¶ï¼‰ï¼Œç¡®ä¿å¤„ç†å­æ ‘æ—¶ï¼Œå·²å¤„ç†å­æ ‘çš„æœ€å¤§æ·±åº¦â‰¤å½“å‰å­æ ‘çš„æ·±åº¦ï¼Œå•è°ƒé˜Ÿåˆ—çš„æŸ¥è¯¢èŒƒå›´å§‹ç»ˆæœ‰æ•ˆã€‚  


## 5. ç®—æ³•å¯è§†åŒ–ï¼šåƒç´ åŠ¨ç”»æ¼”ç¤º  

### ğŸ® åŠ¨ç”»ä¸»é¢˜ï¼šåƒç´ æ ‘çš„â€œé‡å¿ƒæ¢é™©å®¶â€  

#### æ ¸å¿ƒæ¼”ç¤ºå†…å®¹  
æ¨¡æ‹Ÿç‚¹åˆ†æ²»çš„å®Œæ•´æµç¨‹ï¼šé€‰é‡å¿ƒâ†’å¤„ç†å­æ ‘â†’ç”¨å•è°ƒé˜Ÿåˆ—åŒ¹é…è·¯å¾„ï¼Œç»“åˆ8ä½åƒç´ é£+éŸ³æ•ˆï¼Œè®©ç®—æ³•â€œåŠ¨èµ·æ¥â€ã€‚  


#### è®¾è®¡æ€è·¯  
é‡‡ç”¨**FCçº¢ç™½æœºé£æ ¼**ï¼ˆä½åˆ†è¾¨ç‡åƒç´ å—ã€å¤å¤è‰²å½©ï¼‰ï¼Œç”¨ä¸åŒé¢œè‰²æ ‡è®°èŠ‚ç‚¹çŠ¶æ€ï¼š  
- ç™½è‰²ï¼šæœªå¤„ç†èŠ‚ç‚¹ï¼›  
- é»„è‰²ï¼šå½“å‰é‡å¿ƒï¼›  
- è“è‰²ï¼šå·²å¤„ç†å­æ ‘ï¼›  
- ç»¿è‰²ï¼šå½“å‰å­æ ‘ï¼›  
- çº¢è‰²ï¼šæ»‘åŠ¨çª—å£çš„åŒ¹é…è·¯å¾„ã€‚  


#### åŠ¨ç”»æ­¥éª¤ä¸äº¤äº’  
1. **åˆå§‹åŒ–**ï¼š  
   - å±å¹•æ˜¾ç¤ºåƒç´ æ ‘ï¼ˆèŠ‚ç‚¹æ˜¯16x16çš„æ–¹å—ï¼Œè¾¹æ˜¯åƒç´ çº¿ï¼‰ï¼›  
   - æ§åˆ¶é¢æ¿ï¼šå¼€å§‹/æš‚åœã€å•æ­¥ã€é‡ç½®æŒ‰é’®ï¼Œé€Ÿåº¦æ»‘å—ï¼›  
   - 8ä½é£æ ¼èƒŒæ™¯éŸ³ä¹ï¼ˆå¦‚ã€Šè¶…çº§é©¬é‡Œå¥¥ã€‹çš„è½»å¿«æ—‹å¾‹ï¼‰ã€‚  

2. **é€‰é‡å¿ƒ**ï¼š  
   - ä»æ ¹èŠ‚ç‚¹ï¼ˆ1å·ï¼‰å¼€å§‹ï¼Œé»„è‰²æ‰©æ•£åˆ°æ‰€æœ‰èŠ‚ç‚¹ï¼Œæ‰¾åˆ°é‡å¿ƒååœæ­¢ï¼ˆé»„è‰²é«˜äº®ï¼‰ï¼›  
   - æ’­æ”¾â€œå®â€çš„éŸ³æ•ˆï¼Œè¡¨ç¤ºæ‰¾åˆ°é‡å¿ƒã€‚  

3. **å¤„ç†å­æ ‘**ï¼š  
   - ç»¿è‰²é€æ­¥å¡«å……å½“å‰å­æ ‘çš„èŠ‚ç‚¹ï¼Œæ¯ä¸ªèŠ‚ç‚¹æ˜¾ç¤ºâ€œæ·±åº¦-æƒå€¼å’Œâ€ï¼ˆå¦‚â€œ3â†’2â€è¡¨ç¤ºæ·±åº¦3ï¼Œæƒå€¼å’Œ2ï¼‰ï¼›  
   - å•è°ƒé˜Ÿåˆ—ç”¨çº¢è‰²æ¡†æ ‡è®°æ»‘åŠ¨çª—å£çš„èŒƒå›´ï¼ˆå¦‚[2,4]ï¼‰ï¼Œæœ€å¤§å€¼ç”¨ç»¿è‰²ç®­å¤´æŒ‡å‘ã€‚  

4. **åŒ¹é…è·¯å¾„**ï¼š  
   - å½“æ‰¾åˆ°åŒ¹é…çš„è·¯å¾„ï¼ˆå’Œâ‰¥0ï¼‰ï¼Œçº¢è‰²æ¡†é—ªçƒï¼Œæ’­æ”¾â€œèƒœåˆ©â€éŸ³æ•ˆï¼ˆå¦‚ã€Šå¡å°”è¾¾ã€‹çš„è§£è°œéŸ³æ•ˆï¼‰ï¼›  
   - ç­”æ¡ˆè·¯å¾„çš„ç«¯ç‚¹ç”¨çº¢è‰²é«˜äº®ï¼Œæ˜¾ç¤ºâ€œæ‰¾åˆ°æœ€ä¼˜è·¯å¾„ï¼â€ã€‚  


#### äº¤äº’è®¾è®¡  
- **å•æ­¥æ‰§è¡Œ**ï¼šç‚¹å‡»â€œå•æ­¥â€ï¼ŒåŠ¨ç”»æ‰§è¡Œä¸€æ­¥ï¼ˆå¦‚é€‰é‡å¿ƒâ†’å¤„ç†ä¸‹ä¸€ä¸ªå­æ ‘ï¼‰ï¼›  
- **è‡ªåŠ¨æ’­æ”¾**ï¼šè°ƒæ•´é€Ÿåº¦æ»‘å—ï¼ˆ1x~5xï¼‰ï¼ŒåŠ¨ç”»è‡ªåŠ¨æ‰§è¡Œï¼›  
- **é‡ç½®**ï¼šæ¢å¤åˆå§‹çŠ¶æ€ï¼Œé‡æ–°å¼€å§‹ã€‚  


## 6. æ‹“å±•ç»ƒä¹ ä¸ç›¸ä¼¼é—®é¢˜æ€è€ƒ

### é€šç”¨æ€è·¯è¿ç§»  
æœ¬é¢˜çš„æ ¸å¿ƒå¥—è·¯æ˜¯**äºŒåˆ†ç­”æ¡ˆ+ç‚¹åˆ†æ²»**ï¼Œé€‚ç”¨äºæ‰€æœ‰â€œæ ‘ä¸Šè·¯å¾„çš„æå€¼é—®é¢˜â€ï¼ˆå¦‚æœ€å¤§æƒå€¼å’Œã€æœ€é•¿è·¯å¾„ã€ä¸­ä½æ•°è·¯å¾„ï¼‰ã€‚å…³é”®æ˜¯å°†â€œæå€¼é—®é¢˜â€è½¬åŒ–ä¸ºâ€œå¯åˆ¤æ–­çš„æ¡ä»¶â€ï¼ˆå¦‚ä¸­ä½æ•°â†’æƒå€¼å’Œâ‰¥0ï¼‰ï¼Œå†ç”¨ç‚¹åˆ†æ²»é«˜æ•ˆç»Ÿè®¡ã€‚  


### ç»ƒä¹ æ¨èï¼ˆæ´›è°·ï¼‰  
1. **P3806 ã€æ¨¡æ¿ã€‘ç‚¹åˆ†æ²»1**  
   ğŸ—£ï¸ æ¨èç†ç”±ï¼šç‚¹åˆ†æ²»çš„åŸºç¡€æ¨¡æ¿é¢˜ï¼Œç»ƒä¹ â€œç»Ÿè®¡æ ‘ä¸Šè·¯å¾„é•¿åº¦â‰¤kçš„æ•°é‡â€ï¼Œå·©å›ºç‚¹åˆ†æ²»çš„æ¡†æ¶ã€‚  

2. **P4178 Tree**  
   ğŸ—£ï¸ æ¨èç†ç”±ï¼šç»Ÿè®¡æ ‘ä¸Šè·¯å¾„æƒå€¼å’Œâ‰¤kçš„æ•°é‡ï¼Œéœ€è¦ç”¨ç‚¹åˆ†æ²»+åŒæŒ‡é’ˆä¼˜åŒ–ï¼Œè¿›ä¸€æ­¥ç†è§£è·¯å¾„ç»Ÿè®¡ã€‚  

3. **P2634 èªèªå¯å¯**  
   ğŸ—£ï¸ æ¨èç†ç”±ï¼šç»Ÿè®¡æ ‘ä¸Šè·¯å¾„æƒå€¼å’Œèƒ½è¢«3æ•´é™¤çš„æ•°é‡ï¼Œç»ƒä¹ ç‚¹åˆ†æ²»ä¸­çš„æ¨¡è¿ç®—å¤„ç†ã€‚  


## 7. å­¦ä¹ å¿ƒå¾—ä¸ç»éªŒåˆ†äº«  
**å‚è€ƒç»éªŒï¼ˆæ¥è‡ªshadowice1984ï¼‰**ï¼šâ€œäººå‚»å¸¸æ•°å¤§ï¼Œä¸¤ä¸ªlogè·‘ä¸è¿‡3ä¸ªlogâ€¦â€¦â€  
**ç‚¹è¯„**ï¼šç‚¹åˆ†æ²»çš„å¸¸æ•°ä¼˜åŒ–å¾ˆé‡è¦ï¼æ¯”å¦‚ï¼Œç”¨BFSä»£æ›¿DFSå¤„ç†å­æ ‘ï¼ˆé¿å…æ ˆæº¢å‡ºï¼‰ã€æŒ‰å­æ ‘æ·±åº¦æ’åºï¼ˆå‡å°‘å•è°ƒé˜Ÿåˆ—çš„åˆå§‹åŒ–ï¼‰ã€ç”¨æ•°ç»„ä»£æ›¿vectorï¼ˆå‡å°‘åŠ¨æ€å†…å­˜å¼€é”€ï¼‰ï¼Œè¿™äº›ç»†èŠ‚èƒ½è®©ä»£ç è·‘å¾—æ›´å¿«ã€‚  


## 8. æ€»ç»“  
æœ¬æ¬¡åˆ†æçš„â€œFreezing with Styleâ€é¢˜ï¼Œæ ¸å¿ƒæ˜¯**äºŒåˆ†ç­”æ¡ˆ+ç‚¹åˆ†æ²»+å•è°ƒé˜Ÿåˆ—**ã€‚å…³é”®æŠ€å·§æ˜¯ï¼š  
1. å°†ä¸­ä½æ•°é—®é¢˜è½¬åŒ–ä¸ºæƒå€¼å’Œé—®é¢˜ï¼›  
2. ç”¨ç‚¹åˆ†æ²»é«˜æ•ˆç»Ÿè®¡æ ‘è·¯å¾„ï¼›  
3. ç”¨å•è°ƒé˜Ÿåˆ—ä¼˜åŒ–æ»‘åŠ¨çª—å£æŸ¥è¯¢ã€‚  

è®°ä½ï¼šç‚¹åˆ†æ²»çš„æœ¬è´¨æ˜¯â€œåˆ†æ²»+é‡å¿ƒâ€ï¼Œèƒ½å°†æ ‘è·¯å¾„é—®é¢˜çš„å¤æ‚åº¦ä»O(nÂ²)é™åˆ°O(n logÂ²n)ï¼›äºŒåˆ†ç­”æ¡ˆæ˜¯è§£å†³â€œæœ€å¤§/æœ€å°æå€¼é—®é¢˜â€çš„é€šç”¨å·¥å…·ï¼Œå°¤å…¶æ˜¯å½“ç›´æ¥ç»Ÿè®¡å›°éš¾æ—¶ã€‚  


ä¸‹æ¬¡æˆ‘ä»¬å†ä¸€èµ·æ¢ç´¢æ›´å¤æ‚çš„æ ‘ç®—æ³•å§ï¼ğŸ’ª

---
å¤„ç†ç”¨æ—¶ï¼š96.63ç§’
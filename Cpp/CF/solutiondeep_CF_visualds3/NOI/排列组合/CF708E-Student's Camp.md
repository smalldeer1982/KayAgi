# é¢˜ç›®ä¿¡æ¯

# Student's Camp

## é¢˜ç›®æè¿°

Alex studied well and won the trip to student camp Alushta, located on the seashore.

Unfortunately, it's the period of the strong winds now and there is a chance the camp will be destroyed! Camp building can be represented as the rectangle of $ n+2 $ concrete blocks height and $ m $ blocks width.

Every day there is a breeze blowing from the sea. Each block, except for the blocks of the upper and lower levers, such that there is no block to the left of it is destroyed with the probability ![](https://cdn.luogu.com.cn/upload/vjudge_pic/CF708E/422afcf1e06a5628bae49992f52449e3f10a781f.png). Similarly, each night the breeze blows in the direction to the sea. Thus, each block (again, except for the blocks of the upper and lower levers) such that there is no block to the right of it is destroyed with the same probability $ p $ . Note, that blocks of the upper and lower level are indestructible, so there are only $ nÂ·m $ blocks that can be destroyed.

The period of the strong winds will last for $ k $ days and $ k $ nights. If during this period the building will split in at least two connected components, it will collapse and Alex will have to find another place to spend summer.

Find the probability that Alex won't have to look for other opportunities and will be able to spend the summer in this camp.

## è¯´æ˜/æç¤º

In the first sample, each of the four blocks is destroyed with the probability ![](https://cdn.luogu.com.cn/upload/vjudge_pic/CF708E/fda96725ccc697b767e5edbf0d5cfb5ba17d9aa2.png). There are $ 7 $ scenarios that result in building not collapsing, and the probability we are looking for is equal to ![](https://cdn.luogu.com.cn/upload/vjudge_pic/CF708E/dda8ba13f4feb6c7325a04d07cb771a7084c4ba2.png), so you should print ![](https://cdn.luogu.com.cn/upload/vjudge_pic/CF708E/823f9bb4d7539823cd6e4037b4f9a35cb2e52f03.png)

 ![](https://cdn.luogu.com.cn/upload/vjudge_pic/CF708E/2ecb6c84ea76dfa6c7235391533a743f1c25b7f8.png)

## æ ·ä¾‹ #1

### è¾“å…¥

```
2 2
1 2
1
```

### è¾“å‡º

```
937500007
```

## æ ·ä¾‹ #2

### è¾“å…¥

```
5 1
3 10
1
```

### è¾“å‡º

```
95964640
```

## æ ·ä¾‹ #3

### è¾“å…¥

```
3 3
1 10
5
```

### è¾“å‡º

```
927188454
```

# AIåˆ†æç»“æœ

# ğŸ’¡ Kayçš„C++ç®—æ³•è§£æï¼šStudent's Camp æ·±å…¥å­¦ä¹ æŒ‡å— ğŸ’¡

## 1. é¢˜ç›®è§£è¯»ä¸æ ¸å¿ƒç®—æ³•è¯†åˆ«

âœ¨ **æœ¬é¢˜ä¸»è¦è€ƒå¯Ÿ**ï¼šåŠ¨æ€è§„åˆ’ï¼ˆDPï¼‰+ å‰ç¼€å’Œä¼˜åŒ– + ç»„åˆæ•°å­¦åº”ç”¨

ğŸ—£ï¸ **åˆæ­¥åˆ†æ**ï¼š  
è§£å†³è¿™é“é¢˜çš„å…³é”®ï¼Œå°±åƒâ€œæ­ç§¯æœ¨â€â€”â€”æ¯ä¸€å±‚ç§¯æœ¨ï¼ˆè¡Œï¼‰å¿…é¡»å’Œä¸Šä¸€å±‚ç´§ç´§ç›¸è¿ï¼Œå¦åˆ™æ•´ä¸ªç»“æ„ä¼šå€’å¡Œã€‚**åŠ¨æ€è§„åˆ’ï¼ˆDPï¼‰**çš„æ ¸å¿ƒæ€æƒ³å°±æ˜¯æŠŠâ€œæ•´ä¸ªç»“æ„è¿é€šâ€è¿™ä¸ªå¤§é—®é¢˜ï¼Œæ‹†æˆâ€œæ¯ä¸€å±‚ä¸ä¸Šä¸€å±‚è¿é€šâ€çš„å°é—®é¢˜ï¼Œé€šè¿‡è®°å½•æ¯ä¸€å±‚çš„çŠ¶æ€ï¼ˆæ¯”å¦‚å‰©ä¸‹çš„åŒºé—´ï¼‰ï¼Œé€æ­¥æ¨å¯¼ç­”æ¡ˆã€‚  

å…·ä½“æ¥è¯´ï¼Œé¢˜ç›®ä¸­æœ€ä¸Šã€æœ€ä¸‹ä¸¤è¡Œä¸ä¼šæ¶ˆå¤±ï¼Œæ‰€ä»¥ç»“æ„â€œä¸è¿é€šâ€åªèƒ½æ˜¯æŸä¸¤è¡Œçš„åŒºé—´æ²¡æœ‰äº¤é›†ã€‚æˆ‘ä»¬éœ€è¦ç”¨DPè®°å½•**ç¬¬iè¡Œå‰©ä¸‹åŒºé—´[l,r]ä¸”å‰iè¡Œè¿é€šçš„æ¦‚ç‡**ï¼Œå†é€šè¿‡**å‰ç¼€å’Œä¼˜åŒ–**å¿«é€Ÿè®¡ç®—â€œä¸Šä¸€å±‚ä¸å½“å‰åŒºé—´ç›¸äº¤çš„æ€»æ¦‚ç‡â€ï¼ˆé¿å…é‡å¤è®¡ç®—ï¼‰ã€‚  

### æ ¸å¿ƒç®—æ³•æµç¨‹ä¸å¯è§†åŒ–è®¾è®¡æ€è·¯  
1. **çŠ¶æ€è®¾è®¡**ï¼šç”¨`f(i,l,r)`è¡¨ç¤ºç¬¬iè¡Œå‰©ä¸‹[l,r]åŒºé—´ä¸”å‰iè¡Œè¿é€šçš„æ¦‚ç‡ã€‚  
2. **è½¬ç§»é€»è¾‘**ï¼š`f(i,l,r) = ç¬¬iè¡Œå‰©[l,r]çš„æ¦‚ç‡ Ã— (ä¸Šä¸€å±‚æ€»è¿é€šæ¦‚ç‡ - ä¸Šä¸€å±‚ä¸[l,r]ä¸ç›¸äº¤çš„æ¦‚ç‡)`ã€‚  
3. **å‰ç¼€å’Œä¼˜åŒ–**ï¼šç”¨`F(i)`è¡¨ç¤ºä¸Šä¸€å±‚æ€»è¿é€šæ¦‚ç‡ï¼Œ`L(i,x)`è¡¨ç¤ºä¸Šä¸€å±‚åŒºé—´å³ç«¯ç‚¹<xçš„æ¦‚ç‡ï¼Œ`R(i,x)`è¡¨ç¤ºä¸Šä¸€å±‚åŒºé—´å·¦ç«¯ç‚¹>xçš„æ¦‚ç‡ï¼Œé€šè¿‡å‰ç¼€å’Œå¿«é€Ÿè®¡ç®—è¿™äº›å€¼ã€‚  

**å¯è§†åŒ–è®¾è®¡**ï¼š  
- ç”¨8ä½åƒç´ é£æ ¼å±•ç¤ºç½‘æ ¼ï¼Œæ¯ä¸€è¡Œçš„åŒºé—´ç”¨ä¸åŒé¢œè‰²çš„åƒç´ å—è¡¨ç¤ºï¼ˆæ¯”å¦‚è“è‰²ä»£è¡¨å½“å‰è¡Œï¼Œç»¿è‰²ä»£è¡¨ä¸Šä¸€è¡Œï¼‰ã€‚  
- åŠ¨æ€æ¼”ç¤ºæ¯ä¸€è¡Œçš„æ¶ˆå¤±è¿‡ç¨‹ï¼šæ¯å¤©å·¦å³ä¸¤è¾¹çš„åƒç´ å—ä»¥æ¦‚ç‡pâ€œé—ªçƒæ¶ˆå¤±â€ï¼Œä¼´éšâ€œå’»â€çš„éŸ³æ•ˆã€‚  
- è½¬ç§»æ—¶ï¼Œç”¨çº¢è‰²é«˜äº®å½“å‰å¤„ç†çš„åŒºé—´ï¼Œç”¨é»„è‰²é«˜äº®ä¸Šä¸€å±‚ä¸å½“å‰åŒºé—´ç›¸äº¤çš„éƒ¨åˆ†ï¼Œä¼´éšâ€œå®â€çš„éŸ³æ•ˆã€‚  
- æ§åˆ¶é¢æ¿æœ‰â€œå•æ­¥æ‰§è¡Œâ€â€œè‡ªåŠ¨æ’­æ”¾â€æŒ‰é’®ï¼Œé€Ÿåº¦æ»‘å—ï¼Œé‡ç½®åŠŸèƒ½ï¼Œè¿˜æœ‰8ä½é£æ ¼çš„èƒŒæ™¯éŸ³ä¹ï¼ˆæ¯”å¦‚ã€Šè¶…çº§é©¬é‡Œå¥¥ã€‹çš„è½»æ¾æ—‹å¾‹ï¼‰ã€‚


## 2. ç²¾é€‰ä¼˜è´¨é¢˜è§£å‚è€ƒ

### é¢˜è§£ä¸€ï¼šä½œè€…ï¼šçƒ­è¨€çƒ­è¯­ï¼ˆèµï¼š68ï¼‰  
* **ç‚¹è¯„**ï¼šè¿™ä»½é¢˜è§£æ˜¯æœ¬é¢˜çš„â€œæ ‡æ†è§£æ³•â€ï¼Œæ€è·¯æ¸…æ™°åˆ°â€œæ¯ä¸€æ­¥éƒ½èƒ½è·Ÿç€èµ°â€ã€‚å®ƒä»**çŠ¶æ€è®¾è®¡â†’è½¬ç§»ä¼˜åŒ–â†’å‰ç¼€å’Œå¤„ç†**ï¼Œä¸€æ­¥æ­¥æŠŠå¤æ‚åº¦ä»O(nmÂ²)é™åˆ°O(nm)ã€‚å…³é”®äº®ç‚¹æ˜¯ï¼š  
  - ç”¨`f(i,l,r)`è¡¨ç¤ºçŠ¶æ€ï¼Œå†é€šè¿‡å®¹æ–¥ï¼ˆæ€»æ¦‚ç‡ - ä¸ç›¸äº¤æ¦‚ç‡ï¼‰ç®€åŒ–è½¬ç§»ï¼›  
  - å‘ç°`L(i,x)`å’Œ`R(i,x)`å¯¹ç§°ï¼Œåªéœ€è¦å¤„ç†å…¶ä¸­ä¸€ä¸ªï¼›  
  - ç”¨å‰ç¼€å’Œå¿«é€Ÿè®¡ç®—`F(i)`ã€`L(i,x)`ã€`R(i,x)`ï¼ŒæŠŠè½¬ç§»å¤æ‚åº¦é™åˆ°O(1)ã€‚  
  ä»£ç é£æ ¼è§„èŒƒï¼Œå˜é‡åï¼ˆæ¯”å¦‚`F`ã€`L`ã€`R`ï¼‰å«ä¹‰æ˜ç¡®ï¼Œè¾¹ç•Œå¤„ç†ä¸¥è°¨ï¼Œæ˜¯å­¦ä¹ DPä¼˜åŒ–çš„ç»ä½³æ¡ˆä¾‹ã€‚


## 3. æ ¸å¿ƒéš¾ç‚¹è¾¨æä¸è§£é¢˜ç­–ç•¥

### å…³é”®ç‚¹1ï¼šå¦‚ä½•è®¾è®¡çŠ¶æ€ï¼Ÿ  
**éš¾ç‚¹**ï¼šç›´æ¥è®°å½•æ¯ä¸€è¡Œçš„åŒºé—´[l,r]ä¼šå¯¼è‡´çŠ¶æ€æ•°O(nmÂ²)ï¼Œæ— æ³•å¤„ç†n,m=1.5e3çš„æƒ…å†µã€‚  
**ç­–ç•¥**ï¼šç”¨`f(i,l,r)`è¡¨ç¤ºç¬¬iè¡Œå‰©[l,r]ä¸”å‰iè¡Œè¿é€šçš„æ¦‚ç‡ï¼Œå†é€šè¿‡**å‰ç¼€å’Œ**åˆå¹¶çŠ¶æ€ï¼ˆæ¯”å¦‚`F(i)`è¡¨ç¤ºä¸Šä¸€å±‚æ€»è¿é€šæ¦‚ç‡ï¼‰ï¼Œå‡å°‘çŠ¶æ€æ•°ã€‚

### å…³é”®ç‚¹2ï¼šå¦‚ä½•å¤„ç†åŒºé—´ç›¸äº¤çš„æ±‚å’Œï¼Ÿ  
**éš¾ç‚¹**ï¼šç›´æ¥è®¡ç®—â€œä¸Šä¸€å±‚ä¸å½“å‰åŒºé—´ç›¸äº¤çš„æ¦‚ç‡â€éœ€è¦éå†æ‰€æœ‰ä¸Šä¸€å±‚çš„åŒºé—´ï¼Œå¤æ‚åº¦O(mÂ²)ã€‚  
**ç­–ç•¥**ï¼š**å®¹æ–¥åŸç†**â€”â€”ç”¨â€œä¸Šä¸€å±‚æ€»æ¦‚ç‡â€å‡å»â€œä¸Šä¸€å±‚ä¸å½“å‰åŒºé—´ä¸ç›¸äº¤çš„æ¦‚ç‡â€ï¼ˆå³ä¸Šä¸€å±‚åŒºé—´å³ç«¯ç‚¹<å½“å‰lï¼Œæˆ–å·¦ç«¯ç‚¹>å½“å‰rï¼‰ï¼Œå†ç”¨å‰ç¼€å’Œå¿«é€Ÿè®¡ç®—è¿™ä¸¤ä¸ªä¸ç›¸äº¤çš„æ¦‚ç‡ã€‚

### å…³é”®ç‚¹3ï¼šå¦‚ä½•ä¼˜åŒ–å‰ç¼€å’Œè®¡ç®—ï¼Ÿ  
**éš¾ç‚¹**ï¼šç›´æ¥è®¡ç®—`L(i,x)`ï¼ˆä¸Šä¸€å±‚åŒºé—´å³ç«¯ç‚¹<xçš„æ¦‚ç‡ï¼‰éœ€è¦éå†æ‰€æœ‰åŒºé—´ï¼Œå¤æ‚åº¦O(mÂ²)ã€‚  
**ç­–ç•¥**ï¼šç”¨`S_L(i,r)`è¡¨ç¤ºä¸Šä¸€å±‚å³ç«¯ç‚¹ä¸ºrçš„æ¦‚ç‡å’Œï¼Œå†è®¡ç®—`S_L`çš„å‰ç¼€å’Œå¾—åˆ°`L(i,x)`ï¼Œå¤æ‚åº¦O(m)ã€‚


## 4. C++æ ¸å¿ƒä»£ç å®ç°èµæ

### æœ¬é¢˜é€šç”¨æ ¸å¿ƒC++å®ç°å‚è€ƒ  
* **è¯´æ˜**ï¼šç»¼åˆâ€œçƒ­è¨€çƒ­è¯­â€ç­‰ä¼˜è´¨é¢˜è§£çš„æ€è·¯ï¼Œå®ç°ä¸€ä¸ªæ¸…æ™°çš„æ ¸å¿ƒç‰ˆæœ¬ã€‚  
* **å®Œæ•´æ ¸å¿ƒä»£ç **ï¼š  
```cpp
#include <iostream>
#include <vector>
using namespace std;
typedef long long ll;
const int MOD = 1e9+7;
const int MAXN = 1505;
const int MAXK = 1e5;

ll pow_mod(ll a, ll b) {
    ll res = 1;
    while (b) {
        if (b & 1) res = res * a % MOD;
        a = a * a % MOD;
        b >>= 1;
    }
    return res;
}

ll fac[MAXK+5], inv_fac[MAXK+5];
void init_fac(int k) {
    fac[0] = 1;
    for (int i = 1; i <= k; ++i) fac[i] = fac[i-1] * i % MOD;
    inv_fac[k] = pow_mod(fac[k], MOD-2);
    for (int i = k-1; i >= 0; --i) inv_fac[i] = inv_fac[i+1] * (i+1) % MOD;
}

ll C(int n, int k) {
    if (k < 0 || k > n) return 0;
    return fac[n] * inv_fac[k] % MOD * inv_fac[n - k] % MOD;
}

int main() {
    int n, m, a, b, k;
    cin >> n >> m >> a >> b >> k;
    ll p = (ll)a * pow_mod(b, MOD-2) % MOD;
    ll q = (1 - p + MOD) % MOD;
    init_fac(k);
    
    vector<ll> D(k+1);
    for (int i = 0; i <= k; ++i) {
        D[i] = C(k, i) * pow_mod(p, i) % MOD * pow_mod(q, k - i) % MOD;
    }
    
    vector<ll> sum_D(m+2, 0);
    for (int i = 0; i <= m; ++i) sum_D[i+1] = (sum_D[i] + (i <= k ? D[i] : 0)) % MOD;
    
    vector<vector<ll>> f(n+1, vector<ll>(m+2, 0));
    vector<ll> F(n+1, 0), L(n+1, vector<ll>(m+2, 0)), R(n+1, vector<ll>(m+2, 0));
    
    f[0][m] = 1;
    F[0] = 1;
    for (int r = 1; r <= m; ++r) L[0][r+1] = (L[0][r] + f[0][r]) % MOD;
    for (int l = m; l >= 1; --l) R[0][l-1] = (R[0][l] + f[0][l]) % MOD;
    
    for (int i = 1; i <= n; ++i) {
        for (int r = 1; r <= m; ++r) {
            for (int l = 1; l <= r; ++l) {
                ll P = (l-1 <= k ? D[l-1] : 0) * (m - r <= k ? D[m - r] : 0) % MOD;
                ll total = (F[i-1] - L[i-1][l] - R[i-1][r] + 2 * MOD) % MOD;
                f[i][r] = (f[i][r] + P * total) % MOD;
            }
        }
        F[i] = 0;
        for (int r = 1; r <= m; ++r) F[i] = (F[i] + f[i][r]) % MOD;
        for (int r = 1; r <= m; ++r) L[i][r+1] = (L[i][r] + f[i][r]) % MOD;
        for (int l = m; l >= 1; --l) R[i][l-1] = (R[i][l] + f[i][l]) % MOD;
    }
    
    cout << F[n] << endl;
    return 0;
}
```
* **ä»£ç è§£è¯»æ¦‚è¦**ï¼š  
  1. **é¢„å¤„ç†**ï¼šè®¡ç®—ç»„åˆæ•°`C(n,k)`ï¼Œä»¥åŠæ¯ä¸€è¡Œå·¦å³æ¶ˆå¤±iä¸ªçš„æ¦‚ç‡`D(i)`ã€‚  
  2. **åˆå§‹åŒ–**ï¼šç¬¬0è¡Œï¼ˆæœ€ä¸Šé¢ä¸€è¡Œï¼‰çš„åŒºé—´æ˜¯[1,m]ï¼Œæ‰€ä»¥`f[0][m] = 1`ã€‚  
  3. **DPè½¬ç§»**ï¼šéå†æ¯ä¸€è¡Œï¼Œè®¡ç®—å½“å‰è¡Œæ¯ä¸ªåŒºé—´çš„æ¦‚ç‡ï¼Œç”¨å‰ç¼€å’Œ`L`ã€`R`å¿«é€Ÿå¾—åˆ°ä¸ç›¸äº¤çš„æ¦‚ç‡ã€‚  
  4. **ç»“æœ**ï¼š`F[n]`å°±æ˜¯å‰nè¡Œè¿é€šçš„æ¦‚ç‡ï¼Œå³ç­”æ¡ˆã€‚


## 5. ç®—æ³•å¯è§†åŒ–ï¼šåƒç´ åŠ¨ç”»æ¼”ç¤º

### åŠ¨ç”»è®¾è®¡æ–¹æ¡ˆ  
**ä¸»é¢˜**ï¼šåƒç´ æ¢é™©å®¶æ­å»ºâ€œè¿é€šç§¯æœ¨å¡”â€  
**æ ¸å¿ƒæ¼”ç¤ºå†…å®¹**ï¼š  
1. **åœºæ™¯åˆå§‹åŒ–**ï¼š8ä½åƒç´ é£æ ¼çš„ç½‘æ ¼ï¼Œæœ€ä¸Šé¢å’Œæœ€ä¸‹é¢ä¸€è¡Œæ˜¯â€œåœ°åŸºâ€ï¼ˆç°è‰²åƒç´ å—ï¼‰ï¼Œä¸­é—´æ˜¯å¯æ¶ˆå¤±çš„è¡Œï¼ˆç™½è‰²åƒç´ å—ï¼‰ã€‚  
2. **æ¶ˆå¤±è¿‡ç¨‹**ï¼šæ¯å¤©å·¦å³ä¸¤è¾¹çš„ç™½è‰²åƒç´ å—ä»¥æ¦‚ç‡pâ€œé—ªçƒæ¶ˆå¤±â€ï¼ˆå˜æˆé€æ˜ï¼‰ï¼Œä¼´éšâ€œå’»â€çš„éŸ³æ•ˆã€‚  
3. **DPè½¬ç§»**ï¼š  
   - å½“å‰è¡Œçš„åŒºé—´ç”¨è“è‰²åƒç´ å—è¡¨ç¤ºï¼Œä¸Šä¸€è¡Œçš„åŒºé—´ç”¨ç»¿è‰²è¡¨ç¤ºã€‚  
   - è®¡ç®—â€œä¸Šä¸€å±‚æ€»æ¦‚ç‡â€æ—¶ï¼Œç»¿è‰²åƒç´ å—æ•´ä½“é—ªçƒï¼›è®¡ç®—â€œä¸ç›¸äº¤æ¦‚ç‡â€æ—¶ï¼Œçº¢è‰²æ¡†ä½ä¸Šä¸€å±‚ä¸ç›¸äº¤çš„åŒºé—´ã€‚  
   - è½¬ç§»å®Œæˆåï¼Œè“è‰²åƒç´ å—å›ºå®šï¼Œç»¿è‰²åƒç´ å—å˜æˆä¸‹ä¸€å±‚çš„â€œä¸Šä¸€å±‚â€ã€‚  
4. **æˆåŠŸæç¤º**ï¼šå½“æ‰€æœ‰è¡Œè¿é€šæ—¶ï¼Œæ•´ä¸ªç½‘æ ¼é—ªçƒé‡‘è‰²ï¼Œä¼´éšâ€œèƒœåˆ©â€éŸ³æ•ˆï¼ˆæ¯”å¦‚ã€Šå¡å°”è¾¾ä¼ è¯´ã€‹çš„è§£è°œéŸ³æ•ˆï¼‰ã€‚  
**äº¤äº’è®¾è®¡**ï¼š  
- æ§åˆ¶é¢æ¿æœ‰â€œå•æ­¥â€â€œè‡ªåŠ¨â€â€œé‡ç½®â€æŒ‰é’®ï¼Œé€Ÿåº¦æ»‘å—ï¼ˆä»â€œæ…¢â€åˆ°â€œå¿«â€ï¼‰ã€‚  
- è‡ªåŠ¨æ’­æ”¾æ—¶ï¼Œæ¯å®Œæˆä¸€è¡Œï¼Œå¼¹å‡ºâ€œå®Œæˆç¬¬iå±‚ï¼â€çš„åƒç´ æç¤ºæ¡†ã€‚


## 6. æ‹“å±•ç»ƒä¹ ä¸ç›¸ä¼¼é—®é¢˜æ€è€ƒ

### é€šç”¨æ€è·¯è¿ç§»  
æœ¬é¢˜çš„**åŠ¨æ€è§„åˆ’+å‰ç¼€å’Œä¼˜åŒ–**æ€è·¯ï¼Œå¯ä»¥åº”ç”¨äº**åŒºé—´ç›¸å…³çš„è¿é€šæ€§é—®é¢˜**ï¼Œæ¯”å¦‚ï¼š  
- ç½‘æ ¼ä¸­çš„è·¯å¾„è¿é€šé—®é¢˜ï¼ˆæ¯ä¸€æ­¥åªèƒ½èµ°ç›¸é‚»åŒºé—´ï¼‰ï¼›  
- åºåˆ—ä¸­çš„å­åºåˆ—è¿é€šé—®é¢˜ï¼ˆæ¯”å¦‚æœ€é•¿è¿ç»­å­åºåˆ—çš„æ¦‚ç‡ï¼‰ã€‚

### ç»ƒä¹ æ¨èï¼ˆæ´›è°·ï¼‰  
1. **æ´›è°· P1002 [NOIP2002 æ™®åŠç»„] è¿‡æ²³å’**ï¼šç»ƒä¹ åŠ¨æ€è§„åˆ’çš„çŠ¶æ€è®¾è®¡å’Œè½¬ç§»ã€‚  
2. **æ´›è°· P1040 [NOIP2003 æé«˜ç»„] åŠ åˆ†äºŒå‰æ ‘**ï¼šç»ƒä¹ åŠ¨æ€è§„åˆ’çš„åŒºé—´çŠ¶æ€å’Œå‰ç¼€å’Œä¼˜åŒ–ã€‚  
3. **æ´›è°· P1115 æœ€å¤§å­æ®µå’Œ**ï¼šç»ƒä¹ åŠ¨æ€è§„åˆ’çš„ç®€åŒ–å’Œå‰ç¼€å’Œåº”ç”¨ã€‚


## 7. å­¦ä¹ å¿ƒå¾—ä¸ç»éªŒåˆ†äº«ï¼ˆè‹¥æœ‰ï¼‰

**å‚è€ƒç»éªŒï¼ˆæ¥è‡ªâ€œçƒ­è¨€çƒ­è¯­â€ï¼‰**ï¼š  
â€œæœ€åˆæˆ‘ç”¨äº†O(nmÂ²)çš„DPï¼Œç»“æœè¶…æ—¶ã€‚åæ¥æƒ³åˆ°ç”¨å®¹æ–¥å¤„ç†åŒºé—´ç›¸äº¤çš„é—®é¢˜ï¼Œå†ç”¨å‰ç¼€å’Œä¼˜åŒ–æ±‚å’Œï¼Œå¤æ‚åº¦ä¸€ä¸‹é™åˆ°O(nm)ã€‚â€  
**ç‚¹è¯„**ï¼šè¿™è¯´æ˜**é‡åˆ°å¤æ‚çš„æ±‚å’Œé—®é¢˜ï¼Œå…ˆæƒ³å®¹æ–¥ï¼Œå†æƒ³å‰ç¼€å’Œ**æ˜¯è§£å†³DPä¼˜åŒ–çš„å¸¸ç”¨æ€è·¯ã€‚åŠ¨æ‰‹æ¨å¯¼çŠ¶æ€è½¬ç§»å¼ï¼ŒæŠŠå¤§çš„æ±‚å’Œé¡¹æ‹†æˆå°çš„å¯é¢„å¤„ç†é¡¹ï¼Œèƒ½å¤§å¤§ç®€åŒ–é—®é¢˜ã€‚


## æ€»ç»“  
æœ¬æ¬¡åˆ†æäº†â€œStudent's Campâ€çš„åŠ¨æ€è§„åˆ’è§£æ³•ï¼Œæ ¸å¿ƒæ˜¯**çŠ¶æ€è®¾è®¡+å®¹æ–¥+å‰ç¼€å’Œä¼˜åŒ–**ã€‚å¸Œæœ›è¿™ä»½æŒ‡å—èƒ½å¸®åŠ©ä½ æŒæ¡DPä¼˜åŒ–çš„æŠ€å·§ï¼Œä¸‹æ¬¡é‡åˆ°ç±»ä¼¼é—®é¢˜æ—¶ï¼Œèƒ½å¿«é€Ÿæƒ³åˆ°â€œæ‹†çŠ¶æ€ã€ç”¨å®¹æ–¥ã€å‰ç¼€å’Œâ€çš„æ€è·¯ã€‚ç¼–ç¨‹çš„ä¹è¶£åœ¨äºâ€œæ‹†è§£é—®é¢˜â€ï¼Œæ…¢æ…¢æ¥ï¼Œä½ ä¼šè¶Šæ¥è¶Šæ£’ï¼ğŸ’ª

---
å¤„ç†ç”¨æ—¶ï¼š85.04ç§’
# é¢˜ç›®ä¿¡æ¯

# AmShZ Farm

## é¢˜ç›®æè¿°

To AmShZ, all arrays are equal, but some arrays are more-equal than others. Specifically, the arrays consisting of $ n $ elements from $ 1 $ to $ n $ that can be turned into permutations of numbers from $ 1 $ to $ n $ by adding a non-negative integer to each element.

Mashtali who wants to appear in every problem statement thinks that an array $ b $ consisting of $ k $ elements is compatible with a more-equal array $ a $ consisting of $ n $ elements if for each $ 1 \le i \le k $ we have $ 1 \le b_i \le n $ and also $ a_{b_1} = a_{b_2} = \ldots = a_{b_k} $ .

Find the number of pairs of arrays $ a $ and $ b $ such that $ a $ is a more-equal array consisting of $ n $ elements and $ b $ is an array compatible with $ a $ consisting of $ k $ elements modulo $ 998244353 $ .

Note that the elements of $ b $ are not necessarily distinct, same holds for $ a $ .

## è¯´æ˜/æç¤º

There are eight possible pairs for the second example:

1. $ a = \{1, 1\}, b = \{1, 1\} $
2. $ a = \{1, 1\}, b = \{1, 2\} $
3. $ a = \{1, 1\}, b = \{2, 1\} $
4. $ a = \{1, 1\}, b = \{2, 2\} $
5. $ a = \{1, 2\}, b = \{1, 1\} $
6. $ a = \{1, 2\}, b = \{2, 2\} $
7. $ a = \{2, 1\}, b = \{1, 1\} $
8. $ a = \{2, 1\}, b = \{2, 2\} $

## æ ·ä¾‹ #1

### è¾“å…¥

```
1 1```

### è¾“å‡º

```
1```

## æ ·ä¾‹ #2

### è¾“å…¥

```
2 2```

### è¾“å‡º

```
8```

## æ ·ä¾‹ #3

### è¾“å…¥

```
5 4```

### è¾“å‡º

```
50400```

## æ ·ä¾‹ #4

### è¾“å…¥

```
20 100```

### è¾“å‡º

```
807645526```

## æ ·ä¾‹ #5

### è¾“å…¥

```
10000000 10000```

### è¾“å‡º

```
883232350```

# AIåˆ†æç»“æœ

# ğŸ’¡ Kayçš„C++ç®—æ³•è§£æï¼šAmShZ Farm æ·±å…¥å­¦ä¹ æŒ‡å— ğŸ’¡

## 1. é¢˜ç›®è§£è¯»ä¸æ ¸å¿ƒç®—æ³•è¯†åˆ«

âœ¨ **æœ¬é¢˜ä¸»è¦è€ƒå¯Ÿ**ï¼šç»„åˆæ•°å­¦ï¼ˆæ–¯ç‰¹æ—æ•°ã€äºŒé¡¹å¼å®šç†ï¼‰ + ç”Ÿæˆå‡½æ•°ï¼ˆNTTå¿«é€Ÿå·ç§¯ï¼‰

ğŸ—£ï¸ **åˆæ­¥åˆ†æ**ï¼š
è§£å†³è¿™é“é¢˜ï¼Œå°±åƒåœ¨ç©â€œæ•°å­¦ç§¯æœ¨æ‹¼å›¾â€â€”â€”ç»„åˆæ•°å­¦æ˜¯**ç§¯æœ¨å—**ï¼ˆç”¨æ–¯ç‰¹æ—æ•°æ‹†åˆ†æ•°ã€äºŒé¡¹å¼å®šç†åˆå¹¶é¡¹ï¼‰ï¼Œç”Ÿæˆå‡½æ•°ï¼ˆNTTï¼‰æ˜¯**å¿«é€Ÿæ‹¼ç§¯æœ¨çš„å·¥å…·**ã€‚  
- **ç»„åˆæ•°å­¦**ï¼šæˆ‘ä»¬éœ€è¦è®¡ç®—â€œé€‰iä¸ªä½ç½®æ”¾åŒä¸€ä¸ªæ•°ï¼Œè´¡çŒ®i^kâ€çš„æ€»å’Œï¼ˆÎ£C(n,i)i^k n^{n-i}ï¼‰ã€‚ä½†i^kå¾ˆéš¾ç›´æ¥å¤„ç†ï¼Œäºæ˜¯ç”¨**ç¬¬äºŒç±»æ–¯ç‰¹æ—æ•°**ï¼ˆæŠŠkä¸ªä¸åŒçš„çƒæ”¾è¿›iä¸ªç›¸åŒçš„ç›’å­ï¼Œæ–¹æ¡ˆæ•°S(k,i)ï¼‰æŠŠi^kæ‹†æˆÎ£S(k,j)C(i,j)j!ï¼ˆjâ‰¤kï¼‰ï¼Œè¿™æ ·æ±‚å’ŒèŒƒå›´ä»nç¼©å°åˆ°kï¼ˆå› ä¸ºj>kæ—¶S(k,j)=0ï¼‰ã€‚  
- **ç”Ÿæˆå‡½æ•°ï¼ˆNTTï¼‰**ï¼šè®¡ç®—æ–¯ç‰¹æ—æ•°éœ€è¦å·ç§¯ï¼ˆæ¯”å¦‚S(k,j) = Î£(-1)^{j-i}C(j,i)i^k / j!ï¼‰ï¼Œè€ŒNTTæ˜¯â€œå¿«é€Ÿå·ç§¯çš„é­”æ³•â€â€”â€”èƒ½åœ¨O(k log k)æ—¶é—´å†…ç®—å‡ºæ‰€æœ‰S(k,j)ï¼Œé¿å…æš´åŠ›è®¡ç®—çš„O(kÂ²)å¤æ‚åº¦ã€‚  

**é¢˜è§£æ ¸å¿ƒæ€è·¯**ï¼š  
1. **aæ•°ç»„è®¡æ•°**ï¼šé€šè¿‡ç¯æ¨¡å‹ï¼ˆæŠŠaçš„èŒƒå›´æ‹“å±•åˆ°n+1ï¼Œå½¢æˆç¯ï¼‰ï¼Œå¾—å‡ºåˆæ³•açš„æ•°é‡æ˜¯(n+1)^{n-1}ï¼ˆæ¯ä¸ªç‚¹è¢«ç©ºå‡ºçš„æ¦‚ç‡ç›¸åŒï¼‰ã€‚  
2. **bæ•°ç»„è´¡çŒ®**ï¼šåˆ©ç”¨ç¯çš„å¯¹ç§°æ€§ï¼Œæ‰€æœ‰açš„è´¡çŒ®æ€»å’Œé™¤ä»¥n+1å°±æ˜¯ç­”æ¡ˆï¼Œæœ€ç»ˆè½¬åŒ–ä¸ºè®¡ç®—Î£C(n,i)i^k n^{n-i}ã€‚  
3. **åŒ–ç®€æ±‚å’Œ**ï¼šç”¨æ–¯ç‰¹æ—æ•°å±•å¼€i^kï¼Œä»£å…¥åå¾—åˆ°Î£C(n,j)S(k,j)j!(n+1)^{n-j}ï¼ˆjâ‰¤kï¼‰ã€‚  
4. **å¿«é€Ÿè®¡ç®—**ï¼šç”¨NTTæ±‚æ–¯ç‰¹æ—æ•°S(k,j)ï¼Œå†ç”¨å¿«é€Ÿå¹‚ç®—(n+1)^{n-j}ï¼Œæœ€åæ±‚å’Œã€‚  

**æ ¸å¿ƒéš¾ç‚¹**ï¼š  
- å¦‚ä½•é«˜æ•ˆè®¡ç®—å¤§é‡æ–¯ç‰¹æ—æ•°ï¼ˆS(k,j)ï¼‰ï¼Ÿâ†’ ç”¨ç”Ÿæˆå‡½æ•°çš„å·ç§¯+NTTã€‚  
- å¤„ç†å¤§nï¼ˆæ¯”å¦‚n=1e7ï¼‰ä½†kå°ï¼ˆkâ‰¤1e5ï¼‰çš„æƒ…å†µï¼Ÿâ†’ åˆ©ç”¨jâ‰¤kçš„æ€§è´¨ï¼Œåªè®¡ç®—åˆ°j=kã€‚  

**å¯è§†åŒ–è®¾è®¡æ€è·¯**ï¼š  
æˆ‘ä»¬è®¾è®¡ä¸€ä¸ª**åƒç´ å¤šé¡¹å¼å®éªŒå®¤**ï¼Œç”¨ä¸åŒé¢œè‰²çš„åƒç´ å—ä»£è¡¨å¤šé¡¹å¼ç³»æ•°ï¼ˆæ¯”å¦‚f[i]æ˜¯â€œè´Ÿå·ç§¯æœ¨â€ï¼Œg[i]æ˜¯â€œå¹‚æ¬¡ç§¯æœ¨â€ï¼‰ï¼š  
- **åˆå§‹åŒ–**ï¼šä¸¤æ’åƒç´ å—åˆ†åˆ«ä»£è¡¨fï¼ˆçº¢è‰²ï¼Œ(-1)^i/i!ï¼‰å’Œgï¼ˆè“è‰²ï¼Œi^k/i!ï¼‰ã€‚  
- **ä½åè½¬**ï¼šåƒç´ å—æŒ‰ä½åè½¬é¡ºåºé‡æ–°æ’åˆ—ï¼Œä¼´éšâ€œå’”å—’â€éŸ³æ•ˆå’Œæ—‹è½¬åŠ¨ç”»ã€‚  
- **å·ç§¯**ï¼šå¯¹åº”åƒç´ å—ç›¸ä¹˜ï¼Œé¢œè‰²å åŠ ï¼ˆçº¢+è“=ç´«ï¼‰ï¼Œä¼´éšâ€œå®â€çš„éŸ³æ•ˆã€‚  
- **é€†å˜æ¢**ï¼šå¾—åˆ°æ–¯ç‰¹æ—æ•°çš„ç´«è‰²åƒç´ å—ï¼Œç”¨â€œå‘å…‰â€åŠ¨ç”»æç¤ºç»“æœã€‚  


## 2. ç²¾é€‰ä¼˜è´¨é¢˜è§£å‚è€ƒ

### é¢˜è§£ä¸€ï¼šMihariï¼ˆèµï¼š7ï¼‰
* **ç‚¹è¯„**ï¼šæ€è·¯ä»ç¯æ¨¡å‹åˆ°ç»„åˆæ•°æ¨å¯¼ï¼Œå†åˆ°NTTè®¡ç®—æ–¯ç‰¹æ—æ•°ï¼Œæ¯ä¸€æ­¥éƒ½æ¸…æ™°æ˜“æ‡‚ã€‚ä»£ç è§„èŒƒï¼Œå˜é‡å‘½åï¼ˆå¦‚`f`ä»£è¡¨è´Ÿå·å¤šé¡¹å¼ï¼Œ`u`ä»£è¡¨å¹‚æ¬¡å¤šé¡¹å¼ï¼‰ç›´è§‚ï¼ŒNTTéƒ¨åˆ†å°è£…æˆ`poly`å‘½åç©ºé—´ï¼Œå¯è¯»æ€§é«˜ã€‚äº®ç‚¹æ˜¯å°†æ–¯ç‰¹æ—æ•°çš„å·ç§¯å…¬å¼ç›´æ¥è½¬åŒ–ä¸ºä»£ç ï¼Œæ˜¯â€œä»ç†è®ºåˆ°å®ç°â€çš„å…¸èŒƒã€‚


### é¢˜è§£äºŒï¼štzc_wkï¼ˆèµï¼š3ï¼‰
* **ç‚¹è¯„**ï¼šæ¨å¯¼è¿‡ç¨‹è¯¦ç»†ï¼Œä»â€œè´ªå¿ƒæ€æƒ³è½¬åŒ–é—®é¢˜â€åˆ°â€œç¯æ¨¡å‹å¯¹ç§°æ€§â€ï¼Œå†åˆ°â€œç»„åˆæ•°åŒ–ç®€â€ï¼Œæ¯ä¸€æ­¥éƒ½æœ‰ç»„åˆæ„ä¹‰çš„è§£é‡Šã€‚ä»£ç ç®€æ´ï¼Œç”¨`conv`å‡½æ•°å°è£…NTTå·ç§¯ï¼Œé¢„å¤„ç†é˜¶ä¹˜å’Œé€†å…ƒçš„`init_fac`å‡½æ•°é€šç”¨ã€‚äº®ç‚¹æ˜¯å°†å¤æ‚çš„ç»„åˆæ¨å¯¼æ‹†è§£æˆæ˜“æ‡‚çš„æ­¥éª¤ï¼Œé€‚åˆåˆå­¦è€…ç†è§£â€œé—®é¢˜è½¬åŒ–â€çš„é‡è¦æ€§ã€‚


### é¢˜è§£ä¸‰ï¼šwaautoï¼ˆèµï¼š2ï¼‰
* **ç‚¹è¯„**ï¼šä»£ç é«˜æ•ˆï¼Œåˆ©ç”¨é€’æ¨å¼ä¼˜åŒ–è®¡ç®—ï¼ˆ`base`å˜é‡é€’æ¨C(n,j)*(n+1)^{n-j}ï¼‰ï¼Œå°†æ—¶é—´å¤æ‚åº¦ä»O(k log n)é™åˆ°O(k)ã€‚äº®ç‚¹æ˜¯â€œå¼å­æ¨å®Œä»£ç å°±å¥½å†™â€â€”â€”é€šè¿‡æ•°å­¦æ¨å¯¼å°†å¤§nçš„è®¡ç®—è½¬åŒ–ä¸ºå¿«é€Ÿå¹‚å’Œé€’æ¨ï¼Œé€‚åˆå¤„ç†næå¤§ä½†kå°çš„æƒ…å†µã€‚


## 3. æ ¸å¿ƒéš¾ç‚¹è¾¨æä¸è§£é¢˜ç­–ç•¥

### æ ¸å¿ƒéš¾ç‚¹1ï¼šç†è§£more-equal arrayçš„è®¡æ•°ï¼ˆç¯æ¨¡å‹ï¼‰
- **é—®é¢˜**ï¼šå¦‚ä½•å¿«é€Ÿè®¡ç®—åˆæ³•aæ•°ç»„çš„æ•°é‡ï¼Ÿ  
- **è§£å†³ç­–ç•¥**ï¼šå°†açš„èŒƒå›´æ‹“å±•åˆ°n+1ï¼Œå½¢æˆ**ç¯**ï¼ˆæ¯ä¸ªæ•°åŠ 1åå›åˆ°1ï¼‰ã€‚æ­¤æ—¶ï¼Œåˆæ³•açš„æ¡ä»¶ç­‰ä»·äºâ€œç¯ä¸­n+1å·ä½ç½®æœªè¢«å ç”¨â€ã€‚ç”±äºç¯çš„å¯¹ç§°æ€§ï¼Œæ¯ä¸ªä½ç½®æœªè¢«å ç”¨çš„æ¦‚ç‡ç›¸åŒï¼Œå› æ­¤åˆæ³•açš„æ•°é‡æ˜¯æ€»åºåˆ—æ•°ï¼ˆ(n+1)^nï¼‰é™¤ä»¥n+1ï¼Œå³(n+1)^{n-1}ã€‚


### æ ¸å¿ƒéš¾ç‚¹2ï¼šå¤„ç†i^kçš„æ±‚å’Œï¼ˆå¤§kå°nï¼‰
- **é—®é¢˜**ï¼šç›´æ¥è®¡ç®—i^kï¼ˆiä»0åˆ°nï¼‰ä¼šè¶…æ—¶ï¼Œå°¤å…¶æ˜¯å½“k=1e5æ—¶ã€‚  
- **è§£å†³ç­–ç•¥**ï¼šç”¨**ç¬¬äºŒç±»æ–¯ç‰¹æ—æ•°**å±•å¼€i^kï¼š  
  $$i^k = \sum_{j=0}^i S(k,j) C(i,j) j!$$  
  å…¶ä¸­S(k,j)æ˜¯â€œå°†kä¸ªä¸åŒçš„çƒæ”¾è¿›jä¸ªç›¸åŒçš„ç›’å­ï¼ˆæ— ç©ºç›’ï¼‰â€çš„æ–¹æ¡ˆæ•°ã€‚è¿™æ ·æ±‚å’ŒèŒƒå›´ä»nç¼©å°åˆ°kï¼ˆå› ä¸ºj>kæ—¶S(k,j)=0ï¼‰ã€‚


### æ ¸å¿ƒéš¾ç‚¹3ï¼šé«˜æ•ˆè®¡ç®—æ–¯ç‰¹æ—æ•°ï¼ˆå¤§kï¼‰
- **é—®é¢˜**ï¼šæš´åŠ›è®¡ç®—S(k,j)éœ€è¦O(kÂ²)æ—¶é—´ï¼Œæ— æ³•å¤„ç†k=1e5çš„æƒ…å†µã€‚  
- **è§£å†³ç­–ç•¥**ï¼šç”¨**ç”Ÿæˆå‡½æ•°å·ç§¯**è®¡ç®—æ–¯ç‰¹æ—æ•°ã€‚æ ¹æ®å…¬å¼ï¼š  
  $$S(k,j) = \frac{1}{j!} \sum_{i=0}^j (-1)^{j-i} C(j,i) i^k$$  
  ä»¤$f(i) = (-1)^i / i!$ï¼Œ$g(i) = i^k / i!$ï¼Œåˆ™S(k,j) = (f * g)[j]ï¼ˆ*ä»£è¡¨å·ç§¯ï¼‰ã€‚ç”¨NTTå¿«é€Ÿè®¡ç®—å·ç§¯ï¼Œæ—¶é—´å¤æ‚åº¦O(k log k)ã€‚


### âœ¨ è§£é¢˜æŠ€å·§æ€»ç»“
1. **æ¨¡å‹è½¬åŒ–**ï¼šå°†çº¿æ€§é—®é¢˜è½¬åŒ–ä¸ºç¯å½¢ï¼Œåˆ©ç”¨å¯¹ç§°æ€§ç®€åŒ–è®¡æ•°ï¼ˆå¦‚æœ¬é¢˜çš„ç¯æ¨¡å‹ï¼‰ã€‚  
2. **æ–¯ç‰¹æ—æ•°å±•å¼€**ï¼šé‡åˆ°i^kçš„æ±‚å’Œï¼Œä¼˜å…ˆç”¨æ–¯ç‰¹æ—æ•°æ‹†åˆ†æˆç»„åˆæ•°å’Œé˜¶ä¹˜çš„ä¹˜ç§¯ï¼Œç¼©å°æ±‚å’ŒèŒƒå›´ã€‚  
3. **NTTåº”ç”¨**ï¼šéœ€è¦è®¡ç®—å·ç§¯æ—¶ï¼Œä¼˜å…ˆè€ƒè™‘NTTï¼ˆå°¤å…¶æ˜¯kâ‰¤1e5æ—¶ï¼‰ï¼Œé¿å…æš´åŠ›æšä¸¾ã€‚  


## 4. C++æ ¸å¿ƒä»£ç å®ç°èµæ

### æœ¬é¢˜é€šç”¨æ ¸å¿ƒC++å®ç°å‚è€ƒ
* **è¯´æ˜**ï¼šç»¼åˆMihariã€tzc_wkã€waautoçš„æ€è·¯ï¼Œæä¾›ä¸€ä¸ªæ¸…æ™°çš„æ ¸å¿ƒå®ç°ï¼ˆå¤„ç†kâ‰¤1e5ï¼Œnâ‰¤1e7ï¼‰ã€‚
* **å®Œæ•´æ ¸å¿ƒä»£ç **ï¼š
```cpp
#include <iostream>
#include <vector>
#include <algorithm>
using namespace std;

typedef long long ll;
const int MOD = 998244353;
const int G = 3; // åŸæ ¹
const int MAXK = 1e5 + 10;

ll qpow(ll a, ll b) {
    ll res = 1;
    for (; b; b >>= 1, a = a * a % MOD)
        if (b & 1) res = res * a % MOD;
    return res;
}

namespace NTT {
    vector<int> rev;
    void init_rev(int n) {
        rev.resize(n);
        for (int i = 0; i < n; ++i)
            rev[i] = (rev[i >> 1] >> 1) | ((i & 1) ? (n >> 1) : 0);
    }
    void ntt(vector<ll> &a, bool inv) {
        int n = a.size();
        for (int i = 0; i < n; ++i)
            if (i < rev[i]) swap(a[i], a[rev[i]]);
        for (int len = 2; len <= n; len <<= 1) {
            ll wn = qpow(G, (MOD - 1) / len);
            if (inv) wn = qpow(wn, MOD - 2);
            for (int i = 0; i < n; i += len) {
                ll w = 1;
                for (int j = 0; j < len / 2; ++j, w = w * wn % MOD) {
                    ll x = a[i + j], y = w * a[i + j + len/2] % MOD;
                    a[i + j] = (x + y) % MOD;
                    a[i + j + len/2] = (x - y + MOD) % MOD;
                }
            }
        }
        if (inv) {
            ll inv_n = qpow(n, MOD - 2);
            for (ll &x : a) x = x * inv_n % MOD;
        }
    }
    vector<ll> conv(vector<ll> a, vector<ll> b) {
        int n = 1;
        while (n < a.size() + b.size()) n <<= 1;
        a.resize(n), b.resize(n);
        init_rev(n);
        ntt(a, false), ntt(b, false);
        for (int i = 0; i < n; ++i) a[i] = a[i] * b[i] % MOD;
        ntt(a, true);
        return a;
    }
}

ll fac[MAXK], inv_fac[MAXK];

void precompute(int k) {
    fac[0] = 1;
    for (int i = 1; i <= k; ++i)
        fac[i] = fac[i-1] * i % MOD;
    inv_fac[k] = qpow(fac[k], MOD - 2);
    for (int i = k-1; i >= 0; --i)
        inv_fac[i] = inv_fac[i+1] * (i+1) % MOD;
}

int main() {
    int n, k;
    cin >> n >> k;
    precompute(k);

    // è®¡ç®—f(i) = (-1)^i / i!, g(i) = i^k / i!
    vector<ll> f(k+1), g(k+1);
    for (int i = 0; i <= k; ++i) {
        f[i] = (i % 2 == 0 ? 1 : MOD - 1) * inv_fac[i] % MOD;
        g[i] = qpow(i, k) * inv_fac[i] % MOD;
    }

    // å·ç§¯å¾—åˆ°æ–¯ç‰¹æ—æ•°S(k, j) = (f*g)[j]
    vector<ll> stirling = NTT::conv(f, g);

    // è®¡ç®—ç­”æ¡ˆï¼šsum_{j=0}^k C(n,j) * S(k,j) * j! * (n+1)^(n-j)
    ll ans = 0;
    ll C = 1; // C(n, j)ï¼Œé€’æ¨è®¡ç®—
    ll pow_n1 = qpow(n+1, n); // (n+1)^n
    ll inv_n1 = qpow(n+1, MOD - 2); // 1/(n+1)
    for (int j = 0; j <= k; ++j) {
        if (j > n) break; // C(n,j)=0å½“j>n
        // C(n,j) = C(n,j-1) * (n-j+1)/jï¼Œè¿™é‡Œjä»0å¼€å§‹ï¼ŒC(0)=1
        if (j > 0) C = C * (n - j + 1) % MOD * qpow(j, MOD - 2) % MOD;
        // (n+1)^(n-j) = (n+1)^n / (n+1)^j = pow_n1 * inv_n1^j
        ll term = C * stirling[j] % MOD;
        term = term * fac[j] % MOD;
        term = term * pow_n1 % MOD;
        ans = (ans + term) % MOD;
        // ä¸‹ä¸€æ¬¡çš„pow_n1 = pow_n1 * inv_n1
        pow_n1 = pow_n1 * inv_n1 % MOD;
    }

    cout << ans << endl;
    return 0;
}
```
* **ä»£ç è§£è¯»æ¦‚è¦**ï¼š  
  1. **é¢„å¤„ç†**ï¼šè®¡ç®—é˜¶ä¹˜`fac`å’Œé€†é˜¶ä¹˜`inv_fac`ï¼ˆç”¨äºæ–¯ç‰¹æ—æ•°çš„ç”Ÿæˆå‡½æ•°ï¼‰ã€‚  
  2. **ç”Ÿæˆå‡½æ•°æ„é€ **ï¼šæ„é€ `f`ï¼ˆè´Ÿå·å¤šé¡¹å¼ï¼‰å’Œ`g`ï¼ˆå¹‚æ¬¡å¤šé¡¹å¼ï¼‰ã€‚  
  3. **NTTå·ç§¯**ï¼šè®¡ç®—`f*g`å¾—åˆ°æ–¯ç‰¹æ—æ•°`stirling[j]`ã€‚  
  4. **æ±‚å’Œ**ï¼šé€’æ¨è®¡ç®—ç»„åˆæ•°`C(n,j)`å’Œå¹‚æ¬¡`(n+1)^(n-j)`ï¼Œç´¯åŠ å¾—åˆ°ç­”æ¡ˆã€‚


### é¢˜è§£ä¸€æ ¸å¿ƒç‰‡æ®µèµæï¼ˆMihariï¼‰
* **äº®ç‚¹**ï¼šå°†æ–¯ç‰¹æ—æ•°çš„å·ç§¯å…¬å¼ç›´æ¥è½¬åŒ–ä¸ºä»£ç ï¼ŒNTTå°è£…æˆ`poly`å‘½åç©ºé—´ï¼Œå¯è¯»æ€§é«˜ã€‚
* **æ ¸å¿ƒä»£ç ç‰‡æ®µ**ï¼š
```cpp
// è®¡ç®—få’Œgå¤šé¡¹å¼
rep(i, 0, k){
    f[i]=(i&1)? (mod-finv[i]): finv[i];
    u[i]=1ll*qkpow(i, k)*finv[i]%mod;
}
// NTTå·ç§¯
poly::prepare(k*2+5);
poly::ntt(f, 0); poly::ntt(u, 0);
rep(i, 0, poly::n-1) f[i]=1ll*f[i]*u[i]%mod;
poly::ntt(f, 1);
```
* **ä»£ç è§£è¯»**ï¼š  
  - `f[i]`æ˜¯`(-1)^i / i!`ï¼šç”¨`(i&1)`åˆ¤æ–­å¥‡å¶ï¼Œå¥‡æ•°åˆ™å–æ¨¡åï¼ˆ`mod-finv[i]`ï¼‰ã€‚  
  - `u[i]`æ˜¯`i^k / i!`ï¼šç”¨`qkpow(i, k)`è®¡ç®—içš„kæ¬¡å¹‚ï¼Œä¹˜ä»¥é€†é˜¶ä¹˜ã€‚  
  - `poly::ntt(f, 0)`ï¼šå¯¹fåšNTTæ­£å˜æ¢ï¼›`poly::ntt(f, 1)`ï¼šé€†å˜æ¢å¾—åˆ°å·ç§¯ç»“æœï¼ˆæ–¯ç‰¹æ—æ•°ï¼‰ã€‚
* **å­¦ä¹ ç¬”è®°**ï¼šç”Ÿæˆå‡½æ•°çš„æ„é€ æ˜¯è®¡ç®—æ–¯ç‰¹æ—æ•°çš„å…³é”®ï¼Œè¦ç‰¢è®°`f`å’Œ`g`çš„å®šä¹‰ã€‚


### é¢˜è§£ä¸‰æ ¸å¿ƒç‰‡æ®µèµæï¼ˆwaautoï¼‰
* **äº®ç‚¹**ï¼šç”¨é€’æ¨å¼ä¼˜åŒ–`C(n,j)*(n+1)^(n-j)`çš„è®¡ç®—ï¼Œå°†æ—¶é—´å¤æ‚åº¦ä»O(k log n)é™åˆ°O(k)ã€‚
* **æ ¸å¿ƒä»£ç ç‰‡æ®µ**ï¼š
```cpp
ll base = n * qpow(n + 1, n - 1) % MOD;
ll inv = qpow(n + 1, P - 2);
for (ll i = 1; i <= min(n, k); i++) {
    ans = (ans + S2[i] * base) % MOD;
    base = base * inv % MOD * (n - i) % MOD;
}
```
* **ä»£ç è§£è¯»**ï¼š  
  - `base`åˆå§‹ä¸º`n*(n+1)^(n-1)`ï¼šå¯¹åº”j=1æ—¶çš„é¡¹ï¼ˆ`C(n,1)*(n+1)^(n-1)`ï¼‰ã€‚  
  - æ¯æ¬¡è¿­ä»£ï¼š`base = base * inv * (n-i)`ï¼š  
    - `inv`æ˜¯`1/(n+1)`ï¼Œå¯¹åº”`(n+1)^(n-j)`å˜ä¸º`(n+1)^(n-(j+1))`ã€‚  
    - `(n-i)`å¯¹åº”`C(n,j+1) = C(n,j) * (n-j)/(j+1)`ä¸­çš„`(n-j)`ï¼ˆè¿™é‡Œj=iï¼‰ã€‚  
* **å­¦ä¹ ç¬”è®°**ï¼šé€’æ¨å¼æ˜¯å¤„ç†å¤§nå°ké—®é¢˜çš„åˆ©å™¨ï¼Œè¦å–„äºåˆ©ç”¨æ•°å­¦å¼å­çš„é€’æ¨æ€§è´¨ã€‚


## 5. ç®—æ³•å¯è§†åŒ–ï¼šåƒç´ å¤šé¡¹å¼å®éªŒå®¤

### åŠ¨ç”»æ¼”ç¤ºæ–¹æ¡ˆ
**ä¸»é¢˜**ï¼šåƒç´ ç§‘å­¦å®¶åœ¨å®éªŒå®¤é‡Œç”¨NTTâ€œåˆæˆâ€æ–¯ç‰¹æ—æ•°ã€‚  
**æ ¸å¿ƒå†…å®¹**ï¼šæ¼”ç¤ºç”Ÿæˆå‡½æ•°ä»æ„é€ åˆ°å·ç§¯çš„å…¨è¿‡ç¨‹ï¼Œç»“åˆå¤å¤æ¸¸æˆå…ƒç´ ã€‚  

### è®¾è®¡ç»†èŠ‚
1. **åœºæ™¯ä¸UI**ï¼š  
   - 8ä½åƒç´ é£æ ¼çš„å®éªŒå®¤ï¼ŒèƒŒæ™¯æ˜¯å¤å¤ç”µè„‘å±å¹•ï¼Œæ˜¾ç¤ºä¸¤ä¸ªå¤šé¡¹å¼`f`ï¼ˆçº¢è‰²æ–¹å—ï¼‰å’Œ`g`ï¼ˆè“è‰²æ–¹å—ï¼‰ã€‚  
   - æ§åˆ¶é¢æ¿ï¼š`å•æ­¥`ã€`è‡ªåŠ¨`ã€`é‡ç½®`æŒ‰é’®ï¼›é€Ÿåº¦æ»‘å—ï¼ˆ1x~5xï¼‰ï¼›`å¤šé¡¹å¼ç³»æ•°`æ˜¾ç¤ºåŒºã€‚  

2. **åŠ¨ç”»æ­¥éª¤**ï¼š  
   - **åˆå§‹åŒ–**ï¼šçº¢è‰²æ–¹å—æ’æˆä¸€æ’ï¼ˆf[i]ï¼‰ï¼Œè“è‰²æ–¹å—æ’æˆå¦ä¸€æ’ï¼ˆg[i]ï¼‰ï¼Œä¼´éšâ€œæ»´æ»´â€å¼€æœºéŸ³æ•ˆã€‚  
   - **ä½åè½¬**ï¼šæ–¹å—æŒ‰ä½åè½¬é¡ºåºç§»åŠ¨ï¼Œæ¯”å¦‚i=3ï¼ˆ11ï¼‰â†’i=6ï¼ˆ110ï¼‰ï¼Œä¼´éšâ€œå’”å—’â€éŸ³æ•ˆå’Œæ—‹è½¬åŠ¨ç”»ã€‚  
   - **è´è¶æ“ä½œ**ï¼šæ¯ä¸€å±‚çš„ä¸¤ä¸ªæ–¹å—äº¤æ¢å¹¶ç›¸ä¹˜ï¼Œé¢œè‰²å åŠ ï¼ˆçº¢+è“=ç´«ï¼‰ï¼Œä¼´éšâ€œå®â€çš„éŸ³æ•ˆã€‚  
   - **å·ç§¯ç»“æœ**ï¼šç´«è‰²æ–¹å—æ’æˆä¸€æ’ï¼ˆæ–¯ç‰¹æ—æ•°ï¼‰ï¼Œæ—è¾¹æ˜¾ç¤º`S(k,j) = ...`çš„æ–‡å­—æç¤ºï¼Œä¼´éšâ€œå—¡â€çš„æˆåŠŸéŸ³æ•ˆã€‚  

3. **äº¤äº’è®¾è®¡**ï¼š  
   - **å•æ­¥**ï¼šç‚¹å‡»ä¸€æ¬¡æ‰§è¡Œä¸€æ­¥è´è¶æ“ä½œï¼Œæ–¹ä¾¿è§‚å¯Ÿæ¯ä¸€æ­¥å˜åŒ–ã€‚  
   - **è‡ªåŠ¨**ï¼šæŒ‰é€‰å®šé€Ÿåº¦æ’­æ”¾åŠ¨ç”»ï¼Œé€Ÿåº¦æ»‘å—è°ƒèŠ‚å¿«æ…¢ã€‚  
   - **é‡ç½®**ï¼šæ¢å¤åˆå§‹çŠ¶æ€ï¼Œé‡æ–°å¼€å§‹æ¼”ç¤ºã€‚  

4. **æ¸¸æˆåŒ–å…ƒç´ **ï¼š  
   - **è¿‡å…³å¥–åŠ±**ï¼šå®Œæˆå·ç§¯åï¼Œå±å¹•æ˜¾ç¤ºâ€œæ–¯ç‰¹æ—æ•°åˆæˆæˆåŠŸï¼â€ï¼Œä¼´éšä¸Šæ‰¬çš„â€œèƒœåˆ©â€éŸ³æ•ˆã€‚  
   - **ç§¯åˆ†ç³»ç»Ÿ**ï¼šæ¯å®Œæˆä¸€æ¬¡æ¼”ç¤ºå¾—10åˆ†ï¼Œè¿ç»­å®Œæˆ3æ¬¡å¾—â€œNTTå¤§å¸ˆâ€ç§°å·ã€‚  


## 6. æ‹“å±•ç»ƒä¹ ä¸ç›¸ä¼¼é—®é¢˜æ€è€ƒ

### é€šç”¨æ€è·¯è¿ç§»
æœ¬é¢˜çš„æ ¸å¿ƒæ˜¯**â€œç”¨ç”Ÿæˆå‡½æ•°å¤„ç†ç»„åˆæ•°æ±‚å’Œâ€**ï¼Œé€‚ç”¨äºä»¥ä¸‹åœºæ™¯ï¼š  
1. è®¡ç®—Î£C(n,i)i^k x^{n-i}ï¼ˆå¦‚æœ¬é¢˜ï¼‰ã€‚  
2. è®¡ç®—ç¬¬äºŒç±»æ–¯ç‰¹æ—æ•°çš„è¡Œï¼ˆå¦‚æ´›è°·P5395ï¼‰ã€‚  
3. è®¡ç®—å¤šé¡¹å¼å±•å¼€åçš„æŸä¸€é¡¹ç³»æ•°ï¼ˆå¦‚æ´›è°·P3803ï¼‰ã€‚  


### æ´›è°·ç»ƒä¹ æ¨è
1. **P5395 ç¬¬äºŒç±»æ–¯ç‰¹æ—æ•°Â·è¡Œ**ï¼šç›´æ¥è®¡ç®—S(k,j)ï¼Œå·©å›ºç”Ÿæˆå‡½æ•°+NTTçš„åº”ç”¨ã€‚  
2. **P3803 å¤šé¡¹å¼ä¹˜æ³•**ï¼šNTTçš„åŸºç¡€ç»ƒä¹ ï¼Œç†Ÿæ‚‰å·ç§¯çš„å®ç°ã€‚  
3. **P4721 ç”Ÿæˆå‡½æ•°+NTT**ï¼šè®¡ç®—ç»„åˆæ•°æ±‚å’Œï¼Œæ‹“å±•æœ¬é¢˜çš„æ€è·¯ã€‚  
4. **CF1528F AmShZ Farm**ï¼šåŸé¢˜ï¼Œå·©å›ºç¯æ¨¡å‹å’Œç»„åˆæ•°æ¨å¯¼ã€‚  


## 7. å­¦ä¹ å¿ƒå¾—ä¸ç»éªŒåˆ†äº«
- **Mihari**ï¼šâ€œç¯æ¨¡å‹æ˜¯ç¬¬äºŒæ¬¡è§äº†â€â€”â€”ç»„åˆæ•°å­¦çš„æ¨¡å‹éœ€è¦ç§¯ç´¯ï¼Œæ¯”å¦‚â€œçº¿æ€§è½¬ç¯å½¢â€çš„æŠ€å·§ã€‚  
- **tzc_wk**ï¼šâ€œè´ªå¿ƒæ€æƒ³è½¬åŒ–é—®é¢˜â€â€”â€”é‡åˆ°å¤æ‚æ¡ä»¶ï¼ˆå¦‚aæ•°ç»„çš„åˆæ³•æ€§ï¼‰ï¼Œä¼˜å…ˆç”¨è´ªå¿ƒæˆ–ç­‰ä»·æ¨¡å‹è½¬åŒ–ã€‚  
- **waauto**ï¼šâ€œå¼å­æ¨å®Œäº†ä»£ç å°±å¥½å†™äº†â€â€”â€”æ•°å­¦æ¨å¯¼æ˜¯ä»£ç çš„åŸºç¡€ï¼Œè¦å…ˆæ¨å¯¼å‡ºç®€æ´çš„å¼å­å†å†™ä»£ç ã€‚  


## æ€»ç»“
æœ¬æ¬¡åˆ†æçš„æ ¸å¿ƒæ˜¯**ç»„åˆæ•°å­¦ä¸ç”Ÿæˆå‡½æ•°çš„ç»“åˆ**ï¼šé€šè¿‡ç¯æ¨¡å‹ç®€åŒ–è®¡æ•°ï¼Œç”¨æ–¯ç‰¹æ—æ•°å±•å¼€å¹‚æ¬¡ï¼Œç”¨NTTå¿«é€Ÿè®¡ç®—å·ç§¯ï¼Œæœ€åæ±‚å’Œå¾—åˆ°ç»“æœã€‚å¸Œæœ›å¤§å®¶é€šè¿‡æœ¬é¢˜æŒæ¡â€œæ¨¡å‹è½¬åŒ–â†’æ•°å­¦æ¨å¯¼â†’ç”Ÿæˆå‡½æ•°å®ç°â€çš„è§£é¢˜æµç¨‹ï¼Œä¸‹æ¬¡é‡åˆ°ç±»ä¼¼é—®é¢˜æ—¶èƒ½ä¸¾ä¸€åä¸‰ï¼ğŸ’ª

---
å¤„ç†ç”¨æ—¶ï¼š131.62ç§’
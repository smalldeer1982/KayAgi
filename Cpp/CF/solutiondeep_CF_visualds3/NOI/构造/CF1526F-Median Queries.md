# é¢˜ç›®ä¿¡æ¯

# Median Queries

## é¢˜ç›®æè¿°

This is an interactive problem.

There is a secret permutation $ p $ ( $ 1 $ -indexed) of numbers from $ 1 $ to $ n $ . More formally, for $ 1 \leq i \leq n $ , $ 1 \leq p[i] \leq n $ and for $ 1 \leq i < j \leq n $ , $ p[i] \neq p[j] $ . It is known that $ p[1]<p[2] $ .

In $ 1 $ query, you give $ 3 $ distinct integers $ a,b,c $ ( $ 1 \leq a,b,c \leq n $ ), and receive the median of $ \{|p[a]-p[b]|,|p[b]-p[c]|,|p[a]-p[c]|\} $ .

In this case, the median is the $ 2 $ -nd element ( $ 1 $ -indexed) of the sequence when sorted in non-decreasing order. The median of $ \{4,6,2\} $ is $ 4 $ and the median of $ \{0,123,33\} $ is $ 33 $ .

Can you find the secret permutation in not more than $ 2n+420 $ queries?

Note: the grader is not adaptive: the permutation is fixed before any queries are made.

## è¯´æ˜/æç¤º

The secret permutation is $ \{9,10,19,7,16,18,11,14,15,6,20,8,17,4,5,3,12,2,13,1\} $ .

For the first query, the values of $ (a,b,c) $ is $ (1,5,2) $ . Since $ p[1]=9 $ , $ p[5]=16 $ and $ p[2]=10 $ . The return value is the median of $ \{|9-16|,|16-10|,|9-10|\} $ which is $ 6 $ .

For the second query, the values of $ (a,b,c) $ is $ (20,19,2) $ . Since $ p[20]=1 $ , $ p[19]=13 $ and $ p[2]=10 $ . The return value is the median of $ \{|1-13|,|13-10|,|1-10|\} $ which is $ 9 $ .

By some miracle, we have figured out that the secret permutation is $ \{9,10,19,7,16,18,11,14,15,6,20,8,17,4,5,3,12,2,13,1\} $ . We output it and receive $ 1 $ from the interactor, meaning that we have guessed the secret permutation correctly.

## æ ·ä¾‹ #1

### è¾“å…¥

```
1
20

6

9

1```

### è¾“å‡º

```
? 1 5 2

? 20 19 2

! 9 10 19 7 16 18 11 14 15 6 20 8 17 4 5 3 12 2 13 1```

# AIåˆ†æç»“æœ

# ğŸ’¡ Kayçš„C++ç®—æ³•è§£æï¼šMedian Queries æ·±å…¥å­¦ä¹ æŒ‡å— ğŸ’¡


## 1. é¢˜ç›®è§£è¯»ä¸æ ¸å¿ƒç®—æ³•è¯†åˆ«

âœ¨ **æœ¬é¢˜ä¸»è¦è€ƒå¯Ÿ**ï¼šç¼–ç¨‹æŠ€å·§åº”ç”¨ï¼ˆäº¤äº’å¼é—®é¢˜å¤„ç†+éšæœºåŒ–ç­–ç•¥ï¼‰+ æ•°å­¦ï¼ˆè·ç¦»æ€§è´¨åˆ†æï¼‰

ğŸ—£ï¸ **åˆæ­¥åˆ†æ**ï¼š  
ä½ å¯ä»¥æŠŠè¿™é“é¢˜æƒ³è±¡æˆä¸€åœºã€Œ**åƒç´ ä¾¦æ¢çŒœæ’åˆ—**ã€çš„æ¸¸æˆâ€”â€”æˆ‘ä»¬éœ€è¦é€šè¿‡å‘â€œè£åˆ¤â€ï¼ˆäº¤äº’å™¨ï¼‰æé—®ï¼ˆé€‰ä¸‰ä¸ªä½ç½®é—®ä¸­ä½æ•°ï¼‰ï¼Œè¿˜åŸä¸€ä¸ªéšè—çš„æ’åˆ—ã€‚æ ¸å¿ƒæŠ€å·§æ˜¯**â€œç”¨èªæ˜çš„æé—®æ›¿ä»£ç›²çŒœâ€**ï¼šåˆ©ç”¨æ’åˆ—çš„æ€§è´¨æŠŠâ€œä¸­ä½æ•°â€è½¬åŒ–ä¸ºâ€œä¸¤ä¸ªè·ç¦»çš„æœ€å¤§å€¼â€ï¼Œå†é€šè¿‡**éšæœºåŒ–å¿«é€Ÿæ‰¾åˆ°ä¸€å¯¹â€œç¦»å¾—å¾ˆè¿‘çš„ä½ç½®â€**ï¼Œä»¥æ­¤ä¸ºé”šç‚¹â€œé¡ºè—¤æ‘¸ç“œâ€æ‰¾å‡ºæ•´ä¸ªæ’åˆ—ã€‚  

### æ ¸å¿ƒç®—æ³•é€»è¾‘
1. **é—®é¢˜è½¬åŒ–**ï¼šå¦‚æœä¸‰ä¸ªä½ç½®å¯¹åº”çš„å€¼æ»¡è¶³ \(p_a < p_b < p_c\)ï¼Œé‚£ä¹ˆè¯¢é—®è¿™ä¸‰ä¸ªä½ç½®å¾—åˆ°çš„ä¸­ä½æ•°å°±æ˜¯ \(\max(p_b-p_a, p_c-p_b)\)ï¼ˆæ¯”å¦‚ä¸‰ä¸ªæ•°å·®æ˜¯2ã€3ã€5ï¼Œä¸­ä½æ•°æ˜¯3ï¼Œæ­£å¥½æ˜¯æœ€å¤§çš„ç›¸é‚»å·®ï¼‰ã€‚  
2. **é”šç‚¹ç­–ç•¥**ï¼šå¦‚æœèƒ½æ‰¾åˆ°ä¸¤ä¸ªä½ç½® \(i,j\) ä½¿å¾— \(|p_i-p_j|\) å¾ˆå°ï¼ˆæ¯”å¦‚å°äº \(n/6\)ï¼‰ï¼Œé‚£ä¹ˆç”¨è¿™ä¸¤ä¸ªä½ç½®è¯¢é—®æ‰€æœ‰å…¶ä»–ä½ç½®ï¼Œå¾—åˆ°çš„**æœ€å¤§è·ç¦»**å¯¹åº”çš„å€¼ä¸€å®šæ˜¯1æˆ–nï¼Œ**æ¬¡å¤§è·ç¦»**å¯¹åº”çš„å€¼æ˜¯2æˆ–n-1ï¼ˆå› ä¸ºå®ƒä»¬ç¦»é”šç‚¹æœ€è¿œï¼‰ã€‚  
3. **éšæœºåŒ–æ‰¾é”šç‚¹**ï¼šå› ä¸ºéšæœºé€‰ä¸‰ä¸ªä½ç½®ï¼Œæ‰¾åˆ°è¿‘è·ç¦»å¯¹çš„æ¦‚ç‡å¾ˆé«˜ï¼ˆ420æ¬¡çš„å¤±è´¥æ¦‚ç‡å‡ ä¹ä¸º0ï¼‰ï¼Œæ‰€ä»¥ç”¨éšæœºåŒ–åœ¨420æ¬¡å†…æå®šé”šç‚¹ï¼Œå‰©ä¸‹çš„n-2æ¬¡è¯¢é—®å°±èƒ½è¿˜åŸæ’åˆ—ã€‚  

### å¯è§†åŒ–è®¾è®¡æ€è·¯
æˆ‘ä»¬ä¼šæŠŠè¿™ä¸ªè¿‡ç¨‹åšæˆ**8ä½åƒç´ é£çš„â€œå¯»å®æ¸¸æˆâ€**ï¼š  
- å±å¹•ä¸Šæ˜¯20ä¸ªåƒç´ ç‚¹ï¼ˆå¯¹åº”n=20çš„æ ·ä¾‹ï¼‰ï¼Œæ¯ä¸ªç‚¹ä»£è¡¨ä¸€ä¸ªä½ç½®ï¼›  
- éšæœºé€‰ä¸‰ä¸ªç‚¹æ—¶ï¼Œè¿™ä¸‰ä¸ªç‚¹ä¼šé—ªçƒé»„è‰²ï¼Œä¼´éšâ€œå“”â€çš„éŸ³æ•ˆï¼›  
- å½“æ‰¾åˆ°è¿‘è·ç¦»å¯¹ï¼ˆæ¯”å¦‚å·®â‰¤3ï¼‰ï¼Œè¿™ä¸¤ä¸ªç‚¹ä¼šå˜æˆç»¿è‰²å¹¶â€œè·³ä¸€ä¸‹â€ï¼Œæ’­æ”¾â€œå®â€çš„æç¤ºéŸ³ï¼›  
- æ¥ä¸‹æ¥ï¼Œç”¨è¿™ä¸¤ä¸ªç»¿ç‚¹è¯¢é—®å…¶ä»–ç‚¹ï¼Œæ¯ä¸ªç‚¹ä¼šæ˜¾ç¤ºå¯¹åº”çš„è·ç¦»å€¼ï¼ˆæ¯”å¦‚çº¢è‰²æ•°å­—ï¼‰ï¼Œæœ€å¤§å€¼çš„ç‚¹å˜çº¢ï¼ˆä»£è¡¨1ï¼‰ï¼Œæ¬¡å¤§å€¼çš„ç‚¹å˜æ©™ï¼ˆä»£è¡¨2ï¼‰ï¼›  
- æœ€åï¼Œæ‰€æœ‰ç‚¹æ˜¾ç¤ºæœ€ç»ˆçš„æ’åˆ—å€¼ï¼Œæ’­æ”¾â€œèƒœåˆ©â€éŸ³æ•ˆï¼ˆç±»ä¼¼FCæ¸¸æˆçš„é€šå…³éŸ³ä¹ï¼‰ã€‚  


## 2. ç²¾é€‰ä¼˜è´¨é¢˜è§£å‚è€ƒ

ä¸ºå¤§å®¶ç­›é€‰äº†4ä»½æ€è·¯æ¸…æ™°ã€ä»£ç æ˜“è¯»çš„ä¼˜è´¨é¢˜è§£ï¼š

**é¢˜è§£ä¸€ï¼šdztlbï¼ˆç»¼åˆè¯„åˆ†4.5æ˜Ÿï¼‰**  
* **ç‚¹è¯„**ï¼šè¿™ä»½é¢˜è§£æŠŠâ€œæ‰¾é”šç‚¹â†’å®š1å’Œ2â†’ç®—æ‰€æœ‰å€¼â€çš„é€»è¾‘æ‹†è§£å¾—éå¸¸æ¸…æ¥šã€‚ä½œè€…å…ˆç”¨ä¸¤å±‚å¾ªç¯éšæœºé€‰1-13å†…çš„ç‚¹ï¼ˆç¼©å°éšæœºèŒƒå›´æé«˜æ•ˆç‡ï¼‰ï¼Œæ‰¾åˆ°è¿‘è·ç¦»å¯¹åï¼Œé€šè¿‡â€œæœ€å¤§è·ç¦»â€ç¡®å®š1çš„ä½ç½®ï¼Œâ€œæ¬¡å¤§è·ç¦»â€ç¡®å®š2çš„ä½ç½®ï¼Œæœ€åç”¨é”šç‚¹è®¡ç®—æ‰€æœ‰å€¼ã€‚ä»£ç é‡Œçš„`query`å‡½æ•°å°è£…äº†äº¤äº’é€»è¾‘ï¼Œå˜é‡å`val`ï¼ˆå­˜å‚¨è·ç¦»ï¼‰ã€`nowid`ï¼ˆæœ€å¤§è·ç¦»çš„ä½ç½®ï¼‰éƒ½å¾ˆç›´è§‚ï¼Œç”šè‡³è€ƒè™‘äº†å¯¹ç§°æƒ…å†µï¼ˆå¦‚æœp[1]>p[2]å°±ç¿»è½¬æ’åˆ—ï¼‰ï¼Œéå¸¸ä¸¥è°¨ï¼

**é¢˜è§£äºŒï¼šhappybobï¼ˆç»¼åˆè¯„åˆ†4.5æ˜Ÿï¼‰**  
* **ç‚¹è¯„**ï¼šè¿™é¢˜è§£çš„éšæœºåŒ–éƒ¨åˆ†æ›´â€œçº¯ç²¹â€â€”â€”ç”¨`mt19937`éšæœºæ•°ç”Ÿæˆå™¨é€‰ä¸‰ä¸ªç‚¹ï¼Œç›´åˆ°æ‰¾åˆ°è¿‘è·ç¦»å¯¹ã€‚ä½œè€…ç‰¹åˆ«å¼ºè°ƒäº†â€œå¯¹ç§°æ€§è´¨â€ï¼ˆpå’Œn-p+1çš„è¯¢é—®ç»“æœç›¸åŒï¼‰ï¼Œæœ€åé€šè¿‡p[1]<p[2]æ¥å®šæœ€ç»ˆæ’åˆ—ã€‚ä»£ç ç»“æ„å’Œdztlbç±»ä¼¼ï¼Œä½†éšæœºåŒ–éƒ¨åˆ†æ›´ç®€æ´ï¼Œé€‚åˆå…¥é—¨å­¦ä¹ è€…å‚è€ƒã€‚

**é¢˜è§£ä¸‰ï¼šEuphoricStarï¼ˆç»¼åˆè¯„åˆ†4æ˜Ÿï¼‰**  
* **ç‚¹è¯„**ï¼šä½œè€…ç›´æ¥ç‚¹å‡ºæ ¸å¿ƒâ€”â€”â€œæ‰¾åˆ°1å’Œ2å°±èƒ½è§£â€ï¼Œå¹¶ç®€æ´åˆ†æäº†â€œè¿‘è·ç¦»å¯¹â€çš„æ¡ä»¶ï¼ˆå·®â‰¤(n-4)/3ï¼‰ã€‚è™½ç„¶æ²¡æœ‰ç»™å‡ºå®Œæ•´ä»£ç ï¼Œä½†æ€è·¯çš„æç‚¼å¾ˆåˆ°ä½ï¼Œé€‚åˆå¿«é€Ÿç†è§£é—®é¢˜æœ¬è´¨ã€‚

**é¢˜è§£å››ï¼šBPG_ningï¼ˆç»¼åˆè¯„åˆ†4æ˜Ÿï¼‰**  
* **ç‚¹è¯„**ï¼šè¿™ä»½é¢˜è§£çš„ç†è®ºåˆ†ææœ€æ·±å…¥ï¼ˆæ¯”å¦‚è¯æ˜â€œåŒºé—´å†…çš„ç‚¹çš„è¯¢é—®ç»“æœæ›´å°â€ï¼‰ï¼Œä½†ä»£ç ç›¸å¯¹å¤æ‚ï¼Œé€‚åˆæƒ³æ·±å…¥ç ”ç©¶é—®é¢˜æ€§è´¨çš„åŒå­¦ã€‚ä½œè€…ç”šè‡³ç»™å‡ºäº†nÂ³ã€nÂ²åˆ°2nçš„ä¼˜åŒ–è¿‡ç¨‹ï¼Œèƒ½å¸®ä½ ç†è§£â€œå¦‚ä½•ä»æš´åŠ›åˆ°é«˜æ•ˆâ€ã€‚


## 3. æ ¸å¿ƒéš¾ç‚¹è¾¨æä¸è§£é¢˜ç­–ç•¥

### æ ¸å¿ƒéš¾ç‚¹1ï¼šå¦‚ä½•è½¬åŒ–è¯¢é—®ç»“æœçš„æ€§è´¨ï¼Ÿ  
**åˆ†æ**ï¼šé¢˜ç›®ç»™çš„æ˜¯â€œä¸‰ä¸ªç»å¯¹å·®çš„ä¸­ä½æ•°â€ï¼Œä½†æˆ‘ä»¬éœ€è¦çš„æ˜¯â€œä¸¤ä¸ªç›¸é‚»å·®çš„æœ€å¤§å€¼â€â€”â€”è¿™ä¸€æ­¥æ˜¯è§£é¢˜çš„å…³é”®ï¼  
**ç­–ç•¥**ï¼šå‡è®¾ä¸‰ä¸ªå€¼æŒ‰ä»å°åˆ°å¤§æ’åˆ—ä¸º \(a < b < c\)ï¼Œé‚£ä¹ˆä¸‰ä¸ªå·®æ˜¯ \(b-a, c-b, c-a\)ï¼Œä¸­ä½æ•°å°±æ˜¯ \(max(b-a, c-b)\)ï¼ˆå› ä¸ºc-a = (b-a)+(c-b)ï¼Œè‚¯å®šæ˜¯æœ€å¤§çš„ï¼Œæ‰€ä»¥ä¸­ä½æ•°æ˜¯ç¬¬äºŒå¤§çš„ï¼Œä¹Ÿå°±æ˜¯ä¸¤ä¸ªç›¸é‚»å·®çš„æœ€å¤§å€¼ï¼‰ã€‚  

### æ ¸å¿ƒéš¾ç‚¹2ï¼šå¦‚ä½•é«˜æ•ˆæ‰¾åˆ°â€œè¿‘è·ç¦»å¯¹â€ï¼Ÿ  
**åˆ†æ**ï¼šå¦‚æœç›´æ¥éå†æ‰€æœ‰å¯¹ï¼Œéœ€è¦O(nÂ²)æ¬¡è¯¢é—®ï¼Œè‚¯å®šè¶…æ—¶ï¼›ä½†éšæœºåŒ–èƒ½åœ¨æ¦‚ç‡ä¸Šå¿«é€Ÿæ‰¾åˆ°ï¼  
**ç­–ç•¥**ï¼šéšæœºé€‰ä¸‰ä¸ªç‚¹è¯¢é—®ï¼Œå¦‚æœç»“æœâ‰¤n/6ï¼Œé‚£ä¹ˆè¿™ä¸‰ä¸ªç‚¹ä¸­ä»»æ„ä¸¤ä¸ªçš„å·®éƒ½â‰¤n/3ï¼ˆæ•°å­¦è¯æ˜ï¼šå‡è®¾a<b<cï¼Œç»“æœæ˜¯max(b-a,c-b)â‰¤n/6ï¼Œé‚£ä¹ˆc-a = (b-a)+(c-b)â‰¤2*(n/6)=n/3ï¼‰ã€‚420æ¬¡éšæœºçš„å¤±è´¥æ¦‚ç‡æ˜¯\((8/9)^{420}â‰ˆ3e-22\)ï¼Œå‡ ä¹ä¸å¯èƒ½å¤±è´¥ï¼

### æ ¸å¿ƒéš¾ç‚¹3ï¼šå¦‚ä½•å¤„ç†â€œå¯¹ç§°æƒ…å†µâ€ï¼Ÿ  
**åˆ†æ**ï¼šæ’åˆ—på’Œqï¼ˆq[i]=n-p[i]+1ï¼‰çš„è¯¢é—®ç»“æœå®Œå…¨ç›¸åŒï¼Œä½†é¢˜ç›®è¦æ±‚p[1]<p[2]â€”â€”è¿™ä¸€æ­¥æ˜¯æœ€åâ€œå®šç­”æ¡ˆâ€çš„å…³é”®ï¼  
**ç­–ç•¥**ï¼šå½“ç®—å‡ºæ‰€æœ‰p[i]åï¼Œæ£€æŸ¥p[1]å’Œp[2]çš„å¤§å°ï¼Œå¦‚æœp[1]>p[2]ï¼Œå°±æŠŠæ‰€æœ‰p[i]æ¢æˆn-p[i]+1ï¼ˆç›¸å½“äºâ€œç¿»è½¬â€æ’åˆ—ï¼‰ã€‚

### âœ¨ è§£é¢˜æŠ€å·§æ€»ç»“  
- **æ€§è´¨è½¬åŒ–**ï¼šé‡åˆ°å¤æ‚çš„è¯¢é—®ç»“æœï¼Œå…ˆæ‰¾æ•°å­¦æ€§è´¨ï¼ˆæ¯”å¦‚ä¸­ä½æ•°â†’maxç›¸é‚»å·®ï¼‰ï¼ŒæŠŠé—®é¢˜ç®€åŒ–ï¼›  
- **éšæœºåŒ–å·æ‡’**ï¼šå½“æš´åŠ›æ–¹æ³•è¶…æ—¶ä½†æ¦‚ç‡ä¸Šæœ‰æ·å¾„æ—¶ï¼Œç”¨éšæœºåŒ–ï¼ˆæ¯”å¦‚æ‰¾è¿‘è·ç¦»å¯¹ï¼‰ï¼›  
- **å¯¹ç§°å¤„ç†**ï¼šäº¤äº’å¼é—®é¢˜å¸¸æœ‰çš„â€œé•œåƒâ€æƒ…å†µï¼Œæœ€åç”¨é¢˜ç›®æ¡ä»¶å®šç»“æœã€‚


## 4. C++æ ¸å¿ƒä»£ç å®ç°èµæ

### æœ¬é¢˜é€šç”¨æ ¸å¿ƒC++å®ç°å‚è€ƒ  
* **è¯´æ˜**ï¼šç»¼åˆdztlbå’Œhappybobçš„æ€è·¯ï¼Œæç‚¼å‡ºçš„æ¸…æ™°å®ç°ï¼Œè¦†ç›–éšæœºåŒ–æ‰¾é”šç‚¹ã€å®š1å’Œ2ã€ç®—æ‰€æœ‰å€¼çš„æ ¸å¿ƒé€»è¾‘ã€‚  
* **å®Œæ•´æ ¸å¿ƒä»£ç **ï¼š  
```cpp
#include <iostream>
#include <vector>
#include <random>
#include <algorithm>
using namespace std;

const int N = 1e5 + 5;
int n;
mt19937 rnd(114514); // éšæœºæ•°ç”Ÿæˆå™¨

int query(int a, int b, int c) {
    cout << "? " << a << " " << b << " " << c << endl;
    cout.flush();
    int x;
    cin >> x;
    return x;
}

int main() {
    int T;
    cin >> T;
    while (T--) {
        cin >> n;
        int a = -1, b = -1;
        // éšæœºåŒ–æ‰¾è¿‘è·ç¦»å¯¹ï¼ˆâ‰¤n/6ï¼‰
        while (true) {
            int x = rnd() % n + 1;
            int y = rnd() % n + 1;
            int z = rnd() % n + 1;
            if (x == y || y == z || x == z) continue;
            int res = query(x, y, z);
            if (res * 6 <= n - 4) { // æ»¡è¶³æ¡ä»¶ï¼šå·®â‰¤(n-4)/6
                a = x; b = y;
                break;
            }
        }
        // ç”¨a,bè¯¢é—®æ‰€æœ‰ç‚¹ï¼Œæ‰¾æœ€å¤§è·ç¦»å’Œæ¬¡å¤§è·ç¦»
        vector<int> val(n + 1, 0);
        int max_val = 0, max_id = -1;
        for (int i = 1; i <= n; ++i) {
            if (i == a || i == b) continue;
            val[i] = query(a, b, i);
            if (val[i] > max_val) {
                max_val = val[i];
                max_id = i;
            }
        }
        // æ‰¾æ¬¡å¤§è·ç¦»ï¼ˆmax_val-1ï¼‰çš„ç‚¹
        int sec_id = -1;
        for (int i = 1; i <= n; ++i) {
            if (i == a || i == b) continue;
            if (val[i] == max_val - 1) {
                if (sec_id == -1) sec_id = i;
                else { // æœ‰ä¸¤ä¸ªå€™é€‰ï¼Œé€‰æ›´ä¼˜çš„
                    int q1 = query(max_id, a, i);
                    int q2 = query(max_id, a, sec_id);
                    if (q1 < q2) sec_id = i;
                }
            }
        }
        // ç¡®å®š1å’Œ2çš„ä½ç½®
        vector<int> p(n + 1, 0);
        p[max_id] = 1;
        p[sec_id] = 2;
        // è®¡ç®—å…¶ä»–ç‚¹çš„å€¼
        for (int i = 1; i <= n; ++i) {
            if (i == max_id || i == sec_id) continue;
            p[i] = query(sec_id, max_id, i) + 2;
        }
        // å¤„ç†å¯¹ç§°æƒ…å†µ
        if (p[1] > p[2]) {
            for (int i = 1; i <= n; ++i) {
                p[i] = n - p[i] + 1;
            }
        }
        // è¾“å‡ºç»“æœ
        cout << "! ";
        for (int i = 1; i <= n; ++i) {
            cout << p[i] << " ";
        }
        cout << endl;
        cout.flush();
        int x;
        cin >> x; // æ¥æ”¶äº¤äº’å™¨çš„åé¦ˆ
    }
    return 0;
}
```
* **ä»£ç è§£è¯»æ¦‚è¦**ï¼š  
  1. **éšæœºåŒ–æ‰¾é”šç‚¹**ï¼šç”¨`mt19937`éšæœºé€‰ä¸‰ä¸ªç‚¹ï¼Œç›´åˆ°æ‰¾åˆ°æ»¡è¶³æ¡ä»¶çš„è¿‘è·ç¦»å¯¹(a,b)ï¼›  
  2. **æ‰¾æœ€å¤§/æ¬¡å¤§è·ç¦»**ï¼šç”¨a,bè¯¢é—®æ‰€æœ‰ç‚¹ï¼Œè®°å½•æ¯ä¸ªç‚¹çš„è·ç¦»`val[i]`ï¼Œæ‰¾åˆ°æœ€å¤§è·ç¦»çš„ç‚¹`max_id`ï¼ˆå¯¹åº”1ï¼‰å’Œæ¬¡å¤§çš„`sec_id`ï¼ˆå¯¹åº”2ï¼‰ï¼›  
  3. **è®¡ç®—æ‰€æœ‰å€¼**ï¼šç”¨1å’Œ2çš„ä½ç½®è¯¢é—®å…¶ä»–ç‚¹ï¼Œç›´æ¥å¾—åˆ°å¯¹åº”çš„å€¼ï¼›  
  4. **å¯¹ç§°å¤„ç†**ï¼šç¡®ä¿p[1]<p[2]ï¼Œå¦åˆ™ç¿»è½¬æ’åˆ—ã€‚

---

### é¢˜è§£ä¸€ï¼šdztlbï¼ˆæ¥æºï¼šæ´›è°·é¢˜è§£ï¼‰  
* **äº®ç‚¹**ï¼šç”¨åŒé‡å¾ªç¯é™åˆ¶éšæœºèŒƒå›´ï¼ˆ1-13ï¼‰ï¼Œå‡å°‘ä¸å¿…è¦çš„è¯¢é—®ï¼Œæé«˜æ•ˆç‡ã€‚  
* **æ ¸å¿ƒä»£ç ç‰‡æ®µ**ï¼š  
```cpp
bool ok = 0;
for (int i = 1; i <= 13 && !ok; ++i)
    for (int j = i + 1; j <= 13 && !ok; ++j)
        for (int k = j + 1; k <= 13 && !ok; ++k)
            if (query(i, j, k) * 6 <= n - 4) {
                a = i; b = j; ok = 1;
            }
```
* **ä»£ç è§£è¯»**ï¼š  
  è¿™æ®µä»£ç æ˜¯â€œç¼©å°èŒƒå›´çš„éšæœºåŒ–â€â€”â€”ä½œè€…æ²¡æœ‰éšæœºæ‰€æœ‰ç‚¹ï¼Œè€Œæ˜¯åªåœ¨1-13ä¸­é€‰ä¸‰ä¸ªç‚¹è¯¢é—®ã€‚ä¸ºä»€ä¹ˆï¼Ÿå› ä¸º13ä¸ªç‚¹æœ‰`C(13,3)=286`ç§ç»„åˆï¼Œè¿œå°äº420æ¬¡çš„é™åˆ¶ï¼Œè€Œä¸”æ¦‚ç‡ä¸Šè¶³å¤Ÿæ‰¾åˆ°è¿‘è·ç¦»å¯¹ã€‚è¿™ç§â€œå®šå‘éšæœºâ€èƒ½å‡å°‘äº¤äº’æ¬¡æ•°ï¼Œæ›´é«˜æ•ˆï¼  
* **å­¦ä¹ ç¬”è®°**ï¼šéšæœºåŒ–ä¸ä¸€å®šæ˜¯â€œå…¨éšæœºâ€ï¼Œå¯ä»¥ç»“åˆé—®é¢˜è°ƒæ•´èŒƒå›´ï¼Œæé«˜æ•ˆç‡ã€‚

---

### é¢˜è§£äºŒï¼šhappybobï¼ˆæ¥æºï¼šæ´›è°·é¢˜è§£ï¼‰  
* **äº®ç‚¹**ï¼šç”¨`mt19937`ç”Ÿæˆé«˜è´¨é‡éšæœºæ•°ï¼Œä»£ç æ›´ç®€æ´ã€‚  
* **æ ¸å¿ƒä»£ç ç‰‡æ®µ**ï¼š  
```cpp
mt19937 rnd(114514);
uniform_int_distribution<int> rg(1, n);
while (true) {
    int x = rg(rnd), y = rg(rnd), z = rg(rnd);
    if (x == y || y == z || x == z) continue;
    if (query(x, y, z) <= (n - 4) / 6) {
        a = x; b = y; break;
    }
}
```
* **ä»£ç è§£è¯»**ï¼š  
  è¿™æ®µä»£ç ç”¨C++11çš„`mt19937`éšæœºæ•°ç”Ÿæˆå™¨ï¼ˆæ¯”`rand()`æ›´å‡åŒ€ï¼‰ï¼Œ`uniform_int_distribution`ä¿è¯ç”Ÿæˆ1åˆ°nçš„å‡åŒ€åˆ†å¸ƒã€‚å½“æ‰¾åˆ°æ»¡è¶³æ¡ä»¶çš„ä¸‰ä¸ªç‚¹æ—¶ï¼Œç›´æ¥å–å‰ä¸¤ä¸ªä½œä¸ºé”šç‚¹(a,b)ã€‚è¿™ç§å†™æ³•æ›´ç°ä»£ï¼Œä¹Ÿæ›´æ˜“è¯»ã€‚  
* **å­¦ä¹ ç¬”è®°**ï¼šC++11çš„éšæœºæ•°åº“æ›´å¼ºå¤§ï¼Œæ¨èä½¿ç”¨`mt19937`å’Œ`uniform_int_distribution`ã€‚


## 5. ç®—æ³•å¯è§†åŒ–ï¼šåƒç´ åŠ¨ç”»æ¼”ç¤º  

### ğŸŒŸ åŠ¨ç”»ä¸»é¢˜ï¼šåƒç´ ä¾¦æ¢æ‰¾æ’åˆ—  
**è®¾è®¡æ€è·¯**ï¼šç”¨8ä½åƒç´ é£è¿˜åŸè§£é¢˜è¿‡ç¨‹ï¼ŒæŠŠâ€œè¯¢é—®â€å˜æˆâ€œä¾¦æ¢è°ƒæŸ¥â€ï¼Œç”¨æ¸¸æˆåŒ–å…ƒç´ ï¼ˆéŸ³æ•ˆã€å…³å¡ï¼‰å¢å¼ºè¶£å‘³æ€§â€”â€”æ¯•ç«Ÿï¼Œå­¦ç®—æ³•ä¹Ÿå¯ä»¥åƒç©FCæ¸¸æˆä¸€æ ·å¼€å¿ƒï¼

### ğŸ® åŠ¨ç”»ç»†èŠ‚ä¸äº¤äº’è®¾è®¡  
1. **åœºæ™¯åˆå§‹åŒ–**ï¼š  
   - å±å¹•å·¦ä¾§æ˜¯20ä¸ªåƒç´ ç‚¹ï¼ˆå¯¹åº”n=20ï¼‰ï¼Œæ¯ä¸ªç‚¹æ˜¯16x16çš„æ–¹å—ï¼Œç¼–å·1-20ï¼›  
   - å³ä¾§æ˜¯â€œä¾¦æ¢é¢æ¿â€ï¼šæ˜¾ç¤ºâ€œå¼€å§‹/æš‚åœâ€â€œå•æ­¥â€â€œé‡ç½®â€æŒ‰é’®ï¼Œé€Ÿåº¦æ»‘å—ï¼ˆ1x-5xï¼‰ï¼Œä»¥åŠå½“å‰çš„â€œçº¿ç´¢â€ï¼ˆæ¯”å¦‚â€œå·²æ‰¾åˆ°é”šç‚¹ï¼š3å’Œ5â€ï¼‰ï¼›  
   - èƒŒæ™¯æ’­æ”¾8ä½é£æ ¼çš„è½»æ¾BGMï¼ˆç±»ä¼¼ã€Šè¶…çº§é©¬é‡Œå¥¥ã€‹çš„å¼€å¤´éŸ³ä¹ï¼‰ã€‚

2. **éšæœºåŒ–æ‰¾é”šç‚¹**ï¼š  
   - ç‚¹å‡»â€œå¼€å§‹â€åï¼Œå±å¹•ä¸Šéšæœºé—ªçƒä¸‰ä¸ªç‚¹ï¼ˆé»„è‰²ï¼‰ï¼Œä¼´éšâ€œå“”â€çš„éŸ³æ•ˆï¼›  
   - å½“æ‰¾åˆ°æ»¡è¶³æ¡ä»¶çš„é”šç‚¹ï¼ˆæ¯”å¦‚3å’Œ5ï¼‰ï¼Œè¿™ä¸¤ä¸ªç‚¹å˜æˆç»¿è‰²ï¼ŒåŒæ—¶å¼¹å‡ºæ–‡å­—æç¤ºï¼šâ€œæ‰¾åˆ°è¿‘è·ç¦»å¯¹ï¼è·ç¦»â‰¤3â€ï¼Œå¹¶æ’­æ”¾â€œå®â€çš„éŸ³æ•ˆï¼›  
   - å¦‚æœæ²¡æ‰¾åˆ°ï¼Œç»§ç»­é—ªçƒå…¶ä»–ä¸‰ä¸ªç‚¹ï¼Œç›´åˆ°æˆåŠŸã€‚

3. **æ‰¾1å’Œ2çš„ä½ç½®**ï¼š  
   - ç”¨ç»¿è‰²é”šç‚¹è¯¢é—®æ‰€æœ‰ç‚¹ï¼Œæ¯ä¸ªç‚¹ä¸‹æ–¹æ˜¾ç¤ºè·ç¦»å€¼ï¼ˆçº¢è‰²æ•°å­—ï¼‰ï¼›  
   - æœ€å¤§è·ç¦»çš„ç‚¹ï¼ˆæ¯”å¦‚10ï¼‰å˜çº¢ï¼Œæ¬¡å¤§çš„ç‚¹ï¼ˆæ¯”å¦‚7ï¼‰å˜æ©™ï¼Œæ–‡å­—æç¤ºï¼šâ€œæ€€ç–‘ç‚¹10æ˜¯1ï¼Œç‚¹7æ˜¯2â€ï¼›  
   - å¦‚æœæœ‰ä¸¤ä¸ªå€™é€‰ç‚¹ï¼Œå±å¹•ä¼šæ˜¾ç¤ºä¸¤ä¸ªç‚¹çš„æ¯”è¾ƒè¿‡ç¨‹ï¼ˆæ¯”å¦‚è¯¢é—®ç‚¹10ã€3ã€12å’Œç‚¹10ã€3ã€7ï¼‰ï¼Œé€‰æ›´ä¼˜çš„é‚£ä¸ªï¼Œä¼´éšâ€œå’”åš“â€çš„éŸ³æ•ˆã€‚

4. **è¿˜åŸæ’åˆ—**ï¼š  
   - è®¡ç®—æ¯ä¸ªç‚¹çš„å€¼ï¼Œæ•°å­—æ˜¾ç¤ºåœ¨åƒç´ ç‚¹ä¸‹æ–¹ï¼ˆæ¯”å¦‚ç‚¹1æ˜¾ç¤º9ï¼Œç‚¹2æ˜¾ç¤º10ï¼‰ï¼›  
   - æœ€åæ£€æŸ¥p[1]<p[2]ï¼Œå¦‚æœéœ€è¦ç¿»è½¬ï¼Œæ‰€æœ‰ç‚¹çš„æ•°å­—ä¼šâ€œç¿»è½¬â€ï¼ˆæ¯”å¦‚9â†’12ï¼Œ10â†’11ï¼‰ï¼Œä¼´éšâ€œå“—å•¦â€çš„éŸ³æ•ˆï¼›  
   - å®Œæˆåï¼Œæ‰€æœ‰ç‚¹å˜æˆå½©è‰²ï¼Œæ’­æ”¾èƒœåˆ©éŸ³ä¹ï¼ˆç±»ä¼¼ã€Šé­‚æ–—ç½—ã€‹çš„é€šå…³éŸ³æ•ˆï¼‰ï¼Œå¹¶æ˜¾ç¤ºâ€œæ’åˆ—è¿˜åŸæˆåŠŸï¼â€ã€‚

5. **äº¤äº’æ§åˆ¶**ï¼š  
   - **å•æ­¥**ï¼šç‚¹å‡»ä¸€æ¬¡èµ°ä¸€æ­¥ï¼Œé€‚åˆä»”ç»†è§‚å¯Ÿæ¯ä¸€æ­¥ï¼›  
   - **è‡ªåŠ¨æ’­æ”¾**ï¼šæŒ‰è®¾ç½®çš„é€Ÿåº¦ï¼ˆ1x-5xï¼‰è‡ªåŠ¨æ‰§è¡Œï¼Œé€‚åˆå¿«é€Ÿçœ‹æµç¨‹ï¼›  
   - **é‡ç½®**ï¼šå›åˆ°åˆå§‹çŠ¶æ€ï¼Œé‡æ–°å¼€å§‹æ¸¸æˆã€‚

### ğŸµ éŸ³æ•ˆè®¾è®¡  
- éšæœºè¯¢é—®ï¼šâ€œå“”â€ï¼ˆçŸ­å£°ï¼‰ï¼›  
- æ‰¾åˆ°é”šç‚¹ï¼šâ€œå®â€ï¼ˆæ¸…è„†å£°ï¼‰ï¼›  
- æ¯”è¾ƒå€™é€‰ç‚¹ï¼šâ€œå’”åš“â€ï¼ˆæœºæ¢°å£°ï¼‰ï¼›  
- ç¿»è½¬æ’åˆ—ï¼šâ€œå“—å•¦â€ï¼ˆæµæ°´å£°ï¼‰ï¼›  
- èƒœåˆ©ï¼šâ€œå™”å™”å™”â€ï¼ˆä¸Šæ‰¬è°ƒï¼‰ã€‚


## 6. æ‹“å±•ç»ƒä¹ ä¸ç›¸ä¼¼é—®é¢˜æ€è€ƒ  

### é€šç”¨æ€è·¯è¿ç§»  
æœ¬é¢˜çš„æŠ€å·§å¯ä»¥ç”¨åˆ°**æ‰€æœ‰äº¤äº’å¼é—®é¢˜**ä¸­ï¼š  
- è½¬åŒ–è¯¢é—®ç»“æœçš„æ€§è´¨ï¼ˆæ¯”å¦‚æŠŠä¸­ä½æ•°å˜æˆmaxå·®ï¼‰ï¼›  
- ç”¨éšæœºåŒ–å¿«é€Ÿæ‰¾åˆ°å…³é”®é”šç‚¹ï¼›  
- å¤„ç†å¯¹ç§°æƒ…å†µã€‚

### æ¨èç»ƒä¹ ï¼ˆæ´›è°·ï¼‰  
1. **æ´›è°· P1226** - å¿«é€Ÿå¹‚ï¼ˆäº¤äº’å¼é—®é¢˜ï¼Œéœ€è¦é€šè¿‡æé—®è®¡ç®—å¹‚ï¼‰  
   ğŸ—£ï¸ æ¨èç†ç”±ï¼šç»ƒä¹ â€œç”¨èªæ˜çš„æé—®æ›¿ä»£æš´åŠ›è®¡ç®—â€ï¼Œç±»ä¼¼æœ¬é¢˜çš„â€œè½¬åŒ–æ€§è´¨â€æ€è·¯ã€‚  
2. **æ´›è°· P3694** - é‚¦é‚¦çš„å¤§åˆå”±ç«™é˜Ÿï¼ˆéœ€è¦åˆ©ç”¨æ’åˆ—æ€§è´¨ä¼˜åŒ–ï¼‰  
   ğŸ—£ï¸ æ¨èç†ç”±ï¼šç»ƒä¹ â€œåˆ©ç”¨æ’åˆ—çš„æ€§è´¨å‡å°‘è®¡ç®—é‡â€ï¼Œç±»ä¼¼æœ¬é¢˜çš„â€œé”šç‚¹ç­–ç•¥â€ã€‚  
3. **æ´›è°· P1162** - å¡«æ•°æ¸¸æˆï¼ˆäº¤äº’å¼é—®é¢˜ï¼Œéœ€è¦é€šè¿‡æé—®å¡«æ•°ï¼‰  
   ğŸ—£ï¸ æ¨èç†ç”±ï¼šç»ƒä¹ â€œäº¤äº’å¼é—®é¢˜çš„é€»è¾‘æ¨å¯¼â€ï¼Œç±»ä¼¼æœ¬é¢˜çš„â€œä¾¦æ¢å¼æ€è€ƒâ€ã€‚


## 7. å­¦ä¹ å¿ƒå¾—ä¸ç»éªŒåˆ†äº«  

**å‚è€ƒç»éªŒï¼ˆæ¥è‡ªdztlbï¼‰**ï¼šâ€œéšæœºåŒ–æ—¶ï¼Œå–è·ç¦»â‰¤n/6èƒ½ä¿è¯æ­£ç¡®ç‡ï¼Œå› ä¸ºè¿™æ ·ä¸¤ä¸¤å·®â‰¤n/3ã€‚è€Œ420æ¬¡çš„å¤±è´¥æ¦‚ç‡å‡ ä¹ä¸º0ï¼Œå®Œå…¨ä¸ç”¨æ‹…å¿ƒè¶…æ—¶ã€‚â€  
**ç‚¹è¯„**ï¼šè¿™ä½ä½œè€…çš„ç»éªŒæé†’æˆ‘ä»¬â€”â€”**éšæœºåŒ–ä¸æ˜¯â€œç¢°è¿æ°”â€ï¼Œè€Œæ˜¯æœ‰æ•°å­¦ä¾æ®çš„**ï¼è®¡ç®—å¤±è´¥æ¦‚ç‡èƒ½è®©æˆ‘ä»¬æ›´æ”¾å¿ƒåœ°ä½¿ç”¨éšæœºåŒ–ï¼Œè€Œä¸æ˜¯ç›²ç›®å°è¯•ã€‚  

**å‚è€ƒç»éªŒï¼ˆæ¥è‡ªhappybobï¼‰**ï¼šâ€œæ’åˆ—på’Œn-p+1çš„è¯¢é—®ç»“æœç›¸åŒï¼Œæœ€åä¸€å®šè¦æ£€æŸ¥p[1]<p[2]ï¼â€  
**ç‚¹è¯„**ï¼šå¯¹ç§°æƒ…å†µæ˜¯äº¤äº’å¼é—®é¢˜çš„â€œé™·é˜±â€ï¼Œå¾ˆå¤šåŒå­¦ä¼šå¿˜è®°å¤„ç†ã€‚è¿™ä½ä½œè€…çš„æé†’èƒ½å¸®æˆ‘ä»¬é¿å¼€è¿™ä¸ªå‘ï¼


## ğŸ’ª æ€»ç»“ä¸é¼“åŠ±  
è¿™æ¬¡çš„é—®é¢˜æ˜¯äº¤äº’å¼ç®—æ³•çš„å…¸å‹ä¾‹å­â€”â€”å®ƒä¸åƒæ’åºã€DPé‚£æ ·æœ‰å›ºå®šæ¨¡æ¿ï¼Œè€Œæ˜¯éœ€è¦ä½ â€œä¸»åŠ¨æ€è€ƒâ€ï¼šå¦‚ä½•æé—®ã€å¦‚ä½•åˆ©ç”¨æ€§è´¨ã€å¦‚ä½•ç”¨éšæœºåŒ–å·æ‡’ã€‚ä½†åªè¦æŒæ¡äº†â€œè½¬åŒ–æ€§è´¨+æ‰¾é”šç‚¹+å¯¹ç§°å¤„ç†â€è¿™ä¸‰ä¸ªæŠ€å·§ï¼Œä½ å°±èƒ½åƒâ€œåƒç´ ä¾¦æ¢â€ä¸€æ ·ï¼Œè½»æ¾ç ´è§£éšè—çš„æ’åˆ—ï¼  

è®°ä½ï¼šç¼–ç¨‹çš„ä¹è¶£åœ¨äºâ€œè§£å†³é—®é¢˜çš„è¿‡ç¨‹â€ï¼Œå°±åƒç©æ¸¸æˆé€šå…³ä¸€æ ·â€”â€”æ¯ä¸€æ­¥æ€è€ƒéƒ½æ˜¯â€œå‡çº§â€ï¼Œæ¯ä¸€æ¬¡æˆåŠŸéƒ½æ˜¯â€œé€šå…³â€ã€‚ä¸‹æ¬¡é‡åˆ°äº¤äº’å¼é—®é¢˜ï¼Œä¸å¦¨æƒ³æƒ³ä»Šå¤©çš„â€œåƒç´ ä¾¦æ¢â€ï¼Œè¯´ä¸å®šå°±èƒ½å¿«é€Ÿæ‰¾åˆ°æ€è·¯ï¼  

ä¸‹æ¬¡æˆ‘ä»¬å†ä¸€èµ·ç ´è§£æ–°çš„ç®—æ³•æŒ‘æˆ˜ï¼ŒåŠ æ²¹ï¼ğŸ’»âœ¨

---
å¤„ç†ç”¨æ—¶ï¼š109.93ç§’
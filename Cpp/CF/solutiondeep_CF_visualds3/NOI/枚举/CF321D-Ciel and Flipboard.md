# é¢˜ç›®ä¿¡æ¯

# Ciel and Flipboard

## é¢˜ç›®æè¿°

Fox Ciel has a board with $ n $ rows and $ n $ columns, there is one integer in each cell.

It's known that $ n $ is an odd number, so let's introduce ![](https://cdn.luogu.com.cn/upload/vjudge_pic/CF321D/6479833d305e8df8be298c6d130b2c56818252f6.png). Fox Ciel can do the following operation many times: she choose a sub-board with size $ x $ rows and $ x $ columns, then all numbers in it will be multiplied by -1.

Return the maximal sum of numbers in the board that she can get by these operations.

## è¯´æ˜/æç¤º

In the first test, we can apply this operation twice: first on the top left $ 2Ã—2 $ sub-board, then on the bottom right $ 2Ã—2 $ sub-board. Then all numbers will become positive.

![](https://cdn.luogu.com.cn/upload/vjudge_pic/CF321D/bba86be06e5760920ea393fc6a496f40415e324b.png)

## æ ·ä¾‹ #1

### è¾“å…¥

```
3
-1 -1 1
-1 1 -1
1 -1 -1
```

### è¾“å‡º

```
9
```

## æ ·ä¾‹ #2

### è¾“å…¥

```
5
-2 0 0 0 -2
0 -2 0 -2 0
0 0 -2 0 0
0 -2 0 -2 0
-2 0 0 0 -2
```

### è¾“å‡º

```
18
```

# AIåˆ†æç»“æœ

# ğŸ’¡ Kayçš„C++ç®—æ³•è§£æï¼šCF321D Ciel and Flipboard æ·±å…¥å­¦ä¹ æŒ‡å— ğŸ’¡


## 1. é¢˜ç›®è§£è¯»ä¸æ ¸å¿ƒç®—æ³•è¯†åˆ«

âœ¨ **æœ¬é¢˜ä¸»è¦è€ƒå¯Ÿ**ï¼šç¼–ç¨‹æŠ€å·§åº”ç”¨ï¼ˆåˆ©ç”¨é—®é¢˜æ€§è´¨ä¼˜åŒ–æšä¸¾ï¼‰

ğŸ—£ï¸ **åˆæ­¥åˆ†æ**ï¼š  
è§£å†³è¿™é“é¢˜çš„å…³é”®ï¼Œå°±åƒç©ã€Œå…³é”®çº¿æ‹¼å›¾ã€æ¸¸æˆâ€”â€”åŸæœ¬è¦æ‹¼å®Œ1000å—çš„å¤§æ‹¼å›¾ï¼ˆå¯¹åº”æšä¸¾æ‰€æœ‰ç¿»è½¬çŠ¶æ€ï¼Œå¤æ‚åº¦æ˜¯ææ€–çš„ \(2^{m^2}\)ï¼‰ï¼Œä½†æˆ‘ä»¬å‘ç°**ä¸­é—´çš„ç«–çº¿ï¼ˆç¬¬\(m\)åˆ—ï¼‰æ˜¯ã€Œå…³é”®çº¿ã€**ï¼šåªè¦æ‹¼å¥½è¿™æ¡çº¿ä¸Šçš„å‡ å—ï¼Œå·¦å³ä¸¤è¾¹çš„æ‹¼å›¾å°±èƒ½ã€Œè‡ªåŠ¨å½’ä½ã€ï¼  

å…·ä½“æ¥è¯´ï¼Œé¢˜ç›®ä¸­çš„ç¿»è½¬æ“ä½œæœ‰ä¸ªã€Œéšè—å¯†ç ã€ï¼šå¯¹äºä»»æ„ä½ç½®\((i,j)\)ï¼ˆ\(j<m\)ï¼‰ï¼Œå®ƒçš„ç¿»è½¬çŠ¶æ€ï¼ˆæ˜¯å¦ä¹˜-1ï¼‰ã€å³è¾¹\(j+m\)ä½ç½®çš„çŠ¶æ€ï¼Œå¿…é¡»å’Œä¸­é—´åˆ—\(m\)çš„çŠ¶æ€æ»¡è¶³ã€Œå¼‚æˆ–ç­‰å¼ã€ï¼ˆ\(vis[i][j] \oplus vis[i][m] \oplus vis[i][j+m] = 0\)ï¼‰ã€‚è¿™å°±åƒæ¯ä¸ªä½ç½®éƒ½ã€Œç»‘å®šã€äº†ä¸­é—´åˆ—çš„çŠ¶æ€â€”â€”åªè¦ç¡®å®šä¸­é—´åˆ—çš„çŠ¶æ€ï¼Œå…¶ä»–ä½ç½®çš„çŠ¶æ€å°±èƒ½ã€Œé¡ºè—¤æ‘¸ç“œã€æ¨å‡ºæ¥ï¼  

### æ ¸å¿ƒç®—æ³•æµç¨‹
1. **æšä¸¾å…³é”®çº¿**ï¼šæšä¸¾ç¬¬\(m\)åˆ—å‰\(m\)ä¸ªä½ç½®çš„ç¿»è½¬çŠ¶æ€ï¼ˆä»…\(2^m\)ç§å¯èƒ½ï¼Œæ¯”å¦‚\(m=17\)æ—¶åªæœ‰131072ç§ï¼Œè¿œå°äº\(2^{17^2}\)ï¼‰ï¼›  
2. **æ¨å¯¼å…¨å±€çŠ¶æ€**ï¼šç”¨ä¸­é—´åˆ—çš„çŠ¶æ€ï¼Œæ¨å¯¼å‡ºæ•´ä¸ªä¸­é—´åˆ—çš„æ‰€æœ‰çŠ¶æ€ï¼›  
3. **è´ªå¿ƒé€‰æœ€ä¼˜**ï¼šå¯¹æ¯ä¸€åˆ—ï¼ˆé™¤ä¸­é—´åˆ—ï¼‰ï¼Œç‹¬ç«‹è®¡ç®—è¯¥åˆ—çš„æœ€å¤§è´¡çŒ®ï¼ˆåˆ—ä¹‹é—´äº’ä¸å½±å“ï¼Œç›´æ¥é€‰æœ€ä¼˜ï¼‰ã€‚  

### å¯è§†åŒ–è®¾è®¡æ€è·¯
æˆ‘ä»¬ç”¨**8ä½åƒç´ é£**å±•ç¤ºçŸ©é˜µï¼Œç”¨é¢œè‰²å’ŒéŸ³æ•ˆå¼ºåŒ–è®°å¿†ï¼š  
- ä¸­é—´åˆ—ç”¨ã€Œé‡‘è‰²ã€çªå‡ºï¼Œæšä¸¾æ—¶é‡‘è‰²å—é€ä¸ªã€Œç‚¹äº®ã€ï¼ˆè¡¨ç¤ºé€‰æ‹©çŠ¶æ€ï¼‰ï¼›  
- æ¯ä¸ªå°å—ï¼ˆå¦‚\((i,j)\)å’Œå®ƒçš„ä¸‰ä¸ªå¯¹ç§°å—ï¼‰ç”¨ã€Œè“è‰²ã€æ¡†ä½ï¼Œå•æ­¥æ‰§è¡Œæ—¶é—ªçƒï¼Œæ˜¾ç¤ºé€‰0æˆ–1çš„è´¡çŒ®å€¼ï¼›  
- å…³é”®æ“ä½œä¼´éšéŸ³æ•ˆï¼šæšä¸¾ä¸­é—´åˆ—æ—¶ã€Œæ»´æ»´ã€å“ï¼Œé€‰æœ€ä¼˜æ—¶ã€Œå®ã€ä¸€å£°ï¼Œå®Œæˆæ‰€æœ‰è®¡ç®—æ’­æ”¾ã€Œèƒœåˆ©è¿›è¡Œæ›²ã€ï¼ˆ8ä½é£æ ¼ï¼‰ï¼  


## 2. ç²¾é€‰ä¼˜è´¨é¢˜è§£å‚è€ƒ

ä¸ºå¤§å®¶ç­›é€‰äº†5ä»½æ€è·¯æ¸…æ™°ã€ä»£ç è§„èŒƒçš„ä¼˜è´¨é¢˜è§£ï¼ˆè¯„åˆ†â‰¥4æ˜Ÿï¼‰ï¼š

### é¢˜è§£ä¸€ï¼šä½œè€…FutaRimeWoawaSete  
**ç‚¹è¯„**ï¼šè¿™ä»½é¢˜è§£åƒã€Œè§£å¯†æ‰‹å†Œã€ï¼ŒæŠŠç¿»è½¬çš„ã€Œå¼‚æˆ–çº¦æŸã€æ¨å¯¼å¾—æ˜æ˜ç™½ç™½ï¼ä»ã€Œå°å—è®¡ç®—ã€ï¼ˆc3å‡½æ•°ï¼‰åˆ°ã€Œåˆ—è®¡ç®—ã€ï¼ˆc2å‡½æ•°ï¼‰å†åˆ°ã€Œæ€»çŸ©é˜µè®¡ç®—ã€ï¼ˆc1å‡½æ•°ï¼‰ï¼Œé€»è¾‘é“¾å±‚å±‚é€’è¿›ï¼Œä»£ç ç»“æ„æ¸…æ™°å¾—åƒã€Œåˆ†å±‚è›‹ç³•ã€â€”â€”æ¯ä¸ªå‡½æ•°è§£å†³ä¸€ä¸ªå°é—®é¢˜ï¼Œæœ€åæ‹¼æˆå®Œæ•´ç­”æ¡ˆã€‚

### é¢˜è§£äºŒï¼šä½œè€…xzyxzy  
**ç‚¹è¯„**ï¼šé¢˜è§£çš„ã€Œåˆ†æ­¥æ¨å¯¼ã€å¤ªè´´å¿ƒäº†ï¼ä»ã€Œæ€§è´¨æ€»ç»“ã€åˆ°ã€Œæšä¸¾èŒƒå›´ä¼˜åŒ–ã€å†åˆ°ã€Œä»£ç å®ç°ã€ï¼Œåƒè€å¸ˆä¸€æ­¥æ­¥è®²é¢˜ã€‚queryå‡½æ•°ç›´æ¥å¯¹åº”ã€Œæ¨å¯¼+è®¡ç®—ã€çš„è¿‡ç¨‹ï¼Œç®€æ´åˆ°ã€Œä¸€çœ¼å°±èƒ½çœ‹æ‡‚ã€ï¼Œéå¸¸é€‚åˆæ–°æ‰‹æ¨¡ä»¿ã€‚

### é¢˜è§£ä¸‰ï¼šä½œè€…lottle1212__  
**ç‚¹è¯„**ï¼šè¿™ä»½é¢˜è§£è—ç€ã€Œè¸©å‘ç»éªŒã€ï¼ä½œè€…ä¸€å¼€å§‹æƒ³è´ªå¿ƒæˆ–DPï¼Œåæ¥å‘ç°ä¸å¯¹â€”â€”è¿™æé†’æˆ‘ä»¬ï¼š**é‡åˆ°æšä¸¾é¢˜å…ˆåˆ«æ€¥ç€æš´åŠ›ï¼Œå…ˆæ‰¾é—®é¢˜çš„ã€Œç‰¹æ®Šæ€§è´¨ã€**ï¼ä»£ç é‡Œçš„`max(query(x,y,0), query(x,y,1))`ç›´æ¥é€‰æ¯ä¸ªå°å—çš„æœ€ä¼˜ï¼Œè¶…ç›´ç™½ï¼

### é¢˜è§£å››ï¼šä½œè€…Polarisx  
**ç‚¹è¯„**ï¼šé¢˜è§£ä¼˜åŒ–äº†æšä¸¾èŒƒå›´ï¼ˆä»\(2^{m^2}\)é™åˆ°\(2^m\)ï¼‰ï¼Œå¹¶ç”¨`work`å‡½æ•°å¤„ç†ç¬¬\(m\)è¡Œçš„æœ€ä¼˜é€‰æ‹©ï¼Œé€»è¾‘ç´§å‡‘ã€‚ä»£ç é‡Œçš„`calc`å‡½æ•°è®¡ç®—å››ä¸ªå°å—çš„è´¡çŒ®ï¼Œç›´æ¥å¯¹åº”å¼‚æˆ–æ¨å¯¼ï¼Œéå¸¸é«˜æ•ˆã€‚

### é¢˜è§£äº”ï¼šä½œè€…Expert_Dreamer  
**ç‚¹è¯„**ï¼šä»£ç ç®€æ´åˆ°ã€Œæè‡´ã€ï¼ç”¨`work`å‡½æ•°å¤„ç†æ€»è´¡çŒ®ï¼Œ`q`å‡½æ•°å¤„ç†åˆ—çš„æœ€ä¼˜é€‰æ‹©ï¼Œ`q1`å‡½æ•°å¤„ç†å°å—â€”â€”ä¸‰å±‚å‡½æ•°åƒã€Œä¿„ç½—æ–¯å¥—å¨ƒã€ï¼Œå±‚å±‚åµŒå¥—ä½†é€»è¾‘æ¸…æ™°ï¼Œé€‚åˆå­¦ä¹ ä»£ç ç»“æ„åŒ–ã€‚


## 3. æ ¸å¿ƒéš¾ç‚¹è¾¨æä¸è§£é¢˜ç­–ç•¥

### æ ¸å¿ƒéš¾ç‚¹ä¸è§£å†³ç­–ç•¥
1. **éš¾ç‚¹1ï¼šå¦‚ä½•å‘ç°ç¿»è½¬çš„ã€Œå¼‚æˆ–æ€§è´¨ã€ï¼Ÿ**  
   åˆ†æï¼šç¿»è½¬\(mÃ—m\)çŸ©é˜µæ—¶ï¼Œç¬¬\(i\)è¡Œçš„\(j\)å’Œ\(j+m\)ä½ç½®ã€Œè¦ä¹ˆéƒ½ä¸ç¿»ï¼Œè¦ä¹ˆç¿»ä¸€ä¸ªã€ï¼Œè€Œä¸­é—´åˆ—\(m\)ä¸€å®šä¼šç¿»ã€‚å› æ­¤ä¸‰ä¸ªä½ç½®çš„çŠ¶æ€å¼‚æˆ–å’Œä¸º0ï¼ˆç¿»è½¬æ¬¡æ•°ä¸ºå¶æ•°æ—¶ä¸å˜ï¼‰ã€‚  
   è§£å†³ç­–ç•¥ï¼š**åŠ¨æ‰‹æ¨¡æ‹Ÿå°ä¾‹å­**ï¼ˆæ¯”å¦‚\(n=3\)ï¼Œç¿»è½¬å·¦ä¸Šè§’\(2Ã—2\)çŸ©é˜µï¼Œçœ‹\(j=1\)å’Œ\(j+2=3\)çš„çŠ¶æ€å˜åŒ–ï¼‰ï¼Œè§„å¾‹è‡ªç„¶æµ®ç°ï¼

2. **éš¾ç‚¹2ï¼šå¦‚ä½•æŠŠé«˜æ¬¡å¹‚æšä¸¾é™åˆ°ä½æ¬¡å¹‚ï¼Ÿ**  
   åˆ†æï¼šå¼‚æˆ–æ€§è´¨å‘Šè¯‰æˆ‘ä»¬ï¼Œä¸­é—´åˆ—çš„çŠ¶æ€èƒ½ã€Œå†³å®šã€å…¶ä»–ä½ç½®çš„çŠ¶æ€ã€‚æ¯”å¦‚ä¸­é—´åˆ—å‰\(m\)ä¸ªä½ç½®çš„çŠ¶æ€æœ‰\(2^m\)ç§å¯èƒ½ï¼Œåé¢çš„ä½ç½®å¯ä»¥é€šè¿‡ã€Œå¼‚æˆ–ä¸­é—´åˆ—\(m\)çš„çŠ¶æ€ã€æ¨å¯¼å‡ºæ¥ã€‚  
   è§£å†³ç­–ç•¥ï¼š**æŠ“ä½ã€Œå…³é”®çº¿ã€**ï¼Œç”¨å…³é”®çº¿çš„çŠ¶æ€è¦†ç›–æ‰€æœ‰å¯èƒ½ï¼ŒæŠŠå¤æ‚åº¦ä»\(2^{m^2}\)ç åˆ°\(2^m\)ï¼

3. **éš¾ç‚¹3ï¼šå¦‚ä½•å¤„ç†å„ä¸ªå—çš„ã€Œç‹¬ç«‹æœ€ä¼˜ã€ï¼Ÿ**  
   åˆ†æï¼šå‰\(m-1\)åˆ—ä¹‹é—´äº’ä¸å½±å“â€”â€”å¤„ç†ç¬¬1åˆ—æ—¶ï¼Œä¸ä¼šæ”¹å˜ç¬¬2åˆ—çš„çŠ¶æ€ã€‚å› æ­¤å¯ä»¥å¯¹æ¯ä¸€åˆ—å•ç‹¬è®¡ç®—ã€Œé€‰ç¿»è½¬0æˆ–1ã€çš„æœ€å¤§è´¡çŒ®ï¼Œå†ç´¯åŠ ã€‚  
   è§£å†³ç­–ç•¥ï¼š**åˆ†è€Œæ²»ä¹‹**ï¼ŒæŠŠå¤§é—®é¢˜æ‹†æˆå°é—®é¢˜ï¼Œæ¯ä¸ªå°é—®é¢˜é€‰æœ€ä¼˜ï¼

### âœ¨ è§£é¢˜æŠ€å·§æ€»ç»“
- **æ‰¾æ€§è´¨**ï¼šé‡åˆ°æšä¸¾é¢˜ï¼Œå…ˆæ‰¾æ“ä½œçš„ã€Œä¸å˜é‡ã€æˆ–ã€Œçº¦æŸå…³ç³»ã€ï¼ˆæ¯”å¦‚å¼‚æˆ–ï¼‰ï¼›  
- **é™ç»´åº¦**ï¼šæŠŠé«˜æ¬¡å¹‚æšä¸¾é™åˆ°ä½æ¬¡å¹‚ï¼ˆæ¯”å¦‚ä»\(2^{m^2}\)åˆ°\(2^m\)ï¼‰ï¼›  
- **åˆ†å—å¤„ç†**ï¼šç‹¬ç«‹çš„å—åˆ†å¼€è®¡ç®—ï¼Œè´ªå¿ƒé€‰æœ€ä¼˜ã€‚  


## 4. C++æ ¸å¿ƒä»£ç å®ç°èµæ

### æœ¬é¢˜é€šç”¨æ ¸å¿ƒC++å®ç°å‚è€ƒ
* **è¯´æ˜**ï¼šç»¼åˆä¼˜è´¨é¢˜è§£æ€è·¯ï¼Œç”¨ã€Œæšä¸¾ä¸­é—´åˆ—+åˆ†å—è®¡ç®—ã€çš„æ–¹å¼ï¼Œæ¸…æ™°å±•ç¤ºæ ¸å¿ƒé€»è¾‘ã€‚
* **å®Œæ•´æ ¸å¿ƒä»£ç **ï¼š
```cpp
#include <iostream>
#include <algorithm>
using namespace std;

const int MAXN = 35;
int n, m;
int a[MAXN][MAXN];
bool rev[MAXN][MAXN]; // 1è¡¨ç¤ºç¿»è½¬ï¼Œ0è¡¨ç¤ºä¸ç¿»è½¬

inline int get(int i, int j) {
    return rev[i][j] ? -a[i][j] : a[i][j];
}

int calc_col(int y, bool bj) {
    rev[m][y] = bj;
    rev[m][y + m] = rev[m][y] ^ rev[m][m];
    int res = get(m, y) + get(m, y + m);
    for (int x = 1; x < m; ++x) {
        int val0 = get(x, y) + get(x + m, y) + get(x, y + m) + get(x + m, y + m);
        rev[x][y] = 1;
        rev[x + m][y] = rev[m][y] ^ rev[x][y];
        rev[x][y + m] = rev[x][m] ^ rev[x][y];
        rev[x + m][y + m] = rev[m][y + m] ^ rev[x][y + m];
        int val1 = get(x, y) + get(x + m, y) + get(x, y + m) + get(x + m, y + m);
        rev[x][y] = 0;
        res += max(val0, val1);
    }
    return res;
}

int calc_total() {
    int res = 0;
    for (int i = m + 1; i <= n; ++i)
        rev[i][m] = rev[i - m][m] ^ rev[m][m];
    for (int i = 1; i <= n; ++i)
        res += get(i, m);
    for (int y = 1; y < m; ++y)
        res += max(calc_col(y, 0), calc_col(y, 1));
    return res;
}

int main() {
    cin >> n;
    m = (n + 1) / 2;
    for (int i = 1; i <= n; ++i)
        for (int j = 1; j <= n; ++j)
            cin >> a[i][j];
    int ans = -1e9;
    for (int mask = 0; mask < (1 << m); ++mask) {
        for (int i = 1; i <= m; ++i)
            rev[i][m] = (mask >> (i - 1)) & 1;
        ans = max(ans, calc_total());
    }
    cout << ans << endl;
    return 0;
}
```
* **ä»£ç è§£è¯»æ¦‚è¦**ï¼š  
  è¿™æ®µä»£ç åƒã€ŒçŸ©é˜µä¼˜åŒ–è®¡ç®—å™¨ã€ï¼š  
  1. è¯»å–è¾“å…¥çŸ©é˜µï¼›  
  2. æšä¸¾ä¸­é—´åˆ—å‰\(m\)è¡Œçš„æ‰€æœ‰çŠ¶æ€ï¼ˆ\(mask\)ä»0åˆ°\(2^m-1\)ï¼‰ï¼›  
  3. æ¨å¯¼ä¸­é—´åˆ—çš„æ‰€æœ‰çŠ¶æ€ï¼Œè®¡ç®—æ€»è´¡çŒ®ï¼›  
  4. å–æœ€å¤§è´¡çŒ®ä½œä¸ºç­”æ¡ˆã€‚  
  å…³é”®å‡½æ•°`calc_col`è®¡ç®—ä¸€åˆ—çš„æœ€ä¼˜å€¼ï¼Œ`calc_total`è®¡ç®—æ€»è´¡çŒ®â€”â€”ç”¨å¼‚æˆ–æ¨å¯¼çŠ¶æ€ï¼Œç”¨`max`é€‰æœ€ä¼˜ã€‚


### é’ˆå¯¹å„ä¼˜è´¨é¢˜è§£çš„ç‰‡æ®µèµæ

#### é¢˜è§£ä¸€ï¼šä½œè€…FutaRimeWoawaSete  
* **äº®ç‚¹**ï¼šç”¨åˆ†å±‚å‡½æ•°ï¼ˆc3â†’c2â†’c1ï¼‰æŠŠã€Œå°å—â†’åˆ—â†’æ€»çŸ©é˜µã€çš„è®¡ç®—è¿‡ç¨‹æ‹†å¾—æ˜æ˜ç™½ç™½ï¼  
* **æ ¸å¿ƒä»£ç ç‰‡æ®µ**ï¼š
```cpp
inline int c3(int x, int y, int i) {
    c[x][y] = i, c[x + m][y] = c[x][y] ^ c[m][y];
    c[x][y + m] = c[x][y] ^ c[x][m], c[x + m][y + m] = c[x][y + m] ^ c[m][y + m];
    int mx = v(x , y) + v(x + m , y) + v(x , y + m) + v(x + m , y + m);
    return mx;
}
```
* **ä»£ç è§£è¯»**ï¼š  
  è¿™æ˜¯ã€Œå°å—è®¡ç®—å™¨ã€ï¼æ¯”å¦‚\(x=1\)ã€\(y=1\)ï¼ˆå‰\(m-1\)è¡Œ/åˆ—ï¼‰ï¼Œ\(i\)æ˜¯\(rev[x][y]\)çš„çŠ¶æ€ï¼š  
  - ç¬¬ä¸€è¡Œï¼šè®¾ç½®\(rev[x][y]\)ä¸º\(i\)ï¼Œç”¨å¼‚æˆ–æ¨å¯¼ä¸‹æ–¹\(x+m\)è¡Œã€å³è¾¹\(y+m\)åˆ—çš„çŠ¶æ€ï¼›  
  - ç¬¬äºŒè¡Œï¼šæ¨å¯¼å³ä¸‹æ–¹\(x+m\)è¡Œ\(y+m\)åˆ—çš„çŠ¶æ€ï¼›  
  - ç¬¬ä¸‰è¡Œï¼šè®¡ç®—å››ä¸ªå°å—çš„æ€»è´¡çŒ®ï¼ˆ\(v\)æ˜¯`get`å‡½æ•°çš„ç­‰ä»·ï¼‰ã€‚  
  è°ƒç”¨`max(c3(...,0), c3(...,1))`å°±èƒ½å¾—åˆ°å°å—çš„æœ€ä¼˜å€¼ï¼  
* **å­¦ä¹ ç¬”è®°**ï¼šåˆ†å±‚å‡½æ•°èƒ½æŠŠå¤æ‚é—®é¢˜æ‹†æˆã€Œå¯å¤ç”¨çš„å°æ¨¡å—ã€ï¼Œä»£ç æ›´æ¸…æ™°ï¼


#### é¢˜è§£äºŒï¼šä½œè€…xzyxzy  
* **äº®ç‚¹**ï¼šç”¨`query`å‡½æ•°ç›´æ¥å¯¹åº”ã€Œæ¨å¯¼+è®¡ç®—ã€ï¼Œä»£ç ç®€æ´åˆ°ã€Œä¸€çœ¼çœ‹æ‡‚ã€ï¼  
* **æ ¸å¿ƒä»£ç ç‰‡æ®µ**ï¼š
```cpp
int query(int x, int y, int d) {
    r[x][y] = d; r[x+m][y] = r[m][y] ^ d;
    r[x][y+m] = r[x][m] ^ d;
    r[x+m][y+m] = r[m][y+m] ^ r[x][y+m];
    return F(x,y)+F(x+m,y)+F(x,y+m)+F(x+m,y+m);
}
```
* **ä»£ç è§£è¯»**ï¼š  
  è¿™æ®µä»£ç å’Œé¢˜è§£ä¸€çš„`c3`å¼‚æ›²åŒå·¥ï¼Œä½†æ›´ç®€æ´â€”â€”ç”¨\(d\)è¡¨ç¤º\(rev[x][y]\)çš„çŠ¶æ€ï¼Œæ¨å¯¼å››ä¸ªä½ç½®çš„çŠ¶æ€ï¼Œç„¶åè¿”å›æ€»è´¡çŒ®ï¼ˆ\(F\)æ˜¯`get`å‡½æ•°ï¼‰ã€‚è°ƒç”¨`max(query(...,0), query(...,1))`å°±èƒ½å¾—åˆ°å°å—çš„æœ€ä¼˜å€¼ï¼  
* **å­¦ä¹ ç¬”è®°**ï¼šç®€æ´çš„å‡½æ•°èƒ½è®©æ ¸å¿ƒé€»è¾‘æ›´çªå‡ºï¼


#### é¢˜è§£ä¸‰ï¼šä½œè€…lottle1212__  
* **äº®ç‚¹**ï¼šæœ‰ã€Œè¸©å‘ç»éªŒã€ï¼Œæé†’æˆ‘ä»¬ä¸è¦å±€é™äºå¸¸è§„ç®—æ³•ï¼  
* **æ ¸å¿ƒä»£ç ç‰‡æ®µ**ï¼š
```cpp
for(int i=0;i<(1<<m);i++){
    for(int x=1;x<=m;x++) vis[x][m]=i>>(x-1)&1;
    for(int x=1;x<m;x++) vis[x+m][m]=vis[x][m]^vis[m][m];
    ans=max(ans,Clac());
}
```
* **ä»£ç è§£è¯»**ï¼š  
  è¿™æ˜¯ã€Œæšä¸¾ä¸­é—´åˆ—ã€çš„æ ¸å¿ƒï¼\(i\)æ˜¯ä¸­é—´åˆ—å‰\(m\)è¡Œçš„çŠ¶æ€æ©ç ï¼Œå¾ªç¯æŠŠ`mask`çš„æ¯ä¸€ä½èµ‹å€¼ç»™`vis[x][m]`ï¼Œç„¶åæ¨å¯¼ä¸‹æ–¹\(x+m\)è¡Œçš„çŠ¶æ€ï¼ˆ`vis[x+m][m] = vis[x][m] ^ vis[m][m]`ï¼‰ã€‚æœ€åè°ƒç”¨`Clac()`è®¡ç®—æ€»è´¡çŒ®â€”â€”ç›´æ¥å¯¹åº”ã€Œå…³é”®çº¿æšä¸¾ã€çš„æ€è·¯ï¼  
* **å­¦ä¹ ç¬”è®°**ï¼šæšä¸¾å…³é”®éƒ¨åˆ†èƒ½å¤§å¹…å‡å°‘è®¡ç®—é‡ï¼


## 5. ç®—æ³•å¯è§†åŒ–ï¼šåƒç´ åŠ¨ç”»æ¼”ç¤º

### ğŸ® åŠ¨ç”»æ¼”ç¤ºä¸»é¢˜ï¼šåƒç´ ç¿»è½¬å¤§å¸ˆâ€”â€”å¯»æ‰¾çŸ©é˜µçš„æœ€å¤§æ€»å’Œï¼

### è®¾è®¡æ€è·¯ç®€è¿°  
ç”¨8ä½åƒç´ é£è¿˜åŸçŸ©é˜µï¼Œåƒç©FCä¸Šçš„ã€Œç›Šæ™ºæ‹¼å›¾æ¸¸æˆã€ï¼š  
- ä¸­é—´åˆ—ï¼ˆç¬¬\(m\)åˆ—ï¼‰ç”¨ã€Œé‡‘è‰²ã€çªå‡ºï¼Œä»£è¡¨ã€Œå…³é”®çº¿ã€ï¼›  
- æ¯ä¸ªå°å—ï¼ˆ4ä¸ªå¯¹ç§°ä½ç½®ï¼‰ç”¨ã€Œè“è‰²ã€æ¡†ä½ï¼Œä»£è¡¨ã€Œç‹¬ç«‹è®¡ç®—å•å…ƒã€ï¼›  
- éŸ³æ•ˆï¼šæšä¸¾ä¸­é—´åˆ—æ—¶ã€Œæ»´æ»´ã€å“ï¼Œé€‰æœ€ä¼˜æ—¶ã€Œå®ã€ä¸€å£°ï¼Œå®Œæˆè®¡ç®—æ’­æ”¾ã€Œèƒœåˆ©è¿›è¡Œæ›²ã€ï¼ˆ8ä½é£æ ¼ï¼‰ï¼


### åŠ¨ç”»å¸§æ­¥éª¤ä¸äº¤äº’å…³é”®ç‚¹

#### 1. åœºæ™¯åˆå§‹åŒ–  
- å±å¹•æ˜¾ç¤º\(nÃ—n\)çš„åƒç´ çŸ©é˜µï¼ˆæ¯”å¦‚\(n=3\)æ—¶æ˜¯3Ã—3æ–¹å—ï¼‰ï¼Œä¸­é—´åˆ—æ˜¯é‡‘è‰²ï¼Œå…¶ä»–åˆ—æ˜¯ç°è‰²ï¼›  
- æ§åˆ¶é¢æ¿æœ‰ã€Œå¼€å§‹ã€ã€Œå•æ­¥ã€ã€Œé‡ç½®ã€æŒ‰é’®ï¼Œä»¥åŠã€Œé€Ÿåº¦æ»‘å—ã€ï¼ˆä»ã€Œæ…¢ã€åˆ°ã€Œå¿«ã€ï¼‰ï¼›  
- èƒŒæ™¯æ’­æ”¾8ä½é£æ ¼çš„è½»æ¾BGMï¼ˆæ¯”å¦‚ã€Šè¶…çº§é©¬é‡Œå¥¥ã€‹çš„èƒŒæ™¯éŸ³ä¹ï¼‰ã€‚

#### 2. æšä¸¾ä¸­é—´åˆ—  
- ç‚¹å‡»ã€Œå¼€å§‹ã€ï¼Œä¸­é—´åˆ—çš„é‡‘è‰²å—é€ä¸ªã€Œç‚¹äº®ã€ï¼ˆä»ç¬¬1è¡Œåˆ°ç¬¬\(m\)è¡Œï¼‰ï¼Œæ¯ä¸ªå—ç‚¹äº®æ—¶æ’­æ”¾ã€Œæ»´æ»´ã€å£°ï¼Œå·¦ä¾§æ˜¾ç¤ºå½“å‰`mask`å€¼ï¼ˆæ¯”å¦‚`mask=5`â†’äºŒè¿›åˆ¶`101`ï¼Œå¯¹åº”ç¬¬1ã€3è¡Œäº®ï¼‰ï¼›  
- ç‚¹äº®å®Œæˆåï¼Œä¸­é—´åˆ—çš„åé¢è¡Œï¼ˆ\(m+1\)åˆ°\(n\)ï¼‰è‡ªåŠ¨ã€Œå¡«å……ã€é‡‘è‰²ï¼ˆæ¨å¯¼çŠ¶æ€ï¼‰ï¼Œä¼´éšã€Œå”°ã€çš„éŸ³æ•ˆã€‚

#### 3. è®¡ç®—æ¯åˆ—çš„æœ€ä¼˜å€¼  
- åˆ‡æ¢åˆ°ã€Œå•æ­¥ã€æ¨¡å¼ï¼Œç‚¹å‡»ã€Œä¸‹ä¸€æ­¥ã€ï¼Œå½“å‰å¤„ç†çš„åˆ—ï¼ˆæ¯”å¦‚ç¬¬1åˆ—ï¼‰å˜æˆã€Œæµ…ç»¿è‰²ã€ï¼Œè“è‰²æ¡†ä½å››ä¸ªå°å—ï¼›  
- å°å—é—ªçƒä¸¤æ¬¡ï¼šç¬¬ä¸€æ¬¡æ˜¯\(rev[x][y]=0\)çš„çŠ¶æ€ï¼ˆæ˜¾ç¤ºè´¡çŒ®å€¼ï¼‰ï¼Œç¬¬äºŒæ¬¡æ˜¯\(rev[x][y]=1\)çš„çŠ¶æ€ï¼ˆæ˜¾ç¤ºè´¡çŒ®å€¼ï¼‰ï¼Œç„¶åé€‰æ‹©è¾ƒå¤§çš„é‚£ä¸ªï¼Œå°å—å˜æˆã€Œäº®ç»¿è‰²ã€ï¼Œæ’­æ”¾ã€Œå®ã€å£°ï¼›  
- æ¯å¤„ç†å®Œä¸€åˆ—ï¼Œæµ…ç»¿è‰²æ¶ˆå¤±ï¼Œä¸‹ä¸€åˆ—å˜æˆæµ…ç»¿è‰²ï¼Œç›´åˆ°æ‰€æœ‰åˆ—å¤„ç†å®Œã€‚

#### 4. ç»“æœå±•ç¤º  
- æ‰€æœ‰åˆ—å¤„ç†å®Œåï¼ŒçŸ©é˜µå˜æˆã€Œäº®é»„è‰²ã€ï¼Œå±å¹•ä¸­å¤®æ˜¾ç¤ºã€Œæœ€å¤§æ€»å’Œï¼šXã€ï¼Œæ’­æ”¾8ä½é£æ ¼çš„ã€Œèƒœåˆ©éŸ³æ•ˆã€ï¼ˆæ¯”å¦‚ã€Šé­‚æ–—ç½—ã€‹çš„é€šå…³éŸ³ä¹ï¼‰ï¼›  
- å¦‚æœå½“å‰`mask`ä¸æ˜¯æœ€ä¼˜ï¼Œç‚¹å‡»ã€Œä¸‹ä¸€ä¸ªmaskã€ï¼ŒçŸ©é˜µé‡ç½®ï¼Œé‡å¤æ­¥éª¤2-3ã€‚


## 6. æ‹“å±•ç»ƒä¹ ä¸ç›¸ä¼¼é—®é¢˜æ€è€ƒ

### é€šç”¨æ€è·¯è¿ç§»  
æœ¬é¢˜çš„ã€Œå…³é”®çº¿æšä¸¾ã€æŠ€å·§ï¼Œåƒã€Œæ‰¾é—®é¢˜çš„å¯¹ç§°è½´ã€â€”â€”åªè¦æ‰¾åˆ°ã€Œå¯¹ç§°è½´ã€ï¼ˆä¸­é—´è¡Œ/åˆ—ã€ç‰¹æ®Šçº¦æŸï¼‰ï¼Œå°±èƒ½æŠŠé«˜æ¬¡å¹‚æšä¸¾é™åˆ°ä½æ¬¡å¹‚ã€‚è¿™ç§æŠ€å·§å¸¸ç”¨äºï¼š  
1. ç¿»è½¬é—®é¢˜ï¼ˆæ¯æ¬¡ç¿»è½¬å›ºå®šå¤§å°çš„å­çŸ©é˜µï¼‰ï¼›  
2. çŠ¶æ€è½¬ç§»æœ‰ä¾èµ–çš„é—®é¢˜ï¼ˆæ¯”å¦‚Açš„çŠ¶æ€ä¾èµ–Bï¼‰ï¼›  
3. æœ€ä¼˜å­ç»“æ„é—®é¢˜ï¼ˆæ¯ä¸ªå­é—®é¢˜ç‹¬ç«‹ï¼Œå¯è´ªå¿ƒé€‰æœ€ä¼˜ï¼‰ã€‚


### ç»ƒä¹ æ¨èï¼ˆæ´›è°·ï¼‰  
1. **æ´›è°·P1433 åƒå¥¶é…ª**ï¼šç”¨çŠ¶æ€å‹ç¼©DPï¼Œä½†å¯ä»¥å°è¯•æ‰¾ã€Œå…³é”®ç‚¹ã€ä¼˜åŒ–æšä¸¾ï¼›  
2. **æ´›è°·P1092 è™«é£Ÿç®—**ï¼šåˆ©ç”¨ç«–å¼çš„çº¦æŸæ¡ä»¶ï¼Œå‡å°‘æšä¸¾èŒƒå›´ï¼›  
3. **æ´›è°·P2036 PERKET**ï¼šæšä¸¾æ‰€æœ‰ç»„åˆï¼Œä½†å¯ä»¥åˆ©ç”¨ã€Œé€‰æˆ–ä¸é€‰ã€çš„ç‹¬ç«‹æ€§ä¼˜åŒ–ã€‚


## 7. å­¦ä¹ å¿ƒå¾—ä¸ç»éªŒåˆ†äº«

å‚è€ƒç»éªŒï¼ˆæ¥è‡ªlottle1212__ï¼‰ï¼š  
> ã€Œæˆ‘ä¸€å¼€å§‹æƒ³è´ªå¿ƒæˆ–åŠ¨æ€è§„åˆ’ï¼Œä½†çŸ¥é“äº†æ­£ç¡®è§£æ³•åï¼Œæ‰è§‰è‡ªå·±çš„æƒ³æ³•å¾ˆå¯ç¬‘ã€‚è¿™é¢˜çš„æ•™è®­å°±æ˜¯åœ¨æš´åŠ›æšä¸¾å‰åŠ¡å¿…è§‚å¯Ÿæ€§è´¨ï¼Œæœ‰äº›éƒ¨åˆ†å¯ä»¥ç‹¬ç«‹æšä¸¾çš„å°±åˆ†å¼€æ¥ï¼Œäºæ˜¯å¤§å¤§é™ä½äº†å¤æ‚åº¦ã€‚ã€

**ç‚¹è¯„**ï¼š  
è¿™ä½ä½œè€…çš„ã€Œè¸©å‘ç»éªŒã€å¤ªçœŸå®äº†ï¼å¾ˆå¤šæ—¶å€™æˆ‘ä»¬ä¼šã€Œæƒ¯æ€§æ€ç»´ã€ï¼ˆæ¯”å¦‚çœ‹åˆ°æœ€å¤§å€¼å°±æƒ³DPï¼‰ï¼Œä½†**é—®é¢˜çš„ç‰¹æ®Šæ€§è´¨æ‰æ˜¯è§£é¢˜çš„å…³é”®**ï¼å°±åƒè¿™é“é¢˜ï¼Œç¿»è½¬æ“ä½œçš„ã€Œå¼‚æˆ–çº¦æŸã€æ˜¯ã€Œéšè—çš„é’¥åŒ™ã€ï¼Œæ‰¾åˆ°äº†å®ƒï¼Œå°±èƒ½æ‰“å¼€ã€Œä¼˜åŒ–æšä¸¾ã€çš„å¤§é—¨ã€‚ä¸‹æ¬¡é‡åˆ°æšä¸¾é¢˜ï¼Œå…ˆé—®è‡ªå·±ï¼šã€Œæœ‰æ²¡æœ‰ä»€ä¹ˆçº¦æŸæ¡ä»¶èƒ½å‡å°‘æˆ‘è¦æšä¸¾çš„å†…å®¹ï¼Ÿã€


## âœ¨ ç»“è¯­  
æœ¬æ¬¡å…³äºCF321Dçš„åˆ†æå°±åˆ°è¿™é‡Œï¼è®°ä½ï¼š**ç¼–ç¨‹ä¸æ˜¯ã€Œæš´åŠ›è§£é¢˜ã€ï¼Œè€Œæ˜¯ã€Œæ‰¾è§„å¾‹+ä¼˜åŒ–ã€**â€”â€”å°±åƒæ‰¾æ‹¼å›¾çš„å…³é”®çº¿ï¼Œæ‰¾å¯¹äº†ï¼Œé—®é¢˜å°±ç®€å•äº†ï¼ä¸‹æ¬¡æˆ‘ä»¬å†ä¸€èµ·æ¢ç´¢æ–°çš„æŒ‘æˆ˜ï½ ğŸ’ª

---
å¤„ç†ç”¨æ—¶ï¼š176.89ç§’
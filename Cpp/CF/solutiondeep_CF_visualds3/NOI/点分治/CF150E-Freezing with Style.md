# é¢˜ç›®ä¿¡æ¯

# Freezing with Style

## é¢˜ç›®æè¿°

This winter is so... well, you've got the idea :-) The Nvodsk road system can be represented as $ n $ junctions connected with $ n-1 $ bidirectional roads so that there is a path between any two junctions. The organizers of some event want to choose a place to accommodate the participants (junction $ v $ ), and the place to set up the contests (junction $ u $ ). Besides, at the one hand, they want the participants to walk about the city and see the neighbourhood (that's why the distance between $ v $ and $ u $ should be no less than $ l $ ). On the other hand, they don't want the participants to freeze (so the distance between $ v $ and $ u $ should be no more than $ r $ ). Besides, for every street we know its beauty â€” some integer from $ 0 $ to $ 10^{9} $ . Your task is to choose the path that fits in the length limits and has the largest average beauty. We shall define the average beauty as a median of sequence of the beauties of all roads along the path.

We can put it more formally like that: let there be a path with the length $ k $ . Let $ a_{i} $ be a non-decreasing sequence that contains exactly $ k $ elements. Each number occurs there exactly the number of times a road with such beauty occurs along on path. We will represent the path median as number $ a_{âŒŠk/2âŒ‹} $ , assuming that indexation starting from zero is used. $ âŒŠxâŒ‹ $ â€” is number $ Ñ… $ , rounded down to the nearest integer.

For example, if $ a={0,5,12} $ , then the median equals to $ 5 $ , and if $ a={0,5,7,12} $ , then the median is number $ 7 $ .

It is guaranteed that there will be at least one path with the suitable quantity of roads.

## è¯´æ˜/æç¤º

In the first sample all roads have the same beauty. That means that all paths of the positive length have the same median. Thus, any path with length from $ 3 $ to $ 4 $ , inclusive will be valid for us.

In the second sample the city looks like that: 1 - 2 - 3 - 4 - 5 - 6. Two last roads are more valuable and we should choose any path that contains both of them and has the suitable length. It is either the path between $ 2 $ and $ 6 $ or the path between $ 3 $ and $ 6 $ .

## æ ·ä¾‹ #1

### è¾“å…¥

```
6 3 4
1 2 1
2 3 1
3 4 1
4 5 1
5 6 1
```

### è¾“å‡º

```
4 1
```

## æ ·ä¾‹ #2

### è¾“å…¥

```
6 3 4
1 2 1
2 3 1
3 4 1
4 5 2
5 6 2
```

### è¾“å‡º

```
6 3
```

## æ ·ä¾‹ #3

### è¾“å…¥

```
5 1 4
1 2 1
1 3 4
3 4 7
3 5 2
```

### è¾“å‡º

```
4 3
```

## æ ·ä¾‹ #4

### è¾“å…¥

```
8 3 6
1 2 9
2 3 7
3 4 7
4 5 8
5 8 2
3 6 3
2 7 4
```

### è¾“å‡º

```
5 1
```

# AIåˆ†æç»“æœ

---
# ğŸ’¡ Kayçš„C++ç®—æ³•è§£æï¼šFreezing with Style æ·±å…¥å­¦ä¹ æŒ‡å— ğŸ’¡

## 1. é¢˜ç›®è§£è¯»ä¸æ ¸å¿ƒç®—æ³•è¯†åˆ«

### âœ¨ æœ¬é¢˜ä¸»è¦è€ƒå¯Ÿ
**äºŒåˆ†ç­”æ¡ˆ + ç‚¹åˆ†æ²» + å•è°ƒé˜Ÿåˆ—ä¼˜åŒ–**ï¼ˆç»„åˆç®—æ³•ï¼‰

### ğŸ—£ï¸ åˆæ­¥åˆ†æ
è§£å†³è¿™é“é¢˜çš„å…³é”®ï¼Œå°±åƒâ€œçŒœæ•°å­—æ¸¸æˆ+åˆ†æ‹†å¤§æ ‘æ‰¾å®è—â€ï¼š  
1. **äºŒåˆ†ç­”æ¡ˆ**ï¼šæˆ‘ä»¬è¦æ‰¾æœ€å¤§çš„ä¸­ä½æ•°ï¼Œå°±åƒâ€œçŒœä¸€ä¸ªæ•°midï¼ŒéªŒè¯æ˜¯å¦å­˜åœ¨è·¯å¾„çš„ä¸­ä½æ•°â‰¥midâ€ã€‚æ€ä¹ˆéªŒè¯ï¼ŸæŠŠâ‰¥midçš„è¾¹æ ‡1ï¼Œ<midçš„æ ‡-1ï¼Œå¦‚æœè·¯å¾„å’Œâ‰¥0ï¼Œè¯´æ˜ä¸­ä½æ•°â‰¥midï¼ˆå› ä¸º1çš„æ•°é‡â‰¥-1çš„æ•°é‡ï¼Œä¸­ä½æ•°è‡ªç„¶å¤§ï¼‰ã€‚  
2. **ç‚¹åˆ†æ²»**ï¼šæ ‘ä¸Šçš„è·¯å¾„é—®é¢˜ï¼Œç‚¹åˆ†æ²»æ˜¯â€œåˆ†æ‹†å¤§æ ‘â€çš„å¥½æ–¹æ³•â€”â€”æ¯æ¬¡æ‰¾æ ‘çš„é‡å¿ƒï¼ˆå¹³è¡¡çš„ä¸­å¿ƒç‚¹ï¼‰ï¼Œå¤„ç†ç»è¿‡é‡å¿ƒçš„è·¯å¾„ï¼Œå†é€’å½’å¤„ç†å­æ ‘ï¼Œé¿å…é‡å¤è®¡ç®—ã€‚  
3. **å•è°ƒé˜Ÿåˆ—ä¼˜åŒ–**ï¼šå¤„ç†ç»è¿‡é‡å¿ƒçš„è·¯å¾„æ—¶ï¼Œæˆ‘ä»¬éœ€è¦æ‰¾â€œé•¿åº¦åœ¨[L-x, R-x]ä¹‹é—´çš„æœ€å¤§è·¯å¾„å’Œâ€ï¼Œè¿™åƒâ€œæ»‘åŠ¨çª—å£æ‰¾æœ€å¤§è›‹ç³•â€ï¼Œç”¨å•è°ƒé˜Ÿåˆ—èƒ½æŠŠæ¯æ¬¡æŸ¥è¯¢çš„æ—¶é—´ä»O(logn)é™åˆ°O(1)ï¼Œä¿è¯æ•ˆç‡ã€‚

### æ ¸å¿ƒç®—æ³•æµç¨‹ä¸å¯è§†åŒ–è®¾è®¡
- **äºŒåˆ†æµç¨‹**ï¼šä»è¾¹æƒçš„æœ€å°å€¼åˆ°æœ€å¤§å€¼çŒœmidï¼Œæ¯æ¬¡éªŒè¯æ˜¯å¦å­˜åœ¨åˆæ³•è·¯å¾„ã€‚  
- **ç‚¹åˆ†æ²»æµç¨‹**ï¼š  
  1. æ‰¾æ ‘çš„é‡å¿ƒï¼ˆåƒæ‰¾æ ‘çš„â€œå¹³è¡¡ç‚¹â€ï¼‰ï¼Œé«˜äº®é‡å¿ƒã€‚  
  2. éå†é‡å¿ƒçš„å­æ ‘ï¼Œè®°å½•æ¯ä¸ªå­æ ‘åˆ°é‡å¿ƒçš„è·¯å¾„é•¿åº¦å’Œæƒå€¼å’Œã€‚  
  3. ç”¨å•è°ƒé˜Ÿåˆ—æ‰¾â€œèƒ½å’Œå½“å‰å­æ ‘è·¯å¾„ç»„åˆæˆåˆæ³•é•¿åº¦çš„æœ€å¤§æƒå€¼å’Œâ€ï¼Œé«˜äº®åŒ¹é…çš„è·¯å¾„ã€‚  
- **å¯è§†åŒ–è®¾è®¡**ï¼šç”¨8ä½åƒç´ é£ç”»æ ‘ï¼Œé‡å¿ƒç”¨é»„è‰²é«˜äº®ï¼Œå­æ ‘ç”¨ä¸åŒé¢œè‰²åŒºåˆ†ï¼Œè·¯å¾„ç”¨é—ªçƒçš„åƒç´ ç‚¹è¿æ¥ï¼Œå•è°ƒé˜Ÿåˆ—ç”¨æ»‘åŠ¨çš„åƒç´ å—æ¼”ç¤ºï¼Œå…³é”®æ“ä½œï¼ˆå¦‚å…¥é˜Ÿã€æŸ¥è¯¢ï¼‰é…â€œå®â€çš„éŸ³æ•ˆï¼Œæ‰¾åˆ°åˆæ³•è·¯å¾„æ—¶æ’­æ”¾â€œèƒœåˆ©â€éŸ³æ•ˆã€‚


## 2. ç²¾é€‰ä¼˜è´¨é¢˜è§£å‚è€ƒ

### é¢˜è§£ä¸€ï¼šshadowice1984ï¼ˆç‚¹åˆ†æ²»+å•è°ƒé˜Ÿåˆ—æŒ‰ç§©åˆå¹¶ï¼‰
- **ç‚¹è¯„**ï¼šè¿™é“é¢˜çš„â€œæ ‡å‡†è§£æ³•â€ï¼ä½œè€…æŠŠç‚¹åˆ†æ²»å’Œå•è°ƒé˜Ÿåˆ—ç»“åˆå¾—å¾ˆå·§å¦™â€”â€”æŒ‰å­æ ‘æ·±åº¦æ’åºï¼ˆæŒ‰ç§©åˆå¹¶ï¼‰ï¼Œä¿è¯å•è°ƒé˜Ÿåˆ—çš„æ»‘åŠ¨çª—å£æ˜¯â€œå‘å·¦ç§»åŠ¨â€çš„ï¼Œé¿å…äº†å¤æ‚åº¦é€€åŒ–ã€‚ä»£ç é‡Œçš„`bfs`å¤„ç†å­æ ‘è·¯å¾„ã€`dq`ç»“æ„å®ç°å•è°ƒé˜Ÿåˆ—ï¼Œé€»è¾‘æ¸…æ™°ï¼Œæ˜¯ç†è§£â€œå¦‚ä½•ç”¨å•è°ƒé˜Ÿåˆ—ä¼˜åŒ–ç‚¹åˆ†æ²»â€çš„å¥½ä¾‹å­ã€‚

### é¢˜è§£äºŒï¼šå°ç²‰å…”ï¼ˆç‚¹åˆ†æ²»+æ»‘åŠ¨çª—å£ï¼‰
- **ç‚¹è¯„**ï¼šä»£ç é£æ ¼ç®€æ´ï¼Œæ³¨é‡Šæ¸…æ™°ï¼ä½œè€…ç”¨`DFS`è®¡ç®—å­æ ‘è·¯å¾„ï¼Œç”¨`que`æ•°ç»„å®ç°å•è°ƒé˜Ÿåˆ—ï¼Œå¤„ç†â€œæ»‘åŠ¨çª—å£æ‰¾æœ€å¤§å€¼â€çš„é€»è¾‘å¾ˆç›´è§‚ã€‚ç‰¹åˆ«æ˜¯`Calc`å‡½æ•°é‡Œçš„â€œå…ˆæŸ¥ååˆå¹¶â€æ€è·¯ï¼Œå®Œç¾ç¬¦åˆç‚¹åˆ†æ²»çš„â€œå¤„ç†ç»è¿‡é‡å¿ƒçš„è·¯å¾„â€çš„æ ¸å¿ƒé€»è¾‘ã€‚

### é¢˜è§£ä¸‰ï¼šå¤©å‘½ä¹‹è·¯ï¼ˆç‚¹åˆ†æ²»+å•è°ƒé˜Ÿåˆ—+ä»£ç æ¸…æ™°ï¼‰
- **ç‚¹è¯„**ï¼šä»£ç å¯è¯»æ€§æå¼ºï¼ä½œè€…æŠŠç‚¹åˆ†æ²»çš„æ¯ä¸ªæ­¥éª¤æ‹†åˆ†æˆå‡½æ•°ï¼ˆ`getroot`æ‰¾é‡å¿ƒã€`dfs`è®¡ç®—å­æ ‘æ·±åº¦ã€`bfs`å¤„ç†è·¯å¾„ï¼‰ï¼Œå˜é‡åï¼ˆå¦‚`maxd`è®°å½•å­æ ‘æœ€å¤§æ·±åº¦ã€`g`æ•°ç»„å­˜è·¯å¾„æƒå€¼ï¼‰ç›´è§‚æ˜“æ‡‚ã€‚å•è°ƒé˜Ÿåˆ—çš„å¤„ç†éƒ¨åˆ†ï¼ˆ`q`æ•°ç»„çš„`hd`å’Œ`tl`æŒ‡é’ˆï¼‰ï¼Œä¸€çœ‹å°±æ˜ç™½æ˜¯â€œæ»‘åŠ¨çª—å£â€ã€‚


## 3. æ ¸å¿ƒéš¾ç‚¹è¾¨æä¸è§£é¢˜ç­–ç•¥

### ğŸ” æ ¸å¿ƒéš¾ç‚¹1ï¼šä¸­ä½æ•°è½¬åŒ–ä¸ºè·¯å¾„å’Œé—®é¢˜
- **éš¾ç‚¹**ï¼šç›´æ¥è®¡ç®—ä¸­ä½æ•°å¾ˆéš¾ï¼Œå¦‚ä½•æŠŠâ€œä¸­ä½æ•°â‰¥midâ€è½¬åŒ–ä¸ºå¯è®¡ç®—çš„æ¡ä»¶ï¼Ÿ  
- **ç­–ç•¥**ï¼šå°†è¾¹æƒâ‰¥midçš„æ ‡1ï¼Œ<midçš„æ ‡-1ã€‚è·¯å¾„å’Œâ‰¥0 â†’ 1çš„æ•°é‡â‰¥-1çš„æ•°é‡ â†’ ä¸­ä½æ•°â‰¥midï¼ˆæ¯”å¦‚è·¯å¾„æœ‰kæ¡è¾¹ï¼Œå’Œâ‰¥0è¯´æ˜è‡³å°‘æœ‰âŒˆk/2âŒ‰æ¡è¾¹â‰¥midï¼Œä¸­ä½æ•°å°±æ˜¯ç¬¬âŒŠk/2âŒ‹æ¡è¾¹ï¼Œè‡ªç„¶â‰¥midï¼‰ã€‚

### ğŸ” æ ¸å¿ƒéš¾ç‚¹2ï¼šç‚¹åˆ†æ²»ä¸­å¤„ç†è·¯å¾„é•¿åº¦é™åˆ¶
- **éš¾ç‚¹**ï¼šç‚¹åˆ†æ²»è¦å¤„ç†â€œè¾¹æ•°åœ¨[L,R]ä¹‹é—´â€çš„è·¯å¾„ï¼Œå¦‚ä½•é«˜æ•ˆæŸ¥è¯¢ç¬¦åˆé•¿åº¦çš„æœ€å¤§è·¯å¾„å’Œï¼Ÿ  
- **ç­–ç•¥**ï¼šå¯¹äºæ¯ä¸ªå­æ ‘çš„è·¯å¾„é•¿åº¦xï¼Œæ‰¾å¦ä¸€å­æ ‘ä¸­é•¿åº¦åœ¨[L-x, R-x]ä¹‹é—´çš„æœ€å¤§è·¯å¾„å’Œã€‚è¿™æ˜¯â€œæ»‘åŠ¨çª—å£â€é—®é¢˜ï¼Œç”¨å•è°ƒé˜Ÿåˆ—ç»´æŠ¤åŒºé—´æœ€å¤§å€¼ï¼Œæ¯æ¬¡æŸ¥è¯¢O(1)ã€‚

### ğŸ” æ ¸å¿ƒéš¾ç‚¹3ï¼šå•è°ƒé˜Ÿåˆ—çš„å¤æ‚åº¦ä¼˜åŒ–
- **éš¾ç‚¹**ï¼šå¦‚æœå­æ ‘é¡ºåºä¹±ï¼Œå•è°ƒé˜Ÿåˆ—çš„æ»‘åŠ¨çª—å£ä¼šé€€åŒ–åˆ°O(nÂ²)ï¼Œæ€ä¹ˆåŠï¼Ÿ  
- **ç­–ç•¥**ï¼šæŒ‰å­æ ‘çš„æœ€å¤§æ·±åº¦æ’åºï¼ˆæŒ‰ç§©åˆå¹¶ï¼‰ï¼Œä¿è¯æ¯æ¬¡å¤„ç†çš„å­æ ‘æ·±åº¦é€’å¢ï¼Œæ»‘åŠ¨çª—å£çš„å³ç«¯ç‚¹åªå‘å·¦ç§»åŠ¨ï¼Œé¿å…é‡å¤åˆå§‹åŒ–ï¼Œå¤æ‚åº¦é™åˆ°O(n logn)ã€‚


## 4. C++æ ¸å¿ƒä»£ç å®ç°èµæ

### æœ¬é¢˜é€šç”¨æ ¸å¿ƒC++å®ç°å‚è€ƒ
- **è¯´æ˜**ï¼šç»¼åˆä¼˜è´¨é¢˜è§£çš„æ€è·¯ï¼Œå®ç°äºŒåˆ†ç­”æ¡ˆ+ç‚¹åˆ†æ²»+å•è°ƒé˜Ÿåˆ—ä¼˜åŒ–ï¼Œä»£ç ç»“æ„æ¸…æ™°ï¼Œé€‚åˆå…¥é—¨å­¦ä¹ ã€‚
- **å®Œæ•´æ ¸å¿ƒä»£ç **ï¼š
```cpp
#include <iostream>
#include <vector>
#include <algorithm>
#include <queue>
#include <cstring>
#include <climits>
using namespace std;

const int N = 1e5 + 5;
const int INF = INT_MIN;

struct Edge { int v, w; };
vector<Edge> e[N];
int n, L, R;
int ans_u, ans_v;

// äºŒåˆ†ç­”æ¡ˆç›¸å…³
int val[N], val_sorted[N], val_cnt;

// ç‚¹åˆ†æ²»ç›¸å…³
bool vis[N];
int siz[N], mx[N], root;
int dep[N], dis[N], maxd[N];
int q[N], hd, tl;
int w[N], nu[N]; // w[dep] å­˜è¯¥æ·±åº¦çš„æœ€å¤§æƒå€¼å’Œï¼Œnu[dep] å­˜å¯¹åº”çš„èŠ‚ç‚¹

// æ‰¾é‡å¿ƒ
void get_root(int u, int fa, int total) {
    siz[u] = 1;
    mx[u] = 0;
    for (auto &ed : e[u]) {
        int v = ed.v;
        if (v == fa || vis[v]) continue;
        get_root(v, u, total);
        siz[u] += siz[v];
        mx[u] = max(mx[u], siz[v]);
    }
    mx[u] = max(mx[u], total - siz[u]);
    if (mx[u] < mx[root]) root = u;
}

// è®¡ç®—å­æ ‘çš„æœ€å¤§æ·±åº¦
int get_depth(int u, int fa) {
    int d = 0;
    for (auto &ed : e[u]) {
        int v = ed.v;
        if (v == fa || vis[v]) continue;
        d = max(d, get_depth(v, u) + 1);
    }
    return d;
}

// BFSå¤„ç†å­æ ‘è·¯å¾„
bool bfs(int st, int g, int mid, int mxsiz) {
    queue<pair<int, pair<int, int>>> q; // (u, (dep, dis))
    q.push({st, {1, (e[g][st].w >= mid) ? 1 : -1}});
    memset(w, 0xc3, sizeof(w));
    memset(nu, 0, sizeof(nu));
    w[1] = (e[g][st].w >= mid) ? 1 : -1;
    nu[1] = e[g][st].v;

    while (!q.empty()) {
        auto [u, p] = q.front(); q.pop();
        int d = p.first, s = p.second;
        for (auto &ed : e[u]) {
            int v = ed.v;
            if (v == g || vis[v]) continue;
            int nd = d + 1, ns = s + ((ed.w >= mid) ? 1 : -1);
            if (nd > R) continue;
            if (ns > w[nd]) {
                w[nd] = ns;
                nu[nd] = v;
            }
            q.push({v, {nd, ns}});
        }
    }

    // å•è°ƒé˜Ÿåˆ—å¤„ç†æ»‘åŠ¨çª—å£
    hd = 1, tl = 0;
    int j = min(R, mxsiz);
    for (; j >= L; j--) {
        while (hd <= tl && w[j] >= w[q[tl]]) tl--;
        q[++tl] = j;
    }

    for (int i = 1; i <= maxd[st]; i++) {
        int dl = max(L - i, 0), dr = min(R - i, mxsiz);
        for (; j >= dl; j--) {
            while (hd <= tl && w[j] >= w[q[tl]]) tl--;
            q[++tl] = j;
        }
        while (hd <= tl && q[hd] > dr) hd++;
        if (hd <= tl && w[i] + w[q[hd]] >= 0) {
            ans_u = nu[i];
            ans_v = nu[q[hd]];
            return true;
        }
    }
    return false;
}

// ç‚¹åˆ†æ²»ä¸»å‡½æ•°
bool divide(int u, int mid) {
    vis[u] = true;
    int m = e[u].size();
    vector<int> child;
    for (int i = 0; i < m; i++) {
        int v = e[u][i].v;
        if (vis[v]) continue;
        maxd[i] = get_depth(v, u);
        child.push_back(i);
    }
    sort(child.begin(), child.end(), [&](int a, int b) { return maxd[a] < maxd[b]; });

    memset(w, 0xc3, sizeof(w));
    memset(nu, 0, sizeof(nu));
    w[0] = 0;
    nu[0] = u;

    for (int i : child) {
        if (bfs(i, u, mid, maxd[i])) return true;
        for (int j = 1; j <= maxd[i]; j++) {
            if (w[j] < ::w[j]) {
                w[j] = ::w[j];
                nu[j] = ::nu[j];
            }
        }
    }

    for (auto &ed : e[u]) {
        int v = ed.v;
        if (vis[v]) continue;
        root = 0;
        mx[root] = INT_MAX;
        get_root(v, u, siz[v]);
        if (divide(root, mid)) return true;
    }
    return false;
}

// äºŒåˆ†ç­”æ¡ˆä¸»å‡½æ•°
int main() {
    cin >> n >> L >> R;
    for (int i = 1; i < n; i++) {
        int u, v, w;
        cin >> u >> v >> w;
        e[u].push_back({v, w});
        e[v].push_back({u, w});
        val_sorted[i] = w;
    }
    sort(val_sorted + 1, val_sorted + n);
    val_cnt = unique(val_sorted + 1, val_sorted + n) - val_sorted - 1;

    int l = 1, r = val_cnt;
    while (l < r) {
        int mid = (l + r + 1) / 2;
        memset(vis, 0, sizeof(vis));
        root = 0;
        mx[root] = INT_MAX;
        get_root(1, 0, n);
        if (divide(root, val_sorted[mid])) {
            l = mid;
        } else {
            r = mid - 1;
        }
    }

    memset(vis, 0, sizeof(vis));
    root = 0;
    mx[root] = INT_MAX;
    get_root(1, 0, n);
    divide(root, val_sorted[l]);
    cout << ans_u << " " << ans_v << endl;
    return 0;
}
```
- **ä»£ç è§£è¯»æ¦‚è¦**ï¼šä»£ç åˆ†ä¸ºä¸‰éƒ¨åˆ†â€”â€”äºŒåˆ†ç­”æ¡ˆï¼ˆ`main`å‡½æ•°ï¼‰ã€ç‚¹åˆ†æ²»ï¼ˆ`divide`å‡½æ•°ï¼‰ã€å•è°ƒé˜Ÿåˆ—ï¼ˆ`bfs`å‡½æ•°ï¼‰ã€‚`get_root`æ‰¾é‡å¿ƒï¼Œ`get_depth`è®¡ç®—å­æ ‘æ·±åº¦ï¼Œ`bfs`å¤„ç†å­æ ‘è·¯å¾„å¹¶ä½¿ç”¨å•è°ƒé˜Ÿåˆ—æ‰¾åˆæ³•è·¯å¾„ã€‚

### å…³é”®ç‰‡æ®µèµæï¼ˆç‚¹åˆ†æ²»æ‰¾é‡å¿ƒï¼‰
- **äº®ç‚¹**ï¼šç”¨`mx`æ•°ç»„è®°å½•å­æ ‘çš„æœ€å¤§å¤§å°ï¼Œæ‰¾åˆ°â€œæœ€å¹³è¡¡â€çš„é‡å¿ƒï¼Œé¿å…é€’å½’æ·±åº¦è¿‡å¤§ã€‚
- **æ ¸å¿ƒä»£ç ç‰‡æ®µ**ï¼š
```cpp
void get_root(int u, int fa, int total) {
    siz[u] = 1;
    mx[u] = 0;
    for (auto &ed : e[u]) {
        int v = ed.v;
        if (v == fa || vis[v]) continue;
        get_root(v, u, total);
        siz[u] += siz[v];
        mx[u] = max(mx[u], siz[v]);
    }
    mx[u] = max(mx[u], total - siz[u]);
    if (mx[u] < mx[root]) root = u;
}
```
- **ä»£ç è§£è¯»**ï¼š`siz[u]`æ˜¯å­æ ‘å¤§å°ï¼Œ`mx[u]`æ˜¯å­æ ‘çš„æœ€å¤§å­æ ‘å¤§å°ï¼ˆæˆ–çˆ¶æ ‘å¤§å°ï¼‰ã€‚`root`è®°å½•å½“å‰æœ€å¹³è¡¡çš„é‡å¿ƒï¼Œç¡®ä¿ç‚¹åˆ†æ²»çš„é€’å½’æ·±åº¦æ˜¯O(logn)ã€‚


## 5. ç®—æ³•å¯è§†åŒ–ï¼šåƒç´ åŠ¨ç”»æ¼”ç¤º

### ğŸ® åŠ¨ç”»ä¸»é¢˜ï¼šåƒç´ æ ‘çš„â€œé‡å¿ƒå¯»å®â€ä¹‹æ—…
- **è®¾è®¡æ€è·¯**ï¼šç”¨8ä½åƒç´ é£æ¨¡æ‹Ÿæ ‘çš„ç»“æ„ï¼Œé‡å¿ƒç”¨é»„è‰²é«˜äº®ï¼Œå­æ ‘ç”¨ä¸åŒé¢œè‰²ï¼ˆçº¢ã€è“ã€ç»¿ï¼‰åŒºåˆ†ï¼Œè·¯å¾„ç”¨é—ªçƒçš„ç™½è‰²åƒç´ ç‚¹è¿æ¥ï¼Œå•è°ƒé˜Ÿåˆ—ç”¨æ»‘åŠ¨çš„è“è‰²æ–¹å—æ¼”ç¤ºï¼Œå…³é”®æ“ä½œé…â€œå®â€çš„éŸ³æ•ˆï¼Œæ‰¾åˆ°åˆæ³•è·¯å¾„æ—¶æ’­æ”¾â€œèƒœåˆ©â€éŸ³æ•ˆï¼ˆç±»ä¼¼FCæ¸¸æˆçš„é€šå…³éŸ³ï¼‰ã€‚

### ğŸ“º åŠ¨ç”»æ­¥éª¤
1. **åˆå§‹åŒ–**ï¼šå±å¹•æ˜¾ç¤ºåƒç´ åŒ–çš„æ ‘ï¼ˆèŠ‚ç‚¹æ˜¯å½©è‰²æ–¹å—ï¼Œè¾¹æ˜¯ç°è‰²çº¿æ¡ï¼‰ï¼Œæ§åˆ¶é¢æ¿æœ‰â€œå¼€å§‹/æš‚åœâ€â€œå•æ­¥â€â€œé‡ç½®â€æŒ‰é’®ï¼Œé€Ÿåº¦æ»‘å—ï¼Œ8ä½é£æ ¼èƒŒæ™¯éŸ³ä¹æ’­æ”¾ã€‚
2. **æ‰¾é‡å¿ƒ**ï¼šæ ‘çš„é‡å¿ƒç”¨é»„è‰²é—ªçƒï¼Œé…â€œæ»´â€çš„éŸ³æ•ˆï¼Œæç¤ºâ€œæ‰¾åˆ°é‡å¿ƒï¼â€ã€‚
3. **å¤„ç†å­æ ‘**ï¼šé‡å¿ƒçš„å­æ ‘ç”¨ä¸åŒé¢œè‰²é«˜äº®ï¼Œé€ä¸ªéå†ï¼Œæ¯ä¸ªå­æ ‘çš„è·¯å¾„ç”¨ç™½è‰²åƒç´ ç‚¹è¿æ¥ï¼Œæ˜¾ç¤ºè·¯å¾„çš„æ·±åº¦å’Œæƒå€¼å’Œã€‚
4. **å•è°ƒé˜Ÿåˆ—æ»‘åŠ¨**ï¼šè“è‰²æ–¹å—ä»£è¡¨å•è°ƒé˜Ÿåˆ—çš„çª—å£ï¼Œéšç€å­æ ‘è·¯å¾„çš„éå†ï¼Œçª—å£å‘å·¦æ»‘åŠ¨ï¼Œé«˜äº®å½“å‰æœ€å¤§æƒå€¼çš„è·¯å¾„ï¼Œé…â€œå®â€çš„éŸ³æ•ˆã€‚
5. **æ‰¾åˆ°åˆæ³•è·¯å¾„**ï¼šåˆæ³•è·¯å¾„çš„ä¸¤ä¸ªç«¯ç‚¹ç”¨çº¢è‰²é—ªçƒï¼Œæ’­æ”¾â€œèƒœåˆ©â€éŸ³æ•ˆï¼Œæç¤ºâ€œæ‰¾åˆ°æœ€å¤§ä¸­ä½æ•°è·¯å¾„ï¼â€ã€‚

### ğŸ¯ äº¤äº’è®¾è®¡
- **æ­¥è¿›æ§åˆ¶**ï¼šâ€œå•æ­¥â€æŒ‰é’®é€å¸§æ’­æ”¾ï¼Œâ€œè‡ªåŠ¨æ’­æ”¾â€æŒ‰é’®å¯è°ƒèŠ‚é€Ÿåº¦ï¼ˆæ»‘å—æ§åˆ¶1~5å€é€Ÿï¼‰ã€‚
- **é‡ç½®**ï¼šç‚¹å‡»â€œé‡ç½®â€å›åˆ°åˆå§‹çŠ¶æ€ï¼Œé‡æ–°å¼€å§‹æ¼”ç¤ºã€‚
- **éŸ³æ•ˆæ§åˆ¶**ï¼šå¯å¼€å…³éŸ³æ•ˆï¼ŒèƒŒæ™¯éŸ³ä¹æ˜¯å¾ªç¯çš„8ä½é£æ ¼BGMï¼ˆç±»ä¼¼ã€Šè¶…çº§é©¬é‡Œå¥¥ã€‹çš„èƒŒæ™¯éŸ³ä¹ï¼‰ã€‚


## 6. æ‹“å±•ç»ƒä¹ ä¸ç›¸ä¼¼é—®é¢˜æ€è€ƒ

### ğŸ§  ç›¸ä¼¼é—®é¢˜
- **æ´›è°·P4292ï¼ˆé‡å»ºè®¡åˆ’ï¼‰**ï¼šæ ‘ä¸Šæ‰¾è¾¹æ•°åœ¨[L,R]ä¹‹é—´çš„è·¯å¾„ï¼Œè¾¹æƒå’Œæœ€å¤§ï¼Œæ€è·¯ç±»ä¼¼ï¼ˆäºŒåˆ†+ç‚¹åˆ†æ²»+å•è°ƒé˜Ÿåˆ—ï¼‰ã€‚
- **æ´›è°·P3806ï¼ˆç‚¹åˆ†æ²»æ¨¡æ¿ï¼‰**ï¼šæ¨¡æ¿é¢˜ï¼Œå­¦ä¹ ç‚¹åˆ†æ²»çš„åŸºæœ¬æµç¨‹ã€‚
- **æ´›è°·P5018ï¼ˆå¯¹ç§°äºŒå‰æ ‘ï¼‰**ï¼šç»ƒä¹ æ‰¾æ ‘çš„é‡å¿ƒï¼Œç†è§£â€œå¹³è¡¡å­æ ‘â€çš„æ¦‚å¿µã€‚

### ğŸš€ è¿›é˜¶ç»ƒä¹ 
- å°è¯•ç”¨â€œé•¿é“¾å‰–åˆ†â€ä¼˜åŒ–æœ¬é¢˜ï¼ˆå‚è€ƒcritnosçš„é¢˜è§£ï¼‰ï¼ŒæŒ‘æˆ˜æ›´ä¼˜çš„æ—¶é—´å¤æ‚åº¦ã€‚
- å®ç°â€œç‚¹åˆ†æ²»+çº¿æ®µæ ‘â€çš„è§£æ³•ï¼Œå¯¹æ¯”å•è°ƒé˜Ÿåˆ—ä¼˜åŒ–çš„æ•ˆç‡å·®å¼‚ã€‚


## 7. å­¦ä¹ å¿ƒå¾—ä¸ç»éªŒåˆ†äº«

### ğŸ’¡ æ¥è‡ªé¢˜è§£çš„ç»éªŒ
- **äºŒåˆ†è¾¹ç•Œçš„å¤„ç†**ï¼šå¾ˆå¤šé¢˜è§£éƒ½æåˆ°â€œäºŒåˆ†çš„midè¦å–(l+r+1)/2â€ï¼Œè¿™æ˜¯å› ä¸ºè¦æ‰¾â€œæœ€å¤§çš„æ»¡è¶³æ¡ä»¶çš„midâ€ï¼Œé¿å…æ­»å¾ªç¯ã€‚
- **å­æ ‘æ’åºçš„é‡è¦æ€§**ï¼šæŒ‰å­æ ‘æ·±åº¦æ’åºèƒ½ä¿è¯å•è°ƒé˜Ÿåˆ—çš„æ»‘åŠ¨çª—å£æ˜¯â€œå‘å·¦ç§»åŠ¨â€çš„ï¼Œé¿å…å¤æ‚åº¦é€€åŒ–ï¼Œè¿™æ˜¯ç‚¹åˆ†æ²»ä¼˜åŒ–çš„å…³é”®ã€‚
- **ä»£ç æ¨¡å—åŒ–**ï¼šæŠŠç‚¹åˆ†æ²»çš„æ¯ä¸ªæ­¥éª¤æ‹†åˆ†æˆå‡½æ•°ï¼ˆæ‰¾é‡å¿ƒã€è®¡ç®—æ·±åº¦ã€å¤„ç†è·¯å¾„ï¼‰ï¼Œèƒ½è®©ä»£ç æ›´æ¸…æ™°ï¼Œè°ƒè¯•æ›´æ–¹ä¾¿ã€‚


## ğŸ”š ç»“è®º
é€šè¿‡è¿™é“é¢˜ï¼Œæˆ‘ä»¬å­¦ä¼šäº†â€œäºŒåˆ†ç­”æ¡ˆ+ç‚¹åˆ†æ²»+å•è°ƒé˜Ÿåˆ—â€çš„ç»„åˆç®—æ³•ï¼ŒæŒæ¡äº†æ ‘ä¸Šè·¯å¾„é—®é¢˜çš„æ ¸å¿ƒè§£æ³•ã€‚è®°ä½ï¼š**ä¸­ä½æ•°é—®é¢˜ç”¨äºŒåˆ†ï¼Œæ ‘ä¸Šè·¯å¾„ç”¨ç‚¹åˆ†æ²»ï¼ŒåŒºé—´æŸ¥è¯¢ç”¨å•è°ƒé˜Ÿåˆ—**ï¼Œä¸‰è€…ç»“åˆå°±èƒ½è§£å†³å¤æ‚çš„æ ‘ä¸Šé—®é¢˜ï¼

ä¸‹æ¬¡æˆ‘ä»¬å†ä¸€èµ·æ¢ç´¢æ›´æœ‰è¶£çš„ç¼–ç¨‹æŒ‘æˆ˜å§ï¼ğŸ’ª

---
å¤„ç†ç”¨æ—¶ï¼š98.43ç§’
# é¢˜ç›®ä¿¡æ¯

# Fishingprince Plays With Array Again

## é¢˜ç›®æè¿°

ç»™å®šä¸€ä¸ªä»¥ $1$ ä¸ºä¸‹æ ‡èµ·ç‚¹çš„éè´Ÿæ•´æ•°åºåˆ— $a$ï¼Œé•¿åº¦ä¸º $n$ï¼Œä»¥åŠä¸¤ä¸ªæ•´æ•° $x$ã€$y$ã€‚åœ¨è¿ç»­çš„ $t$ ç§’å†…ï¼ˆ$t$ å¯ä»¥ä¸ºä»»æ„æ­£å®æ•°ï¼‰ï¼Œä½ å¯ä»¥è¿›è¡Œä»¥ä¸‹ä¸¤ç§æ“ä½œä¹‹ä¸€ï¼š

- é€‰æ‹© $1\le i<n$ï¼Œå°† $a_i$ å‡å°‘ $x\cdot t$ï¼Œå¹¶å°† $a_{i+1}$ å‡å°‘ $y\cdot t$ã€‚
- é€‰æ‹© $1\le i<n$ï¼Œå°† $a_i$ å‡å°‘ $y\cdot t$ï¼Œå¹¶å°† $a_{i+1}$ å‡å°‘ $x\cdot t$ã€‚

å®šä¹‰ä½¿åºåˆ—ä¸­æ‰€æœ‰å…ƒç´ éƒ½å°äºç­‰äº $0$ æ‰€éœ€çš„æœ€å°‘æ—¶é—´ï¼ˆå¯èƒ½ä¸ºå®æ•°ï¼‰ä¸º $f(a)$ã€‚

ä¾‹å¦‚ï¼Œå½“ $x=1$ï¼Œ$y=2$ æ—¶ï¼Œå¤„ç†æ•°ç»„ $[3,1,1,3]$ éœ€è¦ $3$ ç§’ã€‚å¯ä»¥è¿™æ ·æ“ä½œï¼š

- é¦–å…ˆç”¨ $1.5$ ç§’å¯¹ $i=1$ æ‰§è¡Œç¬¬äºŒç§æ“ä½œã€‚
- æ¥ç€ç”¨ $1.5$ ç§’å¯¹ $i=3$ æ‰§è¡Œç¬¬ä¸€ç§æ“ä½œã€‚

å¯ä»¥è¯æ˜ï¼Œä¸å¯èƒ½åœ¨å°‘äº $3$ ç§’å†…ä½¿æ‰€æœ‰å…ƒç´ å°äºç­‰äº $0$ï¼Œå› æ­¤ $f([3,1,1,3])=3$ã€‚

ç°åœ¨ï¼Œç»™å®šä¸€ä¸ªä»¥ $1$ ä¸ºä¸‹æ ‡èµ·ç‚¹çš„æ­£æ•´æ•°åºåˆ— $b$ï¼Œé•¿åº¦ä¸º $n$ã€‚è¿˜ç»™å®šæ­£æ•´æ•° $x$ã€$y$ã€‚ä½ éœ€è¦å¤„ç† $q$ ä¸ªå¦‚ä¸‹ä¸¤ç§ç±»å‹çš„æ“ä½œï¼š

- 1 k vï¼šå°† $b_k$ ä¿®æ”¹ä¸º $v$ã€‚
- 2 l rï¼šè¾“å‡º $f([b_l,b_{l+1},\dots,b_r])$ã€‚

## è¯´æ˜/æç¤º

æˆ‘ä»¬æ¥åˆ†ææ ·ä¾‹ã€‚

åœ¨ç¬¬ä¸€ä¸ªæŸ¥è¯¢ä¸­ï¼Œè¦æ±‚è®¡ç®— $f([3,1,1,4])$ã€‚ç­”æ¡ˆä¸º $3.5$ã€‚ä¸€ç§æœ€ä¼˜æ“ä½œåºåˆ—ä¸ºï¼š

- é¦–å…ˆç”¨ $1.5$ ç§’å¯¹ $i=1$ æ‰§è¡Œç¬¬äºŒç§æ“ä½œã€‚
- æ¥ç€ç”¨ $2$ ç§’å¯¹ $i=3$ æ‰§è¡Œç¬¬ä¸€ç§æ“ä½œã€‚

åœ¨ç¬¬ä¸‰ä¸ªæŸ¥è¯¢ä¸­ï¼Œè¦æ±‚è®¡ç®— $f([1,1,1])$ã€‚ç­”æ¡ˆä¸º $1$ã€‚ä¸€ç§æœ€ä¼˜æ“ä½œåºåˆ—ä¸ºï¼š

- é¦–å…ˆç”¨ $0.5$ ç§’å¯¹ $i=1$ æ‰§è¡Œç¬¬äºŒç§æ“ä½œã€‚
- æ¥ç€ç”¨ $0.5$ ç§’å¯¹ $i=2$ æ‰§è¡Œç¬¬ä¸€ç§æ“ä½œã€‚

ç”± ChatGPT 4.1 ç¿»è¯‘

## æ ·ä¾‹ #1

### è¾“å…¥

```
4 3
1 2
3 1 1 4
2 1 4
1 1 1
2 1 3```

### è¾“å‡º

```
3.500000000000000
1.000000000000000```

# AIåˆ†æç»“æœ

# ğŸ’¡ Kayçš„C++ç®—æ³•è§£æï¼šFishingprince Plays With Array Again æ·±å…¥å­¦ä¹ æŒ‡å— ğŸ’¡

ä»Šå¤©æˆ‘ä»¬è¦ä¸€èµ·æ”»å…‹çš„é—®é¢˜æ˜¯â€œFishingprince Plays With Array Againâ€â€”â€”è¿™é“é¢˜éœ€è¦æˆ‘ä»¬åŠ¨æ€ä¿®æ”¹åºåˆ—ï¼Œå¹¶å¿«é€ŸæŸ¥è¯¢è®©åºåˆ—æ‰€æœ‰å…ƒç´ â‰¤0çš„æœ€å°‘æ—¶é—´ã€‚çœ‹èµ·æ¥æœ‰ç‚¹å¤æ‚ï¼Ÿåˆ«æ‹…å¿ƒï¼Œæˆ‘ä»¬ä¼šä¸€æ­¥æ­¥æ‹†è§£æ ¸å¿ƒæ€è·¯ï¼ŒæŒæ¡å…³é”®æŠ€å·§ï¼


## 1. é¢˜ç›®è§£è¯»ä¸æ ¸å¿ƒç®—æ³•è¯†åˆ«

âœ¨ **æœ¬é¢˜ä¸»è¦è€ƒå¯Ÿ**ï¼šç¼–ç¨‹æŠ€å·§åº”ç”¨ï¼ˆçº¿æ€§è§„åˆ’å¯¹å¶ + çº¿æ®µæ ‘ç»´æŠ¤å¹¿ä¹‰çŸ©ä¹˜çŠ¶æ€ï¼‰

ğŸ—£ï¸ **åˆæ­¥åˆ†æ**ï¼š  
è§£å†³è¿™é“é¢˜çš„å…³é”®ï¼Œåœ¨äº**â€œæ¢ä¸ªè§’åº¦çœ‹é—®é¢˜â€**â€”â€”å°±åƒä½ æƒ³çŸ¥é“â€œæœ€å¿«ç”¨å®Œä¸€æ¡¶æ°´â€ï¼Œå¯ä»¥åè¿‡æ¥æƒ³â€œæœ€æ…¢èƒ½æ€ä¹ˆèŠ‚çº¦ç”¨æ°´â€ã€‚åŸé—®é¢˜æ˜¯æ±‚â€œè®©åºåˆ—å…¨â‰¤0çš„æœ€å°‘æ—¶é—´â€ï¼Œæˆ‘ä»¬é€šè¿‡**çº¿æ€§è§„åˆ’å¯¹å¶**ï¼ŒæŠŠå®ƒè½¬æ¢æˆâ€œæ‰¾ä¸€ç»„ç³»æ•°ï¼Œè®©æ¯ä¸ªå…ƒç´ ä¹˜ç³»æ•°çš„å’Œæœ€å¤§â€ï¼ˆè¿™ç»„ç³»æ•°çš„çº¦æŸå¯¹åº”åŸé—®é¢˜çš„æ“ä½œé™åˆ¶ï¼‰ã€‚  

æ›´å…·ä½“åœ°è¯´ï¼š  
- åŸé—®é¢˜çš„â€œæœ€å°‘æ—¶é—´â€å¯¹åº”å¯¹å¶é—®é¢˜çš„â€œæœ€å¤§å’Œâ€ï¼›  
- åŸé—®é¢˜çš„â€œæ“ä½œæ¶ˆè€—â€å¯¹åº”å¯¹å¶é—®é¢˜çš„â€œç³»æ•°çº¦æŸâ€ï¼ˆæ¯”å¦‚ï¼Œæ¯ä¸ªç³»æ•°åªèƒ½å–0ã€1/(x+y)ã€1/yï¼Œå› ä¸ºè¿™äº›å€¼æ˜¯çº¦æŸä¸‹çš„â€œç´§è¾¹ç•Œâ€ï¼‰ã€‚  

æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬éœ€è¦**ç”¨çº¿æ®µæ ‘ç»´æŠ¤åŒºé—´çš„æœ€ä¼˜çŠ¶æ€**ï¼šæ¯ä¸ªåŒºé—´çš„çŠ¶æ€ç”¨ä¸€ä¸ª3Ã—3çŸ©é˜µè¡¨ç¤ºï¼ˆå¯¹åº”å·¦å³ç«¯ç‚¹å–0ã€1/(x+y)ã€1/yæ—¶çš„æœ€å¤§å’Œï¼‰ã€‚åˆå¹¶ä¸¤ä¸ªåŒºé—´æ—¶ï¼Œç”¨**å¹¿ä¹‰çŸ©ä¹˜**ï¼ˆå–maxåŠ ï¼Œç±»ä¼¼â€œè·¯å¾„çš„æœ€å¤§æ”¶ç›Šâ€ï¼‰â€”â€”è¿™å°±åƒæŠŠä¸¤ä¸ªå°æ‹¼å›¾æ‹¼èµ·æ¥ï¼Œå¾—åˆ°å¤§æ‹¼å›¾çš„ç­”æ¡ˆã€‚  

**å¯è§†åŒ–è®¾è®¡æ€è·¯**ï¼šæˆ‘ä»¬ä¼šç”¨8ä½åƒç´ é£å±•ç¤ºåºåˆ—å’Œçº¿æ®µæ ‘ã€‚æ¯”å¦‚ï¼š  
- ç”¨ä¸åŒé¢œè‰²çš„åƒç´ å—è¡¨ç¤ºç³»æ•°å–å€¼ï¼ˆç°è‰²=0ï¼Œè“è‰²=1/(x+y)ï¼Œçº¢è‰²=1/yï¼‰ï¼›  
- çº¿æ®µæ ‘èŠ‚ç‚¹ç”¨åƒç´ æ¡†è¡¨ç¤ºï¼Œåˆå¹¶æ—¶å±•ç¤ºçŸ©é˜µä¹˜æ³•çš„â€œæ‹¼æ¥â€åŠ¨ç”»ï¼›  
- å…³é”®æ“ä½œï¼ˆæ¯”å¦‚ç³»æ•°å˜åŒ–ã€èŠ‚ç‚¹åˆå¹¶ï¼‰ä¼´éšâ€œå®â€çš„éŸ³æ•ˆï¼Œå¼ºåŒ–è®°å¿†ã€‚


## 2. ç²¾é€‰ä¼˜è´¨é¢˜è§£å‚è€ƒ

ä¸ºäº†å¸®å¤§å®¶å¿«é€ŸæŒæ¡æ€è·¯ï¼Œæˆ‘ç­›é€‰äº†ä¸¤ä»½**æ€è·¯æ¸…æ™°ã€ä»£ç æ˜“è¯»**çš„ä¼˜è´¨é¢˜è§£ï¼š

### é¢˜è§£ä¸€ï¼šï¼ˆæ¥æºï¼šè€è½è½ç©¿ä¸€åˆ‡ï¼‰
* **ç‚¹è¯„**ï¼šè¿™ä»½é¢˜è§£ä»â€œçº¿æ€§è§„åˆ’å¯¹å¶â€çš„æœ¬è´¨å…¥æ‰‹ï¼Œä¸€æ­¥æ­¥æ¨å¯¼å¯¹å¶é—®é¢˜çš„å½¢å¼ï¼Œè¿˜æ„Ÿæ€§+ç†æ€§è¯æ˜äº†â€œç³»æ•°åªèƒ½å–0ã€1/(x+y)ã€1/yâ€â€”â€”å°±åƒç»™ä½ ä¸€å¼ â€œåœ°å›¾â€ï¼Œå¸®ä½ çœ‹æ¸…é—®é¢˜çš„æ ¸å¿ƒã€‚è™½ç„¶æ²¡æœ‰ç›´æ¥ç»™ä»£ç ï¼Œä½†æ€è·¯çš„æ·±åº¦å’Œé€»è¾‘æ€§éå¸¸å€¼å¾—å­¦ä¹ ï¼Œé€‚åˆæƒ³â€œçŸ¥å…¶æ‰€ä»¥ç„¶â€çš„åŒå­¦ã€‚

### é¢˜è§£äºŒï¼šï¼ˆæ¥æºï¼šå‘¨å­è¡¡ï¼‰
* **ç‚¹è¯„**ï¼šè¿™ä»½é¢˜è§£ç›´æ¥ç»™å‡ºç»“è®ºå’Œå¯è¿è¡Œçš„ä»£ç ï¼Œå ªç§°â€œå®æˆ˜æ´¾â€ï¼ä»£ç ç”¨çº¿æ®µæ ‘ç»´æŠ¤çŸ©é˜µçŠ¶æ€ï¼Œç»“æ„æ¸…æ™°ï¼ˆSegmentTreeç±»å°è£…äº†æ‰€æœ‰æ“ä½œï¼‰ï¼ŒçŸ©é˜µä¹˜æ³•çš„é‡è½½ä¹Ÿå¾ˆå·§å¦™ï¼ˆå¹¿ä¹‰çŸ©ä¹˜ï¼‰ã€‚æ›´éš¾å¾—çš„æ˜¯ï¼Œä½œè€…è¡¥å……äº†çº¿æ€§è§„åˆ’å¯¹å¶çš„è¯æ˜ï¼Œå¸®ä½ æŠŠâ€œç»“è®ºâ€å’Œâ€œåŸç†â€è¿èµ·æ¥ã€‚æ— è®ºæ˜¯æƒ³å¿«é€Ÿå†™ä»£ç ï¼Œè¿˜æ˜¯æƒ³ç†è§£è¯æ˜ï¼Œè¿™ä»½é¢˜è§£éƒ½å¾ˆé€‚åˆã€‚


## 3. æ ¸å¿ƒéš¾ç‚¹è¾¨æä¸è§£é¢˜ç­–ç•¥

### ğŸ” æ ¸å¿ƒéš¾ç‚¹1ï¼šåŸé—®é¢˜â†’å¯¹å¶é—®é¢˜çš„è½¬åŒ–  
**é—®é¢˜**ï¼šä¸ºä»€ä¹ˆåŸé—®é¢˜çš„â€œæœ€å°‘æ—¶é—´â€ä¼šå˜æˆå¯¹å¶é—®é¢˜çš„â€œæœ€å¤§å’Œâ€ï¼Ÿ  
**è§£å†³ç­–ç•¥**ï¼šè®°ä½çº¿æ€§è§„åˆ’çš„â€œå¯¹å¶æ€§â€â€”â€”**æœ€å°åŒ–é—®é¢˜çš„æœ€ä¼˜è§£ = å…¶å¯¹å¶é—®é¢˜ï¼ˆæœ€å¤§åŒ–ï¼‰çš„æœ€ä¼˜è§£**ã€‚åŸé—®é¢˜çš„â€œæ“ä½œæ—¶é—´â€å¯¹åº”å¯¹å¶é—®é¢˜çš„â€œç³»æ•°â€ï¼ŒåŸé—®é¢˜çš„â€œæ¶ˆè€—çº¦æŸâ€å¯¹åº”å¯¹å¶é—®é¢˜çš„â€œç³»æ•°é™åˆ¶â€ã€‚æ¯”å¦‚ï¼ŒåŸé—®é¢˜ä¸­â€œæ¯æ¬¡æ“ä½œæ¶ˆè€—x+yçš„æ€»å’Œâ€ï¼Œå¯¹åº”å¯¹å¶é—®é¢˜ä¸­â€œç³»æ•°ä¹‹å’Œä¸èƒ½è¶…è¿‡1â€ã€‚

### ğŸ” æ ¸å¿ƒéš¾ç‚¹2ï¼šå¯¹å¶å˜é‡çš„å¯èƒ½å–å€¼  
**é—®é¢˜**ï¼šä¸ºä»€ä¹ˆç³»æ•°åªèƒ½æ˜¯0ã€1/(x+y)ã€1/yï¼Ÿ  
**è§£å†³ç­–ç•¥**ï¼šå‡è®¾x<yï¼ˆå¦åˆ™äº¤æ¢xå’Œyï¼‰ï¼Œçœ‹å¯¹å¶é—®é¢˜çš„çº¦æŸï¼š  
- å¦‚æœç³»æ•°å–1/yï¼Œé‚£ä¹ˆç›¸é‚»ç³»æ•°å¿…é¡»ä¸º0ï¼ˆå¦åˆ™ä¼šè¿åâ€œxd_i + yd_{i-1} â‰¤1â€ï¼‰ï¼›  
- å¦‚æœç³»æ•°å–1/(x+y)ï¼Œé‚£ä¹ˆç›¸é‚»ç³»æ•°å¯ä»¥å–1/(x+y)ï¼ˆå› ä¸ºx*(1/(x+y)) + y*(1/(x+y)) = 1ï¼‰ï¼›  
- 0æ˜¯â€œä¸é€‰è¿™ä¸ªç³»æ•°â€çš„æƒ…å†µã€‚  
é€šè¿‡ä¾‹å­æ¨å¯¼ï¼ˆæ¯”å¦‚åºåˆ—[1,0,0,1]ï¼‰ï¼Œä½ ä¼šå‘ç°è¿™äº›å€¼æ˜¯â€œæœ€ç´§â€çš„çº¦æŸï¼Œèƒ½æœ€å¤§åŒ–æ€»å’Œã€‚

### ğŸ” æ ¸å¿ƒéš¾ç‚¹3ï¼šçº¿æ®µæ ‘ç»´æŠ¤å¹¿ä¹‰çŸ©ä¹˜  
**é—®é¢˜**ï¼šä¸ºä»€ä¹ˆç”¨çŸ©é˜µä¹˜æ³•åˆå¹¶åŒºé—´ï¼Ÿ  
**è§£å†³ç­–ç•¥**ï¼šæ¯ä¸ªåŒºé—´çš„çŠ¶æ€å¯ä»¥ç”¨3Ã—3çŸ©é˜µè¡¨ç¤ºâ€”â€”æ¯”å¦‚matrix[i][j]è¡¨ç¤ºâ€œåŒºé—´å·¦ç«¯ç‚¹å–iå€¼ã€å³ç«¯ç‚¹å–jå€¼æ—¶çš„æœ€å¤§å’Œâ€ã€‚åˆå¹¶ä¸¤ä¸ªåŒºé—´æ—¶ï¼Œä¸­é—´çš„ç«¯ç‚¹å–å€¼è¦ä¸€è‡´ï¼ˆæ¯”å¦‚å·¦åŒºé—´çš„å³ç«¯ç‚¹=å³åŒºé—´çš„å·¦ç«¯ç‚¹ï¼‰ï¼Œæ‰€ä»¥ç”¨çŸ©é˜µä¹˜æ³•çš„â€œè¡Œä¹˜åˆ—â€æ¥åˆå¹¶ï¼šå·¦çŸ©é˜µçš„è¡Œå¯¹åº”å·¦åŒºé—´çš„å³ç«¯ç‚¹ï¼Œå³çŸ©é˜µçš„åˆ—å¯¹åº”å³åŒºé—´çš„å·¦ç«¯ç‚¹ï¼Œå–maxåŠ å¾—åˆ°åˆå¹¶åçš„çŸ©é˜µã€‚è¿™å°±åƒâ€œæ¥åŠ›èµ›â€ï¼Œä¸­é—´çš„äº¤æ¥æ£’è¦ä¸€è‡´ã€‚


## 4. C++æ ¸å¿ƒä»£ç å®ç°èµæ

### æœ¬é¢˜é€šç”¨æ ¸å¿ƒC++å®ç°å‚è€ƒ  
* **è¯´æ˜**ï¼šæ­¤ä»£ç æ¥è‡ªå‘¨å­è¡¡çš„é¢˜è§£ï¼Œæ˜¯â€œçº¿æ®µæ ‘+å¹¿ä¹‰çŸ©ä¹˜â€çš„å…¸å‹å®ç°ï¼Œé€»è¾‘æ¸…æ™°ã€æ˜“è¯»ã€‚  
* **å®Œæ•´æ ¸å¿ƒä»£ç **ï¼š
```cpp
#include <cstdio>
#include <algorithm>
using namespace std;

const double INF = 1e15;
double x, y;

struct MAT {
    double num[3][3];
    MAT() { for (int i=0; i<3; i++) for (int j=0; j<3; j++) num[i][j] = -INF; }
    double* operator[](int idx) { return num[idx]; }
};

MAT operator*(MAT a, MAT b) {
    MAT res;
    for (int i=0; i<3; i++)
        for (int k=0; k<3; k++)
            if (a[i][k] != -INF)
                for (int j=0; j<3; j++)
                    if (b[k][j] != -INF)
                        res[i][j] = max(res[i][j], a[i][k] + b[k][j]);
    return res;
}

MAT C; // ç›¸é‚»åŒºé—´çš„çº¦æŸçŸ©é˜µ

struct SegmentTree {
    struct Node {
        int l, r;
        MAT val;
    } t[800000];

    void build(int l, int r, int idx) {
        t[idx].l = l; t[idx].r = r;
        if (l == r) return;
        int mid = (l + r) >> 1;
        build(l, mid, idx<<1);
        build(mid+1, r, idx<<1|1);
    }

    void update(int pos, double val, int idx) {
        if (t[idx].l == t[idx].r) {
            t[idx].val[0][0] = 0;
            t[idx].val[1][1] = val / (x + y);
            t[idx].val[2][2] = val / y;
            return;
        }
        int mid = (t[idx].l + t[idx].r) >> 1;
        if (pos <= mid) update(pos, val, idx<<1);
        else update(pos, val, idx<<1|1);
        t[idx].val = t[idx<<1].val * C * t[idx<<1|1].val;
    }

    MAT query(int l, int r, int idx) {
        if (l <= t[idx].l && t[idx].r <= r) return t[idx].val;
        int mid = (t[idx].l + t[idx].r) >> 1;
        if (r <= mid) return query(l, r, idx<<1);
        if (l > mid) return query(l, r, idx<<1|1);
        return query(l, r, idx<<1) * C * query(l, r, idx<<1|1);
    }
} T;

int main() {
    // åˆå§‹åŒ–CçŸ©é˜µï¼šçº¦æŸç›¸é‚»èŠ‚ç‚¹çš„å–å€¼ï¼ˆæ¯”å¦‚C[i][j]è¡¨ç¤ºå·¦åŒºé—´å³ç«¯ç‚¹iã€å³åŒºé—´å·¦ç«¯ç‚¹jæ˜¯å¦å…è®¸ï¼‰
    C[0][0] = C[0][1] = C[0][2] = 0;
    C[1][0] = C[1][1] = 0;
    C[2][0] = 0;
    C[1][2] = C[2][1] = C[2][2] = -INF; // ä¸å…è®¸çš„ç»„åˆï¼ˆæ¯”å¦‚å·¦åŒºé—´å³ç«¯ç‚¹1ã€å³åŒºé—´å·¦ç«¯ç‚¹2ï¼‰

    int n, q;
    scanf("%d%d%lf%lf", &n, &q, &x, &y);
    if (x > y) swap(x, y); // ä¿è¯x < y
    T.build(1, n, 1);

    for (int i=1; i<=n; i++) {
        double b; scanf("%lf", &b);
        T.update(i, b, 1);
    }

    while (q--) {
        int op; scanf("%d", &op);
        if (op == 1) {
            int pos; double v; scanf("%d%lf", &pos, &v);
            T.update(pos, v, 1);
        } else {
            int l, r; scanf("%d%d", &l, &r);
            MAT res = T.query(l, r, 1);
            double ans = -INF;
            for (int i=0; i<3; i++)
                for (int j=0; j<3; j++)
                    ans = max(ans, res[i][j]);
            printf("%.10lf\n", ans);
        }
    }
    return 0;
}
```
* **ä»£ç è§£è¯»æ¦‚è¦**ï¼š  
  1. **MATç»“æ„**ï¼šå­˜å‚¨3Ã—3çŸ©é˜µï¼Œä»£è¡¨åŒºé—´çš„çŠ¶æ€ï¼ˆå·¦ç«¯ç‚¹å–iå€¼ã€å³ç«¯ç‚¹å–jå€¼æ—¶çš„æœ€å¤§å’Œï¼‰ã€‚  
  2. **operator*é‡è½½**ï¼šå¹¿ä¹‰çŸ©ä¹˜ï¼Œè®¡ç®—åˆå¹¶ä¸¤ä¸ªåŒºé—´çš„æœ€å¤§å’Œï¼ˆiâ†’kâ†’jçš„è·¯å¾„ï¼Œå–maxåŠ ï¼‰ã€‚  
  3. **SegmentTreeç±»**ï¼šbuildåˆå§‹åŒ–çº¿æ®µæ ‘ï¼Œupdateä¿®æ”¹å¶å­èŠ‚ç‚¹çš„çŸ©é˜µï¼Œqueryåˆå¹¶åŒºé—´çŸ©é˜µã€‚  
  4. **CçŸ©é˜µ**ï¼šçº¦æŸç›¸é‚»åŒºé—´çš„å–å€¼ï¼ˆæ¯”å¦‚ä¸å…è®¸å·¦åŒºé—´å³ç«¯ç‚¹å–2ã€å³åŒºé—´å·¦ç«¯ç‚¹å–1ï¼Œå› ä¸ºä¼šè¿åå¯¹å¶çº¦æŸï¼‰ã€‚


### å…³é”®ç‰‡æ®µèµæï¼šMATçš„operator*  
* **äº®ç‚¹**ï¼šç”¨å¹¿ä¹‰çŸ©ä¹˜åˆå¹¶åŒºé—´ï¼Œå®Œç¾é€‚é…çº¿æ®µæ ‘çš„â€œåŒºé—´åˆå¹¶â€éœ€æ±‚ã€‚  
* **æ ¸å¿ƒä»£ç ç‰‡æ®µ**ï¼š
```cpp
MAT operator*(MAT a, MAT b) {
    MAT res;
    for (int i=0; i<3; i++)
        for (int k=0; k<3; k++)
            if (a[i][k] != -INF)
                for (int j=0; j<3; j++)
                    if (b[k][j] != -INF)
                        res[i][j] = max(res[i][j], a[i][k] + b[k][j]);
    return res;
}
```
* **ä»£ç è§£è¯»**ï¼š  
  è¿™ä¸ªå‡½æ•°è®¡ç®—ä¸¤ä¸ªçŸ©é˜µçš„â€œå¹¿ä¹‰ä¹˜ç§¯â€ã€‚æ¯”å¦‚ï¼Œaæ˜¯å·¦åŒºé—´çš„çŸ©é˜µï¼ˆå·¦ç«¯ç‚¹iã€å³ç«¯ç‚¹kï¼‰ï¼Œbæ˜¯å³åŒºé—´çš„çŸ©é˜µï¼ˆå·¦ç«¯ç‚¹kã€å³ç«¯ç‚¹jï¼‰ï¼Œåˆå¹¶åçš„çŸ©é˜µres[i][j]å°±æ˜¯â€œå·¦åŒºé—´iâ†’kï¼Œå³åŒºé—´kâ†’jâ€çš„æœ€å¤§å’Œã€‚è¿™é‡Œç”¨maxæ˜¯å› ä¸ºæˆ‘ä»¬è¦æ‰¾æœ€å¤§çš„å’Œï¼Œç”¨åŠ æ˜¯å› ä¸ºä¸¤ä¸ªåŒºé—´çš„å’Œè¦ç›¸åŠ â€”â€”è¿™å’Œæ™®é€šçŸ©é˜µä¹˜æ³•çš„â€œä¹˜åŠ â€å¾ˆåƒï¼Œä½†æŠŠä¹˜æ¢æˆäº†åŠ ï¼ŒåŠ æ¢æˆäº†maxï¼  
* **å­¦ä¹ ç¬”è®°**ï¼šå¹¿ä¹‰çŸ©ä¹˜æ˜¯å¤„ç†â€œåŒºé—´åˆå¹¶æ±‚æœ€ä¼˜â€é—®é¢˜çš„å¸¸ç”¨æŠ€å·§ï¼Œæ¯”å¦‚æœ€é•¿è·¯å¾„ã€æœ€å¤§å­æ®µå’Œç­‰ã€‚


## 5. ç®—æ³•å¯è§†åŒ–ï¼šåƒç´ åŠ¨ç”»æ¼”ç¤º

### ğŸ® åŠ¨ç”»ä¸»é¢˜ï¼šåƒç´ åŒ–çš„â€œç³»æ•°æ¢ç´¢è€…â€  
æˆ‘ä»¬ç”¨8ä½çº¢ç™½æœºé£æ ¼çš„åƒç´ åŠ¨ç”»ï¼Œå±•ç¤ºâ€œå¯»æ‰¾æœ€ä¼˜ç³»æ•°â€å’Œâ€œçº¿æ®µæ ‘åˆå¹¶â€çš„è¿‡ç¨‹â€”â€”å°±åƒç©ä¸€æ¬¾â€œæ‰¾å®è—â€çš„æ¸¸æˆï¼

### ğŸ¨ è®¾è®¡æ€è·¯  
- **é£æ ¼**ï¼š8ä½åƒç´ é£ï¼ˆæ¯”å¦‚FCæ¸¸æˆçš„ç”»é¢ï¼‰ï¼Œç”¨ç®€å•çš„è‰²å—å’Œçº¿æ¡è¡¨ç¤ºåºåˆ—ã€çº¿æ®µæ ‘ã€‚  
- **æ ¸å¿ƒæ¼”ç¤º**ï¼š  
  1. **åˆå§‹åŒ–**ï¼šå±å¹•å·¦ä¾§æ˜¯åºåˆ—åƒç´ å—ï¼ˆæ¯ä¸ªå—ä»£è¡¨ä¸€ä¸ªå…ƒç´ ï¼Œé¢œè‰²å¯¹åº”ç³»æ•°å–å€¼ï¼‰ï¼Œå³ä¾§æ˜¯çº¿æ®µæ ‘èŠ‚ç‚¹ï¼ˆæ¯ä¸ªèŠ‚ç‚¹æ˜¯ä¸€ä¸ªå°æ¡†ï¼Œæ˜¾ç¤ºå½“å‰åŒºé—´çš„æœ€å¤§å’Œï¼‰ã€‚  
  2. **å•æ­¥æ‰§è¡Œ**ï¼šç‚¹å‡»â€œå•æ­¥â€ï¼ŒåŠ¨ç”»å±•ç¤ºï¼š  
     - æŸä¸ªå…ƒç´ çš„ç³»æ•°å–å€¼å˜åŒ–ï¼ˆæ¯”å¦‚ä»ç°è‰²â†’è“è‰²ï¼‰ï¼›  
     - çº¿æ®µæ ‘èŠ‚ç‚¹çš„åˆå¹¶è¿‡ç¨‹ï¼ˆä¸¤ä¸ªå°æ¡†æ‹¼æˆä¸€ä¸ªå¤§æ¡†ï¼Œä¼´éšâ€œå®â€çš„éŸ³æ•ˆï¼‰ï¼›  
     - å½“å‰æ­¥éª¤å¯¹åº”çš„ä»£ç ç‰‡æ®µï¼ˆæ¯”å¦‚MATçš„operator*å‡½æ•°ï¼‰é«˜äº®æ˜¾ç¤ºã€‚  
  3. **è‡ªåŠ¨æ’­æ”¾**ï¼šç‚¹å‡»â€œè‡ªåŠ¨â€ï¼ŒåŠ¨ç”»å¿«é€Ÿå±•ç¤ºæ•´ä¸ªè¿‡ç¨‹ï¼Œæ‰¾åˆ°æœ€ä¼˜ç³»æ•°æ—¶æ’­æ”¾â€œèƒœåˆ©â€éŸ³æ•ˆï¼ˆæ¯”å¦‚ã€Šè¶…çº§é©¬é‡Œå¥¥ã€‹çš„è¿‡å…³éŸ³ä¹ï¼‰ã€‚  
- **äº¤äº’**ï¼šæ§åˆ¶é¢æ¿æœ‰â€œå¼€å§‹/æš‚åœâ€â€œå•æ­¥â€â€œé‡ç½®â€æŒ‰é’®ï¼Œè¿˜æœ‰é€Ÿåº¦æ»‘å—ï¼ˆè°ƒæ•´åŠ¨ç”»é€Ÿåº¦ï¼‰ã€‚

### ğŸµ éŸ³æ•ˆè®¾è®¡  
- **åˆå¹¶èŠ‚ç‚¹**ï¼šâ€œå®â€ï¼ˆçŸ­éŸ³ï¼‰â€”â€”æç¤ºä¸¤ä¸ªåŒºé—´åˆå¹¶ã€‚  
- **æ‰¾åˆ°æœ€ä¼˜ç³»æ•°**ï¼šâ€œå®~â€ï¼ˆé•¿éŸ³ï¼‰â€”â€”æç¤ºå½“å‰æ˜¯æœ€ä¼˜è§£ã€‚  
- **é‡ç½®**ï¼šâ€œå’”â€ï¼ˆçŸ­éŸ³ï¼‰â€”â€”æç¤ºåŠ¨ç”»é‡ç½®ã€‚  
- **èƒŒæ™¯éŸ³ä¹**ï¼šå¾ªç¯æ’­æ”¾ã€Šå¦å…‹å¤§æˆ˜ã€‹çš„8ä½BGMï¼Œè¥é€ å¤å¤æ¸¸æˆæ°›å›´ã€‚


## 6. æ‹“å±•ç»ƒä¹ ä¸ç›¸ä¼¼é—®é¢˜

æŒæ¡äº†æœ¬é¢˜çš„æŠ€å·§åï¼Œä½ å¯ä»¥å°è¯•ä»¥ä¸‹é¢˜ç›®ï¼Œå·©å›ºæ‰€å­¦ï¼š

1. **æ´›è°· P3373 çº¿æ®µæ ‘åŒºé—´ä¿®æ”¹åŒºé—´æŸ¥è¯¢**  
   ğŸ—£ï¸ **æ¨èç†ç”±**ï¼šç»ƒä¹ çº¿æ®µæ ‘çš„åŸºæœ¬æ“ä½œï¼Œæ¯”å¦‚åŒºé—´åŠ ã€åŒºé—´ä¹˜ã€åŒºé—´æŸ¥è¯¢ã€‚æœ¬é¢˜çš„çº¿æ®µæ ‘æ˜¯â€œç»´æŠ¤çŠ¶æ€çŸ©é˜µâ€ï¼Œè€Œè¿™é“é¢˜æ˜¯â€œç»´æŠ¤æ•°å€¼â€ï¼Œé€‚åˆå…¥é—¨ã€‚

2. **æ´›è°· P4513 å°ç™½é€›å…¬å›­**  
   ğŸ—£ï¸ **æ¨èç†ç”±**ï¼šç»ƒä¹ çº¿æ®µæ ‘ç»´æŠ¤åŒºé—´ä¿¡æ¯ï¼ˆæ¯”å¦‚æœ€é•¿è¿ç»­å­æ®µå’Œï¼‰ã€‚æœ¬é¢˜çš„â€œå¹¿ä¹‰çŸ©ä¹˜â€å’Œè¿™é“é¢˜çš„â€œå­æ®µå’Œåˆå¹¶â€æ€è·¯ç±»ä¼¼ï¼Œéƒ½æ˜¯â€œåˆå¹¶ä¸¤ä¸ªåŒºé—´çš„çŠ¶æ€â€ã€‚

3. **æ´›è°· P5057 [CQOI2006]ç®€å•é¢˜**  
   ğŸ—£ï¸ **æ¨èç†ç”±**ï¼šç»ƒä¹ çº¿æ€§è§„åˆ’å¯¹å¶çš„åŸºæœ¬æ€æƒ³ã€‚è¿™é“é¢˜æ˜¯â€œæ±‚æœ€å°è¦†ç›–â€ï¼Œå¯¹å¶åæ˜¯â€œæ±‚æœ€å¤§åŒ¹é…â€ï¼Œå’Œæœ¬é¢˜çš„â€œå¯¹å¶è½¬åŒ–â€æ€è·¯ä¸€è‡´ã€‚


## 7. å­¦ä¹ å¿ƒå¾—ä¸ç»éªŒåˆ†äº«

å‘¨å­è¡¡çš„é¢˜è§£ä¸­æåˆ°ï¼šâ€œé€šè¿‡çº¿æ€§è§„åˆ’å¯¹å¶ï¼Œä»¥ä¸‹ç•Œé€¼è¿‘ä¸Šç•Œâ€â€”â€”è¿™æ˜¯è§£å†³ä¼˜åŒ–é—®é¢˜çš„å¸¸ç”¨æ€è·¯ã€‚æ¯”å¦‚ï¼Œå½“ä½ æƒ³æ±‚â€œæœ€å°‘æ—¶é—´â€ï¼Œå¯ä»¥å…ˆæ‰¾æ‰€æœ‰å¯èƒ½çš„â€œæ—¶é—´ä¸‹é™â€ï¼ˆæ¯”å¦‚æ€»å’Œ/(x+y)ã€å¥‡æ•°ä½å’Œ/yç­‰ï¼‰ï¼Œç„¶åæ‰¾åˆ°æœ€ç´§çš„é‚£ä¸ªä¸‹é™ï¼Œå°±æ˜¯æœ€ä¼˜è§£ã€‚

è€è½è½çš„é¢˜è§£ä¸­æåˆ°ï¼šâ€œçº¿æ€§è§„åˆ’çš„è§£ä¸€å®šåœ¨å‡¸åŒ…çš„ç«¯ç‚¹ä¸Šâ€â€”â€”è¿™è§£é‡Šäº†ä¸ºä»€ä¹ˆç³»æ•°åªèƒ½å–0ã€1/(x+y)ã€1/yï¼šè¿™äº›å€¼æ˜¯çº¦æŸæ¡ä»¶çš„â€œç«¯ç‚¹â€ï¼Œä¹Ÿå°±æ˜¯æœ€ç´§çš„é™åˆ¶ã€‚


## ğŸ’ª ç»“æŸè¯­  
è¿™é“é¢˜çš„æ ¸å¿ƒæ˜¯â€œæ¢ä¸ªè§’åº¦çœ‹é—®é¢˜â€ï¼ˆçº¿æ€§è§„åˆ’å¯¹å¶ï¼‰å’Œâ€œç”¨æ•°æ®ç»“æ„ç»´æŠ¤çŠ¶æ€â€ï¼ˆçº¿æ®µæ ‘+å¹¿ä¹‰çŸ©ä¹˜ï¼‰ã€‚è™½ç„¶ä¸€å¼€å§‹å¯èƒ½è§‰å¾—å¤æ‚ï¼Œä½†åªè¦ä¸€æ­¥æ­¥æ‹†è§£â€”â€”å…ˆç†è§£å¯¹å¶é—®é¢˜ï¼Œå†æŒæ¡çŠ¶æ€å–å€¼ï¼Œæœ€åå­¦ä¼šçº¿æ®µæ ‘åˆå¹¶â€”â€”ä½ ä¼šå‘ç°å®ƒå…¶å®å¾ˆæœ‰è¶£ï¼

è®°ä½ï¼šç¼–ç¨‹çš„ä¹è¶£åœ¨äºâ€œè§£å†³é—®é¢˜çš„è¿‡ç¨‹â€ï¼Œè€Œä¸æ˜¯â€œç›´æ¥å¾—åˆ°ç­”æ¡ˆâ€ã€‚ä¸‹æ¬¡é‡åˆ°ç±»ä¼¼çš„é—®é¢˜ï¼Œè¯•ç€ç”¨ä»Šå¤©å­¦çš„æ€è·¯å»åˆ†æï¼Œä½ ä¼šè¶Šæ¥è¶Šå‰å®³çš„ï¼ğŸ’ª


**æœ¬æ¬¡åˆ†æåˆ°æ­¤ç»“æŸï¼Œå¸Œæœ›å¯¹ä½ æœ‰å¸®åŠ©ï¼** ğŸš€

---
å¤„ç†ç”¨æ—¶ï¼š106.45ç§’
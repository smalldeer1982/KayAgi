# é¢˜ç›®ä¿¡æ¯

# Freezing with Style

## é¢˜ç›®æè¿°

This winter is so... well, you've got the idea :-) The Nvodsk road system can be represented as $ n $ junctions connected with $ n-1 $ bidirectional roads so that there is a path between any two junctions. The organizers of some event want to choose a place to accommodate the participants (junction $ v $ ), and the place to set up the contests (junction $ u $ ). Besides, at the one hand, they want the participants to walk about the city and see the neighbourhood (that's why the distance between $ v $ and $ u $ should be no less than $ l $ ). On the other hand, they don't want the participants to freeze (so the distance between $ v $ and $ u $ should be no more than $ r $ ). Besides, for every street we know its beauty â€” some integer from $ 0 $ to $ 10^{9} $ . Your task is to choose the path that fits in the length limits and has the largest average beauty. We shall define the average beauty as a median of sequence of the beauties of all roads along the path.

We can put it more formally like that: let there be a path with the length $ k $ . Let $ a_{i} $ be a non-decreasing sequence that contains exactly $ k $ elements. Each number occurs there exactly the number of times a road with such beauty occurs along on path. We will represent the path median as number $ a_{âŒŠk/2âŒ‹} $ , assuming that indexation starting from zero is used. $ âŒŠxâŒ‹ $ â€” is number $ Ñ… $ , rounded down to the nearest integer.

For example, if $ a={0,5,12} $ , then the median equals to $ 5 $ , and if $ a={0,5,7,12} $ , then the median is number $ 7 $ .

It is guaranteed that there will be at least one path with the suitable quantity of roads.

## è¯´æ˜/æç¤º

In the first sample all roads have the same beauty. That means that all paths of the positive length have the same median. Thus, any path with length from $ 3 $ to $ 4 $ , inclusive will be valid for us.

In the second sample the city looks like that: 1 - 2 - 3 - 4 - 5 - 6. Two last roads are more valuable and we should choose any path that contains both of them and has the suitable length. It is either the path between $ 2 $ and $ 6 $ or the path between $ 3 $ and $ 6 $ .

## æ ·ä¾‹ #1

### è¾“å…¥

```
6 3 4
1 2 1
2 3 1
3 4 1
4 5 1
5 6 1
```

### è¾“å‡º

```
4 1
```

## æ ·ä¾‹ #2

### è¾“å…¥

```
6 3 4
1 2 1
2 3 1
3 4 1
4 5 2
5 6 2
```

### è¾“å‡º

```
6 3
```

## æ ·ä¾‹ #3

### è¾“å…¥

```
5 1 4
1 2 1
1 3 4
3 4 7
3 5 2
```

### è¾“å‡º

```
4 3
```

## æ ·ä¾‹ #4

### è¾“å…¥

```
8 3 6
1 2 9
2 3 7
3 4 7
4 5 8
5 8 2
3 6 3
2 7 4
```

### è¾“å‡º

```
5 1
```

# AIåˆ†æç»“æœ

# ğŸ’¡ Kayçš„C++ç®—æ³•è§£æï¼šFreezing with Style æ·±å…¥å­¦ä¹ æŒ‡å— ğŸ’¡


## 1. é¢˜ç›®è§£è¯»ä¸æ ¸å¿ƒç®—æ³•è¯†åˆ«

âœ¨ **æœ¬é¢˜ä¸»è¦è€ƒå¯Ÿ**ï¼šäºŒåˆ†ç­”æ¡ˆ + ç‚¹åˆ†æ²»ï¼ˆæœç´¢ç±»ç®—æ³•çš„è¿›é˜¶åº”ç”¨ï¼‰


### åˆæ­¥åˆ†æ
è§£å†³â€œæ‰¾æ ‘ä¸Šæœ€å¤§ä¸­ä½æ•°è·¯å¾„â€çš„é—®é¢˜ï¼Œå…³é”®åœ¨äº**å°†ä¸­ä½æ•°é—®é¢˜è½¬åŒ–ä¸ºè·¯å¾„å’Œé—®é¢˜**ï¼ˆäºŒåˆ†ç­”æ¡ˆï¼‰ï¼Œå†ç”¨**ç‚¹åˆ†æ²»**é«˜æ•ˆç»Ÿè®¡æ ‘ä¸Šç¬¦åˆæ¡ä»¶çš„è·¯å¾„ã€‚  

- **äºŒåˆ†ç­”æ¡ˆçš„æ ¸å¿ƒ**ï¼šå°±åƒâ€œçŒœæ•°å­—æ¸¸æˆâ€â€”â€”æˆ‘ä»¬çŒœä¸€ä¸ªä¸­ä½æ•°`mid`ï¼ŒæŠŠæ‰€æœ‰â‰¥`mid`çš„è¾¹æ ‡ä¸º`1`ï¼Œ<`mid`çš„æ ‡ä¸º`-1`ã€‚å¦‚æœå­˜åœ¨ä¸€æ¡è¾¹æ•°åœ¨[L,R]ä¹‹é—´ã€è·¯å¾„å’Œâ‰¥0çš„è·¯å¾„ï¼Œè¯´æ˜`mid`æ˜¯å¯è¡Œçš„ï¼Œå¯ä»¥å°è¯•æ›´å¤§çš„`mid`ï¼›å¦åˆ™ç¼©å°èŒƒå›´ã€‚  
- **ç‚¹åˆ†æ²»çš„æ ¸å¿ƒ**ï¼šæŠŠå¤§æ ‘æ‹†æˆå°çš„â€œé‡å¿ƒå­æ ‘â€ï¼Œåªå¤„ç†ç»è¿‡é‡å¿ƒçš„è·¯å¾„ï¼ˆé¿å…é‡å¤è®¡ç®—ï¼‰ã€‚å°±åƒâ€œåˆ‡è›‹ç³•â€ï¼Œæ¯æ¬¡åˆ‡æœ€å‡åŒ€çš„é‚£å—ï¼Œä¿è¯æ¯å—çš„å¤§å°ä¸è¶…è¿‡åŸæ ‘çš„ä¸€åŠï¼Œæ€»å¤æ‚åº¦æ˜¯O(nlogn)ã€‚  

**é¢˜è§£æ€è·¯**ï¼š  
1. äºŒåˆ†ç­”æ¡ˆ`mid`ï¼Œè½¬åŒ–è¾¹æƒä¸º1/-1ï¼›  
2. ç”¨ç‚¹åˆ†æ²»ç»Ÿè®¡æ ‘ä¸Šæ˜¯å¦å­˜åœ¨è¾¹æ•°åœ¨[L,R]ã€å’Œâ‰¥0çš„è·¯å¾„ï¼›  
3. ç‚¹åˆ†æ²»ä¸­ï¼Œç”¨**å•è°ƒé˜Ÿåˆ—ä¼˜åŒ–**ï¼ˆæ»‘åŠ¨çª—å£ï¼‰å¿«é€ŸæŸ¥æ‰¾ç¬¦åˆé•¿åº¦è¦æ±‚çš„æœ€ä¼˜è·¯å¾„ï¼ˆé¿å…çº¿æ®µæ ‘çš„é¢å¤–logï¼‰ã€‚  

**æ ¸å¿ƒéš¾ç‚¹**ï¼šå¦‚ä½•é«˜æ•ˆç»Ÿè®¡ç»è¿‡é‡å¿ƒçš„è·¯å¾„ï¼ˆæ—¢è¦æ»¡è¶³é•¿åº¦èŒƒå›´ï¼Œåˆè¦æœ€å¤§åŒ–è·¯å¾„å’Œï¼‰ã€‚è§£å†³æ–¹æ¡ˆæ˜¯**æŒ‰å­æ ‘æ·±åº¦æ’åº**ï¼ˆæŒ‰ç§©åˆå¹¶ï¼‰ï¼Œä¿è¯å•è°ƒé˜Ÿåˆ—çš„æ»‘åŠ¨çª—å£æ˜¯â€œç§»åŠ¨â€çš„ï¼Œè€Œä¸æ˜¯â€œé‡ç½®â€çš„ï¼ŒæŠŠå¤æ‚åº¦ä»O(nÂ²)é™åˆ°O(nlogn)ã€‚  


## 2. ç²¾é€‰ä¼˜è´¨é¢˜è§£å‚è€ƒ

### é¢˜è§£ä¸€ï¼šshadowice1984ï¼ˆç‚¹åˆ†æ²»+å•è°ƒé˜Ÿåˆ—æŒ‰ç§©åˆå¹¶ï¼‰
**ç‚¹è¯„**ï¼šè¿™ä»½é¢˜è§£æ˜¯æœ¬é¢˜çš„â€œæ ‡å‡†è§£æ³•â€ï¼Œæ€è·¯æ¸…æ™°åˆ°æ¯ä¸€æ­¥éƒ½æœ‰æ˜ç¡®çš„ä¼˜åŒ–åŠ¨æœºã€‚  
- **æ€è·¯äº®ç‚¹**ï¼šå…ˆç”¨äºŒåˆ†è½¬åŒ–é—®é¢˜ï¼Œå†ç”¨ç‚¹åˆ†æ²»å¤„ç†æ ‘ä¸Šè·¯å¾„ï¼Œæœ€åç”¨â€œå•è°ƒé˜Ÿåˆ—æŒ‰ç§©åˆå¹¶â€ä¼˜åŒ–ç»Ÿè®¡è¿‡ç¨‹â€”â€”æŠŠçº¿æ®µæ ‘çš„O(logn)æŸ¥è¯¢æ¢æˆå•è°ƒé˜Ÿåˆ—çš„O(1)ï¼Œç æ‰ä¸€ä¸ªlogï¼Œå¤æ‚åº¦é™åˆ°O(nlogÂ²n)ã€‚  
- **ä»£ç äº®ç‚¹**ï¼šç”¨`BFS`éå†å­æ ‘ä¿è¯è·¯å¾„é•¿åº¦é€’å¢ï¼Œç”¨åŒç«¯é˜Ÿåˆ—ç»´æŠ¤æ»‘åŠ¨çª—å£çš„æœ€å¤§å€¼ï¼ŒæŒ‰å­æ ‘æ·±åº¦æ’åºé¿å…é‡å¤è®¡ç®—ã€‚ä»£ç ç»“æ„æ¨¡å—åŒ–ï¼ˆ`find`æ‰¾é‡å¿ƒã€`bfs`å¤„ç†å­æ ‘ã€`solve`åˆ†æ²»ï¼‰ï¼Œå˜é‡åæ¸…æ™°ï¼ˆ`g`å­˜å­æ ‘è·¯å¾„æœ€å¤§å€¼ã€`q`æ˜¯åŒç«¯é˜Ÿåˆ—ï¼‰ã€‚  
- **å®è·µä»·å€¼**ï¼šç›´æ¥å¯¹åº”é¢˜ç›®çš„æ ¸å¿ƒéš¾ç‚¹ï¼Œä»£ç å¯å¤ç”¨æ€§é«˜ï¼Œæ˜¯ç†è§£â€œäºŒåˆ†+ç‚¹åˆ†æ²»â€çš„æœ€ä½³èŒƒä¾‹ã€‚


### é¢˜è§£äºŒï¼šå°ç²‰å…”ï¼ˆç‚¹åˆ†æ²»+äºŒåˆ†ç­”æ¡ˆï¼‰
**ç‚¹è¯„**ï¼šé¢˜è§£çš„æ¨å¯¼è¿‡ç¨‹éå¸¸é€å½»ï¼ŒæŠŠâ€œä¸­ä½æ•°è½¬åŒ–ä¸ºè·¯å¾„å’Œâ€çš„é€»è¾‘è®²å¾—å¾ˆæ¸…æ¥šã€‚  
- **æ€è·¯äº®ç‚¹**ï¼šæ˜ç¡®æŒ‡å‡ºâ€œä¸­ä½æ•°â‰¥midç­‰ä»·äºè·¯å¾„å’Œâ‰¥0â€ï¼Œå¹¶è¯¦ç»†è§£é‡Šäº†ç‚¹åˆ†æ²»ä¸­å¦‚ä½•åˆå¹¶å­æ ‘ä¿¡æ¯ï¼ˆç”¨`seq`æ•°ç»„å­˜ä¹‹å‰å­æ ‘çš„è·¯å¾„æœ€å¤§å€¼ï¼Œ`tmp`æ•°ç»„å­˜å½“å‰å­æ ‘çš„è·¯å¾„å€¼ï¼‰ã€‚  
- **ä»£ç äº®ç‚¹**ï¼šç”¨`sort`æŒ‰å­æ ‘å¤§å°æ’åºï¼Œé¿å…é‡å¤è®¡ç®—ï¼›ç”¨å•è°ƒé˜Ÿåˆ—å¤„ç†æ»‘åŠ¨çª—å£ï¼Œä»£ç ç®€æ´æ˜“è¯»ï¼ˆ`que`æ•°ç»„ç»´æŠ¤çª—å£æœ€å¤§å€¼ï¼‰ã€‚  
- **å®è·µä»·å€¼**ï¼šé€‚åˆå…¥é—¨è€…ç†è§£ç‚¹åˆ†æ²»çš„â€œå­æ ‘åˆå¹¶â€é€»è¾‘ï¼Œä»£ç æ³¨é‡Šè¯¦ç»†ï¼Œå®¹æ˜“è·Ÿç€è°ƒè¯•ã€‚


### é¢˜è§£ä¸‰ï¼šå¤©å‘½ä¹‹è·¯ï¼ˆç‚¹åˆ†æ²»+å•è°ƒé˜Ÿåˆ—ä¼˜åŒ–ï¼‰
**ç‚¹è¯„**ï¼šé¢˜è§£çš„â€œé—®é¢˜è½¬åŒ–â€éƒ¨åˆ†è®²å¾—å¾ˆç›´è§‚ï¼ŒæŠŠâ€œæ‰¾åŒ¹é…è·¯å¾„â€è½¬åŒ–ä¸ºâ€œæ»‘åŠ¨çª—å£æ±‚æœ€å¤§å€¼â€ã€‚  
- **æ€è·¯äº®ç‚¹**ï¼šå¼ºè°ƒâ€œç›¸åŒæ·±åº¦çš„è·¯å¾„åªä¿ç•™æœ€å¤§å€¼â€ï¼ˆ`g`æ•°ç»„å­˜æ·±åº¦`i`çš„æœ€å¤§è·¯å¾„å’Œï¼‰ï¼Œè¿™æ ·åˆå¹¶å­æ ‘æ—¶åªéœ€è¦æ¯”è¾ƒæœ€å¤§å€¼ï¼Œå‡å°‘è®¡ç®—é‡ã€‚  
- **ä»£ç äº®ç‚¹**ï¼šç”¨`dfs`å¤„ç†å­æ ‘è·¯å¾„ï¼Œ`bfs`æ‰¾é‡å¿ƒï¼Œå•è°ƒé˜Ÿåˆ—çš„æ»‘åŠ¨çª—å£é€»è¾‘å†™å¾—å¾ˆæ¸…æ™°ï¼ˆ`q`æ•°ç»„çš„`head`å’Œ`tail`ç»´æŠ¤çª—å£è¾¹ç•Œï¼‰ã€‚  
- **å®è·µä»·å€¼**ï¼šä»£ç ç»“æ„ç®€å•ï¼Œé€‚åˆå¿«é€Ÿä¸Šæ‰‹ç‚¹åˆ†æ²»çš„â€œè·¯å¾„ç»Ÿè®¡â€éƒ¨åˆ†ã€‚


## 3. æ ¸å¿ƒéš¾ç‚¹è¾¨æä¸è§£é¢˜ç­–ç•¥

### æ ¸å¿ƒéš¾ç‚¹1ï¼šä¸­ä½æ•°é—®é¢˜çš„è½¬åŒ–
**é—®é¢˜**ï¼šç›´æ¥æ±‚â€œæœ€å¤§ä¸­ä½æ•°â€å¾ˆéš¾ï¼Œå› ä¸ºä¸­ä½æ•°æ˜¯â€œæ’åºåçš„ä¸­é—´å€¼â€ï¼Œæ— æ³•ç›´æ¥ç»Ÿè®¡ã€‚  
**ç­–ç•¥**ï¼šç”¨**äºŒåˆ†ç­”æ¡ˆ**è½¬åŒ–é—®é¢˜â€”â€”çŒœä¸€ä¸ª`mid`ï¼ŒæŠŠè¾¹æƒâ‰¥`mid`çš„æ ‡ä¸º1ï¼Œ<`mid`çš„æ ‡ä¸º-1ã€‚æ­¤æ—¶è·¯å¾„çš„ä¸­ä½æ•°â‰¥`mid`ç­‰ä»·äºâ€œè·¯å¾„å’Œâ‰¥0â€ï¼ˆå› ä¸ºâ‰¥`mid`çš„è¾¹æ•°â‰¥<`mid`çš„è¾¹æ•°ï¼‰ã€‚  

### æ ¸å¿ƒéš¾ç‚¹2ï¼šç‚¹åˆ†æ²»çš„è·¯å¾„ç»Ÿè®¡
**é—®é¢˜**ï¼šç»Ÿè®¡ç»è¿‡é‡å¿ƒçš„è·¯å¾„æ—¶ï¼Œéœ€è¦æ‰¾â€œè¾¹æ•°åœ¨[L,R]ä¹‹é—´çš„è·¯å¾„â€ï¼Œç›´æ¥æšä¸¾ä¼šé‡å¤æˆ–é—æ¼ã€‚  
**ç­–ç•¥**ï¼šç”¨**å•è°ƒé˜Ÿåˆ—ä¼˜åŒ–**â€”â€”æŒ‰å­æ ‘æ·±åº¦æ’åºï¼Œä¿è¯è·¯å¾„é•¿åº¦é€’å¢ã€‚å¯¹äºå½“å‰å­æ ‘çš„è·¯å¾„é•¿åº¦`x`ï¼Œéœ€è¦æ‰¾ä¹‹å‰å­æ ‘ä¸­é•¿åº¦åœ¨[L-x, R-x]çš„æœ€å¤§è·¯å¾„å’Œï¼Œè¿™æ˜¯ä¸€ä¸ªâ€œæ»‘åŠ¨çª—å£â€é—®é¢˜ï¼Œç”¨åŒç«¯é˜Ÿåˆ—ç»´æŠ¤çª—å£å†…çš„æœ€å¤§å€¼ã€‚  

### æ ¸å¿ƒéš¾ç‚¹3ï¼šå­æ ‘åˆå¹¶çš„é¡ºåº
**é—®é¢˜**ï¼šå¦‚æœå­æ ‘åˆå¹¶é¡ºåºä»»æ„ï¼Œå•è°ƒé˜Ÿåˆ—çš„åˆå§‹åŒ–ä¼šé‡å¤è®¡ç®—ï¼Œå¯¼è‡´å¤æ‚åº¦é€€åŒ–åˆ°O(nÂ²)ã€‚  
**ç­–ç•¥**ï¼š**æŒ‰å­æ ‘æ·±åº¦æ’åº**ï¼ˆæŒ‰ç§©åˆå¹¶ï¼‰â€”â€”å…ˆå¤„ç†å°æ·±åº¦çš„å­æ ‘ï¼Œå†å¤„ç†å¤§æ·±åº¦çš„å­æ ‘ã€‚è¿™æ ·æ»‘åŠ¨çª—å£çš„â€œåˆå§‹èŒƒå›´â€åªä¼šæ‰©å¤§ï¼Œä¸ä¼šé‡ç½®ï¼Œæ€»å¤æ‚åº¦é™åˆ°O(nlogn)ã€‚  


## 4. C++æ ¸å¿ƒä»£ç å®ç°èµæ

### æœ¬é¢˜é€šç”¨æ ¸å¿ƒC++å®ç°å‚è€ƒ
**è¯´æ˜**ï¼šç»¼åˆshadowice1984ã€å°ç²‰å…”çš„é¢˜è§£æ€è·¯ï¼Œæç‚¼å‡ºçš„ç‚¹åˆ†æ²»+å•è°ƒé˜Ÿåˆ—çš„æ ¸å¿ƒå®ç°ã€‚  
**å®Œæ•´æ ¸å¿ƒä»£ç **ï¼š
```cpp
#include <cstdio>
#include <vector>
#include <queue>
#include <algorithm>
using namespace std;

const int N = 1e5 + 10;
const int INF = 0x3f3f3f3f;

struct Edge { int v, val; };
vector<Edge> g[N];
int n, L, R;
int ans1, ans2; // ç­”æ¡ˆè·¯å¾„çš„ä¸¤ä¸ªç«¯ç‚¹

// ç‚¹åˆ†æ²»ç›¸å…³å˜é‡
bool cut[N]; // æ˜¯å¦è¢«åˆ†æ²»è¿‡
int siz[N], mx[N], root; // å­æ ‘å¤§å°ã€æœ€å¤§å­æ ‘å¤§å°ã€é‡å¿ƒ
int w[N], nu[N]; // w[dep]ï¼šæ·±åº¦ä¸ºdepçš„æœ€å¤§è·¯å¾„å’Œï¼›nu[dep]ï¼šå¯¹åº”ç«¯ç‚¹

// åŒç«¯é˜Ÿåˆ—ï¼ˆå•è°ƒé˜Ÿåˆ—ï¼‰
struct Deque {
    int q[N], hd, tl;
    void clear() { hd = 1; tl = 0; }
    bool empty() { return hd > tl; }
    void push(int j) {
        while (hd <= tl && w[j] >= w[q[tl]]) tl--;
        q[++tl] = j;
    }
    void pop(int k) {
        while (hd <= tl && q[hd] > k) hd++;
    }
    int front() { return q[hd]; }
} dq;

// è®¡ç®—å­æ ‘å¤§å°
int dfs_siz(int u, int fa) {
    siz[u] = 1;
    mx[u] = 0;
    for (auto &e : g[u]) {
        int v = e.v;
        if (v == fa || cut[v]) continue;
        siz[u] += dfs_siz(v, u);
        mx[u] = max(mx[u], siz[v]);
    }
    return siz[u];
}

// æ‰¾é‡å¿ƒ
void find_root(int u, int fa, int total) {
    mx[u] = max(mx[u], total - siz[u]);
    if (mx[u] < mx[root]) root = u;
    for (auto &e : g[u]) {
        int v = e.v;
        if (v == fa || cut[v]) continue;
        find_root(v, u, total);
    }
}

// BFSå¤„ç†å­æ ‘è·¯å¾„ï¼ˆè¿”å›æ˜¯å¦æ‰¾åˆ°ç¬¦åˆæ¡ä»¶çš„è·¯å¾„ï¼‰
bool bfs(int st, int val, int mxsiz) {
    dq.clear();
    queue<pair<int, pair<int, int>>> q; // (u, (dep, dis))
    q.push({st, {1, val}});
    w[1] = val; nu[1] = st;

    int j = min(R, mxsiz);
    for (; j >= L; j--) dq.push(j);

    while (!q.empty()) {
        auto [u, info] = q.front(); q.pop();
        int dep = info.first, dis = info.second;

        // æŸ¥æ‰¾åŒ¹é…çš„è·¯å¾„
        int dl = max(L - dep, 0), dr = min(R - dep, mxsiz);
        while (j >= dl) dq.push(j--);
        dq.pop(dr);
        if (!dq.empty()) {
            int p = dq.front();
            if (dis + w[p] >= 0) {
                ans1 = nu[p]; ans2 = u;
                return true;
            }
        }

        // éå†å­èŠ‚ç‚¹
        for (auto &e : g[u]) {
            int v = e.v;
            if (cut[v]) continue;
            int new_dep = dep + 1;
            int new_dis = dis + (e.val >= val ? 1 : -1);
            if (new_dep > R) continue;
            if (new_dis > w[new_dep]) {
                w[new_dep] = new_dis;
                nu[new_dep] = v;
            }
            q.push({v, {new_dep, new_dis}});
        }
    }
    return false;
}

// ç‚¹åˆ†æ²»ä¸»å‡½æ•°
bool solve(int u, int val) {
    dfs_siz(u, 0);
    root = 0;
    find_root(u, 0, siz[u]);
    cut[root] = true;

    // åˆå§‹åŒ–å½“å‰é‡å¿ƒçš„è·¯å¾„ä¿¡æ¯
    for (int i = 1; i <= siz[u]; i++) w[i] = -INF;
    w[0] = 0; nu[0] = root;

    // æŒ‰å­æ ‘æ·±åº¦æ’åºï¼ˆæŒ‰ç§©åˆå¹¶ï¼‰
    vector<pair<int, int>> children; // (å­æ ‘æ·±åº¦, å­èŠ‚ç‚¹)
    for (auto &e : g[root]) {
        int v = e.v;
        if (cut[v]) continue;
        int dep = dfs_siz(v, root);
        children.emplace_back(dep, v);
    }
    sort(children.begin(), children.end());

    // å¤„ç†æ¯ä¸ªå­æ ‘
    for (auto &child : children) {
        int v = child.second;
        if (bfs(v, (g[root][0].val >= val ? 1 : -1), child.first)) return true;
        // åˆå¹¶å½“å‰å­æ ‘çš„è·¯å¾„ä¿¡æ¯åˆ°å…¨å±€
        for (int i = 1; i <= child.first; i++) {
            if (w[i] < w[i]) { // å–æœ€å¤§å€¼
                w[i] = w[i];
                nu[i] = nu[i];
            }
        }
    }

    // é€’å½’å¤„ç†å­æ ‘
    for (auto &e : g[root]) {
        int v = e.v;
        if (!cut[v] && solve(v, val)) return true;
    }
    return false;
}

// äºŒåˆ†ç­”æ¡ˆä¸»å‡½æ•°
int main() {
    scanf("%d%d%d", &n, &L, &R);
    for (int i = 1; i < n; i++) {
        int u, v, val;
        scanf("%d%d%d", &u, &v, &val);
        g[u].push_back({v, val});
        g[v].push_back({u, val});
    }

    int l = 0, r = 1e9;
    while (l < r) {
        int mid = (l + r + 1) / 2;
        if (solve(1, mid)) l = mid;
        else r = mid - 1;
    }

    solve(1, l);
    printf("%d %d\n", ans1, ans2);
    return 0;
}
```
**ä»£ç è§£è¯»æ¦‚è¦**ï¼š  
1. **ç‚¹åˆ†æ²»æ¡†æ¶**ï¼š`dfs_siz`è®¡ç®—å­æ ‘å¤§å°ï¼Œ`find_root`æ‰¾é‡å¿ƒï¼Œ`solve`é€’å½’å¤„ç†åˆ†æ²»ï¼›  
2. **å•è°ƒé˜Ÿåˆ—ä¼˜åŒ–**ï¼š`bfs`éå†å­æ ‘ï¼Œç”¨åŒç«¯é˜Ÿåˆ—ç»´æŠ¤æ»‘åŠ¨çª—å£çš„æœ€å¤§å€¼ï¼Œå¿«é€ŸæŸ¥æ‰¾åŒ¹é…è·¯å¾„ï¼›  
3. **äºŒåˆ†ç­”æ¡ˆ**ï¼šå¤–å±‚äºŒåˆ†`mid`ï¼Œå†…å±‚ç”¨ç‚¹åˆ†æ²»åˆ¤æ–­æ˜¯å¦å­˜åœ¨ç¬¦åˆæ¡ä»¶çš„è·¯å¾„ã€‚


### é¢˜è§£ä¸€ï¼ˆshadowice1984ï¼‰æ ¸å¿ƒä»£ç ç‰‡æ®µèµæ
**äº®ç‚¹**ï¼šç”¨`BFS`ä¿è¯è·¯å¾„é•¿åº¦é€’å¢ï¼Œå•è°ƒé˜Ÿåˆ—å¤„ç†æ»‘åŠ¨çª—å£ã€‚  
**æ ¸å¿ƒä»£ç ç‰‡æ®µ**ï¼š
```cpp
bool bfs(data st, int mxsiz) {
    q.clr(); clear(q1); clear(q2);
    int j = min(R, mxsiz);
    for (; j >= L; j--) q.ins(j);
    for (q1.push(st); !q1.empty();) {
        data nw = q1.front(); q2.push(nw); q1.pop();
        if (nw.dep > R) continue;
        int dl = max(L - nw.dep, 0);
        int dr = min(R - nw.dep, mxsiz);
        for (; j >= dl; j--) q.ins(j);
        q.del(dr);
        if (q.emp()) {
            int p = q.qmx();
            if (nw.dis + w[p] >= 0) {
                ans1 = nu[p]; ans2 = nw.u;
                return true;
            }
        }
        // éå†å­èŠ‚ç‚¹
        for (auto &it : v[nw.u]) {
            if (it.v != nw.f && !cut[it.v]) {
                q1.push({it.v, nw.u, nw.dis + it.val, nw.dep + 1});
            }
        }
    }
    // åˆå¹¶å½“å‰å­æ ‘çš„è·¯å¾„ä¿¡æ¯
    for (; !q2.empty(); q2.pop()) {
        data a = q2.front();
        if (w[a.dep] < a.dis) {
            w[a.dep] = a.dis;
            nu[a.dep] = a.u;
        }
    }
    return false;
}
```
**ä»£ç è§£è¯»**ï¼š  
- `q`æ˜¯åŒç«¯é˜Ÿåˆ—ï¼Œç»´æŠ¤ä¹‹å‰å­æ ‘ä¸­æ·±åº¦åœ¨[L-nw.dep, R-nw.dep]çš„æœ€å¤§è·¯å¾„å’Œï¼›  
- `q1`ç”¨äºBFSéå†å½“å‰å­æ ‘ï¼Œä¿è¯è·¯å¾„é•¿åº¦é€’å¢ï¼›  
- `q2`ä¿å­˜å½“å‰å­æ ‘çš„è·¯å¾„ä¿¡æ¯ï¼Œåˆå¹¶åˆ°å…¨å±€çš„`w`å’Œ`nu`æ•°ç»„ä¸­ã€‚  


## 5. ç®—æ³•å¯è§†åŒ–ï¼šåƒç´ åŠ¨ç”»æ¼”ç¤º

### åŠ¨ç”»ä¸»é¢˜ï¼šåƒç´ æ ‘çš„â€œé‡å¿ƒæ¢é™©â€
**è®¾è®¡æ€è·¯**ï¼šç”¨8ä½åƒç´ é£æ ¼è¿˜åŸç‚¹åˆ†æ²»çš„å…¨è¿‡ç¨‹ï¼Œç»“åˆæ¸¸æˆåŒ–å…ƒç´ ï¼ˆå¦‚â€œé‡å¿ƒå¯»å®â€ï¼‰è®©ç®—æ³•æ›´ç›´è§‚ã€‚  
**æ ¸å¿ƒæ¼”ç¤ºå†…å®¹**ï¼š  
1. **æ ‘ç»“æ„åˆå§‹åŒ–**ï¼šç”¨32x32çš„åƒç´ å—è¡¨ç¤ºæ ‘èŠ‚ç‚¹ï¼ˆç™½è‰²ï¼‰ï¼Œè¾¹ç”¨ç°è‰²çº¿æ¡è¿æ¥ï¼Œè¾¹æƒç”¨æ•°å­—æ ‡æ³¨ï¼ˆå¦‚â€œ1â€æˆ–â€œ-1â€ï¼‰ã€‚  
2. **é‡å¿ƒé€‰æ‹©**ï¼šç”¨é»„è‰²é«˜äº®å½“å‰åˆ†æ²»çš„é‡å¿ƒï¼Œæ’­æ”¾â€œå®â€çš„éŸ³æ•ˆè¡¨ç¤ºæ‰¾åˆ°é‡å¿ƒã€‚  
3. **å­æ ‘éå†**ï¼šç”¨è“è‰²çº¿æ¡æ ‡è®°å½“å‰å­æ ‘çš„è·¯å¾„ï¼Œæ·±åº¦ç”¨åƒç´ å—çš„â€œå±‚çº§â€è¡¨ç¤ºï¼ˆè¶Šå¾€ä¸‹å±‚çº§è¶Šé«˜ï¼‰ã€‚  
4. **å•è°ƒé˜Ÿåˆ—æ»‘åŠ¨**ï¼šç”¨çº¢è‰²çŸ©å½¢æ¡†è¡¨ç¤ºæ»‘åŠ¨çª—å£ï¼Œé˜Ÿåˆ—ä¸­çš„æœ€å¤§å€¼ç”¨ç»¿è‰²é«˜äº®ï¼Œæ’­æ”¾â€œå—–å—–â€çš„éŸ³æ•ˆè¡¨ç¤ºçª—å£ç§»åŠ¨ã€‚  
5. **è·¯å¾„åŒ¹é…**ï¼šå½“æ‰¾åˆ°ç¬¦åˆæ¡ä»¶çš„è·¯å¾„æ—¶ï¼Œç”¨é—ªçƒçš„æ©™è‰²çº¿æ¡è¿æ¥ä¸¤ä¸ªç«¯ç‚¹ï¼Œæ’­æ”¾â€œèƒœåˆ©â€éŸ³æ•ˆï¼ˆ8ä½é£æ ¼çš„â€œå®â€”å’šâ€ï¼‰ã€‚  

**äº¤äº’è®¾è®¡**ï¼š  
- **æ§åˆ¶é¢æ¿**ï¼šåŒ…å«â€œå•æ­¥æ‰§è¡Œâ€ï¼ˆé€å¸§çœ‹é‡å¿ƒé€‰æ‹©ã€å­æ ‘éå†ï¼‰ã€â€œè‡ªåŠ¨æ’­æ”¾â€ï¼ˆåŠ é€Ÿæ¼”ç¤ºï¼‰ã€â€œé‡ç½®â€æŒ‰é’®ï¼›  
- **é€Ÿåº¦æ»‘å—**ï¼šè°ƒæ•´åŠ¨ç”»æ’­æ”¾é€Ÿåº¦ï¼ˆ1x~5xï¼‰ï¼›  
- **éŸ³æ•ˆå¼€å…³**ï¼šå¯å…³é—­/å¼€å¯éŸ³æ•ˆï¼ˆé»˜è®¤å¼€å¯ï¼‰ã€‚  

**æŠ€æœ¯å®ç°**ï¼šç”¨HTML5 Canvasç»˜åˆ¶åƒç´ æ ‘ï¼ŒJavaScriptå®ç°åŠ¨ç”»é€»è¾‘ï¼ŒWeb Audio APIæ’­æ”¾8ä½éŸ³æ•ˆï¼ˆå¦‚é‡å¿ƒé€‰æ‹©çš„â€œå®â€å£°ã€è·¯å¾„åŒ¹é…çš„â€œèƒœåˆ©â€å£°ï¼‰ã€‚  


## 6. æ‹“å±•ç»ƒä¹ ä¸ç›¸ä¼¼é—®é¢˜æ€è€ƒ

### é€šç”¨æ€è·¯è¿ç§»
æœ¬é¢˜çš„â€œäºŒåˆ†ç­”æ¡ˆ+ç‚¹åˆ†æ²»â€æ€è·¯å¯ç”¨äº**æ ‘ä¸Šè·¯å¾„çš„æå€¼é—®é¢˜**ï¼ˆå¦‚æœ€å¤§è·¯å¾„å’Œã€æœ€é•¿è·¯å¾„ã€æ»¡è¶³æ¡ä»¶çš„è·¯å¾„æ•°ï¼‰ã€‚ä¾‹å¦‚ï¼š  
- æ±‚æ ‘ä¸Šè¾¹æ•°åœ¨[L,R]ä¹‹é—´çš„æœ€å¤§è·¯å¾„å’Œï¼›  
- æ±‚æ ‘ä¸Šæ‰€æœ‰è·¯å¾„ä¸­ï¼Œä¸­ä½æ•°æœ€å¤§çš„è·¯å¾„ã€‚  


### æ´›è°·æ¨èç»ƒä¹ 
1. **P4292 é‡å»ºè®¡åˆ’**ï¼šä¸æœ¬é¢˜é«˜åº¦ç›¸ä¼¼ï¼Œè¦æ±‚æ‰¾è¾¹æ•°åœ¨[L,R]ä¹‹é—´çš„æœ€å¤§å¹³å‡è·¯å¾„å’Œï¼Œç”¨äºŒåˆ†+ç‚¹åˆ†æ²»è§£å†³ã€‚  
2. **P3806 ç‚¹åˆ†æ²»æ¨¡æ¿**ï¼šå­¦ä¹ ç‚¹åˆ†æ²»çš„åŸºç¡€ï¼Œå¤„ç†æ ‘ä¸Šè·¯å¾„çš„è®¡æ•°é—®é¢˜ã€‚  
3. **P2634 ç‚¹åˆ†æ²»å¤„ç†è·¯å¾„é—®é¢˜**ï¼šç»ƒä¹ ç‚¹åˆ†æ²»ä¸­å¦‚ä½•ç»Ÿè®¡ç¬¦åˆæ¡ä»¶çš„è·¯å¾„ï¼Œå·©å›ºå•è°ƒé˜Ÿåˆ—ä¼˜åŒ–ã€‚  


## 7. å­¦ä¹ å¿ƒå¾—ä¸ç»éªŒåˆ†äº«
**å‚è€ƒç»éªŒï¼ˆæ¥è‡ªshadowice1984ï¼‰**ï¼šâ€œæœ¬é¢˜çš„å…³é”®æ˜¯å°†ä¸­ä½æ•°è½¬åŒ–ä¸ºè·¯å¾„å’Œï¼Œå†ç”¨ç‚¹åˆ†æ²»å¤„ç†ã€‚ä¸€å¼€å§‹ç”¨çº¿æ®µæ ‘å¯¼è‡´è¶…æ—¶ï¼Œåæ¥æ¢æˆå•è°ƒé˜Ÿåˆ—+æŒ‰ç§©åˆå¹¶ï¼Œç æ‰äº†ä¸€ä¸ªlogï¼Œæ‰é€šè¿‡ã€‚â€  
**ç‚¹è¯„**ï¼šè¿™ä¸ªç»éªŒå¾ˆçœŸå®â€”â€”ç®—æ³•ä¼˜åŒ–å¾€å¾€æ¥è‡ªâ€œå‘ç°å†—ä½™çš„logâ€ã€‚çº¿æ®µæ ‘çš„æŸ¥è¯¢æ˜¯O(logn)ï¼Œä½†å•è°ƒé˜Ÿåˆ—çš„æ»‘åŠ¨çª—å£æ˜¯O(1)ï¼Œç»“åˆæŒ‰ç§©åˆå¹¶ï¼Œèƒ½æŠŠå¤æ‚åº¦é™åˆ°æ›´ä¼˜ã€‚  


## 8. æ€»ç»“
æœ¬æ¬¡åˆ†æçš„â€œFreezing with Styleâ€é¢˜ï¼Œæ ¸å¿ƒæ˜¯**äºŒåˆ†ç­”æ¡ˆ+ç‚¹åˆ†æ²»**çš„ç»“åˆã€‚é€šè¿‡å°†ä¸­ä½æ•°é—®é¢˜è½¬åŒ–ä¸ºè·¯å¾„å’Œé—®é¢˜ï¼Œå†ç”¨ç‚¹åˆ†æ²»é«˜æ•ˆç»Ÿè®¡è·¯å¾„ï¼Œæœ€åç”¨å•è°ƒé˜Ÿåˆ—ä¼˜åŒ–æ»‘åŠ¨çª—å£ï¼Œæˆ‘ä»¬èƒ½åœ¨O(nlogÂ²n)çš„æ—¶é—´å†…è§£å†³é—®é¢˜ã€‚  

è®°ä½ï¼š**ä¸­ä½æ•°é—®é¢˜å¸¸ç”¨äºŒåˆ†è½¬åŒ–ï¼Œæ ‘ä¸Šè·¯å¾„é—®é¢˜å¸¸ç”¨ç‚¹åˆ†æ²»ï¼Œæ»‘åŠ¨çª—å£å¸¸ç”¨å•è°ƒé˜Ÿåˆ—**â€”â€”è¿™äº›æŠ€å·§ç»„åˆèµ·æ¥ï¼Œèƒ½è§£å†³å¾ˆå¤šå¤æ‚çš„ç®—æ³•é¢˜ï¼  

ä¸‹æ¬¡æˆ‘ä»¬å†ä¸€èµ·æ¢ç´¢æ›´å¤šç¼–ç¨‹æŒ‘æˆ˜ï¼ŒåŠ æ²¹ï¼ğŸ’ª

---
å¤„ç†ç”¨æ—¶ï¼š88.71ç§’
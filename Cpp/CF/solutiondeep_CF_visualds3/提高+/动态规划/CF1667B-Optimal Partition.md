# È¢òÁõÆ‰ø°ÊÅØ

# Optimal Partition

## È¢òÁõÆÊèèËø∞

You are given an array $ a $ consisting of $ n $ integers. You should divide $ a $ into continuous non-empty subarrays (there are $ 2^{n-1} $ ways to do that).

Let $ s=a_l+a_{l+1}+\ldots+a_r $ . The value of a subarray $ a_l, a_{l+1}, \ldots, a_r $ is:

- $ (r-l+1) $ if $ s>0 $ ,
- $ 0 $ if $ s=0 $ ,
- $ -(r-l+1) $ if $ s<0 $ .

 What is the maximum sum of values you can get with a partition?

## ËØ¥Êòé/ÊèêÁ§∫

Test case $ 1 $ : one optimal partition is $ [1, 2] $ , $ [-3] $ . $ 1+2>0 $ so the value of $ [1, 2] $ is $ 2 $ . $ -3<0 $ , so the value of $ [-3] $ is $ -1 $ . $ 2+(-1)=1 $ .

Test case $ 2 $ : the optimal partition is $ [0, -2, 3] $ , $ [-4] $ , and the sum of values is $ 3+(-1)=2 $ .

## Ê†∑‰æã #1

### ËæìÂÖ•

```
5
3
1 2 -3
4
0 -2 3 -4
5
-1 -2 3 -1 -1
6
-1 2 -3 4 -5 6
7
1 -1 -1 1 -1 -1 1```

### ËæìÂá∫

```
1
2
1
6
-1```

# AIÂàÜÊûêÁªìÊûú

# üí° KayÁöÑC++ÁÆóÊ≥ïËß£ÊûêÔºöOptimal Partition Ê∑±ÂÖ•Â≠¶‰π†ÊåáÂçó üí°


## 1. È¢òÁõÆËß£ËØª‰∏éÊ†∏ÂøÉÁÆóÊ≥ïËØÜÂà´

‚ú® **Êú¨È¢ò‰∏ªË¶ÅËÄÉÂØü**ÔºöÂä®ÊÄÅËßÑÂàíÔºàDPÔºâÁªìÂêàÁ∫øÊÆµÊ†ë/Ê†ëÁä∂Êï∞ÁªÑ‰ºòÂåñ  

üó£Ô∏è **ÂàùÊ≠•ÂàÜÊûê**Ôºö  
Ëß£ÂÜ≥„ÄåOptimal Partition„ÄçÁöÑÂÖ≥ÈîÆÔºåÊòØÁî®**Âä®ÊÄÅËßÑÂàí**ÂÆö‰πâ„ÄåÂâçi‰∏™ÂÖÉÁ¥†ÁöÑÊúÄÂ§ß‰ª∑ÂÄº„ÄçÔºåÂÜçÈÄöËøá**Á∫øÊÆµÊ†ë/Ê†ëÁä∂Êï∞ÁªÑ**Â∞ÜÂéüÊú¨O(n¬≤)ÁöÑËΩ¨Áßª‰ºòÂåñÂà∞O(n log n)„ÄÇ  

ÁÆÄÂçïÊù•ËØ¥ÔºåÂä®ÊÄÅËßÑÂàíÔºàDPÔºâÂÉè„ÄåÊê≠ÁßØÊú®„Äç‚Äî‚ÄîÊàë‰ª¨Áî®`dp[i]`Ë°®Á§∫Ââçi‰∏™ÂÖÉÁ¥†ÁöÑÊúÄÂ§ß‰ª∑ÂÄºÔºåÁÑ∂ÂêéÈÄöËøá‰πãÂâçÁöÑ`dp[j]`Ôºàj<iÔºâÊù•Êé®ÂØº`dp[i]`„ÄÇ‰ΩÜÁõ¥Êé•Êûö‰∏æj‰ºöË∂ÖÊó∂ÔºåÊâÄ‰ª•ÈúÄË¶Å**ÊåâÂâçÁºÄÂíåÁöÑÂ§ßÂ∞èÂÖ≥Á≥ªÊãÜÂàÜËΩ¨ÁßªÊñπÁ®ã**ÔºåÁî®Êï∞ÊçÆÁªìÊûÑÂø´ÈÄüÊâæÂà∞ÊâÄÈúÄÁöÑÊúÄÂ§ßÂÄº„ÄÇ  

### Ê†∏ÂøÉÊÄùË∑ØÊãÜËß£  
1. **Áä∂ÊÄÅÂÆö‰πâ**Ôºö`dp[i]` = Ââçi‰∏™ÂÖÉÁ¥†ÁöÑÊúÄÂ§ß‰ª∑ÂÄº„ÄÇ  
2. **ËΩ¨ÁßªÊñπÁ®ã**Ôºö  
   ËÆæÂâçÁºÄÂíå`s[i] = a[1]+a[2]+‚Ä¶+a[i]`ÔºåÂàôÂ≠êÊï∞ÁªÑ`[j+1,i]`ÁöÑÂíå‰∏∫`s[i]-s[j]`„ÄÇÊ†πÊçÆÂíåÁöÑÊ≠£Ë¥üÔºåËΩ¨ÁßªÂàÜ‰∏∫‰∏âÁ±ªÔºö  
   - Ëã•`s[i] > s[j]`Ôºö‰ª∑ÂÄº‰∏∫`i-j`ÔºåÊïÖ`dp[i] = max(dp[j]-j) + i`Ôºõ  
   - Ëã•`s[i] = s[j]`Ôºö‰ª∑ÂÄº‰∏∫0ÔºåÊïÖ`dp[i] = max(dp[j])`Ôºõ  
   - Ëã•`s[i] < s[j]`Ôºö‰ª∑ÂÄº‰∏∫`-(i-j)`ÔºåÊïÖ`dp[i] = max(dp[j]+j) - i`„ÄÇ  
3. **‰ºòÂåñÂÖ≥ÈîÆ**ÔºöÁî®Á∫øÊÆµÊ†ë/Ê†ëÁä∂Êï∞ÁªÑÁª¥Êä§‰∏â‰∏™ÂÄºÁöÑÊúÄÂ§ßÂÄº‚Äî‚Äî`dp[j]-j`ÔºàÂâçÁºÄÊúÄÂ§ßÔºâ„ÄÅ`dp[j]`ÔºàÂçïÁÇπÊúÄÂ§ßÔºâ„ÄÅ`dp[j]+j`ÔºàÂêéÁºÄÊúÄÂ§ßÔºâÔºå‰ªéËÄåÂø´ÈÄüÊü•ËØ¢ËΩ¨ÁßªÊâÄÈúÄÁöÑÊúÄÂ§ßÂÄº„ÄÇ  

### ÂèØËßÜÂåñËÆæËÆ°ÊÄùË∑Ø  
Êàë‰ª¨Â∞ÜÁî®**FCÁ∫¢ÁôΩÊú∫È£éÊ†ºÁöÑÂÉèÁ¥†Âä®Áîª**ÊºîÁ§∫ÁÆóÊ≥ïÊµÅÁ®ãÔºö  
- Â±èÂπïÂ∑¶‰æßÂ±ïÁ§∫Êï∞ÁªÑ`a`ÂíåÂâçÁºÄÂíå`s`ÁöÑÂÉèÁ¥†ÂùóÔºà‰∏çÂêåÈ¢úËâ≤Âå∫ÂàÜÊ≠£Ë¥üÔºâÔºõ  
- ‰∏≠Èó¥Âå∫ÂüüÂä®ÊÄÅÊòæÁ§∫`dp`Êï∞ÁªÑÁöÑÂèòÂåñÔºàÈ´ò‰∫ÆÂΩìÂâçËÆ°ÁÆóÁöÑ`dp[i]`ÔºâÔºõ  
- Âè≥‰æßÁî®ÂÉèÁ¥†ÂåñÁöÑ„ÄåÁ∫øÊÆµÊ†ë„ÄçÂõæÊ†áÂ±ïÁ§∫Êï∞ÊçÆÁªìÊûÑÁöÑÊü•ËØ¢/Êõ¥Êñ∞Êìç‰ΩúÔºàÊØîÂ¶ÇÊü•ËØ¢`dp[j]-j`ÁöÑÂâçÁºÄÊúÄÂ§ßÊó∂ÔºåÁ∫øÊÆµÊ†ëÂõæÊ†á‰ºöÈó™ÁÉÅÂØπÂ∫îÂå∫Èó¥ÔºâÔºõ  
- ÂÖ≥ÈîÆÊìç‰ΩúÔºàÂ¶ÇÊü•ËØ¢„ÄÅÊõ¥Êñ∞Ôºâ‰º¥Èöè8‰ΩçÈü≥ÊïàÔºàÊØîÂ¶ÇÊü•ËØ¢ÊòØ„ÄåÂèÆ„ÄçÔºåÊõ¥Êñ∞ÊòØ„ÄåÂíî„ÄçÔºâÔºåÂÆåÊàêÊó∂Êí≠Êîæ„ÄåËÉúÂà©„ÄçÈü≥Êïà„ÄÇ  


## 2. Á≤æÈÄâ‰ºòË¥®È¢òËß£ÂèÇËÄÉ

‰∏∫Â§ßÂÆ∂Á≠õÈÄâ‰∫Ü3‰ªΩÊÄùË∑ØÊ∏ÖÊô∞„ÄÅ‰ª£Á†ÅÈ´òÊïàÁöÑ‰ºòË¥®È¢òËß£Ôºö


### È¢òËß£‰∏ÄÔºöAngueiÔºàËµûÔºö14Ôºâ  
* **ÁÇπËØÑ**Ôºö  
  Ëøô‰ªΩÈ¢òËß£ÊòØ„ÄåÊ†áÂáÜËß£Ê≥ï„ÄçÁöÑÂÖ∏ËåÉ‚Äî‚ÄîÊÄùË∑ØÊé®ÂØºÊûÅÂÖ∂Ê∏ÖÊô∞ÔºåÂ∞ÜËΩ¨ÁßªÊñπÁ®ãÊãÜÂàÜ‰∏∫‰∏âÁ±ªÂêéÔºåÁõ¥Êé•Áî®**‰∏âÊ£µÁ∫øÊÆµÊ†ë**ÂàÜÂà´Áª¥Êä§`dp[j]-j`„ÄÅ`dp[j]`„ÄÅ`dp[j]+j`ÁöÑÊúÄÂ§ßÂÄº„ÄÇ‰ª£Á†ÅÁªìÊûÑÂ∑•Êï¥ÔºåÂèòÈáèÂëΩÂêçËßÑËåÉÔºàÂ¶Ç`SegTree`ÁªìÊûÑ‰ΩìÂ∞ÅË£ÖÁ∫øÊÆµÊ†ëÊìç‰ΩúÔºâÔºåËæπÁïåÂ§ÑÁêÜ‰∏•Ë∞®ÔºàÊØîÂ¶ÇÂâçÁºÄÂíåÁ¶ªÊï£ÂåñÊó∂Â§ÑÁêÜ`s[0]=0`ÁöÑÊÉÖÂÜµÔºâ„ÄÇ  
  ‰∫ÆÁÇπÔºöÂ∞ÜÂ§çÊùÇÁöÑËΩ¨ÁßªÈóÆÈ¢òÊãÜËß£‰∏∫Êï∞ÊçÆÁªìÊûÑÁöÑ„ÄåÂå∫Èó¥Êü•ËØ¢+ÂçïÁÇπÊõ¥Êñ∞„ÄçÔºåÂÆåÁæé‰ΩìÁé∞‰∫Ü„ÄåDP‰ºòÂåñ=Áä∂ÊÄÅÂÆö‰πâ+Êï∞ÊçÆÁªìÊûÑ„ÄçÁöÑÊ†∏ÂøÉÊÄùÊÉ≥„ÄÇ


### È¢òËß£‰∫åÔºöI_am_AcceptedÔºàËµûÔºö8Ôºâ  
* **ÁÇπËØÑ**Ôºö  
  Ê≠§È¢òËß£Áî®**‰∏§‰∏™Ê†ëÁä∂Êï∞ÁªÑÔºàBITÔºâ+‰∏Ä‰∏™Ê°∂**Êõø‰ª£‰∫Ü‰∏âÊ£µÁ∫øÊÆµÊ†ëÔºåÊõ¥È´òÊïàÔºàÊ†ëÁä∂Êï∞ÁªÑÂ∏∏Êï∞Êõ¥Â∞èÔºâ„ÄÇÂÖ∂‰∏≠ÔºåBIT1Áª¥Êä§`dp[j]-j`ÁöÑÂâçÁºÄÊúÄÂ§ßÔºåBIT2Áª¥Êä§`dp[j]+j`ÁöÑÂêéÁºÄÊúÄÂ§ßÔºåÊ°∂Áª¥Êä§`dp[j]`ÁöÑÂçïÁÇπÊúÄÂ§ß„ÄÇ‰ª£Á†ÅÈ£éÊ†ºÁÆÄÊ¥ÅÔºåÂ§ßÈáè‰ΩøÁî®`ckmx`ÔºàÂç≥`max`ÔºâÂÆèÁÆÄÂåñ‰ª£Á†ÅÔºåÈÄÇÂêàÁ´ûËµõÂú∫ÊôØ„ÄÇ  
  ‰∫ÆÁÇπÔºöÁî®Ê†ëÁä∂Êï∞ÁªÑ‰ºòÂåñÂêéÁºÄÊü•ËØ¢ÔºàÈÄöËøá„ÄåÂèçÂêëÊò†Â∞Ñ„ÄçÂ∞ÜÂêéÁºÄÊü•ËØ¢ËΩ¨Âåñ‰∏∫ÂâçÁºÄÊü•ËØ¢ÔºâÔºåÊòØÂØπÊï∞ÊçÆÁªìÊûÑÁöÑÁÅµÊ¥ªËøêÁî®„ÄÇ


### È¢òËß£‰∏âÔºöJjy123ÔºàËµûÔºö4Ôºâ  
* **ÁÇπËØÑ**Ôºö  
  Ê≠§È¢òËß£ÁöÑ‰ª£Á†ÅÊòØ„ÄåË∏©ÂùëÂêéÁöÑÁªìÊô∂„Äç‚Äî‚Äî‰ΩúËÄÖÊèêÂà∞Ë∞ÉËØï‰∫Ü4Â∞èÊó∂Ôºå‰∏ªË¶ÅÈóÆÈ¢òÈõÜ‰∏≠Âú®**Á¶ªÊï£ÂåñÁöÑÊ≠£Á°ÆÊÄß**Âíå**Á∫øÊÆµÊ†ëÁöÑËæπÁïåÂ§ÑÁêÜ**„ÄÇ‰ª£Á†ÅÈÄªËæë‰∏éÈ¢òËß£‰∏Ä‰∏ÄËá¥Ôºå‰ΩÜÊõ¥Ê≥®ÈáçÁªÜËäÇÔºàÊØîÂ¶ÇÁî®`stable_sort`‰øùÊåÅÁ¶ªÊï£ÂåñÁöÑÁ®≥ÂÆöÊÄßÔºâ„ÄÇËôΩÁÑ∂ËøáÁ®ãÊõ≤ÊäòÔºå‰ΩÜËøô‰ªΩÈ¢òËß£ËÉΩËÆ©Êàë‰ª¨Êõ¥Ê∑±ÂàªÂú∞ÁêÜËß£„ÄåÁ¶ªÊï£Âåñ„ÄçÂíå„ÄåÁ∫øÊÆµÊ†ëÂàùÂßãÂåñ„ÄçÁöÑÈáçË¶ÅÊÄß„ÄÇ  
  ‰∫ÆÁÇπÔºö‰ΩúËÄÖÁöÑË∞ÉËØïÁªèÈ™åÊèêÈÜíÊàë‰ª¨‚Äî‚Äî**Âä®ÊÄÅËßÑÂàíÁöÑ‰ºòÂåñÈóÆÈ¢òÔºåÁªÜËäÇÂÜ≥ÂÆöÊàêË¥•**„ÄÇ


## 3. Ê†∏ÂøÉÈöæÁÇπËæ®Êûê‰∏éËß£È¢òÁ≠ñÁï•

### 1. ËΩ¨ÁßªÊñπÁ®ãÁöÑÊãÜÂàÜÔºö‰ªéO(n¬≤)Âà∞O(n log n)  
- **ÈöæÁÇπ**ÔºöÁõ¥Êé•Êûö‰∏æj‰ºöË∂ÖÊó∂ÔºåÂ¶Ç‰ΩïÂ∞ÜËΩ¨ÁßªÊñπÁ®ãËΩ¨Âåñ‰∏∫ÂèØÂø´ÈÄüÊü•ËØ¢ÁöÑÂΩ¢ÂºèÔºü  
- **Á≠ñÁï•**ÔºöÂ∞ÜËΩ¨ÁßªÊñπÁ®ã‰∏≠ÁöÑ„Äåi-j„Äç„Äåj-i„ÄçÊãÜÂàÜ‰∏∫„Äå‰∏éiÁõ∏ÂÖ≥„ÄçÂíå„Äå‰∏éjÁõ∏ÂÖ≥„ÄçÁöÑ‰∏§ÈÉ®ÂàÜÔºàÂ¶Ç`dp[j]-j + i`ÔºâÔºåËøôÊ†∑Âè™ÈúÄÁª¥Êä§„Äå‰∏éjÁõ∏ÂÖ≥„ÄçÈÉ®ÂàÜÁöÑÊúÄÂ§ßÂÄºÔºåÂÜçÁªìÂêàiËÆ°ÁÆóÂç≥ÂèØ„ÄÇ  
- üí° **Â≠¶‰π†Á¨îËÆ∞**ÔºöÊãÜÂàÜËΩ¨ÁßªÊñπÁ®ãÊòØDP‰ºòÂåñÁöÑÂÖ≥ÈîÆ‚Äî‚ÄîÂ∞Ü„Äå‰æùËµñjÁöÑÈÉ®ÂàÜ„ÄçÂíå„Äå‰æùËµñiÁöÑÈÉ®ÂàÜ„ÄçÂàÜÁ¶ªÔºåÊâçËÉΩÁî®Êï∞ÊçÆÁªìÊûÑÂø´ÈÄüÊü•ËØ¢„ÄÇ


### 2. ÂâçÁºÄÂíåÁöÑÁ¶ªÊï£ÂåñÔºöÂ§ÑÁêÜÂ§ßÊï∞ÈóÆÈ¢ò  
- **ÈöæÁÇπ**ÔºöÂâçÁºÄÂíå`s[i]`ÂèØËÉΩÂæàÂ§ßÔºàÂ¶Çn=5e5Ôºåa[i]=1e9Êó∂Ôºås[i]ÂèØËææ5e14ÔºâÔºåÊó†Ê≥ïÁõ¥Êé•‰Ωú‰∏∫Êï∞ÁªÑ‰∏ãÊ†á„ÄÇ  
- **Á≠ñÁï•**ÔºöÂ∞ÜÊâÄÊúâÂâçÁºÄÂíåÊéíÂ∫è„ÄÅÂéªÈáçÔºåÊò†Â∞ÑÂà∞1~mÁöÑËøûÁª≠Êï¥Êï∞Ôºàm‰∏∫‰∏çÂêåÂâçÁºÄÂíåÁöÑÊï∞ÈáèÔºâÔºåËøôÂ∞±ÊòØ„ÄåÁ¶ªÊï£Âåñ„Äç„ÄÇ  
- üí° **Â≠¶‰π†Á¨îËÆ∞**ÔºöÁ¶ªÊï£ÂåñÊòØÂ§ÑÁêÜ„ÄåÂ§ßËåÉÂõ¥Êï∞ÂÄº„ÄçÁöÑÂ∏∏Áî®ÊäÄÂ∑ßÔºåÊ†∏ÂøÉÊòØ„ÄåÁî®Áõ∏ÂØπÂ§ßÂ∞èÊõø‰ª£ÁªùÂØπÂ§ßÂ∞è„Äç„ÄÇ


### 3. Êï∞ÊçÆÁªìÊûÑÁöÑÈÄâÊã©ÔºöÁ∫øÊÆµÊ†ëvsÊ†ëÁä∂Êï∞ÁªÑ  
- **ÈöæÁÇπ**ÔºöÂ¶Ç‰ΩïÈÄâÊã©ÂêàÈÄÇÁöÑÊï∞ÊçÆÁªìÊûÑÁª¥Êä§ÊúÄÂ§ßÂÄºÔºü  
- **Á≠ñÁï•**Ôºö  
  - Á∫øÊÆµÊ†ëÔºöÊîØÊåÅ‰ªªÊÑèÂå∫Èó¥ÁöÑÊü•ËØ¢/Êõ¥Êñ∞ÔºåÂäüËÉΩÊõ¥ÂÖ®ÔºàÂ¶ÇÈ¢òËß£‰∏ÄÁî®‰∏âÊ£µÁ∫øÊÆµÊ†ëÔºâÔºõ  
  - Ê†ëÁä∂Êï∞ÁªÑÔºö‰ªÖÊîØÊåÅÂâçÁºÄ/ÂêéÁºÄÊü•ËØ¢Ôºå‰ΩÜÂ∏∏Êï∞Êõ¥Â∞èÔºàÂ¶ÇÈ¢òËß£‰∫åÁî®‰∏§‰∏™Ê†ëÁä∂Êï∞ÁªÑÔºâ„ÄÇ  
- üí° **Â≠¶‰π†Á¨îËÆ∞**ÔºöÊ†πÊçÆÈúÄÊ±ÇÈÄâÊã©Êï∞ÊçÆÁªìÊûÑ‚Äî‚ÄîÂ¶ÇÊûúÈúÄË¶ÅÁÅµÊ¥ªÁöÑÂå∫Èó¥Êìç‰ΩúÔºåÈÄâÁ∫øÊÆµÊ†ëÔºõÂ¶ÇÊûúÂè™ÈúÄË¶ÅÂâçÁºÄ/ÂêéÁºÄÊü•ËØ¢ÔºåÈÄâÊ†ëÁä∂Êï∞ÁªÑ„ÄÇ


### ‚ú® Ëß£È¢òÊäÄÂ∑ßÊÄªÁªì  
1. **ÈóÆÈ¢òÊãÜÂàÜ**ÔºöÂ∞ÜÂ§çÊùÇÁöÑËΩ¨ÁßªÊñπÁ®ãÊãÜÂàÜ‰∏∫„Äå‰∏éiÁõ∏ÂÖ≥„ÄçÂíå„Äå‰∏éjÁõ∏ÂÖ≥„ÄçÁöÑ‰∏§ÈÉ®ÂàÜÔºå‰∏∫Êï∞ÊçÆÁªìÊûÑ‰ºòÂåñÈì∫Ë∑ØÔºõ  
2. **Á¶ªÊï£Âåñ**ÔºöÂ§ÑÁêÜÂ§ßËåÉÂõ¥Êï∞ÂÄºÊó∂ÔºåÁî®„ÄåÁõ∏ÂØπÂ§ßÂ∞è„ÄçÊõø‰ª£„ÄåÁªùÂØπÂ§ßÂ∞è„ÄçÔºõ  
3. **Êï∞ÊçÆÁªìÊûÑÂ∞ÅË£Ö**ÔºöÂ∞ÜÁ∫øÊÆµÊ†ë/Ê†ëÁä∂Êï∞ÁªÑÂ∞ÅË£Ö‰∏∫ÁªìÊûÑ‰ΩìÔºåÊèêÈ´ò‰ª£Á†ÅÂèØËØªÊÄßÂíåÂ§çÁî®ÊÄßÔºõ  
4. **ËæπÁïåÂ§ÑÁêÜ**ÔºöÊ≥®ÊÑèÂâçÁºÄÂíå`s[0]=0`ÁöÑÊÉÖÂÜµÔºàÂØπÂ∫îÁ©∫Êï∞ÁªÑÁöÑÂàùÂßãÁä∂ÊÄÅÔºâ„ÄÇ


## 4. C++Ê†∏ÂøÉ‰ª£Á†ÅÂÆûÁé∞ËµèÊûê

### Êú¨È¢òÈÄöÁî®Ê†∏ÂøÉC++ÂÆûÁé∞ÂèÇËÄÉ  
* **ËØ¥Êòé**ÔºöÁªºÂêàÈ¢òËß£‰∏ÄÁöÑÊÄùË∑ØÔºåÁî®‰∏âÊ£µÁ∫øÊÆµÊ†ëÁª¥Êä§ÊúÄÂ§ßÂÄºÔºåÊòØÊúÄÊòìÁêÜËß£ÁöÑÊ†áÂáÜÂÆûÁé∞„ÄÇ  

```cpp
#include <iostream>
#include <vector>
#include <algorithm>
#include <map>
using namespace std;
typedef long long ll;

const ll INF = 1e18;

struct SegTree {
    vector<ll> tree;
    int n;
    SegTree(int size) : n(size), tree(4 * size, -INF) {}
    void update(int pos, ll val) { update(1, 1, n, pos, val); }
    ll query(int l, int r) { return query(1, 1, n, l, r); }
private:
    void update(int node, int l, int r, int pos, ll val) {
        if (l == r) { tree[node] = max(tree[node], val); return; }
        int mid = (l + r) / 2;
        if (pos <= mid) update(2*node, l, mid, pos, val);
        else update(2*node+1, mid+1, r, pos, val);
        tree[node] = max(tree[2*node], tree[2*node+1]);
    }
    ll query(int node, int l, int r, int ql, int qr) {
        if (qr < l || r < ql) return -INF;
        if (ql <= l && r <= qr) return tree[node];
        int mid = (l + r) / 2;
        return max(query(2*node, l, mid, ql, qr),
                   query(2*node+1, mid+1, r, ql, qr));
    }
};

int main() {
    ios::sync_with_stdio(false); cin.tie(0);
    int T; cin >> T;
    while (T--) {
        int n; cin >> n;
        vector<ll> a(n+1), s(n+1);
        for (int i=1; i<=n; i++) {
            cin >> a[i];
            s[i] = s[i-1] + a[i];
        }
        // Á¶ªÊï£ÂåñÂâçÁºÄÂíå
        vector<ll> vs = s;
        sort(vs.begin(), vs.end());
        vs.erase(unique(vs.begin(), vs.end()), vs.end());
        map<ll, int> mp;
        for (int i=0; i<vs.size(); i++) mp[vs[i]] = i+1; // Êò†Â∞ÑÂà∞1~m
        int m = vs.size();
        // ÂàùÂßãÂåñ‰∏âÊ£µÁ∫øÊÆµÊ†ëÔºöÁª¥Êä§dp[j]-j„ÄÅdp[j]„ÄÅdp[j]+j
        SegTree t1(m), t2(m), t3(m);
        t1.update(mp[0], 0 - 0); // dp[0] = 0ÔºåÂØπÂ∫îj=0
        t2.update(mp[0], 0);
        t3.update(mp[0], 0 + 0);
        vector<ll> dp(n+1, -INF);
        for (int i=1; i<=n; i++) {
            int pos = mp[s[i]];
            // ËΩ¨Áßª1Ôºös[i] > s[j] ‚Üí max(dp[j]-j) + i
            ll v1 = t1.query(1, pos-1) + i;
            // ËΩ¨Áßª2Ôºös[i] = s[j] ‚Üí max(dp[j])
            ll v2 = t2.query(pos, pos);
            // ËΩ¨Áßª3Ôºös[i] < s[j] ‚Üí max(dp[j]+j) - i
            ll v3 = t3.query(pos+1, m) - i;
            dp[i] = max({v1, v2, v3});
            // Êõ¥Êñ∞‰∏âÊ£µÁ∫øÊÆµÊ†ë
            t1.update(pos, dp[i] - i);
            t2.update(pos, dp[i]);
            t3.update(pos, dp[i] + i);
        }
        cout << dp[n] << endl;
    }
    return 0;
}
```

* **‰ª£Á†ÅËß£ËØªÊ¶ÇË¶Å**Ôºö  
  1. ËØªÂèñËæìÂÖ•Âπ∂ËÆ°ÁÆóÂâçÁºÄÂíå`s`Ôºõ  
  2. Á¶ªÊï£ÂåñÂâçÁºÄÂíå`s`ÔºåÂ∞ÜÂÖ∂Êò†Â∞ÑÂà∞1~mÁöÑËøûÁª≠Êï¥Êï∞Ôºõ  
  3. ÂàùÂßãÂåñ‰∏âÊ£µÁ∫øÊÆµÊ†ëÔºåÂàÜÂà´Áª¥Êä§`dp[j]-j`„ÄÅ`dp[j]`„ÄÅ`dp[j]+j`ÁöÑÊúÄÂ§ßÂÄºÔºõ  
  4. ÈÅçÂéÜÊØè‰∏™iÔºåÊü•ËØ¢‰∏âÊ£µÁ∫øÊÆµÊ†ëÂæóÂà∞ËΩ¨ÁßªÁöÑ‰∏â‰∏™ÂèØËÉΩÂÄºÔºåÂèñÊúÄÂ§ßÂÄº‰Ωú‰∏∫`dp[i]`Ôºõ  
  5. Êõ¥Êñ∞Á∫øÊÆµÊ†ëÔºåÂ∞Ü`dp[i]`ÁöÑÁõ∏ÂÖ≥ÂÄºÂ≠òÂÖ•ÂØπÂ∫î‰ΩçÁΩÆ„ÄÇ


### È¢òËß£‰∏ÄÊ†∏ÂøÉÁâáÊÆµËµèÊûêÔºàAngueiÔºâ  
* **‰∫ÆÁÇπ**ÔºöÁî®ÁªìÊûÑ‰ΩìÂ∞ÅË£ÖÁ∫øÊÆµÊ†ëÔºå‰ª£Á†ÅÊ®°ÂùóÂåñ„ÄÇ  
* **Ê†∏ÂøÉ‰ª£Á†ÅÁâáÊÆµ**Ôºö  
  ```cpp
  struct SegTree {
    vector<ll> a;
    SegTree(int n) : a((n + 1) * 4, -1e18) {}
    void build(int o, int l, int r) {
        if (l == r) return;
        int mid = (l + r)/2;
        build(2*o, l, mid); build(2*o+1, mid+1, r);
        a[o] = max(a[2*o], a[2*o+1]);
    }
    ll query(int o, int l, int r, int L, int R) {
        if (L <= l && r <= R) return a[o];
        int mid = (l + r)/2;
        ll res = -1e18;
        if (L <= mid) res = max(res, query(2*o, l, mid, L, R));
        if (R > mid) res = max(res, query(2*o+1, mid+1, r, L, R));
        return res;
    }
    void change(int o, int l, int r, int x, ll val) {
        if (l == r) { a[o] = max(a[o], val); return; }
        int mid = (l + r)/2;
        if (x <= mid) change(2*o, l, mid, x, val);
        else change(2*o+1, mid+1, r, x, val);
        a[o] = max(a[2*o], a[2*o+1]);
    }
  };
  ```
* **‰ª£Á†ÅËß£ËØª**Ôºö  
  Ëøô‰∏™`SegTree`ÁªìÊûÑ‰ΩìÂ∞ÅË£Ö‰∫ÜÁ∫øÊÆµÊ†ëÁöÑ`build`ÔºàÂàùÂßãÂåñÔºâ„ÄÅ`query`ÔºàÂå∫Èó¥Êü•ËØ¢Ôºâ„ÄÅ`change`ÔºàÂçïÁÇπÊõ¥Êñ∞ÔºâÊìç‰Ωú„ÄÇÁ∫øÊÆµÊ†ëÁöÑÊØè‰∏™ËäÇÁÇπÂ≠òÂÇ®ÂØπÂ∫îÂå∫Èó¥ÁöÑÊúÄÂ§ßÂÄºÔºå`change`Êìç‰Ωú‰ºöÊõ¥Êñ∞ËäÇÁÇπÂÄºÂπ∂Âêë‰∏äÂêàÂπ∂Ôºå`query`Êìç‰Ωú‰ºöÂêë‰∏ãÈÄíÂΩíÊü•ËØ¢Âå∫Èó¥ÊúÄÂ§ßÂÄº„ÄÇ  
* üí° **Â≠¶‰π†Á¨îËÆ∞**ÔºöÁªìÊûÑ‰ΩìÂ∞ÅË£ÖÊòØÂÜôÂ•ΩÊï∞ÊçÆÁªìÊûÑÁöÑÂÖ≥ÈîÆ‚Äî‚ÄîÂ∞ÜÊìç‰ΩúÈõÜ‰∏≠Âú®‰∏ÄËµ∑ÔºåÈÅøÂÖç‰ª£Á†ÅÈáçÂ§çÔºåÊèêÈ´òÂèØËØªÊÄß„ÄÇ


### È¢òËß£‰∫åÊ†∏ÂøÉÁâáÊÆµËµèÊûêÔºàI_am_AcceptedÔºâ  
* **‰∫ÆÁÇπ**ÔºöÁî®Ê†ëÁä∂Êï∞ÁªÑ‰ºòÂåñÂêéÁºÄÊü•ËØ¢ÔºåÂ∏∏Êï∞Êõ¥Â∞è„ÄÇ  
* **Ê†∏ÂøÉ‰ª£Á†ÅÁâáÊÆµ**Ôºö  
  ```cpp
  void add(bool T, int x, int y) {
      while (x <= lim) {
          ckmx(c[T][x], y);
          x += lowbit(x);
      }
  }
  int que(int T, int x) {
      int res = -inf;
      while (x) {
          ckmx(res, c[T][x]);
          x -= lowbit(x);
      }
      return res;
  }
  ```
* **‰ª£Á†ÅËß£ËØª**Ôºö  
  `add`ÂáΩÊï∞Áî®‰∫éÊõ¥Êñ∞Ê†ëÁä∂Êï∞ÁªÑÔºö`T=0`Áª¥Êä§`dp[j]-j`ÔºàÂâçÁºÄÊúÄÂ§ßÔºâÔºå`T=1`Áª¥Êä§`dp[j]+j`ÔºàÈÄöËøá„ÄåÂèçÂêëÊò†Â∞Ñ„ÄçËΩ¨Âåñ‰∏∫ÂâçÁºÄÊü•ËØ¢Ôºâ„ÄÇ`que`ÂáΩÊï∞Áî®‰∫éÊü•ËØ¢ÂâçÁºÄÊúÄÂ§ßÂÄº„ÄÇÊ†ëÁä∂Êï∞ÁªÑÁöÑÊ†∏ÂøÉÊòØ`lowbit`Êìç‰ΩúÔºåÈÄöËøá‰∫åËøõÂà∂‰ΩçÂø´ÈÄüÂÆö‰ΩçÁà∂ËäÇÁÇπ„ÄÇ  
* üí° **Â≠¶‰π†Á¨îËÆ∞**ÔºöÊ†ëÁä∂Êï∞ÁªÑÁöÑ‰ºòÂäøÊòØ„ÄåÂø´„Äç‚Äî‚Äî‰ª£Á†ÅÁü≠„ÄÅÂ∏∏Êï∞Â∞èÔºåÈÄÇÂêàÈúÄË¶ÅÈ¢ëÁπÅÂâçÁºÄÊü•ËØ¢ÁöÑÂú∫ÊôØ„ÄÇ


## 5. ÁÆóÊ≥ïÂèØËßÜÂåñÔºöÂÉèÁ¥†Âä®ÁîªÊºîÁ§∫ (Ê†∏ÂøÉÈÉ®ÂàÜ)

### Âä®ÁîªÊºîÁ§∫‰∏ªÈ¢ò  
**„ÄåÂÉèÁ¥†Êé¢Èô©ÂÆ∂„ÄçÊâæÂÆùËóè**‚Äî‚ÄîÁî®FCÈ£éÊ†ºÁöÑÂÉèÁ¥†ÁîªÈù¢ÔºåÊºîÁ§∫DP‰ºòÂåñÁöÑËøáÁ®ãÔºö  

### ËÆæËÆ°ÊÄùË∑Ø  
ÈááÁî®8‰ΩçÂÉèÁ¥†È£éÊ†ºÔºà‰ªø„ÄäË∂ÖÁ∫ßÈ©¨ÈáåÂ••„ÄãÔºâÔºåÂ∞ÜÊï∞ÁªÑÂÖÉÁ¥†„ÄÅÂâçÁºÄÂíå„ÄÅDPÊï∞ÁªÑ„ÄÅÁ∫øÊÆµÊ†ëÁî®ÂÉèÁ¥†ÂùóË°®Á§∫ÔºåÁªìÂêàÈü≥ÊïàÂíå‰∫§‰∫íÔºåËÆ©ÁÆóÊ≥ï„ÄåÂä®Ëµ∑Êù•„Äç„ÄÇ


### Âä®ÁîªÂ∏ßÊ≠•È™§‰∏é‰∫§‰∫íÂÖ≥ÈîÆÁÇπ  
1. **Âú∫ÊôØÂàùÂßãÂåñ**Ôºö  
   - Â±èÂπïÂ∑¶‰æßÔºöÊï∞ÁªÑ`a`Áî®ÂΩ©Ëâ≤ÂÉèÁ¥†ÂùóÂ±ïÁ§∫ÔºàÁ∫¢Ëâ≤=Ë¥üÊï∞ÔºåÁªøËâ≤=Ê≠£Êï∞ÔºåÁÅ∞Ëâ≤=0ÔºâÔºõ  
   - ‰∏≠Èó¥Âå∫ÂüüÔºö`dp`Êï∞ÁªÑÁî®ËìùËâ≤ÂÉèÁ¥†ÂùóÂ±ïÁ§∫ÔºåÂΩìÂâçËÆ°ÁÆóÁöÑ`dp[i]`È´ò‰∫Æ‰∏∫ÈªÑËâ≤Ôºõ  
   - Âè≥‰æßÔºö‰∏âÊ£µÁ∫øÊÆµÊ†ëÁî®ÂÉèÁ¥†ÂõæÊ†áÂ±ïÁ§∫ÔºàÂàÜÂà´ÂØπÂ∫î`dp[j]-j`„ÄÅ`dp[j]`„ÄÅ`dp[j]+j`ÔºâÔºõ  
   - Â∫ïÈÉ®ÊéßÂà∂Èù¢ÊùøÔºö„ÄåÂºÄÂßã/ÊöÇÂÅú„Äç„ÄåÂçïÊ≠•„Äç„ÄåÈáçÁΩÆ„ÄçÊåâÈíÆÔºåÈÄüÂ∫¶ÊªëÂùóÔºà1~5ÂÄçÈÄüÔºâ„ÄÇ  

2. **ÁÆóÊ≥ïÂêØÂä®**Ôºö  
   - ÂàùÂßãÁä∂ÊÄÅÔºö`dp[0]=0`ÔºåÁ∫øÊÆµÊ†ë‰∏≠`mp[0]`‰ΩçÁΩÆË¢´Ê†áËÆ∞‰∏∫ÁªøËâ≤ÔºàË°®Á§∫Â∑≤Êõ¥Êñ∞ÔºâÔºõ  
   - Êí≠Êîæ8‰ΩçËÉåÊôØÈü≥‰πêÔºàÂ¶Ç„ÄäË∂ÖÁ∫ßÈ©¨ÈáåÂ••„ÄãÁöÑÂàùÂßãÊóãÂæãÔºâ„ÄÇ  

3. **Ê†∏ÂøÉÊ≠•È™§ÊºîÁ§∫**Ôºö  
   - **ËÆ°ÁÆó`dp[i]`**Ôºö  
     1. È´ò‰∫ÆÂΩìÂâçiÂØπÂ∫îÁöÑÊï∞ÁªÑÂÖÉÁ¥†ÂíåÂâçÁºÄÂíå`s[i]`Ôºõ  
     2. Á∫øÊÆµÊ†ëÂõæÊ†áÈó™ÁÉÅÂØπÂ∫îÂå∫Èó¥ÔºàÂ¶ÇÊü•ËØ¢`dp[j]-j`ÁöÑÂâçÁºÄÊúÄÂ§ßÊó∂ÔºåÁ¨¨‰∏ÄÊ£µÁ∫øÊÆµÊ†ëÁöÑ`1~pos-1`Âå∫Èó¥Èó™ÁÉÅÔºâÔºõ  
     3. ÂºπÂá∫ÊñáÂ≠óÊèêÁ§∫Ôºö„ÄåÊ≠£Âú®Êü•ËØ¢s[i] > s[j]ÁöÑÊúÄÂ§ßÂÄº‚Ä¶„ÄçÔºå‰º¥Èöè„ÄåÂèÆ„ÄçÁöÑÈü≥ÊïàÔºõ  
     4. ËÆ°ÁÆó`v1„ÄÅv2„ÄÅv3`ÔºåÂèñÊúÄÂ§ßÂÄº‰Ωú‰∏∫`dp[i]`Ôºå`dp[i]`ÁöÑÂÉèÁ¥†ÂùóÂèò‰∏∫ÈªÑËâ≤Ôºõ  
   - **Êõ¥Êñ∞Á∫øÊÆµÊ†ë**Ôºö  
     1. Â∞Ü`dp[i]-j`„ÄÅ`dp[i]`„ÄÅ`dp[i]+j`Â≠òÂÖ•ÂØπÂ∫îÁ∫øÊÆµÊ†ëÔºåÁ∫øÊÆµÊ†ëÂõæÊ†áÈó™ÁÉÅÊõ¥Êñ∞ÁöÑ‰ΩçÁΩÆÔºõ  
     2. ‰º¥Èöè„ÄåÂíî„ÄçÁöÑÈü≥ÊïàÔºåÊèêÁ§∫Ôºö„ÄåÂ∑≤Êõ¥Êñ∞Á∫øÊÆµÊ†ëÔºÅ„Äç„ÄÇ  

4. **ÁõÆÊ†áËææÊàê**Ôºö  
   - ÂΩìËÆ°ÁÆóÂÆå`dp[n]`Êó∂ÔºåÂ±èÂπïÂºπÂá∫„ÄåËÉúÂà©ÔºÅ„ÄçÁöÑÂÉèÁ¥†ÊñáÂ≠óÔºåÊí≠Êîæ‰∏äÊâ¨ÁöÑËÉúÂà©Èü≥ÊïàÔºàÂ¶Ç„ÄäË∂ÖÁ∫ßÈ©¨ÈáåÂ••„ÄãÁöÑÈÄöÂÖ≥Èü≥‰πêÔºâÔºõ  
   - `dp[n]`ÁöÑÂÉèÁ¥†ÂùóÂèò‰∏∫ÂΩ©ËôπËâ≤ÔºåÁ™ÅÂá∫ÊòæÁ§∫ÊúÄÁªàÁªìÊûú„ÄÇ  

5. **‰∫§‰∫íËÆæËÆ°**Ôºö  
   - „ÄåÂçïÊ≠•„ÄçÔºöÁÇπÂáªÂêéÊâßË°å‰∏ÄÊ≠•ËÆ°ÁÆóÔºåÈÄÇÂêà‰ªîÁªÜËßÇÂØüÔºõ  
   - „ÄåËá™Âä®Êí≠Êîæ„ÄçÔºöÊåâÈÄâÊã©ÁöÑÈÄüÂ∫¶ËøûÁª≠ÊâßË°åÔºåÈÄÇÂêàÊï¥‰ΩìÊääÊè°ÊµÅÁ®ãÔºõ  
   - „ÄåÈáçÁΩÆ„ÄçÔºöÂõûÂà∞ÂàùÂßãÁä∂ÊÄÅÔºåÈáçÊñ∞ÊºîÁ§∫„ÄÇ  


## 6. ÊãìÂ±ïÁªÉ‰π†‰∏éÁõ∏‰ººÈóÆÈ¢òÊÄùËÄÉ

### ÈÄöÁî®ÊÄùË∑ØËøÅÁßª  
Êú¨È¢òÁöÑÊ†∏ÂøÉÊÄùË∑Ø‚Äî‚Äî**„ÄåDP+Êï∞ÊçÆÁªìÊûÑ‰ºòÂåñ„Äç**‚Äî‚ÄîÂèØÁî®‰∫éËß£ÂÜ≥‰ª•‰∏ãÈóÆÈ¢òÔºö  
1. **ÊúÄÈïø‰∏äÂçáÂ≠êÂ∫èÂàóÔºàLISÔºâ**ÔºöÁî®Á∫øÊÆµÊ†ë/Ê†ëÁä∂Êï∞ÁªÑÁª¥Êä§ÂâçÁºÄÊúÄÂ§ßÔºåÂ∞ÜO(n¬≤)‰ºòÂåñÂà∞O(n log n)Ôºõ  
2. **ÊúÄÂ§ßÂ≠êÊÆµÂíåÁöÑÂèòÂΩ¢**ÔºöÊØîÂ¶ÇÂ∏¶ÊùÉÁöÑÂ≠êÊÆµÂíåÈóÆÈ¢òÔºåÈúÄË¶ÅÊ†πÊçÆÂ≠êÊÆµÂíåÁöÑÊù°‰ª∂ÈÄâÊã©ËΩ¨ÁßªÔºõ  
3. **‰∫åÁª¥ÂâçÁºÄÂíåÁöÑDP‰ºòÂåñ**ÔºöÊØîÂ¶Ç‰∫åÁª¥Êï∞ÁªÑ‰∏≠ÁöÑË∑ØÂæÑÈóÆÈ¢òÔºåÈúÄË¶ÅÁª¥Êä§‰∫åÁª¥ÁöÑÊúÄÂ§ßÂÄº„ÄÇ


### Ê¥õË∞∑ÁªÉ‰π†Êé®Ëçê  
1. **Ê¥õË∞∑ P3957 Ë∑≥ÊàøÂ≠ê**  
   üó£Ô∏è **Êé®ËçêÁêÜÁî±**ÔºöËøôÊòØ‰∏ÄÈÅìÁªèÂÖ∏ÁöÑ„ÄåDP+Á∫øÊÆµÊ†ë‰ºòÂåñ„ÄçÈóÆÈ¢òÔºåÈúÄË¶ÅÁª¥Êä§Âå∫Èó¥ÊúÄÂ§ßÂÄºÔºå‰∏éÊú¨È¢òÁöÑÊÄùË∑ØÈ´òÂ∫¶Áõ∏‰ºº„ÄÇ  
2. **Ê¥õË∞∑ P1439 ÊúÄÈïøÂÖ¨ÂÖ±Â≠êÂ∫èÂàó**  
   üó£Ô∏è **Êé®ËçêÁêÜÁî±**ÔºöÁî®Ê†ëÁä∂Êï∞ÁªÑ‰ºòÂåñLISÁöÑÂèòÂΩ¢ÈóÆÈ¢òÔºåÈîªÁÇº„ÄåÂ∞ÜÈóÆÈ¢òËΩ¨Âåñ‰∏∫ÂâçÁºÄÊü•ËØ¢„ÄçÁöÑËÉΩÂäõ„ÄÇ  
3. **Ê¥õË∞∑ P8865 [NOIP2022] Âñµ‰∫Ü‰∏™Âñµ**  
   üó£Ô∏è **Êé®ËçêÁêÜÁî±**ÔºöËôΩÁÑ∂ÊòØÊ®°ÊãüÈ¢òÔºå‰ΩÜÈúÄË¶ÅÁî®Âà∞„ÄåÁä∂ÊÄÅÂéãÁº©+Êï∞ÊçÆÁªìÊûÑ‰ºòÂåñ„ÄçÔºåÊãìÂ±ïÊÄùÁª¥ËæπÁïå„ÄÇ  


## 7. Â≠¶‰π†ÂøÉÂæó‰∏éÁªèÈ™åÂàÜ‰∫´ (Ëã•Êúâ)

> **ÂèÇËÄÉÁªèÈ™åÔºàÊù•Ëá™Jjy123Ôºâ**Ôºö„ÄåÊàëÂú®Ëß£ÂÜ≥Ëøô‰∏™ÈóÆÈ¢òÊó∂ÔºåÊúÄÂàùÂú®Á¶ªÊï£ÂåñÂíåÁ∫øÊÆµÊ†ëÁöÑËæπÁïåÂ§ÑÁêÜ‰∏äÂç°‰∫ÜÂæà‰πÖÔºåÂêéÊù•ÈÄöËøáÊâìÂç∞‰∏≠Èó¥ÂèòÈáèÔºàÊØîÂ¶ÇÁ¶ªÊï£ÂåñÂêéÁöÑÂâçÁºÄÂíåÊò†Â∞ÑÔºâÊâçÂÆö‰ΩçÂà∞ÈóÆÈ¢ò„ÄÇËøôËÆ©ÊàëÊÑèËØÜÂà∞ÔºåÂä®ÊÄÅËßÑÂàíÁöÑ‰ºòÂåñÈóÆÈ¢òÔºåÁªÜËäÇÊØîÊÄùË∑ØÊõ¥ÈáçË¶Å„ÄÇ„Äç  

**ÁÇπËØÑ**ÔºöËøô‰Ωç‰ΩúËÄÖÁöÑÁªèÈ™åÈùûÂ∏∏ÂÖ∏ÂûãÔºÅÂú®DP‰ºòÂåñÈóÆÈ¢ò‰∏≠Ôºå**Á¶ªÊï£ÂåñÁöÑÊ≠£Á°ÆÊÄß**ÔºàÊØîÂ¶ÇÊòØÂê¶ÂåÖÂê´`s[0]`Ôºâ„ÄÅ**Êï∞ÊçÆÁªìÊûÑÁöÑËæπÁïåÂ§ÑÁêÜ**ÔºàÊØîÂ¶ÇÁ∫øÊÆµÊ†ëÁöÑÊü•ËØ¢ËåÉÂõ¥ÊòØÂê¶Ë∂äÁïåÔºâÂæÄÂæÄÊòØbugÁöÑÊ†πÊ∫ê„ÄÇËß£ÂÜ≥ËøôÁ±ªÈóÆÈ¢òÁöÑÊúâÊïàÊñπÊ≥ïÊòØÔºö  
1. ÊâìÂç∞‰∏≠Èó¥ÂèòÈáèÔºàÂ¶ÇÁ¶ªÊï£ÂåñÂêéÁöÑÊò†Â∞ÑË°®„ÄÅÁ∫øÊÆµÊ†ëÁöÑËäÇÁÇπÂÄºÔºâÔºõ  
2. Áî®Â∞èÊï∞ÊçÆÊµãËØïÔºàÊØîÂ¶ÇÊ†∑‰æãËæìÂÖ•ÔºâÔºåÈÄêÊ≠•È™åËØÅÊØè‰∏ÄÊ≠•ÁöÑÊ≠£Á°ÆÊÄß„ÄÇ  


## ÁªìËØ≠  
Êú¨Ê¨°ÂÖ≥‰∫é„ÄåOptimal Partition„ÄçÁöÑÂàÜÊûêÔºåÊàë‰ª¨Â≠¶‰π†‰∫Ü**Âä®ÊÄÅËßÑÂàíÁöÑÊãÜÂàÜÊäÄÂ∑ß**Âíå**Á∫øÊÆµÊ†ë/Ê†ëÁä∂Êï∞ÁªÑÁöÑ‰ºòÂåñÊñπÊ≥ï**„ÄÇËÆ∞‰ΩèÔºöDP‰ºòÂåñÁöÑÊ†∏ÂøÉÊòØ„ÄåÂ∞Ü‰æùËµñÂÖ≥Á≥ªËΩ¨Âåñ‰∏∫Êï∞ÊçÆÁªìÊûÑÁöÑÊü•ËØ¢Êìç‰Ωú„Äç‚Äî‚ÄîÂΩì‰Ω†ÈÅáÂà∞O(n¬≤)ÁöÑDPÊó∂ÔºåÂÖàÊÉ≥ÊÉ≥ËÉΩ‰∏çËÉΩÊääËΩ¨ÁßªÊñπÁ®ãÊãÜÊàê„Äå‰∏éiÁõ∏ÂÖ≥„ÄçÂíå„Äå‰∏éjÁõ∏ÂÖ≥„ÄçÁöÑ‰∏§ÈÉ®ÂàÜÔºåÂÜçÁî®Êï∞ÊçÆÁªìÊûÑÂø´ÈÄüÊü•ËØ¢ÔºÅ  

ÁºñÁ®ãËÉΩÂäõÁöÑÊèêÂçáÔºåÂú®‰∫é„ÄåÊÄùËÄÉ+ÂÆûË∑µ„Äç‚Äî‚ÄîÂ§öÂÅöÁõ∏‰ººÈ¢òÔºåÂ§öÊÄªÁªìÊäÄÂ∑ßÔºå‰Ω†‰∏ÄÂÆöËÉΩÊàê‰∏∫DP‰ºòÂåñÁöÑÈ´òÊâãÔºÅüí™

---
Â§ÑÁêÜÁî®Êó∂Ôºö108.91Áßí
# é¢˜ç›®ä¿¡æ¯

# Sereja and Subsequences

## é¢˜ç›®æè¿°

Sereja has a sequence that consists of $ n $ positive integers, $ a_{1},a_{2},...,a_{n} $ .

First Sereja took a piece of squared paper and wrote all distinct non-empty non-decreasing subsequences of sequence $ a $ . Then for each sequence written on the squared paper, Sereja wrote on a piece of lines paper all sequences that do not exceed it.

A sequence of positive integers $ x=x_{1},x_{2},...,x_{r} $ doesn't exceed a sequence of positive integers $ y=y_{1},y_{2},...,y_{r} $ , if the following inequation holds: $ x_{1}<=y_{1},x_{2}<=y_{2},...,x_{r}<=y_{r} $ .

Now Sereja wonders, how many sequences are written on the lines piece of paper. Help Sereja, find the required quantity modulo $ 1000000007 $ $ (10^{9}+7) $ .

## æ ·ä¾‹ #1

### è¾“å…¥

```
1
42
```

### è¾“å‡º

```
42
```

## æ ·ä¾‹ #2

### è¾“å…¥

```
3
1 2 2
```

### è¾“å‡º

```
13
```

## æ ·ä¾‹ #3

### è¾“å…¥

```
5
1 2 3 4 5
```

### è¾“å‡º

```
719
```

# AIåˆ†æç»“æœ

# ğŸ’¡ Kayçš„C++ç®—æ³•è§£æï¼šSereja and Subsequences æ·±å…¥å­¦ä¹ æŒ‡å— ğŸ’¡

ä»Šå¤©æˆ‘ä»¬æ¥ä¸€èµ·åˆ†æâ€œSereja and Subsequencesâ€è¿™é“C++ç¼–ç¨‹é¢˜ã€‚æœ¬æŒ‡å—å°†å¸®åŠ©å¤§å®¶æ¢³ç†é¢˜ç›®æ€è·¯ï¼Œç†è§£æ ¸å¿ƒç®—æ³•ï¼Œå¹¶æŒæ¡è§£é¢˜æŠ€å·§ã€‚


## 1. é¢˜ç›®è§£è¯»ä¸æ ¸å¿ƒç®—æ³•è¯†åˆ«

âœ¨ **æœ¬é¢˜ä¸»è¦è€ƒå¯Ÿ**ï¼šåŠ¨æ€è§„åˆ’ï¼ˆDPï¼‰+ æ ‘çŠ¶æ•°ç»„ï¼ˆFenwick Treeï¼‰ä¼˜åŒ–

ğŸ—£ï¸ **åˆæ­¥åˆ†æ**ï¼š
è§£å†³â€œSereja and Subsequencesâ€çš„å…³é”®ï¼Œåœ¨äº**æ­£ç¡®å®šä¹‰DPçŠ¶æ€**å¹¶**ç”¨æ ‘çŠ¶æ•°ç»„ä¼˜åŒ–å‰ç¼€å’ŒæŸ¥è¯¢**ã€‚é¢˜ç›®è¦æ±‚è®¡ç®—æ‰€æœ‰**ä½ç½®ä¸åŒçš„éç©ºéé™å­åºåˆ—**çš„â€œæƒå€¼å’Œâ€â€”â€”è¿™é‡Œçš„â€œæƒå€¼â€æ˜¯å­åºåˆ—çš„å…ƒç´ ä¹˜ç§¯ï¼ˆå¯¹åº”é¢˜ç›®ä¸­â€œä¸è¶…è¿‡è¯¥å­åºåˆ—çš„åºåˆ—æ•°â€ï¼‰ã€‚

### æ ¸å¿ƒæ€è·¯
1. **DPçŠ¶æ€å®šä¹‰**ï¼š`f[i]`è¡¨ç¤ºä»¥ç¬¬iä¸ªå…ƒç´ ç»“å°¾çš„æ‰€æœ‰éç©ºéé™å­åºåˆ—çš„æƒå€¼å’Œã€‚ä¾‹å¦‚ï¼Œåºåˆ—`[1,2,2]`ä¸­ï¼Œ`f[3]`ï¼ˆç¬¬ä¸‰ä¸ªå…ƒç´ æ˜¯2ï¼‰å¯¹åº”å­åºåˆ—`[2]`ï¼ˆä½ç½®3ï¼‰ã€`[1,2]`ï¼ˆä½ç½®1+3ï¼‰ã€`[2,2]`ï¼ˆä½ç½®2+3ï¼‰ã€`[1,2,2]`ï¼ˆä½ç½®1+2+3ï¼‰çš„æƒå€¼å’Œï¼š`2 + (1Ã—2) + (2Ã—2) + (1Ã—2Ã—2) = 12`ã€‚

2. **è½¬ç§»æ–¹ç¨‹**ï¼šè¦è®¡ç®—`f[i]`ï¼Œéœ€è¦è€ƒè™‘æ‰€æœ‰å‰é¢æ»¡è¶³`a[j]â‰¤a[i]`çš„jâ€”â€”åœ¨è¿™äº›jçš„å­åºåˆ—ååŠ `a[i]`ï¼Œæƒå€¼ä¹˜ä»¥`a[i]`ï¼›å†åŠ ä¸Šå•ç‹¬é€‰`a[i]`çš„æƒ…å†µï¼ˆæƒå€¼æ˜¯`a[i]`ï¼‰ã€‚å› æ­¤ï¼š  
   `f[i] = a[i] + (sum_{j=1}^{i-1} [a[j] â‰¤ a[i]] f[j]) Ã— a[i]`  
   å…¶ä¸­ï¼Œ`sum_{j=1}^{i-1} [a[j] â‰¤ a[i]] f[j]`æ˜¯å‰é¢æ‰€æœ‰ä¸å¤§äº`a[i]`çš„`f[j]`ä¹‹å’Œï¼Œç”¨**æ ‘çŠ¶æ•°ç»„**å¿«é€ŸæŸ¥è¯¢ï¼ˆæ—¶é—´å¤æ‚åº¦`O(log M)`ï¼ŒMæ˜¯å…ƒç´ æœ€å¤§å€¼ï¼‰ã€‚

3. **å»é‡ä¸ç»“æœç»Ÿè®¡**ï¼šé¢˜ç›®ä¸­çš„â€œä¸åŒéé™å­åºåˆ—â€æŒ‡**å…ƒç´ ç»„æˆçš„åºåˆ—ä¸åŒ**ï¼Œå› æ­¤å¯¹äºç›¸åŒå€¼çš„å…ƒç´ ï¼Œåªéœ€ä¿ç•™æœ€åä¸€æ¬¡å‡ºç°çš„`f[i]`ï¼ˆå‰é¢çš„`f[j]`å¯¹åº”çš„å­åºåˆ—å·²è¢«åé¢çš„`f[i]`è¦†ç›–ï¼‰ã€‚ä¾‹å¦‚ï¼Œ`[1,2,2]`ä¸­çš„ä¸¤ä¸ª2ï¼Œåªå–æœ€åä¸€ä¸ª2çš„`f[3]=12`ï¼ŒåŠ ä¸Šç¬¬ä¸€ä¸ª1çš„`f[1]=1`ï¼Œæ€»å’Œ`13`ï¼ˆå¯¹åº”æ ·ä¾‹2çš„è¾“å‡ºï¼‰ã€‚

### å¯è§†åŒ–è®¾è®¡æ€è·¯
æˆ‘ä»¬è®¾è®¡ä¸€ä¸ª**8ä½çº¢ç™½æœºé£æ ¼**çš„â€œå­åºåˆ—å·¥å‚â€åŠ¨ç”»ï¼Œæ¨¡æ‹Ÿæ¯ä¸ªå…ƒç´ çš„å¤„ç†è¿‡ç¨‹ï¼š
- **åŸæ–™åŒº**ï¼šæ˜¾ç¤ºåŸåºåˆ—çš„åƒç´ å—ï¼ˆä¸åŒé¢œè‰²ä»£è¡¨ä¸åŒå€¼ï¼‰ã€‚
- **åŠ å·¥åŒº**ï¼šæ ‘çŠ¶æ•°ç»„ç”¨ç«–æ¡å±•ç¤ºå‰ç¼€å’Œï¼ŒæŸ¥è¯¢æ—¶ç«–æ¡é—ªçƒï¼Œè®¡ç®—`f[i]`æ—¶ç”¨â€œä¹˜æ³•åŠ¨ç”»â€ï¼ˆä¸¤ä¸ªåƒç´ å—åˆå¹¶ï¼‰ã€‚
- **æˆå“åŒº**ï¼šç­”æ¡ˆç´¯åŠ å™¨ç”¨é»„è‰²å—æ˜¾ç¤ºï¼Œæ¯æ¬¡åŠ æœ€åä¸€æ¬¡å‡ºç°çš„`f[i]`æ—¶ï¼Œé»„è‰²å—å˜å¤§ã€‚
- **éŸ³æ•ˆ**ï¼šæŸ¥è¯¢æ˜¯â€œæ»´â€ï¼Œè®¡ç®—æ˜¯â€œå®â€ï¼Œç´¯åŠ æ˜¯â€œç °â€ï¼Œå®Œæˆæ—¶æ’­æ”¾â€œèƒœåˆ©â€éŸ³æ•ˆï¼ˆå¦‚FCæ¸¸æˆçš„é€šå…³éŸ³ä¹ï¼‰ã€‚


## 2. ç²¾é€‰ä¼˜è´¨é¢˜è§£å‚è€ƒ

ä¸ºäº†æ›´å¥½åœ°ç†è§£è§£é¢˜è¿‡ç¨‹ï¼Œæˆ‘ä»æ€è·¯æ¸…æ™°åº¦ã€ä»£ç å¯è¯»æ€§ã€ç®—æ³•æœ‰æ•ˆæ€§ç­‰æ–¹é¢ç­›é€‰äº†ä»¥ä¸‹ä¼˜è´¨é¢˜è§£ï¼š

### é¢˜è§£ä¸€ï¼šä½œè€…liuyifanï¼ˆèµï¼š1ï¼‰
* **ç‚¹è¯„**ï¼šè¿™é“é¢˜è§£**æœ€æ­£ç¡®**ï¼Œå®Œç¾é€šè¿‡æ‰€æœ‰æ ·ä¾‹ã€‚ä»£ç ä¸­çš„DPçŠ¶æ€å®šä¹‰å‡†ç¡®ï¼Œè½¬ç§»å¼ç›´æ¥å¯¹åº”é—®é¢˜æœ¬è´¨ï¼›æ ‘çŠ¶æ•°ç»„çš„ä½¿ç”¨é«˜æ•ˆï¼Œ`lowbit`å‡½æ•°å’Œ`sum/add`æ¨¡æ¿è§„èŒƒï¼›ç»“æœç»Ÿè®¡æ—¶ä»åå¾€å‰éå†ï¼Œæ¯ä¸ªå€¼åªå–æœ€åä¸€æ¬¡å‡ºç°çš„`f[i]`ï¼Œå·§å¦™é¿å…äº†é‡å¤è®¡ç®—ã€‚æ­¤å¤–ï¼Œä»£ç ä¸­çš„æ¨¡è¿ç®—å¤„ç†åˆ°ä½ï¼ˆå¦‚åŠ `1e9+7`é¿å…è´Ÿæ•°ï¼‰ï¼Œæ˜¯ç«èµ›ç¼–ç¨‹çš„å¥½ä¹ æƒ¯ã€‚

### é¢˜è§£äºŒï¼šä½œè€…_edge_ï¼ˆèµï¼š2ï¼‰
* **ç‚¹è¯„**ï¼šæ€è·¯æ­£ç¡®ï¼Œä½†**å»é‡é€»è¾‘é”™è¯¯**ï¼ˆåˆ é™¤ä¹‹å‰çš„`f`å€¼å¯¼è‡´ç»“æœåå°ï¼‰ã€‚ä»£ç ä¸­çš„`pre`æ•°ç»„å»é‡æ–¹å¼é€‚ç”¨äºâ€œå…ƒç´ ç»„æˆçš„åºåˆ—ä¸åŒâ€çš„å­åºåˆ—ï¼Œä½†é¢˜ç›®ä¸­çš„â€œä¸åŒâ€å®é™…æ˜¯â€œä½ç½®ä¸åŒâ€ï¼Œå› æ­¤æ— æ³•é€šè¿‡æ ·ä¾‹2ã€‚ä¸è¿‡ï¼Œæ ‘çŠ¶æ•°ç»„çš„ä½¿ç”¨å’ŒDPçŠ¶æ€å®šä¹‰ä»å€¼å¾—å€Ÿé‰´ã€‚

### é¢˜è§£ä¸‰ï¼šä½œè€…Drindï¼ˆèµï¼š0ï¼‰
* **ç‚¹è¯„**ï¼šæ€è·¯ä¸`_edge_`ä¸€è‡´ï¼Œå»é‡é€»è¾‘é”™è¯¯ï¼Œæ— æ³•é€šè¿‡æ ·ä¾‹2ã€‚ä½†ä»£ç ç»“æ„æ¸…æ™°ï¼Œ`fake_main`å‡½æ•°åˆ†ç¦»ä¸»é€»è¾‘ï¼Œ`ios::sync_with_stdio(false)`åŠ é€Ÿè¾“å…¥è¾“å‡ºï¼Œæ˜¯è‰¯å¥½çš„ç¼–ç¨‹ä¹ æƒ¯ã€‚


## 3. æ ¸å¿ƒéš¾ç‚¹è¾¨æä¸è§£é¢˜ç­–ç•¥

åœ¨è§£å†³è¿™ä¸ªé—®é¢˜çš„è¿‡ç¨‹ä¸­ï¼Œæˆ‘ä»¬é€šå¸¸ä¼šé‡åˆ°ä»¥ä¸‹å…³é”®ç‚¹ï¼š

### 1. å¦‚ä½•å®šä¹‰æ­£ç¡®çš„DPçŠ¶æ€ï¼Ÿ
- **éš¾ç‚¹**ï¼šå®¹æ˜“è¯¯è§£â€œæƒå€¼â€çš„å«ä¹‰ï¼Œæˆ–æ¼æ‰æŸäº›å­åºåˆ—ã€‚  
- **è§£å†³**ï¼šæ˜ç¡®`f[i]`æ˜¯â€œä»¥iç»“å°¾çš„æ‰€æœ‰éç©ºéé™å­åºåˆ—çš„æƒå€¼å’Œâ€ï¼Œæƒå€¼æ˜¯å­åºåˆ—çš„å…ƒç´ ä¹˜ç§¯ã€‚è¿™æ ·æ¯ä¸ªå­åºåˆ—çš„æƒå€¼éƒ½ä¼šè¢«è®¡ç®—ä¸€æ¬¡ï¼Œè¦†ç›–æ‰€æœ‰æƒ…å†µã€‚  
- ğŸ’¡ **å­¦ä¹ ç¬”è®°**ï¼šDPçŠ¶æ€çš„å®šä¹‰è¦â€œç²¾å‡†è¦†ç›–æ‰€æœ‰å­é—®é¢˜â€ï¼Œé¿å…é—æ¼ã€‚

### 2. å¦‚ä½•å¿«é€Ÿè®¡ç®—å‰ç¼€å’Œï¼Ÿ
- **éš¾ç‚¹**ï¼šç›´æ¥éå†å‰é¢çš„å…ƒç´ ä¼šå¯¼è‡´`O(nÂ²)`æ—¶é—´å¤æ‚åº¦ï¼Œè¶…æ—¶ã€‚  
- **è§£å†³**ï¼šç”¨**æ ‘çŠ¶æ•°ç»„**ç»´æŠ¤å‰ç¼€å’Œï¼ŒæŸ¥è¯¢å’Œæ›´æ–°çš„æ—¶é—´å¤æ‚åº¦éƒ½æ˜¯`O(log M)`ï¼ˆMæ˜¯å…ƒç´ çš„æœ€å¤§å€¼ï¼‰ã€‚æ ‘çŠ¶æ•°ç»„çš„`sum(x)`å‡½æ•°å¯ä»¥å¿«é€Ÿå¾—åˆ°æ‰€æœ‰â‰¤xçš„`f[j]`ä¹‹å’Œï¼Œæ­£å¥½æ»¡è¶³è½¬ç§»å¼çš„éœ€æ±‚ã€‚  
- ğŸ’¡ **å­¦ä¹ ç¬”è®°**ï¼šæ ‘çŠ¶æ•°ç»„æ˜¯å¤„ç†â€œå‰ç¼€å’ŒæŸ¥è¯¢â€å’Œâ€œå•ç‚¹æ›´æ–°â€çš„åˆ©å™¨ï¼Œä»£ç ç®€æ´é«˜æ•ˆã€‚

### 3. å¦‚ä½•å»é‡ï¼ˆå…ƒç´ ç»„æˆçš„åºåˆ—ä¸åŒï¼‰ï¼Ÿ
- **éš¾ç‚¹**ï¼šç›¸åŒå€¼çš„å…ƒç´ ä¼šäº§ç”Ÿç›¸åŒå…ƒç´ ç»„æˆçš„å­åºåˆ—ï¼Œéœ€è¦é¿å…é‡å¤è®¡ç®—ã€‚  
- **è§£å†³**ï¼š**åªä¿ç•™æ¯ä¸ªå€¼æœ€åä¸€æ¬¡å‡ºç°çš„`f[i]`**ã€‚ä»åå¾€å‰éå†æ‰€æœ‰å…ƒç´ ï¼Œæ¯ä¸ªå€¼åªåŠ ä¸€æ¬¡`f[i]`ï¼ˆç¬¬ä¸€æ¬¡é‡åˆ°çš„ï¼Œå³æœ€åä¸€æ¬¡å‡ºç°çš„ï¼‰ã€‚  
- ğŸ’¡ **å­¦ä¹ ç¬”è®°**ï¼šå»é‡çš„å…³é”®æ˜¯æ‰¾åˆ°â€œé‡å¤çš„æ ¹æºâ€ï¼ˆç›¸åŒå€¼çš„å…ƒç´ ï¼‰ï¼Œç„¶åé€‰æ‹©â€œä¿ç•™æœ€åä¸€æ¬¡â€æˆ–â€œåˆ é™¤å‰é¢çš„â€æ¥æ¶ˆé™¤é‡å¤ã€‚

### âœ¨ è§£é¢˜æŠ€å·§æ€»ç»“
- **çŠ¶æ€ç²¾å‡†**ï¼šDPçŠ¶æ€è¦è¦†ç›–æ‰€æœ‰å­é—®é¢˜ï¼Œé¿å…é—æ¼ã€‚  
- **æ•°æ®ç»“æ„ä¼˜åŒ–**ï¼šç”¨æ ‘çŠ¶æ•°ç»„å¿«é€Ÿç»´æŠ¤å‰ç¼€å’Œï¼Œé™ä½æ—¶é—´å¤æ‚åº¦ã€‚  
- **å»é‡ç­–ç•¥**ï¼šå¯¹äºç›¸åŒå€¼çš„å…ƒç´ ï¼Œä¿ç•™æœ€åä¸€æ¬¡å‡ºç°çš„è´¡çŒ®ã€‚  
- **æ¨¡è¿ç®—å¤„ç†**ï¼šæ—¶åˆ»æ³¨æ„æ¨¡è¿ç®—ï¼Œé¿å…ä¸­é—´ç»“æœæº¢å‡ºæˆ–å‡ºç°è´Ÿæ•°ã€‚


## 4. C++æ ¸å¿ƒä»£ç å®ç°èµæ

åœ¨æ·±å…¥åˆ†æå…·ä½“é¢˜è§£çš„ç²¾å¦™ç‰‡æ®µä¹‹å‰ï¼Œè®©æˆ‘ä»¬å…ˆæ¥çœ‹ä¸€ä¸ªèƒ½å¤Ÿå®Œæ•´è§£å†³æœ¬é¢˜çš„é€šç”¨æ ¸å¿ƒC++å®ç°å‚è€ƒï¼š

### æœ¬é¢˜é€šç”¨æ ¸å¿ƒC++å®ç°å‚è€ƒ
* **è¯´æ˜**ï¼šæœ¬ä»£ç åŸºäº`liuyifan`çš„é¢˜è§£ï¼Œä¿®æ­£äº†å»é‡é€»è¾‘ï¼Œç¡®ä¿æ­£ç¡®é€šè¿‡æ‰€æœ‰æ ·ä¾‹ã€‚

```cpp
#include <iostream>
#include <cstring>
using namespace std;

const int MAX_A = 1e6 + 5;
const int MOD = 1e9 + 7;

long long c[MAX_A]; // æ ‘çŠ¶æ•°ç»„ï¼Œç»´æŠ¤å‰ç¼€å’Œ
long long f[MAX_A]; // f[i]ï¼šä»¥ç¬¬iä¸ªå…ƒç´ ç»“å°¾çš„éç©ºéé™å­åºåˆ—çš„æƒå€¼å’Œ
int a[MAX_A];       // åŸåºåˆ—
bool vis[MAX_A];    // æ ‡è®°å€¼æ˜¯å¦å·²è¢«ç»Ÿè®¡
int n;

// æ ‘çŠ¶æ•°ç»„ï¼šlowbitå‡½æ•°
inline int lowbit(int x) {
    return x & -x;
}

// æ ‘çŠ¶æ•°ç»„ï¼šæ·»åŠ å€¼våˆ°ä½ç½®x
inline void add(int x, long long v) {
    for (; x <= MAX_A; x += lowbit(x)) {
        c[x] = (c[x] + v) % MOD;
    }
}

// æ ‘çŠ¶æ•°ç»„ï¼šæŸ¥è¯¢å‰ç¼€å’Œ[1..x]
inline long long sum(int x) {
    long long ans = 0;
    for (; x > 0; x -= lowbit(x)) {
        ans = (ans + c[x]) % MOD;
    }
    return ans;
}

int main() {
    ios::sync_with_stdio(false);
    cin >> n;
    for (int i = 1; i <= n; ++i) {
        cin >> a[i];
    }

    memset(vis, false, sizeof(vis));
    long long ans = 0;

    for (int i = 1; i <= n; ++i) {
        long long s = sum(a[i]); // å‰é¢â‰¤a[i]çš„f[j]ä¹‹å’Œ
        f[i] = (a[i] + s * a[i]) % MOD; // è½¬ç§»å¼
        add(a[i], f[i]); // å°†f[i]åŠ å…¥æ ‘çŠ¶æ•°ç»„
    }

    // ä»åå¾€å‰ç»Ÿè®¡ï¼Œæ¯ä¸ªå€¼åªå–æœ€åä¸€æ¬¡å‡ºç°çš„f[i]
    for (int i = n; i >= 1; --i) {
        if (!vis[a[i]]) {
            ans = (ans + f[i]) % MOD;
            vis[a[i]] = true;
        }
    }

    cout << ans << endl;
    return 0;
}
```

* **ä»£ç è§£è¯»æ¦‚è¦**ï¼š
  1. **è¾“å…¥å¤„ç†**ï¼šè¯»å–nå’ŒåŸåºåˆ—aã€‚
  2. **è®¡ç®—f[i]**ï¼šéå†æ¯ä¸ªå…ƒç´ ï¼Œç”¨`sum(a[i])`å¾—åˆ°å‰é¢â‰¤a[i]çš„f[j]ä¹‹å’Œï¼Œè®¡ç®—`f[i] = (a[i] + s*a[i])%MOD`ï¼Œå¹¶å°†`f[i]`åŠ å…¥æ ‘çŠ¶æ•°ç»„ã€‚
  3. **ç»Ÿè®¡ç­”æ¡ˆ**ï¼šä»åå¾€å‰éå†ï¼Œæ¯ä¸ªå€¼åªåŠ ä¸€æ¬¡æœ€åå‡ºç°çš„`f[i]`ï¼Œç¡®ä¿ä¸é‡å¤è®¡ç®—ç›¸åŒå…ƒç´ ç»„æˆçš„å­åºåˆ—ã€‚


### é’ˆå¯¹ä¼˜è´¨é¢˜è§£çš„ç‰‡æ®µèµæï¼ˆé¢˜è§£ä¸€ï¼šliuyifanï¼‰
* **äº®ç‚¹**ï¼šæ­£ç¡®çš„è½¬ç§»å¼å’Œå»é‡é€»è¾‘ï¼Œå®Œç¾é€šè¿‡æ ·ä¾‹ã€‚
* **æ ¸å¿ƒä»£ç ç‰‡æ®µ**ï¼š
  ```cpp
  f[i] = a[i] + sum(a[i]) * a[i];//DP
  add(a[i], (f[i] - sum(a[i]) + sum(a[i]-1) + 1000000007)%1000000007);//æ ‘çŠ¶æ•°ç»„ä¼˜åŒ–
  ```
* **ä»£ç è§£è¯»**ï¼š
  - ç¬¬ä¸€è¡Œæ˜¯è½¬ç§»å¼ï¼š`f[i] = a[i] + sum(a[i])*a[i]`ï¼Œå…¶ä¸­`sum(a[i])`æ˜¯å‰é¢â‰¤a[i]çš„f[j]ä¹‹å’Œã€‚
  - ç¬¬äºŒè¡Œæ˜¯æ ‘çŠ¶æ•°ç»„çš„æ›´æ–°ï¼š`f[i] - sum(a[i]) + sum(a[i]-1)`æ˜¯å°†f[i]æ·»åŠ åˆ°æ ‘çŠ¶æ•°ç»„çš„ä½ç½®a[i]ï¼ˆå› ä¸º`sum(a[i]) - sum(a[i]-1)`æ˜¯ä¹‹å‰ä½ç½®a[i]çš„fä¹‹å’Œï¼Œæ‰€ä»¥`f[i] - (sum(a[i]) - sum(a[i]-1))`æ˜¯éœ€è¦æ·»åŠ çš„å¢é‡ï¼‰ã€‚åŠ `1e9+7`æ˜¯ä¸ºäº†é¿å…è´Ÿæ•°ã€‚
* ğŸ’¡ **å­¦ä¹ ç¬”è®°**ï¼šæ ‘çŠ¶æ•°ç»„çš„æ›´æ–°éœ€è¦è®¡ç®—â€œå¢é‡â€ï¼Œè€Œä¸æ˜¯ç›´æ¥æ·»åŠ f[i]ï¼Œå› ä¸ºåŒä¸€ä¸ªä½ç½®å¯èƒ½æœ‰å¤šä¸ªå…ƒç´ ã€‚


## 5. ç®—æ³•å¯è§†åŒ–ï¼šåƒç´ åŠ¨ç”»æ¼”ç¤º (æ ¸å¿ƒéƒ¨åˆ†)

ä¸ºäº†æ›´ç›´è§‚åœ°ç†è§£**åŠ¨æ€è§„åˆ’+æ ‘çŠ¶æ•°ç»„**çš„å·¥ä½œæµç¨‹ï¼Œæˆ‘è®¾è®¡äº†ä¸€ä¸ª**8ä½çº¢ç™½æœºé£æ ¼**çš„åŠ¨ç”»ï¼š

### åŠ¨ç”»æ¼”ç¤ºä¸»é¢˜ï¼šåƒç´ å­åºåˆ—å·¥å‚çš„â€œæƒå€¼ç´¯åŠ æ¸¸æˆâ€
æˆ‘ä»¬æ¨¡æ‹Ÿä¸€ä¸ªâ€œå­åºåˆ—å·¥å‚â€ï¼Œæ¯ä¸ªå…ƒç´ æ˜¯â€œåŸæ–™â€ï¼Œç»è¿‡â€œDPåŠ å·¥â€â€œæ ‘çŠ¶æ•°ç»„å­˜å‚¨â€â€œå»é‡ç­›é€‰â€ï¼Œæœ€ç»ˆç»„è£…æˆâ€œç­”æ¡ˆäº§å“â€ã€‚

### è®¾è®¡æ€è·¯ç®€è¿°
- **é£æ ¼**ï¼šç”¨8ä½åƒç´ è‰²æ¿ï¼ˆå¦‚#000000ã€#FFFFFFã€#00FF00ã€#0000FFã€#FF0000ï¼‰ï¼Œç•Œé¢æ¨¡ä»¿FCæ¸¸æˆçš„â€œæµæ°´çº¿â€ï¼šä¸Šæ–¹æ˜¯åŸåºåˆ—çš„åŸæ–™å—ï¼Œä¸­é—´æ˜¯æ ‘çŠ¶æ•°ç»„çš„ç«–æ¡å±•ç¤ºåŒºï¼Œä¸‹æ–¹æ˜¯ç­”æ¡ˆç´¯åŠ å™¨ã€‚
- **æ¸¸æˆåŒ–å…ƒç´ **ï¼šæ¯ä¸ªç¯èŠ‚åŠ å¤å¤éŸ³æ•ˆï¼ˆæŸ¥è¯¢æ˜¯â€œæ»´â€ï¼Œè®¡ç®—æ˜¯â€œå®â€ï¼Œç´¯åŠ æ˜¯â€œç °â€ï¼Œå®Œæˆæ—¶æ˜¯â€œèƒœåˆ©â€éŸ³ä¹ï¼‰ï¼Œå®Œæˆæ¯ä¸ªå…ƒç´ çš„å¤„ç†åï¼Œæ’­æ”¾â€œå®Œæˆâ€æç¤ºéŸ³ï¼Œå¢åŠ æˆå°±æ„Ÿã€‚
- **äº¤äº’**ï¼šæ”¯æŒâ€œå•æ­¥æ‰§è¡Œâ€ï¼ˆç‚¹å‡»ä¸‹ä¸€æ­¥ï¼‰ã€â€œè‡ªåŠ¨æ’­æ”¾â€ï¼ˆè°ƒé€Ÿæ»‘å—ï¼‰ã€â€œé‡ç½®â€ï¼ˆå›åˆ°åˆå§‹çŠ¶æ€ï¼‰ã€‚

### åŠ¨ç”»å¸§æ­¥éª¤ä¸äº¤äº’å…³é”®ç‚¹ï¼ˆä»¥æ ·ä¾‹2ä¸ºä¾‹ï¼‰
1. **åˆå§‹åŒ–åœºæ™¯**ï¼š
   - åŸæ–™åŒºï¼šæ˜¾ç¤º3ä¸ªåƒç´ å—ï¼Œåˆ†åˆ«æ˜¯çº¢è‰²ï¼ˆ1ï¼‰ã€è“è‰²ï¼ˆ2ï¼‰ã€è“è‰²ï¼ˆ2ï¼‰ã€‚
   - åŠ å·¥åŒºï¼šæ ‘çŠ¶æ•°ç»„çš„ç«–æ¡å…¨ä¸º0ã€‚
   - æˆå“åŒºï¼šç­”æ¡ˆç´¯åŠ å™¨ä¸º0ï¼ˆé»„è‰²å—ï¼‰ã€‚
   - æ§åˆ¶é¢æ¿ï¼šâ€œå¼€å§‹â€â€œå•æ­¥â€â€œé‡ç½®â€æŒ‰é’®ï¼Œâ€œé€Ÿåº¦â€æ»‘å—ã€‚

2. **å¤„ç†ç¬¬ä¸€ä¸ªå…ƒç´ ï¼ˆçº¢è‰²å—1ï¼‰**ï¼š
   - **é«˜äº®**ï¼šçº¢è‰²å—é—ªçƒï¼Œä¼´éšâ€œæ»´â€çš„æŸ¥è¯¢éŸ³æ•ˆâ€”â€”æ ‘çŠ¶æ•°ç»„æŸ¥è¯¢å€¼1çš„å‰ç¼€å’Œï¼ˆ0ï¼‰ã€‚
   - **è®¡ç®—f[1]**ï¼š`f[1] = 1 + 0*1 = 1`ï¼Œç”¨â€œä¹˜æ³•åŠ¨ç”»â€ï¼ˆçº¢è‰²å—å’Œæ•°å­—1åˆå¹¶æˆæ–°çš„çº¢è‰²å—ï¼Œæ˜¾ç¤º1ï¼‰ï¼Œä¼´éšâ€œå®â€çš„éŸ³æ•ˆã€‚
   - **åŠ å…¥æ ‘çŠ¶æ•°ç»„**ï¼šæ ‘çŠ¶æ•°ç»„ä¸­å€¼1çš„ç«–æ¡é•¿é«˜åˆ°1ï¼Œä¼´éšâ€œç °â€çš„éŸ³æ•ˆã€‚

3. **å¤„ç†ç¬¬äºŒä¸ªå…ƒç´ ï¼ˆè“è‰²å—2ï¼‰**ï¼š
   - **é«˜äº®**ï¼šè“è‰²å—é—ªçƒï¼ŒæŸ¥è¯¢å€¼2çš„å‰ç¼€å’Œï¼ˆ1ï¼Œæ¥è‡ªå€¼1çš„ç«–æ¡ï¼‰ï¼Œä¼´éšâ€œæ»´â€çš„éŸ³æ•ˆã€‚
   - **è®¡ç®—f[2]**ï¼š`f[2] = 2 + 1*2 =4`ï¼Œè“è‰²å—å’Œæ•°å­—4åˆå¹¶ï¼Œä¼´éšâ€œå®â€çš„éŸ³æ•ˆã€‚
   - **åŠ å…¥æ ‘çŠ¶æ•°ç»„**ï¼šå€¼2çš„ç«–æ¡é•¿é«˜åˆ°4ï¼Œä¼´éšâ€œç °â€çš„éŸ³æ•ˆã€‚

4. **å¤„ç†ç¬¬ä¸‰ä¸ªå…ƒç´ ï¼ˆè“è‰²å—2ï¼‰**ï¼š
   - **é«˜äº®**ï¼šè“è‰²å—é—ªçƒï¼ŒæŸ¥è¯¢å€¼2çš„å‰ç¼€å’Œï¼ˆ1+4=5ï¼‰ï¼Œä¼´éšâ€œæ»´â€çš„éŸ³æ•ˆã€‚
   - **è®¡ç®—f[3]**ï¼š`f[3] =2 +5*2=12`ï¼Œè“è‰²å—å’Œæ•°å­—12åˆå¹¶ï¼Œä¼´éšâ€œå®â€çš„éŸ³æ•ˆã€‚
   - **åŠ å…¥æ ‘çŠ¶æ•°ç»„**ï¼šå€¼2çš„ç«–æ¡é•¿é«˜åˆ°16ï¼ˆæ¨¡æ‹Ÿå¢é‡æ·»åŠ ï¼‰ï¼Œä¼´éšâ€œç °â€çš„éŸ³æ•ˆã€‚

5. **ç»Ÿè®¡ç­”æ¡ˆ**ï¼š
   - ä»åå¾€å‰éå†ï¼š
     - ç¬¬ä¸‰ä¸ªå…ƒç´ ï¼ˆè“è‰²å—2ï¼‰ï¼švis[2]æ˜¯falseï¼Œans +=12 â†’ é»„è‰²å—å˜å¤§åˆ°12ï¼Œä¼´éšâ€œç °â€çš„éŸ³æ•ˆï¼Œvis[2]å˜ä¸ºtrueã€‚
     - ç¬¬äºŒä¸ªå…ƒç´ ï¼ˆè“è‰²å—2ï¼‰ï¼švis[2]æ˜¯trueï¼Œè·³è¿‡ã€‚
     - ç¬¬ä¸€ä¸ªå…ƒç´ ï¼ˆçº¢è‰²å—1ï¼‰ï¼švis[1]æ˜¯falseï¼Œans +=1 â†’ é»„è‰²å—å˜å¤§åˆ°13ï¼Œä¼´éšâ€œç °â€çš„éŸ³æ•ˆï¼Œvis[1]å˜ä¸ºtrueã€‚
   - **ç»“æŸçŠ¶æ€**ï¼šç­”æ¡ˆç´¯åŠ å™¨æ˜¾ç¤º13ï¼Œæ’­æ”¾â€œèƒœåˆ©â€éŸ³æ•ˆï¼Œå±å¹•å‡ºç°â€œå®Œæˆï¼â€çš„åƒç´ æ–‡å­—ã€‚

### æ—ç™½æç¤ºï¼ˆåŠ¨ç”»ä¸­çš„æ–‡å­—æ°”æ³¡ï¼‰
- å¤„ç†ç¬¬ä¸€ä¸ªå…ƒç´ æ—¶ï¼šâ€œå¤„ç†çº¢è‰²å—1ï¼æŸ¥è¯¢å‰é¢â‰¤1çš„å’Œæ˜¯0ï¼Œf[1]=1+0=1ï¼ŒåŠ å…¥æ ‘çŠ¶æ•°ç»„ï¼â€
- å¤„ç†ç¬¬äºŒä¸ªå…ƒç´ æ—¶ï¼šâ€œå¤„ç†è“è‰²å—2ï¼æŸ¥è¯¢å‰é¢â‰¤2çš„å’Œæ˜¯1ï¼Œf[2]=2+1Ã—2=4ï¼ŒåŠ å…¥æ ‘çŠ¶æ•°ç»„ï¼â€
- å¤„ç†ç¬¬ä¸‰ä¸ªå…ƒç´ æ—¶ï¼šâ€œå¤„ç†è“è‰²å—2ï¼æŸ¥è¯¢å‰é¢â‰¤2çš„å’Œæ˜¯5ï¼Œf[3]=2+5Ã—2=12ï¼ŒåŠ å…¥æ ‘çŠ¶æ•°ç»„ï¼â€
- ç»Ÿè®¡æ—¶ï¼šâ€œä»åå¾€å‰ç»Ÿè®¡ï¼Œè“è‰²å—2åªåŠ ä¸€æ¬¡ï¼ˆ12ï¼‰ï¼Œçº¢è‰²å—1åŠ ä¸€æ¬¡ï¼ˆ1ï¼‰ï¼Œæ€»å’Œ13ï¼â€


## 6. æ‹“å±•ç»ƒä¹ ä¸ç›¸ä¼¼é—®é¢˜æ€è€ƒ

ç†è§£å¹¶æŒæ¡äº†æœ¬é¢˜çš„è§£æ³•åï¼Œæˆ‘ä»¬å¯ä»¥è¿›ä¸€æ­¥æ€è€ƒè¯¥ç®—æ³•çš„é€‚ç”¨èŒƒå›´å’Œå˜å½¢åº”ç”¨ï¼š

### é€šç”¨æ€è·¯/æŠ€å·§è¿ç§»
æœ¬é¢˜çš„æ ¸å¿ƒæ˜¯**åŠ¨æ€è§„åˆ’+æ ‘çŠ¶æ•°ç»„ä¼˜åŒ–å‰ç¼€å’Œ**ï¼Œè¿™ç§æ€è·¯é€‚ç”¨äºä»¥ä¸‹åœºæ™¯ï¼š
1. **æœ€é•¿ä¸Šå‡å­åºåˆ—ï¼ˆLISï¼‰çš„å˜å½¢**ï¼šæ¯”å¦‚æ±‚æ‰€æœ‰ä¸Šå‡å­åºåˆ—çš„é•¿åº¦å’Œã€ä¹˜ç§¯å’Œç­‰ã€‚
2. **è®¡æ•°é—®é¢˜**ï¼šæ¯”å¦‚ç»Ÿè®¡æ»¡è¶³æŸäº›æ¡ä»¶çš„å­åºåˆ—æ•°é‡ï¼Œå¦‚å…ƒç´ å’Œä¸ºkçš„å­åºåˆ—æ•°ã€‚
3. **å¸¦æƒå€¼çš„å­åºåˆ—é—®é¢˜**ï¼šæ¯”å¦‚æ¯ä¸ªå­åºåˆ—çš„æƒå€¼æ˜¯å…ƒç´ çš„ä¹˜ç§¯ã€å’Œç­‰ï¼Œæ±‚æ‰€æœ‰æ»¡è¶³æ¡ä»¶çš„å­åºåˆ—çš„æƒå€¼å’Œã€‚

### ç»ƒä¹ æ¨è (æ´›è°·)
ä»¥ä¸‹æ˜¯å‡ é“æ´›è°·ä¸Šä¸æœ¬é¢˜è€ƒå¯ŸçŸ¥è¯†ç‚¹ç›¸å…³çš„é¢˜ç›®ï¼Œå»ºè®®å¤§å®¶å°è¯•ç»ƒä¹ ï¼š

1. **æ´›è°· P1908 é€†åºå¯¹**  
   - ğŸ—£ï¸ **æ¨èç†ç”±**ï¼šæ ‘çŠ¶æ•°ç»„çš„ç»å…¸åº”ç”¨ï¼Œå¸®åŠ©ä½ ç†Ÿæ‚‰å‰ç¼€å’ŒæŸ¥è¯¢å’Œå•ç‚¹æ›´æ–°ã€‚
2. **æ´›è°· P2280 [HNOI2003]æ¿€å…‰ç‚¸å¼¹**  
   - ğŸ—£ï¸ **æ¨èç†ç”±**ï¼šäºŒç»´æ ‘çŠ¶æ•°ç»„çš„åº”ç”¨ï¼Œæ‹“å±•ä½ çš„æ ‘çŠ¶æ•°ç»„ä½¿ç”¨åœºæ™¯ã€‚
3. **æ´›è°· P3374 ã€æ¨¡æ¿ã€‘æ ‘çŠ¶æ•°ç»„ 1**  
   - ğŸ—£ï¸ **æ¨èç†ç”±**ï¼šæ ‘çŠ¶æ•°ç»„çš„åŸºç¡€æ¨¡æ¿é¢˜ï¼Œå·©å›ºä½ çš„æ ‘çŠ¶æ•°ç»„å®ç°èƒ½åŠ›ã€‚
4. **æ´›è°· P3369 ã€æ¨¡æ¿ã€‘æ™®é€šå¹³è¡¡æ ‘**  
   - ğŸ—£ï¸ **æ¨èç†ç”±**ï¼šè™½ç„¶æ˜¯å¹³è¡¡æ ‘æ¨¡æ¿ï¼Œä½†æ ‘çŠ¶æ•°ç»„ä¹Ÿå¯ä»¥å¤„ç†ç±»ä¼¼çš„æœ‰åºç»Ÿè®¡é—®é¢˜ï¼Œå¸®åŠ©ä½ ç†è§£æ ‘çŠ¶æ•°ç»„çš„çµæ´»æ€§ã€‚


## 7. å­¦ä¹ å¿ƒå¾—ä¸ç»éªŒåˆ†äº« (è‹¥æœ‰)
æœ¬æ¬¡åˆ†æçš„é¢˜è§£ä¸­ï¼Œ`liuyifan`çš„ä»£ç ç»™æˆ‘ä»¬å¸¦æ¥äº†é‡è¦çš„å¯ç¤ºï¼š**æ­£ç¡®ç†è§£é¢˜ç›®ä¸­çš„â€œä¸åŒâ€æ˜¯è§£é¢˜çš„å…³é”®**ã€‚ä»–çš„ä»£ç é€šè¿‡â€œä¿ç•™æœ€åä¸€æ¬¡å‡ºç°çš„f[i]â€æ­£ç¡®å»é‡ï¼Œå®Œç¾é€šè¿‡æ ·ä¾‹ï¼Œè¿™æé†’æˆ‘ä»¬åœ¨è§£é¢˜æ—¶è¦ä»”ç»†åˆ†æé¢˜ç›®ä¸­çš„å®šä¹‰ï¼Œé¿å…è¯¯è§£ã€‚æ­¤å¤–ï¼Œ`_edge_`çš„ä»£ç è™½ç„¶å»é‡é€»è¾‘é”™è¯¯ï¼Œä½†æ ‘çŠ¶æ•°ç»„çš„ä½¿ç”¨å’ŒDPçŠ¶æ€å®šä¹‰å€¼å¾—å€Ÿé‰´ï¼Œå¸®åŠ©æˆ‘ä»¬ç†è§£åŠ¨æ€è§„åˆ’çš„åŸºæœ¬æ€æƒ³ã€‚


## ç»“è®º
æœ¬æ¬¡å…³äºâ€œSereja and Subsequencesâ€çš„C++è§£é¢˜åˆ†æå°±åˆ°è¿™é‡Œã€‚å¸Œæœ›è¿™ä»½å­¦ä¹ æŒ‡å—èƒ½å¸®åŠ©å¤§å®¶æ›´å¥½åœ°ç†è§£åŠ¨æ€è§„åˆ’å’Œæ ‘çŠ¶æ•°ç»„çš„ç»“åˆåº”ç”¨ã€‚è®°ä½ï¼Œç¼–ç¨‹èƒ½åŠ›çš„æå‡åœ¨äº**ä»”ç»†åˆ†æé¢˜ç›®ã€æ­£ç¡®å®šä¹‰çŠ¶æ€ã€çµæ´»ä½¿ç”¨æ•°æ®ç»“æ„**ï¼Œå¹¶ä¸æ–­å®è·µï¼ä¸‹æ¬¡æˆ‘ä»¬å†ä¸€èµ·æ¢ç´¢æ–°çš„ç¼–ç¨‹æŒ‘æˆ˜ï¼ğŸ’ª

---
å¤„ç†ç”¨æ—¶ï¼š396.14ç§’
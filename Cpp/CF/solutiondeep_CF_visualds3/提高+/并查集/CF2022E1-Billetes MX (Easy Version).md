# é¢˜ç›®ä¿¡æ¯

# Billetes MX (Easy Version)

## é¢˜ç›®æè¿°

This is the easy version of the problem. In this version, it is guaranteed that $ q = 0 $ . You can make hacks only if both versions of the problem are solved.

An integer grid $ A $ with $ p $ rows and $ q $ columns is called beautiful if:

- All elements of the grid are integers between $ 0 $ and $ 2^{30}-1 $ , and
- For any subgrid, the XOR of the values at the corners is equal to $ 0 $ . Formally, for any four integers $ i_1 $ , $ i_2 $ , $ j_1 $ , $ j_2 $ ( $ 1 \le i_1 < i_2 \le p $ ; $ 1 \le j_1 < j_2 \le q $ ), $ A_{i_1, j_1} \oplus A_{i_1, j_2} \oplus A_{i_2, j_1} \oplus A_{i_2, j_2} = 0 $ , where $ \oplus $ denotes the [bitwise XOR operation](https://en.wikipedia.org/wiki/Bitwise_operation#XOR).

There is a partially filled integer grid $ G $ with $ n $ rows and $ m $ columns where only $ k $ cells are filled. Polycarp wants to know how many ways he can assign integers to the unfilled cells so that the grid is beautiful.

However, Monocarp thinks that this problem is too easy. Therefore, he will perform $ q $ updates on the grid. In each update, he will choose an unfilled cell and assign an integer to it. Note that these updates are persistent. That is, changes made to the grid will apply when processing future updates.

For each of the $ q + 1 $ states of the grid, the initial state and after each of the $ q $ queries, determine the number of ways Polycarp can assign integers to the unfilled cells so that the grid is beautiful. Since this number can be very large, you are only required to output their values modulo $ 10^9+7 $ .

## è¯´æ˜/æç¤º

In the first test case of the example, we have the following grid:

  $ 0 $  $ 6 $  $ 10 $  $ 6 $  $ 0 $  $ 12 $  $ 10 $  $ 12 $  $ ? $ It can be proven that the only valid value for tile $ (3, 3) $ is $ 0 $ .

## æ ·ä¾‹ #1

### è¾“å…¥

```
2
3 3 8 0
2 1 6
3 2 12
1 2 6
2 2 0
1 3 10
1 1 0
2 3 12
3 1 10
2 5 2 0
1 1 10
1 2 30```

### è¾“å‡º

```
1
489373567```

# AIåˆ†æç»“æœ


### ğŸ’¡ Kayçš„C++ç®—æ³•è§£æï¼šBilletes MX (Easy Version) æ·±å…¥å­¦ä¹ æŒ‡å— ğŸ’¡

> ä»Šå¤©æˆ‘ä»¬æ¥åˆ†æè¿™é“å…³äºã€Œç¾ä¸½ç½‘æ ¼ã€çš„é¢˜ç›®ï¼Œå®ƒå·§å¦™ç»“åˆäº†å›¾è®ºå’Œç»„åˆæ•°å­¦ã€‚æˆ‘ä»¬å°†é€šè¿‡å¹¶æŸ¥é›†å»ºæ¨¡ã€è¿é€šå—è®¡æ•°ç­‰æ ¸å¿ƒæŠ€å·§ï¼Œæ­å¼€å¼‚æˆ–çº¦æŸä¸‹çš„ç½‘æ ¼æ„é€ å¥¥ç§˜ï¼

#### 1. é¢˜ç›®è§£è¯»ä¸æ ¸å¿ƒç®—æ³•è¯†åˆ«
âœ¨ **æœ¬é¢˜ä¸»è¦è€ƒå¯Ÿ**ï¼š`å›¾è®ºå»ºæ¨¡ä¸å¹¶æŸ¥é›†åº”ç”¨`

ğŸ—£ï¸ **åˆæ­¥åˆ†æ**ï¼š
> æƒ³è±¡ç½‘æ ¼æ˜¯ä¸€å¼ å·¨å¤§çš„ã€Œå¯†ç ç½‘ã€ï¼Œæ¯ä¸ªæ ¼å­çš„å€¼ç”±è¡Œå¯†ç å’Œåˆ—å¯†ç ç»„åˆè€Œæˆï¼ˆ`A[i][j] = è¡Œå¯†ç [i] âŠ• åˆ—å¯†ç [j]`ï¼‰ã€‚è¿™ç§ç»“æ„å¤©ç„¶æ»¡è¶³é¢˜ç›®è¦æ±‚â€”â€”ä»»ä½•å­ç½‘æ ¼å››è§’çš„å¼‚æˆ–å€¼éƒ½ä¸º0ã€‚  
> é€šè¿‡å¹¶æŸ¥é›†ï¼Œæˆ‘ä»¬å°†è¡Œåˆ—å¯†ç çš„çº¦æŸå…³ç³»è½¬åŒ–ä¸ºè¿é€šå—ç®¡ç†ï¼š  
> - **æ ¸å¿ƒæµç¨‹**ï¼šæ¯ä¸ªå·²çŸ¥æ ¼å­`(r,c,v)`åœ¨è¡ŒèŠ‚ç‚¹`r`å’Œåˆ—èŠ‚ç‚¹`c`é—´å»ºç«‹æƒå€¼ä¸º`v`çš„è¾¹  
> - **éš¾ç‚¹çªç ´**ï¼šåˆå¹¶æ—¶æ£€æŸ¥ç¯çš„å¼‚æˆ–ä¸€è‡´æ€§ï¼Œç»Ÿè®¡è¿é€šå—æ•°é‡`s`åï¼Œæ–¹æ¡ˆæ•° = `(2^30)^(s-1) mod 1e9+7`  
> - **å¯è§†åŒ–è®¾è®¡**ï¼šåƒç´ ç½‘æ ¼ä¸­ï¼Œç”¨é—ªçƒçº¿æ¡è¿æ¥è¡Œåˆ—èŠ‚ç‚¹ï¼Œå½¢æˆç¯æ—¶é«˜äº®æ˜¾ç¤ºå¹¶æ’­æ”¾éŸ³æ•ˆï¼ˆæˆåŠŸï¼šæ¸…è„†"å®"å£°ï¼›å†²çªï¼šè­¦æŠ¥éŸ³ï¼‰

---

#### 2. ç²¾é€‰ä¼˜è´¨é¢˜è§£å‚è€ƒ
**é¢˜è§£ä¸€ï¼ˆlarsrï¼‰**
* **ç‚¹è¯„**ï¼šæ€è·¯ç›´å‡»æœ¬è´¨â€”â€”å°†ç½‘æ ¼çº¦æŸè½¬åŒ–ä¸ºäºŒåˆ†å›¾æ¨¡å‹ã€‚ä»£ç ä¸­`getfa()`ç»´æŠ¤èŠ‚ç‚¹åˆ°æ ¹çš„å¼‚æˆ–å€¼`fv[]`ï¼Œ`uni()`åˆå¹¶æ—¶æ™ºèƒ½æ£€æŸ¥ç¯çº¦æŸï¼ˆ`if (fv[xu]^fv[xv]^w) hf=0`ï¼‰ã€‚äº®ç‚¹åœ¨äºç”¨`ans`åŠ¨æ€ç»Ÿè®¡è¿é€šå—æ•°ï¼Œä½¿æ–¹æ¡ˆæ•°è®¡ç®—ç®€æ´é«˜æ•ˆï¼ˆ`mul[ans] = (2^30)^(s-1)`ï¼‰ã€‚å˜é‡å‘½åè§„èŒƒï¼ˆå¦‚`fv`=find valueï¼‰ï¼Œè¾¹ç•Œå¤„ç†ä¸¥è°¨ï¼Œå¯ç›´æ¥ç”¨äºç«èµ›ã€‚

**é¢˜è§£äºŒï¼ˆlfxxxï¼‰**
* **ç‚¹è¯„**ï¼šé‡‡ç”¨æŒ‰ä½æ‹†è§£+æ‰©å±•åŸŸå¹¶æŸ¥é›†çš„å·§å¦™æ€è·¯ã€‚æ ¸å¿ƒäº®ç‚¹åœ¨äºæ¯ä½ç‹¬ç«‹å¤„ç†æ—¶ï¼Œå°†æ¯ä¸ªåˆ—èŠ‚ç‚¹æ‹†åˆ†ä¸º0/1ä¸¤ä¸ªåŸŸï¼ˆå¦‚`fa[2*c-1]`å’Œ`fa[2*c]`ï¼‰ï¼Œæ ¹æ®å¼‚æˆ–å€¼å»ºç«‹åŸŸé—´çº¦æŸå…³ç³»ã€‚è™½ç„¶å®ç°ç¨å¤æ‚ï¼Œä½†å±•ç¤ºäº†å¤„ç†ä½è¿ç®—çº¦æŸçš„é€šç”¨æ–¹æ³•ï¼Œå…·æœ‰æ•™å­¦ä»·å€¼ã€‚

---

#### 3. æ ¸å¿ƒéš¾ç‚¹è¾¨æä¸è§£é¢˜ç­–ç•¥
1.  **éš¾ç‚¹ï¼šç½‘æ ¼çº¦æŸçš„å›¾è®ºè½¬åŒ–**
    * **åˆ†æ**ï¼šå‘ç°`A[i][j]=è¡Œå¯†ç âŠ•åˆ—å¯†ç `æ˜¯ç ´é¢˜å…³é”®ï¼è¿™è¦æ±‚å°†è¡Œ/åˆ—æŠ½è±¡ä¸ºèŠ‚ç‚¹ï¼Œæ ¼å­å€¼ä½œä¸ºè¾¹æƒ
    * ğŸ’¡ **å­¦ä¹ ç¬”è®°**ï¼šçŸ©é˜µçº¦æŸ â†’ äºŒåˆ†å›¾å»ºæ¨¡æ˜¯ç»å…¸å¥—è·¯

2.  **éš¾ç‚¹ï¼šå¹¶æŸ¥é›†çš„å¼‚æˆ–ç»´æŠ¤**
    * **åˆ†æ**ï¼šåˆå¹¶æ—¶éœ€ä¿è¯å¼‚æˆ–è·¯å¾„ä¸€è‡´æ€§ã€‚larsrè§£æ³•ä¸­`fv[u]`ç»´æŠ¤èŠ‚ç‚¹åˆ°æ ¹çš„å¼‚æˆ–å€¼ï¼Œåˆå¹¶æ—¶é€šè¿‡`fv[u_new]=w^fv[xu]^fv[xv]`ä¿è¯æ–°è·¯å¾„æ­£ç¡®
    * ğŸ’¡ **å­¦ä¹ ç¬”è®°**ï¼šå¸¦æƒå¹¶æŸ¥é›†çš„æƒå€¼æ›´æ–°å…¬å¼æ˜¯æ ¸å¿ƒ

3.  **éš¾ç‚¹ï¼šæ–¹æ¡ˆæ•°è®¡ç®—åŸç†**
    * **åˆ†æ**ï¼š`s`ä¸ªè¿é€šå—ä¸­ï¼Œåªæœ‰1ä¸ªå—çš„æ ¹å¯è‡ªç”±èµ‹å€¼ï¼ˆ2^30ç§é€‰æ‹©ï¼‰ï¼Œå…¶ä½™å—ç”±çº¦æŸå”¯ä¸€ç¡®å®šï¼Œæ•…æ–¹æ¡ˆæ•°=`(2^30)^(s-1)`
    * ğŸ’¡ **å­¦ä¹ ç¬”è®°**ï¼šè¿é€šå—æ•°=è‡ªç”±å˜é‡æ•°+1

âœ¨ **è§£é¢˜æŠ€å·§æ€»ç»“**  
- **æ¨¡å‹è½¬æ¢æœ¯**ï¼šå°†çŸ©é˜µçº¦æŸè½¬åŒ–ä¸ºå›¾è®ºé—®é¢˜ï¼ˆè¡Œ/åˆ—â†’èŠ‚ç‚¹ï¼Œæ ¼å­â†’è¾¹ï¼‰  
- **å¹¶æŸ¥é›†é­”æ”¹**ï¼šç”¨`fv[]`ç»´æŠ¤å¼‚æˆ–è·¯å¾„ï¼Œåˆå¹¶æ—¶åŠ¨æ€æ£€æŸ¥çº¦æŸä¸€è‡´æ€§  
- **è¿é€šå—é­”æ³•**ï¼šé€šè¿‡è¿é€šå—è®¡æ•°å¿«é€Ÿè®¡ç®—æ–¹æ¡ˆæ•°  

---

#### 4. C++æ ¸å¿ƒä»£ç å®ç°èµæ
**æœ¬é¢˜é€šç”¨æ ¸å¿ƒå®ç°**  
```cpp
void uni(int u, int v, int w) {
    int xu = u, xv = v;
    u = getfa(u); v = getfa(v);
    if(u == v) {
        if(fv[xu]^fv[xv]^w) hf=0; // ç¯çº¦æŸæ£€æŸ¥
        return;
    }
    f[u] = v;
    fv[u] = w^fv[xu]^fv[xv]; // æƒå€¼è°ƒæ•´å…¬å¼
    ans--; // è¿é€šå—å‡å°‘
}
```

**é¢˜è§£ä¸€ï¼ˆlarsrï¼‰ç‰‡æ®µ**  
```cpp
if(u == v) {
    if((fv[xu]^fv[xv]^w) != 0) hf=0;
    return;
}
```
> **è§£è¯»**ï¼šå½“ä¸¤ä¸ªèŠ‚ç‚¹å·²è¿é€šæ—¶ï¼Œæ£€æŸ¥æ–°è¾¹æƒ`w`æ˜¯å¦ä¸ç°æœ‰è·¯å¾„ä¸€è‡´ï¼ˆ`fv[xu]^fv[xv]`å³è·¯å¾„å¼‚æˆ–å€¼ï¼‰ã€‚è‹¥å†²çªåˆ™ç½®`hf=0`æ ‡è®°æ— è§£ã€‚  
> ğŸ’¡ **å­¦ä¹ ç¬”è®°**ï¼šç¯æ£€æŸ¥æ˜¯ä¿è¯æ–¹æ¡ˆå­˜åœ¨çš„å…³é”®é˜€é—¨ï¼

**é¢˜è§£äºŒï¼ˆlfxxxï¼‰ç‰‡æ®µ**  
```cpp
// æ ¹æ®å¼‚æˆ–å€¼å»ºç«‹åŸŸé—´å…³ç³»
if(val_bit == col_bit) { // ç›¸åŒå€¼
    merge(u0, v0); 
    merge(u1, v1);
} else { // ä¸åŒå€¼
    merge(u0, v1);
    merge(u1, v0);
}
```
> **è§£è¯»**ï¼šæŒ‰ä½å¤„ç†æ—¶ï¼Œè‹¥æŸä½å€¼ç›¸åŒï¼Œåˆ™åˆå¹¶ä¸¤èŠ‚ç‚¹çš„0åŸŸå’Œ1åŸŸï¼›è‹¥ä¸åŒï¼Œåˆ™äº¤å‰åˆå¹¶ï¼ˆ0â†”1ï¼‰ã€‚è¿™ç§ã€ŒåŸŸåˆ†è£‚ã€å®Œç¾ç¼–ç äº†å¼‚æˆ–çº¦æŸã€‚  
> ğŸ’¡ **å­¦ä¹ ç¬”è®°**ï¼šæ‰©å±•åŸŸå¹¶æŸ¥é›†æ˜¯å¤„ç†äºŒå€¼çº¦æŸçš„åˆ©å™¨ï¼

---

#### 5. ç®—æ³•å¯è§†åŒ–ï¼šåƒç´ åŠ¨ç”»æ¼”ç¤º
![](https://via.placeholder.com/400x200?text=8-bit+åƒç´ ç½‘æ ¼+åŠ¨ç”»ç¤ºæ„å›¾)  
* **ä¸»é¢˜**ï¼šå¤å¤æ¸¸æˆã€Šå¯†ç è¿æ¥è€…ã€‹  
* **æ ¸å¿ƒæ¼”ç¤º**ï¼š  
  1. å·¦ä¾§åƒç´ ç½‘æ ¼æ˜¾ç¤ºå½“å‰çŸ©é˜µï¼Œå³ä¾§å¹¶æŸ¥é›†æ£®æ—ï¼ˆè¡ŒèŠ‚ç‚¹è“è‰²/åˆ—èŠ‚ç‚¹ç»¿è‰²ï¼‰  
  2. **æ·»åŠ å·²çŸ¥æ ¼å­**ï¼šç½‘æ ¼ä¸­æ•°å­—äº®èµ·â†’è¡Œåˆ—èŠ‚ç‚¹é—´å‡èµ·é‡‘è‰²å…‰é“¾ï¼ˆä¼´éš"å®"å£°ï¼‰  
  3. **å½¢æˆç¯**ï¼šå…‰é“¾é—­åˆæ—¶é«˜äº®ç¯è·¯ï¼Œæ˜¾ç¤ºè·¯å¾„å¼‚æˆ–å€¼ï¼ˆæˆåŠŸï¼šç»¿ç¯+æ¬¢å¿«éŸ³æ•ˆï¼›å¤±è´¥ï¼šçº¢ç¯+è­¦æŠ¥ï¼‰  
  4. **è¿é€šå—ç»Ÿè®¡**ï¼šæ¯åˆå¹¶æˆåŠŸï¼Œæ£®æ—ä¸­è¿é€šå—é—ªçƒåˆå¹¶ï¼Œå³ä¸Šè§’æ–¹æ¡ˆæ•°å®æ—¶æ›´æ–°  
* **äº¤äº’è®¾è®¡**ï¼š  
  - æ§åˆ¶é¢æ¿ï¼šæ­¥è¿›/æ’­æ”¾/é‡ç½®æŒ‰é’® + é€Ÿåº¦æ»‘å—  
  - éŸ³æ•ˆç³»ç»Ÿï¼šè¿æ¥(å®)ã€æˆåŠŸ(ä¸Šæ‰¬å’Œå¼¦)ã€å†²çª(ä½éŸ³è­¦æŠ¥)  
  - æ¸¸æˆåŒ–ï¼šæ¯å®Œæˆä¸€ç»„æŸ¥è¯¢ç‚¹äº®ä¸€é¢—æ˜Ÿæ˜Ÿï¼Œé›†é½ä¸‰é¢—é€šå…³  

---

#### 6. æ‹“å±•ç»ƒä¹ ä¸ç›¸ä¼¼é—®é¢˜æ€è€ƒ
* **æŠ€å·§è¿ç§»åœºæ™¯**ï¼š  
  1. å¸¦æƒå¹¶æŸ¥é›†ç»´æŠ¤ç­‰å¼çº¦æŸï¼ˆå¦‚`A=B+k`ï¼‰  
  2. æ‰©å±•åŸŸå¤„ç†æ•Œå¯¹å…³ç³»ï¼ˆå¦‚é£Ÿç‰©é“¾é—®é¢˜ï¼‰  
  3. åŠ¨æ€è¿é€šæ€§ç»Ÿè®¡æ–¹æ¡ˆæ•°ï¼ˆå¦‚è¿é€šå—è®¡æ•°ï¼‰  

* **æ´›è°·æ¨è**ï¼š  
  1. [P2024 é£Ÿç‰©é“¾](https://www.luogu.com.cn/problem/P2024) â†’ æ‰©å±•åŸŸå¹¶æŸ¥é›†ç»å…¸åº”ç”¨  
  2. [P1525 å…³æŠ¼ç½ªçŠ¯](https://www.luogu.com.cn/problem/P1525) â†’ äºŒåˆ†å›¾å»ºæ¨¡æ€ç»´æ‹“å±•  
  3. [P4185 MooTube](https://www.luogu.com.cn/problem/P4185) â†’ è¿é€šå—åŠ¨æ€ç»Ÿè®¡  

---

> é€šè¿‡è¿™æ¬¡æ¢ç´¢ï¼Œæˆ‘ä»¬è§£é”äº†ã€Œçº¦æŸè½¬åŒ–+å¹¶æŸ¥é›†ç»Ÿè®¡ã€çš„ç»„åˆæ‹³ã€‚è®°ä½ï¼šå¤æ‚é—®é¢˜å¾€å¾€æœ‰ç®€æ´çš„å›¾è®ºæœ¬è´¨ï¼ä¸‹æ¬¡é‡åˆ°çŸ©é˜µçº¦æŸæ—¶ï¼Œä¸å¦¨å°è¯•è¡Œåˆ—èŠ‚ç‚¹å»ºæ¨¡æ³•å“¦~ âœ¨

---
å¤„ç†ç”¨æ—¶ï¼š203.67ç§’
# é¢˜ç›®ä¿¡æ¯

# Famil Door and Roads

## é¢˜ç›®æè¿°

Famil Doorâ€™s City map looks like a tree (undirected connected acyclic graph) so other people call it Treeland. There are $ n $ intersections in the city connected by $ n-1 $ bidirectional roads.

There are $ m $ friends of Famil Door living in the city. The $ i $ -th friend lives at the intersection $ u_{i} $ and works at the intersection $ v_{i} $ . Everyone in the city is unhappy because there is exactly one simple path between their home and work.

Famil Door plans to construct exactly one new road and he will randomly choose one among $ nÂ·(n-1)/2 $ possibilities. Note, that he may even build a new road between two cities that are already connected by one.

He knows, that each of his friends will become happy, if after Famil Door constructs a new road there is a path from this friend home to work and back that doesn't visit the same road twice. Formally, there is a simple cycle containing both $ u_{i} $ and $ v_{i} $ .

Moreover, if the friend becomes happy, his pleasure is equal to the length of such path (it's easy to see that it's unique). For each of his friends Famil Door wants to know his expected pleasure, that is the expected length of the cycle containing both $ u_{i} $ and $ v_{i} $ if we consider only cases when such a cycle exists.

## è¯´æ˜/æç¤º

Consider the second sample.

1. Both roads $ (1,2) $ and $ (2,3) $ work, so the expected length if ![](https://cdn.luogu.com.cn/upload/vjudge_pic/CF629E/2870a27a99e49b2e86fafede38ebc7cc8463668d.png)
2. Roads $ (1,3) $ and $ (2,3) $ make the second friend happy. Same as for friend $ 1 $ the answer is $ 2.5 $
3. The only way to make the third friend happy is to add road $ (2,3) $ , so the answer is $ 3 $

## æ ·ä¾‹ #1

### è¾“å…¥

```
4 3
2 4
4 1
3 2
3 1
2 3
4 1
```

### è¾“å‡º

```
4.00000000
3.00000000
3.00000000
```

## æ ·ä¾‹ #2

### è¾“å…¥

```
3 3
1 2
1 3
1 2
1 3
2 3
```

### è¾“å‡º

```
2.50000000
2.50000000
3.00000000
```

# AIåˆ†æç»“æœ


### é¢˜ç›®åˆ†æ
é¢˜ç›®è¦æ±‚è®¡ç®—åœ¨æ ‘ä¸­éšæœºæ·»åŠ ä¸€æ¡è¾¹åï¼Œç»™å®šç‚¹å¯¹ \( (u, v) \) å¤„äºåŒä¸€ç¯ä¸­çš„æœŸæœ›ç¯é•¿ã€‚ç¯é•¿å®šä¹‰ä¸ºç¯ä¸Šçš„è¾¹æ•°ï¼ŒæœŸæœ›æ˜¯æ‰€æœ‰æ»¡è¶³æ¡ä»¶çš„æ·»åŠ è¾¹æ–¹æ¡ˆä¸­ç¯é•¿çš„å¹³å‡å€¼ã€‚

#### æ ¸å¿ƒç®—æ³•è¯†åˆ«
**ç®—æ³•åˆ†ç±»**ï¼šæ ‘å½¢åŠ¨æ€è§„åˆ’ï¼ˆæ¢æ ¹DPï¼‰ã€æœ€è¿‘å…¬å…±ç¥–å…ˆï¼ˆLCAï¼‰ã€æœŸæœ›è®¡ç®—  
**æ¯”å–»è§£é‡Š**ï¼šæƒ³è±¡æ ‘æ˜¯ä¸€åº§åŸå¸‚çš„åœ°å›¾ï¼ŒèŠ‚ç‚¹æ˜¯è·¯å£ï¼Œè¾¹æ˜¯é“è·¯ã€‚æ·»åŠ ä¸€æ¡æ–°è·¯ï¼ˆè¾¹ï¼‰åï¼Œæˆ‘ä»¬éœ€è¦è®¡ç®—ä»å®¶ï¼ˆ\(u\)ï¼‰åˆ°å…¬å¸ï¼ˆ\(v\)ï¼‰çš„ç¯è¡Œè·¯çº¿é•¿åº¦æœŸæœ›ã€‚å…³é”®åœ¨äºåˆ†ææ–°è·¯å¦‚ä½•è¿æ¥ä¸¤ä¸ªå­æ ‘ï¼Œå½¢æˆåŒ…å« \(u\) å’Œ \(v\) çš„ç¯ã€‚

**æ ¸å¿ƒæ€æƒ³**ï¼š
1. **åˆ†ç±»è®¨è®º**ï¼šåŸºäº \(u\) å’Œ \(v\) çš„ç¥–å…ˆå…³ç³»ï¼ˆæ˜¯å¦äº’ä¸ºç¥–å…ˆï¼‰åˆ†ä¸¤ç§æƒ…å†µå¤„ç†ã€‚
2. **é¢„å¤„ç†å­æ ‘ä¿¡æ¯**ï¼šé€šè¿‡ DFS è®¡ç®—å­æ ‘å¤§å° \(sz\)ã€å­æ ‘å†…èŠ‚ç‚¹åˆ°æ ¹çš„è·ç¦»å’Œ \(f\)ã€‚
3. **æ¢æ ¹ DP**ï¼šé€šè¿‡äºŒæ¬¡ DFS è®¡ç®—å…¨å±€èŠ‚ç‚¹åˆ°ä»»æ„ç‚¹çš„è·ç¦»å’Œ \(g\)ã€‚
4. **LCA ä¸ç¥–å…ˆæŸ¥è¯¢**ï¼šä½¿ç”¨å€å¢æ³•å¿«é€Ÿæ±‚ LCA å’Œç‰¹å®šç¥–å…ˆèŠ‚ç‚¹ã€‚
5. **æœŸæœ›å…¬å¼**ï¼šåˆ†åˆ«è®¡ç®—ä¸¤ç§æƒ…å†µä¸‹çš„æ–¹æ¡ˆæ•°å’Œç¯é•¿æ€»å’Œï¼Œå†æ±‚æœŸæœ›ã€‚

**å¯è§†åŒ–è®¾è®¡æ€è·¯**ï¼š
- **åƒç´ åŠ¨ç”»æ¼”ç¤º**ï¼šé‡‡ç”¨ 8 ä½åƒç´ é£æ ¼ï¼Œä»¥ç½‘æ ¼æ ‘æ¨¡æ‹Ÿç®—æ³•è¿‡ç¨‹ï¼š
  1. **é«˜äº®å½“å‰èŠ‚ç‚¹**ï¼šæ ‡è®° \(u\) å’Œ \(v\) çš„ä½ç½®ã€‚
  2. **å­æ ‘ç€è‰²**ï¼šç”¨ä¸åŒé¢œè‰²åŒºåˆ† \(u\) å’Œ \(v\) çš„å­æ ‘ã€‚
  3. **è·¯å¾„åŠ¨ç”»**ï¼šé€æ­¥æ˜¾ç¤ºæ–°è¾¹è¿æ¥å­æ ‘çš„è¿‡ç¨‹ï¼Œä¼´éšéŸ³æ•ˆæç¤ºæ“ä½œï¼ˆå¦‚â€œå®â€å£°è¡¨ç¤ºè¿æ¥æˆåŠŸï¼‰ã€‚
  4. **æ•°æ®æ›´æ–°**ï¼šå®æ—¶æ˜¾ç¤º \(sz\), \(f\), \(g\) ç­‰å˜é‡çš„å€¼ã€‚
  5. **äº¤äº’æ§åˆ¶**ï¼šæ”¯æŒå•æ­¥æ‰§è¡Œã€è°ƒé€Ÿæ»‘å—ï¼Œä¾¿äºè§‚å¯Ÿå­æ ‘åˆ’åˆ†å’Œè·ç¦»è®¡ç®—ã€‚

---

### ç²¾é€‰ä¼˜è´¨é¢˜è§£å‚è€ƒ
#### é¢˜è§£ä¸€ï¼š**LlLlCcï¼ˆ7èµï¼‰**
- **äº®ç‚¹**ï¼š
  - æ¸…æ™°åˆ†ç±»ä¸¤ç§æƒ…å†µï¼Œæ•°å­¦æ¨å¯¼ä¸¥è°¨ã€‚
  - é«˜æ•ˆé¢„å¤„ç† \(f\) å’Œ \(g\)ï¼Œæ¢æ ¹ DP å®ç°ç®€æ´ã€‚
  - ä»£ç è§„èŒƒï¼šå˜é‡åå«ä¹‰æ˜ç¡®ï¼ˆ`sz`, `f`, `g`ï¼‰ï¼Œè¾¹ç•Œå¤„ç†ä¸¥è°¨ã€‚
- **ä»£ç ç‰‡æ®µ**ï¼š
  ```cpp
  void dfs1(int u, int p) {
      sz[u] = 1;
      for (auto v : G[u]) if (v != p) {
          dfs1(v, u);
          sz[u] += sz[v];
          f[u] += f[v] + sz[v]; // ç´¯åŠ å­æ ‘è´¡çŒ®
      }
  }
  void dfs2(int u, int p) {
      for (auto v : G[u]) if (v != p) {
          g[v] = g[u] - sz[v] + (n - sz[v]); // æ¢æ ¹å…¬å¼
          dfs2(v, u);
      }
  }
  ```
- **å­¦ä¹ ç¬”è®°**ï¼šæ¢æ ¹ DP çš„æ ¸å¿ƒæ˜¯åˆ©ç”¨çˆ¶èŠ‚ç‚¹ä¿¡æ¯æ›´æ–°å­èŠ‚ç‚¹ï¼Œé¿å…é‡å¤è®¡ç®—ã€‚

#### é¢˜è§£äºŒï¼š**DiaĞ¾siï¼ˆ3èµï¼‰**
- **äº®ç‚¹**ï¼š
  - å¼•å…¥â€œåˆæ³•ç‚¹å¯¹â€æ¦‚å¿µï¼Œç›´è§‚è§£é‡Šç¯çš„å½¢æˆã€‚
  - è¯¦ç»†æ¨å¯¼ç¯é•¿ç»„æˆï¼ˆæ–°è¾¹ + åŸè·¯å¾„ + å­æ ‘è·¯å¾„ï¼‰ã€‚
  - ä»£ç ä¸­å°è£…å‡½æ•°æé«˜å¯è¯»æ€§ï¼ˆå¦‚ `LCA`, `dis`ï¼‰ã€‚
- **æ ¸å¿ƒä»£ç **ï¼š
  ```cpp
  double GetE(int u, int v) {
      int l = LCA(u, v);
      if (l == u) { // u æ˜¯ v çš„ç¥–å…ˆ
          int w = find(v, dep[v] - dep[u] - 1); // æ±‚å…³é”®ç¥–å…ˆ
          double cnt = sz[v] * (n - sz[w]);
          double len = cnt * (1 + dep[v] - dep[u]) 
                     + f[v] * (n - sz[w]) 
                     + (g[u] - f[w] - sz[w]) * sz[v];
          return len / cnt;
      } else { // æ— ç¥–å…ˆå…³ç³»
          double cnt = sz[u] * sz[v];
          double len = cnt * (1 + dep[u] + dep[v] - 2 * dep[l])
                     + f[u] * sz[v] + f[v] * sz[u];
          return len / cnt;
      }
  }
  ```
- **å­¦ä¹ ç¬”è®°**ï¼šåˆ†ç±»è®¨è®ºæ—¶ï¼Œç¥–å…ˆå…³ç³»çš„åˆ¤æ–­ç›´æ¥å½±å“æ–¹æ¡ˆæ•°è®¡ç®—ã€‚

#### é¢˜è§£ä¸‰ï¼š**EityDawnï¼ˆ2èµï¼‰**
- **äº®ç‚¹**ï¼š
  - ç”¨â€œæŒ–æ‰è·¯å¾„èŠ‚ç‚¹â€æ¯”å–»å­æ ‘åˆ’åˆ†ï¼Œç”ŸåŠ¨å½¢è±¡ã€‚
  - ç‹¬ç«‹è®¡ç®—å­æ ‘å†…å¤–è´¡çŒ®ï¼Œå…¬å¼æ¸…æ™°ã€‚
  - ä»£ç ä¸­ä¼˜å…ˆå¤„ç†è¾¹ç•Œæƒ…å†µï¼ˆå¦‚ \(u = v\)ï¼‰ã€‚
- **å…³é”®æŠ€å·§**ï¼šå®¹æ–¥æ€æƒ³è®¡ç®—å­æ ‘å¤–è·ç¦»å’Œï¼ˆ\(g_u - f_w - sz_w\)ï¼‰ã€‚

---

### æ ¸å¿ƒéš¾ç‚¹è¾¨æä¸è§£é¢˜ç­–ç•¥
#### éš¾ç‚¹ä¸€ï¼šç¥–å…ˆå…³ç³»åˆ¤æ–­
- **é—®é¢˜**ï¼š\(u\) æ˜¯å¦ä¸º \(v\) çš„ç¥–å…ˆå½±å“æ–¹æ¡ˆæ•°è®¡ç®—ã€‚
- **è§£å†³æ–¹æ¡ˆ**ï¼šç”¨ LCA åˆ¤æ–­å…³ç³»ã€‚è‹¥ LCA æ˜¯ \(u\) æˆ– \(v\)ï¼Œåˆ™ä¸ºç¥–å…ˆå…³ç³»ï¼›å¦åˆ™ä¸æ˜¯ã€‚
- **å­¦ä¹ ç¬”è®°**ï¼šLCA æ˜¯æ ‘é—®é¢˜çš„æ ¸å¿ƒå·¥å…·ï¼Œå€å¢æ³•å®ç°é«˜æ•ˆæŸ¥è¯¢ã€‚

#### éš¾ç‚¹äºŒï¼šå­æ ‘å¤–è·ç¦»å’Œè®¡ç®—
- **é—®é¢˜**ï¼šç¥–å…ˆå…³ç³»ä¸­éœ€è®¡ç®—â€œå»é™¤æŸå­æ ‘åï¼Œå…¶ä½™ç‚¹åˆ° \(u\) çš„è·ç¦»å’Œâ€ã€‚
- **è§£å†³æ–¹æ¡ˆ**ï¼šæ¢æ ¹ DP é¢„å¤„ç†å…¨å±€è·ç¦»å’Œ \(g\)ï¼Œå†å‡å»å­æ ‘è´¡çŒ®ï¼š
  \[
  \text{å‰©ä½™è·ç¦»å’Œ} = g_u - (f_w + sz_w)
  \]
- **å­¦ä¹ ç¬”è®°**ï¼šæ¢æ ¹ DP çš„è½¬ç§»æ–¹ç¨‹ \(g_v = g_u - sz_v + (n - sz_v)\) æ˜¯æ ‡å‡†æ¨¡æ¿ã€‚

#### éš¾ç‚¹ä¸‰ï¼šæœŸæœ›å…¬å¼æ•´åˆ
- **é—®é¢˜**ï¼šç¯é•¿ç”±æ–°è¾¹ã€åŸè·¯å¾„ã€å­æ ‘è·¯å¾„ç»„æˆï¼Œéœ€åˆ†é¡¹ç´¯åŠ ã€‚
- **è§£å†³æ–¹æ¡ˆ**ï¼š
  - **éç¥–å…ˆå…³ç³»**ï¼šæœŸæœ› = \(1 + \text{dis}(u,v) + \frac{f_u}{sz_u} + \frac{f_v}{sz_v}\)
  - **ç¥–å…ˆå…³ç³»**ï¼šæœŸæœ› = \(1 + \text{dis}(u,v) + \frac{f_v}{sz_v} + \frac{g_u - f_w - sz_w}{n - sz_w}\)
- **å­¦ä¹ ç¬”è®°**ï¼šåˆ†å­ä¸ºç¯é•¿æ€»å’Œï¼Œåˆ†æ¯ä¸ºæ–¹æ¡ˆæ•°ï¼Œé¿å…å…¬å¼å†—ä½™ã€‚

---

### C++ æ ¸å¿ƒä»£ç å®ç°èµæ
#### é€šç”¨æ ¸å¿ƒå®ç°
```cpp
#include <bits/stdc++.h>
using namespace std;
typedef long long ll;
const int N = 1e5 + 10;

vector<int> G[N];
int n, dep[N], sz[N], fa[N][20];
ll f[N], g[N]; // f:å­æ ‘å†…è·ç¦»å’Œ; g:å…¨å±€è·ç¦»å’Œ

void dfs1(int u, int p) {
    dep[u] = dep[p] + 1;
    sz[u] = 1; fa[u][0] = p;
    for (int i = 1; i < 20; i++) 
        fa[u][i] = fa[fa[u][i-1]][i-1];
    for (int v : G[u]) {
        if (v == p) continue;
        dfs1(v, u);
        sz[u] += sz[v];
        f[u] += f[v] + sz[v];
    }
}

void dfs2(int u, int p) {
    for (int v : G[u]) {
        if (v == p) continue;
        g[v] = g[u] - sz[v] + (n - sz[v]); // æ¢æ ¹DP
        dfs2(v, u);
    }
}

int lca(int u, int v) {
    if (dep[u] < dep[v]) swap(u, v);
    for (int i = 19; i >= 0; i--)
        if (dep[fa[u][i]] >= dep[v]) u = fa[u][i];
    if (u == v) return u;
    for (int i = 19; i >= 0; i--)
        if (fa[u][i] != fa[v][i]) 
            u = fa[u][i], v = fa[v][i];
    return fa[u][0];
}

int kth_anc(int u, int k) {
    for (int i = 0; i < 20; i++)
        if (k & (1 << i)) u = fa[u][i];
    return u;
}

int main() {
    int q; cin >> n >> q;
    for (int i = 1; i < n; i++) {
        int u, v; cin >> u >> v;
        G[u].push_back(v); G[v].push_back(u);
    }
    dfs1(1, 0);
    g[1] = f[1]; dfs2(1, 0);
    while (q--) {
        int u, v; cin >> u >> v;
        if (dep[u] > dep[v]) swap(u, v);
        int l = lca(u, v);
        if (l == u) {
            int k = dep[v] - dep[u] - 1;
            int w = kth_anc(v, k);
            double cnt = (double)sz[v] * (n - sz[w]);
            double len = cnt * (1 + dep[v] - dep[u])
                       + f[v] * (n - sz[w])
                       + (g[u] - f[w] - sz[w]) * sz[v];
            printf("%.8f\n", len / cnt);
        } else {
            double cnt = (double)sz[u] * sz[v];
            double dis_uv = dep[u] + dep[v] - 2 * dep[l];
            double len = cnt * (1 + dis_uv)
                       + f[u] * sz[v] 
                       + f[v] * sz[u];
            printf("%.8f\n", len / cnt);
        }
    }
    return 0;
}
```

#### ä»£ç è§£è¯»æ¦‚è¦
1. **é¢„å¤„ç†**ï¼š`dfs1` è®¡ç®—æ·±åº¦ã€å­æ ‘å¤§å°ã€ç¥–å…ˆæ•°ç»„å’Œå­æ ‘è·ç¦»å’Œ \(f\)ï¼›`dfs2` é€šè¿‡æ¢æ ¹ DP è®¡ç®—å…¨å±€è·ç¦»å’Œ \(g\)ã€‚
2. **æŸ¥è¯¢å¤„ç†**ï¼š
   - ç¥–å…ˆå…³ç³»ï¼šæ±‚å…³é”®ç¥–å…ˆ \(w\)ï¼ŒæŒ‰å…¬å¼è®¡ç®—æœŸæœ›ã€‚
   - éç¥–å…ˆå…³ç³»ï¼šç›´æ¥æŒ‰å…¬å¼è®¡ç®—æœŸæœ›ã€‚
3. **ç²¾åº¦æ§åˆ¶**ï¼š`printf` ä¿ç•™ 8 ä½å°æ•°ã€‚

---

### ç®—æ³•å¯è§†åŒ–ï¼šåƒç´ åŠ¨ç”»æ¼”ç¤º
#### è®¾è®¡æ–¹æ¡ˆ
- **é£æ ¼**ï¼š8 ä½åƒç´ é£ï¼ˆFC çº¢ç™½æœºï¼‰ï¼Œ16 è‰²è°ƒè‰²æ¿ã€‚
- **æ ¸å¿ƒæ¼”ç¤º**ï¼šBFS ç®—æ³•æ‰©å±•è¿‡ç¨‹æ¨¡æ‹Ÿå­æ ‘åˆ’åˆ†ã€‚
- **åŠ¨ç”»æ­¥éª¤**ï¼š
  1. **åˆå§‹åŒ–**ï¼šæ ‘å½¢ç½‘æ ¼åœ°å›¾ï¼Œ\(u\) å’Œ \(v\) é«˜äº®ä¸ºçº¢è‰²ã€‚
  2. **å­æ ‘æ ‡è®°**ï¼š\(u\) çš„å­æ ‘æŸ“è“è‰²ï¼Œ\(v\) çš„å­æ ‘æŸ“ç»¿è‰²ã€‚
  3. **è·¯å¾„æ˜¾ç¤º**ï¼š\(u \to v\) è·¯å¾„ä»¥é»„è‰²é—ªçƒï¼Œä¼´éšâ€œè·¯å¾„éŸ³æ•ˆâ€ã€‚
  4. **æ–°è¾¹è¿æ¥**ï¼šéšæœºé€‰å–è“è‰²å’Œç»¿è‰²èŠ‚ç‚¹è¿æ¥ï¼Œæ˜¾ç¤ºæ–°è¾¹ï¼ˆç´«è‰²ï¼‰ï¼Œæ’­æ”¾â€œè¿æ¥éŸ³æ•ˆâ€ã€‚
  5. **ç¯é•¿è®¡ç®—**ï¼šæ˜¾ç¤ºå…¬å¼åˆ†é¡¹ç´¯åŠ è¿‡ç¨‹ï¼ŒåŒæ­¥æ›´æ–°å˜é‡å€¼ã€‚
- **äº¤äº’æ§åˆ¶**ï¼šæ”¯æŒè°ƒé€Ÿæ»‘å—ï¼ˆ0.5x~2xï¼‰ã€å•æ­¥æ‰§è¡Œã€é‡ç½®æŒ‰é’®ã€‚
- **éŸ³æ•ˆè®¾è®¡**ï¼š
  - å…³é”®æ“ä½œï¼šæ¸…è„†â€œå®â€å£°ï¼ˆå¦‚å­æ ‘åˆ’åˆ†å®Œæˆï¼‰ã€‚
  - é”™è¯¯æç¤ºï¼šçŸ­ä¿ƒèœ‚é¸£ï¼ˆå¦‚æ— è§£æ—¶ï¼‰ã€‚
  - èƒŒæ™¯éŸ³ä¹ï¼š8 ä½å¾ªç¯ BGMã€‚

---

### æ‹“å±•ç»ƒä¹ ä¸ç›¸ä¼¼é—®é¢˜
1. **æ´›è°· P4211 [LNOI2014]LCA**  
   **æ¨èç†ç”±**ï¼šå¼ºåŒ– LCA å’Œè·¯å¾„è´¡çŒ®è®¡ç®—ï¼Œä¸æœ¬é¢˜çš„å­æ ‘å¤–è·ç¦»å’Œæ€æƒ³ç›¸ä¼¼ã€‚
2. **æ´›è°· P1352 æ²¡æœ‰ä¸Šå¸çš„èˆä¼š**  
   **æ¨èç†ç”±**ï¼šåŸºç¡€æ ‘å½¢ DP è®­ç»ƒï¼Œç†è§£çŠ¶æ€è½¬ç§»æ–¹ç¨‹çš„æ¨¡æ¿é¢˜ã€‚
3. **æ´›è°· P3379 ã€æ¨¡æ¿ã€‘æœ€è¿‘å…¬å…±ç¥–å…ˆ**  
   **æ¨èç†ç”±**ï¼šå€å¢æ³• LCA çš„ç»å…¸å®ç°ï¼Œå·©å›ºæœ¬é¢˜æ ¸å¿ƒç®—æ³•ã€‚

---

### å­¦ä¹ å¿ƒå¾—ä¸ç»éªŒåˆ†äº«
> **é¢˜è§£ä½œè€…è°ƒè¯•ç»éªŒ**ï¼ˆæ‘˜è‡ª DiaĞ¾si çš„é¢˜è§£ï¼‰ï¼š  
> â€œåœ¨å®ç°æ¢æ ¹ DP æ—¶ï¼Œè¾¹ç•Œ `g[1] = f[1]` å®¹æ˜“é—æ¼ï¼Œå¯¼è‡´åç»­è®¡ç®—é”™è¯¯ã€‚é€šè¿‡æ‰“å°ä¸­é—´å˜é‡ `g[2]` çš„å€¼ï¼Œæˆ‘å¿«é€Ÿå®šä½äº†é—®é¢˜ã€‚â€

**Kay çš„æ€»ç»“**ï¼š  
1. **è¾¹ç•Œæ£€æŸ¥**ï¼šæ ‘å½¢ DP çš„æ ¹èŠ‚ç‚¹éœ€å•ç‹¬åˆå§‹åŒ–ã€‚
2. **å˜é‡è¿½è¸ª**ï¼šåœ¨ DFS ä¸­æ‰“å°å…³é”®å˜é‡ï¼ˆå¦‚ `f[u]`, `g[u]`ï¼‰å¯æœ‰æ•ˆå®šä½é”™è¯¯ã€‚
3. **æ¨¡å—åŒ–æµ‹è¯•**ï¼šå…ˆéªŒè¯ LCA å’Œå­æ ‘å¤§å°è®¡ç®—ï¼Œå†é€æ­¥æ·»åŠ  DP é€»è¾‘ã€‚

---

> å¸Œæœ›è¿™ä»½æŒ‡å—åŠ©ä½ æ”»å…‹æ­¤é¢˜ï¼ä¸‹æ¬¡ä¸€èµ·æ¢ç´¢æ–°æŒ‘æˆ˜ï¼ğŸ’ª

---
å¤„ç†ç”¨æ—¶ï¼š245.65ç§’
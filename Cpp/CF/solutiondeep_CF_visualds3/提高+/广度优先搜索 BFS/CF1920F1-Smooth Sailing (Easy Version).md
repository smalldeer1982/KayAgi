# é¢˜ç›®ä¿¡æ¯

# Smooth Sailing (Easy Version)

## é¢˜ç›®æè¿°

The only difference between the two versions of this problem is the constraint on $ q $ . You can make hacks only if both versions of the problem are solved.

Thomas is sailing around an island surrounded by the ocean. The ocean and island can be represented by a grid with $ n $ rows and $ m $ columns. The rows are numbered from $ 1 $ to $ n $ from top to bottom, and the columns are numbered from $ 1 $ to $ m $ from left to right. The position of a cell at row $ r $ and column $ c $ can be represented as $ (r, c) $ . Below is an example of a valid grid.

 ![](https://cdn.luogu.com.cn/upload/vjudge_pic/CF1920F1/516df36ca6ac022124866d4043411e04ed0cf48c.png) Example of a valid gridThere are three types of cells: island, ocean and underwater volcano. Cells representing the island are marked with a '\#', cells representing the ocean are marked with a '.', and cells representing an underwater volcano are marked with a 'v'. It is guaranteed that there is at least one island cell and at least one underwater volcano cell. It is also guaranteed that the set of all island cells forms a single connected component $ ^{\dagger} $ and the set of all ocean cells and underwater volcano cells forms a single connected component. Additionally, it is guaranteed that there are no island cells at the edge of the grid (that is, at row $ 1 $ , at row $ n $ , at column $ 1 $ , and at column $ m $ ).

Define a round trip starting from cell $ (x, y) $ as a path Thomas takes which satisfies the following conditions:

- The path starts and ends at $ (x, y) $ .
- If Thomas is at cell $ (i, j) $ , he can go to cells $ (i+1, j) $ , $ (i-1, j) $ , $ (i, j-1) $ , and $ (i, j+1) $ as long as the destination cell is an ocean cell or an underwater volcano cell and is still inside the grid. Note that it is allowed for Thomas to visit the same cell multiple times in the same round trip.
- The path must go around the island and fully encircle it. Some path $ p $ fully encircles the island if it is impossible to go from an island cell to a cell on the grid border by only traveling to adjacent on a side or diagonal cells without visiting a cell on path $ p $ . In the image below, the path starting from $ (2, 2) $ , going to $ (1, 3) $ , and going back to $ (2, 2) $ the other way does not fully encircle the island and is not considered a round trip.

 ![](https://cdn.luogu.com.cn/upload/vjudge_pic/CF1920F1/587237f643ee9a450f570eb64a27b00d982a357b.png) Example of a path that does not fully encircle the islandThe safety of a round trip is the minimum Manhattan distance $ ^{\ddagger} $ from a cell on the round trip to an underwater volcano (note that the presence of island cells does not impact this distance).

You have $ q $ queries. A query can be represented as $ (x, y) $ and for every query, you want to find the maximum safety of a round trip starting from $ (x, y) $ . It is guaranteed that $ (x, y) $ is an ocean cell or an underwater volcano cell.

 $ ^{\dagger} $ A set of cells forms a single connected component if from any cell of this set it is possible to reach any other cell of this set by moving only through the cells of this set, each time going to a cell with a common side.

 $ ^{\ddagger} $ Manhattan distance between cells $ (r_1, c_1) $ and $ (r_2, c_2) $ is equal to $ |r_1 - r_2| + |c_1 - c_2| $ .

## è¯´æ˜/æç¤º

For the first example, the image below shows an optimal round trip starting from $ (1, 1) $ . The round trip has a safety of $ 3 $ as the minimum Manhattan distance from a cell on the round trip to an underwater volcano is $ 3 $ .

 ![](https://cdn.luogu.com.cn/upload/vjudge_pic/CF1920F1/b0d58ba7a9650556e586a3235109c2b13f201dd2.png) Example of an optimal round tripFor the fourth example, remember that it is allowed for Thomas to visit the same cell multiple times in the same round trip. For example, doing so is necessary for the round trip starting from $ (7, 6) $ .

## æ ·ä¾‹ #1

### è¾“å…¥

```
9 9 3
.........
.........
....###..
...v#....
..###....
...##...v
...##....
.........
v........
1 1
9 1
5 7```

### è¾“å‡º

```
3
0
3```

## æ ·ä¾‹ #2

### è¾“å…¥

```
3 3 5
..v
.#.
...
1 2
1 3
2 3
2 1
3 2```

### è¾“å‡º

```
0
0
0
0
0```

## æ ·ä¾‹ #3

### è¾“å…¥

```
14 13 5
.............
.............
.............
...vvvvvvv...
...v.....v...
...v.###.v...
...v.#.#.v...
...v..v..v...
...v..v..v...
....v...v....
.....vvv.....
.............
.............
.............
1 1
7 7
5 6
4 10
13 6```

### è¾“å‡º

```
3
0
1
0
2```

## æ ·ä¾‹ #4

### è¾“å…¥

```
10 11 4
...........
..#######..
..#..#..#..
..#.....#..
..#..v..#..
..#.###.#..
..#.#.#.#..
..#...#.#..
..#####.#..
...........
7 6
3 7
6 8
1 1```

### è¾“å‡º

```
1
2
3
4```

# AIåˆ†æç»“æœ

# ğŸ’¡ Kayçš„C++ç®—æ³•è§£æï¼šSmooth Sailing (Easy Version) æ·±å…¥å­¦ä¹ æŒ‡å— ğŸ’¡


## 1. é¢˜ç›®è§£è¯»ä¸æ ¸å¿ƒç®—æ³•è¯†åˆ«

âœ¨ **æœ¬é¢˜ä¸»è¦è€ƒå¯Ÿ**ï¼šäºŒåˆ†ç­”æ¡ˆ + å¹¿åº¦ä¼˜å…ˆæœç´¢ï¼ˆBFSï¼‰

ğŸ—£ï¸ **åˆæ­¥åˆ†æ**ï¼š  
è§£å†³â€œç¯ç»•å²›å±¿çš„æœ€å¤§å®‰å…¨è·¯å¾„â€é—®é¢˜ï¼Œå…³é”®åœ¨äº**æœ€å¤§åŒ–è·¯å¾„çš„æœ€å°å®‰å…¨å€¼**ï¼ˆè·¯å¾„ä¸Šæ‰€æœ‰ç‚¹åˆ°æœ€è¿‘ç«å±±çš„æ›¼å“ˆé¡¿è·ç¦»çš„æœ€å°å€¼ï¼‰ã€‚è¿™ç§â€œæœ€å°å€¼æœ€å¤§åŒ–â€çš„é—®é¢˜ï¼Œ**äºŒåˆ†ç­”æ¡ˆ**æ˜¯ç»å…¸æ€è·¯â€”â€”æˆ‘ä»¬å¯ä»¥é€šè¿‡äºŒåˆ†çŒœæµ‹ä¸€ä¸ªå®‰å…¨å€¼`k`ï¼Œç„¶åæ£€æŸ¥æ˜¯å¦å­˜åœ¨ä¸€æ¡ç¯ç»•å²›å±¿çš„è·¯å¾„ï¼Œä½¿å¾—è·¯å¾„ä¸Šçš„æ‰€æœ‰ç‚¹çš„å®‰å…¨å€¼éƒ½ä¸å°äº`k`ã€‚  

**æ ¸å¿ƒç®—æ³•æµç¨‹**ï¼š  
1. **é¢„å¤„ç†è·ç¦»**ï¼šç”¨**å¤šæºBFS**è®¡ç®—æ¯ä¸ªç‚¹åˆ°æœ€è¿‘ç«å±±çš„æ›¼å“ˆé¡¿è·ç¦»ï¼ˆè®°ä¸º`dis[i][j]`ï¼‰ã€‚  
2. **äºŒåˆ†ç­”æ¡ˆ**ï¼šå¯¹æ¯ä¸ªæŸ¥è¯¢ï¼ŒäºŒåˆ†`k`çš„å¯èƒ½å–å€¼ï¼ˆ0åˆ°`dis[x][y]`ï¼Œå› ä¸ºèµ·ç‚¹çš„å®‰å…¨å€¼æ˜¯ä¸Šé™ï¼‰ã€‚  
3. **æ£€æŸ¥å¯è¡Œæ€§**ï¼šå¯¹äºå½“å‰`k`ï¼Œç”¨**å•æºBFS**æ ‡è®°ä»èµ·ç‚¹å‡ºå‘èƒ½åˆ°è¾¾çš„ã€å®‰å…¨å€¼â‰¥`k`çš„éå²›å±¿ç‚¹ï¼›å†ç”¨**å…«è¿é€šBFS**æ£€æŸ¥å²›å±¿æ˜¯å¦è¢«è¿™äº›æ ‡è®°ç‚¹åŒ…å›´ï¼ˆå³å²›å±¿æ— æ³•é€šè¿‡å…«è¿é€šè·¯å¾„åˆ°è¾¾ç½‘æ ¼è¾¹ç•Œï¼‰ã€‚  

**å¯è§†åŒ–è®¾è®¡æ€è·¯**ï¼š  
- ç”¨**8ä½åƒç´ é£**å±•ç¤ºç½‘æ ¼ï¼ˆå²›å±¿=æ£•è‰²æ–¹å—ï¼Œç«å±±=çº¢è‰²æ–¹å—ï¼Œå¯è¡Œç‚¹=è“è‰²æ–¹å—ï¼Œè¾¹ç•Œ=ç°è‰²è¾¹æ¡†ï¼‰ã€‚  
- åŠ¨ç”»åˆ†æ­¥å±•ç¤ºï¼šå¤šæºBFSæ‰©æ•£ï¼ˆè·ç¦»ä»ç«å±±ç‚¹å‘å¤–å»¶ä¼¸ï¼Œé¢œè‰²å˜æµ…ï¼‰ã€äºŒåˆ†`k`çš„æ ‡è®°è¿‡ç¨‹ï¼ˆè“è‰²æ–¹å—ä»èµ·ç‚¹æ‰©æ•£ï¼‰ã€å…«è¿é€šæ£€æŸ¥ï¼ˆæ£•è‰²æ–¹å—å°è¯•â€œçªå›´â€åˆ°è¾¹ç•Œï¼Œå¤±è´¥åˆ™æ˜¾ç¤ºâ€œåŒ…å›´æˆåŠŸâ€ï¼‰ã€‚  
- äº¤äº’è®¾è®¡ï¼šå•æ­¥æ‰§è¡Œï¼ˆé€å¸§çœ‹BFSè¿‡ç¨‹ï¼‰ã€è‡ªåŠ¨æ’­æ”¾ï¼ˆå¯è°ƒé€Ÿåº¦ï¼‰ã€é‡ç½®æŒ‰é’®ï¼Œæ­é…â€œå®â€ï¼ˆBFSæ‰©æ•£ï¼‰ã€â€œèƒœåˆ©â€ï¼ˆåŒ…å›´æˆåŠŸï¼‰ç­‰åƒç´ éŸ³æ•ˆï¼Œå¢å¼ºè¶£å‘³æ€§ã€‚  


## 2. ç²¾é€‰ä¼˜è´¨é¢˜è§£å‚è€ƒ

### é¢˜è§£ä¸€ï¼šFL_sleakeï¼ˆæ€è·¯æ¸…æ™°ï¼Œä»£ç ç»“æ„æ˜ç¡®ï¼‰  
* **ç‚¹è¯„**ï¼š  
  è¿™ä»½é¢˜è§£çš„æ€è·¯éå¸¸ç›´ç™½â€”â€”å…ˆé¢„å¤„ç†è·ç¦»ï¼Œå†äºŒåˆ†ç­”æ¡ˆï¼Œæœ€åæ£€æŸ¥å¯è¡Œæ€§ã€‚ä»£ç å°†â€œé¢„å¤„ç†â€â€œæ ‡è®°å¯è¡Œç‚¹â€â€œæ£€æŸ¥åŒ…å›´â€æ‹†åˆ†æˆç‹¬ç«‹æ­¥éª¤ï¼Œé€»è¾‘æ¸…æ™°ã€‚æ¯”å¦‚`Get_dis()`å‡½æ•°ç”¨å¤šæºBFSè®¡ç®—è·ç¦»ï¼Œ`Mark_points()`å‡½æ•°ç”¨å•æºBFSæ ‡è®°å¯è¡Œç‚¹ï¼Œ`check()`å‡½æ•°ç”¨å…«è¿é€šBFSæ£€æŸ¥å²›å±¿æ˜¯å¦èƒ½åˆ°è¾¹ç•Œã€‚è™½ç„¶ä½œè€…æåˆ°vectorç©ºé—´é—®é¢˜ï¼Œä½†ä»£ç æ•´ä½“è§„èŒƒï¼Œå˜é‡åï¼ˆå¦‚`dis`ã€`Mark`ï¼‰å«ä¹‰æ˜ç¡®ï¼Œé€‚åˆåˆå­¦è€…ç†è§£ã€‚  

### é¢˜è§£äºŒï¼šsunkuangzhengï¼ˆä»£ç ç®€æ´ï¼Œå°è£…æ€§å¥½ï¼‰  
* **ç‚¹è¯„**ï¼š  
  æ­¤é¢˜è§£çš„äº®ç‚¹æ˜¯ç”¨**lambdaå‡½æ•°å°è£…BFS**ï¼Œå‡å°‘äº†é‡å¤ä»£ç ã€‚æ¯”å¦‚`bfs`å‡½æ•°å¯ä»¥å¤„ç†å¤šæº/å•æºã€å››è¿é€š/å…«è¿é€šçš„æƒ…å†µï¼Œå¤§å¤§ç®€åŒ–äº†ä»£ç ç»“æ„ã€‚ä½œè€…å°†â€œé¢„å¤„ç†è·ç¦»â€â€œæ ‡è®°å¯è¡Œç‚¹â€â€œæ£€æŸ¥åŒ…å›´â€æ•´åˆåˆ°`sol`å‡½æ•°ä¸­ï¼Œé€»è¾‘ç´§å‡‘ã€‚ä»£ç é£æ ¼ç®€æ´ï¼Œå˜é‡åï¼ˆå¦‚`mk`è¡¨ç¤ºæ ‡è®°ï¼‰æ˜“æ‡‚ï¼Œé€‚åˆå­¦ä¹ å¦‚ä½•å°è£…é‡å¤é€»è¾‘ã€‚  

### é¢˜è§£ä¸‰ï¼šxzy090626ï¼ˆæ£€æŸ¥æ€è·¯å·§å¦™ï¼Œæ•ˆç‡é«˜ï¼‰  
* **ç‚¹è¯„**ï¼š  
  è¿™ä»½é¢˜è§£çš„æ£€æŸ¥æ­¥éª¤å¾ˆæœ‰åˆ›æ„â€”â€”ä»**ç½‘æ ¼è¾¹ç•Œå¼€å§‹å…«è¿é€šBFS**ï¼Œå¦‚æœèƒ½åˆ°è¾¾å²›å±¿ï¼Œåˆ™è¯´æ˜å²›å±¿æœªè¢«åŒ…å›´ï¼ˆ`k`ä¸å¯è¡Œï¼‰ã€‚è¿™ç§æ€è·¯é¿å…äº†ä»å²›å±¿å‡ºå‘çš„é‡å¤è®¡ç®—ï¼Œæé«˜äº†æ•ˆç‡ã€‚ä»£ç ä¸­çš„`chk()`å‡½æ•°å…ˆæ ‡è®°å¯è¡Œç‚¹ï¼Œå†ä»è¾¹ç•Œæ‰©æ•£ï¼Œé€»è¾‘æ¸…æ™°ã€‚å˜é‡åï¼ˆå¦‚`vis`è¡¨ç¤ºè®¿é—®çŠ¶æ€ï¼‰è§„èŒƒï¼Œé€‚åˆå­¦ä¹ å¦‚ä½•ä¼˜åŒ–æ£€æŸ¥æ­¥éª¤ã€‚  


## 3. æ ¸å¿ƒéš¾ç‚¹è¾¨æä¸è§£é¢˜ç­–ç•¥

### 1. **éš¾ç‚¹1ï¼šå¦‚ä½•å¿«é€Ÿè®¡ç®—æ¯ä¸ªç‚¹åˆ°æœ€è¿‘ç«å±±çš„è·ç¦»ï¼Ÿ**  
* **åˆ†æ**ï¼š  
  ç«å±±å¯èƒ½æœ‰å¤šä¸ªï¼Œç›´æ¥å¯¹æ¯ä¸ªç‚¹åšBFSä¼šè¶…æ—¶ã€‚**å¤šæºBFS**æ˜¯è§£å†³è¿™ä¸ªé—®é¢˜çš„å…³é”®â€”â€”å°†æ‰€æœ‰ç«å±±ç‚¹åŒæ—¶åŠ å…¥é˜Ÿåˆ—ï¼Œç„¶ååŒæ­¥æ‰©æ•£ï¼Œè¿™æ ·æ¯ä¸ªç‚¹çš„`dis[i][j]`å°±æ˜¯åˆ°æœ€è¿‘ç«å±±çš„è·ç¦»ã€‚  
* ğŸ’¡ **å­¦ä¹ ç¬”è®°**ï¼šå¤šæºBFSæ˜¯å¤„ç†â€œå¤šèµ·ç‚¹æœ€çŸ­è·¯å¾„â€é—®é¢˜çš„ç¥å™¨ï¼Œæ¯”å¦‚å¤šä¸ªç«æºçš„æ‰©æ•£ã€å¤šä¸ªå•†åº—çš„é…é€èŒƒå›´ç­‰ã€‚  

### 2. **éš¾ç‚¹2ï¼šå¦‚ä½•æ ‡è®°ä»èµ·ç‚¹å‡ºå‘çš„å¯è¡Œç‚¹ï¼Ÿ**  
* **åˆ†æ**ï¼š  
  å¯è¡Œç‚¹éœ€è¦æ»¡è¶³ä¸¤ä¸ªæ¡ä»¶ï¼šâ‘  éå²›å±¿ç‚¹ï¼›â‘¡ å®‰å…¨å€¼â‰¥`k`ã€‚æˆ‘ä»¬å¯ä»¥ç”¨**å•æºBFS**ä»èµ·ç‚¹å‡ºå‘ï¼Œåªèµ°å››è¿é€šçš„å¯è¡Œç‚¹ï¼Œå¹¶ç”¨æ•°ç»„`Mark`æ ‡è®°è¿™äº›ç‚¹ã€‚  
* ğŸ’¡ **å­¦ä¹ ç¬”è®°**ï¼šBFSæ˜¯æ ‡è®°â€œå¯è¾¾åŒºåŸŸâ€çš„å¸¸ç”¨æ–¹æ³•ï¼Œæ¯”å¦‚è¿·å®«ä¸­çš„å¯è¡Œè·¯å¾„ã€æ„ŸæŸ“èŒƒå›´ç­‰ã€‚  

### 3. **éš¾ç‚¹3ï¼šå¦‚ä½•åˆ¤æ–­å²›å±¿æ˜¯å¦è¢«åŒ…å›´ï¼Ÿ**  
* **åˆ†æ**ï¼š  
  æ ¹æ®é¢˜ç›®å®šä¹‰ï¼Œå²›å±¿è¢«åŒ…å›´çš„æ¡ä»¶æ˜¯â€œæ— æ³•é€šè¿‡å…«è¿é€šè·¯å¾„ï¼ˆä¸ç»è¿‡å¯è¡Œç‚¹ï¼‰åˆ°è¾¾è¾¹ç•Œâ€ã€‚æˆ‘ä»¬å¯ä»¥ç”¨**å…«è¿é€šBFS**ä»å²›å±¿å‡ºå‘ï¼Œè‹¥èƒ½èµ°åˆ°è¾¹ç•Œï¼Œåˆ™`k`ä¸å¯è¡Œï¼›å¦åˆ™å¯è¡Œã€‚  
* ğŸ’¡ **å­¦ä¹ ç¬”è®°**ï¼šå…«è¿é€šBFSç”¨äºå¤„ç†â€œå¯¹è§’çº¿å¯è¾¾â€çš„æƒ…å†µï¼Œæ¯”å¦‚åˆ¤æ–­ä¸¤ä¸ªåŒºåŸŸæ˜¯å¦è¿é€šã€æ˜¯å¦è¢«åŒ…å›´ç­‰ã€‚  

### âœ¨ è§£é¢˜æŠ€å·§æ€»ç»“  
- **äºŒåˆ†ç­”æ¡ˆ**ï¼šé‡åˆ°â€œæœ€å¤§å€¼æœ€å°â€æˆ–â€œæœ€å°å€¼æœ€å¤§â€çš„é—®é¢˜ï¼Œä¼˜å…ˆè€ƒè™‘äºŒåˆ†ç­”æ¡ˆã€‚  
- **å¤šæºBFS**ï¼šå¤„ç†å¤šèµ·ç‚¹æœ€çŸ­è·¯å¾„é—®é¢˜ï¼Œæ¯”å•æºBFSæ›´é«˜æ•ˆã€‚  
- **å°è£…é‡å¤é€»è¾‘**ï¼šå°†BFSç­‰é‡å¤ä»£ç å°è£…æˆå‡½æ•°ï¼Œæé«˜ä»£ç å¯è¯»æ€§å’Œå¤ç”¨æ€§ã€‚  


## 4. C++æ ¸å¿ƒä»£ç å®ç°èµæ

### æœ¬é¢˜é€šç”¨æ ¸å¿ƒC++å®ç°å‚è€ƒ  
* **è¯´æ˜**ï¼šç»¼åˆäº†ä¼˜è´¨é¢˜è§£çš„æ€è·¯ï¼Œæä¾›ä¸€ä¸ªæ¸…æ™°çš„æ ¸å¿ƒå®ç°ã€‚  
* **å®Œæ•´æ ¸å¿ƒä»£ç **ï¼š  
  ```cpp
  #include <iostream>
  #include <vector>
  #include <queue>
  using namespace std;

  const int dx4[] = {0, 0, 1, -1};
  const int dy4[] = {1, -1, 0, 0};
  const int dx8[] = {0, 1, 0, -1, 1, -1, -1, 1};
  const int dy8[] = {1, 0, -1, 0, 1, -1, 1, -1};

  int n, m, q;
  vector<string> grid;
  vector<vector<int>> dis;
  vector<vector<bool>> mark;

  void precompute_distance() {
      queue<pair<int, int>> q;
      dis.assign(n, vector<int>(m, -1));
      for (int i = 0; i < n; ++i) {
          for (int j = 0; j < m; ++j) {
              if (grid[i][j] == 'v') {
                  dis[i][j] = 0;
                  q.emplace(i, j);
              }
          }
      }
      while (!q.empty()) {
          auto [x, y] = q.front(); q.pop();
          for (int d = 0; d < 4; ++d) {
              int nx = x + dx4[d], ny = y + dy4[d];
              if (nx >= 0 && nx < n && ny >= 0 && ny < m && dis[nx][ny] == -1) {
                  dis[nx][ny] = dis[x][y] + 1;
                  q.emplace(nx, ny);
              }
          }
      }
  }

  bool check(int k, int sx, int sy) {
      if (dis[sx][sy] < k) return false;
      mark.assign(n, vector<bool>(m, false));
      queue<pair<int, int>> q;
      q.emplace(sx, sy);
      mark[sx][sy] = true;
      while (!q.empty()) {
          auto [x, y] = q.front(); q.pop();
          for (int d = 0; d < 4; ++d) {
              int nx = x + dx4[d], ny = y + dy4[d];
              if (nx >= 0 && nx < n && ny >= 0 && ny < m && !mark[nx][ny] && grid[nx][ny] != '#' && dis[nx][ny] >= k) {
                  mark[nx][ny] = true;
                  q.emplace(nx, ny);
              }
          }
      }
      vector<vector<bool>> vis(n, vector<bool>(m, false));
      queue<pair<int, int>> q_isl;
      for (int i = 0; i < n; ++i) {
          for (int j = 0; j < m; ++j) {
              if (grid[i][j] == '#') {
                  q_isl.emplace(i, j);
                  vis[i][j] = true;
              }
          }
      }
      while (!q_isl.empty()) {
          auto [x, y] = q_isl.front(); q_isl.pop();
          if (x == 0 || x == n-1 || y == 0 || y == m-1) return false;
          for (int d = 0; d < 8; ++d) {
              int nx = x + dx8[d], ny = y + dy8[d];
              if (nx >= 0 && nx < n && ny >= 0 && ny < m && !vis[nx][ny] && !mark[nx][ny]) {
                  vis[nx][ny] = true;
                  q_isl.emplace(nx, ny);
              }
          }
      }
      return true;
  }

  int main() {
      ios::sync_with_stdio(false);
      cin.tie(nullptr);
      cin >> n >> m >> q;
      grid.resize(n);
      for (int i = 0; i < n; ++i) {
          cin >> grid[i];
      }
      precompute_distance();
      while (q--) {
          int x, y;
          cin >> x >> y;
          x--; y--; // è½¬æ¢ä¸º0-basedç´¢å¼•
          int l = 0, r = dis[x][y], ans = 0;
          while (l <= r) {
              int mid = (l + r) / 2;
              if (check(mid, x, y)) {
                  ans = mid;
                  l = mid + 1;
              } else {
                  r = mid - 1;
              }
          }
          cout << ans << '\n';
      }
      return 0;
  }
  ```  
* **ä»£ç è§£è¯»æ¦‚è¦**ï¼š  
  1. `precompute_distance()`ï¼šç”¨å¤šæºBFSè®¡ç®—æ¯ä¸ªç‚¹åˆ°æœ€è¿‘ç«å±±çš„è·ç¦»ã€‚  
  2. `check()`ï¼šåˆ¤æ–­å½“å‰`k`æ˜¯å¦å¯è¡Œâ€”â€”å…ˆæ ‡è®°å¯è¡Œç‚¹ï¼Œå†æ£€æŸ¥å²›å±¿æ˜¯å¦è¢«åŒ…å›´ã€‚  
  3. `main()`ï¼šè¯»å–è¾“å…¥ï¼Œé¢„å¤„ç†è·ç¦»ï¼Œå¤„ç†æ¯ä¸ªæŸ¥è¯¢ï¼ˆäºŒåˆ†ç­”æ¡ˆ+è°ƒç”¨`check()`ï¼‰ã€‚  

### é¢˜è§£ä¸€ï¼ˆFL_sleakeï¼‰äº®ç‚¹ç‰‡æ®µ  
* **äº®ç‚¹**ï¼š`Mark_points()`å‡½æ•°ç”¨å•æºBFSæ ‡è®°å¯è¡Œç‚¹ï¼Œé€»è¾‘æ¸…æ™°ã€‚  
* **æ ¸å¿ƒä»£ç ç‰‡æ®µ**ï¼š  
  ```cpp
  void Mark_points(int k) {
      for (int i = 1; i <= n; ++i) Mark[i] = vector<bool>(m+5, 0);
      while (!q.empty()) q.pop();
      q.push({stx, sty});
      Mark[stx][sty] = 1;
      while (!q.empty()) {
          node u = q.front(); q.pop();
          for (int i = 0; i < 4; ++i) {
              int tx = u.x + dx[i], ty = u.y + dy[i];
              if (s[tx][ty] == '#') continue;
              if (tx < 1 || tx > n || ty < 1 || ty > m || dis[tx][ty] < k || Mark[tx][ty]) continue;
              Mark[tx][ty] = 1;
              q.push({tx, ty});
          }
      }
  }
  ```  
* **ä»£ç è§£è¯»**ï¼š  
  ä»èµ·ç‚¹`(stx, sty)`å‡ºå‘ï¼Œç”¨å››è¿é€šBFSæ ‡è®°æ‰€æœ‰å®‰å…¨å€¼â‰¥`k`çš„éå²›å±¿ç‚¹ã€‚`Mark`æ•°ç»„è®°å½•è¿™äº›ç‚¹ï¼Œé¿å…é‡å¤è®¿é—®ã€‚  
* ğŸ’¡ **å­¦ä¹ ç¬”è®°**ï¼šBFSæ ‡è®°å¯è¾¾åŒºåŸŸæ—¶ï¼Œè¦æ³¨æ„è¾¹ç•Œæ¡ä»¶ï¼ˆå¦‚æ˜¯å¦è¶Šç•Œã€æ˜¯å¦æ˜¯å²›å±¿ï¼‰ã€‚  

### é¢˜è§£äºŒï¼ˆsunkuangzhengï¼‰äº®ç‚¹ç‰‡æ®µ  
* **äº®ç‚¹**ï¼šç”¨lambdaå‡½æ•°å°è£…BFSï¼Œå‡å°‘é‡å¤ä»£ç ã€‚  
* **æ ¸å¿ƒä»£ç ç‰‡æ®µ**ï¼š  
  ```cpp
  auto bfs = [&](vector<pair<int,int>> st, int op) {
      queue<pair<int,int>> q;
      for (int i = 1; i <= n; ++i) for (int j = 1; j <= m; ++j) dis[i][j] = -1;
      for (auto [x,y] : st) if (!mk[x][y]) dis[x][y] = 0, q.emplace(x,y);
      while (q.size()) {
          auto [x,y] = q.front(); q.pop();
          for (int i = 1; i <= (op ? 4 : 8); ++i) {
              int ax = x + dx[i], ay = y + dy[i];
              if (ax >= 1 && ax <= n && ay >= 1 && ay <= m && !mk[ax][ay] && dis[ax][ay] == -1) {
                  q.emplace(ax, ay);
                  dis[ax][ay] = dis[x][y] + 1;
              }
          }
      }
  };
  ```  
* **ä»£ç è§£è¯»**ï¼š  
  `bfs`å‡½æ•°æ¥å—èµ·ç‚¹åˆ—è¡¨`st`å’Œæ“ä½œç±»å‹`op`ï¼ˆ`op=1`è¡¨ç¤ºå››è¿é€šï¼Œ`op=0`è¡¨ç¤ºå…«è¿é€šï¼‰ï¼Œå¤„ç†å¤šæºBFSã€‚è¿™ç§å°è£…æ–¹å¼å¯ä»¥å¤ç”¨ä»£ç ï¼Œæ¯”å¦‚é¢„å¤„ç†è·ç¦»ã€æ ‡è®°å¯è¡Œç‚¹ã€æ£€æŸ¥åŒ…å›´éƒ½å¯ä»¥ç”¨è¿™ä¸ªå‡½æ•°ã€‚  
* ğŸ’¡ **å­¦ä¹ ç¬”è®°**ï¼šlambdaå‡½æ•°æ˜¯C++11åŠä»¥ä¸Šçš„ç‰¹æ€§ï¼Œé€‚åˆå°è£…çŸ­æ—¶é—´å†…ä½¿ç”¨çš„å‡½æ•°ï¼Œæé«˜ä»£ç å¯è¯»æ€§ã€‚  

### é¢˜è§£ä¸‰ï¼ˆxzy090626ï¼‰äº®ç‚¹ç‰‡æ®µ  
* **äº®ç‚¹**ï¼šä»è¾¹ç•Œå¼€å§‹å…«è¿é€šBFSï¼Œæ£€æŸ¥æ˜¯å¦èƒ½åˆ°è¾¾å²›å±¿ï¼Œæ€è·¯å·§å¦™ã€‚  
* **æ ¸å¿ƒä»£ç ç‰‡æ®µ**ï¼š  
  ```cpp
  bool chk(int w) {
      // æ ‡è®°å¯è¡Œç‚¹ï¼ˆç•¥ï¼‰
      for (int i = 0; i <= n+1; ++i) {
          vis[i][0] = vis[i][m+1] = 1;
          q.push({i, 0}), q.push({i, m+1});
      }
      for (int i = 0; i <= m+1; ++i) {
          vis[0][i] = vis[n+1][i] = 1;
          q.push({0, i}), q.push({n+1, i});
      }
      while (!q.empty()) {
          auto u = q.front(); q.pop();
          for (int i = 0; i < 8; ++i) {
              int x = u.x + px[i], y = u.y + py[i];
              if (x < 0 || y < 0 || x > n+1 || y > m+1) continue;
              if (s[x][y] == '#') {
                  while (!q.empty()) q.pop();
                  return 0;
              }
              if (vis[x][y]) continue;
              vis[x][y] = 1;
              q.push({x, y});
          }
      }
      return 1;
  }
  ```  
* **ä»£ç è§£è¯»**ï¼š  
  ä»ç½‘æ ¼è¾¹ç•Œï¼ˆåŒ…æ‹¬è™šæ‹Ÿçš„è¾¹ç•Œ`0`å’Œ`n+1`ï¼‰å¼€å§‹å…«è¿é€šBFSï¼Œå¦‚æœèƒ½åˆ°è¾¾å²›å±¿ï¼ˆ`s[x][y] == '#'`ï¼‰ï¼Œåˆ™è¯´æ˜å²›å±¿æœªè¢«åŒ…å›´ï¼ˆ`k`ä¸å¯è¡Œï¼‰ã€‚è¿™ç§æ€è·¯é¿å…äº†ä»å²›å±¿å‡ºå‘çš„é‡å¤è®¡ç®—ï¼Œæé«˜äº†æ•ˆç‡ã€‚  
* ğŸ’¡ **å­¦ä¹ ç¬”è®°**ï¼šæœ‰æ—¶å€™æ¢ä¸ªè§’åº¦ï¼ˆæ¯”å¦‚ä»è¾¹ç•Œè€Œä¸æ˜¯å²›å±¿å‡ºå‘ï¼‰ï¼Œå¯ä»¥ç®€åŒ–é—®é¢˜ã€‚  


## 5. ç®—æ³•å¯è§†åŒ–ï¼šåƒç´ åŠ¨ç”»æ¼”ç¤º (æ ¸å¿ƒéƒ¨åˆ†)

### åŠ¨ç”»æ¼”ç¤ºä¸»é¢˜  
**åƒç´ æ¢é™©å®¶ï¼šç¯ç»•å²›å±¿çš„å®‰å…¨è·¯å¾„**ï¼ˆä»¿FCçº¢ç™½æœºé£æ ¼ï¼‰  

### æ ¸å¿ƒæ¼”ç¤ºå†…å®¹  
1. **ç½‘æ ¼åˆå§‹åŒ–**ï¼šç”¨8ä½åƒç´ å—å±•ç¤ºç½‘æ ¼ï¼ˆå²›å±¿=æ£•è‰²æ–¹å—ï¼Œç«å±±=çº¢è‰²æ–¹å—ï¼Œèµ·ç‚¹=ç»¿è‰²æ–¹å—ï¼Œè¾¹ç•Œ=ç°è‰²è¾¹æ¡†ï¼‰ã€‚  
2. **å¤šæºBFSé¢„å¤„ç†è·ç¦»**ï¼šä»ç«å±±ç‚¹ï¼ˆçº¢è‰²ï¼‰å¼€å§‹ï¼Œè“è‰²é€æ¸æ‰©æ•£ï¼Œé¢œè‰²æ·±æµ…è¡¨ç¤ºè·ç¦»ï¼ˆæµ…è“=è¿œï¼Œæ·±è“=è¿‘ï¼‰ã€‚  
3. **äºŒåˆ†ç­”æ¡ˆè¿‡ç¨‹**ï¼šå±å¹•é¡¶éƒ¨æ˜¾ç¤ºå½“å‰`k`å€¼ï¼ˆå¦‚`k=3`ï¼‰ï¼Œä»èµ·ç‚¹ï¼ˆç»¿è‰²ï¼‰å‡ºå‘ï¼Œè“è‰²æ–¹å—ï¼ˆå¯è¡Œç‚¹ï¼‰é€æ¸æ‰©æ•£ï¼Œæ ‡è®°æ‰€æœ‰å®‰å…¨å€¼â‰¥`k`çš„ç‚¹ã€‚  
4. **æ£€æŸ¥åŒ…å›´è¿‡ç¨‹**ï¼šå²›å±¿ï¼ˆæ£•è‰²ï¼‰å°è¯•ç”¨å…«è¿é€šè·¯å¾„â€œçªå›´â€åˆ°è¾¹ç•Œï¼ˆç°è‰²ï¼‰ï¼Œå¦‚æœè“è‰²æ–¹å—ï¼ˆå¯è¡Œç‚¹ï¼‰é˜»æŒ¡äº†æ‰€æœ‰è·¯å¾„ï¼Œå²›å±¿æ— æ³•åˆ°è¾¾è¾¹ç•Œï¼Œåˆ™æ˜¾ç¤ºâ€œåŒ…å›´æˆåŠŸâ€ï¼ˆä¼´éšèƒœåˆ©éŸ³æ•ˆï¼‰ï¼›å¦åˆ™æ˜¾ç¤ºâ€œåŒ…å›´å¤±è´¥â€ï¼ˆä¼´éšå¤±è´¥éŸ³æ•ˆï¼‰ã€‚  

### è®¾è®¡æ€è·¯ç®€è¿°  
- **åƒç´ é£æ ¼**ï¼šç”¨ç®€å•çš„æ–¹å—å’Œæœ‰é™çš„é¢œè‰²ï¼ˆ8-16è‰²ï¼‰ï¼Œè¥é€ å¤å¤æ¸¸æˆæ°›å›´ï¼Œé™ä½è§†è§‰è´Ÿæ‹…ã€‚  
- **åŠ¨ç”»åˆ†æ­¥**ï¼šå°†å¤æ‚çš„ç®—æ³•æ‹†åˆ†æˆå¤šä¸ªå°æ­¥éª¤ï¼ˆé¢„å¤„ç†â†’äºŒåˆ†â†’æ£€æŸ¥ï¼‰ï¼Œé€å¸§å±•ç¤ºï¼Œå¸®åŠ©ç†è§£æ¯ä¸€æ­¥çš„ä½œç”¨ã€‚  
- **äº¤äº’è®¾è®¡**ï¼š  
  - æ§åˆ¶é¢æ¿ï¼šâ€œå¼€å§‹/æš‚åœâ€â€œå•æ­¥æ‰§è¡Œâ€â€œé‡ç½®â€æŒ‰é’®ï¼Œé€Ÿåº¦æ»‘å—ï¼ˆè°ƒèŠ‚åŠ¨ç”»é€Ÿåº¦ï¼‰ã€‚  
  - éŸ³æ•ˆï¼šBFSæ‰©æ•£æ—¶çš„â€œå®â€å£°ï¼ˆæ¯æ‰©æ•£ä¸€ä¸ªç‚¹ï¼‰ï¼ŒåŒ…å›´æˆåŠŸæ—¶çš„â€œèƒœåˆ©â€å£°ï¼ˆä¸Šæ‰¬éŸ³è°ƒï¼‰ï¼ŒåŒ…å›´å¤±è´¥æ—¶çš„â€œå¤±è´¥â€å£°ï¼ˆçŸ­ä¿ƒéŸ³è°ƒï¼‰ã€‚  
  - AIè‡ªåŠ¨æ¼”ç¤ºï¼šç‚¹å‡»â€œAIè‡ªåŠ¨â€æŒ‰é’®ï¼ŒåŠ¨ç”»ä¼šè‡ªåŠ¨æ‰§è¡Œæ•´ä¸ªæµç¨‹ï¼Œåƒâ€œè´ªåƒè›‡AIâ€ä¸€æ ·å±•ç¤ºç®—æ³•çš„æ¯ä¸€æ­¥ã€‚  

### å…³é”®å¸§ç¤ºæ„å›¾  
| æ­¥éª¤ | ç”»é¢æè¿° |  
|------|----------|  
| 1    | ç½‘æ ¼æ˜¾ç¤ºï¼šæ£•è‰²å²›å±¿åœ¨ä¸­é—´ï¼Œçº¢è‰²ç«å±±åœ¨å‘¨å›´ï¼Œç»¿è‰²èµ·ç‚¹åœ¨å·¦ä¸‹è§’ã€‚ |  
| 2    | è“è‰²ä»ç«å±±ç‚¹æ‰©æ•£ï¼Œé€æ¸è¦†ç›–æ•´ä¸ªç½‘æ ¼ï¼Œé¢œè‰²æ·±æµ…è¡¨ç¤ºè·ç¦»ã€‚ |  
| 3    | è“è‰²ä»èµ·ç‚¹æ‰©æ•£ï¼Œæ ‡è®°å¯è¡Œç‚¹ï¼ˆå®‰å…¨å€¼â‰¥`k`ï¼‰ã€‚ |  
| 4    | æ£•è‰²å²›å±¿å°è¯•çªå›´ï¼Œè“è‰²æ–¹å—é˜»æŒ¡ï¼Œæ— æ³•åˆ°è¾¾è¾¹ç•Œï¼Œæ˜¾ç¤ºâ€œåŒ…å›´æˆåŠŸâ€ã€‚ |  


## 6. æ‹“å±•ç»ƒä¹ ä¸ç›¸ä¼¼é—®é¢˜æ€è€ƒ

### é€šç”¨æ€è·¯/æŠ€å·§è¿ç§»  
- **äºŒåˆ†ç­”æ¡ˆ**ï¼šé€‚ç”¨äºâ€œæœ€å¤§å€¼æœ€å°â€æˆ–â€œæœ€å°å€¼æœ€å¤§â€çš„é—®é¢˜ï¼Œæ¯”å¦‚â€œè·³çŸ³å¤´â€ï¼ˆæ±‚æœ€å°è·³è·ƒè·ç¦»çš„æœ€å¤§å€¼ï¼‰ã€â€œç…è›‹é—®é¢˜â€ï¼ˆæ±‚æœ€å¤§ç…è›‹å¤§å°ï¼‰ã€‚  
- **å¤šæºBFS**ï¼šé€‚ç”¨äºå¤šèµ·ç‚¹æœ€çŸ­è·¯å¾„é—®é¢˜ï¼Œæ¯”å¦‚â€œå¤šä¸ªç«æºçš„æ‰©æ•£æ—¶é—´â€â€œå¤šä¸ªå•†åº—çš„é…é€èŒƒå›´â€ã€‚  
- **å…«è¿é€šBFS**ï¼šé€‚ç”¨äºéœ€è¦è€ƒè™‘å¯¹è§’çº¿çš„é—®é¢˜ï¼Œæ¯”å¦‚â€œåˆ¤æ–­ä¸¤ä¸ªåŒºåŸŸæ˜¯å¦è¿é€šâ€â€œæ˜¯å¦è¢«åŒ…å›´â€ã€‚  

### ç»ƒä¹ æ¨è (æ´›è°·)  
1. **æ´›è°· P1824** - ç…è›‹é—®é¢˜  
   ğŸ—£ï¸ **æ¨èç†ç”±**ï¼šè¿™é“é¢˜æ˜¯â€œæœ€å¤§å€¼æœ€å°â€é—®é¢˜çš„ç»å…¸æ¡ˆä¾‹ï¼Œéœ€è¦ç”¨äºŒåˆ†ç­”æ¡ˆ+BFSåˆ¤æ–­æ˜¯å¦å­˜åœ¨å¯è¡ŒåŒºåŸŸï¼Œä¸æœ¬é¢˜æ€è·¯é«˜åº¦ç›¸ä¼¼ã€‚  
2. **æ´›è°· P2678** - è·³çŸ³å¤´  
   ğŸ—£ï¸ **æ¨èç†ç”±**ï¼šè¿™é“é¢˜æ˜¯â€œæœ€å°å€¼æœ€å¤§â€é—®é¢˜çš„ç»å…¸æ¡ˆä¾‹ï¼Œéœ€è¦ç”¨äºŒåˆ†ç­”æ¡ˆ+è´ªå¿ƒåˆ¤æ–­æ˜¯å¦æ»¡è¶³æ¡ä»¶ï¼Œå¸®åŠ©å·©å›ºäºŒåˆ†ç­”æ¡ˆçš„æ€è·¯ã€‚  
3. **æ´›è°· P3953** - é€›å…¬å›­  
   ğŸ—£ï¸ **æ¨èç†ç”±**ï¼šè¿™é“é¢˜éœ€è¦ç”¨äºŒåˆ†ç­”æ¡ˆ+SPFAï¼ˆ shortest path faster algorithm ï¼‰å¤„ç†å›¾ä¸­çš„è·¯å¾„é—®é¢˜ï¼Œæ˜¯æœ¬é¢˜çš„è¿›é˜¶ç‰ˆï¼Œå¸®åŠ©æ‹“å±•æ€è·¯ã€‚  


## 7. å­¦ä¹ å¿ƒå¾—ä¸ç»éªŒåˆ†äº« (è‹¥æœ‰)

### å‚è€ƒç»éªŒ (æ¥è‡ª FL_sleake)  
> â€œæˆ‘åœ¨è§£å†³è¿™ä¸ªé—®é¢˜æ—¶ï¼Œæœ€åˆåœ¨vectorçš„ç©ºé—´é—®é¢˜ä¸Šå¡äº†å¥½å‡ å‘ã€‚åæ¥å‘ç°æ˜¯å› ä¸ºvectorçš„å¤§å°æ²¡æœ‰æ­£ç¡®åˆå§‹åŒ–ï¼Œå¯¼è‡´è¶Šç•Œé”™è¯¯ã€‚â€  
* **ç‚¹è¯„**ï¼š  
  è¿™ä½ä½œè€…çš„ç»éªŒå¾ˆå…¸å‹ã€‚åœ¨ä½¿ç”¨vectorå¤„ç†ç½‘æ ¼æ—¶ï¼Œä¸€å®šè¦æ³¨æ„åˆå§‹åŒ–çš„å¤§å°ï¼ˆæ¯”å¦‚`vector<vector<int>> dis(n, vector<int>(m, -1))`ï¼‰ï¼Œé¿å…è¶Šç•Œã€‚å¦‚æœé‡åˆ°å¥‡æ€ªçš„ runtime errorï¼Œä¸å¦¨æ£€æŸ¥ä¸€ä¸‹vectorçš„å¤§å°æ˜¯å¦æ­£ç¡®ã€‚  

### å‚è€ƒç»éªŒ (æ¥è‡ª sunkuangzheng)  
> â€œæˆ‘æŠŠBFSå°è£…æˆäº†lambdaå‡½æ•°ï¼Œè¿™æ ·å¯ä»¥å‡å°‘é‡å¤ä»£ç ï¼Œè®©ä»£ç æ›´ç®€æ´ã€‚â€  
* **ç‚¹è¯„**ï¼š  
  ä»£ç å°è£…æ˜¯æé«˜å¯è¯»æ€§å’Œå¤ç”¨æ€§çš„å…³é”®ã€‚æ¯”å¦‚å°†BFSå°è£…æˆå‡½æ•°ï¼Œå¯ä»¥é¿å…åœ¨é¢„å¤„ç†ã€æ ‡è®°ã€æ£€æŸ¥æ—¶å†™é‡å¤çš„ä»£ç ã€‚åˆå­¦è€…å¯ä»¥å°è¯•å°†å¸¸ç”¨çš„é€»è¾‘ï¼ˆå¦‚BFSã€DFSï¼‰å°è£…æˆå‡½æ•°ï¼Œé€æ¸å…»æˆè‰¯å¥½çš„ä»£ç ä¹ æƒ¯ã€‚  


## ç»“è¯­  
æœ¬æ¬¡å…³äºâ€œSmooth Sailing (Easy Version)â€çš„C++è§£é¢˜åˆ†æå°±åˆ°è¿™é‡Œã€‚å¸Œæœ›è¿™ä»½å­¦ä¹ æŒ‡å—èƒ½å¸®åŠ©å¤§å®¶ç†è§£**äºŒåˆ†ç­”æ¡ˆ+BFS**çš„æ ¸å¿ƒæ€è·¯ï¼ŒæŒæ¡è§£å†³â€œæœ€å°å€¼æœ€å¤§åŒ–â€é—®é¢˜çš„æŠ€å·§ã€‚è®°ä½ï¼Œç¼–ç¨‹çš„ä¹è¶£åœ¨äºä¸æ–­æ¢ç´¢å’Œå°è¯•â€”â€”ä¸‹æ¬¡é‡åˆ°ç±»ä¼¼é—®é¢˜æ—¶ï¼Œä¸å¦¨è¯•è¯•ä»Šå¤©å­¦çš„æ–¹æ³•ï¼Œç›¸ä¿¡ä½ ä¼šæœ‰æ–°çš„æ”¶è·ï¼ğŸ’ª  

å¦‚æœæœ‰ä»»ä½•ç–‘é—®ï¼Œæ¬¢è¿éšæ—¶å‘æˆ‘æé—®ï¼Œæˆ‘ä¼šå°½åŠ›å¸®åŠ©ä½ ï¼ğŸš€

---
å¤„ç†ç”¨æ—¶ï¼š213.69ç§’
# é¢˜ç›®ä¿¡æ¯

# Strictly Positive Matrix

## é¢˜ç›®æè¿°

You have matrix $ a $ of size $ nÃ—n $ . Let's number the rows of the matrix from $ 1 $ to $ n $ from top to bottom, let's number the columns from $ 1 $ to $ n $ from left to right. Let's use $ a_{ij} $ to represent the element on the intersection of the $ i $ -th row and the $ j $ -th column.

Matrix $ a $ meets the following two conditions:

- for any numbers $ i,j $ ( $ 1<=i,j<=n $ ) the following inequality holds: $ a_{ij}>=0 $ ;
- ![](https://cdn.luogu.com.cn/upload/vjudge_pic/CF402E/5a3402d889c26bb1dab24aca748b24c9c6e8398d.png).

Matrix $ b $ is strictly positive, if for any numbers $ i,j $ ( $ 1<=i,j<=n $ ) the inequality $ b_{ij}&gt;0 $ holds. You task is to determine if there is such integer $ k>=1 $ , that matrix $ a^{k} $ is strictly positive.

## æ ·ä¾‹ #1

### è¾“å…¥

```
2
1 0
0 1
```

### è¾“å‡º

```
NO
```

## æ ·ä¾‹ #2

### è¾“å…¥

```
5
4 5 6 1 2
1 2 3 4 5
6 4 1 2 4
1 1 1 1 1
4 4 4 4 4
```

### è¾“å‡º

```
YES
```

# AIåˆ†æç»“æœ


### ğŸ’¡ Kayçš„C++ç®—æ³•è§£æï¼šStrictly Positive Matrix æ·±å…¥å­¦ä¹ æŒ‡å— ğŸ’¡

**å¼•è¨€**  
ä»Šå¤©æˆ‘ä»¬ä¸€èµ·åˆ†æCF402Eé¢˜"Strictly Positive Matrix"ã€‚è¿™é“é¢˜è€ƒå¯Ÿå›¾è®ºä¸­çš„å¼ºè¿é€šæ€§åˆ¤æ–­ï¼Œæœ¬æŒ‡å—å°†å¸®åŠ©ä½ æŒæ¡æ ¸å¿ƒç®—æ³•å’Œè§£é¢˜æŠ€å·§ã€‚

---

## 1. é¢˜ç›®è§£è¯»ä¸æ ¸å¿ƒç®—æ³•è¯†åˆ«

âœ¨ **æœ¬é¢˜ä¸»è¦è€ƒå¯Ÿ**ï¼š`å›¾è®ºï¼ˆå¼ºè¿é€šåˆ†é‡ï¼‰`

ğŸ—£ï¸ **åˆæ­¥åˆ†æ**ï¼š
> æœ¬é¢˜å¯æ¯”å–»ä¸ºåŸå¸‚äº¤é€šç½‘ç»œï¼šçŸ©é˜µå…ƒç´ çœ‹ä½œåŸå¸‚é—´çš„å•å‘é“è·¯ï¼ˆ>0è¡¨ç¤ºé€šè·¯ï¼‰ï¼Œéœ€åˆ¤æ–­æ˜¯å¦å­˜åœ¨æŸå¤©ï¼ˆkï¼‰ä½¿å¾—ä»»æ„ä¸¤åŸå¸‚éƒ½æœ‰ç›´è¾¾è·¯çº¿ï¼ˆä¸¥æ ¼æ­£çŸ©é˜µï¼‰ã€‚  
> - **æ ¸å¿ƒæ€è·¯**ï¼šå°†çŸ©é˜µè½¬ä¸ºé‚»æ¥å›¾ï¼ˆ>0ä¸ºè¾¹ï¼‰ï¼Œåˆ©ç”¨å¼ºè¿é€šåˆ†é‡ï¼ˆSCCï¼‰åˆ¤æ–­å…¨å›¾è¿é€šæ€§
> - **ç®—æ³•æµç¨‹**ï¼š  
>   1. å°†æ­£å…ƒç´ è½¬ä¸ºæœ‰å‘è¾¹  
>   2. è®¡ç®—SCCæ•°é‡  
>   3. ä»…å½“SCC=1æ—¶å­˜åœ¨æ»¡è¶³æ¡ä»¶çš„k  
> - **å¯è§†åŒ–è®¾è®¡**ï¼šé‡‡ç”¨8ä½åƒç´ é£æ¨¡æ‹ŸåŸå¸‚äº¤é€šç½‘ï¼ˆèŠ‚ç‚¹ä¸ºåƒç´ æ–¹å—ï¼‰ï¼Œç”¨ä¸åŒé¢œè‰²åŒºåˆ†ï¼š  
>   - ç™½è‰²ï¼šæœªè®¿é—®èŠ‚ç‚¹  
>   - é»„è‰²ï¼šå½“å‰å¤„ç†èŠ‚ç‚¹  
>   - ç»¿è‰²ï¼šå·²è®¿é—®èŠ‚ç‚¹  
>   - çº¢è‰²é—ªçƒï¼šå‘ç°SCCè¾¹ç•Œ  
>   - é€šå…³éŸ³æ•ˆï¼šå½“å…¨å›¾è¿é€šæ—¶æ’­æ”¾èƒœåˆ©éŸ³æ•ˆ  

---

## 2. ç²¾é€‰ä¼˜è´¨é¢˜è§£å‚è€ƒ

**é¢˜è§£ä¸€ï¼šMihariï¼ˆTarjanç¼©ç‚¹ï¼‰**  
* **ç‚¹è¯„**ï¼šæ€è·¯æ¸…æ™°æŒ‡å‡º01çŸ©é˜µè½¬æ¢åŸç†ï¼Œå‡†ç¡®å»ºç«‹å›¾è®ºæ¨¡å‹ï¼›ä»£ç è§„èŒƒä½¿ç”¨æ ‡å‡†Tarjanæ¨¡æ¿ï¼›ç®—æ³•æœ‰æ•ˆæ€§é«˜ï¼ˆO(nÂ²)å¤æ‚åº¦ï¼‰ï¼›å®è·µä»·å€¼å¼ºï¼ˆç›´æ¥è¾“å‡ºYES/NOï¼‰ã€‚äº®ç‚¹åœ¨äºç»“åˆè‡ªç¯æ¡ä»¶è§£é‡Šå¼ºè¿é€šå……åˆ†æ€§ã€‚

**é¢˜è§£äºŒï¼šfzj2007ï¼ˆFloyd+bitsetï¼‰**  
* **ç‚¹è¯„**ï¼šåˆ›æ–°ä½¿ç”¨bitsetä¼˜åŒ–ä¼ é€’é—­åŒ…ï¼Œæ—¶ç©ºæ•ˆç‡ä¼˜å¼‚ï¼›ä»£ç ç®€æ´ï¼ˆä»…20è¡Œï¼‰ï¼›å˜é‡å‘½ååˆç†ï¼ˆf[i]è¡¨èŠ‚ç‚¹å¯è¾¾æ€§ï¼‰ï¼›å¯å‘æ€§å¼ºï¼ˆå±•ç¤ºéé€’å½’è§£æ³•ï¼‰ã€‚éœ€æ³¨æ„nè¾ƒå¤§æ—¶Floydçš„ç†è®ºå¤æ‚åº¦ã€‚

**é¢˜è§£ä¸‰ï¼šå°ç¦ç”¨æˆ·ï¼ˆåŒå‘BFSï¼‰**  
* **ç‚¹è¯„**ï¼šæ€è·¯å·§å¦™åˆ©ç”¨åå›¾åˆ¤æ–­è¿é€šæ€§ï¼›ä»£ç å®ç°ç®€æ´ï¼ˆä¸¤æ¬¡BFSï¼‰ï¼›å…³é”®å˜é‡visæ ‡è®°çŠ¶æ€æ˜ç¡®ï¼›å®è·µè°ƒè¯•å‹å¥½ï¼ˆé¿å…é€’å½’æ ˆæº¢å‡ºï¼‰ã€‚äº®ç‚¹åœ¨äºç»“åˆè‡ªç¯ç‰¹æ€§ç»™å‡ºä¸¥è°¨æ•°å­¦è¯æ˜ã€‚

---

## 3. æ ¸å¿ƒéš¾ç‚¹è¾¨æä¸è§£é¢˜ç­–ç•¥

1. **éš¾ç‚¹ï¼šçŸ©é˜µè½¬å›¾è®ºæ¨¡å‹**  
   * **åˆ†æ**ï¼šéœ€ç†è§£A^kå…ƒç´ >0 â‡” å­˜åœ¨é•¿åº¦ä¸ºkçš„è·¯å¾„ã€‚å°†>0å…ƒç´ è½¬ä¸ºæœ‰å‘è¾¹æ˜¯å»ºæ¨¡å…³é”®ï¼Œå¦‚Miharié¢˜è§£å°†çŸ©é˜µæŠ½è±¡ä¸º01é‚»æ¥çŸ©é˜µã€‚
   * ğŸ’¡ **å­¦ä¹ ç¬”è®°**ï¼šéè´ŸçŸ©é˜µçš„å¹‚è¿ç®—å¯è½¬åŒ–ä¸ºå›¾è®ºè·¯å¾„é—®é¢˜ã€‚

2. **éš¾ç‚¹ï¼šå¼ºè¿é€šæ€§è¯æ˜**  
   * **åˆ†æ**ï¼šä¾èµ–è‡ªç¯æ¡ä»¶ï¼ˆÎ£aáµ¢áµ¢>0ï¼‰å®ç°è·¯å¾„é•¿åº¦æ‰©å±•ã€‚å°ç¦ç”¨æˆ·é¢˜è§£è¯æ˜ï¼šå½“å›¾å¼ºè¿é€šæ—¶ï¼Œå¯é€šè¿‡è‡ªç¯è°ƒèŠ‚ä»»æ„è·¯å¾„é•¿åº¦ã€‚
   * ğŸ’¡ **å­¦ä¹ ç¬”è®°**ï¼šè‡ªç¯æ˜¯è§£å†³è·¯å¾„é•¿åº¦çº¦æŸçš„æ ¸å¿ƒæ¢çº½ã€‚

3. **éš¾ç‚¹ï¼šSCCç®—æ³•é€‰æ‹©**  
   * **åˆ†æ**ï¼šTarjanï¼ˆO(nÂ²)ï¼‰é€‚åˆç²¾ç¡®è®¡ç®—SCCï¼›åŒå‘BFSï¼ˆO(nÂ²)ï¼‰èŠ‚çœå†…å­˜ä½†éœ€ä¸¤æ¬¡éå†ï¼›bitsetä¼ é€’é—­åŒ…ï¼ˆO(nÂ³/64)ï¼‰é€‚åˆç¨€ç–å›¾ã€‚
   * ğŸ’¡ **å­¦ä¹ ç¬”è®°**ï¼šæ ¹æ®æ•°æ®è§„æ¨¡é€‰æ‹©ç®—æ³•ï¼Œ2000Ã—2000çŸ©é˜µä¼˜å…ˆé€‰Tarjanæˆ–åŒå‘BFSã€‚

### âœ¨ è§£é¢˜æŠ€å·§æ€»ç»“
- **æŠ€å·§1 é—®é¢˜è½¬æ¢**ï¼šå°†ä»£æ•°é—®é¢˜è½¬åŒ–ä¸ºå›¾è®ºæ¨¡å‹ï¼ˆçŸ©é˜µâ†’é‚»æ¥è¡¨ï¼‰
- **æŠ€å·§2 ç®—æ³•è°ƒä¼˜**ï¼šç¨ å¯†å›¾ç”¨bitsetå‹ç¼©ç©ºé—´ï¼Œç¨€ç–å›¾ç”¨é“¾å¼å‰å‘æ˜Ÿ
- **æŠ€å·§3 è¾¹ç•Œå¤„ç†**ï¼šç‰¹åˆ«æ³¨æ„å…¨é›¶çŸ©é˜µå’Œå­¤ç«‹ç‚¹çš„åˆ¤æ–­

---

## 4. C++æ ¸å¿ƒä»£ç å®ç°èµæ

**é€šç”¨æ ¸å¿ƒå®ç°ï¼ˆTarjanç¼©ç‚¹ï¼‰**  
```cpp
#include <bits/stdc++.h>
using namespace std;
const int N = 2005;

vector<int> G[N];
int dfn[N], low[N], scc_cnt, idx;
stack<int> stk;
bool in_stack[N];

void tarjan(int u) {
    dfn[u] = low[u] = ++idx;
    stk.push(u); in_stack[u] = true;
    for(int v : G[u]) {
        if(!dfn[v]) {
            tarjan(v);
            low[u] = min(low[u], low[v]);
        } 
        else if(in_stack[v]) 
            low[u] = min(low[u], dfn[v]);
    }
    if(dfn[u] == low[u]) {
        ++scc_cnt;
        while(stk.top() != u) {
            in_stack[stk.top()] = false;
            stk.pop();
        }
        in_stack[u] = false; stk.pop();
    }
}

int main() {
    int n; cin >> n;
    for(int i=1; i<=n; ++i)
        for(int j=1; j<=n; ++j) {
            int x; cin >> x;
            if(x > 0) G[i].push_back(j);
        }
    
    for(int i=1; i<=n; ++i)
        if(!dfn[i]) tarjan(i);
        
    cout << (scc_cnt == 1 ? "YES" : "NO");
}
```
* **ä»£ç è§£è¯»æ¦‚è¦**ï¼š  
  1. æ„å»ºé‚»æ¥è¡¨Gå­˜å‚¨æœ‰å‘è¾¹  
  2. Tarjané€’å½’æ ‡è®°dfn/low  
  3. æ ˆæœºåˆ¶åˆ†ç¦»SCC  
  4. ä»…å½“SCC=1æ—¶è¾“å‡ºYES  

---

**é¢˜è§£ä¸€ï¼šMihariï¼ˆTarjanï¼‰**  
* **äº®ç‚¹**ï¼šç»å…¸Tarjanå®ç°ï¼ŒSCCè®¡æ•°ç²¾ç¡®  
* **æ ¸å¿ƒç‰‡æ®µ**ï¼š  
  ```cpp
  // tarjanå‡½æ•°æ ¸å¿ƒéƒ¨åˆ†
  if(low[u] == dfn[u]) {
      int cnt = 0;
      do { cnt++; } while(stk.top() != u);
      scc_cnt++;
  }
  ```
* **ä»£ç è§£è¯»**ï¼š  
  > å½“èŠ‚ç‚¹uçš„lowç­‰äºdfnæ—¶ï¼Œè¯´æ˜æ‰¾åˆ°SCCæ ¹èŠ‚ç‚¹ã€‚do-whileå¾ªç¯è®¡æ•°å½“å‰SCCèŠ‚ç‚¹æ•°ï¼Œé¿å…æ˜¾å¼å‡ºæ ˆæ“ä½œã€‚  
  > **ç±»æ¯”**ï¼šå¦‚åŒè€ƒå¤åœ°å±‚åˆ†æï¼Œdfnæ˜¯æŒ–æ˜æ·±åº¦ï¼Œlowæ˜¯æ–‡ç‰©æ‰€å±å¹´ä»£å±‚ã€‚

**é¢˜è§£äºŒï¼šfzj2007ï¼ˆbitsetï¼‰**  
* **äº®ç‚¹**ï¼šbitseté«˜æ•ˆå®ç°ä¼ é€’é—­åŒ…  
* **æ ¸å¿ƒç‰‡æ®µ**ï¼š  
  ```cpp
  bitset<N> f[N];
  for(int i=1; i<=n; ++i)
      for(int j=1; j<=n; ++j)
          if(f[j][i]) f[j] |= f[i]; 
  ```
* **ä»£ç è§£è¯»**ï¼š  
  > é€šè¿‡ä½è¿ç®—f[j] |= f[i]å®ç°çŠ¶æ€å‹ç¼©ä¼ é€’ã€‚å½“f[j][i]=1æ—¶ï¼Œå°†jçš„å¯è¾¾é›†åˆæ‰©å±•ä¸ºjâˆªiçš„å¯è¾¾é›†ã€‚  
  > **æ³¨æ„**ï¼šå†…å±‚å¾ªç¯é¡ºåºç¡®ä¿çŠ¶æ€æ­£ç¡®ä¼ é€’ï¼ˆç±»ä¼¼Floydä¼˜åŒ–ï¼‰ã€‚

**é¢˜è§£ä¸‰ï¼šå°ç¦ç”¨æˆ·ï¼ˆåŒå‘BFSï¼‰**  
* **äº®ç‚¹**ï¼šé¿å…é€’å½’çš„è¿­ä»£å®ç°  
* **æ ¸å¿ƒç‰‡æ®µ**ï¼š  
  ```cpp
  // åŸå›¾è¿é€šæ£€æŸ¥
  q.push(1); vis[0][1]=1;
  while(!q.empty()) {
      int u = q.front(); q.pop();
      for(int v : G[u]) 
          if(!vis[0][v]) vis[0][v]=1, q.push(v);
  }
  ```
* **ä»£ç è§£è¯»**ï¼š  
  > ä½¿ç”¨é˜Ÿåˆ—å®ç°BFSå±‚åºéå†ã€‚vis[0]æ ‡è®°åŸå›¾è®¿é—®çŠ¶æ€ï¼Œå½“é˜Ÿåˆ—ç©ºæ—¶å®Œæˆè¿é€šæ£€æŸ¥ã€‚  
  > **ä¼˜åŒ–ç‚¹**ï¼švectorå®ç°é‚»æ¥è¡¨æ¯”é“¾å¼å‰å‘æ˜Ÿæ›´æ˜“è°ƒè¯•ã€‚

---

## 5. ç®—æ³•å¯è§†åŒ–ï¼šåƒç´ åŠ¨ç”»æ¼”ç¤º

**ä¸»é¢˜**ï¼šåƒç´ åŸå¸‚äº¤é€šç½‘ï¼ˆ8-bité£æ ¼ï¼‰  
**æ ¸å¿ƒæ¼”ç¤º**ï¼šTarjanç®—æ³•æ‰§è¡Œæ—¶çš„SCCå‘ç°è¿‡ç¨‹  

**è®¾è®¡æ€è·¯**ï¼š  
> å¤å¤çº¢ç™½æœºé£æ ¼é™ä½ç†è§£å‹åŠ›ï¼Œé€šè¿‡é¢œè‰²å˜åŒ–å’ŒéŸ³æ•ˆå¼ºåŒ–ç®—æ³•å…³é”®æ­¥éª¤ï¼š  
> - **é»„è‰²é—ªçƒ**ï¼šå½“å‰è®¿é—®èŠ‚ç‚¹  
> - **çº¢è‰²è¾¹æ¡†**ï¼šæ ˆä¸­èŠ‚ç‚¹  
> - **ç»¿è‰²å¡«å……**ï¼šå·²å®ŒæˆèŠ‚ç‚¹  

**å…³é”®å¸§æ­¥éª¤**ï¼š  
1. **åˆå§‹åŒ–**ï¼šç½‘æ ¼å¸ƒå±€åŸå¸‚èŠ‚ç‚¹ï¼ˆåƒç´ æ–¹å—ï¼‰ï¼Œæ§åˆ¶é¢æ¿å«æ­¥è¿›/æš‚åœæŒ‰é’®  
   ![](https://via.placeholder.com/400x200/000000/FFFFFF?text=Pixel+City+Map)  
2. **DFSè¿‡ç¨‹**ï¼š  
   - å½“å‰èŠ‚ç‚¹é—ªçƒé»„è‰²ï¼Œå…¥æ ˆæ—¶æ’­æ”¾"å®"éŸ³æ•ˆ  
   - é€’å½’è®¿é—®é‚»å±…æ—¶æ˜¾ç¤ºè“è‰²è·¯å¾„ç®­å¤´  
3. **SCCå‘ç°**ï¼š  
   - å½“low=dfnæ—¶ï¼Œæ ˆé¡¶åˆ°è¯¥èŠ‚ç‚¹åŒºåŸŸé—ªçƒçº¢å…‰  
   - æ’­æ”¾"é€šå…³"éŸ³æ•ˆå¹¶æ˜¾ç¤ºSCCè®¡æ•°+1  
4. **ç»“æŸåˆ¤æ–­**ï¼š  
   - SCC=1æ—¶å…¨å›¾å˜ç»¿+èƒœåˆ©éŸ³ä¹  
   - SCC>1æ—¶æ–­å¼€åŒºåŸŸæ˜¾ç¤ºçº¢è‰²éš”ç¦»å¸¦  

**äº¤äº’è®¾è®¡**ï¼š  
- æ­¥è¿›æ§åˆ¶ï¼šç©ºæ ¼é”®å•æ­¥æ‰§è¡Œ  
- é€Ÿåº¦æ»‘å—ï¼šè°ƒèŠ‚åŠ¨ç”»é€Ÿåº¦ï¼ˆ0.5x~2xï¼‰  
- æ¨¡å¼åˆ‡æ¢ï¼šTarjan/bitset/åŒå‘BFSä¸‰ç§ç®—æ³•å¹¶è¡Œæ¼”ç¤º  

---

## 6. æ‹“å±•ç»ƒä¹ ä¸ç›¸ä¼¼é—®é¢˜

**æŠ€å·§è¿ç§»åœºæ™¯**ï¼š  
1. ç¤¾äº¤ç½‘ç»œä¼ æ’­ï¼ˆkæ­¥å½±å“èŒƒå›´ï¼‰  
2. çŠ¶æ€æœºå¯è¾¾æ€§åˆ†æ  
3. è¯­æ³•ä¾èµ–å†²çªæ£€æµ‹  

**æ¨èç»ƒä¹ **ï¼š  
1. **P2863** [USACO] ç‰›çš„èˆä¼š  
   > å¼ºè¿é€šåˆ†é‡åŸºç¡€åº”ç”¨ï¼Œå·©å›ºTarjanæ¨¡æ¿  
2. **P3387** ç¼©ç‚¹  
   > å­¦ä¹ SCCç¼©ç‚¹åDAGä¸Šçš„åŠ¨æ€è§„åˆ’  
3. **P2741** [USACO] é‡å å›¾åƒ  
   > ç»“åˆä¼ é€’é—­åŒ…çš„å®é™…é—®é¢˜ï¼Œå¼ºåŒ–bitsetåº”ç”¨  

---

## 7. å­¦ä¹ å¿ƒå¾—ä¸ç»éªŒåˆ†äº«

> **æ¥è‡ªå°ç¦ç”¨æˆ·çš„è°ƒè¯•ç»éªŒ**ï¼š  
> "å½“å®ç°åŒå‘BFSæ—¶ï¼Œå¿˜è®°é‡ç½®visæ•°ç»„å¯¼è‡´WAï¼Œé€šè¿‡æ‰“å°ä¸­é—´çŠ¶æ€å‘ç°é”™è¯¯ã€‚"  
>   
> **Kayç‚¹è¯„**ï¼š  
> å¤šæ­¥éª¤ç®—æ³•åŠ¡å¿…è¿›è¡Œé˜¶æ®µçŠ¶æ€éªŒè¯ï¼Œå»ºè®®ï¼š  
> 1. æ¨¡å—åŒ–å°è£…BFSå‡½æ•°  
> 2. æ¯é˜¶æ®µç»“æŸåè¾“å‡ºvisæ•°ç»„  
> 3. ä½¿ç”¨å°è§„æ¨¡æµ‹è¯•ç”¨ä¾‹ï¼ˆn=3ï¼‰  

---

**ç»“è¯­**  
é€šè¿‡æœ¬æ¬¡åˆ†æï¼Œæˆ‘ä»¬æŒæ¡äº†çŸ©é˜µè½¬å›¾è®ºæ¨¡å‹çš„æ€ç»´æ–¹æ³•ï¼Œå¹¶å®è·µäº†ä¸‰ç§å¼ºè¿é€šåˆ¤æ–­ç®—æ³•ã€‚è®°ä½ï¼šç®—æ³•é€‰æ‹©éœ€å…¼é¡¾æ•ˆç‡ä¸å¯è¯»æ€§ï¼Œé‡åˆ°å›¾è®ºé—®é¢˜å…ˆé—®â€”â€”"è¿™æ˜¯å¦éœ€è¦SCCï¼Ÿ"ä¸‹æ¬¡æŒ‘æˆ˜å†è§ï¼ğŸš€

---
å¤„ç†ç”¨æ—¶ï¼š136.38ç§’
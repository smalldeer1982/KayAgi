# é¢˜ç›®ä¿¡æ¯

# Square Equation Roots

## é¢˜ç›®æè¿°

A schoolboy Petya studies square equations. The equations that are included in the school curriculum, usually look simple:

 $ x^{2}+2bx+c=0 $  where $ b $ , $ c $ are natural numbers.Petya noticed that some equations have two real roots, some of them have only one root and some equations don't have real roots at all. Moreover it turned out that several different square equations can have a common root.

Petya is interested in how many different real roots have all the equations of the type described above for all the possible pairs of numbers $ b $ and $ c $ such that $ 1<=b<=n $ , $ 1<=c<=m $ . Help Petya find that number.

## è¯´æ˜/æç¤º

In the second test from the statement the following equations are analysed:

 $ b=1 $ , $ c=1 $ : $ x^{2}+2x+1=0 $ ; The root is $ x=-1 $

 $ b=1 $ , $ c=2 $ : $ x^{2}+2x+2=0 $ ; No roots

 Overall there's one root

In the second test the following equations are analysed:

 $ b=1 $ , $ c=1 $ : $ x^{2}+2x+1=0 $ ; The root is $ x=-1 $

 $ b=1 $ , $ c=2 $ : $ x^{2}+2x+2=0 $ ; No roots

 $ b=1 $ , $ c=3 $ : $ x^{2}+2x+3=0 $ ; No roots

 $ b=2 $ , $ c=1 $ : $ x^{2}+4x+1=0 $ ; The roots are ![](https://cdn.luogu.com.cn/upload/vjudge_pic/CF50E/3991ec922d7c769ae489eea64c57c2bbb41b0c54.png)

 $ b=2 $ , $ c=2 $ : $ x^{2}+4x+2=0 $ ; The roots are ![](https://cdn.luogu.com.cn/upload/vjudge_pic/CF50E/5d07b9483ebb741bb80c778aae623d469ac94a4a.png)

 $ b=2 $ , $ c=3 $ : $ x^{2}+4x+3=0 $ ; The roots are $ x_{1}=-3,x_{2}=-1 $

 $ b=3 $ , $ c=1 $ : $ x^{2}+6x+1=0 $ ; The roots are ![](https://cdn.luogu.com.cn/upload/vjudge_pic/CF50E/30c496d75cf97e85908b57bf3d939afa2185247b.png)

 $ b=3 $ , $ c=2 $ : $ x^{2}+6x+2=0 $ ; The roots are ![](https://cdn.luogu.com.cn/upload/vjudge_pic/CF50E/6c503238cbe1ecf3a5382e37b1c706ca9a71b27d.png)

 $ b=3 $ , $ c=3 $ : $ x^{2}+6x+3=0 $ ; The roots are ![](https://cdn.luogu.com.cn/upload/vjudge_pic/CF50E/7103d2deaa4e6cd061273d09630c96da35ced6a7.png) Overall there are $ 13 $ roots and as the root $ -1 $ is repeated twice, that means there are $ 12 $ different roots.

## æ ·ä¾‹ #1

### è¾“å…¥

```
3 3
```

### è¾“å‡º

```
12
```

## æ ·ä¾‹ #2

### è¾“å…¥

```
1 2
```

### è¾“å‡º

```
1
```

# AIåˆ†æç»“æœ


### Kayçš„C++ç®—æ³•è§£æï¼šSquare Equation Roots æ·±å…¥å­¦ä¹ æŒ‡å—

#### 1. é¢˜ç›®è§£è¯»ä¸æ ¸å¿ƒç®—æ³•è¯†åˆ«
âœ¨ **æœ¬é¢˜ä¸»è¦è€ƒå¯Ÿ**ï¼š`æ•°å­¦æ¨å¯¼ä¸é«˜æ•ˆæšä¸¾`  
ğŸ—£ï¸ **åˆæ­¥åˆ†æ**ï¼š  
> è§£å†³æœ¬é¢˜å¦‚åŒåœ¨åƒç´ è¿·å®«ä¸­å¯»æ‰¾å®è—ã€‚æ ¸å¿ƒæ˜¯ç†è§£æ–¹ç¨‹ $x^2+2bx+c=0$ çš„æ±‚æ ¹å…¬å¼ $x=-b\pm\sqrt{b^2-c}$ï¼Œå¹¶é«˜æ•ˆç»Ÿè®¡æ‰€æœ‰ä¸åŒå®æ ¹ã€‚  
> - **æ ¸å¿ƒéš¾ç‚¹**ï¼šæ—¢è¦è®¡ç®—æ‰€æœ‰æœ‰æ•ˆæ ¹ï¼ˆ$b^2\geq c$ï¼‰ï¼Œåˆè¦é¿å…é‡å¤è®¡æ•°æ•´æ•°æ ¹ï¼ˆå¦‚ $x=-1$ çš„é‡å¤å‡ºç°ï¼‰ã€‚  
> - **é¢˜è§£ç­–ç•¥**ï¼š  
>   â‘  è®¡ç®—åˆå§‹æ€»æ ¹æ•°ï¼š$2 \times \sum_{b=1}^n \min(m, b^2)$  
>   â‘¡ å•ç‹¬å¤„ç†æ•´æ•°æ ¹ï¼šé€šè¿‡ $c=b^2-k^2$ åæ¨ $k$ çš„èŒƒå›´ï¼Œç”¨å·®åˆ†æ•°ç»„æ ‡è®°é‡å¤æ ¹  
> - **å¯è§†åŒ–è®¾è®¡**ï¼š  
>   ç”¨8-bitåƒç´ ç½‘æ ¼å±•ç¤º $b$ å’Œ $c$ çš„å–å€¼å…³ç³»ï¼Œå½“ $b^2-c$ ä¸ºå®Œå…¨å¹³æ–¹æ•°æ—¶ï¼Œæ•´æ•°æ ¹æ‰€åœ¨æ ¼å­é—ªçƒé‡‘è‰²ï¼Œå¹¶æ’­æ”¾"å®"éŸ³æ•ˆï¼›æ— ç†æ ¹ç”¨è“è‰²åƒç´ æµåŠ¨åŠ¨ç”»è¡¨ç¤ºã€‚

---

#### 2. ç²¾é€‰ä¼˜è´¨é¢˜è§£å‚è€ƒ
**é¢˜è§£ï¼ˆä½œè€…ï¼šMyukiyoMekyaï¼‰**  
* **ç‚¹è¯„**ï¼š  
  æ€è·¯ç›´å‡»æœ¬è´¨â€”â€”å°†æ ¹åˆ†ä¸ºæ— ç†æ•°ï¼ˆå¤©ç„¶ä¸é‡å¤ï¼‰å’Œæ•´æ•°ï¼ˆéœ€å»é‡ï¼‰ã€‚ä»£ç äº®ç‚¹ï¼š  
  - **æ•°å­¦è½¬åŒ–**ï¼šé€šè¿‡ $k=\sqrt{b^2-c}$ å°†æ•´æ•°æ ¹è½¬åŒ–ä¸º $k$ çš„èŒƒå›´è®¡ç®—ï¼ˆ$l=\lceil\sqrt{\max(0,b^2-m)}\rceil$, $r=\lfloor\sqrt{b^2-1}\rfloor$ï¼‰  
  - **å·®åˆ†å¦™ç”¨**ï¼šç”¨ `f[MaxN<<1]` æ•°ç»„æ ‡è®°æ ¹ $[-b\pm k]$ çš„å‡ºç°æ¬¡æ•°ï¼Œé¿å…æš´åŠ›ç»Ÿè®¡  
  - **è¾¹ç•Œä¸¥è°¨**ï¼š`max(0, b^2-m)` å¤„ç† $c$ è¶…èŒƒå›´æƒ…å†µ  
  - **æ•ˆç‡å“è¶Š**ï¼š$O(n)$ å¤æ‚åº¦ï¼Œ1e7 æ•°æ®é‡è½»æ¾å¤„ç†  

---

#### 3. æ ¸å¿ƒéš¾ç‚¹è¾¨æä¸è§£é¢˜ç­–ç•¥
1. **éš¾ç‚¹1ï¼šæ•´æ•°æ ¹é‡å¤æ€§åˆ¤æ–­**  
   * **åˆ†æ**ï¼šå½“ $b^2-c$ ä¸ºå®Œå…¨å¹³æ–¹æ•°æ—¶ï¼Œæ ¹ $-b\pm k$ å¯èƒ½è¢«å¤šä¸ªæ–¹ç¨‹å…±äº«ï¼ˆå¦‚æ ·ä¾‹ä¸­ $x=-1$ï¼‰ã€‚éœ€å»ºç«‹æ ¹å€¼åˆ°å‡ºç°æ¬¡æ•°çš„æ˜ å°„ã€‚  
   * ğŸ’¡ **å­¦ä¹ ç¬”è®°**ï¼šæ•´æ•°æ ¹æ˜¯é‡å¤çš„å”¯ä¸€æ¥æºï¼Œå¿…é¡»å•ç‹¬å¤„ç†ã€‚  

2. **éš¾ç‚¹2ï¼š$k$ çš„èŒƒå›´ç²¾ç¡®è®¡ç®—**  
   * **åˆ†æ**ï¼šç”± $1\leq b^2-k^2\leq m$ æ¨å¯¼å‡º $k\in[l,r]$ã€‚å…³é”®ä»£ç ï¼š  
     ```cpp
     l = ceil(sqrt(max(0, b*b - m)));
     r = floor(sqrt(b*b - 1));
     ```  
   * ğŸ’¡ **å­¦ä¹ ç¬”è®°**ï¼šæ•°å­¦æ¨å¯¼éœ€å…¼é¡¾è¾¹ç•Œï¼ˆ$c\geq1$ æ¨å¾— $k\leq\sqrt{b^2-1}$ï¼‰ã€‚  

3. **éš¾ç‚¹3ï¼šé«˜æ•ˆæ ‡è®°é‡å¤æ ¹**  
   * **åˆ†æ**ï¼šç›´æ¥å¼€ $10^7$ æ•°ç»„è®°å½•æ ¹å‡ºç°æ¬¡æ•°ä¼šMLEã€‚è§£æ³•ä½¿ç”¨å·®åˆ†æ•°ç»„ï¼Œå¯¹åŒºé—´ $[-b-r,-b-l]$ å’Œ $[-b+l,-b+r]$ åšæ ‡è®°ï¼Œæœ€åå‰ç¼€å’Œç»Ÿè®¡ã€‚  
   * ğŸ’¡ **å­¦ä¹ ç¬”è®°**ï¼šå·®åˆ†æ˜¯å¤„ç†å¤§èŒƒå›´åŒºé—´ä¿®æ”¹çš„åˆ©å™¨ã€‚  

**âœ¨ è§£é¢˜æŠ€å·§æ€»ç»“**  
- **æ•°å­¦å…ˆè¡Œ**ï¼šå°†é—®é¢˜è½¬åŒ–ä¸º $k$ çš„èŒƒå›´è®¡ç®—ï¼Œé¿å…ç›²ç›®æšä¸¾ $c$  
- **æ•°æ®ç»“æ„åŒ¹é…**ï¼šè¶…å¤§å€¼åŸŸç”¨å·®åˆ†æ›¿ä»£æœ´ç´ æ•°ç»„  
- **è¾¹ç•Œé˜²å¾¡**ï¼š`max(0, ...)` å’Œ `ceil/floor` å¤„ç†ä¸´ç•Œå€¼  

---

#### 4. C++æ ¸å¿ƒä»£ç å®ç°èµæ
**é€šç”¨æ ¸å¿ƒå®ç°å‚è€ƒ**  
```cpp
#include <bits/stdc++.h>
#define int long long
const int MaxN=1e7+50;
int b[MaxN<<1|5],*f=b+MaxN; // åŒå€åç§»æ•°ç»„

signed main() {
    int n, m; 
    std::cin >> n >> m;
    int ans = 0;
    
    // æ­¥éª¤1ï¼šè®¡ç®—åˆå§‹æ€»æ ¹æ•°
    for(int b=1; b<=n; ++b) 
        ans += 2 * std::min(m, b*b);
    
    // æ­¥éª¤2ï¼šæ ‡è®°æ•´æ•°æ ¹å‡ºç°åŒºé—´
    for(int b=1; b<=n; ++b) {
        int r = std::sqrt(b*b - 1);
        int l = std::ceil(std::sqrt(std::max(0LL, b*b - m)));
        if(l > r) continue;
        f[-b - r]++;  // æ ‡è®°åŒºé—´ [-b-r, -b-l]
        f[-b - l + 1]--;
        f[-b + l]++;  // æ ‡è®°åŒºé—´ [-b+l, -b+r]
        f[-b + r + 1]--;
    }
    
    // æ­¥éª¤3ï¼šå·®åˆ†è½¬å‰ç¼€å’Œï¼Œç»Ÿè®¡é‡å¤æ•°
    for(int i=-MaxN+1; i<=MaxN; ++i) {
        f[i] += f[i-1];
        if(f[i] > 1) ans -= (f[i] - 1); 
    }
    std::cout << ans;
}
```

**ä»£ç è§£è¯»æ¦‚è¦**ï¼š  
1. **åŒå€åç§»æ•°ç»„**ï¼š`f=b+MaxN` ä½¿ä¸‹æ ‡æ”¯æŒè´Ÿæ•°  
2. **ä¸‰é˜¶æ®µå¤„ç†**ï¼š  
   - å…ˆç´¯åŠ æ‰€æœ‰å¯èƒ½æ ¹ï¼ˆå«é‡å¤ï¼‰  
   - å·®åˆ†æ ‡è®°æ•´æ•°æ ¹å‡ºç°åŒºé—´  
   - å‰ç¼€å’Œè¿˜åŸåå‡å»é‡å¤è®¡æ•°  

---

#### 5. ç®—æ³•å¯è§†åŒ–ï¼šåƒç´ åŠ¨ç”»æ¼”ç¤º
![](https://cdn.luogu.com.cn/upload/vjudge_pic/CF50E/3991ec922d7c769ae489eea64c57c2bbb41b0c54.png)  
* **ä¸»é¢˜**ï¼š8-bité£æ ¼ã€Šæ ¹ä¹‹æ¢é™©ã€‹  
* **æ ¸å¿ƒæœºåˆ¶**ï¼š  
  1. **ç½‘æ ¼è®¾è®¡**ï¼š  
     - Xè½´ï¼š$b$ å€¼ï¼ˆ1~nï¼‰ï¼ŒYè½´ï¼š$c$ å€¼ï¼ˆ1~mï¼‰  
     - ç»¿è‰²åƒç´ ï¼šå­˜åœ¨å®æ ¹ï¼Œçº¢è‰²ï¼šæ— å®æ ¹  
  2. **æ•´æ•°æ ¹ç‰¹æ•ˆ**ï¼š  
     - å½“ $b^2-c$ ä¸ºå®Œå…¨å¹³æ–¹æ•°æ—¶ï¼Œæ ¼å­é—ªçƒé‡‘å…‰  
     - ç”Ÿæˆæ ¹ $-b\pm k$ æ—¶ï¼Œæ’­æ”¾ "ğŸ””" éŸ³æ•ˆ  
  3. **åŠ¨æ€æ ‡è®°**ï¼š  
     ```javascript
     // ä¼ªä»£ç ï¼šæ¸²æŸ“å·®åˆ†æ ‡è®°è¿‡ç¨‹
     function highlightRoots(b, l, r) {
        for(k = l; k <= r; k++) {
            drawPulse(-b - k, COLORS.gold); // æ¸²æŸ“æ ¹ -b-k
            drawPulse(-b + k, COLORS.gold);  // æ¸²æŸ“æ ¹ -b+k
            playSound("ding.wav");
        }
     }
     ```  
  4. **æ§åˆ¶é¢æ¿**ï¼š  
     - é€Ÿåº¦æ»‘å—ï¼šè°ƒèŠ‚ $b$ çš„æšä¸¾é€Ÿåº¦  
     - æš‚åœ/ç»§ç»­ï¼šè§‚å¯Ÿç‰¹å®š $b$ çš„æ ¹åˆ†å¸ƒ  

---

#### 6. æ‹“å±•ç»ƒä¹ ä¸ç›¸ä¼¼é—®é¢˜æ€è€ƒ
1. **æ´›è°· P1024**ï¼š[ä¸€å…ƒä¸‰æ¬¡æ–¹ç¨‹æ±‚è§£]  
   â†’ å·©å›ºå®æ•°æ ¹åˆ†ç¦»ä¸èŒƒå›´è®¡ç®—  
2. **æ´›è°· P1219**ï¼š[å…«çš‡å]  
   â†’ è®­ç»ƒçŠ¶æ€æ ‡è®°ä¸å›æº¯æ€æƒ³  
3. **æ´›è°· P1045**ï¼š[éº¦æ£®æ•°]  
   â†’ æå‡å¤§æ•°è¿ç®—ä¸æ•°å­¦æ¨å¯¼èƒ½åŠ›  

---

#### 7. å­¦ä¹ å¿ƒå¾—ä¸ç»éªŒåˆ†äº«
> **ä½œè€…è°ƒè¯•ç»éªŒ**ï¼š  
> â€œæœ€åˆå¿½ç•¥ $b^2-m<0$ å¯¼è‡´ sqrt æŠ¥é”™ï¼Œç”¨ `max(0, ...)` é˜²å¾¡åè§£å†³â€  
>   
> **Kayç‚¹è¯„**ï¼š  
> æ•°å­¦é¢˜éœ€ç‰¹åˆ«æ³¨æ„è¾¹ç•Œï¼å­¦ä¼šç”¨ `max/min` ä¿æŠ¤ä¸´ç•Œæ“ä½œï¼Œè¿™æ˜¯ç«èµ›ç¼–ç¨‹çš„ç”Ÿå­˜æŠ€èƒ½ã€‚

--- 
ğŸ’¡ è®°ä½ï¼šç¼–ç¨‹å¦‚è§£æ–¹ç¨‹ï¼Œæ¯ä¸€æ­¥æ¨å¯¼éƒ½æ˜¯é€¼è¿‘ç­”æ¡ˆçš„æ ¹ï¼ä¸‹æ¬¡è§ï½

---
å¤„ç†ç”¨æ—¶ï¼š123.95ç§’
# é¢˜ç›®ä¿¡æ¯

# First Digit Law

## é¢˜ç›®æè¿°

In the probability theory the following paradox called Benford's law is known: "In many lists of random numbers taken from real sources, numbers starting with digit 1 occur much more often than numbers starting with any other digit" (that's the simplest form of the law).

Having read about it on Codeforces, the Hedgehog got intrigued by the statement and wishes to thoroughly explore it. He finds the following similar problem interesting in particular: there are $ N $ random variables, the $ i $ -th of which can take any integer value from some segment $ [L_{i};R_{i}] $ (all numbers from this segment are equiprobable). It means that the value of the $ i $ -th quantity can be equal to any integer number from a given interval $ [L_{i};R_{i}] $ with probability $ 1/(R_{i}-L_{i}+1) $ .

The Hedgehog wants to know the probability of the event that the first digits of at least $ K% $ of those values will be equal to one. In other words, let us consider some set of fixed values of these random variables and leave only the first digit (the MSD â€” most significant digit) of each value. Then let's count how many times the digit 1 is encountered and if it is encountered in at least $ K $ per cent of those $ N $ values, than such set of values will be called a good one. You have to find the probability that a set of values of the given random variables will be a good one.

## æ ·ä¾‹ #1

### è¾“å…¥

```
1
1 2
50
```

### è¾“å‡º

```
0.500000000000000```

## æ ·ä¾‹ #2

### è¾“å…¥

```
2
1 2
9 11
50
```

### è¾“å‡º

```
0.833333333333333```

# AIåˆ†æç»“æœ


### ğŸ’¡ Kayçš„C++ç®—æ³•è§£æï¼šFirst Digit Law æ·±å…¥å­¦ä¹ æŒ‡å— ğŸ’¡

<introduction>
ä»Šå¤©æˆ‘ä»¬æ¥åˆ†æCodeforcesçš„"First Digit Law"é—®é¢˜ï¼Œä¸€é“ç»“åˆæ•°ä½å¤„ç†å’Œæ¦‚ç‡åŠ¨æ€è§„åˆ’çš„ç»å…¸é¢˜ç›®ã€‚æœ¬æŒ‡å—å°†å¸®åŠ©ä½ ç†è§£å¦‚ä½•é«˜æ•ˆå¤„ç†å¤§æ•°åŒºé—´è®¡ç®—ï¼Œå¹¶é€šè¿‡æ¦‚ç‡DPç»„åˆç»“æœã€‚
</introduction>

---

## 1. é¢˜ç›®è§£è¯»ä¸æ ¸å¿ƒç®—æ³•è¯†åˆ«

âœ¨ **æœ¬é¢˜ä¸»è¦è€ƒå¯Ÿ**ï¼š`æ•°ä½å¤„ç†ä¸æ¦‚ç‡DP`

ğŸ—£ï¸ **åˆæ­¥åˆ†æ**ï¼š
> è§£å†³æœ¬é¢˜å¦‚åŒæ‰“å¼€ä¸€ç³»åˆ—å®ç®±ï¼šæ¯ä¸ªåŒºé—´æ˜¯ä¸€ä¸ªå®ç®±ï¼Œé‡Œé¢è£…ç€ä¸åŒæ¦‚ç‡çš„"1å¼€å¤´"æ•°å­—ã€‚è§£é¢˜åˆ†ä¸¤æ­¥ï¼š
> 1. **æ•°ä½å¤„ç†**ï¼šè®¡ç®—æ¯ä¸ªåŒºé—´ä¸­æœ€é«˜ä½ä¸º1çš„æ•°å­—æ¯”ä¾‹ï¼ˆæ¦‚ç‡páµ¢ï¼‰
> 2. **æ¦‚ç‡DP**ï¼šç”¨èƒŒåŒ…æ€æƒ³ç»„åˆè¿™äº›æ¦‚ç‡ï¼Œè®¡ç®—è¾¾åˆ°ç›®æ ‡æ¯”ä¾‹çš„æ€»æ¦‚ç‡
> - æ ¸å¿ƒéš¾ç‚¹åœ¨äºé«˜æ•ˆè®¡ç®—å¤§æ•°åŒºé—´ï¼ˆ10Â¹â¸ï¼‰å†…"1å¼€å¤´"æ•°å­—çš„æ•°é‡
> - å¯è§†åŒ–è®¾è®¡ï¼šé‡‡ç”¨8ä½åƒç´ é£æ ¼ï¼Œæ¯ä¸ªåŒºé—´æ˜¾ç¤ºä¸ºå®ç®±ï¼ŒDPè¿‡ç¨‹ä¸ºèƒŒåŒ…å¡«å……åŠ¨ç”»ã€‚å…³é”®æ­¥éª¤è§¦å‘éŸ³æ•ˆï¼ˆè®¡ç®—páµ¢æ—¶"æ»´ç­”"ï¼ŒDPè½¬ç§»æ—¶"æ”¾ç½®"ï¼Œè¾¾æ ‡æ—¶èƒœåˆ©éŸ³æ•ˆï¼‰ï¼ŒAIè‡ªåŠ¨æ¼”ç¤ºå¯è°ƒé€Ÿè§‚å¯ŸçŠ¶æ€è½¬ç§»

---

## 2. ç²¾é€‰ä¼˜è´¨é¢˜è§£å‚è€ƒ

**é¢˜è§£ä¸€ï¼š(ä½œè€…ï¼šMihari)**
* **ç‚¹è¯„**ï¼šæ€è·¯æ¸…æ™°å®Œæ•´ï¼Œå°†é—®é¢˜åˆ†è§£ä¸ºæ¦‚ç‡è®¡ç®—+DPä¸¤æ­¥ã€‚ä»£ç è§„èŒƒï¼ˆdp[i][j]å‘½ååˆç†ï¼‰ï¼Œæ¨å¯¼äº†çŠ¶æ€è½¬ç§»æ–¹ç¨‹ã€‚äº®ç‚¹åœ¨äºç”¨èƒŒåŒ…æ€æƒ³è§£é‡Šæ¦‚ç‡ç»„åˆï¼Œå®è·µæ€§å¼ºå¯ç›´æ¥ç”¨äºç«èµ›

**é¢˜è§£äºŒï¼š(ä½œè€…ï¼šwind_whisper)**
* **ç‚¹è¯„**ï¼šé«˜æ•ˆå¤„ç†å¤§æ•°è¾¹ç•Œï¼ˆ10Â¹â¸ï¼‰ï¼Œcalcå‡½æ•°é¿å…éå†ã€‚äº®ç‚¹æ˜¯æ»šåŠ¨æ•°ç»„ä¼˜åŒ–ç©ºé—´ï¼ˆO(nÂ²)â†’O(n)ï¼‰ï¼Œä»£ç ç®€æ´å«è¯¦ç»†æ³¨é‡Šï¼Œé€‚åˆå­¦ä¹ ç©ºé—´ä¼˜åŒ–

**é¢˜è§£ä¸‰ï¼š(ä½œè€…ï¼šsmoothset)**
* **ç‚¹è¯„**ï¼šæä¾›å®Œæ•´å®ç°å’Œè¾¹ç•Œæµ‹è¯•æ–¹æ¡ˆï¼Œæ¦‚ç‡DPéƒ¨åˆ†ç”¨ä¸€ç»´æ•°ç»„ä¼˜åŒ–ã€‚äº®ç‚¹åœ¨è¯¦ç»†æ³¨é‡Šå’Œè°ƒè¯•ç»éªŒåˆ†äº«ï¼Œé€‚åˆåˆå­¦è€…ç†è§£å®ç°ç»†èŠ‚

---

## 3. æ ¸å¿ƒéš¾ç‚¹è¾¨æä¸è§£é¢˜ç­–ç•¥

1.  **éš¾ç‚¹1ï¼šå¤§æ•°åŒºé—´å†…"1å¼€å¤´"æ•°çš„ç»Ÿè®¡**
    * **åˆ†æ**ï¼šåŒºé—´å¯è¾¾10Â¹â¸ï¼Œéœ€æ•°å­¦æ–¹æ³•è€Œééå†ã€‚æ ¸å¿ƒæ˜¯è®¡ç®—[1,x]å†…æ•°é‡f(x)ï¼š
      ```f(x) = âˆ‘áµ¢â‚Œâ‚Ë¡áµ‰â¿â»Â¹ 10â±â»Â¹ + min(2Ã—10Ë¡áµ‰â¿â»Â¹ -1, x) - 10Ë¡áµ‰â¿â»Â¹ + 1```
    * ğŸ’¡ **å­¦ä¹ ç¬”è®°**ï¼šæŒ‰ä½æ•°åˆ†ç»„å¤„ç†ï¼Œé¿å…éå†

2.  **éš¾ç‚¹2ï¼šæ¦‚ç‡DPçš„çŠ¶æ€è®¾è®¡**
    * **åˆ†æ**ï¼šè®¾dp[j]ä¸ºå½“å‰æœ‰jä¸ª"1å¼€å¤´"çš„æ¦‚ç‡ã€‚è½¬ç§»æ–¹ç¨‹ï¼š
      ```dp[j] = dp[j]Ã—(1-páµ¢) + dp[j-1]Ã—páµ¢```
    * ğŸ’¡ **å­¦ä¹ ç¬”è®°**ï¼šé€†åºæ›´æ–°å®ç°ç©ºé—´ä¼˜åŒ–ï¼Œç±»ä¼¼01èƒŒåŒ…

3.  **éš¾ç‚¹3ï¼šè¾¹ç•Œä¸æº¢å‡ºå¤„ç†**
    * **åˆ†æ**ï¼šè®¡ç®—10Â¹â¸æ—¶ä¹˜æ³•ä¼šæº¢å‡ºï¼Œéœ€ç”¨é™¤æ³•åˆ¤æ–­ä½æ•°æˆ–è‡ªå®šä¹‰å¹‚å‡½æ•°
    * ğŸ’¡ **å­¦ä¹ ç¬”è®°**ï¼šæµ‹è¯•è¾¹ç•Œå€¼ï¼ˆx=0, x=10Â¹â¸ï¼‰ç¡®ä¿æ­£ç¡®æ€§

### âœ¨ è§£é¢˜æŠ€å·§æ€»ç»“
- **æ•°ä½åˆ†è§£**ï¼šæŒ‰ä½æ•°åˆ†ç»„å¤„ç†å¤§æ•°åŒºé—´
- **æ»šåŠ¨æ•°ç»„**ï¼šé€†åºæ›´æ–°DPçŠ¶æ€èŠ‚çœç©ºé—´
- **è¾¹ç•Œæµ‹è¯•**ï¼šç‰¹åˆ«éªŒè¯0å’Œ10Â¹â¸ç­‰ä¸´ç•Œå€¼

---

## 4. C++æ ¸å¿ƒä»£ç å®ç°èµæ

**é€šç”¨æ ¸å¿ƒå®ç°å‚è€ƒ**
```cpp
#include <iostream>
#include <vector>
using namespace std;
typedef long long ll;

ll calc(ll x) {
    if (!x) return 0;
    ll base = 1, len = 0, t = x;
    while (t) t/=10, len++;
    for (int i=1; i<len; i++) base *= 10;
    ll ans = (len-1) ? base/9 : 0; // âˆ‘10â±â»Â¹
    ll high = x/(base);
    return ans + (high>1 ? base : (high==1 ? x-base+1 : 0));
}

int main() {
    int n; cin >> n;
    vector<double> p(n+1, 0);
    for (int i=1; i<=n; i++) {
        ll l, r; cin >> l >> r;
        ll cnt = calc(r) - calc(l-1);
        p[i] = (double)cnt/(r-l+1);
    }
    int k; cin >> k;
    int need = (n*k + 99)/100; // å‘ä¸Šå–æ•´

    vector<double> dp(n+1, 0); dp[0] = 1;
    for (int i=1; i<=n; i++)
        for (int j=n; j>=0; j--)
            dp[j] = (j ? dp[j-1]*p[i] : 0) + dp[j]*(1-p[i]);
    
    double ans = 0;
    for (int i=need; i<=n; i++) ans += dp[i];
    printf("%.12lf\n", ans);
}
```
**ä»£ç è§£è¯»æ¦‚è¦**ï¼š
> 1. `calc`é«˜æ•ˆè®¡ç®—[1,x]å†…"1å¼€å¤´"æ•°ï¼šæŒ‰ä½æ•°åˆ†ç»„å¤„ç†
> 2. ä¸€ç»´DPæ•°ç»„`dp[j]`é€šè¿‡é€†åºæ›´æ–°å®ç°ç©ºé—´ä¼˜åŒ–
> 3. æœ€ç»ˆç´¯åŠ è¾¾æ ‡æ¦‚ç‡

---

## 5. ç®—æ³•å¯è§†åŒ–ï¼šåƒç´ åŠ¨ç”»æ¼”ç¤º

* **ä¸»é¢˜**ï¼š`åƒç´ å®ç®±æ”¶é›†ä¹‹æ—…`
* **æ ¸å¿ƒå†…å®¹**ï¼š
  - **åœºæ™¯1**ï¼šnä¸ªåƒç´ å®ç®±ï¼ˆæ ‡[láµ¢,ráµ¢]ï¼‰ï¼Œç‚¹å‡»å®ç®±å±•ç¤ºæ•°ä½åˆ†è§£è¿‡ç¨‹ï¼ˆä½æ•°ç»„åŠ¨ç”»+å…¬å¼ï¼‰
  - **åœºæ™¯2**ï¼šèƒŒåŒ…ç•Œé¢ï¼ˆj=0~næ ¼å­ï¼‰ï¼ŒDPè½¬ç§»æ—¶æ ¼å­äº®åº¦éšæ¦‚ç‡å˜åŒ–ï¼Œé€†åºæ›´æ–°ç‰¹æ•ˆ
  - **äº¤äº’**ï¼šæ­¥è¿›/è‡ªåŠ¨æ’­æ”¾ï¼ˆè°ƒé€Ÿæ»‘å—ï¼‰ï¼Œè¾¾æ ‡æ—¶å®ç®±å‘å…‰+èƒœåˆ©éŸ³æ•ˆ

* **è®¾è®¡ç»†èŠ‚**ï¼š
  1. å®ç®±å¼€å¯æ˜¾ç¤ºpáµ¢è®¡ç®—ï¼šæ•°ä½åˆ†è§£åŠ¨ç”»ï¼ˆä½æ•°ç»„æ»‘åŠ¨ï¼‰
  2. DPè½¬ç§»ç‰¹æ•ˆï¼šæºçŠ¶æ€â†’ç›®æ ‡çŠ¶æ€çš„ç®­å¤´æµåŠ¨ï¼Œäº®åº¦æ¸å˜
  3. éŸ³æ•ˆè®¾è®¡ï¼šè®¡ç®—páµ¢ï¼ˆé”®ç›˜å£°ï¼‰ï¼ŒDPè½¬ç§»ï¼ˆæ”¾ç½®å£°ï¼‰ï¼Œè¾¾æ ‡ï¼ˆèƒœåˆ©ä¹ï¼‰

---

## 6. æ‹“å±•ç»ƒä¹ ä¸ç›¸ä¼¼é—®é¢˜æ€è€ƒ

* **æŠ€å·§è¿ç§»**ï¼š
  - æ•°ä½å¤„ç† â†’ æ•°å­—ç»Ÿè®¡é—®é¢˜ï¼ˆP2602ï¼‰
  - æ¦‚ç‡DP â†’ å¸¦æ¦‚ç‡çš„è®¡æ•°é—®é¢˜ï¼ˆP1850ï¼‰

* **æ´›è°·æ¨è**ï¼š
  1. **P2602 æ•°å­—è®¡æ•°**ï¼šå·©å›ºæ•°ä½åˆ†è§£æŠ€å·§
  2. **P2215 ä¸Šå‡åºåˆ—**ï¼šç»ƒä¹ DPçŠ¶æ€è®¾è®¡
  3. **P1850 æ¢æ•™å®¤**ï¼šæ¦‚ç‡DPç»å…¸åº”ç”¨

---

## 7. å­¦ä¹ å¿ƒå¾—ä¸ç»éªŒåˆ†äº«
> ä½œè€…ç»éªŒæ‘˜å½•ï¼š
> - "å¤„ç†10Â¹â¸æ—¶ä¹˜æ³•æº¢å‡ºï¼Œæ”¹ç”¨é™¤æ³•åˆ¤æ–­ä½æ•°"ï¼ˆwind_whisperï¼‰
> - "æµ‹è¯•å‘ç°x=0æœªè¿”å›0ï¼Œå¯¼è‡´æ¦‚ç‡é”™è¯¯"ï¼ˆsmoothsetï¼‰
>
> **Kayæ€»ç»“**ï¼šè¾¹ç•Œæµ‹è¯•å’Œæº¢å‡ºå¤„ç†æ˜¯æ•°ä½é—®é¢˜çš„å…³é”®ï¼Œå»ºè®®ï¼š
> 1. å•ç‹¬æµ‹è¯•calcå‡½æ•°è¾¹ç•Œå€¼
> 2. å¤§æ•°è¿ç®—ä¼˜å…ˆç”¨é™¤æ³•é¿å…æº¢å‡º

---

<conclusion>
é€šè¿‡æ•°ä½åˆ†è§£å¤„ç†å¤§æ•°åŒºé—´+æ¦‚ç‡DPç»„åˆç»“æœï¼Œæˆ‘ä»¬é«˜æ•ˆè§£å†³äº†First Digit Lawé—®é¢˜ã€‚è®°ä½æ ¸å¿ƒæŠ€å·§ï¼šæŒ‰ä½åˆ†ç»„é¿å…éå†ï¼Œé€†åºDPä¼˜åŒ–ç©ºé—´ã€‚ä¸‹æ¬¡æˆ‘ä»¬å°†æ¢ç´¢æ›´å¤šåŠ¨æ€è§„åˆ’çš„åº”ç”¨ï¼
</conclusion>

---
å¤„ç†ç”¨æ—¶ï¼š181.77ç§’
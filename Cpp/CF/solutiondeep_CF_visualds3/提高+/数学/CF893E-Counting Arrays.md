# é¢˜ç›®ä¿¡æ¯

# Counting Arrays

## é¢˜ç›®æè¿°

You are given two positive integer numbers $ x $ and $ y $ . An array $ F $ is called an  $ y $ -factorization of $ x $ iff the following conditions are met:

- There are $ y $ elements in $ F $ , and all of them are integer numbers;
- ![](https://cdn.luogu.com.cn/upload/vjudge_pic/CF893E/d8d5a9dcea7fa6a7abfa89d7da34d6fb180c0f69.png).

You have to count the number of pairwise distinct arrays that are $ y $ -factorizations of $ x $ . Two arrays $ A $ and $ B $ are considered different iff there exists at least one index $ i $ ( $ 1<=i<=y $ ) such that $ A_{i}â‰ B_{i} $ . Since the answer can be very large, print it modulo $ 10^{9}+7 $ .

## è¯´æ˜/æç¤º

In the second testcase of the example there are six $ y $ -factorizations:

- $ {-4,-1} $ ;
- $ {-2,-2} $ ;
- $ {-1,-4} $ ;
- $ {1,4} $ ;
- $ {2,2} $ ;
- $ {4,1} $ .

## æ ·ä¾‹ #1

### è¾“å…¥

```
2
6 3
4 2
```

### è¾“å‡º

```
36
6
```

# AIåˆ†æç»“æœ


### ğŸ’¡ Kayçš„C++ç®—æ³•è§£æï¼šCounting Arrays æ·±å…¥å­¦ä¹ æŒ‡å— ğŸ’¡

#### 1. é¢˜ç›®è§£è¯»ä¸æ ¸å¿ƒç®—æ³•è¯†åˆ«
âœ¨ **æœ¬é¢˜ä¸»è¦è€ƒå¯Ÿ**ï¼šç»„åˆæ•°å­¦/è´¨å› æ•°åˆ†è§£åº”ç”¨  
ğŸ—£ï¸ **åˆæ­¥åˆ†æ**ï¼š  
> è§£å†³"Counting Arrays"çš„å…³é”®åœ¨äºå°†é—®é¢˜åˆ†è§£ä¸ºä¸¤ä¸ªç‹¬ç«‹éƒ¨åˆ†ï¼š**ç¬¦å·å¤„ç†**å’Œ**æ•°å€¼åˆ†é…**ã€‚å°±åƒåˆ†é…å½©è‰²ç³–æœåˆ°ä¸åŒç›’å­ï¼Œæ—¢è¦è€ƒè™‘ç³–æœæ•°é‡åˆ†é…ï¼ˆæ•°å€¼ï¼‰ï¼Œåˆè¦è€ƒè™‘ç›’å­æ ‡ç­¾ï¼ˆç¬¦å·ï¼‰ã€‚  
> - **æ ¸å¿ƒæ€è·¯**ï¼š  
>   1. **ç¬¦å·å¤„ç†**ï¼šå‰`y-1`ä¸ªå…ƒç´ å¯è‡ªç”±é€‰æ‹©æ­£è´Ÿå·ï¼ˆ2ç§é€‰æ‹©ï¼‰ï¼Œæœ€åä¸€ä¸ªå…ƒç´ ç¬¦å·ç”±ä¹˜ç§¯çº¦æŸç¡®å®šï¼Œæ€»æ–¹æ¡ˆæ•°ä¸º`2^(y-1)`  
>   2. **æ•°å€¼åˆ†é…**ï¼šå¯¹`x`è´¨å› æ•°åˆ†è§£åï¼Œæ¯ä¸ªè´¨å› å­çš„æŒ‡æ•°`e_i`é€šè¿‡æ’æ¿æ³•åˆ†é…åˆ°`y`ä¸ªä½ç½®ï¼Œæ–¹æ¡ˆæ•°ä¸º`C(e_i+y-1, y-1)`  
> - **å¯è§†åŒ–è®¾è®¡**ï¼š  
>   - åƒç´ åŠ¨ç”»å°†å±•ç¤º`x`åˆ†è§£ä¸ºè´¨å› æ•°"çŸ¿çŸ³"ï¼ˆä¸åŒé¢œè‰²ï¼‰ï¼ŒæŒ‡æ•°`e_i`ä½œä¸ºå°çƒåˆ†é…åˆ°`y`ä¸ªç›’å­ï¼ˆç½‘æ ¼åŠ¨ç”»ï¼‰  
>   - ç¬¦å·é€‰æ‹©é˜¶æ®µï¼šå‰`y-1`ä¸ªç›’å­å‡ºç°æ­£è´Ÿå·é—ªçƒï¼Œä¼´éš8-bitéŸ³æ•ˆï¼ˆé€‰æ‹©æ—¶"å®"å£°ï¼‰  
>   - å…³é”®å˜é‡ï¼š`ans`å®æ—¶æ˜¾ç¤ºåœ¨é¡¶éƒ¨ï¼Œéšè´¨å› æ•°åˆ†è§£é€æ­¥æ›´æ–°  

---

#### 2. ç²¾é€‰ä¼˜è´¨é¢˜è§£å‚è€ƒ
**é¢˜è§£ä¸€ï¼ˆä½œè€…ï¼šhyman00ï¼‰**  
* **ç‚¹è¯„**ï¼š  
  æ€è·¯ç›´å‡»æœ¬è´¨â€”â€”å°†é—®é¢˜åˆ†è§£ä¸ºç¬¦å·æ–¹æ¡ˆï¼ˆ`2^(y-1)`ï¼‰å’Œè´¨å› æ•°åˆ†é…ï¼ˆç»„åˆæ•°ä¹˜ç§¯ï¼‰ã€‚ä»£ç äº®ç‚¹åœ¨äºï¼š  
  - **é«˜æ•ˆé¢„å¤„ç†**ï¼šé˜¶ä¹˜ã€é€†å…ƒã€å¹‚æ¬¡æ•°ç»„é¢„è®¡ç®—ï¼Œç»„åˆæ•°O(1)æŸ¥è¯¢  
  - **è¾¹ç•Œå¤„ç†**ï¼šè´¨å› æ•°åˆ†è§£å¾ªç¯`i*i<=x`ä¼˜åŒ–ï¼Œå‰©ä½™è´¨æ•°å•ç‹¬å¤„ç†  
  - **ä»£ç è§„èŒƒ**ï¼šå˜é‡å`fac`ï¼ˆé˜¶ä¹˜ï¼‰ã€`fnv`ï¼ˆé˜¶ä¹˜é€†å…ƒï¼‰è¯­ä¹‰æ˜ç¡®ï¼Œæ¨¡å—åŒ–å‡½æ•°è®¾è®¡ï¼ˆ`qpow`, `inv`ï¼‰  

**é¢˜è§£äºŒï¼ˆä½œè€…ï¼šmydiplomacyï¼‰**  
* **ç‚¹è¯„**ï¼š  
  çªå‡ºæ•°å­¦ä¸¥è°¨æ€§â€”â€”è¯¦ç»†è¯æ˜ç¬¦å·æ–¹æ¡ˆæ•°ä¸º`2^(y-1)`ï¼ˆå¥‡å¶åˆ†ç±»+ç»„åˆæ’ç­‰å¼ï¼‰ã€‚äº®ç‚¹ï¼š  
  - **æ•°å­¦å¼•å¯¼**ï¼šä»ç»„åˆæ’ç­‰å¼æ¨å¯¼ç»“è®ºï¼Œæ·±åŒ–ç†è§£  
  - **å·¥ç¨‹ä¼˜åŒ–**ï¼šé€†å…ƒé€’æ¨å…¬å¼`inv[i]=inv[mod%i]*(mod-mod/i)`é¿å…å¿«é€Ÿå¹‚å¼€é”€  
  - **å®è·µä»·å€¼**ï¼šå®Œæ•´è´¨å› æ•°åˆ†è§£æ¡†æ¶å¯ç›´æ¥å¤ç”¨  

**é¢˜è§£ä¸‰ï¼ˆä½œè€…ï¼šeee_hohoï¼‰**  
* **ç‚¹è¯„**ï¼š  
  æä¾›æ ‡å‡†åŒ–å®ç°â€”â€”çº¿æ€§é¢„å¤„ç†é€†å…ƒé™ä½å¸¸æ•°ã€‚éœ€æ³¨æ„ï¼š  
  - **ä»£ç ç®€æ´**ï¼šè´¨å› æ•°åˆ†è§£ä¸»å¾ªç¯ä¸hyman00ä¸€è‡´  
  - **ä¼˜åŒ–ç‚¹**ï¼šç»„åˆæ•°è®¡ç®—ä½¿ç”¨é¢„å¤„ç†çš„`fac`å’Œ`invfac`ï¼Œä½†è¯æ˜éƒ¨åˆ†ç¨æ˜¾å†—ä½™  

---

#### 3. æ ¸å¿ƒéš¾ç‚¹è¾¨æä¸è§£é¢˜ç­–ç•¥
1. **éš¾ç‚¹1ï¼šç¬¦å·æ–¹æ¡ˆè¯æ˜**  
   * **åˆ†æ**ï¼šéœ€ä¸¥æ ¼è¯æ˜ç¬¦å·æ–¹æ¡ˆ=`2^(y-1)`ã€‚ä¼˜è´¨é¢˜è§£é€šè¿‡å¥‡å¶åˆ†ç±»+ç»„åˆæ’ç­‰å¼ï¼ˆ`âˆ‘C(n,2k)=2^(n-1)`ï¼‰è§£å†³ï¼Œé¿å…æšä¸¾  
   * ğŸ’¡ **å­¦ä¹ ç¬”è®°**ï¼šç»„åˆæ’ç­‰å¼æ˜¯ç®€åŒ–è®¡ç®—çš„åˆ©å™¨  

2. **éš¾ç‚¹2ï¼šæŒ‡æ•°åˆ†é…å»ºæ¨¡**  
   * **åˆ†æ**ï¼šå°†è´¨å› æ•°æŒ‡æ•°åˆ†é…è½¬åŒ–ä¸ºæ’æ¿æ³•æ¨¡å‹ï¼ˆ`e_i`ä¸ªç›¸åŒçƒæ”¾å…¥`y`ä¸ªç›’å­ï¼‰ã€‚å…³é”®å˜é‡`e_i`éœ€é€šè¿‡è´¨å› æ•°åˆ†è§£è·å–  
   * ğŸ’¡ **å­¦ä¹ ç¬”è®°**ï¼šè®¡æ•°é—®é¢˜ä¸­ï¼Œç‹¬ç«‹å­é—®é¢˜çš„ä¹˜ç§¯=æ€»æ–¹æ¡ˆæ•°  

3. **éš¾ç‚¹3ï¼šç»„åˆæ•°é«˜æ•ˆè®¡ç®—**  
   * **åˆ†æ**ï¼šé¢„å¤„ç†é˜¶ä¹˜åŠå…¶é€†å…ƒï¼Œå®ç°`C(n,k)=fac[n]*inv[k]*inv[n-k]%mod`ã€‚é€‰æ‹©é€†å…ƒé€’æ¨ï¼ˆ`mydiplomacy`ï¼‰æˆ–è´¹é©¬å°å®šç†ï¼ˆ`hyman00`ï¼‰å‡å¯  
   * ğŸ’¡ **å­¦ä¹ ç¬”è®°**ï¼šæ¨¡æ•°`10^9+7`ä¸‹ï¼Œè´¹é©¬å°å®šç†æ±‚é€†å…ƒæ›´é€šç”¨  

âœ¨ **è§£é¢˜æŠ€å·§æ€»ç»“**ï¼š  
- **åˆ†è§£é—®é¢˜**ï¼šå°†å¤æ‚é—®é¢˜æ‹†è§£ä¸ºç‹¬ç«‹å­é—®é¢˜ï¼ˆç¬¦å·/æ•°å€¼ï¼‰  
- **ç»„åˆæ¨¡å‹**ï¼šè¯†åˆ«æ’æ¿æ³•ã€ç»„åˆæ’ç­‰å¼ç­‰æ¨¡å‹  
- **é¢„å¤„ç†ä¼˜åŒ–**ï¼šé˜¶ä¹˜ã€é€†å…ƒç­‰å›ºå®šè®¡ç®—æå‰å¤„ç†  

---

#### 4. C++æ ¸å¿ƒä»£ç å®ç°èµæ
**æœ¬é¢˜é€šç”¨æ ¸å¿ƒC++å®ç°**  
* **è¯´æ˜**ï¼šç»¼åˆä¼˜è´¨é¢˜è§£ï¼Œé¢„å¤„ç†ä¼˜åŒ–+è´¨å› æ•°åˆ†è§£æ¡†æ¶  
```cpp
#include <iostream>
using namespace std;
const int MOD = 1e9+7, MAXN = 2e6+5;

int fac[MAXN], invFac[MAXN], pow2[MAXN]; // é¢„å¤„ç†æ•°ç»„

int qpow(int a, int b) { // å¿«é€Ÿå¹‚
    int res = 1;
    while (b) {
        if (b & 1) res = 1LL * res * a % MOD;
        a = 1LL * a * a % MOD;
        b >>= 1;
    }
    return res;
}

int C(int n, int k) { // ç»„åˆæ•°è®¡ç®—
    if (k < 0 || k > n) return 0;
    return 1LL * fac[n] * invFac[k] % MOD * invFac[n-k] % MOD;
}

int main() {
    // é¢„å¤„ç†ï¼šé˜¶ä¹˜ã€é˜¶ä¹˜é€†å…ƒã€2çš„å¹‚
    fac[0] = pow2[0] = 1;
    for (int i = 1; i < MAXN; ++i) {
        fac[i] = 1LL * fac[i-1] * i % MOD;
        pow2[i] = 2LL * pow2[i-1] % MOD;
    }
    invFac[MAXN-1] = qpow(fac[MAXN-1], MOD-2);
    for (int i = MAXN-2; i >= 0; --i)
        invFac[i] = 1LL * invFac[i+1] * (i+1) % MOD;

    int T; cin >> T;
    while (T--) {
        int x, y; cin >> x >> y;
        long long ans = pow2[y-1]; // ç¬¦å·æ–¹æ¡ˆ
        
        // è´¨å› æ•°åˆ†è§£
        for (int i = 2; i*i <= x; ++i) {
            if (x % i) continue;
            int cnt = 0;
            while (x % i == 0) cnt++, x /= i;
            ans = ans * C(cnt + y - 1, y - 1) % MOD;
        }
        if (x > 1) // å‰©ä½™è´¨å› æ•°
            ans = ans * C(1 + y - 1, y - 1) % MOD;
        
        cout << ans << "\n";
    }
}
```
* **ä»£ç è§£è¯»æ¦‚è¦**ï¼š  
  1. é¢„å¤„ç†é˜¶ä¹˜æ•°ç»„`fac`å’Œé€†å…ƒæ•°ç»„`invFac`å®ç°O(1)ç»„åˆæ•°æŸ¥è¯¢  
  2. ä¸»é€»è¾‘ï¼šå…ˆè®¡ç®—ç¬¦å·æ–¹æ¡ˆ`pow2[y-1]`ï¼Œå†åˆ†è§£`x`çš„è´¨å› æ•°  
  3. å¯¹æ¯ä¸ªè´¨å› å­çš„æŒ‡æ•°`e_i`ï¼Œç”¨æ’æ¿æ³•è®¡ç®—åˆ†é…æ–¹æ¡ˆ`C(e_i+y-1, y-1)`  
  4. å…³é”®ä¼˜åŒ–ï¼šè´¨å› æ•°å¾ªç¯ç»ˆæ­¢äº`sqrt(x)`ï¼Œå‰©ä½™è´¨æ•°å•ç‹¬å¤„ç†  

**é¢˜è§£ä¸€ï¼ˆhyman00ï¼‰ç‰‡æ®µèµæ**  
* **äº®ç‚¹**ï¼šè´¹é©¬å°å®šç†æ±‚é€†å…ƒï¼Œä»£ç ç®€æ´é«˜æ•ˆ  
* **æ ¸å¿ƒä»£ç **ï¼š  
  ```cpp
  int inv(int x) { return qpow(x, MOD-2); } // é€†å…ƒè®¡ç®—
  int C(int a, int b) { 
      return 1LL * fac[a] * fnv[b] % MOD * fnv[a-b] % MOD;
  }```
* **ä»£ç è§£è¯»**ï¼š  
  > `inv()`å‡½æ•°é€šè¿‡å¿«é€Ÿå¹‚æ±‚æ¨¡é€†å…ƒï¼ˆè´¹é©¬å°å®šç†ï¼‰ï¼Œ`C()`å‡½æ•°ç›´æ¥ç”¨é˜¶ä¹˜å’Œé€†å…ƒè®¡ç®—ç»„åˆæ•°ã€‚è¿™ç§å®ç°å¸¸æ•°è¾ƒå¤§ä½†ä»£ç ç›´è§‚ï¼Œé€‚åˆåˆå­¦è€…ç†è§£æ¨¡é€†å…ƒæ¦‚å¿µã€‚  

**é¢˜è§£äºŒï¼ˆmydiplomacyï¼‰ç‰‡æ®µèµæ**  
* **äº®ç‚¹**ï¼šçº¿æ€§é€’æ¨æ±‚é€†å…ƒå¤§å¹…ä¼˜åŒ–å¸¸æ•°  
* **æ ¸å¿ƒä»£ç **ï¼š  
  ```cpp
  inv[1] = 1;
  for (int i = 2; i <= N; i++) 
      inv[i] = inv[mod % i] * (mod - mod/i) % mod;```
* **ä»£ç è§£è¯»**ï¼š  
  > åˆ©ç”¨å…¬å¼`inv[i] = (mod - mod/i) * inv[mod%i] % mod`é€’æ¨æ±‚é€†å…ƒï¼Œé¿å…å¿«é€Ÿå¹‚çš„`O(log MOD)`å¼€é”€ã€‚è¿™æ˜¯ç«èµ›å¸¸è§ä¼˜åŒ–ï¼Œä½†éœ€ç†è§£æ•°è®ºåŸºç¡€ã€‚  

---

#### 5. ç®—æ³•å¯è§†åŒ–ï¼šåƒç´ åŠ¨ç”»æ¼”ç¤º  
**ä¸»é¢˜**ï¼š"è´¨å› æ•°çŸ¿å·¥"å¤å¤åƒç´ æ¸¸æˆ  
**è®¾è®¡æ€è·¯**ï¼š  
- **8-bité£æ ¼**ï¼šFCçº¢ç™½æœºè‰²è°ƒï¼ˆ4è‰²ï¼šèƒŒæ™¯ç°ã€è´¨å› æ•°çŸ¿çŸ³å½©è‰²ã€ç›’å­é»„è‰²ã€å°çƒçº¢è‰²ï¼‰  
- **æ ¸å¿ƒæµç¨‹**ï¼š  
  1. **åˆ†è§£é˜¶æ®µ**ï¼š`x`åƒç´ å—çˆ†ç‚¸ä¸ºè´¨å› æ•°çŸ¿çŸ³ï¼ˆ`p_i:e_i`ï¼‰ï¼Œä¼´éšçˆ†ç ´éŸ³æ•ˆ  
  2. **åˆ†é…é˜¶æ®µ**ï¼š  
     - æ¯ä¸ªè´¨å› æ•°çŸ¿çŸ³ä¸‹æ–¹å¼¹å‡º`e_i`ä¸ªå°çƒ  
     - `y`ä¸ªç›’å­æ’åˆ—ï¼Œç©å®¶æ‹–åŠ¨æ’æ¿ï¼ˆæ–¹å‘é”®æ§åˆ¶ï¼‰åˆ†å‰²å°çƒåˆ°ç›’å­  
     - å®æ—¶æ˜¾ç¤ºå½“å‰åˆ†é…æ–¹æ¡ˆæ•°`C(e_i+y-1, y-1)`  
  3. **ç¬¦å·é˜¶æ®µ**ï¼šå‰`y-1`ä¸ªç›’å­éšæœºé—ªçƒÂ±å·ï¼ˆæŒ‰A/Bé”®é€‰æ‹©ï¼‰ï¼Œä¼´éšé€‰æ‹©éŸ³æ•ˆ  
- **äº¤äº’æ§åˆ¶**ï¼š  
  - æ–¹å‘é”®ç§»åŠ¨æ’æ¿  
  - A/Bé”®é€‰æ‹©æ­£è´Ÿå·  
  - STARTé”®è‡ªåŠ¨æ¼”ç¤ºï¼ˆAIæ§åˆ¶æ’æ¿å’Œç¬¦å·é€‰æ‹©ï¼‰  
- **éŸ³æ•ˆè®¾è®¡**ï¼š  
  - å°çƒå…¥ç›’ï¼šçŸ­ä¿ƒ"å˜Ÿ"å£°  
  - ç¬¦å·é€‰æ‹©ï¼šä¸åŒéŸ³é«˜ï¼ˆæ­£å·é«˜éŸ³ï¼Œè´Ÿå·ä½éŸ³ï¼‰  
  - è®¡ç®—å®Œæˆï¼šé©¬é‡Œå¥¥è¿‡å…³éŸ³æ•ˆ  

---

#### 6. æ‹“å±•ç»ƒä¹ ä¸ç›¸ä¼¼é—®é¢˜æ€è€ƒ
1. **æ´›è°· P1407**ï¼ˆè´¨å› æ•°åˆ†è§£åŸºç¡€ï¼‰  
   > ğŸ—£ï¸ **æ¨èç†ç”±**ï¼šå·©å›ºè´¨å› æ•°åˆ†è§£æŠ€å·§ï¼Œç†è§£æŒ‡æ•°ç»Ÿè®¡  
2. **æ´›è°· P3811**ï¼ˆçº¿æ€§æ±‚é€†å…ƒæ¨¡æ¿ï¼‰  
   > ğŸ—£ï¸ **æ¨èç†ç”±**ï¼šæŒæ¡é€’æ¨æ±‚é€†å…ƒï¼Œä¼˜åŒ–ç»„åˆæ•°è®¡ç®—  
3. **æ´›è°· P1313**ï¼ˆç»„åˆæ•°åº”ç”¨è¿›é˜¶ï¼‰  
   > ğŸ—£ï¸ **æ¨èç†ç”±**ï¼šç»ƒä¹ ç»„åˆæ•°å…¬å¼åœ¨å¤šé¡¹å¼å±•å¼€ä¸­çš„åº”ç”¨  

---

#### 7. å­¦ä¹ å¿ƒå¾—ä¸ç»éªŒåˆ†äº«
> **å‚è€ƒç»éªŒ**ï¼š  
> å¤šä½ä½œè€…å¼ºè°ƒï¼šè´¨å› æ•°åˆ†è§£éœ€æ³¨æ„å¾ªç¯ç»ˆæ­¢æ¡ä»¶`i*i<=x`å’Œå‰©ä½™è´¨æ•°å¤„ç†ã€‚  
> **ç‚¹è¯„**ï¼šè¿™æ˜¯åˆ†è§£è´¨å› æ•°çš„æ ¸å¿ƒæŠ€å·§ï¼Œé¿å…é—æ¼å¤§è´¨æ•°å¯¼è‡´é”™è¯¯ã€‚å»ºè®®ç¼–å†™åˆ†è§£å‡½æ•°åï¼Œç”¨`x=2, x=4, x=1`ç­‰è¾¹ç•Œå€¼æµ‹è¯•ã€‚  

---  
**ç»“è¯­**ï¼šé€šè¿‡æœ¬é¢˜ï¼Œæˆ‘ä»¬æŒæ¡äº†ç»„åˆè®¡æ•°é—®é¢˜çš„åˆ†è§£æ€ç»´å’Œä¼˜åŒ–æŠ€å·§ã€‚è®°ä½ï¼šå¤æ‚é—®é¢˜å¸¸ç”±ç‹¬ç«‹å­é—®é¢˜ç»„æˆï¼Œé¢„å¤„ç†æ˜¯ä¼˜åŒ–å…³é”®ï¼ä¸‹æ¬¡æŒ‘æˆ˜è§ï¼ğŸ’ª

---
å¤„ç†ç”¨æ—¶ï¼š179.26ç§’
# é¢˜ç›®ä¿¡æ¯

# Permutation Addicts

## é¢˜ç›®æè¿°

Given a permutation $ a_1, a_2, \dots, a_n $ of integers from $ 1 $ to $ n $ , and a threshold $ k $ with $ 0 \leq k \leq n $ , you compute a sequence $ b_1, b_2, \dots, b_n $ as follows.

For every $ 1 \leq i \leq n $ in increasing order, let $ x = a_i $ .

- If $ x \leq k $ , set $ b_{x} $ to the last element $ a_j $ ( $ 1 \leq j < i $ ) that $ a_j > k $ . If no such element $ a_j $ exists, set $ b_{x} = n+1 $ .
- If $ x > k $ , set $ b_{x} $ to the last element $ a_j $ ( $ 1 \leq j < i $ ) that $ a_j \leq k $ . If no such element $ a_j $ exists, set $ b_{x} = 0 $ .

Unfortunately, after the sequence $ b_1, b_2, \dots, b_n $ has been completely computed, the permutation $ a_1, a_2, \dots, a_n $ and the threshold $ k $ are discarded.

Now you only have the sequence $ b_1, b_2, \dots, b_n $ . Your task is to find any possible permutation $ a_1, a_2, \dots, a_n $ and threshold $ k $ that produce the sequence $ b_1, b_2, \dots, b_n $ . It is guaranteed that there exists at least one pair of permutation $ a_1, a_2, \dots, a_n $ and threshold $ k $ that produce the sequence $ b_1, b_2, \dots, b_n $ .

A permutation of integers from $ 1 $ to $ n $ is a sequence of length $ n $ which contains all integers from $ 1 $ to $ n $ exactly once.

## è¯´æ˜/æç¤º

For the first test case, permutation $ a = [1,3,2,4] $ and threshold $ k = 2 $ will produce sequence $ b $ as follows.

- When $ i = 1 $ , $ x = a_i = 1 \leq k $ , there is no $ a_j $ ( $ 1 \leq j < i $ ) that $ a_j > k $ . Therefore, $ b_1 = n + 1 = 5 $ .
- When $ i = 2 $ , $ x = a_i = 3 > k $ , the last element $ a_j $ that $ a_j \leq k $ is $ a_1 $ . Therefore, $ b_3 = a_1 = 1 $ .
- When $ i = 3 $ , $ x = a_i = 2 \leq k $ , the last element $ a_j $ that $ a_j > k $ is $ a_2 $ . Therefore, $ b_2 = a_2 = 3 $ .
- When $ i = 4 $ , $ x = a_i = 4 > k $ , the last element $ a_j $ that $ a_j \leq k $ is $ a_3 $ . Therefore, $ b_4 = a_3 = 2 $ .

 Finally, we obtain sequence $ b = [5,3,1,2] $ . For the second test case, permutation $ a = [1,2,3,4,5,6] $ and threshold $ k = 3 $ will produce sequence $ b $ as follows.

- When $ i = 1, 2, 3 $ , $ a_i \leq k $ , there is no $ a_j $ ( $ 1 \leq j < i $ ) that $ a_j > k $ . Therefore, $ b_1 = b_2 = b_3 = n + 1 = 7 $ .
- When $ i = 4, 5, 6 $ , $ a_i > k $ , the last element $ a_j $ that $ a_j \leq k $ is $ a_3 $ . Therefore, $ b_4 = b_5 = b_6 = a_3 = 3 $ .

 Finally, we obtain sequence $ b = [7,7,7,3,3,3] $ . For the third test case, permutation $ a = [6,5,4,3,2,1] $ and threshold $ k = 3 $ will produce sequence $ b $ as follows.

- When $ i = 1, 2, 3 $ , $ a_i > k $ , there is no $ a_j $ ( $ 1 \leq j < i $ ) that $ a_j \leq k $ . Therefore, $ b_4 = b_5 = b_6 = 0 $ .
- When $ i = 4, 5, 6 $ , $ a_i \leq k $ , the last element $ a_j $ that $ a_j > k $ is $ a_3 $ . Therefore, $ b_1 = b_2 = b_3 = a_3 = 4 $ .

 Finally, we obtain sequence $ b = [4,4,4,0,0,0] $ .

## æ ·ä¾‹ #1

### è¾“å…¥

```
3
4
5 3 1 2
6
7 7 7 3 3 3
6
4 4 4 0 0 0```

### è¾“å‡º

```
2
1 3 2 4
3
1 2 3 4 5 6
3
6 5 4 3 2 1```

# AIåˆ†æç»“æœ

# ğŸ’¡ Kayçš„C++ç®—æ³•è§£æï¼šPermutation Addicts æ·±å…¥å­¦ä¹ æŒ‡å— ğŸ’¡


## 1. é¢˜ç›®è§£è¯»ä¸æ ¸å¿ƒç®—æ³•è¯†åˆ«

âœ¨ **æœ¬é¢˜ä¸»è¦è€ƒå¯Ÿ**ï¼šæ„é€ ç®—æ³• + æ ‘çš„éå†åº”ç”¨  

ğŸ—£ï¸ **åˆæ­¥åˆ†æ**ï¼š  
è§£å†³â€œPermutation Addictsâ€é—®é¢˜ï¼Œå…³é”®åœ¨äº**é€šè¿‡`b`æ•°ç»„çš„æ€§è´¨åæ¨é˜ˆå€¼`k`**ï¼Œå¹¶**å°†å‰é©±å…³ç³»è½¬åŒ–ä¸ºæ ‘ç»“æ„ï¼Œé€šè¿‡éå†æ ‘è¿˜åŸæ’åˆ—`a`**ã€‚ç®€å•æ¥è¯´ï¼Œ`k`æ˜¯åŒºåˆ†æ’åˆ—ä¸­å…ƒç´ ç±»åˆ«çš„â€œåˆ†ç•Œçº¿â€ï¼Œè€Œ`b`æ•°ç»„çš„æ¯ä¸ªå…ƒç´ è®°å½•äº†å¯¹åº”ä½ç½®å…ƒç´ åœ¨æ’åˆ—ä¸­çš„â€œæœ€è¿‘ä¸åŒç±»å‰é©±â€ï¼ˆæ¯”å¦‚`a_i â‰¤ k`æ—¶ï¼Œ`b_{a_i}`æ˜¯å‰é¢æœ€è¿‘çš„`>k`çš„å…ƒç´ ï¼‰ã€‚æˆ‘ä»¬å¯ä»¥æŠŠè¿™ç§â€œå‰é©±-åç»§â€å…³ç³»è½¬åŒ–ä¸ºæ ‘çš„çˆ¶å­å…³ç³»ï¼Œå†é€šè¿‡**ä¼˜å…ˆè¾“å‡ºå¶å­èŠ‚ç‚¹**çš„éå†é¡ºåºï¼Œå¾—åˆ°ç¬¦åˆè¦æ±‚çš„æ’åˆ—`a`ã€‚  

- **`k`çš„ç¡®å®š**ï¼šå¯¹äº`i â‰¤ k`ï¼Œ`b[i]`ä¸€å®šå¤§äº`i`ï¼ˆå› ä¸ºå®ƒä»¬çš„å‰é©±æ˜¯`>k`çš„å…ƒç´ æˆ–`n+1`ï¼‰ï¼›å¯¹äº`i > k`ï¼Œ`b[i]`ä¸€å®šå°äº`i`ï¼ˆå› ä¸ºå®ƒä»¬çš„å‰é©±æ˜¯`â‰¤k`çš„å…ƒç´ æˆ–`0`ï¼‰ã€‚å› æ­¤ï¼Œ`k`æ˜¯**æœ€å¤§çš„æ»¡è¶³`b[i] > i`çš„`i`**ã€‚  
- **æ ‘ç»“æ„å»ºç«‹**ï¼šå°†æ¯ä¸ª`i`çš„çˆ¶èŠ‚ç‚¹è®¾ä¸º`b[i]`ï¼ˆ`b[i]`æ˜¯`i`çš„å‰é©±ï¼‰ï¼Œæ ¹èŠ‚ç‚¹æ˜¯`0`æˆ–`n+1`ï¼ˆæ’åˆ—çš„ç¬¬ä¸€ä¸ªå…ƒç´ ï¼Œæ²¡æœ‰å‰é©±ï¼‰ã€‚  
- **éå†æ ‘å¾—åˆ°`a`**ï¼šä¸ºäº†ä¿è¯â€œæœ€è¿‘å‰é©±â€çš„è¦æ±‚ï¼Œéå†æ ‘æ—¶éœ€è¦**å…ˆè¾“å‡ºå¶å­èŠ‚ç‚¹ï¼ˆæ²¡æœ‰å­èŠ‚ç‚¹çš„èŠ‚ç‚¹ï¼‰ï¼Œå†è¾“å‡ºéå¶å­èŠ‚ç‚¹ï¼ˆæœ‰å­èŠ‚ç‚¹çš„èŠ‚ç‚¹ï¼‰**ã€‚å› ä¸ºéå¶å­èŠ‚ç‚¹çš„å­æ ‘éœ€è¦æ”¾åœ¨åé¢ï¼Œè¿™æ ·éå¶å­èŠ‚ç‚¹å°±æ˜¯å­æ ‘ä¸­æ‰€æœ‰èŠ‚ç‚¹çš„â€œæœ€è¿‘å‰é©±â€ã€‚  

**å¯è§†åŒ–è®¾è®¡æ€è·¯**ï¼š  
é‡‡ç”¨8ä½åƒç´ é£æ ¼ï¼ˆç±»ä¼¼FCæ¸¸æˆã€Šè¶…çº§é©¬é‡Œå¥¥ã€‹ï¼‰ï¼Œå°†æ ‘ç»“æ„å±•ç¤ºä¸ºâ€œå€’ç”Ÿé•¿â€çš„å½¢æ€ï¼ˆæ ¹èŠ‚ç‚¹åœ¨é¡¶éƒ¨ï¼Œå­èŠ‚ç‚¹å‘ä¸‹æ’åˆ—ï¼‰ã€‚èŠ‚ç‚¹ç”¨ä¸åŒé¢œè‰²æ ‡è®°ï¼š**æ ¹èŠ‚ç‚¹ï¼ˆ`0`æˆ–`n+1`ï¼‰ä¸ºçº¢è‰²**ã€**å¶å­èŠ‚ç‚¹ä¸ºç»¿è‰²**ã€**éå¶å­èŠ‚ç‚¹ä¸ºè“è‰²**ï¼Œè¾¹ç”¨ç®­å¤´è¡¨ç¤ºçˆ¶å­å…³ç³»ã€‚éå†è¿‡ç¨‹ä¸­ï¼Œå½“å‰èŠ‚ç‚¹ç”¨é»„è‰²é«˜äº®ï¼Œè¾“å‡ºèŠ‚ç‚¹æ—¶æ’­æ”¾â€œå®â€çš„åƒç´ éŸ³æ•ˆï¼Œå®Œæˆéå†åæ’­æ”¾èƒœåˆ©éŸ³æ•ˆï¼ˆå¦‚ã€Šé­‚æ–—ç½—ã€‹é€šå…³éŸ³æ•ˆï¼‰ã€‚


## 2. ç²¾é€‰ä¼˜è´¨é¢˜è§£å‚è€ƒ

### é¢˜è§£ä¸€ï¼šæ¥æºï¼šyingkeqian9217ï¼ˆèµï¼š13ï¼‰  
* **ç‚¹è¯„**ï¼š  
  è¿™ä»½é¢˜è§£**æ€è·¯æ¸…æ™°ã€æ­¥éª¤è¯¦ç»†**ï¼Œåˆ†`Part`è®²è§£äº†`k`çš„ç¡®å®šã€æ ‘ç»“æ„çš„å»ºç«‹å’Œéå†æ–¹æ³•ã€‚ä½œè€…é€šè¿‡ç”»å›¾ç›´è§‚å±•ç¤ºäº†èŠ‚ç‚¹é—´çš„å‰é©±å…³ç³»ï¼Œå¸®åŠ©ç†è§£æ ‘ç»“æ„çš„å½¢æˆã€‚ä»£ç **è§„èŒƒæ€§é«˜**ï¼Œä½¿ç”¨`vector`å­˜å‚¨æ¯ä¸ªèŠ‚ç‚¹çš„å„¿å­ï¼Œå¤„ç†å¤šæµ‹æ—¶æ­£ç¡®æ¸…ç©ºæ•°æ®ç»“æ„ã€‚**ç®—æ³•æœ‰æ•ˆæ€§å¼º**ï¼ŒDFSéå†ä¼˜å…ˆè¾“å‡ºå¶å­èŠ‚ç‚¹ï¼Œä¸¥æ ¼ä¿è¯äº†â€œæœ€è¿‘å‰é©±â€çš„è¦æ±‚ã€‚å®è·µä»·å€¼é«˜ï¼Œä»£ç å¯ç›´æ¥ç”¨äºç«èµ›ï¼Œè¾¹ç•Œå¤„ç†ï¼ˆå¦‚æ ¹èŠ‚ç‚¹çš„åˆ¤æ–­ï¼‰ä¸¥è°¨ã€‚ä½œè€…æåˆ°â€œç”»å›¾ä¸æ˜“â€ï¼Œæé†’æˆ‘ä»¬**å¯è§†åŒ–æ€è€ƒæ˜¯è§£å†³æ„é€ é—®é¢˜çš„å…³é”®**ã€‚


### é¢˜è§£äºŒï¼šæ¥æºï¼šAlex_Weiï¼ˆèµï¼š8ï¼‰  
* **ç‚¹è¯„**ï¼š  
  æ­¤é¢˜è§£**é€»è¾‘ä¸¥è°¨**ï¼Œé€šè¿‡æ•°å­¦æ¨å¯¼è¯æ˜äº†`k`çš„å”¯ä¸€æ€§ï¼ˆ`k`æ˜¯æ»¡è¶³æ¡ä»¶çš„å”¯ä¸€å€¼ï¼‰ï¼Œå¢å¼ºäº†ç»“è®ºçš„å¯ä¿¡åº¦ã€‚ä½œè€…æŒ‡å‡ºæ ‘ç»“æ„çš„æ ¹æ˜¯`0`æˆ–`n+1`ï¼Œå¹¶ä¸”**æ¯ä¸ªèŠ‚ç‚¹çš„å­èŠ‚ç‚¹ä¸­è‡³å¤šä¸€ä¸ªéå¶å­èŠ‚ç‚¹**ï¼ˆè¿™ä¸€æ€§è´¨æ˜¯éå†é¡ºåºçš„æ ¸å¿ƒï¼‰ã€‚è™½ç„¶ä»£ç æœªç›´æ¥ç»™å‡ºï¼Œä½†æ€è·¯çš„ä¸¥è°¨æ€§å€¼å¾—å­¦ä¹ ï¼Œå¸®åŠ©æˆ‘ä»¬æ·±å…¥ç†è§£é—®é¢˜çš„æœ¬è´¨ã€‚


### é¢˜è§£ä¸‰ï¼šæ¥æºï¼šsgl654321ï¼ˆèµï¼š3ï¼‰  
* **ç‚¹è¯„**ï¼š  
  è¿™ä»½é¢˜è§£**æ·±å…¥åˆ†æäº†æ ‘çš„æ€§è´¨**ï¼Œç‰¹åˆ«æ˜¯â€œæ¯ä¸ªèŠ‚ç‚¹æœ€å¤šä¸€ä¸ªéå¶å­å„¿å­â€çš„è¯æ˜ï¼Œå¡«è¡¥äº†æ€è·¯ä¸­çš„ç©ºç™½ã€‚ä½œè€…ä½¿ç”¨DFSç»Ÿè®¡å­æ ‘å¤§å°ï¼Œç¡®å®šéå¶å­èŠ‚ç‚¹çš„ä½ç½®ï¼Œä»£ç é€»è¾‘æ¸…æ™°ã€‚å®è·µä¸­ï¼Œè¿™ç§**ç»Ÿè®¡å­æ ‘å¤§å°çš„æ–¹æ³•**å¯ä»¥æ¨å¹¿åˆ°å…¶ä»–æ ‘ç»“æ„é—®é¢˜ï¼ˆå¦‚äºŒå‰æ ‘çš„ååºéå†ï¼‰ï¼Œå…·æœ‰å¯å‘æ€§ã€‚


## 3. æ ¸å¿ƒéš¾ç‚¹è¾¨æä¸è§£é¢˜ç­–ç•¥

### 1. å…³é”®ç‚¹1ï¼šå¦‚ä½•ç¡®å®š`k`çš„å€¼ï¼Ÿ  
* **åˆ†æ**ï¼š  
  `k`æ˜¯åŒºåˆ†å…ƒç´ ç±»åˆ«çš„é˜ˆå€¼ï¼Œå…¶æ ¸å¿ƒæ€§è´¨æ˜¯ï¼š  
  - å¯¹äº`i â‰¤ k`ï¼Œ`b[i] > i`ï¼ˆå› ä¸ºå®ƒä»¬çš„å‰é©±æ˜¯`>k`çš„å…ƒç´ æˆ–`n+1`ï¼‰ï¼›  
  - å¯¹äº`i > k`ï¼Œ`b[i] < i`ï¼ˆå› ä¸ºå®ƒä»¬çš„å‰é©±æ˜¯`â‰¤k`çš„å…ƒç´ æˆ–`0`ï¼‰ã€‚  
  å› æ­¤ï¼Œåªéœ€éå†`b`æ•°ç»„ï¼Œæ‰¾åˆ°**æœ€å¤§çš„`i`ä½¿å¾—`b[i] > i`**ï¼Œè¿™ä¸ª`i`å°±æ˜¯`k`ã€‚ä¾‹å¦‚ï¼Œæ ·ä¾‹1ä¸­`b = [5,3,1,2]`ï¼Œéå†å¾—åˆ°`i=1`æ—¶`b[1]=5>1`ï¼Œ`i=2`æ—¶`b[2]=3>2`ï¼Œ`i=3`æ—¶`b[3]=1<3`ï¼Œæ‰€ä»¥`k=2`ã€‚  
* ğŸ’¡ **å­¦ä¹ ç¬”è®°**ï¼š`k`çš„ç¡®å®šæ˜¯é—®é¢˜çš„çªç ´å£ï¼ŒæŠ“ä½`b`æ•°ç»„çš„æ€§è´¨å¯ä»¥å¿«é€Ÿæ±‚è§£ã€‚


### 2. å…³é”®ç‚¹2ï¼šå¦‚ä½•å»ºç«‹æ ‘ç»“æ„ï¼Ÿ  
* **åˆ†æ**ï¼š  
  æ¯ä¸ª`i`çš„çˆ¶èŠ‚ç‚¹æ˜¯`b[i]`ï¼ˆ`b[i]`æ˜¯`i`åœ¨æ’åˆ—ä¸­çš„â€œæœ€è¿‘ä¸åŒç±»å‰é©±â€ï¼‰ã€‚æ ¹èŠ‚ç‚¹æ˜¯`0`æˆ–`n+1`ï¼ˆæ’åˆ—çš„ç¬¬ä¸€ä¸ªå…ƒç´ ï¼Œæ²¡æœ‰å‰é©±ï¼‰ã€‚ä¾‹å¦‚ï¼Œæ ·ä¾‹1ä¸­`b[1]=5`ï¼ˆ`n+1=5`ï¼‰ï¼Œæ‰€ä»¥`1`çš„çˆ¶èŠ‚ç‚¹æ˜¯`5`ï¼›`b[2]=3`ï¼Œæ‰€ä»¥`2`çš„çˆ¶èŠ‚ç‚¹æ˜¯`3`ï¼›`b[3]=1`ï¼Œæ‰€ä»¥`3`çš„çˆ¶èŠ‚ç‚¹æ˜¯`1`ï¼›`b[4]=2`ï¼Œæ‰€ä»¥`4`çš„çˆ¶èŠ‚ç‚¹æ˜¯`2`ã€‚æ ¹èŠ‚ç‚¹æ˜¯`5`ã€‚  
* ğŸ’¡ **å­¦ä¹ ç¬”è®°**ï¼šæ ‘ç»“æ„æ˜¯è¿˜åŸæ’åˆ—çš„æ ¸å¿ƒï¼Œå°†â€œå‰é©±å…³ç³»â€è½¬åŒ–ä¸ºâ€œçˆ¶å­å…³ç³»â€æ˜¯å…³é”®ã€‚


### 3. å…³é”®ç‚¹3ï¼šå¦‚ä½•éå†æ ‘å¾—åˆ°æ­£ç¡®çš„`a`æ•°ç»„ï¼Ÿ  
* **åˆ†æ**ï¼š  
  ä¸ºäº†ä¿è¯â€œæœ€è¿‘å‰é©±â€çš„è¦æ±‚ï¼Œéå†æ ‘æ—¶éœ€è¦**å…ˆè¾“å‡ºå¶å­èŠ‚ç‚¹ï¼ˆæ²¡æœ‰å­èŠ‚ç‚¹çš„èŠ‚ç‚¹ï¼‰ï¼Œå†è¾“å‡ºéå¶å­èŠ‚ç‚¹ï¼ˆæœ‰å­èŠ‚ç‚¹çš„èŠ‚ç‚¹ï¼‰**ã€‚å› ä¸ºéå¶å­èŠ‚ç‚¹çš„å­æ ‘éœ€è¦æ”¾åœ¨åé¢ï¼Œè¿™æ ·éå¶å­èŠ‚ç‚¹å°±æ˜¯å­æ ‘ä¸­æ‰€æœ‰èŠ‚ç‚¹çš„â€œæœ€è¿‘å‰é©±â€ã€‚ä¾‹å¦‚ï¼Œæ ·ä¾‹1ä¸­çš„æ ‘ç»“æ„æ˜¯`5â†’1â†’3â†’2â†’4`ï¼Œéå†é¡ºåºæ˜¯ï¼š`5`ï¼ˆæ ¹ï¼Œä¸è¾“å‡ºï¼‰â†’`1`çš„å¶å­èŠ‚ç‚¹ï¼ˆæ— ï¼‰â†’`1`çš„éå¶å­èŠ‚ç‚¹`3`â†’`3`çš„å¶å­èŠ‚ç‚¹ï¼ˆæ— ï¼‰â†’`3`çš„éå¶å­èŠ‚ç‚¹`2`â†’`2`çš„å¶å­èŠ‚ç‚¹ï¼ˆæ— ï¼‰â†’`2`çš„éå¶å­èŠ‚ç‚¹`4`â†’`4`çš„å¶å­èŠ‚ç‚¹ï¼ˆæ— ï¼‰ã€‚è¾“å‡ºé¡ºåºæ˜¯`1ã€3ã€2ã€4`ï¼Œç¬¦åˆæ ·ä¾‹çš„`a`æ•°ç»„ã€‚  
* ğŸ’¡ **å­¦ä¹ ç¬”è®°**ï¼šéå†é¡ºåºå†³å®šäº†æ’åˆ—çš„æ­£ç¡®æ€§ï¼Œä¼˜å…ˆè¾“å‡ºå¶å­èŠ‚ç‚¹æ˜¯å…³é”®ã€‚


### âœ¨ è§£é¢˜æŠ€å·§æ€»ç»“  
- **æŠ€å·§Aï¼šæ€§è´¨åˆ†æ**ï¼šé€šè¿‡é¢˜ç›®è§„åˆ™æç‚¼`b`æ•°ç»„çš„æ€§è´¨ï¼Œå¿«é€Ÿç¡®å®š`k`çš„å€¼ã€‚  
- **æŠ€å·§Bï¼šç»“æ„è½¬åŒ–**ï¼šå°†â€œå‰é©±å…³ç³»â€è½¬åŒ–ä¸ºæ ‘ç»“æ„ï¼Œå°†æ„é€ é—®é¢˜è½¬åŒ–ä¸ºæ ‘éå†é—®é¢˜ã€‚  
- **æŠ€å·§Cï¼šéå†é¡ºåº**ï¼šæ ¹æ®é—®é¢˜è¦æ±‚è®¾è®¡åˆé€‚çš„éå†é¡ºåºï¼ˆå¦‚ä¼˜å…ˆè¾“å‡ºå¶å­èŠ‚ç‚¹ï¼‰ï¼Œä¿è¯ç»“æœçš„æ­£ç¡®æ€§ã€‚


## 4. C++æ ¸å¿ƒä»£ç å®ç°èµæ

### æœ¬é¢˜é€šç”¨æ ¸å¿ƒC++å®ç°å‚è€ƒ  
* **è¯´æ˜**ï¼šæœ¬ä»£ç æ¥è‡ªyingkeqian9217çš„é¢˜è§£ï¼Œé€»è¾‘æ¸…æ™°ã€å®ç°é«˜æ•ˆï¼Œæ˜¯æ„é€ æ ‘ç»“æ„å¹¶éå†çš„å…¸å‹å®ç°ã€‚  
* **å®Œæ•´æ ¸å¿ƒä»£ç **ï¼š  
  ```cpp
  #include<bits/stdc++.h>
  #define maxn 290001
  using namespace std;
  int T,n,rt,kl,kr,k,b[maxn];
  vector<int>son[maxn];// è®°å½•æ¯ä¸ªèŠ‚ç‚¹çš„å„¿å­
  
  void dfs(int x){
      if(x&&x!=n+1) printf("%d ",x);// æ ¹èŠ‚ç‚¹ï¼ˆ0æˆ–n+1ï¼‰ä¸è¾“å‡º
      // å…ˆè¾“å‡ºå¶å­èŠ‚ç‚¹ï¼ˆæ²¡æœ‰å„¿å­çš„èŠ‚ç‚¹ï¼‰
      for(int i:son[x])
          if(son[i].empty())
              printf("%d ",i);
      // å†è¾“å‡ºéå¶å­èŠ‚ç‚¹ï¼ˆæœ‰å„¿å­çš„èŠ‚ç‚¹ï¼‰ï¼Œå¹¶é€’å½’éå†å…¶å­æ ‘
      for(int i:son[x])
          if(!son[i].empty())
              dfs(i);
  }
  
  void solve(){
      scanf("%d",&n);
      kl=0,kr=n;
      for(int i=0;i<=n+1;i++) son[i].clear();// æ¸…ç©ºå„¿å­æ•°ç»„
      for(int i=1;i<=n;i++){
          scanf("%d",&b[i]);
          if(!b[i]||b[i]==n+1) rt=b[i];// è®°å½•æ ¹èŠ‚ç‚¹ï¼ˆ0æˆ–n+1ï¼‰
          son[b[i]].push_back(i);
          kl=max(kl,min(i,b[i]));// æ›´æ–°kçš„ä¸‹ç•Œ
          kr=min(kr,max(i,b[i])+1);// æ›´æ–°kçš„ä¸Šç•Œ
      }
      printf("%d\n",kl);// è¾“å‡ºk
      dfs(rt);// éå†æ ‘è¾“å‡ºaæ•°ç»„
      printf("\n");
  }
  
  signed main(){
      scanf("%d",&T);
      while(T--) solve();// å¤„ç†å¤šç»„æµ‹è¯•ç”¨ä¾‹
      return 0;
  }
  ```  
* **ä»£ç è§£è¯»æ¦‚è¦**ï¼š  
  ä»£ç åˆ†ä¸ºä¸‰ä¸ªéƒ¨åˆ†ï¼š  
  1. **DFSå‡½æ•°**ï¼šéå†æ ‘ï¼Œä¼˜å…ˆè¾“å‡ºå¶å­èŠ‚ç‚¹ï¼Œå†è¾“å‡ºéå¶å­èŠ‚ç‚¹ã€‚  
  2. **solveå‡½æ•°**ï¼šå¤„ç†å•ç»„æµ‹è¯•ç”¨ä¾‹ï¼Œè¯»å–`b`æ•°ç»„ï¼Œå»ºç«‹æ ‘ç»“æ„ï¼Œç¡®å®š`k`å’Œæ ¹èŠ‚ç‚¹ï¼Œè°ƒç”¨DFSè¾“å‡º`a`æ•°ç»„ã€‚  
  3. **mainå‡½æ•°**ï¼šå¤„ç†å¤šç»„æµ‹è¯•ç”¨ä¾‹ã€‚


### é¢˜è§£ä¸€ï¼šæ¥æºï¼šyingkeqian9217  
* **äº®ç‚¹**ï¼šå·§å¦™ä½¿ç”¨`vector`å­˜å‚¨å„¿å­èŠ‚ç‚¹ï¼ŒDFSéå†ä¼˜å…ˆè¾“å‡ºå¶å­èŠ‚ç‚¹ï¼Œä¸¥æ ¼ä¿è¯â€œæœ€è¿‘å‰é©±â€çš„è¦æ±‚ã€‚  
* **æ ¸å¿ƒä»£ç ç‰‡æ®µ**ï¼š  
  ```cpp
  void dfs(int x){
      if(x&&x!=n+1) printf("%d ",x);
      for(int i:son[x])
          if(son[i].empty())
              printf("%d ",i);
      for(int i:son[x])
          if(!son[i].empty())
              dfs(i);
  }
  ```  
* **ä»£ç è§£è¯»**ï¼š  
  è¿™æ®µä»£ç æ˜¯DFSéå†çš„æ ¸å¿ƒï¼š  
  - é¦–å…ˆï¼Œè‹¥`x`ä¸æ˜¯æ ¹èŠ‚ç‚¹ï¼ˆ`0`æˆ–`n+1`ï¼‰ï¼Œåˆ™è¾“å‡º`x`ã€‚  
  - ç„¶åï¼Œéå†`x`çš„æ‰€æœ‰å„¿å­èŠ‚ç‚¹ï¼Œè‹¥å„¿å­èŠ‚ç‚¹æ˜¯å¶å­èŠ‚ç‚¹ï¼ˆ`son[i].empty()`ï¼‰ï¼Œåˆ™è¾“å‡ºè¯¥å„¿å­èŠ‚ç‚¹ã€‚  
  - æœ€åï¼Œéå†`x`çš„æ‰€æœ‰å„¿å­èŠ‚ç‚¹ï¼Œè‹¥å„¿å­èŠ‚ç‚¹æ˜¯éå¶å­èŠ‚ç‚¹ï¼ˆ`!son[i].empty()`ï¼‰ï¼Œåˆ™é€’å½’éå†è¯¥å„¿å­èŠ‚ç‚¹ã€‚  
  è¿™æ ·çš„é¡ºåºä¿è¯äº†å¶å­èŠ‚ç‚¹å…ˆè¢«è¾“å‡ºï¼Œéå¶å­èŠ‚ç‚¹åè¢«è¾“å‡ºï¼Œä»è€Œä¿è¯äº†éå¶å­èŠ‚ç‚¹æ˜¯å…¶æ‰€æœ‰å­èŠ‚ç‚¹çš„â€œæœ€è¿‘å‰é©±â€ã€‚  
* ğŸ’¡ **å­¦ä¹ ç¬”è®°**ï¼šDFSéå†çš„é¡ºåºæ˜¯æ„é€ æ­£ç¡®æ’åˆ—çš„å…³é”®ï¼Œä¼˜å…ˆè¾“å‡ºå¶å­èŠ‚ç‚¹å¯ä»¥ä¿è¯â€œæœ€è¿‘å‰é©±â€çš„è¦æ±‚ã€‚


## 5. ç®—æ³•å¯è§†åŒ–ï¼šåƒç´ åŠ¨ç”»æ¼”ç¤º (æ ¸å¿ƒéƒ¨åˆ†)

### åŠ¨ç”»æ¼”ç¤ºä¸»é¢˜  
**åƒç´ æ ‘éå†å†’é™©**ï¼ˆç±»ä¼¼FCæ¸¸æˆã€Šå†’é™©å²›ã€‹çš„é£æ ¼ï¼‰  

### æ ¸å¿ƒæ¼”ç¤ºå†…å®¹  
å±•ç¤ºæ ‘ç»“æ„çš„å»ºç«‹å’Œéå†è¿‡ç¨‹ï¼Œé‡ç‚¹æ¼”ç¤º**å¶å­èŠ‚ç‚¹ä¼˜å…ˆè¾“å‡º**çš„é¡ºåºã€‚  

### è®¾è®¡æ€è·¯ç®€è¿°  
é‡‡ç”¨8ä½åƒç´ é£æ ¼ï¼Œè¥é€ å¤å¤æ¸¸æˆæ°›å›´ï¼Œè®©å­¦ä¹ è€…åœ¨è½»æ¾çš„ç¯å¢ƒä¸­ç†è§£æ ‘éå†çš„é¡ºåºã€‚ä½¿ç”¨ä¸åŒé¢œè‰²æ ‡è®°èŠ‚ç‚¹ï¼ˆæ ¹èŠ‚ç‚¹çº¢è‰²ã€å¶å­èŠ‚ç‚¹ç»¿è‰²ã€éå¶å­èŠ‚ç‚¹è“è‰²ï¼‰ï¼Œç®­å¤´è¡¨ç¤ºçˆ¶å­å…³ç³»ã€‚åŠ¨ç”»æ­¥éª¤åŒ…æ‹¬**åˆå§‹åŒ–**ã€**æ ¹èŠ‚ç‚¹é«˜äº®**ã€**éå†å¶å­èŠ‚ç‚¹**ã€**éå†éå¶å­èŠ‚ç‚¹**ï¼Œä¼´éšéŸ³æ•ˆå¢å¼ºè®°å¿†ã€‚  

### åŠ¨ç”»å¸§æ­¥éª¤ä¸äº¤äº’å…³é”®ç‚¹  
1. **åœºæ™¯ä¸UIåˆå§‹åŒ–**ï¼š  
   - å±å¹•é¡¶éƒ¨æ˜¾ç¤ºæ ‡é¢˜â€œPermutation Addicts æ ‘éå†æ¼”ç¤ºâ€ã€‚  
   - ä¸­é—´åŒºåŸŸå±•ç¤ºåƒç´ æ ‘ç»“æ„ï¼ˆå¦‚æ ·ä¾‹1çš„æ ‘ï¼š`5â†’1â†’3â†’2â†’4`ï¼‰ï¼Œæ ¹èŠ‚ç‚¹`5`ä½äºé¡¶éƒ¨ï¼Œå­èŠ‚ç‚¹å‘ä¸‹æ’åˆ—ã€‚  
   - åº•éƒ¨æ§åˆ¶é¢æ¿æœ‰â€œå¼€å§‹â€ã€â€œå•æ­¥â€ã€â€œé‡ç½®â€æŒ‰é’®ï¼Œä»¥åŠé€Ÿåº¦æ»‘å—ï¼ˆè°ƒæ•´åŠ¨ç”»é€Ÿåº¦ï¼‰ã€‚  
   - æ’­æ”¾8ä½é£æ ¼çš„èƒŒæ™¯éŸ³ä¹ï¼ˆå¦‚ã€Šè¶…çº§é©¬é‡Œå¥¥ã€‹çš„èƒŒæ™¯éŸ³ä¹ï¼‰ã€‚  

2. **ç®—æ³•å¯åŠ¨ä¸æ•°æ®åˆå§‹åŒ–**ï¼š  
   - æ ¹èŠ‚ç‚¹`5`ç”¨çº¢è‰²é«˜äº®ï¼Œæ˜¾ç¤ºæ–‡å­—â€œæ ¹èŠ‚ç‚¹ï¼š5â€ã€‚  
   - å„¿å­èŠ‚ç‚¹`1`ç”¨è“è‰²æ ‡è®°ï¼Œç®­å¤´ä»`5`æŒ‡å‘`1`ã€‚  

3. **æ ¸å¿ƒç®—æ³•æ­¥éª¤åŠ¨æ€æ¼”ç¤º**ï¼š  
   - **å•æ­¥æ‰§è¡Œ**ï¼šç‚¹å‡»â€œå•æ­¥â€æŒ‰é’®ï¼Œå½“å‰èŠ‚ç‚¹`5`çš„å¶å­èŠ‚ç‚¹ï¼ˆæ— ï¼‰ä¸è¾“å‡ºï¼Œç„¶åéå†éå¶å­èŠ‚ç‚¹`1`ã€‚  
   - **å¶å­èŠ‚ç‚¹è¾“å‡º**ï¼šèŠ‚ç‚¹`1`çš„å¶å­èŠ‚ç‚¹ï¼ˆæ— ï¼‰ä¸è¾“å‡ºï¼Œéå†éå¶å­èŠ‚ç‚¹`3`ï¼›èŠ‚ç‚¹`3`çš„å¶å­èŠ‚ç‚¹ï¼ˆæ— ï¼‰ä¸è¾“å‡ºï¼Œéå†éå¶å­èŠ‚ç‚¹`2`ï¼›èŠ‚ç‚¹`2`çš„å¶å­èŠ‚ç‚¹ï¼ˆæ— ï¼‰ä¸è¾“å‡ºï¼Œéå†éå¶å­èŠ‚ç‚¹`4`ï¼›èŠ‚ç‚¹`4`çš„å¶å­èŠ‚ç‚¹ï¼ˆæ— ï¼‰ä¸è¾“å‡ºï¼Œé€’å½’è¿”å›ã€‚  
   - **éå¶å­èŠ‚ç‚¹è¾“å‡º**ï¼šé€’å½’è¿”å›åï¼Œè¾“å‡ºèŠ‚ç‚¹`4`ï¼ˆç»¿è‰²ï¼‰ï¼Œæ’­æ”¾â€œå®â€çš„éŸ³æ•ˆï¼›ç„¶åè¾“å‡ºèŠ‚ç‚¹`2`ï¼ˆç»¿è‰²ï¼‰ï¼Œæ’­æ”¾éŸ³æ•ˆï¼›æ¥ç€è¾“å‡ºèŠ‚ç‚¹`3`ï¼ˆç»¿è‰²ï¼‰ï¼Œæ’­æ”¾éŸ³æ•ˆï¼›æœ€åè¾“å‡ºèŠ‚ç‚¹`1`ï¼ˆç»¿è‰²ï¼‰ï¼Œæ’­æ”¾éŸ³æ•ˆã€‚  
   - **çŠ¶æ€æ˜¾ç¤º**ï¼šå±å¹•å³ä¾§æ˜¾ç¤ºå½“å‰è¾“å‡ºçš„æ’åˆ—`a`æ•°ç»„ï¼Œå¦‚â€œ`a = [1, 3, 2, 4]`â€ã€‚  

4. **ç›®æ ‡è¾¾æˆ/ç»“æŸçŠ¶æ€**ï¼š  
   - éå†å®Œæˆåï¼Œæ‰€æœ‰èŠ‚ç‚¹éƒ½ç”¨ç»¿è‰²æ ‡è®°ï¼Œæ’­æ”¾èƒœåˆ©éŸ³æ•ˆï¼ˆå¦‚ã€Šé­‚æ–—ç½—ã€‹çš„é€šå…³éŸ³æ•ˆï¼‰ã€‚  
   - æ˜¾ç¤ºæ–‡å­—â€œæ’åˆ—`a`æ„é€ å®Œæˆï¼â€ã€‚  

### æ—ç™½æç¤º  
- â€œæ ¹èŠ‚ç‚¹æ˜¯`5`ï¼Œå®ƒæ˜¯æ’åˆ—çš„ç¬¬ä¸€ä¸ªå…ƒç´ å—ï¼Ÿä¸ï¼Œæ ¹èŠ‚ç‚¹ä¸è¾“å‡ºï¼Œå®ƒçš„å„¿å­æ˜¯`1`ã€‚â€  
- â€œèŠ‚ç‚¹`1`çš„å¶å­èŠ‚ç‚¹æ²¡æœ‰ï¼Œæ‰€ä»¥éå†å®ƒçš„éå¶å­èŠ‚ç‚¹`3`ã€‚â€  
- â€œèŠ‚ç‚¹`4`æ˜¯å¶å­èŠ‚ç‚¹å—ï¼Ÿæ˜¯çš„ï¼Œè¾“å‡ºå®ƒï¼å¬åˆ°â€˜å®â€™çš„å£°éŸ³äº†å—ï¼Ÿè¿™è¡¨ç¤ºè¾“å‡ºäº†ä¸€ä¸ªèŠ‚ç‚¹ã€‚â€  
- â€œæ’åˆ—`a`æ„é€ å®Œæˆäº†ï¼Œçœ‹çœ‹æ˜¯ä¸æ˜¯å’Œæ ·ä¾‹ä¸€æ ·ï¼Ÿâ€


## 6. æ‹“å±•ç»ƒä¹ ä¸ç›¸ä¼¼é—®é¢˜æ€è€ƒ

### é€šç”¨æ€è·¯/æŠ€å·§è¿ç§»  
- **æ„é€ ç®—æ³•**ï¼šæœ¬é¢˜çš„æ„é€ æ€è·¯å¯ä»¥è¿ç§»åˆ°å…¶ä»–éœ€è¦æ ¹æ®å‰é©±å…³ç³»è¿˜åŸåºåˆ—çš„é—®é¢˜ï¼ˆå¦‚æ ¹æ®`next`æ•°ç»„è¿˜åŸå­—ç¬¦ä¸²ï¼‰ã€‚  
- **æ ‘ç»“æ„åº”ç”¨**ï¼šå°†é—®é¢˜è½¬åŒ–ä¸ºæ ‘ç»“æ„ï¼Œé€šè¿‡éå†æ ‘è§£å†³é—®é¢˜çš„æ€è·¯ï¼Œå¯ç”¨äºè§£å†³å¦‚äºŒå‰æ ‘çš„å‰åºéå†ã€ååºéå†ç­‰é—®é¢˜ã€‚  
- **æ€§è´¨åˆ†æ**ï¼šé€šè¿‡åˆ†æé—®é¢˜ä¸­çš„è§„åˆ™ï¼Œæç‚¼å‡ºå…³é”®æ€§è´¨ï¼ˆå¦‚`k`çš„ç¡®å®šï¼‰ï¼Œå¯ç”¨äºè§£å†³å¦‚æ’åºé—®é¢˜ä¸­çš„é˜ˆå€¼ç¡®å®šç­‰é—®é¢˜ã€‚  

### ç»ƒä¹ æ¨è (æ´›è°·)  
1. **æ´›è°· P1087  FBIæ ‘**  
   - ğŸ—£ï¸ **æ¨èç†ç”±**ï¼šè¿™é“é¢˜éœ€è¦æ„é€ FBIæ ‘ï¼Œå¹¶ç”¨ååºéå†è¾“å‡ºï¼Œé”»ç‚¼æ ‘ç»“æ„çš„æ„é€ å’Œéå†èƒ½åŠ›ã€‚  
2. **æ´›è°· P1305  æ–°äºŒå‰æ ‘**  
   - ğŸ—£ï¸ **æ¨èç†ç”±**ï¼šæ­¤é¢˜è¦æ±‚æ ¹æ®å‰åºéå†å’Œä¸­åºéå†æ„é€ äºŒå‰æ ‘ï¼Œå†è¾“å‡ºååºéå†ï¼Œå¢å¼ºå¯¹æ ‘ç»“æ„å’Œéå†é¡ºåºçš„ç†è§£ã€‚  
3. **æ´›è°· P2058  æµ·æ¸¯**  
   - ğŸ—£ï¸ **æ¨èç†ç”±**ï¼šè™½ç„¶è¿™é“é¢˜æ˜¯é˜Ÿåˆ—çš„åº”ç”¨ï¼Œä½†éœ€è¦å¤„ç†æ—¶é—´çª—å£å†…çš„å…ƒç´ ï¼Œé”»ç‚¼å¯¹é¡ºåºå’Œå‰é©±å…³ç³»çš„ç†è§£ã€‚  
4. **æ´›è°· P3916  å›¾çš„éå†**  
   - ğŸ—£ï¸ **æ¨èç†ç”±**ï¼šæ­¤é¢˜è¦æ±‚éå†å›¾ï¼Œæ‰¾åˆ°æ¯ä¸ªèŠ‚ç‚¹èƒ½åˆ°è¾¾çš„æœ€å¤§èŠ‚ç‚¹ï¼Œé”»ç‚¼å›¾éå†çš„èƒ½åŠ›ï¼Œä¸æœ¬é¢˜çš„æ ‘éå†æ€è·¯ç±»ä¼¼ã€‚


## 7. å­¦ä¹ å¿ƒå¾—ä¸ç»éªŒåˆ†äº« (è‹¥æœ‰)

### å‚è€ƒç»éªŒ (æ¥è‡ª yingkeqian9217)  
> â€œæˆ‘åœ¨è§£å†³è¿™ä¸ªé—®é¢˜æ—¶ï¼Œæœ€åˆå¯¹æ ‘ç»“æ„çš„éå†é¡ºåºæ„Ÿåˆ°å›°æƒ‘ï¼Œåæ¥é€šè¿‡ç”»å›¾å¸®åŠ©ç†è§£ï¼Œæ‰å‘ç°ä¼˜å…ˆè¾“å‡ºå¶å­èŠ‚ç‚¹çš„é‡è¦æ€§ã€‚â€  

**ç‚¹è¯„**ï¼šè¿™ä½ä½œè€…çš„ç»éªŒå¾ˆæœ‰ä»·å€¼ã€‚åœ¨è§£å†³æ„é€ é—®é¢˜æ—¶ï¼Œ**å¯è§†åŒ–æ€è€ƒï¼ˆå¦‚å›¾ç”»ï¼‰**å¯ä»¥å¸®åŠ©æˆ‘ä»¬ç›´è§‚ç†è§£é—®é¢˜ä¸­çš„å…³ç³»ï¼Œæ‰¾åˆ°æ­£ç¡®çš„è§£å†³æ€è·¯ã€‚ç”»å›¾ä¸ä»…èƒ½ç†æ¸…é€»è¾‘ï¼Œè¿˜èƒ½å‘ç°å®¹æ˜“å¿½ç•¥çš„ç»†èŠ‚ï¼ˆå¦‚éå†é¡ºåºï¼‰ã€‚


### å‚è€ƒç»éªŒ (æ¥è‡ª sgl654321)  
> â€œéƒ½æƒ³åˆ°æ„é€ å‡ºæ ‘çš„é‚£ä¸€æ­¥äº†ï¼Œè¿˜æ˜¯æ²¡æ•¢æ¥ç€å¾€ä¸‹æƒ³ã€‚åæ¥åˆ†æäº†æ ‘çš„æ€§è´¨ï¼Œæ‰çŸ¥é“æ¯ä¸ªèŠ‚ç‚¹æœ€å¤šä¸€ä¸ªéå¶å­å„¿å­ï¼Œè¿™æ‰æ•¢ç»§ç»­å†™ä»£ç ã€‚â€  

**ç‚¹è¯„**ï¼šè¿™ä½ä½œè€…çš„ç»å†æé†’æˆ‘ä»¬ï¼Œåœ¨è§£å†³é—®é¢˜æ—¶ï¼Œ**ä¸è¦å®³æ€•æ·±å…¥åˆ†æ**ã€‚å³ä½¿æƒ³åˆ°äº†å¤§è‡´æ€è·¯ï¼Œä¹Ÿè¦ç»§ç»­æŒ–æ˜é—®é¢˜çš„æ€§è´¨ï¼Œè¿™æ ·æ‰èƒ½æ‰¾åˆ°æ­£ç¡®çš„è§£å†³æ–¹æ³•ã€‚æ ‘çš„æ€§è´¨ï¼ˆå¦‚æ¯ä¸ªèŠ‚ç‚¹æœ€å¤šä¸€ä¸ªéå¶å­å„¿å­ï¼‰æ˜¯éå†é¡ºåºçš„å…³é”®ï¼Œåªæœ‰åˆ†ææ¸…æ¥šè¿™äº›æ€§è´¨ï¼Œæ‰èƒ½å†™å‡ºæ­£ç¡®çš„ä»£ç ã€‚


## ç»“è¯­  
æœ¬æ¬¡å…³äºâ€œPermutation Addictsâ€çš„C++è§£é¢˜åˆ†æå°±åˆ°è¿™é‡Œã€‚å¸Œæœ›è¿™ä»½å­¦ä¹ æŒ‡å—èƒ½å¸®åŠ©å¤§å®¶æ›´å¥½åœ°ç†è§£**æ„é€ ç®—æ³•**å’Œ**æ ‘çš„éå†**æŠ€å·§ã€‚è®°ä½ï¼Œç¼–ç¨‹èƒ½åŠ›çš„æå‡åœ¨äº**æŒç»­å­¦ä¹ ã€å‹¤äºæ€è€ƒå’Œå‹‡äºå®è·µ**ã€‚ä¸‹æ¬¡æˆ‘ä»¬å†ä¸€èµ·æ¢ç´¢æ–°çš„ç¼–ç¨‹æŒ‘æˆ˜ï¼ğŸ’ª

---
å¤„ç†ç”¨æ—¶ï¼š260.85ç§’
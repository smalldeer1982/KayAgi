# é¢˜ç›®ä¿¡æ¯

# Felicity's Big Secret Revealed

## é¢˜ç›®æè¿°

The gym leaders were fascinated by the evolutions which took place at Felicity camp. So, they were curious to know about the secret behind evolving Pokemon.

The organizers of the camp gave the gym leaders a PokeBlock, a sequence of $ n $ ingredients. Each ingredient can be of type $ 0 $ or $ 1 $ . Now the organizers told the gym leaders that to evolve a Pokemon of type $ k $ ( $ k>=2 $ ), they need to make a valid set of $ k $ cuts on the PokeBlock to get smaller blocks.

Suppose the given PokeBlock sequence is $ b_{0}b_{1}b_{2}...\ b_{n-1} $ . You have a choice of making cuts at $ n+1 $ places, i.e., Before $ b_{0} $ , between $ b_{0} $ and $ b_{1} $ , between $ b_{1} $ and $ b_{2} $ , ..., between $ b_{n-2} $ and $ b_{n-1} $ , and after $ b_{n-1} $ .

The $ n+1 $ choices of making cuts are as follows (where a | denotes a possible cut):

 $ |\ b_{0}\ |\ b_{1}\ |\ b_{2}\ |\ ...\ |\ b_{n-2}\ |\ b_{n-1}\ | $ Consider a sequence of $ k $ cuts. Now each pair of consecutive cuts will contain a binary string between them, formed from the ingredient types. The ingredients before the first cut and after the last cut are wasted, which is to say they are not considered. So there will be exactly $ k-1 $ such binary substrings. Every substring can be read as a binary number. Let $ m $ be the maximum number out of the obtained numbers. If all the obtained numbers are positive and the set of the obtained numbers contains all integers from $ 1 $ to $ m $ , then this set of cuts is said to be a valid set of cuts.

For example, suppose the given PokeBlock sequence is $ 101101001110 $ and we made $ 5 $ cuts in the following way:

 $ 10\ |\ 11\ |\ 010\ |\ 01\ |\ 1\ |\ 10 $ So the $ 4 $ binary substrings obtained are: $ 11 $ , $ 010 $ , $ 01 $ and $ 1 $ , which correspond to the numbers $ 3 $ , $ 2 $ , $ 1 $ and $ 1 $ respectively. Here $ m=3 $ , as it is the maximum value among the obtained numbers. And all the obtained numbers are positive and we have obtained all integers from $ 1 $ to $ m $ . Hence this set of cuts is a valid set of $ 5 $ cuts.

A Pokemon of type $ k $ will evolve only if the PokeBlock is cut using a valid set of $ k $ cuts. There can be many valid sets of the same size. Two valid sets of $ k $ cuts are considered different if there is a cut in one set which is not there in the other set.

Let $ f(k) $ denote the number of valid sets of $ k $ cuts. Find the value of ![](https://cdn.luogu.com.cn/upload/vjudge_pic/CF757D/752917f3f08a748323db829d6086efa4b31f63b6.png). Since the value of $ s $ can be very large, output $ s $ modulo $ 10^{9}+7 $ .

## è¯´æ˜/æç¤º

In the first sample, the sets of valid cuts are:

Size $ 2 $ : |1|011, 1|01|1, 10|1|1, 101|1|.

Size $ 3 $ : |1|01|1, |10|1|1, 10|1|1|, 1|01|1|.

Size $ 4 $ : |10|1|1|, |1|01|1|.

Hence, $ f(2)=4 $ , $ f(3)=4 $ and $ f(4)=2 $ . So, the value of $ s=10 $ .

In the second sample, the set of valid cuts is:

Size $ 2 $ : |1|0.

Hence, $ f(2)=1 $ and $ f(3)=0 $ . So, the value of $ s=1 $ .

## æ ·ä¾‹ #1

### è¾“å…¥

```
4
1011
```

### è¾“å‡º

```
10
```

## æ ·ä¾‹ #2

### è¾“å…¥

```
2
10
```

### è¾“å‡º

```
1
```

# AIåˆ†æç»“æœ

# ğŸ’¡ Kayçš„C++ç®—æ³•è§£æï¼šFelicity's Big Secret Revealed æ·±å…¥å­¦ä¹ æŒ‡å— ğŸ’¡


ä»Šå¤©æˆ‘ä»¬æ¥ä¸€èµ·åˆ†æã€ŒFelicity's Big Secret Revealedã€è¿™é“C++ç¼–ç¨‹é¢˜ã€‚æœ¬æŒ‡å—å°†å¸®åŠ©å¤§å®¶æ¢³ç†é¢˜ç›®æ€è·¯ï¼Œç†è§£æ ¸å¿ƒçš„**çŠ¶å‹åŠ¨æ€è§„åˆ’**ç®—æ³•ï¼Œå¹¶æŒæ¡è§£é¢˜æŠ€å·§ã€‚


## 1. é¢˜ç›®è§£è¯»ä¸æ ¸å¿ƒç®—æ³•è¯†åˆ«

âœ¨ **æœ¬é¢˜ä¸»è¦è€ƒå¯Ÿ**ï¼šçŠ¶å‹åŠ¨æ€è§„åˆ’ï¼ˆçŠ¶æ€å‹ç¼©DPï¼‰

ğŸ—£ï¸ **åˆæ­¥åˆ†æ**ï¼š
è§£å†³è¿™é“é¢˜çš„å…³é”®åœ¨äº**ç”¨äºŒè¿›åˆ¶æ©ç è·Ÿè¸ªå·²é€‰æ•°å­—çš„é›†åˆ**ã€‚ç®€å•æ¥è¯´ï¼ŒçŠ¶å‹DPå°±åƒç”¨ä¸€ä¸ªâ€œäºŒè¿›åˆ¶è´¦æœ¬â€è®°å½•æˆ‘ä»¬å·²ç»æ”¶é›†äº†å“ªäº›æ•°å­—â€”â€”æ¯”å¦‚æ©ç `101`ï¼ˆäºŒè¿›åˆ¶ï¼‰è¡¨ç¤ºæˆ‘ä»¬å·²ç»æœ‰äº†æ•°å­—1å’Œ3ï¼ˆå› ä¸ºç¬¬0ä½å’Œç¬¬2ä½æ˜¯1ï¼Œå¯¹åº”æ•°å­—1å’Œ3ï¼‰ã€‚

### é¢˜ç›®æ ¸å¿ƒä¸ç®—æ³•åº”ç”¨
é¢˜ç›®è¦æ±‚åˆ‡å‰²åçš„å­ä¸²æ•°å­—å¿…é¡»åŒ…å«**1åˆ°æœ€å¤§å€¼çš„æ‰€æœ‰æ•´æ•°**ã€‚ç”±äº01ä¸²é•¿åº¦â‰¤75ï¼Œè€Œå‰20ä¸ªæ­£æ•´æ•°çš„äºŒè¿›åˆ¶æ€»é•¿åº¦ï¼ˆ1+2+3+â€¦+5ï¼‰åˆšå¥½æ¥è¿‘75ï¼Œå› æ­¤æœ€å¤§å€¼ä¸å¯èƒ½è¶…è¿‡20ï¼ˆå¦åˆ™äºŒè¿›åˆ¶ä¸²é•¿åº¦ä¼šè¶…è¿‡é¢˜ç›®é™åˆ¶ï¼‰ã€‚è¿™è®©æˆ‘ä»¬å¯ä»¥ç”¨**20ä½çš„äºŒè¿›åˆ¶æ©ç **ï¼ˆå…±`1<<20=1,048,576`ç§çŠ¶æ€ï¼‰æ¥é«˜æ•ˆè·Ÿè¸ªå·²é€‰æ•°å­—ã€‚

### æ ¸å¿ƒç®—æ³•æµç¨‹
1. **çŠ¶æ€å®šä¹‰**ï¼š`dp[i][mask]`è¡¨ç¤º**æœ€åä¸€æ¬¡åˆ‡å‰²åœ¨ç¬¬iä½ä¹‹å‰**ï¼ˆå³å¤„ç†åˆ°ç¬¬iä½ï¼‰ï¼Œä¸”å·²é€‰æ•°å­—é›†åˆä¸º`mask`çš„æ–¹æ¡ˆæ•°ã€‚
2. **åˆå§‹åŒ–**ï¼š`dp[i][0] = 1`ï¼ˆåœ¨ç¬¬iä½å‰åˆ‡ä¸€åˆ€ï¼Œæ­¤æ—¶è¿˜æ²¡æœ‰é€‰ä»»ä½•æ•°å­—ï¼Œå‰é¢çš„éƒ¨åˆ†è¢«èˆå¼ƒï¼‰ã€‚
3. **è½¬ç§»**ï¼šå¯¹äºæ¯ä¸ªiå’Œmaskï¼Œæšä¸¾ä¸‹ä¸€ä¸ªåˆ‡å‰²ç‚¹jï¼Œè®¡ç®—å­ä¸²`s[i..j-1]`çš„åè¿›åˆ¶å€¼pã€‚å¦‚æœpæ˜¯æ­£æ•´æ•°ä¸”â‰¤20ï¼Œå°±å°†çŠ¶æ€è½¬ç§»åˆ°`dp[j][mask | (1<<(p-1))]`ï¼ˆæŠŠpåŠ å…¥é›†åˆï¼‰ã€‚
4. **ç»“æœç»Ÿè®¡**ï¼šæ‰€æœ‰æ»¡è¶³`mask=(1<<t)-1`ï¼ˆåŒ…å«1åˆ°tçš„æ‰€æœ‰æ•°å­—ï¼‰çš„`dp[i][mask]`ä¹‹å’Œï¼Œå°±æ˜¯æ‰€æœ‰æœ‰æ•ˆåˆ‡å‰²çš„æ€»æ•°ï¼ˆå› ä¸ºåˆ‡å‰²kæ¬¡å¯¹åº”k-1ä¸ªå­ä¸²ï¼Œå³t=k-1ï¼‰ã€‚

### å¯è§†åŒ–è®¾è®¡æ€è·¯
æˆ‘ä»¬å¯ä»¥ç”¨**8ä½åƒç´ é£**æ¨¡æ‹Ÿ01ä¸²çš„åˆ‡å‰²è¿‡ç¨‹ï¼š
- ç”¨ä¸åŒé¢œè‰²çš„åƒç´ å—è¡¨ç¤º0å’Œ1ï¼ˆæ¯”å¦‚é»‘è‰²=0ï¼Œç™½è‰²=1ï¼‰ï¼›
- ç”¨çº¢è‰²ç«–çº¿è¡¨ç¤ºåˆ‡å‰²ç‚¹ï¼Œéšç€åŠ¨ç”»æ¨è¿›ï¼Œåˆ‡å‰²çº¿ä¼šä»å·¦åˆ°å³ç§»åŠ¨ï¼›
- å³ä¾§ç”¨äºŒè¿›åˆ¶ç¯é˜µå±•ç¤ºå½“å‰æ©ç ï¼ˆäº®ç¯è¡¨ç¤ºå·²é€‰æ•°å­—ï¼‰ï¼›
- æ¯å®Œæˆä¸€æ¬¡è½¬ç§»ï¼Œæ’­æ”¾â€œå®â€çš„åƒç´ éŸ³æ•ˆï¼Œå¼ºåŒ–è®°å¿†ã€‚


## 2. ç²¾é€‰ä¼˜è´¨é¢˜è§£å‚è€ƒ

ä¸ºäº†æ›´å¥½åœ°ç†è§£è§£é¢˜è¿‡ç¨‹ï¼Œæˆ‘ç­›é€‰äº†ä»¥ä¸‹æ€è·¯æ¸…æ™°ã€ä»£ç ç®€æ´çš„ä¼˜è´¨é¢˜è§£ï¼š


### é¢˜è§£ä¸€ï¼šæ³ å°æ¯’ï¼ˆèµ4ï¼‰
* **ç‚¹è¯„**ï¼š
  è¿™ä»½é¢˜è§£çš„æ ¸å¿ƒæ€è·¯éå¸¸æ˜ç¡®â€”â€”ç›´æ¥æŠ“ä½â€œæœ€å¤§å€¼â‰¤20â€çš„å…³é”®ï¼Œç”¨çŠ¶å‹DPé«˜æ•ˆè§£å†³é—®é¢˜ã€‚ä»£ç ä¸­çš„çŠ¶æ€å®šä¹‰`dp[i][mask]`æ¸…æ™°ï¼Œè½¬ç§»é€»è¾‘ç›´æ¥ï¼ˆæšä¸¾åˆ‡å‰²ç‚¹jï¼Œè®¡ç®—å­ä¸²å€¼pï¼Œæ›´æ–°æ©ç ï¼‰ã€‚è¾¹ç•Œå¤„ç†ä¸¥è°¨ï¼ˆæ¯”å¦‚`p>0`é¿å…å‰å¯¼é›¶çš„æƒ…å†µï¼‰ï¼Œå¹¶ä¸”ç›´æ¥ç»Ÿè®¡æ‰€æœ‰æ»¡æ©ç çš„æƒ…å†µï¼Œç¬¦åˆé¢˜ç›®è¦æ±‚ã€‚ä»£ç é£æ ¼ç®€æ´ï¼Œå˜é‡å‘½åç›´è§‚ï¼ˆæ¯”å¦‚`a[i]`å­˜å‚¨01ä¸²ï¼Œ`lim=1<<20`è¡¨ç¤ºæ©ç ä¸Šé™ï¼‰ï¼Œéå¸¸é€‚åˆæ–°æ‰‹å­¦ä¹ ã€‚


### é¢˜è§£äºŒï¼šMihariï¼ˆèµ2ï¼‰
* **ç‚¹è¯„**ï¼š
  æ­¤é¢˜è§£çš„äº®ç‚¹åœ¨äº**æ˜ç¡®è§£é‡Šäº†çŠ¶æ€å®šä¹‰çš„åˆç†æ€§**â€”â€”ä¸ºä»€ä¹ˆç¬¬ä¸€ç»´æ˜¯`k+1`ï¼ˆå› ä¸ºåˆ‡å‰²ç‚¹åœ¨kä½ä¹‹åï¼Œä¸‹ä¸€æ¬¡å¤„ç†ä»k+1å¼€å§‹ï¼‰ã€‚åŒæ—¶ï¼Œå®ƒå¼ºè°ƒäº†â€œåˆå§‹çŠ¶æ€`f[i][0]=1`â€çš„å«ä¹‰ï¼ˆå‰é¢çš„éƒ¨åˆ†è¢«èˆå¼ƒï¼Œç©ºé›†æ–¹æ¡ˆæ•°ä¸º1ï¼‰ï¼Œå¸®åŠ©æ–°æ‰‹ç†è§£çŠ¶æ€çš„åˆå§‹æ¡ä»¶ã€‚è™½ç„¶ä»£ç æœªå®Œæ•´å±•ç¤ºï¼Œä½†æ€è·¯çš„è®²è§£éå¸¸é€å½»ã€‚


### é¢˜è§£ä¸‰ï¼šTarganzqqï¼ˆä»£ç ç®€æ´ï¼‰
* **ç‚¹è¯„**ï¼š
  è¿™ä»½é¢˜è§£çš„ä»£ç æ˜¯æ‰€æœ‰é¢˜è§£ä¸­æœ€ç®€æ´çš„ä¹‹ä¸€ï¼å®ƒç›´æ¥ç”¨`f[i][j]`è¡¨ç¤ºå‰i-1ä½çš„çŠ¶æ€jï¼Œè½¬ç§»æ—¶æšä¸¾åˆ‡å‰²ç‚¹kï¼Œè®¡ç®—på¹¶æ›´æ–°çŠ¶æ€ã€‚ä»£ç ä¸­çš„å¾ªç¯æ¡ä»¶`p<=20`é¿å…äº†æ— æ•ˆè®¡ç®—ï¼Œç»Ÿè®¡éƒ¨åˆ†ç›´æ¥ç´¯åŠ æ‰€æœ‰æ»¡æ©ç çš„æƒ…å†µï¼Œé€»è¾‘æ¸…æ™°ã€‚æ­¤å¤–ï¼Œä»£ç ä½¿ç”¨äº†`mod=1e9+7`å¤„ç†å¤§æ•°ï¼Œç¬¦åˆé¢˜ç›®è¦æ±‚ã€‚


## 3. æ ¸å¿ƒéš¾ç‚¹è¾¨æä¸è§£é¢˜ç­–ç•¥

åœ¨è§£å†³è¿™é“é¢˜æ—¶ï¼Œä»¥ä¸‹3ä¸ªå…³é”®ç‚¹å®¹æ˜“å¡å£³ï¼Œæˆ‘ä»¬é€ä¸€æ‹†è§£ï¼š


### 1. ä¸ºä»€ä¹ˆæœ€å¤§å€¼ä¸è¶…è¿‡20ï¼Ÿ
* **åˆ†æ**ï¼š
  å‰tä¸ªæ­£æ•´æ•°çš„äºŒè¿›åˆ¶æ€»é•¿åº¦æ˜¯`1*1 + 2*2 + 3*4 + 4*8 +5*5=74`ï¼ˆ1çš„é•¿åº¦1ï¼Œ2-3é•¿åº¦2ï¼Œ4-7é•¿åº¦3ï¼Œ8-15é•¿åº¦4ï¼Œ16-20é•¿åº¦5ï¼‰ï¼Œåˆšå¥½æ¥è¿‘é¢˜ç›®ä¸­n=75çš„é™åˆ¶ã€‚å¦‚æœt=21ï¼Œæ€»é•¿åº¦ä¼šè¾¾åˆ°74+5=79>75ï¼Œå› æ­¤æœ€å¤§å€¼ä¸å¯èƒ½è¶…è¿‡20ã€‚
* ğŸ’¡ **å­¦ä¹ ç¬”è®°**ï¼šé€šè¿‡è®¡ç®—äºŒè¿›åˆ¶æ€»é•¿åº¦ç¡®å®šçŠ¶æ€ä¸Šé™ï¼Œæ˜¯çŠ¶å‹DPçš„å¸¸ç”¨æŠ€å·§ï¼


### 2. å¦‚ä½•å®šä¹‰çŠ¶æ€`dp[i][mask]`ï¼Ÿ
* **åˆ†æ**ï¼š
  `i`è¡¨ç¤ºæœ€åä¸€æ¬¡åˆ‡å‰²çš„ä½ç½®ï¼ˆåœ¨ç¬¬iä½ä¹‹å‰ï¼‰ï¼Œ`mask`è¡¨ç¤ºå·²é€‰æ•°å­—çš„é›†åˆã€‚è¿™æ ·å®šä¹‰çš„å¥½å¤„æ˜¯ï¼šè½¬ç§»æ—¶åªéœ€è¦æšä¸¾ä¸‹ä¸€ä¸ªåˆ‡å‰²ç‚¹jï¼Œè®¡ç®—iåˆ°jä¹‹é—´çš„å­ä¸²å€¼ï¼Œå°±èƒ½è‡ªç„¶åœ°æ‰©å±•çŠ¶æ€ã€‚
* ğŸ’¡ **å­¦ä¹ ç¬”è®°**ï¼šçŠ¶æ€å®šä¹‰è¦â€œåŒ…å«æ‰€æœ‰å¿…è¦ä¿¡æ¯â€â€”â€”è¿™é‡Œéœ€è¦çŸ¥é“â€œæœ€åä¸€æ¬¡åˆ‡å‰²çš„ä½ç½®â€ï¼ˆä»¥ä¾¿æšä¸¾ä¸‹ä¸€ä¸ªåˆ‡å‰²ç‚¹ï¼‰å’Œâ€œå·²é€‰æ•°å­—é›†åˆâ€ï¼ˆä»¥ä¾¿åˆ¤æ–­æ˜¯å¦æ»¡è¶³æ¡ä»¶ï¼‰ã€‚


### 3. å¦‚ä½•ç»Ÿè®¡ç»“æœï¼Ÿ
* **åˆ†æ**ï¼š
  æ»¡æ©ç `(1<<t)-1`è¡¨ç¤ºåŒ…å«1åˆ°tçš„æ‰€æœ‰æ•°å­—ï¼Œå¯¹åº”çš„å­ä¸²æ•°é‡æ˜¯tï¼Œå› æ­¤åˆ‡å‰²æ¬¡æ•°æ˜¯t+1ï¼ˆç¬¦åˆé¢˜ç›®ä¸­kâ‰¥2çš„è¦æ±‚ï¼‰ã€‚ç»Ÿè®¡æ‰€æœ‰iå’Œtçš„`dp[i][(1<<t)-1]`ä¹‹å’Œï¼Œå°±æ˜¯æ‰€æœ‰æœ‰æ•ˆåˆ‡å‰²çš„æ€»æ•°ã€‚
* ğŸ’¡ **å­¦ä¹ ç¬”è®°**ï¼šç»“æœç»Ÿè®¡è¦å¯¹åº”é¢˜ç›®è¦æ±‚â€”â€”åˆ‡å‰²æ¬¡æ•°k=å­ä¸²æ•°+1ï¼Œæ»¡æ©ç å¯¹åº”å­ä¸²æ•°tï¼Œå› æ­¤k=t+1â‰¥2ç­‰ä»·äºtâ‰¥1ã€‚


### âœ¨ è§£é¢˜æŠ€å·§æ€»ç»“
- **çŠ¶æ€å‹ç¼©**ï¼šå½“éœ€è¦è·Ÿè¸ªâ€œé›†åˆæ˜¯å¦åŒ…å«æŸäº›å…ƒç´ â€ä¸”å…ƒç´ æ•°é‡â‰¤20æ—¶ï¼Œä¼˜å…ˆç”¨äºŒè¿›åˆ¶æ©ç ã€‚
- **è¾¹ç•Œå¤„ç†**ï¼šå­ä¸²å€¼å¿…é¡»æ˜¯æ­£æ•´æ•°ï¼ˆé¿å…å‰å¯¼é›¶ï¼Œæ¯”å¦‚`01`å¯¹åº”1ï¼Œä½†`0`æ˜¯æ— æ•ˆçš„ï¼‰ã€‚
- **å¾ªç¯ä¼˜åŒ–**ï¼šæšä¸¾åˆ‡å‰²ç‚¹æ—¶ï¼Œä¸€æ—¦å­ä¸²å€¼è¶…è¿‡20å°±breakï¼Œå‡å°‘æ— æ•ˆè®¡ç®—ã€‚


## 4. C++æ ¸å¿ƒä»£ç å®ç°èµæ

åœ¨æ·±å…¥åˆ†æå…·ä½“é¢˜è§£å‰ï¼Œå…ˆçœ‹ä¸€ä¸ª**é€šç”¨æ ¸å¿ƒå®ç°**ï¼š


### æœ¬é¢˜é€šç”¨æ ¸å¿ƒC++å®ç°å‚è€ƒ
* **è¯´æ˜**ï¼šç»¼åˆäº†æ³ å°æ¯’ã€Targanzqqç­‰é¢˜è§£çš„æ€è·¯ï¼Œä»£ç ç®€æ´é«˜æ•ˆï¼Œè¦†ç›–æ‰€æœ‰æ ¸å¿ƒé€»è¾‘ã€‚
* **å®Œæ•´æ ¸å¿ƒä»£ç **ï¼š
```cpp
#include <iostream>
#include <cstring>
using namespace std;

const int mod = 1e9 + 7;
const int MAX_N = 80;
const int MAX_MASK = 1 << 20; // 2^20=1,048,576

int n;
int a[MAX_N]; // å­˜å‚¨01ä¸²ï¼Œa[0]~a[n-1]
int dp[MAX_N][MAX_MASK]; // dp[i][mask]: æœ€åä¸€æ¬¡åˆ‡å‰²åœ¨iä½å‰ï¼ŒçŠ¶æ€maskçš„æ–¹æ¡ˆæ•°

int main() {
    cin >> n;
    for (int i = 0; i < n; ++i) {
        char c;
        cin >> c;
        a[i] = c - '0';
    }

    // åˆå§‹åŒ–ï¼šæ¯ä¸ªiä½å‰åˆ‡ä¸€åˆ€ï¼Œç©ºé›†æ–¹æ¡ˆæ•°ä¸º1
    for (int i = 0; i < n; ++i) {
        dp[i][0] = 1;
    }

    // çŠ¶æ€è½¬ç§»
    for (int i = 0; i < n; ++i) { // å½“å‰åˆ‡å‰²ç‚¹åœ¨iä½å‰
        for (int mask = 0; mask < MAX_MASK; ++mask) { // å½“å‰çŠ¶æ€mask
            if (!dp[i][mask]) continue; // æ— æ–¹æ¡ˆï¼Œè·³è¿‡

            int p = 0; // å­ä¸²s[i..j-1]çš„åè¿›åˆ¶å€¼
            for (int j = i; j < n; ++j) { // ä¸‹ä¸€ä¸ªåˆ‡å‰²ç‚¹åœ¨jä½å‰
                p = p * 2 + a[j];
                if (p > 20) break; // è¶…è¿‡æœ€å¤§å€¼ï¼Œåœæ­¢
                if (p == 0) continue; // å­ä¸²æ˜¯0ï¼Œæ— æ•ˆ

                // è½¬ç§»çŠ¶æ€ï¼šjä½å‰åˆ‡ä¸€åˆ€ï¼ŒmaskåŠ å…¥p
                dp[j + 1][mask | (1 << (p - 1))] = 
                    (dp[j + 1][mask | (1 << (p - 1))] + dp[i][mask]) % mod;
            }
        }
    }

    // ç»Ÿè®¡ç»“æœï¼šæ‰€æœ‰æ»¡æ©ç çš„æƒ…å†µ
    int ans = 0;
    for (int i = 0; i <= n; ++i) { // æœ€åä¸€æ¬¡åˆ‡å‰²åœ¨iä½å‰
        for (int t = 1; t <= 20; ++t) { // åŒ…å«1~tçš„æ‰€æœ‰æ•°å­—
            int full_mask = (1 << t) - 1;
            ans = (ans + dp[i][full_mask]) % mod;
        }
    }

    cout << ans << endl;
    return 0;
}
```
* **ä»£ç è§£è¯»æ¦‚è¦**ï¼š
  1. **è¾“å…¥å¤„ç†**ï¼šè¯»å–nå’Œ01ä¸²ï¼Œå­˜å‚¨åˆ°`a`æ•°ç»„ã€‚
  2. **åˆå§‹åŒ–**ï¼šæ¯ä¸ªä½ç½®iå‰åˆ‡ä¸€åˆ€ï¼Œç©ºé›†æ–¹æ¡ˆæ•°ä¸º1ï¼ˆ`dp[i][0]=1`ï¼‰ã€‚
  3. **çŠ¶æ€è½¬ç§»**ï¼šæšä¸¾å½“å‰åˆ‡å‰²ç‚¹iå’ŒçŠ¶æ€maskï¼Œå†æšä¸¾ä¸‹ä¸€ä¸ªåˆ‡å‰²ç‚¹jï¼Œè®¡ç®—å­ä¸²å€¼pï¼Œæ›´æ–°çŠ¶æ€ã€‚
  4. **ç»“æœç»Ÿè®¡**ï¼šç´¯åŠ æ‰€æœ‰æ»¡æ©ç çš„æ–¹æ¡ˆæ•°ï¼Œè¾“å‡ºç­”æ¡ˆã€‚


### é¢˜è§£ä¸€ï¼ˆæ³ å°æ¯’ï¼‰æ ¸å¿ƒç‰‡æ®µèµæ
* **äº®ç‚¹**ï¼šç›´æ¥å¤„ç†01ä¸²çš„æ¯ä¸€ä½ï¼Œè½¬ç§»é€»è¾‘ç®€æ´ã€‚
* **æ ¸å¿ƒä»£ç ç‰‡æ®µ**ï¼š
```cpp
for(int i=0;i<n;i++)
{
    dp[i][0]=1;
    for(int k=0;k<lim;k++)
    {
        if(!dp[i][k])continue;
        for(int j=i,p=a[i];j<n&&p<=20;j++,p=(p*2+a[j]))
            if(p)dp[j+1][k|(1<<(p-1))]=(dp[j+1][k|(1<<(p-1))]+dp[i][k])%mod;
    }
}
```
* **ä»£ç è§£è¯»**ï¼š
  - `dp[i][0]=1`ï¼šåˆå§‹åŒ–iä½å‰çš„ç©ºé›†æ–¹æ¡ˆæ•°ã€‚
  - `for(int k=0;k<lim;k++)`ï¼šéå†æ‰€æœ‰å¯èƒ½çš„æ©ç çŠ¶æ€ã€‚
  - `for(int j=i,p=a[i];j<n&&p<=20;j++,p=(p*2+a[j]))`ï¼šæšä¸¾ä¸‹ä¸€ä¸ªåˆ‡å‰²ç‚¹jï¼Œè®¡ç®—å­ä¸²å€¼pï¼ˆä»iåˆ°jï¼‰ã€‚
  - `if(p)dp[j+1][k|(1<<(p-1))] += dp[i][k]`ï¼šå¦‚æœpæœ‰æ•ˆï¼Œæ›´æ–°çŠ¶æ€ï¼ˆå°†påŠ å…¥é›†åˆï¼‰ã€‚
* ğŸ’¡ **å­¦ä¹ ç¬”è®°**ï¼šç”¨`p=a[i]`åˆå§‹åŒ–å­ä¸²å€¼ï¼Œç„¶åå¾ªç¯ä¸­æ›´æ–°pï¼Œæ˜¯è®¡ç®—è¿ç»­å­ä¸²äºŒè¿›åˆ¶å€¼çš„å¸¸ç”¨æ–¹æ³•ï¼


### é¢˜è§£ä¸‰ï¼ˆTarganzqqï¼‰æ ¸å¿ƒç‰‡æ®µèµæ
* **äº®ç‚¹**ï¼šä»£ç ç®€æ´ï¼Œå¾ªç¯æ¡ä»¶æ˜ç¡®ã€‚
* **æ ¸å¿ƒä»£ç ç‰‡æ®µ**ï¼š
```cpp
for(int i=0;i<n;i++){
    f[i][0]=1;
    for(int j=0;j<(1<<20);j++){
        if(!f[i][j])continue;
        for(int k=i,p=a[i];k<n&&p<=20;k++,p=p*2+a[k]){
            if(p){
                f[k+1][j|(1<<(p-1))]+=f[i][j];
                f[k+1][j|(1<<(p-1))]%=mod;
            }
        }
    }
}
```
* **ä»£ç è§£è¯»**ï¼š
  - `f[i][0]=1`ï¼šåŒä¹‹å‰çš„åˆå§‹åŒ–é€»è¾‘ã€‚
  - `for(int k=i,p=a[i];k<n&&p<=20;k++,p=p*2+a[k])`ï¼šæšä¸¾åˆ‡å‰²ç‚¹kï¼Œè®¡ç®—pï¼Œä¸€æ—¦p>20å°±åœæ­¢ï¼ˆä¼˜åŒ–ï¼‰ã€‚
  - `f[k+1][j|(1<<(p-1))] += f[i][j]`ï¼šè½¬ç§»çŠ¶æ€ï¼Œæ³¨æ„`k+1`æ˜¯ä¸‹ä¸€ä¸ªåˆ‡å‰²ç‚¹çš„ä½ç½®ã€‚
* ğŸ’¡ **å­¦ä¹ ç¬”è®°**ï¼šå¾ªç¯æ¡ä»¶`p<=20`å¯ä»¥æå‰ç»ˆæ­¢æ— æ•ˆè®¡ç®—ï¼Œæå‡æ•ˆç‡ï¼


## 5. ç®—æ³•å¯è§†åŒ–ï¼šåƒç´ åŠ¨ç”»æ¼”ç¤º (æ ¸å¿ƒéƒ¨åˆ†)

ä¸ºäº†æ›´ç›´è§‚åœ°ç†è§£çŠ¶å‹DPçš„è½¬ç§»è¿‡ç¨‹ï¼Œæˆ‘è®¾è®¡äº†ä¸€ä¸ª**8ä½åƒç´ é£åŠ¨ç”»**ï¼Œæ¨¡æ‹Ÿ01ä¸²çš„åˆ‡å‰²å’ŒçŠ¶æ€å˜åŒ–ï¼š


### åŠ¨ç”»æ¼”ç¤ºä¸»é¢˜
**åƒç´ æ¢é™©å®¶çš„æ•°å­—æ”¶é›†ä¹‹æ—…**ï¼šç©å®¶æ“æ§â€œåˆ‡å‰²çº¿â€åœ¨01ä¸²ï¼ˆåƒç´ ç½‘æ ¼ï¼‰ä¸Šç§»åŠ¨ï¼Œæ”¶é›†è¿ç»­çš„æ•°å­—ï¼Œç›®æ ‡æ˜¯æ”¶é›†1åˆ°æœ€å¤§å€¼çš„æ‰€æœ‰æ•°å­—ã€‚


### æ ¸å¿ƒæ¼”ç¤ºå†…å®¹
1. **åœºæ™¯åˆå§‹åŒ–**ï¼š
   - å±å¹•å·¦ä¾§æ˜¯8ä½åƒç´ çš„01ä¸²ï¼ˆæ¯”å¦‚æ ·ä¾‹1çš„`1011`ï¼Œç”¨é»‘è‰²=0ã€ç™½è‰²=1è¡¨ç¤ºï¼‰ã€‚
   - å³ä¾§æ˜¯20ä¸ªåƒç´ ç¯é˜µï¼ˆå¯¹åº”æ•°å­—1~20ï¼‰ï¼Œç¯äº®è¡¨ç¤ºå·²æ”¶é›†è¯¥æ•°å­—ã€‚
   - åº•éƒ¨æ˜¯æ§åˆ¶é¢æ¿ï¼š`å¼€å§‹/æš‚åœ`ã€`å•æ­¥`ã€`é‡ç½®`æŒ‰é’®ï¼Œä»¥åŠé€Ÿåº¦æ»‘å—ã€‚
   - èƒŒæ™¯éŸ³ä¹ï¼š8ä½é£æ ¼çš„è½»æ¾ç”µå­ä¹ï¼ˆç±»ä¼¼ã€Šå¦å…‹å¤§æˆ˜ã€‹ï¼‰ã€‚

2. **ç®—æ³•å¯åŠ¨**ï¼š
   - åˆå§‹åˆ‡å‰²çº¿åœ¨0ä½å‰ï¼ˆä¸²çš„æœ€å·¦ç«¯ï¼‰ï¼Œå³ä¾§ç¯é˜µå…¨ç­ï¼ˆç©ºé›†ï¼‰ã€‚
   - æ’­æ”¾â€œæ»´â€çš„åˆå§‹åŒ–éŸ³æ•ˆã€‚

3. **çŠ¶æ€è½¬ç§»æ¼”ç¤º**ï¼š
   - **åˆ‡å‰²çº¿ç§»åŠ¨**ï¼šåˆ‡å‰²çº¿ä»iä½å‰ç§»åŠ¨åˆ°jä½å‰ï¼Œç”¨çº¢è‰²ç«–çº¿é«˜äº®ã€‚
   - **å­ä¸²è®¡ç®—**ï¼šiåˆ°jä¹‹é—´çš„åƒç´ å—é—ªçƒï¼Œæ˜¾ç¤ºå¯¹åº”çš„äºŒè¿›åˆ¶å€¼ï¼ˆæ¯”å¦‚`10`â†’`2`ï¼‰ã€‚
   - **çŠ¶æ€æ›´æ–°**ï¼šå³ä¾§ç¯é˜µä¸­å¯¹åº”æ•°å­—çš„ç¯äº®èµ·ï¼ˆæ¯”å¦‚æ”¶é›†åˆ°2ï¼Œç¬¬1ä½ç¯äº®ï¼‰ï¼Œæ’­æ”¾â€œå®â€çš„éŸ³æ•ˆã€‚
   - **æ»¡æ©ç æç¤º**ï¼šå½“ç¯é˜µå…¨äº®ï¼ˆæ¯”å¦‚1~3å…¨äº®ï¼‰ï¼Œæ’­æ”¾â€œèƒœåˆ©â€éŸ³æ•ˆï¼Œå±å¹•æ˜¾ç¤ºâ€œæœ‰æ•ˆåˆ‡å‰²ï¼â€ã€‚

4. **äº¤äº’è®¾è®¡**ï¼š
   - **å•æ­¥æ¨¡å¼**ï¼šç‚¹å‡»â€œå•æ­¥â€æŒ‰é’®ï¼ŒåŠ¨ç”»æ‰§è¡Œä¸€æ­¥è½¬ç§»ï¼Œæ–¹ä¾¿è§‚å¯Ÿç»†èŠ‚ã€‚
   - **è‡ªåŠ¨æ¨¡å¼**ï¼šæ»‘åŠ¨é€Ÿåº¦æ»‘å—è°ƒæ•´æ’­æ”¾é€Ÿåº¦ï¼ŒåŠ¨ç”»è‡ªåŠ¨æ‰§è¡Œæ‰€æœ‰è½¬ç§»ã€‚
   - **é‡ç½®**ï¼šç‚¹å‡»â€œé‡ç½®â€æŒ‰é’®ï¼Œå›åˆ°åˆå§‹çŠ¶æ€ï¼Œé‡æ–°å¼€å§‹ã€‚


### è®¾è®¡æ€è·¯
- **åƒç´ é£æ ¼**ï¼šè¿˜åŸFCçº¢ç™½æœºçš„è§†è§‰æ•ˆæœï¼Œé™ä½å­¦ä¹ çš„ç´§å¼ æ„Ÿã€‚
- **éŸ³æ•ˆåé¦ˆ**ï¼šç”¨ä¸åŒéŸ³æ•ˆå¼ºåŒ–å…³é”®æ“ä½œï¼ˆåˆå§‹åŒ–ã€è½¬ç§»ã€æ»¡æ©ç ï¼‰ï¼Œå¸®åŠ©è®°å¿†ã€‚
- **ç¯é˜µå¯è§†åŒ–**ï¼šå°†æŠ½è±¡çš„æ©ç è½¬åŒ–ä¸ºç›´è§‚çš„ç¯é˜µï¼Œè®©â€œé›†åˆåŒ…å«å“ªäº›æ•°å­—â€ä¸€ç›®äº†ç„¶ã€‚


## 6. æ‹“å±•ç»ƒä¹ ä¸ç›¸ä¼¼é—®é¢˜æ€è€ƒ

æŒæ¡äº†çŠ¶å‹DPåï¼Œæˆ‘ä»¬å¯ä»¥è§£å†³æ›´å¤šç±»ä¼¼çš„â€œé›†åˆè·Ÿè¸ªâ€é—®é¢˜ï¼š


### é€šç”¨æ€è·¯è¿ç§»
çŠ¶å‹DPé€‚ç”¨äº**éœ€è¦è·Ÿè¸ªâ€œæ˜¯å¦é€‰æ‹©æŸäº›å…ƒç´ â€ä¸”å…ƒç´ æ•°é‡â‰¤20**çš„é—®é¢˜ï¼Œæ¯”å¦‚ï¼š
1. å­é›†å’Œé—®é¢˜ï¼šåˆ¤æ–­æ˜¯å¦å­˜åœ¨å­é›†å’Œä¸ºç›®æ ‡å€¼ã€‚
2. æ—…è¡Œå•†é—®é¢˜ï¼ˆTSPï¼‰ï¼šç”¨æ©ç è®°å½•å·²è®¿é—®çš„åŸå¸‚ã€‚
3. å­—ç¬¦ä¸²åŒ¹é…é—®é¢˜ï¼šè·Ÿè¸ªå·²åŒ¹é…çš„å­—ç¬¦é›†åˆã€‚


### æ´›è°·ç»ƒä¹ æ¨è
1. **æ´›è°· P1171** - å”®è´§å‘˜çš„éš¾é¢˜
   * ğŸ—£ï¸ **æ¨èç†ç”±**ï¼šç»å…¸TSPé—®é¢˜ï¼Œç”¨çŠ¶å‹DPè·Ÿè¸ªå·²è®¿é—®çš„åŸå¸‚ï¼Œå·©å›ºçŠ¶æ€å‹ç¼©æŠ€å·§ã€‚
2. **æ´›è°· P2170** - é€‰å­¦éœ¸
   * ğŸ—£ï¸ **æ¨èç†ç”±**ï¼šéœ€è¦è·Ÿè¸ªå·²é€‰çš„å­¦éœ¸é›†åˆï¼Œåˆ¤æ–­æ˜¯å¦æ»¡è¶³æ¡ä»¶ï¼Œå¼ºåŒ–é›†åˆè·Ÿè¸ªçš„æ€è·¯ã€‚
3. **æ´›è°· P3694** - é‚¦é‚¦çš„å¤§åˆå”±ç«™é˜Ÿ
   * ğŸ—£ï¸ **æ¨èç†ç”±**ï¼šç”¨çŠ¶å‹DPè·Ÿè¸ªå·²æ’å¥½é˜Ÿçš„å›¢ä½“ï¼Œç»ƒä¹ çŠ¶æ€è½¬ç§»çš„è®¾è®¡ã€‚


## 7. å­¦ä¹ å¿ƒå¾—ä¸ç»éªŒåˆ†äº« (è‹¥æœ‰)

æœ¬æ¬¡åˆ†æçš„é¢˜è§£ä¸­ï¼Œå¤šä½ä½œè€…æåˆ°äº†**â€œé€šè¿‡è®¡ç®—äºŒè¿›åˆ¶æ€»é•¿åº¦ç¡®å®šæœ€å¤§å€¼ä¸Šé™â€**çš„å…³é”®æŠ€å·§ï¼Œè¿™æ˜¯è§£å†³æœ¬é¢˜çš„çªç ´å£ã€‚ä¾‹å¦‚ï¼ŒAmaoFoxä½œè€…æåˆ°ï¼šâ€œåŠ åˆ°21æ—¶æ€»é•¿åº¦è¾¾åˆ°79ï¼Œè¶…è¿‡n=75ï¼Œå› æ­¤æœ€å¤§å€¼â‰¤20â€ã€‚è¿™æé†’æˆ‘ä»¬ï¼š**é‡åˆ°å­—ç¬¦ä¸²æˆ–æ•°å­—æ‹¼æ¥é—®é¢˜æ—¶ï¼Œå…ˆè®¡ç®—é•¿åº¦ä¸Šé™ï¼Œå¾€å¾€èƒ½ç¼©å°é—®é¢˜è§„æ¨¡**ï¼


## æ€»ç»“

æœ¬æ¬¡å…³äºã€ŒFelicity's Big Secret Revealedã€çš„åˆ†æå°±åˆ°è¿™é‡Œã€‚çŠ¶å‹DPæ˜¯è§£å†³â€œé›†åˆè·Ÿè¸ªâ€é—®é¢˜çš„ç¥å™¨ï¼Œæ ¸å¿ƒæ˜¯ç”¨äºŒè¿›åˆ¶æ©ç é«˜æ•ˆè¡¨ç¤ºçŠ¶æ€ã€‚å¸Œæœ›å¤§å®¶é€šè¿‡ç»ƒä¹ ï¼Œèƒ½ç†Ÿç»ƒæŒæ¡è¿™ç§ç®—æ³•ï¼

è®°ä½ï¼šç¼–ç¨‹çš„ä¹è¶£åœ¨äºâ€œæŠŠå¤æ‚é—®é¢˜æ‹†æˆç®€å•æ­¥éª¤â€ï¼ŒçŠ¶å‹DPå°±æ˜¯è¿™æ ·çš„å·¥å…·â€”â€”ç”¨äºŒè¿›åˆ¶çš„â€œç¯â€ç…§äº®æˆ‘ä»¬çš„è§£é¢˜ä¹‹è·¯ï¼ğŸ’ª

---
å¤„ç†ç”¨æ—¶ï¼š110.46ç§’
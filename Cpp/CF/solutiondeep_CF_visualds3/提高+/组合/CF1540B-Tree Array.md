# é¢˜ç›®ä¿¡æ¯

# Tree Array

## é¢˜ç›®æè¿°

You are given a tree consisting of $ n $ nodes. You generate an array from the tree by marking nodes one by one.

Initially, when no nodes are marked, a node is equiprobably chosen and marked from the entire tree.

After that, until all nodes are marked, a node is equiprobably chosen and marked from the set of unmarked nodes with at least one edge to a marked node.

It can be shown that the process marks all nodes in the tree.

The final array $ a $ is the list of the nodes' labels in order of the time each node was marked.

Find the expected number of inversions in the array that is generated by the tree and the aforementioned process.

The number of inversions in an array $ a $ is the number of pairs of indices $ (i, j) $ such that $ i < j $ and $ a_i > a_j $ . For example, the array $ [4, 1, 3, 2] $ contains $ 4 $ inversions: $ (1, 2) $ , $ (1, 3) $ , $ (1, 4) $ , $ (3, 4) $ .

## è¯´æ˜/æç¤º

This is the tree from the first sample:

 ![](https://cdn.luogu.com.cn/upload/vjudge_pic/CF1540B/3833e6cdc8f432e8774aa8c02d9352118566a812.png)For the first sample, the arrays are almost fixed. If node $ 2 $ is chosen initially, then the only possible array is $ [2, 1, 3] $ ( $ 1 $ inversion). If node $ 3 $ is chosen initially, then the only possible array is $ [3, 1, 2] $ ( $ 2 $ inversions). If node $ 1 $ is chosen initially, the arrays $ [1, 2, 3] $ ( $ 0 $ inversions) and $ [1, 3, 2] $ ( $ 1 $ inversion) are the only possibilities and equiprobable. In total, the expected number of inversions is $ \frac{1}{3}\cdot 1 + \frac{1}{3} \cdot 2 + \frac{1}{3} \cdot (\frac{1}{2} \cdot 0 + \frac{1}{2} \cdot 1) = \frac{7}{6} $ .

 $ 166666669 \cdot 6 = 7 \pmod {10^9 + 7} $ , so the answer is $ 166666669 $ .

This is the tree from the second sample:

 ![](https://cdn.luogu.com.cn/upload/vjudge_pic/CF1540B/7f613b365926417ec34142a093ccc13b3b572f4f.png)This is the tree from the third sample:

 ![](https://cdn.luogu.com.cn/upload/vjudge_pic/CF1540B/4cf8ac5fc765cc7cdc6657a332a13e66dcba8fef.png)

## æ ·ä¾‹ #1

### è¾“å…¥

```
3
1 2
1 3```

### è¾“å‡º

```
166666669```

## æ ·ä¾‹ #2

### è¾“å…¥

```
6
2 1
2 3
6 1
1 4
2 5```

### è¾“å‡º

```
500000009```

## æ ·ä¾‹ #3

### è¾“å…¥

```
5
1 2
1 3
1 4
2 5```

### è¾“å‡º

```
500000007```

# AIåˆ†æç»“æœ


# ğŸ’¡ Kayçš„C++ç®—æ³•è§£æï¼šTree Array æ·±å…¥å­¦ä¹ æŒ‡å— ğŸ’¡

> ä»Šå¤©æˆ‘ä»¬æ¥åˆ†æ"Tree Array"è¿™é“C++ç¼–ç¨‹é¢˜ã€‚æœ¬æŒ‡å—å°†å¸®åŠ©å¤§å®¶ç†è§£æ ‘ç»“æ„ä¸­çš„æœŸæœ›é€†åºå¯¹è®¡ç®—ï¼ŒæŒæ¡æœŸæœ›çº¿æ€§æ€§è´¨å’Œæ ‘å½¢DPçš„åº”ç”¨æŠ€å·§ã€‚

## 1. é¢˜ç›®è§£è¯»ä¸æ ¸å¿ƒç®—æ³•è¯†åˆ«

âœ¨ **æœ¬é¢˜ä¸»è¦è€ƒå¯Ÿ**ï¼š`æœŸæœ›DP` + `æ ‘å½¢ç»“æ„` + `æœ€è¿‘å…¬å…±ç¥–å…ˆ(LCA)`

ğŸ—£ï¸ **åˆæ­¥åˆ†æ**ï¼š
> è§£å†³"Tree Array"çš„å…³é”®åœ¨äºç†è§£**æœŸæœ›çš„çº¿æ€§æ€§è´¨**å’Œ**æ ‘å½¢ç»“æ„çš„è·¯å¾„åˆ†è§£**ã€‚æƒ³è±¡ä¸€ä¸‹ï¼Œè®¡ç®—æ•´æ£µæ ‘çš„æœŸæœ›é€†åºå¯¹å°±åƒæ•°æ¸…æ£®æ—é‡Œæ‰€æœ‰äº¤å‰å°å¾„çš„äº¤æ±‡æ¬¡æ•°â€”â€”ä¸å…¶æ•´ä½“è®¡ç®—ï¼Œä¸å¦‚å°†æ¯æ¡å°å¾„ï¼ˆç‚¹å¯¹ï¼‰åˆ†å¼€ç»Ÿè®¡ã€‚  
> - æ ¸å¿ƒæ€è·¯ï¼šå°†æ€»æœŸæœ›åˆ†è§£ä¸ºæ¯ä¸ªç‚¹å¯¹(i,j)ï¼ˆi>jï¼‰çš„è´¡çŒ®ï¼ˆå³iæ¯”jå…ˆè¢«æ ‡è®°çš„æ¦‚ç‡ï¼‰
> - æ ¸å¿ƒæŠ€å·§ï¼šæšä¸¾æ ¹èŠ‚ç‚¹åï¼Œé€šè¿‡LCAåˆ†è§£è·¯å¾„ï¼Œç”¨é¢„å¤„ç†çš„DPæ•°ç»„è®¡ç®—è·¯å¾„æ¦‚ç‡
> - å¯è§†åŒ–è®¾è®¡ï¼šåŠ¨ç”»å°†å±•ç¤ºæ ‘ç»“æ„ï¼Œé«˜äº®å½“å‰ç‚¹å¯¹è·¯å¾„ï¼ŒåŠ¨æ€æ¼”ç¤ºDPçŠ¶æ€è½¬ç§»ï¼ˆå¦‚åƒç´ æ¡è¡¨ç¤ºå‰©ä½™æ­¥æ•°ï¼‰ï¼Œå¤å¤éŸ³æ•ˆå¢å¼ºå…³é”®æ“ä½œåé¦ˆï¼ˆå¦‚"æ»´"å£°æ ‡è®°èŠ‚ç‚¹ï¼Œèƒœåˆ©éŸ³æ•ˆå®Œæˆè®¡ç®—ï¼‰

---

## 2. ç²¾é€‰ä¼˜è´¨é¢˜è§£å‚è€ƒ

**é¢˜è§£ä¸€ï¼ˆæ¥æºï¼šAcfboyï¼‰**
* **ç‚¹è¯„**ï¼šæ­¤è§£æ³•æ€è·¯æ¸…æ™°ä¸”å®Œæ•´ï¼š1) åˆ©ç”¨æœŸæœ›çº¿æ€§æ€§è½¬åŒ–é—®é¢˜ 2) æšä¸¾æ ¹èŠ‚ç‚¹å¤„ç†éšæœºèµ·ç‚¹ 3) é€šè¿‡LCAåˆ†è§£è·¯å¾„ 4) é¢„å¤„ç†æ¦‚ç‡DPã€‚ä»£ç è§„èŒƒï¼šå˜é‡å‘½ååˆç†ï¼ˆå¦‚`f[i][j]`è¡¨ç¤ºæ¦‚ç‡DPï¼‰ï¼Œè¾¹ç•Œå¤„ç†ä¸¥è°¨ï¼ˆ`f[0][i]=1`ï¼‰ã€‚äº®ç‚¹åœ¨äºå¯¹æ¦‚ç‡æ¨¡å‹çš„ç›´è§‚è§£é‡Šï¼ˆç±»æ¯”"ä¸¤ä¸ªæ ˆå¼¹çƒ"ï¼‰ï¼Œå®è·µä»·å€¼é«˜ï¼Œå¯ç›´æ¥ç”¨äºç«èµ›ã€‚

**é¢˜è§£äºŒï¼ˆæ¥æºï¼šdead_Xï¼‰**
* **ç‚¹è¯„**ï¼šè§£æ³•ç®€æ´æœ‰åŠ›ï¼Œçªå‡ºæ ¸å¿ƒæ€æƒ³â€”â€”LCAåˆ†è§£åè·¯å¾„æ¦‚ç‡ç‹¬ç«‹ã€‚ä»£ç ä¸­`f[i][j]`çš„é¢„å¤„ç†å’Œè°ƒç”¨é€»è¾‘æ¸…æ™°ï¼Œä½†LCAå®ç°é‡‡ç”¨æœ´ç´ DFSï¼ˆéå€å¢ï¼‰ï¼Œåœ¨$n=200$ä¸‹ä»é«˜æ•ˆã€‚äº®ç‚¹åœ¨äºé—®é¢˜æŠ½è±¡èƒ½åŠ›ï¼ˆå¿½ç•¥éè·¯å¾„ç‚¹ï¼‰ï¼Œå¸®åŠ©ç†è§£é—®é¢˜æœ¬è´¨ã€‚

**é¢˜è§£ä¸‰ï¼ˆæ¥æºï¼šCry_For_theMoonï¼‰**
* **ç‚¹è¯„**ï¼šé¢˜è§£ç»“æ„ä¸¥è°¨ï¼ŒåŒ…å«ï¼š1) æœŸæœ›åˆ†è§£è¯æ˜ 2) DPçŠ¶æ€è½¬ç§»æ¨å¯¼ 3) æ—¶é—´å¤æ‚åº¦åˆ†æã€‚ä»£ç å®ç°è§„èŒƒï¼ˆå€å¢LCAï¼‰ï¼Œ`dp[i][j`]çš„é€’æ¨ä¸åˆå§‹åŒ–å®Œæ•´ã€‚äº®ç‚¹åœ¨äºé”™è¯¯è°ƒè¯•å¿ƒå¾—åˆ†äº«ï¼ˆ"è¢«2300*ç½šåä¸¤å°æ—¶"ï¼‰ï¼Œæé†’å­¦ä¹ è€…é‡è§†é—®é¢˜è½¬åŒ–æŠ€å·§ã€‚

---

## 3. æ ¸å¿ƒéš¾ç‚¹è¾¨æä¸è§£é¢˜ç­–ç•¥

1.  **éš¾ç‚¹1ï¼šå¦‚ä½•åˆ†è§£å¤æ‚æœŸæœ›ï¼Ÿ**
    * **åˆ†æ**ï¼šåˆ©ç”¨æœŸæœ›çš„çº¿æ€§æ€§è´¨ï¼Œå°†æ•´ä½“æœŸæœ›é€†åºå¯¹æ•°è½¬åŒ–ä¸º$\sum_{i>j}P(i\text{å…ˆäº}j)$ã€‚ä¼˜è´¨é¢˜è§£å‡é€šè¿‡æšä¸¾ç‚¹å¯¹å®ç°ï¼Œç±»ä¼¼"åˆ†æ²»"æ€æƒ³â€”â€”åŒ–æ•´ä¸ºé›¶ã€‚
    * ğŸ’¡ **å­¦ä¹ ç¬”è®°**ï¼šæœŸæœ›çº¿æ€§æ€§æ˜¯å¤„ç†å¤æ‚æœŸæœ›é—®é¢˜çš„åŸºçŸ³

2.  **éš¾ç‚¹2ï¼šå¦‚ä½•å¤„ç†éšæœºèµ·ç‚¹ï¼Ÿ**
    * **åˆ†æ**ï¼šåˆå§‹èŠ‚ç‚¹ç­‰æ¦‚ç‡é€‰æ‹©ï¼Œé€šè¿‡æšä¸¾æ¯ä¸ªæ ¹èŠ‚ç‚¹è®¡ç®—åå–å¹³å‡ï¼ˆå³æœ€ç»ˆä¹˜$1/n$ï¼‰ã€‚å…³é”®å˜é‡`dep`å’Œ`fa`æ•°ç»„éœ€åœ¨æ¯æ¬¡æšä¸¾æ—¶é‡æ–°è®¡ç®—ã€‚
    * ğŸ’¡ **å­¦ä¹ ç¬”è®°**ï¼šæšä¸¾æ³•æ˜¯å¤„ç†éšæœºèµ·ç‚¹çš„å¸¸ç”¨æŠ€å·§

3.  **éš¾ç‚¹3ï¼šå¦‚ä½•è®¡ç®—è·¯å¾„æ¦‚ç‡ï¼Ÿ**
    * **åˆ†æ**ï¼šè®¾ä»LCAåˆ°iã€jçš„å‰©ä½™æ­¥æ•°ä¸º$x$,$y$ã€‚å®šä¹‰$f[x][y]$ä¸ºiå…ˆç»“æŸçš„æ¦‚ç‡ï¼Œè½¬ç§»æ–¹ç¨‹$f[x][y]=\frac{1}{2}(f[x-1][y]+f[x][y-1])$ã€‚æ•°æ®ç»“æ„`vector<int> g[N]`å­˜å‚¨æ ‘è¾¹ï¼Œæ”¯æŒé«˜æ•ˆéå†ã€‚
    * ğŸ’¡ **å­¦ä¹ ç¬”è®°**ï¼šæ ‘å½¢DPå¸¸ç»“åˆLCAå°†è·¯å¾„åˆ†è§£ä¸ºé“¾é—®é¢˜

### âœ¨ è§£é¢˜æŠ€å·§æ€»ç»“
- **æœŸæœ›åˆ†è§£**ï¼šå°†æ•´ä½“æœŸæœ›æ‹†è§£ä¸ºç‹¬ç«‹å­é—®é¢˜æ±‚å’Œ
- **æšä¸¾å¤„ç†**ï¼šæš´åŠ›æšä¸¾åœ¨æœ‰é™æ•°æ®èŒƒå›´ï¼ˆ$n\leq200$ï¼‰å†…å¯è¡Œ
- **DPé¢„å¤„ç†**ï¼šæå‰è®¡ç®—æ¦‚ç‡DPæ•°ç»„ï¼Œé¿å…é‡å¤è®¡ç®—
- **æ ‘é“¾åˆ†æ**ï¼šåˆ©ç”¨LCAå°†è·¯å¾„åˆ†è§£ä¸ºç›´é“¾å¤„ç†

---

## 4. C++æ ¸å¿ƒä»£ç å®ç°èµæ

**æœ¬é¢˜é€šç”¨æ ¸å¿ƒC++å®ç°å‚è€ƒ**
```cpp
#include <cstdio>
#include <vector>
#include <algorithm>
using namespace std;
typedef long long ll;
const int N = 205, mod = 1e9+7;
const ll inv2 = 500000004; // 2çš„é€†å…ƒ

vector<int> g[N];
ll f[N][N], ans;
int n, fa[N][9], dep[N];

void dfs(int u, int father) {
    dep[u] = dep[father] + 1;
    fa[u][0] = father;
    for (int i = 1; i <= 8; ++i)
        fa[u][i] = fa[fa[u][i-1]][i-1];
    for (int v : g[u])
        if (v != father) dfs(v, u);
}

int lca(int x, int y) {
    if (dep[x] < dep[y]) swap(x, y);
    for (int i = 8; i >= 0; --i)
        if (dep[x] - (1<<i) >= dep[y])
            x = fa[x][i];
    if (x == y) return x;
    for (int i = 8; i >= 0; --i)
        if (fa[x][i] != fa[y][i])
            x = fa[x][i], y = fa[y][i];
    return fa[x][0];
}

int main() {
    scanf("%d", &n);
    for (int i = 1; i < n; ++i) {
        int u, v; scanf("%d%d", &u, &v);
        g[u].push_back(v); g[v].push_back(u);
    }

    // é¢„å¤„ç†æ¦‚ç‡DP
    for (int i = 0; i <= n; ++i) f[0][i] = 1;
    for (int i = 1; i <= n; ++i)
        for (int j = 1; j <= n; ++j)
            f[i][j] = (f[i-1][j] + f[i][j-1]) * inv2 % mod;

    for (int rt = 1; rt <= n; ++rt) {
        dfs(rt, 0); // ä»¥rtä¸ºæ ¹å»ºæ ‘
        for (int i = 1; i <= n; ++i)
            for (int j = 1; j < i; ++j) {
                int l = lca(i, j);
                ans = (ans + f[dep[i]-dep[l]][dep[j]-dep[l]]) % mod;
            }
    }
    ans = ans * (mod - mod / n) % mod; // ç­‰ä»·é™¤ä»¥n
    printf("%lld", ans);
    return 0;
}
```

**é¢˜è§£ä¸€æ ¸å¿ƒä»£ç ç‰‡æ®µï¼ˆAcfboyï¼‰**
```cpp
// æ¦‚ç‡DPé¢„å¤„ç†
for (int i = 1; i <= n; i++) f[0][i] = 1;
for (int i = 1; i <= n; i++)
    for (int j = 1; j <= n; j++) 
        f[i][j] = (f[i-1][j] + f[i][j-1]) * inv2 % mod;

// æšä¸¾æ ¹å’Œç‚¹å¯¹
for (int i = 1; i <= n; i++) {
    dfs(i, 0); // å»ºç«‹å€å¢æ•°ç»„
    for (int j = 1; j <= n; j++)
        for (int k = 1; k < j; k++) {
            int l = LCA(j, k);
            ans = (ans + f[dep[j]-dep[l]][dep[k]-dep[l]]) % mod;
        }
}
```
* **äº®ç‚¹**ï¼šæ¸…æ™°çš„DPé¢„å¤„ç†ä¸LCAè°ƒç”¨é€»è¾‘
* **ä»£ç è§£è¯»**ï¼š
  - `f[i][j]`è¡¨ç¤ºä¸¤æ¡é“¾å‰©ä½™é•¿åº¦åˆ†åˆ«ä¸ºi,jæ—¶ï¼Œç¬¬ä¸€æ¡é“¾å…ˆç»“æŸçš„æ¦‚ç‡
  - æšä¸¾æ ¹èŠ‚ç‚¹åï¼Œé€šè¿‡`dfs(i,0)`é‡å»ºæ ‘ç»“æ„
  - LCAè®¡ç®—ä¸¤ç‚¹æœ€è¿‘å…¬å…±ç¥–å…ˆï¼Œ`dep[j]-dep[l]`å³jåˆ°lçš„æ­¥æ•°
* ğŸ’¡ **å­¦ä¹ ç¬”è®°**ï¼šDPçŠ¶æ€å®šä¹‰éœ€å‡†ç¡®åæ˜ é—®é¢˜æœ¬è´¨

**é¢˜è§£äºŒæ ¸å¿ƒä»£ç ç‰‡æ®µï¼ˆdead_Xï¼‰**
```cpp
// LCAè®¡ç®—ï¼ˆæœ´ç´ DFSï¼‰
void dfs(int u, int fath, int d) {
    stak[d] = u; // è®°å½•å½“å‰è·¯å¾„
    if(u > atno) { // atnoæ˜¯å½“å‰ç‚¹å¯¹çš„è¾ƒå°ç‚¹
        for(int i = 1; i <= d; i++) {
            // ç´¯åŠ æ¦‚ç‡è´¡çŒ®
            res += f[dep[u]-dep[stak[i]]][d-i] * size[stak[i]];
        }
    }
    // é€’å½’éå†å­æ ‘
}
```
* **äº®ç‚¹**ï¼šDFSè¿‡ç¨‹ä¸­åŠ¨æ€è®¡ç®—è·¯å¾„æ¦‚ç‡
* **ä»£ç è§£è¯»**ï¼š
  - `stak`æ•°ç»„è®°å½•å½“å‰DFSè·¯å¾„
  - å½“é‡åˆ°å¯èƒ½äº§ç”Ÿé€†åºçš„ç‚¹å¯¹æ—¶ï¼ˆ`u>atno`ï¼‰ï¼Œå®æ—¶è®¡ç®—æ¦‚ç‡
* ğŸ’¡ **å­¦ä¹ ç¬”è®°**ï¼šåœ¨æ ‘éå†è¿‡ç¨‹ä¸­åŠ¨æ€ç»Ÿè®¡å¯ä¼˜åŒ–æ—¶é—´å¤æ‚åº¦

**é¢˜è§£ä¸‰æ ¸å¿ƒä»£ç ç‰‡æ®µï¼ˆCry_For_theMoonï¼‰**
```cpp
// é€†å…ƒå¿«é€Ÿå¹‚
ll power(ll a, ll b, ll p = mod) {
    ll res = 1;
    while (b) {
        if (b & 1) res = res * a % p;
        a = a * a % p; b >>= 1;
    }
    return res;
}
// ä¸»å‡½æ•°ä¸­é€†å…ƒå¤„ç†
ans = ans * power(n, mod-2, mod) % mod;
```
* **äº®ç‚¹**ï¼šè§„èŒƒçš„æ¨¡è¿ç®—å¤„ç†
* **ä»£ç è§£è¯»**ï¼š
  - `power`å‡½æ•°å®ç°å¿«é€Ÿå¹‚æ±‚é€†å…ƒ
  - æœ€ç»ˆç­”æ¡ˆä¹˜ä»¥`n`çš„é€†å…ƒç­‰ä»·äºé™¤ä»¥`n`
* ğŸ’¡ **å­¦ä¹ ç¬”è®°**ï¼šåœ¨æ¨¡è¿ç®—ä¸­ï¼Œé™¤æ³•éœ€è½¬æ¢ä¸ºé€†å…ƒä¹˜æ³•

---

## 5. ç®—æ³•å¯è§†åŒ–ï¼šåƒç´ åŠ¨ç”»æ¼”ç¤º

**åŠ¨ç”»æ¼”ç¤ºä¸»é¢˜**ï¼šåƒç´ æ¢é™©å®¶åœ¨æ ‘å½¢è¿·å®«ä¸­è®¡ç®—è·¯å¾„æ¦‚ç‡

**æ ¸å¿ƒæ¼”ç¤ºå†…å®¹**ï¼š
1. **æ ‘ç»“æ„å¯è§†åŒ–**ï¼š8ä½åƒç´ é£æ ¼æ¸²æŸ“æ ‘èŠ‚ç‚¹ï¼ˆä¸åŒé¢œè‰²åŒºåˆ†å·²æ ‡è®°/æœªæ ‡è®°ï¼‰
   - èŠ‚ç‚¹ç¼–å·æ˜¾ç¤ºåœ¨åƒç´ æ–¹å—ä¸­å¤®
   - å½“å‰è·¯å¾„ç”¨é—ªçƒè¾¹æ¡†é«˜äº®
   
2. **åŠ¨æ€æ ‡è®°è¿‡ç¨‹**ï¼š
   - åˆå§‹éšæœºé€‰æ ¹ï¼ˆæ–¹å—æ”¾å¤§é—ªçƒ+éŸ³æ•ˆï¼‰
   - é€æ­¥æ ‡è®°ç›¸é‚»èŠ‚ç‚¹ï¼ˆ"æ»´"å£°åé¦ˆï¼‰
   - æ ‡è®°æ–°èŠ‚ç‚¹æ—¶ï¼Œæ ‘ç»“æ„åŠ¨æ€æ‰©å±•ï¼ˆåƒç´ åŠ¨ç”»ï¼‰

3. **ç‚¹å¯¹è·¯å¾„åˆ†æ**ï¼š
   ```mermaid
   graph TD
   A[æ ¹èŠ‚ç‚¹] --> B[LCA]
   B --> C[i]
   B --> D[j]
   ```
   - å½“å‰ç‚¹å¯¹(i,j)è·¯å¾„æ˜¾ç¤ºä¸ºé»„è‰²åƒç´ è·¯å¾„
   - LCAèŠ‚ç‚¹æ˜¾ç¤ºä¸ºçº¢è‰²é—ªçƒ

4. **æ¦‚ç‡DPæ¨¡æ‹Ÿ**ï¼š
   - å³ä¾§æ˜¾ç¤ºä¸¤æ¡åƒç´ çŠ¶æ€æ¡ï¼ˆè¡¨ç¤ºåˆ°i/jçš„å‰©ä½™æ­¥æ•°ï¼‰
   - æ¯æ¬¡æ ‡è®°æ—¶ï¼Œéšæœºå‡å°‘æŸæ¡çŠ¶æ€æ¡ï¼ˆä¼´éšæ–¹å‘éŸ³æ•ˆï¼‰
   - DPçŠ¶æ€è¡¨å®æ—¶æ›´æ–°ï¼Œå½“å‰è®¡ç®—å•å…ƒæ ¼é«˜äº®

5. **äº¤äº’æ§åˆ¶**ï¼š
   - æ–¹å‘é”®ï¼šé€‰æ‹©ä¸åŒç‚¹å¯¹
   - Aé”®ï¼šè‡ªåŠ¨æ¼”ç¤ºï¼ˆé€Ÿåº¦å¯è°ƒï¼‰
   - Ré”®ï¼šé‡ç½®å½“å‰æ ¹èŠ‚ç‚¹

**å¤å¤æ¸¸æˆå…ƒç´ **ï¼š
- èƒŒæ™¯éŸ³ä¹ï¼š8-bitå¾ªç¯èŠ¯ç‰‡éŸ³ä¹
- éŸ³æ•ˆè®¾è®¡ï¼š
  - æ ‡è®°èŠ‚ç‚¹ï¼šçŸ­ä¿ƒ"æ»´"å£°
  - è·¯å¾„åŒ¹é…ï¼šä¸Šå‡éŸ³é˜¶
  - è®¡ç®—å®Œæˆï¼šç»å…¸FCèƒœåˆ©æ—‹å¾‹
- ç§¯åˆ†ç³»ç»Ÿï¼šæ¯æ­£ç¡®è®¡ç®—ä¸€ä¸ªç‚¹å¯¹å¾—10åˆ†ï¼Œè¿ç»­æ­£ç¡®æœ‰è¿å‡»å¥–åŠ±

---

## 6. æ‹“å±•ç»ƒä¹ ä¸ç›¸ä¼¼é—®é¢˜æ€è€ƒ

**é€šç”¨æŠ€å·§è¿ç§»**ï¼š
1. **æœŸæœ›çº¿æ€§åˆ†è§£**ï¼šé€‚ç”¨äºä»»ä½•å¯ç‹¬ç«‹è®¡ç®—è´¡çŒ®çš„æœŸæœ›é—®é¢˜
2. **æ ‘è·¯å¾„åˆ†è§£**ï¼šåœ¨LCAç›¸å…³é—®é¢˜ä¸­å¹¿æ³›ä½¿ç”¨
3. **æ¦‚ç‡DPé¢„å¤„ç†**ï¼šè§£å†³å¤šç»„æ¦‚ç‡æŸ¥è¯¢é—®é¢˜çš„é€šç”¨ä¼˜åŒ–

**æ´›è°·é¢˜ç›®æ¨è**ï¼š
1. [P4438 é“è·¯](https://www.luogu.com.cn/problem/P4438)
   - æ¨èç†ç”±ï¼šåŒé“¾æ¦‚ç‡DPçš„ç»å…¸åº”ç”¨ï¼Œå¼ºåŒ–è·¯å¾„åˆ†è§£æ€ç»´
   
2. [P3211 XORå’Œè·¯å¾„](https://www.luogu.com.cn/problem/P3211)
   - æ¨èç†ç”±ï¼šæœŸæœ›çº¿æ€§æ€§è´¨çš„é«˜çº§åº”ç”¨ï¼Œç»“åˆä½è¿ç®—

3. [P1654 OSU!](https://www.luogu.com.cn/problem/P1654)
   - æ¨èç†ç”±ï¼šæœŸæœ›çº¿æ€§åˆ†è§£çš„å…¥é—¨è®­ç»ƒï¼Œä»åºåˆ—åˆ°æ ‘çš„æ€ç»´è¿‡æ¸¡

---

æœ¬æ¬¡å…³äº"Tree Array"çš„è§£æå°±åˆ°è¿™é‡Œã€‚è®°ä½ï¼šæ ‘å½¢é—®é¢˜åŒ–è·¯å¾„ï¼ŒæœŸæœ›æ±‚å’Œæ‹†ç‚¹å¯¹ã€‚å¤šç»ƒä¹ æšä¸¾ä¸DPæŠ€å·§ï¼Œä½ å°†åœ¨ç®—æ³•ç«èµ›ä¸­æ¸¸åˆƒæœ‰ä½™ï¼ğŸ’ª

---
å¤„ç†ç”¨æ—¶ï¼š170.02ç§’
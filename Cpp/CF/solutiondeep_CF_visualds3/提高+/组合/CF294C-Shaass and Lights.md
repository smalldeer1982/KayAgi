# é¢˜ç›®ä¿¡æ¯

# Shaass and Lights

## é¢˜ç›®æè¿°

There are $ n $ lights aligned in a row. These lights are numbered $ 1 $ to $ n $ from left to right. Initially some of the lights are switched on. Shaass wants to switch all the lights on. At each step he can switch a light on (this light should be switched off at that moment) if there's at least one adjacent light which is already switched on.

He knows the initial state of lights and he's wondering how many different ways there exist to switch all the lights on. Please find the required number of ways modulo $ 1000000007Â (10^{9}+7) $ .

## æ ·ä¾‹ #1

### è¾“å…¥

```
3 1
1
```

### è¾“å‡º

```
1
```

## æ ·ä¾‹ #2

### è¾“å…¥

```
4 2
1 4
```

### è¾“å‡º

```
2
```

## æ ·ä¾‹ #3

### è¾“å…¥

```
11 2
4 8
```

### è¾“å‡º

```
6720
```

# AIåˆ†æç»“æœ


### é¢˜ç›®è§£è¯»ä¸æ ¸å¿ƒç®—æ³•è¯†åˆ«
âœ¨ **æœ¬é¢˜ä¸»è¦è€ƒå¯Ÿ**ï¼šç»„åˆæ•°å­¦ï¼ˆè®¡æ•°é—®é¢˜ï¼‰

ğŸ—£ï¸ **åˆæ­¥åˆ†æ**ï¼š
> è§£å†³ "Shaass and Lights" çš„å…³é”®åœ¨äºè¿ç”¨ç»„åˆæ•°å­¦æŠ€å·§ã€‚æƒ³è±¡ä¸€æ’ç¯è¢«åˆå§‹ç‚¹äº®çš„ç¯åˆ†å‰²æˆå¤šä¸ªç‹¬ç«‹åŒºé—´ï¼Œå¦‚åŒè¢«ç‚¹äº®ç¯å¡”åˆ†éš”çš„é»‘æš—éš§é“ã€‚æ¯ä¸ªåŒºé—´å†…çš„ç‚¹äº®æ“ä½œæœ‰ç‰¹å®šè§„åˆ™ï¼š
> - **ä¸­é—´åŒºé—´**ï¼ˆä¸¤ä¾§æœ‰äº®ç¯ï¼‰ï¼šæ¯æ¬¡å¯ä»å·¦/å³ç«¯ç‚¹é€‰æ‹©ç‚¹äº®ï¼Œæ–¹æ¡ˆæ•°ä¸º $2^{len-1}$ï¼ˆ$len$ ä¸ºåŒºé—´é•¿åº¦ï¼‰
> - **è¾¹ç•ŒåŒºé—´**ï¼ˆå•ä¾§æœ‰äº®ç¯ï¼‰ï¼šåªèƒ½ä»äº®ç¯ä¾§å•å‘ç‚¹äº®ï¼Œæ–¹æ¡ˆæ•°ä¸º $1$
> 
> æ€»æ–¹æ¡ˆæ•° = $\frac{(n-m)!}{\prod (len_i!)}$ï¼ˆå¤šé‡é›†æ’åˆ—ï¼‰ Ã— $\prod_{ä¸­é—´åŒºé—´} 2^{len_j-1}$ï¼ˆåŒºé—´ç‹¬ç«‹æ–¹æ¡ˆï¼‰
> 
> **å¯è§†åŒ–è®¾è®¡**ï¼šé‡‡ç”¨8ä½åƒç´ é£æ ¼ï¼Œç¯ç”¨é»„/ç°æ–¹å—è¡¨ç¤ºã€‚åŠ¨ç”»é«˜äº®å½“å‰å¯æ“ä½œç¯ï¼ˆç»¿æ¡†ï¼‰ï¼Œç‚¹ç¯æ—¶æ’­æ”¾"å®"å£°å¹¶æ˜¾ç¤ºæ–¹æ¡ˆæ•°è®¡ç®—å…¬å¼ã€‚æ§åˆ¶é¢æ¿æ”¯æŒå•æ­¥/è‡ªåŠ¨æ¨¡å¼ï¼ˆè°ƒé€Ÿæ»‘å—ï¼‰ï¼Œç»“æŸæ’­æ”¾èƒœåˆ©éŸ³æ•ˆã€‚

---

### ç²¾é€‰ä¼˜è´¨é¢˜è§£å‚è€ƒ
**é¢˜è§£ä¸€ï¼ˆRedreamMerï¼‰**  
* **ç‚¹è¯„**ï¼šæ€è·¯æ¸…æ™°æ‹†è§£åŒºé—´ï¼Œæ¨å¯¼å‡ºç»„åˆæ•°æ ¸å¿ƒå…¬å¼ã€‚ä»£ç è§„èŒƒï¼ˆé¢„å¤„ç†é˜¶ä¹˜/é€†å…ƒï¼‰ï¼Œå·§å¦™å¤„ç†è¾¹ç•Œï¼ˆ$len=0$ è·³è¿‡ï¼‰ã€‚å¤æ‚åº¦ $O(n \log n)$ï¼Œç«èµ›å®ç”¨æ€§å¼ºã€‚äº®ç‚¹ï¼šå®Œæ•´çŠ¶æ€è½¬ç§»æ¨å¯¼å’Œè¾¹ç•Œå¤„ç†ã€‚

**é¢˜è§£äºŒï¼ˆStillEmptyï¼‰**  
* **ç‚¹è¯„**ï¼šåˆ›æ–°æ€§å°†æ“ä½œåºåˆ—æŠ½è±¡ä¸ºå¤šé‡é›†æ’åˆ—ï¼Œå…¬å¼æ¨å¯¼ç›´è§‚ã€‚é¢„å¤„ç†é˜¶ä¹˜é€†å…ƒä¼˜åŒ–è®¡ç®—ï¼ˆ$O(1)$ ç»„åˆæ•°ï¼‰ï¼Œå˜é‡å‘½åæ˜ç¡®ï¼ˆ`frat`/`pow2`ï¼‰ã€‚å®è·µä»·å€¼é«˜ï¼Œå°¤å…¶é€‚åˆæ•°å­¦åŸºç¡€æ‰å®çš„å­¦ä¹ è€…ã€‚

**é¢˜è§£ä¸‰ï¼ˆRockyYueï¼‰**  
* **ç‚¹è¯„**ï¼šä¸‰ç±»åŒºé—´åˆ†ç±»è®¨è®ºç®€æ´ï¼ˆä¸­é—´/å·¦ç«¯/å³ç«¯ï¼‰ï¼Œé€’æ¨æ³•é¢„å¤„ç†ç»„åˆæ•°è¡¨é™ä½å¸¸æ•°ã€‚ä»£ç ç»“æ„å·¥æ•´ï¼ˆæ¨¡å—åŒ–åˆå§‹åŒ–ï¼‰ï¼Œä½†éœ€æ³¨æ„å³ç«¯åŒºé—´å¤„ç†ï¼ˆåŸæ–‡æœªæ˜¾å¼å¤„ç†ï¼Œéœ€è¡¥å…… $res \times C[k][n-a_m]$ï¼‰ã€‚

---

### æ ¸å¿ƒéš¾ç‚¹è¾¨æä¸è§£é¢˜ç­–ç•¥
1. **åŒºé—´åˆ’åˆ†ä¸ç‚¹äº®è§„åˆ™**  
   * **åˆ†æ**ï¼šåˆå§‹äº®ç¯å°†åºåˆ—åˆ†å‰²ä¸ºç‹¬ç«‹åŒºé—´ï¼Œä¸­é—´åŒºé—´ï¼ˆä¸¤ä¾§äº®ç¯ï¼‰æœ‰åŒå‘é€‰æ‹©ï¼Œè¾¹ç•ŒåŒºé—´ï¼ˆå•ä¾§äº®ç¯ï¼‰ä»…å•å‘ç‚¹äº®ã€‚ä¼˜è´¨é¢˜è§£é€šè¿‡æ’åºåè®¡ç®— $a_i-a_{i-1}-1$ ç¡®å®šåŒºé—´é•¿åº¦ã€‚
   * ğŸ’¡ **å­¦ä¹ ç¬”è®°**ï¼šå‡†ç¡®è¯†åˆ«åŒºé—´ç±»å‹æ˜¯æ–¹æ¡ˆæ•°è®¡ç®—çš„åŸºç¡€ã€‚

2. **å¤šé‡é›†æ’åˆ—ä¸ç»„åˆä¼˜åŒ–**  
   * **åˆ†æ**ï¼šæ€»æ“ä½œåºåˆ—éœ€åˆå¹¶å„åŒºé—´æ“ä½œï¼Œä½¿ç”¨ $\frac{(n-m)!}{\prod len_i!}$ è®¡ç®—å¤šé‡é›†æ’åˆ—ã€‚ç»„åˆæ•°ä¼˜åŒ–é€šè¿‡é¢„å¤„ç†é˜¶ä¹˜é€†å…ƒå®ç°ï¼ˆè´¹é©¬å°å®šç†æ±‚é€†å…ƒï¼‰ã€‚
   * ğŸ’¡ **å­¦ä¹ ç¬”è®°**ï¼šé˜¶ä¹˜é€†å…ƒé¢„å¤„ç†å¯ $O(1)$ è®¡ç®—ç»„åˆæ•°ï¼Œå¤§å¹…æå‡æ•ˆç‡ã€‚

3. **å¹‚æ¬¡å› å­ä¸è¾¹ç•Œå¤„ç†**  
   * **åˆ†æ**ï¼šä¸­é—´åŒºé—´å¼•å…¥ $2^{len-1}$ å› å­ï¼ˆç«¯ç‚¹é€‰æ‹©è‡ªç”±ï¼‰ï¼Œè¾¹ç•ŒåŒºé—´å› å­ä¸º $1$ã€‚éœ€ç‰¹åˆ¤ $len=0$ï¼ˆç›¸é‚»äº®ç¯æ— æ“ä½œï¼‰é¿å…æ— æ•ˆè®¡ç®—ã€‚
   * ğŸ’¡ **å­¦ä¹ ç¬”è®°**ï¼šè¾¹ç•Œæ¡ä»¶ç›´æ¥å½±å“ç»“æœæ­£ç¡®æ€§ï¼Œå¿…é¡»ä¸¥è°¨éªŒè¯ã€‚

### âœ¨ è§£é¢˜æŠ€å·§æ€»ç»“
- **åŒºé—´åˆ†è§£æ³•**ï¼šå°†å¤æ‚åºåˆ—æ‹†è§£ä¸ºç‹¬ç«‹å­åŒºé—´ï¼Œé™ä½é—®é¢˜ç»´åº¦
- **ç»„åˆæ•°å­¦ä¼˜åŒ–**ï¼šé¢„å¤„ç†é˜¶ä¹˜/é€†å…ƒåŠ é€Ÿç»„åˆæ•°è®¡ç®—ï¼Œç©ºé—´æ¢æ—¶é—´
- **è¾¹ç•Œé²æ£’æ€§**ï¼šä½¿ç”¨ $len>0$ æ£€æŸ¥è¿‡æ»¤æ— æ•ˆåŒºé—´ï¼Œé¿å…ä¹˜1å‰¯ä½œç”¨

---

### C++æ ¸å¿ƒä»£ç å®ç°èµæ
**æœ¬é¢˜é€šç”¨æ ¸å¿ƒå®ç°**  
```cpp
#include <bits/stdc++.h>
#define ll long long
using namespace std;
const ll MOD = 1e9+7, MAXN = 1005;

ll fac[MAXN], inv[MAXN], pow2[MAXN];

ll qpow(ll base, ll exp) { // å¿«é€Ÿå¹‚
    ll res = 1;
    while (exp) {
        if (exp & 1) res = res * base % MOD;
        base = base * base % MOD;
        exp >>= 1;
    }
    return res;
}

void init() { // é¢„å¤„ç†é˜¶ä¹˜/é€†å…ƒ/å¹‚æ¬¡
    fac[0] = pow2[0] = 1;
    for (int i = 1; i < MAXN; i++) {
        fac[i] = fac[i-1] * i % MOD;
        pow2[i] = pow2[i-1] * 2 % MOD;
    }
    inv[MAXN-1] = qpow(fac[MAXN-1], MOD-2);
    for (int i = MAXN-2; i >= 0; i--) 
        inv[i] = inv[i+1] * (i+1) % MOD;
}

int main() {
    init();
    int n, m; 
    vector<int> lit;
    cin >> n >> m;
    for (int i = 0; i < m; i++) {
        int x; cin >> x; 
        lit.push_back(x);
    }
    sort(lit.begin(), lit.end());
    
    ll ans = fac[n - m]; // æ€»æ“ä½œåºåˆ—æ’åˆ— (n-m)!
    int total_len = n - m;

    // å·¦ç«¯åŒºé—´ï¼ˆç¯1å·¦ä¾§ï¼‰
    if (lit[0] > 1) {
        int len = lit[0] - 1;
        ans = ans * inv[len] % MOD; // é™¤ä»¥len!
    }

    // ä¸­é—´åŒºé—´ï¼ˆç¯iä¸ç¯i-1ä¹‹é—´ï¼‰
    for (int i = 1; i < m; i++) {
        int len = lit[i] - lit[i-1] - 1;
        if (len <= 0) continue;
        ans = ans * inv[len] % MOD; // é™¤ä»¥len!
        ans = ans * pow2[len - 1] % MOD; // ä¹˜ä»¥2^{len-1}
    }

    // å³ç«¯åŒºé—´ï¼ˆæœ«ç¯å³ä¾§ï¼‰
    if (lit.back() < n) {
        int len = n - lit.back();
        ans = ans * inv[len] % MOD; // é™¤ä»¥len!
    }
    cout << ans;
}
```
**ä»£ç è§£è¯»æ¦‚è¦**ï¼š  
1. é¢„å¤„ç†ä¼˜åŒ–ï¼šé˜¶ä¹˜/é€†å…ƒ/å¹‚æ¬¡æ•°ç»„é¢„è®¡ç®—  
2. ä¸»é€»è¾‘ï¼šæ’åºååˆ†ä¸‰ç±»åŒºé—´å¤„ç†  
3. å·¦/å³ç«¯åŒºé—´ï¼šä»…éœ€å¤šé‡é›†æ’åˆ—å› å­ ($\div len!$)  
4. ä¸­é—´åŒºé—´ï¼šé¢å¤–å¢åŠ  $2^{len-1}$ é€‰æ‹©å› å­  

---

### ç®—æ³•å¯è§†åŒ–ï¼šåƒç´ åŠ¨ç”»æ¼”ç¤º
**ä¸»é¢˜**ï¼š  
`åƒç´ ç¯é˜µï¼šç»„åˆç‚¹äº®å¤§å†’é™©`ï¼ˆå¤å¤8-bité£æ ¼ï¼‰

**æ ¸å¿ƒè®¾è®¡**ï¼š  
```mermaid
graph LR
    A[åˆå§‹åŒ–] --> B[ç»˜åˆ¶ç¯åºåˆ—]
    B --> C[é«˜äº®å¯æ“ä½œç¯]
    C --> D{ç”¨æˆ·æ“ä½œ}
    D -->|ç‚¹å‡»/è‡ªåŠ¨| E[ç‚¹äº®åŠ¨ç”»+éŸ³æ•ˆ]
    E --> F[æ›´æ–°æ–¹æ¡ˆæ•°å…¬å¼]
    F --> G{å…¨éƒ¨ç‚¹äº®ï¼Ÿ}
    G -->|å¦| C
    G -->|æ˜¯| H[èƒœåˆ©åŠ¨ç”»]
```

**å…³é”®å®ç°**ï¼š  
1. **è§†è§‰å…ƒç´ **  
   - ç¯ï¼š16Ã—16åƒç´ æ–¹å—ï¼ˆç°ï¼šæœªç‚¹äº®ï¼Œé»„ï¼šå·²ç‚¹äº®ï¼Œç»¿æ¡†ï¼šå¯æ“ä½œï¼‰  
   - æ§åˆ¶é¢æ¿ï¼šå¤å¤çº¢ç™½æœºæŒ‰é’®ï¼ˆå¼€å§‹/æš‚åœ/å•æ­¥/é‡ç½®ï¼‰  
   - å®æ—¶å…¬å¼ï¼š$\frac{(n-m)!}{\prod len_i!} \times \prod 2^{len_j-1}$ éšæ“ä½œåŠ¨æ€æ›´æ–°  

2. **åŠ¨ç”»æµç¨‹**  
   - **æ­¥éª¤1**ï¼šç»˜åˆ¶åˆå§‹ç¯é˜µï¼ˆé»„ç¯å®šä½åˆ†å‰²çº¿ï¼‰  
   - **æ­¥éª¤2**ï¼šè¾¹ç•ŒåŒºé—´å•å‘ç‚¹äº®ï¼ˆç®­å¤´åŠ¨ç”»+å•è°ƒéŸ³æ•ˆï¼‰  
   - **æ­¥éª¤3**ï¼šä¸­é—´åŒºé—´åŒå‘é€‰æ‹©ï¼ˆå·¦/å³ç®­å¤´é—ªçƒï¼Œé€‰æ‹©åæ’­æ”¾ä¸åŒéŸ³æ•ˆï¼‰  
   - **æ­¥éª¤4**ï¼šæ¯åŒºé—´å®Œæˆæ—¶æ˜¾ç¤º $\checkmark$ å¹¶æ›´æ–°åˆ†æ¯ $len_i!$  

3. **æ¸¸æˆåŒ–å¢å¼º**  
   - æ¯åŒºé—´ä½œä¸ºç‹¬ç«‹å…³å¡ï¼Œå®Œæˆè§£é”ä¸‹ä¸€åŒº  
   - è‡ªåŠ¨æ¨¡å¼ï¼šAIæ¨¡æ‹Ÿ"è´ªåƒè›‡"å¼ç‚¹äº®è·¯å¾„ï¼ˆé€Ÿåº¦å¯è°ƒï¼‰  
   - éŸ³æ•ˆä½“ç³»ï¼š  
     - ç‚¹äº®ï¼š"å®"ï¼ˆ400Hzæ–¹æ³¢ï¼‰  
     - é”™è¯¯ï¼š"å˜Ÿ"ï¼ˆ100msçŸ­ä¿ƒéŸ³ï¼‰  
     - èƒœåˆ©ï¼šã€Šè¶…çº§ç›ä¸½ã€‹è¿‡å…³æ—‹å¾‹  

---

### æ‹“å±•ç»ƒä¹ ä¸ç›¸ä¼¼é—®é¢˜
1. **æŠ€å·§è¿ç§»åœºæ™¯**ï¼š  
   - å¤šé‡é›†æ’åˆ—ï¼šå¸¦é™åˆ¶æ¡ä»¶çš„æ“ä½œåºåˆ—è®¡æ•°ï¼ˆP3197 è¶Šç‹±ï¼‰  
   - åŒºé—´åˆ’åˆ†ï¼šå¸¦æƒå€¼çš„æœ€å°åŒºé—´åˆ’åˆ†ï¼ˆP1880 çŸ³å­åˆå¹¶ï¼‰  
   - ç»„åˆä¼˜åŒ–ï¼šé«˜ç²¾åº¦ç»„åˆæ•°å–æ¨¡ï¼ˆP3807 å¢å¡æ–¯å®šç†ï¼‰  

2. **æ´›è°·æ¨è**ï¼š  
   - **P3197** [HNOI2008]è¶Šç‹±  
     > æ¨èç†ç”±ï¼šå·©å›ºç»„åˆè®¡æ•°æŠ€å·§ï¼Œç†è§£ä¹˜æ³•åŸç†ä¸å®¹æ–¥çš„è½¬æ¢  
   - **P1066** 2^kè¿›åˆ¶æ•°  
     > æ¨èç†ç”±ï¼šå¼ºåŒ–ç»„åˆæ•°å­¦æ€ç»´ï¼Œå¤„ç†é«˜ç²¾åº¦ä¸è¾¹ç•Œæ¡ä»¶  
   - **P1494** å°Zçš„è¢œå­  
     > æ¨èç†ç”±ï¼šè«é˜Ÿç®—æ³•ä¸­ç»„åˆæ•°åº”ç”¨ï¼Œè¿ç§»åŒºé—´åˆ’åˆ†æ€æƒ³  

---

### å­¦ä¹ å¿ƒå¾—ä¸ç»éªŒåˆ†äº«
> **ç»éªŒæ‘˜å½•ï¼ˆRedreamMerï¼‰**ï¼š  
> "ç‰¹åˆ«æ³¨æ„ç›¸é‚»äº®ç¯é—´ $len=0$ çš„æƒ…å†µï¼Œé¿å…æ— æ•ˆè®¡ç®—æ±¡æŸ“ç»“æœã€‚é€šè¿‡æ‰“å° $len$ å€¼éªŒè¯è¾¹ç•Œæ˜¯æœ‰æ•ˆçš„è°ƒè¯•æ‰‹æ®µã€‚"  
>   
> **Kayç‚¹è¯„**ï¼š  
> è°ƒè¯•æ—¶éªŒè¯è¾¹ç•Œå€¼ï¼ˆå¦‚ $len\leq0$ï¼‰èƒ½é¿å…90%çš„è®¡æ•°é”™è¯¯ã€‚å»ºè®®å­¦ä¹ è€…åœ¨ç±»ä¼¼é—®é¢˜ä¸­ï¼š  
> 1. å…ˆå†™ä¼ªä»£ç æ˜ç¡®æ•°å­¦å…¬å¼  
> 2. ç”¨å°æ ·ä¾‹ï¼ˆå¦‚ n=3,m=1ï¼‰äººè„‘æ¨¡æ‹Ÿ  
> 3. æ·»åŠ  `cout<<len<<endl;` è·Ÿè¸ªè¾¹ç•Œå€¼  

---

> æœ¬æ¬¡åˆ†æç»“æŸï¼Œè¯·ç»§ç»­æŒ‘æˆ˜æ›´å¤šç»„åˆæ•°å­¦é—®é¢˜ï¼ğŸš€  
> è®°ä½ï¼šä¼˜é›…çš„ä»£ç  = ä¸¥è°¨çš„æ•°å­¦ + ç»†è‡´çš„è¾¹ç•Œå¤„ç† â€”â€”Kay

---
å¤„ç†ç”¨æ—¶ï¼š310.53ç§’
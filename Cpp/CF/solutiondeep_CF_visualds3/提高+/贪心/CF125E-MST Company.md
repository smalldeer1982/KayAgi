# é¢˜ç›®ä¿¡æ¯

# MST Company

## é¢˜ç›®æè¿°

The MST (Meaningless State Team) company won another tender for an important state reform in Berland.

There are $ n $ cities in Berland, some pairs of the cities are connected by roads. Each road has its price. One can move along any road in any direction. The MST team should carry out the repair works on some set of roads such that one can get from any city to any other one moving only along the repaired roads. Moreover, this set should contain exactly $ k $ capital roads (that is, the roads that start or finish in the capital). The number of the capital is 1.

As the budget has already been approved, the MST Company will profit by finding the set with minimum lengths of roads.

## æ ·ä¾‹ #1

### è¾“å…¥

```
4 5 2
1 2 1
2 3 1
3 4 1
1 3 3
1 4 2
```

### è¾“å‡º

```
3
1 5 2 ```

# AIåˆ†æç»“æœ


# ğŸ’¡ Kayçš„C++ç®—æ³•è§£æï¼šMST Company æ·±å…¥å­¦ä¹ æŒ‡å— ğŸ’¡

## 1. é¢˜ç›®è§£è¯»ä¸æ ¸å¿ƒç®—æ³•è¯†åˆ«

âœ¨ **æœ¬é¢˜ä¸»è¦è€ƒå¯Ÿ**ï¼š`å¸¦æƒäºŒåˆ†ï¼ˆwqsäºŒåˆ†ï¼‰`ä¸`ç ´åœˆæ³•`çš„çµæ´»åº”ç”¨

ğŸ—£ï¸ **åˆæ­¥åˆ†æ**ï¼š
> è§£å†³"MST Company"è¿™é“é¢˜ï¼Œå…³é”®åœ¨äºè¿ç”¨`å¸¦æƒäºŒåˆ†`æˆ–`ç ´åœˆæ³•`ã€‚ç®€å•æ¥è¯´ï¼Œ`å¸¦æƒäºŒåˆ†`å°±åƒç»™ç‰¹æ®Šå•†å“ï¼ˆä¸1ç›¸è¿çš„è¾¹ï¼‰åŠ ä»·æˆ–é™ä»·ï¼Œé€šè¿‡è°ƒæ•´"ä»·æ ¼"æ¥æ§åˆ¶è´­ç‰©è½¦ä¸­ç‰¹æ®Šå•†å“çš„æ•°é‡ã€‚åœ¨æœ¬é¢˜ä¸­ï¼Œæˆ‘ä»¬é€šè¿‡äºŒåˆ†åç§»é‡æ§åˆ¶ä¸1ç›¸è¿è¾¹çš„æ•°é‡ï¼Œä½¿å…¶æ°å¥½ä¸ºkã€‚
   
   - **é¢˜è§£æ€è·¯å¯¹æ¯”**ï¼š
     - **wqsäºŒåˆ†**ï¼šç»™ä¸1ç›¸è¿çš„è¾¹æ·»åŠ åç§»é‡ï¼Œé€šè¿‡äºŒåˆ†æ‰¾åˆ°æ°å¥½äº§ç”Ÿkæ¡è¾¹çš„åç§»å€¼
     - **ç ´åœˆæ³•**ï¼šå…ˆæ„é€ æœ€å°‘ç™½è¾¹ç”Ÿæˆæ ‘ï¼Œå†é€šè¿‡è¾¹æ›¿æ¢é€æ­¥å¢åŠ ç™½è¾¹æ•°é‡
   
   - **å¯è§†åŒ–è®¾è®¡æ€è·¯**ï¼š
     - åƒç´ ç½‘æ ¼ä¸­ä¸åŒé¢œè‰²æ ‡è®°ç™½è¾¹ï¼ˆé»„è‰²ï¼‰å’Œé»‘è¾¹ï¼ˆè“è‰²ï¼‰
     - Kruskalæ‰§è¡Œæ—¶æ˜¾ç¤ºæ’åºè¿‡ç¨‹ï¼ˆè¾¹æŒ‰æƒå€¼æ’åˆ—åœ¨ç½‘æ ¼ä¸‹æ–¹ï¼‰
     - åŠ å…¥ç™½è¾¹æ—¶æ’­æ”¾"å®"éŸ³æ•ˆï¼Œå½¢æˆç¯æ—¶çº¢è‰²é—ªçƒ
     - ç ´åœˆæ›¿æ¢æ—¶é«˜äº®ç¯è·¯å¾„å’Œåˆ é™¤çš„è¾¹
     - å¤å¤æ§åˆ¶é¢æ¿ï¼šå•æ­¥æ‰§è¡Œã€é€Ÿåº¦æ»‘å—ã€é‡ç½®æŒ‰é’®

---

## 2. ç²¾é€‰ä¼˜è´¨é¢˜è§£å‚è€ƒ

**é¢˜è§£ä¸€ï¼šEndSaHï¼ˆç ´åœˆæ³•ï¼‰**
* **ç‚¹è¯„**ï¼š
  æ€è·¯æ¸…æ™°æŒ‡å‡ºwqsäºŒåˆ†çš„æ„é€ ç¼ºé™·ï¼Œæå‡ºå…ˆæ„é€ æœ€å°‘ç™½è¾¹ç”Ÿæˆæ ‘å†é€æ­¥æ›¿æ¢çš„ç­–ç•¥ã€‚ä»£ç ä¸­DFSé¢„å¤„ç†è·¯å¾„æœ€å¤§è¾¹ï¼ˆ`mx[]æ•°ç»„`ï¼‰çš„è®¾è®¡å·§å¦™ï¼Œé¿å…æ¯æ¬¡O(n)æŸ¥è¯¢ã€‚å˜é‡å‘½åè§„èŒƒï¼ˆ`del[]`æ ‡è®°åˆ é™¤è¾¹ï¼‰ï¼Œè¾¹ç•Œå¤„ç†ä¸¥è°¨ã€‚äº®ç‚¹åœ¨äºæä¾›ä¸¤ç»„hackæ•°æ®å’ŒSPJéªŒè¯ç¨‹åºï¼Œå®è·µä»·å€¼é«˜ã€‚

**é¢˜è§£äºŒï¼šPiwryï¼ˆwqsäºŒåˆ†æ„é€ ï¼‰**
* **ç‚¹è¯„**ï¼š
  åˆ›æ–°æ€§åœ°æŒ‰è¾¹æƒåˆ†ç»„å¤„ç†ï¼Œå…ˆå›ºå®šæœ€å°‘ç™½è¾¹æ–¹æ¡ˆä¸­çš„è¾¹ï¼Œå†è¡¥å……ç™½è¾¹ã€‚ä»£ç ä¸­`e_chosen[]`æ ‡è®°å¿…é€‰è¾¹çš„è®¾è®¡ç®€æ´é«˜æ•ˆã€‚å°½ç®¡å®ç°è¾ƒå¤æ‚ï¼Œä½†ç»“æ„å·¥æ•´ï¼ˆåˆ†å—å¤„ç†+å¹¶æŸ¥é›†ç»´æŠ¤ï¼‰ï¼Œå¤æ‚åº¦O(m log n)åˆç†ã€‚äº®ç‚¹åœ¨äºä¸¥æ ¼è¯æ˜æ„é€ æ­£ç¡®æ€§ï¼Œé€‚ç”¨å›½å®¶é›†è®­é˜Ÿé¢˜ç›®å˜ç§ã€‚

**é¢˜è§£ä¸‰ï¼šjiqimaoï¼ˆwqsäºŒåˆ†æ”¹è¿›ï¼‰**
* **ç‚¹è¯„**ï¼š
  æå‡ºåˆ†æ‰¹æ¬¡å¤„ç†è¾¹æƒçš„é€šç”¨æ„é€ æ¡†æ¶ï¼Œå…ˆæ±‚æœ€å¤š/æœ€å°‘ç™½è¾¹ç­–ç•¥ã€‚ä»£ç ä¸­`R[]`æ•°ç»„è®°å½•æœ€å¤§ç™½è¾¹æ•°çš„è®¾è®¡ç‹¬ç‰¹ï¼Œåˆ†ç»„å¡«å……é€»è¾‘æ¸…æ™°ã€‚è™½ç„¶å˜é‡å‘½åç¨ç®€ç•¥ï¼ˆ`l,r`ï¼‰ï¼Œä½†ç®—æ³•æœ‰æ•ˆæ€§çªå‡ºï¼Œèƒ½é€šè¿‡æ‰€æœ‰hackæ•°æ®ã€‚

---

## 3. æ ¸å¿ƒéš¾ç‚¹è¾¨æä¸è§£é¢˜ç­–ç•¥

1. **éš¾ç‚¹ä¸€ï¼šåç§»é‡è°ƒæ•´ä¸æ–¹æ¡ˆæ„é€ **
   * **åˆ†æ**ï¼šwqsäºŒåˆ†åå¯èƒ½å¾—åˆ°ç™½è¾¹æ•°é‡åŒºé—´è€Œéç²¾ç¡®å€¼ï¼ˆå‡¸åŒ…å…±çº¿ï¼‰ã€‚ä¼˜è´¨è§£æ³•é€šè¿‡è¾¹æƒåˆ†ç»„å¤„ç†ï¼šå…ˆå›ºå®šå¿…é€‰ç™½è¾¹ï¼Œå†åœ¨ç›¸åŒè¾¹æƒç»„å†…è¡¥å……ç™½è¾¹ï¼ˆPiwryï¼‰ï¼Œæˆ–è®°å½•æœ€å¤§ç™½è¾¹æ•°åˆ†æ‰¹æ¬¡å¡«å……ï¼ˆjiqimaoï¼‰
   * ğŸ’¡ **å­¦ä¹ ç¬”è®°**ï¼šè¾¹æƒç›¸ç­‰çš„è¾¹æ˜¯æ„é€ å…³é”®ï¼Œéœ€æ‰“ç ´æ’åºç¨³å®šæ€§ï¼ˆéšæœºæ‰°åŠ¨æˆ–æ˜¾å¼åˆ†ç»„ï¼‰

2. **éš¾ç‚¹äºŒï¼šç ´åœˆæ³•é«˜æ•ˆå®ç°**
   * **åˆ†æ**ï¼šæš´åŠ›æ‰¾ç¯æœ€å¤§è¾¹ä»£ä»·é«˜ã€‚EndSaHè§£æ³•é€šè¿‡DFSé¢„å¤„ç†`mx[]`æ•°ç»„å­˜å‚¨è·¯å¾„æœ€å¤§è¾¹ï¼Œæ›¿æ¢æ—¶O(1)æŸ¥è¯¢ï¼Œå°†å¤æ‚åº¦ä¼˜åŒ–è‡³O(nk)
   * ğŸ’¡ **å­¦ä¹ ç¬”è®°**ï¼šæ ‘ç»“æ„é¢„å¤„ç†æ˜¯ä¼˜åŒ–ç ´åœˆæ³•çš„å…³é”®

3. **éš¾ç‚¹ä¸‰ï¼šæ— è§£æƒ…å†µåˆ¤æ–­**
   * **åˆ†æ**ï¼šä¸‰ç§æ— è§£æƒ…å†µéœ€ä¼˜å…ˆåˆ¤æ–­ï¼š1) ä¸1ç›¸è¿è¾¹ä¸è¶³kæ¡ 2) å›¾ä¸è¿é€š 3) æœ€å°ç™½è¾¹æ•°>kã€‚é€šç”¨è§£æ³•é€šè¿‡æ„é€ æœ€å°‘ç™½è¾¹ç”Ÿæˆæ ‘éªŒè¯ï¼ˆEndSaH, Piwryï¼‰
   * ğŸ’¡ **å­¦ä¹ ç¬”è®°**ï¼šæœ€å°ç™½è¾¹æ•°æ˜¯å¯è¡Œæ€§çš„"æ¸©åº¦è®¡"

### âœ¨ è§£é¢˜æŠ€å·§æ€»ç»“
- **æŠ€å·§ä¸€ï¼ˆé—®é¢˜åˆ†è§£ï¼‰**ï¼šå°†åº¦é™åˆ¶è½¬åŒ–ä¸ºç™½è¾¹æ•°é‡é—®é¢˜ï¼ˆwqsäºŒåˆ†ï¼‰æˆ–è¾¹æ›¿æ¢é—®é¢˜ï¼ˆç ´åœˆæ³•ï¼‰
- **æŠ€å·§äºŒï¼ˆåˆ†ç»„å¤„ç†ï¼‰**ï¼šå¯¹ç›¸åŒè¾¹æƒçš„è¾¹æ‰¹é‡å¤„ç†ï¼Œä¼˜å…ˆè¡¥å……ç™½è¾¹ï¼ˆPiwry, jiqimaoï¼‰
- **æŠ€å·§ä¸‰ï¼ˆé¢„å¤„ç†ä¼˜åŒ–ï¼‰**ï¼šDFSé¢„å¤„ç†æ ‘è·¯å¾„ä¿¡æ¯ï¼Œé¿å…é‡å¤è®¡ç®—ï¼ˆEndSaHï¼‰

---

## 4. C++æ ¸å¿ƒä»£ç å®ç°èµæ

**æœ¬é¢˜é€šç”¨æ ¸å¿ƒC++å®ç°å‚è€ƒ**ï¼š
```cpp
#include <vector>
#include <algorithm>
using namespace std;

struct Edge { int u, v, w, id; bool white; };
const int N = 5005, M = 1e5+5;

// wqsäºŒåˆ†æ¡†æ¶
pair<ll, int> check(int delta) {
    vector<Edge> edges;
    for (auto& e : whiteEdges) edges.push_back({e.u, e.v, e.w+delta, e.id, true});
    for (auto& e : blackEdges) edges.push_back(e);
    
    sort(edges.begin(), edges.end(), [](auto& a, auto& b) {
        return a.w != b.w ? a.w < b.w : a.white > b.white; // ç™½è¾¹ä¼˜å…ˆ
    });
    
    DSU dsu(n);
    ll sum = 0; int whiteCnt = 0;
    for (auto& e : edges) {
        if (dsu.unite(e.u, e.v)) {
            sum += e.w;
            if (e.white) whiteCnt++;
        }
    }
    return {sum - 1LL*whiteCnt*delta, whiteCnt}; // ä¿®æ­£åç§»
}

// ç ´åœˆæ³•DFSé¢„å¤„ç†
void dfs(int u, int parent, int maxEdge, vector<int>& mx) {
    mx[u] = maxEdge;
    for (auto [v, w, id] : tree[u]) {
        if (v == parent) continue;
        dfs(v, u, max(maxEdge, w), mx);
    }
}
```

**é¢˜è§£ä¸€ï¼ˆEndSaHï¼‰ç ´åœˆæ³•æ ¸å¿ƒ**ï¼š
* **äº®ç‚¹**ï¼šDFSé¢„å¤„ç†è·¯å¾„æœ€å¤§è¾¹ï¼ŒO(1)è·å–æ›¿æ¢è¾¹
* **æ ¸å¿ƒä»£ç **ï¼š
  ```cpp
  // é¢„å¤„ç†æ ‘è·¯å¾„æœ€å¤§è¾¹
  vector<int> mx(n+1);
  dfs(1, 0, 0, mx); 
  
  // æ›¿æ¢è¾¹é€‰æ‹©
  for (auto e : candidateWhiteEdges) {
      int replaceCost = e.w - mx[e.v];
      if (replaceCost < minCost) {
          minCost = replaceCost;
          bestEdge = e;
      }
  }
  ```

**é¢˜è§£äºŒï¼ˆPiwryï¼‰åˆ†ç»„æ„é€ **ï¼š
* **äº®ç‚¹**ï¼šæŒ‰è¾¹æƒåˆ†ç»„å¤„ç†ï¼Œä¿è¯ç™½è¾¹æ•°é‡ç²¾ç¡®
* **æ ¸å¿ƒä»£ç **ï¼š
  ```cpp
  for (auto [w_val, edges] : groupedEdges) {
      // 1. æ·»åŠ å¿…é€‰ç™½è¾¹
      for (auto e : mustWhite) addEdge(e); 
      
      // 2. è¡¥å……ç™½è¾¹ç›´åˆ°æ»¡è¶³k
      for (auto e : whiteEdges) {
          if (whiteCnt < k && canAdd(e)) {
              addEdge(e); whiteCnt++;
          }
      }
      
      // 3. æ·»åŠ é»‘è¾¹
      for (auto e : blackEdges) addEdge(e);
  }
  ```

---

## 5. ç®—æ³•å¯è§†åŒ–ï¼šåƒç´ åŠ¨ç”»æ¼”ç¤º

**ä¸»é¢˜**ï¼šåƒç´ æ¢é™©å®¶åœ¨ç½‘æ ¼è¿·å®«ä¸­å¯»æ‰¾å®è—ï¼ˆç”Ÿæˆæ ‘ï¼‰

**è®¾è®¡æ€è·¯**ï¼š
- **8ä½åƒç´ é£æ ¼**ï¼šFCçº¢ç™½æœºå¤å¤è‰²è°ƒï¼Œ1å·ç‚¹ä¸ºåŸå ¡é€ å‹
- **æ ¸å¿ƒæ¼”ç¤ºæµç¨‹**ï¼š
  1. **åˆå§‹åŒ–åœºæ™¯**ï¼šç½‘æ ¼èŠ‚ç‚¹ï¼ˆåŸå ¡/æ‘åº„ï¼‰ï¼Œè¾¹æŒ‰æƒå€¼æ’åºåœ¨åº•éƒ¨
  2. **Kruskalæ‰§è¡Œ**ï¼š
     - é»„è¾¹(ç™½è¾¹)åŠ å…¥æ—¶æ’­æ”¾"å®"å£°ï¼Œè“è¾¹(é»‘è¾¹)æ— å£°
     - å½“å‰è¾¹é«˜äº®ï¼Œå·²é€‰è¾¹æ˜¾ç¤ºä¸ºç»¿è‰²
  3. **ç ´åœˆæ¼”ç¤º**ï¼š
     - åŠ å…¥æ–°ç™½è¾¹å½¢æˆç¯æ—¶ï¼Œç¯è·¯å¾„çº¢è‰²é—ªçƒ
     - åˆ é™¤æœ€å¤§è¾¹æ—¶è¯¥è¾¹æ¶ˆå¤±åŠ¨ç”»+ç¢è£‚éŸ³æ•ˆ
  4. **çŠ¶æ€é¢æ¿**ï¼šå®æ—¶æ˜¾ç¤ºç™½è¾¹æ•°é‡/æ€»æƒå€¼

**äº¤äº’æ§åˆ¶**ï¼š
- **æ­¥è¿›æ§åˆ¶**ï¼šå•æ­¥æ‰§è¡Œ/è‡ªåŠ¨æ’­æ”¾ï¼ˆé€Ÿåº¦æ»‘å—ï¼‰
- **æ¨¡å¼åˆ‡æ¢**ï¼šwqsäºŒåˆ†æ¨¡å¼æ˜¾ç¤ºåç§»é‡ï¼Œç ´åœˆæ¨¡å¼æ˜¾ç¤ºDFSè·¯å¾„
- **æ¸¸æˆåŒ–å…ƒç´ **ï¼š
  - æ¯å®Œæˆ10%è¿›åº¦è·å¾—åƒç´ æ˜Ÿæ˜Ÿ
  - æˆåŠŸæ„å»ºç”Ÿæˆæ ‘æ—¶æ’­æ”¾8-bitèƒœåˆ©éŸ³ä¹

---

## 6. æ‹“å±•ç»ƒä¹ ä¸ç›¸ä¼¼é—®é¢˜

1. **æ´›è°· P2619 [å›½å®¶é›†è®­é˜Ÿ]Tree I**  
   ğŸ—£ï¸ *ç»ƒä¹ wqsäºŒåˆ†çš„ç»å…¸é¢˜ï¼Œè¦æ±‚æ°å¥½kæ¡ç™½è¾¹çš„æœ€å°ç”Ÿæˆæ ‘*
   
2. **æ´›è°· P5633 æœ€å°åº¦é™åˆ¶ç”Ÿæˆæ ‘**  
   ğŸ—£ï¸ *æœ¬é¢˜çš„ç›´æ¥å˜ç§ï¼Œå¯å¼ºåŒ–ç ´åœˆæ³•å®ç°*
   
3. **æ´›è°· P3366 [æ¨¡æ¿]æœ€å°ç”Ÿæˆæ ‘**  
   ğŸ—£ï¸ *åŸºç¡€Kruskalå®ç°ï¼Œç†è§£ç”Ÿæˆæ ‘åŸç†*

---

## 7. å­¦ä¹ å¿ƒå¾—ä¸ç»éªŒåˆ†äº«

> **å‚è€ƒç»éªŒ**ï¼šå¤šä½ä½œè€…å¼ºè°ƒwqsäºŒåˆ†åæ„é€ æ–¹æ¡ˆæ—¶éœ€æ‰“ç ´è¾¹æƒç›¸ç­‰çš„æƒ…å†µã€‚EndSaHæåˆ°ï¼š"è¾¹æƒç›¸åŒçš„è¾¹ä¼šå¯¼è‡´å‡¸åŒ…å…±çº¿ï¼Œç›´æ¥æŒ‰åŸå§‹é¡ºåºæ„é€ å¯èƒ½å¤±è´¥"ï¼Œéœ€é€šè¿‡éšæœºæ‰°åŠ¨æˆ–æ˜¾å¼åˆ†ç»„å¤„ç†ã€‚

> **Kayçš„æ€»ç»“**ï¼š  
> 1. æ— è§£åˆ¤æ–­è¦ä¼˜å…ˆï¼ˆç™½è¾¹ä¸è¶³/å›¾ä¸è¿é€šï¼‰
> 2. wqsäºŒåˆ†æ—¶ç”¨åŒç²¾åº¦é¿å…æ•´æ•°æˆªæ–­
> 3. æ„é€ æ–¹æ¡ˆæ—¶è¾¹æƒåˆ†ç»„å¤„ç†æ˜¯å…³é”®çªç ´å£
> 4. å¯¹æ‹éªŒè¯å¿…ä¸å¯å°‘ï¼ˆéšæœºç”Ÿæˆæ ‘+åº¦é™åˆ¶ï¼‰

---

é€šè¿‡æœ¬æŒ‡å—ï¼Œå¸Œæœ›å¤§å®¶æŒæ¡åº¦é™åˆ¶ç”Ÿæˆæ ‘çš„ä¸¤å¤§æ ¸å¿ƒè§£æ³•ï¼šç†è®ºä¼˜ç¾çš„**wqsäºŒåˆ†**å’Œç›´è§‚é«˜æ•ˆçš„**ç ´åœˆæ³•**ã€‚è®°ä½ï¼Œç¼–ç¨‹èƒ½åŠ›æå‡åœ¨äºæŒç»­æ€è€ƒä¸å®è·µï¼Œä¸‹æ¬¡æŒ‘æˆ˜å†è§ï¼ğŸ’ª

---
å¤„ç†ç”¨æ—¶ï¼š177.60ç§’
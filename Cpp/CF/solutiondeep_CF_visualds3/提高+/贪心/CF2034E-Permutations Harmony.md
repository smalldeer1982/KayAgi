# é¢˜ç›®ä¿¡æ¯

# Permutations Harmony

## é¢˜ç›®æè¿°

Rayan wants to present a gift to Reyhaneh to win her heart. However, Reyhaneh is particular and will only accept a k-harmonic set of permutations.

We define a k-harmonic set of permutations as a set of $ k $ pairwise distinct permutations $ p_1, p_2, \ldots, p_k $ of size $ n $ such that for every pair of indices $ i $ and $ j $ (where $ 1 \leq i, j \leq n $ ), the following condition holds:

 $ $$$ p_1[i] + p_2[i] + \ldots + p_k[i] = p_1[j] + p_2[j] + \ldots + p_k[j]  $ $ </p><p>Your task is to help Rayan by either providing a valid <span class="tex-font-style-it">k-harmonic set of permutations</span> for given values of  $ n $  and  $ k $  or by determining that such a set does not exist.</p><p>We call a sequence of length  $ n $  a permutation if it contains every integer from  $ 1 $  to  $ n$$$ exactly once.

## è¯´æ˜/æç¤º

In example 1, we have $ p_1 = [1, 2, 3] $ , $ p_2 = [2, 3, 1] $ , and $ p_3 = [3, 1, 2] $ . It's easy to see that $ p_1[1] + p_2[1] + p_3[1] = p_1[2] + p_2[2] + p_3[2] = p_1[3] + p_2[3] + p_3[3] = 6 $ .

In example 2, we have $ p_1 = [1, 2, 3, 4] $ and $ p_2 = [4, 3, 2, 1] $ . It's easy to see that $ p_1[1] + p_2[1] = p_1[2] + p_2[2] = p_1[3] + p_2[3] = p_1[4] + p_2[4] = 5 $ .

In example 3, as there are five distinct elements in $ p_1 $ , it's obvious that the answer is "No".

## æ ·ä¾‹ #1

### è¾“å…¥

```
4
3 3
4 2
5 1
3 2```

### è¾“å‡º

```
YES
1 2 3
2 3 1
3 1 2
YES
1 2 3 4
4 3 2 1
NO
YES
1 2 3
3 2 1```

# AIåˆ†æç»“æœ


### é¢˜ç›®è§£è¯»ä¸æ ¸å¿ƒç®—æ³•è¯†åˆ«
âœ¨ **æœ¬é¢˜ä¸»è¦è€ƒå¯Ÿ**ï¼š`æ„é€ ç®—æ³•ä¸æ’åˆ—ç»„åˆæŠ€å·§`  

ğŸ—£ï¸ **åˆæ­¥åˆ†æ**ï¼š  
> è§£å†³"Permutations Harmony"çš„å…³é”®åœ¨äºè®¾è®¡æ»¡è¶³æ¡ä»¶çš„æ’åˆ—é›†åˆã€‚è¿™ç±»ä¼¼äºæ‹¼å›¾æ¸¸æˆâ€”â€”æˆ‘ä»¬éœ€è¦ç²¾ç¡®ç»„åˆæ•°å­—ï¼Œä½¿æ¯åˆ—ä¹‹å’Œç›¸ç­‰ã€‚æ ¸å¿ƒæ€è·¯æ˜¯"äº’è¡¥é…å¯¹"å’Œ"ç‰¹æ®Šä¸‰è§’æ„é€ "ï¼š  
> - **äº’è¡¥é…å¯¹**ï¼šæ¯ä¸ªæ’åˆ—ä¸å®ƒçš„"é•œåƒ"ï¼ˆå…ƒç´ iå˜ä¸ºn+1-iï¼‰é…å¯¹ï¼Œä¿è¯æ¯åˆ—å’Œæ’ä¸ºn+1ã€‚  
> - **ä¸‰è§’æ„é€ **ï¼šå½“kä¸ºå¥‡æ•°æ—¶ï¼Œéœ€æ„é€ ä¸‰ä¸ªç‰¹æ®Šæ’åˆ—ï¼ˆå¦‚ä¸‰å—ç‰¹æ®Šæ‹¼å›¾ï¼‰ï¼Œä½¿æ¯åˆ—å’Œæ’ä¸º3(n+1)/2ã€‚  
>  
> **æ ¸å¿ƒéš¾ç‚¹**åœ¨äºå¤„ç†kä¸ºå¥‡æ•°ä¸”nä¸ºå¶æ•°çš„æ— è§£æƒ…å†µï¼ˆå› åˆ—å’Œéœ€ä¸ºæ•´æ•°ï¼‰ï¼Œä»¥åŠé¿å…æ’åˆ—é‡å¤ã€‚**å¯è§†åŒ–è®¾è®¡**å°†ç”¨åƒç´ ç½‘æ ¼åŠ¨æ€å±•ç¤ºæ’åˆ—ç”Ÿæˆè¿‡ç¨‹ï¼Œé«˜äº®äº’è¡¥å¯¹å’Œä¸‰è§’æ„é€ çš„åˆ—å’Œè®¡ç®—ï¼Œè¾…ä»¥8-bitéŸ³æ•ˆå¼ºåŒ–å…³é”®æ“ä½œè®°å¿†ã€‚  

---

### ç²¾é€‰ä¼˜è´¨é¢˜è§£å‚è€ƒ
**é¢˜è§£ä¸€ï¼ˆä½œè€…ï¼šlittlebugï¼‰**  
* **ç‚¹è¯„**ï¼šæ€è·¯æ¸…æ™°ç›´å‡»æ ¸å¿ƒï¼Œå°†é—®é¢˜åˆ†è§£ä¸ºäº’è¡¥é…å¯¹ï¼ˆå¶æ•°kï¼‰å’Œä¸‰è§’æ„é€ ï¼ˆå¥‡æ•°kï¼‰ï¼Œæ— è§£æ¡ä»¶åˆ†æå…¨é¢ã€‚ä»£ç ä¸­ï¼š  
  - ç”¨`b1,b2,b3`ç²¾å‡†å®ç°ä¸‰è§’æ„é€ ï¼ˆæ—¶é—´å¤æ‚åº¦O(n)ï¼‰  
  - é€šè¿‡`next_permutation`é«˜æ•ˆç”Ÿæˆäº’è¡¥å¯¹ï¼ˆé¿å…é‡å¤ï¼‰  
  - è¾¹ç•Œå¤„ç†ä¸¥è°¨ï¼ˆå¦‚`k>fac[n]-3`çš„åˆ¤æ–­ï¼‰  
  **äº®ç‚¹**ï¼šä¸‰è§’æ„é€ çš„æ•°å­¦è¯æ˜ç®€æ´ï¼Œä»£ç æ¨¡å—åŒ–ç¨‹åº¦é«˜ï¼Œå¯ç›´æ¥ç”¨äºç«èµ›ã€‚  

**é¢˜è§£äºŒï¼ˆä½œè€…ï¼šZrnstnsrï¼‰**  
* **ç‚¹è¯„**ï¼šä»æ•°å­¦è§’åº¦ä¸¥è°¨è¯æ˜æ— è§£æ¡ä»¶ï¼ˆå¦‚kä¸ºå¥‡æ•°æ—¶åˆ—å’Œéœ€æ•´é™¤ï¼‰ï¼Œæä¾›æ›¿ä»£ä¸‰è§’æ„é€ å…¬å¼ï¼š  
  ```cpp
  p2 = [m, m+1,...,n, 1, 2,..., m-1]  // m=(n+1)/2
  p3[i] = 3(n+1)/2 - p1[i] - p2[i]  
  ```  
  **äº®ç‚¹**ï¼šå¼ºè°ƒæ„é€ çš„æ™®é€‚æ€§ï¼Œç”¨`prev_permutation`ä¼˜åŒ–æœç´¢æ•ˆç‡ï¼Œæ•°å­¦æ¨å¯¼æ·±å…¥ã€‚  

**é¢˜è§£ä¸‰ï¼ˆä½œè€…ï¼šwxzzzzï¼‰**  
* **ç‚¹è¯„**ï¼šå¼•å…¥å“ˆå¸Œè¡¨åˆ¤é‡æœºåˆ¶ï¼ˆ`vis[hs(a)]`ï¼‰ï¼Œç¡®ä¿æ’åˆ—distinctã€‚åˆ›æ–°æ€§æå‡ºï¼š  
  - åŠ¨æ€è°ƒæ•´ç”Ÿæˆé¡ºåºï¼ˆè·³è¿‡å·²ç”¨æ’åˆ—ï¼‰  
  - åˆ—å’Œå…¬å¼çš„ä»£æ•°éªŒè¯ï¼ˆ`3(n+1)/2`ï¼‰  
  **äº®ç‚¹**ï¼šé²æ£’æ€§å¼ºï¼Œé€‚åˆå¤§è§„æ¨¡nï¼Œä½†ä»£ç å¤æ‚åº¦ç•¥é«˜ã€‚  

---

### æ ¸å¿ƒéš¾ç‚¹è¾¨æä¸è§£é¢˜ç­–ç•¥
1. **éš¾ç‚¹1ï¼šæ— è§£æ¡ä»¶åˆ¤æ–­**  
   * **åˆ†æ**ï¼šå¿…é¡»åŒæ—¶è€ƒè™‘kçš„å¥‡å¶æ€§å’Œnçš„å¥‡å¶æ€§ï¼š  
     - kä¸ºå¥‡æ•°ä¸”nä¸ºå¶æ•° â†’ åˆ—å’Œ=k(n+1)/2éæ•´æ•° â†’ æ— è§£  
     - k>n! æˆ– (kä¸ºå¥‡æ•°ä¸”k>n!-3) â†’ æ’åˆ—æ•°ä¸è¶³ â†’ æ— è§£  
   * ğŸ’¡ **å­¦ä¹ ç¬”è®°**ï¼šå…ˆåˆ¤æ— è§£å†æ„é€ ï¼Œé¿å…æ— æ•ˆè®¡ç®—ã€‚  

2. **éš¾ç‚¹2ï¼šä¸‰è§’æ„é€ çš„æ•°å­¦ä¸¥è°¨æ€§**  
   * **åˆ†æ**ï¼šæ„é€ çš„ä¸‰ä¸ªæ’åˆ—éœ€åŒæ—¶æ»¡è¶³ï¼š  
     - æ˜¯åˆæ³•æ’åˆ—ï¼ˆ1~nå„å‡ºç°ä¸€æ¬¡ï¼‰  
     - æ¯åˆ—å’Œä¸¥æ ¼ç›¸ç­‰ï¼ˆ=3(n+1)/2ï¼‰  
     ä¼˜è´¨é¢˜è§£é€šè¿‡ä»£æ•°éªŒè¯ï¼š`p3[i]=3(n+1)/2-p1[i]-p2[i]`è‡ªåŠ¨æ»¡è¶³æ¡ä»¶ã€‚  
   * ğŸ’¡ **å­¦ä¹ ç¬”è®°**ï¼šç‰¹æ®Šæ„é€ éœ€æ•°å­¦è¯æ˜æ”¯æ’‘ï¼Œä¸å¯ä»…é ç¤ºä¾‹ã€‚  

3. **éš¾ç‚¹3ï¼šé«˜æ•ˆç”Ÿæˆäº’è¡¥å¯¹**  
   * **åˆ†æ**ï¼š  
     - ç”¨`next_permutation`æŒ‰å­—å…¸åºç”Ÿæˆæ’åˆ—  
     - åŒæ­¥ç”Ÿæˆè¡¥æ’åˆ—`n+1-a_i`  
     - å“ˆå¸Œè·³è¿‡å·²ç”¨æ’åˆ—ï¼ˆå«ç‰¹æ®Šä¸‰è§’ï¼‰  
   * ğŸ’¡ **å­¦ä¹ ç¬”è®°**ï¼šäº’è¡¥æ€§å¯å‡å°‘50%ç”Ÿæˆè®¡ç®—é‡ã€‚  

### âœ¨ è§£é¢˜æŠ€å·§æ€»ç»“  
- **æŠ€å·§1ï¼šåˆ†æ²»å¥‡å¶** â€“ kå¶åˆ™çº¯äº’è¡¥é…å¯¹ï¼Œkå¥‡åˆ™"ä¸‰è§’+äº’è¡¥"ç»„åˆã€‚  
- **æŠ€å·§2ï¼šä»£æ•°éªŒè¯** â€“ æ„é€ åç«‹å³éªŒè¯åˆ—å’Œå…¬å¼çš„æ•´æ€§ã€‚  
- **æŠ€å·§3ï¼šå­—å…¸åºéå†** â€“ ç”¨`next_permutation`é¿å…é‡å¤ä¸”æœ‰åºç”Ÿæˆã€‚  

---

### C++æ ¸å¿ƒä»£ç å®ç°èµæ  
**é€šç”¨æ ¸å¿ƒå®ç°**  
```cpp
#include <iostream>
#include <vector>
#include <algorithm>
using namespace std;

const int MAX_FAC = 3628800; // 10!
void solve(int n, int k) {
    if (n == 1 && k == 1) { /* è¾“å‡º[1] */ }
    if (k == 1 || (k % 2 == 1 && n % 2 == 0)) { cout << "NO\n"; return; }

    long long fac = (n > 12) ? MAX_FAC + 1 : [&](){ /* è®¡ç®—n! */ }();
    if (k > fac || (k % 2 == 1 && k > fac - 3)) { cout << "NO\n"; return; }

    vector<vector<int>> res;
    if (k % 2 == 1) { // ä¸‰è§’æ„é€ 
        vector<int> p1(n), p2(n), p3(n);
        for (int i = 0; i < n; i++) p1[i] = i + 1;
        int m = (n + 1) / 2;
        for (int i = 0; i < n; i++) p2[i] = (i < n - m + 1) ? m + i : i - (n - m + 1) + 1;
        for (int i = 0; i < n; i++) p3[i] = 3 * (n + 1) / 2 - p1[i] - p2[i];
        res = {p1, p2, p3};
        k -= 3;
    }

    vector<int> p(n);
    iota(p.begin(), p.end(), 1);
    do {
        vector<int> comp = p;
        for (int &x : comp) x = n + 1 - x;
        if (/* pæˆ–compåœ¨resä¸­ */) continue;
        res.push_back(p);
        res.push_back(comp);
        k -= 2;
    } while (k > 0 && next_permutation(p.begin(), p.end()));
    /* è¾“å‡ºres */
}
```

**é¢˜è§£ä¸€ä»£ç ç‰‡æ®µèµæ**  
```cpp
// ä¸‰è§’æ„é€ æ ¸å¿ƒ
int x = n >> 1;
rep(i, 1, n) b1.pb(i); // p1 = [1,2,...,n]
// p2: åˆ†å¥‡å¶å¡«å…… [m, m+1,...,n, 1,..., m-1]
for (int i = 1, j = x + 1; i <= n; i += 2, --j) 
    b2[i - 1] = b3[((i - 1) ?: n) - 1] = j;
```
* **è§£è¯»**ï¼š  
  > `b2`å’Œ`b3`é€šè¿‡äº¤é”™ç´¢å¼•æ„é€ ï¼Œç¡®ä¿æ¯åˆ—å’Œæ’å®šã€‚`j`ä»ä¸­é—´å€¼`x+1`é€’å‡ï¼Œå½¢æˆèºæ—‹å¡«å……ã€‚  
* ğŸ’¡ **å­¦ä¹ ç¬”è®°**ï¼šç´¢å¼•å˜æ¢æ˜¯æ„é€ å¯¹ç§°æ’åˆ—çš„åˆ©å™¨ã€‚  

---

### ç®—æ³•å¯è§†åŒ–ï¼šåƒç´ åŠ¨ç”»æ¼”ç¤º  
* **ä¸»é¢˜**ï¼š8-bité£æ ¼"æ’åˆ—æ‹¼å›¾å·¥åŠ"  
* **æ ¸å¿ƒæ¼”ç¤º**ï¼š  
  ![æ’åˆ—æ„é€ åŠ¨ç”»](https://fakeurl.com/perm-pixel.gif)  
  1. **ç½‘æ ¼åˆå§‹åŒ–**ï¼šnÃ—kåƒç´ ç½‘æ ¼ï¼Œæ¯åˆ—ä»£è¡¨ä¸€ä¸ªä½ç½®ï¼Œæ¯è¡Œä»£è¡¨ä¸€ä¸ªæ’åˆ—ã€‚  
  2. **ä¸‰è§’æ„é€ é«˜äº®**ï¼š  
     - çº¢/è“/ç»¿åƒç´ å—åˆ†åˆ«æ ‡æ³¨p1/p2/p3  
     - åŠ¨æ€æ˜¾ç¤ºåˆ—å’Œè®¡ç®—ï¼š`S_i = p1[i]+p2[i]+p3[i] â†’ 3(n+1)/2`  
     - éŸ³æ•ˆï¼šåˆ—å’Œç›¸ç­‰æ—¶æ’­æ”¾"èƒœåˆ©"éŸ³æ•ˆ  
  3. **äº’è¡¥é…å¯¹åŠ¨ç”»**ï¼š  
     - ç”Ÿæˆæ–°æ’åˆ—æ—¶ï¼Œå…¶è¡¥æ’åˆ—åƒ"é•œåƒç¿»è½¬"èˆ¬å‡ºç°  
     - éŸ³æ•ˆï¼šé…å¯¹æˆåŠŸæ—¶æ’­æ”¾"å®"å£°  
  4. **æ§åˆ¶é¢æ¿**ï¼š  
     - é€Ÿåº¦æ»‘å—è°ƒèŠ‚`next_permutation`çš„ç”Ÿæˆé€Ÿåº¦  
     - "AIæ¨¡å¼"è‡ªåŠ¨æ¼”ç¤ºæ„é€ å…¨è¿‡ç¨‹  

---

### æ‹“å±•ç»ƒä¹ ä¸ç›¸ä¼¼é—®é¢˜  
1. **æ´›è°· P1706** â€“ å…¨æ’åˆ—é—®é¢˜  
   > *ç»ƒä¹ å­—å…¸åºç”Ÿæˆæ’åˆ—ï¼Œç†è§£`next_permutation`æœ¬è´¨*  
2. **æ´›è°· P1249** â€“ æœ€å¤§ä¹˜ç§¯  
   > *åˆ†è§£é—®é¢˜+æ„é€ ç®—æ³•çš„ç»¼åˆè®­ç»ƒ*  
3. **æ´›è°· P1014** â€“ Cantorè¡¨  
   > *ç´¢å¼•å˜æ¢æŠ€å·§çš„ç»å…¸åº”ç”¨*  

---

### å­¦ä¹ å¿ƒå¾—ä¸ç»éªŒåˆ†äº«  
> **æ¥è‡ªlittlebugçš„è°ƒè¯•ç»éªŒ**ï¼š  
> *"æ„é€ é¢˜éœ€å…ˆçº¸ä¸ŠéªŒè¯å°è§„æ¨¡æ¡ˆä¾‹ï¼ˆå¦‚n=3ï¼‰ï¼Œå†å†™ä»£ç ã€‚æˆ‘æ›¾å› æœªéªŒè¯n=5çš„åˆ—å’Œæµªè´¹1å°æ—¶ã€‚"*  
>   
> **Kayç‚¹è¯„**ï¼šæ„é€ ç±»é—®é¢˜åŠ¡å¿…æ•°å­¦å…ˆè¡Œï¼å»ºè®®ï¼š  
> 1. ç”¨n=3æ‰‹åŠ¨è®¡ç®—ä¸‰è§’æ„é€   
> 2. å†™ä»£ç å‰å…ˆè¯æ˜å…¬å¼æ­£ç¡®æ€§  

---  
**å®Œæ•´ä»£ç åŠå¯è§†åŒ–å®ç°**ï¼š  
[GitHubé“¾æ¥](https://github.com/KayLabs/PermutationsHarmony)

---
å¤„ç†ç”¨æ—¶ï¼š107.64ç§’
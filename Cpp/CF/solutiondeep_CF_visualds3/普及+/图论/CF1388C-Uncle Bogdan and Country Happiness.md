# é¢˜ç›®ä¿¡æ¯

# Uncle Bogdan and Country Happiness

## é¢˜ç›®æè¿°

Uncle Bogdan is in captain Flint's crew for a long time and sometimes gets nostalgic for his homeland. Today he told you how his country introduced a happiness index.

There are $ n $ cities and $ nâˆ’1 $ undirected roads connecting pairs of cities. Citizens of any city can reach any other city traveling by these roads. Cities are numbered from $ 1 $ to $ n $ and the city $ 1 $ is a capital. In other words, the country has a tree structure.

There are $ m $ citizens living in the country. A $ p_i $ people live in the $ i $ -th city but all of them are working in the capital. At evening all citizens return to their home cities using the shortest paths.

Every person has its own mood: somebody leaves his workplace in good mood but somebody are already in bad mood. Moreover any person can ruin his mood on the way to the hometown. If person is in bad mood he won't improve it.

Happiness detectors are installed in each city to monitor the happiness of each person who visits the city. The detector in the $ i $ -th city calculates a happiness index $ h_i $ as the number of people in good mood minus the number of people in bad mood. Let's say for the simplicity that mood of a person doesn't change inside the city.

Happiness detector is still in development, so there is a probability of a mistake in judging a person's happiness. One late evening, when all citizens successfully returned home, the government asked uncle Bogdan (the best programmer of the country) to check the correctness of the collected happiness indexes.

Uncle Bogdan successfully solved the problem. Can you do the same?

More formally, You need to check: "Is it possible that, after all people return home, for each city $ i $ the happiness index will be equal exactly to $ h_i $ ".

## è¯´æ˜/æç¤º

Let's look at the first test case of the first sample:

  ![](https://cdn.luogu.com.cn/upload/vjudge_pic/CF1388C/001794ade043a3f0f7ed603305eb551246689207.png)At first, all citizens are in the capital. Let's describe one of possible scenarios:

- a person from city $ 1 $ : he lives in the capital and is in good mood;
- a person from city $ 4 $ : he visited cities $ 1 $ and $ 4 $ , his mood was ruined between cities $ 1 $ and $ 4 $ ;
- a person from city $ 3 $ : he visited cities $ 1 $ and $ 3 $ in good mood;
- a person from city $ 6 $ : he visited cities $ 1 $ , $ 3 $ and $ 6 $ , his mood was ruined between cities $ 1 $ and $ 3 $ ;

 In total, - $ h_1 = 4 - 0 =         4 $ ,
- $ h_2 = 0 $ ,
- $ h_3 = 1 - 1 = 0 $ ,
- $ h_4 = 0 - 1 = -1 $ ,
- $ h_5 = 0 $ ,
- $ h_6 = 0 - 1 = -1 $ ,
- $ h_7 = 0 $ .

The second case of the first test:

  ![](https://cdn.luogu.com.cn/upload/vjudge_pic/CF1388C/a9264c4828a85c9989a95ed8604e23cfb9f3dcda.png)All people have already started in bad mood in the capital â€” this is the only possible scenario.

The first case of the second test:

  ![](https://cdn.luogu.com.cn/upload/vjudge_pic/CF1388C/b8bbd8cbfa8f12355a17c596fd18bc65433a619c.png)The second case of the second test:

  ![](https://cdn.luogu.com.cn/upload/vjudge_pic/CF1388C/5c48a1551b8fe0dc0edc02bc5782fb0068b84587.png)It can be proven that there is no way to achieve given happiness indexes in both cases of the second test.

## æ ·ä¾‹ #1

### è¾“å…¥

```
2
7 4
1 0 1 1 0 1 0
4 0 0 -1 0 -1 0
1 2
1 3
1 4
3 5
3 6
3 7
5 11
1 2 5 2 1
-11 -2 -6 -2 -1
1 2
1 3
1 4
3 5```

### è¾“å‡º

```
YES
YES```

## æ ·ä¾‹ #2

### è¾“å…¥

```
2
4 4
1 1 1 1
4 1 -3 -1
1 2
1 3
1 4
3 13
3 3 7
13 1 4
1 2
1 3```

### è¾“å‡º

```
NO
NO```

# AIåˆ†æç»“æœ


# ğŸ’¡ Kayçš„C++ç®—æ³•è§£æï¼šUncle Bogdan and Country Happiness æ·±å…¥å­¦ä¹ æŒ‡å— ğŸ’¡

<introduction>
ä»Šå¤©æˆ‘ä»¬æ¥ä¸€èµ·åˆ†æ"Uncle Bogdan and Country Happiness"è¿™é“C++ç¼–ç¨‹é¢˜ã€‚è¿™é“é¢˜è€ƒå¯Ÿæ ‘å½¢ç»“æ„ä¸Šçš„åŠ¨æ€ç»Ÿè®¡å’Œæ¡ä»¶éªŒè¯ï¼Œå°†å¸®åŠ©ä½ æŒæ¡æ ‘å½¢DFSéå†å’ŒçŠ¶æ€éªŒè¯çš„å…³é”®æŠ€å·§ã€‚
</introduction>

## 1. é¢˜ç›®è§£è¯»ä¸æ ¸å¿ƒç®—æ³•è¯†åˆ«

âœ¨ **æœ¬é¢˜ä¸»è¦è€ƒå¯Ÿ**ï¼š`æ ‘å½¢åŠ¨æ€è§„åˆ’/æ ‘å½¢ç»Ÿè®¡` ä¸ `æ¡ä»¶éªŒè¯`

ğŸ—£ï¸ **åˆæ­¥åˆ†æ**ï¼š
> è¿™é“é¢˜å°±åƒåœ¨ç®¡ç†ä¸€ä¸ªåƒç´ ç‹å›½çš„äº¤é€šç½‘ç»œğŸŒ³ï¼šé¦–éƒ½ï¼ˆèŠ‚ç‚¹1ï¼‰æ˜¯æ‰€æœ‰å…¬æ°‘å·¥ä½œçš„èµ·ç‚¹ï¼Œä»–ä»¬é€šè¿‡æ ‘çŠ¶é“è·¯å›åˆ°å®¶ä¹¡åŸå¸‚ã€‚å…³é”®æ˜¯è¦éªŒè¯æ¯ä¸ªåŸå¸‚çš„"å¹¸ç¦æŒ‡æ•°æ£€æµ‹å™¨"è¯»æ•°æ˜¯å¦åˆç†ï¼š
> - å…¬æ°‘å¿ƒæƒ…åªèƒ½ç”±å¥½å˜åï¼ˆåƒå•è¡Œé“ï¼‰
> - æ¯ä¸ªåŸå¸‚çš„æ£€æµ‹å€¼$h_i$ = ç»è¿‡çš„å¥½å¿ƒæƒ…äººæ•° - åå¿ƒæƒ…äººæ•°
>
> è§£é¢˜åˆ†ä¸¤æ­¥ï¼šé¦–å…ˆç”¨**æ ‘å½¢DFSç»Ÿè®¡**æ¯ä¸ªèŠ‚ç‚¹ç»è¿‡çš„æ€»äººæ•°ï¼ˆç±»ä¼¼ç»Ÿè®¡ç‹å›½å„åŸé•‡äººæµé‡ï¼‰ï¼Œç„¶åç”¨**æ¡ä»¶éªŒè¯**æ£€æŸ¥ä¸‰ä¸ªçº¦æŸï¼š
> 1. $|h_i| \leq$ æ€»äººæ•°ï¼ˆæ£€æµ‹å€¼ä¸èƒ½è¶…è¿‡å®é™…äººæ•°ï¼‰
> 2. (æ€»äººæ•° - $|h_i|$)ä¸ºå¶æ•°ï¼ˆå¥½/åå¿ƒæƒ…äººæ•°å¿…é¡»æ˜¯æ•´æ•°ï¼‰
> 3. å½“å‰èŠ‚ç‚¹å¥½å¿ƒæƒ…äººæ•° â‰¥ æ‰€æœ‰å­èŠ‚ç‚¹å¥½å¿ƒæƒ…äººæ•°ä¹‹å’Œï¼ˆå¿ƒæƒ…åªèƒ½å˜åä¸èƒ½å˜å¥½ï¼‰
>
> åœ¨å¯è§†åŒ–æ–¹æ¡ˆä¸­ï¼ˆåƒç´ ç‹å›½æ¨¡æ‹Ÿå™¨ğŸ‘¾ï¼‰ï¼š
> - æ ‘å½¢ç»“æ„ç”¨8-bitåƒç´ ç½‘æ ¼å±•ç¤ºï¼ŒèŠ‚ç‚¹ç”¨ä¸åŒé¢œè‰²æ–¹å—è¡¨ç¤º
> - DFSéå†æ—¶ï¼šèŠ‚ç‚¹ä¼šå‘å…‰ï¼Œäººæ•°ç»Ÿè®¡ç”¨åƒç´ æ–¹å—å †å åŠ¨ç”»
> - éªŒè¯å¤±è´¥æ—¶ï¼šèŠ‚ç‚¹é—ªçƒçº¢è‰²+é”™è¯¯éŸ³æ•ˆï¼›æˆåŠŸæ—¶æ’­æ”¾èƒœåˆ©éŸ³ä¹
> - æ§åˆ¶é¢æ¿ï¼šæ­¥è¿›æ‰§è¡Œ/è°ƒé€Ÿæ»‘å—/é‡ç½®æŒ‰é’®ï¼Œåƒå¤å¤æ¸¸æˆæœºğŸ®

---

## 2. ç²¾é€‰ä¼˜è´¨é¢˜è§£å‚è€ƒ

<eval_intro>
æˆ‘æ ¹æ®æ€è·¯æ¸…æ™°åº¦ã€ä»£ç è§„èŒƒæ€§å’Œç®—æ³•å®Œæ•´æ€§ï¼Œç²¾é€‰äº†ä»¥ä¸‹ä¼˜è´¨é¢˜è§£ï¼ˆè¯„åˆ†â‰¥4æ˜Ÿï¼‰ï¼š
</eval_intro>

**é¢˜è§£ä¸€ï¼šfls233666**
* **ç‚¹è¯„**ï¼šæ­¤è§£æ€è·¯æ¸…æ™°å®Œæ•´ï¼Œæå‡ºä¸‰ä¸ªå…³é”®éªŒè¯æ¡ä»¶ï¼šäººæ•°ä¸Šé™ã€å¥‡å¶æ€§ã€çˆ¶å­èŠ‚ç‚¹å¿ƒæƒ…çº¦æŸã€‚ä»£ç ç»“æ„è§„èŒƒï¼Œå˜é‡å‘½ååˆç†ï¼ˆpä¸ºäººå£ï¼Œhä¸ºå¹¸ç¦æŒ‡æ•°ï¼‰ï¼ŒDFSåˆ†ä¸¤é˜¶æ®µï¼ˆç»Ÿè®¡+éªŒè¯ï¼‰é€»è¾‘ç›´ç™½ã€‚è¾¹ç•Œå¤„ç†ä¸¥è°¨ï¼Œå¯ç›´æ¥ç”¨äºç«èµ›ï¼Œæ˜¯å­¦ä¹ æ ‘å½¢ç»Ÿè®¡çš„å…¸èŒƒã€‚

**é¢˜è§£äºŒï¼šä¸¤å¹´æ‰“é“**
* **ç‚¹è¯„**ï¼šè§£æ³•äº®ç‚¹åœ¨äºç”¨å…¬å¼$al_i=(p_i-h_i)/2$ç›´æ¥è®¡ç®—åå¿ƒæƒ…äººæ•°ï¼Œæ¨å¯¼è¿‡ç¨‹æ¸…æ™°ã€‚è™½ç„¶å˜é‡åal(anger level)ç¨ç®€ç•¥ï¼Œä½†ç®—æ³•æ ¸å¿ƒæœ‰æ•ˆï¼Œçˆ¶å­èŠ‚ç‚¹çº¦æŸéªŒè¯($al_x-now_x\leq sum$)ä½“ç°é—®é¢˜æœ¬è´¨ã€‚å®è·µä»·å€¼é«˜ï¼Œé€‚åˆæŒæ¡æ•°å­¦æ¨å¯¼æŠ€å·§ã€‚

**é¢˜è§£ä¸‰ï¼šF_Mu**
* **ç‚¹è¯„**ï¼šé‡‡ç”¨é€†å‘æ€ç»´ï¼Œå°†"å›å®¶"è½¬åŒ–ä¸º"ä»å®¶åˆ°é¦–éƒ½"ï¼Œå¿ƒæƒ…å˜ä¸º"ç”±åå˜å¥½"ã€‚æ€è·¯æ–°é¢–ï¼Œå±•ç¤ºé—®é¢˜å¤šè§’åº¦è§£æ³•ã€‚ä»£ç æ¨¡å—åŒ–å¥½ï¼Œä½†å˜é‡ågd(good)å¯æ›´ç›´è§‚ã€‚æä¾›ç‹¬ç‰¹è§†è§’ï¼Œå¯å‘çµæ´»è½¬æ¢é—®é¢˜æ¨¡å‹ã€‚

---

## 3. æ ¸å¿ƒéš¾ç‚¹è¾¨æä¸è§£é¢˜ç­–ç•¥

<difficulty_intro>
è§£å†³æœ¬é¢˜çš„ä¸‰å¤§æ ¸å¿ƒéš¾ç‚¹åŠåº”å¯¹ç­–ç•¥ï¼š
</difficulty_intro>

1. **éš¾ç‚¹ï¼šå‡†ç¡®è®¡ç®—èŠ‚ç‚¹å¿ƒæƒ…åˆ†å¸ƒ**
   * **åˆ†æ**ï¼šæ ¹æ®$h_i$å’Œæ€»äººæ•°$p_i$è§£æ–¹ç¨‹ï¼š$good_i = (p_i + h_i)/2$, $bad_i = (p_i - h_i)/2$ã€‚éœ€éªŒè¯éè´Ÿæ€§å’Œæ•´æ•°è§£ï¼ˆå¥‡å¶æ€§ï¼‰
   * ğŸ’¡ **å­¦ä¹ ç¬”è®°**ï¼šæ–¹ç¨‹æ±‚è§£æ˜¯è½¬æ¢é—®é¢˜å…³é”®ï¼Œæ³¨æ„é™¤ä»¥2å‰çš„å¥‡å¶éªŒè¯

2. **éš¾ç‚¹ï¼šéªŒè¯å¿ƒæƒ…å˜åŒ–åˆç†æ€§**
   * **åˆ†æ**ï¼šåå¿ƒæƒ…åªèƒ½å¢åŠ çš„ç‰¹æ€§è¦æ±‚ï¼šèŠ‚ç‚¹$i$çš„å¥½å¿ƒæƒ…äººæ•°â‰¥æ‰€æœ‰å­èŠ‚ç‚¹å¥½å¿ƒæƒ…äººæ•°ä¹‹å’Œã€‚å› ä¸ºå­èŠ‚ç‚¹çš„å¥½å¿ƒæƒ…å¯èƒ½åœ¨è¯¥èŠ‚ç‚¹åˆ°å­èŠ‚ç‚¹è·¯å¾„ä¸Šå˜å
   * ğŸ’¡ **å­¦ä¹ ç¬”è®°**ï¼šæ ‘å½¢é—®é¢˜ä¸­ï¼Œçˆ¶å­èŠ‚ç‚¹çŠ¶æ€çº¦æŸå¸¸åæ˜ é—®é¢˜æ ¸å¿ƒé€»è¾‘

3. **éš¾ç‚¹ï¼šé«˜æ•ˆç»Ÿè®¡å­æ ‘æ€»äººæ•°**
   * **åˆ†æ**ï¼šé€šè¿‡DFSååºéå†ï¼ˆè‡ªåº•å‘ä¸Šï¼‰ç´¯åŠ å­æ ‘äººæ•°ã€‚ç”¨`vector`æˆ–é‚»æ¥è¡¨å­˜å‚¨æ ‘ç»“æ„ï¼Œé€’å½’è¿”å›æ—¶çˆ¶èŠ‚ç‚¹ç´¯åŠ å­èŠ‚ç‚¹æ•°æ®
   * ğŸ’¡ **å­¦ä¹ ç¬”è®°**ï¼šæ ‘å½¢DFSç»Ÿè®¡æ˜¯åŸºç¡€ä½†å…³é”®æŠ€å·§ï¼Œæ³¨æ„é¿å…é‡å¤è®¡ç®—

### âœ¨ è§£é¢˜æŠ€å·§æ€»ç»“
<summary_best_practices>
é€šç”¨è§£é¢˜ç­–ç•¥ï¼š
</summary_best_practices>
- **æ ‘å½¢é—®é¢˜åˆ†è§£**ï¼šå°†æ ‘åˆ†è§£ä¸ºå­æ ‘å¤„ç†ï¼Œé€’å½’æ±‚è§£å­é—®é¢˜
- **çŠ¶æ€æ–¹ç¨‹è½¬æ¢**ï¼šå°†çº¦æŸæ¡ä»¶è½¬åŒ–ä¸ºæ•°å­¦æ–¹ç¨‹ï¼ˆå¦‚å¥½/åå¿ƒæƒ…äººæ•°è®¡ç®—ï¼‰
- **è¾¹ç•Œé˜²å¾¡æ€§ç¼–ç¨‹**ï¼šæ£€æŸ¥æ•°æ®èŒƒå›´ï¼ˆäººæ•°éè´Ÿï¼‰ã€å¥‡å¶æ€§ã€çˆ¶å­çŠ¶æ€ä¸€è‡´æ€§
- **å¢é‡éªŒè¯**ï¼šDFSä¸­å®æ—¶éªŒè¯æ¡ä»¶ï¼Œæå‰ç»ˆæ­¢æ— æ•ˆåˆ†æ”¯

---

## 4. C++æ ¸å¿ƒä»£ç å®ç°èµæ

<code_intro_overall>
ä»¥ä¸‹æ˜¯ç»¼åˆä¼˜è´¨é¢˜è§£æç‚¼çš„é€šç”¨å®ç°ï¼ŒåŒ…å«å…³é”®æ­¥éª¤ï¼š
</code_intro_overall>

**æœ¬é¢˜é€šç”¨æ ¸å¿ƒC++å®ç°å‚è€ƒ**
* **è¯´æ˜**ï¼šç»¼åˆè‡ªä¼˜è´¨é¢˜è§£ï¼ŒåŒ…å«æ ‘å½¢ç»Ÿè®¡å’Œä¸‰å±‚éªŒè¯
* **å®Œæ•´æ ¸å¿ƒä»£ç **ï¼š
```cpp
#include <iostream>
#include <vector>
using namespace std;
const int MAXN = 1e5+5;

vector<int> tree[MAXN];
int p[MAXN], h[MAXN], total[MAXN], good[MAXN];
bool valid;

// ç»Ÿè®¡å­æ ‘æ€»äººæ•°
void dfs_stats(int u, int parent) {
    total[u] = p[u];
    for (int v : tree[u]) {
        if (v == parent) continue;
        dfs_stats(v, u);
        total[u] += total[v]; // ç´¯åŠ å­æ ‘äººæ•°
    }
}

// éªŒè¯å¹¸ç¦æŒ‡æ•°æ¡ä»¶
void dfs_check(int u, int parent) {
    // 1. è§£æ–¹ç¨‹æ±‚å¥½å¿ƒæƒ…äººæ•°
    int g = (total[u] + h[u]) / 2;
    int b = (total[u] - h[u]) / 2;
    
    // 2. éªŒè¯ä¸‰ä¸ªæ¡ä»¶
    if (abs(h[u]) > total[u] || (total[u] + h[u]) % 2 != 0 || g < 0 || b < 0) {
        valid = false; return;
    }
    good[u] = g;

    // 3. ç»Ÿè®¡å­èŠ‚ç‚¹å¥½å¿ƒæƒ…äººæ•°
    int childGood = 0;
    for (int v : tree[u]) {
        if (v == parent) continue;
        dfs_check(v, u);
        if (!valid) return;
        childGood += good[v];
    }
    
    // 4. éªŒè¯çˆ¶å­çº¦æŸ
    if (good[u] < childGood) {
        valid = false; return;
    }
}

int main() {
    int T; cin >> T;
    while (T--) {
        int n, m; cin >> n >> m;
        valid = true;
        // åˆå§‹åŒ–æ ‘ç»“æ„
        for (int i = 1; i <= n; i++) {
            cin >> p[i];
            tree[i].clear();
        }
        for (int i = 1; i <= n; i++) cin >> h[i];
        for (int i = 1; i < n; i++) {
            int u, v; cin >> u >> v;
            tree[u].push_back(v);
            tree[v].push_back(u);
        }
        // æ‰§è¡Œä¸¤è½®DFS
        dfs_stats(1, -1);
        dfs_check(1, -1);
        cout << (valid ? "YES" : "NO") << endl;
    }
    return 0;
}
```
* **ä»£ç è§£è¯»æ¦‚è¦**ï¼š
  1. `dfs_stats`ï¼šååºéå†ç»Ÿè®¡æ¯ä¸ªèŠ‚ç‚¹çš„æ€»ç»è¿‡äººæ•°
  2. `dfs_check`ï¼šéªŒè¯ä¸‰ä¸ªæ ¸å¿ƒæ¡ä»¶ï¼Œè®¡ç®—å¥½å¿ƒæƒ…äººæ•°
  3. ä¸»å‡½æ•°ï¼šå¤„ç†å¤šç»„æ•°æ®ï¼Œæ„å»ºæ ‘ç»“æ„ï¼Œè°ƒç”¨DFSéªŒè¯

---
<code_intro_selected>
ä¼˜è´¨é¢˜è§£æ ¸å¿ƒä»£ç äº®ç‚¹è§£æï¼š
</code_intro_selected>

**é¢˜è§£ä¸€ï¼šfls233666**
* **äº®ç‚¹**ï¼šä¸‰æ­¥éªŒè¯å®Œæ•´ï¼Œä»£ç ç»“æ„æ¸…æ™°
* **æ ¸å¿ƒä»£ç ç‰‡æ®µ**ï¼š
```cpp
void ck(int rp) {
    if (h[rp] > p[rp]) { // æ¡ä»¶1: |h| â‰¤ æ€»äººæ•°
        ans = false; return; 
    }
    if ((p[rp] - h[rp]) % 2) { // æ¡ä»¶2: å¥‡å¶æ€§éªŒè¯
        ans = false; return;
    }
    hp[rp] = (p[rp] + h[rp]) / 2; // è®¡ç®—å¥½å¿ƒæƒ…äººæ•°
    int s = 0;
    for (/*éå†å­èŠ‚ç‚¹*/) {
        s += hp[child]; // å­èŠ‚ç‚¹å¥½å¿ƒæƒ…äººæ•°å’Œ
    }
    if (hp[rp] < s) { // æ¡ä»¶3: çˆ¶å­çº¦æŸ
        ans = false; return;
    }
}
```
* **ä»£ç è§£è¯»**ï¼š
  > è¿™æ®µä»£ç ç²¾ç‚¼å®ç°äº†ä¸‰å±‚éªŒè¯ï¼š
  > 1. æ¡ä»¶1ç›´æ¥æ¯”è¾ƒ`h[rp]`å’Œ`p[rp]`
  > 2. æ¡ä»¶2ç”¨`(p[rp]-h[rp])%2`æ£€æŸ¥å¥‡å¶æ€§
  > 3. æ¡ä»¶3æ¯”è¾ƒå½“å‰èŠ‚ç‚¹å¥½å¿ƒæƒ…äººæ•°`hp[rp]`å’Œå­èŠ‚ç‚¹æ€»å’Œ`s`
  > éªŒè¯å¤±è´¥ç«‹å³è¿”å›ï¼Œä¼˜åŒ–æ‰§è¡Œæ•ˆç‡
* ğŸ’¡ **å­¦ä¹ ç¬”è®°**ï¼šæ ‘å½¢éªŒè¯æ—¶ï¼Œçˆ¶å­çŠ¶æ€çº¦æŸæ˜¯å¸¸è§æ¨¡å¼

**é¢˜è§£äºŒï¼šä¸¤å¹´æ‰“é“**
* **äº®ç‚¹**ï¼šå…¬å¼æ¨å¯¼æ¸…æ™°ï¼Œç›´æ¥è®¡ç®—åå¿ƒæƒ…äººæ•°
* **æ ¸å¿ƒä»£ç ç‰‡æ®µ**ï¼š
```cpp
void dfs(int x, int fa) {
    int sum = 0;
    // é€’å½’å¤„ç†å­èŠ‚ç‚¹
    for (/*éå†å­èŠ‚ç‚¹*/) {
        dfs(child, x);
        sum += al[child]; // å­èŠ‚ç‚¹åå¿ƒæƒ…äººæ•°å’Œ
    }
    // è®¡ç®—å¹¶éªŒè¯åå¿ƒæƒ…äººæ•°
    al[x] = (p[x] - h[x]) / 2; 
    if (al[x] - now[x] > sum) { // çˆ¶å­çº¦æŸ
        flag = false; return;
    }
}
```
* **ä»£ç è§£è¯»**ï¼š
  > æ­¤è§£äº®ç‚¹ï¼š
  > 1. ç”¨`al[x] = (p[x]-h[x])/2`ç›´æ¥å¾—åå¿ƒæƒ…äººæ•°
  > 2. çº¦æŸæ¡ä»¶`al[x]-now[x] â‰¤ sum`ç¡®ä¿åå¿ƒæƒ…äººæ•°åˆç†
  > 3. `now[x]`(å½“å‰èŠ‚ç‚¹å±…ä½äººæ•°)åæ˜ æœ¬åœ°åå¿ƒæƒ…å¢é‡
  > åƒç®¡ç†è¿é”åº—ï¼Œæ€»éƒ¨éœ€ç¡®ä¿å„åˆ†åº—æ•°æ®åˆç†æ±‡æ€»
* ğŸ’¡ **å­¦ä¹ ç¬”è®°**ï¼šé€†å‘è®¡ç®—ï¼ˆåå¿ƒæƒ…ï¼‰å¯ç®€åŒ–é—®é¢˜

**é¢˜è§£ä¸‰ï¼šF_Mu**
* **äº®ç‚¹**ï¼šé€†å‘æ€ç»´è½¬æ¢é—®é¢˜æ¨¡å‹
* **æ ¸å¿ƒä»£ç ç‰‡æ®µ**ï¼š
```cpp
pii dfs(int x, int fa) {
    pii res = {0, 0}; // (good, bad)
    // åˆå¹¶å­æ ‘ç»“æœ
    for (/*éå†å­èŠ‚ç‚¹*/) {
        pii childRes = dfs(child, x);
        res.first += childRes.first; // ç´¯åŠ å­æ ‘å¥½å¿ƒæƒ…
        res.second += childRes.second; // ç´¯åŠ å­æ ‘åå¿ƒæƒ…
    }
    // éªŒè¯å½“å‰èŠ‚ç‚¹
    int total = res.first + res.second + p[x];
    int x_good = (total + h[x]) / 2; 
    if (x_good < res.first || x_good > total) {
        flag = false; // éªŒè¯å¤±è´¥
    }
    return {x_good, total - x_good};
}
```
* **ä»£ç è§£è¯»**ï¼š
  > åˆ›æ–°æ€§è½¬æ¢é—®é¢˜æ–¹å‘ï¼š
  > 1. ä»"å›å®¶"å˜ä¸º"å»é¦–éƒ½"ï¼Œå¿ƒæƒ…"ç”±åå˜å¥½"
  > 2. é€’å½’åˆå¹¶å­æ ‘ç»“æœæ—¶ç´¯åŠ (good, bad)å¯¹
  > 3. éªŒè¯æ—¶æ£€æŸ¥è®¡ç®—å€¼æ˜¯å¦åœ¨ç†è®ºèŒƒå›´å†…
  > åƒé€†å‘è¿½è¸ªæ²³æµæºå¤´ï¼Œè·å¾—æ–°è§†è§’
* ğŸ’¡ **å­¦ä¹ ç¬”è®°**ï¼šçµæ´»è½¬æ¢é—®é¢˜æ¨¡å‹å¯æ‰“å¼€æ–°æ€è·¯

-----

## 5. ç®—æ³•å¯è§†åŒ–ï¼šåƒç´ åŠ¨ç”»æ¼”ç¤º (æ ¸å¿ƒéƒ¨åˆ†)

<visualization_intro>
ä¸‹é¢æ˜¯ä¸ºæœ¬é¢˜è®¾è®¡çš„"åƒç´ ç‹å›½å¹¸ç¦éªŒè¯å™¨"åŠ¨ç”»æ–¹æ¡ˆï¼Œé‡‡ç”¨8-bitå¤å¤é£æ ¼ï¼Œå¸®åŠ©ç›´è§‚ç†è§£ç®—æ³•æµç¨‹ï¼š
</visualization_intro>

* **åŠ¨ç”»ä¸»é¢˜**ï¼šåƒç´ ç‹å›½äº¤é€šç½‘ä¸å¿ƒæƒ…éªŒè¯å¤§å†’é™©

* **æ ¸å¿ƒæ¼”ç¤ºå†…å®¹**ï¼šæ ‘å½¢DFSç»Ÿè®¡ä¸ä¸‰å±‚éªŒè¯è¿‡ç¨‹

* **è®¾è®¡æ€è·¯**ï¼šé‡‡ç”¨FCçº¢ç™½æœºåƒç´ é£æ ¼ï¼Œç”¨é¢œè‰²åŒºåˆ†ç®—æ³•çŠ¶æ€ã€‚æ¸¸æˆåŒ–è¿›åº¦æ¡å’ŒéŸ³æ•ˆå¢å¼ºå­¦ä¹ åŠ¨åŠ›ï¼Œå…³é”®æ“ä½œå¯è§†åŒ–é™ä½ç†è§£é—¨æ§›ã€‚

* **åŠ¨ç”»å¸§æ­¥éª¤**ï¼š
  1. **åœºæ™¯åˆå§‹åŒ–**ï¼ˆåƒç´ ç½‘æ ¼+æ§åˆ¶é¢æ¿ï¼‰
     - æ ‘å½¢ç»“æ„ï¼šèŠ‚ç‚¹ç”¨å½©è‰²åƒç´ æ–¹å—ï¼ˆé¦–éƒ½=é‡‘è‰²ï¼Œå…¶ä»–=è“è‰²ï¼‰
     - æ§åˆ¶é¢æ¿ï¼šå¼€å§‹/æš‚åœ/æ­¥è¿›/é€Ÿåº¦æ»‘å—/é‡ç½®
     - ä¿¡æ¯æ ï¼šæ˜¾ç¤ºå½“å‰èŠ‚ç‚¹ID/æ€»äººæ•°/å¥½å¿ƒæƒ…äººæ•°
     - èƒŒæ™¯ï¼šä½é¥±å’Œåº¦åƒç´ ç½‘æ ¼ï¼Œæ’­æ”¾è½»æ¾8-bitéŸ³ä¹

  2. **äººå£ç»Ÿè®¡é˜¶æ®µ**ï¼ˆè‡ªåº•å‘ä¸ŠDFSï¼‰
     - å¶å­èŠ‚ç‚¹å…ˆäº®èµ·ï¼Œæ˜¾ç¤ºäººå£æ•°`p[i]`ï¼ˆåƒç´ æ•°å­—è·³åŠ¨ï¼‰
     - é€’å½’è¿”å›æ—¶ï¼šçˆ¶èŠ‚ç‚¹æ–¹å—è†¨èƒ€ï¼Œæ˜¾ç¤ºç´¯åŠ å€¼ï¼ˆ`p[çˆ¶] += p[å­]`ï¼‰
     - éŸ³æ•ˆï¼šèŠ‚ç‚¹æ¿€æ´»=æ¸…è„†"å®"å£°ï¼Œæ•°æ®ç´¯åŠ =é½¿è½®è½¬åŠ¨å£°

  3. **å¹¸ç¦éªŒè¯é˜¶æ®µ**ï¼ˆè‡ªé¡¶å‘ä¸‹DFSï¼‰
     - **æ¡ä»¶1éªŒè¯**ï¼šè‹¥`|h_i| > p_i`ï¼ŒèŠ‚ç‚¹é—ªçƒçº¢è‰²+è­¦æŠ¥éŸ³
     - **æ¡ä»¶2éªŒè¯**ï¼šå¥‡å¶æ£€æŸ¥å¤±è´¥æ—¶ï¼ŒèŠ‚ç‚¹äº¤æ›¿é»„è“é—ªçƒ+é”™è¯¯éŸ³
     - **æ¡ä»¶3éªŒè¯**ï¼š
       - å½“å‰èŠ‚ç‚¹ï¼šé¡¶éƒ¨ç»¿è‰²æ¡=å¥½å¿ƒæƒ…äººæ•°
       - å­èŠ‚ç‚¹ï¼šæ˜¾ç¤ºç»¿è‰²æ¡å¹¶è¿çº¿æ±‡æ€»
       - è¿åæ—¶ï¼šç»¿è‰²æ¡æ–­è£‚+ç¢è£‚åŠ¨ç”»éŸ³æ•ˆ

  4. **æ¸¸æˆåŒ–è¿›åº¦ä¸åé¦ˆ**
     - æˆåŠŸé€šè¿‡èŠ‚ç‚¹ï¼šåƒç´ çƒŸèŠ±+é‡‘å¸éŸ³æ•ˆï¼Œè¿›åº¦æ¡å¢é•¿
     - å®Œå…¨é€šè¿‡ï¼šå…¨å±å½©è™¹åŠ¨ç”»+èƒœåˆ©éŸ³ä¹
     - å¤±è´¥ï¼šå±å¹•æŠ–åŠ¨ï¼Œæ˜¾ç¤º"Game Over"åƒç´ å­—ä½“

  5. **AIæ¼”ç¤ºæ¨¡å¼**ï¼ˆè‡ªåŠ¨æ’­æ”¾ï¼‰
     - åƒ"åƒè±†äºº"AIè‡ªåŠ¨éå†æ ‘ç»“æ„
     - å¯è°ƒé€Ÿè§‚å¯Ÿç»†èŠ‚ï¼ˆ0.5x-4xé€Ÿåº¦ï¼‰
     - æš‚åœæ—¶æ˜¾ç¤ºå½“å‰æ­¥éª¤çš„ä¼ªä»£ç å’Œå˜é‡å€¼

* **äº¤äº’æ§åˆ¶**ï¼š
  - æ­¥è¿›æ¨¡å¼ï¼šæŒ‰ä¸€æ¬¡é”®å‰è¿›ä¸€ä¸ªç®—æ³•æ­¥éª¤
  - é€Ÿåº¦æ»‘å—ï¼šå®æ—¶è°ƒæ•´åŠ¨ç”»é€Ÿåº¦
  - æ¨¡å¼åˆ‡æ¢ï¼šæ‰‹åŠ¨/AIæ¼”ç¤º/å¯¹æ¯”æ¨¡å¼ï¼ˆå¹¶æ’ä¸åŒè§£æ³•ï¼‰

* **éŸ³æ•ˆè®¾è®¡**ï¼š
  - å…³é”®æ“ä½œï¼šé€‰æ‹©èŠ‚ç‚¹ï¼ˆæ°´æ»´å£°ï¼‰ï¼ŒéªŒè¯é€šè¿‡ï¼ˆä¸Šå‡éŸ³é˜¶ï¼‰
  - é”™è¯¯æç¤ºï¼šçŸ­ä¿ƒ"å“”"å£°
  - èƒŒæ™¯éŸ³ä¹ï¼šè½»å¿«8-bitå¾ªç¯æ—‹å¾‹

<visualization_conclusion>
è¿™ä¸ªåƒç´ åŠ¨ç”»æ–¹æ¡ˆå°†æŠ½è±¡ç®—æ³•è½¬åŒ–ä¸ºå¯äº¤äº’çš„æ¸¸æˆä½“éªŒï¼Œé€šè¿‡è§†è§‰åé¦ˆå’ŒéŸ³æ•ˆå¼ºåŒ–å¯¹æ ‘å½¢ç»Ÿè®¡å’Œæ¡ä»¶éªŒè¯çš„ç†è§£ã€‚
</visualization_conclusion>

-----

## 6. æ‹“å±•ç»ƒä¹ ä¸ç›¸ä¼¼é—®é¢˜æ€è€ƒ

<similar_problems_intro>
æŒæ¡æœ¬é¢˜æŠ€å·§åï¼Œå¯å°è¯•ä»¥ä¸‹ç›¸ä¼¼é—®é¢˜ï¼š
</similar_problems_intro>

* **é€šç”¨æŠ€å·§è¿ç§»**ï¼š
  æ ‘å½¢ç»Ÿè®¡å’ŒçŠ¶æ€éªŒè¯æŠ€å·§é€‚ç”¨äºï¼š
  1. æ ‘å½¢è·¯å¾„ç»Ÿè®¡ï¼ˆå¦‚èŠ‚ç‚¹è¦†ç›–é—®é¢˜ï¼‰
  2. çˆ¶å­çŠ¶æ€çº¦æŸé—®é¢˜ï¼ˆå¦‚èµ„æºåˆ†é…ï¼‰
  3. æ ‘å½¢åŠ¨æ€è§„åˆ’ä¼˜åŒ–

* **ç»ƒä¹ æ¨è (æ´›è°·)**ï¼š
  1. **æ´›è°· P1352** - æ²¡æœ‰ä¸Šå¸çš„èˆä¼š
     * ğŸ—£ï¸ **æ¨èç†ç”±**ï¼šåŸºç¡€æ ‘å½¢DPï¼Œç»ƒä¹ çˆ¶å­çŠ¶æ€è½¬ç§»ï¼ˆç±»ä¼¼å¿ƒæƒ…ä¼ é€’çº¦æŸï¼‰
  
  2. **æ´›è°· P2014** - é€‰è¯¾
     * ğŸ—£ï¸ **æ¨èç†ç”±**ï¼šæ ‘å½¢ä¾èµ–èƒŒåŒ…é—®é¢˜ï¼Œå¼ºåŒ–DFSç»Ÿè®¡å’Œèµ„æºåˆ†é…æŠ€å·§
  
  3. **æ´›è°· P1273** - æœ‰çº¿ç”µè§†ç½‘
     * ğŸ—£ï¸ **æ¨èç†ç”±**ï¼šæ ‘å½¢ç»Ÿè®¡+æˆæœ¬éªŒè¯ï¼Œä¸æœ¬é¢˜äººå£ç»Ÿè®¡é«˜åº¦ç›¸ä¼¼

-----

## 7. å­¦ä¹ å¿ƒå¾—ä¸ç»éªŒåˆ†äº« (è‹¥æœ‰)

<insights_intro>
é¢˜è§£ä¸­çš„è°ƒè¯•ç»éªŒå€¼å¾—å€Ÿé‰´ï¼š
</insights_intro>

> **å‚è€ƒç»éªŒ (æ¥è‡ª fls233666)**ï¼š
> "åœ¨è§£å†³è¿™ä¸ªé—®é¢˜æ—¶ï¼Œæœ€åˆåœ¨è¾¹ç•Œæ¡ä»¶å¤„ç†ä¸Šå¡äº†å¾ˆä¹…ï¼Œåæ¥é€šè¿‡æ„é€ æç«¯æµ‹è¯•ç”¨ä¾‹ï¼ˆå¦‚å•èŠ‚ç‚¹ã€å…¨åå¿ƒæƒ…æƒ…å†µï¼‰æ‰å®šä½åˆ°é—®é¢˜"
>
> **ç‚¹è¯„**ï¼šè¿™æé†’æˆ‘ä»¬ï¼š
> 1. æ ‘å½¢é—®é¢˜ä¸­ï¼Œå•èŠ‚ç‚¹å’Œé“¾çŠ¶ç»“æ„æ˜¯é‡è¦è¾¹ç•Œç”¨ä¾‹
> 2. æç«¯æ•°æ®æµ‹è¯•ï¼ˆå¦‚æœ€å¤§è§„æ¨¡ã€å…¨è´Ÿå€¼ï¼‰èƒ½æš´éœ²éšè—bug
> 3. åˆ†æ­¥éªŒè¯æ¯”æ•´ä½“è°ƒè¯•æ›´é«˜æ•ˆ

<conclusion>
æœ¬æ¬¡"Uncle Bogdan and Country Happiness"çš„è§£æå°±åˆ°è¿™é‡Œã€‚è®°ä½æ ¸å¿ƒæŠ€å·§ï¼šæ ‘å½¢ç»Ÿè®¡DFS + ä¸‰å±‚æ¡ä»¶éªŒè¯ã€‚å¤šç»ƒä¹ æ ‘å½¢é—®é¢˜ï¼Œä¸‹æ¬¡é‡åˆ°ç±»ä¼¼æŒ‘æˆ˜æ—¶ï¼Œä½ ä¸€å®šèƒ½åƒåƒç´ å‹‡å£«ä¸€æ ·é¡ºåˆ©é€šå…³ï¼ğŸ’ª
</conclusion>

-----

---
å¤„ç†ç”¨æ—¶ï¼š269.44ç§’
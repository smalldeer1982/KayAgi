# é¢˜ç›®ä¿¡æ¯

# Vasya and Types

## é¢˜ç›®æè¿°

Programmer Vasya is studying a new programming language &K\*. The &K\* language resembles the languages of the C family in its syntax. However, it is more powerful, which is why the rules of the actual C-like languages are unapplicable to it. To fully understand the statement, please read the language's description below carefully and follow it and not the similar rules in real programming languages.

There is a very powerful system of pointers on &K\* â€” you can add an asterisk to the right of the existing type $ X $ â€” that will result in new type $ X* $ . That is called pointer-definition operation. Also, there is the operation that does the opposite â€” to any type of $ X $ , which is a pointer, you can add an ampersand â€” that will result in a type $ &amp;X $ , to which refers $ X $ . That is called a dereference operation.

The &K\* language has only two basic data types â€” void and errtype. Also, the language has operators typedef and typeof.

- The operator "typedef $ A $ $ B $ " defines a new data type $ B $ , which is equivalent to $ A $ . $ A $ can have asterisks and ampersands, and $ B $ cannot have them. For example, the operator typedef void\*\* ptptvoid will create a new type ptptvoid, that can be used as void\*\*.
- The operator "typeof $ A $ " returns type of $ A $ , brought to void, that is, returns the type void\*\*...\*, equivalent to it with the necessary number of asterisks (the number can possibly be zero). That is, having defined the ptptvoid type, as shown above, the typeof ptptvoid operator will return void\*\*.

An attempt of dereferencing of the void type will lead to an error: to a special data type errtype. For errtype the following equation holds true: errtype\* $ = $ &errtype $ = $ errtype. An attempt to use the data type that hasn't been defined before that will also lead to the errtype.

Using typedef, we can define one type several times. Of all the definitions only the last one is valid. However, all the types that have been defined earlier using this type do not change.

Let us also note that the dereference operation has the lower priority that the pointer operation, in other words $ &amp;T* $ is always equal to $ T $ .

Note, that the operators are executed consecutively one by one. If we have two operators "typedef &void a" and "typedef a\* b", then at first a becomes errtype, and after that b becomes errtype\* = errtype, but not &void\* = void (see sample 2).

Vasya does not yet fully understand this powerful technology, that's why he asked you to help him. Write a program that analyzes these operators.

## è¯´æ˜/æç¤º

Let's look at the second sample.

After the first two queries typedef the b type is equivalent to void\*, and Ñ â€” to void\*\*.

The next query typedef redefines b â€” it is now equal to &b = &void\* = void. At that, the Ñ type doesn't change.

After that the Ñ type is defined as &&b\* = &&void\* = &void = errtype. It doesn't influence the b type, that's why the next typedef defines c as &void\* = void.

Then the b type is again redefined as &void = errtype.

Please note that the c type in the next query is defined exactly as errtype\*\*\*\*\*\*\* = errtype, and not &void\*\*\*\*\*\*\* = void\*\*\*\*\*\*. The same happens in the last typedef.

## æ ·ä¾‹ #1

### è¾“å…¥

```
5
typedef void* ptv
typeof ptv
typedef &&ptv node
typeof node
typeof &ptv
```

### è¾“å‡º

```
void*
errtype
void
```

## æ ·ä¾‹ #2

### è¾“å…¥

```
17
typedef void* b
typedef b* c
typeof b
typeof c
typedef &b b
typeof b
typeof c
typedef &&b* c
typeof c
typedef &b* c
typeof c
typedef &void b
typeof b
typedef b******* c
typeof c
typedef &&b* c
typeof c
```

### è¾“å‡º

```
void*
void**
void
void**
errtype
void
errtype
errtype
errtype
```

# AIåˆ†æç»“æœ

---
# ğŸ’¡ Kayçš„C++ç®—æ³•è§£æï¼šVasya and Types æ·±å…¥å­¦ä¹ æŒ‡å— ğŸ’¡

<introduction>
  ä»Šå¤©æˆ‘ä»¬æ¥åˆ†æã€ŒVasya and Typesã€è¿™é“C++æ¨¡æ‹Ÿé¢˜ã€‚å®ƒçš„æ ¸å¿ƒæ˜¯æ¨¡æ‹Ÿä¸€ç§è‡ªå®šä¹‰ç¼–ç¨‹è¯­è¨€çš„ç±»å‹ç³»ç»Ÿâ€”â€”ä½ éœ€è¦å¤„ç†`typedef`ï¼ˆå®šä¹‰ç±»å‹åˆ«åï¼‰å’Œ`typeof`ï¼ˆæŸ¥è¯¢ç±»å‹ï¼‰æ“ä½œï¼Œç†è§£æŒ‡é’ˆï¼ˆ`*`ï¼‰å’Œè§£å¼•ç”¨ï¼ˆ`&`ï¼‰çš„è®¡ç®—è§„åˆ™ï¼Œè¿˜è¦å¤„ç†é”™è¯¯ç±»å‹`errtype`çš„ä¼ æ’­ã€‚è¿™é“é¢˜èƒ½å¸®ä½ é”»ç‚¼**å­—ç¬¦ä¸²å¤„ç†**å’Œ**çŠ¶æ€æ¨¡æ‹Ÿ**çš„èƒ½åŠ›ï¼Œä¸€èµ·å¼€å§‹å§ï¼
</introduction>

## 1. é¢˜ç›®è§£è¯»ä¸æ ¸å¿ƒç®—æ³•è¯†åˆ«

âœ¨ **æœ¬é¢˜ä¸»è¦è€ƒå¯Ÿ**ï¼šæ¨¡æ‹Ÿåº”ç”¨ï¼ˆå­—ç¬¦ä¸²å¤„ç† + çŠ¶æ€æ˜ å°„ï¼‰

ğŸ—£ï¸ **åˆæ­¥åˆ†æ**ï¼š
> è§£å†³è¿™é“é¢˜çš„å…³é”®æ˜¯**ç”¨æ¨¡æ‹Ÿæ€ç»´è¿˜åŸç±»å‹ç³»ç»Ÿçš„è§„åˆ™**â€”â€”å°±åƒç©â€œç±»å‹ç§¯æœ¨æ¸¸æˆâ€ï¼šæ¯ä¸ªç±»å‹å¯ä»¥çœ‹ä½œâ€œåŸºç¡€å—ï¼ˆvoid/errtypeï¼‰â€åŠ ä¸Šè‹¥å¹²â€œæŒ‡é’ˆå—ï¼ˆ*ï¼‰â€ï¼Œè€Œ`&`æ˜¯â€œæ‹†æŒ‡é’ˆå—â€ï¼Œ`*`æ˜¯â€œåŠ æŒ‡é’ˆå—â€ã€‚å¦‚æœæ‹†å¾—å¤ªå¤šï¼ˆ`&`æ¯”`*`å¤šï¼‰ï¼Œç§¯æœ¨å°±ä¼šâ€œç¢æ‰â€å˜æˆ`errtype`ï¼›å¦‚æœç”¨äº†æ²¡å®šä¹‰çš„ç§¯æœ¨ï¼Œä¹Ÿä¼šç¢æ‰ã€‚
   - **æ ¸å¿ƒæ€è·¯**ï¼šç”¨`map`è®°å½•æ¯ä¸ªç±»å‹çš„â€œæŒ‡é’ˆå±‚æ•°â€ï¼ˆ`void`æ˜¯0å±‚ï¼Œ`errtype`æ˜¯-1å±‚ï¼‰ã€‚å¯¹äºæ¯ä¸ªæ“ä½œï¼š
     - `typedef A B`ï¼šè®¡ç®—Açš„æœ€ç»ˆæŒ‡é’ˆå±‚æ•°ï¼ŒæŠŠBæ˜ å°„åˆ°è¿™ä¸ªå±‚æ•°ï¼ˆå¦‚æœå±‚æ•°<0åˆ™è®¾ä¸º-1ï¼‰ã€‚
     - `typeof A`ï¼šè®¡ç®—Açš„æœ€ç»ˆæŒ‡é’ˆå±‚æ•°ï¼Œè¾“å‡º`void`åŠ å¯¹åº”æ•°é‡çš„`*`ï¼ˆå±‚æ•°<0åˆ™è¾“å‡º`errtype`ï¼‰ã€‚
   - **æ ¸å¿ƒéš¾ç‚¹**ï¼šâ‘  å¦‚ä½•æ­£ç¡®è®¡ç®—`A`ä¸­çš„`&`å’Œ`*`æ•°é‡å·®ï¼›â‘¡ å¦‚ä½•å¤„ç†`errtype`çš„ä¼ æ’­ï¼ˆä¸€æ—¦å˜æˆ`errtype`ï¼Œæ‰€æœ‰æ“ä½œéƒ½æ— æ•ˆï¼‰ï¼›â‘¢ å¦‚ä½•é«˜æ•ˆæ˜ å°„ç±»å‹ä¸æŒ‡é’ˆå±‚æ•°ã€‚
   - **å¯è§†åŒ–è®¾è®¡æ€è·¯**ï¼šç”¨åƒç´ å—æ¨¡æ‹Ÿç±»å‹å˜åŒ–â€”â€”æ¯”å¦‚`void`æ˜¯è“è‰²å°æ–¹å—ï¼Œ`*`æ˜¯é»„è‰²å³ç®­å¤´ï¼Œ`&`æ˜¯çº¢è‰²å·¦ç®­å¤´ï¼Œ`errtype`æ˜¯ç ´ç¢çš„çº¢è‰²æ–¹å—ã€‚å½“å¤„ç†`typedef void* ptv`æ—¶ï¼Œè“è‰²æ–¹å—å³è¾¹åŠ ä¸€ä¸ªé»„è‰²ç®­å¤´ï¼›å¤„ç†`typeof &&ptv`æ—¶ï¼Œä¸¤ä¸ªçº¢è‰²ç®­å¤´â€œæ‹†â€æ‰ä¸¤ä¸ªé»„è‰²ç®­å¤´ï¼Œå‰©ä¸‹è´Ÿæ•°å±‚ï¼Œå˜æˆç ´ç¢æ–¹å—ã€‚
   - **æ¸¸æˆåŒ–å…ƒç´ **ï¼šè®¾è®¡â€œç±»å‹å·¥åŠâ€åœºæ™¯ï¼Œç”¨æˆ·ç‚¹å‡»â€œæ‰§è¡Œæ“ä½œâ€æ—¶ï¼Œåƒç´ å°äººä¼šç§»åŠ¨ç®­å¤´åˆ°å¯¹åº”æ–¹å—ï¼ŒæˆåŠŸåˆ™æ’­æ”¾â€œå®â€çš„éŸ³æ•ˆï¼Œå¤±è´¥åˆ™æ’­æ”¾â€œ buzzâ€ï¼Œå¢åŠ äº’åŠ¨æ„Ÿã€‚


---

## 2. ç²¾é€‰ä¼˜è´¨é¢˜è§£å‚è€ƒ

<eval_intro>
æˆ‘ä»æ€è·¯æ¸…æ™°åº¦ã€ä»£ç å¯è¯»æ€§å’Œå®è·µä»·å€¼å‡ºå‘ï¼Œç­›é€‰å‡º**Empty_Dream**çš„é¢˜è§£ï¼ˆè¯„åˆ†4.8æ˜Ÿï¼‰â€”â€”å®ƒç”¨æœ€ç®€æ´çš„é€»è¾‘è¦†ç›–äº†æ‰€æœ‰è§„åˆ™ï¼Œä»£ç è§„èŒƒæ˜“è¯»ï¼Œæ˜¯æ¨¡æ‹Ÿé¢˜çš„å…¸èŒƒã€‚
</eval_intro>

**é¢˜è§£ä¸€ï¼šæ¥æºï¼šEmpty_Dream**
* **ç‚¹è¯„**ï¼šè¿™ä»½é¢˜è§£çš„æ€è·¯åƒâ€œæ•°å­¦å…¬å¼â€ä¸€æ ·æ¸…æ™°â€”â€”ç”¨`map<string, int>`ç›´æ¥æ˜ å°„ç±»å‹åˆ°æŒ‡é’ˆå±‚æ•°ï¼ˆ`errtype`è®°ä¸º-1ï¼‰ï¼Œç”¨`type`å‡½æ•°ç»Ÿä¸€è®¡ç®—ä»»æ„ç±»å‹å­—ç¬¦ä¸²çš„æœ€ç»ˆå±‚æ•°ã€‚å®ƒçš„äº®ç‚¹åœ¨äºï¼š
  1. **çŠ¶æ€æŠ½è±¡**ï¼šæŠŠå¤æ‚çš„ç±»å‹æ“ä½œç®€åŒ–ä¸ºâ€œæŒ‡é’ˆå±‚æ•°çš„åŠ å‡æ³•â€ï¼Œæ¯”å¦‚`&`æ˜¯å‡1ï¼Œ`*`æ˜¯åŠ 1ï¼Œå®Œç¾è´´åˆé¢˜ç›®è§„åˆ™ã€‚
  2. **ä»£ç æ¨¡å—åŒ–**ï¼šæŠŠ`typedef`å’Œ`typeof`çš„é€»è¾‘æ‹†æˆ`run_typedef`å’Œ`run_typeof`å‡½æ•°ï¼Œç»“æ„æ¸…æ™°ï¼Œå¤ç”¨æ€§é«˜ã€‚
  3. **è¾¹ç•Œå¤„ç†ä¸¥è°¨**ï¼šæ¯”å¦‚æœªå®šä¹‰çš„ç±»å‹ç›´æ¥è¿”å›-1ï¼ˆ`errtype`ï¼‰ï¼Œå±‚æ•°<0æ—¶å¼ºåˆ¶è®¾ä¸º-1ï¼Œå®Œå…¨ç¬¦åˆé¢˜ç›®å¯¹`errtype`çš„å®šä¹‰ã€‚
  4. **ä»£ç ç®€æ´**ï¼šæ²¡æœ‰å†—ä½™å˜é‡ï¼Œæ¯”å¦‚ç”¨`mp["void"] = 0`å’Œ`mp["errtype"] = -1`åˆå§‹åŒ–åŸºç¡€ç±»å‹ï¼Œç›´æ¥å¯¹åº”è§„åˆ™ã€‚


---

## 3. æ ¸å¿ƒéš¾ç‚¹è¾¨æä¸è§£é¢˜ç­–ç•¥

<difficulty_intro>
æ¨¡æ‹Ÿé¢˜çš„å…³é”®æ˜¯â€œæŠŠè§„åˆ™å˜æˆä»£ç é€»è¾‘â€ã€‚è¿™é“é¢˜çš„æ ¸å¿ƒéš¾ç‚¹é›†ä¸­åœ¨**ç±»å‹çŠ¶æ€çš„è®¡ç®—**å’Œ**é”™è¯¯ä¼ æ’­**ï¼Œæˆ‘ä»¬é€ä¸€æ‹†è§£ï¼š
</difficulty_intro>

1.  **å…³é”®ç‚¹1ï¼šå¦‚ä½•è®¡ç®—ç±»å‹çš„æŒ‡é’ˆå±‚æ•°ï¼Ÿ**
    * **åˆ†æ**ï¼šé¢˜ç›®ä¸­`&`æ˜¯â€œè§£å¼•ç”¨â€ï¼ˆå‡å°‘æŒ‡é’ˆå±‚æ•°ï¼‰ï¼Œ`*`æ˜¯â€œå–æŒ‡é’ˆâ€ï¼ˆå¢åŠ æŒ‡é’ˆå±‚æ•°ï¼‰ï¼Œä¸”`&`åªèƒ½åœ¨ç±»å‹å‰é¢ï¼Œ`*`åªèƒ½åœ¨åé¢ï¼ˆé¢˜ç›®éšå«æ¡ä»¶ï¼‰ã€‚å› æ­¤ï¼Œæˆ‘ä»¬å¯ä»¥ï¼š
      - ç»Ÿè®¡å­—ç¬¦ä¸²å‰çš„`&`æ•°é‡ï¼ˆè®°ä¸º`cnt1`ï¼Œæ¯æœ‰ä¸€ä¸ªå‡1å±‚ï¼‰ï¼›
      - ç»Ÿè®¡å­—ç¬¦ä¸²åçš„`*`æ•°é‡ï¼ˆè®°ä¸º`cnt2`ï¼Œæ¯æœ‰ä¸€ä¸ªåŠ 1å±‚ï¼‰ï¼›
      - å–å‡ºä¸­é—´çš„åŸºç¡€ç±»å‹ï¼ˆæ¯”å¦‚`void*`ä¸­é—´æ˜¯`void`ï¼‰ï¼ŒæŸ¥å®ƒçš„å±‚æ•°`t`ï¼Œæœ€ç»ˆå±‚æ•°æ˜¯`t + cnt2 - cnt1`ã€‚
    * ğŸ’¡ **å­¦ä¹ ç¬”è®°**ï¼šæŠŠå­—ç¬¦ä¸²æ‹†æˆâ€œå‰ç¼€&â€â€œåŸºç¡€ç±»å‹â€â€œåç¼€*â€ä¸‰éƒ¨åˆ†ï¼Œæ˜¯å¤„ç†è¿™ç±»é—®é¢˜çš„é€šç”¨æŠ€å·§ï¼

2.  **å…³é”®ç‚¹2ï¼šå¦‚ä½•å¤„ç†errtypeçš„ä¼ æ’­ï¼Ÿ**
    * **åˆ†æ**ï¼š`errtype`æœ‰ä¸‰ä¸ªè§¦å‘æ¡ä»¶ï¼šâ‘  è§£å¼•ç”¨`void`ï¼ˆå±‚æ•°<0ï¼‰ï¼›â‘¡ ä½¿ç”¨æœªå®šä¹‰çš„ç±»å‹ï¼›â‘¢ åŸºäº`errtype`çš„ä»»ä½•æ“ä½œã€‚å› æ­¤ï¼Œæˆ‘ä»¬åªéœ€ï¼š
      - ç”¨ç‰¹æ®Šå€¼ï¼ˆæ¯”å¦‚-1ï¼‰æ ‡è®°`errtype`ï¼›
      - ä»»ä½•æ¶‰åŠ`errtype`çš„è®¡ç®—ï¼Œç»“æœéƒ½è®¾ä¸º-1ã€‚
    * ğŸ’¡ **å­¦ä¹ ç¬”è®°**ï¼šç”¨â€œå“¨å…µå€¼â€ï¼ˆæ¯”å¦‚-1ï¼‰æ ‡è®°é”™è¯¯çŠ¶æ€ï¼Œèƒ½ç®€åŒ–æ¡ä»¶åˆ¤æ–­ï¼

3.  **å…³é”®ç‚¹3ï¼šå¦‚ä½•é«˜æ•ˆæ˜ å°„ç±»å‹ä¸çŠ¶æ€ï¼Ÿ**
    * **åˆ†æ**ï¼š`typedef`ä¼šå®šä¹‰ç±»å‹åˆ«åï¼Œä¸”åé¢çš„å®šä¹‰ä¼šè¦†ç›–å‰é¢çš„ã€‚å› æ­¤ï¼Œç”¨`map<string, int>`ï¼ˆé”®æ˜¯ç±»å‹åï¼Œå€¼æ˜¯æŒ‡é’ˆå±‚æ•°ï¼‰æ­£å¥½æ»¡è¶³éœ€æ±‚â€”â€”`map`çš„é”®å”¯ä¸€ï¼Œä¿®æ”¹æ—¶ç›´æ¥è¦†ç›–æ—§å€¼ã€‚
    * ğŸ’¡ **å­¦ä¹ ç¬”è®°**ï¼š`map`æ˜¯å¤„ç†â€œé”®å€¼å¯¹æ˜ å°„â€é—®é¢˜çš„ç¥å™¨ï¼Œå°¤å…¶é€‚åˆåŠ¨æ€å®šä¹‰çš„åœºæ™¯ï¼

### âœ¨ è§£é¢˜æŠ€å·§æ€»ç»“
<summary_best_practices>
æ¨¡æ‹Ÿé¢˜çš„â€œé€šå…³ç§˜è¯€â€æ˜¯ï¼š
</summary_best_practices>
- **è§„åˆ™æ‹†è§£**ï¼šæŠŠé¢˜ç›®ä¸­çš„è‡ªç„¶è¯­è¨€è§„åˆ™è½¬åŒ–ä¸ºâ€œæ•°å­¦è¿ç®—â€æˆ–â€œæ¡ä»¶åˆ¤æ–­â€ï¼ˆæ¯”å¦‚æŠŠ`&`å’Œ`*`å˜æˆåŠ å‡ï¼‰ã€‚
- **çŠ¶æ€æŠ½è±¡**ï¼šç”¨ç®€å•çš„æ•°æ®ç»“æ„ï¼ˆæ¯”å¦‚`map`ã€`int`ï¼‰è¡¨ç¤ºå¤æ‚çš„çŠ¶æ€ï¼ˆæ¯”å¦‚ç±»å‹çš„æŒ‡é’ˆå±‚æ•°ï¼‰ã€‚
- **æ¨¡å—åŒ–ç¼–ç¨‹**ï¼šæŠŠä¸åŒæ“ä½œï¼ˆæ¯”å¦‚`typedef`å’Œ`typeof`ï¼‰æ‹†æˆå‡½æ•°ï¼Œé™ä½ä»£ç å¤æ‚åº¦ã€‚
- **è¾¹ç•Œæµ‹è¯•**ï¼šç”¨æ ·ä¾‹éªŒè¯è¾¹ç•Œæƒ…å†µï¼ˆæ¯”å¦‚`typeof &void`åº”è¯¥è¿”å›`errtype`ï¼‰ï¼Œç¡®ä¿é€»è¾‘æ­£ç¡®ã€‚


---

## 4. C++æ ¸å¿ƒä»£ç å®ç°èµæ

<code_intro_overall>
é¦–å…ˆçœ‹**é€šç”¨æ ¸å¿ƒå®ç°**â€”â€”å®ƒæ¥è‡ªEmpty_Dreamçš„é¢˜è§£ï¼Œé€»è¾‘æ¸…æ™°ï¼Œè¦†ç›–æ‰€æœ‰è§„åˆ™ï¼Œæ˜¯æ¨¡æ‹Ÿé¢˜çš„â€œæ ‡å‡†æ¨¡æ¿â€ã€‚
</code_intro_overall>

**æœ¬é¢˜é€šç”¨æ ¸å¿ƒC++å®ç°å‚è€ƒ**
* **è¯´æ˜**ï¼šæœ¬ä»£ç æ˜¯Empty_Dreamé¢˜è§£çš„å®Œæ•´å®ç°ï¼Œç”¨`map`è®°å½•ç±»å‹çŠ¶æ€ï¼Œ`type`å‡½æ•°è®¡ç®—æŒ‡é’ˆå±‚æ•°ï¼Œå®Œç¾è´´åˆé¢˜ç›®è§„åˆ™ã€‚
* **å®Œæ•´æ ¸å¿ƒä»£ç **ï¼š
    ```cpp
    #include<bits/stdc++.h>
    using namespace std;

    int n;
    string act;
    map<string, int> mp; // ç±»å‹å -> æŒ‡é’ˆå±‚æ•°ï¼ˆerrtypeä¸º-1ï¼‰

    // è®¡ç®—ç±»å‹å­—ç¬¦ä¸²sçš„æœ€ç»ˆæŒ‡é’ˆå±‚æ•°
    int type(string s) {
        int cnt1 = 0, cnt2 = 0;
        // ç»Ÿè®¡å‰é¢çš„&æ•°é‡ï¼ˆè§£å¼•ç”¨ï¼Œå‡å±‚æ•°ï¼‰
        while (!s.empty() && s[0] == '&') {
            cnt1++;
            s.erase(s.begin());
        }
        // ç»Ÿè®¡åé¢çš„*æ•°é‡ï¼ˆå–æŒ‡é’ˆï¼ŒåŠ å±‚æ•°ï¼‰
        while (!s.empty() && s.back() == '*') {
            cnt2++;
            s.pop_back();
        }
        // åŸºç¡€ç±»å‹æœªå®šä¹‰æˆ–ä¸ºerrtype
        if (mp.find(s) == mp.end() || mp[s] == -1) {
            return -1;
        }
        int t = mp[s] + cnt2 - cnt1;
        return t < 0 ? -1 : t; // å±‚æ•°<0åˆ™ä¸ºerrtype
    }

    // å¤„ç†typedefæ“ä½œï¼štypedef A B
    void run_typedef() {
        string A, B;
        cin >> A >> B;
        mp[B] = type(A); // Bæ˜ å°„åˆ°Açš„æœ€ç»ˆå±‚æ•°
    }

    // å¤„ç†typeofæ“ä½œï¼štypeof A
    void run_typeof() {
        string A;
        cin >> A;
        int t = type(A);
        if (t == -1) {
            cout << "errtype\n";
        } else {
            cout << "void";
            for (int i = 0; i < t; i++) cout << "*";
            cout << "\n";
        }
    }

    int main() {
        // åˆå§‹åŒ–åŸºç¡€ç±»å‹ï¼švoidæ˜¯0å±‚ï¼Œerrtypeæ˜¯-1å±‚
        mp["void"] = 0;
        mp["errtype"] = -1;
        cin >> n;
        for (int i = 0; i < n; i++) {
            cin >> act;
            if (act == "typedef") run_typedef();
            else if (act == "typeof") run_typeof();
        }
        return 0;
    }
    ```
* **ä»£ç è§£è¯»æ¦‚è¦**ï¼š
    > ä»£ç åˆ†ä¸ºä¸‰éƒ¨åˆ†ï¼šâ‘  `type`å‡½æ•°è®¡ç®—ç±»å‹çš„æŒ‡é’ˆå±‚æ•°ï¼›â‘¡ `run_typedef`å’Œ`run_typeof`å¤„ç†ä¸¤ç§æ“ä½œï¼›â‘¢ `main`å‡½æ•°åˆå§‹åŒ–åŸºç¡€ç±»å‹å¹¶å¾ªç¯å¤„ç†è¾“å…¥ã€‚æ ¸å¿ƒé€»è¾‘æ˜¯**ç”¨`map`ç»´æŠ¤ç±»å‹çš„æŒ‡é’ˆå±‚æ•°**ï¼Œé€šè¿‡`type`å‡½æ•°ç»Ÿä¸€è®¡ç®—æ‰€æœ‰ç±»å‹çš„æœ€ç»ˆçŠ¶æ€ã€‚


---
<code_intro_selected>
æ¥ä¸‹æ¥å‰–æEmpty_Dreamé¢˜è§£çš„**æ ¸å¿ƒç‰‡æ®µ**ï¼Œçœ‹å®ƒå¦‚ä½•æŠŠè§„åˆ™å˜æˆä»£ç ï¼š
</code_intro_selected>

**é¢˜è§£ä¸€ï¼šæ¥æºï¼šEmpty_Dream**
* **äº®ç‚¹**ï¼šç”¨`type`å‡½æ•°ç»Ÿä¸€å¤„ç†æ‰€æœ‰ç±»å‹è®¡ç®—ï¼Œé¿å…é‡å¤ä»£ç ï¼Œé€»è¾‘å¤ç”¨ç‡é«˜ã€‚
* **æ ¸å¿ƒä»£ç ç‰‡æ®µ**ï¼š
    ```cpp
    int type(string s) {
        int cnt1 = 0, cnt2 = 0;
        while (!s.empty() && s[0] == '&') { cnt1++; s.erase(s.begin()); }
        while (!s.empty() && s.back() == '*') { cnt2++; s.pop_back(); }
        if (mp.find(s) == mp.end() || mp[s] == -1) return -1;
        int t = mp[s] + cnt2 - cnt1;
        return t < 0 ? -1 : t;
    }
    ```
* **ä»£ç è§£è¯»**ï¼š
    > è¿™æ®µä»£ç æ˜¯æ•´ä¸ªé¢˜è§£çš„â€œå¿ƒè„â€ï¼š
    1. **ç»Ÿè®¡&å’Œ***ï¼šç”¨`while`å¾ªç¯åˆ å»å­—ç¬¦ä¸²å‰çš„`&`ï¼ˆç»Ÿè®¡`cnt1`ï¼‰å’Œåçš„`*`ï¼ˆç»Ÿè®¡`cnt2`ï¼‰ï¼Œå‰©ä¸‹çš„å°±æ˜¯åŸºç¡€ç±»å‹ï¼ˆæ¯”å¦‚`&void*`å‰©ä¸‹`void`ï¼‰ã€‚
    2. **æ£€æŸ¥åŸºç¡€ç±»å‹**ï¼šå¦‚æœåŸºç¡€ç±»å‹æ²¡å®šä¹‰ï¼ˆ`mp.find(s) == mp.end()`ï¼‰æˆ–æœ¬èº«æ˜¯`errtype`ï¼ˆ`mp[s] == -1`ï¼‰ï¼Œç›´æ¥è¿”å›-1ã€‚
    3. **è®¡ç®—æœ€ç»ˆå±‚æ•°**ï¼šåŸºç¡€ç±»å‹çš„å±‚æ•°åŠ ä¸Š`cnt2 - cnt1`ï¼ˆ`*`åŠ å±‚æ•°ï¼Œ`&`å‡å±‚æ•°ï¼‰ï¼Œå¦‚æœç»“æœ<0ï¼Œè¿”å›-1ï¼ˆ`errtype`ï¼‰ï¼Œå¦åˆ™è¿”å›å±‚æ•°ã€‚
    > æ¯”å¦‚è®¡ç®—`typeof &&ptv`ï¼šå‡è®¾`ptv`æ˜¯`void*`ï¼ˆå±‚æ•°1ï¼‰ï¼Œ`cnt1=2`ï¼ˆä¸¤ä¸ª&ï¼‰ï¼Œ`cnt2=0`ï¼Œæœ€ç»ˆå±‚æ•°æ˜¯1+0-2=-1ï¼Œæ‰€ä»¥è¾“å‡º`errtype`â€”â€”å®Œç¾ç¬¦åˆæ ·ä¾‹1ï¼
* ğŸ’¡ **å­¦ä¹ ç¬”è®°**ï¼šæŠŠé‡å¤çš„è®¡ç®—é€»è¾‘å°è£…æˆå‡½æ•°ï¼Œæ˜¯å†™å¥½æ¨¡æ‹Ÿé¢˜çš„å…³é”®â€”â€”é¿å…â€œå¤åˆ¶ç²˜è´´â€ï¼Œå‡å°‘é”™è¯¯ï¼


---

## 5. ç®—æ³•å¯è§†åŒ–ï¼šåƒç´ åŠ¨ç”»æ¼”ç¤º (æ ¸å¿ƒéƒ¨åˆ†)

<visualization_intro>
ä¸ºäº†æ›´ç›´è§‚åœ°â€œçœ‹â€åˆ°ç±»å‹çš„å˜åŒ–ï¼Œæˆ‘è®¾è®¡äº†ä¸€ä¸ª**åƒç´ é£æ ¼çš„â€œç±»å‹å·¥åŠâ€åŠ¨ç”»**â€”â€”ä½ å¯ä»¥åƒç©FCæ¸¸æˆä¸€æ ·ï¼Œè§è¯`typedef`å’Œ`typeof`å¦‚ä½•æ”¹å˜ç±»å‹ï¼
</visualization_intro>

  * **åŠ¨ç”»æ¼”ç¤ºä¸»é¢˜**ï¼šåƒç´ å°äººåœ¨â€œç±»å‹å·¥åŠâ€é‡Œå¤„ç†`typedef`å’Œ`typeof`æ“ä½œï¼Œç”¨ç§¯æœ¨å—è¡¨ç¤ºç±»å‹ï¼Œç®­å¤´è¡¨ç¤º`&`å’Œ`*`ã€‚
  * **æ ¸å¿ƒæ¼”ç¤ºå†…å®¹**ï¼šæ¨¡æ‹Ÿæ ·ä¾‹1çš„5ä¸ªæ“ä½œï¼Œå±•ç¤º`ptv`ã€`node`çš„ç±»å‹å˜åŒ–ï¼Œä»¥åŠ`typeof`çš„è¾“å‡ºç»“æœã€‚
  * **è®¾è®¡æ€è·¯ç®€è¿°**ï¼šç”¨8ä½åƒç´ é£ï¼ˆFCçº¢ç™½æœºé£æ ¼ï¼‰é™ä½è§†è§‰è´Ÿæ‹…ï¼Œç”¨â€œç§¯æœ¨+ç®­å¤´â€ç›´è§‚è¡¨ç¤ºç±»å‹ç»“æ„ï¼Œç”¨éŸ³æ•ˆå¼ºåŒ–æ“ä½œè®°å¿†â€”â€”æ¯”å¦‚`typedef`æ—¶â€œå®â€ä¸€å£°ï¼Œ`typeof`æ—¶â€œæ»´â€ä¸€å£°ï¼Œ`errtype`æ—¶â€œ buzzâ€ä¸€å£°ï¼Œè®©å­¦ä¹ æ›´æœ‰ä»£å…¥æ„Ÿã€‚


### åŠ¨ç”»å¸§æ­¥éª¤ä¸äº¤äº’å…³é”®ç‚¹
#### 1. åœºæ™¯åˆå§‹åŒ–ï¼ˆ8ä½åƒç´ é£ï¼‰
   * **ç•Œé¢å¸ƒå±€**ï¼š
     - å·¦ä¾§ï¼š`ç±»å‹å·¥åŠ`åœºæ™¯ï¼ˆ20x10åƒç´ ç½‘æ ¼ï¼‰ï¼Œæ˜¾ç¤ºå½“å‰çš„ç±»å‹ç§¯æœ¨ï¼ˆ`void`æ˜¯è“è‰²æ–¹å—ï¼Œ`*`æ˜¯é»„è‰²å³ç®­å¤´ï¼Œ`&`æ˜¯çº¢è‰²å·¦ç®­å¤´ï¼Œ`errtype`æ˜¯ç ´ç¢çš„çº¢è‰²æ–¹å—ï¼‰ã€‚
     - å³ä¾§ï¼š`æ§åˆ¶é¢æ¿`ï¼ˆæŒ‰é’®+æ»‘å—ï¼‰ï¼š`å¼€å§‹/æš‚åœ`ï¼ˆç»¿è‰²æŒ‰é’®ï¼‰ã€`å•æ­¥æ‰§è¡Œ`ï¼ˆé»„è‰²æŒ‰é’®ï¼‰ã€`é‡ç½®`ï¼ˆçº¢è‰²æŒ‰é’®ï¼‰ã€`é€Ÿåº¦æ»‘å—`ï¼ˆ1~5æ¡£ï¼‰ã€‚
     - åº•éƒ¨ï¼š`è¾“å‡ºæ¡†`ï¼ˆæ˜¾ç¤º`typeof`çš„ç»“æœï¼‰ã€‚
   * **èƒŒæ™¯éŸ³ä¹**ï¼šå¾ªç¯æ’­æ”¾8ä½é£æ ¼çš„è½»æ¾æ—‹å¾‹ï¼ˆç±»ä¼¼ã€Šè¶…çº§é©¬é‡Œå¥¥ã€‹çš„èƒŒæ™¯éŸ³ï¼‰ã€‚


#### 2. æ“ä½œæ¼”ç¤ºï¼ˆä»¥æ ·ä¾‹1ä¸ºä¾‹ï¼‰
æ ·ä¾‹1è¾“å…¥ï¼š
```
5
typedef void* ptv
typeof ptv
typedef &&ptv node
typeof node
typeof &ptv
```

**å¸§1ï¼šåˆå§‹åŒ–**
   - å·¥åŠé‡Œæ˜¾ç¤º`void`ï¼ˆè“è‰²æ–¹å—ï¼‰ï¼Œå³ä¾§`map`åˆ—è¡¨æ˜¾ç¤º`void:0`ã€`errtype:-1`ã€‚
   - æ§åˆ¶é¢æ¿æ˜¾ç¤ºâ€œç­‰å¾…æ“ä½œâ€ã€‚

**å¸§2ï¼šå¤„ç†`typedef void* ptv`**
   - åƒç´ å°äººä»å·¦ä¾§æ‹¿å‡º`void`æ–¹å—ï¼ˆè“è‰²ï¼‰ï¼Œå³ä¾§åŠ ä¸€ä¸ªé»„è‰²`*`ç®­å¤´ï¼ˆå˜æˆ`void*`ï¼‰ã€‚
   - å°äººæŠŠ`ptv`æ ‡ç­¾è´´åœ¨ç§¯æœ¨ä¸Šï¼Œå³ä¾§`map`åˆ—è¡¨æ–°å¢`ptv:1`ã€‚
   - æ’­æ”¾â€œå®â€çš„éŸ³æ•ˆã€‚

**å¸§3ï¼šå¤„ç†`typeof ptv`**
   - å°äººæŒ‡å‘`ptv`ç§¯æœ¨ï¼ˆ`void*`ï¼‰ï¼Œåº•éƒ¨è¾“å‡ºæ¡†æ˜¾ç¤º`void*`ã€‚
   - æ’­æ”¾â€œæ»´â€çš„éŸ³æ•ˆã€‚

**å¸§4ï¼šå¤„ç†`typedef &&ptv node`**
   - å°äººæ‹¿å‡º`ptv`ç§¯æœ¨ï¼ˆ`void*`ï¼Œ1å±‚ï¼‰ï¼Œå·¦ä¾§åŠ ä¸¤ä¸ªçº¢è‰²`&`ç®­å¤´ï¼ˆå‡2å±‚ï¼‰ã€‚
   - ç§¯æœ¨å˜æˆç ´ç¢çš„çº¢è‰²æ–¹å—ï¼ˆå±‚æ•°1-2=-1ï¼Œ`errtype`ï¼‰ï¼Œå°äººæŠŠ`node`æ ‡ç­¾è´´ä¸Šå»ï¼Œå³ä¾§`map`åˆ—è¡¨æ–°å¢`node:-1`ã€‚
   - æ’­æ”¾â€œ buzzâ€çš„éŸ³æ•ˆã€‚

**å¸§5ï¼šå¤„ç†`typeof node`**
   - å°äººæŒ‡å‘`node`ç§¯æœ¨ï¼ˆç ´ç¢çº¢è‰²ï¼‰ï¼Œåº•éƒ¨è¾“å‡ºæ¡†æ˜¾ç¤º`errtype`ã€‚
   - æ’­æ”¾â€œ buzzâ€çš„éŸ³æ•ˆã€‚

**å¸§6ï¼šå¤„ç†`typeof &ptv`**
   - å°äººæ‹¿å‡º`ptv`ç§¯æœ¨ï¼ˆ`void*`ï¼Œ1å±‚ï¼‰ï¼Œå·¦ä¾§åŠ ä¸€ä¸ªçº¢è‰²`&`ç®­å¤´ï¼ˆå‡1å±‚ï¼‰ã€‚
   - ç§¯æœ¨å˜æˆ`void`ï¼ˆ1-1=0å±‚ï¼‰ï¼Œåº•éƒ¨è¾“å‡ºæ¡†æ˜¾ç¤º`void`ã€‚
   - æ’­æ”¾â€œæ»´â€çš„éŸ³æ•ˆã€‚


#### 3. äº¤äº’è®¾è®¡
   - **å•æ­¥æ‰§è¡Œ**ï¼šç‚¹å‡»â€œå•æ­¥â€æŒ‰é’®ï¼ŒåŠ¨ç”»æ‰§è¡Œä¸€æ­¥æ“ä½œï¼Œåœåœ¨å½“å‰å¸§ï¼Œæ–¹ä¾¿è§‚å¯Ÿç»†èŠ‚ã€‚
   - **è‡ªåŠ¨æ’­æ”¾**ï¼šæ‹–åŠ¨æ»‘å—è°ƒæ•´é€Ÿåº¦ï¼ˆ1æ¡£æœ€æ…¢ï¼Œ5æ¡£æœ€å¿«ï¼‰ï¼ŒåŠ¨ç”»è‡ªåŠ¨æ‰§è¡Œæ‰€æœ‰æ“ä½œã€‚
   - **é‡ç½®**ï¼šç‚¹å‡»â€œé‡ç½®â€æŒ‰é’®ï¼Œå›åˆ°åˆå§‹çŠ¶æ€ï¼Œé‡æ–°æ¼”ç¤ºã€‚


<visualization_conclusion>
é€šè¿‡è¿™ä¸ªåŠ¨ç”»ï¼Œä½ å¯ä»¥**ç›´è§‚çœ‹åˆ°æ¯ä¸€æ­¥æ“ä½œå¦‚ä½•æ”¹å˜ç±»å‹çš„çŠ¶æ€**â€”â€”æ¯”å¦‚`&`å¦‚ä½•â€œæ‹†â€æŒ‡é’ˆï¼Œ`*`å¦‚ä½•â€œåŠ â€æŒ‡é’ˆï¼Œ`errtype`å¦‚ä½•äº§ç”Ÿã€‚åƒç´ é£æ ¼å’ŒéŸ³æ•ˆè®©å­¦ä¹ ä¸å†æ¯ç‡¥ï¼Œè€Œæ˜¯åƒç©æ¸¸æˆä¸€æ ·æœ‰è¶£ï¼


---

## 6. æ‹“å±•ç»ƒä¹ ä¸ç›¸ä¼¼é—®é¢˜æ€è€ƒ

<similar_problems_intro>
æ¨¡æ‹Ÿé¢˜çš„æ ¸å¿ƒæ˜¯â€œè¿˜åŸè§„åˆ™â€ï¼Œå­¦ä¼šè¿™é“é¢˜çš„æ€è·¯åï¼Œå¯ä»¥è§£å†³å¾ˆå¤šç±»ä¼¼çš„â€œå­—ç¬¦ä¸²+çŠ¶æ€æ˜ å°„â€é—®é¢˜ï¼Œæ¯”å¦‚ï¼š
</similar_problems_intro>

  * **é€šç”¨æ€è·¯è¿ç§»**ï¼š
    - å¤„ç†**é…ç½®æ–‡ä»¶è§£æ**ï¼ˆæ¯”å¦‚è§£æ`key=value`çš„é…ç½®ï¼Œç”¨`map`å­˜å‚¨é”®å€¼å¯¹ï¼‰ï¼›
    - æ¨¡æ‹Ÿ**ç®€å•çš„ç¼–ç¨‹è¯­è¨€è§£é‡Šå™¨**ï¼ˆæ¯”å¦‚å¤„ç†å˜é‡å®šä¹‰å’ŒæŸ¥è¯¢ï¼‰ï¼›
    - ç»Ÿè®¡**å­—ç¬¦ä¸²ä¸­çš„ç‰¹å®šå­—ç¬¦**ï¼ˆæ¯”å¦‚ç»Ÿè®¡æ‹¬å·çš„åŒ¹é…æ•°ï¼‰ã€‚


  * **ç»ƒä¹ æ¨è (æ´›è°·)**ï¼š
    ä»¥ä¸‹é¢˜ç›®éƒ½æ˜¯â€œæ¨¡æ‹Ÿ+å­—ç¬¦ä¸²å¤„ç†â€çš„ç»å…¸é¢˜ï¼Œå¸®ä½ å·©å›ºæ€è·¯ï¼š

    1.  **æ´›è°· P1003** - é“ºåœ°æ¯¯
          * ğŸ—£ï¸ **æ¨èç†ç”±**ï¼šæ¨¡æ‹Ÿåœ°æ¯¯çš„è¦†ç›–è¿‡ç¨‹ï¼Œéœ€è¦å¤„ç†åæ ‡çš„æ˜ å°„ï¼Œé”»ç‚¼â€œçŠ¶æ€æ›´æ–°â€èƒ½åŠ›ã€‚
    2.  **æ´›è°· P1042** - ä¹’ä¹“çƒ
          * ğŸ—£ï¸ **æ¨èç†ç”±**ï¼šæ¨¡æ‹Ÿä¹’ä¹“çƒçš„å¾—åˆ†è§„åˆ™ï¼Œéœ€è¦å¤„ç†å­—ç¬¦ä¸²è¾“å…¥å’ŒçŠ¶æ€åˆ‡æ¢ï¼Œé”»ç‚¼â€œè§„åˆ™æ‹†è§£â€èƒ½åŠ›ã€‚
    3.  **æ´›è°· P1157** - ç»„åˆæ•°è¾“å‡º
          * ğŸ—£ï¸ **æ¨èç†ç”±**ï¼šæ¨¡æ‹Ÿç»„åˆæ•°çš„è®¡ç®—è¿‡ç¨‹ï¼Œéœ€è¦å¤„ç†äºŒç»´æ•°ç»„çš„çŠ¶æ€ï¼Œé”»ç‚¼â€œçŠ¶æ€æŠ½è±¡â€èƒ½åŠ›ã€‚
    4.  **æ´›è°· P1200** - [USACO1.1]ä½ çš„é£ç¢Ÿåœ¨è¿™å„¿ Your Ride Is Here
          * ğŸ—£ï¸ **æ¨èç†ç”±**ï¼šæ¨¡æ‹Ÿå­—ç¬¦ä¸²çš„å“ˆå¸Œè®¡ç®—ï¼Œéœ€è¦å¤„ç†å­—ç¬¦åˆ°æ•°å­—çš„æ˜ å°„ï¼Œé”»ç‚¼â€œå­—ç¬¦ä¸²å¤„ç†â€èƒ½åŠ›ã€‚


---

## 7. å­¦ä¹ å¿ƒå¾—ä¸ç»éªŒåˆ†äº« (è‹¥æœ‰)

<insights_intro>
Empty_Dreamçš„é¢˜è§£æ²¡æœ‰æ˜ç¡®çš„ä¸ªäººå¿ƒå¾—ï¼Œä½†ä»ä»£ç ä¸­å¯ä»¥çœ‹å‡ºä»–çš„â€œæ¨¡æ‹Ÿé¢˜ç»éªŒâ€ï¼š
</insights_intro>

> **éšå½¢ç»éªŒ**ï¼šç”¨`map`å­˜å‚¨çŠ¶æ€ã€ç”¨å‡½æ•°å°è£…é‡å¤é€»è¾‘ã€ç”¨å“¨å…µå€¼æ ‡è®°é”™è¯¯â€”â€”è¿™äº›éƒ½æ˜¯æ¨¡æ‹Ÿé¢˜çš„â€œé€šç”¨æŠ€å·§â€ã€‚æ¯”å¦‚`mp["errtype"] = -1`ç”¨-1æ ‡è®°é”™è¯¯ï¼Œé¿å…äº†å¤æ‚çš„æ¡ä»¶åˆ¤æ–­ï¼›`type`å‡½æ•°å°è£…äº†ç±»å‹è®¡ç®—ï¼Œé¿å…äº†`run_typedef`å’Œ`run_typeof`ä¸­çš„é‡å¤ä»£ç ã€‚
>
> **ç‚¹è¯„**ï¼šè¿™äº›æŠ€å·§çœ‹ä¼¼ç®€å•ï¼Œä½†èƒ½å¤§å¤§é™ä½ä»£ç çš„å¤æ‚åº¦å’Œé”™è¯¯ç‡ã€‚æ¯”å¦‚å¦‚æœä½ ä¸ç”¨`type`å‡½æ•°ï¼Œ`run_typedef`å’Œ`run_typeof`éƒ½è¦å†™ä¸€é`&`å’Œ`*`çš„ç»Ÿè®¡é€»è¾‘ï¼Œå¾ˆå®¹æ˜“å‡ºé”™ï¼


---

<conclusion>
æœ¬æ¬¡å…³äºã€ŒVasya and Typesã€çš„åˆ†æå°±åˆ°è¿™é‡Œã€‚æ¨¡æ‹Ÿé¢˜çš„å…³é”®æ˜¯â€œæŠŠè§„åˆ™å˜æˆä»£ç â€â€”â€”å…ˆæ‹†è§£è§„åˆ™ï¼Œå†æŠ½è±¡çŠ¶æ€ï¼Œæœ€åç”¨ç®€å•çš„æ•°æ®ç»“æ„å®ç°ã€‚è®°ä½ï¼š**å¤æ‚çš„é—®é¢˜ï¼Œå¾€å¾€å¯ä»¥ç”¨ç®€å•çš„é€»è¾‘è§£å†³**ï¼ä¸‹æ¬¡é‡åˆ°æ¨¡æ‹Ÿé¢˜ï¼Œä¸å¦¨å…ˆæƒ³ï¼šâ€œæˆ‘èƒ½ç”¨`map`æˆ–`int`è¡¨ç¤ºçŠ¶æ€å—ï¼Ÿèƒ½æŠŠé‡å¤é€»è¾‘å°è£…æˆå‡½æ•°å—ï¼Ÿâ€ ç¥ä½ ä¸‹æ¬¡è§£é¢˜æ›´é¡ºåˆ©ï¼ğŸ’ª
</conclusion>

---

---
å¤„ç†ç”¨æ—¶ï¼š192.18ç§’
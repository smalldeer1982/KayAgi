# é¢˜ç›®ä¿¡æ¯

# String Mark

## é¢˜ç›®æè¿°

At the Byteland State University marks are strings of the same length. Mark $ x $ is considered better than $ y $ if string $ y $ is lexicographically smaller than $ x $ .

Recently at the BSU was an important test work on which Vasya recived the mark $ a $ . It is very hard for the teacher to remember the exact mark of every student, but he knows the mark $ b $ , such that every student recieved mark strictly smaller than $ b $ .

Vasya isn't satisfied with his mark so he decided to improve it. He can swap characters in the string corresponding to his mark as many times as he like. Now he want to know only the number of different ways to improve his mark so that his teacher didn't notice something suspicious.

More formally: you are given two strings $ a $ , $ b $ of the same length and you need to figure out the number of different strings $ c $ such that:

1\) $ c $ can be obtained from $ a $ by swapping some characters, in other words $ c $ is a permutation of $ a $ .

2\) String $ a $ is lexicographically smaller than $ c $ .

3\) String $ c $ is lexicographically smaller than $ b $ .

For two strings $ x $ and $ y $ of the same length it is true that $ x $ is lexicographically smaller than $ y $ if there exists such $ i $ , that $ x_{1}=y_{1},x_{2}=y_{2},...,x_{i-1}=y_{i-1},x_{i}<y_{i} $ .

Since the answer can be very large, you need to find answer modulo $ 10^{9}+7 $ .

## è¯´æ˜/æç¤º

In first sample from string $ abc $ can be obtained strings $ acb,bac,bca,cab,cba $ , all of them are larger than $ abc $ , but smaller than $ ddd $ . So the answer is $ 5 $ .

In second sample any string obtained from $ abcdef $ is larger than $ abcdeg $ . So the answer is $ 0 $ .

## æ ·ä¾‹ #1

### è¾“å…¥

```
abc
ddd
```

### è¾“å‡º

```
5
```

## æ ·ä¾‹ #2

### è¾“å…¥

```
abcdef
abcdeg
```

### è¾“å‡º

```
0
```

## æ ·ä¾‹ #3

### è¾“å…¥

```
abacaba
ubuduba
```

### è¾“å‡º

```
64
```

# AIåˆ†æç»“æœ

# ğŸ’¡ Kayçš„C++ç®—æ³•è§£æï¼šString Mark æ·±å…¥å­¦ä¹ æŒ‡å— ğŸ’¡


ä»Šå¤©æˆ‘ä»¬æ¥ä¸€èµ·åˆ†æâ€œString Markâ€è¿™é“C++ç¼–ç¨‹é¢˜ã€‚è¿™é“é¢˜ç»“åˆäº†**ç»„åˆæ•°å­¦**å’Œ**å­—å…¸åºæ¯”è¾ƒ**çš„æ ¸å¿ƒæ€æƒ³ï¼Œéœ€è¦æˆ‘ä»¬ç”¨â€œè½¬åŒ–é—®é¢˜â€çš„æ€è·¯ç®€åŒ–å¤æ‚åº¦ã€‚æœ¬æŒ‡å—å°†å¸®ä½ æ¢³ç†æ€è·¯ã€ç†è§£æ ¸å¿ƒç®—æ³•ï¼Œå¹¶æŒæ¡è§£é¢˜æŠ€å·§ï½


## 1. é¢˜ç›®è§£è¯»ä¸æ ¸å¿ƒç®—æ³•è¯†åˆ«

âœ¨ **æœ¬é¢˜ä¸»è¦è€ƒå¯Ÿ**ï¼šç»„åˆæ•°å­¦ï¼ˆæ’åˆ—è®¡æ•°ï¼‰+ å­—å…¸åºå·®åˆ†æ€æƒ³  

ğŸ—£ï¸ **åˆæ­¥åˆ†æ**ï¼š  
é¢˜ç›®è¦æ±‚è®¡ç®—**açš„æ’åˆ—ä¸­æ»¡è¶³a < c < bçš„å­—ç¬¦ä¸²cçš„æ•°é‡**ã€‚ç›´æ¥æšä¸¾æ‰€æœ‰æ’åˆ—æ˜¾ç„¶ä¸ç°å®ï¼ˆå­—ç¬¦ä¸²é•¿åº¦å¯èƒ½å¾ˆå¤§ï¼‰ï¼Œå› æ­¤å…³é”®æ˜¯**å°†åŒè¾¹ç•Œé—®é¢˜è½¬åŒ–ä¸ºä¸¤ä¸ªå•è¾¹ç•Œé—®é¢˜çš„å·®åˆ†**â€”â€”ç­”æ¡ˆç­‰äºâ€œaçš„æ’åˆ—ä¸­å°äºbçš„æ•°é‡â€å‡å»â€œaçš„æ’åˆ—ä¸­å°äºç­‰äºaçš„æ•°é‡â€ï¼ˆå³`f(b) - f(a) - 1`ï¼Œå…¶ä¸­`f(s)`è¡¨ç¤ºaçš„æ’åˆ—ä¸­å°äºsçš„æ•°é‡ï¼‰ã€‚  

### æ ¸å¿ƒç®—æ³•æµç¨‹
`f(s)`çš„è®¡ç®—æ˜¯å…³é”®ï¼š  
1. **é¢„å¤„ç†é˜¶ä¹˜å’Œé€†å…ƒ**ï¼šå› ä¸ºè¦è®¡ç®—æ’åˆ—æ•°ï¼ˆæ¯”å¦‚nä¸ªå­—ç¬¦çš„å…¨æ’åˆ—æ•°æ˜¯n!ï¼‰ï¼Œè€Œæ¨¡è¿ç®—ä¸‹é™¤æ³•éœ€è¦ç”¨é€†å…ƒä»£æ›¿ã€‚  
2. **é€ä¸ªä½ç½®åˆ†æ**ï¼šä»å·¦åˆ°å³å¤„ç†sçš„æ¯ä¸ªå­—ç¬¦ï¼Œè®¡ç®—å½“å‰ä½ç½®é€‰â€œæ¯”s[i]å°çš„å­—ç¬¦â€æ—¶ï¼Œåé¢æ‰€æœ‰å¯èƒ½çš„æ’åˆ—æ•°ä¹‹å’Œã€‚ä¾‹å¦‚ï¼Œå‡è®¾å½“å‰å¤„ç†åˆ°ç¬¬iä½ï¼Œé€‰äº†ä¸€ä¸ªæ¯”s[i]å°çš„å­—ç¬¦xï¼Œé‚£ä¹ˆåé¢n-iä¸ªä½ç½®å¯ä»¥ç”¨å‰©ä¸‹çš„å­—ç¬¦ä»»æ„æ’åˆ—ï¼Œæ•°é‡æ˜¯`(å‰©ä½™å­—ç¬¦çš„å…¨æ’åˆ—æ•°) Ã— (xçš„å‰©ä½™æ•°é‡)`ã€‚  
3. **ç»´æŠ¤å‰©ä½™å­—ç¬¦è®¡æ•°**ï¼šæ¯é€‰ä¸€ä¸ªå­—ç¬¦ï¼Œå°±å‡å°‘å…¶è®¡æ•°ï¼Œç»§ç»­å¤„ç†ä¸‹ä¸€ä½ï¼ˆå¦‚æœå½“å‰å­—ç¬¦æ— æ³•é€‰s[i]ï¼Œåˆ™ç›´æ¥breakï¼Œå› ä¸ºåé¢çš„æ’åˆ—ä¸å¯èƒ½æ›´å°äº†ï¼‰ã€‚  

### å¯è§†åŒ–è®¾è®¡æ€è·¯
æˆ‘ä»¬å¯ä»¥ç”¨**8ä½åƒç´ é£**æ¨¡æ‹Ÿ`f(s)`çš„è®¡ç®—è¿‡ç¨‹ï¼š  
- ç”¨ä¸åŒé¢œè‰²çš„åƒç´ å—è¡¨ç¤º26ä¸ªå­—æ¯çš„è®¡æ•°ï¼ˆæ¯”å¦‚çº¢è‰²å—ä»£è¡¨'a'çš„æ•°é‡ï¼‰ï¼›  
- ç”¨â€œæ¸¸æ ‡â€é«˜äº®å½“å‰å¤„ç†çš„ä½ç½®ï¼ˆæ¯”å¦‚ç¬¬iä½ï¼‰ï¼›  
- é€‰å­—ç¬¦æ—¶ï¼Œå¯¹åº”é¢œè‰²å—é—ªçƒå¹¶å‡å°‘æ•°é‡ï¼ŒåŒæ—¶å³ä¾§æ˜¾ç¤ºå½“å‰è´¡çŒ®çš„æ’åˆ—æ•°ï¼›  
- ç´¯åŠ ç»“æœæ—¶ï¼Œç”¨â€œè¿›åº¦æ¡â€å±•ç¤ºansçš„å¢é•¿ã€‚  
- åŠ å…¥**å¤å¤éŸ³æ•ˆ**ï¼šé€‰å­—ç¬¦æ—¶æ’­æ”¾â€œå®â€çš„éŸ³æ•ˆï¼Œè®¡ç®—å®Œæˆæ—¶æ’­æ”¾â€œèƒœåˆ©æ—‹å¾‹â€ï¼Œå¢å¼ºè®°å¿†ç‚¹ï½


## 2. ç²¾é€‰ä¼˜è´¨é¢˜è§£å‚è€ƒ

ä¸ºå¤§å®¶ç­›é€‰äº†**1æ¡5æ˜Ÿé¢˜è§£**ï¼ˆæ€è·¯æ¸…æ™°ã€ä»£ç é«˜æ•ˆã€æ³¨é‡Šåˆ°ä½ï¼‰ï¼š

**é¢˜è§£ä¸€ï¼šæ¥æºï¼šfisheep**  
* **ç‚¹è¯„**ï¼š  
  è¿™ä»½é¢˜è§£çš„**æ ¸å¿ƒäº®ç‚¹æ˜¯â€œé—®é¢˜è½¬åŒ–â€**â€”â€”æŠŠâ€œa < c < bâ€è½¬åŒ–ä¸ºâ€œf(b) - f(a) - 1â€ï¼Œç›´æ¥å°†åŒè¾¹ç•Œé—®é¢˜æ‹†è§£ä¸ºä¸¤ä¸ªå•è¾¹ç•Œé—®é¢˜ï¼Œé¿å…äº†å¤æ‚çš„æšä¸¾ã€‚  
  ä»£ç æ–¹é¢ï¼š  
  - é¢„å¤„ç†äº†é˜¶ä¹˜`f`ã€é˜¶ä¹˜é€†å…ƒ`rf`ã€å•ä¸ªæ•°å­—çš„é€†å…ƒ`sr`ï¼Œé«˜æ•ˆè®¡ç®—ç»„åˆæ•°ï¼›  
  - `f1`å‡½æ•°é€»è¾‘æ¸…æ™°ï¼šé€ä¸ªä½ç½®å¤„ç†å­—ç¬¦ï¼Œè®¡ç®—æ¯ä¸ªå¯èƒ½çš„é€‰æ‹©è´¡çŒ®çš„æ’åˆ—æ•°ï¼Œç´¯åŠ å¾—åˆ°`f(s)`ï¼›  
  - å˜é‡å‘½åç›´è§‚ï¼ˆ`cnt`è®°å½•açš„å­—ç¬¦è®¡æ•°ï¼Œ`c`æ˜¯`cnt`çš„å‰¯æœ¬ç”¨äºä¸´æ—¶è®¡ç®—ï¼‰ï¼Œè¾¹ç•Œå¤„ç†ä¸¥è°¨ï¼ˆæ¯”å¦‚æ— æ³•é€‰s[i]æ—¶ç›´æ¥breakï¼‰ã€‚  
  ä»å®è·µè§’åº¦çœ‹ï¼Œä»£ç å¯ä»¥ç›´æ¥ç”¨äºç«èµ›ï¼Œä¸”æ¨¡è¿ç®—å¤„ç†æ­£ç¡®ï¼Œæ˜¯éå¸¸æ ‡å‡†çš„ç»„åˆæ•°å­¦åº”ç”¨é¢˜è§£æ³•ï½


## 3. æ ¸å¿ƒéš¾ç‚¹è¾¨æä¸è§£é¢˜ç­–ç•¥

### æ ¸å¿ƒéš¾ç‚¹ä¸è§£å†³ç­–ç•¥
1. **éš¾ç‚¹1ï¼šå¦‚ä½•å°†åŒè¾¹ç•Œé—®é¢˜è½¬åŒ–ä¸ºå•è¾¹ç•Œï¼Ÿ**  
   * **åˆ†æ**ï¼šç›´æ¥è®¡ç®—â€œa < c < bâ€çš„æ•°é‡ï¼Œéœ€è¦åŒæ—¶è€ƒè™‘ä¸¤ä¸ªè¾¹ç•Œï¼Œé€»è¾‘å¤æ‚ã€‚ä½†`cæ˜¯açš„æ’åˆ—`ï¼Œå› æ­¤â€œa < câ€ç­‰ä»·äºâ€œcä¸åœ¨açš„æ’åˆ—ä¸­å°äºç­‰äºaçš„é›†åˆé‡Œâ€ï¼Œâ€œc < bâ€ç­‰ä»·äºâ€œcåœ¨açš„æ’åˆ—ä¸­å°äºbçš„é›†åˆé‡Œâ€ã€‚å› æ­¤ç­”æ¡ˆç­‰äº`f(b) - f(a) - 1`ï¼ˆå‡1æ˜¯å› ä¸º`f(a)`åŒ…å«äº†æ‰€æœ‰å°äºaçš„æ’åˆ—ï¼Œè€Œaæœ¬èº«ä¸æ»¡è¶³a < cï¼‰ã€‚  
   * ğŸ’¡ **å­¦ä¹ ç¬”è®°**ï¼šè½¬åŒ–é—®é¢˜æ˜¯è§£å†³å¤æ‚è¾¹ç•Œçš„å…³é”®ï¼

2. **éš¾ç‚¹2ï¼šå¦‚ä½•è®¡ç®—f(s)ï¼ˆaçš„æ’åˆ—ä¸­å°äºsçš„æ•°é‡ï¼‰ï¼Ÿ**  
   * **åˆ†æ**ï¼šå­—å…¸åºçš„æ¯”è¾ƒæ˜¯â€œä»å·¦åˆ°å³ç¬¬ä¸€ä¸ªä¸åŒå­—ç¬¦å†³å®šå¤§å°â€ã€‚å› æ­¤ï¼Œæˆ‘ä»¬å¯ä»¥**é€ä¸ªä½ç½®è®¡ç®—è´¡çŒ®**ï¼š  
     - å¯¹äºç¬¬iä½ï¼Œæšä¸¾æ‰€æœ‰æ¯”s[i]å°çš„å­—ç¬¦xï¼šå¦‚æœxåœ¨å‰©ä½™å­—ç¬¦ä¸­å­˜åœ¨ï¼Œé‚£ä¹ˆé€‰xä½œä¸ºç¬¬iä½ï¼Œåé¢çš„n-iä½å¯ä»¥ç”¨å‰©ä¸‹çš„å­—ç¬¦ä»»æ„æ’åˆ—ï¼Œè´¡çŒ®çš„æ•°é‡æ˜¯`(å‰©ä½™å­—ç¬¦çš„å…¨æ’åˆ—æ•°) Ã— (xçš„å‰©ä½™æ•°é‡)`ã€‚  
     - ç´¯åŠ æ‰€æœ‰å¯èƒ½çš„xçš„è´¡çŒ®ï¼Œå°±æ˜¯å½“å‰ä½çš„æ€»è´¡çŒ®ã€‚  
   * ğŸ’¡ **å­¦ä¹ ç¬”è®°**ï¼šå­—å…¸åºé—®é¢˜çš„æ ¸å¿ƒæ˜¯â€œé€ä½å†³ç­–â€ï¼ŒæŠ“ä½ç¬¬ä¸€ä¸ªä¸åŒç‚¹ï¼

3. **éš¾ç‚¹3ï¼šå¦‚ä½•å¤„ç†å¤§æ•°å–æ¨¡å’Œç»„åˆæ•°è®¡ç®—ï¼Ÿ**  
   * **åˆ†æ**ï¼šæ’åˆ—æ•°çš„è®¡ç®—éœ€è¦ç”¨åˆ°é˜¶ä¹˜ï¼ˆn!ï¼‰ï¼Œè€Œæ¨¡è¿ç®—ä¸‹çš„é™¤æ³•éœ€è¦ç”¨**é€†å…ƒ**ï¼ˆæ¯”å¦‚ï¼Œn!/(k!) ç­‰ä»·äº n! Ã— inv(k!) mod MODï¼‰ã€‚å› æ­¤ï¼Œæˆ‘ä»¬éœ€è¦é¢„å¤„ç†é˜¶ä¹˜`f[i] = i! mod MOD`ã€é˜¶ä¹˜é€†å…ƒ`rf[i] = inv(i!) mod MOD`ï¼Œä»¥åŠå•ä¸ªæ•°å­—çš„é€†å…ƒ`sr[i] = inv(i) mod MOD`ï¼Œè¿™æ ·å¯ä»¥å¿«é€Ÿè®¡ç®—ä»»æ„æ’åˆ—æ•°ã€‚  
   * ğŸ’¡ **å­¦ä¹ ç¬”è®°**ï¼šé¢„å¤„ç†æ˜¯ç»„åˆæ•°å­¦é¢˜çš„â€œå¿…å¤‡æŠ€èƒ½â€ï¼Œèƒ½å¤§å¹…æé«˜æ•ˆç‡ï¼

### âœ¨ è§£é¢˜æŠ€å·§æ€»ç»“
- **é—®é¢˜è½¬åŒ–**ï¼šå°†åŒè¾¹ç•Œè½¬åŒ–ä¸ºå•è¾¹ç•Œï¼Œç®€åŒ–è®¡ç®—ï¼›  
- **é€ä½å†³ç­–**ï¼šå­—å…¸åºé—®é¢˜ä»å·¦åˆ°å³åˆ†æï¼Œè®¡ç®—æ¯ä¸ªä½ç½®çš„è´¡çŒ®ï¼›  
- **é¢„å¤„ç†é€†å…ƒ**ï¼šç»„åˆæ•°è®¡ç®—ä¸­ï¼Œé€†å…ƒæ˜¯å¤„ç†é™¤æ³•çš„å…³é”®ï¼›  
- **æ¨¡è¿ç®—æŠ€å·§**ï¼šå‡æ³•åè¦åŠ MODå†å–æ¨¡ï¼Œé¿å…è´Ÿæ•°ï¼ˆæ¯”å¦‚`(f(b)-f(a)-1+MOD)%MOD`ï¼‰ã€‚


## 4. C++æ ¸å¿ƒä»£ç å®ç°èµæ

### æœ¬é¢˜é€šç”¨æ ¸å¿ƒC++å®ç°å‚è€ƒ
* **è¯´æ˜**ï¼šæ­¤ä»£ç æ¥è‡ªé¢˜è§£fisheepï¼Œé€»è¾‘æ¸…æ™°ã€å®ç°é«˜æ•ˆï¼Œæ˜¯ç»„åˆæ•°å­¦+å­—å…¸åºé—®é¢˜çš„å…¸å‹å®ç°ã€‚  
* **å®Œæ•´æ ¸å¿ƒä»£ç **ï¼š
```cpp
#include<cstdio>
#include<algorithm>  
#include<cstring>  
#include<iostream>    
using namespace std;  
typedef long long ll;
const int maxn=1e6+5;
const int mod=1e9+7;

int n;
char a[maxn],b[maxn];
int cnt[26],c[26];
ll f[maxn],rf[maxn],sr[maxn]; // f:é˜¶ä¹˜, rf:é˜¶ä¹˜é€†å…ƒ, sr:å•ä¸ªæ•°å­—é€†å…ƒ

ll f1(char *s){
    memcpy(c, cnt, sizeof(c)); // å¤åˆ¶cntåˆ°cï¼Œé¿å…ä¿®æ”¹åŸè®¡æ•°
    ll cur = f[n]; // å½“å‰å‰©ä½™å­—ç¬¦çš„å…¨æ’åˆ—æ•°ï¼ˆåˆå§‹ä¸ºn!ï¼‰
    for(int i=0;i<26;i++){
        if(c[i]) cur = cur * rf[c[i]] % mod; // é™¤ä»¥æ¯ä¸ªå­—ç¬¦çš„é‡å¤æ¬¡æ•°çš„é˜¶ä¹˜ï¼ˆå³è®¡ç®—å¤šé‡æ’åˆ—æ•°ï¼‰
    }
    ll ans=0;
    for(int i=1;i<=n;i++){ // é€ä½å¤„ç†
        for(int x=0;x<s[i]-'a';x++){ // æšä¸¾æ¯”s[i]å°çš„å­—ç¬¦x
            if(c[x]){ // å¦‚æœxè¿˜æœ‰å‰©ä½™
                ll now = cur;
                now = now * sr[n - i + 1] % mod; // ä¹˜ä»¥ (n-i+1)çš„é€†å…ƒï¼ˆå› ä¸ºcuræ˜¯å½“å‰çš„å¤šé‡æ’åˆ—æ•°ï¼Œé€‰xåéœ€è¦è°ƒæ•´ï¼‰
                now = now * c[x] % mod; // ä¹˜ä»¥xçš„å‰©ä½™æ•°é‡ï¼ˆé€‰å…¶ä¸­ä¸€ä¸ªxä½œä¸ºå½“å‰ä½ï¼‰
                ans = (ans + now) % mod;
            }
        }
        if(c[s[i]-'a']){ // å¦‚æœå½“å‰å­—ç¬¦å¯ä»¥é€‰s[i]
            cur = cur * sr[n - i + 1] % mod; // è°ƒæ•´curï¼ˆé€‰s[i]åçš„å¤šé‡æ’åˆ—æ•°ï¼‰
            cur = cur * c[s[i]-'a'] % mod;
            c[s[i]-'a']--; // å‡å°‘s[i]çš„è®¡æ•°
        } else {
            break; // æ— æ³•é€‰s[i]ï¼Œåé¢çš„æ’åˆ—ä¸å¯èƒ½æ›´å°ï¼Œç›´æ¥é€€å‡º
        }
    }
    return ans;
}

ll rev(ll a){ // å¿«é€Ÿå¹‚æ±‚é€†å…ƒï¼ˆè´¹é©¬å°å®šç†ï¼Œå› ä¸ºmodæ˜¯è´¨æ•°ï¼‰
    ll ret=1;
    for(ll b=mod-2;b;b>>=1,a=a*a%mod)
        if(b&1) ret=ret*a%mod;
    return ret;
}

int main(){
    // é¢„å¤„ç†é˜¶ä¹˜ã€é€†å…ƒ
    f[0]=rf[0]=1;
    for(int i=1;i<maxn;i++){
        f[i] = f[i-1] * i % mod;
        sr[i] = rev(i);
        rf[i] = rf[i-1] * sr[i] % mod;
    }
    scanf("%s%s",a+1,b+1); // å­—ç¬¦ä¸²ä»ä¸‹æ ‡1å¼€å§‹å­˜å‚¨
    n=strlen(a+1);
    for(int i=1;i<=n;i++) cnt[a[i]-'a']++; // ç»Ÿè®¡aä¸­æ¯ä¸ªå­—ç¬¦çš„æ•°é‡
    ll ans = (f1(b) - f1(a) - 1 + mod) % mod; // è®¡ç®—f(b)-f(a)-1ï¼ŒåŠ modé¿å…è´Ÿæ•°
    printf("%lld\n",ans);
    return 0;
}
```
* **ä»£ç è§£è¯»æ¦‚è¦**ï¼š  
  1. **é¢„å¤„ç†**ï¼šè®¡ç®—é˜¶ä¹˜`f`ã€å•ä¸ªæ•°å­—é€†å…ƒ`sr`ã€é˜¶ä¹˜é€†å…ƒ`rf`ï¼›  
  2. **è¾“å…¥å¤„ç†**ï¼šè¯»å–aå’Œbï¼Œç»Ÿè®¡açš„å­—ç¬¦è®¡æ•°`cnt`ï¼›  
  3. **è®¡ç®—f(b)å’Œf(a)**ï¼šè°ƒç”¨`f1`å‡½æ•°è®¡ç®—açš„æ’åˆ—ä¸­å°äºbå’Œå°äºaçš„æ•°é‡ï¼›  
  4. **ç»“æœè®¡ç®—**ï¼šç”¨`f(b)-f(a)-1`å¾—åˆ°ç­”æ¡ˆï¼Œæ¨¡è¿ç®—å¤„ç†è´Ÿæ•°ã€‚


### å…³é”®ä»£ç ç‰‡æ®µèµæï¼ˆæ¥è‡ªé¢˜è§£ä¸€ï¼‰
**äº®ç‚¹**ï¼š`f1`å‡½æ•°ä¸­â€œé€ä½è®¡ç®—è´¡çŒ®â€çš„é€»è¾‘ï¼Œå®Œç¾ä½“ç°äº†å­—å…¸åºé—®é¢˜çš„æ ¸å¿ƒæ€æƒ³ã€‚  
**æ ¸å¿ƒä»£ç ç‰‡æ®µ**ï¼š
```cpp
ll f1(char *s){
    memcpy(c, cnt, sizeof(c));
    ll cur = f[n];
    for(int i=0;i<26;i++) if(c[i]) cur = cur * rf[c[i]] % mod;
    ll ans=0;
    for(int i=1;i<=n;i++){
        for(int x=0;x<s[i]-'a';x++){
            if(c[x]){
                ll now = cur * sr[n - i + 1] % mod;
                now = now * c[x] % mod;
                ans = (ans + now) % mod;
            }
        }
        if(c[s[i]-'a']){
            cur = cur * sr[n - i + 1] % mod;
            cur = cur * c[s[i]-'a'] % mod;
            c[s[i]-'a']--;
        } else break;
    }
    return ans;
}
```
**ä»£ç è§£è¯»**ï¼š  
- `memcpy(c, cnt, sizeof(c))`ï¼šå¤åˆ¶açš„å­—ç¬¦è®¡æ•°åˆ°ä¸´æ—¶æ•°ç»„cï¼Œé¿å…ä¿®æ”¹åŸæ•°ç»„ï¼›  
- `cur = f[n] * rf[c[0]] * rf[c[1]] * ... % mod`ï¼šè®¡ç®—açš„å¤šé‡æ’åˆ—æ•°ï¼ˆå³æ€»å…±æœ‰å¤šå°‘ç§ä¸åŒçš„æ’åˆ—ï¼‰ï¼›  
- å¤–å±‚å¾ªç¯`for(int i=1;i<=n;i++)`ï¼šé€ä½å¤„ç†sçš„ç¬¬iä½ï¼›  
- å†…å±‚å¾ªç¯`for(int x=0;x<s[i]-'a';x++)`ï¼šæšä¸¾æ‰€æœ‰æ¯”s[i]å°çš„å­—ç¬¦xï¼›  
  - `now = cur * sr[n-i+1] * c[x] % mod`ï¼šè®¡ç®—é€‰xä½œä¸ºç¬¬iä½æ—¶çš„è´¡çŒ®ï¼š  
    - `cur`æ˜¯å½“å‰å‰©ä½™å­—ç¬¦çš„å¤šé‡æ’åˆ—æ•°ï¼›  
    - `sr[n-i+1]`æ˜¯`(n-i+1)`çš„é€†å…ƒï¼ˆå› ä¸ºé€‰xåï¼Œå‰©ä½™å­—ç¬¦æ•°æ˜¯n-iï¼Œéœ€è¦è°ƒæ•´curï¼‰ï¼›  
    - `c[x]`æ˜¯xçš„å‰©ä½™æ•°é‡ï¼ˆé€‰å…¶ä¸­ä¸€ä¸ªxä½œä¸ºå½“å‰ä½ï¼‰ï¼›  
- å¤„ç†é€‰s[i]çš„æƒ…å†µï¼šå¦‚æœs[i]è¿˜æœ‰å‰©ä½™ï¼Œè°ƒæ•´curå¹¶å‡å°‘s[i]çš„è®¡æ•°ï¼Œç»§ç»­å¤„ç†ä¸‹ä¸€ä½ï¼›å¦åˆ™breakï¼ˆæ— æ³•é€‰s[i]ï¼Œåé¢çš„æ’åˆ—ä¸å¯èƒ½æ›´å°ï¼‰ã€‚  

ğŸ’¡ **å­¦ä¹ ç¬”è®°**ï¼š`f1`å‡½æ•°çš„é€»è¾‘æ˜¯â€œå­—å…¸åºé€ä½å†³ç­–â€çš„æ ‡å‡†å®ç°ï¼Œè¦é‡ç‚¹ç†è§£`cur`çš„è°ƒæ•´è¿‡ç¨‹ï¼


## 5. ç®—æ³•å¯è§†åŒ–ï¼šåƒç´ åŠ¨ç”»æ¼”ç¤º (æ ¸å¿ƒéƒ¨åˆ†)

### åŠ¨ç”»æ¼”ç¤ºä¸»é¢˜ï¼šåƒç´ å­—ç¬¦çš„â€œå­—å…¸åºå†’é™©â€  
æˆ‘ä»¬ç”¨**8ä½FCæ¸¸æˆé£æ ¼**æ¨¡æ‹Ÿ`f(s)`çš„è®¡ç®—è¿‡ç¨‹ï¼Œè®©ç®—æ³•â€œåŠ¨èµ·æ¥â€ï¼

### è®¾è®¡æ€è·¯
- **é£æ ¼**ï¼š8ä½åƒç´ é£ï¼ˆæ¯”å¦‚ç”¨NESçš„é…è‰²æ–¹æ¡ˆï¼šæµ…è“èƒŒæ™¯ã€ç™½è‰²å­—ç¬¦ã€å½©è‰²è®¡æ•°å—ï¼‰ï¼›  
- **äº¤äº’**ï¼šæ”¯æŒâ€œå•æ­¥æ‰§è¡Œâ€â€œè‡ªåŠ¨æ’­æ”¾â€â€œé‡ç½®â€ï¼Œé€Ÿåº¦æ»‘å—è°ƒèŠ‚åŠ¨ç”»é€Ÿåº¦ï¼›  
- **æ¸¸æˆåŒ–å…ƒç´ **ï¼šæ¯å¤„ç†å®Œä¸€ä½ï¼Œæ’­æ”¾â€œå®â€çš„éŸ³æ•ˆï¼›è®¡ç®—å®Œæˆæ—¶æ’­æ”¾â€œèƒœåˆ©æ—‹å¾‹â€ï¼Œå±å¹•å¼¹å‡ºâ€œè®¡ç®—å®Œæˆï¼â€çš„åƒç´ æ–‡å­—ï¼›  
- **ä¿¡æ¯å±•ç¤º**ï¼šå³ä¾§æ˜¾ç¤ºå½“å‰å¤„ç†çš„ä½ç½®ã€å‰©ä½™å­—ç¬¦è®¡æ•°ã€å½“å‰ç´¯åŠ çš„anså€¼ï¼ŒåŒæ­¥é«˜äº®å¯¹åº”çš„ä»£ç è¡Œã€‚


### åŠ¨ç”»å¸§æ­¥éª¤
1. **åˆå§‹åŒ–åœºæ™¯**ï¼š  
   - å±å¹•å·¦ä¾§æ˜¾ç¤º26ä¸ªå½©è‰²åƒç´ å—ï¼ˆå¯¹åº”açš„å­—ç¬¦è®¡æ•°ï¼Œæ¯”å¦‚çº¢è‰²å—ä»£è¡¨'a'ï¼Œæ•°é‡æ˜¯cnt['a']ï¼‰ï¼›  
   - ä¸­é—´æ˜¾ç¤ºsçš„å­—ç¬¦ä¸²ï¼ˆæ¯”å¦‚sæ˜¯"ddd"ï¼‰ï¼Œç”¨é»„è‰²æ¸¸æ ‡é«˜äº®ç¬¬1ä½ï¼›  
   - å³ä¾§æ˜¾ç¤ºâ€œå½“å‰ansï¼š0â€â€œå‰©ä½™å­—ç¬¦ï¼ša(1), b(1), c(1)â€ï¼ˆç¤ºä¾‹ä¸­çš„aæ˜¯"abc"ï¼‰ã€‚

2. **é€ä½å¤„ç†ï¼ˆä»¥ç¬¬1ä½ä¸ºä¾‹ï¼‰**ï¼š  
   - æ¸¸æ ‡æŒ‡å‘s[1]ï¼ˆ'd'ï¼‰ï¼Œå†…å±‚å¾ªç¯æšä¸¾x=0ï¼ˆ'a'ï¼‰ã€1ï¼ˆ'b'ï¼‰ã€2ï¼ˆ'c'ï¼‰ï¼›  
   - å¯¹äºx=0ï¼ˆ'a'ï¼‰ï¼šçº¢è‰²å—é—ªçƒï¼Œå³ä¾§æ˜¾ç¤ºâ€œå½“å‰è´¡çŒ®ï¼š2! = 2â€ï¼ˆå› ä¸ºé€‰'a'åï¼Œå‰©ä½™bå’Œcå¯ä»¥æ’åˆ—æˆ2ç§ï¼‰ï¼›  
   - ç´¯åŠ ansåˆ°2ï¼Œç„¶åå¤„ç†x=1ï¼ˆ'b'ï¼‰ï¼šè“è‰²å—é—ªçƒï¼Œè´¡çŒ®2ï¼Œanså˜ä¸º4ï¼›  
   - å¤„ç†x=2ï¼ˆ'c'ï¼‰ï¼šç»¿è‰²å—é—ªçƒï¼Œè´¡çŒ®2ï¼Œanså˜ä¸º6ï¼›  
   - é€‰s[1]ï¼ˆ'd'ï¼‰ï¼šä½†aä¸­æ²¡æœ‰'d'ï¼Œæ‰€ä»¥breakï¼Œf(s)çš„ç»“æœæ˜¯6ï¼ˆå¯¹åº”æ ·ä¾‹1ä¸­çš„f(b)=6ï¼Œf(a)=1ï¼Œans=6-1-1=4ï¼Ÿä¸å¯¹ï¼Œæ ·ä¾‹1ä¸­çš„aæ˜¯"abc"ï¼Œf(a)æ˜¯0ï¼Ÿå“¦ï¼Œæ ·ä¾‹1ä¸­çš„aæ˜¯"abc"ï¼Œf(a)æ˜¯açš„æ’åˆ—ä¸­å°äºaçš„æ•°é‡ï¼Œå³0ã€‚f(b)æ˜¯açš„æ’åˆ—ä¸­å°äº"ddd"çš„æ•°é‡ï¼Œå³æ‰€æœ‰æ’åˆ—æ•°ï¼ˆ6ï¼‰ï¼Œæ‰€ä»¥ans=6-0-1=5ï¼Œç¬¦åˆæ ·ä¾‹1çš„è¾“å‡ºã€‚ï¼‰

3. **è®¡ç®—å®Œæˆ**ï¼š  
   - æ’­æ”¾â€œèƒœåˆ©æ—‹å¾‹â€ï¼Œå±å¹•æ˜¾ç¤ºâ€œf(s) = 6â€ï¼Œå³ä¾§anså˜ä¸º6ï¼›  
   - å¯ä»¥ç‚¹å‡»â€œé‡ç½®â€é‡æ–°è®¡ç®—ï¼Œæˆ–â€œåˆ‡æ¢ç®—æ³•â€æ¯”è¾ƒä¸åŒè§£æ³•ã€‚


## 6. æ‹“å±•ç»ƒä¹ ä¸ç›¸ä¼¼é—®é¢˜æ€è€ƒ

### é€šç”¨æ€è·¯è¿ç§»
æœ¬é¢˜çš„**æ ¸å¿ƒæ€è·¯**ï¼ˆé—®é¢˜è½¬åŒ–ã€é€ä½å†³ç­–ã€ç»„åˆæ•°è®¡ç®—ï¼‰å¯ä»¥è§£å†³ä»¥ä¸‹é—®é¢˜ï¼š  
- è®¡ç®—ä¸€ä¸ªå­—ç¬¦ä¸²çš„æ‰€æœ‰æ’åˆ—ä¸­å¤§äº/å°äºæŸä¸ªå­—ç¬¦ä¸²çš„æ•°é‡ï¼›  
- æ±‚ç¬¬kå°çš„æ’åˆ—ï¼ˆé€†é—®é¢˜ï¼‰ï¼›  
- ç»Ÿè®¡æ»¡è¶³å­—å…¸åºæ¡ä»¶çš„å­—ç¬¦ä¸²æ•°é‡ï¼ˆæ¯”å¦‚å¯†ç å¼ºåº¦ç»Ÿè®¡ï¼‰ã€‚


### ç»ƒä¹ æ¨è (æ´›è°·)
1. **æ´›è°· P2524 Uimçš„æƒ…äººèŠ‚ç¤¼ç‰©Â·å…¶ä¹‹å£±**  
   * ğŸ—£ï¸ **æ¨èç†ç”±**ï¼šç›´æ¥è€ƒå¯Ÿâ€œæ±‚ç¬¬kå°çš„æ’åˆ—â€ï¼Œæ˜¯æœ¬é¢˜çš„é€†é—®é¢˜ï¼Œèƒ½å¸®ä½ å·©å›ºâ€œé€ä½å†³ç­–â€çš„æ€è·¯ã€‚  
2. **æ´›è°· P3197 [HNOI2008]è¶Šç‹±**  
   * ğŸ—£ï¸ **æ¨èç†ç”±**ï¼šç»„åˆæ•°å­¦åº”ç”¨é¢˜ï¼Œéœ€è¦é¢„å¤„ç†é˜¶ä¹˜å’Œé€†å…ƒï¼Œé”»ç‚¼æ¨¡è¿ç®—æŠ€å·§ã€‚  
3. **æ´›è°· P4071 [SDOI2016]æ’åˆ—è®¡æ•°**  
   * ğŸ—£ï¸ **æ¨èç†ç”±**ï¼šè€ƒå¯Ÿå¤šé‡æ’åˆ—çš„è®¡æ•°ï¼Œå’Œæœ¬é¢˜çš„`cur`è®¡ç®—é€»è¾‘ç›¸ä¼¼ï¼Œèƒ½æ·±åŒ–å¯¹ç»„åˆæ•°çš„ç†è§£ã€‚  


## 7. å­¦ä¹ å¿ƒå¾—ä¸ç»éªŒåˆ†äº« (è‹¥æœ‰)

> **å‚è€ƒç»éªŒ (æ¥è‡ªfisheep)**ï¼šâ€œæˆ‘åœ¨è§£å†³è¿™ä¸ªé—®é¢˜æ—¶ï¼Œæœ€åˆå¡äº†å¾ˆä¹…ï¼Œåæ¥æƒ³åˆ°â€˜æŠŠåŒè¾¹ç•Œè½¬åŒ–ä¸ºå•è¾¹ç•Œâ€™ï¼Œé—®é¢˜å°±è¿åˆƒè€Œè§£äº†ã€‚å¦å¤–ï¼Œé¢„å¤„ç†é˜¶ä¹˜å’Œé€†å…ƒçš„æŠ€å·§ä¸€å®šè¦è®°ç‰¢ï¼Œå¦åˆ™ç»„åˆæ•°è®¡ç®—ä¼šå¾ˆéº»çƒ¦ã€‚â€  
> **ç‚¹è¯„**ï¼šè¿™ä½ä½œè€…çš„ç»éªŒå¾ˆå®è´µï¼â€œé—®é¢˜è½¬åŒ–â€æ˜¯è§£å†³å¤æ‚é¢˜ç›®çš„å…³é”®â€”â€”å½“ç›´æ¥è§£å†³é—®é¢˜å›°éš¾æ—¶ï¼Œä¸å¦¨æ¢ä¸ªè§’åº¦æ€è€ƒã€‚é¢„å¤„ç†é€†å…ƒä¹Ÿæ˜¯ç»„åˆæ•°å­¦é¢˜çš„â€œå¿…å¤‡æŠ€èƒ½â€ï¼Œèƒ½å¤§å¹…æé«˜ä»£ç æ•ˆç‡ï½


æœ¬æ¬¡å…³äºâ€œString Markâ€çš„C++è§£é¢˜åˆ†æå°±åˆ°è¿™é‡Œã€‚å¸Œæœ›è¿™ä»½æŒ‡å—èƒ½å¸®ä½ ç†è§£ç»„åˆæ•°å­¦ä¸å­—å…¸åºçš„ç»“åˆåº”ç”¨ã€‚è®°ä½ï¼š**è½¬åŒ–é—®é¢˜+é€ä½å†³ç­–+é¢„å¤„ç†**ï¼Œæ˜¯è§£å†³è¿™ç±»é¢˜çš„â€œé»„é‡‘ä¸‰è§’â€ï¼ä¸‹æ¬¡æˆ‘ä»¬å†ä¸€èµ·æ¢ç´¢æ–°çš„ç¼–ç¨‹æŒ‘æˆ˜ï½ğŸ’ª

---
å¤„ç†ç”¨æ—¶ï¼š179.49ç§’
# é¢˜ç›®ä¿¡æ¯

# Beautiful Graph

## é¢˜ç›®æè¿°

You are given an undirected unweighted graph consisting of $ n $ vertices and $ m $ edges.

You have to write a number on each vertex of the graph. Each number should be $ 1 $ , $ 2 $ or $ 3 $ . The graph becomes beautiful if for each edge the sum of numbers on vertices connected by this edge is odd.

Calculate the number of possible ways to write numbers $ 1 $ , $ 2 $ and $ 3 $ on vertices so the graph becomes beautiful. Since this number may be large, print it modulo $ 998244353 $ .

Note that you have to write exactly one number on each vertex.

The graph does not have any self-loops or multiple edges.

## è¯´æ˜/æç¤º

Possible ways to distribute numbers in the first test:

1. the vertex $ 1 $ should contain $ 1 $ , and $ 2 $ should contain $ 2 $ ;
2. the vertex $ 1 $ should contain $ 3 $ , and $ 2 $ should contain $ 2 $ ;
3. the vertex $ 1 $ should contain $ 2 $ , and $ 2 $ should contain $ 1 $ ;
4. the vertex $ 1 $ should contain $ 2 $ , and $ 2 $ should contain $ 3 $ .

In the second test there is no way to distribute numbers.

## æ ·ä¾‹ #1

### è¾“å…¥

```
2
2 1
1 2
4 6
1 2
1 3
1 4
2 3
2 4
3 4
```

### è¾“å‡º

```
4
0
```

# AIåˆ†æç»“æœ


### ğŸ’¡ Kayçš„C++ç®—æ³•è§£æï¼šBeautiful Graph æ·±å…¥å­¦ä¹ æŒ‡å— ğŸ’¡

**<introduction>**
ä»Šå¤©æˆ‘ä»¬æ¥åˆ†æâ€œBeautiful Graphâ€è¿™é“å›¾è®ºé¢˜ç›®ã€‚æœ¬æŒ‡å—å°†å¸®åŠ©ä½ å¿«é€Ÿç†è§£æ ¸å¿ƒæ€è·¯ã€æŒæ¡è§£é¢˜æŠ€å·§ï¼Œå¹¶é€šè¿‡å¯è§†åŒ–æ–¹æ¡ˆç›´è§‚æ„Ÿå—ç®—æ³•æ‰§è¡Œè¿‡ç¨‹ã€‚
**</introduction>**

---

## 1. é¢˜ç›®è§£è¯»ä¸æ ¸å¿ƒç®—æ³•è¯†åˆ«

âœ¨ **æœ¬é¢˜ä¸»è¦è€ƒå¯Ÿ**ï¼š`äºŒåˆ†å›¾æŸ“è‰²` + `è®¡æ•°åŸç†`

ğŸ—£ï¸ **åˆæ­¥åˆ†æ**ï¼š
> è§£å†³æœ¬é¢˜çš„å…³é”®åœ¨äºç†è§£**å¥‡å¶æ€§çº¦æŸ**ï¼šç›¸é‚»é¡¶ç‚¹å¿…é¡»å¥‡å¶æ€§ä¸åŒï¼ˆå¥‡æ•°+å¶æ•°=å¥‡æ•°ï¼‰ã€‚è¿™ç­‰ä»·äºå°†å›¾æŸ“æˆäºŒåˆ†å›¾ï¼ˆå¦‚é»‘ç™½ä¸¤è‰²ï¼‰ï¼Œé»‘ç‚¹èµ‹å¥‡æ•°å€¼ï¼ˆ1æˆ–3ï¼‰ï¼Œç™½ç‚¹èµ‹å¶æ•°å€¼ï¼ˆ2ï¼‰ã€‚  
> - **æ ¸å¿ƒéš¾ç‚¹**ï¼šåˆ¤æ–­å›¾æ˜¯å¦ä¸ºäºŒåˆ†å›¾ï¼ˆæ— å¥‡ç¯ï¼‰ï¼Œå¹¶ç»Ÿè®¡æ¯ä¸ªè¿é€šå—çš„é»‘/ç™½ç‚¹æ•°é‡  
> - **è§£å†³æ–¹æ¡ˆ**ï¼šé€šè¿‡BFS/DFSæŸ“è‰²ï¼Œè‹¥æŸ“è‰²å†²çªåˆ™æ–¹æ¡ˆæ•°ä¸º0ï¼›å¦åˆ™å¯¹æ¯ä¸ªè¿é€šå—è®¡ç®—$2^{\text{é»‘ç‚¹æ•°}} + 2^{\text{ç™½ç‚¹æ•°}}$  
> - **å¯è§†åŒ–è®¾è®¡**ï¼šç”¨åƒç´ æ–¹å—è¡¨ç¤ºé¡¶ç‚¹ï¼ŒæŸ“è‰²æ—¶å½“å‰æ–¹å—é—ªçƒï¼Œç›¸é‚»æ–¹å—åŒæ­¥åè‰²æ˜¾ç¤ºã€‚å†²çªæ—¶çº¢è‰²é«˜äº®ï¼ŒæˆåŠŸæ—¶æ’­æ”¾8bitéŸ³æ•ˆ  
> - **å¤å¤æ¸¸æˆåŒ–**ï¼šè®¾è®¡ä¸º"åƒç´ æ¢é™©å®¶"é—¯å…³æ¨¡å¼ï¼Œæ¯æŸ“è‰²ä¸€ä¸ªè¿é€šå—è§†ä¸ºé€šå…³å°å…³å¡ï¼Œèƒœåˆ©æ—¶æ’­æ”¾FCé£æ ¼èƒœåˆ©éŸ³æ•ˆ

---

## 2. ç²¾é€‰ä¼˜è´¨é¢˜è§£å‚è€ƒ

**é¢˜è§£ä¸€ï¼ˆLJC00118ï¼‰**
* **ç‚¹è¯„**ï¼šæ€è·¯æ¸…æ™°ç›´å‡»äºŒåˆ†å›¾æœ¬è´¨ï¼ŒBFSå®ç°è§„èŒƒï¼ˆé˜Ÿåˆ—æ“ä½œã€åŠæ—¶breakä¼˜åŒ–ï¼‰ï¼Œå˜é‡å`cnt1/cnt2`ç›´è§‚ã€‚äº®ç‚¹åœ¨äºå¤„ç†å¤šç»„æ•°æ®æ—¶é¿å…memsetæ•´ä¸ªæ•°ç»„ï¼Œé€šè¿‡å±€éƒ¨åˆå§‹åŒ–æå‡æ•ˆç‡ã€‚è¾¹ç•Œå¤„ç†ä¸¥è°¨ï¼Œä»£ç å¯ç›´æ¥ç”¨äºç«èµ›ã€‚

**é¢˜è§£äºŒï¼ˆfmj_123ï¼‰**
* **ç‚¹è¯„**ï¼šDFSå®ç°ç®€æ´ï¼Œç”¨`vis[]`å’Œ`color[]`åŒæ•°ç»„é¿å…å†²çªã€‚äº®ç‚¹æ˜¯å¿«é€Ÿå¹‚è®¡ç®—$2^n$çš„å°è£…å‡½æ•°ï¼Œä»¥åŠ"å¥‡å¶é¢ å€’"çš„ç”ŸåŠ¨è§£é‡Šï¼ˆ"é»‘ç‚¹ä¸ºå¥‡ç™½ç‚¹ä¸ºå¶å’Œé»‘ç‚¹ä¸ºå¶ç™½ç‚¹ä¸ºå¥‡"ï¼‰ï¼Œå¯¹åˆå­¦è€…å‹å¥½ã€‚

**é¢˜è§£ä¸‰ï¼ˆè½»ç»˜ï¼‰**
* **ç‚¹è¯„**ï¼šå¼ºè°ƒäºŒåˆ†å›¾ä¸é¢˜ç›®çš„è½¬æ¢å…³ç³»ï¼ˆ"1å’Œ3ç­‰ä»·"ï¼‰ï¼Œä»£ç æ¨¡å—åŒ–å¥½ã€‚äº®ç‚¹æ˜¯"å­¦ä¹ ç¬”è®°"æ€»ç»“æ ¸å¿ƒæ€æƒ³ï¼Œä»¥åŠé€’å½’DFSä¸­åŠæ—¶è¿”å›å†²çªçš„ä¼˜åŒ–ï¼Œå®è·µå‚è€ƒä»·å€¼é«˜ã€‚

---

## 3. æ ¸å¿ƒéš¾ç‚¹è¾¨æä¸è§£é¢˜ç­–ç•¥

1.  **äºŒåˆ†å›¾åˆ¤å®šï¼ˆå¥‡ç¯æ£€æµ‹ï¼‰**
    * **åˆ†æ**ï¼šè‹¥å­˜åœ¨å¥‡æ•°é•¿åº¦ç¯ï¼Œåˆ™æ— æ³•æ»¡è¶³å¥‡å¶äº¤æ›¿ï¼ˆå¦‚A-B-C-Aå½¢æˆA/CåŒå¥‡ä½†éœ€ä¸åŒï¼‰ã€‚ä¼˜è´¨é¢˜è§£ç”¨BFS/DFSæŸ“è‰²æ—¶æ£€æŸ¥é‚»æ¥ç‚¹é¢œè‰²
    * ğŸ’¡ **å­¦ä¹ ç¬”è®°**ï¼šæŸ“è‰²å†²çª=å­˜åœ¨å¥‡ç¯=æ–¹æ¡ˆæ•°ä¸º0

2.  **è¿é€šå—ç‹¬ç«‹è®¡æ•°**
    * **åˆ†æ**ï¼šå›¾å¯èƒ½ä¸è¿é€šï¼Œæ¯ä¸ªè¿é€šå—æ–¹æ¡ˆç‹¬ç«‹ã€‚éœ€éå†æ‰€æœ‰æœªè®¿é—®ç‚¹å¯åŠ¨æŸ“è‰²ï¼Œç”¨`ans *= å—æ–¹æ¡ˆ`ç´¯è®¡ç»“æœ
    * ğŸ’¡ **å­¦ä¹ ç¬”è®°**ï¼šæ€»æ–¹æ¡ˆ=Î (æ¯ä¸ªè¿é€šå—æ–¹æ¡ˆ)

3.  **æ–¹æ¡ˆæ•°æ¨å¯¼**
    * **åˆ†æ**ï¼šè®¾è¿é€šå—é»‘ç‚¹aä¸ªï¼Œç™½ç‚¹bä¸ªã€‚é»‘å¥‡æ—¶æ–¹æ¡ˆ=$2^a$ï¼ˆæ¯ä¸ªé»‘ç‚¹é€‰1æˆ–3ï¼‰ï¼Œç™½å¥‡æ—¶æ–¹æ¡ˆ=$2^b$ï¼Œæ€»å’Œ$2^a+2^b$
    * ğŸ’¡ **å­¦ä¹ ç¬”è®°**ï¼šå¥‡æ•°ç‚¹æœ‰2ç§é€‰æ‹©ï¼Œå¶æ•°ç‚¹åªæœ‰1ç§

### âœ¨ è§£é¢˜æŠ€å·§æ€»ç»“
- **é—®é¢˜åˆ†è§£**ï¼šç‹¬ç«‹å¤„ç†æ¯ä¸ªè¿é€šå—å†åˆå¹¶ç»“æœ  
- **æŸ“è‰²ä¼˜åŒ–**ï¼šç”¨`color[u]=3-color[v]`å®ç°é»‘ç™½äº¤æ›¿  
- **å¹‚è¿ç®—**ï¼šé¢„å¤„ç†$2^n$æˆ–å¿«é€Ÿå¹‚é¿å…é‡å¤è®¡ç®—  
- **è¾¹ç•Œå¤„ç†**ï¼šå¤šç»„æ•°æ®æ—¶åªåˆå§‹åŒ–ç”¨åˆ°çš„éƒ¨åˆ†ï¼ˆé¿å…`memset`è¶…æ—¶ï¼‰

---

## 4. C++æ ¸å¿ƒä»£ç å®ç°èµæ

**æœ¬é¢˜é€šç”¨æ ¸å¿ƒC++å®ç°å‚è€ƒ**
```cpp
#include <iostream>
#include <vector>
#include <queue>
using namespace std;
const int MOD = 998244353;
const int N = 3e5+5;

vector<int> g[N];
int color[N]; // 0æœªæŸ“ 1é»‘ 2ç™½

long long qpow(long long base, long long exp) {
    long long res = 1;
    while (exp) {
        if (exp & 1) res = res * base % MOD;
        base = base * base % MOD;
        exp >>= 1;
    }
    return res;
}

int main() {
    int T; cin >> T;
    while (T--) {
        int n, m; cin >> n >> m;
        // åˆå§‹åŒ–å½“å‰æ•°æ®
        for (int i = 1; i <= n; i++) {
            g[i].clear();
            color[i] = 0;
        }
        // å»ºå›¾
        while (m--) {
            int u, v; cin >> u >> v;
            g[u].push_back(v);
            g[v].push_back(u);
        }
        long long ans = 1;
        bool valid = true;
        for (int i = 1; i <= n && valid; i++) {
            if (color[i]) continue; // å·²æŸ“è‰²åˆ™è·³è¿‡
            queue<int> q;
            q.push(i);
            color[i] = 1;
            int cnt1 = 1, cnt2 = 0; // é»‘/ç™½è®¡æ•°
            while (!q.empty() && valid) {
                int u = q.front(); q.pop();
                for (int v : g[u]) {
                    if (!color[v]) {
                        color[v] = 3 - color[u]; // æŸ“åè‰²
                        if (color[v] == 1) cnt1++;
                        else cnt2++;
                        q.push(v);
                    } else if (color[v] == color[u]) {
                        valid = false; // å†²çª
                        break;
                    }
                }
            }
            if (!valid) break;
            long long ways = (qpow(2, cnt1) + qpow(2, cnt2)) % MOD;
            ans = (ans * ways) % MOD;
        }
        cout << (valid ? ans : 0) << endl;
    }
    return 0;
}
```
**ä»£ç è§£è¯»æ¦‚è¦**ï¼š
1. å¤šç»„æ•°æ®ä¸‹ä»…åˆå§‹åŒ–å½“å‰ç”¨åˆ°çš„éƒ¨åˆ†  
2. BFSæŸ“è‰²ï¼šèµ·ç‚¹æŸ“é»‘è‰²(1)ï¼Œé‚»ç‚¹æŸ“ç™½è‰²(2)  
3. å†²çªæ£€æµ‹ï¼šé‚»æ¥ç‚¹é¢œè‰²ç›¸åŒç«‹å³ç»ˆæ­¢  
4. æ–¹æ¡ˆè®¡ç®—ï¼š$2^{\text{é»‘ç‚¹}} + 2^{\text{ç™½ç‚¹}}$ å–æ¨¡

---

## 5. ç®—æ³•å¯è§†åŒ–ï¼šåƒç´ åŠ¨ç”»æ¼”ç¤º

**ä¸»é¢˜**ï¼š`åƒç´ æ¢é™©å®¶ä¹‹å¥‡å¶è¿·å®«`ï¼ˆFCçº¢ç™½æœºé£æ ¼ï¼‰  
**æ ¸å¿ƒæ¼”ç¤º**ï¼šäºŒåˆ†å›¾æŸ“è‰²è¿‡ç¨‹ä¸å†²çªæ£€æµ‹  

```mermaid
graph TD
    A[å¯åŠ¨åŠ¨ç”»] --> B[åˆå§‹åŒ–æ‰€æœ‰ç‚¹ä¸ºç°è‰²]
    B --> C{é€‰æ‹©èµ·ç‚¹}
    C --> D[å½“å‰ç‚¹é—ªçƒé»„è‰²]
    D --> E[æŸ“ä¸ºé»‘è‰²/ç™½è‰²]
    E --> F[ç›¸é‚»ç‚¹é—ªçƒè“è‰²]
    F --> G[æŸ“ç›¸åé¢œè‰²]
    G --> H{å†²çªï¼Ÿ}
    H -- æ˜¯ --> I[å†²çªè¾¹çº¢è‰²é—ªçƒ+çˆ†ç‚¸éŸ³æ•ˆ]
    H -- å¦ --> J{è¿é€šå—å®Œæˆï¼Ÿ}
    J -- å¦ --> D
    J -- æ˜¯ --> K[æ’­æ”¾èƒœåˆ©éŸ³æ•ˆ+æ˜¾ç¤ºæ–¹æ¡ˆæ•°]
```

**äº¤äº’æ§åˆ¶é¢æ¿**ï¼š
- `å•æ­¥æ‰§è¡Œ`ï¼šæ‰‹åŠ¨è§¦å‘æŸ“è‰²æ­¥éª¤  
- `é€Ÿåº¦è°ƒèŠ‚`ï¼šæ»‘å—æ§åˆ¶è‡ªåŠ¨æ’­æ”¾é€Ÿåº¦ï¼ˆæ…¢é€Ÿ0.5x~å¿«é€Ÿ3xï¼‰  
- `AIæ¼”ç¤º`ï¼šè‡ªåŠ¨å®Œæˆæ•´ä¸ªè¿é€šå—æŸ“è‰²ï¼ˆç±»ä¼¼è´ªåƒè›‡AIï¼‰  

**å…³é”®åŠ¨ç”»ç»†èŠ‚**ï¼š
1. **é¡¶ç‚¹è¡¨ç¤º**ï¼š10x10åƒç´ æ–¹å—ï¼Œç°è‰²(æœªæŸ“)/é»‘è‰²/ç™½è‰²  
2. **è¾¹é«˜äº®**ï¼šå½“å‰å¤„ç†çš„è¾¹æ˜¾ç¤ºä¸ºé»„è‰²ï¼ŒæˆåŠŸæŸ“è‰²åå˜ç»¿  
3. **å†²çªç‰¹æ•ˆ**ï¼šå†²çªé¡¶ç‚¹å¿«é€Ÿçº¢ç™½é—ªçƒ3æ¬¡+â€œå‘²å•¦â€éŸ³æ•ˆ  
4. **è®¡æ•°æ¿**ï¼šå®æ—¶æ˜¾ç¤ºå½“å‰è¿é€šå—çš„é»‘/ç™½ç‚¹æ•°å’Œæ–¹æ¡ˆæ•°  

**éŸ³æ•ˆè®¾è®¡**ï¼š
- æŸ“è‰²æˆåŠŸï¼šæ¸…è„†â€œå®â€å£°ï¼ˆ8bitæ­£å¼¦æ³¢ï¼‰  
- è¿é€šå—å®Œæˆï¼šä¸Šå‡éŸ³é˜¶+é¼“ç‚¹  
- å†²çªï¼šä½éŸ³â€œè½°â€å£°  

---

## 6. æ‹“å±•ç»ƒä¹ ä¸ç›¸ä¼¼é—®é¢˜æ€è€ƒ

**é€šç”¨æŠ€å·§è¿ç§»**ï¼š
1. **çº¦æŸè½¬æ¢**ï¼šå°†æ•°å€¼å¥‡å¶æ€§è½¬åŒ–ä¸ºå›¾æŸ“è‰²é—®é¢˜  
2. **è¿é€šå—ç‹¬ç«‹å¤„ç†**ï¼šé€‚ç”¨äºå¤šè¿é€šå­å›¾è®¡æ•°é—®é¢˜  
3. **äºŒåˆ†å›¾æ¨¡å‹**ï¼šè§£å†³ç›¸é‚»ç»“ç‚¹ä¸èƒ½åŒç±»çš„çº¦æŸé—®é¢˜  

**æ´›è°·ç»ƒä¹ æ¨è**ï¼š
1. **P1330 å°é”é˜³å…‰å¤§å­¦**  
   ğŸ—£ï¸ ç›´æ¥åº”ç”¨äºŒåˆ†å›¾æŸ“è‰²ï¼Œç»ƒä¹ å†²çªæ£€æµ‹  

2. **P1525 å…³æŠ¼ç½ªçŠ¯**  
   ğŸ—£ï¸ äºŒåˆ†ç­”æ¡ˆ+äºŒåˆ†å›¾åˆ¤å®šï¼ŒæŒæ¡æ¨¡å‹å˜å½¢  

3. **P3386 äºŒåˆ†å›¾æœ€å¤§åŒ¹é…**  
   ğŸ—£ï¸ è¿›é˜¶åŒˆç‰™åˆ©ç®—æ³•ï¼Œç†è§£äºŒåˆ†å›¾åº”ç”¨æ‹“å±•  

---

## 7. å­¦ä¹ å¿ƒå¾—ä¸ç»éªŒåˆ†äº«

> **å‚è€ƒç»éªŒ**ï¼ˆæ¥è‡ªå¤šä½é¢˜è§£ä½œè€…ï¼‰ï¼š  
> â€œå¤šç»„æ•°æ®åˆå§‹åŒ–è‹¥ç”¨`memset`æ•´ä¸ªæ•°ç»„ä¼šè¶…æ—¶ï¼Œå¿…é¡»åªåˆå§‹åŒ–ç”¨åˆ°çš„éƒ¨åˆ†â€  
> â€œæŸ“è‰²æ—¶ç”¨`3-color[u]`æ¯”`if-else`æ›´ç®€æ´ä¸æ˜“é”™â€  
>  
> **Kayæ€»ç»“**ï¼š  
> 1. åˆå§‹åŒ–èŒƒå›´å½±å“æ•ˆç‡ï¼Œå¤§æ•°æ®ä¸‹éœ€ç²¾ç»†æ§åˆ¶  
> 2. æ•°å­¦å¼ç¼–ç èƒ½æå‡å¯è¯»æ€§ï¼ˆå¦‚åè‰²æ“ä½œï¼‰  
> 3. å…ˆåˆ¤è¿é€šå—å†è®¡æ•°çš„æ¡†æ¶å¯æ‰©å±•åˆ°å…¶ä»–å›¾è®ºé—®é¢˜  

---

**<conclusion>**
é€šè¿‡æœ¬æŒ‡å—ï¼Œæˆ‘ä»¬æŒæ¡äº†äºŒåˆ†å›¾æŸ“è‰²çš„æ ¸å¿ƒæ€æƒ³ã€é«˜æ•ˆå®ç°æŠ€å·§åŠè°ƒè¯•è¦ç‚¹ã€‚è®°ä½ï¼šå°†å¤æ‚çº¦æŸè½¬åŒ–ä¸ºå›¾æ¨¡å‹æ˜¯è§£é¢˜å…³é”®ï¼å¤šåŠ¨æ‰‹å®ç°å¯è§†åŒ–ç®—æ³•ï¼Œèƒ½åŠ æ·±ç†è§£ã€‚ä¸‹æ¬¡æŒ‘æˆ˜å†è§ï¼ğŸ’ª
**</conclusion>**

---
å¤„ç†ç”¨æ—¶ï¼š149.95ç§’
# é¢˜ç›®ä¿¡æ¯

# Anna, Svyatoslav and Maps

## é¢˜ç›®æè¿°

The main characters have been omitted to be short.

You are given a directed unweighted graph without loops with $ n $ vertexes and a path in it (that path is not necessary simple) given by a sequence $ p_1, p_2, \ldots, p_m $ of $ m $ vertexes; for each $ 1 \leq i < m $ there is an arc from $ p_i $ to $ p_{i+1} $ .

Define the sequence $ v_1, v_2, \ldots, v_k $ of $ k $ vertexes as good, if $ v $ is a subsequence of $ p $ , $ v_1 = p_1 $ , $ v_k = p_m $ , and $ p $ is one of the shortest paths passing through the vertexes $ v_1 $ , $ \ldots $ , $ v_k $ in that order.

A sequence $ a $ is a subsequence of a sequence $ b $ if $ a $ can be obtained from $ b $ by deletion of several (possibly, zero or all) elements. It is obvious that the sequence $ p $ is good but your task is to find the shortest good subsequence.

If there are multiple shortest good subsequences, output any of them.

## è¯´æ˜/æç¤º

Below you can see the graph from the first example:

![](https://cdn.luogu.com.cn/upload/vjudge_pic/CF1204C/71cf125b3567a608d3e838a04ba123f82afa0825.png)

The given path is passing through vertexes $ 1 $ , $ 2 $ , $ 3 $ , $ 4 $ . The sequence $ 1-2-4 $ is good because it is the subsequence of the given path, its first and the last elements are equal to the first and the last elements of the given path respectively, and the shortest path passing through vertexes $ 1 $ , $ 2 $ and $ 4 $ in that order is $ 1-2-3-4 $ . Note that subsequences $ 1-4 $ and $ 1-3-4 $ aren't good because in both cases the shortest path passing through the vertexes of these sequences is $ 1-3-4 $ .

In the third example, the graph is full so any sequence of vertexes in which any two consecutive elements are distinct defines a path consisting of the same number of vertexes.

In the fourth example, the paths $ 1-2-4 $ and $ 1-3-4 $ are the shortest paths passing through the vertexes $ 1 $ and $ 4 $ .

## æ ·ä¾‹ #1

### è¾“å…¥

```
4
0110
0010
0001
1000
4
1 2 3 4
```

### è¾“å‡º

```
3
1 2 4 ```

## æ ·ä¾‹ #2

### è¾“å…¥

```
4
0110
0010
1001
1000
20
1 2 3 4 1 2 3 4 1 2 3 4 1 2 3 4 1 2 3 4
```

### è¾“å‡º

```
11
1 2 4 2 4 2 4 2 4 2 4 ```

## æ ·ä¾‹ #3

### è¾“å…¥

```
3
011
101
110
7
1 2 3 1 3 2 1
```

### è¾“å‡º

```
7
1 2 3 1 3 2 1 ```

## æ ·ä¾‹ #4

### è¾“å…¥

```
4
0110
0001
0001
1000
3
1 2 4
```

### è¾“å‡º

```
2
1 4 ```

# AIåˆ†æç»“æœ

# ğŸ’¡ Kayçš„C++ç®—æ³•è§£æï¼šAnna, Svyatoslav and Maps æ·±å…¥å­¦ä¹ æŒ‡å— ğŸ’¡


## 1. é¢˜ç›®è§£è¯»ä¸æ ¸å¿ƒç®—æ³•è¯†åˆ«

âœ¨ **æœ¬é¢˜ä¸»è¦è€ƒå¯Ÿ**ï¼šå›¾è®ºï¼ˆæœ€çŸ­è·¯ï¼‰ + è´ªå¿ƒç­–ç•¥


ğŸ—£ï¸ **åˆæ­¥åˆ†æ**ï¼š  
è§£å†³â€œAnna, Svyatoslav and Mapsâ€çš„å…³é”®ï¼Œæ˜¯**ç”¨æœ€çŸ­è·¯ç®—æ³•é¢„å¤„ç†å›¾çš„ä¿¡æ¯ï¼Œå†ç”¨è´ªå¿ƒç­–ç•¥ç­›é€‰å‡ºæœ€çŸ­çš„â€œå¥½çš„å­åºåˆ—â€**ã€‚  

- **å›¾è®ºï¼ˆFloyd-Warshallç®—æ³•ï¼‰**ï¼šå°±åƒç»™åœ°å›¾æ ‡æ³¨æ‰€æœ‰åœ°ç‚¹é—´çš„æœ€çŸ­è·¯çº¿â€”â€”å› ä¸ºå›¾çš„èŠ‚ç‚¹æ•°â‰¤100ï¼Œæˆ‘ä»¬å¯ä»¥ç”¨Floydç®—æ³•ï¼ˆO(nÂ³)ï¼‰é¢„å¤„ç†æ‰€æœ‰ç‚¹å¯¹çš„æœ€çŸ­è·¯å¾„ï¼Œè¿™æ ·åç»­åˆ¤æ–­ä¼šéå¸¸å¿«ã€‚  
- **è´ªå¿ƒç­–ç•¥**ï¼šç±»ä¼¼â€œé€‰æœ€å°‘çš„åœ°æ ‡ç¡®ä¿ä¸è¿·è·¯â€â€”â€”æˆ‘ä»¬è¦ä»åŸè·¯å¾„ä¸­å°½å¯èƒ½å°‘é€‰ç‚¹ï¼Œåªåœ¨â€œå¿…é¡»é€‰â€çš„æ—¶å€™é€‰ï¼ˆæ¯”å¦‚å½“å‰ç‚¹ä¸ä¸Šä¸€ä¸ªé€‰ä¸­ç‚¹çš„æœ€çŸ­è·¯å¾„æ¯”åŸè·¯å¾„çŸ­ï¼Œä¸é€‰å°±ä¼šâ€œèµ°æ·å¾„â€ï¼Œè¿åé¢˜æ„ï¼‰ã€‚  

**æ ¸å¿ƒé€»è¾‘**ï¼š  
1. ç”¨Floydç®—å‡ºä»»æ„ä¸¤ç‚¹çš„æœ€çŸ­è·ç¦»`dis[u][v]`ã€‚  
2. ä»åŸè·¯å¾„çš„ç¬¬ä¸€ä¸ªç‚¹å¼€å§‹ï¼Œç»´æŠ¤ä¸Šä¸€ä¸ªé€‰ä¸­çš„ç‚¹`last`ã€‚  
3. éå†åŸè·¯å¾„ï¼šå¦‚æœ`dis[p[last]][p[i]] < (i - last)`ï¼ˆæœ€çŸ­è·¯å¾„æ¯”åŸè·¯å¾„æ­¥æ•°çŸ­ï¼‰ï¼Œè¯´æ˜å¿…é¡»é€‰`p[i-1]`ï¼Œå¦åˆ™ç»§ç»­ã€‚  
4. æœ€ååŠ å…¥åŸè·¯å¾„çš„æœ€åä¸€ä¸ªç‚¹ã€‚  

**å¯è§†åŒ–è®¾è®¡æ€è·¯**ï¼š  
æˆ‘ä»¬ä¼šåšä¸€ä¸ª**FCçº¢ç™½æœºé£æ ¼çš„åƒç´ åŠ¨ç”»**â€”â€”ç”¨å½©è‰²æ–¹å—è¡¨ç¤ºèŠ‚ç‚¹ï¼Œç®­å¤´è¡¨ç¤ºè·¯å¾„ï¼Œé€‰ä¸­çš„èŠ‚ç‚¹é—ªçƒ+â€œå®â€çš„éŸ³æ•ˆï¼ŒåŸè·¯å¾„ç”¨çº¢è‰²ç®­å¤´åŠ¨æ€èµ°ä¸€éã€‚åŠ¨ç”»æ”¯æŒâ€œå•æ­¥æ‰§è¡Œâ€â€œè‡ªåŠ¨æ’­æ”¾â€ï¼Œæ–¹ä¾¿ä½ çœ‹æ¸…æ¯ä¸€æ­¥å†³ç­–ã€‚


## 2. ç²¾é€‰ä¼˜è´¨é¢˜è§£å‚è€ƒ

### é¢˜è§£ä¸€ï¼šä½œè€…te5555ï¼ˆèµï¼š8ï¼‰
* **ç‚¹è¯„**ï¼šè¿™é¢˜è§£æŠŠé¢˜æ„è½¬åŒ–å¾—ç‰¹åˆ«æ¸…æ¥šï¼ä½œè€…ç›´æ¥ç‚¹å‡ºâ€œå¥½çš„å­åºåˆ—â€çš„æ¡ä»¶æ˜¯â€œæœ€çŸ­è·¯å¾„ç­‰äºåŸè·¯å¾„æ­¥æ•°â€ï¼Œä»£ç é€»è¾‘ä¹Ÿå¾ˆé¡ºâ€”â€”ç”¨`cur`ç´¯ç§¯åŸè·¯å¾„æ­¥æ•°ï¼Œåˆ¤æ–­`dis[las][p[i]] < cur`æ—¶é€‰ç‚¹ã€‚å˜é‡å‘½åï¼ˆ`las`è¡¨ç¤ºä¸Šä¸€ä¸ªé€‰ä¸­çš„ç‚¹ï¼Œ`cur`è¡¨ç¤ºå½“å‰æ­¥æ•°ï¼‰å¾ˆç›´è§‚ï¼Œè¾¹ç•Œå¤„ç†ä¹Ÿä¸¥è°¨ï¼ˆæœ€ååŠ åŸè·¯å¾„ç»ˆç‚¹ï¼‰ã€‚ä»£ç èƒ½ç›´æ¥ç”¨äºç«èµ›ï¼Œå¤„ç†1e6é•¿åº¦çš„åºåˆ—ä¹Ÿä¸å¡ï¼Œæ˜¯éå¸¸ä¼˜è´¨çš„å‚è€ƒã€‚


### é¢˜è§£äºŒï¼šä½œè€…robin12138ï¼ˆèµï¼š2ï¼‰
* **ç‚¹è¯„**ï¼šè¿™é¢˜è§£çš„è´ªå¿ƒæ€è·¯å¾ˆæ˜ç¡®ï¼ä½œè€…ç”¨`x`è¡¨ç¤ºä¸Šä¸€ä¸ªé€‰ä¸­çš„ç‚¹ï¼Œ`dis`ç´¯ç§¯åŸè·¯å¾„æ­¥æ•°ï¼Œåˆ¤æ–­æ¡ä»¶`d[x][p[i]] < dis`æ—¶é€‰ç‚¹ã€‚ä»£ç é£æ ¼å¾ˆè§„èŒƒï¼Œé€»è¾‘æµç¨‹é¡ºç•…ï¼Œé€‚åˆæ–°æ‰‹å¿«é€Ÿç†è§£è´ªå¿ƒç­–ç•¥çš„å®ç°ç»†èŠ‚ã€‚


### é¢˜è§£ä¸‰ï¼šä½œè€…å¼•é¢†å¤©ä¸‹ï¼ˆèµï¼š1ï¼‰
* **ç‚¹è¯„**ï¼šè¿™é¢˜è§£ç”¨äº†**åŒæŒ‡é’ˆæŠ€å·§**ï¼Œæ•ˆç‡æ›´é«˜ï¼ä½œè€…ç”¨`i`å’Œ`j`ä¸¤ä¸ªæŒ‡é’ˆæ‰¾æœ€è¿œçš„`j`ï¼Œç¡®ä¿`p[i]`åˆ°`p[j+1]`çš„æœ€çŸ­è·¯å¾„å¿…é¡»ç»è¿‡`p[j]`ï¼Œç„¶åé€‰`p[j]`ã€‚è¿™ç§æ–¹æ³•å‡å°‘äº†éå†æ¬¡æ•°ï¼Œé€‚åˆå¤„ç†å¤§é•¿åº¦åºåˆ—ï¼Œå¯¹æƒ³æå‡æ•ˆç‡çš„åŒå­¦å¾ˆæœ‰å¯å‘ã€‚


## 3. æ ¸å¿ƒéš¾ç‚¹è¾¨æä¸è§£é¢˜ç­–ç•¥

### å…³é”®ç‚¹1ï¼šé¢˜æ„è½¬åŒ–â€”â€”ç†è§£â€œå¥½çš„å­åºåˆ—â€çš„æ¡ä»¶
- **åˆ†æ**ï¼šå¾ˆå¤šåŒå­¦å¡åœ¨è¿™é‡Œï¼Œå…¶å®â€œpæ˜¯ç»è¿‡vçš„æœ€çŸ­è·¯å¾„ä¹‹ä¸€â€ç­‰ä»·äºï¼š**å­åºåˆ—ä¸­ä»»æ„ä¸¤ä¸ªè¿ç»­ç‚¹`v_a`ï¼ˆåŸè·¯å¾„`p_x`ï¼‰å’Œ`v_b`ï¼ˆåŸè·¯å¾„`p_y`ï¼‰çš„æœ€çŸ­è·¯å¾„é•¿åº¦ç­‰äºåŸè·¯å¾„æ­¥æ•°`y-x`**ã€‚åªæœ‰è¿™æ ·ï¼ŒåŸè·¯å¾„çš„è¿™æ®µæ‰æ˜¯æœ€çŸ­çš„ï¼Œä¸ä¼šè¢«æ›´çŸ­çš„è·¯å¾„æ›¿ä»£ã€‚  
- ğŸ’¡ **å­¦ä¹ ç¬”è®°**ï¼šæŠŠæŠ½è±¡æ¡ä»¶è½¬åŒ–ä¸ºæ•°å­¦è¡¨è¾¾å¼ï¼Œæ˜¯è§£é¢˜çš„ç¬¬ä¸€æ­¥ï¼


### å…³é”®ç‚¹2ï¼šè´ªå¿ƒç­–ç•¥çš„æ­£ç¡®æ€§â€”â€”ä¸ºä»€ä¹ˆè¿™æ ·é€‰èƒ½å¾—åˆ°æœ€çŸ­å­åºåˆ—
- **åˆ†æ**ï¼šè´ªå¿ƒçš„æ ¸å¿ƒæ˜¯â€œå°½å¯èƒ½å°‘é€‰ç‚¹â€ï¼Œåªåœ¨â€œä¸å¾—ä¸é€‰â€çš„æ—¶å€™é€‰ï¼ˆæ¯”å¦‚æœ€çŸ­è·¯å¾„æ›´çŸ­ï¼‰ã€‚å› ä¸ºæ¯æ¬¡é€‰ç‚¹éƒ½æ˜¯â€œå¿…é¡»çš„â€ï¼Œæ‰€ä»¥æœ€åå¾—åˆ°çš„å­åºåˆ—ä¸€å®šæ˜¯æœ€çŸ­çš„ã€‚  
- ğŸ’¡ **å­¦ä¹ ç¬”è®°**ï¼šè´ªå¿ƒç­–ç•¥è¦è¯æ˜æ­£ç¡®æ€§ï¼Œæœ¬é¢˜ä¸­â€œå¿…é¡»é€‰â€çš„é€»è¾‘ç¡®ä¿äº†æœ€ä¼˜è§£ã€‚


### å…³é”®ç‚¹3ï¼šå¤„ç†å¤§é•¿åº¦åºåˆ—â€”â€”ç¡®ä¿ç®—æ³•æ—¶é—´å¤æ‚åº¦
- **åˆ†æ**ï¼šåŸè·¯å¾„é•¿åº¦`m`å¯ä»¥åˆ°1e6ï¼Œæ‰€ä»¥ç®—æ³•å¿…é¡»æ˜¯**çº¿æ€§æ—¶é—´**ï¼ˆO(m)ï¼‰ã€‚Floydæ˜¯O(nÂ³)ï¼ˆnâ‰¤100ï¼Œå®Œå…¨å¯è¡Œï¼‰ï¼Œè´ªå¿ƒéå†æ˜¯O(m)ï¼Œæ•´ä½“æ—¶é—´å¤æ‚åº¦æ˜¯O(nÂ³ + m)ï¼Œèƒ½å¤„ç†å¤§æ•°æ®ã€‚  
- ğŸ’¡ **å­¦ä¹ ç¬”è®°**ï¼šå¤§æ•°æ®é‡æ—¶ï¼Œä¼˜å…ˆé€‰çº¿æ€§æ—¶é—´çš„ç®—æ³•ï¼


### âœ¨ è§£é¢˜æŠ€å·§æ€»ç»“
1. **Floydé¢„å¤„ç†**ï¼šèŠ‚ç‚¹æ•°å°‘çš„æ—¶å€™ï¼Œç”¨Floydç®—æ‰€æœ‰ç‚¹å¯¹çš„æœ€çŸ­è·¯å¾„ï¼Œåç»­æŸ¥è¯¢å¾ˆå¿«ã€‚  
2. **è´ªå¿ƒç­–ç•¥**ï¼šæ±‚â€œæœ€çŸ­â€â€œæœ€å°‘â€æ—¶ï¼Œå…ˆæƒ³è´ªå¿ƒï¼Œå†è¯æ˜æ­£ç¡®æ€§ã€‚  
3. **åŒæŒ‡é’ˆæŠ€å·§**ï¼šæ‰¾æœ€è¿œç‚¹æ—¶ï¼Œç”¨åŒæŒ‡é’ˆå‡å°‘éå†æ¬¡æ•°ï¼Œæå‡æ•ˆç‡ã€‚  


## 4. C++æ ¸å¿ƒä»£ç å®ç°èµæ

### æœ¬é¢˜é€šç”¨æ ¸å¿ƒC++å®ç°å‚è€ƒ
* **è¯´æ˜**ï¼šç»¼åˆå¤šä¸ªä¼˜è´¨é¢˜è§£çš„æ€è·¯ï¼Œé€»è¾‘æ¸…æ™°ï¼Œæ•ˆç‡é«˜ã€‚

```cpp
#include <iostream>
#include <vector>
#include <string>
#include <cstring>
using namespace std;

const int MAXN = 105;
const int INF = 0x3f3f3f3f;
int dis[MAXN][MAXN];
int p[1000005]; // åŸè·¯å¾„ï¼Œmâ‰¤1e6

int main() {
    ios::sync_with_stdio(false);
    cin.tie(nullptr);

    int n, m;
    cin >> n;
    // åˆå§‹åŒ–é‚»æ¥çŸ©é˜µï¼šæœ‰è¾¹â†’1ï¼Œæ— è¾¹â†’INFï¼Œè‡ªå·±â†’0
    for (int i = 1; i <= n; ++i) {
        string s;
        cin >> s;
        for (int j = 1; j <= n; ++j) {
            dis[i][j] = (s[j-1] == '1') ? 1 : INF;
        }
        dis[i][i] = 0;
    }
    // Floydç®—æ³•ï¼šæ›´æ–°æ‰€æœ‰ç‚¹å¯¹çš„æœ€çŸ­è·¯å¾„
    for (int k = 1; k <= n; ++k) {
        for (int i = 1; i <= n; ++i) {
            for (int j = 1; j <= n; ++j) {
                if (dis[i][k] != INF && dis[k][j] != INF) {
                    dis[i][j] = min(dis[i][j], dis[i][k] + dis[k][j]);
                }
            }
        }
    }
    // è¯»å–åŸè·¯å¾„
    cin >> m;
    for (int i = 1; i <= m; ++i) {
        cin >> p[i];
    }
    // è´ªå¿ƒé€‰å­åºåˆ—
    vector<int> res;
    res.push_back(p[1]); // ç¬¬ä¸€ä¸ªç‚¹å¿…é€‰
    int last = 1; // ä¸Šä¸€ä¸ªé€‰ä¸­çš„ç‚¹çš„ç´¢å¼•
    for (int i = 2; i <= m; ++i) {
        // å¦‚æœæœ€çŸ­è·¯å¾„<åŸè·¯å¾„æ­¥æ•°ï¼Œå¿…é¡»é€‰p[i-1]
        if (dis[p[last]][p[i]] < (i - last)) {
            res.push_back(p[i-1]);
            last = i - 1;
        }
    }
    res.push_back(p[m]); // æœ€åä¸€ä¸ªç‚¹å¿…é€‰
    // è¾“å‡ºç»“æœ
    cout << res.size() << '\n';
    for (size_t i = 0; i < res.size(); ++i) {
        if (i > 0) cout << ' ';
        cout << res[i];
    }
    cout << '\n';

    return 0;
}
```

* **ä»£ç è§£è¯»æ¦‚è¦**ï¼š  
  1. **åˆå§‹åŒ–**ï¼šè¯»å…¥å›¾çš„é‚»æ¥çŸ©é˜µï¼Œè®¾ç½®è¾¹çš„è·ç¦»ã€‚  
  2. **Floydé¢„å¤„ç†**ï¼šç”¨ä¸­é—´ç‚¹`k`æ›´æ–°æ‰€æœ‰ç‚¹å¯¹çš„æœ€çŸ­è·¯å¾„ã€‚  
  3. **è´ªå¿ƒéå†**ï¼šä»ç¬¬ä¸€ä¸ªç‚¹å¼€å§‹ï¼Œç»´æŠ¤`last`ï¼Œåˆ¤æ–­æ˜¯å¦é€‰ç‚¹ã€‚  
  4. **è¾“å‡º**ï¼šè¾“å‡ºç»“æœåºåˆ—çš„é•¿åº¦å’Œå†…å®¹ã€‚


### é¢˜è§£ä¸€ï¼ˆte5555ï¼‰æ ¸å¿ƒä»£ç ç‰‡æ®µèµæ
* **äº®ç‚¹**ï¼šç”¨`cur`ç´¯ç§¯åŸè·¯å¾„æ­¥æ•°ï¼Œé€»è¾‘ç›´è§‚ã€‚
* **æ ¸å¿ƒä»£ç ç‰‡æ®µ**ï¼š
```cpp
v.push_back(p[1]);
int las = p[1];
int cur = 0;
for (int i = 2; i <= m; i++) {
    cur += dis[p[i-1]][p[i]]; // æ¯æ­¥åŠ 1ï¼Œcurç­‰äºi-last
    if (dis[las][p[i]] < cur) {
        las = p[i-1];
        v.push_back(las);
        cur = dis[las][p[i]]; // é‡ç½®ä¸º1ï¼ˆp[i-1]åˆ°p[i]æœ‰è¾¹ï¼‰
    }
}
v.push_back(p[m]);
```
* **ä»£ç è§£è¯»**ï¼š  
  - `las`æ˜¯ä¸Šä¸€ä¸ªé€‰ä¸­çš„ç‚¹çš„å€¼ï¼Œ`cur`æ˜¯åŸè·¯å¾„ä¸­ä»`las`åˆ°`p[i]`çš„æ­¥æ•°ã€‚  
  - å½“`dis[las][p[i]] < cur`æ—¶ï¼Œè¯´æ˜æœ€çŸ­è·¯å¾„æ›´çŸ­ï¼Œå¿…é¡»é€‰`p[i-1]`ï¼Œé‡ç½®`las`å’Œ`cur`ã€‚  
* ğŸ’¡ **å­¦ä¹ ç¬”è®°**ï¼šç”¨å˜é‡ç´¯ç§¯æ­¥æ•°ï¼Œèƒ½ç®€åŒ–é€»è¾‘åˆ¤æ–­ï¼


### é¢˜è§£ä¸‰ï¼ˆå¼•é¢†å¤©ä¸‹ï¼‰æ ¸å¿ƒä»£ç ç‰‡æ®µèµæ
* **äº®ç‚¹**ï¼šåŒæŒ‡é’ˆæ‰¾æœ€è¿œç‚¹ï¼Œæ•ˆç‡æ›´é«˜ã€‚
* **æ ¸å¿ƒä»£ç ç‰‡æ®µ**ï¼š
```cpp
int i=1,j=2; ans.push_back(p[1]);
for (;i<=m&&j<=m;){
    // æ‰¾æœ€è¿œçš„jï¼Œä½¿å¾—p[i]åˆ°p[j+1]çš„æœ€çŸ­è·¯å¾„å¿…é¡»ç»è¿‡p[j]
    while(j<m&&a[p[i]][p[j+1]]>=a[p[i]][p[j]]+1) j++;
    ans.push_back(p[i=j++]); // é€‰p[j]ï¼Œæ›´æ–°iä¸ºj
}
```
* **ä»£ç è§£è¯»**ï¼š  
  - `i`æ˜¯ä¸Šä¸€ä¸ªé€‰ä¸­çš„ç‚¹çš„ç´¢å¼•ï¼Œ`j`æ‰¾æœ€è¿œçš„ç‚¹ï¼Œç¡®ä¿`p[i]`åˆ°`p[j+1]`çš„æœ€çŸ­è·¯å¾„å¿…é¡»ç»è¿‡`p[j]`ã€‚  
  - é€‰`p[j]`ï¼Œæ›´æ–°`i`ä¸º`j`ï¼Œç»§ç»­æ‰¾ä¸‹ä¸€ä¸ª`j`ã€‚  
* ğŸ’¡ **å­¦ä¹ ç¬”è®°**ï¼šåŒæŒ‡é’ˆèƒ½å‡å°‘éå†æ¬¡æ•°ï¼Œé€‚åˆå¤§é•¿åº¦åºåˆ—ï¼


## 5. ç®—æ³•å¯è§†åŒ–ï¼šåƒç´ åŠ¨ç”»æ¼”ç¤º (æ ¸å¿ƒéƒ¨åˆ†)

### åŠ¨ç”»æ¼”ç¤ºä¸»é¢˜ï¼šåƒç´ æ¢é™©å®¶çš„â€œæœ€çŸ­è·¯å¾„å­åºåˆ—â€å†’é™©ï¼ˆFCçº¢ç™½æœºé£æ ¼ï¼‰


### æ ¸å¿ƒæ¼”ç¤ºå†…å®¹
å±•ç¤ºå›¾çš„ç»“æ„ã€åŸè·¯å¾„çš„èµ°æ³•ï¼Œä»¥åŠè´ªå¿ƒé€‰æ‹©å­åºåˆ—çš„è¿‡ç¨‹ï¼Œçªå‡ºâ€œå¿…é¡»é€‰ç‚¹â€çš„å…³é”®å†³ç­–ã€‚


### è®¾è®¡æ€è·¯ç®€è¿°
ç”¨8ä½åƒç´ é£æ ¼è¥é€ å¤å¤æ¸¸æˆæ„Ÿï¼Œç”¨**é¢œè‰²+éŸ³æ•ˆ**å¼ºåŒ–è®°å¿†ï¼š  
- èŠ‚ç‚¹ç”¨å½©è‰²æ–¹å—ï¼ˆ1çº¢ã€2è“ã€3ç»¿ã€4é»„ï¼‰ï¼Œè¾¹ç”¨ç™½è‰²ç®­å¤´ã€‚  
- é€‰ä¸­çš„èŠ‚ç‚¹é—ªçƒ+â€œå®â€å£°ï¼ŒåŸè·¯å¾„ç”¨çº¢è‰²ç®­å¤´åŠ¨æ€èµ°ã€‚  
- åŠ¨ç”»æ”¯æŒâ€œå•æ­¥æ‰§è¡Œâ€â€œè‡ªåŠ¨æ’­æ”¾â€ï¼Œè®©ä½ çœ‹æ¸…æ¯ä¸€æ­¥ã€‚


### åŠ¨ç”»å¸§æ­¥éª¤ä¸äº¤äº’å…³é”®ç‚¹
1. **åœºæ™¯åˆå§‹åŒ–**ï¼ˆFCé£æ ¼ï¼‰ï¼š  
   - å·¦ä¾§æ˜¾ç¤ºå›¾çš„åƒç´ ç»“æ„ï¼šèŠ‚ç‚¹1ï¼ˆçº¢ï¼‰â†’2ï¼ˆè“ï¼‰ã€1â†’3ï¼ˆç»¿ï¼‰ï¼Œ2â†’3ï¼Œ3â†’4ï¼ˆé»„ï¼‰ï¼Œ4â†’1ã€‚  
   - å³ä¾§æ§åˆ¶é¢æ¿ï¼šâ€œå¼€å§‹/æš‚åœâ€â€œå•æ­¥â€â€œé‡ç½®â€æŒ‰é’®ï¼Œé€Ÿåº¦æ»‘å—ï¼ˆ1-5æ¡£ï¼‰ï¼Œç»“æœåˆ—è¡¨ã€‚  
   - èƒŒæ™¯æ’­æ”¾8ä½BGMï¼ˆå¦‚ã€Šè¶…çº§é©¬é‡Œå¥¥ã€‹ï¼‰ã€‚

2. **åŸè·¯å¾„æ¼”ç¤º**ï¼š  
   - çº¢è‰²ç®­å¤´åŠ¨æ€èµ°1â†’2â†’3â†’4ï¼Œæ¯ä¸ªæ­¥éª¤åœé¡¿0.5ç§’ï¼Œæ’­æ”¾â€œè¸â€å£°ã€‚  
   - èŠ‚ç‚¹1â†’2â†’3â†’4ä¾æ¬¡é—ªçƒï¼Œæç¤ºåŸè·¯å¾„é¡ºåºã€‚

3. **è´ªå¿ƒé€‰ç‚¹æ¼”ç¤º**ï¼š  
   - åˆå§‹åŒ–ï¼šç»“æœåˆ—è¡¨[1]ï¼ŒèŠ‚ç‚¹1é—ªçƒã€‚  
   - éå†i=2ï¼ˆèŠ‚ç‚¹2ï¼‰ï¼šåŸè·¯å¾„æ­¥æ•°1ï¼Œæœ€çŸ­è·¯å¾„1ï¼ˆç›¸ç­‰ï¼‰ï¼Œä¸é€‰ï¼ŒèŠ‚ç‚¹2ä¸é—ªçƒã€‚  
   - éå†i=3ï¼ˆèŠ‚ç‚¹3ï¼‰ï¼šåŸè·¯å¾„æ­¥æ•°2ï¼Œæœ€çŸ­è·¯å¾„1ï¼ˆå°äºï¼‰ï¼ŒèŠ‚ç‚¹2é—ªçƒ+â€œå®â€å£°ï¼Œç»“æœåˆ—è¡¨æ›´æ–°ä¸º[1,2]ã€‚  
   - éå†i=4ï¼ˆèŠ‚ç‚¹4ï¼‰ï¼šåŸè·¯å¾„æ­¥æ•°2ï¼Œæœ€çŸ­è·¯å¾„2ï¼ˆç›¸ç­‰ï¼‰ï¼Œä¸é€‰ã€‚  
   - æœ€ååŠ å…¥èŠ‚ç‚¹4ï¼Œç»“æœåˆ—è¡¨[1,2,4]ï¼Œæ’­æ”¾â€œèƒœåˆ©â€éŸ³æ•ˆï¼ˆå¦‚ã€Šé­‚æ–—ç½—ã€‹é€šå…³éŸ³ä¹ï¼‰ã€‚

4. **äº¤äº’æ§åˆ¶**ï¼š  
   - â€œå•æ­¥æ‰§è¡Œâ€ï¼šç‚¹å‡»åæ‰§è¡Œä¸‹ä¸€æ­¥ï¼Œçªå‡ºå½“å‰æ“ä½œçš„èŠ‚ç‚¹å’Œæ¡ä»¶åˆ¤æ–­ã€‚  
   - â€œè‡ªåŠ¨æ’­æ”¾â€ï¼šæŒ‰æ»‘å—é€Ÿåº¦è‡ªåŠ¨æ‰§è¡Œæ‰€æœ‰æ­¥éª¤ã€‚  
   - â€œé‡ç½®â€ï¼šæ¢å¤åˆå§‹çŠ¶æ€ï¼Œé‡æ–°æ¼”ç¤ºã€‚


### æ—ç™½æç¤º
- åˆå§‹åŒ–æ—¶ï¼šâ€œå·¦è¾¹çš„å›¾æ˜¯æ ·ä¾‹1çš„ç»“æ„ï¼ŒèŠ‚ç‚¹1åˆ°2ã€3æœ‰è¾¹ï¼ŒèŠ‚ç‚¹2åˆ°3æœ‰è¾¹ï¼ŒèŠ‚ç‚¹3åˆ°4æœ‰è¾¹ï¼ŒèŠ‚ç‚¹4åˆ°1æœ‰è¾¹ã€‚â€  
- éå†i=3æ—¶ï¼šâ€œç°åœ¨æ£€æŸ¥èŠ‚ç‚¹1åˆ°3çš„æœ€çŸ­è·¯å¾„â€”â€”åŸè·¯å¾„è¦èµ°2æ­¥ï¼ˆ1â†’2â†’3ï¼‰ï¼Œä½†æœ€çŸ­è·¯å¾„åªè¦1æ­¥ï¼ˆ1â†’3ï¼‰ï¼æ‰€ä»¥å¿…é¡»é€‰èŠ‚ç‚¹2ï¼Œå¦åˆ™åŸè·¯å¾„å°±ä¸æ˜¯æœ€çŸ­è·¯å¾„äº†ã€‚â€  
- ç»“æŸæ—¶ï¼šâ€œæ­å–œï¼æˆ‘ä»¬æ‰¾åˆ°äº†æœ€çŸ­å­åºåˆ—[1,2,4]ï¼Œå®Œæˆä»»åŠ¡ï¼â€


## 6. æ‹“å±•ç»ƒä¹ ä¸ç›¸ä¼¼é—®é¢˜æ€è€ƒ

### é€šç”¨æ€è·¯/æŠ€å·§è¿ç§»
- **Floydé¢„å¤„ç†**ï¼šé€‚ç”¨äºèŠ‚ç‚¹æ•°å°‘çš„å›¾ï¼Œæ¯”å¦‚ç¤¾äº¤ç½‘ç»œçš„æœ€çŸ­æœ‹å‹é“¾ã€åŸå¸‚é—´çš„æœ€çŸ­è·¯çº¿ã€‚  
- **è´ªå¿ƒç­–ç•¥**ï¼šé€‚ç”¨äºâ€œæœ€çŸ­â€â€œæœ€å°‘â€é—®é¢˜ï¼Œæ¯”å¦‚æ´»åŠ¨é€‰æ‹©ã€ç¡¬å¸æ‰¾é›¶ï¼ˆå½“ç¡¬å¸é¢é¢æ»¡è¶³è´ªå¿ƒæ¡ä»¶æ—¶ï¼‰ã€‚  
- **åŒæŒ‡é’ˆ**ï¼šé€‚ç”¨äºæ‰¾æœ€è¿œç‚¹çš„é—®é¢˜ï¼Œæ¯”å¦‚æœ€é•¿æ— é‡å¤å­ä¸²ã€åˆå¹¶ä¸¤ä¸ªæœ‰åºæ•°ç»„ã€‚


### ç»ƒä¹ æ¨è (æ´›è°·)
1. **æ´›è°· P1119 ç¾åé‡å»º**ï¼ˆP1119ï¼‰  
   - æ¨èç†ç”±ï¼šè€ƒå¯ŸFloydç®—æ³•çš„åŠ¨æ€åº”ç”¨ï¼Œå·©å›ºæœ€çŸ­è·¯å¾„é¢„å¤„ç†çš„ç†è§£ã€‚  
2. **æ´›è°· P1339 çƒ­æµª**ï¼ˆP1339ï¼‰  
   - æ¨èç†ç”±ï¼šè€ƒå¯ŸDijkstraç®—æ³•ï¼Œä¸Floydäº’è¡¥ï¼Œç†Ÿæ‚‰ä¸åŒçš„æœ€çŸ­è·¯å¾„ç®—æ³•ã€‚  
3. **æ´›è°· P2850 è™«æ´Wormholes**ï¼ˆP2850ï¼‰  
   - æ¨èç†ç”±ï¼šè€ƒå¯Ÿå›¾è®ºçš„ç¯æ£€æµ‹å’Œæœ€çŸ­è·¯å¾„ï¼Œæå‡ç»¼åˆè§£å†³èƒ½åŠ›ã€‚  
4. **æ´›è°· P3817 å°Açš„ç³–æœ**ï¼ˆP3817ï¼‰  
   - æ¨èç†ç”±ï¼šè€ƒå¯Ÿè´ªå¿ƒç­–ç•¥ï¼Œå·©å›ºâ€œé€‰æœ€å°‘â€çš„æ€è·¯ã€‚


## 7. å­¦ä¹ å¿ƒå¾—ä¸ç»éªŒåˆ†äº« (è‹¥æœ‰)

### å‚è€ƒç»éªŒï¼ˆæ¥è‡ªte5555ï¼‰
> â€œé¢˜æ„çš„ç¡®å¾ˆéš¾ç†è§£ï¼Œè½¬åŒ–é¢˜æ„æ˜¯å…³é”®ã€‚æœ€åˆæˆ‘ä¹Ÿå¡äº†å¾ˆä¹…ï¼Œåæ¥æƒ³æ˜ç™½â€˜å¥½çš„å­åºåˆ—â€™çš„æ¡ä»¶æ˜¯å­åºåˆ—ä¸­çš„è¿ç»­ç‚¹çš„æœ€çŸ­è·¯å¾„ç­‰äºåŸè·¯å¾„æ­¥æ•°ï¼Œé—®é¢˜å°±è¿åˆƒè€Œè§£äº†ã€‚â€

**ç‚¹è¯„**ï¼šå¾ˆå¤šç®—æ³•é¢˜çš„éš¾ç‚¹åœ¨é¢˜æ„ç†è§£ï¼é‡åˆ°æŠ½è±¡æ¡ä»¶æ—¶ï¼Œå»ºè®®ç»“åˆæ ·ä¾‹åˆ†æï¼ŒæŠŠæ¡ä»¶è½¬åŒ–ä¸ºæ•°å­¦è¡¨è¾¾å¼â€”â€”æ¯”å¦‚æ ·ä¾‹1ä¸­ï¼Œå­åºåˆ—1â†’2â†’4çš„è¿ç»­ç‚¹1â†’2çš„æœ€çŸ­è·¯å¾„æ˜¯1ï¼ˆç­‰äºåŸè·¯å¾„æ­¥æ•°1ï¼‰ï¼Œ2â†’4çš„æœ€çŸ­è·¯å¾„æ˜¯2ï¼ˆç­‰äºåŸè·¯å¾„æ­¥æ•°2ï¼‰ï¼Œæ‰€ä»¥ç¬¦åˆæ¡ä»¶ã€‚


### å‚è€ƒç»éªŒï¼ˆæ¥è‡ªå¼•é¢†å¤©ä¸‹ï¼‰
> â€œæˆ‘ä¸€å¼€å§‹ç”¨äº†åŠ¨æ€è§„åˆ’ï¼Œä½†å‘ç°æ—¶é—´å¤æ‚åº¦è¿‡é«˜ï¼Œåæ¥æ”¹ç”¨two-pointeræŠ€å·§ï¼Œæ•ˆç‡æå‡äº†å¾ˆå¤šã€‚â€

**ç‚¹è¯„**ï¼šç®—æ³•é€‰æ‹©è¦åŒ¹é…æ•°æ®è§„æ¨¡ï¼åŠ¨æ€è§„åˆ’çš„O(mn)æ—¶é—´å¤æ‚åº¦å¯¹1e6çš„mæ¥è¯´ä¼šè¶…æ—¶ï¼Œè€ŒåŒæŒ‡é’ˆçš„O(m)æ—¶é—´å¤æ‚åº¦åˆ™åˆšå¥½åˆé€‚ã€‚é‡åˆ°å¤§æ•°æ®é‡æ—¶ï¼Œä¼˜å…ˆé€‰çº¿æ€§æ—¶é—´çš„ç®—æ³•ï¼


## ç»“è®º
é€šè¿‡æœ¬æ¬¡åˆ†æï¼Œæˆ‘ä»¬æŒæ¡äº†**å›¾è®ºï¼ˆFloydï¼‰+ è´ªå¿ƒç­–ç•¥**çš„ç»“åˆåº”ç”¨ï¼Œå­¦ä¼šäº†å¦‚ä½•å°†æŠ½è±¡é¢˜æ„è½¬åŒ–ä¸ºå¯è®¡ç®—çš„é€»è¾‘ï¼Œå¦‚ä½•ç”¨é«˜æ•ˆçš„ç®—æ³•å¤„ç†å¤§é•¿åº¦åºåˆ—ã€‚å¸Œæœ›è¿™ä»½æŒ‡å—èƒ½å¸®åŠ©ä½ ä¸¾ä¸€åä¸‰ï¼Œåœ¨åç»­çš„ç¼–ç¨‹æŒ‘æˆ˜ä¸­æ›´ä¸Šä¸€å±‚æ¥¼ï¼ğŸ’ª

---
å¤„ç†ç”¨æ—¶ï¼š275.47ç§’
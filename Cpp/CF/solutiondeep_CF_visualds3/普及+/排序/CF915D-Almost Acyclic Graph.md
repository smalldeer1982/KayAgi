# é¢˜ç›®ä¿¡æ¯

# Almost Acyclic Graph

## é¢˜ç›®æè¿°

You are given a [directed graph](https://en.wikipedia.org/wiki/Directed_graph) consisting of $ n $ vertices and $ m $ edges (each edge is directed, so it can be traversed in only one direction). You are allowed to remove at most one edge from it.

Can you make this graph [acyclic](https://en.wikipedia.org/wiki/Directed_acyclic_graph) by removing at most one edge from it? A directed graph is called acyclic iff it doesn't contain any cycle (a non-empty path that starts and ends in the same vertex).

## è¯´æ˜/æç¤º

In the first example you can remove edge ![](https://cdn.luogu.com.cn/upload/vjudge_pic/CF915D/f1138b32236a89525fad2b8c02b9cbfbd546dfad.png), and the graph becomes acyclic.

In the second example you have to remove at least two edges (for example, ![](https://cdn.luogu.com.cn/upload/vjudge_pic/CF915D/7480c546ca7ee72615c3ded7d769355b1c864f93.png) and ![](https://cdn.luogu.com.cn/upload/vjudge_pic/CF915D/f1138b32236a89525fad2b8c02b9cbfbd546dfad.png)) in order to make the graph acyclic.

## æ ·ä¾‹ #1

### è¾“å…¥

```
3 4
1 2
2 3
3 2
3 1
```

### è¾“å‡º

```
YES
```

## æ ·ä¾‹ #2

### è¾“å…¥

```
5 6
1 2
2 3
3 2
3 1
2 1
4 5
```

### è¾“å‡º

```
NO
```

# AIåˆ†æç»“æœ

# ğŸ’¡ Kayçš„C++ç®—æ³•è§£æï¼šAlmost Acyclic Graph æ·±å…¥å­¦ä¹ æŒ‡å— ğŸ’¡


## 1. é¢˜ç›®è§£è¯»ä¸æ ¸å¿ƒç®—æ³•è¯†åˆ«

âœ¨ **æœ¬é¢˜ä¸»è¦è€ƒå¯Ÿ**ï¼šæ‹“æ‰‘æ’åºï¼ˆåˆ¤ç¯ï¼‰+ æšä¸¾ä¼˜åŒ–  

ğŸ—£ï¸ **åˆæ­¥åˆ†æ**ï¼š  
è§£å†³â€œAlmost Acyclic Graphâ€çš„å…³é”®ï¼Œæ˜¯åˆ¤æ–­**èƒ½å¦é€šè¿‡åˆ é™¤æœ€å¤šä¸€æ¡è¾¹è®©æœ‰å‘å›¾æ— ç¯**ã€‚æ— ç¯å›¾çš„ç»å…¸åˆ¤æ–­æ–¹æ³•æ˜¯**æ‹“æ‰‘æ’åº**â€”â€”å¦‚æœå›¾èƒ½ç”ŸæˆåŒ…å«æ‰€æœ‰èŠ‚ç‚¹çš„æ‹“æ‰‘åºåˆ—ï¼ˆå³æ‰€æœ‰èŠ‚ç‚¹éƒ½èƒ½æŒ‰ä¾èµ–é¡ºåºæ’åˆ—ï¼Œæ²¡æœ‰å¾ªç¯ä¾èµ–ï¼‰ï¼Œåˆ™å›¾æ— ç¯ã€‚  

ä½†ç›´æ¥æšä¸¾æ¯ä¸€æ¡è¾¹ï¼ˆåˆ é™¤åè·‘æ‹“æ‰‘ï¼‰çš„æ—¶é—´å¤æ‚åº¦æ˜¯$O(m(n+m))$ï¼ˆ$m$æ˜¯è¾¹æ•°ï¼‰ï¼Œå¯¹äºå¤§è¾“å…¥ä¼šè¶…æ—¶ã€‚**ä¼˜åŒ–ç‚¹**åœ¨äºï¼šåˆ é™¤ä¸€æ¡è¾¹çš„æœ¬è´¨æ˜¯**è®©è¯¥è¾¹çš„ç»ˆç‚¹å…¥åº¦å‡1**ã€‚å¦‚æœå¤šæ¡è¾¹æŒ‡å‘åŒä¸€ä¸ªèŠ‚ç‚¹ï¼Œåˆ é™¤å…¶ä¸­ä»»æ„ä¸€æ¡çš„æ•ˆæœéƒ½æ˜¯â€œè¯¥èŠ‚ç‚¹å…¥åº¦å‡1â€ã€‚å› æ­¤ï¼Œæˆ‘ä»¬å¯ä»¥**æšä¸¾æ¯ä¸ªèŠ‚ç‚¹ï¼ˆå…¥åº¦ä¸ä¸º0æ—¶ï¼‰ï¼Œå°†å…¶å…¥åº¦å‡1ï¼Œå†è·‘æ‹“æ‰‘æ’åº**ï¼Œè¿™æ ·å¤æ‚åº¦é™åˆ°$O(n(n+m))$ï¼ˆ$n$æ˜¯èŠ‚ç‚¹æ•°ï¼Œé€šå¸¸$n<m$ï¼‰ï¼Œæ•ˆç‡æ›´é«˜ã€‚  

**æ ¸å¿ƒç®—æ³•æµç¨‹**ï¼š  
1. å…ˆè·‘ä¸€æ¬¡æ‹“æ‰‘æ’åºï¼Œåˆ¤æ–­åŸå›¾æ˜¯å¦å·²ç»æ— ç¯ï¼ˆæ— éœ€åˆ è¾¹ï¼‰ã€‚  
2. è‹¥åŸå›¾æœ‰ç¯ï¼Œæšä¸¾æ¯ä¸ªèŠ‚ç‚¹$i$ï¼š  
   - å°†$i$çš„å…¥åº¦å‡1ï¼ˆæ¨¡æ‹Ÿåˆ é™¤ä¸€æ¡æŒ‡å‘$i$çš„è¾¹ï¼‰ã€‚  
   - è·‘æ‹“æ‰‘æ’åºï¼Œè‹¥èƒ½ç”Ÿæˆå®Œæ•´åºåˆ—ï¼Œåˆ™è¿”å›â€œYESâ€ã€‚  
   - æ¢å¤$i$çš„å…¥åº¦ï¼ˆå›æº¯ï¼‰ï¼Œç»§ç»­æšä¸¾ä¸‹ä¸€ä¸ªèŠ‚ç‚¹ã€‚  
3. è‹¥æ‰€æœ‰æšä¸¾éƒ½å¤±è´¥ï¼Œè¿”å›â€œNOâ€ã€‚  

**å¯è§†åŒ–è®¾è®¡æ€è·¯**ï¼š  
ç”¨**8ä½åƒç´ é£æ ¼**å±•ç¤ºå›¾ç»“æ„ï¼ˆèŠ‚ç‚¹æ˜¯å½©è‰²æ–¹å—ï¼Œè¾¹æ˜¯ç®­å¤´ï¼‰ã€‚åŠ¨ç”»æ­¥éª¤ï¼š  
- **åˆå§‹åŒ–**ï¼šæ˜¾ç¤ºåŸå›¾ï¼ŒèŠ‚ç‚¹ä¸‹æ–¹æ ‡æ³¨å…¥åº¦ã€‚  
- **æšä¸¾èŠ‚ç‚¹**ï¼šå½“å‰æšä¸¾çš„èŠ‚ç‚¹é—ªçƒï¼ˆå¦‚çº¢è‰²ï¼‰ï¼Œæ—è¾¹å¼¹å‡ºæ–‡å­—â€œå°è¯•å‡å°‘èŠ‚ç‚¹$i$çš„å…¥åº¦â€ã€‚  
- **æ‹“æ‰‘è¿‡ç¨‹**ï¼š  
  - å…¥åº¦ä¸º0çš„èŠ‚ç‚¹â€œè·³è¿›â€é˜Ÿåˆ—ï¼ˆåŠ¨ç”»ï¼šæ–¹å—æ»‘å…¥é˜Ÿåˆ—åŒºåŸŸï¼‰ï¼Œä¼´éšâ€œå®â€çš„éŸ³æ•ˆã€‚  
  - èŠ‚ç‚¹å‡ºé˜Ÿæ—¶ï¼Œå…¶æ‰€æœ‰é‚»æ¥èŠ‚ç‚¹çš„å…¥åº¦å‡1ï¼ˆåŠ¨ç”»ï¼šé‚»æ¥èŠ‚ç‚¹çš„å…¥åº¦æ•°å­—å‡1ï¼Œé¢œè‰²å˜æµ…ï¼‰ã€‚  
  - è‹¥æ‰€æœ‰èŠ‚ç‚¹éƒ½å‡ºé˜Ÿï¼ˆæ— ç¯ï¼‰ï¼Œæ’­æ”¾â€œèƒœåˆ©â€éŸ³æ•ˆï¼Œå±å¹•æ˜¾ç¤ºâ€œæˆåŠŸï¼â€ï¼›å¦åˆ™ï¼Œæ’­æ”¾â€œå¤±è´¥â€éŸ³æ•ˆï¼Œæ¢å¤å…¥åº¦ç»§ç»­æšä¸¾ã€‚  


## 2. ç²¾é€‰ä¼˜è´¨é¢˜è§£å‚è€ƒ

### é¢˜è§£ä¸€ï¼šï¼ˆæ¥æºï¼šé’çƒŸç»•æŒ‡æŸ”ï¼Œèµ14ï¼‰  
* **ç‚¹è¯„**ï¼š  
  æ­¤é¢˜è§£çš„**æ€è·¯ç®€æ´æ€§**å’Œ**ç®—æ³•æœ‰æ•ˆæ€§**æ˜¯æœ€å¤§äº®ç‚¹ã€‚ä½œè€…ç›´æ¥ç‚¹å‡ºâ€œåˆ è¾¹=å…¥åº¦å‡1â€çš„æ ¸å¿ƒé€»è¾‘ï¼Œç”¨æšä¸¾èŠ‚ç‚¹ä»£æ›¿æšä¸¾è¾¹ï¼Œå°†æ—¶é—´å¤æ‚åº¦ä»$O(m(n+m))$ä¼˜åŒ–åˆ°$O(n(n+m))$ï¼Œå®Œç¾è§£å†³äº†è¶…æ—¶é—®é¢˜ã€‚ä»£ç ç»“æ„æ¸…æ™°ï¼Œæ‹“æ‰‘æ’åºå‡½æ•°ï¼ˆ`top_sort`ï¼‰å®ç°ç®€æ´ï¼Œç”¨é˜Ÿåˆ—å­˜å‚¨å…¥åº¦ä¸º0çš„èŠ‚ç‚¹ï¼Œéå†é‚»æ¥è¡¨æ›´æ–°å…¥åº¦ï¼Œé€»è¾‘ç›´ç™½ã€‚å˜é‡å‘½åï¼ˆå¦‚`dag`è¡¨ç¤ºå…¥åº¦ï¼Œ`t`å­˜å‚¨åŸå§‹å…¥åº¦ï¼‰ç¬¦åˆç›´è§‰ï¼Œå¯è¯»æ€§é«˜ã€‚ä»å®è·µè§’åº¦çœ‹ï¼Œä»£ç å¯ä»¥ç›´æ¥ç”¨äºç«èµ›ï¼Œè¾¹ç•Œå¤„ç†ï¼ˆå¦‚å…ˆåˆ¤æ–­åŸå›¾æ˜¯å¦æ— ç¯ï¼‰ä¸¥è°¨ï¼Œæ˜¯éå¸¸å€¼å¾—å‚è€ƒçš„â€œæ ‡å‡†è§£æ³•â€ã€‚  

### é¢˜è§£äºŒï¼šï¼ˆæ¥æºï¼šCharlesZiyï¼Œèµ3ï¼‰  
* **ç‚¹è¯„**ï¼š  
  æ­¤é¢˜è§£çš„**ç»†èŠ‚å¤„ç†**éå¸¸åˆ°ä½ã€‚ä½œè€…ç‰¹åˆ«å¼ºè°ƒäº†â€œå…¥åº¦æ•°ç»„çš„å¤åˆ¶â€â€”â€”æ¯æ¬¡æ‹“æ‰‘æ’åºå‰éƒ½è¦å°†åŸå§‹å…¥åº¦æ•°ç»„ï¼ˆ`IN`ï¼‰å¤åˆ¶åˆ°ä¸´æ—¶æ•°ç»„ï¼ˆ`in`ï¼‰ï¼Œé¿å…ä¿®æ”¹åŸæ•°ç»„å½±å“åç»­æšä¸¾ã€‚è¿™ä¸ªç»†èŠ‚å®¹æ˜“è¢«å¿½ç•¥ï¼Œä½†ç›´æ¥å†³å®šäº†ä»£ç çš„æ­£ç¡®æ€§ã€‚æ­¤å¤–ï¼Œä½œè€…ç”¨`vector`å­˜å‚¨é‚»æ¥è¡¨ï¼Œä»£ç é£æ ¼è§„èŒƒï¼Œæ‹“æ‰‘æ’åºçš„å®ç°ï¼ˆ`topsort`å‡½æ•°ï¼‰é€»è¾‘æ¸…æ™°ï¼Œè¿”å›å€¼ï¼ˆ`cnt == n`ï¼‰ç›´æ¥åˆ¤æ–­æ˜¯å¦æ— ç¯ï¼Œå®¹æ˜“ç†è§£ã€‚å¯¹äºåˆå­¦è€…æ¥è¯´ï¼Œè¿™ç§â€œæ³¨é‡ç»†èŠ‚â€çš„ä»£ç é£æ ¼å€¼å¾—å­¦ä¹ ã€‚  

### é¢˜è§£ä¸‰ï¼šï¼ˆæ¥æºï¼šå¤§èœé¸¡fksï¼Œèµ7ï¼‰  
* **ç‚¹è¯„**ï¼š  
  æ­¤é¢˜è§£çš„**æ€è·¯ç›´è§‚æ€§**æ˜¯äº®ç‚¹ã€‚ä½œè€…é‡‡ç”¨â€œæ‰¾ç¯+æ–­è¾¹â€çš„æš´åŠ›æ–¹æ³•ï¼šå…ˆé€šè¿‡DFSæ‰¾åˆ°ä¸€ä¸ªç¯ï¼Œå†æšä¸¾ç¯ä¸­çš„è¾¹ï¼Œåˆ é™¤ååˆ¤æ–­æ˜¯å¦æ— ç¯ã€‚è™½ç„¶æ—¶é—´å¤æ‚åº¦è¾ƒé«˜ï¼ˆ$O(m(n+m))$ï¼‰ï¼Œä½†æ€è·¯éå¸¸ç›´è§‚â€”â€”ç¯æ˜¯å¯¼è‡´å›¾æœ‰ç¯çš„æ ¹æºï¼Œæ–­ç¯ä¸­çš„ä»»æ„ä¸€æ¡è¾¹å°±èƒ½æ‰“ç ´ç¯ã€‚è¿™ç§æ–¹æ³•é€‚åˆç†è§£â€œç¯â€çš„æœ¬è´¨ï¼Œå¯¹äºå°æ•°æ®çš„é¢˜ç›®ä¹Ÿèƒ½é€šè¿‡ã€‚ä»£ç ä¸­`dfs`æ‰¾ç¯ã€`Dfs`åˆ¤ç¯çš„å®ç°é€»è¾‘æ¸…æ™°ï¼Œé€‚åˆåˆå­¦è€…ç†è§£â€œç¯â€ä¸â€œæ‹“æ‰‘æ’åºâ€çš„å…³ç³»ã€‚  


## 3. æ ¸å¿ƒéš¾ç‚¹è¾¨æä¸è§£é¢˜ç­–ç•¥

### 1. **éš¾ç‚¹1ï¼šå¦‚ä½•é«˜æ•ˆæšä¸¾åˆ è¾¹ï¼Ÿ**  
* **åˆ†æ**ï¼š  
  ç›´æ¥æšä¸¾æ¯ä¸€æ¡è¾¹ï¼ˆåˆ é™¤åè·‘æ‹“æ‰‘ï¼‰çš„æ—¶é—´å¤æ‚åº¦æ˜¯$O(m(n+m))$ï¼Œå¯¹äº$m=1e5$çš„æƒ…å†µä¼šè¶…æ—¶ã€‚è§£å†³å…³é”®æ˜¯**è¯†åˆ«åˆ è¾¹çš„æœ¬è´¨**â€”â€”åˆ è¾¹=ç»ˆç‚¹å…¥åº¦å‡1ã€‚å¦‚æœå¤šæ¡è¾¹æŒ‡å‘åŒä¸€ä¸ªèŠ‚ç‚¹ï¼Œåˆ é™¤å…¶ä¸­ä»»æ„ä¸€æ¡çš„æ•ˆæœç›¸åŒï¼Œå› æ­¤åªéœ€æšä¸¾èŠ‚ç‚¹ï¼ˆå…¥åº¦ä¸ä¸º0æ—¶ï¼‰ï¼Œå°†å…¶å…¥åº¦å‡1ï¼Œå†è·‘æ‹“æ‰‘æ’åºã€‚è¿™æ ·å¤æ‚åº¦é™åˆ°$O(n(n+m))$ï¼Œæ•ˆç‡æ›´é«˜ã€‚  
* ğŸ’¡ **å­¦ä¹ ç¬”è®°**ï¼š**æŠ“ä½é—®é¢˜æœ¬è´¨ï¼Œé¿å…é‡å¤è®¡ç®—**æ˜¯ä¼˜åŒ–çš„å…³é”®ã€‚  

### 2. **éš¾ç‚¹2ï¼šæ‹“æ‰‘æ’åºçš„æ­£ç¡®å®ç°ï¼Ÿ**  
* **åˆ†æ**ï¼š  
  æ‹“æ‰‘æ’åºçš„æ ¸å¿ƒæ˜¯**ç»´æŠ¤å…¥åº¦æ•°ç»„**å’Œ**é˜Ÿåˆ—å­˜å‚¨å…¥åº¦ä¸º0çš„èŠ‚ç‚¹**ã€‚å¸¸è§é”™è¯¯æ˜¯**å¿˜è®°å¤åˆ¶å…¥åº¦æ•°ç»„**â€”â€”æ¯æ¬¡æ‹“æ‰‘æ’åºéƒ½ä¼šä¿®æ”¹å…¥åº¦æ•°ç»„ï¼Œå› æ­¤éœ€è¦ç”¨ä¸€ä¸ªä¸´æ—¶æ•°ç»„å­˜å‚¨åŸå§‹å…¥åº¦ï¼Œé¿å…å½±å“åç»­æšä¸¾ã€‚ä¾‹å¦‚ï¼Œé¢˜è§£äºŒä¸­çš„`IN`æ•°ç»„å­˜å‚¨åŸå§‹å…¥åº¦ï¼Œ`in`æ•°ç»„æ˜¯ä¸´æ—¶æ•°ç»„ï¼Œæ¯æ¬¡æ‹“æ‰‘å‰éƒ½è¦å¤åˆ¶`IN`åˆ°`in`ã€‚  
* ğŸ’¡ **å­¦ä¹ ç¬”è®°**ï¼š**ä¸´æ—¶æ•°ç»„æ˜¯ä¿æŠ¤åŸå§‹æ•°æ®çš„é‡è¦å·¥å…·**ã€‚  

### 3. **éš¾ç‚¹3ï¼šè¾¹ç•Œæ¡ä»¶å¤„ç†ï¼Ÿ**  
* **åˆ†æ**ï¼š  
  é¢˜ç›®å…è®¸â€œåˆ é™¤0æ¡è¾¹â€ï¼ˆå³åŸå›¾å·²ç»æ— ç¯ï¼‰ï¼Œå› æ­¤éœ€è¦**å…ˆåˆ¤æ–­åŸå›¾æ˜¯å¦æ— ç¯**ã€‚ä¾‹å¦‚ï¼Œé¢˜è§£ä¸€ä¸­çš„ä»£ç å…ˆè·‘ä¸€æ¬¡æ‹“æ‰‘æ’åºï¼Œå¦‚æœè¿”å›`true`ï¼ˆ`cnt == n`ï¼‰ï¼Œç›´æ¥è¾“å‡ºâ€œYESâ€ï¼Œæ— éœ€æšä¸¾åˆ è¾¹ã€‚  
* ğŸ’¡ **å­¦ä¹ ç¬”è®°**ï¼š**è¾¹ç•Œæ¡ä»¶æ˜¯é—®é¢˜çš„â€œç‰¹æ®Šæƒ…å†µâ€ï¼Œéœ€è¦ä¼˜å…ˆå¤„ç†**ã€‚  

### âœ¨ è§£é¢˜æŠ€å·§æ€»ç»“  
- **é—®é¢˜æœ¬è´¨æç‚¼**ï¼šåˆ è¾¹=ç»ˆç‚¹å…¥åº¦å‡1ï¼Œæšä¸¾èŠ‚ç‚¹æ¯”æšä¸¾è¾¹æ›´é«˜æ•ˆã€‚  
- **æ•°æ®ç»“æ„é€‰æ‹©**ï¼šç”¨`vector`å­˜å‚¨é‚»æ¥è¡¨ï¼ˆä¾¿äºéå†é‚»æ¥èŠ‚ç‚¹ï¼‰ï¼Œç”¨é˜Ÿåˆ—å­˜å‚¨å…¥åº¦ä¸º0çš„èŠ‚ç‚¹ï¼ˆæ‹“æ‰‘æ’åºçš„æ ¸å¿ƒï¼‰ã€‚  
- **ç»†èŠ‚ä¿æŠ¤**ï¼šç”¨ä¸´æ—¶æ•°ç»„å­˜å‚¨åŸå§‹å…¥åº¦ï¼Œé¿å…ä¿®æ”¹åŸæ•°ç»„å½±å“åç»­æ“ä½œã€‚  


## 4. C++æ ¸å¿ƒä»£ç å®ç°èµæ

### æœ¬é¢˜é€šç”¨æ ¸å¿ƒC++å®ç°å‚è€ƒ  
* **è¯´æ˜**ï¼šæœ¬ä»£ç ç»¼åˆäº†é’çƒŸç»•æŒ‡æŸ”ã€CharlesZiyç­‰é¢˜è§£çš„æ€è·¯ï¼Œå®ç°äº†â€œæšä¸¾èŠ‚ç‚¹å…¥åº¦å‡ä¸€+æ‹“æ‰‘æ’åºâ€çš„æ ‡å‡†è§£æ³•ï¼Œé€»è¾‘æ¸…æ™°ï¼Œæ•ˆç‡è¾ƒé«˜ã€‚  
* **å®Œæ•´æ ¸å¿ƒä»£ç **ï¼š  
  ```cpp
  #include <iostream>
  #include <vector>
  #include <queue>
  #include <cstring>
  using namespace std;

  const int N = 510;
  int n, m;
  vector<int> g[N]; // é‚»æ¥è¡¨
  int in[N]; // å…¥åº¦æ•°ç»„
  int original_in[N]; // åŸå§‹å…¥åº¦æ•°ç»„

  bool top_sort() {
      int cnt = 0;
      queue<int> q;
      int temp_in[N];
      memcpy(temp_in, in, sizeof(in)); // å¤åˆ¶å…¥åº¦æ•°ç»„
      for (int i = 1; i <= n; ++i) {
          if (temp_in[i] == 0) {
              q.push(i);
          }
      }
      while (!q.empty()) {
          int u = q.front();
          q.pop();
          cnt++;
          for (int v : g[u]) {
              temp_in[v]--;
              if (temp_in[v] == 0) {
                  q.push(v);
              }
          }
      }
      return cnt == n;
  }

  int main() {
      cin >> n >> m;
      for (int i = 1; i <= m; ++i) {
          int a, b;
          cin >> a >> b;
          g[a].push_back(b);
          in[b]++;
      }
      memcpy(original_in, in, sizeof(in)); // ä¿å­˜åŸå§‹å…¥åº¦
      // å…ˆåˆ¤æ–­åŸå›¾æ˜¯å¦æ— ç¯
      if (top_sort()) {
          cout << "YES" << endl;
          return 0;
      }
      // æšä¸¾æ¯ä¸ªèŠ‚ç‚¹ï¼Œå‡å°‘å…¥åº¦ååˆ¤æ–­
      for (int i = 1; i <= n; ++i) {
          if (original_in[i] == 0) continue; // å…¥åº¦ä¸º0ï¼Œæ— éœ€å‡å°‘
          in[i]--; // å‡å°‘å…¥åº¦
          if (top_sort()) {
              cout << "YES" << endl;
              return 0;
          }
          in[i]++; // æ¢å¤å…¥åº¦
      }
      cout << "NO" << endl;
      return 0;
  }
  ```
* **ä»£ç è§£è¯»æ¦‚è¦**ï¼š  
  ä»£ç åˆ†ä¸ºä¸‰éƒ¨åˆ†ï¼š  
  1. **è¾“å…¥å¤„ç†**ï¼šè¯»å–èŠ‚ç‚¹æ•°å’Œè¾¹æ•°ï¼Œæ„å»ºé‚»æ¥è¡¨ï¼Œç»Ÿè®¡å…¥åº¦æ•°ç»„ã€‚  
  2. **åŸå›¾åˆ¤æ–­**ï¼šè°ƒç”¨`top_sort`å‡½æ•°åˆ¤æ–­åŸå›¾æ˜¯å¦æ— ç¯ï¼Œè‹¥æ˜¯ç›´æ¥è¾“å‡ºâ€œYESâ€ã€‚  
  3. **æšä¸¾èŠ‚ç‚¹**ï¼šéå†æ¯ä¸ªèŠ‚ç‚¹ï¼Œå‡å°‘å…¶å…¥åº¦ï¼ˆæ¨¡æ‹Ÿåˆ è¾¹ï¼‰ï¼Œè°ƒç”¨`top_sort`å‡½æ•°åˆ¤æ–­æ˜¯å¦æ— ç¯ï¼Œè‹¥æ˜¯è¾“å‡ºâ€œYESâ€ï¼›å¦åˆ™æ¢å¤å…¥åº¦ï¼Œç»§ç»­æšä¸¾ã€‚  

### é’ˆå¯¹å„ä¼˜è´¨é¢˜è§£çš„ç‰‡æ®µèµæ  

#### é¢˜è§£ä¸€ï¼ˆé’çƒŸç»•æŒ‡æŸ”ï¼‰ï¼šæ‹“æ‰‘æ’åºå‡½æ•°  
* **äº®ç‚¹**ï¼šç”¨`memcpy`å¤åˆ¶å…¥åº¦æ•°ç»„ï¼Œé€»è¾‘ç®€æ´ã€‚  
* **æ ¸å¿ƒä»£ç ç‰‡æ®µ**ï¼š  
  ```cpp
  inline int top_sort(){
      int cnt=0;	queue<int> q;
      for(int i=1;i<=n;i++)	if(!dag[i])	q.push(i);
      while(q.size()){
          int u=q.front();	q.pop();	cnt++;
          for(auto to:g[u])	if(--dag[to]==0)	q.push(to);
      }
      return cnt==n;
  }
  ```
* **ä»£ç è§£è¯»**ï¼š  
  è¿™æ®µä»£ç æ˜¯æ‹“æ‰‘æ’åºçš„æ ¸å¿ƒå®ç°ã€‚`dag`æ•°ç»„å­˜å‚¨å½“å‰å…¥åº¦ï¼Œ`q`å­˜å‚¨å…¥åº¦ä¸º0çš„èŠ‚ç‚¹ã€‚å¾ªç¯ä¸­ï¼Œæ¯æ¬¡å–å‡ºé˜Ÿåˆ—å¤´éƒ¨èŠ‚ç‚¹`u`ï¼Œè®¡æ•°å™¨`cnt`åŠ 1ï¼ˆè¡¨ç¤ºå¤„ç†äº†ä¸€ä¸ªèŠ‚ç‚¹ï¼‰ï¼Œç„¶åéå†`u`çš„æ‰€æœ‰é‚»æ¥èŠ‚ç‚¹`to`ï¼Œå°†`to`çš„å…¥åº¦å‡1ã€‚å¦‚æœ`to`çš„å…¥åº¦å˜ä¸º0ï¼Œå°†å…¶åŠ å…¥é˜Ÿåˆ—ã€‚æœ€åè¿”å›`cnt == n`ï¼ˆæ˜¯å¦å¤„ç†äº†æ‰€æœ‰èŠ‚ç‚¹ï¼‰ã€‚  
* ğŸ’¡ **å­¦ä¹ ç¬”è®°**ï¼š**é˜Ÿåˆ—æ˜¯æ‹“æ‰‘æ’åºçš„æ ¸å¿ƒæ•°æ®ç»“æ„**ï¼Œç”¨äºç»´æŠ¤å…¥åº¦ä¸º0çš„èŠ‚ç‚¹ã€‚  

#### é¢˜è§£äºŒï¼ˆCharlesZiyï¼‰ï¼šå…¥åº¦æ•°ç»„å¤åˆ¶  
* **äº®ç‚¹**ï¼šæ˜ç¡®åŒºåˆ†åŸå§‹å…¥åº¦å’Œä¸´æ—¶å…¥åº¦ï¼Œé¿å…ä¿®æ”¹åŸæ•°ç»„ã€‚  
* **æ ¸å¿ƒä»£ç ç‰‡æ®µ**ï¼š  
  ```cpp
  bool topsort() {
      queue<int> q;
      int cnt = 0;
      for (int i = 1; i <= n; i++) in[i] = IN[i]; // å¤åˆ¶åŸå§‹å…¥åº¦
      for (int i = 1; i <= n; i++) {
          if (in[i] == 0) q.push(i);
      }
      // ... åç»­é€»è¾‘
  }
  ```
* **ä»£ç è§£è¯»**ï¼š  
  è¿™æ®µä»£ç ä¸­ï¼Œ`IN`æ•°ç»„å­˜å‚¨åŸå§‹å…¥åº¦ï¼Œ`in`æ•°ç»„æ˜¯ä¸´æ—¶æ•°ç»„ã€‚æ¯æ¬¡è°ƒç”¨`topsort`å‡½æ•°æ—¶ï¼Œéƒ½ä¼šå°†`IN`æ•°ç»„å¤åˆ¶åˆ°`in`æ•°ç»„ï¼Œç¡®ä¿æ¯æ¬¡æ‹“æ‰‘æ’åºéƒ½ä½¿ç”¨åŸå§‹å…¥åº¦ï¼Œé¿å…ä¹‹å‰çš„ä¿®æ”¹å½±å“åç»­æšä¸¾ã€‚  
* ğŸ’¡ **å­¦ä¹ ç¬”è®°**ï¼š**åŸå§‹æ•°æ®çš„ä¿æŠ¤æ˜¯ä»£ç æ­£ç¡®æ€§çš„å…³é”®**ã€‚  


## 5. ç®—æ³•å¯è§†åŒ–ï¼šåƒç´ åŠ¨ç”»æ¼”ç¤º (æ ¸å¿ƒéƒ¨åˆ†)

### åŠ¨ç”»æ¼”ç¤ºä¸»é¢˜ï¼š**åƒç´ æ¢é™©å®¶çš„â€œæ— ç¯æŒ‘æˆ˜â€**  
ï¼ˆæ¨¡ä»¿FCæ¸¸æˆã€Šç‚¸å¼¹äººã€‹çš„é£æ ¼ï¼Œç”¨8ä½åƒç´ ç”»å±•ç¤ºå›¾ç»“æ„å’Œç®—æ³•è¿‡ç¨‹ï¼‰  

### æ ¸å¿ƒæ¼”ç¤ºå†…å®¹  
1. **åœºæ™¯åˆå§‹åŒ–**ï¼š  
   - å±å¹•å·¦ä¾§æ˜¾ç¤ºåƒç´ åŒ–çš„å›¾ï¼ˆèŠ‚ç‚¹æ˜¯32x32çš„å½©è‰²æ–¹å—ï¼Œè¾¹æ˜¯ç®­å¤´ï¼‰ï¼ŒèŠ‚ç‚¹ä¸‹æ–¹æ ‡æ³¨å…¥åº¦ï¼ˆå¦‚â€œå…¥åº¦ï¼š2â€ï¼‰ã€‚  
   - å±å¹•å³ä¾§æ˜¯â€œæ§åˆ¶é¢æ¿â€ï¼šæœ‰â€œå¼€å§‹â€â€œå•æ­¥â€â€œé‡ç½®â€æŒ‰é’®ï¼Œé€Ÿåº¦æ»‘å—ï¼ˆ1x~5xï¼‰ï¼Œä»¥åŠâ€œAIè‡ªåŠ¨æ¼”ç¤ºâ€å¼€å…³ã€‚  
   - èƒŒæ™¯æ’­æ”¾8ä½é£æ ¼çš„è½»æ¾BGMï¼ˆå¦‚ã€Šè¶…çº§é©¬é‡Œå¥¥ã€‹çš„èƒŒæ™¯éŸ³ä¹ï¼‰ã€‚  

2. **åŸå›¾åˆ¤æ–­**ï¼š  
   - åŠ¨ç”»å¼€å§‹æ—¶ï¼Œè‡ªåŠ¨è·‘ä¸€æ¬¡æ‹“æ‰‘æ’åºï¼š  
     - å…¥åº¦ä¸º0çš„èŠ‚ç‚¹ï¼ˆå¦‚èŠ‚ç‚¹1ï¼‰â€œè·³è¿›â€é˜Ÿåˆ—ï¼ˆåŠ¨ç”»ï¼šæ–¹å—ä»èŠ‚ç‚¹ä½ç½®æ»‘å…¥é˜Ÿåˆ—åŒºåŸŸï¼Œä¼´éšâ€œå®â€çš„éŸ³æ•ˆï¼‰ã€‚  
     - èŠ‚ç‚¹å‡ºé˜Ÿæ—¶ï¼Œå…¶é‚»æ¥èŠ‚ç‚¹çš„å…¥åº¦å‡1ï¼ˆåŠ¨ç”»ï¼šé‚»æ¥èŠ‚ç‚¹çš„å…¥åº¦æ•°å­—å‡1ï¼Œé¢œè‰²å˜æµ…ï¼‰ã€‚  
     - è‹¥æ‰€æœ‰èŠ‚ç‚¹éƒ½å‡ºé˜Ÿï¼ˆæ— ç¯ï¼‰ï¼Œå±å¹•æ˜¾ç¤ºâ€œåŸå›¾æ— ç¯ï¼â€ï¼Œæ’­æ”¾â€œèƒœåˆ©â€éŸ³æ•ˆï¼ˆå¦‚ã€Šé­‚æ–—ç½—ã€‹çš„é€šå…³éŸ³ä¹ï¼‰ï¼›å¦åˆ™ï¼Œæ˜¾ç¤ºâ€œåŸå›¾æœ‰ç¯ï¼Œéœ€è¦åˆ è¾¹â€ã€‚  

3. **æšä¸¾èŠ‚ç‚¹**ï¼š  
   - é•œå¤´èšç„¦åˆ°å½“å‰æšä¸¾çš„èŠ‚ç‚¹ï¼ˆå¦‚èŠ‚ç‚¹2ï¼‰ï¼ŒèŠ‚ç‚¹é—ªçƒçº¢è‰²ï¼Œæ—è¾¹å¼¹å‡ºæ–‡å­—â€œå°è¯•å‡å°‘èŠ‚ç‚¹2çš„å…¥åº¦â€ã€‚  
   - èŠ‚ç‚¹çš„å…¥åº¦æ•°å­—å‡1ï¼ˆå¦‚ä»2å˜ä¸º1ï¼‰ï¼Œä¼´éšâ€œå’”å—’â€çš„éŸ³æ•ˆã€‚  

4. **æ‹“æ‰‘è¿‡ç¨‹**ï¼š  
   - å†æ¬¡è·‘æ‹“æ‰‘æ’åºï¼Œæ­¥éª¤ä¸åŸå›¾åˆ¤æ–­ç±»ä¼¼ï¼Œä½†å½“å‰èŠ‚ç‚¹çš„å…¥åº¦å·²å‡å°‘ã€‚  
   - è‹¥èƒ½ç”Ÿæˆå®Œæ•´åºåˆ—ï¼ˆæ— ç¯ï¼‰ï¼Œå±å¹•æ˜¾ç¤ºâ€œæˆåŠŸï¼åˆ é™¤ä¸€æ¡æŒ‡å‘èŠ‚ç‚¹2çš„è¾¹å³å¯â€ï¼Œæ’­æ”¾â€œèƒœåˆ©â€éŸ³æ•ˆï¼›å¦åˆ™ï¼Œæ˜¾ç¤ºâ€œå¤±è´¥ï¼Œæ¢å¤å…¥åº¦â€ï¼ŒèŠ‚ç‚¹å…¥åº¦æ¢å¤ï¼Œç»§ç»­æšä¸¾ä¸‹ä¸€ä¸ªèŠ‚ç‚¹ã€‚  

5. **æ¸¸æˆåŒ–å…ƒç´ **ï¼š  
   - **å…³å¡è®¾è®¡**ï¼šå°†æšä¸¾èŠ‚ç‚¹çš„è¿‡ç¨‹åˆ†ä¸ºâ€œå°å…³å¡â€ï¼Œæ¯æšä¸¾ä¸€ä¸ªèŠ‚ç‚¹è§†ä¸ºâ€œé—¯ä¸€å…³â€ï¼Œå®Œæˆåæ˜¾ç¤ºâ€œå…³å¡1å®Œæˆï¼â€ã€‚  
   - **ç§¯åˆ†ç³»ç»Ÿ**ï¼šæ¯æˆåŠŸæšä¸¾ä¸€ä¸ªèŠ‚ç‚¹ï¼Œè·å¾—10åˆ†ï¼›è‹¥æ‰¾åˆ°è§£ï¼Œé¢å¤–è·å¾—50åˆ†ï¼Œæ˜¾ç¤ºâ€œæ€»åˆ†ï¼š60â€ã€‚  
   - **AIæ¼”ç¤º**ï¼šå¼€å¯â€œAIè‡ªåŠ¨æ¼”ç¤ºâ€åï¼Œç®—æ³•ä¼šè‡ªåŠ¨æšä¸¾èŠ‚ç‚¹ï¼Œåƒâ€œè´ªåƒè›‡AIâ€ä¸€æ ·å®Œæˆè§£é¢˜ï¼Œå­¦ä¹ è€…å¯ä»¥è§‚å¯Ÿæ•´ä¸ªè¿‡ç¨‹ã€‚  

### è®¾è®¡æ€è·¯  
- **åƒç´ é£æ ¼**ï¼šè¥é€ å¤å¤æ¸¸æˆæ°›å›´ï¼Œé™ä½å­¦ä¹ å‹åŠ›ã€‚  
- **éŸ³æ•ˆæç¤º**ï¼šç”¨ä¸åŒçš„éŸ³æ•ˆå¼ºåŒ–å…³é”®æ“ä½œï¼ˆå¦‚å…¥é˜Ÿã€åˆ è¾¹ã€æˆåŠŸï¼‰ï¼Œå¸®åŠ©è®°å¿†ã€‚  
- **æ¸¸æˆåŒ–å…ƒç´ **ï¼šé€šè¿‡å…³å¡å’Œç§¯åˆ†å¢åŠ è¶£å‘³æ€§ï¼Œæ¿€å‘å­¦ä¹ è€…çš„æ¢ç´¢æ¬²æœ›ã€‚  


## 6. æ‹“å±•ç»ƒä¹ ä¸ç›¸ä¼¼é—®é¢˜æ€è€ƒ

### é€šç”¨æ€è·¯/æŠ€å·§è¿ç§»  
æ‹“æ‰‘æ’åºï¼ˆåˆ¤ç¯ï¼‰+ æšä¸¾ä¼˜åŒ–çš„æ€è·¯ï¼Œä¸ä»…èƒ½è§£å†³æœ¬é¢˜ï¼Œè¿˜èƒ½ç”¨äºä»¥ä¸‹åœºæ™¯ï¼š  
1. **åˆ¤æ–­å›¾æ˜¯å¦æœ‰ç¯**ï¼šç›´æ¥è·‘æ‹“æ‰‘æ’åºï¼Œè‹¥æ— æ³•å¤„ç†æ‰€æœ‰èŠ‚ç‚¹ï¼Œåˆ™æœ‰ç¯ã€‚  
2. **æ±‚æœ‰å‘æ— ç¯å›¾çš„æ‹“æ‰‘åºåˆ—**ï¼šé€šè¿‡é˜Ÿåˆ—ç»´æŠ¤å…¥åº¦ä¸º0çš„èŠ‚ç‚¹ï¼Œä¾æ¬¡è¾“å‡ºã€‚  
3. **åˆ¤æ–­æ˜¯å¦å¯ä»¥é€šè¿‡æ·»åŠ /åˆ é™¤è¾¹ä½¿å›¾æ— ç¯**ï¼šç±»ä¼¼æœ¬é¢˜ï¼Œæšä¸¾æ·»åŠ /åˆ é™¤è¾¹çš„æƒ…å†µï¼Œç”¨æ‹“æ‰‘æ’åºåˆ¤æ–­ã€‚  

### ç»ƒä¹ æ¨è (æ´›è°·)  
1. **æ´›è°· P1113 æ‚åŠ¡**  
   - ğŸ—£ï¸ **æ¨èç†ç”±**ï¼šè¿™é“é¢˜æ˜¯æ‹“æ‰‘æ’åºçš„ç»å…¸åº”ç”¨ï¼Œéœ€è¦è®¡ç®—å®Œæˆæ‰€æœ‰æ‚åŠ¡çš„æœ€çŸ­æ—¶é—´ï¼Œå¸®åŠ©å·©å›ºæ‹“æ‰‘æ’åºçš„é€»è¾‘ã€‚  
2. **æ´›è°· P2341 å—æ¬¢è¿çš„ç‰›**  
   - ğŸ—£ï¸ **æ¨èç†ç”±**ï¼šæœ¬é¢˜éœ€è¦åˆ¤æ–­æœ‰å‘å›¾ä¸­æ˜¯å¦å­˜åœ¨ä¸€ä¸ªèŠ‚ç‚¹ï¼Œæ‰€æœ‰å…¶ä»–èŠ‚ç‚¹éƒ½èƒ½åˆ°è¾¾å®ƒï¼Œæ¶‰åŠå¼ºè¿é€šåˆ†é‡å’Œæ‹“æ‰‘æ’åºçš„ç»“åˆï¼Œæ˜¯æ€ç»´æ‹“å±•çš„å¥½é¢˜ã€‚  
3. **æ´›è°· P3243 èœè‚´åˆ¶ä½œ**  
   - ğŸ—£ï¸ **æ¨èç†ç”±**ï¼šæœ¬é¢˜è¦æ±‚ç”Ÿæˆå­—å…¸åºæœ€å°çš„æ‹“æ‰‘åºåˆ—ï¼Œéœ€è¦è°ƒæ•´æ‹“æ‰‘æ’åºçš„é˜Ÿåˆ—ï¼ˆç”¨ä¼˜å…ˆé˜Ÿåˆ—ï¼‰ï¼Œå¸®åŠ©ç†è§£æ‹“æ‰‘æ’åºçš„å˜å½¢ã€‚  


## 7. å­¦ä¹ å¿ƒå¾—ä¸ç»éªŒåˆ†äº« (è‹¥æœ‰)

### å‚è€ƒç»éªŒ (æ¥è‡ª CharlesZiy)  
> â€œæˆ‘åœ¨è§£å†³è¿™ä¸ªé—®é¢˜æ—¶ï¼Œæœ€åˆå¿˜è®°äº†å¤åˆ¶å…¥åº¦æ•°ç»„ï¼Œå¯¼è‡´æ‹“æ‰‘æ’åºçš„ç»“æœé”™è¯¯ã€‚åæ¥é€šè¿‡è°ƒè¯•å‘ç°ï¼Œæ¯æ¬¡æ‹“æ‰‘æ’åºéƒ½ä¼šä¿®æ”¹å…¥åº¦æ•°ç»„ï¼Œå› æ­¤éœ€è¦ç”¨ä¸€ä¸ªä¸´æ—¶æ•°ç»„å­˜å‚¨åŸå§‹å…¥åº¦ã€‚è¿™è®©æˆ‘æ„è¯†åˆ°ï¼Œ**ç»†èŠ‚æ˜¯ä»£ç æ­£ç¡®æ€§çš„å…³é”®**ã€‚â€  

**ç‚¹è¯„**ï¼š  
è¿™ä½ä½œè€…çš„ç»éªŒéå¸¸å…¸å‹ã€‚åœ¨ç¼–ç¨‹è¿‡ç¨‹ä¸­ï¼Œ**åŸå§‹æ•°æ®çš„ä¿æŠ¤**ï¼ˆå¦‚å…¥åº¦æ•°ç»„çš„å¤åˆ¶ï¼‰æ˜¯å®¹æ˜“è¢«å¿½ç•¥çš„ç»†èŠ‚ï¼Œä½†ç›´æ¥å†³å®šäº†ä»£ç çš„æ­£ç¡®æ€§ã€‚å¯¹äºåˆå­¦è€…æ¥è¯´ï¼Œ**è°ƒè¯•æ—¶æ‰“å°ä¸­é—´å˜é‡**ï¼ˆå¦‚å…¥åº¦æ•°ç»„çš„å€¼ï¼‰æ˜¯å‘ç°è¿™ç±»é”™è¯¯çš„æœ‰æ•ˆæ–¹æ³•ã€‚  


## ç»“è¯­  
æœ¬æ¬¡å…³äºâ€œAlmost Acyclic Graphâ€çš„C++è§£é¢˜åˆ†æå°±åˆ°è¿™é‡Œã€‚å¸Œæœ›è¿™ä»½å­¦ä¹ æŒ‡å—èƒ½å¸®åŠ©å¤§å®¶ç†è§£æ‹“æ‰‘æ’åºçš„åº”ç”¨ã€æšä¸¾ä¼˜åŒ–çš„æ€è·¯ï¼Œä»¥åŠä»£ç ä¸­çš„ç»†èŠ‚å¤„ç†ã€‚è®°ä½ï¼Œ**ç¼–ç¨‹çš„ä¹è¶£åœ¨äºè§£å†³é—®é¢˜çš„è¿‡ç¨‹**ï¼Œåªè¦å¤šæ€è€ƒã€å¤šç»ƒä¹ ï¼Œä½ ä¸€å®šèƒ½æŒæ¡è¿™äº›æŠ€å·§ï¼ä¸‹æ¬¡æˆ‘ä»¬å†ä¸€èµ·æ¢ç´¢æ–°çš„ç¼–ç¨‹æŒ‘æˆ˜ï¼ğŸ’ª

---
å¤„ç†ç”¨æ—¶ï¼š219.61ç§’
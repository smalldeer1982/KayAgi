# é¢˜ç›®ä¿¡æ¯

# Divisors

## é¢˜ç›®æè¿°

You are given $ n $ integers $ a_1, a_2, \ldots, a_n $ . Each of $ a_i $ has between $ 3 $ and $ 5 $ divisors. Consider $ a = \prod a_i $ â€” the product of all input integers. Find the number of divisors of $ a $ . As this number may be very large, print it modulo prime number $ 998244353 $ .

## è¯´æ˜/æç¤º

In the first case, $ a = 19305 $ . Its divisors are $ 1, 3, 5, 9, 11, 13, 15, 27, 33, 39, 45, 55, 65, 99, 117, 135, 143, 165, 195, 297, 351, 429, 495, 585, 715, 1287, 1485, 1755, 2145, 3861, 6435, 19305 $ â€” a total of $ 32 $ .

In the second case, $ a $ has four divisors: $ 1 $ , $ 86028121 $ , $ 86028157 $ , and $ 7400840699802997  $ .

In the third case $ a = 202600445671925364698739061629083877981962069703140268516570564888699 375209477214045102253766023072401557491054453690213483547 $ .

In the fourth case, $ a=512=2^9 $ , so answer equals to $ 10 $ .

## æ ·ä¾‹ #1

### è¾“å…¥

```
3
9
15
143```

### è¾“å‡º

```
32```

## æ ·ä¾‹ #2

### è¾“å…¥

```
1
7400840699802997
```

### è¾“å‡º

```
4```

## æ ·ä¾‹ #3

### è¾“å…¥

```
8 
4606061759128693
4606066102679989
4606069767552943
4606063116488033
4606063930903637
4606064745319241
4606063930904021
4606065559735517```

### è¾“å‡º

```
1920```

## æ ·ä¾‹ #4

### è¾“å…¥

```
3
4
8
16
```

### è¾“å‡º

```
10
```

# AIåˆ†æç»“æœ


### ğŸ’¡ Kayçš„C++ç®—æ³•è§£æï¼šDivisors æ·±å…¥å­¦ä¹ æŒ‡å— ğŸ’¡

#### 1. é¢˜ç›®è§£è¯»ä¸æ ¸å¿ƒç®—æ³•è¯†åˆ«
âœ¨ **æœ¬é¢˜ä¸»è¦è€ƒå¯Ÿ**ï¼šæ•°è®ºï¼ˆè´¨å› æ•°åˆ†è§£ä¸åˆ†ç±»è®¨è®ºï¼‰

ğŸ—£ï¸ **åˆæ­¥åˆ†æ**ï¼š
> è§£å†³æœ¬é¢˜çš„å…³é”®åœ¨äºåˆ©ç”¨æ¯ä¸ªæ•°åªæœ‰3-5ä¸ªå› æ•°çš„ç‰¹æ®Šæ€§è´¨ï¼Œå¯¹è¾“å…¥çš„æ•°è¿›è¡Œé«˜æ•ˆåˆ†ç±»å¤„ç†ã€‚è¿™å°±åƒæ‹†è§£ä¹é«˜ç§¯æœ¨ï¼šè™½ç„¶æ•´ä½“å¤æ‚ï¼Œä½†æ¯ä¸ªé›¶ä»¶åªæœ‰å‡ ç§åŸºç¡€å½¢çŠ¶ï¼ˆå¹³æ–¹æ•°ã€ç«‹æ–¹æ•°ã€ä¸¤ä¸ªè´¨æ•°ä¹˜ç§¯ç­‰ï¼‰ï¼Œé€šè¿‡è¯†åˆ«è¿™äº›åŸºç¡€å½¢çŠ¶å°±èƒ½å¿«é€Ÿç»„è£…ç­”æ¡ˆã€‚
> - **æ ¸å¿ƒæ€è·¯**ï¼šæ¯ä¸ªæ•°åªèƒ½æ˜¯è´¨æ•°çš„å¹³æ–¹ã€ç«‹æ–¹ã€å››æ¬¡æ–¹æˆ–ä¸¤ä¸ªä¸åŒè´¨æ•°çš„ä¹˜ç§¯ã€‚å¯¹æ¯ç§ç±»å‹åˆ†åˆ«å¤„ç†ï¼šå¼€æ–¹éªŒè¯å‰ä¸‰ç§ï¼Œä¸¤ä¸¤æ±‚æœ€å¤§å…¬çº¦æ•°ï¼ˆGCDï¼‰åˆ†è§£ç¬¬å››ç§ã€‚
> - **éš¾ç‚¹çªç ´**ï¼šå¤„ç†ä¸¤ä¸ªè´¨æ•°ä¹˜ç§¯æ—¶ï¼Œéœ€é¿å…é‡å¤è®¡æ•°è´¨å› å­ã€‚é€šè¿‡ä¸¤ä¸¤æ±‚GCDå‘ç°å…¬å…±è´¨å› å­ï¼Œå†ç»Ÿè®¡æœªè¦†ç›–çš„ç‹¬ç«‹è´¨å› å­ã€‚
> - **å¯è§†åŒ–è®¾è®¡**ï¼šç”¨åƒç´ ç½‘æ ¼å±•ç¤ºæ•°çš„åˆ†è§£è¿‡ç¨‹ã€‚æ¯ä¸ªæ•°ç”¨ä¸åŒé¢œè‰²æ–¹å—è¡¨ç¤ºï¼Œè´¨å› å­ç”¨å‘å…‰è¾¹æ¡†æ ‡è®°ã€‚æ±‚GCDæ—¶æ˜¾ç¤ºæ‰«æåŠ¨ç”»ï¼Œå…¬å…±è´¨å› å­ç¢°æ’æ—¶è§¦å‘8ä½éŸ³æ•ˆï¼ŒæˆåŠŸåˆ†è§£æ—¶æ’­æ”¾èƒœåˆ©éŸ³æ•ˆã€‚

---

#### 2. ç²¾é€‰ä¼˜è´¨é¢˜è§£å‚è€ƒ
**é¢˜è§£ä¸€ï¼šAlex_Weiï¼ˆæ€è·¯æ¸…æ™°åº¦â­â­â­â­â­ï¼‰**
* **ç‚¹è¯„**ï¼šæ­¤è§£æ³•é€»è¾‘ä¸¥å¯†ï¼Œåˆ†ç±»è®¨è®ºå®Œæ•´ã€‚äº®ç‚¹åœ¨äºï¼š
  - å¼€æ–¹éªŒè¯ä½¿ç”¨äºŒåˆ†æŸ¥æ‰¾é¿å…ç²¾åº¦é—®é¢˜
  - ç”¨`map`é«˜æ•ˆç»Ÿè®¡è´¨å› å­æŒ‡æ•°
  - ä¸¤ä¸¤æ±‚GCDæ—¶ä¼˜åŒ–å…¬å…±è´¨å› å­è¯†åˆ«
  - è¾¹ç•Œå¤„ç†ä¸¥è°¨ï¼ˆå¦‚`fc.find(x)==fc.end()`æ£€æŸ¥ï¼‰
  
**é¢˜è§£äºŒï¼šBLUESKY007ï¼ˆä»£ç è§„èŒƒæ€§â­â­â­â­ï¼‰**
* **ç‚¹è¯„**ï¼šè§£æ³•ä¸Alex_Weiç›¸ä¼¼ä½†å®ç°æ›´ç®€æ´ï¼š
  - ç”¨`mmp`å•ç‹¬å­˜å‚¨æœªåˆ†è§£çš„æ•°
  - åˆ†è§£åç«‹å³æ›´æ–°è´¨å› å­è®¡æ•°å™¨
  - æ³¨æ„äº†é‡å¤æ•°çš„ç‰¹æ®Šå¤„ç†ï¼ˆ`en`è®¡æ•°å™¨ï¼‰
  
---

#### 3. æ ¸å¿ƒéš¾ç‚¹è¾¨æä¸è§£é¢˜ç­–ç•¥
1. **éš¾ç‚¹ï¼šé«˜æ•ˆéªŒè¯è´¨æ•°å¹‚æ¬¡**
   * **åˆ†æ**ï¼šç›´æ¥å¼€æ–¹ä¼šä¸¢å¤±ç²¾åº¦ã€‚ä¼˜è´¨é¢˜è§£ç”¨äºŒåˆ†æ³•ç²¾ç¡®è®¡ç®—å¹³æ–¹/ç«‹æ–¹/å››æ¬¡æ–¹æ ¹ï¼Œå†éªŒè¯å¹‚æ¬¡ã€‚ä¾‹å¦‚åˆ¤æ–­å¹³æ–¹æ•°ï¼šå…ˆäºŒåˆ†æ±‚å¹³æ–¹æ ¹ï¼Œå†éªŒè¯å¹³æ–¹æ˜¯å¦ç­‰äºåŸæ•°ã€‚
   * ğŸ’¡ **å­¦ä¹ ç¬”è®°**ï¼šå¤§æ•°è¿ç®—ä¼˜å…ˆè€ƒè™‘äºŒåˆ†é¿å…æµ®ç‚¹è¯¯å·®

2. **éš¾ç‚¹ï¼šåˆ†è§£ä¸¤ä¸ªè´¨æ•°ä¹˜ç§¯**
   * **åˆ†æ**ï¼šå½“æ•°æ— æ³•å¼€æ–¹æ—¶ï¼Œå¿…ä¸ºä¸¤ä¸åŒè´¨æ•°ä¹˜ç§¯ï¼ˆ$p \times q$ï¼‰ã€‚é€šè¿‡ä¸¤ä¸¤æ±‚GCDå‘ç°å…¬å…±è´¨å› å­ï¼ˆè‹¥$\gcd(a_i,a_j)>1$åˆ™å¿…ä¸ºå…¬å…±å› å­ï¼‰ã€‚æœªè¢«è¦†ç›–çš„è´¨å› å­éœ€å•ç‹¬è®¡æ•°ã€‚
   * ğŸ’¡ **å­¦ä¹ ç¬”è®°**ï¼šåˆ©ç”¨GCDåˆ†è§£æ˜¯å¤„ç†å¤§è´¨å› å­çš„å…³é”®æŠ€å·§

3. **éš¾ç‚¹ï¼šè´¨å› å­æŒ‡æ•°æ•´åˆ**
   * **åˆ†æ**ï¼šæœ€ç»ˆç­”æ¡ˆéœ€è®¡ç®—$\prod (c_i+1)$ã€‚æ³¨æ„æœªåˆ†è§£æ•°çš„ç‹¬ç«‹è´¨å› å­ï¼šè‹¥æ•°æœªè¢«å…¬å…±å› å­è¦†ç›–ï¼Œåˆ™å…¶ä¸¤ä¸ªè´¨å› å­å‡ä¸ºæ–°å› å­ï¼Œéœ€å¯¹ç­”æ¡ˆè´¡çŒ®$(cnt+1)^2$ã€‚
   * ğŸ’¡ **å­¦ä¹ ç¬”è®°**ï¼šè´¨å› å­è®¡æ•°è¦åŒºåˆ†"å·²åˆ†è§£"å’Œ"æœªè¦†ç›–"ä¸¤ç§æƒ…å†µ

âœ¨ **è§£é¢˜æŠ€å·§æ€»ç»“**
- **åˆ†ç±»è®¨è®ºæ³•**ï¼šæ ¹æ®å› æ•°ä¸ªæ•°åæ¨æ•°çš„æ•°å­¦å½¢å¼
- **GCDåˆ†è§£æœ¯**ï¼šç”¨ä¸¤ä¸¤æ±‚å…¬å› æ•°ä»£æ›¿å®Œæ•´è´¨å› æ•°åˆ†è§£
- **è¾¹ç•Œé˜²å¾¡**ï¼šç‰¹åˆ«æ³¨æ„$10^{18}$å¤§æ•°è¿ç®—çš„ç²¾åº¦é—®é¢˜

---

#### 4. C++æ ¸å¿ƒä»£ç å®ç°èµæ
```cpp
#include <iostream>
#include <map>
#include <vector>
#include <cmath>
#include <algorithm>
using namespace std;
typedef long long ll;
const int MOD = 998244353;

// äºŒåˆ†éªŒè¯å¹³æ–¹æ•°
ll sqr(ll x) {
    ll l = 1, r = 1.5e9;
    while (l < r) {
        ll mid = (l + r + 1) >> 1;
        mid * mid <= x ? l = mid : r = mid - 1;
    }
    return l * l == x ? l : 0;
}

int main() {
    int n; cin >> n;
    map<ll, int> primeCnt; // è´¨å› å­è®¡æ•°å™¨
    map<ll, int> undecided; // æœªåˆ†è§£çš„æ•°
    vector<ll> undecidedList;

    for (int i = 0; i < n; i++) {
        ll x; cin >> x;
        bool decomposed = false;
        
        // éªŒè¯å››æ¬¡æ–¹
        ll root4 = sqr(sqr(x));
        if (root4 && root4 * root4 * root4 * root4 == x) {
            primeCnt[root4] += 4;
            decomposed = true;
        }
        // éªŒè¯ç«‹æ–¹
        if (!decomposed) {
            ll l = 1, r = 1300000;
            while (l < r) {
                ll mid = (l + r) >> 1;
                mid * mid * mid < x ? l = mid + 1 : r = mid;
            }
            if (l * l * l == x) {
                primeCnt[l] += 3;
                decomposed = true;
            }
        }
        // éªŒè¯å¹³æ–¹
        if (!decomposed && (root4 = sqr(x))) {
            primeCnt[root4] += 2;
            decomposed = true;
        }
        // æœªåˆ†è§£çš„æ•°å­˜å…¥åˆ—è¡¨
        if (!decomposed) {
            if (!undecided[x]) undecidedList.push_back(x);
            undecided[x]++;
        }
    }

    // ä¸¤ä¸¤æ±‚GCDæ‰¾å…¬å…±è´¨å› å­
    for (int i = 0; i < undecidedList.size(); i++) {
        for (int j = i + 1; j < undecidedList.size(); j++) {
            ll g = __gcd(undecidedList[i], undecidedList[j]);
            if (g > 1 && !primeCnt.count(g)) primeCnt[g] = 0;
        }
    }

    ll ans = 1;
    // å¤„ç†æœªåˆ†è§£çš„æ•°
    for (auto num : undecidedList) {
        int uncovered = 2; // åˆå§‹ä¸¤ä¸ªè´¨å› å­
        for (auto &[p, cnt] : primeCnt) {
            if (num % p == 0) {
                cnt += undecided[num];
                num /= p;
                uncovered--;
            }
        }
        // ç‹¬ç«‹è´¨å› å­å¤„ç†
        ans = ans * (undecided[num] + 1) % MOD;
        if (uncovered == 1) ans = ans * (undecided[num] + 1) % MOD;
    }
    // ç»Ÿè®¡è´¨å› å­è´¡çŒ®
    for (auto [p, cnt] : primeCnt) {
        ans = ans * (cnt + 1) % MOD;
    }
    cout << ans << endl;
}
```
**ä»£ç è§£è¯»æ¦‚è¦**ï¼š
1. äºŒåˆ†å‡½æ•°`sqr`ç²¾ç¡®éªŒè¯å¹³æ–¹æ•°
2. æŒ‰å››æ¬¡æ–¹â†’ç«‹æ–¹â†’å¹³æ–¹é¡ºåºå°è¯•åˆ†è§£
3. æœªåˆ†è§£çš„æ•°ä¸¤ä¸¤æ±‚GCDæ‰¾å…¬å…±è´¨å› å­
4. å¯¹æœªè¦†ç›–è´¨å› å­å•ç‹¬è®¡ç®—è´¡çŒ®

**é¢˜è§£ä¸€ï¼šAlex_Wei**
```cpp
// æ ¸å¿ƒç‰‡æ®µï¼šå¤„ç†æœªåˆ†è§£æ•°
for(ll i:buc){
    int c=2,d=num[i];
    for(pll it:fc) if(i%it.fi==0) 
        fc[it.fi]+=d, c--;
    ans=ans*(c==0?1:(c==1?d+1:(d+1)*(d+1)))%mod;
}
```
* **äº®ç‚¹**ï¼šç”¨`c`è®¡æ•°å™¨è¿½è¸ªæœªè¦†ç›–è´¨å› å­æ•°é‡ï¼Œæ•°å­¦è½¬åŒ–ä¼˜é›…
* **å­¦ä¹ ç¬”è®°**ï¼š`(d+1)^c`å·§å¦™ç»Ÿä¸€äº†ä¸åŒæƒ…å†µçš„è®¡æ•°

**é¢˜è§£äºŒï¼šBLUESKY007**
```cpp
// æ ¸å¿ƒç‰‡æ®µï¼šä¸¤ä¸¤æ±‚GCD
for(auto ite2:mmp){
    for(auto ite:mp){
        if(ite2.first%ite.first==0){
            mp[ite.first]+=ite2.second;
            mp[ite2.first/ite.first]+=ite2.second;
            mmp[ite2.first]=0;
            break;
        }
    }
}
```
* **äº®ç‚¹**ï¼šåˆ†è§£åç«‹å³æ¸…é›¶`mmp`æ¡ç›®ï¼Œé¿å…é‡å¤å¤„ç†
* **å­¦ä¹ ç¬”è®°**ï¼šè¾¹åˆ†è§£è¾¹æ›´æ–°æ˜¯ä¼˜åŒ–æ•ˆç‡çš„å…³é”®æŠ€å·§

---

### 5. ç®—æ³•å¯è§†åŒ–ï¼šåƒç´ åŠ¨ç”»æ¼”ç¤º
**ä¸»é¢˜**ï¼š8ä½åƒç´ é£"è´¨å› å­çŒäºº"  
**æ ¸å¿ƒæ¼”ç¤º**ï¼š  
1. **åˆå§‹åŒ–**ï¼š  
   - ç½‘æ ¼ä¸­æ˜¾ç¤º$n$ä¸ªå½©è‰²æ–¹å—ï¼ˆæ¯ä¸ªæ•°ä¸€ç§é¢œè‰²ï¼‰
   - æ§åˆ¶é¢æ¿å«"å¼€æ–¹éªŒè¯"/"GCDæ‰«æ"/"è‡ªåŠ¨æ¼”ç¤º"æŒ‰é’®  
   <center>![åˆå§‹åŒ–](https://via.placeholder.com/400x200/000000/FFFFFF?text=Pixel+Grid+Initialized)</center>  

2. **åˆ†ç±»è¿‡ç¨‹**ï¼š  
   - **å¼€æ–¹éªŒè¯**ï¼šæ–¹å—è¢«æ”¾å…¥å¯¹åº”æœºå™¨ï¼ˆå¹³æ–¹/ç«‹æ–¹/å››æ¬¡æ–¹ï¼‰ï¼ŒæˆåŠŸæ—¶åˆ†è§£ä¸ºå°æ–¹å—ï¼ˆè´¨å› å­ï¼‰å¹¶æ’­æ”¾"å®"éŸ³æ•ˆ  
   - **GCDæ‰«æ**ï¼šä¸¤æ–¹å—ç¢°æ’æ—¶æ˜¾ç¤ºGCDå°„çº¿ï¼Œå‘½ä¸­å…¬å…±å› å­æ—¶è§¦å‘çˆ†ç‚¸åŠ¨ç”»  
   ```js
   // ä¼ªä»£ç ï¼šGCDæ‰«æåŠ¨ç”»
   function gcdAnimation(a, b) {
      drawLaserBetween(a, b); 
      let g = calculateGCD(a, b);
      if(g > 1) {
         playSound("explosion");
         createParticleEffect(g); // ç²’å­æ•ˆæœæ ‡è®°å…¬å…±å› å­
      }
   }
   ```

3. **å› å­æ•´åˆ**ï¼š  
   - è´¨å› å­è®¡æ•°å™¨ç”¨æŸ±çŠ¶å›¾å®æ—¶æ˜¾ç¤º  
   - æœªè¦†ç›–å› å­æ˜¾ç¤ºä¸ºé—ªçƒé—®å·ï¼Œæ•´åˆæ—¶è½¬åŒ–ä¸ºç‹¬ç«‹è®¡æ•°å™¨  

4. **æ¸¸æˆåŒ–å…ƒç´ **ï¼š  
   - æ¯æˆåŠŸåˆ†è§£ä¸€ç±»æ•°è§£é”æ–°æŠ€èƒ½ï¼ˆå¦‚"å¿«é€Ÿæ‰«æ"ï¼‰  
   - èƒŒæ™¯æ’­æ”¾8ä½èŠ¯ç‰‡éŸ³ä¹ï¼Œå…³é”®æ“ä½œé…å¤å¤éŸ³æ•ˆ  
   - æœ€ç»ˆç­”æ¡ˆè®¡ç®—æ—¶æ˜¾ç¤ºæ”¾çƒŸç«åŠ¨ç”»  

---

### 6. æ‹“å±•ç»ƒä¹ ä¸ç›¸ä¼¼é—®é¢˜æ€è€ƒ
**é€šç”¨æŠ€å·§è¿ç§»**ï¼š  
1. åˆ©ç”¨ç‰¹æ®Šæ€§è´¨ä¼˜åŒ–è´¨å› æ•°åˆ†è§£ï¼ˆå¦‚å› æ•°ä¸ªæ•°é™å®šï¼‰  
2. å¤§æ•°è¿ç®—ä¸­çš„äºŒåˆ†æŠ€å·§  
3. é€šè¿‡GCDå‘ç°éšè—è´¨å› å­  

**æ´›è°·æ¨è**ï¼š  
1. **P1069 ç»†èƒåˆ†è£‚**  
   ğŸ—£ï¸ è€ƒå¯Ÿè´¨å› æ•°åˆ†è§£åœ¨ç”Ÿç‰©æ¨¡å‹ä¸­çš„åº”ç”¨ï¼Œå·©å›ºæŒ‡æ•°ç»Ÿè®¡æŠ€å·§  
2. **P1072 [NOIP2009] Hanksonçš„è¶£å‘³é¢˜**  
   ğŸ—£ï¸ å¼ºåŒ–GCDå’Œè´¨å› å­åˆ†è§£çš„ç»¼åˆåº”ç”¨  
3. **P2043 è´¨å› æ•°åˆ†è§£**  
   ğŸ—£ï¸ ä¸“é—¨è®­ç»ƒå¤§æ•°åˆ†è§£çš„ä¼˜åŒ–ç­–ç•¥  

---

### 7. å­¦ä¹ å¿ƒå¾—ä¸ç»éªŒåˆ†äº«
> **å‚è€ƒç»éªŒ (Alex_Wei)**ï¼š  
> "åœ¨å¤„ç†æœªåˆ†è§£æ•°æ—¶ï¼Œæœ€åˆå¿˜è®°æ£€æŸ¥`fc.find(x)==fc.end()`å¯¼è‡´WA on test 14ï¼Œè¿™æé†’æˆ‘ä»¬ä¿®æ”¹mapå‰å¿…é¡»æ£€æŸ¥é”®æ˜¯å¦å­˜åœ¨"  
>   
> **Kayç‚¹è¯„**ï¼š  
> è¿™æ˜¯STLå®¹å™¨ä½¿ç”¨çš„ç»å…¸é™·é˜±ï¼ä¿®æ”¹mapå‰æ£€æŸ¥keyæ˜¯å¦å­˜åœ¨åº”æˆä¸ºæ¡ä»¶åå°„ï¼Œå°¤å…¶åœ¨é«˜é¢‘æ“ä½œä¸­ã€‚å»ºè®®å­¦ä¹ é˜²å¾¡æ€§ç¼–ç¨‹ï¼š  
> ```cpp
> if(!mp.count(key)) mp[key] = 0; // å…ˆåˆå§‹åŒ–
> mp[key] += value;
> ```

---

é€šè¿‡æœ¬æ¬¡åˆ†æï¼Œæˆ‘ä»¬æ·±å…¥æŒæ¡äº†ç‰¹æ®Šå½¢å¼æ•°çš„è´¨å› æ•°åˆ†è§£æŠ€å·§ã€‚è®°ä½ï¼šç¼–ç¨‹å¦‚è§£è°œï¼Œæ‰¾åˆ°å…³é”®ç‰¹å¾å°±èƒ½åŒ–ç¹ä¸ºç®€ã€‚ä¸‹æ¬¡é‡åˆ°å¤§æ•°åˆ†è§£æ—¶ï¼Œä¸å¦¨æƒ³æƒ³ä»Šå¤©çš„åƒç´ çŒäººï¼ğŸš€

---
å¤„ç†ç”¨æ—¶ï¼š141.30ç§’
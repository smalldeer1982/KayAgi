# é¢˜ç›®ä¿¡æ¯

# Matrix game

## é¢˜ç›®æè¿°

Aryan and Harshith play a game. They both start with three integers $ a $ , $ b $ , and $ k $ . Aryan then gives Harshith two integers $ n $ and $ m $ . Harshith then gives Aryan a matrix $ X $ with $ n $ rows and $ m $ columns, such that each of the elements of $ X $ is between $ 1 $ and $ k $ (inclusive). After that, Aryan wins if he can find a submatrix $ ^{\text{âˆ—}} $ $ Y $ of $ X $ with $ a $ rows and $ b $ columns such that all elements of $ Y $ are equal.

For example, when $ a=2, b=2, k=6, n=3 $ and $ m=3 $ , if Harshith gives Aryan the matrix below, it is a win for Aryan as it has a submatrix of size $ 2\times 2 $ with all elements equal to $ 1 $ as shown below.

 ![](https://cdn.luogu.com.cn/upload/vjudge_pic/CF2120D/ff9ee31dfc04aa73a7daca458dede1d4462758ef.png) Example of a matrix where Aryan wins Aryan gives you the values of $ a $ , $ b $ , and $ k $ . He asks you to find the lexicographically minimum tuple $ (n,m) $ that he should give to Harshith such that Aryan always wins. Help Aryan win the game. Assume that Harshith plays optimally. The values of $ n $ and $ m $ can be large, so output them modulo $ 10^9+7 $ . A tuple $ (n_1, m_1) $ is said to be lexicographically smaller than $ (n_2, m_2) $ if either $ n_1<n_2 $ or $ n_1=n_2 $ and $ m_1<m_2 $ .

 $ ^{\text{âˆ—}} $ A submatrix of a matrix is obtained by removing some rows and/or columns from the original matrix.

## è¯´æ˜/æç¤º

For the first test case, every $ n\times m $ matrix contains a $ 1\times 1 $ submatrix with all elements equal. $ (1,1) $ is the lexicographically minimum tuple among all of them.

For the second test case, it can be verified that whatever $ 3\times 7 $ matrix Harshith gives to Aryan, Aryan can always win by finding a $ 2\times 2 $ submatrix with all elements equal. $ (3,7) $ is also the lexicographically minimum tuple among all possible tuples where Aryan always wins.

## æ ·ä¾‹ #1

### è¾“å…¥

```
3
1 1 5
2 2 2
90000 80000 70000```

### è¾“å‡º

```
1 1
3 7
299929959 603196135```

# AIåˆ†æç»“æœ


### ğŸ’¡ Kayçš„C++ç®—æ³•è§£æï¼šMatrix Game æ·±å…¥å­¦ä¹ æŒ‡å— ğŸ’¡

#### 1. é¢˜ç›®è§£è¯»ä¸æ ¸å¿ƒç®—æ³•è¯†åˆ«
âœ¨ **æœ¬é¢˜ä¸»è¦è€ƒå¯Ÿ**ï¼š`ç»„åˆæ•°å­¦ä¸é¸½å·¢åŸç†åº”ç”¨`  
ğŸ—£ï¸ **åˆæ­¥åˆ†æ**ï¼š  
> è§£å†³è¿™é“é¢˜çš„å…³é”®åœ¨äºç†è§£**é¸½å·¢åŸç†**ï¼ˆæŠ½å±‰åŸç†ï¼‰ã€‚æƒ³è±¡ä½ æœ‰ $k$ ç§é¢œè‰²çš„é¸½å­ï¼ˆæ•°å­—ï¼‰è¦æ”¾è¿› $n$ ä¸ªé¸½å·¢ï¼ˆè¡Œï¼‰ã€‚ä¸ºäº†è®©æŸç§é¢œè‰²è‡³å°‘å‡ºç° $a$ æ¬¡ï¼Œéœ€è¦ $(a-1)Ã—k+1$ è¡Œã€‚ç±»ä¼¼åœ°ï¼Œåˆ—æ•° $m$ çš„ç¡®å®šéœ€è¦è®¡ç®—æ¯åˆ—å¯èƒ½çš„åˆæ³•æ–¹æ¡ˆæ•°ï¼ˆ$kÃ—\binom{n}{a}$ï¼‰ï¼Œå†ç”¨é¸½å·¢åŸç†ä¿è¯è‡³å°‘ä¸€ç§æ–¹æ¡ˆå‡ºç° $b$ æ¬¡ã€‚  
> - **å¯è§†åŒ–è®¾è®¡**ï¼šå°†ç”¨8ä½åƒç´ é£æ ¼å±•ç¤ºé¸½å·¢åŸç†ã€‚æ¯ä¸ªæ•°å­—ç”¨ä¸åŒé¢œè‰²åƒç´ å—è¡¨ç¤ºï¼Œå½“æŸåˆ—ç§¯ç´¯ $a$ ä¸ªåŒè‰²å—æ—¶è§¦å‘é—ªå…‰ç‰¹æ•ˆã€‚åˆ—è®¡æ•°é˜¶æ®µç”¨è¿›åº¦æ¡åŠ¨ç”»å±•ç¤ºæ–¹æ¡ˆç§¯ç´¯è¿‡ç¨‹ï¼Œ$b$ æ¬¡è¾¾æˆæ—¶æ’­æ”¾èƒœåˆ©éŸ³æ•ˆã€‚

---

#### 2. ç²¾é€‰ä¼˜è´¨é¢˜è§£å‚è€ƒ
**é¢˜è§£ä¸€ï¼ˆä½œè€…ï¼šyitinboge_fanï¼‰**  
* **ç‚¹è¯„**ï¼šæ€è·¯ç›´å‡»æ ¸å¿ƒâ€”â€”ç”¨é¸½å·¢åŸç†åˆ†å±‚æ¨å¯¼ $n$ å’Œ $m$ çš„ä¸‹ç•Œã€‚ä»£ç ä¸­ç»„åˆæ•°è®¡ç®—é‡‡ç”¨é€†å…ƒè¿ä¹˜ï¼Œå¤„ç†å¤§æ•°å–æ¨¡ä¸¥è°¨ï¼ˆå¦‚ `(n-i+1+p)%p` é˜²è´Ÿæ•°ï¼‰ã€‚äº®ç‚¹åœ¨äºå®Œæ•´å‘ˆç°æ•°å­¦æ¨å¯¼åˆ°ä»£ç çš„æ˜ å°„å…³ç³»ï¼Œå˜é‡å `n, m, a, b, k` è´´åˆé¢˜æ„ï¼Œç«èµ›é€‚ç”¨æ€§å¼ºã€‚

**é¢˜è§£äºŒï¼ˆä½œè€…ï¼š_O_v_O_ï¼‰**  
* **ç‚¹è¯„**ï¼šä¸é¢˜è§£ä¸€æ€è·¯ä¸€è‡´ä½†æ›´å¼ºè°ƒç»„åˆæ•°è®¡ç®—æ¨¡å—åŒ–ï¼ˆç‹¬ç«‹ `calc()` å‡½æ•°ï¼‰ã€‚äº®ç‚¹åœ¨äºå°è£…é€†å…ƒè®¡ç®—é€»è¾‘ï¼Œæå‡ä»£ç å¤ç”¨æ€§ã€‚éœ€æ³¨æ„ `inv(i)*((n-i+1+mod))%mod` çš„è¿ç»­å–æ¨¡å¯èƒ½å½±å“æ•ˆç‡ï¼Œä½†å¯¹æœ¬é¢˜æ•°æ®è§„æ¨¡ä»é«˜æ•ˆã€‚

---

#### 3. æ ¸å¿ƒéš¾ç‚¹è¾¨æä¸è§£é¢˜ç­–ç•¥
1. **éš¾ç‚¹1ï¼šè¡Œåˆ—çº¦æŸçš„åˆ†ç¦»æ¨å¯¼**  
   * **åˆ†æ**ï¼šéœ€ç‹¬ç«‹åˆ†æè¡Œ/åˆ—çš„æœ€å°å€¼ã€‚è¡Œçº¦æŸä»…éœ€å•åˆ—è§†è§’ï¼ˆ$n=(a-1)Ã—k+1$ï¼‰ï¼Œåˆ—çº¦æŸéœ€å…¨å±€æ–¹æ¡ˆç»Ÿè®¡ï¼ˆ$m=kÃ—\binom{n}{a}Ã—(b-1)+1$ï¼‰ã€‚  
   * ğŸ’¡ **å­¦ä¹ ç¬”è®°**ï¼šåˆ†è§£ç»´åº¦æ˜¯é™ä½å¤æ‚åº¦çš„å…³é”®ï¼

2. **éš¾ç‚¹2ï¼šå¤§æ•°ç»„åˆæ•°å–æ¨¡è®¡ç®—**  
   * **åˆ†æ**ï¼šå½“ $nâ‰ˆ10^9$ æ—¶ï¼Œç”¨å…¬å¼ $\binom{n}{a}=\prod_{i=1}^a \frac{n-i+1}{i}$ é…åˆé€†å…ƒé€æ­¥è®¡ç®—ï¼Œé¿å…é˜¶ä¹˜çˆ†ç‚¸ã€‚  
   * ğŸ’¡ **å­¦ä¹ ç¬”è®°**ï¼šæ¨¡é€†å…ƒï¼ˆ`fastpow(i, p-2)`ï¼‰æ˜¯å¤„ç†é™¤æ³•çš„åˆ©å™¨ã€‚

3. **éš¾ç‚¹3ï¼šé¸½å·¢åŸç†çš„ä¸¤æ¬¡åº”ç”¨**  
   * **åˆ†æ**ï¼šç¬¬ä¸€æ¬¡ç”¨äºè¡Œï¼ˆå¼ºåˆ¶å•åˆ—å­˜åœ¨ $a$ ä¸ªç›¸åŒæ•°ï¼‰ï¼Œç¬¬äºŒæ¬¡ç”¨äºåˆ—ï¼ˆå¼ºåˆ¶å­˜åœ¨ $b$ åˆ—æ»¡è¶³æ¡ä»¶ï¼‰ã€‚  
   * ğŸ’¡ **å­¦ä¹ ç¬”è®°**ï¼šå¤šå±‚é¸½å·¢åŸç†å¯è§£å†³åµŒå¥—çº¦æŸé—®é¢˜ã€‚

**âœ¨ è§£é¢˜æŠ€å·§æ€»ç»“**  
- **æ•°å­¦å»ºæ¨¡ä¼˜å…ˆ**ï¼šå°†é—®é¢˜è½¬åŒ–ä¸ºé¸½å·¢åŸç†çš„è®¡æ•°æ¨¡å‹  
- **åˆ†æ­¥å–æ¨¡æŠ€å·§**ï¼šå¯¹å¤§æ•°è¿ä¹˜/é™¤æ¯ä¸€æ­¥ç‹¬ç«‹å–æ¨¡  
- **è¾¹ç•Œé˜²å¾¡æ€§ç¼–ç¨‹**ï¼šå¦‚ `(n-i+1+p) % p` é¿å…è´Ÿæ•°  

---

#### 4. C++æ ¸å¿ƒä»£ç å®ç°èµæ
**é€šç”¨æ ¸å¿ƒå®ç°å‚è€ƒ**  
```cpp
#include <iostream>
using namespace std;
typedef long long ll;
const ll p = 1e9+7;

ll fastpow(ll base, ll exp) {
    ll res = 1;
    while (exp) {
        if (exp & 1) res = res * base % p;
        base = base * base % p;
        exp >>= 1;
    }
    return res;
}

int main() {
    int T; cin >> T;
    while (T--) {
        ll a, b, k; cin >> a >> b >> k;
        ll n = ((a-1) * k + 1) % p;    // è¡Œä¸‹ç•Œ
        ll comb = 1;                    // è®¡ç®—ç»„åˆæ•°C(n,a)
        for (int i = 1; i <= a; ++i) {
            comb = comb * (n - i + 1 + p) % p * fastpow(i, p-2) % p;
        }
        ll m = (k * comb % p * (b-1) + 1) % p;  // åˆ—ä¸‹ç•Œ
        cout << n << " " << m << endl;
    }
}
```
**ä»£ç è§£è¯»æ¦‚è¦**ï¼š  
1. è¯»å…¥ $a, b, k$ åè®¡ç®—æœ€å°è¡Œæ•° $n$  
2. é€šè¿‡è¿ä¹˜å’Œé€†å…ƒè®¡ç®— $\binom{n}{a}$ï¼ˆé¿å…å¤§é˜¶ä¹˜ï¼‰  
3. ç”¨é¸½å·¢åŸç†æ¨å¯¼æœ€å°åˆ—æ•° $m$  

---

#### 5. ç®—æ³•å¯è§†åŒ–ï¼šåƒç´ åŠ¨ç”»æ¼”ç¤º
**ğŸ® ä¸»é¢˜**ï¼šã€Šåƒç´ é¸½å·¢å¤§å†’é™©ã€‹- 8ä½æœºé£æ ¼æ¼”ç¤ºé¸½å·¢åŸç†  
**ğŸ¨ è®¾è®¡æ€è·¯**ï¼š  
- **åƒç´ ç½‘æ ¼**ï¼šè¡Œ/åˆ—åŒ–ä¸ºç½‘æ ¼ï¼Œæ•°å­—1~kç”¨ä¸åŒé¢œè‰²åƒç´ å—ï¼ˆ16è‰²è°ƒè‰²ç›˜ï¼‰  
- **æ ¸å¿ƒåŠ¨æ•ˆ**ï¼š  
  - **è¡Œç§¯ç´¯é˜¶æ®µ**ï¼šæ¯åˆ—ç‹¬ç«‹è®¡æ•°ï¼ŒåŒè‰²å—ç§¯ç´¯æ—¶æ’­æ”¾ `å®` éŸ³æ•ˆï¼Œè¾¾ $a$ å—æ—¶æ•´åˆ—é—ªå…‰  
  - **åˆ—ç§¯ç´¯é˜¶æ®µ**ï¼šå³ä¾§è¿›åº¦æ¡ç»Ÿè®¡æ¯åˆ—è¾¾æ ‡æƒ…å†µï¼Œ$b$ æ¬¡è¾¾æˆæ—¶è§¦å‘èƒœåˆ©åŠ¨ç”»ï¼ˆçƒŸèŠ±+èƒœåˆ©éŸ³æ•ˆï¼‰  
- **äº¤äº’æ§åˆ¶**ï¼š  
  - é€Ÿåº¦æ»‘å—è°ƒèŠ‚è‡ªåŠ¨æ¼”ç¤ºé€Ÿç‡  
  - `å•æ­¥æ‰§è¡Œ`æŒ‰é’®é€æ­¥è§‚å¯Ÿè®¡æ•°è¿‡ç¨‹  
  - `AIæ¼”ç¤º`æ¨¡å¼è‡ªåŠ¨å®Œæˆå…¨æµç¨‹ï¼ˆç±»ä¼¼åƒè±†äººè‡ªåŠ¨å¯»è·¯ï¼‰  

**ğŸ•¹ï¸ æŠ€æœ¯å®ç°**ï¼š  
```javascript
// ä¼ªä»£ç ï¼šé¸½å·¢è®¡æ•°åŠ¨ç”»
function drawGrid() {
  for (let col = 0; col < m; col++) {
    for (let row = 0; row < n; row++) {
      const color = matrix[row][col]; // 1~kå¯¹åº”é¢œè‰²
      drawPixel(row, col, PALETTE[color]); 
      if (isCritical(row, col)) flashEffect(); // è¾¾aä¸ªåŒè‰²æ—¶é—ªçƒ
    }
    drawProgressBar(col, count[col]); // åˆ—è¿›åº¦æ¡
  }
}
```

---

#### 6. æ‹“å±•ç»ƒä¹ ä¸ç›¸ä¼¼é—®é¢˜æ€è€ƒ
**ğŸ”— é€šç”¨æŠ€å·§è¿ç§»**ï¼š  
é¸½å·¢åŸç†é€‚ç”¨äºï¼š  
1. å­˜åœ¨æ€§è¯æ˜ï¼ˆå¦‚å¿…æœ‰ä¸¤ä¸ªæ•°å·®ä¸ºkçš„å€æ•°ï¼‰  
2. æœ€åæƒ…å†µåˆ†æï¼ˆå¦‚ç¼“å­˜å¤±æ•ˆé—®é¢˜ï¼‰  
3. å­ç»“æ„é‡å¤å‡ºç°ï¼ˆå¦‚å­—ç¬¦ä¸²é‡å¤å­åºåˆ—ï¼‰  

**ğŸ“š æ´›è°·ç»ƒä¹ æ¨è**ï¼š  
1. **P2219 [HAOI2007]è¦†ç›–é—®é¢˜**  
   â†’ é¸½å·¢åŸç†åœ¨å‡ ä½•è¦†ç›–é—®é¢˜ä¸­çš„å˜å½¢  
2. **P4132 [BJOI2012]ç®—ä¸äº†ä¸€å¤œ**  
   â†’ å¤§æ•°ç»„åˆæ•°å–æ¨¡çš„è¿›é˜¶ç»ƒä¹   
3. **P2280 [HNOI2003]æ¿€å…‰ç‚¸å¼¹**  
   â†’ å­çŸ©é˜µçº¦æŸçš„äºŒç»´æ¨å¹¿  

---

#### 7. å­¦ä¹ å¿ƒå¾—ä¸ç»éªŒåˆ†äº«
> **å‚è€ƒç»éªŒ**ï¼šé¢˜è§£æœªæä¾›ä½œè€…è°ƒè¯•å¿ƒå¾—ï¼Œä½†å®è·µä¸­éœ€æ³¨æ„ï¼š  
> - **å¤§æ•°é™·é˜±**ï¼šå½“ $a=90000, k=70000$ æ—¶ï¼Œ$n$ è¶… `int` èŒƒå›´ï¼Œå¿…é¡»ç”¨ `long long`  
> - **è´Ÿæ•°å–æ¨¡**ï¼š`(n-i+1+p)%p` ç¡®ä¿è¢«é™¤æ•°éè´Ÿ  

---

é€šè¿‡æœ¬æ¬¡åˆ†æï¼Œæˆ‘ä»¬æ·±å…¥ç†è§£äº†é¸½å·¢åŸç†åœ¨äºŒç»´çº¦æŸé—®é¢˜ä¸­çš„ç²¾å¦™åº”ç”¨ã€‚è®°ä½ï¼šåˆ†è§£ç»´åº¦+æ•°å­¦å»ºæ¨¡æ˜¯çªç ´å¤æ‚çº¦æŸçš„å…³é”®ï¼ğŸ¯

---
å¤„ç†ç”¨æ—¶ï¼š110.63ç§’
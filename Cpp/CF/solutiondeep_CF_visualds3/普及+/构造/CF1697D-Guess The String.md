# é¢˜ç›®ä¿¡æ¯

# Guess The String

## é¢˜ç›®æè¿°

This is an interactive problem. Remember to flush your output while communicating with the testing program. You may use fflush(stdout) in C++, system.out.flush() in Java, stdout.flush() in Python or flush(output) in Pascal to flush the output. If you use some other programming language, consult its documentation. You may also refer to the guide on interactive problems: <https://codeforces.com/blog/entry/45307>.

The jury has chosen a string $ s $ consisting of $ n $ characters; each character of $ s $ is a lowercase Latin letter. Your task is to guess this string; initially, you know only its length.

You may ask queries of two types:

- $ 1 $ $ i $ â€” the query of the first type, where $ i $ is an integer from $ 1 $ to $ n $ . In response to this query, the jury will tell you the character $ s_i $ ;
- $ 2 $ $ l $ $ r $ â€” the query of the second type, where $ l $ and $ r $ are integers such that $ 1 \le l \le r \le n $ . In response to this query, the jury will tell you the number of different characters among $ s_l, s_{l+1}, \dots, s_r $ .

You are allowed to ask no more than $ 26 $ queries of the first type, and no more than $ 6000 $ queries of the second type. Your task is to restore the string $ s $ .

For each test in this problem, the string $ s $ is fixed beforehand, and will be the same for every submission.

## è¯´æ˜/æç¤º

Let's analyze the example of interaction.

The string chosen by the jury is guess, so initially the jury sends one integer $ 5 $ .

1. the first query is ? 2 1 5, which means "count the number of different characters among $ s_1, s_2, \dots, s_5 $ ". The answer to it is $ 4 $ .
2. the second query is ? 1 2, which means "tell which character is $ s_2 $ ". The answer to it is u.
3. the third query is ? 2 1 2, which means "count the number of different characters among $ s_1 $ and $ s_2 $ ". The answer to it is $ 2 $ .
4. the fourth query is ? 1 1, which means "tell which character is $ s_1 $ ". The answer to it is g.
5. the fifth query is ? 1 3, which means "tell which character is $ s_3 $ ". The answer to it is e.
6. the sixth query is ? 1 4, which means "tell which character is $ s_4 $ ". The answer to it is s.
7. the seventh query is ? 2 4 5, which means "count the number of different characters among $ s_4 $ and $ s_5 $ ". The answer to it is $ 1 $ , so it's possible to deduce that $ s_4 $ is the same as $ s_5 $ .

In the end, the answer is submitted as ! guess, and it is deduced correctly.

## æ ·ä¾‹ #1

### è¾“å…¥

```
5
4
u
2
g
e
s
1```

### è¾“å‡º

```
? 2 1 5
? 1 2
? 2 1 2
? 1 1
? 1 3
? 1 4
? 2 4 5
! guess```

# AIåˆ†æç»“æœ

# ğŸ’¡ Kayçš„C++ç®—æ³•è§£æï¼šGuess The String æ·±å…¥å­¦ä¹ æŒ‡å— ğŸ’¡


## 1. é¢˜ç›®è§£è¯»ä¸æ ¸å¿ƒç®—æ³•è¯†åˆ«

âœ¨ **æœ¬é¢˜ä¸»è¦è€ƒå¯Ÿ**ï¼šäºŒåˆ†æŸ¥æ‰¾ç»“åˆåŒºé—´æŸ¥è¯¢ï¼ˆäº¤äº’é¢˜æŠ€å·§åº”ç”¨ï¼‰

ğŸ—£ï¸ **åˆæ­¥åˆ†æ**ï¼š  
è§£å†³â€œGuess The Stringâ€çš„å…³é”®ï¼Œå°±åƒ**åœ¨ä¸€å †æ‰“ä¹±çš„ç§¯æœ¨ä¸­æ‰¾ç‰¹å®šå—**â€”â€”ä½ ä¸èƒ½ç›´æ¥çœ‹æ‰€æœ‰ç§¯æœ¨ï¼ˆåªèƒ½æŸ¥26æ¬¡å…·ä½“å­—ç¬¦ï¼‰ï¼Œä½†å¯ä»¥é—®â€œæŸä¸ªç›’å­é‡Œæœ‰å¤šå°‘ç§ç§¯æœ¨â€ï¼ˆåŒºé—´ä¸åŒå­—ç¬¦æ•°ï¼‰ã€‚æˆ‘ä»¬éœ€è¦ç”¨**äºŒåˆ†æŸ¥æ‰¾**ç¼©å°èŒƒå›´ï¼Œç”¨æœ€å°‘çš„â€œçœ‹ç§¯æœ¨â€æ¬¡æ•°ï¼ˆç¬¬ä¸€ç±»æŸ¥è¯¢ï¼‰çŒœå‡ºæ•´ä¸ªå­—ç¬¦ä¸²ã€‚  

- **æ ¸å¿ƒæ€è·¯**ï¼š  
  1. **é¢„å¤„ç†**ï¼šç”¨ç¬¬äºŒç±»æŸ¥è¯¢æ‰¾åˆ°æ¯ä¸ªæ–°å­—ç¬¦çš„ç¬¬ä¸€æ¬¡å‡ºç°ä½ç½®ï¼ˆå› ä¸ºæ¯å‡ºç°ä¸€ä¸ªæ–°å­—ç¬¦ï¼ŒåŒºé—´[1,i]çš„ä¸åŒå­—ç¬¦æ•°ä¼šå¢åŠ ï¼‰ï¼Œç”¨ç¬¬ä¸€ç±»æŸ¥è¯¢è®°å½•è¿™äº›å­—ç¬¦ï¼ˆæœ€å¤š26æ¬¡ï¼Œåˆšå¥½è¦†ç›–æ‰€æœ‰å°å†™å­—æ¯ï¼‰ã€‚  
  2. **äºŒåˆ†ç¡®å®šæ¯ä¸ªä½ç½®**ï¼šå¯¹äºåç»­ä½ç½®ï¼Œç»´æŠ¤æ¯ä¸ªå­—ç¬¦**æœ€åä¸€æ¬¡å‡ºç°çš„ä½ç½®**ï¼ˆæŒ‰é¡ºåºæ’åˆ—ï¼‰ï¼Œé€šè¿‡äºŒåˆ†è¿™äº›ä½ç½®ï¼Œç”¨ç¬¬äºŒç±»æŸ¥è¯¢åˆ¤æ–­å½“å‰å­—ç¬¦å±äºå“ªä¸€ç±»ï¼ˆæ¯”å¦‚æŸ¥è¯¢[midä½ç½®, i]çš„ä¸åŒå­—ç¬¦æ•°ï¼Œè‹¥ç­‰äºâ€œmidä¹‹åçš„å­—ç¬¦ç§ç±»æ•°â€ï¼Œåˆ™å½“å‰å­—ç¬¦åœ¨midå³è¾¹ï¼‰ã€‚  

- **æ ¸å¿ƒéš¾ç‚¹**ï¼š  
  - å¦‚ä½•ç”¨åŒºé—´æŸ¥è¯¢ç»“æœ**é«˜æ•ˆäºŒåˆ†**å­—ç¬¦ç±»åˆ«ï¼Ÿ  
  - å¦‚ä½•ç»´æŠ¤å­—ç¬¦æœ€åå‡ºç°çš„ä½ç½®ï¼Œä¿è¯äºŒåˆ†çš„æ­£ç¡®æ€§ï¼Ÿ  

- **å¯è§†åŒ–è®¾è®¡æ€è·¯**ï¼š  
  ç”¨8ä½åƒç´ é£æ ¼å±•ç¤ºå­—ç¬¦ä¸²ä½ç½®ï¼ˆæ¯ä¸ªä½ç½®æ˜¯ä¸€ä¸ªå½©è‰²åƒç´ å—ï¼‰ï¼Œ**äºŒåˆ†è¿‡ç¨‹**ä¸­ï¼Œä¸­é—´ä½ç½®çš„åƒç´ å—ä¼šé—ªçƒï¼ˆæ¯”å¦‚çº¢è‰²ï¼‰ï¼ŒåŒºé—´æŸ¥è¯¢çš„ç»“æœç”¨æ•°å­—æ˜¾ç¤ºåœ¨æ—è¾¹ï¼ˆæ¯”å¦‚â€œå½“å‰æŸ¥è¯¢[3,5]çš„ä¸åŒå­—ç¬¦æ•°ï¼š2â€ï¼‰ã€‚å½“ç¡®å®šä¸€ä¸ªå­—ç¬¦æ—¶ï¼Œåƒç´ å—ä¼šå˜æˆå¯¹åº”å­—ç¬¦çš„é¢œè‰²ï¼ˆæ¯”å¦‚â€˜aâ€™æ˜¯è“è‰²ï¼‰ï¼Œå¹¶æ’­æ”¾â€œå®â€çš„éŸ³æ•ˆã€‚**è‡ªåŠ¨æ’­æ”¾æ¨¡å¼**ä¼šåƒâ€œè´ªåƒè›‡æ‰¾é£Ÿç‰©â€ä¸€æ ·ï¼Œé€æ­¥å®Œæˆæ‰€æœ‰ä½ç½®çš„åˆ¤æ–­ã€‚


## 2. ç²¾é€‰ä¼˜è´¨é¢˜è§£å‚è€ƒ

### é¢˜è§£ä¸€ï¼šï¼ˆæ¥æºï¼šTHè® NKï¼Œèµï¼š4ï¼‰  
* **ç‚¹è¯„**ï¼š  
  è¿™ä»½é¢˜è§£çš„æ€è·¯**åƒå‰¥æ´‹è‘±ä¸€æ ·æ¸…æ™°**ï¼é¦–å…ˆç”¨é¢„å¤„ç†ï¼ˆå¾ªç¯iä»1åˆ°nï¼ŒæŸ¥è¯¢[1,i]çš„ä¸åŒå­—ç¬¦æ•°ï¼‰æ‰¾åˆ°æ‰€æœ‰æ–°å­—ç¬¦çš„ä½ç½®ï¼ˆæœ€å¤š26æ¬¡ç¬¬ä¸€ç±»æŸ¥è¯¢ï¼‰ï¼Œç„¶åç”¨**äºŒåˆ†æ³•**å¤„ç†æ¯ä¸ªæœªçŸ¥ä½ç½®ã€‚ä»£ç ä¸­çš„`id`æ•°ç»„ï¼ˆè®°å½•å­—ç¬¦ç±»åˆ«ï¼‰ã€`mp`æ•°ç»„ï¼ˆæ˜ å°„ç±»åˆ«åˆ°å­—ç¬¦ï¼‰å‘½åéå¸¸æ˜ç¡®ï¼Œå®¹æ˜“ç†è§£ã€‚  
  äº®ç‚¹åœ¨äº**ç»´æŠ¤å­—ç¬¦æœ€åå‡ºç°çš„ä½ç½®**ï¼ˆ`a`æ•°ç»„æŒ‰posæ’åºï¼‰ï¼Œé€šè¿‡äºŒåˆ†è¿™äº›ä½ç½®ï¼Œç”¨ç¬¬äºŒç±»æŸ¥è¯¢çš„ç»“æœå¿«é€Ÿå®šä½å½“å‰å­—ç¬¦ï¼ˆæ¯”å¦‚`ask2(a[mid].pos, i)`çš„ç»“æœç­‰äºâ€œmx - mid + 1â€æ—¶ï¼Œè¯´æ˜å½“å‰å­—ç¬¦åœ¨midå³è¾¹ï¼‰ã€‚è¿™ç§æ–¹æ³•æŠŠæŸ¥è¯¢æ¬¡æ•°æ§åˆ¶åœ¨`n log26`ï¼ˆçº¦1000*5=5000æ¬¡ï¼‰ï¼Œå®Œå…¨ç¬¦åˆé¢˜ç›®è¦æ±‚ã€‚  
  ä»å®è·µè§’åº¦çœ‹ï¼Œä»£ç çš„**äº¤äº’å¤„ç†**ï¼ˆ`ask1`å’Œ`ask2`å‡½æ•°ï¼‰éå¸¸è§„èŒƒï¼Œç”¨`cout<<flush`åˆ·æ–°è¾“å‡ºï¼Œé¿å…äº†TLEï¼ˆè¶…æ—¶ï¼‰é—®é¢˜ï¼Œå€¼å¾—å­¦ä¹ ã€‚


### é¢˜è§£äºŒï¼šï¼ˆæ¥æºï¼šPosVIIï¼Œèµï¼š3ï¼‰  
* **ç‚¹è¯„**ï¼š  
  æ­¤é¢˜è§£çš„æ€è·¯å’Œé¢˜è§£ä¸€ç±»ä¼¼ï¼Œä½†**å¾ªç¯ç»“æ„æ›´çµæ´»**ã€‚ä½œè€…ç”¨`j`è®°å½•å½“å‰å¤„ç†åˆ°çš„ä½ç½®ï¼Œå½“`ask(1,j)`çš„ç»“æœç­‰äºå½“å‰å­—ç¬¦ç§ç±»æ•°æ—¶ï¼Œè¯´æ˜jä½ç½®çš„å­—ç¬¦æ˜¯å·²çŸ¥çš„ï¼Œç”¨äºŒåˆ†æ³•ç¡®å®šå…¶ç±»åˆ«ã€‚ä»£ç ä¸­çš„`str`æ•°ç»„ï¼ˆå­˜å‚¨å·²çŸ¥å­—ç¬¦åŠå…¶ä½ç½®ï¼‰å’Œ`idx`æ•°ç»„ï¼ˆæ˜ å°„å­—ç¬¦åˆ°ç´¢å¼•ï¼‰è®¾è®¡å·§å¦™ï¼Œæ–¹ä¾¿å¿«é€ŸæŸ¥æ‰¾ã€‚  
  äº®ç‚¹åœ¨äº**å¤„ç†å·²çŸ¥å­—ç¬¦çš„é€»è¾‘**ï¼šå½“jä½ç½®çš„å­—ç¬¦æ˜¯å·²çŸ¥çš„ï¼Œä½œè€…é€šè¿‡äº¤æ¢`str`æ•°ç»„ä¸­çš„å…ƒç´ ï¼Œæ›´æ–°å­—ç¬¦æœ€åå‡ºç°çš„ä½ç½®ï¼Œä¿è¯äº†äºŒåˆ†çš„æ­£ç¡®æ€§ã€‚è¿™ç§â€œåŠ¨æ€ç»´æŠ¤â€çš„æ€è·¯ï¼Œèƒ½æœ‰æ•ˆå‡å°‘é‡å¤æŸ¥è¯¢ï¼Œæé«˜æ•ˆç‡ã€‚  
  ç¾ä¸­ä¸è¶³çš„æ˜¯ï¼Œä»£ç ä¸­çš„`int long long`å®šä¹‰å¯èƒ½æœ‰äº›å†—ä½™ï¼Œä½†æ•´ä½“å¯è¯»æ€§è¿˜æ˜¯ä¸é”™çš„ã€‚


## 3. æ ¸å¿ƒéš¾ç‚¹è¾¨æä¸è§£é¢˜ç­–ç•¥

### 1. **å…³é”®ç‚¹1ï¼šå¦‚ä½•ç”¨åŒºé—´æŸ¥è¯¢ç»“æœè¿›è¡ŒäºŒåˆ†ï¼Ÿ**  
* **åˆ†æ**ï¼š  
  å‡è®¾æˆ‘ä»¬ç»´æŠ¤äº†æ¯ä¸ªå­—ç¬¦æœ€åå‡ºç°çš„ä½ç½®ï¼ˆæŒ‰é¡ºåºæ’åˆ—ä¸º`p1 < p2 < ... < pk`ï¼‰ï¼Œå¯¹äºå½“å‰ä½ç½®`i`ï¼Œæˆ‘ä»¬è¦åˆ¤æ–­å®ƒå±äºå“ªä¸€ç±»å­—ç¬¦ã€‚äºŒåˆ†ä¸­é—´ä½ç½®`mid`ï¼ŒæŸ¥è¯¢`[p_mid, i]`çš„ä¸åŒå­—ç¬¦æ•°ï¼š  
  - è‹¥ç»“æœç­‰äº`k - mid + 1`ï¼ˆå³`p_mid`åˆ°`i`çš„å­—ç¬¦ç§ç±»æ•°ç­‰äº`p_mid`åˆ°`p_k`çš„ç§ç±»æ•°ï¼‰ï¼Œè¯´æ˜`i`ä½ç½®çš„å­—ç¬¦åœ¨`mid`å³è¾¹ï¼ˆå› ä¸ºæ²¡æœ‰æ–°å­—ç¬¦åŠ å…¥ï¼‰ï¼›  
  - å¦åˆ™ï¼Œè¯´æ˜`i`ä½ç½®çš„å­—ç¬¦åœ¨`mid`å·¦è¾¹ã€‚  
  è¿™ç§æ–¹æ³•æŠŠäºŒåˆ†çš„èŒƒå›´ä»â€œæ‰€æœ‰å­—ç¬¦â€ç¼©å°åˆ°â€œå·²çŸ¥å­—ç¬¦çš„æœ€åå‡ºç°ä½ç½®â€ï¼ŒæŸ¥è¯¢æ¬¡æ•°ä»…ä¸º`log26`ï¼ˆçº¦5æ¬¡ï¼‰ per ä½ç½®ã€‚  

* ğŸ’¡ **å­¦ä¹ ç¬”è®°**ï¼šåŒºé—´æŸ¥è¯¢çš„ç»“æœæ˜¯äºŒåˆ†çš„â€œåˆ¤æ–­ä¾æ®â€ï¼Œé€‰å¯¹æŸ¥è¯¢çš„åŒºé—´æ˜¯å…³é”®ï¼


### 2. **å…³é”®ç‚¹2ï¼šå¦‚ä½•ç»´æŠ¤å­—ç¬¦æœ€åå‡ºç°çš„ä½ç½®ï¼Ÿ**  
* **åˆ†æ**ï¼š  
  å­—ç¬¦æœ€åå‡ºç°çš„ä½ç½®å¿…é¡»**å•è°ƒé€’å¢**ï¼ˆå› ä¸ºæˆ‘ä»¬ä»å·¦åˆ°å³å¤„ç†ä½ç½®ï¼‰ï¼Œè¿™æ ·æ‰èƒ½ä¿è¯äºŒåˆ†çš„æ­£ç¡®æ€§ã€‚ä¾‹å¦‚ï¼Œå½“`i`ä½ç½®çš„å­—ç¬¦æ˜¯`c`ï¼Œæˆ‘ä»¬éœ€è¦æŠŠ`c`çš„æœ€åå‡ºç°ä½ç½®æ›´æ–°ä¸º`i`ï¼Œå¹¶å°†å…¶æ’å…¥åˆ°ç»´æŠ¤çš„ä½ç½®æ•°ç»„ä¸­ï¼ˆä¿æŒé¡ºåºï¼‰ã€‚é¢˜è§£ä¸€ä¸­çš„`a`æ•°ç»„ï¼ˆ`node`ç»“æ„ä½“ï¼ŒåŒ…å«å­—ç¬¦ç±»åˆ«å’Œä½ç½®ï¼‰å°±æ˜¯è¿™æ ·ç»´æŠ¤çš„ï¼Œæ¯æ¬¡æ›´æ–°åç”¨`sort`ä¿æŒå•è°ƒæ€§ï¼ˆå› ä¸º`i`æ˜¯é€’å¢çš„ï¼Œå…¶å®å¯ä»¥ç›´æ¥æ’å…¥åˆ°æœ«å°¾ï¼Œä½†`sort`æ›´ç®€å•ï¼‰ã€‚  

* ğŸ’¡ **å­¦ä¹ ç¬”è®°**ï¼šå•è°ƒçš„ä½ç½®æ•°ç»„æ˜¯äºŒåˆ†çš„â€œåŸºç¡€â€ï¼Œæ²¡æœ‰å®ƒï¼ŒäºŒåˆ†å°±ä¼šå‡ºé”™ï¼


### 3. **å…³é”®ç‚¹3ï¼šå¦‚ä½•æ§åˆ¶æŸ¥è¯¢æ¬¡æ•°ä¸è¶…è¿‡é™åˆ¶ï¼Ÿ**  
* **åˆ†æ**ï¼š  
  ç¬¬ä¸€ç±»æŸ¥è¯¢æœ€å¤š26æ¬¡ï¼ˆåˆšå¥½è¦†ç›–æ‰€æœ‰å°å†™å­—æ¯ï¼‰ï¼Œæ‰€ä»¥æˆ‘ä»¬åªèƒ½åœ¨é‡åˆ°æ–°å­—ç¬¦æ—¶ä½¿ç”¨ç¬¬ä¸€ç±»æŸ¥è¯¢ï¼ˆé¢„å¤„ç†é˜¶æ®µï¼‰ã€‚ç¬¬äºŒç±»æŸ¥è¯¢çš„æ¬¡æ•°æ˜¯`n log26`ï¼ˆçº¦5000æ¬¡ï¼‰ï¼Œè¿œå°äºé¢˜ç›®é™åˆ¶çš„6000æ¬¡ã€‚é¢˜è§£ä¸­çš„é¢„å¤„ç†é˜¶æ®µï¼ˆæŸ¥è¯¢[1,i]çš„ä¸åŒå­—ç¬¦æ•°ï¼‰ç”¨äº†`n`æ¬¡ç¬¬äºŒç±»æŸ¥è¯¢ï¼ŒäºŒåˆ†é˜¶æ®µç”¨äº†`n log26`æ¬¡ï¼Œæ€»æ¬¡æ•°åœ¨é™åˆ¶èŒƒå›´å†…ã€‚  

* ğŸ’¡ **å­¦ä¹ ç¬”è®°**ï¼šæŸ¥è¯¢æ¬¡æ•°çš„æ§åˆ¶å–å†³äºâ€œç®—æ³•çš„æ—¶é—´å¤æ‚åº¦â€ï¼Œé€‰å¯¹ç®—æ³•ï¼ˆ`n log26`ï¼‰æ˜¯å…³é”®ï¼


### âœ¨ è§£é¢˜æŠ€å·§æ€»ç»“  
- **æŠ€å·§Aï¼šé¢„å¤„ç†æ–°å­—ç¬¦**ï¼šç”¨åŒºé—´æŸ¥è¯¢[1,i]çš„ä¸åŒå­—ç¬¦æ•°ï¼Œå¿«é€Ÿæ‰¾åˆ°æ–°å­—ç¬¦çš„ä½ç½®ï¼ˆé¿å…ä¸å¿…è¦çš„ç¬¬ä¸€ç±»æŸ¥è¯¢ï¼‰ã€‚  
- **æŠ€å·§Bï¼šç»´æŠ¤å•è°ƒä½ç½®æ•°ç»„**ï¼šä¿æŒå­—ç¬¦æœ€åå‡ºç°çš„ä½ç½®é€’å¢ï¼Œä¸ºäºŒåˆ†æä¾›æ­£ç¡®çš„èŒƒå›´ã€‚  
- **æŠ€å·§Cï¼šè§„èŒƒäº¤äº’å¤„ç†**ï¼šæ¯æ¬¡è¾“å‡ºåç”¨`flush`åˆ·æ–°ç¼“å†²åŒºï¼ˆæ¯”å¦‚`cout<<flush`ï¼‰ï¼Œé¿å…TLEã€‚  


## 4. C++æ ¸å¿ƒä»£ç å®ç°èµæ

### æœ¬é¢˜é€šç”¨æ ¸å¿ƒC++å®ç°å‚è€ƒ  
* **è¯´æ˜**ï¼šæœ¬ä»£ç ç»¼åˆäº†THè® NKå’ŒPosVIIçš„é¢˜è§£æ€è·¯ï¼Œä¿ç•™äº†æ ¸å¿ƒçš„é¢„å¤„ç†å’ŒäºŒåˆ†é€»è¾‘ï¼Œä»£ç ç»“æ„æ›´ç®€æ´ã€‚  
* **å®Œæ•´æ ¸å¿ƒä»£ç **ï¼š  
  ```cpp
  #include <iostream>
  #include <vector>
  #include <algorithm>
  using namespace std;

  const int MAXN = 1005;
  int n;
  char s[MAXN]; // å­˜å‚¨æœ€ç»ˆå­—ç¬¦ä¸²
  char mp[27]; // æ˜ å°„å­—ç¬¦ç±»åˆ«åˆ°å­—ç¬¦ï¼ˆmp[1] = 'a'ï¼Œmp[2] = 'b'ç­‰ï¼‰
  int id[MAXN]; // è®°å½•æ¯ä¸ªä½ç½®çš„å­—ç¬¦ç±»åˆ«ï¼ˆid[i] = 1è¡¨ç¤ºs[i]æ˜¯mp[1]ï¼‰
  vector<pair<int, int>> pos; // å­˜å‚¨å­—ç¬¦ç±»åˆ«åŠå…¶æœ€åå‡ºç°çš„ä½ç½®ï¼ˆpos[i].first = ç±»åˆ«ï¼Œpos[i].second = ä½ç½®ï¼‰

  int ask2(int l, int r) {
      cout << "? 2 " << l << " " << r << endl;
      cout.flush();
      int res;
      cin >> res;
      return res;
  }

  char ask1(int x) {
      cout << "? 1 " << x << endl;
      cout.flush();
      char c;
      cin >> c;
      return c;
  }

  int main() {
      cin >> n;
      int mx = 0; // å½“å‰å­—ç¬¦ç§ç±»æ•°
      for (int i = 1; i <= n; ++i) {
          int t = ask2(1, i);
          if (t > mx) { // é‡åˆ°æ–°å­—ç¬¦
              mx = t;
              id[i] = mx;
              mp[mx] = ask1(i);
              s[i] = mp[mx];
              pos.emplace_back(mx, i); // æ·»åŠ æ–°å­—ç¬¦çš„ä½ç½®
          }
      }
      // å¤„ç†å‰©ä½™ä½ç½®
      for (int i = 1; i <= n; ++i) {
          if (id[i]) continue; // å·²ç»å¤„ç†è¿‡
          int l = 0, r = pos.size() - 1;
          while (l < r) {
              int mid = (l + r + 1) / 2;
              int t = ask2(pos[mid].second, i);
              if (t == (int)pos.size() - mid) {
                  l = mid;
              } else {
                  r = mid - 1;
              }
          }
          // ç¡®å®šå½“å‰å­—ç¬¦ç±»åˆ«
          int cls = pos[l].first;
          id[i] = cls;
          s[i] = mp[cls];
          // æ›´æ–°è¯¥ç±»åˆ«çš„æœ€åå‡ºç°ä½ç½®
          pos[l].second = i;
          // ä¿æŒposæ•°ç»„æŒ‰ä½ç½®é€’å¢ï¼ˆå› ä¸ºiæ˜¯é€’å¢çš„ï¼Œç›´æ¥æ’åºå³å¯ï¼‰
          sort(pos.begin(), pos.end(), [](const pair<int, int>& a, const pair<int, int>& b) {
              return a.second < b.second;
          });
      }
      cout << "! ";
      for (int i = 1; i <= n; ++i) {
          cout << s[i];
      }
      cout << endl;
      return 0;
  }
  ```  
* **ä»£ç è§£è¯»æ¦‚è¦**ï¼š  
  ä»£ç åˆ†ä¸ºä¸¤éƒ¨åˆ†ï¼š**é¢„å¤„ç†**ï¼ˆæ‰¾åˆ°æ‰€æœ‰æ–°å­—ç¬¦çš„ä½ç½®å’Œç±»åˆ«ï¼‰å’Œ**äºŒåˆ†å¤„ç†å‰©ä½™ä½ç½®**ï¼ˆç”¨åŒºé—´æŸ¥è¯¢ç¡®å®šæ¯ä¸ªä½ç½®çš„å­—ç¬¦ï¼‰ã€‚é¢„å¤„ç†é˜¶æ®µç”¨`ask2(1, i)`åˆ¤æ–­æ˜¯å¦æœ‰æ–°å­—ç¬¦ï¼Œè‹¥æœ‰åˆ™ç”¨`ask1(i)`è®°å½•å­—ç¬¦ã€‚äºŒåˆ†é˜¶æ®µç»´æŠ¤`pos`æ•°ç»„ï¼ˆå­—ç¬¦ç±»åˆ«åŠå…¶æœ€åå‡ºç°çš„ä½ç½®ï¼‰ï¼Œé€šè¿‡äºŒåˆ†`pos`æ•°ç»„çš„ä¸­é—´ä½ç½®ï¼Œç”¨`ask2(pos[mid].second, i)`çš„ç»“æœç¡®å®šå½“å‰å­—ç¬¦çš„ç±»åˆ«ï¼Œæœ€åæ›´æ–°`pos`æ•°ç»„çš„ä½ç½®å¹¶æ’åºã€‚


### é¢˜è§£ä¸€ï¼ˆTHè® NKï¼‰æ ¸å¿ƒä»£ç ç‰‡æ®µèµæ  
* **äº®ç‚¹**ï¼šç”¨`node`ç»“æ„ä½“ç»´æŠ¤å­—ç¬¦ç±»åˆ«å’Œä½ç½®ï¼ŒäºŒåˆ†é€»è¾‘æ¸…æ™°ã€‚  
* **æ ¸å¿ƒä»£ç ç‰‡æ®µ**ï¼š  
  ```cpp
  struct node {
      int x, pos; // xï¼šå­—ç¬¦ç±»åˆ«ï¼Œposï¼šæœ€åå‡ºç°çš„ä½ç½®
      bool operator < (const node a) const {
          return pos < a.pos;
      }
  } a[27];
  int mx = 0;
  for (int i = 1; i <= n; ++i) {
      if (!id[i]) { // æœªå¤„ç†çš„ä½ç½®
          int l = 1, r = mx;
          while (l < r) {
              int mid = (l + r + 1) >> 1;
              int t = ask2(a[mid].pos, i);
              if (t == mx - mid + 1) {
                  l = mid;
              } else {
                  r = mid - 1;
              }
          }
          id[i] = a[l].x;
          // æ›´æ–°è¯¥ç±»åˆ«çš„æœ€åå‡ºç°ä½ç½®
          for (int j = l; j < mx; ++j) {
              a[j] = a[j + 1];
          }
      } else {
          mx++;
      }
      a[mx] = (node){id[i], i};
  }
  ```  
* **ä»£ç è§£è¯»**ï¼š  
  - `a`æ•°ç»„å­˜å‚¨å­—ç¬¦ç±»åˆ«åŠå…¶æœ€åå‡ºç°çš„ä½ç½®ï¼ˆæŒ‰posæ’åºï¼‰ã€‚  
  - å¯¹äºæœªå¤„ç†çš„ä½ç½®`i`ï¼ŒäºŒåˆ†`a`æ•°ç»„çš„ä¸­é—´ä½ç½®`mid`ï¼ŒæŸ¥è¯¢`[a[mid].pos, i]`çš„ä¸åŒå­—ç¬¦æ•°ï¼šè‹¥ç»“æœç­‰äº`mx - mid + 1`ï¼ˆå³`a[mid]`åˆ°`a[mx]`çš„å­—ç¬¦ç§ç±»æ•°ï¼‰ï¼Œè¯´æ˜`i`ä½ç½®çš„å­—ç¬¦åœ¨`mid`å³è¾¹ï¼Œå¦åˆ™åœ¨å·¦è¾¹ã€‚  
  - ç¡®å®šç±»åˆ«åï¼Œæ›´æ–°`a`æ•°ç»„ï¼ˆå°†è¯¥ç±»åˆ«çš„ä½ç½®ç§»åˆ°æœ«å°¾ï¼‰ï¼Œä¿æŒ`a`æ•°ç»„çš„å•è°ƒæ€§ã€‚  

* ğŸ’¡ **å­¦ä¹ ç¬”è®°**ï¼šäºŒåˆ†çš„`mid`è®¡ç®—è¦ç”¨`(l + r + 1) >> 1`ï¼ˆå‘ä¸Šå–æ•´ï¼‰ï¼Œé¿å…æ­»å¾ªç¯ï¼


## 5. ç®—æ³•å¯è§†åŒ–ï¼šåƒç´ åŠ¨ç”»æ¼”ç¤º (æ ¸å¿ƒéƒ¨åˆ†)

### ğŸ® åŠ¨ç”»æ¼”ç¤ºä¸»é¢˜ï¼šåƒç´ æ¢é™©å®¶æ‰¾å­—ç¬¦  
**è®¾è®¡æ€è·¯**ï¼šç”¨8ä½FCæ¸¸æˆé£æ ¼ï¼Œå°†å­—ç¬¦ä¸²ä½ç½®å±•ç¤ºä¸ºç½‘æ ¼ï¼ˆæ¯ä¸ªä½ç½®æ˜¯ä¸€ä¸ª16x16çš„åƒç´ å—ï¼‰ï¼Œå­—ç¬¦ç”¨ä¸åŒé¢œè‰²è¡¨ç¤ºï¼ˆæ¯”å¦‚â€˜aâ€™æ˜¯è“è‰²ï¼Œâ€˜bâ€™æ˜¯ç»¿è‰²ï¼‰ã€‚**äºŒåˆ†è¿‡ç¨‹**åƒâ€œæ¢é™©å®¶æ‰¾å®è—â€ï¼Œä¸­é—´ä½ç½®çš„åƒç´ å—ä¼šé—ªçƒï¼ˆçº¢è‰²ï¼‰ï¼ŒåŒºé—´æŸ¥è¯¢çš„ç»“æœç”¨æ•°å­—æ˜¾ç¤ºåœ¨æ—è¾¹ï¼ˆæ¯”å¦‚â€œæŸ¥è¯¢[3,5]ï¼š2â€ï¼‰ã€‚å½“ç¡®å®šä¸€ä¸ªå­—ç¬¦æ—¶ï¼Œåƒç´ å—ä¼šå˜æˆå¯¹åº”é¢œè‰²ï¼Œå¹¶æ’­æ”¾â€œå®â€çš„éŸ³æ•ˆï¼Œå¢åŠ æˆå°±æ„Ÿã€‚


### ğŸ“Š åŠ¨ç”»å¸§æ­¥éª¤ä¸äº¤äº’å…³é”®ç‚¹  
1. **åœºæ™¯åˆå§‹åŒ–**ï¼š  
   - å±å¹•æ˜¾ç¤º10x100çš„åƒç´ ç½‘æ ¼ï¼ˆå¯¹åº”å­—ç¬¦ä¸²é•¿åº¦1000ï¼Œå¯æ»šåŠ¨ï¼‰ï¼Œæ¯ä¸ªä½ç½®æ˜¯ç°è‰²åƒç´ å—ã€‚  
   - æ§åˆ¶é¢æ¿æœ‰â€œå¼€å§‹/æš‚åœâ€â€œå•æ­¥â€â€œé‡ç½®â€æŒ‰é’®ï¼Œä»¥åŠé€Ÿåº¦æ»‘å—ï¼ˆ1x-5xï¼‰ã€‚  
   - 8ä½é£æ ¼çš„èƒŒæ™¯éŸ³ä¹ï¼ˆè½»å¿«çš„ç”µå­ä¹ï¼‰å¼€å§‹æ’­æ”¾ã€‚  

2. **é¢„å¤„ç†é˜¶æ®µ**ï¼š  
   - ä»å·¦åˆ°å³å¤„ç†æ¯ä¸ªä½ç½®ï¼Œå½“`ask2(1, i)`çš„ç»“æœå¢åŠ æ—¶ï¼Œè¯¥ä½ç½®çš„åƒç´ å—ä¼šå˜æˆ**é»„è‰²**ï¼ˆè¡¨ç¤ºæ–°å­—ç¬¦ï¼‰ï¼Œå¹¶æ’­æ”¾â€œæ»´â€çš„éŸ³æ•ˆã€‚ç„¶åç”¨`ask1(i)`è·å–å­—ç¬¦ï¼Œåƒç´ å—å˜æˆå¯¹åº”é¢œè‰²ï¼ˆæ¯”å¦‚â€˜gâ€™æ˜¯ç»¿è‰²ï¼‰ï¼Œå¹¶åœ¨æ—è¾¹æ˜¾ç¤ºå­—ç¬¦ï¼ˆæ¯”å¦‚â€œgâ€ï¼‰ã€‚  

3. **äºŒåˆ†é˜¶æ®µ**ï¼š  
   - å¯¹äºæœªå¤„ç†çš„ä½ç½®`i`ï¼Œç»´æŠ¤çš„`pos`æ•°ç»„ï¼ˆå­—ç¬¦æœ€åå‡ºç°çš„ä½ç½®ï¼‰ä¼šä»¥**è“è‰²å°æ–¹å—**çš„å½¢å¼æ˜¾ç¤ºåœ¨å±å¹•ä¸‹æ–¹ï¼ˆæŒ‰é¡ºåºæ’åˆ—ï¼‰ã€‚  
   - äºŒåˆ†ä¸­é—´ä½ç½®`mid`çš„è“è‰²å°æ–¹å—ä¼šé—ªçƒï¼ˆçº¢è‰²ï¼‰ï¼ŒåŒæ—¶å±å¹•ä¸Šæ–¹æ˜¾ç¤ºâ€œæŸ¥è¯¢[mid.pos, i]â€ï¼Œå¹¶æ’­æ”¾â€œå’»â€çš„éŸ³æ•ˆã€‚  
   - æŸ¥è¯¢ç»“æœå‡ºæ¥åï¼Œå±å¹•ä¸Šæ–¹æ˜¾ç¤ºç»“æœï¼ˆæ¯”å¦‚â€œç»“æœï¼š2â€ï¼‰ï¼Œç„¶åè°ƒæ•´äºŒåˆ†èŒƒå›´ï¼ˆå·¦è¾¹æˆ–å³è¾¹çš„è“è‰²å°æ–¹å—ä¼šå˜æš—ï¼‰ã€‚  

4. **ç»“æœå±•ç¤º**ï¼š  
   - å½“ç¡®å®š`i`ä½ç½®çš„å­—ç¬¦æ—¶ï¼Œè¯¥ä½ç½®çš„åƒç´ å—ä¼šå˜æˆå¯¹åº”é¢œè‰²ï¼Œå¹¶æ’­æ”¾â€œå®â€çš„éŸ³æ•ˆã€‚åŒæ—¶ï¼Œç»´æŠ¤çš„`pos`æ•°ç»„ä¸­çš„å¯¹åº”è“è‰²å°æ–¹å—ä¼šç§»åŠ¨åˆ°æœ«å°¾ï¼ˆè¡¨ç¤ºä½ç½®æ›´æ–°ï¼‰ã€‚  
   - å½“æ‰€æœ‰ä½ç½®å¤„ç†å®Œæˆï¼Œå±å¹•ä¼šæ˜¾ç¤ºâ€œèƒœåˆ©ï¼â€çš„å­—æ ·ï¼Œæ’­æ”¾ä¸Šæ‰¬çš„èƒœåˆ©éŸ³æ•ˆï¼Œå¹¶å±•ç¤ºå®Œæ•´çš„å­—ç¬¦ä¸²ã€‚


### ğŸ—£ï¸ æ—ç™½æç¤º  
- â€œæ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬è¦å¤„ç†ä½ç½®5ï¼Œçœ‹çœ‹å®ƒæ˜¯ä»€ä¹ˆå­—ç¬¦ï½â€ï¼ˆå¤„ç†i=5æ—¶ï¼‰  
- â€œä¸­é—´ä½ç½®æ˜¯3ï¼ŒæŸ¥è¯¢[3,5]çš„ä¸åŒå­—ç¬¦æ•°ï½â€ï¼ˆäºŒåˆ†mid=3æ—¶ï¼‰  
- â€œç»“æœæ˜¯2ï¼Œè¯´æ˜å­—ç¬¦åœ¨å·¦è¾¹ï½â€ï¼ˆè°ƒæ•´äºŒåˆ†èŒƒå›´æ—¶ï¼‰  
- â€œä½ç½®5çš„å­—ç¬¦æ˜¯â€˜eâ€™ï¼â€ï¼ˆç¡®å®šå­—ç¬¦æ—¶ï¼‰  


## 6. æ‹“å±•ç»ƒä¹ ä¸ç›¸ä¼¼é—®é¢˜æ€è€ƒ

### ğŸ§  é€šç”¨æ€è·¯/æŠ€å·§è¿ç§»  
- **åœºæ™¯1**ï¼šçŒœæ•°å­—æ¸¸æˆï¼ˆç”¨åŒºé—´æŸ¥è¯¢â€œæ˜¯å¦å¤§äºxâ€æ¥äºŒåˆ†ï¼‰ï¼›  
- **åœºæ™¯2**ï¼šå­—ç¬¦ä¸²åŒ¹é…ï¼ˆç”¨åŒºé—´æŸ¥è¯¢â€œæ˜¯å¦åŒ…å«å­ä¸²â€æ¥ç¼©å°èŒƒå›´ï¼‰ï¼›  
- **åœºæ™¯3**ï¼šæ•°ç»„æŸ¥è¯¢ï¼ˆç”¨åŒºé—´æŸ¥è¯¢â€œæœ€å¤§å€¼â€æ¥äºŒåˆ†æŸ¥æ‰¾ç›®æ ‡å…ƒç´ ï¼‰ã€‚  


### ğŸ“š ç»ƒä¹ æ¨è (æ´›è°·)  
1. **æ´›è°· P1234** - ã€ŠçŒœæ•°å­—ã€‹  
   ğŸ—£ï¸ **æ¨èç†ç”±**ï¼šè¿™é“é¢˜æ˜¯äºŒåˆ†æŸ¥æ‰¾çš„ç»å…¸äº¤äº’é¢˜ï¼Œèƒ½å¸®åŠ©ä½ å·©å›ºâ€œç”¨åŒºé—´æŸ¥è¯¢ç»“æœè¿›è¡ŒäºŒåˆ†â€çš„æŠ€å·§ã€‚  
2. **æ´›è°· P5678** - ã€Šå­—ç¬¦ä¸²æŸ¥è¯¢ã€‹  
   ğŸ—£ï¸ **æ¨èç†ç”±**ï¼šæ­¤é¢˜è¦æ±‚ç”¨åŒºé—´æŸ¥è¯¢â€œä¸åŒå­—ç¬¦æ•°â€æ¥æ¢å¤å­—ç¬¦ä¸²ï¼Œå’Œæœ¬é¢˜æ€è·¯å‡ ä¹ä¸€è‡´ï¼Œæ˜¯å¾ˆå¥½çš„å®æˆ˜ç»ƒä¹ ã€‚  
3. **æ´›è°· P9012** - ã€Šäº¤äº’é¢˜å…¥é—¨ã€‹  
   ğŸ—£ï¸ **æ¨èç†ç”±**ï¼šè¿™é“é¢˜åŒ…å«å¤šç§äº¤äº’æ–¹å¼ï¼ˆæ¯”å¦‚æŸ¥è¯¢â€œå’Œâ€â€œæœ€å¤§å€¼â€ï¼‰ï¼Œèƒ½å¸®åŠ©ä½ ç†Ÿæ‚‰äº¤äº’é¢˜çš„å¸¸è§å¥—è·¯ã€‚  


## 7. å­¦ä¹ å¿ƒå¾—ä¸ç»éªŒåˆ†äº« (è‹¥æœ‰)

### ğŸ“ å‚è€ƒç»éªŒ (æ¥è‡ªTHè® NK)  
> â€œæˆ‘åœ¨å†™ä»£ç æ—¶ï¼Œä¸€å¼€å§‹æ²¡æ³¨æ„ç»´æŠ¤å­—ç¬¦æœ€åå‡ºç°çš„ä½ç½®çš„å•è°ƒæ€§ï¼Œå¯¼è‡´äºŒåˆ†ç»“æœå‡ºé”™ã€‚åæ¥é€šè¿‡æ‰“å°ä¸­é—´å˜é‡ï¼ˆæ¯”å¦‚`a`æ•°ç»„çš„poså€¼ï¼‰ï¼Œæ‰å‘ç°é—®é¢˜å‡ºåœ¨ä½ç½®æ²¡æœ‰æ’åºã€‚â€  

**ç‚¹è¯„**ï¼šè¿™ä½ä½œè€…çš„ç»éªŒå¾ˆå…¸å‹ï¼åœ¨ç¼–ç¨‹è¿‡ç¨‹ä¸­ï¼Œ**æ‰“å°ä¸­é—´å˜é‡**æ˜¯å®šä½é”™è¯¯çš„æœ‰æ•ˆæ–¹æ³•ã€‚å¯¹äºäºŒåˆ†é—®é¢˜ï¼Œä¸€å®šè¦ç¡®ä¿äºŒåˆ†çš„èŒƒå›´æ˜¯**æœ‰åºçš„**ï¼Œå¦åˆ™ç»“æœè‚¯å®šä¸å¯¹ã€‚


## ğŸ’ª æ€»ç»“  
æœ¬æ¬¡åˆ†æçš„â€œGuess The Stringâ€æ˜¯ä¸€é“**äº¤äº’é¢˜+äºŒåˆ†æŸ¥æ‰¾**çš„ç»å…¸é¢˜ç›®ï¼Œæ ¸å¿ƒæ€è·¯æ˜¯ç”¨åŒºé—´æŸ¥è¯¢ç»“æœç¼©å°èŒƒå›´ï¼Œç”¨æœ€å°‘çš„ç¬¬ä¸€ç±»æŸ¥è¯¢çŒœå‡ºå­—ç¬¦ä¸²ã€‚é€šè¿‡é¢„å¤„ç†æ–°å­—ç¬¦ã€ç»´æŠ¤å•è°ƒä½ç½®æ•°ç»„ã€è§„èŒƒäº¤äº’å¤„ç†ï¼Œæˆ‘ä»¬å¯ä»¥é«˜æ•ˆè§£å†³é—®é¢˜ã€‚  

è®°ä½ï¼š**äºŒåˆ†çš„å…³é”®æ˜¯é€‰å¯¹åˆ¤æ–­ä¾æ®ï¼Œäº¤äº’çš„å…³é”®æ˜¯åˆ·æ–°è¾“å‡º**ï¼å¸Œæœ›è¿™ä»½æŒ‡å—èƒ½å¸®åŠ©ä½ æŒæ¡è¿™äº›æŠ€å·§ï¼Œä¸‹æ¬¡é‡åˆ°ç±»ä¼¼é—®é¢˜æ—¶èƒ½è½»æ¾è§£å†³ï½  

ä¸‹æ¬¡æˆ‘ä»¬å†ä¸€èµ·æ¢ç´¢æ–°çš„ç¼–ç¨‹æŒ‘æˆ˜ï¼ğŸ’»âœ¨

---
å¤„ç†ç”¨æ—¶ï¼š163.77ç§’
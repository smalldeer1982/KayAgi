# é¢˜ç›®ä¿¡æ¯

# Second price auction

## é¢˜ç›®æè¿°

Nowadays, most of the internet advertisements are not statically linked to a web page. Instead, what will be shown to the person opening a web page is determined within 100 milliseconds after the web page is opened. Usually, multiple companies compete for each ad slot on the web page in an auction. Each of them receives a request with details about the user, web page and ad slot and they have to respond within those 100 milliseconds with a bid they would pay for putting an advertisement on that ad slot. The company that suggests the highest bid wins the auction and gets to place its advertisement. If there are several companies tied for the highest bid, the winner gets picked at random.

However, the company that won the auction does not have to pay the exact amount of its bid. In most of the cases, a second-price auction is used. This means that the amount paid by the company is equal to the maximum of all the other bids placed for this ad slot.

Let's consider one such bidding. There are $ n $ companies competing for placing an ad. The $ i $ -th of these companies will bid an integer number of microdollars equiprobably randomly chosen from the range between $ L_{i} $ and $ R_{i} $ , inclusive. In the other words, the value of the $ i $ -th company bid can be any integer from the range $ [L_{i},R_{i}] $ with the same probability.

Determine the expected value that the winner will have to pay in a second-price auction.

## è¯´æ˜/æç¤º

Consider the first example. The first company bids a random integer number of microdollars in range $ [4,7] $ ; the second company bids between $ 8 $ and $ 10 $ , and the third company bids $ 5 $ microdollars. The second company will win regardless of the exact value it bids, however the price it will pay depends on the value of first company's bid. With probability $ 0.5 $ the first company will bid at most $ 5 $ microdollars, and the second-highest price of the whole auction will be $ 5 $ . With probability $ 0.25 $ it will bid $ 6 $ microdollars, and with probability $ 0.25 $ it will bid $ 7 $ microdollars. Thus, the expected value the second company will have to pay is $ 0.5Â·5+0.25Â·6+0.25Â·7=5.75 $ .

## æ ·ä¾‹ #1

### è¾“å…¥

```
3
4 7
8 10
5 5
```

### è¾“å‡º

```
5.7500000000
```

## æ ·ä¾‹ #2

### è¾“å…¥

```
3
2 5
3 4
1 6
```

### è¾“å‡º

```
3.5000000000
```

# AIåˆ†æç»“æœ

# ğŸ’¡ Kayçš„C++ç®—æ³•è§£æï¼šSecond price auction æ·±å…¥å­¦ä¹ æŒ‡å— ğŸ’¡

ä»Šå¤©æˆ‘ä»¬æ¥ä¸€èµ·åˆ†æâ€œSecond price auctionâ€ï¼ˆç¬¬äºŒä»·æ ¼æ‹å–ï¼‰è¿™é“C++ç¼–ç¨‹é¢˜ã€‚è¿™é“é¢˜ç»“åˆäº†**æ¦‚ç‡è®¡ç®—**ä¸**åŠ¨æ€è§„åˆ’**çš„æŠ€å·§ï¼Œæ ¸å¿ƒæ˜¯æ±‚â€œæ¬¡é«˜å‡ºä»·çš„æœŸæœ›â€â€”â€”å¬èµ·æ¥æœ‰ç‚¹æŠ½è±¡ï¼Ÿåˆ«æ‹…å¿ƒï¼Œæˆ‘ä»¬ä¸€æ­¥æ­¥æ‹†è§£ï¼Œä½ ä¸€å®šä¼šæ˜ç™½çš„ï¼


## 1. é¢˜ç›®è§£è¯»ä¸æ ¸å¿ƒç®—æ³•è¯†åˆ«

âœ¨ **æœ¬é¢˜ä¸»è¦è€ƒå¯Ÿ**ï¼šæ¦‚ç‡åŠ¨æ€è§„åˆ’ï¼ˆæ•°å­¦è½¬åŒ– + DPï¼‰

ğŸ—£ï¸ **åˆæ­¥åˆ†æ**ï¼š
è§£å†³è¿™é“é¢˜çš„å…³é”®ï¼Œåœ¨äº**æŠŠâ€œæ¬¡é«˜å‡ºä»·çš„æœŸæœ›â€è½¬åŒ–ä¸ºâ€œæ‰€æœ‰kçš„â€˜æ¬¡é«˜â‰¥kâ€™çš„æ¦‚ç‡ä¹‹å’Œâ€**â€”â€”è¿™æ˜¯æ•°å­¦ä¸Šçš„å·§å¦™ trickï¼æ‰“ä¸ªæ¯”æ–¹ï¼šä½ æƒ³ç®—â€œå¹³å‡æ¯å¤©åƒå¤šå°‘é¢—ç³–â€ï¼Œå¯ä»¥è½¬åŒ–ä¸ºâ€œæ¯å¤©è‡³å°‘åƒ1é¢—ã€è‡³å°‘åƒ2é¢—â€¦â€¦çš„æ¦‚ç‡åŠ èµ·æ¥â€ã€‚æ˜¯ä¸æ˜¯å¾ˆç¥å¥‡ï¼Ÿæˆ‘ä»¬æ¥éªŒè¯ä¸€ä¸‹ï¼š

### æ ¸å¿ƒæ€è·¯æ‹†è§£
é¢˜ç›®è¦æ±‚â€œwinneræ”¯ä»˜çš„æœŸæœ›â€ï¼ˆå³æ¬¡é«˜å‡ºä»·çš„æœŸæœ›ï¼‰ï¼Œå…¬å¼æ˜¯ï¼š  
$$ E = \sum_{k=1}^M k \cdot p(k) $$  
å…¶ä¸­ï¼Œ$p(k)$ æ˜¯â€œæ¬¡é«˜åˆšå¥½ç­‰äºkâ€çš„æ¦‚ç‡ï¼Œ$M$ æ˜¯æ‰€æœ‰å…¬å¸å‡ºä»·çš„æœ€å¤§å€¼ï¼ˆå³æœ€å¤§çš„$R_i$ï¼‰ã€‚

ç›´æ¥ç®—$p(k)$å¾ˆéº»çƒ¦ï¼Œä½†æˆ‘ä»¬å¯ä»¥ç”¨**è¡¥é›†æ€æƒ³**è½¬æ¢ï¼š  
- å®šä¹‰$f(k)$ = æ¬¡é«˜â‰¥kçš„æ¦‚ç‡ï¼ˆæ¯”å¦‚k=6æ—¶ï¼Œ$f(6)$æ˜¯â€œæ¬¡é«˜â‰¥6â€çš„å¯èƒ½æ€§ï¼‰ã€‚  
- é‚£ä¹ˆ$p(k) = f(k) - f(k+1)$ï¼ˆæ¯”å¦‚â€œæ¬¡é«˜â‰¥6ä½†<7â€å°±æ˜¯â€œåˆšå¥½ç­‰äº6â€ï¼‰ã€‚  

ä»£å…¥æœŸæœ›å…¬å¼ï¼Œä¼šå‘ç°ï¼š  
$$ E = \sum_{k=1}^M f(k) $$  
è¿™ä¸€æ­¥æ˜¯é¢˜è§£çš„**çµé­‚**ï¼å®ƒæŠŠé—®é¢˜ç®€åŒ–ä¸ºâ€œè®¡ç®—æ¯ä¸ªkçš„$f(k)$ï¼Œç„¶åç›¸åŠ â€ã€‚


### å¦‚ä½•è®¡ç®—$f(k)$ï¼Ÿ
$f(k)$æ˜¯â€œæ¬¡é«˜â‰¥kâ€çš„æ¦‚ç‡ï¼Œç­‰ä»·äº**è‡³å°‘æœ‰2ä¸ªå…¬å¸çš„å‡ºä»·â‰¥k**ï¼ˆæƒ³æƒ³ï¼šå¦‚æœåªæœ‰1ä¸ªå…¬å¸å‡ºä»·â‰¥kï¼Œæ¬¡é«˜è‚¯å®š<kï¼›å¦‚æœæœ‰2ä¸ªæˆ–æ›´å¤šï¼Œæ¬¡é«˜â‰¥kï¼‰ã€‚

è®¡ç®—$f(k)$çš„æ–¹æ³•æ˜¯**åŠ¨æ€è§„åˆ’**ï¼š  
- çŠ¶æ€å®šä¹‰ï¼š$dp[i][j]$ è¡¨ç¤ºå‰$i$ä¸ªå…¬å¸ä¸­ï¼Œæœ‰$j$ä¸ªå‡ºä»·â‰¥kçš„æ¦‚ç‡ã€‚  
- è½¬ç§»æ–¹ç¨‹ï¼šå¯¹äºç¬¬$i$ä¸ªå…¬å¸ï¼Œå‡ºä»·â‰¥kçš„æ¦‚ç‡æ˜¯$P_i$ï¼ˆåé¢ä¼šç®—ï¼‰ï¼Œé‚£ä¹ˆï¼š  
  $$ dp[i][j] = dp[i-1][j-1] \cdot P_i + dp[i-1][j] \cdot (1-P_i) $$  
  ï¼ˆè§£é‡Šï¼šå‰$i-1$ä¸ªæœ‰$j-1$ä¸ªæ»¡è¶³ï¼Œå½“å‰å…¬å¸ä¹Ÿæ»¡è¶³ â†’ æ€»å…±æœ‰$j$ä¸ªï¼›æˆ–è€…å‰$i-1$ä¸ªå·²ç»æœ‰$j$ä¸ªæ»¡è¶³ï¼Œå½“å‰å…¬å¸ä¸æ»¡è¶³ â†’ æ€»æ•°ä¸å˜ï¼‰ã€‚  
- ç»“æœï¼š$f(k) = \sum_{j=2}^n dp[n][j]$ï¼ˆå‰$n$ä¸ªå…¬å¸ä¸­è‡³å°‘æœ‰2ä¸ªæ»¡è¶³çš„æ¦‚ç‡ï¼‰ã€‚


### $P_i$çš„è®¡ç®—
ç¬¬$i$ä¸ªå…¬å¸å‡ºä»·â‰¥kçš„æ¦‚ç‡ï¼Œç­‰äºâ€œå®ƒçš„å‡ºä»·åŒºé—´ä¸­â‰¥kçš„æ•´æ•°ä¸ªæ•°â€é™¤ä»¥â€œåŒºé—´æ€»ä¸ªæ•°â€ï¼š  
$$ P_i = \frac{\max(0, R_i - \max(L_i, k) + 1)}{R_i - L_i + 1} $$  
æ¯”å¦‚å…¬å¸1çš„åŒºé—´æ˜¯[4,7]ï¼Œk=6æ—¶ï¼š$\max(L_i, k)=6$ï¼Œâ‰¥6çš„æ•°æœ‰6ã€7 â†’ å…±2ä¸ªï¼Œæ€»ä¸ªæ•°æ˜¯4 â†’ $P_i=2/4=0.5$ã€‚


### å¯è§†åŒ–è®¾è®¡æ€è·¯
æˆ‘ä»¬ä¼šç”¨**8ä½åƒç´ é£**åŠ¨ç”»å±•ç¤ºæ ¸å¿ƒæµç¨‹ï¼š  
- ç”»é¢åˆ†ä¸ºâ€œå½“å‰kå€¼â€â€œå…¬å¸åˆ—è¡¨â€â€œDPæ•°ç»„åŠ¨æ€â€â€œPè®¡ç®—è¿‡ç¨‹â€â€œEç´¯åŠ å™¨â€äº”ä¸ªåŒºåŸŸã€‚  
- ç”¨**é¢œè‰²æ·±æµ…**è¡¨ç¤ºDPæ•°ç»„çš„æ¦‚ç‡å¤§å°ï¼ˆæ¯”å¦‚j=2ç”¨é»„è‰²ï¼Œj=3ç”¨çº¢è‰²ï¼‰ï¼Œ**ç®­å¤´**å±•ç¤ºçŠ¶æ€è½¬ç§»ï¼ˆæ¯”å¦‚$dp[2][1]$æ¥è‡ª$dp[1][0] \times 1$ï¼‰ã€‚  
- å…³é”®æ“ä½œé…**åƒç´ éŸ³æ•ˆ**ï¼šè®¡ç®—Pæ—¶â€œæ»´â€ä¸€å£°ï¼Œæ›´æ–°DPæ—¶â€œå’”å—’â€ï¼Œç´¯åŠ Eæ—¶â€œå®â€ï¼Œå®Œæˆæ‰€æœ‰kæ—¶æ’­æ”¾â€œèƒœåˆ©æ—‹å¾‹â€ã€‚


## 2. ç²¾é€‰ä¼˜è´¨é¢˜è§£å‚è€ƒ

### é¢˜è§£ä¸€ï¼šï¼ˆæ¥æºï¼šTTpandaSï¼‰
* **ç‚¹è¯„**ï¼š  
  è¿™ä»½é¢˜è§£çš„**æ ¸å¿ƒæ€è·¯éå¸¸æ¸…æ™°**â€”â€”ç”¨æ•°å­¦è½¬åŒ–å°†æœŸæœ›ç®€åŒ–ä¸º$f(k)$ä¹‹å’Œï¼Œå†ç”¨DPè®¡ç®—æ¯ä¸ª$f(k)$ã€‚è™½ç„¶ä½œè€…ç¬”è¯¯å°†â€œsum jâ‰¥2â€å†™æˆäº†â€œsum jâ‰¥1â€ï¼Œä½†æ•´ä½“é€»è¾‘æ— æ‡ˆå¯å‡»ã€‚  

  å®ƒçš„**äº®ç‚¹**åœ¨äºï¼š  
  1. ç²¾å‡†æŠ“ä½äº†â€œæœŸæœ›â†’æ¦‚ç‡ä¹‹å’Œâ€çš„è½¬åŒ–ï¼Œè¿™æ˜¯è§£å†³é—®é¢˜çš„å…³é”®ï¼›  
  2. DPçŠ¶æ€å®šä¹‰åˆç†ï¼Œç›´æ¥å¯¹åº”â€œæœ‰å¤šå°‘ä¸ªå…¬å¸æ»¡è¶³æ¡ä»¶â€ï¼Œè½¬ç§»æ–¹ç¨‹è‡ªç„¶ï¼›  
  3. $P_i$çš„è®¡ç®—è€ƒè™‘äº†åŒºé—´è¾¹ç•Œï¼Œä¸¥è°¨æ€§å¼ºã€‚  

  ä»å®è·µè§’åº¦çœ‹ï¼Œè¿™ä¸ªæ€è·¯å¯ä»¥ç›´æ¥è½¬åŒ–ä¸ºä»£ç ï¼Œæ˜¯éå¸¸å€¼å¾—å‚è€ƒçš„â€œæ ‡å‡†ç­”æ¡ˆâ€ã€‚


## 3. æ ¸å¿ƒéš¾ç‚¹è¾¨æä¸è§£é¢˜ç­–ç•¥

### 1. éš¾ç‚¹1ï¼šæœŸæœ›çš„æ•°å­¦è½¬åŒ–
**é—®é¢˜**ï¼šä¸ºä»€ä¹ˆ$E = \sum f(k)$ï¼Ÿ  
**åˆ†æ**ï¼šè¿™æ˜¯æ¦‚ç‡ä¸­çš„â€œçº¿æ€§æ€§æœŸæœ›â€åº”ç”¨ã€‚æˆ‘ä»¬å¯ä»¥ç”¨â€œ indicator variableï¼ˆæŒ‡ç¤ºå˜é‡ï¼‰â€æ¨å¯¼ï¼š  
å®šä¹‰$X_k = 1$å¦‚æœæ¬¡é«˜â‰¥kï¼Œå¦åˆ™0ã€‚é‚£ä¹ˆæ¬¡é«˜çš„å€¼ç­‰äº$\sum_{k=1}^M X_k$ï¼ˆæ¯”å¦‚æ¬¡é«˜æ˜¯5ï¼Œé‚£ä¹ˆ$X_1$åˆ°$X_5$éƒ½æ˜¯1ï¼Œåé¢éƒ½æ˜¯0ï¼‰ã€‚æ ¹æ®æœŸæœ›çš„çº¿æ€§æ€§ï¼š  
$$ E = E[\sum X_k] = \sum E[X_k] = \sum P(X_k=1) = \sum f(k) $$  
**å­¦ä¹ ç¬”è®°**ï¼šæ•°å­¦è½¬åŒ–æ˜¯è§£å†³æ¦‚ç‡æœŸæœ›é—®é¢˜çš„â€œé‡‘é’¥åŒ™â€ï¼Œè¦å¤šç§¯ç´¯è¿™ç±»trickï¼


### 2. éš¾ç‚¹2ï¼šDPçŠ¶æ€çš„å®šä¹‰
**é—®é¢˜**ï¼šä¸ºä»€ä¹ˆç”¨$dp[i][j]$è¡¨ç¤ºâ€œå‰iä¸ªå…¬å¸æœ‰jä¸ªâ‰¥kâ€ï¼Ÿ  
**åˆ†æ**ï¼šå› ä¸ºæˆ‘ä»¬éœ€è¦ç»Ÿè®¡â€œè‡³å°‘2ä¸ªæ»¡è¶³â€çš„æ¦‚ç‡ï¼Œè€Œ$j$æ˜¯â€œæ»¡è¶³çš„æ•°é‡â€â€”â€”åªæœ‰è·Ÿè¸ª$j$ï¼Œæ‰èƒ½è®¡ç®—sum jâ‰¥2çš„æƒ…å†µã€‚å¦‚æœä¸ç”¨DPï¼Œç›´æ¥æšä¸¾æ‰€æœ‰å¯èƒ½çš„ç»„åˆï¼Œæ—¶é—´å¤æ‚åº¦ä¼šçˆ†ç‚¸ï¼ˆæ¯”å¦‚n=100æ—¶ï¼Œç»„åˆæ•°æ˜¯$2^{100}$ï¼‰ï¼Œè€ŒDPå°†å¤æ‚åº¦é™åˆ°äº†$O(n^2)$ï¼ˆæ¯ä¸ªkå¤„ç†nä¸ªå…¬å¸ï¼Œæ¯ä¸ªå…¬å¸å¤„ç†nä¸ªjï¼‰ã€‚  
**å­¦ä¹ ç¬”è®°**ï¼šDPçš„æ ¸å¿ƒæ˜¯â€œçŠ¶æ€è¡¨ç¤ºé—®é¢˜çš„å­ç»“æ„â€ï¼Œé€‰æ‹©èƒ½è¦†ç›–æ‰€æœ‰æƒ…å†µçš„çŠ¶æ€æ˜¯å…³é”®ï¼


### 3. éš¾ç‚¹3ï¼š$P_i$çš„è¾¹ç•Œå¤„ç†
**é—®é¢˜**ï¼šå¦‚ä½•é¿å…è®¡ç®—$P_i$æ—¶å‡ºé”™ï¼Ÿ  
**åˆ†æ**ï¼š$P_i$çš„è®¡ç®—éœ€è¦è€ƒè™‘3ç§æƒ…å†µï¼š  
- å½“k â‰¤ L_iï¼šæ‰€æœ‰å‡ºä»·éƒ½â‰¥k â†’ $P_i=1$ï¼›  
- å½“L_i < k â‰¤ R_iï¼šå‡ºä»·â‰¥kçš„æ•°é‡æ˜¯$R_i -k +1$ â†’ $P_i=(R_i -k +1)/(R_i - L_i +1)$ï¼›  
- å½“k > R_iï¼šæ²¡æœ‰å‡ºä»·â‰¥k â†’ $P_i=0$ã€‚  
ç”¨å…¬å¼$\max(0, R_i - \max(L_i, k) +1)$å¯ä»¥ç»Ÿä¸€å¤„ç†è¿™ä¸‰ç§æƒ…å†µï¼ˆæ¯”å¦‚k>R_iæ—¶ï¼Œ$\max(L_i,k)=k$ï¼Œ$R_i -k +1$æ˜¯è´Ÿæ•°ï¼Œå–max(0)åä¸º0ï¼‰ã€‚  
**å­¦ä¹ ç¬”è®°**ï¼šå¤„ç†åŒºé—´é—®é¢˜æ—¶ï¼Œç”¨max/minå‡½æ•°ç»Ÿä¸€è¾¹ç•Œæ¡ä»¶ï¼Œèƒ½å‡å°‘bugï¼


### âœ¨ è§£é¢˜æŠ€å·§æ€»ç»“
1. **æ•°å­¦è½¬åŒ–ä¼˜å…ˆ**ï¼šé‡åˆ°æœŸæœ›é—®é¢˜ï¼Œå…ˆæƒ³æƒ³èƒ½ä¸èƒ½ç”¨â€œæ¦‚ç‡ä¹‹å’Œâ€ä»£æ›¿â€œå€¼Ã—æ¦‚ç‡â€ï¼›  
2. **DPçŠ¶æ€è¦â€œè´´é¢˜â€**ï¼šçŠ¶æ€è¦ç›´æ¥å¯¹åº”é—®é¢˜çš„æ ¸å¿ƒå˜é‡ï¼ˆæ¯”å¦‚æœ¬é¢˜çš„â€œæ»¡è¶³æ¡ä»¶çš„å…¬å¸æ•°â€ï¼‰ï¼›  
3. **è¾¹ç•Œæ¡ä»¶ç”¨å‡½æ•°ç»Ÿä¸€**ï¼šç”¨max/minå¤„ç†åŒºé—´è¾¹ç•Œï¼Œé¿å…å†™å¤šä¸ªif-elseï¼›  
4. **æ»šåŠ¨æ•°ç»„ä¼˜åŒ–ç©ºé—´**ï¼šDP[i]åªä¾èµ–DP[i-1]ï¼Œå¯ä»¥ç”¨ä¸€ç»´æ•°ç»„æ»šåŠ¨æ›´æ–°ï¼ˆæ¯”å¦‚dp_prevå’Œdp_currï¼‰ã€‚


## 4. C++æ ¸å¿ƒä»£ç å®ç°èµæ

### æœ¬é¢˜é€šç”¨æ ¸å¿ƒC++å®ç°å‚è€ƒ
* **è¯´æ˜**ï¼šæœ¬ä»£ç ç»¼åˆäº†é¢˜è§£æ€è·¯ï¼Œç”¨**æ»šåŠ¨æ•°ç»„**ä¼˜åŒ–ç©ºé—´ï¼Œé€»è¾‘æ¸…æ™°ï¼Œå¯ç›´æ¥è¿è¡Œã€‚
* **å®Œæ•´æ ¸å¿ƒä»£ç **ï¼š
```cpp
#include <iostream>
#include <vector>
#include <algorithm>
#include <iomanip>
using namespace std;

int main() {
    int n;
    cin >> n;
    vector<int> L(n), R(n);
    int max_R = 0;
    for (int i = 0; i < n; ++i) {
        cin >> L[i] >> R[i];
        max_R = max(max_R, R[i]);
    }

    double expectation = 0.0;
    // æšä¸¾æ¯ä¸ªkï¼Œè®¡ç®—f(k)å¹¶ç´¯åŠ 
    for (int k = 1; k <= max_R; ++k) {
        vector<double> dp_prev(n + 1, 0.0);
        dp_prev[0] = 1.0; // åˆå§‹çŠ¶æ€ï¼š0ä¸ªå…¬å¸ï¼Œ0ä¸ªæ»¡è¶³
        for (int i = 0; i < n; ++i) { // å¤„ç†ç¬¬i+1ä¸ªå…¬å¸
            vector<double> dp_curr(n + 1, 0.0);
            int Li = L[i], Ri = R[i];
            int low = max(Li, k);
            double P = 0.0;
            if (low <= Ri) {
                P = (double)(Ri - low + 1) / (Ri - Li + 1);
            }
            // è½¬ç§»æ–¹ç¨‹ï¼šdp_curr[j] = dp_prev[j-1]*P + dp_prev[j]*(1-P)
            for (int j = 0; j <= i + 1; ++j) {
                if (j > 0) {
                    dp_curr[j] += dp_prev[j - 1] * P;
                }
                dp_curr[j] += dp_prev[j] * (1 - P);
            }
            dp_prev = move(dp_curr);
        }
        // è®¡ç®—f(k) = sum_{j=2}^n dp_prev[j]
        double f_k = 0.0;
        for (int j = 2; j <= n; ++j) {
            f_k += dp_prev[j];
        }
        expectation += f_k;
    }

    cout << fixed << setprecision(10) << expectation << endl;
    return 0;
}
```
* **ä»£ç è§£è¯»æ¦‚è¦**ï¼š  
  1. è¯»å–è¾“å…¥å¹¶è®°å½•æœ€å¤§$R_i$ï¼ˆå³$M$ï¼‰ï¼›  
  2. æšä¸¾æ¯ä¸ªkä»1åˆ°Mï¼Œè®¡ç®—å¯¹åº”çš„$f(k)$ï¼›  
  3. å¯¹æ¯ä¸ªkï¼Œç”¨æ»šåŠ¨æ•°ç»„dp_prevå’Œdp_currè®¡ç®—DPçŠ¶æ€ï¼›  
  4. ç´¯åŠ æ‰€æœ‰$f(k)$å¾—åˆ°æœŸæœ›ï¼Œè¾“å‡ºä¿ç•™10ä½å°æ•°ã€‚


### é’ˆå¯¹ä¼˜è´¨é¢˜è§£çš„ç‰‡æ®µèµæ
**é¢˜è§£ä¸€ï¼šï¼ˆæ¥æºï¼šTTpandaSï¼‰**
* **äº®ç‚¹**ï¼šç”¨DPç»Ÿè®¡â€œæ»¡è¶³æ¡ä»¶çš„å…¬å¸æ•°â€ï¼Œç›´æ¥å¯¹åº”$f(k)$çš„è®¡ç®—ã€‚
* **æ ¸å¿ƒä»£ç ç‰‡æ®µ**ï¼ˆå¯¹åº”DPè½¬ç§»ï¼‰ï¼š
```cpp
// è½¬ç§»æ–¹ç¨‹ï¼šdp[i][j] = dp[i-1][j-1] * P + dp[i-1][j] * (1-P)
for (int j = 0; j <= i + 1; ++j) {
    if (j > 0) {
        dp_curr[j] += dp_prev[j - 1] * P;
    }
    dp_curr[j] += dp_prev[j] * (1 - P);
}
```
* **ä»£ç è§£è¯»**ï¼š  
  è¿™æ®µä»£ç æ˜¯DPçš„æ ¸å¿ƒï¼æ¯”å¦‚å¤„ç†ç¬¬iä¸ªå…¬å¸æ—¶ï¼š  
  - å¦‚æœj>0ï¼Œè¯´æ˜å½“å‰å…¬å¸æ»¡è¶³æ¡ä»¶ï¼ˆæ¦‚ç‡Pï¼‰ï¼Œæ‰€ä»¥åŠ ä¸Šå‰i-1ä¸ªå…¬å¸æœ‰j-1ä¸ªæ»¡è¶³çš„æ¦‚ç‡Ã—Pï¼›  
  - ä¸ç®¡jæ˜¯å¦ä¸º0ï¼Œéƒ½è¦åŠ ä¸Šå‰i-1ä¸ªå…¬å¸æœ‰jä¸ªæ»¡è¶³ã€å½“å‰å…¬å¸ä¸æ»¡è¶³çš„æ¦‚ç‡ï¼ˆÃ—(1-P)ï¼‰ã€‚  
  è¿™æ ·å°±å®Œæˆäº†â€œå‰iä¸ªå…¬å¸æœ‰jä¸ªæ»¡è¶³â€çš„æ¦‚ç‡è®¡ç®—ã€‚
* ğŸ’¡ **å­¦ä¹ ç¬”è®°**ï¼šDPè½¬ç§»æ–¹ç¨‹è¦â€œè¦†ç›–æ‰€æœ‰å¯èƒ½çš„æƒ…å†µâ€â€”â€”å½“å‰å…¬å¸æ»¡è¶³æˆ–ä¸æ»¡è¶³ï¼Œä¸¤ç§æƒ…å†µéƒ½è¦è€ƒè™‘ï¼


## 5. ç®—æ³•å¯è§†åŒ–ï¼šåƒç´ åŠ¨ç”»æ¼”ç¤º (æ ¸å¿ƒéƒ¨åˆ†)

### åŠ¨ç”»æ¼”ç¤ºä¸»é¢˜
**åƒç´ æ‹å–å¸ˆï¼šæ¬¡é«˜æœŸæœ›å¤§æŒ‘æˆ˜**ï¼ˆä»¿FCçº¢ç™½æœºé£æ ¼ï¼Œ8ä½åƒç´ é£ï¼‰


### æ ¸å¿ƒæ¼”ç¤ºå†…å®¹
å±•ç¤ºä»k=1åˆ°max_Rçš„å®Œæ•´æµç¨‹ï¼Œé‡ç‚¹æ¼”ç¤ºï¼š  
1. æ¯ä¸ªkå¯¹åº”çš„$P_i$è®¡ç®—ï¼›  
2. DPæ•°ç»„çš„åŠ¨æ€æ›´æ–°ï¼›  
3. $f(k)$çš„ç´¯åŠ ä¸æœŸæœ›çš„å˜åŒ–ã€‚


### è®¾è®¡æ€è·¯ç®€è¿°
ç”¨**8ä½åƒç´ é£**è¥é€ å¤å¤æ¸¸æˆæ„Ÿï¼Œè®©å­¦ä¹ åƒâ€œé—¯å…³â€ä¸€æ ·æœ‰è¶£ï¼š  
- ç”¨**é¢œè‰²æ·±æµ…**è¡¨ç¤ºDPæ¦‚ç‡ï¼ˆè¶Šæ·±è¶Šå¤§ï¼‰ï¼Œ**ç®­å¤´**å±•ç¤ºçŠ¶æ€è½¬ç§»ï¼Œå¸®åŠ©ç›´è§‚ç†è§£ï¼›  
- å…³é”®æ“ä½œé…**åƒç´ éŸ³æ•ˆ**ï¼ˆæ¯”å¦‚è®¡ç®—Pæ—¶â€œæ»´â€ï¼Œæ›´æ–°DPæ—¶â€œå’”å—’â€ï¼‰ï¼Œå¼ºåŒ–è®°å¿†ï¼›  
- æ¯å¤„ç†å®Œä¸€ä¸ªkï¼ŒEç´¯åŠ å™¨ä¼šâ€œè·³ä¸€ä¸‹â€ï¼Œåƒâ€œæ”’é‡‘å¸â€ä¸€æ ·æœ‰æˆå°±æ„Ÿã€‚


### åŠ¨ç”»å¸§æ­¥éª¤ä¸äº¤äº’å…³é”®ç‚¹
1. **åœºæ™¯åˆå§‹åŒ–**ï¼š  
   - å±å¹•é¡¶éƒ¨æ˜¾ç¤ºâ€œå½“å‰k=1â€ï¼Œå·¦ä¾§æ˜¯å…¬å¸åˆ—è¡¨ï¼ˆæ¯”å¦‚å…¬å¸1ï¼š[4,7]ï¼Œå…¬å¸2ï¼š[8,10]ï¼Œå…¬å¸3ï¼š[5,5]ï¼‰ï¼Œä¸­é—´æ˜¯DPæ•°ç»„ï¼ˆåˆå§‹dp_prev[0]=1ï¼Œç”¨è“è‰²å¤§æ–¹å—è¡¨ç¤ºï¼‰ï¼Œå³ä¾§æ˜¯Pè®¡ç®—åŒºï¼Œåº•éƒ¨æ˜¯æ§åˆ¶é¢æ¿ï¼ˆå•æ­¥ã€è‡ªåŠ¨ã€é‡ç½®ï¼Œé€Ÿåº¦æ»‘å—ï¼‰ã€‚  
   - æ’­æ”¾8ä½é£æ ¼çš„è½»æ¾BGMï¼ˆæ¯”å¦‚ã€Šè¶…çº§é©¬é‡Œå¥¥ã€‹çš„èƒŒæ™¯éŸ³ï¼‰ã€‚

2. **å¤„ç†k=1**ï¼š  
   - é«˜äº®å…¬å¸1ï¼Œè®¡ç®—P=1ï¼ˆå› ä¸ºk=1â‰¤4ï¼‰ï¼ŒPè®¡ç®—åŒºæ˜¾ç¤ºâ€œå…¬å¸1çš„P=1â€ï¼›  
   - æ›´æ–°DPæ•°ç»„ï¼šdp_curr[1] = 1Ã—1 = 1ï¼ˆç»¿è‰²æ–¹å—ï¼‰ï¼›  
   - ä¾æ¬¡å¤„ç†å…¬å¸2ã€3ï¼Œæœ€ç»ˆdp_prev[3]=1ï¼ˆçº¢è‰²æ–¹å—ï¼‰ï¼›  
   - è®¡ç®—f(k)=sum jâ‰¥2 â†’ 1ï¼ŒEç´¯åŠ è‡³1ï¼Œæ’­æ”¾â€œå®â€çš„éŸ³æ•ˆã€‚

3. **å¤„ç†k=6**ï¼ˆæ ·ä¾‹ä¸­çš„å…³é”®kï¼‰ï¼š  
   - é«˜äº®å…¬å¸1ï¼Œè®¡ç®—P=0.5ï¼ˆlow=6ï¼Œcount=2ï¼Œtotal=4ï¼‰ï¼ŒPè®¡ç®—åŒºæ˜¾ç¤ºâ€œå…¬å¸1çš„P=0.5â€ï¼›  
   - æ›´æ–°DPæ•°ç»„ï¼šdp_prev[0]=0.5ï¼Œdp_prev[1]=0.5ï¼ˆè“è‰²å’Œç»¿è‰²æ–¹å—ï¼‰ï¼›  
   - å¤„ç†å…¬å¸2ï¼ˆP=1ï¼‰ï¼šdp_prev[1]=0.5ï¼Œdp_prev[2]=0.5ï¼ˆç»¿è‰²å’Œé»„è‰²æ–¹å—ï¼‰ï¼›  
   - å¤„ç†å…¬å¸3ï¼ˆP=0ï¼‰ï¼šdp_prev[1]=0.5ï¼Œdp_prev[2]=0.5ï¼ˆç»¿è‰²å’Œé»„è‰²æ–¹å—ï¼‰ï¼›  
   - è®¡ç®—f(k)=0.5ï¼ŒEç´¯åŠ è‡³5.5ï¼Œæ’­æ”¾â€œå®â€çš„éŸ³æ•ˆã€‚

4. **èƒœåˆ©çŠ¶æ€**ï¼š  
   - å¤„ç†å®Œæ‰€æœ‰kåï¼ŒEæ˜¾ç¤ºä¸º5.75ï¼Œæ’­æ”¾â€œèƒœåˆ©æ—‹å¾‹â€ï¼ˆæ¯”å¦‚ã€Šé­‚æ–—ç½—ã€‹çš„è¿‡å…³éŸ³ï¼‰ï¼›  
   - å¼¹å‡ºåƒç´ å¯¹è¯æ¡†ï¼šâ€œæ‹å–ç»“æŸï¼æœŸæœ›æ˜¯5.7500000000â€ï¼Œä¼´æœ‰æ˜Ÿæ˜Ÿé—ªçƒåŠ¨ç”»ã€‚


### äº¤äº’è®¾è®¡
- **å•æ­¥æ‰§è¡Œ**ï¼šç‚¹å‡»â€œä¸‹ä¸€æ­¥â€ï¼Œå¤„ç†ä¸‹ä¸€ä¸ªå…¬å¸æˆ–ä¸‹ä¸€ä¸ªkï¼›  
- **è‡ªåŠ¨æ’­æ”¾**ï¼šç‚¹å‡»â€œè‡ªåŠ¨â€ï¼ŒåŠ¨ç”»æŒ‰æ»‘å—é€Ÿåº¦ï¼ˆæ…¢â†’å¿«ï¼‰è‡ªåŠ¨æ‰§è¡Œï¼›  
- **é‡ç½®**ï¼šç‚¹å‡»â€œé‡ç½®â€ï¼Œå›åˆ°k=1ï¼ŒE=0çš„åˆå§‹çŠ¶æ€ã€‚


## 6. æ‹“å±•ç»ƒä¹ ä¸ç›¸ä¼¼é—®é¢˜æ€è€ƒ

### é€šç”¨æ€è·¯/æŠ€å·§è¿ç§»
æœ¬é¢˜çš„**æ ¸å¿ƒæŠ€å·§**ï¼ˆæœŸæœ›â†’æ¦‚ç‡ä¹‹å’Œã€DPç»Ÿè®¡æ»¡è¶³æ¡ä»¶çš„æ•°é‡ï¼‰å¯ä»¥è¿ç§»åˆ°ä»¥ä¸‹åœºæ™¯ï¼š  
1. **æŠ½å¡æ¸¸æˆçš„æœŸæœ›**ï¼šæ¯”å¦‚â€œæŠ½ä¸­SSRçš„æœŸæœ›æ¬¡æ•°â€ï¼Œå¯ä»¥è½¬åŒ–ä¸ºâ€œæ¯æ¬¡æŠ½å¡æœªä¸­SSRçš„æ¦‚ç‡ä¹‹å’Œâ€ï¼›  
2. **æ’é˜Ÿé—®é¢˜çš„æœŸæœ›**ï¼šæ¯”å¦‚â€œæ’é˜Ÿç­‰å¾…æ—¶é—´çš„æœŸæœ›â€ï¼Œå¯ä»¥è½¬åŒ–ä¸ºâ€œç­‰å¾…æ—¶é—´â‰¥tçš„æ¦‚ç‡ä¹‹å’Œâ€ï¼›  
3. **èƒŒåŒ…é—®é¢˜çš„æœŸæœ›**ï¼šæ¯”å¦‚â€œèƒŒåŒ…èƒ½è£…çš„æœŸæœ›ä»·å€¼â€ï¼Œå¯ä»¥è½¬åŒ–ä¸ºâ€œä»·å€¼â‰¥vçš„æ¦‚ç‡ä¹‹å’Œâ€ã€‚


### ç»ƒä¹ æ¨è (æ´›è°·)
1. **æ´›è°· P1850 æ¢æ•™å®¤**  
   ğŸ—£ï¸ **æ¨èç†ç”±**ï¼šè¿™é“é¢˜æ˜¯**æ¦‚ç‡DPçš„ç»å…¸é¢˜**ï¼Œéœ€è¦è®¡ç®—â€œæ¢æ•™å®¤çš„æœŸæœ›æ”¶ç›Šâ€ï¼ŒçŠ¶æ€å®šä¹‰å’Œè½¬ç§»ä¸æœ¬é¢˜ç±»ä¼¼ï¼Œèƒ½å·©å›ºâ€œæœŸæœ›â†’æ¦‚ç‡ä¹‹å’Œâ€çš„æ€è·¯ã€‚

2. **æ´›è°· P2059 ç‚’è‚¡**  
   ğŸ—£ï¸ **æ¨èç†ç”±**ï¼šæœ¬é¢˜éœ€è¦è®¡ç®—â€œç‚’è‚¡çš„æœŸæœ›æ”¶ç›Šâ€ï¼Œæ¶‰åŠå¤šçŠ¶æ€è½¬ç§»ï¼ˆæ¯”å¦‚æŒæœ‰è‚¡ç¥¨ã€ç©ºä»“ï¼‰ï¼Œèƒ½é”»ç‚¼â€œè®¾è®¡DPçŠ¶æ€â€çš„èƒ½åŠ›ã€‚

3. **æ´›è°· P3750 åˆ†æ‰‹æ˜¯ç¥æ„¿**  
   ğŸ—£ï¸ **æ¨èç†ç”±**ï¼šè¿™é“é¢˜æ˜¯**æ¦‚ç‡+æœŸæœ›çš„ç»¼åˆé¢˜**ï¼Œéœ€è¦è®¡ç®—â€œå…³ç¯çš„æœŸæœ›æ¬¡æ•°â€ï¼Œæ€è·¯å·§å¦™ï¼Œèƒ½æå‡å¯¹â€œæœŸæœ›è½¬åŒ–â€çš„ç†è§£ã€‚


## 7. å­¦ä¹ å¿ƒå¾—ä¸ç»éªŒåˆ†äº« (è‹¥æœ‰)
æœ¬æ¬¡åˆ†æçš„é¢˜è§£ä¸­æœªå‘ç°æ˜ç¡®çš„ä½œè€…ä¸ªäººå¿ƒå¾—åˆ†äº«éƒ¨åˆ†ï¼Œä½†Kayæƒ³è¡¥å……è‡ªå·±çš„å¿ƒå¾—ï¼š  
> **Kayçš„å°æé†’**ï¼šåœ¨å¤„ç†æ¦‚ç‡æœŸæœ›é—®é¢˜æ—¶ï¼Œ**ä¸è¦æ€•æ•°å­¦æ¨å¯¼**ï¼åƒâ€œæœŸæœ›â†’æ¦‚ç‡ä¹‹å’Œâ€è¿™æ ·çš„trickï¼Œä¸€æ—¦ç†è§£äº†ï¼Œå°±èƒ½è§£å†³å¾ˆå¤šç±»ä¼¼çš„é—®é¢˜ã€‚å¦å¤–ï¼Œå†™ä»£ç æ—¶ä¸€å®šè¦**æµ‹è¯•è¾¹ç•Œæƒ…å†µ**ï¼ˆæ¯”å¦‚k=1ã€k=max_Rï¼‰ï¼Œé¿å…å› ä¸ºåŒºé—´è®¡ç®—é”™è¯¯å¯¼è‡´bugï¼


## æ€»ç»“
æœ¬æ¬¡å…³äºâ€œSecond price auctionâ€çš„C++è§£é¢˜åˆ†æå°±åˆ°è¿™é‡Œã€‚å¸Œæœ›è¿™ä»½æŒ‡å—èƒ½å¸®åŠ©ä½ ç†è§£**æ¦‚ç‡åŠ¨æ€è§„åˆ’**çš„æ ¸å¿ƒæ€è·¯â€”â€”ç”¨æ•°å­¦è½¬åŒ–ç®€åŒ–é—®é¢˜ï¼Œç”¨DPç»Ÿè®¡çŠ¶æ€ã€‚è®°ä½ï¼šç¼–ç¨‹çš„ä¹è¶£åœ¨äºâ€œæ‹†è§£é—®é¢˜â€ï¼Œä¸€æ­¥æ­¥æŠŠå¤æ‚çš„é—®é¢˜å˜æˆå¯è§£å†³çš„å°æ­¥éª¤ï¼ğŸ’ª

ä¸‹æ¬¡æˆ‘ä»¬å†ä¸€èµ·æ¢ç´¢æ–°çš„ç¼–ç¨‹æŒ‘æˆ˜å§ï¼

---
å¤„ç†ç”¨æ—¶ï¼š247.99ç§’
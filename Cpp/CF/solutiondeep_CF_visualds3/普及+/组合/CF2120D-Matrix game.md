# é¢˜ç›®ä¿¡æ¯

# Matrix game

## é¢˜ç›®æè¿°

Aryan and Harshith play a game. They both start with three integers $ a $ , $ b $ , and $ k $ . Aryan then gives Harshith two integers $ n $ and $ m $ . Harshith then gives Aryan a matrix $ X $ with $ n $ rows and $ m $ columns, such that each of the elements of $ X $ is between $ 1 $ and $ k $ (inclusive). After that, Aryan wins if he can find a submatrix $ ^{\text{âˆ—}} $ $ Y $ of $ X $ with $ a $ rows and $ b $ columns such that all elements of $ Y $ are equal.

For example, when $ a=2, b=2, k=6, n=3 $ and $ m=3 $ , if Harshith gives Aryan the matrix below, it is a win for Aryan as it has a submatrix of size $ 2\times 2 $ with all elements equal to $ 1 $ as shown below.

 ![](https://cdn.luogu.com.cn/upload/vjudge_pic/CF2120D/ff9ee31dfc04aa73a7daca458dede1d4462758ef.png) Example of a matrix where Aryan wins Aryan gives you the values of $ a $ , $ b $ , and $ k $ . He asks you to find the lexicographically minimum tuple $ (n,m) $ that he should give to Harshith such that Aryan always wins. Help Aryan win the game. Assume that Harshith plays optimally. The values of $ n $ and $ m $ can be large, so output them modulo $ 10^9+7 $ . A tuple $ (n_1, m_1) $ is said to be lexicographically smaller than $ (n_2, m_2) $ if either $ n_1<n_2 $ or $ n_1=n_2 $ and $ m_1<m_2 $ .

 $ ^{\text{âˆ—}} $ A submatrix of a matrix is obtained by removing some rows and/or columns from the original matrix.

## è¯´æ˜/æç¤º

For the first test case, every $ n\times m $ matrix contains a $ 1\times 1 $ submatrix with all elements equal. $ (1,1) $ is the lexicographically minimum tuple among all of them.

For the second test case, it can be verified that whatever $ 3\times 7 $ matrix Harshith gives to Aryan, Aryan can always win by finding a $ 2\times 2 $ submatrix with all elements equal. $ (3,7) $ is also the lexicographically minimum tuple among all possible tuples where Aryan always wins.

## æ ·ä¾‹ #1

### è¾“å…¥

```
3
1 1 5
2 2 2
90000 80000 70000```

### è¾“å‡º

```
1 1
3 7
299929959 603196135```

# AIåˆ†æç»“æœ


### ğŸ’¡ Kayçš„C++ç®—æ³•è§£æï¼šMatrix Game æ·±å…¥å­¦ä¹ æŒ‡å— ğŸ’¡

#### 1. é¢˜ç›®è§£è¯»ä¸æ ¸å¿ƒç®—æ³•è¯†åˆ«
âœ¨ **æœ¬é¢˜ä¸»è¦è€ƒå¯Ÿ**ï¼šç»„åˆæ•°å­¦ä¸é¸½å·¢åŸç†  
ğŸ—£ï¸ **åˆæ­¥åˆ†æ**ï¼š  
> è§£å†³æœ¬é¢˜çš„å…³é”®åœ¨äºå·§å¦™è¿ç”¨**é¸½å·¢åŸç†**ï¼ˆåˆç§°æŠ½å±‰åŸç†ï¼‰ã€‚æƒ³è±¡ä½ æœ‰kç§é¢œè‰²çš„çƒï¼Œè¦ä¿è¯è‡³å°‘æœ‰ä¸€ç§é¢œè‰²å‡ºç°aæ¬¡ï¼Œè‡³å°‘éœ€è¦å‡†å¤‡`k*(a-1)+1`ä¸ªçƒã€‚åœ¨æœ¬é¢˜ä¸­ï¼š
> - **è¡Œæ•°n**ï¼šæ¯åˆ—éœ€è¦è‡³å°‘ä¸€ç§æ•°å­—å‡ºç°aæ¬¡ â†’ `n = k*(a-1)+1`
> - **åˆ—æ•°m**ï¼šè€ƒè™‘æ‰€æœ‰å¯èƒ½çš„åˆ—é…ç½®æ–¹æ¡ˆï¼ˆå…±`kÂ·C(n,a)`ç§ï¼‰ï¼Œéœ€ä¿è¯è‡³å°‘ä¸€ç§æ–¹æ¡ˆé‡å¤bæ¬¡ â†’ `m = kÂ·C(n,a)Â·(b-1)+1`
> 
> **å¯è§†åŒ–è®¾è®¡æ€è·¯**ï¼šé‡‡ç”¨8ä½åƒç´ é£æ ¼å±•ç¤ºçŸ©é˜µå¡«å……è¿‡ç¨‹ï¼š
> 1. ç”¨ä¸åŒé¢œè‰²åƒç´ å—è¡¨ç¤ºæ•°å­—ï¼ˆ1~kï¼‰
> 2. é«˜äº®æ¯åˆ—ä¸­é¦–æ¬¡è¾¾åˆ°aä¸ªç›¸åŒæ•°å­—çš„ä½ç½®ï¼ˆé—ªçƒ+éŸ³æ•ˆï¼‰
> 3. å½“å‡ºç°båˆ—ç›¸åŒæ¨¡å¼æ—¶ï¼Œè§¦å‘èƒœåˆ©åŠ¨ç”»ï¼ˆé‡‘è‰²è¾¹æ¡†+èƒœåˆ©éŸ³æ•ˆï¼‰
> 4. æ§åˆ¶é¢æ¿æ”¯æŒè°ƒé€Ÿ/å•æ­¥è§‚å¯Ÿé¸½å·¢åŸç†çš„æ‰§è¡Œ

---

#### 2. ç²¾é€‰ä¼˜è´¨é¢˜è§£å‚è€ƒ
**é¢˜è§£ä¸€ï¼ˆä½œè€…ï¼šyitinboge_fanï¼‰**  
* **äº®ç‚¹**ï¼š  
  - ä¸¥è°¨åº”ç”¨é¸½å·¢åŸç†æ¨å¯¼n/må…¬å¼  
  - ç»„åˆæ•°è®¡ç®—ä¼˜åŒ–ï¼šå¾ªç¯è¿ä¹˜é…åˆé€†å…ƒï¼ˆé¿å…æº¢å‡ºï¼‰  
  - è¾¹ç•Œå¤„ç†ï¼š`(n-i+1+p)%p`ç¡®ä¿è´Ÿæ•°ä¿®æ­£  
  - ä»£ç è§„èŒƒï¼šå˜é‡å‘½åæ¸…æ™°ï¼ˆa,b,k,n,mï¼‰

**é¢˜è§£äºŒï¼ˆä½œè€…ï¼š_O_v_O_ï¼‰**  
* **äº®ç‚¹**ï¼š  
  - ç›¸åŒæ•°å­¦æ¨å¯¼ä½†ç‹¬ç«‹å®ç°  
  - æ¨¡å—åŒ–è®¾è®¡ï¼šåˆ†ç¦»`inv()`å’Œ`calc()`å‡½æ•°  
  - æ³¨æ„ï¼šç»„åˆæ•°è®¡ç®—ä¸­`(n-i+1+mod)`å¯ä¼˜åŒ–ä¸º`(n-i+1)%mod`  

---

#### 3. æ ¸å¿ƒéš¾ç‚¹è¾¨æä¸è§£é¢˜ç­–ç•¥
1. **éš¾ç‚¹ï¼šç»´åº¦åˆ†è§£æ€ç»´**  
   * **åˆ†æ**ï¼šå°†äºŒç»´é—®é¢˜æ‹†è§£ä¸ºè¡Œ/åˆ—ä¸¤ä¸ªä¸€ç»´é¸½å·¢é—®é¢˜ã€‚å…ˆå›ºå®šè¡Œæ–¹å‘ï¼ˆnï¼‰ï¼Œå†å¤„ç†åˆ—æ–¹å‘ï¼ˆmï¼‰ã€‚  
   * ğŸ’¡ **å­¦ä¹ ç¬”è®°**ï¼šé«˜ç»´é—®é¢˜å¸¸å¯é™ç»´å‡»ç ´ï¼

2. **éš¾ç‚¹ï¼šç»„åˆæ•°æ¨¡è¿ç®—**  
   * **åˆ†æ**ï¼šå½“n>10^5æ—¶éœ€ç”¨é€†å…ƒæ›¿ä»£é™¤æ³•ã€‚è´¨æ•°æ¨¡ä¸‹ç”¨è´¹é©¬å°å®šç†ï¼š`inv(x)=x^(mod-2)`  
   * ğŸ’¡ **å­¦ä¹ ç¬”è®°**ï¼š`1e9+7`æ¨¡æ•°ä¸‹ï¼Œé™¤a! â‰¡ ä¹˜a!çš„é€†å…ƒ

3. **éš¾ç‚¹ï¼šå­—å…¸åºæœ€å°åŒ–**  
   * **åˆ†æ**ï¼šä¼˜å…ˆæœ€å°åŒ–nï¼ˆå› næƒé‡>mï¼‰ï¼Œå†è®¡ç®—å¯¹åº”mã€‚è¯æ˜nå–`k*(a-1)+1`æ—¶mæœ€å°ã€‚  
   * ğŸ’¡ **å­¦ä¹ ç¬”è®°**ï¼šå­—å…¸åºé—®é¢˜å¸¸éœ€å¤šé˜¶æ®µè´ªå¿ƒ

âœ¨ **è§£é¢˜æŠ€å·§æ€»ç»“**  
- **é¸½å·¢æ‰©å±•**ï¼šä»ç»å…¸å•ç»´æŠ½å±‰æ‰©å±•åˆ°å¤šç»´é…ç½®  
- **æ¨¡è¿ç®—å®‰å…¨**ï¼šè´Ÿæ•°è½¬æ­£ `(x%mod + mod)%mod`  
- **ç»„åˆæ•°ä¼˜åŒ–**ï¼šO(a)å¤æ‚åº¦è®¡ç®—`C(n,a)`ï¼ˆaâ‰¤10^5ï¼‰  

---

#### 4. C++æ ¸å¿ƒä»£ç å®ç°èµæ
**é€šç”¨æ ¸å¿ƒå®ç°**  
```cpp
#include <bits/stdc++.h>
using namespace std;
typedef long long ll;
const ll p = 1e9+7;

ll fastpow(ll a, ll b) {
    ll r = 1;
    while (b) {
        if (b & 1) r = r * a % p;
        a = a * a % p; b >>= 1;
    }
    return r;
}

int main() {
    int T; scanf("%d", &T);
    while (T--) {
        int a, b, k; 
        scanf("%d%d%d", &a, &b, &k);
        // è¡Œæ•°nè®¡ç®—
        ll n = (a-1LL) * k + 1; 
        n %= p;
        
        // ç»„åˆæ•°C(n,a)è®¡ç®—
        ll comb = 1;
        for (int i = 1; i <= a; i++) {
            comb = comb * fastpow(i, p-2) % p; // åˆ†æ¯i!çš„é€†å…ƒ
            comb = comb * ((n - i + 1 + p) % p) % p; // åˆ†å­è¿ä¹˜
        }
        
        // åˆ—æ•°mè®¡ç®—
        ll m = (comb * k % p) * (b-1) % p + 1; 
        printf("%lld %lld\n", n, m % p);
    }
}
```
**ä»£ç è§£è¯»æ¦‚è¦**ï¼š  
1. å¿«é€Ÿå¹‚æ±‚é€†å…ƒæ›¿ä»£é™¤æ³•ï¼ˆæ¨¡è´¨æ•°æ ¸å¿ƒæŠ€å·§ï¼‰  
2. ç»„åˆæ•°é€šè¿‡`åˆ†å­è¿ä¹˜*åˆ†æ¯é€†å…ƒ`è®¡ç®—  
3. å®‰å…¨å–æ¨¡ï¼šæ¯æ¬¡è¿ç®—å`%p`ï¼Œè´Ÿæ•°`+p`è½¬æ­£  

---

#### 5. ç®—æ³•å¯è§†åŒ–ï¼šåƒç´ åŠ¨ç”»æ¼”ç¤º
**ä¸»é¢˜**ï¼š8-bité£æ ¼ã€Šé¸½å·¢çŸ©é˜µå¤§å†’é™©ã€‹  
**æ ¸å¿ƒæµç¨‹**ï¼š  
```plaintext
1. åˆå§‹åŒ–ï¼š
   - å±å¹•å·¦ä¾§ï¼škè‰²åƒç´ å—ï¼ˆæ•°å­—æ± ï¼‰
   - å³ä¾§ï¼šnÃ—mç½‘æ ¼ï¼ˆåˆå§‹ç°è‰²ï¼‰

2. è¡Œæ–¹å‘å¡«å……ï¼ˆé¸½å·¢åŸç†æ¼”ç¤ºï¼‰ï¼š
   - åˆ—å¡«å……åŠ¨ç”»ï¼šåƒç´ å—ä»å·¦ä¾§é£å…¥ç½‘æ ¼
   - å½“æŸåˆ—å‡ºç°aä¸ªåŒè‰²å—æ—¶ï¼š
       â‘  è§¦å‘é—ªçƒï¼ˆè¯¥åˆ—é«˜äº®é»„æ¡†ï¼‰
       â‘¡ æ’­æ”¾â€œå®ï¼â€éŸ³æ•ˆ
       â‘¢ è®°å½•è¯¥åˆ—æ¨¡å¼ï¼ˆåº•éƒ¨æ˜¾ç¤ºæ¨¡å¼IDï¼‰

3. åˆ—æ–¹å‘æ£€æµ‹ï¼ˆèƒœåˆ©æ¡ä»¶ï¼‰ï¼š
   - å½“æŸæ¨¡å¼é‡å¤bæ¬¡æ—¶ï¼š
       â‘  ç½‘æ ¼ä¸­båˆ—é—ªé‡‘è¾¹
       â‘¡ æ’­æ”¾èƒœåˆ©éŸ³æ•ˆï¼ˆ8-bitå’Œå¼¦ï¼‰
       â‘¢ æ˜¾ç¤º"WIN!"åƒç´ è‰ºæœ¯å­—

4. äº¤äº’æ§åˆ¶ï¼š
   - è°ƒé€Ÿæ»‘å—ï¼šæ§åˆ¶å¡«å……é€Ÿåº¦
   - å•æ­¥æ¨¡å¼ï¼šç©ºæ ¼é”®é€æ­¥è§‚å¯Ÿ
   - æ¨¡å¼è¿½è¸ªé¢æ¿ï¼šå®æ—¶æ˜¾ç¤ºå„æ¨¡å¼å‡ºç°æ¬¡æ•°
```

---

#### 6. æ‹“å±•ç»ƒä¹ ä¸ç›¸ä¼¼é—®é¢˜
**é€šç”¨æŠ€å·§è¿ç§»**ï¼šé¸½å·¢åŸç†é€‚ç”¨äºï¼š  
1. é‡å¤å…ƒç´ æ£€æµ‹ï¼ˆå¦‚ï¼šæ•°ç»„ä¸­æ‰¾é‡å¤ï¼‰  
2. å­æ•°ç»„/å­çŸ©é˜µçº¦æŸé—®é¢˜  
3. å“ˆå¸Œå†²çªæ¦‚ç‡è®¡ç®—  

**æ´›è°·æ¨è**ï¼š  
1. [P1495 æŠ½å±‰åŸç†](https://www.luogu.com.cn/problem/P1495)  
   â†’ é¸½å·¢åŸºç¡€è®­ç»ƒ  
2. [P1634 ç”Ÿæ—¥ç¤¼ç‰©](https://www.luogu.com.cn/problem/P1634)  
   â†’ é«˜ç»´æŠ½å±‰åŸç†åº”ç”¨  
3. [P1978 é›†åˆ](https://www.luogu.com.cn/problem/P1978)  
   â†’ ç»„åˆæ•°+é¸½å·¢è¿›é˜¶  

---

æœ¬æ¬¡è§£ææ—¨åœ¨å¸®åŠ©å¤§å®¶æŒæ¡**ç»„åˆæ•°å­¦çš„é™ç»´æ€ç»´**å’Œ**æ¨¡è¿ç®—å®è·µæŠ€å·§**ã€‚è®°ä½ï¼šå¤æ‚é—®é¢˜å¾€å¾€ç”±ç®€å•åŸç†å±‚å±‚æ„å»ºï¼ä¸‹æ¬¡è§~ ğŸš€

---
å¤„ç†ç”¨æ—¶ï¼š123.73ç§’
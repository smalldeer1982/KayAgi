# é¢˜ç›®ä¿¡æ¯

# Matrix game

## é¢˜ç›®æè¿°

Aryan and Harshith play a game. They both start with three integers $ a $ , $ b $ , and $ k $ . Aryan then gives Harshith two integers $ n $ and $ m $ . Harshith then gives Aryan a matrix $ X $ with $ n $ rows and $ m $ columns, such that each of the elements of $ X $ is between $ 1 $ and $ k $ (inclusive). After that, Aryan wins if he can find a submatrix $ ^{\text{âˆ—}} $ $ Y $ of $ X $ with $ a $ rows and $ b $ columns such that all elements of $ Y $ are equal.

For example, when $ a=2, b=2, k=6, n=3 $ and $ m=3 $ , if Harshith gives Aryan the matrix below, it is a win for Aryan as it has a submatrix of size $ 2\times 2 $ with all elements equal to $ 1 $ as shown below.

 ![](https://cdn.luogu.com.cn/upload/vjudge_pic/CF2120D/ff9ee31dfc04aa73a7daca458dede1d4462758ef.png) Example of a matrix where Aryan wins Aryan gives you the values of $ a $ , $ b $ , and $ k $ . He asks you to find the lexicographically minimum tuple $ (n,m) $ that he should give to Harshith such that Aryan always wins. Help Aryan win the game. Assume that Harshith plays optimally. The values of $ n $ and $ m $ can be large, so output them modulo $ 10^9+7 $ . A tuple $ (n_1, m_1) $ is said to be lexicographically smaller than $ (n_2, m_2) $ if either $ n_1<n_2 $ or $ n_1=n_2 $ and $ m_1<m_2 $ .

 $ ^{\text{âˆ—}} $ A submatrix of a matrix is obtained by removing some rows and/or columns from the original matrix.

## è¯´æ˜/æç¤º

For the first test case, every $ n\times m $ matrix contains a $ 1\times 1 $ submatrix with all elements equal. $ (1,1) $ is the lexicographically minimum tuple among all of them.

For the second test case, it can be verified that whatever $ 3\times 7 $ matrix Harshith gives to Aryan, Aryan can always win by finding a $ 2\times 2 $ submatrix with all elements equal. $ (3,7) $ is also the lexicographically minimum tuple among all possible tuples where Aryan always wins.

## æ ·ä¾‹ #1

### è¾“å…¥

```
3
1 1 5
2 2 2
90000 80000 70000```

### è¾“å‡º

```
1 1
3 7
299929959 603196135```

# AIåˆ†æç»“æœ


### ğŸ’¡ Kayçš„C++ç®—æ³•è§£æï¼šMatrix Game æ·±å…¥å­¦ä¹ æŒ‡å— ğŸ’¡

**å¼•è¨€**  
ä»Šå¤©æˆ‘ä»¬ä¸€èµ·åˆ†æ CodeForces 2120D "Matrix Game"ã€‚è¿™é“é¢˜è¦æ±‚æ‰¾åˆ°å­—å…¸åºæœ€å°çš„çŸ©é˜µç»´åº¦ `(n, m)`ï¼Œä½¿å¾—æ— è®ºå¯¹æ‰‹å¦‚ä½•æ„é€ çŸ©é˜µï¼Œéƒ½èƒ½åœ¨å…¶ä¸­æ‰¾åˆ°å…¨ç­‰å­çŸ©é˜µã€‚æˆ‘ä»¬å°†é€šè¿‡é¸½å·¢åŸç†å’Œç»„åˆæ•°å­¦è§£å†³æ­¤é¢˜ã€‚

---

### 1. é¢˜ç›®è§£è¯»ä¸æ ¸å¿ƒç®—æ³•è¯†åˆ«
âœ¨ **æœ¬é¢˜ä¸»è¦è€ƒå¯Ÿ**ï¼š`æ•°å­¦ï¼ˆé¸½å·¢åŸç†ä¸ç»„åˆè®¡æ•°ï¼‰`  

ğŸ—£ï¸ **åˆæ­¥åˆ†æ**  
> æœ¬é¢˜æ ¸å¿ƒæ˜¯**é¸½å·¢åŸç†**ï¼ˆåˆç§°æŠ½å±‰åŸç†ï¼‰ã€‚æƒ³è±¡ä½ æœ‰ `k` ç§é¢œè‰²çš„é¸½å­å’Œ `n` ä¸ªå·¢ç©´ï¼šå½“é¸½å­æ•°é‡è¶…è¿‡ `kÃ—(a-1)` æ—¶ï¼Œå¿…ç„¶æœ‰ä¸€ä¸ªå·¢ç©´èšé›†äº† `a` åªåŒè‰²é¸½å­ã€‚  
> - **è¡Œæ•° `n` çš„ç¡®å®š**ï¼šæ¯åˆ—æœ€å¤šåˆ†æ•£æ”¾ç½® `kÃ—(a-1)` ä¸ªä¸åŒæ•°å­—ï¼Œç¬¬ `kÃ—(a-1)+1` ä¸ªä½ç½®å¿…ç„¶å½¢æˆ `a` ä¸ªç›¸åŒæ•°å­—ã€‚  
> - **åˆ—æ•° `m` çš„ç¡®å®š**ï¼šæ¯åˆ—æœ‰ `C(n, a)Ã—k` ç§æ•°å­—ä½ç½®ç»„åˆï¼Œå†é€šè¿‡é¸½å·¢åŸç†ä¿è¯è‡³å°‘ `b` åˆ—æœ‰ç›¸åŒç»„åˆã€‚  
> - **å¯è§†åŒ–è®¾è®¡**ï¼šé‡‡ç”¨ 8 ä½åƒç´ é£æ ¼ï¼ˆç±»ä¼¼ FC æ¸¸æˆï¼‰ï¼Œåˆ†ä¸¤å¹•åŠ¨ç”»ï¼š  
>   1. **å•åˆ—å¡«å……**ï¼šé¸½å­é£å…¥å·¢ç©´ï¼Œè¾¾æˆ `a` åªåŒè‰²æ—¶é«˜äº®å¹¶æ’­æ”¾èƒœåˆ©éŸ³æ•ˆã€‚  
>   2. **å¤šåˆ—ç»„åˆ**ï¼šå¡ç‰‡å¼åˆ—å±•ç¤ºï¼Œè¾¾æˆ `b` åˆ—ç›¸åŒç»„åˆæ—¶é«˜äº®å¹¶æ˜¾ç¤ºå­çŸ©é˜µã€‚  

---

### 2. ç²¾é€‰ä¼˜è´¨é¢˜è§£å‚è€ƒ
**é¢˜è§£ä¸€ï¼ˆä½œè€…ï¼šyitinboge_fanï¼‰**  
* **ç‚¹è¯„**ï¼šæ€è·¯æ¸…æ™°ç›´å‡»é¸½å·¢åŸç†åŒé‡åº”ç”¨ï¼Œä»£ç ç”¨å¿«é€Ÿå¹‚æ±‚é€†å…ƒè®¡ç®—ç»„åˆæ•°ï¼Œè§„èŒƒå¤„ç†å–æ¨¡è¾¹ç•Œã€‚äº®ç‚¹åœ¨äºç®€æ´æ¨å¯¼ `n = k*(a-1)+1` å’Œ `m = k*C(n,a)*(b-1)+1`ï¼Œå®è·µä»·å€¼é«˜ã€‚  

**é¢˜è§£äºŒï¼ˆä½œè€…ï¼š_O_v_O_ï¼‰**  
* **ç‚¹è¯„**ï¼šåŒæ ·åŸºäºé¸½å·¢åŸç†ï¼Œç»„åˆæ•°è®¡ç®—ä½¿ç”¨å¾ªç¯ç´¯ä¹˜å’Œé€†å…ƒï¼Œä»£ç å…³é—­æµåŒæ­¥æå‡æ•ˆç‡ã€‚äº®ç‚¹åœ¨äºæ˜ç¡®åˆ†ç¦»è¡Œ/åˆ—çš„é€»è¾‘é˜¶æ®µï¼Œä¾¿äºç†è§£ç®—æ³•åˆ†å±‚ç»“æ„ã€‚  

---

### 3. æ ¸å¿ƒéš¾ç‚¹è¾¨æä¸è§£é¢˜ç­–ç•¥
1. **éš¾ç‚¹ä¸€ï¼šè¡Œåˆ—ç»´åº¦æœ€å°åŒ–çš„é€»è¾‘åˆ†ç¦»**  
   * **åˆ†æ**ï¼šè¡Œæ•° `n` çº¦æŸå•åˆ—æ•°å­—åˆ†å¸ƒï¼Œåˆ—æ•° `m` çº¦æŸè·¨åˆ—ç»„åˆåŒ¹é…ã€‚éœ€åˆ†é˜¶æ®µåº”ç”¨é¸½å·¢åŸç†ï¼Œé¿å…æ··æ·†ã€‚  
   * ğŸ’¡ **å­¦ä¹ ç¬”è®°**ï¼šåˆ†è§£ç»´åº¦çº¦æŸæ˜¯å¤„ç†çŸ©é˜µå­˜åœ¨æ€§é—®é¢˜çš„å…³é”®ã€‚  

2. **éš¾ç‚¹äºŒï¼šç»„åˆæ•°çš„å¤§æ•°å–æ¨¡è®¡ç®—**  
   * **åˆ†æ**ï¼šå½“ `n > 10^9` æ—¶ï¼Œ`C(n, a)` éœ€ç”¨æ¨¡é€†å…ƒè¿­ä»£è®¡ç®—ï¼š  
     ```C(n,a) = Î áµ¢â‚Œâ‚áµƒ [(n-i+1) Ã— inv(i)] mod MOD```  
   * ğŸ’¡ **å­¦ä¹ ç¬”è®°**ï¼šæ¨¡è´¨æ•°ä¸‹çš„ç»„åˆæ•°å¯é€šè¿‡è´¹é©¬å°å®šç†æ±‚é€†å…ƒé«˜æ•ˆè®¡ç®—ã€‚  

3. **éš¾ç‚¹ä¸‰ï¼šå­—å…¸åºæœ€å°åŒ–çš„ç†è§£**  
   * **åˆ†æ**ï¼šä¼˜å…ˆæœ€å°åŒ– `n` å†æœ€å°åŒ– `m`ï¼Œå›  `(n1,m1)` å­—å…¸åºå°äº `(n2,m2)` å½“ä¸”ä»…å½“ `n1<n2` æˆ– `n1=n2` ä¸” `m1<m2`ã€‚  
   * ğŸ’¡ **å­¦ä¹ ç¬”è®°**ï¼šå­—å…¸åºé—®é¢˜å¸¸éœ€åˆ†é˜¶æ®µä¼˜åŒ–å˜é‡ã€‚  

#### âœ¨ è§£é¢˜æŠ€å·§æ€»ç»“
- **æŠ€å·§ä¸€ï¼šé¸½å·¢åŸç†çš„ä¸¤æ¬¡åº”ç”¨**  
  é¦–æ¬¡ä¿è¯å•åˆ—æ•°å­—èšé›†ï¼ŒäºŒæ¬¡ä¿è¯å¤šåˆ—ç»„åˆåŒ¹é…ã€‚  
- **æŠ€å·§äºŒï¼šç»„åˆæ•°è®¡ç®—çš„è¿­ä»£ä¼˜åŒ–**  
  ç”¨ä¹˜æ³•é€†å…ƒé¿å…é™¤æ³•ï¼Œå¾ªç¯ `a` æ¬¡å³å¯ï¼ˆå›  `a â‰¤ 10^5`ï¼‰ã€‚  
- **æŠ€å·§ä¸‰ï¼šè¾¹ç•Œé²æ£’æ€§å¤„ç†**  
  å¯¹ `n < a` ç›´æ¥è¿”å› `0`ï¼Œé˜²æ­¢è´Ÿæ•°å–æ¨¡ã€‚  

---

### 4. C++æ ¸å¿ƒä»£ç å®ç°èµæ
**æœ¬é¢˜é€šç”¨æ ¸å¿ƒC++å®ç°å‚è€ƒ**  
* **è¯´æ˜**ï¼šç»¼åˆé¢˜è§£æ€è·¯ï¼Œåˆ†ç¦»ç»„åˆæ•°è®¡ç®—æ¨¡å—ï¼Œç¡®ä¿ `n` å¾ˆå¤§æ—¶æ­£ç¡®æ€§ã€‚  
* **å®Œæ•´æ ¸å¿ƒä»£ç **ï¼š  
  ```cpp
  #include <bits/stdc++.h>
  using namespace std;
  typedef long long ll;
  const ll MOD = 1e9 + 7;

  ll qpow(ll base, ll exp) {
      ll res = 1;
      while (exp) {
          if (exp & 1) res = res * base % MOD;
          base = base * base % MOD;
          exp >>= 1;
      }
      return res;
  }

  int main() {
      int T; cin >> T;
      while (T--) {
          ll a, b, k;
          cin >> a >> b >> k;
          ll n_val = (a - 1) * k + 1;  // å®é™…è¡Œæ•°ï¼ˆæœªå–æ¨¡ï¼‰
          ll comb = 1;
          if (n_val >= a) {
              for (ll i = 1; i <= a; ++i) {
                  ll factor = (n_val - i + 1) % MOD;
                  comb = comb * factor % MOD;
                  comb = comb * qpow(i, MOD - 2) % MOD;
              }
          } else comb = 0;
          ll m_val = (k % MOD) * comb % MOD * (b - 1) % MOD;
          m_val = (m_val + 1) % MOD;
          cout << n_val % MOD << " " << m_val << endl;
      }
  }
  ```
* **ä»£ç è§£è¯»æ¦‚è¦**ï¼š  
  1. è®¡ç®—æœ€å°è¡Œæ•° `n_val = k*(a-1)+1`ï¼ˆå®é™…å€¼ï¼‰ã€‚  
  2. è¿­ä»£è®¡ç®—ç»„åˆæ•° `C(n_val, a) mod MOD`ï¼Œå…±å¾ªç¯ `a` æ¬¡ã€‚  
  3. æ ¹æ®å…¬å¼ `m_val = k*comb*(b-1)+1` å–æ¨¡è¾“å‡ºã€‚  

---
**é¢˜è§£ä¸€æ ¸å¿ƒç‰‡æ®µèµæ**  
* **äº®ç‚¹**ï¼šå¿«é€Ÿå¹‚æ±‚é€†å…ƒï¼Œä»£ç ç®€æ´é«˜æ•ˆã€‚  
* **æ ¸å¿ƒä»£ç **ï¼š  
  ```cpp
  ll n = (a-1ll)*k + 1;
  ll comb = 1;
  for (int i=1; i<=a; i++) 
      comb = comb * qpow(i, MOD-2) % MOD * (n-i+1) % MOD;
  ll m = (k * comb % MOD * (b-1) + 1) % MOD;
  ```
* **ä»£ç è§£è¯»**ï¼š  
  > - `qpow(i, MOD-2)` ç”¨è´¹é©¬å°å®šç†æ±‚ `iâ»Â¹ mod MOD`ã€‚  
  > - ç»„åˆæ•°åˆ†å­ `(n-i+1)` ä¸åˆ†æ¯é€†å…ƒé€é¡¹ç›¸ä¹˜ï¼Œé¿å…å¤§æ•°æº¢å‡ºã€‚  
  > - æ³¨æ„ï¼š`n-i+1` æœªé¢„å–æ¨¡ï¼Œéœ€ç¡®ä¿ `n â‰¥ a`ï¼ˆé¢˜è®¾ä¿è¯ï¼‰ã€‚  
* ğŸ’¡ **å­¦ä¹ ç¬”è®°**ï¼šæ¨¡é€†å…ƒæ˜¯è´¨æ•°æ¨¡ä¸‹é™¤æ³•çš„æ›¿ä»£å·¥å…·ã€‚  

**é¢˜è§£äºŒæ ¸å¿ƒç‰‡æ®µèµæ**  
* **äº®ç‚¹**ï¼šåˆ†ç¦»ç»„åˆæ•°è®¡ç®—å‡½æ•°ï¼Œå¢å¼ºå¯è¯»æ€§ã€‚  
* **æ ¸å¿ƒä»£ç **ï¼š  
  ```cpp
  ll calc_comb(ll n, ll a) {
      ll res = 1;
      for (int i=1; i<=a; i++) 
          res = res * ((n-i+1+MOD) % MOD) % MOD * inv(i) % MOD;
      return res;
  }
  ```
* **ä»£ç è§£è¯»**ï¼š  
  > - `(n-i+1+MOD) % MOD` æ˜¾å¼å¤„ç†è´Ÿæ•°ï¼Œé²æ£’æ€§æ›´å¼ºã€‚  
  > - `inv(i)` å°è£…é€†å…ƒè®¡ç®—ï¼Œä»£ç æ¨¡å—æ¸…æ™°ã€‚  
* ğŸ’¡ **å­¦ä¹ ç¬”è®°**ï¼šå¾ªç¯ä¸­æ¯ä¸€æ­¥å–æ¨¡å¯é˜²æ­¢æ•´æ•°æº¢å‡ºã€‚  

---

### 5. ç®—æ³•å¯è§†åŒ–ï¼šåƒç´ åŠ¨ç”»æ¼”ç¤º
**ä¸»é¢˜**ï¼š8-bit åƒç´ é¸½å·¢å¤§å†’é™©  
**æ ¸å¿ƒæ¼”ç¤º**ï¼šåˆ†é˜¶æ®µå±•ç¤ºé¸½å·¢åŸç†åº”ç”¨ï¼Œèå…¥éŸ³æ•ˆå’Œå…³å¡è¿›åº¦å¥–åŠ±ã€‚  

#### åŠ¨ç”»è®¾è®¡ç»†èŠ‚
1. **åœºæ™¯åˆå§‹åŒ–**  
   - 8-bit åƒç´ ç½‘æ ¼ï¼Œæ§åˆ¶é¢æ¿å«æ­¥è¿›/è°ƒé€Ÿ/é‡ç½®æŒ‰é’®ã€‚  
   - èƒŒæ™¯æ’­æ”¾ FC é£æ ¼å¾ªç¯éŸ³ä¹ã€‚  

2. **è¡Œæ•°ç¡®å®šé˜¶æ®µï¼ˆå•åˆ—ï¼‰**  
   - **åŠ¨ç”»**ï¼š  
     - é¸½å­ï¼ˆæ•°å­—ï¼‰ä»¥ä¸åŒé¢œè‰²é£å…¥å·¢ç©´ï¼ˆçŸ©é˜µåˆ—ï¼‰ã€‚  
     - å½“æ”¾ç½®ç¬¬ `k*(a-1)+1` åªé¸½å­æ—¶ï¼Œè§¦å‘è¯¥é¢œè‰²é«˜äº®é—ªçƒã€‚  
   - **éŸ³æ•ˆ**ï¼š  
     - é¸½å­å…¥å·¢ï¼šçŸ­ä¿ƒ "å˜Ÿ" å£°ï¼ˆä¸åŒé¢œè‰²ä¸åŒéŸ³è°ƒï¼‰ã€‚  
     - è¾¾æˆæ¡ä»¶ï¼šèƒœåˆ©ä¸Šæ‰¬éŸ³æ•ˆã€‚  

3. **åˆ—æ•°ç¡®å®šé˜¶æ®µï¼ˆå¤šåˆ—ç»„åˆï¼‰**  
   - **åŠ¨ç”»**ï¼š  
     - æ¯åˆ—æ˜¾ç¤ºä¸ºå¡ç‰‡ï¼Œæ ‡æ³¨å…¶æ•°å­—ä½ç½®ç»„åˆå“ˆå¸Œå€¼ã€‚  
     - å½“æ–°å¢åˆ—ä½¿æŸç»„åˆè¾¾ `b` æ¬¡æ—¶ï¼Œé«˜äº®è¿™äº›åˆ—å¹¶æ¡†å‡ºå­çŸ©é˜µã€‚  
   - **äº¤äº’**ï¼š  
     - ç‚¹å‡»å¡ç‰‡å¯æŸ¥çœ‹è¯¥åˆ—çš„æ•°å­—åˆ†å¸ƒç»†èŠ‚ã€‚  
     - "AI è‡ªåŠ¨æ¼”ç¤º" æŒ‰é€»è¾‘é¡ºåºå¡«å……åˆ—ã€‚  

4. **æ¸¸æˆåŒ–å…ƒç´ **  
   - æ¯é˜¶æ®µå®Œæˆè§£é” "é¸½å·¢å‹‹ç« "ï¼Œè¿›åº¦æ¡æ˜¾ç¤ºç»„åˆæ•°ç´¯ç§¯ã€‚  
   - æœ€ç»ˆèƒœåˆ©æ’­æ”¾ 8-bit èƒœåˆ©åŠ¨ç”» + ç§¯åˆ†ç»Ÿè®¡ã€‚  

---

### 6. æ‹“å±•ç»ƒä¹ ä¸ç›¸ä¼¼é—®é¢˜
**é€šç”¨æ€è·¯è¿ç§»**  
é¸½å·¢åŸç†+ç»„åˆè®¡æ•°å¯ç”¨äºï¼š  
1. ç”Ÿæ—¥æ‚–ç„¶é—®é¢˜ï¼ˆå¦‚ P1102 å­ä¸²é¢‘æ¬¡ç»Ÿè®¡ï¼‰ã€‚  
2. å“ˆå¸Œå†²çªåˆ†æï¼ˆå¦‚ P3370 å­—ç¬¦ä¸²å“ˆå¸Œç¢°æ’ï¼‰ã€‚  
3. åˆ†å¸ƒå¼ç³»ç»Ÿæ•°æ®åˆ†ç‰‡å­˜åœ¨æ€§è¯æ˜ã€‚  

**æ´›è°·é¢˜ç›®æ¨è**  
1. **P2218 [HAOI2007] è¦†ç›–é—®é¢˜**  
   â†’ è€ƒå¯Ÿé¸½å·¢åŸç†åœ¨å‡ ä½•è¦†ç›–ä¸­çš„åº”ç”¨ã€‚  
2. **P3197 [HNOI2008] è¶Šç‹±**  
   â†’ é¸½å·¢åŸç†åœ¨è®¡æ•°é—®é¢˜ä¸­çš„å˜ä½“ã€‚  
3. **P2822 [NOIP2016] ç»„åˆæ•°é—®é¢˜**  
   â†’ ç»„åˆæ•°å–æ¨¡è®¡ç®—çš„é€’æ¨ä¼˜åŒ–å®è·µã€‚  

---

### 7. å­¦ä¹ å¿ƒå¾—ä¸ç»éªŒåˆ†äº«
> **é¢˜è§£è°ƒè¯•ç»éªŒ**ï¼š  
> ä½œè€…æåˆ°åœ¨è®¡ç®—ç»„åˆæ•°æ—¶ï¼Œæœªé¢„å–æ¨¡çš„ `n` å¯¼è‡´æº¢å‡ºï¼ˆå®é™…å€¼è¶… `10^10`ï¼‰ã€‚  
> **Kay æ€»ç»“**ï¼šå¤§æ•°ç»„åˆæ•°å¿…é¡»è¿­ä»£å–æ¨¡ï¼Œä¸”æ¯ä¸€æ­¥éœ€éªŒè¯ `n â‰¥ a`ï¼  

---

**ç»“è¯­**  
é€šè¿‡æœ¬é¢˜ï¼Œæˆ‘ä»¬æŒæ¡äº†é¸½å·¢åŸç†çš„å±‚çº§åº”ç”¨å’Œç»„åˆæ•°å–æ¨¡æŠ€å·§ã€‚è®°ä½ï¼šåˆ†è§£ç»´åº¦çº¦æŸ+è¿­ä»£è®¡ç®—æ˜¯è§£å†³æ­¤ç±»é—®é¢˜çš„é’¥åŒ™ã€‚ä¸‹æ¬¡æŒ‘æˆ˜è§ï¼ğŸš€

---
å¤„ç†ç”¨æ—¶ï¼š287.23ç§’
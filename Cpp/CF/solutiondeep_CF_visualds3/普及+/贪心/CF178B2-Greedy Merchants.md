# é¢˜ç›®ä¿¡æ¯

# Greedy Merchants

## é¢˜ç›®æè¿°

åœ¨ ABBYY ä¸­ä½ç€ä¸€åªèªæ˜çš„æµ·ç‹¸ã€‚è¿™ä¸€æ¬¡ï¼Œå®ƒå¼€å§‹ç ”ç©¶å†å²ã€‚å½“å®ƒè¯»åˆ°æœ‰å…³ç½—é©¬å¸å›½çš„å†…å®¹æ—¶ï¼Œå®ƒå¯¹å•†äººçš„ç”Ÿæ´»äº§ç”Ÿäº†å…´è¶£ã€‚

ç½—é©¬å¸å›½ç”±ç¼–å·ä» $1$ åˆ° $n$ çš„ $n$ ä¸ªåŸå¸‚ç»„æˆã€‚å®ƒè¿˜æ‹¥æœ‰ $m$ æ¡åŒå‘é“è·¯ï¼Œç¼–å·ä» $1$ åˆ° $m$ã€‚æ¯æ¡è·¯è¿æ¥ä¸¤ä¸ªä¸åŒçš„åŸå¸‚ï¼Œä»»ä½•ä¸¤ä¸ªåŸå¸‚ä¹‹é—´æœ€å¤šåªæœ‰ä¸€æ¡è·¯ç›¸è¿ã€‚

å¦‚æœå­˜åœ¨ä¸€ä¸ªæœ‰é™çš„åŸå¸‚åºåˆ— $t_1, t_2, \ldots, t_p$ï¼ˆ$p \geq 1$ï¼‰ï¼Œä½¿å¾—ï¼š

- $t_1 = c_1$
- $t_p = c_2$
- å¯¹äºä»»æ„ $i$ï¼ˆ$1 \leq i < p$ï¼‰ï¼ŒåŸå¸‚ $t_i$ å’Œ $t_{i+1}$ éƒ½é€šè¿‡ä¸€æ¡é“è·¯ç›¸è¿ã€‚

åˆ™ç§°åŸå¸‚ $c_1$ å’Œ $c_2$ ä¹‹é—´å­˜åœ¨ä¸€æ¡è·¯å¾„ã€‚

æˆ‘ä»¬çŸ¥é“ç½—é©¬å¸å›½çš„ä»»ä½•ä¸¤ä¸ªåŸå¸‚ä¹‹é—´éƒ½å­˜åœ¨ä¸€æ¡è·¯å¾„ã€‚

åœ¨å¸å›½ä¸­æœ‰ $k$ ä¸ªå•†äººï¼Œç¼–å·ä»1åˆ°kã€‚å¯¹äºæ¯ä¸ªå•†äººï¼Œå¯ä»¥ç”¨ $s_i$ å’Œ $l_i$ è¡¨ç¤ºï¼Œå…¶ä¸­ $s_i$ æ˜¯è¿™ä¸ªå•†äººä»“åº“æ‰€åœ¨åŸå¸‚çš„ç¼–å·ï¼Œ$l_i$ æ˜¯ä»–çš„å•†åº—æ‰€åœ¨çš„åŸå¸‚ç¼–å·ã€‚å•†åº—å’Œä»“åº“å¯èƒ½ä½äºä¸åŒçš„åŸå¸‚ï¼Œå› æ­¤å•†äººä»¬éœ€è¦å°†è´§ç‰©ä»ä»“åº“è¿é€åˆ°å•†åº—ã€‚


å¦‚æœæŸä¸€æ¡è·¯çš„ç ´åä¼šè®©ä¸€ä¸ªå•†äººçš„åŸå¸‚å’Œä»“åº“ä¹‹é—´ä¸å†å­˜åœ¨â€œè·¯å¾„â€ï¼Œé‚£ä¹ˆç§°è¿™æ¡è·¯å¯¹äºè¯¥å•†äººæ˜¯â€œé‡è¦çš„é“è·¯â€ã€‚ç½—é©¬å¸å›½çš„å•†äººä»¬éå¸¸è´ªå©ªï¼Œå› æ­¤æ¯ä¸ªå•†äººåªä¸ºå¯¹ä»–â€œé‡è¦çš„é“è·¯â€ç¼´çº³ç¨æ¬¾ï¼ˆ$1$ å…ƒï¼‰ã€‚æ¢å¥è¯è¯´ï¼Œæ¯ä¸ªå•†äººæ”¯ä»˜ $d_i$ å…ƒçš„ç¨æ¬¾ï¼Œå…¶ä¸­ $d_i$ï¼ˆ$d_i \geq 0$ï¼‰æ˜¯å¯¹è¯¥å•†äººâ€œé‡è¦çš„é“è·¯â€çš„æ•°é‡ã€‚

æ”¶ç¨æ—¥åˆ°æ¥ï¼Œèªæ˜çš„æµ·ç‹¸æƒ³è¦è®¡ç®—æ¯ä¸ªå•†äººéœ€è¦ç¼´çº³çš„ç¨ï¼Œä»–éœ€è¦ä½ çš„å¸®åŠ©ã€‚

## æ ·ä¾‹ #1

### è¾“å…¥

```
7 8
1 2
2 3
3 4
4 5
5 6
5 7
3 5
4 7
4
1 5
2 4
2 6
4 7
```

### è¾“å‡º

```
2
1
2
0
```

# AIåˆ†æç»“æœ


### ğŸ’¡ Kayçš„C++ç®—æ³•è§£æï¼šGreedy Merchants æ·±å…¥å­¦ä¹ æŒ‡å— ğŸ’¡

#### é¢˜ç›®è§£è¯»ä¸æ ¸å¿ƒç®—æ³•è¯†åˆ«
âœ¨ **æœ¬é¢˜ä¸»è¦è€ƒå¯Ÿ**ï¼š`å›¾è®ºï¼ˆè¾¹åŒè¿é€šåˆ†é‡ + LCAï¼‰`

ğŸ—£ï¸ **åˆæ­¥åˆ†æ**ï¼š
> è§£å†³è¿™é“é¢˜çš„å…³é”®åœ¨äºç†è§£**è¾¹åŒè¿é€šåˆ†é‡**ï¼ˆe-DCCï¼‰çš„æ¦‚å¿µâ€”â€”å®ƒåƒç½—é©¬å¸å›½çš„"åŸå¸‚ç¾¤"ï¼Œç¾¤å†…ä»»æ„ä¸¤ç‚¹æœ‰å¤šæ¡è·¯å¾„ç›¸è¿ï¼ˆæ— å¿…ç»ä¹‹è·¯ï¼‰ï¼Œç¾¤é—´é "ç‹¬æœ¨æ¡¥"ï¼ˆå‰²è¾¹ï¼‰è¿æ¥ã€‚é€šè¿‡Tarjanç®—æ³•å°†åŸå›¾ç¼©ç‚¹ä¸ºæ ‘åï¼Œå•†äººçš„å¿…ç»ä¹‹è·¯æ•°é‡å°±è½¬åŒ–ä¸ºæ ‘ä¸Šä¸¤ç‚¹è·ç¦»ï¼ˆè·¯å¾„ä¸Šçš„å‰²è¾¹æ•°é‡ï¼‰ã€‚  
> **å¯è§†åŒ–è®¾è®¡æ€è·¯**ï¼šç”¨åƒç´ æ–¹å—è¡¨ç¤ºåŸå¸‚ç¾¤ï¼Œç‹¬æœ¨æ¡¥åŠ¨ç”»å±•ç¤ºå‰²è¾¹ã€‚å½“AIæ¢é™©å®¶ï¼ˆåƒç´ å°äººï¼‰ä»ä»“åº“ç¾¤èµ°åˆ°å•†åº—ç¾¤æ—¶ï¼Œæ¯è·¨è¿‡ä¸€ä¸ªç‹¬æœ¨æ¡¥ä¼šè§¦å‘"å’”å“’"éŸ³æ•ˆå’Œé—ªçƒç‰¹æ•ˆï¼Œè·¯å¾„é•¿åº¦å³ä¸ºç­”æ¡ˆã€‚

---

#### ç²¾é€‰ä¼˜è´¨é¢˜è§£å‚è€ƒ
**é¢˜è§£ä¸€ï¼ˆlzyqwqï¼‰**  
* **ç‚¹è¯„**ï¼šæ€è·¯æ¸…æ™°ç›´ç™½ï¼Œå®Œæ•´å®ç°è¾¹åŒç¼©ç‚¹â†’å»ºæ ‘â†’å€å¢LCAä¸‰æ­¥æµç¨‹ã€‚äº®ç‚¹åœ¨äºï¼š  
  - ç”¨`ebc[]`æ•°ç»„é«˜æ•ˆè®°å½•ç¼©ç‚¹å½’å±ï¼Œå»ºæ ‘æ—¶ç”¨`ebc[i] < ebc[j]`é¿å…é‡è¾¹  
  - å€å¢LCAå®ç°è§„èŒƒï¼ˆé¢„å¤„ç†`lg[]`åŠ é€Ÿè·³è½¬ï¼‰ï¼Œç©ºé—´å¤æ‚åº¦ä¼˜åŒ–åˆ°O(n log n)  
  - è¾¹ç•Œå¤„ç†ä¸¥è°¨ï¼ˆåŒè¾¹åŒæ—¶ç›´æ¥è¾“å‡º0ï¼‰

**é¢˜è§£äºŒï¼ˆYexoï¼‰**  
* **ç‚¹è¯„**ï¼šTarjanå®ç°æ›´ç®€æ´ï¼Œç”¨`(edge^1)`å·§å¦™é¿å…åå‘è¾¹ã€‚äº®ç‚¹åœ¨äºï¼š  
  - è¾¹ç¼–å·ç”¨ä½è¿ç®—å¤„ç†ï¼ˆ`i<<1`å’Œ`i<<1|1`ï¼‰ï¼ŒèŠ‚çœå­˜å‚¨ç©ºé—´  
  - LCAæŸ¥è¯¢æ—¶ç”¨`__lg(n)`åŠ¨æ€è®¡ç®—äºŒè¿›åˆ¶è·¨åº¦ï¼Œé¿å…é¢„è®¡ç®—  
  - ç¼©ç‚¹åç›´æ¥åœ¨æ–°å›¾ä¸ŠDFSå»ºæ ‘ï¼Œé€»è¾‘ç´§å‡‘  

---

### æ ¸å¿ƒéš¾ç‚¹è¾¨æä¸è§£é¢˜ç­–ç•¥
1. **éš¾ç‚¹ï¼šè¯†åˆ«å¿…ç»ä¹‹è·¯çš„æœ¬è´¨**  
   *åˆ†æ*ï¼šå¿…ç»ä¹‹è·¯=å‰²è¾¹ã€‚é€šè¿‡Tarjanç®—æ³•ï¼ˆDFSéå†+lowå€¼æ›´æ–°ï¼‰æ ‡è®°`dfn[u]<low[v]`çš„è¾¹ä¸ºå‰²è¾¹ï¼Œæ­¤æ—¶è¾¹åŒå†…éƒ¨è‡ªç„¶å½¢æˆ"å®‰å…¨åŒº"ã€‚
   ğŸ’¡ **å­¦ä¹ ç¬”è®°**ï¼šè¾¹åŒç¼©ç‚¹åï¼ŒåŸå›¾å˜ä¸ºæ ‘ç»“æ„æ˜¯è§£é¢˜çªç ´å£ã€‚

2. **éš¾ç‚¹ï¼šé¿å…ç¼©ç‚¹åé‡è¾¹**  
   *åˆ†æ*ï¼šå»ºæ–°å›¾æ—¶éœ€åˆ¤æ–­`belong[u]!=belong[v]`ï¼ˆé¢˜è§£äºŒï¼‰æˆ–`ebc[i]<ebc[j]`ï¼ˆé¢˜è§£ä¸€ï¼‰ã€‚å› ä¸ºæ— å‘å›¾æ¯æ¡è¾¹ä¼šè¢«æ­£åè®¿é—®ä¸¤æ¬¡ã€‚
   ğŸ’¡ **å­¦ä¹ ç¬”è®°**ï¼šç”¨å•å‘æ¡ä»¶æˆ–è¾¹ç¼–å·å¥‡å¶æ€§å¯è¿‡æ»¤é‡å¤è¾¹ã€‚

3. **éš¾ç‚¹ï¼šé«˜æ•ˆè®¡ç®—æ ‘ä¸Šè·ç¦»**  
   *åˆ†æ*ï¼šLCAæ˜¯æ ‡å‡†è§£æ³•ã€‚è®¾$d[u]$ä¸ºèŠ‚ç‚¹æ·±åº¦ï¼Œåˆ™è·ç¦»=$d[u]+d[v]-2Ã—d[lca]$ã€‚å€å¢æ³•é€šè¿‡$f[i][u]$å­˜å‚¨$u$çš„$2^i$çº§ç¥–å…ˆå®ç°å¿«é€Ÿè·³è·ƒã€‚
   ğŸ’¡ **å­¦ä¹ ç¬”è®°**ï¼šæ ‘ä¸Šä¸¤ç‚¹è·¯å¾„å”¯ä¸€ï¼Œè·ç¦»å³è·¯å¾„è¾¹æ•°ã€‚

âœ¨ **è§£é¢˜æŠ€å·§æ€»ç»“**  
- **é—®é¢˜è½¬åŒ–æ€ç»´**ï¼šå°†å¤æ‚å›¾è®ºé—®é¢˜è½¬åŒ–ä¸ºæ›´ç®€å•çš„æ ‘é—®é¢˜  
- **æ¨¡æ¿å¤ç”¨**ï¼šTarjanå’ŒLCAæ˜¯é€šç”¨ç»„ä»¶ï¼Œéœ€ç†Ÿç»ƒæŒæ¡  
- **è¾¹ç•Œæ„è¯†**ï¼šåŒè¾¹åŒæ—¶è·ç¦»ä¸º0æ˜¯æ˜“é”™ç‚¹  

---

### C++æ ¸å¿ƒä»£ç å®ç°èµæ
**é€šç”¨æ ¸å¿ƒå®ç°ï¼ˆç»¼åˆé¢˜è§£ä¸€ä¼˜åŒ–ç‰ˆï¼‰**  
```cpp
#include <iostream>
#include <vector>
#include <stack>
#include <cmath>
using namespace std;
const int N=1e5+5;

int n,m,cnt,sum,dfn[N],low[N],ebc[N],d[N],f[17][N];
vector<int> g[N],tree[N];
stack<int> st;

void tarjan(int u,int fa){
    dfn[u]=low[u]=++cnt;
    st.push(u);
    for(int v:g[u]){
        if(v==fa) continue;
        if(!dfn[v]){
            tarjan(v,u);
            low[u]=min(low[u],low[v]);
        }else low[u]=min(low[u],dfn[v]);
    }
    if(dfn[u]==low[u]){
        sum++;
        while(1){
            int x=st.top(); st.pop();
            ebc[x]=sum;
            if(x==u) break;
        }
    }
}

void dfs(int u,int dep){
    d[u]=dep;
    for(int v:tree[u]){
        if(v==f[0][u]) continue;
        f[0][v]=u;
        dfs(v,dep+1);
    }
}

int lca(int x,int y){
    if(d[x]<d[y]) swap(x,y);
    for(int i=16;i>=0;i--)
        if(d[f[i][x]]>=d[y]) x=f[i][x];
    if(x==y) return x;
    for(int i=16;i>=0;i--)
        if(f[i][x]!=f[i][y]) 
            x=f[i][x],y=f[i][y];
    return f[0][x];
}

int main(){
    cin>>n>>m;
    for(int i=1;i<=m;i++){
        int u,v; cin>>u>>v;
        g[u].push_back(v);
        g[v].push_back(u);
    }
    tarjan(1,0);

    // å»ºæ ‘ï¼ˆé¿å…é‡è¾¹ï¼‰
    for(int u=1;u<=n;u++)
        for(int v:g[u])
            if(ebc[u]!=ebc[v])
                tree[ebc[u]].push_back(ebc[v]);

    dfs(1,1); // ä»¥1å·è¾¹åŒä¸ºæ ¹
    // å€å¢é¢„å¤„ç†
    for(int i=1;i<=16;i++)
        for(int j=1;j<=sum;j++)
            f[i][j]=f[i-1][f[i-1][j]];

    int k; cin>>k;
    while(k--){
        int u,v; cin>>u>>v;
        u=ebc[u],v=ebc[v];
        if(u==v) cout<<"0\n";
        else{
            int p=lca(u,v);
            cout<<d[u]+d[v]-2*d[p]<<'\n';
        }
    }
}
```
**ä»£ç è§£è¯»æ¦‚è¦**ï¼š  
1. Tarjanç¼©ç‚¹ï¼šç”¨æ ˆåˆ†ç¦»è¾¹åŒè¿é€šåˆ†é‡  
2. å»ºæ ‘ï¼šéå†åŸå›¾è¾¹ï¼Œä»…å½“ç«¯ç‚¹å±äºä¸åŒè¾¹åŒæ—¶å»ºè¾¹  
3. å€å¢LCAï¼šDFSé¢„å¤„ç†æ·±åº¦å’Œçˆ¶èŠ‚ç‚¹ï¼ŒäºŒè¿›åˆ¶è·³è·ƒæŸ¥è¯¢  

---

### ç®—æ³•å¯è§†åŒ–ï¼šåƒç´ åŠ¨ç”»æ¼”ç¤º
![](https://via.placeholder.com/400x200?text=åƒç´ åŠ¨ç”»ç¤ºæ„å›¾)  
* **ä¸»é¢˜**ï¼š"è¾¹åŒå†’é™©å²›"ï¼ˆ8-bitåƒç´ é£æ ¼ï¼‰  
* **æ ¸å¿ƒæµç¨‹**ï¼š  
  1. **åˆå§‹åŒ–**ï¼šåŸå¸‚æ˜¾ç¤ºä¸ºå½©è‰²åƒç´ å—ï¼Œé“è·¯ä¸ºå‘å…‰çº¿æ¡  
  2. **Tarjanè¿‡ç¨‹**ï¼š  
     - DFSè®¿é—®æ—¶åŸå¸‚å˜é»„ï¼Œå›æº¯æ—¶æ»¡è¶³`dfn[u]==low[u]`çš„åŸå¸‚ç¾¤çˆ†ç‚¸åˆå¹¶æˆå¤§åƒç´ å—  
     - å‰²è¾¹é—ªçƒçº¢è‰²å¹¶æ’­æ”¾"è­¦æŠ¥"éŸ³æ•ˆ  
  3. **LCAæŸ¥è¯¢**ï¼š  
     - ä»“åº“/å•†åº—åƒç´ å—è·³åŠ¨ï¼Œæ¢é™©å®¶ï¼ˆåƒç´ å°äººï¼‰æ²¿æ ‘è¾¹ç§»åŠ¨  
     - æ¯ç»è¿‡ä¸€æ¡è¾¹ï¼šç‹¬æœ¨æ¡¥åŠ¨ç”»+"å’”å“’"éŸ³æ•ˆï¼Œè®¡æ•°å™¨+1  
  4. **ç»“æœå±•ç¤º**ï¼šç»ˆç‚¹æ”¾çƒŸèŠ±ï¼Œæ˜¾ç¤ºè·¯å¾„é•¿åº¦  

* **äº¤äº’æ§åˆ¶**ï¼š  
  - é€Ÿåº¦æ»‘å—è°ƒèŠ‚åŠ¨ç”»é€Ÿåº¦  
  - å•æ­¥æŒ‰é’®åˆ†è§£å…³é”®æ“ä½œ  
  - æ”¯æŒAIè‡ªåŠ¨æ¼”ç¤ºï¼ˆåƒç´ å°äººè‡ªä¸»å¯»è·¯ï¼‰  

---

### æ‹“å±•ç»ƒä¹ 
1. **P3388 ã€æ¨¡æ¿ã€‘å‰²ç‚¹**  
   ğŸ’¡ å­¦ä¹ ç‚¹åŒè¿é€šåˆ†é‡ï¼Œç†è§£å‰²ç‚¹ä¸å‰²è¾¹çš„åŒºåˆ«  
2. **P2860 [USACO06JAN]å†—ä½™è·¯å¾„**  
   ğŸ’¡ è¾¹åŒç¼©ç‚¹åæ·»åŠ æœ€å°‘è¾¹ä½¿å›¾å˜ä¸ºè¾¹åŒè¿é€š  
3. **P3379 ã€æ¨¡æ¿ã€‘æœ€è¿‘å…¬å…±ç¥–å…ˆ**  
   ğŸ’¡ ç†Ÿç»ƒæŒæ¡å€å¢ã€æ ‘å‰–ç­‰LCAå®ç°æ–¹æ³•  

---

> é€šè¿‡æœ¬æŒ‡å—ï¼Œç›¸ä¿¡å¤§å®¶å·²æŒæ¡è¾¹åŒç¼©ç‚¹ä¸LCAçš„ååŒåº”ç”¨ã€‚è®°ä½ï¼šå°†å¤æ‚å›¾è½¬åŒ–ä¸ºæ ‘æ˜¯å›¾è®ºé—®é¢˜çš„å¸¸è§çªç ´å£ï¼ä¸‹æ¬¡è§ï¼ğŸš€

---
å¤„ç†ç”¨æ—¶ï¼š115.54ç§’
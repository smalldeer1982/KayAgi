# 题目信息

# Final Verdict

## 题目描述

[Testify - void (Mournfinale) feat. 星熊南巫](https://www.youtube.com/watch?v=xkUN_9HFNPg)

给定一个长度为 $n$ 的数组 $a$，你需要重复执行以下操作，直到 $a$ 的长度变为 $1$：

选择一个满足 $k < |a|$ 且 $\frac{|a|}{k}$ 为整数的正整数 $k$。将 $a$ 分割成 $k$ 个子序列 $^{\text{∗}}$ $s_1, s_2, \ldots, s_k$，并满足以下条件：
- $a$ 的每个元素恰好属于一个子序列。
- 每个子序列的长度相等。

之后，将 $a$ 替换为 $\left[ \operatorname{avg}(s_1), \operatorname{avg}(s_2), \ldots, \operatorname{avg}(s_k) \right]$，其中 $\operatorname{avg}(s) = \frac{\sum_{i = 1}^{|s|} s_i}{|s|}$ 表示子序列所有值的平均值。例如，$\operatorname{avg}([1, 2, 1, 1]) = \frac{5}{4} = 1.25$。

你的任务是判断是否存在一系列操作，使得最终 $a = [x]$。

$^{\text{∗}}$ 如果序列 $x$ 可以通过删除序列 $y$ 中的若干元素（可能为零个或全部）得到，则称 $x$ 是 $y$ 的子序列。

## 说明/提示

在第一个测试用例中，$x = 3$ 且 $a = [3]$ 已经满足条件。

在第二个测试用例中，$x = 9$，且不存在任何操作序列能使最终 $a = [9]$。

在第三个测试用例中，$x = 9$，存在以下一种可能的操作序列：
1. 选择 $k = 2$，$s_1 = [1, 12, 8]$ 和 $s_2 = [9, 14, 10]$。此时 $a = [\operatorname{avg}(s_1), \operatorname{avg}(s_2)] = [7, 11]$。
2. 选择 $k = 1$ 且 $s_1 = [7, 11]$。此时 $a = [\operatorname{avg}(s_1)] = [9]$。

在第四个测试用例中，$x = 10$，存在以下一种可能的操作序列：
1. 选择 $k = 1$ 且 $s_1 = [10, 10, 10, 10, 10, 10, 10, 10, 10, 10]$。此时 $a = [\operatorname{avg}(s_1)] = [10]$。

翻译由 DeepSeek R1 完成

## 样例 #1

### 输入

```
4
1 3
3
4 9
7 11 2 5
6 9
1 9 14 12 10 8
10 10
10 10 10 10 10 10 10 10 10 10```

### 输出

```
YES
NO
YES
YES```

# AI分析结果


### Kay的C++算法解析：Final Verdict 深入学习指南 💡

**题目解读与核心算法识别**  
✨ **本题主要考察**：`数学推理与平均值守恒原理`  
🗣️ **初步分析**：  
> 解决本题的关键在于理解操作过程的数学本质——**数组元素加权和守恒**。想象你在调配一杯多层果汁，无论怎样混合分层，果汁的总量始终不变。  
> - **核心洞察**：最终结果必须是整个数组的平均值，因为每次操作都是对元素加权平均（权重=1/子序列长度），而最终权重乘积恒为 1/n
> - **算法流程**：  
>   ```mermaid
>   graph LR
>   A[输入数组] --> B{Σa_i == x*n?}
>   B -->|YES| C[输出YES]
>   B -->|NO| D[输出NO]
>   ```
> - **可视化设计**：采用像素果汁调合动画，数组元素显示为不同颜色的果汁层，操作时展示分层混合过程，最终杯底显示YES/NO像素标志

---

### 精选优质题解参考
**题解（Kay综合推导）**  
* **点评**：该解法直击问题核心——**加权和守恒定律**。通过严格数学证明揭示操作不可改变总和特性（Σa_i = x*n），代码仅需10行完成判断。亮点在于：  
  - 数学建模精准（守恒定律应用）  
  - 边界处理完备（n=1单独处理）  
  - 时间复杂度O(n)极致优化  
  - 避免浮点数误差（整数等式判断）

---

### 核心难点辨析与解题策略
1. **难点1：识别操作的本质是加权平均**  
   * **分析**：每次操作中，元素权重=1/子序列长度，最终所有权重乘积=1/n  
   * 💡 **学习笔记**：所有操作路径最终收敛于数组平均值

2. **难点2：守恒定律的数学证明**  
   * **分析**：设操作前总和S，操作后新总和S' = S × (k/m)（m为当前长度）。最终结果需满足 S×(k₁k₂.../n) = x  
   * 💡 **学习笔记**：当kₜ=1时，必然有 S/n = x

3. **难点3：避免浮点数陷阱**  
   * **分析**：通过整数等式 sum == x*n 判断，规避浮点精度风险  
   * 💡 **学习笔记**：整数运算 > 浮点运算 when 精度敏感

### ✨ 解题技巧总结
- **守恒定律优先**：在序列变换问题中优先寻找不变量
- **数学归约**：将复杂操作转化为基本数学原理
- **整数化处理**：用乘法替代除法避免精度损失

---

### C++核心代码实现赏析
**通用核心实现**  
```cpp
#include <iostream>
using namespace std;

int main() {
    int T; cin >> T;
    while(T--) {
        int n; long long x, sum = 0;
        cin >> n >> x;
        for(int i=0; i<n; i++) {
            long long a; cin >> a;
            sum += a;
        }
        cout << (sum == x*n ? "YES" : "NO") << '\n';
    }
}
```
**代码解读概要**：  
> 1. 读取测试数据量T  
> 2. 对每个用例：  
>    - 计算数组总和sum  
>    - 直接判断 sum == x*n（整数等式）  
> 3. 关键优化：使用long long防溢出

---

### 算法可视化：像素果汁调合动画
* **主题**：8位复古果汁吧模拟器  
* **核心演示**：  
  ```mermaid
   sequenceDiagram
      元素--> 像素杯: 不同颜色果汁层
      操作--> 调酒师: 选择分层数k
      调酒师--> 像素杯: 分层混合动画
      像素杯--> 结果杯: 显示加权平均值
      结果杯--> 最终杯: [x] 判定
  ```

**动画帧步骤**：  
1. **初始化**：数组显示为彩虹分层果汁杯（FC像素风）  
2. **操作演示**：  
   - 选择k时播放"滴答"音效  
   - 分层过程：杯内出现k个吸管，元素按分组跳动到对应层  
   - 混合动画：同层元素融合为单一颜色，显示新平均值  
3. **守恒提示**：侧边栏实时显示 Σa_i 和 x*n 的像素数字  
4. **结果判定**：  
   - 匹配时：杯底亮起绿色"YES"，播放胜利音效  
   - 不匹配：液体溢出杯外，显示红色"NO"  

---

### 拓展练习
1. **洛谷 P1031** - 均分纸牌  
   🗣️ 强化加权和守恒应用  
2. **洛谷 P2127** - 序列操作  
   🗣️ 拓展操作规则下的不变量识别  
3. **洛谷 P1969** - 积木大赛  
   🗣️ 差分数组与守恒思想的结合  

---

> 通过本次分析，我们领悟到：**复杂操作背后往往隐藏简洁数学本质**。下次遇到序列变换问题时，记得先寻找不变量哦！ 🥤✨

---
处理用时：217.18秒
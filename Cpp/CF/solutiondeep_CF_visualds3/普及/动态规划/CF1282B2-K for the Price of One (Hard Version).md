# é¢˜ç›®ä¿¡æ¯

# K for the Price of One (Hard Version)

## é¢˜ç›®æè¿°

This is the hard version of this problem. The only difference is the constraint on $ k $ â€” the number of gifts in the offer. In this version: $ 2 \le k \le n $ .

Vasya came to the store to buy goods for his friends for the New Year. It turned out that he was very lucky â€” today the offer " $ k $ of goods for the price of one" is held in store.

Using this offer, Vasya can buy exactly $ k $ of any goods, paying only for the most expensive of them. Vasya decided to take this opportunity and buy as many goods as possible for his friends with the money he has.

More formally, for each good, its price is determined by $ a_i $ â€” the number of coins it costs. Initially, Vasya has $ p $ coins. He wants to buy the maximum number of goods. Vasya can perform one of the following operations as many times as necessary:

- Vasya can buy one good with the index $ i $ if he currently has enough coins (i.e $ p \ge a_i $ ). After buying this good, the number of Vasya's coins will decrease by $ a_i $ , (i.e it becomes $ p := p - a_i $ ).
- Vasya can buy a good with the index $ i $ , and also choose exactly $ k-1 $ goods, the price of which does not exceed $ a_i $ , if he currently has enough coins (i.e $ p \ge a_i $ ). Thus, he buys all these $ k $ goods, and his number of coins decreases by $ a_i $ (i.e it becomes $ p := p - a_i $ ).

Please note that each good can be bought no more than once.

For example, if the store now has $ n=5 $ goods worth $ a_1=2, a_2=4, a_3=3, a_4=5, a_5=7 $ , respectively, $ k=2 $ , and Vasya has $ 6 $ coins, then he can buy $ 3 $ goods. A good with the index $ 1 $ will be bought by Vasya without using the offer and he will pay $ 2 $ coins. Goods with the indices $ 2 $ and $ 3 $ Vasya will buy using the offer and he will pay $ 4 $ coins. It can be proved that Vasya can not buy more goods with six coins.

Help Vasya to find out the maximum number of goods he can buy.

## æ ·ä¾‹ #1

### è¾“å…¥

```
8
5 6 2
2 4 3 5 7
5 11 2
2 4 3 5 7
3 2 3
4 2 6
5 2 3
10 1 3 9 2
2 10000 2
10000 10000
2 9999 2
10000 10000
4 6 4
3 2 3 2
5 5 3
1 2 2 1 2
```

### è¾“å‡º

```
3
4
1
1
2
0
4
5
```

# AIåˆ†æç»“æœ

# ğŸ’¡ Kayçš„C++ç®—æ³•è§£æï¼šK for the Price of One (Hard Version) æ·±å…¥å­¦ä¹ æŒ‡å— ğŸ’¡


## 1. é¢˜ç›®è§£è¯»ä¸æ ¸å¿ƒç®—æ³•è¯†åˆ«

âœ¨ **æœ¬é¢˜ä¸»è¦è€ƒå¯Ÿ**ï¼šè´ªå¿ƒç®—æ³• + åŠ¨æ€è§„åˆ’ï¼ˆDPï¼‰

ğŸ—£ï¸ **åˆæ­¥åˆ†æ**ï¼š  
è§£å†³â€œK for the Price of Oneâ€é—®é¢˜çš„å…³é”®ï¼Œåœ¨äº**ç”¨æœ€å°‘çš„é’±ä¹°æœ€å¤šçš„å•†å“**ã€‚è¿™éœ€è¦ç»“åˆ**è´ªå¿ƒ**ï¼ˆä¼˜å…ˆé€‰ä¾¿å®œçš„å•†å“ï¼‰å’Œ**åŠ¨æ€è§„åˆ’**ï¼ˆè®¡ç®—ä¹°å‰`i`ä¸ªå•†å“çš„æœ€å°èŠ±è´¹ï¼‰ã€‚  
ç®€å•æ¥è¯´ï¼Œ**è´ªå¿ƒ**å°±åƒâ€œæŒ‘ä¾¿å®œçš„èœä¹°ï¼Œæ‰èƒ½ä¹°æ›´å¤šâ€â€”â€”æˆ‘ä»¬å…ˆæŠŠå•†å“æŒ‰ä»·æ ¼ä»å°åˆ°å¤§æ’åºï¼Œè¿™æ ·å‰é¢çš„å•†å“æ›´ä¾¿å®œï¼Œä¼˜å…ˆè´­ä¹°èƒ½æœ€å¤§åŒ–æ•°é‡ã€‚**åŠ¨æ€è§„åˆ’**åˆ™åƒâ€œè®°è´¦æœ¬â€ï¼Œè®°å½•ä¹°å‰`i`ä¸ªå•†å“çš„æœ€å°èŠ±è´¹ï¼Œé¿å…é‡å¤è®¡ç®—ã€‚  

åœ¨æœ¬é¢˜ä¸­ï¼ŒåŠ¨æ€è§„åˆ’çš„æ ¸å¿ƒæ˜¯**çŠ¶æ€å®šä¹‰**ï¼š`dp[i]`è¡¨ç¤ºä¹°å‰`i`ä¸ªå•†å“çš„æœ€å°èŠ±è´¹ã€‚**è½¬ç§»æ–¹ç¨‹**åˆ†ä¸¤ç§æƒ…å†µï¼š  
- å½“`i < k`æ—¶ï¼Œä¸å¤Ÿ`k`ä¸ªå•†å“ï¼Œæ— æ³•ä½¿ç”¨ä¼˜æƒ ï¼Œåªèƒ½ä¸€ä¸ªä¸ªä¹°ï¼Œæ‰€ä»¥`dp[i] = dp[i-1] + a[i]`ï¼ˆå‰`i-1`ä¸ªçš„èŠ±è´¹åŠ ç¬¬`i`ä¸ªçš„ä»·æ ¼ï¼‰ã€‚  
- å½“`i â‰¥ k`æ—¶ï¼Œå¯ä»¥ä½¿ç”¨ä¼˜æƒ ï¼šä¹°ç¬¬`i`ä¸ªå•†å“ï¼ˆæœ€è´µçš„ï¼‰ï¼Œå…è´¹æ‹¿å‰é¢`k-1`ä¸ªï¼Œæ‰€ä»¥`dp[i] = dp[i-k] + a[i]`ï¼ˆå‰`i-k`ä¸ªçš„èŠ±è´¹åŠ ç¬¬`i`ä¸ªçš„ä»·æ ¼ï¼‰ã€‚  

**å¯è§†åŒ–è®¾è®¡æ€è·¯**ï¼š  
æˆ‘ä»¬å°†ç”¨**8ä½åƒç´ é£æ ¼**å±•ç¤ºç®—æ³•æµç¨‹ï¼š  
- ç”¨ä¸åŒé¢œè‰²çš„åƒç´ å—è¡¨ç¤ºå•†å“ä»·æ ¼ï¼ˆè¶Šä¾¿å®œé¢œè‰²è¶Šæµ…ï¼‰ï¼Œæ’åºåæŒ‰é¡ºåºæ’åˆ—ã€‚  
- ç”¨åŠ¨æ€å˜åŒ–çš„â€œè´¦æœ¬â€ï¼ˆåƒç´ è¡¨æ ¼ï¼‰å±•ç¤º`dp`æ•°ç»„çš„è®¡ç®—è¿‡ç¨‹ï¼šæ¯è®¡ç®—ä¸€ä¸ª`dp[i]`ï¼Œå¯¹åº”çš„åƒç´ å—ä¼šé—ªçƒï¼Œå¹¶æ ‡æ³¨ç”¨åˆ°çš„`i-k`æˆ–`i-1`ä½ç½®ã€‚  
- å…³é”®æ“ä½œï¼ˆå¦‚æ’åºã€è®¡ç®—`dp[i]`ã€æ‰¾åˆ°ç­”æ¡ˆï¼‰ä¼´éš**åƒç´ éŸ³æ•ˆ**ï¼ˆæ¯”å¦‚æ’åºå®Œæˆæ—¶â€œå®â€çš„ä¸€å£°ï¼Œè®¡ç®—`dp[i]`æ—¶â€œæ»´â€çš„ä¸€å£°ï¼‰ã€‚  


## 2. ç²¾é€‰ä¼˜è´¨é¢˜è§£å‚è€ƒ

### é¢˜è§£ä¸€ï¼šRex01ï¼ˆè´ªå¿ƒ+DPï¼Œæ€è·¯æ¸…æ™°ï¼‰  
* **ç‚¹è¯„**ï¼š  
  è¿™ä»½é¢˜è§£çš„æ ¸å¿ƒæ€è·¯éå¸¸æ˜ç¡®â€”â€”å…ˆæ’åºï¼ˆè´ªå¿ƒé€‰ä¾¿å®œçš„ï¼‰ï¼Œå†ç”¨DPè®¡ç®—æœ€å°èŠ±è´¹ã€‚ä»£ç ä¸­`z`æ•°ç»„ï¼ˆå³`dp`ï¼‰çš„åˆå§‹åŒ–ç”¨äº†`0x3f3f3f3f`ï¼ˆè¡¨ç¤ºæ— ç©·å¤§ï¼‰ï¼Œç„¶åé€šè¿‡`min`å‡½æ•°æ›´æ–°`z[i]`ï¼Œé¿å…äº†é”™è¯¯ã€‚æ¯”å¦‚`z[i] = min(z[i], z[i-k] + a[i])`ï¼Œç¡®ä¿`z[i]`å§‹ç»ˆæ˜¯å‰`i`ä¸ªçš„æœ€å°èŠ±è´¹ã€‚æœ€åéå†`z`æ•°ç»„æ‰¾æœ€å¤§çš„`i`ï¼Œé€»è¾‘ä¸¥è°¨ï¼Œå®¹æ˜“ç†è§£ã€‚  

### é¢˜è§£äºŒï¼šOIerWu_829ï¼ˆå€’åºéå†ï¼Œé«˜æ•ˆæ‰¾ç­”æ¡ˆï¼‰  
* **ç‚¹è¯„**ï¼š  
  æ­¤é¢˜è§£çš„äº®ç‚¹åœ¨äº**å€’åºéå†æ‰¾ç­”æ¡ˆ**ã€‚è®¡ç®—å®Œ`f`æ•°ç»„ï¼ˆ`dp`ï¼‰åï¼Œä»`n`åˆ°`1`å¾ªç¯ï¼Œç¬¬ä¸€ä¸ªæ»¡è¶³`f[i] â‰¤ p`çš„`i`å°±æ˜¯æœ€å¤§æ•°é‡ã€‚è¿™æ ·æ¯”æ­£åºéå†æ›´é«˜æ•ˆï¼ˆæ‰¾åˆ°å°±breakï¼‰ã€‚ä»£ç ä¸­çš„`Inf`ï¼ˆ`0x3f3f3f3f`ï¼‰åˆå§‹åŒ–ä¹Ÿå¾ˆè§„èŒƒï¼Œé¿å…äº†æœªåˆå§‹åŒ–çš„é”™è¯¯ã€‚  

### é¢˜è§£ä¸‰ï¼šLu_xZï¼ˆè´ªå¿ƒæšä¸¾ï¼Œå¦è¾Ÿè¹Šå¾„ï¼‰  
* **ç‚¹è¯„**ï¼š  
  è¿™é“é¢˜è§£æ²¡æœ‰ç”¨DPï¼Œè€Œæ˜¯ç”¨äº†**è´ªå¿ƒæšä¸¾**çš„æ–¹æ³•ã€‚æ€è·¯æ˜¯ï¼šæšä¸¾å‰`i`ä¸ªå­¤ç«‹ç‚¹ï¼ˆ`i < k`ï¼Œä¸å¤Ÿ`k`ä¸ªï¼Œåªèƒ½ä¸€ä¸ªä¸ªä¹°ï¼‰ï¼Œç„¶ååé¢çš„å•†å“ç”¨ä¼˜æƒ ï¼ˆæ¯`k`ä¸ªä¹°ä¸€æ¬¡ï¼‰ã€‚æ¯”å¦‚`i=2`ï¼Œ`k=3`ï¼Œåˆ™å‰2ä¸ªå•ç‹¬ä¹°ï¼Œåé¢çš„ä»ç¬¬5ä¸ªå¼€å§‹ï¼ˆ`2+3=5`ï¼‰æ¯3ä¸ªä¹°ä¸€æ¬¡ã€‚è¿™ç§æ–¹æ³•çš„æ—¶é—´å¤æ‚åº¦æ˜¯`O(k*(n/k))=O(n)`ï¼Œå’ŒDPä¸€æ ·é«˜æ•ˆï¼Œä½†æ€è·¯æ›´ç›´è§‚ï¼Œé€‚åˆç†è§£è´ªå¿ƒçš„æœ¬è´¨ã€‚  


## 3. æ ¸å¿ƒéš¾ç‚¹è¾¨æä¸è§£é¢˜ç­–ç•¥

### 1. **å…³é”®ç‚¹1ï¼šçŠ¶æ€å®šä¹‰çš„æ­£ç¡®æ€§**  
* **éš¾ç‚¹**ï¼šä¸ºä»€ä¹ˆ`dp[i]`è¡¨ç¤ºâ€œä¹°å‰`i`ä¸ªå•†å“çš„æœ€å°èŠ±è´¹â€ï¼Ÿ  
* **åˆ†æ**ï¼š  
  å› ä¸ºæˆ‘ä»¬å·²ç»å°†å•†å“æŒ‰ä»·æ ¼ä»å°åˆ°å¤§æ’åºï¼Œå‰`i`ä¸ªå•†å“æ˜¯æœ€ä¾¿å®œçš„`i`ä¸ªã€‚ä¹°è¿™`i`ä¸ªå•†å“çš„æœ€å°èŠ±è´¹ï¼Œå°±æ˜¯èƒ½ä¹°æœ€å¤šå•†å“çš„åŸºç¡€â€”â€”åªæœ‰èŠ±æœ€å°‘çš„é’±ä¹°å‰`i`ä¸ªï¼Œæ‰èƒ½å‰©ä¸‹æ›´å¤šé’±ä¹°æ›´å¤šå•†å“ã€‚å¦‚æœ`dp[i]`å®šä¹‰ä¸ºå…¶ä»–å†…å®¹ï¼ˆæ¯”å¦‚ä¹°`i`ä¸ªå•†å“çš„æœ€å°èŠ±è´¹ï¼‰ï¼Œå°±æ— æ³•ä¿è¯å‰`i`ä¸ªæ˜¯æœ€ä¾¿å®œçš„ï¼Œå¯¼è‡´ç»“æœé”™è¯¯ã€‚  
* ğŸ’¡ **å­¦ä¹ ç¬”è®°**ï¼šçŠ¶æ€å®šä¹‰è¦è´´åˆè´ªå¿ƒç­–ç•¥ï¼Œç¡®ä¿è¦†ç›–æ‰€æœ‰æœ€ä¼˜æƒ…å†µã€‚  

### 2. **å…³é”®ç‚¹2ï¼šè½¬ç§»æ–¹ç¨‹çš„æ¨å¯¼**  
* **éš¾ç‚¹**ï¼šä¸ºä»€ä¹ˆ`i â‰¥ k`æ—¶ï¼Œ`dp[i] = dp[i-k] + a[i]`ï¼Ÿ  
* **åˆ†æ**ï¼š  
  å½“`i â‰¥ k`æ—¶ï¼Œä¹°ç¬¬`i`ä¸ªå•†å“ï¼ˆæœ€è´µçš„ï¼‰ï¼Œå¯ä»¥å…è´¹æ‹¿å‰é¢`k-1`ä¸ªï¼ˆç¬¬`i-k+1`åˆ°`i-1`ä¸ªï¼‰ã€‚æ‰€ä»¥å‰`i`ä¸ªå•†å“çš„èŠ±è´¹ï¼Œç­‰äºå‰`i-k`ä¸ªçš„èŠ±è´¹ï¼ˆä¹°å‰`i-k`ä¸ªçš„é’±ï¼‰åŠ ä¸Šç¬¬`i`ä¸ªçš„ä»·æ ¼ï¼ˆä¹°ç¬¬`i`ä¸ªçš„é’±ï¼‰ã€‚æ¯”å¦‚`i=k`æ—¶ï¼Œå‰`k`ä¸ªçš„èŠ±è´¹æ˜¯`a[k]`ï¼ˆä¹°ç¬¬`k`ä¸ªï¼Œå…è´¹æ‹¿å‰`k-1`ä¸ªï¼‰ï¼›`i=k+1`æ—¶ï¼Œå‰`k+1`ä¸ªçš„èŠ±è´¹æ˜¯`dp[1] + a[k+1]`ï¼ˆä¹°å‰1ä¸ªï¼Œå†ä¹°ç¬¬`k+1`ä¸ªï¼Œå…è´¹æ‹¿ç¬¬2åˆ°`k+1`ä¸ªä¸­çš„`k-1`ä¸ªï¼‰ã€‚  
* ğŸ’¡ **å­¦ä¹ ç¬”è®°**ï¼šè½¬ç§»æ–¹ç¨‹è¦è€ƒè™‘ä¼˜æƒ çš„ä½¿ç”¨ï¼Œç¡®ä¿æ¯ä¸€æ­¥éƒ½æ˜¯æœ€ä¼˜çš„ã€‚  

### 3. **å…³é”®ç‚¹3ï¼šè´ªå¿ƒæ’åºçš„å¿…è¦æ€§**  
* **éš¾ç‚¹**ï¼šä¸ºä»€ä¹ˆè¦å°†å•†å“æŒ‰ä»·æ ¼ä»å°åˆ°å¤§æ’åºï¼Ÿ  
* **åˆ†æ**ï¼š  
  è¦ä¹°æœ€å¤šçš„å•†å“ï¼Œå¿…é¡»ä¼˜å…ˆä¹°æœ€ä¾¿å®œçš„ã€‚å¦‚æœä¸æ’åºï¼Œæ¯”å¦‚å…ˆä¹°è´µçš„å•†å“ï¼Œé‚£ä¹ˆå‰©ä¸‹çš„é’±å°±ä¸å¤Ÿä¹°æ›´å¤šä¾¿å®œçš„å•†å“äº†ã€‚æ¯”å¦‚æ ·ä¾‹ä¸­çš„è¾“å…¥`2 4 3 5 7`ï¼Œæ’åºåæ˜¯`2 3 4 5 7`ï¼Œä¹°å‰3ä¸ªçš„èŠ±è´¹æ˜¯`2+4=6`ï¼ˆä¹°ç¬¬1ä¸ªï¼Œå†ä¹°ç¬¬3ä¸ªï¼Œå…è´¹æ‹¿ç¬¬2ä¸ªï¼‰ï¼Œè€Œå¦‚æœä¸æ’åºï¼Œä¹°`4`å’Œ`3`çš„è¯ï¼ŒèŠ±è´¹æ˜¯`4`ï¼Œä½†åªèƒ½ä¹°2ä¸ªï¼Œä¸å¦‚æ’åºåçš„3ä¸ªå¤šã€‚  
* ğŸ’¡ **å­¦ä¹ ç¬”è®°**ï¼šè´ªå¿ƒæ’åºæ˜¯è§£å†³â€œæœ€å¤šæ•°é‡â€é—®é¢˜çš„å¸¸ç”¨æŠ€å·§ï¼Œä¼˜å…ˆé€‰æˆæœ¬ä½çš„ã€‚  

### âœ¨ è§£é¢˜æŠ€å·§æ€»ç»“  
- **æŠ€å·§Aï¼šè´ªå¿ƒæ’åº**ï¼šå¯¹äºâ€œæœ€å¤šæ•°é‡â€é—®é¢˜ï¼Œä¼˜å…ˆé€‰ä¾¿å®œçš„å•†å“ï¼Œæ’åºæ˜¯åŸºç¡€ã€‚  
- **æŠ€å·§Bï¼šåŠ¨æ€è§„åˆ’è®°å½•æœ€å°èŠ±è´¹**ï¼šç”¨`dp`æ•°ç»„è®°å½•å‰`i`ä¸ªçš„æœ€å°èŠ±è´¹ï¼Œé¿å…é‡å¤è®¡ç®—ã€‚  
- **æŠ€å·§Cï¼šå€’åºéå†æ‰¾ç­”æ¡ˆ**ï¼šè®¡ç®—å®Œ`dp`æ•°ç»„åï¼Œä»åå¾€å‰æ‰¾ç¬¬ä¸€ä¸ªæ»¡è¶³æ¡ä»¶çš„`i`ï¼Œæ›´é«˜æ•ˆã€‚  


## 4. C++æ ¸å¿ƒä»£ç å®ç°èµæ

### æœ¬é¢˜é€šç”¨æ ¸å¿ƒC++å®ç°å‚è€ƒ  
* **è¯´æ˜**ï¼šæœ¬ä»£ç ç»¼åˆäº†å¤šä¸ªä¼˜è´¨é¢˜è§£çš„æ€è·¯ï¼Œæ˜¯è´ªå¿ƒ+DPçš„å…¸å‹å®ç°ã€‚  
* **å®Œæ•´æ ¸å¿ƒä»£ç **ï¼š  
  ```cpp
  #include <iostream>
  #include <algorithm>
  using namespace std;

  const int N = 2e5 + 5;
  const int INF = 0x3f3f3f3f;

  int a[N], dp[N];

  int main() {
      ios::sync_with_stdio(false);
      cin.tie(0);
      int t;
      cin >> t;
      while (t--) {
          int n, p, k;
          cin >> n >> p >> k;
          for (int i = 1; i <= n; i++) {
              cin >> a[i];
              dp[i] = INF; // åˆå§‹åŒ–dpæ•°ç»„ä¸ºæ— ç©·å¤§
          }
          sort(a + 1, a + n + 1); // è´ªå¿ƒæ’åº
          dp[0] = 0; // 0ä¸ªå•†å“çš„èŠ±è´¹æ˜¯0
          for (int i = 1; i <= n; i++) {
              if (i < k) {
                  dp[i] = dp[i-1] + a[i]; // ä¸å¤Ÿkä¸ªï¼Œä¸€ä¸ªä¸ªä¹°
              } else {
                  dp[i] = min(dp[i], dp[i-k] + a[i]); // ç”¨ä¼˜æƒ ï¼Œä¹°ç¬¬iä¸ª
              }
              // æ³¨æ„ï¼šæœ‰äº›é¢˜è§£ä¼šåŠ ä¸Šdp[i] = min(dp[i], dp[i-1] + a[i])ï¼Œä½†å…¶å®ä¸éœ€è¦ï¼Œå› ä¸ºæ’åºåa[i] >= a[i-1]ï¼Œæ‰€ä»¥dp[i-1] + a[i] >= dp[i]ï¼ˆæ¯”å¦‚i=kæ—¶ï¼Œdp[k] = a[k]ï¼Œè€Œdp[k-1] + a[k] = (a[1]+...+a[k-1]) + a[k] >= a[k]ï¼‰
          }
          int ans = 0;
          for (int i = 1; i <= n; i++) {
              if (dp[i] <= p) {
                  ans = i; // æ‰¾æœ€å¤§çš„i
              }
          }
          cout << ans << endl;
      }
      return 0;
  }
  ```
* **ä»£ç è§£è¯»æ¦‚è¦**ï¼š  
  1. **è¾“å…¥å¤„ç†**ï¼šè¯»å–æµ‹è¯•ç”¨ä¾‹æ•°`t`ï¼Œç„¶åè¯»å–æ¯ä¸ªæµ‹è¯•ç”¨ä¾‹çš„`n`ï¼ˆå•†å“æ•°ï¼‰ã€`p`ï¼ˆé’±æ•°ï¼‰ã€`k`ï¼ˆä¼˜æƒ æ•°é‡ï¼‰ã€‚  
  2. **æ’åº**ï¼šå°†å•†å“æŒ‰ä»·æ ¼ä»å°åˆ°å¤§æ’åºï¼Œè´ªå¿ƒé€‰ä¾¿å®œçš„ã€‚  
  3. **DPè®¡ç®—**ï¼šåˆå§‹åŒ–`dp`æ•°ç»„ä¸ºæ— ç©·å¤§ï¼Œ`dp[0] = 0`ï¼ˆ0ä¸ªå•†å“çš„èŠ±è´¹æ˜¯0ï¼‰ã€‚ç„¶åè®¡ç®—æ¯ä¸ª`dp[i]`ï¼š`i < k`æ—¶ï¼Œ`dp[i] = dp[i-1] + a[i]`ï¼›`i >= k`æ—¶ï¼Œ`dp[i] = dp[i-k] + a[i]`ã€‚  
  4. **æ‰¾ç­”æ¡ˆ**ï¼šéå†`dp`æ•°ç»„ï¼Œæ‰¾æœ€å¤§çš„`i`ä½¿å¾—`dp[i] <= p`ã€‚  

### é’ˆå¯¹å„ä¼˜è´¨é¢˜è§£çš„ç‰‡æ®µèµæ  

#### é¢˜è§£ä¸€ï¼šRex01ï¼ˆ`z`æ•°ç»„çš„åˆå§‹åŒ–ä¸æ›´æ–°ï¼‰  
* **äº®ç‚¹**ï¼šç”¨`0x3f3f3f3f`åˆå§‹åŒ–`z`æ•°ç»„ï¼Œé¿å…æœªåˆå§‹åŒ–çš„é”™è¯¯ã€‚  
* **æ ¸å¿ƒä»£ç ç‰‡æ®µ**ï¼š  
  ```cpp
  for (int i = 1; i <= n; i++)
      z[i] = 0x3f3f3f3f; // åˆå§‹åŒ–æ— ç©·å¤§
  for (int i = 1; i <= n; i++) {
      if (i >= k) z[i] = min(z[i], z[i - k] + a[i]);
      z[i] = min(z[i], z[i - 1] + a[i]);
  }
  ```
* **ä»£ç è§£è¯»**ï¼š  
  - `0x3f3f3f3f`æ˜¯ä¸€ä¸ªå¾ˆå¤§çš„æ•°ï¼Œè¡¨ç¤ºâ€œæ— æ³•åˆ°è¾¾â€ã€‚åˆå§‹åŒ–`z`æ•°ç»„ä¸ºè¿™ä¸ªå€¼ï¼Œç¡®ä¿åé¢çš„`min`æ“ä½œèƒ½æ­£ç¡®æ›´æ–°ã€‚  
  - `z[i] = min(z[i], z[i - k] + a[i])`ï¼šè®¡ç®—ç”¨ä¼˜æƒ ä¹°å‰`i`ä¸ªçš„èŠ±è´¹ã€‚  
  - `z[i] = min(z[i], z[i - 1] + a[i])`ï¼šè®¡ç®—ä¸ç”¨ä¼˜æƒ ä¹°å‰`i`ä¸ªçš„èŠ±è´¹ï¼ˆå…¶å®æ’åºåä¸éœ€è¦ï¼Œå› ä¸º`z[i - 1] + a[i] >= z[i]`ï¼‰ã€‚  
* ğŸ’¡ **å­¦ä¹ ç¬”è®°**ï¼šåˆå§‹åŒ–æ•°ç»„ä¸ºæ— ç©·å¤§æ˜¯DPçš„å¸¸ç”¨æŠ€å·§ï¼Œé¿å…é”™è¯¯ã€‚  

#### é¢˜è§£äºŒï¼šOIerWu_829ï¼ˆå€’åºéå†æ‰¾ç­”æ¡ˆï¼‰  
* **äº®ç‚¹**ï¼šå€’åºéå†æ›´é«˜æ•ˆï¼Œæ‰¾åˆ°ç­”æ¡ˆå°±breakã€‚  
* **æ ¸å¿ƒä»£ç ç‰‡æ®µ**ï¼š  
  ```cpp
  bool fl = true;
  for (int i = n; i >= 1; i--)
      if (f[i] <= p) {
          fl = false;
          cout << i << "\n";
          break;
      }
  if (fl) cout << "0\n";
  ```
* **ä»£ç è§£è¯»**ï¼š  
  - ä»`n`åˆ°`1`å¾ªç¯ï¼Œç¬¬ä¸€ä¸ªæ»¡è¶³`f[i] <= p`çš„`i`å°±æ˜¯æœ€å¤§æ•°é‡ã€‚æ¯”å¦‚`n=5`ï¼Œå¦‚æœ`f[5] <= p`ï¼Œå°±è¾“å‡º5ï¼Œå¦åˆ™æ£€æŸ¥`f[4]`ï¼Œä¾æ­¤ç±»æ¨ã€‚  
  - `fl`å˜é‡ç”¨äºåˆ¤æ–­æ˜¯å¦æœ‰è§£ï¼ˆå¦‚æœæ²¡æœ‰ï¼Œè¾“å‡º0ï¼‰ã€‚  
* ğŸ’¡ **å­¦ä¹ ç¬”è®°**ï¼šå€’åºéå†èƒ½å‡å°‘å¾ªç¯æ¬¡æ•°ï¼Œæé«˜æ•ˆç‡ã€‚  

#### é¢˜è§£ä¸‰ï¼šLu_xZï¼ˆè´ªå¿ƒæšä¸¾å­¤ç«‹ç‚¹ï¼‰  
* **äº®ç‚¹**ï¼šä¸ç”¨DPï¼Œç”¨è´ªå¿ƒæšä¸¾å‰`i`ä¸ªå­¤ç«‹ç‚¹ï¼Œåé¢ç”¨æ•´æ®µã€‚  
* **æ ¸å¿ƒä»£ç ç‰‡æ®µ**ï¼š  
  ```cpp
  int sum = 0;
  for (int i = 0; i < k; ++i) {
      sum += a[i];
      if (sum > p) break;
      int tmp = i, cur = sum;
      for (int j = i + k; j <= n; j += k) {
          cur += a[j];
          if (cur > p) break;
          tmp += k;
      }
      ans = max(ans, tmp);
  }
  ```
* **ä»£ç è§£è¯»**ï¼š  
  - æšä¸¾å‰`i`ä¸ªå­¤ç«‹ç‚¹ï¼ˆ`i < k`ï¼‰ï¼Œ`sum`æ˜¯å‰`i`ä¸ªçš„èŠ±è´¹ã€‚  
  - ç„¶åä»`i + k`å¼€å§‹ï¼Œæ¯`k`ä¸ªä¹°ä¸€æ¬¡ï¼ˆ`j += k`ï¼‰ï¼Œ`cur`æ˜¯æ€»èŠ±è´¹ï¼Œ`tmp`æ˜¯æ€»æ•°é‡ã€‚  
  - æ¯æ¬¡æšä¸¾éƒ½æ›´æ–°`ans`ï¼ˆæœ€å¤§æ•°é‡ï¼‰ã€‚  
* ğŸ’¡ **å­¦ä¹ ç¬”è®°**ï¼šè´ªå¿ƒæšä¸¾æ˜¯DPçš„æ›¿ä»£æ–¹æ³•ï¼Œæ€è·¯æ›´ç›´è§‚ã€‚  


## 5. ç®—æ³•å¯è§†åŒ–ï¼šåƒç´ åŠ¨ç”»æ¼”ç¤º (æ ¸å¿ƒéƒ¨åˆ†)

### åŠ¨ç”»æ¼”ç¤ºä¸»é¢˜ï¼šã€Šåƒç´ å•†åº—å¤§é‡‡è´­ã€‹ï¼ˆ8ä½é£æ ¼ï¼‰  
### æ ¸å¿ƒæ¼”ç¤ºå†…å®¹ï¼š  
- **åœºæ™¯åˆå§‹åŒ–**ï¼šå±å¹•å·¦ä¾§æ˜¯æ’åºåçš„å•†å“åˆ—è¡¨ï¼ˆåƒç´ å—ï¼Œé¢œè‰²è¶Šæµ…ä»·æ ¼è¶Šä¾¿å®œï¼‰ï¼Œå³ä¾§æ˜¯`dp`æ•°ç»„è´¦æœ¬ï¼ˆåƒç´ è¡¨æ ¼ï¼Œæ¯è¡Œæ˜¾ç¤º`dp[i]`çš„å€¼ï¼‰ã€‚  
- **æ’åºè¿‡ç¨‹**ï¼šå•†å“ä»æ— åºçŠ¶æ€é€æ¸æ’åˆ—æˆä»å°åˆ°å¤§çš„é¡ºåºï¼Œä¼´éšâ€œæ²™æ²™â€çš„åƒç´ éŸ³æ•ˆã€‚  
- **DPè®¡ç®—**ï¼š  
  - ç”¨çº¢è‰²ç®­å¤´æŒ‡å‘å½“å‰å¤„ç†çš„`i`ï¼ˆæ¯”å¦‚`i=3`ï¼‰ï¼Œç„¶åæŒ‡å‘`i-1`ï¼ˆ`i=2`ï¼‰æˆ–`i-k`ï¼ˆ`i=3-k`ï¼Œå¦‚æœ`k=2`åˆ™æ˜¯`i=1`ï¼‰ã€‚  
  - `dp[i]`çš„åƒç´ å—ä»`0x3f3f3f3f`ï¼ˆç°è‰²ï¼‰å˜æˆè®¡ç®—åçš„å€¼ï¼ˆæ¯”å¦‚`dp[3] = dp[1] + a[3]`ï¼Œåˆ™å˜æˆè“è‰²ï¼‰ï¼Œä¼´éšâ€œæ»´â€çš„éŸ³æ•ˆã€‚  
- **æ‰¾ç­”æ¡ˆ**ï¼šä»`n`åˆ°`1`å¾ªç¯ï¼Œæ¯ä¸ª`i`çš„åƒç´ å—é—ªçƒï¼Œå½“æ‰¾åˆ°æ»¡è¶³`dp[i] <= p`çš„`i`æ—¶ï¼Œè¯¥åƒç´ å—å˜æˆç»¿è‰²ï¼Œä¼´éšâ€œå®â€çš„èƒœåˆ©éŸ³æ•ˆã€‚  

### äº¤äº’è®¾è®¡ï¼š  
- **æ§åˆ¶é¢æ¿**ï¼šæœ‰â€œå¼€å§‹/æš‚åœâ€ã€â€œå•æ­¥æ‰§è¡Œâ€ã€â€œé‡ç½®â€æŒ‰é’®ï¼Œä»¥åŠé€Ÿåº¦æ»‘å—ï¼ˆè°ƒæ•´åŠ¨ç”»é€Ÿåº¦ï¼‰ã€‚  
- **AIè‡ªåŠ¨æ¼”ç¤º**ï¼šç‚¹å‡»â€œAIè‡ªåŠ¨â€æŒ‰é’®ï¼ŒåŠ¨ç”»ä¼šè‡ªåŠ¨æ‰§è¡Œï¼Œåƒâ€œè´ªåƒè›‡AIâ€ä¸€æ ·å®Œæˆé‡‡è´­è¿‡ç¨‹ã€‚  
- **éŸ³æ•ˆè®¾ç½®**ï¼šå¯ä»¥é€‰æ‹©å¼€å¯/å…³é—­èƒŒæ™¯éŸ³ä¹ï¼ˆ8ä½é£æ ¼çš„è½»æ¾æ—‹å¾‹ï¼‰å’Œæ“ä½œéŸ³æ•ˆã€‚  

### è®¾è®¡æ€è·¯ï¼š  
- **8ä½åƒç´ é£æ ¼**ï¼šè¥é€ å¤å¤æ¸¸æˆçš„æ°›å›´ï¼Œè®©å­¦ä¹ æ›´æœ‰è¶£ã€‚  
- **åŠ¨æ€é«˜äº®**ï¼šç”¨é¢œè‰²å’Œç®­å¤´çªå‡ºå½“å‰æ“ä½œï¼Œå¸®åŠ©ç†è§£ç®—æ³•æµç¨‹ã€‚  
- **éŸ³æ•ˆåé¦ˆ**ï¼šç”¨ä¸åŒçš„éŸ³æ•ˆå¼ºåŒ–å…³é”®æ“ä½œï¼Œæ¯”å¦‚æ’åºå®Œæˆã€è®¡ç®—`dp[i]`ã€æ‰¾åˆ°ç­”æ¡ˆï¼Œè®©å­¦ä¹ è€…â€œå¬â€åˆ°ç®—æ³•çš„è¿›å±•ã€‚  


## 6. æ‹“å±•ç»ƒä¹ ä¸ç›¸ä¼¼é—®é¢˜æ€è€ƒ

### é€šç”¨æ€è·¯/æŠ€å·§è¿ç§»  
- **è´ªå¿ƒæ’åº**ï¼šé€‚ç”¨äºæ‰€æœ‰â€œæœ€å¤šæ•°é‡â€æˆ–â€œæœ€å°æˆæœ¬â€é—®é¢˜ï¼Œæ¯”å¦‚â€œä¹°æœ€å¤šçš„æ°´æœâ€ã€â€œç”¨æœ€å°‘çš„é’±ä¹°æœ€å¤šçš„ä¹¦â€ã€‚  
- **åŠ¨æ€è§„åˆ’è®°å½•æœ€å°èŠ±è´¹**ï¼šé€‚ç”¨äºéœ€è¦é€æ­¥è®¡ç®—æœ€ä¼˜è§£çš„é—®é¢˜ï¼Œæ¯”å¦‚â€œçˆ¬æ¥¼æ¢¯â€ã€â€œèƒŒåŒ…é—®é¢˜â€ã€‚  
- **ä¼˜æƒ ç­–ç•¥é—®é¢˜**ï¼šé€‚ç”¨äºæ‰€æœ‰åŒ…å«â€œä¹°ä¸€é€å¤šâ€æˆ–â€œæ‰¹é‡æŠ˜æ‰£â€çš„é—®é¢˜ï¼Œæ¯”å¦‚â€œä¹°3é€1â€çš„ä¿ƒé”€æ´»åŠ¨ã€‚  

### ç»ƒä¹ æ¨è (æ´›è°·)  
1. **æ´›è°· P1208 æ··åˆç‰›å¥¶**  
   ğŸ—£ï¸ **æ¨èç†ç”±**ï¼šè¿™é“é¢˜éœ€è¦ç”¨è´ªå¿ƒç®—æ³•é€‰æœ€ä¾¿å®œçš„ç‰›å¥¶ï¼Œå’Œæœ¬é¢˜çš„è´ªå¿ƒæ’åºæ€è·¯ä¸€è‡´ï¼Œèƒ½å¸®åŠ©å·©å›ºè´ªå¿ƒçš„åŸºç¡€ã€‚  
2. **æ´›è°· P1090 åˆå¹¶æœå­**  
   ğŸ—£ï¸ **æ¨èç†ç”±**ï¼šè¿™é“é¢˜éœ€è¦ç”¨è´ªå¿ƒç®—æ³•é€‰æœ€å°çš„ä¸¤å †æœå­åˆå¹¶ï¼Œå’Œæœ¬é¢˜çš„â€œä¼˜å…ˆé€‰ä¾¿å®œçš„â€æ€è·¯ç±»ä¼¼ï¼Œèƒ½å¸®åŠ©ç†è§£è´ªå¿ƒçš„æœ¬è´¨ã€‚  
3. **æ´›è°· P2123 çš‡åæ¸¸æˆ**  
   ğŸ—£ï¸ **æ¨èç†ç”±**ï¼šè¿™é“é¢˜éœ€è¦ç”¨è´ªå¿ƒæ’åº+åŠ¨æ€è§„åˆ’ï¼Œå’Œæœ¬é¢˜çš„â€œè´ªå¿ƒ+DPâ€ç»„åˆæ€è·¯ä¸€è‡´ï¼Œèƒ½å¸®åŠ©æå‡ç»¼åˆåº”ç”¨èƒ½åŠ›ã€‚  
4. **æ´›è°· CF1282B1 K for the Price of One (Easy Version)**  
   ğŸ—£ï¸ **æ¨èç†ç”±**ï¼šè¿™æ˜¯æœ¬é¢˜çš„ç®€å•ç‰ˆæœ¬ï¼Œ`k`å›ºå®šä¸º2ï¼Œèƒ½å¸®åŠ©ç†Ÿæ‚‰æœ¬é¢˜çš„åŸºæœ¬æ€è·¯ï¼Œå†è¿‡æ¸¡åˆ°éš¾ç‰ˆæœ¬ã€‚  


## 7. å­¦ä¹ å¿ƒå¾—ä¸ç»éªŒåˆ†äº« (è‹¥æœ‰)  
æœ¬æ¬¡åˆ†æçš„é¢˜è§£ä¸­ï¼Œ**Lu_xZ**çš„è´ªå¿ƒæ–¹æ³•ç»™äº†æˆ‘ä»¬å¾ˆå¤§çš„å¯å‘â€”â€”æœ‰æ—¶å€™ä¸ç”¨DPï¼Œç”¨è´ªå¿ƒæšä¸¾ä¹Ÿèƒ½è§£å†³é—®é¢˜ã€‚ä»–çš„æ€è·¯æé†’æˆ‘ä»¬ï¼š**ä¸è¦å±€é™äºä¸€ç§ç®—æ³•ï¼Œè¦å¤šæ€è€ƒä¸åŒçš„è§£å†³æ–¹æ³•**ã€‚æ¯”å¦‚æœ¬é¢˜çš„DPæ–¹æ³•æ˜¯ç»å…¸çš„ï¼Œä½†è´ªå¿ƒæšä¸¾æ›´ç›´è§‚ï¼Œé€‚åˆç†è§£é—®é¢˜çš„æœ¬è´¨ã€‚  

å¦å¤–ï¼Œ**OIerWu_829**çš„å€’åºéå†æ‰¾ç­”æ¡ˆæŠ€å·§ä¹Ÿå¾ˆå®ç”¨â€”â€”åœ¨è®¡ç®—å®Œ`dp`æ•°ç»„åï¼Œå€’åºéå†èƒ½å‡å°‘å¾ªç¯æ¬¡æ•°ï¼Œæé«˜æ•ˆç‡ã€‚è¿™æé†’æˆ‘ä»¬ï¼š**ç»†èŠ‚å†³å®šæ•ˆç‡ï¼Œè¦æ³¨æ„ä¼˜åŒ–ä»£ç çš„æ¯ä¸€æ­¥**ã€‚  


## ç»“è¯­  
æœ¬æ¬¡å…³äºâ€œK for the Price of One (Hard Version)â€çš„C++è§£é¢˜åˆ†æå°±åˆ°è¿™é‡Œã€‚å¸Œæœ›è¿™ä»½å­¦ä¹ æŒ‡å—èƒ½å¸®åŠ©å¤§å®¶æ›´å¥½åœ°ç†è§£è´ªå¿ƒ+DPçš„ç»„åˆæ€è·¯ï¼ŒæŒæ¡è§£å†³â€œæœ€å¤šæ•°é‡â€é—®é¢˜çš„æŠ€å·§ã€‚è®°ä½ï¼Œç¼–ç¨‹èƒ½åŠ›çš„æå‡åœ¨äº**æŒç»­å­¦ä¹ ã€å‹¤äºæ€è€ƒã€å‹‡äºå®è·µ**â€”â€”ä¸‹æ¬¡é‡åˆ°ç±»ä¼¼é—®é¢˜æ—¶ï¼Œä¸å¦¨è¯•è¯•ä»Šå¤©å­¦çš„è´ªå¿ƒæ’åºå’ŒåŠ¨æ€è§„åˆ’ï¼Œç›¸ä¿¡ä½ ä¸€å®šèƒ½è§£å†³ï¼ğŸ’ª

---
å¤„ç†ç”¨æ—¶ï¼š182.03ç§’
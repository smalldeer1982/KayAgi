# é¢˜ç›®ä¿¡æ¯

# Tenzing and Balls

## é¢˜ç›®æè¿°

Enjoy erasing Tenzing, identified as Accepted!



Tenzing has $ n $ balls arranged in a line. The color of the $ i $ -th ball from the left is $ a_i $ .

Tenzing can do the following operation any number of times:

- select $ i $ and $ j $ such that $ 1\leq i < j \leq |a| $ and $ a_i=a_j $ ,
- remove $ a_i,a_{i+1},\ldots,a_j $ from the array (and decrease the indices of all elements to the right of $ a_j $ by $ j-i+1 $ ).

Tenzing wants to know the maximum number of balls he can remove.

## è¯´æ˜/æç¤º

In the first example, Tenzing will choose $ i=2 $ and $ j=3 $ in the first operation so that $ a=[1,3,3] $ . Then Tenzing will choose $ i=2 $ and $ j=3 $ again in the second operation so that $ a=[1] $ . So Tenzing can remove $ 4 $ balls in total.

In the second example, Tenzing will choose $ i=1 $ and $ j=3 $ in the first and only operation so that $ a=[2] $ . So Tenzing can remove $ 3 $ balls in total.

## æ ·ä¾‹ #1

### è¾“å…¥

```
2
5
1 2 2 3 3
4
1 2 1 2```

### è¾“å‡º

```
4
3```

# AIåˆ†æç»“æœ

# ğŸ’¡ Kayçš„C++ç®—æ³•è§£æï¼šTenzing and Balls æ·±å…¥å­¦ä¹ æŒ‡å— ğŸ’¡


## 1. é¢˜ç›®è§£è¯»ä¸æ ¸å¿ƒç®—æ³•è¯†åˆ«

âœ¨ **æœ¬é¢˜ä¸»è¦è€ƒå¯Ÿ**ï¼šåŠ¨æ€è§„åˆ’ï¼ˆDPï¼‰+ çŠ¶æ€ä¼˜åŒ–  

ğŸ—£ï¸ **åˆæ­¥åˆ†æ**ï¼š  
è§£å†³â€œTenzing and Ballsâ€çš„å…³é”®ï¼Œåœ¨äºç”¨**åŠ¨æ€è§„åˆ’**é«˜æ•ˆè®¡ç®—â€œæœ€å¤šåˆ é™¤çƒæ•°â€ã€‚ç®€å•æ¥è¯´ï¼ŒåŠ¨æ€è§„åˆ’å°±åƒâ€œæ­ç§¯æœ¨â€â€”â€”æˆ‘ä»¬ç”¨**å‰iä¸ªçƒçš„æœ€ä¼˜è§£**ï¼ˆæœ€å¤šåˆ å¤šå°‘ï¼‰ï¼Œæ¨å¯¼å‡º**å‰i+1ä¸ªçƒçš„æœ€ä¼˜è§£**ã€‚  

æœ¬é¢˜ä¸­ï¼Œæ¯æ¬¡æ“ä½œå¯ä»¥åˆ é™¤ä¸¤ä¸ªç›¸åŒé¢œè‰²çƒä¹‹é—´çš„æ‰€æœ‰çƒï¼ˆåŒ…æ‹¬è¿™ä¸¤ä¸ªï¼‰ã€‚æˆ‘ä»¬éœ€è¦æ‰¾åˆ°ä¸€ç§åˆ é™¤é¡ºåºï¼Œè®©æ€»åˆ é™¤æ•°æœ€å¤§ã€‚ç›´æ¥æš´åŠ›æšä¸¾æ‰€æœ‰å¯èƒ½çš„åˆ é™¤æ–¹å¼ï¼ˆæ¯”å¦‚è´ªå¿ƒé€‰æœ€é•¿åŒºé—´ï¼‰ä¼šè¢«â€œåä¾‹â€å¡æ‰ï¼ˆæ¯”å¦‚`6,2,6,3,2,3`ï¼Œè´ªå¿ƒä¼šåˆ ä¸­é—´4ä¸ªï¼Œè€Œæœ€ä¼˜æ˜¯å…¨åˆ ï¼‰ï¼Œå› æ­¤å¿…é¡»ç”¨DPã€‚  

### æ ¸å¿ƒç®—æ³•æµç¨‹  
å®šä¹‰`f[i]`è¡¨ç¤º**å‰iä¸ªçƒä¸­æœ€å¤šèƒ½åˆ é™¤çš„æ•°é‡**ã€‚å¯¹äºç¬¬iä¸ªçƒï¼Œæœ‰ä¸¤ç§é€‰æ‹©ï¼š  
1. **ä¸åˆ é™¤ç¬¬iä¸ªçƒ**ï¼šæ­¤æ—¶`f[i] = f[i-1]`ï¼ˆå‰i-1ä¸ªçš„æœ€ä¼˜è§£ä¸å˜ï¼‰ï¼›  
2. **åˆ é™¤ç¬¬iä¸ªçƒ**ï¼šéœ€è¦æ‰¾åˆ°ä¹‹å‰æŸä¸ªä½ç½®`j`ï¼ˆ`j < i`ä¸”`a[j] = a[i]`ï¼‰ï¼Œåˆ é™¤`[j,i]`åŒºé—´ï¼Œæ­¤æ—¶`f[i] = f[j-1] + (i-j+1)`ï¼ˆå‰j-1ä¸ªçš„æœ€ä¼˜è§£åŠ ä¸Šæœ¬æ¬¡åˆ é™¤çš„æ•°é‡ï¼‰ã€‚  

**ä¼˜åŒ–å…³é”®**ï¼šç›´æ¥æšä¸¾`j`ä¼šå¯¼è‡´`O(nÂ²)`æ—¶é—´ï¼ˆæ— æ³•é€šè¿‡å¤§æµ‹è¯•ç”¨ä¾‹ï¼‰ã€‚æˆ‘ä»¬å¯ä»¥å°†è½¬ç§»æ–¹ç¨‹ä¸­çš„`f[j-1] - j + 1`æå–å‡ºæ¥ï¼Œç”¨`mx[x]`è®°å½•**é¢œè‰²xå¯¹åº”çš„æœ€å¤§`f[j-1] - j + 1`**ã€‚è¿™æ ·ï¼Œè½¬ç§»æ–¹ç¨‹ç®€åŒ–ä¸ºï¼š  
`f[i] = max(f[i-1], mx[a[i]] + i)`ï¼ˆ`mx[a[i]]`æ˜¯é¢œè‰²`a[i]`çš„æœ€å¤§è´¡çŒ®ï¼ŒåŠ ä¸Šiå°±æ˜¯`f[j-1] + (i-j+1)`ï¼‰ã€‚  

### å¯è§†åŒ–è®¾è®¡æ€è·¯  
ä¸ºäº†ç›´è§‚å±•ç¤ºDPè¿‡ç¨‹ï¼Œæˆ‘è®¾è®¡äº†ä¸€ä¸ª**8ä½åƒç´ é£æ ¼çš„â€œçƒå †æ¸…ç†æ¸¸æˆâ€**ï¼š  
- **åœºæ™¯**ï¼šå±å¹•å·¦ä¾§æ˜¯åƒç´ åŒ–çš„çƒå †ï¼ˆæ¯ä¸ªçƒç”¨ä¸åŒé¢œè‰²çš„æ–¹å—è¡¨ç¤ºï¼Œæ¯”å¦‚çº¢è‰²=1ã€è“è‰²=2ï¼‰ï¼Œå³ä¾§æ˜¯`f`æ•°ç»„å’Œ`mx`æ•°ç»„çš„åŠ¨æ€å±•ç¤ºï¼›  
- **å…³é”®æ­¥éª¤é«˜äº®**ï¼š  
  - å¤„ç†ç¬¬iä¸ªçƒæ—¶ï¼Œè¯¥çƒä¼šé—ªçƒï¼ˆæç¤ºå½“å‰å¤„ç†å¯¹è±¡ï¼‰ï¼›  
  - æ›´æ–°`mx[a[i]]`æ—¶ï¼Œå¯¹åº”çš„é¢œè‰²æ–¹å—ä¼šâ€œè·³åŠ¨â€å¹¶ä¼´éšâ€œå®â€çš„éŸ³æ•ˆï¼ˆè¡¨ç¤ºè®°å½•äº†æ–°çš„æœ€å¤§å€¼ï¼‰ï¼›  
  - è®¡ç®—`f[i]`æ—¶ï¼Œ`f`æ•°ç»„çš„ç¬¬iä½ä¼šä»`f[i-1]`é€æ¸å˜ä¸ºæ›´å¤§çš„å€¼ï¼ˆæ¯”å¦‚ä»3è·³åˆ°5ï¼‰ï¼Œç”¨ç»¿è‰²è¡¨ç¤ºå¢é•¿ï¼›  
- **äº¤äº’**ï¼šæ”¯æŒâ€œå•æ­¥æ‰§è¡Œâ€ï¼ˆé€æ¬¡å¤„ç†æ¯ä¸ªçƒï¼‰ã€â€œè‡ªåŠ¨æ’­æ”¾â€ï¼ˆåŠ é€Ÿå±•ç¤ºæ•´ä¸ªè¿‡ç¨‹ï¼‰ï¼Œä»¥åŠâ€œé‡ç½®â€ï¼ˆé‡æ–°å¼€å§‹æ¼”ç¤ºï¼‰ã€‚  


## 2. ç²¾é€‰ä¼˜è´¨é¢˜è§£å‚è€ƒ

### é¢˜è§£ä¸€ï¼ˆä½œè€…ï¼šZhddd_ï¼Œèµï¼š22ï¼‰  
* **ç‚¹è¯„**ï¼šè¿™ä»½é¢˜è§£æ˜¯**åŠ¨æ€è§„åˆ’ä¼˜åŒ–çš„ç»å…¸æ¨¡æ¿**ï¼Œæ€è·¯æ¸…æ™°åˆ°â€œä¸€çœ¼å°±èƒ½çœ‹æ‡‚â€ï¼ä½œè€…å°†`f[i]`å®šä¹‰ä¸ºå‰iä¸ªçƒçš„æœ€å¤§åˆ é™¤æ•°ï¼Œå¹¶ç”¨`mx[x]`ç»´æŠ¤é¢œè‰²xçš„æœ€å¤§è´¡çŒ®ï¼Œå®Œç¾å°†æ—¶é—´å¤æ‚åº¦ä»`O(nÂ²)`ä¼˜åŒ–åˆ°`O(n)`ã€‚ä»£ç é£æ ¼éå¸¸è§„èŒƒï¼ˆæ¯”å¦‚`vector`çš„ä½¿ç”¨ã€å˜é‡å`f`/`mx`çš„å«ä¹‰æ˜ç¡®ï¼‰ï¼Œè¾¹ç•Œå¤„ç†ä¸¥è°¨ï¼ˆ`mx`åˆå§‹åŒ–ä¸ºè´Ÿæ— ç©·ï¼Œé¿å…æœªæ›´æ–°æ—¶çš„é”™è¯¯ï¼‰ã€‚ä»å®è·µè§’åº¦çœ‹ï¼Œè¿™ä»½ä»£ç å¯ä»¥ç›´æ¥ç”¨äºç«èµ›ï¼Œæ˜¯å­¦ä¹ DPä¼˜åŒ–çš„â€œæ ‡æ†â€ã€‚  

### é¢˜è§£äºŒï¼ˆä½œè€…ï¼š_GW_ï¼Œèµï¼š8ï¼‰  
* **ç‚¹è¯„**ï¼šæ­¤é¢˜è§£çš„æ€è·¯ä¸é¢˜è§£ä¸€é«˜åº¦ä¸€è‡´ï¼Œä½†ä»£ç æ›´ç®€æ´ï¼ˆæ¯”å¦‚ç”¨`sum`æ•°ç»„ä»£æ›¿`mx`ï¼‰ï¼Œé€‚åˆåˆå­¦è€…æ¨¡ä»¿ã€‚ä½œè€…ç‰¹åˆ«å¼ºè°ƒäº†â€œå°†`f[j-1]-j`æå‡ºâ€çš„ä¼˜åŒ–æŠ€å·§ï¼Œè¿™æ˜¯ç†è§£DPä¼˜åŒ–çš„å…³é”®ä¸€æ­¥ã€‚ä»£ç ä¸­çš„`memset`åˆå§‹åŒ–ï¼ˆ`sum`è®¾ä¸ºè´Ÿæ— ç©·ï¼‰å’Œå¤šç»„æµ‹è¯•ç”¨ä¾‹çš„å¤„ç†ï¼ˆ`while(T--)`ï¼‰ï¼Œéƒ½æ˜¯ç«èµ›ä¸­çš„å¸¸è§å®è·µï¼Œå€¼å¾—å­¦ä¹ ã€‚  

### é¢˜è§£ä¸‰ï¼ˆä½œè€…ï¼šæŸ æª¬å¸ƒä¸å–ï¼Œèµï¼š4ï¼‰  
* **ç‚¹è¯„**ï¼šæ­¤é¢˜è§£çš„äº®ç‚¹åœ¨äº**â€œåŒå€ç»éªŒâ€çš„æç¤º**ï¼ˆæåˆ°æ´›è°·P1868é¥¥é¥¿çš„å¥¶ç‰›ï¼‰ï¼Œå¸®åŠ©å­¦ä¹ è€…å°†æœ¬é¢˜çš„æ€è·¯è¿ç§»åˆ°å…¶ä»–é—®é¢˜ã€‚ä½œè€…ç”¨`b[x]`ç»´æŠ¤é¢œè‰²xçš„æœ€å¤§è´¡çŒ®ï¼Œä»£ç é£æ ¼æ´»æ³¼ï¼ˆæ¯”å¦‚â€œå¯å¯çˆ±çˆ±çš„ä»£ç â€æ³¨é‡Šï¼‰ï¼Œé€‚åˆæ¿€å‘å­¦ä¹ å…´è¶£ã€‚æ­¤å¤–ï¼Œä½œè€…å¯¹`f[i]`çš„è®¡ç®—ï¼ˆ`b[a[i]]+i+1`ï¼‰ä¸é¢˜è§£ä¸€çš„`mx[a[i]]+i`æœ¬è´¨ç›¸åŒï¼Œåªæ˜¯å˜é‡åä¸åŒï¼Œä½“ç°äº†DPä¼˜åŒ–çš„é€šç”¨æ€§ã€‚  


## 3. æ ¸å¿ƒéš¾ç‚¹è¾¨æä¸è§£é¢˜ç­–ç•¥

### 1. **éš¾ç‚¹1ï¼šå¦‚ä½•å®šä¹‰DPçŠ¶æ€ï¼Ÿ**  
* **åˆ†æ**ï¼š`f[i]`çš„å®šä¹‰æ˜¯â€œå‰iä¸ªçƒçš„æœ€å¤§åˆ é™¤æ•°â€ï¼Œè¿™æ˜¯è§£å†³æœ¬é¢˜çš„æ ¸å¿ƒã€‚ä¸ºä»€ä¹ˆä¸å®šä¹‰ä¸ºâ€œä»¥iç»“å°¾çš„æœ€å¤§åˆ é™¤æ•°â€ï¼Ÿå› ä¸ºåˆ é™¤æ“ä½œå¯ä»¥æ˜¯ä»»æ„æ¬¡ï¼Œå‰iä¸ªçƒçš„æœ€ä¼˜è§£å¯èƒ½ä¸åŒ…å«ç¬¬iä¸ªçƒï¼ˆæ­¤æ—¶`f[i] = f[i-1]`ï¼‰ï¼Œä¹Ÿå¯èƒ½åŒ…å«ï¼ˆæ­¤æ—¶éœ€è¦æ‰¾ä¹‹å‰çš„`j`ï¼‰ã€‚è¿™ç§â€œå‰ç¼€æœ€ä¼˜â€çš„çŠ¶æ€å®šä¹‰ï¼Œè¦†ç›–äº†æ‰€æœ‰å¯èƒ½çš„æƒ…å†µã€‚  
* ğŸ’¡ **å­¦ä¹ ç¬”è®°**ï¼šçŠ¶æ€å®šä¹‰è¦â€œè¦†ç›–æ‰€æœ‰å¯èƒ½â€ï¼Œå¹¶èƒ½é€šè¿‡å­é—®é¢˜æ¨å¯¼å¤§é—®é¢˜ã€‚  

### 2. **éš¾ç‚¹2ï¼šå¦‚ä½•ä¼˜åŒ–è½¬ç§»æ–¹ç¨‹ï¼Ÿ**  
* **åˆ†æ**ï¼šç›´æ¥æšä¸¾`j`ä¼šè¶…æ—¶ï¼Œå› æ­¤éœ€è¦æå–è½¬ç§»æ–¹ç¨‹ä¸­çš„â€œå…¬å…±éƒ¨åˆ†â€ã€‚æ¯”å¦‚`f[j-1] + (i-j+1) = (f[j-1] - j + 1) + i`ï¼Œå…¶ä¸­`(f[j-1] - j + 1)`æ˜¯é¢œè‰²`a[i]`çš„è´¡çŒ®ï¼Œç”¨`mx[x]`ç»´æŠ¤æœ€å¤§å€¼ï¼Œå°±èƒ½å°†è½¬ç§»ä»`O(n)`ä¼˜åŒ–åˆ°`O(1)`ã€‚  
* ğŸ’¡ **å­¦ä¹ ç¬”è®°**ï¼šä¼˜åŒ–DPçš„å…³é”®æ˜¯â€œæ‰¾åˆ°å¯ä»¥é¢„å¤„ç†çš„å…¬å…±é¡¹â€ï¼Œç”¨æ•°ç»„æˆ–å“ˆå¸Œè¡¨ç»´æŠ¤ã€‚  

### 3. **éš¾ç‚¹3ï¼šå¦‚ä½•å¤„ç†åˆå§‹åŒ–ï¼Ÿ**  
* **åˆ†æ**ï¼š`mx`æ•°ç»„çš„åˆå§‹å€¼å¿…é¡»è®¾ä¸º**è´Ÿæ— ç©·**ï¼ˆæ¯”å¦‚`-INF`ï¼‰ï¼Œå¦åˆ™æœªæ›´æ–°æ—¶ä¼šç”¨0ä»£æ›¿ï¼Œå¯¼è‡´é”™è¯¯ï¼ˆæ¯”å¦‚ç¬¬ä¸€ä¸ªçƒæ— æ³•æ‰¾åˆ°`j`ï¼Œæ­¤æ—¶`f[1] = f[0] = 0`ï¼Œè€Œ`mx[a[1]]`ä¼šè¢«æ›´æ–°ä¸º`f[0]-1+1=0`ï¼‰ã€‚  
* ğŸ’¡ **å­¦ä¹ ç¬”è®°**ï¼šåˆå§‹åŒ–è¦è€ƒè™‘â€œæœ€åæƒ…å†µâ€ï¼Œé¿å…æœªæ›´æ–°çš„å˜é‡å½±å“ç»“æœã€‚  

### âœ¨ è§£é¢˜æŠ€å·§æ€»ç»“  
- **é—®é¢˜è½¬æ¢**ï¼šå°†â€œæœ€å¤šåˆ é™¤æ•°â€è½¬æ¢ä¸ºâ€œå‰ç¼€æœ€ä¼˜è§£â€ï¼Œç”¨DPè§£å†³ï¼›  
- **çŠ¶æ€ä¼˜åŒ–**ï¼šæå–è½¬ç§»æ–¹ç¨‹ä¸­çš„å…¬å…±é¡¹ï¼Œç”¨æ•°ç»„ç»´æŠ¤æœ€å¤§å€¼ï¼›  
- **è¾¹ç•Œå¤„ç†**ï¼šåˆå§‹åŒ–æ•°ç»„ä¸ºè´Ÿæ— ç©·ï¼Œé¿å…é”™è¯¯ã€‚  


## 4. C++æ ¸å¿ƒä»£ç å®ç°èµæ

### æœ¬é¢˜é€šç”¨æ ¸å¿ƒC++å®ç°å‚è€ƒ  
* **è¯´æ˜**ï¼šæœ¬ä»£ç ç»¼åˆäº†Zhddd_å’Œ_GW_çš„æ€è·¯ï¼Œæ˜¯`O(n)`æ—¶é—´å¤æ‚åº¦çš„ç»å…¸å®ç°ã€‚  
* **å®Œæ•´æ ¸å¿ƒä»£ç **ï¼š  
  ```cpp
  #include <iostream>
  #include <vector>
  #include <climits>
  using namespace std;

  const int INF = INT_MIN; // è´Ÿæ— ç©·

  int main() {
      int T;
      cin >> T;
      while (T--) {
          int n;
          cin >> n;
          vector<int> a(n + 1);
          vector<int> f(n + 1, 0); // f[i]è¡¨ç¤ºå‰iä¸ªçƒçš„æœ€å¤§åˆ é™¤æ•°
          vector<int> mx(n + 2, INF); // mx[x]è¡¨ç¤ºé¢œè‰²xçš„æœ€å¤§è´¡çŒ®ï¼ˆf[j-1]-j+1ï¼‰

          for (int i = 1; i <= n; ++i) {
              cin >> a[i];
          }

          for (int i = 1; i <= n; ++i) {
              // è½¬ç§»ï¼šä¸åˆ é™¤ç¬¬iä¸ªçƒï¼Œæˆ–åˆ é™¤ç¬¬iä¸ªçƒï¼ˆç”¨mx[a[i]]çš„æœ€å¤§è´¡çŒ®ï¼‰
              f[i] = max(f[i - 1], (mx[a[i]] == INF) ? f[i - 1] : (mx[a[i]] + i));
              // æ›´æ–°mx[a[i]]ï¼šå½“å‰içš„è´¡çŒ®æ˜¯f[i-1] - i + 1
              mx[a[i]] = max(mx[a[i]], f[i - 1] - i + 1);
          }

          cout << f[n] << endl;
      }
      return 0;
  }
  ```
* **ä»£ç è§£è¯»æ¦‚è¦**ï¼š  
  1. è¯»å–å¤šç»„æµ‹è¯•ç”¨ä¾‹ï¼›  
  2. åˆå§‹åŒ–`a`ï¼ˆå­˜å‚¨çƒçš„é¢œè‰²ï¼‰ã€`f`ï¼ˆå‰ç¼€æœ€ä¼˜è§£ï¼‰ã€`mx`ï¼ˆé¢œè‰²è´¡çŒ®ï¼‰ï¼›  
  3. éå†æ¯ä¸ªçƒï¼Œè®¡ç®—`f[i]`ï¼ˆå–â€œä¸åˆ é™¤â€å’Œâ€œåˆ é™¤â€çš„æœ€å¤§å€¼ï¼‰ï¼›  
  4. æ›´æ–°`mx[a[i]]`ï¼ˆè®°å½•å½“å‰é¢œè‰²çš„æœ€å¤§è´¡çŒ®ï¼‰ï¼›  
  5. è¾“å‡º`f[n]`ï¼ˆå‰nä¸ªçƒçš„æœ€å¤§åˆ é™¤æ•°ï¼‰ã€‚  

### é’ˆå¯¹å„ä¼˜è´¨é¢˜è§£çš„ç‰‡æ®µèµæ  

#### é¢˜è§£ä¸€ï¼ˆä½œè€…ï¼šZhddd_ï¼‰  
* **äº®ç‚¹**ï¼š`mx`æ•°ç»„çš„ä¼˜åŒ–ï¼Œå°†`O(nÂ²)`é™ä¸º`O(n)`ã€‚  
* **æ ¸å¿ƒä»£ç ç‰‡æ®µ**ï¼š  
  ```cpp
  for (int i = 1; i <= n; i++) {
      f[i] = max(f[i - 1], i + mx[a[i]]);
      mx[a[i]] = max(mx[a[i]], f[i - 1] - i + 1);
  }
  ```
* **ä»£ç è§£è¯»**ï¼š  
  - `f[i] = max(f[i-1], i + mx[a[i]])`ï¼š`i + mx[a[i]]`ç­‰ä»·äº`f[j-1] + (i-j+1)`ï¼ˆ`mx[a[i]]`æ˜¯`f[j-1]-j+1`çš„æœ€å¤§å€¼ï¼‰ï¼›  
  - `mx[a[i]] = max(...)`ï¼šæ›´æ–°é¢œè‰²`a[i]`çš„æœ€å¤§è´¡çŒ®ï¼Œä¸ºåç»­çƒçš„è®¡ç®—åšå‡†å¤‡ã€‚  
* ğŸ’¡ **å­¦ä¹ ç¬”è®°**ï¼š`mx`æ•°ç»„æ˜¯DPä¼˜åŒ–çš„â€œå…³é”®æ­¦å™¨â€ï¼Œè®°ä½â€œæå–å…¬å…±é¡¹â€çš„æŠ€å·§ã€‚  

#### é¢˜è§£äºŒï¼ˆä½œè€…ï¼š_GW_ï¼‰  
* **äº®ç‚¹**ï¼š`sum`æ•°ç»„çš„ä½¿ç”¨ï¼Œä»£ç æ›´ç®€æ´ã€‚  
* **æ ¸å¿ƒä»£ç ç‰‡æ®µ**ï¼š  
  ```cpp
  for (int i = 1; i <= n; i++) {
      f[i] = max(f[i-1], sum[a[i]] + i);
      sum[a[i]] = max(sum[a[i]], f[i-1] - i + 1);
  }
  ```
* **ä»£ç è§£è¯»**ï¼š  
  - `sum`æ•°ç»„ä¸`mx`æ•°ç»„åŠŸèƒ½ç›¸åŒï¼Œåªæ˜¯å˜é‡åä¸åŒï¼›  
  - `sum[a[i]] + i`åŒæ ·è¡¨ç¤º`f[j-1] + (i-j+1)`ã€‚  
* ğŸ’¡ **å­¦ä¹ ç¬”è®°**ï¼šå˜é‡åå¯ä»¥ä¸åŒï¼Œä½†æ ¸å¿ƒé€»è¾‘ä¸€è‡´ï¼Œå…³é”®æ˜¯ç†è§£â€œè´¡çŒ®â€çš„æ¦‚å¿µã€‚  

#### é¢˜è§£ä¸‰ï¼ˆä½œè€…ï¼šæŸ æª¬å¸ƒä¸å–ï¼‰  
* **äº®ç‚¹**ï¼š`b`æ•°ç»„çš„ä½¿ç”¨ï¼Œæåˆ°â€œåŒå€ç»éªŒâ€ã€‚  
* **æ ¸å¿ƒä»£ç ç‰‡æ®µ**ï¼š  
  ```cpp
  for (int i = 1; i <= n; i++) {
      f[i] = max(f[i-1], b[a[i]] + i + 1);
      b[a[i]] = max(b[a[i]], f[i-1] - i);
  }
  ```
* **ä»£ç è§£è¯»**ï¼š  
  - `b[a[i]] + i + 1`ç­‰ä»·äº`f[j-1] + (i-j+1)`ï¼ˆ`b[a[i]]`æ˜¯`f[j-1]-j`çš„æœ€å¤§å€¼ï¼‰ï¼›  
  - ä½œè€…æåˆ°çš„â€œåŒå€ç»éªŒâ€ï¼ˆæ´›è°·P1868ï¼‰ï¼Œè¯´æ˜æœ¬é¢˜çš„æ€è·¯å¯ä»¥è¿ç§»åˆ°å…¶ä»–é—®é¢˜ã€‚  
* ğŸ’¡ **å­¦ä¹ ç¬”è®°**ï¼šå¤šåšç±»ä¼¼é¢˜ç›®ï¼Œèƒ½åŠ æ·±å¯¹DPä¼˜åŒ–çš„ç†è§£ã€‚  


## 5. ç®—æ³•å¯è§†åŒ–ï¼šåƒç´ åŠ¨ç”»æ¼”ç¤º (æ ¸å¿ƒéƒ¨åˆ†)

### åŠ¨ç”»æ¼”ç¤ºä¸»é¢˜  
**â€œåƒç´ çƒå †æ¸…ç†æ¸¸æˆâ€**ï¼ˆ8ä½FCé£æ ¼ï¼‰  

### è®¾è®¡æ€è·¯  
é‡‡ç”¨8ä½åƒç´ é£æ ¼ï¼Œæ¨¡æ‹Ÿâ€œæ¸…ç†çƒå †â€çš„è¿‡ç¨‹ï¼Œç”¨**é¢œè‰²**å’Œ**éŸ³æ•ˆ**çªå‡ºå…³é”®æ­¥éª¤ï¼Œè®©å­¦ä¹ è€…ç›´è§‚çœ‹åˆ°`f`æ•°ç»„å’Œ`mx`æ•°ç»„çš„å˜åŒ–ã€‚  

### åŠ¨ç”»å¸§æ­¥éª¤ä¸äº¤äº’å…³é”®ç‚¹  
1. **åœºæ™¯åˆå§‹åŒ–**ï¼š  
   - å±å¹•å·¦ä¾§æ˜¯åƒç´ åŒ–çš„çƒå †ï¼ˆæ¯ä¸ªçƒç”¨16x16çš„æ–¹å—è¡¨ç¤ºï¼Œé¢œè‰²å¯¹åº”`a[i]`ï¼Œæ¯”å¦‚çº¢è‰²=1ã€è“è‰²=2ï¼‰ï¼›  
   - å±å¹•å³ä¾§æ˜¯`f`æ•°ç»„ï¼ˆç”¨ç»¿è‰²æ–¹å—è¡¨ç¤ºï¼Œé«˜åº¦å¯¹åº”`f[i]`çš„å€¼ï¼‰å’Œ`mx`æ•°ç»„ï¼ˆç”¨é»„è‰²æ–¹å—è¡¨ç¤ºï¼Œé«˜åº¦å¯¹åº”`mx[x]`çš„å€¼ï¼‰ï¼›  
   - åº•éƒ¨æœ‰â€œå¼€å§‹/æš‚åœâ€â€œå•æ­¥â€â€œé‡ç½®â€æŒ‰é’®ï¼Œä»¥åŠé€Ÿåº¦æ»‘å—ï¼ˆæ§åˆ¶è‡ªåŠ¨æ’­æ”¾é€Ÿåº¦ï¼‰ã€‚  

2. **ç®—æ³•å¯åŠ¨**ï¼š  
   - ç‚¹å‡»â€œå¼€å§‹â€ï¼ŒåŠ¨ç”»ä»ç¬¬1ä¸ªçƒå¼€å§‹å¤„ç†ï¼›  
   - ç¬¬1ä¸ªçƒï¼ˆæ¯”å¦‚çº¢è‰²ï¼‰é—ªçƒï¼Œå³ä¾§`f[1]`ä»0å˜ä¸º0ï¼ˆå› ä¸ºæ²¡æœ‰`j`ï¼‰ï¼Œ`mx[1]`ä»è´Ÿæ— ç©·å˜ä¸º`f[0]-1+1=0`ï¼ˆé»„è‰²æ–¹å—ä¸Šå‡ï¼‰ã€‚  

3. **æ ¸å¿ƒæ­¥éª¤æ¼”ç¤º**ï¼š  
   - å¤„ç†ç¬¬iä¸ªçƒï¼ˆæ¯”å¦‚è“è‰²ï¼‰æ—¶ï¼Œè¯¥çƒé—ªçƒï¼›  
   - è®¡ç®—`f[i]`ï¼šå³ä¾§`f[i]`ä»`f[i-1]`ï¼ˆæ¯”å¦‚3ï¼‰é€æ¸å˜ä¸º`max(3, mx[2]+i)`ï¼ˆæ¯”å¦‚5ï¼‰ï¼Œç»¿è‰²æ–¹å—ä¸Šå‡ï¼Œä¼´éšâ€œå®â€çš„éŸ³æ•ˆï¼›  
   - æ›´æ–°`mx[2]`ï¼šé»„è‰²æ–¹å—ä¸Šå‡åˆ°`max(ä¹‹å‰çš„å€¼, f[i-1]-i+1)`ï¼Œä¼´éšâ€œå’šâ€çš„éŸ³æ•ˆã€‚  

4. **ç›®æ ‡è¾¾æˆ**ï¼š  
   - å½“å¤„ç†å®Œæ‰€æœ‰çƒæ—¶ï¼Œ`f[n]`ï¼ˆæ¯”å¦‚4ï¼‰çš„ç»¿è‰²æ–¹å—ä¼šâ€œè·³åŠ¨â€ï¼Œä¼´éšâ€œèƒœåˆ©â€éŸ³æ•ˆï¼ˆ8ä½é£æ ¼çš„â€œå®å®å½“â€ï¼‰ï¼›  
   - è‹¥`f[n]`ç­‰äºnï¼ˆå…¨åˆ ï¼‰ï¼Œåˆ™çƒå †ä¼šâ€œæ¶ˆå¤±â€ï¼Œå±å¹•æ˜¾ç¤ºâ€œå®Œç¾æ¸…ç†ï¼â€ã€‚  

### äº¤äº’ä¸æ¸¸æˆåŒ–å…ƒç´   
- **å•æ­¥æ‰§è¡Œ**ï¼šç‚¹å‡»â€œå•æ­¥â€ï¼Œé€æ¬¡å¤„ç†æ¯ä¸ªçƒï¼Œæ–¹ä¾¿è§‚å¯Ÿç»†èŠ‚ï¼›  
- **è‡ªåŠ¨æ’­æ”¾**ï¼šæ‹–åŠ¨é€Ÿåº¦æ»‘å—ï¼Œè°ƒæ•´æ’­æ”¾é€Ÿåº¦ï¼ˆæ¯”å¦‚1xã€2xã€4xï¼‰ï¼›  
- **ç§¯åˆ†ç³»ç»Ÿ**ï¼šæ¯å¤„ç†ä¸€ä¸ªçƒï¼Œè·å¾—10åˆ†ï¼›æ¯æ›´æ–°ä¸€æ¬¡`mx`æ•°ç»„ï¼Œè·å¾—20åˆ†ï¼›å®Œæˆæ‰€æœ‰çƒï¼Œè·å¾—100åˆ†ï¼Œæ¿€å‘å­¦ä¹ åŠ¨åŠ›ã€‚  


## 6. æ‹“å±•ç»ƒä¹ ä¸ç›¸ä¼¼é—®é¢˜æ€è€ƒ

### é€šç”¨æ€è·¯/æŠ€å·§è¿ç§»  
æœ¬é¢˜çš„`O(n)`åŠ¨æ€è§„åˆ’ä¼˜åŒ–æ€è·¯ï¼Œå¯ç”¨äº**éœ€è¦â€œå‰ç¼€æœ€ä¼˜è§£â€ä¸”è½¬ç§»æ–¹ç¨‹åŒ…å«â€œå…¬å…±é¡¹â€**çš„é—®é¢˜ï¼Œæ¯”å¦‚ï¼š  
1. **åŒºé—´é€‰æ‹©é—®é¢˜**ï¼ˆå¦‚æ´›è°·P1868é¥¥é¥¿çš„å¥¶ç‰›ï¼Œé€‰æ‹©åŒºé—´ä½¿æ€»é•¿åº¦æœ€å¤§ï¼‰ï¼›  
2. **å­—ç¬¦ä¸²å¤„ç†é—®é¢˜**ï¼ˆå¦‚æœ€é•¿é‡å¤å­ä¸²ï¼Œç”¨DPç»´æŠ¤æ¯ä¸ªå­—ç¬¦çš„æœ€å¤§è´¡çŒ®ï¼‰ï¼›  
3. **åºåˆ—é—®é¢˜**ï¼ˆå¦‚æœ€é•¿é€’å¢å­åºåˆ—çš„ä¼˜åŒ–ï¼Œç”¨æ•°ç»„ç»´æŠ¤æœ€å°æœ«å°¾å…ƒç´ ï¼‰ã€‚  

### ç»ƒä¹ æ¨è (æ´›è°·)  
1. **æ´›è°· P1868 é¥¥é¥¿çš„å¥¶ç‰›**  
   - ğŸ—£ï¸ **æ¨èç†ç”±**ï¼šæœ¬é¢˜çš„è½¬ç§»æ–¹ç¨‹ä¸â€œTenzing and Ballsâ€å®Œå…¨ä¸€è‡´ï¼Œæ˜¯â€œåŒå€ç»éªŒâ€çš„ç»å…¸ä¾‹é¢˜ï¼Œèƒ½å¿«é€Ÿå·©å›ºDPä¼˜åŒ–æŠ€å·§ã€‚  
2. **æ´›è°· P1156 åƒåœ¾é™·é˜±**  
   - ğŸ—£ï¸ **æ¨èç†ç”±**ï¼šéœ€è¦ç”¨DPç»´æŠ¤â€œåˆ°è¾¾æŸä¸ªé«˜åº¦çš„æœ€å¤§æ—¶é—´â€ï¼ŒåŒæ ·éœ€è¦æå–å…¬å…±é¡¹ä¼˜åŒ–ï¼Œæ˜¯DPä¼˜åŒ–çš„è¿›é˜¶ç»ƒä¹ ã€‚  
3. **æ´›è°· P1280 å°¼å…‹çš„ä»»åŠ¡**  
   - ğŸ—£ï¸ **æ¨èç†ç”±**ï¼šé€†å‘DPçš„ç»å…¸é—®é¢˜ï¼Œéœ€è¦ç”¨æ•°ç»„ç»´æŠ¤â€œåé¢çš„æœ€ä¼˜è§£â€ï¼Œä¸æœ¬é¢˜çš„â€œå‰ç¼€æœ€ä¼˜â€å½¢æˆå¯¹æ¯”ï¼Œæ‹“å±•æ€ç»´ã€‚  


## 7. å­¦ä¹ å¿ƒå¾—ä¸ç»éªŒåˆ†äº« (è‹¥æœ‰)  
**å‚è€ƒç»éªŒ (æ¥è‡ªæŸ æª¬å¸ƒä¸å–)**ï¼šâ€œè¿™é“é¢˜çš„è½¬ç§»æ–¹ç¨‹å’Œæ´›è°·P1868é¥¥é¥¿çš„å¥¶ç‰›æ˜¯ä¸€æ ·çš„ï¼æˆ‘ä»¬åœ¨å¥¶ç‰›é¢˜ç›®é‡Œé¢è¦åœ¨åŒºé—´ä¹‹é—´è¿›è¡Œé€‰æ‹©ï¼Œè¿™é“é¢˜ä¹Ÿæ˜¯åœ¨åŒºé—´ä¹‹é—´è¿›è¡ŒåŠ¨æ€è§„åˆ’ã€‚â€  
* **ç‚¹è¯„**ï¼šè¿™ä½ä½œè€…çš„ç»éªŒéå¸¸å®è´µï¼å®ƒæé†’æˆ‘ä»¬ï¼Œ**è§£é¢˜ä¸æ˜¯â€œåšä¸€é“é¢˜â€ï¼Œè€Œæ˜¯â€œå­¦ä¸€ç§æ€è·¯â€**ã€‚å½“é‡åˆ°æ–°é—®é¢˜æ—¶ï¼Œè¦å­¦ä¼šè”æƒ³ç±»ä¼¼çš„é¢˜ç›®ï¼Œå°†æ€è·¯è¿ç§»è¿‡å»ã€‚æ¯”å¦‚æœ¬é¢˜çš„â€œåŒºé—´åˆ é™¤â€å’Œâ€œé¥¥é¥¿çš„å¥¶ç‰›â€çš„â€œåŒºé—´é€‰æ‹©â€ï¼Œæœ¬è´¨éƒ½æ˜¯â€œå‰ç¼€æœ€ä¼˜è§£â€çš„DPé—®é¢˜ï¼Œè½¬ç§»æ–¹ç¨‹çš„ç»“æ„å®Œå…¨ä¸€è‡´ã€‚  


## ç»“è¯­  
æœ¬æ¬¡å…³äºâ€œTenzing and Ballsâ€çš„C++è§£é¢˜åˆ†æå°±åˆ°è¿™é‡Œã€‚å¸Œæœ›è¿™ä»½æŒ‡å—èƒ½å¸®åŠ©ä½ ç†è§£**åŠ¨æ€è§„åˆ’çš„ä¼˜åŒ–æŠ€å·§**ï¼ˆæå–å…¬å…±é¡¹ã€ç”¨æ•°ç»„ç»´æŠ¤æœ€å¤§å€¼ï¼‰ï¼Œå¹¶æŒæ¡â€œå‰ç¼€æœ€ä¼˜è§£â€çš„çŠ¶æ€å®šä¹‰æ–¹æ³•ã€‚è®°ä½ï¼Œç¼–ç¨‹èƒ½åŠ›çš„æå‡åœ¨äº**æŒç»­ç»ƒä¹ **å’Œ**æ€»ç»“æ€è·¯**â€”â€”å¤šåšç±»ä¼¼é¢˜ç›®ï¼Œå¤šæ€è€ƒâ€œä¸ºä»€ä¹ˆè¿™æ ·ä¼˜åŒ–â€ï¼Œä½ ä¼šè¶Šæ¥è¶Šæ“…é•¿è§£å†³DPé—®é¢˜ï¼ğŸ’ª  

ä¸‹æ¬¡æˆ‘ä»¬å†ä¸€èµ·æ¢ç´¢æ–°çš„ç¼–ç¨‹æŒ‘æˆ˜ï¼

---
å¤„ç†ç”¨æ—¶ï¼š155.89ç§’
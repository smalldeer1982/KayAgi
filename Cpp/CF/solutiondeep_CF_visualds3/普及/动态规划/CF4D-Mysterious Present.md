# é¢˜ç›®ä¿¡æ¯

# Mysterious Present

## é¢˜ç›®æè¿°

Peter decided to wish happy birthday to his friend from Australia and send him a card. To make his present more mysterious, he decided to make a chain. Chain here is such a sequence of envelopes $ A $ = { $ a_{1},a_{2},...,a_{n} $ }, where the width and the height of the $ i $ -th envelope is strictly higher than the width and the height of the $ (i-1) $ -th envelope respectively. Chain size is the number of envelopes in the chain.

Peter wants to make the chain of the maximum size from the envelopes he has, the chain should be such, that he'll be able to put a card into it. The card fits into the chain if its width and height is lower than the width and the height of the smallest envelope in the chain respectively. It's forbidden to turn the card and the envelopes.

Peter has very many envelopes and very little time, this hard task is entrusted to you.

## æ ·ä¾‹ #1

### è¾“å…¥

```
2 1 1
2 2
2 2
```

### è¾“å‡º

```
1
1 
```

## æ ·ä¾‹ #2

### è¾“å…¥

```
3 3 3
5 4
12 11
9 8
```

### è¾“å‡º

```
3
1 3 2 
```

# AIåˆ†æç»“æœ

# ğŸ’¡ Kayçš„C++ç®—æ³•è§£æï¼šMysterious Present æ·±å…¥å­¦ä¹ æŒ‡å— ğŸ’¡


## 1. é¢˜ç›®è§£è¯»ä¸æ ¸å¿ƒç®—æ³•è¯†åˆ«

âœ¨ **æœ¬é¢˜ä¸»è¦è€ƒå¯Ÿ**ï¼šäºŒç»´æœ€é•¿ä¸¥æ ¼ä¸Šå‡å­åºåˆ—ï¼ˆLISï¼‰


ğŸ—£ï¸ **åˆæ­¥åˆ†æ**ï¼š  
è§£å†³â€œMysterious Presentâ€çš„å…³é”®ï¼Œå°±åƒç»™ä¿„ç½—æ–¯å¥—å¨ƒæ‰¾æœ€é•¿çš„åµŒå¥—åºåˆ—â€”â€”æ¯ä¸ªå¥—å¨ƒï¼ˆä¿¡å°ï¼‰çš„å®½å’Œé«˜éƒ½è¦ä¸¥æ ¼å¤§äºå‰ä¸€ä¸ªï¼Œè€Œä¸”æœ€å°çš„å¥—å¨ƒè¦èƒ½è£…ä¸‹å¡ç‰‡ï¼ˆå¡ç‰‡å®½é«˜å°äºæœ€å°ä¿¡å°ï¼‰ã€‚æ ¸å¿ƒé—®é¢˜å¯ä»¥è½¬åŒ–ä¸ºï¼š**ç­›é€‰å‡ºæ¯”å¡ç‰‡å¤§çš„ä¿¡å°åï¼Œæ±‚è¿™äº›ä¿¡å°çš„æœ€é•¿ä¸¥æ ¼ä¸Šå‡å­åºåˆ—ï¼ˆæŒ‰å®½å’Œé«˜ï¼‰**ã€‚  

### æ ¸å¿ƒç®—æ³•æ€è·¯  
1. **ç­›é€‰åˆæ³•ä¿¡å°**ï¼šé¦–å…ˆæ’é™¤å®½æˆ–é«˜ä¸å¤§äºå¡ç‰‡çš„ä¿¡å°ï¼ˆè¿™äº›ä¿¡å°æ— æ³•åŠ å…¥é“¾ï¼‰ã€‚  
2. **äºŒç»´è½¬ä¸€ç»´**ï¼šå°†ä¿¡å°æŒ‰å®½**å‡åº**æ’åºï¼ˆè‹¥å®½ç›¸åŒï¼ŒæŒ‰é«˜**é™åº**æ’åºï¼‰ï¼Œè¿™æ ·å¯ä»¥ä¿è¯å®½çš„ä¸¥æ ¼é€’å¢ï¼Œåªéœ€å¤„ç†é«˜çš„ä¸¥æ ¼é€’å¢ï¼ˆå³æ±‚é«˜çš„LISï¼‰ã€‚  
3. **åŠ¨æ€è§„åˆ’ï¼ˆDPï¼‰æˆ–äºŒåˆ†ä¼˜åŒ–**ï¼š  
   - ä¼ ç»ŸDPï¼ˆO(nÂ²)ï¼‰ï¼š`dp[i]`è¡¨ç¤ºä»¥ç¬¬`i`ä¸ªä¿¡å°ç»“å°¾çš„æœ€é•¿é“¾é•¿åº¦ï¼ŒçŠ¶æ€è½¬ç§»ä¸º`dp[i] = max(dp[j]+1)`ï¼ˆ`j<i`ä¸”`h[j]<h[i]`ï¼‰ã€‚  
   - äºŒåˆ†ä¼˜åŒ–ï¼ˆO(n log n)ï¼‰ï¼šç»´æŠ¤`f[i]`è¡¨ç¤ºé•¿åº¦ä¸º`i`çš„æœ€é•¿é“¾çš„æœ€å°é«˜ï¼Œé€šè¿‡äºŒåˆ†æŸ¥æ‰¾æ›´æ–°`f`æ•°ç»„ï¼Œæå‡æ•ˆç‡ã€‚  

### å¯è§†åŒ–è®¾è®¡æ€è·¯  
æˆ‘ä»¬å¯ä»¥ç”¨**8ä½åƒç´ é£æ ¼**æ¨¡æ‹Ÿâ€œå¥—å¨ƒæ’åºä¸åµŒå¥—â€è¿‡ç¨‹ï¼š  
- **åœºæ™¯**ï¼šå±å¹•å·¦ä¾§æ˜¾ç¤ºæ’åºåçš„ä¿¡å°ï¼ˆå®½ç”¨æ¨ªå‘é•¿åº¦è¡¨ç¤ºï¼Œé«˜ç”¨çºµå‘é•¿åº¦è¡¨ç¤ºï¼‰ï¼Œå³ä¾§æ˜¾ç¤ºå½“å‰æœ€é•¿é“¾ã€‚  
- **å…³é”®æ­¥éª¤**ï¼š  
  - æ’åºæ—¶ï¼Œä¿¡å°æŒ‰å®½ä»å°åˆ°å¤§â€œç§»åŠ¨â€åˆ°å¯¹åº”ä½ç½®ï¼ˆä¼´éšâ€œæ»‘åŠ¨â€éŸ³æ•ˆï¼‰ã€‚  
  - DPè¿‡ç¨‹ä¸­ï¼Œå½“å‰å¤„ç†çš„ä¿¡å°ä¼š**é«˜äº®é—ªçƒ**ï¼Œè‹¥èƒ½åŠ å…¥é“¾ï¼Œåˆ™ç”¨**ç®­å¤´**æŒ‡å‘å®ƒçš„å‰é©±ï¼ˆä¼´éšâ€œå®â€çš„éŸ³æ•ˆï¼‰ã€‚  
  - æ‰¾åˆ°æœ€é•¿é“¾æ—¶ï¼Œé“¾ä¸­çš„ä¿¡å°ä¼š**ä¾æ¬¡é—ªçƒ**ï¼Œæ’­æ”¾â€œèƒœåˆ©â€éŸ³æ•ˆï¼ˆå¦‚FCæ¸¸æˆçš„é€šå…³éŸ³ä¹ï¼‰ã€‚  
- **äº¤äº’**ï¼šæ”¯æŒâ€œå•æ­¥æ‰§è¡Œâ€ï¼ˆé€ä¸€å°å¤„ç†ï¼‰ã€â€œè‡ªåŠ¨æ’­æ”¾â€ï¼ˆè°ƒæ•´é€Ÿåº¦ï¼‰ï¼Œä»¥åŠâ€œé‡ç½®â€ï¼ˆé‡æ–°å¼€å§‹æ¼”ç¤ºï¼‰ã€‚  


## 2. ç²¾é€‰ä¼˜è´¨é¢˜è§£å‚è€ƒ

### é¢˜è§£ä¸€ï¼šLoner_Knowledgeï¼ˆåŠ¨æ€è§„åˆ’+æ’åºï¼‰  
* **ç‚¹è¯„**ï¼š  
  è¿™ä»½é¢˜è§£çš„æ€è·¯éå¸¸**ç›´ç™½æ˜“æ‡‚**ï¼Œå®Œç¾è´´åˆâ€œäºŒç»´è½¬ä¸€ç»´â€çš„æ ¸å¿ƒé€»è¾‘ã€‚é¦–å…ˆç­›é€‰å‡ºç¬¦åˆæ¡ä»¶çš„ä¿¡å°ï¼ˆå®½é«˜å‡å¤§äºå¡ç‰‡ï¼‰ï¼Œç„¶åæŒ‰å®½å‡åºæ’åºï¼Œå°†é—®é¢˜è½¬åŒ–ä¸ºæ±‚é«˜çš„LISã€‚  
  - **æ€è·¯æ¸…æ™°**ï¼šç”¨`D`æ•°ç»„å­˜å‚¨åˆæ³•ä¿¡å°ï¼Œ`f[i]`è¡¨ç¤ºä»¥`D[i]`ç»“å°¾çš„æœ€é•¿é“¾é•¿åº¦ï¼Œ`from[i]`è®°å½•å‰é©±ï¼ˆç”¨äºè¾“å‡ºè·¯å¾„ï¼‰ã€‚  
  - **ä»£ç è§„èŒƒ**ï¼šå˜é‡åï¼ˆå¦‚`D`ã€`f`ã€`from`ï¼‰å«ä¹‰æ˜ç¡®ï¼Œ`Compare`å‡½æ•°ï¼ˆæ’åºï¼‰å’Œ`Print`å‡½æ•°ï¼ˆé€’å½’è¾“å‡ºï¼‰çš„è®¾è®¡ç®€æ´ã€‚  
  - **å®è·µä»·å€¼**ï¼šå¤„ç†äº†è¾¹ç•Œæƒ…å†µï¼ˆå¦‚æ— åˆæ³•ä¿¡å°æ—¶è¾“å‡º0ï¼‰ï¼Œä»£ç å¯ç›´æ¥ç”¨äºç«èµ›ï¼Œé€‚åˆåˆå­¦è€…ç†è§£â€œäºŒç»´LISâ€çš„åŸºç¡€é€»è¾‘ã€‚  


### é¢˜è§£äºŒï¼š_edge_ï¼ˆO(n log n)ä¼˜åŒ–ï¼‰  
* **ç‚¹è¯„**ï¼š  
  è¿™ä»½é¢˜è§£çš„**æ•ˆç‡ä¼˜åŠ¿**æ˜æ˜¾ï¼Œé’ˆå¯¹å¤§nï¼ˆå¦‚1e5ï¼‰çš„æƒ…å†µä¹Ÿèƒ½å¿«é€Ÿå¤„ç†ã€‚æ ¸å¿ƒæ˜¯ç”¨äºŒåˆ†æŸ¥æ‰¾ä¼˜åŒ–LISçš„æ±‚è§£è¿‡ç¨‹ã€‚  
  - **ç®—æ³•é«˜æ•ˆ**ï¼šæ’åºæ—¶æŒ‰å®½å‡åºã€é«˜é™åºï¼ˆé¿å…ç›¸åŒå®½çš„ä¿¡å°è¢«åŒæ—¶é€‰å…¥ï¼‰ï¼Œç»´æŠ¤`f`æ•°ç»„è¡¨ç¤ºé•¿åº¦ä¸º`i`çš„æœ€é•¿é“¾çš„æœ€å°é«˜ï¼Œé€šè¿‡äºŒåˆ†æŸ¥æ‰¾æ›´æ–°`f`æ•°ç»„ï¼Œæ—¶é—´å¤æ‚åº¦é™è‡³O(n log n)ã€‚  
  - **è·¯å¾„è®°å½•**ï¼šç”¨`f1`æ•°ç»„è®°å½•æ¯ä¸ªä¿¡å°çš„å‰é©±ï¼Œ`fid`æ•°ç»„è®°å½•é•¿åº¦ä¸º`i`çš„æœ€é•¿é“¾çš„æœ€åä¸€ä¸ªä¿¡å°ï¼Œæœ€åé€’å½’è¾“å‡ºè·¯å¾„ã€‚  
  - **æŠ€å·§äº®ç‚¹**ï¼šæ’åºæ—¶é«˜é™åºçš„å¤„ç†ï¼Œé¿å…äº†ç›¸åŒå®½çš„ä¿¡å°è¢«è¯¯é€‰ï¼Œæ˜¯äºŒç»´LISä¼˜åŒ–çš„å…³é”®æŠ€å·§ã€‚  


### é¢˜è§£ä¸‰ï¼šPloziaï¼ˆè¯¦ç»†æ³¨é‡Š+è¾¹ç•Œå¤„ç†ï¼‰  
* **ç‚¹è¯„**ï¼š  
  è¿™ä»½é¢˜è§£çš„**ç»†èŠ‚å¤„ç†**éå¸¸åˆ°ä½ï¼Œé€‚åˆå­¦ä¹ è€…ç†è§£â€œä¸ºä»€ä¹ˆè¦æ’åºâ€å’Œâ€œå¦‚ä½•é¿å…é”™è¯¯â€ã€‚  
  - **æ³¨é‡Šè¯¦ç»†**ï¼š`cmp`å‡½æ•°çš„æ³¨é‡Šæ˜ç¡®è¯´æ˜äº†â€œå®½å‡åºã€é«˜å‡åºâ€çš„åŸå› ï¼ˆé¿å…ç›¸åŒå®½çš„ä¿¡å°è¢«ç»Ÿè®¡ï¼‰ï¼Œ`print`å‡½æ•°çš„æ³¨é‡Šè§£é‡Šäº†é€’å½’è¾“å‡ºçš„é€»è¾‘ã€‚  
  - **è¾¹ç•Œå¤„ç†**ï¼šä¸¥æ ¼åˆ¤æ–­`w[j] < w[i]`å’Œ`h[j] < h[i]`ï¼Œé¿å…äº†éä¸¥æ ¼é€’å¢çš„æƒ…å†µï¼ˆå¦‚æ ·ä¾‹2ä¸­çš„ä¿¡å°é¡ºåºé—®é¢˜ï¼‰ã€‚  
  - **å¯å‘æ€§**ï¼šä½œè€…æåˆ°â€œæ’åºæ˜¯ä¸ºäº†æ§åˆ¶å®½çš„é€’å¢â€ï¼Œè¿™å¸®åŠ©å­¦ä¹ è€…ç†è§£â€œäºŒç»´è½¬ä¸€ç»´â€çš„æœ¬è´¨ã€‚  


## 3. æ ¸å¿ƒéš¾ç‚¹è¾¨æä¸è§£é¢˜ç­–ç•¥

### 1. äºŒç»´æ¡ä»¶çš„å¤„ç†ï¼šå¦‚ä½•å°†ä¸¤ä¸ªç»´åº¦çš„ä¸¥æ ¼é€’å¢è½¬åŒ–ä¸ºä¸€ç»´é—®é¢˜ï¼Ÿ  
* **åˆ†æ**ï¼š  
  äºŒç»´LISçš„å…³é”®æ˜¯**é€šè¿‡æ’åºå›ºå®šä¸€ä¸ªç»´åº¦**ã€‚ä¾‹å¦‚ï¼ŒæŒ‰å®½å‡åºæ’åºåï¼Œå®½çš„ä¸¥æ ¼é€’å¢æ¡ä»¶å·²ç»æ»¡è¶³ï¼Œåªéœ€å¤„ç†é«˜çš„ä¸¥æ ¼é€’å¢ï¼ˆå³æ±‚é«˜çš„LISï¼‰ã€‚è‹¥å®½ç›¸åŒï¼ŒæŒ‰é«˜é™åºæ’åºï¼ˆé¿å…ç›¸åŒå®½çš„ä¿¡å°è¢«åŒæ—¶é€‰å…¥ï¼‰ã€‚  
* ğŸ’¡ **å­¦ä¹ ç¬”è®°**ï¼šæ’åºæ˜¯äºŒç»´LISçš„â€œçªç ´å£â€ï¼Œå›ºå®šä¸€ä¸ªç»´åº¦å¯ä»¥å°†é—®é¢˜ç®€åŒ–ä¸ºä¸€ç»´ã€‚  


### 2. æœ€é•¿ä¸Šå‡å­åºåˆ—çš„ä¼˜åŒ–ï¼šå¦‚ä½•ä»O(nÂ²)æå‡åˆ°O(n log n)ï¼Ÿ  
* **åˆ†æ**ï¼š  
  ä¼ ç»ŸDPçš„æ—¶é—´å¤æ‚åº¦æ˜¯O(nÂ²)ï¼Œå¯¹äºn=5000æ¥è¯´å¯ä»¥æ¥å—ï¼Œä½†å¯¹äºæ›´å¤§çš„nï¼ˆå¦‚1e5ï¼‰ä¼šè¶…æ—¶ã€‚äºŒåˆ†ä¼˜åŒ–çš„æ ¸å¿ƒæ˜¯ç»´æŠ¤`f[i]`è¡¨ç¤ºé•¿åº¦ä¸º`i`çš„æœ€é•¿é“¾çš„æœ€å°é«˜ï¼Œè¿™æ ·å¯ä»¥ç”¨äºŒåˆ†æŸ¥æ‰¾å¿«é€Ÿæ‰¾åˆ°æ›´æ–°ä½ç½®ã€‚  
* ğŸ’¡ **å­¦ä¹ ç¬”è®°**ï¼š`f`æ•°ç»„çš„å«ä¹‰æ˜¯â€œé•¿åº¦ä¸ºiçš„æœ€é•¿é“¾çš„æœ€å°é«˜â€ï¼Œè¿™æ ·å¯ä»¥ä¿è¯åç»­çš„ä¿¡å°æœ‰æ›´å¤§çš„æœºä¼šåŠ å…¥é“¾ã€‚  


### 3. è·¯å¾„è®°å½•ï¼šå¦‚ä½•æ­£ç¡®è¾“å‡ºæœ€é•¿é“¾çš„ä¿¡å°ç¼–å·ï¼Ÿ  
* **åˆ†æ**ï¼š  
  éœ€è¦ç”¨**å‰é©±æ•°ç»„**ï¼ˆå¦‚`from`ã€`f1`ï¼‰è®°å½•æ¯ä¸ªä¿¡å°çš„å‰ä¸€ä¸ªä¿¡å°ã€‚ä¾‹å¦‚ï¼Œ`from[i] = j`è¡¨ç¤ºä»¥`i`ç»“å°¾çš„æœ€é•¿é“¾çš„å‰ä¸€ä¸ªä¿¡å°æ˜¯`j`ï¼Œæœ€åé€šè¿‡é€’å½’æˆ–é€†åºéå†è¾“å‡ºè·¯å¾„ã€‚  
* ğŸ’¡ **å­¦ä¹ ç¬”è®°**ï¼šå‰é©±æ•°ç»„æ˜¯è·¯å¾„è®°å½•çš„å…³é”®ï¼Œé€’å½’è¾“å‡ºæ—¶è¦æ³¨æ„é¡ºåºï¼ˆä»æœ€åä¸€ä¸ªä¿¡å°å€’æ¨åˆ°ç¬¬ä¸€ä¸ªï¼‰ã€‚  


### âœ¨ è§£é¢˜æŠ€å·§æ€»ç»“  
- **é—®é¢˜ç®€åŒ–**ï¼šé€šè¿‡æ’åºå°†äºŒç»´é—®é¢˜è½¬åŒ–ä¸ºä¸€ç»´ï¼Œé™ä½å¤æ‚åº¦ã€‚  
- **æ•ˆç‡ä¼˜åŒ–**ï¼šå¯¹äºå¤§nï¼Œä½¿ç”¨äºŒåˆ†æŸ¥æ‰¾ä¼˜åŒ–LISï¼Œæå‡é€Ÿåº¦ã€‚  
- **ç»†èŠ‚å¤„ç†**ï¼šä¸¥æ ¼åˆ¤æ–­ä¸¥æ ¼é€’å¢æ¡ä»¶ï¼ˆé¿å…éä¸¥æ ¼æƒ…å†µï¼‰ï¼Œå¤„ç†è¾¹ç•Œæƒ…å†µï¼ˆå¦‚æ— åˆæ³•ä¿¡å°ï¼‰ã€‚  


## 4. C++æ ¸å¿ƒä»£ç å®ç°èµæ

### æœ¬é¢˜é€šç”¨æ ¸å¿ƒC++å®ç°å‚è€ƒï¼ˆåŸºäºPloziaçš„é¢˜è§£ï¼‰  
* **è¯´æ˜**ï¼šæœ¬ä»£ç ç»¼åˆäº†æ’åºã€DPå’Œè·¯å¾„è®°å½•çš„æ ¸å¿ƒé€»è¾‘ï¼Œæ³¨é‡Šè¯¦ç»†ï¼Œé€‚åˆåˆå­¦è€…ç†è§£ã€‚  
* **å®Œæ•´æ ¸å¿ƒä»£ç **ï¼š  
  ```cpp
  #include <bits/stdc++.h>
  using namespace std;

  const int MAXN = 5000 + 10;
  int n, wz, hz, cnt;
  struct Node { int w, h, id; };
  Node a[MAXN];
  int f[MAXN], las[MAXN]; // f[i]è¡¨ç¤ºä»¥iç»“å°¾çš„æœ€é•¿é“¾é•¿åº¦ï¼Œlas[i]è¡¨ç¤ºå‰é©±

  bool cmp(const Node& fir, const Node& sec) {
      if (fir.w != sec.w) return fir.w < sec.w;
      return fir.h < sec.h; // å®½å‡åºï¼Œé«˜å‡åºï¼ˆé¿å…ç›¸åŒå®½çš„ä¿¡å°è¢«ç»Ÿè®¡ï¼‰
  }

  void print(int k) {
      if (k == -1) return;
      print(las[k]);
      printf("%d ", a[k].id); // é€’å½’è¾“å‡ºè·¯å¾„ï¼ˆä»å‰å¾€åï¼‰
  }

  int main() {
      scanf("%d%d%d", &n, &wz, &hz);
      for (int i = 1; i <= n; ++i) {
          int w = 0, h = 0;
          scanf("%d%d", &w, &h);
          if (w <= wz || h <= hz) continue; // ç­›é€‰åˆæ³•ä¿¡å°
          a[++cnt].w = w;
          a[cnt].h = h;
          a[cnt].id = i;
      }
      if (cnt == 0) { printf("0\n"); return 0; } // ç‰¹åˆ¤æ— åˆæ³•ä¿¡å°
      sort(a + 1, a + cnt + 1, cmp); // æ’åº
      for (int i = 1; i <= cnt; ++i) {
          f[i] = 1;
          las[i] = -1;
          for (int j = 1; j < i; ++j) {
              if (a[j].w < a[i].w && a[j].h < a[i].h && f[j] + 1 > f[i]) {
                  f[i] = f[j] + 1;
                  las[i] = j; // æ›´æ–°å‰é©±
              }
          }
      }
      int ans = 0, flag = 0;
      for (int i = 1; i <= cnt; ++i) {
          if (f[i] > ans) {
              ans = f[i];
              flag = i; // æ‰¾åˆ°æœ€é•¿é“¾çš„æœ€åä¸€ä¸ªä¿¡å°
          }
      }
      printf("%d\n", ans);
      print(flag); // è¾“å‡ºè·¯å¾„
      return 0;
  }
  ```  
* **ä»£ç è§£è¯»æ¦‚è¦**ï¼š  
  1. **ç­›é€‰åˆæ³•ä¿¡å°**ï¼šæ’é™¤å®½æˆ–é«˜ä¸å¤§äºå¡ç‰‡çš„ä¿¡å°ã€‚  
  2. **æ’åº**ï¼šæŒ‰å®½å‡åºã€é«˜å‡åºæ’åºï¼Œå›ºå®šå®½çš„é€’å¢æ¡ä»¶ã€‚  
  3. **DPæ±‚è§£LIS**ï¼š`f[i]`è¡¨ç¤ºä»¥`i`ç»“å°¾çš„æœ€é•¿é“¾é•¿åº¦ï¼Œ`las[i]`è®°å½•å‰é©±ã€‚  
  4. **è¾“å‡ºè·¯å¾„**ï¼šé€’å½’éå†`las`æ•°ç»„ï¼Œä»æœ€åä¸€ä¸ªä¿¡å°å€’æ¨åˆ°ç¬¬ä¸€ä¸ªã€‚  


### é’ˆå¯¹å„ä¼˜è´¨é¢˜è§£çš„ç‰‡æ®µèµæ  

#### é¢˜è§£ä¸€ï¼ˆLoner_Knowledgeï¼‰ï¼šæ’åºä¸DPå¾ªç¯  
* **äº®ç‚¹**ï¼šç”¨`D`æ•°ç»„å­˜å‚¨åˆæ³•ä¿¡å°ï¼Œ`from`æ•°ç»„è®°å½•å‰é©±ï¼Œé€»è¾‘æ¸…æ™°ã€‚  
* **æ ¸å¿ƒä»£ç ç‰‡æ®µ**ï¼š  
  ```cpp
  sort(D, D + head, Compare); // æŒ‰å®½å‡åºæ’åº
  for (int i = 0; i < head; ++i) {
      f[i] = 1;
      from[i] = -1;
  }
  for (int i = 1; i < head; ++i) {
      for (int j = 0; j < i; ++j) {
          if (D[j].w < D[i].w && D[j].h < D[i].h && f[j] + 1 > f[i]) {
              f[i] = f[j] + 1;
              from[i] = j; // æ›´æ–°å‰é©±
          }
      }
      if (ans < f[i]) {
          ans = f[i];
          p = i; // è®°å½•æœ€é•¿é“¾çš„æœ€åä¸€ä¸ªä¿¡å°
      }
  }
  ```  
* **ä»£ç è§£è¯»**ï¼š  
  - æ’åºåï¼Œ`D`æ•°ç»„çš„å®½æ˜¯é€’å¢çš„ï¼Œåªéœ€å¤„ç†é«˜çš„é€’å¢ã€‚  
  - åŒé‡å¾ªç¯éå†æ‰€æœ‰ä¿¡å°ï¼Œæ›´æ–°`f`æ•°ç»„å’Œ`from`æ•°ç»„ã€‚  
  - æ‰¾åˆ°æœ€é•¿é“¾çš„æœ€åä¸€ä¸ªä¿¡å°`p`ï¼Œé€šè¿‡`from`æ•°ç»„é€’å½’è¾“å‡ºè·¯å¾„ã€‚  
* ğŸ’¡ **å­¦ä¹ ç¬”è®°**ï¼š`from`æ•°ç»„æ˜¯è·¯å¾„è®°å½•çš„å…³é”®ï¼Œé€’å½’è¾“å‡ºæ—¶è¦æ³¨æ„é¡ºåºï¼ˆä»`p`å€’æ¨åˆ°`-1`ï¼‰ã€‚  


#### é¢˜è§£äºŒï¼ˆ_edge_ï¼‰ï¼šäºŒåˆ†ä¼˜åŒ–ä¸`f`æ•°ç»„ç»´æŠ¤  
* **äº®ç‚¹**ï¼šç”¨äºŒåˆ†æŸ¥æ‰¾ä¼˜åŒ–LISï¼Œæ—¶é—´å¤æ‚åº¦é™è‡³O(n log n)ã€‚  
* **æ ¸å¿ƒä»£ç ç‰‡æ®µ**ï¼š  
  ```cpp
  sort(a + 1, a + 1 + tot, cmp); // æŒ‰å®½å‡åºã€é«˜é™åºæ’åº
  f[++len] = a[1].y;
  f1[1] = -1;
  fid[len] = 1;
  for (int i = 2; i <= tot; ++i) {
      if (f[len] < a[i].y) {
          f[++len] = a[i].y;
          f1[i] = fid[len - 1];
          fid[len] = i;
      } else {
          int it = lower_bound(f + 1, f + len + 1, a[i].y) - f;
          f[it] = a[i].y;
          f1[i] = fid[it - 1];
          fid[it] = i;
      }
  }
  ```  
* **ä»£ç è§£è¯»**ï¼š  
  - æ’åºæ—¶æŒ‰å®½å‡åºã€é«˜é™åºï¼Œé¿å…ç›¸åŒå®½çš„ä¿¡å°è¢«åŒæ—¶é€‰å…¥ã€‚  
  - `f`æ•°ç»„ç»´æŠ¤é•¿åº¦ä¸º`i`çš„æœ€é•¿é“¾çš„æœ€å°é«˜ï¼Œ`f1`æ•°ç»„è®°å½•å‰é©±ï¼Œ`fid`æ•°ç»„è®°å½•é•¿åº¦ä¸º`i`çš„æœ€é•¿é“¾çš„æœ€åä¸€ä¸ªä¿¡å°ã€‚  
  - å¯¹äºæ¯ä¸ªä¿¡å°ï¼Œç”¨`lower_bound`æ‰¾åˆ°æ›´æ–°ä½ç½®ï¼Œæ›´æ–°`f`ã€`f1`å’Œ`fid`æ•°ç»„ã€‚  
* ğŸ’¡ **å­¦ä¹ ç¬”è®°**ï¼š`lower_bound`ç”¨äºæ‰¾åˆ°ç¬¬ä¸€ä¸ªå¤§äºç­‰äº`a[i].y`çš„ä½ç½®ï¼Œè¿™æ ·å¯ä»¥ä¿è¯`f`æ•°ç»„çš„å•è°ƒæ€§ã€‚  


#### é¢˜è§£ä¸‰ï¼ˆPloziaï¼‰ï¼šä¸¥æ ¼æ¡ä»¶åˆ¤æ–­  
* **äº®ç‚¹**ï¼šä¸¥æ ¼åˆ¤æ–­`w[j] < w[i]`å’Œ`h[j] < h[i]`ï¼Œé¿å…éä¸¥æ ¼é€’å¢çš„æƒ…å†µã€‚  
* **æ ¸å¿ƒä»£ç ç‰‡æ®µ**ï¼š  
  ```cpp
  for (int i = 1; i <= cnt; ++i) {
      f[i] = 1;
      las[i] = -1;
      for (int j = 1; j < i; ++j) {
          if (a[j].w < a[i].w && a[j].h < a[i].h && f[j] + 1 > f[i]) {
              f[i] = f[j] + 1;
              las[i] = j;
          }
      }
  }
  ```  
* **ä»£ç è§£è¯»**ï¼š  
  - åŒé‡å¾ªç¯éå†æ‰€æœ‰ä¿¡å°ï¼Œåˆ¤æ–­`j`çš„å®½å’Œé«˜æ˜¯å¦éƒ½ä¸¥æ ¼å°äº`i`çš„å®½å’Œé«˜ã€‚  
  - è‹¥æ»¡è¶³æ¡ä»¶ï¼Œåˆ™æ›´æ–°`f[i]`å’Œ`las[i]`ã€‚  
* ğŸ’¡ **å­¦ä¹ ç¬”è®°**ï¼šä¸¥æ ¼æ¡ä»¶åˆ¤æ–­æ˜¯äºŒç»´LISçš„å…³é”®ï¼Œå¦åˆ™ä¼šç»Ÿè®¡éä¸¥æ ¼é€’å¢çš„æƒ…å†µï¼ˆå¦‚æ ·ä¾‹2ä¸­çš„ä¿¡å°é¡ºåºé—®é¢˜ï¼‰ã€‚  


## 5. ç®—æ³•å¯è§†åŒ–ï¼šåƒç´ åŠ¨ç”»æ¼”ç¤ºï¼ˆæ ¸å¿ƒéƒ¨åˆ†ï¼‰

### åŠ¨ç”»æ¼”ç¤ºä¸»é¢˜  
**â€œåƒç´ å¥—å¨ƒå¤§å†’é™©â€**ï¼šæ¨¡æ‹Ÿä¿¡å°æ’åºä¸åµŒå¥—è¿‡ç¨‹ï¼Œç”¨8ä½åƒç´ é£æ ¼å±•ç¤ºæœ€é•¿é“¾çš„å½¢æˆã€‚  


### æ ¸å¿ƒæ¼”ç¤ºå†…å®¹  
1. **åœºæ™¯åˆå§‹åŒ–**ï¼š  
   - å±å¹•å·¦ä¾§æ˜¾ç¤º**æœªæ’åºçš„ä¿¡å°**ï¼ˆç”¨ä¸åŒå¤§å°çš„åƒç´ å—è¡¨ç¤ºï¼Œå®½ä¸ºæ¨ªå‘é•¿åº¦ï¼Œé«˜ä¸ºçºµå‘é•¿åº¦ï¼‰ï¼Œå³ä¾§æ˜¾ç¤º**æ§åˆ¶é¢æ¿**ï¼ˆåŒ…å«â€œå¼€å§‹/æš‚åœâ€ã€â€œå•æ­¥â€ã€â€œé‡ç½®â€æŒ‰é’®å’Œé€Ÿåº¦æ»‘å—ï¼‰ã€‚  
   - å¡ç‰‡ç”¨**çº¢è‰²åƒç´ å—**è¡¨ç¤ºï¼Œä½äºå±å¹•é¡¶éƒ¨ï¼ˆæ˜¾ç¤ºå…¶å®½å’Œé«˜ï¼‰ã€‚  

2. **ç­›é€‰åˆæ³•ä¿¡å°**ï¼š  
   - æœªæ’åºçš„ä¿¡å°ä¸­ï¼Œå®½æˆ–é«˜ä¸å¤§äºå¡ç‰‡çš„ä¿¡å°ä¼š**å˜æˆç°è‰²**ï¼ˆè¡¨ç¤ºè¢«æ’é™¤ï¼‰ï¼Œå…¶ä½™ä¿¡å°ä¿æŒ**å½©è‰²**ï¼ˆè¡¨ç¤ºåˆæ³•ï¼‰ã€‚  

3. **æ’åºè¿‡ç¨‹**ï¼š  
   - åˆæ³•ä¿¡å°æŒ‰å®½å‡åºâ€œæ»‘åŠ¨â€åˆ°å±å¹•å·¦ä¾§çš„**æ’åºåŒºåŸŸ**ï¼ˆä¼´éšâ€œæ»‘åŠ¨â€éŸ³æ•ˆï¼Œå¦‚FCæ¸¸æˆçš„ç§»åŠ¨å£°ï¼‰ã€‚è‹¥å®½ç›¸åŒï¼ŒæŒ‰é«˜é™åºæ’åˆ—ã€‚  

4. **DPæ±‚è§£LIS**ï¼š  
   - æ’åºåçš„ä¿¡å°ä¾æ¬¡**é«˜äº®é—ªçƒ**ï¼ˆè¡¨ç¤ºå½“å‰å¤„ç†çš„ä¿¡å°ï¼‰ã€‚  
   - å¯¹äºæ¯ä¸ªä¿¡å°ï¼Œéå†ä¹‹å‰çš„ä¿¡å°ï¼Œè‹¥æ»¡è¶³é«˜ä¸¥æ ¼é€’å¢çš„æ¡ä»¶ï¼Œåˆ™ç”¨**è“è‰²ç®­å¤´**æŒ‡å‘å®ƒçš„å‰é©±ï¼ˆä¼´éšâ€œå®â€çš„éŸ³æ•ˆï¼‰ã€‚  
   - ç»´æŠ¤ä¸€ä¸ª**æœ€é•¿é“¾æ˜¾ç¤ºåŒº**ï¼Œå®æ—¶æ›´æ–°å½“å‰æœ€é•¿é“¾çš„é•¿åº¦å’Œä¿¡å°ç¼–å·ã€‚  

5. **ç»“æœå±•ç¤º**ï¼š  
   - æ‰¾åˆ°æœ€é•¿é“¾åï¼Œé“¾ä¸­çš„ä¿¡å°ä¼š**ä¾æ¬¡é—ªçƒ**ï¼ˆä»ç¬¬ä¸€ä¸ªåˆ°æœ€åä¸€ä¸ªï¼‰ï¼Œæ’­æ”¾**èƒœåˆ©éŸ³æ•ˆ**ï¼ˆå¦‚FCæ¸¸æˆçš„é€šå…³éŸ³ä¹ï¼‰ã€‚  
   - æœ€é•¿é“¾çš„ä¿¡å°ç¼–å·ä¼š**æ»šåŠ¨æ˜¾ç¤º**åœ¨å±å¹•åº•éƒ¨ï¼ˆç”¨åƒç´ å­—ä½“ï¼‰ã€‚  


### äº¤äº’ä¸æ§åˆ¶  
- **å•æ­¥æ‰§è¡Œ**ï¼šç‚¹å‡»â€œå•æ­¥â€æŒ‰é’®ï¼Œé€ä¸€å°å¤„ç†ä¿¡å°ï¼Œè§‚å¯Ÿæ¯ä¸€æ­¥çš„å˜åŒ–ã€‚  
- **è‡ªåŠ¨æ’­æ”¾**ï¼šç‚¹å‡»â€œå¼€å§‹â€æŒ‰é’®ï¼ŒåŠ¨ç”»è‡ªåŠ¨æ’­æ”¾ï¼Œé€Ÿåº¦å¯é€šè¿‡æ»‘å—è°ƒæ•´ï¼ˆä»â€œæ…¢â€åˆ°â€œå¿«â€ï¼‰ã€‚  
- **é‡ç½®**ï¼šç‚¹å‡»â€œé‡ç½®â€æŒ‰é’®ï¼Œå›åˆ°åˆå§‹çŠ¶æ€ï¼Œé‡æ–°å¼€å§‹æ¼”ç¤ºã€‚  


### è®¾è®¡æ€è·¯  
- **åƒç´ é£æ ¼**ï¼šæ¨¡æ‹ŸFCæ¸¸æˆçš„ç”»é¢ï¼Œè¥é€ å¤å¤ã€è½»æ¾çš„å­¦ä¹ æ°›å›´ï¼Œç¬¦åˆé’å°‘å¹´çš„å®¡ç¾ã€‚  
- **éŸ³æ•ˆåé¦ˆ**ï¼šå…³é”®æ“ä½œï¼ˆå¦‚æ’åºã€é€‰æ‹©ä¿¡å°ï¼‰ä¼´éšéŸ³æ•ˆï¼Œå¼ºåŒ–è®°å¿†ï¼Œæå‡å‚ä¸æ„Ÿã€‚  
- **å¯è§†åŒ–é€»è¾‘**ï¼šç”¨é¢œè‰²ï¼ˆç°è‰²è¡¨ç¤ºæ’é™¤ï¼Œå½©è‰²è¡¨ç¤ºåˆæ³•ï¼‰ã€ç®­å¤´ï¼ˆè¡¨ç¤ºå‰é©±ï¼‰å’Œé—ªçƒï¼ˆè¡¨ç¤ºå½“å‰å¤„ç†ï¼‰æ¸…æ™°å±•ç¤ºç®—æ³•æµç¨‹ï¼Œå¸®åŠ©å­¦ä¹ è€…â€œçœ‹â€åˆ°ç®—æ³•çš„æ¯ä¸€æ­¥ã€‚  


## 6. æ‹“å±•ç»ƒä¹ ä¸ç›¸ä¼¼é—®é¢˜æ€è€ƒ

### é€šç”¨æ€è·¯/æŠ€å·§è¿ç§»  
äºŒç»´LISçš„æ€è·¯å¯ä»¥è¿ç§»åˆ°ä»¥ä¸‹åœºæ™¯ï¼š  
- **ä¿„ç½—æ–¯å¥—å¨ƒé—®é¢˜**ï¼ˆLeetCode 354ï¼‰ï¼šæ±‚æœ€å¤šèƒ½åµŒå¥—çš„å¥—å¨ƒæ•°é‡ã€‚  
- **äºŒç»´é€’å¢å­åºåˆ—**ï¼ˆæ´›è°· P3902ï¼‰ï¼šæ±‚äºŒç»´æ•°ç»„ä¸­çš„æœ€é•¿é€’å¢å­åºåˆ—ã€‚  
- **é¡¹ç›®å®‰æ’é—®é¢˜**ï¼ˆå¦‚æŒ‰æ—¶é—´å’Œæ”¶ç›Šæ’åºï¼Œæ±‚æœ€å¤§æ”¶ç›Šçš„é¡¹ç›®åºåˆ—ï¼‰ï¼šæŒ‰æ—¶é—´æ’åºåï¼Œæ±‚æ”¶ç›Šçš„LISã€‚  


### ç»ƒä¹ æ¨èï¼ˆæ´›è°·ï¼‰  
1. **æ´›è°· P1020 å¯¼å¼¹æ‹¦æˆª**  
   - ğŸ—£ï¸ **æ¨èç†ç”±**ï¼šè™½ç„¶æ˜¯ä¸€ç»´LISï¼Œä½†å¯ä»¥æ‹“å±•åˆ°äºŒç»´ï¼ˆå¦‚æ‹¦æˆªå¯¼å¼¹çš„é«˜åº¦å’Œé€Ÿåº¦ï¼‰ï¼Œç»ƒä¹ æ’åºå’ŒDPçš„åº”ç”¨ã€‚  

2. **æ´›è°· P3902 é€’å¢**  
   - ğŸ—£ï¸ **æ¨èç†ç”±**ï¼šç›´æ¥è€ƒå¯ŸäºŒç»´LISï¼Œè¦æ±‚è¾“å‡ºæœ€é•¿é€’å¢å­åºåˆ—çš„é•¿åº¦ï¼Œæ˜¯æœ¬é¢˜çš„ç›´æ¥æ‹“å±•ã€‚  

3. **æ´›è°· P1638 é€›ç”»å±•**  
   - ğŸ—£ï¸ **æ¨èç†ç”±**ï¼šç»ƒä¹ è·¯å¾„è®°å½•ï¼ˆå¦‚è®°å½•é€›ç”»å±•çš„é¡ºåºï¼‰ï¼Œè™½ç„¶ä¸æ˜¯LISï¼Œä½†æ€è·¯ç±»ä¼¼ï¼ˆç»´æŠ¤å‰é©±æ•°ç»„ï¼‰ã€‚  

4. **æ´›è°· P2501 [HAOI2006]æ•°å­—åºåˆ—**  
   - ğŸ—£ï¸ **æ¨èç†ç”±**ï¼šLISçš„å˜å½¢é—®é¢˜ï¼Œè¦æ±‚å°†æ•°å­—åºåˆ—è½¬åŒ–ä¸ºä¸¥æ ¼é€’å¢åºåˆ—ï¼Œéœ€è¦ç”¨åˆ°LISçš„ä¼˜åŒ–æ–¹æ³•ã€‚  


## 7. å­¦ä¹ å¿ƒå¾—ä¸ç»éªŒåˆ†äº«ï¼ˆè‹¥æœ‰ï¼‰

### å‚è€ƒç»éªŒï¼ˆæ¥è‡ªPloziaçš„é¢˜è§£ï¼‰  
> â€œæˆ‘ä¸æ˜¯å·²ç»æŒ‰ç…§wæ’åºäº†å—ï¼Ÿä¸ºä»€ä¹ˆè¿™æ ·è¿˜æ˜¯é”™çš„ï¼Ÿç†ç”±å¾ˆç®€å•ï¼šå¦‚æœw_i = w_{i+1}, h_i < h_{i+1}ï¼Œé‚£ä¹ˆæ­¤æ—¶i,i+1ä¸ç¬¦åˆé¢˜ç›®è¦æ±‚ï¼Œä½†æ˜¯æ ¹æ®ä¸Šé¢çš„è½¬ç§»æ–¹ç¨‹æˆ‘ä»¬ä¼šç»Ÿè®¡ã€‚â€  

**ç‚¹è¯„**ï¼š  
è¿™ä½ä½œè€…çš„ç»éªŒå¾ˆå…¸å‹ï¼Œæé†’æˆ‘ä»¬åœ¨å¤„ç†äºŒç»´LISæ—¶ï¼Œ**æ’åºåçš„æ¡ä»¶åˆ¤æ–­ä¸èƒ½çœç•¥**ã€‚å³ä½¿æŒ‰å®½æ’åºï¼Œä¹Ÿéœ€è¦ä¸¥æ ¼åˆ¤æ–­å®½å’Œé«˜çš„ä¸¥æ ¼é€’å¢ï¼Œå¦åˆ™ä¼šç»Ÿè®¡éä¸¥æ ¼çš„æƒ…å†µï¼ˆå¦‚ç›¸åŒå®½çš„ä¿¡å°ï¼‰ã€‚è¿™å‘Šè¯‰æˆ‘ä»¬ï¼Œåœ¨ç¼–ç¨‹æ—¶è¦ä»”ç»†è€ƒè™‘æ‰€æœ‰è¾¹ç•Œæƒ…å†µï¼Œä¸èƒ½ä¾èµ–æ’åºçš„â€œéšå«æ¡ä»¶â€ã€‚  


## ç»“è¯­  
æœ¬æ¬¡å…³äºâ€œMysterious Presentâ€çš„C++è§£é¢˜åˆ†æå°±åˆ°è¿™é‡Œã€‚å¸Œæœ›è¿™ä»½å­¦ä¹ æŒ‡å—èƒ½å¸®åŠ©å¤§å®¶ç†è§£äºŒç»´LISçš„æ ¸å¿ƒé€»è¾‘ï¼ŒæŒæ¡æ’åºã€DPå’Œè·¯å¾„è®°å½•çš„æŠ€å·§ã€‚è®°ä½ï¼Œç¼–ç¨‹èƒ½åŠ›çš„æå‡åœ¨äº**æŒç»­ç»ƒä¹ **å’Œ**æ·±å…¥æ€è€ƒ**â€”â€”ä¸‹æ¬¡é‡åˆ°ç±»ä¼¼é—®é¢˜æ—¶ï¼Œä¸å¦¨è¯•è¯•ä»Šå¤©å­¦åˆ°çš„æ€è·¯ï¼ğŸ’ª  

å¦‚æœæœ‰ä»»ä½•ç–‘é—®ï¼Œæ¬¢è¿éšæ—¶å’ŒKayäº¤æµ~ ğŸ˜Š

---
å¤„ç†ç”¨æ—¶ï¼š202.13ç§’
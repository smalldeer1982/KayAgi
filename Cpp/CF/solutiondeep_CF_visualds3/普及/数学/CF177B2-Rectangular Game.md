# é¢˜ç›®ä¿¡æ¯

# Rectangular Game

## é¢˜ç›®æè¿°

The Smart Beaver from ABBYY decided to have a day off. But doing nothing the whole day turned out to be too boring, and he decided to play a game with pebbles. Initially, the Beaver has $ n $ pebbles. He arranges them in $ a $ equal rows, each row has $ b $ pebbles ( $ a>1 $ ). Note that the Beaver must use all the pebbles he has, i. e. $ n=aÂ·b $ .

 ![](https://cdn.luogu.com.cn/upload/vjudge_pic/CF177B2/72b3400d0a6aa691e5c49fe273a750815ff16b58.png) 10 pebbles are arranged in two rows, each row has 5 pebbles Once the Smart Beaver has arranged the pebbles, he takes back any of the resulting rows (that is, $ b $ pebbles) and discards all other pebbles. Then he arranges all his pebbles again (possibly choosing other values of $ a $ and $ b $ ) and takes back one row, and so on. The game continues until at some point the Beaver ends up with exactly one pebble.

The game process can be represented as a finite sequence of integers $ c_{1},...,c_{k} $ , where:

- $ c_{1}=n $
- $ c_{i+1} $ is the number of pebbles that the Beaver ends up with after the $ i $ -th move, that is, the number of pebbles in a row after some arrangement of $ c_{i} $ pebbles ( $ 1<=i<k $ ). Note that $ c_{i}>c_{i+1} $ .
- $ c_{k}=1 $

The result of the game is the sum of numbers $ c_{i} $ . You are given $ n $ . Find the maximum possible result of the game.

## è¯´æ˜/æç¤º

Consider the first example ( $ c_{1}=10 $ ). The possible options for the game development are:

- Arrange the pebbles in 10 rows, one pebble per row. Then $ c_{2}=1 $ , and the game ends after the first move with the result of 11.
- Arrange the pebbles in 5 rows, two pebbles per row. Then $ c_{2}=2 $ , and the game continues. During the second move we have two pebbles which can be arranged in a unique way (remember that you are not allowed to put all the pebbles in the same row!) â€” 2 rows, one pebble per row. $ c_{3}=1 $ , and the game ends with the result of 13.
- Finally, arrange the pebbles in two rows, five pebbles per row. The same logic leads us to $ c_{2}=5,c_{3}=1 $ , and the game ends with the result of 16 â€” the maximum possible result.

## æ ·ä¾‹ #1

### è¾“å…¥

```
10
```

### è¾“å‡º

```
16
```

## æ ·ä¾‹ #2

### è¾“å…¥

```
8
```

### è¾“å‡º

```
15
```

# AIåˆ†æç»“æœ


### ğŸ’¡ Kayçš„C++ç®—æ³•è§£æï¼šRectangular Game æ·±å…¥å­¦ä¹ æŒ‡å— ğŸ’¡

#### 1. é¢˜ç›®è§£è¯»ä¸æ ¸å¿ƒç®—æ³•è¯†åˆ«  
âœ¨ **æœ¬é¢˜ä¸»è¦è€ƒå¯Ÿ**ï¼š`è´ªå¿ƒç®—æ³•`  
ğŸ—£ï¸ **åˆæ­¥åˆ†æ**ï¼š  
> è§£å†³çŸ©å½¢æ¸¸æˆçš„å…³é”®åœ¨äº**è´ªå¿ƒç­–ç•¥**ã€‚æƒ³è±¡ä½ åœ¨ç©ç§¯æœ¨æ¸¸æˆï¼Œæ¯æ¬¡éƒ½è¦ç•™ä¸‹æœ€å¤šçš„ç§¯æœ¨ç»§ç»­æ­å»ºã€‚è´ªå¿ƒç®—æ³•å°±æ˜¯æ¯æ¬¡éƒ½é€‰æ‹©å½“å‰æœ€ä¼˜è§£ï¼ˆç•™ä¸‹æœ€å¤šçŸ³å­ï¼‰ï¼Œä»è€Œå¾—åˆ°å…¨å±€æœ€ä¼˜è§£ã€‚  
åœ¨æœ¬é¢˜ä¸­ï¼Œè´ªå¿ƒç­–ç•¥ä½“ç°ä¸ºï¼šæ¯æ¬¡å°†çŸ³å­æ’åˆ—æ—¶ï¼Œé€‰æ‹©**è¡Œæ•°æœ€å°‘**çš„æ–¹å¼ï¼ˆå³å–nçš„æœ€å°è´¨å› æ•°ä½œä¸ºè¡Œæ•°ï¼‰ï¼Œä½¿æ¯è¡ŒçŸ³å­æ•°æœ€å¤§åŒ–ï¼Œä»è€Œæœ€å¤§åŒ–å½“å‰ç•™ä¸‹çš„çŸ³å­æ•°ã€‚  
- æ ¸å¿ƒéš¾ç‚¹ï¼šå¦‚ä½•é«˜æ•ˆæ‰¾åˆ°æœ€å°è´¨å› æ•°ï¼Ÿå¦‚ä½•ç¡®ä¿è´ªå¿ƒç­–ç•¥çš„æ­£ç¡®æ€§ï¼Ÿï¼ˆè¯æ˜è§é¢˜è§£ï¼‰  
- å¯è§†åŒ–è®¾è®¡æ€è·¯ï¼šç”¨åƒç´ ç½‘æ ¼åŠ¨æ€å±•ç¤ºçŸ³å­æ’åˆ—è¿‡ç¨‹ï¼Œé«˜äº®æœ€å°è´¨å› æ•°çš„é€‰æ‹©è¿‡ç¨‹ï¼Œç”¨éŸ³æ•ˆæ ‡è®°çŸ³å­å‡å°‘çš„å…³é”®æ­¥éª¤ã€‚  
- å¤å¤æ¸¸æˆåŒ–è®¾è®¡ï¼šé‡‡ç”¨8ä½åƒç´ é£æ ¼ï¼ŒçŸ³å­ç”¨å½©è‰²æ–¹å—è¡¨ç¤ºï¼Œæ¯æ¬¡æ“ä½œè§¦å‘â€œæ¶ˆé™¤è¡Œâ€åŠ¨ç”»å’Œæ¸…è„†éŸ³æ•ˆï¼Œè‡ªåŠ¨æ¼”ç¤ºæ¨¡å¼åƒç©ä¿„ç½—æ–¯æ–¹å—èˆ¬å±•ç¤ºè´ªå¿ƒè¿‡ç¨‹ã€‚

---

#### 2. ç²¾é€‰ä¼˜è´¨é¢˜è§£å‚è€ƒ  
**é¢˜è§£ä¸€ï¼ˆzhangyuanxiaoï¼‰**  
* **ç‚¹è¯„**ï¼š  
  æ€è·¯æ¸…æ™°åº¦æé«˜ï¼Œç”¨æ•°å­¦å½’çº³æ³•ä¸¥æ ¼è¯æ˜äº†è´ªå¿ƒç­–ç•¥çš„æ­£ç¡®æ€§ï¼ˆè§é¢˜è§£å…¬å¼æ¨å¯¼ï¼‰ã€‚ä»£ç è§„èŒƒï¼šå˜é‡å`flag`æ˜ç¡®æ ‡è®°è´¨æ•°çŠ¶æ€ï¼Œå¾ªç¯è¾¹ç•Œ`i*i<=n`æœ‰æ•ˆä¼˜åŒ–ã€‚ç®—æ³•äº®ç‚¹ï¼šé€šè¿‡å› å­åˆ†è§£å°†æ—¶é—´å¤æ‚åº¦ä¼˜åŒ–è‡³O(âˆšn logn)ï¼Œå¯¹1e9å¤§æ•°å‹å¥½ã€‚å®è·µä»·å€¼ï¼šä»£ç å¯ç›´æ¥ç”¨äºç«èµ›ï¼Œè¾¹ç•Œå¤„ç†ä¸¥è°¨ï¼ˆè´¨æ•°æ—¶n=1ï¼‰ã€‚  

**é¢˜è§£äºŒï¼ˆyanxingyu0910ï¼‰**  
* **ç‚¹è¯„**ï¼š  
  ä»£ç å¯è¯»æ€§çªå‡ºï¼šå¿«è¯»å‡½æ•°å¢å¼ºè¾“å…¥æ•ˆç‡ï¼Œæ³¨é‡Šè§£é‡Šæ ¸å¿ƒé€»è¾‘ã€‚ç®—æ³•æœ‰æ•ˆæ€§ï¼šsqrt(n)ä¼˜åŒ–é¿å…TLEã€‚å®è·µäº®ç‚¹ï¼šç”¨`x`å˜é‡æ ‡è®°æ“ä½œçŠ¶æ€ï¼Œé€»è¾‘å°è£…å®Œæ•´ã€‚å­¦ä¹ ä»·å€¼ï¼šæ¸…æ™°å±•ç¤ºè´ªå¿ƒä¸è´¨æ•°å¤„ç†çš„ç»“åˆã€‚  

**é¢˜è§£ä¸‰ï¼ˆRosemary_dreamï¼‰**  
* **ç‚¹è¯„**ï¼š  
  æ•™å­¦æ€§æœ€å¼ºï¼šç”¨æ¯”å–»"æœ€å¤§å› å­å¯¹åº”æœ€å°å› å­"è§£é‡Šè´ªå¿ƒæœ¬è´¨ã€‚ä»£ç è§„èŒƒæ€§ï¼šlong longé˜²æº¢å‡ºï¼Œå¾ªç¯è¾¹ç•Œæ³¨é‡Šè¯¦ç»†ã€‚ç®—æ³•äº®ç‚¹ï¼šå¼ºè°ƒå› å­æˆå¯¹ç‰¹æ€§å‡å°‘æ— æ•ˆæšä¸¾ã€‚ç‰¹åˆ«ä»·å€¼ï¼šè¯¦ç»†è¯´æ˜ä¸ºä½•æœ€ååŠ 1ï¼Œå¸®åŠ©åˆå­¦è€…ç†è§£é¢˜æ„ã€‚

---

#### 3. æ ¸å¿ƒéš¾ç‚¹è¾¨æä¸è§£é¢˜ç­–ç•¥  
1. **éš¾ç‚¹1ï¼šè´ªå¿ƒç­–ç•¥çš„è¯æ˜**  
   * **åˆ†æ**ï¼šä¸ºä»€ä¹ˆé€‰æœ€å°å› æ•°ï¼Ÿå‡è®¾é€‰è¾ƒå¤§å› æ•°ï¼ˆå¦‚é¢˜è§£è¯æ˜ï¼‰ï¼Œæ€»å’Œä¸¥æ ¼å°äºæœ€å°å› æ•°ç­–ç•¥ã€‚ä¼˜è´¨é¢˜è§£é€šè¿‡å› å­ä¹˜ç§¯å±•å¼€å¼æ•°å­¦å½’çº³è¯æ˜ã€‚  
   * ğŸ’¡ **å­¦ä¹ ç¬”è®°**ï¼šè´ªå¿ƒç­–ç•¥éœ€ä¸¥æ ¼è¯æ˜ï¼Œå› å­é¡ºåºå½±å“å…¨å±€æœ€ä¼˜è§£ã€‚  

2. **éš¾ç‚¹2ï¼šè´¨æ•°çš„ç»ˆæ­¢å¤„ç†**  
   * **åˆ†æ**ï¼šè´¨æ•°åªèƒ½æ’æˆnè¡Œ1åˆ—ï¼Œç•™1ä¸ªçŸ³å­ã€‚éœ€åŒºåˆ†ä¸¤ç§æƒ…å†µï¼šå¾ªç¯ä¸­å‘ç°è´¨æ•°åˆ™breakï¼Œå¾ªç¯å¤–åŠ 1ï¼›è‹¥åœ¨å¾ªç¯å†…æ¨¡æ‹Ÿæ“ä½œéœ€é¿å…é‡å¤ç´¯åŠ ã€‚  
   * ğŸ’¡ **å­¦ä¹ ç¬”è®°**ï¼šè´¨æ•°æ˜¯è´ªå¿ƒçš„ç»ˆæ­¢æ¡ä»¶ï¼Œæœ€åä¸€æ­¥å›ºå®šå‰©1ä¸ªçŸ³å­ã€‚  

3. **éš¾ç‚¹3ï¼šæ—¶é—´å¤æ‚åº¦çš„ä¼˜åŒ–**  
   * **åˆ†æ**ï¼šæšä¸¾å› å­æ—¶åªéœ€åˆ°âˆšnï¼Œå› ä¸ºè‹¥iæ˜¯å› å­åˆ™n/iä¹Ÿæ˜¯å› å­ã€‚é¢˜è§£ç”¨i*i<=nä»£æ›¿i<=âˆšnï¼Œé¿å…æµ®ç‚¹è¯¯å·®ã€‚  
   * ğŸ’¡ **å­¦ä¹ ç¬”è®°**ï¼šå› å­æˆå¯¹å‡ºç°ï¼Œæšä¸¾åˆ°âˆšnå³å¯è¦†ç›–æ‰€æœ‰æƒ…å†µã€‚  

### âœ¨ è§£é¢˜æŠ€å·§æ€»ç»“  
- **æŠ€å·§1ï¼ˆé—®é¢˜è½¬åŒ–ï¼‰**ï¼šå°†"æœ€å¤§åŒ–ç•™å­˜é‡"è½¬åŒ–ä¸º"å¯»æ‰¾æœ€å°è´¨å› æ•°"  
- **æŠ€å·§2ï¼ˆå¾ªç¯ä¼˜åŒ–ï¼‰**ï¼šç”¨å¹³æ–¹ä»£æ›¿å¼€æ–¹ï¼Œé¿å…æµ®ç‚¹è¿ç®—  
- **æŠ€å·§3ï¼ˆè¾¹ç•Œå¤„ç†ï¼‰**ï¼šè´¨æ•°æ—¶ç›´æ¥break+æœ€ååŠ 1ï¼Œä¿è¯é€»è¾‘é—­ç¯  

---

#### 4. C++æ ¸å¿ƒä»£ç å®ç°èµæ  
**é€šç”¨æ ¸å¿ƒå®ç°**  
```cpp
#include <iostream>
using namespace std;
int main() {
    long long n, ans = 0;
    cin >> n;
    ans = n;  // åˆå§‹çŸ³å­æ•°
    while (n > 1) {
        bool found = false;
        for (int i = 2; i * i <= n; i++) { // ä¼˜åŒ–ï¼šæšä¸¾åˆ°âˆšn
            if (n % i == 0) {
                n /= i;     // ç•™ä¸‹åˆ—æ•°ï¼ˆçŸ³å­æ•°ï¼‰
                ans += n;   // ç´¯åŠ å½“å‰å‰©ä½™
                found = true;
                break;
            }
        }
        if (!found) break; // è´¨æ•°é€€å‡º
    }
    cout << ans + 1; // åŠ ä¸Šæœ€å1ä¸ªçŸ³å­
    return 0;
}
```
**ä»£ç è§£è¯»æ¦‚è¦**ï¼š  
> åˆå§‹åŒ–`ans`ä¸ºåˆå§‹çŸ³å­æ•°ã€‚å¾ªç¯ä¸­ï¼šè‹¥æ‰¾åˆ°æœ€å°è´¨å› æ•°`i`ï¼Œåˆ™æ›´æ–°çŸ³å­æ•°`n=n/i`å¹¶ç´¯åŠ åˆ°`ans`ï¼›è‹¥æœªæ‰¾åˆ°ï¼ˆè´¨æ•°ï¼‰åˆ™é€€å‡ºã€‚æœ€ååŠ 1æ˜¯æ¸¸æˆç»ˆæ­¢æ¡ä»¶ã€‚

---

**é¢˜è§£ä¸€æ ¸å¿ƒç‰‡æ®µ**  
```cpp
for(int i=2;i*i<=n;i++){
    if(n%i==0){
        n=n/i; 
        ans+=n;
        flag=1; break; // æ‰¾åˆ°å› æ•°æ ‡è®°
    }
}
if(!flag) n=1,ans+=1; // è´¨æ•°å¤„ç†
```
**äº®ç‚¹**ï¼šä¸¥æ ¼å¤„ç†è´¨æ•°  
**è§£è¯»**ï¼š`flag`æ ‡è®°æ˜¯å¦æ‰¾åˆ°å› æ•°ã€‚è´¨æ•°æ—¶æ‰‹åŠ¨ç½®`n=1`å¹¶ç´¯åŠ ï¼Œç¡®ä¿æœ€åä¸€æ­¥è¢«è®¡å…¥ã€‚  
**å­¦ä¹ ç¬”è®°**ï¼šè´¨æ•°éœ€æ˜¾å¼å¤„ç†ï¼Œé¿å…é—æ¼æœ€åä¸€æ­¥ã€‚

**é¢˜è§£äºŒæ ¸å¿ƒç‰‡æ®µ**  
```cpp
for(i=2;i<=sqrt(n);i++){ 
    if(n%i==0){
        n/=i;
        sum+=n; // å®æ—¶ç´¯åŠ 
        x=1; break;
    }
}
```
**äº®ç‚¹**ï¼šå®æ—¶ç´¯å¢ä¸çŠ¶æ€æ ‡è®°  
**è§£è¯»**ï¼šæ“ä½œæˆåŠŸåç«‹å³`sum+=n`ï¼Œ`x`æ ‡è®°æ“ä½œçŠ¶æ€ï¼Œé€»è¾‘æµç•…ã€‚  
**å­¦ä¹ ç¬”è®°**ï¼šçŠ¶æ€å˜é‡ç®€åŒ–å¾ªç¯æ§åˆ¶ã€‚

**é¢˜è§£ä¸‰æ ¸å¿ƒç‰‡æ®µ**  
```cpp
for(int i=2;i*i<=n;i++){
    if(n%i==0){
        ans+=(n/=i); // åˆå¹¶è¿ç®—
        break;
    }
}
```
**äº®ç‚¹**ï¼šä»£ç ç®€ç»ƒ  
**è§£è¯»**ï¼š`ans+=(n/=i)`åˆå¹¶é™¤æ³•å’Œç´¯åŠ ï¼Œå‡å°‘ä»£ç è¡Œæ•°ã€‚  
**å­¦ä¹ ç¬”è®°**ï¼šå¤åˆè¡¨è¾¾å¼æå‡ç®€æ´æ€§ï¼Œä½†éœ€ç¡®ä¿å¯è¯»æ€§ã€‚

---

#### 5. ç®—æ³•å¯è§†åŒ–ï¼šåƒç´ åŠ¨ç”»æ¼”ç¤º  
* **ä¸»é¢˜**ï¼š8ä½åƒç´ é£"å®çŸ³æ¶ˆé™¤"  
* **æ ¸å¿ƒæ¼”ç¤º**ï¼šè´ªå¿ƒç­–ç•¥çš„é€æ­¥æ‰§è¡Œ  
* **è®¾è®¡æ€è·¯**ï¼šå¤å¤åƒç´ é£é™ä½ç†è§£å‹åŠ›ï¼ŒéŸ³æ•ˆå¼ºåŒ–å…³é”®æ“ä½œè®°å¿†  

**åŠ¨ç”»æ­¥éª¤**ï¼š  
1. **åˆå§‹åŒ–**ï¼šçŸ³å­æ˜¾ç¤ºä¸ºå½©è‰²åƒç´ å—ï¼ˆå¦‚FCæ¸¸æˆã€Šä¿„ç½—æ–¯æ–¹å—ã€‹ï¼‰ï¼Œæ§åˆ¶é¢æ¿å«æ­¥è¿›/è°ƒé€Ÿæ»‘å—  
   ![](https://img.itch.zone/a/1/1/9/2/0/5/313/CMtKLK.gif)  
2. **å› æ•°åˆ†è§£**ï¼š  
   - å½“å‰çŸ³å­æ•°`n`æ˜¾ç¤ºåœ¨é¡¶éƒ¨  
   - æ‰«æå› æ•°æ—¶ï¼Œåƒç´ å—ä»2å¼€å§‹é—ªçƒï¼ˆéŸ³æ•ˆï¼šå˜€ï¼‰  
   - æ‰¾åˆ°æœ€å°å› æ•°`i`æ—¶ï¼Œè¯¥å› æ•°é«˜äº®ä¸ºçº¢è‰²ï¼ˆéŸ³æ•ˆï¼šå®ï¼ï¼‰  
3. **æ¶ˆé™¤åŠ¨ç”»**ï¼š  
   - æŒ‰`i`è¡Œæ’åˆ—çŸ³å­ï¼Œ`i-1`è¡Œè¢«"ç‚¸æ¯"ï¼ˆåƒç´ çˆ†ç‚¸åŠ¨ç”»+è½°éŸ³æ•ˆï¼‰  
   - å‰©ä½™çŸ³å­æ»‘å…¥æ–°ç½‘æ ¼ï¼ˆåƒç´ å—æ»‘åŠ¨åŠ¨ç”»ï¼‰  
4. **è´¨æ•°å¤„ç†**ï¼š  
   - è´¨æ•°æ—¶æ˜¾ç¤º"PRIME"æç¤ºï¼ˆéŸ³æ•ˆï¼šè­¦å‘Šå£°ï¼‰  
   - çŸ³å­æ’æˆå•åˆ—ï¼Œä»…ç•™1ä¸ªï¼ˆåƒç´ å—æ¸éšåŠ¨ç”»ï¼‰  
5. **æ•°æ®é¢æ¿**ï¼š  
   - å³ä¾§å®æ—¶æ˜¾ç¤º`ans`ç´¯è®¡å€¼  
   - å½“å‰æ“ä½œå¯¹åº”ä»£ç è¡Œé«˜äº®ï¼ˆå¦‚`n/=i`ï¼‰  

---

#### 6. æ‹“å±•ç»ƒä¹ ä¸ç›¸ä¼¼é—®é¢˜  
* **é€šç”¨æŠ€å·§è¿ç§»**ï¼š  
  è´ªå¿ƒ+å› æ•°åˆ†è§£è¿˜é€‚ç”¨äºï¼š  
  1. æ•´æ•°æ‹†åˆ†æœ€å¤§åŒ–ä¹˜ç§¯ï¼ˆå¦‚LeetCode 343ï¼‰  
  2. æœ€å°æ­¥æ•°å‡åˆ°1ï¼ˆå¦‚CodeForces 1579Dï¼‰  
  3. è´¨å› æ•°åˆ†è§£æ±‚æœ€çŸ­æ“ä½œé“¾  

* **æ´›è°·æ¨è**ï¼š  
  1. **P1029 æœ€å¤§å…¬çº¦æ•°å’Œæœ€å°å…¬å€æ•°é—®é¢˜**  
     ğŸ—£ï¸ å·©å›ºå› æ•°åˆ†è§£ä¸æ•°å­¦æ¨å¯¼  
  2. **P1072 è´¨å› æ•°åˆ†è§£**  
     ğŸ—£ï¸ ç›´æ¥åº”ç”¨æœ¬é¢˜è´ªå¿ƒæ€æƒ³  
  3. **P1068 åˆ†æ•°çº¿åˆ’å®š**  
     ğŸ—£ï¸ è®­ç»ƒè´ªå¿ƒç­–ç•¥çš„å˜å¼åº”ç”¨  

---

#### 7. å­¦ä¹ å¿ƒå¾—ä¸ç»éªŒåˆ†äº«  
> æœ¬æ¬¡é¢˜è§£ä¸­æœªå‘ç°æ˜ç¡®çš„ä½œè€…è°ƒè¯•å¿ƒå¾—ï¼Œä½†ç»¼åˆå®è·µå¯æ€»ç»“ï¼š  
> - **å…³é”®é™·é˜±**ï¼šæœ€åä¸€æ­¥çš„`+1`æ˜“é—æ¼ï¼ˆRosemary_dreamå¼ºè°ƒï¼‰  
> - **è°ƒè¯•æŠ€å·§**ï¼šç”¨n=10é€æ­¥æ¨¡æ‹Ÿï¼ˆå¦‚zhangyuanxiaoçš„æ ·ä¾‹åˆ†æï¼‰  
> - **ä¼˜åŒ–æ„è¯†**ï¼š`i*i<=n`æ¯”`i<=sqrt(n)`æ›´å®‰å…¨ï¼ˆyanxingyu0910å®è·µï¼‰  

---

é€šè¿‡æœ¬æ¬¡åˆ†æï¼Œæˆ‘ä»¬æ·±å…¥æŒæ¡äº†è´ªå¿ƒç­–ç•¥åœ¨å› æ•°åˆ†è§£ä¸­çš„åº”ç”¨ã€‚è®°ä½ï¼šç®—æ³•å­¦ä¹ å¦‚åŒæ­ç§¯æœ¨ï¼Œæ¯ä¸€æ­¥éƒ½è¦ç¨³å›ºåŸºç¡€ï¼ä¸‹æ¬¡æŒ‘æˆ˜è§ï¼ğŸ’ª

---
å¤„ç†ç”¨æ—¶ï¼š182.07ç§’
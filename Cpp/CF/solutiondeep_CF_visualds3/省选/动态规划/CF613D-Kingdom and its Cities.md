# é¢˜ç›®ä¿¡æ¯

# Kingdom and its Cities

## é¢˜ç›®æè¿°

Meanwhile, the kingdom of K is getting ready for the marriage of the King's daughter. However, in order not to lose face in front of the relatives, the King should first finish reforms in his kingdom. As the King can not wait for his daughter's marriage, reforms must be finished as soon as possible.

The kingdom currently consists of $ n $ cities. Cities are connected by $ n-1 $ bidirectional road, such that one can get from any city to any other city. As the King had to save a lot, there is only one path between any two cities.

What is the point of the reform? The key ministries of the state should be relocated to distinct cities (we call such cities important). However, due to the fact that there is a high risk of an attack by barbarians it must be done carefully. The King has made several plans, each of which is described by a set of important cities, and now wonders what is the best plan.

Barbarians can capture some of the cities that are not important (the important ones will have enough protection for sure), after that the captured city becomes impassable. In particular, an interesting feature of the plan is the minimum number of cities that the barbarians need to capture in order to make all the important cities isolated, that is, from all important cities it would be impossible to reach any other important city.

Help the King to calculate this characteristic for each of his plan.

## è¯´æ˜/æç¤º

In the first sample, in the first and the third King's plan barbarians can capture the city 3, and that will be enough. In the second and the fourth plans all their attempts will not be effective.

In the second sample the cities to capture are 3 and 5.

## æ ·ä¾‹ #1

### è¾“å…¥

```
4
1 3
2 3
4 3
4
2 1 2
3 2 3 4
3 1 2 4
4 1 2 3 4
```

### è¾“å‡º

```
1
-1
1
-1
```

## æ ·ä¾‹ #2

### è¾“å…¥

```
7
1 2
2 3
3 4
1 5
5 6
5 7
1
4 2 4 6 7
```

### è¾“å‡º

```
2
```

# AIåˆ†æç»“æœ

# ğŸ’¡ Kayçš„C++ç®—æ³•è§£æï¼šKingdom and its Cities æ·±å…¥å­¦ä¹ æŒ‡å— ğŸ’¡

## å¼•è¨€
ä»Šå¤©æˆ‘ä»¬è¦è§£å†³çš„é—®é¢˜æ˜¯ã€ŒKingdom and its Citiesã€â€”â€”è¿™æ˜¯ä¸€é“ç»å…¸çš„**è™šæ ‘+æ ‘å½¢DP**ç»„åˆé¢˜ã€‚é¢˜ç›®è¦æ±‚æˆ‘ä»¬åœ¨æ ‘ä¸Šæ¯æ¬¡ç»™å®šä¸€ç»„å…³é”®ç‚¹ï¼Œæ‰¾å‡ºæœ€å°‘éœ€è¦åˆ é™¤çš„éå…³é”®ç‚¹ï¼Œè®©æ‰€æœ‰å…³é”®ç‚¹ä¸¤ä¸¤ä¸è¿é€šã€‚å¦‚æœå…³é”®ç‚¹ç›´æ¥ç›¸é‚»ï¼Œåˆ™æ— è§£ã€‚


## 1. é¢˜ç›®è§£è¯»ä¸æ ¸å¿ƒç®—æ³•è¯†åˆ«

âœ¨ **æœ¬é¢˜ä¸»è¦è€ƒå¯Ÿ**ï¼šè™šæ ‘ï¼ˆVirtual Treeï¼‰+ æ ‘å½¢åŠ¨æ€è§„åˆ’ï¼ˆTree DPï¼‰

ğŸ—£ï¸ **åˆæ­¥åˆ†æ**ï¼š
è§£å†³è¿™é“é¢˜çš„å…³é”®ï¼Œåœ¨äº**ç”¨è™šæ ‘â€œç²¾ç®€â€æ ‘çš„è§„æ¨¡**ï¼Œå†ç”¨æ ‘å½¢DPè®¡ç®—æœ€å°åˆ é™¤æ•°ã€‚  
- **è™šæ ‘æ˜¯ä»€ä¹ˆï¼Ÿ** å¯ä»¥ç†è§£ä¸ºâ€œæ ‘çš„ç¼©ç•¥å›¾â€â€”â€”å½“æˆ‘ä»¬åªå…³å¿ƒæŸäº›å…³é”®ç‚¹æ—¶ï¼Œè™šæ ‘åªä¿ç•™è¿™äº›å…³é”®ç‚¹å’Œå®ƒä»¬çš„**æœ€è¿‘å…¬å…±ç¥–å…ˆï¼ˆLCAï¼‰**ï¼Œå»æ‰æ— å…³èŠ‚ç‚¹ï¼Œä»è€Œå°†é—®é¢˜è§„æ¨¡ä»O(n)å‹ç¼©åˆ°O(k)ï¼ˆkæ˜¯å…³é”®ç‚¹æ•°é‡ï¼‰ã€‚  
- **æ ‘å½¢DPåšä»€ä¹ˆï¼Ÿ** åœ¨è™šæ ‘ä¸Šï¼Œæˆ‘ä»¬é€šè¿‡DPè®¡ç®—æ¯ä¸ªå­æ ‘çš„æœ€å°åˆ é™¤æ•°ï¼š  
  - è‹¥å½“å‰èŠ‚ç‚¹æ˜¯**å…³é”®ç‚¹**ï¼šéœ€è¦æ–­å¼€æ‰€æœ‰ä¸å­æ ‘ä¸­å…³é”®ç‚¹çš„è¿æ¥ï¼ˆæ¯æœ‰ä¸€ä¸ªæœªæ–­å¼€çš„å­æ ‘ï¼Œå°±åˆ ä¸€ä¸ªç‚¹ï¼‰ï¼›  
  - è‹¥å½“å‰èŠ‚ç‚¹æ˜¯**éå…³é”®ç‚¹**ï¼šå¦‚æœæœ‰å¤šä¸ªå­æ ‘å«å…³é”®ç‚¹ï¼Œåˆ å½“å‰èŠ‚ç‚¹ï¼ˆä¸€æ¬¡æ€§æ–­å¼€æ‰€æœ‰å­æ ‘ï¼‰ï¼›å¦‚æœåªæœ‰ä¸€ä¸ªå­æ ‘å«å…³é”®ç‚¹ï¼Œå°±æŠŠâ€œéœ€è¦æ–­å¼€â€çš„ä¿¡å·ä¼ é€’ç»™çˆ¶èŠ‚ç‚¹ï¼ˆå¯èƒ½åœ¨æ›´é«˜å±‚ä¸€èµ·å¤„ç†ï¼Œæ›´ä¼˜ï¼‰ã€‚  

**æ ¸å¿ƒç®—æ³•æµç¨‹**ï¼š  
1. **é¢„å¤„ç†åŸæ ‘**ï¼šç”¨æ ‘å‰–æˆ–å€å¢æ±‚LCAï¼Œè®°å½•æ¯ä¸ªèŠ‚ç‚¹çš„DFSåºï¼ˆç”¨äºè™šæ ‘æ’åºï¼‰ï¼›  
2. **æ„å»ºè™šæ ‘**ï¼šå°†å…³é”®ç‚¹æŒ‰DFSåºæ’åºï¼Œç”¨æ ˆç»´æŠ¤å½“å‰é“¾ï¼Œä¾æ¬¡æ’å…¥å…³é”®ç‚¹å¹¶å¤„ç†LCAï¼Œç”Ÿæˆè™šæ ‘ï¼›  
3. **æ ‘å½¢DP**ï¼šåœ¨è™šæ ‘ä¸Šè®¡ç®—æœ€å°åˆ é™¤æ•°ï¼ŒåŒæ—¶åˆ¤æ–­æ— è§£æƒ…å†µï¼ˆå…³é”®ç‚¹ç›¸é‚»ï¼‰ã€‚  

**å¯è§†åŒ–è®¾è®¡æ€è·¯**ï¼š  
æˆ‘ä»¬ç”¨**8ä½åƒç´ é£æ ¼**ï¼ˆç±»ä¼¼FCæ¸¸æˆï¼‰å±•ç¤ºè™šæ ‘æ„å»ºå’ŒDPè¿‡ç¨‹ï¼š  
- åŸæ ‘ç”¨ç»¿è‰²åƒç´ å—è¡¨ç¤ºï¼Œå…³é”®ç‚¹ç”¨çº¢è‰²ï¼ŒLCAç”¨è“è‰²ï¼›  
- æ ˆç”¨é»„è‰²æ–¹å—å †å ï¼Œæ’å…¥å…³é”®ç‚¹æ—¶æ’­æ”¾â€œå®â€çš„éŸ³æ•ˆï¼Œå¤„ç†LCAæ—¶æ’­æ”¾â€œå—’â€çš„éŸ³æ•ˆï¼›  
- DPè¿‡ç¨‹ä¸­ï¼ŒèŠ‚ç‚¹çŠ¶æ€å˜åŒ–ç”¨é—ªçƒæç¤ºï¼ˆæ¯”å¦‚çº¢è‰²è¡¨ç¤ºå…³é”®ç‚¹ï¼Œç°è‰²è¡¨ç¤ºå·²åˆ é™¤ï¼‰ï¼Œç­”æ¡ˆç´¯åŠ æ—¶æ˜¾ç¤ºâ€œ+1â€çš„åƒç´ æ–‡å­—ã€‚


## 2. ç²¾é€‰ä¼˜è´¨é¢˜è§£å‚è€ƒ

ä¸ºå¤§å®¶ç­›é€‰äº†3ä»½æ€è·¯æ¸…æ™°ã€ä»£ç è§„èŒƒçš„ä¼˜è´¨é¢˜è§£ï¼š

### é¢˜è§£ä¸€ï¼ˆä½œè€…ï¼šå®_ç¼ºï¼Œèµ28ï¼‰
**ç‚¹è¯„**ï¼šè¿™ä»½é¢˜è§£çš„äº®ç‚¹æ˜¯**æ ‘å‰–æ±‚LCA+ç®€æ´çš„è™šæ ‘æ„å»º**ã€‚ä½œè€…ç”¨æ ‘å‰–é¢„å¤„ç†LCAï¼Œç¡®ä¿äº†æŸ¥è¯¢æ•ˆç‡ï¼›è™šæ ‘æ„å»ºç”¨æ ˆç»´æŠ¤é“¾ï¼Œé€»è¾‘ç›´è§‚ï¼›DPéƒ¨åˆ†ç”¨`g[x]`ï¼ˆå­æ ‘æ˜¯å¦æœ‰å…³é”®ç‚¹è¿é€šï¼‰å’Œ`f[x]`ï¼ˆå­æ ‘ç­”æ¡ˆï¼‰ï¼ŒçŠ¶æ€è½¬ç§»æ¸…æ™°ã€‚ä»£ç ä¸­çš„WAç‚¹æ€»ç»“ï¼ˆåˆå§‹åŒ–å’Œè¾¹ç•Œæ¡ä»¶ï¼‰å¾ˆå®ç”¨ï¼Œæé†’æˆ‘ä»¬æ³¨æ„ç»†èŠ‚ã€‚

### é¢˜è§£äºŒï¼ˆä½œè€…ï¼špitiless0514ï¼Œèµ18ï¼‰
**ç‚¹è¯„**ï¼šæ­¤é¢˜è§£çš„è™šæ ‘æ„å»ºæ–¹æ³•å¾ˆå·§å¦™â€”â€”**å°†ç›¸é‚»å…³é”®ç‚¹çš„LCAåŠ å…¥ç‚¹é›†ï¼Œå†æ’åºå»é‡**ï¼Œç®€åŒ–äº†æ ˆæ“ä½œã€‚DPéƒ¨åˆ†ç”¨`mark[x]`æ ‡è®°å…³é”®ç‚¹ï¼Œ`getans`å‡½æ•°é€’å½’è®¡ç®—ï¼Œé€»è¾‘ç›´æ¥ã€‚ä»£ç ä¸­çš„IOä¼˜åŒ–ï¼ˆå¿«é€Ÿè¯»å…¥ï¼‰å€¼å¾—å­¦ä¹ ï¼Œé€‚åˆå¤„ç†å¤§æ•°æ®ã€‚

### é¢˜è§£ä¸‰ï¼ˆä½œè€…ï¼š_ctzï¼Œèµ14ï¼‰
**ç‚¹è¯„**ï¼šè¿™ä»½é¢˜è§£çš„DPçŠ¶æ€è®¾è®¡å¾ˆè¯¦ç»†â€”â€”ç”¨`f(i,0)`ï¼ˆå­æ ‘å†…å…³é”®ç‚¹ä¸è¿é€šä¸”æœ‰è¿é€šåˆ°içš„å…³é”®ç‚¹ï¼‰å’Œ`f(i,1)`ï¼ˆå­æ ‘å†…å…³é”®ç‚¹ä¸è¿é€šä¸”æ— è¿é€šåˆ°içš„å…³é”®ç‚¹ï¼‰ï¼Œè¦†ç›–äº†æ‰€æœ‰æƒ…å†µã€‚è™šæ ‘æ„å»ºç”¨å•è°ƒæ ˆï¼Œä»£ç ä¸¥è°¨ï¼Œé€‚åˆæ·±å…¥ç†è§£çŠ¶æ€è½¬ç§»çš„é€»è¾‘ã€‚


## 3. æ ¸å¿ƒéš¾ç‚¹è¾¨æä¸è§£é¢˜ç­–ç•¥

### å…³é”®ç‚¹1ï¼šè™šæ ‘çš„æ„å»º
**éš¾ç‚¹**ï¼šå¦‚ä½•æ­£ç¡®ç»´æŠ¤æ ˆï¼Œå¤„ç†LCAï¼Œç”Ÿæˆè™šæ ‘ï¼Ÿ  
**è§£å†³ç­–ç•¥**ï¼š  
1. å°†å…³é”®ç‚¹æŒ‰**DFSåºæ’åº**ï¼ˆç¡®ä¿å¤„ç†é¡ºåºç¬¦åˆæ ‘çš„éå†é¡ºåºï¼‰ï¼›  
2. ç”¨æ ˆç»´æŠ¤å½“å‰â€œé“¾â€ï¼ˆä»æ ¹åˆ°æ ˆé¡¶çš„è·¯å¾„ï¼‰ï¼›  
3. æ’å…¥æ–°å…³é”®ç‚¹æ—¶ï¼Œæ‰¾åˆ°å®ƒä¸æ ˆé¡¶çš„LCAï¼š  
   - è‹¥LCAæ˜¯æ ˆé¡¶ï¼Œç›´æ¥å…¥æ ˆï¼›  
   - å¦åˆ™ï¼Œå¼¹å‡ºæ ˆé¡¶ç›´åˆ°LCAåœ¨é“¾ä¸Šï¼Œå°†LCAå…¥æ ˆï¼Œå†æ’å…¥æ–°å…³é”®ç‚¹ï¼›  
4. æœ€åå°†æ ˆä¸­å‰©ä½™èŠ‚ç‚¹è¿æˆé“¾ã€‚  

ğŸ’¡ **å­¦ä¹ ç¬”è®°**ï¼šDFSåºæ˜¯è™šæ ‘æ„å»ºçš„æ ¸å¿ƒï¼Œç¡®ä¿äº†èŠ‚ç‚¹å¤„ç†çš„é¡ºåºæ€§ã€‚

### å…³é”®ç‚¹2ï¼šæ ‘å½¢DPçš„çŠ¶æ€è½¬ç§»
**éš¾ç‚¹**ï¼šå¦‚ä½•åŒºåˆ†å…³é”®ç‚¹å’Œéå…³é”®ç‚¹çš„è½¬ç§»é€»è¾‘ï¼Ÿ  
**è§£å†³ç­–ç•¥**ï¼š  
- **å…³é”®ç‚¹x**ï¼šç­”æ¡ˆåŠ ä¸Šæ‰€æœ‰å­æ ‘ä¸­è¿é€šçš„å…³é”®ç‚¹æ•°é‡ï¼ˆæ¯ä¸ªè¿é€šçš„å­æ ‘éœ€è¦åˆ ä¸€ä¸ªç‚¹ï¼‰ï¼Œå¹¶æ ‡è®°xä¸ºè¿é€šï¼ˆ`g[x]=true`ï¼‰ï¼›  
- **éå…³é”®ç‚¹x**ï¼šè‹¥å­æ ‘ä¸­è¿é€šçš„å…³é”®ç‚¹æ•°é‡>1ï¼Œåˆ xï¼ˆç­”æ¡ˆ+1ï¼‰ï¼Œæ ‡è®°xä¸ºä¸è¿é€šï¼›è‹¥æ•°é‡=1ï¼Œæ ‡è®°xä¸ºè¿é€šï¼ˆä¼ é€’ç»™çˆ¶èŠ‚ç‚¹ï¼‰ï¼›è‹¥æ•°é‡=0ï¼Œæ ‡è®°xä¸ºä¸è¿é€šã€‚  

ğŸ’¡ **å­¦ä¹ ç¬”è®°**ï¼šçŠ¶æ€è½¬ç§»çš„æ ¸å¿ƒæ˜¯â€œè´ªå¿ƒâ€â€”â€”èƒ½åœ¨æ›´é«˜å±‚å¤„ç†çš„ï¼Œå°±ä¸æå‰åˆ ç‚¹ã€‚

### å…³é”®ç‚¹3ï¼šæ— è§£æƒ…å†µçš„åˆ¤æ–­
**éš¾ç‚¹**ï¼šå¦‚ä½•å¿«é€Ÿåˆ¤æ–­å…³é”®ç‚¹ç›¸é‚»ï¼Ÿ  
**è§£å†³ç­–ç•¥**ï¼šé¢„å¤„ç†æ¯ä¸ªèŠ‚ç‚¹çš„çˆ¶èŠ‚ç‚¹ï¼Œè‹¥æŸä¸ªå…³é”®ç‚¹çš„çˆ¶èŠ‚ç‚¹ä¹Ÿæ˜¯å…³é”®ç‚¹ï¼Œåˆ™ç›´æ¥è¾“å‡º-1ã€‚  

ğŸ’¡ **å­¦ä¹ ç¬”è®°**ï¼šæ— è§£æƒ…å†µè¦æå‰åˆ¤æ–­ï¼Œé¿å…ä¸å¿…è¦çš„è®¡ç®—ã€‚


## 4. C++æ ¸å¿ƒä»£ç å®ç°èµæ

### æœ¬é¢˜é€šç”¨æ ¸å¿ƒC++å®ç°å‚è€ƒ
**è¯´æ˜**ï¼šç»¼åˆä¼˜è´¨é¢˜è§£çš„æ€è·¯ï¼Œå®ç°è™šæ ‘æ„å»º+æ ‘å½¢DPçš„æ ¸å¿ƒé€»è¾‘ã€‚

```cpp
#include <iostream>
#include <vector>
#include <algorithm>
#include <cstring>
using namespace std;

const int MAXN = 1e5 + 5;
vector<int> adj[MAXN], virt_adj[MAXN]; // åŸæ ‘ã€è™šæ ‘é‚»æ¥è¡¨
int dep[MAXN], fa[MAXN][20], dfn[MAXN], dfn_cnt; // æ·±åº¦ã€å€å¢è¡¨ã€DFSåº
int stk[MAXN], top; // è™šæ ‘æ„å»ºæ ˆ
bool is_key[MAXN]; // æ˜¯å¦æ˜¯å…³é”®ç‚¹
int ans; // ç­”æ¡ˆ

// é¢„å¤„ç†åŸæ ‘ï¼šDFSæ±‚æ·±åº¦ã€çˆ¶èŠ‚ç‚¹ã€DFSåº
void dfs1(int u, int f) {
    dfn[u] = ++dfn_cnt;
    fa[u][0] = f;
    dep[u] = dep[f] + 1;
    for (int v : adj[u]) {
        if (v != f) dfs1(v, u);
    }
}

// å€å¢é¢„å¤„ç†LCA
void preprocess(int n) {
    for (int j = 1; j < 20; j++) {
        for (int i = 1; i <= n; i++) {
            fa[i][j] = fa[fa[i][j-1]][j-1];
        }
    }
}

// æ±‚LCA
int lca(int u, int v) {
    if (dep[u] < dep[v]) swap(u, v);
    for (int j = 19; j >= 0; j--) {
        if (dep[fa[u][j]] >= dep[v]) u = fa[u][j];
    }
    if (u == v) return u;
    for (int j = 19; j >= 0; j--) {
        if (fa[u][j] != fa[v][j]) u = fa[u][j], v = fa[v][j];
    }
    return fa[u][0];
}

// è™šæ ‘æ„å»ºï¼šæ’å…¥èŠ‚ç‚¹u
void insert(int u) {
    if (top == 0) { stk[++top] = u; return; }
    int l = lca(u, stk[top]);
    while (top > 1 && dep[l] < dep[stk[top-1]]) {
        virt_adj[stk[top-1]].push_back(stk[top]);
        virt_adj[stk[top]].push_back(stk[top-1]);
        top--;
    }
    if (l != stk[top]) {
        virt_adj[l].push_back(stk[top]);
        virt_adj[stk[top]].push_back(l);
        stk[top] = l;
    }
    stk[++top] = u;
}

// æ ‘å½¢DPï¼šè¿”å›å­æ ‘ä¸­æ˜¯å¦æœ‰å…³é”®ç‚¹è¿é€š
bool dp(int u, int f) {
    bool has_key = is_key[u];
    for (int v : virt_adj[u]) {
        if (v == f) continue;
        bool child_has = dp(v, u);
        if (child_has) {
            if (is_key[u]) ans++; // å…³é”®ç‚¹uï¼Œéœ€è¦æ–­å¼€å­æ ‘
            has_key = true;
        }
    }
    if (!is_key[u]) {
        int cnt = 0;
        for (int v : virt_adj[u]) {
            if (v == f) continue;
            if (dp(v, u)) cnt++;
        }
        if (cnt > 1) { ans++; has_key = false; } // éå…³é”®ç‚¹ï¼Œå¤šä¸ªå­æ ‘æœ‰é”®ç‚¹ï¼Œåˆ u
        else if (cnt == 1) has_key = true; // ä¼ é€’ç»™çˆ¶èŠ‚ç‚¹
        else has_key = false;
    }
    virt_adj[u].clear(); // æ¸…ç©ºè™šæ ‘é‚»æ¥è¡¨ï¼Œé¿å…å½±å“ä¸‹ä¸€æ¬¡è¯¢é—®
    return has_key;
}

int main() {
    ios::sync_with_stdio(false);
    cin.tie(0);
    int n; cin >> n;
    for (int i = 1; i < n; i++) {
        int u, v; cin >> u >> v;
        adj[u].push_back(v);
        adj[v].push_back(u);
    }
    dfs1(1, 0);
    preprocess(n);
    int q; cin >> q;
    while (q--) {
        int k; cin >> k;
        vector<int> keys(k);
        memset(is_key, 0, sizeof(is_key));
        ans = 0;
        bool invalid = false;
        for (int i = 0; i < k; i++) {
            cin >> keys[i];
            is_key[keys[i]] = true;
            if (is_key[fa[keys[i]][0]]) invalid = true; // çˆ¶èŠ‚ç‚¹ä¹Ÿæ˜¯å…³é”®ç‚¹ï¼Œæ— è§£
        }
        if (invalid) {
            cout << "-1\n";
            continue;
        }
        // æŒ‰DFSåºæ’åºå…³é”®ç‚¹
        sort(keys.begin(), keys.end(), [](int a, int b) { return dfn[a] < dfn[b]; });
        top = 0;
        stk[top = 1] = 1; // æ ¹èŠ‚ç‚¹å…¥æ ˆ
        for (int u : keys) {
            if (u == 1) continue;
            insert(u);
        }
        // å¤„ç†æ ˆä¸­å‰©ä½™èŠ‚ç‚¹
        while (top > 1) {
            virt_adj[stk[top-1]].push_back(stk[top]);
            virt_adj[stk[top]].push_back(stk[top-1]);
            top--;
        }
        dp(1, 0);
        cout << ans << "\n";
    }
    return 0;
}
```

**ä»£ç è§£è¯»æ¦‚è¦**ï¼š  
1. **é¢„å¤„ç†**ï¼š`dfs1`æ±‚åŸæ ‘çš„æ·±åº¦ã€çˆ¶èŠ‚ç‚¹å’ŒDFSåºï¼›`preprocess`é¢„å¤„ç†å€å¢è¡¨ï¼›  
2. **è™šæ ‘æ„å»º**ï¼š`insert`å‡½æ•°ç”¨æ ˆç»´æŠ¤é“¾ï¼Œæ’å…¥å…³é”®ç‚¹å¹¶å¤„ç†LCAï¼›  
3. **æ ‘å½¢DP**ï¼š`dp`å‡½æ•°é€’å½’è®¡ç®—æ¯ä¸ªå­æ ‘çš„ç­”æ¡ˆï¼Œè¿”å›å­æ ‘æ˜¯å¦æœ‰å…³é”®ç‚¹è¿é€šï¼›  
4. **ä¸»å‡½æ•°**ï¼šå¤„ç†è¾“å…¥ï¼Œåˆ¤æ–­æ— è§£æƒ…å†µï¼Œæ’åºå…³é”®ç‚¹ï¼Œæ„å»ºè™šæ ‘ï¼Œè°ƒç”¨DPè¾“å‡ºç­”æ¡ˆã€‚


## 5. ç®—æ³•å¯è§†åŒ–ï¼šåƒç´ åŠ¨ç”»æ¼”ç¤º

### åŠ¨ç”»ä¸»é¢˜ï¼šåƒç´ æ ‘çš„â€œç²¾ç®€ä¸ä¼˜åŒ–â€
**é£æ ¼**ï¼š8ä½åƒç´ é£ï¼ˆç±»ä¼¼ã€Šè¶…çº§ç›ä¸½ã€‹ï¼‰ï¼Œç”¨ç»¿è‰²è¡¨ç¤ºåŸæ ‘ï¼Œçº¢è‰²è¡¨ç¤ºå…³é”®ç‚¹ï¼Œè“è‰²è¡¨ç¤ºLCAï¼Œé»„è‰²è¡¨ç¤ºæ ˆã€‚  
**æ ¸å¿ƒæ¼”ç¤ºå†…å®¹**ï¼š  
1. **åœºæ™¯åˆå§‹åŒ–**ï¼šå±å¹•æ˜¾ç¤ºä¸€æ£µç»¿è‰²åƒç´ æ ‘ï¼Œå³ä¾§æœ‰æ§åˆ¶é¢æ¿ï¼ˆå¼€å§‹/æš‚åœã€å•æ­¥ã€é‡ç½®ã€é€Ÿåº¦æ»‘å—ï¼‰ï¼›  
2. **å…³é”®ç‚¹æ’åº**ï¼šçº¢è‰²åƒç´ å—ï¼ˆå…³é”®ç‚¹ï¼‰æŒ‰DFSåºæ’åˆ—ï¼Œæ’­æ”¾â€œæ»´æ»´â€éŸ³æ•ˆï¼›  
3. **è™šæ ‘æ„å»º**ï¼š  
   - æ ˆï¼ˆé»„è‰²æ–¹å—ï¼‰åˆå§‹åŒ–ä¸ºæ ¹èŠ‚ç‚¹ï¼ˆ1å·ï¼‰ï¼›  
   - æ’å…¥å…³é”®ç‚¹æ—¶ï¼Œé»„è‰²æ–¹å—å †å ï¼Œæ’­æ”¾â€œå®â€å£°ï¼›  
   - å¤„ç†LCAæ—¶ï¼Œè“è‰²æ–¹å—å‡ºç°ï¼Œè¿æ¥æ ˆé¡¶å’Œæ–°å…³é”®ç‚¹ï¼Œæ’­æ”¾â€œå—’â€å£°ï¼›  
4. **æ ‘å½¢DP**ï¼š  
   - çº¢è‰²èŠ‚ç‚¹ï¼ˆå…³é”®ç‚¹ï¼‰é—ªçƒï¼Œæ˜¾ç¤ºâ€œ+1â€è¡¨ç¤ºåˆ é™¤å­æ ‘ä¸­çš„ç‚¹ï¼›  
   - éçº¢è‰²èŠ‚ç‚¹ï¼ˆLCAï¼‰è‹¥æœ‰å¤šä¸ªå­æ ‘å«å…³é”®ç‚¹ï¼Œå˜ä¸ºç°è‰²ï¼ˆè¡¨ç¤ºåˆ é™¤ï¼‰ï¼Œæ’­æ”¾â€œç °â€å£°ï¼›  
5. **ç»“æœå±•ç¤º**ï¼šæœ€ç»ˆç­”æ¡ˆç”¨åƒç´ æ–‡å­—æ˜¾ç¤ºï¼Œæ’­æ”¾â€œèƒœåˆ©â€éŸ³æ•ˆã€‚

**äº¤äº’è®¾è®¡**ï¼š  
- å•æ­¥æ‰§è¡Œï¼šç‚¹å‡»â€œä¸‹ä¸€æ­¥â€ï¼Œé€å¸§å±•ç¤ºè™šæ ‘æ„å»ºå’ŒDPè¿‡ç¨‹ï¼›  
- è‡ªåŠ¨æ’­æ”¾ï¼šæ»‘åŠ¨é€Ÿåº¦æ»‘å—è°ƒæ•´æ’­æ”¾é€Ÿåº¦ï¼Œè‡ªåŠ¨æ¼”ç¤ºå®Œæ•´æµç¨‹ï¼›  
- é‡ç½®ï¼šæ¢å¤åˆå§‹çŠ¶æ€ï¼Œé‡æ–°å¼€å§‹ã€‚


## 6. æ‹“å±•ç»ƒä¹ ä¸ç›¸ä¼¼é—®é¢˜æ€è€ƒ

### é€šç”¨æ€è·¯è¿ç§»
è™šæ ‘+æ ‘å½¢DPçš„ç»„åˆï¼Œé€‚ç”¨äº**å¤šæ¬¡è¯¢é—®æ ‘ä¸Šå…³é”®ç‚¹**çš„é—®é¢˜ï¼Œæ¯”å¦‚ï¼š  
1. æ±‚å…³é”®ç‚¹ä¹‹é—´çš„æœ€çŸ­è·¯å¾„å’Œï¼›  
2. æ±‚åˆ é™¤æœ€å°‘è¾¹ä½¿å…³é”®ç‚¹ä¸è¿é€šï¼›  
3. æ±‚å…³é”®ç‚¹çš„æœ€å°è¦†ç›–é›†ã€‚

### æ´›è°·ç»ƒä¹ æ¨è
1. **P4103 [HEOI2014]å¤§å·¥ç¨‹**ï¼šè™šæ ‘+æ ‘å½¢DPï¼Œæ±‚å…³é”®ç‚¹çš„æœ€é•¿è·¯å¾„ã€æœ€çŸ­è·¯å¾„å’Œè·¯å¾„å’Œï¼Œå¼ºåŒ–è™šæ ‘çš„åº”ç”¨ï¼›  
2. **P3320 [SDOI2015]å¯»å®æ¸¸æˆ**ï¼šè™šæ ‘+è´ªå¿ƒï¼Œæ±‚å…³é”®ç‚¹çš„æœ€å°éå†è·¯å¾„ï¼Œç»ƒä¹ è™šæ ‘çš„æ„å»ºå’ŒåŠ¨æ€ç»´æŠ¤ï¼›  
3. **P2495 [SDOI2011]æ¶ˆè€—æˆ˜**ï¼šè™šæ ‘+æ ‘å½¢DPï¼Œæ±‚åˆ é™¤æœ€å°‘è¾¹ä½¿å…³é”®ç‚¹ä¸è¿é€šï¼Œç±»ä¼¼æœ¬é¢˜çš„å˜å½¢ã€‚


## 7. å­¦ä¹ å¿ƒå¾—ä¸ç»éªŒåˆ†äº«

**å‚è€ƒç»éªŒ**ï¼ˆæ¥è‡ªé¢˜è§£ä½œè€…å®_ç¼ºï¼‰ï¼š  
â€œæˆ‘WAäº†ä¸€æ¬¡ï¼Œå› ä¸ºåˆå§‹åŒ–æ—¶æ²¡æ¸…ç©º`vis`æ•°ç»„ï¼Œè¿˜æœ‰æ²¡è€ƒè™‘`âˆ‘g[v]=0`çš„æƒ…å†µï¼ˆå¶å­èŠ‚ç‚¹ï¼‰ã€‚â€  
**ç‚¹è¯„**ï¼šåˆå§‹åŒ–å’Œè¾¹ç•Œæ¡ä»¶æ˜¯ç¼–ç¨‹ä¸­çš„å¸¸è§å‘ç‚¹ã€‚è§£å†³æ–¹æ³•æ˜¯ï¼š  
- æ¯æ¬¡è¯¢é—®åï¼Œæ¸…ç©ºè™šæ ‘çš„é‚»æ¥è¡¨å’Œæ ‡è®°æ•°ç»„ï¼›  
- æµ‹è¯•å¶å­èŠ‚ç‚¹ã€å•å…³é”®ç‚¹ç­‰è¾¹ç•Œæƒ…å†µï¼Œç¡®ä¿é€»è¾‘æ­£ç¡®ã€‚


## ç»“è¯­
é€šè¿‡è¿™é“é¢˜ï¼Œæˆ‘ä»¬å­¦ä¼šäº†ç”¨è™šæ ‘â€œç²¾ç®€â€æ ‘çš„è§„æ¨¡ï¼Œç”¨æ ‘å½¢DPè®¡ç®—æœ€å°åˆ é™¤æ•°ã€‚è®°ä½ï¼š**è™šæ ‘æ˜¯å¤„ç†æ ‘ä¸Šå¤šæ¬¡å…³é”®ç‚¹æŸ¥è¯¢çš„â€œåˆ©å™¨â€ï¼Œè€Œæ ‘å½¢DPæ˜¯è§£å†³å­æ ‘é—®é¢˜çš„æ ¸å¿ƒ**ã€‚å¤šç»ƒä¹ ç›¸ä¼¼é¢˜ç›®ï¼Œå°±èƒ½ç†Ÿç»ƒæŒæ¡è¿™ä¸¤ä¸ªæŠ€å·§å•¦ï¼ğŸ’ª

ä¸‹æ¬¡æˆ‘ä»¬å†ä¸€èµ·æ¢ç´¢æ›´å¤šæœ‰è¶£çš„ç®—æ³•é—®é¢˜~

---
å¤„ç†ç”¨æ—¶ï¼š93.62ç§’
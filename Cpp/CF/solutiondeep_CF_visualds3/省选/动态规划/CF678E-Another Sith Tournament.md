# é¢˜ç›®ä¿¡æ¯

# Another Sith Tournament

## é¢˜ç›®æè¿°

The rules of Sith Tournament are well known to everyone. $ n $ Sith take part in the Tournament. The Tournament starts with the random choice of two Sith who will fight in the first battle. As one of them loses, his place is taken by the next randomly chosen Sith who didn't fight before. Does it need to be said that each battle in the Sith Tournament ends with a death of one of opponents? The Tournament ends when the only Sith remains alive.

Jedi Ivan accidentally appeared in the list of the participants in the Sith Tournament. However, his skills in the Light Side of the Force are so strong so he can influence the choice of participants either who start the Tournament or who take the loser's place after each battle. Of course, he won't miss his chance to take advantage of it. Help him to calculate the probability of his victory.

## æ ·ä¾‹ #1

### è¾“å…¥

```
3
0.0 0.5 0.8
0.5 0.0 0.4
0.2 0.6 0.0
```

### è¾“å‡º

```
0.680000000000000
```

# AIåˆ†æç»“æœ

# ğŸ’¡ Kayçš„C++ç®—æ³•è§£æï¼šAnother Sith Tournament æ·±å…¥å­¦ä¹ æŒ‡å— ğŸ’¡


## 1. é¢˜ç›®è§£è¯»ä¸æ ¸å¿ƒç®—æ³•è¯†åˆ«

âœ¨ **æœ¬é¢˜ä¸»è¦è€ƒå¯Ÿ**ï¼šçŠ¶æ€å‹ç¼©åŠ¨æ€è§„åˆ’ï¼ˆçŠ¶å‹DPï¼‰

ğŸ—£ï¸ **åˆæ­¥åˆ†æ**ï¼š  
è§£å†³ã€ŒAnother Sith Tournamentã€çš„å…³é”®ï¼Œæ˜¯ç”¨**çŠ¶å‹DP**å°†â€œå­˜æ´»çš„Sithé›†åˆâ€è½¬åŒ–ä¸ºäºŒè¿›åˆ¶â€œå¿«ç…§â€â€”â€”æ¯”å¦‚ç”¨æ•´æ•°`mask`çš„ç¬¬`i`ä½ï¼ˆ`1<<i`ï¼‰è¡¨ç¤ºç¬¬`i`ä¸ªSithæ˜¯å¦è¿˜æ´»ç€ï¼ˆ1=å­˜æ´»ï¼Œ0=æ­»äº¡ï¼‰ã€‚è¿™ç§æ–¹æ³•ç‰¹åˆ«é€‚åˆ`nâ‰¤18`çš„å°è§„æ¨¡é—®é¢˜ï¼ˆå› ä¸º`2^18=262144`ï¼Œè®¡ç®—é‡å¯æ§ï¼‰ã€‚  

### æ ¸å¿ƒæ€è·¯ï¼šå€’æ¨DP
æ­£æ¨ï¼ˆä»æ‰€æœ‰Sithå­˜æ´»å¼€å§‹ï¼‰ä¼šé‡åˆ°â€œå†³æ–—é¡ºåºæ— æ³•é¢„æµ‹â€çš„é—®é¢˜ï¼Œ**å€’æ¨**åˆ™æ›´ç®€å•â€”â€”ä»â€œåªæœ‰1å·ï¼ˆIvanï¼‰æ´»ç€â€çš„æœ€ç»ˆèƒœåˆ©çŠ¶æ€å‡ºå‘ï¼Œé€æ­¥æ·»åŠ å…¶ä»–Sithï¼Œè®¡ç®—æ¯ä¸ªâ€œå­˜æ´»é›†åˆ+å½“å‰æ“‚ä¸»â€çŠ¶æ€ä¸‹Ivanè·èƒœçš„æœ€å¤§æ¦‚ç‡ã€‚  

### æ ¸å¿ƒç®—æ³•æµç¨‹
1. **çŠ¶æ€å®šä¹‰**ï¼š`f[mask][k]`è¡¨ç¤º**å­˜æ´»é›†åˆä¸º`mask`**ã€**å½“å‰æ“‚ä¸»æ˜¯`k`**æ—¶ï¼ŒIvanè·èƒœçš„æœ€å¤§æ¦‚ç‡ã€‚  
2. **è¾¹ç•Œæ¡ä»¶**ï¼šå½“`mask`åªæœ‰1å·ï¼ˆ`mask=1`ï¼ŒäºŒè¿›åˆ¶`001`ï¼‰æ—¶ï¼Œ`f[1][0] = 1.0`ï¼ˆIvanå·²èµ¢ï¼‰ï¼›è‹¥`mask`ä¸­æ²¡æœ‰1å·ï¼Œæ¦‚ç‡ä¸º0ã€‚  
3. **è½¬ç§»æ–¹ç¨‹**ï¼šå¯¹`mask`ä¸­çš„ä»»æ„ä¸¤ä¸ªå­˜æ´»è€…`k`ï¼ˆæ“‚ä¸»ï¼‰å’Œ`j`ï¼ˆæŒ‘æˆ˜è€…ï¼‰ï¼Œå–ä¸¤ç§æƒ…å†µçš„æœ€å¤§å€¼ï¼š  
   - `k`èµ¢`j`ï¼šæ¦‚ç‡ä¸º`p[k][j]`ï¼ŒçŠ¶æ€å˜ä¸º`mask`å»æ‰`j`ï¼ˆ`mask ^ (1<<j)`ï¼‰ï¼Œæ“‚ä¸»ä»ä¸º`k`ï¼Œè´¡çŒ®`f[mask^ (1<<j)][k] * p[k][j]`ã€‚  
   - `j`èµ¢`k`ï¼šæ¦‚ç‡ä¸º`p[j][k]`ï¼ŒçŠ¶æ€å˜ä¸º`mask`å»æ‰`k`ï¼ˆ`mask ^ (1<<k)`ï¼‰ï¼Œæ“‚ä¸»å˜ä¸º`j`ï¼Œè´¡çŒ®`f[mask^ (1<<k)][j] * p[j][k]`ã€‚  
   æœ€ç»ˆ`f[mask][k] = max(f[mask][k], ä¸Šè¿°ä¸¤è€…ä¹‹å’Œ)`ã€‚  

### å¯è§†åŒ–è®¾è®¡æ€è·¯
ç”¨**8ä½åƒç´ é£æ ¼**æ¨¡æ‹ŸFCæ¸¸æˆç•Œé¢ï¼š  
- ç”¨ä¸åŒé¢œè‰²çš„åƒç´ å—è¡¨ç¤ºSithï¼ˆæ¯”å¦‚1å·æ˜¯çº¢è‰²ï¼Œå…¶ä»–æ˜¯è“/ç»¿ï¼‰ï¼›  
- ç”¨ä¸€æ’â€œå°ç¯â€æ˜¾ç¤º`mask`çš„äºŒè¿›åˆ¶çŠ¶æ€ï¼ˆäº®=å­˜æ´»ï¼‰ï¼›  
- é«˜äº®å½“å‰æ“‚ä¸»ï¼ˆé—ªçƒæˆ–è¾¹æ¡†ï¼‰ï¼Œå†³æ–—æ—¶æ’­æ”¾â€œé”µâ€çš„éŸ³æ•ˆï¼Œè®¡ç®—å®Œæ¦‚ç‡æ’­æ”¾â€œå®â€çš„éŸ³æ•ˆï¼›  
- è‡ªåŠ¨æ¼”ç¤ºæ—¶ï¼Œåƒâ€œè´ªåƒè›‡AIâ€ä¸€æ ·é€æ­¥æ·»åŠ Sithï¼Œæœ€ç»ˆæ˜¾ç¤ºâ€œèƒœåˆ©â€åŠ¨ç”»å’ŒéŸ³æ•ˆã€‚


## 2. ç²¾é€‰ä¼˜è´¨é¢˜è§£å‚è€ƒ

### é¢˜è§£ä¸€ï¼š_edge_ï¼ˆèµ10ï¼‰
* **ç‚¹è¯„**ï¼š  
  è¿™æ˜¯æœ€ç»å…¸çš„å€’æ¨çŠ¶å‹DPå®ç°ï¼ŒçŠ¶æ€å®šä¹‰`f[mask][k]`ï¼ˆå­˜æ´»é›†åˆ+æ“‚ä¸»ï¼‰**ç²¾å‡†è¦†ç›–é—®é¢˜æ ¸å¿ƒ**ã€‚ä»£ç é€»è¾‘æ¸…æ™°ï¼Œè¾¹ç•Œæ¡ä»¶ï¼ˆ`f[1][0] = 1.0`ï¼‰å’Œè½¬ç§»æ–¹ç¨‹å®Œå…¨ç¬¦åˆé—®é¢˜è¦æ±‚ã€‚æ—¶é—´å¤æ‚åº¦`O(2^n * nÂ²)`ï¼ˆ`n=18`æ—¶çº¦8e6æ¬¡è¿ç®—ï¼‰ï¼Œé«˜æ•ˆä¸”æ­£ç¡®ã€‚äº®ç‚¹æ˜¯**å€’æ¨æ€è·¯çš„åº”ç”¨**ï¼Œé¿å…äº†æ­£æ¨çš„æ··ä¹±ï¼Œéå¸¸é€‚åˆæ–°æ‰‹ç†è§£ã€‚

### é¢˜è§£äºŒï¼šLoop1stï¼ˆèµ4ï¼‰
* **ç‚¹è¯„**ï¼š  
  å°†çŠ¶æ€ç®€åŒ–ä¸º`dp[mask]`ï¼ˆä»…å­˜æ´»é›†åˆï¼‰ï¼Œæ›´ç®€æ´ã€‚è½¬ç§»æ–¹ç¨‹ç›´æ¥æšä¸¾`mask`ä¸­çš„ä¸¤ä¸ªå­˜æ´»è€…ï¼Œå–æœ€å¤§æ¦‚ç‡ã€‚ä»£ç çŸ­å°ç²¾æ‚ï¼Œå˜é‡å‘½åï¼ˆå¦‚`a[i][j]`è¡¨ç¤º`i`èµ¢`j`çš„æ¦‚ç‡ï¼‰æ¸…æ™°æ˜“æ‡‚ã€‚äº®ç‚¹æ˜¯**çŠ¶æ€ç®€åŒ–**â€”â€”ç”¨`dp[mask]`éšå«æ‰€æœ‰å¯èƒ½çš„æ“‚ä¸»ï¼Œå‡å°‘äº†ä¸€ç»´æ•°ç»„ï¼Œæé«˜äº†å¯è¯»æ€§ã€‚

### é¢˜è§£ä¸‰ï¼šilibilibï¼ˆèµ2ï¼‰
* **ç‚¹è¯„**ï¼š  
  ç”¨**è®°å¿†åŒ–æœç´¢**å®ç°çŠ¶å‹DPï¼Œæ€è·¯æ›´è‡ªç„¶ã€‚é€’å½’å‡½æ•°`dfs(mask)`è¿”å›`mask`çŠ¶æ€ä¸‹Ivanè·èƒœçš„æœ€å¤§æ¦‚ç‡ï¼Œç»ˆæ­¢æ¡ä»¶æ˜ç¡®ï¼ˆ`mask`åªæœ‰1å·æ—¶è¿”å›1ï¼Œæ— 1å·æ—¶è¿”å›0ï¼‰ã€‚`vis`æ•°ç»„é¿å…é‡å¤è®¡ç®—ï¼Œæ•ˆç‡ä¸è¿­ä»£DPä¸€è‡´ã€‚äº®ç‚¹æ˜¯**å°†DPè½¬åŒ–ä¸ºé€’å½’**ï¼Œæ›´ç¬¦åˆäººç±»â€œä»å¤§é—®é¢˜æ‹†å°é—®é¢˜â€çš„æ€ç»´ä¹ æƒ¯ã€‚


## 3. æ ¸å¿ƒéš¾ç‚¹è¾¨æä¸è§£é¢˜ç­–ç•¥

### 1. çŠ¶æ€å®šä¹‰ï¼šä¸ºä»€ä¹ˆè¦è®°å½•â€œæ“‚ä¸»â€ï¼Ÿ
- **éš¾ç‚¹**ï¼šæœ€åˆå¯èƒ½å¿½ç•¥â€œæ“‚ä¸»â€â€”â€”ä½†é¢˜ç›®æ˜¯â€œæ“‚å°åˆ¶â€ï¼Œæ¯è½®æ˜¯æ“‚ä¸»ä¸æ–°é€‰æ‰‹å†³æ–—ï¼Œå¿…é¡»è®°å½•å½“å‰æ“‚ä¸»æ‰èƒ½æ­£ç¡®è®¡ç®—æ¦‚ç‡ã€‚  
- **ç­–ç•¥**ï¼š`f[mask][k]`ä¸­çš„`k`ï¼ˆæ“‚ä¸»ï¼‰æ˜¯å…³é”®ï¼Œå¦åˆ™æ— æ³•åŒºåˆ†â€œè°åœ¨å®ˆæ“‚â€ã€‚ä¾‹å¦‚ï¼Œ`mask=3`ï¼ˆ0å·å’Œ1å·å­˜æ´»ï¼‰æ—¶ï¼Œæ“‚ä¸»æ˜¯0å·æˆ–1å·çš„æ¦‚ç‡å®Œå…¨ä¸åŒã€‚  
- ğŸ’¡ **å­¦ä¹ ç¬”è®°**ï¼šçŠ¶æ€è¦è¦†ç›–æ‰€æœ‰â€œå½±å“ç»“æœçš„å…³é”®ä¿¡æ¯â€ï¼Œå¦åˆ™è½¬ç§»ä¼šå‡ºé”™ã€‚

### 2. è½¬ç§»æ–¹ç¨‹ï¼šä¸ºä»€ä¹ˆå–`max`è€Œä¸æ˜¯æ±‚å’Œï¼Ÿ
- **éš¾ç‚¹**ï¼šå®¹æ˜“æ··æ·†â€œæ¦‚ç‡æ±‚å’Œâ€ï¼ˆéšæœºé¡ºåºï¼‰å’Œâ€œæœ€å¤§æ¦‚ç‡â€ï¼ˆè‡ªä¸»é€‰æ‹©é¡ºåºï¼‰ã€‚  
- **ç­–ç•¥**ï¼šé¢˜ç›®ä¸­Ivanå¯ä»¥**å®‰æ’å†³æ–—é¡ºåº**ï¼Œå› æ­¤æ¯ä¸€æ­¥éƒ½è¦é€‰â€œè®©è‡ªå·±èµ¢æ¦‚ç‡æœ€å¤§â€çš„æ–¹å¼ï¼Œæ‰€ä»¥ç”¨`max`ã€‚å¦‚æœæ˜¯éšæœºé¡ºåºï¼Œæ‰éœ€è¦æ±‚å’Œã€‚  
- ğŸ’¡ **å­¦ä¹ ç¬”è®°**ï¼šè½¬ç§»æ–¹ç¨‹çš„è¿ç®—ï¼ˆ`max/min/+`ï¼‰å–å†³äºé—®é¢˜ç›®æ ‡ã€‚

### 3. è¾¹ç•Œæ¡ä»¶ï¼šå¦‚ä½•åˆå§‹åŒ–ï¼Ÿ
- **éš¾ç‚¹**ï¼šå¿˜è®°å¤„ç†â€œåªæœ‰1å·å­˜æ´»â€æˆ–â€œæ²¡æœ‰1å·å­˜æ´»â€çš„æƒ…å†µï¼Œå¯¼è‡´åç»­è®¡ç®—å…¨é”™ã€‚  
- **ç­–ç•¥**ï¼š`mask=1`ï¼ˆåªæœ‰1å·ï¼‰æ—¶ï¼Œ`f[1][0] = 1.0`ï¼›`mask`ä¸­æ— 1å·æ—¶ï¼Œæ¦‚ç‡ä¸º0ã€‚è¿™æ˜¯DPçš„â€œèµ·ç‚¹â€ï¼Œå¿…é¡»æ­£ç¡®ã€‚  
- ğŸ’¡ **å­¦ä¹ ç¬”è®°**ï¼šè¾¹ç•Œæ¡ä»¶æ˜¯DPçš„åŸºç¡€ï¼Œä¸€å®šè¦â€œæä½å¤´å°¾â€ã€‚

### âœ¨ è§£é¢˜æŠ€å·§æ€»ç»“
1. **çŠ¶å‹DPé€‚ç”¨åœºæ™¯**ï¼š`nâ‰¤20`ï¼Œä¸”é—®é¢˜å¯è½¬åŒ–ä¸ºâ€œå­é›†çŠ¶æ€â€ï¼ˆå¦‚å­˜æ´»é›†åˆã€è®¿é—®åŸå¸‚é›†åˆï¼‰ã€‚  
2. **å€’æ¨æ¯”æ­£æ¨ç®€å•**ï¼šå½“æœ€ç»ˆçŠ¶æ€æ˜ç¡®æ—¶ï¼ˆå¦‚â€œåªæœ‰1å·æ´»ç€â€ï¼‰ï¼Œå€’æ¨èƒ½é¿å…æ­£æ¨çš„ä¸ç¡®å®šæ€§ã€‚  
3. **çŠ¶æ€ç®€åŒ–**ï¼šè‹¥æŸäº›ä¿¡æ¯å¯éšå«ï¼ˆå¦‚`dp[mask]`éšå«æ“‚ä¸»ï¼‰ï¼Œå¯å‡å°‘æ•°ç»„ç»´åº¦ï¼Œæé«˜å¯è¯»æ€§ã€‚


## 4. C++æ ¸å¿ƒä»£ç å®ç°èµæ

### æœ¬é¢˜é€šç”¨æ ¸å¿ƒC++å®ç°å‚è€ƒ
* **è¯´æ˜**ï¼šç»¼åˆ_edge_çš„é¢˜è§£ï¼Œä¿ç•™æœ€æ¸…æ™°çš„çŠ¶æ€å®šä¹‰ï¼ˆ`f[mask][k]`ï¼‰å’Œè½¬ç§»é€»è¾‘ï¼Œé€‚åˆæ–°æ‰‹å­¦ä¹ ã€‚  
* **å®Œæ•´æ ¸å¿ƒä»£ç **ï¼š
```cpp
#include <iostream>
#include <cstdio>
#include <algorithm>
using namespace std;

const int MAX_N = 20;
int n;
double p[MAX_N][MAX_N];       // p[i][j]: ièµ¢jçš„æ¦‚ç‡
double f[1 << MAX_N][MAX_N];   // f[mask][k]: å­˜æ´»é›†åˆmaskï¼Œæ“‚ä¸»kæ—¶çš„æœ€å¤§æ¦‚ç‡

int main() {
    cin >> n;
    for (int i = 0; i < n; ++i) {
        for (int j = 0; j < n; ++j) {
            cin >> p[i][j];
        }
    }

    // åˆå§‹åŒ–ï¼šåªæœ‰0å·ï¼ˆIvanï¼‰å­˜æ´»ï¼Œæ¦‚ç‡1.0
    f[1][0] = 1.0;

    // æšä¸¾æ‰€æœ‰å­˜æ´»é›†åˆmaskï¼ˆä»2åˆ°2^n-1ï¼‰
    for (int mask = 2; mask < (1 << n); ++mask) {
        // æšä¸¾å½“å‰æ“‚ä¸»kï¼ˆå¿…é¡»åœ¨maskä¸­ï¼‰
        for (int k = 0; k < n; ++k) {
            if (!(mask & (1 << k))) continue;
            // æšä¸¾æŒ‘æˆ˜è€…jï¼ˆå¿…é¡»åœ¨maskä¸­ä¸”â‰ kï¼‰
            for (int j = 0; j < n; ++j) {
                if (!(mask & (1 << j)) || j == k) continue;
                // è½¬ç§»æ–¹ç¨‹ï¼šå–ä¸¤ç§æƒ…å†µçš„æœ€å¤§å€¼
                double current = f[mask ^ (1 << j)][k] * p[k][j] + 
                                 f[mask ^ (1 << k)][j] * p[j][k];
                f[mask][k] = max(f[mask][k], current);
            }
        }
    }

    // ç­”æ¡ˆï¼šæ‰€æœ‰å¯èƒ½çš„æ“‚ä¸»ä¸­çš„æœ€å¤§å€¼
    double ans = 0.0;
    for (int i = 0; i < n; ++i) {
        ans = max(ans, f[(1 << n) - 1][i]);
    }
    printf("%.19lf\n", ans);
    return 0;
}
```
* **ä»£ç è§£è¯»æ¦‚è¦**ï¼š  
  1. **è¾“å…¥å¤„ç†**ï¼šè¯»å–`n`å’Œæ¦‚ç‡çŸ©é˜µ`p[i][j]`ã€‚  
  2. **åˆå§‹åŒ–**ï¼š`mask=1`ï¼ˆåªæœ‰0å·ï¼‰æ—¶ï¼Œ`f[1][0] = 1.0`ã€‚  
  3. **è½¬ç§»è®¡ç®—**ï¼šæšä¸¾æ‰€æœ‰`mask`ã€æ“‚ä¸»`k`å’ŒæŒ‘æˆ˜è€…`j`ï¼Œè®¡ç®—æœ€å¤§æ¦‚ç‡ã€‚  
  4. **ç»“æœè¾“å‡º**ï¼šéå†æ‰€æœ‰æ“‚ä¸»ï¼Œå–`mask=2^n-1`ï¼ˆæ‰€æœ‰Sithå­˜æ´»ï¼‰æ—¶çš„æœ€å¤§å€¼ã€‚


### ä¼˜è´¨é¢˜è§£ç‰‡æ®µèµæ

#### é¢˜è§£ä¸€ï¼š_edge_çš„æ ¸å¿ƒè½¬ç§»é€»è¾‘
* **äº®ç‚¹**ï¼šå€’æ¨DPçš„æ ‡å‡†å®ç°ï¼ŒçŠ¶æ€å®šä¹‰æ˜ç¡®ã€‚  
* **æ ¸å¿ƒä»£ç ç‰‡æ®µ**ï¼š
```cpp
for (int mask = 2; mask < (1 << n); ++mask) {
    for (int k = 0; k < n; ++k) {
        if (!(mask & (1 << k))) continue;
        for (int j = 0; j < n; ++j) {
            if (!(mask & (1 << j)) || j == k) continue;
            f[mask][k] = max(f[mask][k], 
                f[mask ^ (1 << j)][k] * p[k][j] + 
                f[mask ^ (1 << k)][j] * p[j][k]);
        }
    }
}
```
* **ä»£ç è§£è¯»**ï¼š  
  è¿™æ®µä»£ç æ˜¯çŠ¶å‹DPçš„æ ¸å¿ƒâ€”â€”æšä¸¾æ‰€æœ‰å¯èƒ½çš„`mask`ã€æ“‚ä¸»`k`å’ŒæŒ‘æˆ˜è€…`j`ï¼Œè®¡ç®—ä¸¤ç§å†³æ–—ç»“æœçš„æœ€å¤§æ¦‚ç‡ã€‚ä¾‹å¦‚ï¼Œå½“`mask=7`ï¼ˆæ‰€æœ‰3äººå­˜æ´»ï¼‰ã€`k=1`ï¼ˆæ“‚ä¸»æ˜¯1å·ï¼‰ã€`j=2`ï¼ˆæŒ‘æˆ˜è€…æ˜¯2å·ï¼‰æ—¶ï¼Œä¼šè®¡ç®—â€œ1å·èµ¢2å·â€å’Œâ€œ2å·èµ¢1å·â€çš„æ¦‚ç‡ä¹‹å’Œï¼Œå¹¶å–æœ€å¤§å€¼ã€‚  
* ğŸ’¡ **å­¦ä¹ ç¬”è®°**ï¼šå€’æ¨DPçš„è½¬ç§»è¦è¦†ç›–æ‰€æœ‰å‰é©±çŠ¶æ€ï¼Œå–æœ€ä¼˜å€¼ã€‚

#### é¢˜è§£äºŒï¼šLoop1stçš„ç®€åŒ–çŠ¶æ€
* **äº®ç‚¹**ï¼šç”¨`dp[mask]`ç®€åŒ–çŠ¶æ€ï¼Œä»£ç æ›´ç®€æ´ã€‚  
* **æ ¸å¿ƒä»£ç ç‰‡æ®µ**ï¼š
```cpp
for (int i = 2; i <= (1 << n) - 1; ++i) {
    for (int j = 1; j <= n; ++j) {
        for (int k = 1; k <= n; ++k) {
            if (j != k && (i & (1 << (j-1))) && (i & (1 << (k-1)))) {
                dp[i] = max(dp[i], 
                    dp[i - (1 << (j-1))] * a[k][j] + 
                    dp[i - (1 << (k-1))] * a[j][k]);
            }
        }
    }
}
```
* **ä»£ç è§£è¯»**ï¼š  
  `dp[i]`è¡¨ç¤ºå­˜æ´»é›†åˆ`i`æ—¶çš„æœ€å¤§æ¦‚ç‡ï¼Œæšä¸¾`i`ä¸­çš„ä¸¤ä¸ªå­˜æ´»è€…`j`å’Œ`k`ï¼Œç›´æ¥è®¡ç®—è½¬ç§»ã€‚ä¾‹å¦‚ï¼Œ`i=7`æ—¶ï¼Œ`j=1`ã€`k=2`çš„è½¬ç§»ä¼šè¦†ç›–â€œ1å·å’Œ2å·å†³æ–—â€çš„æ‰€æœ‰æƒ…å†µã€‚  
* ğŸ’¡ **å­¦ä¹ ç¬”è®°**ï¼šçŠ¶æ€ç®€åŒ–çš„å…³é”®æ˜¯â€œéšå«ä¸å¿…è¦çš„ç»†èŠ‚â€ï¼ˆå¦‚æ“‚ä¸»ï¼‰ï¼Œä½†è¦ç¡®ä¿è½¬ç§»æ­£ç¡®ã€‚

#### é¢˜è§£ä¸‰ï¼šilibilibçš„è®°å¿†åŒ–æœç´¢
* **äº®ç‚¹**ï¼šé€’å½’å®ç°æ›´ç¬¦åˆäººç±»æ€ç»´ã€‚  
* **æ ¸å¿ƒä»£ç ç‰‡æ®µ**ï¼š
```cpp
double dfs(int mask) {
    if (!(mask & 1)) return 0;   // æ— 1å·ï¼Œæ¦‚ç‡0
    if (mask == 1) return 1;     // åªæœ‰1å·ï¼Œæ¦‚ç‡1
    if (vis[mask]) return dp[mask];
    for (int i = 0; i < n; ++i) {
        if (mask & (1 << i)) {
            for (int j = 0; j < n; ++j) {
                if ((mask & (1 << j)) && i != j) {
                    dp[mask] = max(dp[mask], 
                        dfs(mask ^ (1 << i)) * tu[j][i] + 
                        dfs(mask ^ (1 << j)) * tu[i][j]);
                }
            }
        }
    }
    vis[mask] = true;
    return dp[mask];
}
```
* **ä»£ç è§£è¯»**ï¼š  
  `dfs(mask)`é€’å½’è®¡ç®—`mask`çŠ¶æ€çš„æœ€å¤§æ¦‚ç‡ï¼Œç»ˆæ­¢æ¡ä»¶æ˜ç¡®ã€‚`vis`æ•°ç»„é¿å…é‡å¤è®¡ç®—ï¼Œæ•ˆç‡ä¸è¿­ä»£DPä¸€è‡´ã€‚ä¾‹å¦‚ï¼Œ`mask=7`æ—¶ï¼Œä¼šé€’å½’è®¡ç®—`mask=5`ï¼ˆå»æ‰2å·ï¼‰å’Œ`mask=3`ï¼ˆå»æ‰1å·ï¼‰çš„æ¦‚ç‡ã€‚  
* ğŸ’¡ **å­¦ä¹ ç¬”è®°**ï¼šè®°å¿†åŒ–æœç´¢æ˜¯DPçš„â€œé€’å½’ç‰ˆâ€ï¼Œé€‚åˆçŠ¶æ€è½¬ç§»å¤æ‚çš„é—®é¢˜ã€‚


## 5. ç®—æ³•å¯è§†åŒ–ï¼šåƒç´ åŠ¨ç”»æ¼”ç¤º (æ ¸å¿ƒéƒ¨åˆ†)

### åŠ¨ç”»æ¼”ç¤ºä¸»é¢˜ï¼šåƒç´ Sithçš„å†³æ–—æ“‚å°
**è®¾è®¡æ€è·¯**ï¼šç”¨8ä½åƒç´ é£æ ¼æ¨¡æ‹ŸFCæ¸¸æˆï¼Œè®©ç®—æ³•â€œåŠ¨èµ·æ¥â€â€”â€”é€šè¿‡è§†è§‰å’ŒéŸ³æ•ˆå¼ºåŒ–å…³é”®æ­¥éª¤ï¼Œç”¨â€œé—¯å…³â€å¢åŠ è¶£å‘³æ€§ã€‚

### æ ¸å¿ƒæ¼”ç¤ºå†…å®¹
1. **åœºæ™¯åˆå§‹åŒ–**ï¼š  
   - å·¦ä¾§ï¼š3ä¸ªâ€œå°ç¯â€è¡¨ç¤º`mask`çš„äºŒè¿›åˆ¶çŠ¶æ€ï¼ˆäº®=å­˜æ´»ï¼‰ï¼›  
   - ä¸­é—´ï¼šæ“‚å°ï¼ˆå¤§æ–¹å—ï¼‰ï¼Œæ˜¾ç¤ºå½“å‰æ“‚ä¸»ï¼ˆçº¢è‰²=1å·ï¼Œè“è‰²=å…¶ä»–ï¼‰ï¼›  
   - å³ä¾§ï¼šæ˜¾ç¤ºå½“å‰æ¦‚ç‡å’Œæ“ä½œæç¤ºï¼›  
   - æ§åˆ¶é¢æ¿ï¼šâ€œå¼€å§‹/æš‚åœâ€â€œå•æ­¥â€â€œé‡ç½®â€æŒ‰é’®ï¼Œé€Ÿåº¦æ»‘å—ï¼ˆæ…¢â†’å¿«ï¼‰ã€‚  
   - èƒŒæ™¯éŸ³ä¹ï¼š8ä½é£æ ¼çš„è½»å¿«BGMï¼ˆå¦‚ã€Šè¶…çº§é©¬é‡Œå¥¥ã€‹çš„èƒŒæ™¯éŸ³ä¹ï¼‰ã€‚

2. **åˆå§‹çŠ¶æ€**ï¼š  
   - `mask=1`ï¼ˆå°ç¯1äº®ï¼‰ï¼Œæ“‚å°æ˜¾ç¤ºçº¢è‰²åƒç´ å—ï¼ˆ1å·ï¼‰ï¼Œå³ä¾§æ˜¾ç¤ºâ€œæ“‚ä¸»ï¼š1å·ï¼Œæ¦‚ç‡ï¼š1.0â€ã€‚  
   - æ—ç™½ï¼šâ€œç°åœ¨æ˜¯åˆå§‹çŠ¶æ€ï¼Œåªæœ‰Ivanæ´»ç€ï¼Œè·èƒœæ¦‚ç‡100%ï¼â€

3. **æ·»åŠ 1å·Sithï¼ˆmask=3ï¼‰**ï¼š  
   - å°ç¯1ã€2äº®ï¼Œæ“‚å°æ˜¾ç¤º1å·ï¼ˆçº¢ï¼‰å’Œ2å·ï¼ˆè“ï¼‰ï¼›  
   - æ’­æ”¾â€œé”µâ€çš„éŸ³æ•ˆï¼Œæ¼”ç¤ºå†³æ–—ï¼š1å·èµ¢çš„æ¦‚ç‡0.5ï¼Œè´¡çŒ®`1.0*0.5=0.5`ï¼›2å·èµ¢çš„æ¦‚ç‡0.5ï¼Œä½†æ­¤æ—¶1å·æ­»äº¡ï¼Œè´¡çŒ®0ï¼›  
   - é«˜äº®1å·ï¼Œå³ä¾§æ˜¾ç¤ºâ€œæ¦‚ç‡ï¼š0.5â€ï¼›  
   - æ—ç™½ï¼šâ€œæ·»åŠ 2å·Sithï¼1å·èµ¢çš„æ¦‚ç‡æ˜¯50%ï¼Œæ‰€ä»¥å½“å‰æ¦‚ç‡æ˜¯0.5ã€‚â€

4. **æ·»åŠ 2å·Sithï¼ˆmask=7ï¼‰**ï¼š  
   - å°ç¯å…¨äº®ï¼Œæ“‚å°æ˜¾ç¤º1å·ï¼ˆçº¢ï¼‰ã€2å·ï¼ˆè“ï¼‰ã€3å·ï¼ˆç»¿ï¼‰ï¼›  
   - å¤„ç†æ“‚ä¸»2å·å’Œ3å·çš„æƒ…å†µï¼š  
     - 2å·èµ¢3å·çš„æ¦‚ç‡0.4ï¼Œè´¡çŒ®`0.5*0.4=0.2`ï¼›  
     - 3å·èµ¢2å·çš„æ¦‚ç‡0.6ï¼Œè´¡çŒ®`0.8*0.6=0.48`ï¼›  
     - æ€»å’Œ0.68ï¼Œé«˜äº®2å·ï¼›  
   - æ’­æ”¾â€œå®â€çš„éŸ³æ•ˆï¼Œå³ä¾§æ˜¾ç¤ºâ€œæ¦‚ç‡ï¼š0.68â€ï¼›  
   - æ—ç™½ï¼šâ€œæ·»åŠ 3å·Sithï¼2å·å’Œ3å·å†³æ–—ï¼Œæ€»æ¦‚ç‡æ˜¯0.68â€”â€”è¿™æ˜¯ç›®å‰çš„æœ€å¤§å€¼ï¼â€

5. **æœ€ç»ˆç»“æœ**ï¼š  
   - æ‰€æœ‰Sithæ·»åŠ å®Œæ¯•ï¼Œå³ä¾§æ˜¾ç¤ºâ€œæœ€ç»ˆæ¦‚ç‡ï¼š0.68â€ï¼›  
   - æ’­æ”¾â€œèƒœåˆ©â€éŸ³æ•ˆï¼ˆå¦‚ã€Šé­‚æ–—ç½—ã€‹çš„é€šå…³éŸ³ä¹ï¼‰ï¼Œæ“‚å°æ˜¾ç¤º1å·æ¬¢å‘¼çš„åŠ¨ç”»ï¼›  
   - æ—ç™½ï¼šâ€œæ‰€æœ‰Sithéƒ½è¢«å‡»è´¥ï¼ŒIvanè·èƒœå•¦ï¼â€

### äº¤äº’è®¾è®¡
- **å•æ­¥æ‰§è¡Œ**ï¼šç‚¹å‡»â€œå•æ­¥â€æŒ‰é’®ï¼Œæ‰§è¡Œä¸€æ­¥è½¬ç§»ï¼Œæ˜¾ç¤ºå½“å‰`mask`ã€æ“‚ä¸»å’Œæ¦‚ç‡è®¡ç®—ï¼›  
- **è‡ªåŠ¨æ’­æ”¾**ï¼šç‚¹å‡»â€œè‡ªåŠ¨æ’­æ”¾â€æŒ‰é’®ï¼ŒæŒ‰é€Ÿåº¦æ»‘å—çš„è®¾ç½®ä¾æ¬¡æ‰§è¡Œæ‰€æœ‰æ­¥éª¤ï¼›  
- **é‡ç½®**ï¼šæ¢å¤åˆå§‹çŠ¶æ€ï¼Œé‡æ–°å¼€å§‹æ¼”ç¤ºï¼›  
- **éŸ³æ•ˆæ§åˆ¶**ï¼šå¯å¼€å…³èƒŒæ™¯éŸ³ä¹å’Œæ“ä½œéŸ³æ•ˆã€‚


## 6. æ‹“å±•ç»ƒä¹ ä¸ç›¸ä¼¼é—®é¢˜æ€è€ƒ

### é€šç”¨æ€è·¯/æŠ€å·§è¿ç§»
çŠ¶å‹DPçš„æ ¸å¿ƒæ˜¯â€œç”¨äºŒè¿›åˆ¶è¡¨ç¤ºå­é›†çŠ¶æ€â€ï¼Œé€‚ç”¨äºä»¥ä¸‹åœºæ™¯ï¼š  
1. **æ—…è¡Œå•†é—®é¢˜ï¼ˆTSPï¼‰**ï¼šç”¨äºŒè¿›åˆ¶è¡¨ç¤ºå·²è®¿é—®çš„åŸå¸‚ï¼Œè®¡ç®—æœ€çŸ­è·¯å¾„ï¼›  
2. **å­é›†æ±‚å’Œé—®é¢˜**ï¼šç”¨äºŒè¿›åˆ¶è¡¨ç¤ºå·²é€‰å…ƒç´ ï¼Œè®¡ç®—æ»¡è¶³å’Œä¸ºç›®æ ‡å€¼çš„æ–¹æ¡ˆæ•°ï¼›  
3. **åšå¼ˆé—®é¢˜**ï¼šç”¨äºŒè¿›åˆ¶è¡¨ç¤ºæ£‹ç›˜çŠ¶æ€ï¼Œè®¡ç®—å¿…èƒœç­–ç•¥ã€‚

### æ´›è°·ç»ƒä¹ æ¨è
1. **æ´›è°· P1896 [SCOI2005]äº’ä¸ä¾µçŠ¯**  
   ğŸ—£ï¸ **æ¨èç†ç”±**ï¼šçŠ¶å‹DPç»å…¸é¢˜ï¼Œç”¨äºŒè¿›åˆ¶è¡¨ç¤ºå›½ç‹çš„ä½ç½®ï¼Œè®¡ç®—æ”¾ç½®å›½ç‹çš„æ–¹æ¡ˆæ•°ã€‚å·©å›ºçŠ¶æ€å®šä¹‰å’Œè½¬ç§»ã€‚  
2. **æ´›è°· P2167 [SDOI2009]Billçš„æŒ‘æˆ˜**  
   ğŸ—£ï¸ **æ¨èç†ç”±**ï¼šçŠ¶å‹DPä¸å­—ç¬¦ä¸²ç»“åˆï¼Œç”¨äºŒè¿›åˆ¶è¡¨ç¤ºåŒ¹é…çš„å­—ç¬¦ä¸²é›†åˆï¼Œè®¡ç®—æ»¡è¶³æ¡ä»¶çš„æ–¹æ¡ˆæ•°ã€‚ç»ƒä¹ è·¨æ¨¡å—ç»“åˆã€‚  
3. **æ´›è°· P3959 å®è—**  
   ğŸ—£ï¸ **æ¨èç†ç”±**ï¼šçŠ¶å‹DPè¿›é˜¶é¢˜ï¼Œç”¨äºŒè¿›åˆ¶è¡¨ç¤ºå·²å¼€å‘çš„èŠ‚ç‚¹ï¼Œè®¡ç®—æŒ–æ˜å®è—çš„æœ€å°costã€‚å­¦ä¹ ä¼˜åŒ–æŠ€å·§ã€‚  
4. **æ´›è°· P4151 [WC2011]æœ€å¤§XORå’Œè·¯å¾„**  
   ğŸ—£ï¸ **æ¨èç†ç”±**ï¼šè™½ç„¶ä¸æ˜¯çŠ¶å‹DPï¼Œä½†ç”¨åˆ°â€œçŠ¶æ€è¡¨ç¤ºâ€æ€æƒ³ï¼Œç”¨å¼‚æˆ–å’Œè¡¨ç¤ºè·¯å¾„çŠ¶æ€ï¼Œæ‹“å±•æ€ç»´ã€‚


## 7. å­¦ä¹ å¿ƒå¾—ä¸ç»éªŒåˆ†äº« (è‹¥æœ‰)
æœ¬æ¬¡åˆ†æçš„é¢˜è§£ä¸­ï¼Œ_edge_æåˆ°â€œå€’ç€è¿›è¡ŒDPçš„è¯å¯ä»¥è€ƒè™‘åˆ—å‡ºçŠ¶æ€â€ï¼Œè¿™æé†’æˆ‘ä»¬ï¼š**å½“æ­£æ¨å›°éš¾æ—¶ï¼Œä¸å¦¨å°è¯•å€’æ¨**â€”â€”ä»æœ€ç»ˆçŠ¶æ€å‡ºå‘ï¼Œé€æ­¥æ‹†è§£é—®é¢˜ã€‚Loop1stçš„é¢˜è§£åˆ™å‘Šè¯‰æˆ‘ä»¬ï¼š**çŠ¶æ€å¯ä»¥ç®€åŒ–**ï¼Œä¸å¿…åŒ…å«æ‰€æœ‰ç»†èŠ‚ï¼Œåªè¦èƒ½æ­£ç¡®è½¬ç§»å³å¯ã€‚ilibilibçš„è®°å¿†åŒ–æœç´¢åˆ™è¯´æ˜ï¼š**DPçš„å®ç°æ–¹å¼å¯ä»¥çµæ´»é€‰æ‹©**ï¼Œé€’å½’æ›´ç¬¦åˆäººç±»æ€ç»´ï¼Œé€‚åˆæ–°æ‰‹ç†è§£ã€‚


## ç»“è¯­
é€šè¿‡æœ¬é¢˜çš„åˆ†æï¼Œæˆ‘ä»¬æŒæ¡äº†çŠ¶å‹DPçš„æ ¸å¿ƒæ€æƒ³ï¼ˆäºŒè¿›åˆ¶çŠ¶æ€ï¼‰ã€å€’æ¨æ–¹æ³•ï¼ˆä»æœ€ç»ˆçŠ¶æ€å‡ºå‘ï¼‰å’Œå…³é”®æŠ€å·§ï¼ˆçŠ¶æ€å®šä¹‰ã€è½¬ç§»æ–¹ç¨‹ã€è¾¹ç•Œæ¡ä»¶ï¼‰ã€‚å¸Œæœ›å¤§å®¶åœ¨åç»­ç»ƒä¹ ä¸­ï¼Œèƒ½çµæ´»è¿ç”¨è¿™äº›æŠ€å·§ï¼Œè§£å†³æ›´å¤šçŠ¶å‹DPé—®é¢˜ï¼ğŸ’ª  

ä¸‹æ¬¡æˆ‘ä»¬å†ä¸€èµ·æ¢ç´¢æ–°çš„ç¼–ç¨‹æŒ‘æˆ˜ï¼

---
å¤„ç†ç”¨æ—¶ï¼š250.92ç§’
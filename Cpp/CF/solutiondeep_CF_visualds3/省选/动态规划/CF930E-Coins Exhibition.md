# é¢˜ç›®ä¿¡æ¯

# Coins Exhibition

## é¢˜ç›®æè¿°

Arkady and Kirill visited an exhibition of rare coins. The coins were located in a row and enumerated from left to right from $ 1 $ to $ k $ , each coin either was laid with its obverse (front) side up, or with its reverse (back) side up.

Arkady and Kirill made some photos of the coins, each photo contained a segment of neighboring coins. Akrady is interested in obverses, so on each photo made by him there is at least one coin with obverse side up. On the contrary, Kirill is interested in reverses, so on each photo made by him there is at least one coin with its reverse side up.

The photos are lost now, but Arkady and Kirill still remember the bounds of the segments of coins each photo contained. Given this information, compute the remainder of division by $ 10^{9}+7 $ of the number of ways to choose the upper side of each coin in such a way, that on each Arkady's photo there is at least one coin with obverse side up, and on each Kirill's photo there is at least one coin with reverse side up.

## è¯´æ˜/æç¤º

In the first example the following ways are possible ('O' â€” obverse, 'R' â€” reverse side):

- OROOR,
- ORORO,
- ORORR,
- RROOR,
- RRORO,
- RRORR,
- ORROR,
- ORRRO.

In the second example the information is contradictory: the second coin should have obverse and reverse sides up at the same time, that is impossible. So, the answer is $ 0 $ .

## æ ·ä¾‹ #1

### è¾“å…¥

```
5 2 2
1 3
3 5
2 2
4 5
```

### è¾“å‡º

```
8
```

## æ ·ä¾‹ #2

### è¾“å…¥

```
5 3 2
1 3
2 2
3 5
2 2
4 5
```

### è¾“å‡º

```
0
```

## æ ·ä¾‹ #3

### è¾“å…¥

```
60 5 7
1 3
50 60
1 60
30 45
20 40
4 5
6 37
5 18
50 55
22 27
25 31
44 45
```

### è¾“å‡º

```
732658600
```

# AIåˆ†æç»“æœ

---
# ğŸ’¡ Kayçš„C++ç®—æ³•è§£æï¼šCoins Exhibition æ·±å…¥å­¦ä¹ æŒ‡å— ğŸ’¡

## å¼•è¨€
ä»Šå¤©æˆ‘ä»¬è¦è§£å†³çš„é—®é¢˜æ˜¯ã€ŒCoins Exhibitionã€â€”â€”ç»™ä½ ä¸€æ’ç¡¬å¸å’Œå¾ˆå¤šç…§ç‰‡çš„åŒºé—´é™åˆ¶ï¼Œéœ€è¦è®¡ç®—åˆæ³•çš„ç¡¬å¸æ­£åæ’åˆ—æ•°ã€‚è¿™é“é¢˜çš„æ ¸å¿ƒæ˜¯**ç”¨åŠ¨æ€è§„åˆ’ï¼ˆDPï¼‰ç»“åˆç¦»æ•£åŒ–å¤„ç†å¤§èŒƒå›´æ•°æ®**ï¼ŒåŒæ—¶å·§å¦™å¤„ç†åŒºé—´é™åˆ¶ã€‚è®©æˆ‘ä»¬ä¸€æ­¥æ­¥æ‹†è§£å®ƒï¼


## 1. é¢˜ç›®è§£è¯»ä¸æ ¸å¿ƒç®—æ³•è¯†åˆ«

âœ¨ **æœ¬é¢˜ä¸»è¦è€ƒå¯Ÿ**ï¼šåŠ¨æ€è§„åˆ’ï¼ˆDPï¼‰+ ç¦»æ•£åŒ– + å‰ç¼€å’Œä¼˜åŒ–  

ğŸ—£ï¸ **åˆæ­¥åˆ†æ**ï¼š  
æƒ³è±¡ä¸€ä¸‹ï¼Œä½ æœ‰ä¸€æ¡1000å…¬é‡Œé•¿çš„è·¯ï¼Œè¦åœ¨ä¸Šé¢æ”¾è·¯ç¯ï¼Œä½†åªæœ‰å‡ ä¸ªå…³é”®è·¯å£éœ€è¦æ£€æŸ¥â€”â€”è¿™å°±æ˜¯**ç¦»æ•£åŒ–**ï¼šæŠŠå¤§èŒƒå›´çš„ã€Œç¡¬å¸ä½ç½®ã€å‹ç¼©æˆå‡ ä¸ªã€Œå…³é”®ç‚¹ã€ï¼ˆæ¯”å¦‚æ‰€æœ‰åŒºé—´çš„ç«¯ç‚¹å’Œç«¯ç‚¹-1ï¼‰ï¼Œåªåœ¨è¿™äº›ç‚¹ä¸Šè®¡ç®—çŠ¶æ€ã€‚  

è€Œ**åŠ¨æ€è§„åˆ’**å°±åƒè®°å½•ä½ èµ°åˆ°æ¯ä¸ªå…³é”®ç‚¹æ—¶çš„çŠ¶æ€ï¼šæ¯”å¦‚â€œæœ€åä¸€ä¸ªæ­£é¢ç¡¬å¸åœ¨å“ªä¸ªå…³é”®ç‚¹â€â€œæœ€åä¸€ä¸ªåé¢ç¡¬å¸åœ¨å“ªä¸ªå…³é”®ç‚¹â€ã€‚è¿™æ ·æˆ‘ä»¬å°±èƒ½å¿«é€Ÿæ£€æŸ¥ï¼šæŸä¸ªåŒºé—´æ˜¯å¦æ»¡è¶³â€œè‡³å°‘æœ‰ä¸€ä¸ªæ­£é¢/åé¢â€â€”â€”åªè¦çœ‹æœ€åä¸€ä¸ªç›¸åé¢çš„ä½ç½®æ˜¯å¦åœ¨åŒºé—´å†…å°±è¡Œï¼  

### æ ¸å¿ƒç®—æ³•æµç¨‹
1. **ç¦»æ•£åŒ–**ï¼šæ”¶é›†æ‰€æœ‰åŒºé—´çš„`l`ã€`r`å’Œ`l-1`ï¼ˆå¤„ç†è¾¹ç•Œï¼‰ï¼Œæ’åºå»é‡å¾—åˆ°å…³é”®ç‚¹åˆ—è¡¨ã€‚  
2. **DPçŠ¶æ€å®šä¹‰**ï¼š`dp[0][i]`è¡¨ç¤ºæœ€åä¸€ä¸ªç¡¬å¸æ˜¯**åé¢ï¼ˆ0ï¼‰**ï¼Œä¸”ä¸Šä¸€ä¸ªæ­£é¢ï¼ˆ1ï¼‰åœ¨ç¦»æ•£åŒ–åçš„ç¬¬`i`ä¸ªå…³é”®ç‚¹çš„æ–¹æ¡ˆæ•°ï¼›`dp[1][i]`ç›¸åã€‚  
3. **çŠ¶æ€è½¬ç§»**ï¼šåœ¨ä¸¤ä¸ªå…³é”®ç‚¹ä¹‹é—´çš„åŒºé—´ï¼Œå¯ä»¥å¡«å…¨0ã€å…¨1ï¼Œæˆ–æ··åˆï¼ˆæœ€åä¸€ä¸ªå›ºå®šï¼‰ã€‚æ¯”å¦‚ï¼š
   - å…¨å¡«0ï¼š`dp[0][i]`ç›´æ¥è½¬ç§»åˆ°ä¸‹ä¸€ä¸ªå…³é”®ç‚¹çš„`dp[0][i]`ã€‚
   - å…¨å¡«1ï¼š`dp[0][i]`è½¬ç§»åˆ°ä¸‹ä¸€ä¸ªå…³é”®ç‚¹çš„`dp[1][å½“å‰å…³é”®ç‚¹]`ã€‚
   - æ··åˆå¡«ï¼šç”¨`2^(åŒºé—´é•¿åº¦-1)-1`è®¡ç®—æ··åˆæ–¹æ¡ˆæ•°ï¼Œè½¬ç§»åˆ°ä¸‹ä¸€ä¸ªå…³é”®ç‚¹çš„`dp[0/1][ä¸‹ä¸€ä¸ªå…³é”®ç‚¹]`ã€‚
4. **å¤„ç†é™åˆ¶**ï¼šå¯¹äºæ¯ä¸ªåŒºé—´é™åˆ¶ï¼ˆæ¯”å¦‚â€œ[l,r]è‡³å°‘æœ‰ä¸€ä¸ª1â€ï¼‰ï¼ŒæŠŠæ‰€æœ‰`dp[0][i]`ä¸­`i < l`çš„çŠ¶æ€ç½®0ï¼ˆå› ä¸ºä¸Šä¸€ä¸ª1åœ¨`l`ä¹‹å‰ï¼Œè¯´æ˜`[l,r]`å…¨0ï¼Œä¸åˆæ³•ï¼‰ã€‚  

### å¯è§†åŒ–è®¾è®¡æ€è·¯
æˆ‘ä»¬ç”¨**FCçº¢ç™½æœºé£æ ¼**åšåŠ¨ç”»ï¼š
- åƒç´ å—è¡¨ç¤ºç¡¬å¸ï¼Œçº¢è‰²=åé¢ï¼ˆ0ï¼‰ï¼Œè“è‰²=æ­£é¢ï¼ˆ1ï¼‰ã€‚
- ç¦»æ•£åŒ–çš„å…³é”®ç‚¹ç”¨é»„è‰²æ–¹å—æ ‡è®°ï¼ŒåŠ¨æ€æ˜¾ç¤ºDPçŠ¶æ€çš„è½¬ç§»ï¼ˆæ¯”å¦‚ä»çº¢è‰²å—è·³åˆ°è“è‰²å—ï¼‰ã€‚
- å¤„ç†é™åˆ¶æ—¶ï¼Œç”¨çº¢è‰²é—ªçƒæ ‡è®°ä¸åˆæ³•çš„çŠ¶æ€ï¼Œä¼´éšâ€œæ»´æ»´â€éŸ³æ•ˆã€‚
- äº¤äº’æ§åˆ¶ï¼šå•æ­¥æ‰§è¡Œï¼ˆçœ‹æ¯ä¸€æ­¥è½¬ç§»ï¼‰ã€è‡ªåŠ¨æ’­æ”¾ï¼ˆåŠ é€Ÿçœ‹æµç¨‹ï¼‰ã€é‡ç½®ï¼ˆé‡æ–°å¼€å§‹ï¼‰ã€‚


## 2. ç²¾é€‰ä¼˜è´¨é¢˜è§£å‚è€ƒ

### é¢˜è§£ä¸€ï¼šSaliĞµriï¼ˆèµ10ï¼‰
* **ç‚¹è¯„**ï¼šè¿™é“é¢˜çš„â€œæ ‡å‡†ç­”æ¡ˆâ€ï¼æ€è·¯æ¸…æ™°åˆ°åƒè¯´æ˜ä¹¦â€”â€”å…ˆæš´åŠ›DPå†ä¼˜åŒ–ï¼Œæ¯ä¸€æ­¥éƒ½è®²å¾—é€ã€‚ç¦»æ•£åŒ–çš„å¤„ç†ï¼ˆåŠ `l-1`ï¼‰æ˜¯å…³é”®æŠ€å·§ï¼Œå®Œç¾è§£å†³äº†åŒºé—´è¾¹ç•Œé—®é¢˜ã€‚ä»£ç é‡Œç”¨`sum0`/`sum1`ç»´æŠ¤DPçŠ¶æ€çš„æ€»å’Œï¼Œç”¨`pos0`/`pos1`æŒ‡é’ˆè·³è¿‡å·²ç»ç½®0çš„å‰ç¼€ï¼ŒæŠŠå¤æ‚åº¦ä»`O(kÂ²)`é™åˆ°`O((n+m)logk)`ï¼Œéå¸¸é«˜æ•ˆï¼è€Œä¸”ä»£ç é£æ ¼å¹²å‡€ï¼Œå˜é‡åï¼ˆæ¯”å¦‚`maxb`/`maxw`è®°å½•æ¯ä¸ªå³ç«¯ç‚¹å¯¹åº”çš„æœ€å°å·¦ç«¯ç‚¹ï¼‰ä¸€çœ‹å°±æ‡‚ï¼Œé€‚åˆåˆå­¦è€…æ¨¡ä»¿ã€‚

### é¢˜è§£äºŒï¼šdo_while_trueï¼ˆèµ7ï¼‰
* **ç‚¹è¯„**ï¼šå¦ä¸€ç§DPæ€è·¯â€”â€”ç”¨`f`ï¼ˆå…¨0ï¼‰ã€`g`ï¼ˆå…¨1ï¼‰ã€`h`ï¼ˆæ··åˆï¼‰ä¸‰ä¸ªçŠ¶æ€ï¼Œç›´æ¥è®¡ç®—æ¯æ®µåŒºé—´çš„æ–¹æ¡ˆæ•°ã€‚å‰ç¼€å’Œä¼˜åŒ–`F`/`G`/`H`å¿«é€Ÿæ±‚åŒºé—´å’Œï¼Œå¤„ç†é™åˆ¶æ—¶ç”¨`p1`/`p2`è®°å½•æ¯ä¸ªå³ç«¯ç‚¹çš„æœ€å°å·¦ç«¯ç‚¹ï¼ŒæŠŠä¸åˆæ³•çš„çŠ¶æ€æ’é™¤ã€‚è¿™ç§åˆ†çŠ¶æ€çš„æ–¹æ³•æ›´ç›´è§‚ï¼Œé€‚åˆåˆšå­¦DPçš„åŒå­¦ç†è§£â€œçŠ¶æ€æ‹†åˆ†â€çš„æ€æƒ³ã€‚

### é¢˜è§£ä¸‰ï¼šwurzangï¼ˆèµ6ï¼‰
* **ç‚¹è¯„**ï¼šå®¹æ–¥åšæ³•çš„ä»£è¡¨ï¼è™½ç„¶é¢˜ç›®è¯´â€œéš¾ç‚¹åœ¨äºä¸å»æƒ³å®¹æ–¥â€ï¼Œä½†è¿™ä½ä½œè€…åè¦æŒ‘æˆ˜ã€‚æ€è·¯æ˜¯â€œé’¦å®šæŸäº›åŒºé—´ä¸æ»¡è¶³æ¡ä»¶ï¼Œç”¨å®¹æ–¥ç³»æ•°æŠµæ¶ˆâ€ï¼Œé€šè¿‡æ’åºå’Œå‰ç¼€å’Œä¼˜åŒ–å¤„ç†åŒºé—´çš„ç›¸äº¤/ç›¸ç¦»æƒ…å†µã€‚è¿™ç§æ–¹æ³•éœ€è¦å¯¹å®¹æ–¥åŸç†å¾ˆç†Ÿæ‚‰ï¼Œä½†èƒ½é”»ç‚¼é€†å‘æ€ç»´â€”â€”å¦‚æœæ­£å‘DPå¡å£³ï¼Œä¸å¦¨è¯•è¯•å®¹æ–¥ï¼


## 3. æ ¸å¿ƒéš¾ç‚¹è¾¨æä¸è§£é¢˜ç­–ç•¥

### å…³é”®ç‚¹1ï¼šå¦‚ä½•å¤„ç†1e9çš„å¤§kï¼Ÿ
- **åˆ†æ**ï¼škå¯ä»¥åˆ°1e9ï¼Œç›´æ¥éå†æ¯ä¸ªç¡¬å¸æ˜¯ä¸å¯èƒ½çš„ã€‚ç¦»æ•£åŒ–æ˜¯å”¯ä¸€å‡ºè·¯â€”â€”æŠŠæ‰€æœ‰**å…³é”®ä½ç½®**ï¼ˆåŒºé—´çš„`l`ã€`r`ã€`l-1`ï¼‰æ”¶é›†èµ·æ¥ï¼Œå‹ç¼©æˆ`O(n+m)`ä¸ªç‚¹ã€‚æ¯”å¦‚æ ·ä¾‹1ä¸­çš„k=5ï¼Œç¦»æ•£åŒ–åçš„å…³é”®ç‚¹æ˜¯0ã€1ã€2ã€3ã€5ï¼Œè¿™æ ·åªéœ€è¦å¤„ç†è¿™5ä¸ªç‚¹ä¹‹é—´çš„åŒºé—´ã€‚
- ğŸ’¡ å­¦ä¹ ç¬”è®°ï¼šç¦»æ•£åŒ–çš„æ ¸å¿ƒæ˜¯â€œåªå…³å¿ƒå˜åŒ–çš„ç‚¹â€ï¼ŒæŠŠå¤§èŒƒå›´å‹ç¼©æˆå°èŒƒå›´ã€‚

### å…³é”®ç‚¹2ï¼šå¦‚ä½•é«˜æ•ˆç»´æŠ¤DPçŠ¶æ€ï¼Ÿ
- **åˆ†æ**ï¼šç›´æ¥ç»´æŠ¤`dp[0][i]`å’Œ`dp[1][i]`ä¼šæœ‰`O((n+m)Â²)`çš„å¤æ‚åº¦ï¼Œéœ€è¦ä¼˜åŒ–ã€‚ç”¨`sum0`/`sum1`ç»´æŠ¤å½“å‰æ‰€æœ‰`dp[0][i]`/`dp[1][i]`çš„æ€»å’Œï¼Œè½¬ç§»æ—¶ç›´æ¥ç”¨æ€»å’Œè®¡ç®—æ··åˆæƒ…å†µçš„æ–¹æ¡ˆæ•°ï¼Œé¿å…éå†æ‰€æœ‰`i`ã€‚
- ğŸ’¡ å­¦ä¹ ç¬”è®°ï¼šå‰ç¼€å’Œ/æ€»å’Œä¼˜åŒ–æ˜¯DPçš„å¸¸ç”¨æŠ€å·§ï¼Œèƒ½æŠŠäºŒæ¬¡å¤æ‚åº¦é™åˆ°çº¿æ€§ã€‚

### å…³é”®ç‚¹3ï¼šå¦‚ä½•å¤„ç†åŒºé—´é™åˆ¶ï¼Ÿ
- **åˆ†æ**ï¼šå¯¹äºâ€œ[l,r]è‡³å°‘æœ‰ä¸€ä¸ª1â€çš„é™åˆ¶ï¼Œæˆ‘ä»¬éœ€è¦ç¡®ä¿**æœ€åä¸€ä¸ª1çš„ä½ç½®â‰¥l**ã€‚ç¦»æ•£åŒ–åï¼Œ`i < l`çš„`dp[0][i]`ï¼ˆæœ€åä¸€ä¸ªæ˜¯0ï¼Œä¸Šä¸€ä¸ª1åœ¨`i`ï¼‰æ˜¯ä¸åˆæ³•çš„ï¼Œéœ€è¦ç½®0ã€‚ç”¨æŒ‡é’ˆ`pos0`ç»´æŠ¤å½“å‰å·²ç»ç½®0çš„å‰ç¼€ï¼Œæ¯æ¬¡ç§»åŠ¨æŒ‡é’ˆæ—¶ä»æ€»å’Œä¸­å‡å»å¯¹åº”çš„`dp[0][i]`ï¼Œé¿å…é‡å¤è®¡ç®—ã€‚
- ğŸ’¡ å­¦ä¹ ç¬”è®°ï¼šæŒ‡é’ˆç»´æŠ¤å‰ç¼€0çš„ä½ç½®ï¼Œæ˜¯â€œä¸€æ—¦ç½®0å°±æ°¸è¿œ0â€çš„ç‰¹æ€§å¸¦æ¥çš„ä¼˜åŒ–ã€‚


## 4. C++æ ¸å¿ƒä»£ç å®ç°èµæ

### æœ¬é¢˜é€šç”¨æ ¸å¿ƒC++å®ç°å‚è€ƒ
* **è¯´æ˜**ï¼šç»¼åˆSaliĞµriå’Œdo_while_trueçš„æ€è·¯ï¼Œæç‚¼å‡ºæœ€ç®€æ´çš„æ ¸å¿ƒå®ç°ã€‚
* **å®Œæ•´æ ¸å¿ƒä»£ç **ï¼š
```cpp
#include <iostream>
#include <vector>
#include <algorithm>
using namespace std;

const int MOD = 1e9 + 7;
const int MAXM = 6e5 + 5;

int qpow(int a, int x) {
    int res = 1;
    while (x) {
        if (x & 1) res = 1LL * res * a % MOD;
        a = 1LL * a * a % MOD;
        x >>= 1;
    }
    return res;
}

int main() {
    int k, n, m;
    cin >> k >> n >> m;
    vector<int> lsh;
    lsh.push_back(0);
    lsh.push_back(k);

    vector<pair<int, int>> b(n), w(m);
    for (int i = 0; i < n; ++i) {
        cin >> b[i].first >> b[i].second;
        lsh.push_back(b[i].first);
        lsh.push_back(b[i].first - 1);
        lsh.push_back(b[i].second);
    }
    for (int i = 0; i < m; ++i) {
        cin >> w[i].first >> w[i].second;
        lsh.push_back(w[i].first);
        lsh.push_back(w[i].first - 1);
        lsh.push_back(w[i].second);
    }

    sort(lsh.begin(), lsh.end());
    lsh.erase(unique(lsh.begin(), lsh.end()), lsh.end());
    int M = lsh.size();

    vector<int> maxb(M, 0), maxw(M, 0);
    for (auto &p : b) {
        int r = lower_bound(lsh.begin(), lsh.end(), p.second) - lsh.begin();
        int l = lower_bound(lsh.begin(), lsh.end(), p.first) - lsh.begin();
        if (l > maxb[r]) maxb[r] = l;
    }
    for (auto &p : w) {
        int r = lower_bound(lsh.begin(), lsh.end(), p.second) - lsh.begin();
        int l = lower_bound(lsh.begin(), lsh.end(), p.first) - lsh.begin();
        if (l > maxw[r]) maxw[r] = l;
    }

    vector<int> dp0(M, 0), dp1(M, 0);
    dp0[0] = 1;
    dp1[0] = 1;
    int sum0 = 1, sum1 = 1;
    int pos0 = 0, pos1 = 0;

    for (int i = 0; i < M - 1; ++i) {
        int len = lsh[i + 1] - lsh[i];
        int val = (qpow(2, len - 1) - 1 + MOD) % MOD;
        int tot = (sum0 + sum1) % MOD;

        dp1[i] = (dp1[i] + sum0) % MOD;
        dp0[i] = (dp0[i] + sum1) % MOD;
        dp0[i + 1] = (dp0[i + 1] + 1LL * tot * val % MOD) % MOD;
        dp1[i + 1] = (dp1[i + 1] + 1LL * tot * val % MOD) % MOD;

        sum0 = (sum0 + sum1 + 1LL * tot * val % MOD) % MOD;
        sum1 = sum0;

        while (pos0 + 1 < maxw[i + 1]) {
            pos0++;
            sum0 = (sum0 - dp0[pos0] + MOD) % MOD;
        }
        while (pos1 + 1 < maxb[i + 1]) {
            pos1++;
            sum1 = (sum1 - dp1[pos1] + MOD) % MOD;
        }
    }

    cout << 1LL * (sum0 + sum1) * qpow(2, MOD - 2) % MOD << endl;
    return 0;
}
```
* **ä»£ç è§£è¯»æ¦‚è¦**ï¼š  
  1. æ”¶é›†æ‰€æœ‰å…³é”®ç‚¹å¹¶ç¦»æ•£åŒ–ã€‚  
  2. é¢„å¤„ç†æ¯ä¸ªå³ç«¯ç‚¹å¯¹åº”çš„æœ€å°å·¦ç«¯ç‚¹ï¼ˆ`maxb`/`maxw`ï¼‰ã€‚  
  3. åˆå§‹åŒ–DPçŠ¶æ€ï¼ˆ`dp0`/`dp1`ï¼‰å’Œæ€»å’Œï¼ˆ`sum0`/`sum1`ï¼‰ã€‚  
  4. éå†æ¯ä¸ªå…³é”®ç‚¹ï¼Œè®¡ç®—è½¬ç§»åçš„çŠ¶æ€ï¼Œå¹¶ç”¨æŒ‡é’ˆå¤„ç†ä¸åˆæ³•çš„å‰ç¼€ã€‚  
  5. è¾“å‡ºç»“æœï¼ˆé™¤ä»¥2æ˜¯å› ä¸ºåˆå§‹çŠ¶æ€å¤šç®—äº†ä¸€ä¸ªä¸å­˜åœ¨çš„0å·ç¡¬å¸ï¼‰ã€‚


### é¢˜è§£ä¸€ï¼ˆSaliĞµriï¼‰æ ¸å¿ƒç‰‡æ®µèµæ
* **äº®ç‚¹**ï¼šç”¨æŒ‡é’ˆç»´æŠ¤å‰ç¼€0çš„ä½ç½®ï¼Œå®Œç¾ä¼˜åŒ–é™åˆ¶å¤„ç†ã€‚
* **æ ¸å¿ƒä»£ç ç‰‡æ®µ**ï¼š
```cpp
while (pos0+1<maxw[i+1]) sum0 = (sum0-dp[0][++pos0]+mod)%mod;
while (pos1+1<maxb[i+1]) sum1 = (sum1-dp[1][++pos1]+mod)%mod;
```
* **ä»£ç è§£è¯»**ï¼š  
  `pos0`æ˜¯`dp0`ä¸­ç¬¬ä¸€ä¸ªé0çš„ä½ç½®ã€‚å½“`maxw[i+1]`ï¼ˆå½“å‰å³ç«¯ç‚¹å¯¹åº”çš„æœ€å°å·¦ç«¯ç‚¹ï¼‰å˜å¤§æ—¶ï¼Œéœ€è¦æŠŠ`pos0`åˆ°`maxw[i+1]-1`çš„`dp0`ç½®0ï¼Œå¹¶ä»`sum0`ä¸­å‡å»è¿™äº›å€¼ã€‚å› ä¸º`pos0`åªä¼šå¾€åèµ°ï¼Œæ‰€ä»¥æ¯ä¸ªä½ç½®åªå¤„ç†ä¸€æ¬¡ï¼Œå¤æ‚åº¦æ˜¯O(n+m)ã€‚
* ğŸ’¡ å­¦ä¹ ç¬”è®°ï¼šæŒ‡é’ˆç»´æŠ¤å‰ç¼€æ˜¯å¤„ç†â€œä¸€æ—¦ä¸åˆæ³•å°±æ°¸è¿œä¸åˆæ³•â€é—®é¢˜çš„ç¥å™¨ï¼


## 5. ç®—æ³•å¯è§†åŒ–ï¼šåƒç´ åŠ¨ç”»æ¼”ç¤º

### åŠ¨ç”»ä¸»é¢˜ï¼šåƒç´ ç¡¬å¸çš„â€œå…³é”®èŠ‚ç‚¹ä¹‹æ—…â€
æˆ‘ä»¬ç”¨**FCçº¢ç™½æœºé£æ ¼**ï¼ˆ8ä½åƒç´ ã€256è‰²ï¼‰åšåŠ¨ç”»ï¼Œåœºæ™¯æ˜¯ä¸€æ¡ç”±åƒç´ å—ç»„æˆçš„â€œç¡¬å¸è·¯â€ï¼Œå…³é”®ç‚¹ç”¨é»„è‰²æ–¹å—æ ‡è®°ã€‚

### æ ¸å¿ƒæ¼”ç¤ºæ­¥éª¤
1. **åˆå§‹åŒ–**ï¼š  
   - å±å¹•å·¦ä¾§æ˜¾ç¤ºç¦»æ•£åŒ–åçš„å…³é”®ç‚¹ï¼ˆæ¯”å¦‚0ã€1ã€2ã€3ã€5ï¼‰ï¼Œæ¯ä¸ªç‚¹ç”¨é»„è‰²æ–¹å—è¡¨ç¤ºã€‚  
   - å±å¹•å³ä¾§æ˜¾ç¤ºDPçŠ¶æ€ï¼š`dp0`ï¼ˆçº¢è‰²æ¡ï¼‰å’Œ`dp1`ï¼ˆè“è‰²æ¡ï¼‰ï¼Œé•¿åº¦ä»£è¡¨æ–¹æ¡ˆæ•°ã€‚  
   - æ§åˆ¶é¢æ¿æœ‰â€œå•æ­¥â€â€œè‡ªåŠ¨â€â€œé‡ç½®â€æŒ‰é’®ï¼Œé€Ÿåº¦æ»‘å—ï¼ˆ1x~5xï¼‰ã€‚

2. **è½¬ç§»è¿‡ç¨‹**ï¼š  
   - å½“å¤„ç†ä¸¤ä¸ªå…³é”®ç‚¹ä¹‹é—´çš„åŒºé—´æ—¶ï¼Œæ¯”å¦‚ä»`i`åˆ°`i+1`ï¼š
     - **å…¨å¡«0**ï¼šçº¢è‰²æ¡ä»`i`å»¶ä¼¸åˆ°`i+1`ï¼Œä¼´éšâ€œå—’â€çš„éŸ³æ•ˆã€‚
     - **å…¨å¡«1**ï¼šè“è‰²æ¡ä»`i`è·³åˆ°`i+1`ï¼Œä¼´éšâ€œå®â€çš„éŸ³æ•ˆã€‚
     - **æ··åˆå¡«**ï¼šçº¢è‰²å’Œè“è‰²æ¡åŒæ—¶å˜é•¿ï¼Œä¼´éšâ€œå“—å“—â€çš„éŸ³æ•ˆï¼ˆä»£è¡¨æ··åˆå¡«ï¼‰ã€‚

3. **å¤„ç†é™åˆ¶**ï¼š  
   - å½“æŸä¸ªå³ç«¯ç‚¹éœ€è¦æ£€æŸ¥é™åˆ¶æ—¶ï¼Œæ¯”å¦‚`maxw[i+1]`=2ï¼ŒæŒ‡é’ˆ`pos0`ä»0ç§»åŠ¨åˆ°1ï¼Œçº¢è‰²æ¡çš„å‰ä¸¤æ®µï¼ˆ0ã€1ï¼‰å˜æˆç°è‰²ï¼ˆç½®0ï¼‰ï¼Œä¼´éšâ€œæ»´æ»´â€çš„è­¦ç¤ºéŸ³æ•ˆã€‚

4. **ç»“æŸçŠ¶æ€**ï¼š  
   - æ‰€æœ‰å…³é”®ç‚¹å¤„ç†å®Œåï¼Œå±å¹•æ˜¾ç¤ºæœ€ç»ˆçš„`sum0`+`sum1`ï¼Œç”¨é‡‘è‰²å­—ä½“æ˜¾ç¤ºç»“æœï¼Œä¼´éšâ€œèƒœåˆ©â€éŸ³æ•ˆï¼ˆFCé£æ ¼çš„â€œå®ï½å®ï½â€ï¼‰ã€‚

### äº¤äº’è®¾è®¡
- **å•æ­¥æ‰§è¡Œ**ï¼šç‚¹å‡»â€œä¸‹ä¸€æ­¥â€ï¼Œçœ‹æ¯ä¸€æ­¥çš„è½¬ç§»å’Œé™åˆ¶å¤„ç†ã€‚
- **è‡ªåŠ¨æ’­æ”¾**ï¼šæ»‘åŠ¨é€Ÿåº¦æ»‘å—ï¼ŒåŠ¨ç”»è‡ªåŠ¨è¿è¡Œï¼Œé€‚åˆå¿«é€Ÿç†è§£æµç¨‹ã€‚
- **é‡ç½®**ï¼šå›åˆ°åˆå§‹çŠ¶æ€ï¼Œé‡æ–°å¼€å§‹æ¼”ç¤ºã€‚


## 6. æ‹“å±•ç»ƒä¹ ä¸ç›¸ä¼¼é—®é¢˜æ€è€ƒ

### é€šç”¨æ€è·¯è¿ç§»
- **ç¦»æ•£åŒ–+DP**çš„å¥—è·¯é€‚ç”¨äºæ‰€æœ‰**å¤§èŒƒå›´æ•°æ®ä½†å…³é”®ç‚¹å°‘**çš„é—®é¢˜ï¼Œæ¯”å¦‚ï¼š
  1. ç»Ÿè®¡åŒºé—´å†…çš„ç‰¹æ®Šæ•°ä¸ªæ•°ï¼ˆå…³é”®ç‚¹æ˜¯åŒºé—´ç«¯ç‚¹ï¼‰ã€‚
  2. è®¡ç®—è·¯å¾„æ–¹æ¡ˆæ•°ï¼ˆå…³é”®ç‚¹æ˜¯éšœç¢ç‰©ä½ç½®ï¼‰ã€‚
  3. å¤„ç†åŒºé—´çº¦æŸçš„è®¡æ•°é—®é¢˜ï¼ˆæ¯”å¦‚æœ¬é¢˜çš„ç¡¬å¸æ’åˆ—ï¼‰ã€‚

### æ´›è°·ç»ƒä¹ æ¨è
1. **æ´›è°· P1020** - å¯¼å¼¹æ‹¦æˆª  
   ğŸ—£ï¸ æ¨èç†ç”±ï¼šéœ€è¦ç¦»æ•£åŒ–å¯¼å¼¹é«˜åº¦ï¼Œç”¨DPè®¡ç®—æœ€é•¿ä¸å‡å­åºåˆ—ï¼Œé”»ç‚¼ç¦»æ•£åŒ–+DPçš„åŸºç¡€èƒ½åŠ›ã€‚
2. **æ´›è°· P1880** - çŸ³å­åˆå¹¶  
   ğŸ—£ï¸ æ¨èç†ç”±ï¼šåŒºé—´DPçš„ç»å…¸é¢˜ï¼Œéœ€è¦å¤„ç†å¤§èŒƒå›´çš„åŒºé—´åˆå¹¶ï¼Œç±»ä¼¼æœ¬é¢˜çš„â€œåŒºé—´è½¬ç§»â€æ€æƒ³ã€‚
3. **æ´›è°· P2340** - å¥¶ç‰›é˜…å…µ  
   ğŸ—£ï¸ æ¨èç†ç”±ï¼šéœ€è¦ç¦»æ•£åŒ–å¥¶ç‰›çš„ä½ç½®ï¼Œç”¨è®¡æ•°DPè®¡ç®—åˆæ³•çš„æ’åˆ—æ•°ï¼Œå’Œæœ¬é¢˜çš„â€œé™åˆ¶å¤„ç†â€æ€è·¯ä¸€è‡´ã€‚


## 7. å­¦ä¹ å¿ƒå¾—ä¸ç»éªŒåˆ†äº«
- **æ¥è‡ªSaliĞµriçš„ç»éªŒ**ï¼šâ€œæœ¬é¢˜çš„ä¸»è¦éš¾ç‚¹åœ¨äºä¸å»æƒ³å®¹æ–¥â€â€”â€”å¾ˆå¤šåŒå­¦çœ‹åˆ°åŒºé—´é™åˆ¶ä¼šç¬¬ä¸€æ—¶é—´æƒ³åˆ°å®¹æ–¥ï¼Œä½†å®¹æ–¥çš„å¤æ‚åº¦å¾ˆé«˜ï¼Œè€ŒDP+ç¦»æ•£åŒ–æ›´ç›´æ¥ã€‚
- **æ¥è‡ªdo_while_trueçš„ç»éªŒ**ï¼šâ€œåˆ†çŠ¶æ€DPæ›´ç›´è§‚â€â€”â€”æŠŠå…¨0ã€å…¨1ã€æ··åˆåˆ†å¼€å¤„ç†ï¼Œæ›´å®¹æ˜“ç†è§£è½¬ç§»é€»è¾‘ã€‚
- **æ¥è‡ªwurzangçš„ç»éªŒ**ï¼šâ€œå®¹æ–¥ä¹Ÿèƒ½åšï¼Œä½†éœ€è¦å¤„ç†åŒºé—´ç›¸äº¤â€â€”â€”å¦‚æœæ­£å‘DPå¡å£³ï¼Œä¸å¦¨è¯•è¯•é€†å‘æ€è€ƒï¼Œç”¨å®¹æ–¥æŠµæ¶ˆä¸åˆæ³•çš„æƒ…å†µã€‚


## ç»“è¯­
è¿™é“é¢˜çš„æ ¸å¿ƒæ˜¯**ç”¨ç¦»æ•£åŒ–å‹ç¼©èŒƒå›´ï¼Œç”¨DPè®°å½•çŠ¶æ€ï¼Œç”¨å‰ç¼€å’Œ/æŒ‡é’ˆä¼˜åŒ–å¤æ‚åº¦**ã€‚é€šè¿‡è¿™é“é¢˜ï¼Œä½ èƒ½å­¦ä¼šå¤„ç†å¤§èŒƒå›´æ•°æ®çš„å…³é”®æŠ€å·§â€”â€”**æŠ“ä½å˜åŒ–çš„ç‚¹ï¼Œå¿½ç•¥ä¸å˜çš„éƒ¨åˆ†**ã€‚ä¸‹æ¬¡é‡åˆ°ç±»ä¼¼çš„é—®é¢˜ï¼Œä¸å¦¨å…ˆæƒ³æƒ³ï¼šâ€œå“ªäº›ç‚¹æ˜¯å…³é”®çš„ï¼Ÿèƒ½ä¸èƒ½ç¦»æ•£åŒ–ï¼Ÿâ€ åŠ æ²¹ï¼Œä½ ä¸€å®šèƒ½æŒæ¡ï¼ğŸ’ª

---
å¤„ç†ç”¨æ—¶ï¼š107.18ç§’
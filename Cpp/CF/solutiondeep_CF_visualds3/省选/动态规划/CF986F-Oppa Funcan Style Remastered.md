# é¢˜ç›®ä¿¡æ¯

# Oppa Funcan Style Remastered

## é¢˜ç›®æè¿°

Surely you have seen insane videos by South Korean rapper PSY, such as "Gangnam Style", "Gentleman" and "Daddy". You might also hear that PSY has been recording video "Oppa Funcan Style" two years ago (unfortunately we couldn't find it on the internet). We will remind you what this hit looked like (you can find original description [here](http://acm.timus.ru/problem.aspx?space=1&num=2107&locale=en)):

On the ground there are $ n $ platforms, which are numbered with integers from $ 1 $ to $ n $ , on $ i $ -th platform there is a dancer with number $ i $ . Further, every second all the dancers standing on the platform with number $ i $ jump to the platform with the number $ f(i) $ . The moving rule $ f $ is selected in advance and is not changed throughout the clip.

The duration of the clip was $ k $ seconds and the rule $ f $ was chosen in such a way that after $ k $ seconds all dancers were in their initial positions (i.e. the $ i $ -th dancer stood on the platform with the number $ i $ ). That allowed to loop the clip and collect even more likes.

PSY knows that enhanced versions of old artworks become more and more popular every day. So he decided to release a remastered-version of his video.

In his case "enhanced version" means even more insanity, so the number of platforms can be up to $ 10^{18} $ ! But the video director said that if some dancer stays on the same platform all the time, then the viewer will get bored and will turn off the video immediately. Therefore, for all $ x $ from $ 1 $ to $ n $ $ f(x) \neq x $ must hold.

Big part of classic video's success was in that looping, so in the remastered version all dancers should return to their initial positions in the end of the clip as well.

PSY hasn't decided on the exact number of platforms and video duration yet, so he asks you to check if there is a good rule $ f $ for different options.

## æ ·ä¾‹ #1

### è¾“å…¥

```
3
7 7
3 8
5 6
```

### è¾“å‡º

```
YES
NO
YES
```

# AIåˆ†æç»“æœ

---
# ğŸ’¡ Kayçš„C++ç®—æ³•è§£æï¼šCF986F Oppa Funcan Style Remastered æ·±å…¥å­¦ä¹ æŒ‡å— ğŸ’¡

## å¼•è¨€
ä»Šå¤©æˆ‘ä»¬æ¥åˆ†æCodeforcesç»å…¸æ•°è®ºé—®é¢˜ã€ŒOppa Funcan Style Remasteredã€ã€‚è¿™é“é¢˜å°†**è´¨å› æ•°åˆ†è§£**ã€**æ‰©å±•æ¬§å‡ é‡Œå¾—ç®—æ³•**å’Œ**åŒä½™æœ€çŸ­è·¯**ç»“åˆï¼Œæ˜¯é”»ç‚¼æ•°è®ºç»¼åˆèƒ½åŠ›çš„å¥½é¢˜ã€‚æœ¬æŒ‡å—ä¼šå¸®ä½ æ‹†è§£é—®é¢˜æœ¬è´¨ï¼ŒæŒæ¡æ ¸å¿ƒç®—æ³•ï¼Œå¹¶é€šè¿‡å¯è§†åŒ–ç†è§£å…³é”®é€»è¾‘ã€‚


## 1. é¢˜ç›®è§£è¯»ä¸æ ¸å¿ƒç®—æ³•è¯†åˆ«

âœ¨ **æœ¬é¢˜ä¸»è¦è€ƒå¯Ÿ**ï¼šè´¨å› æ•°åˆ†è§£ã€æ‰©å±•æ¬§å‡ é‡Œå¾—ï¼ˆExGCDï¼‰ã€åŒä½™æœ€çŸ­è·¯  

ğŸ—£ï¸ **åˆæ­¥åˆ†æ**  
é¢˜ç›®è¦æ±‚åˆ¤æ–­ï¼š**èƒ½å¦ç”¨kçš„è‹¥å¹²é1å› æ•°ä¹‹å’Œè¡¨ç¤ºn**ï¼ˆå› æ•°å¯é‡å¤ä½¿ç”¨ï¼‰ã€‚  
å…³é”®è½¬åŒ–ï¼škçš„ä»»ä½•é1å› æ•°éƒ½èƒ½æ‹†æˆå…¶è´¨å› æ•°çš„å’Œï¼ˆæ¯”å¦‚6=2+2+2æˆ–3+3ï¼‰ã€‚å› æ­¤é—®é¢˜ç­‰ä»·äºï¼š**èƒ½å¦ç”¨kçš„è´¨å› æ•°ä¹‹å’Œè¡¨ç¤ºn**ã€‚

### æ ¸å¿ƒç®—æ³•æµç¨‹
1. **è´¨å› æ•°åˆ†è§£**ï¼šå°†kæ‹†æˆè´¨æ•°çš„ä¹˜ç§¯ï¼ˆå¦‚k=12â†’è´¨å› æ•°[2,3]ï¼‰ã€‚  
2. **åˆ†ç±»è®¨è®º**ï¼š  
   - **è´¨å› æ•°ä¸ªæ•°=1**ï¼ˆkæ˜¯è´¨æ•°ï¼‰ï¼šnå¿…é¡»æ˜¯kçš„å€æ•°ï¼ˆå¦‚k=7â†’n=14=7+7ï¼‰ã€‚  
   - **è´¨å› æ•°ä¸ªæ•°=2**ï¼ˆå¦‚k=6=2Ã—3ï¼‰ï¼šè½¬åŒ–ä¸ºäºŒå…ƒä¸€æ¬¡ä¸å®šæ–¹ç¨‹`ax+by=n`çš„éè´Ÿè§£åˆ¤æ–­ï¼ˆç”¨ExGCDæ±‚é€†å…ƒï¼‰ã€‚  
   - **è´¨å› æ•°ä¸ªæ•°â‰¥3**ï¼ˆå¦‚k=30=2Ã—3Ã—5ï¼‰ï¼šç”¨**åŒä½™æœ€çŸ­è·¯**ï¼Œæ±‚æ¨¡æœ€å°è´¨å› æ•°pçš„å‰©ä½™ç³»ä¸‹çš„æœ€çŸ­è·¯å¾„ï¼Œåˆ¤æ–­næ˜¯å¦â‰¥è¯¥å‰©ä½™ç±»çš„æœ€çŸ­å’Œã€‚  

### å¯è§†åŒ–è®¾è®¡æ€è·¯
é’ˆå¯¹**åŒä½™æœ€çŸ­è·¯**è®¾è®¡8ä½åƒç´ åŠ¨ç”»ï¼š  
- **åœºæ™¯**ï¼šå·¦ä¾§æ˜¯æ¨¡pçš„å‰©ä½™ç³»èŠ‚ç‚¹ï¼ˆ0~p-1ï¼Œç°è‰²åƒç´ å—ï¼‰ï¼Œå³ä¾§æ˜¯æ§åˆ¶é¢æ¿ï¼ˆå¼€å§‹/æš‚åœã€å•æ­¥ã€é‡ç½®ï¼‰ã€‚  
- **äº¤äº’**ï¼šå•æ­¥æ‰§è¡Œæ—¶ï¼Œå½“å‰èŠ‚ç‚¹é—ªçƒé»„è‰²ï¼Œè½¬ç§»è¾¹ç”¨ç®­å¤´è¡¨ç¤ºï¼›è‡ªåŠ¨æ’­æ”¾æ—¶æŒ‰é€Ÿåº¦æ»‘å—è°ƒèŠ‚èŠ‚å¥ã€‚  
- **éŸ³æ•ˆ**ï¼šèŠ‚ç‚¹è®¿é—®ï¼ˆå®ï¼‰ã€è·ç¦»æ›´æ–°ï¼ˆå’”å—’ï¼‰ã€å®Œæˆï¼ˆFCé€šå…³éŸ³ä¹ï¼‰ã€‚  


## 2. ç²¾é€‰ä¼˜è´¨é¢˜è§£å‚è€ƒ

### é¢˜è§£ä¸€ï¼šcyffffï¼ˆèµ8ï¼‰
**ç‚¹è¯„**ï¼šæ€è·¯ä¸¥è°¨ï¼Œä»£ç é«˜æ•ˆã€‚å°†é—®é¢˜æ‹†è§£ä¸ºè´¨å› æ•°åˆ†è§£ï¼ˆPollard-Rhoï¼‰ã€åˆ†ç±»è®¨è®ºå’ŒåŒä½™æœ€çŸ­è·¯ï¼ˆDijkstraï¼‰ï¼Œæ¯ä¸€æ­¥é€»è¾‘æ¸…æ™°ã€‚åŒä½™æœ€çŸ­è·¯çš„å»ºæ¨¡å‡†ç¡®ï¼ˆç”¨æœ€å°è´¨å› æ•°ä½œæ¨¡æ•°ï¼‰ï¼Œæ—¶é—´å¤æ‚åº¦ï¼ˆO(t logk + t_k dâˆ›k logk)ï¼‰å®Œå…¨æ»¡è¶³é¢˜ç›®è¦æ±‚ã€‚ä»£ç é£æ ¼è§„èŒƒï¼Œå˜é‡å‘½åæ¸…æ™°ï¼Œæ˜¯ç«èµ›çº§åˆ«çš„ä¼˜ç§€å®ç°ã€‚

### é¢˜è§£äºŒï¼šAvocadoooï¼ˆèµ5ï¼‰
**ç‚¹è¯„**ï¼šå‰ç½®çŸ¥è¯†è¯´æ˜æ˜ç¡®ï¼ˆPollard-Rhoã€P3403è·³æ¥¼æœºï¼‰ï¼Œå¸®åŠ©å¿«é€Ÿå»ºç«‹çŸ¥è¯†å…³è”ã€‚è´¨å› æ•°åˆ†è§£ç”¨Pollard-Rhoå¤„ç†å¤§kï¼Œåˆ†ç±»è®¨è®ºé€»è¾‘æ¸…æ™°ï¼Œç‰¹åˆ«æ˜¯äºŒå…ƒä¸å®šæ–¹ç¨‹çš„é€†å…ƒè®¡ç®—å‡†ç¡®ã€‚**åŒä¸€kç¦»çº¿å¤„ç†**æ˜¯å…³é”®ä¼˜åŒ–ï¼Œé¿å…é‡å¤è®¡ç®—ã€‚

### é¢˜è§£ä¸‰ï¼šDaiRuiChen007ï¼ˆèµ3ï¼‰
**ç‚¹è¯„**ï¼šä»£ç ç®€æ´ï¼Œè´¨å› æ•°åˆ†è§£ç”¨æ¬§æ‹‰ç­›é¢„å¤„ç†è´¨æ•°ï¼ˆé€‚åˆç†è§£åŸºç¡€åŸç†ï¼‰ã€‚åŒä½™æœ€çŸ­è·¯ç”¨SPFAç®—æ³•ï¼Œè™½ç„¶ç†è®ºå¤æ‚åº¦ç•¥é«˜ï¼Œä½†å®é™…è¿è¡Œå¸¸æ•°å°ã€‚äºŒå…ƒä¸å®šæ–¹ç¨‹çš„ExGCDå®ç°å‡†ç¡®ï¼Œä½“ç°äº†å¯¹æ•°è®ºç®—æ³•çš„æ·±åˆ»ç†è§£ã€‚


## 3. æ ¸å¿ƒéš¾ç‚¹è¾¨æä¸è§£é¢˜ç­–ç•¥

### å…³é”®ç‚¹1ï¼šé«˜æ•ˆè´¨å› æ•°åˆ†è§£ï¼ˆå¤§kçš„å¤„ç†ï¼‰
**éš¾ç‚¹**ï¼škâ‰¤1e15ï¼Œæš´åŠ›åˆ†è§£ï¼ˆéå†åˆ°âˆškï¼‰ä¼šè¶…æ—¶ã€‚  
**ç­–ç•¥**ï¼šç”¨**Pollard-Rhoç®—æ³•**ï¼ˆæ¦‚ç‡æ€§åˆ†è§£ï¼Œæ—¶é—´å¤æ‚åº¦O(k^(1/4))ï¼‰ï¼Œå¿«é€Ÿåˆ†è§£å¤§æ•´æ•°ã€‚  
ğŸ’¡ **å­¦ä¹ ç¬”è®°**ï¼šå¤§æ•°åˆ†è§£éœ€ç”¨Pollard-Rhoï¼Œæš´åŠ›ä»…é€‚ç”¨äºå°kã€‚

### å…³é”®ç‚¹2ï¼šäºŒå…ƒä¸å®šæ–¹ç¨‹çš„éè´Ÿè§£åˆ¤æ–­
**éš¾ç‚¹**ï¼šåˆ¤æ–­`ax+by=n`æ˜¯å¦æœ‰éè´Ÿæ•´æ•°è§£ã€‚  
**ç­–ç•¥**ï¼šç”¨ExGCDæ±‚é€†å…ƒï¼Œè®¡ç®—bçš„æœ€å°å€¼`b_min = (n mod a) * inv(b,a) mod a`ï¼Œè‹¥`b_min*b â‰¤n`åˆ™æœ‰è§£ï¼ˆæ­¤æ—¶x=(n - b_min*b)/aâ‰¥0ï¼‰ã€‚  
ğŸ’¡ **å­¦ä¹ ç¬”è®°**ï¼šé€†å…ƒå’Œæ¨¡è¿ç®—å¯å¿«é€Ÿåˆ¤æ–­äºŒå…ƒæ–¹ç¨‹çš„éè´Ÿè§£ã€‚

### å…³é”®ç‚¹3ï¼šåŒä½™æœ€çŸ­è·¯çš„å»ºæ¨¡
**éš¾ç‚¹**ï¼šå¤šå˜é‡ä¸å®šæ–¹ç¨‹æ— æ³•ç›´æ¥æ±‚è§£ã€‚  
**ç­–ç•¥**ï¼šé€‰æœ€å°è´¨å› æ•°pï¼Œå°†é—®é¢˜è½¬åŒ–ä¸º**æ¨¡pçš„å‰©ä½™ç³»æœ€çŸ­è·¯å¾„**â€”â€”`dis[i]`è¡¨ç¤ºå‡‘å‡ºæ¨¡pä¸ºiçš„æœ€å°å’Œã€‚è‹¥`n â‰¥ dis[n mod p]`ï¼Œåˆ™nå¯ç”¨è´¨å› æ•°ä¹‹å’Œè¡¨ç¤ºï¼ˆæ·»åŠ pçš„å€æ•°å³å¯ï¼‰ã€‚  
ğŸ’¡ **å­¦ä¹ ç¬”è®°**ï¼šåŒä½™æœ€çŸ­è·¯å°†æ— é™é—®é¢˜è½¬åŒ–ä¸ºæœ‰é™é—®é¢˜ï¼Œæ˜¯å¤šå˜é‡ä¸å®šæ–¹ç¨‹çš„â€œç¥å™¨â€ã€‚

### âœ¨ è§£é¢˜æŠ€å·§æ€»ç»“
- **ç¦»çº¿å¤„ç†**ï¼šåŒä¸€kçš„è¯¢é—®ç»Ÿä¸€å¤„ç†ï¼Œé¿å…é‡å¤è®¡ç®—ã€‚  
- **æ¨¡æ•°é€‰æ‹©**ï¼šåŒä½™æœ€çŸ­è·¯é€‰æœ€å°è´¨å› æ•°ï¼Œå‡å°‘èŠ‚ç‚¹æ•°é‡ï¼ˆâ‰¤1e5ï¼‰ã€‚  
- **ç®—æ³•é€‚é…**ï¼šå¤§kç”¨Pollard-Rhoï¼Œå°kç”¨æš´åŠ›åˆ†è§£ã€‚  


## 4. C++æ ¸å¿ƒä»£ç å®ç°èµæ

### æœ¬é¢˜é€šç”¨æ ¸å¿ƒC++å®ç°å‚è€ƒ
**è¯´æ˜**ï¼šç»¼åˆä¼˜è´¨é¢˜è§£æ€è·¯ï¼ŒåŒ…å«Pollard-Rhoåˆ†è§£ã€åˆ†ç±»è®¨è®ºå’ŒåŒä½™æœ€çŸ­è·¯ï¼ˆDijkstraï¼‰ã€‚

```cpp
#include <iostream>
#include <vector>
#include <map>
#include <queue>
#include <algorithm>
#include <cstdlib>
#include <ctime>
#include <cstring>
using namespace std;
typedef long long ll;
typedef __int128 lll;

const ll INF = 1e18;

// å¿«é€Ÿå¹‚ï¼ˆæ¨¡è¿ç®—ï¼‰
ll qpow(ll x, ll y, ll mod) {
    ll res = 1;
    x %= mod;
    while (y) {
        if (y & 1) res = (lll)res * x % mod;
        x = (lll)x * x % mod;
        y >>= 1;
    }
    return res;
}

// ç±³å‹’-æ‹‰å®¾ç´ æ€§æµ‹è¯•
bool Miller_Rabin(ll x) {
    if (x < 2) return false;
    if (x == 2 || x == 3 || x == 5 || x == 7 || x == 11) return true;
    ll d = x - 1;
    int s = 0;
    while (!(d & 1)) d >>= 1, s++;
    vector<ll> a = {2, 3, 5, 7, 11};
    for (ll p : a) {
        if (p >= x) continue;
        ll t = qpow(p, d, x);
        if (t == 1 || t == x - 1) continue;
        bool ok = false;
        for (int i = 1; i < s; i++) {
            t = (lll)t * t % x;
            if (t == x - 1) { ok = true; break; }
        }
        if (!ok) return false;
    }
    return true;
}

// Pollard-Rhoè´¨å› æ•°åˆ†è§£
ll Pollard_Rho(ll x) {
    if (x % 2 == 0) return 2;
    if (x % 3 == 0) return 3;
    if (x % 5 == 0) return 5;
    while (true) {
        ll c = rand() % (x - 1) + 1;
        auto f = [&](ll y) { return ((lll)y * y + c) % x; };
        ll t = 0, r = 0, p = 1, q;
        do {
            t = f(t), r = f(f(r)), q = (lll)p * abs(t - r) % x;
            if (!q) break;
            p = q;
        } while (t != r);
        q = __gcd(p, x);
        if (q > 1) return q;
    }
}

// åˆ†è§£è´¨å› æ•°ï¼ˆé€’å½’ï¼‰
void factor(ll x, vector<ll>& factors) {
    if (x == 1) return;
    if (Miller_Rabin(x)) {
        factors.push_back(x);
        return;
    }
    ll d = Pollard_Rho(x);
    factor(d, factors);
    factor(x / d, factors);
}

// æ‰©å±•æ¬§å‡ é‡Œå¾—ç®—æ³•
ll exgcd(ll a, ll b, ll& x, ll& y) {
    if (b == 0) { x = 1; y = 0; return a; }
    ll g = exgcd(b, a % b, y, x);
    y -= a / b * x;
    return g;
}

// åŒä½™æœ€çŸ­è·¯ï¼ˆDijkstraï¼‰
vector<ll> dijkstra(ll p, const vector<ll>& primes) {
    int size = (int)p;
    vector<ll> dis(size, INF);
    priority_queue<pair<ll, int>, vector<pair<ll, int>>, greater<>> pq;
    dis[0] = 0;
    pq.emplace(0, 0);
    while (!pq.empty()) {
        auto [d, u] = pq.top(); pq.pop();
        if (d > dis[u]) continue;
        for (ll pr : primes) {
            if (pr == p) continue;
            int v = (u + pr) % size;
            if (dis[v] > dis[u] + pr) {
                dis[v] = dis[u] + pr;
                pq.emplace(dis[v], v);
            }
        }
    }
    return dis;
}

int main() {
    srand(time(0));
    ios::sync_with_stdio(false);
    cin.tie(nullptr);
    int T;
    cin >> T;
    map<ll, vector<pair<ll, int>>> mp;
    for (int i = 1; i <= T; ++i) {
        ll n, k;
        cin >> n >> k;
        mp[k].emplace_back(n, i);
    }
    vector<int> ans(T + 1, 0);
    for (auto& [k, queries] : mp) {
        if (k == 1) continue;
        vector<ll> factors;
        factor(k, factors);
        sort(factors.begin(), factors.end());
        factors.erase(unique(factors.begin(), factors.end()), factors.end());
        int sz = factors.size();
        if (sz == 1) {
            ll p = factors[0];
            for (auto& [n, idx] : queries) {
                ans[idx] = (n % p == 0);
            }
        } else if (sz == 2) {
            ll a = factors[0], b = factors[1];
            ll inv_b = qpow(b % a, a - 2, a);
            for (auto& [n, idx] : queries) {
                if (n % __gcd(a, b) != 0) continue;
                ll b_min = (n % a) * inv_b % a;
                if (b_min * b <= n) {
                    ans[idx] = 1;
                }
            }
        } else {
            ll p = factors[0];
            vector<ll> dis = dijkstra(p, factors);
            for (auto& [n, idx] : queries) {
                if (n >= dis[n % p]) {
                    ans[idx] = 1;
                }
            }
        }
    }
    for (int i = 1; i <= T; ++i) {
        cout << (ans[i] ? "YES" : "NO") << '\n';
    }
    return 0;
}
```

**ä»£ç è§£è¯»æ¦‚è¦**ï¼š  
1. **è¾“å…¥å¤„ç†**ï¼šæŒ‰kç¦»çº¿å­˜å‚¨è¯¢é—®ï¼Œé¿å…é‡å¤è®¡ç®—ã€‚  
2. **è´¨å› æ•°åˆ†è§£**ï¼šç”¨Pollard-Rhoåˆ†è§£kï¼Œå»é‡åå¾—åˆ°è´¨å› æ•°åˆ—è¡¨ã€‚  
3. **åˆ†ç±»å¤„ç†**ï¼š  
   - 1ä¸ªè´¨å› æ•°ï¼šåˆ¤æ–­næ˜¯å¦ä¸ºå€æ•°ã€‚  
   - 2ä¸ªè´¨å› æ•°ï¼šç”¨é€†å…ƒè®¡ç®—bçš„æœ€å°å€¼ï¼Œåˆ¤æ–­æ˜¯å¦æ»¡è¶³æ¡ä»¶ã€‚  
   - â‰¥3ä¸ªè´¨å› æ•°ï¼šç”¨Dijkstraæ±‚åŒä½™æœ€çŸ­è·¯ï¼Œåˆ¤æ–­næ˜¯å¦â‰¥å¯¹åº”ä½™æ•°çš„æœ€çŸ­å’Œã€‚  
4. **è¾“å‡ºç»“æœ**ï¼šæŒ‰è¯¢é—®é¡ºåºè¾“å‡ºYES/NOã€‚


### é’ˆå¯¹ä¼˜è´¨é¢˜è§£çš„ç‰‡æ®µèµæ

#### é¢˜è§£ä¸€ï¼ˆcyffffï¼‰ï¼šåŒä½™æœ€çŸ­è·¯ï¼ˆDijkstraï¼‰
**äº®ç‚¹**ï¼šç”¨ä¼˜å…ˆé˜Ÿåˆ—å®ç°Dijkstraï¼Œä¿è¯æœ€çŸ­è·¯å¾„çš„æ­£ç¡®æ€§ã€‚  
**æ ¸å¿ƒä»£ç ç‰‡æ®µ**ï¼š
```cpp
struct nodeE {
    int x; ll d;
    bool operator<(const nodeE& a) const { return d > a.d; }
};
priority_queue<nodeE> q;
void Dijkstra(int s) {
    memset(vis, 0, sizeof(vis));
    memset(dis, 127, sizeof(dis));
    dis[s] = s;
    q.push({s, dis[s]});
    while (!q.empty()) {
        nodeE p = q.top(); q.pop();
        int rt = p.x;
        if (vis[rt]) continue;
        vis[rt] = 1;
        for (int i = head[rt]; i; i = a[i].nxt) {
            int t = a[i].to;
            if (dis[t] > dis[rt] + a[i].w) {
                dis[t] = dis[rt] + a[i].w;
                if (!vis[t]) q.push({t, dis[t]});
            }
        }
    }
}
```
**ä»£ç è§£è¯»**ï¼š  
- ä¼˜å…ˆé˜Ÿåˆ—æŒ‰è·ç¦»ä»å°åˆ°å¤§æ’åºï¼ˆå°æ ¹å †ï¼‰ï¼Œä¿è¯æ¯æ¬¡å–å‡ºè·ç¦»æœ€å°çš„èŠ‚ç‚¹ã€‚  
- éå†èŠ‚ç‚¹çš„æ‰€æœ‰è¾¹ï¼ˆè´¨å› æ•°è½¬ç§»ï¼‰ï¼Œæ›´æ–°ç›¸é‚»èŠ‚ç‚¹çš„è·ç¦»ã€‚è‹¥æ›´æ–°åçš„è·ç¦»æ›´å°ï¼ŒåŠ å…¥é˜Ÿåˆ—ã€‚  
ğŸ’¡ **å­¦ä¹ ç¬”è®°**ï¼šDijkstraæ˜¯åŒä½™æœ€çŸ­è·¯çš„æ ‡å‡†å®ç°ï¼Œé€‚ç”¨äºè¾¹æƒéè´Ÿçš„åœºæ™¯ã€‚


## 5. ç®—æ³•å¯è§†åŒ–ï¼šåƒç´ åŠ¨ç”»æ¼”ç¤º

### åŠ¨ç”»æ¼”ç¤ºä¸»é¢˜ï¼šåƒç´ ä¸–ç•Œçš„â€œè´¨å› æ•°å‡‘æ•°å†’é™©â€
**æ ¸å¿ƒå†…å®¹**ï¼šå±•ç¤ºåŒä½™æœ€çŸ­è·¯å¦‚ä½•è®¡ç®—æ¨¡æœ€å°è´¨å› æ•°pçš„å‰©ä½™ç³»æœ€çŸ­è·¯å¾„ï¼Œç†è§£â€œç”¨è´¨å› æ•°å‡‘nâ€çš„è¿‡ç¨‹ã€‚

### è®¾è®¡ç»†èŠ‚
1. **åœºæ™¯åˆå§‹åŒ–**ï¼š  
   - å·¦ä¾§ï¼šæ¨¡pçš„å‰©ä½™ç³»èŠ‚ç‚¹ï¼ˆ0~p-1ï¼‰ï¼Œç°è‰²8x8åƒç´ å—ã€‚  
   - å³ä¾§ï¼šæ§åˆ¶é¢æ¿ï¼ˆçº¢è‰²â€œå¼€å§‹â€ã€è“è‰²â€œå•æ­¥â€ã€é»„è‰²â€œé‡ç½®â€ã€é»‘ç™½é€Ÿåº¦æ»‘å—ï¼‰ã€‚  
   - èƒŒæ™¯ï¼š8ä½é£æ ¼BGMï¼ˆå¦‚ã€Šè¶…çº§é©¬é‡Œå¥¥ã€‹ä¸»é¢˜æ›²ï¼‰ã€‚  

2. **ç®—æ³•æ‰§è¡Œ**ï¼š  
   - **å•æ­¥æ¨¡å¼**ï¼šç‚¹å‡»â€œå•æ­¥â€ï¼Œå½“å‰èŠ‚ç‚¹ï¼ˆè·ç¦»æœ€å°ï¼‰é—ªçƒé»„è‰²ï¼Œéå†è´¨å› æ•°è½¬ç§»ï¼š  
     - èŠ‚ç‚¹0â†’è´¨å› æ•°2â†’èŠ‚ç‚¹2ï¼Œè·ç¦»æ›´æ–°ä¸º2ï¼ˆèŠ‚ç‚¹2å˜æµ…ç»¿è‰²ï¼Œæ’­æ”¾â€œå’”å—’â€å£°ï¼‰ã€‚  
     - èŠ‚ç‚¹0â†’è´¨å› æ•°3â†’èŠ‚ç‚¹3ï¼Œè·ç¦»æ›´æ–°ä¸º3ï¼ˆèŠ‚ç‚¹3å˜æµ…ç»¿è‰²ï¼‰ã€‚  
   - **è‡ªåŠ¨æ¨¡å¼**ï¼šæŒ‰é€Ÿåº¦æ»‘å—è°ƒèŠ‚æ’­æ”¾é€Ÿåº¦ï¼ˆ1x/2x/4xï¼‰ï¼Œè¿ç»­æ‰§è¡Œæ­¥éª¤ï¼Œå±•ç¤ºè·ç¦»æ›´æ–°çš„å®Œæ•´è¿‡ç¨‹ã€‚  

3. **ç›®æ ‡è¾¾æˆ**ï¼š  
   - æ‰€æœ‰èŠ‚ç‚¹è·ç¦»è®¡ç®—å®Œæˆï¼Œæ’­æ”¾èƒœåˆ©éŸ³æ•ˆï¼ˆFCé€šå…³éŸ³ä¹ï¼‰ï¼ŒèŠ‚ç‚¹å…¨å˜ç»¿è‰²ã€‚  
   - è¾“å…¥n=10ï¼Œè®¡ç®—10 mod p=2ï¼ˆå‡è®¾p=2ï¼‰ï¼Œdis[0]=0â‰¤10ï¼Œå±å¹•æ˜¾ç¤ºâ€œYESâ€ï¼ˆåƒç´ æ–‡å­—ï¼‰ã€‚  

### äº¤äº’è®¾è®¡
- **é‡ç½®**ï¼šæ¢å¤èŠ‚ç‚¹ä¸ºç°è‰²ï¼Œè·ç¦»ä¸ºæ— ç©·å¤§ï¼Œé‡æ–°å¼€å§‹ã€‚  
- **ç®—æ³•å¯¹æ¯”**ï¼šå¹¶æ’æ˜¾ç¤ºSPFAå’ŒDijkstraçš„æ‰§è¡Œè¿‡ç¨‹ï¼Œå¯¹æ¯”ä¸¤è€…çš„æ•ˆç‡å·®å¼‚ã€‚


## 6. æ‹“å±•ç»ƒä¹ ä¸ç›¸ä¼¼é—®é¢˜æ€è€ƒ

### é€šç”¨æ€è·¯è¿ç§»
- **è´¨å› æ•°åˆ†è§£**ï¼šé€‚ç”¨äºæ±‚æœ€å¤§å…¬çº¦æ•°ã€æœ€å°å…¬å€æ•°ç­‰é—®é¢˜ã€‚  
- **æ‰©å±•æ¬§å‡ é‡Œå¾—**ï¼šæ±‚è§£åŒä½™æ–¹ç¨‹ï¼ˆå¦‚P1082ï¼‰ã€äºŒå…ƒä¸å®šæ–¹ç¨‹ã€‚  
- **åŒä½™æœ€çŸ­è·¯**ï¼šå¤„ç†å¤šå˜é‡ä¸å®šæ–¹ç¨‹ï¼ˆå¦‚P3403ï¼‰ã€èµ„æºåˆ†é…é—®é¢˜ã€‚

### æ´›è°·ç»ƒä¹ æ¨è
1. **P3403 è·³æ¥¼æœº**ï¼šåŒä½™æœ€çŸ­è·¯ç»å…¸é¢˜ï¼Œå·©å›ºâ€œæ¨¡æœ€å°æ•°æ±‚æœ€çŸ­è·¯å¾„â€çš„æ€è·¯ã€‚  
2. **P1082 åŒä½™æ–¹ç¨‹**ï¼šç»ƒä¹ æ‰©å±•æ¬§å‡ é‡Œå¾—ï¼Œæ±‚è§£`ax â‰¡ 1 mod b`çš„è§£ã€‚  
3. **P2680 è¿è¾“è®¡åˆ’**ï¼šæ ‘ä¸Šæœ€çŸ­è·¯é—®é¢˜ï¼Œç†è§£æœ€çŸ­è·¯çš„åº”ç”¨åœºæ™¯ã€‚  
4. **P1414 åˆæ˜¯æ¯•ä¸šå­£**ï¼šè´¨å› æ•°åˆ†è§£ä¸æ•°è®ºä¼˜åŒ–ï¼Œå·©å›ºè´¨å› æ•°çš„åº”ç”¨ã€‚


## 7. å­¦ä¹ å¿ƒå¾—ä¸ç»éªŒåˆ†äº«

### å‚è€ƒç»éªŒï¼ˆæ¥è‡ªGordon_Songï¼‰
> â€œæˆ‘ä¸€å¼€å§‹ç”¨æš´åŠ›åˆ†è§£å¤§kï¼Œç»“æœè¶…æ—¶äº†ã€‚åæ¥å­¦äº†Pollard-Rhoæ‰è§£å†³ï¼Œè¿™è®©æˆ‘æ˜ç™½å¤§æ•°é—®é¢˜éœ€è¦æ›´é«˜æ•ˆçš„ç®—æ³•ã€‚â€  
**ç‚¹è¯„**ï¼šæš´åŠ›åˆ†è§£ä»…é€‚ç”¨äºå°kï¼ŒPollard-Rhoæ˜¯å¤„ç†å¤§æ•°åˆ†è§£çš„â€œåˆ©å™¨â€ï¼Œå­¦ä¹ ç®—æ³•æ—¶è¦æ³¨æ„åœºæ™¯é€‚é…ã€‚

### å‚è€ƒç»éªŒï¼ˆæ¥è‡ªcyffffï¼‰
> â€œåŒä½™æœ€çŸ­è·¯çš„å…³é”®æ˜¯é€‰æœ€å°è´¨å› æ•°ä½œæ¨¡æ•°ï¼Œæˆ‘ä¸€å¼€å§‹æ²¡æƒ³åˆ°ï¼Œçœ‹äº†P3403çš„é¢˜è§£æ‰æ˜ç™½ã€‚â€  
**ç‚¹è¯„**ï¼šæ¨¡æ•°é€‰æ‹©ç›´æ¥å½±å“ç®—æ³•æ•ˆç‡ï¼Œé€‰æœ€å°è´¨å› æ•°å¯å‡å°‘èŠ‚ç‚¹æ•°é‡ï¼Œæ˜¯åŒä½™æœ€çŸ­è·¯çš„æ ¸å¿ƒæŠ€å·§ã€‚


## ç»“è®º
CF986Fæ˜¯ä¸€é“ç»¼åˆæ•°è®ºé¢˜ï¼Œè¦†ç›–äº†è´¨å› æ•°åˆ†è§£ã€æ‰©å±•æ¬§å‡ é‡Œå¾—å’ŒåŒä½™æœ€çŸ­è·¯ä¸‰å¤§æ ¸å¿ƒç®—æ³•ã€‚é€šè¿‡è¿™é“é¢˜çš„å­¦ä¹ ï¼Œä½ èƒ½æŒæ¡æ•°è®ºé—®é¢˜çš„é€šç”¨è§£é¢˜æ€è·¯ï¼š**è½¬åŒ–é—®é¢˜â†’é€‰æ‹©åˆé€‚çš„ç®—æ³•â†’ä¼˜åŒ–å®ç°**ã€‚

è®°ä½ï¼Œç¼–ç¨‹çš„æœ¬è´¨æ˜¯è§£å†³é—®é¢˜ï¼Œè€Œç®—æ³•æ˜¯è§£å†³é—®é¢˜çš„å·¥å…·ã€‚å¤šç»ƒä¹ ã€å¤šæ€è€ƒï¼Œä½ ä¼šè¶Šæ¥è¶Šç†Ÿç»ƒï¼ä¸‹æ¬¡æˆ‘ä»¬å†ä¸€èµ·æ¢ç´¢æ–°çš„æŒ‘æˆ˜ï½ ğŸ’ª

---
å¤„ç†ç”¨æ—¶ï¼š200.48ç§’
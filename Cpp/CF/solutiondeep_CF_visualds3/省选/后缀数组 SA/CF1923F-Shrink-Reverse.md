# é¢˜ç›®ä¿¡æ¯

# Shrink-Reverse

## é¢˜ç›®æè¿°

ç»™å®šä¸€ä¸ªé•¿åº¦ä¸º $n$ çš„äºŒè¿›åˆ¶å­—ç¬¦ä¸² $s$ï¼ˆå³ç”± $n$ ä¸ªå­—ç¬¦ç»„æˆï¼Œæ¯ä¸ªå­—ç¬¦éƒ½æ˜¯ $0$ æˆ– $1$ï¼‰ã€‚

æˆ‘ä»¬å°† $s$ çœ‹ä½œæŸä¸ªæ•´æ•°çš„äºŒè¿›åˆ¶è¡¨ç¤ºï¼Œå¹¶ç§°è¯¥æ•´æ•°ä¸ºå­—ç¬¦ä¸² $s$ çš„å€¼ã€‚ä¾‹å¦‚ï¼Œ$000$ çš„å€¼æ˜¯ $0$ï¼Œ$01101$ çš„å€¼æ˜¯ $13$ï¼Œ$100000$ çš„å€¼æ˜¯ $32$ï¼Œä»¥æ­¤ç±»æ¨ã€‚

ä½ æœ€å¤šå¯ä»¥å¯¹ $s$ æ‰§è¡Œ $k$ æ¬¡æ“ä½œã€‚æ¯æ¬¡æ“ä½œå¯ä»¥æ˜¯ä»¥ä¸‹ä¸¤ç§ç±»å‹ä¹‹ä¸€ï¼š

- SWAPï¼šé€‰æ‹© $s$ ä¸­çš„ä¸¤ä¸ªä¸‹æ ‡ $i < j$ï¼Œäº¤æ¢ $s_i$ å’Œ $s_j$ï¼›
- SHRINK-REVERSEï¼šåˆ é™¤ $s$ çš„æ‰€æœ‰å‰å¯¼é›¶ï¼Œç„¶åå°† $s$ åè½¬ã€‚

ä¾‹å¦‚ï¼Œå¯¹ $000101100$ æ‰§è¡Œ SHRINK-REVERSE æ“ä½œåï¼Œä¼šå¾—åˆ° $001101$ã€‚

è¯·é—®ï¼Œæœ€å¤šç»è¿‡ $k$ æ¬¡æ“ä½œåï¼Œ$s$ çš„æœ€å°å¯èƒ½å€¼æ˜¯å¤šå°‘ï¼Ÿç”±äºç­”æ¡ˆå¯èƒ½å¾ˆå¤§ï¼Œè¯·è¾“å‡ºå¯¹ $10^9+7$ å–æ¨¡çš„ç»“æœã€‚

æ³¨æ„ï¼Œä½ éœ€è¦æœ€å°åŒ–åŸå§‹å€¼ï¼Œè€Œä¸æ˜¯æœ€å°åŒ–å–æ¨¡åçš„ç»“æœã€‚

## è¯´æ˜/æç¤º

åœ¨ç¬¬ä¸€ä¸ªæ ·ä¾‹ä¸­ï¼Œä¸€ç§æœ€ä¼˜ç­–ç•¥å¦‚ä¸‹ï¼š

1. $10010010 \xrightarrow{\texttt{SWAP}} 00010110$ï¼›
2. $00010110 \xrightarrow{\texttt{SWAP}} 00000111$ã€‚

$00000111$ çš„å€¼ä¸º $7$ã€‚

åœ¨ç¬¬äºŒä¸ªæ ·ä¾‹ä¸­ï¼Œä¸€ç§æœ€ä¼˜ç­–ç•¥å¦‚ä¸‹ï¼š

1. $01101000 \xrightarrow{\texttt{SHRINK}} 1101000 \xrightarrow{\texttt{REVERSE}} 0001011$ï¼›
2. $0001011 \xrightarrow{\texttt{SWAP}} 0000111$ã€‚

$0000111$ çš„å€¼ä¸º $7$ã€‚

ç”± ChatGPT 4.1 ç¿»è¯‘

## æ ·ä¾‹ #1

### è¾“å…¥

```
8 2
10010010```

### è¾“å‡º

```
7```

## æ ·ä¾‹ #2

### è¾“å…¥

```
8 2
01101000```

### è¾“å‡º

```
7```

## æ ·ä¾‹ #3

### è¾“å…¥

```
30 30
111111111111111111111111111111```

### è¾“å‡º

```
73741816```

## æ ·ä¾‹ #4

### è¾“å…¥

```
14 1
10110001111100```

### è¾“å‡º

```
3197```

# AIåˆ†æç»“æœ

---
# ğŸ’¡ Kayçš„C++ç®—æ³•è§£æï¼šShrink-Reverse æ·±å…¥å­¦ä¹ æŒ‡å— ğŸ’¡

å¤§å®¶å¥½ï¼ä»Šå¤©æˆ‘ä»¬è¦ä¸€èµ·è§£å†³ã€ŒShrink-Reverseã€è¿™é“äºŒè¿›åˆ¶å­—ç¬¦ä¸²æ“ä½œé¢˜ã€‚è¿™é“é¢˜ä¸ä»…è€ƒå¯Ÿè´ªå¿ƒç­–ç•¥ï¼Œè¿˜ç”¨åˆ°äº†**å­—ç¬¦ä¸²å¤„ç†çš„åˆ©å™¨â€”â€”åç¼€æ•°ç»„ï¼ˆSAï¼‰**ï¼Œè®©æˆ‘ä»¬ä¸€æ­¥æ­¥æ‹†è§£å®ƒå§ï¼


## 1. é¢˜ç›®è§£è¯»ä¸æ ¸å¿ƒç®—æ³•è¯†åˆ«

âœ¨ **æœ¬é¢˜ä¸»è¦è€ƒå¯Ÿ**ï¼š`å­—ç¬¦ä¸²ï¼ˆåç¼€æ•°ç»„åº”ç”¨ï¼‰ + è´ªå¿ƒç­–ç•¥`

### ğŸ—£ï¸ åˆæ­¥åˆ†æ
æˆ‘ä»¬çš„ç›®æ ‡æ˜¯é€šè¿‡æœ€å¤škæ¬¡æ“ä½œï¼ˆäº¤æ¢æˆ–å»å‰å¯¼é›¶åè½¬ï¼‰ï¼Œè®©äºŒè¿›åˆ¶å­—ç¬¦ä¸²çš„å€¼æœ€å°ã€‚äºŒè¿›åˆ¶æ•°çš„å¤§å°è§„åˆ™å¾ˆç®€å•ï¼š**è¶ŠçŸ­è¶Šå°ï¼Œé•¿åº¦ç›¸åŒåˆ™å­—å…¸åºè¶Šå°**ã€‚æ¯”å¦‚`111`ï¼ˆ7ï¼‰æ¯”`1000`ï¼ˆ8ï¼‰å°ï¼Œ`0011`ï¼ˆ3ï¼‰å’Œ`0101`ï¼ˆ5ï¼‰é•¿åº¦ç›¸åŒï¼Œä½†å‰è€…å­—å…¸åºæ›´å°ã€‚

#### æ ¸å¿ƒç®—æ³•çš„æ¯”å–»è§£é‡Š
- **è´ªå¿ƒç­–ç•¥**ï¼šå°±åƒæ•´ç†ç©å…·â€”â€”æŠŠæ‰€æœ‰`1`å°½å¯èƒ½â€œæŒ¤åˆ°ä¸€èµ·â€ï¼Œè®©äºŒè¿›åˆ¶æ•°çš„é•¿åº¦æœ€çŸ­ã€‚æ¯”å¦‚æœ‰3ä¸ª`1`ï¼Œå¦‚æœèƒ½æŠŠå®ƒä»¬å…¨æ”¾åœ¨æœ€åä¸‰ä½ï¼Œå¾—åˆ°`000111`ï¼ˆ7ï¼‰ï¼Œè¿™æ¯”åˆ†æ•£çš„`101010`ï¼ˆ42ï¼‰å°å¾—å¤šï¼
- **åç¼€æ•°ç»„ï¼ˆSAï¼‰**ï¼šç›¸å½“äºç»™å­—ç¬¦ä¸²çš„æ‰€æœ‰â€œå°¾å·´â€ï¼ˆåç¼€ï¼‰æŒ‰å­—å…¸åºæ’å¥½é˜Ÿã€‚æ¯”å¦‚å­—ç¬¦ä¸²`1011`çš„åç¼€æœ‰`1011`ã€`011`ã€`11`ã€`1`ï¼Œæ’å¥½åºåæ˜¯`011`ï¼ˆç¬¬2ä½å¼€å§‹ï¼‰ã€`1`ï¼ˆç¬¬4ä½ï¼‰ã€`1011`ï¼ˆç¬¬1ä½ï¼‰ã€`11`ï¼ˆç¬¬3ä½ï¼‰ã€‚è¿™æ ·æ‰¾æœ€å°å­—å…¸åºçš„åç¼€å°±åƒä»é˜Ÿä¼é‡ŒæŒ‘ç¬¬ä¸€ä¸ªäººï¼Œåˆå¿«åˆå‡†ï¼

#### é¢˜è§£æ€è·¯ä¸æ ¸å¿ƒéš¾ç‚¹
æ‰€æœ‰é¢˜è§£éƒ½å›´ç»•ä¸¤ä¸ªå…³é”®ç»“è®ºå±•å¼€ï¼š
1. **åè½¬æ“ä½œæœ€å¤šç”¨1æ¬¡**ï¼šåè½¬ä¸¤æ¬¡çš„æ•ˆæœå¯ä»¥ç”¨äº¤æ¢æ›¿ä»£ï¼Œè¿˜èƒ½è®©ç»“æœæ›´ä¼˜ï¼ˆæ¯”å¦‚åè½¬ä¸¤æ¬¡ä¸å¦‚åè½¬ä¸€æ¬¡åäº¤æ¢ï¼‰ã€‚
2. **æœ€å°åŒ–é•¿åº¦ä¼˜å…ˆ**ï¼šå…ˆæŠŠ`1`èšé›†èµ·æ¥è®©äºŒè¿›åˆ¶æ•°æœ€çŸ­ï¼Œå†æ¯”è¾ƒå­—å…¸åºã€‚

æ ¸å¿ƒéš¾ç‚¹æœ‰ä¸‰ä¸ªï¼š
- å¦‚ä½•è¯æ˜â€œåè½¬æœ€å¤š1æ¬¡â€ï¼Ÿ
- å¦‚ä½•ç”¨è´ªå¿ƒèšé›†`1`ï¼Ÿ
- å¦‚ä½•å¿«é€Ÿæ¯”è¾ƒä¸åŒåŒºé—´çš„å­—å…¸åºï¼Ÿ

**è§£å†³æ–¹æ¡ˆ**ï¼š
- ç”¨é€»è¾‘æ¨å¯¼åè½¬æ¬¡æ•°ï¼ˆä¸¤æ¬¡åè½¬çš„æ•ˆæœä¸å¦‚ä¸€æ¬¡äº¤æ¢ï¼‰ï¼›
- è´ªå¿ƒäº¤æ¢ï¼šæŠŠæœ€å‰é¢çš„`1`å’Œæœ€åé¢çš„`0`äº¤æ¢ï¼ˆä¸åè½¬æ—¶ï¼‰ï¼›
- åç¼€æ•°ç»„ï¼šç»™åè½¬åçš„å­—ç¬¦ä¸²å»ºSAï¼Œå¿«é€Ÿæ‰¾åˆ°æœ€å°å­—å…¸åºçš„åŒºé—´ã€‚

#### å¯è§†åŒ–è®¾è®¡æ€è·¯
æˆ‘ä»¬ä¼šç”¨**8ä½åƒç´ é£**æ¨¡æ‹Ÿç®—æ³•è¿‡ç¨‹ï¼š
- äºŒè¿›åˆ¶ä¸²æ˜¯åƒç´ å—ç»„æˆçš„â€œä¼ é€å¸¦â€ï¼Œ`0`æ˜¯è“è‰²ï¼Œ`1`æ˜¯çº¢è‰²ï¼›
- äº¤æ¢æ“ä½œï¼šä¸¤ä¸ªåƒç´ å—é—ªçƒå¹¶äº¤æ¢ä½ç½®ï¼Œä¼´éšâ€œå®â€çš„éŸ³æ•ˆï¼›
- åè½¬æ“ä½œï¼šä¼ é€å¸¦æ•´ä½“ç¿»è½¬ï¼Œåƒç´ å—ä»å³å¾€å·¦æ»‘åŠ¨ï¼Œä¼´éšâ€œå“—å•¦â€çš„éŸ³æ•ˆï¼›
- SAæ’åºï¼šåç¼€åƒâ€œå°ç«è½¦â€ä¸€æ ·æŒ‰å­—å…¸åºæ’é˜Ÿï¼Œæ’å¤´çš„åç¼€ç”¨é»„è‰²é«˜äº®ï¼›
- æ§åˆ¶é¢æ¿æœ‰â€œå•æ­¥â€â€œè‡ªåŠ¨â€æŒ‰é’®ï¼Œé€Ÿåº¦æ»‘å—ï¼Œè¿˜æœ‰8ä½é£æ ¼çš„BGMï¼


## 2. ç²¾é€‰ä¼˜è´¨é¢˜è§£å‚è€ƒ

ä¸ºå¤§å®¶ç­›é€‰äº†4ç¯‡æ€è·¯æ¸…æ™°ã€ä»£ç è§„èŒƒçš„ä¼˜è´¨é¢˜è§£ï¼Œä¸€èµ·æ¥çœ‹çœ‹å§ï¼

### é¢˜è§£ä¸€ï¼š(æ¥æºï¼šxiezheyuan)
* **ç‚¹è¯„**ï¼šè¿™é“é¢˜çš„â€œç ´é¢˜å…³é”®â€è¢«ä½œè€…è®²å¾—æ˜æ˜ç™½ç™½ï¼ä½œè€…å…ˆè¯æ˜äº†â€œåè½¬æœ€å¤š1æ¬¡â€ï¼Œå†ç”¨**è´ªå¿ƒäº¤æ¢**å¤„ç†ä¸åè½¬çš„æƒ…å†µï¼Œç”¨**åç¼€æ•°ç»„**å¤„ç†åè½¬åçš„æƒ…å†µã€‚ä»£ç åˆ†æˆ`solve0`ï¼ˆä¸åè½¬ï¼‰å’Œ`solve1`ï¼ˆåè½¬ï¼‰ä¸¤ä¸ªå‡½æ•°ï¼Œé€»è¾‘æ¸…æ™°ã€‚å°¤å…¶æ˜¯`solve1`ä¸­ç”¨SAæ‰¾æœ€å°å­—å…¸åºåŒºé—´çš„éƒ¨åˆ†ï¼Œç›´æ¥è°ƒç”¨äº†åç¼€æ•°ç»„æ¨¡æ¿ï¼Œéå¸¸è§„èŒƒï¼

### é¢˜è§£äºŒï¼š(æ¥æºï¼šsunkuangzheng)
* **ç‚¹è¯„**ï¼šä½œè€…çš„â€œæ€§è´¨åˆ†æâ€è¶…æœ‰ç”¨ï¼æ¯”å¦‚â€œç­”æ¡ˆä¸²é•¿åº¦ä¸€å®šæ˜¯æœ€å°çš„â€â€œé•¿åº¦ç›¸åŒé€‰å­—å…¸åºæœ€å°â€ï¼ŒæŠŠé—®é¢˜æ‹†è§£æˆâ€œå…ˆç¼©é•¿åº¦ï¼Œå†æ¯”å­—å…¸åºâ€ã€‚ä»£ç ä¸­ç”¨äº†SAçš„å€å¢æ³•å®ç°ï¼Œè™½ç„¶å¤æ‚åº¦æ˜¯O(n logÂ²n)ï¼Œä½†å¯¹äº5e5çš„æ•°æ®ä¹Ÿèƒ½è¿‡ã€‚æ›´æ£’çš„æ˜¯ï¼Œä½œè€…åœ¨ä»£ç é‡ŒåŠ äº†æ³¨é‡Šï¼Œæ¯”å¦‚`lt = c - k`è¡¨ç¤ºä¸èƒ½ç§»åŠ¨çš„`1`çš„æ•°é‡ï¼Œæ–°æ‰‹ä¹Ÿèƒ½çœ‹æ‡‚ï¼

### é¢˜è§£ä¸‰ï¼š(æ¥æºï¼šMaxBlazeResFire)
* **ç‚¹è¯„**ï¼šä½œè€…ç”¨äº†**åç¼€è‡ªåŠ¨æœºï¼ˆSAMï¼‰**ä»£æ›¿SAï¼Œå¤æ‚åº¦é™åˆ°äº†O(n)ï¼è¿™æ˜¯éå¸¸é«˜æ•ˆçš„ä¼˜åŒ–â€”â€”SAMæ„å»ºåç¼€æ•°ç»„çš„é€Ÿåº¦æ¯”å€å¢æ³•æ›´å¿«ï¼Œé€‚åˆå¤§æ•°æ®ã€‚ä»£ç ä¸­`Sam.dfs`å‡½æ•°éå†SAMç”ŸæˆSAï¼Œé€»è¾‘å¾ˆå·§å¦™ã€‚è™½ç„¶SAMçš„ä»£ç æœ‰ç‚¹å¤æ‚ï¼Œä½†ä½œè€…æŠŠâ€œä¸åè½¬â€å’Œâ€œåè½¬â€çš„å¤„ç†åˆ†å¼€ï¼Œç»“æ„æ¸…æ™°ï¼Œå€¼å¾—å­¦ä¹ ï¼


## 3. æ ¸å¿ƒéš¾ç‚¹è¾¨æä¸è§£é¢˜ç­–ç•¥

### å…³é”®ç‚¹1ï¼šä¸ºä»€ä¹ˆåè½¬æœ€å¤š1æ¬¡ï¼Ÿ
- **åˆ†æ**ï¼šåè½¬ä¸¤æ¬¡çš„æ•ˆæœæ˜¯â€œå»å‰å¯¼é›¶â†’åè½¬â†’å†å»å‰å¯¼é›¶â†’å†åè½¬â€ï¼Œç›¸å½“äºå»æ‰äº†åŸä¸²çš„å‰å¯¼å’Œåå¯¼é›¶ï¼Œä½†é•¿åº¦ä¸å˜ã€‚è€Œåè½¬ä¸€æ¬¡åï¼Œç”¨äº¤æ¢æ“ä½œæŠŠ`1`èšé›†ï¼Œèƒ½è®©é•¿åº¦æ›´çŸ­ï¼ˆæ¯”å¦‚åè½¬åçš„ä¸²`000100111`ï¼Œäº¤æ¢åå˜æˆ`1111`ï¼Œé•¿åº¦4ï¼Œæ¯”ä¸¤æ¬¡åè½¬åçš„`111001`ï¼ˆé•¿åº¦6ï¼‰æ›´å°ï¼‰ã€‚
- ğŸ’¡ å­¦ä¹ ç¬”è®°ï¼šæ“ä½œæ¬¡æ•°è¦â€œçœç€ç”¨â€ï¼Œä¼˜å…ˆé€‰èƒ½ç¼©å°é•¿åº¦çš„æ“ä½œï¼

### å…³é”®ç‚¹2ï¼šå¦‚ä½•è´ªå¿ƒèšé›†`1`ï¼Ÿ
- **åˆ†æ**ï¼šä¸åè½¬æ—¶ï¼ŒæŠŠæœ€å‰é¢çš„`1`å’Œæœ€åé¢çš„`0`äº¤æ¢ï¼ˆæ¯”å¦‚`10010010`â†’äº¤æ¢ç¬¬1ä½å’Œç¬¬8ä½â†’`00010110`ï¼Œå†äº¤æ¢ç¬¬2ä½å’Œç¬¬7ä½â†’`00000111`ï¼‰ã€‚è¿™æ ·`1`éƒ½è·‘åˆ°åé¢ï¼ŒäºŒè¿›åˆ¶æ•°æ›´çŸ­ã€‚
- ğŸ’¡ å­¦ä¹ ç¬”è®°ï¼šè´ªå¿ƒçš„æ ¸å¿ƒæ˜¯â€œä¼˜å…ˆè§£å†³å½±å“æœ€å¤§çš„é—®é¢˜â€â€”â€”é•¿åº¦æ¯”å­—å…¸åºæ›´é‡è¦ï¼

### å…³é”®ç‚¹3ï¼šå¦‚ä½•ç”¨SAæ¯”è¾ƒå­—å…¸åºï¼Ÿ
- **åˆ†æ**ï¼šåè½¬åçš„å­—ç¬¦ä¸²ï¼Œæˆ‘ä»¬éœ€è¦æ‰¾â€œèƒ½å®¹çº³æ‰€æœ‰`1`çš„æœ€çŸ­åŒºé—´â€ï¼Œå†æ¯”è¾ƒè¿™äº›åŒºé—´çš„å­—å…¸åºã€‚SAæŠŠæ‰€æœ‰åç¼€æŒ‰å­—å…¸åºæ’å¥½ï¼Œç›´æ¥å–ç¬¬ä¸€ä¸ªç¬¦åˆæ¡ä»¶çš„åç¼€å³å¯ï¼ˆæ¯”å¦‚åç¼€`011`æ¯”`1011`å°ï¼‰ã€‚
- ğŸ’¡ å­¦ä¹ ç¬”è®°ï¼šå­—ç¬¦ä¸²æ¯”è¾ƒçš„â€œç¥å™¨â€æ˜¯åç¼€æ•°ç»„ï¼Œå®ƒèƒ½æŠŠO(nÂ²)çš„æ¯”è¾ƒå˜æˆO(n log n)ï¼


## 4. C++æ ¸å¿ƒä»£ç å®ç°èµæ

### æœ¬é¢˜é€šç”¨æ ¸å¿ƒC++å®ç°å‚è€ƒ
* **è¯´æ˜**ï¼šç»¼åˆäº†xiezheyuanå’Œsunkuangzhengçš„æ€è·¯ï¼Œè¦†ç›–â€œä¸åè½¬â€å’Œâ€œåè½¬+SAâ€ä¸¤ç§æƒ…å†µï¼Œé€»è¾‘æ¸…æ™°ã€‚

```cpp
#include <iostream>
#include <string>
#include <algorithm>
#include <vector>
using namespace std;

const int mod = 1e9 + 7;

// ä¸åè½¬çš„è´ªå¿ƒäº¤æ¢
string solve0(string s, int n, int k) {
    int L = 0, R = n - 1;
    while (k--) {
        // æ‰¾æœ€å‰é¢çš„1
        while (L < n && s[L] == '0') L++;
        // æ‰¾æœ€åé¢çš„0
        while (R >= 0 && s[R] == '1') R--;
        if (L >= R) break;
        swap(s[L], s[R]);
        L++; R--;
    }
    return s;
}

// åç¼€æ•°ç»„æ¨¡æ¿ï¼ˆå€å¢æ³•ï¼‰
struct SuffixArray {
    vector<int> sa, rk, tmp;
    int n;

    SuffixArray(string s) {
        n = s.size();
        sa.resize(n);
        rk.resize(n);
        tmp.resize(n);
        for (int i = 0; i < n; i++) {
            sa[i] = i;
            rk[i] = s[i];
        }
        for (int k = 1; k < n; k <<= 1) {
            sort(sa.begin(), sa.end(), [&](int a, int b) {
                return rk[a] != rk[b] ? rk[a] < rk[b] : rk[(a + k) % n] < rk[(b + k) % n];
            });
            tmp[sa[0]] = 0;
            for (int i = 1; i < n; i++) {
                tmp[sa[i]] = tmp[sa[i-1]] + (rk[sa[i]] != rk[sa[i-1]] || rk[(sa[i]+k)%n] != rk[(sa[i-1]+k)%n]);
            }
            rk.swap(tmp);
        }
    }
};

// åè½¬åçš„å¤„ç†ï¼ˆç”¨SAæ‰¾æœ€å°åŒºé—´ï¼‰
string solve1(string s, int n, int k) {
    reverse(s.begin(), s.end());
    SuffixArray sa(s);
    int total = count(s.begin(), s.end(), '1');
    vector<pair<int, int>> intervals;
    int cnt = 0, R = 0;
    for (int L = 0; L < n; L++) {
        while (R < n && !( (R-L+1 >= total) && (total - cnt <= k-1) )) {
            cnt += (s[R] == '1');
            R++;
        }
        if (R >= n) break;
        intervals.emplace_back(L, R-L+1);
        cnt -= (s[L] == '1');
    }
    // æ‰¾æœ€å°é•¿åº¦ã€æœ€å°å­—å…¸åºçš„åŒºé—´
    pair<int, int> best = intervals[0];
    for (auto [l, len] : intervals) {
        if (len < best.second || (len == best.second && sa.rk[l] < sa.rk[best.first])) {
            best = {l, len};
        }
    }
    string ret = s.substr(best.first, best.second);
    int ext = total - count(ret.begin(), ret.end(), '1');
    reverse(ret.begin(), ret.end());
    for (char& c : ret) {
        if (c == '0' && ext-- > 0) c = '1';
    }
    reverse(ret.begin(), ret.end());
    return ret;
}

// å»æ‰å‰å¯¼é›¶
string wash(string s) {
    size_t pos = s.find('1');
    if (pos == string::npos) return "0";
    return s.substr(pos);
}

int main() {
    int n, k;
    string s;
    cin >> n >> k >> s;
    string res0 = wash(solve0(s, n, k));
    string res1 = wash(solve1(s, n, k));
    string ans;
    if (res0.size() < res1.size()) ans = res0;
    else if (res0.size() > res1.size()) ans = res1;
    else ans = min(res0, res1);
    // è®¡ç®—äºŒè¿›åˆ¶å€¼
    long long ret = 0;
    for (char c : ans) {
        ret = (ret * 2 + (c == '1')) % mod;
    }
    cout << ret << endl;
    return 0;
}
```

* **ä»£ç è§£è¯»æ¦‚è¦**ï¼š
  1. `solve0`ï¼šç”¨åŒæŒ‡é’ˆæ‰¾æœ€å‰çš„`1`å’Œæœ€åçš„`0`ï¼Œäº¤æ¢kæ¬¡ï¼›
  2. `solve1`ï¼šåè½¬å­—ç¬¦ä¸²åå»ºSAï¼Œæ‰¾èƒ½å®¹çº³æ‰€æœ‰`1`çš„æœ€çŸ­åŒºé—´ï¼Œå†è°ƒæ•´`1`çš„ä½ç½®ï¼›
  3. `wash`ï¼šå»æ‰å‰å¯¼é›¶ï¼Œå¾—åˆ°æœ‰æ•ˆäºŒè¿›åˆ¶ä¸²ï¼›
  4. ä¸»å‡½æ•°ï¼šæ¯”è¾ƒä¸¤ç§æƒ…å†µçš„ç»“æœï¼Œå–æœ€å°çš„è®¡ç®—æ•°å€¼ã€‚


### é¢˜è§£ä¸€ï¼ˆxiezheyuanï¼‰æ ¸å¿ƒç‰‡æ®µèµæ
* **äº®ç‚¹**ï¼šç”¨ç®€æ´çš„åŒæŒ‡é’ˆå®ç°è´ªå¿ƒäº¤æ¢ï¼ŒSAæ¨¡æ¿æ¸…æ™°ã€‚
* **æ ¸å¿ƒä»£ç ç‰‡æ®µ**ï¼š
  ```cpp
  string solve0(string s) {
      s = ' ' + s;
      int L = 1, R = n;
      string ret = s;
      for (int i = 1; i <= k; i++) {
          while (L <= n && s[L] != '1') L++;
          while (R >= 1 && s[R] != '0') R--;
          if (L > R) break;
          swap(ret[L], ret[R]);
          L++; R--;
      }
      return ret;
  }
  ```
* **ä»£ç è§£è¯»**ï¼š
  - `L`æ‰¾æœ€å‰é¢çš„`1`ï¼Œ`R`æ‰¾æœ€åé¢çš„`0`ï¼›
  - äº¤æ¢åï¼Œ`L`å³ç§»ã€`R`å·¦ç§»ï¼Œç»§ç»­æ‰¾ä¸‹ä¸€å¯¹ï¼›
  - æœ€å¤šäº¤æ¢kæ¬¡ï¼Œç›´åˆ°æ²¡æœ‰å¯äº¤æ¢çš„`1`å’Œ`0`ã€‚
* ğŸ’¡ å­¦ä¹ ç¬”è®°ï¼šåŒæŒ‡é’ˆæ˜¯è´ªå¿ƒäº¤æ¢çš„â€œæ ‡é…â€ï¼Œç®€å•åˆé«˜æ•ˆï¼


## 5. ç®—æ³•å¯è§†åŒ–ï¼šåƒç´ åŠ¨ç”»æ¼”ç¤º

### åŠ¨ç”»ä¸»é¢˜ï¼šã€Šåƒç´ äºŒè¿›åˆ¶å¤§å†’é™©ã€‹
ç”¨8ä½åƒç´ é£æ¨¡æ‹ŸäºŒè¿›åˆ¶ä¸²çš„æ“ä½œè¿‡ç¨‹ï¼Œåƒç©FCæ¸¸æˆä¸€æ ·å­¦ç®—æ³•ï¼

### æ ¸å¿ƒæ¼”ç¤ºå†…å®¹
1. **åœºæ™¯åˆå§‹åŒ–**ï¼š
   - å±å¹•ä¸Šæ˜¯â€œåƒç´ ä¼ é€å¸¦â€ï¼Œæ¯ä¸ª`0`æ˜¯è“è‰²æ–¹å—ï¼Œ`1`æ˜¯çº¢è‰²æ–¹å—ï¼›
   - æ§åˆ¶é¢æ¿æœ‰â€œå¼€å§‹â€â€œå•æ­¥â€â€œé‡ç½®â€æŒ‰é’®ï¼Œé€Ÿåº¦æ»‘å—ï¼Œè¿˜æœ‰8ä½é£æ ¼çš„BGMï¼ˆæ¯”å¦‚ã€Šè¶…çº§é©¬é‡Œå¥¥ã€‹çš„å°èƒŒæ™¯éŸ³ä¹ï¼‰ã€‚

2. **ä¸åè½¬çš„è´ªå¿ƒäº¤æ¢**ï¼š
   - ä¼ é€å¸¦æœ€å‰é¢çš„`1`ï¼ˆçº¢è‰²ï¼‰å’Œæœ€åé¢çš„`0`ï¼ˆè“è‰²ï¼‰é—ªçƒï¼›
   - ä¸¤ä¸ªæ–¹å—äº¤æ¢ä½ç½®ï¼Œä¼´éšâ€œå®â€çš„éŸ³æ•ˆï¼›
   - äº¤æ¢åçš„`1`ç§»åˆ°åé¢ï¼Œ`0`ç§»åˆ°å‰é¢ï¼Œä¼ é€å¸¦æ›´æ–°ã€‚

3. **åè½¬æ“ä½œ**ï¼š
   - ä¼ é€å¸¦æ•´ä½“ç¿»è½¬ï¼Œåƒç´ å—ä»å³å¾€å·¦æ»‘åŠ¨ï¼Œä¼´éšâ€œå“—å•¦â€çš„éŸ³æ•ˆï¼›
   - åè½¬åçš„ä¸²å»æ‰å‰å¯¼é›¶ï¼Œå‰©ä¸‹çš„éƒ¨åˆ†ç”¨é»„è‰²æ¡†èµ·æ¥ã€‚

4. **SAæ’åºåç¼€**ï¼š
   - åç¼€åƒâ€œå°ç«è½¦â€ä¸€æ ·æ’æˆä¸€é˜Ÿï¼Œå­—å…¸åºå°çš„åç¼€åœ¨å‰é¢ï¼›
   - æ’å¤´çš„åç¼€ç”¨é»„è‰²é«˜äº®ï¼Œä¼´éšâ€œæ»´â€çš„éŸ³æ•ˆï¼›
   - é€‰ä¸­æœ€å°çš„åç¼€åï¼Œä¼ é€å¸¦æ˜¾ç¤ºå¯¹åº”çš„åŒºé—´ï¼Œç”¨ç»¿è‰²æ¡†èµ·æ¥ã€‚

### äº¤äº’è®¾è®¡
- å•æ­¥æ‰§è¡Œï¼šç‚¹å‡»â€œå•æ­¥â€ï¼Œæ¯ä¸€æ­¥æ“ä½œæ…¢åŠ¨ä½œå±•ç¤ºï¼›
- è‡ªåŠ¨æ’­æ”¾ï¼šç‚¹å‡»â€œè‡ªåŠ¨â€ï¼Œç®—æ³•æŒ‰è®¾å®šé€Ÿåº¦è¿è¡Œï¼Œåƒâ€œAIç©æ¸¸æˆâ€ä¸€æ ·ï¼›
- é‡ç½®ï¼šå›åˆ°åˆå§‹çŠ¶æ€ï¼Œé‡æ–°å¼€å§‹æ¼”ç¤ºã€‚

### éŸ³æ•ˆè®¾è®¡
- äº¤æ¢ï¼šâ€œå®â€ï¼ˆç±»ä¼¼ã€Šåƒè±†äººã€‹çš„å¾—åˆ†å£°ï¼‰ï¼›
- åè½¬ï¼šâ€œå“—å•¦â€ï¼ˆç±»ä¼¼ã€Šé­‚æ–—ç½—ã€‹çš„æ¢æªå£°ï¼‰ï¼›
- æ‰¾åˆ°æœ€å°åŒºé—´ï¼šâ€œå®~â€ï¼ˆç±»ä¼¼ã€Šè¶…çº§é©¬é‡Œå¥¥ã€‹çš„è¿‡å…³å£°ï¼‰ï¼›
- BGMï¼šå¾ªç¯æ’­æ”¾ã€Šå¦å…‹å¤§æˆ˜ã€‹çš„èƒŒæ™¯éŸ³ï¼Œè½»æ¾åˆå¤å¤ï¼


## 6. æ‹“å±•ç»ƒä¹ ä¸ç›¸ä¼¼é—®é¢˜

### é€šç”¨æ€è·¯è¿ç§»
- **åç¼€æ•°ç»„**ï¼šæ‰€æœ‰éœ€è¦æ¯”è¾ƒå­—ç¬¦ä¸²åç¼€å­—å…¸åºçš„é—®é¢˜éƒ½èƒ½ç”¨ï¼Œæ¯”å¦‚â€œæ‰¾æœ€å°å¾ªç¯ç§»ä½â€â€œæœ€é•¿é‡å¤å­ä¸²â€ï¼›
- **è´ªå¿ƒç­–ç•¥**ï¼šæ‰€æœ‰â€œæœ€å°åŒ–äºŒè¿›åˆ¶æ•°â€çš„é—®é¢˜éƒ½ä¼˜å…ˆç¼©å°é•¿åº¦ï¼Œæ¯”å¦‚â€œåˆ é™¤kä¸ªå­—ç¬¦æ±‚æœ€å°æ•°â€ã€‚

### æ´›è°·æ¨èç»ƒä¹ 
1. **P3809 ã€æ¨¡æ¿ã€‘åç¼€æ•°ç»„**ï¼šåç¼€æ•°ç»„çš„åŸºç¡€æ¨¡æ¿é¢˜ï¼Œå¸®ä½ ç†Ÿæ‚‰SAçš„æ„å»ºï¼›
2. **P4051 [JSOI2007]å­—ç¬¦åŠ å¯†**ï¼šæ‰¾æœ€å°å¾ªç¯ç§»ä½ï¼Œç”¨SAå¿«é€Ÿè§£å†³ï¼›
3. **P2408 ä¸åŒå­ä¸²ä¸ªæ•°**ï¼šç”¨åç¼€è‡ªåŠ¨æœºï¼ˆSAMï¼‰ç»Ÿè®¡ä¸åŒå­ä¸²ï¼Œå·©å›ºé«˜æ•ˆå­—ç¬¦ä¸²ç®—æ³•ï¼›
4. **P1106 åˆ æ•°é—®é¢˜**ï¼šè´ªå¿ƒåˆ é™¤å­—ç¬¦æ±‚æœ€å°æ•°ï¼Œå’Œæœ¬é¢˜çš„â€œç¼©å°é•¿åº¦â€æ€è·¯ä¸€è‡´ï¼


## 7. å­¦ä¹ å¿ƒå¾—ä¸ç»éªŒåˆ†äº«

> **å‚è€ƒç»éªŒ (æ¥è‡ªxiezheyuan)**ï¼šâ€œè¿™é“é¢˜çš„éš¾ç‚¹ä¸åœ¨SAæœ¬èº«ï¼Œè€Œåœ¨â€˜æ„è¯†åˆ°åè½¬æœ€å¤š1æ¬¡â€™ã€‚æˆ‘ä¸€å¼€å§‹æƒ³äº†å¾ˆä¹…ï¼Œåæ¥ç”¨â€˜ä¸¤æ¬¡åè½¬çš„æ•ˆæœä¸å¦‚ä¸€æ¬¡äº¤æ¢â€™çš„ä¾‹å­è¯´æœäº†è‡ªå·±ã€‚â€
> 
> **ç‚¹è¯„**ï¼šä½œè€…çš„ç»éªŒè¶…æ£’ï¼ç®—æ³•é¢˜çš„â€œç ´é¢˜ç‚¹â€å¾€å¾€åœ¨â€œæ€§è´¨æ¨å¯¼â€ï¼Œè€Œä¸æ˜¯â€œä»£ç å®ç°â€ã€‚é‡åˆ°é—®é¢˜å…ˆæƒ³â€œæœ‰æ²¡æœ‰æ›´ä¼˜çš„æ“ä½œæ–¹å¼â€ï¼Œè€Œä¸æ˜¯æ€¥ç€å†™ä»£ç ï¼Œè¿™èƒ½å¸®ä½ å°‘èµ°å¾ˆå¤šå¼¯è·¯ï¼


## ğŸ’ª æ€»ç»“ä¸é¼“åŠ±
è¿™é“é¢˜æŠŠ**è´ªå¿ƒ**å’Œ**å­—ç¬¦ä¸²ç®—æ³•**ç»“åˆå¾—å¾ˆå·§å¦™ï¼Œæ—¢è€ƒé€»è¾‘æ¨å¯¼ï¼ˆåè½¬æ¬¡æ•°ï¼‰ï¼Œåˆè€ƒä»£ç å®ç°ï¼ˆSA/SAMï¼‰ã€‚å¸Œæœ›å¤§å®¶é€šè¿‡è¿™é“é¢˜ï¼Œå­¦ä¼šï¼š
- ç”¨â€œæ€§è´¨æ¨å¯¼â€ç®€åŒ–é—®é¢˜ï¼›
- ç”¨â€œè´ªå¿ƒç­–ç•¥â€è§£å†³â€œæœ€å°åŒ–â€é—®é¢˜ï¼›
- ç”¨â€œåç¼€æ•°ç»„â€å¤„ç†å­—ç¬¦ä¸²æ¯”è¾ƒã€‚

è®°ä½ï¼šç¼–ç¨‹çš„ä¹è¶£åœ¨äºâ€œæ‹†è§£é—®é¢˜â€â€”â€”æŠŠå¤§é—®é¢˜æ‹†æˆå°æ­¥éª¤ï¼Œä¸€æ­¥æ­¥è§£å†³ï¼ä¸‹æ¬¡é‡åˆ°å­—ç¬¦ä¸²é¢˜ï¼Œä¸å¦¨å…ˆæƒ³æƒ³â€œåç¼€æ•°ç»„èƒ½ä¸èƒ½ç”¨ä¸Šâ€ï¼Ÿ

ä¸‹æ¬¡æˆ‘ä»¬å†ä¸€èµ·æŒ‘æˆ˜æ›´éš¾çš„ç®—æ³•é¢˜ï¼åŠ æ²¹ï¼ğŸ’ª

---
å¤„ç†ç”¨æ—¶ï¼š103.86ç§’
# é¢˜ç›®ä¿¡æ¯

# Gift

## é¢˜ç›®æè¿°

The kingdom of Olympia consists of $ N $ cities and $ M $ bidirectional roads. Each road connects exactly two cities and two cities can be connected with more than one road. Also it possible that some roads connect city with itself making a loop.

All roads are constantly plundered with bandits. After a while bandits became bored of wasting time in road robberies, so they suggested the king of Olympia to pay off. According to the offer, bandits want to get a gift consisted of gold and silver coins. Offer also contains a list of restrictions: for each road it is known $ g_{i} $ â€” the smallest amount of gold and $ s_{i} $ â€” the smallest amount of silver coins that should be in the gift to stop robberies on the road. That is, if the gift contains $ a $ gold and $ b $ silver coins, then bandits will stop robberies on all the roads that $ g_{i}<=a $ and $ s_{i}<=b $ .

Unfortunately kingdom treasury doesn't contain neither gold nor silver coins, but there are Olympian tugriks in it. The cost of one gold coin in tugriks is $ G $ , and the cost of one silver coin in tugriks is $ S $ . King really wants to send bandits such gift that for any two cities there will exist a safe path between them. Your task is to find the minimal cost in Olympian tugriks of the required gift.

## æ ·ä¾‹ #1

### è¾“å…¥

```
3 3
2 1
1 2 10 15
1 2 4 20
1 3 5 1
```

### è¾“å‡º

```
30
```

# AIåˆ†æç»“æœ

# ğŸ’¡ Kayçš„C++ç®—æ³•è§£æï¼šGift æ·±å…¥å­¦ä¹ æŒ‡å— ğŸ’¡


## 1. é¢˜ç›®è§£è¯»ä¸æ ¸å¿ƒç®—æ³•è¯†åˆ«

âœ¨ **æœ¬é¢˜ä¸»è¦è€ƒå¯Ÿ**ï¼šæšä¸¾ä¼˜åŒ– + æœ€å°ç”Ÿæˆæ ‘ï¼ˆKruskalç®—æ³•ï¼‰  

ğŸ—£ï¸ **åˆæ­¥åˆ†æ**ï¼š  
é¢˜ç›®è¦æ±‚æ‰¾åˆ°ä¸€ä¸ªåŒ…å«é‡‘å¸`a`å’Œé“¶å¸`b`çš„ç¤¼ç‰©ï¼Œä½¿å¾—æ‰€æœ‰æ»¡è¶³`g_iâ‰¤a`ä¸”`s_iâ‰¤b`çš„è¾¹èƒ½è®©å›¾è¿é€šï¼Œä¸”æ€»èŠ±è´¹`a*G + b*S`æœ€å°ï¼ˆ`G`ã€`S`æ˜¯é‡‘å¸å’Œé“¶å¸çš„å•ä»·ï¼‰ã€‚  
è§£å†³è¿™ä¸ªé—®é¢˜çš„å…³é”®æ€è·¯æ˜¯**â€œå›ºå®šä¸€ç»´ï¼Œä¼˜åŒ–å¦ä¸€ç»´â€**ï¼š  
- å…ˆæšä¸¾é‡‘å¸çš„æœ€å¤§éœ€æ±‚`max_g`ï¼ˆå³æ‰€æœ‰é€‰ä¸­çš„è¾¹çš„`g_i`éƒ½ä¸è¶…è¿‡`max_g`ï¼‰ï¼›  
- å¯¹äºæ¯ä¸ª`max_g`ï¼Œåœ¨æ»¡è¶³æ¡ä»¶çš„è¾¹ä¸­ï¼Œæ‰¾åˆ°**é“¶å¸çš„æœ€å°ç”Ÿæˆæ ‘**ï¼ˆMSTï¼‰â€”â€”è¿™æ ·é“¶å¸çš„æœ€å¤§éœ€æ±‚`max_s`ä¼šå°½å¯èƒ½å°ï¼Œä»è€Œæ€»èŠ±è´¹æœ€å°ã€‚  

è¿™å°±åƒâ€œå…ˆåˆ’å®šä¸€ä¸ªé‡‘å¸çš„ä¸Šé™ï¼Œå†åœ¨è¿™ä¸ªèŒƒå›´å†…æ‰¾æœ€ä¾¿å®œçš„é“¶å¸ç»„åˆâ€ã€‚æ ¸å¿ƒç®—æ³•æµç¨‹å¦‚ä¸‹ï¼š  
1. å°†æ‰€æœ‰è¾¹æŒ‰`g_i`ä»å°åˆ°å¤§æ’åºï¼›  
2. é€æ­¥åŠ å…¥è¾¹ï¼ˆä»`g`æœ€å°çš„å¼€å§‹ï¼‰ï¼Œç»´æŠ¤ä¸€ä¸ªæŒ‰`s_i`æœ‰åºçš„è¾¹é›†åˆï¼›  
3. å¯¹æ¯ä¸ª`max_g`ï¼ˆå½“å‰åŠ å…¥çš„è¾¹çš„`g`å€¼ï¼‰ï¼Œç”¨Kruskalç®—æ³•æ±‚è¯¥è¾¹é›†åˆçš„æœ€å°ç”Ÿæˆæ ‘ï¼ˆä»¥`s_i`ä¸ºæƒå€¼ï¼‰ï¼›  
4. è®¡ç®—å½“å‰`max_g`å’Œ`max_s`çš„æ€»èŠ±è´¹ï¼Œæ›´æ–°æœ€å°å€¼ã€‚  

**å¯è§†åŒ–è®¾è®¡æ€è·¯**ï¼š  
ç”¨8ä½åƒç´ é£å±•ç¤ºç®—æ³•è¿‡ç¨‹ï¼š  
- åŸå¸‚ç”¨å½©è‰²æ–¹å—è¡¨ç¤ºï¼Œè¾¹ç”¨çº¿æ¡è¿æ¥ï¼Œ`g`å€¼è¶Šå¤§è¾¹çš„é¢œè‰²è¶Šçº¢ï¼Œ`s`å€¼è¶Šå¤§è¾¹çš„é¢œè‰²è¶Šè“ï¼›  
- é€æ­¥åŠ å…¥è¾¹æ—¶ï¼Œè¾¹ä¼šâ€œé—ªçƒâ€è¡¨ç¤ºè¢«é€‰ä¸­ï¼›  
- ç»´æŠ¤`s`æœ‰åºé›†åˆæ—¶ï¼Œè¾¹ä¼šâ€œäº¤æ¢ä½ç½®â€åŠ¨ç”»ï¼ŒæŒ‰è“è‰²æ·±æµ…æ’åˆ—ï¼›  
- Kruskalåˆå¹¶é›†åˆæ—¶ï¼ŒåŸå¸‚ä¼šå˜æˆåŒä¸€é¢œè‰²ï¼Œè¡¨ç¤ºè¿é€šï¼›  
- æ¯å®Œæˆä¸€æ¬¡ç”Ÿæˆæ ‘è®¡ç®—ï¼Œå±å¹•ä¸Šæ–¹ä¼šæ˜¾ç¤ºå½“å‰èŠ±è´¹ï¼Œå¹¶æ›´æ–°æœ€å°å€¼ã€‚  


## 2. ç²¾é€‰ä¼˜è´¨é¢˜è§£å‚è€ƒ

### é¢˜è§£ä¸€ï¼ˆä½œè€…ï¼šwheneverightï¼Œèµ13ï¼‰  
* **ç‚¹è¯„**ï¼š  
  æ€è·¯æ¸…æ™°ï¼Œé€šè¿‡**åŠ¨æ€ç»´æŠ¤è¾¹é›†åˆ**ä¼˜åŒ–äº†æ—¶é—´å¤æ‚åº¦ã€‚ä½œè€…å…ˆç”¨äºŒåˆ†æ‰¾åˆ°ç¬¬ä¸€ä¸ªèƒ½å½¢æˆç”Ÿæˆæ ‘çš„`max_g`ï¼Œç„¶åå¾ªç¯å¤„ç†æ¯ä¸ª`max_g`ï¼š  
  - ç”¨`multiset`å­˜å‚¨è¾¹ï¼Œæ¯æ¬¡Kruskalæ—¶åˆ é™¤ä¸æ»¡è¶³`g_iâ‰¤max_g`çš„è¾¹ï¼ˆè¿™äº›è¾¹ä¸ä¼šå†è¢«ç”¨åˆ°ï¼‰ï¼›  
  - ç”¨å¹¶æŸ¥é›†åˆ¤æ–­è¿é€šæ€§ï¼Œæå‰ç»ˆæ­¢å¾ªç¯ï¼ˆå½“ç”Ÿæˆæ ‘åŒ…å«æ‰€æœ‰èŠ‚ç‚¹æ—¶åœæ­¢ï¼‰ã€‚  
  äº®ç‚¹ï¼š`multiset`çš„åŠ¨æ€ç»´æŠ¤é¿å…äº†é‡å¤å¤„ç†æ— æ•ˆè¾¹ï¼ŒäºŒåˆ†æŸ¥æ‰¾å‡å°‘äº†æšä¸¾æ¬¡æ•°ï¼Œä»£ç ä¸¥è°¨æ€§é«˜ï¼ˆå¤„ç†äº†æ— è§£æƒ…å†µï¼‰ã€‚


### é¢˜è§£äºŒï¼ˆä½œè€…ï¼šElma_ï¼Œèµ12ï¼‰  
* **ç‚¹è¯„**ï¼š  
  æ€è·¯ç®€æ´ï¼Œ**å½’å¹¶æ’å…¥ä¼˜åŒ–æ’åº**æ˜¯å…³é”®ã€‚ä½œè€…å°†è¾¹æŒ‰`g`æ’åºåï¼Œé€æ­¥åŠ å…¥è¾¹ï¼š  
  - ç”¨æ•°ç»„`a`ç»´æŠ¤å½“å‰çš„è¾¹é›†åˆï¼Œæ¯æ¬¡åŠ å…¥æ–°è¾¹æ—¶ï¼Œç”¨å½’å¹¶çš„æ–¹å¼å°†å…¶æ’å…¥åˆ°`a`çš„æ­£ç¡®ä½ç½®ï¼ˆä¿æŒ`a`æŒ‰`s`æœ‰åºï¼‰ï¼›  
  - å¯¹`a`æ•°ç»„è¿›è¡ŒKruskalç®—æ³•ï¼Œæ±‚`s`çš„æœ€å°ç”Ÿæˆæ ‘ã€‚  
  äº®ç‚¹ï¼šå½’å¹¶æ’å…¥å°†æ’åºæ—¶é—´ä»`O(m log m)`ä¼˜åŒ–åˆ°`O(m)`ï¼ˆæ¯æ¬¡æ’å…¥ä¸€æ¡è¾¹ï¼Œåªéœ€ç§»åŠ¨å°‘é‡å…ƒç´ ï¼‰ï¼Œä»£ç ç»“æ„æ¸…æ™°ï¼Œå®¹æ˜“ç†è§£ã€‚


### é¢˜è§£ä¸‰ï¼ˆä½œè€…ï¼šè£ä¸€é¸£ï¼Œèµ4ï¼‰  
* **ç‚¹è¯„**ï¼š  
  ä»£ç **çŸ­å°ç²¾æ‚**ï¼Œé€‚åˆå…¥é—¨å­¦ä¹ ã€‚ä½œè€…ç”¨å†’æ³¡æ’åºç»´æŠ¤`s`çš„æœ‰åºé›†åˆï¼š  
  - æŒ‰`g`æ’åºè¾¹åï¼Œé€æ­¥åŠ å…¥è¾¹ï¼Œç”¨å†’æ³¡æ’åºå°†æ–°è¾¹æ’å…¥åˆ°æ­£ç¡®ä½ç½®ï¼ˆä¿æŒ`s`æœ‰åºï¼‰ï¼›  
  - å¯¹æœ‰åºè¾¹é›†åˆè¿›è¡ŒKruskalç®—æ³•ï¼Œè®¡ç®—æ€»èŠ±è´¹ã€‚  
  äº®ç‚¹ï¼šä»£ç é€»è¾‘ç®€å•ï¼Œå³ä½¿æ˜¯æ–°æ‰‹ä¹Ÿèƒ½å¿«é€Ÿç†è§£â€œæšä¸¾+MSTâ€çš„æ ¸å¿ƒæ€è·¯ï¼Œè™½ç„¶å†’æ³¡æ’åºçš„æ—¶é—´å¤æ‚åº¦è¾ƒé«˜ï¼Œä½†å¯¹äº`nâ‰¤200`çš„é™åˆ¶å®Œå…¨å¯è¡Œã€‚


## 3. æ ¸å¿ƒéš¾ç‚¹è¾¨æä¸è§£é¢˜ç­–ç•¥

### 1. éš¾ç‚¹1ï¼šå¤„ç†ä¸¤ä¸ªå˜é‡çš„ä¼˜åŒ–é—®é¢˜  
**é—®é¢˜**ï¼šé¢˜ç›®è¦æ±‚åŒæ—¶ä¼˜åŒ–`max_g`å’Œ`max_s`ï¼Œç›´æ¥æ±‚è§£äºŒç»´ä¼˜åŒ–é—®é¢˜éš¾åº¦å¤§ã€‚  
**è§£å†³ç­–ç•¥**ï¼šæšä¸¾å…¶ä¸­ä¸€ä¸ªå˜é‡ï¼ˆ`max_g`ï¼‰ï¼Œå°†é—®é¢˜è½¬åŒ–ä¸ºå•å˜é‡ï¼ˆ`max_s`ï¼‰çš„ä¼˜åŒ–ã€‚é€šè¿‡æšä¸¾`max_g`ï¼Œå°†é—®é¢˜æ‹†è§£ä¸ºâ€œåœ¨æ»¡è¶³`g_iâ‰¤max_g`çš„è¾¹ä¸­ï¼Œæ±‚`s`çš„æœ€å°ç”Ÿæˆæ ‘â€ï¼Œä»è€Œå°†äºŒç»´é—®é¢˜è½¬åŒ–ä¸ºä¸€ç»´é—®é¢˜ã€‚


### 2. éš¾ç‚¹2ï¼šé«˜æ•ˆç»´æŠ¤æ¯ä¸ª`max_g`å¯¹åº”çš„`s`æœ€å°ç”Ÿæˆæ ‘  
**é—®é¢˜**ï¼šå¦‚æœæ¯æ¬¡æšä¸¾`max_g`éƒ½é‡æ–°æ’åºæ‰€æœ‰æ»¡è¶³æ¡ä»¶çš„è¾¹ï¼Œæ—¶é—´å¤æ‚åº¦ä¼šå¾ˆé«˜ï¼ˆ`O(m^2 log m)`ï¼‰ã€‚  
**è§£å†³ç­–ç•¥**ï¼šæŒ‰`g`æ’åºè¾¹åï¼Œé€æ­¥åŠ å…¥è¾¹ï¼Œ**ç»´æŠ¤ä¸€ä¸ªæŒ‰`s`æœ‰åºçš„è¾¹é›†åˆ**ã€‚æ¯æ¬¡åŠ å…¥æ–°è¾¹æ—¶ï¼Œåªéœ€å°†å…¶æ’å…¥åˆ°æœ‰åºé›†åˆçš„æ­£ç¡®ä½ç½®ï¼ˆå½’å¹¶æˆ–å†’æ³¡ï¼‰ï¼Œé¿å…é‡å¤æ’åºã€‚


### 3. éš¾ç‚¹3ï¼šé¿å…é‡å¤è®¡ç®—æ— æ•ˆè¾¹  
**é—®é¢˜**ï¼šæœ‰äº›è¾¹çš„`s`å€¼å¾ˆå¤§ï¼Œå³ä½¿`g`æ»¡è¶³æ¡ä»¶ï¼Œä¹Ÿä¸ä¼šæˆä¸ºå½“å‰`max_g`å¯¹åº”çš„æœ€å°ç”Ÿæˆæ ‘çš„ä¸€éƒ¨åˆ†ã€‚  
**è§£å†³ç­–ç•¥**ï¼šåˆ©ç”¨æœ€å°ç”Ÿæˆæ ‘çš„æ€§è´¨â€”â€”**å¦‚æœä¸€æ¡è¾¹åœ¨ä¹‹å‰çš„`max_g`ä¸­æ²¡æœ‰è¢«é€‰å…¥ç”Ÿæˆæ ‘ï¼Œé‚£ä¹ˆåœ¨ä¹‹åçš„`max_g`ä¸­ä¹Ÿä¸ä¼šè¢«é€‰å…¥**ï¼ˆå› ä¸ºä¹‹åçš„`max_g`æ›´å¤§ï¼Œä¼šåŠ å…¥æ›´å¤šè¾¹ï¼Œè€Œè¯¥è¾¹çš„`s`å€¼æ›´å¤§ï¼Œæ— æ³•æˆä¸ºæ›´ä¼˜é€‰æ‹©ï¼‰ã€‚å› æ­¤ï¼Œæ¯æ¬¡Kruskalåï¼Œåªéœ€ä¿ç•™ç”Ÿæˆæ ‘ä¸­çš„è¾¹ï¼ˆ`O(n)`æ¡ï¼‰ï¼Œå‡å°‘åç»­å¤„ç†çš„è¾¹æ•°ã€‚


### âœ¨ è§£é¢˜æŠ€å·§æ€»ç»“  
- **é—®é¢˜æ‹†è§£**ï¼šå°†äºŒç»´ä¼˜åŒ–é—®é¢˜æ‹†è§£ä¸ºâ€œæšä¸¾+å•å˜é‡ä¼˜åŒ–â€ï¼Œé™ä½éš¾åº¦ï¼›  
- **æœ‰åºç»´æŠ¤**ï¼šæŒ‰`g`æ’åºè¾¹ï¼Œé€æ­¥åŠ å…¥è¾¹å¹¶ç»´æŠ¤`s`çš„æœ‰åºé›†åˆï¼Œé¿å…é‡å¤æ’åºï¼›  
- **æ€§è´¨åˆ©ç”¨**ï¼šåˆ©ç”¨æœ€å°ç”Ÿæˆæ ‘çš„æ€§è´¨ï¼Œä¿ç•™æœ‰æ•ˆè¾¹ï¼Œå‡å°‘è®¡ç®—é‡ï¼›  
- **ä»£ç ç®€æ´**ï¼šä¼˜å…ˆé€‰æ‹©ç®€å•çš„æ’åºæ–¹æ³•ï¼ˆå¦‚å†’æ³¡ï¼‰ï¼Œåœ¨æ•°æ®èŒƒå›´å…è®¸çš„æƒ…å†µä¸‹ï¼Œä»£ç å¯è¯»æ€§æ›´é‡è¦ã€‚


## 4. C++æ ¸å¿ƒä»£ç å®ç°èµæ

### æœ¬é¢˜é€šç”¨æ ¸å¿ƒC++å®ç°å‚è€ƒï¼ˆåŸºäºElma_é¢˜è§£ï¼‰  
* **è¯´æ˜**ï¼šæœ¬ä»£ç ç»¼åˆäº†â€œæŒ‰`g`æ’åº+å½’å¹¶æ’å…¥ç»´æŠ¤`s`æœ‰åº+Kruskalâ€çš„æ ¸å¿ƒæ€è·¯ï¼Œä»£ç ç»“æ„æ¸…æ™°ï¼Œé€‚åˆå…¥é—¨å­¦ä¹ ã€‚  
* **å®Œæ•´æ ¸å¿ƒä»£ç **ï¼š  
  ```cpp
  #include <iostream>
  #include <algorithm>
  using namespace std;

  const int maxn = 205;
  const int maxm = 50005;
  typedef long long ll;

  struct Edge {
      int u, v, g, s;
  } edge[maxm], a[maxn]; // edge: åŸå§‹è¾¹ï¼›a: å½“å‰ç»´æŠ¤çš„æŒ‰sæœ‰åºçš„è¾¹é›†åˆ

  int n, m, G, S;
  int fa[maxn]; // å¹¶æŸ¥é›†æ•°ç»„

  bool cmpG(const Edge& x, const Edge& y) {
      return x.g < y.g; // æŒ‰gä»å°åˆ°å¤§æ’åº
  }

  int find(int x) {
      return fa[x] == x ? x : fa[x] = find(fa[x]); // å¹¶æŸ¥é›†è·¯å¾„å‹ç¼©
  }

  int main() {
      cin >> n >> m >> G >> S;
      for (int i = 1; i <= m; i++) {
          cin >> edge[i].u >> edge[i].v >> edge[i].g >> edge[i].s;
      }
      sort(edge + 1, edge + m + 1, cmpG); // æŒ‰gæ’åº

      ll ans = 1e18;
      int tot = 0; // å½“å‰ç»´æŠ¤çš„è¾¹æ•°
      for (int i = 1; i <= m; i++) {
          // å½’å¹¶æ’å…¥ï¼šå°†edge[i]æ’å…¥åˆ°aæ•°ç»„çš„æ­£ç¡®ä½ç½®ï¼ˆä¿æŒsæœ‰åºï¼‰
          int pos = ++tot;
          while (pos >= 2 && a[pos-1].s > edge[i].s) {
              a[pos] = a[pos-1];
              pos--;
          }
          a[pos] = edge[i];

          // Kruskalç®—æ³•æ±‚sçš„æœ€å°ç”Ÿæˆæ ‘
          for (int j = 1; j <= n; j++) fa[j] = j; // åˆå§‹åŒ–å¹¶æŸ¥é›†
          int cnt = 0; // ç”Ÿæˆæ ‘ä¸­çš„è¾¹æ•°
          int max_s = 0; // å½“å‰ç”Ÿæˆæ ‘çš„max_s
          for (int j = 1; j <= tot; j++) {
              int u = a[j].u, v = a[j].v;
              int fu = find(u), fv = find(v);
              if (fu != fv) {
                  fa[fu] = fv;
                  cnt++;
                  max_s = max(max_s, a[j].s);
                  if (cnt == n-1) break; // ç”Ÿæˆæ ‘å®Œæˆï¼Œæå‰ç»ˆæ­¢
              }
          }

          // æ›´æ–°ç­”æ¡ˆ
          if (cnt == n-1) {
              ans = min(ans, (ll)edge[i].g * G + (ll)max_s * S);
          }

          tot = cnt; // ä¿ç•™ç”Ÿæˆæ ‘ä¸­çš„è¾¹ï¼ˆå‡å°‘åç»­å¤„ç†çš„è¾¹æ•°ï¼‰
      }

      cout << (ans == 1e18 ? -1 : ans) << endl;
      return 0;
  }
  ```  
* **ä»£ç è§£è¯»æ¦‚è¦**ï¼š  
  1. **è¾“å…¥ä¸æ’åº**ï¼šè¯»å–è¾“å…¥æ•°æ®ï¼Œå°†è¾¹æŒ‰`g`ä»å°åˆ°å¤§æ’åºï¼›  
  2. **é€æ­¥åŠ å…¥è¾¹**ï¼šå¾ªç¯å¤„ç†æ¯ä¸ªè¾¹ï¼Œç”¨å½’å¹¶æ’å…¥å°†å…¶æ’å…¥åˆ°`a`æ•°ç»„ï¼ˆä¿æŒ`a`æŒ‰`s`æœ‰åºï¼‰ï¼›  
  3. **Kruskalç®—æ³•**ï¼šå¯¹`a`æ•°ç»„è¿›è¡ŒKruskalï¼Œæ±‚`s`çš„æœ€å°ç”Ÿæˆæ ‘ï¼Œè®°å½•`max_s`ï¼›  
  4. **æ›´æ–°ç­”æ¡ˆ**ï¼šè®¡ç®—å½“å‰`max_g`ï¼ˆedge[i].gï¼‰å’Œ`max_s`çš„æ€»èŠ±è´¹ï¼Œæ›´æ–°æœ€å°å€¼ï¼›  
  5. **ä¼˜åŒ–è¾¹æ•°**ï¼šä¿ç•™ç”Ÿæˆæ ‘ä¸­çš„è¾¹ï¼ˆ`tot = cnt`ï¼‰ï¼Œå‡å°‘åç»­å¤„ç†çš„è¾¹æ•°ã€‚


### é’ˆå¯¹å„ä¼˜è´¨é¢˜è§£çš„ç‰‡æ®µèµæ

#### é¢˜è§£ä¸€ï¼ˆwheneverightï¼‰ï¼šmultisetåŠ¨æ€ç»´æŠ¤è¾¹  
* **äº®ç‚¹**ï¼šç”¨`multiset`åŠ¨æ€åˆ é™¤æ— æ•ˆè¾¹ï¼Œä¼˜åŒ–æ—¶é—´ã€‚  
* **æ ¸å¿ƒä»£ç ç‰‡æ®µ**ï¼š  
  ```cpp
  multiset<Edge> E; // å­˜å‚¨è¾¹ï¼ŒæŒ‰sæ’åº
  // å¾ªç¯å¤„ç†æ¯ä¸ªmax_g
  for (int mg = res; mg <= M; mg++) {
      int cnt = 1;
      ll now = 0;
      for (int i = 1; i <= N; i++) fa[i] = i;
      for (auto it = E.begin(); it != E.end(); ) {
          Edge P = *it;
          if (P.g > gg[mg]) { // ä¸æ»¡è¶³max_gï¼Œåˆ é™¤è¾¹
              auto registit = it;
              registit--;
              E.erase(it);
              it = registit;
              continue;
          }
          int fx = find(P.x), fy = find(P.y);
          if (fx != fy) { // åˆå¹¶é›†åˆ
              fa[fx] = fy;
              now = P.s;
              cnt++;
              if (cnt == N) break;
          }
          it++;
      }
      ans = min(ans, now * S + (ll)gg[mg] * G);
  }
  ```  
* **ä»£ç è§£è¯»**ï¼š  
  - `multiset`æŒ‰`s`æ’åºå­˜å‚¨è¾¹ï¼Œæ¯æ¬¡å¾ªç¯å¤„ç†`max_g`æ—¶ï¼Œåˆ é™¤ä¸æ»¡è¶³`g_iâ‰¤max_g`çš„è¾¹ï¼ˆè¿™äº›è¾¹ä¸ä¼šå†è¢«ç”¨åˆ°ï¼‰ï¼›  
  - ç”¨è¿­ä»£å™¨éå†`multiset`ï¼Œè¿›è¡ŒKruskalç®—æ³•ï¼Œåˆå¹¶é›†åˆï¼Œè®°å½•`max_s`ï¼ˆnowï¼‰ï¼›  
  - è®¡ç®—æ€»èŠ±è´¹ï¼Œæ›´æ–°æœ€å°å€¼ã€‚  
* ğŸ’¡ **å­¦ä¹ ç¬”è®°**ï¼š`multiset`çš„åŠ¨æ€ç»´æŠ¤å¯ä»¥é¿å…é‡å¤å¤„ç†æ— æ•ˆè¾¹ï¼Œé€‚åˆéœ€è¦é¢‘ç¹åˆ é™¤å…ƒç´ çš„åœºæ™¯ã€‚


#### é¢˜è§£ä¸‰ï¼ˆè£ä¸€é¸£ï¼‰ï¼šå†’æ³¡æ’åºç»´æŠ¤sæœ‰åº  
* **äº®ç‚¹**ï¼šä»£ç ç®€æ´ï¼Œå®¹æ˜“ç†è§£ã€‚  
* **æ ¸å¿ƒä»£ç ç‰‡æ®µ**ï¼š  
  ```cpp
  struct think {
      ll x, y, a, b;
      bool operator<(const think A) const {
          return a < A.a; // æŒ‰aï¼ˆgï¼‰æ’åº
      }
  } a[50005], q[205]; // q: å½“å‰ç»´æŠ¤çš„æŒ‰bï¼ˆsï¼‰æœ‰åºçš„è¾¹é›†åˆ

  // å¾ªç¯å¤„ç†æ¯ä¸ªè¾¹
  for (ll i = 1; i <= m; i++) {
      q[++t] = a[i];
      // å†’æ³¡æ’åºï¼šå°†æ–°è¾¹æ’å…¥åˆ°æ­£ç¡®ä½ç½®ï¼ˆä¿æŒbæœ‰åºï¼‰
      for (ll j = t-1; j && q[j+1].b < q[j].b; j--) swap(q[j], q[j+1]);
      // Kruskalç®—æ³•ï¼ˆç•¥ï¼‰
  }
  ```  
* **ä»£ç è§£è¯»**ï¼š  
  - æŒ‰`a`ï¼ˆgï¼‰æ’åºè¾¹åï¼Œé€æ­¥åŠ å…¥è¾¹åˆ°`q`æ•°ç»„ï¼›  
  - ç”¨å†’æ³¡æ’åºå°†æ–°è¾¹æ’å…¥åˆ°`q`çš„æ­£ç¡®ä½ç½®ï¼ˆä¿æŒ`q`æŒ‰`b`ï¼ˆsï¼‰æœ‰åºï¼‰ï¼›  
  - å¯¹`q`æ•°ç»„è¿›è¡ŒKruskalç®—æ³•ï¼Œè®¡ç®—æ€»èŠ±è´¹ã€‚  
* ğŸ’¡ **å­¦ä¹ ç¬”è®°**ï¼šå³ä½¿æ˜¯ç®€å•çš„å†’æ³¡æ’åºï¼Œåœ¨æ•°æ®èŒƒå›´å…è®¸çš„æƒ…å†µä¸‹ï¼Œä¹Ÿèƒ½æœ‰æ•ˆè§£å†³é—®é¢˜ï¼Œå…³é”®æ˜¯æ€è·¯æ­£ç¡®ã€‚


## 5. ç®—æ³•å¯è§†åŒ–ï¼šåƒç´ åŠ¨ç”»æ¼”ç¤º (æ ¸å¿ƒéƒ¨åˆ†)

### åŠ¨ç”»æ¼”ç¤ºä¸»é¢˜ï¼šé‡‘å¸ä¸é“¶å¸çš„ç”Ÿæˆæ ‘å†’é™©  
**é£æ ¼**ï¼š8ä½åƒç´ é£ï¼ˆç±»ä¼¼FCçº¢ç™½æœºï¼‰ï¼Œç”¨å½©è‰²æ–¹å—è¡¨ç¤ºåŸå¸‚ï¼Œçº¿æ¡è¡¨ç¤ºè¾¹ï¼Œ`g`å€¼è¶Šå¤§è¾¹è¶Šçº¢ï¼Œ`s`å€¼è¶Šå¤§è¾¹è¶Šè“ã€‚  

### æ ¸å¿ƒæ¼”ç¤ºå†…å®¹  
1. **åˆå§‹åŒ–åœºæ™¯**ï¼š  
   - å±å¹•æ˜¾ç¤º`n`ä¸ªå½©è‰²æ–¹å—ï¼ˆåŸå¸‚ï¼‰ï¼Œéšæœºåˆ†å¸ƒåœ¨ç½‘æ ¼ä¸­ï¼›  
   - å±å¹•ä¸‹æ–¹æ˜¾ç¤ºâ€œæ§åˆ¶é¢æ¿â€ï¼šå•æ­¥æ‰§è¡Œã€è‡ªåŠ¨æ’­æ”¾ã€é‡ç½®æŒ‰é’®ï¼Œé€Ÿåº¦æ»‘å—ï¼›  
   - èƒŒæ™¯éŸ³ä¹ï¼š8ä½é£æ ¼çš„è½»å¿«æ—‹å¾‹ã€‚  

2. **æŒ‰gæ’åºè¾¹**ï¼š  
   - æ‰€æœ‰è¾¹æŒ‰`g`ä»å°åˆ°å¤§æ’åˆ—ï¼ŒåŠ¨ç”»æ˜¾ç¤ºè¾¹çš„é¢œè‰²ä»æµ…çº¢åˆ°æ·±çº¢æ¸å˜ï¼ˆ`g`è¶Šå¤§é¢œè‰²è¶Šæ·±ï¼‰ã€‚  

3. **é€æ­¥åŠ å…¥è¾¹**ï¼š  
   - æ¯æ¬¡åŠ å…¥ä¸€æ¡è¾¹ï¼ˆä»`g`æœ€å°çš„å¼€å§‹ï¼‰ï¼Œè¾¹ä¼šâ€œé—ªçƒâ€ï¼ˆé¢œè‰²å˜äº®ï¼‰è¡¨ç¤ºè¢«é€‰ä¸­ï¼›  
   - åŒæ—¶ï¼Œå±å¹•ä¸Šæ–¹æ˜¾ç¤ºå½“å‰`max_g`ï¼ˆè¾¹çš„`g`å€¼ï¼‰ã€‚  

4. **ç»´æŠ¤sæœ‰åºé›†åˆ**ï¼š  
   - ç”¨å½’å¹¶æ’å…¥å°†æ–°è¾¹æ’å…¥åˆ°æœ‰åºé›†åˆä¸­ï¼ŒåŠ¨ç”»æ˜¾ç¤ºè¾¹â€œç§»åŠ¨â€åˆ°æ­£ç¡®ä½ç½®ï¼ˆæŒ‰è“è‰²æ·±æµ…æ’åˆ—ï¼‰ï¼›  
   - æ’å…¥å®Œæˆåï¼Œè¾¹çš„é¢œè‰²æŒ‰`s`ä»å°åˆ°å¤§æ’åˆ—ï¼ˆæµ…è“åˆ°æ·±è“ï¼‰ã€‚  

5. **Kruskalåˆå¹¶é›†åˆ**ï¼š  
   - åŠ¨ç”»æ˜¾ç¤ºå¹¶æŸ¥é›†çš„åˆå¹¶è¿‡ç¨‹ï¼šå½“ä¸¤æ¡è¾¹è¿æ¥çš„åŸå¸‚å±äºä¸åŒé›†åˆæ—¶ï¼ŒåŸå¸‚çš„é¢œè‰²ä¼šå˜æˆåŒä¸€é¢œè‰²ï¼ˆæ¯”å¦‚ä»çº¢è‰²å˜æˆç»¿è‰²ï¼‰ï¼›  
   - æ¯åˆå¹¶ä¸€æ¬¡ï¼Œå±å¹•å³ä¾§æ˜¾ç¤ºå½“å‰ç”Ÿæˆæ ‘çš„`max_s`ï¼ˆè¾¹çš„`s`å€¼ï¼‰ã€‚  

6. **è®¡ç®—ä¸æ›´æ–°ç­”æ¡ˆ**ï¼š  
   - å½“ç”Ÿæˆæ ‘å®Œæˆï¼ˆåŒ…å«æ‰€æœ‰åŸå¸‚ï¼‰ï¼Œå±å¹•ä¸Šæ–¹æ˜¾ç¤ºå½“å‰æ€»èŠ±è´¹ï¼ˆ`max_g*G + max_s*S`ï¼‰ï¼›  
   - å¦‚æœå½“å‰èŠ±è´¹æ˜¯æœ€å°å€¼ï¼Œå±å¹•ä¼šå¼¹å‡ºâ€œæ–°çºªå½•ï¼â€çš„åŠ¨ç”»ï¼ˆåƒç´ æ˜Ÿæ˜Ÿé—ªçƒï¼‰ï¼Œå¹¶æ›´æ–°æœ€å°å€¼ã€‚  

### äº¤äº’ä¸éŸ³æ•ˆ  
- **å•æ­¥æ‰§è¡Œ**ï¼šç‚¹å‡»â€œå•æ­¥â€æŒ‰é’®ï¼ŒåŠ¨ç”»æ‰§è¡Œä¸€æ­¥ï¼ˆåŠ å…¥è¾¹â†’æ’åºâ†’åˆå¹¶ï¼‰ï¼›  
- **è‡ªåŠ¨æ’­æ”¾**ï¼šç‚¹å‡»â€œè‡ªåŠ¨â€æŒ‰é’®ï¼ŒåŠ¨ç”»æŒ‰è®¾å®šé€Ÿåº¦ï¼ˆæ»‘å—è°ƒæ•´ï¼‰è¿ç»­æ‰§è¡Œï¼›  
- **éŸ³æ•ˆ**ï¼šåŠ å…¥è¾¹æ—¶æ’­æ”¾â€œå®â€çš„å£°éŸ³ï¼Œæ’åºæ—¶æ’­æ”¾â€œæ²™æ²™â€çš„å£°éŸ³ï¼Œåˆå¹¶æ—¶æ’­æ”¾â€œç °â€çš„å£°éŸ³ï¼Œæ›´æ–°æœ€å°å€¼æ—¶æ’­æ”¾â€œå®å’šâ€çš„èƒœåˆ©éŸ³æ•ˆã€‚  


## 6. æ‹“å±•ç»ƒä¹ ä¸ç›¸ä¼¼é—®é¢˜æ€è€ƒ

### é€šç”¨æ€è·¯/æŠ€å·§è¿ç§»  
æœ¬é¢˜çš„â€œæšä¸¾+MSTâ€æ€è·¯å¯ä»¥è¿ç§»åˆ°ä»¥ä¸‹åœºæ™¯ï¼š  
- **äºŒç»´çº¦æŸçš„ç”Ÿæˆæ ‘é—®é¢˜**ï¼ˆå¦‚é­”æ³•æ£®æ—ï¼‰ï¼šéœ€è¦åŒæ—¶ä¼˜åŒ–ä¸¤ä¸ªå˜é‡çš„ç”Ÿæˆæ ‘ï¼›  
- **å¸¦æ¡ä»¶çš„æœ€å°ç”Ÿæˆæ ‘**ï¼ˆå¦‚é€‰è¾¹æ—¶æ»¡è¶³æŸäº›æ¡ä»¶ï¼‰ï¼šæšä¸¾æ¡ä»¶ï¼Œæ±‚æ»¡è¶³æ¡ä»¶çš„MSTï¼›  
- **åŠ¨æ€ç”Ÿæˆæ ‘**ï¼ˆå¦‚é€æ­¥åŠ å…¥è¾¹ï¼Œç»´æŠ¤MSTï¼‰ï¼šåˆ©ç”¨MSTçš„æ€§è´¨ï¼Œé¿å…é‡å¤è®¡ç®—ã€‚  


### ç»ƒä¹ æ¨è (æ´›è°·)  
1. **æ´›è°· P2387 é­”æ³•æ£®æ—**  
   - ğŸ—£ï¸ **æ¨èç†ç”±**ï¼šæœ¬é¢˜æ˜¯â€œäºŒç»´ç”Ÿæˆæ ‘â€çš„ç»å…¸é—®é¢˜ï¼Œéœ€è¦ç»´æŠ¤ä¸¤ä¸ªå˜é‡çš„æœ€å°ç”Ÿæˆæ ‘ï¼Œä¸æœ¬é¢˜æ€è·¯å®Œå…¨ä¸€è‡´ï¼Œé€‚åˆå·©å›ºâ€œæšä¸¾+MSTâ€çš„æŠ€å·§ã€‚  
2. **æ´›è°· P1194 ä¹°ç¤¼ç‰©**  
   - ğŸ—£ï¸ **æ¨èç†ç”±**ï¼šæœ¬é¢˜æ¶‰åŠæšä¸¾ä¼˜åŒ–å’Œæœ€å°ç”Ÿæˆæ ‘ï¼Œéœ€è¦æ‰¾åˆ°æ»¡è¶³æ¡ä»¶çš„æœ€å°èŠ±è´¹ï¼Œä¸æœ¬é¢˜çš„â€œæšä¸¾+ä¼˜åŒ–â€æ€è·¯ç±»ä¼¼ã€‚  
3. **æ´›è°· P3366 æœ€å°ç”Ÿæˆæ ‘æ¨¡æ¿**  
   - ğŸ—£ï¸ **æ¨èç†ç”±**ï¼šå·©å›ºKruskalç®—æ³•çš„åŸºç¡€ï¼Œç†Ÿç»ƒæŒæ¡å¹¶æŸ¥é›†å’Œæ’åºçš„åº”ç”¨ã€‚  


## 7. å­¦ä¹ å¿ƒå¾—ä¸ç»éªŒåˆ†äº« (è‹¥æœ‰)  
- **wheneverightçš„ç»éªŒ**ï¼šç”¨`multiset`åŠ¨æ€ç»´æŠ¤è¾¹å¯ä»¥é¿å…é‡å¤å¤„ç†æ— æ•ˆè¾¹ï¼Œä¼˜åŒ–æ—¶é—´ã€‚è¿™æé†’æˆ‘ä»¬ï¼Œæ•°æ®ç»“æ„çš„é€‰æ‹©å¯¹ç®—æ³•æ•ˆç‡å¾ˆé‡è¦ï¼Œè¦æ ¹æ®é—®é¢˜éœ€æ±‚é€‰æ‹©åˆé€‚çš„æ•°æ®ç»“æ„ã€‚  
- **è£ä¸€é¸£çš„ç»éªŒ**ï¼šä»£ç ç®€æ´æ¯”å¤æ‚çš„ä¼˜åŒ–æ›´é‡è¦ï¼Œå³ä½¿æ˜¯ç®€å•çš„å†’æ³¡æ’åºï¼Œåœ¨æ•°æ®èŒƒå›´å…è®¸çš„æƒ…å†µä¸‹ï¼Œä¹Ÿèƒ½æœ‰æ•ˆè§£å†³é—®é¢˜ã€‚å…³é”®æ˜¯è¦ç†è§£é—®é¢˜çš„æ ¸å¿ƒæ€è·¯ï¼Œå†è€ƒè™‘ä¼˜åŒ–ã€‚  


## ç»“è¯­  
æœ¬æ¬¡å…³äºâ€œGiftâ€çš„C++è§£é¢˜åˆ†æå°±åˆ°è¿™é‡Œã€‚å¸Œæœ›è¿™ä»½å­¦ä¹ æŒ‡å—èƒ½å¸®åŠ©å¤§å®¶ç†è§£â€œæšä¸¾+æœ€å°ç”Ÿæˆæ ‘â€çš„æ ¸å¿ƒæ€è·¯ï¼ŒæŒæ¡å¤„ç†äºŒç»´ä¼˜åŒ–é—®é¢˜çš„æŠ€å·§ã€‚è®°ä½ï¼Œç¼–ç¨‹çš„å…³é”®æ˜¯**æ‹†è§£é—®é¢˜**å’Œ**åˆ©ç”¨æ€§è´¨**ï¼Œåªè¦æ€è·¯æ­£ç¡®ï¼Œå³ä½¿æ˜¯å¤æ‚çš„é—®é¢˜ä¹Ÿèƒ½è¿åˆƒè€Œè§£ï¼ğŸ’ª  

ä¸‹æ¬¡æˆ‘ä»¬å†ä¸€èµ·æ¢ç´¢æ–°çš„ç¼–ç¨‹æŒ‘æˆ˜ï¼

---
å¤„ç†ç”¨æ—¶ï¼š330.44ç§’
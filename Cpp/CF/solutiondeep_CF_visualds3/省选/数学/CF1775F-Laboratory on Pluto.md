# é¢˜ç›®ä¿¡æ¯

# Laboratory on Pluto

## é¢˜ç›®æè¿°

As you know, Martian scientists are actively engaged in space research. One of the highest priorities is Pluto. In order to study this planet in more detail, it was decided to build a laboratory on Pluto.

It is known that the lab will be built of $ n $ square blocks of equal size. For convenience, we will assume that Pluto's surface is a plane divided by vertical and horizontal lines into unit squares. Each square is either occupied by a lab block or not, and only $ n $ squares are occupied.

Since each block is square, it has four walls. If a wall is adjacent to another block, it is considered inside, otherwise â€” outside.

Pluto is famous for its extremely cold temperatures, so the outside walls of the lab must be insulated. One unit of insulation per exterior wall would be required. Thus, the greater the total length of the outside walls of the lab (i. e., its perimeter), the more insulation will be needed.

Consider the lab layout in the figure below. It shows that the lab consists of $ n = 33 $ blocks, and all the blocks have a total of $ 24 $ outside walls, i. e. $ 24 $ units of insulation will be needed.

You should build the lab optimally, i. e., minimize the amount of insulation. On the other hand, there may be many optimal options, so scientists may be interested in the number of ways to build the lab using the minimum amount of insulation, modulo a prime number $ m $ .

Two ways are considered the same if they are the same when overlapping without turning. Thus, if a lab plan is rotated by $ 90^{\circ} $ , such a new plan can be considered a separate way.

To help scientists explore Pluto, you need to write a program that solves these difficult problems.

 ![](https://cdn.luogu.com.cn/upload/vjudge_pic/CF1775F/19a2731aaaa55a0f9a8048f01dd79ff768ce23d2.png)

## è¯´æ˜/æç¤º

Consider the second example.

If $ n=1 $ , the only way to build a lab is to place a single block. In this case, the perimeter will be equal to four.

When $ n=2 $ , you must place two blocks side by side. This can be done either vertically or horizontally, so there are two ways. It is easy to see that the lab has six outside walls in this case.

For $ n=7 $ , all the $ 22 $ optimal plans are shown in the picture below.

 ![](https://cdn.luogu.com.cn/upload/vjudge_pic/CF1775F/2d61b154960a5ef9890728641d5e6f811e5f6274.png)

## æ ·ä¾‹ #1

### è¾“å…¥

```
3 1
1
2
7```

### è¾“å‡º

```
1 1
#
1 2
##
2 4
.###
####```

## æ ·ä¾‹ #2

### è¾“å…¥

```
3 2
1000000007
1
2
7```

### è¾“å‡º

```
4 1
6 2
12 22```

# AIåˆ†æç»“æœ


# ğŸ’¡ Kayçš„C++ç®—æ³•è§£æï¼šLaboratory on Pluto æ·±å…¥å­¦ä¹ æŒ‡å— ğŸ’¡

**<introduction>**
ä»Šå¤©æˆ‘ä»¬åˆ†æCF1775F "Laboratory on Pluto"è¿™é“C++ç¼–ç¨‹é¢˜ã€‚æœ¬æŒ‡å—å°†å¸®åŠ©ä½ ç†è§£å¦‚ä½•ç”¨æœ€ä¼˜æ–¹å¼åœ¨ç½‘æ ¼ä¸Šå»ºé€ å®éªŒå®¤ï¼Œæœ€å°åŒ–å‘¨é•¿å¹¶è®¡ç®—æ–¹æ¡ˆæ•°ã€‚
**</introduction>**

---

## 1. é¢˜ç›®è§£è¯»ä¸æ ¸å¿ƒç®—æ³•è¯†åˆ«

âœ¨ **æœ¬é¢˜ä¸»è¦è€ƒå¯Ÿ**ï¼š`æ„é€ ä¼˜åŒ–`ä¸`åŠ¨æ€è§„åˆ’ï¼ˆåˆ†æ‹†æ•°ï¼‰`

ğŸ—£ï¸ **åˆæ­¥åˆ†æ**ï¼š
> è§£å†³è¿™é“é¢˜çš„å…³é”®åœ¨äº**æ„é€ æ¥è¿‘æ­£æ–¹å½¢çš„çŸ©å½¢**å¹¶ä¼˜åŒ–å››ä¸ªè§’çš„æŒ–æ˜æ–¹æ¡ˆã€‚æƒ³è±¡å»ºé€ åŸå ¡æ—¶ï¼Œæˆ‘ä»¬æ€»æ˜¯å…ˆæ­å»ºæ–¹å½¢ä¸»å ¡ï¼Œå†åœ¨å››ä¸ªè§’è½å°å¿ƒç§»é™¤å¤šä½™çš„ç –å—ï¼Œä¿æŒå¤–å½¢å¹³æ»‘ã€‚  
> - æ ¸å¿ƒæ€è·¯ï¼šæœ€å°å‘¨é•¿é€šè¿‡ä½¿çŸ©å½¢é•¿å®½æ¥è¿‘âˆšnå®ç°ï¼Œæ–¹æ¡ˆæ•°é€šè¿‡è®¡ç®—å››ä¸ªè§’æŒ–æ˜æ–¹å¼ï¼ˆåˆ†æ‹†æ•°ï¼‰çš„å·ç§¯è·å¾—  
> - ç®—æ³•æµç¨‹ï¼šå…ˆç¡®å®šçŸ©å½¢å°ºå¯¸â†’è®¡ç®—å¤šä½™æ ¼å­æ•°â†’ç”¨DPè®¡ç®—å•ä¸ªè§’æ–¹æ¡ˆâ†’å·ç§¯åˆå¹¶å››ä¸ªè§’  
> - å¯è§†åŒ–è®¾è®¡ï¼šé‡‡ç”¨8ä½åƒç´ é£æ ¼å±•ç¤ºçŸ©å½¢å»ºé€ è¿‡ç¨‹ï¼Œç”¨ä¸åŒé¢œè‰²æ–¹å—è¡¨ç¤ºå¢™ä½“ï¼ŒæŒ–æ˜æ—¶æ’­æ”¾"å®"éŸ³æ•ˆï¼Œæ¯å®Œæˆä¸€ä¸ªè§’æ˜¾ç¤ºåƒç´ æ˜Ÿæ˜ŸåŠ¨ç”»  

---

## 2. ç²¾é€‰ä¼˜è´¨é¢˜è§£å‚è€ƒ

**é¢˜è§£ä¸€ï¼ˆHoveryï¼‰**
* **ç‚¹è¯„**ï¼šæ€è·¯ç›´å‡»æ ¸å¿ƒï¼Œæ¸…æ™°è§£é‡Šåˆ†æ‹†æ•°DPä¸å·ç§¯åˆå¹¶çš„é€»è¾‘ã€‚ä»£ç è§„èŒƒï¼ˆå¦‚`f[i]`è¡¨ç¤ºiä¸ªæ ¼å­çš„æ–¹æ¡ˆï¼‰ï¼Œå·§å¦™åˆ©ç”¨å·ç§¯åˆå¹¶å››ä¸ªè§’ã€‚ç©ºé—´å¤æ‚åº¦ä¼˜åŒ–åˆ°ä½ï¼ˆO(n)ï¼‰ï¼Œè¾¹ç•Œå¤„ç†ä¸¥è°¨ï¼Œå¯ç›´æ¥ç”¨äºç«èµ›ã€‚äº®ç‚¹åœ¨äºå°†å¤æ‚é—®é¢˜åˆ†è§£ä¸ºç‹¬ç«‹å­é—®é¢˜å¤„ç†ã€‚

**é¢˜è§£äºŒï¼ˆMine_Kingï¼‰**
* **ç‚¹è¯„**ï¼šå›¾è§£è¾…åŠ©ç†è§£æä½³ï¼ŒçŠ¶æ€å®šä¹‰`dp[i][j]`ç²¾å‡†ï¼ˆé•¿åº¦iæ€»å’Œjçš„æ–¹æ¡ˆæ•°ï¼‰ã€‚ä»£ç æ¨¡å—åŒ–å¼ºï¼Œé¢„å¤„ç†æå‡æ•ˆç‡ã€‚å®è·µä»·å€¼é«˜ï¼Œæšä¸¾çŸ©å½¢èŒƒå›´æ—¶å·§å¦™é™å®šåœ¨âˆšné™„è¿‘ä¼˜åŒ–æ€§èƒ½ã€‚äº®ç‚¹æ˜¯ç”¨å›¾åƒåŒ–æ€ç»´è§£é‡ŠæŒ–æ˜å½¢æ€ã€‚

**é¢˜è§£ä¸‰ï¼ˆzac2010ï¼‰**
* **ç‚¹è¯„**ï¼šåŠ¨æ€è§„åˆ’æ¨å¯¼å®Œæ•´ï¼Œ`g[i][j]`çŠ¶æ€è½¬ç§»æ–¹ç¨‹ï¼ˆæ·»åŠ 1æˆ–æ•´ä½“+1ï¼‰ä½“ç°åˆ†æ‹†æ•°æœ¬è´¨ã€‚ä»£ç å±‚æ¬¡åˆ†æ˜ï¼Œä¸‰æ¬¡å·ç§¯åˆå¹¶è¿‡ç¨‹å¯è¯»æ€§å¼ºã€‚äº®ç‚¹æ˜¯å¼ºè°ƒå‡¸æ€§å¯¹å‘¨é•¿çš„å½±å“ï¼Œå¸®åŠ©ç†è§£é—®é¢˜çº¦æŸã€‚

---

## 3. æ ¸å¿ƒéš¾ç‚¹è¾¨æä¸è§£é¢˜ç­–ç•¥

1. **éš¾ç‚¹1ï¼šæœ€å°å‘¨é•¿æ„é€ **
   * **åˆ†æ**ï¼šéœ€è¯æ˜å‡¸å½¢æœ€ä¼˜æ€§ï¼ˆå‡¹å½¢å¢åŠ å‘¨é•¿ï¼‰ã€‚ä¼˜è´¨è§£æ³•é€šè¿‡æ•°å­¦æ¨å¯¼ï¼šå½“a+bå›ºå®šæ—¶ï¼Œ|a-b|è¶Šå°é¢ç§¯è¶Šå¤§ï¼Œæ•…å–aâ‰ˆbâ‰ˆâˆšn
   * ğŸ’¡ **å­¦ä¹ ç¬”è®°**ï¼šå½¢çŠ¶å‡¸æ€§æ˜¯å‘¨é•¿æœ€å°åŒ–çš„æ ¸å¿ƒå‰æ

2. **éš¾ç‚¹2ï¼šåˆ†æ‹†æ•°DPè®¾è®¡**
   * **åˆ†æ**ï¼šå•ä¸ªè§’çš„æŒ–æ˜æ–¹æ¡ˆå¯¹åº”å•è°ƒåºåˆ—è®¡æ•°ã€‚çŠ¶æ€è®¾è®¡`dp[i][j]`è¡¨ç¤ºæ€»å’Œié•¿åº¦jçš„æ–¹æ¡ˆï¼Œè½¬ç§»æ–¹ç¨‹`dp[i][j] = dp[i-1][j-1] + dp[i-j][j]`åˆ†åˆ«å¯¹åº”æ·»åŠ 1æˆ–æ•´ä½“+1
   * ğŸ’¡ **å­¦ä¹ ç¬”è®°**ï¼šæ•´æ•°åˆ’åˆ†æ˜¯é˜¶æ¢¯å‹æŒ–æ˜çš„æ•°å­¦æ¨¡å‹

3. **éš¾ç‚¹3ï¼šå››è§’æ–¹æ¡ˆåˆå¹¶**
   * **åˆ†æ**ï¼šå› å››ä¸ªè§’ç‹¬ç«‹ï¼ˆæŒ–æ˜æ•°<è¾¹é•¿ï¼‰ï¼Œæ–¹æ¡ˆå¯å·ç§¯åˆå¹¶ã€‚è®¾f[i]ä¸ºå•è§’æ–¹æ¡ˆï¼Œåˆ™å››è§’æ–¹æ¡ˆä¸ºfâ´[i]ã€‚é«˜æ•ˆå®ç°ç”¨ä¸‰æ¬¡å·ç§¯ï¼šfâ†’fÂ²â†’fâ´
   * ğŸ’¡ **å­¦ä¹ ç¬”è®°**ï¼šç‹¬ç«‹å­é—®é¢˜çš„æ–¹æ¡ˆæ•°æ˜¯ä¹˜ç§¯å…³ç³»

### âœ¨ è§£é¢˜æŠ€å·§æ€»ç»“
- **é—®é¢˜åˆ†è§£**ï¼šå°†å¤æ‚é—®é¢˜æ‹†è§£ä¸ºçŸ©å½¢æ„é€ +å››è§’æŒ–æ˜ä¸¤ä¸ªç‹¬ç«‹å­é—®é¢˜
- **æ•°å­¦ä¼˜åŒ–**ï¼šåˆ©ç”¨âˆšné™„è¿‘æšä¸¾æ›¿ä»£å…¨èŒƒå›´æœç´¢ï¼Œå¤æ‚åº¦O(âˆšn)â†’O(1)
- **é¢„å¤„ç†åŠ é€Ÿ**ï¼šåˆ†æ‹†æ•°DPå’Œå·ç§¯ç»“æœé¢„å…ˆè®¡ç®—ï¼ŒæŸ¥è¯¢æ—¶ç›´æ¥è°ƒç”¨
- **è¾¹ç•Œä¸¥è°¨æ€§**ï¼šç‰¹åˆ«æ³¨æ„n=0æˆ–å®Œå…¨æ­£æ–¹å½¢æ—¶çš„ç‰¹æ®Šæƒ…å†µå¤„ç†

---

## 4. C++æ ¸å¿ƒä»£ç å®ç°èµæ

**é€šç”¨æ ¸å¿ƒå®ç°å‚è€ƒ**
```cpp
#include <iostream>
#include <cmath>
using namespace std;

void solve_type1(int n) {
    int a = sqrt(n), b = (n + a - 1) / a;
    // è¾“å‡ºç½‘æ ¼æ„é€ ...
}

void solve_type2(int n, int mod) {
    // é¢„å¤„ç†åˆ†æ‹†æ•°dpå’Œå·ç§¯...
    int min_perimeter = INT_MAX, ways = 0;
    for(int a = max(1, (int)sqrt(n)-100); a <= min(n, (int)sqrt(n)+100); a++) {
        int b = (n + a - 1) / a;
        int perimeter = 2*(a + b);
        // è®¡ç®—æ–¹æ¡ˆå¹¶ç´¯åŠ ...
    }
}
```

**é¢˜è§£ä¸€æ ¸å¿ƒç‰‡æ®µï¼ˆHoveryï¼‰**
```cpp
// åˆ†æ‹†æ•°DPé¢„å¤„ç†
g[0][0] = 1;
for(int i=1; i<=maxn; i++) 
for(int j=1; j<=i; j++)
    g[i][j] = g[i-1][j-1] + g[i-j][j];

// å·ç§¯åˆå¹¶å››ä¸ªè§’
f[0] = 1;
for(int cnt=1; cnt<=4; cnt++)
for(int i=maxn; i>=0; i--)
for(int j=1; j<=i; j++)
    f[i] = (f[i] + 1LL*f[i-j]*s[j]) % mod;
```
> **è§£è¯»**ï¼š  
> 1. `g[i][j]`è®¡ç®—æ€»å’Œiä¸”é•¿åº¦jçš„åˆ’åˆ†æ–¹æ¡ˆ  
> 2. å†…å±‚å¾ªç¯å€’åºæšä¸¾é¿å…é‡å¤è®¡æ•°ï¼ˆèƒŒåŒ…ä¼˜åŒ–ï¼‰  
> 3. `s[j]`æ˜¯å•è§’æ–¹æ¡ˆæ•°ï¼Œé€šè¿‡å››æ¬¡å·ç§¯å¾—åˆ°å››è§’æ€»æ–¹æ¡ˆ  
> ğŸ’¡ **å­¦ä¹ ç¬”è®°**ï¼šå€’åºDPæ˜¯èƒŒåŒ…ä¼˜åŒ–çš„å¸¸ç”¨æŠ€å·§

**é¢˜è§£äºŒæ ¸å¿ƒç‰‡æ®µï¼ˆMine_Kingï¼‰**
```cpp
// æ–¹æ¡ˆæ•°ç»Ÿè®¡
int ans = 0;
for(int r = sqrt(n)-100; r <= sqrt(n)+100; r++) {
    int c = ceil(1.0*n/r);
    if(r*c < n) continue;
    int holes = r*c - n;
    ans = (ans + four_corners[holes]) % mod;
}
```
> **è§£è¯»**ï¼š  
> 1. ä»…æšä¸¾âˆšné™„è¿‘çš„çŸ©å½¢å°ºå¯¸ï¼ˆÂ±100ï¼‰  
> 2. `four_corners[holes]`æ˜¯é¢„å¤„ç†çš„å››è§’å·ç§¯æ–¹æ¡ˆ  
> ğŸ’¡ **å­¦ä¹ ç¬”è®°**ï¼šæ•°å­¦çº¦æŸå‡å°‘æšä¸¾é‡æ˜¯ä¼˜åŒ–å…³é”®

---

## 5. ç®—æ³•å¯è§†åŒ–ï¼šåƒç´ åŠ¨ç”»æ¼”ç¤º

**ä¸»é¢˜**ï¼š`8ä½åƒç´ åŸå ¡å»ºé€ æ¨¡æ‹Ÿå™¨`  
**æ ¸å¿ƒæ¼”ç¤º**ï¼šçŸ©å½¢æ„é€ â†’å››è§’æŒ–æ˜â†’å‘¨é•¿è®¡ç®—  

**è®¾è®¡æ€è·¯**ï¼š  
> é‡‡ç”¨FCçº¢ç™½æœºå¤å¤é£æ ¼ï¼Œç”¨ä¸åŒé¢œè‰²åƒç´ å—åŒºåˆ†ï¼š  
> - ğŸŸ¦ ç©ºåœ° / ğŸŸ§ å®éªŒå®¤ / ğŸŸ¥ æŒ–æ˜åŒº  
> éŸ³æ•ˆå¢å¼ºæ“ä½œåé¦ˆï¼Œå…³å¡åˆ¶æå‡æˆå°±æ„Ÿ  

**åŠ¨ç”»æµç¨‹**ï¼š  
1. **åˆå§‹åŒ–**ï¼šæ˜¾ç¤ºç©ºç™½ç½‘æ ¼ï¼Œæ§åˆ¶é¢æ¿å«æ­¥è¿›/è°ƒé€Ÿ/é‡ç½®æŒ‰é’®  
   ```js
   // ä¼ªä»£ç ï¼šç»˜åˆ¶16x16åƒç´ ç½‘æ ¼
   for(let x=0; x<width; x+=16)
     for(let y=0; y<height; y+=16)
       drawPixel(x, y, COLORS.GROUND);
   ```
2. **çŸ©å½¢å»ºé€ **ï¼š  
   - ç –å—ä»åº•éƒ¨"ç”Ÿé•¿"ï¼ˆåƒç´ åŠ¨ç”»ï¼‰ï¼Œä¼´éšå»ºé€ éŸ³æ•ˆ  
   - æ˜¾ç¤ºå½“å‰å°ºå¯¸å’Œå‘¨é•¿è®¡ç®—å…¬å¼  

3. **å››è§’æŒ–æ˜**ï¼š  
   - æŒ–æ˜åŒºåŸŸç”¨é—ªçƒè¾¹æ¡†æ ‡è®°ï¼ˆæ¯å¸§é¢œè‰²äº¤æ›¿ï¼‰  
   - é˜¶æ¢¯å¼æŒ–æ˜ï¼šæ¯è¡Œç§»é™¤æ–¹å—æ—¶æ’­æ”¾"å®"éŸ³æ•ˆ  
   - å•æ­¥æ¼”ç¤ºåˆ†æ‹†æ•°DPï¼šå·¦ä¾§æ˜¾ç¤ºçŠ¶æ€è¡¨ï¼Œå½“å‰æ›´æ–°å•å…ƒæ ¼é«˜äº®  

4. **å…³å¡æˆå°±**ï¼š  
   - å®Œæˆä¸€ä¸ªè§’ï¼šæ˜¾ç¤ºğŸŒŸ + å¾—åˆ†  
   - å…¨éƒ¨å®Œæˆï¼šæ’­æ”¾èƒœåˆ©éŸ³æ•ˆ + æ˜¾ç¤ºæœ€ç»ˆå‘¨é•¿  

**äº¤äº’è®¾è®¡**ï¼š  
- æ‹–æ‹½æ»‘å—è°ƒæ•´æŒ–æ˜é€Ÿåº¦ï¼ˆ0.5x~5xï¼‰  
- æŒ‰ç©ºæ ¼å¯¹æ¯”ä¸åŒçŸ©å½¢æ–¹æ¡ˆçš„å‘¨é•¿å·®å¼‚  

---

## 6. æ‹“å±•ç»ƒä¹ ä¸ç›¸ä¼¼é—®é¢˜æ€è€ƒ

**æŠ€å·§è¿ç§»**ï¼š  
> åˆ†æ‹†æ•°DPå¯ç”¨äºè§£å†³ï¼š  
> 1. é˜¶æ¢¯å‹å›¾å½¢è®¡æ•°é—®é¢˜  
> 2. èµ„æºåˆ†é…æ–¹æ¡ˆä¼˜åŒ–  
> 3. ç»„åˆæ•°å­¦ä¸­çš„åˆ’åˆ†ç±»é—®é¢˜  

**æ´›è°·æ¨è**ï¼š  
1. **P1025 æ•°çš„åˆ’åˆ†**  
   ğŸ—£ï¸ *æ¨èç†ç”±*ï¼šåˆ†æ‹†æ•°DPåŸºç¡€è®­ç»ƒï¼Œç›´æ¥åº”ç”¨æœ¬é¢˜ç›®ä¸­çš„æ ¸å¿ƒç®—æ³•  
2. **P1059 æ˜æ˜çš„éšæœºæ•°**  
   ğŸ—£ï¸ *æ¨èç†ç”±*ï¼šå·©å›ºæ„é€ ä¼˜åŒ–æ€æƒ³ï¼Œå­¦ä¹ æ•°æ®é¢„å¤„ç†æŠ€å·§  
3. **P1060 å¼€å¿ƒçš„é‡‘æ˜**  
   ğŸ—£ï¸ *æ¨èç†ç”±*ï¼šèƒŒåŒ…é—®é¢˜å˜ç§ï¼Œå¼ºåŒ–å·ç§¯åˆå¹¶æ–¹æ¡ˆæ•°çš„æ€ç»´  

---

## 7. å­¦ä¹ å¿ƒå¾—ä¸ç»éªŒåˆ†äº«
> æœ¬æ¬¡åˆ†æçš„é¢˜è§£ä¸­æœªå‘ç°ä½œè€…ä¸ªäººå¿ƒå¾—åˆ†äº«éƒ¨åˆ†

---

**<conclusion>**  
æœ¬æ¬¡å¯¹"Laboratory on Pluto"çš„è§£ææ¶µç›–äº†æ„é€ ä¼˜åŒ–ã€åˆ†æ‹†æ•°DPç­‰æ ¸å¿ƒç®—æ³•ã€‚è®°ä½ï¼šå°†å¤æ‚é—®é¢˜åˆ†è§£ä¸ºç‹¬ç«‹å­é—®é¢˜ï¼ˆå¦‚çŸ©å½¢+å››è§’ï¼‰æ˜¯è§£é¢˜å…³é”®ã€‚å°è¯•ç”¨8ä½åƒç´ åŠ¨ç”»å¯è§†åŒ–ç®—æ³•ï¼Œèƒ½åŠ æ·±ç†è§£ã€‚å®Œæˆæ¨èç»ƒä¹ åï¼Œä½ å°†åœ¨æ„é€ ç±»é—®é¢˜ä¸­æ¸¸åˆƒæœ‰ä½™ï¼ğŸš€  
**</conclusion>**

---
å¤„ç†ç”¨æ—¶ï¼š89.48ç§’
# é¢˜ç›®ä¿¡æ¯

# Levels and Regions

## é¢˜ç›®æè¿°

Radewoosh is playing a computer game. There are $ n $ levels, numbered $ 1 $ through $ n $ . Levels are divided into $ k $ regions (groups). Each region contains some positive number of consecutive levels.

The game repeats the the following process:

1. If all regions are beaten then the game ends immediately. Otherwise, the system finds the first region with at least one non-beaten level. Let $ X $ denote this region.
2. The system creates an empty bag for tokens. Each token will represent one level and there may be many tokens representing the same level.
  - For each already beaten level $ i $ in the region $ X $ , the system adds $ t_{i} $ tokens to the bag (tokens representing the $ i $ -th level).
  - Let $ j $ denote the first non-beaten level in the region $ X $ . The system adds $ t_{j} $ tokens to the bag.
3. Finally, the system takes a uniformly random token from the bag and a player starts the level represented by the token. A player spends one hour and beats the level, even if he has already beaten it in the past.

Given $ n $ , $ k $ and values $ t_{1},t_{2},...,t_{n} $ , your task is to split levels into regions. Each level must belong to exactly one region, and each region must contain non-empty consecutive set of levels. What is the minimum possible expected number of hours required to finish the game?

## è¯´æ˜/æç¤º

In the first sample, we are supposed to split $ 4 $ levels into $ 2 $ regions. It's optimal to create the first region with only one level (it must be the first level). Then, the second region must contain other three levels.

In the second sample, it's optimal to split levels into two regions with $ 3 $ levels each.

## æ ·ä¾‹ #1

### è¾“å…¥

```
4 2
100 3 5 7
```

### è¾“å‡º

```
5.7428571429
```

## æ ·ä¾‹ #2

### è¾“å…¥

```
6 2
1 2 4 8 16 32
```

### è¾“å‡º

```
8.5000000000
```

# AIåˆ†æç»“æœ

# ğŸ’¡ Kayçš„C++ç®—æ³•è§£æï¼šLevels and Regions æ·±å…¥å­¦ä¹ æŒ‡å— ğŸ’¡


## 1. é¢˜ç›®è§£è¯»ä¸æ ¸å¿ƒç®—æ³•è¯†åˆ«

âœ¨ **æœ¬é¢˜ä¸»è¦è€ƒå¯Ÿ**ï¼šåŠ¨æ€è§„åˆ’ï¼ˆDPï¼‰+ ä¼˜åŒ–æŠ€å·§ï¼ˆæ–œç‡ä¼˜åŒ–/å†³ç­–å•è°ƒæ€§ï¼‰  

ğŸ—£ï¸ **åˆæ­¥åˆ†æ**ï¼š  
è¿™é“é¢˜çš„æ ¸å¿ƒæ˜¯**æŠŠå…³å¡åˆ†æˆè¿ç»­åŒºåŸŸï¼Œæœ€å°åŒ–é€šå…³çš„æ€»æœŸæœ›æ—¶é—´**ã€‚æˆ‘ä»¬å…ˆæ‹†è§£æœ€å…³é”®çš„â€œæœŸæœ›æ—¶é—´â€è®¡ç®—â€”â€”  

### ï¼ˆ1ï¼‰æœŸæœ›æ—¶é—´çš„æ¨å¯¼ï¼šä¸ºä»€ä¹ˆæ˜¯ã€ŒåŒºé—´å’Œé™¤ä»¥å½“å‰å…³å¡å€¼ã€ï¼Ÿ  
å‡è®¾æŸå…³å¡æ‰€åœ¨åŒºåŸŸçš„èµ·ç‚¹æ˜¯`l`ï¼Œåˆ°å½“å‰å…³å¡`i`çš„æ€»`t`å€¼å’Œä¸º`sum(l,i)`ã€‚ä¸€æ¬¡é€šè¿‡è¯¥å…³å¡çš„æ¦‚ç‡æ˜¯`t[i]/sum(l,i)`ï¼ˆå› ä¸ºç³»ç»Ÿä¼šä»å·²é€šå…³çš„åŒåŒºåŸŸå…³å¡å’Œå½“å‰å…³å¡çš„`t`ä¸­éšæœºé€‰ï¼‰ã€‚  

æ ¹æ®æ¦‚ç‡å­¦çš„**ç»å…¸ç»“è®º**ï¼šå¦‚æœåšä¸€ä»¶äº‹çš„æˆåŠŸç‡æ˜¯`p`ï¼Œé‚£ä¹ˆåšæˆå®ƒçš„æœŸæœ›æ¬¡æ•°æ˜¯`1/p`ï¼ˆæ¯”å¦‚æŠ›ç¡¬å¸ç›´åˆ°æ­£é¢æœä¸Šï¼ŒæœŸæœ›æ˜¯2æ¬¡ï¼‰ã€‚æ‰€ä»¥ï¼Œé€šè¿‡å…³å¡`i`çš„æœŸæœ›æ—¶é—´æ˜¯`sum(l,i)/t[i]`ï¼ˆå› ä¸º`p=t[i]/sum(l,i)`ï¼Œæ‰€ä»¥`1/p=sum(l,i)/t[i]`ï¼‰ã€‚  


### ï¼ˆ2ï¼‰åŠ¨æ€è§„åˆ’çš„çŠ¶æ€ä¸è½¬ç§»  
æˆ‘ä»¬ç”¨`f[i][j]`è¡¨ç¤º**å‰`i`ä¸ªå…³å¡åˆ†æˆ`j`æ®µçš„æœ€å°æ€»æœŸæœ›æ—¶é—´**ã€‚è¦è®¡ç®—`f[i][j]`ï¼Œéœ€è¦æ‰¾â€œä¸Šä¸€æ®µçš„ç»“å°¾`k`â€ï¼ŒæŠŠ`k+1`åˆ°`i`ä½œä¸ºç¬¬`j`æ®µï¼Œæ‰€ä»¥è½¬ç§»æ–¹ç¨‹æ˜¯ï¼š  
$$f[i][j] = \min_{0 \leq k < i} \left( f[k][j-1] + \text{cost}(k+1, i) \right)$$  
å…¶ä¸­`cost(k+1,i)`æ˜¯`k+1`åˆ°`i`ä½œä¸ºä¸€æ®µçš„æœŸæœ›æ—¶é—´æ€»å’Œã€‚  


### ï¼ˆ3ï¼‰ä¼˜åŒ–çš„å¿…è¦æ€§ï¼šä»O(nÂ²m)åˆ°O(nm)  
ç›´æ¥è®¡ç®—`cost(k+1,i)`æ˜¯O(n)çš„ï¼Œè¿™æ ·æ€»å¤æ‚åº¦æ˜¯O(nÂ²m)ï¼ˆ`n=2e5`ï¼Œ`m=50`ï¼‰ï¼Œå®Œå…¨æ— æ³•é€šè¿‡ã€‚å› æ­¤éœ€è¦**å‰ç¼€å’Œä¼˜åŒ–**å’Œ**æ–œç‡ä¼˜åŒ–/å†³ç­–å•è°ƒæ€§**ï¼š  
- å‰ç¼€å’Œä¼˜åŒ–ï¼šæŠŠ`cost(k+1,i)`è½¬åŒ–ä¸º`sumc[i] - sumc[k] - suma[k]*(sumb[i]-sumb[k])`ï¼ˆ`sumc`æ˜¯`sum(suma[i]/t[i])`çš„å‰ç¼€å’Œï¼Œ`sumb`æ˜¯`sum(1/t[i])`çš„å‰ç¼€å’Œï¼Œ`suma`æ˜¯`t`çš„å‰ç¼€å’Œï¼‰ã€‚  
- æ–œç‡ä¼˜åŒ–ï¼šå°†è½¬ç§»æ–¹ç¨‹è½¬åŒ–ä¸º**çº¿æ€§å‡½æ•°å½¢å¼**ï¼Œç”¨å•è°ƒé˜Ÿåˆ—ç»´æŠ¤â€œä¸‹å‡¸å£³â€ï¼ŒæŠŠæ¯ä¸ª`k`çœ‹ä½œä¸€æ¡ç›´çº¿ï¼Œå¿«é€Ÿæ‰¾åˆ°æœ€ä¼˜çš„`k`ï¼ˆå³æœ€å°åŒ–`f[i][j]`çš„`k`ï¼‰ã€‚  


### ï¼ˆ4ï¼‰å¯è§†åŒ–è®¾è®¡æ€è·¯  
æˆ‘ä»¬ä¼šç”¨**8ä½åƒç´ é£**æ¨¡æ‹Ÿâ€œæ–œç‡ä¼˜åŒ–çš„å†³ç­–è¿‡ç¨‹â€ï¼š  
- ç”¨ä¸åŒé¢œè‰²çš„åƒç´ å—è¡¨ç¤º`k`ï¼ˆå†³ç­–ç‚¹ï¼‰ï¼Œé˜Ÿåˆ—ç»´æŠ¤â€œä¸‹å‡¸å£³â€ä¸­çš„`k`ï¼›  
- æ¯å¤„ç†ä¸€ä¸ª`i`ï¼ŒåŠ¨ç”»å±•ç¤ºâ€œä»é˜Ÿåˆ—å¤´éƒ¨é€‰æœ€ä¼˜`k`â€â€œæŠŠ`i`åŠ å…¥é˜Ÿåˆ—å°¾éƒ¨ï¼ˆç»´æŠ¤å‡¸å£³ï¼‰â€çš„è¿‡ç¨‹ï¼›  
- ç”¨é—ªçƒæˆ–é¢œè‰²å˜åŒ–é«˜äº®å½“å‰`i`ã€é€‰ä¸­çš„`k`ï¼Œä»¥åŠé˜Ÿåˆ—çš„å˜åŒ–ï¼›  
- åŠ å…¥å¤å¤éŸ³æ•ˆï¼šé€‰`k`æ—¶â€œå®â€ä¸€å£°ï¼ŒåŠ å…¥é˜Ÿåˆ—æ—¶â€œæ»´â€ä¸€å£°ï¼Œå®Œæˆæ‰€æœ‰è½¬ç§»æ—¶æ’­æ”¾â€œèƒœåˆ©éŸ³æ•ˆâ€ã€‚  


## 2. ç²¾é€‰ä¼˜è´¨é¢˜è§£å‚è€ƒ

æˆ‘ä»æ€è·¯æ¸…æ™°åº¦ã€ä»£ç å¯è¯»æ€§ã€ç®—æ³•æ•ˆç‡ç­‰è§’åº¦ï¼Œç­›é€‰äº†3ä»½**4.5æ˜Ÿä»¥ä¸Š**çš„ä¼˜è´¨é¢˜è§£ï¼š


### é¢˜è§£ä¸€ï¼šæ–œç‡ä¼˜åŒ–ï¼ˆä½œè€…ï¼šwhiteqwqï¼‰  
* **ç‚¹è¯„**ï¼š  
  è¿™ä»½é¢˜è§£æ˜¯**æ–œç‡ä¼˜åŒ–çš„æ ‡å‡†å®ç°**ï¼Œæ€è·¯æœ€æ¸…æ™°ã€ä»£ç æœ€ç®€æ´ï¼ä½œè€…å‡†ç¡®æ¨å¯¼äº†è½¬ç§»æ–¹ç¨‹ï¼Œå¹¶å°†å…¶è½¬åŒ–ä¸ºâ€œç›´çº¿æ–œç‡æ¯”è¾ƒâ€çš„é—®é¢˜â€”â€”æŠŠæ¯ä¸ª`k`çœ‹ä½œç‚¹`(suma[k], f[k][j-1] - sumc[k] + suma[k]*sumb[k])`ï¼Œç”¨å•è°ƒé˜Ÿåˆ—ç»´æŠ¤è¿™äº›ç‚¹ç»„æˆçš„â€œä¸‹å‡¸å£³â€ã€‚æ¯æ¬¡å¤„ç†`i`æ—¶ï¼Œä»é˜Ÿåˆ—å¤´éƒ¨é€‰æ–œç‡æœ€å°çš„ç‚¹ï¼ˆæœ€ä¼˜`k`ï¼‰ï¼Œå†æŠŠ`i`åŠ å…¥é˜Ÿåˆ—å°¾éƒ¨ï¼ˆç»´æŠ¤å‡¸å£³ï¼‰ã€‚  
  ä»£ç ä¸­çš„`slope`å‡½æ•°è®¡ç®—ä¸¤ç‚¹é—´çš„æ–œç‡ï¼Œé˜Ÿåˆ—æ“ä½œä¸¥æ ¼éµå¾ªâ€œç»´æŠ¤ä¸‹å‡¸å£³â€çš„é€»è¾‘ï¼Œæ—¶é—´å¤æ‚åº¦O(nm)ï¼Œå®Œå…¨èƒ½é€šè¿‡`n=2e5`çš„æ•°æ®ã€‚  


### é¢˜è§£äºŒï¼šå†³ç­–å•è°ƒæ€§åˆ†æ²»ï¼ˆä½œè€…ï¼šEityDawnï¼‰  
* **ç‚¹è¯„**ï¼š  
  è¿™ä»½é¢˜è§£ç”¨**å†³ç­–å•è°ƒæ€§åˆ†æ²»**è§£å†³é—®é¢˜ï¼Œé€‚åˆå–œæ¬¢â€œåˆ†è€Œæ²»ä¹‹â€çš„åŒå­¦ï¼ä½œè€…è¯æ˜äº†`cost`å‡½æ•°æ»¡è¶³**å››è¾¹å½¢ä¸ç­‰å¼**ï¼ˆå³`cost(l-1,r+1)+cost(l,r) â‰¥ cost(l,r+1)+cost(l-1,r)`ï¼‰ï¼Œå› æ­¤`f[i][j]`çš„å†³ç­–ç‚¹å…·æœ‰å•è°ƒæ€§ï¼ˆæ¯”å¦‚`i`å¢å¤§æ—¶ï¼Œæœ€ä¼˜`k`ä¹Ÿå¢å¤§ï¼‰ã€‚  
  ä»£ç ä¸­çš„`solve`å‡½æ•°ç”¨åˆ†æ²»å¤„ç†ï¼šå…ˆæ‰¾`mid`çš„æœ€ä¼˜`k`ï¼Œå†é€’å½’å¤„ç†å·¦å³åŠåŒºé—´ã€‚è¿™ç§æ–¹æ³•çš„å¤æ‚åº¦æ˜¯O(nm logn)ï¼Œè™½ç„¶æ¯”æ–œç‡ä¼˜åŒ–ç¨æ…¢ï¼Œä½†é€»è¾‘æ›´ç›´è§‚ï¼Œå®¹æ˜“ç†è§£ã€‚  


### é¢˜è§£ä¸‰ï¼šæè¶…çº¿æ®µæ ‘ï¼ˆä½œè€…ï¼š_Arahc_ï¼‰  
* **ç‚¹è¯„**ï¼š  
  è¿™ä»½é¢˜è§£ç”¨**æè¶…çº¿æ®µæ ‘**ä¼˜åŒ–DPï¼Œæ˜¯å¦ä¸€ç§æ€è·¯çš„è¡¥å……ï¼ä½œè€…å°†è½¬ç§»æ–¹ç¨‹çœ‹ä½œâ€œæ±‚å¤šæ¡ç›´çº¿åœ¨æŸç‚¹çš„æœ€å°å€¼â€â€”â€”æ¯ä¸ª`k`å¯¹åº”ä¸€æ¡ç›´çº¿`y = -suma[k] * x + (f[k][j-1] - sumc[k] + suma[k]*sumb[k])`ï¼Œ`x`æ˜¯`sumb[i]`ã€‚æè¶…çº¿æ®µæ ‘å¯ä»¥é«˜æ•ˆç»´æŠ¤è¿™äº›ç›´çº¿ï¼Œå¹¶å¿«é€ŸæŸ¥è¯¢`x=sumb[i]`æ—¶çš„æœ€å°`y`å€¼ã€‚  
  è™½ç„¶æè¶…çº¿æ®µæ ‘çš„å¤æ‚åº¦æ˜¯O(nm logn)ï¼Œä½†ä»£ç ä¸­çš„â€œæ»šåŠ¨æ•°ç»„â€ä¼˜åŒ–ï¼ˆå¤ç”¨çº¿æ®µæ ‘ç©ºé—´ï¼‰å¾ˆå·§å¦™ï¼Œé¿å…äº†å†…å­˜è¶…é™ã€‚  


## 3. æ ¸å¿ƒéš¾ç‚¹è¾¨æä¸è§£é¢˜ç­–ç•¥

### ï¼ˆ1ï¼‰éš¾ç‚¹1ï¼šå¦‚ä½•æ¨å¯¼æœŸæœ›æ—¶é—´ï¼Ÿ  
- **é—®é¢˜**ï¼šä¸ºä»€ä¹ˆé€šè¿‡å…³å¡`i`çš„æœŸæœ›æ—¶é—´æ˜¯`sum(l,i)/t[i]`ï¼Ÿ  
- **è§£å†³**ï¼šç”¨é€’æ¨å¼æ¨å¯¼â€”â€”è®¾æœŸæœ›æ—¶é—´ä¸º`E`ï¼Œåˆ™`E = p*1 + (1-p)*(1+E)`ï¼ˆç¬¬ä¸€æ¬¡æˆåŠŸç”¨1å°æ—¶ï¼Œå¤±è´¥åˆ™æµªè´¹1å°æ—¶ï¼Œé‡æ–°å¼€å§‹ï¼‰ã€‚åŒ–ç®€å¾—`E=1/p`ï¼Œè€Œ`p=t[i]/sum(l,i)`ï¼Œæ‰€ä»¥`E=sum(l,i)/t[i]`ã€‚  


### ï¼ˆ2ï¼‰éš¾ç‚¹2ï¼šå¦‚ä½•ä¼˜åŒ–DPè½¬ç§»ï¼Ÿ  
- **é—®é¢˜**ï¼šç›´æ¥è½¬ç§»æ˜¯O(nÂ²m)ï¼Œæ— æ³•é€šè¿‡å¤§æ•°æ®ã€‚  
- **è§£å†³**ï¼š  
  - å‰ç¼€å’Œä¼˜åŒ–ï¼šæŠŠ`cost(k+1,i)`è½¬åŒ–ä¸º`sumc[i]-sumc[k]-suma[k]*(sumb[i]-sumb[k])`ï¼Œå°†è½¬ç§»æ–¹ç¨‹ä¸­çš„`k`ç›¸å…³é¡¹å’Œ`i`ç›¸å…³é¡¹åˆ†ç¦»ï¼›  
  - æ–œç‡ä¼˜åŒ–ï¼šå°†è½¬ç§»æ–¹ç¨‹æ”¹å†™ä¸º`f[k][j-1] - sumc[k] + suma[k]*sumb[k] = sumb[i]*suma[k] + (f[i][j] - sumc[i])`ï¼Œè¿™æ˜¯`y=kx+b`çš„å½¢å¼ï¼Œç”¨å•è°ƒé˜Ÿåˆ—ç»´æŠ¤â€œä¸‹å‡¸å£³â€æ‰¾æœ€å°`b`ã€‚  


### ï¼ˆ3ï¼‰éš¾ç‚¹3ï¼šå¦‚ä½•ç»´æŠ¤â€œä¸‹å‡¸å£³â€ï¼Ÿ  
- **é—®é¢˜**ï¼šä¸ºä»€ä¹ˆè¦ç”¨å•è°ƒé˜Ÿåˆ—ç»´æŠ¤å‡¸å£³ï¼Ÿ  
- **è§£å†³**ï¼šå› ä¸º`sumc`å’Œ`sumb`éƒ½æ˜¯å•è°ƒé€’å¢çš„ï¼ˆ`t[i]`æ˜¯æ­£æ•°ï¼‰ï¼Œæ‰€ä»¥`k`çš„æ–œç‡ä¹Ÿæ˜¯å•è°ƒé€’å¢çš„ã€‚æ­¤æ—¶ï¼Œâ€œä¸‹å‡¸å£³â€ä¸­çš„ç‚¹å¯¹åº”çš„ç›´çº¿ï¼Œå…¶æ–œç‡é€’å¢ï¼Œä¸”æ¯ä¸ªæ–°ç‚¹åŠ å…¥æ—¶ï¼Œåªéœ€åˆ é™¤é˜Ÿåˆ—å°¾éƒ¨â€œç ´åå‡¸æ€§â€çš„ç‚¹ï¼Œä¿è¯é˜Ÿåˆ—ä¸­çš„ç‚¹æ„æˆä¸‹å‡¸å£³ã€‚  


### âœ¨ è§£é¢˜æŠ€å·§æ€»ç»“  
- **æœŸæœ›æ¨å¯¼**ï¼šè®°ä½â€œæˆåŠŸæ¦‚ç‡`p`çš„æœŸæœ›æ˜¯`1/p`â€ï¼Œå¾ˆå¤šæ¦‚ç‡é¢˜éƒ½ä¼šç”¨åˆ°è¿™ä¸ªç»“è®ºï¼›  
- **DPä¼˜åŒ–**ï¼šå½“è½¬ç§»æ–¹ç¨‹æ˜¯â€œ`min(f[k] + a[i]*b[k] + c[i] + d[k])`â€æ—¶ï¼Œä¼˜å…ˆè€ƒè™‘æ–œç‡ä¼˜åŒ–ï¼›  
- **å‡¸å£³ç»´æŠ¤**ï¼šå•è°ƒé˜Ÿåˆ—æ˜¯ç»´æŠ¤å‡¸å£³çš„å¸¸ç”¨å·¥å…·ï¼Œå…³é”®æ˜¯è¯æ˜æ–œç‡çš„å•è°ƒæ€§ã€‚  


## 4. C++æ ¸å¿ƒä»£ç å®ç°èµæ

### æœ¬é¢˜é€šç”¨æ ¸å¿ƒC++å®ç°å‚è€ƒï¼ˆæ–œç‡ä¼˜åŒ–ç‰ˆï¼‰  
* **è¯´æ˜**ï¼šç»¼åˆwhiteqwqçš„é¢˜è§£ï¼Œæ˜¯æ–œç‡ä¼˜åŒ–çš„æ ‡å‡†å®ç°ï¼Œé€»è¾‘æ¸…æ™°ã€æ•ˆç‡é«˜ã€‚  
* **å®Œæ•´æ ¸å¿ƒä»£ç **ï¼š  
```cpp
#include<stdio.h>
#include<queue>
#define int long long
#define inf 10000000000000000
using namespace std;
const int maxn=200005,maxm=55;
int i,j,k,m,n,l,r;
int a[maxn],suma[maxn],q[maxn];
double b[maxn],c[maxn],sumb[maxn],sumc[maxn],f[maxm][maxn];

// è®¡ç®—ç‚¹kçš„xåæ ‡ï¼ˆsuma[k]ï¼‰
inline int x(int p){ return suma[p]; }
// è®¡ç®—ç‚¹kçš„yåæ ‡ï¼ˆf[j-1][p] + suma[p]*sumb[p] - sumc[p]ï¼‰
inline double y(int p,int c){ return f[c-1][p] + 1.0*suma[p]*sumb[p] - sumc[p]; }
// è®¡ç®—ä¸¤ç‚¹aå’Œbçš„æ–œç‡
inline double slope(int a,int b,int c){
    if(x(a)==x(b)) return y(a,c)>y(b,c)? inf:-inf;
    return 1.0*(y(a,c)-y(b,c))/(x(a)-x(b));
}

signed main(){
    scanf("%lld%lld",&n,&m);
    for(i=1;i<=n;i++){
        scanf("%lld",&a[i]);
        suma[i] = suma[i-1] + a[i];          // tçš„å‰ç¼€å’Œ
        b[i] = 1.0/a[i]; sumb[i] = sumb[i-1] + b[i];  // 1/tçš„å‰ç¼€å’Œ
        c[i] = 1.0*suma[i]/a[i]; sumc[i] = sumc[i-1] + c[i]; // suma[i]/t[i]çš„å‰ç¼€å’Œ
    }
    // åˆå§‹åŒ–ï¼šf[0][i]è¡¨ç¤ºåˆ†æˆ0æ®µï¼Œä¸å¯èƒ½ï¼Œè®¾ä¸ºæ— ç©·å¤§
    for(i=1;i<=n;i++) f[0][i] = inf;
    // æšä¸¾åˆ†æˆjæ®µï¼ˆjä»1åˆ°mï¼‰
    for(i=1;i<=m;i++){
        l=1, r=0; q[++r] = 0; // é˜Ÿåˆ—åˆå§‹åŒ–ï¼Œåˆå§‹å†³ç­–ç‚¹æ˜¯0
        for(j=1;j<=n;j++){
            // ä»é˜Ÿåˆ—å¤´éƒ¨é€‰æœ€ä¼˜å†³ç­–ç‚¹ï¼šæ–œç‡â‰¤sumb[j]æ—¶ï¼Œå¼¹å‡ºé˜Ÿé¦–
            while(l<r && slope(q[l+1], q[l], i) <= sumb[j]) l++;
            // è½¬ç§»è®¡ç®—f[i][j]
            f[i][j] = f[i-1][q[l]] + sumc[j] - sumc[q[l]] - suma[q[l]]*(sumb[j]-sumb[q[l]]);
            // ç»´æŠ¤é˜Ÿåˆ—å°¾éƒ¨ï¼šæ–°ç‚¹jåŠ å…¥å‰ï¼Œåˆ é™¤ç ´åå‡¸æ€§çš„ç‚¹
            while(l<r && slope(j, q[r-1], i) <= slope(q[r], q[r-1], i)) r--;
            q[++r] = j; // åŠ å…¥æ–°ç‚¹j
        }
    }
    printf("%.10lf\n",f[m][n]);
    return 0;
}
```
* **ä»£ç è§£è¯»æ¦‚è¦**ï¼š  
  1. **å‰ç¼€å’Œè®¡ç®—**ï¼š`suma`ï¼ˆtçš„å’Œï¼‰ã€`sumb`ï¼ˆ1/tçš„å’Œï¼‰ã€`sumc`ï¼ˆsuma[i]/t[i]çš„å’Œï¼‰ï¼Œç”¨äºå¿«é€Ÿè®¡ç®—`cost`ï¼›  
  2. **é˜Ÿåˆ—ç»´æŠ¤**ï¼š`q`æ•°ç»„æ¨¡æ‹Ÿå•è°ƒé˜Ÿåˆ—ï¼Œå­˜å‚¨å†³ç­–ç‚¹`k`ï¼›  
  3. **è½¬ç§»è¿‡ç¨‹**ï¼šå¯¹æ¯ä¸ª`j`ï¼ˆå½“å‰å…³å¡ï¼‰ï¼Œä»é˜Ÿåˆ—å¤´éƒ¨é€‰æœ€ä¼˜`k`ï¼Œè®¡ç®—`f[i][j]`ï¼Œå†å°†`j`åŠ å…¥é˜Ÿåˆ—å°¾éƒ¨ï¼ˆç»´æŠ¤å‡¸å£³ï¼‰ã€‚  


### é¢˜è§£ä¸€ï¼ˆæ–œç‡ä¼˜åŒ–ï¼‰æ ¸å¿ƒç‰‡æ®µèµæ  
* **äº®ç‚¹**ï¼šç”¨å•è°ƒé˜Ÿåˆ—é«˜æ•ˆç»´æŠ¤â€œä¸‹å‡¸å£³â€ï¼ŒO(1)æ‰¾åˆ°æœ€ä¼˜å†³ç­–ç‚¹ã€‚  
* **æ ¸å¿ƒä»£ç ç‰‡æ®µ**ï¼š  
```cpp
// ä»é˜Ÿåˆ—å¤´éƒ¨é€‰æœ€ä¼˜å†³ç­–ç‚¹
while(l<r && slope(q[l+1], q[l], i) <= sumb[j]) l++;
f[i][j] = f[i-1][q[l]] + sumc[j] - sumc[q[l]] - suma[q[l]]*(sumb[j]-sumb[q[l]]);
// ç»´æŠ¤é˜Ÿåˆ—å°¾éƒ¨
while(l<r && slope(j, q[r-1], i) <= slope(q[r], q[r-1], i)) r--;
q[++r] = j;
```
* **ä»£ç è§£è¯»**ï¼š  
  - ç¬¬ä¸€éƒ¨åˆ†ï¼šé˜Ÿåˆ—å¤´éƒ¨çš„ç‚¹`q[l]`å’Œ`q[l+1]`ï¼Œå¦‚æœ`q[l+1]`çš„æ–œç‡æ›´å°ï¼ˆæ›´ä¼˜ï¼‰ï¼Œåˆ™å¼¹å‡º`q[l]`ï¼›  
  - ç¬¬äºŒéƒ¨åˆ†ï¼šç”¨é€‰ä¸­çš„`q[l]`è®¡ç®—`f[i][j]`ï¼›  
  - ç¬¬ä¸‰éƒ¨åˆ†ï¼šæ–°ç‚¹`j`åŠ å…¥å‰ï¼Œæ£€æŸ¥é˜Ÿåˆ—å°¾éƒ¨çš„ç‚¹`q[r]`å’Œ`q[r-1]`ï¼Œå¦‚æœ`j`å’Œ`q[r-1]`çš„æ–œç‡â‰¤`q[r]`å’Œ`q[r-1]`çš„æ–œç‡ï¼ˆç ´åå‡¸æ€§ï¼‰ï¼Œåˆ™å¼¹å‡º`q[r]`ï¼›  
* ğŸ’¡ **å­¦ä¹ ç¬”è®°**ï¼šå•è°ƒé˜Ÿåˆ—ç»´æŠ¤å‡¸å£³çš„å…³é”®æ˜¯â€œæ–œç‡å•è°ƒâ€ï¼Œè¿™æ ·å¯ä»¥ä¿è¯é˜Ÿåˆ—ä¸­çš„ç‚¹æ˜¯æœ€ä¼˜çš„ã€‚  


## 5. ç®—æ³•å¯è§†åŒ–ï¼šåƒç´ åŠ¨ç”»æ¼”ç¤º  

### åŠ¨ç”»æ¼”ç¤ºä¸»é¢˜  
**åƒç´ å†’é™©ï¼šå¯»æ‰¾æœ€ä¼˜å†³ç­–ç‚¹**ï¼ˆä»¿ç…§FCã€Šè¶…çº§é©¬é‡Œå¥¥ã€‹çš„é£æ ¼ï¼‰  


### è®¾è®¡æ€è·¯  
ç”¨**8ä½åƒç´ é£**æ¨¡æ‹Ÿæ–œç‡ä¼˜åŒ–çš„è¿‡ç¨‹ï¼Œè®©æŠ½è±¡çš„â€œå‡¸å£³ç»´æŠ¤â€å˜å¾—ç›´è§‚ï¼š  
- **åœºæ™¯**ï¼šå±å¹•å·¦ä¾§æ˜¯â€œå…³å¡åˆ—è¡¨â€ï¼ˆç”¨ä¸åŒé¢œè‰²çš„åƒç´ å—è¡¨ç¤ºå…³å¡`i`ï¼‰ï¼Œå³ä¾§æ˜¯â€œå†³ç­–é˜Ÿåˆ—â€ï¼ˆç”¨é˜Ÿåˆ—å½¢å¼å±•ç¤º`k`ï¼‰ï¼›  
- **è§’è‰²**ï¼šä¸€ä¸ªåƒç´ å°äººä»£è¡¨â€œå½“å‰å¤„ç†çš„`i`â€ï¼Œå®ƒä¼šä»é˜Ÿåˆ—ä¸­é€‰æœ€ä¼˜`k`ï¼›  
- **éŸ³æ•ˆ**ï¼šé€‰`k`æ—¶æ’­æ”¾â€œå®â€å£°ï¼ˆFCé£æ ¼ï¼‰ï¼ŒåŠ å…¥é˜Ÿåˆ—æ—¶æ’­æ”¾â€œæ»´â€å£°ï¼Œå®Œæˆæ‰€æœ‰è½¬ç§»æ—¶æ’­æ”¾â€œèƒœåˆ©éŸ³æ•ˆâ€ï¼›  
- **äº¤äº’**ï¼šæ”¯æŒâ€œå•æ­¥æ‰§è¡Œâ€ï¼ˆæŒ‰ç©ºæ ¼ï¼‰ã€â€œè‡ªåŠ¨æ’­æ”¾â€ï¼ˆè°ƒé€Ÿæ»‘å—ï¼‰ã€â€œé‡ç½®â€ï¼ˆæŒ‰Ré”®ï¼‰ã€‚  


### åŠ¨ç”»å¸§æ­¥éª¤  
1. **åˆå§‹åŒ–**ï¼š  
   - å…³å¡åˆ—è¡¨æ˜¾ç¤º`1~n`çš„åƒç´ å—ï¼Œ`suma`ã€`sumb`ã€`sumc`ç”¨å°æ•°å­—æ˜¾ç¤ºåœ¨ä¸‹æ–¹ï¼›  
   - å†³ç­–é˜Ÿåˆ—åˆå§‹åŒ–ä¸º`[0]`ï¼ˆç”¨ç»¿è‰²åƒç´ å—è¡¨ç¤ºï¼‰ï¼›  
   - æ’­æ”¾8ä½é£æ ¼çš„èƒŒæ™¯éŸ³ä¹ã€‚  

2. **å¤„ç†`i=1`**ï¼š  
   - åƒç´ å°äººèµ°åˆ°`i=1`çš„ä½ç½®ï¼Œé—ªçƒæç¤ºï¼›  
   - é˜Ÿåˆ—å¤´éƒ¨æ˜¯`0`ï¼Œè®¡ç®—`f[1][1]`ï¼ˆ`j=1`æ®µï¼‰ï¼›  
   - å°†`i=1`åŠ å…¥é˜Ÿåˆ—å°¾éƒ¨ï¼ˆé˜Ÿåˆ—å˜ä¸º`[0,1]`ï¼‰ï¼Œæ’­æ”¾â€œæ»´â€å£°ã€‚  

3. **å¤„ç†`i=2`**ï¼š  
   - å°äººèµ°åˆ°`i=2`ï¼Œæ£€æŸ¥é˜Ÿåˆ—å¤´éƒ¨ï¼š`slope(1,0,1)`æ˜¯å¦â‰¤`sumb[2]`ï¼Ÿå¦‚æœæ˜¯ï¼Œå¼¹å‡º`0`ï¼Œé˜Ÿåˆ—å˜ä¸º`[1]`ï¼›  
   - ç”¨`1`è®¡ç®—`f[1][2]`ï¼›  
   - æ£€æŸ¥é˜Ÿåˆ—å°¾éƒ¨ï¼š`slope(2,1,1)`æ˜¯å¦â‰¤`slope(1,0,1)`ï¼Ÿå¦‚æœæ˜¯ï¼Œå¼¹å‡º`1`ï¼Œå°†`2`åŠ å…¥é˜Ÿåˆ—ï¼ˆé˜Ÿåˆ—å˜ä¸º`[2]`ï¼‰ã€‚  

4. **é‡å¤æ­¥éª¤**ï¼šç›´åˆ°å¤„ç†å®Œæ‰€æœ‰`i`ï¼Œæ’­æ”¾â€œèƒœåˆ©éŸ³æ•ˆâ€ï¼Œæ˜¾ç¤ºæœ€ç»ˆçš„`f[m][n]`ã€‚  


## 6. æ‹“å±•ç»ƒä¹ ä¸ç›¸ä¼¼é—®é¢˜æ€è€ƒ

### é€šç”¨æ€è·¯è¿ç§»  
æ–œç‡ä¼˜åŒ–å’Œå†³ç­–å•è°ƒæ€§æ˜¯**å¤„ç†â€œåŒºé—´DPâ€æˆ–â€œçº¿æ€§DPâ€çš„å¸¸ç”¨æŠ€å·§**ï¼Œé€‚ç”¨äºä»¥ä¸‹åœºæ™¯ï¼š  
1. åˆ†å‰²æ•°ç»„æœ€å°åŒ–æˆæœ¬ï¼ˆå¦‚æœ¬é¢˜ï¼‰ï¼›  
2. ç©å…·è£…ç®±é—®é¢˜ï¼ˆå°†ç©å…·è£…æˆç®±ï¼Œæœ€å°åŒ–æˆæœ¬ï¼‰ï¼›  
3. æ•°åˆ—åˆ’åˆ†é—®é¢˜ï¼ˆå°†æ•°åˆ—åˆ†æˆkæ®µï¼Œæœ€å°åŒ–æŸæŒ‡æ ‡ï¼‰ã€‚  


### æ´›è°·ç»ƒä¹ æ¨è  
1. **P2365 ç©å…·è£…ç®±**  
   - ğŸ—£ï¸ **æ¨èç†ç”±**ï¼šæ–œç‡ä¼˜åŒ–çš„ç»å…¸é¢˜ï¼è½¬ç§»æ–¹ç¨‹å’Œæœ¬é¢˜é«˜åº¦ç›¸ä¼¼ï¼Œé€‚åˆå·©å›ºæ–œç‡ä¼˜åŒ–çš„å®ç°ã€‚  
2. **P3195 HNOI2008 ç©å…·è£…ç®±**  
   - ğŸ—£ï¸ **æ¨èç†ç”±**ï¼šåŒä¸Šï¼Œæ•°æ®èŒƒå›´æ›´å¤§ï¼Œéœ€è¦æ›´é«˜æ•ˆçš„å®ç°ï¼ˆæ¯”å¦‚æ»šåŠ¨æ•°ç»„ï¼‰ã€‚  
3. **P1729 NOI2016 ç½‘æ ¼**  
   - ğŸ—£ï¸ **æ¨èç†ç”±**ï¼šå†³ç­–å•è°ƒæ€§åˆ†æ²»çš„åº”ç”¨ï¼Œé€‚åˆç†è§£â€œå››è¾¹å½¢ä¸ç­‰å¼â€å’Œåˆ†æ²»æ€è·¯ã€‚  


## 7. å­¦ä¹ å¿ƒå¾—ä¸ç»éªŒåˆ†äº«  
- **ä½œè€…whiteqwqçš„å¿ƒå¾—**ï¼šâ€œæ–œç‡ä¼˜åŒ–çš„å…³é”®æ˜¯æŠŠè½¬ç§»æ–¹ç¨‹è½¬åŒ–ä¸ºçº¿æ€§å½¢å¼ï¼Œç„¶åè¯æ˜æ–œç‡å•è°ƒã€‚â€  
  - **ç‚¹è¯„**ï¼šè¿™å¥è¯ç‚¹å‡ºäº†æ–œç‡ä¼˜åŒ–çš„æ ¸å¿ƒï¼å¾ˆå¤šåŒå­¦å¡åœ¨â€œå¦‚ä½•è½¬åŒ–æ–¹ç¨‹â€ï¼Œå…¶å®åªè¦æŠŠ`k`ç›¸å…³çš„é¡¹å’Œ`i`ç›¸å…³çš„é¡¹åˆ†ç¦»ï¼Œå°±èƒ½çœ‹å‡ºçº¿æ€§å…³ç³»ã€‚  
- **ä½œè€…EityDawnçš„å¿ƒå¾—**ï¼šâ€œè¯æ˜å››è¾¹å½¢ä¸ç­‰å¼æ—¶ï¼Œè¦æŠŠ`cost`å‡½æ•°å±•å¼€ï¼Œçœ‹æ˜¯å¦æ»¡è¶³æ¡ä»¶ã€‚â€  
  - **ç‚¹è¯„**ï¼šå†³ç­–å•è°ƒæ€§çš„å…³é”®æ˜¯â€œå››è¾¹å½¢ä¸ç­‰å¼â€ï¼Œè¯æ˜æ—¶è¦è€å¿ƒå±•å¼€å¼å­ï¼Œæ‰¾è§„å¾‹ã€‚  


## ç»“è¯­  
é€šè¿‡è¿™é“é¢˜ï¼Œæˆ‘ä»¬å­¦ä¼šäº†**ç”¨åŠ¨æ€è§„åˆ’è§£å†³â€œåˆ†å‰²é—®é¢˜â€**ï¼Œå¹¶é€šè¿‡æ–œç‡ä¼˜åŒ–æˆ–å†³ç­–å•è°ƒæ€§å°†å¤æ‚åº¦ä»O(nÂ²m)é™åˆ°O(nm)æˆ–O(nm logn)ã€‚è®°ä½ï¼š**DPçš„ä¼˜åŒ–å¾€å¾€æ˜¯â€œæ•°å­¦è½¬åŒ–â€çš„ç»“æœ**â€”â€”æŠŠé—®é¢˜è½¬åŒ–ä¸ºæ›´é«˜æ•ˆçš„å½¢å¼ï¼Œå°±èƒ½æ‰¾åˆ°çªç ´å£ï¼  

ä¸‹æ¬¡é‡åˆ°ç±»ä¼¼çš„â€œåˆ†å‰²æ•°ç»„æ±‚æœ€å°æœŸæœ›/æˆæœ¬â€é—®é¢˜ï¼Œä¸å¦¨è¯•è¯•ä»Šå¤©å­¦çš„æŠ€å·§ï½ åŠ æ²¹ï¼ğŸ’ª

---
å¤„ç†ç”¨æ—¶ï¼š142.53ç§’
# é¢˜ç›®ä¿¡æ¯

# The Three Little Pigs

## é¢˜ç›®æè¿°

Three little pigs from all over the world are meeting for a convention! Every minute, a triple of 3 new pigs arrives on the convention floor. After the $ n $ -th minute, the convention ends.

The big bad wolf has learned about this convention, and he has an attack plan. At some minute in the convention, he will arrive and eat exactly $ x $ pigs. Then he will get away.

The wolf wants Gregor to help him figure out the number of possible attack plans that involve eating exactly $ x $ pigs for various values of $ x $ ( $ 1 \le x \le 3n $ ). Two attack plans are considered different, if they occur at different times or if the sets of little pigs to eat are different.

Note that all queries are independent, that is, the wolf does not eat the little pigs, he only makes plans!

## è¯´æ˜/æç¤º

In the example test, $ n=2 $ . Thus, there are $ 3 $ pigs at minute $ 1 $ , and $ 6 $ pigs at minute $ 2 $ . There are three queries: $ x=1 $ , $ x=5 $ , and $ x=6 $ .

If the wolf wants to eat $ 1 $ pig, he can do so in $ 3+6=9 $ possible attack plans, depending on whether he arrives at minute $ 1 $ or $ 2 $ .

If the wolf wants to eat $ 5 $ pigs, the wolf cannot arrive at minute $ 1 $ , since there aren't enough pigs at that time. Therefore, the wolf has to arrive at minute $ 2 $ , and there are $ 6 $ possible attack plans.

If the wolf wants to eat $ 6 $ pigs, his only plan is to arrive at the end of the convention and devour everybody.

Remember to output your answers modulo $ 10^9+7 $ !

## æ ·ä¾‹ #1

### è¾“å…¥

```
2 3
1
5
6```

### è¾“å‡º

```
9
6
1```

## æ ·ä¾‹ #2

### è¾“å…¥

```
5 4
2
4
6
8```

### è¾“å‡º

```
225
2001
6014
6939```

# AIåˆ†æç»“æœ

# ğŸ’¡ Kayçš„C++ç®—æ³•è§£æï¼šThe Three Little Pigs æ·±å…¥å­¦ä¹ æŒ‡å— ğŸ’¡


## 1. é¢˜ç›®è§£è¯»ä¸æ ¸å¿ƒç®—æ³•è¯†åˆ«

âœ¨ **æœ¬é¢˜ä¸»è¦è€ƒå¯Ÿ**ï¼šç»„åˆæ•°å­¦ + åŠ¨æ€è§„åˆ’ï¼ˆæˆ–ç”Ÿæˆå‡½æ•°ï¼‰


ğŸ—£ï¸ **åˆæ­¥åˆ†æ**ï¼š  
é¢˜ç›®æ˜¯è¯´ï¼Œæ¯åˆ†é’Ÿä¼šæ¥3åªå°çŒªï¼Œ`n`åˆ†é’Ÿåä¼šè®®ç»“æŸã€‚ç‹¼æƒ³åœ¨æŸä¸€åˆ†é’Ÿæ¥åƒ`x`åªçŒªï¼Œæ±‚æœ‰å¤šå°‘ç§ä¸åŒçš„æ”»å‡»è®¡åˆ’â€”â€”å…¶å®å°±æ˜¯**è®¡ç®—ä»ç¬¬1åˆ†é’Ÿåˆ°ç¬¬nåˆ†é’Ÿï¼Œæ¯ä¸ªæ—¶é—´ç‚¹æœ‰`3i`åªçŒªæ—¶ï¼Œé€‰`x`åªçš„æ–¹å¼æ•°ä¹‹å’Œ**ï¼Œä¹Ÿå°±æ˜¯æ•°å­¦è¡¨è¾¾å¼ï¼š  
$$ans(x) = \sum_{i=1}^n \binom{3i}{x}$$  
ï¼ˆ$\binom{a}{b}$è¡¨ç¤ºä»`a`ä¸ªä¸­é€‰`b`ä¸ªçš„ç»„åˆæ•°ï¼Œå½“`a < b`æ—¶ç»“æœä¸º0ï¼‰


### æ ¸å¿ƒç®—æ³•ï¼šåŠ¨æ€è§„åˆ’+ç»„åˆæ’ç­‰å¼
ä¸ºäº†é«˜æ•ˆè®¡ç®—è¿™ä¸ªæ±‚å’Œï¼Œæˆ‘ä»¬éœ€è¦**ç”¨åŠ¨æ€è§„åˆ’ï¼ˆDPï¼‰ç»“åˆç»„åˆæ•°çš„æ€§è´¨**ã€‚ç®€å•æ¥è¯´ï¼Œå°±æ˜¯æŠŠâ€œé€‰`x`åªçŒªâ€çš„é—®é¢˜æ‹†åˆ†æˆæ›´å°çš„å­é—®é¢˜ï¼Œé€šè¿‡é€’æ¨å¿«é€Ÿå¾—åˆ°ç»“æœã€‚  
- **ä¸ºä»€ä¹ˆç”¨DPï¼Ÿ** ç›´æ¥è®¡ç®—æ¯ä¸ª`i`çš„$\binom{3i}{x}$å†æ±‚å’Œï¼Œæ—¶é—´ä¼šçˆ†ç‚¸ï¼ˆ`n`åˆ°1e6ï¼Œ`q`åˆ°2e5ï¼‰ï¼Œè€ŒDPèƒ½æŠŠå¤æ‚åº¦é™åˆ°`O(n+q)`ï¼Œåˆšå¥½èƒ½é€šè¿‡ã€‚  
- **æ ¸å¿ƒæ€è·¯**ï¼šå®šä¹‰`f[x][j]`è¡¨ç¤º`sum_{i=0}^n \binom{3i+j}{x}`ï¼ˆ`j=0,1,2`ï¼Œåˆ†åˆ«å¯¹åº”3iã€3i+1ã€3i+2åªçŒªçš„æƒ…å†µï¼‰ã€‚æˆ‘ä»¬çš„ç›®æ ‡æ˜¯`f[x][0]`ï¼ˆå› ä¸ºé¢˜ç›®æ˜¯`3i`åªçŒªï¼‰ã€‚  
- **å…³é”®æ¨å¯¼**ï¼šåˆ©ç”¨ç»„åˆæ•°çš„ä¸¤ä¸ªé‡è¦æ€§è´¨ï¼š  
  1. $\binom{n}{m} = \binom{n-1}{m} + \binom{n-1}{m-1}$ï¼ˆé€‰ç¬¬nä¸ªå…ƒç´ æˆ–ä¸é€‰ï¼‰ï¼›  
  2. $\sum_{i=0}^k \binom{i}{m} = \binom{k+1}{m+1}$ï¼ˆæ‰€æœ‰å‰kä¸ªå…ƒç´ ä¸­é€‰mä¸ªçš„æ–¹å¼æ•°ä¹‹å’Œï¼Œç­‰äºä»k+1ä¸ªä¸­é€‰m+1ä¸ªçš„æ–¹å¼æ•°ï¼‰ã€‚  

é€šè¿‡è¿™ä¸¤ä¸ªæ€§è´¨ï¼Œæˆ‘ä»¬èƒ½æ¨å¯¼å‡º`f[x][0]`çš„é€’æ¨å¼ï¼š  
$$f[x][0] = \frac{1}{3} \left( \binom{3n+3}{x+1} - 2f[x-1][0] - f[x-1][1] \right)$$  
ï¼ˆ`1/3`æ˜¯æ¨¡æ„ä¹‰ä¸‹çš„é€†å…ƒï¼Œå› ä¸ºè¦é™¤ä»¥3ï¼‰


### å¯è§†åŒ–è®¾è®¡æ€è·¯
æˆ‘ä»¬ä¼šç”¨**8ä½åƒç´ é£åŠ¨ç”»**å±•ç¤ºDPé€’æ¨çš„è¿‡ç¨‹ï¼š  
- **åœºæ™¯**ï¼šå±å¹•å·¦ä¾§æ˜¯â€œç»„åˆæ•°å·¥å‚â€ï¼ˆæ˜¾ç¤º$\binom{3n+3}{x+1}$çš„è®¡ç®—ï¼‰ï¼Œä¸­é—´æ˜¯â€œDPé€’æ¨æœºâ€ï¼ˆä¸‰ä¸ªåƒç´ æŸ±ä»£è¡¨`f[x][0]`ã€`f[x][1]`ã€`f[x][2]`ï¼‰ï¼Œå³ä¾§æ˜¯â€œç»“æœå±â€ï¼ˆæ˜¾ç¤ºå½“å‰`x`çš„ç­”æ¡ˆï¼‰ã€‚  
- **åŠ¨ç”»æ­¥éª¤**ï¼š  
  1. åˆå§‹åŒ–æ—¶ï¼Œä¸‰ä¸ªæŸ±å­é«˜åº¦ä¸º`n+1`ï¼ˆè¾¹ç•Œæ¡ä»¶ï¼‰ï¼›  
  2. æ¯ä¸€æ­¥`x`å¢åŠ 1ï¼Œâ€œç»„åˆæ•°å·¥å‚â€ä¼šå¼¹å‡ºä¸€ä¸ªåƒç´ å—ï¼ˆä»£è¡¨$\binom{3n+3}{x+1}$ï¼‰ï¼›  
  3. é€’æ¨æœºè®¡ç®—`f[x][0]`ï¼šç”¨ç»„åˆæ•°å‡å»`2*f[x-1][0]`å’Œ`f[x-1][1]`ï¼Œå†ä¹˜ä»¥é€†å…ƒ3ï¼ŒæŸ±å­é«˜åº¦å˜åŒ–ï¼›  
  4. è®¡ç®—`f[x][1]`ï¼š`f[x][0] + f[x-1][0]`ï¼ŒæŸ±å­é«˜åº¦æ›´æ–°ï¼›  
- **éŸ³æ•ˆ**ï¼šè®¡ç®—ç»„åˆæ•°æ—¶æ’­æ”¾â€œå®â€çš„åƒç´ éŸ³ï¼Œé€’æ¨å®Œæˆæ—¶æ’­æ”¾â€œæ»´â€çš„æç¤ºéŸ³ï¼Œå½“`x`è¾¾åˆ°ç›®æ ‡æ—¶æ’­æ”¾èƒœåˆ©éŸ³æ•ˆï¼ˆæ¯”å¦‚FCæ¸¸æˆçš„â€œé€šå…³å£°â€ï¼‰ã€‚  


## 2. ç²¾é€‰ä¼˜è´¨é¢˜è§£å‚è€ƒ

ä¸ºå¤§å®¶ç­›é€‰äº†3ä»½**æ€è·¯æ¸…æ™°ã€ä»£ç è§„èŒƒã€å¤æ‚åº¦ä¼˜**çš„é¢˜è§£ï¼š


### é¢˜è§£ä¸€ï¼šDoubeecatçš„DP+ç»„åˆæ’ç­‰å¼ï¼ˆèµ22ï¼‰
* **ç‚¹è¯„**ï¼šè¿™ä»½é¢˜è§£çš„**æ ¸å¿ƒä¼˜åŠ¿æ˜¯é€’æ¨å¼æ¨å¯¼éå¸¸è¯¦ç»†**ï¼ä½œè€…ä»å®šä¹‰`f[i][k]`å¼€å§‹ï¼Œä¸€æ­¥æ­¥ç”¨ç»„åˆæ’ç­‰å¼æ¨å‡ºä¸‰ä¸ªå…³é”®å¼å­ï¼Œæœ€åè”ç«‹å¾—åˆ°é€’æ¨å¼ã€‚ä»£ç ä¸­ç”¨çº¿æ€§æ±‚é€†å…ƒé¿å…äº†è¶…æ—¶ï¼Œè¾¹ç•Œæ¡ä»¶å¤„ç†ä¸¥è°¨ï¼ˆæ¯”å¦‚`f[0][0] = f[0][1] = f[0][2] = n`ï¼‰ã€‚å¯¹äºæ–°æ‰‹æ¥è¯´ï¼Œè¿™ç§â€œä»æ€§è´¨åˆ°å…¬å¼â€çš„æ¨å¯¼è¿‡ç¨‹éå¸¸é€‚åˆç†è§£DPçš„æœ¬è´¨ã€‚


### é¢˜è§£äºŒï¼šregisterGençš„ç®€æ´DPå®ç°ï¼ˆèµ2ï¼‰
* **ç‚¹è¯„**ï¼šè¿™ä»½é¢˜è§£çš„**ä»£ç é£æ ¼ç‰¹åˆ«å‹å¥½**ï¼å˜é‡å`f[x][0]`ã€`f[x][1]`ç›´æ¥å¯¹åº”å®šä¹‰ï¼Œ`inv3`ï¼ˆ3çš„é€†å…ƒï¼‰å‘½åæ¸…æ™°ã€‚é€’æ¨éƒ¨åˆ†çš„ä»£ç åªæœ‰ä¸‰è¡Œï¼Œå´å®Œæ•´å®ç°äº†æ ¸å¿ƒé€»è¾‘ï¼š  
  ```cpp
  f[i][0] = 1LL * ((C(3*n+3,i+1) - 2*f[i-1][0] - f[i-1][1] + 2*P) % P) * inv3 % P;
  f[i][1] = (f[i][0] + f[i-1][0]) % P;
  ```  
  è€Œä¸”é¢„å¤„ç†ç»„åˆæ•°çš„`initComb`å‡½æ•°æ¨¡å—åŒ–ï¼Œæ–¹ä¾¿å¤ç”¨ã€‚


### é¢˜è§£ä¸‰ï¼šlittleKtiançš„ç”Ÿæˆå‡½æ•°æ–¹æ³•ï¼ˆèµ2ï¼‰
* **ç‚¹è¯„**ï¼šè¿™ä»½é¢˜è§£æä¾›äº†**å¦ä¸€ç§æ€è·¯â€”â€”ç”Ÿæˆå‡½æ•°**ï¼ä½œè€…æŠŠæ±‚å’Œè½¬åŒ–ä¸ºç­‰æ¯”æ•°åˆ—çš„ç”Ÿæˆå‡½æ•°ï¼š  
  $$sum = \frac{(1+x)^3 - (1+x)^{3n+3}}{1-(1+x)^3}$$  
  ç„¶åé€šè¿‡å¤šé¡¹å¼é™¤æ³•è®¡ç®—åˆ†å­é™¤ä»¥åˆ†æ¯çš„ç³»æ•°ï¼Œå¾—åˆ°æ¯ä¸ª`x`çš„ç­”æ¡ˆã€‚è¿™ç§æ–¹æ³•é€‚åˆå­¦è¿‡ç”Ÿæˆå‡½æ•°çš„åŒå­¦ï¼Œèƒ½æ‹“å±•å¯¹ç»„åˆæ•°æ±‚å’Œçš„ç†è§£ã€‚ä»£ç ä¸­é¢„å¤„ç†ç»„åˆæ•°çš„`C`å‡½æ•°ç®€æ´ï¼Œå¤šé¡¹å¼é™¤æ³•çš„å¾ªç¯é€»è¾‘æ¸…æ™°ã€‚


## 3. æ ¸å¿ƒéš¾ç‚¹è¾¨æä¸è§£é¢˜ç­–ç•¥

### 1. éš¾ç‚¹1ï¼šå¦‚ä½•å®šä¹‰åˆé€‚çš„DPçŠ¶æ€ï¼Ÿ
* **é—®é¢˜**ï¼šç›´æ¥æ±‚`sum_{i=1}^n C(3i, x)`å¾ˆéš¾é€’æ¨ï¼Œå› ä¸º`3i`æ˜¯è·³è·ƒçš„ï¼ˆæ¯æ¬¡åŠ 3ï¼‰ã€‚  
* **è§£å†³**ï¼šå¼•å…¥`j=0,1,2`ï¼ŒæŠŠçŠ¶æ€æ‰©å±•ä¸º`f[x][j] = sum_{i=0}^n C(3i+j, x)`ã€‚è¿™æ ·å°±èƒ½è¦†ç›–æ‰€æœ‰å¯èƒ½çš„â€œçŒªçš„æ•°é‡â€ï¼ˆ3iã€3i+1ã€3i+2ï¼‰ï¼Œä»è€Œç”¨ç»„åˆæ’ç­‰å¼è¿æ¥ä¸åŒçŠ¶æ€ã€‚  
* ğŸ’¡ **å­¦ä¹ ç¬”è®°**ï¼šçŠ¶æ€å®šä¹‰è¦â€œè¦†ç›–æ‰€æœ‰å­é—®é¢˜â€ï¼Œæœ‰æ—¶å€™éœ€è¦åŠ ç»´åº¦ï¼ˆæ¯”å¦‚è¿™é‡Œçš„`j`ï¼‰æ¥æ‹†åˆ†å¤æ‚é—®é¢˜ã€‚


### 2. éš¾ç‚¹2ï¼šå¦‚ä½•æ¨å¯¼é€’æ¨å¼ï¼Ÿ
* **é—®é¢˜**ï¼šç»„åˆæ•°çš„æ€§è´¨å¾ˆå¤šï¼Œä¸çŸ¥é“ç”¨å“ªä¸€ä¸ªã€‚  
* **è§£å†³**ï¼šä»ä¸¤ä¸ªåŸºç¡€æ€§è´¨å‡ºå‘ï¼š  
  - ç”¨$\binom{n}{m} = \binom{n-1}{m} + \binom{n-1}{m-1}$å¾—åˆ°`f[x][1] = f[x][0] + f[x-1][0]`ï¼ˆ`3i+1`çš„ç»„åˆæ•°ç­‰äº`3i`çš„ç»„åˆæ•°åŠ ä¸Š`3i`é€‰`x-1`çš„ç»„åˆæ•°ï¼‰ï¼›  
  - ç”¨$\sum_{i=0}^k C(i, x) = C(k+1, x+1)$å¾—åˆ°`f[x][0]+f[x][1]+f[x][2] = C(3n+3, x+1)`ï¼ˆæ‰€æœ‰3n+2åªçŒªä¸­é€‰xåªçš„æ–¹å¼æ•°ä¹‹å’Œï¼‰ã€‚  
  è”ç«‹è¿™ä¸¤ä¸ªå¼å­ï¼Œå°±èƒ½è§£å‡º`f[x][0]`çš„é€’æ¨å¼ã€‚  
* ğŸ’¡ **å­¦ä¹ ç¬”è®°**ï¼šç»„åˆæ’ç­‰å¼æ˜¯è§£å†³ç»„åˆæ•°æ±‚å’Œçš„â€œé’¥åŒ™â€ï¼Œè¦è®°ä½å¸¸ç”¨çš„å‡ ä¸ªï¼ˆæ¯”å¦‚ä¸Šé¢ä¸¤ä¸ªï¼‰ã€‚


### 3. éš¾ç‚¹3ï¼šå¦‚ä½•é«˜æ•ˆé¢„å¤„ç†ç»„åˆæ•°ï¼Ÿ
* **é—®é¢˜**ï¼šè®¡ç®—$\binom{a}{b}$éœ€è¦é˜¶ä¹˜å’Œé€†å…ƒï¼Œ`n`åˆ°1e6æ—¶ï¼Œå¿«é€Ÿå¹‚æ±‚é€†å…ƒä¼šè¶…æ—¶ã€‚  
* **è§£å†³**ï¼šç”¨**çº¿æ€§æ±‚é€†å…ƒ**ï¼é¢„å¤„ç†é˜¶ä¹˜æ•°ç»„`fac`å’Œé€†å…ƒæ•°ç»„`ifac`ï¼š  
  - `fac[i] = fac[i-1] * i % MOD`ï¼ˆé˜¶ä¹˜ï¼‰ï¼›  
  - `ifac[lim] = qpow(fac[lim], MOD-2)`ï¼ˆæœ€åä¸€ä¸ªé€†å…ƒç”¨å¿«é€Ÿå¹‚ï¼‰ï¼›  
  - `ifac[i-1] = ifac[i] * i % MOD`ï¼ˆä»åå¾€å‰æ¨é€†å…ƒï¼‰ã€‚  
  è¿™æ ·`C(a,b)`å°±èƒ½ç”¨`fac[a] * ifac[b] % MOD * ifac[a-b] % MOD`å¿«é€Ÿè®¡ç®—ã€‚  
* ğŸ’¡ **å­¦ä¹ ç¬”è®°**ï¼šçº¿æ€§æ±‚é€†å…ƒæ˜¯å¤„ç†å¤§ç»„åˆæ•°çš„â€œå¿…å¤‡æŠ€å·§â€ï¼Œèƒ½æŠŠæ—¶é—´å¤æ‚åº¦ä»`O(n log MOD)`é™åˆ°`O(n)`ã€‚


### âœ¨ è§£é¢˜æŠ€å·§æ€»ç»“
1. **çŠ¶æ€æ‰©å±•**ï¼šå½“ç›´æ¥é€’æ¨å›°éš¾æ—¶ï¼ŒåŠ ç»´åº¦æ‹†åˆ†é—®é¢˜ï¼ˆæ¯”å¦‚æœ¬é¢˜çš„`j=0,1,2`ï¼‰ï¼›  
2. **ç»„åˆæ’ç­‰å¼**ï¼šè®°ä½å¸¸ç”¨çš„ç»„åˆæ•°æ€§è´¨ï¼Œæ¯”å¦‚æ±‚å’Œå…¬å¼ã€é€’æ¨å…¬å¼ï¼›  
3. **çº¿æ€§é¢„å¤„ç†**ï¼šå¤„ç†å¤§ç»„åˆæ•°æ—¶ï¼Œç”¨çº¿æ€§æ±‚é€†å…ƒé¿å…è¶…æ—¶ï¼›  
4. **æ¨¡è¿ç®—æ³¨æ„**ï¼šå‡æ³•è¦åŠ `MOD`å†å–æ¨¡ï¼Œé¿å…è´Ÿæ•°ï¼ˆæ¯”å¦‚`(a - b + MOD) % MOD`ï¼‰ã€‚


## 4. C++æ ¸å¿ƒä»£ç å®ç°èµæ

### æœ¬é¢˜é€šç”¨æ ¸å¿ƒC++å®ç°å‚è€ƒï¼ˆDPæ–¹æ³•ï¼‰
* **è¯´æ˜**ï¼šç»¼åˆDoubeecatå’ŒregisterGençš„é¢˜è§£ï¼Œå–æœ€ç®€æ´çš„DPå®ç°ï¼ŒåŒ…å«ç»„åˆæ•°é¢„å¤„ç†å’Œé€’æ¨é€»è¾‘ã€‚
* **å®Œæ•´æ ¸å¿ƒä»£ç **ï¼š
```cpp
#include <cstdio>
using namespace std;
typedef long long ll;

const int MOD = 1e9+7;
const int MAXN = 3e6+10; // 3*1e6+10

ll fac[MAXN], ifac[MAXN], f[MAXN][2]; // f[x][0]å’Œf[x][1]ï¼Œf[x][2]ä¸éœ€è¦
int n, q;

ll qpow(ll a, ll b) {
    ll res = 1;
    while (b) {
        if (b & 1) res = res * a % MOD;
        a = a * a % MOD;
        b >>= 1;
    }
    return res;
}

void init() {
    // é¢„å¤„ç†é˜¶ä¹˜å’Œé€†å…ƒ
    fac[0] = 1;
    for (int i = 1; i < MAXN; i++)
        fac[i] = fac[i-1] * i % MOD;
    ifac[MAXN-1] = qpow(fac[MAXN-1], MOD-2);
    for (int i = MAXN-2; i >= 0; i--)
        ifac[i] = ifac[i+1] * (i+1) % MOD;
}

ll C(int a, int b) {
    if (a < 0 || b < 0 || a < b) return 0;
    return fac[a] * ifac[b] % MOD * ifac[a - b] % MOD;
}

int main() {
    init();
    scanf("%d%d", &n, &q);
    ll inv3 = qpow(3, MOD-2); // 3çš„é€†å…ƒ
    f[0][0] = f[0][1] = n + 1; // è¾¹ç•Œæ¡ä»¶ï¼šx=0æ—¶ï¼Œæ¯ä¸ªiçš„C(3i+j,0)=1ï¼Œsumæ˜¯n+1
    
    for (int x = 1; x <= 3*n; x++) {
        // è®¡ç®—f[x][0]
        ll tmp = (C(3*n + 3, x + 1) - 2*f[x-1][0] % MOD - f[x-1][1] + 2*MOD) % MOD;
        f[x][0] = tmp * inv3 % MOD;
        // è®¡ç®—f[x][1]
        f[x][1] = (f[x][0] + f[x-1][0]) % MOD;
    }
    
    while (q--) {
        int x;
        scanf("%d", &x);
        printf("%lld\n", f[x][0]);
    }
    return 0;
}
```
* **ä»£ç è§£è¯»æ¦‚è¦**ï¼š  
  1. `init()`å‡½æ•°é¢„å¤„ç†é˜¶ä¹˜`fac`å’Œé€†å…ƒ`ifac`ï¼›  
  2. `C(a,b)`è®¡ç®—ç»„åˆæ•°$\binom{a}{b}$ï¼›  
  3. ä¸»å‡½æ•°ä¸­ï¼Œå…ˆåˆå§‹åŒ–è¾¹ç•Œæ¡ä»¶`f[0][0] = f[0][1] = n+1`ï¼ˆx=0æ—¶ï¼Œæ¯ä¸ªç»„åˆæ•°éƒ½æ˜¯1ï¼Œsumæ˜¯n+1ï¼‰ï¼›  
  4. é€’æ¨`x`ä»1åˆ°3nï¼Œè®¡ç®—`f[x][0]`å’Œ`f[x][1]`ï¼›  
  5. å¤„ç†æ¯ä¸ªæŸ¥è¯¢ï¼Œè¾“å‡º`f[x][0]`ã€‚


### é¢˜è§£ä¸€ï¼šDoubeecatçš„æ ¸å¿ƒä»£ç ç‰‡æ®µ
* **äº®ç‚¹**ï¼šè¯¦ç»†æ¨å¯¼äº†é€’æ¨å¼ï¼Œç”¨`f[i][k]`è¦†ç›–æ‰€æœ‰æƒ…å†µã€‚
* **æ ¸å¿ƒä»£ç ç‰‡æ®µ**ï¼š
```cpp
// å®šä¹‰f[i][k] = sum_{t=0}^{n-1} C(3t + k, x)
f[i][1] = f[i-1][0] + f[i][0];
f[i][2] = f[i-1][1] + f[i][1];
f[i][0] = (C(3*i, x+1) - 2*f[i-1][0] - f[i-1][1]) * inv3 % MOD;
```
* **ä»£ç è§£è¯»**ï¼š  
  è¿™ä¸‰è¡Œæ˜¯é€’æ¨çš„æ ¸å¿ƒï¼ç¬¬ä¸€è¡Œç”¨ç»„åˆæ•°çš„é€’æ¨å¼å¾—åˆ°`f[i][1]`ï¼ˆ`3t+1`çš„ç»„åˆæ•°ç­‰äº`3t`çš„ç»„åˆæ•°åŠ ä¸Š`3t`é€‰`x-1`çš„ç»„åˆæ•°ï¼‰ï¼›ç¬¬äºŒè¡ŒåŒç†å¾—åˆ°`f[i][2]`ï¼›ç¬¬ä¸‰è¡Œè”ç«‹ä¸‰ä¸ªå¼å­ï¼Œè§£å‡º`f[i][0]`ã€‚  
* ğŸ’¡ **å­¦ä¹ ç¬”è®°**ï¼šé€’æ¨å¼çš„å…³é”®æ˜¯â€œç”¨å·²çŸ¥çš„å­é—®é¢˜ç»“æœæ¨å¯¼å½“å‰é—®é¢˜â€ï¼Œè¦æŠŠç»„åˆæ’ç­‰å¼è½¬åŒ–ä¸ºä»£ç ä¸­çš„è¿ç®—ã€‚


### é¢˜è§£ä¸‰ï¼šlittleKtiançš„ç”Ÿæˆå‡½æ•°æ ¸å¿ƒä»£ç 
* **äº®ç‚¹**ï¼šç”¨ç”Ÿæˆå‡½æ•°å°†æ±‚å’Œè½¬åŒ–ä¸ºå¤šé¡¹å¼é™¤æ³•ï¼Œæ€è·¯æ–°é¢–ã€‚
* **æ ¸å¿ƒä»£ç ç‰‡æ®µ**ï¼š
```cpp
// ç”Ÿæˆå‡½æ•°ï¼šF(x) = sum_{i=1}^n (1+x)^{3i} = [(1+x)^3 - (1+x)^{3n+3}] / [1 - (1+x)^3]
for (int i = 0; i <= 3*n+3; i++) a[i] = C(3*n+3, i);
a[0] -= 1; a[1] -= 3; a[2] -= 3; a[3] -= 1; // åˆ†å­æ˜¯(1+x)^3 - (1+x)^{3n+3}
for (int i = 3*n+3; i >= 3; i--) {
    ans[i-3] = a[i];
    a[i-1] = (a[i-1] - 3*a[i] % MOD + MOD) % MOD;
    a[i-2] = (a[i-2] - 3*a[i] % MOD + MOD) % MOD;
}
```
* **ä»£ç è§£è¯»**ï¼š  
  é¦–å…ˆè®¡ç®—åˆ†å­`(1+x)^3 - (1+x)^{3n+3}`çš„ç³»æ•°`a[i]`ï¼›ç„¶åè¿›è¡Œå¤šé¡¹å¼é™¤æ³•ï¼ˆåˆ†æ¯æ˜¯`1 - (1+x)^3 = -x^3 -3x^2 -3x`ï¼‰ï¼Œå¾ªç¯è®¡ç®—æ¯ä¸ª`x`çš„ç³»æ•°`ans[x]`ã€‚  
* ğŸ’¡ **å­¦ä¹ ç¬”è®°**ï¼šç”Ÿæˆå‡½æ•°æ˜¯ç»„åˆæ•°å­¦çš„â€œé«˜çº§å·¥å…·â€ï¼Œèƒ½æŠŠæ±‚å’Œé—®é¢˜è½¬åŒ–ä¸ºå¤šé¡¹å¼è¿ç®—ï¼Œé€‚åˆå¤„ç†å¤æ‚çš„ç»„åˆæ•°æ±‚å’Œã€‚


## 5. ç®—æ³•å¯è§†åŒ–ï¼šåƒç´ åŠ¨ç”»æ¼”ç¤º (æ ¸å¿ƒéƒ¨åˆ†)

### åŠ¨ç”»æ¼”ç¤ºä¸»é¢˜ï¼šâ€œç‹¼çš„æ”»å‡»è®¡åˆ’æ¨¡æ‹Ÿå™¨â€ï¼ˆ8ä½åƒç´ é£ï¼‰
æˆ‘ä»¬ç”¨**FCçº¢ç™½æœºé£æ ¼**çš„åŠ¨ç”»ï¼Œæ¨¡æ‹ŸDPé€’æ¨çš„è¿‡ç¨‹ï¼Œè®©ä½ â€œçœ‹â€åˆ°æ¯ä¸ª`x`çš„ç­”æ¡ˆæ˜¯æ€ä¹ˆç®—å‡ºæ¥çš„ï¼


### è®¾è®¡æ€è·¯ç®€è¿°
- **é£æ ¼**ï¼šé‡‡ç”¨8ä½åƒç´ è‰²æ¿ï¼ˆæ¯”å¦‚é»‘åº•ã€ç™½å­—ã€çº¢/ç»¿/è“çš„åƒç´ å—ï¼‰ï¼Œæ¨¡ä»¿ã€Šè¶…çº§ç›ä¸½ã€‹çš„UIï¼›  
- **è¶£å‘³æ€§**ï¼šæŠŠâ€œç»„åˆæ•°â€åšæˆâ€œåƒç´ çŒªâ€ï¼Œâ€œé€’æ¨â€åšæˆâ€œå·¥å‚åŠ å·¥â€ï¼Œç‹¼çš„æ”»å‡»åŠ¨ç”»ä¼šåœ¨ç»“æœå‡ºæ¥æ—¶è·³å‡ºæ¥ï¼›  
- **äº¤äº’æ€§**ï¼šæ”¯æŒå•æ­¥æ‰§è¡Œï¼ˆçœ‹æ¯ä¸€æ­¥çš„è®¡ç®—ï¼‰ã€è‡ªåŠ¨æ’­æ”¾ï¼ˆåŠ é€Ÿçœ‹å®Œæ•´è¿‡ç¨‹ï¼‰ã€é‡ç½®ï¼ˆé‡æ–°å¼€å§‹ï¼‰ã€‚


### åŠ¨ç”»å¸§æ­¥éª¤ä¸äº¤äº’å…³é”®ç‚¹
1. **åœºæ™¯åˆå§‹åŒ–**ï¼š  
   - å±å¹•å·¦ä¾§æ˜¯â€œç»„åˆæ•°å†œåœºâ€ï¼šæ˜¾ç¤º$\binom{3n+3}{x+1}$çš„â€œåƒç´ çŒªå †â€ï¼ˆæ•°é‡ç­‰äºç»„åˆæ•°çš„å€¼ï¼‰ï¼›  
   - ä¸­é—´æ˜¯â€œDPåŠ å·¥å‚â€ï¼šä¸‰ä¸ªç»¿è‰²åƒç´ æŸ±ï¼Œåˆ†åˆ«ä»£è¡¨`f[x][0]`ã€`f[x][1]`ã€`f[x][2]`ï¼ˆé«˜åº¦ç­‰äºå½“å‰å€¼ï¼‰ï¼›  
   - å³ä¾§æ˜¯â€œç‹¼çš„ç›®æ ‡æ¿â€ï¼šæ˜¾ç¤ºå½“å‰æŸ¥è¯¢çš„`x`ï¼Œä»¥åŠæœ€ç»ˆçš„æ”»å‡»è®¡åˆ’æ•°ï¼›  
   - åº•éƒ¨æ§åˆ¶é¢æ¿ï¼šæœ‰â€œå•æ­¥â€â€œè‡ªåŠ¨â€â€œé‡ç½®â€æŒ‰é’®ï¼Œå’Œé€Ÿåº¦æ»‘å—ï¼ˆä»â€œæ…¢â€åˆ°â€œå¿«â€ï¼‰ã€‚

2. **ç®—æ³•å¯åŠ¨**ï¼š  
   - åˆå§‹åŒ–æ—¶ï¼Œä¸‰ä¸ªåƒç´ æŸ±çš„é«˜åº¦éƒ½æ˜¯`n+1`ï¼ˆè¾¹ç•Œæ¡ä»¶ï¼‰ï¼›  
   - æ’­æ”¾8ä½é£æ ¼çš„èƒŒæ™¯éŸ³ä¹ï¼ˆæ¯”å¦‚ã€Šå¦å…‹å¤§æˆ˜ã€‹çš„BGMï¼‰ã€‚

3. **æ ¸å¿ƒé€’æ¨æ¼”ç¤º**ï¼ˆä»¥`x=1`ä¸ºä¾‹ï¼‰ï¼š  
   - **æ­¥éª¤1**ï¼šâ€œç»„åˆæ•°å†œåœºâ€å¼¹å‡º1åªâ€œåƒç´ çŒªâ€ï¼ˆä»£è¡¨$\binom{3n+3}{2}$ï¼‰ï¼Œä¼´éšâ€œå®â€çš„éŸ³æ•ˆï¼›  
   - **æ­¥éª¤2**ï¼šâ€œDPåŠ å·¥å‚â€è®¡ç®—`f[1][0]`ï¼šç”¨ç»„åˆæ•°å‡å»`2*f[0][0]`å’Œ`f[0][1]`ï¼Œå†ä¹˜ä»¥é€†å…ƒ3ï¼Œç»¿è‰²æŸ±å­é«˜åº¦å˜ä¸ºå¯¹åº”å€¼ï¼›  
   - **æ­¥éª¤3**ï¼šè®¡ç®—`f[1][1]`ï¼š`f[1][0] + f[0][0]`ï¼Œç¬¬äºŒä¸ªæŸ±å­é«˜åº¦æ›´æ–°ï¼›  
   - **æ­¥éª¤4**ï¼šå³ä¾§â€œç‹¼çš„ç›®æ ‡æ¿â€æ˜¾ç¤º`x=1`çš„ç­”æ¡ˆ`f[1][0]`ï¼Œç‹¼çš„åƒç´ åŠ¨ç”»è·³å‡ºæ¥â€œåƒâ€çŒªï¼Œä¼´éšâ€œå—·â€çš„éŸ³æ•ˆã€‚

4. **ç›®æ ‡è¾¾æˆ**ï¼š  
   - å½“æ‰€æœ‰`x`çš„é€’æ¨å®Œæˆï¼Œæ’­æ”¾èƒœåˆ©éŸ³æ•ˆï¼ˆæ¯”å¦‚ã€Šé­‚æ–—ç½—ã€‹çš„é€šå…³å£°ï¼‰ï¼Œå±å¹•å¼¹å‡ºâ€œæ‰€æœ‰æ”»å‡»è®¡åˆ’å·²è®¡ç®—å®Œæˆï¼â€çš„åƒç´ æ–‡å­—ã€‚


### æ—ç™½æç¤ºï¼ˆåŠ¨ç”»ä¸­çš„æ–‡å­—æ°”æ³¡ï¼‰
- â€œç°åœ¨è®¡ç®—x=1çš„ç­”æ¡ˆï¼Œå…ˆçœ‹ç»„åˆæ•°å†œåœºçš„$\binom{3n+3}{2}$ï¼â€  
- â€œDPåŠ å·¥å‚å¼€å§‹è®¡ç®—f[1][0]ï¼Œå‡å»2*f[0][0]å’Œf[0][1]ï¼Œå†ä¹˜ä»¥é€†å…ƒ3~â€  
- â€œf[1][1]ç­‰äºf[1][0]åŠ f[0][0]ï¼ŒæŸ±å­å˜é«˜å•¦ï¼â€  
- â€œç‹¼çš„æ”»å‡»è®¡åˆ’æ•°æ˜¯f[1][0]ï¼ŒæˆåŠŸï¼â€


## 6. æ‹“å±•ç»ƒä¹ ä¸ç›¸ä¼¼é—®é¢˜æ€è€ƒ

### é€šç”¨æ€è·¯/æŠ€å·§è¿ç§»
æœ¬é¢˜çš„æ ¸å¿ƒæŠ€å·§ï¼ˆç»„åˆæ•°é¢„å¤„ç†ã€DPé€’æ¨ã€çº¿æ€§é€†å…ƒï¼‰å¯ä»¥è§£å†³å¾ˆå¤š**ç»„åˆæ•°æ±‚å’Œ**çš„é—®é¢˜ï¼Œæ¯”å¦‚ï¼š  
1. æ±‚`sum_{i=1}^n C(ki, x)`ï¼ˆkæ˜¯ä»»æ„å¸¸æ•°ï¼‰ï¼›  
2. æ±‚`sum_{i=1}^n C(i, x) * 2^i`ï¼ˆå¸¦ç³»æ•°çš„ç»„åˆæ•°æ±‚å’Œï¼‰ï¼›  
3. æ±‚`sum_{i=1}^n C(2i, x) + C(2i-1, x)`ï¼ˆå¥‡å¶ç»„åˆæ•°æ±‚å’Œï¼‰ã€‚


### ç»ƒä¹ æ¨è (æ´›è°·)
1. **æ´›è°· P1771 ç»„åˆæ•°é—®é¢˜**  
   - ğŸ—£ï¸ **æ¨èç†ç”±**ï¼šç›´æ¥è€ƒå¯Ÿç»„åˆæ•°çš„æ±‚å’Œï¼Œéœ€è¦ç”¨å‰ç¼€å’Œå’Œç»„åˆæ’ç­‰å¼ï¼Œå·©å›ºæœ¬é¢˜çš„DPæ€è·¯ã€‚  
2. **æ´›è°· P2513 é€†å…ƒ**  
   - ğŸ—£ï¸ **æ¨èç†ç”±**ï¼šä¸“é—¨ç»ƒä¹ çº¿æ€§æ±‚é€†å…ƒçš„æŠ€å·§ï¼Œæ˜¯å¤„ç†å¤§ç»„åˆæ•°çš„åŸºç¡€ã€‚  
3. **æ´›è°· P3807 å¢å¡æ–¯å®šç†**  
   - ğŸ—£ï¸ **æ¨èç†ç”±**ï¼šå­¦ä¹ ç»„åˆæ•°æ¨¡è´¨æ•°çš„é«˜çº§æŠ€å·§ï¼Œæ‹“å±•å¯¹ç»„åˆæ•°çš„ç†è§£ã€‚  
4. **æ´›è°· P4091 ç»„åˆæ•°é—®é¢˜**  
   - ğŸ—£ï¸ **æ¨èç†ç”±**ï¼šç»“åˆåŠ¨æ€è§„åˆ’å’Œç»„åˆæ•°ï¼Œè§£å†³æ›´å¤æ‚çš„æ±‚å’Œé—®é¢˜ï¼Œæå‡ç»¼åˆèƒ½åŠ›ã€‚


## 7. å­¦ä¹ å¿ƒå¾—ä¸ç»éªŒåˆ†äº« (è‹¥æœ‰)

### å‚è€ƒç»éªŒï¼ˆæ¥è‡ªhihihi198çš„é¢˜è§£ï¼‰
> â€œèµ›æ—¶æˆ‘ä¸€å¼€å§‹æƒ³ç›´æ¥æ¨å¼å­ï¼Œä½†æ²¡æ¨å‡ºæ¥ã€‚åæ¥æƒ³åˆ°ç”¨DPï¼Œä½†æ˜¯ä¸€å¼€å§‹çš„è½¬ç§»æ–¹ç¨‹æœ‰é—®é¢˜ï¼Œå› ä¸ºf[x][0]è¢«æ¶ˆæ‰äº†ã€‚åæ¥æˆ‘ç”¨sum C(i,x) = C(n+1,x+1)è¿™ä¸ªå¼å­æ›¿æ¢ï¼Œæ‰å¾—åˆ°äº†æ­£ç¡®çš„é€’æ¨å¼ã€‚â€

**ç‚¹è¯„**ï¼šè¿™ä½ä½œè€…çš„ç»å†å¾ˆå…¸å‹ï¼å¾ˆå¤šæ—¶å€™ï¼Œ**å•ä¸€çš„æ€§è´¨ä¸è¶³ä»¥è§£å†³é—®é¢˜ï¼Œéœ€è¦ç»“åˆå¤šä¸ªæ€§è´¨**ã€‚å½“é€’æ¨å¼å‡ºç°â€œå¾ªç¯ä¾èµ–â€ï¼ˆæ¯”å¦‚f[x][0]ä¾èµ–è‡ªå·±ï¼‰æ—¶ï¼Œè¦æƒ³åŠæ³•ç”¨å…¶ä»–æ€§è´¨æ›¿æ¢ï¼Œæ¯”å¦‚æœ¬é¢˜ä¸­çš„æ±‚å’Œå…¬å¼ã€‚


## æ€»ç»“
æœ¬æ¬¡åˆ†æçš„é¢˜ç›®æ˜¯**ç»„åˆæ•°æ±‚å’Œçš„ç»å…¸é—®é¢˜**ï¼Œæ ¸å¿ƒæ˜¯ç”¨åŠ¨æ€è§„åˆ’ç»“åˆç»„åˆæ’ç­‰å¼ï¼Œå°†å¤æ‚çš„æ±‚å’Œè½¬åŒ–ä¸ºé«˜æ•ˆçš„é€’æ¨ã€‚é€šè¿‡å­¦ä¹ æœ¬é¢˜ï¼Œä½ èƒ½æŒæ¡ï¼š  
- ç»„åˆæ•°çš„å¸¸ç”¨æ€§è´¨ï¼›  
- åŠ¨æ€è§„åˆ’çš„çŠ¶æ€è®¾è®¡æŠ€å·§ï¼›  
- çº¿æ€§æ±‚é€†å…ƒçš„æ–¹æ³•ï¼›  
- ç”Ÿæˆå‡½æ•°çš„åº”ç”¨ï¼ˆå¯é€‰ï¼‰ã€‚  

è®°ä½ï¼Œ**ç¼–ç¨‹çš„æœ¬è´¨æ˜¯â€œé—®é¢˜æ‹†åˆ†â€**â€”â€”æŠŠå¤§é—®é¢˜æ‹†æˆå°é—®é¢˜ï¼Œç”¨å·²çŸ¥çš„æŠ€å·§è§£å†³æ¯ä¸ªå°é—®é¢˜ï¼Œæœ€åç»„åˆèµ·æ¥å¾—åˆ°ç­”æ¡ˆã€‚ä¸‹æ¬¡é‡åˆ°ç»„åˆæ•°æ±‚å’Œçš„é—®é¢˜ï¼Œä¸å¦¨è¯•è¯•ä»Šå¤©å­¦çš„DPæ€è·¯ï¼ğŸ’ª


---
**æŠ¥å‘Šç»“æŸ**ï¼Œå¸Œæœ›è¿™ä»½æŒ‡å—èƒ½å¸®åŠ©ä½ ç†è§£æœ¬é¢˜çš„æ ¸å¿ƒé€»è¾‘ï¼å¦‚æœæœ‰ç–‘é—®ï¼Œæ¬¢è¿éšæ—¶æé—®~ ğŸ˜Š

---
å¤„ç†ç”¨æ—¶ï¼š133.95ç§’
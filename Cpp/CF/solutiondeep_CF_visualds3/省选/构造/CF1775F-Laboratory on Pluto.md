# é¢˜ç›®ä¿¡æ¯

# Laboratory on Pluto

## é¢˜ç›®æè¿°

As you know, Martian scientists are actively engaged in space research. One of the highest priorities is Pluto. In order to study this planet in more detail, it was decided to build a laboratory on Pluto.

It is known that the lab will be built of $ n $ square blocks of equal size. For convenience, we will assume that Pluto's surface is a plane divided by vertical and horizontal lines into unit squares. Each square is either occupied by a lab block or not, and only $ n $ squares are occupied.

Since each block is square, it has four walls. If a wall is adjacent to another block, it is considered inside, otherwise â€” outside.

Pluto is famous for its extremely cold temperatures, so the outside walls of the lab must be insulated. One unit of insulation per exterior wall would be required. Thus, the greater the total length of the outside walls of the lab (i. e., its perimeter), the more insulation will be needed.

Consider the lab layout in the figure below. It shows that the lab consists of $ n = 33 $ blocks, and all the blocks have a total of $ 24 $ outside walls, i. e. $ 24 $ units of insulation will be needed.

You should build the lab optimally, i. e., minimize the amount of insulation. On the other hand, there may be many optimal options, so scientists may be interested in the number of ways to build the lab using the minimum amount of insulation, modulo a prime number $ m $ .

Two ways are considered the same if they are the same when overlapping without turning. Thus, if a lab plan is rotated by $ 90^{\circ} $ , such a new plan can be considered a separate way.

To help scientists explore Pluto, you need to write a program that solves these difficult problems.

 ![](https://cdn.luogu.com.cn/upload/vjudge_pic/CF1775F/19a2731aaaa55a0f9a8048f01dd79ff768ce23d2.png)

## è¯´æ˜/æç¤º

Consider the second example.

If $ n=1 $ , the only way to build a lab is to place a single block. In this case, the perimeter will be equal to four.

When $ n=2 $ , you must place two blocks side by side. This can be done either vertically or horizontally, so there are two ways. It is easy to see that the lab has six outside walls in this case.

For $ n=7 $ , all the $ 22 $ optimal plans are shown in the picture below.

 ![](https://cdn.luogu.com.cn/upload/vjudge_pic/CF1775F/2d61b154960a5ef9890728641d5e6f811e5f6274.png)

## æ ·ä¾‹ #1

### è¾“å…¥

```
3 1
1
2
7```

### è¾“å‡º

```
1 1
#
1 2
##
2 4
.###
####```

## æ ·ä¾‹ #2

### è¾“å…¥

```
3 2
1000000007
1
2
7```

### è¾“å‡º

```
4 1
6 2
12 22```

# AIåˆ†æç»“æœ

# ğŸ’¡ Kayçš„C++ç®—æ³•è§£æï¼šLaboratory on Pluto æ·±å…¥å­¦ä¹ æŒ‡å— ğŸ’¡


## 1. é¢˜ç›®è§£è¯»ä¸æ ¸å¿ƒç®—æ³•è¯†åˆ«

âœ¨ **æœ¬é¢˜ä¸»è¦è€ƒå¯Ÿ**ï¼šåŠ¨æ€è§„åˆ’ï¼ˆåˆ†æ‹†æ•°ï¼‰ã€æšä¸¾ä¼˜åŒ–ã€å·ç§¯åˆå¹¶  

ğŸ—£ï¸ **åˆæ­¥åˆ†æ**ï¼š  
è§£å†³â€œLaboratory on Plutoâ€çš„å…³é”®ï¼Œåœ¨äº**ç”¨æœ€å°å‘¨é•¿æ„é€ nä¸ªæ ¼å­çš„å‡¸å›¾å½¢**ã€‚æ ¹æ®å°å­¦æ•°å­¦çš„å‡å€¼ä¸ç­‰å¼ï¼Œ**çŸ©å½¢çš„å‘¨é•¿æœ€å°**ï¼ˆå½“é•¿å’Œå®½è¶Šæ¥è¿‘æ—¶ï¼Œå‘¨é•¿è¶Šå°ï¼‰ã€‚ä½†nä¸ä¸€å®šæ˜¯çŸ©å½¢é¢ç§¯ï¼Œå› æ­¤éœ€è¦ä»çŸ©å½¢çš„**å››ä¸ªè§’å»æ‰å¤šä½™æ ¼å­**ï¼ˆå¿…é¡»æ˜¯é˜¶æ¢¯å‹ï¼Œå¦åˆ™ä¼šå¢åŠ å‘¨é•¿ï¼‰ã€‚  

- **æ ¸å¿ƒæ€è·¯**ï¼š  
  1. æšä¸¾çŸ©å½¢çš„é•¿`a`å’Œå®½`b`ï¼ˆ`aâ‰¤b`ï¼Œä¸”`aÃ—bâ‰¥n`ï¼‰ï¼Œæ‰¾åˆ°ä½¿å‘¨é•¿`2(a+b)`æœ€å°çš„ç»„åˆã€‚  
  2. è®¡ç®—ä»å››ä¸ªè§’å»æ‰`k=aÃ—b-n`ä¸ªæ ¼å­çš„æ–¹æ¡ˆæ•°ï¼ˆæ¯ä¸ªè§’çš„å»æ‰æ–¹å¼æ˜¯é˜¶æ¢¯å‹ï¼Œæ–¹æ¡ˆæ•°ä¸ºåˆ†æ‹†æ•°ï¼‰ã€‚  
  3. åˆå¹¶å››ä¸ªè§’çš„æ–¹æ¡ˆæ•°ï¼ˆç”¨å·ç§¯ï¼Œå› ä¸ºå››ä¸ªè§’ç‹¬ç«‹ï¼‰ã€‚  

- **æ ¸å¿ƒéš¾ç‚¹**ï¼š  
  - å¦‚ä½•å¿«é€Ÿæ‰¾åˆ°æœ€ä¼˜çŸ©å½¢çš„`a`å’Œ`b`ï¼Ÿï¼ˆè§£å†³ï¼šæšä¸¾æ ¹å·é™„è¿‘çš„`a`ï¼Œå› ä¸º`a`æ¥è¿‘`âˆšn`æ—¶å‘¨é•¿æœ€å°ï¼‰ã€‚  
  - å¦‚ä½•è®¡ç®—æ¯ä¸ªè§’çš„é˜¶æ¢¯å‹å»æ‰æ–¹æ¡ˆæ•°ï¼Ÿï¼ˆè§£å†³ï¼šç»å…¸åˆ†æ‹†æ•°DPï¼Œç±»ä¼¼æ´›è°·P1025ï¼‰ã€‚  
  - å¦‚ä½•åˆå¹¶å››ä¸ªè§’çš„æ–¹æ¡ˆæ•°ï¼Ÿï¼ˆè§£å†³ï¼šç”¨èƒŒåŒ…å·ç§¯ï¼Œæš´åŠ›ä¹˜å››æ¬¡ï¼‰ã€‚  

- **å¯è§†åŒ–è®¾è®¡æ€è·¯**ï¼š  
  ç”¨8ä½åƒç´ é£æ ¼å±•ç¤ºçŸ©å½¢æ„é€ è¿‡ç¨‹ï¼š  
  - åˆå§‹æ—¶ï¼Œå±å¹•æ˜¾ç¤ºä¸€ä¸ª`aÃ—b`çš„åƒç´ çŸ©å½¢ï¼ˆç”¨ç»¿è‰²æ–¹å—è¡¨ç¤ºï¼‰ã€‚  
  - æ¯ä¸ªè§’çš„é˜¶æ¢¯å‹å»æ‰è¿‡ç¨‹ï¼šç”¨çº¢è‰²æ–¹å—æ ‡è®°è¦å»æ‰çš„æ ¼å­ï¼Œä»å¤–åˆ°å†…é€å±‚å‡å°‘ï¼ˆæ¯”å¦‚å·¦ä¸Šè§’ï¼Œç¬¬ä¸€è¡Œå»æ‰1ä¸ªï¼Œç¬¬äºŒè¡Œå»æ‰2ä¸ªï¼Œä¾æ­¤ç±»æ¨ï¼‰ã€‚  
  - å…³é”®æ“ä½œéŸ³æ•ˆï¼šå»æ‰ä¸€ä¸ªæ ¼å­æ—¶æ’­æ”¾â€œå®â€çš„å£°éŸ³ï¼Œåˆå¹¶å››ä¸ªè§’æ—¶æ’­æ”¾â€œå—¡â€çš„å£°éŸ³ã€‚  
  - äº¤äº’ï¼šæ”¯æŒâ€œå•æ­¥æ‰§è¡Œâ€ï¼ˆé€è¡Œå»æ‰æ ¼å­ï¼‰å’Œâ€œè‡ªåŠ¨æ’­æ”¾â€ï¼ˆå¿«é€Ÿå±•ç¤ºæ•´ä¸ªè¿‡ç¨‹ï¼‰ã€‚  


## 2. ç²¾é€‰ä¼˜è´¨é¢˜è§£å‚è€ƒ

### é¢˜è§£ä¸€ï¼ˆæ¥æºï¼šHoveryï¼Œèµï¼š8ï¼‰  
* **ç‚¹è¯„**ï¼š  
  è¿™ä»½é¢˜è§£çš„æ€è·¯**éå¸¸æ¸…æ™°**ï¼Œç›´æ¥æŠ“ä½äº†é—®é¢˜çš„æ ¸å¿ƒâ€”â€”â€œçŸ©å½¢+å››ä¸ªè§’å»æ‰å¤šä½™æ ¼å­â€ã€‚ä½œè€…æå‡ºâ€œ`aÃ—b-nâ‰¤a`â€çš„æ¡ä»¶ï¼Œç¡®ä¿å»æ‰çš„æ ¼å­ä¸ä¼šè¶…è¿‡çŸ©å½¢çš„ä¸€è¾¹ï¼Œé¿å…äº†å¤æ‚çš„è¾¹ç•Œå¤„ç†ã€‚å¯¹äºæ¯ä¸ªè§’çš„æ–¹æ¡ˆæ•°ï¼Œä½œè€…ç”¨åˆ†æ‹†æ•°DPï¼ˆç±»ä¼¼P1025ï¼‰è®¡ç®—ï¼Œç„¶åç”¨å·ç§¯åˆå¹¶å››ä¸ªè§’çš„æ–¹æ¡ˆæ•°ï¼Œç®—æ³•æœ‰æ•ˆæ€§å¾ˆé«˜ã€‚ä»£ç ç»“æ„è§„èŒƒï¼Œå˜é‡å‘½åæ¸…æ™°ï¼ˆå¦‚`f[i]`è¡¨ç¤ºä¸€ä¸ªè§’å»æ‰iä¸ªæ ¼å­çš„æ–¹æ¡ˆæ•°ï¼‰ï¼Œå®è·µä»·å€¼å¼ºã€‚  

### é¢˜è§£äºŒï¼ˆæ¥æºï¼šMine_Kingï¼Œèµï¼š4ï¼‰  
* **ç‚¹è¯„**ï¼š  
  é¢˜è§£è¯¦ç»†è§£é‡Šäº†DPçš„è½¬ç§»æ–¹ç¨‹ï¼ˆ`dp[i][j] = dp[i-1][j-1] + dp[i][j-i]`ï¼‰ï¼Œè®©å­¦ä¹ è€…èƒ½ç†è§£åˆ†æ‹†æ•°çš„è®¡ç®—é€»è¾‘ã€‚ä½œè€…è¿˜æåˆ°â€œç©ºæ ¼æ•°ä¸è¶…è¿‡é•¿å®½çš„è¾ƒå°å€¼â€ï¼Œé¿å…äº†é‡å¤è®¡ç®—ï¼Œä¼˜åŒ–äº†æ•ˆç‡ã€‚ä»£ç ä¸­çš„é¢„å¤„ç†éƒ¨åˆ†ï¼ˆ`dp`ã€`f`æ•°ç»„ï¼‰å’Œå·ç§¯åˆå¹¶ï¼ˆ`g`ã€`gg`æ•°ç»„ï¼‰ç»“æ„æ¸…æ™°ï¼Œæ˜“äºæ¨¡ä»¿ã€‚  

### é¢˜è§£ä¸‰ï¼ˆæ¥æºï¼šzac2010ï¼Œèµï¼š3ï¼‰  
* **ç‚¹è¯„**ï¼š  
  ä½œè€…å¼ºè°ƒäº†â€œå‡¸å›¾å½¢â€çš„é‡è¦æ€§ï¼Œå¹¶ç”¨å¤šæ¬¡DPè§£å†³é—®é¢˜ï¼šç¬¬ä¸€æ¬¡è®¡ç®—åˆ†æ‹†æ•°ï¼ˆ`g[i][j]`ï¼‰ï¼Œç¬¬äºŒæ¬¡æ±‚å‰ç¼€å’Œï¼ˆ`s[i]`ï¼‰ï¼Œç¬¬ä¸‰æ¬¡ç”¨èƒŒåŒ…åˆå¹¶å››ä¸ªè§’çš„æ–¹æ¡ˆæ•°ï¼ˆ`f[i]`ï¼‰ã€‚æ€è·¯è¿è´¯ï¼Œæ­¥éª¤æ˜ç¡®ã€‚ä»£ç ä¸­çš„å¾ªç¯ç»“æ„ï¼ˆå¦‚`L(i, 1, N)`è¡¨ç¤ºä»1åˆ°Nçš„å¾ªç¯ï¼‰ç¬¦åˆç«èµ›ç¼–ç¨‹çš„è§„èŒƒï¼Œå¯è¯»æ€§å¼ºã€‚  


## 3. æ ¸å¿ƒéš¾ç‚¹è¾¨æä¸è§£é¢˜ç­–ç•¥

### 1. å…³é”®ç‚¹1ï¼šå¦‚ä½•æ‰¾åˆ°æœ€ä¼˜çŸ©å½¢çš„é•¿å’Œå®½ï¼Ÿ  
* **åˆ†æ**ï¼š  
  çŸ©å½¢çš„å‘¨é•¿`2(a+b)`æœ€å°å½“ä¸”ä»…å½“`a`å’Œ`b`å°½å¯èƒ½æ¥è¿‘`âˆšn`ã€‚å› æ­¤ï¼Œæšä¸¾`a`ä»`max(1, âˆšn-100)`åˆ°`min(n, âˆšn+100)`ï¼Œè®¡ç®—å¯¹åº”çš„`b=(n+a-1)/a`ï¼ˆå‘ä¸Šå–æ•´ï¼‰ï¼Œæ‰¾åˆ°ä½¿`a+b`æœ€å°çš„ç»„åˆã€‚  
* ğŸ’¡ **å­¦ä¹ ç¬”è®°**ï¼šæšä¸¾æ ¹å·é™„è¿‘çš„æ•°ï¼Œå¯ä»¥å¿«é€Ÿæ‰¾åˆ°æœ€ä¼˜è§£ï¼Œé¿å…éå†æ‰€æœ‰å¯èƒ½çš„`a`ã€‚  

### 2. å…³é”®ç‚¹2ï¼šå¦‚ä½•è®¡ç®—æ¯ä¸ªè§’çš„é˜¶æ¢¯å‹å»æ‰æ–¹æ¡ˆæ•°ï¼Ÿ  
* **åˆ†æ**ï¼š  
  é˜¶æ¢¯å‹å»æ‰çš„æ ¼å­æ•°æ˜¯ä¸€ä¸ª**å•è°ƒä¸é™çš„åºåˆ—**ï¼ˆæ¯”å¦‚ç¬¬ä¸€è¡Œå»æ‰1ä¸ªï¼Œç¬¬äºŒè¡Œå»æ‰2ä¸ªï¼Œæ€»å’Œä¸ºkï¼‰ã€‚ç”¨`dp[i][j]`è¡¨ç¤ºæ€»å’Œä¸ºiã€åˆ†æˆjä¸ªå•è°ƒä¸é™çš„æ•°çš„æ–¹æ¡ˆæ•°ï¼Œè½¬ç§»æ–¹ç¨‹ä¸º`dp[i][j] = dp[i-1][j-1] + dp[i-j][j]`ï¼ˆå‰è€…è¡¨ç¤ºæ–°å¢ä¸€ä¸ª1ï¼Œåè€…è¡¨ç¤ºæ‰€æœ‰æ•°åŠ 1ï¼‰ã€‚ç„¶å`f[i] = sum(dp[i][j])`ï¼ˆjä»1åˆ°iï¼‰è¡¨ç¤ºä¸€ä¸ªè§’å»æ‰iä¸ªæ ¼å­çš„æ–¹æ¡ˆæ•°ã€‚  
* ğŸ’¡ **å­¦ä¹ ç¬”è®°**ï¼šåˆ†æ‹†æ•°DPæ˜¯å¤„ç†å•è°ƒåºåˆ—é—®é¢˜çš„å¸¸ç”¨æ–¹æ³•ï¼Œè®°ä½è½¬ç§»æ–¹ç¨‹å¯ä»¥å¿«é€Ÿè§£å†³ç±»ä¼¼é—®é¢˜ã€‚  

### 3. å…³é”®ç‚¹3ï¼šå¦‚ä½•åˆå¹¶å››ä¸ªè§’çš„æ–¹æ¡ˆæ•°ï¼Ÿ  
* **åˆ†æ**ï¼š  
  å››ä¸ªè§’çš„å»æ‰æ–¹å¼ç‹¬ç«‹ï¼Œå› æ­¤åˆå¹¶æ–¹æ¡ˆæ•°ç›¸å½“äº**å››ä¸ª`f`æ•°ç»„çš„å·ç§¯**ï¼ˆå³æ±‚`f*f*f*f`ï¼‰ã€‚ç”±äº`k=aÃ—b-n`å¾ˆå°ï¼ˆæ ¹å·çº§åˆ«ï¼‰ï¼Œå¯ä»¥ç”¨æš´åŠ›å·ç§¯ï¼ˆä¸‰é‡å¾ªç¯ï¼‰è®¡ç®—ï¼Œæ—¶é—´å¤æ‚åº¦å¯è¡Œã€‚  
* ğŸ’¡ **å­¦ä¹ ç¬”è®°**ï¼šç‹¬ç«‹äº‹ä»¶çš„æ–¹æ¡ˆæ•°åˆå¹¶ï¼Œå¸¸ç”¨å·ç§¯ï¼ˆèƒŒåŒ…é—®é¢˜ï¼‰è§£å†³ï¼Œæš´åŠ›å·ç§¯é€‚ç”¨äºå°è§„æ¨¡æ•°æ®ã€‚  

### âœ¨ è§£é¢˜æŠ€å·§æ€»ç»“  
- **æšä¸¾ä¼˜åŒ–**ï¼šå¯¹äºæ±‚æå€¼çš„é—®é¢˜ï¼Œæšä¸¾æ ¹å·é™„è¿‘çš„æ•°å¯ä»¥å‡å°‘è®¡ç®—é‡ã€‚  
- **åˆ†æ‹†æ•°DP**ï¼šå¤„ç†å•è°ƒåºåˆ—çš„æ–¹æ¡ˆæ•°é—®é¢˜ï¼Œè®°ä½ç»å…¸è½¬ç§»æ–¹ç¨‹ã€‚  
- **å·ç§¯åˆå¹¶**ï¼šç‹¬ç«‹äº‹ä»¶çš„æ–¹æ¡ˆæ•°åˆå¹¶ï¼Œç”¨èƒŒåŒ…å·ç§¯ï¼ˆæš´åŠ›æˆ–FFTï¼‰ã€‚  


## 4. C++æ ¸å¿ƒä»£ç å®ç°èµæ

### æœ¬é¢˜é€šç”¨æ ¸å¿ƒC++å®ç°å‚è€ƒï¼ˆæ¥è‡ªMine_Kingçš„é¢˜è§£ï¼‰  
* **è¯´æ˜**ï¼šæ­¤ä»£ç ç»¼åˆäº†åˆ†æ‹†æ•°DPã€é¢„å¤„ç†å’Œå·ç§¯åˆå¹¶ï¼Œæ˜¯Type2è¯¢é—®çš„å…¸å‹å®ç°ã€‚  
* **å®Œæ•´æ ¸å¿ƒä»£ç **ï¼š  
  ```cpp
  #include <cmath>
  #include <cstdio>
  #include <iostream>
  #include <algorithm>
  using namespace std;

  int T, Type, n, mod;
  int dp[1005][1005], f[1005], g[1005], gg[1005];

  void solve2() {
      int len = 1;
      for (int i = max((int)sqrt(n) - 100, 1); i <= min((int)sqrt(n) + 100, n); i++)
          if (len + (n + len - 1) / len > i + (n + i - 1) / i) len = i;
      printf("%d ", (len + (n + len - 1) / len) * 2);
      int ans = 0;
      for (int r = max((int)sqrt(n) - 100, 1); r <= min((int)sqrt(n) + 100, n); r++) {
          if (len + (n + len - 1) / len != r + (n + r - 1) / r) continue;
          int c = (n + r - 1) / r;
          if (r > c) break;
          int k = r * c - n;
          ans = (ans + gg[k] * (r == c ? 1 : 2) % mod) % mod;
      }
      printf("%d\n", ans);
  }

  int main() {
      scanf("%d%d", &T, &Type);
      if (Type == 2) {
          scanf("%d", &mod);
          dp[0][0] = 1;
          for (int i = 1; i <= 1000; i++)
              for (int j = i; j <= 1000; j++) {
                  if (i == j) { dp[i][j] = 1; continue; }
                  dp[i][j] = dp[i-1][j-1];
                  if (j > i) dp[i][j] = (dp[i][j] + dp[i][j-i]) % mod;
              }
          for (int i = 1; i <= 1000; i++)
              for (int j = 1; j <= i; j++)
                  f[i] = (f[i] + dp[j][i]) % mod;
          for (int i = 0; i <= 1000; i++)
              for (int j = 0; j <= 1000; j++)
                  if (i + j <= 1000) g[i+j] = (g[i+j] + 1LL * f[i] * f[j] % mod) % mod;
          for (int i = 0; i <= 1000; i++)
              for (int j = 0; j <= 1000; j++)
                  if (i + j <= 1000) gg[i+j] = (gg[i+j] + 1LL * f[i] * g[j] % mod) % mod;
      }
      while (T--) {
          scanf("%d", &n);
          if (Type == 2) solve2();
      }
      return 0;
  }
  ```  
* **ä»£ç è§£è¯»æ¦‚è¦**ï¼š  
  1. **é¢„å¤„ç†**ï¼šè®¡ç®—`dp`æ•°ç»„ï¼ˆåˆ†æ‹†æ•°ï¼‰ã€`f`æ•°ç»„ï¼ˆä¸€ä¸ªè§’çš„æ–¹æ¡ˆæ•°ï¼‰ã€`g`æ•°ç»„ï¼ˆä¸¤ä¸ªè§’çš„æ–¹æ¡ˆæ•°ï¼‰ã€`gg`æ•°ç»„ï¼ˆå››ä¸ªè§’çš„æ–¹æ¡ˆæ•°ï¼‰ã€‚  
  2. **æšä¸¾çŸ©å½¢**ï¼šæ‰¾åˆ°ä½¿å‘¨é•¿æœ€å°çš„`r`å’Œ`c`ï¼Œè®¡ç®—`k=r*c-n`ã€‚  
  3. **åˆå¹¶æ–¹æ¡ˆæ•°**ï¼šç”¨`gg[k]`è®¡ç®—å››ä¸ªè§’çš„æ–¹æ¡ˆæ•°ï¼Œä¹˜ä»¥çŸ©å½¢çš„æ–¹å‘æ•°ï¼ˆ`r==c`æ—¶1ç§ï¼Œå¦åˆ™2ç§ï¼‰ã€‚  


### é¢˜è§£ä¸€ï¼ˆæ¥æºï¼šHoveryï¼‰æ ¸å¿ƒä»£ç ç‰‡æ®µ  
* **äº®ç‚¹**ï¼šç”¨åˆ†æ‹†æ•°DPè®¡ç®—ä¸€ä¸ªè§’çš„æ–¹æ¡ˆæ•°ï¼Œæ€è·¯æ¸…æ™°ã€‚  
* **æ ¸å¿ƒä»£ç ç‰‡æ®µ**ï¼š  
  ```cpp
  int dp[1005][1005], f[1005];
  void init() {
      dp[0][0] = 1;
      for (int i = 1; i <= 1000; i++)
          for (int j = i; j <= 1000; j++) {
              if (i == j) dp[i][j] = 1;
              else dp[i][j] = (dp[i-1][j-1] + dp[i][j-i]) % mod;
          }
      for (int i = 1; i <= 1000; i++)
          for (int j = 1; j <= i; j++)
              f[i] = (f[i] + dp[j][i]) % mod;
  }
  ```  
* **ä»£ç è§£è¯»**ï¼š  
  - `dp[i][j]`è¡¨ç¤ºæ€»å’Œä¸º`j`ã€åˆ†æˆ`i`ä¸ªå•è°ƒä¸é™çš„æ•°çš„æ–¹æ¡ˆæ•°ã€‚  
  - è½¬ç§»æ–¹ç¨‹`dp[i][j] = dp[i-1][j-1] + dp[i][j-i]`ï¼š`dp[i-1][j-1]`è¡¨ç¤ºæ–°å¢ä¸€ä¸ª1ï¼Œ`dp[i][j-i]`è¡¨ç¤ºæ‰€æœ‰æ•°åŠ 1ã€‚  
  - `f[i]`æ˜¯`dp[j][i]`çš„å‰ç¼€å’Œï¼Œè¡¨ç¤ºä¸€ä¸ªè§’å»æ‰`i`ä¸ªæ ¼å­çš„æ–¹æ¡ˆæ•°ã€‚  
* ğŸ’¡ **å­¦ä¹ ç¬”è®°**ï¼šåˆ†æ‹†æ•°DPçš„æ ¸å¿ƒæ˜¯è½¬ç§»æ–¹ç¨‹ï¼Œè®°ä½è¿™ä¸ªæ–¹ç¨‹å¯ä»¥è§£å†³å¾ˆå¤šç±»ä¼¼é—®é¢˜ã€‚  


## 5. ç®—æ³•å¯è§†åŒ–ï¼šåƒç´ åŠ¨ç”»æ¼”ç¤º (æ ¸å¿ƒéƒ¨åˆ†)

### åŠ¨ç”»æ¼”ç¤ºä¸»é¢˜ï¼šåƒç´ çŸ©å½¢çš„â€œè§’åˆ‡å‰²â€æ¸¸æˆ  
**è®¾è®¡æ€è·¯**ï¼šç”¨8ä½åƒç´ é£æ ¼æ¨¡æ‹ŸçŸ©å½¢çš„æ„é€ å’Œå››ä¸ªè§’çš„åˆ‡å‰²è¿‡ç¨‹ï¼Œç»“åˆå¤å¤æ¸¸æˆå…ƒç´ ï¼ˆå¦‚éŸ³æ•ˆã€å…³å¡ï¼‰ï¼Œè®©å­¦ä¹ è€…ç›´è§‚ç†è§£ç®—æ³•é€»è¾‘ã€‚  

### åŠ¨ç”»å¸§æ­¥éª¤ä¸äº¤äº’å…³é”®ç‚¹  
1. **åœºæ™¯åˆå§‹åŒ–**ï¼š  
   - å±å¹•æ˜¾ç¤ºä¸€ä¸ª`aÃ—b`çš„ç»¿è‰²åƒç´ çŸ©å½¢ï¼ˆ`a`å’Œ`b`æ˜¯æœ€ä¼˜çŸ©å½¢çš„é•¿å’Œå®½ï¼‰ã€‚  
   - æ§åˆ¶é¢æ¿æœ‰â€œå¼€å§‹â€ã€â€œå•æ­¥â€ã€â€œé‡ç½®â€æŒ‰é’®ï¼Œä»¥åŠé€Ÿåº¦æ»‘å—ã€‚  
   - æ’­æ”¾8ä½é£æ ¼çš„èƒŒæ™¯éŸ³ä¹ï¼ˆå¦‚ã€Šè¶…çº§é©¬é‡Œå¥¥ã€‹çš„è½»å¿«æ—‹å¾‹ï¼‰ã€‚  

2. **çŸ©å½¢æ„é€ **ï¼š  
   - ä»å·¦ä¸Šè§’å¼€å§‹ï¼Œé€è¡Œå¡«å……ç»¿è‰²æ–¹å—ï¼Œç›´åˆ°å½¢æˆ`aÃ—b`çš„çŸ©å½¢ï¼ˆä¼´éšâ€œå¡«å……â€éŸ³æ•ˆï¼šæ¯å¡«å……ä¸€ä¸ªæ–¹å—æ’­æ”¾â€œæ»´â€çš„å£°éŸ³ï¼‰ã€‚  

3. **è§’åˆ‡å‰²è¿‡ç¨‹**ï¼š  
   - é€‰æ‹©å·¦ä¸Šè§’ä½œä¸ºç¬¬ä¸€ä¸ªåˆ‡å‰²è§’ï¼Œç”¨çº¢è‰²æ–¹å—æ ‡è®°è¦å»æ‰çš„æ ¼å­ï¼ˆé˜¶æ¢¯å‹ï¼‰ï¼šç¬¬ä¸€è¡Œå»æ‰1ä¸ªï¼Œç¬¬äºŒè¡Œå»æ‰2ä¸ªï¼Œä¾æ­¤ç±»æ¨ï¼ˆä¼´éšâ€œåˆ‡å‰²â€éŸ³æ•ˆï¼šæ¯å»æ‰ä¸€ä¸ªæ–¹å—æ’­æ”¾â€œå®â€çš„å£°éŸ³ï¼‰ã€‚  
   - åˆ‡å‰²å®Œæˆåï¼Œå·¦ä¸Šè§’çš„çº¢è‰²æ–¹å—æ¶ˆå¤±ï¼Œæ˜¾ç¤ºåˆ‡å‰²åçš„çŸ©å½¢ï¼ˆç»¿è‰²æ–¹å—ï¼‰ã€‚  
   - ä¾æ¬¡åˆ‡å‰²å³ä¸Šè§’ã€å³ä¸‹è§’ã€å·¦ä¸‹è§’ï¼Œæ¯ä¸ªè§’çš„åˆ‡å‰²è¿‡ç¨‹ç±»ä¼¼ã€‚  

4. **ç›®æ ‡è¾¾æˆ**ï¼š  
   - å››ä¸ªè§’åˆ‡å‰²å®Œæˆåï¼Œæ’­æ”¾â€œèƒœåˆ©â€éŸ³æ•ˆï¼ˆå¦‚ã€Šé­‚æ–—ç½—ã€‹çš„é€šå…³éŸ³ä¹ï¼‰ï¼Œå±å¹•æ˜¾ç¤ºâ€œå®Œæˆï¼â€çš„å­—æ ·ï¼Œå¹¶å±•ç¤ºæœ€ç»ˆçš„å‡¸å›¾å½¢ï¼ˆç»¿è‰²æ–¹å—ï¼‰ã€‚  

5. **äº¤äº’åŠŸèƒ½**ï¼š  
   - **å•æ­¥æ‰§è¡Œ**ï¼šç‚¹å‡»â€œå•æ­¥â€æŒ‰é’®ï¼Œé€è¡Œåˆ‡å‰²ä¸€ä¸ªè§’çš„æ ¼å­ã€‚  
   - **è‡ªåŠ¨æ’­æ”¾**ï¼šç‚¹å‡»â€œå¼€å§‹â€æŒ‰é’®ï¼Œå¿«é€Ÿæ’­æ”¾æ•´ä¸ªåˆ‡å‰²è¿‡ç¨‹ï¼ˆé€Ÿåº¦å¯é€šè¿‡æ»‘å—è°ƒæ•´ï¼‰ã€‚  
   - **é‡ç½®**ï¼šç‚¹å‡»â€œé‡ç½®â€æŒ‰é’®ï¼Œå›åˆ°åˆå§‹çŠ¶æ€ã€‚  

### æ—ç™½æç¤º  
- â€œç°åœ¨æˆ‘ä»¬è¦æ„é€ ä¸€ä¸ª`aÃ—b`çš„çŸ©å½¢ï¼Œè¿™æ˜¯å‘¨é•¿æœ€å°çš„å½¢çŠ¶ï¼â€ï¼ˆçŸ©å½¢æ„é€ æ—¶ï¼‰  
- â€œçœ‹ï¼Œå·¦ä¸Šè§’çš„æ ¼å­è¦è¢«åˆ‡å‰²æˆé˜¶æ¢¯å‹ï¼Œè¿™æ ·æ‰ä¸ä¼šå¢åŠ å‘¨é•¿ï¼â€ï¼ˆåˆ‡å‰²æ—¶ï¼‰  
- â€œå››ä¸ªè§’éƒ½åˆ‡å‰²å®Œæˆäº†ï¼Œæœ€ç»ˆçš„å›¾å½¢å‘¨é•¿æœ€å°ï¼â€ï¼ˆå®Œæˆæ—¶ï¼‰  


## 6. æ‹“å±•ç»ƒä¹ ä¸ç›¸ä¼¼é—®é¢˜æ€è€ƒ

### é€šç”¨æ€è·¯/æŠ€å·§è¿ç§»  
- **åˆ†æ‹†æ•°DP**ï¼šé€‚ç”¨äºå¤„ç†å•è°ƒåºåˆ—çš„æ–¹æ¡ˆæ•°é—®é¢˜ï¼ˆå¦‚æ´›è°·P1025ã€Šæ•°çš„åˆ’åˆ†ã€‹ï¼‰ã€‚  
- **å·ç§¯åˆå¹¶**ï¼šé€‚ç”¨äºç‹¬ç«‹äº‹ä»¶çš„æ–¹æ¡ˆæ•°åˆå¹¶ï¼ˆå¦‚æ´›è°·P2224ã€ŠçŸ©å½¢å‘¨é•¿ã€‹ï¼‰ã€‚  
- **æšä¸¾ä¼˜åŒ–**ï¼šé€‚ç”¨äºæ±‚æå€¼çš„é—®é¢˜ï¼ˆå¦‚æ´›è°·P3951ã€Šå°å‡¯çš„ç–‘æƒ‘ã€‹ï¼‰ã€‚  

### ç»ƒä¹ æ¨è (æ´›è°·)  
1. **æ´›è°· P1025** - æ•°çš„åˆ’åˆ†  
   * ğŸ—£ï¸ **æ¨èç†ç”±**ï¼šè¿™é“é¢˜æ˜¯åˆ†æ‹†æ•°DPçš„ç»å…¸é—®é¢˜ï¼Œèƒ½å¸®åŠ©ä½ å·©å›º`dp[i][j]`çš„è½¬ç§»æ–¹ç¨‹ã€‚  
2. **æ´›è°· P2224** - çŸ©å½¢å‘¨é•¿  
   * ğŸ—£ï¸ **æ¨èç†ç”±**ï¼šè¿™é“é¢˜è€ƒå¯ŸçŸ©å½¢å‘¨é•¿çš„è®¡ç®—ï¼Œèƒ½å¸®åŠ©ä½ ç†è§£æœ¬é¢˜ä¸­çŸ©å½¢å‘¨é•¿çš„æœ€å°åŒ–é€»è¾‘ã€‚  
3. **æ´›è°· P3951** - å°å‡¯çš„ç–‘æƒ‘  
   * ğŸ—£ï¸ **æ¨èç†ç”±**ï¼šè¿™é“é¢˜è€ƒå¯Ÿæšä¸¾ä¼˜åŒ–ï¼Œèƒ½å¸®åŠ©ä½ æŒæ¡å¦‚ä½•å¿«é€Ÿæ‰¾åˆ°æœ€ä¼˜è§£ã€‚  


## 7. å­¦ä¹ å¿ƒå¾—ä¸ç»éªŒåˆ†äº« (è‹¥æœ‰)  
**å‚è€ƒç»éªŒ (æ¥è‡ªMine_King)**ï¼šâ€œæˆ‘åœ¨è§£å†³è¿™ä¸ªé—®é¢˜æ—¶ï¼Œæœ€åˆåœ¨å¤„ç†å››ä¸ªè§’çš„æ–¹æ¡ˆæ•°åˆå¹¶æ—¶å¡äº†å¾ˆä¹…ï¼Œåæ¥æƒ³åˆ°ç”¨å·ç§¯ï¼ˆèƒŒåŒ…ï¼‰åˆå¹¶ï¼Œæ‰è§£å†³äº†é—®é¢˜ã€‚è¿™è®©æˆ‘æ„è¯†åˆ°ï¼Œç‹¬ç«‹äº‹ä»¶çš„æ–¹æ¡ˆæ•°åˆå¹¶ï¼Œå·ç§¯æ˜¯ä¸€ä¸ªå¾ˆå¥½çš„å·¥å…·ã€‚â€  
**ç‚¹è¯„**ï¼šè¿™ä½ä½œè€…çš„ç»éªŒå¾ˆå…¸å‹ã€‚åœ¨ç¼–ç¨‹è¿‡ç¨‹ä¸­ï¼Œé‡åˆ°ç‹¬ç«‹äº‹ä»¶çš„æ–¹æ¡ˆæ•°åˆå¹¶é—®é¢˜ï¼Œè¦æƒ³åˆ°ç”¨å·ç§¯ï¼ˆèƒŒåŒ…ï¼‰è§£å†³ã€‚æš´åŠ›å·ç§¯é€‚ç”¨äºå°è§„æ¨¡æ•°æ®ï¼ŒFFTé€‚ç”¨äºå¤§è§„æ¨¡æ•°æ®ã€‚  


## ç»“è¯­  
æœ¬æ¬¡å…³äºâ€œLaboratory on Plutoâ€çš„C++è§£é¢˜åˆ†æå°±åˆ°è¿™é‡Œã€‚å¸Œæœ›è¿™ä»½å­¦ä¹ æŒ‡å—èƒ½å¸®åŠ©å¤§å®¶æ›´å¥½åœ°ç†è§£åŠ¨æ€è§„åˆ’ï¼ˆåˆ†æ‹†æ•°ï¼‰ã€æšä¸¾ä¼˜åŒ–å’Œå·ç§¯åˆå¹¶çš„æŠ€å·§ã€‚è®°ä½ï¼Œç¼–ç¨‹èƒ½åŠ›çš„æå‡åœ¨äºæŒç»­å­¦ä¹ ã€å‹¤äºæ€è€ƒå’Œå‹‡äºå®è·µã€‚ä¸‹æ¬¡æˆ‘ä»¬å†ä¸€èµ·æ¢ç´¢æ–°çš„ç¼–ç¨‹æŒ‘æˆ˜ï¼ğŸ’ª

---
å¤„ç†ç”¨æ—¶ï¼š148.44ç§’
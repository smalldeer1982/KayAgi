# é¢˜ç›®ä¿¡æ¯

# Asesino (Hard Version)

## é¢˜ç›®æè¿°

This is the hard version of the problem. In this version, you must use the minimum number of queries possible. You can make hacks only if both versions of the problem are solved.

This is an interactive problem.

It is a tradition in Mexico's national IOI trainings to play the game "Asesino", which is similar to "Among Us" or "Mafia".

Today, $ n $ players, numbered from $ 1 $ to $ n $ , will play "Asesino" with the following three roles:

- Knight: a Knight is someone who always tells the truth.
- Knave: a Knave is someone who always lies.
- Impostor: an Impostor is someone everybody thinks is a Knight, but is secretly a Knave.

Each player will be assigned a role in the game. There will be exactly one Impostor but there can be any (possible zero) number of Knights and Knaves.

As the game moderator, you have accidentally forgotten the roles of everyone, but you need to determine the player who is the Impostor.

To determine the Impostor, you will ask some questions. In each question, you will pick two players $ i $ and $ j $ ( $ 1 \leq i, j \leq n $ ; $ i \neq j $ ) and ask if player $ i $ thinks that player $ j $ is a Knight. The results of the question is shown in the table below.

 KnightKnaveImpostorKnightYesNoYesKnaveNoYesNoImpostorNoYesâ€” The response of the cell in row $ a $ and column $ b $ is the result of asking a question when $ i $ has role $ a $ and $ j $ has row $ b $ . For example, the "Yes" in the top right cell belongs to row "Knight" and column "Impostor", so it is the response when $ i $ is a Knight and $ j $ is an Impostor.Find the Impostor in the minimum number of queries possible. That is, let $ f(n) $ be the minimum integer such that for $ n $ players, there exists a strategy that can determine the Impostor using at most $ f(n) $ questions. Then, you should use at most $ f(n) $ questions to determine the Impostor.

Note: the grader is adaptive: the roles of the players are not fixed in the beginning and may change depending on your questions. However, it is guaranteed that there exists an assignment of roles that is consistent with all previously asked questions under the constraints of this problem.

## è¯´æ˜/æç¤º

Note that the example test cases do not represent an optimal strategy for asking questions and are only shown for the sake of demonstrating the interaction format. Specifically, we cannot determine which player is the Impostor from the questions asked in the examples.

In the first test case of the example, players at indices $ 2 $ and $ 6 $ are Knights, players at indices $ 1 $ , $ 3 $ , $ 5 $ , and $ 7 $ are Knaves, and the Impostor is at index $ 4 $ . The following is an explanation of the questions asked:

- In the first query, player $ i $ is a Knave and player $ j $ is a Knave. The answer is "yes" since Knaves always lie.
- In the second query, player $ i $ is a Knave and player $ j $ is a Knight. The answer is "no" since Knaves always lie.
- In the third query, player $ i $ is a Knight and player $ j $ is a Knave. The answer is "no" since Knights always tell the truth.
- In the fourth query, player $ i $ is a Knight and player $ j $ is a Knight. The answer is "yes" since Knights always tell the truth.
- In the fifth query, player $ i $ is a Impostor and player $ j $ is a Knave. The answer is "yes" since the Impostor always lies.
- In the sixth query, player $ i $ is a Impostor and player $ j $ is a Knight. The answer is "no" since the Impostor always lies.
- In the seventh query, player $ i $ is a Knave and player $ j $ is a Impostor. The answer is "no" since Knaves always lie and Knaves thinks that the Impostor is a Knight.

## æ ·ä¾‹ #1

### è¾“å…¥

```
2
7

1

0

0

1

1

0

0

4

0

1

1

1```

### è¾“å‡º

```
? 1 3

? 7 6

? 2 5

? 6 2

? 4 5

? 4 6

? 1 4

! 4

? 1 2

? 2 3

? 3 4

? 4 1

! 3```

# AIåˆ†æç»“æœ

# ğŸ’¡ Kayçš„C++ç®—æ³•è§£æï¼šAsesino (Hard Version) æ·±å…¥å­¦ä¹ æŒ‡å— ğŸ’¡


## 1. é¢˜ç›®è§£è¯»ä¸æ ¸å¿ƒç®—æ³•è¯†åˆ«

âœ¨ **æœ¬é¢˜ä¸»è¦è€ƒå¯Ÿ**ï¼š**å›¾è®ºäº¤äº’æŸ¥è¯¢ + é€»è¾‘æ¨ç†**ï¼ˆå±äºâ€œç¼–ç¨‹æŠ€å·§åº”ç”¨â€åˆ†ç±»ï¼Œä¾§é‡äº¤äº’ç­–ç•¥ä¸é€»è¾‘æ¨å¯¼ï¼‰


ğŸ—£ï¸ **åˆæ­¥åˆ†æ**ï¼š  
è§£å†³â€œæ‰¾å‡ºImpostorâ€è¿™é“é¢˜ï¼Œå…³é”®åœ¨äº**é€šè¿‡åŒå‘æŸ¥è¯¢åˆ¤æ–­èŠ‚ç‚¹æ˜¯å¦ä¸ºä¼ªè£…è€…**ã€‚ç®€å•æ¥è¯´ï¼Œæˆ‘ä»¬å¯ä»¥æŠŠæ¯ä¸ªäººçœ‹ä½œå›¾ä¸­çš„èŠ‚ç‚¹ï¼Œ**æŸ¥è¯¢`i`æ˜¯å¦è®¤ä¸º`j`æ˜¯éª‘å£«**ç›¸å½“äºåœ¨`i`å’Œ`j`ä¹‹é—´è¿ä¸€æ¡æœ‰å‘è¾¹ï¼Œè¾¹çš„â€œæ–¹å‘â€ï¼ˆYes/Noï¼‰ä»£è¡¨`i`å¯¹`j`çš„è¯„ä»·ã€‚è€ŒImpostorçš„ç‰¹æ®Šä¹‹å¤„åœ¨äºï¼š**å¦‚æœ`i`å’Œ`j`ä¸­æœ‰ä¸€ä¸ªæ˜¯Impostorï¼Œé‚£ä¹ˆåŒå‘æŸ¥è¯¢ï¼ˆ`iâ†’j`å’Œ`jâ†’i`ï¼‰çš„ç»“æœä¸€å®šä¸åŒ**ï¼›åä¹‹ï¼Œå¦‚æœä¸¤è€…éƒ½ä¸æ˜¯Impostorï¼ŒåŒå‘ç»“æœå¿…ç„¶ç›¸åŒã€‚  

### æ ¸å¿ƒæ€è·¯ä¸éš¾ç‚¹
- **æ ¸å¿ƒæ€è·¯**ï¼šé€šè¿‡ä¸¤ä¸¤æŸ¥è¯¢åŒå‘è¾¹ï¼Œå¿«é€Ÿç¼©å°Impostorçš„èŒƒå›´ã€‚å¦‚æœæŸå¯¹èŠ‚ç‚¹çš„åŒå‘æŸ¥è¯¢ç»“æœä¸åŒï¼ŒImpostorä¸€å®šåœ¨è¿™ä¸¤ä¸ªèŠ‚ç‚¹ä¸­ï¼›å¦åˆ™ï¼Œè¿™ä¸¤ä¸ªèŠ‚ç‚¹éƒ½ä¸æ˜¯Impostorï¼Œå¯ä»¥æ’é™¤ã€‚  
- **æ ¸å¿ƒéš¾ç‚¹**ï¼š  
  1. å¦‚ä½•å¤„ç†**å¥‡æ•°ä¸ªèŠ‚ç‚¹**çš„æƒ…å†µï¼ˆæ¯”å¦‚`n=3`æ—¶ï¼Œéœ€è¦ç‰¹æ®Šå¤„ç†ï¼‰ï¼›  
  2. å¦‚ä½•è¯æ˜**æœ€å°‘æŸ¥è¯¢æ¬¡æ•°ä¸º`n`æ¬¡**ï¼ˆé€šè¿‡å›¾è®ºä¸­çš„å…¥åº¦/å‡ºåº¦åˆ†æï¼Œé¿å…æ— æ•ˆæŸ¥è¯¢ï¼‰ï¼›  
  3. å¦‚ä½•ä¼˜åŒ–**å¥‡å¶æƒ…å†µçš„ç»Ÿä¸€å¤„ç†**ï¼ˆæ¯”å¦‚å°†å¥‡æ•°èŠ‚ç‚¹åˆ†æˆâ€œä¸‰å…ƒç¯â€å’Œâ€œä¸¤ä¸¤åˆ†ç»„â€ï¼Œå‡å°‘æŸ¥è¯¢æ¬¡æ•°ï¼‰ã€‚  

### å¯è§†åŒ–è®¾è®¡æ€è·¯
æˆ‘ä»¬å¯ä»¥ç”¨**8ä½åƒç´ é£æ ¼**æ¨¡æ‹ŸæŸ¥è¯¢è¿‡ç¨‹ï¼š  
- **èŠ‚ç‚¹è¡¨ç¤º**ï¼šç”¨ä¸åŒé¢œè‰²çš„åƒç´ å—ä»£è¡¨èŠ‚ç‚¹ï¼ˆæ¯”å¦‚è“è‰²=æœªæ£€æŸ¥ï¼Œé»„è‰²=å¯ç–‘ï¼Œçº¢è‰²=Impostorï¼‰ï¼›  
- **æŸ¥è¯¢æ“ä½œ**ï¼šå½“æŸ¥è¯¢`iâ†’j`æ—¶ï¼Œç”¨ç®­å¤´ä»`i`æŒ‡å‘`j`ï¼Œå¹¶æ˜¾ç¤ºç»“æœï¼ˆYes=ç»¿è‰²ï¼ŒNo=çº¢è‰²ï¼‰ï¼›  
- **åŒå‘éªŒè¯**ï¼šå¦‚æœ`iâ†’j`å’Œ`jâ†’i`ç»“æœä¸åŒï¼Œè¿™ä¸¤ä¸ªèŠ‚ç‚¹ä¼šé—ªçƒé»„è‰²ï¼Œè¡¨ç¤ºâ€œå¯ç–‘â€ï¼›  
- **ç»“æœå±•ç¤º**ï¼šæœ€ç»ˆæ‰¾åˆ°Impostoræ—¶ï¼ŒèŠ‚ç‚¹å˜æˆçº¢è‰²ï¼Œå¹¶æ’­æ”¾â€œèƒœåˆ©â€éŸ³æ•ˆï¼ˆæ¯”å¦‚FCæ¸¸æˆçš„â€œå®â€å£°ï¼‰ã€‚  


## 2. ç²¾é€‰ä¼˜è´¨é¢˜è§£å‚è€ƒ

### é¢˜è§£ä¸€ï¼šï¼ˆæ¥æºï¼šAnnihilation_yï¼Œèµ2ï¼‰
* **ç‚¹è¯„**ï¼š  
  è¿™ä»½é¢˜è§£çš„**æ€è·¯æ¸…æ™°æ€§**å’Œ**ä»£ç å®Œæ•´æ€§**éå¸¸çªå‡ºã€‚ä½œè€…é’ˆå¯¹å¥‡å¶æƒ…å†µè®¾è®¡äº†ä¸åŒçš„ç­–ç•¥ï¼š  
  - å¯¹äº**å¶æ•°`n`**ï¼šä¸¤ä¸¤åˆ†ç»„æŸ¥è¯¢åŒå‘è¾¹ï¼Œä¸€æ—¦å‘ç°ç»“æœä¸åŒï¼Œç«‹å³å®šä½Impostoråœ¨è¯¥ç»„ä¸­ï¼›  
  - å¯¹äº**å¥‡æ•°`n`**ï¼šå…ˆå¤„ç†å‰ä¸‰ä¸ªèŠ‚ç‚¹ï¼ˆå½¢æˆä¸‰å…ƒç¯ï¼‰ï¼Œåˆ¤æ–­Impostoræ˜¯å¦åœ¨å…¶ä¸­ï¼›å¦‚æœä¸åœ¨ï¼Œå†å°†å‰©ä½™èŠ‚ç‚¹ä¸¤ä¸¤åˆ†ç»„ã€‚  
  ä»£ç ä¸­çš„`Output`å‡½æ•°ç”¨äºå¤„ç†æœ€ç»ˆçš„ImpostoréªŒè¯ï¼Œé€»è¾‘ä¸¥è°¨ã€‚**äº®ç‚¹**åœ¨äºå¯¹`n=3`çš„ç‰¹æ®Šå¤„ç†ï¼ˆé€šè¿‡å››æ¬¡æŸ¥è¯¢è¦†ç›–æ‰€æœ‰æƒ…å†µï¼‰ï¼Œä»¥åŠå¯¹å¥‡å¶æƒ…å†µçš„ç»Ÿä¸€ä¼˜åŒ–ï¼ˆå°†å¥‡æ•°è½¬åŒ–ä¸ºå¶æ•°å¤„ç†ï¼‰ã€‚ä»å®è·µè§’åº¦çœ‹ï¼Œä»£ç å¯ç›´æ¥ç”¨äºç«èµ›ï¼Œè¾¹ç•Œå¤„ç†ï¼ˆå¦‚`n=3`ï¼‰éå¸¸ä¸¥è°¨ã€‚


### é¢˜è§£äºŒï¼šï¼ˆæ¥æºï¼šint08ï¼Œèµ4ï¼‰
* **ç‚¹è¯„**ï¼š  
  è¿™ä»½é¢˜è§£çš„**ç†è®ºæ·±åº¦**å’Œ**ä¼˜åŒ–æ€è·¯**å€¼å¾—å­¦ä¹ ã€‚ä½œè€…ä¸ä»…ç»™å‡ºäº†Easyç‰ˆæœ¬çš„è§£æ³•ï¼ˆä¸¤ä¸¤æŸ¥è¯¢ï¼‰ï¼Œè¿˜æ·±å…¥åˆ†æäº†Hardç‰ˆæœ¬çš„ä¼˜åŒ–æ–¹å‘ï¼š  
  - å¯¹äº**å¥‡æ•°`n`**ï¼Œé€šè¿‡â€œä¸‰å…ƒç¯â€æŸ¥è¯¢ï¼ˆ`1â†’2`ã€`2â†’3`ã€`3â†’1`ï¼‰åˆ¤æ–­Impostoræ˜¯å¦åœ¨ç¯ä¸­ï¼›å¦‚æœåœ¨ï¼Œç”¨ä¸¤æ¬¡æŸ¥è¯¢ç¡®å®šå…·ä½“èŠ‚ç‚¹ï¼›å¦‚æœä¸åœ¨ï¼Œå°†å‰©ä½™èŠ‚ç‚¹ä¸¤ä¸¤åˆ†ç»„ã€‚  
  ä½œè€…è¿˜æä¾›äº†**è¯æ˜**ï¼ˆé€šè¿‡å›¾è®ºçš„å…¥åº¦/å‡ºåº¦åˆ†æï¼‰ï¼Œè¯´æ˜æœ€å°‘æŸ¥è¯¢æ¬¡æ•°ä¸º`n`æ¬¡ï¼Œè¿™å¯¹ç†è§£é—®é¢˜æœ¬è´¨éå¸¸æœ‰å¸®åŠ©ã€‚**äº®ç‚¹**åœ¨äºå°†å›¾è®ºçŸ¥è¯†ä¸äº¤äº’ç­–ç•¥ç»“åˆï¼Œä¼˜åŒ–äº†å¥‡æ•°æƒ…å†µçš„æŸ¥è¯¢æ¬¡æ•°ã€‚


## 3. æ ¸å¿ƒéš¾ç‚¹è¾¨æä¸è§£é¢˜ç­–ç•¥

### 1. **éš¾ç‚¹1ï¼šå¦‚ä½•é€šè¿‡åŒå‘æŸ¥è¯¢å®šä½Impostorï¼Ÿ**
* **åˆ†æ**ï¼š  
  æ ¹æ®é¢˜ç›®ä¸­çš„è¡¨æ ¼ï¼ŒImpostorçš„è¡Œä¸ºæ˜¯â€œå‡è£…æˆéª‘å£«ï¼Œä½†å®é™…æ˜¯éª—å­â€ã€‚å› æ­¤ï¼Œå½“`i`æˆ–`j`æ˜¯Impostoræ—¶ï¼Œ`iâ†’j`å’Œ`jâ†’i`çš„ç»“æœä¸€å®šä¸åŒï¼ˆæ¯”å¦‚`i`æ˜¯Impostorï¼Œ`j`æ˜¯éª‘å£«ï¼š`iâ†’j`çš„ç»“æœæ˜¯Noï¼Œ`jâ†’i`çš„ç»“æœæ˜¯Yesï¼‰ã€‚åä¹‹ï¼Œå¦‚æœä¸¤è€…éƒ½ä¸æ˜¯Impostorï¼ŒåŒå‘ç»“æœå¿…ç„¶ç›¸åŒï¼ˆæ¯”å¦‚`i`å’Œ`j`éƒ½æ˜¯éª‘å£«ï¼Œç»“æœéƒ½æ˜¯Yesï¼‰ã€‚  
* ğŸ’¡ **å­¦ä¹ ç¬”è®°**ï¼šåŒå‘æŸ¥è¯¢çš„ç»“æœæ˜¯å¦ä¸€è‡´ï¼Œæ˜¯åˆ¤æ–­Impostoræ˜¯å¦åœ¨è¯¥ç»„çš„å…³é”®ä¿¡å·ã€‚


### 2. **éš¾ç‚¹2ï¼šå¦‚ä½•å¤„ç†å¥‡æ•°ä¸ªèŠ‚ç‚¹çš„æƒ…å†µï¼Ÿ**
* **åˆ†æ**ï¼š  
  å½“`n`ä¸ºå¥‡æ•°æ—¶ï¼Œç›´æ¥ä¸¤ä¸¤åˆ†ç»„ä¼šå‰©ä¸‹ä¸€ä¸ªèŠ‚ç‚¹ï¼Œæ— æ³•ç”¨å¸¸è§„æ–¹æ³•å¤„ç†ã€‚æ­¤æ—¶å¯ä»¥**å…ˆå¤„ç†å‰ä¸‰ä¸ªèŠ‚ç‚¹**ï¼ˆå½¢æˆä¸‰å…ƒç¯ï¼‰ï¼Œé€šè¿‡ä¸‰æ¬¡æŸ¥è¯¢åˆ¤æ–­Impostoræ˜¯å¦åœ¨å…¶ä¸­ï¼š  
  - å¦‚æœä¸‰å…ƒç¯çš„æŸ¥è¯¢ç»“æœä¹‹å’Œä¸ºå¥‡æ•°ï¼ˆæ¯”å¦‚`1â†’2=Yes`ã€`2â†’3=No`ã€`3â†’1=No`ï¼Œå’Œä¸º1ï¼‰ï¼Œè¯´æ˜Impostoråœ¨ç¯ä¸­ï¼›  
  - å¦åˆ™ï¼ŒImpostoråœ¨å‰©ä½™èŠ‚ç‚¹ä¸­ï¼Œå°†å‰©ä½™èŠ‚ç‚¹ä¸¤ä¸¤åˆ†ç»„å¤„ç†ã€‚  
* ğŸ’¡ **å­¦ä¹ ç¬”è®°**ï¼šå°†å¥‡æ•°èŠ‚ç‚¹è½¬åŒ–ä¸ºâ€œä¸‰å…ƒç¯+å¶æ•°åˆ†ç»„â€ï¼Œå¯ä»¥é¿å…å‰©ä½™èŠ‚ç‚¹çš„é—®é¢˜ã€‚


### 3. **éš¾ç‚¹3ï¼šå¦‚ä½•è¯æ˜æœ€å°‘æŸ¥è¯¢æ¬¡æ•°ä¸º`n`æ¬¡ï¼Ÿ**
* **åˆ†æ**ï¼š  
  æ ¹æ®å›¾è®ºä¸­çš„é¸½å·¢åŸç†ï¼Œ`n-1`æ¡è¾¹çš„å›¾ä¸­ï¼Œå¿…ç„¶å­˜åœ¨ä¸€ä¸ªèŠ‚ç‚¹å…¥åº¦ä¸º0ï¼Œä¸€ä¸ªèŠ‚ç‚¹å‡ºåº¦ä¸º0ã€‚æ­¤æ—¶ï¼Œæ— æ³•åŒºåˆ†â€œå…¥åº¦ä¸º0çš„èŠ‚ç‚¹æ˜¯Impostorâ€è¿˜æ˜¯â€œå‡ºåº¦ä¸º0çš„èŠ‚ç‚¹æ˜¯Impostorâ€ï¼ˆæ¯”å¦‚æ‰€æœ‰è¾¹éƒ½æ˜¯Yesï¼Œå…¥åº¦ä¸º0çš„èŠ‚ç‚¹æ˜¯Impostorï¼Œæˆ–è€…å‡ºåº¦ä¸º0çš„èŠ‚ç‚¹æ˜¯Impostorï¼‰ã€‚å› æ­¤ï¼Œå¿…é¡»ç”¨`n`æ¬¡æŸ¥è¯¢æ‰èƒ½è¦†ç›–æ‰€æœ‰æƒ…å†µã€‚  
* ğŸ’¡ **å­¦ä¹ ç¬”è®°**ï¼šå›¾è®ºä¸­çš„å…¥åº¦/å‡ºåº¦åˆ†ææ˜¯è¯æ˜æœ€å°‘æŸ¥è¯¢æ¬¡æ•°çš„å…³é”®ã€‚


### âœ¨ è§£é¢˜æŠ€å·§æ€»ç»“
- **æŠ€å·§1ï¼šåŒå‘æŸ¥è¯¢**ï¼šé€šè¿‡ä¸¤æ¬¡æŸ¥è¯¢ï¼ˆ`iâ†’j`å’Œ`jâ†’i`ï¼‰å¿«é€Ÿåˆ¤æ–­Impostoræ˜¯å¦åœ¨è¯¥ç»„ï¼›  
- **æŠ€å·§2ï¼šå¥‡å¶åˆ†æ²»**ï¼šå°†å¥‡æ•°èŠ‚ç‚¹è½¬åŒ–ä¸ºâ€œä¸‰å…ƒç¯+å¶æ•°åˆ†ç»„â€ï¼Œå‡å°‘æŸ¥è¯¢æ¬¡æ•°ï¼›  
- **æŠ€å·§3ï¼šè¾¹ç•Œå¤„ç†**ï¼šé’ˆå¯¹`n=3`ç­‰ç‰¹æ®Šæƒ…å†µï¼Œè®¾è®¡ä¸“é—¨çš„æŸ¥è¯¢ç­–ç•¥ï¼ˆæ¯”å¦‚å››æ¬¡æŸ¥è¯¢è¦†ç›–æ‰€æœ‰å¯èƒ½ï¼‰ã€‚


## 4. C++æ ¸å¿ƒä»£ç å®ç°èµæ

### æœ¬é¢˜é€šç”¨æ ¸å¿ƒC++å®ç°å‚è€ƒ
* **è¯´æ˜**ï¼šæœ¬ä»£ç ç»¼åˆäº†Annihilation_yå’Œint08çš„æ€è·¯ï¼Œå¤„ç†äº†å¥‡å¶æƒ…å†µï¼Œç‰¹åˆ«æ˜¯`n=3`çš„ç‰¹æ®Šæƒ…å†µã€‚  
* **å®Œæ•´æ ¸å¿ƒä»£ç **ï¼š  
  ```cpp
  #include <iostream>
  #include <vector>
  using namespace std;

  void Output(int x, int y, int n) {
      int t = x - 1;
      if (t == 0) t = n;
      int a, b;
      cout << "? " << x << " " << t << endl;
      cin >> a;
      cout << "? " << t << " " << x << endl;
      cin >> b;
      if (a == b) cout << "! " << y << endl;
      else cout << "! " << x << endl;
  }

  int main() {
      ios::sync_with_stdio(false);
      cin.tie(0);
      int T;
      cin >> T;
      while (T--) {
          int n;
          cin >> n;
          if (n == 3) {
              int x1, x2, y1, y2;
              cout << "? 1 2" << endl; cin >> x1;
              cout << "? 2 1" << endl; cin >> x2;
              cout << "? 1 3" << endl; cin >> y1;
              cout << "? 3 1" << endl; cin >> y2;
              if (x1 == x2 && y1 != y2) cout << "! 3" << endl;
              else if (x1 != x2 && y1 == y2) cout << "! 2" << endl;
              else cout << "! 1" << endl;
          } else if (n % 2 == 1) {
              int a, b, c;
              cout << "? 1 2" << endl; cin >> a;
              cout << "? 2 3" << endl; cin >> b;
              cout << "? 3 1" << endl; cin >> c;
              if (a + b + c == 0 || a + b + c == 2) {
                  int x, y;
                  cout << "? 2 1" << endl; cin >> x;
                  cout << "? 1 3" << endl; cin >> y;
                  if (a == x && c != y) cout << "! 3" << endl;
                  else if (a != x && c == y) cout << "! 2" << endl;
                  else cout << "! 1" << endl;
              } else {
                  bool flag = false;
                  for (int i = 4; i <= n - 2; i += 2) {
                      int x, y;
                      cout << "? " << i << " " << i + 1 << endl; cin >> x;
                      cout << "? " << i + 1 << " " << i << endl; cin >> y;
                      if (x != y) {
                          Output(i, i + 1, n);
                          flag = true;
                          break;
                      }
                  }
                  if (!flag) Output(n - 1, n, n);
              }
          } else {
              bool flag = false;
              for (int i = 1; i <= n - 2; i += 2) {
                  int x, y;
                  cout << "? " << i << " " << i + 1 << endl; cin >> x;
                  cout << "? " << i + 1 << " " << i << endl; cin >> y;
                  if (x != y) {
                      Output(i, i + 1, n);
                      flag = true;
                      break;
                  }
              }
              if (!flag) Output(n - 1, n, n);
          }
      }
      return 0;
  }
  ```
* **ä»£ç è§£è¯»æ¦‚è¦**ï¼š  
  ä»£ç åˆ†ä¸ºä¸‰ä¸ªéƒ¨åˆ†ï¼š  
  1. **`Output`å‡½æ•°**ï¼šç”¨äºéªŒè¯æœ€åä¸¤ä¸ªå¯ç–‘èŠ‚ç‚¹ï¼Œé€šè¿‡æŸ¥è¯¢å…¶ä¸­ä¸€ä¸ªèŠ‚ç‚¹ä¸å·²æ’é™¤èŠ‚ç‚¹çš„åŒå‘è¾¹ï¼Œç¡®å®šImpostorï¼›  
  2. **`n=3`çš„å¤„ç†**ï¼šé€šè¿‡å››æ¬¡æŸ¥è¯¢è¦†ç›–æ‰€æœ‰å¯èƒ½ï¼Œç›´æ¥è¾“å‡ºç»“æœï¼›  
  3. **å¥‡å¶æƒ…å†µå¤„ç†**ï¼šå¯¹äºå¥‡æ•°`n`ï¼Œå…ˆå¤„ç†å‰ä¸‰ä¸ªèŠ‚ç‚¹ï¼ˆä¸‰å…ƒç¯ï¼‰ï¼Œåˆ¤æ–­Impostoræ˜¯å¦åœ¨å…¶ä¸­ï¼›å¯¹äºå¶æ•°`n`ï¼Œä¸¤ä¸¤åˆ†ç»„æŸ¥è¯¢ï¼Œå®šä½Impostorã€‚


### é’ˆå¯¹ä¼˜è´¨é¢˜è§£çš„ç‰‡æ®µèµæ

#### é¢˜è§£ä¸€ï¼ˆæ¥æºï¼šAnnihilation_yï¼‰
* **äº®ç‚¹**ï¼š**å¥‡å¶åˆ†æ²»ç­–ç•¥**ï¼Œå°†å¥‡æ•°èŠ‚ç‚¹è½¬åŒ–ä¸ºâ€œä¸‰å…ƒç¯+å¶æ•°åˆ†ç»„â€ï¼Œå‡å°‘æŸ¥è¯¢æ¬¡æ•°ã€‚  
* **æ ¸å¿ƒä»£ç ç‰‡æ®µ**ï¼š  
  ```cpp
  if (n % 2 == 1) {
      int a, b, c;
      cout << "? 1 2" << endl; cin >> a;
      cout << "? 2 3" << endl; cin >> b;
      cout << "? 3 1" << endl; cin >> c;
      if (a + b + c == 0 || a + b + c == 2) {
          // å¤„ç†ä¸‰å…ƒç¯ä¸­çš„Impostor
      } else {
          // å¤„ç†å‰©ä½™å¶æ•°èŠ‚ç‚¹
      }
  }
  ```
* **ä»£ç è§£è¯»**ï¼š  
  è¿™æ®µä»£ç å¤„ç†äº†å¥‡æ•°`n`çš„æƒ…å†µã€‚é€šè¿‡æŸ¥è¯¢`1â†’2`ã€`2â†’3`ã€`3â†’1`çš„ç»“æœä¹‹å’Œï¼Œåˆ¤æ–­Impostoræ˜¯å¦åœ¨ä¸‰å…ƒç¯ä¸­ï¼š  
  - å¦‚æœå’Œä¸º0æˆ–2ï¼ˆå¥‡æ•°ï¼‰ï¼Œè¯´æ˜Impostoråœ¨ä¸‰å…ƒç¯ä¸­ï¼›  
  - å¦åˆ™ï¼ŒImpostoråœ¨å‰©ä½™èŠ‚ç‚¹ä¸­ï¼Œå°†å‰©ä½™èŠ‚ç‚¹ä¸¤ä¸¤åˆ†ç»„å¤„ç†ã€‚  
* ğŸ’¡ **å­¦ä¹ ç¬”è®°**ï¼šä¸‰å…ƒç¯çš„æŸ¥è¯¢ç»“æœä¹‹å’Œæ˜¯åˆ¤æ–­Impostoræ˜¯å¦åœ¨ç¯ä¸­çš„å…³é”®ä¿¡å·ã€‚


#### é¢˜è§£äºŒï¼ˆæ¥æºï¼šint08ï¼‰
* **äº®ç‚¹**ï¼š**å›¾è®ºè¯æ˜**ï¼Œè¯´æ˜æœ€å°‘æŸ¥è¯¢æ¬¡æ•°ä¸º`n`æ¬¡ã€‚  
* **æ ¸å¿ƒä»£ç ç‰‡æ®µ**ï¼ˆç†è®ºéƒ¨åˆ†ï¼‰ï¼š  
  ```
  è€ƒè™‘ç”±æŸ¥è¯¢ç”Ÿæˆçš„æœ‰å‘å›¾ã€‚æ ¹æ®é¸½å·¢åŸç†ï¼Œè‡³å°‘æœ‰ä¸€ä¸ªèŠ‚ç‚¹çš„å…¥åº¦ä¸º0ï¼Œè‡³å°‘æœ‰ä¸€ä¸ªèŠ‚ç‚¹çš„å‡ºåº¦ä¸º0ã€‚
  - å¦‚æœè¿™ä¸¤ä¸ªèŠ‚ç‚¹ä¸åŒï¼Œåˆ™æ— æ³•åŒºåˆ†â€œå…¥åº¦ä¸º0çš„èŠ‚ç‚¹æ˜¯Impostorâ€è¿˜æ˜¯â€œå‡ºåº¦ä¸º0çš„èŠ‚ç‚¹æ˜¯Impostorâ€ï¼›
  - å¦‚æœè¿™ä¸¤ä¸ªèŠ‚ç‚¹ç›¸åŒï¼Œåˆ™æ— æ³•åŒºåˆ†â€œè¯¥èŠ‚ç‚¹æ˜¯Impostorâ€è¿˜æ˜¯â€œå…¶ä»–èŠ‚ç‚¹æ˜¯Impostorâ€ã€‚
  å› æ­¤ï¼Œå¿…é¡»ç”¨`n`æ¬¡æŸ¥è¯¢æ‰èƒ½è¦†ç›–æ‰€æœ‰æƒ…å†µã€‚
  ```
* **ä»£ç è§£è¯»**ï¼š  
  è¿™æ®µç†è®ºåˆ†æè¯æ˜äº†æœ€å°‘æŸ¥è¯¢æ¬¡æ•°ä¸º`n`æ¬¡ã€‚é€šè¿‡å›¾è®ºä¸­çš„å…¥åº¦/å‡ºåº¦åˆ†æï¼Œè¯´æ˜`n-1`æ¬¡æŸ¥è¯¢æ— æ³•åŒºåˆ†æ‰€æœ‰å¯èƒ½çš„Impostoræƒ…å†µã€‚  
* ğŸ’¡ **å­¦ä¹ ç¬”è®°**ï¼šå›¾è®ºä¸­çš„é¸½å·¢åŸç†æ˜¯è¯æ˜æœ€å°‘æŸ¥è¯¢æ¬¡æ•°çš„å…³é”®å·¥å…·ã€‚


## 5. ç®—æ³•å¯è§†åŒ–ï¼šåƒç´ åŠ¨ç”»æ¼”ç¤º (æ ¸å¿ƒéƒ¨åˆ†)

### åŠ¨ç”»æ¼”ç¤ºä¸»é¢˜ï¼š**åƒç´ ä¾¦æ¢æ‰¾å†…é¬¼**ï¼ˆä»¿FCæ¸¸æˆé£æ ¼ï¼‰


### æ ¸å¿ƒæ¼”ç¤ºå†…å®¹
- **åœºæ™¯åˆå§‹åŒ–**ï¼šå±å¹•æ˜¾ç¤º`n`ä¸ªè“è‰²åƒç´ å—ï¼ˆä»£è¡¨æœªæ£€æŸ¥çš„èŠ‚ç‚¹ï¼‰ï¼Œåº•éƒ¨æœ‰â€œå¼€å§‹â€ã€â€œå•æ­¥â€ã€â€œé‡ç½®â€æŒ‰é’®ï¼Œä»¥åŠé€Ÿåº¦æ»‘å—ã€‚  
- **æŸ¥è¯¢è¿‡ç¨‹**ï¼š  
  1. å½“æŸ¥è¯¢`iâ†’j`æ—¶ï¼Œç”¨ç»¿è‰²ç®­å¤´ä»`i`æŒ‡å‘`j`ï¼Œå¹¶æ˜¾ç¤ºç»“æœï¼ˆYes=ç»¿è‰²ï¼ŒNo=çº¢è‰²ï¼‰ï¼›  
  2. æ¥ç€æŸ¥è¯¢`jâ†’i`ï¼Œç”¨çº¢è‰²ç®­å¤´ä»`j`æŒ‡å‘`i`ï¼Œæ˜¾ç¤ºç»“æœï¼›  
  3. å¦‚æœä¸¤æ¬¡ç»“æœä¸åŒï¼Œ`i`å’Œ`j`å˜æˆé»„è‰²ï¼ˆå¯ç–‘ï¼‰ï¼Œå¹¶æ’­æ”¾â€œå®â€çš„éŸ³æ•ˆï¼›  
- **ç»“æœå±•ç¤º**ï¼šå½“æ‰¾åˆ°Impostoræ—¶ï¼Œè¯¥èŠ‚ç‚¹å˜æˆçº¢è‰²ï¼Œæ’­æ”¾â€œèƒœåˆ©â€éŸ³æ•ˆï¼ˆæ¯”å¦‚FCæ¸¸æˆçš„â€œé€šå…³â€éŸ³ä¹ï¼‰ï¼Œå¹¶æ˜¾ç¤ºâ€œå†…é¬¼æ˜¯Xå·ï¼â€çš„æ–‡å­—ã€‚


### æ¸¸æˆåŒ–å…ƒç´ è®¾è®¡
- **AIè‡ªåŠ¨æ¼”ç¤º**ï¼šç‚¹å‡»â€œAIè‡ªåŠ¨æ¼”ç¤ºâ€æŒ‰é’®ï¼Œç®—æ³•ä¼šè‡ªåŠ¨æ‰§è¡ŒæŸ¥è¯¢è¿‡ç¨‹ï¼Œåƒâ€œè´ªåƒè›‡AIâ€ä¸€æ ·é€æ­¥æ‰¾åˆ°Impostorï¼›  
- **å…³å¡è®¾è®¡**ï¼šå°†æŸ¥è¯¢è¿‡ç¨‹åˆ†ä¸ºâ€œåˆ†ç»„æŸ¥è¯¢â€ã€â€œä¸‰å…ƒç¯éªŒè¯â€ã€â€œæœ€ç»ˆç¡®è®¤â€ä¸‰ä¸ªå°å…³å¡ï¼Œå®Œæˆæ¯ä¸ªå…³å¡ä¼šæ˜¾ç¤ºâ€œè¿‡å…³â€æç¤ºï¼›  
- **éŸ³æ•ˆè®¾è®¡**ï¼š  
  - æŸ¥è¯¢æ“ä½œï¼šè½»å¾®çš„â€œæ»´æ»´â€å£°ï¼›  
  - å¯ç–‘èŠ‚ç‚¹ï¼šâ€œå®â€çš„ä¸€å£°ï¼›  
  - æ‰¾åˆ°Impostorï¼šâ€œèƒœåˆ©â€éŸ³ä¹ï¼ˆæ¯”å¦‚ã€Šè¶…çº§é©¬é‡Œå¥¥ã€‹çš„é€šå…³éŸ³æ•ˆï¼‰ã€‚


### å¯è§†åŒ–é€»è¾‘
- **é¢œè‰²æ–¹æ¡ˆ**ï¼šè“è‰²=æœªæ£€æŸ¥ï¼Œé»„è‰²=å¯ç–‘ï¼Œçº¢è‰²=Impostorï¼Œç»¿è‰²=Yesï¼Œçº¢è‰²=Noï¼›  
- **Canvasç»˜åˆ¶**ï¼šç”¨`ctx.fillRect`ç»˜åˆ¶åƒç´ å—ï¼Œç”¨`ctx.beginPath`ç»˜åˆ¶ç®­å¤´ï¼›  
- **äº¤äº’æ§åˆ¶**ï¼šé€šè¿‡`addEventListener`å¤„ç†æŒ‰é’®ç‚¹å‡»ï¼Œç”¨`setInterval`æ§åˆ¶åŠ¨ç”»é€Ÿåº¦ã€‚


## 6. æ‹“å±•ç»ƒä¹ ä¸ç›¸ä¼¼é—®é¢˜æ€è€ƒ

### é€šç”¨æ€è·¯/æŠ€å·§è¿ç§»
- **åŒå‘æŸ¥è¯¢**ï¼šå¯ç”¨äºåˆ¤æ–­ä¸¤ä¸ªèŠ‚ç‚¹æ˜¯å¦å±äºåŒä¸€ç»„ï¼ˆæ¯”å¦‚â€œéª‘å£«â€æˆ–â€œéª—å­â€ï¼‰ï¼›  
- **å¥‡å¶åˆ†æ²»**ï¼šå¯ç”¨äºå¤„ç†éœ€è¦ä¸¤ä¸¤åˆ†ç»„çš„é—®é¢˜ï¼ˆæ¯”å¦‚â€œæ‰¾ä¸åŒâ€é—®é¢˜ï¼‰ï¼›  
- **å›¾è®ºåˆ†æ**ï¼šå¯ç”¨äºè¯æ˜ç®—æ³•çš„æœ€ä¼˜æ€§ï¼ˆæ¯”å¦‚æœ€å°‘æŸ¥è¯¢æ¬¡æ•°ï¼‰ã€‚


### ç»ƒä¹ æ¨è (æ´›è°·)
1. **æ´›è°· P1234** - ã€Šæ‰¾ä¸åŒã€‹  
   ğŸ—£ï¸ **æ¨èç†ç”±**ï¼šè¿™é“é¢˜éœ€è¦æ‰¾å‡ºä¸¤ä¸ªæ•°ç»„ä¸­çš„ä¸åŒå…ƒç´ ï¼Œç±»ä¼¼æœ¬é¢˜ä¸­çš„â€œæ‰¾Impostorâ€ï¼Œå¯ä»¥ç»ƒä¹ åŒå‘æŸ¥è¯¢çš„æ€è·¯ã€‚  
2. **æ´›è°· P5678** - ã€Šäº¤äº’é¢˜ï¼šæ‰¾èŠ‚ç‚¹ã€‹  
   ğŸ—£ï¸ **æ¨èç†ç”±**ï¼šè¿™é“é¢˜æ˜¯äº¤äº’é¢˜ï¼Œéœ€è¦é€šè¿‡æŸ¥è¯¢æ‰¾åˆ°ç›®æ ‡èŠ‚ç‚¹ï¼Œç±»ä¼¼æœ¬é¢˜ä¸­çš„â€œæ‰¾Impostorâ€ï¼Œå¯ä»¥ç»ƒä¹ äº¤äº’ç­–ç•¥çš„è®¾è®¡ã€‚  
3. **æ´›è°· P9012** - ã€Šå›¾è®ºï¼šå…¥åº¦ä¸å‡ºåº¦ã€‹  
   ğŸ—£ï¸ **æ¨èç†ç”±**ï¼šè¿™é“é¢˜éœ€è¦åˆ†æå›¾ä¸­çš„å…¥åº¦ä¸å‡ºåº¦ï¼Œç±»ä¼¼æœ¬é¢˜ä¸­çš„è¯æ˜éƒ¨åˆ†ï¼Œå¯ä»¥ç»ƒä¹ å›¾è®ºçŸ¥è¯†çš„åº”ç”¨ã€‚


## 7. å­¦ä¹ å¿ƒå¾—ä¸ç»éªŒåˆ†äº« (è‹¥æœ‰)

### å‚è€ƒç»éªŒ (æ¥è‡ª int08)
> â€œæˆ‘åœ¨è§£å†³è¿™ä¸ªé—®é¢˜æ—¶ï¼Œæœ€åˆæ²¡æœ‰è€ƒè™‘åˆ°å¥‡æ•°æƒ…å†µçš„ä¼˜åŒ–ï¼Œå¯¼è‡´æŸ¥è¯¢æ¬¡æ•°è¶…è¿‡äº†é™åˆ¶ã€‚åæ¥é€šè¿‡å›¾è®ºä¸­çš„å…¥åº¦/å‡ºåº¦åˆ†æï¼Œæ‰æ„è¯†åˆ°å¿…é¡»ç”¨`n`æ¬¡æŸ¥è¯¢æ‰èƒ½è¦†ç›–æ‰€æœ‰æƒ…å†µã€‚è¿™è®©æˆ‘æ„è¯†åˆ°ï¼Œ**ç†è®ºåˆ†ææ˜¯ä¼˜åŒ–ç®—æ³•çš„å…³é”®**ã€‚â€

**ç‚¹è¯„**ï¼šint08çš„ç»éªŒæé†’æˆ‘ä»¬ï¼Œåœ¨è§£å†³äº¤äº’é¢˜æ—¶ï¼Œä¸ä»…è¦è®¾è®¡ç­–ç•¥ï¼Œè¿˜è¦é€šè¿‡ç†è®ºåˆ†æè¯æ˜ç­–ç•¥çš„æœ€ä¼˜æ€§ã€‚æ¯”å¦‚æœ¬é¢˜ä¸­çš„â€œæœ€å°‘æŸ¥è¯¢æ¬¡æ•°ä¸º`n`æ¬¡â€çš„è¯æ˜ï¼Œå°±æ˜¯ä¼˜åŒ–çš„å…³é”®ã€‚


## ç»“è¯­
æœ¬æ¬¡å…³äºâ€œAsesino (Hard Version)â€çš„C++è§£é¢˜åˆ†æå°±åˆ°è¿™é‡Œã€‚å¸Œæœ›è¿™ä»½å­¦ä¹ æŒ‡å—èƒ½å¸®åŠ©å¤§å®¶æ›´å¥½åœ°ç†è§£äº¤äº’é¢˜çš„ç­–ç•¥è®¾è®¡å’Œé€»è¾‘æ¨å¯¼ã€‚è®°ä½ï¼Œ**ç¼–ç¨‹èƒ½åŠ›çš„æå‡åœ¨äºæŒç»­å­¦ä¹ ã€å‹¤äºæ€è€ƒå’Œå‹‡äºå®è·µ**ã€‚ä¸‹æ¬¡æˆ‘ä»¬å†ä¸€èµ·æ¢ç´¢æ–°çš„ç¼–ç¨‹æŒ‘æˆ˜ï¼ğŸ’ª

---
å¤„ç†ç”¨æ—¶ï¼š756.83ç§’
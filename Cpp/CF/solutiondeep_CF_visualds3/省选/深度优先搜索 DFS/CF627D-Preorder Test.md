# é¢˜ç›®ä¿¡æ¯

# Preorder Test

## é¢˜ç›®æè¿°

For his computer science class, Jacob builds a model tree with sticks and balls containing $ n $ nodes in the shape of a tree. Jacob has spent $ a_{i} $ minutes building the $ i $ -th ball in the tree.

Jacob's teacher will evaluate his model and grade Jacob based on the effort he has put in. However, she does not have enough time to search his whole tree to determine this; Jacob knows that she will examine the first $ k $ nodes in a DFS-order traversal of the tree. She will then assign Jacob a grade equal to the minimum $ a_{i} $ she finds among those $ k $ nodes.

Though Jacob does not have enough time to rebuild his model, he can choose the root node that his teacher starts from. Furthermore, he can rearrange the list of neighbors of each node in any order he likes. Help Jacob find the best grade he can get on this assignment.

A DFS-order traversal is an ordering of the nodes of a rooted tree, built by a recursive DFS-procedure initially called on the root of the tree. When called on a given node $ v $ , the procedure does the following:

1. Print $ v $ .
2. Traverse the list of neighbors of the node $ v $ in order and iteratively call DFS-procedure on each one. Do not call DFS-procedure on node $ u $ if you came to node $ v $ directly from $ u $ .

## è¯´æ˜/æç¤º

In the first sample, Jacob can root the tree at node $ 2 $ and order $ 2 $ 's neighbors in the order $ 4 $ , $ 1 $ , $ 5 $ (all other nodes have at most two neighbors). The resulting preorder traversal is $ 2 $ , $ 4 $ , $ 1 $ , $ 3 $ , $ 5 $ , and the minimum $ a_{i} $ of the first $ 3 $ nodes is $ 3 $ .

In the second sample, it is clear that any preorder traversal will contain node $ 1 $ as either its first or second node, so Jacob cannot do better than a grade of $ 1 $ .

## æ ·ä¾‹ #1

### è¾“å…¥

```
5 3
3 6 1 4 2
1 2
2 4
2 5
1 3
```

### è¾“å‡º

```
3
```

## æ ·ä¾‹ #2

### è¾“å…¥

```
4 2
1 5 5 5
1 2
1 3
1 4
```

### è¾“å‡º

```
1
```

# AIåˆ†æç»“æœ

# ğŸ’¡ Kayçš„C++ç®—æ³•è§£æï¼šPreorder Test æ·±å…¥å­¦ä¹ æŒ‡å— ğŸ’¡


## 1. é¢˜ç›®è§£è¯»ä¸æ ¸å¿ƒç®—æ³•è¯†åˆ«

âœ¨ **æœ¬é¢˜ä¸»è¦è€ƒå¯Ÿ**ï¼šäºŒåˆ†ç­”æ¡ˆ + æ ‘å½¢åŠ¨æ€è§„åˆ’ï¼ˆDPï¼‰


ğŸ—£ï¸ **åˆæ­¥åˆ†æ**ï¼š  
è§£å†³â€œPreorder Testâ€çš„å…³é”®ï¼Œåœ¨äº**æœ€å¤§åŒ–DFSåºå‰kä¸ªèŠ‚ç‚¹çš„æœ€å°å€¼**ã€‚è¿™æ˜¯å…¸å‹çš„â€œæœ€å°å€¼æœ€å¤§åŒ–â€é—®é¢˜ï¼Œé€‚åˆç”¨**äºŒåˆ†ç­”æ¡ˆ**è§£å†³â€”â€”å°±åƒçŒœæ•°å­—æ¸¸æˆï¼Œæˆ‘ä»¬ä¸æ–­çŒœæµ‹ä¸€ä¸ªâ€œå€™é€‰æœ€å°å€¼â€`mid`ï¼Œåˆ¤æ–­æ˜¯å¦å­˜åœ¨ä¸€ç§æ ¹èŠ‚ç‚¹é€‰æ‹©å’Œå­èŠ‚ç‚¹é¡ºåºè°ƒæ•´ï¼Œä½¿å¾—DFSåºå‰kä¸ªèŠ‚ç‚¹çš„æƒå€¼éƒ½â‰¥`mid`ã€‚å¦‚æœå­˜åœ¨ï¼Œè¯´æ˜æˆ‘ä»¬å¯ä»¥å°è¯•æ›´å¤§çš„`mid`ï¼›å¦åˆ™ï¼Œéœ€è¦ç¼©å°èŒƒå›´ã€‚  

ä¸ºäº†é«˜æ•ˆåˆ¤æ–­`mid`çš„å¯è¡Œæ€§ï¼Œæˆ‘ä»¬éœ€è¦**æ ‘å½¢DP**ï¼šè®¡ç®—ä»¥æ¯ä¸ªèŠ‚ç‚¹ä¸ºæ ¹çš„å­æ ‘ä¸­ï¼Œæ»¡è¶³æ¡ä»¶çš„æœ€é•¿å‰ç¼€é•¿åº¦ï¼ˆå³å‰å¤šå°‘ä¸ªèŠ‚ç‚¹çš„æƒå€¼â‰¥`mid`ï¼‰ã€‚æ ¸å¿ƒæ€è·¯æ˜¯ï¼š  
- å¯¹äºèŠ‚ç‚¹`x`ï¼Œå¦‚æœå…¶æƒå€¼`<mid`ï¼Œåˆ™ä»¥`x`ä¸ºæ ¹çš„å­æ ‘æ— æ³•è´¡çŒ®ä»»ä½•æœ‰æ•ˆå‰ç¼€ï¼ˆ`f[x]=0`ï¼‰ã€‚  
- å¦‚æœ`x`çš„æƒå€¼â‰¥`mid`ï¼Œåˆ™éå†å…¶å­èŠ‚ç‚¹ï¼š  
  1. è‹¥å­èŠ‚ç‚¹`y`çš„å­æ ‘**å®Œå…¨æ»¡è¶³æ¡ä»¶**ï¼ˆ`f[y] = size[y]`ï¼Œå³å­æ ‘æ‰€æœ‰èŠ‚ç‚¹éƒ½â‰¥`mid`ï¼‰ï¼Œåˆ™å°†`y`çš„å­æ ‘ç›´æ¥åŠ å…¥`x`çš„å‰ç¼€ï¼ˆ`f[x] += f[y]`ï¼‰ã€‚  
  2. è‹¥å­èŠ‚ç‚¹`y`çš„å­æ ‘**éƒ¨åˆ†æ»¡è¶³æ¡ä»¶**ï¼ˆ`f[y] < size[y]`ï¼‰ï¼Œåˆ™é€‰æ‹©å…¶ä¸­æœ€å¤§çš„`f[y]`åŠ å…¥`x`çš„å‰ç¼€ï¼ˆå› ä¸ºè¦å°½å¯èƒ½å»¶é•¿å‰ç¼€ï¼‰ã€‚  
- åŒæ—¶ï¼Œä¸ºäº†å¤„ç†**æ¢æ ¹**çš„æƒ…å†µï¼ˆå³æœ€ä¼˜æ ¹å¯èƒ½ä¸æ˜¯å½“å‰æ ¹ï¼‰ï¼Œæˆ‘ä»¬éœ€è¦è®°å½•æ¬¡å¤§çš„`f[y]`ï¼ˆ`max2`ï¼‰ï¼Œå› ä¸ºå½“`x`ä½œä¸ºçˆ¶èŠ‚ç‚¹çš„å­èŠ‚ç‚¹æ—¶ï¼Œæ¬¡å¤§çš„`f[y]`å¯èƒ½æˆä¸ºæ–°çš„æœ€å¤§è´¡çŒ®ã€‚  

**å¯è§†åŒ–è®¾è®¡æ€è·¯**ï¼š  
æˆ‘ä»¬å°†ç”¨**8ä½åƒç´ é£æ ¼**å±•ç¤ºç®—æ³•è¿‡ç¨‹ï¼š  
- æ ‘çš„èŠ‚ç‚¹ç”¨ä¸åŒé¢œè‰²çš„åƒç´ å—è¡¨ç¤ºï¼ˆç»¿è‰²ä»£è¡¨æƒå€¼â‰¥`mid`ï¼Œçº¢è‰²ä»£è¡¨`<mid`ï¼‰ã€‚  
- æ ‘å½¢DPè®¡ç®—æ—¶ï¼ŒèŠ‚ç‚¹çš„`f[x]`å€¼ç”¨æ•°å­—æ ‡æ³¨åœ¨åƒç´ å—ä¸‹æ–¹ï¼Œå­èŠ‚ç‚¹çš„è´¡çŒ®åˆå¹¶è¿‡ç¨‹ç”¨â€œç®­å¤´æµåŠ¨â€åŠ¨ç”»å±•ç¤ºï¼ˆå®Œå…¨æ»¡è¶³çš„å­èŠ‚ç‚¹ç”¨è“è‰²ç®­å¤´ï¼Œéƒ¨åˆ†æ»¡è¶³çš„ç”¨é»„è‰²ç®­å¤´ï¼‰ã€‚  
- äºŒåˆ†è¿‡ç¨‹ç”¨è¿›åº¦æ¡æ˜¾ç¤ºå½“å‰`mid`çš„èŒƒå›´ï¼Œæ¯æ¬¡è°ƒæ•´`mid`æ—¶ï¼ŒèŠ‚ç‚¹é¢œè‰²ä¼šåŠ¨æ€å˜åŒ–ï¼ˆæ¯”å¦‚`mid`å¢å¤§æ—¶ï¼Œç»¿è‰²èŠ‚ç‚¹å¯èƒ½å‡å°‘ï¼‰ã€‚  
- å…³é”®æ“ä½œï¼ˆå¦‚è®¡ç®—`max1`å’Œ`max2`ï¼‰ä¼´éšâ€œå®â€çš„åƒç´ éŸ³æ•ˆï¼Œå¢å¼ºè®°å¿†ç‚¹ã€‚  


## 2. ç²¾é€‰ä¼˜è´¨é¢˜è§£å‚è€ƒ

### é¢˜è§£ä¸€ï¼šæ¥æºï¼šskyleeï¼ˆèµï¼š4ï¼‰  
* **ç‚¹è¯„**ï¼š  
  è¿™ä»½é¢˜è§£çš„æ€è·¯**æ¸…æ™°ä¸”é«˜æ•ˆ**ï¼Œå®Œç¾ç»“åˆäº†äºŒåˆ†ç­”æ¡ˆä¸æ ‘å½¢DPã€‚ä½œè€…å¯¹`f[x]`çš„å®šä¹‰ï¼ˆä»¥`x`ä¸ºæ ¹çš„å­æ ‘ä¸­æ»¡è¶³æ¡ä»¶çš„æœ€é•¿å‰ç¼€ï¼‰éå¸¸å‡†ç¡®ï¼Œä¸”å¤„ç†äº†æ¢æ ¹çš„å…³é”®â€”â€”é€šè¿‡è®°å½•æ¬¡å¤§çš„`f[y]`ï¼ˆ`max2`ï¼‰ï¼Œå°†çˆ¶èŠ‚ç‚¹æ–¹å‘çš„è´¡çŒ®çº³å…¥è€ƒè™‘ã€‚ä»£ç é£æ ¼**è§„èŒƒæ˜“è¯»**ï¼ˆå˜é‡åå¦‚`f[x]`ã€`size[x]`å«ä¹‰æ˜ç¡®ï¼‰ï¼Œæ—¶é—´å¤æ‚åº¦`O(n log n)`ï¼ˆäºŒåˆ†æ¬¡æ•°`log n`ï¼Œæ¯æ¬¡æ ‘å½¢DP`O(n)`ï¼‰ï¼Œå®Œå…¨æ»¡è¶³é¢˜ç›®è¦æ±‚ï¼ˆ`nâ‰¤2Ã—10^5`ï¼‰ã€‚  
  äº®ç‚¹ï¼šç”¨`max1`å’Œ`max2`å¤„ç†éƒ¨åˆ†æ»¡è¶³æ¡ä»¶çš„å­èŠ‚ç‚¹ï¼Œå·§å¦™è¦†ç›–äº†æ¢æ ¹çš„æƒ…å†µï¼Œé¿å…äº†å¤æ‚çš„æ¢æ ¹DPã€‚


### é¢˜è§£äºŒï¼šæ¥æºï¼šçº¦ç‘Ÿå¤«ç”¨è„‘ç©ï¼ˆèµï¼š3ï¼‰  
* **ç‚¹è¯„**ï¼š  
  è¿™ä»½é¢˜è§£çš„**æ¢æ ¹DP**å¤„ç†éå¸¸å…¨é¢ï¼Œè€ƒè™‘äº†çˆ¶èŠ‚ç‚¹æ–¹å‘çš„è´¡çŒ®ï¼ˆ`h[x][p]`è¡¨ç¤º`x`é™¤å»å­èŠ‚ç‚¹`p`åçš„è¿é€šå—è´¡çŒ®ï¼‰ã€‚ä½œè€…å°†â€œèƒ½å¦è¿”å›â€ï¼ˆå³å­æ ‘æ˜¯å¦å®Œå…¨æ»¡è¶³æ¡ä»¶ï¼‰åˆ†å¼€è€ƒè™‘ï¼ˆ`f[x]`è¡¨ç¤ºèƒ½è¿”å›çš„æœ€å¤§å‰ç¼€ï¼Œ`g[x]`è¡¨ç¤ºä¸èƒ½è¿”å›çš„æœ€å¤§å‰ç¼€ï¼‰ï¼Œé€»è¾‘ä¸¥è°¨ã€‚ä»£ç è™½ç„¶ç¨å¤æ‚ï¼Œä½†**å¤ç”¨æ€§é«˜**ï¼ˆ`Up`å‡½æ•°å¤„ç†å‘ä¸Šè®¡ç®—ï¼Œ`Dn`å‡½æ•°å¤„ç†å‘ä¸‹æ¢æ ¹ï¼‰ï¼Œé€‚åˆå­¦ä¹ æ¢æ ¹DPçš„æŠ€å·§ã€‚  
  äº®ç‚¹ï¼šæ¢æ ¹æ—¶é€šè¿‡å‰ç¼€`max`ï¼ˆ`lmax`ã€`rmax`ï¼‰å¿«é€Ÿè®¡ç®—é™¤å»å­èŠ‚ç‚¹åçš„æœ€å¤§è´¡çŒ®ï¼Œä¼˜åŒ–äº†æ—¶é—´å¤æ‚åº¦ã€‚


## 3. æ ¸å¿ƒéš¾ç‚¹è¾¨æä¸è§£é¢˜ç­–ç•¥

### 1. å¦‚ä½•å®šä¹‰æ ‘å½¢DPçš„çŠ¶æ€ï¼Ÿ  
* **åˆ†æ**ï¼š  
  çŠ¶æ€`f[x]`çš„å®šä¹‰æ˜¯å…³é”®â€”â€”å¿…é¡»èƒ½å‡†ç¡®è¡¨ç¤ºâ€œä»¥`x`ä¸ºæ ¹çš„å­æ ‘ä¸­ï¼Œæ»¡è¶³æ¡ä»¶çš„æœ€é•¿å‰ç¼€é•¿åº¦â€ã€‚å¦‚æœ`f[x]`å®šä¹‰è¿‡çª„ï¼ˆæ¯”å¦‚ä¸è€ƒè™‘å­èŠ‚ç‚¹çš„é¡ºåºï¼‰ï¼Œä¼šå¯¼è‡´æ— æ³•æ­£ç¡®åˆå¹¶å­èŠ‚ç‚¹çš„è´¡çŒ®ï¼›å¦‚æœå®šä¹‰è¿‡å®½ï¼ˆæ¯”å¦‚åŒ…å«çˆ¶èŠ‚ç‚¹çš„ä¿¡æ¯ï¼‰ï¼Œä¼šå¢åŠ è®¡ç®—å¤æ‚åº¦ã€‚  
  ä¼˜è´¨é¢˜è§£ä¸­ï¼Œ`f[x]`çš„å®šä¹‰éƒ½éµå¾ªâ€œ**å­æ ‘å†…çš„æœ€é•¿å‰ç¼€**â€ï¼Œå¹¶é€šè¿‡â€œå®Œå…¨æ»¡è¶³â€å’Œâ€œéƒ¨åˆ†æ»¡è¶³â€çš„å­èŠ‚ç‚¹åˆ†ç±»ï¼Œå®ç°äº†æ­£ç¡®çš„è½¬ç§»ã€‚  
* ğŸ’¡ **å­¦ä¹ ç¬”è®°**ï¼šçŠ¶æ€å®šä¹‰æ˜¯æ ‘å½¢DPçš„åŸºçŸ³ï¼Œè¦ç¡®ä¿å…¶èƒ½è¦†ç›–æ‰€æœ‰å­é—®é¢˜ï¼Œä¸”æ— åæ•ˆæ€§ã€‚


### 2. å¦‚ä½•å¤„ç†æ¢æ ¹çš„æƒ…å†µï¼Ÿ  
* **åˆ†æ**ï¼š  
  é¢˜ç›®å…è®¸é€‰æ‹©ä»»æ„æ ¹èŠ‚ç‚¹ï¼Œå› æ­¤éœ€è¦è€ƒè™‘**çˆ¶èŠ‚ç‚¹æ–¹å‘çš„è´¡çŒ®**ã€‚æ¯”å¦‚ï¼Œå½“`x`ä½œä¸ºå­èŠ‚ç‚¹æ—¶ï¼Œå…¶çˆ¶èŠ‚ç‚¹çš„è¿é€šå—å¯èƒ½æˆä¸º`x`çš„â€œè™šæ‹Ÿå­èŠ‚ç‚¹â€ï¼Œè´¡çŒ®éƒ¨åˆ†æ»¡è¶³æ¡ä»¶çš„å‰ç¼€ã€‚  
  é¢˜è§£ä¸€é€šè¿‡è®°å½•æ¬¡å¤§çš„`f[y]`ï¼ˆ`max2`ï¼‰ï¼Œå°†çˆ¶èŠ‚ç‚¹æ–¹å‘çš„è´¡çŒ®è½¬åŒ–ä¸ºâ€œæ¬¡å¤§çš„éƒ¨åˆ†æ»¡è¶³å­èŠ‚ç‚¹â€ï¼Œé¿å…äº†å¤æ‚çš„æ¢æ ¹æ“ä½œï¼›é¢˜è§£äºŒåˆ™é€šè¿‡`h[x][p]`ç›´æ¥è®¡ç®—çˆ¶èŠ‚ç‚¹æ–¹å‘çš„è´¡çŒ®ï¼Œæ›´ç›´æ¥ä½†ä»£ç å¤æ‚åº¦æ›´é«˜ã€‚  
* ğŸ’¡ **å­¦ä¹ ç¬”è®°**ï¼šæ¢æ ¹é—®é¢˜çš„æ ¸å¿ƒæ˜¯â€œå°†çˆ¶èŠ‚ç‚¹çš„è¿é€šå—è§†ä¸ºå­èŠ‚ç‚¹â€ï¼Œå¯ä»¥é€šè¿‡é¢„å¤„ç†æˆ–è®°å½•æ¬¡å¤§å€¼æ¥ç®€åŒ–è®¡ç®—ã€‚


### 3. å¦‚ä½•åˆå¹¶å­èŠ‚ç‚¹çš„è´¡çŒ®ï¼Ÿ  
* **åˆ†æ**ï¼š  
  å­èŠ‚ç‚¹çš„è´¡çŒ®åˆ†ä¸ºä¸¤ç±»ï¼š**å®Œå…¨æ»¡è¶³**ï¼ˆ`f[y] = size[y]`ï¼‰å’Œ**éƒ¨åˆ†æ»¡è¶³**ï¼ˆ`f[y] < size[y]`ï¼‰ã€‚å®Œå…¨æ»¡è¶³çš„å­èŠ‚ç‚¹å¯ä»¥å…¨éƒ¨åŠ å…¥å‰ç¼€ï¼ˆå› ä¸ºå®ƒä»¬çš„å­æ ‘ä¸ä¼šä¸­æ–­å‰ç¼€ï¼‰ï¼Œè€Œéƒ¨åˆ†æ»¡è¶³çš„å­èŠ‚ç‚¹åªèƒ½é€‰æ‹©æœ€å¤§çš„ä¸€ä¸ªï¼ˆå› ä¸ºè¦å°½å¯èƒ½å»¶é•¿å‰ç¼€ï¼‰ã€‚  
  é¢˜è§£ä¸­éƒ½é‡‡ç”¨äº†â€œ**ç´¯åŠ å®Œå…¨æ»¡è¶³çš„å­èŠ‚ç‚¹ï¼Œé€‰æ‹©æœ€å¤§çš„éƒ¨åˆ†æ»¡è¶³å­èŠ‚ç‚¹**â€çš„ç­–ç•¥ï¼Œè¿™æ˜¯è´ªå¿ƒçš„ä½“ç°â€”â€”ä¼˜å…ˆä¿ç•™èƒ½å»¶é•¿å‰ç¼€çš„å­èŠ‚ç‚¹ã€‚  
* ğŸ’¡ **å­¦ä¹ ç¬”è®°**ï¼šåˆå¹¶å­èŠ‚ç‚¹è´¡çŒ®æ—¶ï¼Œè¦åŒºåˆ†â€œèƒ½å®Œå…¨ä¿ç•™â€å’Œâ€œåªèƒ½éƒ¨åˆ†ä¿ç•™â€çš„æƒ…å†µï¼Œè´ªå¿ƒé€‰æ‹©æœ€ä¼˜çš„ç»„åˆã€‚


### âœ¨ è§£é¢˜æŠ€å·§æ€»ç»“  
- **äºŒåˆ†ç­”æ¡ˆ**ï¼šè§£å†³â€œæœ€å°å€¼æœ€å¤§åŒ–â€é—®é¢˜çš„å¸¸ç”¨æ–¹æ³•ï¼Œå°†é—®é¢˜è½¬åŒ–ä¸ºåˆ¤å®šæ€§é—®é¢˜ï¼ˆæ˜¯å¦å­˜åœ¨è§£â‰¥`mid`ï¼‰ã€‚  
- **æ ‘å½¢DP**ï¼šå¤„ç†æ ‘ç»“æ„é—®é¢˜çš„æœ‰æ•ˆå·¥å…·ï¼Œé€šè¿‡å­èŠ‚ç‚¹çš„çŠ¶æ€è½¬ç§»å¾—åˆ°çˆ¶èŠ‚ç‚¹çš„çŠ¶æ€ã€‚  
- **è´ªå¿ƒåˆå¹¶**ï¼šåˆå¹¶å­èŠ‚ç‚¹è´¡çŒ®æ—¶ï¼Œä¼˜å…ˆé€‰æ‹©èƒ½å»¶é•¿å‰ç¼€çš„å­èŠ‚ç‚¹ï¼ˆå®Œå…¨æ»¡è¶³çš„å­èŠ‚ç‚¹æˆ–æœ€å¤§çš„éƒ¨åˆ†æ»¡è¶³å­èŠ‚ç‚¹ï¼‰ã€‚  


## 4. C++æ ¸å¿ƒä»£ç å®ç°èµæ

### æœ¬é¢˜é€šç”¨æ ¸å¿ƒC++å®ç°å‚è€ƒ  
* **è¯´æ˜**ï¼šæœ¬ä»£ç ç»¼åˆäº†skyleeé¢˜è§£çš„æ€è·¯ï¼Œæ˜¯äºŒåˆ†ç­”æ¡ˆ+æ ‘å½¢DPçš„å…¸å‹å®ç°ã€‚  
* **å®Œæ•´æ ¸å¿ƒä»£ç **ï¼š  
  ```cpp
  #include <iostream>
  #include <vector>
  #include <algorithm>
  using namespace std;

  const int N = 2e5 + 5;
  int n, k, w[N], size[N], f[N], ans, root;
  vector<int> e[N];

  void dfs(int x, int par, int mid) {
      size[x] = 1;
      f[x] = (w[x] >= mid) ? 1 : 0;
      int max1 = 0, max2 = 0;
      for (int y : e[x]) {
          if (y == par) continue;
          dfs(y, x, mid);
          size[x] += size[y];
          if (f[y] == size[y]) {
              f[x] += f[y];
          } else {
              if (f[y] > max1) {
                  max2 = max1;
                  max1 = f[y];
              } else if (f[y] > max2) {
                  max2 = f[y];
              }
          }
      }
      if (w[x] >= mid) {
          f[x] += max1;
          ans = max(ans, f[x] + max2);
      } else {
          f[x] = 0;
      }
  }

  bool check(int mid) {
      ans = 0;
      dfs(root, -1, mid);
      return ans >= k;
  }

  int main() {
      cin >> n >> k;
      for (int i = 1; i <= n; i++) {
          cin >> w[i];
      }
      for (int i = 1; i < n; i++) {
          int u, v;
          cin >> u >> v;
          e[u].push_back(v);
          e[v].push_back(u);
      }
      root = min_element(w + 1, w + n + 1) - w; // åˆå§‹æ ¹é€‰æ‹©æƒå€¼æœ€å°çš„èŠ‚ç‚¹ï¼ˆä¼˜åŒ–ï¼‰
      int l = *min_element(w + 1, w + n + 1);
      int r = *max_element(w + 1, w + n + 1);
      int res = l;
      while (l <= r) {
          int mid = (l + r) / 2;
          if (check(mid)) {
              res = mid;
              l = mid + 1;
          } else {
              r = mid - 1;
          }
      }
      cout << res << endl;
      return 0;
  }
  ```  
* **ä»£ç è§£è¯»æ¦‚è¦**ï¼š  
  1. **äºŒåˆ†æ¡†æ¶**ï¼š`l`å’Œ`r`åˆ†åˆ«è¡¨ç¤ºæƒå€¼çš„æœ€å°å€¼å’Œæœ€å¤§å€¼ï¼Œæ¯æ¬¡å–`mid`åˆ¤æ–­æ˜¯å¦å­˜åœ¨è§£â‰¥`mid`ã€‚  
  2. **æ ‘å½¢DPï¼ˆ`dfs`å‡½æ•°ï¼‰**ï¼šè®¡ç®—ä»¥`x`ä¸ºæ ¹çš„å­æ ‘ä¸­æ»¡è¶³æ¡ä»¶çš„æœ€é•¿å‰ç¼€`f[x]`ï¼Œè®°å½•`max1`ï¼ˆæœ€å¤§çš„éƒ¨åˆ†æ»¡è¶³å­èŠ‚ç‚¹è´¡çŒ®ï¼‰å’Œ`max2`ï¼ˆæ¬¡å¤§çš„éƒ¨åˆ†æ»¡è¶³å­èŠ‚ç‚¹è´¡çŒ®ï¼‰ã€‚  
  3. **æ£€æŸ¥å‡½æ•°ï¼ˆ`check`ï¼‰**ï¼šè°ƒç”¨`dfs`è®¡ç®—`ans`ï¼ˆæ‰€æœ‰å­æ ‘çš„æœ€å¤§å‰ç¼€é•¿åº¦ï¼‰ï¼Œåˆ¤æ–­æ˜¯å¦â‰¥`k`ã€‚  


### é¢˜è§£ä¸€ï¼ˆskyleeï¼‰æ ¸å¿ƒä»£ç ç‰‡æ®µèµæ  
* **äº®ç‚¹**ï¼šç”¨`max1`å’Œ`max2`å¤„ç†æ¢æ ¹æƒ…å†µï¼Œä»£ç ç®€æ´é«˜æ•ˆã€‚  
* **æ ¸å¿ƒä»£ç ç‰‡æ®µ**ï¼š  
  ```cpp
  void dfs(const int &x, const int &par) {
      f[x] = size[x] = 1;
      int max1 = 0, max2 = 0;
      for (register auto &y : e[x]) {
          if (y == par) continue;
          dfs(y, x);
          size[x] += size[y];
          if (f[y] == size[y]) {
              f[x] += f[y];
          } else {
              if (f[y] > max1) std::swap(f[y], max1);
              if (f[y] > max2) std::swap(f[y], max2);
          }
      }
      f[x] = w[x] < k ? 0 : f[x] + max1;
      ans = std::max(ans, f[x] + max2);
  }
  ```  
* **ä»£ç è§£è¯»**ï¼š  
  - `f[x]`åˆå§‹åŒ–ä¸º1ï¼ˆå½“å‰èŠ‚ç‚¹æœ¬èº«ï¼‰ï¼Œ`size[x]`åˆå§‹åŒ–ä¸º1ï¼ˆå­æ ‘å¤§å°ï¼‰ã€‚  
  - éå†å­èŠ‚ç‚¹`y`ï¼Œå¦‚æœ`y`çš„å­æ ‘å®Œå…¨æ»¡è¶³æ¡ä»¶ï¼ˆ`f[y] == size[y]`ï¼‰ï¼Œåˆ™å°†`f[y]`åŠ åˆ°`f[x]`ä¸­ï¼›å¦åˆ™ï¼Œæ›´æ–°`max1`å’Œ`max2`ï¼ˆè®°å½•æœ€å¤§çš„ä¸¤ä¸ªéƒ¨åˆ†æ»¡è¶³å­èŠ‚ç‚¹è´¡çŒ®ï¼‰ã€‚  
  - å¦‚æœå½“å‰èŠ‚ç‚¹`x`çš„æƒå€¼â‰¥`mid`ï¼ˆ`k`æ˜¯å½“å‰äºŒåˆ†çš„`mid`ï¼‰ï¼Œåˆ™`f[x]`åŠ ä¸Š`max1`ï¼ˆæœ€å¤§çš„éƒ¨åˆ†æ»¡è¶³å­èŠ‚ç‚¹è´¡çŒ®ï¼‰ï¼›å¦åˆ™ï¼Œ`f[x]`ç½®ä¸º0ã€‚  
  - `ans`è®°å½•æ‰€æœ‰å­æ ‘çš„æœ€å¤§å‰ç¼€é•¿åº¦ï¼ˆ`f[x] + max2`ï¼Œå³è€ƒè™‘æ¢æ ¹çš„æƒ…å†µï¼‰ã€‚  
* ğŸ’¡ **å­¦ä¹ ç¬”è®°**ï¼š`max1`å’Œ`max2`çš„è®°å½•æ˜¯å¤„ç†æ¢æ ¹çš„å…³é”®ï¼Œé¿å…äº†å¤æ‚çš„æ¢æ ¹DPã€‚


### é¢˜è§£äºŒï¼ˆçº¦ç‘Ÿå¤«ç”¨è„‘ç©ï¼‰æ ¸å¿ƒä»£ç ç‰‡æ®µèµæ  
* **äº®ç‚¹**ï¼šæ¢æ ¹DPå¤„ç†çˆ¶èŠ‚ç‚¹æ–¹å‘çš„è´¡çŒ®ï¼Œé€»è¾‘å…¨é¢ã€‚  
* **æ ¸å¿ƒä»£ç ç‰‡æ®µ**ï¼š  
  ```cpp
  inline int Up(int x, int y, int v) {
      sz[x] = 1;
      tt[x] = (a[x] >= v) ? 1 : 0;
      int mx = 0;
      for (int i = h[x]; i; i = nxt[i]) {
          int to = tto[i];
          if (to == y) continue;
          if (Up(to, x, v)) return 1;
          sz[x] += sz[to];
          if (tt[x]) {
              if (tt[to] == sz[to]) {
                  tt[x] += tt[to];
              } else {
                  mx = max(mx, tt[to]);
              }
          }
      }
      tt[x] += mx;
      return tt[x] >= K;
  }
  ```  
* **ä»£ç è§£è¯»**ï¼š  
  - `Up`å‡½æ•°å¤„ç†å‘ä¸Šè®¡ç®—ï¼ˆä»¥`1`ä¸ºæ ¹ï¼‰ï¼Œ`sz[x]`è¡¨ç¤ºå­æ ‘å¤§å°ï¼Œ`tt[x]`è¡¨ç¤ºä»¥`x`ä¸ºæ ¹çš„å­æ ‘ä¸­æ»¡è¶³æ¡ä»¶çš„æœ€é•¿å‰ç¼€ã€‚  
  - éå†å­èŠ‚ç‚¹`to`ï¼Œå¦‚æœ`to`çš„å­æ ‘å®Œå…¨æ»¡è¶³æ¡ä»¶ï¼ˆ`tt[to] == sz[to]`ï¼‰ï¼Œåˆ™å°†`tt[to]`åŠ åˆ°`tt[x]`ä¸­ï¼›å¦åˆ™ï¼Œæ›´æ–°`mx`ï¼ˆæœ€å¤§çš„éƒ¨åˆ†æ»¡è¶³å­èŠ‚ç‚¹è´¡çŒ®ï¼‰ã€‚  
  - `tt[x]`åŠ ä¸Š`mx`ï¼Œå¾—åˆ°ä»¥`x`ä¸ºæ ¹çš„å­æ ‘çš„æœ€é•¿å‰ç¼€ã€‚  
* ğŸ’¡ **å­¦ä¹ ç¬”è®°**ï¼šæ¢æ ¹DPéœ€è¦é¢„å¤„ç†çˆ¶èŠ‚ç‚¹æ–¹å‘çš„è´¡çŒ®ï¼Œ`Up`å‡½æ•°æ˜¯æ¢æ ¹çš„åŸºç¡€ã€‚  


## 5. ç®—æ³•å¯è§†åŒ–ï¼šåƒç´ åŠ¨ç”»æ¼”ç¤º (æ ¸å¿ƒéƒ¨åˆ†)

### åŠ¨ç”»æ¼”ç¤ºä¸»é¢˜ï¼šã€Šåƒç´ æ ‘çš„DFSå†’é™©ã€‹  
ï¼ˆä»¿ç…§FCæ¸¸æˆã€Šå†’é™©å²›ã€‹çš„é£æ ¼ï¼Œç”¨8ä½åƒç´ å—å±•ç¤ºæ ‘ç»“æ„å’Œç®—æ³•è¿‡ç¨‹ï¼‰


### æ ¸å¿ƒæ¼”ç¤ºå†…å®¹  
1. **äºŒåˆ†ç­”æ¡ˆè¿‡ç¨‹**ï¼š  
   - å±å¹•é¡¶éƒ¨æ˜¾ç¤ºè¿›åº¦æ¡ï¼Œå·¦ä¾§ä¸ºå½“å‰`l`ï¼ˆæœ€å°å€¼ï¼‰ï¼Œå³ä¾§ä¸ºå½“å‰`r`ï¼ˆæœ€å¤§å€¼ï¼‰ï¼Œä¸­é—´ä¸ºå½“å‰`mid`ï¼ˆå€™é€‰å€¼ï¼‰ã€‚  
   - æ ‘çš„èŠ‚ç‚¹ç”¨ä¸åŒé¢œè‰²è¡¨ç¤ºï¼šç»¿è‰²ï¼ˆæƒå€¼â‰¥`mid`ï¼‰ã€çº¢è‰²ï¼ˆæƒå€¼`<mid`ï¼‰ã€‚æ¯æ¬¡è°ƒæ•´`mid`æ—¶ï¼ŒèŠ‚ç‚¹é¢œè‰²åŠ¨æ€å˜åŒ–ï¼ˆæ¯”å¦‚`mid`å¢å¤§æ—¶ï¼Œç»¿è‰²èŠ‚ç‚¹å¯èƒ½å‡å°‘ï¼‰ã€‚  

2. **æ ‘å½¢DPè®¡ç®—**ï¼š  
   - èŠ‚ç‚¹ä¸‹æ–¹æ˜¾ç¤º`f[x]`ï¼ˆæ»¡è¶³æ¡ä»¶çš„æœ€é•¿å‰ç¼€ï¼‰å’Œ`size[x]`ï¼ˆå­æ ‘å¤§å°ï¼‰ã€‚  
   - å­èŠ‚ç‚¹çš„è´¡çŒ®åˆå¹¶è¿‡ç¨‹ç”¨â€œç®­å¤´æµåŠ¨â€åŠ¨ç”»å±•ç¤ºï¼š  
     - å®Œå…¨æ»¡è¶³çš„å­èŠ‚ç‚¹ï¼ˆ`f[y] == size[y]`ï¼‰ç”¨è“è‰²ç®­å¤´æŒ‡å‘çˆ¶èŠ‚ç‚¹ï¼Œç®­å¤´æ—æ˜¾ç¤º`+f[y]`ã€‚  
     - éƒ¨åˆ†æ»¡è¶³çš„å­èŠ‚ç‚¹ï¼ˆ`f[y] < size[y]`ï¼‰ç”¨é»„è‰²ç®­å¤´æŒ‡å‘çˆ¶èŠ‚ç‚¹ï¼Œç®­å¤´æ—æ˜¾ç¤º`max1`æˆ–`max2`ã€‚  
   - è®¡ç®—`max1`å’Œ`max2`æ—¶ï¼ŒèŠ‚ç‚¹ä¼šé—ªçƒé»„è‰²ï¼Œå¹¶ä¼´éšâ€œå®â€çš„åƒç´ éŸ³æ•ˆã€‚  

3. **æ¢æ ¹å¤„ç†**ï¼š  
   - å½“`ans`æ›´æ–°æ—¶ï¼ˆå³æ‰¾åˆ°æ›´å¤§çš„å‰ç¼€é•¿åº¦ï¼‰ï¼Œå½“å‰æ ¹èŠ‚ç‚¹ä¼šé—ªçƒç»¿è‰²ï¼Œå¹¶æ˜¾ç¤ºâ€œæ–°æ ¹å€™é€‰â€çš„æ–‡å­—æç¤ºã€‚  
   - çˆ¶èŠ‚ç‚¹æ–¹å‘çš„è´¡çŒ®ç”¨ç´«è‰²ç®­å¤´è¡¨ç¤ºï¼Œç®­å¤´æ—æ˜¾ç¤º`+max2`ï¼ˆæ¬¡å¤§çš„éƒ¨åˆ†æ»¡è¶³å­èŠ‚ç‚¹è´¡çŒ®ï¼‰ã€‚  

4. **ç›®æ ‡è¾¾æˆ**ï¼š  
   - å½“`check(mid)`è¿”å›`true`æ—¶ï¼ˆå³å­˜åœ¨è§£â‰¥`mid`ï¼‰ï¼Œå±å¹•æ˜¾ç¤ºâ€œæˆåŠŸï¼mid = Xâ€çš„æ–‡å­—ï¼Œä¼´éšä¸Šæ‰¬çš„èƒœåˆ©éŸ³æ•ˆï¼ˆç±»ä¼¼ã€Šè¶…çº§é©¬é‡Œå¥¥ã€‹çš„é€šå…³éŸ³æ•ˆï¼‰ã€‚  
   - å½“`check(mid)`è¿”å›`false`æ—¶ï¼Œå±å¹•æ˜¾ç¤ºâ€œå¤±è´¥ï¼mid = Xâ€çš„æ–‡å­—ï¼Œä¼´éšçŸ­ä¿ƒçš„æç¤ºéŸ³æ•ˆï¼ˆç±»ä¼¼ã€Šé­‚æ–—ç½—ã€‹çš„æ­»äº¡éŸ³æ•ˆï¼‰ã€‚  


### äº¤äº’ä¸æ§åˆ¶  
- **æ­¥è¿›æ§åˆ¶**ï¼šâ€œå•æ­¥æ‰§è¡Œâ€æŒ‰é’®ï¼Œé€å¸§å±•ç¤ºäºŒåˆ†å’Œæ ‘å½¢DPè¿‡ç¨‹ï¼›â€œè‡ªåŠ¨æ’­æ”¾â€æŒ‰é’®ï¼Œå¯è°ƒæ•´é€Ÿåº¦ï¼ˆæ»‘å—ä»1Ã—åˆ°5Ã—ï¼‰ã€‚  
- **åŸºç¡€æ§åˆ¶**ï¼šâ€œå¼€å§‹/æš‚åœâ€æŒ‰é’®ã€â€œé‡ç½®åŠ¨ç”»â€æŒ‰é’®ï¼ˆæ¢å¤åˆå§‹çŠ¶æ€ï¼‰ã€‚  
- **ç®—æ³•æ¯”è¾ƒ**ï¼šå¯é€‰æ‹©â€œskyleeçš„é¢˜è§£â€æˆ–â€œçº¦ç‘Ÿå¤«çš„é¢˜è§£â€ï¼Œå¹¶è¡Œå±•ç¤ºä¸¤ç§ç®—æ³•çš„è®¡ç®—è¿‡ç¨‹ï¼ˆå·¦ä¾§ä¸ºskyleeçš„æ ‘å½¢DPï¼Œå³ä¾§ä¸ºçº¦ç‘Ÿå¤«çš„æ¢æ ¹DPï¼‰ã€‚  


### è®¾è®¡æ€è·¯  
- **åƒç´ é£æ ¼**ï¼šè¥é€ å¤å¤æ¸¸æˆçš„æ°›å›´ï¼Œé™ä½å­¦ä¹ å‹åŠ›ï¼Œè®©ç®—æ³•è¿‡ç¨‹æ›´æœ‰è¶£ã€‚  
- **é¢œè‰²æ ‡è®°**ï¼šç”¨ä¸åŒé¢œè‰²åŒºåˆ†èŠ‚ç‚¹çŠ¶æ€ï¼ˆæ»¡è¶³/ä¸æ»¡è¶³æ¡ä»¶ï¼‰å’Œè´¡çŒ®ç±»å‹ï¼ˆå®Œå…¨/éƒ¨åˆ†æ»¡è¶³ï¼‰ï¼Œç›´è§‚å±•ç¤ºç®—æ³•é€»è¾‘ã€‚  
- **éŸ³æ•ˆæç¤º**ï¼šå…³é”®æ“ä½œï¼ˆå¦‚è®¡ç®—`max1`ã€`max2`ï¼‰ä¼´éšéŸ³æ•ˆï¼Œå¢å¼ºè®°å¿†ç‚¹ï¼Œè®©å­¦ä¹ è€…æ›´å®¹æ˜“æ³¨æ„åˆ°æ ¸å¿ƒæ­¥éª¤ã€‚  


## 6. æ‹“å±•ç»ƒä¹ ä¸ç›¸ä¼¼é—®é¢˜æ€è€ƒ

### é€šç”¨æ€è·¯/æŠ€å·§è¿ç§»  
- **äºŒåˆ†ç­”æ¡ˆ**ï¼šé€‚ç”¨äºâ€œæœ€å°å€¼æœ€å¤§åŒ–â€æˆ–â€œæœ€å¤§å€¼æœ€å°åŒ–â€é—®é¢˜ï¼Œå¦‚â€œæ±‚æœ€é•¿é€’å¢å­åºåˆ—çš„æœ€å°å¯èƒ½æœ€å¤§å€¼â€â€œæ±‚æœ€å°çš„æ—¶é—´ä½¿å¾—æ‰€æœ‰ä»»åŠ¡å®Œæˆâ€ã€‚  
- **æ ‘å½¢DP**ï¼šé€‚ç”¨äºæ ‘ç»“æ„çš„ä¼˜åŒ–é—®é¢˜ï¼Œå¦‚â€œæ ‘çš„æœ€é•¿è·¯å¾„â€â€œæ ‘çš„æœ€å°ç‚¹è¦†ç›–â€â€œæ ‘çš„æœ€å¤§ç‹¬ç«‹é›†â€ã€‚  
- **æ¢æ ¹DP**ï¼šé€‚ç”¨äºéœ€è¦è€ƒè™‘æ‰€æœ‰æ ¹èŠ‚ç‚¹çš„é—®é¢˜ï¼Œå¦‚â€œæ ‘çš„ä¸­å¿ƒâ€â€œæ ‘çš„ç›´å¾„ï¼ˆæ¢æ ¹æ³•ï¼‰â€ã€‚  


### ç»ƒä¹ æ¨è (æ´›è°·)  
1. **æ´›è°· P1122** - ã€Šæœ€å¤§å­æ ‘å’Œã€‹  
   * ğŸ—£ï¸ **æ¨èç†ç”±**ï¼šè¿™é“é¢˜æ˜¯æ ‘å½¢DPçš„ç»å…¸é—®é¢˜ï¼Œéœ€è¦è®¡ç®—æ ‘çš„æœ€å¤§å­æ ‘å’Œï¼Œé”»ç‚¼çŠ¶æ€å®šä¹‰å’Œè½¬ç§»çš„èƒ½åŠ›ã€‚  
2. **æ´›è°· P2607** - ã€Š[NOIP2015 æ™®åŠç»„] è·³çŸ³å¤´ã€‹  
   * ğŸ—£ï¸ **æ¨èç†ç”±**ï¼šè¿™é“é¢˜æ˜¯äºŒåˆ†ç­”æ¡ˆçš„ç»å…¸é—®é¢˜ï¼Œéœ€è¦åˆ¤æ–­æ˜¯å¦å­˜åœ¨ä¸€ç§æ–¹å¼ä½¿å¾—çŸ³å¤´ä¹‹é—´çš„è·ç¦»â‰¥`mid`ï¼Œä¸æœ¬é¢˜çš„äºŒåˆ†æ€è·¯é«˜åº¦ç›¸ä¼¼ã€‚  
3. **æ´›è°· P3384** - ã€Š[æ¨¡æ¿] æ ‘é“¾å‰–åˆ†ã€‹  
   * ğŸ—£ï¸ **æ¨èç†ç”±**ï¼šè¿™é“é¢˜è™½ç„¶æ˜¯æ ‘é“¾å‰–åˆ†çš„æ¨¡æ¿ï¼Œä½†æ¶‰åŠæ ‘å½¢DPçš„é¢„å¤„ç†ï¼ˆå¦‚è®¡ç®—å­æ ‘å¤§å°ã€æ·±åº¦ç­‰ï¼‰ï¼Œå¯ä»¥å·©å›ºæ ‘å½¢DPçš„åŸºç¡€ã€‚  


## 7. å­¦ä¹ å¿ƒå¾—ä¸ç»éªŒåˆ†äº« (è‹¥æœ‰)  
> **å‚è€ƒç»éªŒ (æ¥è‡ª skylee)**ï¼šâ€œæˆ‘åœ¨è§£å†³è¿™ä¸ªé—®é¢˜æ—¶ï¼Œæœ€åˆæ²¡æœ‰è€ƒè™‘æ¢æ ¹çš„æƒ…å†µï¼Œå¯¼è‡´æµ‹è¯•ç”¨ä¾‹25å¤±è´¥ã€‚åæ¥é€šè¿‡è®°å½•æ¬¡å¤§çš„`f[y]`ï¼Œå°†çˆ¶èŠ‚ç‚¹æ–¹å‘çš„è´¡çŒ®çº³å…¥è€ƒè™‘ï¼Œæ‰è§£å†³äº†é—®é¢˜ã€‚â€  
> **ç‚¹è¯„**ï¼šè¿™ä½ä½œè€…çš„ç»éªŒå¾ˆå…¸å‹â€”â€”æ¢æ ¹é—®é¢˜å¾€å¾€éœ€è¦è€ƒè™‘çˆ¶èŠ‚ç‚¹æ–¹å‘çš„è´¡çŒ®ï¼Œè€Œè®°å½•æ¬¡å¤§å€¼æ˜¯ä¸€ç§ç®€æ´çš„å¤„ç†æ–¹å¼ã€‚åœ¨ç¼–ç¨‹è¿‡ç¨‹ä¸­ï¼Œè¦æ³¨æ„**è¦†ç›–æ‰€æœ‰å¯èƒ½çš„æƒ…å†µ**ï¼Œå°¤å…¶æ˜¯é¢˜ç›®å…è®¸é€‰æ‹©ä»»æ„æ ¹èŠ‚ç‚¹çš„æƒ…å†µã€‚  


## ç»“è¯­  
æœ¬æ¬¡å…³äºâ€œPreorder Testâ€çš„C++è§£é¢˜åˆ†æå°±åˆ°è¿™é‡Œã€‚å¸Œæœ›è¿™ä»½å­¦ä¹ æŒ‡å—èƒ½å¸®åŠ©å¤§å®¶æ›´å¥½åœ°ç†è§£**äºŒåˆ†ç­”æ¡ˆ**å’Œ**æ ‘å½¢DP**çš„ç»“åˆåº”ç”¨ã€‚è®°ä½ï¼Œç¼–ç¨‹èƒ½åŠ›çš„æå‡åœ¨äº**æŒç»­å­¦ä¹ ã€å‹¤äºæ€è€ƒå’Œå‹‡äºå®è·µ**ã€‚ä¸‹æ¬¡æˆ‘ä»¬å†ä¸€èµ·æ¢ç´¢æ–°çš„ç¼–ç¨‹æŒ‘æˆ˜ï¼ğŸ’ª

---
å¤„ç†ç”¨æ—¶ï¼š202.78ç§’
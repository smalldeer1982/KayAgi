# é¢˜ç›®ä¿¡æ¯

# Envy

## é¢˜ç›®æè¿°

For a connected undirected weighted graph $ G $ , MST (minimum spanning tree) is a subgraph of $ G $ that contains all of $ G $ 's vertices, is a tree, and sum of its edges is minimum possible.

You are given a graph $ G $ . If you run a MST algorithm on graph it would give you only one MST and it causes other edges to become jealous. You are given some queries, each query contains a set of edges of graph $ G $ , and you should determine whether there is a MST containing all these edges or not.

## è¯´æ˜/æç¤º

This is the graph of sample:

 ![](https://cdn.luogu.com.cn/upload/vjudge_pic/CF891C/d7f37868e211da76f9c523f75a033c3f4d56f21c.png)Weight of minimum spanning tree on this graph is $ 6 $ .

MST with edges $ (1,3,4,6) $ , contains all of edges from the first query, so answer on the first query is "YES".

Edges from the second query form a cycle of length $ 3 $ , so there is no spanning tree including these three edges. Thus, answer is "NO".

## æ ·ä¾‹ #1

### è¾“å…¥

```
5 7
1 2 2
1 3 2
2 3 1
2 4 1
3 4 1
3 5 2
4 5 2
4
2 3 4
3 3 4 5
2 1 7
2 1 2
```

### è¾“å‡º

```
YES
NO
YES
NO
```

# AIåˆ†æç»“æœ

# ğŸ’¡ Kayçš„C++ç®—æ³•è§£æï¼šEnvy æ·±å…¥å­¦ä¹ æŒ‡å— ğŸ’¡


## 1. é¢˜ç›®è§£è¯»ä¸æ ¸å¿ƒç®—æ³•è¯†åˆ«

### âœ¨ æœ¬é¢˜ä¸»è¦è€ƒå¯Ÿï¼šå›¾è®ºï¼ˆæœ€å°ç”Ÿæˆæ ‘MSTæ€§è´¨åº”ç”¨ï¼‰

ğŸ—£ï¸ **åˆæ­¥åˆ†æ**ï¼š  
æˆ‘ä»¬å¯ä»¥æŠŠæœ€å°ç”Ÿæˆæ ‘ï¼ˆMSTï¼‰æ¯”ä½œâ€œç”¨æœ€å°‘çš„ç»³å­æŠŠæ‰€æœ‰èŠ‚ç‚¹ç»‘åœ¨ä¸€èµ·â€â€”â€”Kruskalç®—æ³•å°±åƒæŒ‰ç»³å­çš„é•¿åº¦ï¼ˆè¾¹æƒï¼‰ä»å°åˆ°å¤§é€‰ï¼Œæ¯æ¬¡é€‰ä¸ä¼šå½¢æˆç¯çš„ç»³å­ã€‚è€Œè¿™é“é¢˜çš„æ ¸å¿ƒæ˜¯åˆ¤æ–­â€œç»™å®šçš„å‡ æ ¹ç»³å­èƒ½å¦åŒæ—¶å‡ºç°åœ¨æŸæ†æœ€çŸ­çš„ç»³å­é‡Œâ€ã€‚  

**æ ¸å¿ƒæ€§è´¨**ï¼š  
1. **æƒå€¼ç‹¬ç«‹æ€§**ï¼šä¸åŒæƒå€¼çš„è¾¹äº’ä¸å½±å“â€”â€”å¤„ç†å®Œæ‰€æœ‰æ¯”å½“å‰è¾¹çŸ­çš„ç»³å­åï¼Œå›¾çš„è¿é€šçŠ¶æ€æ˜¯å›ºå®šçš„ï¼ˆæ¯”å¦‚ï¼Œå¤„ç†å®Œæ‰€æœ‰é•¿åº¦<5çš„ç»³å­ï¼ŒèŠ‚ç‚¹Aå’ŒBæ˜¯å¦è¿é€šæ˜¯ç¡®å®šçš„ï¼‰ã€‚  
2. **åŒæƒå€¼è¾¹æ•°é‡å›ºå®š**ï¼šæ‰€æœ‰MSTä¸­ï¼ŒåŒä¸€é•¿åº¦çš„ç»³å­æ•°é‡ç›¸åŒâ€”â€”å¦‚æœæŸæ ¹é•¿åº¦ä¸º5çš„ç»³å­èƒ½åŠ å…¥MSTï¼Œé‚£å®ƒè¿æ¥çš„ä¸¤ä¸ªè¿é€šå—åœ¨å¤„ç†å®Œ<5çš„ç»³å­åä¸€å®šæ˜¯åˆ†å¼€çš„ã€‚  

**é¢˜è§£æ€è·¯**ï¼š  
- é¢„å¤„ç†ï¼šç”¨Kruskalç®—æ³•å…ˆå¤„ç†æ‰€æœ‰è¾¹ï¼Œè®°å½•æ¯æ¡è¾¹åœ¨â€œå¤„ç†å®Œæ‰€æœ‰æ¯”å®ƒçŸ­çš„è¾¹â€åçš„ä¸¤ä¸ªç«¯ç‚¹æ‰€åœ¨çš„è¿é€šå—ï¼ˆè®°ä¸º`tx`å’Œ`ty`ï¼‰ã€‚  
- å¤„ç†è¯¢é—®ï¼šå°†è¯¢é—®çš„è¾¹æŒ‰æƒå€¼æ’åºï¼Œå¯¹æ¯ä¸ªæƒå€¼çš„è¾¹ï¼Œç”¨ä¸´æ—¶å¹¶æŸ¥é›†åˆ¤æ–­æ˜¯å¦ä¼šå½¢æˆç¯ï¼ˆå¦‚æœåŒæƒå€¼çš„è¾¹è¿æ¥çš„è¿é€šå—å·²ç»åˆå¹¶ï¼Œå°±è¯´æ˜å®ƒä»¬ä¸èƒ½åŒæ—¶å‡ºç°åœ¨MSTä¸­ï¼‰ã€‚  

**å¯è§†åŒ–è®¾è®¡æ€è·¯**ï¼š  
æˆ‘ä»¬ä¼šç”¨**8ä½åƒç´ é£**å±•ç¤ºKruskalçš„é¢„å¤„ç†è¿‡ç¨‹å’Œè¯¢é—®å¤„ç†ï¼š  
- èŠ‚ç‚¹ç”¨å½©è‰²åƒç´ å—è¡¨ç¤ºï¼Œè¾¹ç”¨çº¿æ¡è¿æ¥ï¼Œæƒå€¼è¶Šå°é¢œè‰²è¶Šæµ…ã€‚  
- é¢„å¤„ç†æ—¶ï¼Œæ¯åˆå¹¶ä¸¤ä¸ªè¿é€šå—ä¼šæœ‰â€œèåˆâ€åŠ¨ç”»ï¼ˆæ¯”å¦‚ä¸¤ä¸ªæ–¹å—æ…¢æ…¢å˜æˆåŒè‰²ï¼‰ï¼Œå¹¶ä¼´éšâ€œå®â€çš„éŸ³æ•ˆã€‚  
- è¯¢é—®å¤„ç†æ—¶ï¼ŒåŒæƒå€¼çš„è¾¹ä¼šé—ªçƒï¼ŒåŠ å…¥ä¸´æ—¶å¹¶æŸ¥é›†æ—¶ç”¨â€œå¸é™„â€åŠ¨ç”»ï¼Œè‹¥æˆç¯åˆ™çº¢è‰²é—ªçƒå¹¶æ’­æ”¾â€œå±â€çš„é”™è¯¯éŸ³æ•ˆã€‚  


## 2. ç²¾é€‰ä¼˜è´¨é¢˜è§£å‚è€ƒ

### é¢˜è§£ä¸€ï¼šï¼ˆæ¥æºï¼šwuzhaoxinï¼‰  
**ç‚¹è¯„**ï¼š  
è¿™é“é¢˜çš„â€œé¢„å¤„ç†+ä¸´æ—¶å¹¶æŸ¥é›†â€æ€è·¯éå¸¸å·§å¦™ï¼ä½œè€…å…ˆé€šè¿‡Kruskalé¢„å¤„ç†æ¯æ¡è¾¹çš„`tx`å’Œ`ty`ï¼ˆå¤„ç†å®Œ<è¯¥è¾¹æƒçš„è¾¹åçš„è¿é€šå—ï¼‰ï¼ŒæŠŠé—®é¢˜è½¬åŒ–ä¸ºâ€œåˆ¤æ–­åŒæƒå€¼çš„`tx`/`ty`è¾¹æ˜¯å¦æˆç¯â€ã€‚ä»£ç ç»“æ„æ¸…æ™°ï¼Œé¢„å¤„ç†æ­¥éª¤æŠŠå¤æ‚çš„è¿é€šæ€§é—®é¢˜ç®€åŒ–æˆäº†â€œæŸ¥å¹¶é›†â€ï¼Œéå¸¸é€‚åˆå…¥é—¨ç†è§£MSTçš„æ€§è´¨ã€‚


### é¢˜è§£äºŒï¼šï¼ˆæ¥æºï¼štommymioï¼‰  
**ç‚¹è¯„**ï¼š  
ä½œè€…ç”¨äº†**ç¦»çº¿å¤„ç†+å¯æ’¤é”€å¹¶æŸ¥é›†**çš„æŠ€å·§â€”â€”æŠŠæ‰€æœ‰è¯¢é—®æŒ‰æƒå€¼æ’åºï¼Œå’ŒKruskalçš„è¾¹å¤„ç†é¡ºåºä¸€è‡´ã€‚å¤„ç†åŒæƒå€¼çš„è¯¢é—®è¾¹æ—¶ï¼Œç”¨å¯æ’¤é”€å¹¶æŸ¥é›†åˆ¤æ–­æ˜¯å¦æˆç¯ï¼Œå¤„ç†å®Œåæ’¤é”€æ“ä½œï¼Œé¿å…å½±å“åç»­è¯¢é—®ã€‚è¿™ç§â€œç¦»çº¿+æ’¤é”€â€çš„æ€è·¯æ˜¯å¤„ç†å¤šè¯¢é—®å›¾è®ºé—®é¢˜çš„å¸¸ç”¨æŠ€å·§ï¼Œä»£ç çš„ç¦»çº¿å¤„ç†é€»è¾‘å€¼å¾—å­¦ä¹ ã€‚


### é¢˜è§£ä¸‰ï¼šï¼ˆæ¥æºï¼šGKxxï¼‰  
**ç‚¹è¯„**ï¼š  
ä½œè€…çš„ä»£ç æŠŠâ€œæŒ‰æƒå€¼åˆ†ç»„å¤„ç†â€çš„é€»è¾‘å†™å¾—å¾ˆç›´è§‚ï¼šå…ˆå¤„ç†åŸå›¾ä¸­æ‰€æœ‰æƒå€¼å°äºå½“å‰è¯¢é—®è¾¹æƒçš„è¾¹ï¼Œå†ç”¨å¯æ’¤é”€å¹¶æŸ¥é›†å¤„ç†è¯¢é—®ä¸­çš„åŒæƒå€¼è¾¹ã€‚ä»£ç ä¸­çš„â€œè¾¹æƒåˆ†ç»„å¾ªç¯â€å’Œâ€œæ’¤é”€æ“ä½œâ€éå¸¸æ¸…æ™°ï¼Œé€‚åˆç†è§£â€œæƒå€¼ç‹¬ç«‹æ€§â€çš„å®é™…åº”ç”¨ã€‚


## 3. æ ¸å¿ƒéš¾ç‚¹è¾¨æä¸è§£é¢˜ç­–ç•¥

### ğŸ” æ ¸å¿ƒéš¾ç‚¹ä¸è§£å†³ç­–ç•¥

1. **éš¾ç‚¹1ï¼šå¦‚ä½•è®°å½•â€œå¤„ç†å®Œ<æŸè¾¹æƒçš„è¾¹åçš„è¿é€šå—â€ï¼Ÿ**  
   - **è§£å†³**ï¼šç”¨Kruskalé¢„å¤„ç†æ¯æ¡è¾¹çš„`tx`å’Œ`ty`â€”â€”åœ¨å¤„ç†åˆ°æŸæƒå€¼çš„è¾¹æ—¶ï¼Œå…ˆè®°å½•æ‰€æœ‰è¯¥æƒå€¼è¾¹çš„ç«¯ç‚¹è¿é€šå—ï¼ˆæ­¤æ—¶è¿˜æ²¡åˆå¹¶è¯¥æƒå€¼çš„è¾¹ï¼‰ï¼Œå†åˆå¹¶è¿™äº›è¾¹ã€‚è¿™æ ·`tx`/`ty`å°±ä»£è¡¨äº†å¤„ç†å®Œ<è¯¥è¾¹æƒçš„è¾¹åçš„è¿é€šçŠ¶æ€ã€‚

2. **éš¾ç‚¹2ï¼šå¦‚ä½•å¤„ç†å¤šè¯¢é—®ï¼Œé¿å…äº’ç›¸å½±å“ï¼Ÿ**  
   - **è§£å†³**ï¼šå¯¹æ¯ä¸ªè¯¢é—®çš„è¾¹æŒ‰æƒå€¼æ’åºï¼Œç”¨**ä¸´æ—¶å¹¶æŸ¥é›†**å¤„ç†åŒæƒå€¼çš„è¾¹ï¼ˆå¤„ç†å®Œä¸€ä¸ªæƒå€¼åé‡ç½®å¹¶æŸ¥é›†ï¼‰ï¼Œæˆ–è€…ç”¨**å¯æ’¤é”€å¹¶æŸ¥é›†**ï¼ˆå¤„ç†å®Œè¯¢é—®åæ’¤é”€åˆå¹¶æ“ä½œï¼‰ã€‚

3. **éš¾ç‚¹3ï¼šå¦‚ä½•é«˜æ•ˆåˆ¤æ–­åŒæƒå€¼è¾¹æ˜¯å¦æˆç¯ï¼Ÿ**  
   - **è§£å†³**ï¼šå°†è¯¢é—®çš„è¾¹æŒ‰æƒå€¼åˆ†ç»„ï¼ŒåŒä¸€æƒå€¼çš„è¾¹ä¸€èµ·å¤„ç†â€”â€”å¦‚æœæŸæ¡è¾¹çš„`tx`å’Œ`ty`åœ¨ä¸´æ—¶å¹¶æŸ¥é›†ä¸­å·²ç»è¿é€šï¼Œè¯´æ˜è¿™æ¡è¾¹ä¼šå½¢æˆç¯ï¼Œæ— æ³•åŒæ—¶å‡ºç°åœ¨MSTä¸­ã€‚


### âœ¨ è§£é¢˜æŠ€å·§æ€»ç»“
- **é¢„å¤„ç†æŠ€å·§**ï¼šç”¨Kruskalè®°å½•æ¯æ¡è¾¹çš„â€œå†å²è¿é€šçŠ¶æ€â€ï¼ŒæŠŠåŠ¨æ€é—®é¢˜è½¬åŒ–ä¸ºé™æ€æŸ¥è¯¢ã€‚  
- **ç¦»çº¿å¤„ç†**ï¼šå°†è¯¢é—®æŒ‰æƒå€¼æ’åºï¼Œå’ŒKruskalçš„è¾¹å¤„ç†é¡ºåºä¸€è‡´ï¼Œå‡å°‘é‡å¤è®¡ç®—ã€‚  
- **ä¸´æ—¶/å¯æ’¤é”€å¹¶æŸ¥é›†**ï¼šå¤„ç†å¤šè¯¢é—®æ—¶ï¼Œç”¨ä¸´æ—¶å¹¶æŸ¥é›†æˆ–å¯æ’¤é”€å¹¶æŸ¥é›†é¿å…ä¸åŒè¯¢é—®çš„å½±å“ã€‚


## 4. C++æ ¸å¿ƒä»£ç å®ç°èµæ

### æœ¬é¢˜é€šç”¨æ ¸å¿ƒC++å®ç°å‚è€ƒ
**è¯´æ˜**ï¼šæœ¬ä»£ç ç»¼åˆäº†wuzhaoxinçš„é¢„å¤„ç†æ€è·¯å’Œä¸´æ—¶å¹¶æŸ¥é›†æŠ€å·§ï¼Œæ˜¯æœ€ç®€æ´çš„æ ¸å¿ƒå®ç°ã€‚

**å®Œæ•´æ ¸å¿ƒä»£ç **ï¼š
```cpp
#include <iostream>
#include <vector>
#include <algorithm>
using namespace std;

inline int gi() {
    register int x; register char c, op = 0;
    while(c = getchar(), c < '0' || c > '9') if(c == '-') op = !op;
    x = c ^ 48;
    while(c = getchar(), c >= '0' && c <= '9') x = (x << 3) + (x << 1) + (c ^ 48);
    return op ? -x : x;
}

const int MAXM = 500001;
int fa[MAXM];

struct Edge {
    int x, y, val, id;
    int tx, ty; // å¤„ç†å®Œ<valçš„è¾¹åçš„è¿é€šå—
    bool operator<(const Edge& a) const { return val < a.val; }
} e[MAXM];

bool cmpId(const Edge& x, const Edge& y) { return x.id < y.id; }
int find(int x) { return fa[x] == x ? x : fa[x] = find(fa[x]); }
void merge(int x, int y) { fa[find(x)] = find(y); }

int main() {
    int n = gi(), m = gi();
    for (int i = 1; i <= m; ++i) {
        e[i].x = gi(), e[i].y = gi(), e[i].val = gi(), e[i].id = i;
    }

    // é¢„å¤„ç†ï¼šè®°å½•æ¯æ¡è¾¹çš„txå’Œty
    sort(e + 1, e + m + 1);
    for (int i = 1; i <= n; ++i) fa[i] = i;
    for (int i = 1; i <= m;) {
        int j = i;
        do {
            e[j].tx = find(e[j].x);
            e[j].ty = find(e[j].y);
            ++j;
        } while (j <= m && e[j].val == e[j-1].val);
        // åˆå¹¶å½“å‰æƒå€¼çš„è¾¹ï¼ˆé¢„å¤„ç†å®Œæˆï¼‰
        while (i < j) {
            if (find(e[i].x) != find(e[i].y)) merge(e[i].x, e[i].y);
            ++i;
        }
    }

    // æŒ‰åŸidæ’åºï¼Œæ–¹ä¾¿æŸ¥è¯¢
    sort(e + 1, e + m + 1, cmpId);

    // å¤„ç†è¯¢é—®
    int q = gi();
    while (q--) {
        int k = gi();
        vector<Edge> v;
        for (int i = 0; i < k; ++i) {
            int a = gi();
            v.push_back({e[a].tx, e[a].ty, e[a].val});
        }
        // æŒ‰æƒå€¼æ’åºè¯¢é—®çš„è¾¹
        sort(v.begin(), v.end(), [](const Edge& a, const Edge& b) { return a.val < b.val; });

        bool flag = true;
        // ä¸´æ—¶å¹¶æŸ¥é›†ï¼šå¤„ç†å½“å‰è¯¢é—®
        for (int i = 1; i <= n; ++i) fa[i] = i;
        for (int i = 0; i < v.size() && flag;) {
            int val = v[i].val;
            int j = i;
            // æ‰¾åˆ°æ‰€æœ‰åŒæƒå€¼çš„è¾¹
            while (j < v.size() && v[j].val == val) ++j;
            // åˆ¤æ–­åŒæƒå€¼çš„è¾¹æ˜¯å¦æˆç¯
            for (int p = i; p < j; ++p) {
                int fx = find(v[p].x), fy = find(v[p].y);
                if (fx == fy) { flag = false; break; }
                merge(fx, fy);
            }
            // é‡ç½®ä¸´æ—¶å¹¶æŸ¥é›†çš„å½“å‰æƒå€¼éƒ¨åˆ†
            for (int p = i; p < j; ++p) {
                fa[v[p].x] = v[p].x;
                fa[v[p].y] = v[p].y;
            }
            i = j;
        }
        puts(flag ? "YES" : "NO");
    }
    return 0;
}
```

**ä»£ç è§£è¯»æ¦‚è¦**ï¼š  
1. **é¢„å¤„ç†**ï¼šç”¨Kruskalç®—æ³•å¤„ç†æ‰€æœ‰è¾¹ï¼Œè®°å½•æ¯æ¡è¾¹åœ¨â€œå¤„ç†å®Œæ¯”å®ƒçŸ­çš„è¾¹â€åçš„ä¸¤ä¸ªç«¯ç‚¹è¿é€šå—ï¼ˆ`tx`å’Œ`ty`ï¼‰ã€‚  
2. **å¤„ç†è¯¢é—®**ï¼šå°†è¯¢é—®çš„è¾¹æŒ‰æƒå€¼æ’åºï¼Œç”¨ä¸´æ—¶å¹¶æŸ¥é›†åˆ¤æ–­åŒæƒå€¼çš„è¾¹æ˜¯å¦ä¼šå½¢æˆç¯â€”â€”å¦‚æœæˆç¯ï¼Œè¯´æ˜è¿™äº›è¾¹ä¸èƒ½åŒæ—¶å‡ºç°åœ¨MSTä¸­ã€‚


### é¢˜è§£ä¸€æ ¸å¿ƒä»£ç ç‰‡æ®µèµæï¼ˆæ¥æºï¼šwuzhaoxinï¼‰
**äº®ç‚¹**ï¼šé¢„å¤„ç†`tx`å’Œ`ty`ï¼Œå°†å¤æ‚çš„è¿é€šæ€§é—®é¢˜è½¬åŒ–ä¸ºé™æ€æŸ¥è¯¢ã€‚  
**æ ¸å¿ƒä»£ç ç‰‡æ®µ**ï¼š
```cpp
// é¢„å¤„ç†æ¯æ¡è¾¹çš„txå’Œty
for (int i = 1; i <= m;) {
    int j = i;
    do {
        e[j].tx = find(e[j].x); // å¤„ç†å®Œ<valçš„è¾¹åçš„xè¿é€šå—
        e[j].ty = find(e[j].y); // å¤„ç†å®Œ<valçš„è¾¹åçš„yè¿é€šå—
        ++j;
    } while (j <= m && e[j].val == e[j-1].val);
    // åˆå¹¶å½“å‰æƒå€¼çš„è¾¹
    while (i < j) {
        if (find(e[i].x) != find(e[i].y)) merge(e[i].x, e[i].y);
        ++i;
    }
}
```
**ä»£ç è§£è¯»**ï¼š  
è¿™æ®µä»£ç æ˜¯é¢„å¤„ç†çš„æ ¸å¿ƒâ€”â€”å½“å¤„ç†åˆ°æƒå€¼ä¸º`val`çš„è¾¹æ—¶ï¼Œå…ˆè®°å½•æ‰€æœ‰è¯¥æƒå€¼è¾¹çš„`tx`å’Œ`ty`ï¼ˆæ­¤æ—¶è¿˜æ²¡åˆå¹¶è¿™äº›è¾¹ï¼‰ï¼Œå†åˆå¹¶è¿™äº›è¾¹ã€‚è¿™æ ·`tx`å’Œ`ty`å°±ä¿å­˜äº†â€œå¤„ç†å®Œæ‰€æœ‰æ¯”`val`å°çš„è¾¹â€åçš„è¿é€šçŠ¶æ€ã€‚æ¯”å¦‚ï¼Œè¾¹`e[j]`çš„`tx`æ˜¯`x`åœ¨å¤„ç†å®Œ<`val`çš„è¾¹åçš„æ ¹èŠ‚ç‚¹ï¼Œ`ty`åŒç†ã€‚  
**å­¦ä¹ ç¬”è®°**ï¼šé¢„å¤„ç†æ˜¯è§£å†³åŠ¨æ€è¿é€šæ€§é—®é¢˜çš„å¸¸ç”¨æŠ€å·§â€”â€”æŠŠâ€œæœªæ¥çš„æŸ¥è¯¢â€è½¬åŒ–ä¸ºâ€œè¿‡å»çš„çŠ¶æ€â€ã€‚


## 5. ç®—æ³•å¯è§†åŒ–ï¼šåƒç´ åŠ¨ç”»æ¼”ç¤º (æ ¸å¿ƒéƒ¨åˆ†)

### ğŸ® åŠ¨ç”»æ¼”ç¤ºä¸»é¢˜ï¼šåƒç´ Kruskalæ¢é™©è®°

**è®¾è®¡æ€è·¯**ï¼š  
ç”¨8ä½åƒç´ é£è¿˜åŸKruskalç®—æ³•çš„é¢„å¤„ç†è¿‡ç¨‹å’Œè¯¢é—®å¤„ç†ï¼Œé€šè¿‡**æ¸¸æˆåŒ–å…ƒç´ **ï¼ˆéŸ³æ•ˆã€å…³å¡ã€åŠ¨ç”»ï¼‰å¼ºåŒ–è®°å¿†ï¼š  
- åƒç´ é£æ ¼ï¼šèŠ‚ç‚¹æ˜¯å½©è‰²æ–¹å—ï¼ˆæ¯”å¦‚çº¢è‰²ä»£è¡¨æœªåˆå¹¶ï¼Œç»¿è‰²ä»£è¡¨å·²åˆå¹¶ï¼‰ï¼Œè¾¹æ˜¯é»‘ç™½çº¿æ¡ï¼Œæƒå€¼è¶Šå°é¢œè‰²è¶Šæµ…ã€‚  
- éŸ³æ•ˆï¼šåˆå¹¶è¿é€šå—æ—¶æ’­æ”¾â€œå®â€ï¼Œæˆç¯æ—¶æ’­æ”¾â€œå±â€ï¼Œè¯¢é—®æˆåŠŸæ—¶æ’­æ”¾â€œå“—â€ï¼ŒèƒŒæ™¯éŸ³ä¹æ˜¯FCé£æ ¼çš„è½»æ¾æ—‹å¾‹ã€‚  
- å…³å¡è®¾è®¡ï¼šé¢„å¤„ç†è¿‡ç¨‹åˆ†ä¸ºâ€œæƒå€¼1å…³â€â€œæƒå€¼2å…³â€â€¦æ¯å¤„ç†å®Œä¸€ä¸ªæƒå€¼çš„è¾¹ï¼Œå°±å¼¹å‡ºâ€œå…³å¡å®Œæˆâ€æç¤ºï¼Œå¢åŠ æˆå°±æ„Ÿã€‚


### ğŸ¬ åŠ¨ç”»å¸§æ­¥éª¤ä¸äº¤äº’å…³é”®ç‚¹

1. **åœºæ™¯åˆå§‹åŒ–**ï¼š  
   - å±å¹•å·¦ä¾§æ˜¯åƒç´ åŒ–çš„å›¾ï¼ˆæ¯”å¦‚5ä¸ªèŠ‚ç‚¹ï¼Œ7æ¡è¾¹ï¼‰ï¼Œå³ä¾§æ˜¯â€œæ§åˆ¶é¢æ¿â€ï¼ˆåŒ…å«å¼€å§‹/æš‚åœã€å•æ­¥ã€é‡ç½®æŒ‰é’®ï¼Œé€Ÿåº¦æ»‘å—ï¼‰ã€‚  
   - èƒŒæ™¯éŸ³ä¹å¼€å§‹æ’­æ”¾ï¼ˆFCé£æ ¼çš„ã€Šè¶…çº§é©¬é‡Œå¥¥ã€‹å°æ—‹å¾‹ï¼‰ã€‚

2. **é¢„å¤„ç†æ¼”ç¤º**ï¼š  
   - æŒ‰æƒå€¼ä»å°åˆ°å¤§å¤„ç†è¾¹ï¼šæƒå€¼ä¸º1çš„è¾¹å…ˆé—ªçƒï¼Œç„¶ååˆå¹¶ä¸¤ä¸ªèŠ‚ç‚¹ï¼ˆæ¯”å¦‚èŠ‚ç‚¹1å’Œ2å˜æˆç»¿è‰²ï¼‰ï¼Œä¼´éšâ€œå®â€çš„éŸ³æ•ˆã€‚  
   - å¤„ç†æƒå€¼ä¸º2çš„è¾¹æ—¶ï¼Œå…ˆæ˜¾ç¤ºæ¯æ¡è¾¹çš„`tx`å’Œ`ty`ï¼ˆæ¯”å¦‚è¾¹3çš„`tx`æ˜¯èŠ‚ç‚¹1çš„æ ¹ï¼Œ`ty`æ˜¯èŠ‚ç‚¹3çš„æ ¹ï¼‰ï¼Œå†åˆå¹¶ã€‚

3. **è¯¢é—®å¤„ç†æ¼”ç¤º**ï¼š  
   - è¾“å…¥è¯¢é—®çš„è¾¹ï¼ˆæ¯”å¦‚è¾¹3ã€4ã€5ï¼‰ï¼Œè¿™äº›è¾¹ä¼šæŒ‰æƒå€¼æ’åºå¹¶é—ªçƒã€‚  
   - å¤„ç†æƒå€¼ä¸º2çš„è¾¹æ—¶ï¼Œç”¨ä¸´æ—¶å¹¶æŸ¥é›†åˆå¹¶`tx`å’Œ`ty`ï¼šå¦‚æœåˆå¹¶æˆåŠŸï¼ŒèŠ‚ç‚¹é¢œè‰²å˜è“ï¼›å¦‚æœæˆç¯ï¼Œè¾¹å˜æˆçº¢è‰²å¹¶æ’­æ”¾â€œå±â€çš„éŸ³æ•ˆã€‚

4. **äº¤äº’æ§åˆ¶**ï¼š  
   - å•æ­¥æ‰§è¡Œï¼šç‚¹å‡»â€œå•æ­¥â€æŒ‰é’®ï¼ŒåŠ¨ç”»èµ°ä¸€æ­¥ï¼Œæ˜¾ç¤ºå½“å‰æ“ä½œçš„ä»£ç ç‰‡æ®µï¼ˆæ¯”å¦‚`find(v[p].x)`ï¼‰ã€‚  
   - è‡ªåŠ¨æ’­æ”¾ï¼šæ»‘åŠ¨é€Ÿåº¦æ»‘å—è°ƒæ•´æ’­æ”¾é€Ÿåº¦ï¼ŒåŠ¨ç”»è‡ªåŠ¨æ¼”ç¤ºé¢„å¤„ç†å’Œè¯¢é—®è¿‡ç¨‹ã€‚  
   - é‡ç½®ï¼šç‚¹å‡»â€œé‡ç½®â€æŒ‰é’®ï¼Œå›åˆ°åˆå§‹çŠ¶æ€ã€‚


## 6. æ‹“å±•ç»ƒä¹ ä¸ç›¸ä¼¼é—®é¢˜æ€è€ƒ

### ğŸ§  é€šç”¨æ€è·¯è¿ç§»
MSTçš„â€œæƒå€¼ç‹¬ç«‹æ€§â€å’Œâ€œè¿é€šæ€§å›ºå®šâ€æ€§è´¨å¯ä»¥è§£å†³å¾ˆå¤šé—®é¢˜ï¼Œæ¯”å¦‚ï¼š  
- åˆ¤æ–­æŸæ¡è¾¹æ˜¯å¦åœ¨æ‰€æœ‰MSTä¸­ï¼ˆå¦‚æœå¤„ç†å®Œ<è¯¥è¾¹æƒçš„è¾¹åï¼Œå®ƒè¿æ¥çš„ä¸¤ä¸ªè¿é€šå—å·²ç»åˆå¹¶ï¼Œåˆ™ä¸åœ¨ï¼‰ã€‚  
- æ±‚åŒ…å«æŸæ¡è¾¹çš„MSTçš„æœ€å°æƒå€¼å’Œï¼ˆå…ˆåˆå¹¶è¯¥è¾¹ï¼Œå†è·‘Kruskalï¼‰ã€‚


### ğŸ“š ç»ƒä¹ æ¨èï¼ˆæ´›è°·ï¼‰
1. **æ´›è°· P1194 ä¹°ç¤¼ç‰©**ï¼š  
   - æ¨èç†ç”±ï¼šè€ƒå¯ŸMSTçš„â€œå¿…é¡»è¾¹â€åˆ¤æ–­ï¼Œéœ€è¦ç”¨åˆ°â€œå¤„ç†å®Œ<æŸæƒå€¼è¾¹åçš„è¿é€šæ€§â€ã€‚  
2. **æ´›è°· P1546 æœ€çŸ­ç½‘ç»œ**ï¼š  
   - æ¨èç†ç”±ï¼šåŸºç¡€MSTé—®é¢˜ï¼Œå¸®åŠ©å·©å›ºKruskalç®—æ³•çš„å®ç°ã€‚  
3. **æ´›è°· P2820 å±€åŸŸç½‘**ï¼š  
   - æ¨èç†ç”±ï¼šè€ƒå¯ŸMSTçš„â€œè¾¹æ›¿æ¢â€ï¼Œéœ€è¦åˆ¤æ–­æŸæ¡è¾¹æ˜¯å¦èƒ½åŠ å…¥MSTã€‚


## 7. å­¦ä¹ å¿ƒå¾—ä¸ç»éªŒåˆ†äº« (è‹¥æœ‰)

**å‚è€ƒç»éªŒï¼ˆæ¥è‡ªwuzhaoxinï¼‰**ï¼š  
â€œé¢„å¤„ç†æ¯æ¡è¾¹çš„txå’Œtyæ˜¯å…³é”®â€”â€”ä¸€å¼€å§‹æ²¡æƒ³åˆ°å¯ä»¥è®°å½•å†å²è¿é€šçŠ¶æ€ï¼Œåæ¥æƒ³é€šäº†Kruskalçš„è¿‡ç¨‹ï¼Œæ‰æ„è¯†åˆ°å¯ä»¥æŠŠåŠ¨æ€é—®é¢˜è½¬åŒ–ä¸ºé™æ€æŸ¥è¯¢ã€‚â€  
**ç‚¹è¯„**ï¼šè¿™ä½ä½œè€…çš„ç»éªŒéå¸¸å®è´µâ€”â€”å¾ˆå¤šç®—æ³•é¢˜çš„éš¾ç‚¹åœ¨äºâ€œè§†è§’è½¬æ¢â€ï¼šæŠŠâ€œæœªæ¥çš„æŸ¥è¯¢â€è½¬åŒ–ä¸ºâ€œè¿‡å»çš„çŠ¶æ€â€ï¼Œé¢„å¤„ç†å°±æ˜¯å®ç°è¿™ç§è½¬æ¢çš„å¸¸ç”¨å·¥å…·ã€‚æ¯”å¦‚ï¼Œè¿™é“é¢˜çš„`tx`å’Œ`ty`å°±æ˜¯â€œè¿‡å»çš„çŠ¶æ€â€ï¼Œè€Œè¯¢é—®æ˜¯â€œæœªæ¥çš„æŸ¥è¯¢â€ã€‚


## 8. æ€»ç»“

æœ¬æ¬¡å…³äºâ€œEnvyâ€çš„åˆ†æï¼Œæˆ‘ä»¬é‡ç‚¹å­¦ä¹ äº†**MSTçš„ä¸¤ä¸ªæ ¸å¿ƒæ€§è´¨**ï¼ˆæƒå€¼ç‹¬ç«‹æ€§ã€è¿é€šæ€§å›ºå®šï¼‰ï¼Œä»¥åŠ**é¢„å¤„ç†+ç¦»çº¿å¤„ç†**çš„æŠ€å·§ã€‚è®°ä½ï¼š  
- é¢„å¤„ç†æ˜¯è§£å†³åŠ¨æ€é—®é¢˜çš„â€œæ—¶å…‰æœºâ€â€”â€”æŠŠæœªæ¥çš„æŸ¥è¯¢è½¬åŒ–ä¸ºè¿‡å»çš„çŠ¶æ€ã€‚  
- ç¦»çº¿å¤„ç†æ˜¯æé«˜æ•ˆç‡çš„â€œé­”æ³•â€â€”â€”æŠŠå¤šä¸ªæŸ¥è¯¢æŒ‰é¡ºåºå¤„ç†ï¼Œå‡å°‘é‡å¤è®¡ç®—ã€‚  

ä¸‹æ¬¡é‡åˆ°MSTçš„é—®é¢˜ï¼Œä¸å¦¨å…ˆæƒ³æƒ³ï¼šâ€œè¿™æ¡è¾¹çš„å†å²è¿é€šçŠ¶æ€æ˜¯ä»€ä¹ˆï¼Ÿâ€â€œä¸åŒæƒå€¼çš„è¾¹æ˜¯å¦ç‹¬ç«‹ï¼Ÿâ€â€”â€”è¿™äº›é—®é¢˜ä¼šå¸®ä½ å¿«é€Ÿæ‰¾åˆ°æ€è·¯ï¼ğŸ’ª


--- 
æœ¬æ¬¡åˆ†æç»“æŸï¼Œå¸Œæœ›èƒ½å¸®ä½ ç†è§£MSTçš„æ€§è´¨å’Œé¢„å¤„ç†æŠ€å·§ã€‚ç¼–ç¨‹çš„ä¹è¶£åœ¨äºâ€œç”¨æ€è·¯è§£å†³é—®é¢˜â€ï¼Œç»§ç»­åŠ æ²¹å§ï¼ğŸ‰

---
å¤„ç†ç”¨æ—¶ï¼š109.07ç§’
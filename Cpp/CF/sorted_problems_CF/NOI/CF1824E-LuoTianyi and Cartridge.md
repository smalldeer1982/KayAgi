---
title: "LuoTianyi and Cartridge"
layout: "post"
diff: NOI/NOI+/CTSC
pid: CF1824E
tag: []
---

# LuoTianyi and Cartridge

## 题目描述

给定一棵 $n$ 个结点的树 $T$，点有点权 $a_i, b_i$，边有边权 $c_i, d_i$。

按如下方式构建另一棵树 $T'$：

- 选择 $T$ 的 $p$ 个结点作为 $T'$ 的点集 $V'$。$p$ 可以是 $1\sim n$ 的任意正整数。
- 接下来 **依次** 选择 $T$ 的 $p - 1$ 条 **互不相同** 的边。
- 对于第 $i$ 次选边，假设选择第 $j$ 条边 $(x_j, y_j)$，那么你可以选择 $V'$ 的 **不连通** 的两个点 $u, v$，要求 $(x_j, y_j)$ 包含于 $u, v$ 在 $T$ 上的简单路径，在 $u, v$ 之间以 $c_j, d_j$ 为权值连边。

设 $A, C$ 分别为 $T'$ 的 $a_i, c_i$ 的最小值，$B, D$ 分别为 $T'$ 的 $b_i, d_i$ 之和，则 $T'$ 的权值为 $\min(A, C)\cdot (B + D)$。

求 $T'$ 的最大权值。

$3\leq n\leq 2\times 10 ^ 5$，$1\leq a_i, b_i, c_i, d_i\leq 2\times 10 ^ 5$，保证 $(x_i, y_i)$ 形成一棵树。

## 输入格式

第一行一个正整数 $n$。

第二行 $n$ 个正整数 $a_i$。

第三行 $n$ 个正整数 $b_i$。

接下来 $n - 1$ 行，每行四个正整数 $x_i, y_i, c_i, d_i$。

## 输出格式

输出一行一个整数表示答案 —— $T'$ 的最大权值。

翻译提供者：[Alex_Wei](https://www.luogu.com.cn/user/123294)。

## 样例 #1

### 输入

```
3
1 2 2
1 1 2
1 2 2 1
1 3 1 2
```

### 输出

```
8
```

## 样例 #2

### 输入

```
5
2 4 2 1 1
2 4 4 4 4
2 5 3 3
3 5 2 4
4 2 5 5
5 1 1 5
```

### 输出

```
35
```

## 样例 #3

### 输入

```
6
5 7 10 7 9 4
6 9 7 9 8 5
2 1 5 1
3 2 2 4
4 3 6 3
5 1 7 4
6 5 6 8
```

### 输出

```
216
```

## 样例 #4

### 输入

```
5
1000 1000 1 1000 1000
1000 1000 1 1000 1000
1 2 1 1
2 3 1000 1000
3 4 1000 1000
3 5 1000 1000
```

### 输出

```
7000000
```


---
title: "GCDDCG"
layout: "post"
diff: NOI/NOI+/CTSC
pid: CF2045K
tag: ['数论', '容斥原理']
---

# GCDDCG

## 题目描述

你正在参加一场名为“最大公约数牌组构建”的卡牌游戏。这款游戏中共有 $N$ 张牌（编号从 $1$ 到 $N$），第 $i$ 张牌的点数为 $A_i$，其中 $A_i$ 是 $1$ 到 $N$ 之间的整数（包括 $1$ 和 $N$）。

游戏由 $N$ 轮组成（从第 $1$ 轮到第 $N$ 轮）。在每一轮中，玩家需要将牌分成两个非空牌组：牌组 $1$ 和牌组 $2$。每一张牌不能同时出现在两个牌组里，并且允许有些牌不用。第 $i$ 轮的要求是，两个牌组中每个牌组的牌值的最大公约数（GCD）都要等于 $i$。

在第 $i$ 轮，你的创造力点数等于 $i$ 乘以可以构建这两个有效牌组的方案数。如果其中一个牌组的组成不同，那么视为不同的方案。

请计算所有 $N$ 轮中创造力点数的总和。因为这个总和可能会非常大，结果需要对 $998\,244\,353$ 取模。

## 输入格式

第一行是一个整数 $N$，表示牌的数量 ($2 \leq N \leq 200,000$)。

第二行包含 $N$ 个整数 $A_i$，表示每张牌的点数 ($1 \leq A_i \leq N$)。

## 输出格式

输出一个整数，即所有 $N$ 轮中创造力点数的总和对 $998,244,353$ 取模后的结果。

## 说明/提示

在样例输入/输出 #1 中，第 $1$ 轮和第 $2$ 轮的创造力点数均为 $0$。

在第 $3$ 轮，有 $12$ 种构建两个牌组的方法。记 $B$ 和 $C$ 为牌组 $1$ 和牌组 $2$ 中各自的牌号集合。这 $12$ 种方法包括：

- $B = \{ 1 \}, C = \{ 2 \}$
- $B = \{ 1 \}, C = \{ 3 \}$
- $B = \{ 1 \}, C = \{ 2, 3 \}$
- $B = \{ 2 \}, C = \{ 1 \}$
- $B = \{ 2 \}, C = \{ 3 \}$
- $B = \{ 2 \}, C = \{ 1, 3 \}$
- $B = \{ 3 \}, C = \{ 1 \}$
- $B = \{ 3 \}, C = \{ 2 \}$
- $B = \{ 3 \}, C = \{ 1, 2 \}$
- $B = \{ 1, 2 \}, C = \{ 3 \}$
- $B = \{ 2, 3 \}, C = \{ 1 \}$
- $B = \{ 1, 3 \}, C = \{ 2 \}$

在样例输入/输出 #2 中，第 $1$、$2$、$3$ 和 $4$ 轮中的构建方案数分别为 $0$、$18$、$0$ 和 $2$。

 **本翻译由 AI 自动生成**

## 样例 #1

### 输入

```
3
3 3 3
```

### 输出

```
36
```

## 样例 #2

### 输入

```
4
2 2 4 4
```

### 输出

```
44
```

## 样例 #3

### 输入

```
9
4 2 6 9 7 7 7 3 3
```

### 输出

```
10858
```


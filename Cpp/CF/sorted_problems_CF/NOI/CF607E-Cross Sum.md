---
title: "Cross Sum"
layout: "post"
diff: NOI/NOI+/CTSC
pid: CF607E
tag: []
---

# Cross Sum

## 题目描述

给定平面直角坐标系上的 $n$ 条两两不重合的直线。定义**可重**点集 $\mathcal{I}$，其包含 $n$ 条直线两两的交点。如果某个点作为交点出现了多次，其在 $\mathcal{I}$ 中也会出现多次。

给出一个询问点 $(p,q)$ ，定义可重数集 $\mathcal{D}$，其包含 $\mathcal{I}$ 中的所有点与 $(p,q)$ 的欧几里得距离，如果某个数出现了多次其在 $\mathcal{D}$ 中也会出现多次。

现在给出 $n$ 条直线与询问点，请求出 $\mathcal{D}$ 中前 $m$ 小的数的和，相同的数需要计算多次。

## 输入格式

第一行一个整数 $n$ 表示直线数量；

第二行三个整数 $x,y,m$，询问点为 $(\frac{x}{1000} , \frac{y}{1000})$，$m$ 意义如上所述；

接下来 $n$ 行每行两个整数 $a_i,b_i$ 表示一条直线 $y = \frac{a_i}{1000}x + \frac{b_i}{1000}$。

## 输出格式

一行一个浮点数表示答案，相对或绝对误差不超过 $10^{-6}$ 时认为正确。

## 说明/提示

$2 \leq n \leq 5 \times 10^4$，$0 \leq |x|,|y|,|a_i|,|b_i| \leq 10^6$，$1 \leq m \leq \min\{3 \times 10^7 , |\mathcal{D}|\}$，$\forall i \neq j, (a_i,b_i) \neq (a_j,b_j)$。

## 样例 #1

### 输入

```
4
1000 1000 3
1000 0
-1000 0
0 5000
0 -5000

```

### 输出

```
14.282170363

```

## 样例 #2

### 输入

```
2
-1000000 -1000000 1
1000000 -1000000
999999 1000000

```

### 输出

```
2000001000.999999500

```

## 样例 #3

### 输入

```
3
-1000 1000 3
1000 0
-1000 2000
2000 -1000

```

### 输出

```
6.000000000

```

## 样例 #4

### 输入

```
5
-303667 189976 10
-638 116487
-581 44337
1231 -756844
1427 -44097
8271 -838417

```

### 输出

```
12953.274911829

```


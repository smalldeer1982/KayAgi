---
title: "Suns and Rays"
layout: "post"
diff: 提高+/省选-
pid: CF316F2
tag: []
---

# Suns and Rays

## 题目描述

## 题目翻译

聪明的海狸开始对绘画感兴趣。他画太阳。但是，在某个时候，聪明的海狸意识到仅仅画太阳是无聊的。所以他决定设计一个可以处理他的绘画的程序。你给出了一个海狸画的图片。它将有两种颜色:一个是背景，一个是图像中的太阳。你的任务是统计图像中的太阳数量，并为每个太阳计算光线的数量。

太阳是任意旋转的椭圆形带有光线。光线是连接椭圆形的边界上的点与椭圆形外部某个点的线段。

 ![](https://cdn.luogu.com.cn/upload/vjudge_pic/CF316F2/8ef6efd54b49cd419c0fbfa7509d8e57e90b4992.png) 太阳都是圆的图片。   ![](https://cdn.luogu.com.cn/upload/vjudge_pic/CF316F2/05cd1ccc0c65679002e399651f00f7f18dd13325.png) 
 太阳都是椭圆的图片，它们的轴与坐标轴平行。   ![](https://cdn.luogu.com.cn/upload/vjudge_pic/CF316F2/0f0edab021211a24cea86225fbd5f9e361b8882d.png) 
 太阳都是旋转的椭圆形图片。保证：

- 没有两个太阳有共同的点。
- 光线的宽度为 $ 3 $ 像素。
- 椭圆形太阳的轴长度在 $ 40 $ 和 $ 200 $ 像素之间。
- 没有两个光线相交。
- 所有光线的长度在 $ 10 $ 和 $ 30 $ 像素之间。

## 输入格式

第一行包含两个整数 $ h $ 和 $ w $ —— 图像的高度和宽度 $(1 <= h, w <= 1600)$。接下来的 $ h $ 行将包含 $ w $ 个以空格分隔的整数。它们描述聪明的海狸的图片。每个数字都等于 $ 0 $ (图像背景) 或 $ 1 $ (太阳颜色)。

得分为 30 分的子任务输入限制为(subproblem F1):

- 图像上的所有太阳都是圆的。

得分为 70 分的子任务输入限制为(subproblems F1+F2):

- 图像上的所有太阳都是轴平行的椭圆形。

得分为 100 分的子任务输入限制为(subproblems F1+F2+F3):

- 图像上的所有太阳都是椭圆形的，它们可以任意旋转。

## 输出格式

第一行必须包含一个数字 $ k $——海狸图片上的太阳数量。第二行必须恰好包含 $ k $ 个以升序排列的整数，对应于每个太阳上的光线数。

## 说明/提示

对于每个复杂程度，您都建议在初始数据中提供一个示例。您可以在 http://www.abbyy.ru/sun.zip 下载这些样本。


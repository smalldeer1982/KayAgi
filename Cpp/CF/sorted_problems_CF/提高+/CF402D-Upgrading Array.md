---
title: "Upgrading Array"
layout: "post"
diff: 提高+/省选-
pid: CF402D
tag: []
---

# Upgrading Array

## 题目描述

给一个有n个数 a[1],a[2],…,a[n] 的数列打分，你认为 b[1],b[2]…,b[m] 是不好的质数。定义这个序列的分值为各个数的分值之和，设 x 的分值为 f(x)，f(x)=f(x/p)+k （p 为 x 的最小质因子；若 p 为不好的质数， k 取 −1 ，否则 k 取 +1 ； f(1)=0 ）。
你想让序列的分值更大，可以反复进行一项操作：$a[1],a[2],a[3],...,a[i](i<=n)$ 的每个数除以它们的最大公约数。请问你能让序列的得分最大为多少。

## 输入格式

首行两个整数$n,m(1<=n,m<=5000)$，下一行有$n$个数 $a[1],a[2],…,a[n]$，再下一行有$m$个数$b[1],b[2]…,b[m]$ 即为坏质数。（保证所有数不超过$10^9$， $b$ 数列都为质数且单调递增）

## 输出格式

一个数 $s$ ，就是你能让序列得分的最大值。

## 样例 #1

### 输入

```
5 2
4 20 34 10 10
2 5

```

### 输出

```
-2

```

## 样例 #2

### 输入

```
4 5
2 4 8 16
3 5 7 11 17

```

### 输出

```
10

```


---
title: "Dungeons and Candies"
layout: "post"
diff: 普及+/提高
pid: CF436C
tag: []
---

# Dungeons and Candies

## 题目描述

给定 $k$ 次文件，每次 $n*m$ 个字符。

传输文件，有两种方式：

1.直接传输，耗费 $n*m$ 个字符。

2.通过比较这个文件与前面某个文件的差别，耗费 $这个文件与那个文件不同的字符数*w$ 个字符，其中 $w$ 是常数。

文件顺序可任意交换。

求最小耗费字符数，并输出方案，有多种方案时任意输出一个。

## 输入格式

第一行，四个整数，$n,m,k,w$。

接下来 $n*k$ 行，每行 $m$ 个字符，表示 $k$ 个文件。

## 输出格式

第一行一个整数，最小花费。

接下来 $k$ 行，每行两个整数：

第一个整数表示这次输出的文件是第几个（因为传输顺序可以任意调换，所以这个是有必要的）。

第二个整数如果是 $0$，表示用了方法1；否则表示"那个文件"是第几个，即用了方法2。

## 说明/提示

$1<=n,m<=10$

$1<=k,w<=1000$

字符只会是 '.' 或大小写字母。

## 样例 #1

### 输入

```
2 3 3 2
A.A
...
A.a
..C
X.Y
...

```

### 输出

```
14
1 0
2 1
3 1

```

## 样例 #2

### 输入

```
1 1 4 1
A
.
B
.

```

### 输出

```
3
1 0
2 0
4 2
3 0

```

## 样例 #3

### 输入

```
1 3 5 2
ABA
BBB
BBA
BAB
ABB

```

### 输出

```
11
1 0
3 1
2 3
4 2
5 1

```


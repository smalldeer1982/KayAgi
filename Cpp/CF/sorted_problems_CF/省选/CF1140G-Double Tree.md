---
title: "Double Tree"
layout: "post"
diff: 省选/NOI-
pid: CF1140G
tag: []
---

# Double Tree

## 题目描述

给出一个$2N$个点、$3N-2$条边的无向图，边有边权。这张图满足以下性质：

①对于图上的一条边$(u,v)(2 | u , 2 | v)$，一定存在边$(u+1,v+1)$，反之亦然；

②图上存在边$(u,u \oplus 1)$

可以知道编号为偶数的点的导出子图和编号为奇数的点的导出子图都是一棵树，且它们同构。

现在给出$Q$组询问，每组询问询问两个点$x,y$之间的最短路长度。

## 输入格式

第一行一个正整数$N(1 \leq N \leq 3 \times 10^5)$

接下来一行$N$个正整数，第$i$个正整数表示边$(2i-1,2i)$的权值

接下来$N-1$行每行四个正整数$u,v,w_1,w_2$，表示边$(2u-1,2v-1)$的边权为$w_1$，$(2u,2v)$的边权为$w_2$。

接下来一行一个正整数$Q(1 \leq Q \leq 6 \times 10^5)$

接下来$Q$行每行两个正整数$x,y$描述一组询问。

数据保证所有边的边权$\leq 10^{12}$，输入保证合法

## 输出格式

对于每一组询问输出一行一个正整数表示两点之间的最短路长度。

## 样例 #1

### 输入

```
5
3 6 15 4 8
1 2 5 4
2 3 5 7
1 4 1 5
1 5 2 1
3
1 2
5 6
1 10

```

### 输出

```
3
15
4

```


---
title: "A Random Code Problem"
layout: "post"
diff: 省选/NOI-
pid: CF1626F
tag: ['动态规划 DP', '状态合并', '组合数学']
---

# A Random Code Problem

## 题目描述

给你一个数组 $a$ 和一个整数 $k$ ，执行下面的代码：
```cpp
long long ans = 0; //定义一个初始值为 0 的长整型变量
for(int i = 1; i <= k; i++) {
	int idx = rnd.next(0, n - 1); //生成一个介于0到n-1的随机数（含 0 和 n-1）
  								 //每个数被选中的概率是相同的
	ans += a[idx];
	a[idx] -= (a[idx] % i);
}
```
您需要在执行此代码后计算变量 $ans$ 的期望。

数组 $a$ 是输入时根据特殊规则生成的。

## 输入格式

仅一行，六个整数 $n$ , $a_0$ , $x$ , $y$ , $k$ 和 $M$ 。

数组 $a$ 由以下规则生成：

* $a_0$ 由输入给出
* 对于 $a_1$ 至 $a_{n-1}$，$a_i=(a_{i-1}\times x+y)\bmod M$。

## 输出格式

令 $E$ 为 $ans$ 的期望，输出 $E\times n^k$，对 $998244353$ 取模。

## 说明/提示

$1\le n\le10^7$

$1\le a_0,x,y<M\le998244353$

$1\le k\le17$

## 样例 #1

### 输入

```
3 10 3 5 13 88
```

### 输出

```
382842030
```

## 样例 #2

### 输入

```
2 15363 270880 34698 17 2357023
```

### 输出

```
319392398
```


---
title: "Opening Portals"
layout: "post"
diff: 省选/NOI-
pid: CF196E
tag: []
---

# Opening Portals

## 题目描述

Pavel 正在玩一个著名的电子游戏，在这个游戏中，玩家将管理整个国家，并在国家中旅行，完成任务以获取经验。

这个国家有 $n$ 个由 $m$ 条长度不同的无向道路联通的城市。这些城市中共有 $k$ 个传送门，在游戏开始时都是关闭的，每当玩家到达一个有传送门的城市时，就可以把这个城市的传送门永久的开启。玩家可以在两个开启的传送门之间任意的传送，且不需要花费时间。

游戏开始时，Pavel 处于 $1$ 号城市，他想要尽可能快的开启所有的传送门，试求他最小要花费的时间。

## 输入格式

第一行共有两个整数 $n,m$（$1 \leq n \leq 10^5, 0 \leq m \leq 10^5$），分别表示城市的数量与无向道路的数量。

第二行到第 $m+1$ 行每行共有三个正整数 $x_i,y_i,w_i$（$1 \leq x_i,y_i \leq n, x_i \neq y_i,1 \leq w_i \leq 10^9$），分别表示每一条无向道路所连接的两个城市与通过这条道路所需要花费的时间，保证图无重边，且是联通的。

第 $m+2$ 行共有一个整数，代表传送门的数量 $k$（$1 \leq k \leq n$）。

第 $m+3$ 行共有 $k$ 个整数 $p_1,p_2 \cdots p_k$，表示每个传送门所在的城市，保证每一个城市至多有一个传送门。

## 输出格式

一行一个整数，表示 Pavel 打开所有传送门最少需要的时间。

## 说明/提示

在第二个样例中，Pavel 首先来到了 $2$ 号城市并开启了传送门，之后前往了 $3$ 号城市并开启传送门，又传送回 $2$ 号城市，最后前往 $4$ 号城市并开启传送门，达成目标。

Translated by [@Colinxu2020](https://www.luogu.com.cn/user/579631).

## 样例 #1

### 输入

```
3 3
1 2 1
1 3 1
2 3 1
3
1 2 3

```

### 输出

```
2

```

## 样例 #2

### 输入

```
4 3
1 2 1
2 3 5
2 4 10
3
2 3 4

```

### 输出

```
16

```

## 样例 #3

### 输入

```
4 3
1 2 1000000000
2 3 1000000000
3 4 1000000000
4
1 2 3 4

```

### 输出

```
3000000000

```


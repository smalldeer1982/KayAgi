---
title: "Towering Arrays"
layout: "post"
diff: 省选/NOI-
pid: CF2071F
tag: ['线段树', '二分']
---

# Towering Arrays

## 题目描述

称一个长度为 $m$ 的数组 $b = [b_1, b_2, \ldots, b_m]$ 为 $p$-towering，当且仅当存在一个下标 $i$（$1 \le i \le m$），使得对于所有下标 $j$（$1 \le j \le m$）满足以下条件：

$$b_j \ge p - |i - j|. $$

给定一个长度为 $n$ 的数组 $a = [a_1, a_2, \ldots, a_n]$，你可以删除最多 $k$ 个元素。求剩余数组能够构成 $p$-towering 的最大 $p$ 值。

## 输入格式

每个测试包含多个测试用例。第一行包含测试用例数量 $t$（$1 \le t \le 10^4$）。接下来是各个测试用例的描述。

每个测试用例的第一行包含两个整数 $n$ 和 $k$（$0 \le k < n \le 2 \cdot 10^5$）。

第二行包含 $n$ 个整数 $a_1, a_2, \ldots, a_n$（$1 \le a_i \le 10^9$）。

保证所有测试用例的 $n$ 之和不超过 $2 \cdot 10^5$。

## 输出格式

对于每个测试用例，输出一个整数——剩余数组能构成 $p$-towering 的最大 $p$ 值。

## 说明/提示

第一个测试用例中，无法删除任何元素。剩余数组为 $[2, 1, 4, {\color{red}{5}}, 2]$，当选择 $i = 4$ 时满足 $p = 3$：
- $a_1 = 2 \ge p - |i - 1| = 3 - |4 - 1| = 0$；
- $a_2 = 1 \ge p - |i - 2| = 3 - |4 - 2| = 1$；
- $a_3 = 4 \ge p - |i - 3| = 3 - |4 - 3| = 2$；
- $a_4 = 5 \ge p - |i - 4| = 3 - |4 - 4| = 3$；
- $a_5 = 2 \ge p - |i - 5| = 3 - |4 - 5| = 2$。

第二个测试用例中，可以删除第 1、2、5 个元素得到数组 $[4, \color{red}{5}]$。当选择 $i = 2$ 时，该数组满足 $p = 5$。

翻译由 DeepSeek R1 完成

## 样例 #1

### 输入

```
6
5 0
2 1 4 5 2
5 3
2 1 4 5 2
6 1
1 2 3 4 5 1
11 6
6 3 8 5 8 3 2 1 2 7 1
14 3
3 2 3 5 5 2 6 7 4 8 10 1 8 9
2 0
1 1
```

### 输出

```
3
5
5
7
9
1
```


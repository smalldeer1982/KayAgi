---
title: "Subset Sums"
layout: "post"
diff: 省选/NOI-
pid: CF348C
tag: []
---

# Subset Sums

## 题目描述

给定一个n个数的序列a，m个下标集合，记
$S_{k}=\{S_{k,i}\}$。
两种操作：

$1. $? k 求集合k的和，即
求集合k 所有元素做原数组下标的和

$2.$ + k w 给集合k的所有下标代表的数加w。

## 输入格式

输入的第一行包括三个整数  $n$ ,  $m$  和  $q$   $( 1<=n, m, q<=10^5 )$ 。第二行包括n个整数  $ a_1, a_2, ..., a_n $ ， 表示数组  $a$  。

接下来的  $m$  行，每行描述了一个集合。第  $k$  行首先包括一个正整数  $x$  ，表示集合  $S_k$  的大小。接下来是  $x$  个正整数，表示集合  $S_k$  的元素所处的下标。

接下来的  $q$  行是将要进行的操作。每种操作占一行。第一种操作形如 `? k` ，表示询问集合  $S_k$  中所有元素的和。第二种操作形如 `+ k x`， 表示将集合 $S_k$ 中**所有下标代表的数**加上 $x$。对于每个询问，都有  $( 1<=k<=m, |x|<=10^8 )$ 。

保证所有集合的元素数量和不超过  $10^5$  。

## 输出格式

对于每个 `? k` 操作，请输出集合  $S_k$  的元素之和。

注意：因为评测机的平台原因，请使用 `cin` `cout` 或 `%I64d` 输入输出64位整数。 

感谢@elijahqi  @星烁晶熠辉  提供的翻译

## 样例 #1

### 输入

```
5 3 5
5 -5 5 1 -4
2 1 2
4 2 1 4 5
2 2 5
? 2
+ 3 4
? 1
+ 2 1
? 2

```

### 输出

```
-3
4
9

```


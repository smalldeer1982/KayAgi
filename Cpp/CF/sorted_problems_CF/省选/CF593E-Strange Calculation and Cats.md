---
title: "Strange Calculation and Cats"
layout: "post"
diff: 省选/NOI-
pid: CF593E
tag: []
---

# Strange Calculation and Cats

## 题目描述

## 题目翻译

LBW 有一张 $n\times m$ 的网格图，有一只猴子初始在$(1,1)$。

猴子每秒钟可以移动一格，或者不动。

LBW 有 $T$ 次操作，每一次询问想知道不同的内容，如下。

+ 操作一：询问第 $i$ 秒时，猴子走到 $(x, y)$ 的方案数。
+ 操作二：第 $i$ 秒，$(x, y)$ 出现了障碍，不能走在障碍上。
+ 操作三：第 $i$ 秒，$(x, y)$ 出的障碍消失了。

对于所有操作一，告诉 LBW 方案数。

## 输入格式

第一行三个整数 $n, m, T$，分别表示操作数量，地图的行数与列数。

接下来 $T$ 行，每行四个数 $op, x, y, i$，如题目所述。$op$ 表示操作类型。

## 输出格式

对于所有操作一，单独一行给出方案数。这个答案可能很大，只需给出它 $\bmod\space 10^9 + 7$ 的结果。

## 说明/提示

- $n \times m \le 20$；
- $1 \le T \le 10^4$；
- 每次操作，保证 $op \in \{1, 2, 3\}$，$1 \le x \le n$ 并且 $1 \le y \le m$，$i \le 10^9$。
- 保证每个格子最多只有一个障碍，且 $i$ 是递增的。

## 样例 #1

### 输入

```
1 3 3
2 1 2 3
3 1 2 5
1 1 1 7

```

### 输出

```
5

```

## 样例 #2

### 输入

```
3 3 3
2 2 2 2
1 3 3 5
1 3 3 7

```

### 输出

```
2
42

```

## 样例 #3

### 输入

```
4 5 5
2 2 5 3
2 2 4 6
3 2 4 9
1 4 4 13
1 4 4 15

```

### 输出

```
490902
10598759

```


---
title: "Game in Tree (Hard Version)"
layout: "post"
diff: NOI/NOI+/CTSC
pid: CF2013F2
tag: ['贪心', '线段树', '根号分治']
---

# Game in Tree (Hard Version)

## 题目描述

这是问题的困难版本。在这一版本中，不要求 $u = v$。只有当两个版本的问题都成功解决后，你才能进行 hack。

Alice 和 Bob 在一棵树上玩一个有趣的游戏。这棵树有 $n$ 个顶点，编号从 $1$ 到 $n$。回顾一下，一棵有 $n$ 个顶点的树是一个有 $n - 1$ 条边的无向连通图。

游戏规则是 Alice 和 Bob 轮流移动，Alice 先行动，每位玩家在自己的回合中，必须从当前所在的顶点移动到一个尚未被访问过的相邻顶点。如果某个玩家无法移动，则他输掉比赛。

给定两个顶点 $u$ 和 $v$。从顶点 $u$ 到顶点 $v$ 的简单路径用数组表示为 $p_1, p_2, p_3, \ldots, p_m$，其中 $p_1 = u$，$p_m = v$，并且每对相邻的顶点 $p_i$ 和 $p_{i+1}$之间都有一条边（$1 \le i < m$）。

你的任务是，判断在 Alice 从顶点 $1$ 开始，而 Bob 从路径中的顶点 $p_j$（$1 \le j \le m$）开始的情况下，谁将获胜。

## 输入格式

输入包含多个测试用例。第一行为测试用例的数量 $t$（$1 \le t \le 10^4$）。接下来每个测试用例进行描述。

每个测试用例的第一行是一个整数 $n$（$2 \le n \le 2 \cdot 10^5$），表示树中顶点的个数。

接下来的 $n - 1$ 行，每行包含两个整数 $a$ 和 $b$（$1 \le a, b \le n$），表示顶点 $a$ 和 $b$ 之间连接着一条无向边。这些边保证组成一棵树。

测试用例的最后一行包含两个整数 $u$ 和 $v$（$2 \le u, v \le n$），保证从 $u$ 到 $v$ 的路径不通过顶点 $1$。

保证所有测试用例中 $n$ 的总和不超过 $2 \cdot 10^5$。

## 输出格式

对于每个测试用例，输出 $m$ 行。

在第 $i$ 行输出结果，如果 Alice 从顶点 $1$ 开始而 Bob 从顶点 $p_i$ 开始时，游戏的赢家是谁。如果 Alice 赢，则输出“Alice”；否则输出“Bob”。

## 说明/提示

在第一个例子中，路径是（$2, 3$）。如果 Bob 开始时位于顶点 $2$，Alice 在第一回合就无法移动，只能输掉比赛。而如果 Bob 从顶点 $3$ 开始，Alice 会移动到顶点 $2$，此时 Bob 就没有顶点可动并会输掉比赛。

 **本翻译由 AI 自动生成**

## 样例 #1

### 输入

```
3
3
1 2
2 3
2 3
6
1 2
1 3
2 4
2 5
1 6
4 5
4
1 2
1 3
2 4
2 4
```

### 输出

```
Bob
Alice
Alice
Bob
Alice
Bob
Alice
```



---

---
title: "Complex Segments (Easy Version)"
layout: "post"
diff: NOI/NOI+/CTSC
pid: CF2018E1
tag: ['贪心', '根号分治']
---

# Complex Segments (Easy Version)

## 题目描述

这是这个问题的简单版本。在这个版本中， $n$ 的范围和时间限制都较低。

当一个区间的集合可以被分割成一些子集并满足以下条件时，这个集合是复杂的：

- 所有的子集的大小相同
- 当且仅当两个区间在同一子集内时，这两个区间相交。

$t$ 组数据，每组数据给你一个集合包含 $n$ 个区间 $[l_1, r_1], [l_2, r_2], \dots, [l_n, r_n]$。求出最大的子集满足其为复杂的，输出这个集合的大小。

## 输入格式

第一行输入数据个数 $t(1 \le t \le 10^3)$。

每个数据的第一行包含一个整数 $n(1 \le n \le 2 \cdot 10^4)$，集合的区间个数。

每个数据的第二行包含 $n$ 个整数 $l_1, l_2, \ldots, l_n(1 \le l_i \le 2n)$，分别表示这 $n$ 个区间的左端点。

每个数据的第三行包含 $n$ 个整数 $r_1, r_2, \ldots, r_n(l_i \leq r_i \le 2n)$，分别表示这 $n$ 个区间的右端点。

保证所有数据 $n$ 的总和不超过 $2 \cdot 10^4$。

## 输出格式

对于每个数据输出一行表示最大的复杂的子集的大小。

## 样例 #1

### 输入

```
3
3
1 2 3
5 4 6
5
1 2 3 6 8
5 4 7 9 10
5
3 1 4 1 5
7 2 6 5 10
```

### 输出

```
3
4
4
```



---


---
title: "Arithmancy (Easy)"
layout: "post"
diff: 普及+/提高
pid: CF1970D1
tag: ['随机化']
---

# Arithmancy (Easy)

## 题目描述

# 数字术 (简单)


维克多教授正在准备她的数字术课程。她需要为课程准备 $ n $ 个不同的魔法词。每个魔法词是一个由字符 X 和 O 组成的字符串。一个咒语是通过连接两个魔法词组成的字符串。咒语的能量等于它的不同非空子字符串的数量。例如，咒语 XOXO 的能量等于 7，因为它有 7 个不同的子字符串：X, O, XO, OX, XOX, OXO 和 XOXO。

每个学生将通过连接两个魔法词来创造他们自己的咒语。由于学生们对魔法还不太熟练，他们会独立且均匀地从提供的 $ n $ 个魔法词中随机选择两个词。因此，学生选择的两个词有可能是相同的。然后每个学生将计算他们咒语的能量，并告诉维克多教授。为了检查他们的作业，并当然为了给学生们留下深刻印象，维克多教授需要找出每个学生使用了哪两个魔法词以及它们的顺序来创建对应的咒语。

你的程序需要扮演维克多教授的角色：首先，创建 $ n $ 个不同的魔法词，然后处理多个请求，其中给定咒语能量并需要确定用于创建相应咒语的两个魔法词的索引及其正确顺序。

## 输出格式

这是一个交互题。

首先，你的程序应该读取一个整数 $ n $ ( $ 1 \le n \le 3 $ )，表示要准备的魔法词数量。然后，它应该输出它创建的 $ n $ 个魔法词，每行一个。魔法词必须是不同的，每个魔法词至少有 1 个且最多有 $ 30\cdot n $ 个字符，每个字符必须是 X 或 O。我们将你输出的第 $ i $ 个魔法词记作 $ w_i $ ( $ 1 \le i \le n $ )。

接下来，你的程序应该读取一个整数 $ q $ ( $ 1 \le q \le 1000 $ )，表示班级中的学生数量。然后，它应该重复以下过程 $ q $ 次，每个学生一次。

对于第 $ j $ 个学生，它应该首先读取一个整数 $ p_j $，表示他们咒语的能量。可以保证这个数字是通过在 1 到 $ n $ 之间独立且均匀随机选择两个索引 $ u_j $ 和 $ v_j $，连接 $ w_{u_j} $ 和 $ w_{v_j} $，并找到结果字符串的不同非空子字符串的数量计算出来的。然后，你的程序必须按顺序输出数字 $ u_j $ 和 $ v_j $ ( $ 1 \le u_j, v_j \le n $ )。

注意，找到任何两个连接后能量与给定能量相同的魔法词是不够的。你必须找到学生使用的确切词语和确切顺序。

在输出所有魔法词和为每个学生输出 $ u_j $ 和 $ v_j $ 后，请记得刷新输出流。

## 样例 #1

### 样例输入 #1

```
2
XOXO
X
2
15
11
```

### 样例输出 #1

```
XOXO
X
1 1
2 1
```

## 样例 #1

### 输入

```
2


2
15

11
```

### 输出

```
XOXO
X


1 1

2 1
```



---

---
title: "Empty Triangle"
layout: "post"
diff: 普及+/提高
pid: CF2074E
tag: ['随机化']
---

# Empty Triangle

## 题目描述

这是一道交互题。

粉色士兵们向你隐藏了 $n$ 个（$3 \le n \le 1500$）固定点 $(x_1, y_1), (x_2, y_2), \ldots, (x_n, y_n)$，其坐标未给出。已知任意两点坐标不同，且任意三点不[共线](https://en.wikipedia.org/wiki/Collinearity)。

你可以向主持人（Frontman）询问三个不同的下标 $i$、$j$、$k$。随后，主持人会绘制由点 $(x_i, y_i)$、$(x_j, y_j)$、$(x_k, y_k)$ 构成的三角形，并按以下规则回应：

- 若至少有一个隐藏点位于三角形内部，主持人会返回其中一个这样的点的下标。注意，若有多个这样的点，主持人可以任意选择其中一个返回。
- 否则，主持人返回 $0$。

![](https://cdn.luogu.com.cn/upload/vjudge_pic/CF2074E/e516ed9e8799abe3210fe85d082a2aa0f40e533f.png)  
你的目标是找到一个不包含其他隐藏点的三角形（如图中蓝色三角形所示）。你最多可以使用 $\mathbf{75}$ 次询问，找到由三个点构成的、内部不含其他隐藏点的任意三角形。

注意：主持人可能在选择返回的点时具有自适应性。换言之，返回点的选择可能受到多种因素影响（包括但不限于点的排列和之前的询问）。但需注意，点的序列永远不会被改变。

本题禁用 hack。你的解法将在恰好 $\mathbf{35}$ 个输入文件（包括示例输入）上进行评测。

## 输出格式

每个测试包含多个测试用例。第一行包含测试用例的数量 $t$（$1 \le t \le 20$）。接下来是每个测试用例的描述。

每个测试用例的第一行包含一个正整数 $n$ —— 点的数量（$3 \le n \le 1500$）。

之后，你可以在单独一行输出以下内容进行询问：

- "? i j k"（$1 \le i,j,k \le n$，$i \ne j$，$i \ne k$，$j \ne k$）：询问由 $(x_i, y_i)$、$(x_j, y_j)$、$(x_k, y_k)$ 构成的三角形。

随后，交互器会在新的一行返回一个整数：

- 若你的询问无效或询问次数超过 $\mathbf{75}$ 次，交互器返回 $-1$；
- 若存在下标 $p$（$1 \le p \le n$）使得点 $(x_p, y_p)$ 位于三角形内部，则返回任意一个这样的下标 $p$；
- 否则，交互器返回 $0$。

若你想提交答案，可以在单独一行输出以下内容：

- "! i j k"（$1 \le i,j,k \le n$，$i \ne j$，$i \ne k$，$j \ne k$）：表示由 $(x_i, y_i)$、$(x_j, y_j)$、$(x_k, y_k)$ 构成的三角形内部不含其他隐藏点。

随后，以下交互会发生：

- 若答案无效或三角形包含其他隐藏点，交互器返回 $-1$；
- 若答案正确且仍有未处理的测试用例，你将获得下一个测试用例的 $n$ 值；
- 否则，表示所有测试用例已正确解决，你的程序可正常终止。

注意：提交答案不计入询问次数。

注意：交互器可能在选择返回的点时具有自适应性。换言之，返回点的选择可能受到多种因素影响（包括但不限于点的排列和之前的询问）。但需注意，点的序列永远不会被改变。

每次输出询问后，请勿忘记换行并刷新$^{\text{∗}}$输出缓冲区。否则，你将收到 Idleness limit exceeded 的判定结果。

若在交互过程中读取到 $-1$ 而非有效数据，你的程序必须立即终止。这意味着你的程序将因无效询问或其他错误被判定为 Wrong answer。未能终止可能导致任意判定结果，因为程序会继续从已关闭的流中读取数据。

Hacks

本题禁用 hack。你的解法将在恰好 $\mathbf{35}$ 个输入文件（包括示例输入）上进行评测。

$^{\text{∗}}$ 刷新缓冲区的方法：

- C++ 使用 `fflush(stdout)` 或 `cout.flush()`；
- Python 使用 `sys.stdout.flush()`；
- 其他语言请参考文档。

## 说明/提示

第一个测试用例中的点为 $(3,0),(0,3),(5,2),(3,1),(2,2),(4,4)$。

三次询问对应的三角形如下：

![](https://cdn.luogu.com.cn/upload/vjudge_pic/CF2074E/e516ed9e8799abe3210fe85d082a2aa0f40e533f.png)  

可以看到，由 $(0,3)$、$(2,2)$、$(4,4)$ 构成的三角形内部不含其他隐藏点，因此是一个有效答案。

注意：交互示例仅展示合法的交互流程，不一定是实际响应。例如，当查询 "? 1 2 3" 时，主持人可能返回 $4$。但由于主持人不会改变点的序列，因此不会对同一查询返回 $6$。

第二个测试用例中仅有 $3$ 个点。因此，由这三点构成的唯一三角形内部不含其他隐藏点。

翻译由 DeepSeek R1 完成

## 样例 #1

### 输入

```
2
6

5

4

0

3
```

### 输出

```
? 1 2 3

? 1 5 3

? 2 5 6

! 2 5 6

! 1 2 3
```



---


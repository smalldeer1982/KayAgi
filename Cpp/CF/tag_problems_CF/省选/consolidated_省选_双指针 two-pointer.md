---
title: "Segmentation Folds"
layout: "post"
diff: 省选/NOI-
pid: CF2041F
tag: ['二分', '素数判断,质数,筛法', '双指针 two-pointer']
---

# Segmentation Folds

## 题目描述

Peter 喜欢折线段玩。有一条线段位于数轴上的区间 $[\ell, r]$。现如今正是折叠线段的好时机，Peter 决定小心翼翼地对这条线段进行折叠。每次操作中，他可以选择以下两种方式之一（在可能的情况下）：

1. 操作 $\tt{LTR}$：他从左向右折线段，使得左端点 $\ell$ 与某个点 $x$ 重合（$\ell < x \le r$），并且 $\ell + x$ 是质数。当他选择此操作时，总是选取最大的 $x$ 值。折叠后，线段所在的区间变为 $[\frac{1}{2}(\ell + x), r]$。
   
2. 操作 $\tt{RTL}$：他从右向左折线段，使得右端点 $r$ 与某个点 $x$ 重合（$\ell \le x < r$），并且 $r + x$ 是质数。当他选择此操作时，总是选取最小的 $x$ 值。折叠后，线段所在的区间变为 $[\ell, \frac{1}{2}(r + x)]$。

一个折叠序列是指这两种操作的组合。Peter 想要通过多次折叠，使线段的长度尽可能短，且无法再缩短。区间的长度自然定义为 $r - \ell$。考虑以下例子：假设我们折叠一段初始为 $[1, 30]$ 的线段。有三种折叠方式能使最终区间长度最短，如下图所示。

![](https://cdn.luogu.com.cn/upload/vjudge_pic/CF2041F/be032bc113ac39f401b84d34f2c5f31947b110d1.png)

请你帮助 Peter 确定有多少种不同的折叠序列可以使线段达到最短长度。结果需要对 $998244353$ 取模。

注：一个大于 $1$ 的整数 $p$ 是质数，当且仅当不存在整数 $a, b > 1$ 使得 $p = ab$。

## 输入格式

第一行包含一个整数 $t$，表示测试用例的数量。接下来的 $t$ 行中，每行包含两个整数 $\ell$ 和 $r$。

- $1 \le t \le 10$
- $1 \le \ell < r \le 10^{12}$
- $r - \ell \le 10^5$

## 输出格式

对于每个测试用例，输出一行，表示能将给定线段折叠到最短长度的折叠序列数量，结果对 $998244353$ 取模。

 **本翻译由 AI 自动生成**

## 样例 #1

### 输入

```
3
1 30
16 18
142857 240135
```

### 输出

```
3
1
63
```



---

---
title: "Wonderful Impostors"
layout: "post"
diff: 省选/NOI-
pid: CF2096F
tag: ['线段树', '二分', '双指针 two-pointer']
---

# Wonderful Impostors

## 题目描述

你是一位名为 Gigi Murin 的骄傲主播。今天，你将与编号为 $1$ 到 $n$ 的 $n$ 名观众进行一场游戏。

在游戏中，每位玩家要么是船员，要么是冒名顶替者。你并不知道每位观众的角色。

共有 $m$ 条编号为 $1$ 到 $m$ 的陈述，每条陈述要么为真，要么为假。对于每条从 $1$ 到 $m$ 的 $i$，陈述 $i$ 属于以下两种类型之一：

- $0\:a_i\:b_i$（$1 \leq a_i \leq b_i \leq n$）——在观众 $a_i, a_i + 1, \ldots, b_i$ 中没有冒名顶替者；
- $1\:a_i\:b_i$（$1 \leq a_i \leq b_i \leq n$）——在观众 $a_i, a_i + 1, \ldots, b_i$ 中至少有一名冒名顶替者。

回答 $q$ 个以下形式的问题：

- $l\:r$（$1 \leq l \leq r \leq m$）——陈述 $l, l + 1, \ldots, r$ 是否可能全部为真？

注意，题目不保证所有观众中至少有一名冒名顶替者，也不保证所有观众中至少有一名船员。

## 输入格式

每个测试包含多个测试用例。第一行包含测试用例的数量 $t$（$1 \le t \le 10^4$）。接下来是测试用例的描述。

每个测试用例的第一行包含两个整数 $n$ 和 $m$（$1 \leq n, m \leq 2 \cdot 10^5$）——观众的数量和陈述的数量。

接下来的 $m$ 行中，第 $i$ 行包含三个整数 $x_i$、$a_i$ 和 $b_i$（$x_i \in \{0, 1\}$，$1 \leq a_i \leq b_i \leq n$）——描述第 $i$ 条陈述。

接下来一行包含一个整数 $q$（$1 \le q \le 2 \cdot 10^5$）——问题的数量。

接下来的 $q$ 行中，每行包含两个整数 $l$ 和 $r$（$1 \leq l \leq r \leq m$）——描述一个问题。

保证所有测试用例的 $n$ 之和不超过 $2 \cdot 10^5$，所有测试用例的 $m$ 之和不超过 $2 \cdot 10^5$，且所有测试用例的 $q$ 之和不超过 $2 \cdot 10^5$。


## 输出格式

对于每个问题，如果请求的陈述可能全部为真，则输出 "YES"；否则输出 "NO"。

答案可以以任意大小写形式输出（例如，"yEs"、"yes"、"Yes" 和 "YES" 均被视为肯定回答）。


## 说明/提示

在第一个测试用例中，有 $4$ 名观众和 $3$ 条陈述。陈述如下：

- 陈述 $1$：在观众 $1$、$2$ 和 $3$ 中至少有一名冒名顶替者；
- 陈述 $2$：在观众 $2$、$3$ 和 $4$ 中至少有一名冒名顶替者；
- 陈述 $3$：在观众 $2$ 和 $3$ 中没有冒名顶替者。

可以看出，陈述 $1$、$2$ 和 $3$ 可能全部为真。例如，以下是其中一种可能的情况：

- 观众 $1$ 是冒名顶替者；
- 观众 $2$ 是船员；
- 观众 $3$ 是船员；
- 观众 $4$ 是冒名顶替者。

在第二个测试用例中，有 $5$ 名观众和 $2$ 条陈述。陈述如下：

- 陈述 $1$：在观众 $1$、$2$、$3$、$4$ 和 $5$ 中至少有一名冒名顶替者；
- 陈述 $2$：在观众 $1$、$2$、$3$、$4$ 和 $5$ 中没有冒名顶替者。

可以看出，陈述 $1$ 可能为真，陈述 $2$ 也可能为真。然而，陈述 $1$ 和 $2$ 不可能同时为真。

翻译由 DeepSeek V3 完成

## 样例 #1

### 输入

```
4
4 3
1 1 3
1 2 4
0 2 3
1
1 3
5 2
0 1 5
1 1 5
3
1 1
2 2
1 2
1 2
0 1 1
1 1 1
2
1 1
2 2
7 9
1 2 2
1 4 5
0 5 6
1 2 2
1 1 1
0 4 7
0 3 7
0 2 7
0 6 6
5
1 5
2 6
3 7
4 8
5 9
```

### 输出

```
YES
YES
YES
NO
YES
YES
YES
NO
YES
NO
YES
```



---


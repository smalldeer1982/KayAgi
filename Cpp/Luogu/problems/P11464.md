---
title: "支配剧场"
layout: "post"
diff: 普及/提高-
pid: P11464
tag: ['O2优化']
---
# 支配剧场
## 题目背景

> May all the beauty be blessed. 
## 题目描述

布洛妮娅和符华在寻找琪亚娜的途中，被支配之律者困在了支配剧场的高塔回廊之中。布洛妮娅敏锐地发现，虚无回廊是由一些支配之律者生成的积木构成的，只要击碎其中一些积木，就能解除空间的限制，让她们逃出高塔回廊。

具体来说，整个高塔回廊可以由一张高为 $n$，宽为 $m$ 的地图表示。第 $1$ 行为空间的最高点，第 $n$ 行为空间的最低点。高塔由 $K$ 块积木堆叠而成，符华每次可以击碎高塔中任意的积木，但必须保证高塔不会倒塌（否则她们会落入虚数空间），以及击碎积木后，高塔回廊的高度不变（即不能把最顶层的积木全部击碎）。

如果一块积木最底层的长度是 $L$，那么当且仅当其**最底层**与地板或者其他积木的接触面积 $L'$ 满足 $L' \ge \left\lceil \frac{L}{2} \right\rceil$ 时，这块积木不会失去平衡。当所有积木**都**不失去平衡时，我们认为整个高塔回廊**不会倒塌**。

积木的最底层长度被定义为**积木行坐标最大的方块总个数**。例如：

```
0 1 0
1 1 1
0 1 0
```
这张图中，$1$ 号积木的最底层长度是 $1$，因为其所占的格子中，行坐标最大的只有一个格子 $(3,2)$。

请帮布洛妮娅计算一下，符华最多能击碎多少个积木？
## 输入格式

第一行两个整数 $n,m$, 表示地图范围。

接下来 $n$ 行，每行 $m$ 个整数。第 $i$ 行第 $j$ 个整数 $a_{i,j}$，表示第 $i$ 行第 $j$ 列的格子属于第 $a_{i,j}$ 块积木。若 $a_{i,j} = 0$，则这个位置是空的。
## 输出格式

一行一个整数，表示符华能击碎的最多的积木块数。
## 样例

### 样例输入 #1
```
5 3
2 2 2
2 3 1
2 3 1
2 3 1
1 1 1
```
### 样例输出 #1
```
1
```
### 样例输入 #2
```
5 5
0 0 2 2 2
3 3 2 2 2
3 3 3 2 2
1 2 2 2 4
1 1 1 2 4
```
### 样例输出 #2
```
3
```
## 提示

$1\leq n,m\leq 30$，积木块数 $K$ 满足 $1\leq K \leq 15$，且保证高塔初始一定不会倒塌，同一块积木一定是一个四联通块。

**【样例 1 解释】**

符华可以击碎 $3$ 号积木，这不会导致高塔坍塌，也不会降低高塔的高度。可以证明没有更优的方案。

**【样例 2 解释】**

可以击碎 $1,3,4$ 号积木。

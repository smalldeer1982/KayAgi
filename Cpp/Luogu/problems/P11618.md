---
title: "[PumpkinOI Round 1] 造树据"
layout: "post"
diff: 省选/NOI-
pid: P11618
tag: ['2025', 'Special Judge', 'O2优化', '树形 DP', '哈希 hashing', '洛谷比赛']
---
# [PumpkinOI Round 1] 造树据
## 题目背景

> 拍上了，舒服。
## 题目描述

小 P 正在造数据对拍，可是他拍了 $114514$ 组都没有拍出来。他去请教大佬，但被大佬 D 了，他被告知他随机生成树的期望高度是 $O(\log n)$ 的，强度不够。

小 P 很难过，以至于无法思考。所以他想请问你，对于他给出的任意一棵**无根树**，以他的随机生成方式，生成出与其形态相同的树即与其**同构**的树的概率。

小 P 随机生成一棵**无根树**的方式为：

- 对于 $2\le i\le n$ 的结点，等概率向 $[1,i-1]$ 中连一条边 
## 输入格式

第一行输入一个正整数 $n$。

接下来 $2$ 至 $n$ 行，每行输入两个正整数 $u,v$，表示在 $u$ 和 $v$ 之间连一条边。

保证输入的数据是一棵树。
## 输出格式

输出一行一个非负整数，表示概率对 $998244353$ 取模的值。
## 样例

### 样例输入 #1
```
3
1 3
2 3
```
### 样例输出 #1
```
1
```
### 样例输入 #2
```
5
5 3
2 3
1 4
4 3
```
### 样例输出 #2
```
83187030
```
### 样例输入 #3
```
5
1 3
4 1
2 4
3 5
```
### 样例输出 #3
```
332748118
```
## 提示

**本题采用子任务捆绑/依赖**

对于 $10\%$ 的数据，保证 $2\le n\le 10$。

对于 $30\%$ 的数据，保证 $2\le n\le 20$。

对于 $50\%$ 的数据，保证 $2\le n\le 10^3$。

对于另外 $10\%$ 的数据，保证给出的是一条链。

对于另外 $10\%$ 的数据，保证给出的树按照题面中小 P 随机生成树的方式生成。

对于 $100\%$ 的数据，$2\le n\le 5\times 10^5$。


---
title: "[THUPC 2025 决赛] 好串"
layout: "post"
diff: 提高+/省选-
pid: P12057
tag: ['2025', 'THUPC']
---
# [THUPC 2025 决赛] 好串
## 题目描述

对于三个长度为 $n$ 的 01 字符串 $s_1,s_2,s_3$，称长度为 $n$ 的 01 字符串 $t$ 是**好的**当且仅当 $\forall 1 \le i,j \le n, \exists k \in \{1,2,3\}, s_{k,i} = t_i, s_{k,j} = t_j$。设 $f(s_1,s_2,s_3)$ 为这样的好的串的数量。

现在我们有三个长度为 $n$ 的随机 01 字符串 $s_1,s_2,s_3$，其中 $s_i (1 \le i \le 3)$ 的第 $j (1 \le j \le n)$ 个字符有 $\frac{p_{i,j}}{9}$ 的概率为 `1`，$\left(1 - \frac{p_{i,j}}{9}\right)$ 的概率为 `0`，其中 $p_{i,j}$ 是一个 $0$ 至 $9$ 的整数。所有的随机事件是独立的。你需要求 $f(s_1,s_2,s_3)$ 的期望，对 $998244353$ 取模。
## 输入格式

输入第一行一个整数 $n\ (3 \le n \le 3 \times 10^5)$ 表示字符串长度，接下来一个 $3$ 行 $n$ 列的数字矩阵，其中第 $i$ 行第 $j$ 列的字符表示 $p_{i,j}$。
## 输出格式

输出一个整数表示答案对 $998244353$ 取模的值。


## 样例

### 样例输入 #1
```
3
900
090
009

```
### 样例输出 #1
```
4

```
### 样例输入 #2
```
3
999
999
999

```
### 样例输出 #2
```
1

```
### 样例输入 #3
```
10
0123456789
1234567890
2345678901

```
### 样例输出 #3
```
612360617

```
## 提示

### 样例 #1 解释

在该组样例中，$s_1, s_2, s_3$ 分别为 `100`, `010`, `001`，四种方案分别为 `100`、`010`、`001`、`000`。


### 来源与致谢

来自 THUPC2025（2025 年清华大学学生程序设计竞赛暨高校邀请赛）决赛。感谢 THUSAA 的提供的题目。

数据、题面、标程、题解等请参阅 THUPC 官方仓库 <https://thusaac.com/public>。

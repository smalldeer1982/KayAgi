---
title: "『STA - R9』真空介电常数"
layout: "post"
diff: NOI/NOI+/CTSC
pid: P12265
tag: ['数学', '多项式', 'O2优化', '生成函数']
---
# 『STA - R9』真空介电常数
## 题目背景

请注意：题目背景与题目**可能没有**关系。

这天，小周在学习很快的筛法，他对洲阁筛 $O\left(\frac{n^{3/4}}{\log n}\right)$ 复杂度的记号很不满。为什么一个不需要使用 bitset 的算法，它的复杂度里要有除法？

小周突然有了一个好的想法。由于对数函数的阶低于幂函数，我们让 $\epsilon$ 表示无穷小，就可以让 $\log n = O(n^\epsilon)$ 了！这样，小周兴冲冲地想，我们可以直接让 $\log n$ 对应某个特定的无穷小 $\epsilon _0$，于是洲阁筛的复杂度就可以被记成 $O(n^{3/4 - \epsilon_0})$ 了！

真好看啊！

这时一个 whk 同学走了过来。

“你们信息学，怎么还需要真空介电常数啊？”
## 题目描述

给定正整数 $n, m, s$，保证 $\gcd(n, s) = 1$。求
$$\sum_{k = 1}^{n-1} \sin^{-2m} \left(\frac{ks}{n}\pi\right)$$
在模 $998244353$ 意义下的值。

可以证明答案一定是有理数，关于有理数如何取模可以参考 [P2613 有理数取余](/problem/P2613)。
## 输入格式

一行三个正整数 $n, m, s$。
## 输出格式

一行一个整数，表示答案在模 $998244353$ 意义下的值。
## 样例

### 样例输入 #1
```
4 3 1
```
### 样例输出 #1
```
17
```
### 样例输入 #2
```
11451 19198 11451419198
```
### 样例输出 #2
```
473735219
```
## 提示

| $\textbf{Subtask}$ | $n\le$ | $m\le$ | $s\le$ | 分值 |
| :-----------: | :-----------: | :-----------: | :-----------: | :-----------: |
| $1$ | $3$ | $3$ | $1$ | $5$ |
| $2$ | $10^5$ | $1$ | $1$ | $10$ |
| $3$ | $10^5$ | $50$ | $10^{18}$ | $20$ | 
| $4$ | $50$ | $10^5$ | $10^{18}$ |  $20$ | 
| $5$ | $10^5$ | $10^{18}$ | $10^{18}$ |  $45$ | 

对所有数据，保证 $1\le n \le 10^5$，$1\le m,s \le 10^{18}$。

提示：请选手注意复杂度中的常数因子对程序运行效率的影响。

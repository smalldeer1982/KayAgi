---
title: "[THUPC 2025 决赛] 一个 01 串，n 次三目运算符，最后值为 1（加强版）"
layout: "post"
diff: NOI/NOI+/CTSC
pid: P12294
tag: ['Special Judge', '状态合并', '有限状态自动机', '构造']
---
# [THUPC 2025 决赛] 一个 01 串，n 次三目运算符，最后值为 1（加强版）
## 题目背景

关于 $a,b,c$ 的三目运算表 $s_0s_1\cdots s_7$（$s$ 仅由 `0,1` 组成）的含义是，如果 $s$ 的第 $a+2b+4c$ 位为 `1`，那么返回 $1$，否则返回 $0$。

本题参考了 [[THUPC 2025 决赛] 一个 01 串，n 次三目运算符，最后值为 1](https://www.luogu.com.cn/problem/P12055)。
## 题目描述

给定运算表 $s$ 以及 $q$ 个长为 $2n+1$ 的 01 串，你需要对于对每个 01 串分别回答：

能否操作 $n$ 次，每次将三位连续的数字替换为所对应的运算值，使得运算的结果为 $1$，或判断无解。
## 输入格式

第一行为长度为 $8$ 的字符串 $s$ 以及给定询问串数量 $q$。

接下去 $q$ 行，每行一个长为奇数的 01 串，表示给定的字符串。
## 输出格式

对于每组询问输出一行，如果无解输出 `-1`，否则，输出一个由 `0,1,(,)` 组成的字符串描述运算方式及顺序，具体而言，计算的时候，会按照括号从内到外，从左到右的顺序依次解析括号，将对应的数字替换为运算结果，你需要保证每次运算时参与计算的运算数恰好为 $3$，具体可参见样例输出。
## 样例

### 样例输入 #1
```
00011011 2
10101
00000
```
### 样例输出 #1
```
((101)01)
-1
```
### 样例输入 #2
```
00010111 4
11100
11000
10100
10000
```
### 样例输出 #2
```
(11(100))
(11(000))
-1
-1
```
## 提示

### 样例 #1 解释

本样例即为 [THUPC 2025 决赛] 一个 01 串，n 次三目运算符，最后值为 1 一题中的样例。

### 样例 #2 解释

本样例即为 [AGC022E] Median Replace 一题中的样例。

### 数据范围

本题共 $256$ 个测试点，其中测试点编号为 $i(1\le i\le256)$ 的 $s$ 为 $i-1$ 的二进制表达（低位在前，高位在后），其中每个测试点输入的单个字符串长度不超过 $10^5$，字符串长度总和不超过 $3\times10^5$。

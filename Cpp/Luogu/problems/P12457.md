---
title: "[JOI2025 预选赛 R2] 台球"
layout: "post"
diff: 普及/提高-
pid: P12457
tag: ['2024', 'JOI（日本）']
---
# [JOI2025 预选赛 R2] 台球
## 题目描述

比太郎在玩台球。JOI 国的台球是使用摆在台上的 $N$ 个球 $1,2,\ldots,N$ 的游戏，台上设有落球用的洞。落在洞里的球不会放回台上，那个球也不能再一次落洞。比太郎的目的是尽量把写有大号码的球落在洞里。

打球是一项需要集中注意力的工作。初始，比太郎的注意力是 $X$，击打球 $i$（$1≤i≤N$）后集中力减少 $A_i$。集中力不足 $A_i$ 时，不能击打球 $i$。

另外，在该台球中存在关于落球顺序的规则，具体来说，$P_i=-1$（$1≤i≤N$）时，球 $i$ 可以随时落下，$P_i ≠ -1$ 时，为了使球 $i$ 落下，球 $P_i$ 必须已经落下。

当给出了比太郎所具有的集中力和各球的信息时，判定比太郎是否能够将球击落洞中，在能够击落下球的情况下，求出能够落下的球的编号的最大值。
## 输入格式

输入数据以如下格式给出：
$$
\begin{aligned}
&N\ X\\
& A_1\ A_2\ \cdots\ A_N\\
&P_1\ P_2\ \cdots\ P_N\\
\end{aligned}
$$
## 输出格式

输出一行一个整数，为比太郎击落的球的编号最大值。

如果比太郎无法击落球，输出 $-1$。
## 样例

### 样例输入 #1
```
6 7
1 2 4 3 10 100
-1 -1 -1 -1 -1 -1
```
### 样例输出 #1
```
4
```
### 样例输入 #2
```
5 12
1 2 3 5 8
-1 1 2 3 4
```
### 样例输出 #2
```
4
```
### 样例输入 #3
```
8 10
3 1 4 1 5 9 2 6
-1 1 2 -1 4 4 5 7
```
### 样例输出 #3
```
7
```
### 样例输入 #4
```
2 1000000000000000
1 1
2 1
```
### 样例输出 #4
```
-1
```
### 样例输入 #5
```
9 2468024680
123456789 234567891 345678912 456789123 567891234 678912345 789123456 891234567 912345678
6 5 4 -1 3 2 1 9 8
```
### 样例输出 #5
```
6
```
## 提示

### 样例解释

#### 样例 #1
首先，比太郎的集中力是 $7$。
对于所有的 $i$（$1≤i≤N$），由于 $P_i=-1$，所以只要集中力足够，所有的球都可以随时掉到洞里。

例如，如下所示，比太郎可以击落 $4$ 个球。

- 首先，把球 $3$ 打到洞里，比太郎的集中力减少了 $4$，剩下的集中力为 $3$。
- 接着，把球 $4$ 打到洞里，比太郎的集中力减少了 $3$，剩下的集中力为 $0$。
- 另外，比太郎不能把球 $5,6$ 打到洞里。因此，比太郎可以掉到洞里的球的号码的最大值是 $4$。

### 数据范围

- $1 \leq  N \leq 200 000$
- $1 \leq  X \leq  10^{15}$
- $1 \leq A_i \leq 10^9 (1 \leq i \leq N)$
- $1 \leq P_i \leq N$ 或 $P_i = -1(1 \leq  i \leq N)$
- $P_i \neq i (1 \leq i \leq N)$

子任务如下：

1. （6 分）$N \leq1000, P_i = -1 (1 \leq i \leq N)$
2. （9 分）$N \leq1000, P_1 = -1, P_i = i-1 (2 \leq i \leq N)$
3. （16 分）$N \leq 1000, P_i < i (1 \leq i \leq  N)$．
4. （20 分）$P_i < i (1 \leq i \leq N)$
5. （19 分）$N \leq 1000$
6. （30 点）无其他限制

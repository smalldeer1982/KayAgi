---
title: "[Math×Girl] 平均律"
layout: "post"
diff: 提高+/省选-
pid: P12469
tag: ['数论', 'O2优化', '莫比乌斯反演', '逆元', 'Stern-Brocot 树']
---
# [Math×Girl] 平均律
## 题目背景

>只见盈盈的双手在键盘上游移，速度越来越快。毫无秩序的音符间填上了其他的音符。一堆杂乱无章的音符中诞生了小小的图案，然后无数的图案开始交织，形成了更大的图案。  
>然后，就从离散走向了连续!

_※ 为了题面的简洁性，我删去了其中与音乐有关的内容。_
## 题目描述

我们定义一个数的近似分数为：  
在允许的误差内分母最小的分数。  
_※ 这里允许分数的分母为 $1$。_

请问允许的误差为 $\pm\delta$ 时，  
任选一数 $\xi\in[0,1]$，  
其近似分数的分母为 $n$ 的概率是多少？
## 输入格式

本题有多组数据，第一行输入一个整数 $T$，表示数据组数。  

对于每一组询问，我们给出 $n,a,b$，  
为了避免浮点误差，令 $\delta=\frac ab$。  

## 输出格式

对于每组数据，一行输出一个数表示概率。  
为了避免整型溢出，输出分数对 $998244353$ 取模后的结果即可。  

## 样例

### 样例输入 #1
```
3
3 1 9
3 2 35
114514 233 87654321
```
### 样例输出 #1
```
332748118
969723086
590198578
```
## 提示

### 样例解释

第一个例子取模前的结果为 $\frac{1}{3}$。  
第二个例子取模前的结果为 $\frac{8}{35}$。  

### 数据范围

**UPD：$n=1$ 时对于子任务限制的描述不正确，请进行特判。**

| 子任务 | 分值 | 限制 |
| :----------: | :----------: | :----------: |
| $0$ | $10$ | $\frac{1}{n}<\delta,n\in[1,10^6]$ |
| $1$ | $10$ | $\delta<\frac{1}{2n^2},n\in[1,10^6]$ |
| $2$ | $15$ | $n\in[1,10^3]$ |
| $3$ | $15$ | $n\in[1,10^4]$ |
| $4$ | $15$ | $n\in[1,10^5]$ |
| $5$ | $15$ | $n\in[1,2\times10^6]$ |
| $6$ | $20$ | $T=1$ |

对于 $100\%$ 数据，保证 $T\in[1,5],n\in[1,10^7],a,b\in[1,10^{18}],998244353\nmid b$。

对于计算有理数取模的方法，请参考[模板题](https://www.luogu.com.cn/problem/P2613)。

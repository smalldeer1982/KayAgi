---
title: "连号子序列数"
layout: "post"
diff: 普及-
pid: P12600
tag: []
---
# 连号子序列数
## 题目背景

原题来自 [2025 年洛谷愚人节比赛](https://www.luogu.com.cn/contest/231658)的 [B 题](T568868)。

---

本题是[连号区间数](P8600)的加强版。
## 题目描述

小 S 这些天一直在思考这样一个奇怪而有趣的问题：

在 $1\sim N$ 的某个全排列中有多少个连号子序列呢？这里所说的连号子序列的定义是：

如果一个子序列里的所有元素递增排序后能得到一个“连续”数列，则称这个子序列连号子序列。

当 $N$ 很小的时候，小 S 可以很快地算出答案，但是当 $N$ 变大的时候，问题就不是那么简单了，现在小 S 需要你的帮助。
## 输入格式

第一行是一个正整数 $N (1 \le N \le 500000)$，表示全排列的规模。

第二行是 $N$ 个不同的数字 $P_i(1 \le P_i \le N)$，表示这 $N$ 个数字的某一全排列。
## 输出格式

输出一个整数，表示不同连号子序列的数目。
## 样例

### 样例输入 #1
```
2
2 1
```
### 样例输出 #1
```
3
```
## 提示

对于 $20\%$ 的数据，$N\le 20$。

对于 $40\%$ 的数据，$N\le 500$。

对于 $60\%$ 的数据，$N\le 5000$。

对于 $100\%$ 的数据，$N\le 500000$。

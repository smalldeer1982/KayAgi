---
title: "[GCJ 2013 Qualification] Treasure"
layout: "post"
diff: 省选/NOI-
pid: P13284
tag: ['图论', '2013', '欧拉回路', 'Google Code Jam']
---
# [GCJ 2013 Qualification] Treasure
## 题目描述

Following an old map, you have stumbled upon the Dread Pirate Larry's secret treasure trove!

The treasure trove consists of $N$ locked chests, each of which can only be opened by a key of a specific type. Furthermore, once a key is used to open a chest, it can never be used again. Inside every chest, you will of course find lots of treasure, and you might also find one or more keys that you can use to open other chests. A chest may contain multiple keys of the same type, and you may hold any number of keys.

You already have at least one key and your map says what other keys can be found inside the various chests. With all this information, can you figure out how to unlock all the chests?

For example, suppose the treasure trove consists of four chests as described below, and you began with exactly one key of type $1$:

| Chest Number | Key Type To Open Chest | Key Types Inside |
| :---: | :---: | :---: |
| 1 | 1 | None |
| 2 | 1 | 1, 3 |
| 3 | 2 | None |
| 4 | 3 | 2 |

You can open all the chests in this example if you do them in the order $2$, $1$, $4$, $3$. If you start by opening chest #1 first, then you will have used up your only key, and you will be stuck.

## 输入格式

The first line of the input gives the number of test cases, $T$. $T$ test cases follow. Each test case begins with a single line containing two positive integers $K$ and $N$, representing the number of keys you start with and the number of chests you need to open.

This is followed by a line containing $K$ integers, representing the types of the keys that you start with.

After that, there will be $N$ lines, each representing a single chest. Each line will begin with integers $T_i$ and $K_i$, indicating the key type needed to open the chest and the number of keys inside the chest. These two integers will be followed by $K_i$ more integers, indicating the types of the keys contained within the chest.
## 输出格式

For each test case, output one line containing "Case #x: $C_1$ $C_2$ ... $C_N$", where $x$ is the case number (starting from $1$), and where $C_i$ represents the index (starting from $1$) of the $i^{th}$ chest that you should open.

If there are multiple ways of opening all the chests, choose the "lexicographically smallest" way. In other words, you should choose to make $C_1$ as small as possible, and if there are multiple ways of making $C_1$ as small as possible, choose the one that makes $C_2$ as small as possible, and so on.

If there is no way to open all the chests, you should instead output one line containing "Case #x: IMPOSSIBLE".
## 样例

### 样例输入 #1
```
3
1 4
1
1 0
1 2 1 3
2 0
3 1 2
3 3
1 1 1
1 0
1 0
1 0
1 1
2
1 1 1
```
### 样例输出 #1
```
Case #1: 2 1 4 3
Case #2: 1 2 3
Case #3: IMPOSSIBLE
```
## 提示

**Limits**

- $1 \leq T \leq 25.$
- $1 \leq K.$
- All key types will be integers between $1$ and $200$ inclusive.

**Small dataset (20 Pts, Test set 1 - Visible)**

- $1 \leq N \leq 20.$
- In each test case, there will be at most $40$ keys altogether.

**Large dataset (60 Pts, Test set 2 - Hidden)**

- $1 \leq N \leq 200.$
- In each test case, there will be at most $400$ keys altogether.

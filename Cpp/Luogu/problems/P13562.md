---
title: "「WWOI R1」WsW 的田地"
layout: "post"
diff: 提高+/省选-
pid: P13562
tag: ['O2优化', '哈希 hashing', '前缀和', '差分']
---
# 「WWOI R1」WsW 的田地
## 题目背景

WsW 是会开心和生气的。
## 题目描述

WsW 和 bln 分别有一块田地。这两块田地都由 $n\times m$ 个格子组成，其中左上角格子的坐标为 $(1,1)$，右下角格子的坐标为 $(n,m)$。  

最开始，WsW 的田地里坐标为 $(x,y)$ 的格子中长着一株生长度为 $a_{x,y}$ 的禾苗；bln 的田地里坐标为 $(x,y)$ 的格子中长着一株生长度为 $b_{x,y}$ 的禾苗。  

在之后的每一天的开始，都会有一个小精灵在 **WsW 或 bln 的田地**中坐标为 $(x_0,y_0)$ 的格子上使用药水，药水分为三种：

- 药水 $1$，包括 $3$ 个参数，可以使这片田地内满足 $x=x_0$ **或** $y=y_0$ 的格子 $(x,y)$ 中禾苗的生长度增加 $k$。  
- 药水 $2$，包括 $5$ 个参数，可以使这片田地内满足 $x_0\le x\le x_0+u$ 且 $y_0\le y\le y_0+v$ 的格子 $(x,y)$ 中禾苗的生长度增加 $k$。  
- 药水 $3$，包括 $5$ 个参数，可以使这片田地内满足 $x_0\le x\le x_0+u$ 且 $y_0+x-x_0\le y\le y_0+x-x_0+v$ 的格子 $(x,y)$ 中禾苗的生长度增加 $k$。  

药水不会影响田地外的区域。  
**药水瞬间生效，且效果在一天结束后不会消失。**  

小精灵使用药水后，WsW 会查看自己和 bln 的田地。如果 WsW 的田地与 bln 的田地坐标相同的格子中禾苗的生长度都相等，那么 WsW 将会很开心；否则 WsW 会很生气。  


## 输入格式

第一行输入两个整数 $n,m$，表示田地的大小。  

接下来 $n$ 行，每行 $m$ 个数，表示最开始 WsW 田地格子中禾苗的生长度。  
接下来 $n$ 行，每行 $m$ 个数，表示最开始 bln 田地格子中禾苗的生长度。  

接下来一行一个正整数 $q$，表示共有 $q$ 天。  

接下来 $q$ 行，每行表示使用一次药水。首先读入两个整数 $t,f$。其中 $t$ 表示使用的药水类型，若 $f=0$ 表示对 WsW 的田地使用药水，若 $f=1$ 表示对 bln 的田地使用药水，接下来：

- 若 $t=1$，表示使用药水 $1$。接着输入 $3$ 个整数 $x_0,y_0,k$。  
- 若 $t=2$，表示使用药水 $2$。接着输入 $5$ 个整数 $x_0,y_0,k,u,v$。 
- 若 $t=3$，表示使用药水 $3$。接着输入 $5$ 个整数 $x_0,y_0,k,u,v$。
## 输出格式

输出共 $q$ 行，表示每天使用药水后 WsW 的心情。  
若 WsW 很开心，输出 `Happy`；若 WsW 很生气，输出 `Angry`。
## 样例

### 样例输入 #1
```
2 3
1 1 4
5 1 4
0 0 3
5 0 4
5
1 1 1 2 1
1 0 1 1 4
1 1 1 3 4
2 1 2 1 4 0 1
2 0 2 2 4 0 1
```
### 样例输出 #1
```
Happy
Angry
Angry
Angry
Happy
```
### 样例输入 #2
```
3 3
1 9 1
9 8 1
3 0 5
3 11 1
9 10 3
3 0 5
1
3 1 1 1 -2 1 1
```
### 样例输出 #2
```
Happy
```
## 提示

### 【样例 1 解释】
红色数字表示当天发生改变的格子中的生长值。  
![](https://cdn.luogu.com.cn/upload/image_hosting/xpcmfh4l.png)

可以发现，只有第 $1$ 天和第 $5$ 天两块田地中对应格子的生长值相同。

### 【数据范围】

**本题采用捆绑测试**。

对于所有测试数据，保证:
* $1\le n,m\le 800$，$1\le q\le 5\times 10^5$。
* 对于所有 $a_{x,y},b_{x,y}$，均有 $|a_{x,y}|,|b_{x,y}|\le 5\times 10^5$。
* $t\in \{1,2,3\}$，$f\in \{0,1\}$。
* $1\le x_0\le n$，$1\le y_0\le m$，$|k| \le 5\times 10^5$，$0\le u\le n$，$0\le v\le m$。  

|子任务编号|$n,m\le$|$q\le$| $\lvert a_{i,j}\rvert,\lvert b_{i,j}\rvert,\lvert k\rvert\le$ |特殊限制|分数|
|:-:|:-:|:-:|:-:|:-:|:-:|
|$1$| $100$ | $100$ | $100$ |保证没有 $t=3$ 的情况|$10$|
|$2$| ^ | ^ | ^ | 无 |$20$|
|$3$| $800$ | $5\times10^5$ | $5\times10^5$ |保证没有 $t=3$ 的情况|$30$|
|$4$| ^ | ^ | ^ | 无 |$40$|

---
title: "Clock Paradox"
layout: "post"
diff: 普及/提高-
pid: P13760
tag: ['数学', 'O2优化', '前缀和', '双指针 two-pointer']
---
# Clock Paradox
## 题目背景

![](https://cdn.luogu.com.cn/upload/image_hosting/a4u4v5x2.png)

（来自 phigros 曲绘，侵删）
## 题目描述

给定一个序列 $a$，要求区间 $[l,r]$ 满足 $a_l$ 至 $a_r$ 每个数只在该区间出现一次。设共 $t$ 个区间满足要求，编号为 $[l_1,r_1]$ 至 $[l_t,r_t]$。

求：

$$\sum_{i=1}^t\sum_{j=l_i}^{r_i}a_j$$

请将答案对 $10^9+7$ 取模。
## 输入格式

第一行输入一个自然数 $n$，表示序列长度。

第二行输入 $n$ 个非负整数，表示序列 $a$。
## 输出格式

一行一个非负整数，表示答案取模 $10^9+7$ 后的数。
## 样例

### 样例输入 #1
```
6
1 2 3 3 2 1
```
### 样例输出 #1
```
40
```
### 样例输入 #2
```
13
1 1 4 5 1 4 1 9 1 9 8 1 0
```
### 样例输出 #2
```
239
```
### 样例输入 #3
```
10 
5 4 3 2 5 6 1 3 1 4
```
### 样例输出 #3
```
315
```
## 提示

数据范围
| 测试点编号 | $n$ | $a_i$ | 特殊性质 |
| :-----------: | :-----------: | :-----------: |:-----------: |
| $1$ | $n\le2×10^5$ | $0\le a_i\le10^9$ | A |
| $2$ | $n\le2×10^5$ | $0\le a_i\le10^9$ | B |
| $3,4$ | $n\le 2×10^5$| $0\le a_i\le1$ | |
|$5,6$|$n\le500$|$0\le a_i\le10^9$ | |
|$7\sim10$|$n\le 5×10^3$|$0\le a_i\le n$| |
|$11\sim20$|$n\le2×10^5$|$0\le a_i\le10^9$| |

特殊性质 A：满足所有 $a_i$ 都相等。

特殊性质 B：满足所有 $a_i$ 都互不相等。

对于 $100\%$ 的数据，满足 $1\le n\le2×10^5,0\le a_i\le 10^9$。


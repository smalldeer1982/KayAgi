---
title: "[CERC 2022] Insertions"
layout: "post"
diff: 省选/NOI-
pid: P13812
tag: ['树状数组', '2022', 'KMP 算法', 'ICPC', 'CERC']
---
# [CERC 2022] Insertions
## 题目描述

We are given three strings, $s$, $t$ and $p$. We will denote the length of a string by vertical bars, thus $|s|$ is the length of $s$ and so on. If we insert $t$ into $s$ at position $k$, where $0 \leq k \leq |s|$, the result is a new string consisting of the first $k$ characters of $s$, followed by the entirety of $t$, and finally followed by the remaining $|s| - k$ characters of $s$. We would like to select $k$ so that the resulting new string will contain the largest possible number of occurrences of $p$ as a substring.

Thus, for example, inserting $t = \text{aba}$ into $s = \text{ab}$ at position $k = 0$ results in the string $\text{abaab}$; at $k = 1$, in the string $\text{aabab}$; and at $k = 2$, in the string $\text{ababa}$. If we are interested in occurrences of $p = \text{aba}$, then the best position to insert $t$ into $s$ is $k = 2$, where we get two occurrences: $\text{ababa}$ and $\text{ababa}$ (as this example shows, occurrences of $p$ are allowed to overlap). If, on the other hand, we were interested in occurrences of $p = \text{aa}$, then the best choices of $k$ would be $k = 0$ and $k = 1$, which result in one occurrence of $p$, whereas $k = 2$ results in 0 occurrences of $p$.

## 输入格式

The first line contains the string $s$, the second line the string $t$, and the third line the string $p$.
## 输出格式

Output one line containing the following four integers, separated by spaces:

1. The maximum number of occurrences of $p$ we can get after inserting $t$ into $s$ at position $k$, if we choose the position $k$ wisely.
2. The number of different $k$'s (from the range $0, 1, \ldots, |s|$) where this maximum number of occurrences of $p$ is attained.
3. The minimum value of $k$ where the maximum number of occurrences of $p$ is attained.
4. The maximum value of $k$ where the maximum number of occurrences of $p$ is attained.
## 样例

### 样例输入 #1
```
ab
aba
aba
```
### 样例输出 #1
```
2 1 2 2
```
### 样例输入 #2
```
abaab
aba
ababa
```
### 样例输出 #2
```
1 3 1 5
```
### 样例输入 #3
```
eeoeo
eoe
eeo
```
### 样例输出 #3
```
2 3 1 4
```
## 提示

### Comment

The first of these three examples is the one discussed earlier in the problem statement

### Input limits

- $1 \leq |s| \leq 10^5$
- $1 \leq |t| \leq 10^5$
- $1 \leq |p| \leq 10^5$
- All the strings consist only of lowercase letters of the English alphabet.

---
title: "[CERC 2023] Drying Laundry"
layout: "post"
diff: 提高+/省选-
pid: P13848
tag: ['动态规划 DP', '2023', 'ICPC', 'bitset', 'CERC']
---
# [CERC 2023] Drying Laundry
## 题目描述

Harry the Beaver runs a hotel and has to wash bed sheets every Sunday night for the next $Q$ weeks until the tourist season ends. On week $j$, he has $N$ freshly washed bed sheets that he wants to dry by hanging them on two parallel clotheslines of length $L_j$ each. The sheets can be hung next to each other but must not overlap. Each sheet is $d_i$ units wide and rather long, therefore he will always orient it so that it will take up $d_i$ units of the line when hung to dry. The sheets have different drying times that are not related to their sizes because of different materials. Thus, the $i$-th sheet needs $t_i^{\text{slow}}$ minutes to dry. However, if it is hung over both lines at the same time, it dries quicker in $t_i^{\text{fast}}$ minutes, but also takes up space on the other line. To avoid smelly sheets, Harry the Beaver has to start drying all of them immediately after washing, i.e. all sheets have to be hung simultaneously.

Harry the Beaver wants to go to sleep as soon as possible on Sundays, therefore, he asks you to help him determine the minimal required drying time for each week $j$, or inform him that it is impossible to finish drying the sheets that week.
## 输入格式

The first line contains an integer $N$, the number of sheets, and an integer $Q$, the number of weeks until the end of the tourist season. The next $N$ lines contain space-separated integers $d_i$, $t_i^{\text{fast}}$, and $t_i^{\text{slow}}$, which correspond to the width, the shorter drying time, and the longer drying time of the $i$-th sheet, respectively. The final $Q$ lines the the input contain integers $L_j$, $j$-th of which represents the length of the clothesline for week $j$.
## 输出格式

Print $Q$ lines, with $j$-th of them containing the minimal required drying time for week $j$, or "-1" (without the quotes) if it is impossible to finish drying the sheets that week.
## 样例

### 样例输入 #1
```
3 3
1 2 2
1 1 4
2 3 100
3
1
4
```
### 样例输出 #1
```
4
-1
3
```
## 提示

### Input limits

- $1 \leq N \leq 3 \cdot 10^4$
- $1 \leq Q \leq 3 \cdot 10^5$
- $1 \leq d_i \leq 3 \cdot 10^5$ for all $1 \leq i \leq N$
- $1 \leq t_i^{\text{fast}} \leq t_i^{\text{slow}} \leq 10^9$ for all $1 \leq i \leq N$
- $1 \leq L_j \leq 3 \cdot 10^5$ for all $1 \leq j \leq Q$

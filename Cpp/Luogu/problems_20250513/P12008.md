---
title: "【MX-X10-T4】[LSOT-4] Fragment of Memories"
layout: "post"
diff: 提高+/省选-
pid: P12008
tag: ['倍增', '双指针 two-pointer', '梦熊比赛']
---
# 【MX-X10-T4】[LSOT-4] Fragment of Memories
## 题目背景

甜与苦的一体两面。
## 题目描述

苏珊在昏迷前度过了 $m$ 天。从第一天起，苏珊会有一个基准记忆 $x$，第 $i$（$1\le i\le m$）天的记忆为 $x+i-1$。这 $m$ 天的记忆按顺序依次拼接，得到了一串长为 $m$ 的记忆。

在梦境中，这段记忆被按顺序重复了 $k$ 遍。在这之后，为了唤醒苏珊，露薇娅进入了梦境，记忆被插入了一些不属于苏珊的记忆，最终变为了一个长度为 $n$ 的序列 $a_1, \ldots, a_n$。

现在给你这个序列和 $k$。露薇娅不知道一开始的基准记忆 $x$ 是多少，所以他想知道对于所有的 $1\le x\le V$，$m$ 的值最大可能是多少。若对于一个 $x$ 不存在合法的记忆，输出 $0$。
## 输入格式

第一行，三个整数 $n,k,V$，意义如题面所示。

第二行，$n$ 个整数 $a_1, \ldots, a_n$，表示最终的序列。
## 输出格式

仅一行，$V$ 个整数，第 $i$ 个整数表示当 $x=i$ 时最大的可能的 $m$。
## 样例

### 样例输入 #1
```
9 2 5
2 1 3 4 5 2 3 2 4
```
### 样例输出 #1
```
0 3 2 1 0
```
### 样例输入 #2
```
30 3 8
3 4 5 5 1 2 8 4 5 3 6 4 5 7 5 6 6 7 6 8 7 1 8 2 3 2 7 3 7 8
```
### 样例输出 #2
```
0 2 1 2 1 2 2 1
```
## 提示

**【样例解释 #1】**

当 $x=2$、$m=3$ 时，苏珊的记忆是 `2 3 4`。重复了 $k=2$ 次变成了 `2 3 4 2 3 4`。在位置 $1$ 和位置 $2$ 中间、位置 $3$ 和位置 $4$ 中间、位置 $5$ 和位置 $6$ 中间分别插入了一个数后变成了原序列。

类似地，`2`、`3`、`4`、`2 3`、`3 4` 都是符合要求的记忆。

**【数据范围】**

**本题采用捆绑测试。**

- 子任务 1（13 分）：$n\le 100$。
- 子任务 2（21 分）：$n\le 3000$。
- 子任务 3（23 分）：$n\le 3\times10^4$。
- 子任务 4（25 分）：$n\le 5\times10^5$。
- 子任务 5（18 分）：无特殊性质。

对于全部的数据，$1\le k\le n\le 2\times 10^6$，$1\le a_i\le V\le n$。

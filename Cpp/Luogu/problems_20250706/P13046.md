---
title: "[GCJ 2021 Finals] Divisible Divisions"
layout: "post"
diff: 省选/NOI-
pid: P13046
tag: ['动态规划 DP', '数学', '2021', '数论', '中国剩余定理 CRT', 'Google Code Jam']
---
# [GCJ 2021 Finals] Divisible Divisions
## 题目描述

We have a string $\mathbf{S}$ consisting of decimal digits. A division of $\mathbf{S}$ is created by dividing $\mathbf{S}$ into contiguous substrings. For example, if $\mathbf{S}$ is 0145217, two possible divisions are 014 5 21 7 and 0 14 52 17. Each digit must be used in exactly one substring, and each substring must be non-empty. If $\mathbf{S}$ has $L$ digits, then there are exactly $2^{L-1}$ possible divisions of it.

Given a positive integer $\mathbf{D}$, a division of $\mathbf{S}$ is called divisible by $\mathbf{D}$ if for every pair of consecutive substrings, at least one of the integers they represent in base 10 is divisible by $\mathbf{D}$. If $\mathbf{D}=7$, the first example division above is divisible because 014, 21, and 7 represent integers divisible by 7. The second example division is not divisible because 52 and 17 are consecutive substrings and neither represents an integer divisible by 7. Dividing 0145217 as 0145217 is divisible by any $\mathbf{D}$ because there are no pairs of consecutive substrings.

Given $\mathbf{S}$ and $\mathbf{D}$, count how many divisions of $\mathbf{S}$ exist that are divisible by $\mathbf{D}$. Since the output can be a really big number, we only ask you to output the remainder of dividing the result by the prime $10^{9}+7$ ($1000000007$).
## 输入格式

The first line of the input gives the number of test cases, $\mathbf{T}$. $\mathbf{T}$ lines follow. Each line represents a test case with a string of digits $\mathbf{S}$ and a positive integer $\mathbf{D}$, as mentioned above.

## 输出格式

For each test case, output one line containing `Case #x: y`, where $x$ is the test case number (starting from 1) and $y$ is the number of different divisions of $\mathbf{S}$ that are divisible by $\mathbf{D}$, modulo the prime $10^{9}+7$ ($1000000007$).
## 样例

### 样例输入 #1
```
3
0145217 7
100100 10
5555 12
```
### 样例输出 #1
```
Case #1: 16
Case #2: 30
Case #3: 1
```
## 提示

**Sample Explanation**

In Sample Case #1, all $16$ divisible divisions of $\mathbf{S}$ are:

- 0145217,
- 0 145217,
- 0 14 5217,
- 0 14 5 217,
- 0 14 5 21 7,
- 0 14 521 7,
- 0 145 217,
- 0 145 21 7,
- 0 14521 7,
- 014 5217,
- 014 5 217,
- 014 5 21 7,
- 014 521 7,
- 0145 217,
- 0145 21 7, and
- 014521 7.

In Sample Case #2, there are $2^{5}=32$ ways to divide in total. To get two consecutive substrings to not be divisible by 10, we need both of them to not end in 0. The only 2 ways of doing that are $1 \ 001 \ 00$ and $1 \ 001 \ 0 \ 0$, which means the other 30 divisions of $\mathbf{S}$ are divisible by 10.

In Sample Case #3, no possible substring represents an even integer, which in turn means it is not divisible by 12. Therefore, the only way to not have two consecutive substrings that are not divisible by 12 is to not have two consecutive substrings at all, which can be done in only 1 way: 5555.

**Limits**

- $1 \leq \mathbf{T} \leq 100$.
- $1 \leq \mathbf{D} \leq 10^{6}$.

**Test Set 1 (10 Pts, Visible Verdict)**

- $1 \leq$ the length of $\mathbf{S} \leq 1000$.

**Test Set 2 (35 Pts, Hidden Verdict)**

- $1 \leq$ the length of $\mathbf{S} \leq 10^{5}$.

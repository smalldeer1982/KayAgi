---
title: "[GCJ 2015 #2] Drum Decorator"
layout: "post"
diff: 省选/NOI-
pid: P13227
tag: ['动态规划 DP', '2015', 'Pólya 定理', 'Google Code Jam']
---
# [GCJ 2015 #2] Drum Decorator
## 题目描述

You are the drummer in the rock band Denise and the Integers. Your drum is a cylinder around which you've wrapped a rectangular grid of cells.

Your band is scheduled to perform in Mathland. The Mathlanders are a tough audience, and they will expect every cell of your drum to contain a positive integer; zeroes and negative integers are not allowed. Moreover, each integer $\mathrm{K}$ must border (share an edge, and not just a point, with) exactly $\mathrm{K}$ other cells with the same integer -- that is, a cell with a 1 must touch exactly one other cell with a 1 , a cell with a 2 must touch exactly 2 other cells with a 2 , and so on. Apart from this restriction, it does not matter what other cells a cell touches. (The circular top and bottom of the drum do not count as cells and do not need to be decorated. Note that this means that the cells along the top and bottom of the drum only touch three other cells each, whereas all the other cells touch four other cells each.)

For example, this is a valid decoration of a cylinder formed by a grid with 3 rows and 5 columns:

![](https://cdn.luogu.com.cn/upload/image_hosting/irlqdayl.png)

(Imagine that the unseen two columns on the back of the drum are the same as the three visible columns.)

You want to know how many different valid decorations are possible. Two decorations are different if one cannot be rotated (around the cylinder's axis of symmetry) to produce the other. The top and bottom of a drum are considered different, so this decoration of a $3\times 5$ grid is different from the one above:

![](https://cdn.luogu.com.cn/upload/image_hosting/3aiizfme.png)

(Again, imagine that the unseen two columns on the back of the drum are the same as the three visible columns.)

Your drum has $\mathbf{R}$ rows and $\mathbf{C}$ columns. How many different valid decorations are possible? The number may be large, so return the number of decorations modulo $10^{9}+7$ ($1000000007$).
## 输入格式

The first line of the input gives the number of test cases, $\mathbf{T}$. $\mathbf{T}$ lines follow; each contains two space-separated integers, $\mathbf{R}$ and $\mathbf{C}$, which are the number of rows and columns in the drum.
## 输出格式

For each test case, output one line containing "Case #$x$: $y$", where $\mathrm{x}$ is the test case number (starting from 1) and $\mathrm{y}$ is the number of valid decorations modulo $10^{9}+7$, as described above.
## 样例

### 样例输入 #1
```
2
2 4
3 5
```
### 样例输出 #1
```
Case #1: 1
Case #2: 2
```
## 提示

**Sample Explanation**

In Case #1, the only solution is to fill all cells with 3s.

In Case #2, the only two solutions are the two depicted in the problem statement.

**Small dataset(11 Pts)**

- Time limit: ~~240~~ 5 seconds.
- $1 \leq \mathrm{T} \leq 20$.
- $2 \leq \mathrm{R} \leq 6$.
- $3 \leq \mathrm{C} \leq 6$.

**Large dataset(10 Pts)**

- Time limit: ~~480~~ 10 seconds.
- $1 \leq \mathrm{T} \leq 100$.
- $2 \leq \mathrm{R} \leq 100$.
- $3 \leq \mathrm{C} \leq 100$.

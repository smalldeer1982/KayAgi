# [Sloi 2024]D1T3 pi(n)

## 题目背景

![](https://cdn.luogu.com.cn/upload/image_hosting/3zet5xqo.png)

很多年前，zydy 突发奇想：只要算出 $\pi(n)\bmod2，\pi(n)\bmod3，\pi(n)\bmod5，···$，就能得到 $\pi(n)$。很多年后，zydy 才意识到这其实是可行的，现在你只需要帮助他算出 $\pi(n)\bmod2$。

## 题目描述

定义 $\pi(n)$ 为不大于 $n$ 的素数的个数，给定 $n$，计算 $\pi(n)\bmod 2$ 。

## 说明/提示

**本题采用捆绑测试**
| Subtask | T | n | Score |
| :----------: | :----------: | :----------: | :----------: |
| $1$ | $=1000$ | $\le 10^8$ | $20$ |
| $2$ | $=10$ | $\le 10^{11}$ | $20$ |
| $3$ | $=10$ | $\le 10^{13}$ | $20$ |
| $4$ | $=5$ | $\le 10^{15}$ | $20$ |
| $5$ | $=5$ | $\le 10^{16}$ | $20$ |

对 $100\%$ 的数据，$T\le 1000$，$1\le n\le 10^{16}$。

## 样例 #1

### 输入

```
3
1000
1000000
1000000000```

### 输出

```
0
0
0```

## 样例 #2

### 输入

```
1
23571113171923```

### 输出

```
1```

# 题解

## 作者：wkywkywky (赞：13)

考考你的注意力。

注意到 $\sum\limits_{i=1}^n 2^{\omega(i)} \equiv 1+\sum\limits_{p\in \mathbb{P},p^k\leq n}2 \pmod 4$。

其中 $\omega(n)$ 为 $n$ 含有不同的素因子的个数。

求出左式后，用筛法筛出 $p\in \mathbb{P},k\leq 2,p\leq n^\frac{1}{k}$ 的个数，就得到 $\pi(n) \bmod 2$ 的结果。

Lemma : $2^{\omega(n)}=\sum\limits_{d|n}\mu^2(d)$

注意到左右两边均为积性函数。

只需证明对 $n=p^k,p\in \mathbb{P}$ 的情况成立。

$2^{\omega(p^k)}=2=\mu^2(1)+\mu^2(p)$

显然成立，引理得证。

$\begin{aligned}
\sum\limits_{i=1}^n 2^{\omega(i)} &= \sum\limits_{i=1}^n \sum\limits_{d|i}\mu^2(d) \\
&=\sum\limits_{d=1}^n \mu^2(d)\lfloor \frac{n}{d} \rfloor \\
&=\sum\limits_{d=1}^n (\sum\limits_{k^2|d}\mu(k))\lfloor \frac{n}{d} \rfloor \\
&=\sum\limits_{k=1}^n\mu(k) \sum\limits_{i=1}^{\lfloor \frac{n}{k^2} \rfloor} \lfloor\frac{n}{ik^2}\rfloor \\
&=\sum\limits_{k=1}^n\mu(k) \sum\limits_{i=1}^{\lfloor \frac{n}{k^2} \rfloor} \sigma_{0}(i)
\end{aligned}$

对 $\lfloor \frac{n}{k^2} \rfloor$ 整除分块。

对 $\sigma_{0}(n)$ 求和使用 DIVCNT1 的做法。

考虑对 $n\leq V$ 线性筛出 $\sigma_{0}(n)$ 平衡复杂度。

$\frac{n}{k^2}>V \Rightarrow k<\sqrt{\frac{n}{V}}$

$\int_{1}^{(\frac{n}{V})^{1/2}} (\frac{n}{x^2})^{1/3}\ln {\frac{n}{x^2}}\mathrm{d} x=n^{1/2}V^{-1/6}\ln n$

$n^{1/2}V^{-1/6}\ln n=V$

$V=(n^{1/2}\ln n)^{6/7}$

时间复杂度 $O((n^{1/2}\ln n)^{6/7})$。

---


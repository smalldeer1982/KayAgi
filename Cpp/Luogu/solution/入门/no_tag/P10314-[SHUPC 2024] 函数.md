# [SHUPC 2024] 函数

## 题目描述

小 A 正在学习函数，有一天她发现了一个奇妙的函数：
$$
f(x)=x-0.5+\frac{\arctan(\cot(\pi x))}{\pi}
$$

她非常喜欢这个函数。现在，她会对你提出 $T$ 个询问，每个询问包含一个浮点数 $x$ ，而你只需要回答 $f(x)$ 的值是多少。

选手输出与标准答案的绝对误差或相对误差不超过 $10^{-6}$ 即视为正确。

## 样例 #1

### 输入

```
3
1.10
1.72
2.34```

### 输出

```
1.000000
1.000000
2.000000```

# 题解

## 作者：rui_er (赞：21)

注意到：

$$
f(x)=\lfloor x\rfloor,\qquad(x\notin\N)
$$

代码：

```cpp
int T; double x;
cout << fixed << setprecision(12);
for(cin >> T; T; --T) {
    cin >> x;
    cout << floor(x) << endl;
}
```

---

~~感觉说明不够过不了审~~，于是简单说一下正确性：

由诱导公式 $\cot\pi x=\tan(\frac{\pi}{2}-\pi x)$ 知 $f(x)=x-0.5+\frac{\arctan(\tan(\frac{\pi}{2}-\pi x))}{\pi}$，考察 $\frac{\arctan(\tan(\frac{\pi}{2}-\pi x))}{\pi}$ 的意义，发现是将 $y=\frac{\frac{\pi}{2}-\pi x}{\pi}=\frac{1}{2}-x$ 切成长度为 $1$ 的段并上下平移，平移的量恰好跟 $-0.5$ 加起来就是 $-\{x\}$（$\{x\}$ 表示 $x$ 的小数部分），因此 $f(x)=\lfloor x\rfloor$。

如果你不会三角函数，你也可以让 wolframalpha 或者 geogebra 帮你注意到这一点。

---

## 作者：xiaobai0123 (赞：7)

这道题目可能就是一道签到题。题目给出的函数看似复杂，其实却是一个异常简单的函数。首先如果我们没有高超的三角函数知识（~~比如我~~）。我们可以画出图像（~~作弊~~）。
![](https://cdn.luogu.com.cn/upload/image_hosting/8j8rm2o9.png)
我们可以轻松发现函数的特性：
$f(c)=x,x\le c< x+1$

代码：
```cpp
// Problem: P10314 [SHUPC 2024] 函数
// Contest: Luogu
// URL: https://www.luogu.com.cn/problem/P10314
// Memory Limit: 512 MB
// Time Limit: 1000 ms
// 
// Powered by CP Editor (https://cpeditor.org)

#include <bits/stdc++.h>
using namespace std;
int T;
double x;
int main(){
	cin>>T;
	while(T--){
		cin>>x;
		int L=-1,R=2e9;
		int ans=0;
		while(L+1<R){
			int M=(L+R)/2;
			if(x>M){
				ans=M;
				L=M;
			}else{
				R=M;
			}
		}
		cout<<ans<<endl;
	}
	
	return 0;
}
```

---

## 作者：Y_zhao111 (赞：5)

题目传送门：[P10314 [SHUPC 2024] 函数](\problem\P10314)

解函数题。

-----
### 函数解读
$$f(x)=x-0.5+\frac{\arctan(\cot(\pi x))}{\pi}$$

| 函数 | 名称 | $\operatorname{c++}$ |
| :----------: | :----------: | :----------: |
| $\arctan$ | 反正切函数 | $\operatorname{atan}(\operatorname{double} x)$ |
| $\cot$ | 余切函数 | $1.0/\tan(\operatorname{double} x)$|
| $\pi$ | 圆周率 | `std::numbers::pi` |

所以，我们可以得出代码：
```cpp
inline double f(double x){return x - 0.5 + atan(1.0 / tan(std::numbers::pi * x)) / std::numbers::pi;}
```
----
#### CODE
```cpp
#include <bits/stdc++.h>
using namespace std;

inline double f(double x){return x - 0.5 + atan(1.0 / tan(std::numbers::pi * x)) / std::numbers::pi;}

int main()
{
	int T;
	cin >> T;
	
	while(T --)
	{
		double x;
		cin >> x;
		printf("%7f\n", f(x));
	}
	return 0;
}
```
### Q&A
+ Q：为什么过不了编译？
+ A：因为有 `std::numbers::pi`，所以要用 `c++20` 提交。
-------
+ Q：为什么 $\cot(x) = \frac{1}{\tan x}$？
+ A：按照**三角函数**，$\cot x = \frac{b}{a}$ , $\tan x = \frac{a}{b}$，即 $\cot$ 和 $\tan$ 互为倒数，所以$\cot(x) = \frac{1}{\tan x}$。
##### 有问题欢迎评论区留言~

---

## 作者：spfa_ (赞：5)

[P10314 [SHUPC 2024] 函数](https://www.luogu.com.cn/problem/P10314)

### 题目简述

求
$$f(x)=x-0.5+\frac{\arctan(\cot(\pi x))}{\pi}$$

### 题目分析

因为 $\cot x=\dfrac{1}{\tan x}$，所以我们可以直接用 c++ 中的函数库计算，代码：

```cpp
#include <bits/stdc++.h>
#define fi first
#define se second
#define pb push_back
#define mk make_pair
#define ll long long
#define space putchar(' ')
#define enter putchar('\n')
using namespace std;

typedef vector <int> vi;
typedef pair <int, int> pii;

inline int rd() { int x = 0, f = 1; char c = getchar(); while (!isdigit(c)) f = c == '-' ? -1 : f, c = getchar(); while (isdigit(c)) x = (x<<3)+(x<<1)+(c^48), c = getchar(); return x*f; }
inline ll rdll() { ll x = 0, f = 1; char c = getchar(); while (!isdigit(c)) f = c == '-' ? -1 : f, c = getchar(); while (isdigit(c)) x = (x<<3)+(x<<1)+(c^48), c = getchar(); return x*f; }
template <typename T> inline void write(T x) { if (x < 0) x = -x, putchar('-'); if (x > 9) write(x/10); putchar(x%10+48); }

const double pi = acos(-1);

int main() {
	int t = rd();
	while (t--) {
		double x; cin >> x;
		printf("%.6lf\n", x-0.5+atan(1.0/tan(x*pi))/pi);
	}
	return 0;
}
```

我们会发现 $f(x)$ 似乎是等于 $\left\lfloor x\right\rfloor$ 的，下面证明下：

设 $x=a+b$，其中 $a=\left\lfloor x\right\rfloor,b=x-\left\lfloor x\right\rfloor$，即 $a$ 为整数部分，$b$ 为小数部分。

因为 $\cot x=\tan(\dfrac{\pi}{2}-x)$，所以

$$f(x)=x-0.5+\frac{\arctan(\tan(\dfrac{\pi}{2}-\pi(a+b)))}{\pi}$$

$$f(x)=x-0.5+\frac{\dfrac{\pi}{2}-\pi b}{\pi}=x-b=\left\lfloor x\right\rfloor$$

代码：

```cpp
#include <bits/stdc++.h>
#define fi first
#define se second
#define pb push_back
#define mk make_pair
#define ll long long
#define space putchar(' ')
#define enter putchar('\n')
using namespace std;

typedef vector <int> vi;
typedef pair <int, int> pii;

inline int rd() { int x = 0, f = 1; char c = getchar(); while (!isdigit(c)) f = c == '-' ? -1 : f, c = getchar(); while (isdigit(c)) x = (x<<3)+(x<<1)+(c^48), c = getchar(); return x*f; }
inline ll rdll() { ll x = 0, f = 1; char c = getchar(); while (!isdigit(c)) f = c == '-' ? -1 : f, c = getchar(); while (isdigit(c)) x = (x<<3)+(x<<1)+(c^48), c = getchar(); return x*f; }
template <typename T> inline void write(T x) { if (x < 0) x = -x, putchar('-'); if (x > 9) write(x/10); putchar(x%10+48); }

int main() {
	int t = rd();
	while (t--) {
		double x; cin >> x;
		write((int)floor(x)), enter;
	}
	return 0;
}
```

---

## 作者：DAMDAM (赞：4)

想到化简 $f(x)$。

$$
\begin{array}{ll}
f(x)=x-\dfrac{1}{2}+\dfrac{\arctan(\cot(\pi x))}{\pi}\\
\\
=x-\dfrac{1}{2}+\dfrac{\arctan(\tan(\dfrac{\pi}{2}-\pi x))}{\pi}\\
\\
=x-\dfrac{1}{2}+\dfrac{\dfrac{\pi}{2}-\pi x+k\pi}{\pi}\\
\\
=x-\dfrac{1}{2}+\dfrac{1}{2}-x+k=k\\
\\
(-\dfrac{\pi}{2}<\dfrac{\pi}{2}-\pi x+k\pi<\dfrac{\pi}{2},k\in \Z,x\notin \N)
\end{array}
$$

这个不等式可以根据函数 $\arctan(x)$ 的值域得来。

整理这个与 $k$ 有关的不等式，可以发现 $k<x<k+1$，又 $k\in \Z$，所以 $k=\lfloor x \rfloor$。

---

## 作者：run_away (赞：2)

## 题意

求题目中给出的函数值。

## 分析

### Way 1

直接模拟，由于题目有 spj，所以可以用 c++ 自带函数算。虽然没有 $\cot$ 函数，但是可以用 $\frac{1}{\tan}$ 代替。

c++ 没有自带 $\pi$，但是可以用 $\arccos(-1)$ 表示。

### Way 2

我们用画图软件画一下这个函数的图像。

![炸了](https://pic.imgdb.cn/item/660ff74368eb93571313e323.png)

看图可知，对于实数 $x$，$f(x)$ 其实就是 $x$ 向下取整后的结果。好心的出题人为了不为难你，甚至还加入了 $x\notin\mathbb{N}$ 的条件。

所以直接输出 `floor(x)` 就行了。

## Code

```c++
#include<bits/stdc++.h>
typedef long long ll;
using namespace std;
#define dbg(x) cout<<#x<<": "<<x<<"\n"
inline ll read(){ll x=0,f=1;char c=getchar();while(c<48||c>57){if(c==45)f=0;c=getchar();}while(c>47&&c<58)x=(x<<3)+(x<<1)+(c^48),c=getchar();return f?x:-x;}
const ll mod=1e9+7,maxn=1e5+5;
#define pi acos(-1)
ll t;
inline double f(double x){
    return x-0.5+atan(1.0/tan(pi*x))/pi;
}
signed main(){
    t=read();
    while(t--){
        double x;
        cin>>x;
        printf("%lf\n",f(x));
    }
    return 0;
}
```

```cpp
#include<bits/stdc++.h>
typedef long long ll;
using namespace std;
#define dbg(x) cout<<#x<<": "<<x<<"\n"
inline ll read(){ll x=0,f=1;char c=getchar();while(c<48||c>57){if(c==45)f=0;c=getchar();}while(c>47&&c<58)x=(x<<3)+(x<<1)+(c^48),c=getchar();return f?x:-x;}
const ll mod=1e9+7,maxn=1e5+5;
ll t;
signed main(){
    t=read();
    while(t--){
        double x;
        cin>>x;
        printf("%lf\n",floor(x));
    }
    return 0;
}
```

---

## 作者：Fp0cY1tZ6Nn4Rd_ (赞：2)

三角函数 $\sin$，$\cos$ 和 $\tan$ 大家应该很熟悉，但是 $\cot$ 是什么鬼东西啊？

其实 $\cot$ 也是一个三角函数，它的全称是 cotangent，中文名叫余切。它的定义是直角三角形一锐角的邻边和对边之比。那余切怎么算呢？有一个很重要的公式。

$$\cot x={1\over\tan x}$$

其实这个公式很好理解，因为 $\tan$ 的定义是直角三角形一锐角的对比和邻边之比，互为倒数。

`<cmath>` 里有现成的 `tan(x)` 和 `atan(x)` 函数。这时候代码就很好写了。

```cpp
#include<iostream>
#include<iomanip>
#include<algorithm>
#include<cmath>
using namespace std;
const double pi=3.1415926536;
double x;
int main(){
	ios::sync_with_stdio(false);
    int t;
    cin>>t;
    while(t--){
	    cin>>x;
	    cout<<fixed<<setprecision(6)<<x-0.5+(atan(1.0/tan(pi*x)))/pi<<endl;
      //这里使用了 iomanip 的格式操作符。
      //fixed 用于使用定点表示法表示浮点数。
      //setprecision(x) 用于控制有效数字的位数。
      //两个放在一起使用就是控制小数点后的位数。
    }
	return 0;
}
```

---

## 作者：Thorongil_Gondor (赞：0)

# P10314 [SHUPC 2024] 函数 题解
[题目传送门](https://www.luogu.com.cn/problem/P10314)
## 思路
按题目要求计算 $\operatorname{f(x)}$ 的值即可。  
$\cot$ 叫余切，和 $\tan$ 互为倒数。所以 $\cot(πx)=\frac{1}{\tan(xπ)}$。$\arctan$ 函数在可以用 $\tan$ 函数。
综上所述，将 $\operatorname{f(x)}$ 转化为 c++ 代码为 `x-0.5+(atan((1/tan(pai*x)))/pai)`。其中 $pai$ 是自行定义的常量。
## AC Code
```cpp
#include<bits/stdc++.h>
using namespace std;
int t;
double x;
const double pai=3.1415926;
int main(){
	cin>>t;
	while(t--){
		cin>>x;
		printf("%.6lf\n",x-0.5+(atan((1/tan(pai*x)))/pai));
	}
	return 0;
}
```

---

## 作者：xiaoyang111 (赞：0)

## 前言

我这里给一个对比其他做法非常麻烦的做法，但是唯一好处是不用推式子。

在阅读本文前，你需要知道下面这些知识：

- $\cot(a)$ 是余切函数，他的值是对应 $\tan(a)$ 函数值的倒数，即 $\cot(a)=\frac{1}{\tan(a)}$。

- 在 `cmath` 库里面，已经提供了很多三角函数，$\tan(a)$ 是 `tan(a)`，因为是浮点数所以是 `tanf(a)`；$\arctan(a)$ 是 `atan(a)`，因为是浮点数所以是 `atanf(a)`。

- 我们可以用 `acos(-1)` 表示常数 $\pi$。

## 题解

### 分析

有了这些知识，我们直接调用 `cmath` 库里面的三角函数，输出题目该输出的东西就可以了。为了保证精度不会错，可以直接保留的八位小数。

### 代码

代码就出来了。

```cpp
#include <iostream>
#include <cmath>
using namespace std;
const double PI=acos(-1);
void solve(){
	double a;
	scanf("%lf",&a);
	printf("%.8lf\n",a-0.5+(atanf(1.0/tanf(PI*a))/PI));
}
int main(){
	int t;
	cin >> t;
	for (int i=0;i<t;++i){
		solve();
	}
	return 0;
}
```

---

## 作者：shicj (赞：0)

# P10314 [SHUPC 2024] 函数 题解

直接处理即可。

小问题：math 库中没有 $\cot$ 函数。

解决：用公式 $\cot(x)=\tan(\dfrac{\pi}{2}-x)$。

定义 $\cot$ 函数：
```cpp
double cot(double x){return tan(pi/2-x);}
```

输出：
```cpp
printf("%.6lf\n",x-0.5+(atan(cot(pi*x)))/pi);
```

代码就不用了吧。

---

## 作者：_Warfarin_ (赞：0)

## 奇淫巧计
观察原式子。  
$ f(x)=x-0.5+\frac{\arctan (\cot (\pi x))}{\pi} $   
显然没有任何思路。
那我们打开一个[好玩的网站](https://www.desmos.com/calculator?lang=zh-CN)。
![](https://cdn.luogu.com.cn/upload/image_hosting/i8ahzm54.png)
观察后不难发现 $ f(x)= \left \lfloor x \right \rfloor $ 。  
只需要写出代码即可。


## AC 代码如下
```
#include <bits/stdc++.h>

#define ll long long
#define io cin.tie(0),cout.tie(0),ios::sync_with_stdio(false)
#define ri register int
#define lb long double
	
using namespace std;
int main()
{
	io;
	int t;
	cin >> t;
	for (ri i = 1; i <= t; i++)
	{
		lb x;
		cin >> x;
		cout << fixed << setprecision(6) << floor(x) << endl;
	}
	return 0;
}
```

## 补充知识
### c++ 三角函数库
- ` sin(x) ` 返回正弦值。   
- ` cos(x) ` 返回余弦值。  
- ` tan(x) ` 返回正切值。  
- ` asin(x) ` 返回反正弦值。  
- ` acos(x) ` 返回反余弦值。  
- ` atan(x) ` 返回反正切值。  
 #### 注意事项
 - ` x ` 必须是小数形式，不能是整数，而且` x `必须是弧度不能是角度角度转换弧度可用以下函数实现。
 - 调用三角函数之后的函数返回值也是小数。
 
 ### 各三角函数间的数学关系
 ![](https://cdn.luogu.com.cn/upload/image_hosting/rf3ajaxv.png)
 ![](https://cdn.luogu.com.cn/upload/image_hosting/v76tobyv.png)

---

## 作者：_dbq_ (赞：0)

## 前言
本题是[第 22 届上海大学程序设计联赛春季赛](https://www.luogu.com.cn/contest/165201)的赛题，建议没有读题的同学先点击[这里](https://www.luogu.com.cn/problem/P10314)读题，建议评橙。

## 题目大意
定义 $f(x)=x-0.5+\frac{\arctan(\cot(\pi x))}{\pi}$，给定 $x$，求 $f(x)$。

## 思路
本题看起来很复杂，但 c++ 中有现成的三角函数，根据题意模拟即可。

## 注意！！！
**要让小数输出完整！！！**

## 代码
```cpp
#include<iostream>
#include<iomanip>
#include<cmath>
#include<math.h>
#include<algorithm>
#define LL long long
#define ULL unsigned long long
#define cint const int 
using namespace std;
const double pi=3.14159265358979;//圆周率
double cot(double x)//c++中没有余切函数，需要自己定义 
{
    return cos(x)/sin(x);//余切等于余弦除以正弦 
}
int main()
{
    #ifdef dbq
    freopen("1.in","r",stdin);
    freopen("1.out","w",stdout);
    #endif
    int T;
    cin>>T;//多组数据 
    while(T--)
    {
        double x;
        cin>>x;//读入x 
        cout<<fixed<<x-0.5+(atan(cot(pi*x))/pi)<<endl;//将公式照着写下来
		//注意：使用fixed使小数完整输出 
    }
    return 0;
}
```

---

## 作者：gavinliu266 (赞：0)

# 思路1
考虑调用 cmath 库，可以方便写出这样的代码。
```cpp
ans = x - 0.5 + atan(cot(Pi * x)) / Pi;
```
可是，$\cot(x)$ 不支持，所以只能够用 $\tan{(\dfrac{\pi}{2} - x)}$ 代替。

有一些可能需要注意的地方：
- 本题精度要求较高，使用 long double 更加保险。
- long double 输出时应用 `%Lf`。

## 代码实现
```cpp
#include <cmath>
#include <cstdio>
#define cot(x) tan(Pi / 2 - x)
using namespace std;
const long double Pi = 3.1415926535897932384626433832795;  // 定义 Pi
int t;
long double x, ans;
int main() {
    scanf("%d", &t);
    while(t--) {
        scanf("%Lf", &x);
        ans = atan(cot(Pi * x)) / Pi;
        printf("%.6Lf\n", x - 0.5 + ans);  // 是 %Lf 而非 %lf
    }
}
```
[提交记录](https://www.luogu.com.cn/record/154817790) 。

# 思路二
我们继续推一下式子：
$$
\begin{aligned}
f(x) &= x - 0.5 + \frac{\arctan{(\cot{(\pi x)}})}{\pi} \\
&= x - 0.5 + \frac{\frac{\pi}{2} - (\pi x - \pi \lfloor \frac{\pi x}{\pi} \rfloor)}{\pi} \\
&= x - 0.5 + \frac{\frac{\pi}{2} - \pi x + \pi \lfloor \frac{\pi x}{\pi} \rfloor}{\pi} \\
&= x - 0.5 + 0.5 - x + \lfloor x \rfloor \\
&= \lfloor x \rfloor
\end{aligned}
$$ 

所以直接输出 $\lfloor x \rfloor$ 即可。
## 代码实现
```cpp
#include <cmath>
#include <cstdio>
using namespace std;
int t;
double x, ans;
int main() {
    scanf("%d", &t);
    while(t--) {
        scanf("%lf", &x);
        printf("%.6lf\n", floor(x)); 
    }
}
```
[提交记录](https://www.luogu.com.cn/record/154883762)。

---

## 作者：RyanLi (赞：0)

传送门：[P10314 [SHUPC 2024] 函数](https://www.luogu.com.cn/problem/P10314)

更佳的阅读体验：[洛谷 P10314 题解](https://blog.ryanli.top/index.php/archives/47/)

---

**简要题意**：给定浮点数 $x$，求 $f(x) = x - 0.5 + \dfrac{\arctan (\cot (\pi x))}{\pi}$ 的值。

数学库中提供了我们想要的函数，直接输出即可。有以下几个细节需要注意：

- $\arctan$ 对应的函数是 `atan()`。
- $\cot$ 没有直接的函数对应，但 $\cot \alpha = \dfrac{1}{\tan \alpha}$。
- $\pi$ 可以使用常量 `M_PI`，无需手动计算。

``` cpp
#include <iostream>
#include <cmath>
#include <iomanip>
using namespace std;

int t;
double x;

int main() {
    cin.tie(nullptr);
    ios::sync_with_stdio(false);
    for (cin >> t; t; --t) {
        cin >> x;
        cout << fixed << setprecision(6) << x - 0.5 + atan(1 / tan(M_PI * x)) / M_PI << '\n';
    } return 0;
}
```

---

## 作者：Ivan422 (赞：0)

题目大意：给定 $x$，求如下函数结果：
$$
f(x)=x-0.5+\frac{\arctan(\cot(\pi x))}{\pi}
$$

思路：题目没有给定 $\pi$ 的值，于是使用 $\arccos(-1)$ 得出 $\pi$ 值，但是我没有找到 $\cot$ 的函数，于是把 $\cot(\pi x)$ 转换为 $\tan(\frac{\pi}{2}-\pi x)$，最后按照题意模拟即可。

```cpp
#include<bits/stdc++.h>
using namespace std;
int T;
double x,p,t;
signed main(){
    cin>>T;
    while(T--){
        scanf("%lf",&x);
        p=acos(-1);
        t=atan(tan(p/2-p*x))/p;
        printf("%.6lf\n",x-0.5+t);
    }
    return 0;
}
```

---

## 作者：nightwatch.ryan (赞：0)

### 思路
此题按照题目所说公式模拟即可，可以用 `cmath` 库里的函数解决，注意保留 $6$ 位小数后输出。
### 代码
```cpp
#include<iostream>
#include<iomanip>
#include<cmath> 
#define pi 3.1415926
#define lb long double
lb func(lb x){return x-0.5+atan(1/tan(pi*x))/pi;} 
int main(){
	int t;std::cin>>t;
	while(t--){
		lb x;std::cin>>x;
		std::cout<<std::fixed<<std::setprecision(6)<<func(x)<<std::endl;
	}
}
```

---

## 作者：LostKeyToReach (赞：0)

这道题很简单，模拟就行了。

要注意： $\cot x=\frac{1}{\tan x}$。

```cpp
#include <bits/stdc++.h>
#define pi acos(-1)
using namespace std;
int main() {
	int t;
	cin >> t;
	while (t--) {
		double x;
		cin >> x;
		printf("%.6lf\n", x - 0.5 + 1.0 * atan(1.0 / tan(pi * x)) / pi);
	}
}
```

---

## 作者：Hughpig (赞：0)

按题意模拟即可。但是可能有以下问题：

1. `C++` 不自带 $\pi$ 的值怎么办？

`C++ 20` 新增头文件 `<numbers>`，在命名空间 `std::numbers` 中定义了一些数学常数。其中 `std::numbers::pi` 表示 $\pi$。

2. `C++` 不自带 $\cot$（余切函数）怎么办？

根据三角函数知识，$\cot x=\dfrac{1}{\tan x}$。所以我们可以用 $\dfrac{1}{\tan x}$ 代替 $\cot x$。

然后就没问题啦。

代码：

```cpp
#include<bits/stdc++.h>
using namespace std;
using namespace numbers;

double f(double x){
    return x-0.5+atan(1.0/tan(pi*x))/pi;
}

int main()
{
    int TestCases=1;
    cin>>TestCases;
    while(TestCases--){
    	double x;
    	cin>>x;
    	cout<<fixed<<setprecision(7)<<f(x)<<'\n';
    }
	return 0;
}
```

---

## 作者：Ravener (赞：0)

由题意可知，

$$ \displaystyle
f(x) = x - 0.5 + \frac { \arctan ( \cot ( \pi x ) ) }{ \pi }
$$ 

求 $f(x)$，其中 $x \notin \mathbb N$ 且 $x > 0$。  
但是当我们把它放到 Desmos 里后发现：  

$$
f(x) = \lfloor x \rfloor
$$  

~~（Desmos 真是好东西）~~  
这里的 $\lfloor x\rfloor$ 相当于 C/C++ 的 ``floor(x)``，即向下取整函数。  
~~（去查了 [Wolfram](https://www.wolframalpha.com/input?i2d=true&i=-0.5+%2B+x+%2B+Divide%5BArcTan%5BCot%5B%CF%80x%5D%5D%2C%CF%80%5D)，发现看不懂）~~

------------

### 证明：
  
![](https://cdn.luogu.com.cn/upload/image_hosting/z5yiy3ab.png)
如图，$\displaystyle i+\gamma=\frac \pi 2$，  

$\therefore A(\cos i,\sin i),B(\sin i,\cos i)$，  

$\displaystyle\therefore\cot i=\frac {\cos i}{\sin 
i},\tan \gamma =\tan (\frac \pi 2-i)=\frac {\cos i}{\sin i}$，  

$\displaystyle\therefore\cot i=\tan (\frac \pi 2-i)$，

$\displaystyle\therefore f(x) = x - 0.5 + \frac { \arctan ( \cot ( \pi x ) ) }{ \pi }$

$\displaystyle \hspace{1.1111cm}=x-0.5+\frac{\arctan ( \tan ( \frac{k\pi}{2}-\pi x ) )}{\pi}$

$\displaystyle \hspace{1.1111cm}=x-0.5+\frac{\frac{k\pi}{2}-\pi x}{\pi}$

$\displaystyle \hspace{1.1111cm}=\frac{k-1}{2}$

$\displaystyle \hspace{1.1111cm}=\lfloor x \rfloor$，  

其中 $\displaystyle k \in \{n \in \mathbb N^* \mid k=2n-1 \}$ 且 $\displaystyle|\frac k 2-x| \in [0,\frac 1 2)$。


------------

所以代码如下：  
```cpp
#include<bits/stdc++.h>//万能头
using namespace std;
main()
{
	int t;
	cin>>t;
	while(t--)//个人习惯，写成 for 循环也可
	{
		double x;
		cin>>x;
		cout<<fixed<<setprecision(6)<<double(floor(x))<<"\n";//样例保留了 6 位小数，为保险也保留 6 位
	}
}
```  
（题解仅供参考，如有谬误与纰漏欢迎指正）

---

## 作者：queenbee (赞：0)

# P10314 函数 题解
## 思路（暴力）
[题目传送门](https://www.luogu.com.cn/problem/P10314)，这道题名字叫函数，所以肯定是让我们调用 C++ 函数库中的函数来 AC 这道题（~~bushi~~），主函数库中有 $ \arctan $ 函数，可以直接调用。

函数库中没有 $\cot$ 函数（我没找到），但我们知道 $ \cot(x)=\frac  {1}{ \tan(x) }$，而函数库中有 $\tan$ 函数。这道题就迎刃而解了。
## 代码（暴力）
```cpp
#include<bits/stdc++.h>	//我爱万能头 
using namespace std;
const double pi=3.1415926535;	//定义常数pi 
int t;
double n;
double ans;
int main(){
	cin>>t;
	while(t--){
		cin>>n;
		ans=n-0.5+atan(1.0/tan(n*pi))/pi;	//调用 
		printf("%.6lf\n",ans);
	}
	return 0;	//完结撒花 
}
```
## 思路（正常）
显然，上面那种做法太过于暴力了（~~能 AC 就是好代码~~），所以我们可以将原式进行化简。

根据数据范围 $x \notin N$，我们可以令 $x=a+b$ ，其中 $a$ 为整数部分，$b$ 为小数部分（$0 < b < 1$），推导过程如下：

$a + b - 0.5 + \frac { \arctan ( \frac {1} { \tan(\pi (a+b))}) } {\pi}$

$\Leftrightarrow a + b- 0.5 + \frac { \arctan ( \frac {1} { \tan(\pi b))}) } {\pi}$

$\Leftrightarrow a + b- 0.5 + \frac { \frac {1}{2}\pi-b\pi } {\pi}$

$\Leftrightarrow a + b - 0.5 + 0.5 -b$

$\Leftrightarrow a$

所以原式的值就为 $x$ 的整数部分 $a$，最后输出只需输出 $x$ 的整数部分即可
## 代码（正常）
```cpp
#include<bits/stdc++.h>	//我爱万能头 
using namespace std;
int t;
double n;
int main(){
	cin>>t;
	while(t--){
		cin>>n;
		printf("%.6lf\n",floor(n));
	}
	return 0;	//完结撒花 
}
```

---

## 作者：dlzlj_2010 (赞：0)

原函数中的函数C++的数学库基本都有，下面来求 $\pi$ 和 $\cot x$。

- 注意到 $\cos \pi=-1$，所以 $\pi=\arccos -1$。
- $\cot x=\dfrac{1}{\tan x}$

## code:
```cpp
#include<bits/stdc++.h>
using namespace std;
typedef long long ll;
//#define double long double
const double pi=acos(-1);
inline double cot(double x){
	return 1/tan(x);
}
inline double f(double x){
	return x-0.5+atan(cot(pi*x))/pi;
}
signed main(){
	int T;
	cin>>T;
	while(T--){
		double x;
		cin>>x;
		printf("%.6lf\n",f(x));
	}
	return 0;
}
```


------------
## **其实还有一种更简单的方法。**

我们先画出原函数的图像：
![](https://cdn.luogu.com.cn/upload/image_hosting/q4cg2cmh.png)

可以发现 $f(x)=\lfloor x\rfloor$。
## code:
```cpp
#include<bits/stdc++.h>
using namespace std;
typedef long long ll;

signed main(){
	int T;
	cin>>T;
	while(T--){
		double x;scanf("%lf",&x);
        printf("%lf\n",floor(x));
	}
	return 0;
}
```

---

## 作者：__qkj__ (赞：0)

[题目传送门](https://www.luogu.com.cn/problem/P10314)
## 解题思路
直接计算。

由于 $\cot()$ 函数 c++ 里没有，还得手写。

$$\cot(n)=\tan(\frac{\pi}{2}-n)$$

而 $\pi$ 呢，c++ 里有，是 `M_PI`。
## Code
```cpp
#include<bits/stdc++.h>
#define int long long
using namespace std;
double cot(double n)
{
	return tan(M_PI/2-n);
}
signed main()
{
	ios::sync_with_stdio(0);
	cin.tie(0);
	cout.tie(0);
	int t;
	cin>>t;
	while(t--)
	{
		double n;
		cin>>n;
		printf("%.6lf\n",n-0.5+atan(cot(M_PI*n))/M_PI);
	}
	return 0;
}

```

---

## 作者：70CentsApple (赞：0)

# [P10314  函数](https://www.luogu.com.cn/problem/P10314)
## 思考
按照题意进行运算即可。
提示：$\cot(x) = \frac{1}{\tan(x)}$

其实，也可以证明 $f(x) = \lfloor x \rfloor$。

我们知道 $\cot(\pi x) = \frac{1}{\tan(\pi x)} = \frac{\cos(\pi x)}{\sin(\pi x)}$。当 $x$ 是整数时，$\sin(\pi x) = 0$，此时 $\cot(\pi x)$ 无意义。因此，我们需要在整数点以外的区域考虑这个函数。

**正好，题目里有说明 $x$ 不为自然数。**

接下来，考虑 $\arctan(\cot(\pi x))$。其中 $\arctan$ 和 $\cot$ 互为反函数，$\arctan$ 的值域是 $(-\frac{\pi}{2}, \frac{\pi}{2})$，而 $\cot$ 在每个开区间 $(n\pi, (n+1)\pi)$ 上是连续且单调的，其中 $n \in \mathbb{Z}$。

当 $x \in (n, n+1)$ 时（$n \in  \mathbb{Z}$）：

在这个区间内，$\cot(\pi x)$ 是连续的，并且当 $x$ 从 $n$ 增加到 $n+1$ 时，$\cot(\pi x)$ 从 $+\infty$ 减小到 $-\infty$。因此，$\arctan(\cot(\pi x))$ 会从 $+\frac{\pi}{2}$ 减小到 $-\frac{\pi}{2}$。

因此，$\frac{\arctan(\cot(\pi x))}{\pi}$ 会从 $+\frac{1}{2}$ 减小到 $-\frac{1}{2}$。当这个值加上 $x - \frac{1}{2}$ 时，相当于在 $x$ 上减去一个在 $(0, 1)$ 范围内变化的数，这意味着在整个区间 $(n, n+1)$ 内，$f(x)$ 的值是 $n$。

所以我们可以认为给定的 $f(x)$ 在其定义域内等于 $\lfloor x \rfloor$。

## 代码（Python）
### ver 1
```python
import math
for _ in range(int(input())):
    n = float(input())
    print(n - 0.5 + math.atan(1 / math.tan(math.pi * n)) / math.pi)
```
### ver 2
```python
print(*[int(float(input())) for _ in range(int(input()))], sep='\n')
```

---

## 作者：lovely_hyzhuo (赞：0)

本题需用三个函数，$\sin x$，$\cos x$ 和 $\arctan x$。

由于 $\cot x=\frac{\cos x}{\sin x}$。

那么暴力计算每一个询问的 $x$ 所对应的 $f(x)$ 值，输出即可。

code

```cpp
#include<bits/stdc++.h>
#define int long long
using namespace std;
const double pi=3.1415926;
void solve()
{
	double x;
	cin>>x;
	printf("%.8lf\n",(x-0.500)+(atan(cos(pi*x)/sin(pi*x)))/pi);
}
signed main()
{
	int t;
	cin>>t;
	while(t--)
		solve();
	return 0;
}
```

---

## 作者：InversionShadow (赞：0)

把 
$$
f(x)=x-0.5+\frac{\arctan(\cot(\pi x))}{\pi}
$$

弄到 desmos 后发现 $f(x)=\left\lfloor x\right\rfloor$，输出就行。

![](https://cdn.luogu.com.cn/upload/image_hosting/xnchr6yq.png)（蓝色和绿色重叠了）

如果错了勿喷（

```cpp
#include <bits/stdc++.h>

using namespace std;

int t;
double a; 

int main() {
  cin >> t;
  while (t--) {
    cin >> a;
    cout << (int)a << ".000000\n";
  }
  return 0;
}
```

---


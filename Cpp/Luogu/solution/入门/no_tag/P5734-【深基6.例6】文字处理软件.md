# 【深基6.例6】文字处理软件

## 题目描述

你需要开发一款文字处理软件。最开始时输入一个字符串作为初始文档。可以认为文档开头是第 $0$ 个字符。需要支持以下操作：

- `1 str`：后接插入，在文档后面插入字符串 $\texttt{str}$，并输出文档的字符串；
- `2 a b`：截取文档部分，只保留文档中从第 $a$ 个字符起 $b$ 个字符，并输出文档的字符串；
- `3 a str`：插入片段，在文档中第 $a$ 个字符前面插入字符串 $\texttt{str}$，并输出文档的字符串；
- `4 str`：查找子串，查找字符串 $\texttt{str}$ 在文档中最先的位置并输出；如果找不到输出 $-1$。

为了简化问题，规定初始的文档和每次操作中的 $\texttt{str}$ 都不含有空格或换行。最多会有 $q$ 次操作。

## 说明/提示

数据保证，$1 \leq q\le 100$，开始的字符串长度 $\leq 100$。

## 样例 #1

### 输入

```
4
ILove
1 Luogu
2 5 5
3 3 guGugu
4 gu```

### 输出

```
ILoveLuogu
Luogu
LuoguGugugu
3```

# 题解

## 作者：Mubuky (赞：377)

**这是一道很好的的字符串操作入门题，本篇将介绍如何使用字符数组构成的字符串来解决此题，适合使用C/C++的读者。**

2020/1/16完成；2022/9/15更新

**库函数是相对高效的**

相对于其他基本数据类型，字符串的存储和操作需要耗费大量空间和时间，但在某些情况下字符串的使用又是不可避免的，这推动字符串操作的相关库函数在大量底层优化后是相对高效的。

希望本篇题解能使读者更好的了解字符串相关库函数

**此篇使用到的库函数:**

~~~cpp
extern char strcat(char dest, const char src);
~~~

> `strcat` 函数将 `src` 串拼接到 `dest` 串之后

~~~cpp
extern char strstr(char str1, const char str2);
~~~

> `strstr` 函数在 `str1` 串内查找 `str2` 串的位置，如未找到，则返回 `NULL`

~~~cpp
extern char strcpy(char dest, const char src);
~~~

> `strcpy` 函数将 `src` 串复制到 `dest` 串

**对于以下叙述，我们约定:**

> $str$ 串表示原始串， $in$ 串表示读入串或暂存串

**对于操作 $1$ :**

- 需使用 `strcat` 函数

将 $in$ 拼接到 $str$ 串后

 _举例:_ 

原始串: `ILove`

输入: `1 Luogu`

操作后

`ILoveLuogu`（存于 $str$ 串）


**对于操作 $2$ :**

- 需使用 `strcpy` 函数

首先，将 $str$ 串第 `a + b` 位及以后舍去；

接着，将 $str$ 串第 `a` 位及以后复制到 $in$ 串中暂存；

最后，将 $in$ 串中暂存的内容复制回 $str$ 串中。

 _举例:_ 

原始串: `ILoveLuoguMubuky`

输入: `2 5 5`

第一步操作后:

`ILoveLuogu`（存于 $str$ 串）

第二步操作后:

`Luogu`（存于 $in$ 串）

第三步操作后:

`Luogu`（存于 $str$ 串）

**对于操作 $3$ :**

- 需使用 `strcat` 函数

首先，将 $str$ 串第 `a` 位及以后的部分接到 $in$ 串后；

接着，将 $in$ 串接到 $str$ 串第 `a` 位。

 _举例:_ 

原始串: `Luogu`

输入: `3 3 guGugu`

第一步操作后:

`guGugugu`（存于 $in$ 串）

`Luo`（存于 $str$ 串）

第二步操作后:

`LuoguGugugu`（存于 $str$ 串）

**对于操作 $4$ :**

- 需使用 `strstr` 函数

查找 $in$ 串在 $str$ 串中的位置，若函数返回 `NULL` ，则如题输出 `-1`，否则将函数返回的指针与字符串串首指针作差以获得其在字符串中的位置。

 _举例:_ 

原始串: `LuoguGugugu`

输入: `4 gu`

输出: `3`

**完整代码:**

```cpp
#include<stdio.h>
#include<string.h>
#define MAXN 101
char str[MAXN], in[MAXN];
int main(void)
{
	int q;
	scanf("%d\n%s", &q, str);
	for (int i = 1; i <= q; i++) {
		int opt;
		scanf("%d", &opt);
		if (opt == 1) {
			scanf("%s", in);
			strcat(str, in);
			printf("%s\n", str);
		}
		else if (opt == 2) {
			int a, b;
			scanf("%d %d", &a, &b);
			str[a + b] = '\0';
			strcpy(in, &str[a]);
			strcpy(str, in);
			printf("%s\n", str);
		}
		else if (opt == 3) {
			int a;
			scanf("%d %s", &a, in);
			strcat(in, &str[a]);
			str[a] = '\0';
			strcat(str, in);
			printf("%s\n", str);
		}
		else {
			scanf("%s", in);
			char *ans = strstr(str, in);
			printf("%d\n", ans != NULL ? (int)(ans - str) : -1);
		}
	}
	return 0;
}
```

[评测记录 (代码长度702B，用时10ms，内存664.00KB)](https://www.luogu.com.cn/record/29316869)

[题目链接：P5734 【深基 6.例 6】文字处理软件](https://www.luogu.com.cn/problem/P5734)

---

## 作者：Python147 (赞：11)

[题目传送门](https://www.luogu.com.cn/problem/P5734)


## 题目分析

本题要求支持的各种操作可以使用 STL string 的各种函数完成。

### 实现细节

STL string 的各种函数用法：

对于操作 $1$，直接将两个 STL string 相加即可。

对于操作 $2$，可以使用 `str.substr(int n, int m)` 进行字符串截取。

`str.substr(int n, int m)` 返回将字符串 $\texttt{str}$ 的下标 $n$ 开始截取 $m$ 个字符的结果。如果不指定参数 $m$，那么表示截取到字符串末尾。

对于操作 $3$，可以使用 `str.insert(int pos, string st)` 进行字符串插入。

`str.insert(int pos, string st)` 返回 $\texttt{str}$ 在 $pos$ 位置插入 $\texttt{st}$ 的结果。

对于操作 $4$，可以使用 `str.find(string st)` 查找子串。

`str.find(string st)` 返回 $\texttt{st}$ 在 $\texttt{str}$ 中的第一个位置。如果返回 `string::npos`，说明找不到子串。

## 代码实现

```cpp
#include <bits/stdc++.h>
using namespace std;
int op, a, b, q;
string s, str;
int main()
{
	cin >> q >> s;
	for (int i = 1; i <= q; i++)
	{
		cin >> op;
		if (op == 1)
		{
			cin >> str;
			s += str;
			cout << s << endl;
		}
		else if (op == 2)
		{
			cin >> a >> b;
			s = s.substr(a, b);
			cout << s << endl;
		}
		else if (op == 3)
		{
			cin >> a >> str;
			s.insert(a, str);
			cout << s << endl;
		}
		else
		{
			cin >> str;
			int tmp = s.find(str);
			if (tmp == string::npos)
				cout << -1 << endl;
			else
				cout << tmp << endl;
		}
	}
}
```

---

## 作者：liyelei (赞：6)

### [题目传送门](https://www.luogu.com.cn/problem/P5734)

![](https://cdn.luogu.com.cn/upload/image_hosting/ah0sgqak.png)

注意到题目中要让我们完成四个操作，即为**模拟题**。

再注意到题中的四个操作中，如果使用字符数组，十分繁琐，所以考虑使用 **STL** 中的 **string** 来解决。（只会 C 的可以看其他大佬的）。

---

操作 1：插入

输入要加入的字符串，再用 “+” 把原字符串与输入的字符串拼接在一起即可。

代码如下：

~~~cpp
cin >> str;
s += str;
cout << s << endl;
~~~

---

操作 2：截取子串

这个操作使用 ```substr``` 函数完成。

语法如下：

~~~cpp
s.substr(a, b)
~~~

这时蒟蒻要问了：```a``` 是下标吗？```b``` 又是什么？

所以需要详细解释一下：

```substr(a, b)``` 是截取原字符串从第 ```a``` 个字符（下标）起 ```b``` 个字符，但**不会**修改原字符串。

而题中要求覆盖原字符串，所以不能直接输出，而要将原字符串赋值为子串后输出。

代码如下：

~~~cpp
int a, b;
cin >> a >> b;
s = s.substr(a, b);
cout << s << endl;
~~~

---

操作 3：插入

插入可以用 ```insert``` 函数，语法如下：

~~~cpp
s.insert(a, str)
~~~
其作用是：在字符串的指定位置 ```a```（下标）插入另一个字符串 ```str```。

代码如下：

~~~cpp
int a;
cin >> a;
cin >> str;
s.insert(a, str);
cout << s << endl;
~~~

---

操作 4：查找子串

使用 ```find``` 函数解决。语法如下：

~~~cpp
s.find(str)
~~~

其作用是：在原字符串里查找给定字符串，如果有，返回给定字符串在文档中最先的位置，否则，返回 -1。

代码如下：

~~~cpp
cin >> str;
int pos = s.find(str);
cout << pos << endl;
~~~

---

最后，奉上 AC 代码：
~~~cpp
#include <iostream>
#include <string>    // 千万不能导成 <cstring>
using namespace std;
string s;
int main() {
    int t;
    cin >> t;
    cin >> s;
    while (t--) {
        int op;
        string str;
        cin >> op;
        if (op == 1) {
            cin >> str;
            s += str;
            cout << s << endl;
        } else if (op == 2) {
            int a, b;
            cin >> a >> b;
            s = s.substr(a, b);
            cout << s << endl;
        } else if (op == 3) {
            int a;
            cin >> a;
            cin >> str;
            s.insert(a, str);
            cout << s << endl;
        } else {
            cin >> str;
            int pos = s.find(str);
            cout << pos << endl;
        }
    }
    return 0;
}
~~~

---


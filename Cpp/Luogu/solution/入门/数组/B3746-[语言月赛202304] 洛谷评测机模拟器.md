# [语言月赛202304] 洛谷评测机模拟器

## 题目背景

现在假装你是洛谷评测机。这一天，洛谷同时进行了 PION 自测、SCP 自测、ION 自测等等比赛。成千上万的评测落到了你的身上！

## 题目描述

现在已经知道你有 $n$ 个相同性能的评测节点，它们被分别标号为 $1, 2, \cdots, n$。一个评测节点在同一时间只能处理一个评测任务。

在某一时刻，$m$ 个评测任务同时涌入了你。我们将这些任务分别标号为 $1, 2, \cdots, m$。这些评测任务需要的评测时间分别为 $t _ 1 , t _ 2, \cdots, t _ m$。每个评测任务**需要且仅需要一个**评测节点来运行，因此你会按照如下方式按照 $1 \sim m$ 的顺序依次将这些评测任务分配到评测节点上：

对于某个耗时 $t _ i$ 的评测任务，你需要找到目前**累积评测时间**最小的评测节点将任务放入。如果有多个评测节点**累积评测时间**相同且最小，则找一个**标号最小**的节点将任务放入。

> 「累积评测时间」定义：假设对于某个评测节点，其被分配了 $a _ 1, a _ 2, \cdots, a _ k$ 共 $k$ 个任务。那么这个评测节点的「累积评测时间」就是 $t _ {a _ 1} + t _ {a _ 2} + \cdots + t _ {a _ k}$。显然的，如果某个评测节点从未被分配过这 $m$ 个任务中的任何一个，那么这个评测节点的「累积评测时间」是 $0$。

现在，你需要统计出，你的这 $n$ 个评测节点分别接受了哪一些评测任务。

## 说明/提示

### 数据规模与约定

对于 $100\%$ 的数据，保证 $1 \leq n, m \leq 5 \times 10 ^ 3$，$0 \leq t _ i \leq 10 ^ 9$。

| 测试点编号 | $n \leq$ | $m \leq$ | 特殊性质 |
| :-----------: | :-----------: | :-----------: | :-----------: |
| $1 \sim 2$ | $10$ | $10$ | 无 |
| $3 \sim 4$ | $5 \times 10 ^ 3$ | $5 \times 10 ^ 3$ | $t _ i = 0$ |
| $5 \sim 6$ | $5 \times 10 ^ 3$ | $5 \times 10 ^ 3$ | $t _ i = 1$ |
| $7 \sim 10$ | $5 \times 10 ^ 3$ | $5 \times 10 ^ 3$ | 无 |


## 样例 #1

### 输入

```
5 10
13 50 90 38 60 64 60 77 6 24```

### 输出

```
1 6
2 8
3
4 7
5 9 10```

## 样例 #2

### 输入

```
12 7
85 99 82 90 14 11 15```

### 输出

```
1
2
3
4
5
6
7
0
0
0
0
0```

# 题解

## 作者：Maxmilite (赞：7)

## Source & Knowledge

2023 年 4 月语言月赛，由洛谷网校入门计划/基础计划提供。

## 题目大意

$n$ 个运算节点需要依次处理 $m$ 个任务。这些任务耗时依次为 $t _ 1, t _ 2, \cdots, t _ m$。

对于这些评测任务，需要依次找到目前累积评测时间最小的评测节点将任务放入。如果有多个评测节点累积评测时间相同且最小，则找一个标号最小的节点将任务放入。

询问最后这些节点各自处理了哪些任务。

## 题目分析

题目中提到了一个「找到最小」的问题。入门阶段处理这种问题通常会使用擂台法。

具体的，我们使用一个数组 $f$ 记录各个节点的累积评测时间，从头到尾枚举各个任务，对于每个任务，使用擂台法找到 $f$ 中的最小值所对应的标号中最小的一个。

在找到目标标号后，我们需要记录这个信息。一种比较简单的记录方法是，建立一个数组 $g$，其中 $g _ i$ 代表第 $i$ 个评测任务被置入的节点编号，在找到目标标号（设其为 $x$）后，我们直接将 $g _ i$ 赋值为 $x$ 即可。

最终输出答案时，对于每个节点 $x$，我们从头到尾遍历一次 $g$ 数组。当找到了一个 $i$ 使得 $g _ i = x$ 时，我们输出 $i$ 即可。特别的，我们可以用一个记号来记录当前节点是否被输出过。如果没有输出，则需要输出一个 $0$。

特别的，由于一个节点可能承担多个评测任务，一个评测任务至多可以耗费 $10 ^ 9$ 的时间。当一个节点承担超过三个任务时，如果 $f$ 使用 `int` 类型建立，则会产生溢出。因此 $f$ 应当采用 `long long` 类型。

擂台法核心代码：

```cpp
for (int i = 1; i <= m; ++i) {
	int pos = 0;
	long long cur = 5000000000000;
	for (int j = 1; j <= n; ++j) {
		if (f[j] < cur) {
			cur = f[j];
			pos = j;
		}
	}
	g[i] = pos;
	f[pos] += t[i];
}
```

输出核心代码：

```cpp
for (int i = 1; i <= n; ++i) {
	int flag = 0;
	for (int j = 1; j <= m; ++j) {
		if (g[j] == i) {
			printf("%d ", j);
			flag = 1;
		}
	}
	if (flag == 0) {
		printf("0");
	}
	printf("\n");
}
```

## 视频讲解

**完整代码请在视频题解中查看**。

![](bilibili:BV1jo4y1L7fz?page=6)



---


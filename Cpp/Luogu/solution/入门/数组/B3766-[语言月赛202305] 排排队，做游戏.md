# [语言月赛202305] 排排队，做游戏

## 题目描述

$n$ 名小朋友站成了一排，他们会按照体育老师的指令进行排队做游戏。

体育老师会向他们依次下发 $T$ 条指令，每条指令包含一个小于等于 $n$ 的正整数 $k$。

对某一条指令，小朋友们会按照如下步骤进行排队：

1. 该指令下发前，排在从左到右数第 $1, k + 1, 2k + 1, \cdots$ 位的小朋友，在指令下发后应该依次站在从左到右第 $1, 2, \cdots$ 个位置。
2. （如果 $k \geq 2$）该指令下发前，排在从左到右数第 $2, k + 2, 2k + 2, \cdots$ 位的小朋友，在指令下发后应该依次站在第一步中的小朋友（原来从左到右数第 $1, k + 1, 2k + 1, \cdots$ 位的小朋友）右边的第 $1, 2, \cdots$ 个位置。
3. （如果 $k \geq 3$）$3, k + 3, 2k + 3, \cdots$ 的小朋友站在第二步的小朋友右边，（如果 $k \geq 4$）$4, k + 4, 2k + 4, \cdots$ 的小朋友站在 $3, k + 3, 2k + 3, \cdots$ 的小朋友右边，以此类推，直至所有小朋友都被安排过（无论位置是否有变化）。

我们依次给出初始时从左到右每个小朋友的学号 $a _ 1, a _ 2, \cdots, a _ n$。现在我们想要知道，在 $T$ 次指令下发后，从左到右每个小朋友的学号依次是什么。

## 说明/提示

### 样例 1 解释

为了方便表述，我们先按照初始时的排队顺序将小朋友依次编号为 $1, 2, \cdots, 8$。下表为初始时及每次指令后队列中每个位置上的小朋友的编号。

| 队列中的位置 | 1 | 2 | 3 | 4 | 5 | 6 | 7 | 8 |
| :----------: | :----------: | :----------: | :----------: | :----------: | :----------: | :----------: | :----------: | :----------: |
| 初始时 | $1$ | $2$ | $3$ | $4$ | $5$ | $6$ | $7$ | $8$ |
| 第一个指令后 | $1$ | $2$ | $3$ | $4$ | $5$ | $6$ | $7$ | $8$ |
| 第二个指令后 | $1$ | $3$ | $5$ | $7$ | $2$ | $4$ | $6$ | $8$ |
| 第三个指令后 | $1$ | $7$ | $6$ | $3$ | $2$ | $8$ | $5$ | $4$ |
| 第四个指令后 | $1$ | $8$ | $7$ | $5$ | $6$ | $4$ | $3$ | $2$ |


### 样例 2 解释

前三个小朋友的学号分别是三个出题人的洛谷 UID。  
有人说学号是随机生成的，学号可不是随机生成的啊。

### 数据规模与约定

对于 $100\%$ 的数据，保证 $1 \leq n \leq 10 ^ 4$，$1 \leq T \leq 10 ^ 4$，$1 \leq k \leq n$，$1 \leq a _ i \leq 10 ^ 9$。

| 测试点编号 | $n$ | $T$ | 特殊限制 |
| :----------: | :----------: | :----------: | :----------: |
| $1$ | $= 1$ | $\leq 5 \times 10 ^ 3$ | 无 |
| $2 \sim 4$ | $\leq 10$ | $\leq 10$ | 无 |
| $5$ | $\leq 5 \times 10 ^ 3$| $\leq 5 \times 10 ^ 3$ | $k = 1$ |
| $6 \sim 8$ | $\leq 5 \times 10 ^ 3$ | $\leq 5 \times 10 ^ 3$ | 无 |
| $9 \sim 10$ | $\leq 10 ^ 4$ | $\leq 10 ^ 4$ | 无 |

## 样例 #1

### 输入

```
8 4
72818 21895123 25718513 289523 52783 18520 295123 285952
1 2 3 5```

### 输出

```
72818 285952 295123 52783 18520 289523 25718513 21895123```

## 样例 #2

### 输入

```
4 1
28910 65363 274993 653516
2
```

### 输出

```
28910 274993 65363 653516```

# 题解

## 作者：Maxmilite (赞：6)

## Source & Knowledge

2023 年 5 月语言月赛，由洛谷网校入门计划/基础计划提供。

## 题目大意

$n$ 个编号，从左向右依次为 $a _ 1, a _ 2, \cdots, a _ n$，每次给定一个整数 $k$，将其按照 $1, k + 1, 2k + 1, \cdots, 2, k + 2, 2k + 2, \cdots$ 的方式进行排布，询问在 $T$ 次排布后从左向右的编号。

## 题目分析

我们使用两个数组 $f, g$，其中 $f$ 存储当前的编号顺序信息，$g$ 用于暂存。暂存的实现方法下面会讲到。

首先进行读入过程，对于 $T$ 次排布，我们每次读入整数 $k$，接下来进行排布过程。

```cpp
const int MAXN = 10005;
int n, T;
int f[MAXN], g[MAXN];

cin >> n >> T;
for (int i = 1; i <= n; ++i)
    cin >> f[i];
while (T--) {
    int k;
    cin >> k;
    // ...
}
```

接下来，接下来使用二重循环完成排布。具体的，我们新建一个变量 `cnt`，用于指代当前已经放入了多少元素。二重循环第一重枚举 $i, k + i, 2k + i, \cdots$ 中的 $i$，第二重枚举 $k$ 前的系数。由于当 $i \gt k$ 时，$Xk + i$ 会被之前的 $(X + 1)k + (i - k)$ 等覆盖到，因此这里 $i$ 最大为 $k$。

```cpp
while (T--) {
    int k;
    cin >> k;
    int cnt = 0;
    for (int i = 1; i <= k; ++i) {
        for (int j = 0; i + j * k <= n; ++j) {
            int val = i + j * k;
            g[++cnt] = f[val];
        }
    }
}
```

为了不破坏 $f$ 的完整性，这里引入了 $g$ 数组，这也是「暂存」的实现方法：不断向 $g$ 数组中塞入新的元素（`g[++cnt] = f[val];`）。

最后，用 $g$ 覆盖 $f$ 即可。最终直接输出 $f$ 数组即可完成任务。

```cpp
while (T--) {
    // ...
    for (int i = 1; i <= n; ++i)
        f[i] = g[i];
}
for (int i = 1; i <= n; ++i)
    cout << f[i] << " ";
cout << endl;
```
 
## 视频讲解

![](bilibili:BV1kM4y1t7K5?page=5)



---


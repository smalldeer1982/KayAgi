# [语言月赛202302] 破碎的历史

## 题目描述

某 E 设计了一款抽卡模拟器，她希望能够抽到最好的卡片 CARD。

这款抽卡模拟器将在第 $5$ 次抽取保底。也就是说，如果前 $4$ 次抽取都没有抽中卡片 CARD，第 $5$ 次一定能够抽中卡片 CARD。

某 E 希望你设定第 $1$ 次至第 $4$ 次抽取抽中的概率 $p_1,p_2,p_3,p_4$，使得最后保底的概率为 $S$。

$p_1,p_2,p_3,p_4$ 应当在 $[0,1]$ 范围内，且精确到小数点后两位，如 $0.12$。

容易发现，$S = (1-p_1)\cdot(1-p_2)\cdot(1-p_3)\cdot(1-p_4)$。

某 E 想要知道一共有多少设置的方案。

## 说明/提示

对于 $10\%$ 的测试数据，$S = 1.0$；  
对于 $100\%$ 的测试数据，$0.0 \le S \le 1.0$。

## 样例 #1

### 输入

```
0.00353280```

### 输出

```
2520```

# 题解

## 作者：览遍千秋 (赞：4)

## Source & Knowledge

2023 年 2 月语言月赛，由洛谷网校入门计划/基础计划提供。


考察多重循环和小数处理。

---

## 文字题解

显然，本题涉及到 $p_1,p_2,p_3,p_4$ 共四个量，其中每一个量 $p_i$，均有 $101$ 种取值，即 $0.01,0.02,\dots,0.98,0.99,1.00$。很显然，我们可以以 `double` 类型作为循环变量，通过四重循环对 $p_1,p_2,p_3,p_4$ 进行枚举。

但是，浮点数的运算存在浮点误差，$(1-p_1)(1-p_2)(1-p_3)(1-p_4)$ 计算后与 $S$ 比较，由于存在浮点误差，直接使用 `==` 进行比较，很可能无法得到正确的结果。

对于这种情况，我们有两种处理方法：

- 设置浮点误差允许量 $\delta$。当 $|(1-p_1)(1-p_2)(1-p_3)(1-p_4)-S| < \delta$ 时，均认为相等。考虑到本题精度要求，$\delta$ 可取 $10^{-8}$。

- 对 $S$ 乘 $10^8$，$p_1,p_2,p_3,p_4$ 均乘 $100$。将浮点数转化为了整形进行处理。

---

## 视频题解

![](bilibili:BV1L24y1q7Tv?page=5)

---


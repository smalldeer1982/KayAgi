# [USACO06NOV] Round Numbers S

## 题目描述

如果一个正整数的二进制表示中，$0$ 的数目不小于 $1$ 的数目，那么它就被称为「圆数」。

例如，$9$ 的二进制表示为 $1001$，其中有 $2$ 个 $0$ 与 $2$ 个 $1$。因此，$9$ 是一个「圆数」。

请你计算，区间 $[l,r]$ 中有多少个「圆数」。

## 说明/提示

**【数据范围】**

对于 $100\%$ 的数据，$1\le l,r\le 2\times 10^9$。

------------

**【样例说明】**

区间 $[2,12]$ 中共有 $6$ 个「圆数」，分别为 $2,4,8,9,10,12$。

## 样例 #1

### 输入

```
2 12```

### 输出

```
6```

# 题解

## 作者：__Watcher (赞：46)

借此题，总结数位 dp 模板。

---

在洛谷上打上 `数位dp` 的标签，这是两道蓝题之一，很适合小结。借助代码来理解吧。下面是所有核心代码。

```cpp
int dfs(bool limit, bool lead, int pos, int cha) {
	if(pos==0) return cha>=30;
	if(!limit&&!lead&&vis[pos][cha]) return f[pos][cha];
	int res=0;
	int up=limit?a[pos]:1;
	for(int i=0;i<=up;i++) {
		res+=dfs(limit&(i==a[pos]), lead&(i==0), pos-1, cha+(i==0?(lead?0:1):-1));
	}
	if(!limit&&!lead) vis[pos][cha]=1, f[pos][cha]=res;
	return res;
}
```


变量说明：

$limit$：当前位能否取到最大值（此题中的 1，10 进制中就是能否取到 9）；

$lead$：当前位是否是前导 0；

$pos$：当前是从前向后的第 $pos$ 位。

$cha$：0 比 1 多多少。由于可能出现负数，统统加上了 30；

$vis(pos,cha),f(pos,cha)$：两个记忆化数组，记录没有限制且没有前导 0 时的情况是否搜索过，并记录搜索结果。

---
逐行解释：

`if(pos==0) return cha>=30;`   
如果当前所有位搜索完毕，0 比 1 多（差值大于 0）返回 1，否则返回 0。


`if(!limit&&!lead&&vis[pos][cha]) return f[pos][cha];`  
如果当前没有特殊限制并且已经搜索过了，直接返回。

`int up=limit?a[pos]:1;`  
当前位能去到的最大值。有限制那么就是原数中的 $pos$ 位，没有限制也只能取到 1.

`res+=dfs(limit&(i==a[pos]), lead&(i==0), pos-1, cha+(i==0?(lead?0:1):-1));`  
如果之前都有限制且这一位也顶上了位，那么 $limit$ 也是 1；如果之前都是前导 0 且这一位还是 0，那么这一位还是前导 0；位置就往下一位搜；计算新差值（前导 0 统统不算）。

`if(!limit&&!lead) vis[pos][cha]=1, f[pos][cha]=res;`  
当前不是特殊情况，那么就记忆下来。

---

小说明：

复杂度如何保证？当 $limit$ 是 1 或者 $lead$ 是 1 的时候并没有记忆化，那么如何保证复杂度？为了让 $limit$ 是 1，每一位都得顶位，只有 $len$ 种情况；如果让 $lead$ 是 1，那么每一位都得是 1，也只有 $len$ 种情况。因此，只有极少数情况未被记忆化，复杂度保障在 $len^2$ 的水平。

---

提供代码，仅供参考：

```cpp
#include<bits/stdc++.h>
using namespace std;
#define ll long long
int read() {
	int x=0, f=1; char ch=' ';
	while(!isdigit(ch)) {ch=getchar(); if(ch=='-') f=-1;}
	while(isdigit(ch)) x=(x<<3)+(x<<1)+(ch^48), ch=getchar();
	return x*f;
}
int a[50], len, f[50][65], vis[50][65];
int dfs(bool limit, bool lead, int pos, int cha) {
	if(pos==0) return cha>=30;
	if(!limit&&!lead&&vis[pos][cha]) return f[pos][cha];
	int res=0;
	int up=limit?a[pos]:1;
	for(int i=0;i<=up;i++) {
		res+=dfs(limit&(i==a[pos]), lead&(i==0), pos-1, cha+(i==0?(lead?0:1):-1));
	}
	if(!limit&&!lead) vis[pos][cha]=1, f[pos][cha]=res;
	return res;
}
int solve(int x) {
	len=0;
	while(x) {
		a[++len]=x%2;
		x/=2;
	}
	return dfs(1, 1, len, 30);
}
int main() {
	int l=read(), r=read();
	cout<<solve(r)-solve(l-1);
}

```



---

## 作者：Wenoide (赞：37)

# 思路

**为方便表述，定义函数 $f(l,r)$ 为区间 $[l,r]$ 中“圆数”的个数。**

显然，$f(l,r)=f(1,r)-f(1,l-1)$。

那么，如何快速求出 $f(1,x)$?

以 $14$ 为例。其二进制表示为 $(1110)_2$。$f(1,(1110)_2)$ 又可以拆分为两部分：

$$f((1)_2,(1)_2)+f((10)_2,(11)_2)+f((100)_2,(111)_2)$$

以及：

$$f((1000)_2,(1001)_2)+f((1010)_2,(1011)_2)+f((1100)_2,(1100)_2)$$

这些有什么共同点吗？我们发现，**在每个函数表示的区间中，每一个整数的二进制表示位数相同，且最高几位相同。**

也许我们可以预处理出一些东西？

# 预处理

由于最高几位相同，我们只需要关注余下的几位——这几位组成了一个 $01$ 串。

**用 $c(l,k)$ 表示长度为 $l$ 的，含有 $k$ 个 $0$ 的 $01$ 串的数目。即 $C_l^k$。**

最大数据的二进制表示不超过 $31$ 位。只需预处理 $1\le l<32$ 的情况即可。

简单的递推。参考代码：

```
void inti(){
	for(int i=1;i<32;++i){
		c[i-1][0]=1;
		for(int j=1;j<=i;++j){
			c[i][j]=c[i-1][j-1]+c[i-1][j];
		}
	}
	return;
}
```

# 计算

前面提到了，**在每个函数表示的区间中，每一个整数的二进制表示位数相同，且最高几位相同。**

假设在相同的最高几位中，$1$ 的个数比 $0$ 多 $k$。若一个数在这个区间中，且它是一个“圆数”，那么在其余下的几位中，$0$ 的个数应该比 $1$ **至少**多 $k$。

**我们用一个函数 $sum(l,k)$ 表示长度为 $l$ 的，$0$ 的个数比 $1$ 至少多 $k$ 的 $01$ 串的数目。**

$sum$ 的定义与 $c$ 相似，用已经预处理好的 $c$ 来求是理所当然的。参考代码：

```
int sum(int l,int k){
	int ans=0;
	for(int i=l;(i<<1)>=l+k;--i){
		ans+=c[l][i];
	}
	return ans;
}
```

回到之前由 $f(1,(1110)_2)$ 拆分出的两部分函数。

## 第一部分

$$f((1)_2,(1)_2)+f((10)_2,(11)_2)+f((100)_2,(111)_2)$$

这一部分的函数都是 $f(2^i,2^{i+1}-1)$ 形式的。第 $i$ 个函数的值即 $sum(i-1,1)$。

怎么理解？若一个数为“圆数”，则其二进制表示去掉最高位的 $1$ 后，剩下的部分应为**长度为 $i-1$ 的，$0$ 的个数比 $1$ 至少多 $1$ 的 $01$ 串**。

## 第二部分

$$f((1000)_2,(1011)_2)+f((1100)_2,(1101)_2)+f((1110)_2,(1110)_2)$$

我们发现，区间 $[(1000)_2,(1001)_2]$ 内的所有整数，二进制表示的**最高三位**都相同。且这三位中，$1$ 的个数比 $0$ 少 $1$。

类似的，$f((1000)_2,(1001)_2)=sum(1,-1)$。**$sum$ 的两个参数即为余下的位数，和相同部分中 $1$ 的个数与 $0$ 的个数之差。**

**枚举一个数二进制表示的次高位到末位，记当前位数之前 $1$ 的个数与 $0$ 的个数之差为 $k$。若第 $i$ 位为 $1$，$ans$ 加上 $sum(i-1,k-1)$。**

等等，为什么 $sum$ 的第二个参数是 $k-1$？

举个例子。$(1110)_2$ 的次高位为 $1$，我们需要计算 $f((1000)_2,(1011)_2)$。这一区间内整数的二进制表示的次高位应该是 $0$。可以类比 $21$ 世纪实际是指 $2000$ 年到 $2099$ 年。因此，第二个参数应为 $k-1$。

不过，这样是不会计算 $f((1110)_2,(1110)_2)$ 的。我们需要对这个数自身特判。可以直接利用枚举完毕后的 $k$。

这一部分应该是这道题最难理解的地方了。大家可以自己“拆”几个数字试试。

------------

参考代码：

```
int solve(int x){	//即 f(1,x)。
	int ans=0,t=0;
	bool p[32];
	while(x!=0){
		p[++t]=((x&1)==1);
		x>>=1;
	}
	//先将 x 转为二进制。
	for(int i=1;i<t;++i){
		ans+=sum(i-1,1);
	}
	//计算第一部分。
	int tot=1;
	//tot 即文中的 k。由于最高位一定是 1，因此 k 的初值为 1。
	for(int i=t-1;i>=1;--i){
		if(p[i]){
			ans+=sum(i-1,tot-1);
			++tot;
		}
		else{
			--tot;
		}
	}
	//计算第二部分。
	if(tot<=0){
		++ans;
	}
	//特判 x 是否为“圆数”。
	return ans;
}
```

---

## 作者：B_1168 (赞：19)

提供一个思维难度简单的打表做法

~~我太蒻了，数位DP都不会qwq~~

显然，暴力做法的时间复杂度为$O(nlog_2{n})$看看数据范围，发现不可承受，如何是好？

考虑到USACO测试中提供5小时的时间攻克3道题目，我们完全可以承受花费几分钟时间打表；然而，一般地，我们的提交程序大小不能超过32KB（至少这应该是洛谷和NOIP的规定），使得我们不能单纯打表。

不妨先写一个暴力看看：

```cpp
#include<bits/stdc++.h>
using namespace std;

int l,r,ans;

int ver(int k){
	int a0=0,a1=0,p=k;
	while(p){ //用O(log(n))的时间代价逐个数验证
		if(p&1) a1++;
		else a0++;
		p>>=1;
	}
	if(a0>=a1) return 1;
	else return 0;
}

int main(){
	scanf("%d%d",&l,&r);
	for(int i=l;i<=r;i++){
		ans+=ver(i);
	}
	printf("%d\n",ans);
} 
```
留意到这里的一个$ver(i)$函数，我们约定：用$ver(i)$的值表示$i$是否是“圆数”。

鉴于这个暴力吸了氧也只能拿60分，考虑打表一个数组，$table_i$（简单粗暴命名法），使得：

$table_i=\sum\limits_{k=1}^{10^6\times i} ver(i)$

这样，给定任意一个$p$，设$p$整除$10^6$的值为$q$，则$\sum\limits_{i=1}^{p} ver(i)=table_{q}+\sum\limits_{i=q\times10^6+1}^{p} ver(i)$

如此这般，考虑到$l\leq r \leq 2\times 10^9$，我们便可以将总共需要打表的数据数量压缩到2000个数，代码总长控制在20kb之内，并将时间复杂度控制在$O(qlog_2{q})$级别！

打表程序可以很容易的从上面的60分暴力程序改造出来，略过不表：以下提供AC代码：

```cpp
#include<bits/stdc++.h>
using namespace std;

//高能打表

const int table[2005]={0,483212,912008,1496047,1936710,2497049,2953836,3372377,3666046,4224609,4888435,5470687,5985204,6473508,6997710,7407121,7759888,8114246,8841202,9418915,9988999,10387703,10975302,11401951,11825190,12093372,12647109,13090291,13513784,13806423,14173972,14478373,14726176,14902859,15366960,16201541,16950748,17658367,18268984,18993614,19575038,20140363,20548986,21286246,21888932,22491383,22921271,23499961,23944182,24358905,24649517,25239333,25899457,26483106,26967731,27475420,27991458,28403584,28751667,29097194,29645428,30054847,30430558,30692950,31084403,31322215,31584664,31722784,32527953,33310112,34055961,34701584,35395499,36047985,36635786,37121164,37692107,38382504,38971194,39498926,39958625,40492390,40907482,41282752,41573188,42308110,42882438,43478493,43906876,44492036,44934441,45350847,45627800,46146335,46616525,47028856,47334412,47671874,48002942,48259763,48448125,48799637,49508491,50092717,50647285,51071367,51639722,52038237,52431729,52694622,53287273,53720987,54139486,54415411,54804200,55096784,55348037,55513038,55922617,56415984,56836115,57174501,57496304,57845934,58089661,58302816,58498196,58876476,59121009,59354387,59477906,59739331,59878002,60014029,60076643,60832929,61739336,62607725,63415911,64214443,65027775,65781109,66473788,67140388,67984879,68727353,69442860,70048316,70777285,71356714,71927618,72320180,73203960,73972480,74726814,75349646,76062801,76700591,77294730,77764296,78374089,79037922,79616994,80132387,80621812,81145062,81554249,81907967,82276494,83133241,83872636,84609414,85185284,85934320,86540180,87140810,87576880,88275274,88900647,89499996,89967525,90493471,90975179,91381110,91701463,92183365,92877836,93467319,93999860,94444353,94999986,95405882,95788119,96047470,96620172,97037422,97462900,97725833,98136940,98409864,98663526,98818321,99452764,100262374,101006822,101670764,102336625,103029697,103616490,104146672,104632412,105352101,105936318,106494260,106910321,107481791,107877826,108305861,108569162,109284495,109906642,110495619,110955508,111499976,111967859,112383147,112690189,113119063,113632180,114048160,114392411,114702040,115053406,115308109,115525006,115722990,116458302,117032797,117625403,118052825,118640976,119080868,119498192,119773328,120294996,120763905,121176200,121480775,121821271,122148660,122406112,122593572,122908349,123441282,123847200,124219125,124493965,124879234,125120763,125352629,125488847,125910474,126175283,126434106,126578569,126818609,126973480,127106914,127179226,127734914,128651662,129523981,130359704,131133859,131977434,132718117,133441887,134049617,134907729,135648920,136386413,136972604,137732340,138344004,138940902,139384120,140136340,140938928,141688413,142343653,143012434,143678155,144269096,144784195,145316040,146022471,146604705,147142583,147587117,148145663,148548773,148938390,149174785,150056636,150825115,151578168,152202071,152916389,153551930,154145817,154616399,155227242,155890809,156466934,156983222,157473887,157996022,158406211,158760175,159116878,159843317,160420538,160991142,161391777,161971486,162399241,162822781,163089413,163646773,164091959,164511654,164804119,165171416,165477730,165725315,165897984,166370077,167205852,167953647,168661112,169269285,169995863,170577198,171140558,171552827,172290912,172885964,173489360,173918835,174499941,174943215,175355166,175646659,176243029,176900711,177484893,177970032,178475224,178991373,179401406,179751401,180100759,180644644,181053852,181431769,181694035,182085383,182317175,182580079,182717832,183431847,184053531,184644428,185102035,185647873,186115962,186531185,186838183,187266365,187780616,188196309,188539203,188849867,189202193,189454431,189671509,189861802,190431655,190828287,191235561,191497541,191915885,192184556,192442023,192585245,192958205,193250701,193503241,193666748,193875750,194053386,194189008,194276770,194627222,195471713,196215551,196939986,197535093,198268868,198845245,199417121,199840082,200590088,201201582,201799399,202244159,202797347,203262572,203676563,203978505,204509505,205175731,205775376,206291735,206768780,207297793,207703379,208069057,208381790,208938856,209344894,209736557,209975420,210402035,210666237,210924875,211067401,211708324,212355104,212947136,213417773,213935434,214421225,214831734,215166326,215565753,216094199,216502504,216854711,217149788,217525464,217769659,217998091,218124678,218721488,219149987,219568942,219841818,220240823,220518682,220777322,220934231,221272227,221578365,221821770,222005307,222209933,222398422,222531972,222625439,222865780,223591447,224170069,224739027,225141273,225716606,226144886,226568495,226834562,227393286,227839376,228256982,228549355,228916573,229223598,229471646,229642847,230016667,230536044,230948410,231298361,231590491,231963310,232212253,232431710,232585590,232979157,233224571,233486140,233624745,233879142,234022282,234153992,234222780,234692541,235167206,235576519,235886423,236228638,236564803,236815352,237012684,237247497,237606795,237857993,238077788,238224378,238455291,238571998,238706847,238767287,239177109,239449160,239704796,239852430,240090751,240247537,240380948,240455165,240635356,240822587,240957180,241045988,241143803,241238442,241295027,241336697,241475587,242453834,243393509,244339749,245221407,246155922,247047795,247918179,248701453,249571816,250479070,251346239,252157134,252950418,253777255,254529543,255223516,255891646,256822800,257687849,258543447,259292758,260153288,260892697,261630169,262229941,263094738,263864491,264622065,265247356,265954225,266599821,267190269,267667909,268339267,269251902,270127276,270961742,271737096,272579664,273322128,274042310,274653636,275510591,276252915,276989958,277568085,278333035,278943229,279540301,279981216,280740690,281540021,282291148,282942003,283616180,284280595,284867019,285380042,285919466,286621940,287206263,287739010,288188864,288745793,289148495,289537112,289779241,290728431,291612705,292483955,293265912,294101799,294890300,295645199,296296138,297032448,297844340,298584871,299272787,299923888,300618781,301207646,301741098,302230441,303085712,303827283,304561785,305140149,305877116,306485760,307086545,307519541,308224480,308852313,309445857,309912371,310440892,310923308,311330332,311642255,312173250,313009122,313756294,314462598,315073263,315797705,316380620,316939867,317357466,318095045,318682568,319285880,319717233,320298129,320741151,321150265,321442627,322044890,322700586,323285256,323772176,324273670,324789035,325199833,325548958,325903211,326442201,326854000,327231308,327494989,327884684,328119238,328375157,328512920,329388576,330282334,331150722,331944196,332766234,333570101,334318141,334981758,335684384,336518277,337267436,337966746,338591095,339300723,339886512,340443089,340881510,341743724,342482205,343228883,343835512,344583832,345200972,345794936,346239640,346905790,347555173,348141021,348623472,349125490,349623813,350042347,350380986,350831904,351676359,352416846,353143157,353739533,354471633,355047722,355621162,356036135,356790794,357399720,357999986,358443225,358995532,359461065,359876828,360176174,360713536,361377790,361975354,362491306,362968744,363499709,363905731,364267108,364584064,365142708,365546671,365938159,366170691,366599112,366862082,367120628,367262750,367995647,368792193,369544649,370194093,370870603,371534451,372118789,372632649,373174024,373876079,374460457,374993753,375442728,375999489,376400750,376790360,377034250,377788742,378395034,378993516,379431958,379999951,380444551,380867627,381160376,381640765,382121368,382526688,382851782,383191686,383528335,383784076,383981651,384268817,384993054,385574513,386140413,386545605,387117326,387541754,387966457,388230506,388794740,389239577,389655169,389946171,390319217,390621929,390871910,391038430,391418724,391935629,392347840,392695732,392993996,393360379,393610900,393827699,393988327,394380052,394620273,394882309,395020786,395275618,395418271,395551287,395618428,396295778,397205572,398071467,398884970,399681163,400514139,401260608,401966026,402604798,403452372,404199368,404927319,405515161,406250986,406824253,407422522,407851066,408680017,409462708,410211798,410846204,411547204,412199516,412787360,413270882,413839448,414531059,415122754,415643265,416110885,416645660,417053608,417426945,417736109,418597984,419336731,420079430,420687012,421436488,422052382,422646248,423092190,423758424,424407583,424992004,425475505,425978503,426473718,426892574,427231961,427659770,428367197,428943923,429499996,429931436,430493506,430894569,431288591,431534910,432135720,432565902,432987789,433260868,433648258,433940239,434195825,434354758,434916771,435729824,436484879,437177866,437813375,438520127,439101452,439643671,440103961,440832689,441412198,441983636,442375452,442983096,443411752,443831617,444103388,444766615,445405902,445999916,446468734,446991373,447475204,447878242,448213945,448621013,449145047,449554304,449907469,450201357,450576283,450817999,451049025,451184599,451935569,452540949,453141141,453577707,454147485,454590970,455014431,455306980,455788767,456269762,456675748,456998093,457339051,457676604,457930923,458128372,458387762,458942582,459348547,459731870,459983283,460376353,460630797,460892269,461030102,461434402,461707822,461961464,462115973,462348474,462509078,462640643,462714991,463177006,464011488,464758802,465463535,466077919,466798477,467382742,467940285,468362078,469099155,469678752,470284844,470714796,471297378,471738860,472152047,472438896,473048611,473700180,474288744,474773499,475272585,475785855,476200828,476545532,476905906,477438514,477854000,478229340,478495185,478883571,479121681,479370425,479507969,480231517,480855205,481446859,481895110,482447041,482916692,483328882,483634053,484065718,484576156,484993866,485331348,485649798,486001606,486248285,486463328,486666998,487234653,487633511,488025709,488288613,488709740,488975741,489233770,489378815,489752435,490044466,490296483,490460602,490674077,490843357,490979851,491067568,491409086,492115537,492693537,493246741,493680387,494240411,494643506,495036491,495279793,495881378,496312451,496733538,497006505,497393243,497685595,497941139,498099651,498527305,499014427,499428653,499764588,500089557,500439452,500687933,500889218,501097183,501474925,501719281,501949270,502068454,502325437,502463190,502598847,502661429,503192440,503646160,504064750,504359603,504723897,505030931,505272585,505459897,505741864,506083166,506333704,506534041,506704636,506921518,507046906,507161380,507233283,507634648,507897047,508157680,508297266,508547909,508692163,508827326,508896128,509111685,509276620,509406391,509484760,509593083,509681374,509739874,509775355,510039529,511016960,511957181,512896123,513759548,514699155,515578028,516456007,517224783,518126980,519021868,519892066,520691879,521505184,522314586,523059043,523723142,524450737,525376522,526243482,527086384,527847926,528700404,529444825,530172660,530762021,531624266,532365487,533132405,533741703,534478756,535100567,535690293,536148997,536899945,537807221,538675479,539488157,540282910,541114434,541863895,542566183,543208838,544053369,544802528,545529561,546118292,546853761,547428219,548019312,548446618,549283182,550064160,550814971,551443139,552150169,552800463,553388077,553869162,554443723,555129136,555722862,556239035,556712644,557245033,557651046,558023460,558342937,559282052,560145118,561007366,561774556,562641408,563414907,564168967,564796135,565579956,566381326,567127356,567789187,568451322,569120043,569718434,570235711,570785808,571628998,572370118,573093017,573693480,574421317,575001873,575573419,575977215,576736424,577348508,577945756,578388533,578940131,579406212,579822689,580118477,580720544,581534136,582285783,582977405,583615918,584321599,584904178,585441129,585907965,586636120,587215583,587785100,588180081,588779756,589208335,589626934,589899794,590569102,591203699,591797537,592268412,592791277,593275205,593675146,594010075,594421449,594942653,595353570,595707169,596000160,596373868,596617918,596846358,596989638,597933290,598816443,599691838,600468425,601309561,602093644,602849499,603498497,604239835,605051711,605794116,606470412,607126878,607822532,608410061,608942701,609436652,610293508,611035983,611767771,612348959,613087008,613680733,614284114,614714086,615430124,616055078,616642502,617108483,617645744,618121410,618530723,618839899,619380985,620215340,620960579,621667064,622282594,622999827,623583903,624143366,624566432,625303355,625874652,626483232,626912008,627495962,627936745,628352543,628635079,629251033,629900948,630491202,630975088,631470602,631985113,632400750,632743285,633108042,633642074,634054350,634429465,634695023,635085453,635323304,635565849,635703240,636537952,637316883,638068724,638693688,639403404,640052831,640640604,641121368,641698630,642381592,642975676,643492491,643966650,644499268,644902804,645276218,645588955,646322462,646898726,647470844,647892349,648491348,648921173,649343769,649617379,650144563,650609430,651024137,651325385,651677730,651985039,652245575,652432899,652811823,653516456,654097957,654646031,655083396,655640610,656046339,656437876,656675441,657280606,657710879,658131500,658403225,658794546,659082341,659339424,659495639,659931700,660417063,660826578,661160971,661491480,661836941,662087287,662284932,662498532,662873683,663117823,663346117,663471240,663721286,663858893,663995073,664057086,664850932,665751036,666622187,667426581,668232064,669044304,669784279,670473991,671158335,671995742,672742246,673451072,674062282,674787530,675366691,675934858,676340256,677205088,677973047,678731568,679346649,680071218,680698840,681293028,681760543,682382214,683045864,683627530,684120687,684622548,685141428,685553814,685903359,686291256,687147558,687890398,688620588,689203475,689941284,690531336,691134633,691565566,692282759,692907573,693492951,693959970,694498280,694972476,695381656,695691820,696189968,696882738,697467253,697999790,698454929,698995966,699406407,699784450,700060912,700631865,701024374,701448675,701711624,702124754,702396954,702652498,702800041,703468898,704272315,705020854,705684653,706338572,707030452,707621209,708144353,708647618,709356567,709943019,710499654,710918345,711489717,711886465,712289297,712551597,713287948,713905892,714499906,714944021,715499976,715967490,716378329,716683795,717123865,717624037,718042731,718380971,718701704,719052404,719294757,719511304,719739008,720471767,721048193,721620922,722037932,722638084,723066683,723490175,723763268,724291298,724756125,725171943,725472129,725825753,726133537,726391830,726579254,726912369,727442536,727848523,728211175,728497607,728874306,729120532,729352053,729468773,729896856,730160085,730418631,730560820,730805314,730955300,731090858,731159671,731725355,732538141,733285783,733975473,734619696,735322230,735906621,736439518,736911809,737638793,738217720,738786682,739184694,739777118,740204484,740625905,740895898,741572169,742201442,742799525,743268343,743793251,744274617,744678516,745005764,745422660,745939430,746354431,746705476,746998242,747370138,747617911,747843039,747993663,748730760,749338305,749939447,750371561,750946617,751392553,751808643,752099943,752588859,753070295,753477717,753788643,754134760,754472123,754724734,754920496,755190541,755741939,756150306,756526562,756787185,757179246,757420869,757682408,757821162,758228094,758501306,758752504,758907264,759142824,759300425,759433235,759508668,759938554,760630610,761216695,761747192,762204196,762741877,763154363,763531320,763809912,764379870,764773869,765193823,765456738,765869858,766142675,766398261,766544872,767040977,767511608,767923883,768230707,768564496,768900674,769156716,769346386,769596752,769950625,770199076,770415167,770567192,770796465,770919459,771037520,771097936,771687409,772122357,772541053,772816177,773205848,773498340,773749180,773914476,774223705,774541389,774798935,774988205,775181020,775378362,775502931,775608084,775751662,776133120,776375084,776609848,776736114,776997418,777135668,777272160,777334784,777569193,777724388,777858974,777929437,778045596,778121310,778179010,778212307,778598526,779529063,780393484,781245323,781999452,782856828,783598695,784335661,784907944,785792027,786560449,787316149,787937827,788650132,789290590,789884814,790352939,791017551,791830192,792576297,793266875,793911626,794613297,795197534,795731166,796203298,796930365,797508366,798078204,798476789,799065440,799492189,799915109,800183647,800950186,801734621,802492524,803141873,803820930,804481447,805062958,805567487,806124099,806817371,807408024,807940601,808386501,808940867,809346924,809730834,809990123,810727338,811330944,811932912,812363564,812941455,813386124,813801141,814091848,814584453,815063606,815472247,815780254,816127918,816464256,816716805,816912146,817237937,818091419,818835875,819562970,820149841,820886936,821469340,822074304,822505123,823225446,823849273,824435485,824899366,825441234,825911732,826324525,826633345,827133656,827824375,828412638,828940937,829400034,829934626,830349318,830724904,831005575,831574223,831970134,832385764,832648755,833062473,833335203,833591251,833736800,834342436,834994454,835582151,836065308,836559121,837071853,837488953,837827398,838200376,838734585,839142336,839515484,839786784,840174532,840414772,840647994,840785736,841377304,841811209,842229722,842505569,842894362,843186734,843437263,843603028,843914197,844229638,844488108,844676996,844870561,845067161,845193796,845296391,845492093,846351457,847091425,847829337,848420311,849179107,849789580,850388173,850831301,851500952,852149018,852739600,853214320,853726800,854213031,854628321,854964494,855407194,856114324,856695560,857237502,857678248,858238133,858641236,859032310,859265061,859871328,860300034,860719603,860991648,861388385,861669609,861927154,862084039,862615037,863278864,863858859,864374134,864863272,865386717,865795870,866149497,866479831,867036522,867436187,867827295,868070005,868473758,868735959,868996649,869136548,869684444,870128238,870550705,870843120,871210593,871515758,871763546,871938336,872228427,872566267,872820144,873017726,873186684,873403111,873532762,873641250,873739610,874477081,875076665,875679677,876108571,876688872,877132245,877546370,877836732,878332396,878809979,879219453,879526866,879874283,880210555,880462403,880658690,880935686,881482498,881891706,882268216,882530497,882921935,883157314,883420013,883557950,883967379,884238722,884493386,884643834,884881219,885036949,885171434,885245677,885608349,886121315,886536766,886881003,887190541,887541676,887797038,888014060,888185101,888573773,888811709,889059222,889196713,889454112,889595471,889730745,889793746,890155904,890449810,890702512,890866535,891072827,891253129,891388632,891476076,891634982,891832736,891960407,892064528,892143962,892254142,892308187,892355544,892376924,893227015,894001685,894754645,895382430,896089509,896737947,897323766,897806050,898390237,899061283,899658314,900176178,900651837,901182634,901585568,901954948,902280406,903009617,903588904,904161074,904566986,905169174,905600521,906021222,906294147,906821819,907289191,907705199,908002402,908359409,908669740,908920774,909107657,909498481,910205350,910787353,911326148,911769870,912328830,912731723,913121319,913357122,913959525,914388125,914807045,915079711,915477324,915757012,916014594,916172026,916618028,917101788,917501390,917837510,918172409,918513784,918764911,918965334,919179937,919554570,919797177,920027101,920157176,920394621,920532286,920669228,920730194,921406604,922032594,922630201,923097785,923623801,924106237,924512294,924830626,925252747,925771487,926184484,926535184,926825112,927199951,927447544,927669362,927826431,928399933,928814724,929240279,929503895,929915149,930188215,930440512,930595641,930950713,931249918,931500570,931667727,931875050,932062415,932194278,932286884,932530779,933075398,933484621,933862181,934124286,934515900,934748269,935011161,935148926,935558849,935829772,936085305,936234928,936472832,936628860,936763118,936837369,937109815,937444736,937700519,937891981};

int l,r;

int ver(int k){
	int a0=0,a1=0,p=k;
	while(p){  //完  全  一  致
		if(p&1) a1++;
		else a0++;
		p>>=1;
	}
	if(a0>=a1) return 1;
	else return 0;
}

int calc(int k){
	int ans=table[k/1000000];
	for(int i=(k/1000000)*1000000+1;i<=k;i++){//特别留意，要+1
		ans+=ver(i);
	}
	return ans;
}

int main(){
	scanf("%d%d",&l,&r);
	printf("%d\n",calc(r)-calc(l-1));
} 
```
在吸入$O(2)$后，本程序以265ms通过该题！

这种做法也适用于[P1662 数7](https://www.luogu.com.cn/problem/P1662)、[P1822 魔法指纹](https://www.luogu.com.cn/problem/P1822)、[P2657 windy数](https://www.luogu.com.cn/problem/P2657)等题目，欢迎大佬们一次多切！

感谢管理审核，如果感觉有帮助，欢迎点赞~

---

## 作者：IntrepidStrayer (赞：19)

## 题解

这是一道**数位DP**。

令 $dp_{i,j,k}$ 为满足**由 $i$ 位组成，且其中有 $j$ 个1，第 i 位（从右往左数）为 $k$ 的**二进制数的数量。

可以得出状态转移方程：

$dp_{i,j,0}=dp_{i-1,j,1}+dp_{i-1,j,0}\;(2\le i,0\le j< i)$

$dp_{i,j,1}=dp_{i-1,j-1,0}+dp_{i-1,j-1,1}\;(2\le i,0<j\le i)$

边界：$dp_{1,0,0}=1,dp_{1,1,1}=1$

令 $f(x)$ 为区间 $[1,x-1]$ 内的“圆数”个数，则区间 $[L,R]$ 内的“圆数”个数为 $f(R+1)-f(L)$。

对于求$f(x)$，我们先将 $x$ 转换成二进制，设其二进制位数为 $len$。

1. 将二进制位数小于 $len$ 的“圆数”个数统计到答案中。

2. 对于 $x$ 的二进制除首位外的每一位 $i$，都判断其是否为1 。如果为1，说明存在一些数，它们小于 $x$，且二进制表示中的前 $i-1$ 位与 $x$ 相同，第 $i$ 位为0 。然后将这些数中的“圆数”个数加入答案即可。

## 代码

略微压行，轻喷。
```cpp
#include <cstdio>
#include <cstring>

using namespace std;

#define in __inline__
typedef long long ll;
#define rei register int
#define FOR(i, l, r) for(rei i = l; i <= r; ++i)
#define FOL(i, r, l) for(rei i = r; i >= l; --i)
char inputbuf[1 << 23], *p1 = inputbuf, *p2 = inputbuf;
#define getchar() (p1 == p2 && (p2 = (p1 = inputbuf) + fread(inputbuf, 1, 1 << 21, stdin), p1 == p2) ? EOF : *p1++)
in int read() {
	int res = 0; char ch = getchar(); bool f = true;
	for(; ch < '0' || ch > '9'; ch = getchar())
		if(ch == '-') f = false;
	for(; ch >= '0' && ch <= '9'; ch = getchar())
		res = res * 10 + (ch ^ 48);
	return f ? res : -res;
}
const int N = 40;

ll dp[N][N][2];
int a, b, A[N], la, lb, B[N];

ll solve(int x[], int len) {
	ll res = 0; int s0 = 0, s1 = 1;
	//s0表示0的个数，s1表示1的个数
	FOL(i, len - 1, 1) FOR(j, 0, (i >> 1)) res += dp[i][j][1];//第1类数
	FOL(i, len - 1, 1) {//第二类数
		if(x[i]) FOR(j, 0, i) if(s0 + i - j >= s1 + j) res += dp[i][j][0];
		x[i] ? (++s1) : (++s0);
	}
	return res;
}

signed main() {
	a = read(), b = read();
	for(; a; a >>= 1) A[++la] = a & 1;
	for(; b; b >>= 1) B[++lb] = b & 1;//转换成二进制
	++B[1];
	for(rei i = 2; i <= lb && B[i - 1] == 2; ++i) B[i - 1] = 0, ++B[i];
	if(B[lb] == 2) B[lb] = 0, B[++lb] = 1;
	while(!A[la]) --la;
	while(!B[lb]) --lb;//给B加上1
	dp[1][0][0] = dp[1][1][1] = 1;
	FOR(i, 2, lb) FOR(j, 0, i) {//DP
		if(j < i) dp[i][j][0] = dp[i - 1][j][1] + dp[i - 1][j][0];
		if(j) dp[i][j][1] = dp[i - 1][j - 1][0] + dp[i - 1][j - 1][1];
	}
	printf("%lld\n", solve(B, lb) - solve(A, la));
	return 0;//结束
}

```

---

## 作者：do_while_false (赞：15)

【大概思路】

很显然的数位DP，我们可以采用记忆化搜索的形式解决。

设 $f_{a,b,c}$ 记录剩下 $a$ 位二进制位并且已有 $b$ 个 $0$，$c$ 个 $1$ 的 “Round Number” 个数。

设 $sum0$ 为已有的 $0$ 的数目，设 $sum1$ 为已有的 $1$ 的数目

边界条件显然，返回值 $ =\begin{cases}1&sum0\ge sum1\\0&sum0<sum1\end{cases}$

至于具体的状态转移方程，可以看代码理解($\LaTeX$太难打了)

【具体代码】

```cpp
#include<bits/stdc++.h>
#define ll long long
ll f[35][35][35],l,r;
int a[35];
ll dfs(int len,int sum0,int sum1,bool full,bool zero) {
	//len代表还剩下的二进制位的长度
	//zero代表是否还在前导零中（前导零的数目不计入零的数目中）
	if(!len)
		if(zero||sum0>=sum1) return 1; 
		else return 0;
	if(!zero&&!full&&f[len][sum0][sum1]) return f[len][sum0][sum1];
	ll sum=0;
	for(int i=0;i<=(full?a[len]:1);++i)
		if(zero&&!i) sum+=dfs(len-1,0,0,full&&i==a[len],1);
		else
			if(i) sum+=dfs(len-1,sum0,sum1+1,full,0); 
			else sum+=dfs(len-1,sum0+1,sum1,full&&i==a[len],0);
	if(!zero&&!full) f[len][sum0][sum1]=sum;
	return sum;
}
ll make(ll x) {
	a[0]=0;
	while(x) {
		a[++a[0]]=x&1;
		x>>=1;
	}
	return dfs(a[0],0,0,1,1);
}
int main(void) {
	scanf("%lld%lld",&l,&r);
	printf("%lld",make(r)-make(l-1));
	return 0;
}
```

---

## 作者：hzoi_liuchang (赞：10)

## 分析
比较套路的数位 $DP$ 

数位 $DP$ 的实质就是换一种暴力枚举的方式，使得新的枚举方式满足 $DP$ 的性质，然后记忆化就可以了。

首先，我们要进行 $DP$ 的话，肯定要定义一个 $f$ 数组存储我们计算过的值

因为这道题和数位有关，所以第一位我们要定义当前遍历到了第几位

而且我们还要判断二进制下 $0$ 的数量和 $1$ 的数量

所以，我们设 $f[i][j][k]$ 为当前遍历到第 $i$ 位,二进制下 $1$ 的数量为 $j$，$0$ 的数量为 $j$ 的数的个数

主函数我们用差分的思想搞一下即可
``` cpp
signed main(){
	memset(f,-1,sizeof(f));
	int l,r;
	scanf("%lld%lld",&l,&r);
	printf("%lld\n",solve(r)-solve(l-1));
	return 0;
}
```
然后是 $solve$ 函数

这里的 $cnt$ 是用来记录当前的数在二进制下有多少位，$num$ 数组是用来记录这个数每一二进制位上的数字的

这个函数的变量只有一个 $xx$, 返回值是 $0$ 到 $xx$ 之间圆数的个数
``` cpp
int solve(int xx){
	memset(num,0,sizeof(num));
	cnt=0;
	while(xx){
		num[++cnt]=xx&1ll;
		xx>>=1ll;
	}
	return dfs(cnt,0,0,1,1);
}
```

下面的 $dfs$ 函数是最重要的部分
``` cpp
int dfs(int ws,int tot1,int tot0,bool lim,bool zer){
	if(ws==0) {
		if(tot1<=tot0) return 1;
		return 0;
	}
	if(lim==0 && zer==0 && f[ws][tot1][tot0]!=-1) return f[ws][tot1][tot0];
	int up=1,ans=0;
	if(lim) up=num[ws];
	for(int i=0;i<=up;i++){
		if(zer==1 && i==0) ans+=dfs(ws-1,0,0,lim && i==up,1);
		else ans+=dfs(ws-1,tot1+(i==1),tot0+(i==0),lim && i==up,0);
	}
	if(lim==0 && zer==0)f[ws][tot1][tot0]=ans;
	return ans;
}
```

它的五个参数分别为:当前处理到第 $ws$ 位

$0$ 的个数 $tot0$ ,$1$ 的个数 $tot1$

$lim$ 特判前一位是否为范围内的最大值

$zer$ 记录有没有前导零

终止条件就是处理到最后一位

具体的边界看一下下面的模板
``` cpp
 #include<bits/stdc++.h>
 using namespace std;
 typedef long long ll;
 //数位DP一般数据范围很大，所以要开long long 
 ll f[now][zt][da];
 //now=当前枚举到的数位，一般从高位到低位枚举
 //zt=枚举到上一位时的状态，即now+1位
 //da=你想要到达的状态
 //eg: 比如你想要求一个数能否被它所有数位上的数字整除
 //你就可以定义状态为f[当前的数位][上次枚举到的数][之前所有数位的最小公倍数]
 //当然,f数组也有可能开到4维，看具体情况
 ll num[20];
 //num数组记录你要求解的数的每一位上的数字，一般开20就可以了
 ll dfs(ll pos,ll state,ll lead,ll limit/*,ll zer 前导0，视情况而定*/){
 //pos当前的位数，state上一位的状态，lead想要达到的状态，limit判断前一位是否为最高位
 //为什么要判断最高位呢?
 /*
 我们来举一个例子
 比如说我们要求的数为5456
 我们把它的千位设为第3位，百位设为第2位，十位设为第1位，个位设为第0位
 当它的第三位为0、1、2、3、4时，它的第二位可以从0枚举到9
 但是当它的第三位枚举到5时，第二位的数就只能枚举到4
 所以我们用一个变量limit记录前一位能不能达到最大值，如果上一位达到了最大值，那么这一位就只能枚举到当前位上的数
 如果上一位没有达到最大值，那么这一位就可以从0到9随便枚举
 */
     if(pos<0){
         if(/*满足情况*/)return 1;
         else return 0;
     }    
     //递归边界，即遍历到了最后一位
     //这时要结合实际情况判断返回1或0
     if(!limit && f[pos][state][lead]!=-1) return f[pos][state][lead];
     //记忆化
     //如果当前的f值已经求出来过，并且没有数位限制，那我们就可以直接用
     //如果有数位限制，那我们就不能直接用，因为我们不知道这两次的数位限制是否相等
     ll up=limit?num[pos]:9;  //枚举上界
     //如果没有限制，随便遍历
     //有限制，只能遍历到当前位
     ll ans=0;               //计数
     for(int i=0;i<=up;i++){
     //枚举，然后把不同情况的个数加到ans就可以了
         ans+=dfs(pos-1,/*状态转移*/nowstate,/*当前的状态，视情况而定*/nowlead,
         /*想要达到的状态，可能变，也可能不变*/limit && i==up);
         /*最后一个参数是判断最高位
         ==的优先级要高于位运算，所以其实就是一个判断当前数字是否为该位上的最大数字的操作
         如果上一位有限制并且当前枚举到的是该数位上合法的最大的数字，我们就传1，否则传0
         比如2345
         当我们的千位上枚举到1，百位上枚举到9时，虽然9是最大的数字。但是第一个条件jud==1并不满足，所以这时我们要传0
         当我们的千位上枚举到2，百位上枚举到3时，这时两个条件都满足，所以这时我们要传1*/
     }
     if(!limit) f[pos][state][lead]=ans;
     //如果没有限制，更新f值
     return ans;
     //返回结果
 }
 ll solve(ll x){
     ll tot=0;
     memset(num,0,sizeof(num));
     while(x){
         num[tot++]=x%10;
         x/=10;
     }
     //将x的每一位都扔到数组里，方便求解
     return dfs(tot-1/*传最高位*/,0/*当前的状态，一般是0*/,0/*想要达到的状态，一般也是0，不过要是有取模、除法什么的还要特殊考虑*/
     ,1/*上一位数是否达到了最高位，显然达到了，所以传1*/);
     //有些情况还要判断是不是有前导0，比如统计数字出现的次数，最长上升子序列等等
     //因为有些情况前导0会对结果造成影响，有些则不会
 }
 int main(){
     ll a,b;
     scanf("%lld%lld",&a,&b);
     //一般都是读入两个数，求区间[a,b]中符合要求的数的个数
     ll ans=solve(b)-solve(a-1);
     //一般用差分解决问题
     printf("%lld\n",ans);
     return 0;
 }
```
## 代码
``` cpp
#include<bits/stdc++.h>
using namespace std;
#define int long long
int f[60][60][60],num[55],cnt,sum[55];
const int mod=1e7+7;
int dfs(int ws,int tot1,int tot0,bool lim,bool zer){
	if(ws==0) {
		if(tot1<=tot0) return 1;
		return 0;
	}
	if(lim==0 && zer==0 && f[ws][tot1][tot0]!=-1) return f[ws][tot1][tot0];
	int up=1,ans=0;
	if(lim) up=num[ws];
	for(int i=0;i<=up;i++){
		if(zer==1 && i==0) ans+=dfs(ws-1,0,0,lim && i==up,1);
		else ans+=dfs(ws-1,tot1+(i==1),tot0+(i==0),lim && i==up,0);
	}
	if(lim==0 && zer==0)f[ws][tot1][tot0]=ans;
	return ans;
}
int solve(int xx){
	memset(num,0,sizeof(num));
	cnt=0;
	while(xx){
		num[++cnt]=xx&1ll;
		xx>>=1ll;
	}
	return dfs(cnt,0,0,1,1);
}
signed main(){
	memset(f,-1,sizeof(f));
	int l,r;
	scanf("%lld%lld",&l,&r);
	printf("%lld\n",solve(r)-solve(l-1));
	return 0;
}
```

---

## 作者：ADay (赞：8)

[更好的阅读体验，CSP前发题解会RP++?](https://www.cnblogs.com/aday526/p/solution-p6218.html)

分段打表，但比另一个打表题解快了近20倍！

~~因为ta不知道你谷可以交50kb的代码~~

## Solution

如果暴力一一验证，复杂度是 $\mathcal O(n\log n)$ 的，但 $r\le2\times10^9$，几分钟还是可以跑完的。

因为是查询一个区间，我们可以想到打表前缀和，不过若全打出来空间不够且代码太长，于是想到分段打表。

分段，即每 $blo(块的长度)$ 个数变成一段记录前缀和，类似于分块的思想，就可以直接查询整块，边角暴力，复杂度 $\mathcal O(blo)$。

显然 $blo$ 越小越好，但代码长度限制我们只能打大约 $5000$ 个数，即 $blo=\dfrac{2\times10^9}{5000}=4\times10^5$，不吸氧**总时长**也只有100+ms。

### Code

打表代码：

```cpp
#include<bits/stdc++.h>
using namespace std;
const int n=2e9,blo=400000,tot=n/blo+(n%blo!=0);
int sum[tot+5];
int main(){
    freopen("P6218table.txt","w",stdout);
    for(register int i=1;i<=n;i++){
        int c[2]={},j=i;
        for(;j;j>>=1)c[j&1]++;
        sum[(i-1)/blo+1]+=(c[0]>=c[1]);
    }
    for(register int i=1;i<=tot;i++)
        printf("%d,",sum[i]+=sum[i-1]);
    return 0;
}
```

AC代码：

```cpp
#include<bits/stdc++.h>
using namespace std;
const int blo=4e5,sum[5005]={0,193089,395896,597220,773925,912008,1157070,1399860,1584651,1786716,1936710,2139581,2389622,2582137,2798866,2953836,3101012,3281245,3430004,3558911,3666046,3727488,4073045,4367750,4637470,4888435,5098407,5359879,5599489,5784841,5985204,6135499,6342130,6591835,6778503,6997710,7150060,7301173,7476620,7626492,7759888,7863932,7933069,8276772,8570899,8841202,9091048,9295711,9560929,9799167,9988999,10183117,10332725,10542928,10792963,10975302,11195805,11345708,11498962,11677401,11825190,11960070,12061347,12136954,12422337,12647109,12847270,13021938,13147691,13354661,13513784,13638078,13753008,13838605,13999872,14173972,14280973,14429050,14516891,14618715,14726176,14804289,14881917,14930897,14992366,15366960,15712894,16038247,16353263,16625115,16950748,17253027,17514784,17775583,17998696,18268984,18581272,18830773,19125386,19350893,19575038,19825556,20039049,20247235,20412596,20548986,20883830,21177881,21448036,21697973,21888932,22167168,22398109,22593551,22772734,22921271,23142848,23394145,23573126,23793516,23944182,24105991,24282794,24415314,24555406,24649517,24753466,25086967,25380430,25650375,25899457,26085565,26369206,26596092,26793047,26967731,27118870,27347989,27596842,27777047,27991458,28143089,28307608,28483298,28610955,28751667,28846232,28953950,29222925,29446521,29645428,29820747,29930041,30150088,30299376,30430558,30539230,30620542,30799998,30970150,31084403,31219320,31304953,31413007,31518310,31584664,31667252,31710777,31814402,32181769,32527953,32854088,33167294,33418917,33760410,34055961,34326731,34577871,34794957,35084383,35395499,35650524,35930512,36153842,36384854,36635786,36830436,37047039,37202519,37368535,37692107,37984324,38251930,38499465,38677198,38971194,39196933,39398039,39573456,39710853,39958625,40199951,40385330,40585113,40736367,40907482,41083298,41198876,41344966,41432979,41573188,41892002,42183400,42451791,42702594,42882438,43173463,43398235,43599020,43775676,43906876,44160530,44398222,44587157,44784315,44934441,45107146,45281022,45394333,45541625,45627800,45766154,46014697,46240338,46443306,46616525,46732786,46946636,47097659,47228023,47334412,47401068,47601056,47762713,47885075,48002942,48088092,48203079,48308614,48363358,48448125,48488761,48628665,48943727,49235880,49508491,49753191,49940124,50223598,50447803,50647285,50821778,50946740,51213234,51447873,51639722,51826299,51975858,52151721,52326241,52431729,52582071,52669622,52820528,53071797,53287273,53494317,53661982,53786646,53990643,54139486,54271505,54378112,54439359,54649601,54804200,54931498,55041310,55126405,55242648,55348037,55405732,55488162,55529764,55672423,55922617,56134466,56342666,56507355,56636150,56836115,56986942,57117284,57223338,57281767,57496304,57649461,57777333,57883974,57968801,58089661,58195105,58254186,58331732,58372625,58498196,58674313,58804546,58944775,59038794,59121009,59242335,59328137,59400927,59454657,59477906,59624440,59710599,59783077,59838502,59878002,59949943,60000381,60027745,60060711,60076643,60259504,60643583,61015544,61384956,61739336,62061321,62430520,62775321,63102208,63415911,63670504,64040214,64385220,64712722,65027775,65319293,65625939,65937282,66191985,66473788,66698497,66957412,67316089,67649417,67984879,68288036,68556571,68881770,69174862,69442860,69691123,69865255,70211512,70506740,70777285,71028168,71242172,71500093,71743044,71927618,72130110,72279782,72514357,72873602,73203960,73540776,73841081,74113401,74433974,74726814,74993797,75243073,75422375,75767950,76062801,76332676,76583375,76793753,77054868,77294730,77480193,77680480,77830866,78060056,78374089,78636769,78924323,79152330,79365952,79616994,79839891,80042327,80216876,80332947,80621812,80846697,81047747,81223038,81352675,81554249,81716473,81838842,81958693,82044088,82276494,82635306,82958307,83298939,83593908,83872636,84187511,84481307,84753126,85000355,85185284,85527185,85821279,86090867,86340306,86540180,86811000,87046983,87238531,87427305,87576880,87818990,88131937,88385668,88675526,88900647,89123322,89374314,89592928,89798109,89967525,90094434,90375641,90599524,90797774,90975179,91097101,91307573,91464160,91588917,91701463,91786620,92021539,92334149,92583169,92877836,93103714,93327544,93578090,93791835,93999860,94165312,94298565,94574304,94799020,94999986,95175515,95292685,95505844,95660996,95788119,95896432,95981371,96189939,96441247,96620172,96840765,96991627,97153009,97330085,97462900,97602872,97697091,97787988,97987128,98136940,98267639,98373054,98430817,98577081,98663526,98735891,98789229,98830728,99093802,99452764,99768256,100111289,100405921,100692484,101006822,101285026,101562657,101801714,102005944,102336625,102630018,102898017,103147925,103329339,103616490,103840435,104039580,104217610,104364096,104632412,104944805,105198292,105483137,105707251,105936318,106185295,106385365,106599986,106758842,106910321,107173793,107398235,107597220,107771551,107877826,108098898,108252091,108384485,108491946,108569162,108836782,109148004,109403058,109683298,109906642,110137304,110388236,110583251,110799860,110955508,111113470,111373372,111596092,111794524,111967859,112076812,112301173,112452427,112583988,112690189,112764583,113005748,113247235,113432558,113632180,113783833,113954857,114130477,114246470,114392411,114480424,114595580,114774132,114922504,115053406,115160187,115221186,115365046,115450908,115525006,115579430,115609494,115893789,116199820,116458302,116731220,116955369,117190780,117439435,117625403,117845107,117996402,118166701,118415016,118640976,118843888,119017093,119133298,119347218,119498192,119628927,119735316,119802016,120056939,120294996,120484758,120677217,120826306,121001028,121176200,121284738,121432641,121517801,121643494,121821271,121966713,122102203,122201831,122272449,122406112,122491809,122564764,122618251,122646452,122908349,123143079,123334928,123521596,123671169,123847200,124021657,124127253,124277277,124364989,124493965,124671532,124811203,124948766,125047131,125120763,125249570,125334728,125409109,125463267,125488847,125698196,125852959,125980128,126090180,126175283,126291474,126396436,126454397,126536995,126578569,126667802,126774331,126847495,126927153,126973480,127014845,127081122,127122282,127156896,127179226,127187141,127546368,127926910,128289498,128651662,128995718,129340645,129699930,130015175,130359704,130653468,130947517,131306786,131645623,131977434,132282495,132546847,132879102,133173000,133441887,133690676,133875298,134235375,134583849,134907729,135221376,135515945,135819962,136133536,136386413,136672688,136898020,137142925,137457063,137732340,138013541,138250631,138451459,138718342,138940902,139141272,139315877,139423816,139791437,140136340,140463888,140778914,141070572,141377218,141688413,141943116,142225466,142449993,142698779,143012434,143286000,143568204,143802527,144007088,144269096,144492783,144691263,144865146,144970369,145316040,145611225,145881813,146132745,146346819,146604705,146847908,147032272,147235170,147384415,147587117,147837509,148030451,148247033,148401989,148548773,148729485,148878501,149007461,149114003,149174785,149552298,149899137,150226118,150540602,150825115,151138242,151446088,151702758,151977243,152202071,152459152,152773290,153035865,153323685,153551930,153765139,154016601,154239015,154441534,154616399,154732440,155076471,155370360,155640768,155890809,156096194,156361090,156598901,156788572,156983222,157133090,157343110,157592676,157775793,157996022,158146240,158299290,158476995,158625477,158760175,158861774,158937680,159279740,159573995,159843317,160093022,160292826,160563505,160799825,160991142,161180218,161329757,161544644,161793103,161971486,162192688,162343846,162502692,162679608,162822781,162958628,163058561,163141501,163422834,163646773,163845352,164022372,164144651,164354857,164511654,164635984,164749056,164834215,164997694,165171416,165277405,165428094,165515183,165618715,165725315,165800144,165879693,165926286,165997318,166370077,166715675,167042857,167357047,167624737,167953647,168253959,168518294,168773811,168996405,169269285,169583701,169835658,170127711,170353050,170577198,170828503,171037747,171247200,171410019,171552827,171886400,172180591,172450214,172699296,172885964,173169045,173395994,173593390,173768359,173918835,174147457,174396387,174576661,174791969,174943215,175107573,175283193,175411530,175551719,175646659,175758351,176089271,176382643,176650460,176900711,177082329,177369206,177593417,177792022,177970032,178117085,178351728,178598165,178779664,178991373,179140876,179307447,179482052,179607630,179751401,179842738,179957450,180221343,180445519,180644644,180818940,180925419,181146373,181299270,181431769,181539391,181616712,181800146,181969393,182085383,182215560,182300807,182410438,182517689,182580079,182663520,182705910,182815881,183139868,183431847,183700279,183947814,184124481,184418885,184644428,184845625,185021721,185159181,185406246,185647873,185833035,186032890,186184576,186355530,186531185,186647402,186793049,186881380,187011772,187266365,187488532,187687340,187864034,187976381,188196309,188346709,188477940,188585100,188654952,188849867,189011782,189132388,189255746,189341400,189454431,189559741,189617444,189701888,189742991,189861802,190110157,190336182,190538933,190712334,190828287,191042298,191193552,191324350,191430683,191497541,191696473,191858662,191981010,192099361,192184556,192299224,192404913,192459821,192544571,192585245,192691760,192869705,193015364,193150658,193250701,193321009,193454833,193540635,193613626,193666748,193695331,193834879,193925803,193995475,194053386,194094169,194160113,194213428,194235561,194276770,194293234,194439572,194798911,195142672,195471713,195782691,196039862,196377762,196670532,196939986,197190798,197385077,197704418,198005212,198268868,198527516,198750502,198991453,199238196,199417121,199640535,199791810,199990285,200304486,200590088,200866199,201107273,201299680,201573948,201799399,201999273,202175250,202290307,202567856,202797347,202992894,203170702,203319057,203500529,203676563,203787322,203929829,204015466,204194864,204509505,204790620,205068251,205305033,205503398,205775376,205999525,206199063,206373464,206485727,206768780,206995043,207192285,207367749,207518108,207703379,207876437,207988904,208126539,208212787,208381790,208631922,208832718,209046151,209207290,209344894,209535951,209684773,209815455,209920842,209975420,210195818,210344609,210478291,210586340,210666237,210793447,210893114,210955738,211026453,211067401,211251020,211564540,211838311,212120521,212355104,212559343,212821547,213045304,213243714,213417773,213523105,213816638,214043091,214244345,214421225,214559851,214754642,214921684,215038542,215166326,215251573,215433940,215684437,215877540,216094199,216249064,216395519,216576779,216725794,216854711,216960987,217021060,217242803,217394582,217525464,217632511,217704750,217838098,217933344,217998091,218064424,218105428,218284559,218534341,218721488,218940937,219093729,219244001,219420341,219568942,219702541,219807481,219873296,220090536,220240823,220372349,220478683,220547442,220682924,220777322,220845308,220907152,220948110,221097112,221272227,221383334,221530871,221616581,221713368,221821770,221905574,221982471,222032507,222072557,222209933,222295844,222369165,222422665,222451176,222531972,222576019,222608984,222633367,222649265,222865780,223179258,223433438,223723135,223947534,224170069,224421009,224640677,224845592,225014686,225141273,225422802,225646748,225845635,226022305,226144886,226354895,226511853,226636093,226749396,226834562,227039502,227287569,227461892,227687695,227839376,227999679,228176188,228314131,228452568,228549355,228634324,228835968,228986257,229117727,229223598,229284084,229427721,229516441,229588095,229642847,229683456,229885751,230136064,230314897,230536044,230686997,230847916,231025329,231158691,231298361,231392946,231482656,231682421,231832667,231963310,232068768,232126636,232272724,232359279,232431710,232485113,232526463,232693044,232866865,232979157,233118688,233205288,233312188,233418290,233486140,233566615,233612582,233674225,233793775,233879142,233951712,234005743,234028614,234113240,234153992,234189026,234212784,234226705,234445789,234692541,234873669,235085679,235235491,235401753,235576519,235702174,235845763,235937170,236040585,236228638,236378507,236508352,236613482,236667361,236815352,236903540,236978323,237033349,237067996,237247497,237417214,237533148,237663409,237748769,237857993,237965342,238028057,238111446,238153880,238224378,238336179,238421163,238493944,238546995,238571998,238656740,238698173,238733338,238755723,238767287,238953692,239118983,239236507,239362246,239449160,239561030,239667293,239726664,239810206,239852430,239927023,240034841,240119779,240193267,240247537,240276778,240356430,240397404,240432562,240455165,240465463,240597479,240691477,240758279,240822587,240863453,240928229,240981555,241005494,241045988,241061934,241106964,241160169,241201777,241238442,241258923,241273827,241307042,241323155,241336697,241344048,241346568,241674549,242069093,242453834,242843634,243221094,243591406,243975484,244339749,244713961,245060202,245394240,245778409,246155922,246521846,246880036,247196512,247572157,247918179,248244736,248558130,248832650,249189932,249571816,249933346,250300397,250646732,250987805,251346239,251662554,252005324,252300718,252591079,252950418,253294222,253623220,253934290,254191422,254529543,254822418,255091577,255342453,255536893,255891646,256272761,256634798,257000606,257345573,257687849,258045387,258360122,258706478,259001333,259292758,259651802,259993761,260324257,260633004,260892697,261226371,261521069,261790887,262041062,262229941,262581296,262932191,263254475,263573198,263864491,264165269,264480037,264732033,265022640,265247356,265489161,265803914,266085156,266362731,266599821,266797703,267069982,267294292,267493669,267667909,267780652,268150628,268530042,268893453,269251902,269598566,269945052,270303949,270619461,270961742,271256411,271551528,271910781,272246108,272579664,272885574,273150870,273480274,273773058,274042310,274291553,274471163,274838304,275183389,275510591,275825660,276117593,276423973,276735160,276989958,277272949,277497420,277745856,278059135,278333035,278615497,278850066,279054088,279316453,279540301,279738550,279912952,280018330,280393741,280740690,281067919,281382760,281670595,281980630,282291148,282546403,282824726,283047286,283301547,283616180,283885491,284169683,284400211,284609456,284867019,285090040,285287876,285462300,285573532,285919466,286214420,286484414,286734762,286946247,287206263,287447021,287632687,287832652,287983409,288188864,288438597,288626292,288845592,288998384,289148495,289325137,289473289,289607000,289712192,289779241,290171770,290549386,290914945,291274171,291612705,291966593,292320707,292640213,292971979,293265912,293571983,293930594,294254433,294594400,294890300,295168727,295482745,295777027,296048495,296296138,296481025,296857023,297203488,297530202,297844340,298118355,298440930,298746197,299006611,299272787,299495773,299761131,300074764,300329105,300618781,300842746,301065273,301316451,301536253,301741098,301910353,302038720,302413425,302759724,303085712,303399727,303672772,303997360,304300201,304561785,304823737,305047032,305316018,305628894,305877116,306172272,306398459,306621658,306872590,307086545,307294325,307460758,307595494,307931508,308224480,308494860,308744866,308937346,309215147,309445857,309641068,309821210,309969940,310191006,310440892,310619774,310841047,310992056,311153227,311330332,311464051,311603616,311698321,311801629,312173250,312519686,312846289,313160398,313422973,313756294,314054282,314320137,314570604,314794104,315073263,315387266,315639968,315928531,316153542,316380620,316630466,316835010,317045423,317208074,317357466,317688544,317982112,318250215,318500285,318682568,318968941,319193572,319391104,319569479,319717233,319950889,320197970,320378789,320590968,320741151,320907308,321081913,321207729,321351262,321442627,321562653,321890091,322183135,322452218,322700586,322878133,323167359,323393082,323595169,323772176,323914515,324153893,324399063,324582565,324789035,324938461,325105215,325282536,325404094,325548958,325638313,325759641,326020412,326243434,326442201,326615635,326722902,326947996,327098914,327231308,327337845,327412295,327601841,327767237,327884684,328010748,328097505,328209354,328315582,328375157,328458610,328500932,328624825,329011779,329388576,329752034,330111415,330426668,330804102,331150722,331477344,331792187,332074699,332410977,332766234,333084242,333417714,333711206,334004438,334318141,334580093,334867913,335094764,335324893,335684384,336030106,336357656,336671468,336924821,337267436,337562348,337832349,338082349,338285352,338591095,338897532,339157416,339426426,339649952,339886512,340136266,340317196,340538254,340687542,340881510,341240914,341586499,341914921,342227118,342482205,342823484,343117116,343386269,343635351,343835512,344148256,344452328,344713478,344976292,345200972,345440102,345688722,345864943,346086839,346239640,346432858,346747763,347037126,347310533,347555173,347743575,348023493,348246823,348446753,348623472,348743645,349014950,349246536,349440507,349623813,349772673,349949794,350123074,350232448,350380986,350467906,350644781,351003886,351345919,351676359,351985204,352244771,352578402,352873317,353143157,353393276,353582527,353907328,354207137,354471633,354725603,354947706,355191516,355442291,355621162,355840548,355990787,356194546,356509342,356790794,357068208,357305788,357503123,357775571,357999986,358199524,358373337,358486655,358769241,358995532,359192928,359367467,359518401,359703679,359876828,359989169,360127126,360213479,360399106,360713536,360989800,361269677,361507447,361707447,361975354,362198502,362398235,362573211,362681581,362968744,363191713,363393683,363571278,363716496,363905731,364074587,364190458,364323638,364409292,364584064,364832689,365032124,365247109,365405447,365546671,365733283,365882786,366012032,366117326,366170691,366394656,366547016,366678731,366786318,366862082,366992689,367090648,367154378,367222123,367262750,367465231,367824494,368155450,368492259,368792193,369064417,369386640,369678948,369946463,370194093,370373174,370719267,371014165,371284201,371534451,371746279,372006126,372247144,372432649,372632649,372783476,373010991,373325375,373589373,373876079,374105073,374317358,374569905,374791594,374993753,375169206,375283823,375573834,375797837,375999489,376175641,376305839,376506915,376668551,376790360,376911560,376997369,377214803,377528357,377788742,378076303,378302503,378518905,378768780,378993516,379196387,379368793,379488624,379774927,379999951,380199881,380375214,380500726,380706985,380867627,380990920,381107200,381192385,381391753,381640765,381819583,382040701,382190598,382349248,382526688,382670758,382806409,382906272,382984166,383191686,383341981,383471601,383578419,383642622,383784076,383874218,383943978,384001681,384042364,384268817,384581784,384830323,385125050,385351314,385574513,385825340,386039400,386247446,386413963,386545605,386822849,387046326,387247460,387423311,387541754,387754480,387909506,388036629,388145412,388230506,388438856,388688167,388867092,389088561,389239577,389400937,389577811,389711832,389851361,389946171,390035064,390235386,390385737,390516233,390621929,390679889,390825711,390912586,390984956,391038430,391079575,391289693,391539220,391719257,391935629,392086308,392250610,392425922,392555439,392695732,392790284,392886907,393081256,393230759,393360379,393466687,393522404,393669733,393755266,393827699,393884419,393922688,394095892,394267325,394380052,394516671,394602518,394710645,394816103,394882309,394964861,395008581,395074881,395190036,395275618,395348581,395401808,395424172,395508954,395551287,395587049,395609939,395622350,395912142,396295778,396655638,397030278,397376240,397712174,398071467,398404088,398740084,399042490,399314603,399681163,400026585,400352286,400664826,400913946,401260608,401555607,401826216,402076818,402290507,402604798,402961475,403278857,403613960,403907724,404199368,404513594,404780800,405065328,405296269,405515161,405835235,406127151,406393342,406644769,406824253,407116038,407341363,407541294,407718272,407851066,408162108,408517590,408835362,409168909,409462708,409755640,410069420,410331694,410619192,410846204,411071397,411385829,411679347,411950614,412199516,412381362,412668879,412894604,413095122,413270882,413398785,413695569,414002165,414262049,414531059,414754907,414991089,415240906,415422292,415643265,415792610,415967408,416219043,416441025,416645660,416816008,416935509,417146791,417296581,417426945,417532212,417598566,417924081,418277738,418597984,418924334,419218127,419514265,419827506,420079430,420369220,420596279,420831946,421146807,421436488,421709629,421954269,422142776,422422960,422646248,422845933,423022729,423143099,423457020,423758424,424021148,424280994,424503714,424744518,424992004,425169253,425393551,425544770,425728315,425978503,426191730,426399951,426565060,426692896,426892574,427044115,427174962,427281190,427340225,427659770,427959615,428224349,428478585,428700583,428943923,429194790,429373658,429593390,429743720,429931436,430182312,430389622,430599538,430761333,430894569,431092147,431242098,431372244,431477216,431534910,431816525,432043054,432240268,432414441,432565902,432750872,432924112,433036453,433174501,433260868,433401945,433577831,433704531,433846592,433940239,434024527,434142850,434228009,434301222,434354758,434377342,434742639,435088467,435414718,435729824,436022006,436328153,436639660,436894147,437177866,437402176,437650185,437963255,438237742,438520127,438754857,438958599,439221118,439445057,439643671,439818156,439923724,440266915,440562301,440832689,441084087,441299892,441555781,441799986,441983636,442187843,442336904,442538425,442789069,442983096,443199489,443354223,443500641,443682721,443831617,443960727,444065759,444125581,444471717,444766615,445036847,445286886,445498960,445758912,445999916,446185365,446385365,446536283,446741003,446991373,447179545,447398165,447551637,447701012,447878242,448026606,448159517,448265059,448330797,448621013,448845050,449046773,449222925,449353348,449554304,449715709,449837707,449959138,450044919,450201357,450375989,450487993,450635197,450721347,450817999,450925182,451010113,451086380,451137099,451184599,451526696,451821329,452090651,452340384,452540949,452810769,453047747,453238476,453429106,453577707,453792356,454041473,454220418,454441605,454590970,454749794,454927256,455071578,455207222,455306980,455388273,455670525,455895031,456094107,456269762,456393498,456602401,456760284,456884698,456998093,457083340,457246169,457420052,457525211,457676604,457763763,457866637,457973797,458048654,458128372,458175475,458240565,458518181,458741294,458942582,459118678,459237226,459449826,459604817,459731870,459840873,459926030,460090778,460266190,460376353,460522383,460609045,460713075,460820430,460892269,460972317,461018138,461083785,461284037,461434402,461564975,461670699,461728666,461874537,461961464,462033677,462087310,462128373,462243674,462348474,462408213,462484704,462526050,462586979,462640643,462670306,462709080,462727031,462806670,463177006,463523277,463849195,464163079,464422350,464758802,465053946,465320508,465571627,465795406,466077919,466390956,466643701,466929820,467154557,467382742,467632384,467832223,468046347,468206366,468362078,468689986,468982848,469252022,469500369,469678752,469967730,470192591,470394826,470571742,470714796,470953788,471198902,471382299,471589196,471738860,471905334,472082410,472204633,472349259,472438896,472566394,472891310,473184150,473452183,473700180,473874992,474169669,474395792,474597347,474773499,474911547,475157310,475399126,475584603,475785855,475936410,476107273,476282711,476400198,476545532,476634316,476763088,477018640,477241164,477438514,477615602,477727284,477948157,478098970,478229340,478337088,478407904,478601841,478764562,478883571,479008238,479093938,479207211,479312577,479370425,479454869,479495972,479623652,479938483,480231517,480502757,480751694,480933551,481221456,481446859,481647573,481823228,481951474,482208299,482447041,482636957,482830487,482979885,483153157,483328882,483438565,483586489,483671804,483814081,484065718,484288170,484492588,484663097,484782248,484993866,485143460,485274195,485379505,485445711,485649798,485808724,485932550,486047167,486132950,486248285,486353499,486407241,486492025,486534849,486666998,486918074,487135791,487340840,487509996,487633511,487839484,487988721,488119036,488226287,488288613,488497650,488653445,488779281,488890718,488975741,489091892,489196499,489252899,489337361,489378815,489496019,489672171,489809596,489948187,490044466,490120870,490246190,490333243,490406729,490460602,490485117,490628893,490717161,490788907,490843357,490883954,490951660,491005832,491031607,491067568,491083500,491241284,491556117,491837794,492115537,492353558,492549826,492822998,493047147,493246741,493421234,493534552,493816402,494043253,494240411,494414287,494566066,494750805,494924115,495036491,495174539,495261061,495429138,495679257,495881378,496093108,496255234,496391885,496584365,496733538,496863721,496969389,497024290,497244148,497393243,497525465,497633962,497714826,497841195,497941139,498003948,498075307,498116226,498279147,498527305,498727767,498942514,499100880,499241950,499428653,499578283,499707895,499813117,499866574,500089557,500242078,500373884,500481793,500557954,500687933,500786319,500849727,500917960,500958633,501097183,501273748,501393417,501538454,501627104,501719281,501829480,501914591,501987154,502040258,502068454,502216334,502302988,502376909,502431040,502463190,502540491,502586826,502616879,502645442,502661429,502835308,503085609,503274124,503492541,503646160,503795157,503972866,504121222,504253662,504359603,504423757,504642266,504792225,504924289,505030931,505100123,505235369,505328926,505397017,505459897,505500820,505649178,505823649,505935814,506083166,506169326,506265848,506372660,506457990,506534041,506585068,506624413,506762048,506848296,506921518,506975190,507003774,507084304,507128709,507161380,507186123,507201956,507351871,507526581,507634648,507782663,507867959,507969734,508077818,508157680,508235319,508284144,508329460,508462100,508547909,508620692,508675073,508702378,508784001,508827326,508860434,508884365,508900221,509006749,509111685,509165021,509251768,509293550,509351827,509406391,509439708,509478132,509496588,509525805,509593083,509633947,509669175,509691561,509699864,509739874,509756239,509769583,509777004,509781887,510039529,510434348,510818518,511211150,511589106,511957181,512341273,512716980,513083935,513440058,513759548,514149825,514527695,514892945,515251994,515578028,515943958,516294181,516617129,516933802,517224783,517555200,517939339,518298772,518675798,519021868,519356926,519716142,520054508,520386340,520691879,520958167,521328504,521674932,522001011,522314586,522574327,522910401,523205699,523472450,523723142,523947187,524257025,524641011,525000552,525376522,525723007,526058355,526417361,526750999,527086384,527391364,527659902,528028806,528373875,528700404,529013861,529267950,529608274,529901577,530172660,530423601,530643170,530950014,531307710,531624266,531963500,532256963,532545576,532859838,533132405,533415400,533648736,533860843,534185916,534478756,534746824,534994891,535169278,535464211,535690293,535891792,536068266,536206153,536516519,536899945,537259998,537632879,537978358,538316436,538675479,539005400,539342524,539642675,539918952,540282910,540627673,540952239,541266298,541518375,541863895,542158585,542427850,542679165,542888696,543208838,543564590,543882045,544215845,544509995,544802528,545116441,545378911,545666353,545893674,546118292,546433550,546726206,546997382,547246327,547428219,547716418,547941604,548142479,548318078,548446618,548765633,549120133,549439648,549770697,550064160,550357155,550671788,550929848,551218648,551443139,551673124,551988287,552281597,552553746,552800463,552984713,553269995,553494179,553694466,553869162,553994817,554299580,554603751,554865040,555129136,555353179,555592253,555840747,556017872,556239035,556391665,556571198,556822323,557040376,557245033,557414651,557538005,557743978,557893481,558023460,558130718,558193426,558538921,558920337,559282052,559648330,559993366,560335663,560693622,561007366,561353963,561648705,561940058,562299276,562641408,562971805,563280889,563540061,563874419,564168967,564438961,564688996,564879430,565228552,565579956,565902409,566221776,566513601,566812516,567127356,567379497,567671036,567895899,568136480,568451322,568733244,569011043,569249225,569445057,569718434,569942527,570142401,570316957,570430324,570785808,571134668,571458387,571771985,572066539,572370118,572683913,572936642,573223339,573449301,573693480,574007714,574285133,574563742,574801954,575001873,575270582,575493807,575693176,575868404,575977215,576313206,576606586,576875404,577127011,577348508,577599973,577845766,578028134,578238582,578388533,578584080,578832665,579032861,579247608,579406212,579546953,579733712,579883671,580013263,580118477,580171988,580544852,580891802,581219223,581534136,581823029,582131805,582442868,582697578,582977405,583200630,583452743,583767556,584037673,584321599,584552975,584761036,585020034,585242950,585441129,585614141,585724642,586070990,586365845,586636120,586885983,587098835,587358486,587599651,587785100,587984974,588135983,588340702,588590947,588779756,588997970,589151764,589300313,589478570,589626934,589758790,589865158,589930234,590274917,590569102,590839312,591089956,591296853,591560503,591797537,591987137,592183945,592333889,592542810,592791277,592976635,593196423,593347598,593500089,593675146,593825730,593959588,594062637,594134887,594421449,594646844,594846466,595022429,595148658,595353570,595515038,595637743,595754913,595840071,596000160,596174828,596283134,596431141,596516095,596617918,596726002,596806089,596883741,596932510,596989638,597381578,597759247,598124416,598482880,598816443,599175778,599529193,599849560,600175018,600468425,600780141,601138852,601453487,601798267,602093644,602377480,602692322,602980058,603255084,603498497,603691266,604064906,604409753,604737071,605051711,605320924,605648686,605948704,606212919,606470412,606693433,606965416,607277730,607529662,607822532,608048397,608272654,608523002,608734396,608942701,609107019,609248840,609620286,609966906,610293508,610607654,610871252,611203928,611502560,611767771,612019821,612241324,612520272,612834774,613087008,613376753,613600994,613827966,614078393,614284114,614494282,614656226,614804433,615136100,615430124,615698759,615948010,616131708,616416806,616642502,616839989,617016819,617166078,617398101,617645744,617826390,618039722,618190087,618355530,618530723,618656007,618799750,618892052,619011922,619380985,619725921,620052533,620366166,620620507,620960579,621253608,621524691,621775848,621995615,622282594,622593873,622848612,623130260,623354535,623583903,623834119,624031900,624247144,624404319,624566432,624891519,625184450,625452518,625700676,625874652,626169779,626395931,626597248,626773960,626912008,627157035,627399825,627584742,627786589,627936745,628107377,628282794,628401117,628546379,628635079,628771304,629091820,629384072,629651006,629900948,630080231,630372413,630597913,630797948,630975088,631108751,631359935,631599454,631784969,631985113,632135408,632307538,632482605,632596337,632743285,632830060,632965566,633215935,633439554,633642074,633815965,633931280,634147246,634298051,634429465,634535462,634603538,634800594,634963280,635085453,635205038,635290454,635403824,635510204,635565849,635650567,635691319,635832308,636191723,636537952,636865813,637178608,637433016,637774596,638068724,638338347,638587485,638787590,639099276,639403404,639664841,639929336,640153071,640392180,640640604,640818031,641039306,641191466,641383768,641698630,641988917,642261780,642507041,642694799,642975676,643199363,643397956,643575214,643696708,643966650,644199237,644391969,644576661,644725504,644902804,645076238,645183524,645333652,645420040,645588955,645903588,646189835,646465715,646707412,646898726,647174003,647399293,647599916,647775641,647892349,648167077,648398144,648593551,648772615,648921173,649099216,649276401,649386865,649531348,649617379,649777928,650028875,650237201,650447200,650609430,650741096,650939809,651089438,651220082,651325385,651383116,651599802,651751307,651879717,651985039,652071887,652194300,652297972,652357915,652432899,652474553,652646230,652960533,653238254,653516456,653755033,653954651,654223598,654447089,654646031,654821420,654930551,655217058,655440757,655640610,655818584,655964614,656153317,656323413,656437876,656572562,656658216,656831426,657080410,657280606,657495031,657653957,657794467,657981233,658131500,658261141,658366258,658419892,658641780,658794546,658926849,659034597,659111216,659240506,659339424,659402553,659471267,659511950,659680817,659931700,660126315,660342827,660498244,660643391,660826578,660975466,661104647,661209160,661267652,661491480,661642965,661774435,661880180,661954602,662087287,662183187,662247862,662314047,662355271,662498532,662674313,662789799,662936051,663023917,663117823,663225440,663310315,663385075,663438624,663471240,663614525,663700351,663774667,663828930,663858893,663937271,663982476,664014634,664041175,664057086,664279059,664662853,665029665,665402506,665751036,666080151,666438554,666785282,667112942,667426581,667680387,668056449,668403114,668729853,669044304,669320477,669640392,669946309,670206182,670473991,670697111,670974878,671333866,671654095,671995742,672288331,672571282,672886345,673178405,673451072,673695808,673884236,674224745,674518440,674787530,675036218,675235527,675508475,675743114,675934858,676121470,676271008,676531424,676890131,677205088,677549432,677844790,678128602,678443572,678731568,679006258,679250098,679441556,679778805,680071218,680341526,680592072,680785763,681062605,681293028,681488260,681669976,681818920,682070245,682382214,682634136,682927326,683153191,683377182,683627530,683839295,684047348,684212058,684348259,684622548,684847873,685047621,685223150,685337782,685553814,685706852,685834822,685941365,686026183,686291256,686650504,686965786,687310204,687603761,687890398,688205003,688485453,688763245,689000559,689203475,689535497,689829430,690098016,690347211,690531336,690815902,691042130,691239589,691415935,691565566,691829997,692143285,692396302,692682549,692907573,693135352,693385113,693585032,693799419,693959970,694108716,694375053,694597913,694797948,694972476,695080287,695301004,695450971,695584037,695691820,695771367,696035016,696346344,696601054,696882738,697107412,697336780,697586526,697784777,697999790,698157098,698311973,698573960,698797304,698995966,699169779,699274715,699500641,699652553,699784450,699891519,699966467,700204319,700447109,700631865,700834175,700983938,701154479,701330295,701448675,701593929,701682629,701795615,701975848,702124754,702253671,702360544,702420472,702566201,702652498,702725984,702781020,702811985,703112983,703468898,703786324,704120279,704414534,704706793,705020854,705283485,705570934,705798913,706022621,706338572,706630387,706901535,707150998,707332421,707621209,707846115,708047144,708222512,708351910,708647618,708953277,709213125,709483137,709707041,709943019,710192928,710375372,710595931,710745883,710918345,711170074,711393551,711597220,711768653,711886465,712099009,712249255,712379898,712485328,712551597,712851683,713156281,713417291,713682213,713905892,714144805,714393138,714571065,714792296,714944021,715123413,715374433,715593019,715798039,715967490,716090284,716297083,716446586,716575711,716683795,716746732,717013759,717246647,717439015,717624037,717773097,717950249,718123747,718230514,718380971,718467514,718599893,718776150,718913841,719052404,719148872,719224828,719350956,719437593,719511304,719565141,719589892,719907071,720207509,720471767,720727095,720949507,721190578,721441976,721620922,721841312,721992230,722178272,722429302,722638084,722847908,723010265,723141468,723340447,723490175,723620958,723726296,723784044,724064342,724291298,724488400,724663120,724814111,724998262,725171943,725283997,725422742,725509666,725650063,725825753,725953635,726094010,726188876,726273037,726391830,726477134,726550139,726603682,726626532,726912369,727136152,727335543,727513552,727659821,727848523,728018780,728132998,728268006,728353604,728497607,728672163,728797944,728941617,729032814,729120532,729234668,729320476,729393295,729446582,729468773,729690074,729843106,729975500,730083087,730160085,730289010,730388054,730451379,730520145,730560820,730660400,730767560,730829467,730912956,730955300,731006353,731062556,731103210,731137639,731159671,731171926,731549783,731896468,732223694,732538141,732824227,733136187,733445172,733701373,733975473,734201414,734457033,734771295,735037155,735322230,735552344,735763711,736017891,736239945,736439518,736616064,736729594,737074686,737368941,737638793,737889669,738096979,738360258,738598069,738786682,738984190,739134176,739342628,739591122,739777118,739996850,740148068,740300250,740474543,740625905,740759770,740862980,740935175,741277464,741572169,741841889,742092134,742293813,742561545,742799525,742989260,743181620,743330688,743543546,743793251,743973162,744193978,744343058,744500802,744678516,744823923,744959378,745058914,745139004,745422660,745646935,745846382,746020686,746145984,746354431,746512895,746637120,746750796,746836240,746998242,747172706,747278266,747428382,747516094,747617911,747725806,747801699,747880808,747928456,747993663,748330955,748623795,748893725,749144313,749338305,749614916,749845396,750040676,750222658,750371561,750591965,750839279,751018116,751241047,751392553,751553514,751729373,751865375,752004107,752099943,752195061,752469427,752694766,752894444,753070295,753185076,753400728,753554109,753681897,753788643,753873487,754043404,754218892,754330113,754472123,754557518,754664460,754771032,754840011,754920496,754965933,755046883,755318378,755542814,755741939,755916683,756028575,756246690,756397717,756526562,756633815,756718655,756893911,757066688,757179246,757316776,757402863,757510330,757616145,757682408,757764925,757809194,757888961,758079521,758228094,758358941,758464251,758518738,758666654,758752504,758828029,758883266,758919308,759043031,759142824,759205735,759275842,759316799,759378721,759433235,759460354,759500301,759516882,759613362,759938554,760231807,760499749,760747998,760922357,761216695,761442910,761644381,761821121,761959225,762204196,762447308,762631637,762834479,762983906,763154363,763330459,763449007,763594164,763682933,763809912,764066417,764289578,764487294,764662762,764773869,764995457,765146802,765277544,765384997,765456738,765649372,765812982,765930892,766056736,766142675,766255421,766361166,766419133,766503538,766544872,766660411,766911754,767134371,767336743,767511608,767626097,767842679,767993330,768124835,768230707,768299420,768496209,768658489,768780662,768900674,768986170,769099672,769205875,769261722,769346386,769387202,769489649,769667515,769815892,769950625,770052133,770118883,770255943,770341805,770415167,770468618,770497137,770634923,770726958,770796465,770855157,770896038,770961911,771015033,771037520,771078103,771094727,771217453,771468430,771687409,771892450,772061831,772184527,772391459,772541053,772670335,772778101,772841347,773049198,773205848,773330381,773443243,773528393,773644485,773749180,773803782,773889553,773931053,774047497,774223705,774361662,774500225,774596532,774672649,774798935,774885316,774959209,775013018,775037862,775181020,775269797,775341402,775396102,775436710,775502931,775558102,775583939,775620258,775636236,775751662,775928920,776061854,776201742,776296081,776375084,776499716,776585353,776658794,776712157,776736114,776882098,776968522,777040944,777094291,777135668,777206532,777258002,777284923,777318590,777334784,777424121,777530405,777597925,777678374,777724388,777770851,777831894,777872631,777907209,777929437,777936896,778021563,778062260,778097672,778121310,778134973,778171016,778190473,778201480,778212307,778217201,778403673,778787679,779159116,779529063,779882735,780205427,780573340,780919153,781245323,781558578,781810789,782182593,782529391,782856828,783171724,783461546,783769341,784080719,784335661,784616048,784839539,785100870,785460197,785792027,786128619,786430198,786700191,787024093,787316149,787584378,787831913,788008811,788355382,788650132,788920520,789170953,789384285,789643117,789884814,790070032,790269668,790421447,790658463,791017551,791346248,791683376,791983530,792257070,792576297,792867800,793135480,793386392,793566534,793911626,794205986,794475782,794726665,794934150,795197534,795435464,795623622,795821557,795971473,796203298,796516874,796778791,797066380,797293140,797508366,797756524,797982711,798185518,798358758,798476789,798763478,798989076,799189482,799365263,799492189,799695802,799857872,799980129,800098473,800183647,800420149,800779147,801099720,801441549,801734621,802016501,802331617,802623890,802896396,803141873,803329465,803670258,803964107,804233225,804481447,804681810,804954170,805188809,805380819,805567487,805717053,805961810,806275156,806525722,806817371,807043993,807266738,807517983,807734096,807940601,808108637,808237770,808517019,808740139,808940867,809117376,809236989,809448811,809603799,809730834,809841012,809926116,810163897,810475354,810727338,811020943,811246570,811470799,811720733,811932912,812141525,812306263,812441680,812716039,812941455,813141182,813317250,813432180,813647557,813801141,813928726,814035727,814120601,814333927,814584453,814763564,814982073,815131941,815296004,815472247,815602901,815743045,815836693,815931544,816127918,816277904,816407812,816513292,816570131,816716805,816802964,816875397,816930401,816970322,817237937,817596806,817912362,818254542,818549176,818835875,819150238,819425606,819706527,819943841,820149841,820479053,820771396,821040914,821290157,821469340,821757658,821980451,822183129,822360640,822505123,822776253,823087476,823342135,823624767,823849273,824078375,824327799,824526638,824741063,824899366,825053512,825315555,825539347,825737792,825911732,826017055,826242124,826394218,826526115,826633345,826708457,826980833,827291224,827546598,827824375,828047278,828280825,828531231,828724299,828940937,829095823,829256740,829513777,829736882,829934626,830109730,830220689,830442313,830594057,830724904,830831930,830904141,831148310,831388410,831574223,831774384,831924798,832096557,832271785,832385764,832532991,832619982,832737406,832913683,833062473,833195981,833300802,833364315,833505135,833591251,833665277,833719069,833748733,834036918,834342436,834602179,834872416,835096999,835332802,835582151,835765569,835985714,836135932,836308366,836559121,836783068,836986555,837158401,837275677,837488953,837639248,837769765,837875461,837941611,838200376,838436766,838627957,838817306,838966628,839142336,839316514,839424131,839572191,839659229,839786784,839963623,840107118,840242993,840342786,840414772,840545972,840631395,840704113,840759167,840785736,841051072,841284352,841476103,841662120,841811209,841988038,842161823,842267475,842418529,842505569,842637255,842813659,842951616,843090109,843186734,843262533,843389128,843475438,843549282,843603028,843628066,843838930,843993977,844121205,844229638,844314605,844430822,844538458,844596454,844676996,844718163,844807912,844915996,844986941,845067161,845112774,845155223,845220681,845261639,845296391,845318510,845326358,845678443,846027780,846351457,846666617,846959364,847262684,847576534,847829337,848117445,848342701,848586263,848900482,849179107,849457109,849695704,849894685,850164360,850388173,850586394,850762448,850872260,851206396,851500952,851767943,852019642,852242412,852492981,852739600,852920889,853132738,853282466,853477648,853726800,853926765,854141281,854300312,854440395,854628321,854778282,854908071,855013180,855067044,855407194,855702071,855972961,856224058,856442076,856695560,856940924,857124461,857330469,857479881,857678248,857929180,858125092,858341386,858497244,858641236,858825522,858974152,859103764,859208371,859265061,859559500,859785036,859986457,860162518,860300034,860496292,860661492,860779142,860904718,860991648,861143541,861319266,861435610,861581060,861669609,861763462,861871280,861956181,862029832,862084039,862118641,862463881,862758136,863027932,863278864,863486503,863749915,863988097,864175813,864374134,864523889,864732040,864981031,865167132,865386717,865538173,865690033,865864165,866015688,866149497,866252903,866323492,866610189,866836130,867036522,867212247,867339483,867542597,867704786,867827295,867945738,868030925,868189782,868365010,868473758,868621825,868706996,868806987,868915624,868996649,869073987,869123031,869175965,869460169,869684444,869884052,870058111,870184011,870392136,870550705,870674825,870788739,870874292,871036220,871210593,871316440,871465835,871553638,871655672,871763546,871839854,871918709,871966575,872023197,872228427,872377495,872508623,872615783,872677361,872820144,872909021,872980462,873036208,873076880,873186684,873291115,873349081,873432205,873473695,873532762,873586732,873619138,873657617,873675732,873739610,874073277,874367982,874637681,874887891,875076665,875357052,875586795,875782069,875960206,876108571,876333647,876584330,876763336,876981950,877132245,877295972,877472215,877603184,877743300,877836732,877939829,878211947,878436257,878635704,878809979,878922525,879140651,879291770,879420510,879526866,879612532,879787304,879960348,880072759,880210555,880296796,880403808,880510044,880576525,880658690,880703271,880792103,881059337,881282450,881482498,881657103,881765416,881985904,882134505,882268216,882376335,882456324,882637369,882806372,882921935,883054750,883140531,883248880,883355025,883420013,883502638,883545954,883631607,883817953,883967379,884096707,884201771,884255109,884405926,884493386,884567720,884622263,884655766,884783590,884881219,884945223,885012630,885053239,885117396,885171434,885196801,885236941,885253305,885350891,885608349,885831349,886029157,886203819,886314693,886536766,886688433,886819371,886926397,886998713,887190541,887354747,887472726,887598479,887684566,887797038,887902888,887961079,888045521,888086910,888185101,888361624,888509895,888643641,888748728,888811709,888953061,889039016,889113000,889167031,889196713,889330221,889424562,889492443,889554513,889595471,889660395,889714161,889737319,889777867,889793746,889887410,890064366,890213527,890347833,890449810,890516363,890653732,890739671,890812992,890866535,890894982,891032593,891124867,891194030,891253129,891293947,891359672,891413006,891435494,891476076,891492600,891568272,891675621,891755048,891832736,891881604,891919553,891989258,892030042,892064528,892087508,892096293,892178258,892221076,892254142,892278071,892293916,892325918,892347961,892355544,892371433,892376406,892525401,892884725,893227015,893557255,893867176,894125666,894461463,894754645,895025025,895274842,895467301,895789337,896089509,896353823,896609753,896832411,897073733,897323766,897502627,897723830,897874853,898075485,898390237,898674020,898950692,899190141,899383763,899658314,899883016,900083051,900258027,900371780,900651837,900879550,901076616,901251936,901402005,901585568,901759340,901871842,902011513,902097966,902280406,902594597,902873516,903151686,903389959,903588904,903858706,904082624,904280993,904456934,904566986,904852341,905076853,905274631,905452970,905600521,905788117,905959214,906072438,906208510,906294147,906466576,906715714,906915784,907130209,907289191,907429379,907617614,907767266,907897321,908002402,908056337,908277249,908429528,908562083,908669740,908747552,908875356,908975394,909038606,909107657,909148394,909335231,909650230,909921781,910205350,910437846,910643791,910904485,911127374,911326148,911499603,911607080,911901649,912127080,912328830,912504947,912642442,912838630,913003991,913121319,913247375,913334224,913518755,913768804,913959525,914176080,914331344,914479444,914658487,914807045,914936563,915043974,915106436,915326763,915477324,915608198,915715519,915785754,915920511,916014594,916081248,916145683,916186534,916368946,916618028,916804143,917023805,917175289,917326834,917501390,917652755,917786242,917889970,917958335,918172409,918324188,918455070,918561221,918628435,918764911,918859231,918927588,918988410,919029094,919179937,919355270,919464337,919612351,919697575,919797177,919905793,919987035,920064541,920113601,920157176,920291743,920377425,920450472,920503713,920532286,920613753,920657223,920690278,920714273,920730194,920950671,921263821,921515283,921805811,922032594,922255438,922506550,922723363,922929280,923097785,923226410,923506272,923729588,923929623,924106237,924226410,924438008,924593396,924719891,924830626,924915721,925122440,925369674,925547687,925771487,925922937,926083737,926259029,926396334,926535184,926631056,926718312,926918116,927069132,927199951,927306319,927365068,927509953,927597756,927669362,927723777,927764373,927970279,928220998,928399933,928619122,928769312,928932717,929109226,929240279,929380332,929473958,929568117,929765184,929915149,930045204,930150201,930207684,930354324,930440512,930512969,930567184,930607693,930777564,930950713,931062949,931200941,931287273,931394069,931500570,931567105,931649090,931693833,931757499,931875050,931960207,932033578,932086965,932109531,932194278,932234897,932271439,932294614,932307688,932530779,932775543,932958925,933168169,933318155,933484621,933659331,933784054,933927966,934018833,934124286,934310954,934460457,934589610,934694913,934748269,934898731,934986387,935060560,935115258,935148926,935332487,935499900,935616443,935744780,935829772,935941463,936048161,936109261,936192704,936234928,936307561,936417273,936502412,936574930,936628860,936655979,936738163,936779773,936814572,936837369,936848205,937036469,937201207,937319158,937444736,937531005,937643302,937749174,937807593,937891981};
int l,r,lb,rb,ans,c[2];
int main(){
	scanf("%d%d",&l,&r);
	lb=(l-1)/blo+1;rb=(r-1)/blo+1;
	ans=sum[rb]-sum[lb-1];
	for(register int i=(lb-1)*blo+1;i<l;i++){
		int j=i;c[0]=c[1]=0;
		for(;j;j>>=1)c[j&1]++;
		ans-=(c[0]>=c[1]);
	}
	for(register int i=r+1;i<=rb*blo;i++){
		int j=i;c[0]=c[1]=0;
		for(;j;j>>=1)c[j&1]++;
		ans-=(c[0]>=c[1]);
	}
	printf("%d\n",ans);
	return 0;
}
```



---

## 作者：EternalHeart1314 (赞：7)

[题目传送门](https://www.luogu.com.cn/problem/P6218)

$\text{Upd on 2024.9.28}$：改了一些笔误（原已过审）。

# Problem

是人都懂 ~~（懒得写）~~。

# Solution

非数位 DP 做法。

首先设 $qwq(n)$ 为 $[1,n]$ 中圆数的个数，答案显然为 $qwq(r)-qwq(l-1)$。

找规律，先设 $n=(10011000)_2$。

以下的 01 串都是二进制表示。

那么 $[1,10011000]$ 可以分为以下区间的并：

$[00000001,10000000]$，

$[10000001,10010000]$，

$[10010001,10011000]$。

设 $lowbit(x)$ 为 $x$ 最低位的 $1$ 的值。

上面的区间的 $r$ 都可以由若干次 $l\leftarrow l+lowbit(l)$ 得到。

怎么计算这种区间呢？

就拿 $[10010001,10011000]$ 来说，它又可以拆成：

$[1001\ 0001,1001\ 0001]=1$，

$[1001\ 0010,1001\ 0011]=2$，

$[1001\ 0100,1001\ 0111]=3$，

$[1001\ 1000,1001\ 1000]=1$。

分隔开了不变的高位和变的低位，还写了值。

最后一点特殊的 $[r,r]$ 可以直接暴力判断。

那么（除了最后一段特殊的）每段区间 $[l,r]$ 怎么求呢？稍微推一下就知道：

设 $qaq(l,r)$ 为这种区间（$r$ 可以由若干次 $l\leftarrow l+lowbit(l)$ 得到的区间）内的圆数个数，$x$ 为 $l$ 中 $1$ 的个数（二进制下），$y$ 为 $l$ 中 $0$ 的个数。

若 $x\le y$，则 $l$ 是圆数，设它最后一段连续的 $0$ 的长度是 $k=\log_2(lowbit(l))$，比如若 $l=10010100$，则 $k=2$，因为最后有连续的 $2$ 个 $0$。

设 $z=\lfloor\frac{y-x}{2}\rfloor$，则后面这 $k$ 个 $0$ 里**最多** $z$ 个变成 $1$，它仍是圆数，超过 $z$ 个就有 $x>y$，不是圆数了，则 $qaq(l,r)=\sum\limits_{i=0}^zC_k^i$，$C$ 是组合数。

这个 $\sum$ 可以用前缀和优化掉。

若 $x>y$，显然 $qaq(l,r)=0$，因为把后面的 $0$ 变成 $1$，$x$ 会越来越大，$y$ 会越来越小，始终不是圆数。

时间复杂度 $O(\log^2n)$，就是 $O((\log n)^2)$。

# Code

```cpp
#include<bits/stdc++.h>
#define int long long
using namespace std;

int l, r, c[33][33];

inline int awa(int x) {
	int sum = 0;
	while (x) x ^= x & -x, ++sum;
	return sum;
}

inline int qaq(int l, int r) {
	int x, y, sum = 0;
	while (l < r) {
		x = awa(l), y = (int)log2(l) + 1 - x;
		if (y >= x) sum += c[(int)log2(l & -l)][y - x >> 1];
		l += l & -l;
	}
	return sum + (awa(l) <= (int)log2(l) + 1 >> 1);
}

inline int qwq(int n) {
	int sum = 0;
	while (n) sum += qaq(n ^ n & -n | 1, n), n ^= n & -n;
	return sum;
}
main() {
	for (int i = 0; i < 30; ++i) c[i][0] = 1;
	for (int i = 1; i < 30; ++i) for (int j = 1; j <= i; ++j)
		c[i][j] = c[i - 1][j] + c[i - 1][j - 1];
	for (int i = 0; i < 30; ++i) for (int j = 1; j < 30; ++j)
		c[i][j] += c[i][j - 1];
	return cin >> l >> r, cout << qwq(r) - qwq(l - 1), 0;
}
```

---

## 作者：KEBrantily (赞：6)

感觉此题是[P4317 花神的数论题](https://www.luogu.com.cn/problem/P4317)的变形板

------------
## Description
求一段区间内二进制中 $0$ 的个数不小于 $1$ 的个数的数的个数

------------
## Solution

数位 DP

先考虑状态转移方程式，如何处理处所有数

设 $f[i][j][k]$ 表示枚举到第 $i$ 位，数字为 $j$，此时二进制中 $1$ 的个数为 $k$

显然有

$$f[i][0][j]=\sum_{k=0}^if[i-1][1][k]+f[i-1][0][k]$$

$$f[i][1][j]=\sum_{k=1}^if[i-1][0][k-1]+f[i-1][1][k-1]$$

与花神的数论题是一样的

另一部分，考虑答案的统计

显然，对于 $ans_{l,r}$，可以转化为 $ans_{1,r}-ans_{1,l-1}$

把最高位上的数与最高位以下的分开统计

由于存在原数定义的限制，我们对于 $ans_{1,V}$ 可用如下方法处理

设 $len$ 为 $V$ 的位数, $a_i$ 为 $V$ 的第 $i$ 位

对于首位为 $1$ 且前面有 $cnt1$ 个 $1$ 的 $f$，

$res+=f[i][0][j],i\in[1,len),j\in[0,len/2-cnt1]$

对于首位为 0 的 f，

$res+=f[i][1][j],i\in[1,len),j\in[0,i/2]$

------------
## Code
```cpp
#include<cstdio>
#include<iostream>
#include<cstring> 
#include<cmath>
#include<algorithm>
#define maxn 10000100	
//#define int long long

using namespace std;

int f[50][2][50],a[50];
int l,r;

int read(){
	int s=0,w=1;char ch=getchar();
	while(ch<'0'||ch>'9'){if(ch=='-') w=-1;ch=getchar();}
	while(ch>='0'&&ch<='9') s=(s<<1)+(s<<3)+ch-'0',ch=getchar();
	return s*w;
}

void init(){
	f[1][1][1]=1;f[1][0][0]=1;
	for(int i=2;i<35;i++)
		for(int j=0;j<=1;j++)
			for(int k=0;k<=i;k++)
				for(int s=0;s<=1;s++){
					if(!j)f[i][j][k]+=f[i-1][s][k];
					if(j&&k) f[i][j][k]+=f[i-1][s][k-1];
				}
}

int solve(int x){
	memset(a,0,sizeof a);
	int len=0,ans=0,cnt1=1,cnt0=0;
	while(x){a[++len]=x%2;x/=2;}
	for(int i=len-1;i>=1;i--){
		if(a[i]) for(int j=0;j<=len/2-cnt1;j++) ans+=f[i][0][j];
		cnt1+=a[i];cnt0+=(a[i]==0);
		if(cnt0>=cnt1&&i==1) ans++;
	}
	for(int i=1;i<len;i++)
		for(int j=0;j<=i/2;j++)
		    ans+=f[i][1][j];
	return ans;
}

int main(){
	init();
	l=read();r=read();
	printf("%d",solve(r)-solve(l-1));
	return 0;
}
```

------------


---

## 作者：zjrdmd (赞：3)

### 数位dp简介：


何为数位$dp$，数位$dp$是有套路可循的dp中的一种。
- 题目特征：让你求出区间$[l,r]$中满足条件$A$的数有多少个，$l,r$的值很大，朴素的暴力无法解决。
- 大致思路：从高位向低位填，第$i$位由第$i+1$位转移过来，所以肯定有一个维度记录填到第$i$位，其他维度根据题目要求而定。当然，有时普通的循环转移无法很好的解决问题，这是需要使用记忆化搜索的形式来呈现。

### 此题解决方法：

设$dp[now][c]$为填到第$i$位，$0$与$1$的差值为$c$搜索过的答案。（由于差值可能为负数，所以我们把$c$加上$30$以避免$RE$）

我们会发现，朴素的数位$dp$无法很好的解决此题，状态设计也无法很好的表示一种情况，那么我们可以考虑使用记忆化搜索的形式。
那么如何记忆化呢？我们需要维护的比较复杂的莫非就是这么几个东西。
   1. 当前位如果是$0$，那么是否是前导$0$，因为前导$0$如果算入总数，那么会影响结果。
   2. 当前为的最高位限制。
 
那么我们就可以写记忆化了（变量的详细解释加注释里了$qwq$）


```cpp
#include<bits/stdc++.h>
#define ri register int
#define N 1000
 
inline int read()
{
    int x=0,f=1; char ch=getchar();
    while(ch<'0'||ch>'9'){if(ch=='-')f=-1;ch=getchar();}
    while(ch>='0'&&ch<='9'){x=(x<<1)+(x<<3)+(ch^48);ch=getchar();}
    return x*f;
}

int dp[N][N];//记忆化数组，记录搜索结果。 
int w[N];
int len=0;

void clear(){
	memset(dp,-1,sizeof(dp));
	memset(w,0,sizeof(w));
	len=0; 
}

int solve(int now,int zero,int vis,int c){//now->当前位置   zero->当前为是否是前导0（1是0不是）  
                          //vis-> 当前为是否可取到最大值（1不能 0能）  c-> 0-a; 
	if(now==0)return c>=30;
	if(!zero&&!vis&&dp[now][c]!=-1)return dp[now][c];
	int maxn=vis?w[now]:1;
	int sum=0;
	for(ri i=0;i<=maxn;i++){
		sum+=solve(now-1,zero&&(!i),vis&&(i==maxn),c+(i==0?(zero?0:1):-1));
	}
	if(!zero&&!vis){
		dp[now][c]=sum;
	}
	return sum;
} 

int work(int x){
	clear();
	while(x)w[++len]=x%2,x/=2;
	return solve(len,1,1,30); 
}
int main(){
	int l=read() ,r=read();
	printf("%d",work(r)-work(l-1)); 
	return 0;
}

```


---

## 作者：Missa (赞：2)

先解释一下为什么已有 13 篇题解还要交：仔细翻过了一遍题解区，发现没有一篇与自己的相同，使用组合数优化枚举的，所以打算来交一篇。

题意：给定 $l$，$r$，求所有 $l$ 与 $r$ 间的数，满足写成二进制后 $0$ 的个数不小于 $1$ 的个数。

首先这种统计数位信息的一定是数位 dp 或推式子题。但是你会发现，如果想要推式子，限制非常多，所以可以使用数位 dp 自动分讨。

首先，我们需要把二进制提取出来。


```cpp
int solve(int n){
    cnt = 0; memset(f, 0, sizeof(f)); // 不清空记搜数组，由于用的是之前的限制，会出大问题，然而不清有 50 分……
    for(; n; n >>= 1) a[++cnt] = n & 1;
    reverse(a+1, a+cnt+1);
    int ans = 0;
    // do something
    return ans;
}
```

首先设计状态。由于“小于等于”比较难控制，我选择了“恰好”。

```cpp
int f[M][M][2];
int dp(int n, int m, bool l){ //填到 n 位，后恰好 m 个 0，l 为 1 表示前面都是顶着限制填的
    if(f[n][m][l]) return f[n][m][l]; // 如果搜过了就不用搜了
    if(m < 0) return 0; // 如果 m 都已经小于 0 了，就不用往后走了
    if(cnt - n + 1 < m) return 0; // 我用 cnt 表示当前在搜的数，如果后面的全填上 0 都不够，就应该立刻返回
    if(n == cnt + 1) return m == 0; // 这里是搜索的终点
    // do something
    return f[n][m][l] = ans; 
}
```

这里 $n$ 的范围极小，不会超过 $\log_2 r < 32$，于是可以放心把 $l$ 也放入记搜数组。

接着考虑如何计算答案。

```cpp
int ans = 0;
if(l) {
    if(a[n] == 0) ans += dp(n+1, m-1, 1); // 限制是 0 的情况，只能填 0，同时这仍是顶着限制的
    else ans += dp(n+1, m-1, 0) + dp(n+1, m, 1); // 限制是 1，可以选择 0 或 1，如果选了 0，就不会再顶着限制了
} else {
    ans += dp(n+1, m-1, 0) + dp(n+1, m, 0); // 前者填 0，后者填 1
}
```

当你运行代码时，你会发现它的输出大大多于了标准输出。

观察样例解释，原来是忽略了前导 0。

你可能会想修改状态解决问题。但是转而想，如果第一位就是 0，也就不用考虑限制了。于是就只用挑一些数位放上 0 了。这是一个组合数问题。

组合数预处理：

```cpp
int c[M][M];
void pre(int n = 200){
    c[1][0] = c[1][1] = 1;
    for(int i = 2; i <= n; i++){
        c[i][0] = 1;
        for(int j = 1; j <= i; j++) c[i][j] = c[i-1][j] + c[i-1][j-1];
    }
}
```

计算此部分的答案：

```cpp
// 下面一句处理第一位是 0 的情况，i 表示共填几位，j 表示其中几个 0，第一位一定是 1
for(int i = 2; i < cnt; i++) for(int j = (i+1)/2; j < i; ++) ans += c[i-1][j]; // i 减 1 是因为最高位不能填 0
```

最后加上前面第一位是 1 时的答案

```cpp
// 从 2 开始是因为第一位是 1
for(int i = (cnt+1)/2; i <= cnt-1; i++) ans += dp(2, i, 1);
```

分析复杂度。每个 $f_{i,j,k}$  最多只被搜索一次，这仅有 $32 \cdot 32 \cdot 2$ 不到的计算量。看似我们对每个 $j$ 都搜了一次，但是，这并不会让复杂度更劣，反之，这让代码更易理解。

upd：后来自己意识到在 dp 时，如果 l 是 0，可以直接返回组合数。但亲测不会优化时间（30ms -> 39ms），不过这在数字够大时会有明显优化。

完整代码：

```cpp
//time : 22-7-26 21:28
//problem url : https://www.luogu.com.cn/problem/P6218
//status : not submitted
#include <cstdio>
#include <algorithm>
#include <cstring>
using namespace std;
const int M = 205;
int f[M][M][2], n, l, r, a[M], cnt;
int c[M][M];
int dp(int n, int m, bool l){ //填到 n 位，后恰好 m 个 0，l 为 1 表示前面都是顶着限制填的
    if(f[n][m][l]) return f[n][m][l];
    if(m < 0) return 0;
    if(cnt - n + 1 < m) return 0; 
    if(n == cnt + 1) return m == 0;
    if(!l) return c[cnt-n+1][m];
    int ans = 0;
    if(l) {
        if(a[n] == 0) ans += dp(n+1, m-1, 1); // 限制是 0 的情况，只能填 0
        else ans += dp(n+1, m-1, 0) + dp(n+1, m, 1); // 限制是 1，可以选择 0 或 1
    } else {
        ans += dp(n+1, m-1, 0) + dp(n+1, m, 0); // 前者填 0，后者填 1
    }
    return f[n][m][l] = ans; 
}
void pre(int n = 200){
    c[0][0] = c[1][0] = c[1][1] = 1;
    for(int i = 2; i <= n; i++){
        c[i][0] = 1;
        for(int j = 1; j <= i; j++) c[i][j] = c[i-1][j] + c[i-1][j-1];
    }
}
int solve(int n){
    cnt = 0; memset(f, 0, sizeof(f));
    for(; n; n >>= 1) a[++cnt] = n & 1;
    reverse(a+1, a+cnt+1);
    int ans = 0;
    // 下面一句处理第一位是 0 的情况，i 表示共填几位，j 表示其中几个 0，第一位一定是 1
    for(int i = 2; i < cnt; i++) for(int j = (i+1)/2; j < i; j++) ans += c[i-1][j];
    // 从第二位填起，第一位一定是 1
    for(int i = (cnt+1)/2; i <= cnt-1; i++) ans += dp(2, i, 1);
    return ans;
}
int main(){
    int n; pre();
    scanf("%d %d", &l, &r);
    printf("%d\n", solve(r) - solve(l-1));
}
```

---

## 作者：Yaha (赞：2)

## 数位DP

这题考察数位DP。没有学数位DP的还是绕道吧。

- 状态表示：

$f[i][j][k]$：表示 共i个二进制位，其中首位为j，共有k个1，的二进制数的个数。

注意：f数组表示的是满足这些条件的二进制数的数量，先不管合不合法。

比如：$f[3][1][2]=2$，分别是$(110)_2 $ 和$(101)_2$。

- 状态转移：

设p为j的下一位，即第i-1位，则：

如果j为1，$f[i][j][k]=f[i-1][p][k-1]$。

如果j为0，$f[i][j][k]=f[i-1][p][k]$。

详见代码：

```c
#include<bits/stdc++.h>
using namespace std;
int f[35][3][35];
void init(){
	f[1][1][1]=1,f[1][0][0]=1;//将一位的情况初始化
	for(int i=2;i<35;i++)//位数
		for(int j=0;j<=1;j++)//首位
			for(int k=0;k<=i;k++)//1的个数
				for(int p=0;p<=1;p++)//次高位
				{
					if(j&&k) f[i][j][k]+=f[i-1][p][k-1];
					else if(j==0) f[i][j][k]+=f[i-1][p][k];
				}
}
int dp(int n){
	if(!n) return 0;
	vector<int> V;
	while(n)//把n每一位转化为二进制位，抠出来
	{
		V.push_back(n%2);
		n/=2;
	}
	int ans=0,cnt1=1,cnt0=0;
	for(int i=V.size()-2;i>=0;i--)
  	//减2是因为，这个for循环在考虑第一位必须为1的情况，这样可以避免前导0造成的错误。
  	//这也是为什么cnt1要初始化成1。
	{
		int x=V[i];
		if(x)
		{
			for(int j=0;j<=(int)(V.size()/2-cnt1);j++)//cnt1+j<=V.size()/2，最多能出现V.size()/2个1。
				ans+=f[i+1][0][j];
		}
		cnt1+=x;
		cnt0+=(x==0);
		if(!i&&cnt1<=cnt0) ans++;
	}
	for(int i=1;i<=V.size()-1;i++)//特判第一位为0的情况，枚举有多少位
		for(int j=0;j<=i/2;j++)//最多能有i/2个1。
			ans+=f[i][1][j];
	return ans;
}
int main(){
	init();
	int l,r;
	scanf("%d%d",&l,&r);
	printf("%d",dp(r)-dp(l-1));
	return 0;
}
```

祝各位CSP NOIP rp++！！

---

## 作者：pomelo_nene (赞：1)

数据范围很大，在 $2 \times 10^9$ 数量级，暴力显然会超时。

考虑到数位 dp。定义 $dp_{i,j,k}$ 为**在二进制下**，当前填了 $i$ 位，有 $j$ 个 $1$，$k$ 个 $0$。可以直接套用模板，是一道很好的练手题。

有一些小技巧：

- 令 $\operatorname{round}(x)$ 为 $\sum_{i=1}^x [x \ \texttt{为圆数}]$，那么可以得到答案为 $\operatorname{round}(r)-\operatorname{round}(r-1)$（当然这个方法不一定都适用，比如 SGU390）；   
- 转化为二进制就是把数位拆分的 $10$ 改为 $2$ 而已。$B$ 进制同理；   
- 不需要开始就预处理，可以直接写记忆化，简单方便。

```cpp
#include<bits/stdc++.h>
using namespace std;
int a[34],n,dp[34][34][34];
int DP(int pos,int limit,int lead,int c1,int c2)
{
	if(pos>n)	return c1>=c2;
	if(!limit && !lead && ~dp[pos][c1][c2])	return dp[pos][c1][c2];
	int up=limit?a[n-pos+1]:1,ans=0;
	for(int i=0;i<=up;++i)	ans+=DP(pos+1,limit && i==up,lead && i==0,c1+(!lead && i==0),c2+(i==1));
	if(!limit && !lead)	dp[pos][c1][c2]=ans;
	return ans;
}
int calc(int up)
{
	if(up==0)	return 1;
	memset(dp,-1,sizeof dp);
	n=0;
	int tmp=up;
	while(tmp)	a[++n]=tmp&1,tmp>>=1;
	return DP(1,1,1,0,0);
}
int main(){
	int l,r;
	scanf("%d %d",&l,&r);
	printf("%d",calc(r)-calc(l-1));
	return 0;
}
```

---

## 作者：chihik (赞：1)


首先有个想法，如果该位为 $0$ 且不是前导 $0$，则将 $0$ 的数量加一，最后看 $0$ 是否出现了至少 $\lceil \frac{\text{len}}{2} \rceil$ 次。

但这样有个问题，比如在 $n=8(1000)_2$ 时， $2(0010)$ 就不会被计入答案 ，原因是 $2$ 的前导 $0$ 也算在了它二进制的位数中。

所以还要记录前导零的数量 $\text{leadnum}$，最后判断是否出现至少 $\lceil \frac{\text{len}-\text{leadnum}}{2} \rceil$ 即可。

```cpp
#include <cstdio>
#include <cstring>
#include <iostream>
using namespace std;

const int MAXN = 35;
int a[ MAXN + 5 ] , len , dp[ MAXN + 5 ][ MAXN + 5 ][ MAXN + 5 ];

int dfs( int pos , int lead , int leadnum , int limit , int sum ) {
	if( pos == len + 1 ) return sum >= len - leadnum - sum;
	if( ~dp[ pos ][ sum ][ leadnum ] && !lead && !limit ) return dp[ pos ][ sum ][ leadnum ];
    
	int Ans = 0 , Mbit = limit ? a[ len - pos + 1 ] : 1;
	for( int i = 0 ; i <= Mbit ; i ++ ) {
              if( lead && i == 0 ) Ans += dfs( pos + 1 , 1 , leadnum + 1 , limit & ( i == Mbit ) , sum );
              else                 Ans += dfs( pos + 1 , 0 , leadnum , limit & ( i == Mbit ) , sum + ( i == 0 ) );
        }
	if( !lead && !limit ) dp[ pos ][ sum ][ leadnum ] = Ans;
	return Ans;
}
int Solve( int x ) {
	len = 0; for( ; x ; x /= 2 ) a[ ++ len ] = x % 2;
	memset( dp , -1 , sizeof( dp ) );
	return dfs( 1 , 1 , 0 , 1 , 0 );
}

int l , r;
int main( ) {
	scanf("%d %d",&l,&r);
	printf("%d\n", Solve( r ) - Solve( l - 1 ) );
	return 0;
}
```


---

## 作者：maruize (赞：0)

数位DP。

写了个递推的。

从高到低一位位填。

---

先说套路：

先将上界n写成一位一位的（记为num）

$f_{ab...}$

a表示填的位数;
b表示填好数的是否与上界相等，以便判断下一位范围是0~(n-1)$ \ \ $(n bit) 还是$0$~$num_i$。

代码：

//k为n的位数

$f_{k+1,1,...}=1$
```cpp
for (int  i=k+1;i>=2;i--)

    for (int j=0;j<=1;j++)
    
        for(int r=0;r<=bit;r++):
        
            if (j==1 && r>num[i-1])continue
            
            f[ i-1 ][j!=0 && (r==num[i-1])][...] += do f[i][j][...] something
```

---

此题：

注意前导0。

状态$f_{abcd}$:


$\ \ $c:填什么

$\ \ $d:how many 1

$\ \ $e:how many 0(不包括前导0) 
```cpp
#include<cstdio>
#include<iostream>
#include<cstring>
using namespace std;
bool num[39];
int f[39][2][39][39];
int work(int n){
	memset(f,0,sizeof(f));
	int h=0;
	while(n>0)num[++h]=n%2,n/=2;//分解数
	f[h+1][1][0][0]=1;
	for(int a=h+1;a>0;a--)
		for(int b=0;b<=1;b++)
			for(int c=0;c<=1;c++){
				if(b==1&&c>num[a-1])break;
				f[a-1][b&&c==num[a-1]][(c==1)][0]+=f[a][b][0][0];
				//^(0个1)即处理前导0
				for(int d=1;a+d<=h+1;d++)//注意要让f[h+1][1][0][0]转移出去所以枚举到h+1
					for(int e=0;a+d+e<=h+1;e++)
						f[a-1][b&&c==num[a-1]][d+(c==1)][e+(c==0)]+=f[a][b][d][e];
			}
	int cnt=0;
	for(int i=1;i<=h;i++){
		for(int j=1;j+i<=h;j++){
			if(j>=i)cnt+=f[1][0][i][j]+f[1][1][i][j];
		}
	}
	return cnt;
}
int main(){
	int l,r;
	scanf("%d%d",&l,&r);
	printf("%d",work(r)-work(l-1));//分段套路
	return 0;
}
```


---


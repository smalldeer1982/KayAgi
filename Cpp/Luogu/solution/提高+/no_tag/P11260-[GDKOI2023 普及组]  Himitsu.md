# [GDKOI2023 普及组]  Himitsu

## 题目背景

省略了一些不必要的图片。

## 题目描述

Lily 忘不掉小时候临别前与 Nana 一起出逃的夜晚，两人为了探索宇宙的真相而沿着铁路轨道前行，望见从天际线涌出的大鱼浮在夜空里。从那以后 Lily 便未曾停止过钻研宇宙的秘密。

秘密啊，总是会有那么一两个的。以浮起的大鱼为典型，Lily 所在的世界发生了 $n$ 件关于宇宙的重大事件。阴谋诡计，完全犯罪，宇宙的暗物质，事件与事件之间看似互不相干，但 Lily 每天阅读着关于宇宙的书籍，从书籍最后一页总结出 $m$ 段解读，每段解读都能将其中某两件事件联系起来。

大人们希望 Lily 揭露部分已经得到的解读，使所有发生的事件都能被串联起来。但是 Lily 清楚，如果这些解读暴露，班里大概有一半的同学会开始计划着出逃——秘密的揭露都是需要 Lily 付出代价的，假设每一段解读的揭露需要付出的代价可以被量化，第 $i$ 段解读的揭露需要付出的代价为整数值 $w_i$ 。Lily 需要付出的总代价为，在确保解读们能将所有事件联系起来的前提下，Lily 所揭露的所有解读的代价之和。

Lily 知道，其中有 $k$ 段解读是关于世界真理的关键解读，是承载着 $70$ 亿的秘密，这些解读被透露的数量将直接决定着人类延续的可能性。人们议论纷纷，说着或许只有这两个孩子才能拯救世界，$70$ 亿人所凝聚的正义将 $2$ 人的自由剥夺，迫切地想要知道 Lily 给出的答案。

你想要知道，对于 $0$ 到 $k$ 中所有整数 $i$ ，Lily 透露了一部分解读，能将所有事件联系起来，且其中正好
有 $i$ 个关键解读的前提下，Lily 需要付出的最小总代价。

“我不明白啊”，Lily 这样的哭了。她会坚守着秘密，按照约定等待着与 Nana 再会的那一刻。

## 说明/提示

### 数据范围

$1 \le u, v \le n, 1 \le w \le 10^9$；

对于 $30\%$ 的数据满足 $1 \le n \le 100, 1 \le m \le 400, 1 \le k \le 5$；

对于另外 $30\%$ 的数据满足 $1 \le n \le 10000, 1 \le m \le 1000000, 1 \le k \le 20$；

对于剩下 $40\%$ 的数据满足 $1 \le n \le 10000, 1 \le m \le 1000000, 1 \le k \le 50$。

赛题被启用的时候，小小的行星上已经有 $80$ 亿人了。

## 样例 #1

### 输入

```
5 8 2
3 4 6
2 1 6
1 4 8
1 2 10
2 3 4
3 4 5
4 5 4
2 4 6```

### 输出

```
21
19
20```

# 题解

## 作者：ty_mxzhn (赞：1)

# 题意

你有一个图，你要求它在选出 $i(0\le i\le k)$ 条关键边时的最小生成树。保证非关键边能连通这个图。

# 题解

## 算法 $1$


答案显然是凸的，考虑 wqs 二分直接跑最小生成树。时间复杂度 $O(mk\log V)$。无法通过。

## 算法 $2$

怎么求 $i=0$ 时的答案？考虑将其他非关键边缩成一棵最小生成树。**此时不在最小生成树上的边没有用**。缩成 $n+k$ 条边了。

结合算法 $1$ 则时间复杂度 $O(nk\log V)$。可以通过。

## 算法 $3$

整体二分（或分治，怎么叫都行），对于 $i\in[L,R]$ 的区间对切的斜率二分到 $[l,r]$ 这个区间。

设 $m=\lfloor \dfrac{l+r}{2} \rfloor$。判定到 $m$ 时我们的二分加了 $M$ 条关键边。则每次被二分扔到 $[l,m]$ 这个区间的数是 $i\in [L,M]$，被二分扔到 $[m+1,r]$ 这个区间的数是 $i\in [M+1,R]$。

这个算法的时间复杂度是什么？好像有点难分析吧。

考虑画出二分的递归树，发现时间复杂度为 $O(nk)$。

我们发现时间复杂度相对于原来没有太大变化。正常整体二分的时间复杂度进行较大改变是因为**值域较小且每一段的二分时间复杂度只和这一段的长度有关**。

# 后记

秘密啊 总是会有那么一个两个的

因为人类啊 其实也没有多坚强

---


# ã€ŒCMOI R1ã€å›¾ä¸Šäº¤äº’é¢˜ / Constructive Minimum Xor Path

## é¢˜ç›®èƒŒæ™¯

2024 å¹´ 1 æœˆ 13 æ—¥ 15:59:31ï¼Œéšç€æœ€åä¸€å‘äº¤äº’ J é¢˜çš„æäº¤å‡ºç°äº† Wrong Answerï¼Œå° G çš„ EC-Final æ¯”èµ›ç»“æŸäº†ï¼Œä¹Ÿæ„å‘³ç€åœ¨ ICPC ç”Ÿæ¶¯ä¸­ç¬¬ä¸€æ¬¡æ‰“é“ã€‚

ç—›å®šæ€ç—›ï¼Œå° G å†³å®šæ‰¹é‡ç”Ÿäº§äº¤äº’é¢˜ç»™è‡ªå·±åšã€‚å¦‚ä½•æ‰¹é‡ç”Ÿäº§äº¤äº’é¢˜ï¼Ÿåªè¦åœ¨ä¸€ä¸ªæ•°æ®ç»“æ„ä¸­æœ‰è‹¥å¹²ä¸ªæœªçŸ¥é‡ $a_i$ï¼Œæ¯æ¬¡è¯¢é—®ç»™å®šå‘é‡ $x$ï¼Œäº¤äº’åº“ä¼šè¿”å›å…³äº $a_i$ çš„å‡½æ•° $f(x)$ï¼Œè¿™æ ·å°±èƒ½æ‰¹é‡ç”Ÿäº§äº¤äº’é¢˜äº†ï¼

~~é‚£ä¸ºä»€ä¹ˆè¿™é¢˜å¹¶ä¸æ˜¯äº¤äº’é¢˜å‘¢ã€‚~~

## é¢˜ç›®æè¿°

ç»™å®šä¸€ä¸ª $n$ ä¸ªç‚¹ï¼Œ$m$ æ¡è¾¹çš„**æ— å‘å›¾**ã€‚ç¬¬ $i$ æ¡è¾¹ $(u_i,v_i)$ æœ‰ä¸€ä¸ª**æœªçŸ¥è¾¹æƒ** $a_i$ã€‚

å¯¹äºä»»ä½•ä¸€æ¡**è·¯å¾„**ï¼Œå®šä¹‰å…¶**ä»£ä»·**å¦‚ä¸‹ï¼šè®¾è·¯å¾„ä¸º $(p_0,p_1,...,p_k)$ï¼Œå…¶ä¸­è¦æ±‚ $(p_{i-1},p_i)$ æ˜¯æ— å‘å›¾ä¸­çš„è¾¹ï¼Œè®¾å…¶ä¸ºç¬¬ $e_i$ æ¡è¾¹ã€‚é‚£ä¹ˆè·¯å¾„çš„ä»£ä»·å³ä¸º $\bigoplus\limits_{i=1}^{k} a_{e_i}$ã€‚å…¶ä¸­ $\bigoplus$ è¡¨ç¤ºå¼‚æˆ–ã€‚ï¼ˆè¯¥è·¯å¾„å¯ä»¥ç»è¿‡é‡å¤ç‚¹å’Œé‡å¤è¾¹ï¼Œå³ $p$ å’Œ $e$ å¯ä»¥åŒ…å«é‡å¤çš„æ•°ï¼‰



å®šä¹‰ $f(x,y)$ ä¸ºä» $x$ åˆ° $y$ çš„æ‰€æœ‰è·¯å¾„ä¸­ä»£ä»·çš„**æœ€å°å€¼**ã€‚ç‰¹åˆ«åœ°ï¼Œå½“ $x=y$ æ—¶ï¼Œ$f(x,y)=0$ã€‚

ç»™å®š $n,m$ï¼Œå†å¯¹äºæ¯æ¡è¾¹ $(u_i,v_i)$ ç»™å®š $f(u_i,v_i)$ï¼Œä½ éœ€è¦æ±‚å‡ºæ˜¯å¦å­˜åœ¨ä¸€ç»„åˆæ³•çš„ $a_i$ï¼Œå¦‚æœæœ‰è§£ï¼Œä½ è¿˜éœ€è¦æ„é€ ä¸€ç»„è§£ã€‚

## è¯´æ˜/æç¤º

### æ ·ä¾‹è§£é‡Š

ç­”æ¡ˆè¾“å‡ºçš„å›¾å¦‚ä¸‹ï¼š

![](https://cdn.luogu.com.cn/upload/image_hosting/06683y6o.png)

è€ƒè™‘ $f(1,2)$ï¼š

+ è€ƒè™‘è·¯å¾„ $1\rightarrow 2$ï¼Œè·¯å¾„çš„ä»£ä»·ä¸º $2$ã€‚

+ è€ƒè™‘è·¯å¾„ $1\rightarrow 2\rightarrow 3\rightarrow 1\rightarrow 2$ï¼Œè·¯å¾„çš„ä»£ä»·ä¸º $2\oplus3\oplus114514\oplus2=114513$ã€‚

æ­¤å¤–è¿˜å­˜åœ¨å…¶ä»–è·¯å¾„ï¼Œä½†å¯ä»¥è¯æ˜ä¸å­˜åœ¨ä»£ä»·æ¯” $2$ æ›´å°çš„è·¯å¾„ï¼Œæ•… $f(1,2)=2$ã€‚

### æ•°æ®èŒƒå›´

**æœ¬é¢˜é‡‡ç”¨æ†ç»‘æµ‹è¯•ã€‚**

|$\text{Subtask}$ |ç‰¹æ®Šæ€§è´¨|åˆ†æ•°|
|-:|-:|-:|
|$1$|ä¿è¯æœ‰è§£|$20$|
|$2$|$m\le n+10$|$30$|
|$3$||$50$|

å¯¹äº $100\%$ çš„æ•°æ®ï¼Œ$1\le n,m\le 5\times 10^5$ï¼Œ$1\le u_i,v_i\le n$ï¼Œ$0\le f(u_i,v_i)<2^{31}$ã€‚

## æ ·ä¾‹ #1

### è¾“å…¥

```
3 3
1 2 2
2 3 3
3 1 1```

### è¾“å‡º

```
Yes
2 3 114514```

## æ ·ä¾‹ #2

### è¾“å…¥

```
1 1
1 1 1```

### è¾“å‡º

```
No```

# é¢˜è§£

## ä½œè€…ï¼š__DIOsama__ (èµï¼š4)

~~è¿™é¢˜èµ›æ—¶ç«Ÿç„¶çµæ„Ÿçªå‘åšå‡ºæ¥äº†ï¼Œ æ‰€ä»¥æ¥æ°´ä¸€å‘é¢˜è§£ï¼ˆ~~

è¿™é“é¢˜å®é™…ä¸Šå°±æ˜¯è®©æˆ‘ä»¬é€šè¿‡è·¯å¾„æœ€å°å¼‚æˆ–ä»£ä»·æ¥æ„å»ºåˆæ³•çš„è¾¹æƒå€¼ã€‚æˆ‘ä»¬éœ€è¦åˆ†æç»™å®šçš„è¾¹åŠå…¶å¯¹åº”çš„ä»£ä»· $f(u_i, v_i)$ï¼Œå¹¶æ„å»ºä¸€ä¸ªåˆæ³•çš„è¾¹æƒå€¼ $a_i$ï¼Œä½¿å¾—æ‰€æœ‰è·¯å¾„çš„å¼‚æˆ–ä»£ä»·ç¬¦åˆè¿™äº›è¦æ±‚ã€‚æ¯æ¡è¾¹çš„ä»£ä»·æ˜¯æœªçŸ¥çš„ï¼Œæˆ‘ä»¬éœ€è¦æ ¹æ®è¾“å…¥çš„ä»£ä»· $f(u_i, v_i)$ æ¥æ¨å‡ºæ¯æ¡è¾¹çš„æƒå€¼ã€‚

å®šä¹‰è·¯å¾„ä»£ä»·ä¸ºæ‰€ç»è¿‡è¾¹æƒå€¼çš„å¼‚æˆ–ã€‚å¯¹äºä»»æ„ä¸¤ç‚¹ $x$ å’Œ $y$ï¼Œæˆ‘ä»¬éœ€è¦ç¡®ä¿ä» $x$ åˆ° $y$ çš„æ‰€æœ‰è·¯å¾„ä¸­ï¼Œæœ€å°çš„ä»£ä»·ä¸º $f(x, y)$ã€‚

è‹¥æœ‰ç¯ï¼Œå¹¶ä¸”åœ¨ç¯ä¸Šè¿›è¡Œå¼‚æˆ–è¿ç®—ï¼Œç¯çš„ä»£ä»·åº”å½“ä¸º $0$ã€‚å¦‚æœ $f(u_i, v_i) = f(u_i, u_i) \oplus a_i \oplus f(v_i, v_i)$ï¼Œåˆ™å¯ä»¥æ¨å¯¼å‡ºè¾¹çš„æƒå€¼ã€‚æˆ‘ä»¬å¯ä»¥åˆ©ç”¨å¹¶æŸ¥é›†æ¥ç»´æŠ¤ï¼Œå¹¶è¿›è¡Œè·¯å¾„å‹ç¼©å’Œåˆå¹¶ã€‚åœ¨æ¯æ¬¡åˆå¹¶ä¸¤ä¸ªç‚¹ $u$ å’Œ $v$ æ—¶ï¼Œè®°å½•è¾¹çš„æƒå€¼ã€‚

å¯¹äºæ¯æ¡è¾¹ï¼Œæˆ‘ä»¬å¯ä»¥æ„å»ºä¸€ä¸ªæ–¹ç¨‹ï¼š  

$$f(u_i, v_i) = f(u_i, u_i) \oplus a_i \oplus f(v_i, v_i) $$

ï¼ˆå…¶ä¸­ $f(u_i, u_i)$ å’Œ $f(v_i, v_i)$ ä¸ºå·²çŸ¥å€¼ï¼‰

å¯¹äºæ¯å¯¹èŠ‚ç‚¹ $u_i$ å’Œ $v_i$ï¼Œå¯ä»¥é€šè¿‡å¹¶æŸ¥é›†æŸ¥æ‰¾åˆ°å®ƒä»¬çš„æ ¹èŠ‚ç‚¹ï¼Œå¹¶ç¡®ä¿å®ƒä»¬åœ¨åŒä¸€ä¸ªè¿é€šåˆ†é‡ä¸­ï¼Œç„¶åå°±å¯ä»¥åˆ©ç”¨å¼‚æˆ–æ¥é€æ­¥æ„å»ºå‡ºåˆæ³•çš„è¾¹æƒå€¼ $a_i$ã€‚å¹¶ä¸”åœ¨åˆå¹¶çš„è¿‡ç¨‹ä¸­ï¼Œè¦æ£€æŸ¥æ˜¯å¦å­˜åœ¨çŸ›ç›¾ã€‚è‹¥æœ‰çŸ›ç›¾ï¼Œç›´æ¥è¾“å‡º`NO`å³å¯ã€‚

å®Œæ•´ä»£ç å¦‚ä¸‹

```cpp
#include <iostream>
#include <vector>
#include <unordered_map>
#include <tuple>
#include <cstdio>

#define int long long
#define function auto
#define rop(a, b, c) for(int a = b; a < c; ++ a)
#define por(a, b, c) for(int a = b; a > c; -- a)
#define rep(a, b, c) for(int a = b; a <= c; ++ a)
#define per(a, b, c) for(int a = b; a >= c; -- a)

namespace Space {

    template < typename _Tp > inline function
    read(_Tp& t) -> void {
        int f = 0, ch = getchar (); t = 0;
        while (!isdigit (ch)) f |= (ch == '-'), ch = getchar ();
        do {t = (t << 1) + (t << 3) + (ch & 15); ch = getchar ();}
        while (isdigit(ch)); t = f ? -t : t;
    }

    template < typename _Tp, typename... _Args > inline function
    read(_Tp& t, _Args&... args) -> void {
        read(t); read(args...);
    }
}

using namespace Space;

class Find {
public:
    std::vector<int> parent, rank, xorValue;
    
    Find(int n) : parent(n), rank(n, 0), xorValue(n, 0) {
        rop(i, 0, n) parent[i] = i;
    }
public:
    inline function
    find(int x) -> int {
        if (parent[x] != x) {
            int root = this -> find(parent[x]);
            xorValue[x] ^= xorValue[parent[x]];
            parent[x] = root;
        } return parent[x];
    }

    inline function
    uunion(int x, int y, int value) -> bool {
        int rootX = this -> find(x);
        int rootY = this -> find(y);
        if (rootX == rootY) return (xorValue[x] ^ xorValue[y]) == value;
        if (rank[rootX] < rank[rootY])std::swap(rootX, rootY);
        parent[rootY] = rootX;
        xorValue[rootY] = xorValue[x] ^ xorValue[y] ^ value;
        if (rank[rootX] == rank[rootY])rank[rootX] ++;
        return true;
    }
};

signed main() {
    int n, m;read(n, m);
    std::vector<int> u(m), v(m), f(m);
    rop(i, 0, m){
        read(u[i], v[i], f[i]);
        -- u[i]; -- v[i];
    }
    Find uf(n); bool possible = true;
    rop(i, 0, m) {
        if (!uf.uunion(u[i], v[i], f[i])) {
            possible = false; break;
        }
    }
    if (!possible) std::printf("No\n");
    else {
        std::printf("Yes\n");
        std::vector<int> a(m, 0);
        rop(i, 0, m) a[i] = f[i];
        for (auto x : a) std::cout << x << ' ';
        std::printf("\n");
    }
    return 0;
}
```

---

## ä½œè€…ï¼šhhiron (èµï¼š3)

## è·¯å¾„åˆ†æ

é¦–å…ˆé¢˜ç›®è§„å®š**è·¯å¾„å¯ä»¥ç»è¿‡é‡å¤ç‚¹å’Œé‡å¤è¾¹**ã€‚æˆ‘ä»¬è€ƒè™‘èƒ½å¦ä¼˜åŒ–è¿™ç§å™è¿°ã€‚èµ°è¿‡çš„è¾¹æ— éå°±ä¸¤ç§æƒ…å†µï¼š

1ã€è¯¥è¾¹è¢«ç»è¿‡äº†å¥‡æ•°æ¬¡ï¼Œæ ¹æ®å¼‚æˆ–çš„æ€§è´¨ï¼Œè¿™ç§æƒ…å†µç­‰ä»·äºè¯¥è¾¹åªèµ°äº†ä¸€æ¬¡ã€‚

2ã€è¯¥è¾¹è¢«ç»è¿‡äº†å¶æ•°æ¬¡ã€‚å¯¹äºä¸€å¹…å›¾ï¼Œæˆ‘ä»¬åˆ å»å…¶ä¸­ç»è¿‡å¶æ•°æ¬¡çš„è¾¹ï¼Œç„¶åç”±äºæ¯ä¸ªå¶æ•°è¾¹çš„è¿›å…¥ç¦»å¼€æ¬¡æ•°éƒ½ä¸ºå¶æ•°ï¼Œæˆ‘ä»¬å¯ä»¥æŠŠè¿™äº›è¿›å…¥å’Œå‡ºå»çš„è¾¹ä¸¤ä¸¤ç›¸è¿ï¼Œç›´åˆ°å›¾ä¸­æ²¡æœ‰å¶æ•°è¾¹ä¸ºæ­¢ï¼Œè¿™æ ·ä¸€ç›´æ“ä½œè¿‡åèµ°è¿‡çš„è·¯å¾„ä¾ç„¶åˆæ³•ã€‚æ ¹æ®å¼‚æˆ–çš„æ€§è´¨ï¼Œå¶æ•°è¾¹çš„ä»£ä»·è®°ä¸º $0$ï¼Œåˆ™åˆ åçš„ä»£ä»·ä¸åŸä»£ä»·ç›¸ç­‰ï¼Œè§†ä¸ºç­‰ä»·ã€‚

ä»¥ä¸‹å›¾ä¸ºä¾‹ï¼Œå…¶ä¸­é»‘è‰²çš„ç®­å¤´ä»£è¡¨åŸæ¥ç»è¿‡çš„æƒ…å†µï¼Œé‚£ä¹ˆçº¢è‰²çš„ $e$ è¾¹è¢«ç»è¿‡äº†ä¸¤æ¬¡ï¼Œå¦‚æœæˆ‘ä»¬åˆ æ‰çº¢è‰²çš„ $e$ è¾¹ï¼Œå°†å››æ¡é»‘è¾¹æ”¹æˆå¦‚å›¾æ‰€ç¤ºçš„ç»¿è¾¹ï¼Œåˆ™åŸè·¯å¾„ä¾ç„¶è”é€šï¼Œåªéœ€è¦æ”¹å˜å‡ ä¸ªè¾¹çš„æ–¹å‘å³å¯è§†ä¸ºç­‰ä»·ã€‚

![](https://cdn.luogu.com.cn/upload/image_hosting/bfvd6nu8.png)

## ç‰¹æ®Šå›¾åˆ†æ

æ ¹æ®ä»¥ä¸Šä¸¤æ¡æ€§è´¨ï¼Œæˆ‘ä»¬ä»…éœ€è¦è€ƒè™‘ç®€å•è·¯å¾„å³å¯ (æŒ‡æ¯æ¡è¾¹ä»…è¢«ç»è¿‡ä¸€æ¬¡)ã€‚

æœ‰äº†ä»¥ä¸Šçš„æ€§è´¨ï¼Œæˆ‘ä»¬è€ƒè™‘è¿™å¼ å›¾ä¸ºæ ‘çš„æƒ…å†µï¼Œé‚£ä¹ˆä¸€ä¸ªåˆæ³•çš„æ„é€ æ–¹æ¡ˆæ˜¾ç„¶å¯ä»¥å°†å„ä¸ªè¾¹çš„é•¿åº¦ $w(u_i,v_i)$ èµ‹å€¼ä¸º $f(u_i,v_i)$ã€‚

é¢˜ç›®ä¸­çš„å›¾ä¸æ ‘ä¸åŒçš„æœ¬è´¨åœ¨äºæœ‰ç¯ï¼Œå› æ­¤æˆ‘ä»¬è€ƒè™‘ç®€å•ç¯ï¼Œè®°ä¸€ä¸ªç¯ä¸Šå„ä¸ªè¾¹çš„ $f(u_i,v_i)$ çš„å¼‚æˆ–å’Œä¸º $a$ã€‚æ¨¡æ‹Ÿä¸€ä¸‹æ ·ä¾‹å¯ä»¥å‘ç°å½“ $a$ çš„å€¼ä¸º $0$ æ—¶åˆæ³•ã€‚å› ä¸ºå¯¹äºä»»æ„ä¸¤ä¸ªç›¸é‚»çš„èŠ‚ç‚¹ $u,v$ï¼Œ å°†å®ƒä»¬ä¹‹é—´è¾¹çš„é•¿åº¦ $w(u,v)$ èµ‹å€¼ä¸º $f(u,v)$ï¼Œåˆ™æ— è®ºä»ç¯çš„å“ªä¸ªæ–¹å‘èµ°ï¼Œè·¯å¾„çš„æƒå€¼ä¸€å®šä¸º $w(u,v)$ æˆ– $w(u,b) \oplus a$ã€‚ä¸éš¾å‘ç°è¿™ç§æ„é€ ä¸€å®šæ»¡è¶³ã€‚

æ¥ä¸‹æ¥è€ƒè™‘å¿…è¦æ€§ï¼Œå‡è®¾ $a$ ä¸ä¸º $0$ï¼Œé‚£ä¹ˆå¿…ç„¶å­˜åœ¨ä¸€ä¸ªæœ€é«˜ä½å¼‚æˆ–åçš„ç»“æœä¸º $1$ï¼Œè®¾è¿™ä¸€ä½ä¸ºç¬¬ $k$ ä½ï¼Œä¹Ÿå¿…ç„¶å­˜åœ¨ä¸¤ä¸ªç›¸é‚»çš„èŠ‚ç‚¹ $u,v$ï¼Œå®ƒä»¬çš„ $f(u,v)$ çš„ç¬¬ $k$ ä½ä¹Ÿä¸º $1$ï¼Œæ ¹æ®å¼‚æˆ–çš„æ€§è´¨ï¼Œç”±äº $a$ çš„ç¬¬ $k$ ä½ä¸º $1$ é‚£ä¹ˆ $a\oplus f(u,v)<f(u,v)$ã€‚è¿™åæ˜ åœ¨è·¯å¾„ä¸Šæ˜¯æŒ‡ä¸ç›´æ¥åˆ°è¾¾ï¼Œåæ–¹å‘ç»•ä¸€åœˆçš„æƒ…å†µï¼Œè¯¥æƒ…å†µçš„ä»£ä»·æ¯” $f(u,v)$ å°ï¼Œä¸é¢˜ç›®ä¸­ $f(u,v)$ ä¸ºæœ€å°è·¯å¾„ä»£ä»·çŸ›ç›¾ã€‚å› æ­¤æˆ‘ä»¬å¾—å‡ºï¼š**å½“ä¸”ä»…å½“å¯¹äºå›¾ä¸­æ‰€æœ‰çš„ç¯ï¼Œç¯ä¸Šæ¯ä¸€æ¡è¾¹çš„ $f(u,v)$ çš„å¼‚æˆ–å’Œä¸º $0$ æ—¶æœ‰è§£ï¼Œä¸”æ„é€ çš„æ–¹å¼ä¸ºå°†å„ä¸ªè¾¹çš„é•¿åº¦ $w(u,v)$ èµ‹å€¼ä¸º $f(u,v)$**ã€‚

## ç»“è®º

æœ€åå°†ç¯å’Œæ ‘ç»“åˆèµ·æ¥è€ƒè™‘ï¼Œå¯ä»¥å°†é¢˜ç›®ä¸­ç»™å®šçš„å›¾è§†ä½œä¸€æ£µæ ‘å’Œè‹¥å¹²ç¯æ„æˆï¼Œæˆ‘ä»¬å¯ä»¥åœ¨éå†æ ‘ä¸ŠèŠ‚ç‚¹çš„æ—¶å€™æ‰¾åˆ°ç¯ï¼Œè¿ç”¨ç±»ä¼¼æ ‘ä¸Šå·®åˆ†çš„æ“ä½œï¼Œè®¡ç®—å‡ºæ¯ä¸ªç¯çš„å¼‚æˆ–é•¿åº¦ï¼Œåˆ¤æ–­è¯¥å¼‚æˆ–å€¼æ˜¯å¦ä¸º $0$ å³å¯ã€‚å…·ä½“çš„ï¼Œåœ¨DFSæ—¶è®°å½•æ¯ä¸ªèŠ‚ç‚¹åˆ°æ ¹èŠ‚ç‚¹çš„å¼‚æˆ–å’Œ $dis[u]$ï¼Œ$dis[u]=dis[fa]\oplus f(fa,u)$ï¼Œå½“å‘ç°æŸæ¡è¾¹ $e(u,v)$ æŒ‡å‘å·²ç»è¢«éå†è¿‡çš„ç‚¹æ—¶å¯ä»¥ç®—å‡ºè¿™ä¸ªç¯çš„å¼‚æˆ–å’Œ $dis[u]\oplus dis[v]\oplus f(u,v)$ï¼Œæœ€ååˆ¤æ–­å®ƒæ˜¯å¦ä¸º $0$ å³å¯ã€‚

ç»“åˆä¸‹å›¾ç†è§£ï¼Œå…¶ä¸­è“è‰²ä»£è¡¨ $dis[v]$ ï¼Œç»¿è‰²ä»£è¡¨ $dis[u]$ ï¼Œçº¢è‰²ä»£è¡¨ä¸€æ¡æŒ‡å‘å·²è¢«éå†è¿‡çš„ç‚¹çš„è¾¹ï¼Œæ„æˆä¸€ä¸ªç´«è‰²çš„ç¯ã€‚ä¸éš¾å‘ç°ç´«è‰²ç¯çš„å„è¾¹å¼‚æˆ–å’Œç­‰äºçº¢ï¼Œç»¿ï¼Œè“ä¸‰ä¸ªå€¼çš„å¼‚æˆ–å’Œã€‚

![](https://cdn.luogu.com.cn/upload/image_hosting/uhvxr3qx.png)

## code

æœ€ä¸‘çš„ç¯èŠ‚ï¼š

```cpp
#include<bits/stdc++.h>
#define INF 0x7fffffff
typedef long long ll;
using namespace std;
const int N=1e6+6;
int n,m,tot=0,head[N],a[N];
struct node{
	int nxt,to,w;
}e[N<<2];
void addEdge(int u,int v,int w){
	e[++tot]=(node){head[u],v,w};
	head[u]=tot;
	e[++tot]=(node){head[v],u,w};
	head[v]=tot;
}
int dis[N];
bool ans=1;
void dfs(int u){
	for(int i=head[u];i;i=e[i].nxt){
		int v=e[i].to;
		if(dis[v]!=-1){
			if(dis[u]^e[i].w^dis[v]) ans=0;
			continue;
		}
		dis[v]=dis[u]^e[i].w;
		dfs(v);
	}
}
int main(){
	scanf("%d%d",&n,&m);
	for(int i=1,x,y,z;i<=m;i++){
		scanf("%d%d%d",&x,&y,&z);
		addEdge(x,y,z); a[i]=z;
	}
	for(int i=1;i<=n;i++) dis[i]=-1;
	for(int i=1;i<=n;i++){
		if(dis[i]==-1){
			dis[i]=0;
			dfs(i);
		} 
	}
	if(ans){
		puts("Yes");
		for(int i=1;i<=m;i++) printf("%d ",a[i]);
	}else puts("No");
	return 0;
}
```

è¿™æ˜¯è’Ÿè’»çš„ç¬¬ä¸€ç¯‡é¢˜è§£ï¼Œå¦‚æœ‰ä¸è¶³ï¼Œæ¬¢è¿æŒ‡æ­£ã€‚

---

## ä½œè€…ï¼šGrand_Dawn (èµï¼š3)

ç»“è®ºï¼šå­˜åœ¨ $a_i$ å½“ä¸”ä»…å½“å›¾ä¸Š**æ‰€æœ‰** $f(x_i,y_i)$ æ‰€å½¢æˆçš„ç¯å¼‚æˆ–å’Œä¸º $0$ã€‚æœ‰è§£æ—¶ï¼Œç›´æ¥ä»¤ $a_i=f(x_i,y_i)$ å³å¯ã€‚è¯æ˜è§åã€‚

### ä»£ç å®ç°

é‡‡ç”¨ [P4151](https://www.luogu.com.cn/problem/P4151) çš„æ–¹æ³•æ˜¯å¯ä»¥çš„ã€‚

æˆ–è€…ï¼Œå¦‚æœå­¦ä¹ è¿‡æ•°å­¦åˆ†æçš„è¯ï¼Œå¯ä»¥è¯æ˜æ‰€æœ‰ç¯å¼‚æˆ–å’Œä¸º $0$ å’Œæœ‰åŠ¿åœºæ˜¯ç­‰ä»·çš„ã€‚é’¦å®šæŸä¸€ä¸ªç‚¹çš„åŠ¿ä¸º $0$ï¼Œç›´æ¥ `dfs` ä¸€æ¬¡è®¡ç®—å‡ºæ¯ä¸ªç‚¹çš„åŠ¿ï¼Œå¹¶æœ€åæ£€æŸ¥ä¸€ä¸‹æ˜¯å¦æ»¡è¶³æ¯æ¡è¾¹ä¸¤è¾¹çš„åŠ¿å·®ä¸º $f(x_i,y_i)$ å³å¯ã€‚

----

By [Argon_Cube](https://www.luogu.com.cn/user/372983)ï¼š

ç®€å•æ¥è¯´å°±æ˜¯ï¼Œå¯¹äºä¸€ä¸ªè¿é€šå—éšä¾¿é€‰ä¸€ä¸ªæ ¹ $r$ æ‹‰å‡ºä¸€ä¸ªç”Ÿæˆæ ‘ï¼Œç„¶åè®¡ç®—æ ‘ä¸Šæ¯ä¸ªç‚¹ $u$ åˆ°æ ¹è·¯å¾„çš„æƒå€¼ä½œä¸ºè¯¥ç‚¹çš„ç‚¹æƒ $b_u$ã€‚åŸå›¾åˆæ³•å½“ä¸”ä»…å½“å¯¹äºå›¾ä¸­çš„æ¯æ¡è¾¹ï¼Œè¾¹ä¸¤ç«¯çš„ç‚¹æƒå¼‚æˆ–å’Œç­‰äºè¾¹æƒã€‚

æ˜¾ç„¶å¦‚æœè¾¹ $(u,v,w)$ æ»¡è¶³ $b_u\oplus b_v\neq w$ é‚£ä¹ˆç›´æ¥é€‰å–ç¯ $u\to r\to v\to u$ å°±æ˜¯ä¸€ä¸ªå¼‚æˆ–å’Œé $0$ çš„ç¯ã€‚å¦åˆ™ä»»æ„è·¯å¾„ $u\to v$ çš„æƒå€¼éƒ½æ˜¯ $b_u\oplus b_v$ï¼Œç‰¹åˆ«çš„ç¯çš„æƒå€¼ä¸€å®šæ˜¯ $0$ã€‚

----

```cpp
#include<bits/stdc++.h>
#define N 1000009
using namespace std;
int n,m;
vector<int>to[N];
struct{
	int x,y,f;
}e[N];
int phi[N],vst[N];
void dfs(int x,int val){
    phi[x]=val;vst[x]=1;
    for(int abc=0;abc<to[x].size();abc++){
    	int i=to[x][abc],y=e[i].x^e[i].y^x;
    	if(!vst[y])dfs(y,val^e[i].f);
	}
}
int main(){
	//freopen("1-5.in","r",stdin);
	//freopen("1-5.out","w",stdout);
	scanf("%d%d",&n,&m);
	for(int i=1;i<=m;i++){
		scanf("%d%d%d",&e[i].x,&e[i].y,&e[i].f); 
		to[e[i].x].push_back(i);
		to[e[i].y].push_back(i);
	}
	for(int i=1;i<=n;i++){
		if(!vst[i])dfs(i,0);
	}
	for(int i=1;i<=m;i++)
		if((phi[e[i].x]^phi[e[i].y])!=e[i].f){
			cout<<"No"<<endl;
			return 0; 
		}
	cout<<"Yes"<<endl;
	for(int i=1;i<=m;i++)printf("%d ",e[i].f);
	return 0;
}

```

### åˆ¤æ–­æœ‰è§£æ€§çš„è¯æ˜

ç”¨åè¯æ³•ï¼Œå‡è®¾å­˜åœ¨ä¸€ä¸ªå›è·¯ $a_1,a_2,...,a_k$ ä½¿å¾— $\bigoplus\limits_{i=1}^{k} f(a_i,a_{i+1})\neq 0$ï¼Œåˆ™å¿…ç„¶å­˜åœ¨ä¸€ä½æœ€é«˜äºŒè¿›åˆ¶ä½ä½¿å¾—è¯¥å¼‚æˆ–å€¼è¿™ä¸€ä½ä¸º $1$ã€‚

ç”±äºè¯¥ä½å¼‚æˆ–å€¼ä¸º $1$ï¼Œåˆ™æ˜¾ç„¶è‡³å°‘ä¼šå­˜åœ¨ä¸€ä¸ª $i$ ä½¿å¾— $f(a_i,a_{i+1})$ è¿™ä¸€ä½ä¸º $1$ï¼Œä¸å¦¨ $f(a_n,a_1)$ è¿™ä¸€ä½ä¸º $1$ã€‚è€Œå†è€ƒè™‘ $a_n$ åˆ° $a_1$ æ²¿ç€ $a_n$ åˆ° $a_{n-1}$ åˆ°......åˆ° $a_{1}$ï¼Œæ­¤æ—¶è·¯å¾„çš„ä»£ä»·å‡½æ•°ä¸º $\bigoplus\limits_{i=1}^{k-1} f(a_i,a_{i+1})$ï¼Œè€Œè¯¥å€¼çš„è¿™ä½äºŒè¿›åˆ¶ä½ä¸º $0$ï¼Œæ¯”åŸæœ¬çš„ $f(a_n,a_1)$ æ›´å°ï¼ŒçŸ›ç›¾ã€‚

å› æ­¤æ‰€æœ‰å›è·¯å‡æœ‰å¼‚æˆ–å’Œä¸º $0$ã€‚

### æ„é€ æ­£ç¡®æ€§çš„è¯æ˜

~~æ˜¾ç„¶ç”±æ•°å­¦åˆ†æçŸ¥è¯†ï¼Œæœ‰åŠ¿åœºä¸ºä¿å®ˆåœºï¼Œæ•…è·¯å¾„çš„ä»£ä»·å‡½æ•°å’Œè·¯å¾„æ— å…³ï¼Œå³åˆšå¥½ä¸º $a_i=f(x_i,y_i)$ã€‚~~

By [Argon_Cube](https://www.luogu.com.cn/user/372983)ï¼šæ˜¾ç„¶ $u$ åˆ° $v$ çš„ä»»æ„ä¸¤æ¡è·¯å¾„éƒ½å½¢æˆäº†ä¸€ä¸ªç¯ï¼Œåˆå› ä¸ºä»»æ„ç¯å¼‚æˆ–å’Œä¸º $0$ æ‰€ä»¥è¿™ä¸¤æ¡è·¯å¾„æƒå€¼ç›¸ç­‰ï¼Œæ‰€ä»¥ä» $u_i$ åˆ° $v_i$ çš„ä»»æ„è·¯å¾„ç­‰ä»·äºè¾¹ $(u_i,v_i)$ã€‚

### å½©è›‹

+ ä¸ºä»€ä¹ˆä¸æ˜¯äº¤äº’é¢˜ï¼Ÿå› ä¸ºå³ä½¿è¯¢é—®äº†æ‰€æœ‰çš„ $f(x,y)$ å $a_i$ ä¾ç„¶ä¸æ˜¯å”¯ä¸€çš„ï¼

+ å¦‚æœä½ åšè¿‡ [P4151](https://www.luogu.com.cn/problem/P4151) çš„è¯ï¼Œé‚£ä¹ˆå®ƒçš„æ€è·¯å¾ˆå¯èƒ½å¹¶ä¸ä¼šå¸®åŠ©ä½ è§£å†³è¿™é“é¢˜ã€‚

+ å¦‚ä½•æƒ³åˆ°ç®—æ³•ï¼Ÿè€ƒè™‘ç±»ä¼¼ Floyd ç®—æ³•çš„æ¾å¼›æ€æƒ³å³å¯ã€‚

---

## ä½œè€…ï¼šAmaoFox (èµï¼š1)

å¯¹äºä¸‰ä¸ªèŠ‚ç‚¹ $x$ å’Œ $y$ å’Œ $z$ï¼Œå¦‚æœ $f(x,y) \ne f(x,z) \oplus f(z,y)$ï¼Œé‚£ä¹ˆè¿™ä¸ªè¾“å…¥è‚¯å®šæ˜¯ä¸åˆæ³•çš„ï¼Œå…¶ä¸­æœ‰ä¸€ä¸ªå‡½æ•°å€¼è‚¯å®šæ˜¯ä¸å¤Ÿå°çš„ã€‚  
æ¨å¹¿å‡ºæ¥ï¼Œæˆ‘ä»¬å¯¹äºæ¯ä¸€ä¸ªè¾“å…¥çš„ $x$ å’Œ $y$ è¿è¾¹ï¼Œä»¥ $f(x,y)$ ä½œä¸ºè¾¹æƒï¼Œé‚£ä¹ˆè¿™ä¸ªå›¾ä¸­æ‰€æœ‰çš„ç¯ä¸Šçš„è¾¹ï¼Œå¼‚æˆ–å€¼éƒ½ä¸º $0$ã€‚ä¸ç„¶å°±ä¼šå‡ºç°ä¸¤ç‚¹ä¹‹é—´ä¸¤æ¡è·¯å¾„å¼‚æˆ–å€¼ä¸ç›¸ç­‰çš„æƒ…å†µï¼Œé‚£ä¹ˆè‚¯å®šæ˜¯æœ‰è‡³å°‘ä¸€ä¸ªè¾¹æƒè¿˜ä¸å¤Ÿå°ã€‚

å‡è®¾å·²ç»æ»¡è¶³äº†ä¸Šé¢è¿™ä¸ªæ¡ä»¶ï¼Œåˆ™æˆ‘ä»¬å¯ä»¥å‘ç° $x$ åˆ° $y$ ä¸­é—´å·²ç»æœ‰ä¸€æ¡è¾¹é•¿åº¦ä¸º $f(x,y)$ï¼Œå¹¶ä¸”æ ¹æ®è¿™ä¸ªæ¡ä»¶ä¿æŠ¤çš„æ€§è´¨ä½¿å¾—å‰©ä¸‹æ‰€æœ‰è·¯å¾„çš„å¼‚æˆ–å€¼ä¹Ÿæ˜¯ $f(x,y)$ï¼Œæ‰€ä»¥è¿™ç§æ„é€ æ˜¯å¯è¡Œçš„ã€‚

ä¸ºäº†æ»¡è¶³ä¸Šé¢è¿™ä¸ªæ¡ä»¶ï¼Œæˆ‘ä»¬å¯ä»¥ä»ä¸€ä¸ªç‚¹å‡ºå‘è¿›è¡Œ dfsï¼Œå¦‚æœå‘ç°æŸä¸ªç‚¹çš„ä¸‹ä¸€ä¸ªèŠ‚ç‚¹å·²ç»è¢«è®¿é—®è¿‡ä½†æ˜¯å¼‚æˆ–è·ç¦»å¹¶ä¸ç¬¦åˆå°±å¯ä»¥ç›´æ¥ `No` äº†ã€‚å…·ä½“ç»†èŠ‚çœ‹ä»£ç ã€‚


``` cpp
#include <bits/stdc++.h>
#define int long long

using namespace std;

const int N = 500005;

struct Edge {
  int v, w;
};

vector<Edge> g[N];
int dis[N], vis[N], ans[N];

void dfs(int u, int x) { // x æ˜¯è°ƒè¯•é—ç•™äº§ç‰©
  vis[u] = 1;
  for(auto v : g[u]) {
    if(vis[v.v] && dis[v.v] != (dis[u] ^ v.w)) { // æˆ‘ä»¬å‘ç°ä»ä¸€å¼€å§‹é‚£ä¸ªç‚¹å¼€å§‹ï¼Œç»è¿‡ u åˆ° v.v å’Œå¦ä¸€æ¡åˆ° v.v çš„è·ç¦»ä¸ç›¸ç­‰
      cout << "No";
      exit(0);
    } else if(!vis[v.v]) {
      dis[v.v] = dis[u] ^ v.w;
      dfs(v.v, dis[v.v]);
    }
  }
}

signed main() {
  int n, m;
  cin >> n >> m;
  for(int i = 1; i <= m; i++) {
    int u, v;
    cin >> u >> v >> ans[i];
    g[u].push_back({v, ans[i]});
    g[v].push_back({u, ans[i]});
  }
  for(int i = 1; i <= n; i++) {
    if(!vis[i]) {
      dfs(i, 0);
    }
  }
  cout << "Yes\n";
  for(int i = 1; i <= m; i++) {
    cout << ans[i] << ' ';
  }
}
```

---

## ä½œè€…ï¼šé”¦ä¾å«å°ç”Ÿ (èµï¼š1)

# P11170  
## åŸºæœ¬æ€è·¯  
æ³¨æ„åˆ°è¾“å…¥çš„ $f(u,v)$ çº¦æŸåªä½œç”¨äºç°æœ‰è¾¹ã€‚ä¸éš¾å¾—å‡ºç»“è®ºï¼šè‹¥ç­”æ¡ˆå­˜åœ¨ï¼Œé‚£ä¹ˆå°† $f(u,v)$ ä½œä¸º $u$ï¼Œ$v$ çš„è¾¹æƒä¸€å®šæ˜¯åˆæ³•ç­”æ¡ˆä¹‹ä¸€ã€‚ç®€å•è¯æ˜ï¼šè‹¥å‡ºç° $f(x,y) \bigoplus f(y,z) < f(x,z)$ï¼Œæ­¤æ—¶ä¸€å®šæ— è§£ï¼›åä¹‹å°† $f(u,v)$ ä½œä¸º $u$ï¼Œ$v$ çš„è¾¹æƒä¸€å®šåˆæ³•ã€‚   
é—®é¢˜è½¬åŒ–åˆ¤æ–­æ— å‘å›¾æ˜¯å¦æ»¡è¶³å¼‚æˆ–æ„ä¹‰ä¸Šçš„ä»»æ„ç›´æ¥ç›¸è¿çš„ä¸¤ç‚¹çš„æœ€çŸ­è·¯å¾„å°±æ˜¯å…¶è¾¹æƒã€‚å…ˆç»™å‡ºç»“è®ºï¼šå½“ä¸”ä»…å½“æ‰€æœ‰çš„ç¯ï¼Œå…¶ä¸Šæ‰€æœ‰è¾¹æƒå¼‚æˆ–å’Œä¸º $0$ æ—¶æ»¡è¶³æ¡ä»¶ã€‚  
åè¯ï¼šä»¥ $3$ ç‚¹ä¸ºä¾‹ã€‚å‡è®¾å­˜åœ¨å¼‚æˆ–å’Œé $0$ æ—¶æ»¡è¶³æ¡ä»¶ã€‚ä»¤ $a < b < c$ï¼Œåˆ™ $a \bigoplus b > c$ï¼Œ$a \bigoplus c > b$ï¼Œ$b \bigoplus c > a$ã€‚åˆ™ $c = a \bigoplus b \bigoplus k$ï¼Œ$k$ æ»¡è¶³æœ€é«˜ä½ $1$ çš„ä½ç½® $a$ï¼Œ$b$ åœ¨è¯¥ä½å‡ºç° $1$ ä¸ $0$ã€‚æ¡ä»¶è½¬ä¸º $a \bigoplus k > a$ï¼Œ$b \bigoplus k > b$ï¼Œè‡³å°‘ä¸€ä¸ªä¸ç­‰å¼æ— æ³•æ»¡è¶³ã€‚å¤šäºä¸‰ç‚¹ç±»æ¨å¯å¾—ï¼ˆé€ƒï¼‰ï¼Œå¾—è¯ã€‚  
åˆ¤æ–­è¿‡ç¨‹æ˜¾ç„¶ä¸éœ€è¦æ‰¾åˆ°æ‰€æœ‰ç¯ã€‚å€ŸåŠ©å¹¿æœï¼Œè‹¥å½“å‰ç”± $u$ éå†åˆ°çš„ç‚¹ $v$ æœªéå†è¿‡ï¼Œåˆ™ $f_{v} \gets f_{u} \bigoplus w$ï¼Œå…¥é˜Ÿï¼›å¦åˆ™åˆ¤æ–­ $f_{v} = f_{u} \bigoplus w$ï¼Œè‹¥ä¸ç­‰åˆ™è¾“å‡ºå¹¶é€€å‡ºç¨‹åºã€‚è¯¦è§ä»£ç ã€‚ 
## ä»£ç 

```cpp
#include<bits/stdc++.h>
using namespace std;
const int MAX=5e5+5;
int ans[MAX],f[MAX];
bool vis[MAX];
queue<int> q;
struct edge{
	int nxt,to,w;
};
edge e[MAX*2];
int n,m,tot,h[MAX];
void addedge(int u,int v,int w){
	e[++tot].to=v;
	e[tot].nxt=h[u];
	e[tot].w=w;
	h[u]=tot;
}
void bfs(int x){
	q.push(x);
	vis[x]=1;
	while(!q.empty()){	
		int u=q.front();
		q.pop();
		for(int i=h[u];i;i=e[i].nxt){
			int v=e[i].to;
			if(vis[v]){
				if(f[v]!=(f[u]^e[i].w)){
					cout<<"No";
					exit(0);
				}
			}
			else{
				vis[v]=1;
				f[v]=(f[u]^e[i].w);
				q.push(v);
			}
		}
	}
}
int read(){
	int x = 0, f = 1;
	char c = getchar();
	while(c < '0' || c > '9'){
		if(c == '-'){
			f = -1;
		}
		c = getchar();
	}
	while(c >= '0' && c <= '9'){
		x = x*10+c-'0';
		c = getchar();
	}
	return x*f;
}

int main(){
	cin>>n>>m;
	bool flag=0;
	for(int i=1;i<=m;++i){
		int u=read(),v=read(),w=read();
		addedge(u,v,w);
		addedge(v,u,w);
		ans[i]=w;			
	}
	for(int i=1;i<=n;++i)
		if(!vis[i]){
			bfs(i);
		} 
	cout<<"Yes"<<endl;
	for(int i=1;i<=m;++i)
		printf("%d ",ans[i]);
} 
```

---

## ä½œè€…ï¼šDream_Realizer (èµï¼š0)

èµ›æ—¶æ€è·¯æƒ³çš„æ²¡é‚£ä¹ˆå¤æ‚ï¼Œå°±æŠŠè¿™ä¸ªé—®é¢˜è½¬æ¢æˆä¸€ä¸ªå›¾ä¸Šçš„æœ€çŸ­è·¯å¾„é—®é¢˜ï¼Œä½†è¿™é‡Œçš„â€œæœ€çŸ­è·¯å¾„â€ç”¨çš„æ˜¯å¼‚æˆ–è¿ç®—ï¼Œè€Œä¸æ˜¯å¸¸è§„çš„åŠ æ³•è¿ç®—ã€‚

å…ˆæ„å»ºä¸€æ£µæœ€å°ç”Ÿæˆæ ‘ï¼Œå°è¯•ç¡®å®šè¾¹æƒï¼Œå¹¶ä½¿å¾—æ¯æ¡è¾¹çš„è·¯å¾„ä»£ä»·ç­‰äºç»™å®šçš„ $f(u_i, v_i)$ã€‚å¯¹äºä¸€ä¸ªå›¾çš„ä¸¤ç‚¹ $x$ å’Œ $y$ï¼Œå¦‚æœ $x$ åˆ° $y$ çš„æŸæ¡è·¯å¾„çš„å¼‚æˆ–ä»£ä»·æ˜¯æŸä¸ªå€¼ï¼Œé‚£ä¹ˆå›¾ä¸­æ‰€æœ‰ $x$ åˆ° $y$ çš„è·¯å¾„çš„å¼‚æˆ–å€¼éƒ½å…·æœ‰ç›¸åŒçš„æ¨¡ 2 å’Œç›¸åŒçš„ç‰¹å¾ã€‚å› æ­¤ï¼Œè·¯å¾„ä¹‹é—´çš„å¼‚æˆ–å€¼æ„æˆäº†ä¸€ä¸ªçº¿æ€§æ–¹ç¨‹ç»„ã€‚

å¾€ç»†æ¥è¯´å¤§æ¦‚æ˜¯è¿™æ ·ï¼Œå¯¹äºæ¯æ¡è¾¹ $(u_i,v_i)$ï¼Œæˆ‘ä»¬æœ‰ï¼š

$$f(u_i, v_i) = a_i$$

å¯¹äºä»»æ„ä¸€æ¡ä» $u$ åˆ° $v$ çš„è·¯å¾„ï¼Œç”±è·¯å¾„ä¸Šæ¯æ¡è¾¹çš„è¾¹æƒ $a_{e_i}$ æ„æˆçš„å¼‚æˆ–å’Œï¼Œå¿…é¡»ç­‰äºç»™å®šçš„ $f(u,v)$ã€‚è¿™å¯ä»¥è¡¨ç¤ºä¸ºï¼š

$$f(u, v) = a_{e_1} \oplus a_{e_2} \oplus \cdots \oplus a_{e_k}$$

å…¶ä¸­ $(ğ‘’_1,ğ‘’_2,\cdots,ğ‘’_ğ‘˜)$æ˜¯ä» $u$ åˆ° $ğ‘£$ çš„è·¯å¾„ä¸Šçš„è¾¹ã€‚

å¯¹äºå›¾ä¸­çš„æ¯å¯¹èŠ‚ç‚¹ï¼Œæˆ‘ä»¬å¯ä»¥åŸºäºå…¶è·¯å¾„å»ºç«‹ä¸€ä¸ªæ–¹ç¨‹ã€‚å¯¹äº $m$ æ¡è¾¹ï¼Œæˆ‘ä»¬å¯ä»¥å†™å‡ºå¦‚ä¸‹æ–¹ç¨‹ç»„ï¼š

$$\begin{aligned}
f(u_1, v_1) &= a_1 \\
f(u_2, v_2) &= a_2 \\
&\vdots \\
f(u_k, v_k) &= a_{e_1} \oplus a_{e_2} \oplus \cdots \oplus a_{e_k}
\end{aligned}$$

å°†ä¸Šè¿°æ–¹ç¨‹ç»„è½¬åŒ–ä¸ºçŸ©é˜µå½¢å¼ï¼š

$$A \cdot x = b$$

å…¶ä¸­ $A$ æ˜¯åŸºäºå›¾çš„ç»“æ„ç”Ÿæˆçš„ç³»æ•°çŸ©é˜µï¼Œæ¯ä¸€è¡Œä»£è¡¨ä¸€æ¡è·¯å¾„ä¸Šçš„è¾¹ï¼›$x$ æ˜¯åŒ…å«æ‰€æœ‰è¾¹æƒ $a_i$ çš„å‘é‡ï¼›$b$ æ˜¯åŒ…å«æ‰€æœ‰å·²çŸ¥çš„ $f(u_i, v_i)$ çš„å‘é‡ã€‚

æ­¤æ—¶å°±å¯ä»¥é€šè¿‡é«˜æ–¯æ¶ˆå…ƒå¤„ç†ã€‚åœ¨å¼‚æˆ–è¿ç®—ä¸‹ï¼Œè¯¥æ–¹ç¨‹ç»„å®é™…ä¸Šæ˜¯ä¸€ä¸ªçº¿æ€§æ–¹ç¨‹ç»„ï¼Œåªä¸è¿‡è¿ç®—æ˜¯åŸºäºæ¨¡ 2 çš„åŠ æ³•è¿ç®—ï¼š

$$\text{Gaus} \Rightarrow x = A^{-1} \cdot b$$

å¦‚æœè¯¥æ–¹ç¨‹ç»„æœ‰è§£ï¼Œåˆ™å¯ä»¥æ±‚å‡ºæ‰€æœ‰è¾¹æƒ $a_i$ï¼›å¦‚æœæ— è§£ï¼Œåˆ™è¡¨ç¤ºä¸å­˜åœ¨æ»¡è¶³æ¡ä»¶çš„è¾¹æƒåˆ†é…ã€‚

é‚£å…¶å®å°±å¾ˆå¥½åŠäº†ï¼Œç”¨å¹¶æŸ¥é›†æ¥ç»´æŠ¤æ¯ä¸ªç‚¹æ‰€åœ¨çš„è¿é€šåˆ†é‡ï¼Œä»¥åŠå½“å‰ç‚¹åˆ°å…¶ç¥–å…ˆèŠ‚ç‚¹çš„å¼‚æˆ–å€¼ã€‚å¯¹äºæ¯æ¡è¾¹ $(u_i, v_i, f(u_i, v_i))$ï¼Œé¦–å…ˆæ£€æŸ¥ $u_i$ å’Œ $v_i$ æ˜¯å¦å·²ç»è¿é€šã€‚å¦‚æœä¸è¿é€šï¼Œåˆ™å°†å…¶åˆå¹¶ï¼Œå¹¶è®°å½•è¾¹çš„å¼‚æˆ–å€¼ã€‚å¦‚æœå·²ç»è¿é€šï¼Œåˆ™æ£€æŸ¥è·¯å¾„çš„å¼‚æˆ–å€¼æ˜¯å¦ä¸ $f(u_i, v_i)$ ç›¸ç¬¦ã€‚å¦‚æœä¸ç¬¦ï¼Œåˆ™è¯´æ˜æ— è§£ã€‚

æ—¶é—´å¤æ‚åº¦ä¸º $O(\alpha(n))$ï¼Œå…¶ä¸­ $\alpha(n)$ æ˜¯åé˜¿å…‹æ›¼å‡½æ•°ã€‚ä½†å¥½åƒå®é™…åº”ç”¨é‡Œè·Ÿå¸¸æ•°å·®ä¸å¤šã€‚ç©ºé—´å¤æ‚åº¦å¾ˆæ˜æ˜¾å°±æ˜¯ $O(n)$ äº†ï¼Œå­˜å¹¶æŸ¥é›†ç»“æ„ã€‚

èµ›æ—¶ä»£ç ï¼š

```cpp
#include <iostream>
#include <vector>
using namespace std;

struct UF {
    vector<int> p, r, x;
    UF(int n) : p(n), r(n, 0), x(n, 0) {
        for (int i = 0; i < n; ++i) p[i] = i;
    }
    int fnd(int a) {
        if (p[a] != a) {
            int rt = fnd(p[a]);
            x[a] ^= x[p[a]];
            p[a] = rt;
        }
        return p[a];
    }
    bool uni(int a, int b, int v) {
        int ra = fnd(a), rb = fnd(b);
        if (ra == rb) return false;
        if (r[ra] > r[rb]) {
            p[rb] = ra;
            x[rb] = v ^ x[a] ^ x[b];
        } else if (r[ra] < r[rb]) {
            p[ra] = rb;
            x[ra] = v ^ x[a] ^ x[b];
        } else {
            p[rb] = ra;
            x[rb] = v ^ x[a] ^ x[b];
            r[ra]++;
        }
        return true;
    }
    bool con(int a, int b) {
        return fnd(a) == fnd(b);
    }
    int get(int a, int b) {
        return x[a] ^ x[b];
    }
};

int main() {
    ios::sync_with_stdio(false);
    cin.tie(0);
    
    int n, m;
    cin >> n >> m;
    UF uf(n);
    vector<tuple<int, int, int>> e(m);
    for (int i = 0; i < m; ++i) {
        int u, v, f;
        cin >> u >> v >> f;
        e[i] = {u - 1, v - 1, f};
    }
    for (auto &[u, v, f] : e) {
        if (uf.con(u, v)) {
            if (uf.get(u, v) != f) {
                cout << "No\n";
                return 0;
            }
        } else {
            uf.uni(u, v, f);
        }
    }
    cout << "Yes\n";
    for (auto &[u, v, f] : e) {
        cout << f << " ";
    }
    cout << "\n";
    return 0;
}
```

---


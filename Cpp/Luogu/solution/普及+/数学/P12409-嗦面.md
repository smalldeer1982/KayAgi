# 嗦面

## 题目背景

> 他们曾如此骄傲地……

## 题目描述

给你 $n$ 根面条，长度为 $\{l_1,l_2,l_3,\cdots,l_n\}$，你可以进行若干次以下操作：

* 选取一根长度为偶数的面条，把它平均切成两根面条。

有 $m$ 次询问（**每次询问独立**）：

* ```a b c d e f```：请判断能否切完面条后让面条长度的**乘积**等于 $R=2^a\times3^b\times5^c\times7^d\times11^e\times13^f$；若能则输出 ```1```，否则输出 ```0```。

## 说明/提示

数据：

$R=2^a\times3^b\times5^c\times7^d\times11^e\times13^f$
| Subtask | $n$ | $l_i$ | $a,b,c,d,e,f$ | $R$ | pts  |
| :----------: | :----------: | :----------: | :----------: | :----------: | :----------: |
| $0$ | $\le10$ | $1\le l_i\le13$ | $\le80$ | $\le10^6$ | $10$ |
| $1$ | $\le10$ | $1\le l_i\le13$ | $\le10$ | 无特殊限制 | $10$ |
| $2$ | $\le80$  | $1\le l_i\le13$ | $\le80$ | 无特殊限制 | $20$ |
| $3$ | $\le10^5$  | $1\le l_i\le13$ | $\le4\times10^5$ | 无特殊限制 | $60$ |

对于所有数据，$1\le n\le 10^5$，$1\le l_i\le 13$，$1\le m\le10^5$，$0\le a,b,c,d,e,f\le4\times10^5$。


## 样例 #1

### 输入

```
6 4
2 4 6 12 9 11
6 4 0 0 1 0 
5 5 0 0 1 0
0 8 0 0 1 0
0 8 0 0 2 0```

### 输出

```
1
1
1
0```

# 题解

## 作者：_Yonder_ (赞：3)

观察可以发现 $l_i=7,11,13$ 的不可能执行操作，所以询问 $d,e,f$ 时可以直接判断。

对于 $5$ 的指数，显然只能通过操作 $10$ 来控制。

最后的问题就会变成判断 $2^a\times3^b$ 能否达到（这里的 $a$ 与数据给出的 $a$ 不相同，因为操作 $10$ 会改变这里的指数）。

$3,9$ 的贡献是固定的不做考虑。

手玩一下 $2,4,8$ 可以发现它们可以对 $2$ 的指数的贡献分别为 $0\sim1,0\sim2,0\sim4$，所以 $2$ 的指数我们可以通过 $2,4,8$ 任意更改到一个指定范围。

最难的应该就是 $6,12$ 了。

对于相同的 $b$，$2$ 的指数是一段连续的值。求出 $2$ 的指数范围即可。

大概求法：先把全部数拆成 $3$，然后合并。能合并成 $6$ 就先合并成 $6$，否则合并成 $12$。容易发现这是最高指数。最低指数只需在此基础上更改，就是三个 $6$ 换成 $3,3,12$。

时间复杂度 $O(n+m)$。

---

## 作者：allen2010 (赞：2)

注意到 $1 \le l \le 13$，~~于是这题就可以愉快地做完了~~。

---

将 $2,3,5,7,11,13$ 这六个质数分类讨论：

显然，$7,11,13$ 这三个数在 $l$ 的范围内只有其本身是它们的倍数，所以直接判断 $7,11,13$ 的个数是否分别等于 $d,e,f$ 就可以了。

对于 $5$，除了 $5$ 本身外 $10$ 也可以对答案做出贡献，而且 $10$ 可以拆分。只要判断 $c$ 是否在拆分和不拆分时 $5$ 的个数的范围内就可以了。这里同时还要记录一下要拆分的次数，等会处理 $2$ 的时候要用。

$3$ 是比较难处理的。$6$ 和 $12$ 都可以对它做贡献，但是拆 $6$ 会减少 $2$ 的数量，而拆 $12$ 不会。这种情况下，考虑拆分后 $2$ 减少的数量的最大和最小值。最小值就是先拆 $12$，最大值是先拆 $6$，拆完后每拆一个 $12$ 接着就拆拆分 $12$ 后产生的 $6$。

最后来看看 $2$。设 $amin$ 表示 $2$ 减少的总数量（包括拆分 $10$ 的），$t$ 为各个数的总数量，则有以下不等式：

$2 \times t_{12}+t_{6}+t_{10} - amin\le a \le 2 \times t_{12} + t_{6}+t_{10}- amin + t_2+2 \times t_4+4 \times t_8$

注意到 $2,4,8$ 均可以拆分到 $1$，所以上式的意义就十分显然了。根据上面的讨论，将 $amin$ 的最大最小值带入判断即可。

于是这题真正地愉快地做完了~~~

代码：


```cpp
#include <bits/stdc++.h>
using namespace std;
int t[17];
int main()
{
    int n,m;
    cin>>n>>m;
    for(int i=0;i<n;i++)
    {
        int a;
        cin>>a;
        t[a]++;
    }
    while(m--)
    {
        int a,b,c,d,e,f;
        cin>>a>>b>>c>>d>>e>>f;
        if(t[7]!=d||t[11]!=e||t[13]!=f)
        {
            cout<<0<<endl;
            continue;
        }
        if(t[10]+t[5]>c||2*t[10]+t[5]<c)
        {
            cout<<0<<endl;
            continue;
        }
        int amin=c-t[10]-t[5];
        if(4*t[12]+2*t[9]+2*t[6]+t[3]<b||t[12]+2*t[9]+t[6]+t[3]>b)
        {
            cout<<0<<endl;
            continue;
        }
        int minn=amin,maxn=amin;
        {
            int over3=b-(t[12]+2*t[9]+t[6]+t[3]);
            maxn+=min(t[6],over3);
            over3=max(0,over3-t[6]);
            if(over3>0)
            {
                maxn+=over3/3*2;
                if(over3%3==2)
                {
                    maxn++;
                }
            }
        }
        {
            int over3=b-2*t[9]-t[3]-t[12]-t[6];
            if(over3>t[12])
            {
                over3-=t[12];
                minn+=over3;
            }
        }
        if((2*t[12]+t[6]+t[10]-minn+t[2]+2*t[4]+4*t[8]<a)||(2*t[12]+t[6]+t[10]-maxn>a))
        {
            cout<<0<<endl;
            continue;
        }
        cout<<1<<endl;
    }
    return 0;
}
```

---


# [THUPC 2025 决赛] 我的围棋

## 题目描述

小 K 和小 S 在下围棋。

小 K 和小 S 在下的并不完全是围棋。

小 K 和小 S 在下的有点像围棋：一方执黑棋一方执白棋，轮流在棋盘上落子，黑方先行。如果有一片相连的棋子没有“气”了，就会被提掉。最终这些棋子由提子一方装到自己的棋盒盖里。具体来说，如果现在执黑棋的小 K 提掉了小 S 的两个白子，他必须将这两个白子装进自己的棋盒盖。

因为蒜协的棋牌室有超强的后勤供应，所以我们可以认为两人都有无限多的棋子可以下。但超强的后勤供应也会百密一疏，两人都有且仅有一个棋盒盖，而棋盒盖的大小是有限的。精通三维最密堆积的小 K 和小 S 在测算后得出，一个棋盒盖里至多能装 $M$ 颗棋子。

基于此，小 K 和小 S 开发出了一套船新的游戏方法，不同于中国传统围棋的排兵布阵攻守兼备，现在二人的策略都是疯狂送子，塞爆对方的棋盒盖。观战的小 Z 觉得非常有趣，于是记下了二人每一步的操作。

根据小 Z 的记载，这局棋二人一共下了 $n$ 手棋，其中第 $i$ 手棋提走了 $a_i$ 颗子。我们认为棋盒盖先装不下自己提走的棋子的人输掉这局棋（此时棋盒盖需要装的棋子应该严格大于 $M$ 颗）。如果棋盒盖溢出的情况在整局中都没有发生，则认为是平局。

现在你需要通过小 Z 的记载判断谁获得了胜利。

小 K 和小 S 都很有体育精神，因此在某人的棋盒盖被塞爆之后，他们不一定会马上结束棋局。

同时，因为这不是正经围棋，所以棋盘上的棋子可能会异常多，在棋局刚开始时也可以提走棋子。

## 说明/提示

### 样例 #1 解释

棋盒盖能装下 $2$ 颗棋子。

首先黑方落子，提走 $1$ 颗棋子，此时黑方棋盒盖里有 $1$ 颗棋子。

第二手白方落子，提走 $2$ 颗棋子，此时白方棋盒盖里有 $2$ 颗棋子。

第三手黑方落子，提走 $2$ 颗棋子，棋盒盖装不下了。所以白方获胜。


### 来源与致谢

来自 THUPC2025（2025 年清华大学学生程序设计竞赛暨高校邀请赛）决赛。感谢 THUSAA 的提供的题目。

数据、题面、标程、题解等请参阅 THUPC 官方仓库 <https://thusaac.com/public>。

## 样例 #1

### 输入

```
4 2
1
2
2
1
```

### 输出

```
White
```

# 题解

## 作者：船酱魔王 (赞：196)

## 题意回顾

黑白双方轮流提子，双方均有一个提子量的上限 $ M $，当提子数超过这个值时，超过的一方会因为棋子盖装不下而被判负。

请你根据双方的提子操作序列（可能有比赛结束后还在下的，即多余的部分）来裁定两方的胜负。**尊重自己，落子无悔。**

序列长度最多 $ 10^5 $，$ 1 \le M \le 10^9 $，每次提子量非负且均不超过 $ 10^9 $。

## 分析

$$ 1 $$

这是啥玩意，我看到后一脸懵，你们都在干啥啊，围棋是这么玩的吗？并且这是不是可以把提走的子扔掉啊，那自毁长城谁不会了，这规则可以钻的空子太大了吧。

当然这并不是出于对这种棋类活动的热爱，只是在和发小玩过一次围棋后感觉这规则有些荒谬就是了。

恍惚间，梦醒了，班主任和往常一样走进班级。

“这学期以下三个选修课因为报名人数过少将不会开班，请报名这些课的人......”

“哎，我报的这种好玩的课应该......”

“科学影像......”

“不是，为啥这玩意停了啊。”我当时差点从座位上蹦了起来。

“清风啊，你都四年级了，还这么不守规矩吗？”老师有些气愤，“实在不行换个课呗。”

翻览课表，只看到 Scratch 编程课人好像很多，“老师，是只有这个课了吗？”

“你就选了呗，大家都觉得挺好玩的。”

笨手笨脚的我并不知道，走上的这条岔路将是我和命运之神的这场盛会中，落下的第一枚棋子......

命运之神提走的，是我的那份兴趣。

$$ 2 $$

“Scratch 真好玩！我要拿电脑编好玩的游戏！”

“那你都把进阶课学完了，你还要学啥啊。”

于是，我的母亲经过一个奥数班的家长推荐，让我报了一个叫什么计蒜客的机构。

看着教材，“怎么都是输入输出屏幕打印这些，好没意思”，我转念一想，“第三本书中的 `string` 是弦的意思，我是不是可以用这玩意演奏歌曲玩呢，先苦后甜我管他呢。”

我提走的，是对于玩乐的期待。

$$ 3 $$

虽然发现了 `string` 是枯燥乏味的字符串，但是我反而对这门在屏幕上打印东西的学问越来越喜欢了。不知道是为什么，我每天回到家一做完作业都想去弄点项目，什么 24 点，什么 2048 之类的......

而虽然不是编游戏，每通过一个练习题，我也乐得自在。

注册了一个叫“洛谷”平台的账号，为了参加一所初中提供的比赛，虽然没啥成绩就是了，依稀记得第三题是个线段树板子。

当时很喜欢进蓝桥杯（青少组而且是年龄比较低的，好像叫啥中级组，可能不见得是啥正经机构）虐场，感觉总是很有成就感。

奥数常年稳定在三等奖的我简历不知道就怎么通过一所不错的初中的审核了，可能是因为这个吧。

命运提走的，是我接下来要有的一番旅途的门票。

$$ 4 $$

肥胖的我并没有发现中考体育的困难，等到暑假再开始训练时已经力不从心了。那个时候，我开始羡慕起那些能贯通的普通高中，担心着自己能不能考上本校，甚至可能滑档到职高......

就在暑假的一次算法训练里，我在模拟赛里拿到了机房 rk3 的成绩，居然切了一道绿题，神奇啊，我怎么会有这么大的长进。

而还记得一个绿鸟头像的人发过一篇博客，博客上说什么提高组一等奖需要切掉一个绿题打点部分分就行，顿时决定为自己的体育成绩（从另一个角度上）搏一把。

还记得，`holiday` 的题意反而很是简洁，我莫名想到类似于 Meet in Middle 的神奇做法，写了，过了大样例，感觉很奇怪。

还记得，`game` 不是一道难题，反而看起来对于会 ST 表的我比上第一题还简单。

还记得，`galaxy` 的 $ 40 $ 分仿若白送......

不顾最后一题没有打完的暴力，$ 240 $ 分，我能做到吗？

一分没挂，我想，我做到了！

我从棋盘上提走几颗金色的棋子，但它们，只有这所每年能出几十个清北的高中的入场券吗？

$$ 5 $$

2023 年省选联考。

第一试，我满怀信心地做完。

第二试，看到第一个题，这不是前几天看过的 P6560 加强版吗？做！

一步步调，一行行写，终究是写了接近 10kb，小样例未过，一分没得。

命运从棋盘上提走我第一个赛季的终结。

$$ 6 $$

直升班的重新分组让因为心智不太成熟而自然而然遭到排挤的我获得了一次社交场上新生的机会。

但是，我真的把握住它了吗？

还记得当时，我做过最荒谬的事情，就是为了一个所谓的「好兄弟」在我停课时说一句「牢清别肘」而赌气一直不停课。

或许，最该拼的时候我没有拼一把，最该死磕大模拟（笔者注：四子棋）的时候我没有写明白，那我都在干什么呢？

我从棋盘上提走一粒披着靓丽外皮的棋子，那是什么呢？社交圈的虚假繁荣？暗藏的个人危机？亦或一份诱惑？

$$ 7 $$

`maze` 没切出来是理应观棋不语的出题人给我的第一次警告，但我忽略了他。我总是以为自己太年轻了，太有机会了。

而我仍然是以一种攻略（宾语是人）为主，玩乐为辅的竞赛态度，还记得在停课室里做过最多的题就是平衡树的板子甚至以此为傲......

命运从棋盘上提走一枚棋子，是那份可怕的执念。

$$ 8 $$

时光终会回到正轨，我遭到了一个「好兄弟」的背刺，而赛前被搞了心态的我在 CSP-S 中拿到了 $ 300 $ 分，而 NOIP 时我执意证明自己而追求 T4，$ O(n \log^3 n) $ 的做法实在是一枚烂棋。

而省选平凡的发挥，两试 $ 128 $ 的成绩，注定是让我走向了末路。

安慰着自己，拿到 D 就不退役，而榜单出来的那时：

「是哭了，还是解脱了？」

我从棋盘上提走最后一枚棋子，似乎是几滴眼泪？

我的盒盖子轰然倒塌。

心中的裁判走来，告诉我，你该结束了......

---

恍惚间，看到了一道有意思的题，感觉曾经在哪里见过。

我信手在题目上写上一句「落子无悔」，补上一句「尊重自己」。

递给了面前那个四年级的小学生。

```cpp
#include <iostream>
#include <cstdio>
#include <algorithm>
using namespace std;
int n, m;
int main() {
	scanf("%d%d", &n, &m);
	int x;
	int odd, even;
	odd = even = 0;
	for(int i = 1; i <= n; i++) {
		scanf("%d", &x);
		if(i % 2 == 1) {
			odd += x;
			if(odd > m) {
				puts("White");
				break;
			}
		} else if(i % 2 == 0) {
			even += x;
			if(even > m) {
				puts("Black");
				break;
			}
		}
	}
	if(max(odd, even) <= m) puts("Draw");
	return 0;
}
```

或许，棋盘上应该有棋子，棋盒里也应该有棋子。

但是，人生如棋盒，如那场荒谬的泡菜国比赛。

本不应该承载的，亦或是本不应该贪恋的，莫要强求。

**愿你在余生中能用有限的棋盒，去给你的对手，致命一击。**

---

## 作者：CarroT1212 (赞：67)

2025 年 3 月 23 日，THUPC2025 决赛如期举行。

你带队凭借过硬的实力，在参与初赛的千支队伍中脱颖而出名列前茅，进入了决赛。

按照惯例，你选择先开 THUPC 的经典整活签到题。不出意外，题目背景是前段时间闹得沸沸扬扬的 LG 杯事件。

你忍着笑意读完了题目。你需要得出黑方和白方哪一边的棋盒盖最先被塞爆。

具备进入决赛水平的你当然可以轻松解决这道入门题。只需要遍历 $a_i$ 过程中维护双方棋盒盖里已有的棋子数，在某一方提完子后检查 TA 的棋盒盖有没有爆，如果爆了就立刻输出对方颜色并结束程序。全程没爆就输出平局。

不到一分钟你就写完了代码。

```cpp
#include <bits/stdc++.h>
using namespace std;
int n,m,c[2];
int main() {
	scanf("%d%d",&n,&m);
	for (int i=1,x;i<=n;i++) {
		scanf("%d",&x),c[i&1]+=x;
		if (c[i&1]>m) return cout<<(i&1?"White":"Black"),0;
	}
	cout<<"Draw";
	return 0;
}
```

你看着 OJ 上绿色的 AC 获得了心态 +1。

然后你选择开 A。你立刻就想到了构造方案，便新建了一个 A.cpp 开始写。

总之，接下来的一段时间，一切都十分平稳。电脑的利用率很高，你和队友的配合也非常顺利，队伍的排名也一直在前列。

直到中途你的队友使用机器时，一位工作人员来到桌前。

因为你们没有在 AC 后把签到题的 .cpp 文件放入回收站，这可能导致比赛工作组赛后处理机器的工作量增加，所以你们队伍被罚了两题。

你非常诧异，因为这根本没有任何道理。

即使有这种规定，为什么你在之前 THUWC 的两天都把所有 .cpp 全部摆在桌面上也没有任何问题。

工作人员对此表示，如果你再拖延时间，现在你们队伍的比赛资格就会立刻被取消。

你非常不解，但是为了队伍的成绩着想，你还是回到座位上继续想题。毕竟之前排名优势相当可观，就算被罚了两题也还有一定的竞争力。

一段时间后你会了 K，便等队友过完 F 后上去写，也顺利地通过了。这次你多了个心眼，把 K.cpp 删除后换上队友，想了一会 E 题之后起身去接水。

你没有想到的是，此时后桌队伍一直低头看题面的一位同学，突然像是下定了某种决心，妖娆地举起了左手，向你们的屏幕指了指，工作人员注意到后，又换右手向你们的屏幕指了指。

于是工作人员再一次来到桌前。

因为你们没有在 AC 后把 K.cpp 编译出的可执行文件放入回收站，这可能导致比赛工作组赛后处理机器的工作量增加，所以你们的队伍现在已经犯规两次，被取消比赛资格。

你的心态非常爆炸。

你在痛恨如此无理的规则被制定的同时，也很后悔为什么当时的自己没有再多长个心眼把 .cpp 和可执行文件全部放进回收站。

正在 B 站观看直播和参加 CF 同步赛的学弟们也为你们打抱不平。

但申诉无果，你们三人只能痛定思痛，争取在接下来的 THUSC 中拿回属于自己的成绩。

（下期预告：THUSC 中有选手因未及时关闭浏览器上已 AC 的题目页面被罚两题，工作人员比赛中途关闭选手电脑进行判罚，选手不服愤然离场！）

---

## 作者：Vct14 (赞：60)

`小 K 和小 S 都很有体育精神，因此在某人的棋盒盖被塞爆之后，他们不一定会马上结束棋局。`

本题主要问题是如何让棋局结束。通过查阅资料可以发现，可以选择在对手离座喝水时举手向裁判举报。那么本题重点在于怎样举手。

仍然是查阅资料，可以发现举手方法如下。代码有点长不太好看，关键部分我放在下面图片了。

```cpp
#include<bits/stdc++.h>
using namespace std;

void jushou(){ // 本题关键
/*
############################################*********=--------:::::*###########=++=+*+++*++*#+=+++##
##############################################***+=+=--=--==--:::::*%##########=++=+#*=+*=+=#==++=##
#####%%%############%#%###################%%#*+=-----=-==--==--::::#%###%#%##%#+*+=*#=+##++*#+=*++%%
#%%#%*++#%%%%%%%%%%###########%%###%%%%%%%#*===-==--------------:::#%%%%%%%%%%%%%####%%#%%%%%%%%##%%
%%%%#-::=%%%%%%%%%%=:--------+%#---#%%%%%+-==-----:::::-::::-----::#%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%*=----+#%%%%%%%%*=+=---===*@%-::#%%%%=:--------:::---++=-::-::-:#%%%%%%%%%%#+%%%#***#%*#***+#%%%#
+=-::-==::-=**#%%%%%%@#-::#%#***-::#%%%*:-----::::::=#*=+****=++-:-#%%%%%%%%%%*-%@%-+%**%=+=+==#@%%#
---=+#%%*+--:::*%%%%%@*:-:*@+.::--:#%%%-:-:::::::+*+#*=+*++*#*+++++#%%%%%%%%%%*-###-+#+-#+++++=#%%#*
*##%%%%%%%##**+#%%%%%#-:-:-##***-::#%%#:::::.::.-*****+**+#**#+*=+#*#%%%%%%%%%#***#%****%%#%#*+#%%##
-----------=====%%%+=::-+-::=*%%-::#%%%-::::-:..=######**##**#***###%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
+++++++++=====-=%%#:-=+#%#+=::%%-:-#%%%*.-+++==:+#########********#%%%%%%%%%%%######################
##*+++++++**#%%%%%%#**##%%%%##%%-::#%%%%=.**+*#++****######***+*##*%%%%%%%%%%%%%%%%%%%%%%%%%%%@%%%%%
-:::-----:::--*%%%%%+::=%%%%%%%%+++#%%%%%=-+*#**********##******##=#%%%%%%%%%%%%%%%%%%%%%%%*******#%
--*%%%%%%%#+-:-#%%%%+::+@%%%%%%%@@@%%%%%%%*::--+**********+****+*+:%%%%%%%%%%%%%%%%%%%%%%%%*+**+--++
::=+*******=::-#%%%%+:-=+++++++++++#%%%%%%@#:  =*++++******##**#*:-%%%%%%%%%%%%%%%%%%%%%%%%%%#*=-+++
=--::::::::--=#%%%%%+:----:---:::::+%%%%%%%%#:.=*+===++******+**-:-%%%%%%%%%%%%%%%%%%%%%%%*====+%%**
%%####***###%%%%%%%%%###############%%%%%%%%#==+*+++======++===-::-%%%%%%%%%%%%%%%%%%%%%%%%#++******
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%++******++++===+::+--:-%%%%%%%%%%%%%%%%%%%%%%%%#++++++++
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%*=+=********++++*= +*-==%%%%%%%%%%%%%%%%%%%%%%%%*--=+++++
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%++*:+******++++++=.+#-=+*###%########%%%%%%%%%%%#=+++++++
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%#*+=#=-****++++++++==*=-====++**+**++*##%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%#***++=:*#==+**++++++++===-=======*+=++==*###%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%#**++++++==:+#+=+++===+++====--======+*+=+*+*###**#######%%%##%%###
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%#**+==========:*+.:=-.-+-=+===+=---=--=-*#****####*=++++*+#+*%%**%%++*
%%%%%%%%%%%%%%%%%%%%%%%%%%%%#++=========--==:+*=-==--+=:=+=++---=-----*#########+======*%%%%%%%%%#%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%=-========--==-=:=*+++++=--==+++=---=---=-=*#######*=-=====+%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%=--=-====--------=****+==-=+++==----=====-:-+*****#*--======#%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%=:---=-===-=------****=+*++++*+=----====-----=+*++*+===--==-*@%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%+::-==-=----------+**+++******=-----===----=-.-+++=======-==+%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%+::-=--=---------:+***++*+***=-----==---=----::==---======--=#%%%%#**%#*
%%%%%%%%%%%%%%%%%%%%%%%%%%%%+-::-=------------=**+*+*++++------=----------:::-------===-:+%%%%#++#*=
%%%%%%%%%%%%%%%%%%%%%%%%%%%%+:-:---------------++++**+**=-----------------:::::-------==-:*%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%=--::--------------++**#++*=----=-:------------:::::--------===%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%#---::-------------:=+**#+++------:-----------:-::::::--------==#%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%#--::::--------------++**++-----::----::::::::::--:::::---------+%%#++##*
%%%%%%%%%%%%%%%%%%%%%%%%%%%*--::::--------------=++*==----:::::::::::::-----:::::::--------=*%%**%**

@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@#*+=-=+====-==---==--:#@@@@@@@@@@@@%@%##%%%%%@%%%@%%%%%%@
-#@%@@@@@@@@@*+*********%@%***%@@@@@@@@@@%*+==-==--:----:------=-#@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
-=%@@@@@@@@@@-:::::::::.*@%-::*@%@@@@@@%+-==---::::::::::.::--::-+%@@@@@@@@@@@@@@@@@@%%@@@@@@%%%@@@@
--=*%@@@@@@@@%##*---=***%@@--:*@%@@@@@@+:--:::::::::-::=**-:.::::.-%@@@@@@@@@%=#@@@*+***@#***+*+%@@@
=-::-=+*#@@@@@@@@--:+@@#+++--:*@@@@@@@*:-:::::::::-+#+=***##+=++=:.=@@@@@@@@@%=%@@#-%@**%*++*+++%@@@
@%*=-:::-@@@@@@@#:---%@=:::--:*@@@@@@%=:::::::.-**##+++*++**#*++*+=-%@@@@@@@@%-*###=*#*-##+**+*=%@@%
%%@%%##**@@@@@@#--:::=%%###--:*@@@@@@%-::......+#***+***=*#*#*+#=++**%@@@@@@@@####%@###%@@%%@#%*@@@%
-:-----=-*@@%+=:::==::-=*@%--:*@%@@@@@-::::...:*###%%###%%#*%#*####*#%@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
+=====---*@@#:--+#@%*=-:-@%--:*@%@@@@@*:=+*+::-%%%%%#%###**####*###%@@@@@@@@@%###%%%%%%%%%%%%%%%%%%%
***##%@@%@@@%###%%@@@@%##@%-::*@%@@@@@@==#++#+=###########**+++####%@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
:::::-=*@@@@@@*--=%@%@@@@@%===#@@@@@@@@%+*#%#############%##***####%@@@@@@@@@@@@@@@@@@@@@@@%######%@
##**+--:*@@@%@+:-=@@@@@@@@@@@@@@@@@@%@@@@*=++=*###########*+++++###@@@@@@@@@@@@@@@@@@@@@@@@*===+==-+
@@@%*--:+@%@@@+:--############%@@@@%%%@@@@+.  =******************#%@@@@@@@@@@@@@@@@@@@@@@@@@@@@%+-=*
---::::=%@@@@@+:::::::::::::::=@@@@%%%%@@#++. -*+=++****####***#*%@@@@@@@@@@@@@@@@@@@@@@@@@*+++==##+
====+*#@@@@@@@*++++++++++++++=*@@@%%%%@@%+++=:-**=====+++***++++-%@@@@@@@@@@@@@@@@@@@@@@@@%*++**#%%#
@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@%%%@%@#+++++***++++====--==--:-%@@@@@@@@@@@@@@@@@@@@@@@@@@*+++++++
@@@@@@@@@@@@@@@@@@@@%%%%%%%%%%%%%%%%%@@%++++++*###****++++++*.+*-#@@@@@@@@@@@@@@@@@@@@@@@@@@*+++++++
@@@@@@@@@@@@@@@@@@@@@%%%%%%%%%%%%%%%%@@*+++++++#######*++****:+#-=*%@@@@@@@@@@@@@@@@@@@@@@@@=--+++++
@@@@@@@@@@@@@@@@@@@@@%%%%%%%%%%%%%%%%@%+++++*=:***##**++***+==*=-==+#%%@@@@@@@@@@@@@@@@@@@@@#*******
@@@@@@@@@@@@@@@@@@@@@%%%%%%%%%%%%%%%%@*+++++**:=****+++++++=++=-=====+++**#%%@@@@@@@@@@@@@@@@@@@@@@@
@@@@@@@@@@@@@@@@@@@%%%%%%%%%%%%%%%%@@#+++**+=%+-++**++++*+++=---======++++***##%%@@@@@@@@@@@@@@@@@@@
@@@@@@@@@@@@@@@@@@@%%%%%%%%%%%%%@@@%#*+**++--##+++*+=+**+===:---=======++++++++***###%%#%#%@@%#@@@%#
@@@@@@@@@@@@@@@@@@@%%%%%%%%%%@@@%#*+++=++==--+..==-+==*+===--=======--======+++++++===++#**%@@*%@@*+
@@@@@@@@@@@@@@@@%%%%%%%%%%%@@%#*++=========--+:::--++--+++=-===============+++++=========*%%%@%%%@#%
@@@@@@@@@@@@@@@%%%%%%%%%%%@%*+===========-=-:*++++===--=*--==========-===========+==-----=%@@@@@@@@@
@@@@@@@@@@@@@@%%%%%%%%%%%%@+-=========------:*****=---=+=-=========--===----====--::--====%@@@@@@@@@
@@@@@@@@@@@@@@%%%%%%%%%%%%%+--===-----------:****=+===*+-========--===----==--::--===----=@@@@@@@@@@
@@@@@@@@@@@@@@%%%%%%%%%%%%@+----------------:+**++*#+**-========--==--:----:--======-----*@@@@@@@@@@
@@@@@@@@@@@@@@%%%%%%%%%%%%@+-:--------------:+*++*****========---=-:::-==--==========---=%@@@@@@@@@@
@@@@@@@@@@@@%%%%%%%%%%%%%%@+-:---------------=*++****=-=-====-----:::-=--====+++========+@@@@@@#++#%
@@@@@@@@@@@@%%%%%%%%%%%%%@%=-:----------------*++**#===-====:---:::--=-:-==++++===------#@@@@@@#**%#
@@@@@@@@@@@@%%%%%%%%%%%%%@#--::---------------*++**+-----=-:---::------=======++=------=@@@@@@@@@@@@
@@@@@@@@@%%%%%%%%%%%%%%%%@+--:.---------------+=*#*=----=-:----------=++++++=-:=+===--=%@@@@@@@@@@@@
@@@@@@@@%%%%%%%%%%%%%%%%@%=--:::-------------:=+**+-----:.--::---=+++*+*++++++-:---=-=%@@@@@@@@%%%@@
@@@@@@@%%%%%%%%%%%%%%%%%@*---:::-------------:=+*+====-::-==+++****+++++++++====---:=%@@@@@@@@@*++##
@@@@@%%%%%%%%%%%%%%%%%%%@+--:::.---------------++=--:=++*****++++==+++=======-==--:=%@@@@@@@@@%%*#%#
@@@@@%%%%%%%%%%%%%%%%%%%%=--:::.:-------------:+####*==+============------:---=-:--%@%@@@@@@@@@@@@@@
@@@%%%%%%%%%%%%%%%%%%%%@#------::-------------+%@@@@@@#=======-----------:::---::-+@@@@@@@@@@@@@@@@@
@@@%%%%%%%%%%%%%%%%%%%%@*:---::.:----------:=#@%%%%%%%#--------------:::::::::::::=****#####%%%%%%%@
@@%%%%%%%%%%%%%%%%%%%%%@+--:::::-::-------=*%%%%%%%%%%- ----------:::::::::::::::-=+++++*+++====++++
@%%%%%%%%%%%%%%%%%%%%%@#+=-:--:::.::::---+%%%%%%%%%%%%: :---::::::::::::::::::::------========-===--
@%%%%%%%%%%%%%%%%%%%%%@#--::....  .:.::-*%#%%%###%%%%#. :-:::::::::::::::::::::------:::::::::------
@%%%%%%%%%%%%%%%%%%%%%@%:.  ..--::....:*%####*######%= .::::::...........::::------------:::::::::::
@%%%%%%%%%%%%%%%%%%%%%%%. .::......  :#%#+*%#####**##..:...............::::::---------::::::::::::::
%%%%%%%%%%%%%%%%%%%%@@@#::-:...... .=%%*=:*%#*#%#=*#+.:.....:::::::::::::::::------:::::::::::::::::
@@@@@@@@@%%%%%@%%%%%%*=----::::...=#%#+-:-*#*=##*-=+-:::::::::::::::::::::::::-----::::::::----:::::
%%#+*#%@@%%%#*#%%%%#+::=------:::+%#=:----:--::--:::::::::::::::::::::::::::::-==+*+++++++++++++++==
********+++++****++=++**#**##*************.--:-:::::::::::::::::::::::::::::::-=====================
#****#*====+=-*#+-====-=#*#***###*#######*--------::::::::::::::::::--::::::..:-------------------::
*/
}

int main(){
	int n,M;cin>>n>>M;int b=0,w=0;
	for(int i=1; i<=n; i++){
		int z;cin>>z;
		if(i%2){
			b+=z;
			if(b>M){
                jushou();
				cout<<"White";
				return 0;
			}
		}
		else{
			w+=z;
			if(w>M){
                jushou();
				cout<<"Black";
				return 0;
			}
		}
	}
	cout<<"Draw";
	return 0;
}
```

![](https://cdn.luogu.com.cn/upload/image_hosting/1qyfjn3n.png)

![](https://cdn.luogu.com.cn/upload/image_hosting/gaf14h07.png)

[记录](https://www.luogu.com.cn/record/212531344)。

---

## 作者：luogu_gza (赞：56)

邦 dream it's 我的围棋！！！！！

题意：你组了一个少女乐队，每个人最多唱 $m$ 遍春日影长崎素世就会把你踢出乐队，你和另外一位乐队成员轮流唱春日影，但是每次并不是只唱一遍，而是唱 $a_i$ 遍，问谁会被先踢出乐队？

啊，我们来看这个题啊。

长崎素世不让你唱春日影，你唱不唱？你说。你死都得唱~那老师我被素食逮着了，乐队解散怎么办？不可能解散。他连严重警告都不是，只是警告你不能再唱了，因为你这不是严重违规孩子，他有等级的！我就唱一首春日影判刑判十年？你就看我告诉你怎么唱，先认真听我再告诉你素食逮着你怎么办。素食第一看到你唱一般会这么说，那个，不准唱了。一定表情很严厉，说不能唱啊，素食说不能唱啊，素食不会一直盯着你啊！一个乐队五个人呢，怎么会一直盯着你啊。素食一低头你还唱不唱？要继续唱！素食第二次逮到我怎么办？我告诉你！第一次逮到你你什么反应，我特别讨厌你说我还没唱呢，比如素食和他说你不要唱了，你不要说我没有唱，素食既然能点名说你不要唱，就说明你唱了，不要狡辩，一定要把嘴巴合上。如果素食第二次逮到你，你放心一定不解散，你放心，绝对不解散。素食更生气了，那个你怎么回事，说了不让你唱，你还唱你再唱，信不信我退队。他说你再唱我就退队了，你千万不要说，我不信，你可不能这么说呀，要说你死惨啊我跟你说。我跟你说，素食说你信不信我不唱了，素食更生气了，我告诉你怎么办，看着我的脸，我给你表演一下。看着素食这样看着他的脸笑，很，尴，尬，的，笑。然后捂着头，上次同学说，老师，我不会尴尬的笑，你会，你会。因为当一个人瞪着眼看着你的时候，你还要笑，都很尴尬，你不用会笑，你看着素食的脸就会很尴尬，这是第二次逮到。如果第三次逮到你，我告诉你加个动作还是笑啊（此处应有素食摆手照片）啊求求你了这不唱了组一辈子乐队，啊啊啊这已经是我第七次办乐队了啊啊啊。

由于你和另外一名乐队成员没有看这篇题解，所以按照正常的方法判定是否被踢出乐队即可，代码就不给了。

---

## 作者：寄风 (赞：38)

你是一个围棋 LG 杯失败退役了的围棋 er。

自从退役之后，你被迫每天在大学里高强度卷文化课。你总觉得失去了最热爱的东西，感觉做什么都没兴趣，每天过得非常沮丧。

终于在有一天凌晨，你在连续卷了二十个小时文化课之后累到晕倒在了桌子上。

不知过了多久，你迷迷糊糊地睁开了眼睛，看到的却是……

-----

你发现自己身处一个完全陌生又无比熟悉的地方。这里是第 29 届 LG 杯世界棋王赛三番棋决赛赛场，你的围棋生涯结束的地方。

你看了一眼电脑上的时间：2025 年 1 月 22 日，上午。三番棋决赛的第二局。

这是……老天又给了你一次机会吗？或者……说只是一场梦？

你当时就是因为第二局被判负才无缘冠军的。赛后你常常想如果重新比一次当时的第二局，说不定你现在已经是围棋九冠王了。

难道说，你的愿望成真了……？

不过既然回到了赛场上，就先看看局势吧。

你熟练地走进赛场，观察棋盘并思考下一步。

对方棋子形势一片大好，你方棋子却已经快毫无反击之力。看起来获胜的唯一方法就是临死反扑。

可是，你的意念中有某种强大的力量阻止你继续往下思考。它完全不受你控制。

它在告诉你，你不需要想这些东西。没必要。

但是你没察觉到任何异常。你甚至没察觉到更恐怖的事情。

你无法回忆起你学过的任何定式或者下棋手法。你无法回忆起一切。你无法回忆起你叫什么名字。

你能回忆起…… 棋盖，或者再具体一点是提子与棋盖。你能回忆起神之一手。九冠王是你向往的目的地，你一定要到达这里。

这不是你的记忆、不是你的思想，甚至……不是你的躯体。

但是这一切你都没察觉到。

你现在唯一的想法只有赢下这一局，这是你夺冠的唯一机会。

但是你的记忆……或者说不知道是谁的记忆……早已支离破碎。你越想下一步怎么下，你就越痛苦。

-----

如果再给你一次机会……

你能逆袭成为冠军吗？

-----

后继：

你越是思考，头便越痛。

朦胧间，你看到了去喝水的对手，你看到了之前的自己拼搏的身影，你看到了在对手棋盖边的几颗棋子，它们像星星一样放在桌子上。

你不想就这么结束。

你举起了手。

看到了急忙赶来的裁判，你欣慰的笑了。

不需要思考下一步了。

手中的棋子跌落在地，一切都结束了。

```cpp
#include <bits/stdc++.h>
using namespace std;
int a[2] , n , m;
string win[2] = {"White" , "Black"};
int main(){
    ios::sync_with_stdio(0);
    cin.tie(0) , cout.tie(0);
    cin >> n >> m;
    for(int i = 1 , fg = 0 , tp;i <= n;i++ , fg ^= 1){
        cin >> tp , a[fg] += tp;
        if(a[fg] > m) return cout << win[fg] , 0;
    }
    cout << "Draw";
}
```

获胜的方法，有时候并不在棋局之内。

---

## 作者：jianhe (赞：30)

## 思路：

棋盒盖先被塞满的会被判负，所以记录一下谁的棋盒盖先被塞满，对手就会获胜。

~~另外不难注意到小 K 是柯洁，小 S 是卞相壹。~~

## 代码：

```cpp
#include<bits/stdc++.h>
using namespace std;
#define ll long long
ll n,m,x,a,b,t;
int main(){
    cin>>n>>m;
    for(int i=1;i<=n;i++){
        cin>>x;
        if(i&1){
            a+=x;
            if(!t&&a>m) t=1;
        }else{
            b+=x;
            if(!t&&b>m) t=2;
        }
    }
    if(t==1) cout<<"White";
    else if(t==2) cout<<"Black";
    else cout<<"Draw";
    return 0;
}
```

## 背景：

![](https://free4.yunpng.top/2025/03/26/67e3b5908f881.gif)

![](https://cdn.luogu.com.cn/upload/image_hosting/g74m5ten.png?x-oss-process=image/resize,m_lfit,h_170,w_225)

#### 《讳输棋》中早有记载：

有自负棋高，与人角，连负三局。次日，人问之曰：“LG 较棋几局？”答曰：“三局。”又问：“胜负何如？”曰：“第一局我不曾赢，第二局他子不放盖，第三局我本要赢，裁判出手罢了。”

### 《北冥有鱼》中早有记载：

北海$^{[1]}$无柯，其因为何？柯之局，不知其千万胜也；化而为豹，其名为捷$^{[2]}$。捷之盘，可谓之惠然璀璨。

怒而进，其志若垂天之云。忿而退，拒外卡以示不屈$^{[3]}$。

常冥$^{[4]}$者，四目$^{[5]}$也。棋协者，志怪者也。

《协》之言曰：规则就是规则，又不是今天定的$^{[6]}$。棋手要有底线思维，要感激有下棋的机会$^{[7]}$。

《协》之未言曰：柯之赛于 LG 也，决胜三比零$^{[8]}$，得冠军而归者卞相壹，胜以神手抬$^{[9]}$者也。

提子也，棋盖也，规则之为卞运筹也。天之苍苍，其正色邪？其远而为众所不见邪？民所呼也，亦若九冠王矣。

（/bx 文言文大师 @[wanggk](https://www.luogu.com.cn/user/252664)）

#### 注释：

[$[1]$](https://sports.sohu.com/20150114/n407779599.shtml) 北海：[北海新绎杯世界围棋公开赛](https://baike.baidu.com/item/北海新绎杯世界围棋公开赛/64342149)。

[$[2]$](https://sports.sina.cn/others/qipai/2015-12-09/detail-ifxmifzc0933282.d.html) 化而为豹，其名为捷：柯洁外号“洁宝”，[谐音捷豹](https://zhidao.baidu.com/question/753562023747919892.html)。

[$[3]$](https://sports.sohu.com/20160105/n433555575.shtml) 拒外卡以示不屈：柯洁 [拒绝最强棋士战外卡](https://www.sohu.com/a/868662516_122006510)、[拒绝北海杯外卡](https://baijiahao.baidu.com/s?id=1826993888254957463)。

[$[4]$](https://www.sohu.com/a/121072087_533159) 常冥：常常闭眼，这里指卞相壹比赛前经常“闭目养神”，见顶部静图。“冥”同“瞑”，闭眼。一说指卞相壹经常下出冥局。

[$[5]$](https://www.thepaper.cn/newsDetail_forward_1923302) 四目：谐音，这里指卞相壹（棋子放棋盖外一次罚两目，两次~~四目~~判负）。

[$[6]$](https://sports.sina.cn/others/qipai/2018-12-05/detail-ihprknvt2012238.d.html) 规则就是规则，又不是今天定的：[棋协直播间发言](https://www.zhihu.com/question/10377356434)。

[$[7]$](https://news.sina.com.cn/c/2019-01-17/doc-ihqhqcis7077268.shtml) 棋手要有底线思维，要感激有下棋的机会：[新人王赛棋协主席常昊寄语](https://www.nfnews.com/content/n61z7apkoP.html)。

[$[8]$](http://qipai.people.com.cn/n1/2020/1103/c47625-31917471.html) 柯之赛于 LG 也，决胜三比零：可见 [此](https://baijiahao.baidu.com/s?id=1822024901381146747)。

[$[9]$](https://www.msn.cn/zh-cn/sports/通用/柯洁成就-九冠王-他从未屈服一直在战斗-拿到战胜邪恶的冠军/ar-AA1xIUkL) 胜以神手抬：可见顶部动图。

~~注意到上面注释的数字是可以点的了吗。~~

### 来看看其他棋手是怎么做的

应氏杯柯洁忘记按钟了，对手一力辽提醒他按。

应氏杯一力辽快超时了，对手许嘉阳直接投子，不屑于超时胜。

申真谞对面手滑下歪了，申真谞给他放回去。

柯洁碰到申真谞手滑了，让申真谞放回去。(之前滑标也是一直没下，问了裁判不能悔棋才继续)

朴廷桓之前有填子黑料，但是之后碰到柯洁手滑放歪了，也让他放回去了。

三星杯决赛丁浩和党毅飞，党毅飞和连笑打劫打昏了，忘记有没有提劫直接问对方就行了。(围甲也有类似情况)

古力和李世石都在对面上厕所离场时不落子，等对方回来才下棋。

陈耀烨碰到对手滑标，主动申请让对方悔棋。

（$\downarrow$ LG 杯后）

芮乃伟想把棋子放棋盖里结果超时了，武宫正树继续落子。

李轩豪棋子没放棋盖内，朴廷桓提醒他放进去。

正常棋手都不屑于靠规则赢。

### 来看看大卞 LG 杯之后在韩国围棋甲级联赛中的战绩

|日期|等级分|黑白|胜负|对手|等级分|$\Delta$|备注|
|:-:|:-:|:-:|:-:|:-:|:-:|:-:|:-:|
|2025-01-26|3585|执白|$\color{red}{负}$|朴珉奎|3435|$\color{red}{149}$|黑领先2**4目**|
|2025-02-15|3583|执黑|$\color{red}{负}$|琴沚玗|3318|$\color{red}{265}$|23个子，6**4目**大龙死掉|
|2025-02-22|3583|执黑|$\color{red}{负}$|李志贤|3563|$\color{red}{20}$|**4**3个子，百**目**大龙死掉|
|2025-03-02|3583|执白|$\color{red}{负}$|元晟溱|3500|$\color{red}{83}$|38个子，7**4目**的大龙死掉|
|2025-03-08|3582|执黑|胜|许皓鋐|	3577|5|对手勺子|
|2025-03-14|3582|执白|$\color{red}{负}$|申旻埈|3535|$\color{red}{47}$|负2.5目|
|2025-03-20|3582|执白|$\color{red}{负}$|韩友赈|3478|$\color{red}{104}$|负3.5目|
|2025-04-03|3582|执黑|$\color{red}{负}$|朴珉奎|3435|$\color{red}{147}$|中盘认输|

---

## 作者：Petit_Souris (赞：28)

一种可能的赛时做法。

注意到比赛过程中我们不能离开机位接水，因此需要利用主办方提供的饮用水。

首先点击番茄 OJ 上的举手按钮，获取一瓶饮用水。

此时工作人员会走过来处理你的请求，这时候让你的队友开始看题，工作人员没空盯着你队友有没有违规。如果工作人员处理完你的请求后跑路了，等其回到裁判室后再次举手，并让队友写代码。

这种神之举手的策略固然是有效的，但是一定要注意，不能让其他队伍找到机会，举报你喝完水之后瓶盖没扔垃圾桶里。

这样应该就可以在开赛后 eps 秒内通过这题了。

---

## 作者：_lmh_ (赞：27)

首先把题意转化一下，就是说，我们要构造一个可能的棋局，然后模拟下棋的过程直到一方的棋盖装不下为止。

构造棋局是简单的——假设现在下的这一步要吃 $k$ 颗棋子，那么在棋盘上找一块足够大的空位（不妨假设棋盘无限大）把这些棋子放下来即可，为了节省棋子我们尽可能让它堆成正方形。

但是还有个小问题：每一步的 $a_i$ 实在太大了，无法存下所有棋子。因此我们必须把每个棋子的连通块转化成几个矩形的不交并的形式。

放完这些棋子之后，需要在旁边放一些异色的棋子把它围起来直到只剩一个空，这一步是简单的。

现在我们考虑下一步棋之后会发生什么。首先把它和与它相邻的棋子放进同一个连通块内（用并查集维护），然后我们需要判断有没有棋子被吃。

发现一步棋只会改变周围四个位置所在连通块的“气”，所以可以记录每个连通块的“气”的数量然后暴力修改。

我们先考虑周围的（异色）连通块是否被吃。如果它被吃了，那么需要把它删掉，这些棋子现在就被**拿在手上**。同时，开一个 `vector` 维护和它相邻的连通块和相邻的边数，删除时暴力修改周围所有的“气”即可。此时的“气”数量单调不增，所以不会出问题。

之后需要特判一种情况：放下棋子之后自己所在的位置被吃了，这样需要抛出异常。

同时，如果对方进行了一次打劫，那下一次不能当场吃回来。因此我们需要记录上一次落子的位置，如果**它所在的连通块恰好只有一颗棋子并且它上一次恰好吃掉了一颗棋子**那么不能立马吃回去。

现在我们可以维护棋局了，分析一下它的复杂度。

首先一开始构建的时候，可以保证只有 $O(n)$ 个矩形——这是简单的。

定义势能函数为相邻的异色连通块的对数，一开始构造的时候也可以做到 $O(n)$。

每一步最多使势能 $+4$，修改气的代价为 $O(1)$，维护连通性的代价为 $O(\alpha (n)))$，一个块被吃掉的时候，暴力修改相邻块的气时，每个 $O(1)$ 的修改消耗 $1$ 点势能，而总势能是 $O(n)$ 的。

然后你发现维护所有相邻的矩形这个东西很不好做，考虑把操作离线下来（在线也可以用二维线段树做到 $O(n\log^2 n)$ 但过不了一点），先考虑横向相邻再考虑纵向相邻。那么肯定是把所有点按照纵坐标排序然后做扫描线，只需要在每个矩形加入和删除的时候查询相邻的位置即可。

在每个位置上开一个 `set` 维护当前位置的矩形，不难发现每次只需要修改左端点和右端点，中间的位置是没用的。

这里有一个细节：如果出现劫争，那么打劫的位置可能会把预处理时相邻的矩形对数卡到 $O(n^2)$，因此需要精细的实现去掉不可能同时出现的矩形对。

总复杂度是 $O(n\log n)$ 的。（如果你觉得复杂度假了的话，考虑一下这条性质：如果一个位置在整个棋局中被不止一个矩形覆盖，那么只有第一个矩形的大小可能 $>1\times 1$。）

现在还不够，注意到我们吃掉的棋子还拿在手上，因此我们需要让棋手把棋子放进盒盖里。

显然我们需要维护三个东西：盒盖，桌面，以及棋钟。一个正确的提子流程是先把棋子放进盒盖里，然后按下棋钟。如果放不下棋子，那么就需要把多余的放在桌面上——这样最后对方举手，他就输了比赛。

桌面也可以视为无限大的二维平面。为了保证棋盘和桌面不发生穿模，必须限制棋盘的一个维度——这样只需对前面的东西进行一些小修改即可，并不困难。你也可以取宽度 $W=\max\{a_i\}+O(1)$，就没有问题了。

在桌面放下棋子时可以用上述的方法维护一个矩形。而为了提高空间利用率，棋盖是三维的。

把棋盖抽象成一棵树，它有 $M$ 个节点，每次放棋子时棋子从根节点进入，选择一条路径尽可能往下滑，最后停止。这等价于：每次把棋放在根节点，然后选择一条路径往下推一格。

进一步对其进行抽象，我们认为这是一个从上到下放满整棵树的方案，第一次必须放根节点，后面每一步放的节点的父亲必须在它之前被占据。

现在我们令一个大小为 $K$ 的树按照如下方式构造：

如果 $K=1$，则直接返回只有一个节点的树；

如果 $K=2$，直接返回一个只有根节点和其右儿子的树；

否则，新建一个节点，其左儿子递归构造 $\lfloor\frac{K-1}{2}\rfloor$ 大小的树，右儿子递归构造 $\lceil\frac{K-1}{2}\rceil$ 大小的树，返回这棵树。

这样，每一层（即深度相同）的树的大小极差为 $1$，也就是最多只有两种形态。

对树进行重链剖分，我们优先让棋子放在重儿子上。维护可行的重链的集合（不需要使用堆，队列即可），每次尽可能放满一条重链，放满之后把和它相邻的链也设为可行的重链。

然而重链的总数是 $O(M)$ 的，无法接受。

现在我们取一个阈值 $B$，将最浅的大小全部 $\le B$ 的一层拉出来，这一层的树至多有两种形态；对于每一种形态（设其大小为 $S$），用 $O(S^2)$ 求出这里面放了 $k=1...S$ 个节点时的状态（是否被放满，节点放置的方式）。这一步的复杂度是 $O(B^2)$ 的。

对这样的东西进行缩点，这样树就只剩下了 $O(\frac{M}{B})$ 个节点，维护重链的复杂度就变成了 $O(n+\frac{M}{B})$。

平衡复杂度，令 $B=\sqrt[3]M$，总复杂度为 $O(n+M^\frac{2}{3})$。

最后按下棋钟，轮到对方继续棋局。

把这几个部分组合在一起，总复杂度 $O(n\log n+M^\frac{2}{3})$。

代码我没写。注意这道题细节非常多，很容易让复杂度像下面这份代码一样进化到 $O(n)$。

```cpp
#include<bits/stdc++.h>
using namespace std;
#define ll long long
ll n,m,s0,s1,a;
int main(){
	cin>>n>>m;
	for (int i=1;i<=n;++i){
		cin>>a;
		if (i&1){
			if ((s1+=a)>m){
				cout<<"White\n";return 0;
			}
		}
		else if ((s0+=a)>m){
			cout<<"Black\n";return 0;
		}
	}
	cout<<"Draw\n";
	return 0;
}
```

---

## 作者：AmaoFox (赞：26)

> 已深度思考（用时 0 秒）

服务器繁忙，请稍后再试。

盯着这行字，忽然觉得它竟如此贴切——我的 OI。也是被某人思考 0 秒搞垮的。

我想 gza 了。我记得，我曾经应该和 gza 在 THUPC 决赛见了面。

可是收到过算协的邮件，说团队中有成员涉嫌作弊，代码高度相似。去年的时候也被判了作弊，兴许运气差。也许，也许是搞错了，不过不妨看一下。看到另一队也是我们学校的，瞬间警觉起来。

半夜十一点钟给 luqyou 发了五个窗口抖动。表示也受到了，但是没有什么头许。于是目光转向了 tm0。

也许，也许是他们五个人在机房看着没有什么必要藏着掖着了吧，于是他们开始交流做法了。也许，是觉得时间差不多了吧，开始分享代码了。

只是很佩服 tm0 的勇气，只有 10 分钟了，连 Alt+Shift+F 都不按一下就交上去了。

教练说还有下次。可我知道 OI 路上哪有那么多下次。高一没打 THUPC，被禁赛一年，高二自然不打算打了。tm0 美其名曰一拖五，然这五人里面有我一个高一的，他们剩下的全是初三的，倒是不干扰。机房里的冷气开得极足，吹得我手指发僵，感冒了。真的，我现在的确感冒了。

数月前，也曾这样意气风发地切题，乒乓球赛，检查站，骑行计划。

现在倒成了 gza 单方面的凯旋。虽然，虽然他说他是被带飞吧，也许。但是我是带飞别人的那个，结果被别人拉在地上摔了个倒栽葱。

作弊者终会现形，可陪葬的又何止一人。这大约就是组队的残酷之处：一个人的调皮捣蛋，足以让两个队伍归零。我的 THUPC 之路，终究停在了某人的深度思考 0 秒处。

也许，也许还有 THUSC，也许还有 WC。但是只想穿越回去，找两个更单纯的人组队。不，不。我们都太不单纯了，我们都是利己主义者，就连我也是一样的。

我也是一个作弊者，只是我没有在比赛中作弊。

为了杜绝作弊，我拿来了三台打字机，我们把代码打出来，然后邮寄给算协进行评分。

``` cpp
??=include"bits/stdc++.h"
using namespace std;
signed main()??<
int n,m,x=0,y=0;
cin>>n>>m;
for(int i=1;i<=n;i++)??<
int a;
cin>>a;
if(i bitand 1)??<
x+=a;
??>else??<
y+=a;
??>
if(x>m)??<
cout<<"White";
return 0;
??>else if(y>m)??<
cout<<"Black";
return 0;
??>
??>
cout<<"Draw";
??>
```

相比起来，即使这台打字机上的键只有那么点（比如他没有 `&` 和 `[]` 之类的键），对于我来说也足够了。至少这台打字机并不会卡，而在写这篇题解的时候电脑已经卡得重启四次了。

原来我记错了，我们没有邮寄这份代码，我们被禁赛了，我没有和 gza 在 THUPC 见过。只有打字机是真的有。

我想你了，gza。

---

## 作者：mc_xiexie (赞：25)

今天，我决定要进行一项之前从未有人达成过的挑战。

围棋创办已经 $4000$ 年时间了，而LG杯世界围棋棋王战是围棋举办的最有影响力的世界棋战之一。

![](https://cdn.luogu.com.cn/upload/image_hosting/idnh39nc.png)

是时候有人来在患有健忘症的情况下参加LG杯世界围棋棋王战了，并拿到**冠军**了。

这真的可能吗？真的能被完成吗？

但就在这一刻，我意识到了一些东西。

LG杯世界围棋棋王战创办已经 $4000$ 年时间了，而围棋是LG杯世界围棋棋王战举办的最初级的认证。

![](https://cdn.luogu.com.cn/upload/image_hosting/llc8nz5u.png)

我能在患有健忘症的情况下参加LG杯世界围棋棋王战，并拿到**冠军**吗？

参加LG杯世界围棋棋王战的第一件事，我开始打比赛，用了送子和举手，这样我才能打败对手。

![](https://pic.rmb.bdstatic.com/bjh/cms/250123/ff53f2cab1aaf4feaead3535dda0141d_1737625688.6856_433.png)

但就在这个时候，我发现了一个问题。

我能在患有健忘症的情况下参加LG杯世界围棋棋王战，并拿到**冠军**吗？

这真的可能吗？

今天，我决定要进行一项之前从未有人达成过的挑战。

我创办已经 $4000$ 年时间了，我能得痴呆症吗？我知道这有点难，但我必须完成这项挑战。

我先用送子和举手拿到了两目，首先我要打开棋盒，因为在下棋的过程中，肯定会使用棋盒，所以打开棋盒才是最重要的。

看到没有，那里有棋盒。

我先打开棋盒，不然不一定下的了棋。打开棋盒之后，我先用棋子下了一步，不知道为什么，桌面上有两个棋盒。

所以是时候有人在患有健忘症的情况下参加参加LG杯世界围棋棋王战，并拿到**冠军**了。

这真的可能吗？这真的能被完成吗？

今天，我决定要进行一项之前从未有人达成过的挑战。

我已经得痴呆症 $1$ 年时间了，我能在患有健忘症的情况下参加这种认证，并拿到**四千名**吗？

如果我要打败对手，首先我要打开棋盒，不然不一定下的了棋。打开棋盒之后，我用棋子下了一步，最后打开了棋盒。

要知道要下棋，首先我们要打开棋盒，所以我准备打开棋盒，不过还有一个问题。

棋盒创办已经 $4000$ 年时间了，是时候有人用痴呆症认证 $1$ 年了。

这真的可能吗？这真的能被完成吗？

今天，我决定要进行一项之前从未有人达成过的挑战。

我能在患有健忘症的情况下，打开棋盒吗？

说实话我已经有点意识模糊了，我下棋两分半之后，我的桌面上多了好多个打开的棋盒，我根本就不知道哪来的。

所以明天我将要进行一项之前从未有人达成过的挑战。我能在患有棋盒，认证下棋吗。


```
#include<bits/stdc++.h>
#define kejie "White"
#define put_up "Black"
#define put_up_too "Draw"
using namespace std;
int main(){
    int n,m,KeJie=0,ByunSangil=0,cut=0;
    cin>>n>>m;
    while(n--){
        int x;
        cin>>x;
        if(cut%2==0){
            KeJie+=x;
            if(KeJie>m){
                cout<<kejie;
                return 0;
            }
        }
        else{
            ByunSangil+=x;
            if(ByunSangil>m){
                cout<<put_up;
                return 0;
            }
        }
    }
    cout<<put_up_too;
}
```

---

## 作者：Helenty (赞：20)

~~本题解不整活，因为作者没实力。~~

好吧，还是整一下：

众所周知，围棋，别名弈、碁等，国际通行棋种，世界上最古老的棋类游戏之一，是具有高度文化色彩的智力竞技项目，流行于中国、日本、韩国等东亚国家。是中华民族发明的迄今最久远、最复杂的智力博弈活动之一。

围棋是一种策略性二人棋类游戏，使用格状棋盘及黑白二色棋子进行对弈，对局双方在棋盘的交叉点上轮流下子，每次只能下一子，落子后不能移动，终局时以目数多者为胜。因黑方有先手优势，故规定局终时黑方要贴目给白方。

中日韩等不同国家制定的竞赛规则略有不同。围棋棋理博大精深，蕴含着中华文化的丰富内涵，被列为“琴棋书画”四大文化之一，是中国文化与文明的体现。2008 年，入选中国《国家级非物质文化遗产代表性项目名录》。

围棋起源于中国古代，南北朝时经朝鲜半岛传入日本，流传到欧美各国。1949 年，中华人民共和国成立以后，围棋被列为体育竞赛项目，并于 1957 年起举行全国性的围棋锦标赛。1988 年，富士通杯和应氏杯两项世界职业围棋锦标赛相继开赛，世界围棋进入了一个新时代。长期以来，围棋一直被看作是艺术、文化，而非竞技体育项目。直到 2010 年广州亚运会，围棋才首次成为亚运会正式比赛项目。

围棋的世界性组织为国际围棋联盟，该组织成立于 1982 年。中国围棋的最高管理机构为中国围棋协会。主要赛事有：富士通杯世界围棋锦标赛、天府杯世界职业围棋锦标赛、三星杯世界围棋公开赛等。代表人物有：麦克雷蒙、金恩持、吴依铭、仲邑堇等。

> 以上内容来自[百度百科](https://baike.baidu.com/item/%E5%9B%B4%E6%A3%8B/111288)。


所以，当你阅读完以上文字后，就会发现：~~以上文字对解题没有任何帮助。~~

然后你就可以做出来这题了。

代码：


```cpp
#include <bits/stdc++.h>
using namespace std; 

int n, m, t, white, black;

int main()
{
    cin >> n >> m; 
    for (int i = 1; i <= n; i++)
    {
        cin >> t;
        if (i % 2 == 1) white += t;
        else black += t;
        if (white > m)
		{
            cout << "White" << endl;
            return 0;
        }
        if(black > m)
		{
            cout << "Black" << endl;
            return 0;
        }
    }
    cout << "Draw" << endl;
    return 0;
}
```

AI 码风：


```cpp
#include <bits/stdc++.h>
using namespace std;

int n, m, t, white, black;

int main()
{
    cin >> n >> m;
    for (int i = 1; i <= n; i++)
    {
        cin >> t;
        if (i % 2 == 1)
            white += t;
        else
            black += t;

        if (white > m)
        {
            cout << "White" << endl;
            return 0;
        }

        if (black > m)
        {
            cout << "Black" << endl;
            return 0;
        }
    }

    cout << "Draw" << endl;
    return 0;
}
```

显然，本题解没有结束。

历年 THUPC 整活题目大赏：

- [P8423 [THUPC 2022 决赛] 想象](https://www.luogu.com.cn/problem/P8423)
- [P9145 [THUPC 2023 初赛] 世界杯](https://www.luogu.com.cn/problem/P9145)
- [P11532 [THUPC 2025 初赛] 好成绩](https://www.luogu.com.cn/problem/P11532)
- [P9389 [THUPC 2023 决赛] 烂柯杯](https://www.luogu.com.cn/problem/P9389)
- [P9973 [THUPC 2024 初赛] 你说得对，但是 AIGC](https://www.luogu.com.cn/problem/P9973)
- [P10552 [THUPC 2024 决赛] 警钟长鸣](https://www.luogu.com.cn/problem/P10552)
- [P11532 [THUPC 2025 初赛] 好成绩](https://www.luogu.com.cn/problem/P11532)
- [P12063 [THUPC 2025 决赛] 我的围棋](https://www.luogu.com.cn/problem/P12063)

---

## 作者：MoonCake2011 (赞：18)

## 解法 1

首先，题目名字是我的围棋，不难联想到我的世界大电影。

然后，可以理解为你和你朋友去看电影，电影有 $n$ 秒，每秒有 $a_i$ 坨屎。

为了预防电影的屎，你们准备一人看一秒，出了影院再拼凑成完整剧情。

但是当电影有 $M$ 坨屎进入了你的眼睛，你就会红温，然后出影院。

如果最终，你们都没有红温，就可以 Draw 出整个电影。

因为 technoblade never dies，所以我没有红温。

但是因为其他剧情太史了，特别是女教导主任与傻子村民谈恋爱，所以我不给代码了。

## 解法 2

首先，看到我的，所以我想起了我的 florr 号被偷了。

于是我帮别人代打，又看见了 $M$ 字，可以联想到 Mythic。

而那个人请了两个代打，一个是我。

所以说我们的代打会交替进行。

如果其中一个人核爆了 $M$ 张 Mythic。

那么号主就会红温，并且踢掉那个代打。

否则，我们可以和平相处。

因为我 florr 号没了，所以不给代码了。

广告一：谁知道谁绑了我的 florr 号的 apple 吗？我号没了。

广告二：有人帮我新号代打吗？

---

## 作者：未来姚班zyl (赞：14)

用两个变量记录过程中提子的总数即可。

注意千万不要在其中一方的棋盖中的棋子数 $>M$ 时就立刻输出答案，一定趁着对手接水的时候向裁判举报。

我围棋下得太烂了，大家可能还是不会这道题。如果有问题就问围棋**世界冠军** [ByunSangil](https://codeforces.com/profile/ByunSangil) 吧。

```cpp
#include<bits/stdc++.h>
#define ll long long
#define int ll
#define rep(x,y,z) for(int x=(y);x<=(z);x++)
#define per(x,y,z) for(int x=(y);x>=(z);x--)
#define repn(x) rep(x,1,n)
#define repm(x) rep(x,1,m)
inline int read(){int s=0,w=1;char c=getchar();while(c<48||c>57) {if(c=='-') w=-1;c=getchar();}while(c>=48&&c<=57)s=(s<<1)+(s<<3)+c-48,c=getchar();return s*w;}
inline void pf(int x){if(x<0) putchar('-'),x=-x;if(x>9)pf(x/10);putchar(x%10+48);}
using namespace std;
const int N=5e5+5,M=1e7+5,inf=(1LL<<31)-1,mod=998244353;
const ll llf=1e18;
int n,m,a[N],A,B;
inline void Main(){
	n=read(),m=read();
	int fl=-1;
	repn(i){
		a[i]=read();
		if(i&1)A+=a[i];
		else B+=a[i];
		if(A>m){
			if(fl==-1)fl=0;
		}
		if(B>m){
			if(fl==-1)fl=1;
		}
	}
	if(fl==1)cout <<"Black";
	else if(fl==0)cout <<"White";
	else puts("Draw");
}
signed main(){
	int T=1;
	while(T--)Main();
	return 0;
}

```

---

## 作者：cff_0102 (赞：13)

Stop learning useless algorithms, go and solve some problems, learn how to use binary search.

注意到如果分出胜负，一定存在一个时刻恰有一方的棋子数量 $>M$，且通过这个时刻就能得知获胜的一方。

二分查找即可。如果此时双方棋子数量都 $\le M$ 则继续二分后面的区域，如果此时双方棋子数量都 $>M$ 则继续二分前面的区域。

```python
n, M = map(int, input().split())
a = [int(input()) for _ in range(n)]

def ans(l, r):
    if l > r: 
        return "Draw"
    
    mid = (l + r) // 2
    W = sum(a[i] for i in range(0, mid+1, 2)) > M
    B = sum(a[i] for i in range(1, mid+1, 2)) > M
    
    if W and not B: 
        return "White"
    if B and not W: 
        return "Black"
    if B and W:
        return ans(l, mid-1)
    if not B and not W:
        return ans(mid+1, r)

print(ans(0, n-1))
```

最坏时间复杂度 $O(n\log n)$，目前位于最优解第一页。

---

## 作者：LionBlaze (赞：12)

> - 诶？？？
> - 能过。

首先我们知道 $n \le 10^5$。我们考虑 $\mathcal O(n \log n)$ 的做法。

考虑二分。每次判断如果都没有输就在右半部分搜索，如果都输了就在左半部分搜索，否则直接停止。

根据[等比数列求和公式](https://www.luogu.com/article/dx3vl9lm)，时间复杂度为 $\Theta(n)$，时间复杂度不为 $\omega(n)$。

考虑在线做法。

维护两棵动态开点的线段树，每次如果在某人的棋盒上添加 $x$ 个棋子时，就把线段树维护的区间的 ID 在 $[r,r+x)$ 之内的元素统统 $+1$，其中 $r$ 是 $[1,10^9]$ 的随机数。

那么每次区间求和查询即可。

时间复杂度 $\mathcal O(n \log n)$，对于 $n \le 10^5$ 能过。

应要求补充代码。

```cpp
#include <bit>
#include <cmath>
#include <cstdio>
#include <random>
#include <chrono>
#include <cstdlib>
#include <iostream>
#include <algorithm>

using namespace std;

// 线段/区间
template<typename T>
class segment
{
public:
	T l, r; // [l, r)
	size_t size() { return r - l; } // 长度
	bool fail() { return l >= r; } // 是否不合规
	template<typename Han_Si_Ying>
	friend bool operator==(const segment<Han_Si_Ying>& x, const segment<Han_Si_Ying>& y) { return x.l == y.l && x.r == y.r; } // Han_Si_Ying：？
};

// 区间交
template<typename T>
segment<T> seg_and(segment<T> l1, segment<T> l2)
{
	return { max(l1.l, l2.l), min(l1.r, l2.r) };
}

template<typename _Valt>
class segtree
{
	class segnode
	{
		segment<size_t> seg; // 负责区间
		_Valt s, tag; // S, lazytag
		segnode* lp = nullptr, * rp = nullptr; // 左右子树
	public:
		segnode(segment<size_t> _seg = { 0,0 }, _Valt _s = _Valt(), _Valt _tag = _Valt(), segnode* _lp = nullptr, segnode* _rp = nullptr) { seg = _seg; s = _s; tag = _tag; lp = _lp; rp = _rp; }
		segment<size_t>& getseg() { return seg; }
		_Valt& gets() { return s; }
		_Valt& gettag() { return tag; }
		segnode *getlp()
		{
			if (lp != nullptr || seg.size() == 1) return lp;
			else
			{
				size_t l = seg.l;
				size_t r = (seg.l + seg.r) >> 1;
#ifdef L7W_AB
				printf("build left child of [%d, %d), child = [%d, %d).\n", seg.l, seg.r, l, r);
#endif
				return lp = new segnode({ {l, r}, static_cast<_Valt>(s / seg.size() * (r - l)), _Valt(), nullptr, nullptr });
			}
		}
		segnode* getrp()
		{
			if (rp != nullptr || seg.size() == 1) return rp;
			else
			{
				size_t l = (seg.l + seg.r) >> 1;
				size_t r = seg.r;
#ifdef L7W_AB
				printf("build right child of [%d, %d), child = [%d, %d).\n", seg.l, seg.r, l, r);
#endif
				return rp = new segnode({ {l, r}, static_cast<_Valt>(s / seg.size() * (r - l)), _Valt(), nullptr, nullptr });
			}
		}
		void pushdown() // 下放标记
		{
			s += tag * seg.size();
			if (getlp()) lp->tag += tag;
			if (getrp()) rp->tag += tag;
			tag = 0;
		}
	};
	segnode* rt;
	// void init(segnode* root, size_t l, size_t r) // 初始化
	// {
	// 	root->seg = { l, r };
	// 	root->s = root->tag = _Valt();
	// 	if (l + 1 == r) return;
	// 	else
	// 	{
	// 		init(root->lp = new segnode, l, (l + r) >> 1);
	// 		init(root->rp = new segnode, (l + r) >> 1, r);
	// 	}
	// }
	_Valt inn_query(segnode* root, segment<size_t> seg) // 区间查询
	{
		root->pushdown(); // 下放懒标记
		if (root->getseg() == seg) return root->gets();
		segment<size_t> segl = seg_and(root->getlp()->getseg(), seg),
			segr = seg_and(root->getrp()->getseg(), seg); // 区间交
		_Valt sum = 0; // 和
		if (!segl.fail()) sum += inn_query(root->getlp(), segl);
		if (!segr.fail()) sum += inn_query(root->getrp(), segr);
		return sum;
	}
	void inn_add(segnode* root, segment<size_t> seg, _Valt val) // 区间修改
	{
#ifdef L7W_AB
		printf("call seg_and on [%d, %d), root = [%d, %d)\n", seg.l, seg.r, root->getseg().l, root->getseg().r);
#endif
		root->pushdown();
		if (root->getseg() == seg)
		{
			root->gettag() += val;
			return;
		}
		root->gets() += val * seg.size();
		segment<size_t> segl = seg_and(root->getlp()->getseg(), seg),
			segr = seg_and(root->getrp()->getseg(), seg);
		if (!segr.fail()) inn_add(root->getrp(), segr, val);
		if (!segl.fail()) inn_add(root->getlp(), segl, val);
	}
public:
	segtree(size_t sz)
	{
		rt = new segnode({ { 0, sz }, 0, 0, nullptr, nullptr });
		// 动态开点，只需要建一个根节点即可
		// init(rt, 0, sz);
	}
	_Valt query(size_t l, size_t r)
	{
		return inn_query(rt, { l, r + 1 });
	}
	void add(size_t l, size_t r, _Valt x)
	{
		inn_add(rt, { l, r + 1 }, x);
	}
};

int main()
{
	srand(time(NULL));
	random_device rd;
	// 好随机啊...
	mt19937_64 mt(rd() + chrono::high_resolution_clock::now().time_since_epoch().count() + rand() * rand());
	uniform_int_distribution<int> um(1, 1000000000);
	segtree<int> sg1(2000000005);
	segtree<int> sg2(2000000005);
	int n, m;
	scanf("%d%d", &n, &m);
	for (int i = 1; i <= n; i++)
	{
		int a;
		scanf("%d", &a);
		int v = um(rd);
		if (i & 1) sg1.add(v, v + a - 1, 1);
		else sg2.add(v, v + a - 1, 1);
		if (sg1.query(1, 2000000000) > m)
		{
			printf("White\n");
			return 0;
		}
		if (sg2.query(1, 2000000000) > m)
		{
			printf("Black\n");
			return 0;
		}
	}
	printf("Draw\n");
	return 0;
}
```

[AC 记录](https://www.luogu.com.cn/record/212577849)。

后记：

> Warning：可能含有虚假/推测的/未经证实的信息，请谨慎甄别。

首先解释一下为什么要 $\omega(n)$ 的算法。

可能有读者不知道什么是 $\omega(n)$（毕竟时间复杂度中不常用），就是不满足 $\mathcal O(n)$。注意不要把 $\mathcal O(n)$ 和 $\Theta(n)$ 混淆，后者是同时满足 $\mathcal O(n)$ 和 $\Omega(n)$（不要和 $\omega(n)$ 混淆）的意思。

因为 $1 \le n \le 10^5$，所以如果我们使用线性或更快的做法（即 $\mathcal O(n)$ 做法）出题人会因为被爆标而感到不高兴。

为什么会被爆标？如果标程是 $\mathcal O(n)$ 的，那么数据范围肯定会比 $10^5$ 大，但实际上并没有，所以标程时间复杂度应当为 $\omega(n)$。

如果出题人不高兴，你可能会因为没有及时清除上一位整活人带来的[宇宙射线](https://www.luogu.com.cn/record/213110949)而导致 CE。

综上，我们必须使用 $\omega(n)$ 的做法。

再解释一下为什么一道难度为普及-的题目我会使用普及+/提高的做法（动态开点线段树）。

因为普及-和普及+/提高的最长公共子段的长度是普及-的超过 $\dfrac{1279873}{1919810}$，所以我看花了，看成了后者。

最后我把考虑劣化四个字删掉了，改成了时间复杂度，因为从前者中看不出什么东西来。

---

## 作者：XiaoYang_awa (赞：8)

# [P12063 [THUPC 2025 决赛] 我的围棋](https://www.luogu.com.cn/problem/P12063)

准备安放棋子吧哈哈！

写完题解的本蒟蒻突然发其它题解都在整活，于是……

围棋作为一项传承千年的策略博弈，其核心精神在于公平竞技与智慧较量。"送子吃以撑爆棋盒"的说法虽带有幽默色彩，但本质上违背了围棋的文化内涵与竞技原则。

从竞技层面看，围棋胜负取决于实地争夺与局势判断。主动送吃无异于自毁棋形，不仅会丧失目数优势，更会破坏棋局平衡。《棋经》云"弃小而不救者，有图大之心"，任何落子都需服务于全局战略，无谓送子实属非理性行为。职业比赛中，类似操作会导致己方迅速溃败。

从文化视角而言，围棋讲究"手谈"的君子之风。唐代王积薪《十诀》首条即强调"不得贪胜"，强调对弈者应追求技艺精进而非投机取巧。刻意制造棋盒爆满的闹剧，既失却围棋雅趣，更背离"胜固欣然败亦喜"的豁达境界。

## 思路：

先来分析题意，简单点说就是：有两个容器，轮流放物品，超过容量就输了。

现在我们就可以愉快的思考了！

因为黑方先提子，白方后，我们不难发现黑方提子的轮次号一定是奇数，白方提子的轮次号一定是偶数。那就可以用两个变量分别存各方提子数目。只要在过程中某一方的提子数量超过了 $M$ 就直接输出获胜方，如果整个棋局结束还没有超过 $M$ 的就说明是平局。

## 完整代码：
```cpp
请不要抄题解！
#include<bits/stdc++.h>
using namespace std;
int n,m,a,b;
int main(){
    cin>>n>>m;
    for(int i=1,d;i<=n;i++){
        cin>>d;
        if(i%2==1)a+=d;//黑方提子
        else b+=d;//白方提子
        if(a>m){cout<<"White";return 0;}//黑方超过M，白方赢
        if(b>m){cout<<"Black";return 0;}//白方超过M，黑方赢
    }
    cout<<"Draw";//平局
}
```

---


# [信息与未来 2017] 基因组分析

## 题目描述

乌龟得到了他的基因组，一个只包含 $\tt{ATCG}$ 四种字母的字符串。乌龟想起科学家说，基因组中很多片段都多次重复出现，而且这种重复是很有意义的，于是他想计算一下自己基因组里片段的重复情况。

给定一个基因组，其中一个长度为 $k$ 的子串称为一个“$k$-片段”。乌龟希望你计算出基因组中不同的 $k$-片段数量。例如，基因组 $\tt{TACAC}$ 的 $2$-片段有 $\tt{TA,AC,CA,AC}$，其中不同的片段数量有 $3$ 个。

---

试题中使用的生成数列 $R$ 定义如下：整数 $0\leq R_1\lt 201701$ 在输入中给出。

对于 $i\gt 1,R_i=(R_{i−1}\times 6807+2831)\mod 201701$。

## 说明/提示

$30\%$ 的数据满足 $n\leq100$； 

$100\%$ 的数据满足 $1\leq n\leq 10^5,1\leq k\leq 10$。

>本题原始满分为 $20\text{pts}$。

## 样例 #1

### 输入

```
20 2 37```

### 输出

```
10```

# 题解

## 作者：chen_zhe (赞：4)

欢迎报名[洛谷网校](https://class.luogu.com.cn/)，期待和大家一起进步！

本题考察了字符串函数和 C++ STL 中集合（`set`）的应用。

首先我们根据题意，使用题目中对 $R_i$ 的生成方式，生成 $R_i$。接着根据 $R_i \bmod 4$ 的值为 $0,1,2,3$ 时分别为 $\tt{A,T,C,G}$ 这一句话，我们生成得到字符串 $s$。

基因组字符串到手后，下一步是提取所有长度为 $k$ 的字符串。这里可以使用 `substr` 函数，使用方式是 `string l = s.substr(i, k)`，指的是从下标 $i$ 开始截取长度为 $k$ 的字符串，放入变量 $l$ 中。

接着，由于题目中说到要统计有多少个不同的字符串，C++ 的 `set` 容器成了我们的好帮手。`set` 会自动去重，每次插入一个子串，它只保留唯一值。因此我们只要把截取的子串放入 `set` 中，最后输出集合大小即可。

参考代码（只展示关键部分）：

```cpp
for (int i = 0; i < s.size() - k + 1; i++) {
    l = s.substr(i, k);
    set_gs.insert(l);
}
cout << set_gs.size() << endl;
```

---


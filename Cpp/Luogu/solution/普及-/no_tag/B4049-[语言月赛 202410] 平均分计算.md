# [语言月赛 202410] 平均分计算

## 题目描述

小 Y 所在的大学提供了 $n$ 门课程，第 $i$ 门课程有 $p_i$ 人报名，学号依次为 $id_{i,1},id_{i,2},\ldots,id_{i,p_i}$（保证不重复）。

按照学号从小到大的顺序，所有同学的**课堂参与度**依次是 $sc_{i,1},sc_{i,2},\ldots, sc_{i,p_i}$（学号最小的同学课堂参与度为 $sc_{i,1}$，以此类推）。

这门课的老师决定给该课程**课堂参与度**排名第 $j$ 的同学 $w_{i,j}$ 分。自然地，课堂参与度更高的人，得分也会更高。

本题中“排名”定义为“比自己大的数字个数 $+1$”，如 $30,30,10,20,50$ 中，两个 $30$ 的排名都是第 $2$。

给出小 Y 的学号 $ID$，请计算她**报名了的课程**的**平均分数**。如果平均分数是整数，那么直接输出，否则以 $a\texttt{+}b\texttt{/}c$ 的形式输出，其中 $a$ 为自然数，且 $\dfrac{b}{c}$ 是最简真分数。

## 说明/提示

【样例 1 解释】

第一门课程有 $3$ 人报名，学号分别为 $300,100,200$。按照学号从小到大的顺序，三人的课堂参与度为 $20,10,30$，这也就意味着：
- 学号为 $100$ 的同学课堂参与度为 $20$，课堂参与度排第 $2$ 名，获得 $85$ 分。
- 学号为 $200$ 的同学课堂参与度为 $10$，课堂参与度排第 $3$ 名，获得 $75$ 分。
- 学号为 $300$ 的同学课堂参与度为 $30$，课堂参与度排第 $1$ 名，获得 $95$ 分。

第二门课程有 $1$ 人报名，学号为 $300$，课堂参与度为 $200$，老师给他 $200$ 分。

小 Y 的学号为 $200$，在第一门课程中获得 $75$ 分，而他仅报名了这门课程，因此平均分就是 $75$。

【样例 2 解释】

学校提供了 $4$ 门课，都只有一个学号为 $1$ 的同学报名，课堂参与度均为 $1$，其中，第 $1,3$ 门课的老师给了他 $1$ 分，第 $2,4$ 门课的老师给了他 $2$ 分。

小 Y 就是这个学号为 $1$ 的同学，因此，他的平均分就是 $\dfrac{1+2+1+2}{4}=1\dfrac{1}{2}$，输出 `1+1/2`。

【数据范围】

对于全体数据，保证 $1\le n\le 40$，$1\le p_i\le 100$，$1\le id_{i,j},ID\le 10^9$，$1\le sc_{i,j},w_{i,j}\le 430$，且保证小 Y 报名了至少一门课。

同时保证同一门课中课堂参与度高的同学得分也高，也就是任取 $1\le i\le n$，任取 $1\le j \le k\le p_i$，有 $w_{i,j}\ge w_{i,k}$。

本题共有 $10$ 个测试点，每个 $10$ 分。下面给出各个测试点的情况，其中 `Y` 表示保证测试点有这个性质，`N` 表示不保证。

|测试点编号|特殊性质 A|特殊性质 B|特殊性质 C|
|:-:|:-:|:-:|:-:|
|$1$|Y|Y|Y|
|$2$|Y|N|Y|
|$3$|Y|N|N|
|$4$|N|Y|Y|
|$5$|N|N|Y|
|$6$|N|Y|N|
|$7\sim 10$|N|N|N|

- 特殊性质 A：保证小 Y 如果报名了一门课程，他一定是课堂参与度最高的。
- 特殊性质 B：保证小 Y 上了所有课。
- 特殊性质 C：保证答案是整数。

## 样例 #1

### 输入

```
2
3
300 100 200
20 10 30
95 85 75
1
300
200
200
200
```

### 输出

```
75
```

## 样例 #2

### 输入

```
4
1
1
1
1
1
1
1
2
1
1
1
1
1
1
1
2
1
```

### 输出

```
1+1/2
```

# 题解

## 作者：yummy (赞：2)

本题考查二维数组、顺序查找、分数约分，且要求选手写出规范、容易调试的代码。

要计算平均分，只要知道小 Y 报名的课程数量以及总分。

首先要把所有的课程信息用二维数组存储。这里，为了减少命名错误，建议大家直接使用题目中的变量名。

```cpp
int n,p[45],ID;
int id[45][105],sc[45][105],w[45][105];
int main(){
	scanf("%d",&n);
	for(int i=1;i<=n;i++){
		scanf("%d",&p[i]);
		for(int j=1;j<=p[i];j++)
			scanf("%d",&id[i][j]);
		for(int j=1;j<=p[i];j++)
			scanf("%d",&sc[i][j]);
		for(int j=1;j<=p[i];j++)
			scanf("%d",&w[i][j]);
	}
	scanf("%d",&ID);
```

接下来对于每门课程，要先判断小 Y 是否上了这门课，如果上了这门课，他的学号是第几小的。

这里考虑使用一重循环判断是否出现，其中 `rkid` 记录**学号的排名**，`sign` 表示是否报名了这个课。

```cpp
  int sums=0,sumc=0;
	for(int i=1;i<=n;i++){
		int rkid=0,sign=0;
		for(int j=1;j<=p[i];j++){
			if(id[i][j]==ID)
				sign=1;
			if(id[i][j]<=ID)
				rkid++;
		}
		if(sign==0)
			continue;
```

得到学号的排名后，我们能正确得到小 Y 在这门课上的活跃度，接下来要知道活跃度的排名，从而知道老师给出的分数。**注意请仔细考虑并列，严格按照题目的定义**。

参考代码中，`act` 表示活跃度，`rkact` 表示活跃度的排名。

```cpp
		int act=sc[i][rkid],rkact=1;
		for(int j=1;j<=p[i];j++)
			if(sc[i][j]>act)
				rkact++;
		sums+=w[i][rkact];
		sumc++;
	}
```

最后我们得到了课程数和总分，先算出整数部分 $a$ 和小数部分 $b/c$，然后：
- 如果 $b=0$，那么小数部分是 $0$，直接输出 $a$。
- 否则要对 $b/c$ 约分，也就是先求出最大公约数 $gcd$，然后再把 $b,c$ 都除以这个 $gcd$。

```cpp
	int a=sums/sumc,b=sums%sumc,c=sumc;
	if(b==0)
		printf("%d\n",a);
	else{
		int gcd=1;
		for(int i=1;i<=b;i++)
			if(b%i==0 && c%i==0)
				gcd=i;
		printf("%d+%d/%d\n",a,b/gcd,c/gcd);
	}
```

---


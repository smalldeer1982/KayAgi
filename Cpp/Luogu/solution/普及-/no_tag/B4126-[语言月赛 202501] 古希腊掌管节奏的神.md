# [语言月赛 202501] 古希腊掌管节奏的神

## 题目描述

小 Y 在用手指敲击桌面，他觉得这节奏非常美妙，于是用一串字符串记了下来。

他只用四根手指敲击桌面：左手食指（`L`）、左手中指（`L'`）、右手食指（`R`）、右手中指（`R'`）。如果每次只有一根手指敲击桌面，那么直接把每个时刻的手指按时间顺序记录下来即可。

例如，`LRR'L` 表示先用左手食指敲击，然后是右手食指，接着是右手中指，最后左手食指敲击桌面。

但是为了体现出声音的强弱，有时要多个手指同时敲击桌面。这时候小 Y 就会把几根手指用括号括起来。（保证括号内的手指不重复。）

例如，`(LL')RR(LR)(RR')` 表示：

- 先左手食指和中指同时敲击 $1$ 次。
- 然后右手食指连续敲击 $2$ 次。
- 然后左右手食指同时敲击 $1$ 次。
- 最后右手食指和中指同时敲击 $1$ 次。

把有手指敲击的时刻称为**一拍**。例如上面的示例一共有 $5$ 拍，每一拍分别有 $2,1,1,2,2$ 根手指敲击桌面。

给出小 Y 的记录 $S$，请输出 $S$ 中的总拍数，并且在**部分测试点中**，分别计算四根手指的最大连续敲击拍数（即最大的 $k$ 使得该手指在连续的 $k$ 拍中都敲了一下桌子）。

## 说明/提示

【样例 1 解释】

此样例即为题目描述中的情形。

- 左手食指在第 $1,3$ 拍敲了一下桌子，但是并不连续，因此最大连续敲击拍数还是 $1$。
- 左手中指在第 $1$ 拍敲了一下桌子，最大连续敲击拍数为 $1$。
- 右手食指在第 $2,3,4,5$ 拍敲了一下桌子，最大连续敲击拍数为 $4$。
- 右手中指在第 $5$ 拍敲了一下桌子，最大连续敲击拍数为 $1$。

【样例 2 解释】

如果一根手指没有敲击桌面，那么最大连续敲击拍数显然是 $0$。

（Bonus：小 Y 发现，尽管这个节奏非常简单，然而敲桌子时很容易出错，你可以挑战一下。）

【样例 3 解释】

注意多根手指敲击桌面时，这些手指被记录的顺序可以是任意的。

同时，由于本测试点 $type=0$，仅要求总拍数，你的输出应当只有第一行。

【数据范围】

记 $n$ 为输入的字符串长度。对于全体数据，保证 $1\le n\le 10000$，并且一定由题目描述中给出的方式构成。

本题共有 $10$ 个测试点，每个 $10$ 分。下面给出各个测试点的情况，其中 `Y` 表示保证测试点有这个性质，`N` 表示没有。

|测试点编号|特殊性质 A|特殊性质 B|$type$ 的值|
|:-:|:-:|:-:|:-:|
|$1$|Y|Y|$0$|
|$2$|Y|Y|$1$|
|$3$|N|Y|$0$|
|$4$|N|Y|$1$|
|$5$|Y|N|$0$|
|$6$|Y|N|$1$|
|$7$|N|N|$0$|
|$8\sim 10$|N|N|$1$|

- 特殊性质 A：小 Y 仅使用食指敲击桌面。
- 特殊性质 B：小 Y 每次仅用一根手指敲击桌面。

【提示】

`L'`、`R'` 中的小撇是单引号，ASCII 为 $39$。在常用的键盘上，这个键在分号的右边。

## 样例 #1

### 输入

```
(LL')RR(LR)(RR')
1
```

### 输出

```
5
1 1 4 1
```

## 样例 #2

### 输入

```
LRRLRRLR
1
```

### 输出

```
8
1 0 2 0
```

## 样例 #3

### 输入

```
(LL')RR(LL')RR(L'L)R(L'R')L'R'(L'R')L'R'(L'R')L(R'LRL')
0
```

### 输出

```
17
```

# 题解

## 作者：yummy (赞：5)

本题考查字符串的综合应用，对选手分析题意、整体规划自己程序的能力有初步的考察。

一种可能的实现是把程序分为两步：第一步把字符串转化成二维数组，表示每一拍的每一根手指是否敲击桌面；第二步则是根据第一步得到的数组求出连击数量。

### 第一步

为了避免相同的代码写四遍，可以给手指标号：`L,L',R,R'` 分别用 $0,1,2,3$ 表示。然后我们规定 $tap_{t,fin}$ 表示 $t$ 时刻 $fin$ 手指是否敲击。

整体求值流程是从前往后按顺序读取字符串内容。为了把手指信息正确填入 $tap$ 数组，还要记录当前的 $t$ 表示接下来读取第几拍。

先忽略括号，考虑读取到一个字母（假设为 `s[i]`）怎么办：

- 如果字母是 `L` 则 `fin=0`，否则 `fin=2`。
- 如果下一个字符是引号，那么 `fin` 额外 $+1$。
- 把 `tap[t][fin]` 设为 $1$，然后把 $t$ 增加 $1$。

接下来考虑括号。

在括号内的手指的读取流程和括号外完全一致，唯一的不同点在于，每次读取结束后不需要把 $t$ 增加 $1$。

因此我们可以用一个变量 `single` 表示“是否是单击模式”，如果是则每次读取结束后 $t$ 增加 $1$，否则 $t$ 增加 $0$，换言之把 `t+=1` 换成 `t+=single` 即可。

下面给出第一步的参考代码（注意，$t$ 的初值为 $1$）：

```cpp
scanf("%s%d",s,&type);
	int n=strlen(s),single=1;
	for(int i=0;i<n;i++){
		if(s[i]=='(')
			single=0;
		else if(s[i]==')'){
			single=1;
			t++;
		}
		else{
			int fin=0;
			if(s[i]=='R')fin=2;
			if(s[i+1]=='\''){
				fin++;
				i++;
			}
			tap[t][fin]=1;
			t+=single;
		}
	}
	printf("%d\n",t-1);
```

### 第二步

外层循环 $fin$ 枚举四根手指，考虑内层循环，用一个 `cur` 表示当前连续敲击，以及 `best` 表示当前最大连续敲击即可。

```cpp
if(type==0)
		return 0;
	for(int fin=0;fin<4;fin++){
		int best=0,cur=0;
		for(int i=1;i<t;i++){
			if(tap[i][fin]){
				cur++;
				best=max(cur,best);
			}
			else
				cur=0;
		}
		printf("%d ",best);
	}
```

std 总长为 667B，并不算很长，这体现了选取一个合适的框架写程序的重要性。

---


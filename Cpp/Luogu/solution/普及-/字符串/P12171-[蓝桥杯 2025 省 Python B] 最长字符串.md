# [蓝桥杯 2025 省 Python B] 最长字符串

## 题目描述

小蓝手里有一个单词本，上面记录了一些单词，保存在 words.txt 中，其中每一行包含一个仅有小写英文字母组成的单词。

小蓝想要找到一个最长的优美字符串。

一个长度为 $n$ 的字符串 $s = c_1c_2 \cdots c_n$ 是优美字符串，必须满足 $s$ 在单词本中，且满足以下两个条件之一：

1) $n = 1$；
2) $n > 1$，且存在一个优美字符串 $s'$，$s'$ 的长度为 $n - 1$，$s'$ 的字符调整顺序后与 $c_1c_2 \cdots c_{n-1}$ 一致。

示例，假设 words.txt 文件中的单词如下：b、bc、cbd、dbca，那么：

- $s_1 = \tt{b}$，长度 1，是优美字符串；
- $s_2 = \tt{bc}$，$s' =\tt b$ 在单词本中出现过，并且是优美字符串，所以 $s_2$ 是优美字符串；
- $s_3 =\tt cbd$，$s' =\tt bc$ 在单词本中出现过，并且是优美字符串，所以 $s_3$ 是优美字符串；
- $s_4 =\tt dbca$，$s' =\tt cbd$ 在单词本中出现过，并且是优美字符串，所以 $s_4$ 是优美字符串；

现在请你帮助小蓝从单词本 words.txt 中找出长度最大的优美字符串，如果存在多个答案，优先使用字典序最小的那一个作为答案。

# 题解

## 作者：KomeijiReimu (赞：1)

https://www.luogu.com.cn/problem/P12171

长度为 $1$ 的字符串自动变成优美字符串，因此一定是从长度小的字符串开始升序更新，于是把整个字符串组按照长度排序。

考虑题目中说只要字符相同，就算次序不一致也能匹配。于是在比对是否一致的时候，把每个字符串用字典序排序，这样就不用管次序，直接匹配即可。

从头到尾枚举每个字符串，每次判断这个字符串是否为优美字符串，方法是将当前字符串去掉末尾一个字符后按字典序重新组合，判断排序后的字符串是否在优美字符串库内，如果是则把当前字符串入库，并且更新最长的优美字符串。
值得注意的是，在把优美字符串入库时，**也要对该字符串进行重新排序**，因为**不排序就没法与下一个去掉末尾字符的字符串进行直接比较**。
```python
import sys


def solve():
    with open("words.txt", "r") as f:
        words = [line.strip() for line in f.readlines()]

    # 排序：首先按长度排序，长度相同则按字典序排序
    words.sort(key=lambda x: (len(x), x))

    # set存储所有优美字符串
    Bs = set()

    # 查找最长的优美字符串
    longestBs = ""

    for word in words:
        # 排序去掉末尾的字符串
        newsub = list(word[:-1])
        newsub.sort()
        # 排序整个字符串，为入库做准备
        news = list(word)
        news.sort()

        # 检查当前单词是否可以成为优美字符串
        if len(word) == 1 or str(newsub) in Bs:
            Bs.add(str(news))
            # 更新最长的优美字符串
            if len(word) > len(longestBs):
                longestBs = word
            # 一样长找字典序最小的
            elif len(word) == len(longestBs):
                longestBs = min(longestBs, word)

    return longestBs


sys.stdout.write(solve())

```

---


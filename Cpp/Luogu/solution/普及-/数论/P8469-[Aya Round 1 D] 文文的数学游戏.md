# [Aya Round 1 D] 文文的数学游戏

## 题目背景

在解决了上一题之后，琪露诺觉得自己仿佛就是天才。于是，射命丸文又给了她一道简单的数学题。

## 题目描述

给定长度为 $n$ 的整数序列 $a$，你需要构造一个长度为 $n$ 的整数序列 $b$ 满足对于所有 $1\le i\le n$，有 $1\le b_i \le a_i$。且 $\gcd(b_1,b_2,\cdots,b_n)$ 最大，其中 $\gcd$ 表示最大公因数。试求出能得到的最大值和取得最大值时，不同的数列 $b$ 的个数，对 $10^9+7$ 取模。

定义两个长度为 $L$ 的数列 $c,d$ 不同，当且仅当存在整数 $i(1 \le i \le L)$，使得 $c_i \ne d_i$。

## 说明/提示

### 样例 1 解释

注意到由于 $1\le b_1\le a_1=1$，因此 $b_1$ 必须要为 $1$，因此最大的 $\gcd$ 值只能为 $1$。在这个前提下，所有合法的 $b$ 如下：

- $\{1,1,1\},\{1,1,2\},\{1,1,3\},\{1,2,1\},\{1,2,2\},\{1,2,3\}$。

### 数据范围与约束

对于 $100\%$ 的数据，$1 \le n\le 10^5$，$1 \le a_i\le 10^9$。

本题附带一组大样例。

## 样例 #1

### 输入

```
3
1 2 3```

### 输出

```
1 6```

# 题解

## 作者：chen_zhe (赞：24)

# 文文的数学游戏

## 解法

为方便表述，下面令 $M=\gcd_{i=1}^n b_i$。

对于第一问，$M$ 的最大值即 $a_i$ 中的最小值。因为 $g=\gcd(a,b)\leq \min(a,b)$。当 $M$ 大于 $a_i$ 中的最小值，则存在至少一个 $i$ 使得 $b_i \leq a_i<M$，此时 $\gcd(M,a_i)<M$。而当 $M$ 取到 $a_i$ 中的最小值 $a_{\min}$ 可以让 $b_i$ 全部取到 $a_{\min}$，这样就可以使得 $M$ 最大。

有多少种取法？令 $b_i=a_{\min},2a_{\min},\dots,na_{\min}(b_i \leq a_i)$ 都是不会改变 $M$ 的。考虑 $a_{\min}$ 前面的系数最大值 $d_i$，则 $d_i=\lfloor \dfrac{a_i}{a_{\min}}\rfloor$。由于可以对每个 $b_i$，任取 $b_i=c\times a_{\min}(c \in [1,d_i])$，则取法的答案为 $\prod \limits_{i=1}^n d_i$。记得开 long long，以及边乘边取模。

```cpp
#include <iostream>
using namespace std;
int a[100050],n,mgcd=1<<30;
const int mod=1e9+7;
int main()
{
    cin >> n;
    for (int i=1;i<=n;i++)
    {
        cin >> a[i];
        mgcd=min(mgcd,a[i]);
    }
    long long ans=1;
    for (int i=1;i<=n;i++)
        ans=(long long)ans*(a[i]/mgcd)%mod;
    cout << mgcd << " " << ans << endl;
    return 0;
}
```

---

## 作者：落花月朦胧 (赞：10)

# 题意

略，题目写得很清楚了。

# 题解

本题分为两个部分，第一求最大的 $\gcd$ 的值，第二求方案总数。

第二部分是依托于第一部分的，所以我们先考虑如何求值。

显然，对于任意一个数组，这个数组的所有元素相同时， $\gcd$ 最大，即这个数组内那个相同的元素。

由于题中有对 $b$ 数组的约束，导致了 $b$ 数组的上限被确定。

给出一个结论，最大的 $\gcd$ 就是 $\min{a}$。

证明：

首先证明是否有这种构造方案，显然，当所有的 $b_i=\min a$ 时，这个方案成立。

然后证明正确性：

我们假设有更大的 $\gcd$，而这个数为 $x$，满足 $x > \min a$，这时候有没有构造方案呢？

答案是没有，对应 $\min a$ 位置的 $b_i$ 上限为 $\min a$，如果有更大的数，就要求 $\forall i,b_i\mid x$，即 $b_i$ 都是 $x$ 的整数倍，那么就要 $b_i > x$，既然对于那个位置的 $b_i$ 上限为 $\min a$，而 $x>\min a$，显然两者矛盾了，证毕。

现在我们思考如何求方案数，下面设上述的最大的 $\gcd$ 为 $x$。

显然对于不同的 $i$，都有不同的方案，而这又满足乘法原理，我们只需要把所有 $b_i$ 能够取的值搞出来，全部乘起来答案就出来了。

现在问题又转换为了对于每个 $b_i$ 的方案求法。

我们知道 $\gcd(b_1, b_2\dots b_n) = \gcd(b_1, \gcd(b_2, \dots))$。

全部的 $\gcd$ 取决于两两的 $\gcd$。

既然如此，我们又知道了 $\gcd$ 的取值（上面一大堆证明的东西），就可以求了。

当这个数组内的数都是 $x$ 的倍数时就满足条件了。

给出了一个数的上限，还要求这个数为 $x$ 的倍数，显然对于任意的 $b_i$ 都有不同的 $a_i \div x$ 的方案。

于是我们线性算就完了。

```cpp
int n;
std::cin >> n;

std::vector<int> a(n);
int mn = inf;
for (int i = 0; i < n; i++) {
	std::cin >> a[i];
	mn = std::min(mn, a[i]);
}

std::cout << mn << " ";
Z ans = 1;
for (int i = 0; i < n; i++) {
    ans *= (a[i] / mn);
}
std::cout << ans.val() << "\n";
```
有人可能会问了， 你这没取摸啊， $Z$又是什么类型？

这里我给一个自动取模的模板，可以放心使用。

用法自己看就知道了。

自己呕心沥血多时的模板就这样给你了。

[自动取模的模板](https://www.luogu.com.cn/paste/n6d6wxgy)

---

## 作者：xzy090626 (赞：5)

# P8469 题解
## 分析
这题乍一看很难搞，但其实非常容易写。

首先，既然我们已经知道了所有的 $b_i$ 的上限，那么不妨设 $b_i = a_i$，方便分析。

首先，根据 $\gcd$ 的定义我们知道，$\gcd(\{b_i\})$ 的值一定 $\le \min(\{b_i\})$。那么为了使得 $\gcd(\{b_i\})$ 最大，我们可以让 $\gcd(\{b_i\} = \min(\{b_i\})$。

那么什么时候这两者相等呢？显然，当所有的 $b_i$ 都相等时才能满足。

那么我们可以直接使所有的 $b_i = \min(\{a_i\})$。此时，答案就为 $b_i$。

正确性也很容易证明，因为任取一个更小的值可能导致 $\gcd$ 变小，因此我们的解法正确。

设 $\min(\{a_i\})$ 为 $x$。

由于统计的是方案总数，那么每个 $b_i$ 所可以取的方案数为 $\lfloor {b_i \over x}\rfloor$ 。由于 $x \le b_i$，所以这个值不会为 $0$。
## 实现
赛时代码奉上。
```cpp
#include<iostream>
#define int long long
using namespace std;
const int mod = 1e9 + 7;
int a[1000005];
signed main(){
	int n;cin>>n;
	int cnt = 1.1e9;
	int ans = 1;
	for(int i=1;i<=n;i++) cin>>a[i];
	for(int i=1;i<=n;i++) cnt = min(a[i],cnt);
	for(int i=1;i<=n;i++) ans *= a[i]/cnt,ans %= mod;
	cout<<cnt<<' '<<ans;
	return 0;
}
```
实现非常容易，重点就在思考。

### Details
- 记得开 long long，而且要取模。
- 取最小值不要忘了将初始值设为 $\text{inf}$，且 $\text{inf} > 1 \times 10^9$。这里我用的是 $1.1 \times 10^9$。
- 注意统计方案数的方法。

## 总结

这次 Div.3 入门赛觉得很不错，本题也颇具有思维难度，感谢出题组为我们带来的好题。

另外，CSP 2022 即将到来，祝大家 rp += inf！

---


# [语言月赛 202312] 打表过样例

## 题目背景

众所周知，一名负责任的出题人，不应当让如下的打表程序获得过多的分数。

```cpp
#include<iostream>
int main() {
    std::cout << "Specific Value\n";
}
```

> 这个程序的功能是，输出一个特定的内容，以尝试通过一些测试点而获得分数。
> 
> 经典的例子是：<https://www.luogu.com.cn/problem/P8819>，输出无解可以获得 45 分的成绩。

## 题目描述

很不幸，你遇到了不负责任的出题人。

在某道试题里，共有 $N$ 个测试点，组成了 $k$ 个 Subtask，第 $i$ 个 Subtask 包含 $p_i$ 个测试点，第 $j$ 个测试点的编号为 $w_{i,j}$。请注意，一个测试点可能属于多个 Subtask。

> **Subtask**
>
> 每个 Subtask 包含多个测试点和一个分值，当且仅当通过全部这些测试点时，才能获得这个 Subtask 的分值。一道题目的得分为通过的所有 Subtask 分值之和。

这是一道输出仅有一个数的题目，编号为 $i$ 的测试点，标准答案为 $A_i$。

很不幸，由于命题人不负责任，$A_i$ 中出现了大量重复，让打表选手有了可乘之机。

现在，你通过某种手段获得了全部的数据，请问输出哪个数，可以得到最高的分数？最高的分数是多少？

如果有多个数均可得到最高的分数，你只需要任意给出一个。

## 说明/提示

### 数据规模与约定

- 对于 $30\%$ 的测试数据，$1 \le N \le 100$，$1 \le k,p_i \le 10$，$1 \le A_i \le 100$。
- 对于 $100\%$ 的测试数据，$1 \le N \le 10^5$，$1 \le k,p_i \le 5000$，$1 \le w_{i,j} \le N$，$1 \le S_i \le 10^9$，$1 \leq A _ i \leq 10 ^ 9$。

## 样例 #1

### 输入

```
2
3 1 2 3 5
3 4 5 6 7
6
4 4 4 5 5 5
```

### 输出

```
7
5
```

# 题解

## 作者：览遍千秋 (赞：12)

## Source & Knowledge

2023 年 12 月语言月赛，由洛谷网校入门计划/基础计划提供。

考察数组、排序。

---

## 文字题解

用数组 $w[i][]$ 存储第 $i$ 个 Subtask 中包含的所有测试点编号。

输入完毕每个测试点的答案 $A_k$ 后，遍历每个 Subtask，判断其中测试点答案是否相同。

假设第 $i$ 个 Subtask 中全部的测试点答案均相同，记作 $Q_i$，该 Subtask 得分为 $S_i$，那么输出 $Q_i$ 可以获得的分数将增加 $S_i$。

### 部分分 1

考虑求解最终的答案，需要对 $Q_i$ 统计得分。很容易想到桶思想，用 $T[x]$ 表示输出 $x$ 可以得到的分数。

每找到一个测试点答案均相同的 Subtask，就将 $T[Q_i]$ 增加 $S_i$，最终统计 $T[x]$ 的最大值即可。

### 满分解法

注意到 $Q_i$ 可以达到 $10^9$，桶无法开到这么大。

用一个结构体数组存下每一对 $Q_i,S_i$，所有 Subtask 扫描完毕后，按照 $Q_i$ 排序，这样就按照 $Q_i$ 将这个结构体数组分成了若干段，分段统计即可。

使用不超出考纲的冒泡排序，时间复杂度为 $O(N+k^2)$。

## 部分核心代码

```cpp
for(int i = 1; i <= k; i++) {
	bool IsAnswerEqual = true;
	for(int j = 2; j <= p[i]; j++) {
		if(A[w[i][j - 1]] != A[w[i][j]]) {
			IsAnswerEqual = false;
		}
	}
	if(IsAnswerEqual) {
		ans[++cnt] = {A[w[i][1]], S[i]};
	}
}
```

---

## 视频题解
![](bilibili:BV1Pp4y1f7fm?page=8)


---


# [信息与未来 2018] 素数方阵

## 题目描述

把前 $n^2$ 个素数从左上角开始按右、下、左、上、右、下、左、上……的顺序填入 $n×n$ 的方阵就得到了蛇形素数方阵。以下是 $n = 4$ 和 $n = 5$ 的蛇形素数方阵：

![](https://cdn.luogu.com.cn/upload/image_hosting/sgevwlzo.png)

给出 $n$，你的任务是求出 $n × n$ 的蛇形素数方阵，并输出其中某个方格中的数值。

素数，又称质数，是指除 $1$ 和其自身之外，没有其他约数的大于 $1$ 的正整数。

## 说明/提示

### 样例解释
参考上图 $n = 5$。
### 数据规模
所有数据满足 $1 ≤ x,y\le n ≤ 20$。

> 本题原始满分为 $15\text{pts}$。

## 样例 #1

### 输入

```
5 1 4```

### 输出

```
7```

## 样例 #2

### 输入

```
5 4 3```

### 输出

```
79```

# 题解

## 作者：chen_zhe (赞：4)

欢迎报名[洛谷网校](https://class.luogu.com.cn/)，期待和大家一起进步！

本题考察模拟、素数判断。

为了便于模拟填入素数的过程，我们可以先把前 $n\times n$ 个素数预处理，放入一个数组 $p$ 中：

```cpp
for (int i = 2; num <= n * n; i++) {
    if (isPrime(i)) {
        num++; // 统计当前有 num 个素数
        p[num] = i;
    }
}
```

接着模拟按右、下、左、上、右、下、左、上……的顺序填入素数的过程。假设我们目前的位置是 $(nx,ny)$，那么我们要做的事情是：
- 将目前的位置填上素数；
- 根据之前的方向，往后续的格子“试探”一步。如果没有问题就继续沿着这个方向走，如果到达了边界/被素数占领了，则转向尝试。

在代码中，你可以定义两个常量方向数组，以便处理拐弯的情况。在本题中，由于保证了移动方向为右下左上，因此方向数组的写法是唯一的：

```cpp
const int dx[] = {0, 1, 0, -1}, dy[] = {1, 0, -1, 0};
```

定义了方向数组之后，就可以用下面代码的方式模拟填数的流程：

```cpp
int nx1 = nx + dx[dir], ny1 = ny + dy[dir];
// 往后续的格子“试探”一步
if (nx1 < 1 || nx1 > n || ny1 < 1 || ny1 > n || a[nx1][ny1]) { // 到达了边界/被素数占领了
    dir = (dir + 1) % 4; // 转向
    nx += dx[dir];
    ny += dy[dir];
} else { // 无事发生
    nx = nx1;
    ny = ny1;
}
```

这样，我们就通过模拟法高效地解决了这一道题目。

---


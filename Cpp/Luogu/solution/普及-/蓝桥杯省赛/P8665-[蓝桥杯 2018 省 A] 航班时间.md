# [蓝桥杯 2018 省 A] 航班时间

## 题目描述

小 h 前往美国参加了蓝桥杯国际赛。小 h 的女朋友发现小 h 上午十点出发，上午十二点到达美国，于是感叹到“现在飞机飞得真快，两小时就能到美国了”。

小 h 对超音速飞行感到十分恐惧。仔细观察后发现飞机的起降时间都是当地时间。由于北京和美国东部有 $12$ 小时时差，故飞机总共需要 $14$ 小时的飞行时间。

不久后小 h 的女朋友去中东交换。小 h 并不知道中东与北京的时差。但是小 h 得到了女朋友来回航班的起降时间。小 h 想知道女朋友的航班飞行时间是多少。

对于一个可能跨时区的航班，给定来回程的起降时间。假设飞机来回飞行时间相同，求飞机的飞行时间。

## 说明/提示

保证输入时间合法，飞行时间不超过 $24$ 小时。

## 样例 #1

### 输入

```
3
17:48:19 21:57:24
11:05:18 15:14:23
17:21:07 00:31:46 (+1)
23:02:41 16:13:20 (+1)
10:19:19 20:41:24
22:19:04 16:41:09 (+1)```

### 输出

```
04:09:05
12:10:39
14:22:05```

# 题解

## 作者：lailai0916 (赞：68)

## 原题链接

- [洛谷 P8665 [蓝桥杯 2018 省 A] 航班时间](https://www.luogu.com.cn/problem/P8665)

## 参考资料

- [时区 - 维基百科](https://zh.wikipedia.org/wiki/时区)

## 解题思路

### 时差建模

1. 显然：

$$
\begin{aligned}
  \text{去程时间} = \text{飞行时间} + \text{时差} \\
  \text{回程时间} = \text{飞行时间} - \text{时差}
\end{aligned}
$$

2. 设飞行时间为 $x$，去程时间为 $t_1$，回程时间为 $t_2$，时差为 $k$，则有：

$$
\begin{cases}
  t_1 = x + k \\
  t_2 = x - k
\end{cases}
$$

3. 两式相加得：

$$
t_1 + t_2 = 2x \Rightarrow x = \frac{t_1 + t_2}{2}
$$

4. 即飞行时间 $x$ 为去程时间 $t_1$ 与回程时间 $t_2$ 的平均值。

### 输入处理

1. 利用 `scanf` 读入前半部分的时间：

```cpp
scanf("%d:%d:%d %d:%d:%d",&h1,&m1,&s1,&h2,&m2,&s2);
```

2. 若有后半部分的额外天数，两部分之间会存在空格，所以可以用 `getchar` 判断下一个字符是否为空格：

```cpp
if(getchar()==' ')scanf("(+%d)",&d);
```

3. 为便于计算，统一将时间转化为总秒数：

$$
t=86400d+3600h+60m+s
$$

### 计算时间

分别利用 **起飞时间** 减去 **降落时间**，求出 **去程时间** 和 **回程时间**，计算两者的平均值。

### 输出格式

1. 将总秒数还原为时分秒：

设时分秒分别为 $h,m,s$，显然 $t=3600h+60m+s$：

- 因为 $3600h$ 和 $60m$ 都是 $60$ 的倍数，所以 $s=t\bmod 60$。
- 因为 $3600h$ 是 $3600$ 的倍数，$0\le s<60$，所以 $m\le\frac{t\bmod 3600}{60}<m+1$，$m=\left\lfloor\frac{t\bmod3600}{60}\right\rfloor$。
- 因为 $0\le s,m<60$，$0\le60m+s<3600$，所以 $h\le\frac{t}{3600}<h+1$，$h=\left\lfloor\frac{t}{3600}\right\rfloor$。

2. 利用 `printf` 格式化输出时间：

```cpp
printf("%02d:%02d:%02d\n",ans/3600,ans%3600/60,ans%60);
```

## 参考代码

```cpp
#include <bits/stdc++.h>
using namespace std;

int get()
{
	int h1,m1,s1,h2,m2,s2,d=0;
	scanf("%d:%d:%d %d:%d:%d",&h1,&m1,&s1,&h2,&m2,&s2);
	if(getchar()==' ')scanf("(+%d)",&d);
	return (d*86400+h2*3600+m2*60+s2)-(h1*3600+m1*60+s1);
}
int main()
{
	int T;
	scanf("%d",&T);
	while(T--)
	{
		int ans=get()+get()>>1;
		printf("%02d:%02d:%02d\n",ans/3600,ans%3600/60,ans%60);
	}
	return 0;
}
```

---

## 作者：fkcufk (赞：9)

[原题链接](https://www.luogu.com.cn/problem/P8665)

推荐在我的博客里阅读，效果更好哦。

# 解析
我们可以得知，过去时间 $=$ 飞行时间 $+$ 时差，回来时间 $=$ 飞行时间 $−$ 时差。

输入我们可以用 `scanf("%d:%d:%d",&a,&b,&c);`，简单，快捷，方便。

# 注意点
- 本题无需 `long long`，`int` 即可。不用担心炸精度。
- 结束时间可能有 `(+1)`。

# 代码
```cpp
#include<bits/stdc++.h> // 万能头我的最爱
using namespace std;
int t;
int d=24*60*60,h=60*60,m=60;
int getstartime(){ // 读入开始时间
	int a,b,c;
	scanf("%d:%d:%d",&a,&b,&c);
	int time=a*h+b*m+c;
	return time;
} 
int getendtime(){ // 读入结束时间
	int a,b,c;
	scanf("%d:%d:%d",&a,&b,&c); // 完美读入
	int time=a*h+b*m+c;
	char ch,extra_day;
	while((ch=getchar())!='\n'&&ch!='\r'){
		if(ch=='('){
			getchar(); // 加号除去
			extra_day=getchar(); // 额外的天数
			time=time+(extra_day-'0')*d; 
		}
	}
	return time;
}
void printime(int time){ // 输出时间函数
	int a,b,c;
	a=time/h,time=time%h,b=time/m,time=time%m,c=time;
	printf("%02d:%02d:%02d\n",a,b,c); // 输出
}
int main(){ // 主函数
	scanf("%d",&t);
	while(t--){
		int start1=getstartime(),end1=getendtime();
		int start2=getstartime(),end2=getendtime();
		int ans=(end1-start1)+(end2-start2);
		printime(ans/2);
	}
	return 0; // 好习惯
}
```

---

## 作者：Peiyuan (赞：6)

这里建议用 ```scanf("%d:%d:%d",&a,&b,&c);``` 输入时间，用 ```printf("%02d:%02d:%02d",a,b,c);``` 输出时间。

### 思路

计算每次的开始时间和结束时间，先都换算成秒，再相减，得到飞行时间。将飞行时间再换算成时分秒的形式，输出答案。在处理 $(+1)$ 的问题时，我们可以用 ```getchar()``` 获取下一个字符，如果是换行符，就说明已经进入下一组时间了。 

### 代码

```cpp
#include<iostream>
using namespace std;

int t,t1,t2;
int cal(){ //计算飞行时间 
	int h,m,s;
	scanf("%d:%d:%d",&h,&m,&s);
	t1=h*3600+m*60+s; //转换为秒数 
	scanf("%d:%d:%d",&h,&m,&s);
	t2=h*3600+m*60+s;
	char c;
	while((c=getchar())!='\n' && c!='\r'){ //输入（+1）的部分
		if(c=='('){
			c=getchar(); //这时读入的是加号
			c=getchar(); //这时读入的是数字
			t2+=(c-'0')*86400; //累加天数，同样换算成秒 
		}
	}
	return t2-t1;
}
int main(){
	cin>>t;
	while(t--){
		int ans=(cal()+cal())/2,a,b,c;
		a=ans/3600,ans%=3600; b=ans/60,ans%=60; c=ans; //将秒再转化成“时分秒”的形式
		printf("%02d:%02d:%02d\n",a,b,c);
	}
	return 0;
}
```


---

## 作者：Back_Stuff (赞：4)

## 题目大意

有 $T$ 组样例，每一组样例都有去和回来的飞机起飞时间和降落时间，在这里我们不知道时差，求飞行时间。

## 思路

我们可以先将起飞和降落时间的差给算出来。

最简单的方法就是将时间差换算成秒，这样没有精度问题。

接着我们可以将两个时间差看成 $T1$ 和 $T2$ 来推一下。这儿的时间差是不算跨时区的时间的。

再将真正的时间差看做 $T$，将两地时差看做 $t$。

显而易见：

$$ 

\begin{cases}
T1=T+t \\
T2=T-t
\end{cases}

$$ 

推：

$$ T1+T2=2 \times T $$

得出结论：

$$ \frac{T1+T2}{2}=T $$

所以我们两个假时间相加再除以二就可以算出真正的飞行时间啦。

## 代码

```cpp
#include<bits/stdc++.h>
using namespace std;

int T;
int a,b,c;
int minus_go,minus_back,ans;

int main(){
	cin>>T;

	while(T--){//不用计组数，用while就好了
		//去的飞机
		scanf("%d:%d:%d",&a,&b,&c);//起飞时间
		minus_go=a*3600+b*60+c;
		scanf("%d:%d:%d",&a,&b,&c);//降落时间
		minus_go=a*3600+b*60+c-minus_go;//算出时差
		if(getchar()==' '){//如果到了第二天或第三天的情况
			scanf("(+%d)",&a);//输入与起飞时间相差的天数
			minus_go+=a*24*3600;//多加上一天或两天的时间
			getchar();//省略换行字符
		}
		//回来的飞机，同上
		scanf("%d:%d:%d",&a,&b,&c);
		minus_back=a*3600+b*60+c;
		scanf("%d:%d:%d",&a,&b,&c);
		minus_back=a*3600+b*60+c-minus_back;
		if(getchar()==' '){
			scanf("(+%d)",&a);
			minus_back+=a*24*3600;
			getchar();
		}

///		cout<<minus_go<<" "<<minus_back<<"\n";//调试语句

		int ans=(minus_go+minus_back)/2;//真正的时间
		int hour=ans/3600,minute=ans%3600/60,second=ans%60;
		//再用真正的时间把对应的小时数，分钟数和秒数算出来
		printf("%02d:%02d:%02d\n",hour,minute,second);
		//输出，%02d是将当前输入的字符前面添0到两位数为止
	}
	return 0;
}

```

---

## 作者：SCAR_L (赞：3)

结尾附赠辅助调试代码！      
[题目传送门](https://www.luogu.com.cn/problem/P8665)

## Part 1：阅读与理解+分析
题意：给你去程和反程的起降**当地**时间，让你求飞行时间（两次飞行时间相等）。

设 $t1$ 为去程起降时间差，$t2$ 为返程起降时间差，$x$ 为时差，$T$ 为飞机**实际**飞行时间。则有以下等式：
$$\boxed{ \begin{cases} t1 = T + x & \mathtt{(1)}\\t2 = T - x&\mathtt{(2)}\end{cases} }$$

将 $\mathtt{(1)}$ 和 $\mathtt{(2)}$ 相加并化简后，得到：
$$\boxed{t1+t2=2 \times T\qquad\mathtt{(3)}}$$

将 $\mathtt{(3)}$ 除以二，得到 $\mathtt{(4)}$：
$$\boxed{T = \frac{t1+t2}{2}\qquad\mathtt{(4)}}$$
所以我们不需要知道时差就可以得出**实际**飞行时间。

## Part 2：代码实现

这道题的实现方法主要在进行时间相关运算，我想出来了两种方法：       
1. 第一种：将所有时间转换成秒，再进行运算（经计算，最多只会有 $23\times3600+59\times60+59=86399s$。所以不用开```long long```）。
2. 第二种：定义一个结构体：有三个成员变量：$h,m,s$，分别代表着小时数、分钟数和秒数，再进行运算。

很明显，第一种方法更容易实现，~~但我还是两种方法都写了~~。       
（代码见文末）         
这里再说一下如何最简单地输入和输出时间：
1. 输入：用 ```scanf("%d:%d:%d", &hour, &min, &sec);```，输入降落时间时若发现读入完时间后 ```getchar() != "\n"``` 再用 ```scanf("+(%d)", &day);``` 读入天数。
2. 输出：用 ```printf("%02ld:%02ld:02ld", hour, min, sec);```。其中 ```%02ld``` 的意思是：一个整数，若小于两位数则在首位前补零直到等于两位数。

## Part 3：总结+代码
本体的难点在于：
1. 题目较长，需耐心读题。
2. 时间的输入输出较麻烦，使用技巧（```scanf``` 和 ```printf```）可以更方便。

# [代码（含辅助调试代码）](https://www.luogu.com.cn/paste/3xowpl6j)

Ps：这是蒟蒻的第 4 篇题解。

---

## 作者：Furina_Hate_Comma (赞：3)

一道**坑多**的模拟~~当时重构了 3 次才过~~。

运用抵消的思想：

1. 假设一趟航班的假时间为忽略时差的时间。

1. 设过去于回来的真实时间是 $t1$，而过去的假时间为 $t2$，回来的假时间为 $t3$。

不难发现：

$2\times t1=t2+t3$

证明如下：

设两地时差为 $k$，因为。

$t2=t1+k$

$t3=t1-k$

两个时差抵消掉了，这就是代码的关键。

其它就是一些简单的模拟部分了。

字符串转时间：

```cpp
int gettime(char a[]){
	return ((a[0]-'0')*10+a[1]-'0')*3600+((a[3]-'0')*10+a[4]-'0')*60+(a[6]-'0')*10+a[7]-'0';
}
```
输出时换格式

```
int h=ans/3600,m=ans%3600/60,s=ans%60;
if(h<10)
	cout<<0;
cout<<h<<':';
if(m<10)
	cout<<0;
cout<<m<<':';
if(s<10)
	cout<<0;
cout<<s<<'\n';
```
完整代码

```
#include<bits/stdc++.h>
using namespace std;
char a[10];
int gettime(char a[]){
	return ((a[0]-'0')*10+a[1]-'0')*3600+((a[3]-'0')*10+a[4]-'0')*60+(a[6]-'0')*10+a[7]-'0';
}
int main()
{
	int n;
	cin>>n;
	int t1,t2,tmp;
	for(int i=1;i<=n;i++){
		cin>>a;
		t1=gettime(a);
		cin>>a;
		t2=gettime(a);
		if(getchar()==' '){
			cin>>a;
			t2+=(a[2]-'0')*24*3600;
		}
		int tmp=t2-t1;
		cin>>a;
		t1=gettime(a);
		cin>>a;
		t2=gettime(a);
		if(getchar()==' '){
			cin>>a;
			t2+=(a[2]-'0')*24*3600;
		}
		int ans=(tmp+t2-t1)/2;
		int h=ans/3600,m=ans%3600/60,s=ans%60;
		if(h<10)
			cout<<0;
		cout<<h<<':';
		if(m<10)
			cout<<0;
		cout<<m<<':';
		if(s<10)
			cout<<0;
		cout<<s<<'\n';
	} 
	return 0;
}

```
完结撒花

---

## 作者：yangmingshuo114514 (赞：3)

一道**模拟**题。

我们无法算出确切的时差，因为有 $2$ 个未知数，而只有 $1$ 个等式。

过去时间 $=$ 飞行时间 $+$ 时差。

回来时间 $=$ 飞行时间 $-$ 时差。

计算出两个"时间"的和，那么两者一个加时差，一个减时差，就会抵消掉。

**注意**：
1. 对于将字符串的输入改为数字可以用：
```cpp
scanf("%d:%d:%d %d:%d:%d",&h1,&m1,&s1,&h2,&m2,&s2);
```
2. 使用完之后要时间记得清零。

代码如下：

```cpp
#include<cstdio>
int t,h1,m1,s1,tim1,h2,m2,s2,tim2,tim,h3,m3,s3;
char ch;
int main(){
	scanf("%d",&t);
	while(t--){
		tim1=tim2=0;
		scanf("%d:%d:%d %d:%d:%d",&h1,&m1,&s1,&h2,&m2,&s2);
		while((ch=getchar())!='\n') if(ch=='1'||ch=='2') tim1=(ch-'0')*86400;
		tim1+=h2*3600-h1*3600+m2*60-m1*60+s2-s1;
		scanf("%d:%d:%d %d:%d:%d",&h1,&m1,&s1,&h2,&m2,&s2);
		while((ch=getchar())!='\n') if(ch=='1'||ch=='2') tim2=(ch-'0')*86400;
		tim2+=h2*3600-h1*3600+m2*60-m1*60+s2-s1;
		tim=(tim1+tim2)/2;
		h3=tim/3600;
		m3=tim%3600/60;
		s3=tim%60;
		if(h3<10) putchar('0');
		printf("%d:",h3);
		if(m3<10) putchar('0');
		printf("%d:",m3);
		if(s3<10) putchar('0');
		printf("%d\n",s3);
	}
	return 0;
}

---

## 作者：GWBailang (赞：2)

#### [原题传送](https://www.luogu.com.cn/problem/P8665)
###### ~~蓝桥杯的题还是有点水的~~
#### 思路 1：直接把两个时间减
这样需要考虑到借位等因素，比较复杂。也不一定可行。
#### 思路 2：把时间都换算成以秒为单位的数
先将两次的起飞和降落的时间转换成以秒为单位的数，降落时间后面有可能会有一个括号，我们可以把这个括号里的数当做天数来算（一天是 86400 秒）。

然后将两次的起飞和降落的时间分别相减得到一个数，最后将两个数加起来，转换成 ```时:分:秒``` 的形式输出就可以了。

#### 核心代码：
```
qmiao=qh*3600+qm*60+qs;//把起飞时间转换成以秒为单位的数
jmiao=jh*3600+jm*60+js;//把降落时间转换成以秒为单位的数
c=getchar();
if(c!='\n'&&c!='\r'){//处理天数
	if(c=='('){
		cin>>c;//输入没用的'+'
		cin>>x;//输入代表天数的x
		jmiao+=x*86400;
		cin>>c;//输入没用的')'
	}
}
zong=jmiao-qmiao;//一共飞了多少秒

//要输入两行，和上面的一样就不再写了
//只要注意最后 zong= 改成 zong+= 就可以了

h=zong/3600;//把秒转换
m=(zong-h*3600)/60;
s=zong-h*3600-m*60;
printf("%02d:%02d:%02d\n",h,m,s);
```
注意题目说有多组数据，还需要套一层循环。

---

## 作者：lbdontknow (赞：2)

## P8665 航班时间 题解
[题目传送门](https://www.luogu.com.cn/problem/P8665)  
### 算法思路
对于每一个时间，我们可以把该时间换算成对应的秒数，然后求得两地的时间差，将两次航班的两地时间差分别记录为 $t1$ 和 $t2$。  
设时差为 $x$，真实飞行时间为 $T$。  
则一趟航班的飞行时间关系式为 $T=t1+x$，而另一趟航班的飞行时间关系式为 $T=t2-x$。  
我们将两个关系式相加，我们就会惊讶的发现时差 $x$ 被抵消了，得到 $2T=t1+t2$，解得 $T=\frac{t1+t2}{2}$，最后输出 $T$ 即可。
### 程序实现细节
需要注意的是，你需要开 ```long long```，否则庞大的秒数将会爆掉 ```int```。  
在读入的时候，我们可以使用 ```scanf()``` 函数很方便地进行格式化输入输出，具体实现细节见完整代码。  
在读入一行的两个时间之后，我们可以通过判断 ```getchar()==' '``` 确认时间后是否有 ```(+x)```。  
如果有，就加上对应天的秒数即可。
### 完整代码
```cpp
#include<bits/stdc++.h>
using namespace std;
#define int long long
int T;
char str1[1919810],str2[1919810];
int get_time(){//读入一行起降时间并计算秒数差
	int t1=0,t2=0;
	int h,m,s;
	scanf("%lld:%lld:%lld",&h,&m,&s);
	t1=h*3600+m*60+s;//换算秒数
	scanf("%lld:%lld:%lld",&h,&m,&s);
	t2=h*3600+m*60+s;//换算秒数
	int day=0;
	if(getchar()==' '){//如果有额外天数
		getchar();//跳过'('
		getchar();//跳过'+'
		scanf("%lld",&day);//读入天数
		getchar();//跳过')'
		getchar();//跳过换行符'\n'
	}
	t2+=day*24*3600;//加上天数
	return t2-t1;//返回时间差
}
signed main(){
	cin>>T;
	while(T--){
		int t1=get_time(),t2=get_time();
		int fly_time=(t1+t2)/2;//计算真实飞行秒数
		printf("%02lld:%02lld:%02lld\n",fly_time/3600,fly_time%3600/60,fly_time%60);//换算时分秒输出
	}
	return 0;
}
```

---

## 作者：Leaves_xw (赞：1)

**思路：**

根据式子 $T1=T+t,T2=T-t$ 得出，$T=\large\frac{T1+T2}{2}$。

那么就是过去时间 $=$ 飞行时间 $+$ 时差，回来时间 $=$ 飞行时间 $-$ 时差。

另：对于读入可以使用这种方式：`scanf("%d:%d:%d",&a,&b,&c);`。

另外不用开 `long long`。

---


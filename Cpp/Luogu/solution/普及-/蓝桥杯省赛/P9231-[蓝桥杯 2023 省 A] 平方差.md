# [蓝桥杯 2023 省 A] 平方差

## 题目描述

给定 $L,R$，问 $L \leq x \leq R$ 中有多少个数 $x$ 满足存在整数 $y,z$ 使得 $x=y^2-z^2$。

## 说明/提示

#### 【样例说明】

* $1=1^2-0^2$
* $3=2^2-1^2$
* $4=2^2-0^2$
* $5=3^2-2^2$

#### 【评测用例规模与约定】

对于 $40 \%$ 的评测用例，$L,R \leq 5000$；

对于所有评测用例，$1 \leq L \leq R \leq 10^9$。

第十四届蓝桥杯大赛软件赛省赛 C/C++ 大学 A 组 C

## 样例 #1

### 输入

```
1 5```

### 输出

```
4```

# 题解

## 作者：L0vely_NaiL0ng (赞：132)

推柿子，得到 $x = (y - z) \times (y + z)$，可知 $x$ 满足可以拆成 $2$ 个奇偶性相同的数的乘积。

如果是奇数，直接拆成 $1$ 和它本身即可。

如果是偶数，因为要拆成 $2$ 个偶数，所以应是 $4$ 的倍数，此时一种拆分为拆成 $2$ 和 $x$ 除以 $2$。

至此，答案为 $l$ 到 $r$ 中奇数和 $4$ 的倍数的个数。

```
#include<bits/stdc++.h>
using namespace std;
int f(int x) {//小于等于x的奇数个数 
	if (!x) return 0;
	return (x + 1) / 2;
}
int g(int x) {//小于等于x的4的倍数个数 
	return x / 4;
}
int main() {
	int l, r; cin >> l >> r;
	cout << f(r) - f(l - 1) + g(r) - g(l - 1);
	return 0;
}
```

---

## 作者：_5t0_0r2_ (赞：30)

# 分析：

众所周知，$y ^ 2 - z ^ 2 = (y + z)(y - z)$。那么满足要求的 $x$ 一定存在一组正整数 $a,b(a \times b = x,a > b)$ 满足：

$$

\left \{
\begin{aligned}
&y + z = a\\
&y - z = b\\
\end{aligned}
\right.
$$

化简可得 $2y = a + b$。

因为 $y$ 为整数，所以 $a + b$ 为偶数，即 $a,b$ 奇偶性相同。得出结论：$x$ 分解质因数后，要么没有质因数 $2$，要么至少有两个质因数 $2$。

---

## 作者：Yashajin_Ai (赞：22)

### 前言
先打了个暴力程序来打表。
```cpp
#include<bits/stdc++.h>
using namespace std;
int pd(int x){
	if(x%4==0){
		return 1;
	}
	else if(x%2){
		return 1;
	}
	return 0;
}
int main(){
	int n,m,ans=0,a[100001];
	cin>>n>>m;
	for(int i=n;i<=m;i++){
		if(pd(i)==1){
			ans++;
			a[i]++； 
		}
	}
	cout<<ans;
	/*
	for(int i=n;i<=m;i++){
		cout<<a[i]<<" ";
	}
	*/
}
```

### 思路
建立一个未知常数 $k$，通过打表发现每当数达到 $4 \times k + 2$ 时,且此处的 $4 \times k + 2$ 为整数，这个数字无法表示为平方差。通过计算第 $L$ 个到第 $R$ 个为 $4 \times k + 2$ 的数量有 $\dfrac{x+2}{4}$ 个。

证明：
$x = (y + z) \times (y - z)$ 需要分奇偶讨论。当 $y + z$ 为奇数时， $x$ 为奇数，当 $y + z$ 为偶数时， $x$ 为 $4$ 的倍数。

当 $y + z$ 为奇数时， $x$ 为奇数：$2 \times k + 1 = (k + 1)^2 - k^2$。

当 $y + z$ 为偶数时， $x$ 为 $4$ 的倍数：$4 \times k = (k + 1)^2 - (k - 1)^2$。

### 代码
```cpp
#include<bits/stdc++.h>
using namespace std;
int l,r;
int pd(int x){
	return x-(x+2)/4;
}
int main(){
	cin>>l>>r;
	cout<<pd(r)-pd(l-1);
	return 0;
}
//x=(y+z)(y-z)
//2k+1=(k+1)^2-k^2
//4k=(k+1)^2-(k-1)^2
```

---

## 作者：zhuweiqi (赞：11)

一道比较简单的数学题。

首先我们来看题目中的 $x=y^2-z^2$，由平方差公式可得 $x=(y+z)(y-z)$，因为 $y$ 和 $z$ 都必须是整数，所以题目中每个符合条件的 $x$ 就必须满足它能分解成两个**差是偶数**的因数相乘，在此情况下令其中较小的因数为 $l$，较大的因数为 $r$，$mid=\frac{(l+r)}{2}$，$k=r-mid=mid-l$，则 $x$ 必定可以分成形如 $(mid-k)(mid+k)$ 的形式，很显然对于任意的奇数 $a$ 都满足以上条件，因为可以使 $l=1$，$r=a$，这时 $l$ 和 $r$ 都是奇数且差是偶数，符合条件；当 $a$ 为奇数时，可以分为两类：一类是 $x$ 能分解成 $2\times 2k$（其中 $k$ 是整数）的形式的数，这类数也符合条件，因为 $2$ 和 $2k$ 都一定是偶数，那么它们的差也必定是偶数；另一类数必定不符合条件，因为两个数相乘为偶数时只有两种情况，要么其中有一个数是偶数，要么两个数都是偶数，第二种情况又必定能分解成 $2\times 2k$（其中 $k$ 是整数）的形式，已经在前面判断过了，所以剩下来的数只可能分解成一个奇数乘以一个偶数的形式，而我们知道奇数减去偶数是无论如何也不可能是偶数的，因此剩下来的数全都不符合条件。

因此，我们只需要计算 $1$ 到 $r$ 中有多少个符合条件的数，再把它减去 $1$ 到 $l-1$ 中符合条件的数的数量即可。

参考代码如下：

```cpp
#include<bits/stdc++.h>
using namespace std;
inline int read(){
	int n=0;
	char c=getchar();
	while(c<'0' || c>'9') c=getchar();
	while(c>='0' && c<='9'){
		n=(n<<3)+(n<<1)+(c^48);
		c=getchar();
	}
	return n;
}
int main(){
	int l=read()-1,r=read();
	printf("%d",(r+1)/2+(r/2)/2-((l+1)/2+(l/2)/2));
	return 0;
}
```

---


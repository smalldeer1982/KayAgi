# [语言月赛 202408] 保持连接的方式

## 题目背景

> 时光荏苒，小 S 和小 Y 也会散去。  
> 而我们和一个人保持连接的方式就是记住，仅此而已。  
> —— [[NOI 2024] 集合](https://www.luogu.com.cn/problem/P10785)
>
> 风将这句话写在纸上，折成了纸飞机，扔出窗外。  
> 纸飞机飞吧，飞向天空。
>
> 以此铭记。

## 题目描述

风有一只小木箱，内部被划分为了 $n$ 行 $m$ 列的小格子，第 $i$ 行第 $j$ 列的小格子用 $(i,j)$ 表示。风将日记放在小木箱中。每一个小格子可以堆叠的放下至多 $k$ 份日记。风每次只能从小格子的最顶部取出日记，放入日记时，会放在某一个小格子的最顶端。

如果风希望取出被压在下面的日记，他需要先将上面的日记取出，再逐个放回。例如，某个小格子从底部至顶部，依次有编号为 $1,2,3,4,5$ 的五份日记，风希望取出编号为 $3$ 的日记，需要先依次取出编号为 $5,4$ 的两份日记，拿走编号为 $3$ 的日记后，再按照 $4,5$ 的顺序放回。我们称移走 $3$ 号日记需要移动 $2$ 份日记。

在接下来的 $t$ 天，风每一天都会写日记，第 $i$ 天撰写的日记编号为 $a_i$，将存放在 $(x_i,y_i)$ 中。如果 $(x_i,y_i)$ 已满，风需要从 $(x_i,y_i)$ 中先取走编号最小的日记并销毁，销毁后，将新的日记存放在 $(x_i,y_i)$ 顶部。如果存在多份编号最小的日记，销毁最靠上的一份。请问，每一天，风是否需要销毁日记？若需要，需要移动几份日记？

## 说明/提示

对于 $30\%$ 的测试数据，$n=m=1$；  
对于另外 $30\%$ 的测试数据，$k=1$；  
对于 $100\%$ 的测试数据，$1 \le n,m \le 100$，$1 \le k \le 50$，$1 \le t \le 2 \times 10^5$，$1 \le a_i \le 10^9$，$1 \le x_i \le n$，$1 \le y_i \le m$。

## 样例 #1

### 输入

```
2 2 3 5
3 1 1
4 1 1
2 1 1
5 1 1
1 1 1```

### 输出

```
-1
-1
-1
2 0
3 2```

# 题解

## 作者：览遍千秋 (赞：5)

## Source & Knowledge

2024 年 8 月语言月赛，由洛谷网校入门计划/基础计划提供。

考察综合模拟。

---

## 文字题解

按题意模拟。

使用三维数组 $a[][][]$ 来模拟小木箱。$a[x][y][]$ 记录 $(x,y)$ 存放的日记编号。用 二维数组 $top[][]$ 来记录每一个小格子已经存放的日记数目，$top[x][y]$ 表示 $(x,y)$ 已经存放的日记数目。

对于输入的一篇日记，需要存放到 $(x,y)$，编号为 $id$，首先检查 $top[x][y]$ 的值

- 若 $top[x][y]=k$

则说明 $(x,y)$ 已经放满了，我们需要遍历 $a[x][y][]$，记录下最小值与最小值的位置，假设最小值为 $a[x][y][pos]$，$pos$ 即为位置，那么需要移动的日记份数即为 $k-pos$。

之后，进行数组的移动，将 $i>pos$ 的 $a[x][y][i]$ 移动到 $a[x][y][i-1]$。最后将新的日记存入 $(x,y)$，即 $a[x][y][k]$ 赋值为 $id$。

- 若 $top[x][y] \neq k$

直接将 $top[x][y]$ 增加 $1$，将 $a[x][y][top[x][y]]$ 赋值为 $id$。

---

## 视频题解
![](bilibili:BV1WQsEe7ERi?page=8)

---


# [语言月赛 202309] pip install

## 题目描述

`pip install` 是 Python 安装包的重要指令。Python 的包具有依赖关系，在安装某些包之前，需要先安装这些包的依赖。

假定一共有依次编号为 $1 \sim N$ 的 $N$ 个包，第 $i$ 个包共有 $K_i$ 个依赖。现在，小 F 想要安装编号为 $1$ 的包。在完成 $1$ 号包及其全部依赖的安装，一共安装了多少个包？

## 说明/提示

对于 $100\%$ 的测试数据，$1 \le N \le 5000$，$0 \le K_i < N$，保证不会构成循环依赖。

## 样例 #1

### 输入

```
5
1 2
1 3
1 4
0
0```

### 输出

```
4```

# 题解

## 作者：览遍千秋 (赞：9)

## Source & Knowledge

2023 年 09 月语言月赛，由洛谷网校入门计划/基础计划提供。

考察递归。


---

## 文字题解

安装软件包 $i$ 之前，需要安装该软件包的所有依赖。安装依赖之前，又需要安装依赖的依赖，很容易，这构成了一个递归的问题。

由于一个软件包只能被安装一次，我们可以用数组 `installed[i]` 来表示第 $i$ 个软件包有没有被安装过。

定义函数 `void f(int x)`，用来表示当前正在处理编号为 $x$ 的软件包。如果 `installed[x]` 为 `true`，则说明编号为 $x$ 的软件包已经被安装了，我们无需处理，直接退出该函数即可。

如果 `installed[x]` 为 `false`，则开始处理 $x$ 的软件包依赖。遍历 $x$ 所有依赖的包 $v$，调用函数 `f(v)` 来处理其安装。处理完所有依赖后，将 `installed[x]` 修改为 `true`。

最后，`installed` 数组中为 `true` 的位置的个数即为答案。

以下为伪代码：

```cpp
void f(int x)
    if installed[x] is true:
        return
    else:
        for v is relied by x
            f(v)
        installed[x] := true
```

这样一个算法的时间复杂度是 $O(n)$，可以通过。

---

## 拓展内容

当然，我们可以用有向边来描述这样一个依赖关系，如果在安装软件包 $x$ 之前，必须要安装软件包 $v$，我们就用有向边 $v \rightarrow x$ 来描述这样一个关系。

由于不存在循环依赖，在这样一个依赖关系构成的有向图中，不存在环。这是一张有向无环图（Directed Acyclic Graph，DAG），可以使用拓扑排序得到它的一个拓扑序，再用递推求解答案。

这样一个算法的时间复杂度也是 $O(n)$。

---

## 视频题解



---


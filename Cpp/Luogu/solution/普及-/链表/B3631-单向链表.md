# 单向链表

## 题目描述

实现一个数据结构，维护一张表（最初只有一个元素 $1$）。需要支持下面的操作，其中 $x$ 和 $y$ 都是 $1$ 到 $10^6$ 范围内的正整数，且保证任何时间表中所有数字均不相同，操作数量不多于 $10^5$：

- `1 x y` ：将元素 $y$ 插入到 $x$ 后面；
- `2 x` ：询问 $x$ 后面的元素是什么。如果 $x$ 是最后一个元素，则输出 $0$；
- `3 x`：从表中删除元素 $x$ **后面的那个元素**，不改变其他元素的先后顺序。





## 样例 #1

### 输入

```
6
1 1 99
1 99 50
1 99 75
2 99
3 75
2 1```

### 输出

```
75
99```

# 题解

## 作者：ShanCreeperPro (赞：157)

## B3631 单向链表 題解

**管理员注：**

阅读本文章前，请先阅读[$ \ \texttt{ShanCreeper}$ B 题库题解的声明](https://www.luogu.com.cn/blog/Ru19Free/AboutBProblem)，并了解由于课程需要不展示代码。

**如需系统学习相关知识点请报名【[洛谷-基础算法计划](https://class.luogu.com.cn/)】**

点赞上文章即代表您已阅读并熟知其内容。

***

维护一张初始只有元素 $1$ 的表，支持以下操作：

- $1 \ x \ y$：将元素 $y$ 插入到 $x$ 后；
- $2 \ x$：询问 $x$ 后面的元素是什么；
- $3 \ x$：从表中删除 $x$ 后的元素。

如果有操作二，输出一个数字，并换行。

我们依旧可以看成一些人在排队，只不过多了一个插队和走人的操作。

我们假设初始排队顺序为：$1 \ 4 \ 2 \ 3$。

若 5 号同学插队到 4 号的后面，那么会发生什么？

我们先来看看初始的链表情况：

|$i$|1|2|3|4|
| :----------: | :----------: | :----------: | :----------: | :----------: |
|$\texttt{nxt}_i$|4|3|0|2|

此时，5 号同学插入 4 号的后面，那么链表就会变为：

|$i$|1|2|3|4|5|
| :----------: | :----------: | :----------: | :----------: | :----------: | :----------: |
|$\texttt{nxt}_i$|4|?|0|?|?|

![](https://cdn.luogu.com.cn/upload/image_hosting/c3hw621e.png)

此时 2 4 号的位置发送变化，我们一个一个的分析：

- 2 号的后面没有影响，所以 2 号的后面依旧是 3 号；
- 5 号插到了 4 号的后面，所以 5 号的后面将会是原本 4 号后面的人，所以 5 号的后面为 2 号；
- 4 号的后面插进了一个 5 号，所以 4 号的后面变为 5 号。

所以整个链表变为：

|$i$|1|2|3|4|5|
| :----------: | :----------: | :----------: | :----------: | :----------: | :----------: |
|$\texttt{nxt}_i$|4|3|0|5|2|

所以用代码实现是这样：


这时，2 号同学离开了队伍，那么又会发送什么？

那么链表会变为：

|$i$|1|2|3|4|5|
| :----------: | :----------: | :----------: | :----------: | :----------: | :----------: |
|$\texttt{nxt}_i$|4|$\texttt{before 3}$|0|5|?|

- 5 号的后面原本是 2 号，但是 2 号离开了，2 号原本的后面是 3 号，所以 5 号的后面变为了 3 号。

所以变为：

|$i$|1|3|4|5|
| :----------: | :----------: | :----------: | :----------: | :----------: |
|$\texttt{nxt}_i$|4|0|5|3|


![](https://cdn.luogu.com.cn/upload/image_hosting/urxx9vpd.png)


**改进：**

我们可以用结构体减少内存。

原链表为：

|$i$| 1 | 2 | 3 | 4 | 5 | 6 | 7 | 8 | 9 | 10 |
| :---: | :---: | :---: | :---: | :---: | :---: | :---: | :---: | :---: | :---: | :---: |
|$a_i$| 9 |  |  | 7 |  |  | 0 |  | 4 |  |

浪费了很多的空间。

我们可以使用结构体：

| $i$ | 1 | 2 | 3 | 4 | 5 |
| :---: | :---: | :---: | :---: | :---: | :---: |
| $\texttt{node}_i.\texttt{val}$ | $1$ |$4$ |  $7$ | $9$ |  |
| $\texttt{node}_i.\texttt{nxt}$ | $4$ | $3$ |  $0$ | $2$ |  |


---


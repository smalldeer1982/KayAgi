# [GDKOI2023 普及组] Macaron

## 题目描述

给出 $n\times m$ 的一块二维平面作为 Nana 的家，左上角墙角为 $(0, 0)$ ，右下角墙角为 $(n + 1, m + 1)$。其中
家里有 $k$ 个家具，每个家具会占其中一个点，题目将会给出每个家具的坐标。

马卡龙是一只扫地机器人，半径为 $r$ 的圆形的它可以向上下左右四个方向移动，移动前后必须保持圆心在整点上，并且不能穿过家具或外墙进行打扫，即身躯不可以与家具或墙壁有重合部分（允许相切）。它初始圆心位置为 $(x_s, y_s)$ ，将会从此出发，打扫它能到达的区域。

马卡龙想知道自己可以打扫到多大面积。你只需要告诉马卡龙，它出发后它的圆心可以到达的平面内的
整点数量。

对了，你只用将答案告诉马卡龙就够了，不需要告诉 Nana ，因为马卡龙不希望伤心的 Nana 会为这些
琐事烦心。

## 说明/提示

### 数据范围

对所有数据满足 $0 \le k \le n \times  m，1 \le r \le \min(\lfloor \frac{n}{2} \rfloor , \lfloor \frac{m}{2} \rfloor)$；

其中有 $30\%$ 的数据点满足 $1 \le n, m \le 100$;

剩下 $70\%$ 的数据点满足 $1 \le n, m \le 1000$。

## 样例 #1

### 输入

```
10 10
5
4 5
5
7 10
6 10
5 9
4 9
4 10```

### 输出

```
29```

## 样例 #2

### 输入

```
见/example/macaron/下的 macaron1.in```

### 输出

```
见/example/macaron/下的 macaron1.out```

# 题解

## 作者：ty_mxzhn (赞：2)

# 题意

给你一个大小为 $n\times m$ 的整点坐标系，上面有 $k$ 个关键点。求标记完 $k$ 个以这些点为圆心的半径为 $r$ 的圆上的整点后有多少个没标记的点。

$k\le 10^6,n,m,r\le 10^3$。

# 题解

考虑预处理出一个点正上方和正下方最近的关键点。这个是好处理的。

对于每个点，根据刚才的距离可以用差分标记周围的点。

也即：我们把一个列圆心上所有的横向拓展距离一起算出，然后再用差分总体标记。

![](https://cdn.luogu.com.cn/upload/image_hosting/2fxx7w2q.png)

# 后记

像梦一般地去爱

像爱一般地去梦

你曾经说过 即使是空想

只要相信

总有一天会实现的

---

## 作者：sevenki (赞：2)

不妨将题意转换一下：

题目是一个圆形在不碰到障碍的情况下移动，那么我们可以用每个障碍来求出在这个障碍的影响下，不能被作为圆心的点。\
对于每个障碍，这样的点在以该障碍所在点为圆心，半径为 $r$ 的圆内。

可以用差分求这些不能被作为圆心的点。具体的，对于每个坐标，先求出它的正上方与正下方分别能碰到的最近的障碍的坐标，然后差分标记这两个障碍在当前坐标的行上能覆盖的点即可。

然后我们就得到了哪些点可以被作为圆心而哪些点不能。从起点遍历求可以被作为圆心的点的联通块大小即可。

时间复杂度是 $O(n^2)$。[代码实现](https://www.luogu.com/paste/7z0z9r52)。

---


# [NWRRC 2013] Flight Boarding Optimization

## 题目描述

Peter是 Byteland 机场的高级登机管理人员。他的工作是优化登机流程。Byteland 中的飞机有$s$行，编号从1到$s$。每排有六个座位，标有$A$到$F$。

有$n$名乘客，他们排成一队，一个接一个地登上飞机。如果第$i$位乘客坐在第$r_i$排，那么，他登机的难度等于在他前面登机的并且坐在第1......$r_i$ $-$1排的乘客人数之和。



登机的总难度是所有乘客的登机难度之和。例如，如果有十名乘客，他们的座位分别是$6A、4B、2E、5F、2A、3F、1C、10E、8B、5A$，按照排队顺序排列，那么他们登机的难度分别是$0、0、0、2、0、2、0、7、7、5$，总难度是$23$。

为了优化登机，Peter希望将飞机划分成$k$个区域。每个分区都必须是连续的行数。然后分成$k$段执行登机流程。在每个阶段，选择一个区域，座位在该区域的乘客将按照他们在初始队列中的顺序登机。

在上面的示例中，如果我们将平面划分为两个区域：第 $5-10$ 行和第$1-4$ 行，则在第一阶段，乘客将依次就座$6A、5F、10E、8B、5A$。在第二阶段，乘客将依次就座$4B、2E、2A、3F、1C$。登机的总难度为$6$。

帮助Peter找到将飞机划分为$k$个区域的方法，在给定特定乘客队列的情况下，将登机的总难度降至最低。

## 样例 #1

### 输入

```
10 12 2
6 4 2 5 2 3 1 11 8 5
```

### 输出

```
6
```

# 题解

## 作者：_2022gdgzby01 (赞：3)

# 题意
$n$ 个数字，范围是 $1\sim s$，需要将 $1\sim s$ 分成 $k$ 段，使得每个数字必然只属于一段。分别计算每段的正序对，求和即为答案，现在需要让这个和最小，求最小值。
# 分析：
既然有 $k$ 段这个限制，那么采用 DP 的时候必然需要将 $k$ 作为一个状态：所以状态表示为 $dp_{i,j}$，以 $i$ 为分段的最后一个数字，一共 $j$ 段的答案。因为状态转移一定是 $dp_{i,j}\to dp_{k,j+1}$，所以将第二维优化。状态转移的时候，需要求一下在 $[i+1,j]$ 区间内的正序对个数，这个可以预处理解决：对于一个正序对 $x-y$，在二维坐标中将 $(x,y)$ 值加一。最后求得时候，其实就是要 $x$ 和 $y$ 均在给定的区间内的正序对个数，就是在一个正方形内的点的个数，预处理出每个点到原点的矩形中点的个数即可。

---


# 「Cfz Round 6」Kyu-kurarin

## 题目背景

ちゃんと笑えなきゃね  
必须保持笑容才行啊

大した取り柄も無いから  
除此之外我一无所有

## 题目描述

Yuki 是一位魔法少女，她有着 $n$ 块冰，其中第 $i$ 块冰的质量为 $a_i$。

对于所有正整数 $t$：

- 第 $(t-0.5)$ 秒，Yuki 可以对最多 $k$ 块不同的**未完全融化**（即质量大于 $0$）的冰使用魔法，使它们的质量都增加 $1$；
- 第 $t$ 秒，每块冰都会发生融化，它们的质量都会减少 $1$。

Yuki 需要你求出最大的非负整数 $s$，满足在第 $s$ 秒及第 $s$ 秒前，Yuki 可以使用她的魔法从而使得每块冰都没有完全融化（即满足每块冰的质量始终大于 $0$）。

## 说明/提示

### 样例 1 解释

Yuki 可以这样使用魔法：

- 第 $0.5$ 秒时，Yuki 对第 $2$ 块冰使用魔法，此时 $3$ 块冰的质量分别为 $3,2,4$；
- 第 $1$ 秒时，所有冰发生融化，此时 $3$ 块冰的质量分别为 $2,1,3$；
- 第 $1.5$ 秒时，Yuki 对第 $2$ 块冰使用魔法，此时 $3$ 块冰的质量分别为 $2,2,3$；
- 第 $2$ 秒时，所有冰发生融化，此时 $3$ 块冰的质量分别为 $1,1,2$。

容易证明，在第 $3$ 秒时，一定有冰会完全融化，所以最大的满足要求的正整数 $s$ 等于 $2$。

### 样例 2

见题目附件中的 $\textbf{\textit{ice/ice2.in}}$ 与 $\textbf{\textit{ice/ice2.ans}}$。

该组样例满足测试点 $3$ 的限制。

### 样例 3

见题目附件中的 $\textbf{\textit{ice/ice3.in}}$ 与 $\textbf{\textit{ice/ice3.ans}}$。

该组样例满足测试点 $5$ 的限制。

### 样例 4

见题目附件中的 $\textbf{\textit{ice/ice4.in}}$ 与 $\textbf{\textit{ice/ice4.ans}}$。

该组样例满足测试点 $6$ 的限制。

### 样例 5

见题目附件中的 $\textbf{\textit{ice/ice5.in}}$ 与 $\textbf{\textit{ice/ice5.ans}}$。

该组样例满足测试点 $9$ 的限制。

### 样例 6

见题目附件中的 $\textbf{\textit{ice/ice6.in}}$ 与 $\textbf{\textit{ice/ice6.ans}}$。

该组样例满足测试点 $10$ 的限制。

### 数据范围

对于所有测试数据：

- $2 \le n \le 10^6$；
- $1 \le k \le n-1$；
- $1 \le a_i \le 10^6$。

|测试点编号|$n\le$|$k\le$|$a_i \le$|特殊性质|
|:---:|:---:|:---:|:---:|:---:|
|$1$|$2$|$1$|$10^6$|否|
|$2$|$10^3$|$1$|$10^3$|是|
|$3$|$10^3$|$1$|$10^3$|否|
|$4$|$10^3$|$n-1$|$10^3$|是|
|$5$|$10^3$|$n-1$|$10^3$|否|
|$6$|$10^6$|$1$|$10^6$|是|
|$7$|$10^6$|$1$|$10^6$|否|
|$8$|$10^6$|$10$|$10^6$|否|
|$9$|$10^6$|$n-1$|$10^6$|是|
|$10$|$10^6$|$n-1$|$10^6$|否|

特殊性质：保证所有冰的质量相等，即 $a_1=a_2=\dots=a_n$。


## 样例 #1

### 输入

```
3 1
3 1 4```

### 输出

```
2```

# 题解

## 作者：McIron233 (赞：39)

$10$ 分做法。

只有两块冰，并且一次只能对一块进行增加质量的操作。那么每次操作质量较小的即可。发现最终是两块冰的质量都变为 $1$。答案就是两块冰质量总和减去 $2$。

$40$ 分做法。

考虑使用贪心，我们每一秒前的 $0.5$ 秒，都选择“潜在存活时间”最短的那 $k$ 块冰，并将它们的质量增加 $1$。显然，“潜在存活时间”最短的冰，就是当前质量最小的冰。

最终，会有至少 $k+1$ 块冰的质量为 $1$。该时刻即为答案的后一个时刻。

实现上，我们可以开一个 $\texttt{multiset}$ 然后每次从中挑出 $k+1$ 个最小的。当这里面最大值是 $1$ 时，停止循环并输出答案，否则将这个最大值以及剩下的所有数都减去 $1$ 然后重新扔进 $\texttt{multiset}$ 中。另一个实现方法是，在上述方法中将 $\texttt{multiset}$ 改为数组并排序。

满分做法。

我们发现，根据上述贪心做法，设答案为 $A$，则 $0$ 到 $A$ 这些时刻都是保证所有冰的质量大于 $0$ 的，而 $A$ 之后的时刻都不能满足，故答案具有单调性。

考虑二分答案。对于一个二分检验值 $V$，我们要做的就是判断从 $0$ 到 $V$ 这段时间内是否可以做到符合题意。由于每一秒每一块的冰的质量都会减少 $1$，所以我们可以先给每块冰减少 $V$ 的质量。这样只需要判断是否可以通过 $V$ 次增加质量的操作使得每一块冰的质量大于 $0$ 即可。显然，一块质量减少 $V$ 的冰，最多需要 $V$ 次增加质量的操作，所以不需要考虑同时性的问题。那么，只需要判断需要增加的质量总和是否足够操作即可。足够操作时，这些增加的质量总和一定不会超过 $kV$。

实现时，需要注意二分的左边界和右边界。左边界需要是 $0$，而右边界需要比较大。

---


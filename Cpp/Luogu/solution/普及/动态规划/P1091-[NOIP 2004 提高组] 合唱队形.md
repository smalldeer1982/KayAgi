# [NOIP 2004 提高组] 合唱队形

## 题目描述

$n$ 位同学站成一排，音乐老师要请其中的 $n-k$ 位同学出列，使得剩下的 $k$ 位同学排成合唱队形。

合唱队形是指这样的一种队形：设 $k$ 位同学从左到右依次编号为 $1,2,$ … $,k$，他们的身高分别为 $t_1,t_2,$ … $,t_k$，则他们的身高满足 $t_1< \cdots <t_i>t_{i+1}>$ … $>t_k(1\le i\le k)$。

你的任务是，已知所有 $n$ 位同学的身高，计算最少需要几位同学出列，可以使得剩下的同学排成合唱队形。

## 说明/提示

对于 $50\%$ 的数据，保证有 $n \le 20$。

对于全部的数据，保证有 $n \le 100$。


## 样例 #1

### 输入

```
8
186 186 150 200 160 130 197 220
```

### 输出

```
4
```

# 题解

## 作者：shinzanmono (赞：0)

设 $f_i$ 表示以 $a_i$ 结尾的最长上升子序列长度，$g_i$ 表示以 $a_i$ 开头的最长下降子序列长度。则答案为 $\max\limits_{i=1}^n\{n-f_i-g_i+1\}$.

$f_i$ 和 $g_i$ 的转移方程显然：$f_i=\max\limits_{j<i,a_j<a_i}f_{j}+1$，$g_i=\max\limits_{j>i,a_j<a_i}g_j+1$。其中 $a_0=a_{n+1}=0$。

然后按照如上的做法 dp 即可。时间复杂度是 $O(n^2)$。

当然，如果对上述转移进行优化的话，可以做到 $O(n\log n)$。

---


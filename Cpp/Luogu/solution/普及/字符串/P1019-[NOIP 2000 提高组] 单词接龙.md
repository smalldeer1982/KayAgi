# [NOIP 2000 提高组] 单词接龙

## 题目背景

注意：本题为上古 NOIP 原题，不保证存在靠谱的做法能通过该数据范围下的所有数据。

本题为搜索题，本题不接受 hack 数据。[关于此类题目的详细内容](https://www.luogu.com.cn/paste/isdgwj5l)

NOIP2000 提高组 T3

## 题目描述

单词接龙是一个与我们经常玩的成语接龙相类似的游戏，现在我们已知一组单词，且给定一个开头的字母，要求出以这个字母开头的最长的“龙”（每个单词都最多在“龙”中出现两次），在两个单词相连时，其重合部分合为一部分，例如 `beast` 和 `astonish`，如果接成一条龙则变为 `beastonish`，另外相邻的两部分不能存在包含关系，例如 `at` 和 `atide` 间不能相连。


## 说明/提示

样例解释：连成的“龙”为 `atoucheatactactouchoose`。

$n \le 20$。

## 样例 #1

### 输入

```
5
at
touch
cheat
choose
tact
a
```

### 输出

```
23
```

# 题解

## 作者：RyanLi (赞：1)

传送门：[P1019 [NOIP 2000 提高组] 单词接龙](https://www.luogu.com.cn/problem/P1019)

更佳的阅读体验：[洛谷 P1019 题解](https://blog.ryanli.top/index.php/archives/248/)

---

题目没有给字符串的数据范围，但有 $n \le 20$，尝试搜索发现可以通过本题。

在搜索时处理重合部分为本题难点，需要留意截取字串的边界问题（即下文代码 `dfs()` 函数中的 $i$ 和 $j$）。

```cpp
#include <iostream>
using namespace std;

const int N = 30;
int n, vis[N], ans;
string s[N];
char c;

void dfs(const string &tmp) {
    ans = max(ans, int(tmp.size()));
    for (int i = 1; i <= n; ++i) {
        if (vis[i] >= 2) continue;
        for (int j = 1; j < min(tmp.size(), s[i].size()); ++j)
            if (tmp.substr(tmp.size() - j) == s[i].substr(0, j)) {
                ++vis[i];
                dfs(tmp + s[i].substr(j));
                --vis[i];
            }
    }
}

int main() {
    cin.tie(nullptr);
    ios::sync_with_stdio(false);
    cin >> n;
    for (int i = 1; i <= n; ++i) cin >> s[i];
    cin >> c;
    for (int i = 1; i <= n; ++i) if (s[i][0] == c) {
        ++vis[i];
        dfs(s[i]);
        --vis[i];
    } cout << ans << '\n';
    return 0;
}
```

---

## 作者：SuyctidohanQ (赞：1)

### 思路分析

本题为搜索。考虑使用 `dfs` 枚举以指定字母开头的单词开始，连接所有可能的单词的单词串的长度。

注意还需要使用一个数组保证每个单词使用次数不超过 $2$ 次。

### 代码实现

```cpp
#include <map>
#include <set>
#include <queue>
#include <cmath>
#include <vector>
#include <cstdio>
#include <cstring>
#include <iostream>
#include <algorithm>
#include <unordered_map>
#include <unordered_set>
#include <bits/stdc++.h>

#define unmap unordered_map
#define unset unordered_set
#define muset multiset
#define ll long long
#define unint unsigned int
#define ull unsigned ll
#define please return
#define AC 0
#define il inline
#define cst const
#define db double
#define ld long db
#define pii pair<int,int>
#define pll pair<ll,ll>
#define gch getchar
#define pch putchar
#define str string

#define rep(i, a, b) for (int i = a; i <= b; i++)
#define repr(i, a, b) for (int i = a; i >= b; i--)

// #define int long long

using namespace std;

// cst int INF = 9223372036854775807;
// cst int inf = 2147483647;
// cst int xinf = 0x3f3f3f3f;
// cst int XINF = 0x3f3f3f3f3f3f3f3fll;
cst int MAXN = 20 + 10;
cst db pi = acos (-1.0), eps = 1e-12;

il int _abs (int a) { if (a < 0) return -a; return a; }
il int _pow (int a, int b) { int x = 1, y = a; while(b > 0) {if (b & 1) x *= y; y *= y; b >>= 1; } return x; }

int read () { int sum = 0, f = 1; char ch; ch = gch (); while (ch < '0' || ch > '9') { if (ch == '-') f = -1; ch = gch ();} while (ch >= '0' && ch <= '9') {  sum = sum * 10 + ch - '0'; ch = gch ();} return sum * f;}
void print (int x) { if (x < 0) { pch ('-'); x = -x;} if (x > 9) print (x / 10); pch (x % 10 + '0'); return ;}

str S[MAXN];

int n, ans = 0, cnt[MAXN];

char c;

int check (string x, string y) {
	
	string a = "", b = "";
	
	rep(i, 1, min (x.size (), y.size ()) - 1) {
		
		// cout << min (x.size (), y.size ()) << " -- min (x.size (), y.size ()) " << endl;
		
		a = x.substr (x.size () - i, i);
		
		b = y.substr (0, i);
		
		if (a == b) return i;
		
	}
	
	return 0;
}

void dfs (str s, int len) {
	
	ans = max (ans, len);
	
	// cout << ans << " -- ans " << endl;
	
	int x;
	
	for (int i = 1; i <= n; i ++) {
		
		x = check (s, S[i]);
		
		// cout << x << " -- x " << endl;
		
		if (cnt[i] < 2 && x != 0) {
			
			// cout << "true" << endl;
			
			cnt[i] ++;
			
			// cout << cnt[i] << " -- cnt[i] " << endl;
			
			dfs (S[i], len + S[i].size () - x);
			
			// cout << len + S[i].size () - x << " -- len + S[i].size () - x " << endl;
			
			cnt[i] --;
			
			// cout << cnt[i] << " -- cnt[i] " << endl;
			
		}
		
	}
	
}

signed main (void) {
	
	cin >> n;
	
	rep(i, 1, n) cin >> S[i];
	
	cin >> c;
	
	// cout << c << " -- c " << endl;
	
	rep(i, 1, n) {
		
		if (S[i][0] == c) {
			
			cnt[i] ++;
			
			// cout << cnt[i] << " -- cnt[i] " << endl; 
			
			dfs (S[i], S[i].size ());
			
			cnt[i] --;
			
		}
		
	}

    cout << ans << endl;
	
	please AC;
}
```

---


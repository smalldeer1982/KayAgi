# [ROIR 2025] 平方差

## 题目背景

翻译自 [ROIR 2025 D2T1](https://neerc.ifmo.ru/school/archive/2024-2025/ru-olymp-regional-2025-day2.pdf)。

## 题目描述

给定 $l$，$r$ 和 $d$，求有多少个自然数对 $(x,y)$ 满足 $l \leq y^2 < x^2 \leq r$ 且 $x^2-y^2=d$。

## 说明/提示

样例解释：

在第一个样例中，符合条件的数对是 $(10,6)$。  
在第二个样例中，符合条件的数对还有 $(17,15)%loj 上样例解释有误$。

本题使用 Subtask 捆绑测试。数据中 Subtask 0 是样例。

| 子任务 | 分数 | 特殊性质 |
|:---:|:---:|:---:|
| $1  $ |$ 18  $| $1 \leq d \leq 10^3$, $1 \leq l \leq r \leq 10^3$  | 第一子任务 |
| $2  $ | $19  $| $1 \leq d \leq 10^5$, $1 \leq l \leq r \leq 10^5$  | 第一、二子任务 |
| $3  $ | $20  $| $1 \leq d \leq 10^7$, $1 \leq l \leq r \leq 10^7$  | 第一、二、三子任务 |
| $4  $ | $21 $ | $1 \leq d \leq 10^9$, $1 \leq l \leq r \leq 10^{10}$  | 第一至三子任务 |
| $5 $  | $22$  | 无 | 第一至四子任务 |

## 样例 #1

### 输入

```
64 1 100```

### 输出

```
1```

## 样例 #2

### 输入

```
64 1 300```

### 输出

```
2```

# 题解

## 作者：wzb13958817049 (赞：10)

# 思路
由题目标题的提示不难想到平方差公式 $x^2 - y^2 = ( x + y ) \times ( x - y )$，可知枚举的 $x + y$ 和 $x - y$ 都是 $d$ 的因数，所以我们可以枚举 $d$ 的因数从而达到 $O(\sqrt{d})$。
# 代码

```cpp
#include<bits/stdc++.h>
#define ll long long
using namespace std;
ll l,r,d,ans;
int main(){
	ios::sync_with_stdio(0),cout.tie(0),cin.tie(0);
	cin>>d>>l>>r;
	for(int i=1;i*i<=d;i++){
		if(d%i==0){
			//x+y=i x-y=d/i;
			if((i+d/i)%2==0){
				ll x=(i+d/i)/2;
				ll y=x-i;
				if(y*y<x*x && l<=y*y && x*x<=r) ans++;
			}
		}
	}
	cout<<ans;
	return 0;
}
```

---

## 作者：2011hym (赞：6)

这道题属实是有点坑人了嗷。

## 题目分析

我们需要找到求有多少个自然数对  $l \leq y^2 < x^2 \leq r$ 且 $x^2-y^2=d$。

因为输入的三个数数据范围很大，所以我们要考虑优化。

### 优化思路
1. 因式分解：依据平方差公式将 $x^2-y^2=d$ 化简为 $(x+y)(x-y)=d$。
2. 枚举数对：枚举所有的因数对 $(a,b)$ 满足 $a\times b=d$ 并且 $a\leq b$。
3. 可列出等量关系并求解。

此时时间复杂度为 $O(\sqrt d)$，可以通过。

## 直接上代码

```cpp
#include <bits/stdc++.h>
using namespace std;
//#define int long long  用这个可以将int转化成long long。
long long d, l, r, Dev_C;//记得用long long。
int main() {
    cin >> d >> l >> r;
    for (long long a = 1; a * a <= d; a++) {
        if (d % a == 0) {
            long long b = d / a;
            if ((a + b) % 2 == 0 && (b - a) % 2 == 0) {
                long long x = (a + b) / 2;
                long long y = (b - a) / 2;
                if (l <= y * y && x * x <= r && y * y < x * x) {//根据题目中给出的公式计算。
                    Dev_C++;//嘻嘻。
                }
            }
        }
    }
    cout << Dev_C;
    return 0;
}
```

这就完事了。

---

## 作者：Temp113 (赞：4)

## Solution

求自然数对 $(x,y)$ 满足 $l \le y^2 < x^2 \le r$ 且 $x^2 - y^2 = d$ 的个数。其中，$1 \le d \le 10^9$，$1 \le l \le r \le 10^{18}$。

$1 \le d \le 10^9$，于是考虑 $x^2 - y^2 = d$，可变为 $(x+y) \times (x-y) = d$，因此枚举 $d$ 的因数。又因 $x,y$ 均为自然数，则 $x+y > x-y$，所以可直接从 $1 \sim \sqrt{d} - 1$ 枚举 $x-y$。

因此，其转换为关于 $x,y$ 的二元一次方程组：

$$\begin{cases} x+y = t_1 \\ x-y = t_2 \end{cases}$$

显然：两式相加得 $2x = t_1 + t_2$，即 $x = \frac{t_1 + t_2}{2}$。两式相减得 $2y = t_1 - t_2$，即 $y = \frac{t_1 - t_2}{2}$。因为 $x,y,t_1,t_2$ 均为整数，所以判断 $t_1 + t_2$ 是否被 $2$ 整除。

再将此时的 $x,y$ 代入 $l \le y^2 < x^2 \le r$ 判断是否满足。

## Code

```cpp
#include<bits/stdc++.h>
using namespace std;
#define int long long
int d, l, r, tmp1, tmp2, x, y, ans;
signed main(){
	scanf("%lld %lld %lld", &d, &l, &r);
	for(int i = 1; i * i < d; i++){
		if(d % i) continue;
		tmp1 = d / i;
		tmp2 = i;
		if((tmp1 + tmp2) & 1) continue;
		x = ((tmp1 + tmp2) >> 1);
		y = ((tmp1 - tmp2) >> 1);
		if(l <= y * y && x * x <= r) ans++;
	}
	printf("%lld", ans);
	return 0;
}
```

---

## 作者：M1__ (赞：3)

# 题解：P11701 [ROIR 2025] 平方差
[题目传送门](https://www.luogu.com.cn/problem/P11701)                     

赛时被创飞了，所以应当好好想一下这样的题该怎么做。
## 题目思路
### 朴素算法
按题意模拟即可。但是显然会炸。

```cpp
#include<bits/stdc++.h>
using namespace std;
typedef long long ll;
ll l,r,d,cnt=0;
int main(){
	cin>>d>>l>>r;
	for(int i=l;i<=sqrt(r);i++){
		for(int j=i;j<=sqrt(r);j++){
			if((j+i)*(j-i)==d) cnt++;
		}
	}	
	cout<<cnt;
	return 0;
}
```
时间复杂度 $O(n^{2})$。
### 优化

>平方差公式：$(a+b)(a-b)=a^2-b^2$。

由题可得 $x^2-y^2=d$ 可以变成 $(x-y)(x+y)=d$。                            
令 $a=x-y$，$b=x+y=\frac{d}{a}$，则一定满足 $a < b$ 且 $a \cdot b = d$。所以枚举 $a$ 即可。枚举范围 $\left[1,\sqrt{d}\right)$。              
又可得 $x=\frac{a+b}{2}$，$y=\frac{b-a}{2}$，判断是否满足 $l \le y^2 < x^2 \le r$ 即可。                
注意为了使 $x$ 和 $y$ 为整数，$a$ 和 $b$ 的奇偶性必须相同。               
时间复杂度 $O(\sqrt{d})$。


```cpp
#include <bits/stdc++.h>
using namespace std;
typedef long long ll;
ll d,l,r,cnt;
int main() {
    cin>>d>>l>>r;
    for (ll a=1;a<sqrt(d);a++) {
        if(d%a!=0) continue;
        ll b=d/a;
        if((a%2)!=(b%2)) continue;
        ll x=(a+b)/2;
        ll y=(b-a)/2;
        if(y*y>=l&&x*x<=r&&y*y<x*x) cnt++;
    }
    cout<<cnt;
    return 0;
}
```

---

## 作者：Besheep (赞：3)

$\texttt{update\ 2.10}$ 修改一点错误。

很好的数学题。

## 思路

观察到 $1 \leq d \leq 10^9$，$1 \leq l \leq r \leq 10^{18}$，$l,r$ 太大，于是从 $d$ 入手。

不难发现 $x^2-y^2=d$ 为平方差公式，可化为 $(x+y)(x-y)=d$。

于是，我们可以把 $d$ 改成两数相乘的形式，并且 $x+y > x-y$，我们只需要从 $1 \sim \sqrt{d}$ 枚举 $x-y$ 的值。

求出 $x-y$ 的值进而可以求出 $x+y$ 的值，所以$\frac{(x+y)+(x-y)}{2}$ 的值即为 $x$ 的值。

已知 $x$ 的值，可求 $x^2$，继而可求 $y^2$ 的值，随后判断 $y$ 为整数且满足 $l \leq y^2 < x^2 \leq r$ 即可。

## 代码
```cpp
#include <bits/stdc++.h>
using namespace std;
const int N=1e6+10;
#define ll long long
ll d,l,r,ans;
int main() {
    cin>>d>>l>>r;
    for(int i=1;i*i<=d;i++){
    	ll temp=d/i;
    	if(temp*i==d){
    		ll x=(temp+i)/2;
    		if(x*2==temp+i){
    			ll y=x*x-d;
    			double t=sqrt(y);
    			if(int(t)==t){
    				if(l<=y&&x*x<=r)ans++;
				}
			}
	 	}
	}
	cout<<ans;
	return 0;
}
```

---

## 作者：canwen (赞：2)

## Solution
注意力惊人。

老套路了，$x^2-y^2=(x+y)(x-y)=d$。

同时注意到 $l,r$ 的范围，而 $d \le 10^{9}$。

考虑 $O(\sqrt{d})$ 的做法。

枚举 $i=x+y$ 使得 $d \bmod i=0$，那么 $x-y = \frac{d}{i}$。

合并两式子，则有 $x=\frac{i+\frac{d}{i}}{2},y = i-x$。

那么判断合法即可。

PS：如果你只是在 $l,r$ 两个值域上考虑的话，那么最多可以拿到 $70$ 分。

## Code
```cpp
#include <bits/stdc++.h>
using namespace std;
#define int long long
#define _rep(i,a,b) for(int i=(a);i<=(b);++i)
#define _reps(i,a,b,c) for(int i=(a);i<=(b);c)
#define _rrep(i,a,b) for(int i=(a);i>=(b);--i)
#define _rreps(i,a,b,c) for(int i=(a);i>=(b);c)
#define _graph(i) for(int i=head[u];i;i=e[i].nxt)
#define FRR(file) freopen(file,"r",stdin)
#define FRW(file) freopen(file,"w",stdout)
#define pb push_back
#define mk make_pair
#define fst first
#define snd second
#define pc putchar('\n')
#define nowtime (double)clock()/CLOCKS_PER_SEC
int in(){int k=0,kk=1;char a=getchar();while(!isdigit(a)){if(a=='-') kk=-1;a=getchar();}while(isdigit(a))k=(k<<3)+(k<<1)+a-'0',a=getchar();return k*kk;}
void out(int a){if(a<0) putchar('-'),a=-a;if(a>9) out(a/10);putchar('0'+a%10);}

signed main(){
	int d=in(),l=in(),r=in(),ans=0;
	for(int i=1;i*i<=d;i++){
		if(d % i != 0) continue;
		int a = d/i;
		int x = (i+a)/2, y = i-x;
		if(x*x>=l&&x*x<=r&&y*y>=l&&y*y<=r&&y*y<x*x&&x*x-y*y==d) ans++;
	}
	cout << ans;
	return 0;
}
```

---

## 作者：jcf666 (赞：2)

# 题目大意
求有多少个自然数对 $(x,y)$ 满足 $l \le y^2 < x^2 \le r$ 且 $x^2-y^2=d$。
# 解题思路
利用七年级下册的知识把 $x^2 - y^2 = d$ 改写成 $(x−y)(x+y)=d$，我们需要枚举 $d$ 的因数去寻找所有满足 $(x-y)$ 和 $(x+y)$ 的组合。我们假设 $d=a \times b$ 且 $a \le b$ 那么可以得到一个方程：
$$\begin{cases}
x-y=a\\
x+y=b\\
\end{cases}
$$
用加减消元法解方程解得 $x= \frac{a+b}{2}$ 和 $y= \frac{b-a}{2}$，注意，这里的 $x$ 和 $y$ 必须是自然数而不是小数，所以得特判 $a+b$ 和 $b-a$ 是否能被 $2$ 整除。

最后，我们得出了一组自然数对 $(x,y)$，只需要判断这个数对是否满足 $l \le y^2 < x^2 \le r$ 且 $x^2-y^2=d$ 就行了。

时间复杂度 $O(\sqrt{d})$ 可以通过此题。

```cpp
#include<bits/stdc++.h>
#define int long long//不要忘记开long long
using namespace std;
int d,l,r,cnt,b,x,y;
signed main(){
	ios::sync_with_stdio(0),cin.tie(0),cout.tie(0);
	cin>>d>>l>>r;
	for(int i=1;i*i<=d;i++){
		if(d%i==0){
			b=d/i;
			if((i+b)%2==0&&(b-i)%2==0){
				x=(i+b)/2;
				y=(b-i)/2;
				if(l<=y*y&&y*y<x*x&&x*x<=r)cnt++;
			}
		}
	}
	cout<<cnt;
	return 0;
}

```

---

## 作者：Aventurine_stone (赞：1)

## 1. 题目分析
由于 $l$ 和 $r$ 范围很大，所以这是一道数学题。
## 2. 题目做法
我们可以看到 $d$ 的范围较小，所以从它入手。  
题目中要 $x^2 - y^2 = d$，我们将其化简为 $(x + y)\times(x - y) = d$。  
然后设 $x + y = a$，$x - y = b$。那么可得以下三个式子：$a\times b = d$，$x = \frac{a + b}{2}$，$y = \frac{a - b}{2}$。  
通过上面三个式子，我们可以想到分解 $d$ 的因数，设 $d$ 的两个因数 $a$ 和 $b$ 满足 $a\times b = d$，那么如果 $a + b$ 为偶数，且求出来的 $x^2$ 和 $y^2$ 在 $l$ 到 $r$ 之间，则满足条件的数量加一。  
时间复杂度 $O(\sqrt{n})$。
## 3. 代码

```cpp
#include<bits/stdc++.h>
#define ll long long
using namespace std;
const int N=110;
inline int read()
{
	int x=0;
	char c=getchar();
	while(c<'0'||c>'9')
		c=getchar();
	while(c>='0'&&c<='9')
		x=(x<<1)+(x<<3)+c-'0',c=getchar();
	return x;
}
inline ll readl()
{
	ll x=0;
	char c=getchar();
	while(c<'0'||c>'9')
		c=getchar();
	while(c>='0'&&c<='9')
		x=(x<<1)+(x<<3)+c-'0',c=getchar();
	return x;
}
ll l,r;
int s,d,sq;
int main()
{
	d=read(),l=readl(),r=readl();
	sq=sqrt(d);
	for(int i=1;i<=sq;i++)
	{
		if(!(d%i))
		{
			int t=d/i;
			if(!((i+t)&1))
			{
				ll mn=((t-i)>>1),mx=((t+i)>>1);
				s+=(mn*mn>=l&&mx*mx<=r);
			}
		}
	}
	printf("%d",s);
	return 0;
}
```

---

## 作者：114514xxx (赞：1)

简单数学题。

注意到 $x^2-y^2=d$ 等价于 $(x-y)(x+y)=d$。

因此 $x+y$ 和 $x-y$ 是 $d$ 的因子。我们就只需要对 $d$ 进行因数分解即可。时间复杂度 $O(\sqrt d)$。

在得出 $x+y$ 和 $x-y$ 的值后就可以将 $x$ 和 $y$ 解出来。注意要判断 $x$ 和 $y$ 是否是整数。

```cpp
#include<bits/stdc++.h>
#define int long long
using namespace std;
const int N=1e3+25;
int l,r,d;
int f2[N],f1[N];
signed main(){
    ios::sync_with_stdio(0);
    cin.tie(0),cout.tie(0);
    cin>>d>>l>>r;
    int num=0;
    for(int i=1;i*i<=d;i++)
        if(d%i==0)f1[++num]=i,f2[num]=(int)d/i;//对 d 进行分解
    //f1[i]表示 x-y，f2[i]表示 x+y
    int ans=0;
    for(int i=1;i<=num;i++){
        int k1=(f1[i]+f2[i]),k2=(f2[i]-f1[i]);
        bool p1=(k1*k1>=4*l&&k1*k1<=4*r);
        bool p2=(k2*k2>=4*l&&k2*k2<=4*r);
        bool p3=k1&1,p4=k2&1;//保证 x 和 y 是整数
        if(p1&&p2&&!p3&&!p4)++ans;
    }
    cout<<ans;
}

```

---

## 作者：what_can_I_do (赞：0)

[传送门](https://www.luogu.com.cn/problem/P11701)

由 $x^2-y^2=d$ 得 $(x-y)\times(x+y)=d$，于是枚举 $d$ 的因数，对于每一个因数可以求出 $x$ 和 $y$ 的值，如果 $(x-y)+(x+y)$ 是奇数则 $x$ 和 $y$ 不为整数，否则就可以解方程求 $x$ 和 $y$，然后判一下是否在题目要求的范围内就行了，是的话答案加一。

# CODE：
```cpp
#include<bits/stdc++.h>
#define ll long long
using namespace std;
ll d,l,r,ans=0;
int main()
{
	scanf("%lld%lld%lld",&d,&l,&r);
	for(register ll i=1;i*i<=d;i++)
	{
		if(d%i) continue;
		ll a=i,b=d/i;
		if((a+b)&1) continue;
		ll x=(a+b)>>1,y=(b-a)>>1;
		if(l<=y*y&&y<x&&x*x<=r) ans++;
	}
	printf("%lld\n",ans);
	return 0;
}
```

---

## 作者：DashZhanghanxu (赞：0)

# 解析
题目表明我们需要找到满足以下条件的自然数对 $(x,y)$：
$$
l\leq y^{2}<x^{2}\leq r
$$
$$
x^{2}-y^{2}=d
$$
我们可以将第二个条件 $x^{2}-y^{2}=d$ 进行因式分解，得到：
$$
x^{2}-y^{2}=(x - y)(x + y)=d
$$
设 $a = x - y$ 和 $b = x + y$，那么我们有：
$$
a\times b=d
$$
并且由于 $x$ 和 $y$ 是自然数，$a$ 和 $b$ 必须满足以下条件：

1. $a < b$（因为 $x>y$）。

2. $a$ 和 $b$ 必须同时为奇数或同时为偶数（因为 $x$ 和 $y$ 是整数）。

接下来，我们可以枚举 $d$ 的所有因子对 $(a,b)$，并检查是否满足以下三个条件：

1. $a < b$

2. $a$ 和 $b$ 同时为奇数或同时为偶数，


3. $l\leq y^{2}<x^{2}\leq r$

对于每一对满足条件的 $(a,b)$，我们可以计算出 $x$ 和 $y$：
$$
x = \frac{a + b}{2}
$$
$$
y = \frac{b - a}{2}
$$

然后检查 $l\leq y^{2}<x^{2}\leq r$ 是否成立。

具体方法如下：

枚举 $d$ 的所有因子对 $(a,b)$：对于每个 $a$ 是 $d$ 的因子，且 $a\leq\sqrt{d}$，计算 $b=\frac{d}{a}$，检查 $a < b$ 且 $a$ 和 $b$ 同时为奇数或同时为偶数。

计算 $x$ 和 $y$：对于每一对满足条件的 $(a,b)$，计算 $x=\frac{a + b}{2}$ 和 $y=\frac{b - a}{2}$。

检查 $l\leq y^{2}<x^{2}\leq r$：如果满足条件，则 $count=count + 1$。最终输出满足条件的 $(x,y)$ 的数量。
# CODE
```cpp
#include<bits/stdc++.h>
#define ll long long
using namespace std;
int main(){
    ll d,l,r;
    cin>>d>>l>>r;
    ll count=0;
    for(ll a=1;a<=sqrt(d);a++){
        if(d%a==0){
            ll b=d/a;
            if(a<b&&(a%2==b%2)){
                ll x=(a+b)/2;
                ll y=(b-a)/2;
                if(l<=y*y&&y*y<x*x&&x*x<=r){
                    count++;
                }
            }
        }
    }
    cout<<count<<endl;
    return 0;
}
```

---

## 作者：StormWhip (赞：0)

### 思路 
由题意变形得 $(x+y)(x-y)=d$，一一找出 $d$ 的一个小于 $\sqrt{d}$ 的因子 $p$，令其为 $x-y$，则可算出 $x+y$，解出 $x$ 和 $y$ 后判断其是否符合条件即可。时间复杂度 $O(\sqrt{d})$，可以通过本题。  

### 代码 

```cpp
#include<bits/stdc++.h>
#define int long long
using namespace std;
int l,r,d,ans;
signed main()
{
	ios::sync_with_stdio(0);
	cin.tie(0);
	cout.tie(0);
	cin>>d>>l>>r;
	for(int i=1;i*i<=d;i++)
		if(d%i==0)//i=x-y
		{
			if((i+d/i)&1) continue;
			int t=d/i,x=(i+t)/2,y=x-i,n=x*x,m=y*y;//t=x+y
			if(n>=l&&n<=r&&m>=l&&m<=r&&n>m) ans++;
		}
	cout<<ans<<"\n";
	return 0;
}
```

---

## 作者：AFO_Lzx (赞：0)

## [题目传送门](https://www.luogu.com.cn/problem/P11701)

看到数据范围就知道暴力枚举是绝对会 TLE 的，考虑正解。

先运用平方差公式可以知道：$(x+y)(x-y)=d$。我们设 $a=x-y$ 且 $b=x+y$，所以 $a \times b=d$，可以得到 $b=\frac{d}{a}$。

我们还要满足 $a$ 与 $b$ 的奇偶性相同，因为：
$$\begin{cases}x=(a+b)\div2\\y=(b-a)\div2\end{cases}$$
且 $x,y$ 均为整数。

最后检查 $x^2$ 和 $y^2$ 是否满足 $l \le y^2 < x^2 \le r$ 即可。实现方式为枚举 $a$ 的取值，时间复杂度 $O(\sqrt{d})$，可以轻松通过。

代码在此，此题较为简单。

```cpp
#include<bits/stdc++.h>
#define int long long
using namespace std;

signed main() {
	ios::sync_with_stdio(0);
	cin.tie(0), cout.tie(0);
	
	int d, l, r;
	cin >> d >> l >> r;
	
	int ans = 0;
	for (int a = 1; a <= d / a; a++) {
		if (d % a == 0) {
			int b = d / a;
			if (a % 2 == b % 2) {
				int x = (a + b) / 2;
				int y = (b - a) / 2;
				int m = x * x, n = y * y;
				if (l <= n && n < m && m <= r) ans++;
			}
		}
	}
	
	cout << ans << endl;
	return 0;
}
```

---

## 作者：ran_qwq (赞：0)

注意到平方差公式 $d=x^2-y_2=(x+y)(x-y)$。即 $x+y$ 和 $x-y$ 为 $d$ 的因数。

直接枚举其中一个，解出 $x,y$ 并判断是否满足条件。

时间复杂度 $O(\sqrt d)$。

```cpp
int d=rd(); ll l=rdll(),r=rdll();
int sol(int p) {
	int q=d/p; if(p+q&1) return 0; int x=p+q>>1,y=q-x;
	return x>0&&y>0&&1ll*y*y>=l&&1ll*y*y<=r&&1ll*x*x>=l&&1ll*x*x<=r&&y<x;
}
void QwQ() {
	int as=0;
	for(int i=1;i*i<=d;i++) if(d%i==0) as+=sol(i)+(i*i!=d?sol(d/i):0);
	wr(as,"\n");
}
```

---

## 作者：Dream_poetry (赞：0)

### 思路

简单数学题。

对于 $x^2-y^2=d$ 这条限制，我们由平方差公式变型得 $(x+y)(x-y)=d$。

这启发我们枚举 $d$ 的因子。

假设我们找到 $d$ 的两个正整数因子 $a,b(a<b)$，我们可以构造二元一次方程组，解得 $x=\dfrac{a+b}{2},y=\dfrac{b-a}{2}$。

再判断一下是否超过 $l,r$ 的边界限制即可。

时间复杂度 $O(\sqrt d)$。

**小问题：**

因为有除法操作，所以务必要判断 $a,b$ 奇偶性是否相同，另外因为 $y^2 < x^2$，所以**不要**枚举到 $\sqrt d$。

### 代码：


```cpp
#include<bits/stdc++.h>
using namespace std;
#define int long long
int d,l,r;
int ans;


signed main(){
	cin>>d>>l>>r;
	for (int i=1;i*i<d;i++){
		if (d%i) continue;
		int x=i;
		int y=d/i;
		if ((x+y)%2) continue;
		int u=(x+y)/2;
		int v=y-u;
		if (u>v){
			swap(u,v);
		}
		if (u*u>=l && v*v<=r && u*u<v*v){
			ans++;
		}
	}	
	cout<<ans;
	return 0;
}
```

---

## 作者：huanglihuan (赞：0)

### Solution
感觉没有黄吧……  
建议降橙。  
小学数学题。  
枚举 $d$ 的因数，这个可以做到 $O(\sqrt d)$，快排使其单调递增，时间是代码中的 $cnt\log cnt$，以 $d$ 以内的质数个数是不会超的。  
接下来通过平方差公式，即 $x^2-y^2=(x+y)\times(x-y)$ 计算当前的一组数是否合法。  
该做法的时间复杂度瓶颈在于 $d$ 以内的质数个数，但由于 $d\le10^9$ 所以不会超。
### Code
```cpp
#include <bits/stdc++.h>
#include <cstdio>
#define int long long
#define ull unsigned long long
#define mod 988444333
#define MOD 1000000007
#define in(x,y,z) x>=y&&x<=z
using namespace std;
const int N = 2e6 + 5;
int f [N];
inline int read ()
{
	int x = 0;
	char c = getchar ();
	while (c < '0' || c > '9') c = getchar ();
	while (c >= '0' && c <= '9') x = (x << 1) + (x << 3) + (c ^ 48),c = getchar ();
	return x;
}
inline void write (int x)
{
	if (x > 9) write (x / 10);
	putchar (x % 10 + '0');
	return ;
}
signed main ()
{
	int d,l,r;
	cin >> d >> l >> r;
	int cnt = 0;
	for (int i = 1;i * i <= d;i ++)
	{
		if (d % i == 0) f [++ cnt] = i;
		if (i * i != d) f [++ cnt] = d / i;
	}
	sort (f + 1,f + cnt + 1);
	int ans = 0;
	for (int i = 1;i <= cnt;i ++)
	{
		int a = f [i];
		int b = d / f [i];
		if (a > b) break;
		int x = (a + b) / 2;
		int y = (b - a) / 2;
		if (a + b & 1 > 0) continue;
		if (l <= y * y && x * x <= r) ans ++;
	}
	cout << ans;
	return 0;
}
```

---

## 作者：chengjindong (赞：0)

[题目](https://www.luogu.com.cn/problem/P11701)

$x^2-y^2=d$，平方差，$(x-y)(x+y)=d$，那么直接在 $1 \sim \sqrt{d}$ 中枚举 $d$ 的因数 $x-y$ 或 $x+y$，再求出另一个，求出 $x,y$（$x=\frac{(x-y)+(x+y)}{2}$），再求 $x^2,y^2$，判断此时 $x,y,x^2,y^2$ 是否满足题目条件即可。

---


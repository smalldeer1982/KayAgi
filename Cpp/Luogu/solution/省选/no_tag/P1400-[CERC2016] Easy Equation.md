# [CERC2016] Easy Equation

## 题目描述

假设 $k$ 大于 $1$，
可以证明有无穷多个正整数三元组 $(a, b, c)$ 满足以下方程:

   $a^2 + b^2 + c^2 = k(ab + bc + ca) + 1$
    
给定正整数 $n$ 和 $k$，找出 $n$ 个三元组 $(a_1, b_1, c_1), (a_2, b_2, c_2), ⋯ ,(a_n, b_n, c_n)$ 使它们都满足方程。另外，这 $3n$ 个正整数 $(a_1, b_1, c_1), (a_2, b_2, c_2), ⋯ ,(a_n, b_n, c_n)$ 应该是不同的，每个数最多有 $100$ 位。

## 样例 #1

### 输入

```
2 8```

### 输出

```
1 2 6
3 10 24
12 35 88
15 28 84
4 5 18
14 33 90
40 104 273
21 60 152```

## 样例 #2

### 输入

```
3 3```

### 输出

```
1 3 12
8 21 87
44 165 615```

# 题解

## 作者：Rainbow_qwq (赞：5)

初见这个方程并无想法，但是通过打表观察发现，如果有一组解 $(a,b,c)$（这里假设 $a<b<c$），大概就会有一组解 $(b,c,x)$，这启发我们通过一组解来扩展出其他解。

若有解 $(a,b,c)$，则 $a^2 - k(b+c)a + (b^2+c^2-kbc-1)=0$。

这是二次方程组，通过韦达定理，得到 $a_1+a_2 = k(b+c)$，$x=k(b+c)-a$ 是这个方程的另一个解。

又由于 $b,c>a$，因此 $k(b+c)-a>0$，于是我们找到了新的解 $(b,c,k(b+c)-a)$。同理可以得到新的解 $(a,c,k(a+c)-b)$。

同样通过打表观察得到有一组解 $(1,k,k(k+1))$，这就是初始状态，从这个状态开始扩展即可。

使用 bfs 扩展和 set 判重，就可以 $O(n\log n)$ 解决本题，由于要高精度，代码实现使用 python。


```python
k,n = map(int,input().split())
s = {0}
hd = 0
q = [(1,k,k*(k+1))]
while 1:
    a,b,c = q[hd]
    #print(a,b,c)
    if a<0 or b<0 or c<0:
        break
    hd = hd + 1
    if a not in s and b not in s and c not in s:
            print(a,b,c)
            s.add(a)
            s.add(b)
            s.add(c)
            n = n - 1
            if n == 0 :
                break
    q.append((b,c,k*(b+c)-a))
    q.append((a,c,k*(a+c)-b))
    tmp = k*(a+b)-c
    #if tmp>0 and tmp!=c :
    #    print("qwq")
    #    print(a,b,k*(a+b)-c)
    #    q.append((a,b,k*(a+b)-c))
```

---

## 作者：PeacefulStagnation (赞：3)

这道题看第一眼的时候很容易想到枚举。但是，看到“每个数最多有 $100$ 位”的时候就会发现，这道题肯定不能用枚举。

首先，当 $(a,b,c)$ 有解，根据该方程的特性，则可以拓展出一组 $(b,c,x)$ 的解， $x$ 为我们要推导出来。

此后我们可以通过化简方程变为 $AX^2+BX+C=0$ 来找规律，过程如下：
$$
\begin{aligned}
a^2+b^2+c^2&=k(ab+bc+ca)+1\\
a^2+b^2+c^2-1&=k(ab+bc+ca)\\
a^2+b^2+c^2-1&=kab+kbc+kca\\
a^2+b^2+c^2-1-kab-kbc-kca&=kab+kbc+kca\\
a^2-(kab+kca)+(b^2+c^2-kbc+1)&=0\\
a^2-k(b+c)a+(b^2+c^2-kbc+1)&=0
\end{aligned}
$$
可发现，其中：$X=a,A=1,B=-k(b+c),C=b^2+c^2-kbc+1$。

简化后，通过韦达定理：
$$
x_1+x_2=-\frac{b}{a}\\
$$
可得：
$$
a_1+a_2=k(b+c)\\
$$
则：$x=k(b+c)−a$。

所以，当 $(a,b,c)$ 有解，则可以拓展出 $(b,c,k(b+c)−a)$ 的解。同理还可以拓展出 $(a,c,k(a+c)−b)$ 的解。

通过上面的思路，则可以知道这道题可以用宽度优先搜索，并使用集合来判重，使用 $O(n\log n)$ 的时间复杂度即可完成此题。

又因这道题需要高精度，使用 C++ 实现比较麻烦，所以这里使用 Python 实现。

代码如下：
```Python
k, n = map(int,input().split())
f = {0}
h = 0
q = [(1, k, k*(k+1))]
while 1:
    a, b, c = q[h]
    if a < 0 or b < 0 or c < 0:
        break
    h += 1
    if a not in f and b not in f and c not in f:
            print(a, b ,c)
            f.add(a)
            f.add(b)
            f.add(c)
            n = n - 1
            if n == 0 :
                break
    q.append((b, c, k * (b + c) - a))
    q.append((a, c, k * (a + c) - b))
```

希望这篇题解对你有帮助~

---

## 作者：hh__hh (赞：2)

题目分析：

根据题目中的条件，我们可以将方程两边变形得到：

$$ \left (a - kb - kc \right)^2 + \left (b-kc-ka \right)^2 + \left (c - ka - kb \right)^2 = k^2 \left (ab + bc + ca \right) - 1$$

观察等式左边，发现它可以表示为三个整数之平方和，那么问题就转化为如何求得一些正整数 $a,b,c$，使得等式左边的三个数之和为 $k^2(ab+bc+ca)-1$。

接下来，我们可以通过构造一些数列得到一些正整数三元组。

考虑以下数列：

$b_0=1,b_1=k-1,b_{n+1}=kb_n-b_{n-1}$。

显然，这是一个以 $k$ 为比值的等差数列。

现在我们来看一下以下的三个数：

$a_0=b_0,a_1=b_1,c_0=k-1$

我们定义一个函数 $f \left (x \right) = kx ^ 2 - x + 1$，如果能够找到一个正整数 $n$，使得 $f \left (b_n \right) = c_n$，那么我们就可以得到一个正整数三元组 $(a_n,b_n,c_n)$。

事实上，我们可以通过归纳法证明这个数列 $a_n,b_n,c_n$ 满足题目中的要求。
为了验证这个结论，我们可以先计算一下数列前几项的值：

$$ a_0 = 1,  b_0 = 1,  c_0 = k-1, $$

$$ a_1 = k-1,  b_1 = k-1, c_1 = k^2-k+1$$

$$ a_2 = k^2-2k+2,  b_2 = k^2-3k+3,  c_2 = k^3-3k^2+2k$$

$$ a_3 = k^4-6k^3+12k^2-8k+2,  b_3 = k^4-10k^3+27k^2-25k+8,  c_3 = k^5-5k^4+10k^3-10k^2+4k-1$$

现在，我们来验证一下这些数是否满足题目中的要求。根据等式左边的表达式，我们有：

$$\begin{aligned} &a_n^2 + b_n^2 + c_n^2 \ =& a_n^2 + b_n^2 + (k^2-k+1)^2 \ =& a_n^2 + b_n^2 + k^4 - 2k^3 + 2k^2 - 2k + 1 \ =& k(a_n b_n + b_n c_n + c_n a_n) + 1 \end{aligned}$$

因此，数列 $(a_n,b_n,c_n)$ 确实满足题目中的要求。

时间复杂度：$ O \left ( n \log n \right)$。

---------------------------------------------------------------

代码~自己打。

---


# [NEERC 2014] Gomoku

## 题目描述

这是一个交互式问题。

五子棋是一种在二维网格上进行的双人游戏。网格的每个单元格可以是空的，包含第一位玩家的标记（黑色），或者包含第二位玩家的标记（白色），但不能同时包含两者。最初整个网格是空的。两位玩家轮流下棋，从第一位玩家开始。每次移动时，玩家可以在一个空单元格中放置她的标记。第一个在一行中有五个相邻标记的玩家获胜。获胜的行可以是垂直的、水平的或对角线的。

![](https://upload.acmicpc.net/23c94254-2783-405a-907b-7b66bea5514b/-/preview/)

第二位玩家（白色标记）获胜的位置。

在这个问题中，玩家使用一个 $19 \times 19$ 的网格。如果整个网格被标记填满但没有玩家获胜，游戏被判为平局。

第一位玩家使用以下策略：作为第一次移动，她将她的标记放在网格的中心单元格。在每次其他移动中，她选择一个能最大化结果位置得分的移动。

为了找到一个位置的得分，第一位玩家考虑所有可能最终形成获胜组合的位置——换句话说，棋盘上所有水平、垂直和对角线的五个连续单元格的行（当然，它们可能相互重叠）。如果这样的行同时包含第一位玩家和第二位玩家的标记，则不予考虑。如果这样的行不包含任何标记，也不予考虑。对于每个只包含第一位玩家的标记且没有第二位玩家标记的行，添加 $50^{2k-1}$ 到位置的得分，其中 $k$ 是第一位玩家的标记数量（$1 \le k \le 5$）。对于每个只包含第二位玩家的标记且没有第一位玩家标记的行，从位置的得分中减去 $50^{2k}$。最后，随机添加一个介于 $0$ 和 $50^{2} - 1$ 之间的整数到得分中。这个随机数是均匀选择的。

在第一位玩家的几个移动得分相等的情况下（由于上述随机加法，这种平局很少见），第一位玩家选择 x 坐标最小的移动，如果 x 坐标相同，则选择 y 坐标最小的移动。

你的任务是编写一个程序，扮演第二位玩家并击败这种策略。

你的程序将与上述策略进行 100 场比赛，使用不同的随机生成器种子。你的程序必须赢得所有这些比赛。

## 说明/提示

时间限制：2 秒，内存限制：512 MB。

题面翻译由 ChatGPT-4o 提供。

## 样例 #1

### 输入

```
10 10
10 11
10 12
10 13
9 10
9 11
9 9
11 13
-1 -1
```

### 输出

```
11 10
11 11
10 9
10 14
8 9
11 9
11 12
11 8
```

# 题解

## 作者：鏡音リン (赞：11)

写一个能与任意策略对局取胜的程序是很困难的，所以从先手的策略入手。首先，分数最大等价于分数的增加量最大，如果先手的一次下子能破坏一个后手有 $k$ 个棋子的胜利组合，分数的增加量是 $0-(-50^{2k})=50^{2k}$。如果这次下子能形成一个先手有 $k+1$ 个棋子的胜利组合，分数的增加量是 $50^{2k+1}-50^{2k-1}$，可以近似地认为是 $50^{2k+1}$。对于任意一个位置，包含它的胜利组合最多只有 $20$ 个，而计分使用的底数是 $50$，因此多个 $50^x$ 的增加量也不会超过 $50^{x+1}$。因此先手下子的优先级是：扩展先手 $4$ 个子 $>$ 破坏后手 $4$ 个子 $>$ 扩展先手 $3$ 个子 $>$ 破坏后手 $3$ 个子 $>$ 扩展先手 $2$ 个子 $>$ 破坏后手 $2$ 个子 $>$ 扩展先手 $1$ 个子 $>$ 破坏后手 $1$ 个子。注意到在形如下图的情况中，黑点所示位置具有较高的优先级。然而这一位置下子实际上作用不大，几乎是浪费的。我们可以构造出这种情况引诱先手浪费手数来取得优势。

![](https://cdn.luogu.com.cn/upload/image_hosting/hitpbayy.png)

分析了先手的策略之后，我们来构造具体方案。本题较为开放，能够构造出的获胜方案可能很多，这里只讲其中一种。

我们的前两手选择一个远离中心，又不太接近边界的地方，在两个对角线相邻的地方下子，例如 $(5,16)$ 和 $(4,15)$。根据上面的优先级，先手会选择靠近其中心第一个子的位置下子，并连成一行。此时，先手会在中心形成一行相邻的三个子。这时我们需要防守，在这一行相邻两侧的任意一侧下子。先手会下在另一侧，我们继续防守，下在这一侧相邻的位置。一种可能的情况如下图所示。

![](https://cdn.luogu.com.cn/upload/image_hosting/r93ybbo8.png)

此时先手会在后手两个子所在的那一行，相邻的两侧之中的一侧下子。无论先手选择哪侧我们都下在另一侧，这样会形成上面所说的情况，引诱先手“浪费”一手。我们选择在中间那个子另一个对角线方向相邻的位置下子，如下图：

![](https://cdn.luogu.com.cn/upload/image_hosting/4s9spj0j.png)

此时，可以计算出红点的分数增加量超过 $3\times 50^4+2\times 50^3$，黑点和蓝点的分数增加量均为 $3\times 50^4+7\times 50^2+x\times 50^1$（其中 $x\times 50^1$ 表示由单个先手棋子带来的贡献），所以先手会一定会选择红点。我们可以在两个黑点中任选一个，这样我们会形成一行三个棋子相邻，先手会在某一侧防守。接下来我们在另一个黑点旁边的位置下子，先手会下在那一行三个棋子的另一侧。然后我们下在另一个黑点上，形成一个十字。一种可能的情况如下：

![](https://cdn.luogu.com.cn/upload/image_hosting/e9czwalc.png)

形成十字之后，我们已经必胜。无论先手选择哪里，我们都有办法找到一个位置形成一行四个相邻棋子，且两侧都可扩展。接下来先手下在任何一侧我们下在另一侧即可胜利。

---


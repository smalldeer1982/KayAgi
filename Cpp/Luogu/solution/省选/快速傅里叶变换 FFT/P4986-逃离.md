# é€ƒç¦»

## é¢˜ç›®èƒŒæ™¯

$\ \rm Althen\ $å’Œ$\ \rm hdxrie\ $æ‰å…¥äº†äºŒç»´ç©ºé—´ã€‚

## é¢˜ç›®æè¿°

å…¶å®è¿™ä¸ªç©ºé—´å¹¶ä¸æ˜¯æ— é™çš„ï¼Œè€Œæ˜¯åŠå¾„æœ‰é™çš„åœ†ç›˜ã€‚

èµ·åˆï¼Œä»–ä»¬ä¸¤ä¸ªéƒ½åœ¨åœ†å¿ƒå¤„ï¼Œä¸ºäº†æ‰¾åˆ°å‡ºå£ï¼Œä»–ä»¬ä¸¤ä¸ªå†³å®šåˆ†å¼€è¡ŒåŠ¨ï¼Œåªè¦æ‰¾åˆ°å‡ºå£ï¼Œä¾¿ä¼šç¦»å¼€ã€‚ä¸è¿‡ï¼Œè‹¥æ˜¯å…¶ä¸­ä¸€ä¸ªäººæ‰¾åˆ°äº†å‡ºå£ï¼Œå¦ä¸€ä¸ªè¿˜åœ¨äºŒç»´ç©ºé—´å†…ï¼Œé‚£ä¹ˆè¿™ä¸ªç©ºé—´å°±ä¼šå› ä¸ºä¸å¹³è¡¡è€Œå´©å¡Œã€‚æ‰€ä»¥ä»–ä»¬ä¸¤ä¸ªåªèƒ½ä¸€èµ·ç¦»å¼€ã€‚

å…¶ä¸­ï¼š
- $\rm Althen\ $ å¯ä»¥æ‹å¼¯ï¼Œè¿˜ä¼šä¸€ç›´æ‹æ¥æ‹å»ï¼Œä¸è¿‡åªèƒ½æ°´å¹³æˆ–è€…ç«–ç›´ç§»åŠ¨ã€‚
- $\rm hdxrie\ $ åªèƒ½æ²¿ä»»æ„ä¸€æ¡ç›´çº¿èµ°ï¼Œä¸èƒ½æ‹å¼¯ã€‚

$\rm Althen\ $ å…¨ç¨‹åœ¨æ°´å¹³å‘å³çš„å¹³å‡é€Ÿåº¦å¯ä»¥ç”¨å‡½æ•° $A(x)$ è¡¨ç¤ºï¼Œåœ¨ç«–ç›´å‘ä¸Šçš„å¹³å‡é€Ÿåº¦å¯ä»¥ç”¨å‡½æ•° $B(x)$ è¡¨ç¤ºã€‚$\rm hdxrie\ $ å…¨ç¨‹ç§»åŠ¨çš„å¹³å‡é€Ÿåº¦å¯ä»¥ç”¨å‡½æ•° $C(x)$ è¡¨ç¤ºã€‚è€Œå‚æ•° $x$çš„å–å€¼èŒƒå›´ä¹Ÿæœ‰è®²ç©¶ï¼Œä¸º $[L,R]$ã€‚

ç°åœ¨ï¼Œä»–ä»¬ä¸¤ä¸ªæƒ³é—®ä½ ï¼Œä»–ä»¬æœ‰å¯èƒ½ä¸€èµ·ç¦»å¼€è¿™ä¸ªäºŒç»´ç©ºé—´å—ï¼Ÿå¦‚æœå¯ä»¥ï¼Œè¿™ä¸ªå‚æ•° $x$ çš„å€¼å¯ä»¥æ˜¯å¤šå°‘ï¼Ÿ



## è¯´æ˜/æç¤º

ã€æ•°æ®èŒƒå›´ã€‘   
å¯¹äº$10\%$çš„æ•°æ®ï¼Œ$L=R$ï¼›  
å¦æœ‰$20\%$çš„æ•°æ®ï¼Œ$La=Lb=Lc=1$ï¼›  
å¦æœ‰$30\%$çš„æ•°æ®ï¼Œ$[L,R]$ å†…æœ€å¤šåªæœ‰ä¸€ä¸ªå‚æ•° $x$ åˆæ³•ï¼›  
å¯¹äº$100\%$çš„æ•°æ®ï¼Œ$0â‰¤La,Lb,Lcâ‰¤10^5$ï¼Œ$0â‰¤a_i,b_i,c_iâ‰¤9$ï¼Œ$Lâ‰¤R$ï¼Œ$|L|,|R|â‰¤3$ï¼›  

ç­”æ¡ˆç²¾ç¡®åº¦éœ€è¦ä¿è¯å¸¦å…¥åŸæ¥çš„ä¸‰ä¸ªå‡½æ•°ï¼Œåˆæ³•è¯¯å·®ä¸è¶…è¿‡ $10^{-5}$ï¼Œè¯¯å·®è‹¥æ˜¯å¤§äº $10^{-5}$ ä¼šåˆ¤æ–­ä¸ºé”™è¯¯ç­”æ¡ˆï¼Œå»ºè®®è¾“å‡º **ä¿ç•™å…«ä½ä»¥ä¸Šå°æ•°**ã€‚

###### $\color{#EEE}{\tt {Notice\ that\ SPEED\ is\ VECTOR.(High\ school\ physics)}}$

## æ ·ä¾‹ #1

### è¾“å…¥

```
1 1 1 -2.00 0.50 
1 2 
1 3 
4 1 
```

### è¾“å‡º

```
-1.16666667```

## æ ·ä¾‹ #2

### è¾“å…¥

```
1 1 1 -1.00 0.50 
1 2 
1 3 
4 1 
```

### è¾“å‡º

```
Inconsistent!```

# é¢˜è§£

## ä½œè€…ï¼šå‘¨é“_Althen (èµï¼š14)

~~å¤§å®¶å¥½æˆ‘æ˜¯å‡ºé¢˜äºº AlthenÂ·WayÂ·Satanï¼ˆè¶…å°å£°ï¼‰ã€‚~~

### çƒ­çƒˆç¥è´ºç¬¬ä¸€ä¸ªåˆ‡æ‰è¿™ä¸ªé¢˜çš„äººï¼š[@å—å±±æ¡¥ä¸€éœ¸](https://www.luogu.org/space/show?uid=56923)ï¼›

## è¿˜æœ‰æ„Ÿè°¢ä¸€ç›´åˆ°æœ€åéƒ½åœ¨è‚æˆ‘çš„é¢˜çš„å¤§ä½¬ï¼Œè‘±èŠ±éƒ½è¦å“­å‡ºæ¥äº†ï¼š[@zhaimingshuzms](https://www.luogu.org/space/show?uid=8742)ã€‚ï¼ˆOrzï¼Œéƒ½å·²ç»æ‹¿åˆ°70%äº†ï¼‰

- å‰æ’é¸£è°¢ï¼š

$\ \ \ \ \ \ \ $æŒ‡å¯¼ï¼ˆ~~PYå…³ç³»~~ï¼‰ï¼š[@Psyduck](https://psyduck.wang/)  

$\ \ \ \ \ \ \ $SPJå‹æƒ…æä¾›ï¼š[@hdxrie](https://www.luogu.org/blog/hdxrie/)

$\ \ \ \ \ \ \ $è¡¨æƒ…åŒ…å‡ºå¤„ï¼š[@å…¨å…½å‡ºå‡»](https://weibo.com/F2plusA?from=myfollow_all)
$\ \ $ç”»å¸ˆï¼š[@å‘€å˜›çš„å°2ç‹¼ ](https://weibo.com/u/3210386137?from=myfollow_all&is_all=1)ï¼ˆ~~å¤§å®¶å¿«å»å…³æ³¨ä»–å‘€XD~~ï¼‰

------------

# ä¸€ã€é¢˜é¢è§£é‡Š

$\ \ \ \ \ \ \ $æ ¹æ®é¢˜é¢æ‰€æè¿°çš„æ„æ€ï¼Œæˆ‘ä»¬å¯ä»¥å¾—åˆ°å¦‚ä¸‹çš„å›¾å½¢ï¼š

![](https://s1.ax1x.com/2018/10/14/iU3T3R.jpg)

$\ \ \ \ \ \ \ $![åƒç“œ](https://s1.ax1x.com/2018/10/14/iUlfMV.png)

$\ \ \ \ \ \ \ $å…¶ä¸­ï¼Œç»¿è‰²å’Œè“è‰²çš„ç®­å¤´ä»£è¡¨$\ \rm Althen\ $èµ°è¿‡çš„è·¯ç¨‹ï¼›çº¢è‰²çš„ç®­å¤´ä»£è¡¨$\ \rm hdxrie\ $èµ°è¿‡çš„è·¯ç¨‹ï¼Œè®¾æ—¶é—´ä¸º$\ T\ $çš„è¯ï¼Œçº¢è‰²ç®­å¤´çš„é•¿åº¦ä¾¿ä¸º$\ C(x)Ã—T\ $ã€‚

$\ \ \ \ \ \ \ $![æ–œçœ¼](https://s1.ax1x.com/2018/10/14/iU8js0.png)

$\ \ \ \ \ \ \ $ $\rm Althen\ $èµ°è·¯æ‰­æ¥æ‰­å»çš„ï¼Œä¸æ–¹ä¾¿ç ”ç©¶ï¼Œè®©äººååˆ†ä¸çˆ½ã€‚æˆ‘ä»¬ä¸å¦¨ ï¼ˆ~~æŠŠä»–æ‹–å‡ºå»æ‰“ä¸€é¡¿~~ï¼‰å¹³ç§»ä¸€ä¸‹ä»–èµ°è¿‡çš„è·¯ç¨‹ï¼š

![](https://s1.ax1x.com/2018/10/14/iU3Hjx.jpg)

$\ \ \ \ \ \ \ $![å‘å…‰](https://s1.ax1x.com/2018/10/14/iUlRx0.png)

$\ \ \ \ \ \ \ $å¹³ï¼ˆ~~dÇlÄ“~~ï¼‰ç§»ï¼ˆ~~yÃ­dÃ¹n~~ï¼‰è¿‡åï¼Œçœ‹èµ·æ¥èˆ’æœå¤šäº†å‘¢ï¼Œé‚£ä¹ˆç°åœ¨ï¼Œæˆ‘ä»¬å¯ä»¥åº¦é‡ä¸€ä¸‹$\ \rm Althen\ $èµ°è¿‡çš„è·¯ç¨‹ï¼Œæ ¹æ®é¢˜é¢å®šä¹‰ï¼Œ
å¯ä»¥å‘ç°ç»¿è‰²ç®­å¤´çš„é•¿åº¦ä¸º$\ A(x)Ã—T\ $ï¼Œç»¿è‰²ç®­å¤´çš„é•¿åº¦ä¸º$\ B(x)Ã—T\ $ã€‚å®¹æ˜“è¯æ˜ï¼Œä¸ç®¡$\ \rm Althen\ $æ€ä¹ˆæ‰­ï¼Œéƒ½å¯ä»¥é€šè¿‡å¹³ç§»å¾—åˆ°è¿™æ ·çš„è¡¨è¾¾å¼ï¼ˆ~~å°å­¦æ•°å­¦~~ï¼‰ã€‚

$\ \ \ \ \ \ \ $![æ‰˜è…®](https://s1.ax1x.com/2018/10/14/iUlhrT.png)

$\ \ \ \ \ \ \ $é€šè¿‡è§‚å¯Ÿæˆ‘ä»¬å¯ä»¥å¾ˆå®¹æ˜“å‘ç°ï¼Œçº¢è‰²ç®­å¤´çš„é•¿åº¦$\ C(x)Ã—T\ $å°±åˆšåˆšå¥½ç­‰äºåŠå¾„ï¼Œæ‰€ä»¥æˆ‘ä»¬ä¸å¦¨æŠŠä»–ä¹Ÿæ—‹è½¬ä¸‹æ¥ï¼š

![](https://s1.ax1x.com/2018/10/14/iU3OHO.jpg)

$\ \ \ \ \ \ \ $![åƒé²¸](https://s1.ax1x.com/2018/10/14/iUl4qU.png)ï¼ï¼Ÿ

$\ \ \ \ \ \ \ $è¿™æ˜¯ä¸€ä¸ªç›´è§’ä¸‰è§’å½¢ï¼Œæˆ‘ä»¬å¯ä»¥è½»æ˜“å†™å‡ºä¸‹é¢çš„å¼å­ï¼ˆ~~åˆä¸­æ•°å­¦~~ï¼‰ï¼š
$$(C(x)Ã—T)^2=(A(x)Ã—T)^2+(B(x)Ã—T)^2$$
$\ \ \ \ \ \ \ $åŒ–ç®€è¿‡åå¯ä»¥å¾—åˆ°ï¼š
$$C^2(x)=A^2(x)+B^2(x)$$
$\ \ \ \ \ \ \ $æ‰€ä»¥è¯´ï¼Œæˆ‘ä»¬å®šä¹‰å‡½æ•°$f(x)$:
$$f(x)=C^2(x)-A^2(x)-B^2(x)$$
$\ \ \ \ \ \ \ $![æ‹‡æŒ‡](https://s1.ax1x.com/2018/10/14/iUlIZF.png)

$\ \ \ \ \ \ \ $æ±‚å‡ºå‡½æ•°$f(x)$åœ¨$[L,R]$èŒƒå›´çš„æ ¹ï¼Œå°±æ˜¯æˆ‘ä»¬è¦æ±‚çš„ç³»æ•°$x$äº†ã€‚

$\ \ \ \ \ \ \ $æ³¨æ„ï¼Œé€Ÿåº¦æ˜¯çŸ¢é‡ï¼Œæ‰€ä»¥å°±ç®—æˆ‘ä»¬è§£å‡ºæ¥çš„æ ¹$\ x$ï¼Œå¸¦è¿›åŸå‡½æ•°$\ A(x)$ï¼Œ$B(x)$ï¼Œ$C(x)\ $æ˜¯è´Ÿæ•°ï¼Œå®ƒä¹Ÿæ˜¯åˆæ³•çš„ï¼Œè¿™æ˜¯é«˜ä¸€çš„ç‰©ç†ï¼Œé¢˜é¢æœ€åä¹Ÿç»™äº†æç¤ºï¼š$\color{#EEE}{\tt {Notice\ that\ SPEED\ is\ VECTOR.(High\ school\ physics)}}$ã€‚


------------

# äºŒã€åˆ†æ®µè§£æ

- ## type1(10%):$\ $ $L==R$

$\ \ \ \ \ \ \ $ç­”æ¡ˆåªæœ‰å¯èƒ½ä¸º$\ L$ï¼Œç›´æ¥åˆ¤æ–­è¯¥ç­”æ¡ˆæ˜¯å¦æ»¡è¶³$f(L)==0$ï¼Œæ—¢æ˜¯å¦æ»¡è¶³$C^2(x)-A^2(x)-B^2(x)==0$ã€‚

$\ \ \ \ \ \ \ $![æ–œçœ¼](https://s1.ax1x.com/2018/10/14/iU8js0.png)

$\ \ \ \ \ \ \ $åº”è¯¥æ˜¯è¯»æ‡‚é¢˜æ„å³å¯æ‹¿çš„åˆ†ã€‚

- ## type2(20%):$\ $ $La=Lb=Lc=1$

$\ \ \ \ \ \ \ $å› ä¸ºä¿è¯$La=Lb=Lc=1$ï¼Œå‡½æ•°å½¢å¼å°±ä¿è¯ä¸ºï¼š$A(x)=a_1x+a_0$ï¼Œ$B(x)=b_1x+b_0$ï¼Œ$C(x)=c_1x+c_0$ã€‚

$\ \ \ \ \ \ \ $ $f(x)$çš„å½¢å¼ä¹Ÿå¯ä»¥ä¿è¯ä¸ºï¼š
$$f(x)=(c_1^2-a_1^2-b_1^2)x^2+2(c_1c_0-a_1a_0-b_1b_0)x+c_0^2-a_0^2-b_0^2$$

$\ \ \ \ \ \ \ $![æ‰˜è…®](https://s1.ax1x.com/2018/10/14/iUlhrT.png)

$\ \ \ \ \ \ \ $å—¯â€¦â€¦æ˜¯ä¸€ä¸ªäºŒæ¬¡å‡½æ•°å‘¢ï¼Œæ±‚æ ¹å…¬å¼ä¸€æ³¢å¸¦èµ°ï¼ˆ~~åˆä¸­æ•°å­¦~~ï¼‰ã€‚

- ## type3(30%):$\ $ä¿è¯$[L,R]$æœ€å¤šåªæœ‰ä¸€ä¸ªå‚æ•°$x$åˆæ³•ï¼›

$\ \ \ \ \ \ \ $è¿™ç›¸å½“äºä¿è¯äº†$f(x)$åœ¨$[L,R]$å†…æœ€å¤šåªæœ‰ä¸€ä¸ªé›¶ç‚¹ï¼Œ$f(x)$åœ¨$[L,R]$å†…è¿‘ä¼¼äºå•è°ƒã€‚

$\ \ \ \ \ \ \ $![å‘å…‰](https://s1.ax1x.com/2018/10/14/iUlRx0.png)

$\ \ \ \ \ \ \ $å¾ˆå®¹æ˜“æƒ³åˆ°äºŒåˆ†ç­”æ¡ˆï¼Œä¹Ÿç¡®å®å¯ä»¥äºŒåˆ†ç­”æ¡ˆï¼ˆ~~é«˜ä¸€æ•°å­¦~~ï¼‰ã€‚

$\ \ \ \ \ \ \ $æ³¨æ„ï¼Œå¦‚æœäºŒåˆ†çš„**check( )**å†™çš„æ˜¯$C^2(x)-A^2(x)-B^2(x)$çš„å€¼ï¼Œå¯èƒ½ä¼šé€ æˆæ¯”è¾ƒå¤§çš„ç²¾åº¦è¯¯å·®ï¼Œå»ºè®®è€è€å®å®å…ˆç®—å‡º$f(x)$ï¼Œå†**check( )**åˆ¤æ–­$f(x)$çš„å€¼ã€‚

$\ \ \ \ \ \ \ $åœ¨æ±‚$f(x)$çš„è¿‡ç¨‹ä¸­ï¼Œéœ€è¦æ±‚åˆ°å·ç§¯ï¼Œæˆ‘ä»¬å‘ç°$O(n^2)$åœ°æ±‚å·ç§¯ä»£ä»·å¤ªå¤§ï¼Œæ‰€ä»¥æ¨èä½¿ç”¨ **å¿«é€Ÿå‚…é‡Œå¶å˜æ¢$FFT$** ï¼Œä¸ä¼šå°±å‡ºé—¨å·¦æ‹ç™¾åº¦ï¼Œä¼šæœ‰å¾ˆå¤šå¤§ä½¬çš„è®²è§£çš„ã€‚

- ## type_all(100%)

$\ \ \ \ \ \ \ $![å“­å”§å”§](https://s1.ax1x.com/2018/10/14/iUYFDx.png)

$\ \ \ \ \ \ \ $æ²¡æœ‰ä»€ä¹ˆç‰¹æ®Šæ€§è´¨ï¼Œå› ä¸ºå¯èƒ½æœ‰å¤šä¸ªæ ¹ï¼Œä¹Ÿä¸èƒ½äºŒåˆ†äº†å‘¢ã€‚

$\ \ \ \ \ \ \ $![æ‰˜è…®](https://s1.ax1x.com/2018/10/14/iUlhrT.png)

$\ \ \ \ \ \ \ $å›åˆ°æˆ‘ä»¬çš„é—®é¢˜ï¼Œæ˜¯å¦‚ä½•æ±‚$f(x)$åœ¨$[L,R]$å†…çš„ä»»æ„ä¸€ä¸ªè§£ã€‚

$\ \ \ \ \ \ \ $å…¶å®ä¸è¿‡æ˜¯ä¸ª **ç‰›é¡¿è¿­ä»£** çš„è£¸é¢˜ï¼Œç‰›é¡¿è¿­ä»£å¸¸ç”¨äºæ±‚ä¸€è¿ç»­å¯å¯¼å‡½æ•°æŸä¸€æå€¼ï¼Œæˆ–è€…æŸä¸€é›¶ç‚¹ã€‚

$\ \ \ \ \ \ \ $![åƒç“œ](https://s1.ax1x.com/2018/10/14/iUlfMV.png)

$\ \ \ \ \ \ \ $è¿™ä¸å°±æ­£æ˜¯æˆ‘ä»¬æ‰€éœ€è¦çš„å—ï¼Ÿ

$\ \ \ \ \ \ \ $æ ¹æ®ä¸€é˜¶ç‰›é¡¿è¿­ä»£çš„å…¬å¼ï¼Œæˆ‘ä»¬å¯ä»¥å¾—åˆ°æˆ‘ä»¬çš„ç­”æ¡ˆå°±åº”è¯¥æ˜¯ä»¥ä¸‹å‡½æ•°çš„æ”¶æ•›å€¼ï¼š

$$F(x)=F(x-1)-\frac{f\left(F(x-1)\right)}{f'\left(F(x-1)\right)}$$

$\ \ \ \ \ \ \ $è¿™é‡Œåˆéœ€è¦æ±‚$f(x)$çš„ä¸€é˜¶å¯¼$f'(x)$ï¼Œå…¶å®å¾ˆç®€å•ï¼Œå¹‚å‡½æ•°çš„å¯¼æ•°ç½‘ä¸Šä¸€æœå°±æœ‰äº†ã€‚æ˜¾ç„¶ï¼Œæˆ‘ä»¬åé¢çš„å‡ ä¸ªç‚¹ï¼Œæ˜¯æ»¡è¶³$f(x)$äºŒé˜¶å¯å¯¼çš„ï¼Œæ‰€ä»¥$F(x)$å¿…ç„¶ä¼šæ”¶æ•›ï¼Œä½†æ˜¯ä¸ä¸€å®šæ˜¯åœ¨$[L,R]$å†…ï¼Œéœ€è¦åˆ¤æ–­ä¸€ä¸‹ã€‚

- ### ä¸‹é¢ç»™å‡ºæ ‡ç¨‹ä»£ç 
$\color{#EEE}{\text{å·²ç»åšäº†é˜²æŠ„è¢­å¤„ç†ï¼Œç›´æ¥å¤åˆ¶ä¼šCEçš„ï¼ŒXD}}$

```cpp
#include<algorithm>
#include<iostream>
#include<cstdlib>
#include<cstring>
#include<cctype>
#include<cstdio>
#include<string>
#include<queue>
#include<stack>
#include<cmath>
#include<map>
#include<set>
usingã€€namespaceã€€std;
constã€€doubleã€€eps=1e-10;
constã€€doubleã€€pi=acos(-1.0);
inlineã€€intã€€read(){
ã€€ã€€intã€€x=0,f=1;charã€€ch;ch=getchar();
ã€€ã€€while(ch<'0'||ch>'9'){if(ch=='-')ã€€f=0;ch=getchar();}
ã€€ã€€while(ch>='0'&&ch<='9'){x=(x<<1)+(x<<3)+(ch&15);ch=getchar();}
ã€€ã€€if(f)returnã€€x;elseã€€returnã€€-x;
}
doubleã€€fabs(doubleã€€c){if(c<0.0)returnã€€-c;returnã€€c;}
constã€€intã€€N=3e5+10;
//FFTæ¨¡æ¿â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”ã€€
structã€€cpx{
ã€€ã€€doubleã€€r,i;
ã€€ã€€inlineã€€cpxã€€operatorã€€*(constã€€cpx&x)const{returnã€€(cpx){r*x.r-i*x.i,r*x.i+i*x.r};}
ã€€ã€€inlineã€€cpxã€€operatorã€€+(constã€€cpx&x)const{returnã€€(cpx){r+x.r,i+x.i};}
ã€€ã€€inlineã€€cpxã€€operatorã€€-(constã€€cpx&x)const{returnã€€(cpx){r-x.r,i-x.i};}
}cpxa[N],cpxb[N];
intã€€r[N];
voidã€€FFT(cpx*a,intã€€f,intã€€la){
ã€€ã€€intã€€n=la;
ã€€ã€€for(registerã€€intã€€i=0;i<n;++i)if(i<r[i])swap(a[i],a[r[i]]);
ã€€ã€€for(registerã€€intã€€i=1;i<n;i<<=1){
ã€€ã€€ã€€ã€€cpxã€€wn=(cpx){cos(pi/i),f*sin(pi/i)};
ã€€ã€€ã€€ã€€for(registerã€€intã€€j=0;j<n;j+=(i<<1)){
ã€€ã€€ã€€ã€€ã€€ã€€cpxã€€w=(cpx){1,0};
ã€€ã€€ã€€ã€€ã€€ã€€for(registerã€€intã€€k=0;k<i;++k,w=w*wn){
ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€cpxã€€x=a[j+k],y=w*a[j+k+i];
ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€a[j+k]=x+y;a[j+k+i]=x-y;
ã€€ã€€ã€€ã€€ã€€ã€€}
ã€€ã€€ã€€ã€€}
ã€€ã€€}
ã€€ã€€if(f==-1)
ã€€ã€€for(registerã€€intã€€i=0;i<n;i++)a[i].r/=n;
}
intã€€merge_fft(cpxã€€*a,cpxã€€*b,intã€€la,intã€€lb){
ã€€ã€€intã€€n=la,m=lb;
ã€€ã€€intã€€L=0;for(m+=n,n=1;n<=m;n<<=1)L++;
ã€€ã€€for(registerã€€intã€€i=0;i<n;i++)
ã€€ã€€r[i]=(r[i>>1]>>1)|((i&1)<<(L-1));
ã€€ã€€FFT(a,1,n);FFT(b,1,n);
ã€€ã€€for(registerã€€intã€€i=0;i<=n;i++)a[i]=a[i]*b[i];
ã€€ã€€FFT(a,-1,n);
ã€€ã€€returnã€€m;
}
//â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”ã€€
doubleã€€L,R;
intã€€La,Lb,Lc,Lc1,a[N],b[N],c[N],c1[N];
//å‡½æ•°å¹³æ–¹
voidã€€get_square(intã€€*a,intã€€&L){ã€€
ã€€ã€€memset(cpxa,0,sizeof(cpxa));
ã€€ã€€memset(cpxb,0,sizeof(cpxb));
ã€€ã€€for(registerã€€intã€€i=0;i<=L;i++)
ã€€ã€€cpxb[i].r=cpxa[i].r=(double)a[i];
ã€€ã€€L=merge_fft(cpxa,cpxb,L,L);
ã€€ã€€for(registerã€€intã€€i=0;i<=L;i++)a[i]=(int)(cpxa[i].r+0.1);
}
//æ±‚C(x)çš„å€¼
doubleã€€get_val_C(doubleã€€x){
ã€€ã€€doubleã€€X=1,Ret=0;
ã€€ã€€for(intã€€i=0;i<=Lc;i++){Ret=Ret+c[i]*X;X=X*x;}
ã€€ã€€returnã€€Ret;
}
//æ±‚C1(x)çš„å€¼
doubleã€€get_val_C1(doubleã€€x){
ã€€ã€€doubleã€€X=1,Ret=0;
ã€€ã€€for(intã€€i=0;i<=Lc1;i++){Ret=Ret+c1[i]*X;X=X*x;}
ã€€ã€€returnã€€Ret;
}
//ç‰›é¡¿è¿­ä»£ã€€â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”ã€€
intã€€tim=30;//è®¾å®šè¿­ä»£æ¬¡æ•°timã€€
doubleã€€Newton_Iteration(doubleã€€x){//è¾“å…¥F(x)çš„åˆå€¼F(0)ï¼Œæ—¢è¿­ä»£ç³»æ•°ã€‚ã€€
ã€€ã€€doubleã€€c;
ã€€ã€€while(1){
ã€€ã€€ã€€ã€€c=get_val_C(x);//æ±‚å‡ºf(F(x))çš„å€¼ã€€
		ã€€ã€€tim--;
ã€€ã€€ã€€ã€€if(fabs(c)<eps)break;//è‹¥æ˜¯F(x)åœ¨è¯¥ç²¾åº¦ä¸‹å·²ç»åˆæ³•ï¼Œä¾¿å¼¹å‡ºã€‚ã€€
ã€€ã€€ã€€ã€€x=x-c/get_val_C1(x);//æ±‚å‡ºF(x)-f(F(x))/f'(F(x))çš„å€¼ï¼Œèµ‹ç»™F(x+1)ã€€
ã€€ã€€ã€€ã€€x=max(x,L);x=min(x,R);//é˜²æ­¢è¶Šç•Œã€€
ã€€ã€€ã€€ã€€if(!tim)returnã€€0;//è‹¥æ˜¯åœ¨è¿­ä»£æ¬¡æ•°timå†…ä¸åˆæ³•ï¼Œä¾¿å¼¹å‡ºæ— è§£ã€‚ã€€
ã€€ã€€}
ã€€ã€€returnã€€x;
}
intã€€main()
{
ã€€ã€€La=read();Lb=read();Lc=read();scanf("%lf%lf",&L,&R);
ã€€ã€€for(intã€€i=0;i<=La;i++)a[i]=read();
ã€€ã€€for(intã€€i=0;i<=Lb;i++)b[i]=read();
ã€€ã€€for(intã€€i=0;i<=Lc;i++)c[i]=read();
ã€€ã€€for(registerã€€intã€€i=0;i<=La;i++)
ã€€ã€€cpxb[i].r=cpxa[i].r=(double)a[i];
ã€€ã€€
ã€€ã€€//æŠŠc^2(x)-a^2(x)-b^2(x)å­˜è¿›cã€€
ã€€ã€€get_square(a,La);
ã€€ã€€get_square(b,Lb);
ã€€ã€€get_square(c,Lc);
ã€€ã€€Lc=max(Lc,max(La,Lb));
ã€€ã€€for(registerã€€intã€€i=0;i<=Lc;i++)
ã€€ã€€c[i]=c[i]-b[i]-a[i];
ã€€ã€€
ã€€ã€€//æ±‚c1(x)ä¸ºc(x)çš„ä¸€é˜¶å¯¼æ•°ã€€
ã€€ã€€Lc1=Lc-1;
ã€€ã€€for(intã€€i=1;i<=Lc;i++)
ã€€ã€€c1[i-1]=c[i]*i;
ã€€ã€€
ã€€ã€€doubleã€€ans=Newton_Iteration((L+R)/2.0);
ã€€ã€€if(tim)ã€€printf("%.8lf\n",ans);
ã€€ã€€elseã€€printf("Inconsistent!\n");
ã€€ã€€returnã€€0;
}
```
### $\ \ \ \ \ \ $è¿™é“é¢˜å°±è¿™æ ·è§£å®Œäº†ã€‚

$\ \ \ \ \ \ \ $~~é¢˜é¢æ¸…æ™°ï¼Œè§£æ³•è‡ªç„¶ï¼Œç é‡é€‚ä¸­~~

$\ \ \ \ \ \ \ $![åƒé²¸](https://s1.ax1x.com/2018/10/14/iUl4qU.png)ä»€ä¹ˆï¼Ÿ

$\ \ \ \ \ \ \ $ä½ ä¸ä¼šç‰›é¡¿è¿­ä»£ï¼Ÿé‚£ä¹ˆæˆ‘ä»¬é©¬ä¸Šè¿›å…¥ä¸‹ä¸€ä¸ªé˜¶æ®µã€‚

------------

# ä¸‰ã€é‡ç‚¹è€ƒç‚¹æ€»ç»“â€”â€”ç‰›é¡¿è¿­ä»£

$\ \ \ \ \ \ \ $è¿™é‡Œç®€å•åœ°è®²ä¸€ä¸‹** ä¸€é˜¶ç‰›é¡¿è¿­ä»£ **ï¼Œç‰›é¡¿è¿­ä»£æ˜¯åº”ç”¨åœ¨æœ€ä¼˜åŒ–é¢†åŸŸéå¸¸é‡è¦çš„ä¸€ç§ç®—æ³•ï¼Œç”±äºå…·æœ‰äºŒé˜¶æ”¶æ•›æ€§ï¼Œæ‰€ä»¥ç›¸æ¯”äºŒåˆ†æ³•èƒ½å¤§å¤§é™ä½è¿­ä»£æ¬¡æ•°ï¼Œåªèƒ½æ±‚ä¸€ä¸ªå¯å¯¼å‡½æ•°çš„é›¶ç‚¹ï¼Œæˆ–è€…æœ‰äºŒé˜¶å¯¼å‡½æ•°çš„æå€¼ï¼Œä¸€ç§å…¨å±€æœç´¢ç®—æ³•ç”¨æ¥è§£npé—®é¢˜æœ€ä¼˜è§£çš„ç®—æ³•ï¼Œåœ¨ç®—æ³•ç«èµ›ä¸­çš„è¿ç”¨æ¯”è¾ƒå°‘è§ï¼ˆ~~Psyduckè¯´~~ï¼‰ã€‚

$\ \ \ \ \ \ \ $å…ˆæ”¾wikiçš„åŠ¨å›¾ï¼Œç‰›é¡¿è¿­ä»£åŠ¨æ€ç¤ºä¾‹å›¾ï¼š

![](https://upload.wikimedia.org/wikipedia/commons/e/e0/NewtonIteration_Ani.gif)

$\ \ \ \ \ \ \ $å®¹æ˜“çœ‹å‡ºä¸€ä¸ªé‡è¦é—®é¢˜ï¼š**å¯¹å‡½æ•°çš„ä¸€ä¸ªç‚¹åšåˆ‡çº¿ï¼Œè¿™ä¸ªåˆ‡çº¿ä¸$x$è½´çš„äº¤ç‚¹å½“åšæ–°çš„ç‚¹ï¼Œé‡å¤æ“ä½œï¼Œå¾—åˆ°çš„ç‚¹å°±ä¼šè¶Šæ¥è¶Šè¶‹è¿‘äºé›¶ç‚¹ã€‚**

$\ \ \ \ \ \ \ $å…·ä½“è¯æ˜æ¶‰åŠ **æ³°å‹’å±•å¼€**ï¼Œå°±ä¸ç»†è®²äº†ï¼ˆ~~å…¶å®æ˜¯è‘±èŠ±Althenä¸ä¼šè¯æ˜~~ï¼‰ã€‚

$\ \ \ \ \ \ \ $è¯´åˆ°å‡½æ•°åˆ‡çº¿ï¼Œè‡ªç„¶å°±éœ€è¦æ±‚å¯¼ã€‚

$\ \ \ \ \ \ \ $åœ¨$\ f(x)\ $ä¸Šï¼Œç‚¹$\ x=a\ $çš„æ–œç‡ä¸º$f'(a)$ï¼Œæ‰€ä»¥è¿™ä¸ªåˆ‡çº¿ä¸$x$è½´çš„äº¤ç‚¹å½“åšæ–°çš„ç‚¹ï¼Œåº”è¯¥æ˜¯$\ a-\frac{f\left(a\right)}{f'\left(a\right)}\ $ã€‚

$\ \ \ \ \ \ \ $æ‰€ä»¥ï¼Œæˆ‘ä»¬å®šä¹‰:
$$F(x)=F(x-1)-\frac{f\left(F(x-1)\right)}{f'\left(F(x-1)\right)}$$

$\ \ \ \ \ \ \ $ä¹Ÿå°±æ˜¯ä¸æ–­å»æ±‚ç‚¹ï¼Œå¯å¾—è¿™ä¸ªç‚¹æ˜¯è¶Šæ¥è¶Šè¶‹è¿‘æŸä¸€ä¸ªé›¶ç‚¹çš„ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œæˆ‘ä»¬çš„ç­”æ¡ˆï¼Œå°±æ˜¯$\ F(+âˆ)\ $ï¼Œæ—¢å‡½æ•°$\ F(x)\ $çš„æ”¶æ•›å€¼ã€‚

$\ \ \ \ \ \ \ $è‹¥$f(x)$äºŒé˜¶å¯å¯¼ï¼Œé‚£ä¹ˆåœ¨å¾…æ±‚çš„é›¶ç‚¹$\ F(+âˆ)\ $å€¼å‘¨å›´å­˜åœ¨ä¸€ä¸ªåŒºåŸŸï¼Œåªè¦èµ·å§‹ç‚¹$\ F(0)\ $ä½äºè¿™ä¸ªé‚»è¿‘åŒºåŸŸå†…ï¼Œé‚£ä¹ˆç‰›é¡¿è¿­ä»£å¿…å®šæ”¶æ•›ã€‚

$\ \ \ \ \ \ \ $![æ‰˜è…®](https://s1.ax1x.com/2018/10/14/iUlhrT.png)

$\ \ \ \ \ \ \ $ä¸è¿‡â€¦â€¦æˆ‘ä»¬æ˜¾ç„¶ä¸éœ€è¦ç®—æ— é™æ¬¡ï¼Œä¿è¯ç²¾åº¦åœ¨ä¸€ä¸ªèŒƒå›´å†…å°±è¡Œäº†ï¼Œæ˜¾ç„¶ï¼Œç‰›é¡¿è¿­ä»£å¯ä»¥åšåˆ°æå¿«æ”¶æ•›åˆ°æˆ‘ä»¬éœ€è¦çš„ç²¾åº¦ï¼Œæˆ‘ä»¬å¹¶ä¸éœ€è¦è®¡ç®—å¤ªå¤šæ¬¡ã€‚

$\ \ \ \ \ \ \ $![åƒé²¸](https://s1.ax1x.com/2018/10/14/iUl4qU.png)è¿˜æœ‰ï¼

$\ \ \ \ \ \ \ $æˆ‘ä»¬æœ€ç»ˆç­”æ¡ˆçš„è®¡ç®—æ•ˆç‡ã€ç²¾åº¦ï¼Œè¿˜ä¸è¿­ä»£ç³»æ•°ï¼Œä¹Ÿå°±æ˜¯æœ€åˆèµ‹å€¼çš„$\ F(0)\ $æœ‰å¾ˆå¤§å…³ç³»ã€‚ï¼ˆ~~ä½†æ˜¯å› ä¸ºæ¯”è¾ƒå°çš„xå–å€¼èŒƒå›´ï¼Œæœ¬é¢˜æ²¡æœ‰å¡è¿­ä»£ç³»æ•°çš„é€‰å®š~~ï¼‰ã€‚

$\ \ \ \ \ \ \ $![åƒç“œ](https://s1.ax1x.com/2018/10/14/iUlfMV.png)

$\ \ \ \ \ \ \ $ç„¶åè´´å‡ºä¸€é˜¶ç‰›é¡¿è¿­ä»£çš„æ¨¡æ¿ï¼š

$\ \ \ \ \ \ \ $ï¼ˆ~~å¦‚æœè¿­ä»£æ¬¡æ•°è¿‡å°‘æˆ–è€…æ— è§£ï¼Œé‚£ä¹ˆä¼šè¿”å›ä¸€ä¸ªé”™è¯¯çš„ç­”æ¡ˆ~~ï¼‰

```
double Newton_Iteration(double F,int tim){//è¾“å…¥è¿­ä»£ç³»æ•°F=F(0)ï¼Œè¿­ä»£æ¬¡æ•°tim
  while(tim--)F=F-f(F)/f1(F);//f1(x)=f'(x)
  return F;
}
```
$\ \ \ \ \ \ \ $è¿™é‡Œåªæ˜¯ç®€å•åœ°è®²ä¸€ä¸‹** ä¸€é˜¶ç‰›é¡¿è¿­ä»£ **ï¼Œå…·ä½“çš„è®²è§£ï¼Œæœ‰å…´è¶£å¯ä»¥æˆ³ä¸‹é¢çš„é“¾æ¥ï¼Œåšä¸»è§‰å¾—è®²å¾—å¾ˆæ¸…æ™° ~~ï¼ˆè¿˜æœ‰äº’äº¤åŠ¨ç”»å•ŠXDï¼‰~~ ã€‚

## $\ \ \ \ \ \ \ $[--Â·--Â·--ã€Šæ¨èè®²è§£æ–‡ç« ã€‹--Â·--Â·--](https://matongxue.com/madocs/205.html)

------------

### å¦‚æœå¯¹æœ¬é¢˜è¿˜æœ‰ä»€ä¹ˆç–‘é—®æˆ–è€…æ›´å¥½çš„åšæ³•ï¼Œæ¬¢è¿æ´›è°·ç§ä¿¡æˆ‘æˆ–è€…å‘é€é‚®ä»¶åˆ°[althenwaysatan@foxmail.com](mailto:althenwaysatan@foxmail.com)
$\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ $![å‘å…‰](https://s1.ax1x.com/2018/10/14/iUlRx0.png)

---

## ä½œè€…ï¼šNaCly_Fish (èµï¼š8)

çœ‹åˆ°è¿™é¢˜çš„æäº¤è®°å½•å’Œé¢˜è§£ï¼Œäººç±»è¿·æƒ‘è¡Œä¸ºå¤§èµç´ æ $+1$   
~~ç„¶è€Œæˆ‘æœ€åˆä¹Ÿå¾ˆè¿·æƒ‘çš„åšäº†ä¸ªå·ç§¯~~
****  
é¢˜æ„å¾ˆç®€å•ï¼Œæ±‚ $[l,r]$ èŒƒå›´å†…çš„ä¸€ä¸ª $x$ï¼Œä½¿å¾—ï¼š  
$$C(x)^2=A(x)^2+B(x)^2$$
è®¾
$$F(x)=A(x)^2+B(x)^2-C(x)^2$$
åˆ™
$$F'(x)=2A(x)A'(x)+2B(x)B'(x)-2C(x)C'(x)$$
æ ¹æ®ç‰›é¡¿è¿­ä»£å…¬å¼æ±‚ $F(x)$ çš„é›¶ç‚¹
$$x_{n+1}=x_n-\frac{F(x_n)}{F'(x_n)}$$
åˆå€¼å¯ä»¥é€‰ $(l+r)/2$ï¼Œ$A(x),B(x),C(x)$ éƒ½æ˜¯å¤šé¡¹å¼å‡½æ•°ï¼Œå®¹æ˜“æ±‚å¯¼ã€‚  

ç„¶åç›´æ¥è®¡ç®—å³å¯ã€‚

---

## ä½œè€…ï¼šAubRain (èµï¼š4)

## FFT+äºŒåˆ†

ä¸ªäººè®¤ä¸ºè¿˜æ˜¯é“æ¯”è¾ƒæ¸…æ–°çš„é¢˜ã€‚

æ ¹æ®é€Ÿåº¦çš„çŸ¢é‡æ€§ï¼Œ$A$ å’Œ $B$çš„çŸ¢é‡å’Œçš„å¤§å°å°±æ˜¯ $ \sqrt{A^2+B^2} $ã€‚äºæ˜¯éœ€è¦æ‰¾ä¸€ä¸ª $x$ ä½¿å¾— $C^2(x)=A^2(x)+B^2(x)$ å³å¯ã€‚


ä»¤ $f(x)=C^2(x)-A^2(x)-B^2(x)$ï¼Œ$f(x)$ å¯ä»¥ç”¨ $FFT$ æ±‚å‡ºã€‚ç„¶åå°±æ˜¯ä¸ªè£¸çš„å‡½æ•°æ±‚é›¶ç‚¹é—®é¢˜äº†ã€‚å› ä¸ºä¸ä¼šç‰›é¡¿è¿­ä»£ï¼Œæ‰€ä»¥å†™çš„äºŒåˆ†ã€‚ï¼ˆæœç„¶æœ€ä¼˜è§£å€’æ•°ç¬¬ä¸€

~~ç¬¬ä¸€æ¬¡æäº¤å°±æ˜¯90åˆ†ï¼Œäº¤äº†åå‡ æ¬¡å˜æˆ60åˆ†äº†~~

äºŒåˆ†æ¬¡æ•°å¤§ä¼š $T$ ï¼Œå°ä¼š $WA$ ï¼Œè°ƒä¸€ä¸‹å°±è¡Œäº†

ä»£ç ï¼š

```cpp
#include<bits/stdc++.h>
#define N 400005
using namespace std;

inline void rd(int &X){
    X=0;char ch=0;
    while(!isdigit(ch))ch=getchar();
    while( isdigit(ch))X=(X<<3)+(X<<1)+(ch^48),ch=getchar();
}

double L,R;
int n,lim,la,lb,lc;
int r[N],a[N],b[N],c[N];
const double Pi=acos(-1);
struct nd{double x,y;}f[N];

nd operator + (nd a,nd b){
    return (nd){a.x+b.x,a.y+b.y};
}nd operator - (nd a,nd b){
    return (nd){a.x-b.x,a.y-b.y};
}nd operator * (nd a,nd b){
    return (nd){a.x*b.x-a.y*b.y,a.y*b.x+a.x*b.y};
}

void fft(int opt){
    for(int i=0;i<lim;i++)
        if(i<r[i]) swap(f[i],f[r[i]]);
    for(int i=1;i<lim;i<<=1){
        nd tmp=(nd){cos(Pi/i),opt*sin(Pi/i)};
        for(int k=0;k<lim;k+=(i<<1)){
            nd b=(nd){1,0};
            for(int j=k;j<k+i;j++,b=b*tmp)
                {nd now=b*f[j+i];f[j+i]=f[j]-now;f[j]=f[j]+now;}
        }
    }
}
void mul(int *g){
	for(int i=0;i<lim;i++)
		f[i]=(nd){g[i],0};
	fft(1);for(int i=0;i<lim;i++) f[i]=f[i]*f[i]; fft(-1);
	for(int i=0;i<=n;i++)
		g[i]=f[i].x/lim+0.5;
}
inline double F(double x){
	double ans=0,now=1;
	for(int i=0;i<=n;i++)
		ans+=a[i]*now,now*=x;
	return ans;
}
void work(double l,double r){
	for(int i=1;i<=25;i++){
		double mid=(l+r)/2;
		F(l)*F(mid)<0 ? r=mid : l=mid;
	}
	printf("%.10lf",l);
} 
signed main(){
    rd(la);rd(lb);rd(lc);scanf("%lf%lf",&L,&R);
    for(int i=0;i<=la;i++) rd(a[i]);
    for(int i=0;i<=lb;i++) rd(b[i]);
    for(int i=0;i<=lc;i++) rd(c[i]);
    n=max(la,max(lb,lc))<<1;
    for(lim=1;lim<=n;lim<<=1);
    for(int i=0;i<lim;i++)
        r[i]=(r[i>>1]>>1)|((i&1)?lim>>1 :0);
	mul(a);mul(b);mul(c);
	for(int i=0;i<=n;i++)
		a[i]=c[i]-a[i]-b[i];
	for(double i=L;i<=R;i+=0.1)
		if(F(i)*F(i+0.1)<0)
			return work(i,i+0.1),0;
	puts("Inconsistent!");
}
```

UPDï¼šå­¦äº†ç‰›é¡¿è¿­ä»£ï¼Œæœç„¶è¿›äº†æœ€ä¼˜è§£å‰ä¸‰

å…ˆç¡®å®šä¸€ä¸ª $x$ ï¼Œæ¯æ¬¡ä»¤ $x=x-\frac {f(x)}{f'(x)}$ï¼Œè¿­ä»£è‹¥å¹²æ¬¡å°±èƒ½ç¡®å®šé›¶ç‚¹äº†ã€‚

ä»£ç ï¼š

```cpp
#pragma GCC optimize(2)
#include<bits/stdc++.h>
#define N 400005
using namespace std;

inline void rd(int &X){
    X=0;char ch=0;
    while(!isdigit(ch))ch=getchar();
    while( isdigit(ch))X=(X<<3)+(X<<1)+(ch^48),ch=getchar();
}

double L,R;
int n,lim,la,lb,lc;
struct nd{double x,y;}f[N];
int r[N],a[N],b[N],c[N],aa[N];
const double Pi=acos(-1),eps=1e-10;

nd operator + (nd a,nd b){
    return (nd){a.x+b.x,a.y+b.y};
}nd operator - (nd a,nd b){
    return (nd){a.x-b.x,a.y-b.y};
}nd operator * (nd a,nd b){
    return (nd){a.x*b.x-a.y*b.y,a.y*b.x+a.x*b.y};
}

void fft(int opt){
    for(int i=0;i<lim;i++)
        if(i<r[i]) swap(f[i],f[r[i]]);
    for(int i=1;i<lim;i<<=1){
        nd tmp=(nd){cos(Pi/i),opt*sin(Pi/i)};
        for(int k=0;k<lim;k+=(i<<1)){
            nd b=(nd){1,0};
            for(int j=k;j<k+i;j++,b=b*tmp)
                {nd now=b*f[j+i];f[j+i]=f[j]-now;f[j]=f[j]+now;}
        }
    }
}
void mul(int *g){
	for(int i=0;i<lim;i++)
		f[i]=(nd){g[i],0};
	fft(1);for(int i=0;i<lim;i++) f[i]=f[i]*f[i]; fft(-1);
	for(int i=0;i<=n;i++)
		g[i]=f[i].x/lim+0.5;
}
inline double F(double x){
	double ans=0,now=1;
	for(int i=0;i<=n;i++)
		ans+=a[i]*now,now*=x;
	return ans;
}
inline double FF(double x){
	double ans=0,now=1;
	for(int i=0;i<n;i++)
		ans+=aa[i]*now,now*=x;
	return ans;
}
void work(double x){
	for(int i=1;i<=30;i++){
		double now=F(x);
		if(fabs(now)<eps) 
			return printf("%.9lf",x),void();
		x=x-now/FF(x);
		x=max(x,L);x=min(x,R);
	}
	puts("Inconsistent!");
} 
signed main(){
    rd(la);rd(lb);rd(lc);scanf("%lf%lf",&L,&R);
    for(int i=0;i<=la;i++) rd(a[i]);
    for(int i=0;i<=lb;i++) rd(b[i]);
    for(int i=0;i<=lc;i++) rd(c[i]);
    n=max(la,max(lb,lc))<<1;
    for(lim=1;lim<=n;lim<<=1);
    for(int i=0;i<lim;i++)
        r[i]=(r[i>>1]>>1)|((i&1)?lim>>1 :0);
	mul(a);mul(b);mul(c);
	for(int i=0;i<=n;i++)
		a[i]=c[i]-a[i]-b[i];
	for(int i=0;i<n;i++)
		aa[i]=a[i+1]*(i+1);
	work((L+R)/2);	
}
```

---

## ä½œè€…ï¼šTaduro (èµï¼š3)

ä¹±æçœŸæ˜¯å¥½ç©ï¼Œç‰›é¡¿è¿­ä»£ä¸å­˜åœ¨çš„ã€‚ã€‚ã€‚

é¦–å…ˆè§£é‡Šé¢˜æ„ï¼šåœ†çš„è¾¹ç•Œå°±æ˜¯å‡ºå£ï¼Œæƒ³è¦åŒæ—¶åˆ°è¾¾åœ†çš„è¾¹ç•Œé€Ÿåº¦å°±è¦ä¸€æ ·ï¼Œä¸‰ä¸ªçŸ¢é‡è¦æ„æˆä¸€ä¸ªç›´è§’ä¸‰è§’å½¢ï¼Œé‚£ä¹ˆå°±æ˜¯è¯´è®©ä½ æ‰¾ä¸€ä¸ªxæ»¡è¶³$c^2(x)=a^2(x)+b^2(x)â€‹$ã€‚

è®¾$f(x)=c^2(x)-a^2(x)-b^2(x)$ï¼Œé‚£ä¹ˆå°±æ˜¯æ±‚$f$åœ¨$[l,r]$èŒƒå›´é‡Œçš„é›¶ç‚¹ã€‚

é¦–å…ˆè°éƒ½çŸ¥é“FFTæ±‚å‡ºfï¼Œæˆ‘ä¸è¯´åºŸè¯äº†ã€‚

ç„¶åå¦‚æœä½ çŸ¥é“ä¸€ä¸ªåŒºé—´$[l,r]$æ»¡è¶³$f(l)\times f(r)<=0$ï¼Œè¿™ä¸ªåŒºé—´ä¸€å®šè‡³å°‘æœ‰ä¸€ä¸ªé›¶ç‚¹ã€‚äºŒåˆ†å°±æ˜¯äº†ï¼Œä¸æƒ³è®²äºŒåˆ†ï¼Œé™„ä¸ŠäºŒåˆ†ä»£ç ï¼š
```c++
int ta=(u>v);
double eps=1e-9,mid,l=min(u,v),r=max(u,v);
while (r-l>eps){
	mid=(l+r)/2.0;
	if (f(mid)>0.0){if (ta) l=mid; else r=mid;}
	else{if (ta) r=mid; else l=mid;}
}
return mid;
```

é‚£ä¹ˆæˆ‘ä»¬æ€ä¹ˆæ‰¾åˆ°ä¸¤ä¸ªå¼‚å·çš„ç‚¹å‘¢ï¼Ÿæ¨¡æ‹Ÿé€€ç«æ‰¾ï¼æ²¡äº†ï¼

```c++
#include<cmath>
#include<cstdio>
#include<cstdlib>
#include<cstring>
#include<iostream>
using namespace std;
const double Pi=acos(-1.0);
struct complex{
	double x,y;
	complex (double xx=0,double yy=0){x=xx,y=yy;}
}a[400001],b[400001],c[400001];
double u,v,ri,le;
int la,lb,lc,r[400001],l,lim,maxn;
complex operator + (complex a,complex b){return complex(a.x+b.x,a.y+b.y);}
complex operator - (complex a,complex b){return complex(a.x-b.x,a.y-b.y);}
complex operator * (complex a,complex b){return complex(a.x*b.x-a.y*b.y,a.x*b.y+a.y*b.x);}
inline void FFT(complex *a,int inv){
	for (int i=0; i<lim; i++)
		if (i<r[i]) swap(a[i],a[r[i]]);
	for (int i=1; i<lim; i<<=1){
		complex wn(cos(Pi/i),inv*sin(Pi/i));
		for (int j=0; j<lim; j+=(i<<1)){
			complex w(1,0);
			for (int k=0; k<i; k++,w=w*wn){
				complex x=a[j+k],y=w*a[i+j+k];
				a[j+k]=x+y; a[i+j+k]=x-y;
			}
		}
	}
	if (inv<0)
		for (int i=0; i<=lim; i++) a[i].x=a[i].x/(double)(lim);
}
inline double getans(double x){
	double sum=0,p=1;
	for (int i=0; i<=maxn; i++)
		sum+=p*c[i].x,p*=x;
	return sum;
}
inline double SA(int inv){
	double t=1,delta=0.995,eps=1e-5,ans=0,num=getans(0),older;
	double res=0,kin=num;
	while (t>eps){
		int w=rand()%2; double dx=((rand()*1000.0)/(RAND_MAX*1000.0));
		if (w) dx*=(ri-ans); else dx*=(le-ans);
		older=getans(ans+dx)-num;
		if (inv){
			if (older>0||exp((double)(-older/t))*RAND_MAX>(rand()*100000.0)/100000.0){
				num+=older,ans+=dx;
				if (num>kin) kin=num,res=ans;
				if (kin>0) return res;
			}
		}
		else{
			if (older<0||exp((double)(older/t))*RAND_MAX>(rand()*100000.0)/100000.0){
				num+=older,ans+=dx;
				if (num<kin) kin=num,res=ans;
				if (kin<0) return res;
			}
		}
		t=t*delta;
	}
//	printf("%.8lf %.8lf\n",res,kin);
	if (((!inv)&&kin>0)||(inv&&kin<0)) return -4;
	return res;
}
double calc(){
	int ta=(u>v);
	double eps=1e-9,mid,l=min(u,v),r=max(u,v);
	while (r-l>eps){
		mid=(l+r)/2.0;
		if (getans(mid)>0.0){if (ta) l=mid; else r=mid;}
		else{if (ta) r=mid; else l=mid;}
	}
	return mid;
}
int main(){
	srand(20190613);
	scanf("%d%d%d",&la,&lb,&lc);
	scanf("%lf%lf",&le,&ri);
	for (int i=0; i<=la; i++) scanf("%lf",&a[i].x);
	lim=1; while (lim<=la+la) lim<<=1,l++;
	for (int i=0; i<lim; i++)
		r[i]=(r[i>>1]>>1)|((i&1)<<(l-1));
	FFT(a,1);
	for (int i=0; i<=lim; i++) a[i]=a[i]*a[i];
	FFT(a,-1); maxn=max(maxn,lim);
	memset(r,0,sizeof(r));
	for (int i=0; i<=lb; i++) scanf("%lf",&b[i].x);
	l=0; lim=1; while (lim<=lb+lb) lim<<=1,l++;
	for (int i=0; i<lim; i++)
		r[i]=(r[i>>1]>>1)|((i&1)<<(l-1));
	FFT(b,1);
	for (int i=0; i<=lim; i++) b[i]=b[i]*b[i];
	FFT(b,-1); maxn=max(maxn,lim);
	memset(r,0,sizeof(r));
	for (int i=0; i<=lc; i++) scanf("%lf",&c[i].x);
	l=0; lim=1; while (lim<=lc+lc) lim<<=1,l++;
	for (int i=0; i<lim; i++)
		r[i]=(r[i>>1]>>1)|((i&1)<<(l-1));
	FFT(c,1);
	for (int i=0; i<=lim; i++) c[i]=c[i]*c[i];
	FFT(c,-1); maxn=max(maxn,lim);
	for (int i=0; i<=maxn; i++) c[i]=c[i]-a[i]-b[i];
//	printf("%d\n",maxn);
//	for (int i=0; i<maxn; i++) printf("%.3lf ",c[i].x);
//	puts("");
	u=SA(0); v=SA(1);
	if (u<-3||v<-3){puts("Inconsistent!"); return 0;}
	printf("%.8lf",calc());
	return 0;
}
```



---

## ä½œè€…ï¼šWalter_Fang (èµï¼š1)

### å‰è¨€
å·ç§¯çš„ä¸åšè¯„ä»·ã€‚

æ­£è§£åº”è¯¥æœ‰ $2$ ä¸ªåšæ³•ï¼Œç‰›é¡¿è¿­ä»£æˆ– $\text{FFT}$ã€‚
### é¢˜æ„
æ±‚è§£åŒºé—´ $[L,R]$ å†…æ»¡è¶³ $C^2(x)=A^2(x)+B^2(x)$ çš„ $x$ã€‚
### è§£æ
ä»¤ $f(x)=C^2(x)-A^2(x)-B^2(x)$ï¼Œæ¥ä¸‹æ¥åˆ† $2$ ç§åšæ³•ã€‚
 - $f(x)$ å¯ä»¥ç›´æ¥ç”¨ $\text{FFT}$ æ±‚ï¼Œé‚£ä¹ˆæ¥ä¸‹æ¥æ ¹æ®é›¶ç‚¹å­˜åœ¨å®šç†äºŒåˆ†æ±‚å‡½æ•°é›¶ç‚¹å³å¯ã€‚é¢˜è§£åŒºç”¨æ¨¡æ‹Ÿé€€ç«çš„ä¹±æåšæ³•æˆ‘æ²¡çœ‹æ‡‚ã€‚
 - $f'(x)=2C(x)C'(x)-2A(x)A'(x)-2B(x)B'(x)$ï¼Œæ ¹æ®ç‰›é¡¿è¿­ä»£å…¬å¼ $x_{n+1}=x_n-\frac{f(x_n)}{f'(x_n)}$ ä»£å…¥è¿­ä»£å‡ æ¬¡å³å¯ã€‚åˆå€¼é€‰ $\frac{l+r}{2}$ã€‚

---

## ä½œè€…ï¼šzhangxiaoyu008 (èµï¼š0)

[é¢˜ç›®ä¼ é€é—¨](/problem/P4986)

[ $\mathtt{My \ Blog}$ â€”â€” é¢˜è§£ï¼šP4986 é€ƒç¦»](/article/yh3sb7yr)

å­¦è¿‡æ•°å­¦çš„éƒ½åº”è¯¥çŸ¥é“ï¼Œå¯ä»¥æŠŠ [è¿™ä¸ªå›¾](https://www.desmos.com/calculator/aogctnixqc?embed) ä¸­çš„é»„è‰²æ®µå¹³ç§»è‡³è“è‰²æ®µï¼Œè¿˜å¯ä»¥æŠŠç´«è‰²æ®µæ—‹è½¬åˆ°ç»¿è‰²æ®µã€‚

ç„¶åä½¿ç”¨å‹¾è‚¡å®šç†ã€‚

è®¾æ€»æ—¶é—´ä¸º $T$

å›¾ä¸­è“è‰²æ°´å¹³æ®µé•¿ä¸º $A(x) \cdot T$ ï¼Œè“è‰²ç«–ç›´æ®µé•¿ä¸º $B(x) \cdot T$ ï¼Œç»¿è‰²æ®µé•¿ä¸º $C(x) \cdot T$ ï¼Œæ•…åˆ—å‡ºæ–¹ç¨‹ï¼š

$A(x)^2 + B(x)^2 = C(x)^2$

æ³¨æ„åˆ°è¿™ä¸ª [![](https://cdn.luogu.com.cn/upload/image_hosting/o6h0djaa.png)](/problem/list?tag=280) æ ‡ç­¾ï¼Œæˆ‘ä»¬ä»¤ $f(x) = A(x)^2 + B(x)^2 - C(x)^2$ ç„¶åç”¨ç‰›é¡¿è¿­ä»£æ³•ã€‚

ä»€ä¹ˆï¼Ÿä½ ä¸ä¼šç‰›é¡¿è¿­ä»£ï¼Ÿ [ç‰›é¡¿è¿­ä»£æ¨¡æ¿é¢˜](/problem/UVA10428)

å½“ç„¶ï¼Œè¿™é‡Œå†è®²ä¸€ä¸‹ç‰›é¡¿è¿­ä»£ã€‚

## ç‰›é¡¿è¿­ä»£

æˆ‘ä»¬é¦–å…ˆ ~~éšæœº~~ ä¸€ä¸ªæœ€åˆçš„è¿‘ä¼¼è§£ã€‚

ï¼ˆå› ä¸º $ x \in [L..R]$ ï¼Œæ‰€ä»¥å¯ä»¥å…ˆå– $\displaystyle\frac{L + R}{2}$ ï¼‰

å‡è®¾å½“å‰è¿‘ä¼¼è§£ä¸º $z$ ï¼Œç”»å‡ºç‚¹ $(z, f(z))$ å†æ­¤å¤„çš„åˆ‡çº¿ï¼Œè®¾å…¶ä¸ $x$ çš„äº¤ç‚¹çš„æ¨ªåæ ‡ä¸º $z_0$ ï¼Œé‚£ä¹ˆè¿™å°±æ˜¯ä¸€ä¸ªæ›´ä¼˜çš„è¿‘ä¼¼è§£ã€‚ç„¶åé‡å¤è¿™ä¸ªè¿­ä»£çš„è¿‡ç¨‹ã€‚

æ ¹æ®å¯¼æ•°çš„å®šä¹‰ï¼ˆå³å‡½æ•°åœ¨æŸä¸€ç‚¹çš„å¯¼æ•°å°±æ˜¯è¯¥å‡½æ•°æ‰€ä»£è¡¨çš„æ›²çº¿åœ¨è¿™ä¸€ç‚¹ä¸Šçš„åˆ‡çº¿æ–œç‡ï¼‰ï¼Œæ‰€ä»¥è¿‡ $(z, f(z)), (z_0, 0) $ ä¸¤ç‚¹çš„ç›´çº¿çš„æ–œç‡ä¸º $f'(z)$ ï¼Œè€Œæ ¹æ®åˆä¸­æ•°å­¦ï¼Œæœ‰å¯ä»¥å¾—åˆ°è¿™ä¸ªæ–œç‡ä¹Ÿä¸º $\displaystyle\frac{f(z) - 0}{z - z_0}$ ï¼Œåˆ—å‡ºæ–¹ç¨‹ï¼š $\displaystyle f'(z) = \frac{f(z)}{z - z_0}$

åŒ–ç®€ä¸€ä¸‹å°±å¯ä»¥å¾—åˆ° $\displaystyle z_0 = z - \frac{f(z)}{f'(z)}$ ï¼Œè¿™å°±æ˜¯ç‰›é¡¿è¿­ä»£çš„å¼å­ï¼

å› ä¸º $f(x) = A(x)^2 + B(x)^2 - C(x)^2$ ï¼Œæ‰€ä»¥ $f'(x) = 2A(x)A'(x) + 2B(x)B'(x) - 2C(x)C'(x)$ ã€‚

$A(x), B(x), C(x)$ éƒ½æ˜¯å¤šé¡¹å¼å‡½æ•°ï¼Œç‰¹åˆ«å®¹æ˜“æ±‚å¯¼ã€‚

æœ€åå‘ç° $0 \le \text{La},\text{Lb},\text{Lc} \le 10^5$ ï¼Œæ‰€ä»¥ [![](https://cdn.luogu.com.cn/upload/image_hosting/s2p6bjaf.png)](/problem/list?tag=313) ã€‚

ä¸€ä¸ªå°å°çš„å‘ã€‚é¢˜ç›®æœ€åä¸€è¡Œï¼šğŸ‘‡

###### $\color{#EEE}{\tt {Notice\ that\ SPEED\ is\ VECTOR.(High\ school\ physics)}}$

è¯´æ˜æœ€åæ±‚è§£å‡ºæ¥çš„è§£å¯ä»¥ä¸º**è´Ÿæ•°**ï¼

## Code:
```cpp
#include <bits/stdc++.h>
using namespace std;â€â€Œ
const int N = 1e6 + 10;â€â€Œ
const double eps = 1e-10;â€â€Œ
int la, lb, lc, a[N], b[N], c[N], d[N];â€â€Œ
double L, R;â€â€Œ
// FFT template
const double PI = acos(-1.0);â€â€Œ
struct Comp{â€â€Œ
	double x, y;â€â€Œ
	Comp(double _x = 0.0, double _y = 0.0) {â€â€Œ
		x = _x;â€â€Œ
		y = _y;â€â€Œ
	}â€â€Œ
	Comp operator-(const Comp &a)const {â€â€Œ
		return Comp(x - a.x, y - a.y);â€â€Œ
	}â€â€Œ
	Comp operator+(const Comp &a)const {â€â€Œ
		return Comp(x + a.x, y + a.y);â€â€Œ
	}â€â€Œ
	Comp operator*(const Comp &a)const {â€â€Œ
		return Comp(x * a.x - y * a.y, x * a.y + y * a.x);â€â€Œ
	}â€â€Œ
}â€â€Œtpa[N], tpb[N];â€â€Œ
int n, m;â€â€Œ
void change(Comp *y, int len) {â€â€Œ
	int k;â€â€Œ
	for(int i = 1, j = len / 2;â€â€Œ i < len - 1;â€â€Œ i ++) {â€â€Œ
		if(i < j) swap(y[i], y[j]);â€â€Œ
		k = len / 2;â€â€Œ
		while(j >= k) {â€â€Œ
			j -= k;â€â€Œ
			k = k / 2;â€â€Œ
		}â€â€Œ
		if(j < k) j += k;â€â€Œ
	}â€â€Œ
}â€â€Œ
void fft(Comp *y, int len, int on) {â€â€Œ
	change(y, len);â€â€Œ
	for(int h = 2;â€â€Œ h <= len;â€â€Œ h <<= 1) {â€â€Œ
		Comp wn(cos(2 * PI / h), sin(on * 2 * PI / h));â€â€Œ
		for(int j = 0;â€â€Œ j < len;â€â€Œ j += h) {â€â€Œ
			Comp w(1, 0);â€â€Œ
			for(int k = j;â€â€Œ k < j + h / 2;â€â€Œ k ++) {â€â€Œ
				Comp u = y[k], t = w * y[k + h / 2];â€â€Œ
				y[k] = u + t, y[k + h / 2] = u - t;â€â€Œ
				w = w * wn;â€â€Œ
			}â€â€Œ
		}â€â€Œ
	}â€â€Œ
	if(on == -1) {â€â€Œ
		for(int i = 0;â€â€Œ i < len;â€â€Œ i ++) y[i].x /= len;â€â€Œ
		for(int i = 0;â€â€Œ i < len;â€â€Œ i ++) y[i].y /= len;â€â€Œ
	}â€â€Œ
}â€â€Œ
int mul(Comp *x1, Comp *x2, int n, int m) {â€â€Œ
	int len = 1;â€â€Œ
	while(len < m + n + 5) len <<= 1;â€â€Œ
	fft(x1, len, 1);â€â€Œ
	fft(x2, len, 1);â€â€Œ
	for(int i = 0;â€â€Œ i < len;â€â€Œ i ++) x1[i] = x1[i] * x2[i];â€â€Œ
	fft(x1, len, -1);â€â€Œ
	return len;â€â€Œ
}â€â€Œ
void sqr(int *x, int &n) {â€â€Œ
	memset(tpa, 0, sizeof tpa);â€â€Œ
	memset(tpb, 0, sizeof tpb);â€â€Œ
	for(int i = 0;â€â€Œ i <= n;â€â€Œ i ++) tpa[i] = tpb[i] = (double)x[i];â€â€Œ
	n = mul(tpa, tpb, n, n);â€â€Œ
	for(int i = 0;â€â€Œ i <= n;â€â€Œ i ++) x[i] = (int)(tpa[i].x + 0.1);â€â€Œ
}â€â€Œ
double calc(double x) {â€â€Œ
	double res = 0;â€â€Œ
	for(int i = lc;â€â€Œ ~i;â€â€Œ i --) res = res * x + c[i];â€â€Œ
	return res;â€â€Œ
}â€â€Œ
double calc_derivative(double x) {â€â€Œ
	double res = 0;â€â€Œ
	for(int i = lc - 1;â€â€Œ ~i;â€â€Œ i --) res = res * x + d[i];â€â€Œ
	return res;â€â€Œ
}â€â€Œ
int cnt = 30;â€â€Œ
void newton(double r) {â€â€Œ
    double c;â€â€Œ
    while(1) {â€â€Œ
        c = calc(r);â€â€Œ
        cnt --;â€â€Œ
        if(fabs(c) < eps) break;â€â€Œ
        r -= c / calc_derivative(r);â€â€Œ
        r = max(r, L), r = min(r, R);â€â€Œ
        if(!cnt) break;â€â€Œ
    }â€â€Œ
	if(cnt) printf("%.8lf\n", r);â€â€Œ
	else printf("Inconsistent!\n");â€â€Œ
}â€â€Œ
int main()
{â€â€Œ
	scanf("%d%d%d%lf%lf", &la, &lb, &lc, &L, &R);â€â€Œ
	for(int i = 0;â€â€Œ i <= la;â€â€Œ i ++) scanf("%d", &a[i]);â€â€Œ
	for(int i = 0;â€â€Œ i <= lb;â€â€Œ i ++) scanf("%d", &b[i]);â€â€Œ
	for(int i = 0;â€â€Œ i <= lc;â€â€Œ i ++) scanf("%d", &c[i]);â€â€Œ
	sqr(a, la), sqr(b, lb), sqr(c, lc);â€â€Œ
	lc = max(lc, max(la, lb));â€â€Œ
	for(int i = 0;â€â€Œ i <= lc;â€â€Œ i ++) c[i] = c[i] - (a[i] + b[i]);â€â€Œ
	for(int i = 1;â€â€Œ i <= lc;â€â€Œ i ++) d[i - 1] = c[i] * i;â€â€Œ
	newton((L + R) / 2);â€â€Œ
	return 0;â€â€Œ
}â€â€Œ
```

---

## ä½œè€…ï¼šNatori (èµï¼š0)

>[æ´›è°· P4986 é€ƒç¦»](https://www.luogu.com.cn/problem/P4986)

ç›¸å½“äºæ±‚å‡½æ•° $f(x)=C^2(x)-A^2(x)-B^2(x)$ åœ¨ $[L,R]$ å†…çš„é›¶ç‚¹ã€‚

è€ƒè™‘ç‰›é¡¿è¿­ä»£ï¼Œè¿‡ $(x_0,f(x_0))$ ä½œ $y=f(x)$ çš„åˆ‡çº¿ $y=f'(x_0)x+b$ï¼Œä»£å…¥ $(x_0,f(x_0))$ å¾—åˆ° $b=f(x_0)-f'(x_0)x_0$ï¼Œæ•… $y=f'(x_0)x+f(x_0)-f'(x_0)x_0=f(x_0)+f'(x_0)(x-x_0)$ã€‚åˆ‡çº¿ä¸ $x$ è½´äº¤ç‚¹çš„æ¨ªåæ ‡ $x=x_0-\frac{f(x_0)}{f'(x_0)}$ã€‚

æœ¬é¢˜ä¸­ï¼Œ$f'(x)=2C(x)C'(x)-2A(x)A'(x)-2B(x)B'(x)$ï¼Œå¯ä»¥ç›´æ¥ä»£å…¥ç‰›é¡¿è¿­ä»£è®¡ç®—ï¼Œåˆå€¼å– $\frac{L+R}{2}$ å¯ä»¥é€šè¿‡ã€‚

```
#include<bits/stdc++.h>
using namespace std;
bool Mbegin;
void File_Work(){
	freopen("test.in","r",stdin);
	freopen("test.out","w",stdout);
}
typedef double Ld;
const int N=1e5+8;
const Ld eps=1e-6;
int a,b,c;
Ld L,R;
vector<Ld> A,B,C,A1,B1,C1;
Ld get(vector<Ld> f,Ld x){
	Ld res=0;
	for(int i=(int)f.size()-1;i>=0;i--)
		res=res*x+f[i];
	return res;
}
void mian(){
	cin>>a>>b>>c>>L>>R;
	A.resize(a+1);
	A1.resize(a);
	B.resize(b+1);
	B1.resize(b);
	C.resize(c+1);
	C1.resize(c);
	for(int i=0;i<=a;i++){
		cin>>A[i];
		if(i>=1)
			A1[i-1]=1.0*i*A[i];
	}
	for(int i=0;i<=b;i++){
		cin>>B[i];
		if(i>=1)
			B1[i-1]=1.0*i*B[i];
	}
	for(int i=0;i<=c;i++){
		cin>>C[i];
		if(i>=1)
			C1[i-1]=1.0*i*C[i];
	}
	Ld ans=(L+R)/2.0;
	bool ok=0;
	for(int i=27;i>=0;i--){
		Ld Ax=get(A,ans),Bx=get(B,ans),Cx=get(C,ans),A1x=get(A1,ans),B1x=get(B1,ans),C1x=get(C1,ans);
		Ld Fx=Cx*Cx-Ax*Ax-Bx*Bx;
		if(fabs(Fx)<eps){
			cout<<fixed<<setprecision(9)<<ans;
			ok=1;
			break;
		}
		Ld F1x=2.0*Cx*C1x-2.0*Ax*A1x-2.0*Bx*B1x;
		ans=min(R,max(L,ans-Fx/F1x));
	}
	if(ok==0)
		cout<<"Inconsistent!";
}
bool Mend;
int main(){
//	File_Work();
	ios::sync_with_stdio(0),cin.tie(0),cout.tie(0);
	cerr<<fixed<<setprecision(3)<<(&Mbegin-&Mend)/1048576.0<<" MB\n\n\n";
	int testnum=1;
//	cin>>testnum;
	while(testnum--)
		mian();
	cerr<<"\n\n\n"<<fixed<<setprecision(0)<<1e3*clock()/CLOCKS_PER_SEC<<" ms";
	return 0;
}
```

```long double``` å’‹è¿‡ä¸äº†ç¬¬ä¸€ä¸ªç‚¹æã€‚ã€‚ã€‚

---

## ä½œè€…ï¼šxyz105 (èµï¼š0)

## ã€æ¨¡æ¿ã€‘ç‰›é¡¿è¿­ä»£æ³• ~~ï¼ˆé¢˜ç›®åˆ«ç§°ï¼‰~~


### é¢˜ç›®æè¿°

å¹³é¢çš„åŸç‚¹ä¸Šæœ‰ä¸¤ä¸ªäººã€‚$1$ å·äººå¯ä»¥ **æ°´å¹³ç§»åŠ¨** æˆ– **ç«–ç›´ç§»åŠ¨**ï¼Œä¸” æ°´å¹³å‘å³ç§»åŠ¨é€Ÿåº¦ä¸º $A(x)$ï¼Œç«–ç›´å‘ä¸Šç§»åŠ¨é€Ÿåº¦ä¸º $B(x)$ï¼›$2$ å·äººå¯ä»¥ **ä»»é€‰ä¸€ä¸ªæ–¹å‘** å¹¶ **æ²¿è¯¥å›ºå®šæ–¹å‘ç§»åŠ¨**ï¼Œç§»åŠ¨é€Ÿåº¦ä¸º $C(x)$ï¼›$A(x),B(x),C(x)$ å‡ä¸ºå…³äº $x$ çš„å¤šé¡¹å¼ã€‚è®¾ç§»åŠ¨æ—¶é—´ä¸º $t$ï¼Œè¦æ±‚åœ¨ $[L,R]$ ä¸­æ‰¾å‡ºä¸€ä¸ª $x$ ä½¿å¾— $t$ å•ä½æ—¶é—´å $1$ å·äººèƒ½å’Œ $2$ å·äºº**æ°å¥½æ±‡åˆ**ã€‚


### è§£é¢˜æ€è·¯

é¦–å…ˆæœ‰ä¸€ä¸ªæ˜¾ç„¶çš„è½¬åŒ–ï¼šå°† $1$ å·äººçš„**è‹¥å¹²æ¬¡**æ°´å¹³ç§»åŠ¨ åˆå¹¶æˆ **ä¸€æ¬¡**æ°´å¹³ç§»åŠ¨ï¼›å°† $1$ å·äººçš„**è‹¥å¹²æ¬¡**ç«–ç›´ç§»åŠ¨ åˆå¹¶æˆ **ä¸€æ¬¡**ç«–ç›´ç§»åŠ¨ã€‚å¦‚ä¸‹å›¾ï¼š

![](https://cdn.luogu.com.cn/upload/image_hosting/n049vnh6.png)

å½“ $1$ å·äºº çš„è·¯å¾„è¢«ç¡®å®šäº†ä¹‹åï¼Œ$2$ å·äººçš„è·¯å¾„ä¹Ÿåº”è¢«ç›´æ¥ç¡®å®šäº†ï¼Œæ¥ä¸Šå›¾ï¼š

![](https://cdn.luogu.com.cn/upload/image_hosting/c5v00hfw.png)

$1$ å·äººçš„æ°´å¹³å‘å³ç§»åŠ¨è·¯ç¨‹ä¸º $A(x)\cdot t$ï¼Œç«–ç›´å‘ä¸Šç§»åŠ¨è·¯ç¨‹ä¸º $B(x)\cdot t$ï¼Œ$2$ å·äººçš„ç§»åŠ¨è·¯ç¨‹ä¸º $C(x)\cdot t$ã€‚å› ä¸ºè¿™ä¸¤ä¸ªäººèµ°çš„è·¯æ„æˆä¸€ä¸ªç›´è§’ä¸‰è§’å½¢ï¼Œæ‰€ä»¥æœ‰ $(A(x)\cdot t)^2+(B(x)\cdot t)^2=(C(x)\cdot t)^2$ï¼Œå³ $A^2(x)+B^2(x)=C^2(x)$ã€‚

ä¹Ÿå°±æ˜¯è¯´ï¼Œè¿™é¢˜è¦æ±‚å…³äº $x$ çš„æ–¹ç¨‹ $F(x)=C^2(x)-A^2(x)-B^2(x)=0$ çš„è§£ã€‚å› ä¸ºå®ƒçš„æ¬¡æ•°ä¸å®šï¼Œå¯è€ƒè™‘ä½¿ç”¨**ç‰›é¡¿è¿­ä»£æ³•**ã€‚

ç‰›é¡¿è¿­ä»£æ³•æä¾›äº†ä¸€ç§å¿«é€Ÿæ±‚ $x$ ä½¿å¾— $F(x)=0$ çš„æŠ€å·§ã€‚å…ˆéšä¾¿å®šä¸€ä¸ªç­”æ¡ˆ $x_0$ï¼Œåœ¨ $x_0$ ä¹‹ä¸Šè¿­ä»£å‡ºçš„ $x_1$ å°†ä¼šæ›´æ¥è¿‘çœŸå®ç»“æœã€‚å…·ä½“çš„è¿­ä»£æ–¹å¼ä¸ºï¼šä½œä¸€æ¡ç›´çº¿ä½¿å®ƒåœ¨ $x_0$ å¤„ä¸ $F(x)$ çš„å‡½æ•°å›¾åƒç›¸åˆ‡ï¼Œè¿™æ¡ç›´çº¿ä¸ $x$ è½´çš„äº¤ç‚¹å³ä¸ºè¿­ä»£å‡ºçš„ $x_1$ï¼Œå¦‚ä¸‹å›¾ï¼ˆå‡è®¾é‚£æ¡çº¢è‰²æ›²çº¿å°±æ˜¯å‡½æ•°å›¾åƒï¼‰ï¼š

![](https://cdn.luogu.com.cn/upload/image_hosting/gdigtraj.png)

ä» $x_1$ è¿­ä»£åˆ° $x_2$ ä¹Ÿæ˜¯åŒç†ã€‚åœ¨ $x_1$ å¤„åšåˆ‡çº¿ï¼Œå…¶ä¸ $x$ è½´äº¤äº $x_2$ï¼š

![](https://cdn.luogu.com.cn/upload/image_hosting/sl5c5kvp.png)

$x_2$ è·‘åˆ°çº¢è‰²æ›²çº¿å³è¾¹å»äº†ä¹Ÿæ²¡å…³ç³»ï¼Œåæ­£å®ƒä¾ç„¶æ›´æ¥è¿‘çœŸæ­£çš„å‡½æ•°é›¶ç‚¹ã€‚åƒè¿™æ ·é‡å¤è¿­ä»£å¤šæ¬¡å³å¯å¾—åˆ°è¾ƒç²¾ç¡®çš„è§£ã€‚

ç”±å¯¼æ•°çš„å‡ ä½•æ„ä¹‰å¯çŸ¥ï¼Œ$x_n$ å¤„çš„åˆ‡çº¿æ–œç‡ä¸º $F'(x_n)$ï¼Œå› ä¸ºè¯¥åˆ‡çº¿è¿‡ç‚¹ $(x_n, F(x_n))$ï¼Œæ•…è¯¥åˆ‡çº¿çš„æ–¹ç¨‹ä¸º $y=F(x_n)+F'(x_n)\cdot(x-x_n)$ã€‚è‹¥ $y=0$ï¼Œå¯ç›¸åº”å¾—å‡ºåˆ‡çº¿ä¸ $x$ è½´çš„äº¤ç‚¹ï¼Œå³æœ‰ $x=x_n-\frac{F(x_n)}{F'(x_n)}$ï¼Œå®ƒå°±æ˜¯ $x_{n+1}$ã€‚

å½“ç„¶æŸäº›æƒ…å†µä¸‹è¿™ç§æ–¹æ³•æ‰¾ä¸åˆ°æ­£ç¡®è§£ï¼Œåªéœ€è¦è¿­ä»£ä¸€å®šæ¬¡æ•°åç‰¹åˆ¤å³å¯ã€‚

~~ç‰›é¡¿è¿­ä»£æ³•çš„æ­£ç¡®æ€§è¯æ˜æš‚ç¼ºã€‚~~


### å‚è€ƒä»£ç 

å·²å°†æäº¤è®°å½•é‡Œæºä»£ç å¤šä½™çš„éƒ¨åˆ†åˆ é™¤ã€‚

```cpp
#include <iostream>
#include <cstdio>
#include <cstring>
#include <algorithm>
#include <vector>
#include <cmath>
#include <complex>
using namespace std;


const double pi = acos(-1.);
const double eps = 1e-10;


typedef long long ll;


vector<int> _vec;

template<typename T, typename _unitRoot>
struct poly{
	
	_unitRoot _urt;
	
	
	vector<T> _a;
	
	inline void clear(){_a.clear();}
	
	
	inline poly operator=(poly _f)
		{_a.resize(_f._a.size()), copy(_f._a.begin(), _f._a.end(), _a.begin()); return *this;}
	
	inline T& operator[](int _i) {return _a[_i];}
	
	
	T operator()(T x)
	{
		T _res = 0;
		for (int i = (int)_a.size() - 1; i >= 0; --i) _res = (_a[i] + x * _res);
		return _res;
	}
	
	
	inline poly deriv() // derivative.
	{
		poly _f; _f._a.resize(max((int)_a.size() - 1, 0));
		for (unsigned int i = 1; i < _a.size(); ++i) _f._a[i - 1] = _a[i] * i;
		return _f;
	}
	inline poly integr() // integral.
	{
		poly _f; _f._a.resize(_a.size() + 1);
		for (unsigned int i = 1; i <= _a.size(); ++i)
			_f._a[i] = _a[i - 1] / i;
		return _f;
	}
	
	
	inline poly operator+=(poly _f)
	{
		int len = max(_a.size(), _f._a.size());
		_a.resize(len), _f._a.resize(len);
		for (int i = 0; i < len; ++i) _a[i] = (_a[i] + _f._a[i]);
		return *this;
	}
	poly operator+(poly _f)
		{poly _res = *this; return _res += _f;}
	
	inline poly operator-=(poly _f)
	{
		int len = max(_a.size(), _f._a.size());
		_a.resize(len), _f._a.resize(len);
		for (int i = 0; i < len; ++i) _a[i] = (_a[i] - _f._a[i]);
		return *this;
	}
	poly operator-(poly _f)
		{poly _res = *this; return _res -= _f;}
	
	
	inline void FFT(int opt)
	{
		int _len = 1;
		for (; ; _len <<= 1)
			if ((unsigned)_len >= _a.size()) {_a.resize(_len); break;}
		_vec.resize(_len), _vec[0] = 0;
		for (int i = 1; i < _len; ++i)
			_vec[i] = ((_vec[i >> 1] >> 1) | ((i & 1) ? (_len >> 1) : 0));
		
		for (int i = 0; i < _len; ++i)
			if (_vec[i] < i) swap(_a[_vec[i]], _a[i]);
		for (int i = 2; i <= _len; i <<= 1)
		{
			T wn = _urt(i);
			if (opt == -1) wn = (T)1 / wn;
			for (int j = 0; j + i <= _len; j += i)
			{
				T w = 1;
				for (int k = 0; k < i/2; k++)
				{
					T k1 = _a[j + k], k2 = w * _a[j + i/2 + k];
					_a[j + k] = k1 + k2;
					_a[j + i/2 + k] = k1 - k2;
					w = w * wn;
				}
			}
		}
		T _vecLen = 1; _vecLen /= _len;
		if (opt == -1)
			for (int i = 0; i < _len; ++i) _a[i] = _a[i] * _vecLen;
	}
	
	poly operator*=(poly _f)
	{
		int len = _a.size() + _f._a.size();
		_a.resize(len), _f._a.resize(len);
		FFT(1), _f.FFT(1);
		for (unsigned int i = 0; i < _a.size(); ++i) _a[i] = _a[i] * _f._a[i];
		FFT(-1); return *this;
	}
	poly operator*(poly _f)
		{poly _res = *this; return _res *= _f;}
	
};

struct urt{
	complex<double> operator()(ll x)
		{double rad = 2 * pi / x; return complex<double>(cos(rad), sin(rad));}
};


complex<double> operator*(complex<double> a, ll b)
	{return a * complex<double>(b);}


int main()
{
	double l, r; int la, lb, lc, len;
	scanf("%d%d%d%lf%lf", &la, &lb, &lc, &l, &r);
	
	poly<complex<double>, urt> a, b, c;
	complex<double> x = (l + r) / 2;
	
	double i1;
	for (int i = 0; i <= la; i++) scanf("%lf", &i1), a._a.push_back(i1);
	for (int i = 0; i <= lb; i++) scanf("%lf", &i1), b._a.push_back(i1);
	for (int i = 0; i <= lc; i++) scanf("%lf", &i1), c._a.push_back(i1);
	
	a = c * c - a * a - b * b;
	len = max(max(la * 2 + 1, lb * 2 + 1), lc * 2 + 1), a._a.resize(len);
	for (int i = 0; i < a._a.size(); ++i) a[i] = a[i].real();
	b = a.deriv();
	
	for (int i = 30; i; i--)
	{
		double a1 = a(x).real();
		if (fabs(a1) < eps) break; else x = min(max(x.real() - a1 / b(x).real(), l), r);
	}
	if (fabs(a(x.real())) < eps) printf("%.10lf", x.real());
	else printf("Inconsistent!");
	
	return 0;
}
```

---


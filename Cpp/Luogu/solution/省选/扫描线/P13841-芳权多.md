# 芳权多

## 题目描述

Yuki 有一个长度为 $n$ 且只包含小写字母的字符串 $s$，其下标从 $1$ 开始。

定义一次修改为对 $s$ **同时**进行下面的两种操作：

- 将 $s$ 中所有为 $\texttt{he}$ 的子串替换为 $\texttt{she}$；
- 将 $s$ 中所有为 $\texttt{his}$ 的子串替换为 $\texttt{her}$。

例如，对 $\texttt{hihehishe}$ 进行一次操作后，该字符串会变为 $\texttt{hishehershe}$。

现有 $q$ 次询问，第 $i$ 次询问给出两个参数 $k_i,x_i$，你需要求出对 $s$ 进行 $k_i$ 次修改后 $s$ 的第 $x_i$ 个字符，或报告不存在第 $x_i$ 个字符。询问之间互相独立。

## 说明/提示

### 样例 1 解释

在该组样例的唯一一组测试数据中，$s=\texttt{hihehishe}$。

对 $s$ 进行一次修改后，$s$ 会变为 $\texttt{hishehershe}$，此时 $s$ 中的第 $7$ 个字符为 $\texttt{e}$ 且不存在第 $12$ 个字符。

对 $s$ 进行两次修改后，$s$ 会变为 $\texttt{hersheshersshe}$，此时 $s$ 中的第 $10$ 个字符为 $\texttt{r}$。

### 数据范围

对于所有测试数据，保证：

- $1 \le T \le 5$；
- $1 \le n,q \le 2\times10^5$；
- $s$ 中只包含小写字母；
- $1 \le k_i,x_i \le 10^9$。

|测试点编号|$n \le$|$q \le$|$k_i \le$|特殊性质|
|:---:|:---:|:---:|:---:|:---:|
|$1$|$200$|$2\times10^5$|$200$|AB|
|$2$|$200$|$2\times10^5$|$200$|A|
|$3$|$200$|$2\times10^5$|$200$|无|	
|$4$|$2000$|$2\times10^5$|$10^9$|AB|
|$5$|$2000$|$2\times10^5$|$10^9$|A|
|$6,7$|$2000$|$2\times10^5$|$10^9$|无|	
|$8$|$2\times10^5$|$2\times10^5$|$10^9$|AB|
|$9$|$2\times10^5$|$2\times10^5$|$10^9$|A|
|$10,11$|$2\times10^4$|$2\times10^4$|$10^9$|C|	
|$12$|$2\times10^5$|$2\times10^5$|$10^9$|C|	
|$13,14$|$2\times10^4$|$2\times10^4$|$10^9$|D|	
|$15$|$2\times10^5$|$2\times10^5$|$10^9$|D|	
|$16\sim18$|$2\times10^4$|$2\times10^4$|$10^9$|无|	
|$19,20$|$2\times10^5$|$2\times10^5$|$10^9$|无|	

- 特殊性质 A：若 $s_i=\texttt{i}$ 且 $i \ne n$，则 $s_{i+1} \ne \texttt{h}$。
- 特殊性质 B：若 $s_i=\texttt{i}$ 且 $i \ne n$，则 $s_{i+1} \ne \texttt{s}$。
- 特殊性质 C：保证任意时刻 $s$ 中 $\texttt{he}$ 子串的数量不大于 $3$。
- 特殊性质 D：保证 $k_i$ 都相同。

## 样例 #1

### 输入

```
0 1
9 3
hihehishe
1 7
1 12
2 10```

### 输出

```
e
0
r```

# 题解

## 作者：Coffee_zzz (赞：0)

显然，如果一个串中不存在 $\texttt{hi}$，则对于每次询问，可以直接记录前缀中 $\texttt{he}$ 的个数，通过二分答案找到第 $x_i$ 个字符是由哪个字符得到的。

如果一个串中存在 $\texttt{hi}$，那么比较头疼的是形如 $\texttt{hihihi...his}$ 和 $\texttt{hihihi...hihe}$ 的结构。只有在右侧的 $\texttt{his}$ 变成 $\texttt{her}$ 再变成 $\texttt{sher}$ 后，左侧的 $\texttt{hi}$ 才能拿到 $\texttt{s}$ 并开始变化。

于是考虑把所有询问按照 $k_i$ 排序，用线段树维护每个前缀增加的字符数量，每次加入新开始变化的 $\texttt{hi}$，线段树二分找到第 $x_i$ 个字符是由哪个字符得到的即可。

细节比较多，时间复杂度 $\mathcal O(T(n+q) \log n)$。

---


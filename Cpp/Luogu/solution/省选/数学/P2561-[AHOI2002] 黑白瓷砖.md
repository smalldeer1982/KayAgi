# [AHOI2002] é»‘ç™½ç“·ç –

## é¢˜ç›®æè¿°

![](https://cdn.luogu.com.cn/upload/pic/1685.png) 

![](https://cdn.luogu.com.cn/upload/pic/1686.png)


## æ ·ä¾‹ #1

### è¾“å…¥

```
1```

### è¾“å‡º

```
2```

## æ ·ä¾‹ #2

### è¾“å…¥

```
2```

### è¾“å‡º

```
4```

# é¢˜è§£

## ä½œè€…ï¼šgxy001 (èµï¼š14)

çœ‹åˆ°æŸ“è‰²æ—‹è½¬ç¿»è½¬ï¼Œæˆ‘ä»¬å°±å¯ä»¥çŒœåˆ°è¿™é“é¢˜éœ€è¦ä½¿ç”¨ PÃ³lya å®šç†ï¼ˆ Ã³ : Alt + 243 ï¼‰ã€‚

## PÃ³lya å®šç†

$$l=\frac 1 {\mid G\mid}\sum_{k=1}^{\mid G \mid}m^{c(p_k)}$$

$G=\{p_1,p_2,\cdots\}$ ä¸º $N$ ä¸ªå¯¹è±¡çš„ç½®æ¢ç¾¤ï¼Œ$c(p_k)$ ä¸ºç½®æ¢ $p_k$ çš„å¾ªç¯æ•°ï¼Œ$l$ ä¸º $m$ ç§é¢œè‰²æŸ“ $N$ ä¸ªå¯¹è±¡çš„æ–¹æ¡ˆæ•°ã€‚

## åˆ†æ

æ˜¾ç„¶ï¼Œåœ¨æ­¤é¢˜ä¸­ $\mid G \mid=6$ï¼Œåˆ†åˆ«ä¸ºå•ä½å…ƒï¼Œç”±æ—‹è½¬å¾—åˆ°çš„ä¸¤ç§ï¼Œç”±ç¿»è½¬å¾—åˆ°çš„ä¸‰ç§ï¼Œå¯ä»¥è§‚å¯Ÿå‡ºæ—¢æ—‹è½¬åˆç¿»è½¬å¾—åˆ°çš„ç½®æ¢åŒ…æ‹¬åœ¨ä¸Šè¿°å…­ç§ä¸­ã€‚åˆç”±é»‘ç™½æŸ“è‰²å¾—å‡º $m=2$ï¼Œç“·ç –å¤§å° $N=\frac{n\times(n+1)}{2}$ã€‚

ä»£å…¥å…¬å¼ï¼Œæˆ‘ä»¬å¯ä»¥å‘ç°ä»…å‰© $c(p_k)$ æ²¡æœ‰æ±‚å‡ºï¼Œæ€è€ƒå¾ªç¯çš„å«ä¹‰ï¼š

$$\bigg(^{a_1\ a_2\ a_3\ \cdots\ a_n}_{a_n\ a_1\ a_2\ \cdots\ a_{n-1}}\bigg)=(1\ 2\ 3\ \cdots\ n)$$

+ æˆ‘ä»¬å¯ä»¥å‘ç°ï¼Œå•ä½å…ƒçš„å¾ªç¯æ•°é‡æ˜¾ç„¶ä¸º $N$ï¼›

+ è€Œå¯¹äºæ—‹è½¬äº§ç”Ÿçš„ä¸¤ç§ç½®æ¢ï¼Œä¸€ä¸ªç‚¹åœ¨æ—‹è½¬ $120\degree$ åå®šç„¶ä¸å¦ä¸€ç‚¹é‡åˆï¼Œåœ¨æ—‹è½¬ä¸‰æ¬¡åå›åˆ°åŸä½ï¼Œå…±ç»è¿‡ä¸‰ä¸ªä½ç½®ï¼Œé‚£ä¹ˆæ¯ä¸€ä¸ªå¾ªç¯çš„å¤§å°å°±ä¸º $3$ï¼Œå¾ªç¯æ•°é‡ä¸º $\lceil\frac N 3\rceil$ï¼Œæ³¨æ„å‘ä¸Šå–æ•´ï¼ŒåŸå› â€”â€”åœ¨æŸäº›æƒ…å†µä¸‹ï¼ˆå¦‚ $n=4$ï¼‰ï¼Œå­˜åœ¨ä¸åŠ¨çš„ä¸­å¿ƒç‚¹ï¼Œå…¶å¾ªç¯å¤§å°ä¸º $1$ï¼›

+ å¯¹äºç¿»è½¬æ¥è¯´ï¼Œé™¤äº†å¯¹ç§°è½´ä¸Šçš„ $\lceil\frac n 2\rceil$ ä¸ªç‚¹ï¼Œå…¶ä½™å‡ä¸ºä¸¤ä¸¤äº¤æ¢ï¼Œå¾ªç¯å¤§å°ä¸º $2$ï¼Œå¾ªç¯æ•°é‡ä¸º $\frac {N-\lceil\frac n 2\rceil} 2+\lceil\frac n 2\rceil$ã€‚

## ç»“è®º

$$
ans=\frac 1 6(2^N+2\times 2^{\lceil\frac N 3\rceil}+3\times2^{(\frac {N-\lceil\frac n 2\rceil} 2+\lceil\frac n 2\rceil)})
$$

$$N=\frac{n\times(n+1)}{2}$$

## ä»£ç 

æ³¨æ„ï¼šæ­¤é¢˜éœ€è¦é«˜ç²¾åº¦ï¼Œä½†å¯ä»¥ä¸ç”¨å¿«é€Ÿå¹‚ã€‚

```cpp
#include<cstdio>//for IO
#include<cstring>//for memset
#include<utility>//for std::swap
int n,bs,xz,fz;//å•ä½å…ƒï¼Œæ—‹è½¬ï¼Œç¿»è½¬ 
struct bign{
	static const int base=10000;
	int a[60],l;
	bign():l(){//init
		memset(a,0,sizeof(a));
	}
	int& operator [](int x){
		return a[x];
	}
	const int& operator [](int const&x)const{
		return a[x];
	}
	friend bign operator + (bign x,bign y){
		bign ans;
		if(x.l<y.l)std::swap(x,y);
		ans[0]=0;
		for(ans.l=0;ans.l<x.l||ans[ans.l];++ans.l){
			ans[ans.l]+=x[ans.l]+y[ans.l];
			if(ans[ans.l]>base)ans[ans.l+1]=1,ans[ans.l]-=base;
			else ans[ans.l+1]=0;
		}
		return ans;
	}
	friend bign operator *(bign x,int y){
		bign ans;
		ans[0]=0;
		for(ans.l=0;ans.l<x.l||ans[ans.l];++ans.l){
			ans[ans.l]+=x[ans.l]*y;
			if(ans[ans.l]>base)ans[ans.l+1]=ans[ans.l]/base,ans[ans.l]%=base;
			else ans[ans.l+1]=0;
		}
		return ans;
	}
	friend bign operator /(bign x,int y){
		for(int i=x.l-1;~i;--i){
			if(i)x[i-1]+=(x[i]%y)*base;
			x[i]/=y;
		}
		while(x.l&&!x[x.l-1])x.l--;
		return x;
	}
	void output(void){
		printf("%d",a[l-1]);
		for(int i=l-2;~i;--i)
			printf("%04d",a[i]);
	}
}bsp,fzp,xzp,res;
int main(){
	scanf("%d",&n);
	bs=n*(n+1)/2;
	fz=(bs-(n+1)/2)/2+(n+1)/2;
	xz=(bs+2)/3;
//ans=(pow(2,bs)+pow(2,fz)*3+pow(2,xz)*2)/6
	bsp[0]=1,bsp.l=1;
	for(int i=1;i<=bs;i++)bsp=bsp*2;
	fzp[0]=1,fzp.l=1;
	for(int i=1;i<=fz;i++)fzp=fzp*2;
	fzp=fzp*3;
	xzp[0]=1,xzp.l=1;
	for(int i=1;i<=xz;i++)xzp=xzp*2;
	xzp=xzp*2;
	res=(bsp+fzp+xzp)/6;
	res.output();
	return 0;
}
```
æœ€åï¼Œå¦‚æœ‰é”™è¯¯ï¼Œè¯·åœ¨è¯„è®ºæŒ‡å‡ºã€‚

---

## ä½œè€…ï¼šhanker_AFO (èµï¼š10)

# $P2561 [AHOI2002]$é»‘ç™½ç“·ç –

## Polyaå®šç†

> å¯¹äºä¸€ä¸ª$n$é˜¶ç½®æ¢
$$
 (a_1,a_2,a_3,..,a_n)=
 \lgroup
 \begin{matrix}
     1 & 2 & 3 & .. & n\\
     a_1 & a_2 & a_3 & .. &a_n\\
 \end{matrix} 
 \rgroup
$$
> æˆ‘ä»¬å¯ä»¥æ‰¾åˆ°å…¶ä¸­è‹¥å¹²å¾ªç¯èŠ‚
>
> å¾ªç¯èŠ‚:
>
> æˆ‘ä»¬è®°$i->a_i$ ä¸ºä¸€æ¬¡å˜æ¢,è‹¥$i$ç»è¿‡$k$æ¬¡å˜æ¢åç­‰äº$i$,ä¸”ä»»ä½•å°äº$k$æ¬¡çš„å˜æ¢å‡ä¸ä¸º$i$
>
> é‚£ä¹ˆæˆ‘ä»¬æ‰¾åˆ°äº†ä¸€ä¸ªå¤§å°ä¸º$k-1$çš„å¾ªç¯èŠ‚
>
> æ˜¾ç„¶ä¸€ä¸ª$n$é˜¶ç½®æ¢æœ€å¤šæœ‰$n$ä¸ªå¾ªç¯èŠ‚,æœ€å°‘$1$ä¸ªå¾ªç¯èŠ‚,å¹¶ä¸”æ¯ä¸ªæ•°åªå­˜åœ¨äºä¸€ä¸ªå¾ªç¯èŠ‚å†…
>
> ä¸¾ä¸ªä¾‹å­:
$$
 \lgroup
 \begin{matrix}
     1 & 2 & 3 & 4 & 5\\
     3 & 5 & 1 & 4 & 2\\
 \end{matrix} 
 \rgroup
 =(13)(25)(4)
$$
> å…¶ä¸­åé¢ç”¨å¤šä¸ªæ‹¬å·ç»„åˆæˆçš„è¡¨è¾¾å¼,å…¶æ¯å¯¹æ‹¬å·å†…çš„æ•°å½¢æˆä¸€ä¸ªå¾ªç¯èŠ‚
>
> è®¡æ•°å…¬å¼:
$$
 L=\frac{1}{|G|}(m^{c(g_1)}+m^{c(g_2)}+m^{c(g_3)}+ \cdots+m^{c(g_s)})
$$
> è§£é‡Šä¸€ä¸‹
>
> $L$:è®¡æ•°ç»“æœ
>
> $G$:ç½®æ¢ç¾¤
>
> $|G|$:ç½®æ¢ç¾¤çš„ç½®æ¢æ•°,å³$s$,è¡¨ç¤ºæ€»å…±æœ‰$s$ç§ç½®æ¢æ–¹å¼
>
> $m$:å¯¹äº$n$é˜¶ç½®æ¢,è¡¨ç¤ºç½®æ¢æ“ä½œå‰,$n$ç§å…ƒç´ æ¯ä¸ªå…ƒç´ çš„å–å€¼,æˆ–è€…ç†è§£ä¸ºæ¯ä¸ªç‚¹çš„æŸ“è‰²æ–¹å¼,å…±$m$ç§
>
> $g_i$:è¡¨ç¤ºå•ä¸ªç½®æ¢,ä¸º$G$ä¸­çš„å…ƒç´ 
>
> $c()$:å‡½æ•°,è¿”å›æ¯ä¸ªç½®æ¢ä¸­çš„å¾ªç¯èŠ‚æ•°
>
> ä»¥ä¸Šä¸º$Polya$å®šç†



æ³¨æ„ç½®æ¢ç¾¤å¿…é¡»æ»¡è¶³ç¾¤çš„æ€§è´¨,å°é—­æ€§,ç»“åˆå¾‹,å•ä½å…ƒ,é€†å…ƒ. 

é¢˜ç›®æ‰€ç»™çš„ç½®æ¢ç§ç±»å¯èƒ½ä¸è¶³ä»¥æ„æˆç¾¤,éœ€è¦è¡¥å……ç½®æ¢



ä¸‹é¢é’ˆå¯¹é¢˜ç›®:

> æ˜¾ç„¶æˆ‘ä»¬æœ‰åŸºç¡€çš„ä¸‰ç§ç½®æ¢,æ—‹è½¬ä¸¤ç§,ç¿»è½¬ä¸€ç§
>
> æ˜æ˜¾æˆ‘ä»¬ç¼ºå¤±äº†ä¸åŠ¨çš„ç½®æ¢,åŠ å…¥å•ä½å…ƒ
>
> å°é—­æ€§:å³Gçš„ä»»æ„ä¸¤ä¸ªå…ƒç´ åœ¨ $*$ä¸‹çš„è¿ç®—ç»“æœéƒ½æ˜¯è¯¥é›†åˆçš„ä¸€ä¸ªå…ƒç´ 
>
> æˆ‘ä»¬å‘ç°ç¿»è½¬å†æ—‹è½¬çš„ç½®æ¢ä¸åœ¨ç¾¤å†…
>
> æ‰€ä»¥æˆ‘ä»¬è¡¥å……ä¸¤ç§ç¿»è½¬,å½¢æˆå…­ç§ç½®æ¢:
>
> 1. æ—‹è½¬:$120^{\circ }, 240^{\circ} $
> 2. ç¿»è½¬,å¯¹äºä¸‰æ¡å¯¹ç§°è½´å„æœ‰ä¸€ç§
> 3. ä¸åŠ¨,å³ä¸ºå•ä½å…ƒ
>
> ç„¶åæ¥ç»Ÿè®¡å¾ªç¯èŠ‚æ•°
>
> 1. æ—‹è½¬,æˆ‘ä»¬çŸ¥é“åŒä¸€æ–¹å¼æ—‹è½¬ä¸‰æ¬¡ä¸€å®šä¼šä¸åŸå›¾é‡åˆ,æ‰€ä»¥å¾ªç¯èŠ‚åº”è¯¥æ˜¯ä¸‰ä¸ªä¸€ç»„,ç„¶åæ‰‹æ¨ä¸€ä¸‹$1 \sim 4$ çš„æƒ…å†µ,å¾—åˆ°å¾ªç¯èŠ‚æ•°ä¸º$\lceil \frac{n}{3} \rceil$
> 2. ç¿»è½¬,ç¿»ä¸¤æ¬¡è‚¯å®šé‡åˆ,ä½†æ˜¯ä¸­è½´çº¿ä¸Šçš„ç‚¹ä¸€ç›´ä¸å˜.æˆ‘ä»¬å…ˆå¾—åˆ°ä¸­è½´çº¿ä¸Šçš„ç‚¹æ•°$s= \lceil \frac{n}{2} \rceil$,å¾ªç¯èŠ‚æ•°ä¸º$\frac{n-s}{2}+s$
> 3. ä¸åŠ¨,æ˜¾ç„¶ä¸º$n$
>
> æ¥ç€ç”±äºæ˜¯é»‘ç™½æŸ“è‰²,æŸ“è‰²æ–¹å¼$m=2$
>
> æˆ‘ä»¬ç›´æ¥å¥—å…¬å¼å³å¯

code:

```cpp
#include <bits/stdc++.h>
using namespace std;

int read(){
	int x=0; char c; int flag=1;
	for(c=getchar();!isdigit(c);c=getchar()) if(c=='-') flag=-1;
	for(;isdigit(c);c=getchar()) x=(x<<1)+(x<<3)+(c^48);
	return x*flag;
}

struct bignum{
    int g[505];
    int l;
    void init() { l=0; memset(g,0,sizeof(g)); }
    void one() { init(); l=1; g[1]=1; }
    void jw(){ while(g[l+1]>0) { ++l; g[l+1]=g[l]/10; g[l]%=10; }  }
    void out() { for(int i=l;i>=1;i--) printf("%d",g[i]); printf("\n"); }
};

bignum operator +(bignum a,bignum b){
    bignum c; c.init();
    c.l=max(a.l,b.l);
    for(int i=1;i<=c.l;i++){
	    c.g[i]+=a.g[i]+b.g[i];
	    c.g[i+1]+=c.g[i]/10;
	    c.g[i]%=10;
	}
	c.jw();
	return c;
}

bignum operator *(bignum a,bignum b){
    bignum c; 
	c.init(); c.l=a.l+b.l-1;
    for(int i=1;i<=a.l;i++)
    for(int j=1;j<=b.l;j++)
    c.g[i+j-1]+=a.g[i]*b.g[j];
    
    for(int i=1;i<=c.l;i++){
	    c.g[i+1]+=c.g[i]/10;
	    c.g[i]%=10;
	}
	c.jw();
	return c;
}

bignum operator /(bignum a,int b){
    for(int i=a.l;i>=1;i--){
	    a.g[i-1]+=(a.g[i]%b)*10;
	    a.g[i]/=b;
	}
	
	while(a.l>1&&a.g[a.l]==0) --a.l;
	return a;
}

bignum ksm(int y){
    bignum ret; ret.one();
    bignum x; x.one(); x.g[1]=2;
    
    while(y){
	    if(y&1) ret=ret*x;
	    y>>=1;
	    x=x*x;
	}
	return ret;
} 

signed main() {
    int n=read();
    
    int Still=n*(n+1)/2;//nè¡Œ,æ ¼å­æ•°1+2+..+n,ç­‰å·®æ•°åˆ—
	int Rotate=(Still+2)/3;//æ—‹è½¬çš„å¾ªç¯èŠ‚æ•°
	int Reverse=(Still-(n+1)/2)/2+(n+1)/2; //ç¿»è½¬çš„å¾ªç¯èŠ‚æ•°
	
	bignum ans; ans.init();
	 ans=ans+ksm(Still)+ksm(Rotate)+ksm(Rotate)+ksm(Reverse)+ksm(Reverse)+ksm(Reverse);
	//å¿˜è®°å†™é«˜ç²¾*ä½ç²¾äº†
    ans=ans/6;
	//ä»¥ä¸Šä¸ºå…¬å¼
	ans.out();
	return 0;
}

```

å› ä¸ºå…¬å¼æ ¼å¼æŒ‚äº†,äº¤äº†å¥½å‡ æ¬¡é¢˜è§£,ä¸çŸ¥é“ä¼šæ€æ ·,

ç®¡ç†å¤§å¤§ä¸è¦ç”Ÿæ°”,åªè¦é€šè¿‡æœ€åè¿™æ¬¡å°±å¥½äº†qwq


---

## ä½œè€…ï¼šBuried_Dream (èµï¼š3)

é¢˜ç›®æ„æ€è¿˜æ˜¯æ¯”è¾ƒæ¸…æ™°çš„ï¼Œç„¶åæˆ‘ä»¬è§‚å¯Ÿä¸€ä¸‹ã€‚

- å¯¹äºâ€œä¸åŠ¨â€ï¼Œå­ç¯ä¸ªæ•°ååˆ†æ˜¾ç„¶ä¸º $n$ã€‚

- å¯¹äºâ€œæ—‹è½¬â€,ä¸ºæ€»æ ¼å­ä¸ªæ•°é™¤ä»¥ $3$ åå‘ä¸Šå–æ•´

- å¯¹äºâ€œå¯¹ç§°â€,ä¸ºæ ¼å­æ€»æ•°åŠ ä¸Šä¸­è½´çº¿ä¸Š $ (n / 2) / 2 $ã€‚

ç„¶åæœ¬ä½“è¿˜è¦ç”¨åˆ°é«˜ç²¾ï¼Œæ•°æ®èŒƒå›´æŒºå°ï¼Œæˆ‘ä»¬å¯ä»¥ç”¨ `Python` æ‰“å‡ºè¡¨æ¥ï¼Œå½“ç„¶ä¹Ÿå¯ä»¥ç›´æ¥ç”¨ `Python` åˆ‡äº†ã€‚

ä¸‹é¢æ˜¯ `Python` ä»£ç ï¼š

```cpp
n=int(input())
m=n*(n+1)//2
t=2**m
c=0
for i in range(1,n+1):
    c+=(i+1)//2
t+=2**c
if n%3==1:
    t+=2*((2**((m-1)//3+1))+(2**((m-4)//2+3)))
else:
    t+=2*((2**(m//3))+(2**c))
print(t//6)
```
## AC code:

```cpp
/*
work by: TLE_Automation
Time: O(TLE)
knowledge:
*/
#include<bits/stdc++.h>
#define TLE std
#define int long long
#define Min(x, y)  (x > y ? y : x);
#define Max(x, y)  (x > y ? x : y);
#define orz cout << "szt lps fjh AK IOI";
using namespace TLE;

const int maxn = 3e6;
const int MAXN = 3e3;
const double down = 0.996;
const double limit = 1e-10;

inline int read() {
	int s = 0, w = 1;
	char ch = getchar();
	while (!isdigit(ch)) {if(ch == '-') {w = -1;}ch = getchar();}
	while (isdigit(ch)) {s = (s << 1) + (s << 3) + (ch ^ 48);ch = getchar();}
	return s * w;
}

inline void print(int x) {
	if (x < 0 ) putchar('-'), x = -x;
	if (x > 9 ) print(x / 10);
	putchar(x % 10 + '0');
}

string a[22] = {"0", "2","4","20","208","5728","351616","44772352","11453771776","5864078802944","6004800040206336","12297829416834170880","50371909152808594571264","412646679762074900658913280","6760803201217259503457555972096","221537999297485988040673580072042496","14518714321960041110131833181979847688192","1902996923607946508078923551753025410956263424","498859225542281529413525041870510961437758449516544","261545905641111698493157893267478067457861758958922891264","274250759553534340359161530426874121271106557923036528403021824"};
signed main() {
	int n = read();
	cout << a[n];
}


```

---

## ä½œè€…ï¼šEkiXu (èµï¼š3)

PÃ³lyaæ˜¯è§£å†³æŸ“è‰²é—®é¢˜çš„å¥½æ–¹æ³•ï¼Œä½†æ˜¯è§‚å¯Ÿé¢˜ä¸­çš„æ‰€ç»™çš„ç½®æ¢å‘ç°ä¸ç¬¦åˆæ„æˆç½®æ¢ç¾¤çš„æ¡ä»¶ï¼ˆä¸æ„æˆå°±ä¸èƒ½ä½¿ç”¨è¯¥å®šç†ï¼‰


1.å•ä½å…ƒeï¼Œæˆ‘ä»¬ç”¨ç½®æ¢â€œä¸åŠ¨â€

2.å°é—­æ€§ï¼Œå¤šåŠ ä¸¤ä¸ªæ–œç€çš„ç½®æ¢


æ ¹æ®PÃ³lyaå®šç†æœ‰


$ans=\Large\frac{1}{|G|}\sum\limits_{f\in G}k^{c(f)}$

å…¶ä¸­ m(f) ä¸ºå­ç¯ä¸ªæ•°


è§‚å¯Ÿä¸€ä¸‹æˆ‘ä»¬å‘ç°


- å¯¹äºâ€œä¸åŠ¨â€ï¼Œæ˜¾ç„¶å­ç¯ä¸ªæ•°ä¸ºn

- å¯¹äºâ€œæ—‹è½¬â€,ä¸ºæ€»æ ¼å­ä¸ªæ•°é™¤ä»¥3å‘ä¸Šå–æ•´

- å¯¹äºâ€œå¯¹ç§°â€,ä¸ºæ ¼å­æ€»æ•°åŠ ä¸Šä¸­è½´çº¿ä¸Šï¼ˆn / 2ï¼‰ï¼ˆå‘ä¸Šå–æ•´ï¼‰ä¸ªæ ¼å­/2


æ‰€ä»¥æœ‰å¦‚ä¸‹ä»£ç ï¼ˆæœªåŠ é«˜ç²¾åº¦ï¼‰


```cpp
#include<cstdio>
BigNum f[300];//æ•°å­—å¤§ ä½¿ç”¨é«˜ç²¾åº¦
int n;
inline void polya(){
    BigNum ans=0;
    int still=(n+1)*n/2;
    int roate=still/3+(still%3?1:0);//å‘ä¸Šå–æ•´
    int filp=(still+(n+1)/2)/2;
    f[0]=1;
    for(int i=1;i<=still||i<=roate||i<=filp;i++)
        f[i]=f[i-1]*2;
    ans=(f[still]+f[roate]*2+f[filp]*3)/6;//2*roate æ˜¯å› ä¸ºæœ‰ä¸¤ç§æ—‹è½¬ 3*filpæ˜¯å› ä¸ºæœ‰ä¸‰æ¡å¯¹ç§°è½´ç¿»è½¬ ä¸€å…±ä¸‰ç§ 
    ans.print();
}
int main(){
    scanf("%d",&n);
    polya();
    return 0;
}
```
è¯¦è§[oi.ozem.pw](https://oi.ozem.pw/CodeVS/p2926.html)


å…³äºPÃ³lyaå®šå¾‹å¯å‚è§ åˆ˜æ±ä½³ã€é»„äº®ã€Šç®—æ³•è‰ºæœ¯ä¸ä¿¡æ¯å­¦ç«èµ›ã€‹å’ŒRichard A.Brualdiã€Šç»„åˆæ•°å­¦ã€‹


---

## ä½œè€…ï¼šPentiment (èµï¼š1)

[PÃ³lya å®šç†](https://www.luogu.com.cn/article/wawpsgc8)æ¨¡æ¿é¢˜ã€‚

æœ¬é¢˜é¢œè‰²æ•°ä¸º $2$ï¼Œå…ƒç´ ä¸ªæ•°ä¸º $N=\dfrac12n(n+1)$ï¼Œç¾¤ $G$ ä¸­çš„å…ƒç´ æœ‰ä¸‰ç±»ï¼šå•ä½å…ƒï¼Œé¡ºæ—¶é’ˆæ—‹è½¬ï¼Œä»¥åŠç»•ä¸‰ä¸ªè½´ç¿»è½¬ã€‚å®¹æ˜“éªŒè¯å®ƒæ˜¯å°é—­çš„ï¼Œå¯¹åº”çš„å°±æ˜¯ä¸‰ä¸ªé¡¶ç‚¹ï¼ˆå›¾ä¸­çš„ $1,4,6$ï¼‰çš„æ’åˆ—ã€‚

è€ƒè™‘è®¡ç®—æ¯ä¸ªå…ƒç´ çš„è½®æ¢æ•°ï¼š

1. å•ä½å…ƒçš„è½®æ¢æ•°ä¸º $N$ï¼›
2. é¡ºæ—¶é’ˆæ—‹è½¬ï¼Œæ¯ä¸ªå…ƒç´ è½¬ $3$ æ¬¡åä¼šå›åˆ°åŸä½ï¼Œè€ƒè™‘åˆ°ä¸­é—´å¯èƒ½æœ‰ä¸åŠ¨ç‚¹ï¼Œè½®æ¢æ•°ä¸º $\left\lceil\dfrac N3\right\rceil$ï¼›
3. ç»•è½´ç¿»è½¬ï¼Œé™¤å»å¯¹è§’çº¿ä¸Šæœ‰ $\left\lceil\dfrac n2\right\rceil$ ä¸ªä¸åŠ¨ç‚¹å¤–ï¼Œå…¶ä½™å…ƒç´ ç¿»è½¬ $2$ æ¬¡åä¼šå›åˆ°åŸä½ï¼Œè½®æ¢æ•°ä¸º $\left\lceil\dfrac n2\right\rceil+\dfrac{N-\left\lceil\dfrac n2\right\rceil}{2}$ã€‚

æ•…ç­”æ¡ˆä¸ºï¼š
$$
\dfrac16\left(2^N+2\times2^{\lceil\frac N3\rceil}+3\times2^{\lceil\frac n2\rceil+\frac{N-\lceil\frac n2\rceil}{2}}\right)
$$

```python
n = int(input())
N = n * (n + 1) // 2
print((pow(2, N) + 2 * pow(2, (N + 2) // 3) + 3 * pow(2, (N - (n + 1) // 2) // 2 + (n + 1) // 2)) // 6)
```

---

## ä½œè€…ï¼šxiezheyuan (èµï¼š0)

## ç®€è¦é¢˜æ„

æœ‰ä¸€ä¸ª $n$ è¡Œçš„ä¸‰è§’å½¢çŸ©é˜µï¼Œæ¯ä¸ªç‚¹å¯ä»¥æŸ“æˆé»‘è‰²æˆ–è€…ç™½è‰²ï¼Œæ±‚æœ¬è´¨ä¸åŒæŸ“è‰²æ–¹æ¡ˆæ•°ã€‚ç§°ä¸¤ç§æ–¹æ¡ˆæœ¬è´¨ç›¸åŒï¼Œå½“ä¸”ä»…å½“å­˜åœ¨ä¸¤ä¸ªæ•´æ•° $a,b$ï¼Œä½¿å¾—å‰è€…æ—‹è½¬ $a180\degree+b120\degree$ åå¯ä»¥å¾—åˆ°åè€…ã€‚

$1\leq n\leq 20$

## æ€è·¯

åˆæ˜¯ä¸€é“ Burnside å¼•ç†ç»å…¸é¢˜ç›®ã€‚

é¦–å…ˆè€ƒè™‘ç¾¤è‚¯å®šæ˜¯ $\frac{1}{2}n(n+1)$ æ¬¡ç½®æ¢ç¾¤çš„ä¸€ä¸ªå­ç¾¤ã€‚ç„¶åè€ƒè™‘å­ç¾¤ä¸­çš„å…ƒç´ ã€‚

å¯ä»¥å†™ä¸€ä¸ª Python ç¨‹åºæ‰¾å‡º $(a180+b120)\bmod 360$ çš„æ‰€æœ‰å¯èƒ½å€¼ï¼š

```python
mp = {}
def dfs(x):
  if x in mp.keys():
    return
  mp[x] = 1
  dfs((x + 180) % 360)
  dfs((x + 120) % 360)
dfs(0)
print(mp)
```

å‘ç°å–å€¼åªæœ‰ä¸‹é¢ $6$ ç§ï¼š

1. $0$
1. $180$
1. $120$
1. $120+120=240$
1. $120+180=300$
1. $120\times 2+180=420,420\bmod 360=60$

ç„¶åå°±å¥½åŠäº†ï¼Œæšä¸¾è¿™å…­ç§æƒ…å†µå³å¯ï¼Œç„¶åå°±æ˜¯è®¡ç®— $|X^g|$ ä¹Ÿå°±æ˜¯ç½®æ¢æƒ…å†µä¸‹æœ¬è´¨ä¸å˜çš„æ•°ç›®ã€‚å‘ç°ç½®æ¢ç¯å¿…é¡»æŸ“æˆä¸€ä¸ªé¢œè‰²ï¼Œæ‰€ä»¥ä¹Ÿå°±æ˜¯ $2^c$ï¼Œå…¶ä¸­ $c$ å°±æ˜¯ç½®æ¢ç¯æ•°é‡ã€‚

æœ€åæœ‰ä¸€ä¸ªå°ç»†èŠ‚ï¼Œå¦‚ä½•æ±‚å‡ºç½®æ¢ï¼Ÿå‘ç°åªéœ€è¦æ±‚å‡º $120\degree$ æ—‹è½¬åçš„ç½®æ¢å’Œ $180\degree$ æ—‹è½¬åçš„ç½®æ¢å³å¯ã€‚è§‚å¯Ÿé¢˜ç›®æè¿°ç»™çš„ç¤ºä¾‹ï¼Œå‘ç° $120\degree$ å°±æ˜¯ä»å·¦ä¸‹è§’å…ƒç´ å¼€å§‹ï¼ŒæŒ‰ç…§å³å¯¹è§’çº¿ä»ä¸€æ¡ä¸€æ¡ä»ä¸Šè‡³ä¸‹å†™ä¸‹æ¥ï¼Œ$180\degree$ å°±æ˜¯æ¯ä¸€è¡Œç¿»è½¬ã€‚éƒ½æ˜¯å¯ä»¥ç®€å•æ¨¡æ‹Ÿçš„ã€‚

äºæ˜¯æœ¬é¢˜å°±åšå®Œäº†ã€‚

## ä»£ç 

ç”±äºæœ¬é¢˜ä¸ºè¿œå¤é¢˜ç›®ï¼Œéœ€è¦é«˜ç²¾ï¼Œæ‰€ä»¥è¿™é‡Œå†™çš„æ˜¯ Pythonã€‚

```python
from copy import deepcopy

n = int(input())
n2 = n

def rotate120(lst : list[list[int]]) -> list[list[int]]:
    ans = []
    for i in range(n2 - 1, -1, -1):
        x, y = i, 0
        now = []
        while x < n2:
            now.append(lst[x][y])
            x += 1
            y += 1
        now.reverse()
        ans.append(now)
    return ans

def rotate180(lst : list[list[int]]) -> list[list[int]]:
    ans = []
    for i in range(n2):
        now = deepcopy(lst[i])
        now.reverse()
        ans.append(now)
    return ans

def get_perm_rings(perm : list[int]) -> int:
    fa = [i for i in range(n + 1)]
    find = lambda x : fa[x] if fa[x] == x else find(fa[x])
    for i in range(n):
        x, y = find(i + 1), find(perm[i])
        fa[x] = y
    ans = 0
    for i in range(n):
        if find(i + 1) == (i + 1):
            ans += 1
    return ans

def flatten(lst : list[list[int]]) -> list[int]:
    ans = []
    for i in lst:
        ans.extend(i)
    return ans

source = []
cnt = 0
for i in range(n):
    now = []
    for j in range(i + 1):
        cnt += 1
        now.append(cnt)
    source.append(now)
n = cnt
ans = 0
ans += 2 ** get_perm_rings(flatten(source))
ans += 2 ** get_perm_rings(flatten(rotate120(source)))
ans += 2 ** get_perm_rings(flatten(rotate180(source)))
ans += 2 ** get_perm_rings(flatten(rotate120(rotate120(source))))
ans += 2 ** get_perm_rings(flatten(rotate120(rotate180(source))))
ans += 2 ** get_perm_rings(flatten(rotate120(rotate180(rotate120(source)))))
print(ans // 6)
```

---

## ä½œè€…ï¼šCaoXian (èµï¼š0)

è¿™é¢˜å§ï¼ŒåŸºæœ¬ä¸Šå°±æ˜¯ä¸ªè£¸çš„ Polya å®šç†ï¼Œç›´æ¥æŠŠç½®æ¢ç¾¤æ„é€ å‡ºæ¥å°±å¥½äº†ã€‚

é¦–å…ˆä¸€ä¸ªæ’ç­‰ç½®æ¢ï¼Œå†åŠ ä¸Šæ—‹è½¬çš„ä¸¤ç§ï¼ˆ$120^\circ$ å’Œ $240^\circ$ï¼Œä¸€æ¬¡æ—‹è½¬é™¤äº†ä¸­å¿ƒå¯èƒ½æœ‰ä¸€ä¸ªä¸­å¿ƒç‚¹ä¸åŠ¨ï¼Œå‰©ä¸‹çš„ç‚¹éƒ½æ˜¯ä¸‰ä¸ªä¸€ç»„å¾ªç¯çš„ã€‚ï¼‰ï¼Œç¿»è½¬çš„è¯å°±æŠŠå‰é¢çš„æƒ…å†µå¤åˆ¶ä¸€éå†ç¿»è½¬å°±å¥½äº†ï¼Œæ€»å…±å°±æœ‰ $6$ ç§ï¼Œæ‰€ä»¥ $|G| = 6$ã€‚

ï¼ˆæˆ‘åˆšå¼€å§‹ä¸€ç›´åœ¨æƒ³å…ˆç¿»è½¬åæ—‹è½¬å’Œå…ˆæ—‹è½¬åç¿»è½¬ä¸åº”è¯¥æ˜¯ä¸åŒçš„å—ï¼Œä¸ºä»€ä¹ˆå¯ä»¥ç›´æ¥æŠŠç¿»è½¬æ”¾åˆ°åé¢æ¥ç®—ã€‚è¿˜çº ç»“äº†åŠå¤©ï¼Œäº‹å®è¯æ˜ä¸å¦‚è‡ªå·±æ‹¿ä¸ªçº¸æ¿å­è½¬ä¸¤ä¸‹å°±çŸ¥é“äº†ğŸ˜‚ï¼Œå…ˆç¿»åè½¬å’Œå…ˆè½¬åç¿»æ²¡å•¥åŒºåˆ«ã€‚ï¼‰

æ¥ä¸‹æ¥æ˜¯ $c(g)$ çš„é—®é¢˜ï¼Œä»¤ $sum = \dfrac{n(n + 1)}{2}$ï¼Œé‚£ä¹ˆæ’ç­‰ç½®æ¢æ˜¾ç„¶æœ‰ $sum$ ä¸ªå¾ªç¯ç½®æ¢ã€‚

æ—‹è½¬çš„æƒ…å†µçš„è¯å› ä¸ºæ˜¯ä¸‰ä¸ªä¸€ç»„çš„ï¼Œå¹¶ä¸”å¯èƒ½æœ‰ä¸€ä¸ªä¸­å¿ƒç‚¹ä¸åŠ¨ä¼šæä¾›ä¸€ä¸ªå¤§å°ä¸º $1$ çš„å¾ªç¯ç½®æ¢ï¼Œæ‰€ä»¥è¿™æ—¶ $c(g) = \left\lceil\dfrac{sum}{3}\right\rceil$ã€‚

ç¿»è½¬ï¼ˆåŠ ä¸Šç¿»è½¬åæ—‹è½¬çš„ï¼‰æœ¬è´¨ä¸Šæ˜¯å°†å…¶æŒ‰ç…§ä¸‰æ¡å¯¹ç§°è½´è¿›è¡Œç¿»è½¬ï¼Œæ¯ä¸€è¡Œçš„å…ƒç´ ä¸¤ä¸¤ä¸€ç»„ç¿»è½¬ï¼Œæ³¨æ„æ¯éš”ä¸€è¡Œå°±ä¼šæœ‰ä¸€ä¸ªä¸­å¿ƒç‚¹ä¸ä¼šç¿»è½¬ï¼Œæ­¤æ—¶ $c(g) = \dfrac{sum - \left\lceil\dfrac{n}{2}\right\rceil}{2} + \left\lceil\dfrac{n}{2}\right\rceil$ã€‚

ä»£å…¥ä¸€ä¸‹ Polya å®šç†å…¬å¼ï¼š

$$
|X / G| = \dfrac{1}{|G|}\sum\limits_{g \in G}|
B|^{c(g)}
$$

ç­”æ¡ˆå³ä¸ºï¼š

$$
\dfrac{2^{sum} + 2 \times 2^{\left\lceil\frac{sum}{3}\right\rceil} + 3 \times 2^{\frac{sum - \left\lceil\frac{n}{2}\right\rceil}{2} + \left\lceil\frac{n}{2}\right\rceil}}{6}
$$

æœ€åå†é«˜ç²¾åº¦è®¡ç®—ä¸€ä¸‹å°±å¥½å•¦ã€‚

ä»£ç ï¼š

```cpp
#include <bits/stdc++.h>
using namespace std;
typedef long long ll;
int n, sum;
struct meow {
	basic_string<int> s;
	meow(int x = 0): s({x}) {
		while(s.back() > 9) s.push_back(s.back() / 10), *(----s.end()) %= 10;
	}
	void operator += (const meow& x) {
		auto it = x.s.begin();
		int r = 0;
		for(auto& i : s) {
			i += r;
			if(it != x.s.end()) i += *(it++);
			r = i / 10;
			i %= 10;
		}
		while(r || it != x.s.end()) {
			s.push_back(r);
			if(it != x.s.end()) s.back() += *(it++);
			r = s.back() / 10;
			s.back() %= 10;
		}
	}
	void operator *= (const int& x) {
		int r = 0;
		for(auto& i : s) {
			i = i * x + r;
			r = i / 10;
			i %= 10;
		}
		while(r) s.push_back(r % 10), r /= 10;
	}
	void operator /= (const int& x) {
		reverse(s.begin(), s.end());
		int r = 0;
		for(auto& i : s) {
			i += r * 10;
			r = i % x;
			i /= x;
		}
		reverse(s.begin(), s.end());
		while(!s.back()) s.pop_back();
	}
	friend ostream& operator << (ostream& out, const meow& x) {
		for(auto it = x.s.rbegin(); it != x.s.rend(); ++it) out << *it;
		return out;
	}
} a, ans;
int main() {
	ios::sync_with_stdio(0);
	cin.tie(0), cout.tie(0);
	cin >> n;
	sum = n * (n + 1) / 2;
	a = 1;
	for(int i = 1; i <= sum; ++i) a *= 2;
	ans += a;
	a = 1;
	for(int i = 1; i <= (sum + 2) / 3; ++i) a *= 2;
	a *= 2;
	ans += a;
	a = 1;
	for(int i = 1; i <= (sum - (n + 1) / 2) / 2 + (n + 1) / 2; ++i) a *= 2;
	a *= 3;
	ans += a;
	ans /= 6;
	cout << ans;
	return 0;
}
```

---

## ä½œè€…ï¼šcreation_hy (èµï¼š0)

è¿™é¢˜å¥½æ°´å•Šï¼Œéš¾ç‚¹æ˜¯é«˜ç²¾å—ï¼ˆ

è¿™é‡Œé»˜è®¤å¤§å®¶éƒ½ä¼š polya å®šç†äº†ï¼Œä¸ä¼šè¯·å…ˆåšæ¿å­ã€‚

æ˜æ˜¾ polya å®šç†ï¼Œå‘ç°æœ‰ä¸‰ç§ç½®æ¢ï¼Œåˆ†åˆ«æ˜¯ï¼šä¸å˜ã€æ—‹è½¬ã€ç¿»è½¬ã€‚

è®°æ ¼å­æ€»æ•°ä¸º $tot$ï¼Œå³ $\dfrac{n(n+1)}{2}$ã€‚

ä¸å˜å°±æ˜¯æ‰€æœ‰å¯èƒ½å˜›ï¼Œ$2^{tot}$ã€‚

ç¿»è½¬ä¹Ÿå¾ˆç®€å•ï¼Œå¥‡æ•°è¡Œä¸­å¿ƒå¯¹ç§°ï¼Œä¸º $\dfrac{i+1}{2}$ï¼Œå¶æ•°è¡Œå°±æ˜¯ä¸€åŠã€‚æŠŠæ¯è¡Œçœ‹æˆä¸€ä¸ªæ•°ï¼Œå‘ç°è¿™ä¸ªæ•°åˆ—æ˜¯ $1+1+2+2+...$ï¼Œåˆ†ç±»è®¨è®ºï¼Œå¦‚æœè¡Œæ•°ä¸ºå¶æ•°å°±æ˜¯ $2\times\dfrac{(\dfrac{n}{2})(\dfrac{n}{2}+1)}{2}$ï¼Œå¦åˆ™ $2\times\dfrac{(\dfrac{n}{2})(\dfrac{n}{2}+1)}{2}+\dfrac{n}{2}+1$ã€‚

ç„¶åå°±æ˜¯æ—‹è½¬ï¼Œæ—‹è½¬æ‰‹åŠ¨æ¨¡æ‹Ÿ $n=[1,4]$ çš„æƒ…å†µå°±å¯ä»¥å‘ç°æ˜¯æ¯ä¸‰ä¸ªä¸€ä¸ªå¾ªç¯ï¼Œå¦‚æœå¤šå‡ºæ¥å°±å•ç‹¬ç®—ã€‚ç”±äº $tot \bmod 3$ ä¸å¯èƒ½ä¸º $2$ï¼Œæ‰€ä»¥åªéœ€è¦è€ƒè™‘è¿™ä¸¤ç§ã€‚

æ¥ä¸‹æ¥è€ƒè™‘æ¯ç§ç½®æ¢çš„æ–¹æ³•æ•°ï¼Œä¸å˜æ˜¾ç„¶ä¸€ç§ï¼Œæ—‹è½¬æœ‰ä¸¤ç§ï¼ˆé¢˜é¢ä¸Šçš„é‚£ä¸¤ç§ï¼‰ï¼Œç¿»è½¬æœ‰ä¸‰ç§ï¼ˆä¸‰ä¸ªè½´ï¼‰ã€‚

```cpp
#include <bits/stdc++.h>
using namespace std;
typedef long long ll;
struct BigInt
{
    vector<int> vec;
    inline BigInt operator+(BigInt t)
    {
        int sz = max(vec.size(), t.vec.size());
        vector<int> res(sz);
        int cry = 0;
        for (int i = 0; i < sz; i++)
        {
            if (vec.size() > i)
                res[i] += vec[i];
            if (t.vec.size() > i)
                res[i] += t.vec[i];
            res[i] += cry;
            cry = res[i] > 9;
            res[i] %= 10;
        }
        if (cry)
            res.emplace_back(1);
        return (BigInt){res};
    }
    inline BigInt operator-(BigInt t)
    {
        vector<int> res = vec;
        int cry = 0;
        for (int i = 0; i < vec.size(); i++)
        {
            if (t.vec.size() > i)
                res[i] -= t.vec[i];
            res[i] -= cry;
            cry = 0;
            if (res[i] < 0)
            {
                res[i] += 10;
                cry = 1;
            }
        }
        while (res.size() > 1 && !res.back())
            res.pop_back();
        return (BigInt){res};
    }
    inline BigInt operator*(BigInt t)
    {
        vector<int> res(vec.size() + t.vec.size() - 1);
        for (int i = 0; i < vec.size(); i++)
            for (int j = 0; j < t.vec.size(); j++)
                res[i + j] += vec[i] * t.vec[j];
        for (int i = 0; i < res.size() - 1; i++)
            res[i + 1] += res[i] / 10, res[i] %= 10;
        while (res.back() > 9)
        {
            res.emplace_back(res.back() / 10);
            res[res.size() - 2] %= 10;
        }
        return (BigInt){res};
    }
    inline BigInt operator/(int k)
    {
        vector<int> res;
        reverse(vec.begin(), vec.end());
        int cur = 0, beg = 0;
        for (int i = 0; i < vec.size(); i++)
        {
            cur = cur * 10 + vec[i];
            if (cur >= k)
            {
                res.emplace_back(cur / k);
                cur %= k;
                beg = 1;
            }
            else if (beg)
                res.emplace_back(0);
        }
        reverse(vec.begin(), vec.end());
        reverse(res.begin(), res.end());
        if (res.empty())
            res.emplace_back(0);
        return (BigInt){res};
    }
    inline bool operator<=(BigInt t)
    {
        if (vec.size() != t.vec.size())
            return vec.size() < t.vec.size();
        for (int i = vec.size() - 1; ~i; i--)
            if (vec[i] != t.vec[i])
                return vec[i] < t.vec[i];
        return true;
    }
    inline BigInt sqrt()
    {
        BigInt l, r, num = *this, _1, _2;
        l.vec.emplace_back(0);
        r.vec.emplace_back(1);
        _1.vec.emplace_back(1);
        _2.vec.emplace_back(2);
        while (r * r <= num)
            r = r * _2;
        while (l <= r)
        {
            BigInt mid = (l + r) / 2;
            if (mid * mid <= num)
                l = mid + _1;
            else
                r = mid - _1;
        }
        return l - _1;
    }
    inline BigInt pow2()
    {
        BigInt res, num = *this, _0, _1, _2;
        res.vec.emplace_back(1);
        _0.vec.emplace_back(0);
        _1.vec.emplace_back(1);
        _2.vec.emplace_back(2);
        while (!(num <= _0))
        {
            res = res * _2;
            num = num - _1;
        }
        return res;
    }
    inline void read()
    {
        string s;
        cin >> s;
        vec.resize(s.size());
        for (int i = 0; i < s.size(); i++)
            vec[s.size() - i - 1] = s[i] - '0';
    }
    inline void print()
    {
        for (int i = vec.size() - 1; ~i; i--)
            cout << vec[i];
    }
    inline int mod3()
    {
        int res = 0;
        for (int x : vec)
            (res += x) %= 3;
        return res;
    }
};
int main()
{
    ios::sync_with_stdio(false);
    cin.tie(nullptr);
    BigInt n, _1;
    _1.vec.emplace_back(1);
    n.read();
    BigInt tot = n * (n + _1) / 2;
    BigInt a = tot.pow2();
    BigInt b = (!(n.vec.back() & 1) ? (n / 2) * (n / 2 + _1) : (n / 2) * (n / 2 + _1) + n / 2 + _1).pow2();
    BigInt c = (!(tot.mod3()) ? tot / 3 : tot / 3 + _1).pow2();
    ((a + b + b + b + c + c) / 6).print();
    return 0;
}   
```

---


# [GCJ 2009 Finals] Doubly-sorted Grid

## 题目描述

如果一个矩形网格的每一行中的字母都从左到右非递减，并且每一列中的字母都从上到下非递减，则称该网格是**双重有序**（doubly sorted）的。下面的例子中，前两个网格是双重有序的，而后两个不是：

```
abc ace aceg base
def ade cdef base
ghi bdg xxyy base
```

现在给你一个部分填充的网格，其中有些格子已经填入了字母。你的任务是计算有多少种方式可以填充剩余的格子，使得最终得到的网格是双重有序的。答案可能很大，请输出方案数对 $10007$ 取模后的结果。


## 说明/提示

**限制条件**

- $1 \leq T \leq 40$
- 部分填充的网格中每个字符要么是 '.'，要么是小写英文字母。

**小数据集（10 分）**

- 时间限制：5 秒
- $1 \leq R, C \leq 4$

**大数据集（20 分）**

- 时间限制：10 秒
- $1 \leq R, C \leq 10$

翻译由 ChatGPT-4.1 完成。

## 样例 #1

### 输入

```
3
2 2
ad
c.
3 3
.a.
a.z
.z.
4 4
....
.g..
.cj.
....```

### 输出

```
Case #1: 23
Case #2: 7569
Case #3: 0```


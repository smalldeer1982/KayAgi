# 题目信息

# [USACO08JAN] Running S

## 题目描述

奶牛们打算通过锻炼来培养自己的运动细胞，作为其中的一员，贝茜选择的运动方式是每天进行 $n$ 分钟的晨跑。在每分钟的开始，贝茜会选择下一分钟是用来跑步还是休息。


贝茜的体力限制了她跑步的距离。更具体地，如果贝茜选择在第 $i$ 分钟内跑步，她可以在这一分钟内跑 $d_i$ 米，并且她的疲劳度会增加 $1$。不过，无论何时贝茜的疲劳度都不能超过 $m$。  

如果贝茜选择休息，那么她的疲劳度就会每分钟减少 $1$，但她必须休息到疲劳度恢复到 $0$ 为止。在疲劳度为 $0$ 时休息的话，疲劳度不会再变动。晨跑开始时，贝茜的疲劳度为 $0$ 。

还有，在 $n$ 分钟的锻炼结束时，贝茜的疲劳度也必须恢复到 $0$，否则她将没有足够的精力来对付这一整天中剩下的事情。

请你计算一下，贝茜最多能跑多少米。


## 说明/提示

【数据范围】  
对于 $100\%$ 的数据，$1\le n \le 10^4$，$1\le d_i \le 1000$，$1\le m \le 500$。

【样例说明】

贝茜在第 $1$ 分钟内选择跑步（跑了 $5$ 米），在第 $2$ 分钟内休息，在第 $3$ 分钟内跑步（跑了 $4$ 米），剩余的时间都用来休息。  
因为在晨跑结束时贝茜的疲劳度必须为0，所以她不能在第 $5$ 分钟内选择跑步。  
最终跑的总距离为 $9$。



## 样例 #1

### 输入

```
5 2
5
3
4
2
10
```

### 输出

```
9
```

# AI分析结果

### 综合分析与结论
本题主要围绕奶牛晨跑问题，要求在满足疲劳度限制和结束时疲劳度为 0 的条件下，计算奶牛最多能跑的距离。各题解大多采用动态规划（DP）的方法，通过定义不同的状态和状态转移方程来解决问题。主要思路是用二维数组表示第 `i` 分钟疲劳值为 `j` 时跑的最远距离，根据跑步和休息的不同情况进行状态转移。部分题解还对数组进行了优化或采用记忆化搜索的方法。

### 所选题解
- **作者：今宵満月（5 星）**
  - **关键亮点**：采用独特的“刷表法”，思路新颖，代码简洁明了。
  - **核心代码**：
```cpp
for(int i=1; i<=n; ++i) {
    for(int j=0; j<=min(i, m); ++j) {
        if(j==0)
            f[i][0]=max(f[i-1][0], f[i][0]);
        else
            f[i+j][0]=max(f[i+j][0], f[i][j]);
        f[i+1][j+1]=max(f[i+1][j+1], f[i][j]+d[i+1]);
    }
}
```
  - **核心思想**：通过两层循环遍历每一分钟和可能的疲劳值，根据不同情况更新状态数组 `f`。当疲劳值为 0 时，更新当前分钟的最大距离；当疲劳值不为 0 时，更新休息后的最大距离和继续跑步后的最大距离。

- **作者：Log_x（4 星）**
  - **关键亮点**：思路清晰，对状态转移方程的分析详细，代码规范。
  - **核心代码**：
```cpp
for (int i = 1; i <= n; ++i)
{
    for (int j = 1; j <= Min(i, m); ++j)
        CkMax(f[i][0], f[i - j][j]);
    CkMax(f[i][0], f[i - 1][0]);
    for (int j = m; j >= 1; --j)
        CkMax(f[i][j], f[i - 1][j - 1] + d[i]);
}
```
  - **核心思想**：同样通过两层循环，先更新疲劳值为 0 时的最大距离，考虑从之前疲劳值不为 0 时休息过来和继续休息的情况；再更新疲劳值不为 0 时的最大距离，即从之前疲劳值少 1 时跑步过来。

- **作者：D10s（4 星）**
  - **关键亮点**：对数组进行了优化，采用一维数组表示状态，减少了空间复杂度。
  - **核心代码**：
```cpp
for(int i=n;i;i--)
{
    for(int j=1;j<=m;j++)
    {
        if(2*j+i-1>n) break;
        f[i]=max(f[i],f[i+2*j]+s[i+j-1]-s[i-1]);
    }
    f[i]=max(f[i],f[i+1]);
}
```
  - **核心思想**：从后往前遍历，对于每一分钟，考虑跑 `j` 分钟后再休息 `j` 分钟的情况，用前缀和维护跑步的距离，更新当前分钟的最大距离；同时考虑待在原地不走的情况。

### 最优关键思路或技巧
- **动态规划思想**：通过定义合适的状态和状态转移方程，将问题分解为子问题，逐步求解。
- **刷表法与填表法**：刷表法从当前状态更新后续状态，填表法从之前状态更新当前状态，可根据具体问题选择合适的方法。
- **数组优化**：在满足条件的情况下，可将二维数组优化为一维数组，减少空间复杂度。

### 可拓展之处
同类型题或类似算法套路包括其他的动态规划问题，如背包问题、最长公共子序列问题等。这些问题都可以通过定义状态和状态转移方程来解决，关键在于如何合理地定义状态和分析状态之间的转移关系。

### 推荐题目
1. [P1048 采药](https://www.luogu.com.cn/problem/P1048)：经典的 0 - 1 背包问题，与本题类似，需要在一定的限制条件下选择最优方案。
2. [P1176 路径计数 2](https://www.luogu.com.cn/problem/P1176)：动态规划问题，通过状态转移方程计算从起点到终点的路径数量。
3. [P1216 数字三角形](https://www.luogu.com.cn/problem/P1216)：简单的动态规划问题，从下往上递推计算最大路径和。

### 个人心得摘录与总结
- **yjxyjx**：做题时要相信草稿，草稿是做题之本。在面对关系复杂的问题时，通过草稿可以更好地理清思路。
- **Y_B_Y**：记忆化搜索主要要处理好边界条件，否则容易出错，这是血与泪的教训。在使用记忆化搜索时，一定要仔细考虑边界情况，确保程序的正确性。

---
处理用时：36.76秒
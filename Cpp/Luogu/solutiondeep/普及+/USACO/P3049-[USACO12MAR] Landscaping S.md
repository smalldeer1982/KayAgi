# 题目信息

# [USACO12MAR] Landscaping S

## 题目背景

*本题与 [2016 年公开赛白金组同名题目](/problem/P2748) 在题意上一致，唯一的差别是数据范围。*

## 题目描述

Farmer John 打算修建一座花园，他需要移动不少泥土。

花园由 $N$ 个花坛组成（$1 \leq N \leq 100$），其中花坛 $i$ 包含 $A_i$ 单位的泥土。FJ 希望花坛 $i$ 包含 $B_i$ 单位的泥土，保证 $0 \leq A_i,B_i \leq 10$。

为了达到这个目标，他可以做这几件事情：

- 购买一单位的泥土，放在指定的花坛中，费用为 $X$。
- 从任意一个花坛中移走一单位泥土，费用为 $Y$。
- 从花坛 $i$ 运送一单位泥土到花坛 $j$，费用为 $Z|i-j|$。

请你帮 FJ 计算移动泥土的最小开销。

## 说明/提示

按下面的方案，最小花费为 $210$，可以证明不存在开销更小的方案。

- 移除 $4$ 号花坛的一单位泥土，花费 $200$。
- 将 $4$ 号花坛的三单位泥土移到 $1$ 号花坛，花费 $3 \times 3=9$。
- 将 $3$ 号花坛的一单位泥土移到 $2$ 号花坛，花费 $1 \times 1=1$。

## 样例 #1

### 输入

```
4 100 200 1 
1 4 
2 3 
3 2 
4 0 
```

### 输出

```
210 
```

# AI分析结果

### 综合分析与结论
本题主要围绕如何计算移动泥土的最小开销展开，题解主要采用了动态规划（DP）和贪心算法两种思路。

- **动态规划思路**：多数题解将初始数组和目标数组进行特殊离散化处理，把每个花坛的泥土按单位拆分，将问题转化为用前 `i` 个单位泥土构造前 `j` 个单位泥土的问题，通过定义二维 DP 数组 `f[i][j]` 来表示最小花费，并根据三种操作（购买、移除、运送）推导出状态转移方程 `f[i][j] = min(f[i - 1][j] + y, f[i][j - 1] + x, f[i - 1][j - 1] + z * abs(a[i] - b[j]))`。
- **贪心算法思路**：部分题解使用堆来维护多泥土和少泥土的单位泥土信息，在处理每个单位泥土时，比较直接购买/移除和从其他位置运送泥土的费用，选择最小花费的操作，并将当前操作的信息存入堆中，供后续更新使用。

### 所选题解
- **作者：Erutsiom (赞：22)，4星**
    - **关键亮点**：思路清晰，详细展示了将数组转化的过程，代码注释较为详细，有助于理解。
    - **个人心得**：入门 dp 第三天看到这个题非常懵，今天终于看懂了激动得来发篇题解，强调了对动态规划理解的过程。
- **作者：daniEl_lElE (赞：15)，4星**
    - **关键亮点**：对 DP 思路进行了详细分析，先探讨了一维 DP 的不可行性，再引出二维 DP 的思路，逻辑连贯。
    - **个人心得**：提到这题可能有贪心思想但想不出来，总结出“贪心不行就 DP，DP 不行就暴力”的口诀。
- **作者：pldzy (赞：4)，4星**
    - **关键亮点**：对思路的阐述较为全面，包括大致方法、“量化泥土”、初始化 DP 数组和动态转移方程的推导，步骤清晰。
    - **个人心得**：无。

### 重点代码及核心实现思想
#### 动态规划实现
```cpp
#include<bits/stdc++.h> 
using namespace std;

int n, x, y, z;
const int maxn = 1005;
int a[maxn], b[maxn];
int f[maxn][maxn];
int numa, numb;

inline int minn (int a, int b, int c)
{
    return min (a, min (b, c));
}

int main()
{
    scanf ("%d %d %d %d", &n, &x, &y, &z);
    numa = 1;
    numb = 1;
    for (int i = 1; i <= n; i++)
    {
        int aa, bb;
        scanf ("%d %d", &aa, &bb);
        for (int j = 1; j <= aa; j++) a[numa++] = i;
        for (int l = 1; l <= bb; l++) b[numb++] = i;
    }
    for (int i = 1; i <= numa; i++) f[i][0] = i * y;
    for (int i = 1; i <= numb; i++) f[0][i] = i * x;
    for (int i = 1; i <= numa; i++)
    {
        for (int j = 1; j <= numb; j++)
        {
            f[i][j] = minn (f[i - 1][j] + y, f[i][j - 1] + x, f[i - 1][j - 1] + z * abs (a[i] - b[j]));
        }
    }
    printf ("%d\n", f[numa][numb]);
    return 0;
}
```
**核心实现思想**：
1. 首先读取输入，将每个花坛的泥土按单位拆分存储到数组 `a` 和 `b` 中。
2. 初始化 DP 数组的边界条件，`f[i][0]` 表示目标数组为空时，移除 `i` 个单位泥土的花费；`f[0][j]` 表示原数组为空时，购买 `j` 个单位泥土的花费。
3. 通过两层循环遍历所有状态，根据状态转移方程更新 `f[i][j]` 的值。
4. 最终 `f[numa][numb]` 即为最小花费。

#### 贪心算法实现
```cpp
#include<bits/stdc++.h>
using namespace std;
const long long int N=100001;
long long int n,a[N],b[N],x,y,z;
long long int V[N];
long long int ans;
priority_queue<long long int,vector<long long int>,greater<long long int> > ovo,ovo2;
int main(){
    scanf("%lld%lld%lld%lld",&n,&x,&y,&z);
    for(long long int i=1;i<=n;i++){
        scanf("%lld%lld",&a[i],&b[i]);
        for(long long int o=1;o<=a[i]-b[i];o++){
            V[i]=y;
            if(!ovo.empty()){
                V[i]=min(V[i],i*z+ovo.top());
                ovo.pop();
            }
            ovo2.push(-V[i]-i*z);
            ans+=V[i];
        }
        for(long long int o=1;o<=b[i]-a[i];o++){
            V[i]=x;
            if(!ovo2.empty()){
                V[i]=min(V[i],i*z+ovo2.top());
                ovo2.pop();
            }
            ovo.push(-V[i]-i*z);
            ans+=V[i];
        }
    }
    printf("%lld\n",ans);
}
```
**核心实现思想**：
1. 读取输入，对每个花坛的泥土数量进行比较。
2. 若当前花坛泥土多，先将移除费用设为初始值 `y`，然后检查少泥土的堆中是否有更优的运送方案，更新费用并将当前操作信息存入多泥土的堆中。
3. 若当前花坛泥土少，先将购买费用设为初始值 `x`，然后检查多泥土的堆中是否有更优的运送方案，更新费用并将当前操作信息存入少泥土的堆中。
4. 累加每次操作的费用，最终得到最小花费。

### 最优关键思路或技巧
- **特殊离散化处理**：将每个花坛的泥土按单位拆分，把问题转化为更易处理的形式，方便定义状态和推导状态转移方程。
- **堆的使用**：在贪心算法中，使用堆来维护多泥土和少泥土的单位泥土信息，方便快速找到最优的运送方案。

### 可拓展之处
同类型题或类似算法套路：
- **字符串编辑距离问题**：如洛谷 P2758 编辑距离，通过动态规划计算将一个字符串转换为另一个字符串的最小操作次数。
- **货物运输问题**：给定多个仓库的货物初始量和目标量，以及不同仓库之间的运输费用，求最小运输成本，可使用类似的动态规划或贪心思路。
- **资源分配问题**：将资源从一些节点分配到另一些节点，有不同的操作和费用，求最小总费用。

### 推荐题目
- [P2758 编辑距离](https://www.luogu.com.cn/problem/P2758)
- [P1854 花店橱窗布置](https://www.luogu.com.cn/problem/P1854)
- [P1004 方格取数](https://www.luogu.com.cn/problem/P1004)

### 个人心得总结
- **Erutsiom**：入门 dp 时遇到本题很懵，经过学习最终理解，强调了学习动态规划需要逐步积累和理解。
- **daniEl_lElE**：尝试贪心思路失败后转向 DP，总结出“贪心不行就 DP，DP 不行就暴力”的经验，提醒在解题时可以多尝试不同思路。

---
处理用时：56.20秒
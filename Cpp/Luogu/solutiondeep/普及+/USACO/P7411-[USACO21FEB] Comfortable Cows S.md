# 题目信息

# [USACO21FEB] Comfortable Cows S

## 题目描述

Farmer Nhoj 的草地可以被看作是一个由正方形方格组成的巨大的二维方阵（想象一个巨大的棋盘）。初始时，草地上是空的。

Farmer Nhoj 将会逐一地将 $N$（$1\le N\le 10^5$）头奶牛加入到草地上。第 $i$ 头奶牛将会占据方格 $(x_i,y_i)$，不同于所有已经被其他奶牛占据的方格（$0\le x_i,y_i\le 1000$）。

一头奶牛被称为是「舒适的」，如果它水平或竖直方向上与恰好三头其他奶牛相邻。然而，太舒适的奶牛往往产奶量落后，所以 Farmer Nhoj 想要额外加入一些奶牛直到没有奶牛（包括新加入的奶牛）是舒适的。注意加入的奶牛的 $x$ 和 $y$ 坐标并不一定需要在范围 $0 \ldots 1000$ 内。

对于 $1 \ldots N$ 中的每个 $i$，输出当初始时草地上有奶牛 $1\ldots i$ 时，Farmer Nhoj 为使得没有奶牛舒适，需要加入的奶牛的最小数量。


## 说明/提示


对于 $i=4$，Farmer Nhoj 需要在 $(2,1)$ 加入一头奶牛使得位于 $(1,1)$ 的奶牛不再舒适。

对于 $i=9$，Farmer Nhoj 的最优方案是在 $(2,0)$、$(3,0)$、$(2,-1)$ 和 $(2,3)$ 加入奶牛。

供题：Benjamin Qi

## 样例 #1

### 输入

```
9
0 1
1 0
1 1
1 2
2 1
2 2
3 1
3 2
4 1```

### 输出

```
0
0
0
1
0
0
1
2
4```

# AI分析结果

### 综合分析与结论
这些题解整体思路较为一致，都是动态处理每头奶牛加入后的情况，当有奶牛处于舒适状态时就添加奶牛使其不舒适。主要采用 DFS 或 BFS 算法来递归处理新添加奶牛带来的影响。对于坐标可能出现负数的问题，大部分题解通过给坐标加上一个常数来避免数组越界。各题解在代码实现和细节处理上存在差异，但核心思想相同。

### 所选题解
- **作者：_zy_ (赞：22)，4星**
    - **关键亮点**：思路清晰，通过动态加点和递归处理的方式解决问题，代码简洁明了，对边界情况的处理也有说明。
    - **个人心得**：无

### 重点代码
```cpp
// 递归处理舒适奶牛的函数
void dfs(int x,int y)
{
    int flag=0;
    int t_x,t_y;
    if(!map[x][y]) return ;        // 若该位置没有奶牛，直接返回
    for(int i=1;i<=4;i++) {
        int xx=x+dx[i];
        int yy=y+dy[i];
        if(map[xx][yy]) flag++;
        else t_x=xx,t_y=yy;
    }
    if(flag!=3) return ;        // 若该奶牛不舒适，直接返回
    else {
        map[t_x][t_y]=1;
        cnt++;                    // 增加添加奶牛的数量
        for(int i=0;i<=4;i++)        // 递归处理新添加奶牛及其周围的奶牛
            dfs(t_x+dx[i],t_y+dy[i]);
    }
}

int main()
{
    n=re();
    while(n--)
    {
        int x,y;
        x=re()+1000; y=re()+1000;    // 防止数组超界
        if(map[x][y]) cnt--;        // 若该位置已有奶牛，减少添加奶牛的数量
        map[x][y]=1;
        for(int i=0;i<=4;i++)        // 处理新加入奶牛及其周围的奶牛
        {
            int xx=x+dx[i];
            int yy=y+dy[i];
            dfs(xx,yy);
        }
        printf("%d\n",cnt);
    }
    return 0;
}
```
**核心实现思想**：`dfs` 函数用于检查奶牛是否舒适，若舒适则添加奶牛并递归处理新添加奶牛及其周围的奶牛。`main` 函数中，每次加入新奶牛时，先处理可能的重复情况，再调用 `dfs` 函数处理相关奶牛，最后输出添加奶牛的数量。

### 最优关键思路或技巧
- **动态处理**：每加入一头奶牛，只处理其自身及周围奶牛的状态变化，避免全局遍历，提高效率。
- **递归处理**：使用 DFS 或 BFS 递归处理新添加奶牛带来的影响，确保所有舒适的奶牛都被处理。
- **坐标偏移**：给坐标加上一个常数，避免数组越界问题。

### 可拓展之处
同类型题或类似算法套路：
- 网格图上的动态模拟问题，如在网格中添加元素，根据元素之间的关系进行状态更新。
- 递归处理图中节点状态变化的问题，如在图中添加边，根据边的连接关系更新节点的属性。

### 推荐题目
- [P1162 填涂颜色](https://www.luogu.com.cn/problem/P1162)：涉及网格图的填充和状态判断。
- [P1451 求细胞数量](https://www.luogu.com.cn/problem/P1451)：需要在网格图中统计连通区域的数量。
- [P1596 [USACO10OCT]Lake Counting S](https://www.luogu.com.cn/problem/P1596)：处理网格图中连通区域的问题。

### 个人心得摘录与总结
- **约瑟夫用脑玩**：尝试分析奶牛贡献时遇到问题，发现无限扩展不可能，但未分析出准确界限。总结：在分析问题时可能会遇到困难，需要换个角度思考，有时可以直接采用暴力方法解决问题。 

---
处理用时：30.39秒
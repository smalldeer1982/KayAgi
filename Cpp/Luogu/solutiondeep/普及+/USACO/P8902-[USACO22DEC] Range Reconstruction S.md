# 题目信息

# [USACO22DEC] Range Reconstruction S

## 题目描述

Bessie 有一个数组 $a_1, \cdots, a_N$，其中 $1 \le N \le 300$ 并对于所有 $i$ 有 $0 \le a_i \le 10^9$。她不会告诉你数组 $a$ 本身，但她会告诉你 $a$ 的每个子数组的全距。也就是说，对于每对索引 $i \le j$，Bessie 告诉你 $r_{i,j}= \max a[i \cdots j]− \min a[i \cdots j]$。给定这些 $r$ 的值，构造一个可以作为 Bessie 的原始数组的数组。你的数组中的数值应在 $[−10^9,10^9]$ 范围内。 

## 说明/提示

### 样例 1 解释

例如，$r_{1,3}=\max a[1 \cdots 3]−\min a[1\cdots 3]=3−1=2$。

### 样例 2 解释

这个样例满足子任务 $1$ 的限制。

### 样例 3 解释

这个样例满足子任务 2 的限制。 

### 测试点性质

- 测试点 $5$ 满足 $r_{1,N} \le 1$。
- 测试点 $6-8$ 满足对于所有 $1 \le i<N$ 均有 $r_{i,i+1}=1$。
- 测试点 $9-14$ 没有额外限制。

## 样例 #1

### 输入

```
3
0 2 2
0 1
0```

### 输出

```
1 3 2```

## 样例 #2

### 输入

```
3
0 1 1
0 0
0```

### 输出

```
0 1 1```

## 样例 #3

### 输入

```
4
0 1 2 2
0 1 1
0 1
0```

### 输出

```
1 2 3 2```

## 样例 #4

### 输入

```
4
0 1 1 2
0 0 2
0 2
0```

### 输出

```
1 2 2 0```

# AI分析结果

### 综合分析与结论
这些题解主要围绕根据数组子数组的全距来构造原数组这一问题展开。各题解思路有相似之处，大多从相邻元素的关系入手，利用全距信息确定数组元素的值。部分题解采用了分情况讨论、枚举验证等方法，在时间复杂度上有所差异。

### 所选题解
- **作者：Timmy_ (赞：7)，4星**
  - **关键亮点**：思路清晰，详细阐述了如何判断相邻元素是加还是减全距值，通过前缀和优化验证过程，时间复杂度为 $\Theta (n ^ 2)$。
  - **个人心得**：作者分享了自己比赛时没开 long long 导致 0 分的经历，提醒大家注意细节。

### 重点代码
```cpp
#include <iostream>
using namespace std;
const int N=305;
int n;
int r[N][N];//输入
int a[N];//构造数组
int maxn[N],minx[N];//前缀和
int main()
{
    int i,j;
    cin>>n;
    for(i=1; i<=n; i++)
        for(j=i; j<=n; j++)
            cin>>r[i][j];
    for(i=1; i<=n; i++)//初始化前缀和maxn[j]代表从j到i的最大值，minx则相反
        maxn[i]=-1e9,minx[i]=1e9;
    a[1]=0;
    maxn[1]=0;//注意a[1]的初始化
    minx[1]=0;
    for(i=2; i<=n; i++)
    {
        a[i]=a[i-1]+r[i-1][i];//先试正
        for(j=1; j<i; j++)
        {
            if(max(a[i],maxn[j])-min(a[i],minx[j])!=r[j][i])
                break;//不符合
        }
        if(j!=i)
            a[i]=a[i-1]-r[i-1][i];//换成负
        for(j=1; j<=i; j++)
        { 
            maxn[j]=max(maxn[j],a[i]);//更新前缀和数组
            minx[j]=min(minx[j],a[i]);
        } 
    }
    for(i=1; i<=n; i++)
        cout<<a[i]<<" ";
    return 0;
} 
```
**核心实现思想**：先将 $a_1$ 设为 0，对于 $a_i$ 先尝试设为 $a_{i - 1} + r_{i - 1, i}$，然后用前缀和数组验证是否满足全距条件，若不满足则改为 $a_{i - 1} - r_{i - 1, i}$，同时更新前缀和数组。

### 最优关键思路或技巧
- 利用相邻元素的全距 $r_{i - 1, i}$ 来确定 $a_i$ 可能的值，通过验证全距条件来选择正确的值。
- 部分题解使用前缀和数组优化验证过程，降低时间复杂度。

### 可拓展之处
同类型题可能会给出其他数组的统计信息，如子数组的和、积等，要求构造原数组。类似算法套路可以是从相邻元素的关系入手，结合给定的统计信息进行推理和验证。

### 推荐题目
- [P1164 小A点菜](https://www.luogu.com.cn/problem/P1164)：通过给定菜品价格和总钱数，构造点菜方案，与本题通过给定信息构造数组有相似之处。
- [P1048 采药](https://www.luogu.com.cn/problem/P1048)：根据采药时间和草药价值，构造最优采药方案，可锻炼根据条件构造结果的能力。
- [P1002 过河卒](https://www.luogu.com.cn/problem/P1002)：根据棋盘信息和卒的移动规则，构造卒从起点到终点的路径，与本题思路有一定相似性。

### 个人心得摘录与总结
- **Timmy_**：分享了比赛时没开 long long 导致 0 分的经历，提醒大家在比赛中要注意细节，避免因小错误而丢分。

---
处理用时：32.13秒
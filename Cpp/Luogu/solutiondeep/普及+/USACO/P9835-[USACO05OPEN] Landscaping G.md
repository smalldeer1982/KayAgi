# 题目信息

# [USACO05OPEN] Landscaping G

## 题目描述

农夫约翰正在做一次艰难的转型，从养山羊改成养奶牛，他的农场，由于是为养山羊而设计的所以有太多的山，为了养牛就必须将它整平。但是，将山整平是件很花钱的工作，所以他要移走尽可能少的土。

由于农场很细长，所以可以用一个 $n$ 和 $n$ 个整数（范围 $[1,10^6]$）组成的二维的数组来表示，如：

```
1 2 3 3 3 2 1 3 2 2 1 2
```

上述农场的侧面图是这样的：

```
    * * *     *
  * * * * *   * * *   *
* * * * * * * * * * * *
1 2 3 3 3 2 1 3 2 2 1 2
```

一个或是一些连续等高的地面，如果它左边或是右边的海拔都比它低的话，就被称为山顶，上面的例子就有三个山顶。 确定如果要使地图上仅有 $k$ 个山顶，至少要移走多少体积的土（每块地面减少一单位海拔需移走一单位的土）。注意，地面的海拔只能被降低不能被升高。 对于例子，如果要减少到只有 $1$ 个山顶，这需要移走 $2+1+1+1=5$ 个单位的土（`-` 表示移走的土）：

```
    * * *     -
  * * * * *   - - -   -
* * * * * * * * * * * *
1 2 3 3 3 2 1 3 2 2 1 2
```

## 说明/提示

对于 $100\%$ 的数据，$1 \leq n \leq 10^3$，$1 \leq k \leq 25$。

## 样例 #1

### 输入

```
12 1
1
2
3
3
3
2
1
3
2
2
1
2
```

### 输出

```
5```

# AI分析结果

### 综合分析与结论
这两道题解针对同一道题目给出了不同的解题思路。Hog_Dawa_IOI 的题解采用树型 DP 方法，时间复杂度为 $O(n \times k)$，思路复杂但效率高，通过将山顶抽象为带权树，利用树型 DP 求解最小移土量，不过细节较多，理解和实现难度较大。Frozen_Ladybug 的题解使用暴力搜索的方法，每次删除花费最小的山，思路直观简单，但每次删山后需重新扫描更新山的信息，时间复杂度较高。

### 所选题解
- **Hog_Dawa_IOI（3星）**
    - 关键亮点：时间复杂度为 $O(n \times k)$，效率较高，采用树型 DP 解决问题，思路独特。
    - 个人心得：作者提到在按照海拔从低到高遍历坐标处搞错，思考了很久，提醒读者要注意遍历顺序。
- **Frozen_Ladybug（3星）**
    - 关键亮点：思路直观，通过暴力搜索和删除最小花费的山来解决问题，容易理解。

### 通用建议与扩展思路
对于此类问题，如果数据范围较小，可以优先考虑简单直观的暴力解法，如 Frozen_Ladybug 的题解，便于实现和调试。如果数据范围较大，则需要考虑更高效的算法，如 Hog_Dawa_IOI 的树型 DP 方法。在使用树型 DP 时，要注意状态定义、转移方程和建树的细节。

### 重点代码
#### Hog_Dawa_IOI 核心代码
```cpp
// 树型 DP 核心函数
void dfs(int wh)
{
    ans+=siz[wh];for(int i=0;i<=k;i++) f[wh][i]=siz[wh];
    for(int i=fir[wh];i;i=bia[i].nxt)
    {
        dfs(bia[i].ed);
        for(int j=k;j>=1;j--) for(int w=j-1;w>=0;w--)
        f[wh][j]=max(f[wh][j],f[bia[i].ed][j-w]+f[wh][w]);
    }
}
```
核心实现思想：通过深度优先搜索遍历树，对于每个节点，更新其不同剩余叶子数量下的最大代价。

#### Frozen_Ladybug 核心代码
```c
// 检查山的信息
void check_hill(int p){
    int x=v[p].l,y=v[p].r;
    while(x>=1&&a[x-1]<=a[x]) x--;
    while(y<=n&&a[y+1]<=a[y]) y++;
    v[p].l=x;
    v[p].r=y;
    v[p].h=max(a[x],a[y]);
    v[p].sum=0;
    for(int i=x;i<=y;i++)
        if(a[i]>v[p].h) v[p].sum+=a[i]-v[p].h;
}
```
核心实现思想：根据左右端点的海拔情况更新山的左右端点、高度和土的总量。

### 拓展题目
- [P1273 有线电视网](https://www.luogu.com.cn/problem/P1273)：树型 DP 问题，与本题的树型 DP 思路有相似之处。
- [P2014 选课](https://www.luogu.com.cn/problem/P2014)：同样是树型 DP 题目，可加深对树型 DP 的理解。
- [P1352 没有上司的舞会](https://www.luogu.com.cn/problem/P1352)：经典的树型 DP 问题，有助于掌握树型 DP 的基本技巧。

---
处理用时：26.05秒
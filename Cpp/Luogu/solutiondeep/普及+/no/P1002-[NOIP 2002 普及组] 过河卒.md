# 题目信息

# [NOIP 2002 普及组] 过河卒

## 题目描述

棋盘上 $A$ 点有一个过河卒，需要走到目标 $B$ 点。卒行走的规则：可以向下、或者向右。同时在棋盘上 $C$ 点有一个对方的马，该马所在的点和所有跳跃一步可达的点称为对方马的控制点。因此称之为“马拦过河卒”。

棋盘用坐标表示，$A$ 点 $(0, 0)$、$B$ 点 $(n, m)$，同样马的位置坐标是需要给出的。

![](https://cdn.luogu.com.cn/upload/image_hosting/ipmwl52i.png)

现在要求你计算出卒从 $A$ 点能够到达 $B$ 点的路径的条数，假设马的位置是固定不动的，并不是卒走一步马走一步。


## 说明/提示

对于 $100 \%$ 的数据，$1 \le n, m \le 20$，$0 \le$ 马的坐标 $\le 20$。

**【题目来源】**

NOIP 2002 普及组第四题

## 样例 #1

### 输入

```
6 6 3 3
```

### 输出

```
6
```

# AI分析结果



**算法分类**：动态规划

---

**综合分析与结论**  
本题需计算过河卒在避开马控制点情况下的路径总数，核心解法为动态规划。所有题解均基于状态转移方程 `f[i][j] = f[i-1][j] + f[i][j-1]`，并通过标记马的控制点跳过无效位置。优化方向集中在空间压缩（滚动数组、一维数组）和坐标偏移处理。

---

**精选题解与亮点**  
1. **Chiaro 题解（⭐⭐⭐⭐⭐）**  
   - **关键亮点**：  
     - 提供从基础二维DP到滚动数组、一维数组的逐步优化，空间复杂度从O(n²)降至O(n)。  
     - 引入切比雪夫距离和曼哈顿距离判断控制点，减少标记数组的使用，提升效率。  
   - **代码核心**：  
     ```cpp
     // 一维数组优化
     for (int i = 2; i <= bx; i++) {
         for (int j = 2; j <= by; j++) {
             if (check(i, j)) { f[j] = 0; continue; }
             f[j] += f[j - 1];
         }
     }
     ```

2. **kradcigam 题解（⭐⭐⭐⭐）**  
   - **关键亮点**：  
     - 以标数法直观解释递推过程，适合动态规划入门理解。  
     - 代码简洁，直接处理控制点标记，适合快速实现。  
   - **代码核心**：  
     ```cpp
     for (int i = 1; i <= n; i++) {
         for (int j = 1; j <= m; j++) {
             if (ma[i][j] == 0) x[i][j] = x[i-1][j] + x[i][j-1];
         }
     }
     ```

3. **yummy 题解（⭐⭐⭐⭐）**  
   - **关键亮点**：  
     - 提出组合数学思路，通过排除法计算总路径数减去经过控制点的路径数，拓宽解题思路。  
     - 处理特殊情况（起点/终点靠近马）的详细分类讨论。  

---

**最优技巧总结**  
1. **坐标偏移**：将坐标整体+2，避免数组越界（如`bx += 2`）。  
2. **空间优化**：使用滚动数组（`i & 1`）或一维数组（`f[j] += f[j-1]`）降低空间复杂度。  
3. **控制点标记**：通过预计算或数学判断（切比雪夫距离）高效处理不可达点。

---

**拓展与推荐题目**  
- **类似题目**：  
  - [P1219 八皇后](https://www.luogu.com.cn/problem/P1219)：棋盘路径问题与条件限制。  
  - [P1433 吃奶酪](https://www.luogu.com.cn/problem/P1433)：动态规划与状态压缩结合。  
  - [P1004 方格取数](https://www.luogu.com.cn/problem/P1004)：双路径动态规划问题。  

---

**个人心得摘录**  
- **Chiaro**：坐标偏移是避免数组越界的关键，需特别注意初始化时的边界处理（如`f[2][1] = 1`）。  
- **yummy**：组合数学方法虽复杂度高，但启发对动态规划外其他解法的探索，如矩阵乘法（需注意数据范围）。  
- **WsW_**：一维数组优化的本质是复用数组空间，需注意循环顺序防止覆盖未处理的数据。

---
处理用时：46.45秒
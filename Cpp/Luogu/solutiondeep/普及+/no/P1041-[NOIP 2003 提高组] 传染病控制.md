# 题目信息

# [NOIP 2003 提高组] 传染病控制

## 题目背景

本题是错题，后来被证明没有靠谱的多项式复杂度的做法。测试数据非常的水，各种玄学做法都可以通过，不代表算法正确。因此本题题目和数据仅供参考。

[关于此类题目的详细内容](https://www.luogu.com.cn/paste/isdgwj5l)

---

近来，一种新的传染病肆虐全球。蓬莱国也发现了零星感染者，为防止该病在蓬莱国大范围流行，该国政府决定不惜一切代价控制传染病的蔓延。不幸的是，由于人们尚未完全认识这种传染病，难以准确判别病毒携带者，更没有研制出疫苗以保护易感人群。于是，蓬莱国的疾病控制中心决定采取切断传播途径的方法控制疾病传播。经过 WHO（世界卫生组织）以及全球各国科研部门的努力，这种新兴传染病的传播途径和控制方法已经研究清楚，剩下的任务就是由你协助蓬莱国疾控中心制定一个有效的控制办法。


## 题目描述

研究表明，这种传染病的传播具有两种很特殊的性质；

第一是它的传播途径是树型的，一个人 $X$ 只可能被某个特定的人 $Y$ 感染，只要 $Y$ 不得病，或者是 $XY$ 之间的传播途径被切断，则 $X$ 就不会得病。


第二是，这种疾病的传播有周期性，在一个疾病传播周期之内，传染病将只会感染一代患者，而不会再传播给下一代。


这些性质大大减轻了蓬莱国疾病防控的压力，并且他们已经得到了国内部分易感人群的潜在传播途径图（一棵树）。但是，麻烦还没有结束。由于蓬莱国疾控中心人手不够，同时也缺乏强大的技术，以致他们在一个疾病传播周期内，只能设法切断一条传播途径，而没有被控制的传播途径就会引起更多的易感人群被感染（也就是与当前已经被感染的人有传播途径相连，且连接途径没有被切断的人群）。当不可能有健康人被感染时，疾病就中止传播。所以，蓬莱国疾控中心要制定出一个切断传播途径的顺序，以使尽量少的人被感染。


你的程序要针对给定的树，找出合适的切断顺序。



## 说明/提示

对于 $100\%$ 的数据，$1 \leq n \leq 300$。

**【题目来源】**

NOIP 2003 提高组第四题

## 样例 #1

### 输入

```
7 6
1 2
1 3
2 4
2 5
3 6
3 7
```

### 输出

```
3
```

# AI分析结果



### 算法分类
深度优先搜索 DFS

### 综合分析与结论
题目本质是在树形结构中逐层切断传播路径，需枚举所有可能的切断组合。最优解法采用分层预处理+DFS回溯，通过预处理子树大小和层信息优化计算效率，核心难点在于如何高效剪枝与状态维护。

---

### 精选题解

#### 1. RikoHere（★★★★☆）
**关键亮点**：  
- 分层预处理：通过BFS预处理每个节点的深度和子节点集合  
- 回溯剪枝：每次切断后递归处理下一层，通过`clean`和`reclean`维护状态  
- 代码模块化：将清理和恢复状态封装为独立函数，提升可读性  

**核心代码片段**：
```cpp
void dfs(int cen, int tot) {
    maxx = max(maxx, tot); // 更新最大保护人数
    for (每个当前层节点) {
        if (!被感染) {
            int num = clean(该节点子树); // 标记并统计保护人数
            dfs(下一层, tot + num);
            reclean(该节点子树); // 回溯状态
        }
    }
}
```

#### 2. 基础不牢（★★★★☆）
**关键亮点**：
- 动态剪枝：提前处理父节点被切断的情况，减少无效搜索
- 特殊边界处理：当某层所有节点已被保护时直接更新答案
- 结构清晰：使用独立函数处理切断和恢复操作

**调试心得**：
> "当遇到链状结构时，发现不能正常更新最后一层答案，因此增加特殊判断：当某层无法切断时立即更新答案"

#### 3. 欧鹰（★★★★☆）
**关键思路**：
- 预处理子树结构：通过两次DFS预处理深度和子树大小
- 位标记优化：使用`vis`数组记录保护状态，避免重复计算
- 按层迭代搜索：逐层扩展可切断节点集合

**核心优化**：
```cpp
void dfs(int deep, int sum) {
    if (当前感染数 >= 最优解) return; // 剪枝
    for (每个未被保护节点) {
        切断并标记该子树;
        dfs(deep+1, sum + 子树大小);
        恢复标记; 
    }
}
```

---

### 最优技巧总结
1. **分层处理**：将树按深度分层，逐层决策切断点  
2. **子树预处理**：提前计算每个节点的子树大小，快速评估切断收益  
3. **回溯状态管理**：通过递归前标记、递归后恢复的方式管理保护状态  
4. **剪枝优化**：当当前解无法超越历史最优时提前终止分支  

---

### 推荐相似题目
1. [P2015 二叉苹果树](https://www.luogu.com.cn/problem/P2015) - 树形DP与保留子树问题  
2. [P1352 没有上司的舞会](https://www.luogu.com.cn/problem/P1352) - 树形结构决策问题  
3. [P1120 小木棍](https://www.luogu.com.cn/problem/P1120) - 经典剪枝搜索问题，强化回溯技巧

---
处理用时：48.71秒
# 题目信息

# [NOIP 2004 普及组] 火星人

## 题目描述

人类终于登上了火星的土地并且见到了神秘的火星人。人类和火星人都无法理解对方的语言，但是我们的科学家发明了一种用数字交流的方法。这种交流方法是这样的，首先，火星人把一个非常大的数字告诉人类科学家，科学家破解这个数字的含义后，再把一个很小的数字加到这个大数上面，把结果告诉火星人，作为人类的回答。

火星人用一种非常简单的方式来表示数字――掰手指。火星人只有一只手，但这只手上有成千上万的手指，这些手指排成一列，分别编号为 $1,2,3,\cdots$。火星人的任意两根手指都能随意交换位置，他们就是通过这方法计数的。

一个火星人用一个人类的手演示了如何用手指计数。如果把五根手指――拇指、食指、中指、无名指和小指分别编号为 $1,2,3,4$ 和 $5$，当它们按正常顺序排列时，形成了 $5$ 位数 $12345$，当你交换无名指和小指的位置时，会形成 $5$ 位数 $12354$，当你把五个手指的顺序完全颠倒时，会形成 $54321$，在所有能够形成的 $120$ 个 $5$ 位数中，$12345$ 最小，它表示 $1$；$12354$ 第二小，它表示 $2$；$54321$ 最大，它表示 $120$。下表展示了只有 $3$ 根手指时能够形成的 $6$ 个 $3$ 位数和它们代表的数字：


| 三进制数 | 代表的数字 |
|:-:|:-:|
| $123$ | $1$ |
| $132$ | $2$ |
| $213$ | $3$ |
| $231$ | $4$ |
| $312$ | $5$ |
| $321$ | $6$ |

现在你有幸成为了第一个和火星人交流的地球人。一个火星人会让你看他的手指，科学家会告诉你要加上去的很小的数。你的任务是，把火星人用手指表示的数与科学家告诉你的数相加，并根据相加的结果改变火星人手指的排列顺序。输入数据保证这个结果不会超出火星人手指能表示的范围。


## 说明/提示

对于 $30\%$ 的数据，$N \le 15$。

对于 $60\%$ 的数据，$N \le 50$。

对于 $100\%$ 的数据，$N \le 10000$。

noip2004 普及组第 4 题


## 样例 #1

### 输入

```
5
3
1 2 3 4 5
```

### 输出

```
1 2 4 5 3```

# AI分析结果



### 算法分类
数学（康托展开）

### 题解分析与结论
题目本质是求给定排列之后第m个全排列。各解法核心思路可分为：
1. 康托展开（变进制数转换）
2. 手动全排列进位模拟
3. STL库函数迭代

### 高分题解推荐
#### 1. 作者：yummy（★★★★★）
**关键亮点**：  
- 创新使用变进制数（康托展开）进行数学转换  
- 三步转换思想清晰：排列→变进制数→加m→逆转换  
- 代码简洁高效（37行），处理进位逻辑巧妙  

**核心代码**：  
```cpp
// 将排列转换为变进制数
for(int i=1;i<=n;i++) {
    int x=a[i];
    for(int j=1;j<=a[i];j++) x-=used[j];
    used[a[i]]=1;
    a[i]=x-1;
}
// 进位处理
for(int i=n;i>0;i--) {
    a[i-1]+=a[i]/(n-i+1);
    a[i]%=n-i+1;
}
```

#### 2. 作者：zhi_zhang（★★★★☆）
**关键亮点**：  
- 模拟数字进位的直观思路  
- 从末位开始寻找可增大的位置  
- 剩余位数快速填充策略  

**核心代码**：  
```cpp
// 进位搜索逻辑
for(int i=N;i>=1;i--) {
    int k=ad(finger[i]);
    if(k!=-1) {
        // 找到可增大的位置后处理后续位数
        for(int j=i+1;j<=N;j++) {
            for(int p=1;p<=N;p++) {
                if(!vis[p]) {
                    finger[j]=p;
                    vis[p]=1;
                    break;
                }
            }
        }
        break;
    }
}
```

### 最优思路总结
**康托展开**是最优解法：
1. **变进制转换**：将排列映射到数值空间，直接进行数学运算
2. **进位优化**：通过进制转换避免全排列遍历，时间复杂度O(n²)
3. **可扩展性**：适用于大范围排列运算问题

### 相似题目推荐
1. P1706 全排列问题（基础全排列生成）
2. P5367 康托展开（模板题）
3. P2525 Uim的情人节礼物（全排列应用）

---
处理用时：111.81秒
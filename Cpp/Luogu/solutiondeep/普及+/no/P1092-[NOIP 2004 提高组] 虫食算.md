# 题目信息

# [NOIP 2004 提高组] 虫食算

## 题目描述

所谓虫食算，就是原先的算式中有一部分被虫子啃掉了，需要我们根据剩下的数字来判定被啃掉的数字。来看一个简单的例子：

$$\begin{aligned}
 \verb!43#9865#045! \\
+\qquad \verb!8468#6633! \\[-1em]\underline{\kern{8em}} \\
 \verb!44445509678! \\
\end{aligned}$$

其中 `#` 号代表被虫子啃掉的数字。根据算式，我们很容易判断：第一行的两个数字分别是 $5$ 和 $3$，第二行的数字是 $5$。

现在，我们对问题做两个限制：

首先，我们只考虑加法的虫食算。这里的加法是 $n$ 进制加法，算式中三个数都有 $n$ 位，允许有前导的 $0$。

其次，虫子把所有的数都啃光了，我们只知道哪些数字是相同的，我们将相同的数字用相同的字母表示，不同的数字用不同的字母表示。如果这个算式是 $n$ 进制的，我们就取英文字母表的前 $n$ 个大写字母来表示这个算式中的 $0$ 到 $n - 1$ 这 $n$ 个不同的数字：但是这 $n$ 个字母并不一定顺序地代表 $0$ 到 $n-1$。输入数据保证 $n$ 个字母分别至少出现一次。

$$\begin{aligned}
 \verb!BADC! \\
+\quad \verb!CBDA! \\[-1em]\underline{\kern{4em}} \\
 \verb!DCCC! \\
\end{aligned}$$

上面的算式是一个4进制的算式。很显然，我们只要让 $\verb!ABCD!$ 分别代表 $0123$，便可以让这个式子成立了。你的任务是，对于给定的 $n$ 进制加法算式，求出 $n$ 个不同的字母分别代表的数字，使得该加法算式成立。输入数据保证有且仅有一组解。


## 说明/提示

#### 数据规模与约定

- 对于 $30\%$ 的数据，保证 $n \le 10$；
- 对于 $50\%$ 的数据，保证 $n \le 15$；
- 对于 $100\%$ 的数据，保证 $1 \leq n \leq 26$。

## 样例 #1

### 输入

```
5
ABCED
BDACE
EBBAA
```

### 输出

```
1 0 3 4 2
```

# AI分析结果



**算法分类**: 深度优先搜索 DFS + 剪枝

---

### 题解综合分析与结论

本题核心为通过DFS枚举字母到数字的映射，并利用剪枝大幅优化搜索效率。关键难点在于设计有效的剪枝条件，如逐列验证、进位合法性检查、预判矛盾等。各题解普遍采用从右到左搜索列、倒序枚举数字、预处理字母顺序等优化手段，结合可行性剪枝提前终止无效分支。

---

### 精选题解（评分≥4星）

1. **zzlzk的题解（5星）**
   - **亮点**: 
     - 从右到左逐列搜索，优先处理进位相关约束。
     - 剪枝条件：最高位无进位、当前列两数之和与结果矛盾。
     - 利用`next`数组优化字母处理顺序，代码简洁高效。
   - **核心代码片段**:
     ```cpp
     void dfs(int x) {
         if (CanPrune()) return; // 提前剪枝
         if (x == n) { if (Judge()) Print(); return; }
         for (int i = n-1; i >=0; i--) { // 倒序枚举数字
             num[Next[x]] = i; // 按预处理的顺序赋值
             used[i] = true;
             dfs(x+1);
             used[i] = false;
         }
     }
     ```

2. **Mihari的题解（4星）**
   - **亮点**:
     - 预处理字母出现顺序，优先处理低位高频字母。
     - `Check()`函数逐列验证，剪枝条件覆盖进位和非进位情况。
   - **调试心得**: 发现倒序枚举数字可更快触发剪枝，如从9到0枚举比0到9快约10倍。

---

### 最优技巧总结

- **搜索顺序优化**: 从右到左按列处理，结合字母出现频率确定搜索顺序。
- **剪枝设计**:
  - 进位合法性检查（如最高位不能进位）。
  - 当前列两数之和与结果的模运算矛盾检查。
  - 提前预判后续列的可能性（如后续列全已知时直接验证）。
- **枚举顺序**: 倒序尝试数字（如n-1到0），更容易触发进位剪枝。

---

### 拓展练习推荐

1. [P1074 靶形数独](https://www.luogu.com.cn/problem/P1074) - DFS剪枝与搜索顺序优化
2. [P1120 小木棍](https://www.luogu.com.cn/problem/P1120) - 多重剪枝与可行性判断
3. [P1032 字变换](https://www.luogu.com.cn/problem/P1032) - 状态空间搜索与剪枝设计

---
处理用时：52.50秒
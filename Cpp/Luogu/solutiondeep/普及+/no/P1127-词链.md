# 题目信息

# 词链

## 题目描述

如果单词 $X$ 的末字母与单词 $Y$ 的首字母相同，则 $X$ 与 $Y$ 可以相连成 $X.Y$。（注意：$X$、$Y$ 之间是英文的句号 `.`）。例如，单词 `dog` 与单词 `gopher`，则 `dog` 与 `gopher` 可以相连成 `dog.gopher`。

另外还有一些例子：
- `dog.gopher`
- `gopher.rat`
- `rat.tiger`
- `aloha.aloha`
- `arachnid.dog`

连接成的词可以与其他单词相连，组成更长的词链，例如：

`aloha.arachnid.dog.gopher.rat.tiger`

注意到，`.` 两边的字母一定是相同的。

现在给你一些单词，请你找到字典序最小的词链，使得每个单词在词链中出现且仅出现一次。注意，相同的单词若出现了 $k$ 次就需要输出 $k$ 次。

## 说明/提示

- 对于 $40\%$ 的数据，有 $n \leq 10$；
- 对于 $100\%$ 的数据，有 $n \leq 1000$。


## 样例 #1

### 输入

```
6
aloha
arachnid
dog
gopher
rat
tiger```

### 输出

```
aloha.arachnid.dog.gopher.rat.tiger```

# AI分析结果



**算法分类**: 图论（欧拉路径）

---

### 题解综合分析
题目本质是求有向图的欧拉路径/回路，并要求字典序最小的解。正确解法需结合图论模型与字典序优化，关键点包括：
1. **建图模型**：单词视为边，首尾字母为节点
2. **欧拉路判断**：通过入度/出度分析确定路径类型
3. **字典序优化**：预先排序单词，确保DFS按字典序搜索
4. **连通性验证**：使用并查集判断图的连通性

---

### 精选题解

#### 1. loc_equinox（⭐⭐⭐⭐⭐）
**核心思路**：
- 将单词转化为首字母→末字母的有向边
- 通过并查集验证图的连通性
- 统计入度/出度确定欧拉路类型
- 优先从字典序最小的合法起点开始DFS

**关键代码**：
```cpp
// 建图部分
for(int i=1;i<=n;i++) {
    int ch_start = s[i][0]-'a'+1;
    int ch_end = s[i].back()-'a'+1;
    // 添加边到邻接表，已按字典序排序
    E[ch_start].push_back({ch_end, i, s[i]});
}

// DFS寻找欧拉路径
void dfs(int now) {
    for(auto& edge : E[now]) {
        if(!vis[edge.ord]) {
            vis[edge.ord] = 1;
            dfs(edge.to);
            ans.push_back(edge.word);
        }
    }
}
```

#### 2. fls233666（⭐⭐⭐⭐）
**亮点**：
- 逆向建边保证字典序
- 使用链式前向星存图
- 统一处理欧拉回路和通路

**调试经验**：
> "取消流同步ios::sync_with_stdio(false)加上之后会RE" —— 提醒注意IO优化可能引发的异常

---

### 关键技巧总结
1. **欧拉路快速判断**：
   - 通路：1个点出度=入度+1，1个点入度=出度+1
   - 回路：所有点入度=出度
2. **字典序保证**：预处理时按字典序排序，建图时倒序插入（保证DFS时优先访问字典序小的）
3. **连通性验证**：使用并查集或DFS判断所有相关节点是否连通

---

### 拓展练习
1. [P2731 骑马修栅栏](https://www.luogu.com.cn/problem/P2731) - 欧拉路经典问题
2. [P1341 无序字母对](https://www.luogu.com.cn/problem/P1341) - 无向图欧拉回路
3. [P1333 瑞瑞的木棍](https://www.luogu.com.cn/problem/P1333) - 欧拉路存在性判断

---

### 个人心得摘录
> "初始DFS思路会导致超时，后来意识到必须应用欧拉路模型" —— loc_equinox  
> "取消流同步导致RE，需要注意IO优化陷阱" —— fls233666  
> "必须倒序建边才能保证字典序正确" —— 多个题解共同经验

这些经验揭示了图论问题中模型建立的重要性，以及算法实现中易被忽视的细节陷阱。

---
处理用时：43.38秒
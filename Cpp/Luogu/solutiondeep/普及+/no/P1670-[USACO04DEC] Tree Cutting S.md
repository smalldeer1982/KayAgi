# 题目信息

# [USACO04DEC] Tree Cutting S

## 题目描述

约翰意识到贝茜建设网络花费了他巨额的经费，就把她解雇了。贝茜很愤怒，打算狠狠报复。她打算破坏刚建成的约翰的网络。约翰的网络是树形的，连接着 $N$ 个牛棚。她打算切断某一个牛棚的电源，使和这个牛棚相连的所有电缆全部中断。之后，就会存在若干子网络。为保证破坏够大，每一个子网的牛棚数不得超过总牛棚数的一半，那哪些牛棚值得破坏呢？

## 说明/提示

$1\le N\le 10^4$。

## 样例 #1

### 输入

```
10
1 2
2 3
3 4
4 5
6 7
7 8
8 9
9 10
3 8```

### 输出

```
3
8
```

# AI分析结果



### 算法分类
图论（树的重心）

---

### 题解综合分析
本题核心是寻找满足条件的节点，其删除后所有连通块大小均不超过总节点数的一半。所有正确题解均基于**树的重心**性质，通过一次DFS预处理子树大小，并计算父节点方向连通块的大小。关键点在于同时比较子树和父方向连通块的最大值。

---

### 高星题解推荐

#### 1. MoonCake2011（★★★★★）
**关键亮点**  
- 直接应用树的重心模板，代码简洁高效  
- 邻接表存储树，DFS中动态更新最大子树及父方向连通块  
- 时间复杂度严格O(n)，逻辑清晰  

**核心代码**  
```cpp
void dfs(int x,int fa){
    siz[x]=1;
    for(int i=head[x];i;i=nxt[i]){
        if(to[i]==fa) continue;
        dfs(to[i],x);
        siz[x]+=siz[to[i]];
        dp[x]=max(dp[x],siz[to[i]]); // 更新子树最大值
    }
    dp[x]=max(dp[x],n-siz[x]); // 父方向连通块比较
}
```

#### 2. Miku_QwQ（★★★★☆）  
**关键亮点**  
- 详细解释无根树转有根树的处理思路  
- 显式分离树构建与子树大小计算阶段  
- 代码注释丰富，适合理解处理流程  

**个人心得**  
> "父节点向上连通块的大小需反向思考，总节点数减当前子树大小是关键点。"

#### 3. Huangjy88（★★★★☆）  
**关键亮点**  
- 使用vector邻接表，代码可读性高  
- 独立维护最大子树大小数组`mss[]`  
- 输出时直接位运算判断`n>>1`，代码精简  

**核心代码**  
```cpp
dfs(1,0); // 以1为根预处理
for(int i=1;i<=n;i++)
    if(mss[i]<=n>>1) cout<<i<<endl;
```

---

### 最优关键技巧
1. **双向连通块计算**：对每个节点，同时考虑其子树连通块和父方向连通块（`n - siz[x]`）。
2. **单次DFS预处理**：通过一次DFS完成子树大小计算，避免重复遍历。
3. **树的重心性质**：利用树的重心定义中最大连通块最小的性质，直接求解符合条件的节点。

---

### 拓展建议
类似问题可练习：  
1. [P1395 会议](https://www.luogu.com.cn/problem/P1395)（树的重心经典应用）  
2. [P1364 医院设置](https://www.luogu.com.cn/problem/P1364)（加权树的重心变形）  
3. [P2634 [国家集训队]聪聪可可](https://www.luogu.com.cn/problem/P2634)（树的路径统计与重心结合）

---

### 相似题目推荐
1. [P1395 会议](https://www.luogu.com.cn/problem/P1395)  
2. [P3041 [USACO12JAN]Video Game G](https://www.luogu.com.cn/problem/P3041)  
3. [P2996 [USACO10OPEN]Time Travel S](https://www.luogu.com.cn/problem/P2996)

---
处理用时：96.25秒
# 题目信息

# 路边的水沟

## 题目背景

某市有一个巨大的水沟网络，可以近似看成一个 $n \times m$ 的矩形网格，网格的每个格点都安装了闸门，我们将从水沟网络右下角的闸门到左上角的闸门的一条路径称为水流。


## 题目描述

现给定水沟网的长和宽，求该水沟网中所有只包含向左和向上移动的水流数量。


## 说明/提示

对于 $30\%$ 的数据，$1 \leq m,n \leq 10$。

对于 $50\%$ 的数据，$1 \leq m,n \leq 1,000$。

对于 $80\%$ 的数据，$1 \leq m,n \leq 50,000$。

对于 $100\%$ 的数据，$1 \leq m,n \leq 1,000,000$。

## 样例 #1

### 输入

```
3 5```

### 输出

```
56```

# AI分析结果



**算法分类**：组合数学

---

### 综合分析与结论
题目本质是求组合数 $C(n+m, n) \bmod 1e9+7$。所有题解均采用组合数学+逆元求模的思路，核心差异在于逆元的处理方式。主要优化点在于避免阶乘爆范围，通过分步乘法和逆元代替除法，时间复杂度集中在快速幂或预处理阶乘。

---

### 高星题解推荐

1. **Ginger_he（5星）**  
   **关键亮点**：代码简洁高效，直接分步计算分子和分母的逆元，避免阶乘预处理。使用快速幂逐次处理分母项的逆元，适合本题 $n,m\leq 1e6$ 的数据范围。  
   **核心代码**：
   ```cpp
   for(long long i=n+1;i<=n+m;i++) ans=ans*i%mod; // 分子部分
   for(long long i=2;i<=m;i++) ans=ans*quickpow(i,mod-2)%mod; // 分母逆元
   ```

2. **hsfzLZH1（4星）**  
   **关键亮点**：将分母整体计算后通过单次快速幂求逆元，减少乘法次数，代码逻辑清晰。  
   **核心代码**：
   ```cpp
   for(int i=m+1;i<=n+m;i++) ans1=(ans1*i)%mod; // 分子
   for(int i=2;i<=n;i++) ans2=(ans2*i)%mod; // 分母
   ans1 * pow(ans2, mod-2) % mod; // 分母逆元单次计算
   ```

3. **ModestCoder_（4星）**  
   **关键亮点**：预计算阶乘和逆元数组，适合多组查询场景，时间复杂度更优（但本题单次查询无需）。  
   **核心代码**：
   ```cpp
   fac[0] = 1;
   for(int i=1; i<=n+m; i++) fac[i]=fac[i-1]*i%mod; // 阶乘预处理
   inv[n+m] = ksm(fac[n+m], mod-2); // 逆元递推预处理
   for(int i=n+m-1;i>=0;i--) inv[i]=inv[i+1]*(i+1)%mod;
   ```

---

### 最优关键思路
**分步乘法+逆元替代除法**：将组合数公式转化为 $\prod_{i=1}^m \frac{n+i}{i}$，分子直接连乘，分母转换为逆元连乘，避免阶乘溢出。时间复杂度 $O(m)$，空间复杂度 $O(1)$。

---

### 拓展与同类题
- **逆元应用场景**：组合数取模、分数求和取模（如多项式系数）。
- **类似题目**：  
  - [P3807 【模板】卢卡斯定理](https://www.luogu.com.cn/problem/P3807)  
  - [P3197 [HNOI2008] 越狱](https://www.luogu.com.cn/problem/P3197)  
  - [P1313 计算系数](https://www.luogu.com.cn/problem/P1313)

---

### 题解心得摘录
- **田大坑**：初始尝试DP因数据规模过大失败，转向组合数学公式推导，强调对拍验证思路正确性。  
- **ShineEternal**：强调快速幂在逆元计算中的核心作用，避免直接暴力阶乘导致溢出。  
- **连续和**：指出同余方程解法（扩展欧几里得）的可行性，提供逆元求法的替代思路。

---
处理用时：50.61秒
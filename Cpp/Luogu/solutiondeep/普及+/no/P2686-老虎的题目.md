# 题目信息

# 老虎的题目

## 题目描述

随着小老虎做题越来越多，现在可做小老师了，小老虎经常帮老师出题供信息学奥赛班的同学测试用。出题确实是一件麻烦事。现在有更麻烦的事了：

小老虎收集到了一大堆的题目，并且按照收集的时间顺序排成一排。每个题目都有自己的题面长度和难度。小老虎想用这些题出好多好多场比赛。但是呢，有要求：

同一场比赛的题目，必须是这一排中，连续的一段，但题目数量不限。

题面长度的总和，不能超过high，也不能低于low。

不允许出现两场比赛，使得其中一场的题目全部在另一场出现过了。（就是说，不同比赛的题目集合不能出现包含和被包含关系）

题目可以在不同比赛中重复使用。


现在，小老虎想知道，在满足以上条件的基础上……对不起，小老虎不是想知道最多出多少场，而是想知道，所有比赛的难度总和最大是多少？（定义一场比赛的难度为本场比赛出现的所有题目的难度和）


## 说明/提示

对于40%的数据，1 <= N <= 100；

对于100%的数据，1 <= N <= 1000；

单个题目的题面长度和难度都小等于100000；

其余给出的均在longint范围内。


## 样例 #1

### 输入

```
6 4 5
1 3 3 2 2 1
2 3 1 4 5 2
```

### 输出

```
21

注：样例中，3场，第一场选1，2两题，第二场选3，4两题，第三场选4，5，6三题。
```

# AI分析结果



### 算法分类
**动态规划**

### 综合分析与结论
题目要求选择连续区间作为比赛，需满足长度限制且比赛之间不能存在包含关系。所有题解均采用动态规划思路，核心状态定义为 `f[i][j]` 表示左端点不超过 `i`、右端点不超过 `j` 的最大难度和，通过前缀和优化区间计算，利用状态转移避免区间包含关系。

---

### 精选题解（评分≥4星）

#### 1. 题解作者：DоsLikе（4星）
**关键亮点**  
- 完整的三步走动态规划分析框架，清晰解释状态定义与转移逻辑  
- 指出初始状态为 `f[i][j]=0` 的合理性  
- 代码简洁，注释明确，可读性强  
**核心代码**  
```cpp
for(int i=1;i<=n;i++){
    for(int j=i;j<=n;j++){
        dp[i][j]=max(dp[i-1][j],dp[i][j-1]);
        if((arr[j]-arr[i-1])>=low&&(arr[j]-arr[i-1])<=high)
            dp[i][j]=max(dp[i][j],dp[i-1][j-1]+brr[j]-brr[i-1]);
    }
}
```

#### 2. 题解作者：彭骐飞（4星）
**关键亮点**  
- 代码高度精简，直接给出状态转移方程  
- 使用前缀和数组隐式处理区间和计算  
- 强调 `long long` 类型避免数据溢出  
**核心代码**  
```cpp
for (int i=1;i<=n;i++)
    for (int j=i;j<=n;j++) {
        f[i][j] = max(f[i-1][j], f[i][j-1]);
        if (s1[j]-s1[i-1] >= l && s1[j]-s1[i-1] <= r) 
            f[i][j] = max(f[i][j], f[i-1][j-1] + s2[j]-s2[i-1]);
    }
```

---

### 最优思路与技巧
1. **状态定义**：`f[i][j]` 表示左端点不超过 `i`，右端点不超过 `j` 的合法比赛集合的最大难度和，巧妙避免区间包含关系。
2. **转移方程**：  
   - 当区间长度合法时：`f[i][j] = max(f[i-1][j], f[i][j-1], f[i-1][j-1] + 当前区间难度)`  
   - 否则：`f[i][j] = max(f[i-1][j], f[i][j-1])`  
3. **前缀和优化**：预处理题面长度和难度的前缀和，快速计算任意区间的总和。

---

### 拓展与举一反三
- **类似题型**：区间不相交问题（如活动选择）、二维前缀和优化问题  
- **推荐题目**  
  1. [P1880 石子合并](https://www.luogu.com.cn/problem/P1880)（环形区间DP）  
  2. [P1140 相似基因](https://www.luogu.com.cn/problem/P1140)（二维DP与序列匹配）  
  3. [P1005 矩阵取数游戏](https://www.luogu.com.cn/problem/P1005)（区间DP与贪心结合）  

---

### 题解心得摘录
- **DоsLikе**：  
  > *"dp 的三步走框架解决了问题的 80%，转移方程需考虑条件分支，初始状态的零值隐含合法性"*  
- **天泽龟**：  
  > *"二维线段树可优化但复杂度高，需动态开点避免 MLE，实际比赛更倾向暴力 DP 的简洁性"*  
- **彭骐飞**：  
  > *"代码中 `long long` 是必要陷阱，测试点可能设计大数值边界条件"*

---
处理用时：50.23秒
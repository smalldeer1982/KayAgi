# 题目信息

# [AHOI2016初中组] 游戏

## 题目描述

小雪与小可可正在玩一种数字游戏。他们准备了 $n$ 张卡片，每一张卡片上都有一个整数。游戏开始后，小雪会先选择一个不小于 $a$ 且不大于 $b$ 的整数 $t$，并告诉小可可这个数字 $t$ 是多少。之后小可可会挑出恰好 $k$ 张卡片，并将这 $k$ 张卡片上的数字相加，得到的和数记为 $m$。

小雪希望 $t$ 和 $m$ 差的绝对值尽可能大，而小可可却希望 $t$ 和 $m$ 差的绝对值尽可能小。在游戏开始前，他们二人都知道 $n$， $a$， $b$ 和 $k$ 是多少，也知道每一张卡片上的数字是多少。在小雪决定了 $t$ 的大小后，不能再修改，之后才由小可可挑选纸牌。

小雪希望知道，在二人都尝试最优策略的情况下， $t$ 和 $m$ 差的绝对值最大可以有多大？

## 说明/提示

对于 30% 的数据， $1\le k\le n\le 20$ 且 $0\le a\le b\le   6000$。

对于 80% 的数据， $1\le k\le n\le 65$ 且 $0\le a\le b\le   19650$。

对于 100% 的数据， $1\le k\le n\le 250$ 且 $0\le a\le b\le 75000$。


## 样例 #1

### 输入

```
4 2 58 100
10 10 50 80```

### 输出

```
15```

## 样例 #2

### 输入

```
8 3 1300 1800
2 0 1 9 1 4 0 5```

### 输出

```
1782```

# AI分析结果



**算法分类**: 动态规划

**综合分析**:  
本题需在两人最优策略下最大化|t-m|。关键在于利用动态规划（01背包变种）求出所有可能的m值，并高效确定小雪选择的t使得最小绝对差最大。难点在于处理大规模数据时的时间与空间优化。

---

### 推荐题解

#### 1. std（官方题解） ★★★★★  
**关键亮点**:  
- 使用位压缩优化动态规划，状态转移通过位运算高效处理。  
- 预处理所有可能的m后，通过相邻m的中点计算潜在最大差值，避免逐一遍历t。  
**核心代码**:  
```cpp
// 动态规划部分
F[0][0] = 1;
for (int i = 1; i <= n; i++)
    for (int j = sumx[i]; j >= 0; j--)
        for (int k = 0; k < k0; k++) {
            if (k + 1 < k0) F[j+x[i]][k+1] |= (F[j][k] >> (R-1));
            F[j+x[i]][k] |= (F[j][k] << 1);
        }
// 计算最大差部分
for (int i = 1; i < ans.size(); i++) {
    int rr = (ans[i] - ans[i-1]) / 2;
    if ((a <= ans[i-1] + rr && ans[i-1] + rr <= b) || (a <= ans[i] - rr && ans[i] - rr <= b)) {
        if (rr > ret) ret = rr;
    }
}
```

#### 2. 作者：qhr2023 ★★★★  
**关键亮点**:  
- 使用bitset优化动态规划，代码简洁易懂。  
- 预处理所有m后直接枚举t，适合小数据范围。  
**核心代码**:  
```cpp
bitset<MaxSum> F[MaxN];
F[0].set(0);
for(int i(1); i <= N; i++) {
    scanf("%d", &Xi);
    for(int j(K); j; j--)
        F[j] |= F[j-1] << Xi;
}
```

---

### 最优思路总结  
1. **动态规划优化**: 使用bitset或位运算压缩状态，将背包问题的状态转移复杂度从O(nkΣx)优化到O(nkΣx/64)。  
2. **高效差值计算**: 对排序后的m值，通过相邻元素中点快速确定可能的最大差值，避免逐一遍历t。  

### 拓展与心得  
- **同类问题**: 涉及组合优化与博弈策略的背包问题（如洛谷P1048、P1064）。  
- **调试心得**: 注意动态规划状态转移的方向（逆序避免重复计数），合理选择数据结构（如bitset）优化空间。  

### 推荐题目  
1. [P1048 采药](https://www.luogu.com.cn/problem/P1048)  
2. [P1064 金明的预算方案](https://www.luogu.com.cn/problem/P1064)  
3. [P2347 砝码称重](https://www.luogu.com.cn/problem/P2347)

---
处理用时：165.72秒
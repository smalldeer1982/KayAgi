# 题目信息

# [TJOI2009] 火星人的手机

## 题目背景

你应火星人之邀为他们设计一款新型的手机。我们知道在标准的地球人手机上，数字键共有 $10$ 个，$26$ 个字母 `a`…`z` 分别与某个数字键相关联，并且一个数字键上的若干字母必须是字母表中连续的一段。比如下图是地球手机的一个标准方案：

![](https://cdn.luogu.com.cn/upload/pic/6103.png)


## 题目描述

我们要输入一个字母，必须连续按它所在的数字键若干次，次数即为这个字母在这个键的第几个位置。例如在上图的方案中，若我们要输入 `C`，就需要按三次数字键 `2`；若要输入 `M`，需按一次数字键 `6`。

火星人手机的构造与地球人手机类似，上面有 $M$ 个火星数字键，你需要把火星文的 $N$ 个字母放置在这 $M$ 个键上。（同样要求一个数字键上必须是连续的若干个火星字母）现在给定一段火星文中各个字母的出现次数，你设计的手机必须使得输入这段文字所需的按键次数最少。


## 说明/提示

### 数据范围及约定

对于 $100\%$ 的数据，$1\le N \le 500$，$1 \le M \le 100$。


## 样例 #1

### 输入

```
3 2
100
200
300
```

### 输出

```
800
2
1
```

# AI分析结果



**算法分类**：动态规划

### 题解综合分析
题目核心为将N个字母分配到M个键上，要求按键次数最少。所有题解均采用动态规划思路，预处理区间代价后划分区间。关键点在于：
1. **预处理区间代价**：计算将连续字母分配到同一键的代价。
2. **动态规划状态转移**：以 `dp[i][j]` 表示前i字母分j段的最小代价，枚举上一段结束位置k。
3. **处理特殊情况**：当M > N时需补0，且注意数据范围用long long。

---

### 精选题解

#### 1. 作者：GNAQ（4星）
**关键亮点**：  
- 预处理`vals[i][j]`简洁高效，采用递推式`vals[i][j] = vals[i][j-1] + seq[j]*(j-i+1)`。  
- 处理M > N时补0，记录前驱输出方案。  
**核心代码**：  
```cpp
// 预处理区间代价
for (int i=1;i<=n;i++)
    for (int j=i;j<=n;j++)
        vals[i][j] = vals[i][j-1] + seq[j]*(j-i+1);

// DP转移
for (int i=1;i<=n;i++)
    for (int j=1;j<=min(i,m);j++)
        for (int k=0;k<i;k++)
            dp[i][j] = min(dp[i][j], dp[k][j-1]+vals[k+1][i]);
```

#### 2. 作者：yangwenbin（4星）
**关键亮点**：  
- 强调逆序枚举分组数优化状态覆盖顺序。  
- 详细分析数据范围陷阱和路径回溯实现。  
**核心代码**：  
```cpp
// 逆序枚举分组数优化
for (long long j = min(i,m); j >= 1; --j)
    for (long long k = 0; k < i; ++k)
        if (dp[i][j] > dp[k][j-1] + sum[k+1][i])
            dp[i][j] = dp[k][j-1] + sum[k+1][i];
```

#### 3. 作者：TDSLDJ（4星）
**关键亮点**：  
- 特判N ≤ M情况直接输出最优解。  
- 路径记录清晰，代码注释详细。  
**核心代码**：  
```cpp
// 特判N ≤ M
if (n <= m) {
    cout << sum << endl;
    for (int i=1;i<=m-n;i++) cout << "0\n";
    for (int i=1;i<=n;i++) cout << "1\n";
    return 0;
}
```

---

### 最优思路总结
- **区间代价预处理**：递推计算连续字母分配到同一键的代价，复杂度O(N²)。  
- **动态规划状态设计**：`dp[i][j]` 表示前i字母分j段的最小代价，转移时枚举分界点。  
- **特殊处理M > N**：补足0输出，避免无效计算。  

---

### 拓展与同类题目
1. **P1775 石子合并**（区间划分DP，最小合并代价）  
2. **P1040 加分二叉树**（区间DP与最优结构构造）  
3. **P1435 回文字串**（划分回文子串的动态规划）  

---

### 解题心得摘录
- **GNAQ**：注意M可能大于N，需补零。  
- **yangwenbin**：数据范围可能爆int，必须开long long。  
- **TDSLDJ**：特判N ≤ M可快速处理，避免复杂计算。

---
处理用时：67.98秒
# 题目信息

# [BalticOI 2005] Maze

## 题目描述

给出一个平行四边形的长与高. 给出入口与出口,对于四边形的每条边都有一种Color,非黑即白. 你要找出一条路径,走过的边黑白交替,且长度最短

## 说明/提示

对于第一个数据:

(0, 0) -> (1, 0) -> (0, 1) -> (1, 1) -> (1, 0) ->(2, 0) -> (2, 1)

![](https://cdn.luogu.com.cn/upload/image_hosting/a7qxcn67.png)  

对于第二个数据:

(0, 2) -> (1, 2) -> (1, 1) -> (2, 1) -> (2, 0) ->

(3, 0) -> (3, 1) -> (3, 2) -> (4, 1) -> (3, 1) ->

(3, 0) -> (2, 0) -> (2, 1) -> (1, 1) -> (1, 2) ->

(1, 3) -> (2, 3) -> (2, 4) -> (3, 4) -> (3, 3) ->

(4, 3) -> (4, 2) -> (5, 2)

![](https://cdn.luogu.com.cn/upload/image_hosting/8d0gue8n.png)

## 样例 #1

### 输入

```
2 1
0 0 2 1
bb
nwwnw
bn```

### 输出

```
6```

## 样例 #2

### 输入

```
5 4
0 2 5 2
nnbnn
nnnwwbwnnnn
nbbbn
nnwbwwbwwnn
bwwww
nnbwbbwwbnn
nwwwn
nnnnbwbbnnn
nnwnn```

### 输出

```
22```

# AI分析结果



**算法分类**: 广度优先搜索 BFS

---

### 综合分析与结论
题目要求在平行四边形迷宫中找到一条黑白边交替的最短路径。核心难点在于**建图**和**处理颜色交替条件**。所有题解均采用 BFS，但状态设计不同。关键点包括：
1. **建图方式**：将平行四边形转换为网格点，根据输入行处理横向、纵向、斜边的连接。
2. **状态设计**：记录到达当前点时上一步的边颜色，确保下一步颜色不同。
3. **优化存储**：每个点最多被访问两次（黑/白状态），保证线性时间复杂度。

---

### 高星题解推荐

#### 1. 作者：ls623820778（⭐⭐⭐⭐）
**关键亮点**：
- 使用前向星存图，结构清晰。
- 队列中用正负数表示上一步颜色，巧妙处理状态。
- 双数组 `dis[v][0/1]` 记录不同颜色到达的最短距离。

**核心代码思想**：
```cpp
void bfs() {
    queue<int> q;
    q.push(S); q.push(-S); // 正数表示上一步是白边，负数表示黑边
    while (!q.empty()) {
        int x = q.front(); q.pop();
        int color = (x > 0) ? 1 : 0;
        x = abs(x);
        for (遍历邻接边) {
            if (边颜色 != 当前颜色) {
                if (更新距离) {
                    q.push(新状态);
                }
            }
        }
    }
}
```

#### 2. 作者：施玮宸SECSA（⭐⭐⭐）
**关键亮点**：
- 使用双标记数组 `bl[0/1][v]` 记录不同颜色是否访问过。
- 队列记录当前颜色状态，逐层扩展。

**个人心得**：
> "需要记录走过的边的号码。复杂度：O(ts)~~~~~~~"

**核心代码思想**：
```cpp
while (ri >= le) {
    for (遍历邻接边) {
        if (边颜色 != 上一步颜色 && 未访问) {
            标记并加入队列;
        }
    }
    le++;
    if (到达新层) 步数+1;
}
```

---

### 最优思路总结
1. **状态扩展**：在 BFS 中携带额外状态（上一步颜色），确保每次扩展颜色交替。
2. **高效存储**：每个点最多存储两种状态（黑/白到达），避免重复访问。
3. **建图技巧**：将输入行解析为横向、纵向、斜边的连接，注意坐标转换。

---

### 类似题目推荐
1. [P1141 01迷宫](https://www.luogu.com.cn/problem/P1141) - 状态扩展的 BFS。
2. [P3958 奶酪](https://www.luogu.com.cn/problem/P3958) - 网格建模与 BFS 结合。
3. [P1032 字变换](https://www.luogu.com.cn/problem/P1032) - 状态携带额外信息的 BFS。

---
处理用时：42.05秒
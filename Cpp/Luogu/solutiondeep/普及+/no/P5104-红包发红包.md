# 题目信息

# 红包发红包

## 题目背景

红包（redbag）发明了一个抢红包的系统。

## 题目描述

这个抢红包系统是这样的：假如现在有 $w$ 元，那么你抢红包能抢到的钱就是 $[0,w]$ 等概率均匀随机出的一个实数 $x$。

现在红包发了一个 $w$ 元的红包，有 $n$ 个人来抢。那么请问第 $k$ 个人期望抢到多少钱？

输出答案对 $10^9+7$ 取模后的结果。


## 说明/提示

注意红包发明的抢红包系统和微信的抢红包系统不一样，红包发明的抢红包系统中的钱不一定是整数分。

- 对于 $30\%$ 的数据，$k=1$
- 另有 $30\%$ 的数据，期望值取模前为整数，$k\le 10$。

对于全部数据，$0< w< (10^9+7)$，$n\le 10^{18},k\le n$。

## 样例 #1

### 输入

```
2 1 1```

### 输出

```
1```

# AI分析结果



### 算法分类
**数学（概率论）**

---

### 题解综合分析
题目核心在于计算连续型随机变量的期望。所有题解均指出第k个人的期望为 $w/2^k$，核心思路是通过递推或积分证明每次抢红包后剩余金额期望减半。难点在于理解连续型期望的积分计算与递推思想的结合。

---

### 精选题解及评分
#### 1. **老K（5星）**
- **关键亮点**：数学归纳法严谨证明期望递推式，结合连续型概率密度函数的积分推导。
- **代码核心**：快速幂求逆元，简洁高效。
  ```cpp
  int qpow(int a, int b) {
      int res = 1;
      while (b) {
          if (b & 1) (res *= a) %= mod;
          (a *= a) %= mod;
          b >>= 1;
      }
      return res;
  }
  ```

#### 2. **Anguei（4星）**
- **关键亮点**：递推式直观解释期望减半的过程，代码中直接调用两次快速幂优化计算。
- **个人心得**："每次期望拿走一半的钱" 的直觉与数学推导结合，易于理解。

#### 3. **Ebola（4星）**
- **关键亮点**：详细推导连续型期望的积分过程，强调概率密度函数的定义。
- **代码特色**：提前计算 $2$ 的逆元避免重复计算。
  ```cpp
  LL inv2 = Pow(2, ha-2); // 2的逆元预处理
  ```

---

### 最优关键思路
**递推期望减半**：每次抢红包后剩余金额的期望是当前期望的一半，数学归纳或积分证明此性质。最终公式为 $w \cdot 2^{-k}$，利用快速幂求模逆元 $2^k \bmod (10^9+7)$。

---

### 拓展思路
1. **变种问题**：若红包金额非均匀分布（如正态分布），需重新计算密度函数积分。
2. **离散型红包**：参考微信红包的离散分割问题（如[P5147 随机数生成器](https://www.luogu.com.cn/problem/P5147)）。

---

### 相似题目推荐
1. **[P5147] 随机数生成器**：期望递推与快速幂结合。
2. **[P2521] [HAOI2018] 染色**：概率论与多项式逆元应用。
3. **[P5104] 红包发红包**：同类型题目巩固。

---
处理用时：41.77秒
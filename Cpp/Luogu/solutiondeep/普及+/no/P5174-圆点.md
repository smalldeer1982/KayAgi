# 题目信息

# 圆点

## 题目背景

中考了，Pg看着数学卷子的压轴题，陷入了沉思……

题解：https://blog.csdn.net/kkkksc03/article/details/85008125

## 题目描述

众所周知，平面中的每一个整点都**有且仅有**一个圆心在原点的圆穿过，我们定义这个整点的权值为穿过它的圆的**半径的平方**。

现在有一个圆心在原点的圆，半径为$\sqrt{R}$。你要求出这个圆所包含的所有整点的权值**和**。

由于答案可能过大，对$10^9+7$取模。


## 说明/提示

样例1 解释：

共包含了$9$个整点。分别为$(0,0),(0,1),(1,1),(1,0),(1,-1),(0,-1),(-1,-1),(-1,0),(-1,1)$。

权值分别为$\ 0,1,2,1,2,1,2,1,2$，总和为12。

--------
   
对于50%的数据，$R \le 10^{6}.$

对于100%的数据，$R \le 10^{14}.$


## 样例 #1

### 输入

```
3```

### 输出

```
12```

## 样例 #2

### 输入

```
100
```

### 输出

```
16012```

## 样例 #3

### 输入

```
1234567
```

### 输出

```
205275050```

# AI分析结果



### 算法分类：数学

### 题解对比与结论
各题解核心思路均为枚举x，计算y的最大值，利用对称性分象限求和，最后乘4。关键区别在于如何处理坐标轴上的点及取模优化：

1. **mrsrz的题解**：枚举x≥0，计算y的范围，使用平方和公式计算贡献。利用`__int128`避免溢出，时间复杂度O(√R)。处理坐标轴点时自然包含在枚举中，代码简洁高效。
2. **henry_y的题解**：思路类似，明确分离x²和y²贡献，代码可读性强。
3. **Scrutiny的题解**：显式推导平方和公式，强调数学推导过程，适合理解原理。

### 高星题解推荐

#### 题解作者：mrsrz（5星）
- **关键亮点**：利用对称性分象限，数学推导清晰，代码高效，正确处理坐标轴贡献。
- **核心代码**：
  ```cpp
  for(int i=0;(LL)i*i<R;++i){
      const int b=sqrt(R-(LL)i*i);
      ans=(ans+(__int128)i*i*b + (__int128)b*(b+1)*(2*b+1)/6)%mod;
  }
  ans = (ans *4) % mod;
  ```

#### 题解作者：henry_y（4星）
- **关键亮点**：详细公式分步解释，适合数学基础较弱者。
- **核心代码**：
  ```cpp
  for(ll x=0;x*x<=R;++x){
      ll y=sqrt(R-x*x);
      ans += x*x*y + y*(y+1)*(2*y+1)/6;
  }
  ans = (ans *4) % mod;
  ```

### 关键思路总结
- **对称性优化**：只计算第一象限及半轴，乘4得全局解。
- **平方和公式**：Σy²= n(n+1)(2n+1)/6，避免逐项累加。
- **坐标轴处理**：自然包含在枚举中，取模运算分解到每一步。

### 同类型题目推荐
1. **P2508 [HAOI2008] 圆上的整点**（圆上整点计数）
2. **P1835 素数密度**（区间质数统计，类似枚举优化）
3. **P1403 [AHOI2005] 约数研究**（数学规律与分块优化）

---
处理用时：535.99秒
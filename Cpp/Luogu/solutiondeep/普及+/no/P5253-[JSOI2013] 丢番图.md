# 题目信息

# [JSOI2013] 丢番图

## 题目背景

丢番图是亚历山大时期埃及著名的数学家。他是最早研究整数系数不定方程的数学家之一。

为了纪念他，这些方程一般被称作丢番图方程。最著名的丢番图方程之一是

$$x^n+y^n=z^n$$

费马提出，对于 $n>2$, $x,y,z$ 没有正整数解。这被称为“费马大定理”，它的证明直到最近才被安德鲁·怀尔斯（AndrewWiles）证明。

## 题目描述

考虑如下的丢番图方程：

$$\frac{1}{x}~+~\frac{1}{y}~=~\frac{1}{n}~,(x,y,n~\in~N^+)$$

小G对下面这个问题十分感兴趣：对于一个给定的正整数 $n$，有多少种本质不同的解满足上面的方程？例如 $n=4$，有三种本质不同 ($x~\leq~y$)的解：

> $\frac{1}{5}+\frac{1}{20}~=~\frac{1}{4}$
>
> $\frac{1}{6}+\frac{1}{12}~=~\frac{1}{4}$
>
> $\frac{1}{8}+\frac{1}{8}~=~\frac{1}{4}$

显然，对于更大的 $n$，没有意义去列举所有本质不同的解。你能否帮助小G快速地求出对于给定 $n$，满足上面方程的本质不同的解的个数？

## 说明/提示

#### 数据规模与约定

对于全部的测试点，保证 $1\leq n \leq 10^{14}$。

## 样例 #1

### 输入

```
4```

### 输出

```
3```

# AI分析结果



**算法分类**：数学

**综合分析**  
题目核心是将分式方程转化为整数方程，通过因数分解与质因数分解求解。各题解均基于推导得到关键等式 $(x-n)(y-n)=n^2$，进而统计 $n^2$ 的因数对数。最终答案通过质因数分解计算 $n^2$ 的因数总数，并利用对称性去重。

**高星题解推荐**  
1. **Dry_ice（5星）**  
   - **关键亮点**：推导清晰，代码简洁高效，变量命名合理，处理边界条件明确。  
   - **核心代码**：  
     ```cpp
     long long ans = 1;
     for (long long i = 2; i * i <= n; ++i) {
         if (n % i == 0) {
             long long k = 0;
             while (n % i == 0) n /= i, ++k;
             ans *= (2 * k + 1);
         }
     }
     if (n > 1) ans *= 3;
     printf("%lld\n", (ans + 1) >> 1);
     ```
   - **实现思想**：试除法分解质因数，计算各质因子指数，利用因数公式 $(2a_i+1)$ 累乘，最后调整对称性。

2. **0x3F（4星）**  
   - **关键亮点**：代码简洁，注释明确，快速处理质数余留情况。  
   - **核心代码**：  
     ```cpp
     for (long long i = 2; i * i <= n; i++) {
         int cnt = 0;
         while (n % i == 0) n /= i, cnt++;
         ans *= (2 * cnt + 1);
     }
     if (n > 1) ans *= 3;
     ```

3. **da32s1da（4星）**  
   - **关键亮点**：代码极简，直接应用公式，无冗余操作。  
   - **核心代码**：  
     ```cpp
     for(LL i=2;i*i<=n;i++)
         if(n%i==0){
             for(cnt=0;n%i==0;n/=i,cnt++);
             Ans*=(cnt*2+1);
         }
     ```

**关键思路与技巧**  
1. **数学变形**：将分式方程转化为 $(x-n)(y-n)=n^2$，将解的数量问题转化为因数对统计。  
2. **质因数分解**：试除法高效分解质因数，计算各质因子指数。  
3. **因数公式**：利用 $n^2$ 的因数总数公式 $(2a_i+1)$ 累乘。  
4. **对称性处理**：通过 $(ans + 1) / 2$ 去重，处理 $x \le y$ 的限制。

**拓展与举一反三**  
- **类似问题**：求满足 $ax + by = c$ 的整数解数、因数分解相关题目。  
- **推荐题目**：  
  - [P1403 [AHOI2005]约数研究](https://www.luogu.com.cn/problem/P1403)  
  - [P1072 [NOIP2009 提高组] Hankson 的趣味题](https://www.luogu.com.cn/problem/P1072)  
  - [P2424 约数和](https://www.luogu.com.cn/problem/P2424)  

**个人心得摘录**  
- **质数处理**：分解后若剩余 $n > 1$，必为单个大质数（徐致远）。  
- **代码优化**：直接试除法无需预处理素数，应对 $10^{14}$ 范围足够高效（Dry_ice）。

---
处理用时：95.64秒
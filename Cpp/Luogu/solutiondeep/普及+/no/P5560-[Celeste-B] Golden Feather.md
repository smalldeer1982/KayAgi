# 题目信息

# [Celeste-B] Golden Feather

## 题目背景

> 就是这样，Madeline。

> 保持呼吸。你能行。

## 题目描述

“你的呼吸让那片羽毛一直飘着。”

“平稳缓慢地呼吸，吸气，吐气。”

“看吧，每次都是这么轻松。”

随着 Madeline 的呼吸，羽毛上下移动着。

通过 Madeline 的观察，她还发现，羽毛似乎遵循这一种神奇的运动轨迹。

在每一轮呼吸中，羽毛会在特定的地方停止，这些地方都是有魔力的，具体来说，第 $i$ 个停留处的魔力是 $(i+1)^2-1$。

并且，在一轮呼吸停止时，羽毛会渗透出一些能量，只要能用这些能量沟通这些停止的地方，Madeline 就能运用羽毛的力量飞翔。更具体的，由于同性相斥，两个地方魔力的相似程度越高就越难被沟通，沟通两个地方所需要的能量为这两个地方魔力的 $gcd$。

在一轮一轮的呼吸中，Madeline 已经无暇算出最少需要的能量，由于羽毛渗透出的能量不多，你能帮帮她算出最少需要多少能量来沟通这些羽毛停止的地方吗？

## 说明/提示

n=3 的样例解释如下图

![T1_2.png](https://i.loli.net/2019/09/14/PtflkNCE8b3iKzB.png)
![T1.png](https://i.loli.net/2019/09/14/AIYlMZgonL7thfu.png)

对于 $5\%$ 的数据，$n \leq 3$

对于 $10\%$ 的数据，$n \leq 1000$

对于 $50\%$ 的数据，$n \leq 10^6$,$T \leq 10$

对于 $100\%$ 的数据，$n \leq 10^{18}$,$T \leq 100$

## 样例 #1

### 输入

```
4
1
2
3
9
```

### 输出

```
0
1
2
8```

# AI分析结果



**算法分类**：数学

**综合分析与结论**  
本题要求构造最小生成树，边权为两节点权值的GCD。通过分析节点权值的数学性质发现，除n=4和10外，所有节点均存在边权为1的连接方式，总和为n-1。特例情况下需额外边权3，总和为n+1。核心在于对互质条件的数学推导与特例识别。

---

**精选题解**  
1. **5ab_juruo（5星）**  
   - **关键亮点**：通过递推与质因数分解证明边权规律，结合模运算深入分析特例条件，逻辑严谨。  
   - **代码片段**：直接判断n是否为4或10，其余输出n-1。  
   ```cpp
   if(n == 4 || n == 10) cout << n + 1 << endl;
   else cout << n - 1 << endl;
   ```

2. **Mophie（4星）**  
   - **关键亮点**：分模数讨论互质条件，明确推导出当n≡4 (mod6)时的特殊处理逻辑，数学推导清晰。  
   - **个人心得**：“考试时打表找规律更高效，但需理解数学背景。”

3. **pikabi（4星）**  
   - **关键亮点**：通过打表与条件反证快速定位特例，代码简洁高效，适合竞赛场景。  
   - **代码片段**：特判4和10，其他情况直接返回n-1。  

---

**核心思路总结**  
- **数学优化**：利用数论性质（互质条件）将问题转化为寻找是否存在GCD为1的边，避免显式生成树计算。  
- **特例处理**：通过观察与严格证明确定仅n=4和10无法满足全1边权，需单独处理。  

**扩展与举一反三**  
- **类似题型**：涉及GCD构造的图论问题（如CF1095F）、模数分情况讨论题（如洛谷P1463）。  
- **推荐题目**：  
  1. [P1463 反素数](https://www.luogu.com.cn/problem/P1463)  
  2. [CF1095F Make It Connected](https://codeforces.com/problemset/problem/1095/F)  
  3. [P2568 GCD](https://www.luogu.com.cn/problem/P2568)

---
处理用时：47.69秒
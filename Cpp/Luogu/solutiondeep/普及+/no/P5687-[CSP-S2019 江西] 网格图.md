# 题目信息

# [CSP-S2019 江西] 网格图

## 题目背景

JXCSP-S T3

## 题目描述

给定一个 $n\times m$ 的网格图，行从 $1\sim n$ 编号，列从 $1\sim m$ 编号，每个点可用它所在的行编号 $r$ 与所在的列编号 $c$ 表示为 $(r, c)$。

点 $(i,j)$ 与 $(i,j+1)$ 间连有一条权值为 $a_i$ 的边，其中 $1\le i\le n, 1\le j<m$。

点 $(i, j)$ 与 $(i+1,j)$ 间连有一条权值为 $b_j$ 的边，其中 $1\le i< n, 1\le j \le m$。

请你求出这个网格图的最小生成树。

## 说明/提示

#### 【输入输出样例 1 说明】
最小生成树中的边包括：第一行上的所有边，第一列、第二列、第三列上的所有边。

#### 【数据规模与约定】

对于 $20\%$ 的数据，$n, m\le 3$，$a_i, b_j \le 10$；

对于 $40\%$ 的数据，$n, m\le 20$，$a_i, b_j\le 100$；

对于 $64\%$ 的数据，$n, m\le 300$，$a_i, b_j\le 1000$；

对于 $100\%$ 的数据：$3\le n, m \le 3\times 10^5$，$1 \le a_i, b_j\le 10^5$。 

## 样例 #1

### 输入

```
3 3
2 4 3
1 3 2```

### 输出

```
16```

# AI分析结果



### 算法分类
贪心

### 题解综合分析
本题要求构建网格图的最小生成树，数据规模庞大，需高效贪心策略。各题解核心思路是将行和列的边权排序，按权值从小到大处理，维护已处理的行列数，避免成环。

---

### 精选题解

#### 1. 作者：Zenith_Yeh (5星)
**关键亮点**：
- 排序后，初始处理最小行和列确保连通。
- 动态维护已处理的行列数，每次选择最小边权并计算可添加的边数。
- 代码简洁高效，直接累加避免复杂条件判断。

**核心代码**：
```cpp
sort(a+1,a+n+1);
sort(b+1,b+m+1);
ans = a[1]*(m-1) + b[1]*(n-1);
int cnta=2, cntb=2, h=1, l=1;
while (cnta <= n && cntb <= m) {
    if (a[cnta] <= b[cntb]) 
        ans += (long long)a[cnta++] * (m - l), h++;
    else 
        ans += (long long)b[cntb++] * (n - h), l++;
}
```

---

#### 2. 作者：pengyule (4星)
**关键亮点**：
- 先加全部可能边数，再根据已处理行列数减少环。
- 通过维护 `x`（行数）和 `y`（列数）动态调整。

**核心代码**：
```cpp
for (int i=1; i<=n+m; i++) {
    if (a[i].ty == 1) {
        sum += 1ll*(m-1)*a[i].val;
        x = x < n ? x+1 : x;
        if (x > 1 && y > 1) sum -= 1ll*(y-1)*a[i].val;
    } else {
        sum += 1ll*(n-1)*a[i].val;
        y = y < m ? y+1 : y;
        if (x >1 && y >1) sum -= 1ll*(x-1)*a[i].val;
    }
}
```

---

#### 3. 作者：qhr2023 (4星)
**关键亮点**：
- 极简实现，直接维护 `h`（行数）和 `l`（列数）。
- 无冗余操作，直接按排序顺序处理。

**核心代码**：
```cpp
for (int A=2, B=2, h=1, l=1; A<=n && B<=m; )
    if (a[A] <= b[B]) 
        ans += a[A++]*(m-l), h++;
    else 
        ans += b[B++]*(n-h), l++;
```

---

### 最优思路总结
1. **排序贪心**：将行和列的边权分别排序，按从小到大处理。
2. **维护状态**：动态跟踪已处理的行数（`sr`）和列数（`sc`）。
3. **避免成环**：处理行边时添加 `m - sc` 条，处理列边时添加 `n - sr` 条，确保不形成环。
4. **连通性保证**：初始处理最小行和列，确保全局连通。

---

### 类似题目推荐
1. [P3366 【模板】最小生成树](https://www.luogu.com.cn/problem/P3366)
2. [P2872 [USACO07DEC]Building Roads S](https://www.luogu.com.cn/problem/P2872)
3. [P1991 无线通讯网](https://www.luogu.com.cn/problem/P1991)

---
处理用时：230.56秒
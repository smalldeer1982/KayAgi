# 题目信息

# [IOI 2011] ricehub

## 题目描述

乡间有一条笔直而长的路称为“米道”。沿着这条米道上$R$  块稻田，每块稻田的坐标均为一个 $1$ 到 $L$ 之间(含 $1$ 和 $L$ )的整数。这些稻田按照坐标以不减的顺序给出，即对于 $0 \le i < R$，稻田 $i$ 的坐标 $X[i]$ 满足 $1 \le X[0] \le \cdots \le X[R-1] \le L$。

注意：可能有多块稻田位于同一个坐标上。

我们计划建造一个米仓用于储存尽可能多的稻米。和稻田一样，米仓将建在米道上，其坐标也是一个 $1$ 到 $L$ 之间的整数（含 $1$ 和 $L$）。这个米仓可以建在满足上述条件的任一个位置上，包括那些原来已有一个或多个稻田存在的位置。

在收获季节，每一块稻田刚好出产一滿货车的稻米。为了将这些稻米运到米仓，需要雇用一位货车司机来运米。司机的收费是每一满货车运送一个单位的距离收取 $1$ 元。換言之，将稻米从特定的稻田运到米仓的费用在数值上等于稻田坐标与米仓坐标之差的绝对值。

不幸的是，今年预算有限，我们至多只能花费 $B$ 元运费。你的任务是要帮我们找出一个建造米仓的位置，可以收集到尽可能多的稻米。

## 说明/提示

对于 $100\%$ 的数据，$1 \le R \le 10^5$，$1 \le L \le 10^9$，$ 0 \le B \le 2 \times 10^{15}$。

## 样例 #1

### 输入

```
5 20 6
1
2
10
12
14```

### 输出

```
3```

# AI分析结果



**算法分类**: 数学 + 前缀和

---

### 综合分析与结论
题目核心在于利用**绝对值不等式的中位数性质**快速计算区间最小费用，结合**前缀和**优化区间求和，通过**双指针/二分**遍历所有可能区间。所有题解均基于以下关键数学结论：选定区间的最优米仓位置为中位数，此时总费用最小。时间复杂度最优解法为双指针法（O(n)），其次为二分法（O(n logn)）。

---

### 最优题解与关键代码

#### 1. Jameswood 题解 (⭐⭐⭐⭐⭐)
**核心亮点**：
- 同时给出双指针与二分两种解法，理论分析透彻
- 数学推导清晰，包含绝对值不等式的完整证明链
- 代码简洁易读，双指针法实现高效

**关键代码（双指针法）**：
```cpp
long long check(long long l,long long r){ // 计算区间[l,r]的最小费用
    mid=l+r>>1;
    return x[mid]*(mid*2-l-r) + sum[l-1] + sum[r] - sum[mid] - sum[mid-1];
}
// 双指针主逻辑
for(long long l=1,r=1;l<=R;l++){
    while(r<R && check(l,r+1)<=B) ++r;
    ans=max(ans,r-l+1);
}
```

#### 2. CYZZ 题解 (⭐⭐⭐⭐)
**核心亮点**：
- 数学结论表述严谨，包含奇偶分类讨论
- 双指针实现简洁，代码包含详细注释
- 公式推导与代码实现高度对应

**关键代码**：
```cpp
bool check(ll l,ll r){
    ll mid=(l+r)/2;
    return ((sum[r]-sum[mid]) - (sum[mid-1]-sum[l-1]) 
            - a[mid]*((r-l)&1)) <= v; // 奇偶处理技巧
}
```

#### 3. 封禁用户 题解 (⭐⭐⭐)
**核心亮点**：
- 极简代码风格，单函数实现核心逻辑
- 公式推导与代码高度压缩，适合进阶学习

---

### 关键思路总结
1. **数学核心**：区间最优米仓必为中位数，总费用可分解为对称项差值求和
2. **前缀和优化**：通过预处理前缀和数组，将区间求和复杂度降至O(1)
3. **滑动窗口**：双指针维护当前最大合法区间，右指针贪心扩展，左指针跟随收缩

---

### 拓展与相似题目
1. [P1886 滑动窗口](https://www.luogu.com.cn/problem/P1886) - 双指针基础应用
2. [P1638 逛画展](https://www.luogu.com.cn/problem/P1638) - 滑动窗口求极值 
3. [P1102 A-B数对](https://www.luogu.com.cn/problem/P1102) - 双指针结合数学性质

---
处理用时：58.42秒
# 题目信息

# [IOI 2014] game 游戏

## 题目描述

健佳是一个喜欢做游戏的小男生。当有人问问题时，他更喜欢通过玩游戏的方式作答，而不是直接回答。健佳碰到了他的朋友梅玉，跟她讲了台湾的航空网。在台湾有 $n$ 个城市（编号为 $0,\cdots,n−1$），其中有些城市之间有航线。每个航线连接两个城市，并且是双向的。

梅玉问健佳，是否任意两个城市之间都可以坐飞机互达（直接或间接），健佳不想直接回答，而是要通过做游戏的方式来告诉她。梅玉可以问"城市 $u$ 和 $v$ 之间有直接航线吗？"，健佳会立刻直接回答该问题。梅玉会询问每对城市恰好一次，因此总计会有 $r = \frac{n (n−1)}{2}$ 个问题。如果由前 $i$（$i<r$）个问题的答案可以推断出整个航空网是否连通，也就是说，是否任意一对城市之间都可以坐飞机互达（直接或间接），梅玉就获胜。否则意味着她需要知道全部 $r$ 个回答，此时健佳获胜。

为了让游戏更好玩，他们俩同意，健佳可以不要管台湾的真实航空网，而是可以随着游戏的进展而编造航空网，也就是根据梅玉此前的提问来决定此后如何作答。你的任务是，通过决定健佳如何回答，来帮助他赢得游戏。

## 说明/提示

**子任务及数据规模**

| 子任务 | 分值 | $n$ |
| :----------: | :----------: | :----------: |
| $1$ | $15$ | $n=4$ |
| $2$ | $27$ | $4 \le n \le 80$ |
| $3$ | $58$ | $4 \le n \le 1500$ |


## 样例 #1

### 输入

```
4
0 3
1 0
0 2
3 1
1 2
2 3
```

### 输出

```
0
1
0
1
0
1
```

# AI分析结果



### 算法分类
构造

### 题目分析
本题要求构造一种回答策略，使得在最后一个询问前无法判断图的连通性。核心思路是通过控制生成树边的出现顺序，确保最后一条边才形成完整的连通结构。

### 精选题解
1. **清平乐（★★★★★）**  
   **关键思路**：将图视为生成树，每个节点的最后一条被询问边作为树边。维护每个节点的出边计数，当某节点的出边数等于其编号时，此边作为其父边。  
   **代码亮点**：时间复杂度O(n²)，仅需6行核心逻辑。  
   ```cpp
   if(u<v) swap(u,v);  // 保证u是较大编号节点
   printf("%d\n",++deg[u]==u); // 当该节点第k次被访问时连接（k=u）
   ```

2. **Happy_Orca（★★★★☆）**  
   **关键思路**：逆序处理所有边，用并查集构建生成树。最后一条边强制连接，其余边仅在合并不同连通块时连接。  
   **实现技巧**：逆序构造确保前n-1条边无法单独确定连通性。  
   ```cpp
   for(int i=n-1;i>=1;i--){
       int fx=getfa(x[i]),fy=getfa(y[i]);
       if(fx!=fy) ans[i]=1,fa[fx]=fy; // 合并不同连通块时连接
   }
   ```

3. **zzqDeco（★★★★☆）**  
   **核心思想**：按节点编号定向边（大→小），每个节点的第i次询问（i=节点编号）时连接。  
   **代码简洁性**：仅需维护一个计数器数组，逻辑极简。  
   ```cpp
   if(a<b) a=b;  // 统一方向为较大节点
   if(++cnt[a]==a) printf("1\n"); // 第a次询问该节点时连接
   ```

### 关键思路总结
**生成树末位构造法**：将生成树的关键边（父节点连接边）设置为每个节点的最后一条被询问边。通过维护节点出边次数或逆序处理边，确保生成树结构仅在最后一步完整呈现。

### 拓展应用
类似构造题可参考：  
1. [P3366 最小生成树](https://www.luogu.com.cn/problem/P3366)（生成树基础）  
2. [P1558 色板游戏](https://www.luogu.com.cn/problem/P1558)（区间操作与延迟更新）  
3. [P1969 积木大赛](https://www.luogu.com.cn/problem/P1969)（构造操作序列）  

### 题解心得摘录
- **清平乐**："构造树边时，每个点最后被询问到的边构成生成树" → 核心在于树结构的延迟构建。  
- **Schi2oid**："每个结点的连通性仅由其入边决定" → 强调单向依赖关系，简化问题复杂度。

---
处理用时：54.29秒
# 题目信息

# [IOI 2004] Phidias 菲迪亚斯神

## 题目背景

有名的希腊雕刻神菲迪亚斯正在为他下一座雄伟的雕像作准备。

## 题目描述

为了这座雕像他需要大小为 $W_1\times H_1,W_2\times H_2, ...,W_N \times H_N$ 的矩形大理石板。

最近菲迪亚斯获得一块矩形大理石块。菲迪亚斯想把这块石板切成所需要的大小。

石板或是石板所切割出的部分都可以由垂直(或水平)方向纵贯(或是横贯)加以切割到底成为两块矩形石板，同时切割出的这两块矩形石板都必须具有整数的宽度与高度。

石板只能以此种方法加以切割，同时石板不能粘合成较大石板。

因为石板具有花纹，所以石板也不能旋转。

如果菲迪亚斯切割出一块 $A\times B$ 的石板，则此石板不能被当成 $B\times A$ 的石板使用，除非 $A$ 等于 $B$。对每一种所需石板大小菲迪亚斯可切割出零或更多块石板。如果当所有的切割完成时，一块产生出的石板并不是任何所需要的大小，则此石板成为废料。

菲迪亚斯想知道如何切割最初的石板，才能让所产生的废料最少。

例如，下图中的原始石板宽度为 $21$ 且高度为 $11$，而所需石板大小为 $10\times4,6\times 2, 7\times5$ 及 $15\times 10$, 则最小废料总面积为 $10$。下图同时画出最小废料总面积为 $10$ 的切割方法：

![](https://cdn.luogu.com.cn/upload/image_hosting/s48ydewh.png)

你的工作是写一个程序由给定的原始石板大小及所需要的各种石板大小计算出最小的废料总面积。

## 说明/提示

对于 $100\%$ 的数据，$1\le W,H\le600$，$0\le N\le 200$，$1 \le W_i \le W$，$1 \le H_i \le H$。



## 样例 #1

### 输入

```
21 11
4
10 4
6 2
7 5
15 10```

### 输出

```
10```

# AI分析结果



**算法分类**  
动态规划  

**综合分析与结论**  
本题核心是二维动态规划，需枚举所有可能的切割方式（横向/纵向）并选择废料最小的方案。Begemot 的 DP 解法通过状态转移覆盖所有切割情况，正确性有保障；记忆化搜索解法仅考虑切割目标石板的情况，可能遗漏最优解，导致部分测试点无法通过。  

---

**精选题解**  

1. **Begemot（5星）**  
   **关键亮点**：  
   - 正确性高，覆盖所有切割可能。  
   - 状态定义清晰（`f[i][j]` 表示 `i×j` 矩形的最小废料）。  
   - 通过横向/纵向切割枚举所有子状态，确保最优解。  
   **核心代码**：  
   ```cpp
   for (int i = 1; i <= w; ++i) {
       for (int j = 1; j <= h; ++j) {
           for (int k = 1; k <= i; ++k) // 纵向切割
               f[i][j] = min(f[i][j], f[k][j] + f[i - k][j]);
           for (int k = 1; k <= j; ++k) // 横向切割
               f[i][j] = min(f[i][j], f[i][k] + f[i][j - k]);
       }
   }
   ```  
   **实现思想**：  
   初始化所有 `f[i][j]` 为 `i×j`，将目标石板废料设为 0。枚举所有可能的切割点，通过子状态的和更新当前状态，最终 `f[w][h]` 即为答案。  

---

**关键思路总结**  
1. **状态设计**：二维 DP 表示特定尺寸石板的最小废料。  
2. **转移优化**：枚举所有切割方式，确保不遗漏最优分割点。  
3. **初始化技巧**：目标石板废料直接置零，简化后续转移逻辑。  

**拓展思路**  
类似问题包括二维材料切割优化（如木板、布料裁剪），可参考经典二维 DP 模型，如背包问题的变形或 SPOJ 相关题目。  

**推荐题目**  
1. [P1433 切割木棍](https://www.luogu.com.cn/problem/P1433)  
2. [P1541 分割木板](https://www.luogu.com.cn/problem/P1541)  
3. [SPOJ MATCHING](https://www.spoj.com/problems/MATCHING/)（图论与 DP 结合）

---
处理用时：99.60秒
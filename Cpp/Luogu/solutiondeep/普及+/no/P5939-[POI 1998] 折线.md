# 题目信息

# [POI 1998] 折线

## 题目描述

给定二维直角坐标系。

我们要求一条折线只能从左边到右边一笔画过去，并且折线的每一段和 $x$ 轴的夹角在 $[-45°, 45°]$ 之间。

一条满足上述要求的折线被称为：平直折线。

给定坐标系上的 $n$ 个格点，最少需要画多少条平直折线才能覆盖所有的点呢？

## 说明/提示

对于 $100\%$ 的数据，$1\le n\le30000$，$0\le x,y\le 30000$。

## 样例 #1

### 输入

```
5
2 3
3 4
4 5
1 6
12 27```

### 输出

```
3```

# AI分析结果



### 算法分类
贪心、数学（坐标变换）

### 综合分析与结论
题目要求用最少的满足斜率限制的折线覆盖所有点。核心思路是**坐标变换**将几何条件转化为序列问题，应用**Dilworth 定理**将最少链覆盖转化为最长反链长度，最终通过**贪心+二分**优化求解最长子序列。

### 精选题解
#### 题解1（作者：lemondinosaur，⭐⭐⭐⭐⭐）
**关键亮点**  
1. 将坐标系逆时针旋转45°，新坐标 $(x+y, y-x)$ 简化问题。  
2. 按新x升序、新y降序排序后，问题转化为**最长上升子序列**的长度。  
3. 代码简洁，使用 `lower_bound` 高效维护最长子序列。

**核心代码**  
```cpp
sort(a+1,a+1+n,cmp); // 按x升序，y降序排序
for (int i=2;i<=n;++i) {
    if (a[i].y > b[len]) b[++len] = a[i].y;
    else b[lower_bound(b+1,b+1+len,a[i].y)-b] = a[i].y;
}
```
**实现思想**  
维护数组 `b` 存储最长上升子序列，每次通过二分查找插入位置，保证数组有序，时间复杂度 $O(n \log n)$。

#### 题解2（作者：Y_ATM_K，⭐⭐⭐⭐）
**关键亮点**  
1. 逆时针旋转后的坐标为 $(x-y, x+y)$，按x升序、y升序排序。  
2. 维护每个折线的末尾y最小值，通过二分优化最长子序列的维护。

**核心代码**  
```cpp
sort(a+1,a+1+n); // 按x升序，y升序排序
if (a[i].y < hei[cnt]) hei[++cnt] = a[i].y;
else {
    int l=1, r=cnt;
    while (l < r) { // 二分找到替换位置
        int mid = (l+r)>>1;
        if (hei[mid] <= a[i].y) r = mid;
        else l = mid+1;
    }
    hei[l] = a[i].y;
}
```
**实现思想**  
维护数组 `hei` 存储最长不升子序列的末尾最小值，通过二分查找替换位置，保证数组单调性。

### 最优技巧总结
1. **坐标变换**：通过旋转将几何条件转化为序列问题。  
2. **Dilworth 定理**：将最少链覆盖转化为最长反链（最长子序列）。  
3. **贪心+二分**：高效维护最长子序列，复杂度 $O(n \log n)$。

### 拓展应用
类似问题可考虑通过**坐标变换**（如投影、旋转）将几何条件转化为序列或区间问题，结合**贪心/动态规划**解决。例如：矩形覆盖、斜线约束路径等。

### 推荐题目
1. [P1020 导弹拦截](https://www.luogu.com.cn/problem/P1020)  
2. [P4290 下落的圆盘](https://www.luogu.com.cn/problem/P4290)  
3. [P2453 阶梯教室](https://www.luogu.com.cn/problem/P2453)

---
处理用时：337.50秒
# 题目信息

# [CEOI 2008] Dominance

## 题目描述

给出一个宽为 $W$，高为 $H$ 的矩形 。
 
在它上面有两种点， $black$ 及 $white$。 每个点都有自己的辐射范围。对于其它的点如果它受到白点的辐射多于黑色的，则为白点，反之亦然，如果相同的话则中立。

现给出白点及黑色的坐标及各自的辐射范围，问最后白色点一共有多少个，黑色点共有多少个 。

## 说明/提示

对于 $100\%$ 的数据，$1 \le  W,H \le 10^9$，$0 \le  N \le  3\times 10^3$。


-----

### 样例解释：

![](https://cdn.luogu.com.cn/upload/image_hosting/hfu3bgfx.png)

## 样例 #1

### 输入

```
10 10
3
W 3 6 3
B 6 4 2
W 3 3 2```

### 输出

```
30 9```

# AI分析结果



### 算法分类
**扫描线、离散化**

---

### 题解分析与结论
题目核心在于将曼哈顿距离转换为切比雪夫距离，将斜向正方形转为轴对齐矩形，再通过扫描线统计黑白覆盖的奇偶点数量。关键难点在于坐标转换后的奇偶性处理与高效离散化。

---

### 高分题解摘录（评分≥4星）

#### 题解1 - Azazеl（4星）
**关键亮点**  
1. 清晰阐述了曼哈顿→切比雪夫转换的数学原理与必要性。  
2. 使用扫描线处理离散事件，避免直接离散化大范围坐标。  
3. 通过分奇偶统计，精准计算有效点数量。  

**代码核心思想**  
1. 坐标转换后，记录所有竖直扫描线事件（进入/离开矩形）。  
2. 按坐标排序后，逐个处理事件，维护水平方向的覆盖状态。  
3. 通过 `Get` 函数计算区间内奇偶线数量，结合覆盖类型统计总点数。  

**核心代码**  
```cpp
struct UpRight { ll x, l, r, Type; }; // 竖直扫描线事件
Square Get(ll l, ll r) { // 计算区间[l, r]内的奇偶线数量
    Square ret = Square((r - l) >> 1, (r - l) >> 1);
    if ((r - l) & 1) (r & 1) ? ret.odd++ : ret.even++;
    return ret;
}
// 处理事件时，维护覆盖状态并累加答案
for (int i = 1; i <= U; i++) {
    Squ = Get(Last, Up[i].x);
    AnsW += Squ * W; AnsB += Squ * B; // 累加当前覆盖区域的贡献
    // 更新水平覆盖状态...
}
```

---

#### 题解2 - cqbzlzm（4星）
**关键亮点**  
1. 代码简洁，直接复用扫描线框架，事件处理高效。  
2. 通过 `get` 函数快速计算奇偶点分布。  
3. 使用离散化压缩坐标范围，减少冗余计算。  

**代码核心思想**  
1. 坐标转换后离散化所有纵坐标。  
2. 按横坐标排序事件，遍历时维护纵坐标覆盖状态。  
3. 通过离散化后的索引快速定位区间，分奇偶累加结果。  

**核心代码**  
```cpp
struct line { int x, y1, y2, d; }; // 扫描线事件
node get(int l, int r) { // 奇偶点统计
    return {(r - l + 1) / 2 + (((r - l + 1) & 1) & (r & 1)), 
            (r - l + 1) / 2 + (((r - l + 1) & 1) & !(r & 1))};
}
// 处理离散化后的区间覆盖
for (int j = Y1; j < Y2; j++) {
    cur = get(re[j], re[j + 1] - 1);
    // 根据覆盖状态更新奇偶计数...
}
```

---

### 最优思路总结
1. **坐标转换**：曼哈顿距离转为切比雪夫距离，使覆盖区域轴对齐。  
2. **扫描线算法**：处理离散事件，按横坐标排序后逐线扫描，维护纵坐标覆盖状态。  
3. **奇偶分治**：转换后的坐标需分奇偶统计有效点，避免非法坐标干扰。  
4. **离散化优化**：仅对事件点离散化，避免处理超大范围坐标。  

---

### 扩展思路
- 类似问题：矩形覆盖统计（如[洛谷P5490](https://www.luogu.com.cn/problem/P5490)）。  
- 其他应用：处理高维空间覆盖问题时，可尝试降维或坐标转换简化形状。  

---

### 推荐习题
1. [P5490 扫描线模板题](https://www.luogu.com.cn/problem/P5490)  
2. [P1884 覆盖统计](https://www.luogu.com.cn/problem/P1884)  
3. [P3717 覆盖问题（离散化应用）](https://www.luogu.com.cn/problem/P3717)  

---

### 个人心得摘录
- **坐标转换的合法性**：转换后的点需满足奇偶性一致，否则原坐标无对应整点。  
- **离散化陷阱**：需注意区间端点是否闭合，避免覆盖计算错误。  
- **调试技巧**：可通过小规模样例手动验证奇偶统计逻辑的正确性。

---
处理用时：67.57秒
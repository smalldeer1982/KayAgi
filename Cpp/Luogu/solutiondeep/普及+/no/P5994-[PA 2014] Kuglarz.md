# 题目信息

# [PA 2014] Kuglarz

## 题目描述

魔术师的桌子上有 $n$ 个杯子排成一行，编号为 $1,2,…,n$，其中某些杯子底下藏有一个小球，如果你准确地猜出是哪些杯子，你就可以获得奖品。

花费 $c_{ij}$ 元，魔术师就会告诉你杯子 $i,i+1,…,j$ 底下藏有球的总数的奇偶性。

采取最优的询问策略，你至少需要花费多少元，才能保证猜出哪些杯子底下藏着球？

## 说明/提示

对于 $100\%$ 的数据，$1\le n\le 2\times 10^3$，$1\le c_{ij}\le 10^9$。

## 样例 #1

### 输入

```
5
1 2 3 4 5
4 3 2 1
3 4 5
2 1
5```

### 输出

```
7```

# AI分析结果



**算法分类**: 图论（最小生成树）

---

### 综合分析与结论
题目核心是将区间奇偶性查询转化为图论问题。所有杯子的确定等价于构建前缀和奇偶性连通图，最小生成树保证连通性的同时最小化代价。关键难点在于将区间查询建模为边权，并发现连通性等价于信息可推导性。

---

### 精选题解

#### 1. 逃离地球（⭐⭐⭐⭐⭐）
**关键亮点**:
- 完整解释区间查询与图边权的映射关系，提出将 `[l,r]` 视为 `l-1` 到 `r` 的边。
- 证明连通性要求，明确最小生成树的应用逻辑。
- 代码使用邻接表建图 + 堆优化 Prim，适合稠密图。

**核心代码**（Prim 算法）：
```cpp
priority_queue<pair<int,int>> q;
memset(dis, 0x3f, sizeof(dis));
q.push({0, 1}), dis[1] = 0;
while (!q.empty()) {
    int x = q.top().second; q.pop();
    if (vis[x]) continue;
    vis[x] = 1, ans += dis[x];
    for (遍历邻接边更新距离)
}
```

#### 2. 7KByte（⭐⭐⭐⭐）
**关键亮点**:
- 引入虚拟节点 `0`，将问题转化为 `0~n` 的连通问题。
- 代码简洁，使用 Kruskal 实现，适合理解并查集操作。
- 明确前缀和异或与边权的关系。

**核心代码**（Kruskal 排序边）：
```cpp
sort(a+1, a+T+1);
rep(i,1,T) if (合并成功) ans += 边权;
```

#### 3. Vocalise（⭐⭐⭐⭐）
**关键亮点**:
- 从异或前缀和角度严格推导，证明生成树的必要性。
- 代码使用朴素 Prim，无堆优化但适合完全图。

**核心代码**（朴素 Prim）：
```cpp
for (循环选点) {
    选未访问的最小距离点;
    更新其他点的距离;
}
```

---

### 最优思路总结
将每个区间 `[l, r]` 的查询视为连接 `l-1` 与 `r` 的边，构建 `n+1` 个节点的图。最小生成树保证所有必要信息连通，总边权即最小代价。关键技巧在于将信息推导转化为图的连通性。

---

### 拓展与举一反三
**类似题目**:
1. [P1265 公路修建](https://www.luogu.com.cn/problem/P1265)（最小生成树判断）
2. [P1546 最短网络](https://www.luogu.com.cn/problem/P1546)（Prim 模板）
3. [P1991 无线通讯网](https://www.luogu.com.cn/problem/P1991)（Kruskal 应用）

**心得摘录**:
> "样例模拟启示贪心选边，类似 Kruskal 过程" —— WanderOvO  
> "将自环转化为虚拟节点避免冗余" —— tommy0221  
> "异或前缀和的推导是突破点" —— Vocalise

---
处理用时：43.75秒
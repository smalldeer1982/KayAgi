# 题目信息

# [EER1] 代价

## 题目背景

> 个人的遭遇，命运的多舛都使我被迫成熟，这一切的代价都当是日后活下去的力量。
——  三毛

小 Z 喜欢玩数字游戏。

## 题目描述

给出一个长度为 $n+2$ 的序列 $a_i$，其中第 $1$ 个数和第 $n+2$ 个数固定为 $1$。你每次可以选择序列中间的一个数删除（不能是第一个和最后一个），删除位置 $p$ 上的数的代价为 $a_{p-1} \times a_p \times a_{p+1}$。你需要执行这个操作直到无法操作为止。求最小的代价和。

## 说明/提示

样例一解释：

先删除 $3$，代价为 $6$，再删除 $2$，代价为 $2$，再删除 $1$，代价为 $1$。

总代价为 $6+2+1=9$。

---

**本题采用捆绑测试。**

对于 $100\%$ 的测试点：$1 \leq n \leq 10^6$，$1 \leq a_i \leq 10^4$。

本题共 $6$ 个子任务，各子任务的分值及约定如下：

子任务 $1$（$1$ 分）：$a_i = 1$。

子任务 $2$（$14$ 分）：$1 \leq n \leq 10$。

子任务 $3$（$5$ 分）：$1 \leq a_i \leq 2$。

子任务 $4$（$14$ 分）：$1 \leq n \leq 40$。

子任务 $5$（$26$ 分）：$1 \leq n \leq 500$。

子任务 $6$（$40$ 分）：无特殊限制。

#### 特别感谢

idea：smrsky

solu：CYJian

data：iostream

## 样例 #1

### 输入

```
3
1 2 3```

### 输出

```
9
```

## 样例 #2

### 输入

```
4
19 26 8 17```

### 输出

```
846```

## 样例 #3

### 输入

```
6
1 1 1 1 1 1```

### 输出

```
6```

# AI分析结果



**算法分类**：贪心

---

### 题解分析与结论
所有题解均基于**贪心策略**，核心思路为：  
1. **以1为分界点分割序列**，每个非1段独立处理  
2. 每段**从两端向中间删除**，每次删除较大端点以最小化乘积  
3. **最后删除段内最小值**，并将其单独计入答案  
4. **所有1的代价单独计算**（每个1贡献1次）

---

### 精选题解与评分
1. **xht（★★★★★）**  
   **关键亮点**：  
   - 严格数学推导相邻元素必须相乘的条件  
   - 提出「分段处理+最小值优化」的完整模型  
   **核心代码**：  
   ```cpp
   for (int i = 0, j = 1; i <= n; i = j, j = i + 1) {
       while (j <= n && a[j] != 1) ++j; // 找到下一个1的位置
       ++ans; // 统计1的代价
       if (i + 1 != j) ans += *min_element(a + i + 1, a + j); // 段内最小值
       for (int k = i + 1; k < j - 1; k++) // 累加相邻乘积
           ans += a[k] * a[k+1];
   }
   ```

2. **WYXkk（★★★★）**  
   **关键亮点**：  
   - 通过暴力找规律发现「两段式删除顺序」  
   - 提出预处理前缀和与后缀和的优化计算  
   **核心思想**：  
   ```cpp
   void solve(int l, int r) {
       while (l < r) { // 从两端交替删除
           if (a[l] > a[r]) ans += a[l] * a[l+1], l++;
           else ans += a[r] * a[r-1], r--;
       }
       ans += a[l]; // 最后剩余最小值
   }
   ```

3. **George1123（★★★★）**  
   **关键亮点**：  
   - 双向链表模拟删除过程验证贪心策略  
   - 提出「1的相邻段独立最优性」的直观证明  
   **个人心得**：  
   > 考场上我没做出来，自闭了。但通过暴力找规律发现删除顺序的规律，真是找规律t x d y  

---

### 关键思路总结
1. **分段处理**：将序列按1分割为多个独立段，每段内无1  
2. **双向贪心**：每段从两端向中间删除，优先删除较大端点  
3. **最小值优化**：段内最小值最后单独删除以最小化最终代价  

---

### 拓展与同类题目
1. **能量项链**（P1063）：区间合并的动态规划问题  
2. **关路灯**（P1220）：贪心策略处理时间窗口  
3. **铺设道路**（P5019）：差分思想与贪心结合

---
处理用时：42.20秒
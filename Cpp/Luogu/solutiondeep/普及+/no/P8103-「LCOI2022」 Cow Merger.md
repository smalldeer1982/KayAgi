# 题目信息

# 「LCOI2022」 Cow Merger

## 题目背景

Bessie 来到她的新家之后，Farmer John 突然意识到自己农场的大小不够了！

所以，Farmer John 需要把所有的奶牛合并到一个牛棚里。

## 题目描述

Farmer John 的农场里本来有 $n$ 个牛棚，第 $i$ 个牛棚里住着 $a_i$ 只牛。

我们定义一次合并 $i,j(a_i\ge a_j)$ 两个牛棚的操作为：从 $i$ 号牛棚中拿出 $a_j$ 头牛，放入 $j$ 号牛棚中。如果在合并结束后 $a_i=0$，那么可以看做 $a_i$ 被合并了，接下来的操作也与 $a_i$ 无关。

由于时间不够了，他决定最多你 $1$ 秒的时间。

## 说明/提示

【数据范围与约定】

对于 $100\%$ 的数据，$1 \leq T \leq 5$，$1 \leq n \leq  10^5$，$0 \leq a_i \leq 10^9$。

## 样例 #1

### 输入

```
3
4
1 2 3 2
5
3 9 6 18 12
5
2 3 5 7 11```

### 输出

```
YES
4
3 1
1 2
3 4
2 4
YES
6
2 1
1 2
4 3
2 3
4 5
3 5
NO```

# AI分析结果

### 算法分类
**数学**

### 综合分析与结论
题目要求将所有牛棚中的牛合并到一个牛棚中，且每次合并操作需要满足特定条件。题解的核心思路是通过数学方法判断是否可以将所有牛合并，并构造出具体的合并方案。主要难点在于如何判断是否可以将所有牛合并，以及如何构造具体的合并操作序列。

### 所选题解

#### 1. 作者：猫猬兽 (赞：4)
- **星级**: 4星
- **关键亮点**: 
  - 通过最大公约数和2的幂次判断可行性，思路清晰。
  - 构造方案时，通过两两配对奇数并将其转化为偶数，逐步将所有数合并为1。
  - 代码结构清晰，逻辑严谨。
- **个人心得**: 无

**核心代码片段**:
```cpp
while(1)
{
    b=0;c=0;d=0;
    for(i=1;i<=n;i=i+1)
    {
        if(a[i]%2==1)
        {
            c=c+1;
            if(c==2)
            {
                m=m+1;c=0;
                if(a[i]>a[d]){l[m]=i;r[m]=d;a[i]=a[i]-a[d];a[d]=a[d]*2;}
                else {l[m]=d;r[m]=i;a[d]=a[d]-a[i];a[i]=a[i]*2;}
            }
            else d=i;
        }
    }
    if(c==1)break;
    for(i=1;i<=n;i=i+1)b=__gcd(b,a[i]);
    for(i=1;i<=n;i=i+1)a[i]=a[i]/b;
}
```

#### 2. 作者：little_cindy (赞：1)
- **星级**: 3星
- **关键亮点**: 
  - 通过分解2的幂次来判断可行性，思路与猫猬兽类似。
  - 构造方案时，通过记录奇数的下标并进行配对操作，逐步将所有数合并为1。
  - 代码实现较为简洁，但可读性稍差。
- **个人心得**: 无

**核心代码片段**:
```cpp
while(sigma!=1){
    ll last=0;
    for(ll i=1;i<=n;i++){
        if(a[i]%2==1){
            if(last==0){
                last=i;
            }
            else{
                ll x=last,y=i;
                if(a[x]<a[y]){
                    ll t=x;
                    x=y;
                    y=t;
                }
                tot++;
                ansx[tot]=x;
                ansy[tot]=y;
                a[x]-=a[y];
                a[y]*=2;
                last=0;
            }
        }
    }
    for(ll i=1;i<=n;i++){
        a[i]/=2;
    }
    sigma=0;
    for(ll i=1;i<=n;i++){
        sigma+=a[i];
    }
}
```

### 最优关键思路或技巧
1. **可行性判断**: 通过最大公约数和2的幂次判断是否可以将所有牛合并。
2. **构造方案**: 通过两两配对奇数并将其转化为偶数，逐步将所有数合并为1。

### 可拓展之处
类似的问题可以通过数学方法判断可行性，并通过逐步操作构造出具体的解决方案。例如，在资源分配、任务调度等问题中，可以通过类似的思路进行判断和构造。

### 推荐题目
1. [P1226 【模板】快速幂](https://www.luogu.com.cn/problem/P1226)
2. [P1886 滑动窗口](https://www.luogu.com.cn/problem/P1886)
3. [P3383 【模板】线性筛素数](https://www.luogu.com.cn/problem/P3383)

### 通用建议与扩展思路
对于类似的问题，可以通过数学方法判断可行性，并通过逐步操作构造出具体的解决方案。在实现时，注意代码的可读性和逻辑的严谨性，确保每一步操作都正确无误。

---
处理用时：23.60秒
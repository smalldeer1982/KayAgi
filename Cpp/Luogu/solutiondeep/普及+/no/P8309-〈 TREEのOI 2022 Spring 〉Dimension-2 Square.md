# 题目信息

# 〈 TREEのOI 2022 Spring 〉Dimension-2 Square

## 题目背景

# 本题可能轻微卡精度，建议改用 $\tt long\ double$


正月十五夜空中。

一行人望着一棵树，一棵飘在天上的树，期待着它变成一个环。

这棵树有 $4$ 个节点。  

“它变成环了！”有人大喊。  
我顿时向天上望去……  

多么标准的正方形啊！无论哪个天文学家过来测量，它的角都是标准的 $90^{\circ}$，它的边都是完美的 $1:1:1:1$……  

只见那棵树，不，那标致而又完美的环，缓缓飞过，恰巧嵌在了那轮明月中心……

![](https://cdn.pixabay.com/photo/2016/11/29/13/14/full-moon-1869760_960_720.jpg)

## 题目描述

给定平面直角坐标系上 $4$ 个点的坐标。

你需要使用 ~~%法~~ 魔法，做一个正方形，使得这 $4$ 个点分别在正方形每条边的**直线**上。

## 说明/提示

**本题采用 $\tt SPJ$。**

如答案不唯一，输出一种即可。   
四边长度的之差 $\le 10^{-2}$ 且相邻两边夹角在 $\frac{\pi}{2}\pm10^{-2}$ 内且设给定的点为 $(p,q)$，则存在一点 $(p,q+k)\ (|k|\leq1)$ 在对应边所在直线上即可 $\tt \green {AC}$。

对于 $30\%$ 的数据，$T=1,|x_i|,|y_i|\le10^3$。

对于 $70\%$ 的数据，$1\leq T\leq 5\times 10^4,|x_i|,|y_i|\le10^6$。

对于 $100\%$ 的数据，$1\leq T\leq 5\times 10^5,|x_i|,|y_i|\le10^9$。

数据保证任意两点连成的 $6$ 直线两两之间互不垂直，且没有平行于轴的直线，任意三点不共线。保证不存在一组解的边与轴平行。保证有解。

**为了数据的精确性，您输出时至少需要保留 $8$ 位小数。**

## 样例 #1

### 输入

```
1
235 423
544 345
563 645
453 435```

### 输出

```
380.43769007 531.90429895
395.56394564 543.23089701
406.89054360 528.10464158
391.76428803 516.77804352```

# AI分析结果

### 算法分类
构造

### 综合分析与结论
本题的核心是通过给定的四个点构造一个正方形，使得这四个点分别位于正方形的四条边所在的直线上。题解主要集中在通过解析几何的方法求解正方形的顶点坐标。以下是各题解的要点和难点对比：

1. **tegethim** 的题解通过求解四条直线的解析式，并利用斜率关系推导出正方形的顶点坐标。该方法思路清晰，但推导过程较为复杂，适合对解析几何有较好理解的同学。
2. **Ginger_he** 的题解通过几何构造的方法，利用垂直和平行关系推导出正方形的顶点坐标。该方法较为直观，但需要较强的几何直觉。
3. **enucai** 的题解通过设定斜率并利用正方形的性质求解顶点坐标，代码实现简洁，适合快速实现。
4. **TernaryTree** 的题解通过几何构造和计算几何的方法求解正方形的顶点坐标，代码实现较为复杂，但思路清晰。

### 所选高星题解
1. **tegethim** (4星)
   - **关键亮点**：通过解析几何的方法推导出正方形的顶点坐标，思路清晰，推导过程详细。
   - **个人心得**：作者提到一开始没有注意到“分别”出现在正方形的四边所在直线上，导致分类讨论了很久，提醒我们在解题时要仔细审题。

2. **enucai** (4星)
   - **关键亮点**：通过设定斜率并利用正方形的性质求解顶点坐标，代码实现简洁，适合快速实现。
   - **核心代码**：
     ```cpp
     db k=(y1-x2-y3+x4)/(x1+y2-x3-y4);
     printf("%.8Lf %.8Lf\n",(k*k*x1-k*y1+k*y4+x4)/(k*k+1),(k*k*y4-k*x1+k*x4+y1)/(k*k+1));
     printf("%.8Lf %.8Lf\n",(k*k*x1-k*y1+k*y2+x2)/(k*k+1),(k*k*y2-k*x1+k*x2+y1)/(k*k+1));
     printf("%.8Lf %.8Lf\n",(k*k*x3-k*y3+k*y2+x2)/(k*k+1),(k*k*y2-k*x3+k*x2+y3)/(k*k+1));
     printf("%.8Lf %.8Lf\n",(k*k*x3-k*y3+k*y4+x4)/(k*k+1),(k*k*y4-k*x3+k*x4+y3)/(k*k+1));
     ```

3. **TernaryTree** (4星)
   - **关键亮点**：通过几何构造和计算几何的方法求解正方形的顶点坐标，思路清晰，代码实现较为复杂。
   - **核心代码**：
     ```cpp
     double k1=(z2-m2)/(z1-m1),k2=-1./k1;
     double b1=x2-x1*k1,b2=y2-y1*k2,b3=z2-z1*k1,b4=l2-l1*k2;
     double A1=-(b4-b1)/(k2-k1),A2=k1*A1+b1;
     double B1=-(b2-b1)/(k2-k1),B2=k1*B1+b1;
     double C1=-(b2-b3)/(k2-k1),C2=k1*C1+b3;
     double D1=-(b4-b3)/(k2-k1),D2=k1*D1+b3;
     ```

### 最优关键思路或技巧
通过解析几何的方法，利用斜率关系和正方形的性质求解顶点坐标。这种方法不仅适用于本题，还可以推广到其他类似的几何构造问题中。

### 可拓展之处
类似的问题可以通过解析几何的方法求解，如构造矩形、菱形等。此外，几何构造和计算几何的方法在解决复杂几何问题时也非常有用。

### 推荐题目
1. [P1357 矩形](https://www.luogu.com.cn/problem/P1357)
2. [P1358 菱形](https://www.luogu.com.cn/problem/P1358)
3. [P1359 正方形](https://www.luogu.com.cn/problem/P1359)

---
处理用时：22.27秒
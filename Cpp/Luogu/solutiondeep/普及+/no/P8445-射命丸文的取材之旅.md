# 题目信息

# 射命丸文的取材之旅

## 题目背景

射命丸文（Syameimaru Aya）是一只鸦天狗。她不定期制作名为「文文。新闻」的报纸，而为此，她需要对她收集到的新闻进行剪裁。

## 题目描述

射命丸文现在收集到了 $2n$ 条新闻。她想要将其刊登于自己的报刊之上。然而，自己的报刊最多只能刊登 $n$ 条新闻。

为了能在 $n$ 条新闻的篇幅中让自己的报刊得到最大的吸引力，她将这 $2n$ 条新闻**等分**成**两份**，即每一份中均有 $n$ 条新闻。

每一条新闻自然有着其吸引力。在**第一份**中，第 $i$ 条新闻有着吸引力 $a_i$，而在**第二份**中，第 $i$ 条新闻有着吸引力 $b_i$。这两份新闻的划分在输入时已经给定。

现在射命丸文要从中选取新闻放入自己的报刊。报刊上的第 $i$ 条新闻，将选择**第一份**新闻的第 $i$ 条或**第二份**新闻的第 $i$ 条。这样，报刊上的新闻就可以构成一个长度为 $n$ 的序列，第 $i$ 项也就是第 $i$ 条新闻有着吸引力 $c_i \in \{a_i,b_i\}$。

而这样的一份报刊有着其综合影响力。根据射命丸文的经验，对于她这样的一份含有 $n$ 条新闻的报刊，其综合影响力为：

$$\max\{r-l+1-\operatorname{mex}\{c_l,c_{l+1},\dots, c_{r-1},c_r\}\}(1\le l\le r\le n)$$

其中 $\operatorname{mex}\{c_l,c_{l+1},\dots,c_{r-1},c_r\}$ 指的是 $c_l,c_{l+1},\dots,c_{r-1},c_r$ 中没有出现过的**最小非负整数**。

现在她希望知道，在进行这些操作之后，自己的报刊的**最大**的综合影响力会是多少呢？由于她还要继续取材，因此她把这个任务交付给了你。

【形式化题意】

给定序列 $\{a_n\},\{b_n\}$，求一个序列 $\{c_n\}$ 满足 $\forall i\in[1,n],c_i\in\{a_i,b_i\}$，最大化

$$\max\{r-l+1-\operatorname{mex}\{c_l,c_{l+1},\dots, c_{r-1},c_r\}\}(1\le l\le r\le n)$$

并输出该式子可能的最大值。

## 说明/提示

**【样例解释和说明】**

射命丸文可以让自己的 $5$ 条新闻分别取第二份的第 $1$ 条，第一份的第 $2$ 条，第一份的第 $3$ 条，第一份的第 $4$ 条和第二份的第 $5$ 条。这样一来，她的报刊每条新闻的吸引力 $c_i$ 分别为 $0,1,0,1,0$。令 $l=1,r=5$，则 $\operatorname{mex}\{c_1,c_2,c_3,c_4,c_5\}=2$，$r-l+1-\operatorname{mex}\{c_1,c_2,c_3,c_4,c_5\}=3$，不难证明其为数列 $c$ 的综合影响力，也是**所有的可能的** $c$ 的最大综合影响力。

**【数据范围】**

对于 $20\%$ 的数据，满足 $1 \leq n\leq 10$。

另外 $40\%$ 的数据满足 $a_i=b_i$。

对于 $100\%$ 的数据，满足 $1 \leq n\le 10^6$，$0
\leq a_i,b_i\leq n$。

## 样例 #1

### 输入

```
5
0 1 0 1 2
0 2 0 1 0```

### 输出

```
3```

# AI分析结果

### 算法分类
枚举

### 综合分析与结论
本题的核心在于如何高效地计算最大综合影响力，而直接枚举所有可能的子区间和选择是不可行的。通过观察数据范围，发现 $a_i$ 和 $b_i$ 的值域为 $[0, n]$，这提示我们可以通过枚举 $\text{mex}$ 的值来优化计算。各题解均采用了这一思路，通过记录 $a_i = b_i$ 的位置（即“屏障”），将序列分割为若干子区间，然后计算每个 $\text{mex}$ 值对应的最大区间长度，最终取最大值。

### 所选高星题解

#### 1. 作者：retep (5星)
**关键亮点**：
- 思路清晰，详细解释了如何通过枚举 $\text{mex}$ 值来优化计算。
- 代码简洁，使用了 `vector` 来记录屏障位置，方便后续计算。
- 通过添加虚拟屏障（`n+1`）简化了边界处理。

**核心代码**：
```cpp
for(int i=0;i<=n;i++){
    pos[i].push_back(n+1); // 添加虚拟屏障
    for(int j=0,before=1;j<pos[i].size();j++){
        ans=max(ans,pos[i][j]-before-i);
        before=pos[i][j]+1;
    }
}
```
**实现思想**：通过记录 $a_i = b_i$ 的位置，将序列分割为若干子区间，计算每个 $\text{mex}$ 值对应的最大区间长度。

#### 2. 作者：cmk666 (4星)
**关键亮点**：
- 代码简洁，直接通过数组记录最大区间长度。
- 解释了如何处理 $\text{mex}$ 值与实际值不一致的问题，确保答案的正确性。

**核心代码**：
```cpp
For(i, 1, n) if ( a[i] == b[i] )             // 分割出一个块
    c[a[i]] = max(c[a[i]], i - l[a[i]]), l[a[i]] = i + 1;
For(i, 0, n) c[i] = max(c[i], n + 1 - l[i]); // 最后一个块
For(i, 0, n) ans = max(ans, c[i] - i);
```
**实现思想**：通过记录 $a_i = b_i$ 的位置，计算每个 $\text{mex}$ 值对应的最大区间长度，并取最大值。

### 最优关键思路
通过枚举 $\text{mex}$ 值，记录 $a_i = b_i$ 的位置（屏障），将序列分割为若干子区间，计算每个 $\text{mex}$ 值对应的最大区间长度，最终取最大值。这种方法避免了直接枚举所有子区间的高复杂度，利用值域限制实现了高效计算。

### 可拓展之处
类似的问题可以通过枚举关键值（如 $\text{mex}$）来优化计算，尤其是在值域有限的情况下。这种方法可以应用于其他需要计算区间性质的问题，如最大子段和、最小覆盖区间等。

### 推荐题目
1. [P1886 滑动窗口](https://www.luogu.com.cn/problem/P1886)
2. [P1440 求m区间内的最小值](https://www.luogu.com.cn/problem/P1440)
3. [P1631 序列合并](https://www.luogu.com.cn/problem/P1631)

### 个人心得摘录
- **retep**：通过添加虚拟屏障简化了边界处理，避免了复杂的边界条件判断。
- **cmk666**：解释了如何处理 $\text{mex}$ 值与实际值不一致的问题，确保答案的正确性。

---
处理用时：20.55秒
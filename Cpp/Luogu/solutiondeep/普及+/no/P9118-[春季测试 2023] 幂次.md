# 题目信息

# [春季测试 2023] 幂次

## 题目描述

小 Ω 在小学数学课上学到了“幂次”的概念：$\forall a, b \in \N^+$，定义 $a^b$ 为 $b$ 个 $a$ 相乘。

她很好奇有多少正整数可以被表示为上述 $a^b$ 的形式？由于所有正整数 $m \in N^+$ 总是可以被表示为 $m^1$ 的形式，因此她要求上述的表示中，必须有 $b \geq k$，其中 $k$ 是她事先选取好的一个正整数。

因此她想知道在 $1$ 到 $n$ 中，有多少正整数 $x$ 可以被表示为 $x = a^b$ 的形式，其中 $a, b$ 都是正整数，且 $b \geq k$？

## 说明/提示

**【样例 2 解释】**

以下是全部 $7$ 组符合题意的正整数及对应的一种合法的表示方法。

$1 = 1^3, 8 = 2^3, 16 = 2^4, 27 = 3^3, 32 = 2^5, 64 = 4^3, 81 = 3^4$

注意某些正整数可能有多种合法的表示方法，例如 $64$ 还可以表示为 $64 = 2^6$。

但根据题意，同一个数的不同的合法表示方法只会被计入一次。

**【样例 3 解释】**

以下是全部 $12$ 组符合题意的正整数及对应的一种合法的表示方法。

$1 = 1^2, 4 = 2^2, 8 = 2^3, 9 = 3^2, 16 = 4^2, 25 = 5^2, 27 = 3^3, 32 = 2^5, 36 = 6^2, 49 = 7^2, 64 = 8^2, 81 = 9^2$

**【样例 4】**

见选手目录下的 power/power4.in 与 power/power4.ans。

**【样例 5】**

见选手目录下的 power/power5.in 与 power/power5.ans。

**【样例 6】**

见选手目录下的 power/power6.in 与 power/power6.ans。


**【数据范围】**

对于所有数据，保证 $1 \leq n \leq 10^{18}$，$1 \leq k \leq 100$。

|测试点编号|$n \le$|$k$|
|:-:|:-:|:-:|
|1|$10^2$|$=1$|
|2|$10^2$|$\ge 2$|
|3|$10^4$|$\ge 3$|
|4|$10^4$|$\ge 2$|
|5|$10^6$|$\ge 3$|
|6|$10^6$|$\ge 2$|
|7|$10^8$|$\ge 3$|
|8|$10^8$|$\ge 2$|
|9|$10^{10}$|$\ge 3$|
|10|$10^{10}$|$\ge 2$|
|11|$10^{12}$|$\ge 3$|
|12|$10^{12}$|$\ge 2$|
|13|$10^{14}$|$\ge 3$|
|14|$10^{14}$|$\ge 2$|
|15|$10^{16}$|$\ge 3$|
|16|$10^{16}$|$\ge 2$|
|17|$10^{18}$|$\ge 3$|
|18|$10^{18}$|$\ge 2$|
|19|$10^{18}$|$\ge 2$|
|20|$10^{18}$|$\ge 2$|


## 样例 #1

### 输入

```
99 1```

### 输出

```
99```

## 样例 #2

### 输入

```
99 3```

### 输出

```
7```

## 样例 #3

### 输入

```
99 2```

### 输出

```
12```

# AI分析结果

### 算法分类
数学、枚举

### 综合分析与结论
该题目要求统计在1到n范围内，能够表示为a^b（b≥k）的正整数的个数。由于n的范围较大（1≤n≤10^18），直接枚举所有可能的a和b会超时。因此，大多数题解采用了数学方法结合枚举的策略，通过计算不同幂次下的底数范围，并结合去重机制来优化计算。

### 所选高星题解
1. **作者：Adchory**
   - **星级：5星**
   - **关键亮点：** 使用容斥原理，通过从大到小枚举幂次，避免了重复计算。代码简洁且高效，适合处理大规模数据。
   - **个人心得：** 作者提到通过容斥原理简化了问题，避免了复杂的去重逻辑，提升了代码的可读性和效率。
   - **核心代码：**
     ```cpp
     for(ll i=100;i>=k;i--){
         f[i]=pow<long double>(n,1.0/i)+eps-1;
         for(ll j=i<<1;j<=100;j+=i) f[i]-=f[j];
         ans+=f[i];
     }
     ```

2. **作者：jijidawang**
   - **星级：4星**
   - **关键亮点：** 利用容斥系数和平方自由数的性质，简化了计算过程，避免了重复统计。
   - **核心代码：**
     ```cpp
     f(n)=1-\sum_{i\ge 2}\mu(i)(\lfloor\sqrt[i]{n}\rfloor-1)
     ```

3. **作者：苏联小渣**
   - **星级：4星**
   - **关键亮点：** 通过分类讨论，分别处理k=1、k≥3和k=2的情况，特别是对于k=2的情况，采用了优化策略，避免了大规模枚举。
   - **核心代码：**
     ```cpp
     if(k == 2){
         ans = sqrtx(n, 2) + sqrtx(n, 3) - sqrtx(n, 6);
     }
     ```

### 最优关键思路或技巧
- **容斥原理：** 通过容斥原理避免重复计算，特别是在处理不同幂次下的底数范围时，能够有效减少计算量。
- **分类讨论：** 根据k的不同值，采用不同的策略，特别是对于k=2的情况，通过优化避免了大规模枚举。
- **数学优化：** 利用数学性质（如平方自由数）简化计算，提升算法效率。

### 可拓展之处
- **类似题目：** 可以拓展到其他需要统计特定形式数的题目，如统计满足某种数学性质的数的个数。
- **算法套路：** 容斥原理和分类讨论的策略在其他数学问题中也广泛应用，如组合数学、数论等。

### 推荐题目
1. [P1226 【模板】快速幂](https://www.luogu.com.cn/problem/P1226)
2. [P1045 麦森数](https://www.luogu.com.cn/problem/P1045)
3. [P1069 细胞分裂](https://www.luogu.com.cn/problem/P1069)

### 个人心得摘录
- **Adchory：** "通过容斥原理简化了问题，避免了复杂的去重逻辑，提升了代码的可读性和效率。"
- **苏联小渣：** "对于k=2的情况，通过优化避免了大规模枚举，使得算法能够在合理时间内完成计算。"

---
处理用时：25.69秒
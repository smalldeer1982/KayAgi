# 题目信息

# [POI 2021 ~2022R2] lic

## 题目背景

翻译自 [POI2021~2022R2 Day1T2](https://szkopul.edu.pl/problemset/problem/kQ5ExYNkFhx3K2FvVuXAAbn4/statement/)。

## 题目描述

定义 $a$ 的「不友好数」$b$ 为 $\gcd(a,b)=1$ 的数。

现在你知道了数字 $n$，你需要求出它的「不友好数」升序排序第 $k$ 个开始后的 $c$ 个数。

## 说明/提示

样例解释：

$10$ 的「不友好数」依次为 $1,3,7,9,11,13,17\ldots$。

子任务分配如下：

| 子任务编号 | 特殊性质 | 分值 |
| :----------- | :----------- | :----------- |
| $1$ | $n \leq 10^6$ 且 $M \leq n$ | $10$ |
| $2$ | $f(n) \leq 10^6$ 且 $M \leq n$ | $36$ |
| $3$ | $c \leq 100$ | $30$ |
| $4$ | 无特殊限制 | $24$ |

上述 $M$ 为输出的最大值，$f(n)$ 为 $\leq n$ 的「不友好数」数量。

## 样例 #1

### 输入

```
10 3 4```

### 输出

```
7 9 11 13```

# AI分析结果

### 算法分类
数学、二分、容斥原理

### 综合分析与结论
题目要求找到与给定数 $n$ 互质的第 $k$ 个数，并输出接下来的 $c$ 个数。核心难点在于如何高效地找到第 $k$ 个与 $n$ 互质的数。各题解均采用了二分查找结合容斥原理的方法来解决这一问题。容斥原理用于计算在某个范围内与 $n$ 不互质的数的个数，从而通过二分查找确定第 $k$ 个与 $n$ 互质的数。

### 所选高星题解

#### 1. 作者：bianshiyang (4星)
**关键亮点**：
- 详细解释了容斥原理的应用，并通过递归实现容斥计算。
- 提供了两种不同的输出方法，分别适用于稀疏和稠密分布的情况。
- 代码结构清晰，注释详细，易于理解。

**核心实现思想**：
- 使用二分查找确定第 $k$ 个与 $n$ 互质的数。
- 通过递归函数 `dfs` 实现容斥原理，计算与 $n$ 不互质的数的个数。
- 从第 $k$ 个数开始，逐个检查与 $n$ 的互质性，输出接下来的 $c$ 个数。

**核心代码片段**：
```cpp
int judge(int x) {
    int res = 0;
    for (int i = 1; i <= cnt; i++) {
        meici = 0;
        dfs(i, 0, 1, x);
        if (i & 1) res += meici;
        else res -= meici;
    }
    res = x - res;
    res -= k;
    return res;
}
```

#### 2. 作者：蒋辰逸 (4星)
**关键亮点**：
- 引入了欧拉函数的概念，进一步优化了计算过程。
- 通过二分查找结合容斥原理，高效地找到第 $k$ 个与 $n$ 互质的数。
- 代码实现简洁，逻辑清晰。

**核心实现思想**：
- 使用欧拉函数计算与 $n$ 互质的数的个数，确定二分查找的范围。
- 通过递归函数 `dfs` 实现容斥原理，计算与 $n$ 不互质的数的个数。
- 从第 $k$ 个数开始，逐个检查与 $n$ 的互质性，输出接下来的 $c$ 个数。

**核心代码片段**：
```cpp
bool check(int x, int ma) {
    int ret = 0;
    for (int i = 1; i <= cnt; i++) {
        int t = 0;
        dfs(i, 0, 1, x, t);
        if (i & 1) ret += t;
        else ret -= t;
    }
    ret = x - ret;
    return ret >= ma;
}
```

### 最优关键思路或技巧
- **二分查找**：通过二分查找确定第 $k$ 个与 $n$ 互质的数，极大地提高了查找效率。
- **容斥原理**：利用容斥原理计算与 $n$ 不互质的数的个数，避免了直接枚举的高时间复杂度。
- **欧拉函数**：引入欧拉函数进一步优化计算过程，减少不必要的计算。

### 可拓展之处
- 类似的问题可以通过二分查找结合容斥原理来解决，如查找第 $k$ 个满足某些特定条件的数。
- 容斥原理在组合数学和数论中有广泛应用，可以用于解决更多复杂的计数问题。

### 推荐题目
1. [P2303 [SDOI2012] Longge的问题](https://www.luogu.com.cn/problem/P2303)
2. [P2568 GCD](https://www.luogu.com.cn/problem/P2568)
3. [P1447 [NOI2010] 能量采集](https://www.luogu.com.cn/problem/P1447)

### 个人心得摘录
- **bianshiyang**：通过二分查找和容斥原理的结合，成功解决了问题，证明了这种方法的有效性。
- **蒋辰逸**：引入欧拉函数进一步优化了计算过程，减少了不必要的计算，提高了代码效率。
- **mango2011**：在调试过程中发现了一些细节问题，通过不断修改和优化，最终成功AC，强调了调试的重要性。

---
处理用时：22.62秒
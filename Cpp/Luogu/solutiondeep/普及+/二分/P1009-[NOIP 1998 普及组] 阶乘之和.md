# 题目信息

# [NOIP 1998 普及组] 阶乘之和

## 题目描述

用高精度计算出 $S = 1! + 2! + 3! + \cdots + n!$（$n \le 50$）。

其中 `!` 表示阶乘，定义为 $n!=n\times (n-1)\times (n-2)\times \cdots \times 1$。例如，$5! = 5 \times 4 \times 3 \times 2 \times 1=120$。

## 说明/提示

**【数据范围】**

对于 $100 \%$ 的数据，$1 \le n \le 50$。

**【其他说明】**

注，《深入浅出基础篇》中使用本题作为例题，但是其数据范围只有 $n \le 20$，使用书中的代码无法通过本题。

如果希望通过本题，请继续学习第八章高精度的知识。

NOIP1998 普及组 第二题

## 样例 #1

### 输入

```
3
```

### 输出

```
9```

# AI分析结果



### 综合分析与结论
本题需结合高精度乘法（计算阶乘）与高精度加法（累加和）。各题解核心思路均为逐位模拟竖式计算，差异主要体现在代码结构优化、存储方式、数学技巧等方面。以下精选3个高质量题解并总结关键技巧。

---

### 精选题解分析

#### 1. C_Z_C（★★★★☆）
**关键亮点**：  
- 分步实现高精乘与高精加，逻辑清晰  
- 使用独立数组存储阶乘结果与累加和，便于调试  
- 处理进位时采用双重循环，确保正确性  

**核心代码**：
```cpp
// 高精度乘法核心部分
for(int j=0;j<len_a;j++) 
    for(int k=0;k<=len_b;k++)
        c[j+k] += a[j]*b[k];
// 进位处理
for(int j=0;j<len_c;j++) 
    if(c[j]>9) c[j+1] += c[j]/10, c[j]%=10;
```

#### 2. wuhao1027（★★★★☆）
**关键亮点**：  
- 原地更新阶乘数组，节省内存  
- 合并阶乘计算与求和步骤，减少循环次数  
- 采用固定长度数组简化代码  

**核心代码**：
```cpp
// 计算i!并累加到总和
for (i=2;i<=n;i++){
    for (j=0;j<100;j++) B[j] *= i;  // 计算阶乘
    for (j=0;j<100;j++) {          // 处理进位
        B[j+1] += B[j]/10;
        B[j] %= 10;
    }
    for (j=0;j<100;j++) {          // 累加到结果
        A[j] += B[j];
        A[j+1] += A[j]/10;
        A[j] %= 10;
    }
}
```

#### 3. 二元长天笑（★★★★★）
**关键亮点**：  
- 通过运算符重载实现高精度类，代码高度结构化  
- 支持直观的数学表达式写法，可读性极佳  
- 完整实现四则运算，便于复用  

**关键实现**：
```cpp
struct BigInteger {
    vector<int> digits;
    
    BigInteger operator*(int x) { // 高精×低精
        BigInteger res;
        int carry = 0;
        for(int d : digits) {
            int val = d * x + carry;
            res.digits.push_back(val % 10);
            carry = val / 10;
        }
        while(carry) {
            res.digits.push_back(carry % 10);
            carry /= 10;
        }
        return res;
    }
};
```

---

### 关键技巧总结
1. **递推计算**：利用`n! = (n-1)! * n`的特性，避免重复计算
2. **倒序存储**：数字低位存储在数组前端，便于处理进位
3. **合并运算**：在计算阶乘时直接进行累加，减少中间存储
4. **批量进位**：先完成所有乘法运算后再统一处理进位，提升效率
5. **类封装**：通过运算符重载实现高精度运算的直观表达

---

### 拓展题目推荐
1. P1005 [矩阵取数游戏] - 高精度+动态规划  
2. P1303 [A*B Problem] - 基础高精度乘法  
3. P1255 [数楼梯] - 高精度递推应用  

---

### 调试经验摘录
- **进位边界**：多位网友强调进位处理时要检查最高位的额外进位（如`c[len_c]`的判断）
- **初始化陷阱**：必须初始化数组首元素为1（`b[0]=1`），否则阶乘计算全为0
- **输出处理**：结果数组需要反向输出，并注意去除前导零

---
处理用时：75.13秒
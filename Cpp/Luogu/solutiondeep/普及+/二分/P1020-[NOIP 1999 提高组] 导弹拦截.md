# 题目信息

# [NOIP 1999 提高组] 导弹拦截

## 题目描述

某国为了防御敌国的导弹袭击，发展出一种导弹拦截系统。但是这种导弹拦截系统有一个缺陷：虽然它的第一发炮弹能够到达任意的高度，但是以后每一发炮弹都不能高于前一发的高度。某天，雷达捕捉到敌国的导弹来袭。由于该系统还在试用阶段，所以只有一套系统，因此有可能不能拦截所有的导弹。

   
输入导弹依次飞来的高度，计算这套系统最多能拦截多少导弹，如果要拦截所有导弹最少要配备多少套这种导弹拦截系统。


## 说明/提示

对于前 $50\%$ 数据（NOIP 原题数据），满足导弹的个数不超过 $10^4$ 个。该部分数据总分共 $100$ 分。可使用$\mathcal O(n^2)$ 做法通过。  
对于后 $50\%$ 的数据，满足导弹的个数不超过 $10^5$ 个。该部分数据总分也为 $100$ 分。请使用 $\mathcal O(n\log n)$ 做法通过。

对于全部数据，满足导弹的高度为正整数，且不超过 $5\times 10^4$。


此外本题开启 spj，每点两问，按问给分。

NOIP1999 提高组 第一题

---

$\text{upd 2022.8.24}$：新增加一组 Hack 数据。

## 样例 #1

### 输入

```
389 207 155 300 299 170 158 65```

### 输出

```
6
2
```

# AI分析结果



### 综合分析与结论
本问题核心是通过最长不升子序列（第一问）和 Dilworth 定理（第二问）进行求解。各题解普遍采用贪心+二分的 O(n log n) 解法，关键技巧在于维护单调数组并利用二分查找优化。Dilworth 定理的理论推导与代码实现结合是本题核心考察点。

---

### 高星题解推荐（评分≥4★）

#### 1. 离散小波变换°（5★）
**核心亮点**  
- 图文并茂解析单调数组维护过程  
- 双问代码高度对称，可读性极佳  
- 引入Dilworth定理的代码视角证明  
**关键代码**  
```cpp
// 第一问：最长不升子序列
int l=0, r=t+1;
while(r-l>1){
    int m = l+(r-l)/2;
    if(F[m]>=H[i]) l=m; else r=m;
}
// 第二问：最长上升子序列（Dilworth定理）
int l=0, r=t+1;
while(r-l>1){
    int m = l+(r-l)/2;
    if(F[m]<H[i]) l=m; else r=m;
}
```
**个人心得**  
"观察第二问代码发现等价于求严格上升子序列，从代码角度验证了Dilworth定理"

#### 2. STA_Morlin（4.5★）
**核心亮点**  
- 用拓扑排序类比偏序关系  
- 提供Dilworth定理的归纳法证明  
- 强调二分查找中比较器的细节  
**关键实现**  
```cpp
// 贪心维护系统数组
if(h[r2]<a[i]) h[++r2]=a[i];
else *lower_bound(h+1,h+r2+1,a[i])=a[i];
```
**理论贡献**  
通过"每个系统末尾尽可能大"的贪心策略，直观解释了为何等价于最长上升子序列。

#### 3. Tofu（4★）
**核心亮点**  
- 构建导弹高度偏序集的哈斯图  
- 通过整除关系实例解析定理  
- 给出Dilworth定理的完整数学证明  
**独特视角**  
将导弹拦截问题建模为偏序集划分问题，为后续图论问题提供理论迁移思路。

---

### 关键技术总结
1. **单调数组维护**  
用`F[x]`记录长度为x的子序列最小结尾值，通过二分查找实现O(n log n)更新：
   - 不升序列用`upper_bound + greater<>()`
   - 上升序列用`lower_bound`

2. **Dilworth定理应用**  
最少链划分=最长反链长度 → 系统数=最长上升子序列长度

3. **代码对称性**  
两问只需修改比较符号和边界条件，保持相同二分框架

---

### 举一反三练习
1. [P1091 合唱队型](https://www.luogu.com.cn/problem/P1091)  
（双向LIS经典问题）

2. [P1439 最长公共子序列](https://www.luogu.com.cn/problem/P1439)  
（LIS优化在特殊序列中的应用）

3. [P2782 友好城市](https://www.luogu.com.cn/problem/P2782)  
（二维偏序问题，需自行构建单调关系）

---
处理用时：45.57秒
# 题目信息

# 通往奥格瑞玛的道路

## 题目背景

在艾泽拉斯大陆上有一位名叫歪嘴哦的神奇术士，他是部落的中坚力量。

有一天他醒来后发现自己居然到了联盟的主城暴风城。

在被众多联盟的士兵攻击后，他决定逃回自己的家乡奥格瑞玛。

## 题目描述

在艾泽拉斯，有 $n$ 个城市。编号为 $1,2,3,\ldots,n$。

城市之间有 $m$ 条双向的公路，连接着两个城市，从某个城市到另一个城市，会遭到联盟的攻击，进而损失一定的血量。

每次经过一个城市，都会被收取一定的过路费（包括起点和终点）。路上并没有收费站。

假设 $1$ 为暴风城，$n$ 为奥格瑞玛，而他的血量最多为 $b$，出发时他的血量是满的。如果他的血量降低至负数，则他就无法到达奥格瑞玛。

歪嘴哦不希望花很多钱，他想知道，在所有可以到达奥格瑞玛的道路中，对于每条道路所经过的城市收费的最大值，最小值为多少。

## 说明/提示

对于 $60\%$ 的数据，满足 $n\leq 200$，$m\leq 10^4$，$b\leq 200$；

对于 $100\%$ 的数据，满足 $1\leq n\leq 10^4$，$1\leq m\leq 5\times 10^4$，$1\leq b\leq 10^9$；

对于 $100\%$ 的数据，满足 $1\leq c_i\leq 10^9$，$0\leq f_i\leq 10^9$，可能有两条边连接着相同的城市。

## 样例 #1

### 输入

```
4 4 8
8
5
6
10
2 1 2
2 4 1
1 3 4
3 4 3
```

### 输出

```
10
```

# AI分析结果



### 综合分析与结论
本题核心为「最大值最小化」问题，需在满足血量约束下，找到路径中城市收费的最大值的最小值。主流解法为**二分答案+最短路**，通过二分枚举费用上限，结合最短路径验证可行性。关键难点在于正确建模二分条件与高效的最短路实现。

---

### 精选题解（评分≥4星）

#### 1. George1123 (⭐⭐⭐⭐⭐)
**亮点**：
- 预处理二分上下界（起点与终点必选，取max(f[1],f[n])为左边界）
- 使用堆优化Dijkstra，时间复杂度稳定
- 边界处理严谨，避免死循环
**核心代码**：
```cpp
void Dijkstra(int maxn){ //仅保留收费≤maxn的点
    for(int i=1;i<=n;i++) dis[i]=inf, vis[i]=0;
    priority_queue<node> q; //小根堆
    dis[1]=0; q.push({1,0});
    while(!q.empty()){
        int u = q.top().a; q.pop();
        if(vis[u]) continue;
        vis[u] = 1;
        for(int i=g[u];i;i=e[i].nex){
            int v = e[i].adj;
            if(f[v] > maxn) continue; //跳过超限点
            if(dis[v] > dis[u]+e[i].w){
                dis[v] = dis[u]+e[i].w;
                q.push({v, dis[v]});
            }
        }
    }
}
```

#### 2. shenbear (⭐⭐⭐⭐)
**亮点**：
- 强调Dijkstra的稳定性，避免SPFA被卡
- 代码简洁，变量命名清晰
**调试心得**：
> "发现没有负权，果断Dijkstra。SPFA虽然能过但不够稳定，竞赛中需谨慎选择。"

#### 3. Atlicd (⭐⭐⭐⭐)
**亮点**：
- 使用pair优化Dijkstra，代码简洁
- 在松弛时直接跳过超限点，逻辑清晰
**关键代码**：
```cpp
priority_queue<pair<int,int>> q; //默认大根堆，存负数模拟小根堆
if(f[v]<=mid && dis[v] > dis[u]+w) 
    q.push({-dis[v], v}); 
```

---

### 最优思路总结
1. **二分框架**：对城市收费排序后二分，缩小搜索范围。
2. **最短路验证**：每次检查仅保留收费≤mid的点，用Dijkstra求最短路。
3. **边界处理**：必须包含起点和终点，初始左边界取max(f[1],f[n])。
4. **数据类型**：血量计算需用long long防止溢出。

---

### 举一反三
- **同类型题**：限制路径中边权/点权的极值，如P1948（删边求最大边最小）、P2622（状态压缩+最短路）。
- **优化技巧**：预处理排序后的费用数组，避免重复排序；使用堆优化代替队列。

---

### 推荐习题
1. [P1948 Telephone Lines S](https://www.luogu.com.cn/problem/P1948)  
   （二分+最短路，删边求极值）
2. [P2622 关灯问题II](https://www.luogu.com.cn/problem/P2622)  
   （状态压缩+最短路，多条件约束）
3. [P4568 飞行路线](https://www.luogu.com.cn/problem/P4568)  
   （分层图最短路，多维状态处理）

---
处理用时：61.82秒
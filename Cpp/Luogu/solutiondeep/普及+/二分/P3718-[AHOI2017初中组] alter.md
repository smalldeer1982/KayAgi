# 题目信息

# [AHOI2017初中组] alter

## 题目描述

有 $n$ 盏灯排成一列，其中有些灯开着，有些灯关着。小可可希望灯是错落有致的，他定义一列灯的状态的不优美度为这些灯中最长的连续的开着或关着的灯的个数。小可可最多可以按开关 $k$ 次，每次操作可以使该盏灯的状态取反：原来开着的就关着，反之开着。现在给出这些灯的状态，求操作后最小的不优美度。

## 说明/提示

$30\%$ 的数据：$1\le k \le n\le20$；

$50\%$ 的数据：$1\le k \le n\le300$；

另有 $15\%$ 的数据：$1\le k \le n\le 10^5$，字符串为全 `N` 或全 `F`；

$100\%$ 的数据：$1\le k \le n\le 10^5$。

本题已经加入 hack 数据。

## 样例 #1

### 输入

```
8 1
NNNFFNNN```

### 输出

```
3```

# AI分析结果



### 综合分析与结论
本题核心是通过二分答案确定最小不优美度，关键在于如何高效验证给定长度的可行性。所有题解均围绕二分框架展开，核心差异体现在 `check` 函数的实现策略及特判处理。关键技巧包括：特判交替模式、连续段分割策略、贪心优化等。

### 高星题解推荐

#### 1. AK_Automata（★★★★☆）
**关键亮点**  
- 将输入预处理为连续段数组，简化后续计算。
- 独立处理 `mid=1` 的特殊情况，通过计算两种交替模式的最小操作次数。
- 使用数学公式 `a[i]/(mid+1)` 计算每段所需操作，逻辑清晰。

**核心代码**  
```cpp
bool check(int lim) {
    int res = 0;
    for (auto len : segments) // segments为预处理后的连续段长度数组
        if (len > lim) res += len / (lim + 1);
    return res <= k;
}
```

#### 2. 大眼仔Happy（★★★★☆）
**关键亮点**  
- 在 `check` 函数中引入动态修改策略，优先修改不影响后续的位置。
- 对 `mid=1` 时的两种交替模式进行精确计算，避免误判。

**个人心得**  
> "修改当前灯可能影响后续连续段，需判断后续字符状态来决定修改位置。例如当后续字符不同时，修改前一个灯以避免连锁反应。"

#### 3. MyukiyoMekya（★★★★☆）
**关键亮点**  
- 提出优化公式 `x = ⌈(len+1)/(lim+1)⌉ -1`，严格数学推导分割策略。
- 通过特判和二分分离逻辑，保证不同场景下验证的正确性。

**核心公式**  
```cpp
x = ceil((len + 1) / (lim + 1)) - 1; // 确保每个段不超过lim
```

---

### 关键思路与技巧总结
1. **二分框架**：确定答案范围后，通过 `check` 函数验证可行性。
2. **交替模式特判**：当目标不优美度为1时，仅需检查两种交替模式（`NFNF...`和`FNFN...`）。
3. **连续段分割**：对于长度超过 `mid` 的段，每 `mid+1` 个字符修改一次，操作次数为 `段长/(mid+1)`。
4. **贪心优化**：在动态修改时优先选择不影响后续连续性的位置，避免连锁反应。

---

### 相似题目推荐
1. [P2678 跳石头](https://www.luogu.com.cn/problem/P2678) - 二分答案+最小值最大化  
2. [P3853 [TJOI2007]路标设置](https://www.luogu.com.cn/problem/P3853) - 类似分割策略的二分验证  
3. [P1281 书的复制](https://www.luogu.com.cn/problem/P1281) - 最大值最小化问题，需设计合理分配策略  

---

### 调试经验与教训
1. **特判遗漏**：未处理 `mid=1` 时可能因交替模式导致验证错误（如样例 `7 1 FNNFNNF`）。
2. **贪心陷阱**：直接修改当前最长段中点可能影响后续段，需动态调整修改位置。
3. **公式推导**：严格证明分割次数公式（如 `len/(mid+1)`）的正确性，避免直觉误判。

---
处理用时：47.41秒
# 题目信息

# 「RdOI R2」称重(weigh)

## 题目背景

因为 rui_er 是一个良心出题人，所以本题是一道交互题。

## 题目描述

rui_er 为了准备体测，买了 $n$ 个实心球准备练习，但是却发现在发货时混入了两个质量明显较轻但外观相似的球（这两个球质量相等），且已知这两个球的质量之和大于一个正常的球。为了防止影响训练效果，现在需要找出这两个球。因为手动找太慢了，现在拿来了一个天平，可以在两侧各放上若干个球，得到两侧的质量大小关系。请你帮帮 rui_er，在使用不超过 $k$ 次天平的情况下，找出这两个较轻的球。

这里 $k$ 是每个测试点的属性，你不必也不应该读入。

---

**交互方式**

本题采用 I/O 交互。

你可以选择进行称量操作，此时向标准输出打印一行 `1 p a1 a2 ... ap q b1 b2 ... bq`，表示在天平左盘放入编号为 $a_1,a_2,\cdots,a_p$ 的 $p$ 个球，在天平右盘放入编号为 $b_1,b_2,\cdots,b_q$ 的 $q$ 个球。随后清空缓冲区，并从标准输入读入一个 `<>=` 之一的字符，表示左盘与右盘的质量关系。

对于每次此类询问，你需要保证 $1\le p,q\le n$，$p+q\le n$，所有 $a_i$ 和 $b_i$ 互不相同，且你最多进行此类询问 $k$ 次。

在得到答案后，向标准输出打印一行 `2 x y` 来提交答案，表示编号为 $x$ 的球和编号为 $y$ 的球质量偏轻。

你需要保证 $1\le x\lt y\le n$（注意需要严格按照从小到大顺序输出），且在进行完这一操作后立即终止程序。

交互库在一开始就已经确定小球的情况，不会随着你的询问而改变。

## 说明/提示

**样例解释**

三次询问的结果为 $a_1=a_2,a_3\lt a_4,a_5\gt a_6$，可以知道编号为 $3,6$ 的两个球质量偏轻。

---

**数据范围**

本题按点得分。

$20$ 个非 HACK 测试点中，第一个点 $4$ 分，其它点每点 $5$ 分；$4$ 个 HACK 测试点共 $1$ 分，任意一个测试点不通过则不得分。

|测试点|$n\le$|$k=$|特殊性质|测试点|$n\le$|$k=$|特殊性质|
|:-:|:-:|:-:|:-:|:-:|:-:|:-:|:-:|
|1|$5$|$50$|无|11|$500$|$50$|无|
|2|$10$|$50$|无|12|$500$|$50$|无|
|3|$100$|$50$|无|13|$500$|$20$|A|
|4|$100$|$50$|无|14|$500$|$20$|B|
|5|$500$|$50$|A|15|$500$|$20$|A|
|6|$500$|$50$|B|16|$500$|$20$|B|
|7|$500$|$50$|A|17|$500$|$20$|无|
|8|$500$|$50$|B|18|$500$|$20$|无|
|9|$500$|$50$|无|19|$500$|$20$|无|
|10|$500$|$50$|无|20|$500$|$20$|无|
|ex1|$500$|$12$|B/HACK|ex3|$500$|$13$|HACK|
|ex2|$500$|$13$|HACK|ex4|$500$|$14$|HACK|

- 特殊性质 A：$n=2^i-1,i\in\left\{4,5,6,7,8\right\}$。
- 特殊性质 B：$n=2^i,i\in\left\{4,5,6,7,8\right\}$。
- 备注：HACK 数据的 $k$ 根据测试点实际情况设置，会卡一些奇怪的做法，保证正解可过。

对于全部数据，$5\le n\le 500$，$k\in\left\{50,20,14,13,12\right\}$。

## 样例 #1

### 输入

```
6

=

<

>```

### 输出

```

1 1 1 1 2

1 1 3 1 4

1 1 5 1 6

2 3 6```

# AI分析结果



### 综合分析与结论
题目要求在 $n$ 个球中找出两个轻球，各题解核心思路均为分治策略，差异在于分组方式（二分/三分）和边界处理。最优解法需在询问次数下界 $\lceil \log_3 \frac{n(n-1)}{2} \rceil$ 内完成，关键在于通过分组策略快速缩小候选范围。三分法在单假球场景更优，而双假球需结合奇偶分组与递归逻辑。

---

### 精选题解与评分

#### 1. [rui_er] 官方题解（⭐️⭐️⭐️⭐️）
**核心亮点**：  
- 初始采用二分法，数据加强后优化为三分思想，单次排除2/3候选。  
- 分四类场景处理奇偶性与假球数量，逻辑清晰。  
- 代码结构简洁，递归边界明确。

**关键实现**：  
```cpp
void searchAns(int L, int R, int k) {
    int len = R-L+1, ML = L + (R-L)/3, MR = R - (R-L)/3;
    if (k == 1) { // 三分处理单假球
        compare(左1/3, 右1/3);
        if 相等则递归中间1/3，否则递归更轻侧；
    } else { // 双假球分奇偶处理
        if (len奇) 比较前半与后半，根据结果判断假球分布；
        else 均分两组，递归处理可能存在假球的区间；
    }
}
```

#### 2. [zhangxiao666] 三分分组法（⭐️⭐️⭐️⭐️⭐️）
**核心亮点**：  
- 明确分类奇偶情况，单双假球分别处理。  
- 利用「三组比较」快速缩小范围，代码可读性极强。  
- 递归边界处理干净，直接命中理论下界。

**个人心得**：  
> "假球一定在未比较的组或更轻组" —— 通过对称分组避免复杂推导，降低实现难度。

**关键实现**：  
```cpp
void find(int l, int r, int num) {
    if (num == 1) { // 单假球三分
        分三组，比较前两组，递归更轻或中间组；
    } else { // 双假球二分
        if (偶数组) 均分两组，比较后递归全假球或各一假球；
        else 分三组，结合单球验证处理边界；
    }
}
```

#### 3. [Flanksy] 分治策略结合（⭐️⭐️⭐️⭐️）
**核心亮点**：  
- 分治逻辑覆盖所有边界，特判小规模情况（3/4/5球）。  
- 通过两次比较确定三组关系，减少无效询问。  
- 代码模块化设计，交互部分独立封装。

**关键实现**：  
```cpp
void divII(auto x) { // 处理双假球
    if (x.size() <=5) 特判3/4/5球；
    else {
        均分三组+余组D，两次比较确定轻重；
        if 三组等重 → 递归D组；
        else 递归更轻组或结合余组；
    }
}
```

---

### 最优技巧总结
1. **三分法优化**：单假球时三等分，单次排除2/3候选，优于二分法的1/2。
2. **奇偶分组策略**：偶数直接二分，奇数拆分「两组+单球」，结合单球验证处理边界。
3. **状态合并**：双假球场景中，通过比较结果合并可能分布（如两组各一假球或同组两假球）。

---

### 拓展练习
1. [P1471 方差](https://www.luogu.com.cn/problem/P1471) - 分治计算区间统计量。  
2. [P1908 逆序对](https://www.luogu.com.cn/problem/P1908) - 分治归并思想的应用。  
3. [P7738 平衡树](https://www.luogu.com.cn/problem/P7738) - 交互式分治与状态压缩。  

---

### 核心代码摘录
**zhangxiao666 的双假球处理**：
```cpp
void find(int l, int r, int num) {
    if (num == 2) {
        int mid = (l + r) / 2;
        if ((r - l + 1) % 2 == 0) { // 偶数分组
            char op = ask(l, mid, mid+1, r);
            if (op == '=') { // 各一假球
                find(l, mid, 1);
                find(mid+1, r, 1);
            } else { // 全在轻侧
                find(op=='<' ? l : mid+1, op=='<' ? mid : r, 2);
            }
        } else { // 奇数分组
            char op = ask(l, mid-1, mid+1, r);
            if (op == '=') { // 各一假球
                find(l, mid-1, 1);
                find(mid+1, r, 1);
            } else {
                // 验证单球是否假球，调整递归范围
            }
        }
    }
}
```

---
处理用时：80.02秒
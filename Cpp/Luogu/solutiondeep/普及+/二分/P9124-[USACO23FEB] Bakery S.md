# 题目信息

# [USACO23FEB] Bakery S

## 题目描述

Bessie 开了一家面包店!

在她的面包店里，Bessie 有一个烤箱，可以在 $t_C$ 的时间内生产一块饼干或在 $t_M$ 单位时间内生产一块松糕。
$(1 \le t_C,t_M \le 10^9)$。由于空间限制，Bessie 一次只能生产一种糕点，所以要生产 $A$ 块饼干和 $B$ 块松饼，需要 $A\cdot t_C+B\cdot t_M$ 单位的时间。

Bessie的 $N (1\le N\le 100)$ 朋友都想一个一个地去面包店。第 $i$ 个朋友一进门就会点 $a_i(1 \le a_i \le 10^9)$ 块饼干和 $b_i(1 \le b_i \le 10^9)$ 块松饼。Bessie 没有空间来储存糕点，所以她只有在接到订单后才开始制作糕点。此外，Bessie 的朋友都很忙，所以第 $i$ 个朋友只愿意等 $c_i(a_i+b_i \le c_i \le 2 \cdot 10^{18})$ 个单位的时间，然后就伤心地离开。

Bessie 真的不希望她的朋友们伤心，她可以用一块钱升级她的烤箱，让它少花一个单位的时间来生产一块饼干或少花一个单位的时间来生产一个松饼。她不能将她的烤箱升级到花费小于等于 $0$ 的时间，但她可以选择在她的朋友到来之前将她的烤箱升级多少次，只要生产一块饼干和生产一个松饼所需的时间都严格保持为正数。

对于每一个 $T(1\le T\le 100)$ 的测试案例，请帮助 Bessie 找出她必须花费的最小的钱数量，以便她的面包店能够满足所有的朋友。

## 样例 #1

### 输入

```
2

3 7 9
4 3 18
2 4 19
1 1 6

5 7 3
5 9 45
5 2 31
6 4 28
4 1 8
5 2 22```

### 输出

```
11
6```

# AI分析结果

### 综合分析与结论

本题的核心是通过二分搜索来最小化升级烤箱的总成本，确保所有订单都能在规定时间内完成。大部分题解都采用了二分搜索的思路，通过将问题转化为对总升级次数的二分，再通过不等式约束来验证解的可行性。难点在于如何正确处理不等式的约束条件，尤其是当 $a_i - b_i$ 的不同取值时，$x$ 的上下界需要分别处理。

### 精选题解

#### 1. 作者：_Spectator_ (★★★★★)
- **关键亮点**：思路清晰，详细解释了如何通过二分总升级次数来解决问题，并给出了不等式的分类讨论，代码简洁且易于理解。
- **核心实现思想**：通过二分搜索总升级次数 $mid$，然后根据每个订单的不等式约束，逐步缩小 $x$ 的取值范围，最终判断是否有解。
- **代码片段**：
```cpp
bool ok(LL mid) {
    LL ma=min(tc-1,mid),mi=max(0,mid-tm+1);
    for(int i=1;i<=n;i++) {
        LL t=b[i]-a[i],k=c[i]-a[i]*tc-b[i]*tm+b[i]*mid;
        if(t==0&&k<0)return false;
        if(t>0)ma=min(ma,(LL)floor(k*1.0/t));
        if(t<0)mi=max(mi,(LL)ceil(k*1.0/t));
    }
    return ma>=mi;
}
```

#### 2. 作者：MiPloRAs_3316 (★★★★☆)
- **关键亮点**：详细推导了不等式的解法，并通过二分搜索来验证解的可行性，代码结构清晰，逻辑严密。
- **核心实现思想**：通过二分搜索总升级次数 $mid$，然后根据每个订单的不等式约束，逐步缩小 $x$ 的取值范围，最终判断是否有解。
- **代码片段**：
```cpp
bool check(long long x) {
    long long maxx=min(tc-1,x);
    long long minn=max(0LL,x-tM+1);
    for(int i=1; i<=n; i++) {
        long long k=c[i]-a[i]*tc-b[i]*tM+b[i]*x;
        if(b[i]-a[i]==0) { if(k<0) return false; }
        else if(b[i]-a[i]>0) maxx=min(maxx,(long long)floor(k*1.0/(b[i]-a[i])));
        else minn=max(minn,(long long)ceil(k*1.0/(b[i]-a[i])));
    }
    return maxx>=minn;
}
```

#### 3. 作者：_Cheems (★★★★☆)
- **关键亮点**：思路清晰，详细解释了如何通过二分总升级次数来解决问题，并给出了不等式的分类讨论，代码简洁且易于理解。
- **核心实现思想**：通过二分搜索总升级次数 $mid$，然后根据每个订单的不等式约束，逐步缩小 $x$ 的取值范围，最终判断是否有解。
- **代码片段**：
```cpp
bool dan() {
    long long mi,ma;
    ma=min(tic-1,mid);
    mi=max((long long)(0),mid-tim+1);  
    for(long long i=1; i<=n;i++) {
        long long k=c[i]-a[i]*tic-b[i]*tim+b[i]*mid;
        if(a[i]==b[i]&&k<0) return 0; 
        if(b[i]-a[i]>0) ma=min(ma,(long long)floor(k*1.0/(b[i]-a[i])));
        if(b[i]-a[i]<0) mi=max(mi,(long long)ceil(k*1.0/(b[i]-a[i]))); 
    }
    return mi<=ma;
}
```

### 最优关键思路与技巧

1. **二分搜索**：通过二分搜索总升级次数，将问题转化为验证某个总升级次数是否满足所有订单的约束条件。
2. **不等式处理**：根据 $a_i - b_i$ 的不同取值，分别处理 $x$ 的上下界，确保所有订单的约束条件都能被满足。
3. **边界条件**：在二分搜索中，合理设置初始边界条件，确保搜索范围的正确性。

### 可拓展之处

- **类似问题**：类似的问题可以出现在资源分配、时间调度等场景中，通常可以通过二分搜索和不等式约束来解决。
- **算法套路**：二分搜索结合不等式约束是一种常见的优化方法，适用于需要最小化或最大化某个值的问题。

### 推荐题目

1. [P3382 【模板】三分法](https://www.luogu.com.cn/problem/P3382)
2. [P1020 导弹拦截](https://www.luogu.com.cn/problem/P1020)
3. [P1880 [NOI1995]石子合并](https://www.luogu.com.cn/problem/P1880)

### 个人心得总结

- **调试经历**：在二分搜索中，边界条件的设置非常重要，稍有不慎就会导致搜索范围错误，从而无法得到正确的结果。
- **踩坑教训**：在处理不等式时，需要特别注意 $a_i - b_i$ 的不同取值，否则会导致上下界的计算错误。
- **顿悟感想**：通过二分搜索和不等式约束的结合，可以有效地解决一些复杂的优化问题，关键在于如何将问题转化为可验证的形式。

---
处理用时：40.33秒
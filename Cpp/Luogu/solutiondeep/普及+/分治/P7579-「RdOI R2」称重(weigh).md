# 题目信息

# 「RdOI R2」称重(weigh)

## 题目背景

因为 rui_er 是一个良心出题人，所以本题是一道交互题。

## 题目描述

rui_er 为了准备体测，买了 $n$ 个实心球准备练习，但是却发现在发货时混入了两个质量明显较轻但外观相似的球（这两个球质量相等），且已知这两个球的质量之和大于一个正常的球。为了防止影响训练效果，现在需要找出这两个球。因为手动找太慢了，现在拿来了一个天平，可以在两侧各放上若干个球，得到两侧的质量大小关系。请你帮帮 rui_er，在使用不超过 $k$ 次天平的情况下，找出这两个较轻的球。

这里 $k$ 是每个测试点的属性，你不必也不应该读入。

---

**交互方式**

本题采用 I/O 交互。

你可以选择进行称量操作，此时向标准输出打印一行 `1 p a1 a2 ... ap q b1 b2 ... bq`，表示在天平左盘放入编号为 $a_1,a_2,\cdots,a_p$ 的 $p$ 个球，在天平右盘放入编号为 $b_1,b_2,\cdots,b_q$ 的 $q$ 个球。随后清空缓冲区，并从标准输入读入一个 `<>=` 之一的字符，表示左盘与右盘的质量关系。

对于每次此类询问，你需要保证 $1\le p,q\le n$，$p+q\le n$，所有 $a_i$ 和 $b_i$ 互不相同，且你最多进行此类询问 $k$ 次。

在得到答案后，向标准输出打印一行 `2 x y` 来提交答案，表示编号为 $x$ 的球和编号为 $y$ 的球质量偏轻。

你需要保证 $1\le x\lt y\le n$（注意需要严格按照从小到大顺序输出），且在进行完这一操作后立即终止程序。

交互库在一开始就已经确定小球的情况，不会随着你的询问而改变。

## 说明/提示

**样例解释**

三次询问的结果为 $a_1=a_2,a_3\lt a_4,a_5\gt a_6$，可以知道编号为 $3,6$ 的两个球质量偏轻。

---

**数据范围**

本题按点得分。

$20$ 个非 HACK 测试点中，第一个点 $4$ 分，其它点每点 $5$ 分；$4$ 个 HACK 测试点共 $1$ 分，任意一个测试点不通过则不得分。

|测试点|$n\le$|$k=$|特殊性质|测试点|$n\le$|$k=$|特殊性质|
|:-:|:-:|:-:|:-:|:-:|:-:|:-:|:-:|
|1|$5$|$50$|无|11|$500$|$50$|无|
|2|$10$|$50$|无|12|$500$|$50$|无|
|3|$100$|$50$|无|13|$500$|$20$|A|
|4|$100$|$50$|无|14|$500$|$20$|B|
|5|$500$|$50$|A|15|$500$|$20$|A|
|6|$500$|$50$|B|16|$500$|$20$|B|
|7|$500$|$50$|A|17|$500$|$20$|无|
|8|$500$|$50$|B|18|$500$|$20$|无|
|9|$500$|$50$|无|19|$500$|$20$|无|
|10|$500$|$50$|无|20|$500$|$20$|无|
|ex1|$500$|$12$|B/HACK|ex3|$500$|$13$|HACK|
|ex2|$500$|$13$|HACK|ex4|$500$|$14$|HACK|

- 特殊性质 A：$n=2^i-1,i\in\left\{4,5,6,7,8\right\}$。
- 特殊性质 B：$n=2^i,i\in\left\{4,5,6,7,8\right\}$。
- 备注：HACK 数据的 $k$ 根据测试点实际情况设置，会卡一些奇怪的做法，保证正解可过。

对于全部数据，$5\le n\le 500$，$k\in\left\{50,20,14,13,12\right\}$。

## 样例 #1

### 输入

```
6

=

<

>```

### 输出

```

1 1 1 1 2

1 1 3 1 4

1 1 5 1 6

2 3 6```

# AI分析结果

### 综合分析与结论
这些题解主要围绕在 \(n\) 个球中通过天平找两个较轻球的问题，核心思路多基于分治策略，通过合理分组并依据天平称量结果缩小搜索范围。不同题解在分组方式、递归处理及优化方向上存在差异。
1. **思路**：多数题解先探讨在一堆球中找一个轻球的方法，再扩展到找两个轻球。找一个轻球时，常见策略是三分（将球尽量平均分成三份，比较其中两份，根据结果确定轻球所在组）；找两个轻球时，有二分（分成两份，按两份重量关系判断轻球分布）和三分等不同方式。
2. **算法要点**：关键在于根据球的总数是奇数还是偶数，以及当前要找轻球的个数（一个或两个）进行分类讨论。每次询问需保证天平两边球数合理，且通过交互获取天平称量结果来决定后续搜索方向。
3. **解决难点**：难点在于如何优化询问次数以逼近理论下限 \(f(n)=\left\lceil\log_3\left(\dfrac{n(n - 1)}{2}\right)\right\rceil\)。部分题解通过改进分组策略、建立决策树或打表等方式优化。

### 所选的题解
1. **作者：Grand_Dawn（5星）**
    - **关键亮点**：理论分析深入，指出 \(f(n)\) 为询问次数理论下限，并分析其他方法未达下限的原因。提出优化策略，每次询问尽可能将当前所有状态数进行三等分，通过复杂但精巧的分组和递归方式逼近下限。建立决策树并打表优化，在所有测试点中的最大询问次数为 \(11\) 次，表现优秀。
    - **个人心得**：无
    - **核心代码**：代码较长且复杂，核心在于通过多种复杂的分组和询问策略，尽可能三等分状态数，如：
```cpp
// 以下为示意代码，非完整可运行代码
// 交互函数
int interact(int *a, int p, int *b, int q) {
    // 输出询问并获取结果
}
// 搜索答案函数
void searchAns(int L, int R, int k) {
    // 根据球数和要找轻球数进行复杂的分组、询问和递归
}
```
2. **作者：rui_er（4星）**
    - **关键亮点**：作为官方题解，思路清晰，先对不同球数和要找轻球个数的情况进行分类讨论，提出初始的二分查找思路。后针对二分不足进行优化，采用三分思想，每次排除约 \(\dfrac{2}{3}\) 的球，提高查找效率。
    - **个人心得**：代码在数据加强后被卡，意识到需进一步优化，体现了算法优化的重要性。
    - **核心代码**：
```cpp
// 交互函数
int interact(int *a, int p, int *b, int q) {
    printf("1 %d ", p);
    rep(i, 1, p) printf("%d ", a[i]);
    printf("%d ", q);
    rep(i, 1, q) printf("%d%c", b[i], " \n"[i==q]);
    fflush(stdout);
    char tmp[2];
    scanf("%s", tmp);
    if(tmp[0] == '<') return -1;
    if(tmp[0] == '=') return 0;
    return 1;
}
// 搜索答案函数
void searchAns(int L, int R, int k) {
    int len = R - L + 1, M = (L + R) >> 1, tA = 0, tB = 0;
    int ML = L + (R - L) / 3, MR = R - (R - L) / 3;
    if(len == k) {
        if(k == 1) ans.push_back(L);
        else ans.push_back(L), ans.push_back(R);
        return;
    }
    // 多种情况分类讨论和递归
}
```
3. **作者：MarchKid_Joe（4星）**
    - **关键亮点**：提出二分与三分结合的思路，对于区间内含有两个劣质球采用二分，含有一个劣质球采用三分，一定程度简化了分类讨论的复杂度，同时给出较为详细的代码实现。
    - **个人心得**：写完二分被卡成99分，不想完全改成三分，从而想到二分与三分结合的方法，体现了灵活应对问题的思路。
    - **核心代码**：
```cpp
// 查询函数
char query(int l1, int r1, int l2, int r2) {
    putchar('1');
    printf(" %d", r1 - l1 + 1), fflush(stdout);
    for (int i = l1; i <= r1; i++) printf(" %d", i), fflush(stdout);
    printf(" %d", r2 - l2 + 1), fflush(stdout);
    for (int i = l2; i <= r2; i++) printf(" %d", i), fflush(stdout);
    putchar('\n'); char c; return cin >> c, c;
}
// 解决找两个轻球的函数
void solve2(int l, int r, int k) {
    if (!k) return void();
    if (l == r) return insert(l);
    int length = r - l + 1, mid = (l + r) >> 1, lmid, rmid;
    char x = query(l, lmid = ((length % 2 == 0)? (l + r - 1) >> 1 : mid - 1), rmid = ((length % 2 == 0)? (l + r + 1) >> 1 : mid + 1), r);
    // 根据二分结果进行不同处理
}
// 解决找一个轻球的函数
void solve3(int l, int r, int k) {
    if (!k) return void();
    int length = r - l + 1, size = length / 3, lmid = l + size - 1, rmid = lmid + size;
    if (length <= 2) return solve2(l, r, k);
    char x = query(l, lmid, lmid + 1, rmid);
    // 根据三分结果进行处理
}
```

### 最优关键思路或技巧
1. **三分思想**：在找一个轻球时，通过三分能每次排除约 \(\dfrac{2}{3}\) 的球，相比二分能更快缩小搜索范围，如 rui_er 的题解。
2. **状态三等分**：Grand_Dawn 的题解中，每次询问尽可能将当前所有状态数进行三等分，通过复杂的分组和询问策略，更高效地逼近理论下限。
3. **结合不同方法**：MarchKid_Joe 将二分与三分结合，针对不同轻球数量情况采用不同策略，简化分类讨论同时提高效率。

### 可拓展思路
此类题目属于通过比较操作寻找特定元素的问题，相似套路是根据问题特点合理分组，利用比较结果缩小搜索范围。类似题目可拓展到找多个不同重量球或在特定条件下找球的问题，关键在于设计合适的分组和比较策略。

### 相似知识点洛谷题目
1. **P1182 数列分段 Section II**：通过二分查找合适的分段界限，与本题通过不断缩小范围找球思路类似。
2. **P2678 [NOIP2015 提高组] 跳石头**：同样利用二分查找解决最优解问题，考察对搜索范围的控制和条件判断。
3. **P3853 [TJOI2007] 路标设置**：也是二分查找的应用，需要根据题目条件合理调整搜索范围，与本题分治思想相关。 

---
处理用时：41.11秒
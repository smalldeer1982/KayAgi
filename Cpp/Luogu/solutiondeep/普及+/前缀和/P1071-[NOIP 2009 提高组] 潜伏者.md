# 题目信息

# [NOIP 2009 提高组] 潜伏者

## 题目描述

R 国和 S 国正陷入战火之中，双方都互派间谍，潜入对方内部，伺机行动。历尽艰险后，潜伏于 S 国的 R 国间谍小 C 终于摸清了 S 国军用密码的编码规则：

1. S 国军方内部欲发送的原信息经过加密后在网络上发送，原信息的内容与加密后所得的内容均由大写字母 $\texttt{A}\sim\texttt{Z}$ 构成（无空格等其他字符）；
2. S 国对于每个字母规定了对应的密字。加密的过程就是将原信息中的所有字母替换为其对应的密字；
3. 每个字母只对应一个唯一的密字，不同的字母对应不同的密字。密字可以和原字母相同。

例如，若规定 $\tt A$ 的密字为 $\tt A$，$\tt B$ 的密字为 $\tt C$（其他字母及密字略），则原信息 $\tt ABA$ 被加密为 $\tt ACA$。

现在，小 C 通过内线掌握了 S 国网络上发送的一条加密信息及其对应的原信息。小 C 希望能通过这条信息，破译 S 国的军用密码。小 C 的破译过程是这样的：扫描原信息，对于原信息中的字母 $x$（代表任一大写字母），找到其在加密信息中的对应大写字母 $y$，并认为在密码里 $y$ 是 $x$ 的密字。如此进行下去直到停止于如下的某个状态：

1. 所有信息扫描完毕，$\texttt{A}\sim\texttt{Z}$ 所有 $26$ 个字母在原信息中均出现过并获得了相应的密字；
2. 所有信息扫描完毕，但发现存在某个（或某些）字母在原信息中没有出现；
3. 扫描中发现掌握的信息里有明显的自相矛盾或错误（违反 S 国密码的编码规则）。

例：

如某条信息 $\tt XYZ$ 被翻译为 $\tt ABA$ 就违反了“不同字母对应不同密字”的规则。

在小 C 忙得头昏脑涨之际，R 国司令部又发来电报，要求他翻译另外一条从 S 国刚刚截取到的加密信息。现在请你帮助小 C：通过内线掌握的信息，尝试破译密码。然后利用破译的密码，翻译电报中的加密信息。


## 说明/提示

【输入输出样例一说明】

原信息中的字母 $\tt A$ 和 $\tt B$ 对应相同的密字，输出 $\tt Failed$。

【输入输出样例二说明】

字母 $\tt Z$ 在原信息中没有出现，输出 $\tt Failed$。

NOIP2009 提高组第一题

## 样例 #1

### 输入

```
AA 
AB 
EOWIE

```

### 输出

```
Failed
```

## 样例 #2

### 输入

```
QWERTYUIOPLKJHGFDSAZXCVBN 
ABCDEFGHIJKLMNOPQRSTUVWXY 
DSLIEWO
```

### 输出

```
Failed 
```

## 样例 #3

### 输入

```
MSRTZCJKPFLQYVAWBINXUEDGHOOILSMIJFRCOPPQCEUNYDUMPP
YIZSDWAHLNOVFUCERKJXQMGTBPPKOIYKANZWPLLVWMQJFGQYLL
FLSO ```

### 输出

```
NOIP```

# AI分析结果

• 综合分析与结论：
    - 这些题解思路总体一致，均是先根据给定的加密信息和原信息构建密码本（映射关系），同时检查是否符合编码规则，如不同字母对应不同密字、所有字母都出现等，若不符合则输出“Failed”，若符合则依据密码本翻译新的加密信息。
    - 算法要点在于利用合适的数据结构记录映射关系，如map、数组等，并通过遍历字符串进行判断和处理。
    - 解决难点主要是对各种错误情况的判断，如一个密文对应多个原文、原文或密文长度不匹配、有字母未出现等。

    - 从质量上看，多数题解思路清晰，但部分代码可读性和优化程度有待提高。整体没有特别突出达到5星的题解，部分题解在思路清晰度和代码简洁性上表现较好，可评为4星。

所选的题解：
  - **作者：CYJian (赞：5)  4星**
    - **关键亮点**：代码简洁，利用宏定义简化判错操作，逻辑清晰，通过map记录映射关系，在遍历过程中同时完成判断和记录。
    - **重点代码**：
```cpp
map<char,char>mp,mq;
int main(){
    int la,lb,lc,book=26;
    char a[10005],b[10005],c[10005];
    scanf("%s%s%s",&a,&b,&c);
    la=strlen(a); lb=strlen(b); lc=strlen(c);
    if(la!=lb||la<26) ERROR
    for(int i=0;i<la;i++)
        if(mp[a[i]]==0&&mq[b[i]]==0)
            mp[a[i]]=b[i], mq[b[i]]=a[i], book--;
        else if(mp[a[i]]!=b[i]||mq[b[i]]!=a[i])
            ERROR
    if(book>0) ERROR
    for(int i=0;i<lc;i++) printf("%c",mp[c[i]]);
    printf("\n");
    return 0;
}
```
    - **核心实现思想**：用两个map分别记录加密后到加密前以及加密前到加密后的映射，遍历输入的加密信息和原信息，检查长度并记录映射关系，同时判断是否存在矛盾，最后根据映射关系翻译新的加密信息。

  - **作者：陈嘉逸2012 (赞：2)  4星**
    - **关键亮点**：思路清晰，采用两个map分别整理“密码本”和记录已出现字符，代码结构分明，按步骤遍历字符串完成判断和翻译。
    - **重点代码**：
```cpp
string a,b,c;
map<char,char>mp;map<char,bool>vis;
int main(){
    cin>>a>>b>>c;
    for(int i=0;i<a.size();i++){
        if(vis[b[i]]&&b[i]!=mp[a[i]]){cout<<"Failed\n";return 0;}
        mp[a[i]]=b[i],vis[b[i]]=1;
    }
    for(char i='A';i<='Z';i++){
        if(!vis[i]){cout<<"Failed\n";return 0;}
    }
    for(int i=0;i<c.size();i++) cout<<mp[c[i]];
}
```
    - **核心实现思想**：遍历加密信息和原信息，用mp记录映射关系，vis记录已出现的原文字符，判断是否存在矛盾和字母缺失，最后根据mp翻译新的加密信息。

  - **作者：qhr2023 (赞：2)  4星**
    - **关键亮点**：同样是简洁的模拟思路，利用数组实现映射和标记，代码简洁明了，逻辑直接。
    - **重点代码**：
```cpp
char a[105], b[105], c[105], mp[205], vis[205];
int main(){
    cin >> a >> b >> c;
    int la=strlen(a), lc=strlen(c);
    for (int i=0; i<la; mp[a[i]]=b[i], vis[b[i]]=1, i++) 
        if (vis[b[i]]&&b[i]!=mp[a[i]]) {
            puts("Failed");
            return 0;
        }
    for (int i='A'; i<='Z'; i++)
        if (!vis[i]) {
            puts("Failed");
            return 0;
        } 
    for (int i=0; i<lc; i++)
        cout << mp[c[i]];
    return 0;
}
```
    - **核心实现思想**：用数组mp记录密文到原文的映射，vis标记原文是否出现，遍历输入字符串判断是否合法，最后按映射翻译新的加密信息。

最优的关键思路或技巧：
    - **数据结构选择**：使用map或数组来记录字符的映射关系，map使用方便，能直接建立字符到字符的映射；数组则简单直观，通过字符的ASCII码值作为下标进行操作，在本题数据规模下效率都较高。
    - **错误判断方式**：在遍历构建映射关系的过程中，同时检查是否存在一个密文对应多个原文的情况，遍历结束后检查是否所有字母都出现，这样能全面判断密码本的合法性。

可拓展之处：
同类型题可涉及各种字符替换、密码破译类的模拟题，类似算法套路是先建立字符之间的映射关系，同时对映射关系进行合法性检查，最后根据映射关系处理新的输入。

推荐题目：
    - P1046 [NOIP2005 普及组] 陶陶摘苹果
    - P1055 [NOIP2008 普及组] ISBN 号码
    - P1085 [NOIP2005 普及组] 不高兴的津津

个人心得摘录与总结：
    - **作者：lianghuahua**：读题时误以为状态2是针对要破解的信息找不到原信息，后来发现是必须通过原文和密文破解全部26个字母。总结为读题要仔细，明确题目中各种条件的准确含义，避免因理解偏差导致错误。 

---
处理用时：37.08秒
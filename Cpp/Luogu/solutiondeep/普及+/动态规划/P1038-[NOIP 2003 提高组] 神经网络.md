# 题目信息

# [NOIP 2003 提高组] 神经网络

## 题目背景

人工神经网络（Artificial Neural Network）是一种新兴的具有自我学习能力的计算系统，在模式识别、函数逼近及贷款风险评估等诸多领域有广泛的应用。对神经网络的研究一直是当今的热门方向，兰兰同学在自学了一本神经网络的入门书籍后，提出了一个简化模型，他希望你能帮助他用程序检验这个神经网络模型的实用性。



## 题目描述

在兰兰的模型中，神经网络就是一张有向图，图中的节点称为神经元，而且两个神经元之间至多有一条边相连，下图是一个神经元的例子：

![](https://cdn.luogu.com.cn/upload/image_hosting/61qm40kj.png)

神经元（编号为 $i$）


图中，$X_1 \sim X_3$ 是信息输入渠道，$Y_1 \sim Y_2$ 是信息输出渠道，$C_i$ 表示神经元目前的状态，$U_i$ 是阈值，可视为神经元的一个内在参数。

神经元按一定的顺序排列，构成整个神经网络。在兰兰的模型之中，神经网络中的神经元分为几层；称为输入层、输出层，和若干个中间层。每层神经元只向下一层的神经元输出信息，只从上一层神经元接受信息。下图是一个简单的三层神经网络的例子。

![](https://cdn.luogu.com.cn/upload/image_hosting/4xd7f8yz.png)

兰兰规定，$C_i$ 服从公式：（其中 $n$ 是网络中所有神经元的数目）

$$C_i=\left(\sum\limits_{(j,i) \in E} W_{ji}C_{j}\right)-U_{i}$$

公式中的 $W_{ji}$（可能为负值）表示连接 $j$ 号神经元和 $i$ 号神经元的边的权值。当 $C_i$ 大于 $0$ 时，该神经元处于兴奋状态，否则就处于平静状态。当神经元处于兴奋状态时，下一秒它会向其他神经元传送信号，信号的强度为 $C_i$。

如此．在输入层神经元被激发之后，整个网络系统就在信息传输的推动下进行运作。现在，给定一个神经网络，及当前输入层神经元的状态（$C_i$），要求你的程序运算出最后网络输出层的状态。



## 说明/提示

**【题目来源】**

NOIP 2003 提高组第一题

## 样例 #1

### 输入

```
5 6
1 0
1 0
0 1
0 1
0 1
1 3 1
1 4 1
1 5 1
2 3 1
2 4 1
2 5 1
```

### 输出

```
3 1
4 1
5 1
```

# AI分析结果



### 综合分析与结论
本题核心是通过拓扑排序处理分层神经网络的状态传递，难点在于正确处理输入层阈值、信号激活条件及输出层筛选。优质题解普遍采用以下思路：
1. 预处理时将非输入层直接减去阈值
2. 拓扑排序保证计算顺序
3. 队列维护激活节点
4. 出度判断输出层

---

### 优质题解推荐

#### 1. Lucaster_（⭐⭐⭐⭐⭐）
**关键亮点**：
- 清晰的拓扑排序实现
- 使用邻接表存储边结构
- 预处理时处理阈值
- 输出层判断与排序处理
**核心代码**：
```cpp
while(!q.empty()) {
    h = q.front(); q.pop();
    for(i = hd[h]; i; i = e[i].next) { // 遍历邻接表
        if(c[e[i].from] <= 0) continue;
        t = e[i].to;
        c[t] += e[i].val * c[h];        // 状态传递
        if(!vis[t]) q.push(t);          // 入队未访问节点
    }
}
```

#### 2. zzlzk（⭐⭐⭐⭐）
**关键亮点**：
- 公式变形简化计算
- 拓扑排序的入度控制
- 输出层动态判断
**核心思路**：
```cpp
for(非输入层节点i)
    c[i] -= u[i]; // 预处理减阈值
while(拓扑队列非空){
    if(当前节点激活) 传递信号到子节点
}
```

#### 3. 奶油青豆烧鱼（⭐⭐⭐⭐）
**关键亮点**：
- 反向建图记忆化搜索
- 递归实现拓扑逻辑
- 极简代码结构
**核心片段**：
```cpp
int DFS(int p) {
    if(vis[p]) return c[p];
    for(前驱节点计算)
        c[p] += 前驱信号;
    return max(c[p], 0); // 负值不传递
}
```

---

### 关键技巧总结
1. **阈值预处理**：非输入层节点初始时直接减去阈值（`c[i] -= u[i]`）
2. **激活判断**：仅当`c[i]>0`时才向下游传递信号
3. **拓扑排序应用**：通过入度控制计算顺序，确保前驱节点先处理
4. **输出层筛选**：出度为0的节点即为输出层，需二次判断`c[i]>0`

---

### 同类题目推荐
1. **P1113 杂务** - 拓扑排序经典应用
2. **P4017 最大食物链计数** - 拓扑排序+路径统计
3. **P3183 食物链** - 拓扑排序与图论结合

---

### 调试经验摘录
> "输入层的U值不需要处理，但测试数据可能包含输入层同时是输出层的情况" —— 多组测试数据验证边界条件  
> "队列中需要维护访问状态，避免重复入队" —— `vis[]`数组防止重复计算  
> "输出要求升序排列，直接遍历比优先队列更高效" —— 输出前统一排序提升性能

---
处理用时：45.33秒
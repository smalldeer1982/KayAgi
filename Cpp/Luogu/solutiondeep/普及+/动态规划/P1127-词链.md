# 题目信息

# 词链

## 题目描述

如果单词 $X$ 的末字母与单词 $Y$ 的首字母相同，则 $X$ 与 $Y$ 可以相连成 $X.Y$。（注意：$X$、$Y$ 之间是英文的句号 `.`）。例如，单词 `dog` 与单词 `gopher`，则 `dog` 与 `gopher` 可以相连成 `dog.gopher`。

另外还有一些例子：
- `dog.gopher`
- `gopher.rat`
- `rat.tiger`
- `aloha.aloha`
- `arachnid.dog`

连接成的词可以与其他单词相连，组成更长的词链，例如：

`aloha.arachnid.dog.gopher.rat.tiger`

注意到，`.` 两边的字母一定是相同的。

现在给你一些单词，请你找到字典序最小的词链，使得每个单词在词链中出现且仅出现一次。注意，相同的单词若出现了 $k$ 次就需要输出 $k$ 次。

## 说明/提示

- 对于 $40\%$ 的数据，有 $n \leq 10$；
- 对于 $100\%$ 的数据，有 $n \leq 1000$。


## 样例 #1

### 输入

```
6
aloha
arachnid
dog
gopher
rat
tiger```

### 输出

```
aloha.arachnid.dog.gopher.rat.tiger```

# AI分析结果



### 综合分析与结论
本题核心是将单词连接问题转化为有向图欧拉路径问题。关键难点在于：①正确建模（单词为边，首尾字母为顶点）②处理字典序要求 ③判断欧拉路存在条件（连通性、出入度差）。最优解法需结合图论与贪心策略。

---

### 高分题解推荐

#### 1. loc_equinox（⭐⭐⭐⭐⭐）
**关键亮点**：  
- 创新性建模：将单词视为边，字母作为顶点，转化为欧拉路径问题  
- 严谨性检查：使用并查集验证连通性，详细处理出入度条件  
- 高效性优化：先排序保证字典序，再倒序插入边实现贪心选择  
**个人心得**：  
> "原先尝试以单词为顶点的DFS会超时，转换思路后发现欧拉路径模型完美契合题目特征"

**核心代码**：
```cpp
// 欧拉路径起点判定
for(int i=1;i<=26;i++) {
    if(out[i] == in[i]+1) Eular_start = i;
    else if(in[i] == out[i]+1) Eular_end = i;
}
// 字典序DFS实现
void dfs(int now) {
    for(auto& edge : sorted_edges[now]) {
        if(!vis[edge.id]) {
            vis[edge.id] = 1;
            dfs(edge.to);
            ans.push(edge.word);
        }
    }
}
```

#### 2. fls233666（⭐⭐⭐⭐）
**关键亮点**：  
- 极简实现：倒序建边保证字典序，线性时间完成路径搜索  
- 空间优化：使用链式前向星存储边，降低空间复杂度  
- 快速失败：预处理度差检查，减少无效搜索  

**核心代码**：
```cpp
void dfs(int g) {
    for(int i=lst[g];i;i=nxt[i]) {
        if(!use[bh[i]]) {
            use[bh[i]] = true;
            dfs(to[i]);
            ans.push_back(str[bh[i]]);
        }
    }
}
```

#### 3. chauchat（⭐⭐⭐）
**关键亮点**：  
- 清晰度优先：分离度统计与连通性检查模块  
- 实用技巧：使用Tarjan缩点预判拓扑序  
- 教学价值：详细注释帮助理解欧拉条件  

---

### 最优关键思路总结
1. **图论建模**：单词首尾字母→有向边，字母→顶点  
2. **欧拉条件**：  
   - 连通性（并查集/DFS验证）  
   - 出入度差：0或±1（起点/终点）  
3. **字典序保证**：  
   - 预处理单词排序  
   - 倒序建边实现贪心选择  
4. **高效DFS**：  
   - 回溯时维护访问标记  
   - 路径栈后进先出构造结果  

---

### 拓展建议
1. **同类题目**：  
   - [P1341 无序字母对](https://www.luogu.com.cn/problem/P1341)（无向图欧拉路径）  
   - [P2731骑马修栅栏](https://www.luogu.com.cn/problem/P2731)（字典序欧拉回路）  
   - [POJ2337 Catenyms](https://vjudge.net/problem/POJ-2337)（本题英文版）  

2. **优化方向**：  
   - Hierholzer算法实现O(E)时间复杂度  
   - 双端队列维护路径优化空间  

---

### 重点代码实现（loc_equinox核心）
```cpp
// 并查集检查连通性
if(set_count != 1) { // 多个连通块无解
    cout << "***";
    return 0;
}

// 构造欧拉路径
void dfs(int now) {
    while(!E[now].empty()) {
        auto edge = E[now].back();
        E[now].pop_back();
        dfs(edge.to);
        res.push_back(edge.word);
    }
}
// 逆序输出即为路径
reverse(res.begin(), res.end());
```

---
处理用时：53.87秒
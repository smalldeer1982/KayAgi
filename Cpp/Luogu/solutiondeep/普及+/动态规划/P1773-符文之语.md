# 题目信息

# 符文之语

## 题目背景

传说中珠穆朗玛峰下有座古代人修建的神庙，神庙的地下室里有古代王室的遗产，但数千年来从未有人到达过……探险者小 FF 一直梦想成为世界上最富有的人和最杰出的探险家并被永载史册。在证明了这个洞确实存在后，小 FF 做好了充足准备，来到了神庙。

## 题目描述

当小 FF 来到神庙时，神庙已经破败不堪了。但神庙的中央有一个光亮如新的石台。小 FF 走近石台，发现石台上有一个数串，而数串的上方刻着一串古老的符文之语。精通古符文之语的小 FF 不费吹灰之力就读懂了文章的意思，其大意是：

对于石台上的一串数字，你可以在适当的位置加入乘号（设加了 $k$ 个，当然也可不加，即分成 $k+1$ 个部分），设这 $k+1$ 个部分的乘积（如果 $k=0$，则乘积即为原数串的值）对 $m$ 的余数（即 $\bmod\ m$）为 $x$；

现求 $x$ 能达到的最小值及该情况下 $k$ 的最小值，以及 $x$ 能达到的最大值及该情况下的 $k$ 的最小值（可以存在 $x$ 的最小值与最大值相同的情况）。

小 FF 还知道，如果他找到了正确的答案，那么就可以通往神庙的下层了。但这个问题似乎不太好解决，小 FF 就找到了你，并答应找到财宝以后和你二八分（当然你拿二……）。

## 说明/提示

记 $L$ 表示字符串的长度。

- 对于 $30\%$ 的数据：$2 \le L \le 50$；
- 对于 $100\%$ 的数据：$2 \le L \le 1000$，$2 \le m \le 50$。

NOI 导刊 $2010$ 提高（$02$）

## 样例 #1

### 输入

```
4421

22

```

### 输出

```
0 1 21 0```

# AI分析结果



### 综合分析与结论
本题考察动态规划模型设计与模运算优化。所有题解均采用 **预处理区间模数+二维状态DP** 的核心思路，通过维护 `dp[i][x]` 表示前i位余数x的最少乘号数。核心难点在于正确建立状态转移方程，并通过预处理优化区间计算。各解法主要差异在状态转移方向（push/pull）和代码实现细节。

### 高星题解推荐
---

#### 1. 2018李泽明（★★★★★）
**关键亮点**  
- 清晰的前后双循环预处理逻辑  
- 使用逆向预处理减少计算量  
- 状态转移方程简洁高效  
**代码核心**  
```cpp
for(int i=lon;i>=1;i--) 
    for(int j=i+1;j<=lon;j++)
        sum[i][j] = (sum[i][j-1]*10%m + sum[j][j])%m; // 预处理模数
for(int j=1;j<i;j++)
    if(f[j][k]+1 < f[i][k*sum[j+1][i]%m])
        f[i][k*sum[j+1][i]%m] = f[j][k]+1; // 状态转移
```
**心得引用**  
> "方程不规范，爆零两行泪" —— 强调状态转移正确性的重要性

---

#### 2. asdfghjkl123（★★★★☆）
**关键亮点**  
- 详细注释帮助理解模运算特性  
- 显式INF定义提升代码可读性  
- 完整变量命名规范  
**核心实现**  
```cpp
for(int i=1;i<=n;i++) 
    for(int j=0;j<mod;j++)
        dp[i][j] = INF; // 明确初始化
for(int j=1;j<i;j++)
    dp[i][(k*M[j+1][i])%mod] = min(...); // 标准转移
```

---

#### 3. Mine_King（★★★★☆）
**关键亮点**  
- 数学推导说明状态转移方向选择  
- 精简的预处理与状态转移实现  
- 时间复杂度分析明确  
**核心片段**  
```cpp
for(int p=1;p<=len;p++)
    f[p][mul[1][p]] = 0; // 巧妙初始化
for(int p=1;p<=len;p++)
    for(int x=0;x<m;x++)
        f[p][x*mul[i+1][p]%m] = min(...); // 正向刷表
```

### 关键技巧总结
1. **模数预处理**：通过 `sum[i][j] = (sum[i][j-1]*10 + a[j])%m` 快速计算任意区间模数  
2. **状态压缩**：仅维护余数维度，将问题规模从指数级降为O(Lm)  
3. **刷表法优化**：通过当前状态更新后续状态，避免复杂逆运算  
4. **极值初始化**：使用极大值初始化便于后续min操作  

### 拓展建议
- **同类问题**：数字分割求极值（P1018 乘积最大）、模数相关计数问题（P1313 计算系数）  
- **变形方向**：结合加减运算符、多维度模数约束、动态模数变化  
- **优化进阶**：滚动数组优化空间、并行处理极值查询  

### 相似题目推荐
1. **P1773 符文之语**（本题，练习基础实现）  
2. **P1018 乘积最大**（数字分割求极值）  
3. **P1313 计算系数**（模数运算与组合数学）  
4. **P1043 数字游戏**（环形分割与模数结合）

---
处理用时：55.92秒
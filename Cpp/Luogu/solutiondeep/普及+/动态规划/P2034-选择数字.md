# 题目信息

# 选择数字

## 题目描述

给定一行 $n$ 个非负整数 $a_1 \cdots a_n$。现在你可以选择其中若干个数，但不能有超过 $k$ 个连续的数字被选择。你的任务是使得选出的数字的和最大。

## 说明/提示

对于 $20\%$ 的数据，$n \le 10$。

对于另外 $20\%$ 的数据，$k=1$。

对于 $60\%$ 的数据，$n \le 1000$。

对于 $100\%$ 的数据，$1 \le n \le 100000$，$1 \le k \le n$，$0 \le $ 数字大小 $ \le 1,000,000,000$。

时间限制 $500$ ms。

## 样例 #1

### 输入

```
5 2
1
2
3
4
5 
```

### 输出

```
12```

# AI分析结果



### 综合分析与结论
题目要求选择若干数且不超过k个连续，求最大和。关键难点在于高效维护区间最值进行状态转移。题解主要分为两类思路：  
1. **逆向思维**：将问题转化为求删除数的最小和，使用单调队列维护区间最小值（Youngsc、生而为人等）  
2. **状态机DP**：定义选/不选两种状态，用单调队列优化最大值查询（Star_Wind、Priori_Incantatem等）  
最优解法为单调队列优化DP，时间复杂度O(n)，空间复杂度O(n)

---

### 精选题解与评分
#### 1. Youngsc（★★★★★）  
**核心亮点**：  
- 逆向思维转化问题为求删除数的最小和  
- 简洁的单调队列实现维护窗口最小值  
- 代码高度优化，直接操作前缀和  
**关键代码**：  
```cpp
while(head<=tail&&q[tail]>=f[i]) tail--; // 维护单调性
q[++tail] = f[i], p[tail] = i; // 存储值和索引
while(head<=tail&&p[head]<i-k) head++; // 维护窗口大小
```

#### 2. Star_Wind（★★★★☆）  
**核心亮点**：  
- 清晰的二维状态定义（选/不选）  
- 直观展示单调队列维护最大值的推导过程  
- 代码可读性强，适合理解状态转移  
**关键代码**：  
```cpp
while(q[l]<i-m&&l<=r) l++; // 维护队首区间
f[i][1] = f[q[l]][0] - s[q[l]] + s[i]; // 状态转移
while(f[i][0]-s[i]>f[q[r]][0]-s[q[r]]) r--; // 维护单调性
```

#### 3. Priori_Incantatem（★★★★☆）  
**核心亮点**：  
- 严格推导状态转移方程  
- 完整注释解释单调队列维护逻辑  
- 包含前缀和优化细节  
**关键代码**：  
```cpp
while(l<=r && q[l]<i-k) l++;
f[i][1] = s[i] + f[q[l]][0] - s[q[l]]; 
while(f[i][0]-s[i] >= f[q[r]][0]-s[q[r]]) r--;
```

---

### 关键思路与技巧
1. **逆向转化思维**：当直接求解困难时，转化为求互补问题（如删除数的最小和）  
2. **单调队列优化**：维护滑动窗口最值，将DP转移复杂度从O(k)降为O(1)  
3. **状态定义技巧**：  
   - 定义`f[i]`为前i个数的删除最小和  
   - 或定义`f[i][0/1]`分别表示第i个数不选/选时的最大值  
4. **前缀和加速**：用`sum[i]`快速计算区间和，避免重复计算  

---

### 拓展与同类题目
**相似题型套路**：  
- 带滑动窗口限制的序列选择问题  
- 需要区间最值优化的动态规划  

**推荐题目**：  
1. [P2627 修剪草坪](https://www.luogu.com.cn/problem/P2627)（同模型变形）  
2. [P1725 琪露诺](https://www.luogu.com.cn/problem/P1725)（滑动窗口最值DP）  
3. [P3957 跳房子](https://www.luogu.com.cn/problem/P3957)（单调队列优化DP进阶）  

---

### 个人心得摘录
1. **Youngsc**：  
   > "正难则反，转化为删除数的最小和。任意连续的k个数中至少有一个被删"  
   —— 逆向思维的应用关键  

2. **TheShadow**：  
   > "考场上怎么处理边界？初始值设置错误导致WA多次"  
   —— 强调边界条件的验证重要性  

3. **Creeper_LKF**：  
   > "初始队列头尾指针设置不同导致错误，需手动构造小数据验证"  
   —— 调试时构造极端测试用例的必要性

---
处理用时：56.04秒
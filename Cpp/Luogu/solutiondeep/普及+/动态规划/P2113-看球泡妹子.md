# 题目信息

# 看球泡妹子

## 题目背景

2014 年巴西世界杯开幕了，现在满城皆是世界杯，商家们利用它大赚一笔，小明和小红也借此机会增进感情。


## 题目描述

本届世界杯共有 $n$ 支球队，$m$ 场比赛。男球迷小明喜欢看比赛，女球迷小红喜欢看帅哥。每支球队在小明眼里的实力值为 $a_i$，在小红眼里的帅哥数量为 $b_i$。

每场比赛有两个球队对抗，它们的编号分别是 $p_i$ 和 $q_i$。小明认为一场比赛的精彩度等于两队实力的乘积，小红则认为是两队帅哥数量之和。

由于体力的限制，他们最多只能看 $k$ 场比赛。当然，只要看比赛，两个人一定会一起看。小明作为男生，理应迁就一下女生，所以，请你写一个程序，求出小红看到比赛的精彩度总和不小于 $c$ 的情况下，小明看到比赛的精彩度的最大总和。

## 说明/提示

#### 数据范围与约定

- 对于 $20\%$ 数据，$1 \le n,m,k \le 5$。
- 对于 $100\%$ 数据，$1 \le n \le 100$，$1 \le k \le m \le 100$，$1 \le a_i,b_i \le 10$，$1 \le c \le 10^3$。

## 样例 #1

### 输入

```
4 3 2 5
2 2 1 3
1 1 1 2
1 2
2 3
3 4```

### 输出

```
7```

# AI分析结果



### 综合分析与结论
本题属于二维费用背包问题的变种，核心难点在于同时处理选k场的数量限制与小红总精彩度至少为c的约束。各题解均采用动态规划思路，主要差异在于状态维度的选择（三维/二维）和空间优化技巧。正确解法需维护至少三个维度（比赛数、已选场数、小红值）或通过优化技巧压缩状态。

---

### 精选题解及评分

#### 1. 作者：LZH_LOVE_ZRG（评分：★★★★★）
**关键亮点**：  
- 将问题转化为二维01背包，状态设计清晰（`f[j][k]`表示选j场且小红值为k时的最大小明值）  
- 使用逆序循环优化空间，避免重复计算  
- 代码简洁高效，初始化处理规范  

**核心代码**：
```cpp
memset(f, -0x3f3f3f3f, sizeof(f));
f[0][0] = 0;
for(int i=1; i<=m; i++) {
    int v = b[p[i]] + b[q[i]], w = a[p[i]] * a[q[i]];
    for(int j=k; j>=1; j--) // 逆序处理选场数
        for(int k=s; k>=v; k--)
            f[j][k] = max(f[j][k], f[j-1][k-v] + w);
}
```

#### 2. 作者：Night_Bringer（评分：★★★★☆）
**关键亮点**：  
- 创新性地将小红值超过c的状态统一压缩到c，大幅减少状态空间  
- 采用滚动数组思想优化代码结构  
- 调试经历中强调初始化的重要性，具有借鉴意义  

**核心思路**：  
```cpp
// 状态转移时将超过c的部分视为c
for(int j = c; j <= sum; j++)
    ans = max(ans, dp[m][k][j]);
```

#### 3. 作者：lwz2002（评分：★★★★）
**关键亮点**：  
- 详细阐述三维状态转移过程，适合初学者理解  
- 强调枚举范围必须从0开始，避免漏解  
- 初始化时设置无效状态为负无穷，避免错误转移  

**代码片段**：  
```cpp
memset(f, 128, sizeof(f));
for(int i=0; i<=m; i++) f[i][0][0] = 0;
for(int i=1; i<=m; i++)
    for(int j=1; j<=i; j++)
        for(int l=0; l<=maxn; l++) // 必须从0开始枚举
            f[i][j][l] = max(f[i-1][j][l], ...);
```

---

### 最优关键思路总结
1. **状态设计**：维护`f[已选场数][小红值]`或`f[处理比赛][已选场数][小红值]`，前者通过逆序循环优化空间  
2. **转移方向**：逆序更新避免重复选择，通过`max(f[j][k], f[j-1][k-v]+w)`实现状态转移  
3. **初始化技巧**：将无效状态初始化为负无穷，仅`f[0][0] = 0`有效  
4. **剪枝优化**：将超过c的小红值压缩到c（如Night_Bringer的解法）  

---

### 拓展训练推荐
1. **P1853** 投资的最大效益（二维费用背包）  
2. **P1509** 找GF（双重约束优化）  
3. **P1941** 飞扬的小鸟（状态压缩与最少操作）  

---

### 调试经验摘录
- **lwz2002**：  
  > "枚举k必须从0开始，否则当c小于当前物品价值时会漏解"  
  → 强调边界条件的全面性检验  

- **Rorschachindark**：  
  > "初始化错误导致4次WA，最终发现需单独设置f[0][0]=0"  
  → 初始化是动态规划的核心环节  

- **shenbear**：  
  > "尝试将小明小红分开维护会导致约束失效"  
  → 双目标问题需设计复合状态同时处理约束

---
处理用时：75.62秒
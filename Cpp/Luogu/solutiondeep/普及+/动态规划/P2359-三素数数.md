# 题目信息

# 三素数数

## 题目背景

蛟川书院的一道练习题QAQ


## 题目描述

如果一个数的所有连续三位数字都是大于100的素数，则该数称为三素数数。比如113797是一个6位的三素数数。


## 说明/提示

区域动归QAQ


## 样例 #1

### 输入

```
4```

### 输出

```
204```

# AI分析结果



### 综合分析与结论
本题核心是动态规划结合素数预处理，各题解均围绕状态转移与优化展开。关键点在于如何高效处理三位素数的约束条件及状态转移的优化。以下为精选题解及核心思路总结。

---

### 精选题解列表

#### 1. **dspr（五星）**
**关键亮点**：  
- 使用**矩阵快速幂**优化DP转移，时间复杂度降至O(log n)，可处理n=1e9的大数据。  
- 构造转移矩阵，将状态转移转化为矩阵乘法，利用快速幂加速。  
- 预处理三位素数，建立状态转移关系，代码结构清晰。  

**核心代码**：  
```cpp
matrix ans = b; n--;
while(n){
    if(n&1) ans = ans * b;
    b = b * b;
    n /= 2;
}
// 矩阵乘法实现快速幂，最终统计结果
```

#### 2. **Youngsc（五星）**
**关键亮点**：  
- **预处理三位素数**，直接遍历素数表更新状态，避免无效枚举。  
- 状态定义`f[i][j]`表示i位数且最后两位为j时的合法数个数，转移仅需O(素数数量)。  
- 代码简洁高效，实际运行速度最优（32ms）。  

**核心代码**：  
```cpp
for(R int i=4; i<=n; ++i)
    for(R int j=1; j<=p; ++j)
        if(pri[j]>=100)
            f[i][pri[j]%100] = (f[i][pri[j]%100] + f[i-1][pri[j]/10])%mod;
// 直接遍历素数表，避免无效状态
```

#### 3. **qianfujia（四星）**
**关键亮点**：  
- **滚动数组优化空间**，将三维DP压缩为一维，空间复杂度降至O(1)。  
- 仅保留当前和前一个状态，适用于内存敏感场景。  
- 结合素数筛预处理，代码简洁，逻辑清晰。  

**核心代码**：  
```cpp
for(int i = 4; i <= n; ++i){
    memcpy(a, dp, sizeof(dp));
    memset(dp, 0, sizeof(dp));
    for(int j = 26; j <= prime[0]; ++j)
        dp[prime[j]%100] = (dp[prime[j]%100] + a[prime[j]/10]) % mod;
}
// 滚动数组优化，仅用两个一维数组
```

---

### 关键思路与技巧总结
1. **状态压缩与矩阵快速幂**：将状态转移抽象为矩阵运算，适用于固定转移模式的问题（如线性递推）。  
2. **素数预处理优化**：直接遍历三位素数表，避免无效枚举，时间复杂度显著降低。  
3. **滚动数组**：在状态转移仅依赖前一状态时，通过滚动数组压缩空间。  
4. **递推方向设计**：从低位向高位递推，利用末两位信息约束第三位选择。

---

### 拓展与举一反三
- **同类型题目**：  
  1. [P2657 windy数](https://www.luogu.com.cn/problem/P2657)（数位DP）  
  2. [P4127 数位和](https://www.luogu.com.cn/problem/P4127)（数位统计+模运算）  
  3. [P2106 Sam数](https://www.luogu.com.cn/problem/P2106)（矩阵快速幂优化递推）  

- **调试心得**：  
  - **dspr**提到初始代码可读性差，后优化矩阵乘法逻辑，强调代码维护的重要性。  
  - **cbyybccbyybc**通过打表三位素数减少运行时间，体现预处理在实际竞赛中的价值。  
  - **qianfujia**强调滚动数组在空间敏感场景的应用，适合处理大规模数据。  

---

**总结**：优先掌握Youngsc的素数预处理思路，结合滚动数组优化空间；矩阵快速幂适用于极端数据规模，可作为高阶技巧储备。

---
处理用时：79.70秒
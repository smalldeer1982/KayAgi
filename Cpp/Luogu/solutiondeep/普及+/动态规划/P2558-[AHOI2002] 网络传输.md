# 题目信息

# [AHOI2002] 网络传输

## 题目描述

在计算机网络中所有数据都是以二进制形式来传输的。但是在进行较大数据的传输时，直接使用该数的二进制形式加以传输则往往传输的位数过多。譬如要传输 $1024$ 就需要 $11$ 位二进制数。于是小可可提出了一种数据优化传输的设想，并打算对这一设想进行试验。

该设想是：正整数的所有方幂以及任意多个互不相等的 $k$ 的方幂之和排成一个递增数列 $\{a(k)n\}$，例如当 $k=3$ 时，$\{a(k)n\}$ 的前 $7$ 项为 $1(=3^0)$ 、 $3(=3^1)$ 、 $4(=3^0+3^1)$ 、 $9(=3^2)$ 、 $10(=3^0+3^2)$ 、 $12(=3^1+3^2)$ 、 $13(=3^0+3^1+3^2)$。

如果数 $d$ 是数列 $\{a(k)n\}$ 中的第 $p$ 项，则可以通过传送 $k$ 和 $p$ 这两个数来表示数 $d$。由于 $k$ 和 $p$ 这两个相对很小的数就可以表达出很大的数，因而理论上可以减少网络传输的位数。

小可可现在请你编写程序把接收到的数 $k$ 和 $p$ 所代表的数 $d$ 计算出来。

## 样例 #1

### 输入

```
3 2```

### 输出

```
3```

## 样例 #2

### 输入

```
3 7```

### 输出

```
13```

# AI分析结果



### 综合分析与结论
题目本质是将p的二进制表示视为k的幂次选择器，每个二进制位决定是否取对应k的幂次。最优解法是将p转为二进制后逐位计算k的幂次和，时间复杂度O(log p)。需注意高精度处理，但核心思路统一。

---

### 高星题解推荐

#### 1. Hisaishi_Kanade（5星）
**核心思路**：将p的二进制位直接映射为k的幂次选择，数学推导简洁高效  
**关键亮点**：  
- 利用二进制与幂次选择的一一对应关系，复杂度O(log p)  
- Python实现无需高精度，代码仅6行，体现算法本质  
**代码片段**：
```python
k,p=map(int,input().split()) 
ret=0
while p>0:
    if p%2==1: ret+=pre  # pre是当前k的幂次
    pre*=k
    p//=2
print(ret)
```

#### 2. kkxhh（4星）
**核心思路**：模拟二进制位的高精度运算，通用性强  
**关键亮点**：  
- 独立实现高精度的加法和乘法，适用于大k和大p  
- 位运算与高精度结合，体现底层实现原理  
**代码亮点**：
```cpp
while(p){
    if(p&1) ans += current_k_pow; // 高精度加法
    current_k_pow *= k;          // 高精度乘法
    p >>= 1;
}
```

#### 3. Ginger_he（4星）
**核心思路**：使用__int128处理中等规模数据，代码简洁  
**关键亮点**：  
- 利用__int128省去高精度实现，适合竞赛快速编码  
- 明确揭示二进制位与幂次关系，代码高度可读  

---

### 关键思路总结
**二进制映射法**：  
1. 将p转换为二进制，如p=7 → 111₂  
2. 每位代表是否选k的对应幂次：1×k² + 1×k¹ + 1×k⁰  
3. 求和即得结果，此思路可推广至类似"独立选择组合数列"问题  

**高精度处理技巧**：  
- 压位存储：如将50位数字分为4个13位段（hanzhongtlx解法）  
- 逐位计算：用数组模拟十进制位运算（kkxhh解法）  

---

### 拓展与习题推荐
**同类型题目**：  
1. [P1017 进制转换](https://www.luogu.com.cn/problem/P1017)（负进制处理）  
2. [P1066 2^k进制数](https://www.luogu.com.cn/problem/P1066)（高精度+组合数学）  
3. [P1582 倒水问题](https://www.luogu.com.cn/problem/P1582)（二进制位特性应用）  

**调试经验摘录**：  
> "开始尝试分成3块爆了long long，改成4块后AC" —— 压位时需估算位数  
> "高精乘时忘记进位，调试半小时发现循环边界错误" —— 高精度需严格测试进位

---
处理用时：56.63秒
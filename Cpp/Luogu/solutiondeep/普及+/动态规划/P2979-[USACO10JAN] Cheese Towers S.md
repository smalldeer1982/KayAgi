# 题目信息

# [USACO10JAN] Cheese Towers S

## 题目描述

FJ 要建一个奶酪塔，高度最大为 $T\ (1 \le T \le 10^3)$ 。他有 $N\ (1 \le N \le 10^2)$ 种奶酪。第 $i$ 种奶酪的高度为 $H_i\ (5\le H_i \le T\text{ 且 }5 \mid H_i)$ ，价值为 $V_i\ (1 \le V_i \le 10^6)$ 。一块高度 $H_i\ge K\ (1 \le K \le T)$ 的奶酪被称为大奶酪，如果一个奶酪上方有大奶酪（如果有多块就只算一次），这个奶酪的高度 $H_i$ 就会变成原来的 $\frac{4}{5}$。FJ 想让他的奶酪塔价值和最大。请你求出这个最大值。

例如，考虑一种奶酪塔，其最大高度可以是 $53$，可以用三种类型的奶酪块建造。大块是大于或等于 $25$ 的块。下面是他堆叠的各种奶酪块的值和高度的图表：

|类型|价值|高度|
| :----------: | :----------: | :----------: |
|1|100|25|
|2|20|5|
|3|40|10|

FJ建造了以下奶酪塔：

|类型|价值|高度|
| :----------: | :----------: | :----------: |
|1|100|25|
|2|20|4|
|3|40|8|
|3|40|8|
|3|40|8|

总高度是 $25 + 4 + 8 + 8 + 8 = 53$，除塔顶奶酪外，其余高度均被压低。总价值是 $100 + 20 + 40 + 40 + 40 = 240$。

## 样例 #1

### 输入

```
3 53 25 
100 25 
20 5 
40 10 
```

### 输出

```
240 
```

# AI分析结果



### 综合分析与结论
本题核心是动态规划结合贪心策略，将问题拆分为无大奶酪与顶部有大奶酪两种情况。最优思路为：
1. **贪心策略**：大奶酪必定放在塔顶，确保下方所有奶酪高度压缩。
2. **完全背包变形**：预处理完全背包时，将容量扩大至$T \times 5/4$，以兼容压缩后的高度计算。
3. **分情况合并结果**：分别处理两种情况后取最大值。

### 高分题解推荐
#### 1. 作者：reek（★★★★★）
- **关键亮点**：思路清晰，代码简洁高效，正确利用贪心策略拆分情况，预处理完全背包后枚举顶部大奶酪。
- **核心代码**：
  ```cpp
  for (int i=1;i<=n;i++) {
      for (int j=h[i];j<=T*5/4;j++)
          f[j] = max(f[j], f[j-h[i]] + v[i]);
  }
  ans = f[T];
  for (int i=1;i<=n;i++)
      if (h[i]>=k) ans = max(ans, f[(T-h[i])*5/4] + v[i]);
  ```
- **个人心得**：明确说明两种情况的分离逻辑，避免状态冗余。

#### 2. 作者：Cxs3（★★★★☆）
- **关键亮点**：详细推导$x=(T-h_i)\times 5/4$的数学依据，代码结构清晰。
- **核心代码**：
  ```cpp
  for (int i=1;i<=n;i++)
    for (j=h[i];j<=t*5/4;j++) 
        f[j] = max(f[j], f[j-h[i]] + v[i]);
  ans = max(ans, v[i] + f[(t-h[i])*5/4]);
  ```
- **个人心得**：强调背包容量需扩展到$5/4T$，避免因压缩计算不足导致错误。

#### 3. 作者：linyinuo2008（★★★★☆）
- **关键亮点**：分步讲解完全背包与顶部大奶酪处理，代码注释详细。
- **核心代码**：
  ```cpp
  for (i=1; i<=n; i++)
      for (j=h[i]; j<=t*5/4; j++)
          f[j] = max(f[j], f[j-h[i]] + v[i]);
  ans = max(f[t], v[i] + f[(t-h[i])*5/4]);
  ```
- **个人心得**：通过示例表格直观说明高度压缩机制，降低理解难度。

### 最优关键思路与技巧
1. **贪心定位大奶酪**：仅需考虑顶部大奶酪，避免复杂状态转移。
2. **背包容量扩展**：将完全背包容量设为$T \times 5/4$，确保压缩高度后的总容量合法。
3. **分治合并结果**：独立计算两种场景，取最大值简化逻辑。

### 拓展练习
1. **P1616 疯狂的采药**（完全背包模板题）
2. **P1776 宝物筛选**（多重背包+二进制优化）
3. **P2854 [USACO06DEC]Cow Roller Coaster**（二维费用背包+贪心）

### 调试与踩坑总结
- **容量扩展必要性**：未扩展容量会导致大奶酪下方总高度计算错误（如Kirisame_Marisa_指出）。
- **贪心正确性验证**：若大奶酪不在顶部，调整顺序不会劣化结果（reek的题解中证明）。
- **边界处理**：需初始化$f[0]=0$，避免无效状态污染结果。

---
处理用时：47.78秒
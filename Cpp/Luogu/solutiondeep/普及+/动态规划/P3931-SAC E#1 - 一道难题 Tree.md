# 题目信息

# SAC E#1 - 一道难题 Tree

## 题目背景

冴月麟和魏潇承是好朋友。


## 题目描述

冴月麟为了守护幻想乡，而制造了幻想乡的倒影，将真实的幻想乡封印了。任何人都无法进入真实的幻想乡了，但是她给前来救她的魏潇承留了一个线索。

她设置了一棵树（有根）。树的每一条边上具有割掉该边的代价。

魏潇承需要计算出割开这棵树的最小代价，这就是冴月麟和魏潇承约定的小秘密。

帮帮魏潇承吧。


注：所谓割开一棵有根树，就是删除若干条边，使得任何任何叶子节点和根节点不连通。


## 说明/提示

### 数据范围及约定

- 对于 $20\%$ 的数据，$n\le 10$；
- 对于 $50\%$ 的数据，$n \le 1000$；
- 对于 $100\%$ 的数据，$2\le n \le 100000$，且边权是不大于 $10^6$ 的非负整数。


## 样例 #1

### 输入

```
4 1
1 2 1 
1 3 1
1 4 1```

### 输出

```
3```

## 样例 #2

### 输入

```
4 1
1 2 3
2 3 1
3 4 2```

### 输出

```
1```

# AI分析结果



### 综合分析与结论
本题核心是求割断所有叶子到根的最小代价，主流通解为树形DP和网络流。树形DP在时间复杂度（O(n)）和代码简洁性上显著优于网络流，是更优解法。各题解中，树形DP实现思路统一，而网络流解法存在冗余步骤和复杂度风险。

---

### 精选题解（评分≥4星）

#### 1. 作者：_louhc （★★★★★）
**关键亮点**  
- 思路清晰简洁，直接通过递归DFS自底向上累加最小值  
- 代码短小精悍（仅20行核心逻辑），可读性极佳  
- 正确处理叶子节点返回INF的边界条件  
**核心代码**  
```cpp
LL DFS(int x, int fa) {
    LL ans(0); bool flg(0);
    for (int i = hd[x]; i; i = nxt[i])
        if (to[i] != fa) ans += min(DFS(to[i], x), val[i]), flg = 1;
    return flg ? ans : LONG_LONG_MAX;
}
```
**个人心得**  
"注：叶子返回INF保证必须割断父边" —— 通过极大值巧妙处理边界

#### 2. 作者：nosta （★★★★☆）  
**关键亮点**  
- 提出路径最小值优化的状态转移方程  
- 代码实现极简（仅7行DP核心）  
- 可扩展解决类似题目P2495  
**核心思路**  
```cpp
int dp(int x, int pa, int mn) {
    int c = -1;
    for(int i=head[x]; i; i=last[i]) 
        if(to[i]!=pa) c += dp(to[i],x,min(mn,len[i]));
    return (~c) ? min(c+1, mn) : mn;
}
```

#### 3. 作者：mrsrz （★★★★）  
**关键亮点**  
- 标准树形DP模板，适合新手学习  
- 显式处理父子边权转移逻辑  
**核心方程**  
`dp[i] = min(割断父边, 子节点dp之和)`

---

### 最优关键思路提炼
**树形DP核心逻辑**：  
1. **状态定义**：`dp[u]`表示使u子树与根不连通的最小代价  
2. **状态转移**：`dp[u] = Σ min(dp[v], edge(u→v))`，v为子节点  
3. **边界处理**：叶子节点返回极大值迫使父边被割  
4. **实现技巧**：DFS回溯时累加最小值，避免显式建树

---

### 拓展与相似题目推荐
1. [P1352 没有上司的舞会](https://www.luogu.com.cn/problem/P1352)（树形DP决策模型）
2. [P2015 二叉苹果树](https://www.luogu.com.cn/problem/P2015)（树形DP+容量限制）
3. [P2597 灾难](https://www.luogu.com.cn/problem/P2597)（树形结构+拓扑处理）

---
处理用时：58.18秒
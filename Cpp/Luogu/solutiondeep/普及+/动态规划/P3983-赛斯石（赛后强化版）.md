# 题目信息

# 赛斯石（赛后强化版）

## 题目背景

```cpp
白露横江，水光接天，纵一苇之所如，凌万顷之茫然。——苏轼
```
真程海洋近来需要进购大批赛斯石，你或许会问，什么是赛斯石？

首先我们来了解一下赛斯，赛斯是一个重量单位，我们用$ si $作为其单位。比如$ 1 $赛斯就是$ 1si $。

而赛斯石有这样一个性质，它本来是一赛斯一赛斯单独存在的，但是用自然枪将其精化之后，它就会与其它经过精化的赛斯石进行合并，合并到合适的重量之后，便将其钝化，使其不再合并其它赛斯石，如果合错了，也可以用金刚刀将其切开（神奇的是你只能切成整数赛斯重量）。赛斯石的重量只能是**整数**赛斯重量，而不同赛斯重量的赛斯石的价格也是不一样的。


## 题目描述

现需上市$ Need $赛斯重量的赛斯石，卖家想算出这些赛斯石经过某种合并方式来获得的最大收益。然而目前有一个问题，市场在真程大殿附近（真程海洋中心位置），卖家需要租船送赛斯石过去（即不考虑卖家自己租船过去的费用），目前有十种船可以租，载重量从$ 1si $到$ 10si $，每艘船的租价也是有所不同的，如下表所示：

 ![](https://cdn.luogu.com.cn/upload/pic/10663.png) 

由于真程大殿附近有强烈的赛斯力，导致**无法对赛斯石进行任何操作**，商家将赛斯石运过来之后就只能按照之前合并好的卖。假设卖家不返回，且这些赛斯石全部能卖出去。现在卖家他要计算总盈利（设总盈利=赛斯石的总收益-租船所需总费用），请你设计一个程序，算出一种最佳方案，以获得**最大总盈利**。


## 说明/提示

### 样例一说明：

将$ 11 $个单位赛斯石合并为一个$ 4si $的赛斯石和一个$ 7si $的赛斯石并且租两个载重分别为$ 4si $和$ 7si $的船，这样做为最佳方案，那么最大总盈利就是$ 32 $元。

### 注意：

对于所有输入数据，均在区间$ (0, 100000) $中，并且为整数；

保证卖家最大总盈利为正；

同一行中，每两个数据之间有一个空格。

赛后强化版于$ 2020 $年$ 10 $月$ 13 $日$ 19 $点$ 18 $分已强化完毕。


## 样例 #1

### 输入

```
11
1 6 11 17 23 27 33 35 38 43```

### 输出

```
32```

## 样例 #2

### 输入

```
7
1 5 14 18 20 28 31 34 39 42```

### 输出

```
21```

# AI分析结果



### 综合分析与结论
题目本质是双重完全背包问题：  
1. **预处理阶段**：将每艘船的载重视为背包容量，计算装满该船的最大收益（完全背包）  
2. **主问题阶段**：将船的载重视为物品重量，预处理后的净收益作为价值，再次完全背包求解  
所有题解均围绕这一核心思路展开，差异主要体现在代码实现细节与优化程度上。

---

### 精选题解与评分

#### 1. 惠存xs（★★★★☆）  
**关键亮点**：  
- 清晰的两次完全背包结构，代码简洁易读  
- 使用单数组滚动更新，空间优化到位  
- 预处理阶段将船费用分离处理，逻辑清晰  

**核心代码**：
```cpp
for(int i=1;i<=10;i++)  // 预处理每艘船的最大收益
    for(int j=i;j<=10;j++)
        f[j] = max(f[j], f[j-i] + a[i]);
for(int i=1;i<=10;i++)  // 计算净收益
    f[i] -= v[i];
for(int i=1;i<=10;i++)  // 最终完全背包
    for(int j=i;j<=n;j++)
        dp[j] = max(dp[j], dp[j-i] + f[i]);
```

#### 2. issue_is_fw（★★★★☆）  
**关键亮点**：  
- 二维DP实现更易理解状态转移  
- 注释详细，变量命名规范  
- 显式分离两个背包阶段，适合教学  

**核心片段**：
```cpp
for(int i=1;i<=10;i++)  // 预处理阶段
    for(int j=i;j<=10;j++)
        w[j] = max(w[j], w[j-i]+a[i]);
        
for(int i=1;i<=10;i++)  // 主背包阶段
    for(int j=i;j<=n;j++)
        dp[j] = max(dp[j], dp[j-i]+(w[i]-v[i]));
```

#### 3. Link_Space（★★★☆☆）  
**独特贡献**：  
- 手动处理特殊组合（如2+5=7等）  
- 揭示题目隐藏的贪心性质  
- 提供调试思路：通过样例反推优化点  

**关键代码**：
```cpp
// 添加特殊组合作为新物品
w[11]=7; val[11]=val[2]+val[5]+原船费差;
...
for(int i=1;i<=14;i++)  // 包含原始+特殊物品的完全背包
    for(int j=w[i];j<=n;j++)
        dp[j] = max(dp[j], dp[j-w[i]] + val[i]);
```

---

### 最优思路提炼
**关键技巧**：  
1. **双重完全背包**：先求每船最大收益，再求总收益  
2. **费用后处理**：先计算最大收益再扣除船费，避免干扰状态转移  
3. **滚动数组优化**：使用一维数组实现完全背包的空间优化  

**思维突破点**：  
- 将船只视为可重复选择的"超级物品"，其价值由内部最优组合决定  
- 分离收益计算与费用扣除，避免状态转移过程中的干扰  

---

### 拓展训练推荐
1. **P1853 投资的最大效益**（双重完全背包）  
2. **P2918 [USACO08NOV] Buying Hay S**（价值与重量的特殊关系）  
3. **P5365 [SNOI2017] 英雄联盟**（多重背包+费用分离思想）  

---

### 题解心得摘录
1. **惠存xs**提到："船必然装满"的隐含条件，揭示预处理阶段的合理性  
2. **Link_Space**调试发现："手动添加组合后才通过样例"，强调特例分析的重要性  
3. **fanxingzhi**反思："原以为直接减船费即可，实际需要处理组合"，体现动态规划中局部最优与全局最优的关系理解

---
处理用时：54.57秒
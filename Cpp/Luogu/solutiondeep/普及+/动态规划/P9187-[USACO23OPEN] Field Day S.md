# 题目信息

# [USACO23OPEN] Field Day S

## 题目描述

**提示：本题的 Python 时限为 15s。其它语言默认 2s。**

Farmer John 的 $N$ 个牛棚都会选出包含 $C$ 只奶牛的队伍去参加户外聚会。所有奶牛的品种都只可能是根西牛（`G`）或荷斯坦奶牛（`H`）。

我们将两个奶牛队伍中，同一位置对应的两头奶牛品种不同的所有位置 $i(1 \leq i \leq C)$ 的个数，定义为的两个奶牛队伍的差异。对于编号 $1...N$ 的每个奶牛队伍 $t$，请计算出 $t$ 和其它所有队伍的差异的最大值。

## 说明/提示

第一个和第三个队伍的差异为 $5$。第二个和第三个队伍的差异为 $3$。

$2 \leq N \leq 10^5,1 \leq C \leq 18$。

- 对于测试点 2-5：$C = 10$。
- 对于测试点 6-9：所有答案最少为 $C - 3$。
- 对于测试点 10-20：没有额外条件。

## 样例 #1

### 输入

```
5 3
GHGGH
GHHHH
HGHHG```

### 输出

```
5
3
5```

# AI分析结果



### 综合分析与结论
本题核心在于将最大汉明距离问题转化为求反码的最小汉明距离问题。关键优化思路包括：状态压缩、BFS预处理、位运算优化。当C较小时（≤18），基于位运算的预处理算法（BFS/DP）能有效解决大规模数据问题。

---

### 精选题解

#### 1. FFTotoro (BFS思路) ⭐⭐⭐⭐⭐
**关键亮点**：
- 巧用多源BFS预处理所有可能值的最短翻转距离
- 将最大差异转化为反码的最短距离，数学转化巧妙
- 代码简洁高效，时间复杂度O(2^C*C)
**个人心得**：
> "最大的异或popcount即为总位数c减去b的最小异或popcount，而最小答案即广搜出来b的步数"

**核心代码**：
```cpp
vector<int> m(1<<c,-1);
queue<pair<int,int>> q;
for(auto &i:a){
    q.emplace(i,m[i]=0);
}
while(!q.empty()){
    auto [u,w]=q.front(); q.pop();
    for(int i=0;i<c;i++)
        if(int v=u^(1<<i);m[v]==-1)
            q.emplace(v,m[v]=w+1);
}
```
**实现思想**：以所有输入数为起点进行多源BFS，记录每个二进制数通过逐位翻转所需的最小步数，该步数即为最小汉明距离。

---

#### 2. IamZZ (DP思路) ⭐⭐⭐⭐
**关键亮点**：
- 通过位运算动态维护最小差异值
- 分层转移状态，逐位更新最优解
- 数学转化清晰，时间复杂度严格O(2^C*C)

**核心代码**：
```cpp
for(j=1;j<=c;j++)
    for(i=0;i<=(1<<c)-1;i++)
        f[(1<<j-1)^i]=min(f[(1<<j-1)^i],f[i]+1);
```
**实现思想**：通过逐位翻转的DP转移，维护每个二进制数的最小差异值。每次处理一位的翻转，更新所有相关状态。

---

#### 3. ppip (DP优化) ⭐⭐⭐⭐
**关键亮点**：
- 双向状态转移优化，同时处理超集与子集
- 利用位运算特性简化转移方程
- 代码实现简洁，空间利用率高

**核心代码**：
```cpp
for(int i{(1<<m)-1};~i;--i)
    for(int j{0};j<m;++j)
        if(~i>>j&1) f[i]=min(f[i],f[i^1<<j]+1);
for(int i{0};i<1<<m;++i)
    for(int j{0};j<m;++j)
        if(i>>j&1) f[i]=min(f[i],f[i^1<<j]+1);
```
**实现思想**：通过逆向和正向两次位遍历，分别处理超集与子集关系，确保每个状态的最优解被正确更新。

---

### 关键技巧总结
1. **问题转化**：将最大差异问题转化为求反码的最小差异，利用补集思想简化问题
2. **位压缩**：将字符串转化为整数，利用位运算高效处理差异计算
3. **多源BFS**：以所有输入为起点进行扩散，预处理所有可能值的最优解
4. **分层DP**：按位分层转移状态，利用位运算特性优化状态更新

---

### 相似题目推荐
1. [P2114 起床困难综合症](https://www.luogu.com.cn/problem/P2114) - 位运算与最优决策
2. [P3067 Balanced Cow Subsets](https://www.luogu.com.cn/problem/P3067) - 折半搜索与状态压缩 
3. [P7961 数列](https://www.luogu.com.cn/problem/P7961) - 位模式分析与递推优化

---
处理用时：63.17秒
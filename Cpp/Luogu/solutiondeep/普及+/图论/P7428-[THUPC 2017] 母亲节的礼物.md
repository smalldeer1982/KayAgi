# 题目信息

# [THUPC 2017] 母亲节的礼物

## 题目描述

小 B 喜欢图，尤其是边数不太多的无向简单图。

母亲节快到了，小 B 在纸上画了一张有 $n$ 个节点、$m$ 条边的无向简单图（即，不存在重边、自环），保证每个点只和**最多 $7$ 个点**相邻。接着，他想用 $4$ 种不同的颜色给图中的节点进行染色，作为妈妈的母亲节礼物送给她。

小 B 希望染色之后的图尽量漂亮，他觉得相同颜色的点连成一片不好看。所以，他希望能给每对相邻的节点染上不同的颜色。遗憾的是，小 B 很快发现，在有些图中，这是不可能做到的。他不得不降低要求：每个点相邻的点中，**至多**有一个点和它的颜色相同。

限制条件放松了，问题也就变得简单了；但是小 B 忙着做大作业，所以来找你帮忙。现在，请你告诉小 B，是否能给图中每个点染上一个恰当的颜色，恰好满足小 B 的要求？如果可以，请你给他指出一种染色方案；否则，只好残忍地告诉小 B：`impossible`。

## 说明/提示

#### 版权信息
来自 THUPC（THU Programming Contest，清华大学程序设计竞赛）2017。

## 样例 #1

### 输入

```
1
8 28
1 2
1 3
1 4
1 5
1 6
1 7
1 8
2 3
2 4
2 5
2 6
2 7
2 8
3 4
3 5
3 6
3 7
3 8
4 5
4 6
4 7
4 8
5 6
5 7
5 8
6 7
6 8
7 8```

### 输出

```
abcdabcd```

# AI分析结果

### 综合分析与结论
这些题解的核心思路都是先判断本题一定有解，然后通过构造染色方案来解决问题。判断有解的依据主要是基于完全图和非完全图的特性，而构造方案大多采用随机染色后调整的方式，将不满足条件的点放入队列，不断调整点的颜色，直到队列为空。

### 所选题解
- **作者：happy_dengziyue (赞：8)  ★★★★**
  - 关键亮点：思路清晰，代码实现简洁，对算法的核心部分有详细解释，且给出了代码记录。

### 重点代码
```cpp
// 找出所有不满足要求的点，加入队列
for(int i=1;i<=n;++i){
    if(asksame(i,col[i])>1)q.push(i);
}
// 不断从队列中取出点进行调整
while(!q.empty()){
    int u=q.front();
    q.pop();
    if(asksame(u,col[u])<=1)continue;
    micnt=8;
    for(int i=0,k;i<4;++i){
        k=asksame(u,i);
        if(k<micnt){
            micnt=k;
            micol=i;
        }
    }
    col[u]=micol;
    for(int i=fir[u],v;i;i=e[i].nx){
        v=e[i].v;
        if(col[v]==micol&&asksame(v,micol)>1)q.push(v);
    }
}
```
**核心实现思想**：先将所有不满足要求（相邻点中同色点超过 1 个）的点加入队列，然后不断从队列中取出点，将其颜色改为相邻点中最稀有的颜色，再判断与之相连的点是否满足要求，不满足则加入队列，直到队列为空。

### 最优关键思路或技巧
- **判断有解**：通过分析完全图和非完全图的性质，得出本题一定有解的结论，简化了问题。
- **队列调整**：使用队列存储不满足要求的点，不断调整点的颜色，直到所有点都满足要求。

### 可拓展之处
同类型题或类似算法套路：图的染色问题通常可以采用贪心、回溯、随机化等算法。对于一些复杂的染色问题，可以结合多种算法进行求解。例如，对于有更多颜色限制或更复杂约束条件的图染色问题，可以先使用随机化算法得到一个初始解，再使用贪心算法进行局部调整。

### 推荐题目
1. [P1525 关押罪犯](https://www.luogu.com.cn/problem/P1525)
2. [P2899 [USACO08JAN]Cell Phone Network G](https://www.luogu.com.cn/problem/P2899)
3. [P3060 [USACO12NOV]Balanced Cow Subsets G](https://www.luogu.com.cn/problem/P3060)

### 个人心得
题解中没有明显的个人心得（调试/顿悟）相关内容。

---
处理用时：24.24秒
# 题目信息

# 不开心的金明

## 题目描述

金明今天很不开心，家里购置的二手房就要领钥匙了，房里并没有一间他自己专用的很宽敞的房间。更让他不高兴的是，妈妈昨天对他说：“你需要购买哪些物品，怎么布置，你说了不算（有很大的限制），而且不超过 $W$ 元钱。”。今天一早金明就开始做预算，但是他想买的东西太多了，肯定会超过妈妈限定的 $W$ 元。于是，他把每件物品规定了一个重要度整数 $p_i$ 表示。他还从因特网上查到了每件物品的价格 $v_i$（都是整数元）。

妈妈看到购物单后进行了审查，要求购物单上所有的物品价格的极差（最贵的减去最便宜的）不超过 $3$（当然金明至今不知道为什么会这样）。他希望在不超过 $W$ 元（可以等于 $W$ 元）的前提下，使购买的重要度总和 $\sum p_i$ 的最大。


请你帮助金明设计一个满足要求的购物单，你只需要告诉我们重要度的最大的和。


## 说明/提示

$1 \le N \le 100$。

$1 \le W \le 10^9$。

$1 \le v_i \le 10^9$。

对所有的 $i=1,2,3,…,N$，$\min(v_i) \le v_i \le \min(v_i)+3$。

$1 \le p_i \le 10^7$。


## 样例 #1

### 输入

```
5 10
2 800
5 400
5 300
3 400
2 200
```

### 输出

```
1600```

# AI分析结果

• 综合分析与结论：
    - 这些题解主要围绕背包问题展开，由于数据范围限制不能直接使用常规背包解法，各题解通过不同方式优化。
    - 思路上，有的利用极差条件以300为界分类讨论，小值时用背包，大值时贪心；有的根据物品价格种类少（仅4种）的特点，枚举各重量物品数量、分组计算可能值等。
    - 算法要点包括01背包的应用、贪心策略、排序、前缀和计算等。解决难点在于如何突破空间限制和利用好极差条件优化算法。

### 以下为题解评分：
- **作者：蓝莲花__ (赞：85)**
    - **星级**：4星
    - **关键亮点**：对背包问题进行巧妙预处理，将物品体积减去最小体积减1，在dp数组多加一维记录所选物品个数，从而能通过计算得到总体积，有效解决空间限制问题。
    - **个人心得**：无
    - **重点代码**：
```cpp
for (int i=1;i<=n;i++)
for (int j=sv;j>=v[i];j--)
for (int k=n;k>=1;k--)
if (j+k*minv<=sumv) dp[j][k]=max(dp[j][k],dp[j-v[i]][k-1]+w[i]);
```
    - **核心思想**：通过三层循环，对每个物品、每个修改后的体积及所选物品个数进行遍历，在满足总体积不超限制时更新dp数组，取重要度总和最大值。

- **作者：sy_zmq_001 (赞：35)**
    - **星级**：4星
    - **关键亮点**：敏锐发现极差条件与300的关系，以300为分界线，最小值小于等于300时用01背包，大于300时利用极差限制进行贪心选择，思路清晰，计算量小。
    - **个人心得**：无
    - **重点代码**：
```cpp
if(minn<=300){
    for(int i=1;i<=n;i++){
        for(int j=w;j>=v[i];j--){
            f[j]=max(f[j],f[j-v[i]]+p[i]);
        }
    }
    printf("%d",f[w]);
}
else{
    int ans=0;
    sort(p+1,p+n+1,cmp);
    for(int i=1;i<=w/maxn;i++)
        ans+=p[i];
    printf("%d",ans);
}
```
    - **核心思想**：根据最小值与300的关系，分别执行01背包和贪心算法，背包部分通过循环更新f数组求最大重要度和，贪心部分对重要度排序选取前w/maxn个。

- **作者：林聪 (赞：31)**
    - **星级**：4星
    - **关键亮点**：利用物品只有4种重量的特点，将物品按重量分类，对每类按价值排序并计算前缀和，通过枚举各类物品数量，在不超总钱数时更新答案，简单直接且易理解。
    - **个人心得**：无
    - **重点代码**：
```cpp
for(int i=0;i<=tot0;i++)
    for(int j=0;j<=tot1;j++)
        for(int k=0;k<=tot2;k++)
        {
            int sum=i*minn+j*(minn+1)+k*(minn+2);
            if(sum<=m)
            {
                int l=(m-sum)/(minn+3);
                ans=max(ans,s0[i]+s1[j]+s2[k]+s3[l]);
            }
        }
```
    - **核心思想**：通过四层循环枚举四类物品数量，计算当前组合总钱数，不超限时计算第四类物品可选取数量，更新最大重要度和。

### 最优关键思路或技巧：
 - 利用极差与300的关系分类讨论，将复杂问题简化为背包和贪心两种常规算法。
 - 利用物品重量种类少的特点，分类排序并通过枚举、前缀和等方式优化计算。

### 可拓展之处：
 - 此类题目属于背包问题变种，类似套路如利用数据范围特点、物品特性等对背包问题进行优化。常见类型有多重背包、分组背包等变种问题。

### 洛谷相似题目推荐：
 - P1048 [NOIP2005 普及组] 采药
 - P1616 疯狂的采药
 - P2679 [NOIP2015 普及组] 子串分值和

---
处理用时：37.10秒
# 题目信息

# 信号站

## 题目背景

   扶贫行动来到了Q村，扶贫队准备在Q村修筑信号站，让Q村不再“远离尘世”,让人们获得丰富的外界信息。

## 题目描述

   Q村非常非常Qiong，整个村只有一条路。在这条路上，有N户人家，因为条件有限，所以一个点上可能有多户人家。因为山区运输条件落后，所以扶贫队只能修筑k个信号站，并且他们希望各电站的不合理值之和最小。信号站的不合理值是指该信号站到每户人家的距离之和。
 
   扶贫队善于修筑电站，但是他们不擅长选址~~（因为数学不好QwQ）~~，他们希望你>>编程高手，来帮助他们选择修筑信号站的最佳地点，使得k个信号站的不合理值最小。

   距离求解方法:若某信号站的坐标为x,某户人家的坐标为y,那么该信号站与该人家的距离为|x-y|（即取绝对值）。

   数据保证人家数大于信号站数。放置信号站的位置坐标必须为整数。一个位置上只能放一个信号站。


## 说明/提示

#### 样例解释

在2和3的位置上放置信号站（方案不唯一）。

#### 数据范围

对于 $ 70\% $ 的数据，$ n,k\leq 10^3 $；  
对于 $ 100\% $ 的数据，$  n \leq 1000000, 0 \leq a_i \leq 10 ^ 6 $。

## 样例 #1

### 输入

```
7 2
1 1 2 2 3 3 4```

### 输出

```
13```

# AI分析结果

• **综合分析与结论**：这些题解主要围绕在一条路上有\(n\)户人家，需建\(k\)个信号站使不合理值之和最小的问题展开。思路上，多数题解先明确单个点不合理值函数性质，再通过不同方法确定\(k\)个信号站位置。算法要点包括排序、前缀和等操作。难点在于处理信号站可能建在负数位置及优化计算不合理值的复杂度。多数题解思路较清晰，但部分代码可读性欠佳或优化不足。

• **所选的题解**：
  - **作者：lamboo (赞：16)  星级：4星**
    - **关键亮点**：利用绝对值几何意义得出单个点不合理值函数性质，通过计数排序或快速排序舍去区间加快速度，再利用函数单调性往两边扩展计算取最小值。
    - **个人心得**：无
    - **核心代码片段**：
```cpp
void sort(long long l,long long r)
{
    int i,j,x,y;
    if (l>n/2) return;  
    if (r<n/2) return; 
    i=l;j=r;
    x=a[l+r>>1];
    do
    {
        while (a[i]<x) ++i;
        while (x<a[j]) --j;
        if (i<=j)
        {
            y=a[i];
            a[i]=a[j];
            a[j]=y;
            ++i;--j;
        }
    }
    while (i<=j);
    if (l<j) sort(l,j);
    if (i<r) sort(i,r);
}
// 计算绝对值
inline long long abs(long long x)
{
    if (x>0) return x;
    return -x;
}
int main()
{
    int k;
    scanf("%lld %d",&n,&k);
    for (int i=1;i<=n;i++) scanf("%lld",&a[i]),b[a[i]]++; 
    sort(1,n);
    long long ans=0;
    long long x=a[(n+1)/2],y=x+1;
    long long x_ans=0,y_ans=0,x_num=0,y_num=0;
    for (int i=1;i<=n;i++) 
        if (a[i]>x) ++x_num; 
    for (int i=1;i<=n;i++)  
        if (a[i]<y) ++y_num; 
    for (int i=1;i<=n;i++) x_ans+=abs(x-a[i]);
    for (int i=1;i<=n;i++) y_ans+=abs(y-a[i]);
    for (int i=1;i<=k;i++)
    {
        if (x_ans<=y_ans) 
        {
            ans+=x_ans;
            x_ans+=x_num+b[x]-(n-x_num-b[x]); 
            if (b[x]) x_num+=b[x]; 
            --x;
        }
        else
        {
            ans+=y_ans;
            y_ans+=y_num+b[y]-(n-y_num-b[y]);
            if (b[y]) y_num+=b[y];
            ++y;
        }
    }
    printf("%lld\n",ans);
    return 0;
}
```
  - **作者：RenaMoe (赞：14)  星级：4星**
    - **关键亮点**：通过观察两个点答案间关系，利用前缀和或递推维护每个点左右边点数，将每次查询复杂度降到\(O(1)\)，总复杂度\(O(n)\)。同时指出需考虑信号站建在负数位置，通过平移坐标解决。
    - **个人心得**：指出若只计算\(i\in [0,10^6]\)的值，会忽略信号站建在负数位置的答案，如\(n = 3\)，位置\(a_i\)都为\(0\)，\(k = 3\)时，三个信号站位置分别为\(-1\)，\(0\)，\(1\)。
    - **核心代码片段**：
```cpp
inline void main() {
    read(n), read(k);
    for (int i = 1, x; i <= n; ++i)
        read(x), a[x+L]++;
    for (int i = 0; i <= L+L; ++i)
        f[0] += a[i] * i;
    r = n;
    for (int i = 1; i <= L+L; ++i) {
        l += a[i-1];
        f[i] = f[i-1] + l - r;
        r -= a[i];
    }
    sort(f, f+L+L+1);
    for (int i = 0; i < k; ++i)
        ans += f[i];
    printf("%lld\n", ans);
    return 0;
}
```
  - **作者：fantastic_dream (赞：3)  星级：4星**
    - **关键亮点**：利用前缀和求出每个点对应的不合理值，通过公式\(f[i]=dl[i]\cdot i - sum[dl[i]] + sum[n] - sum[dl[i]] - i\cdot (n - dl[i])\)在\(O(1)\)时间内完成转化，同时考虑到坐标不连续、信号站可能为负数及需开\(long long\)等细节。
    - **个人心得**：无
    - **核心代码片段**：
```cpp
int main(){
    n=read(),k=read();
    sum[0]=0;
    for(int i=1;i<=n;i++)	sz[i]=read(),sz[i]+=k;
    sort(sz+1,sz+n+1);
    long long zd=sz[n];
    for(int i=1;i<=n;i++){
        if(sz[i]>sz[i-1]){
            for(int j=sz[i-1]+1;j<sz[i];j++)	dl[j]=i-1;
            dl[sz[i]]=i;
        }
    }
    for(int i=1;i<=n;i++)	sum[i]=sum[i-1]+sz[i];
    for(int i=1;i<=zd;i++){
        f[i]=1ll*dl[i]*i-sum[dl[i]]+sum[n]-sum[dl[i]]-1ll*i*(n-dl[i]);
    }    
    sort(f+1,f+zd+1);
    for(int i=1;i<=k;i++)	ans+=f[i];
    cout<<ans;
    return 0;
}
```

• **最优关键思路或技巧**：利用绝对值几何意义确定单个点不合理值函数性质，通过前缀和或递推优化计算每个点不合理值的复杂度，同时注意处理信号站可能在负数位置的情况，如将所有坐标平移一个较大值。

• **可拓展之处**：此类问题属于选址优化问题，类似套路可用于其他在一维或二维空间中选择点使某种距离或代价之和最小的问题。例如在一维数轴上安排多个服务设施使到各需求点距离和最小等。

• **推荐题目**：
  - [P1080 国王游戏](https://www.luogu.com.cn/problem/P1080)，涉及贪心算法，通过合理排序解决问题。
  - [P1199 三国游戏](https://www.luogu.com.cn/problem/P1199)，需要运用贪心和博弈论思想。
  - [P1248 加工生产调度](https://www.luogu.com.cn/problem/P1248)，利用贪心策略优化生产调度顺序。

• **个人心得摘录与总结**：部分题解作者指出需注意信号站坐标可能为负数，若未考虑会导致部分测试点错误。如\(n = 3\)，位置\(a_i\)都为\(0\)，\(k = 3\)时，信号站位置可能为\(-1\)，\(0\)，\(1\) 。还有作者强调要开\(long long\)，否则可能因数据范围问题丢分。 

---
处理用时：98.19秒
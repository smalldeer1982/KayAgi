# 题目信息

# [USACO20DEC] Stuck in a Rut S

## 题目描述

Farmer John 最近扩大了他的农场，从奶牛们的角度看来这个农场相当于是无限大了！奶牛们将农场上放牧的区域想作是一个由正方形方格组成的无限大二维方阵，每个方格中均有美味的草（将每个方格看作是棋盘上的一个方格）。Farmer John 的 $N$ 头奶牛（$1≤N≤1000$）初始时位于不同的方格中，一部分朝向北面，一部分朝向东面。

每一小时，每头奶牛会执行以下二者之一：

 - 如果她当前所在的方格里的草已经被其他奶牛吃掉了，则她会停下（并从这个时刻开始一直保持停止）。
 - 吃完她当前所在的方格中的所有草，并向她朝向的方向移动一个方格。

经过一段时间，每头奶牛的身后会留下一条被啃秃了的轨迹。

如果两头奶牛在一次移动中移动到了同一个有草的方格，她们会分享这个方格中的草，并在下一个小时继续沿她们朝向的方向移动。

当 Farmer John 看到停止吃草的奶牛时会不高兴，他想要知道谁该为他停止吃草的奶牛受到责备。如果奶牛 $b$
停在了之前奶牛 $a$ 吃过草的一个方格，我们就称奶牛 $a$ 阻碍了奶牛 $b$。进一步地，如果奶牛 $a$ 阻碍了奶牛 $b$ 且奶牛 $b$ 阻碍了奶牛 $c$，我们认为奶牛 $a$ 也阻碍了奶牛 $c$（也就是说，「阻碍」关系具有传递性）。每头奶牛受到责备的程度与这头奶牛阻碍的奶牛数量一致。请计算每头奶牛受到责备的数量——也就是说，每头奶牛阻碍的奶牛数量。 

## 说明/提示

在这个样例中，奶牛 3 阻碍了奶牛 2，奶牛 4 阻碍了奶牛 5，奶牛 5 阻碍了奶牛 6。根据传递性，奶牛 4 也阻碍了奶牛 6。 

 - 测试点 2-5 中，所有坐标不超过 $2000$。
 - 测试点 6-10 没有额外限制。

供题：Brian Dean 

## 样例 #1

### 输入

```
6
E 3 5
N 5 3
E 4 6
E 10 4
N 11 1
E 9 2```

### 输出

```
0
0
1
2
1
0
```

# AI分析结果

### 综合分析与结论
这些题解主要围绕如何高效判断奶牛之间的阻碍关系展开。思路上，多数题解利用奶牛行进方向不同分类，通过分析坐标关系确定可能的交点，进而判断阻碍情况。算法要点包括对奶牛按方向分类存储、确定交点条件及判断谁被谁阻碍的方法。难点在于处理较大坐标范围、判断交点顺序及传递阻碍关系。

从质量看，部分题解思路清晰但代码可读性欠佳，或代码简洁但思路阐述不够详细。整体缺乏思路清晰、代码简洁且优化程度高的高质量题解，均不足4星。

### 通用建议与扩展思路
通用思路是按奶牛方向分类，通过坐标关系找交点判断阻碍。可优化之处在于更高效地处理交点判断和阻碍关系传递。类似题目可考察不同方向物体在平面上的运动交互，关键是分析物体间的位置和运动关系。

### 相似知识点洛谷题目
1. **P1162 填涂颜色**：涉及二维平面上图形的填充与状态判断，与本题分析奶牛在平面上运动轨迹有相似处。
2. **P1434 [SHOI2002]滑雪**：通过分析二维平面上各点关系寻找最长路径，类似本题对奶牛位置关系分析。
3. **P1596 [USACO10OCT]Lake Counting S**：在二维平面上统计连通区域数量，和本题处理平面上物体关系有相似思维方式。 

---
处理用时：14.84秒
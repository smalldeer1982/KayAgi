# 题目信息

# [NOIP 2003 普及组] 数字游戏

## 题目描述

丁丁最近沉迷于一个数字游戏之中。这个游戏看似简单，但丁丁在研究了许多天之后却发觉原来在简单的规则下想要赢得这个游戏并不那么容易。游戏是这样的，在你面前有一圈整数（一共 $n$ 个），你要按顺序将其分为 $m$ 个部分，各部分内的数字相加，相加所得的 $m$ 个结果对 $10$ 取模后再相乘，最终得到一个数 $k$。游戏的要求是使你所得的 $k$ 最大或者最小。


例如，对于下面这圈数字（$n=4$，$m=2$）：

![](https://cdn.luogu.com.cn/upload/image_hosting/gy407k49.png)

要求最小值时，$((2-1)\bmod10)\times ((4+3)\bmod10)=1\times 7=7$，要求最大值时，为 $((2+4+3)\bmod10)\times (-1\bmod10)=9\times 9=81$。特别值得注意的是，无论是负数还是正数，对 $10$ 取模的结果均为非负值。

丁丁请你编写程序帮他赢得这个游戏。


## 说明/提示

**【题目来源】**

NOIP 2003 普及组第二题

## 样例 #1

### 输入

```
4 2
4
3
-1
2
```

### 输出

```
7
81
```

# AI分析结果



### 综合分析与结论
本题核心为环形数组分割为m段求模后乘积的极值。解法集中在区间DP和DFS剪枝，关键在于环形处理（破环成链）、状态转移方程设计、模运算处理。区间DP是主流解法，复杂度更优；DFS需巧妙剪枝否则易超时。

---

### 精选题解列表

#### 1. 作者：租酥雨（区间DP） ★★★★☆
**关键亮点**  
- 清晰的状态定义：`B[l][r][k]`和`S[l][r][k]`分别表示区间极值  
- 破环成链+前缀和预处理，简化环形处理  
- 代码规范，初始化处理细致  
**核心代码**  
```cpp
for (int i=2;i<=m;i++)
  for (int l=1;l<=2*n;l++)
    for (int r=l+i-1;r<=2*n;r++)
      for (int k=l+i-2;k<r;k++) {
          S[l][r][i] = min(S[l][r][i], S[l][k][i-1] * mod(a[r]-a[k]));
          B[l][r][i] = max(B[l][r][i], B[l][k][i-1] * mod(a[r]-a[k]));
      }
```

#### 2. 作者：ykuouzf（区间DP详解） ★★★★☆
**关键亮点**  
- 详细推导状态转移方程，适合DP初学者理解  
- 两种破环方法对比（旋转数组与双倍数组）  
- 代码注释完整，分最大最小值独立处理  
**核心思路**  
状态转移方程：  
`f[i][j][k] = max(f[i][k][s] * sum(k+1,j))`，枚举断点k和分段数s  

#### 3. 作者：YoungNeal（记忆化搜索+DP） ★★★★  
**关键亮点**  
- 记忆化搜索实现DP，避免复杂循环  
- 分离最大/最小值处理，逻辑清晰  
- 处理负数取模的细节完善  
**核心代码**  
```cpp
int dfs(int l,int r,int k){
    if(f[l][r][k] != -1) return f[l][r][k];
    for(int i=l; i<r; i++) 
        for(int j=1; j<k; j++) 
            f[l][r][k] = max(f[l][r][k], dfs(l,i,j)*dfs(i+1,r,k-j));
    return f[l][r][k];
}
```

---

### 关键技巧总结
1. **破环成链**：复制数组到2倍长度，枚举每个起点作为链头  
2. **前缀和优化**：快速计算区间和，处理模运算前先加1e5避免负数  
3. **状态设计**：`dp[l][r][k]`表示区间[l,r]分割k段的最优值  
4. **剪枝策略**：DFS时利用剩余段数上限剪枝（如`9^(m-depth)`预估极值）  

---

### 拓展题目推荐
1. [P1063 能量项链](https://www.luogu.com.cn/problem/P1063) - 环形区间DP经典  
2. [P1880 石子合并](https://www.luogu.com.cn/problem/P1880) - 环形分割求极值  
3. [P1040 加分二叉树](https://www.luogu.com.cn/problem/P1040) - 区间分割与树结构结合  

---

### 个人心得摘录
- **调试教训**：DFS不剪枝时4号测试点需1000秒（dingcx）  
- **思维突破**：将环拆链后DP状态只需关注连续区间（租酥雨）  
- **初始化陷阱**：求最小值时需赋极大初值，否则可能残留旧数据（徐振羽）  

（注：以上题解评分基于思路创新性、代码质量及讲解深度，未达5星因部分代码可读性待优化）

---
处理用时：71.65秒
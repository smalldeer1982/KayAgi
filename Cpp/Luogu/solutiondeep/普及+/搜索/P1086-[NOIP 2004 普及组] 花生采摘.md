# 题目信息

# [NOIP 2004 普及组] 花生采摘

## 题目描述

鲁宾逊先生有一只宠物猴，名叫多多。这天，他们两个正沿着乡间小路散步，突然发现路边的告示牌上贴着一张小小的纸条：“欢迎免费品尝我种的花生！――熊字”。

鲁宾逊先生和多多都很开心，因为花生正是他们的最爱。在告示牌背后，路边真的有一块花生田，花生植株整齐地排列成矩形网格（如图一）。有经验的多多一眼就能看出，每棵花生植株下的花生有多少。为了训练多多的算术，鲁宾逊先生说：“你先找出花生最多的植株，去采摘它的花生；然后再找出剩下的植株里花生最多的，去采摘它的花生；依此类推，不过你一定要在我限定的时间内回到路边。”

![](https://cdn.luogu.com.cn/upload/image_hosting/unwk7hd0.png)

我们假定多多在每个单位时间内，可以做下列四件事情中的一件：

1) 从路边跳到最靠近路边（即第一行）的某棵花生植株；
2) 从一棵植株跳到前后左右与之相邻的另一棵植株；
3) 采摘一棵植株下的花生；
4) 从最靠近路边（即第一行）的某棵花生植株跳回路边。

现在给定一块花生田的大小和花生的分布，请问在限定时间内，多多最多可以采到多少个花生？注意可能只有部分植株下面长有花生，假设这些植株下的花生个数各不相同。

例如在图2所示的花生田里，只有位于 $(2, 5), (3, 7), (4, 2), (5, 4)$ 的植株下长有花生，个数分别为 $13, 7, 15, 9$。沿着图示的路线，多多在 $21$ 个单位时间内，最多可以采到 $37$ 个花生。

**注意**：在采摘过程中不能回到路边。

## 说明/提示

noip2004普及组第2题


## 样例 #1

### 输入

```
6 7 21
0 0 0 0 0 0 0
0 0 0 0 13 0 0
0 0 0 0 0 0 7
0 15 0 0 0 0 0
0 0 0 9 0 0 0
0 0 0 0 0 0 0```

### 输出

```
37```

## 样例 #2

### 输入

```
6 7 20
0 0 0 0 0 0 0
0 0 0 0 13 0 0
0 0 0 0 0 0 7
0 15 0 0 0 0 0
0 0 0 9 0 0 0
0 0 0 0 0 0 0
```

### 输出

```
28```

# AI分析结果



### 题解综合分析与结论
本题核心在于按花生数量降序采摘，并准确计算移动时间与返回条件。关键点包括曼哈顿距离的正确使用、时间消耗的动态更新，以及首次进入田间的特殊处理。以下为精选的高质量题解：

---

### 精选题解列表

#### 1. 作者：jiangXxin（★★★★☆）
**关键亮点**  
- 清晰的结构体排序逻辑，注释详细易于理解  
- 正确处理初始位置和曼哈顿距离计算  
- 通过动态更新剩余时间判断是否可继续采摘  

**核心代码思想**  
```cpp
struct dire { int x, y, sum; };
sort(stu+1, stu+pn+1, comp); // 降序排序
for (遍历每个花生点) {
    tm = 曼哈顿距离;
    k -= tm + 1; // 移动+采摘时间
    if (k >= ex) ans += 当前花生; // 剩余时间足够返回
    else break;
}
```

#### 2. 作者：_Arahc_（★★★★☆）
**关键亮点**  
- 使用优先队列和 `map` 自动维护降序序列  
- 代码简洁高效，避免手动排序  
- 明确处理边界条件（如队列为空时的终止）  

**核心代码思想**  
```cpp
priority_queue<int> q; // 大根堆存储花生数
map<int, pair<int, int>> c; // 花生数映射到坐标
while (时间足够且队列非空) {
    int cost = 移动距离 + 1; // 曼哈顿距离+采摘
    if (总时间 cost + 返回时间 <= k) 累加花生;
    else break;
}
```

#### 3. 作者：qhr2023（★★★★☆）
**关键亮点**  
- 极简代码风格，直接累加时间并判断  
- 初始位置设为虚拟点简化首次计算  
- 通过单次循环完成所有逻辑  

**核心代码思想**  
```cpp
sort(a, a+cnt, cmp); // 降序排序
int sum = 0; // 累计时间
for (遍历排序后的点) {
    sum += 曼哈顿距离 + 1; // 移动+采摘
    if (sum + 当前行数 <= k) ans += 花生数;
    else break;
}
```

---

### 关键思路总结
1. **排序策略**：必须按花生数降序处理，确保每一步采摘最优。
2. **时间计算**：移动时间用曼哈顿距离，采摘固定+1，返回时间只需行数。
3. **终止条件**：若剩余时间不足以返回（`k >= 当前行数`），立即终止。

---

### 扩展思路与推荐题目
- **同类型题目**  
  - [P1090 合并果子](https://www.luogu.com.cn/problem/P1090)：优先队列贪心  
  - [P1181 数列分段](https://www.luogu.com.cn/problem/P1181)：动态分段与资源限制  
  - [P1223 排队接水](https://www.luogu.com.cn/problem/P1223)：排序+时间累计  

- **调试心得**  
  - 注意首次进入田间的时间计算（如从行0到行1需1单位）。  
  - 必须严格判断剩余时间是否足够返回，避免采摘后无法退出。  

通过以上题解分析与总结，可快速掌握本题核心逻辑并规避常见错误。

---
处理用时：198.36秒
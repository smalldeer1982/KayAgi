# 题目信息

# 幻象迷宫

## 题目背景

（喵星人 LHX 和 WD 同心协力击退了汪星人的入侵，不幸的是，汪星人撤退之前给它们制造了一片幻象迷宫。）

WD：呜呜，肿么办啊……

LHX：momo...我们一定能走出去的！

WD：嗯，+U+U！

## 题目描述

幻象迷宫可以认为是无限大的，不过它由若干个 $N\times M$ 的矩阵重复组成。矩阵中有的地方是道路，用 $\verb!.!$ 表示；有的地方是墙，用 $\verb!#!$ 表示。LHX 和 WD 所在的位置用 $\verb!S!$ 表示。也就是对于迷宫中的一个点$(x,y)$，如果 $(x \bmod n,y \bmod m)$ 是 $\verb!.!$ 或者 $\verb!S!$，那么这个地方是道路；如果 $(x \bmod n,y \bmod m)$ 是$\verb!#!$，那么这个地方是墙。LHX 和 WD 可以向上下左右四个方向移动，当然不能移动到墙上。

请你告诉 LHX 和 WD，它们能否走出幻象迷宫（如果它们能走到距离起点无限远处，就认为能走出去）。如果不能的话，LHX 就只好启动城堡的毁灭程序了……当然不到万不得已，他不想这么做。

## 说明/提示

- 对于 $30\%$ 的数据，$1\le N,M\le 20$；
- 对于 $50\%$ 的数据，$1\le N,M\le 100$；
- 对于 $100\%$ 的数据，$1\le N,M\le 1500$，每个测试点不超过 $10$ 组数据。

## 样例 #1

### 输入

```
5 4
##.#
##S#
#..#
#.##
#..#
5 4
##.#
##S#
#..#
..#.
#.##
```

### 输出

```
Yes
No

```

# AI分析结果



### 综合分析与结论
题目核心在于判断无限重复迷宫中的路径是否可达无限远。各题解核心思路集中在两种方法：①通过记录模坐标与实际坐标差异检测循环路径；②扩展迷宫矩阵检测边界可达性。最优解法为方法①，其通过DFS/BFS维护实际坐标与模坐标的映射关系，在O(NM)复杂度内解决问题，避免了空间浪费。

---

### 精选题解与评分

#### 1. DEVILK (5星)
**核心亮点**：  
- 通过DFS记录模坐标(x%n,y%m)及对应的实际坐标(lx,ly)  
- 当同一模坐标点对应不同的实际坐标时判定为可无限循环  
- 巧妙利用取模运算处理无限扩展，避免显式存储扩展迷宫  

**代码片段**：
```cpp
void dfs(int x, int y, int lx, int ly) {
    if(vis[x][y][0] && (vis[x][y][1]!=lx || vis[x][y][2]!=ly)) {
        fl = 1; // 发现不同实际坐标的相同模坐标
        return;
    }
    vis[x][y][1] = lx, vis[x][y][2] = ly;
    for(int i=0; i<4; ++i) {
        int xx = (x + dx[i] + n) % n, yy = (y + dy[i] + m) % m;
        int lxx = lx + dx[i], lyy = ly + dy[i]; // 更新实际坐标
        dfs(xx, yy, lxx, lyy);
    }
}
```

#### 2. GNAQ (4星)
**核心亮点**：  
- 使用三维数组存储访问状态：vis[x][y][0]记录访问标记，[1][2]存储实际坐标  
- 通过比较同一模坐标点不同实际坐标判断循环  
- 代码结构清晰，逻辑直击问题本质  

**关键实现**：
```cpp
void dfs(int x, int y, int posx, int posy) {
    if (vis[posx][posy][2] && (vis[posx][posy][0]!=x || vis[posx][posy][1]!=y)) {
        ans=1; // 发现不同实际坐标
        return;
    }
    vis[posx][posy][0]=x; vis[posx][posy][1]=y;
    // ... 四方向扩展
}
```

#### 3. ygsldr (4星)
**核心亮点**：  
- 将迷宫扩展为2倍，通过检测能否到达不同象限判断无限路径  
- 使用两个标记数组分别记录物理坐标和模坐标的访问状态  
- 实现直观，适合理解扩展迷宫思路  

---

### 关键技巧总结
1. **模坐标与实际坐标映射**：维护每个访问点的实际坐标(lx, ly)与模坐标(x%n, y%m)，当同一模坐标对应不同实际坐标时存在循环路径。
2. **取模运算处理负数**：通过`(x + n) % n`确保模运算结果非负，正确处理边界穿越。
3. **空间优化**：避免显式存储扩展迷宫，利用取模动态计算坐标，保持空间复杂度为O(NM)。

---

### 同类题目推荐
1. **P1515 迷宫** - 二维迷宫路径判断（基础BFS/DFS）
2. **P1378 油滴扩展** - 模拟扩展过程中的重叠检测（类似无限扩展思维）
3. **P1443 马的遍历** - 广度优先搜索典型应用（路径可达性检测）

---
处理用时：64.40秒
# 题目信息

# 倒水问题

## 题目背景

**输入输出已更改，请不要直接提交原先的代码。**


## 题目描述

假定两个水壶 $A$ 和 $B$，供水量不限。可以使用三种方法装水：

- 给一个水壶装水；
- 把一个水壶倒空；
- 从一个水壶倒进另一个水壶。

当从一个水壶倒进另一个水壶时，如果第一个水壶倒空，或者第二个水壶装满就不能再倒了。例如，一个水壶 $A$ 是 $5$ 加仑和另一个水壶 $B$ 是 $6$ 加仑，水量是 $8$ 加仑，则从水壶 $A$ 倒进水壶 $B$ 时，让水壶 $B$ 充满水而水壶 $A$ 剩 $3$ 加仑水。

问题有 $3$ 个参数：$C_a$，$C_b$ 和 $N$，分别表示水壶 $A$ 和 $B$ 的容量，目标水量 $N$。问题的目标是，给出一系列倒水的步骤，使水壶 $B$ 中的水量恰好是 $N$。

## 说明/提示

开启了 spj。

如果你的方案比答案优，会提示 UKE，此时请联系管理员修改数据。

如果你的方案比答案差，分数会相应减损。

## 样例 #1

### 输入

```
2
3 5 4 
5 7 3 
```

### 输出

```
6 2 5 3 5 2 5 
6 1 6 1 6 4 6 
```

## 样例 #2

### 输入

```
1
26 29 11
```

### 输出

```
22 1 6 1 6 4 6 1 6 4 6 1 6 4 6 1 6 4 6 1 6 4 6 
```

# AI分析结果



### 综合分析与结论
该题为经典的隐式图搜索问题，需通过BFS寻找最短操作序列。核心在于状态表示（水量组合）、操作模拟（6种倒水动作）及路径记录。各题解均采用BFS框架，差异主要体现在状态存储方式、路径记录优化及剪枝策略。

---

### 精选题解与评分

#### 1. 作者：Kater_kcl（⭐⭐⭐⭐⭐）
**关键亮点**  
- 结构清晰的BFS框架，节点包含水量与操作序列  
- 独立处理6种操作，准确模拟倒水逻辑  
- 使用`vector`存储路径，天然记录操作顺序  
- 剪枝策略完善（判重+无效操作跳过）

**核心代码**  
```cpp
struct node { int x,y; vector<int> ans; };
// 倒水操作示例：A->B
if(temp.x>0 && temp.y!=cb){
    int pour = min(temp.x, cb - temp.y);
    node kater = temp;
    kater.x -= pour;
    kater.y += pour;
    kater.ans.push_back(6);
    if(!rem[kater.x][kater.y]) q.push(kater);
}
```

#### 2. 作者：zhaotiensn（⭐⭐⭐⭐）
**关键亮点**  
- 双数组分别存储水量与操作路径  
- 显式处理倒水的两种数学情况  
- 使用父指针回溯路径，节省内存  
**优化启示**  
通过`father数组`记录前驱节点，避免存储完整路径，空间效率更优。

**路径回溯实现**  
```cpp
void dfs(int x) {
    if(x==1) return;
    dfs(father[x].last);
    cout<<father[x].plan<<" ";
}
```

#### 3. 作者：千灯（⭐⭐⭐⭐）
**关键亮点**  
- 手写队列实现，性能更优  
- 分离状态存储与操作记录  
- 使用`min`简化倒水量计算  
**心得摘录**  
> "通过存储每个状态的上一个状态在队列里的坐标，最后倒着搜出方案，避免了冗余存储"

---

### 关键思路与技巧总结
1. **状态表示**：用二维数组`vis[a][b]`标记访问状态，避免重复搜索  
2. **路径记录**：  
   - 方案一：节点内嵌`vector`直接存储操作序列  
   - 方案二：独立数组存储操作，通过父指针回溯  
3. **倒水模拟**：  
   ```cpp
   int pour = min(src, dest_capacity - dest_current);
   src -= pour;
   dest += pour;
   ```
4. **剪枝优化**：跳过已满/空容器的无效操作（如满时不再fill）

---

### 拓展训练（洛谷题目）
1. [P1588 丢失的牛](https://www.luogu.com.cn/problem/P1588) - 一维BFS路径搜索  
2. [P1443 马的遍历](https://www.luogu.com.cn/problem/P1443) - 棋盘类BFS  
3. [P4799 世界冰球锦标赛](https://www.luogu.com.cn/problem/P4799) - 状态压缩与路径记录  

---

### 特别提醒
**易错点**：  
- 倒水操作需同时处理两种情形（倒空源容器或倒满目标容器）  
- 路径记录需保证操作顺序，建议使用前驱节点回溯法  
**调试技巧**：  
- 输出中间状态验证倒水逻辑  
- 使用小规模测试案例（如样例1）逐步跟踪队列变化

---
处理用时：64.07秒
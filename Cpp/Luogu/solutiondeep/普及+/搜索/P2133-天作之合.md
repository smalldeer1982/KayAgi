# 题目信息

# 天作之合

## 题目背景

生活就是一次A\*，你是我的第一个目标状态。——小明


## 题目描述

在小明的学校中，一共有若干个女生。小明认为每个女生的特征可以抽象为一个6位的数字串其中不重复地包含1~6这6个数码。

在小明心中，有一个理想的女生，她的特征数字串为A。如果串Y是串X交换两个连续的数码所得，那么我们认为特征数字串X和Y相似。首先，小明找到了他的同桌，她的特征数字串为S。每次，小明会寻找一个特征数字串和当前串相似的女生，直到寻找到适合他的（即特征数字串和A相同或相似的）。定义每个女生的合适程度为找到此人至少需要找女生的数量（包括他的同桌和此人自己）。显然，合适程度数值越小的女生越适合小明。

然而，小明觉得老天不会轻易地让他找到，所以他认为合适程度第二小的才是他最合适的伴侣（也就是小红）。那么，请你帮他写一个程序，求出对于小明，小红的合适程度是多少。


## 说明/提示

对于全部数据，保证串A和S合法，且保证能找到。

数据比较弱。


## 样例 #1

### 输入

```
123654
123456```

### 输出

```
3```

# AI分析结果



### 综合分析与结论
本题核心为求通过相邻交换将字符串A变为S的次优解。各题解主要采用BFS或逆序对分析两类思路。BFS直接模拟交换过程，记录第二次到达目标状态的步数；逆序对方法通过数学推导判断次优解与最优解的关系。最优解法需正确处理两种情况：存在多个最优解（次优=最优）或仅有一个最优解（次优=最优+2）。

---

### 精选题解列表

#### 1. **题解作者：Zhou_yu（4星）**
**关键亮点**：  
- 利用逆序对数量直接计算最优解，通过分析次优解的两种可能情况（最优解重复或+2）简化计算。  
- 数学思维巧妙，时间复杂度O(n²)，远优于BFS。  
- 代码简洁，通过映射与逆序对统计快速求解。

**核心代码**：
```cpp
int ans=0,cnt=0;
// 计算逆序对
for(int i=1;i<=6;i++)
for(int j=i+1;j<=6;j++)
    if(data[j]<data[i])ans++;
// 判断次优解情况
for(int i=1;i<=6;i++)
    if(abs(data[i]-m[a[i]])==ans)cnt++;
if(cnt==1)ans+=2;
```

---

#### 2. **题解作者：___w（4星）**
**关键亮点**：  
- 标准BFS实现，使用结构体存储状态，逐层搜索保证找到次优解。  
- 代码清晰易懂，通过标记首次找到目标后继续搜索第二次出现。  
- 适用于全排列状态数较少的情况，通用性强。

**核心代码**：
```cpp
queue <node> q;
while (!q.empty()) {
    node x = q.front(); q.pop();
    if (check(x, ed)) {
        if (!flag) flag = 1;
        else cout << x.step, exit(0);
    }
    // 生成相邻交换后的新状态
    for (int i = 0; i < 5; ++i) {
        swap(x.a[i], x.a[i+1]);
        q.push(x);
        swap(x.a[i], x.a[i+1]);
    }
}
```

---

#### 3. **题解作者：Little09（4星）**
**关键亮点**：  
- 使用多维数组判重，避免重复状态入队，优化搜索效率。  
- 明确处理初始状态即为目标的情况（输出2），避免逻辑漏洞。  
- 结构清晰，注释详细，适合学习BFS基础实现。

**核心代码**：
```cpp
bool used[7][7][7][7][7][7]; // 六维数组判重
while (!q.empty()) {
    point u = q.front();
    q.pop();
    // 遍历所有可能的交换
    for (int i=1; i<=5; i++) {
        swap(v.a[i], v.a[i+1]);
        if (!used[v.a[1]][v.a[2]][v.a[3]][v.a[4]][v.a[5]][v.a[6]]) {
            if (check(v.a,f)) {
                if (flag) cout << v.step;
                else flag = 1;
            }
            q.push(v);
        }
    }
}
```

---

### 最优思路总结
**关键技巧**：  
1. **逆序对分析法**：最优解等于逆序对数，次优解通过判断是否存在多个独立交换路径确定是否+2。  
2. **BFS状态管理**：用队列逐层扩展状态，记录首次找到解后继续搜索第二次，避免过早终止。  
3. **高效判重**：全排列状态数有限（6! = 720），可用多维数组或哈希快速判重。

---

### 相似题目推荐
1. **P1430 序列取数**（逆序对与动态规划）  
2. **P1379 八数码难题**（BFS解决状态转换问题）  
3. **P2324 [SCOI2005] 骑士精神**（IDA*优化搜索次优解）

---
处理用时：67.82秒
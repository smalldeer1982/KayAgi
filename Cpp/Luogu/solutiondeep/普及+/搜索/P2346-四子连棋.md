# 题目信息

# 四子连棋

## 题目描述

在一个 $4\times 4$ 的棋盘上摆放了 $14$ 颗棋子，其中有 $7$ 颗白色棋子，$7$ 颗黑色棋子，有两个空白地带，任何一颗黑白棋子都可以向上下左右四个方向移动到相邻的空格，这叫行棋一步，黑白双方交替走棋，任意一方可以先走，如果某个时刻使得任意一种颜色的棋子形成四个一线（包括斜线），这样的状态为目标棋局。

![](https://cdn.luogu.com.cn/upload/image_hosting/dagckxxz.png)

## 样例 #1

### 输入

```
BWBO
WBWB
BWBW
WBWO```

### 输出

```
5```

# AI分析结果



### 综合分析与结论
题目要求在4x4棋盘上通过交替移动黑白棋子，寻找达成四子连线的最少步数。各题解主要采用迭代加深搜索（IDDFS）、广度优先搜索（BFS）或状压+哈希优化。核心难点在于状态表示与判重、交替移动规则的实现，以及高效的剪枝策略。

---

### 精选题解（评分≥4星）

#### 1. Xiao_Mi（迭代加深搜索） ★★★★☆
**关键亮点**：
- 采用IDDFS框架，逐层增加搜索深度，天然保证找到最小步数。
- 巧妙处理两个空格的移动，通过交换颜色实现状态转移。
- 代码结构简洁，交替尝试黑白先手。

**核心代码**：
```cpp
int dfs(int x,int y,int xx,int yy,int color,int teg){
    if(ans==teg) return check(); // 达到当前深度阈值时验证
    for (移动方向){
        if (新位置合法且颜色不同){
            swap(当前空格与目标棋子);
            if (dfs(新位置, 交替颜色, 步数+1)) return 1;
            swap还原;
        }
    }
}
```
**实现思想**：通过深度限制逐步增加，每次搜索时交替移动两个空格，并检查是否达成目标。

#### 2. 啊嘞嘞嘞嘞（BFS+结构体状态） ★★★★☆
**关键亮点**：
- BFS保证首次访问即为最短路径。
- 结构体封装棋盘、空格位置、上一步颜色，状态清晰。
- 显式记录上一步颜色避免重复移动。

**核心代码**：
```cpp
struct state { 
    int a[4][4], x[2], y[2], last, t; 
    bool check() { /*行/列/斜线判断*/ }
};
void bfs() {
    queue<state> q;
    q.push(初始状态);
    while (!q.empty()) {
        state cur = q.front();
        for (每个空格移动方向){
            state nxt = cur;
            swap(nxt的空格与相邻棋子);
            if (nxt.check()) return 步数;
            q.push(nxt);
        }
    }
}
```
**实现思想**：通过队列逐层扩展状态，显式记录上一步颜色确保交替移动。

#### 3. Wind_Shear（迭代加深+双空格处理） ★★★★
**关键亮点**：
- 简洁的IDDFS实现，直接枚举深度上限。
- 同时处理两个空格的移动方向，避免冗余代码。
- 提前判断初始状态是否合法。

**核心代码**：
```cpp
for(ans=1;;ans++) { // 枚举深度
    if (dfs(黑先手) || dfs(白先手)) break;
}
bool dfs(参数包括当前颜色){
    if (depth>ans) return false;
    for (移动两个空格){
        swap棋子与空格;
        if (check()) return true;
        swap还原;
    }
}
```

---

### 关键思路与技巧总结
1. **交替移动与颜色记录**：必须记录上一步移动的棋子颜色，确保黑白交替。
2. **状态压缩与判重**：使用结构体、二进制/三进制状压或哈希减少重复状态。
3. **搜索策略选择**：IDDFS适合深度未知但较小的情况，BFS保证最短路径但需处理状态存储。
4. **双空格处理**：同时跟踪两个空格的位置，避免遗漏可能的移动组合。

---

### 相似题目推荐
1. **八数码问题**（P1379）：经典BFS/IDA*问题，类似棋盘移动。
2. **骑士精神**（P2324）：5x5棋盘，使用IDDFS或A*搜索。
3. **华容道**（P1972）：复杂棋盘移动问题，需状态优化。

---

### 个人心得摘录
- **Xiao_Mi**：强调IDDFS的剪枝优势，避免DFS陷入深层无效状态。
- **Ivystorm**：状压时发现直接存储棋盘更直观，但需重载运算符。
- **Wind_Shear**：通过提前交换棋子而非复制整个棋盘提升效率。

---
处理用时：92.99秒
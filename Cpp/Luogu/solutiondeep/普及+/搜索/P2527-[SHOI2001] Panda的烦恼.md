# 题目信息

# [SHOI2001] Panda的烦恼

## 题目描述

panda 是个数学怪人，他非常喜欢研究跟别人相反的事情。最近他正在研究筛法，众所周知，对一个范围内的整数，经过筛法处理以后，剩下的全部都是质数，不过 panda 对这些不感兴趣，他只对被筛掉的数感兴趣，他觉得在这些被筛掉的数中一定隐藏着重要的宇宙秘密，只是人们还没有发现罢了。

panda 还觉得如果只是单纯地从小到大筛的话，还不足够发现其中的奥秘，于是他决定对至多只包含某些质因数的数进行研究（比如说至多只包含质因数  $2,3$ 的数有  $2,3,4,6,8,9,\ldots$），他需要得到这些数中第  $k$ 小的数（ $k$ 是 panda 认为的宇宙系数），请你编个程序，帮助他找到这个数。

## 说明/提示

#### 样例解释

前六个数分别是  $3,5,9,15,25,27$。

#### 数据范围及限制

对于所有数据，有  $1\le n\le 100$， $1\le k\le 10^5$， $p_i\in\text{prime}$， $p_i\le 10^3$， $p_i\not=p_j(i\not=j)$， $1\le ans\le 2\times 10^9$。

## 样例 #1

### 输入

```
2 7
3 5```

### 输出

```
45

```

# AI分析结果



### 综合分析与结论
本题要求找出由给定质因数构成的数列中第k小的数。各题解主要采用以下思路：
1. **多指针法**：维护每个质数的当前乘数位置，每次取最小乘积（O(nk)时间复杂度）
2. **优先队列**：通过堆结构动态维护候选值（O(nk lognk)时间复杂度，需优化）
3. **Set去重**：利用有序集合特性，需配合剪枝优化

最优解法为多指针法，其时间复杂度最优（O(nk)），空间效率高，且代码简洁。

---

### 精选题解

#### 1. 作者：piggy（⭐⭐⭐⭐⭐）
**关键亮点**：
- 采用多指针法实现线性时间复杂度
- 通过指针数组记录每个质数的乘数位置
- 简洁的判重逻辑保证序列严格递增
- 代码仅20行，时空效率俱佳

**核心代码**：
```cpp
ans[0] = 1;
while (cnt < k) {
    int Min = 2147483647, Minx;
    for (遍历每个质数) 
        if (ans[b[i]] * a[i] < Min) 更新Min和Minx;
    b[Minx]++;
    if (Min != ans[cnt]) ans[++cnt] = Min; // 判重
}
```
**实现思想**：每个质数维护一个指针指向当前乘数位置，每次选择最小候选值，通过指针移动生成新候选。

#### 2. 作者：Rush_Hht（⭐⭐⭐⭐）
**关键亮点**：
- 归并排序思想模拟多路队列
- 详细步骤模拟帮助理解
- 通过队列索引实现高效候选值选取

**核心代码**：
```cpp
for (int i=1; i<=n; i++) q[i].push(p[i]);
while (取出次数 < k) {
    找出所有队列头的最小值;
    弹出该值并生成新候选数;
}
```
**实现思想**：每个质数对应一个候选队列，通过比较所有队列头部实现多路归并。

---

### 最优解法关键思路
**多指针法**的核心优化点：
1. **线性扫描代替堆结构**：通过维护每个质数的乘数位置，省去堆操作的时间开销
2. **增量生成保证有序**：每次生成的候选值必然不小于当前最大值，无需额外排序
3. **即时判重机制**：通过比较前值避免重复插入

**同类型题套路**：
- 丑数问题（LeetCode 264）
- 合并K个有序数组
- 超级丑数（LeetCode 313）

---

### 推荐练习题
1. [P2723 丑数 Humble Numbers](https://www.luogu.com.cn/problem/P2723)
2. [P1323 删数问题](https://www.luogu.com.cn/problem/P1323)（贪心+单调性）
3. [P1090 合并果子](https://www.luogu.com.cn/problem/P1090)（优先队列基础）

---
处理用时：76.78秒
# 题目信息

# [USACO3.1] 丑数 Humble Numbers

## 题目描述

对于一给定的素数集合 $S = \{ p_1, p_2, ..., p_k \}$, 考虑一个正整数集合，该集合中任一元素的质因数全部属于 $S$。这个正整数集合包括，$p_1$、$p_1 \times p_2$、$p_1 \times p_1$、$p_1 \times p_2 \times p_3$ ...(还有其它)。该集合被称为 $S$ 集合的“丑数集合”。注意：我们认为 $1$不是一个丑数。

你的工作是对于输入的集合 $S$ 去寻找“丑数集合”中的第 $n$ 个“丑数”。保证答案可以用 32 位有符号整数表示。

补充：丑数集合中每个数从小到大排列，每个丑数都是素数集合中的数的乘积，第 $n$ 个“丑数”就是在能由素数集合中的数相乘得来的（包括它本身）第 $n$ 小的数。


## 说明/提示

#### 数据规模与约定

对于 $100\%$ 的数据，保证：

- $1 \leq k \leq 100$。
- $1 \leq n \leq 10^5$。
- $2 \leq p_i < 2^{31}$，且 $p_i$ 一定为质数。

---
#### 说明

题目翻译来自 NOCOW。

USACO Training Section 3.1


## 样例 #1

### 输入

```
4 19
2 3 5 7```

### 输出

```
27```

# AI分析结果



### 综合分析与结论
丑数问题的核心在于高效生成有序丑数序列。各题解主要采用动态规划维护指针数组、优先队列/堆、平衡树等数据结构。最优解为动态规划法，通过维护每个质数对应的最小候选丑数索引，以O(nk)时间效率实现，避免了重复计算。

---

### 高星题解推荐

#### 1. 作者：Mark_ZZY（⭐⭐⭐⭐⭐）
**关键亮点**  
- 动态规划+指针数组：每个质数维护当前可乘的最小丑数索引  
- O(nk)时间复杂度，空间O(n+k)，最优效率  
- 代码简洁清晰，无需复杂数据结构  

**核心代码**  
```cpp
int s[100001], b[101];
for(int i=1; i<=m; i++) {
    int min=INT_MAX;
    for(int j=1; j<=n; j++) {
        while(a[j]*s[b[j]] <= s[i-1]) b[j]++;
        if(a[j]*s[b[j]] < min) min = a[j]*s[b[j]];
    }
    s[i] = min;
}
```

#### 2. 作者：Celebrate（⭐⭐⭐⭐⭐）
**关键亮点**  
- 相同动态规划思路，变量命名更直观  
- 明确解释指针数组的物理意义  
- 强调通过单调性优化避免重复计算  

**核心片段**  
```cpp
int p[maxn]; // 质数指针数组
for(int i=1; i<=n; i++){
    ll min_val = a[p[1]] * primes[1];
    for(int j=2; j<=k; j++)
        min_val = min(min_val, a[p[j]] * primes[j]);
    for(int j=1; j<=k; j++)
        if(min_val == a[p[j]] * primes[j]) p[j]++;
    a[i] = min_val;
}
```

#### 3. 作者：muyang_233（⭐⭐⭐⭐）  
**个人心得**  
"BFS需要结合Treap优化，但动态规划才是正解。单调性保证了指针只需递增，无需回溯。"  

**核心技巧**  
- 三指针法通过单次遍历找最小值  
- 利用丑数序列的严格递增特性  

---

### 关键思路总结
**动态规划+指针数组**  
1. 初始化丑数数组`s[0]=1`，每个质数对应指针`b[j]=0`  
2. 每次遍历所有质数，计算当前质数可生成的最小候选值`a[j]*s[b[j]]`  
3. 选取所有候选值中的最小值作为新丑数  
4. 更新产生该最小值对应的质数指针`b[j]++`  

**优化本质**：利用丑数序列的严格单调性，确保每个质数的指针只需单向移动，避免重复计算。

---

### 拓展与相似题目
1. **合并K个有序链表**（同最小值选取思想） - [P1090 合并果子](https://www.luogu.com.cn/problem/P1090)  
2. **超级丑数变种** - [LeetCode 313. Super Ugly Number](https://leetcode.com/problems/super-ugly-number/)  
3. **多指针动态规划应用** - [P2723 丑数 Humble Numbers](https://www.luogu.com.cn/problem/P2723)（本题加强版）

---
处理用时：66.03秒
# 题目信息

# [蓝桥杯 2017 国 A] 填字母游戏

## 题目描述

小明经常玩 LOL 游戏上瘾，一次他想挑战 K 大师，不料 K 大师说：

“我们先来玩个空格填字母的游戏，要是你不能赢我，就再别玩 LOL 了”。

K 大师在纸上画了一行 $n$ 个格子，要小明和他交替往其中填入字母。

并且：

1. 轮到某人填的时候，只能在某个空格中填入 `L` 或 `O`。

2. 谁先让字母组成了 `LOL` 的字样，谁获胜。

3. 如果所有格子都填满了，仍无法组成 `LOL`，则平局。

小明试验了几次都输了，他很惭愧，希望你能用计算机帮他解开这个谜。

## 说明/提示

时限 1 秒, 256M。蓝桥杯 2017 年第八届国赛

## 样例 #1

### 输入

```
4
***
L**L
L**L***L
L*****L```

### 输出

```
0
-1
1
1```

# AI分析结果



### 综合分析与结论
本题核心是博弈论中的必胜态分析，结合记忆化搜索优化。所有题解均采用递归+记忆化搜索框架，核心差异在于剪枝策略和状态判断逻辑。最优解法通过预处理必胜模式（LO*、L*L、*OL）实现快速剪枝，极大减少递归深度。

---

### 精选题解（4星及以上）

#### 1. 作者：Mu_shao（4.5星）
**关键亮点**：
- 预处理三种必胜模式快速剪枝
- 记忆化逻辑清晰，代码可读性强
- 胜负状态转换处理准确
**核心代码**：
```cpp
int win(string str){
    if (str.find("LO*") != -1 || str.find("L*L") != -1 || str.find("*OL") != -1)
        return 1;
    // ... (递归部分与Nightsky_Stars类似但加入额外剪枝)
}
```

#### 2. 作者：Nightsky_Stars（4星）
**关键亮点**：
- 最简框架实现博弈树搜索
- 正确处理平局优先级（能平则平）
**代码片段**：
```cpp
int check(){
    if(s.find("LOL")!=-1) return -1;
    bool res = false;
    for(每个空位){
        s[i] = 'L';
        if(check() == -1) return 1; // 对手输则自己赢
        s[i] = 'O'; // 同理
    }
    return res ? 0 : -1;
}
```

#### 3. 作者：dyc2022（4星）
**创新点**：
- 三进制哈希优化状态存储
- 胜负状态决策树实现完整
**优化亮点**：
```cpp
int ha(string x){ // 将字符串转为三进制数
    int sum = 0;
    for(char c : x) sum = sum*3 + (c=='L'?1:c=='O'?2:0);
    return sum;
}
```

---

### 关键思路总结
1. **必胜模式剪枝**：提前检测可一步致胜的模式（LO*、L*L、*OL）
2. **记忆化方向**：用字符串或哈希值作为状态键，存储三种游戏状态（1/0/-1）
3. **博弈树遍历**：深度优先搜索+负值最大原则（对手的必败即自己的必胜）

---

### 拓展建议
同类问题可考虑：
1. 状态压缩博弈（如棋盘覆盖问题）
2. 有限状态自动机判断
3. 对抗搜索α-β剪枝优化

推荐练习：
1. [P1249 取石子游戏](https://www.luogu.com.cn/problem/P1249)
2. [P1510 石头剪刀布](https://www.luogu.com.cn/problem/P1510)（状态预测）
3. [P2734 [USACO3.3] 游戏](https://www.luogu.com.cn/problem/P2734)

---

### 题解心得摘录
- Mu_shao：发现三种必胜模式后，"直接判胜节省大量递归，这个优化让原本TLE的代码AC"
- dyc2022："用三进制哈希代替map后，运行时间从1.2s降到0.3s，字符串处理是性能瓶颈"
- 封禁用户："最初忘记处理对手的必胜情况，WA了三次才发现状态转换方向错误"

---
处理用时：71.05秒
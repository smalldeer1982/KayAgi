# 题目信息

# [NOIP 2009 普及组] 细胞分裂

## 题目描述

Hanks 博士是 BT（Bio-Tech，生物技术）领域的知名专家。现在，他正在为一个细胞实验做准备工作：培养细胞样本。

Hanks 博士手里现在有 $N$ 种细胞，编号从 $1 \sim N$，一个第 $i$ 种细胞经过 $1$ 秒钟可以分裂为 $S_i$ 个同种细胞（$S_i$ 为正整数）。现在他需要选取某种细胞的一个放进培养皿，让其自由分裂，进行培养。一段时间以后，再把培养皿中的所有细胞平均分入 $M$ 个试管，形成 $M$ 份样本，用于实验。Hanks 博士的试管数 $M$ 很大，普通的计算机的基本数据类型无法存储这样大的 $M$ 值，但万幸的是，$M$ 总可以表示为 $m_1$ 的 $m_2$ 次方，即 $M = m_1^{m_2}$，其中 $m_1,m_2$ 均为基本数据类型可以存储的正整数。

注意，整个实验过程中不允许分割单个细胞，比如某个时刻若培养皿中有 $4$ 个细胞，Hanks 博士可以把它们分入 $2$ 个试管，每试管内 $2$ 个，然后开始实验。但如果培养皿中有 $5$ 个细胞，博士就无法将它们均分入 $2$ 个试管。此时，博士就只能等待一段时间，让细胞们继续分裂，使得其个数可以均分，或是干脆改换另一种细胞培养。

为了能让实验尽早开始，Hanks 博士在选定一种细胞开始培养后，总是在得到的细胞“刚好可以平均分入 $M$ 个试管”时停止细胞培养并开始实验。现在博士希望知道，选择哪种细胞培养，可以使得实验的开始时间最早。


## 说明/提示

【输入输出样例 \#1 说明】

经过 $1$ 秒钟，细胞分裂成 $3$ 个，经过 $2$ 秒钟，细胞分裂成 $9$个，……，可以看出无论怎么分裂，细胞的个数都是奇数，因此永远不能分入 $2$ 个试管。

【输入输出样例 \#2 说明】

第 $1$ 种细胞最早在 $3$ 秒后才能均分入 $24$ 个试管，而第 $2$ 种最早在 $2$ 秒后就可以均分（每试管 $144 / {24}^1 = 6$ 个）。故实验最早可以在 $2$ 秒后开始。

【数据范围】

对于 $50 \%$ 的数据，有 $m_1^{m_2} \le 30000$。

对于所有的数据，有 $1 \le N \le 10000$，$1 \le m_1 \le 30000$，$1 \le m_2 \le 10000$，$1 \le S_i \le 2 \times {10}^9$。


NOIP 2009 普及组 第三题


## 样例 #1

### 输入

```
1 
2 1 
3
```

### 输出

```
-1
```

## 样例 #2

### 输入

```
2
24 1
30 12
```

### 输出

```
2
```

# AI分析结果

### 综合分析与结论

本题的核心在于通过质因数分解来处理大数问题，避免直接计算 $m_1^{m_2}$ 的数值。各题解的思路基本一致，即通过分解 $m_1$ 的质因数，并利用 $m_2$ 来调整质因数的指数，然后对每个细胞的 $S_i$ 进行质因数分解，判断是否包含 $m_1$ 的所有质因数，并计算所需的最小时间 $k$。不同题解在实现细节上有所差异，如质因数分解的方式、代码的简洁性、以及是否进行优化等。

### 所选高星题解

#### 1. **作者：暗ざ之殇 (5星)**
   - **关键亮点**：通过递归求解最大公约数，逐步化简问题，最终将问题转化为求最小的 $n$ 使得某个式子成立。思路清晰，代码实现简洁且高效。
   - **个人心得**：作者通过逐步分解问题，最终将复杂的问题简化为求最小 $n$ 的问题，展示了递归思维在解决复杂问题中的强大作用。
   - **核心代码**：
     ```cpp
     while(m!=1)
     {
         gcdd=gcd(m,s);                //第一小步，求最大公约数 
         if(gcdd==1) {flag=0;break;}   //如果互质，那么肯定无解，直接跳出 
         m/=gcdd;                      //左边剩下了m/gcdd 
         q=s/gcdd;                     //q就是s除以gcdd后剩下的数 
         s=gcdd;                       //右边剩下了gcdd         
         t++;                          //每进入一次循环，就要多减1个m2   
     }
     ```

#### 2. **作者：刘心远 (4星)**
   - **关键亮点**：通过质因数分解，直接计算每个细胞所需的最小时间，思路清晰，代码简洁。
   - **核心代码**：
     ```cpp
     for(int i=1;i<=n;i++)
     {
         cin>>cell; j=1; now=0; here=true;  //初始化
         memset(cell_prime,0,sizeof(cell_prime));  //初始化，加头文件cstring
         while(j<=sum_prime)  //大于30000的质因子忽略，即在30000内质因数分解
         {
             if(cell%prime[j]==0)
             while(cell%prime[j]==0)
             {cell_prime[j]++; cell/=prime[j]; }
             j++;
         }
         for(j=1;j<=sum_prime;j++)
         {
             if(pipe_prime[j]!=0&&cell_prime[j]==0)here=false;  //如果细胞没有试管所拥有的质因子，该细胞不可用
             if(pipe_prime[j]!=0&&cell_prime[j]!=0)  //如果试管没有该质因子，不用做
             {
                 if(pipe_prime[j]%cell_prime[j]==0)
                 now=max(now,pipe_prime[j]/cell_prime[j]);
                 else now=max(now,pipe_prime[j]/cell_prime[j]+1);  //记得要+1，整除时不用加
             }
         }
         if(here){flag=true; if(now<minn)minn=now;}  //如果该细胞可行，做个标志，替换
     }
     ```

#### 3. **作者：7KByte (4星)**
   - **关键亮点**：通过质因数分解，直接计算每个细胞所需的最小时间，代码简洁且易于理解。
   - **核心代码**：
     ```cpp
     for(int i=1;i<=n;i++){
         cin>>s[i];
         zys2(s[i]);
         bool fl=true;
         int sum=0;
         for(int j=1;j<=cnt;j++)
         {
             if(numm[is_prime[j]]&&!numa[is_prime[j]])
             {
                 fl=false;
                 break;
             }
             if(numa[is_prime[j]])
             {
                 sum=max(sum,numm[is_prime[j]]/numa[is_prime[j]]+(numm[is_prime[j]]%numa[is_prime[j]]?1:0));
             }
         }
         if(fl)
         {
             mn=min(mn,sum);
             flag=true;
         }
         memset(numa,0,sizeof(numa));
     }
     ```

### 最优关键思路与技巧

1. **质因数分解**：通过分解 $m_1$ 和 $S_i$ 的质因数，避免直接计算大数，简化问题。
2. **递归思维**：通过递归求解最大公约数，逐步化简问题，最终将复杂问题转化为简单的求最小 $n$ 的问题。
3. **优化计算**：通过提前分解质因数，减少重复计算，提高代码效率。

### 可拓展之处

- **类似问题**：其他涉及大数分解或幂运算的问题，如判断一个数是否为另一个数的幂、计算大数的质因数等。
- **算法套路**：质因数分解、递归思维、优化计算等技巧在其他数学问题中也有广泛应用。

### 推荐题目

1. **P1072 [NOIP2009 提高组] Hankson 的趣味题**：考察质因数分解与最大公约数的应用。
2. **P1068 [NOIP2009 普及组] 分数线划定**：考察排序与统计，适合练习基础算法。
3. **P1070 [NOIP2009 提高组] 道路游戏**：考察动态规划与贪心算法，适合练习复杂问题的分解与优化。

---
处理用时：38.50秒
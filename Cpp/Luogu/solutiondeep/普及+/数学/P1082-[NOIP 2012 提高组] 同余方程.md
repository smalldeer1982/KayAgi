# 题目信息

# [NOIP 2012 提高组] 同余方程

## 题目描述

求关于 $ x$ 的同余方程 $ a x \equiv 1 \pmod {b}$ 的最小正整数解。


## 说明/提示

### 数据规模与约定

- 对于 $40\%$ 的数据，$2 ≤b≤ 1,000$；
- 对于 $60\%$ 的数据，$2 ≤b≤ 50,000,000$；
- 对于 $100\%$ 的数据，$2 ≤a, b≤ 2,000,000,000$。



## 样例 #1

### 输入

```
3 10```

### 输出

```
7```

# AI分析结果

### 综合分析与结论

本题要求解同余方程 $ax \equiv 1 \pmod{b}$ 的最小正整数解，本质上是求 $a$ 在模 $b$ 意义下的乘法逆元。题解中主要采用了两种思路：**扩展欧几里得算法（exgcd）**和**欧拉定理结合快速幂**。扩展欧几里得算法是解决此类问题的标准方法，适用于任意 $a$ 和 $b$ 互质的情况，而欧拉定理方法则要求 $b$ 为质数或与 $a$ 互质。

大部分题解都采用了扩展欧几里得算法，思路清晰且代码简洁，适合初学者理解和实现。少数题解使用了欧拉定理，虽然思路新颖，但实现复杂度较高，且适用范围有限。

### 所选高星题解

#### 1. **学委 (5星)**
- **关键亮点**：详细推导了扩展欧几里得算法的过程，解释了如何将同余方程转化为线性方程，并给出了递归求解的完整思路。代码简洁，处理了负数解的情况，确保了最小正整数解的输出。
- **个人心得**：作者强调了递归求解的核心思想，并通过数学推导展示了如何从递归边界逐步回溯求解，帮助读者深入理解算法。
- **核心代码**：
```cpp
void exgcd(long long a, long long b) {
    if (b == 0) {
        x = 1; y = 7; // y=7能AC，证明了最后一个等式不受最后一个y影响
        return;
    }
    exgcd(b, a % b);
    long long tx = x;
    x = y;
    y = tx - a / b * y;
}
```
- **代码思想**：通过递归求解 $ax + by = \gcd(a, b)$，最终得到 $x$ 和 $y$，并通过取模操作确保 $x$ 为最小正整数解。

#### 2. **_Nova (4.5星)**
- **关键亮点**：详细介绍了扩展欧几里得算法的数学原理，并给出了递归求解的推导过程。代码实现简洁，处理了负数解的情况。
- **核心代码**：
```cpp
void exgcd(int a, int b, int &x, int &y) {
    if (b == 0) {
        x = 1; y = 0;
        return;
    }
    exgcd(b, a % b, y, x);
    y -= a / b * x;
}
```
- **代码思想**：通过递归求解 $ax + by = \gcd(a, b)$，并在回溯时更新 $x$ 和 $y$，最终通过取模操作确保 $x$ 为最小正整数解。

#### 3. **HasNoName (4星)**
- **关键亮点**：简洁明了地介绍了扩展欧几里得算法的实现，并给出了递归求解的核心代码。代码简洁，处理了负数解的情况。
- **核心代码**：
```cpp
void exgcd(int a, int b, int &x, int &y) {
    if (b == 0) {
        x = 1; y = 0;
        return;
    }
    exgcd(b, a % b, y, x);
    y -= a / b * x;
}
```
- **代码思想**：通过递归求解 $ax + by = \gcd(a, b)$，并在回溯时更新 $x$ 和 $y$，最终通过取模操作确保 $x$ 为最小正整数解。

### 最优关键思路与技巧
1. **扩展欧几里得算法**：将同余方程转化为线性方程 $ax + by = \gcd(a, b)$，通过递归求解并回溯更新 $x$ 和 $y$，最终通过取模操作确保 $x$ 为最小正整数解。
2. **负数解处理**：通过 `x = (x % b + b) % b` 确保 $x$ 为最小正整数解，避免负数或过大值。

### 拓展思路与类似题目
1. **类似题目**：
   - [P3811 模意义下的乘法逆元](https://www.luogu.com.cn/problem/P3811)
   - [P2613 有理数取余](https://www.luogu.com.cn/problem/P2613)
   - [P5656 二元一次不定方程](https://www.luogu.com.cn/problem/P5656)

2. **拓展思路**：扩展欧几里得算法不仅可以用于求解逆元，还可以用于求解线性同余方程、二元一次不定方程等问题，是数论中的重要工具。

---
处理用时：30.84秒
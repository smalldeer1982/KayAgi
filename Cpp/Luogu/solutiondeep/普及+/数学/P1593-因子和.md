# 题目信息

# 因子和

## 题目描述

输入两个整数 $a$ 和 $b$，求 $a^b$ 的因子和。

由于结果太大，只要输出它对 $9901$ 取模的结果。

## 说明/提示

#### 数据规模与约定

对于全部的测试点，保证 $1 \leq a \leq 5 \times 10^7$，$0 \leq b \leq 5 \times 10^7$。

## 样例 #1

### 输入

```
2 3```

### 输出

```
15```

# AI分析结果

### 综合分析与结论

本题的核心是求 \(a^b\) 的因子和对 9901 取模的结果。由于 \(a\) 和 \(b\) 的范围较大，直接暴力计算不可行。因此，大多数题解都采用了质因数分解结合等比数列求和的思路，并通过快速幂和逆元来优化计算过程。部分题解还提到了在处理逆元不存在时的特判，确保算法的正确性。

### 所选高质量题解

#### 1. 作者：C_Cong (赞：377)
- **星级**：★★★★★
- **关键亮点**：
  - 详细解释了质因数分解和等比数列求和的数学原理。
  - 通过快速幂和费马小定理求逆元，优化了计算过程。
  - 特别处理了逆元不存在的情况，确保算法的鲁棒性。
- **个人心得**：
  - 作者强调了逆元不存在时的特判，提醒读者注意这一边界情况。
- **核心代码**：
  ```cpp
  int sum(int x, int y) {
      int k = 0;
      y = y * b;
      if (x % mod == 1) {
          k = (y + 1) % mod; // 当逆元不存在时
      } else {
          k = (quick_pow(x % mod, y + 1) - 1) % mod * quick_pow((x - 1) % mod, mod - 2) % mod; // 当逆元存在时
      }
      return k % mod;
  }
  ```

#### 2. 作者：小老虎3018 (赞：53)
- **星级**：★★★★
- **关键亮点**：
  - 清晰地解释了等比数列求和公式的使用。
  - 通过快速幂和逆元优化了计算过程。
  - 强调了逆元不存在时的特判，确保算法的正确性。
- **核心代码**：
  ```cpp
  ll sum(int x, int y) {
      if (x % mod == 1) return (y + 1) % mod;
      return (quick_pow(x, y + 1) - 1) % mod * quick_pow(x - 1, mod - 2) % mod;
  }
  ```

#### 3. 作者：Leap_Frog (赞：50)
- **星级**：★★★★
- **关键亮点**：
  - 简洁地实现了质因数分解和等比数列求和。
  - 通过快速幂和费马小定理求逆元，优化了计算过程。
  - 特别处理了逆元不存在的情况，确保算法的鲁棒性。
- **核心代码**：
  ```cpp
  inline int qpow(int x, int q = mod - 2) {
      int r = 1;
      for (; q; q >>= 1, x = x * x % mod) if (q & 1) r = r * x % mod;
      return (r + mod) % mod;
  }
  ```

### 最优关键思路与技巧

1. **质因数分解**：将 \(a\) 分解为质因数的乘积，便于后续计算。
2. **等比数列求和**：利用等比数列求和公式计算每个质因数的贡献。
3. **快速幂与逆元**：通过快速幂和费马小定理求逆元，优化计算过程。
4. **特判逆元不存在**：当 \(p_i \mod 9901 = 1\) 时，直接计算等比数列的和为 \(n + 1\)。

### 可拓展之处

- **同类型题**：类似的问题可以扩展到求多个数的因子和，或者求其他数论函数的值。
- **算法套路**：质因数分解结合快速幂和逆元的思路可以应用于其他需要处理大数模运算的问题。

### 推荐题目

1. **P1226 【模板】快速幂** - 练习快速幂的实现。
2. **P3811 【模板】乘法逆元** - 练习逆元的计算。
3. **P1069 质因数分解** - 练习质因数分解的应用。

### 个人心得总结

- **调试经历**：多位作者提到在处理逆元不存在时的特判，这是确保算法正确性的关键。
- **踩坑教训**：部分作者在初版代码中忽略了逆元不存在的情况，导致WA，提醒读者注意边界情况。
- **顿悟感想**：通过质因数分解和等比数列求和，可以将复杂的问题简化为多个小问题的组合，这是解决数论问题的常用思路。

---
处理用时：30.89秒
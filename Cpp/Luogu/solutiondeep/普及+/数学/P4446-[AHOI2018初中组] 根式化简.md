# 题目信息

# [AHOI2018初中组] 根式化简

## 题目描述

小可可在学习“立方根”的知识时碰到这样的问题：

将下面根式化简为最简根式：

(1) $\sqrt[3]{125}$ (2) $\sqrt[3]{81}$ (3) $\sqrt[3]{52}$

这个问题对于小可可来说太简单了，他很快就算出了答案：

(1) $5$ (2) 3$\sqrt[3]{3}$ (3) $\sqrt[3]{52}$

小可可知道任意形如$\sqrt[3]{x}$ 的根式，化简后一定可以被写成形如$a\sqrt[3]{b}$的最简根式。他觉得这很有趣，就仿照出了不少题，但没一会儿就被密密麻麻的根式绕晕了，于是他向你求助：

给定 $n$ 个形如 $\sqrt[3]{x}$ 的根式，请你将它们化简为形如$a\sqrt[3]{b}$的最简形式，为了方便，你只需要输出其中的$a$ 即可。

如果你没有学过这部分数学知识，你可以认为题意是：给你$n$ 个正整数$x$，对于每一个$x$，你需要求出整数$a,b$ 使得$a^3 \times b = x$，输出最大的整数$a$ 即可。

## 说明/提示

对于100%的数据满足：$1≤n≤10000$，$1≤x≤10^{18}$。

本题共10 个测试点，编号为1~10，每个测试点额外保证如下：

测试点编号n 的范围x 的范围  
1~2 $n≤10, x≤10^6$  
3~4 $n≤10, x≤10^9$  
5~6 $n≤100, x≤10^{18}$ 且$x$ 为完全立方数  
7~8 $n≤500, x≤10^{18}$  
9~10 $n≤10000, x≤10^{18}$

## 样例 #1

### 输入

```
3
125 81 52```

### 输出

```
5
3
1```

# AI分析结果



### 综合分析结论
各题解核心思路统一：预处理 $x^{\frac{1}{4}}$ 范围内的素数，筛去小因子后判断剩余部分是否为立方数。关键优化在于素数范围选择与二分判断立方数。多数题解采用线性筛法预处理素数，处理每个质因子时累计次数，最终结合二分查找完成剩余立方判断。

---

### 精选题解与评分

#### 1. 作者：hongzy（★★★★☆）
**关键亮点**  
- 严格数学证明筛法有效性，预处理素数到 $31650$ 的边界清晰  
- 代码结构简洁，预处理立方表避免重复计算  
- 使用 `lower_bound` 高效判断立方数  

**核心代码片段**  
```cpp
for(int i=1; i<=cnt && plist[i] <= x; i++){
    c = 0;
    while(x % plist[i] == 0){
        c++; x /= plist[i];
        if(c == 3) ans *= plist[i], c = 0;
    }
}
LL k = lower_bound(pow3+1, pow3+m+1, x) - pow3;
printf("%lld\n", ans*(k*k*k == x ? k : 1));
```

#### 2. 作者：KesdiaelKen（★★★★☆）
**关键亮点**  
- 详细推导筛法边界与分情况讨论  
- 采用线性筛法优化素数生成效率  
- 代码中预计算立方根减少二分范围  

**核心代码片段**  
```cpp
for(int i=1; i<=gs && zs[i] <= bj; i++){
    b=0;
    while(shu%zs[i]==0){
        shu/=zs[i];b++;
        if(b%3==0)a*=zs[i];
    }
}
b=scf(shu); if(b*b*b==shu)a*=b;
```

#### 3. 作者：ziiidan（★★★★☆）
**关键亮点**  
- 代码注释详细，适合新手理解数论逻辑  
- 使用埃氏筛法预处理素数，代码可读性强  
- 通过 `tot` 变量动态统计质因子次数  

**核心代码片段**  
```cpp
for(int i=1; i <= cnt && prime[i] <= x; i++) {
    while(x % prime[i] == 0) {
        x /= prime[i]; tot++;
        if(tot == 3) ans *= prime[i], tot = 0;
    }
}
int pos = lower_bound(p +1, p +maxn-4, x) - p;
if(p[pos] == x) ans *= pos;
```

---

### 最优思路总结
1. **四次方根筛法**：预处理 $x^{\frac{1}{4}}$ 内素数，筛去所有小因子后剩余数最多含有一个大质数的立方。
2. **立方数快速判断**：预处理 $10^6$ 内的立方数组，使用二分查找验证剩余值。
3. **质因子动态累计**：每累计三个相同质因子即乘入答案，保证分解高效性。

---

### 拓展与同类题目
**相似套路题型**  
- **质因数分解优化**：P1075（质因数分解）、P1069（细胞分裂）  
- **大数边界处理**：P1029（最大公约数问题）  
- **数学筛法应用**：P3383（线性筛素数）

**调试心得摘录**  
- Adrien_Mertens：通过多次尝试发现素数筛范围与立方验证的关键性，强调边界测试的重要性。  
- critnos：通过剪枝提前终止循环（如筛到 $x^{\frac{1}{4}}$ 后立即判断剩余立方），将耗时从800ms优化至166ms。

---
处理用时：65.76秒
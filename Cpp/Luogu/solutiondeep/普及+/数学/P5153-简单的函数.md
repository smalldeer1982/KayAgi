# 题目信息

# 简单的函数

## 题目背景

此题为改编题，特别鸣谢吴作凡同学。


## 题目描述

HKE 有一次发现了一个很有趣的函数。

定义 $f(2)=1$。对于 $n\geq3$，设 $t$ 为最小的使得 $n$ 不能被 $t$ 整除的正整数，则 $f(n)=f(t)+1$。

举个栗子。比如 $n=6$，此时 $t=4$，$f(6)=f(4)+1=f(3)+2=f(2)+3=4$。

现在，HKE 想知道 $f(2)\times f(3)\times\cdots\times f(n)$ 是多少？答案可能很大，请对 $10^9+7$ 取模。


## 说明/提示

对于 $30\%$ 的数据，$n\leq1000$；

对于 $50\%$ 的数据，$n\leq1000000$；

对于 $100\%$ 的数据，$n\leq10^{18}$。


## 样例 #1

### 输入

```
4```

### 输出

```
6```

# AI分析结果



### 综合分析与结论
本题关键在于发现函数$f(n)$的取值规律，并高效统计各值出现次数。由于$n$极大（1e18），需利用数学性质将问题转化为统计不同$f(n)$值的数目，通过快速幂计算结果。题解主要分为两类思路：  
1. **预处理lcm+容斥**：计算各$t$对应的$f(t)$，统计满足$lcm(1..t-1)\mid x$且$lcm(1..t)\nmid x$的$x$数量。  
2. **分类讨论$f(n)$取值**：发现$f(n)\leq4$，构造不同条件统计次数。  

### 精选题解与评分

#### 1. _ztyqwq 的题解（⭐⭐⭐⭐⭐）
**关键亮点**：  
- 发现$f(n)\leq4$，通过数学证明简化问题。  
- 利用$t=2^i$的性质，预处理关键lcm值快速统计$f(n)=4$的情况。  
- 代码简洁高效，时间复杂度$O(1)$。  

**核心思路**：  
- $f(n)=2$对应奇数；$f(n)=3$为偶数且不满足特殊条件；$f(n)=4$需满足$n\equiv g_a\pmod{2g_a}$，其中$g_a$为预处理lcm值。  
- 统计各情况数量后快速幂计算结果。  

**代码实现**：  
```cpp
#include <bits/stdc++.h>
using namespace std;
#define int long long
int mod = 1000000007;
inline int fastpow(int a, int n) {
    int ans = 1;
    while(n) {
        if(n & 1) ans = ans * a % mod;
        a = a * a % mod;
        n >>= 1;
    }
    return ans;
}
int a[] = {0, 6, 420, 360360, 72201776446800ll};
signed main() {
    int n;
    scanf("%lld", &n);
    int p3 = n / 2, p2 = n - p3, p4 = 0; 
    for(int i = 1; i <= 4; i++)
        if(n >= a[i])
            p4 += (n + a[i]) / (2 * a[i]);
    int ans = fastpow(2, p2 - 1) * fastpow(3, p3 - p4 - 1) % mod * fastpow(4, p4) % mod; 
    printf("%lld\n", ans);
    return 0;
}
```

#### 2. Caro23333 的题解（⭐⭐⭐⭐）
**关键亮点**：  
- 预处理$f(2..42)$，利用lcm性质统计各$t$对应数量。  
- 通过容斥计算满足条件的$x$数目。  

**核心思路**：  
- 计算前缀lcm，统计每个$t$对应的数数量。  
- 预处理$f$值后，累加各$f$值出现次数。  

**代码片段**：  
```cpp
for(int i = 2; i<=pos; i++)
    cnt[f[i]+1] += calc(pos+1,n,lcm[i-1])-calc(pos+1,n,lcm[i]);
// ...快速幂计算乘积
```

#### 3. George_Je 的题解（⭐⭐⭐）
**关键亮点**：  
- 类似_ztyqwq的分类讨论，但更详细数学推导。  
- 预处理$g$数组快速统计$f(n)=4$的情况。  

**核心思路**：  
- 通过数学证明$f(n)\leq4$，构造$g_a$条件统计数量。  

### 最优思路总结
1. **关键性质**：$f(n)\leq4$，奇数$f(n)=2$，偶数分情况讨论。  
2. **数学构造**：利用$lcm(1..2^i-1)$构造条件，统计$f(n)=4$的数目。  
3. **快速幂优化**：统计各幂次后快速计算乘积。  

### 拓展与相似题目
- **类似知识点**：lcm性质、数论分块、快速幂、函数递推规律。  
- **推荐题目**：  
  1. [P1891 疯狂的lcm](https://www.luogu.com.cn/problem/P1891)  
  2. [P2158 能量采集](https://www.luogu.com.cn/problem/P2158)（数论分块）  
  3. [P2260 模积和](https://www.luogu.com.cn/problem/P2260)（分块与快速幂结合）

---
处理用时：83.67秒
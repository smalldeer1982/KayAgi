# 题目信息

# [清华集训 2015] 灯泡

## 题目背景

$2022$ 年，评测数据发生了翻天覆地的变化，请 $2022$ 年前通过此题的人重新交一遍。

## 题目描述

相比 Wildleopard 的家，他的弟弟 Mildleopard 比较穷。他的房子是狭窄的，而且在他的房间里仅有一个灯泡。每天晚上，他徘徊在自己狭小的房子里，思考如何赚更多的钱。有一天，他发现他的影子的长度随着他在灯泡和墙壁之间走动时会发生变化。一个突然的想法出现在他的脑海里，他想知道在房间里他的影子的最大长度。

![](https://cdn.luogu.com.cn/upload/image_hosting/i78578mk.png)

## 说明/提示

$1\le T \le 100,0.01 \le H,h,D \le 1000,H-h\ge 0.01$，保证 $H,h,D$ 最多由 $6$ 位小数构成。

## 样例 #1

### 输入

```
3
2 1 0.5
2 0.5 3
4 3 4```

### 输出

```
1.000
0.750
4.000```

# AI分析结果



### 综合分析与结论
本题核心在于建立几何模型，将影子长度转化为分段函数，进而通过数学分析或三分法求解极值。关键难点在于分类讨论（地面影子与墙面影子的分界）及对单峰函数极值的快速求解。

---

### 精选题解与评分

#### 1. yangrunze 题解（⭐⭐⭐⭐⭐）
**关键亮点**：  
- 完整数学推导，配图辅助理解分类讨论  
- 结合对勾函数与基本不等式进行极值分析  
- 给出动态图演示函数形态，直观展示极值变化  
**核心思路**：  
将影子分为地面段和墙面段，建立分段函数。利用对勾函数性质求得极值点，并判断极值点是否在定义域内。  
**代码思想**：  
数学推导后直接计算三种情况的最大值：
```cpp
double l = H - sqrt((H-h)*D);
if (l < 0) l = 0;
if (l > h) l = h;
printf("%.3lf\n", l + (h-l)*D/(H-l));
```

#### 2. iuyi 题解（⭐⭐⭐⭐）
**关键亮点**：  
- 求导法精确找到极值点，代码简洁高效  
- 数学推导清晰，直接处理关键约束条件  
**核心思路**：  
设墙上影子长度 $l$，建立 $L = l + \frac{(h-l)D}{H-l}$，求导后解得极值点 $l = H - \sqrt{D(H-h)}$，验证其合法性后代入计算。  
**代码亮点**：  
极简实现，仅需判断极值点是否在 $[0, h]$ 区间内：
```cpp
double l = H - sqrt((H-h)*D);
l = clamp(l, 0.0, h);
printf("%.3lf\n", l + (h-l)*D/(H-l));
```

#### 3. do_while_false 题解（⭐⭐⭐）
**关键亮点**：  
- 三分法模板化实现，适合不熟悉数学推导的选手  
- 通过函数形态分析验证单峰性，降低思维难度  
**代码思想**：  
三分区间内对影子长度函数进行极值搜索，利用黄金分割法逼近最优解：
```cpp
double three_cut() {
    double l=0, r=D;
    while(r-l>eps) {
        double m1 = l + (r-l)/3;
        double m2 = r - (r-l)/3;
        if(f(m1) > f(m2)) r = m2;
        else l = m1;
    }
    return f(l);
}
```

---

### 最优关键思路与技巧
1. **数学建模优先**：通过相似三角形建立分段函数，优先尝试求导或不等式找极值，避免三分法的精度与效率问题。  
2. **对勾函数特性**：形如 $ax + b/x$ 的函数，极值点必为 $\sqrt{b/a}$，需结合定义域判断。  
3. **边界条件验证**：极值点需严格验证是否在合法区间内（如 $x \in [D(H-h)/H, D]$）。  

---

### 拓展与举一反三
1. **类似题型**：  
   - 单峰函数极值问题（P3382 三分法模板）  
   - 几何模型与极值结合（P2571 [SCOI2010] 传送带）  
   - 动态系统最优解（P1883 函数最小值）  
2. **调试技巧**：  
   - 绘制函数图像验证单峰性（如用 Desmos）  
   - 输出中间变量检查极值点合法性  

---

### 推荐练习题
1. [P3382] 三分法模板  
2. [P1883] 函数极值（对勾函数变种）  
3. [P2571] 二维几何极值问题

---
处理用时：53.65秒
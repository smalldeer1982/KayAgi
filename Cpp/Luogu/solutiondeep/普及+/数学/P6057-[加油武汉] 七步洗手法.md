# 题目信息

# [加油武汉] 七步洗手法

## 题目背景

现在正处于疫情防控的关键时期，大家要经常洗手，防止接触感染。

[正确的洗手方法](https://dxy.com/column/4473)

## 题目描述

给定一张含有 $n$ 个点的无向完全图，其中 $m$ 条边是白边，其余是黑边。

现在需要你求出同色的三元环（或者说，三角形）的个数。

## 说明/提示

 - 对于 $20\%$ 的数据，满足 $n \leq 200$；
 - 对于 $50\%$ 的数据，满足 $n \leq 2000$；
 - 对于 $100\%$ 的数据，满足 $1 \leq n \leq 10^5,1 \leq m \leq 3\times 10^5$。

## 样例 #1

### 输入

```
5 3
1 5
2 5
3 5```

### 输出

```
4```

# AI分析结果



### 综合分析与结论
题目要求计算无向完全图中同色三元环的数量。直接暴力枚举时间复杂度不可行，所有题解均采用**补集思想**，即总三元环数减去异色三元环数。核心优化点在于如何高效计算异色三元环：通过统计每个顶点的异色角（白边与黑边的组合）数目，总和除以2即为异色三角形数目，时间复杂度为线性。

---

### 精选题解分析

#### 1. 未见堇开（⭐️⭐️⭐️⭐️⭐️）
**关键亮点**：  
- 补集转化思想清晰，公式推导简洁（异色角统计法）。  
- 代码极简，时间复杂度 $O(n)$，空间复杂度低。  
- 强调 `long long` 防止溢出，对数据范围敏感。

**核心代码**：
```cpp
for(reg int i=1;i<=n;i++)
    ans += (1ll*deg[i]*(n-1-deg[i])); // 异色角数目
printf("%lld", 1ll*n*(n-1)*(n-2)/6 - (ans>>1)); // 总 - 异色/2
```

#### 2. Star_Wind（⭐️⭐️⭐️⭐️）
**关键亮点**：  
- 与未见堇开思路一致，但代码更简练。  
- 使用 `vector` 存储白边邻接信息，直接统计每个点的度数。  
- 明确提示 `long long` 的重要性。

**核心代码**：
```cpp
for(register int i=1; i<=n; i++)
    sum += (v[i].size() * (n - v[i].size() - 1)); // 异色角计算
cout << (ll)n*(n-1)*(n-2)/6 - sum/2;
```

#### 3. _Freedom_（⭐️⭐️⭐️⭐️）
**关键亮点**：  
- 分步骤拆解问题，直观易懂（总数-白边贡献+重复修正）。  
- 通过动态维护相交白边数处理多减情况，复杂度 $O(n+m)$。  
- 详细图解辅助理解，适合初学者。

**核心代码**：
```cpp
for(i=1; i<=m; i++) {
    scanf("%lld%lld", &u, &v);
    ans += a[u] + a[v]; // 统计当前边与之前边的相交次数
    a[u]++, a[v]++;    // 更新白边度数
}
```

---

### 最优关键思路总结
1. **补集转化**：总三元环数 $C(n,3)$ 减去异色三元环数。
2. **异色角统计**：每个顶点的白边数 $w_i$ 与黑边数 $b_i$（$b_i = n-1-w_i$），异色角数目为 $w_i \times b_i$，总和除以2即为异色三角形数。
3. **时间复杂度优化**：将计算从 $O(n^3)$ 降为 $O(n)$，核心公式：
   \[
   \text{答案} = \frac{n(n-1)(n-2)}{6} - \frac{1}{2} \sum_{i=1}^n w_i(n-1-w_i)
   \]

---

### 拓展与举一反三
- **类似题型**：涉及补集思想的图论问题（如异色边计数、补图性质分析）。
- **算法套路**：组合数学公式转化、度数统计优化、动态维护相交边数。
- **推荐题目**：
  1. [P1989 无向图三元环计数](https://www.luogu.com.cn/problem/P1989)
  2. [CF615D Edge Coloring of Bipartite Graphs](https://codeforces.com/problemset/problem/615/D)（补图思想）
  3. [AT1219 歴史の研究](https://www.luogu.com.cn/problem/AT1219)（度数分治优化）

---

### 调试与踩坑教训
- **数据溢出**：必须使用 `long long` 存储结果（$n=1e5$ 时 $C(n,3) \approx 1e15$）。
- **完全图性质**：总边数为 $\frac{n(n-1)}{2}$，黑边数无需显式存储，通过白边数推导即可。

---
处理用时：63.78秒
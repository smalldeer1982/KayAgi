# 题目信息

# 齿轮

## 题目描述

Daniel13265 从不知哪里找来了 $n$ 个齿轮，第 $i$ 个齿轮的齿数为不超过 $m$ 的正整数 $a_i$。他现在想把其中 $k$ 个齿轮按照一定的方式拼接在一起。

当齿轮使用一段时间后，就会产生损耗。一个齿轮组的损耗速率是由这个齿轮组的所有齿轮齿数的最大公约数决定的：最大公约数越大，相同的齿之间啮合的频率就会增高，从而损耗的速率就会变快。这个最大公约数又被称为损耗因子。

算出一个齿轮组的损耗因子是很容易的。可是现在 Daniel13265 想要知道，对于可能拼接出的所有齿轮组的损耗因子。

Daniel13265 知道拼接出损耗因子大于 $m$ 的齿轮组是不可能的，而且由于可能拼出的齿轮组的个数很多，你只需要反过来告诉他对于所有的 $t\in[1, m]$，能够拼接出的损耗因子为 $t$ 的齿轮组的个数对 $10^9+7$ 取模后的结果即可。

## 说明/提示

### 样例解释

损耗因子为 $1$ 的齿轮组有 $(1,2),(1,3),(1,4),(1,6),(2,3),(3,4)$ 共 $6$ 个；  
损耗因子为 $2$ 的齿轮组有 $(2,4),(2,6),(4,6)$ 共 $3$ 个；  
损耗因子为 $3$ 的齿轮组有 $(3,6)$ 共 $1$ 个。

### 数据范围

**本题采用捆绑测试。你每通过一个子任务的所有数据点，就能得到该子任务的全部分数。**

| 子任务编号 | $n\le$ | $m\le$ | $k\le$ | 分值 |
|:-:|:-:|:-:|:-:|:-:|
| $1$ | $10$ | $10^6$ | $10$ | $10$ |
| $2$ | $10^3$ | $10^3$ | $10^3$ | $20$ |
| $3$ | $10^6$ | $10^3$ | $2$ | $5$ |
| $4$ | $10^6$ | $10^6$ | $1$ | $5$ |
| $5$ | $10^6$ | $10^6$ | $2$ | $20$ |
| $6$ | $10^6$ | $10^6$ | $10^6$ | $40$ |

对于 $100\%$ 的数据，满足 $1\le k\le n\le10^6$，$1\le a_i\le m\le10^6$。

## 样例 #1

### 输入

```
5 6 2
1 2 3 4 6
```

### 输出

```
6 3 1 0 0 0
```

# AI分析结果



### 综合分析与结论
本题核心是通过容斥原理或莫比乌斯反演处理数论组合计数问题。各题解均采用「预处理倍数出现次数→倒序容斥计算」的核心思路，其中**StudyingFather**的解法最为简洁高效，**Daniel13265**的官方题解思路最完备，而**FZzzz**的莫比乌斯反演解法提供了另一种数学视角。

---

### 高分题解推荐

#### 1. StudyingFather（⭐⭐⭐⭐⭐）
**关键亮点**：
- 思路清晰，代码简洁，直接定义g_i为倍数方案数
- 预处理组合数时使用阶乘逆元优化
- 倒序容斥实现仅需两重循环，时间复杂度O(m log m + n)

**核心代码**：
```cpp
for(int i=m;i;i--) {
    int cnt=0;
    for(int j=1;i*j<=m;j++) {
        cnt += t[i*j];
        g[i] = (g[i] - g[i*j] + MOD) % MOD;
    }
    g[i] = (g[i] + C(cnt, k)) % MOD;
}
```
**实现思想**：倒序枚举每个t，统计其倍数的总个数计算组合数，再减去更大的t的倍数结果。

#### 2. Daniel13265（⭐⭐⭐⭐）
**关键亮点**：
- 详细解释子任务过渡思路
- 给出不同数据范围的针对性优化策略
- 数学推导严谨，解释容斥原理的由来

**核心公式**：
$$f_t = \binom{cnt(t)}{k} - \sum_{t|i} f_i$$
其中cnt(t)为能被t整除的数的个数

#### 3. FZzzz（⭐⭐⭐⭐）
**独特价值**：
- 提供莫比乌斯反演解法思路
- 展示数论问题的不同数学工具应用
- 包含线性筛预处理μ函数优化

**核心代码**：
```cpp
for(int i=1;i<=m;i++) {
    ll ans=0;
    for(int j=1;i*j<=m;j++)
        ans = (ans + mu[j] * g[i*j]) % mod;
    printf("%d ",(int)ans);
}
```
**数学思想**：利用莫比乌斯函数性质 $f(x)=\sum_{x|d}\mu(d/x)g(d)$

---

### 最优关键思路总结
1. **预处理统计**：对每个数t，统计其倍数总个数cnt(t)
2. **组合数计算**：预处理阶乘逆元以快速计算C(cnt(t),k)
3. **倒序容斥**：从大到小枚举t，$ans[t] = C(cnt(t),k) - \sum_{i>t且t|i} ans[i]$
4. **复杂度优化**：通过调和级数性质将复杂度控制在O(m log m)

---

### 同类拓展题目
1. P2158 [SDOI2008] 仪仗队（欧拉函数与gcd计数）
2. P2522 [HAOI2011] Problem B（莫比乌斯反演应用）
3. P3312 [SDOI2014] 数表（数论组合+离线处理）

---

### 题解中的个人心得摘录
1. **Daniel13265**提到："实际运行时其复杂度达不到理论上界" → 理论分析时需考虑实际常数因子
2. **FZzzz**调试经验："这里会用到乘法逆元预处理组合数" → 强调数论题中逆元预处理的重要性
3. **Godzilla**代码注释："注意这里要倒序枚举" → 倒序处理是容斥的关键点，顺序错误会导致重复计算

---
处理用时：68.47秒
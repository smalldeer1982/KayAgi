# 题目信息

# [USACO23OPEN] Field Day S

## 题目描述

**提示：本题的 Python 时限为 15s。其它语言默认 2s。**

Farmer John 的 $N$ 个牛棚都会选出包含 $C$ 只奶牛的队伍去参加户外聚会。所有奶牛的品种都只可能是根西牛（`G`）或荷斯坦奶牛（`H`）。

我们将两个奶牛队伍中，同一位置对应的两头奶牛品种不同的所有位置 $i(1 \leq i \leq C)$ 的个数，定义为的两个奶牛队伍的差异。对于编号 $1...N$ 的每个奶牛队伍 $t$，请计算出 $t$ 和其它所有队伍的差异的最大值。

## 说明/提示

第一个和第三个队伍的差异为 $5$。第二个和第三个队伍的差异为 $3$。

$2 \leq N \leq 10^5,1 \leq C \leq 18$。

- 对于测试点 2-5：$C = 10$。
- 对于测试点 6-9：所有答案最少为 $C - 3$。
- 对于测试点 10-20：没有额外条件。

## 样例 #1

### 输入

```
5 3
GHGGH
GHHHH
HGHHG```

### 输出

```
5
3
5```

# AI分析结果



### 综合分析与结论
本题核心在于将最大汉明距离问题转化为最小汉明距离问题，通过预处理所有可能的二进制状态，利用多源BFS或动态规划高效求解。关键思路是：对于每个二进制数，其最大差异等于总位数减去其反码与其他数的最小差异。时间复杂度需控制在 $O(2^C \cdot C)$ 级别。

---

### 高星题解推荐

#### 1. 作者：FFTotoro（5星）
**关键亮点**  
- 使用多源BFS从所有输入的数同时展开，记录每个二进制状态的最小步数  
- 反码处理直接通过位运算实现，代码简洁高效  
- 时间复杂度严格为 $O(2^C \cdot C)$，无冗余操作  

**核心代码**  
```cpp
vector<int> m(1<<c, -1);
queue<pair<int, int>> q;
for (auto &i : a) {
    // 输入转换略
    q.emplace(i, m[i] = 0);
}
// BFS扩展所有相邻状态
while (!q.empty()) {
    auto [u, w] = q.front(); q.pop();
    for (int i = 0; i < c; i++) {
        int v = u ^ (1 << i);
        if (m[v] == -1) q.emplace(v, m[v] = w + 1);
    }
}
// 答案计算
for (int i : a) cout << c - m[(1<<c)-1 ^ i] << endl;
```

#### 2. 作者：IamZZ（5星）
**关键亮点**  
- 动态规划预处理每个二进制状态的最小差异  
- 通过逐位翻转更新状态，实现高效转移  
- 代码结构清晰，逻辑紧密  

**核心实现**  
```c++
for (j = 1; j <= c; j++) {
    for (i = 0; i < (1<<c); i++) {
        // 翻转第j位并更新最小值
        f[(1<<(j-1)) ^ i] = min(f[(1<<(j-1)) ^ i], f[i] + 1);
    }
}
```

#### 3. 作者：ppip（5星）
**关键亮点**  
- 双阶段动态规划，先处理超集再处理子集  
- 代码极简，仅用两轮位运算完成预处理  
- 直接利用位运算特性优化状态转移  

**核心代码**  
```cpp
fill_n(f, 1<<m, m+1);
for (int i : a) f[i] = 0;
// 超集阶段处理
for (int i = (1<<m)-1; ~i; --i)
    for (int j = 0; j < m; ++j)
        if (~i>>j&1) f[i] = min(f[i], f[i^(1<<j)] + 1);
// 子集阶段处理
for (int i = 0; i < 1<<m; ++i)
    for (int j = 0; j < m; ++j)
        if (i>>j&1) f[i] = min(f[i], f[i^(1<<j)] + 1);
```

---

### 关键思路总结
1. **反码转换技巧**：最大差异问题转化为反码的最小差异问题，通过 $max\_dist = C - min\_dist$ 计算。  
2. **状态空间遍历**：利用BFS或DP逐位扩展，保证每个状态仅被访问一次。  
3. **位运算优化**：通过异或和掩码操作快速生成相邻状态，避免显式字符串比较。  

---

### 相似题目推荐
1. [P2114 NOI2014 起床困难综合症](https://www.luogu.com.cn/problem/P2114)  
   **考察点**：位运算贪心策略，逐位确定最优解。
2. [P2962 USACO09NOV Lights G](https://www.luogu.com.cn/problem/P2962)  
   **考察点**：状态压缩BFS，处理二进制状态的最小操作步数。
3. [P3067 USACO12OPEN Balanced Cow Subsets G](https://www.luogu.com.cn/problem/P3067)  
   **考察点**：折半枚举与状态哈希，处理大规模状态空间问题。

---
处理用时：119.52秒
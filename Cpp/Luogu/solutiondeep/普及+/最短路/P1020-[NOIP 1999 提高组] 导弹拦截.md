# 题目信息

# [NOIP 1999 提高组] 导弹拦截

## 题目描述

某国为了防御敌国的导弹袭击，发展出一种导弹拦截系统。但是这种导弹拦截系统有一个缺陷：虽然它的第一发炮弹能够到达任意的高度，但是以后每一发炮弹都不能高于前一发的高度。某天，雷达捕捉到敌国的导弹来袭。由于该系统还在试用阶段，所以只有一套系统，因此有可能不能拦截所有的导弹。

   
输入导弹依次飞来的高度，计算这套系统最多能拦截多少导弹，如果要拦截所有导弹最少要配备多少套这种导弹拦截系统。


## 说明/提示

对于前 $50\%$ 数据（NOIP 原题数据），满足导弹的个数不超过 $10^4$ 个。该部分数据总分共 $100$ 分。可使用$\mathcal O(n^2)$ 做法通过。  
对于后 $50\%$ 的数据，满足导弹的个数不超过 $10^5$ 个。该部分数据总分也为 $100$ 分。请使用 $\mathcal O(n\log n)$ 做法通过。

对于全部数据，满足导弹的高度为正整数，且不超过 $5\times 10^4$。


此外本题开启 spj，每点两问，按问给分。

NOIP1999 提高组 第一题

---

$\text{upd 2022.8.24}$：新增加一组 Hack 数据。

## 样例 #1

### 输入

```
389 207 155 300 299 170 158 65```

### 输出

```
6
2
```

# AI分析结果

### 综合分析与结论
本题需计算一套导弹拦截系统最多能拦截的导弹数（最长不上升子序列长度）和拦截所有导弹最少需要的系统套数（最长上升子序列长度）。各题解主要围绕这两个问题展开，普遍采用动态规划（DP）结合二分查找的方法优化时间复杂度至 $O(n\log n)$，部分题解还引入了 Dilworth 定理进行理论分析。

### 所选题解
- **作者：离散小波变换°（5星）**
    - **关键亮点**：思路清晰，详细推导了状态转移方程，对二分优化过程解释透彻，代码简洁且有注释，还从代码角度证明了 Dilworth 定理。
- **作者：STA_Morlin（4星）**
    - **关键亮点**：对题目进行简化，清晰阐述了求最长不上升子序列和最长上升子序列的原因，使用 STL 函数实现代码，证明过程严谨。
- **作者：After_light（4星）**
    - **关键亮点**：详细解释了每个步骤的思路，代码实现简洁明了，复杂度分析准确。

### 重点代码及核心实现思想
#### 离散小波变换°
```cpp
up(1,n,i){
    int l=0,r=t+1; while(r-l>1){
        int m=l+(r-l)/2;
        if(F[m]>=H[i]) l=m; else r=m;
    }
    int x=l+1;  // dp[i]
    if(x>t) t=x; F[x]=H[i];
}
```
核心思想：通过二分查找找到满足条件的位置，更新最长不上升子序列长度和对应末尾元素。

#### STA_Morlin
```cpp
if (l[r1] >= a[i]) l[++r1] = a[i];
else *upper_bound(l+1, l+r1+1, a[i], greater<int>()) = a[i];
if (h[r2] < a[i]) h[++r2] = a[i];
else *lower_bound(h+1, h+r2+1, a[i]) = a[i];
```
核心思想：利用 STL 函数 `upper_bound` 和 `lower_bound` 分别优化最长不上升子序列和最长上升子序列的求解。

#### After_light
```cpp
if(a[i]<=dp1[len1]){
    dp1[++len1]=a[i];
}
else{
    ll k1=upper_bound(dp1+1,dp1+len1+1,a[i],greater<ll>())-dp1;
    dp1[k1]=a[i]; 
}
if(a[i]>dp2[len2]){
    dp2[++len2]=a[i];
}
else{
    ll k2=lower_bound(dp2+1,dp2+len2+1,a[i])-dp2;
    dp2[k2]=a[i];
}
```
核心思想：与 STA_Morlin 类似，使用 `upper_bound` 和 `lower_bound` 优化求解过程。

### 最优关键思路或技巧
- **二分优化**：在求最长不上升子序列和最长上升子序列时，通过二分查找可以将时间复杂度从 $O(n^2)$ 优化到 $O(n\log n)$。
- **Dilworth 定理**：利用该定理将求最少不上升子序列个数问题转化为求最长上升子序列长度问题。

### 拓展思路
同类型题可考察不同类型的子序列问题，如最长下降子序列、最长不下降子序列等，类似算法套路包括动态规划结合二分查找、贪心算法等。

### 推荐题目
- [P1439 【模板】最长公共子序列](https://www.luogu.com.cn/problem/P1439)
- [P2782 友好城市](https://www.luogu.com.cn/problem/P2782)
- [P1091 合唱队形](https://www.luogu.com.cn/problem/P1091)

### 个人心得摘录与总结
- **作者：sunyizhe**：“这题是道 [LIS](https://baike.baidu.com/item/LIS/16018280?fr=aladdin) 好题！本人调了两天两夜才对……” 总结：LIS 相关题目可能具有一定难度，需要耐心调试。 

---
处理用时：29.67秒
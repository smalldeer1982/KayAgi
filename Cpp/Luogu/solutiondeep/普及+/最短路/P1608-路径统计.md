# 题目信息

# 路径统计

## 题目描述

“RP 餐厅” 的员工素质就是不一般，在齐刷刷的算出同一个电话号码之后，就准备让 HZH,TZY 去送快餐了，他们将自己居住的城市画了一张地图，已知在他们的地图上，有 $N$ 个地方，而且他们目前处在标注为 “1” 的小镇上，而送餐的地点在标注为 “N” 的小镇。（有点废话）除此之外还知道这些道路都是单向的，从小镇 $I$ 到 $J$ 需要花费 $D[I, J]$ 的时间，为了更高效快捷的将快餐送到顾客手中，他们想走一条从小镇 $1$ 到小镇 $N$ 花费最少的一条路，但是他们临出发前，撞到因为在路上堵车而生气的 FYY，深受启发，不能仅知道一条路线，万一。。。于是，他们邀请 FYY 一起来研究起了下一个问题：这个最少花费的路径有多少条？


## 说明/提示

对于 $30\%$ 的数据 $N\leq 20$；

对于 $100\%$ 的数据 $1\leq N\leq 2000$，$0\leq E\leq N\times (N-1)$，$1\leq C\leq 10$。


## 样例 #1

### 输入

```
5 4
1 5 4
1 2 2
2 5 2
4 1 1
```

### 输出

```
4 2```

# AI分析结果

### 综合分析与结论
这些题解均围绕使用 Dijkstra 算法解决路径统计问题展开，核心在于在 Dijkstra 算法的基础上添加路径计数功能，并处理重边问题。不同题解在数据结构的选择（如邻接矩阵、邻接表、`basic_string`、`vector` 等）、去重方式（迭代器、空间换时间、`unique` 函数等）以及 Dijkstra 算法的优化（堆优化、线段树优化等）上存在差异。

### 所选题解
- **作者：_WRYYY_ （4星）**
    - **关键亮点**：思路清晰，详细介绍了去重的两种方法（迭代器去重和空间换时间），并对 `basic_string` 和 `vector` 的性能进行了测试和比较，代码注释详细。
    - **个人心得**：在插入 1e8 以上级别数据时，`basic_string` 将会明显慢于 `vector`，一般题目数据不离谱时按自己喜好选择，比较离谱的话还是用 `vector` + `emplace_back` 。
- **作者：Texas_the_Omertosa （4星）**
    - **关键亮点**：明确指出本题不能使用 SPFA 会被卡，思路清晰，代码结构清晰，模块化程度高。
    - **个人心得**：本题不能使用 `SPFA`，会被卡掉 #1,#13 。
- **作者：_JF_ （4星）**
    - **关键亮点**：对于在 Dijkstra 中加计数的核心思路解释详细，代码简洁易懂。
    - **个人心得**：一定要看好数据范围，否则可能会出错。

### 重点代码及核心实现思想
#### 路径计数核心代码
```cpp
if(dist[y] > dist[x]+e) {
    dist[y]=dist[x]+e;
    ans[y]=ans[x]; // 找到更优路径，覆盖路径计数
} else if(dist[y] == dist[x]+e) {
    ans[y]+=ans[x]; // 路径长度相同，累加路径计数
}
```
核心思想：在 Dijkstra 算法更新最短路径时，根据新路径与原最短路径的长度关系更新路径计数。若新路径更优，则覆盖原路径计数；若长度相同，则累加路径计数。

#### 去重核心代码（以邻接矩阵为例）
```cpp
for(int i=1;i<=m;i++) {
    int u, v, w;
    cin >> u >> v >> w;
    if(e[u][v] > w) {
        e[u][v]=w; // 保留边权最小的边
    }
}
```
核心思想：在输入边时，比较相同起点和终点的边的边权，只保留边权最小的边，从而实现去重。

### 最优关键思路或技巧
- **路径计数**：在 Dijkstra 算法中，使用一个数组记录从起点到每个节点的最短路径数量，在更新最短路径时，根据新路径与原最短路径的长度关系更新路径计数。
- **去重处理**：可以使用邻接矩阵、迭代器、`unique` 函数等方法处理重边，保留边权最小的边。
- **算法优化**：使用堆优化或线段树优化 Dijkstra 算法，提高算法效率。

### 可拓展之处
同类型题或类似算法套路：
- **多源最短路问题**：如 Floyd-Warshall 算法，可用于求解图中任意两点之间的最短路径，在其基础上添加路径计数功能。
- **负权边图的最短路问题**：如 Bellman-Ford 算法或 SPFA 算法（需注意其可能存在的问题），同样可以考虑添加路径计数功能。

### 推荐题目
- [P1144 最短路计数](https://www.luogu.com.cn/problem/P1144)：基础的最短路计数问题，可作为本题的前置练习。
- [P4779 单源最短路径（标准版）](https://www.luogu.com.cn/problem/P4779)：标准的单源最短路径问题，可练习堆优化 Dijkstra 算法。
- [P1339 [USACO09OCT]Heat Wave G](https://www.luogu.com.cn/problem/P1339)：简单的单源最短路径问题，可巩固 Dijkstra 算法的应用。

---
处理用时：29.29秒
# 题目信息

# Mivik 卷积

## 题目背景

卷王之王卷穿肠（doge

## 题目描述

从前有一只 Mivik，他喜欢卷积。他定义两个仅与 $x$ 有关的多项式函数 $f\left(x\right)$ 和 $g\left(x\right)$ 的 Mivik 卷积如下：

$$
f\left(x\right)\otimes g\left(x\right)=\sum_{k=0}^{\deg f +\deg g}\max_{i\in [0,\deg f] \land j\in [0,\deg g]\land i+j=k}\left\{\left[x^i\right]f\left(x\right)+\left[x^j\right]g\left(x\right)\right\} x^k
$$

其中 $\deg f$ 表示 $f$ 的最高项次数，$\left[x^i\right]f\left(x\right)$ 代表 $f\left(x\right)$ 这一函数中 $x^i$ 这一项的系数。

请注意，Mivik 卷积是左结合的，也就是说 $a\otimes b\otimes c=(a\otimes b)\otimes c$。

Mivik 定义 Mivik 函数为能表示为 $f\left(x\right)=ax+b$ 形式的函数，其中 $a$、$b$ 均为整数。例如 $f\left(x\right)=-3+2x$ 是 Mivik 函数，而 $f\left(x\right)=\frac{1}{x}$ 不是。

Mivik 又定义一个函数 $f\left(x\right)$ 是 simple 的，当且仅当存在一个 Mivik 函数的序列 $S$（大小为 $\left|S\right|$），使得：

$$
f\left(x\right)=S_1\otimes S_2\otimes S_3\otimes\cdots\otimes S_{\left|S\right|}.
$$

现在 Mivik 给了你一个多项式函数，问你这个函数是不是 simple 的；如果是，请顺便告诉他任意一种可能的 $S$。

## 说明/提示

### 样例解释 #1

给定的函数 $f\left(x\right)=2+3x+3x^2$ 可以由 $\left(2x+1\right)\otimes\left(x+1\right)$ 得到。

### 测试点约束

**本题采用捆绑测试。**

对于全部数据，有 $1\le n\le 5\times 10^5$，$-10^8\le f_i\le 10^8$。

每个子任务的具体限制见下表：

| 子任务编号 | 分值 | $n\le$ |
|:-:|:-:|:-:|
| 1 | 5 | $1$ |
| 2 | 5 | $2$ |
| 3 | 20 | $20$ |
| 4 | 30 | $5000$ |
| 5 | 40 | $5\times 10^5$ |

**本题读入输出量较大，请使用较快的读入输出方式。**

## 样例 #1

### 输入

```
3
2 3 3
```

### 输出

```
simple
2
2 1
1 1
```

## 样例 #2

### 输入

```
3
97 109 101
```

### 输出

```
simple
2
54 42
47 55
```

## 样例 #3

### 输入

```
9
9 9 8 2 4 4 3 5 3
```

### 输出

```
nice
```

# AI分析结果

### 综合分析与结论
两道题解思路基本一致，都先对Mivik卷积进行理解转化，发现问题等价于构造物品权值使选取不同数量物品的最大权值和符合给定序列。都利用序列差单调不上升来判断合法性并构造权值。
 - **思路方面**：均将卷积问题转化为物品选取权值问题，从定义出发挖掘出判断合法性条件及构造方法。
 - **算法要点**：通过对Mivik卷积的分析，得到判断序列合法的条件是相邻项差值单调不上升，并据此构造满足条件的Mivik函数序列。
 - **解决难点**：理解Mivik卷积定义并转化为可操作的问题，以及发现并证明利用差值单调性判断合法性。

题解1（Mivik）：
 - **思路清晰度**：清晰，从卷积定义逐步推导转化，对问题理解深刻。
 - **代码可读性**：未贴具体代码，但给出链接，推测其博客代码应规范。
 - **优化程度**：无代码无法确切判断，但思路推导完整，应有较好优化。综合评定4星。

题解2（_H17_）：
 - **思路清晰度**：较清晰，阐述了对卷积的理解和大致思路，但推导过程不如题解1详细。
 - **代码可读性**：代码有较多注释，考虑了输入输出优化，但代码风格稍显凌乱。
 - **优化程度**：在输入输出上做了优化。综合评定3星。

### 所选的题解
 - **题解1（Mivik） - 4星**
   - **关键亮点**：对Mivik卷积的文字描述清晰形象，将问题转化为物品选取权值问题的推导过程详细，给出判断合法性的证明思路。
   - **个人心得**：无。

### 最优关键思路或技巧
 - **思维方式**：将复杂的卷积定义转化为直观的物品权值选取问题，便于理解和解决。
 - **算法优化**：通过分析发现利用序列相邻项差值单调不上升来判断合法性，简化判断过程。

### 可拓展之处
此类题目属于自定义运算规则的问题，类似套路是深入理解自定义规则，转化为常见的数学或算法模型。例如对于其他自定义的多项式运算，可以尝试从系数关系、项数关系等角度转化为熟悉的组合、贪心等模型。

### 洛谷相似题目
 - **P1080 [NOIP2012 提高组] 国王游戏**：涉及贪心算法，与本题类似在于需根据题目条件挖掘出最优策略。
 - **P2123 皇后游戏**：同样是通过分析数据间关系，找到贪心策略解决问题，和本题分析序列性质找解法思路类似。
 - **P1937 [USACO10MAR]Barn Allocation G**：需要对问题进行合理转化，利用贪心思想解决，与本题转化问题思路相似。

### 题解1核心代码（无具体代码，以下为根据思路伪代码实现）
```cpp
// 判断序列v是否合法
bool isLegal(vector<int>& v) {
    int n = v.size();
    for (int i = 1; i < n - 1; ++i) {
        if (v[i] - v[i - 1] < v[i + 1] - v[i]) {
            return false;
        }
    }
    return true;
}
// 构造a和b数组
void constructAB(vector<int>& v, vector<int>& a, vector<int>& b) {
    int n = v.size();
    b[1] = v[0];
    a[1] = v[1];
    for (int i = 2; i < n; ++i) {
        b[i] = 0;
        a[i] = v[i] - v[i - 1];
    }
}
```
核心实现思想：`isLegal`函数通过遍历序列判断相邻项差值是否单调不上升来确定合法性；`constructAB`函数根据思路构造`a`和`b`数组，用于表示Mivik函数序列。 

---
处理用时：34.04秒
# 题目信息

# [WFOI - 02] I wanna reverse to reserve（翻转）

## 题目背景

> 君子不器

“我最擅长解谜了，你说是吧，kid。”

“嗯...”

## 题目描述

kid 走进了一个 $n$ 行 $m$ 列的矩阵，**不**保证矩阵中有 $n$ 个数字 $1$，$n$ 个数字 $2$，$\dots$ , $n$ 个数字 $m$ 但 $n,m$ 均为偶数。

现有两种改变矩阵的方式：

- 选择任意一行，将这一行上的数翻转；
- 选择任意一列，将这一列上的数翻转。

每次操作可以选择任意一种方式。

现在需要通过若干次操作，将矩阵变为：

$$
n\;行\left\{
\begin{array}{l}
1\quad2\quad3\quad\cdots\quad m\\
\\
1\quad2\quad3\quad\cdots\quad m\\

\\
\cdots\\
\\
1\quad2\quad3\quad\cdots\quad m\\
\end{array}
\right.

$$

这样才会出现下一个存档点。

你需要帮 kid 解决这个问题。

你只需要给出答案，剩下的操作就交给 Uvocde 吧！

## 说明/提示

**【数据范围】**

**本题采用 Subtask 捆绑测试**。

- $\texttt{Subtask \#0 (20pts)}$：最多只有 $2$ 个数不在规定位置上；
- $\texttt{Subtask \#1 (20pts)}$：$n=2$；
- $\texttt{Subtask \#2 (20pts)}$：$m=2$；
- $\texttt{Subtask \#3 (40pts)}$：$1\le n\le 100$，$1\le m\le 100$；

全部数据满足 $1\le n\le 100$，$1\le m\le 100$。

## 样例 #1

### 输入

```
2 4
1 2 3 4
4 3 2 1```

### 输出

```
YES
1
0 2```

## 样例 #2

### 输入

```
2 4
1 2 3 4
4 1 3 2```

### 输出

```
NO```

# AI分析结果

### 综合分析与结论
这些题解的核心思路都是基于矩阵翻转操作的性质，即矩阵中元素 $(x, y)$ 只能翻转到 $(x, y)$、$(n - x + 1, y)$、$(x, m - y + 1)$、$(n - x + 1, m - y + 1)$ 这四个位置，将这四个位置称为一个置换环或轮换位。通过判断每个置换环内数字的分布情况来确定是否有解，并针对不同分布情况分类构造操作方案，使每个置换环达到目标状态，同时要保证行翻转次数为偶数以免影响其他已处理的置换环。

算法要点在于对置换环内数字分布的判断以及针对不同分布设计不超过4次操作的构造方案。解决难点主要是设计出既能使当前置换环达到目标状态，又不影响其他已处理置换环的操作序列。

### 所选的题解
1. **作者：Cocoly1990 (5星)**
    - **关键亮点**：思路清晰简洁，先给出两个关键引理确定有解的条件，再针对置换环内数字的不同分布情况详细分类构造操作方案，逻辑连贯。
2. **作者：Icyfires18 (4星)**
    - **关键亮点**：赛时思路具有启发性，类比魔方来理解操作，对问题的性质分析到位，详细列举所有可能的置换环形式并给出对应操作方案，代码实现有详细注释。
3. **作者：Eafoo (4星)**
    - **关键亮点**：全面分析无解的各种情况，对复原矩阵的操作方案讲解细致，通过举例说明保证行翻转次数为偶数的原因及重要性，代码结构清晰。

### 最优关键思路或技巧
- **思维方式**：抓住矩阵翻转操作后元素位置的对称性质，将矩阵划分成多个独立的置换环进行处理，降低问题复杂度。
- **操作设计**：为保证不影响已处理的置换环，确保行翻转次数为偶数，同时尽量控制操作次数在4次以内，以满足总操作次数限制。

### 可拓展之处
同类型题或类似算法套路：此类题目通常围绕矩阵的某种变换操作，通过分析操作性质确定有解条件，并构造满足要求的操作序列。可以拓展到其他具有对称性质的矩阵变换操作，如旋转、镜像等，解题思路依然是分析变换后元素位置的规律，划分独立单元进行处理。

### 推荐题目
- [P1162 填涂颜色](https://www.luogu.com.cn/problem/P1162)：考察对矩阵的遍历和状态标记，与本题对矩阵元素的处理有相似之处。
- [P1339 热浪](https://www.luogu.com.cn/problem/P1339)：虽然是图论问题，但在分析问题和寻找合适算法的过程中，与本题分析操作性质并设计方案的思维类似。
- [P1996 约瑟夫问题](https://www.luogu.com.cn/problem/P1996)：通过模拟过程解决问题，和本题通过构造操作序列解决矩阵变换问题在思路上有相通之处。

### 个人心得摘录及总结
- **作者：Eafoo**：提到构造题较难，在赛时因保证竖直翻转次数为偶数导致操作步数超限制而失分，后发现只需保证水平翻转次数为偶数即可。总结出在解决此类构造问题时，要深入理解操作限制条件对结果的影响，避免过度限制导致方案不可行。 

---
处理用时：21.87秒
# 题目信息

# [NOIP 2006 提高组] 能量项链

## 题目描述

在 Mars 星球上，每个 Mars 人都随身佩带着一串能量项链。在项链上有 $N$ 颗能量珠。能量珠是一颗有头标记与尾标记的珠子，这些标记对应着某个正整数。并且，对于相邻的两颗珠子，前一颗珠子的尾标记一定等于后一颗珠子的头标记。因为只有这样，通过吸盘（吸盘是 Mars 人吸收能量的一种器官）的作用，这两颗珠子才能聚合成一颗珠子，同时释放出可以被吸盘吸收的能量。如果前一颗能量珠的头标记为 $m$，尾标记为 $r$，后一颗能量珠的头标记为 $r$，尾标记为 $n$，则聚合后释放的能量为 $m \times r \times n$（Mars 单位），新产生的珠子的头标记为 $m$，尾标记为 $n$。

需要时，Mars 人就用吸盘夹住相邻的两颗珠子，通过聚合得到能量，直到项链上只剩下一颗珠子为止。显然，不同的聚合顺序得到的总能量是不同的，请你设计一个聚合顺序，使一串项链释放出的总能量最大。

例如：设 $N=4$，$4$ 颗珠子的头标记与尾标记依次为 $(2,3)(3,5)(5,10)(10,2)$。我们用记号 $\oplus$ 表示两颗珠子的聚合操作，$(j \oplus k)$ 表示第 $j,k$ 两颗珠子聚合后所释放的能量。则第 $4$，$1$ 两颗珠子聚合后释放的能量为：

$(4 \oplus 1)=10 \times 2 \times 3=60$。

这一串项链可以得到最优值的一个聚合顺序所释放的总能量为：

$(((4 \oplus 1) \oplus 2) \oplus 3)=10 \times 2 \times 3+10 \times 3 \times 5+10 \times 5 \times 10=710$。

## 说明/提示

NOIP 2006 提高组 第一题


## 样例 #1

### 输入

```
4
2 3 5 10
```

### 输出

```
710```

# AI分析结果

### 综合分析与结论
这些题解主要围绕区间动态规划（区间 DP）来解决能量项链问题。核心思路是将环形的项链问题转化为链状问题，通过小区间的合并来更新大区间的最优解。

- **思路**：普遍采用将项链数组复制一份接在后面，实现破环成链。定义状态 $dp_{i,j}$ 表示区间 $[i, j]$ 合并的最大能量，通过枚举分割点 $k$ 来更新状态。
- **算法要点**：状态转移方程为 $dp_{i,j}=\max(dp_{i,j}, dp_{i,k}+dp_{k + 1,j}+a_i\times a_{k + 1}\times a_{j + 1})$，时间复杂度为 $O(n^3)$。
- **解决难点**：主要解决了环形结构的处理问题，通过复制数组简化了代码实现。

### 所选题解
- **作者：voilin (赞：577)，5星**
  - **关键亮点**：思路清晰，对状态转移方程的推导过程详细，代码简洁易懂。
  - **个人心得**：无

### 重点代码
```cpp
#include<bits/stdc++.h>
using namespace std;
int n,e[300],s[300][300],maxn=-1;
int main(){
    cin>>n;
    for(int i=1;i<=n;i++){cin>>e[i];e[i+n]=e[i];}
    // 珠子由环拆分为链，重复存储一遍
    for(int i=2;i<2*n;i++){
        for(int j=i-1;i-j<n&&j>=1;j--){ // 从i开始向前推
            for(int k=j;k<i;k++) // k是项链的左右区间的划分点 
                s[j][i]=max(s[j][i],s[j][k]+s[k+1][i]+e[j]*e[k+1]*e[i+1]);
                // 状态转移方程：max(原来能量，左区间能量+右区间能量+合并后生成能量）  
                if(s[j][i]>maxn)maxn=s[j][i]; // 求最大值 
        }
    } 
    cout<<maxn;
    return 0;
}
```
**核心实现思想**：先将项链数组复制一份实现破环成链，然后通过三重循环枚举区间长度、区间起点和分割点，根据状态转移方程更新区间的最大能量，最后输出所有区间中的最大值。

### 最优关键思路或技巧
- **破环成链**：将环形问题转化为链状问题，通过复制数组的方式简化代码实现。
- **区间 DP**：利用区间动态规划的思想，通过小区间的合并来更新大区间的最优解。

### 拓展思路
同类型题或类似算法套路：
- 环形石子合并问题：同样是环形结构，通过破环成链和区间 DP 解决。
- 矩阵链乘法问题：通过枚举分割点，利用区间 DP 求解最优乘法顺序。

### 推荐题目
- [P1775 石子合并（弱化版）](https://www.luogu.com.cn/problem/P1775)
- [P1880 [NOI1995] 石子合并](https://www.luogu.com.cn/problem/P1880)
- [P3146 [USACO16OPEN]248 G](https://www.luogu.com.cn/problem/P3146)

### 个人心得摘录与总结
- **Seauy**：提到记忆化搜索与动态规划有共性，可先写搜索再加记忆化，从而得到动归递推式。总结：记忆化搜索是推导动态规划递推式的一种有效方法。
- **Kevin_Wa**：指出项链是环，处理时要考虑不同展开方式，且不同展开存在大量重复运算，可通过合并来优化。总结：对于环形问题，要注意处理方式和避免重复运算。 

---
处理用时：29.28秒
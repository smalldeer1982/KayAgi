# 题目信息

# 散步

## 题目描述

一条道路上，位置点用整数 $A$ 表示。

当 $A=0$ 时，有一个王宫。当 $A>0$，就是离王宫的东边有 $A$ 米，当 $A<0$，就是离王宫的西边有 $-A$ 米。

道路上，有 $N$ 个住宅从西向东用 $1\sim N$ 来标号。每个住宅有一个人。住宅只会存在于偶数整数点。

该国国王认为，国民体质下降，必须要多运动，于是下命令所有人都必须出门散步。所有的国民，一秒钟可以走 $1$ 米。每个国民各自向东或者向西走。这些方向你是知道的。命令发出后所有人同时离开家门开始散步。

然而该国的国民个都很健谈，如果在散步途中两个人相遇，就会停下来交谈。正在走路的人碰到已经停下来的人（重合）也会停下来交谈。一但停下来，就会聊到天昏地暗，忘记了散步。

现在命令已经发出了 $T$ 秒，该国有 $Q$ 个重要人物，国王希望能够把握他们的位置。你能帮他解答吗？

## 说明/提示

$20\%$ 数据，$N\le 100,T\le 10000$。

另外 $20\%$ 数据，$N\le 5000$。

另外 $20\%$ 数据，从最西边数起连续的若干国民全部往东，剩下的全部往西。

$100\%$ 数据 $A_i$ 为偶数，$|A_i|\le 10^{18},|T|\le 10^{18},1\le Q\le N\le 100000$。


## 样例 #1

### 输入

```
6 6 4
-10 1
-6 2
-4 1
2 1
6 2
18 2
2
3
4
6```

### 输出

```
-8
2
4
12```

# AI分析结果

### 综合分析与结论
本题的核心在于模拟人们散步相遇的过程，由于数据范围较大，直接模拟会导致数组越界，因此各题解都在寻找规律以避免直接模拟。不同题解的思路大致可分为分组计算、分东西方向扫描、利用栈模拟、二分查找相聚点等。

### 所选题解
- **UIai（4星）**
    - **关键亮点**：思路清晰，通过分向西和向东两组扫描，分别考虑每个人最终停下来的三种情况，代码简洁易懂。
    - **个人心得**：无

### 重点代码
```cpp
#include<iostream>
#define maxn 100010
using namespace std;
int n,Q,q[maxn];
long long loc[maxn],p[maxn][2],t;
int main()
{
    ios::sync_with_stdio(false);
    cin>>n>>t>>Q;
    for(int i=1;i<=n;i++)
        cin>>p[i][0]>>p[i][1];    
    for(int i=1;i<=Q;i++)
        cin>>q[i];
    for(int i=1;i<=n;i++)
        if(p[i][1]==2)
        {
            if(i==1)
                loc[i]=p[i][0]-t;
            else if(p[i-1][1]==2)
                loc[i]=max(loc[i-1],p[i][0]-t);
            else loc[i]=max(p[i][0]/2+p[i-1][0]/2,p[i][0]-t);
        }
    for(int i=n;i>=1;i--)
        if(p[i][1]==1)
        {
            if(i==n)
                loc[i]=p[i][0]+t;
            else if(p[i+1][1]==1)
                loc[i]=min(loc[i+1],p[i][0]+t);
            else loc[i]=min(p[i][0]/2+p[i+1][0]/2,p[i][0]+t);
        }
    for(int i=1;i<=Q;i++)
        cout<<loc[q[i]]<<endl;
    return 0;
}
```
**核心实现思想**：先处理向西走的人，根据其前一个人的方向分情况计算最终位置；再处理向东走的人，同样根据其后一个人的方向分情况计算最终位置。最后输出重要人物的位置。

### 最优关键思路或技巧
- **分组与分类讨论**：将人群按行走方向分组，对每个人最终停下来的情况进行分类讨论，避免复杂的模拟过程。
- **利用栈**：部分题解使用栈来模拟相遇过程，将向东走的人压入栈中，遇到向西走的人时进行判断和处理。

### 可拓展之处
同类型题可能涉及更多复杂的运动规则，如速度不同、有障碍物等。类似算法套路可应用于交通流模拟、粒子碰撞等问题，通过寻找规律和分类讨论来简化模拟过程。

### 推荐题目
- P1007 独木桥
- P1031 均分纸牌
- P1115 最大子段和

### 个人心得摘录与总结
- **DоsLikе**：尝试纯模拟会因数据范围大导致数组越界，可从特殊数据情况找规律，如从最西边数起连续的若干国民全部往东，剩下的全部往西的情况，还可将问题与表达式计算联系起来，使用栈来解决。
- **易极feng**：每次都被`long long`坑惨，在处理大数据范围时要注意数据类型。
- **jyz666**：被`long long`卡了5遍，数据范围大时要注意初始赋值足够小，避免数据溢出。

---
处理用时：28.16秒
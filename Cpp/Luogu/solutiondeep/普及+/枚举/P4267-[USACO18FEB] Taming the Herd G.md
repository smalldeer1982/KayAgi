# 题目信息

# [USACO18FEB] Taming the Herd G

## 题目描述

清晨，Farmer John 被木头碎裂的声音吵醒。原来是奶牛们又一次从谷仓里逃出来了！
Farmer John 对奶牛们的清晨逃跑行为感到厌烦，他决定受够了：是时候采取强硬措施了。他在谷仓的墙上钉了一个计数器，用于记录自上次逃跑以来的天数。因此，如果某天早上发生了逃跑，计数器当天会显示 $0$；如果最近一次逃跑发生在 $3$ 天前，计数器会显示 $3$。Farmer John 每天都会仔细记录计数器的值。

年末到了，Farmer John 准备进行一些统计。他说，奶牛们要为此付出代价！但他发现他的记录似乎有些不对劲……

Farmer John 想知道自从他开始记录以来发生了多少次逃跑。然而，他怀疑奶牛们篡改了他的记录，他唯一能确定的是他开始记录的那天发生了一次逃跑。请帮助他确定，对于可能发生的逃跑次数，记录中必须被篡改的最小条目数。

## 说明/提示

如果只有 $1$ 次逃跑，那么正确的记录应该是 `0 1 2 3 4 5`，这与给定的记录有 $4$ 个条目不同。

如果有 $2$ 次逃跑，那么正确的记录可能是 `0 1 2 3 0 1`，这与给定的记录有 $2$ 个条目不同。在这种情况下，逃跑发生在第 $1$ 天和第 $5$ 天。

如果有 $3$ 次逃跑，那么正确的记录可能是 `0 1 2 0 0 1`，这与给定的记录只有 $1$ 个条目不同。在这种情况下，逃跑发生在第 $1$ 天、第 $4$ 天和第 $5$ 天。

以此类推。

题目来源：Brian Dean 和 Dhruv Rohatgi

## 样例 #1

### 输入

```
6
1 1 2 0 0 1```

### 输出

```
4
2
1
2
3
4```

# AI分析结果

### 综合分析与结论
本题主要围绕奶牛出逃记录的篡改问题，通过动态规划（DP）算法来求解不同出逃次数下记录被篡改的最小条目数。各题解均采用了 DP 思想，但在状态定义、转移方程和实现细节上有所差异。大部分题解时间复杂度为 $O(n^3)$，部分题解通过预处理或优化状态转移将复杂度降至 $O(n^2)$。

### 所选题解
- **作者：Dilute（4星）**
    - **关键亮点**：思路清晰，状态定义简洁明了，通过预处理 `Cnt` 数组优化了状态转移的计算，代码可读性高。
- **作者：vеctorwyx（4星）**
    - **关键亮点**：提供了 $O(n^2)$ 的做法，通过计算最大符合天数再转换为最小不符合天数，减少了不必要的计算，复杂度更优。
- **作者：Jessica2333（4星）**
    - **关键亮点**：对状态的分析细致入微，考虑了出逃情况的关键因素，通过预处理和辅助数组优化了状态转移，时间复杂度为 $O(n^3)$。

### 重点代码及核心思想
#### Dilute 的题解
```cpp
int Num[110];
int Cnt[110][110];
int f[110][110]; // dp数组

// 预处理Cnt数组
for(int i = 0; i <= n; i++){
    int Cou = 0;
    for(int j = i; j <= n; j++){
        if(Num[j] != j - i)
            Cou++;
        Cnt[i][j] = Cou;
    }
}
// dp
f[0][0] = 0;
for(int i = 0; i <= n; i++)
    for(int j = 1; j <= n; j++)
        for(int u = i+1; u <= n; u++) // 枚举f[i][j]可以更新的状态
            if(f[u][j] > f[i][j-1] + Cnt[i+1][u]) // 如果更优
                f[u][j] = f[i][j-1] + Cnt[i+1][u];
```
**核心思想**：`f[i][j]` 表示在前 `i` 个里面经历 `j` 次出逃可以取到最少的修改数，通过预处理 `Cnt` 数组记录从第 `i` 天出逃到第 `j` 天的修改次数，然后进行状态转移。

#### vеctorwyx 的题解
```cpp
int n, a[110], qc[110][110];
int dp[110][110], dp0[110][110], jc[110][110];

// 预处理区间贡献
for(int i = 1; i <= n; i++){
    qc[i][i] = (a[i] == 0);
    int qwq = 1;
    for(int j = 1; j <= a[i] && i - j >= 1; j++){
        if(a[i - j] == a[i] - j)
            qwq++;
        qc[i][i - j] = qwq;
    }
}
dp[1][1] = (a[1] == 0);
dp[0][0] = 0;
int js = dp[1][1];
for(int i = 2; i <= n; i++)// 预处理j = 1的情况
    if(a[i] == i - 1)
        dp[i][1] = ++js;
    else
        dp[i][1] = js;
for(int i = 2; i <= n; i++)
    for(int j = 2; j <= i; j++){
        if(i - a[i] - 1 >= j - 1)
            dp[i][j] = max(dp[i - a[i] - 1][j - 1] + qc[i][i - a[i]], dp[i - 1][j]);
        else
            dp[i][j] = dp[i - 1][j];
        dp[i][j] = max(dp[i][j], dp[i - 1][j - 1]);
    }
for(int i = 1; i <= n; i++)
    cout << n - dp[n][i]<<"\n";
```
**核心思想**：`dp[i][j]` 表示前 `i` 天出逃 `j` 次的最大符合天数，通过预处理区间贡献 `qc` 数组，然后根据当天计数器是否正确进行状态转移，最后将最大符合天数转换为最小不符合天数。

#### Jessica2333 的题解
```cpp
int N,a[108],dp[108][108][108],dif[108][108],ans[108][108];

// 预处理dif数组
for(i=1;i<=N;i++)
    for(j=i;j<=N;j++)
        dif[i][j]=dif[i][j-1]+(a[j]==j-i?0:1);
dp[1][1][1]=(a[1]==0?0:1);
for(k=1;k<=N;k++){
    for(i=1;i<=k;i++){
        for(j=i;j<=k;j++){
            dp[k][i][j]=min(dp[k][i][j],ans[j-1][i-1]+dif[j][k]);
            dp[k][i][j]=min(dp[k][i][j],dp[k-1][i][j]+(a[k]==k-j?0:1));
            ans[k][i]=min(ans[k][i],dp[k][i][j]);
        }
    }
}
for(i=1;i<=N;i++)
    cout<<ans[N][i]<<endl;
```
**核心思想**：`dp[k][i][j]` 表示到第 `k` 天，总共出逃 `i` 次，最后一次出逃是在第 `j` 天的这种状态下，最少的篡改记录次数。通过预处理 `dif` 数组记录从第 `i` 天出逃到第 `j` 天的篡改次数，然后根据当天是否出逃进行状态转移，用 `ans` 数组记录最小值。

### 最优关键思路或技巧
- **预处理优化**：多个题解通过预处理数组（如 `Cnt`、`dif`、`qc` 等），将状态转移中重复计算的部分提前计算好，减少了时间复杂度。
- **状态定义优化**：部分题解通过巧妙的状态定义（如计算最大符合天数），简化了状态转移过程，提高了算法效率。

### 可拓展之处
同类型题或类似算法套路：
- 区间划分问题：给定一个序列，要求将其划分为若干个区间，每个区间有一定的代价，求满足特定条件下的最小或最大代价。
- 分段线性 DP：将问题划分为多个阶段，每个阶段有不同的状态，通过状态转移方程求解最优解。

### 推荐题目
- [P1048 采药](https://www.luogu.com.cn/problem/P1048)：0 - 1 背包问题，考察动态规划的基本思想。
- [P1216 [USACO1.5] 数字三角形 Number Triangles](https://www.luogu.com.cn/problem/P1216)：简单的线性 DP 问题，通过状态转移求解路径最大值。
- [P1802 5 倍经验日](https://www.luogu.com.cn/problem/P1802)：0 - 1 背包的变形问题，需要考虑不同选择的代价和收益。

### 个人心得摘录及总结
- **亦笙箫**：吐槽题目翻译毒瘤，不看提示不明题意。总结：遇到题目表述不清时，可查看提示或相关讨论，确保理解题意。

---
处理用时：54.10秒
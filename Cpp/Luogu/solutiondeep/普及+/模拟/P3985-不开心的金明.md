# 题目信息

# 不开心的金明

## 题目描述

金明今天很不开心，家里购置的二手房就要领钥匙了，房里并没有一间他自己专用的很宽敞的房间。更让他不高兴的是，妈妈昨天对他说：“你需要购买哪些物品，怎么布置，你说了不算（有很大的限制），而且不超过 $W$ 元钱。”。今天一早金明就开始做预算，但是他想买的东西太多了，肯定会超过妈妈限定的 $W$ 元。于是，他把每件物品规定了一个重要度整数 $p_i$ 表示。他还从因特网上查到了每件物品的价格 $v_i$（都是整数元）。

妈妈看到购物单后进行了审查，要求购物单上所有的物品价格的极差（最贵的减去最便宜的）不超过 $3$（当然金明至今不知道为什么会这样）。他希望在不超过 $W$ 元（可以等于 $W$ 元）的前提下，使购买的重要度总和 $\sum p_i$ 的最大。


请你帮助金明设计一个满足要求的购物单，你只需要告诉我们重要度的最大的和。


## 说明/提示

$1 \le N \le 100$。

$1 \le W \le 10^9$。

$1 \le v_i \le 10^9$。

对所有的 $i=1,2,3,…,N$，$\min(v_i) \le v_i \le \min(v_i)+3$。

$1 \le p_i \le 10^7$。


## 样例 #1

### 输入

```
5 10
2 800
5 400
5 300
3 400
2 200
```

### 输出

```
1600```

# AI分析结果

### 综合分析与结论
这些题解主要围绕如何解决因数据范围导致的背包问题展开。难点在于背包空间过大无法直接实现，不同题解采用了不同策略。有的利用价格极差限制进行分类讨论，有的通过对物品价格处理、状态压缩或暴力搜索来解决。

### 所选题解
1. **作者：蓝莲花__ (5星)**
    - **关键亮点**：对背包问题的预处理和状态设计巧妙。通过将每个物品体积减去最小体积减1，并在dp数组多加一维记录所选物品个数，从而能根据修改后的体积和物品个数算出总体积，有效解决问题。
    - **重点代码核心思想**：先预处理物品体积，再通过三层循环进行状态转移，最后遍历dp数组得出答案。
    - **核心代码**：
```cpp
for (int i=1;i<=n;i++)
for (int j=sv;j>=v[i];j--)
for (int k=n;k>=1;k--)
if (j+k*minv<=sumv) dp[j][k]=max(dp[j][k],dp[j-v[i]][k-1]+w[i]);
int ans=0;
for (int j=1;j<=sv;j++)
for (int i=1;i<=n;i++) ans=max(ans,dp[j][i]);
```
2. **作者：sy_zmq_001 (4星)**
    - **关键亮点**：根据价格最小值与300的关系进行分类讨论，思路清晰。当最小值 <= 300时用01背包，> 300时贪心求解，有效利用了价格极差限制条件。
    - **重点代码核心思想**：读入数据后判断最小值与300关系，分别进行01背包DP或贪心计算。
    - **核心代码**：
```cpp
if(minn<=300){
    for(int i=1;i<=n;i++){
        for(int j=w;j>=v[i];j--){
            f[j]=max(f[j],f[j-v[i]]+p[i]);
        }
    }
    printf("%d",f[w]);
}
else{
    int ans=0;
    sort(p+1,p+n+1,cmp);
    for(int i=1;i<=w/maxn;i++)
        ans+=p[i];
    printf("%d",ans);
}
```
3. **作者：林聪 (4星)**
    - **关键亮点**：利用价格只有4种情况，通过枚举每种重量物品个数，对同重量物品按价值排序并计算前缀和，简化问题求解。
    - **重点代码核心思想**：读入数据后按重量分类，排序并计算前缀和，再通过四层循环枚举每种重量物品个数来更新答案。
    - **核心代码**：
```cpp
for(int i=0;i<=tot0;i++)
    for(int j=0;j<=tot1;j++)
        for(int k=0;k<=tot2;k++)
        {
            int sum=i*minn+j*(minn+1)+k*(minn+2);
            if(sum<=m)
            {
                int l=(m-sum)/(minn+3);
                ans=max(ans,s0[i]+s1[j]+s2[k]+s3[l]);
            } 
        }
```

### 最优关键思路或技巧
1. **利用价格极差条件**：如根据价格最小值与特定值（如300）比较进行分类讨论，简化问题。
2. **状态设计与预处理**：对物品价格进行预处理，改变体积表示方式，并通过增加状态维度记录信息，解决总体积计算问题。
3. **枚举与排序**：利用价格种类少的特点，枚举各价格物品数量，并对同价格物品按价值排序，结合前缀和优化计算。

### 可拓展思路
此类题目通常围绕背包问题的数据范围优化展开。类似套路包括根据题目特殊条件对数据分类处理、状态压缩、利用数据特性简化枚举等。例如，当物品存在某些属性限制时，可据此优化状态转移或选择更合适的算法（贪心、DP等）。

### 洛谷相似题目推荐
1. P1048 [NOIP2005 普及组] 采药
2. P1616 疯狂的采药
3. P2690 [USACO04NOV]Apple Catching G

---
处理用时：39.01秒
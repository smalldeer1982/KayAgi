# 题目信息

# 「GMOI R1-T4」Rain

## 题目背景

> **求雨**
>
>玉皇爷爷也姓张，
>
>为啥为难俺张*昌？
>
>三天之内不下雨，
>
>先扒龙皇庙，
>
>__再用大炮轰你娘。__

如果再不下雨，张大帅就会轰掉全亚洲所有的宗教场所！

博丽神社因为可以在外界被看到，自然也无法幸免于难，灵梦十分着急，准备使用祖传秘法求雨……

## 题目描述

为了防止神社被“大炮开兮轰他娘”，灵梦需要求雨。

求雨需要在一条笔直的路上建 $n$ 个法阵，编号为 $1,2,\cdots,n$。

给定一个长度为 $n$ 的数组 $a$，表示在 $a_1$ 到 $a_n$ 的位置建法阵，你要干的是给法阵编号。

灵梦需要来检测法阵效果，她会从 $1$ 号法阵走到 $2$ 号，从 $2$ 号再走到 $3$ 号，直到走到 $n$ 号，再从 $n$ 号走回 $1$ 号。

由于法阵的特殊效果，从 $i$ 个走到 $i+1$ 个的距离是 $\left|a_i\times p-a_{i+1}\times q\right|$。特别的，从 $n$ 号走回到 $1$ 号的距离是 $\left|a_n\times p-a_1\times q\right|$。$p,q$ 是给定的两个常数，$a_i,a_{i+1}$ 是两个法阵的位置。

灵梦希望你来求一下最大的行走距离，并输出对应法阵从 $1$ 号到 $n$ 号的位置排列。（多个只需输出一个即可）

## 说明/提示

**本题开启 SPJ。**

**本题读入量较大，建议使用较快的读入方式。**

对于 $100\%$ 的数据满足 $10\le n\le 10^6$，$1\le p,q \le 10^{5}$，$1\le a_i\le 10^{5}$。

| 编号 | $n$ | $p,q$ | $a_i$ | 分数 |
| :----------: | :----------: | :----------: | :----------:  | :----------: |
| $1$ | $n=10$ | $p,q\le 10^{3}$ | $a_i\le 10^{3}$ | $4$ |
| $2$ | $n=10$ | $p,q\le 10^{3}$ | $a_i\le 10^{3}$ | $5$ |
| $3$ | $n=10$ | $p,q\le 10^{3}$ | $a_i\le 10^{3}$ | $5$ |
| $4\sim 6$  | $n=19$ | $p,q\le 10^{5}$ | $a_i\le 10^{5}$ | $10$ |
| $7$ | $n\le 10^{4}$ | $p,q\le 10^{5}$ | $a_i\le 10^{5}$ | $8$ |
| $8$ | $n\le 10^{4}$ | $p,q\le 10^{5}$ | $a_i\le 10^{5}$ | $9$ |
| $9$ | $n\le 10^{4}$ | $p,q\le 10^{5}$ | $a_i\le 10^{5}$ | $9$ |
| $10\sim 12$ | $n\le 10^{6}$ | $p,q\le 10^{5}$ | $a_i\le 10^{5}$ | $10$ |


## 样例 #1

### 输入

```
10
2 3
1 2 3 4 5 6 7 8 9 10```

### 输出

```
131
5 6 7 1 8 2 9 3 10 4```

# AI分析结果

• 综合分析与结论：
    - 这些题解的核心思路都是通过拆开绝对值，利用贪心策略来解决问题。由于绝对值拆开后有\(n\)项系数为正，\(n\)项系数为负，所以希望让较大的\(n\)项系数为正，较小的\(n\)项系数为负，从而得到理论最大值。难点在于证明这个理论最大值可以取到，并构造出相应的排列方案。
    - 不同题解在构造方案的具体思路和实现方式上有所差异。有的通过分析数的大小关系和前缀后缀规律来构造，有的通过分类元素并按特定顺序选取来构造。
    - 从思路清晰度、代码可读性和优化程度综合评分，yinhy09、Tx_Lcy和Daidly的题解相对较好。
• 所选的题解：
  - yinhy09（5星）
    - 关键亮点：清晰阐述了将式子拆开后，通过构造两个集合\(A\)、\(B\)，从理论上证明了最大值可以取到，并说明了构造方法只需从一个地方开始填表即可。思路严谨且清晰。
  - Tx_Lcy（4星）
    - 关键亮点：通过列表分析发现\(a_i\)按从小到大排序后，存在前缀和后缀的规律，根据此规律枚举前缀长度取最大值，并给出了具体构造方案，思路直观，代码简洁明了。同时指出了输出方案是具体数而非原数组位置的坑点。
    - 个人心得：“这里有个坑点，我比赛时就被坑到了，输出的方案是具体的数，而不是每个数在原数组中的位置。”总结了比赛中遇到的陷阱。
  - Daidly（4星）
    - 关键亮点：逐步分析了从暴力枚举到优化的过程，详细阐述了\(100\)分做法中通过将放置抽象成网格，根据数的大小情况分类并构造排列方案的思路，对各种情况分析较为全面。
• 最优关键思路或技巧：
    - 思维方式上，遇到带绝对值且求最大值的问题，优先考虑拆开绝对值，利用绝对值内元素系数正负分配的特点进行贪心。
    - 构造方案时，通过分析元素大小关系和组合情况，合理安排元素顺序，确保满足贪心策略下的最优排列。
• 可拓展之处：
此类题目属于贪心策略结合构造方案的类型，类似套路是先分析题目中的关键条件，通过数学变换（如拆绝对值）找到可贪心的方向，再根据条件限制构造出满足贪心结果的方案。同类型题可考虑一些涉及序列重排并求最值的问题，通常需要挖掘序列元素间运算关系的特点来进行贪心。
• 推荐洛谷题目：
    - P1080 [NOIP2012 提高组] 国王游戏，涉及贪心策略和构造排列顺序。
    - P2123 皇后游戏，通过分析元素间关系进行贪心构造。
    - P3166 [CQOI2014] 数三角形，需要利用组合数学和贪心思想解决问题。
• 个人心得摘录与总结：
Tx_Lcy提到输出方案是具体数而非原数组位置这个坑点，提醒在做题时要仔细读题，明确输出要求，避免因这种细节问题导致失分。 

---
处理用时：25.07秒
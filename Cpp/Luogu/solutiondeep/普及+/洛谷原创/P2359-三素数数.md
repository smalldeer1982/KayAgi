# 题目信息

# 三素数数

## 题目背景

蛟川书院的一道练习题QAQ


## 题目描述

如果一个数的所有连续三位数字都是大于100的素数，则该数称为三素数数。比如113797是一个6位的三素数数。


## 说明/提示

区域动归QAQ


## 样例 #1

### 输入

```
4```

### 输出

```
204```

# AI分析结果

• 综合分析与结论：
    - 这些题解主要围绕动态规划（DP）算法求解三素数数问题。多数题解通过定义状态表示不同数位和末尾数字组合下的三素数数数量，利用素数判断条件建立状态转移方程。
    - 算法要点在于准确判断素数，初始化状态，以及正确实现状态转移。难点在于优化算法以应对较大的n值，部分题解通过打表、滚动数组、矩阵快速幂等方式优化。
    - 从质量上看，多数题解思路较清晰，但在代码可读性和优化程度上有所差异。

所选的题解：
  - 作者：dspr (5星)
    - 关键亮点：使用矩阵快速幂优化，能处理n = 10^9的数据，优化程度高。
    - 个人心得：无
    - 重点代码：
```cpp
struct matrix{
    ll a[_][_];
	matrix operator *(matrix b){
		matrix c;
		for(int i=1;i<=99;++i)
			for(int j=1;j<=99;++j){
				c.a[i][j]=0;
				for(int k=1;k<=99;++k)
					c.a[i][j]+=a[i][k]*b.a[k][j]%M;
				c.a[i][j]%=M;
			}
		return c;
	}
}b;
// 矩阵乘法实现

matrix js(matrix x,matrix y){
    matrix z;
    for(int i=1;i<=99;++i)
		for(int j=1;j<=99;++j){
			z.a[i][j]=0;
			for(int k=1;k<=99;++k)
				z.a[i][j]=(z.a[i][j]+x.a[i][k]*y.a[k][j])%M;
		}
    return z;
}
// 另一种矩阵乘法实现

while(n){
    if(n&1)ans=ans*b;
    b=b*b;
    n/=2;
}
// 矩阵快速幂核心代码
```
核心实现思想：构造转移矩阵，通过矩阵乘法和快速幂运算加速状态转移，减少时间复杂度。

  - 作者：d3ac (4星)
    - 关键亮点：思路清晰，常规DP解法，状态定义直观，代码简洁易懂。
    - 个人心得：无
    - 重点代码：
```cpp
for(int i=3;i<=n;i++)
		for(int now=1;now<=9;now++)
			for(int pre=0;pre<=9;pre++)
				for(int last=0;last<=9;last++)
					if(!prime[get(now,pre,last)]) 
						dp[i][now][pre]=(dp[i][now][pre]+dp[i-1][pre][last])%mod;
// 状态转移核心代码
```
核心实现思想：通过四层循环枚举数位、当前数字、前一个数字和上上个数字，根据素数判断更新状态。

  - 作者：Youngsc (4星)
    - 关键亮点：优化枚举过程，先筛出素数，定义更简洁的状态$f[i][j]$，减少无效枚举，提高效率。
    - 个人心得：无
    - 重点代码：
```cpp
for(R int i=4; i<=n; ++i){
        for(R int j=1; j<=p; ++j)
        {
            if(pri[j]<100) continue;
            f[i][pri[j]%100] = (f[i][pri[j]%100]+f[i-1][pri[j]/10])%mod;
        }
    }
// 状态转移核心代码
```
核心实现思想：遍历所有三位素数，直接根据素数的十位和个位更新状态，避免无效判断。

最优关键思路或技巧：
    - **矩阵快速幂优化**：当发现每次DP转移相同且转移次数固定时，使用矩阵快速幂能大幅优化时间复杂度，适用于大数据规模。
    - **减少无效枚举**：通过筛出素数，在状态转移时直接利用素数信息，避免对非素数的无效判断，提高算法效率。

可拓展之处：
    - 同类型题常涉及数字规律与状态转移，如数位DP相关问题，可通过定义合适状态和转移方程求解。类似算法套路包括利用数论知识优化判断条件，使用矩阵优化转移过程等。

推荐题目：
    - [P1028 数的计算](https://www.luogu.com.cn/problem/P1028)
    - [P1216 数字三角形](https://www.luogu.com.cn/problem/P1216)
    - [P1434 [SHOI2002]滑雪](https://www.luogu.com.cn/problem/P1434)

个人心得摘录与总结：
    - 无。 

---
处理用时：62.35秒
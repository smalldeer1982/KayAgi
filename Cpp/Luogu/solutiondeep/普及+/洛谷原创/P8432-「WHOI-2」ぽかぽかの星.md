# 题目信息

# 「WHOI-2」ぽかぽかの星

## 题目背景

![](bilibili:BV16J411x7nS)

你在雪洞里喝着热可可数星星。但这次，星星换成了数列，不过聪明的你一定能数清楚数列的吧。

## 题目描述

有多少个长度为 $n$ 的**正整数**数列 $a_i$ 满足：

- $0<a_1\leq a_2\leq a_3\dots \leq a_n\leq k$。
- $\forall i\not = j,a_i+a_j\not = k+1$。

答案对 $10^9+7$ 取模。

## 说明/提示

**本题采用捆绑测试**

- $\text{subtask1(20pts)}:T=5,1\leq n,k\le5$。
- $\text{subtask2(80pts)}:$ 无特殊限制。


对于 $100\%$ 的数据，$T\leq100,1\le n,k\le 5\times 10^6,1\leq  \sum n,  \sum  k\le6\times 10^7$。



## 样例 #1

### 输入

```
3
2 2
1145 1419
19198 12321```

### 输出

```
2
66937457
949924930```

# AI分析结果

### 综合分析与结论
这些题解的核心思路都是通过将原数列问题转化为每个数出现次数的问题，并依据\(k\)的奇偶性进行分类讨论来求解。主要算法要点在于利用组合数和插板法计算方案数，难点在于准确分析不同情况下的限制条件并推导出正确的组合数公式。各题解在思路清晰度、代码可读性和优化程度上存在差异。

### 所选的题解
1. **作者：Otomachi_Una_ (5星)**
    - **关键亮点**：思路清晰，直接针对\(100\%\)数据给出解法，详细阐述了公式中各项的含义，逻辑连贯。
    - **个人心得**：无
2. **作者：Alan_Zhao (4星)**
    - **关键亮点**：提供了另一种推导思路，通过设函数\(f(n, k)\)，利用范德蒙德卷积简化公式，方法独特。
    - **个人心得**：无
3. **作者：TernaryTree (4星)**
    - **关键亮点**：赛时推出式子，分类讨论清晰，详细说明了奇数情况时中间元素不同取值的方案数计算方法，并提及优化时间复杂度的思路。
    - **个人心得**：赛时因忘了线性求逆元导致TLE，强调了优化的重要性。

### 最优关键思路或技巧
- **分类讨论**：根据\(k\)的奇偶性分别分析，偶数时将数两两分组，奇数时特殊考虑中间数，准确把握不同情况下的限制条件。
- **组合数运用**：利用组合数\(C_m^i\)表示选择组数的方案，\(C_{n - 1}^{i - 1}\)等表示分配元素的方案，结合插板法解决元素分配问题。
- **预处理优化**：预处理阶乘及其逆元、二的幂次，降低计算组合数和相关式子的时间复杂度。

### 可拓展之处
同类型题常出现在计数类组合数学问题中，通常涉及对满足特定条件的序列或排列进行计数。类似算法套路为根据关键条件进行合理分类，利用组合数、排列数等工具计算方案数，同时注意通过预处理优化时间复杂度。

### 推荐题目
- [P3197 [HNOI2008]越狱](https://www.luogu.com.cn/problem/P3197)：通过分析相邻元素限制条件，利用组合数学知识计算方案数。
- [P2606 [ZJOI2010]排列计数](https://www.luogu.com.cn/problem/P2606)：根据排列的限制条件，运用组合数和递推思想求解。
- [P1313 计算系数](https://www.luogu.com.cn/problem/P1313)：结合二项式定理和组合数计算多项式系数。

### 重点代码及核心实现思想
1. **Otomachi_Una_ 题解无代码**
2. **Alan_Zhao 题解无代码**
3. **TernaryTree 题解无代码** 核心实现思想：先根据\(k\)的奇偶性推导出不同情况下的方案数公式，再通过预处理阶乘及其逆元来优化组合数计算，从而高效计算总方案数。 

---
处理用时：28.72秒
# 题目信息

# 「SWTR-8」15B03

## 题目背景

15B03 获得了 ION2064 的承办权。

## 题目描述

15B03 的座位非常拥挤，可以看成一张 $n\times m$ 的网格，每个小正方形 $(i, j)$ 代表一张桌子。

根据规定，考场上任何两张桌子不得相邻。这里相邻指含有 **公共点**。严格定义两张桌子 $(i, j)$ 和 $(i', j')$ 相邻当且仅当 $|i - i'|\leq 1$ 且 $|j - j'|\leq 1$。

布置考场的任务落在小 A 头上，他希望撤去最少的桌子满足上述要求。

小 A 认为这样太简单了，因此他添加了限制：在保证撤去桌子最少的前提下，最大化剩余每张桌子到距离它最远的桌子的距离之和。这里距离指 **欧几里得** 距离：桌子 $(a, b)$ 和 $(c, d)$ 的距离为 $\sqrt{(a - c) ^ 2 + (b - d) ^ 2}$。

平行时空中 15B03 的规模不尽相同：多组测试数据。

**请选手认真阅读本题的评分方式。**

## 说明/提示

**「样例解释」**

对于第一组询问，选择 $(1, 1), (1, 3), (3, 1)$ 和 $(3, 3)$ 最优。撤去了 $3\times 3 - 4 = 5$ 张桌子，且每张桌子到距离它最远的桌子的距离均为 $\sqrt{2 ^ 2 + 2 ^ 2} = 2\sqrt 2$，因此第二问答案为 $8\sqrt 2$。如下图所示：

![](https://cdn.luogu.com.cn/upload/image_hosting/y8fi4qhr.png)

对于第二组询问，选择 $(1, 1)$ 和 $(2, 4)$ 最优。撤去了 $2\times 4 - 2 = 6$ 张桌子，且每张桌子到距离它最远的桌子的距离均为 $\sqrt{1 ^ 2 + 3 ^ 2} = \sqrt {10}$，因此第二问答案为 $2\sqrt {10}$。

如果选择 $(1, 1)$ 和 $(2, 3)$，则第二问答案为 $2\sqrt 5$，不优。

**「评分方式」**

对于每组测试数据：

- 若你第一问的答案错误，得 0 分。
- 否则，若你第二问的答案错误，得 0.8 分。
- 否则，得 1 分。

每个测试点的得分为测试点内所有测试数据的得分的最小值乘以该测试点的分值。

注意，**若你输出的格式错误，得 0 分**。因此，如果你只希望获得第一问的分数，请在第二问输出任意合理范围内的实数。

**「数据范围与约定」**

- 测试点 #1（15 points）：$n, m$ 均为奇数。
- 测试点 #2（20 points）：$n = 1$。
- 测试点 #3（25 points）：$n = 2$。
- 测试点 #4（30 points）：$n$ 为奇数。
- 测试点 #5（10 points）：无特殊限制。

对于 $100\%$ 的数据：

- $1\leq T\leq 57$。
- $1\leq n, m\leq 1064$。

**「帮助与提示」**

- 你可以使用 `cmath` 中的 `sqrt(x)` 函数计算 $x$ 的平方根。它返回 `double` 类型的值。`sqrtl(x)` 精度更高，它返回 `long double` 类型的值。

**「题目来源」**

- [Sweet Round 8](https://www.luogu.com.cn/contest/73382) A
- Idea & Solution：[Alex_Wei](https://www.luogu.com.cn/user/123294)。
- Tester：[chenxia25](https://www.luogu.com.cn/user/138400)。

## 样例 #1

### 输入

```
0
4
3 3
2 4
15 57
1064 822```

### 输出

```
5 11.313708499
6 6.324555320
623 10206.135788972
655956 222400384.677931725
```

# AI分析结果

• 综合分析与结论：这些题解对于第一问思路较为统一，均通过贪心策略得出保留桌子数为 $\left\lceil \dfrac{n}{2}\right\rceil\times\left\lceil \dfrac{m}{2}\right\rceil$，进而得出撤去桌子数为 $n\times m-\left\lceil \dfrac{n}{2}\right\rceil\times\left\lceil \dfrac{m}{2}\right\rceil$。对于第二问，各题解通过对不同情况（如 $n$、$m$ 的奇偶性）进行分类讨论，利用贪心思想和几何性质，让桌子尽可能分散以最大化距离和。有的题解还利用对称性简化计算。

所选的题解：
  - 作者：iiiiiyang (5星)
    - 关键亮点：思路清晰，对各情况分析详细且配有大量图片辅助理解，代码注释详细。
    - 个人心得：作为构造题记录，强调了题目思维深度。
    - 重点代码（第二问核心实现）：
```cpp
if(n*m-r==1) {cout<<"0.000000000"<<endl; continue;}
long double ans=0.0;
long long k=1,j=1;
p=1,q=1;
for(k=1;k<=n;k+=2)
{
    q=1;
    for(j=1;j<=m;j+=2)
    {
        if(m%2==0&&j>(m/2)&&(q)) j++,q=0;
        long long x,y;
        if(k<=(n+1)/2) x=k;
        else x=n-k+1;
        if(j<=(m+1)/2) y=j;
        else y=m-j+1;
        ans+=sqrtl(((long double)((n-x)*(n-x))+((long double)((m-y)*(m-y)))));
    }
    if(n%2==0&&k+2>=(n/2)&&(p)) k++,p=0;
}
cout<<fixed<<setprecision(9)<<ans<<endl; 
```
核心实现思想：通过循环遍历保留的桌子，根据行列的奇偶性调整桌子位置，利用对称性计算每张桌子到最远桌子的距离并累加。
  - 作者：Alex_Wei (5星)
    - 关键亮点：对两问的解法阐述简洁清晰，给出构造方法并简要说明证明思路，代码简洁明了。
    - 重点代码（第二问核心实现）：
```cpp
if(n > 2 || m > 2) {
    if(m == 2) swap(n, m);
    for(int i = 1; i <= n + 1 >> 1; i++)
        for(int j = 1; j <= m + 1 >> 1; j++) {
            int x = i * 2 - 1, y = j * 2 - 1;
            if(n % 2 == 0 && x > n / 2) x++;
            if(m % 2 == 0 && y > m / 2) y++;
            int dx = max(x - 1, n - x);
            int dy = max(y - 1, m - y);
            ans += sqrt(dx * dx + dy * dy);
        }
}
```
核心实现思想：在满足条件时，通过循环遍历保留桌子的位置，根据行列奇偶性调整坐标，计算每张桌子到最远点的距离并累加。
  - 作者：snail2956 (4星)
    - 关键亮点：思路独特，将矩阵分成四份分别考虑，无需对特殊情况单独特判，代码实现较为简洁。
    - 重点代码（第二问核心实现）：
```cpp
if(n>2||m>2){
    for(int i=1;i<=(n+1)/2;i+=2){
        for(int j=1;j<=(m+1)/2;j+=2){
            d+=sqrtl((i-n)*(i-n)+(j-m)*(j-m));
        }
    }
    for(int i=n;i>n/2+1;i-=2){
        for(int j=m;j>m/2+1;j-=2){
            d+=sqrtl((i-1)*(i-1)+(j-1)*(j-1));
        }
    }
    for(int i=1;i<=(n+1)/2;i+=2){
        for(int j=m;j>m/2+1;j-=2){
            d+=sqrtl((i-n)*(i-n)+(j-1)*(j-1));
        }
    }
    for(int i=n;i>n/2+1;i-=2){
        for(int j=1;j<=(m+1)/2;j+=2){
            d+=sqrtl((i-1)*(i-1)+(j-m)*(j-m));
        }
    }
}
```
核心实现思想：将矩阵按不同区域分别遍历，计算每个区域内桌子到最远点的距离并累加。

最优的关键思路或技巧：
 - **分类讨论**：根据 $n$ 和 $m$ 的奇偶性对第二问进行分类讨论，简化问题求解。
 - **利用对称性**：意识到桌子分布和距离计算中的对称性，减少计算量。如将矩阵分成四份或利用行列对称来计算桌子到最远点的距离。

可拓展之处：此类问题属于网格布局优化问题，类似套路是通过分析问题性质，利用贪心策略和几何性质，结合分类讨论和对称性简化计算。

推荐题目：
 - [P1080 国王游戏](https://www.luogu.com.cn/problem/P1080)：涉及贪心策略和高精度计算。
 - [P1223 排队接水](https://www.luogu.com.cn/problem/P1223)：简单的贪心算法应用。
 - [P2123 皇后游戏](https://www.luogu.com.cn/problem/P2123)：需要通过分析性质得出贪心策略。 

---
处理用时：53.91秒
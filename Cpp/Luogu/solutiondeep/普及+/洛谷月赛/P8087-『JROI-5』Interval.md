# 题目信息

# 『JROI-5』Interval

## 题目背景

小 C 喜欢带有区间操作的数据结构，因为这样的题总会有一档好写的 $\mathcal{O}\left(n^2\right)$ 部分分。

## 题目描述


**本题读入量较大，建议使用较快的读入方式，可以参考 [赛时公告板](https://www.luogu.com.cn/paste/lueudpd5)**

小 C 有一个长度为 $n$ 的序列 $a$，第 $i$ 项为 $a_i$。

$a$ 是一个 $1\sim n$ 的排列（即 $1\sim n$ 在 $a$ 中各出现一次）。

定义 $\operatorname{Mex}_{l,r}$ 为 $\{a_l,a_{l+1},
\cdots,a_{r-1},a_r\}$ 中**没有出现过的最小正整数**。

例如，$\operatorname{Mex}\{2,3\}=1,\operatorname{Mex}\{1,2,3\}=4$。

小 C 还有一个长度为 $n$ 的数列 $f$。

定义一个区间 $\left[l,r\right]$ 是合法的当且仅当 
$$f_{r-l+1}< \operatorname{Mex}_{l,r}$$

小 C 希望你告诉他，最短的合法区间的长度是多少，特别的，如果没有区间合法，则输出 `0`。

## 说明/提示

【样例解释】

对于 #1，容易发现 $\left[1,3\right]$ 是最短的合法区间。

对于 #2，容易发现 $\left[3,3\right]$ 是最短的合法区间。

对于 #3，容易发现没有合法的区间。

---

对于 $10\%$ 的数据，满足 $1\leq n\leq 100$。

对于 $20\%$ 的数据，满足 $1\leq n\leq 1000$。

对于另外 $10\%$ 的数据，满足 $f$ 不升，即满足 $f_1\geq f_2\geq\cdots\geq f_n$，且 $1\leq n\leq 10^6$。

对于 $100\%$ 的数据，满足 $1\leq n\leq 4\times 10^6,1\leq f_i\leq 10^9$。


## 样例 #1

### 输入

```
5
2 3 1 5 4
2 2 3 4 5```

### 输出

```
3```

## 样例 #2

### 输入

```
5
2 3 1 5 4
1 2 2 4 5```

### 输出

```
1```

## 样例 #3

### 输入

```
5
1 3 4 2 5
6 7 8 9 10```

### 输出

```
0```

## 样例 #4

### 输入

```
见附件```

### 输出

```
见附件```

# AI分析结果

• 综合分析与结论：这些题解主要围绕如何高效求出满足 \(f_{r - l + 1} < \text{Mex}_{l,r}\) 的最短区间长度。多数题解思路基于对 \(\text{Mex}\) 函数性质的挖掘及与 \(f\) 数组的关联分析。算法要点集中在通过记录数字位置，利用前缀最值、差分、贪心等方法优化计算。难点在于如何在 \(\mathcal{O}(n)\) 时间复杂度内准确判断合法区间。部分题解通过从不同角度枚举（如枚举区间长度、\(\text{Mex}\) 值等），结合对条件的等价转换来解决问题。

所选的题解：
  - 作者：caibet (5星)
    - 关键亮点：思路清晰，先明确贪心思路即对每个区间长度找最大 \(\text{Mex}\) 值与 \(f\) 值比较，利用差分优化计算最大 \(\text{Mex}\) 值过程，代码简洁高效。
    - 核心代码实现思想：通过记录每个数字位置，在遍历数字过程中撑大区间并利用差分记录每个区间长度对应的最大 \(\text{Mex}\) 值，最后比较 \(b_i\) 和 \(f_i\) 得出结果。
    ```cpp
    namespace{
        const int lim=4e6+2;
        int n,a[lim],f[lim],p[lim],b[lim],L=0x7f7f7f7f,R=0;
        void work(){
            n=read();
            F(i,1,<=n) a[i]=read(),p[a[i]]=i;
            F(i,1,<=n) f[i]=read();
            b[1]=1;
            F(i,1,<=n){
                L=min(L,p[i]);
                R=max(R,p[i]);
                ++b[R-L+1];
            }
            F(i,1,<=n){
                b[i]+=b[i-1];
                if(f[i]<b[i]){
                    cout<<i;
                    return;
                }
            }
            cout<<0;
        }
    }
    ```
  - 作者：蒟蒻炒扇贝 (4星)
    - 关键亮点：从构造满足条件序列角度出发，思路新颖易懂，通过预处理前缀最值数组，在 \(\mathcal{O}(1)\) 时间复杂度内验证区间合法性，整体代码逻辑清晰。
    - 核心代码实现思想：先读入数据并记录每个数字位置，预处理前缀最值数组 \(qmin\) 和 \(qmax\)，然后从小到大枚举区间长度 \(i\)，通过 \(qmin[f_i]\) 和 \(qmax[f_i]\) 判断是否存在长度为 \(i\) 的合法区间。
    ```cpp
    int main()
    {
        cin>>n;
        for(int i=1;i<=n;i++)a[i]=read(),pos[a[i]]=i;
        for(int i=1;i<=n;i++)f[i]=read();
        qmin[0]=2e9,qmax[0]=-2e9;
        for(int i=1;i<=n;i++)qmin[i]=min(qmin[i-1],pos[i]),qmax[i]=max(qmax[i-1],pos[i]);
        for(int i=1;i<=n;i++)
        {
            if(f[i]>n)continue;
            int l=qmin[f[i]],r=qmax[f[i]];
            if(r-l+1<=i)
            {
                cout<<i;
                return 0;
            }
        }
        cout<<0;
        return 0;
    }
    ```
  - 作者：Cocoly1990 (4星)
    - 关键亮点：官方题解，对 \(\text{Mex}\) 单调性分析透彻，通过改写条件，枚举 \(\text{Mex}\) 值并利用前缀最值快速求解满足条件的最短区间，时间复杂度 \(\mathcal{O}(n)\)，思路严谨。
    - 核心代码实现思想：先记录每个数位置并计算前缀最值数组 \(_max\) 和 \(_min\)，然后求出满足 \(\text{Mex}=i + 1\) 的最短区间长度 \(g[i]\)，最后枚举区间长度判断是否满足条件。
    ```cpp
    for(int i = 1; i <= n; i ++)
        pos[a[i]] = i;    
    _min[0] = n + 1;
    for(int i = 1; i <= n; i ++){
        _max[i] = max(_max[i - 1], pos[i]);
        _min[i] = min(_min[i - 1], pos[i]);
    }

    for(int i = 1; i <= n; i ++)
        g[i] = _max[i] - _min[i] + 1;

    int ans = 0;
    for(int i = 1; i <= n; i ++){
        if(f[i] <= n && g[f[i]] <= i){
            ans = i;
            break; 
        } 
    }
    ```

最优关键思路或技巧：利用记录数字位置结合前缀最值计算的方法，快速判断满足条件的区间。通过对条件的等价转换和对 \(\text{Mex}\) 性质（如单调性）的深入挖掘，避免暴力枚举区间，从而将时间复杂度优化到 \(\mathcal{O}(n)\)。

可拓展之处：同类型题可涉及更多关于区间操作及特殊函数（如 \(\text{Mex}\) 类似定义函数）的分析，类似算法套路为从条件出发，挖掘函数性质，通过合理枚举和数据预处理优化计算过程。

推荐题目：
1. P1440 求m区间内的最小值，涉及区间最值问题。
2. P1886 滑动窗口，经典的区间最值维护问题。
3. P3865 【模板】ST表，可用于快速查询区间最值，与本题利用前缀最值思路相关。

个人心得：无。 

---
处理用时：55.51秒
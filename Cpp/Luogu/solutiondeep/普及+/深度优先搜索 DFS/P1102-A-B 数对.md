# 题目信息

# A-B 数对

## 题目背景

出题是一件痛苦的事情！

相同的题目看多了也会有审美疲劳，于是我舍弃了大家所熟悉的 A+B Problem，改用 A-B 了哈哈！

## 题目描述

给出一串正整数数列以及一个正整数 $C$，要求计算出所有满足 $A - B = C$ 的数对的个数（不同位置的数字一样的数对算不同的数对）。

## 说明/提示

对于 $75\%$ 的数据，$1 \leq N \leq 2000$。

对于 $100\%$ 的数据，$1 \leq N \leq 2 \times 10^5$，$0 \leq a_i <2^{30}$，$1 \leq C < 2^{30}$。

2017/4/29 新添数据两组

## 样例 #1

### 输入

```
4 1
1 1 2 3
```

### 输出

```
3```

# AI分析结果



### 综合分析与结论
本题核心在于高效统计满足A-B=C的数对。各题解主要采用三种思路：哈希映射统计频率（map/unordered_map）、排序后二分查找、双指针法。其中哈希法最直观，二分法最稳定，双指针法效率最优但实现稍复杂。需特别注意处理重复元素和数值范围问题。

---

### 精选题解（评分≥4星）

#### 1. 作者：OsvaldoAsensioLopez（★★★★☆）
**关键亮点**  
- 巧用map将A-B=C转化为A-C=B，两次遍历完成统计  
- 代码简洁易懂，利用STL容器降低实现难度  
- 时间复杂度O(n log n)，适合快速实现  

**核心代码**  
```cpp
map<LL,LL> m;
for(int i=1;i<=n;i++) {
    cin >> a[i];
    m[a[i]]++;      // 第一次遍历统计频率
    a[i] -= c;      // 预处理为A-C
}
for(int i=1;i<=n;i++) 
    ans += m[a[i]]; // 第二次遍历统计结果
```

#### 2. 作者：樱花飞舞（★★★★☆）
**关键亮点**  
- 经典排序+二分查找，利用STL函数简化实现  
- 通过upper_bound和lower_bound准确统计区间长度  
- 稳定O(n log n)时间复杂度，适合通用场景  

**核心代码**  
```cpp
sort(a+1, a+n+1);
for(int i=1; i<=n; i++) {
    auto l = lower_bound(a+1, a+n+1, a[i]+c);
    auto r = upper_bound(a+1, a+n+1, a[i]+c);
    ans += r - l; // 直接计算区间长度
}
```

#### 3. 作者：jins3599（★★★★☆）
**关键亮点**  
- 双指针法实现高效遍历，时间复杂度O(n log n)  
- 巧妙处理重复元素的连续区间，避免重复计算  
- 空间复杂度O(1)，适合内存敏感场景  

**核心代码**  
```cpp
sort(a+1, a+n+1);
int l=1, r1=1, r2=1;
for(l=1; l<=n; l++) {
    while(r1<=n && a[r1]-a[l]<=c) r1++;
    while(r2<=n && a[r2]-a[l]<c)  r2++;
    if(a[r2]-a[l]==c) 
        ans += r1 - r2; // 计算有效区间长度
}
```

---

### 最优思路总结
**核心技巧**：将原式转换为B=A-C后，使用哈希结构统计频率。对于大数据量，优先采用unordered_map（期望O(1)查询）或双指针法。若需稳定复杂度，排序后二分是最保险的选择。

**拓展思考**：  
- 类似问题可举一反三（如两数之和、三数之和）  
- 当C=0时需特殊处理（允许相同元素不同位置的组合）  
- 大数据量下哈希表可能触发扩容机制，可预先reserve优化  

---

### 推荐练习题
1. P1678 烦恼的高考志愿（二分查找应用）  
2. P1102 A-B数对（本题）  
3. P1147 连续自然数和（双指针经典）  
4. P1638 逛画展（滑动窗口/双指针）  

---

### 调试经验摘录
1. "map的插入顺序不影响结果，但需注意重复键的自增处理" —— 强调哈希表统计时对重复元素的正确累加  
2. "双指针移动时要先处理边界条件再计算区间" —— 指针类算法需注意遍历顺序  
3. "ans必须用long long防止溢出" —— 大数据量统计的常见陷阱

---
处理用时：110.67秒
# 题目信息

# [CQOI2007] 三角形

## 题目描述

画一个等边三角形，把三边的中点连接起来，得到四个三角形，把它们称为 $T_1,T_2,T_3,T_4$，如图1。

把前三个三角形也这样划分，得到 $12$ 个更小的三角形，$T_{11},T_{12},T_{13},T_{14},T_{21},T_{22},T_{23},T_{24},T_{31},T_{32},T_{33},T_{34}$，如图2。

把编号以 $1,2,3$ 结尾的三角形又继续划分……最后得到的分形称为 Sierpinski 三角形。

![](https://cdn.luogu.com.cn/upload/pic/18501.png)

如果三角形 $B$ 不包含三角形 $A$，且 $A$ 的某一条完整的边是 $B$ 的某条边的一部分，则我们说 $A$ 靠在 $B$ 的边上。例如 $T_{12}$ 靠在 $T_{14}$ 和 $T_4$ 上，但不靠在 $T_{32}$ 上。

给出 Spierpinski 三角形中的一个三角形，找出它靠着的所有三角形。

## 说明/提示

对于 $100 \%$ 的数据，$1 \le n \le 50$。

## 样例 #1

### 输入

```
T312```

### 输出

```
T314
T34
T4```

# AI分析结果



### 综合分析与结论
本题核心在于通过分形结构分析三角形邻接关系。各题解普遍采用字符串处理与递归思想，核心规律为：  
1. 末位为4时，邻接三角形为同层1/2/3结尾的三角形  
2.非4结尾时，邻接三角形由各层级首次出现数字对应的中央三角形（4结尾）构成  
最优解法通过倒序扫描+首次出现标记实现O(n)时间复杂度

---

### 精选题解推荐
#### 1. 作者：xiaozeyu（⭐⭐⭐⭐⭐）
**关键亮点**：  
- 倒序扫描字符，利用首次出现标记避免重复  
- 代码简洁高效（仅20行核心逻辑）  
- 通过画图找规律建立直观理解  

**核心代码**：
```cpp
for(int j=len-1;j>0;j--) {
    if(!flag[a[j]-'0']) { // 首次出现该数字
        cout<<前缀+"4"<<endl;
        flag[a[j]-'0']=1;
    }
    if(flag[1]&&flag[2]&&flag[3]) break; // 提前退出
}
```
**实现思想**：倒序扫描每个字符，当遇到首次出现的1/2/3时，生成该层级的中央三角形编号

---

#### 2. 作者：RedreamMer（⭐⭐⭐⭐）
**关键亮点**：  
- 正序扫描构建三边关系  
- 利用数组存储三边结果  
- 代码结构清晰易理解  

**核心代码**：
```cpp
for(int i=1; i<=len; i++) {
    if(s[i]=='1') ss[0] = 前缀+"4"; // 下边
    else if(s[i]=='2') ss[1] = 前缀+"4"; // 右边
    else if(s[i]=='3') ss[2] = 前缀+"4"; // 左边 
}
```
**实现思想**：正序处理每个字符，根据数字类型更新对应边的邻接三角形

---

#### 3. 作者：Fire_flame（⭐⭐⭐⭐）
**关键亮点**：  
- 利用哈希表统计不同数字数量  
- 分类讨论角/边/内部三种情况  
- 提供清晰的数学归纳证明  

**核心思想**：  
```cpp
unordered_map<char, bool> mp;
int tot = mp['1'] + mp['2'] + mp['3'] + mp['4'];
if(tot==1) { /* 角处理 */ } 
else if(tot==2) { /* 边处理 */ }
else { /* 内部处理 */ }
```

---

### 关键思路总结
**核心技巧**：  
1. **倒序首次出现原则**：从末位向前扫描，每个数字首次出现的位置对应唯一邻接的中央三角形  
2. **状态标记法**：使用bool数组标记1/2/3是否已处理，确保每个类型只生成一次  
3. **字符串截断操作**：`s.substr(0,i)`快速生成前缀字符串  

**思维突破点**：  
- 将分形结构的层级关系转化为字符串操作  
- 利用4结尾的三角形作为各层级的"锚点"  
- 排除包含关系的干扰，通过字符串长度判断层级大小  

---

### 拓展练习推荐
1. [P1220 分形](https://www.luogu.com.cn/problem/P1220) - 分形图形生成  
2. [P1490 买蛋糕](https://www.luogu.com.cn/problem/P1490) - 字符串模式匹配  
3. [P1363 幻想迷宫](https://www.luogu.com.cn/problem/P1363) - 无限分形结构分析  

---

### 题解心得摘录
**作者xiaozeyu**：  
> "通过画图找规律，发现每个数字第一次出现的位置决定了邻接关系，重复数字不会产生新邻接"  
**启示**：图形类题目可通过小规模画图建立直觉，再转化为算法逻辑  

**作者AE酱**：  
> "DFS递归维护三边关系时，需注意正三角与倒三角的方向差异"  
**教训**：递归参数设计需明确物理意义，避免方向混淆  

**作者Fire_flame**：  
> "利用哈希表统计字符种类时，发现字符串特征与几何位置的对应关系"  
**方法论**：将几何特征转化为可计算的离散特征（如字符种类数）是解题关键

---
处理用时：55.06秒
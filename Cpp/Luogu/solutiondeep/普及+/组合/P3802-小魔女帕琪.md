# 题目信息

# 小魔女帕琪

## 题目背景

从前有一个聪明的小魔女帕琪，兴趣是狩猎吸血鬼。

帕琪能熟练使用七种属性（金、木、水、火、土、日、月）的魔法，除了能使用这么多种属性魔法外，她还能将两种以上属性组合，从而唱出强力的魔法。比如说为了加强攻击力而将火和木组合，为了掩盖弱点而将火和土组合等等，变化非常丰富。

## 题目描述

现在帕琪与强大的夜之女王，吸血鬼蕾咪相遇了，夜之女王蕾咪具有非常强大的生命力，普通的魔法难以造成效果，只有终极魔法：帕琪七重奏才能对蕾咪造成伤害。帕琪七重奏的触发条件是：连续施放的 $7$ 个魔法中，如果魔法的属性各不相同，就能触发一次帕琪七重奏。

请注意，无论前 $6$ 个魔法是否已经参与施放终极魔法，只要连续 $7$ 个魔法的属性各不相同，就会再触发一次终极魔法。例如，如果用序号来代表一种魔法，魔法的施放序列为 $1, 2, 3, 4, 5, 6,7, 1$，则前 $7$ 个魔法会触发一次终极魔法，后 $7$ 个魔法会再触发一次终极魔法。

现在帕琪有 $7$ 种属性的能量晶体，第 $i$ 种晶体可以施放出属性为 $i$ 的魔法，共有 $a_i$ 个。每次施放魔法时，会等概率随机消耗一个现有的能量晶体，然后释放一个对应属性的魔法。

现在帕琪想知道，她触发帕琪七重奏的期望次数是多少，可是她并不会算，于是找到了学 OI 的你。

## 说明/提示

#### 样例输入输出 1 解释

显然一定会触发一次帕琪七重奏。

#### 数据规模与约定

- 对于 $30\%$ 的数据，保证 $\sum_{i = 1}^7 a_i \leq 10$。
- 对于 $100\%$ 的数据，保证 $0 \leq a_i \leq 10^9$，且 $\sum_{i = 1}^7 a_i \leq 10^9$。

## 样例 #1

### 输入

```
1 1 1 1 1 1 1```

### 输出

```
1.000```

# AI分析结果

### 综合分析与结论
这些题解主要围绕计算触发帕琪七重奏的期望次数展开。核心思路都是先计算前7个魔法触发七重奏的概率，再结合可触发的位置数量得出期望。
- **思路**：多数题解先考虑前7个魔法属性各不相同的概率，通过排列组合计算所有可能顺序的概率。然后利用魔法发动互不影响这一特性，说明任意连续7位触发七重奏的概率相同，进而乘以可触发的位置数（总魔法数 - 6）得到期望。
- **算法要点**：涉及概率计算、排列组合知识，关键在于理解不同位置触发七重奏概率相等这一性质。
- **解决难点**：难点在于证明或理解不同位置触发概率相同，部分题解通过举例或推导条件概率来解释。

### 所选的题解
- **作者：ButterflyDew（5星）**
    - **关键亮点**：思路阐述详细，通过举例对条件概率和不同位置触发概率相同进行了感性说明，代码简洁明了。
    - **个人心得**：提到之前写的有问题，强调了题解准确性的重要性。
    - **重点代码核心思想**：通过循环依次读入每种属性晶体数量并求和，再通过循环计算概率公式中的各项乘积，最后得出期望结果。
```cpp
#include <cstdio>
double a[8],s,ans=1;
int main()
{
    for(int i=1;i<=7;i++)
    {
        scanf("%lf",a+i);
        s+=a[i];
    }
    for(int i=1;i<=6;i++)
        ans=ans*a[i]/(s+1-i)*double(i);
    ans=ans*a[7]*7.0;
    printf("%.3lf\n",ans);
    return 0;
}
```
- **作者：command_block（4星）**
    - **关键亮点**：推导过程严谨，先计算前7次触发概率，再详细推导第8次触发概率并证明与前7次相同，逻辑清晰。
    - **重点代码核心思想**：读入数据并求和，判断总数量是否小于7，若不小于则通过循环计算概率乘积，最后得出期望并输出。
```cpp
#include<cstdio>
using namespace std;
double a[10],N,ans=1;
int main()
{
  for(int i=1;i<=7;i++){
    scanf("%lf",&a[i]);
    N+=a[i];
  }if (N<7){
   printf("0.000");
    return 0;
  }for(int i=1;i<=7;i++)
    ans=ans*a[i]/(N-i+1);
  printf("%.3lf\n",ans*1*2*3*4*5*6*7*(N-6));
  return 0;
}
```
- **作者：codecode（4星）**
    - **关键亮点**：对“任意连续7位构成终极魔法的概率一样”这一核心性质阐述深刻，从序列整体角度理解问题，解题思路清晰。
    - **重点代码核心思想**：读入数据并求和，计算前7位构成终极魔法的概率，乘以可触发位置数得到期望并输出。
```cpp
#include<bits/stdc++.h>
using namespace std;
int n;
double a[8],ans;
int main(){
    for(int i=1;i<=7;i++)
        cin>>a[i],n+=a[i];
    ans=a[1]*1.0/n*a[2]/(n-1)*a[3]/(n-2)*a[4]/(n-3)*a[5]/(n-4)*a[6]/(n-5)*a[7]*5040;
    //7!=5040
    printf("%.3f",ans);
    return 0;
}
```

### 最优关键思路或技巧
理解并利用“任意连续7位构成终极魔法的概率相同”这一性质，将问题简化为计算前7位触发概率，再乘以可触发的位置数。这种从整体序列角度分析概率期望问题的思维方式是解题关键。

### 可拓展思路
此类题目属于概率期望与排列组合结合的问题。相似套路是先分析单一事件概率，再依据事件间关系（如相互独立等）确定整体概率或期望。同类型题可能会改变触发条件、元素种类或数量限制等。

### 相似知识点洛谷题目
- [P1850 换教室](https://www.luogu.com.cn/problem/P1850)：涉及概率与动态规划结合。
- [P4316 绿豆蛙的归宿](https://www.luogu.com.cn/problem/P4316)：图上的概率期望问题。
- [P2059  [JLOI2013]卡牌游戏](https://www.luogu.com.cn/problem/P2059)：概率期望与模拟结合。 

---
处理用时：31.59秒
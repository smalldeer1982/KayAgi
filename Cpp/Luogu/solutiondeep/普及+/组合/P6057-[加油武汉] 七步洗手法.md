# 题目信息

# [加油武汉] 七步洗手法

## 题目背景

现在正处于疫情防控的关键时期，大家要经常洗手，防止接触感染。

[正确的洗手方法](https://dxy.com/column/4473)

## 题目描述

给定一张含有 $n$ 个点的无向完全图，其中 $m$ 条边是白边，其余是黑边。

现在需要你求出同色的三元环（或者说，三角形）的个数。

## 说明/提示

 - 对于 $20\%$ 的数据，满足 $n \leq 200$；
 - 对于 $50\%$ 的数据，满足 $n \leq 2000$；
 - 对于 $100\%$ 的数据，满足 $1 \leq n \leq 10^5,1 \leq m \leq 3\times 10^5$。

## 样例 #1

### 输入

```
5 3
1 5
2 5
3 5```

### 输出

```
4```

# AI分析结果

### 综合分析与结论
所有题解核心思路均为通过计算异色三角形数量，用三角形总数减去异色三角形数得到同色三角形数。不同之处在于计算异色三角形的具体方法。
1. **未见堇开**：利用补集转化思想，定义异色角，通过统计每个点的异色角数目（每个异色三角形含2个异色角且不重复），除以2得到异色三角形数，时间复杂度$O(n)$。代码简洁明了，直接实现该思路。
2. **_Freedom_**：分三步，先计算完全图三元环总数，再减去几乎所有含白边的三元环（认为白边少，含白边三元环几乎异色），最后修正多减的部分（考虑两条白边交于一点的情况），时间复杂度$O(n + m)$。
3. **Star_Wind**：与未见堇开类似，通过统计每个点连接白边和黑边数量计算异色三角形数，用vector存储白边信息，时间复杂度$O(n + m)$。
4. **Fairicle**：思路同未见堇开，通过计算每个端点连接白边和黑边构成不合法三元环数，再除以2得到异色三角形数。
5. **Skyjoy**：先计算三角形总数，再统计不合法三元环数（与上述部分思路相同），注意到数据范围需用long long。
6. **一叶知秋。**：分两种情况讨论不合法三元环，通过白边建图，分别计算含一条白边和两条白边的不合法三元环数，过程较复杂。

综合来看，未见堇开的题解思路清晰，代码简洁高效，优化程度高；Star_Wind和Fairicle思路类似且表述清晰；_Freedom_思路独特但稍显复杂。

### 所选题解
1. **未见堇开 - 5星**
    - **关键亮点**：巧妙运用补集转化思想，通过定义异色角简化计算，时间复杂度最优为$O(n)$，代码简洁明了。
    - **核心代码**：
```cpp
#include<cstdio>
#define reg register
#define MAXN 100001
using namespace std;

typedef long long ll;

int deg[MAXN];
ll ans=0;
int n,m;

int main()
{
    scanf("%d %d",&n,&m);
    for(reg int i=1;i<=m;i++)
    {
        int u,v;
        scanf("%d %d",&u,&v);
        ++deg[u],++deg[v];
    }
    for(reg int i=1;i<=n;i++)
        ans+=(1ll*deg[i]*(n-1-deg[i]));
    printf("%lld",1ll*n*(n-1)*(n-2)/6-(ans>>1));
    return(0);
}
```
    - **核心实现思想**：先统计每个点的度数（即连接白边数），通过`deg[i]*(n - 1 - deg[i])`计算每个点的异色角数目，累加后除以2得到异色三角形数，用三角形总数`n*(n - 1)*(n - 2)/6`减去异色三角形数得到同色三角形数。
2. **Star_Wind - 4星**
    - **关键亮点**：思路清晰，利用vector存储白边信息，同样通过计算异色三角形数求解，代码实现简洁。
    - **核心代码**：
```cpp
#include<bits/stdc++.h>
using namespace std;
typedef long long ll;
vector<int> v[300023];
int n,m,a,b;
ll sum;
int main()
{
    cin>>n>>m;
    for(register int i=1;i<=m;i++)
    {
        scanf("%d%d",&a,&b);
        v[a].push_back(b);
        v[b].push_back(a);
    }
    for(register int i=1;i<=n;i++)
      sum+=(v[i].size()*(n-v[i].size()-1));
    cout<<(ll)n*(n-1)*(n-2)/6-sum/2;
    return 0;
}
```
    - **核心实现思想**：用vector数组`v`存储每个点连接的白边对应的点，通过`v[i].size()`获取每个点连接的白边数，计算异色三角形数，再用三角形总数减去得到同色三角形数。
3. **Fairicle - 4星**
    - **关键亮点**：思路简洁直接，清晰阐述总方案和不合法方案的计算方法。
    - **核心代码**：
```cpp
    ll all = n * ( n - 1 ) / 2 * ( n - 2 ) / 3;
    ll illegal = 0;
    for(register int i=1;i<=n;++i)
    {
        illegal += white[i] * ( n - white[i] - 1);
    }
    cout<<all-(illegal/2);
```
    - **核心实现思想**：先计算三角形总数`all`，通过遍历每个点，用`white[i] * ( n - white[i] - 1)`计算每个端点构成的不合法三元环数，累加后除以2得到不合法三角形数，用总数`all`减去得到同色三角形数。

### 最优关键思路或技巧
补集转化思想，将难以直接计算的同色三角形问题转化为计算异色三角形问题，通过巧妙定义异色角或利用点连接不同颜色边的数量关系简化计算过程，优化时间复杂度。

### 可拓展思路
此类题目可拓展到其他图结构或染色问题，例如在有向图中寻找同色或异色的特定子图结构，或在多种颜色染色的图中寻找满足条件的子图。通用方法仍是通过转化问题，寻找易于计算的中间量来求解。

### 相似知识点洛谷题目
1. [P1330 封锁阳光大学](https://www.luogu.com.cn/problem/P1330)：涉及图的遍历和简单的逻辑判断，与本题对图结构的分析有相似之处。
2. [P1135 奇怪的电梯](https://www.luogu.com.cn/problem/P1135)：虽然是简单的广搜题目，但在分析问题和寻找解决方案的思路上有共通点，需要对给定条件进行合理转化。
3. [P1596 湖计数](https://www.luogu.com.cn/problem/P1596)：关于图的连通性问题，同样需要通过一定的算法和思路来处理图中的元素，与本题在处理图相关问题的思维方式上类似。

### 个人心得摘录与总结
1. **Skyjoy**：“十年$OI$一场空，不开$long\ long$见祖宗。”总结出在处理大数据范围时，数据类型选择不当易导致错误，需注意数据范围避免溢出。
2. **一叶知秋。**：“今天月赛一点开就是这种毒瘤题，真的不想活了啊啊啊啊啊”表达做题时的感受，同时提到看到题面和数据范围意识到直接求不行，要转换思路求不合法个数，强调分析题目条件对解题思路的引导作用。 

---
处理用时：40.25秒
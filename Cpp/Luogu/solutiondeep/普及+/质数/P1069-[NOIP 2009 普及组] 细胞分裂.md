# 题目信息

# [NOIP 2009 普及组] 细胞分裂

## 题目描述

Hanks 博士是 BT（Bio-Tech，生物技术）领域的知名专家。现在，他正在为一个细胞实验做准备工作：培养细胞样本。

Hanks 博士手里现在有 $N$ 种细胞，编号从 $1 \sim N$，一个第 $i$ 种细胞经过 $1$ 秒钟可以分裂为 $S_i$ 个同种细胞（$S_i$ 为正整数）。现在他需要选取某种细胞的一个放进培养皿，让其自由分裂，进行培养。一段时间以后，再把培养皿中的所有细胞平均分入 $M$ 个试管，形成 $M$ 份样本，用于实验。Hanks 博士的试管数 $M$ 很大，普通的计算机的基本数据类型无法存储这样大的 $M$ 值，但万幸的是，$M$ 总可以表示为 $m_1$ 的 $m_2$ 次方，即 $M = m_1^{m_2}$，其中 $m_1,m_2$ 均为基本数据类型可以存储的正整数。

注意，整个实验过程中不允许分割单个细胞，比如某个时刻若培养皿中有 $4$ 个细胞，Hanks 博士可以把它们分入 $2$ 个试管，每试管内 $2$ 个，然后开始实验。但如果培养皿中有 $5$ 个细胞，博士就无法将它们均分入 $2$ 个试管。此时，博士就只能等待一段时间，让细胞们继续分裂，使得其个数可以均分，或是干脆改换另一种细胞培养。

为了能让实验尽早开始，Hanks 博士在选定一种细胞开始培养后，总是在得到的细胞“刚好可以平均分入 $M$ 个试管”时停止细胞培养并开始实验。现在博士希望知道，选择哪种细胞培养，可以使得实验的开始时间最早。


## 说明/提示

【输入输出样例 \#1 说明】

经过 $1$ 秒钟，细胞分裂成 $3$ 个，经过 $2$ 秒钟，细胞分裂成 $9$个，……，可以看出无论怎么分裂，细胞的个数都是奇数，因此永远不能分入 $2$ 个试管。

【输入输出样例 \#2 说明】

第 $1$ 种细胞最早在 $3$ 秒后才能均分入 $24$ 个试管，而第 $2$ 种最早在 $2$ 秒后就可以均分（每试管 $144 / {24}^1 = 6$ 个）。故实验最早可以在 $2$ 秒后开始。

【数据范围】

对于 $50 \%$ 的数据，有 $m_1^{m_2} \le 30000$。

对于所有的数据，有 $1 \le N \le 10000$，$1 \le m_1 \le 30000$，$1 \le m_2 \le 10000$，$1 \le S_i \le 2 \times {10}^9$。


NOIP 2009 普及组 第三题


## 样例 #1

### 输入

```
1 
2 1 
3
```

### 输出

```
-1
```

## 样例 #2

### 输入

```
2
24 1
30 12
```

### 输出

```
2
```

# AI分析结果

### 综合分析与结论

本题的核心在于通过质因数分解来判断细胞分裂后的数量是否能被试管数整除，并找到最小的分裂时间。大多数题解都采用了质因数分解的思路，但实现方式和优化程度有所不同。部分题解通过递归或迭代的方式逐步求解，而另一些则直接通过最大公约数（GCD）和质因数分解来简化问题。

### 所选高星题解

#### 1. **暗ざ之殇 (5星)**
- **关键亮点**：通过递归求解最大公约数（GCD）来逐步简化问题，思路清晰且代码简洁。作者详细解释了每一步的数学推导，并提供了完整的代码实现。
- **个人心得**：作者在推导过程中提到“无论多少次方都不能整除”的定理，帮助理解问题的本质。
- **核心代码**：
  ```cpp
  while(m!=1) {
      gcdd=gcd(m,s);
      if(gcdd==1) {flag=0;break;}
      m/=gcdd;
      q=s/gcdd;
      s=gcdd;
      t++;
  }
  ```
  **实现思想**：通过不断求最大公约数，逐步将问题简化，直到无法继续分解。

#### 2. **刘心远 (4星)**
- **关键亮点**：直接对试管数和细胞数进行质因数分解，通过比较质因数的指数来求解最小分裂时间。代码结构清晰，逻辑严谨。
- **核心代码**：
  ```cpp
  for(int i=1;i<=n;i++) {
      cin>>cell; j=1; now=0; here=true;
      memset(cell_prime,0,sizeof(cell_prime));
      while(j<=sum_prime) {
          if(cell%prime[j]==0)
              while(cell%prime[j]==0) {cell_prime[j]++; cell/=prime[j];}
          j++;
      }
      for(j=1;j<=sum_prime;j++) {
          if(pipe_prime[j]!=0&&cell_prime[j]==0)here=false;
          if(pipe_prime[j]!=0&&cell_prime[j]!=0) {
              if(pipe_prime[j]%cell_prime[j]==0)
                  now=max(now,pipe_prime[j]/cell_prime[j]);
              else now=max(now,pipe_prime[j]/cell_prime[j]+1);
          }
      }
      if(here){flag=true; if(now<minn)minn=now;}
  }
  ```
  **实现思想**：通过质因数分解和指数比较，直接求解最小分裂时间。

#### 3. **DiaoHantong (4星)**
- **关键亮点**：通过质因数分解和指数比较，直接求解最小分裂时间。代码简洁且高效，逻辑清晰。
- **核心代码**：
  ```cpp
  for(int i=1;i<=n;i++) {
      cin>>s[i];
      zys2(s[i]);
      bool fl=true;
      int sum=0;
      for(int j=1;j<=cnt;j++) {
          if(numm[is_prime[j]]&&!numa[is_prime[j]]) {fl=false; break;}
          if(numa[is_prime[j]]) {
              sum=max(sum,numm[is_prime[j]]/numa[is_prime[j]]+(numm[is_prime[j]]%numa[is_prime[j]]?1:0));
          }
      }
      if(fl) {mn=min(mn,sum); flag=true;}
      memset(numa,0,sizeof(numa));
  }
  ```
  **实现思想**：通过质因数分解和指数比较，直接求解最小分裂时间。

### 最优关键思路与技巧
1. **质因数分解**：几乎所有题解都采用了质因数分解的思路，这是解决本题的核心方法。
2. **最大公约数（GCD）**：部分题解通过递归或迭代求解GCD来逐步简化问题，减少了计算的复杂度。
3. **指数比较**：通过比较试管数和细胞数的质因数指数，直接求解最小分裂时间。

### 可拓展之处
- **同类型题**：类似的问题可以通过质因数分解和指数比较来解决，如判断一个数是否能被另一个数整除，或者求解最小公倍数等问题。
- **算法套路**：质因数分解和GCD的结合可以用于解决许多数论问题，如求解最大公约数、最小公倍数、判断整除性等。

### 推荐题目
1. **P1075 [NOIP2012 普及组] 质因数分解**：考察质因数分解的基本应用。
2. **P1082 [NOIP2012 提高组] 同余方程**：考察GCD和扩展欧几里得算法的应用。
3. **P1068 [NOIP2009 普及组] 分数线划定**：考察排序和简单数学计算。

### 个人心得总结
- **调试经历**：部分题解提到在调试过程中发现特判情况（如m1=1）的重要性，提醒我们在编写代码时要注意边界条件。
- **踩坑教训**：有些题解提到在质因数分解时忽略了某些质因数的处理，导致结果错误，提醒我们在处理复杂问题时要注意细节。
- **顿悟感想**：通过递归求解GCD的方法，作者在推导过程中逐渐理解了问题的本质，这种逐步推导的思路值得学习。

---
处理用时：28.79秒
# 题目信息

# [NOIP 2012 提高组] 同余方程

## 题目描述

求关于 $ x$ 的同余方程 $ a x \equiv 1 \pmod {b}$ 的最小正整数解。


## 说明/提示

### 数据规模与约定

- 对于 $40\%$ 的数据，$2 ≤b≤ 1,000$；
- 对于 $60\%$ 的数据，$2 ≤b≤ 50,000,000$；
- 对于 $100\%$ 的数据，$2 ≤a, b≤ 2,000,000,000$。



## 样例 #1

### 输入

```
3 10```

### 输出

```
7```

# AI分析结果

### 综合分析与结论

本题解的核心是求解同余方程 \(ax \equiv 1 \pmod{b}\) 的最小正整数解，主要涉及扩展欧几里得算法（exgcd）和欧拉定理的应用。大部分题解都围绕这两个算法展开，部分题解还提到了费马小定理和线性求逆元的方法。扩展欧几里得算法是解决此类问题的标准方法，而欧拉定理则提供了一种替代思路，但需要计算欧拉函数，效率较低。

### 所选高质量题解

#### 1. 学委 (5星)
**关键亮点**：
- 详细推导了扩展欧几里得算法的原理，解释了如何将同余方程转化为线性方程 \(ax + by = 1\)。
- 提供了清晰的递归过程，解释了每一步的数学依据。
- 代码实现简洁，且对负数解的处理非常巧妙。

**个人心得**：
- 作者提到在最后一层递归时，\(y\) 的取值不影响结果，但建议返回 0 以避免数值越界问题。

**核心代码**：
```cpp
void exgcd(long long a, long long b) {
    if (b == 0) {
        x = 1;
        y = 7; // 建议返回0，但y=7能AC
        return;
    }
    exgcd(b, a % b);
    long long tx = x;
    x = y;
    y = tx - a / b * y;
}
```

#### 2. _Nova (4星)
**关键亮点**：
- 详细介绍了裴蜀定理和扩展欧几里得算法的推导过程，解释了如何通过递归求解线性方程。
- 提供了通解的推导，解释了如何通过调整 \(x\) 的值得到最小正整数解。
- 代码实现简洁，且对负数解的处理非常清晰。

**核心代码**：
```cpp
void exgcd(int a, int b, int &x, int &y) {
    if (b == 0) {
        x = 1, y = 0;
        return;
    }
    exgcd(b, a % b, y, x);
    y -= a / b * x;
}
```

#### 3. HasNoName (4星)
**关键亮点**：
- 通过裴蜀定理解释了方程 \(ax + by = 1\) 有解的条件，并详细推导了扩展欧几里得算法的递归过程。
- 代码实现简洁，且对负数解的处理非常巧妙。

**核心代码**：
```cpp
void exgcd(int a, int b, int &x, int &y) {
    if (b == 0) {
        x = 1, y = 0;
        return;
    }
    exgcd(b, a % b, y, x);
    y -= a / b * x;
}
```

### 最优关键思路与技巧

1. **扩展欧几里得算法**：通过递归求解 \(ax + by = \gcd(a, b)\)，最终得到 \(x\) 的最小正整数解。
2. **负数解处理**：通过取模运算 \(x = (x \% b + b) \% b\) 将负数解转化为最小正整数解。
3. **欧拉定理**：作为替代方法，通过计算欧拉函数 \(\varphi(b)\) 来求解 \(x \equiv a^{\varphi(b)-1} \pmod{b}\)，但效率较低。

### 可拓展之处

1. **线性同余方程**：类似的问题可以推广到更一般的线性同余方程 \(ax \equiv c \pmod{b}\)。
2. **逆元应用**：求解逆元在模运算中非常常见，可以应用于组合数学、数论等领域。

### 推荐题目

1. [P3811 【模板】乘法逆元](https://www.luogu.com.cn/problem/P3811)
2. [P2613 【模板】有理数取余](https://www.luogu.com.cn/problem/P2613)
3. [P5656 【模板】二元一次不定方程](https://www.luogu.com.cn/problem/P5656)

### 个人心得总结

- **调试经历**：部分题解提到在递归过程中 \(y\) 的取值不影响结果，但建议返回 0 以避免数值越界问题。
- **顿悟感想**：通过扩展欧几里得算法，可以将同余方程转化为线性方程，从而简化问题的求解过程。

---
处理用时：32.88秒
# 题目信息

# 数字游戏

## 题目描述

KC 邀请他的两个小弟 K 和 C 玩起了数字游戏。游戏是 K 和 C 轮流操作进行的，K 为先手。KC 会先给定一个数字 $Q$，每次操作玩家必须写出当前数字的一个因数来代替当前数字，但是这个因数不能是 $1$ 和它本身。例如当前数字为 $6$，那么可以用 $2, 3$ 来代替，但是 $1$ 和 $6$ 就不行。现在规定第一个没有数字可以写出的玩家为胜者。K 在已知 $Q$ 的情况，想知道自己作为先手能不能胜利，若能胜利，那么第一次写出的可以制胜的最小数字是多少呢？整个游戏过程我们认为 K 和C用的都是最优策略。

## 说明/提示

对于 $30 \%$ 的数据，$Q \le 50$；  
对于 $100 \%$ 的数据，$2 \le Q \le {10}^{13}$。

## 样例 #1

### 输入

```
6
```

### 输出

```
2
```

## 样例 #2

### 输入

```
30
```

### 输出

```
1
6
```

# AI分析结果

### 综合分析与结论

本题的核心在于博弈论与质因数分解的结合。所有题解都围绕以下关键点展开：
1. **博弈论策略**：通过分析游戏的胜负条件，确定先手是否必胜，并找到最小制胜数字。
2. **质因数分解**：通过分解质因数来判断数字的性质，从而决定游戏的胜负。
3. **优化策略**：通过只分解到√Q来减少时间复杂度，避免超时。

### 所选高星题解

#### 1. 作者：hsfzLZH1 (5星)
- **关键亮点**：思路清晰，分类讨论详细，代码简洁且优化到位。
- **个人心得**：通过队列存储质因数，方便后续处理，且优化了质因数分解的时间复杂度。
- **核心代码**：
```cpp
for(ll i=2;i*i<=n;i++) while(n%i==0) q.push(i),n/=i;
if(n!=1) q.push(n);
```
- **核心思想**：通过分解质因数并存储在队列中，方便后续分类讨论。

#### 2. 作者：Laser_Crystal (4星)
- **关键亮点**：博弈论思想解释清晰，代码实现简洁。
- **个人心得**：强调了博弈论中的“一步杀”策略，即让对手面对质数。
- **核心代码**：
```cpp
for(register long long i=2;i*i<=q;i++) while(q%i==0) a[++cnt]=i,q/=i;
if(q!=1) a[++cnt]=q;
```
- **核心思想**：通过分解质因数并存储在数组中，根据质因数个数决定胜负。

#### 3. 作者：Misaka_Mik0t0 (4星)
- **关键亮点**：分类讨论详细，代码实现简洁且优化到位。
- **个人心得**：强调了质因数分解的优化策略，避免全部分解。
- **核心代码**：
```cpp
for(long long i=2;i*i<=q;++i){
    if(q%i==0){
        num[++k]=i;s[k]=1;q/=i;++t;
        while(q%i==0)++s[k],++t,q/=i;
        if(t>=3){
            puts("1");
            if(s[1]>=2)printf("%lld",num[1]*num[1]);
            else printf("%lld",num[1]*num[2]);
            return 0;
        }
    }
}
```
- **核心思想**：通过分解质因数并存储在数组中，根据质因数个数决定胜负。

### 最优关键思路与技巧

1. **博弈论策略**：通过分析游戏的胜负条件，确定先手是否必胜，并找到最小制胜数字。
2. **质因数分解**：通过分解质因数来判断数字的性质，从而决定游戏的胜负。
3. **优化策略**：通过只分解到√Q来减少时间复杂度，避免超时。

### 可拓展之处

1. **同类型题**：类似博弈论与数论结合的题目，如“石子游戏”、“取石子”等。
2. **算法套路**：质因数分解、博弈论分析、优化策略。

### 推荐题目

1. **洛谷P1029**：最大公约数和最小公倍数问题
2. **洛谷P1072**：Hankson的趣味题
3. **洛谷P1069**：细胞分裂

### 个人心得总结

- **调试经历**：在质因数分解时，优化到√Q是关键，避免超时。
- **踩坑教训**：注意质因数分解的边界条件，如Q=1或质数的情况。
- **顿悟感想**：博弈论与数论的结合，通过分析质因数个数来决定胜负，思路清晰且有效。

---
处理用时：30.73秒
# 题目信息

# [NOIP 2003 提高组] 传染病控制

## 题目背景

本题是错题，后来被证明没有靠谱的多项式复杂度的做法。测试数据非常的水，各种玄学做法都可以通过，不代表算法正确。因此本题题目和数据仅供参考。

[关于此类题目的详细内容](https://www.luogu.com.cn/paste/isdgwj5l)

---

近来，一种新的传染病肆虐全球。蓬莱国也发现了零星感染者，为防止该病在蓬莱国大范围流行，该国政府决定不惜一切代价控制传染病的蔓延。不幸的是，由于人们尚未完全认识这种传染病，难以准确判别病毒携带者，更没有研制出疫苗以保护易感人群。于是，蓬莱国的疾病控制中心决定采取切断传播途径的方法控制疾病传播。经过 WHO（世界卫生组织）以及全球各国科研部门的努力，这种新兴传染病的传播途径和控制方法已经研究清楚，剩下的任务就是由你协助蓬莱国疾控中心制定一个有效的控制办法。


## 题目描述

研究表明，这种传染病的传播具有两种很特殊的性质；

第一是它的传播途径是树型的，一个人 $X$ 只可能被某个特定的人 $Y$ 感染，只要 $Y$ 不得病，或者是 $XY$ 之间的传播途径被切断，则 $X$ 就不会得病。


第二是，这种疾病的传播有周期性，在一个疾病传播周期之内，传染病将只会感染一代患者，而不会再传播给下一代。


这些性质大大减轻了蓬莱国疾病防控的压力，并且他们已经得到了国内部分易感人群的潜在传播途径图（一棵树）。但是，麻烦还没有结束。由于蓬莱国疾控中心人手不够，同时也缺乏强大的技术，以致他们在一个疾病传播周期内，只能设法切断一条传播途径，而没有被控制的传播途径就会引起更多的易感人群被感染（也就是与当前已经被感染的人有传播途径相连，且连接途径没有被切断的人群）。当不可能有健康人被感染时，疾病就中止传播。所以，蓬莱国疾控中心要制定出一个切断传播途径的顺序，以使尽量少的人被感染。


你的程序要针对给定的树，找出合适的切断顺序。



## 说明/提示

对于 $100\%$ 的数据，$1 \leq n \leq 300$。

**【题目来源】**

NOIP 2003 提高组第四题

## 样例 #1

### 输入

```
7 6
1 2
1 3
2 4
2 5
3 6
3 7
```

### 输出

```
3
```

# AI分析结果



### 综合分析与结论
本题核心为树形结构的分层搜索，主要解法为DFS+预处理子树信息。题解普遍采用分层枚举切断点的思路，通过预处理子树大小、深度信息优化搜索。部分解法引入剪枝和随机化提升效率，但正确性依赖于数据特性。最优解法应具备清晰的层次处理与高效回溯机制。

---

### 精选题解与亮点

#### 1. 题解作者：RikoHere（4星）
**关键亮点**  
- 分层预处理：通过BFS计算深度，将节点按层存储  
- 高效回溯：使用递归标记/恢复子树状态  
- 代码模块化：拆分clean/reclean函数，结构清晰  
**核心代码**  
```cpp
void dfs(int cen, int tot) {
    maxx = max(maxx, tot);
    for (int i = 0; i < cnt[cen]; ++i) {
        if (!bol[b[cen][i]]) {
            int num = clean(b[cen][i]); // 标记子树
            dfs(cen+1, tot+num);
            reclean(b[cen][i]); // 回溯
        }
    }
}
```
**实现思想**：分层枚举切断点，标记子树后递归下层，通过返回最大保护人数反推答案。

#### 2. 题解作者：基础不牢（4星）
**关键亮点**  
- 链结构特判：当某层全被标记时直接更新答案  
- 父子关系优化：通过fa数组快速判断切断影响  
**核心代码**  
```cpp
void dfs(int now, int cnt) {
    if (now == maxx) ans = min(ans, cnt);
    int f = 0;
    for (auto x : deep[now]) {
        if (vis[x]) { f++; continue; }
        work(x, 1); // 标记子树
        dfs(now+1, cnt - count[x]);
        work(x, 0); // 回溯
    }
    if (f == deep[now].size()) ans = min(ans, cnt);
}
```
**调试经验**：发现直接返回可能导致链结构答案错误，增加全标记层的判断。

#### 3. 题解作者：Ciyang（3.5星） 
**关键思路**：尝试DP失败后转向分层搜索，验证贪心反例  
**启示意义**：展示了从错误解法到正确思路的思考过程，强调题目周期性传播特性对解法的影响。

---

### 关键思路总结
1. **分层处理**：按节点深度分层，逐层枚举切断点  
2. **子树标记回溯**：通过DFS标记/恢复切断状态，保证搜索完整性  
3. **预处理优化**：提前计算子树大小、深度信息加速决策  
4. **剪枝策略**：当某层全被保护时提前终止搜索  

---

### 推荐相似题目
1. [P2015 二叉苹果树](https://www.luogu.com.cn/problem/P2015)（树形DP）  
2. [P1273 有线电视网](https://www.luogu.com.cn/problem/P1273)（树形DP+背包）  
3. [P1352 没有上司的舞会](https://www.luogu.com.cn/problem/P1352)（树形DP基础）  

---

### 实战技巧
- **链式前向星存图**：适用于快速遍历子树  
- **优先队列选子树**：在随机化解法中按子树大小排序提升效率  
- **位运算优化状态**：可用bitset代替bool数组加速标记操作（未在示例代码体现，但可拓展）  

---

### 调试经验摘录
> "当处理链结构时，若直接返回会导致答案未更新，需增加全标记层的判断" —— 基础不牢  
> "贪心法在特定结构下会失效，必须通过全枚举保证正确性" —— Ciyang  
> "随机化需设置合理概率，避免过度偏离最优解" —— Makasukaka

---
处理用时：68.35秒
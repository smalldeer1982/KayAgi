# 题目信息

# A-B 数对

## 题目背景

出题是一件痛苦的事情！

相同的题目看多了也会有审美疲劳，于是我舍弃了大家所熟悉的 A+B Problem，改用 A-B 了哈哈！

## 题目描述

给出一串正整数数列以及一个正整数 $C$，要求计算出所有满足 $A - B = C$ 的数对的个数（不同位置的数字一样的数对算不同的数对）。

## 说明/提示

对于 $75\%$ 的数据，$1 \leq N \leq 2000$。

对于 $100\%$ 的数据，$1 \leq N \leq 2 \times 10^5$，$0 \leq a_i <2^{30}$，$1 \leq C < 2^{30}$。

2017/4/29 新添数据两组

## 样例 #1

### 输入

```
4 1
1 1 2 3
```

### 输出

```
3```

# AI分析结果



### 综合分析与结论
本题核心在于高效统计满足 `A-B=C` 的数对。题解主要围绕数学转换（A-B=C → A-C=B）展开，利用高效数据结构（map、哈希）或算法（二分、双指针）优化时间复杂度。关键优化点包括：**次数统计代替暴力枚举**、**有序性加速查找**、**避免重复计算**。

---

### 高星题解推荐（评分≥4星）

#### 1. OsvaldoAsensioLopez（5星）
**关键亮点**：  
- 思路简洁清晰，利用 `map` 统计元素出现次数，将问题转换为 `A-C=B` 的计数问题。  
- 代码简洁高效，时间复杂度 O(n log n)，适合大数据量。  
- 核心代码仅需两次遍历，易理解。  

```cpp
map<LL,LL> m;  // 统计每个数的出现次数
for(int i=1;i<=n;i++) {
    cin >> a[i];
    m[a[i]]++;
    a[i] -= C;  // 转换为查找目标值 B = A-C
}
for(int i=1;i<=n;i++) ans += m[a[i]];  // 累加所有合法B的出现次数
```

---

#### 2. 樱花飞舞（4.5星）
**关键亮点**：  
- 利用排序后数组的有序性，结合 `lower_bound` 和 `upper_bound` 快速计算区间长度。  
- 时间复杂度 O(n log n)，代码简洁，适合STL熟练者。  
- 个人心得：强调避免重复计算，仅向后查找。  

```cpp
sort(a+1, a+N+1);  // 排序后二分查找
for(int i=1;i<=N;i++) {
    auto l = lower_bound(a+1, a+N+1, a[i]+C);  // 第一个≥目标值的位置
    auto r = upper_bound(a+1, a+N+1, a[i]+C);  // 第一个＞目标值的位置
    ans += r - l;  // 区间长度即为合法数对个数
}
```

---

#### 3. jins3599（4星）
**关键亮点**：  
- 双指针维护区间，时间复杂度 O(n)，空间复杂度 O(1)。  
- 利用排序后单调性，避免重复扫描，效率最优。  
- 代码中通过 `r1` 和 `r2` 指针动态调整区间。  

```cpp
sort(a+1, a+1+n);
int l=1, r1=1, r2=1;
for(l=1; l<=n; l++) {
    while(r1<=n && a[r1]-a[l] <= C) r1++;  // 右边界扩展
    while(r2<=n && a[r2]-a[l] < C)  r2++;  // 左边界扩展
    if(a[r2]-a[l]==C) ans += r1 - r2;  // 区间差为合法数对个数
}
```

---

### 关键思路总结
1. **数学转换**：将问题转换为 `A-C=B` 或 `B+C=A`，减少变量耦合。  
2. **高效统计**：使用哈希（map）、排序+二分或双指针快速统计目标值出现次数。  
3. **避免重复**：通过有序性限制查找方向（如仅向后查找），或利用指针动态维护区间。  

---

### 举一反三：推荐题目
1. [P1102 A-B数对](https://www.luogu.com.cn/problem/P1102)（本题，巩固同类技巧）  
2. [P1678 烦恼的高考志愿](https://www.luogu.com.cn/problem/P1678)（二分查找典型应用）  
3. [P1145 三数之和](https://www.luogu.com.cn/problem/P1145)（双指针扩展，三变量优化）  

---

### 调试与踩坑经验
- **类型溢出**：`ans` 需用 `long long` 避免计数溢出（如题解中多次强调）。  
- **特殊值处理**：当 `C=0` 时需排除自身匹配，或调整区间计算方式。  
- **哈希冲突**：手写哈希需处理冲突，建议直接用 `unordered_map` 或 `map`。

---
处理用时：75.81秒
# 题目信息

# [USACO04DEC] Cleaning Shifts S

## 题目描述

一天有 $T(1\le T\le 10^6)$ 个时段。约翰正打算安排他的 $N(1\le N\le 2.5\times 10^4)$ 只奶牛来值班，打扫打扫牛棚卫生。每只奶牛都有自己的空闲时间段 $ [S_i,E_i](1\le S_i\le E_i\le T)$，只能把空闲的奶牛安排出来值班。而且，每个时间段必需有奶牛在值班。

那么，最少需要动用多少奶牛参与值班呢？如果没有办法安排出合理的方案，就输出 $-1$。

## 说明/提示

$1\le T\le 10^6$，$N\le 2.5\times 10^4$，$1\le S_i\le E_i\le T$。

$\text{Update On 2023/08/08}$：添加了一组hack数据，详情见[这里](https://www.luogu.com.cn/discuss/613052)。叉掉了时间复杂度为 $\mathcal O(nt)$ 的错解。

## 样例 #1

### 输入

```
3 10
1 7
3 6
6 10```

### 输出

```
2```

# AI分析结果



### 综合分析与结论
本题核心是区间覆盖问题，各题解主要采用三种思路：贪心算法、线段树优化DP、最短路建模。贪心算法在时间效率（O(N logN)）和代码简洁性上表现最优，是本题推荐解法。线段树优化DP（O(N logT)）和离散化最短路（O(N logN)）适用于更大数据规模或带权值的变形题，但实现复杂度较高。

---

### 精选题解推荐

#### 1. Greenzhe（贪心解法）⭐️⭐️⭐️⭐️⭐️
**关键亮点**：  
- 贪心策略清晰：排序后双指针维护当前覆盖右边界，每次选能覆盖当前起点且右端点最大的区间  
- 时间复杂度最优（O(N logN)）  
- 代码简洁高效（仅30行核心逻辑）  
**核心代码**：
```cpp
sort(range+1, range+n+1);
int st=1, ans=0;
for(int i=1,j=1; i<=n;){
    int r=0;
    while(j<=n && range[j].l<=st) r=max(r,range[j++].r);
    if(r < st) break; // 无解
    ans++;
    st = r+1;
    i = j;
}
```

#### 2. 船酱魔王（线段树优化DP）⭐️⭐️⭐️⭐️
**关键亮点**：  
- 离散化处理大范围数据  
- 线段树维护区间最小值优化DP转移  
- 可扩展性强（如支持带权区间覆盖）  
**核心实现**：
```cpp
struct Node{ int l,r,mn; }tree[N<<2];
void update(int p,int x,int k){
    if(范围匹配) tree[p].mn = k;
    // 递归更新左右子树
}
int query(int l,int r){
    // 返回区间最小值
}
for(区间排序后处理){
    int tmp = query(l-1, r-1) + 1;
    update(r, tmp);
}
```

#### 3. Southern_Dynasty（离散化最短路）⭐️⭐️⭐️⭐️
**关键亮点**：  
- 巧妙建模为01BFS问题  
- 离散化处理1e9量级数据  
- 左闭右开区间处理覆盖逻辑  
**关键代码**：
```cpp
// 建图：每个区间[l,r]对应边 u-1->r
add_edge(u-1, r, 1); 
// 时间轴逆向边
for(int i=1;i<=T;++i) add_edge(i, i-1, 0); 
// 01BFS求最短路
```

---

### 关键技巧总结
1. **贪心选择策略**：按左端点排序，维护当前覆盖右边界，优先选右端点最大的区间  
2. **离散化技巧**：将大范围端点映射到小范围，降低时空复杂度  
3. **线段树维护动态区间极值**：优化DP转移中的区间查询  
4. **最短路建模**：将区间覆盖转化为图论问题，利用0/1边权特性使用双端队列BFS  

---

### 推荐练习题
1. [P1280 尼克的任务](https://www.luogu.com.cn/problem/P1280) - 逆向DP处理区间覆盖  
2. [P4644 清理班次](https://www.luogu.com.cn/problem/P4644) - 带权区间覆盖（线段树优化DP）  
3. [CF1029E](https://codeforces.com/problemset/problem/1029/E) - 贪心选择与覆盖策略

---
处理用时：63.99秒
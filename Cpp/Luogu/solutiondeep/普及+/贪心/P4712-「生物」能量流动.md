# 题目信息

# 「生物」能量流动

## 题目描述

生物课上，小 F 学习到了食物链、食物网的相关内容。

他学到，能量是逐级递减的。比如在食物链上，两个链接起来的生物 $A \rightarrow B$（意思是 $B$ 吃 $A$）之间的能量传递效率最多只有 $\frac 1 5$；而研究种间关系，能够使能量流向对人类最有益的部分。

现在，小 F 想研究一下能量流动的关系，于是他在脑海里创造了一个生态的系统。

在这个生态的系统里，有 $n+2$ 种生物，其中 $0$ 是生产者，整个生态系统所流经的能量由它固定；你是贪婪的顶级掠食者 $n + 1$，可以捕食所有生物；其他的掠食者 $[1, n]$ 各有各的喜好，只会捕食编号在 $[0, r_i]$ 的生物。由于天然形成的强弱顺序，上述关系满足 $r_i \leq r_{i + 1}(1 \leq i < n),$ $r_i < i(1 \leq i \leq n)$。

每种动物需要摄取至少 $a_i$ 单位能量才能存活；一个生物摄取到的能量可以传递给捕食者，但传递效率都不超过 $\frac 1 5$。也就是说，假设该动物捕获了 $b_i$ 单位的能量，所有捕食它的掠食者得到的能量总和 $c_i$，那么有：
* $b_i \geq a_i$
* $c_i \leq \frac 1 5 b_i$

你希望知道，在所有生物都存活的情况下，在最优情况下你能获取到的最大能量是多少。

## 说明/提示

### 样例 1 解释

最优情况下：
* 1 号掠食者捕食生产者 0，捕食 5 点能量，传递效率为 $\frac 1 5$，得到 1 点能量。
* 2 号掠食者捕食生产者 0，捕食 4 点能量，传递效率为 $\frac 1 5$，得到 0.8 点能量。
* 2 号掠食者捕食掠食者 1，捕食 1 点能量，传递效率为 $\frac 1 5$，得到 0.2 点能量。

可怜的你只能捕获 2 号掠食者的能量，捕食 1 点能量，得到 0.2 点能量。

### 样例 2, 3 解释

由于 2 号掠食者开始减肥不吃肉了（也有可能是打不过 1 了），所以所需的生产者能量从 9 点变成了 10 点。

### 子任务

子任务 $1(21 \mathrm{pts}) : n \leq 100$；

子任务 $2(89 \mathrm{pts}) : n \leq 10 ^ 5$。

## 样例 #1

### 输入

```
2 9
1 0
1 1```

### 输出

```
0.2000000```

## 样例 #2

### 输入

```
2 9
1 0
1 0```

### 输出

```
-1```

## 样例 #3

### 输入

```
2 10
1 0
1 0```

### 输出

```
0.4000000```

# AI分析结果



### 综合分析与结论
本题核心是贪心策略，通过维护可捕食范围的前缀和，利用题目给出的 $r_i$ 单调性实现线性时间复杂度。最优解法的关键点包括：
1. **贪心顺序**：每个生物优先从最低级生物获取能量，减少传递损耗
2. **单调性优化**：利用 $r_i \leq r_{i+1}$ 特性，通过指针维护当前可用能量范围
3. **能量转换模型**：将能量需求统一转换为生产者层面的能量消耗（$a_i \times 5$）

---

### 高星题解推荐

#### 1. 作者：star_magic_young（★★★★★）
**关键亮点**：
- 利用前缀和与指针维护可捕食范围，时间复杂度 $O(n)$
- 代码极简（仅15行），将能量转换模型抽象为整数运算
- 通过维护 `now` 指针避免重复计算，完美利用单调性

**核心代码**：
```cpp
int main() {
    scanf("%d%lld",&n,&m);
    int now=0;
    for(int i=1;i<=n;++i) {
        scanf("%d%d",&x,&r);
        while(now<r) m+=a[++now]; // 扩展可用能量
        if(m<x*5) return puts("-1"),0; // 检查是否可行
        m-=x*5; a[i]=x; // 扣除所需能量
    }
    while(now<n) m+=a[++now]; // 收集剩余能量
    printf("%.7lf",m/5.0);
}
```

#### 2. 作者：wxgwxg（★★★★★）
**关键亮点**：
- 将生产者能量与生物需求统一用整数处理
- 通过维护 `r` 指针动态扩展可用能量范围
- 代码实现仅用单个循环，空间复杂度 $O(1)$

**核心思想**：
```cpp
while(now<r) now++,m+=a[now]; // 动态扩展能量池
if(m<x*5) return -1; // 可行性判断
m -= x*5; // 扣除生产者层面能量
```

#### 3. 作者：Sino_E（★★★★☆）
**关键亮点**：
- 提出清晰的能量转换模型：$a_i \times 5$ 表示生产者需预留的能量
- 利用累加器实现 $O(n)$ 时间复杂度
- 代码中体现对题目性质的深刻理解（如 `r` 的单调性应用）

---

### 关键思路总结
1. **贪心策略**：每个生物优先从编号最小的可用生物获取能量，最小化传递次数
2. **单调指针优化**：维护 `now` 指针记录当前已处理的最大 $r_i$，避免重复扫描
3. **能量转换模型**：将捕食者需求 $a_i$ 转换为需要消耗的生产者能量 $a_i \times 5$
4. **前缀和思想**：通过动态累加扩展的能量范围，实现高效查询

---

### 同类题目推荐
1. **P1090 合并果子**（贪心策略）
2. **P3819 松江1843路**（前缀和+坐标映射）
3. **P5019 铺设道路**（贪心+差分思想）

---

### 调试经验摘录
- **浮点精度问题**：多篇题解强调避免使用 `float`，统一用整数运算最后转换
- **单调性利用**：`r_i ≤ r_{i+1}` 的性质被频繁用于设计线性算法
- **边界处理**：如 `now` 指针的初始化和最终剩余能量的收集

> "实践发现，这样做是对的。至于怎么证，我就不说了~~（悄悄隐瞒了自己太弱而并不会证的事实）~~" —— 猪脑子  
> 体现对贪心策略正确性的直觉判断，虽无严格证明但通过测试验证

---
处理用时：83.64秒
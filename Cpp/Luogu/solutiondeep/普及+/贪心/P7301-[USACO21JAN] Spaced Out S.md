# 题目信息

# [USACO21JAN] Spaced Out S

## 题目描述

Farmer John 想要拍摄一张他的奶牛吃草的照片挂在墙上。草地可以用一个 $N$ 行 $N$ 列正方形方格所组成的方阵表示（想象一个 $N \times N$ 的棋盘），其中 $2 \leq N \leq 1000$。在 Farmer John 最近拍摄的照片中，他的奶牛们太过集中于草地上的某个区域。这一次，他想要确保他的奶牛们分散在整个草地上。于是他坚持如下的规则：

 - 没有两头奶牛可以位于同一个方格。
 - 所有 $2 \times 2$ 的子矩阵（共有 $(N-1) \times (N-1)$ 个）必须包含恰好 2 头奶牛。

例如，这一放置方式是合法的：

```
CCC
...
CCC
```

而这一放置方式是不合法的，因为右下的 $2 \times 2$ 正方形区域仅包含 1 头奶牛：

```
C.C
.C.
C..
```

没有其他限制。你可以假设 Farmer John 有无限多的奶牛（根据以往的经验，这种假设似乎是正确的……）。

Farmer John 更希望某些方格中包含奶牛。具体地说，他相信如果方格 $(i, j)$ 中放有一头奶牛，照片的美丽度会增加 $a_{ij}$（$0 \leq a_{ij} \leq 1000$）单位。

求合法的奶牛放置方式的最大总美丽度。


## 说明/提示

在这个样例中，最大美丽度可以在如下放置方式时达到：

```
CC..
..CC
CC..
..CC
```

这种放置方式的美丽度为 $3 + 3 + 3 + 1 + 3 + 3 + 3 + 3 = 22$。

测试点性质：

 - 测试点 2-4 满足 $N \le 4$。
 - 测试点 5-10 满足 $N\le 10$。
 - 测试点 11-20 满足 $N \le 1000$。

供题：Hankai Zhang，Danny Mittal

## 样例 #1

### 输入

```
4
3 3 1 1
1 1 3 1
3 3 1 1
1 1 3 3```

### 输出

```
22```

# AI分析结果



### 综合分析与结论
本题核心在于发现合法放置必须满足行或列交替排列的性质。最优解法通过分别计算行交替和列交替两种模式下的最大美丽度，取较大者。时间复杂度为O(n²)，适用于n≤1000的规模。

---

### 精选题解与评分

#### 1. K8He（5星）
**关键亮点**：  
- 简洁高效地利用奇偶位置统计，完美转化问题为贪心选择  
- 代码极度精简且可读性强，直接反映问题本质  

**核心代码**：  
```cpp
int main(){
    scanf("%d",&n);
    for(int i=1;i<=n;++i)
        for(int j=1;j<=n;++j)
            scanf("%d",&a),x[i][j%2]+=a,y[j][i%2]+=a;
    // x统计行交替，y统计列交替
    for(int i=1;i<=n;++i)
        num+=max(x[i][1],x[i][0]),ans+=max(y[i][1],y[i][0]);
    printf("%d",max(num,ans));
}
```

#### 2. 羚羊WANG（4星）  
**关键亮点**：  
- 独立推导出行列交替性质，代码逻辑清晰  
- 通过拆分奇偶累加实现快速计算  

**代码亮点**：  
```cpp
for(int i=1;i<=n;++i)
    for(int j=1;j<=n;j+=2) st1[i]+=a[j][i];
// st1统计列奇位置，st2统计偶位置
```

---

### 关键思路与技巧
1. **性质观察**：合法放置必须满足行或列严格交替排列，所有2x2子矩阵的约束可转化为全局交替模式。  
2. **贪心选择**：对每行/列分别计算奇偶位置和，取最大值累加。  
3. **维度分离**：行和列两种模式独立计算，避免状态冲突。

---

### 拓展与相似题目
- **同类题型**：棋盘覆盖问题（如黑白染色）、行列约束下的极值问题。  
- **推荐题目**：  
  1. [P1219 八皇后](https://www.luogu.com.cn/problem/P1219)（行列交替的经典问题）  
  2. [P1896 互不侵犯](https://www.luogu.com.cn/problem/P1896)（状态压缩+行列约束）  
  3. [P1433 吃奶酪](https://www.luogu.com.cn/problem/P1433)（矩阵极值+贪心/状压）  

---

### 个人心得摘录
- **K8He**：强调代码简洁性，通过矩阵遍历直接分离奇偶统计。  
- **Diaоsi**：通过构造反例验证行列交替的必然性，强化理解。  
- **BreakPlus**：尝试动态规划后转向更优贪心策略，体现算法优化过程。

---
处理用时：58.15秒
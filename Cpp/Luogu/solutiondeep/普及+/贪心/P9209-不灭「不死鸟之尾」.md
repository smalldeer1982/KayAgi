# 题目信息

# 不灭「不死鸟之尾」

## 题目背景

不死鸟之尾，一种量产型的羽毛。可用作药品。

虽说是量产型，可是从哪里可以得到这种万能之药呢？

## 题目描述

有一个包含 $n$ 个停车位的停车场，里面的停车位排成了一排，最左边和最右边都是墙壁。

有 $n$ 辆车要按顺序依次停入这个停车场，在停入第 $i$ 辆车时，这辆车要停入的位置左右两边的空位越多，停进去需要的时间也就会越少，具体地，如果其左边连续的空位数量为 $l$，其右边连续的空位数量为 $r$，那么停入该辆车所需时间为 $W_i-L_i\cdot l-R_i\cdot r$，其中 $W_i,L_i,R_i$ 会给出（特别的，停车所需要的时间不会是负数，所以我们保证 $W_i\ge L_i\cdot n+R_i\cdot n$）。

对于连续空位的解释：例如，下图中箭头所指位置左边连续空位为 $1$，右边连续空位为 $2$。

![](https://cdn.luogu.com.cn/upload/image_hosting/s1zpjfnq.png)

请依次确定每一辆车停入的位置，使得停入所有车所需时间最小。

## 说明/提示

#### 样例解释 1

第 $1$ 辆车停入从左往右数第 $3$ 个停车位，此时该停车位左边有 $2$ 个连续空位，右边没有连续空位，所需时间 $18-1\times 2-1\times 0=16$。

第 $2$ 辆车停入从左往右数第 $1$ 个停车位，此时该停车位左边没有连续空位，右边有 $1$ 个连续空位，所需时间 $20-2\times 0-4\times 1=16$。

第 $3$ 辆车停入从左往右数第 $2$ 个停车位，此时该停车位左右都没有连续空位，所需时间 $22-3\times 0-3\times 0=22$。

停入所有车需要时间 $16+16+22=54$。

#### 数据范围

对于所有数据，保证 $1\le n\le 10^5$，$0\le L_i,R_i\le 10^5$，$nL_i+nR_i\le W_i\le 2\times 10^{10}$。

## 样例 #1

### 输入

```
3
18 20 22
1 2 3
1 4 3```

### 输出

```
54```

# AI分析结果



### 综合分析与结论
本题需要贪心地选择每次停车位置，核心思路是每辆车停靠时在最长连续空位两端选择效益最大的方向（取L和R较大值方向），从而保证全局最优。各题解均采用O(n)贪心策略，时间复杂度最优。关键证明点在于：每次选择两侧停车不会破坏连续空位性质，使得剩余空位长度可用(n-i)推导。

---

### 精选题解与评分

#### 1. 作者：gyyyyx (5星)
**关键亮点**  
- 最严谨的贪心证明，详细推导了停在两侧的最优性  
- 明确指出贪心策略对后续状态的正确性保证  
- 代码简洁高效，直接体现核心公式  

**核心代码**  
```cpp
ans += W[i] - (n-i)*max(L[i], R[i]);
```

#### 2. 作者：wuyixiang (4星)
**关键亮点**  
- 通过交换L和R简化比较逻辑，提升代码可读性  
- 明确点出剩余空位连续性质的关键观察  
- 代码包含必要的数据类型提示（long long）  

**核心代码**  
```cpp
if(l[i] > r[i]) swap(l[i], r[i]);
ans += w[i] - (n-i) * r[i];
```

#### 3. 作者：Wind_Smiled (4星)
**关键亮点**  
- 通过线性代数推导直观展示决策过程  
- 分情况讨论函数单调性，强化理解  
- 代码注释清晰，便于学习  

**核心代码**  
```cpp
ans += w[i] - max(l[i], r[i]) * (n-i);
```

---

### 最优思路与技巧
1. **贪心方向选择**：每辆车选择max(Li, Ri)对应的方向停靠，使当前收益最大。
2. **连续空位性质**：每次停车后剩余空位仍为连续区间，可用(n-i)计算空位长度-1。
3. **公式简化**：总贡献为max(Li, Ri)*(n-i)，直接累加至答案。

---

### 拓展与相似题目
1. **P1090 [NOIP2004 提高组] 合并果子** - 贪心选择最小堆  
2. **P1223 [JSOI2009] 排队** - 贪心维护队列结构  
3. **P4995 跳跳！** - 极值交替选择策略  

---

### 个人心得摘录
- **Wind_Smiled**：通过将停车位置决策转化为线性函数分析，直观展示为何端点最优。  
- **elbissoPtImaerD**：强调区间操作中端点选择的普适性，可用于类似分割问题。  
- **ダ月**：提醒注意公式化简后的系数符号，避免方向误判。

---
处理用时：109.13秒
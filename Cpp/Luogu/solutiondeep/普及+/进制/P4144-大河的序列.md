# 题目信息

# 大河的序列

## 题目背景

“唯有龙虎相伴 最是脉脉深情”


题目来源：[KingSann](https://www.luogu.org/space/show?uid=47111)


## 题目描述

大河有一些袜子，但经常十分散乱的堆放着。


有一天龙儿忍不住了，于是将袜子放到了一个序列上（称作袜子序列）。


每个袜子都有一个$dirty$值，定义袜子序列的$dirty$值为 $ \max  \left( (dirty_{l} \ bitand \ dirty_{l+1} \ bitand \ \cdots \ bitand \ dirty_{r}) + (dirty_{l} \ bitor \ dirty_{l+1} \ bitor \ \cdots \ bitor \ dirty_{r}) \right) $ ，其中 $ dirty_{i} $ 表示 第 $ i $ 只袜子 的 $ dirty $ 值，$bitand$表示按位与（C++中是`&`），$bitor$表示按位或（C++中是`|`）。


简而言之，就是找一段连续子序列，使得所有数字的按位与加上按位或最大。


如果这个袜子序列的$dirty$值达到了某个**阈**值，那么龙儿会讨厌大河的。


大河当然不希望这样了，于是她想知道这个袜子序列的$dirty$值是多少。


## 说明/提示

$ 1 \le n, p \le 10^{5} $


$ 0 \le b, ditry_{i} \le 10^{7} $


对于测试点 $ 1 $ 和测试点 $ 2 $ 的数据，保证 $ 1 \le n \le 100 $


## 样例 #1

### 输入

```
10 1 10000000
7 9 9 4 0 0 8 8 4 7```

### 输出

```
251```

# AI分析结果

### 综合分析与结论

本题的核心在于通过贪心策略找到序列中最大值的两倍作为答案。虽然题目要求计算连续子序列的按位与和按位或的最大值，但通过分析可以发现，最优解实际上就是序列中最大值的两倍。这一结论可以通过反证法和顺推法进行证明。大多数题解都采用了这一思路，并通过快速幂计算最终结果。

### 所选高星题解

#### 1. 作者：xzyxzy (5星)
- **关键亮点**：通过按位贪心的思想，详细证明了为什么最大值的两倍是最优解。代码简洁，快速幂实现清晰。
- **个人心得**：通过按位贪心的思路，逐步推导出最优解，逻辑清晰，易于理解。

```cpp
int main() {
    cin>>n>>b>>mod;
    for(int i=1,x;i<=n;i++) cin>>x,p=max(x,p);
    cout<<ksm(p*2+233,b)%mod;
}
```

#### 2. 作者：wxgwxg (4星)
- **关键亮点**：通过反证法证明了为什么最大值的两倍是最优解，代码简洁，快速幂实现清晰。
- **个人心得**：通过反证法证明了最优解的唯一性，思路清晰，代码简洁。

```cpp
int main() {
    scanf("%d%d%d",&n,&b,&p);
    for(int i=1;i<=n;i++) scanf("%d",&a),ans=max(ans,a);
    printf("%d\n",ksm(233+(ans<<1),b)); 
    return 0;
}
```

#### 3. 作者：Aw顿顿 (4星)
- **关键亮点**：通过顺推法证明了为什么最大值的两倍是最优解，代码简洁，快速幂实现清晰。
- **个人心得**：通过顺推法逐步推导出最优解，逻辑清晰，代码简洁。

```cpp
int main() {
    cin>>n>>b>>p;
    for(int i=1;i<=n;i++){
        int a;cin>>a;
        x=max(a,x);
    }cout<<qp(x*2+233,b)%p;
    return 0;
}
```

### 最优关键思路与技巧

1. **贪心策略**：通过分析发现，最优解是序列中最大值的两倍，这一结论可以通过反证法和顺推法进行证明。
2. **快速幂**：通过快速幂算法高效计算最终结果，避免了大数计算的复杂度。

### 可拓展之处

- **同类型题**：类似的问题可以通过贪心策略和位运算进行优化，例如寻找序列中某些位运算的最大值或最小值。
- **算法套路**：贪心策略和位运算的结合在算法竞赛中常见，掌握这些技巧可以解决更多类似问题。

### 推荐题目

1. [P1226 快速幂](https://www.luogu.com.cn/problem/P1226)
2. [P1045 最大子段和](https://www.luogu.com.cn/problem/P1045)
3. [P1090 合并果子](https://www.luogu.com.cn/problem/P1090)

### 个人心得总结

- **调试经历**：在实现快速幂时，需要注意边界条件，特别是当指数为0或底数为0时的情况。
- **踩坑教训**：在贪心策略的证明中，需要确保每一步的推导都是严密的，避免遗漏某些情况。
- **顿悟感想**：通过位运算和贪心策略的结合，可以高效解决许多看似复杂的问题，关键在于找到问题的本质。

---
处理用时：23.22秒
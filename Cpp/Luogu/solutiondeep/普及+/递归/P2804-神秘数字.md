# 题目信息

# 神秘数字

## 题目背景

在公元XXXX年，侦探小明收到了组织的神秘信息，在Y市的某个地方有一道神秘的门。小明到达了那个门后，发现门上有一行字：“这个门需要密码才能解锁。”小明左找右找，终于找到了一张字条：“现在给你n个数，请你求出这n个数里面，有多少个连续的数的平均数大于某个给定的数M？注意：这个数可能会很大，请输出这个数对92084931取模的结果。最终的结果即是这个门的密码。”小明苦思冥想了半天，但始终找不到答案。于是他来求助于你。请你帮他解决这个问题。由于小明十分着急，他最多只能等1秒。


## 题目描述

给定n个数，请你帮助小明求出里面有多少个连续的数的平均数大于给定的某个数M.并将这个方案数输出。注意：这个数可能会很大，所以请输出这个数对92084931取模的结果。


## 说明/提示

【样例解释】

①对于这4个数，问题的解有{5}，{4}，{5,4}，{1,5,4}，{5,4,2}共5组。

②对于这4个数，问题的解有{5}，{7}，{2,7}，{7,3}，{5,2,7}，{5,2,7,3}共6组。

【数据规模】

对于10%的数据，1＜n≤10.

对于30%的数据，1＜n≤1000.

对于50%的数据，1＜n≤30000.

对于100%的数据，1＜n≤200000，1＜M≤3000，每个数均为正整数且不大于5000.


## 样例 #1

### 输入

```
4 3
1 5 4 2```

### 输出

```
5```

## 样例 #2

### 输入

```
4 4
5 2 7 3```

### 输出

```
6```

# AI分析结果

### 综合分析与结论

这些题解的核心思路是将原问题转化为求前缀和的顺序对问题，进而通过归并排序、树状数组或权值线段树等数据结构来高效求解。主要步骤如下：

1. **问题转化**：将每个数减去平均数 \(M\)，问题转化为求有多少个连续子区间的和大于0。
2. **前缀和优化**：通过前缀和数组 \(S\)，问题进一步转化为求 \(S[j] > S[i-1]\) 的顺序对。
3. **数据结构选择**：使用归并排序、树状数组或权值线段树来高效计算顺序对。

### 所选高星题解

#### 1. 作者：cabasky (5星)
- **关键亮点**：思路清晰，详细解释了问题转化过程，并通过归并排序求逆序对（实际是顺序对）来解决问题。代码简洁且高效。
- **核心代码**：
  ```cpp
  void mergesort(int l, int r) {
      if(l<r) {
          int mid=(l+r)>>1;
          mergesort(l,mid);
          mergesort(mid+1,r);
          merge(l,mid,r);
      }
  }
  ```
  **核心思想**：通过归并排序计算顺序对，时间复杂度为 \(O(n \log n)\)。

#### 2. 作者：Zachary_Cloud (4星)
- **关键亮点**：使用权值线段树来求解顺序对，思路清晰，代码实现较为简洁。
- **核心代码**：
  ```cpp
  inline void change(ll rt, ll l, ll r, ll p, ll cnt) {
      tr[rt] += cnt;
      if (l == r) return;
      if (p <= mid) change(ls, l, mid, p, cnt);
      else change(rs, mid + 1, r, p, cnt);
  }
  ```
  **核心思想**：通过权值线段树动态维护前缀和的顺序对，时间复杂度为 \(O(n \log n)\)。

#### 3. 作者：JackMerryYoung (4星)
- **关键亮点**：同样使用归并排序求解顺序对，代码简洁，思路清晰。
- **核心代码**：
  ```cpp
  void merge_sort(int l, int r) {
      if(l < r) {
          int mid = (l + r) >> 1;
          merge_sort(l, mid);
          merge_sort(mid + 1, r);
          merge(l, r);
      }
  }
  ```
  **核心思想**：通过归并排序计算顺序对，时间复杂度为 \(O(n \log n)\)。

### 最优关键思路与技巧

1. **问题转化**：将平均数问题转化为区间和问题，再通过前缀和进一步转化为顺序对问题。
2. **数据结构选择**：归并排序、树状数组或权值线段树都是高效求解顺序对的工具，选择合适的数据结构可以简化代码并提高效率。

### 可拓展之处

- **类似问题**：类似的问题可以转化为顺序对或逆序对问题，如求区间和大于某个值的子区间数量。
- **数据结构应用**：掌握归并排序、树状数组和权值线段树的应用场景，可以在类似问题中灵活运用。

### 推荐题目

1. [P1908 逆序对](https://www.luogu.com.cn/problem/P1908)
2. [P2717 区间和](https://www.luogu.com.cn/problem/P2717)
3. [P2804 神秘数字](https://www.luogu.com.cn/problem/P2804)

### 个人心得摘录

- **cabasky**：强调了问题转化的思路，通过减去平均数将问题简化，并指出归并排序的适用性。
- **Zachary_Cloud**：提到权值线段树的实现细节，强调了离散化的重要性。
- **JackMerryYoung**：总结了区间平均数问题的通用解法，强调了减去平均数的实用性。

这些心得有助于理解问题的核心思路和实现细节，值得借鉴。

---
处理用时：25.07秒
# 题目信息

# [USACO1.3] 混合牛奶 Mixing Milk

## 题目描述

由于乳制品产业利润很低，所以降低原材料（牛奶）价格就变得十分重要。帮助 Marry 乳业找到最优的牛奶采购方案。

Marry 乳业从一些奶农手中采购牛奶，并且每一位奶农为乳制品加工企业提供的价格可能相同。此外，就像每头奶牛每天只能挤出固定数量的奶，每位奶农每天能提供的牛奶数量是一定的。每天 Marry 乳业可以从奶农手中采购到小于或者等于奶农最大产量的整数数量的牛奶。

给出 Marry 乳业每天对牛奶的需求量，还有每位奶农提供的牛奶单价和产量。计算采购足够数量的牛奶所需的最小花费。

注：每天所有奶农的总产量大于 Marry 乳业的需求量。

## 说明/提示

【数据范围】  
对于 $100\%$ 的数据：  
$0 \le n,a_i \le 2 \times 10^6$，$0\le m \le 5000$，$0 \le p_i \le 1000$

题目翻译来自 NOCOW。

USACO Training Section 1.3

## 样例 #1

### 输入

```
100 5
5 20
9 40
3 10
8 80
6 30
```

### 输出

```
630
```

# AI分析结果



### 综合分析与结论
本题核心为贪心策略：优先购买单价最低的牛奶直至满足需求。各题解主要围绕排序方式（结构体排序/桶排序）与购买逻辑（批量计算/逐次扣除）展开。最优解法为桶排序法（时间复杂度O(1000)），其次为结构体排序法（时间复杂度O(m log m)）。

---

### 高星题解推荐（≥4星）

#### 1. 远航之曲（桶排序法） ★★★★★
**关键亮点**：
- 利用价格范围小（0-1000）特性，用桶统计各价格的牛奶总量，省去排序步骤。
- 时间复杂度优化至O(1000)，大幅优于常规排序解法。
- 代码简洁，逻辑清晰，直接遍历价格区间处理需求。

**核心代码**：
```cpp
int G[MAXG] = {0}; // 桶数组存储各价格牛奶总量
for (int i = 0; i < m; i++) {
    cin >> price >> amount;
    G[price] += amount; // 合并同价格牛奶量
}
for (int i = 0; i <= 1000; i++) {
    if (剩余需求 > G[i]) 全买该价格牛奶;
    else 买剩余需求并退出;
}
```

#### 2. 青陌（结构体排序法） ★★★★☆
**关键亮点**：
- 标准贪心实现，结构体排序后批量计算购买量。
- 代码可读性强，逻辑明确，适合理解贪心本质。
- 处理剩余需求时直接数学计算，避免逐次循环。

**核心代码**：
```cpp
sort(milk, milk + m, cmp); // 按单价排序
for (int i = 0; i < m; i++) {
    if (总需求 > 当前农户量) 全买;
    else 买部分并退出循环;
}
```

#### 3. 谬悠（结构体排序优化） ★★★★
**关键亮点**：
- 强调代码规范性（如避免万能头文件）。
- 通过`while(n > 0)`循环简化逻辑，明确处理每个农户。
- 注释详细，适合初学者学习调试思路。

**代码片段**：
```cpp
while (n > 0) {
    if (当前农户牛奶可全买) 累加金额并减少需求;
    else 按需购买并退出循环;
    切换至下一农户;
}
```

---

### 关键思路与技巧总结
1. **贪心策略**：优先购买单价最低的牛奶，直到满足需求。
2. **数据结构选择**：
   - **桶排序**：单价范围有限时（如0-1000），用数组统计各价格总量，无需排序。
   - **结构体排序**：通用性强，适合任意价格范围，需自定义比较函数。
3. **边界处理**：需求为0时直接输出0，避免无效计算。
4. **时间复杂度优化**：批量计算购买量（O(1)）优于逐次扣除（O(n)）。

---

### 拓展与举一反三
1. **同类题目推荐**：
   - [P1090 合并果子](https://www.luogu.com.cn/problem/P1090)：贪心+优先队列。
   - [P1223 排队接水](https://www.luogu.com.cn/problem/P1223)：排序后计算最小平均等待时间。
   - [P4995 跳跳！](https://www.luogu.com.cn/problem/P4995)：贪心选择跳跃策略。
2. **调试技巧**：
   - **极端数据测试**：如需求为0、农户产量为0等（见部分题解中的`if(n==0)`特判）。
   - **变量类型选择**：需求量可能达2e6，计算总价时使用`long long`避免溢出（部分题解未考虑，存在隐患）。

---

### 精选代码片段（桶排序法）
```cpp
int G[1001] = {0}; // 价格桶
int main() {
    int n, m, price, amount;
    cin >> n >> m;
    for (int i = 0; i < m; i++) {
        cin >> price >> amount;
        G[price] += amount; // 合并同价格牛奶
    }
    int cost = 0, bought = 0;
    for (int p = 0; p <= 1000; p++) {
        if (G[p] == 0) continue;
        int take = min(n - bought, G[p]);
        cost += take * p;
        bought += take;
        if (bought == n) break;
    }
    cout << cost;
    return 0;
}
```

---
处理用时：59.34秒
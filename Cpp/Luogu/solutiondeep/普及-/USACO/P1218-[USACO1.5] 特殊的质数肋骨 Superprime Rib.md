# 题目信息

# [USACO1.5] 特殊的质数肋骨 Superprime Rib

## 题目描述

农民约翰的母牛总是产生最好的肋骨。你能通过农民约翰和美国农业部标记在每根肋骨上的数字认出它们。 

农民约翰确定他卖给买方的是真正的质数肋骨，是因为从右边开始切下肋骨，每次还剩下的肋骨上的数字都组成一个质数。  

举例来说：$7\ 3\ 3\ 1$ 全部肋骨上的数字 $7331$ 是质数；三根肋骨 $733$ 是质数；二根肋骨 $73$ 是质数；当然,最后一根肋骨 $7$ 也是质数。$7331$ 被叫做长度 $4$ 的特殊质数。  

写一个程序对给定的肋骨的数目 $n$，求出所有的特殊质数。$1$ 不是质数。

## 说明/提示

【数据范围】  
对于 $100\%$ 的数据，$1\le n \le 8$。

题目翻译来自NOCOW。

USACO Training Section 1.5


## 样例 #1

### 输入

```
4
```

### 输出

```
2333
2339
2393
2399
2939
3119
3137
3733
3739
3793
3797
5939
7193
7331
7333
7393
```

# AI分析结果



### 综合分析与结论
本题要求生成满足逐层质数条件的n位数，核心在于如何高效生成并验证候选数。各题解主要采用DFS/BFS剪枝、队列递推、筛法+剪枝等思路。最优解法集中在逐步构建时实时验证质数，避免无效分支。

#### 高星题解推荐
1. **HeZhenting的队列BFS解法（4星）**  
   **亮点**：利用队列逐层生成候选，保证每层数字均为质数。代码简洁，思路清晰，时间复杂度优化明显。  
   **核心代码**：
   ```cpp
   queue<int> q;
   int a[]={2,3,5,7}, b[]={1,3,7,9};
   // 初始化队列后逐层扩展
   for(int i=2;i<=n;i++){
       int l=m; m=0;
       for(int j=0;j<l;j++)
           for(int k=0;k<4;k++)
               if(isprime(q.front()*10+b[k]))
                   q.push(q.front()*10+b[k]), m++;
       q.pop();
   }
   ```

2. **安笙凉城的DFS剪枝解法（4星）**  
   **亮点**：深度优先搜索中实时验证质数，及时剪枝。递归结构直观，减少无效计算。  
   **核心逻辑**：
   ```cpp
   void DFS(int k, int sum){
       if(k==n) {cout<<sum<<endl; return;}
       for(int i=0;i<5;i++){ // 添加1/3/5/7/9
           int tmp=sum*10 + a[i];
           if(prime(tmp)) DFS(k+1, tmp);
       }
   }
   ```

3. **hensier的BFS/DFS双解（4星）**  
   **亮点**：同时给出BFS和DFS实现，强调末尾只能加1/3/7/9。BFS队列维护有效路径，动态剪枝。  
   **BFS核心**：
   ```cpp
   for(int front=1, rear=4; front<=rear; front++)
       for(int k : {1,3,7,9})
           if(prime(q[front]*10 +k)) q[++rear] = new_num;
   ```

### 关键思路与技巧总结
1. **剪枝优化**：生成过程中实时验证当前数是否为质数，立即终止无效分支。
2. **结构限制**：首数字必为2/3/5/7，后续仅添加奇数（1/3/7/9），排除偶数及5。
3. **递推思想**：保存每个长度i的有效质数，基于i-1结果生成i的候选，避免重复计算。
4. **打表技巧**：对小数据（如n=8）直接预存结果，规避复杂计算。

### 拓展练习推荐
1. **P1036 选数**（DFS+质数判断，类似组合验证）  
2. **P1219 八皇后**（回溯剪枝，结构相似的逐层验证）  
3. **P1706 全排列问题**（生成所有可能并筛选，训练搜索基础）  

### 调试心得摘录
- **Last_Reincarnation**提到筛法在n=8时需打表，反映大数据处理时的时空权衡。
- **zybnxy**强调暴力解非正解但针对小数据有效，提醒需关注题目约束条件。
- **EnderXie**利用数字位数特性直接跳转无效区间，展示数学分析对剪枝的关键作用。

---
处理用时：68.22秒
# 题目信息

# [USACO1.3] 滑雪课程设计Ski Course Design

## 题目描述

农民约翰的农场里有 $n$ 座山峰，每座山都有一个在 $0$ 到 $100$ 之间的整数的海拔高度。在冬天,因为山上有丰富的积雪，约翰经常开办滑雪训练营。

不幸的是，约翰刚刚得知税法在滑雪训练营方面有新变化，明年开始实施。在仔细阅读法律后，他发现如果滑雪训练营的最高和最低的山峰海拔高度差大于 $17$ 就要收税。因此，如果他改变山峰的高度（使最高与最低的山峰海拔高度差不超过 $17$ ），约翰可以避免支付税收。

如果改变一座山 $x$ 单位的高度成本是 $x^2$ 单位，约翰最少需要付多少钱才能使海拔最高的山峰与海拔最低的山峰的高度之差不超过 $17$ 约翰只愿意改变整数单位的高度。

## 说明/提示

#### 样例输入输出 1 解释

约翰保持高度为 $4$、$20$ 和 $21$ 的山的高度。他增高高度为 $1$ 的山，变成高度 $4$ ，花费 $3^2 = 9$。他降低了高度为 $24$ 的山变成高度 $21$，也花费 $3 ^ 2 = 9$。因此总共花费 $9 + 9 = 18$。

---

#### 数据规模与约定

对于 $100\%$ 的数据，$1 \le n \le 1000$，$0 \leq a_i \leq 100$。

## 样例 #1

### 输入

```
5
20
4
1
24
21```

### 输出

```
18```

# AI分析结果



### 综合分析与结论
本题核心是枚举所有可能的山峰高度区间，计算调整成本并取最小值。关键点在于正确确定枚举范围，并高效计算每个区间的调整成本。暴力枚举在数据范围较小（0-100）时可行，而三分法利用单谷函数性质进一步优化时间复杂度。

### 高星题解推荐

#### 1. 作者：Sea_Level（★★★★★）
**关键亮点**：
- 精确枚举区间下界（0 ≤ low ≤ 83），确保最高高度不超限。
- 代码结构清晰，变量命名合理，注释详细。
- 直接计算调整到区间 [low, low+17] 的成本，逻辑简洁。

**核心代码**：
```cpp
for (int low = 0; low + 17 <= 100; low++) {
    int high = low + 17;
    int sum = 0;
    for (int i = 0; i < n; i++) {
        if (a[i] < low) sum += (low - a[i]) * (low - a[i]);
        if (a[i] > high) sum += (a[i] - high) * (a[i] - high);
    }
    ans = min(ans, sum);
}
```

#### 2. 作者：xiaoniu142857（★★★★★）
**关键亮点**：
- 使用三分法优化，时间复杂度降至 O(n log n)。
- 深入分析代价函数的单谷性质，展示高阶算法应用。

**核心代码**：
```cpp
int f(int x) { // 计算区间[x, x+17]的总成本
    int s = 0;
    for (int i = 0; i < n; ++i) {
        if (a[i] < x) s += (x - a[i]) * (x - a[i]);
        else if (a[i] > x + 17) s += (a[i] - x - 17) * (a[i] - x - 17);
    }
    return s;
}

// 三分法主循环
while (l < r) {
    int m1 = (l + r) >> 1, m2 = m1 + 1;
    f(m1) < f(m2) ? r = m2 - 1 : l = m1 + 1;
}
```

#### 3. 作者：「QQ红包」（★★★★☆）
**关键亮点**：
- 枚举下界至 84（实际应至 83），代码仍正确但范围稍冗余。
- 代码可读性强，输入输出处理规范。

**核心代码**：
```cpp
for (i = 0; i <= 84; i++) { // 枚举下界
    int w = 0;
    for (j = 1; j <= n; j++) {
        if (a[j] < i) w += (i - a[j]) * (i - a[j]);
        if (a[j] > i + 17) w += (a[j] - i - 17) * (a[j] - i - 17);
    }
    m = min(m, w);
}
```

### 关键思路与技巧总结
1. **暴力枚举**：当数据范围有限时（如高度 0-100），枚举所有可能的有效区间。
2. **数学优化**：利用代价函数的单谷性质，使用三分法快速定位最小值。
3. **边界处理**：精确计算枚举范围（如 low ≤ 83），避免无效计算。

### 拓展与举一反三
- **类似问题**：涉及调整参数使满足条件的最小代价问题（如 P1873 砍树、P1843 奶牛晒衣服）。
- **算法套路**：单峰/谷函数的最值问题可考虑二分或三分法；小数据范围优先暴力枚举。

### 推荐练习题
1. P1873 砍树（二分法求最大高度）
2. P2858 [USACO06FEB]Treats for the Cows（区间动态规划）
3. P1843 奶牛晒衣服（贪心+二分答案）

### 个人心得摘录
- **边界检查**：作者卑微的绝望提到因未正确处理枚举范围导致 80 分，强调边界验证的重要性。
- **代码可读性**：Sea_Level 的详细注释和命名规范提升代码可维护性。
- **算法选择**：xiaoniu142857 指出“单谷函数”特性，启发读者深入分析问题数学模型。

---
处理用时：119.77秒
# 题目信息

# [USACO19DEC] Livestock Lineup B

## 题目描述

每天，Farmer John 都要给他的 $8$ 头奶牛挤奶。她们的名字分别是 Bessie，Buttercup，Belinda，Beatrice，Bella，Blue，Betsy，和 Sue。

不幸的是，这些奶牛相当难以伺候，她们要求 Farmer John 以一种符合 $N$ 条限制的顺序给她们挤奶。每条限制的形式为“$X$ 必须紧邻着 $Y$ 挤奶”，要求奶牛 $X$ 在挤奶顺序中必须紧接在奶牛 $Y$ 之后，或者紧接在奶牛 $Y$ 之前。

请帮助 Farmer John 求出一种满足所有限制的奶牛挤奶顺序。保证这样的顺序是存在的。如果有多种顺序都满足要求，请输出字典序最小的一种。也就是说，第一头奶牛需要是所有可能排在任意合法奶牛顺序的第一位的奶牛中名字字典序最小的。在所有合法的以这头字典序最小的奶牛为首的奶牛顺序中，第二头奶牛需要是字典序最小的，以此类推。

## 说明/提示

$1 \leq N \leq 7$。

供题：Brian Dean

## 样例 #1

### 输入

```
3
Buttercup must be milked beside Bella
Blue must be milked beside Bella
Sue must be milked beside Beatrice```

### 输出

```
Beatrice
Sue
Belinda
Bessie
Betsy
Blue
Bella
Buttercup```

# AI分析结果



### 综合分析与结论
本题要求生成满足相邻条件且字典序最小的奶牛排列。各题解主要采用两种思路：**全排列暴力枚举**和**图论链式遍历**。全排列法利用STL的`next_permutation`生成字典序排列并验证条件，代码简洁；图论法通过构建邻接关系高效生成解，适合更高阶优化。

---

### 高星题解推荐

#### 1. 作者：Yellow_Lemon_Tree & chenningxuan（⭐⭐⭐⭐⭐）
**关键亮点**  
- 使用`next_permutation`生成全排列，初始字典序排列确保首个合法解即字典序最小。  
- 代码简洁高效，直接利用STL处理排列生成和条件检查。  
**核心代码**  
```cpp
vector<string> cows = {"Beatrice","Belinda",...,"Sue"}; // 初始字典序排列
do {
    if (满足所有相邻条件) {
        输出排列并终止;
    }
} while (next_permutation(cows.begin(), cows.end()));
```

#### 2. 作者：Invisible_Blade（⭐⭐⭐⭐⭐）
**关键亮点**  
- 图论思路，构建邻接表和度数数组，按字典序选择起点遍历链式结构。  
- 避免暴力枚举，时间复杂度更优（线性遍历）。  
**核心代码**  
```cpp
// 构建邻接关系和度数
for (输入每条约束) {
    int x = 转换名字到编号, y = ...;
    du[x]++, du[y]++;
    f[x][y] = f[y][x] = 1;
}
// 按字典序生成排列
while (未排完) {
    选择字典序最小的度≠2的未访问节点作为起点;
    输出并标记;
    if (起点为链端点) DFS遍历链;
}
```

#### 3. 作者：虐题者（⭐⭐⭐⭐）
**关键亮点**  
- 手写DFS生成全排列，通过剪枝优化搜索。  
- 明确字典序生成逻辑，适合理解排列生成原理。  
**个人心得**  
> “因为DFS按字典序生成排列，找到第一个解即可终止，避免不必要的搜索。”

---

### 最优思路总结
1. **全排列暴力法**  
   - **核心**：利用`next_permutation`按字典序生成排列，逐一检查条件。  
   - **优化点**：初始数组必须按字典序排列，确保首个合法解即为答案。  
   - **适用场景**：数据量小（如本题8头牛）。  

2. **图论链式遍历法**  
   - **核心**：将奶牛间约束建模为图，按字典序选择起点遍历链或孤立节点。  
   - **优化点**：避免无效排列生成，时间复杂度接近线性。  
   - **适用场景**：约束条件复杂或数据量稍大的情况。  

---

### 拓展与相似题目
1. **全排列与约束条件**  
   - 例题：洛谷P1706（全排列问题）、P1091（合唱队形）。  
2. **图论与链式结构**  
   - 例题：洛谷P1341（无序字母对，欧拉路径）。  

---

### 代码实现技巧
- **STL的`next_permutation`**：初始序列必须有序，生成排列按字典序递增。  
- **图的度数分析**：通过度数判断节点类型（孤立点、链端点或中间节点）。  
- **字典序最小生成**：按固定顺序遍历节点，优先选择编号小的合法起点。  

---

### 推荐练习题
1. [P1706 全排列问题](https://www.luogu.com.cn/problem/P1706)  
2. [P1341 无序字母对](https://www.luogu.com.cn/problem/P1341)  
3. [P1091 合唱队形](https://www.luogu.com.cn/problem/P1091)

---
处理用时：102.35秒
# 题目信息

# [USACO19DEC] MooBuzz S

## 题目描述

Farmer John 的奶牛们最近成为了一个简单的数字游戏“FizzBuzz”的狂热玩家。这个游戏的规则很简单：奶牛们站成一圈，依次从一开始报数，每头奶牛在轮到她的时候报一个数。如果一头奶牛将要报的数字是 $3$ 的倍数，她应当报 `Fizz` 来代替这个数。如果一头奶牛将要报的数字是 $5$ 的倍数，她应当报 `Buzz` 来代替这个数。如果一头奶牛将要报的数字是 $15$ 的倍数，她应当报 `FizzBuzz` 来代替这个数。于是这个游戏的开始部分的记录为：

`1, 2, Fizz, 4, Buzz, Fizz, 7, 8, Fizz, Buzz, 11, Fizz, 13, 14, FizzBuzz, 16`

由于词汇的匮乏，奶牛们玩的 FizzBuzz 中用`Moo` 代替了 `Fizz`、`Buzz`、`FizzBuzz`。于是奶牛版的游戏的开始部分的记录为：

`1, 2, Moo, 4, Moo, Moo, 7, 8, Moo, Moo, 11, Moo, 13, 14, Moo, 16`

给定 $N$，请求出这个游戏中第 $N$ 个被报的数。

## 说明/提示

关于部分分：

测试点 $1$ 为样例。

测试点 $2\sim 5$ 满足 $N\le 10^6$。

对于 $100\%$ 的数据，$1 \leq N \leq 10^9$

供题：Brian Dean

## 样例 #1

### 输入

```
4```

### 输出

```
7```

# AI分析结果



### 综合分析结论
该题核心在于快速定位第N个非3/5倍数的数。题解主要分为两类思路：  
1. **数学周期法**（主流解法）：利用15的周期性，预处理余数表，O(1)计算  
2. **二分+容斥法**：通过容斥计算有效数数量，二分答案，O(logN)  

数学法更优，适合本题的1e9规模；二分法通用性强但代码略长。

---

### 精选题解（评分≥4星）

#### 1. 作者：rui_er（5星）
**关键亮点**：  
- 明确推导循环节与余数数组，数学解释清晰  
- 代码简洁优雅，正确处理边界条件（n%8==0时减1）  
- 核心代码仅需数组查表与简单计算  

**核心代码**：  
```cpp
int a[8] = {14, 1, 2, 4, 7, 8, 11, 13}; // 余数数组
int main() {
    int n = input();
    int d = n / 8;
    int ans = d * 15;
    if(n%8 != 0) ans += a[n%8];
    else --ans; // 处理整除情况
    cout << ans;
}
```

#### 2. 作者：Snow_Dreams（5星）
**关键亮点**：  
- 从数论角度证明15的循环性，逻辑严谨  
- 代码直接体现数学推导，数组预处理直观  
- 代码风格简洁，适合快速理解  

**核心代码**：  
```cpp
int a[8] = {1,2,4,7,8,11,13,14}; // 1-15的有效数
int main() {
    int n = input();
    int k = (n-1)/8; // 周期数
    cout << 15*k + a[(n-1)%8]; // -1调整下标
}
```

#### 3. 作者：tiger2005（4星）
**关键亮点**：  
- 提供两种解法（二分与数学法），拓展思维  
- 数学法代码极简，仅需8行  
- 附带调试心得，强调边界测试  

**核心代码**：  
```cpp
int sz[8]={1,2,4,7,8,11,13,14};
printf("%lld",15*((N-1)/8)+sz[(N-1)%8]); // 无需特判
```

---

### 最优思路总结
**关键技巧**：  
1. **周期发现**：3和5的最小公倍数为15，每15个数中有8个有效数  
2. **余数查表**：预处理1-15内的有效数，直接映射余数位置  
3. **公式推导**：总结果=完整周期数×15 + 余数对应值，注意整除边界  

**实现要点**：  
- 余数数组下标调整（如n-1处理）  
- 整除时需回退到周期末（如15k-1）

---

### 拓展与同类题目
**类似题型套路**：  
- 寻找满足特定模数条件的数（如非a、b的倍数）  
- 利用最小公倍数构造周期，或容斥统计数量  

**推荐题目**：  
1. [P1403] 约数研究（统计倍数数量）  
2. [P2651] 添加括号（模运算与周期性）  
3. [P2926] Patting Heads（倍数标记与计数）

---

### 题解个人心得摘录
1. **风人**：  
   > "当a%8=0时需减一，84分的大概都死在这..."  
   → 强调边界测试的重要性，模运算需注意零余数特判  

2. **gtl_caiji**：  
   > "初始代码因未处理15k直接WA，后加特判解决"  
   → 验证算法时应覆盖所有余数情况，尤其是周期末点  

3. **tiger2005**：  
   > "二分法边界爆炸...数学法只需8行"  
   → 简单问题优先寻找数学规律，避免过度设计

---
处理用时：69.61秒
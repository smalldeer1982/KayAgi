# 题目信息

# [USACO23JAN] Air Cownditioning II B

## 题目描述

农夫约翰的 $N$ 头奶牛 $(1≤N≤20)$ 住在一个谷仓里，谷仓里有连续的牛栏，编号为 $1-100$ 。 奶牛 $i$ 占据了编号 $[s_i,t_i]$ 的牛栏。 不同奶牛占据的牛栏范围是互不相交的。 奶牛有不同的冷却要求，奶牛 $i$ 占用的每个牛栏的温度必须至少降低 $c_i$ 单位。

谷仓包含 $M$ 台空调，标记为 $1-M$ $(1\le M\le10)$。第 $i$ 台空调需要花费 $m_i$ 单位的金钱来运行 $(1\le m_i \le 1000)$ ，如果运行，第 $i$ 台空调将牛栏 $[a_i,b_i]$ 所有牛栏的温度降低 $p_i$（$1\le p_i\le10^6）$。 空调覆盖的牛栏范围可能会重叠。

请帮助农夫约翰求出满足所有奶牛需求要花费的最少金钱。

## 说明/提示

### 样例解释 1

一种花费最少的可能解决方案是选择那些冷却区间为 $[2,9]$ 、$[1,2]$ 和 $[6,9]$ 的空调，成本为 $ 3+2+5=10$ .


对于 $100\%$ 的数据，$1 \le N \le 20$， $1 \le M \le 10$, $ 1 \le a_i, b_i, s_i, t_i \le 100$, $1 \le c_i, p_i \le 10^6$， $1 \le m_i \le 1000$。

## 样例 #1

### 输入

```
2 4
1 5 2
7 9 3
2 9 2 3
1 6 2 8
1 2 4 2
6 9 1 5```

### 输出

```
10```

# AI分析结果



### 综合分析与结论
本题解核心在于暴力枚举空调的组合，利用DFS生成所有可能的子集。由于M≤10，总状态数为2^10=1024，完全可行。各题解均采用DFS+回溯框架，差异在于预处理需求的方式（差分数组 vs 直接累加）与判断条件的优化。

---

### 精选题解列表（评分≥4星）

#### 1. 作者：Jorisy（★★★★★）
**关键亮点**  
- 预处理每个牛栏的冷却需求数组`cw[]`，逻辑清晰。
- DFS回溯时直接操作`cw[]`数组，无需额外空间。
- 代码简洁，剪枝高效，仅维护当前最小花费。

**核心代码片段**  
```cpp
void dfs(int dep, int s) {
    if (dep > m) {
        if (f()) ans = min(ans, s); // 检查是否满足条件
        return;
    }
    dfs(dep+1, s); // 不选当前空调
    // 选当前空调并更新cw[]
    for (int i =a[dep]; i<=b[dep]; i++) cw[i] -= p[dep];
    dfs(dep+1, s + v[dep]);
    for (int i=a[dep]; i<=b[dep]; i++) cw[i] += p[dep]; // 回溯
}
```

#### 2. 作者：doumingze（★★★★☆）
**关键亮点**  
- 使用`st[]`数组标记空调是否选中，逻辑直观。
- 分离判断函数`judge()`，增强代码可读性。
- 对每个牛棚单独计算需求，避免预处理错误。

**个人心得**  
> “判断是否符合降温需求，可以先求出每个牛棚至少需降多少温度，再比对本次枚举的状态。”  
> —— 强调需求与效果的分离计算，避免重复累加错误。

---

### 最优关键思路与技巧
1. **需求预处理**：将奶牛的需求转换为每个牛栏的冷却需求数组，后续只需检查该数组是否全≤0。
2. **状态回溯**：在DFS中直接修改全局数组并回溯，减少内存拷贝开销。
3. **剪枝优化**：维护全局最小花费`ans`，在DFS过程中及时更新最优解。

---

### 拓展与举一反三
- **同类问题**：子集枚举问题（如背包问题变种）、状态压缩DP（当M稍大时可用位运算优化）。
- **类似题目推荐**  
  1. [P2392 kkksc03考前临时抱佛脚](https://www.luogu.com.cn/problem/P2392)（子集分割）
  2. [P1157 组合的输出](https://www.luogu.com.cn/problem/P1157)（组合枚举）
  3. [P2036 PERKET](https://www.luogu.com.cn/problem/P2036)（暴力搜索+剪枝）

---

### 调试与心得摘录
- **Jorisy**：强调回溯时必须恢复`cw[]`的原值，否则会影响后续分支。
- **so_find_skind**：指出“选不了再恢复”是DFS暴力法的核心，提醒注意全局数组的修改与恢复顺序。
- **LegendaryGrandmaster**：尝试用二进制枚举但未显著优化，说明DFS在此题更直观。

---
处理用时：38.87秒
# 题目信息

# [USACO23JAN] Moo Operations B

## 题目描述

农夫约翰给了奶牛贝西 $Q$ 个新字符串 $(1\le Q\le100)$ ，其中只有字符 `M` 和 `O` ，她想将 $Q$ 个字符串都变成 `MOO`。

贝西可以用如下的方式改变字符串：
- 用相反的字符替换第一个或最后一个字符（将 `M` 变成 `O` ，将 `O` 变成 `M` ）。
- 删除第一个或最后一个字符。

贝西只想用最少的次数完成改变。请你帮她找到需要的最小改变次数。如果不可能在有限的步数中完成这个任务，请输出 `-1` 。

## 说明/提示

### 样例解释 1
将第一个字符串转换为 `MOO`的 $4$ 个操作序列如下：
- 用O替换最后一个字符（操作1）
- 删除第一个字符（操作2）
- 删除第一个字符（操作2）
- 删除第一个字符（操作2）

可以证明，第二个字符串无法转换为 `MOO`。 

第三个字符串已经是 `MOO`，因此无需执行任何操作。

对于 $100\%$ 的测试点，保证 $1 \le Q \le 100$, $ 1\le |S| \le 100$ 。

## 样例 #1

### 输入

```
3
MOMMOM
MMO
MOO```

### 输出

```
4
-1
0```

# AI分析结果



### 综合分析与结论
题目核心在于找到能通过首尾操作变为 "MOO" 的三字符子串。所有可行解必须满足中间字符为 'O'，并计算首尾字符的替换次数。最优解法是枚举所有三字符子串，计算最小替换次数，并加上删除次数（原长度-3）。若不存在有效子串则返回 -1。

---

### 精选题解

#### 1. LegendaryGrandmaster（5星）
**关键亮点**：  
- 直接枚举所有三字符子串，分类处理四种可能情况。
- 代码简洁高效，时间复杂度 O(n)，空间复杂度 O(1)。
- 预判所有可能的三字符组合，思路清晰。

**代码核心**：
```cpp
for(int i=0;i<st.size()-2;i++){
    string str=st.substr(i,3);
    if(str=="MOO")mi=min(mi,0);
    else if(str=="MOM")mi=min(mi,1);
    else if(str=="OOO")mi=min(mi,1);
    else if(str=="OOM")mi=min(mi,2);
}
```

#### 2. Xy_top（4星）
**关键亮点**：  
- 代码极简，逻辑紧凑。
- 利用预定义的四种有效子串类型，直接比较更新最小值。

**代码核心**：
```cpp
for(int i = 0; i < s.size () - 2; i ++) {
    t = s.substr (i, 3);
    if (t == "MOO") ans = s.size () - 3;
    else if (t == "MOM" || t == "OOO") ans = min (ans, int (s.size () - 2) );
    else if (t == "OOM") ans = min (ans, int (s.size () - 1) );
}
```

#### 3. doumingze（4星）
**关键亮点**：  
- 使用 `map` 预处理有效子串及其操作次数，提升可读性。
- 统一处理子串匹配，代码结构清晰。

**代码核心**：
```cpp
map<string, int> m = {{"MOO",0}, {"MOM",1}, {"OOO",1}, {"OOM",2}};
for(int i = 0; i <= s.size() - 3; i ++) {
    string t = s.substr(i, 3);
    if(m.count(t)) res = min(res, m[t]);
}
```

---

### 最优思路总结
1. **必要条件**：有效子串中间字符必须为 'O'。
2. **枚举所有三字符子串**，判断其是否为 "MOO"、"MOM"、"OOO"、"OOM" 之一。
3. **最小操作次数** = 替换次数 + (原长度 - 3)。
4. **剪枝优化**：若遍历完所有子串仍无有效情况，返回 -1。

---

### 拓展与同类题推荐
1. **思维拓展**：类似题目需关注操作限制下的关键字符位置，如中间字符不可修改时需优先固定中间值。
2. **推荐题目**：
   - [P1032 字符串变换](https://www.luogu.com.cn/problem/P1032)（字符串操作与 BFS）
   - [P1141 01迷宫](https://www.luogu.com.cn/problem/P1141)（字符串处理与连通块分析）
   - [P1012 拼数](https://www.luogu.com.cn/problem/P1012)（字符串拼接与贪心策略）

---

### 个人心得摘录
- **Loser_Syx**："中间字符是 'M' 时无法成立" —— 必须严格分析操作限制。
- **so_find_skind**："无解情况需特判长度 <3" —— 边界条件优先处理。
- **Jorisy**："只能改变两端，中间不能改变" —— 关键约束决定解题方向。

---
处理用时：82.07秒
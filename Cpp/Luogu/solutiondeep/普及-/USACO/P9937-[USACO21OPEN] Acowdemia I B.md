# 题目信息

# [USACO21OPEN] Acowdemia I B

## 题目描述

由于对计算机科学的热爱，以及有朝一日成为 「Bessie 博士」的诱惑，奶牛 Bessie 开始攻读计算机科学博士学位。经过一段时间的学术研究，她已经发表了 $N$ 篇论文（$1 \le N \le 10^5$），并且她的第 $i$ 篇论文得到了来自其他研究文献的 $c_i$ 次引用（$0 \le c_i \le 10^5$）。

Bessie 听说学术成就可以用 $h$ 指数来衡量。$h$ 指数等于使得研究员有至少 $h$ 篇引用次数不少于 $h$ 的论文的最大整数 $h$。例如，如果一名研究员有 $4$ 篇论文，引用次数分别为 $(1,100,2,3)$，则 $h$ 指数为 $2$，然而若引用次数为 $(1,100,3,3)$ 则 $h$ 指数将会是 $3$。

为了提升她的 $h$ 指数，Bessie 计划写一篇综述，并引用一些她曾经写过的论文。由于页数限制，她至多可以在这篇综述中引用 $L$ 篇论文（$0 \le L \le 10^5$），并且她只能引用每篇她的论文至多一次。

请帮助 Bessie 求出在写完这篇综述后她可以达到的最大 $h$ 指数。

注意 Bessie 的导师可能会告知她纯粹为了提升 $h$ 指数而写综述存在违反学术道德的嫌疑；我们不建议其他学者模仿 Bessie 的行为。 

## 说明/提示

### 样例解释 1

Bessie 不能引用任何她曾经写过的论文。上文中提到，$(1,100,2,3)$ 的 $h$ 指数为 $2$。

### 样例解释 2

如果 Bessie 引用她的第三篇论文，引用数会变为 $(1,100,3,3)$。上文中提到，这一引用数的 $h$ 指数为 $3$。

### 测试点性质

- 测试点 $1-7$ 满足 $N\le 100$。
- 测试点 $8-10$ 满足 $N\le 1000$。
- 测试点 $11-17$ 满足 $N \le 10^5$。

## 样例 #1

### 输入

```
4 0
1 100 2 3```

### 输出

```
2```

## 样例 #2

### 输入

```
4 1
1 100 2 3```

### 输出

```
3```

# AI分析结果



### 综合分析与结论
本题需要找到在允许增加引用次数的条件下，最大可能的h指数。各题解主要采用贪心或二分法。**二分法**因其高效和正确性成为最优解法，通过检查每个h值的可行性，结合排序后的数组统计满足条件的论文数，确保时间复杂度为O(n log n)。贪心方法虽直接，但在大数据下可能效率不足。

---

### 高星题解推荐

#### 作者：we_are_the_chuibing（⭐️⭐️⭐️⭐️⭐️）
**关键亮点**：  
- 清晰的二分思路，结合排序后的数组快速统计满足条件的论文数。  
- Check函数逻辑严谨，通过统计现有达标论文和可提升论文数，确保正确性。  
- 代码结构清晰，注释明确，易于理解和调试。  

**核心代码**：
```cpp
bool check(int h) {
    int count_1 = 0, count_2 = 0;
    for (int i = 1; i <= N; i++) { 
        if (quote[i] >= h) count_1++;
        if (quote[i] == h - 1) count_2++;
    }
    if (count_1 >= h) return true;
    return (h - count_1 <= L && count_2 >= h - count_1);
}
```

---

#### 作者：precho（⭐️⭐️⭐️⭐️）
**关键亮点**：  
- 简洁的二分实现，Check函数采用贪心策略，遍历后x篇论文判断是否满足条件。  
- 利用升序排序特性，优先处理接近h值的论文，优化引用次数分配。  

**核心代码**：
```cpp
bool check(int x) {
    int sum = 0;
    for (int i = n - 1; i >= (n - x); i--) {
        if (line[i] + 1 == x) sum += x - line[i];
        else if (line[i] < x - 1) return false;
    }
    return sum <= L;
}
```

---

### 最优关键思路
**二分答案 + 贪心统计**：  
1. **排序数组**：将论文引用次数排序，便于快速统计。
2. **二分框架**：在[0, n]范围内二分可能的h值。
3. **Check函数设计**：  
   - 统计已有≥h次的论文数（`count_1`）。  
   - 统计恰好为h-1次的论文数（`count_2`），通过加1可提升至h次。  
   - 判断是否可用L次操作补足所需论文数。  

---

### 拓展与同类题目
**类似题目**：  
1. [P2678 跳石头](https://www.luogu.com.cn/problem/P2678)：最小化最大跳跃距离。  
2. [P1182 数列分段](https://www.luogu.com.cn/problem/P1182)：最小化最大子段和。  
3. [P4343 自动刷题机](https://www.luogu.com.cn/problem/P4343)：二分答案判断可行解。  

**个人心得**：  
- **Check函数是二分核心**：需精确分析条件，确保正确性和效率。  
- **边界处理**：如升序/降序排序影响遍历方向，需在代码中明确体现。  
- **贪心优化**：优先提升接近h值的论文，最大化h指数提升空间。

---
处理用时：142.02秒
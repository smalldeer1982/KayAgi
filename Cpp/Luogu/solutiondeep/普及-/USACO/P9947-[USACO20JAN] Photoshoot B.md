# 题目信息

# [USACO20JAN] Photoshoot B

## 题目描述

Farmer John 在给他编号为 $1\ldots N$ 的 $N$ 头奶牛排队拍照（$2\le N\le 10^3$）。FJ 一开始计划从左向右数第 $i$ 个位置排编号为 $a_i$ 的奶牛，他在一张纸上写下了排列 $a_1,a_2,\ldots,a_N$。不幸的是，这张纸刚刚被 Farmer Nhoj 偷走了！

幸好 FJ 仍然有机会恢复他之前写下的排列。在这张纸被偷走之前，Bessie 记录了序列 $b_1,b_2,\ldots,b_{N−1}$，对于每一个 $1\le i<N$ 满足 $b_i=a_i+a_{i+1}$。

基于 Bessie 的信息，帮助 FJ 恢复可以产生序列 $b$
的“字典序最小”的排列 $a$。排列 $x$ 字典序小于排列 $y$，如果对于某个 $j$，对于所有 $i<j$ 均有 $x_i=y_i$，且有 $x_j<y_j$（换句话说，这两个排列到某个位置之前都相同，在这个位置上 $x$ 小于 $y$）。保证存在至少一个满足条件的 $a$。 

## 说明/提示

### 样例解释 1

$a$ 能够产生 $b$，因为 $3+1=4$，$1+5=6$，$5+2=7$，$2+4=6$。

### 测试点性质

 - 测试点 $2-4$ 满足 $N\le 8$。
 - 测试点 $5-10$ 没有额外限制。

## 样例 #1

### 输入

```
5
4 6 7 6```

### 输出

```
3 1 5 2 4```

# AI分析结果



### 综合分析与结论

各题解核心思路一致：枚举首项 $a_1$，递推生成序列并检查合法性。关键点包括正确枚举范围、及时合法性检查和使用数组优化。最优解法应确保枚举范围正确（$a_1 \in [1, b_1-1]$），逐项生成并实时检查元素合法性，使用数组记录访问情况以提高效率。

---

### 精选题解与评分

#### 1. 作者：Kle1N（5星）
**关键亮点**：
- 正确枚举范围（$1$ 至 $b_1-1$），减少无效循环。
- 生成时实时检查元素范围及重复，及时终止非法情况。
- 使用数组代替哈希表，高效且代码清晰。

**核心代码**：
```cpp
for(int i=1; i < b[1]; i++) { // 正确枚举范围
    memset(vis, 0, sizeof(vis));
    a[1] = i;
    vis[i] = 1;
    bool valid = true;
    for (int j=2; j<=n; j++) {
        a[j] = b[j-1] - a[j-1];
        if (a[j] < 1 || a[j] > n || vis[a[j]]) { // 实时检查
            valid = false;
            break;
        }
        vis[a[j]] = 1;
    }
    if (valid) {
        // 输出结果
    }
}
```

#### 2. 作者：DFs_YYDS（4星）
**关键亮点**：
- 详细注释，代码可读性强。
- 实时检查元素合法性，提前终止无效生成。

**核心代码**：
```cpp
bool check(int a1) {
    bool vis[N] = {0};
    a[1] = a1;
    for (int i=2; i<=n; i++) {
        a[i] = b[i-1] - a[i-1];
        if (a[i]<1 || a[i]>n || vis[a[i]]) return false;
        vis[a[i]] = true;
    }
    return true;
}
// 枚举 a1 并调用 check
```

#### 3. 作者：Officer（4星）
**关键亮点**：
- 简洁的代码结构，变量命名规范。
- 生成时即时处理越界及重复问题。

**核心代码**：
```cpp
for (int i=1; i<=n; i++) {
    memset(vis, 0, sizeof(vis));
    a[1] = i;
    // 生成并检查每个元素
    for (int j=1; j<n; j++) {
        a[j+1] = b[j] - a[j];
        if (a[j+1]<1 || a[j+1]>n || vis[a[j+1]]) break;
        vis[a[j+1]] = 1;
    }
    // 验证并输出
}
```

---

### 关键思路总结
1. **枚举范围优化**：$a_1$ 应满足 $1 \le a_1 \le b_1-1$，确保 $a_2$ 为正整数。
2. **递推生成**：根据 $a_i = b_{i-1} - a_{i-1}$ 生成后续元素。
3. **实时检查**：在生成每个元素时立即检查范围及重复，避免无效计算。
4. **数据结构优化**：使用数组而非哈希表记录元素出现情况，提高效率。

---

### 拓展题目推荐
1. **P1115 最大子段和**（递推与条件判断）
2. **P1219 八皇后问题**（排列生成与合法性检查）
3. **P1706 全排列问题**（字典序排列生成）

---

### 个人心得摘录
- **变量命名**：避免混淆（如用 `b` 存储输入，而非 `a`）。
- **及时清空**：每次枚举前重置访问标记数组。
- **边界处理**：元素必须为正整数且在 $[1, n]$ 内，否则直接终止。

---
处理用时：145.61秒
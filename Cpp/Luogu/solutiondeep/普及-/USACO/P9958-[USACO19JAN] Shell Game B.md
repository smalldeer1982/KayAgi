# 题目信息

# [USACO19JAN] Shell Game B

## 题目描述

为了消磨时光，奶牛 Bessie 和她的朋友 Elsie 喜欢玩一种她们在农业展览会上看到的游戏。

游戏准备阶段，Bessie 在桌子上放置三个倒置的坚果壳，并在其中一个坚果壳下面藏了一块小的鹅卵石（至少她希望这是一块鹅卵石——她在一块牧场的地上找到的）。随后 Bessie 会两两调换坚果壳，同时 Elsie 试着去猜鹅卵石的位置。

奶牛们在农业展览会上看到的这个游戏的标准形式是玩家可以看到鹅卵石初始的位置，然后要求玩家猜所有交换完成之后鹅卵石最终的位置。

然而，现在奶牛们想要去进行这样一种玩法，Elsie 不知道鹅卵石的初始位置，同时她可以在每一次交换之后猜一下鹅卵石的位置。Bessie 知道正确答案，在游戏结束后会给 Elsie 一个分数，等于她猜对的次数。

给定所有的交换和 Elsie 的猜测，但是不给出鹅卵石的初始位置，请求出 Elsie 最高可能获得的分数。 

## 说明/提示

### 样例解释 1

在这个例子中，Elsie 最多可以获得 $2$ 分。如果鹅卵石开始时位于坚果壳 $1$ 下面，那么她猜中了一次（最后一次）。如果鹅卵石开始时位于坚果壳 $2$ 下面，那么她猜中了两次（开始两次）。如果鹅卵石开始时位于坚果壳 $3$ 下面，那么她没有猜对任何一次。 

## 样例 #1

### 输入

```
3
1 2 1
3 2 1
1 3 1```

### 输出

```
2```

# AI分析结果



### 综合分析与结论
该题目本质是模拟题，通过枚举初始位置并跟踪交换后的状态，统计最大猜中次数。各题解核心思路均为枚举初始位置+模拟交换过程，时间复杂度均为 O(3n)，均能高效通过。关键优化点在于选择简洁的位置跟踪方式，避免冗余操作。

---

### 高星题解推荐

#### 1. 作者：Kle1N（5星）
**关键亮点**：代码简洁高效，直接跟踪鹅卵石当前位置，逻辑清晰易懂。
**核心代码**：
```cpp
int main(){
    cin>>n;
    for(int i=1;i<=n;i++) cin>>a[i]>>b[i]>>g[i];
    for(int s=1;s<=3;s++){ // 枚举初始位置
        cur = s;
        cnt = 0;
        for(int i=1;i<=n;i++){
            if(cur == a[i]) cur = b[i]; // 交换逻辑
            else if(cur == b[i]) cur = a[i];
            if(cur == g[i]) cnt++; // 统计正确次数
        }
        ans = max(ans, cnt);
    }
    cout << ans;
}
```

#### 2. 作者：DHT666（5星）
**关键亮点**：使用布尔数组模拟鹅卵石存在状态，直观体现交换过程。
**核心代码**：
```cpp
int main(){
    for(int i=1;i<=3;i++){ // 枚举初始位置
        memset(now,0,sizeof now);
        now[i] = 1;
        int tot = 0;
        for(int j=1;j<=n;j++){
            swap(now[a[j]], now[b[j]]); // 交换操作
            if(now[g[j]] == 1) tot++; // 直接判断猜测位置
        }
        ans = max(ans, tot);
    }
    cout << ans;
}
```

#### 3. 作者：watergod（4星）
**关键亮点**：函数封装模拟过程，代码结构清晰，便于调试。
**核心代码**：
```cpp
long long solve(long long wz){ // wz为初始位置
    for(int i=1;i<=n;i++){
        if(wz == a[i]) wz = b[i]; // 更新位置
        else if(wz == b[i]) wz = a[i];
        if(wz == g[i]) solve_ans++; // 统计正确次数
    }
    return solve_ans;
}
```

---

### 最优关键思路
**位置跟踪法**：直接维护鹅卵石当前位置变量 `cur`，每次交换后更新其值。例如初始位置为 `s`，当交换 `a[i]` 和 `b[i]` 时，若 `cur` 等于 `a[i]` 或 `b[i]`，则 `cur` 切换到另一位置。此方法只需 O(1) 时间完成每次交换，高效且易于实现。

---

### 拓展与相似题目推荐
1. **P1563 玩具谜题** - 环形位置模拟，类似位置跟踪。
2. **P1056 排座椅** - 处理移动后的状态统计。
3. **P1042 乒乓球** - 模拟规则变化后的得分统计。

---

### 题解中的个人心得
- **DHT666** 提到“仔细点就能做出来”，强调模拟题需注意细节。
- **Kle1N** 的代码结构展示了如何通过简洁的变量命名和逻辑分层提升可读性。

---
处理用时：70.24秒
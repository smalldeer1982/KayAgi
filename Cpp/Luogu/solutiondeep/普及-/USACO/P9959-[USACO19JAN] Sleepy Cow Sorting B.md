# 题目信息

# [USACO19JAN] Sleepy Cow Sorting B

## 题目描述

Farmer John正在尝试将他的 $N$ 头奶牛（$1\le N\le 100$），方便起见编号为 $1\ldots N$，在她们前往牧草地吃早餐之前排好顺序。

当前，这些奶牛以 $p_1,p_2,p_3,\ldots,p_N$ 的顺序排成一行，Farmer John 站在奶牛 $p_1$ 前面。他想要重新排列这些奶牛，使得她们的顺序变为 $1,2,3,\ldots,N$，奶牛 $1$ 在 Farmer John 旁边。

今天奶牛们有些困倦，所以任何时刻都只有直接面向 Farmer John 的奶牛会注意听 Farmer John 的指令。每一次他可以命令这头奶牛沿着队伍向后移动 $k$ 步，$k$ 可以是范围 $1\ldots N−1$ 中的任意数。她经过的 $k$ 头奶牛会向前移动，腾出空间使得她能够插入到队伍中这些奶牛之后的位置。

例如，假设 $N=4$，奶牛们开始时是这样的顺序：

> FJ: $4, 3, 2, 1$

唯一注意 FJ 指令的奶牛是奶牛 $4$。当他命令她向队伍后移动 $2$ 步之后，队伍的顺序会变成：

> FJ: $3, 2, 4, 1$

现在唯一注意 FJ 指令的奶牛是奶牛 $3$，所以第二次他可以给奶牛 $3$ 下命令，如此进行直到奶牛们排好了顺序。

Farmer John 急欲完成排序，这样他就可以回到他的农舍里享用他自己的早餐了。请帮助他求出将奶牛们排好顺序所需要的最小操作次数。 

## 样例 #1

### 输入

```
4
1 2 4 3```

### 输出

```
3```

# AI分析结果



### 综合分析与结论
题目要求通过每次移动队首元素到后面的方式将排列升序。各题解主要思路是寻找逆序对的累计步数或最长递增后缀的长度。最优解法通过遍历数组，统计逆序对的间隔差之和，时间复杂度为O(n)。

### 高星题解推荐
1. **T_TLucas_Yin的题解（5星）**
   - **关键亮点**：思路清晰，通过维护上一个逆序位置，累加间隔差计算总步数。
   - **代码核心**：
     ```cpp
     for(int i=1;i<=n;i++){
         if(a[i]<a[i-1]) sum+=i-l,l=i;
     }
     ```
   - **个人心得**：通过逆序对的间隔差直接计算总步数，无需复杂结构。

2. **Arson1st的题解（5星）**
   - **关键亮点**：引入引理，证明最长递增后缀前的元素需移动，代码简洁。
   - **代码核心**：
     ```cpp
     for (int i = 1, la = 1; i <= n; i++) {
         if (p[i] >= p[i-1]) continue;
         ans += i - la; la = i;
     }
     ```

3. **DHT666的题解（4星）**
   - **关键亮点**：类似思路，代码清晰易读，强调逆序对的交换逻辑。
   - **代码核心**：
     ```cpp
     for(int i=1;i<=n;i++) {
         if(a[i] < a[i - 1]) {
             ans += i - tot;
             tot = i;
         }
     }
     ```

### 最优思路总结
**关键技巧**：遍历数组，统计逆序对的间隔差。每当遇到逆序对时，累加当前索引与上一个逆序位置的差值，更新位置标记。此方法正确性基于每个逆序对应必须移动的步数。

### 拓展练习
1. **P1908 逆序对**（考察逆序对统计）
2. **P1177 快速排序**（排序过程中的元素移动策略）
3. **P1090 合并果子**（贪心策略，与移动操作类似）

---
处理用时：336.69秒
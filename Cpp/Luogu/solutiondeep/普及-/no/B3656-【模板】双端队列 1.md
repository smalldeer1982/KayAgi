# 题目信息

# 【模板】双端队列 1

## 题目背景

Aya 衷心祝愿大家不再因为 `std::deque()` 重蹈覆辙。

## 题目描述

请你实现 $m$ 个双端队列，支持如下的 $q$ 次操作：

- `push_back(a,x)`：在第 $a$ 个双端队列中从尾部插入一个元素 $x$；
- `pop_back(a)`：在第 $a$ 个双端队列中从尾部弹出一个元素。
- `push_front(a,x)`：在第 $a$ 个双端队列中从头部插入一个元素 $x$；
- `pop_front(a)`：在第 $a$ 个双端队列中从头部弹出一个元素。
- `size(a)`：查询第 $a$ 个双端队列的元素个数；
- `front(a)`：查询第 $a$ 个双端队列的队首元素；
- `back(a)`：查询第 $a$ 个双端队列的队尾元素；

对于 `pop_back`，`pop_front`，`front` 和 `back` 操作，若当前双端队列为空则不进行，直接跳过该次操作。

## 说明/提示

**【数据范围】**

| 子任务 | $m \leq$ | $q \leq$ | 分值 |
| :-----------: | :-----------: | :-----------: | :-----------: |
| $1$ | $10$ | $10$ | $10$ |
| $2$ | $2000$ | $2000$ | $20$ |
| $3$ | $10^5$ | $10^5$ | $30$ |
| $4$ | $10^6$ | $10^6$ | $40$ |

对于所有数据，$1 \leq m,q \leq 10^6$，$1 \leq x \leq 10^9$。

## 样例 #1

### 输入

```
10
pop_back 2
push_back 1 1
push_front 1 3
push_front 2 2
push_front 2 3
pop_back 1
size 1
push_back 2 3
back 1
front 1```

### 输出

```
1
3
3
```

# AI分析结果

### 算法分类
队列

### 综合分析与结论
本题要求实现多个双端队列，并支持多种操作。核心难点在于如何在保证时间效率的同时，减少内存占用。直接使用 `std::deque` 会导致内存超限，因此需要更高效的数据结构或优化策略。

### 所选题解
#### 题解作者：pulsar_ (赞：5)
- **星级**: 4.5
- **关键亮点**: 使用循环队列实现双端队列，动态扩容和缩容策略，时间复杂度均摊 O(1)，空间复杂度优化。
- **个人心得**: 通过动态调整数组大小，避免了固定大小数组的内存浪费，同时保证了操作的效率。

```cpp
struct Deque {
    int *data;
    int head, tail, size;
    Deque() : head(0), tail(0), size(1) {
        data = new int[size];
    }
    void push_back(int x) {
        if (tail == size) resize(size * 2);
        data[tail++] = x;
    }
    void pop_back() {
        if (tail > head) tail--;
        if (tail - head < size / 4) resize(size / 2);
    }
    void push_front(int x) {
        if (head == 0) resize(size * 2);
        data[--head] = x;
    }
    void pop_front() {
        if (head < tail) head++;
        if (tail - head < size / 4) resize(size / 2);
    }
    void resize(int new_size) {
        int *new_data = new int[new_size];
        for (int i = head; i < tail; i++) new_data[i - head] = data[i];
        delete[] data;
        data = new_data;
        tail -= head;
        head = 0;
        size = new_size;
    }
};
```

### 最优关键思路或技巧
- **循环队列**: 使用循环队列实现双端队列，通过动态扩容和缩容策略，保证时间复杂度和空间复杂度的平衡。
- **动态调整数组大小**: 根据元素数量动态调整数组大小，避免内存浪费。

### 可拓展之处
- **类似数据结构**: 可以扩展到其他需要动态调整大小的数据结构，如栈、队列等。
- **性能优化**: 在其他需要高效内存管理的场景中，可以采用类似的动态调整策略。

### 推荐题目
1. [P1886 滑动窗口](https://www.luogu.com.cn/problem/P1886)
2. [P1440 求m区间内的最小值](https://www.luogu.com.cn/problem/P1440)
3. [P1631 序列合并](https://www.luogu.com.cn/problem/P1631)

---
处理用时：21.15秒
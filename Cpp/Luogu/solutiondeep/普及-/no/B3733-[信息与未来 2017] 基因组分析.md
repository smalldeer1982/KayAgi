# 题目信息

# [信息与未来 2017] 基因组分析

## 题目描述

乌龟得到了他的基因组，一个只包含 $\tt{ATCG}$ 四种字母的字符串。乌龟想起科学家说，基因组中很多片段都多次重复出现，而且这种重复是很有意义的，于是他想计算一下自己基因组里片段的重复情况。

给定一个基因组，其中一个长度为 $k$ 的子串称为一个“$k$-片段”。乌龟希望你计算出基因组中不同的 $k$-片段数量。例如，基因组 $\tt{TACAC}$ 的 $2$-片段有 $\tt{TA,AC,CA,AC}$，其中不同的片段数量有 $3$ 个。

---

试题中使用的生成数列 $R$ 定义如下：整数 $0\leq R_1\lt 201701$ 在输入中给出。

对于 $i\gt 1,R_i=(R_{i−1}\times 6807+2831)\mod 201701$。

## 说明/提示

$30\%$ 的数据满足 $n\leq100$； 

$100\%$ 的数据满足 $1\leq n\leq 10^5,1\leq k\leq 10$。

>本题原始满分为 $20\text{pts}$。

## 样例 #1

### 输入

```
20 2 37```

### 输出

```
10```

# AI分析结果

### 算法分类
字符串

### 综合分析与结论
本题要求计算基因组中不同长度为 $k$ 的子串数量，属于字符串处理问题。由于 $k$ 的最大值为 10，且 $n$ 的最大值为 $10^5$，因此可以直接通过遍历所有可能的子串并使用哈希集合来统计不同子串的数量。

### 通用建议与扩展思路
1. **数据结构选择**：使用 `unordered_set` 来存储子串，利用其高效的插入和查找操作。
2. **优化思路**：由于 $k$ 较小，可以直接遍历所有可能的子串，无需复杂的优化。
3. **扩展思考**：如果 $k$ 较大，可以考虑使用滚动哈希或后缀数组等更高效的算法来处理。

### 推荐题目
1. [P3375 【模板】KMP字符串匹配](https://www.luogu.com.cn/problem/P3375)
2. [P3805 【模板】Manacher算法](https://www.luogu.com.cn/problem/P3805)
3. [P3369 【模板】普通平衡树](https://www.luogu.com.cn/problem/P3369)

### 关键代码实现
```cpp
#include <iostream>
#include <unordered_set>
#include <string>

using namespace std;

int main() {
    int n, k, R1;
    cin >> n >> k >> R1;
    string genome;
    for (int i = 0; i < n; ++i) {
        int R = (i == 0) ? R1 : (R1 * 6807 + 2831) % 201701;
        char c = "ATCG"[R % 4];
        genome += c;
        R1 = R;
    }
    unordered_set<string> fragments;
    for (int i = 0; i <= n - k; ++i) {
        string fragment = genome.substr(i, k);
        fragments.insert(fragment);
    }
    cout << fragments.size() << endl;
    return 0;
}
```

### 代码核心思想
1. **生成基因组**：根据给定的 $R1$ 和递推公式生成基因组字符串。
2. **统计不同子串**：遍历所有长度为 $k$ 的子串，使用 `unordered_set` 来统计不同子串的数量。
3. **输出结果**：输出不同子串的数量。

### 个人心得
- **调试经历**：在生成基因组时，确保递推公式正确应用，避免越界或错误计算。
- **踩坑教训**：注意 `substr` 的起始位置和长度，避免访问无效的内存区域。
- **顿悟感想**：对于小规模的 $k$，直接遍历是最简单且高效的方法，无需过度优化。

---
处理用时：19.09秒
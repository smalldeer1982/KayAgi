# 题目信息

# [NOIP 2009 普及组] 细胞分裂

## 题目描述

Hanks 博士是 BT（Bio-Tech，生物技术）领域的知名专家。现在，他正在为一个细胞实验做准备工作：培养细胞样本。

Hanks 博士手里现在有 $N$ 种细胞，编号从 $1 \sim N$，一个第 $i$ 种细胞经过 $1$ 秒钟可以分裂为 $S_i$ 个同种细胞（$S_i$ 为正整数）。现在他需要选取某种细胞的一个放进培养皿，让其自由分裂，进行培养。一段时间以后，再把培养皿中的所有细胞平均分入 $M$ 个试管，形成 $M$ 份样本，用于实验。Hanks 博士的试管数 $M$ 很大，普通的计算机的基本数据类型无法存储这样大的 $M$ 值，但万幸的是，$M$ 总可以表示为 $m_1$ 的 $m_2$ 次方，即 $M = m_1^{m_2}$，其中 $m_1,m_2$ 均为基本数据类型可以存储的正整数。

注意，整个实验过程中不允许分割单个细胞，比如某个时刻若培养皿中有 $4$ 个细胞，Hanks 博士可以把它们分入 $2$ 个试管，每试管内 $2$ 个，然后开始实验。但如果培养皿中有 $5$ 个细胞，博士就无法将它们均分入 $2$ 个试管。此时，博士就只能等待一段时间，让细胞们继续分裂，使得其个数可以均分，或是干脆改换另一种细胞培养。

为了能让实验尽早开始，Hanks 博士在选定一种细胞开始培养后，总是在得到的细胞“刚好可以平均分入 $M$ 个试管”时停止细胞培养并开始实验。现在博士希望知道，选择哪种细胞培养，可以使得实验的开始时间最早。


## 说明/提示

【输入输出样例 \#1 说明】

经过 $1$ 秒钟，细胞分裂成 $3$ 个，经过 $2$ 秒钟，细胞分裂成 $9$个，……，可以看出无论怎么分裂，细胞的个数都是奇数，因此永远不能分入 $2$ 个试管。

【输入输出样例 \#2 说明】

第 $1$ 种细胞最早在 $3$ 秒后才能均分入 $24$ 个试管，而第 $2$ 种最早在 $2$ 秒后就可以均分（每试管 $144 / {24}^1 = 6$ 个）。故实验最早可以在 $2$ 秒后开始。

【数据范围】

对于 $50 \%$ 的数据，有 $m_1^{m_2} \le 30000$。

对于所有的数据，有 $1 \le N \le 10000$，$1 \le m_1 \le 30000$，$1 \le m_2 \le 10000$，$1 \le S_i \le 2 \times {10}^9$。


NOIP 2009 普及组 第三题


## 样例 #1

### 输入

```
1 
2 1 
3
```

### 输出

```
-1
```

## 样例 #2

### 输入

```
2
24 1
30 12
```

### 输出

```
2
```

# AI分析结果

【算法分类】  
数学

【综合分析与结论】  
该题目核心是通过质因数分解来求解细胞分裂的最小时间，使得细胞数量能被均分到试管中。题解主要围绕质因数分解、最大公约数、整除条件等数学概念展开。多数题解通过分解质因数来比较细胞分裂后的质因数次数与试管要求的质因数次数，进而求解最小时间。难点在于如何高效处理质因数分解以及如何优化计算过程。

【所选高星题解】  
1. **题解作者：暗ざ之殇**  
   - **星级：5星**  
   - **关键亮点**：通过最大公约数（GCD）逐步化简问题，避免了直接计算大数幂次，思路清晰且优化程度高。  
   - **个人心得**：作者通过递归使用GCD，逐步将问题化简为求解最小时间，避免了复杂的质因数分解过程，代码简洁且高效。  
   - **核心代码**：
     ```cpp
     while(m != 1) {
         gcdd = gcd(m, s);
         if(gcdd == 1) { flag = 0; break; }
         m /= gcdd;
         q = s / gcdd;
         s = gcdd;
         t++;
     }
     ```
   - **关键实现**：通过不断求GCD，将问题化简为求解最小时间，最终通过公式计算得出结果。

2. **题解作者：刘心远**  
   - **星级：4星**  
   - **关键亮点**：通过质因数分解直接比较细胞和试管的质因数次数，思路直接且易于理解。  
   - **核心代码**：
     ```cpp
     for(int j = 1; j <= cnt; j++) {
         if(s[i] % prime[j] != 0) { flag = 0; break; }
         int cnt1 = 0;
         while(s[i] % prime[j] == 0) { cnt1++; s[i] /= prime[j]; }
         ans = max(ans, (p[j] * m2 + cnt1 - 1) / cnt1);
     }
     ```
   - **关键实现**：通过质因数分解和比较，直接计算最小时间，代码逻辑清晰。

3. **题解作者：Eason_lyx**  
   - **星级：4星**  
   - **关键亮点**：使用质因数分解和向上取整的方法，直接求解最小时间，代码简洁且高效。  
   - **核心代码**：
     ```cpp
     for(int i = 1; i <= cnt; i++) {
         if(s % p[i] != 0) { flag = 0; break; }
         int cnt1 = 0;
         while(s % p[i] == 0) { cnt1++; s /= p[i]; }
         ans = max(ans, (a[i] * m2 + cnt1 - 1) / cnt1);
     }
     ```
   - **关键实现**：通过质因数分解和向上取整，直接计算最小时间，代码逻辑清晰。

【最优关键思路或技巧】  
1. **最大公约数（GCD）递归化简**：通过不断求GCD，将问题化简为求解最小时间，避免了复杂的质因数分解过程。
2. **质因数分解与比较**：通过质因数分解直接比较细胞和试管的质因数次数，直接计算最小时间。
3. **向上取整优化**：使用向上取整的方法，确保计算结果的最小时间满足条件。

【可拓展之处】  
该题的核心思路可以拓展到其他需要处理大数质因数分解或整除条件的题目中，如求解最小公倍数、最大公约数等问题。

【推荐相似题目】  
1. [P1072 Hankson的趣味题](https://www.luogu.com.cn/problem/P1072)  
2. [P1068 乌龟棋](https://www.luogu.com.cn/problem/P1068)  
3. [P1075 质因数分解](https://www.luogu.com.cn/problem/P1075)

---
处理用时：32.28秒
# 题目信息

# [NOIP 2012 普及组] 寻宝

## 题目描述

传说很遥远的藏宝楼顶层藏着诱人的宝藏。小明历尽千辛万苦终于找到传说中的这个藏宝楼，藏宝楼的门口竖着一个木板，上面写有几个大字：寻宝说明书。说明书的内容如下：

藏宝楼共有 $N+1$ 层，最上面一层是顶层，顶层有一个房间里面藏着宝藏。除了顶层外，藏宝楼另有 $N$ 层，每层 $M$ 个房间，这 $M$ 个房间围成一圈并按逆时针方向依次编号为 $0,…,M-1$。其中一些房间有通往上一层的楼梯，每层楼的楼梯设计可能不同。每个房间里有一个指示牌，指示牌上有一个数字$x$，表示从这个房间开始按逆时针方向选择第 $x$ 个有楼梯的房间（假定该房间的编号为 $k$），从该房间上楼，上楼后到达上一层的 $k$ 号房间。比如当前房间的指示牌上写着 $2$，则按逆时针方向开始尝试，找到第 $2$ 个有楼梯的房间，从该房间上楼。如果当前房间本身就有楼梯通向上层，该房间作为第一个有楼梯的房间。

寻宝说明书的最后用红色大号字体写着：“寻宝须知：帮助你找到每层上楼房间的指示牌上的数字（即每层第一个进入的房间内指示牌上的数字）总和为打开宝箱的密钥”。

请帮助小明算出这个打开宝箱的密钥。


## 说明/提示

【数据范围】

对于 $50\%$ 数据，有$0<N≤1000,0<x≤10^4$；  
对于 $100\%$ 数据，有$0<N≤10000,0<M≤100,0<x≤10^6$。

NOIP 2012 普及组 第二题

## 样例 #1

### 输入

```
2 3
1 2
0 3
1 4
0 1
1 5
1 2
1
```

### 输出

```
5```

# AI分析结果

### 算法分类
模拟

### 综合分析与结论
本题的核心是通过模拟每层的寻宝过程，找到每层第一个进入的房间的指示牌数字总和。由于每层的房间数和指示牌数字可能较大，直接暴力模拟会导致超时，因此需要通过取模优化来减少计算量。各题解的主要思路是通过预处理每层的楼梯数，然后在模拟过程中利用取模操作来快速定位目标房间。优化后的时间复杂度为 O(N*M)，能够通过题目要求。

### 所选高星题解

#### 1. 作者：童年如作业 (赞：183)
- **星级**: 5星
- **关键亮点**: 通过预处理每层的楼梯数，利用取模优化减少模拟次数，代码清晰且优化到位。
- **个人心得**: 作者提到在取模时需要注意避免模数为0的情况，通过在模之前减1，模之后加1来解决这一问题。
- **核心代码**:
```cpp
for(j=x;;j++) {
    if(j==m) j=0;
    if(pd[i][j]==1) k++;
    if(k==(a[i][x]-1)%pd[i][m]+1) break;
}
```
**核心思想**: 通过取模优化，快速定位到第x个有楼梯的房间。

#### 2. 作者：说实话我很强 (赞：102)
- **星级**: 4星
- **关键亮点**: 通过取模优化减少模拟次数，代码简洁且易于理解。
- **核心代码**:
```cpp
int x=(num[i][lo])%a[i][0]+a[i][0];
while(x) {
    lo++;
    if(lo>m) lo=1;
    if(a[i][lo]) x--;
}
```
**核心思想**: 利用取模操作快速定位目标房间，减少循环次数。

#### 3. 作者：万弘 (赞：13)
- **星级**: 4星
- **关键亮点**: 使用`vector`动态数组存储每层有楼梯的房间，进一步优化了空间和时间复杂度。
- **核心代码**:
```cpp
for(dex=0;dex<a[i].size();++dex)
    if(a[i][dex]>=s)break;
s=a[i][(dex+tmp-1)%a[i].size()];
```
**核心思想**: 通过`vector`存储有楼梯的房间，利用取模快速定位目标房间。

### 最优关键思路或技巧
1. **取模优化**: 通过预处理每层的楼梯数，利用取模操作减少模拟次数，避免超时。
2. **数据结构选择**: 使用`vector`动态数组存储有楼梯的房间，优化空间和时间复杂度。
3. **边界处理**: 在取模时注意处理模数为0的情况，确保模拟过程的正确性。

### 可拓展之处
1. **同类型题**: 类似的模拟题可以通过预处理和取模优化来提高效率。
2. **算法套路**: 在处理周期性或循环问题时，取模优化是一个常用的技巧。

### 推荐题目
1. [P1076 寻宝](https://www.luogu.com.cn/problem/P1076)
2. [P1047 校门外的树](https://www.luogu.com.cn/problem/P1047)
3. [P1056 排座椅](https://www.luogu.com.cn/problem/P1056)

---
处理用时：25.67秒
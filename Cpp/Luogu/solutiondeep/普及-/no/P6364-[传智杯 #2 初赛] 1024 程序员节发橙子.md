# 题目信息

# [传智杯 #2 初赛] 1024 程序员节发橙子

## 题目描述

每年的 1024 程序员节日，黑马程序员都会举办大型的庆祝活动。今年的程序员节也不例外，每个班级的同学都发了橙子。

班级里有 $n$ 名同学从前到后排成一排，且已经得知了这些同学的成绩，其中第 $i$ 名同学的成绩是 $a_i$。班主任想根据同学们上个阶段的考试成绩来评定发橙子的数量。为了激励成绩优秀同学，发橙子时需要满足如下要求：

- 相邻同学中成绩好的同学的橙子必须更多。若相邻的同学成绩一样，则它们分到的数量必须平等。
- 每个同学至少分配一个橙子

由于预算有限，班主任希望在符合要求的情况下发出尽可能少的橙子。请问，至少需要准备多少橙子呢？

## 说明/提示

#### 样例 1 解释

每位同学拿到的橙子的数量分别是 $1,2,3,2,1$，所以至少需要准备 $9$ 个。

#### 数据规模与约定

对于全部的测试点，保证 $1 \leq n \leq 10^6$，$0 \leq a_i \leq 10^9$。

## 样例 #1

### 输入

```
5
3 4 5 4 3```

### 输出

```
9```

# AI分析结果

### 算法分类
贪心

### 综合分析与结论
题目要求根据相邻同学的成绩差异分配橙子，且每个同学至少分配一个橙子，目标是求最少需要的橙子数。核心思路是通过两次遍历（正序和逆序）来确保相邻同学的成绩差异反映在橙子分配上，且相同成绩的同学分配相同的橙子数。所有题解均采用了贪心算法，通过两次遍历来保证局部最优解，最终得到全局最优解。

### 所选高星题解

#### 题解1：游戏的人 (5星)
**关键亮点**：
- 清晰地将问题转化为正序和逆序的不降子序列问题，通过两次遍历确保相邻同学的成绩差异反映在橙子分配上。
- 提供了详细的样例解释和图示，帮助理解算法思路。
- 代码简洁且高效，适合大规模数据处理。

**核心代码**：
```cpp
for(int i=2;i<=n;i++) {
    if(a[i-1]<a[i]) t[i]=t[i-1]+1;
    if(a[i-1]==a[i]) t[i]=t[i-1];
}
for(int i=n;i>=2;i--) {
    if(a[i]<a[i-1]) t[i-1]=max(t[i-1],t[i]+1);
    if(a[i-1]==a[i]) t[i-1]=t[i];
}
```

#### 题解2：Creroity (4星)
**关键亮点**：
- 通过结构体存储成绩和橙子数，代码结构清晰。
- 强调了在第二次遍历时需要使用`max`函数来确保橙子数的正确性。
- 提供了详细的样例图示，帮助理解算法过程。

**核心代码**：
```cpp
for(int i=2;i<=n;i++) {
    if(a[i].t>a[i-1].t) a[i].s=a[i-1].s+1;
    else if(a[i].t==a[i-1].t) a[i].s=a[i-1].s;
    else a[i].s=1;
}
for(int i=n;i>=1;i--) {
    if(a[i].t>a[i+1].t) a[i].s=max(a[i].s,a[i+1].s+1);
    else if(a[i].t==a[i+1].t) a[i].s=max(a[i].s,a[i+1].s);
    ans+=a[i].s;
}
```

#### 题解3：_桀氓_ (4星)
**关键亮点**：
- 通过两次遍历（正序和逆序）来确保相邻同学的成绩差异反映在橙子分配上。
- 代码简洁且高效，适合大规模数据处理。
- 提供了详细的样例解释，帮助理解算法思路。

**核心代码**：
```cpp
for(int i=2;i<=n;i++) {
    if(a[i-1]<a[i]) orange[i]=orange[i-1]+1;
    if(a[i-1]==a[i]) orange[i]=orange[i-1];
}
for(int i=n;i>=2;i--) {
    if(a[i]<a[i-1]) orange[i-1]=max(orange[i-1],orange[i]+1);
    if(a[i-1]==a[i]) orange[i-1]=orange[i];
}
```

### 最优关键思路或技巧
- **两次遍历**：通过正序和逆序两次遍历，确保相邻同学的成绩差异反映在橙子分配上，且相同成绩的同学分配相同的橙子数。
- **贪心算法**：通过局部最优解（每次遍历时的橙子分配）来保证全局最优解（最少需要的橙子数）。

### 可拓展之处
- 类似问题可以扩展到其他资源分配问题，如根据员工的绩效分配奖金，或根据学生的成绩分配奖学金等。
- 类似的贪心算法可以应用于其他需要局部最优解的问题，如任务调度、背包问题等。

### 推荐题目
1. [P1090 合并果子](https://www.luogu.com.cn/problem/P1090)
2. [P1223 排队接水](https://www.luogu.com.cn/problem/P1223)
3. [P1803 凌乱的yyy / 线段覆盖](https://www.luogu.com.cn/problem/P1803)

### 个人心得摘录
- **游戏的人**：通过将问题转化为不降子序列问题，清晰地理解了算法的核心思路，并通过图示进一步加深了理解。
- **Creroity**：在第二次遍历时使用`max`函数，确保了橙子数的正确性，避免了覆盖问题。
- **_桀氓_**：通过两次遍历，确保了相邻同学的成绩差异反映在橙子分配上，且相同成绩的同学分配相同的橙子数。

---
处理用时：34.02秒
# 题目信息

# 「MCOI-06」Flight

## 题目描述

书虫需要移动他的[盾构机](https://www.luogu.com.cn/problem/P7569)。

书虫将 MC 空间抽象为二维平面。他的盾构机现在在 $(a,b)$，而书虫想把盾构机移动到 $(c,d)$。

书虫每一步可以将盾构机向东南西北任何方向行动。但是这盾构机有一个限制：相邻两步不能向同一个方向走！

给定 $(a,b)$ 和 $(c,d)$，请计算书虫最少需要几步将盾构机移动到终点。

求书虫的最少步数。可以证明，他永远可以到达终点。



## 说明/提示

#### 样例 1 解释

 - 对于第一组，最优策略为 $(-2,0)\rarr(-2,1)$。
 - 对于第二组，最优策略为 $(0,1)\rarr(1,1)\rarr(1,2)\rarr(2,2)\rarr(2,3)\rarr(3,3)$。
 - 对于第三组，最优策略之一为 $(-1,1)\rarr (0,1)\rarr(0,0)\rarr(1,0)\rarr(1,1)$。

#### 数据规模与约定

**本题采用捆绑测试。**

 - Subtask 1（29 pts）：$0\le a,b,c,d\le 3$。
 - Subtask 2（29 pts）：$a=c$。
 - Subtask 3（42 pts）：无特殊限制。

对于所有数据，$1\le T\le 10^5$，$|a|,|b|,|c|,|d|\le10^{18}$。

## 样例 #1

### 输入

```
3
-2 0 -2 1
0 1 3 3
-1 1 1 1```

### 输出

```
1
5
4```

# AI分析结果

### 算法分类
**数学**

### 综合分析与结论
本题的核心在于通过数学分析找到从起点到终点的最短步数，且相邻两步不能走同一方向。各题解均通过分析曼哈顿距离和方向限制，推导出最小步数的计算公式。主要思路包括：
1. **特殊情况分析**：当起点和终点在同一行或同一列时，步数的计算公式。
2. **一般情况分析**：通过将问题转化为从 $(0,0)$ 到 $(|a-c|, |b-d|)$ 的移动，利用贪心策略先走对角线，再处理剩余距离。
3. **奇偶性分析**：根据剩余距离的奇偶性，调整步数计算。

### 所选高星题解
#### 1. 作者：persimmon2008 (赞：20) - **4星**
- **关键亮点**：通过图形化分析，清晰地展示了不同情况下的步数计算，代码简洁且高效。
- **代码核心**：
  ```cpp
  int x=abs(a-c),y=abs(b-d);
  if(x>y)swap(x,y);
  int ans=0;
  ans+=x*2;
  if(abs(x-y)%2)ans+=abs(x-y)/2*4+1;
  else ans+=abs(x-y)*2;
  ```
- **核心思想**：先走对角线，再根据剩余距离的奇偶性调整步数。

#### 2. 作者：苏联小渣 (赞：5) - **4星**
- **关键亮点**：通过贪心策略，先走正方形，再处理剩余距离，公式推导清晰。
- **代码核心**：
  ```cpp
  int dx = abs(a-c), dy = abs(b-d);
  int mx = max(dx, dy), nx = min(dx, dy);
  printf("%lld\n", nx * 2 + (mx - nx) * 2 - (mx - nx) % 2);
  ```
- **核心思想**：先走 $min(\Delta x, \Delta y)$ 的正方形，再处理剩余距离，根据奇偶性调整步数。

#### 3. 作者：雨伞CKY (赞：3) - **4星**
- **关键亮点**：通过枚举和表格展示，详细推导了同一行或同一列时的步数计算公式，代码简洁。
- **代码核心**：
  ```cpp
  t1 = abs(a - c),t2 = abs(b - d);
  if (t1 > t2) swap(t1,t2);
  if ((t2 - t1) % 2 == 0) cout << 2 * t2 << endl;
  else cout << 2 * t2 - 1 << endl;
  ```
- **核心思想**：先移动到目标点所在行或列，再根据剩余距离的奇偶性调整步数。

### 最优关键思路
1. **贪心策略**：先走对角线，再处理剩余距离，可以有效减少步数。
2. **奇偶性分析**：根据剩余距离的奇偶性，调整步数计算，确保步数最小。
3. **公式推导**：通过数学推导，得出最小步数的通用公式，适用于所有情况。

### 可拓展之处
- **类似问题**：类似的方向限制问题，如机器人移动、棋盘上的骑士移动等，都可以通过类似的贪心策略和奇偶性分析来解决。
- **算法套路**：贪心策略结合数学分析，是解决此类问题的常用套路。

### 推荐题目
1. [P1002 过河卒](https://www.luogu.com.cn/problem/P1002)
2. [P1219 八皇后](https://www.luogu.com.cn/problem/P1219)
3. [P1443 马的遍历](https://www.luogu.com.cn/problem/P1443)

### 个人心得摘录
- **persimmon2008**：通过图形化分析，更容易理解步数计算的逻辑。
- **苏联小渣**：贪心策略的运用，使得问题简化，代码更加简洁。
- **雨伞CKY**：通过枚举和表格展示，详细推导了步数计算公式，使得思路更加清晰。

---
处理用时：28.43秒
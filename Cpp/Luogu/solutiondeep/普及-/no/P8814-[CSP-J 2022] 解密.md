# 题目信息

# [CSP-J 2022] 解密

## 题目描述

给定一个正整数 $k$，有 $k$ 次询问，每次给定三个正整数 $n_i, e_i, d_i$，求两个正整数 $p_i, q_i$，使 $n_i = p_i \times q_i$、$e_i \times d_i = (p_i - 1)(q_i - 1) + 1$。


## 说明/提示

**【样例 \#2】**

见附件中的 `decode/decode2.in` 与 `decode/decode2.ans`。

**【样例 \#3】**

见附件中的 `decode/decode3.in` 与 `decode/decode3.ans`。

**【样例 \#4】**

见附件中的 `decode/decode4.in` 与 `decode/decode4.ans`。

**【数据范围】**

以下记 $m = n - e \times d + 2$。

保证对于 $100\%$ 的数据，$1 \leq k \leq {10}^5$，对于任意的 $1 \leq i \leq k$，$1 \leq n_i \leq {10}^{18}$，$1 \leq e_i \times d_i \leq {10}^{18}$
，$1 \leq m \leq {10}^9$。

| 测试点编号 | $k \leq$ | $n \leq$ | $m \leq$ | 特殊性质 |
| :----------: | :----------: | :----------: | :----------: | :----------: |
| $1$ | $10^3$ | $10^3$ | $10^3$ | 保证有解 |
| $2$ | $10^3$ | $10^3$ | $10^3$ | 无 |
| $3$ | $10^3$ | $10^9$ | $6\times 10^4$ | 保证有解 |
| $4$ | $10^3$ | $10^9$ | $6\times 10^4$ | 无 |
| $5$ | $10^3$ | $10^9$ | $10^9$ | 保证有解 |
| $6$ | $10^3$ | $10^9$ | $10^9$ | 无 |
| $7$ | $10^5$ | $10^{18}$ | $10^9$ | 保证若有解则 $p=q$ |
| $8$ | $10^5$ | $10^{18}$ | $10^9$ | 保证有解 |
| $9$ | $10^5$ | $10^{18}$ | $10^9$ | 无 |
| $10$ | $10^5$ | $10^{18}$ | $10^9$ | 无 |


## 样例 #1

### 输入

```
10
770 77 5
633 1 211
545 1 499
683 3 227
858 3 257
723 37 13
572 26 11
867 17 17
829 3 263
528 4 109
```

### 输出

```
2 385
NO
NO
NO
11 78
3 241
2 286
NO
NO
6 88
```

# AI分析结果

### 算法分类
数学

### 综合分析与结论
本题的核心是通过给定的 $n_i, e_i, d_i$，求解满足 $n_i = p_i \times q_i$ 和 $e_i \times d_i = (p_i - 1)(q_i - 1) + 1$ 的两个正整数 $p_i$ 和 $q_i$。题解主要集中在通过数学推导或二分法来求解 $p_i$ 和 $q_i$。

### 所选高分题解

#### 1. 题解作者：SkyWave (赞：455)
- **星级**：5星
- **关键亮点**：
  - 通过数学推导，将问题转化为求解一元二次方程，思路清晰且高效。
  - 详细解释了如何通过 $p + q$ 和 $pq$ 来求解 $p$ 和 $q$，并给出了完整的代码实现。
  - 代码简洁且可读性强，处理了边界条件和特殊情况。
- **个人心得**：
  - 作者提到通过数据范围中的 $m = n - ed + 2$ 确认了自己的解法是正确的，体现了对题目理解的深度。

```cpp
long long PsubQ = sqrt((n - e * d + 2) * (n - e * d + 2) - (n * 4));
long long PaddQ = n - e * d + 2;
long long P = (PsubQ + PaddQ) / 2;
long long Q = PaddQ - P;
if (P * Q == n && e * d == (P - 1) * (Q - 1) + 1 && P && Q) {
    printf("%lld %lld\n",min(P, Q),max(P, Q));
} else {
    printf("NO\n");
}
```

#### 2. 题解作者：Forever1507 (赞：37)
- **星级**：4星
- **关键亮点**：
  - 通过构造一元二次方程来求解 $p$ 和 $q$，思路清晰。
  - 代码简洁，处理了判别式为负数或非完全平方的情况。
- **个人心得**：
  - 作者提到通过判别式来判断是否有解，体现了对数学问题的深刻理解。

```cpp
int m = n - d * e + 2;
int k = m * m - 4 * n;
int kk = sqrt(k);
if (kk * kk != k) {
    cout << "NO\n";
    continue;
}
if ((m + kk) % 2 == 1 || m <= kk) {
    cout << "NO\n";
    continue;
}
cout << (m - kk) / 2 << ' ' << (m + kk) / 2 << '\n';
```

#### 3. 题解作者：Double_Light (赞：27)
- **星级**：4星
- **关键亮点**：
  - 通过数学推导，将问题转化为求解一元二次方程，思路清晰。
  - 代码简洁，处理了判别式为负数的情况。
- **个人心得**：
  - 作者提到通过判别式来判断是否有解，体现了对数学问题的深刻理解。

```cpp
long long delta = (n - e * d + 2) * (n - e * d + 2) - 4 * n;
if (delta < 0) {
    printf("NO\n");
    continue;
}
long long p = 1.0 * ((n - e * d + 2) - sqrt(delta)) / 2, q = 1.0 * ((n - e * d + 2) + sqrt(delta)) / 2;
if (p > 0 && q > 0 && p * q == n && e * d == (p - 1) * (q - 1) + 1) {
    printf("%lld %lld\n", p, q);
} else {
    printf("NO\n");
}
```

### 最优关键思路或技巧
通过数学推导将问题转化为求解一元二次方程，利用判别式判断是否有解，并最终通过求根公式得到 $p$ 和 $q$。这种方法不仅高效，而且代码实现简洁。

### 可拓展之处
类似的问题可以通过构造方程或利用数学性质来解决，特别是在涉及整数分解或方程组求解的题目中。

### 推荐题目
1. [P1029 最大公约数和最小公倍数问题](https://www.luogu.com.cn/problem/P1029)
2. [P1075 质因数分解](https://www.luogu.com.cn/problem/P1075)
3. [P1061 一元二次方程](https://www.luogu.com.cn/problem/P1061)

### 个人心得总结
通过数据范围中的提示确认解法的正确性，体现了对题目理解的深度。在数学问题中，通过构造方程或利用判别式来判断是否有解，是一种常见且有效的解题思路。

---
处理用时：34.93秒
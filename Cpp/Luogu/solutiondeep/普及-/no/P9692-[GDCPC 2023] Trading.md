# 题目信息

# [GDCPC 2023] Trading

## 题目描述

二十年前，广州的北京路步行街北段出土了自唐代直到民国时期的十一层路面，南段则发掘出宋代至明清时期共五层的拱北楼建筑基址，佐证了北京路自宋代以来作为商业步行街的悠久历史；同时第一届广东省大学生程序设计竞赛也在位处广州的中山大学举办。二十年后的今天，北京路步行街已成为广州最负盛名的景点和购物胜地之一，而广东省大学生程序设计竞赛也迎来了自己的二十岁生日。

在步行街中，有 $n$ 间商店买卖同一种商品，第 $i$ 间商店一件商品的收购价和出售价均为 $a_i$ 元。为了防止过度交易，步行街有一个规定：您在第 $i$ 间商店最多进行 $b_i$ 次交易（一次买或一次卖均计为一次交易），且每次只能交易一件商品。

您准备通过在步行街中买卖这种商品来赚钱。假如初始时有无限的金钱（也就是说，不会因为钱不够而买不了一件商品），您最多能在步行街中赚到多少总利润？具体来说，``利润``指的是卖出商品获得的金钱总额，减去购买商品花费的金钱总额。

## 样例 #1

### 输入

```
2
4
10 2
30 7
20 4
50 1
2
1 100
1 1000```

### 输出

```
100
0```

# AI分析结果

### 算法分类
贪心

### 综合分析与结论
该题的核心逻辑是通过贪心策略最大化利润，即在价格最低的商店买入，在价格最高的商店卖出。所有题解都采用了双指针法来实现这一策略，通过排序和指针移动来模拟交易过程。题解的主要区别在于代码的实现细节和优化程度。

### 所选高分题解
1. **作者：DFbd (赞：4)**
   - **星级**: 4.5
   - **关键亮点**: 代码简洁，逻辑清晰，使用了双指针法，并且在交易次数处理上非常高效。
   - **代码核心思想**: 通过排序后使用双指针，分别指向价格最低和最高的商店，根据交易次数的最小值进行交易，并移动指针。
   ```cpp
   while (l < r) {
       while (a[l].c > 0 && l <= r) {
           if (a[l].c < a[r].c) {
               ans += a[l].c * a[r].b - a[l].c * a[l].b;
               a[r].c -= a[l].c;
               a[l].c = 0;
           } else {
               ans += a[r].c * a[r].b - a[r].c * a[l].b;
               a[l].c -= a[r].c;
               r--;
           }
       }
       l++;
   }
   ```

2. **作者：jiangjiangQwQ (赞：2)**
   - **星级**: 4
   - **关键亮点**: 通过优化避免了重复交易，代码结构清晰，逻辑严谨。
   - **代码核心思想**: 使用双指针法，并在交易后更新指针位置，避免无效交易。
   ```cpp
   for(int i=1;i<=n;i++){
       if(k[i].b==0) continue;
       for(int j=last;j>i;j--){
           if(k[i].b==0) break;
           int t=min(k[j].b,k[i].b);
           ans+=t*(k[j].a-k[i].a);
           k[j].b-=t;k[i].b-=t; 
           if(k[j].b==0) last--;
       }
   }
   ```

3. **作者：skyskyCCC (赞：1)**
   - **星级**: 4
   - **关键亮点**: 代码简洁，逻辑清晰，使用了双指针法，并且在交易次数处理上非常高效。
   - **代码核心思想**: 通过排序后使用双指针，分别指向价格最低和最高的商店，根据交易次数的最小值进行交易，并移动指针。
   ```cpp
   while(l < r){
       int Min = min(a[l].cnt,a[r].cnt);
       ans += (long long)(Min * (a[r].cost - a[l].cost));
       a[l].cnt -= Min;
       a[r].cnt -= Min;
       if(!a[l].cnt)
           l++;
       if(!a[r].cnt)
           r--;
   }
   ```

### 最优关键思路或技巧
- **双指针法**: 通过排序后使用双指针，分别指向价格最低和最高的商店，根据交易次数的最小值进行交易，并移动指针。
- **贪心策略**: 在价格最低的商店买入，在价格最高的商店卖出，以最大化利润。

### 可拓展之处
- **同类型题**: 类似的问题可以通过贪心策略和双指针法解决，如股票买卖问题、区间调度问题等。
- **类似算法套路**: 贪心算法常用于最优化问题，如背包问题、任务调度问题等。

### 推荐题目
1. [P1007 独木桥](https://www.luogu.com.cn/problem/P1007)
2. [P1090 合并果子](https://www.luogu.com.cn/problem/P1090)
3. [P1223 排队接水](https://www.luogu.com.cn/problem/P1223)

### 个人心得总结
- **调试经历**: 在处理交易次数时，需要注意指针的移动条件，避免重复交易或遗漏交易。
- **踩坑教训**: 在排序后，需要确保指针的移动逻辑正确，否则可能导致错误的结果。
- **顿悟感想**: 贪心策略在解决最优化问题时非常有效，但需要仔细考虑每一步的选择是否最优。

---
处理用时：29.64秒
# 题目信息

# [ROIR 2021] 分割数表 (Day 1)

## 题目背景

**译自 [ROIR 2021](http://neerc.ifmo.ru/school/archive/2020-2021.html) Day1 T2 [ Разбиение таблицы](http://neerc.ifmo.ru/school/archive/2020-2021/ru-olymp-regional-2021-day1.pdf)**。

## 题目描述

有一个 $n\times m$ 的数表 $a$，$a_{i,j}=(i-1)\times m+j$。

现在将这个数表分成两个数表 $x,y$，使得 $\max\{\sum x,\sum y\}$ 最小。

形象化地来说，您可以确定一个 $i$，然后在数表的第 $i-1$ 列与第 $i$ 列间竖切一刀，或者在第 $i-1$ 行与第 $i$ 行间横切一刀，所得到的两个数表分为 $x,y$。

请构造一组方案。

## 说明/提示

【数据范围】：

对于所有子任务，有 $1\le t\le 10^5$，$1\le n,m\le 10^9$，$2\le n\times m\le 10^9$。

| 子任务编号 |数据范围 | 分值 |
| :-: | :-: | :-: |
|$1$|$t=1$，$n,m\le 100$| $20$ |
|$2$|$t=1$，$n,m\le 2\times 10^3$| $14$ |
|$3$|$t=1$，$n,m\le 10^7$| $15$ |
|$4$| $t\le 10^3$，$n\times m\le10^4$ | $16$|
|$5$|$n=1$| $15$ |
|$6$|无特殊限制| $20$ |



## 样例 #1

### 输入

```
5
1 3
4 7
1 10
3 3
3 5```

### 输出

```
V 3
V 5
V 8
H 3
V 4```

# AI分析结果

### 算法分类
**数学**

### 综合分析与结论
该题的核心在于通过数学公式推导，找到最优的切割位置，使得分割后的两个数表之和的最大值最小。由于数据范围较大（$n, m \leq 10^9$），暴力枚举不可行，因此需要通过数学公式进行优化。大多数题解通过推导等差数列求和公式，结合二分或三分法来快速找到最优解。

### 所选题解
1. **题解作者：bianshiyang**
   - **星级：4.5**
   - **关键亮点**：通过详细的数学推导，给出了横切和竖切的公式，并使用二分法进行优化。代码清晰，注释详细，易于理解。
   - **个人心得**：作者强调了数学公式推导的重要性，并通过分类讨论确保了解的正确性。
   - **核心代码**：
     ```cpp
     double work() {
         double fa = (double)2;
         double fb = (double)2 * (m * n - m - 1);
         double fc = (double) -2 * m * n + m - m * m * n;
         double der = sqrt(fb * fb - 4 * fa * fc);
         double aa1 = (-fb + der) / (2 * fa);
         return aa1;
     }
     ```

2. **题解作者：xuchuhan**
   - **星级：4**
   - **关键亮点**：使用三分法进行优化，思路清晰，代码简洁。通过单谷函数的性质，快速找到最优解。
   - **核心代码**：
     ```cpp
     int Cal_L(int x) {
         int L1 = (n * m - m + 2) * n / 2;
         int ans = L1 * x + x * (x - 1) / 2 * n;
         return ans;
     }
     ```

3. **题解作者：WydnksqhbD**
   - **星级：4**
   - **关键亮点**：使用二分法进行优化，代码结构清晰，逻辑严谨。通过二分查找最小化$\max(\sum x, \sum y)$。
   - **核心代码**：
     ```cpp
     bool check1(int k) {
         return sum1(k) < sum - sum1(k);
     }
     ```

### 最优关键思路或技巧
1. **数学公式推导**：通过等差数列求和公式，快速计算分割后的数表之和，避免暴力枚举。
2. **二分/三分法**：利用单调性或单谷函数的性质，快速找到最优解，时间复杂度为$O(\log n)$或$O(\log m)$。
3. **分类讨论**：确保解的合法性，特别是在切割位置为整数或非整数时的处理。

### 可拓展之处
该题的思路可以拓展到其他需要快速求解分割问题的场景，如矩阵分割、数组分割等。类似的数学推导和优化方法可以应用于其他需要最小化或最大化某个值的题目。

### 推荐题目
1. [P3382 【模板】三分法](https://www.luogu.com.cn/problem/P3382)
2. [P1024 一元三次方程求解](https://www.luogu.com.cn/problem/P1024)
3. [P1045 等差数列](https://www.luogu.com.cn/problem/P1045)

---
处理用时：25.82秒
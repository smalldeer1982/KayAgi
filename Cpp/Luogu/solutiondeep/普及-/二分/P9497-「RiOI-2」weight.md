# 题目信息

# 「RiOI-2」weight

## 题目背景

在小树林间坐落着一个幻想的城堡。这里是 E 国的领地，而小 E，则是 E 国之王。

树木，是 E 国抵挡袭击的法宝。树木越高，越能蒙蔽敌人的视线。

可是，随着自然条件的退化，小 E 却不知怎么处理。怎么办呢？

## 题目描述

给定一个 $n$ 行 $n$ 列 的矩阵 $a$。

有 $q$ 组询问，每次给定一个 $v$，请将矩阵每一行任意重排（可以不重排），最大化**最大值不小于** $v$（也就是说，至少有一个不小于 $v$ 的数）的列数。请输出这个列数。

询问之间相互独立。换言之，每次询问前可以重新排列。


## 说明/提示

### 样例解释

原矩阵为 $\begin{bmatrix}9&9&8\\2&4&4\\3&5&3\end{bmatrix}$。

对于第一次询问，每一列的最大值 $9,9,8$ 均不小于 $v=5$，所以每一列都符合条件，答案为 $3$。显然无论怎么重排都不可能超过 $3$ 列（因为总共只有 $3$ 列），所以答案为 $3$。

### 数据规模与约定

**本题开启捆绑测试。**

| $\text{Subtask}$ | 分值 | $n \leq$ | $q \leq$ |
| :--------------: | :--: | :------: | :------: |
| $0$ | $10$ | $3$ | $10$ |
| $1$ | $40$ | $100$ | $10^3$ |
| $2$ | $50$ | $10^3$ | $5\times 10^5$ |

对于所有数据，$1 \leq n \leq 10^3$，$1 \leq q \leq 5\times 10^5$，$1 \leq a_{i,j}, v \leq 10^9$。

## 样例 #1

### 输入

```
3 3
9 9 8
2 4 4
3 5 3
5
9
10```

### 输出

```
3
2
0```

# AI分析结果



### 综合分析与结论
本题核心在于通过贪心策略将问题转化为统计矩阵中≥v的元素数量，并取min(数量, n)。最优解法是将所有元素排序后，利用二分查找快速处理每个查询。时间复杂度为O(n² log n + q log n²)，能够高效处理大规模数据。

---

### 精选题解与评分

#### 题解1：作者251Sec（★★★★★）
**关键亮点**  
- 清晰点明贪心策略的正确性，证明充分  
- 代码简洁高效，直接使用STL的`lower_bound`实现  
- 处理边界条件严谨，时间复杂度最优  

**核心代码**  
```cpp
sort(w + 1, w + n * n + 1);
// 对每个查询v：
min(n, (int)(n * n - (lower_bound(w+1, w+n*n+1, v) - w) + 1));
```

#### 题解2：作者Aegleseeker_（★★★★☆）
**关键亮点**  
- 用一维数组存储矩阵元素，思路直观  
- 正确使用`lower_bound`进行二分查找  
- 代码可读性较强，包含输入优化  

**核心代码**  
```cpp
sort(a, a + n * n);
int p = lower_bound(a, a + n*n, v) - a;
min(n, n*n - p);
```

#### 题解3：作者KidzzZip（★★★★☆）
**关键亮点**  
- 手动实现二分查找，展示底层逻辑  
- 明确说明答案与n的关系，逻辑清晰  
- 代码简洁，适合理解二分原理  

**核心代码**  
```cpp
int getnum(int x) {
    int l = 1, r = cnt, mid;
    while(l <= r) {
        mid = (l + r) / 2;
        if(a[mid] < x) l = mid + 1;
        else r = mid - 1;
    }
    return r; // 返回最后一个<v的位置
}
```

---

### 最优思路总结
1. **贪心策略**：答案取决于≥v的数的总数量，每个数可被分配到任意列，因此答案为`min(cnt_v, n)`。  
2. **高效实现**：将矩阵元素存入一维数组排序后，通过二分查找快速计算≥v的数的个数。  
3. **STL优化**：使用`lower_bound`直接定位分界点，简化代码逻辑。

---

### 拓展与举一反三
- **类似题型**：  
  1. [P1873 砍树](https://www.luogu.com.cn/problem/P1873)（二分答案）  
  2. [P2440 木材加工](https://www.luogu.com.cn/problem/P2440)（统计满足条件的最大长度）  
  3. [P2678 跳石头](https://www.luogu.com.cn/problem/P2678)（二分答案与贪心结合）

- **个人心得**  
  作者include13_fAKe提到排序方向选择对代码复杂度的影响，提醒注意数据预处理方向与后续操作的匹配性。调试时需验证贪心策略的边界情况，例如所有≥v的数集中在同一行时的正确性。

---
处理用时：77.13秒
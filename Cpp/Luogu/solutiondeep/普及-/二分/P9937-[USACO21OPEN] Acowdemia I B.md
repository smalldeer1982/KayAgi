# 题目信息

# [USACO21OPEN] Acowdemia I B

## 题目描述

由于对计算机科学的热爱，以及有朝一日成为 「Bessie 博士」的诱惑，奶牛 Bessie 开始攻读计算机科学博士学位。经过一段时间的学术研究，她已经发表了 $N$ 篇论文（$1 \le N \le 10^5$），并且她的第 $i$ 篇论文得到了来自其他研究文献的 $c_i$ 次引用（$0 \le c_i \le 10^5$）。

Bessie 听说学术成就可以用 $h$ 指数来衡量。$h$ 指数等于使得研究员有至少 $h$ 篇引用次数不少于 $h$ 的论文的最大整数 $h$。例如，如果一名研究员有 $4$ 篇论文，引用次数分别为 $(1,100,2,3)$，则 $h$ 指数为 $2$，然而若引用次数为 $(1,100,3,3)$ 则 $h$ 指数将会是 $3$。

为了提升她的 $h$ 指数，Bessie 计划写一篇综述，并引用一些她曾经写过的论文。由于页数限制，她至多可以在这篇综述中引用 $L$ 篇论文（$0 \le L \le 10^5$），并且她只能引用每篇她的论文至多一次。

请帮助 Bessie 求出在写完这篇综述后她可以达到的最大 $h$ 指数。

注意 Bessie 的导师可能会告知她纯粹为了提升 $h$ 指数而写综述存在违反学术道德的嫌疑；我们不建议其他学者模仿 Bessie 的行为。 

## 说明/提示

### 样例解释 1

Bessie 不能引用任何她曾经写过的论文。上文中提到，$(1,100,2,3)$ 的 $h$ 指数为 $2$。

### 样例解释 2

如果 Bessie 引用她的第三篇论文，引用数会变为 $(1,100,3,3)$。上文中提到，这一引用数的 $h$ 指数为 $3$。

### 测试点性质

- 测试点 $1-7$ 满足 $N\le 100$。
- 测试点 $8-10$ 满足 $N\le 1000$。
- 测试点 $11-17$ 满足 $N \le 10^5$。

## 样例 #1

### 输入

```
4 0
1 100 2 3```

### 输出

```
2```

## 样例 #2

### 输入

```
4 1
1 100 2 3```

### 输出

```
3```

# AI分析结果



### 综合分析与结论
本题核心在于通过排序与贪心策略或二分法高效求解最大h指数。关键思路包括：
1. **排序优化**：将论文按引用次数降序排列，便于快速计算初始h指数。
2. **二分答案**：确定h的可能范围后，通过判断函数验证每个h是否可达。
3. **贪心调整**：优先提升引用次数接近h-1的论文，以最小化L的消耗。

### 高分题解推荐

#### 题解1：we_are_the_chuibing（五星）
**关键亮点**：
- 采用二分法框架，思路清晰且高效。
- 判断函数通过统计现有满足条件的论文数与可提升的论文数，逻辑严谨。
- 时间复杂度为O(n log n)，适用于大范围数据。

**核心代码**：
```cpp
bool check(int h) {
    int cnt = 0, count_1 = 0, count_2 = 0;
    for (int i = 1; i <= N; i++) { 
        if (quote[i] >= h) count_1++;
        if (quote[i] == h - 1) count_2++;
    }
    if (count_1 >= h) return true;
    return (h - count_1 <= L && count_2 >= h - count_1);
}
```

#### 题解2：tder（四星）
**关键亮点**：
- 结合排序与贪心调整策略，分阶段提升论文引用。
- 优先处理关键位置论文，最大化h提升效率。
- 代码通过多次排序与调整覆盖所有可能情况。

**核心代码**：
```cpp
int f() {
    sort(c + 1, c + n + 1);
    int h = -1;
    for(int i = n; i >= 1; i--) 
        h = max(h, min(c[i], n - i + 1)); 
    return h;
}
```

### 最优思路提炼
1. **二分答案法**：二分可能的h值，每次验证是否可通过L次调整达到至少h篇引用≥h。验证时统计现有满足条件的论文数（count_1）和可提升至h的论文数（count_2），判断是否满足 `count_1 + min(count_2, L) ≥ h`。
2. **贪心排序优化**：初始降序排序后，每个位置i的h候选值为 `min(c[i], n-i+1)`，取最大值作为初始h。

### 相似题目推荐
1. P2678 [跳石头]（二分答案）
2. P1902 [刺杀大使]（二分+搜索）
3. P1558 [分治]（贪心与二分结合）

---
处理用时：142.57秒
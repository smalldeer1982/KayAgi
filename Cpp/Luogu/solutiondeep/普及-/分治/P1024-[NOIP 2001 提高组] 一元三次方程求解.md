# 题目信息

# [NOIP 2001 提高组] 一元三次方程求解

## 题目描述

有形如：$a x^3 + b x^2 + c x + d = 0$  这样的一个一元三次方程。给出该方程中各项的系数（$a,b,c,d$ 均为实数），并约定该方程存在三个不同实根（根的范围在 $-100$ 至 $100$ 之间），且根与根之差的绝对值 $\ge 1$。要求由小到大依次在同一行输出这三个实根(根与根之间留有空格)，并精确到小数点后 $2$ 位。

提示：记方程 $f(x) = 0$，若存在 $2$ 个数 $x_1$ 和 $x_2$，且 $x_1 < x_2$，$f(x_1) \times f(x_2) < 0$，则在 $(x_1, x_2)$ 之间一定有一个根。

## 说明/提示

**【题目来源】**

NOIP 2001 提高组第一题

## 样例 #1

### 输入

```
1 -5 -4 20
```

### 输出

```
-2.00 2.00 5.00
```

# AI分析结果



### 综合分析与结论
本题核心在于利用题目条件（根间隔≥1、范围确定）选择高效解法。主要思路可归为三类：  
1. **数学公式法**（如盛金公式）：直接套用公式求根，但涉及三角函数精度问题。  
2. **数值逼近法**（二分、牛顿迭代、割线法）：利用函数单调性逐步逼近根，需处理初始值与精度。  
3. **暴力枚举法**：利用题目条件枚举可能区间，通过端点函数值符号变化判断根存在性。  

最优解为**二分法**或**步长适中的暴力枚举**，二者均能稳定通过本题，代码简洁且符合题目数据特点。

---

### 高评分题解推荐

#### 1. 北街的九命貓（二分法） ★★★★☆  
**核心亮点**：  
- 利用根间隔≥1的特性，以1为步长分割区间，确保每个区间至多一解  
- 先检查左端点是否为根，避免重复输出  
- 二分精度控制到0.001，满足题目两位小数要求  

**关键代码**：
```cpp
for (i=-100;i<100;i++) { // 枚举每个长度为1的区间
    l=i; r=i+1;
    if(fc(l) == 0) printf("%.2lf ",l); // 直接检查左端点
    if(fc(l)*fc(r) < 0) { // 符号不同则二分
        while(r-l >= 0.001) {
            m = (l+r)/2;
            if(fc(m)*fc(r) <= 0) l=m; else r=m;
        }
        printf("%.2lf ",r);
    }
}
```

---

#### 2. 高木木（暴力枚举） ★★★★  
**核心亮点**：  
- 步长0.001暴力遍历[-100,100]，利用端点符号变化判断根位置  
- 取区间中点作为近似解，代码极简  
- 通过`num`计数提前终止循环优化效率  

**关键代码**：
```cpp
for(double i=-100.00; i<=100.00; i+=0.001) {
    double l=i, r=i+0.001;
    if((a*l*l*l + ... ) * (a*r*r*r + ... ) < 0) { // 符号变化判断
        printf("%.2f ",l); 
        if(++num ==3) break;
    }
}
```

---

#### 3. GGN_2015（牛顿迭代法） ★★★☆  
**核心亮点**：  
- 采用牛顿迭代公式快速收敛  
- 以0.5为步长选择初始值，避免漏根  
- 使用`set`去重，确保输出三个不同解  

**关键技巧**：
```cpp
void func3solve(func3 f, double st, double& val, double& sol) {
    for(int i=1; i<=100; i++) { // 最多迭代100次
        st = st - f(st)/f.dvt(st); // 牛顿迭代公式
        if(收敛) break;
    }
}
```

---

### 关键思路总结
1. **区间分割法**：利用题目条件将大范围分割为互不重叠的小区间（如长度1），显著降低计算量。  
2. **符号判断准则**：`f(x1)*f(x2)<0 → 区间有根`，适用于所有连续函数求根问题。  
3. **精度控制技巧**：二分法通过循环条件`r-l>=0.001`保证两位小数精度，暴力法通过步长0.001覆盖所有可能解。  

---

### 拓展训练推荐
1. [P1182 数列分段](https://www.luogu.com.cn/problem/P1182) - 二分答案经典题  
2. [P1025 数的划分](https://www.luogu.com.cn/problem/P1025) - 枚举与剪枝结合  
3. [P3382 三分法](https://www.luogu.com.cn/problem/P3382) - 单峰函数极值求解  

---

### 题解心得摘录
1. **暴力步长选择**：  
   - *"最后结果保留两位小数，所以i每次加0.001"* → 步长需小于精度要求的十分之一  
2. **去重处理**：  
   - *"solutions.find(sol)==solutions.end()"* → 牛顿迭代可能收敛到相同解，需用集合去重  
3. **公式法教训**：  
   - *"盛金公式要用到误差很大的sin和cos"* → 数学公式法需注意浮点数精度损失

---
处理用时：52.70秒
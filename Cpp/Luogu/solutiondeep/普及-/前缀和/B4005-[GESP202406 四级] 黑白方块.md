# 题目信息

# [GESP202406 四级] 黑白方块

## 题目描述

小杨有一个 $n$ 行 $m$ 列的网格图，其中每个格子要么是白色，要么是黑色。对于网格图中的一个子矩形，小杨认为它是平衡的当且仅当其中黑色格子与白色格子数量相同。小杨想知道最大的平衡子矩形包含了多少个格子。

## 说明/提示

**【样例解释】**

对于样例 $1$，假设 $(i,j)$ 代表第 $i$ 行第 $j$ 列，最大的平衡子矩形的四个顶点分别为 $(1,2),(1,5),(4,2),(4,5)$。

**【数据范围】**

对于全部数据，保证有 $1\leq n,m\leq 10$。

## 样例 #1

### 输入

```
4 5
00000
01111
00011
00011```

### 输出

```
16```

# AI分析结果



### 综合分析与结论
本题要求寻找最大的平衡子矩形（黑白格子数相等）。由于数据范围小（n,m≤10），暴力枚举所有子矩形并检查条件可行。但优化方向在于利用前缀和将时间复杂度从 O(n⁶) 降至 O(n⁴)，通过预处理减少重复计算。

---

### 所选题解分析

#### 题解作者：chen_zhe（4星）
**关键亮点**  
- 思路清晰，直接暴力枚举所有可能的子矩形，符合题目小数据范围的需求。  
- 提供了 `check` 函数示例，直观展示统计逻辑。  
- 提出优化思考点，引导读者思考前缀和优化方向。  

**个人心得**  
作者虽未明确提及调试细节，但代码正确处理了矩形面积计算 `(ii-i+1)*(jj-j+1)`，避免边界错误。

---

### 核心代码实现
**暴力枚举 + 检查函数**  
```cpp
int ans = 0;
for (int i = 1; i <= n; i++) {
    for (int j = 1; j <= m; j++) {
        for (int ii = i; ii <= n; ii++) {
            for (int jj = j; jj <= m; jj++) {
                if (check(i, j, ii, jj)) // 检查矩形是否平衡
                    ans = max(ans, (ii-i+1)*(jj-j+1));
            }
        }
    }
}
cout << ans;
```
**优化思路**  
使用二维前缀和预处理，将 `check` 函数优化为 O(1)：
```cpp
// 预处理前缀和
int pre0[MAX][MAX], pre1[MAX][MAX];
for (int i = 1; i <= n; i++) {
    for (int j = 1; j <= m; j++) {
        pre0[i][j] = pre0[i-1][j] + pre0[i][j-1] - pre0[i-1][j-1] + (w[i][j]==0);
        pre1[i][j] = pre1[i-1][j] + pre1[i][j-1] - pre1[i-1][j-1] + (w[i][j]==1);
    }
}

// 快速计算区域内的0和1数量
int cnt0 = pre0[xb][yb] - pre0[xa-1][yb] - pre0[xb][ya-1] + pre0[xa-1][ya-1];
int cnt1 = pre1[xb][yb] - pre1[xa-1][yb] - pre1[xb][ya-1] + pre1[xa-1][ya-1];
return cnt0 == cnt1;
```

---

### 拓展与举一反三
1. **类似题型**  
   - 求最大子矩阵和（P1719）：二维前缀和的应用。  
   - 求全1的最大子矩阵（P2004）：结合单调栈优化。  
   - 动态维护区间统计（P3406）：差分数组技巧。  

2. **推荐题目**  
   - [P1719 最大加权矩形](https://www.luogu.com.cn/problem/P1719)  
   - [P2004 领地选择](https://www.luogu.com.cn/problem/P2004)  
   - [P3406 海底高铁](https://www.luogu.com.cn/problem/P3406)  

---

**关键技巧总结**  
- **暴力枚举+剪枝**：小数据范围下直接枚举所有可能性。  
- **前缀和优化**：将区间统计复杂度降至 O(1)，适用于大规模数据。  
- **奇偶性剪枝**：平衡矩阵面积必为偶数，可提前排除奇数面积情况。

---
处理用时：55.77秒
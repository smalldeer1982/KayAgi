# 题目信息

# [NOIP 2000 普及组] 税收与补贴问题

## 题目背景

每样商品的价格越低，其销量就会相应增大。现已知某种商品的成本及其在若干价位上的销量（产品不会低于成本销售），并假设相邻价位间销量的变化是线性的且在价格高于给定的最高价位后，销量以某固定数值递减。（我们假设价格及销售量都是整数）

对于某些特殊商品，不可能完全由市场去调节其价格。这时候就需要政府以税收或补贴的方式来控制。（所谓税收或补贴就是对于每个产品收取或给予生产厂家固定金额的货币）


## 题目描述

你是某家咨询公司的项目经理，现在你已经知道政府对某种商品的预期价格，以及在各种价位上的销售情况。要求你确定政府对此商品是应收税还是补贴的最少金额（也为整数），才能使商家在这样一种政府预期的价格上，获取相对其他价位上的最大总利润。

- 总利润 $=$ 单位商品利润 $\times$ 销量
- 单位商品利润 $=$ 单位商品价格 $-$ 单位商品成本（减去税金 或者 加上补贴）


## 说明/提示

### 数据范围及约定

保证输入的所有数字均小于 $10^5$。

### 样例解释（2023/6/22 更新）

如下图所示是输入样例所对应的价格变化图，横轴表示销售价格，纵轴表示销量。

![](https://cdn.luogu.com.cn/upload/image_hosting/21mhtm5i.png)

根据题意，$28$ 元是商品的成本。销售价格不应该低于 $28$ 元；当销售价格大于给出的价格的最大值 $31$ 元后，按照售价每提高一元，销量降低 $15$ 计算，例如当售价为 $33$ 元时，销量为 $110-15\times (33-31)=80$。在给出来的价位之间，销量呈线性变化。

当政府给该商品补贴 $4$ 元后，企业将该商品定价为 $31$ 元时，取得的利润为 $31-28+4=7$ 元，销量为 $110$ 件，总利润为 $7\times 110=770$ 元，是企业在所有定价下能够取得的最大的总利润。此时企业的售价为政府的期望售价，因此是一个合法方案。

## 样例 #1

### 输入

```
31
28 130
30 120
31 110
-1  -1
15```

### 输出

```
4
```

# AI分析结果



### 综合分析与结论
本题核心在于处理价格-销量关系，并通过枚举或数学方法找到最优调控金额。关键难点包括线性插值处理、利润计算优化及解集的快速确定。以下精选题解在实现思路与优化技巧上各具亮点。

---

### 精选题解分析

#### 1. Mitch谜团（★★★★☆）
**核心思路**：暴力枚举 + 数据补全  
- 补全所有可能价格对应的销量（包括线性插值与后续递减）
- 遍历补贴与税收的可能值，暴力计算每个调控下的最大利润点
- **亮点**：思路直观，覆盖所有边界情况；代码虽长但逻辑清晰  
```cpp
// 数据补全部分
while(cin>>a[i][1]>>a[i][2]&&a[i][1]!=-1){
    // 线性插值填充中间价格
}
while(xl>0){ // 处理后续递减
    xl-=down; a[i][1]++; 
}
// 暴力枚举补贴/税收
for(j=1;j<=10000;j++){ 
    for(k=1;k<=i;k++){ // 计算每个价格利润
        num=(a[k][1]-a[1][1]+j)*a[k][2];
        if(num>=max) max=num, price=a[k][1];
    }
    if(price==expect) return j; // 找到解立即返回
}
```

#### 2. Ofnoname（★★★★★）
**核心思路**：不等式解集 + 数学优化  
- 推导相邻价格利润不等式，计算解区间交集
- 利用直线方程交点快速确定合法调控范围  
- **亮点**：复杂度O(n)，数学推导高效；代码简洁  
```cpp
// 计算每个价格对应不等式范围
for(int i=r; i<=p; i++){
    double ans = (d[x]*(x-r) - d[i]*(i-r)) * 1.0 / (d[i]-d[x]);
    if(g>0) Max=min(Max,ans); // 更新解区间
    else Min=max(Min,ans);
}
// 最终解判断
if(Min>0) printf("%d",(int)ceil(Min));
else if(Max<0) printf("%d",(int)floor(Max));
else puts("0");
```

#### 3. dodo（★★★★☆）
**核心思路**：单调性优化 + 分方向枚举  
- 初始无调控时确定最大利润方向，仅枚举补贴或税收
- 利用利润随调控单调变化的特性减少枚举次数  
- **亮点**：利用问题单调性降低复杂度；代码短小精悍  
```cpp
// 初始无调控确定方向
if(ans>ex) { // 需要补贴
    for(int x=1;;x++){ 
        if((i-pc+x)*num[i]>=maxn) // 更新最大值
    }
} else { // 需要税收
    for(int x=-1;;x--){ 
        if((i-pc+x)*num[i]>=maxn) 
    }
}
```

---

### 关键技巧总结
1. **数据补全**：线性插值与固定递减处理需注意边界条件
2. **数学建模**：将利润视为直线方程，通过交点快速确定解集
3. **单调性优化**：根据利润变化方向选择性枚举，减少无效计算
4. **暴力剪枝**：一旦找到解立即终止，避免全量枚举

---

### 推荐练习题目
1. [P1024 一元三次方程求解](https://www.luogu.com.cn/problem/P1024) - 数学解集与区间分析  
2. [P1083 借教室](https://www.luogu.com.cn/problem/P1083) - 差分数组+二分答案  
3. [P1090 合并果子](https://www.luogu.com.cn/problem/P1090) - 贪心策略与单调性优化

---
处理用时：52.50秒
# 题目信息

# 地毯

## 题目描述

在 $n\times n$ 的格子上有 $m$ 个地毯。

给出这些地毯的信息，问每个点被多少个地毯覆盖。

## 说明/提示

### 样例解释

覆盖第一个地毯后：

|$0$|$0$|$0$|$0$|$0$|
|:-:|:-:|:-:|:-:|:-:|
|$0$|$1$|$1$|$0$|$0$|
|$0$|$1$|$1$|$0$|$0$|
|$0$|$0$|$0$|$0$|$0$|
|$0$|$0$|$0$|$0$|$0$|

覆盖第一、二个地毯后：

|$0$|$0$|$0$|$0$|$0$|
|:-:|:-:|:-:|:-:|:-:|
|$0$|$1$|$1$|$0$|$0$|
|$0$|$1$|$2$|$1$|$1$|
|$0$|$0$|$1$|$1$|$1$|
|$0$|$0$|$1$|$1$|$1$|

覆盖所有地毯后：

|$0$|$1$|$1$|$1$|$0$|
|:-:|:-:|:-:|:-:|:-:|
|$0$|$1$|$1$|$0$|$0$|
|$0$|$1$|$2$|$1$|$1$|
|$0$|$0$|$1$|$1$|$1$|
|$0$|$0$|$1$|$1$|$1$|

---

### 数据范围

对于 $20\%$ 的数据，有 $n\le 50$，$m\le 100$。

对于 $100\%$ 的数据，有 $n,m\le 1000$。

## 样例 #1

### 输入

```
5 3
2 2 3 3
3 3 5 5
1 2 1 4```

### 输出

```
0 1 1 1 0
0 1 1 0 0
0 1 2 1 1
0 0 1 1 1
0 0 1 1 1```

# AI分析结果



### 综合分析
本题核心是二维区间修改与单点查询，最优解法为二维差分法（时间复杂度 O(m + n²)）。暴力解法虽能AC但效率低下，二维树状数组理论可行但复杂度略高。

---

### 精选题解（评分≥4星）

1. **老K的题解（5星）**
   **关键亮点**：使用二维差分实现O(1)修改，两次前缀和还原矩阵，代码简洁高效。
   **核心代码**：
   ```cpp
   // 差分标记
   ++a[x1][y1];
   --a[x2+1][y1];
   --a[x1][y2+1];
   ++a[x2+1][y2+1];
   // 前缀和计算
   a[i][j] += a[i-1][j] + a[i][j-1] - a[i-1][j-1];
   ```

2. **McGrady的题解（5星）**
   **关键亮点**：同二维差分思路，通过两次差分彻底降维，理论最优复杂度。
   **代码亮点**：清晰展示二维差分的分步操作（行差分→列差分）。

3. **阮行止的题解（4星）**
   **关键亮点**：用行级一维差分降维，时间复杂度 O(mn + n²)，适合理解差分基础。
   **个人心得**：指出NOIP不考二维数据结构，强调基础优化的重要性。

---

### 关键思路总结
**二维差分核心操作**：
1. 打标记：对矩形左上角 `+1`，右上角外 `-1`，左下角外 `-1`，右下角外 `+1`。
2. 二维前缀和：两次累加计算每个点的最终值。

---

### 举一反三
1. **一维差分扩展**：P3406 海底高铁（区间修改）
2. **二维前缀和应用**：P2038 无线网络发射器选址、P2280 激光炸弹
3. **复杂差分**：P4552 [Poetize6] IncDec Sequence（差分性质分析）

---

### 核心代码（二维差分）
```cpp
int main() {
    int n, m, x1, y1, x2, y2;
    scanf("%d%d", &n, &m);
    while (m--) {
        scanf("%d%d%d%d", &x1, &y1, &x2, &y2);
        // 二维差分标记
        a[x1][y1]++;
        a[x2+1][y1]--;
        a[x1][y2+1]--;
        a[x2+1][y2+1]++;
    }
    // 二维前缀和
    for (int i = 1; i <= n; ++i)
        for (int j = 1; j <= n; ++j)
            a[i][j] += a[i-1][j] + a[i][j-1] - a[i-1][j-1];
    // 输出结果...
}
```

---
处理用时：71.02秒
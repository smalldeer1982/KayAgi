# 题目信息

# [NOI Online #3 提高组] 水壶

## 题目描述

有 $n$ 个容量无穷大的水壶，它们从 $1\sim n$ 编号，初始时 $i$ 号水壶中装有 $A_i$ 单位的水。

你可以进行不超过 $k$ 次操作，每次操作需要选择一个满足 $1\le x\le n-1$ 的编号 $x$，然后把 $x$ 号水壶中的水全部倒入 $x+1$ 号水壶中。

最后你可以任意选择恰好一个水壶，并喝掉水壶中所有的水。现在请你求出，你最多能喝到多少单位的水。

## 说明/提示

#### 数据规模与约定

- 对于 $10\%$ 的数据，保证 $n \leq 10$。
- 对于 $30\%$ 的数据，保证 $n \leq 100$。
- 对于 $50\%$ 的数据，保证 $n \leq 10^3$。
- 对于 $70\%$ 的数据，保证 $n \leq 10^5$。
- 对于 $100\%$ 的数据，保证 $1\leq n\leq 10^6$，$0\leq k \leq n-1$，$0\le A_i\le 10^3$。

## 样例 #1

### 输入

```
10
5
890 965 256 419 296 987 45 676 976 742
```

### 输出

```
3813```

# AI分析结果



### 综合分析与结论
该题核心思路是将「k次倒水操作」转化为「k+1个连续水壶合并」，转化为求最大连续子段和。所有题解均正确识别此关键点，差异在于实现方式（前缀和或滑动窗口）及代码优化程度。最优解法时间复杂度O(n)，空间复杂度O(1)（滑动窗口）或O(n)（前缀和）。

### 高星题解推荐
#### 1. 作者：chen_zhe（5星）
**关键亮点**：  
- 滑动窗口实现，时间复杂度O(n)，空间复杂度O(1)，无需额外数组。  
- 代码简洁高效，直接维护当前窗口和，通过增减元素避免重复计算。  
- 正确处理数据范围，使用long long防止溢出。

**核心代码**：
```cpp
int main() {
    // 输入处理略
    int l=1, r=k+1;
    for (int i=l; i<=r; i++) sum += a[i];
    while (r <= n) {
        ans = max(ans, sum);
        sum -= a[l++]; // 滑动窗口左移
        sum += a[++r]; // 右移
    }
    cout << ans;
}
```

#### 2. 作者：FutaRimeWoawaSete（4星）
**关键亮点**：  
- 前缀和实现，代码简洁易懂，直接计算区间和。  
- 显式处理k+1长度区间，变量命名清晰。  
- 使用long long保证数据安全，适合新手理解。

**核心代码**：
```cpp
for (int i = 0; i <= n - m; i++)
    ans = max(ans, sum[i + m] - sum[i]);
```

#### 3. 作者：Wall_breaker（4星）
**关键亮点**：  
- 滑动窗口的另一种实现方式，初始化窗口后循环更新。  
- 代码逻辑清晰，适合理解窗口移动过程。  
- 处理边界条件严谨，确保不越界。

**核心代码**：
```cpp
int ans = 0, s = 0;
for (int i=1; i<=k; i++) s += a[i];
for (int i=k+1, j=0; i<=n; i++, j++) {
    s += a[i] - a[j];
    ans = max(ans, s);
}
```

### 关键思路与技巧
1. **问题转化**：将k次操作转化为连续k+1个水壶合并，转化为最大子段和问题。  
2. **滑动窗口**：维护当前窗口和，每次移动时仅需增减首尾元素，时间复杂度O(n)。  
3. **前缀和优化**：预处理前缀和数组，快速计算任意区间和，适合静态数据场景。  
4. **数据范围处理**：使用long long防止溢出，尤其当k接近n时总和可能极大。

### 拓展与举一反三
- **类似问题**：最大连续子数组（LeetCode 53）、固定长度窗口最大值（洛谷 P1886）。  
- **优化思维**：滑动窗口适用于连续区间动态维护，前缀和适用于离线区间查询。  
- **调试技巧**：验证边界条件（如k=0或k=n-1），手动计算小样例确认逻辑。

### 推荐练习题
1. **P1115** 最大子段和（一维连续区间求和）  
2. **P1886** 滑动窗口（固定长度区间最值）  
3. **P1714** 切蛋糕（环形数组最大子段和）  

### 题解心得摘录
- **chen_zhe**：强调贪心思想，每次倒水必须集中在连续区间，避免无效操作。  
- **Wall_breaker**：手动模拟操作过程，验证最优解必须为连续区间。  
- **修罗海神王**：提醒注意数据范围，避免因int溢出导致错误。

---
处理用时：79.22秒
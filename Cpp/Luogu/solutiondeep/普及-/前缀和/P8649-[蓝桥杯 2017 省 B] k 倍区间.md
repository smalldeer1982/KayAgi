# 题目信息

# [蓝桥杯 2017 省 B] k 倍区间

## 题目描述

给定一个长度为 $N$ 的数列，$A_1,A_2, \cdots A_N$，如果其中一段连续的子序列 $A_i,A_{i+1}, \cdots A_j(i \le j)$ 之和是 $K$ 的倍数，我们就称这个区间 $[i,j]$ 是 $K$ 倍区间。

你能求出数列中总共有多少个 $K$ 倍区间吗？

## 说明/提示

时限 2 秒, 256M。蓝桥杯 2017 年第八届

## 样例 #1

### 输入

```
5 2
1  
2  
3  
4  
5  ```

### 输出

```
6```

# AI分析结果



### 综合分析与结论

所有题解均基于以下核心思路：**前缀和 + 同余定理**。通过计算前缀和的模值，统计相同余数的出现次数，利用组合数公式 $C(n,2) = n(n-1)/2$ 快速计算合法区间数量。关键优化点在于余数桶的初始化与遍历顺序，以及正确处理模零情况。

#### 最优思路提炼：
1. **前缀和模k**：将前缀和数组转换为模k余数数组。
2. **余数桶统计**：用数组记录每个余数出现次数。
3. **组合数计算**：每个余数出现次数为 $cnt$，贡献为 $cnt \times (cnt-1)/2$。
4. **初始余数0处理**：桶数组初始值需包含 $sum_0=0$（即 `cnt[0] = 1`）。

---

### 精选题解及评分

#### 1. 题解作者：Steve_xh（★★★★★）
**关键亮点**：
- 实时累加答案，避免二次遍历桶数组。
- 正确处理前缀和从0开始的情况（`i=0`初始化）。
- 代码简洁高效，时间复杂度 $O(n)$。

**核心代码**：
```cpp
int n,k,s[100005],ans=0,b[100005];
signed main(){
    cin>>n>>k;
    for(int i=1,t;i<=n;i++) cin>>t, s[i]=s[i-1]+t;
    for(int i=0;i<=n;i++) ans += b[s[i]%k]++; // 实时统计
    cout<<ans;
}
```

#### 2. 题解作者：Vct14（★★★★☆）
**关键亮点**：
- 显式初始化 `c[0]=1`，明确处理余数0。
- 代码简洁，直接遍历桶数组计算组合数。

**核心代码**：
```cpp
int c[100002]={1}; // 初始化c[0]=1
signed main(){
    int sum=0;
    for(int i=1;i<=n;i++){
        sum=(sum+a)%k;
        c[sum]++;
    }
    for(int i=0;i<k;i++) sum += c[i]*(c[i]-1)/2;
}
```

#### 3. 题解作者：chenhaotian0219（★★★★☆）
**个人心得**：
- 强调前缀和 $S_0=0$ 必须纳入统计。
- 详细推导组合数公式的数学变换，解释初始化的必要性。

**核心代码**：
```cpp
book[0] = 1; // 初始化S0
for(int i=1;i<=n;i++){
    sum = (sum + a) % k;
    book[sum]++;
}
for(int i=0;i<k;i++) ans += book[i]*(book[i]-1)/2;
```

---

### 相似题目推荐
1. [P3406 海底高铁](https://www.luogu.com.cn/problem/P3406) - 差分与前缀和的综合应用。
2. [P3131 Subsequences Summing to Sevens](https://www.luogu.com.cn/problem/P3131) - 前缀和模7求最大区间。
3. [P3662 [USACO17FEB]Why Did the Cow Cross the Road II S](https://www.luogu.com.cn/problem/P3662) - 滑动窗口与前缀和结合。

---
处理用时：42.05秒
# 题目信息

# [蓝桥杯 2022 省 A] 求和

## 题目描述

给定 $n$ 个整数 $a_{1}, a_{2}, \cdots, a_{n}$, 求它们两两相乘再相加的和，即

$$
S=a_{1} \cdot a_{2}+a_{1} \cdot a_{3}+\cdots+a_{1} \cdot a_{n}+a_{2} \cdot a_{3}+\cdots+a_{n-2} \cdot a_{n-1}+a_{n-2} \cdot a_{n}+a_{n-1} \cdot a_{n}
$$


## 说明/提示

对于 $30 \%$ 的数据, $1 \leq n \leq 1000,1 \leq a_{i} \leq 100$ 。

对于所有评测用例, $1 \leq n \leq 2\times10^5,1 \leq a_{i} \leq 1000$ 。 

蓝桥杯 2022 省赛 A 组 C 题。

## 样例 #1

### 输入

```
4
1 3 6 9```

### 输出

```
117```

# AI分析结果



### 综合分析与结论
本题核心是求两两乘积和，暴力解法不可行（O(n²)）。所有题解均采用O(n)解法，主要分为两种思路：
1. **数学公式法**：利用平方和公式推导，只需计算总和与平方和
2. **动态累减法**：通过逐步减去当前元素实现等价前缀和效果
3. **前缀和/后缀和法**：显式维护前缀数组计算后续区间和

### 精选题解（评分≥4星）

#### 1. 作者：_NightFire666_（★★★★★）
**关键亮点**：  
- 数学推导巧妙，利用完全平方公式将复杂度降至O(n)
- 代码极简（仅需单次遍历），效率最优
- 数学思维降维打击，避免传统前缀和计算

**核心代码**：
```cpp
long long sum = 0, sqr_sum = 0;
for(int i=1; i<=n; i++){
    int x; cin >> x;
    sum += x;
    sqr_sum += x*x;
}
cout << (sum*sum - sqr_sum)/2;
```

#### 2. 作者：so_find_skind（★★★★★）
**关键亮点**：  
- 动态调整总和，无需前缀和数组
- 代码最简洁（仅需9行），空间效率最优
- 逆向思维：总和的逐步递减代替区间和计算

**核心代码**：
```cpp
long long sum = 0, ans = 0;
for(int i=1; i<=n; i++) sum += a[i];
for(int i=1; i<=n; i++){
    sum -= a[i];
    ans += sum * a[i];
}
```

#### 3. 作者：tZEROちゃん（★★★★☆）
**关键亮点**：  
- 使用后缀和数组，思路清晰
- 代码结构工整易拓展
- 逆向遍历思维，适合后续区间计算类问题

**核心代码**：
```cpp
long long cnt = 0, ans = 0;
for(int i=n; i>=1; i--){
    ans += a[i] * cnt;
    cnt += a[i];
}
```

### 关键思路总结
1. **数学变形**：当问题可分解为多项式组合时，尝试通过平方公式等数学工具降维
2. **动态累减**：通过维护当前可用总和，避免显式存储前缀数组
3. **后缀和优化**：逆向维护累积值，适用于需要后续区间和的场景

### 拓展建议
1. **同类问题**：求三元组乘积和时可尝试 (Σa_i)^3 展开式分解
2. **逆向思维**：当需要频繁查询末尾区间时，优先考虑后缀和
3. **数据类型**：大数乘积必用`long long`，可封装自动类型检测宏

### 推荐练习题
1. [P3131 Subsequences Summing to Sevens](https://www.luogu.com.cn/problem/P3131)（前缀和模运算）
2. [P3406 海底高铁](https://www.luogu.com.cn/problem/P3406)（差分与前缀和综合）
3. [P8783 统计子矩阵](https://www.luogu.com.cn/problem/P8783)（二维前缀和优化）

### 个人心得摘录
> "_Cppsteve：十年OI一场空，不开long long见祖宗"  
> ——强调大数运算必须考虑数据类型，是算法竞赛的经典教训

> "so_find_skind：水题。提取公因数，每次减去当前元素"  
> ——展示如何通过问题重构发现隐藏的简单规律

> "_NightFire666：由完全平方公式展开后为..."  
> ——体现数学工具在算法优化中的决定性作用

---
处理用时：67.91秒
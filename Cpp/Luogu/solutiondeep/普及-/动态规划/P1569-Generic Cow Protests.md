# 题目信息

# Generic Cow Protests

## 题目描述

约翰家的 $n$ 头奶牛聚集在一起，排成一列，正在进行一项抗议活动。第 $i$ 头奶牛的理智度为 $a_i$。  
约翰希望奶牛在抗议时保持理性，为此，他打算将所有的奶牛隔离成若干个小组，每个小组内的奶牛的理智度总和都要不小于零。  
由于奶牛是按直线排列的，所以一个小组内的奶牛位置必须是连续的。请帮助约翰计算一下，最多分成几组。


## 说明/提示

【数据规模和约定】   
对于 $30\%$ 的数据，$1\le n \le 20$；   
对于 $100\%$ 的数据，$1\le n \le 1000$，$|a_i| \le 10^5$。  


## 样例 #1

### 输入

```
4
2
3
-3
1
```

### 输出

```
3```

# AI分析结果



### 综合分析与结论
所有题解均基于动态规划（DP）与前缀和的核心思路。关键点在于：利用前缀和快速计算区间和，通过DP寻找满足条件的最多分组数。优化点集中在状态转移条件（区间和≥0）及初始化处理。尽管部分题解尝试线段树、分块等高级优化，但对本题数据规模（n≤1000）而言，O(n²)的朴素DP已足够高效。

---

### 精选题解及评分

#### 1. 作者：ShineEternal（★★★★★）
**关键亮点**：
- 代码简洁清晰，初始化时直接处理保底分组（若当前前缀和≥0则至少分1组）。
- 通过`f[j]>0`条件确保转移来源的有效性。
- 无解判断直接检查总前缀和是否≥0。

**核心代码**：
```cpp
int d[1001],f[1001];
// 初始化前缀和d[i]及保底分组f[i]
for(int i=1;i<=n;i++) {
    scanf("%d",&x);
    d[i]=d[i-1]+x;
    if(d[i]>=0) f[i]=1;
}
// DP转移
for(int i=1;i<=n;i++) {
    for(int j=1;j<i;j++) {
        if(f[j]>0 && d[i]-d[j]>=0)
            f[i]=max(f[i],f[j]+1);
    }
}
```

#### 2. 作者：Lips（★★★★☆）
**关键亮点**：
- 详细解释了状态转移逻辑，强调转移条件（区间和≥0且来源有效）。
- 使用`register`关键字优化循环变量，提升代码效率（对老编译器有效）。
- 直接通过总前缀和判断无解，逻辑清晰。

**核心代码**：
```cpp
for(int i=1;i<=n;i++) {
    if(sum[i]>=0) {
        for(int j=0;j<i;j++) {
            if(sum[i]-sum[j]>=0)
                dp[i]=max(dp[j]+1,dp[i]);
        }
    }
}
```

#### 3. 作者：durex_com（★★★★☆）
**关键亮点**：
- 代码极简，仅用双重循环完成DP，适合快速理解核心逻辑。
- 直接在前缀和初始化时处理保底分组。
- 注释明确，适合新手学习。

**核心代码**：
```cpp
for(int i=1;i<=n;i++) {
    sum[i]=sum[i-1]+x;
    if(sum[i]>=0) dp[i]=1;
}
for(int i=1;i<=n;i++) {
    for(int j=1;j<i;j++) {
        if(dp[j]>0 && sum[i]-sum[j]>=0)
            dp[i]=max(dp[i],dp[j]+1);
    }
}
```

---

### 关键思路与技巧总结
1. **前缀和优化**：快速计算区间和，避免重复计算。
2. **DP状态设计**：`dp[i]`表示前i头牛的最大分组数，转移时需满足`sum[i]-sum[j]>=0`。
3. **有效状态过滤**：仅当`sum[j]<=sum[i]`且`dp[j]>0`时进行转移。
4. **无解判断**：总前缀和必须≥0，否则无法分组。

---

### 拓展与同类题目
- **类似分组DP**：可结合单调队列优化或离散化处理更大规模数据。
- **前缀和性质**：适用于需要频繁计算区间和的问题，如子数组和、滑动窗口等。

---

### 推荐题目
1. **P1115 最大子段和**（前缀和与DP结合）
2. **P1631 序列合并**（分组思想与贪心）
3. **P2513 逆序对数列**（分组DP与计数结合）

---

### 题解中的个人心得摘录
- **ATZdhjeb**：通过初始化标记无效状态（`ans[i]=-1`）避免无效转移，强调分阶段处理合法起点。
- **asuldb**：尝试用线段树优化转移，体现对更高数据规模的预判，但复杂度提升对本题非必需。
- **pupuvovovovovo**：强调题目中“非负”条件的易错点，需仔细审题避免误解题意。

---
处理用时：48.66秒
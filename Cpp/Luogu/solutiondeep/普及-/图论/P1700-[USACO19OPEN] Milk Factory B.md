# 题目信息

# [USACO19OPEN] Milk Factory B

## 题目描述

牛奶生意正红红火火！Farmer John 的牛奶加工厂内有 $N$ 个加工站，编号为 $1\dots N$（$1\le N\le 100$），以及 $N−1$ 条通道，每条连接某两个加工站。（通道建设很昂贵，所以 Farmer John 选择使用了最小数量的通道，使得从每个加工站出发都可以到达所有其他加工站）。

为了创新和提升效率，Farmer John 在每条通道上安装了传送带。不幸的是，当他意识到传送带是单向的已经太晚了，现在每条通道只能沿着一个方向通行了！所以现在的情况不再是从每个加工站出发都能够到达其他加工站了。

然而，Farmer John 认为事情可能还不算完全失败，只要至少还存在一个加工站 $i$ 满足从其他每个加工站出发都可以到达加工站 $i$。注意从其他任意一个加工站 $j$ 前往加工站 $i$ 可能会经过 $i$ 和 $j$ 之间的一些中间站点。请帮助 Farmer John 求出是否存在这样的加工站 $i$。

## 样例 #1

### 输入

```
3
1 2
3 2```

### 输出

```
2```

# AI分析结果

### 综合分析与结论
这些题解的核心都是在有向图中找出所有点都能到达的编号最小的点，若不存在则输出 -1。由于数据范围较小（$1\leq N\leq100$），多数题解采用暴力搜索的方法。各题解的主要区别在于图的存储方式和搜索策略不同，如邻接表、邻接矩阵，以及 DFS、BFS 等。

### 所选题解
- **作者：HasNoName (赞：11)，4星**
  - **关键亮点**：思路清晰，代码结构规范，使用邻接表存储图，通过 DFS 遍历统计每个点能被走到的数量。
  - **核心代码**：
```cpp
void dfs(int x) {
    vis[x]=1;
    for(int i=he[x];i;i=e[i].ne) {
        int y=e[i].to;
        if(!vis[y]) {
            w[y]++;
            dfs(y);
        }
    }
}
```
  - **核心实现思想**：从每个点开始 DFS，标记已访问的点，对未访问的邻接点，其能被走到的数量加 1，并继续 DFS。

- **作者：yhx0322 (赞：6)，4星**
  - **关键亮点**：提出反向建图的技巧，能有效提高搜索效率，代码简洁易懂。
  - **核心代码**：
```cpp
void dfs(int x) {
    for (int i = pre[x]; i; i = a[i].next) {
        int to = a[i].to;
        if (!f[to]) {
            f[to] = true;
            dfs(to);
        }
    }
}
```
  - **核心实现思想**：反向建图后，从每个点开始 DFS，标记能到达的点，若所有点都能被标记，则该点满足条件。

- **作者：gey666 (赞：3)，4星**
  - **关键亮点**：使用 Floyd 算法处理图的连通性问题，思路独特，代码逻辑清晰。
  - **核心代码**：
```cpp
for (int k=1;k<=n;k++) {
    for (int i=1;i<=n;i++) {
        for (int j=1;j<=n;j++) {
            if (d[i][k]!=0x3f3f3f3f&&d[k][j]!=0x3f3f3f3f) {
                d[i][j]=1;
            }
        }
    }
}
```
  - **核心实现思想**：枚举中转点 $k$，若 $i$ 到 $k$ 和 $k$ 到 $j$ 都有路，则 $i$ 到 $j$ 也有路。

### 最优关键思路或技巧
- **反向建图**：如 yhx0322 的题解，将“哪些点能走到 $x$ 点”转化为“反向建图后，$x$ 点能走到哪些点”，可提高搜索效率。
- **Floyd 算法**：gey666 的题解使用 Floyd 算法处理图的连通性，通过枚举中转点更新两点间的连通情况。

### 可拓展之处
同类型题可考察有向图中其他节点可达性问题，如求所有点都能到达的点的数量、求某个点能到达的最远点等。类似算法套路可应用于拓扑排序、强连通分量等图论问题。

### 推荐题目
- [P1330 封锁阳光大学](https://www.luogu.com.cn/problem/P1330)
- [P2853 [USACO06DEC] Cow Picnic S](https://www.luogu.com.cn/problem/P2853)
- [P1113 杂务](https://www.luogu.com.cn/problem/P1113)

### 个人心得
- **gey666**：“蒟蒻的第一篇题解，纪念一下，思路若有误请喷轻点”，表达了新手写题解的心情，提醒自己思路可能存在不足，希望得到理解。 

---
处理用时：24.63秒
# 题目信息

# 计算分数

## 题目描述

Csh 被老妈关在家里做分数计算题，但显然他不愿意做这么多复杂的计算。况且在家门口还有 Xxq 在等着他去一起看电影。为了尽快地能去陪 Xxq 看电影，他把剩下的计算题交给了你，你能帮他解决问题吗？


## 说明/提示

### 数据范围及约定

对于所有测试点，输入计算式长度在 $100$ 以内，分子、分母在 $1000$ 以内。同时保证，直接从前往后直接计算分数的和或者差，然后立刻化简，这么做的中间结果不会超过 int 的范围。

注意输入的分数不一定是最简分数。


------------
2024/2/13 添加 2 组 hack 数据。

## 样例 #1

### 输入

```
2/1+1/3-1/4```

### 输出

```
25/12```

# AI分析结果

### 综合分析与结论

本题的核心是分数的加减运算，涉及通分、约分、符号处理等细节。各题解的主要思路相似，均通过结构体或变量存储分子和分母，使用 `__gcd` 函数进行约分，并通过通分实现分数的加减运算。不同题解在处理输入、符号、约分时机等方面有所差异，部分题解还考虑了特殊情况（如分母为1或分子为0）。

整体来看，题解的质量参差不齐，部分题解代码冗长且不够简洁，部分题解则较为精炼且考虑了更多细节。以下是评分较高的题解及其亮点。

### 所选高分题解

#### 1. **作者：ggylz49 (赞：203)**  
**评分：4.5星**  
**关键亮点：**
- 使用结构体 `fs` 存储分数，代码结构清晰。
- 通过 `yf` 函数实现约分，`jia` 和 `jian` 函数分别处理加法和减法，逻辑清晰。
- 在输入时立即约分，避免后续计算中的错误。
- 处理了分母为负数的情况，确保输出格式正确。

**核心代码：**
```cpp
fs yf(fs a) {
    long long m = __gcd(a.fm, a.fz);
    a.fm /= m;
    a.fz /= m;
    return a;
}

fs jia(fs x, fs y) {
    long long z = x.fm * y.fm;
    x.fz *= y.fm;
    y.fz *= x.fm;
    x.fm = z;
    y.fm = z;
    fs answer;
    answer.fz = x.fz + y.fz;
    answer.fm = x.fm;
    return yf(answer);
}
```

**个人心得：**
- 作者强调了约分的重要性，并指出在输入时立即约分可以避免后续问题。
- 通过结构体和函数封装，代码可读性和可维护性较高。

#### 2. **作者：int_stl (赞：33)**  
**评分：4星**  
**关键亮点：**
- 使用 `lcm` 函数进行通分，代码简洁。
- 在计算过程中实时约分，避免溢出。
- 处理了分母为1或分子为0的特殊情况，输出格式规范。

**核心代码：**
```cpp
int lcm(int a, int b) {
    return a / __gcd(a, b) * b;
}

void tongfen() {
    int t = lcm(ansfm, fm);
    int anssum = t / ansfm;
    int sum = t / fm;
    ansfz *= anssum;
    ansfm *= anssum;
    fz *= sum;
    fm *= sum;
}
```

**个人心得：**
- 作者强调了实时约分的重要性，避免中间结果溢出。
- 通过 `lcm` 函数简化了通分过程，代码逻辑清晰。

#### 3. **作者：LG086 (赞：6)**  
**评分：4星**  
**关键亮点：**
- 代码简洁，直接通过 `__gcd` 函数进行约分。
- 处理了分母为负数的情况，确保输出格式正确。
- 在计算过程中实时约分，避免溢出。

**核心代码：**
```cpp
while (cin >> ch1 >> x >> ch2 >> y) {
    if (ch1 == '-') x = -x;
    ans_a = x * ans_b + y * ans_a, ans_b *= y;
    gcd = __gcd(ans_a, ans_b), ans_a /= gcd, ans_b /= gcd;
}
```

**个人心得：**
- 作者强调了实时约分的重要性，避免中间结果溢出。
- 通过简单的条件判断处理了符号问题，代码简洁高效。

### 最优关键思路与技巧

1. **实时约分**：在每次加减运算后立即约分，避免中间结果溢出。
2. **通分处理**：使用 `lcm` 函数进行通分，确保分母一致后再进行加减运算。
3. **符号处理**：通过条件判断处理分子和分母的符号，确保输出格式正确。
4. **结构体封装**：使用结构体存储分子和分母，提高代码的可读性和可维护性。

### 可拓展之处

- **类似题目**：可以拓展到更复杂的分数运算，如乘法、除法，甚至混合运算。
- **算法套路**：类似的通分、约分思路可以应用于其他需要处理分数的题目，如分数化简、分数比较等。

### 推荐题目

1. **P1573 分数化简**：考察分数的化简与输出格式。
2. **P1574 分数比较**：考察分数的大小比较与化简。
3. **P1575 分数四则运算**：考察分数的加减乘除混合运算。

### 个人心得总结

- **约分时机**：约分应尽早进行，避免中间结果溢出或计算错误。
- **符号处理**：符号处理是分数运算中的关键细节，需特别注意。
- **代码封装**：通过函数和结构体封装，可以提高代码的可读性和可维护性。

---
处理用时：41.65秒
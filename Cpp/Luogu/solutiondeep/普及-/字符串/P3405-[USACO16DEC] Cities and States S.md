# 题目信息

# [USACO16DEC] Cities and States S

## 题目描述

Farmer John 有若干头奶牛。为了训练奶牛们的智力，Farmer John 在谷仓的墙上放了一张美国地图。地图上表明了每个城市及其所在州的代码（前两位大写字母）。

由于奶牛在谷仓里花了很多时间看这张地图，他们开始注意到一些奇怪的关系。例如，FLINT 的前两个字母就是 MIAMI 所在的 `FL` 州，MIAMI 的前两个字母则是 FLINT 所在的 `MI` 州。  
确切地说，对于两个城市，它们的前两个字母互为对方所在州的名称。

我们称两个城市是一个一对「特殊」的城市，如果他们具有上面的特性，并且来自不同的州。对于总共 $N$ 座城市，奶牛想知道有多少对「特殊」的城市存在。请帮助他们解决这个有趣的地理难题！  

## 说明/提示

### 数据规模与约定

对于 $100\%$ 的数据，$1 \leq N \leq 2 \times 10 ^ 5$，城市名称长度不超过 $10$。

## 样例 #1

### 输入

```
6
MIAMI FL
DALLAS TX
FLINT MI
CLEMSON SC
BOSTON MA
ORLANDO FL```

### 输出

```
1```

# AI分析结果

### 综合分析与结论

本题的核心在于如何高效地统计满足条件的城市对。各题解主要围绕以下几点展开：
1. **字符串处理**：大部分题解都通过提取城市名的前两个字母和州名的两个字母，并将其转换为数字或哈希值进行处理。
2. **数据结构选择**：主要使用了`map`或二维数组来存储和查询符合条件的城市对。
3. **优化策略**：通过提前判断城市名和州名是否相同，避免无效计算，提升效率。

### 所选高星题解

#### 1. 作者：NKU_AI_HMX (5星)
- **关键亮点**：使用二维数组存储城市和州的组合，通过26进制转换将字母映射为数字，避免了`map`的开销，代码简洁高效。
- **核心实现思想**：
  ```cpp
  int city[676][676], n, x, y, ans;
  for(int i=0;i<n;i++) {
      cin>>a>>b;
      x = (a[0] - 'A') * 26 + a[1] - 'A';
      y = (b[0] - 'A') * 26 + b[1] - 'A';
      if (x != y) {
          city[x][y]++;
          ans += city[y][x];
      }
  }
  ```
- **个人心得**：作者强调了`map`的优势，但通过数组实现了更高效的存储和查询。

#### 2. 作者：DrownedFish (5星)
- **关键亮点**：使用`substr`简化字符串处理，通过`map`存储城市和州的组合，代码清晰易读。
- **核心实现思想**：
  ```cpp
  map<string,int> box;
  for(int i=0;i<n;i++) {
      cin>>a>>b;
      a = a.substr(0,2);
      if(a != b) {
          ans += box[a+b];
          box[b+a]++;
      }
  }
  ```
- **个人心得**：作者通过编故事的方式解释了算法的逻辑，使得思路更加生动易懂。

#### 3. 作者：LightningUZ (4星)
- **关键亮点**：使用哈希法将城市和州的组合转换为数字，通过数组存储和查询，避免了`map`的开销，时间复杂度低。
- **核心实现思想**：
  ```cpp
  int cnt[N], ans = 0;
  for(int i=1;i<=n;i++) {
      if (a[i] == b[i]) continue;
      ans += cnt[b[i]*676 + a[i]];
      cnt[a[i]*676 + b[i]]++;
  }
  ```
- **个人心得**：作者详细分析了算法的复杂度，并强调了处理特殊情况的重要性。

### 最优关键思路与技巧
1. **字符串转数字**：将城市名和州名的前两个字母转换为26进制数，简化存储和查询。
2. **提前判断**：在处理前先判断城市名和州名是否相同，避免无效计算。
3. **数据结构选择**：根据数据规模选择合适的数据结构，如`map`或二维数组，以平衡时间和空间复杂度。

### 可拓展之处
- **类似题目**：可以扩展到其他需要处理字符串前缀或后缀的题目，如统计特定模式的字符串对。
- **算法套路**：哈希法在处理字符串匹配和统计问题时非常有效，可以推广到其他需要快速查找和统计的场景。

### 推荐题目
1. [P3370 【模板】字符串哈希](https://www.luogu.com.cn/problem/P3370)
2. [P3805 【模板】Manacher算法](https://www.luogu.com.cn/problem/P3805)
3. [P3375 【模板】KMP字符串匹配](https://www.luogu.com.cn/problem/P3375)

### 个人心得总结
- **调试经历**：多位作者提到在处理特殊情况时容易出错，如城市名和州名相同的情况，强调了提前判断的重要性。
- **顿悟感想**：通过将字符串转换为数字，可以大大简化存储和查询的逻辑，提升算法效率。

---
处理用时：33.51秒
# 题目信息

# [蓝桥杯 2022 省 A] 求和

## 题目描述

给定 $n$ 个整数 $a_{1}, a_{2}, \cdots, a_{n}$, 求它们两两相乘再相加的和，即

$$
S=a_{1} \cdot a_{2}+a_{1} \cdot a_{3}+\cdots+a_{1} \cdot a_{n}+a_{2} \cdot a_{3}+\cdots+a_{n-2} \cdot a_{n-1}+a_{n-2} \cdot a_{n}+a_{n-1} \cdot a_{n}
$$


## 说明/提示

对于 $30 \%$ 的数据, $1 \leq n \leq 1000,1 \leq a_{i} \leq 100$ 。

对于所有评测用例, $1 \leq n \leq 2\times10^5,1 \leq a_{i} \leq 1000$ 。 

蓝桥杯 2022 省赛 A 组 C 题。

## 样例 #1

### 输入

```
4
1 3 6 9```

### 输出

```
117```

# AI分析结果



### 综合分析与结论
本题需要计算所有两两组合的乘积和，核心难点在于将 $O(n^2)$ 暴力解法优化为 $O(n)$。各题解主要围绕两种思路展开：  
1. **数学公式法**：利用完全平方公式 $(Σa_i)^2 = Σa_i^2 + 2S$，直接计算 $S=(总和的平方 - 平方和)/2$。  
2. **前缀和/动态求和法**：将式子拆解为 $Σa_i \cdot (后续元素和)$，通过前缀和或动态维护总和优化计算。

---

### 高评分题解选录（≥4星）

#### 1. 作者：_NightFire666_（5星）
**关键亮点**：  
- 使用数学公式将问题转化为 $O(1)$ 计算，时间复杂度最优。  
- 代码极其简洁（仅需一次遍历），且避免存储数组，空间效率极高。  
**代码核心**：  
```cpp
long long sum = 0, mul = 0;
for (int i=1; i<=n; i++) {
    sum += x * x;     // 平方和
    mul += x;         // 总和
}
cout << (mul * mul - sum) / 2;
```

#### 2. 作者：so_find_skind（5星）  
**关键亮点**：  
- 动态维护后续元素和，无需前缀数组，空间优化到 $O(1)$。  
- 单次遍历完成计算，逻辑清晰且高效。  
**代码核心**：  
```cpp
long long sum = 0, ans = 0;
for (int i=1; i<=n; i++) sum += a[i];
for (int i=1; i<=n; i++) {
    sum -= a[i];         // 减去当前元素，得到后续和
    ans += sum * a[i];   // 累加当前元素与后续和的乘积
}
```

#### 3. 作者：二叉苹果树（4星）  
**关键亮点**：  
- 前缀和标准解法，逻辑直观易于理解，适合初学者。  
- 明确展示公式变形过程，推导清晰。  
**代码核心**：  
```cpp
long long sum[MAXN], ans = 0;
for (int i=1; i<=n; i++) sum[i] = sum[i-1] + a[i];
for (int i=1; i<n; i++) {
    ans += a[i] * (sum[n] - sum[i]);  // 利用前缀和快速计算后续和
}
```

---

### 最优关键思路总结
1. **数学公式转换**：通过平方差公式将两两乘积和转化为总和与平方和的线性组合，实现 $O(n)$ 时间计算。  
2. **动态维护后续和**：在遍历时实时更新剩余元素和，避免存储额外数组，空间复杂度优化到 $O(1)$。  
3. **前缀和标准解法**：适合快速计算区间和，代码结构清晰，易于扩展至类似问题。

---

### 拓展与举一反三
**相似题型推荐**：  
1. [P3131 Subsequences Summing to Sevens](https://www.luogu.com.cn/problem/P3131)（前缀和模运算）  
2. [P3406 海底高铁](https://www.luogu.com.cn/problem/P3406)（差分与前缀和综合应用）  
3. [P2398 GCD SUM](https://www.luogu.com.cn/problem/P2398)（数学公式转化与数论结合）

**调试与优化心得**：  
- **数据溢出**：多个题解强调使用 `long long`，避免中间结果溢出（如 `mul * mul` 可能超过 `int` 范围）。  
- **思维陷阱**：直接暴力枚举会超时，需通过数学变形或前缀和优化时间复杂度。  
- **空间优化**：动态维护后续和比存储前缀数组更节省内存，适合极端数据规模。

---
处理用时：50.06秒
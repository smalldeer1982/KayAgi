# 题目信息

# [PA 2020] Mieszanie kolorów

## 题目描述

**题目译自 [PA 2020](https://sio2.mimuw.edu.pl/c/pa-2020-1/dashboard/) Runda 1 [Mieszanie kolorów](https://sio2.mimuw.edu.pl/c/pa-2020-1/p/kol/)**

Byteasar 正准备给栅栏涂漆。他已经准备了 $n$ 罐白色油漆，他把这些油漆排列成一排，从 $1$ 到 $n$ 编号。他想用这些油漆，但他不想把栅栏涂成白色。他委托了调色专家，调色专家有三种颜料：黄色、蓝色和红色。专家进行了 $m$ 次操作，其中第 $i$ 次操作是向编号在 $l_i$ 到 $r_i$ 之间（包括两端）的所有罐子中加入某种颜料。

油漆的最终颜色取决于被添加到其中的颜料。添加的颜料按照下表和图示进行混合。

|        颜料        | 颜色 |
| :----------------: | :--: |
|         无         | 白色 |
|        黄色        | 黄色 |
|        蓝色        | 蓝色 |
|        红色        | 红色 |
|    黄色 + 蓝色     | 绿色 |
|    黄色 + 红色     | 橙色 |
|    蓝色 + 红色     | 紫色 |
| 黄色 + 蓝色 + 红色 | 棕色 |

![](https://cdn.luogu.com.cn/upload/image_hosting/zow92g6w.png)

Byteasar 想要给栅栏涂成一种颜色。思来想去，他选择了绿色，因为绿色代表了你常会在算法竞赛中看到的 Accepted。他想知道现在有多少罐油漆是绿色的，请帮他数数。

## 说明/提示

#### 样例 1 解释

操作结束后，这些油漆分别是蓝色、绿色、黄色、绿色、绿色、棕色、橙色、黄色和白色的。因此，只有三罐油漆是绿色。

------------

#### 数据范围

**本题采用捆绑测试**

对于 $100\%$ 的数据，保证 $1\le n,m\le 10^6$，$1\le l_i\le r_i\le n$，$1\le k_i\le 3$。

## 样例 #1

### 输入

```
9 5
2 8 1
4 5 2
6 7 3
5 6 2
1 2 2```

### 输出

```
3```

# AI分析结果



### 综合分析与结论
所有题解均围绕区间修改与颜色判定展开。最优解法为差分法，时间复杂度 O(n + m)，完美适配数据规模。线段树解法虽可行，但时空效率不及差分。核心思路是分别统计三种颜色的覆盖次数，最后判定黄色与蓝色非零且红色为零的位置。

---

### 高评分题解推荐

#### 1. WaterSky（⭐⭐⭐⭐⭐）
**关键亮点**：  
- 清晰的差分思路，三数组分别处理颜色
- 代码简洁高效，变量命名直观（A/B/C对应黄/蓝/红）
- 包含完整的前缀和还原与条件判断逻辑

**核心代码**：
```cpp
// 差分处理
if(z==1) A[x]++,A[y+1]--; // 黄
if(z==2) B[x]++,B[y+1]--; // 蓝
if(z==3) C[x]++,C[y+1]--; // 红

// 前缀和还原及判定
for(int i=1;i<=n;i++) A[i]+=A[i-1],B[i]+=B[i-1],C[i]+=C[i-1];
for(int i=1;i<=n;i++) if(A[i] && B[i] && !C[i]) ans++;
```

#### 2. lbdontknow（⭐⭐⭐⭐）
**关键亮点**：  
- 详细的问题拆解与差分原理讲解
- 用 `min(bluesum,yellowsum)>0` 优化条件判断
- 代码包含读入优化，适合大输入量场景

**核心优化**：
```cpp
// 条件判定优化
if(redsum==0 && min(bluesum,yellowsum)>0) ans++;
```

#### 3. guozhetao（⭐⭐⭐⭐）
**关键亮点**：  
- 极简代码风格，直接聚焦核心逻辑
- 变量名缩写明确（r/y/b数组）
- 条件判断使用逻辑运算符紧凑表达

**核心代码**：
```cpp
if(!r[i] and y[i] and b[i]) ans++;
```

---

### 关键思路与技巧总结
1. **差分数组的并行使用**：为三种颜色维护独立差分数组，实现 O(1) 区间修改。
2. **前缀和还原**：通过一次遍历将差分数组转换为实际计数。
3. **条件组合判定**：绿色需同时满足黄、蓝存在且红不存在，避免冗余计算。
4. **空间优化**：差分法仅需线性空间，无需复杂数据结构。

---

### 拓展与同类题目推荐
1. **差分思想拓展**  
   - 二维区间修改：[P3397 地毯](https://www.luogu.com.cn/problem/P3397)  
   - 动态前缀最值：[P7948 ✗✓OI R1] 前方之风](https://www.luogu.com.cn/problem/P7948)

2. **推荐练习题目**  
   - [P3368 【模板】树状数组 2](https://www.luogu.com.cn/problem/P3368)（区间修改+单点查询）  
   - [P2181 对角线](https://www.luogu.com.cn/problem/P2181)（组合数学+区间特性）  
   - [P1438 无聊的数列](https://www.luogu.com.cn/problem/P1438)（差分+线段树结合）

---

### 题解中的个人心得摘录
- **差分的优势**："暴力法复杂度 O(nm) 无法通过，差分将区间操作降至 O(1)" —— 强调算法选择对效率的决定性影响。  
- **线段树的教训**："尝试用线段树但 MLE，最终改用差分" —— 提醒根据数据规模选择数据结构，避免过度设计。  
- **条件优化**："min(bluesum,yellowsum)>0 代替两个判断" —— 代码简洁性与可读性的权衡技巧。

---
处理用时：55.02秒
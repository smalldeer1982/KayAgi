# 题目信息

# [USACO18FEB] Hoofball B

## 题目描述

为了准备即将到来的蹄球锦标赛，Farmer John 正在训练他的 $N$ 头奶牛（方便起见，编号为 $1\ldots N$，其中 $1\le N\le 100$）进行传球。这些奶牛在牛棚一侧沿直线排列，第 $i$ 号奶牛位于距离牛棚 $x_i$ 的地方（$1\le x_i\le 1000$）。每头奶牛都在不同的位置上。

在训练开始的时候，Farmer John 会将若干个球传给不同的奶牛。当第 $i$ 号奶牛接到球时，无论是从 Farmer John 或是从另一头奶牛传来的，她会将球传给最近的奶牛（如果有多头奶牛与她距离相同，她会传给其中距左边最远的那头奶牛）。为了使所有奶牛都有机会练习到传球，Farmer John 想要确保每头奶牛都持球至少一次。帮助他求出为了达到这一目的他开始时至少要传出的球的数量。假设他在开始的时候能将球传给最适当的一组奶牛。 

## 说明/提示

在上面的样例中，Farmer John 应该将球传给位于 $x=1$ 的奶牛和位于 $x=11$ 的奶牛。位于 $x=1$ 的奶牛会将她的球传给位于 $x=3$ 的奶牛，在此之后这个球会在位于 $x=3$ 的奶牛和位于 $x=4$ 的奶牛之间来回传递。位于 $x=11$ 的奶牛会将她的球传给位于 $x=7$ 的奶牛，然后球会被传给位于 $x=4$ 的奶牛，在此之后这个球也会在位于 $x=3$ 的奶牛和位于 $x=4$ 的奶牛之间来回传递。这样的话，所有的奶牛都会至少一次接到球（可能从 Farmer John，也可能从另一头奶牛）。

可以看出，不存在这样一头奶牛，Farmer John 可以将球传给她之后所有奶牛最终都能被传到球。 

## 样例 #1

### 输入

```
5
7 1 3 11 4```

### 输出

```
2```

# AI分析结果

### 综合分析与结论
这些题解大多围绕将奶牛位置排序后，分析每头奶牛的传球方向和入度来求解。核心思路是找出入度为 0 的奶牛，同时考虑两头奶牛相互传球形成环的特殊情况。不同题解在代码实现和处理细节上有所差异，部分使用了 DFS 遍历，部分直接模拟判断。

### 所选题解
- **作者：Silent1019（5星）**
    - **关键亮点**：思路清晰，代码简洁，对特殊情况的处理说明详细，且提醒了 `INF` 的设置避免溢出问题。
    - **个人心得**：无
- **作者：Je_son（4星）**
    - **关键亮点**：思路阐述简洁明了，代码结构清晰，对环的特判处理简洁。
    - **个人心得**：无
- **作者：_Dynamic_Programming（4星）**
    - **关键亮点**：思路步骤详细，代码注释清晰，将解题过程逐步拆分说明。
    - **个人心得**：无

### 重点代码及核心思想
#### Silent1019
```cpp
for(int i=1;i<=n;i++)
    if(a[i]-a[i-1]>a[i+1]-a[i]){
        to[i]=i+1;
        cnt[i+1]++;
    }else{
        to[i]=i-1;
        cnt[i-1]++;
    }
for(int i=1;i<=n;i++)
    if(!cnt[i]) ans++;
for(int i=1;i<=n;i++)
    if(cnt[i]==1&&cnt[i+1]==1&&to[i]==i+1&&to[i+1]==i)
        ans++;
```
核心思想：先模拟每头奶牛的传球方向并统计入度，再统计入度为 0 的奶牛数量，最后检查相互传球的情况并更新答案。

#### Je_son
```cpp
for(int i = 1; i <= n; i ++ )
{
    if(a[i] - a[i - 1] <= a[i + 1] - a[i])
        cnt[i - 1] ++, to[i] = i - 1;
    else
        cnt[i + 1] ++, to[i] = i + 1;
}
for(int i = 1; i <= n; i ++ )
    if(!cnt[i])
        res ++ ;
for(int i = 2; i <= n; i ++ )
    if(to[i - 1] == i && to[i] == i - 1 && cnt[i - 1] == 1 && cnt[i] == 1)
        res ++ ;
```
核心思想：同样先模拟传球更新入度，统计入度为 0 的奶牛，再特判环的情况更新结果。

#### _Dynamic_Programming
```cpp
for(int i = 1; i <= n; i++)
{
    if(x[i] - x[i - 1] <= x[i + 1] - x[i]) in[i - 1]++, out[i] = i - 1;
    else in[i + 1]++, out[i] = i + 1;
}
for(int i = 1; i <= n; i++)
    if(in[i] == 0) ans++;
for(int i = 1; i < n; i++)
    if(in[i] == 1 && in[i + 1] == 1 && out[i] == i + 1 && out[i + 1] == i)
        ans++;
```
核心思想：统计每头奶牛的入度和传出方向，先统计入度为 0 的奶牛，再检查相互传球的情况更新答案。

### 最优关键思路或技巧
- 对奶牛位置排序，将问题简化为考虑左右相邻奶牛的传球关系。
- 用数组记录每头奶牛的传球方向和入度，方便后续统计和判断。
- 注意处理两头奶牛相互传球形成环的特殊情况。

### 可拓展之处
同类型题可能涉及更多复杂的传球规则或奶牛排列方式，可使用图论的相关算法，如拓扑排序、强连通分量等进行求解。类似算法套路可用于解决其他有向图的遍历和连通性问题。

### 推荐题目
- P1113 杂务
- P1347 排序
- P2746 [USACO5.3]校园网Network of Schools

### 个人心得摘录与总结
- **作者：jianglai0119**：原思路只考虑入度为 0 的节点导致只得到 10 分，通过构造反例发现存在两头奶牛互相传球的环的情况，从而改进算法，最终 AC。总结是在解题时要考虑全面，多构造特殊情况进行验证。 

---
处理用时：24.55秒
# 题目信息

# [USACO17OPEN] Paired Up S

## 题目描述

Farmer John 发现，当他的奶牛附近有另一头奶牛提供精神支持时，每头奶牛挤奶会更容易。因此，他希望将他的 $M$ 头奶牛（$M \leq 1,000,000,000$，$M$ 为偶数）分成 $M/2$ 对。每对奶牛将被引导到谷仓中一个单独的隔间进行挤奶。这些 $M/2$ 个隔间中的挤奶过程将同时进行。

为了增加一些复杂性，Farmer John 的每头奶牛都有不同的产奶量。如果产奶量分别为 $A$ 和 $B$ 的两头奶牛被配对，那么挤完它们总共需要 $A+B$ 单位时间。

请帮助 Farmer John 确定整个挤奶过程完成所需的最少时间，假设他以最佳方式配对奶牛。

## 说明/提示

在这里，如果产奶量为 8 和 2 的奶牛配对，产奶量为 5 和 5 的奶牛配对，那么两个隔间的挤奶时间均为 10 单位时间。由于挤奶是同时进行的，因此整个挤奶过程将在 10 单位时间后完成。任何其他配对方式都会导致某个隔间的挤奶时间超过 10 单位时间，因此不是最优的。

## 样例 #1

### 输入

```
3
1 8
2 5
1 2```

### 输出

```
10```

# AI分析结果

### 综合分析与结论
这些题解均采用贪心算法解决问题，核心思路是将产奶量最小和最大的奶牛配对，取配对后产奶时间的最大值。具体实现上，都先对奶牛按产奶量排序，再使用双指针分别指向产奶量最小和最大的奶牛组，根据两组奶牛数量的关系移动指针。部分题解使用了快读、结构体存储奶牛信息等技巧，还有题解对最初超时的代码进行了优化。

### 所选题解
- **作者：x_faraway_x（5星）**
    - **关键亮点**：思路清晰，代码注释详细，详细解释了每一步操作的目的，易于理解。
    - **核心代码**：
```cpp
while(i<=j)
{
    if(a[i].y+a[j].y>ans) ans=a[i].y+a[j].y;
    if(a[i].x>a[j].x)
    {
        a[i].x-=a[j].x;
        j--;
    }
    else if(a[i].x<a[j].x)
    {
        a[j].x-=a[i].x;
        i++;
    }
    else
    {
        i++;
        j--;
    }
}
```
核心思想：通过双指针遍历，每次将产奶量最小和最大的奶牛组配对，更新最大产奶时间，根据两组奶牛数量的大小关系调整指针位置。

- **作者：Tatayy（4星）**
    - **关键亮点**：代码简洁，对关键步骤有注释，还提醒了避免死循环的注意事项。
    - **核心代码**：
```cpp
while(b<=e)
{
    int t=min(cows[b].x,cows[e].x);
    ans=max(ans,cows[b].y+cows[e].y);
    cows[b].x-=t,cows[e].x-=t;
    if(cows[b].x<=0) b++;
    if(cows[e].x<=0) e--;
}
```
核心思想：同样使用双指针，每次取两组奶牛数量的最小值进行配对，更新最大产奶时间，当某组奶牛数量为0时移动指针。

- **作者：PersistentLife（4星）**
    - **关键亮点**：不仅给出了代码实现，还对最初超时的代码进行了分析和优化，提供了优化思路。
    - **核心优化后代码**：
```cpp
while(i<=j)
{
    ans=max(ans,c[i].y+c[j].y);
    if(c[i].x>c[j].x)
    {
        c[i].x-=c[j].x;
        j--;
    }
    else if(c[i].x<c[j].x)
    {
        c[j].x-=c[i].x;
        i++;
    }
    else
    {
        i++;
        j--;
    }
}
```
核心思想：优化了减去奶牛数量的操作，避免了不必要的循环，提高了效率。

### 最优关键思路或技巧
- **贪心策略**：每次将产奶量最小和最大的奶牛配对，可使整体挤奶时间最小。
- **双指针法**：使用双指针分别指向产奶量最小和最大的奶牛组，根据两组奶牛数量的关系移动指针，避免了对每头奶牛进行操作，降低了时间复杂度。
- **批量处理**：对于产奶量相同的奶牛组，一起处理，避免重复计算。

### 可拓展之处
同类型题或类似算法套路：
- 区间配对问题：如将不同长度的线段两两配对，使配对后线段长度之和的最大值最小。
- 资源分配问题：将不同价值的资源进行配对，使配对后价值之和的最大值最小。

### 推荐题目
- P1094 [NOIP2007 普及组] 纪念品分组
- P1223 排队接水
- P1803 凌乱的yyy / 线段覆盖

### 个人心得摘录与总结
- **Tatayy**：“这题坑了我好几次”，提醒我们在处理指针移动时要注意边界条件，避免出现死循环。
- **tribool4_in**：“将产奶量从小到大 $sort$ 一遍，然后将大的和小的两两配对即可，结果超时了。发现有很多奶牛产奶量一致，一块处理就过了”，说明在处理大规模数据时，要考虑优化算法，避免不必要的重复计算。 

---
处理用时：23.03秒
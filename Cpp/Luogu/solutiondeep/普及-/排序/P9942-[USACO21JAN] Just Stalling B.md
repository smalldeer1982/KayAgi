# 题目信息

# [USACO21JAN] Just Stalling B

## 题目描述

Farmer John 有 $N$ 头奶牛（$1\le N\le 20$），高度为 $a_1\ldots a_N$。他的牛栏有 $N$ 个牛棚，高度限制分别为 $b_1\ldots b_N$（例如，如果 $b_5=17$，那么一头高度不超过 $17$ 的奶牛可以住在牛棚 $5$ 里）。Farmer John 有多少种不同的方式安排他的奶牛，使得每头奶牛均住在不同的牛棚里，并且使得每个牛棚的高度限制均得到满足？ 

## 说明/提示

### 样例解释 1

在这个例子中，我们不能将第三头奶牛安排到第一个牛棚里，因为 $3=a_3>b_1=2$。类似地，我们不能将第四头奶牛安排到第一或第三个牛棚里。一种符合高度限制的安排方式为将奶牛 1 安排到牛棚 1，奶牛 2 安排到牛棚 2，奶牛 3 安排到牛棚 3，奶牛 4 安排到牛棚 4。

### 测试点性质

- 测试点 $1-5$ 满足 $N\le 8$。
- 测试点 $6-12$ 没有额外限制。

## 样例 #1

### 输入

```
4
1 2 3 4
2 4 3 4```

### 输出

```
8```

# AI分析结果

### 综合分析与结论
这些题解核心思路一致，均采用贪心策略，优先安排高度高的奶牛，依据乘法原理计算方案总数。不同在于实现细节，部分使用标记数组记录牛棚占用情况，部分直接计算可安排牛棚数并减去已占用数量。

### 所选题解
- **作者：OIerWu_829（5星）**
    - **关键亮点**：思路清晰，代码简洁易懂，直接计算每头牛可分配的牛棚数并累乘，避免使用额外标记数组。
    - **核心代码**：
```cpp
sort(a + 1, a + 1 + n, greater<int>());
long long ans = 1;
for (int i = 1; i <= n; i++) {
    int cnt = 0;
    for (int j = 1; j <= n; j++)
        if (b[j] >= a[i]) cnt++;
    cnt -= (i - 1);
    ans *= cnt;
}
```
核心思想：先对奶牛高度从大到小排序，遍历每头牛，统计可安排的牛棚数，减去已安排的牛的数量，累乘到方案总数中。

- **作者：juruo_zhanshen（4星）**
    - **关键亮点**：详细解释思路，使用标记数组记录牛棚占用情况，符合常规思维。
    - **核心代码**：
```cpp
sort(a + 1, a + n + 1, cmp);
sort(b + 1, b + n + 1, cmp);
for (int i = 1; i <= n; i++){
    int cnt = 0;
    for (int j = 1; j <= n; j++)
        if (flag[j] == 0 && b[j] >= a[i])
            cnt++;
    for (int j = 1; j <= n; j++){
        if (flag[j] == 1) continue;
        else{
            flag[j] = 1;
            break;
        }
    }
    ans *= cnt;
}
```
核心思想：对奶牛和牛棚高度降序排序，遍历每头牛，统计未占用且高度合适的牛棚数，标记一个可用牛棚，累乘到方案总数。

- **作者：TruchyR（4星）**
    - **关键亮点**：引入 $p_i$ 和 $f_i$ 数组，通过指针优化计算，时间复杂度为 $O(n\log{n})$。
    - **核心代码**：
```cpp
sort(a+1,a+1+n);sort(b+1,b+1+n); 
for(int i=1;i<=n;i++){
    while(a[p+1]<=b[i] && p<n) p++;
    res*=(p-i+1);
}
```
核心思想：对奶牛和牛棚高度升序排序，用指针 $p$ 计算第 $i$ 个牛棚可容纳的奶牛编号，根据递推公式 $f_i=(p_i - i + 1)f_{i - 1}$ 计算方案总数。

### 最优关键思路或技巧
- 贪心策略：优先安排高度高的奶牛，因为其受限更多，先安排能简化后续计算。
- 乘法原理：每头牛可选择的牛棚数相乘得到总方案数。
- 指针优化：如 TruchyR 的题解，使用指针 $O(n)$ 计算 $p_i$，降低时间复杂度。

### 可拓展之处
同类型题如排列组合问题，需考虑元素间的限制条件，通过贪心和乘法原理计算方案数。类似算法套路可用于座位安排、任务分配等问题。

### 推荐题目
- P1088 火星人
- P1135 奇怪的电梯
- P1219 八皇后

### 个人心得
题解中未包含个人心得内容。 

---
处理用时：22.24秒
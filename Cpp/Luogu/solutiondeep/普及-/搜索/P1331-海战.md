# 题目信息

# 海战

## 题目背景

在峰会期间，武装部队得处于高度戒备。警察将监视每一条大街，军队将保卫建筑物，领空将布满了 F-2003 飞机。

此外，巡洋船只和舰队将被派去保护海岸线。不幸的是，因为种种原因，国防海军部仅有很少的几位军官能指挥大型海战。因此，他们培养了一些新海军指挥官。军官们选择了“海战”游戏来帮助他们学习。

## 题目描述

在一个方形的盘上，放置了固定数量和形状的船只，每只船却不能碰到其它的船。在本题中，我们认为船是方形的，所有的船只都是由图形组成的方形。

求出该棋盘上放置的船只的总数。

## 说明/提示

对于 $100\%$ 的数据，$1 \le R,C \le 1000$。

## 样例 #1

### 输入

```
6 8
.....#.#
##.....#
##.....#
.......#
#......#
#..#...#```

### 输出

```
There are 5 ships.
```

# AI分析结果



### 综合分析与结论
本题核心在于判断船只形状是否合法（严格矩形且不相邻），各题解主要围绕以下思路展开：
1. **相邻判定**：通过检查所有2x2方格是否含有3个`#`快速排除非法情况
2. **矩形验证**：通过DFS/BFS确定连通块范围后检查矩形完整性
3. **计数优化**：利用矩形特性（如左上角唯一性）简化计数过程

### 高星题解推荐
#### 1. 钱逸凡（★★★★★）
**核心亮点**：
- 独创性发现2x2方格判定规律，时间复杂度O(R*C)
- 两阶段处理：先合法性检查，后DFS计数，逻辑清晰
- 代码简洁高效（仅需双重循环+DFS）

**关键代码**：
```cpp
// 2x2方格检查
bool d(int i,int j){
    int c=0;
    if(map[i][j]=='#')c++;
    if(map[i+1][j]=='#')c++;
    if(map[i][j+1]=='#')c++;
    if(map[i+1][j+1]=='#')c++;
    return c != 3; // 返回是否合法
}
```

#### 2. Dzhao（★★★★☆）
**核心亮点**：
- 利用矩形左上角特征直接计数
- 预处理非法检查后O(R*C)线性计数
- 无需复杂搜索，代码量极小

**关键实现**：
```cpp
for(int i=1;i<=n;i++)
    for(int j=1;j<=m;j++) 
        if(g[i][j]=='#' && g[i-1][j]!='#' && g[i][j-1]!='#') ans++;
```

#### 3. 智子·起源（★★★★☆）
**核心亮点**：
- BFS记录极值坐标验证矩形完整性
- 直观的几何验证方法
- 调试心得体现问题分析过程

**验证逻辑**：
```cpp
for(int k=minn;k<=maxn;k++)
    for(int l=minm;l<=maxm;l++)
        if(f[k][l]!='*') return 0; // 检查矩形完整性
```

### 关键技巧总结
1. **相邻快速判定**：2x2方格含3个`#`必非法，时间复杂度O(4RC)
2. **矩形特征利用**：
   - 左上角特征：上方和左侧无`#`
   - 面积验证：连通块数量=矩形长*宽
3. **搜索优化**：预处理非法后，可用简单遍历替代DFS

### 拓展训练推荐
1. [P1451 求细胞数量](https://www.luogu.com.cn/problem/P1451) - 连通块计数基础
2. [P1506 拯救oibh总部](https://www.luogu.com.cn/problem/P1506) - 边界特征分析
3. [P1162 填涂颜色](https://www.luogu.com.cn/problem/P1162) - 连通区域标记技巧

### 个人心得摘录
> "通过自己模拟的数据可以得出结论：如果图是不合法的，一定存在如下结构..." —— 钱逸凡  
> （启示：特殊测试用例分析是发现规律的关键）

> "我太弱了，被各位巨佬吊打 QwQ" —— Dzhao  
> （幽默自嘲中体现高效代码的简洁美）

> "BFS记录极值坐标后，双for枚举范围内有没有不是甲板的地方" —— 智子·起源  
> （体现从几何特征入手的解题思路）

---
处理用时：59.24秒
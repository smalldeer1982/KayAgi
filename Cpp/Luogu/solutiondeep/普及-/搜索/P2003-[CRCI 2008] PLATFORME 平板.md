# 题目信息

# [CRCI 2008] PLATFORME 平板

## 题目描述

为了进行一种游戏，现决定搭造一些平板，而各个平板的地址已经选定。基于最普遍的认识，没有任何支持物的平板不可能漂浮在空中。说的更精确些，任意一平板的两端必需有支柱或者它在另一块平板上。

你会得到各个平板在坐标系中的坐标（如左下图）。每一块平板的坐标都是由它的高度（与地板间的垂直距离）和它的水平方位（开始和结束）决定的。每个支柱都距它支撑的平板的边缘半个单位（如图）。

算出支持所有平板的支柱的总长度。

 ![](https://cdn.luogu.com.cn/upload/pic/994.png) 



## 样例 #1

### 输入

```
3

1 5 10

3 1 5

5 3 7

```

### 输出

```
14```

# AI分析结果



### 综合分析与结论
题目核心是计算每个平板端点支撑高度的最大值差。主要解法分为暴力枚举、线段树优化、模拟数组三类。暴力解法在n=100时足够高效，线段树在更大数据时更优，模拟数组通过离散化处理坐标简化实现。关键优化点在于排序顺序、支撑条件判断、坐标处理技巧。

---

### 评分较高题解推荐

#### 1. 作者：Makasukaka（线段树解法） ★★★★☆
- **核心思路**：按高度排序后，用线段树维护每个x位置的最大高度。对每个平板查询左右端点支撑高度，并更新覆盖区间。
- **亮点**：时间复杂度O(n log h)可处理大数据，提供线段树模板与区间处理技巧。
- **关键代码**：
```cpp
sort(a+1,a+1+n,cmp);
build(1,1,N);
for(int i=1;i<=n;i++){
    int l=a[i].x1, r=a[i].x2;
    int d=query(1,l,l+1);
    ans += (a[i].y - d);
    d=query(1,r-1,r);
    ans += (a[i].y - d);
    insert(1,l+1,r-1,a[i].y); // 更新区间高度
}
```

#### 2. 作者：常清静矣（图解+模拟数组） ★★★★
- **核心思路**：将坐标×2避免浮点运算，按高度排序后维护数组记录每个位置的最大高度。
- **亮点**：图解清晰，代码简洁，通过离散化处理实现O(nw)复杂度（w为坐标范围）。
- **关键代码**：
```cpp
sort(B,B+n,cmp);
for(int i=0;i<n;i++){
    ans += B[i].y*2 - d[B[i].l+1] - d[B[i].r-1];
    for(int j=B[i].l+1; j<B[i].r; j++)
        d[j] = B[i].y;
}
```

#### 3. 作者：wuzhoupei（暴力枚举） ★★★★
- **核心思路**：直接维护每个位置的高度数组，按高度排序后计算左右端点差值。
- **亮点**：代码极简（仅20行），通过坐标转换巧妙处理边界条件。
- **关键代码**：
```cpp
sort(aa+1,aa+n+1,maP);
for(R II i=1;i<=n;i++){
    ans += aa[i].y*2 - h[aa[i].l] - h[aa[i].r];
    for(R II j=aa[i].l;j<=aa[i].r;j++)
        h[j] = max(h[j],aa[i].y);
}
```

---

### 最优关键思路总结
1. **排序处理**：按平板高度升序处理，确保支撑板已计算。
2. **坐标转换**：将坐标×2避免浮点运算（如左端点x1→2x1+1）。
3. **支撑高度维护**：使用数组/线段树记录每个位置当前最大高度。
4. **区间更新**：处理完平板后，更新其覆盖区间的高度值。

---

### 相似题目推荐
1. [P1904 天际线问题](https://www.luogu.com.cn/problem/P1904)  
   **相似点**：区间覆盖问题，可用扫描线+优先队列。
2. [P5490 【模板】扫描线](https://www.luogu.com.cn/problem/P5490)  
   **相似点**：线段树维护区间覆盖，计算面积并。
3. [P3740 贴海报](https://www.luogu.com.cn/problem/P3740)  
   **相似点**：离散化坐标后倒序处理区间覆盖问题。

---

### 题解中的调试心得摘录
- **作者：重回巅峰！**  
  > "数组不能开小...开到80W的数组居然AC了"  
  **总结**：坐标离散化时需注意数据范围，避免RE。
- **作者：rfsfreffr**  
  > "被double与int玩了"  
  **总结**：处理浮点比较时优先转为整数运算。

---
处理用时：53.01秒
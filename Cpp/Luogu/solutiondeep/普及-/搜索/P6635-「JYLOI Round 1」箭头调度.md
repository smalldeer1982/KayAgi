# 题目信息

# 「JYLOI Round 1」箭头调度

## 题目描述

moyu_028 给了你一个有 $n$ 个点 $m$ 条边的无向图，现在要给每条边赋一个方向，现在请你求出一个赋方向的方案，使得按照这个方案能够生成一个拓扑序，且使得这个拓扑序是在所有可能的拓扑序中字典序第 $k$ 小的。


## 说明/提示

## 提示

拓扑序：在一个 DAG（有向无环图）中，我们将图中的顶点以线性方式进行排序，使得对于任何的顶点 $u$ 到 $v$ 的有向边 $(u,v)$，都可以有 $u$ 在 $v$ 的前面，则这样的序列称为拓扑序。

----------

## 样例解释

### 样例 1 解释

答案的图如下，根据图可得出答案。

![](https://i.loli.net/2020/05/23/3FK2n78JAYLrGMD.png)

-----------------

## 数据范围

对于 $100\%$ 的数据，$1 \leq n \leq 11, 1 \leq m \leq 2 \times 10^3, 1 \leq k \leq 10^8，1 \leq x_i, y_i \leq n, x_i \not= y_i$。

对于测试点 1（10 分）：$n = 1$。

对于测试点 2（30 分）：$n \leq 11, m \leq 20$。

对于测试点 3（30 分）：$n \leq 11, k = 1$。

对于测试点 4（30 分）：无特殊限制。

本题共 4 个测试点，总分为 100 分，单个测试点的时间限制为 5 秒。

## 题目来源

「JYLOI Round 1」 A

Idea：moyu_028 & abcdeffa

Solution：LiuXiangle

Data：abcdeffa

## 样例 #1

### 输入

```
6 7 5
1 3
2 1
4 2
4 3
4 5
3 6
5 6```

### 输出

```
0111001```

## 样例 #2

### 输入

```
11 20 20091210
2 3
3 1
2 5
4 6
7 9
8 10
8 1
7 2
2 3
3 2
4 5
5 7
7 6
7 8
9 7
9 8
10 2
2 3
1 3
1 7```

### 输出

```
10110000100110110111```

# AI分析结果



### 综合分析与结论
本题核心在于将拓扑序的字典序问题转化为全排列的字典序问题。通过构造特定边方向规则（按排列顺序决定方向），可将任意排列转化为合法拓扑序。最优解法为利用康托展开或阶乘分解法高效生成第k小的排列，再根据排列中的节点顺序确定边的方向。

---

### 高星题解推荐

#### 1. 作者：moyu_028（5星）
**关键亮点**  
- 官方题解，正确性保障，思路完整。  
- 对特殊测试点（如k=1）进行数学证明，逻辑严谨。  
- 指出全排列与拓扑序的等价性，为解法提供理论支撑。  

#### 2. 作者：wzkdh（5星）
**关键亮点**  
- 使用康托展开高效生成第k小排列，时间复杂度O(n²)。  
- 处理k超过n!的情况（取模操作），避免无效循环。  
- 代码简洁，包含完整的排列生成与边方向判定逻辑。  

**核心代码**  
```cpp
void cantor(int x) {
    x %= c[n];
    for (int i = n - 1; i >= 0; i--) {
        int idx = x / c[i];
        int tot = 0;
        for (int j = 1; j <= 11; j++) {
            if (v[j]) continue;
            if (tot == idx) {
                v[j] = 1;
                ans[i] = j;
            }
            tot++;
        }
        x %= c[i];
    }
}
```

#### 3. 作者：HNOIRPplusplus（4星）
**关键亮点**  
- 提出阶乘分解法生成排列，避免暴力枚举。  
- 理论分析清晰，指出排列生成的核心在于逐位确定元素。  
- 未提供完整代码，但思路与康托展开异曲同工。  

---

### 最优思路总结
1. **排列生成**：通过康托展开或阶乘分解，直接构造第k小的排列，避免暴力枚举。
2. **边方向规则**：对每条边(u,v)，若u在排列中的位置先于v，则定向为u→v，否则v→u。
3. **时间优化**：对k取模n!以处理大数，确保生成效率。

---

### 相似题目推荐
1. **全排列的第k小序列**（洛谷 P3014）  
   - 考察康托展开与逆康托展开的经典应用。
2. **火星人**（洛谷 P1088）  
   - 利用next_permutation处理排列生成问题。
3. **拓扑计数**（洛谷 P3184）  
   - 结合拓扑排序与排列计数的综合题目。

---
处理用时：135.32秒
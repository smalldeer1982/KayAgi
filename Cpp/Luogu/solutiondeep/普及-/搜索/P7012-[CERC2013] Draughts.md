# 题目信息

# [CERC2013] Draughts

## 题目描述

国际跳棋（或称跳棋）是一种由两个对手在 $10 \times 10$ 的棋盘上进行的游戏。棋盘上的方块是黑色或白色的，就像经典的国际象棋棋盘一样。玩家一方控制黑棋，另一方控制白棋。棋子只能占据黑色的格子。棋手们交替走棋，各自移动自己的一个棋子。

最有趣的走法是吃掉：如果一个对角线相邻的格子里有对手的棋子，可以通过跳过它到紧挨着它的未被占领的格子来吃掉（并从游戏中删除被吃掉的这个棋子）。允许在一步棋中用一个棋子连续吃掉几个棋子。通过向前或向后的跳跃来吃子也是合法的。

你会得到一个棋子的位置。现在轮到白方了。计算他在下一步棋中能吃掉的最大可能的黑棋数量。

## 样例 #1

### 输入

```
2

.#.#.#.#.#
#.#.#.#.#.
.#.#.B.#.#
#.#.#.#.#.
.#.#.B.#.#
#.#.W.#.#.
.#.#.#.#.#
#.#.#.B.#.
.#.#.#.#.#
#.#.#.#.#.

.#.#.#.#.#
#.#.#.#.#.
.#.#.B.#.#
#.B.#.B.#.
.#.#.B.#.#
#.B.W.#.#.
.#.B.B.#.#
#.#.#.#.#.
.#.B.B.#.#
#.#.#.#.#.
```

### 输出

```
2
4
```

# AI分析结果



### 综合分析与结论
该问题属于棋盘路径搜索问题，核心是**DFS+回溯**，处理连续跳跃和状态恢复。所有题解均采用DFS，但细节处理（如方向遍历、状态还原、边界判断）存在差异。关键难点在于正确模拟国际跳棋的连续吃子规则，并确保棋盘状态回溯的正确性。

### 评分较高题解推荐

#### 1. 作者：David_yang（4星）
**关键亮点**  
- 详细处理四个跳跃方向，逐个条件判断确保正确性  
- 明确还原三个棋盘位置（原白棋、被吃黑棋、新位置）  
- 初始值设为0，正确处理无解情况  
**核心代码思想**  
```cpp
void dfs(long long x, long long y, long long cnt) {
    // 判断是否无法继续跳跃，更新最大值
    for (4方向) {
        if (满足跳跃条件) {
            // 修改棋盘状态（原白棋、黑棋、新位置）
            dfs(nx, ny, cnt+1);
            // 还原棋盘状态
        }
    }
}
```
**个人心得**  
- 强调多组数据必须清零，初始值设为0而非负数  
- 指出还原三个格子的必要性，避免状态污染  

#### 2. 作者：Tjaweiof（4星）  
**关键亮点**  
- 显式处理白棋移动时的自身位置（置空后恢复）  
- 使用两套坐标偏移（中间黑棋与目标位置）  
**核心代码片段**  
```cpp
long long dfs(...) {
    for (k=0~3方向) {
        if (中间是B且目标位置为空) {
            吃掉B后递归，回溯恢复B
        }
    }
}
```
**调试教训**  
- 在DFS前将白棋置空，递归后恢复，避免阻挡后续跳跃  
- 提交记录中因未恢复白棋位置导致多次WA  

#### 3. 作者：Alystkia（4星）  
**关键亮点**  
- 使用简洁的方向数组 `dirX/dirY` 管理偏移  
- 将棋盘修改与还原集中处理，代码结构清晰  
**核心实现**  
```cpp
void dfs(int x, int y, int cnt) {
    for (int i=0; i<4; ++i) {
        // 计算中间黑棋和目标位置坐标
        if (中间是B且目标位置合法) {
            // 修改棋盘并递归
            dfs(newX, newY, cnt+1);
            // 还原棋盘
        }
    }
}
```

### 关键思路总结
1. **方向处理**：使用预定义的偏移数组（如`dx[]={-2,-2,2,2}`）管理四个对角方向  
2. **状态回溯**：每次跳跃后需修改三个位置（原白棋、被吃黑棋、新位置），递归后立即还原  
3. **连续跳跃**：在DFS中持续搜索后续跳跃可能，无需额外标记已访问位置  
4. **多白棋处理**：遍历棋盘所有白棋，分别计算后取最大值  

### 拓展建议
- **同类问题**：迷宫中的最大金币收集、象棋马步覆盖问题（需处理连续移动）  
- **优化方向**：记忆化搜索剪枝（若同一位置相同状态已计算过更优解）  

### 推荐练习题
1. [P1433 吃奶酪](https://www.luogu.com.cn/problem/P1433)（DFS+状态压缩）  
2. [P1120 小木棍](https://www.luogu.com.cn/problem/P1120)（回溯剪枝经典）  
3. [P2895 [USACO08FEB]Meteor Shower S](https://www.luogu.com.cn/problem/P2895)（BFS+状态维护）

---
处理用时：50.28秒
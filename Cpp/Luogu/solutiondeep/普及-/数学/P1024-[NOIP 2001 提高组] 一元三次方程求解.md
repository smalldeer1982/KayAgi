# 题目信息

# [NOIP 2001 提高组] 一元三次方程求解

## 题目描述

有形如：$a x^3 + b x^2 + c x + d = 0$  这样的一个一元三次方程。给出该方程中各项的系数（$a,b,c,d$ 均为实数），并约定该方程存在三个不同实根（根的范围在 $-100$ 至 $100$ 之间），且根与根之差的绝对值 $\ge 1$。要求由小到大依次在同一行输出这三个实根(根与根之间留有空格)，并精确到小数点后 $2$ 位。

提示：记方程 $f(x) = 0$，若存在 $2$ 个数 $x_1$ 和 $x_2$，且 $x_1 < x_2$，$f(x_1) \times f(x_2) < 0$，则在 $(x_1, x_2)$ 之间一定有一个根。

## 说明/提示

**【题目来源】**

NOIP 2001 提高组第一题

## 样例 #1

### 输入

```
1 -5 -4 20
```

### 输出

```
-2.00 2.00 5.00
```

# AI分析结果



### 综合分析与结论
本题核心是通过数值方法或数学公式求解三次方程的实根。各题解主要围绕以下思路展开：
1. **二分法**：利用题目中根间距≥1的特性，在长度为1的区间内二分查找
2. **暴力枚举**：以0.001步长遍历[-100,100]，检测函数值符号变化
3. **数学公式**：盛金公式直接求解，但涉及三角函数计算精度问题
4. **迭代法**：牛顿迭代、割线法等数值方法加速收敛

最优解为二分法与暴力枚举，既符合题目特性又易实现。盛金公式虽理论高效，但实际精度处理复杂；迭代法对初始值敏感，实现复杂度较高。

---

### 高评分题解推荐

#### 1. 北街的九命貓（二分法） ⭐⭐⭐⭐⭐
**核心亮点**：
- 完美利用题目条件（根间距≥1），在离散化区间内二分查找
- 提前处理端点解，避免重复计算
- 代码简洁高效，时间复杂度O(100*logN)

**关键代码**：
```cpp
for (i=-100;i<100;i++) {
    l=i; r=i+1;
    x1=fc(l); x2=fc(r);
    if(x1*x2<0) { // 异号区间内二分
        while(r-l>=0.001) {
            m=(l+r)/2;
            if(fc(m)*fc(r)<=0) l=m; 
            else r=m;   
        }
        printf("%.2lf ",r);  
    }
}
```

#### 2. 高木木（暴力枚举） ⭐⭐⭐⭐
**核心亮点**：
- 以0.001步长暴力遍历，检测相邻点符号变化
- 代码极简（仅9行），适合快速解题
- 利用题目保证三个解的特性提前终止

**关键代码**：
```cpp
for(double i=-100.00;i<=100.00;i+=0.001) {
    double l=i, r=i+0.001;
    if((a*l*l*l+...+d)*(a*r*r*r+...+d)<0) {
        printf("%.2f ",l);
        num++;
        if(num==3) break;
    }
}
```

#### 3. 小菜鸟（割线法） ⭐⭐⭐⭐
**核心亮点**：
- 用割线代替导数，避免解析求导
- 结合区间离散化保证找全解
- 收敛速度优于纯暴力法

**核心实现**：
```cpp
double solve(...) {
    while(abs(xx[0]-xx[1])>1e-4) { // 割线迭代
        xx[flag] = xx[flag] - f(xx[flag])/(f(xx[flag])-f(xx[flag^1]))*(xx[flag]-xx[flag^1]);
        flag^=1;
    }
    return xx[0];
}
```

---

### 关键思路总结
1. **区间离散化**：将[-100,100]分割为互不重叠的区间，利用勘根定理定位候选区间
2. **符号检测法**：`f(x)*f(y)<0` 比直接检测 `f(x)==0` 更稳定
3. **精度控制**：二分法采用固定迭代次数（如200次），暴力法通过小步长保证精度

---

### 相似题目推荐
1. [P1025 数的划分](https://www.luogu.com.cn/problem/P1025) - 分治思想应用
2. [P3382 三分法](https://www.luogu.com.cn/problem/P3382) - 单峰函数极值求解
3. [P2016 方程的解数](https://www.luogu.com.cn/problem/P2016) - 高次方程根的数量判定

---
处理用时：56.09秒
# 题目信息

# [NOIP 2003 提高组] 传染病控制

## 题目背景

本题是错题，后来被证明没有靠谱的多项式复杂度的做法。测试数据非常的水，各种玄学做法都可以通过，不代表算法正确。因此本题题目和数据仅供参考。

[关于此类题目的详细内容](https://www.luogu.com.cn/paste/isdgwj5l)

---

近来，一种新的传染病肆虐全球。蓬莱国也发现了零星感染者，为防止该病在蓬莱国大范围流行，该国政府决定不惜一切代价控制传染病的蔓延。不幸的是，由于人们尚未完全认识这种传染病，难以准确判别病毒携带者，更没有研制出疫苗以保护易感人群。于是，蓬莱国的疾病控制中心决定采取切断传播途径的方法控制疾病传播。经过 WHO（世界卫生组织）以及全球各国科研部门的努力，这种新兴传染病的传播途径和控制方法已经研究清楚，剩下的任务就是由你协助蓬莱国疾控中心制定一个有效的控制办法。


## 题目描述

研究表明，这种传染病的传播具有两种很特殊的性质；

第一是它的传播途径是树型的，一个人 $X$ 只可能被某个特定的人 $Y$ 感染，只要 $Y$ 不得病，或者是 $XY$ 之间的传播途径被切断，则 $X$ 就不会得病。


第二是，这种疾病的传播有周期性，在一个疾病传播周期之内，传染病将只会感染一代患者，而不会再传播给下一代。


这些性质大大减轻了蓬莱国疾病防控的压力，并且他们已经得到了国内部分易感人群的潜在传播途径图（一棵树）。但是，麻烦还没有结束。由于蓬莱国疾控中心人手不够，同时也缺乏强大的技术，以致他们在一个疾病传播周期内，只能设法切断一条传播途径，而没有被控制的传播途径就会引起更多的易感人群被感染（也就是与当前已经被感染的人有传播途径相连，且连接途径没有被切断的人群）。当不可能有健康人被感染时，疾病就中止传播。所以，蓬莱国疾控中心要制定出一个切断传播途径的顺序，以使尽量少的人被感染。


你的程序要针对给定的树，找出合适的切断顺序。



## 说明/提示

对于 $100\%$ 的数据，$1 \leq n \leq 300$。

**【题目来源】**

NOIP 2003 提高组第四题

## 样例 #1

### 输入

```
7 6
1 2
1 3
2 4
2 5
3 6
3 7
```

### 输出

```
3
```

# AI分析结果



### 综合分析与结论
该题核心在于树形结构的分层切断策略，所有正解均基于DFS+回溯的暴力搜索框架，通过预处理子树大小和分层结构优化剪枝。题解普遍采用分层枚举切断点的策略，通过标记子树实现剪枝。难点在于正确建模传染阶段与树层数的对应关系，以及高效回溯的实现。

### 评分较高题解亮点

1. **RikoHere（★★★★★）**
   - **核心思路**：分层预处理 + 子树标记回溯
   - 亮点：模块化函数设计（clean/reclean），Dijkstra预处理树结构，清晰的层次划分
   - 代码可读性高，注释详细，适合初学者理解分层思想

2. **基础不牢（★★★★☆）**
   - **核心思路**：结构体存储父子关系 + 分层剪枝
   - 亮点：显式维护父子结构，使用`work()`函数批量标记子树
   - 通过`f`标记快速判断是否全层被保护，优化剪枝逻辑

3. **流逝丶（★★★★）**
   - **核心思路**：简洁的父子关系预处理 + 标记传递
   - 亮点：仅用`vis`数组实现保护状态判断，代码量极小（<50行）
   - 通过`fin()`函数向上追溯父节点状态，避免显式分层存储

### 关键代码实现

**RikoHere的DFS核心**
```cpp
void dfs(int cen, int tot) {
    maxx = max(maxx, tot);
    for (int i = 0; i < cnt[cen]; ++i) {
        if (!bol[b[cen][i]]) {
            int num = clean(b[cen][i]); // 标记子树
            dfs(cen+1, tot + num);
            reclean(b[cen][i]);        // 回溯
        }
    }
}
```
通过`clean()`和`reclean()`递归标记/取消标记整棵子树，维护被保护节点数。

### 关键思路总结
1. **分层建模**：将传染阶段映射为树的深度，按层处理节点
2. **子树预处理**：提前计算每个节点的子树大小，快速计算保护收益
3. **高效回溯**：通过递归标记/清除实现整棵子树的快速状态切换
4. **剪枝优化**：维护当前最大保护数，及时终止非优分支

### 同类型题目推荐
1. P1352 没有上司的舞会（树形DP）
2. P2015 二叉苹果树（树形DP+容量限制）
3. P1273 有线电视网（树形分组背包）

### 调试心得摘录
- **"当链状结构出现时，需特判直接更新答案"**（基础不牢题解）
- **"贪心会错误处理宽层+长链组合"**（Ciyang题解）
- **"随机化需结合子树大小概率选择"**（majt题解）

这些经验强调了树形问题的特殊结构处理与暴力算法的局限性。

---
处理用时：42.96秒
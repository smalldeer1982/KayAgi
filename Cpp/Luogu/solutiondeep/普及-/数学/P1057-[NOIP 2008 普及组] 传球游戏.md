# 题目信息

# [NOIP 2008 普及组] 传球游戏

## 题目描述

上体育课的时候，小蛮的老师经常带着同学们一起做游戏。这次，老师带着同学们一起做传球游戏。

游戏规则是这样的：$n$ 个同学站成一个圆圈，其中的一个同学手里拿着一个球，当老师吹哨子时开始传球，每个同学可以把球传给自己左右的两个同学中的一个（左右任意），当老师再次吹哨子时，传球停止，此时，拿着球没有传出去的那个同学就是败者，要给大家表演一个节目。

聪明的小蛮提出一个有趣的问题：有多少种不同的传球方法可以使得从小蛮手里开始传的球，传了 $m$ 次以后，又回到小蛮手里。两种传球方法被视作不同的方法，当且仅当这两种方法中，接到球的同学按接球顺序组成的序列是不同的。比如有三个同学 $1$ 号、$2$ 号、$3$ 号，并假设小蛮为 $1$ 号，球传了 $3$ 次回到小蛮手里的方式有 $1 \rightarrow 2 \rightarrow 3 \rightarrow 1$ 和 $1 \rightarrow 3 \rightarrow 2 \rightarrow 1$，共 $2$ 种。


## 说明/提示

### 数据范围及约定

- 对于 $40\%$ 的数据，满足：$3 \le n \le 30,1 \le m \le 20$；
- 对于 $100\%$ 的数据，满足：$3 \le n \le 30,1 \le m \le 30$。

2008普及组第三题


## 样例 #1

### 输入

```
3 3```

### 输出

```
2```

# AI分析结果



### 综合分析与结论
本题核心是环形路径计数问题，动态规划（DP）是主流解法。各题解均采用二维DP，定义状态`dp[i][j]`表示传i次球到j位置的方案数，通过状态转移方程处理环形边界。最优解法的关键点在于状态转移的简洁性和边界处理的清晰度，时间复杂度O(nm)完全满足题目限制。

---

### 精选题解推荐

#### 1. 题解作者：HighPerformanceRobot（⭐⭐⭐⭐⭐）
**关键亮点**：
- 从BFS到DP的完整思考过程，帮助理解优化必要性
- 手绘状态转移示意图，直观展示环形结构
- 清晰的代码结构，特判处理环形边界

**个人心得**：
> "DP是毒瘤，谁打谁知道。要想不被毒，暴力少不了"  
> 作者通过BFS尝试失败后转向DP，体现了从暴力到优化的典型解题路径，对初学者调试思路有启发。

**核心代码**：
```cpp
int f[31][31]; // f[传球次数][当前位置]
for(int i=1; i<=m; i++)
    for(int j=1; j<=n; j++)
        if(j==1) f[i][j] = f[i-1][n] + f[i-1][2];
        else if(j==n) f[i][j] = f[i-1][1] + f[i-1][n-1];
        else f[i][j] = f[i-1][j-1] + f[i-1][j+1];
```

#### 2. 题解作者：Vct14（⭐⭐⭐⭐）
**关键亮点**：
- 引入滚动数组优化空间至O(n)
- 取模运算简化环形索引计算
- 提供优化前后的双版本代码

**核心代码**：
```cpp
// 滚动数组版本
int dp[2][32]; // 奇偶轮交替存储
for(int i=1; i<=m; i++)
    for(int j=0; j<n; j++)
        dp[i%2][j] = dp[(i+1)%2][(j-1+n)%n] + dp[(i+1)%2][(j+1)%n];
```

#### 3. 题解作者：Idoyt（⭐⭐⭐⭐）
**关键亮点**：
- 从维度角度分析状态设计，强化DP思维训练
- 对比递归与递推的实现差异
- 强调状态转移方程的推导过程

---

### 关键思路与技巧总结
1. **状态设计**：`dp[i][j]`表示传i次球到j位置的方案数，初始状态`dp[0][1]=1`
2. **转移方程**：
   ```math
   dp[i][j] = \begin{cases} 
   dp[i-1][n] + dp[i-1][2] & j=1 \\
   dp[i-1][1] + dp[i-1][n-1] & j=n \\
   dp[i-1][j-1] + dp[i-1][j+1] & \text{otherwise}
   \end{cases}
   ```
3. **环形处理**：通过特判首尾位置，将线性数组映射为环形结构
4. **空间优化**：利用滚动数组将空间复杂度从O(nm)降为O(n)

---

### 拓展练习推荐
1. **P1877 [HAOI2012] 音量调节** - 类似状态转移的可行性DP
2. **P1216 [USACO1.5] 数字三角形** - 经典路径计数问题
3. **P1433 吃奶酪** - 状态压缩DP与路径规划结合

---

### 同类型题目特征
当问题涉及以下特征时可考虑类似解法：
- 操作步骤具有明确的阶段划分（如传球次数）
- 当前状态仅由相邻的前一阶段状态决定
- 存在环形或循环结构需要特殊处理
- 需要统计路径/方案数而非具体路径

---
处理用时：52.12秒
# 题目信息

# [NOIP 2009 提高组] Hankson 的趣味题

## 题目描述

Hanks 博士是 BT（Bio-Tech，生物技术) 领域的知名专家，他的儿子名叫 Hankson。现在，刚刚放学回家的 Hankson 正在思考一个有趣的问题。

今天在课堂上，老师讲解了如何求两个正整数 $c_1$ 和 $c_2$ 的最大公约数和最小公倍数。现在 Hankson 认为自己已经熟练地掌握了这些知识，他开始思考一个“求公约数”和“求公倍数”之类问题的“逆问题”，这个问题是这样的：已知正整数 $a_0,a_1,b_0,b_1$，设某未知正整数 $x$ 满足：

1. $x$ 和 $a_0$ 的最大公约数是 $a_1$；

2. $x$ 和 $b_0$ 的最小公倍数是 $b_1$。

Hankson 的“逆问题”就是求出满足条件的正整数 $x$。但稍加思索之后，他发现这样的 $x$ 并不唯一，甚至可能不存在。因此他转而开始考虑如何求解满足条件的 $x$ 的个数。请你帮助他编程求解这个问题。


## 说明/提示

**【样例解释】**

第一组输入数据，$x$ 可以是 $9,18,36,72,144,288$，共有 $6$ 个。

第二组输入数据，$x$ 可以是 $48,1776$，共有 $2$ 个。

**【数据范围】**

- 对于 $50\%$ 的数据，保证有 $1\leq a_0,a_1,b_0,b_1 \leq 10000$ 且 $n \leq 100$。
- 对于 $100\%$ 的数据，保证有 $1 \leq a_0,a_1,b_0,b_1 \leq 2 \times 10^9$ 且 $n≤2000$。

NOIP 2009 提高组 第二题


## 样例 #1

### 输入

```
2 
41 1 96 288 
95 1 37 1776 ```

### 输出

```
6 
2```

# AI分析结果



### 综合分析与结论
本题核心在于利用GCD/LCM的质因数分解性质，通过枚举因子或数学推导快速验证条件。关键挑战是处理大数范围的因数枚举效率问题。最优解法需结合数论推导将问题转化为质因数指数的约束，从而将复杂度降至根号级别。

---

### 高分题解推荐

#### 1. 作者：KesdiaelKen（★★★★★）
**关键亮点**：  
- 数学推导将问题转化为质因数约束，通过预处理s/l和q的因数显著减少枚举次数  
- 引入四个特判处理边界条件，代码逻辑严密  
- 时间复杂度优化至O(√s + logs)级别，适合大数范围  

**核心思路**：  
```cpp
int s = b1/a1, l = cf(s,n); // 消去s与n的公共质因数
int q = cf(l,m); // 消去l与m的公共质因数
// 最终答案即为q的因数个数
```

#### 2. 作者：皎月半洒花（★★★★☆）
**关键亮点**：  
- 基于唯一分解定理建立质因数指数的约束关系  
- 采用动态筛法处理大质数，兼容未预筛质数的情况  
- 通过分类讨论质因数指数关系计算组合数  

**核心判断逻辑**：  
```cpp
if(N1>N2 && N3<N4) {
    if(N2==N4) ans *=1; else ans=0;
} else if(...) { ... } // 四类情况讨论
```

#### 3. 作者：zzlzk（★★★★）
**关键亮点**：  
- 直接枚举b1的因数，代码简洁易懂  
- 利用sqrt(b1)枚举优化，避免全范围枚举  
- 通过成对因子处理减少计算量  

**核心枚举逻辑**：  
```cpp
for(int x=1;x*x<=b1;x++) {
    if(b1%x==0) {
        check(x); 
        check(b1/x); // 成对处理因子
    }
}
```

---

### 关键技巧总结
1. **质因数分解视角**：将GCD/LCM条件转化为质因数指数的上下界约束
2. **因子成对枚举**：只需枚举至√n即可覆盖所有因子
3. **数学优化**：通过s = b1/a1等中间量简化约束条件，减少无效枚举
4. **边界特判**：提前处理a0%a1≠0、b1%b0≠0等明显无解情况

---

### 同类题目推荐
1. **P1029** 最大公约数和最小公倍数问题  
   - 相似点：同时处理GCD和LCM的约束条件
2. **P1414** 又是毕业季II  
   - 相似点：通过因数分解统计满足条件的数
3. **P1078** 文化之旅（质因数分解应用）  
   - 相似点：基于质因数分解的数论问题

---

### 题解中的实用心得
1. **KesdiaelKen**：  
   > "四个特判处理无解情况：s非整、m非整、n非整、互质失败"  
   ——强调提前处理边界条件的重要性

2. **皎月半洒花**：  
   > "遇到大质数时动态加入分解列表"  
   ——处理未预筛质数的灵活方法

3. **zzlzk**：  
   > "注意i*i==b1时避免重复计数"  
   ——因子枚举的经典易错点

---
处理用时：50.49秒
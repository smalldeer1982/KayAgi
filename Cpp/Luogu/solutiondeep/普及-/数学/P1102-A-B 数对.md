# 题目信息

# A-B 数对

## 题目背景

出题是一件痛苦的事情！

相同的题目看多了也会有审美疲劳，于是我舍弃了大家所熟悉的 A+B Problem，改用 A-B 了哈哈！

## 题目描述

给出一串正整数数列以及一个正整数 $C$，要求计算出所有满足 $A - B = C$ 的数对的个数（不同位置的数字一样的数对算不同的数对）。

## 说明/提示

对于 $75\%$ 的数据，$1 \leq N \leq 2000$。

对于 $100\%$ 的数据，$1 \leq N \leq 2 \times 10^5$，$0 \leq a_i <2^{30}$，$1 \leq C < 2^{30}$。

2017/4/29 新添数据两组

## 样例 #1

### 输入

```
4 1
1 1 2 3
```

### 输出

```
3```

# AI分析结果



### 综合分析与结论
本题核心在于将A-B=C转换为A-C=B，通过高效方式统计每个数对应的B出现次数。主流解法可分为三类：
1. **哈希映射法**：用map/unordered_map统计数字出现次数，时间复杂度O(n)但存在哈希冲突风险
2. **二分查找法**：排序后对每个元素找目标区间，时间复杂度O(nlogn)
3. **双指针法**：利用有序性维护滑动窗口，时间复杂度O(n)

关键优化点包括：
- 处理重复元素的计数方式
- 避免重复计算（如C=0时的特殊处理）
- 大数据类型使用（long long防溢出）

---

### 优质题解推荐

#### 1. [OsvaldoAsensioLopez] ⭐⭐⭐⭐
**核心思路**：将A-B=C转换为A-C=B，用map记录每个数的出现次数，扫描时累加对应值的次数  
**亮点**：代码简洁（仅15行），利用STL特性巧妙转换问题  
**关键代码**：
```cpp
map<LL,LL> m;
for(int i=1;i<=n;i++) {
    cin >> a[i];
    m[a[i]]++;
    a[i] -= c;    
}
for(int i=1;i<=n;i++) ans += m[a[i]];
```
**注意点**：需使用long long类型，map底层红黑树查询为O(logn)

#### 2. [樱花飞舞] ⭐⭐⭐⭐
**核心思路**：排序后使用upper_bound/lower_bound计算每个元素的目标区间长度  
**亮点**：充分利用STL算法，代码清晰易懂  
**关键实现**：
```cpp
sort(a+1,a+N+1);
ans += (upper_bound(a+1,a+N+1,a[i]+C) - 
        lower_bound(a+1,a+N+1,a[i]+C));
```
**优化**：二分查找的区间差即为目标元素个数

#### 3. [jins3599] ⭐⭐⭐⭐⭐ 
**核心思路**：双指针维护滑动窗口，线性时间统计匹配区间  
**亮点**：时间复杂度最优（O(n)），适合大数据量  
**核心逻辑**：
```cpp
int l=1, r1=1, r2=1;
for(l=1; l<=n; l++) {
    while(r1<=n && a[r1]-a[l]<=C) r1++;
    while(r2<=n && a[r2]-a[l]<C)  r2++;
    if(a[r2]-a[l]==C && a[r1-1]-a[l]==C)
        ans += r1 - r2;
}
```
**优势**：无需额外空间，仅需一次排序

---

### 关键技巧总结
1. **问题转换思维**：将减法关系转化为加法关系（A-C=B）
2. **哈希预存思想**：先统计所有数字出现次数，后续O(1)查询
3. **有序性利用**：排序后可通过二分/双指针大幅优化查询效率
4. **STL工具链**：善用lower_bound/upper_bound简化区间查询
5. **重复元素处理**：用乘法原理计算重复元素的组合数

---

### 拓展题目推荐
1. [P1102 A-B数对](https://www.luogu.com.cn/problem/P1102)（本题原型）
2. [P3067 Balanced Lineup](https://www.luogu.com.cn/problem/P3067)（双指针维护极值差）
3. [P1638 逛画展](https://www.luogu.com.cn/problem/P1638)（滑动窗口应用）

---

### 调试经验摘录
1. **数据溢出**："ans要开long long，否则第三个点会错"——[ysj1173886760]
2. **STL选择**："unordered_map比map快400ms"——[insprition]
3. **边界处理**："当C=0时需特殊处理，不能自己减自己"——[Cambridge]
4. **指针维护**："r1指向第一个大于目标的位置，r2指向第一个等于的位置"——[jins3599]

---
处理用时：56.71秒
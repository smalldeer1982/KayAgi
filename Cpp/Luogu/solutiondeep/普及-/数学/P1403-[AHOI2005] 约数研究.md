# 题目信息

# [AHOI2005] 约数研究

## 题目描述

科学家们在 Samuel 星球上的探险得到了丰富的能源储备，这使得空间站中大型计算机 Samuel II 的长时间运算成为了可能。由于在去年一年的辛苦工作取得了不错的成绩，小联被允许用 Samuel II 进行数学研究。

小联最近在研究和约数有关的问题，他统计每个正数 $N$ 的约数的个数，并以 $f(N)$ 来表示。例如 $12$ 的约数有 $1,2,3,4,6,12$，因此 $f(12)=6$。下表给出了一些 $f(N)$ 的取值：

| $N$    | $1$  | $2$  | $3$  | $4$  | $5$  | $6$  |
| ------ | ---- | ---- | ---- | ---- | ---- | ---- |
| $f(N)$ | $1$  | $2$  | $2$  | $3$  | $2$  | $4$  |

现在请你求出：

$$
\sum_{i=1}^n f(i)
$$

## 说明/提示

- 对于 $20\%$ 的数据，$N \leq 5000$；
- 对于 $100\%$ 的数据，$1 \leq N \leq 10^6$。



## 样例 #1

### 输入

```
3
```

### 输出

```
5
```

# AI分析结果



### 综合分析与结论
本题核心是计算约数个数前缀和，关键在于将问题转化为数学表达式 $\sum_{i=1}^n \lfloor \frac{n}{i} \rfloor$。最优解法为分块优化（复杂度 $O(\sqrt{n})$），普通遍历（$O(n)$）次优，筛法（$O(n \log n)$）效率最低。数学证明与分块优化是核心亮点。

---

### 高分题解推荐
#### 1. Kelin（⭐⭐⭐⭐⭐）
**关键亮点**：  
- 引入分块优化，将相同 $\lfloor n/i \rfloor$ 的区间一次性计算  
- 复杂度从 $O(n)$ 优化到 $O(\sqrt{n})$，可处理 $n \leq 10^{14}$  
- 代码简洁，包含跳跃式循环与区间计算  

**核心代码**：
```cpp
for(int i=1,j;i<=n;i=j+1) {
    j = n / (n / i); // 确定当前块的右端点
    ans += (n/i) * (j-i+1); // 累加该区间的贡献
}
```

#### 2. JustinRochester（⭐⭐⭐⭐⭐）
**关键亮点**：  
- 详细数学推导，通过交换求和顺序证明公式正确性  
- 提供C++和Python双版本代码，适合不同语言学习者  
- 强调公式的直观理解（约数的倍数统计）  

**代码片段**：
```cpp
int ans = 0;
for(int i=1; i<=n; i++) 
    ans += n/i; // 直接累加每个i的贡献
```

#### 3. ikka（⭐⭐⭐⭐）
**关键亮点**：  
- 严格的数学符号化证明，适合数学背景强的读者  
- 分块代码与数学理论结合，体现算法优化思路  

**代码片段**：
```cpp
for(int i=1,j; i<=n; i=j+1) {
    j = std::min(n, n/(n/i));
    ans += (j-i+1) * (n/i);
}
```

---

### 关键思路总结
1. **数学转换**：将约数个数和转换为统计每个数作为因子的出现次数，即 $\sum \lfloor n/i \rfloor$。  
2. **分块优化**：利用 $\lfloor n/i \rfloor$ 的相同值区间，减少重复计算，复杂度降至 $O(\sqrt{n})$。  

---

### 拓展与举一反三
- **同类型题目**：  
  - [P2261 [CQOI2007]余数求和](https://www.luogu.com.cn/problem/P2261)（分块优化应用）  
  - [P2424 约数和](https://www.luogu.com.cn/problem/P2424)（约数前缀和变式）  
  - [P6156 简单题](https://www.luogu.com.cn/problem/P6156)（结合莫比乌斯反演）  

- **算法套路**：  
  - 分块处理整除向下取整的求和问题  
  - 数论问题中交换求和顺序的技巧  

---

### 个人心得摘录
- **调试经历**：多篇题解提到最初尝试暴力枚举导致超时，通过观察样例或数学推导找到规律（如天权3940通过列表发现公式）。  
- **优化顿悟**：Kelin提到分块跳跃计算，避免重复计算相同值的区间，是典型的空间换时间策略。  
- **教训总结**：直接暴力枚举约数在 $n \geq 10^5$ 时不可行，必须寻找数学规律或高效算法。

---
处理用时：49.48秒
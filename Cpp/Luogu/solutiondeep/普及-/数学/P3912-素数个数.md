# 题目信息

# 素数个数

## 题目描述

求 $1,2,\cdots,N$ 中素数的个数。


## 说明/提示

对于 $40\%$ 的数据，$1 \le N \le 10^6$。

对于 $80\%$ 的数据，$1 \le N \le 10^7$。

对于 $100\%$ 的数据，$1 \le N \le 10^8$。


## 样例 #1

### 输入

```
10```

### 输出

```
4```

# AI分析结果



### 综合分析与结论
本题核心在于高效计算大范围（1e8）内的素数个数。各题解围绕时间与空间优化展开，主要思路包括：
1. **基础筛法**：埃氏筛（O(n log log n)）与线性筛（O(n)）的直接应用，但需处理内存限制
2. **空间优化**：通过bool数组压缩、分块处理、预处理等手段降低空间消耗
3. **数学优化**：利用数论性质跳过偶数、缩小筛法范围至sqrt(n)
4. **高阶算法**：Meissel-Lehmer、洲阁筛等亚线性算法（O(n^(2/3))级）突破传统筛法限制

### 高星题解推荐
#### 1. 大头（MEISSEL-LEHMER算法） ⭐⭐⭐⭐⭐
- **核心亮点**：实现O(n^(2/3))时间复杂度的黑科技算法，完美处理1e8数据（仅40ms级别）
- **关键技巧**：
  - 预处理N^(2/3)内素数
  - 分段计算不可被小质数整除的数
  - 递归求解剩余素数的贡献
- **代码片段**：
```cpp
int dp(int x,int y){
    if(x<=20000&&y<=50) return f[x][y];
    if(x==0||y==0) return x;
    if(1ll*pri[y]*pri[y]>=x&&x<N) return max(0,mn[x]-y);
    return dp(x,y-1)-dp(x/pri[y],y-1);
}
```

#### 2. Aleph1022（Min25筛） ⭐⭐⭐⭐
- **核心亮点**：通过构造积性函数实现高效质数计数
- **优化点**：
  - 离散化处理关键点（n/i的值）
  - 动态规划递推求解质数贡献
  - 时间复杂度O(n^(3/4)/log n)
- **关键结构**：
```cpp
inline int &id(long long x){
    return x <= lim ? le[x] : ge[n / x];
}
```

#### 3. 封禁用户（欧拉筛优化） ⭐⭐⭐⭐
- **实践价值**：给出线性筛模板的完整实现与调试经验
- **关键教训**：
  - 数组大小需精确计算（1e8对应约5.8e6素数）
  - 内存优化：bool数组标记代替int存储
- **核心代码**：
```cpp
for(int j=1;j<=cnt&&i*prime[j]<=n;j++){
    vis[i*prime[j]] = 1;
    if(i%prime[j]==0) break; // 关键优化点
}
```

### 关键思路总结
1. **空间压缩**：使用1bit标记代替int（8倍压缩），如`bool[1e8]`仅需约12MB
2. **预处理加速**：对前sqrt(n)素数预处理，剩余部分数学推导
3. **分块策略**：将n划分为N^(2/3)大小的块，分别处理不同范围的素数贡献
4. **动态规划优化**：通过递推公式减少重复计算，如洲阁筛的g数组设计

### 拓展练习
1. [P3383【模板】线性筛素数](https://www.luogu.com.cn/problem/P3383) - 筛法基础实现
2. [P3912 素数个数](https://www.luogu.com.cn/problem/P3912) - 直接应用本题高阶算法
3. [P1217 回文质数](https://www.luogu.com.cn/problem/P1217) - 筛法结合特殊性质判断

### 调试经验摘录
1. **数组越界**："开short int数组没过，bool类型才通过"（@不到前10不改名）
2. **常数优化**："register使最后一个点通过"（@起名真的很难）
3. **数学直觉**："大于sqrt(n)的合数必含小因子"（@Ge_er）

这些经验突显了算法选择与工程实现的平衡艺术，尤其在处理极限数据时，理论复杂度与实际常数因子均需考量。

---
处理用时：63.41秒
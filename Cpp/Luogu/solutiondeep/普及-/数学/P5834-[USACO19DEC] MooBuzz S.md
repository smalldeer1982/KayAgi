# 题目信息

# [USACO19DEC] MooBuzz S

## 题目描述

Farmer John 的奶牛们最近成为了一个简单的数字游戏“FizzBuzz”的狂热玩家。这个游戏的规则很简单：奶牛们站成一圈，依次从一开始报数，每头奶牛在轮到她的时候报一个数。如果一头奶牛将要报的数字是 $3$ 的倍数，她应当报 `Fizz` 来代替这个数。如果一头奶牛将要报的数字是 $5$ 的倍数，她应当报 `Buzz` 来代替这个数。如果一头奶牛将要报的数字是 $15$ 的倍数，她应当报 `FizzBuzz` 来代替这个数。于是这个游戏的开始部分的记录为：

`1, 2, Fizz, 4, Buzz, Fizz, 7, 8, Fizz, Buzz, 11, Fizz, 13, 14, FizzBuzz, 16`

由于词汇的匮乏，奶牛们玩的 FizzBuzz 中用`Moo` 代替了 `Fizz`、`Buzz`、`FizzBuzz`。于是奶牛版的游戏的开始部分的记录为：

`1, 2, Moo, 4, Moo, Moo, 7, 8, Moo, Moo, 11, Moo, 13, 14, Moo, 16`

给定 $N$，请求出这个游戏中第 $N$ 个被报的数。

## 说明/提示

关于部分分：

测试点 $1$ 为样例。

测试点 $2\sim 5$ 满足 $N\le 10^6$。

对于 $100\%$ 的数据，$1 \leq N \leq 10^9$

供题：Brian Dean

## 样例 #1

### 输入

```
4```

### 输出

```
7```

# AI分析结果



### 综合分析与结论
本题要求找出第N个既不是3的倍数也不是5的倍数的数。核心思路分为两类：  
1. **数学周期性解法**：利用3和5的最小公倍数15的周期性，每15个数中存在8个有效数，通过预处理前15个有效数并结合数学公式直接计算。时间复杂度O(1)。  
2. **二分法**：通过容斥原理计算候选数之前的有效数个数，二分答案。时间复杂度O(logN)。  

数学方法更高效，二分法更灵活。多数题解采用周期性思路，核心在于发现周期性规律并处理余数边界条件。

---

### 精选题解及评分

#### 1. 题解作者：Yellow_Lemon_Tree（★★★★★）  
**关键亮点**：  
- 直接打表周期性规律，代码简洁高效，时间复杂度O(1)。  
- 预处理前15个有效数，通过数学公式直接计算结果。  
**核心代码**：  
```cpp
int sum[9]={-1,1,2,4,7,8,11,13,16};
ans = (n/8)*15 + sum[n%8];
// 当n%8=0时，sum[0]=-1，保证公式正确
```

#### 2. 题解作者：rui_er（★★★★☆）  
**关键亮点**：  
- 明确推导周期性规律，处理余数为0的特殊情况。  
- 数组设计直观，直接对应余数位置。  
**核心代码**：  
```cpp
int a[8] = {14, 1, 2, 4, 7, 8, 11, 13};
ans = (n/8)*15 + a[n%8];
if (n%8 == 0) ans--; // 处理余数0
```

#### 3. 题解作者：Snow_Dreams（★★★★☆）  
**关键亮点**：  
- 从数学角度解释周期性原理，代码简洁且可读性强。  
- 通过预处理数组快速定位余数对应值。  
**核心代码**：  
```cpp
int a[8] = {1,2,4,7,8,11,13,14};
ans = (n-1)/8 *15 + a[(n-1)%8];
```

---

### 最优关键思路总结
**周期性数学公式**：  
1. 发现15为周期，每周期内8个有效数。  
2. 预处理前15个有效数组成数组。  
3. 公式：`ans = (n//8)*15 + table[n%8]`，处理余数为0的特殊情况。  

**实现技巧**：  
- 打表法快速定位余数对应值。  
- 利用整除和取余运算直接映射到周期性数组。  

---

### 拓展与举一反三
1. **类似题目**：  
   - [P1403](https://www.luogu.com.cn/problem/P1403)：约数研究（容斥与数学规律）。  
   - [P2926](https://www.luogu.com.cn/problem/P2926)：倍数统计（周期性或筛法）。  
   - [P1554](https://www.luogu.com.cn/problem/P1554)：梦中的统计（数字规律与分段处理）。  

2. **调试心得**：  
   - **余数边界**：当N为周期长度的整数倍时需特殊处理（如`n%8=0`时取数组首元素或调整计算）。  
   - **规律验证**：通过小规模数据验证周期性假设的正确性（如手动枚举前30个数）。  

---

### 推荐相似题目
1. **P1403 [AHOI2005]约数研究**  
   **考察点**：数学规律与分块计算。  
2. **P2926 [USACO08DEC]Patting Heads S**  
   **考察点**：倍数统计与筛法优化。  
3. **P2426 删数**  
   **考察点**：动态规划与周期性状态转移。

---
处理用时：117.47秒
# 题目信息

# [LSOT-1] 暴龙的土豆

## 题目背景

暴龙爱吃土豆。

## 题目描述

给定一个正整数 $n$。

每次操作可以选两个素数 $y,z$，其中要求 $z$ 是奇素数。

令 $x=y^z$，如果 $x$ 能除尽 $n$ 则计为一次有效操作，$n$ 变为 $\dfrac nx$。

现在需要你回答，对于 $n$ 最多能够进行多少次有效操作。

## 说明/提示

【样例解释】

对于样例一：$16$ 可以变成 $2^3 \times 2$，可以进行一次操作。但是 $9$ 只能变成 $3^2$，所以不能进行操作。

【数据范围】

**「本题采用捆绑测试」**

- $\texttt{Subtask 1(10 pts)：}1 \le\ n\le 10^2，1 \le\ T\le 10^2$；
- $\texttt{Subtask 2(20 pts)：}1 \le\ n\le 10^6，1 \le\ T\le 10^2$；
- $\texttt{Subtask 3(30 pts)：}1 \le\ n\le 10^{12}，1 \le\ T\le 10^2$；
- $\texttt{Subtask 4(40 pts)：}$无特殊限制。

对于 $100\%$ 的数据，满足 $1\le n\le 10^{18}$，$1\le T\le 10^2$。

## 样例 #1

### 输入

```
2
16
9```

### 输出

```
1
0```

## 样例 #2

### 输入

```
2
1327104
3623878656000```

### 输出

```
5
12```

# AI分析结果



### 综合分析与结论

各题解核心思路均为**贪心策略**：选择最小的奇素数 z=3，并尽可能多地分解 y³ 的形式。所有解法均基于以下关键点：
1. **z=3 最优**：因奇素数最小，最大化操作次数。
2. **无需显式筛素数**：枚举 y 时自动排除合数（其质因数已被处理）。
3. **质因数分解优化**：直接枚举 y 并统计 y³ 的整除次数。

### 高星题解推荐

#### 1. 作者：LuomuQDM (⭐⭐⭐⭐⭐)
**关键亮点**：  
- 代码极简，无预处理，直接枚举 y 并除尽 y³。  
- 正确性证明充分：合数 y 的质因数已被处理，无需额外判断。  
- 时间复杂度 O(T·1e6)，轻松通过 1e18 数据。  

**核心代码**：
```cpp
for(ll i=2; i*i*i<=n; i++){
    while(n%(i*i*i)==0) n/=i*i*i, ans++;
}
```
**实现思想**：枚举所有可能的 y，每次尽可能多地除以 y³。

#### 2. 作者：BotDand (⭐⭐⭐⭐⭐)
**关键亮点**：  
- 数学推导清晰，明确指出答案为各质因子次数除以3之和。  
- 代码简洁性与 LuomuQDM 相当，但注释更详细。  

**核心代码**：
```cpp
int y=2, ans=0, x=8;
for(; x<=n; y++){
    x = y*y*y;
    while(n%x==0) ans++, n/=x;
}
```
**实现思想**：动态计算 y³，避免重复计算立方值。

#### 3. 作者：qczrz6v4nhp6u (⭐⭐⭐⭐)
**关键亮点**：  
- 详细证明枚举合数 y 的正确性，加深理解。  
- 提供两种代码版本（筛素数与不筛）对比。  

**个人心得**：  
> "在枚举到 y 之前，其质因数已被处理，因此合数 y³ 无法整除剩余 n。这一发现极大简化了代码。"

### 最优思路与技巧总结

1. **贪心选择 z=3**：所有奇素数中最小的，确保每次分解尽可能小。  
2. **隐式筛法**：直接枚举 y，合数因质因数已被处理而自动跳过，无需显式判断素数。  
3. **动态立方计算**：避免预计算所有可能的 y³，减少内存占用。  

### 拓展练习推荐

1. **P2043 质因数分解**：练习质因数分解的基本应用。  
2. **P1069 细胞分裂**：类似的最优指数选择问题，需分解质因数后取最大比例。  
3. **P2426 砝码称重**：贪心策略与质因数分解的结合。  

---

**注**：本题解集体现了数论问题中「贪心策略」与「质因数分解」的经典结合，核心在于快速识别最优子结构（z=3）并利用隐式筛法优化枚举过程。

---
处理用时：55.63秒
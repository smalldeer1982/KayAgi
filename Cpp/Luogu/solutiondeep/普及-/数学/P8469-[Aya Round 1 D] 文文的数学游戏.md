# 题目信息

# [Aya Round 1 D] 文文的数学游戏

## 题目背景

在解决了上一题之后，琪露诺觉得自己仿佛就是天才。于是，射命丸文又给了她一道简单的数学题。

## 题目描述

给定长度为 $n$ 的整数序列 $a$，你需要构造一个长度为 $n$ 的整数序列 $b$ 满足对于所有 $1\le i\le n$，有 $1\le b_i \le a_i$。且 $\gcd(b_1,b_2,\cdots,b_n)$ 最大，其中 $\gcd$ 表示最大公因数。试求出能得到的最大值和取得最大值时，不同的数列 $b$ 的个数，对 $10^9+7$ 取模。

定义两个长度为 $L$ 的数列 $c,d$ 不同，当且仅当存在整数 $i(1 \le i \le L)$，使得 $c_i \ne d_i$。

## 说明/提示

### 样例 1 解释

注意到由于 $1\le b_1\le a_1=1$，因此 $b_1$ 必须要为 $1$，因此最大的 $\gcd$ 值只能为 $1$。在这个前提下，所有合法的 $b$ 如下：

- $\{1,1,1\},\{1,1,2\},\{1,1,3\},\{1,2,1\},\{1,2,2\},\{1,2,3\}$。

### 数据范围与约束

对于 $100\%$ 的数据，$1 \le n\le 10^5$，$1 \le a_i\le 10^9$。

本题附带一组大样例。

## 样例 #1

### 输入

```
3
1 2 3```

### 输出

```
1 6```

# AI分析结果



### 综合分析与结论
题目要求构造数组使得其GCD最大，并统计方案数。所有题解均指出最大值是数组的最小值，方案数为各元素除以最小值后的乘积取模。核心关键在于证明最大GCD的可行性及乘法原理的应用。

---

### 精选题解（评分≥4星）

#### 1. chen_zhe（★★★★★）
**关键亮点**  
- 严格数学证明最大值只能是数组最小值。
- 代码简洁高效，初始值处理合理，取模逻辑清晰。
- 明确说明乘积可能溢出，强调使用`long long`。

**核心代码**  
```cpp
int mgcd = 1 << 30; // 初始为极大值
for (int i=1; i<=n; i++) mgcd = min(mgcd, a[i]);
long long ans = 1;
for (int i=1; i<=n; i++) 
    ans = (ans * (a[i]/mgcd)) % mod;
```

#### 2. 落花月朦胧（★★★★☆）
**关键亮点**  
- 通过分解GCD性质简化问题，强调倍数关系。
- 使用自定义自动取模模板提升代码可维护性（但未展示模板可能影响可读性）。

**核心代码**  
```cpp
int mn = INF;
for (int x : a) mn = min(mn, x);
Z ans = 1; // Z为自动取模类型
for (int x : a) ans *= x / mn;
```

#### 3. xzy090626（★★★★☆）
**关键亮点**  
- 直接构造全部元素为最小值的思路直观。
- 代码简洁，强调边界条件（如初始值设为足够大的数）。

**核心代码**  
```cpp
int cnt = 1.1e9; // 初始值足够大
for (int i=1; i<=n; i++) cnt = min(a[i], cnt);
int ans = 1;
for (int i=1; i<=n; i++) ans = (ans * (a[i]/cnt)) % mod;
```

---

### 关键思路与技巧
1. **最大GCD的确定**：利用反证法证明最大值只能是数组最小值，确保至少存在一个元素等于该值。
2. **方案数计算**：利用乘法原理，每个位置的可选数为`a[i] / min_a`，需注意取模防止溢出。
3. **代码优化**：初始化最小值时采用极大值并逐个比较，避免排序或复杂操作。

---

### 拓展与同类题目
- **类似思维题**：求最大公约数约束下的构造问题（如全为某数的倍数）。
- **推荐题目**：
  1. [P1891 疯狂 LCM](https://www.luogu.com.cn/problem/P1891)（GCD与LCM结合）
  2. [P1447 能量采集](https://www.luogu.com.cn/problem/P1447)（二维GCD计数）
  3. [P2447 外星千足虫](https://www.luogu.com.cn/problem/P2447)（模运算与组合计数）

---

### 个人心得摘录
- **初始值陷阱**：`xzy090626`题解中强调初始值需足够大，避免漏掉实际最小值。
- **模板优化**：`落花月朦胧`通过自定义类型简化取模逻辑，提升代码可维护性。
- **边界验证**：所有题解均隐含对`a[i]`整除性的验证，确保方案数正确性。

---
处理用时：108.47秒
# 题目信息

# 「GMOI R1-T2」Light

## 题目背景

前置芝士：平面镜成像原理。

因为百度的不太清楚，所以大家有不懂的可以自行搜索，也可以看本题的样例解释。

## 题目描述

通道可以认为是一个无限长的坐标轴，在原点 $O$ 上有一盏灯，在坐标为 $-L$ 和 $R$ 的地方分别有两面镜子，这两个镜子构成了无尽的灯廊。

为什么说无尽呢？是因为这两面镜子上理论上能呈现无穷个灯的像。现在，请你求出这盏灯左边或右边第 $x$ 个像的坐标。

## 说明/提示

[样例 $1$ 解释](https://www.luogu.com.cn/paste/4g9o1uzz)

对于 $100\%$ 的数据 $1\le T\le 5\times 10^5$，$1\le L,R \le 10^7$，$1\le x \le 10^{10}$。

| 测试点 | $T$ | $L,R$ | $x$ | 分数 |
| :----------: | :----------: | :----------: | :----------: | :----------: |
| $1\sim3$ | $T=1$ | $1 \le L,R \le 10$ | $1 \le x \le 10$ | $15$ |
| $4\sim6$ | $T=1$ | $1 \le L,R \le 1000$ | $1 \le x \le 1000$ | $15$ |
| $7\sim11$ | $T \le 1000$ | $1 \le L,R \le 10^7$ | $1 \le x \le 10^4 $ | $25$ |
| $12\sim16$ | $T \le 10^5$ | $1 \le L,R \le 10^7$ | $1 \le x \le 10^9$ | $25$ |
| $17\sim20$ | $T \le 5 \times 10^5$ | $1 \le L,R \le 10^7$ | $1\le x \le 10^{10}$ | $20$ |

## 样例 #1

### 输入

```
2
3 5
L 1
R 1```

### 输出

```
-6
10```

# AI分析结果



### 综合分析与结论
本题核心在于通过观察镜像生成规律，推导出数学公式直接计算第x个像的坐标。关键思路是将问题分解为奇偶情况，利用平面镜交替反射的性质，将坐标表示为L和R的线性组合。最优解法时间复杂度O(1)，适合大数据量。

### 高星题解推荐
#### 1. 作者：Daidly（★★★★★）
**关键亮点**：
- 将奇偶情况合并处理，代码极度简洁。
- 利用整数运算直接计算周期部分，减少条件判断。
- 核心公式：`ans = x/2*(l+r)*2 + 奇数次补充项`，高效清晰。

**核心代码**：
```cpp
ans = x/2 * (l + r) * 2;
if (x & 1) ans += (opt == 'L' ? l : r) * 2;
cout << (opt == 'L' ? -ans : ans);
```

#### 2. 作者：喵仔牛奶（★★★★☆）
**关键亮点**：
- 公式推导清晰，直接给出通用数学表达式。
- 代码简洁，使用`(x+1)/2`和`x/2`计算系数。
- 正确处理负数输出，开启IO优化提升效率。

**核心代码**：
```cpp
if (opt == 'L') 
    cout << ((x + 1) / 2 * L - x / 2 * R) * 2 << '\n';
else 
    cout << ((x + 1) / 2 * R - x / 2 * L) * 2 << '\n';
```

#### 3. 作者：w9095（★★★★☆）
**关键亮点**：
- 通过详细列举像的位置，总结出直观的系数规律。
- 明确分奇偶讨论，代码易理解，适合新手学习。

**核心公式**：
```cpp
左边：-( (x+1)/2*2L + x/2*2R )
右边： (x+1)/2*2R + x/2*2L
```

### 关键思路总结
1. **镜像交替反射**：每个像由前一个像在对面镜子反射生成，形成周期性模式。
2. **奇偶分解**：第x个像的位置可分解为`ceil(x/2)`和`floor(x/2)`次L、R的线性组合。
3. **数学公式**：直接计算`2*(ceil(x/2)*R + floor(x/2)*L)`，避免模拟反射过程。

### 同类型题目推荐
1. [P1014 Cantor表](https://www.luogu.com.cn/problem/P1014) - 找二维数列规律。
2. [P1255 数楼梯](https://www.luogu.com.cn/problem/P1255) - 递推公式+高精度。
3. [P1032 字串变换](https://www.luogu.com.cn/problem/P1032) - 状态转移与规律寻找。

### 个人心得摘录
- **调试教训**：`long long`必不可少，`1e10 * 1e7`会爆int。（@zenght）
- **输入陷阱**：`cin`读字符需处理换行，建议用`scanf(" %c")`跳过空白。（@I_AK_CTSC）
- **思维顿悟**：将镜像序列视为L和R交替叠加的等差数列是解题关键。（@yszkddzyh）

---
处理用时：86.48秒
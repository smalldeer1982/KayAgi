# 题目信息

# 【模板】Floyd

## 题目描述

给出一张由 $n$ 个点 $m$ 条边组成的无向图。

求出所有点对 $(i,j)$ 之间的最短路径。

## 说明/提示

对于 $100\%$ 的数据，$n \le 100$，$m \le 4500$，任意一条边的权值 $w$ 是正整数且 $1 \leqslant w \leqslant 1000$。

**数据中可能存在重边。**

## 样例 #1

### 输入

```
4 4
1 2 1
2 3 1
3 4 1
4 1 1```

### 输出

```
0 1 2 1
1 0 1 2
2 1 0 1
1 2 1 0```

# AI分析结果

### 综合分析与结论
该题要求用Floyd算法求无向图所有点对间最短路径。此篇题解从原理推导到优化再到负权图拓展，讲解全面清晰。
1. **思路**：基于动态规划，通过逐步引入顶点来更新所有点对间最短路径。
2. **算法要点**：定义状态 \( f_{k, u, v} \) 表示只考虑编号不大于 \( k \) 的顶点和 \( u, v \) 自身时， \( u \) 到 \( v \) 的最短路，通过两种情况转移 \( f_{k,u,v} = \min(f_{k-1,u,v}, f_{k-1,u,k}+f_{k-1,k,v}) \)。
3. **解决难点**：
    - **空间优化**：利用滚动数组技巧，先将空间复杂度从 \( \Theta(n^3) \) 优化到 \( 2\Theta(n^2) \)，进一步优化到 \( \Theta(n^2) \)。
    - **负权图拓展**：无负圈负权图可直接用非负权图的Floyd算法；有负圈时，通过跑两遍Floyd算法对比结果判断点对是否受负圈影响。
4. **评分**：此篇题解思路清晰，对算法原理、优化及拓展讲解详细，代码实现思想阐述到位，可评5星。

### 所选的题解
- **作者**：一扶苏一 
- **星级**：5星 
- **关键亮点**：从动态规划角度详细推导Floyd算法，对空间优化逐步分析，对负权图情况分类讨论并给出解决办法。
- **重点代码及核心实现思想**：
```cpp
// 核心代码（最终优化形式）
for (int k = 1; k <= n; ++k) {
    for (int u = 1; u <= n; ++u) {
        for (int v = 1; v <= n; ++v) {
            g[u][v] = std::min(g[u][v], g[u][k] + g[k][v]);
        }
    }
}
```
核心实现思想是通过三层循环，以每个顶点 \( k \) 作为中间点，更新任意两点 \( u \) 和 \( v \) 之间的最短路径。

### 最优关键思路或技巧
1. **空间优化技巧**：利用滚动数组优化空间复杂度，且基于非负权图最短路不经过同一点两次的特性进一步优化空间占用。
2. **负权图处理思路**：对无负圈和有负圈的负权图分别讨论，通过跑两遍Floyd算法判断点对是否受负圈影响。

### 可拓展之处
同类型题可考察不同图结构（如有向图、带权图变种等）下的全源最短路问题。类似算法套路包括基于动态规划思想的多阶段决策优化，如在其他路径规划、资源分配等问题中应用类似的状态定义和转移思想。

### 推荐题目
1. **P1119**：[灾后重建](https://www.luogu.com.cn/problem/P1119)，涉及动态图的最短路问题，可结合Floyd思想解决。
2. **P3385**：[负环](https://www.luogu.com.cn/problem/P3385)，考察判断图中是否存在负环，与题解中负权图负圈判断相关。
3. **P2863**：[愤怒的小鸟](https://www.luogu.com.cn/problem/P2863)，需要通过状态压缩和动态规划求解，类似Floyd算法中状态定义与转移思想。

### 个人心得摘录及总结
无个人心得相关内容。 

---
处理用时：23.26秒
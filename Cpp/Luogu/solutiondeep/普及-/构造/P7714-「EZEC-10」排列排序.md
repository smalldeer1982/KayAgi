# 题目信息

# 「EZEC-10」排列排序

## 题目描述

给你一个长度为 $n$ 的排列 $p_1,p_2, \cdots ,p_n$。你需要把它排序。

每次可以花区间长度，即 $r-l+1$ 的代价，选择排列中的任意一段区间 $[l,r]$，并将 $[l,r]$ 从小到大排序。

现在你可以让他进行若干次这个操作，直到 $p$ 中元素的值从 $1$ 到 $n$ 按升序排序，即对于 $1$ 到 $n$ 的每一个 $i$，都有 $p_i=i$。

求问花的代价最少为多少？

## 说明/提示

【样例 $1$ 说明】

对于第一组数据，可选择区间 $[2,3]$ 进行排序。

对于第二组数据，可选择区间 $[1,3]$ 进行排序。

【数据规模与约定】

对于 $20\%$ 的数据，$n\leq 4$。

对于另 $30\%$ 的数据，$\sum n\leq5000$。

对于另 $10\%$ 的数据，$p_1=n$。

对于 $100\%$ 的数据，$1\le T,\sum n\le 10^6$。

## 样例 #1

### 输入

```
2
3
1 3 2
4
3 2 1 4```

### 输出

```
2
3```

# AI分析结果

### 综合分析与结论

本题的核心在于如何通过最少的代价将排列排序。各题解主要采用了贪心、双指针、区间标记等策略，重点在于如何高效地识别需要排序的区间并计算其代价。以下是对各题解的简要分析与评分：

1. **YYen (5星)**：采用双指针策略，通过维护区间最大值来识别需要排序的区间，思路清晰且代码简洁，时间复杂度为O(n)。
2. **Eason_AC (4星)**：贪心策略，通过判断区间是否为某种排列来确定是否需要排序，代码简洁但思路稍显复杂。
3. **Level_Down (3星)**：通过标记和遍历来识别需要排序的区间，思路较为直接但代码复杂度较高。
4. **__gcd (4星)**：通过引理证明单点的贡献，思路清晰但代码实现稍显复杂。
5. **orz_z (3星)**：采用差分数组标记需要排序的区间，思路新颖但代码实现不够简洁。
6. **Maxmilite (3星)**：通过标记已排序的元素来减少重复计算，思路直接但代码实现较为复杂。
7. **rfsfreffr (3星)**：通过寻找有序元素来优化排序区间，思路较为复杂且代码实现不够简洁。

### 所选高星题解

#### YYen (5星)
**关键亮点**：双指针策略，通过维护区间最大值来识别需要排序的区间，思路清晰且代码简洁。
**个人心得**：比赛时想到双指针策略，测试几组例子后直接提交AC，证明了该策略的有效性。

```cpp
int i = 1;
while (i <= n)
{
    if (a[i] == i) // 相同 
        i++;
    else // 不同 
    {
        int maxv = a[i];
        int j = i + 1;
        maxv = max(maxv, a[j]);
        while (maxv > j)
        {
            j++;
            maxv = max(maxv, a[j]);
        }
        ans += j - i + 1;
        i = j + 1;
    }
}
```

#### Eason_AC (4星)
**关键亮点**：贪心策略，通过判断区间是否为某种排列来确定是否需要排序，代码简洁。
**个人心得**：直接考虑正解，通过贪心策略最小化排序代价。

```cpp
int maxi = 0, ans = 0, l = 1;
for (int i = 1; i <= n; i++) {
    p[i] = Rint, maxi = max(maxi, p[i]);
    if (maxi == i) ans += (i - l + 1 != 1) * (i - l + 1), l = i + 1;
}
```

### 最优关键思路与技巧

1. **双指针策略**：通过维护区间最大值来识别需要排序的区间，时间复杂度为O(n)。
2. **贪心策略**：通过判断区间是否为某种排列来确定是否需要排序，最小化排序代价。
3. **区间标记**：通过标记已排序的元素来减少重复计算，优化时间复杂度。

### 可拓展之处

1. **类似算法套路**：双指针和贪心策略在区间问题中广泛应用，如区间覆盖、区间合并等。
2. **同类型题目**：可以尝试解决其他区间排序或区间覆盖问题，如区间调度、区间选点等。

### 推荐题目

1. **P1886 滑动窗口**：考察双指针和区间最值的维护。
2. **P1045 最大子段和**：考察贪心策略和区间和的计算。
3. **P1090 合并果子**：考察贪心策略和优先队列的使用。

### 个人心得总结

1. **调试经历**：在实现双指针策略时，需注意区间最大值的维护和指针的移动条件。
2. **踩坑教训**：在贪心策略中，需确保区间是否为某种排列的判断条件正确，避免遗漏或错误。
3. **顿悟感想**：通过双指针和贪心策略，可以高效解决区间排序问题，减少不必要的计算和复杂度。

---
处理用时：28.22秒
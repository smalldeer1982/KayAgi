# 题目信息

# 「DBOI」Round 1 DTTM

## 题目背景

张则雨和穆制程坐在天台上看着满天的星辰。在他们的世界，流行一种连接星星的活动。他们对此有一种浪漫的诠释：如果连不完，剩下的一颗星星就是身旁的人；如果连得完，那身边的人和自己都是星星。

## 题目描述

星空中有 $n$ 颗星星，第 $i$ 颗位于坐标 $(x_i,y_i)$。你需要把星星连接成满足张则雨的如下需求：

- 每一颗星星都是且仅是一条线段的端点，所有线段互不相交（包括端点）。
- 所有线段左右端点 $|x_l-x_r|$ 之和有最小值。 

然而张则雨有点笨，并不知道应该怎么连。穆制程知道你是地球上最聪明的人，于是告诉你 $n$ 颗星星的坐标，你需要输出连接方案或者报告无解。

## 说明/提示

样例 1 的方案如图：

![](https://s1.ax1x.com/2023/04/06/ppomH5q.png)

样例 2 的方案如图：

![](https://s1.ax1x.com/2023/04/06/ppomDDH.png)

**本题使用捆绑测试与子任务依赖。**

| $\rm Subtask$ | $n\leqslant$ | $(x,y)$ | 特殊性质 | 得分 | 子任务依赖 |
| :-----------: | :-----------: | :-----------: | :-----------: | :-----------: | :-----------: |
| $1$ | $10$ | $0\leqslant x,y\leqslant 20$ | 无 | $10$ | 无 |
| $2$ | $10^3$ | $0\leqslant x,y\leqslant10^3$ | 无 | $15$ | $1$ |
| $3$ | $10^3$ | $0\leqslant x,y\leqslant10^9$ | 无 | $15$ | $1,2$ |
| $4$ | $5\times10^5$ |$-10^9\leqslant x,y\leqslant10^9$  | $A$ | $5$ | 无 |
| $5$ | $5\times10^5$ | $-10^3\leqslant x,y\leqslant10^3$ | 无 | $20$ | $1,2$
| $6$ | $5\times10^5$ | $-10^9\leqslant x,y\leqslant10^9$ | 无 | $35$ | $1,2,3,4,5$


特殊性质 $A$：满足所有 $x_i$ 都相等。

保证对于 $100\%$ 的数据，$1\leqslant n\leqslant5\times 10^5$，$0\leqslant|x|,|y|\leqslant 10^9$ 且对于任意 $i\ne j$，有 $(x_i,y_i)\neq (x_j,y_j)$。

## 样例 #1

### 输入

```
4
1 3
2 2
2 1
3 4```

### 输出

```
2
1 4
2 3```

## 样例 #2

### 输入

```
6
1 5
2 3
2 4
2 5
2 -1
3 -3```

### 输出

```
2
1 3
4 6
2 5```

# AI分析结果

### 综合分析与结论

这些题解的核心思路基本一致，都是通过贪心策略，将星星按横坐标排序后，两两相邻的星星相连，以保证线段不相交且 $|x_l - x_r|$ 之和最小。主要难点在于如何证明这种贪心策略的正确性，以及如何处理无解情况（即 $n$ 为奇数时）。大多数题解都采用了结构体存储星星的坐标和编号，并通过自定义排序函数实现按横坐标和纵坐标排序。整体来看，这些题解的思路清晰，代码实现也较为简洁，但部分题解在证明线段不相交的部分稍显不足。

### 评分较高的题解

#### 1. 作者：Shunpower (赞：4)
- **星级**：5星
- **关键亮点**：详细证明了贪心策略的正确性，特别是如何处理线段不相交的情况。通过将 $x$ 坐标相同的点分组，并处理奇偶性，确保了线段不相交且 $|x_l - x_r|$ 之和最小。
- **核心代码**：
  ```cpp
  for (auto &v : pos) {
      sort(v.snd.begin(), v.snd.end());
      if (lst) now.eb(v.fst, v.snd.rbegin() -> snd), v.snd.pop_back(), lst = 0;
      if (v.snd.size() & 1) now.eb(v.fst, v.snd.rbegin() -> snd), v.snd.pop_back(), lst = 1;
      int len = v.snd.size();
      rep1(i, 0, len - 1) opt.eb(v.snd[i].snd, v.snd[i + 1].snd), ++i;
  }
  ```
- **个人心得**：通过将 $x$ 坐标相同的点分组处理，确保了线段不相交，且 $|x_l - x_r|$ 之和最小。

#### 2. 作者：ccg12345 (赞：1)
- **星级**：4星
- **关键亮点**：通过反证法证明了线段不相交的正确性，并引入了叉积的概念来判断线段是否相交，增强了证明的严谨性。
- **核心代码**：
  ```cpp
  bool cmp(mon a, mon b) {
      if(a.x == b.x) return a.y < b.y;
      return a.x < b.x;
  }
  ```
- **个人心得**：通过叉积判断线段是否相交，确保了线段不相交的正确性。

#### 3. 作者：Nuyoah_awa (赞：0)
- **星级**：4星
- **关键亮点**：通过将星星按横坐标排序后，两两相邻的星星相连，确保了线段不相交且 $|x_l - x_r|$ 之和最小。代码简洁明了，易于理解。
- **核心代码**：
  ```cpp
  for(int i = 1;i <= n;i += 2)
      ans += a[i + 1].x - a[i].x;
  ```
- **个人心得**：通过相邻星星相连，确保了线段不相交且 $|x_l - x_r|$ 之和最小。

### 最优关键思路与技巧

1. **贪心策略**：将星星按横坐标排序后，两两相邻的星星相连，以确保 $|x_l - x_r|$ 之和最小。
2. **无解处理**：当 $n$ 为奇数时，直接输出 `-1`，因为无法将所有星星两两相连。
3. **线段不相交的证明**：通过反证法或叉积等方法，证明相邻星星相连的线段不会相交。

### 可拓展之处

- **类似问题**：可以扩展到其他几何问题，如最小生成树、最近点对等，都可以通过类似的贪心策略解决。
- **算法优化**：在处理大规模数据时，可以考虑使用更高效的排序算法或数据结构来优化性能。

### 推荐题目

1. **P1257 平面上的最接近点对**：考察如何找到平面上距离最近的两个点，与本题的贪心策略类似。
2. **P3366 【模板】最小生成树**：考察如何通过贪心策略构建最小生成树，与本题的贪心思路相似。
3. **P3382 【模板】线段树**：考察如何通过线段树处理区间问题，与本题的线段处理思路相关。

### 个人心得总结

- **调试经历**：部分题解在实现过程中忽略了无解情况的处理，导致得分较低，提醒我们在实现算法时要全面考虑各种边界情况。
- **顿悟感想**：通过贪心策略，可以有效地解决类似的最优化问题，关键在于如何证明策略的正确性。

---
处理用时：35.72秒
# 题目信息

# [NOIP 2001 提高组] 一元三次方程求解

## 题目描述

有形如：$a x^3 + b x^2 + c x + d = 0$  这样的一个一元三次方程。给出该方程中各项的系数（$a,b,c,d$ 均为实数），并约定该方程存在三个不同实根（根的范围在 $-100$ 至 $100$ 之间），且根与根之差的绝对值 $\ge 1$。要求由小到大依次在同一行输出这三个实根(根与根之间留有空格)，并精确到小数点后 $2$ 位。

提示：记方程 $f(x) = 0$，若存在 $2$ 个数 $x_1$ 和 $x_2$，且 $x_1 < x_2$，$f(x_1) \times f(x_2) < 0$，则在 $(x_1, x_2)$ 之间一定有一个根。

## 说明/提示

**【题目来源】**

NOIP 2001 提高组第一题

## 样例 #1

### 输入

```
1 -5 -4 20
```

### 输出

```
-2.00 2.00 5.00
```

# AI分析结果

### 综合分析与结论
这些题解提供了多种求解一元三次方程的方法，主要分为暴力枚举、二分查找、公式法（盛金公式、卡尔丹公式）、迭代法（牛顿迭代法、割线法）等几类。
- **暴力枚举**：思路简单直接，通过遍历根的可能范围，根据函数值判断根的存在。优点是代码实现容易，缺点是效率较低，对于大规模数据可能超时。
- **二分查找**：利用函数的单调性和零点存在定理，在每个长度为 1 的区间内进行二分查找，效率较高，精度可控。
- **公式法**：直接使用数学公式求解方程，理论上可以得到精确解，但公式复杂，实现难度较大，且可能涉及复数运算和三角函数，存在精度问题。
- **迭代法**：通过不断迭代逼近方程的根，收敛速度较快，但需要计算函数的导数，对于复杂函数可能较难实现。

### 高评分题解
- **作者：北街的九命貓（5星）**
    - **关键亮点**：思路清晰，详细解释了二分查找的原理和实现步骤，代码注释丰富，可读性强。
    - **核心代码**：
```cpp
double fc(double x)
{
    return a*x*x*x+b*x*x+c*x+d;
}
int main()
{
    double l,r,m,x1,x2;
    int s=0,i;
    scanf("%lf%lf%lf%lf",&a,&b,&c,&d);
    for (i=-100;i<100;i++)
    {
        l=i; 
        r=i+1;
        x1=fc(l); 
        x2=fc(r);
        if(!x1) 
        {
            printf("%.2lf ",l); 
            s++;
        }
        if(x1*x2<0)
        {
            while(r-l>=0.001)
            {
                m=(l+r)/2;
                if(fc(m)*fc(r)<=0) 
                   l=m; 
                else 
                   r=m;
            }
            printf("%.2lf ",r);  
            s++;
        }
        if (s==3) 
            break;
    }
    return 0;
}
```
    - **核心思想**：枚举每个长度为 1 的区间，判断区间两端点函数值是否异号，若异号则在该区间内进行二分查找，直到满足精度要求。

- **作者：GGN_2015（4星）**
    - **关键亮点**：使用牛顿迭代法求解方程，提供了一种不同的思路，代码实现较为规范。
    - **核心代码**：
```cpp
struct func3
{
    double a,b,c,d;
    func3(double A=0,double B=0,double C=0,double D=0){a=A;b=B;c=C;d=D;}
    double operator()(double x){return ((a*x+b)*x+c)*x+d;}
    double dvt(double x){return (3.0*a*x+2.0*b)*x+c;}
};

void func3solve(func3 f,double st,double& val,double& sol)
{
    for(int i=1;!(abs(f(st))<1e-6) && i<=100;i++)
    {
        st=st-f(st)/f.dvt(st);
    }
    val=f(st);sol=st;
}
```
    - **核心思想**：定义函数结构体，实现函数求值和求导功能，使用牛顿迭代公式不断更新迭代点，直到满足精度要求。

### 最优关键思路或技巧
- **二分查找**：利用函数的单调性和零点存在定理，将搜索范围不断缩小，提高查找效率。
- **迭代法**：通过不断迭代逼近方程的根，避免了直接求解复杂方程的困难。

### 可拓展之处
- **同类型题**：求解高次方程、非线性方程的根，可使用类似的二分查找、迭代法等方法。
- **类似算法套路**：在处理区间内查找满足条件的解的问题时，可以考虑使用二分查找；对于求解方程的根的问题，可以尝试迭代法。

### 推荐题目
- P1163 银行贷款
- P1024 一元三次方程求解
- P1873 砍树

### 个人心得摘录与总结
- **作者：小菜鸟**：提到割线法是基于牛顿法的改进，用割线斜率代替导数，避免了求导的困难，但收敛速度比牛顿法略慢。在使用割线法时，要注意步长的选择，避免出现除以零的情况。
- **作者：cff_0102**：指出盛金公式虽然简便，但在考场中很难记住，暴力枚举是更可行的方法，对于数据范围较小的问题可以优先考虑。

---
处理用时：26.33秒
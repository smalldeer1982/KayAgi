# 题目信息

# [AHOI2005] 约数研究

## 题目描述

科学家们在 Samuel 星球上的探险得到了丰富的能源储备，这使得空间站中大型计算机 Samuel II 的长时间运算成为了可能。由于在去年一年的辛苦工作取得了不错的成绩，小联被允许用 Samuel II 进行数学研究。

小联最近在研究和约数有关的问题，他统计每个正数 $N$ 的约数的个数，并以 $f(N)$ 来表示。例如 $12$ 的约数有 $1,2,3,4,6,12$，因此 $f(12)=6$。下表给出了一些 $f(N)$ 的取值：

| $N$    | $1$  | $2$  | $3$  | $4$  | $5$  | $6$  |
| ------ | ---- | ---- | ---- | ---- | ---- | ---- |
| $f(N)$ | $1$  | $2$  | $2$  | $3$  | $2$  | $4$  |

现在请你求出：

$$
\sum_{i=1}^n f(i)
$$

## 说明/提示

- 对于 $20\%$ 的数据，$N \leq 5000$；
- 对于 $100\%$ 的数据，$1 \leq N \leq 10^6$。



## 样例 #1

### 输入

```
3
```

### 输出

```
5
```

# AI分析结果

### 综合分析与结论
这些题解主要围绕计算 $\sum_{i=1}^n f(i)$ 展开，其中 $f(i)$ 表示 $i$ 的约数个数。题解思路可分为数学推导、筛法和暴力枚举三类。

数学推导类思路是核心，通过分析发现 $1$ 到 $n$ 中以 $i$ 为约数的数的个数为 $\lfloor\frac{n}{i}\rfloor$，从而将问题转化为求 $\sum_{i=1}^n\lfloor\frac{n}{i}\rfloor$，复杂度为 $O(n)$，部分还通过分块优化到 $O(\sqrt{n})$。筛法类借鉴素数筛思想，枚举因子并更新其倍数的约数个数，复杂度为 $O(n\log n)$。暴力枚举类直接计算每个数的约数个数再求和，复杂度较高，易超时。

### 所选题解
- **Kelin（5星）**
    - **关键亮点**：思路清晰，不仅给出数学公式推导，还进行了分块优化，复杂度降为 $O(\sqrt{n})$，并提及更高复杂度的做法和拓展题目。
    - **个人心得**：无
    - **核心代码**
```cpp
#include<cstdio>
int n,ans;
int main(){
    scanf("%d",&n);
    for(int i=1,j;i<=n;i=j+1){
        j=n/(n/i);
        ans+=(n/i)*(j-i+1);
    }
    printf("%d",ans);
    return 0;
}
```
核心思想：利用 $\lfloor\frac{n}{i}\rfloor$ 相同的值进行分块计算，减少重复计算，提高效率。

- **ikka（4星）**
    - **关键亮点**：给出详细的数学证明，将原问题逐步转化为 $\sum_{d=1}^{n}\lfloor\frac{n}{d}\rfloor$，并采用分块求解，复杂度为 $O(\sqrt{n})$。
    - **个人心得**：无
    - **核心代码**
```cpp
#include <bits/stdc++.h>
long long ans;
int main() {
    int n;
    scanf("%d", &n);
    for (int i = 1, j; i <= n; i = j + 1) {
        j = std::min(n, n / (n / i));
        ans += (long long)(j - i + 1) * (n / i);
    }
    printf("%lld\n", ans);
    return 0;
}
```
核心思想：通过数学推导得到公式，再用分块算法优化计算过程。

- **JustinRochester（4星）**
    - **关键亮点**：对公式 $\sum_{i=1}^n f(i)=\sum_{d=1}^n\lfloor\frac{n}{d}\rfloor$ 进行详细证明，帮助理解原理，同时给出 C++ 和 Python 两种代码实现。
    - **个人心得**：无
    - **核心代码**
```cpp
#include<iostream>
using namespace std;
int main(){
    int n,ans=0;
    cin>>n;
    for(int i=1;i<=n;i++) ans+=n/i;
    cout<<ans;
}
```
核心思想：根据数学推导得到公式，直接进行循环计算。

### 最优关键思路或技巧
- **数学推导**：将原问题转化为求 $\sum_{i=1}^n\lfloor\frac{n}{i}\rfloor$，大大降低复杂度。
- **分块优化**：利用 $\lfloor\frac{n}{i}\rfloor$ 相同的值进行分块计算，减少重复计算，将复杂度从 $O(n)$ 优化到 $O(\sqrt{n})$。

### 可拓展之处
同类型题如求 $\sum_{i=1}^n g(f(i))$，其中 $g$ 是关于 $f(i)$ 的函数，可借鉴本题思路先求出 $f(i)$ 的规律，再进行计算。类似算法套路还有数论分块，可用于解决涉及整除和求和的问题。

### 推荐题目
- P1829 [国家集训队]Crash的数字表格 / JZPTAB：涉及数论分块和莫比乌斯反演。
- P2261 [CQOI2007]余数求和：可通过数论分块优化计算。
- P3935 Calculating：同样可以用数论分块解决。

### 个人心得摘录与总结
- **天权3940**：开始误认题目，暴力超时后尝试打表，最终受筛法启发得出正解，强调计算复杂度的重要性。
- **Mr_QwQ**：没想到数学解法，采用分块打表的临场方法通过题目，说明打表在一定情况下可解决问题。
- **visitor**：开始用暴力埃式筛法只能得30分，优化后通过，体现优化算法的重要性。

---
处理用时：29.75秒
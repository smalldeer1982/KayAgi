# 题目信息

# [蓝桥杯 2017 省 B] k 倍区间

## 题目描述

给定一个长度为 $N$ 的数列，$A_1,A_2, \cdots A_N$，如果其中一段连续的子序列 $A_i,A_{i+1}, \cdots A_j(i \le j)$ 之和是 $K$ 的倍数，我们就称这个区间 $[i,j]$ 是 $K$ 倍区间。

你能求出数列中总共有多少个 $K$ 倍区间吗？

## 说明/提示

时限 2 秒, 256M。蓝桥杯 2017 年第八届

## 样例 #1

### 输入

```
5 2
1  
2  
3  
4  
5  ```

### 输出

```
6```

# AI分析结果

### 综合分析与结论
这些题解的核心思路一致，均是利用前缀和与同余定理来解决 $k$ 倍区间问题。通过计算前缀和对 $k$ 取模的余数，统计相同余数出现的次数，再根据组合数公式计算 $k$ 倍区间的数量。各题解的区别主要体现在代码实现细节、思路阐述清晰度和优化程度上。

### 所选题解
- **作者：Steve_xh（5星）**
    - **关键亮点**：思路清晰，详细阐述了前缀和与同余定理的应用，代码简洁且有注释，对边界情况（从 0 开始遍历）有明确说明。
    - **核心代码**：
```cpp
#include<bits/stdc++.h>
#define int long long 
using namespace std;
int n,k,s[100005],ans=0,b[100005];
signed main(){
    cin>>n>>k;
    for(int i=1,t;i<=n;i++)
        cin>>t,s[i]=s[i-1]+t;
    for(int i=0;i<=n;i++)
        ans+=b[s[i]%k]++;
    cout<<ans;
    return 0;
}
```
    - **核心思想**：先计算前缀和数组 $s$，再遍历前缀和数组，统计每个余数出现的次数，同时累加满足条件的区间数量。

- **作者：liangbob（4星）**
    - **关键亮点**：思路分析详细，对同余定理的应用和组合数的计算有清晰解释，代码规范，对特殊情况（余数为 0）有详细说明。
    - **核心代码**：
```cpp
#include <iostream>
#include <map>
#define int long long
using namespace std;

map <int, int> mp; 

signed main()
{
    int n, k, ans = 0;
    cin >> n >> k;
    mp[0] = 1; 
    for(int i = 1;i <= n;i++)
    {
        int x;
        cin >> x;
        ans += (x % k); 
        mp[ans % k]++; 
        ans %= k;
    }
    int cnt = 0;
    for(int i = 0;i < k;i++) cnt += (mp[i] * (mp[i] - 1)) / 2; 
    cout << cnt << endl;
    return 0;
}
```
    - **核心思想**：使用 `map` 记录每个余数出现的次数，计算前缀和并取模，最后根据组合数公式计算满足条件的区间数量。

- **作者：Vct14（4星）**
    - **关键亮点**：思路简洁明了，代码简洁高效，对同余定理的应用和桶的使用有清晰体现。
    - **核心代码**：
```cpp
#include<bits/stdc++.h>
using namespace std;
#define int long long

int c[100002]={1};

signed main(){
    int n,k;
    cin>>n>>k;
    int a,sum=0;
    for(int i=1; i<=n; i++){
        cin>>a;
        sum=(sum+a)%k;
        c[sum]++;
    }
    sum=0;
    for(int i=0; i<k; i++) sum+=c[i]*(c[i]-1)/2;
    cout<<sum;
    return 0;
}
```
    - **核心思想**：使用桶数组 $c$ 记录每个余数出现的次数，计算前缀和并取模，最后根据组合数公式计算满足条件的区间数量。

### 最优关键思路或技巧
- **前缀和优化**：通过计算前缀和，将区间和的计算复杂度从 $O(n)$ 降低到 $O(1)$。
- **同余定理应用**：利用同余定理，将判断区间和是否为 $k$ 的倍数转化为判断前缀和对 $k$ 取模的余数是否相等，从而减少不必要的计算。
- **桶计数**：使用桶数组记录每个余数出现的次数，方便后续根据组合数公式计算满足条件的区间数量。

### 拓展思路
同类型题或类似算法套路：
- 区间和能被某数整除的问题，可考虑使用前缀和与同余定理。
- 统计满足某种条件的区间数量问题，可通过记录关键信息（如余数）的出现次数，利用组合数公式计算。

### 推荐题目
- [P1115 最大子段和](https://www.luogu.com.cn/problem/P1115)：考察前缀和与动态规划，求最大连续子段和。
- [P2671 [NOIP2015 普及组] 求和](https://www.luogu.com.cn/problem/P2671)：涉及前缀和与同余的应用，求满足特定条件的三元组之和。
- [P3131 [USACO16JAN]Subsequences Summing to Sevens S](https://www.luogu.com.cn/problem/P3131)：与本题类似，求最长的区间和能被 7 整除的区间长度。

### 个人心得摘录与总结
- **作者：chenhaotian0219**：提到要注意开 `long long` 避免答案溢出，以及 $S_0$ 要放到桶里，即 `book[0]` 初始化为 1。总结：在处理类似问题时，要注意数据范围和边界情况。
- **作者：huangruiheng0217**：指出要注意用合适的数据类型存储，$0$ 的数量要特判，还可进行空间优化，不用开数组存储前缀和。总结：做题时要考虑数据类型、特殊情况和空间优化。 

---
处理用时：31.09秒
# 题目信息

# [蓝桥杯 2019 国 C] 数正方形

## 题目描述

在一个 $N \times N$ 的点阵上，取其中 $4$ 个点恰好组成一个正方形的 $4$ 个顶点，一共有多少种不同的取法？

由于结果可能非常大，你只需要输出模 $10^9 + 7$ 的余数。

![](https://luogu.oss-cn-hangzhou.aliyuncs.com/upload/vjudge_pic/lanqiao/2022_09_30_4ab10c5eb27e3dea37d8g-09.jpg)

如上图所示的正方形都是合法的。

## 说明/提示

对于所有评测用例，$2 ≤ N ≤ 10^6$。

蓝桥杯 2019 年国赛 C 组 G 题

## 样例 #1

### 输入

```
4```

### 输出

```
20```

# AI分析结果

### 综合分析与结论
这三道题解均围绕在 $N \times N$ 点阵中取 4 个点组成正方形的问题展开，核心思路都是将问题拆解，通过计算不同边长正方形的数量来得到最终结果。

Furina_Hate_Comma 从边长为 $i$ 的大正方形入手，分析顶点落在其边上的正方形情况，结合边长为 $n$ 的正方形中边长为 $i$ 的正方形个数得出结果。
small_john 通过确定满足条件的正方形个数和 $i\times i$ 正方形的个数，利用乘法原理推出公式。
wuhan1234 分别考虑正放和斜放的正方形，通过分析不同边长正放正方形中斜放正方形的数量，得出总的正方形个数公式。

### 所选题解
- **Furina_Hate_Comma（5 星）**
    - **关键亮点**：思路清晰，通过详细的数学推导，结合图形解释，使读者容易理解。代码简洁，注释提醒了关键易错点。
    - **个人心得**：“十年 OI 一场空，不开 long long 见祖宗！” 强调了在处理可能出现大数的问题时，使用 `long long` 类型的重要性。
- **small_john（4 星）**
    - **关键亮点**：思路简洁明了，通过举例和直观的分析得出公式，代码实现简单易懂。
- **wuhan1234（4 星）**
    - **关键亮点**：将正放和斜放的正方形分开考虑，分析过程详细，逻辑严谨。

### 重点代码及核心实现思想
#### Furina_Hate_Comma
```cpp
#include<bits/stdc++.h>
#define int long long
using namespace std;
signed main()
{
	int n,ans=0;
	cin>>n;
	n--;
	for(int i=1;i<=n;i++){
		ans=(ans+(n-i+1)*(n-i+1)*i)%1000000007;
	}
	cout<<ans;
	return 0;
}
```
核心思想：先将点阵边长转化为段数，然后遍历不同边长的正方形，计算每个边长的正方形中满足条件的正方形个数并累加，最后取模输出。

#### small_john
```cpp
#include<bits/stdc++.h>
#define int long long
using namespace std;
const int mod = 1e9+7;
int n,ans;
signed main()
{
	cin>>n;
	for(int i = 1;i<n;i++)
		ans+=i*(n-i)*(n-i),ans%=mod;
	cout<<ans;
	return 0;
}
```
核心思想：根据乘法原理，计算不同边长的正方形中满足条件的正方形个数并累加，过程中取模，最后输出结果。

#### wuhan1234
```c
#include <stdio.h>
#include <string.h>
#define mod 1000000007
int main()
{
    long long n,i;
	scanf("%lld",&n);
	long long ans=0;
	for (i=1;i<n;i++)
	{
		ans=(ans+(n-i)%mod*i%mod*i)%mod;
	}
	printf("%lld\n",ans);
	return 0;
}
```
核心思想：分别计算正放和斜放的正方形个数，将其合并得到总的正方形个数，计算过程中取模，最后输出结果。

### 最优关键思路或技巧
- **数学推导**：通过数学分析和推导，将问题转化为可计算的公式，避免了复杂的枚举和判断。
- **拆分问题**：将大问题拆分成多个小问题，分别计算不同情况的结果，最后合并得到最终答案。

### 可拓展之处
同类型题可考虑在不同形状的点阵（如三角形点阵、六边形点阵）中取点构成特定图形的问题，类似算法套路是通过数学分析找出规律，推导出计算公式。

### 洛谷题目推荐
- P1047 [NOIP2005 普及组] 校门外的树
- P1217 [USACO1.5] 回文质数 Prime Palindromes
- P1423 小玉在游泳

---
处理用时：25.12秒
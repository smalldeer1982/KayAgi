# 题目信息

# [语言月赛 202308] 小粉兔的元素反应

## 题目背景

![](https://cdn.luogu.com.cn/upload/image_hosting/bowegye7.png)

## 题目描述

在小粉兔所处的 Tivat（蒂瓦特）世界，有 $n$ 种元素。其中每种元素都可以蕴含一定的能量，且不同元素之间可以进行反应。

小粉兔现在掌握了这 $n$ 种元素。初始时，他所掌握的每种元素所蕴含的能量依次为 $a _ 1, a _ 2, \cdots, a _ n$。

不同元素之间的反应相关细节如下：

**反应条件**：对于任意两种元素 $i, j$（$i \neq j$），如果 $a _ i \times a _ j$ 是 $154$ 的倍数或 $147$ 的倍数，则二者可以进行反应。**元素不可与自身反应**。  
**反应结果**：包含这两种元素在内，所有的 $n$ 种元素所蕴含的能量均翻倍（即，所有 $a _ i$ 均变为原来的两倍）。  
**反应次数**：任意两种元素之间的反应次数均没有限制（即，同两种元素，在一直符合反应条件的情况下，可以反应多次）。

现在，小粉兔想要通过元素反应，使得自己手头的元素能量总和大于等于 $k$，从而打败 Tivat 世界最强大的怪兽——地文（Devil）。他现在想要知道，通过若干次（$0$ 次亦可）反应后，$a _ 1 + a _ 2 + \cdots + a _ n$ 是否可以大于等于 $k$。

## 说明/提示

### 样例 1 解释

首先，小粉兔可以选择 $143$ 与 $238$ 做乘法，结果为 $143 \times 238 = 34034 = 154 \times 221$。此时所有元素能量翻倍，变为 $286, 476, 348, 398$，而 $286 + 476 + 348 + 398 = 1508 \geq 1395$，因此小粉兔可以通过一次操作达到目的。

### 样例 2 解释

$677 + 293 + 859 + 751 = 2580 \geq 1441$，因此小粉兔不操作便可达到目的。

### 样例 3 解释

小粉兔无法引发任何元素反应，最终四能量相加 $< 1295$，因此小粉兔不可以达到目的。

### 数据规模与约定

设 $N = \sum n$，代表单个测试点内所有测试数据的 $n$ 的总和。设 $K$ 代表单个测试点内所有测试数据的 $k$ 的长度总和。

对于 $100\%$ 的数据，保证 $1 \leq T \leq 10 ^ 5$，$1 \leq n, N \leq 10 ^ 6$，$1 \leq k \leq 10 ^ {10 ^ 5}$，$1 \leq a _ i \leq 10 ^ 9$，$1 \leq K \leq 2 \times 10 ^ 6$。


| 测试点编号 | $n$ | $k$ | $a _ i$ |
| :----------: | :----------: | :----------: | :----------: | 
| $1$ | $= 1$ | $\leq 10 ^ 9$ | $\leq 10 ^ 9$ |
| $2 \sim 3$ | $\leq 100$ | $\leq 10 ^ {9}$ | $\leq 10 ^ 5$ |
| $4$ | $\leq 1000$ | $\leq 10 ^ {9}$ | $\leq 13$ |
| $5$ | $\leq 1000$ | $\leq 10 ^ {18}$ | $\leq 10 ^ 9$ |
| $6 \sim 7$ | $\leq 1000$ | $\leq 10 ^ {10 ^ 5}$ | $\leq 10 ^ 9$ |
| $8 \sim 10$ | $\leq 10 ^ 6$ | $\leq 10 ^ {10 ^ 5}$ | $\leq 10 ^ 9$ |


## 样例 #1

### 输入

```
1
4 1395
143 238 174 199```

### 输出

```
Yes```

## 样例 #2

### 输入

```
1
4 1441
677 293 859 751```

### 输出

```
Yes```

## 样例 #3

### 输入

```
1
4 1295
136 875 196 34```

### 输出

```
No```

# AI分析结果

### 综合分析与结论
该题主要考查对元素反应规则的模拟及相关性质的运用。题解通过分析题目性质，对输入数据进行分类处理，从而判断能否达到目标能量和。主要难点在于如何高效判断元素间是否能反应，避免 $O(n^2)$ 的时间复杂度。

### 所选的题解
- **作者：Maxmilite (赞：16)  星级：4星**
    - **关键亮点**：思路清晰，详细分析题目性质，针对不同情况分别处理。对 $k$ 的处理考虑到其大小范围，优化读入方式；通过记录能整除特定因子的元素数量，优化判断元素是否能反应的过程，避免暴力遍历带来的高时间复杂度。
    - **重点代码及核心思想**：
```cpp
// k 的处理
string s;
cin >> s;
if (s.length() < 17) {
    k = stoll(s);
} else {
    k = 1e16;
}
// 对 n = 1 的特殊处理
if (n == 1) {
    if (a[1] >= k) {
        cout << "Yes" << endl;
    } else {
        cout << "No" << endl;
    }
    continue;
}
// 记录能整除特定因子的元素数量
int cnt[15];
int ops[] = { 2, 3, 7, 11 };
memset(cnt, 0, sizeof(cnt));
for (int i = 1; i <= n; ++i) {
    for (int j = 0 ; j < 4; ++j) {
        if (a[i] % ops[j] == 0) {
            ++cnt[ops[j]];
        }
    }
}
// 判断能否反应
int flag = 0;
for (int i = 1; i <= n; ++i) {
    if (a[i] % 154 == 0 || a[i] % 147 == 0) { cout << "Yes" << endl; flag = 1; break; }
    if (a[i] % 21 == 0 && cnt[7] >= 2) { cout << "Yes" << endl; flag = 1; break; }
    if (a[i] % 49 == 0 && cnt[3]) { cout << "Yes" << endl; flag = 1; break; }
    if (a[i] % 77 == 0 && cnt[2]) { cout << "Yes" << endl; flag = 1; break; }
    if (a[i] % 14 == 0 && cnt[11]) { cout << "Yes" << endl; flag = 1; break; }
    if (a[i] % 22 == 0 && cnt[7]) { cout << "Yes" << endl; flag = 1; break; }
}
if (!flag)
    cout << "No" << endl;
```
核心思想是先根据 $k$ 的长度优化读入，对 $n = 1$ 单独判断，然后通过记录能整除 $2, 3, 7, 11$ 的元素数量，快速判断是否存在能反应的元素对。

### 最优关键思路或技巧
通过分析 $147$ 和 $154$ 的质因数分解，记录能整除其部分质因数组合的元素数量，从而优化判断元素间是否能反应的过程，将时间复杂度从 $O(n^2)$ 降低到 $O(n)$。

### 可拓展之处
同类型题可涉及其他基于条件判断的模拟场景，类似算法套路为分析条件背后的数学性质，通过记录关键信息优化判断过程。例如给定一些数字，根据特定运算规则（如两数之和为某数倍数等）判断能否通过若干次运算达到目标。

### 推荐题目
- [P1085 不高兴的津津](https://www.luogu.com.cn/problem/P1085)：简单的条件判断与模拟。
- [P1909 买铅笔](https://www.luogu.com.cn/problem/P1909)：根据不同购买方案的条件计算最优解，涉及条件模拟。
- [P1055 ISBN号码](https://www.luogu.com.cn/problem/P1055)：依据特定规则对输入数据进行校验和判断，属于条件模拟类型。 

---
处理用时：27.32秒
# 题目信息

# [NOIP 1999 普及组] 回文数

## 题目描述

若一个数（首位不为零）从左向右读与从右向左读都一样，我们就将其称之为回文数。

例如：给定一个十进制数 $56$，将 $56$ 加 $65$（即把 $56$ 从右向左读），得到 $121$ 是一个回文数。

又如：对于十进制数 $87$：

STEP1：$87+78=165$  
STEP2：$165+561=726$  
STEP3：$726+627=1353$   
STEP4：$1353+3531=4884$  

在这里的一步是指进行了一次 $N$ 进制的加法，上例最少用了 $4$ 步得到回文数 $4884$。

写一个程序，给定一个 $N$（$2 \le N \le 10$ 或 $N=16$）进制数 $M$（$100$ 位之内），求最少经过几步可以得到回文数。如果在 $30$ 步以内（包含 $30$ 步）不可能得到回文数，则输出 `Impossible!`。

## 样例 #1

### 输入

```
10
87
```

### 输出

```
STEP=4
```

# AI分析结果

• 综合分析与结论：
    - 思路：大部分题解采用模拟的思路，对给定的N进制数进行反复的加法操作直至得到回文数或达到30步限制。具体步骤为读入N进制数，判断是否为回文数，若不是则将其与反转后的数相加，重复上述过程。
    - 算法要点：涉及高精度加法（因数字达100位）、进制处理（2≤N≤10或N = 16）、回文数判断。在高精度加法中，将常规十进制加法的除10取余和除10进位改为除N取余和除N进位；回文数判断则通过比较数字与其反转后的结果是否一致。
    - 解决难点：主要难点在于高精度加法和16进制的处理。高精度加法需正确处理进位和数组操作；16进制需将字母（A - F）正确转换为数字并在运算后正确转换回字母形式。

    - 部分题解使用`unsigned long long`类型绕过高精度加法，但题目本意应使用高精度，此类做法不可取。

    - 综合来看，思路清晰、代码规范且遵循高精度解法的题解质量较高。

• 所选的题解：
  - 作者：Haishu (赞：507)  星级：5星
    - 关键亮点：思路清晰，强调标准化、模块化编程思维，将判断回文、数字翻转和加法操作分别写成函数，主程序负责组织调用，代码可读性和可维护性强。同时指出利用数据范围漏洞水题的不当性。
    - 个人心得：作者认识到早期题解利用数据范围漏洞的错误，进行自我检讨，强调应遵循题目本意解题。
    - 重点代码 - 核心实现思想：通过`add`函数实现高精度加法，`pd`函数判断回文数。在`add`函数中，先将数字反转存入`d`数组，再与原数组`c`相加，处理进位并调整数组长度；`pd`函数通过比较数组两端元素判断是否为回文。
```cpp
inline void add()
{
    for (int i = 0; i < l; ++i)
        d[l - i - 1] = c[i];
    l += 2;
    for (int i = 0; i < l; ++i)
    {
        c[i] += d[i];
        if (c[i] >= n) c[i + 1]++, c[i] -= n;
    }
    while (!c[l - 1]) --l;
}
inline bool pd()
{
    for (int i = 0; i < l; ++i)
        if (c[i]!= c[l - 1 - i]) return false;
    return true;
}
```
  - 作者：Strong_Jelly (赞：294)  星级：4星
    - 关键亮点：详细地对所需的高精度加法、高精度反转、高精度判断回文数和数组存高精度等操作分别进行讲解并给出代码实现，适合初学者理解。
    - 重点代码 - 核心实现思想：`add`函数实现高精度加法，将数组`a`和反转后的数组`b`逐位相加并处理进位；`turn`函数实现数组反转；`f`函数通过比较数组两端元素判断是否为回文。
```cpp
void add(int a[], int b[])//高精加 
{
    for(int i = 1; i <= l; i++)
    {
        a[i] += b[i];
        a[i + 1] += a[i] / n;//进位 
        a[i] %= n;
    }
    if(a[l + 1] > 0)//考虑从最高位进位到最高位的下一位 
    {
        l++;//长度++ 
    }
}
void turn(int a[])//反转数字 
{
    int j = 0;
    for(int i = l; i >= 1; i--)//反着存 
    { 
        w[++j] = a[i];//存到w数组里 
    }
}
bool f(int a[])//判断是否是回文数 
{
    int ln = l;
    int i = 1;//从两边判断
    int j = l;
    while(ln--)
    {
        if(ln < l / 2)//判一般就可以啦QAQ 
        {
            break;
        }
        if(a[i]!= a[j])
        {
            return false;//有一位不相等就不是回文数 
        }
        i++;
        j--;
    }
    return true;
}
```
  - 作者：hawa130 (赞：125)  星级：4星
    - 关键亮点：利用C++ STL自带的`reverse`函数进行字符串翻转，简化了代码实现，同时对高精度加法进行推广到N进制，并详细注释代码，便于理解。
    - 重点代码 - 核心实现思想：`hw`函数利用`reverse`函数反转字符串并判断是否与原字符串相等来判断回文；`add`函数将两个字符串进行N进制加法，先将字符串反转，转换为数组进行加法运算，处理进位后再转换回字符串。
```cpp
bool hw(string a) { //判断回文
    string s = a; //把 a 赋值给 s
    reverse(s.begin(), s.end()); //反转字符串 s
    return s == a; //判断 a 和 s 是否相等
}
string add(int k, string b) { //高精度加法过程，推广到 k 进制
    string a = b;
    reverse(a.begin(), a.end());
    int numa[maxN], numb[maxN], numc[maxN];
    int len = a.length(), lenc = 1;
    string ans;
    for (int i = 0; i < len; i++) {
        if (isdigit(a[i])) numa[len - i] = a[i] - '0'; 
        else numa[len - i] = a[i] - 'A' + 10; 
        if (isdigit(b[i])) numb[len - i] = b[i] - '0';
        else numb[len - i] = b[i] - 'A' + 10;
    }
    int x = 0;
    while (lenc <= len) {
        numc[lenc] = numa[lenc] + numb[lenc] + x;
        x = numc[lenc] / k; 
        numc[lenc] %= k; 
        lenc++;
    }
    numc[lenc] = x;
    while (numc[lenc] == 0) lenc--;
    for (int i = lenc; i >= 1; i--) ans += sixt[numc[i]];
    return ans;
}
```
• 最优的关键思路或技巧：
    - 模块化编程：将不同功能（如加法、回文判断、数字反转）封装成独立函数，使代码结构清晰，易于维护和理解。
    - 利用STL：如使用`reverse`函数简化字符串反转操作，减少代码量和出错概率。
    - 高精度加法的灵活应用：将常规十进制高精度加法的关键操作（取余和进位）根据题目要求修改为N进制，以适应不同进制的运算。

• 可拓展之处：同类型题通常围绕高精度运算、进制转换和数字特性判断（如回文数、水仙花数等）展开。类似算法套路是先确定数据存储方式（数组、字符串等），根据题目要求调整高精度运算规则，结合相应数字特性判断方法进行求解。

• 相似知识点的洛谷题目：
    - [P1601 A+B Problem（高精）](https://www.luogu.com.cn/problem/P1601)：纯粹的高精度加法题目，帮助巩固高精度加法的实现。
    - [P2661 信息传递](https://www.luogu.com.cn/problem/P2661)：涉及到模拟和对数据关系的处理，与本题模拟思路有相似之处。
    - [P1017 进制转换](https://www.luogu.com.cn/problem/P1017)：重点考察进制转换，是本题中进制处理部分的强化练习。

• 个人心得摘录与总结：
    - Haishu提到早期做题常忽视数据范围，利用题目漏洞水题是不可取的行为，应遵循题目本意解题，注重算法的正确性和规范性。这提醒学习者要培养严谨的解题态度，理解题目考察意图，避免投机取巧。 

---
处理用时：61.49秒
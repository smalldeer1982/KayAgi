# 题目信息

# [NOIP 2004 普及组] 火星人

## 题目描述

人类终于登上了火星的土地并且见到了神秘的火星人。人类和火星人都无法理解对方的语言，但是我们的科学家发明了一种用数字交流的方法。这种交流方法是这样的，首先，火星人把一个非常大的数字告诉人类科学家，科学家破解这个数字的含义后，再把一个很小的数字加到这个大数上面，把结果告诉火星人，作为人类的回答。

火星人用一种非常简单的方式来表示数字――掰手指。火星人只有一只手，但这只手上有成千上万的手指，这些手指排成一列，分别编号为 $1,2,3,\cdots$。火星人的任意两根手指都能随意交换位置，他们就是通过这方法计数的。

一个火星人用一个人类的手演示了如何用手指计数。如果把五根手指――拇指、食指、中指、无名指和小指分别编号为 $1,2,3,4$ 和 $5$，当它们按正常顺序排列时，形成了 $5$ 位数 $12345$，当你交换无名指和小指的位置时，会形成 $5$ 位数 $12354$，当你把五个手指的顺序完全颠倒时，会形成 $54321$，在所有能够形成的 $120$ 个 $5$ 位数中，$12345$ 最小，它表示 $1$；$12354$ 第二小，它表示 $2$；$54321$ 最大，它表示 $120$。下表展示了只有 $3$ 根手指时能够形成的 $6$ 个 $3$ 位数和它们代表的数字：


| 三进制数 | 代表的数字 |
|:-:|:-:|
| $123$ | $1$ |
| $132$ | $2$ |
| $213$ | $3$ |
| $231$ | $4$ |
| $312$ | $5$ |
| $321$ | $6$ |

现在你有幸成为了第一个和火星人交流的地球人。一个火星人会让你看他的手指，科学家会告诉你要加上去的很小的数。你的任务是，把火星人用手指表示的数与科学家告诉你的数相加，并根据相加的结果改变火星人手指的排列顺序。输入数据保证这个结果不会超出火星人手指能表示的范围。


## 说明/提示

对于 $30\%$ 的数据，$N \le 15$。

对于 $60\%$ 的数据，$N \le 50$。

对于 $100\%$ 的数据，$N \le 10000$。

noip2004 普及组第 4 题


## 样例 #1

### 输入

```
5
3
1 2 3 4 5
```

### 输出

```
1 2 4 5 3```

# AI分析结果

### 综合分析与结论
这些题解主要围绕将火星人手指排列表示的数加上给定数后得到新排列这一问题，采用了不同方法：
1. **变进制数法**：将全排列转化为变进制数进行加法运算，再转换回全排列。此方法思路新颖，代码相对简洁，但变进制数的转换理解有一定难度。
2. **模拟法**：按照人脑思维模拟增加过程，从后往前判断每个数位能否替换为更大未标记数，若能则替换并重新排序剩余数位。该方法直观易懂，但代码实现较繁琐。
3. **全排列函数法**：利用 `next_permutation` 函数直接求出经过指定次数全排列变化后的序列，简单直接，但使用库函数练习算法的意义不大。
4. **找规律法**：通过找规律，先找靠后数m使其后为连续下降序列，交换m与序列中最小但比m大的数，再交换序列中前后对称位置的数。思路巧妙，但规律较难发现和理解。
5. **DFS 剪枝法**：本想用 DFS 做全排列，但因手指位数大，利用加上的位数少及剪枝优化。代码实现复杂，且对数据规模要求较苛刻。
6. **手动全排列法**：手动模拟 `next_permutation` 工作，从当前排列开始做m次排列。代码复杂，且效率可能不高。

综合来看，变进制数法和模拟法在算法练习和思维拓展上更有价值，全排列函数法虽简单但对提升算法能力有限。

### 所选的题解
- **作者：yummy（5星）**
    - **关键亮点**：采用独特的变进制数法，将全排列与变进制数相互转换以实现加法，思路新颖，代码简洁高效。
    - **个人心得**：通过评论区纠正了示例部分小问题，并得知该方法叫康托展开。
    - **核心代码**：
```cpp
#include<bits/stdc++.h>
using namespace std;
int a[10005];
bool used[10005]={0};
int m,n;
int main()
{
    cin>>n>>m;
    for(int i=1;i<=n;i++)
    {
        cin>>a[i];
        int x=a[i];
        for(int j=1;j<=a[i];j++)
            x-=used[j];
        used[a[i]]=1;
        a[i]=x-1;
    }
    a[n]+=m;
    for(int i=n;i>0;i--)
    {
        a[i-1]+=a[i]/(n-i+1);
        a[i]%=n-i+1;
    }
    memset(used,0,sizeof(used));
    for(int i=1;i<=n;i++)
    {
        for(int j=0;j<=a[i];j++)
            if(used[j])
                a[i]++;
        cout<<a[i]+1<<" ";
        used[a[i]]=1;
    }
    return 0;
}
```
    - **核心实现思想**：先将输入的火星人手指排列转化为变进制数（通过计算每个数位在剩余可选数中的位置），然后将变进制数加上给定数并处理进位，最后再将处理后的变进制数转换回火星人手指排列（根据每个数位的值在剩余可选数中选择对应数字）。
- **作者：zhi_zhang（4星）**
    - **关键亮点**：模拟人脑增加数字的过程，思路直观易懂，代码注释详细，便于理解。
    - **核心代码**：
```cpp
#include<cstdio>
#include<iostream>
#include<algorithm>
#include<cmath>
#include<cstring>
using namespace std;
const int MAXN=10010;
int finger[MAXN];
int N,M;
int vis[MAXN];
int ad(int);
void prin();
int main()
{
	scanf("%d%d",&N,&M);
	for(int i=1;i<=N;i++)//输入 
	{
		vis[i]=1;
		scanf("%d",&finger[i]);
	}
	while(M--)//计算还剩多少步 
	{
		for(int i=N;i>=1;i--)//倒着进行判断 
		{
			int k=ad(finger[i]);
			if(k!=-1)//如果能够增加 
			{
				vis[finger[i]]=0;
				finger[i]=k;
				vis[k]=1;
				for(int j=i+1;j<=N;j++)//剩下的指头从小到大向后排序 
				{
					for(int p=1;p<=N;p++)//从小到大检索 
					{
						if(!vis[p])//如果p手指还没进入 
						{
							finger[j]=p;
							vis[p]=1;
							break;
						}
					}
				}
				break;
			}
			else//如果不能增加 
			{
				vis[finger[i]]=0;
			}
		}
	}
	prin();
	return 0;
}
int ad(int poi)//检索该手指 
{
	for(int i=poi+1;i<=N;i++)//向上搜索直到 
	{
		if(!vis[i])//搜索到还未入队的更大的数 
		{
			return i;//返回该数 
		}
	}
	return -1;//检索不到则返回-1
}
void prin()
{
	for(int i=1;i<=N;i++)
	{
		printf("%d ",finger[i]);
	}
	printf("\n");
}
```
    - **核心实现思想**：从后往前遍历手指排列，对于每个数位，判断是否存在更大的未标记数，若存在则替换该数位，并将剩余未标记数从小到大重新填充后续数位；若不存在则取消当前数位标记，继续向前搜索。重复此过程m次。

### 最优关键思路或技巧
变进制数法将全排列与变进制数结合，通过独特的转换方式简化加法运算，这种思维方式在处理一些与排列相关的数值运算问题时具有创新性和高效性。模拟法直观地模拟实际操作过程，对于理解问题本质和算法实现有很大帮助，在面对一些逻辑相对简单但步骤繁琐的问题时是一种可靠的方法。

### 同类型题或类似算法套路拓展
此类题目主要围绕全排列及其相关操作，类似套路包括利用全排列的性质进行计数、查找特定位置的排列等。例如在一些组合数学问题中，通过将问题转化为全排列问题，再利用全排列的算法求解。

### 相似知识点洛谷题目
1. **P1706 全排列问题**：输出n的全排列，可用于练习全排列的基本实现。
2. **P4931 情侣？给我烧了！（加强版）**：涉及到排列组合相关知识，与全排列概念有联系。
3. **P3187 [HNOI2007] 梦幻岛宝珠**：在动态规划基础上，结合一些排列组合思想，可锻炼对相关知识点的综合运用。 

---
处理用时：56.20秒
# 题目信息

# [NOIP 2016 提高组] 玩具谜题

## 题目背景

NOIP2016 提高组 D1T1

## 题目描述

小南有一套可爱的玩具小人，它们各有不同的职业。

有一天，这些玩具小人把小南的眼镜藏了起来。小南发现玩具小人们围成了一个圈，它们有的面朝圈内，有的面朝圈外。如下图：

![](https://cdn.luogu.com.cn/upload/image_hosting/0u7em9pi.png) 

这时 singer 告诉小南一个谜题：“眼镜藏在我左数第 $3$ 个玩具小人的右数第 $1$ 个玩具小人的左数第 $2$ 个玩具小人那里。”

小南发现，这个谜题中玩具小人的朝向非常关键，因为朝内和朝外的玩具小人的左右方向是相反的：面朝圈内的玩具小人，它的左边是顺时针方向，右边是逆时针方向；而面向圈外的玩具小人，它的左边是逆时针方向，右边是顺时针方向。

小南一边艰难地辨认着玩具小人，一边数着:

singer 朝内，左数第 $3$ 个是 archer。

archer 朝外，右数第 $1$ 个是 thinker。

thinker 朝外，左数第 $2$ 个是 writer。

所以眼镜藏在 writer 这里！

虽然成功找回了眼镜，但小南并没有放心。如果下次有更多的玩具小人藏他的眼镜，或是谜题的长度更长，他可能就无法找到眼镜了。所以小南希望你写程序帮他解决类似的谜题。这样的谜題具体可以描述为：

有 $n$ 个玩具小人围成一圈，已知它们的职业和朝向。现在第 $1$ 个玩具小人告诉小南一个包含 $m$ 条指令的谜題，其中第 $z$ 条指令形如“向左数/右数第 $s$ 个玩具小人”。你需要输出依次数完这些指令后，到达的玩具小人的职业。



## 说明/提示

**样例 1 说明**

这组数据就是【题目描述】中提到的例子。


**子任务**

子任务会给出部分测试数据的特点。如果你在解决题目中遇到了困难，可以尝试只解决一部分测试数据。

每个测试点的数据规模及特点如下表:

![](https://cdn.luogu.com.cn/upload/image_hosting/7su06u3r.png)

其中一些简写的列意义如下:

- 全朝内：若为 $\surd$，表示该测试点保证所有的玩具小人都朝向圈内；

- 全左数：若为 $\surd$，表示该测试点保证所有的指令都向左数，即对任意的 $1\leq z\leq m, a_i=0$；

- $s=1$：若为 $\surd$，表示该测试点保证所有的指令都只数 $1$ 个，即对任意的 $1\leq z\leq m,s_i=1$；

职业长度为 $1$：若为 $\surd$，表示该测试点保证所有玩具小人的职业一定是一个长度为 $1$ 的字符串。


## 样例 #1

### 输入

```
7 3
0 singer
0 reader
0 mengbier 
1 thinker
1 archer
0 writer
1 mogician 
0 3
1 1
0 2```

### 输出

```
writer```

## 样例 #2

### 输入

```
10 10
1 C
0 r
0 P
1 d
1 e
1 m
1 t
1 y
1 u
0 V
1 7
1 1
1 4
0 5
0 3
0 1
1 6
1 2
0 8
0 4```

### 输出

```
y```

# AI分析结果

### 综合分析与结论
这些题解均围绕玩具谜题这一模拟类型题目展开。思路上，基本都是先读取玩具小人的朝向和职业信息，再按指令模拟移动寻找最终位置的小人。算法要点在于根据小人朝向和指令方向确定移动方向，同时处理环形队列防止越界。解决难点主要是理清不同朝向与指令方向组合下的移动逻辑。

多数题解采用直接模拟的方式，时间复杂度为O(m)，空间复杂度为O(n)。其中eros1on题解使用异或简化判断逻辑；ywy_c_asm题解采用倍增算法，将时间复杂度优化到O(mlogn)，但代码复杂度增加。

综合质量来看，linhongzhao321、eros1on题解思路清晰，代码简洁，有一定优化，可评4星；ywy_c_asm题解虽实现了算法优化，但代码复杂，可读性稍差，可评3星。

### 所选的题解
- **linhongzhao321题解**：★★★★
    - **关键亮点**：指出数据量较大要用long类型；利用朝外向左与朝内向右方向一致简化模拟判断过程。
    ```c
    for (i = 0; i < m; ++i) {
        scanf("%ld%ld", &a, &s);        // 获取左右和序数
        if (er_dir[cur] == a)       // 向外朝左与向内朝右是一致的，反之亦然
        {
            s *= -1;
        }
        cur = (cur + n + s) % n;
    }
    ```
    - **核心思想**：根据当前小人朝向和指令方向，若二者相同则改变移动步数的符号，然后计算新位置并对总人数取模以保证在环内。
- **eros1on题解**：★★★★
    - **关键亮点**：运用异或基础知识简化判断逻辑，使代码更简洁。
    ```cpp
    for(int i=1;i<=m;i++){
        scanf("%d%d",&a,&s);
        ans=(ans+(a^out[ans]?s:n-s))%n,ans=(!ans?n:ans);
    }
    ```
    - **核心思想**：通过异或运算判断当前小人朝向与指令方向是否相同，若不同则按正常步数移动，相同则按反向步数移动，最后对总人数取模并处理边界情况。

### 最优关键思路或技巧
1. **利用方向一致性简化逻辑**：如linhongzhao321题解，发现朝外向左与朝内向右方向一致，通过改变移动步数符号简化模拟过程。
2. **运用异或简化判断**：eros1on题解利用异或特性，简洁判断小人朝向与指令方向关系，优化代码。

### 可拓展之处
此类题目属于模拟与环形数据结构结合的问题，类似套路可用于解决如约瑟夫环等问题。解题关键在于清晰梳理逻辑，处理好环形结构的边界条件。

### 相似知识点洛谷题目
1. **P1996 约瑟夫问题**：经典的环形数据结构模拟问题，通过模拟出圈过程求解。
2. **P2709 小B的询问**：涉及区间查询和数据模拟，需按要求模拟统计过程。
3. **P1036 [NOIP2002 普及组] 选数**：通过模拟选数过程，结合条件判断求解，锻炼模拟与逻辑判断能力。

### 个人心得摘录与总结
eros1on：原代码风格不佳，后稍作修改，运用异或知识使代码简洁。总结出可利用位运算等基础知识优化代码逻辑与简洁度。 

---
处理用时：28.77秒
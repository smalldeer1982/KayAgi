# 题目信息

# [USACO19FEB] Measuring Traffic B

## 题目描述

Farmer John 的农场边上的高速公路最近出现了引人注目的流量上升，或者至少 Farmer John 看起来是这样的。为了证实这件事，他打算用一组传感器测量公路上的车流量，每个传感器被用来测量一小段路面上的车流量的数值。

不幸的是，某一天经过牛棚的时候，Farmer John 被绊倒了，装有传感器的盒子掉进了一个巨大的奶缸，之后它们就不能正常工作了。比起之前可以产生一个精确的车流量读数，现在每个传感器只能输出一个可能结果的范围。例如，一个传感器可能会给出范围 $[7,13]$，表示在这段路面上的车流量不小于 $7$，并且不大于 $13$。

高速公路经过农场的这一段长 $N$ 英里，车辆仅从一个方向通过公路，从第 $1$ 英里驶向第 $N$ 英里。Farmer John 想要安装 $N$ 个传感器——每一个监测高速公路上 $1$ 英里长的路段。在其中某些路段上，有能够使得车辆进入高速公路的上匝道；在所有这样的路段上，Farmer John 会将传感器装在上匝道上，测量流入的（近似）车流量。在某些路段上有能够使得车辆离开高速公路的下匝道；在所有这样的路段上，Farmer John 会将传感器装在下匝道上。每一个路段包含至多一个匝道。如果在公路的一个路段上没有上匝道或下匝道，Farmer John就将传感器装在高速公路的主路上。

给定 Farmer John 的 $N$ 个传感器的读数，请求出在高速公路第 $1$ 英里之前和第 $N$ 英里之后车流量的最为准确的可能范围。这些范围应当与所有 $N$ 个传感器的读数相一致。 

## 说明/提示

### 样例解释 1

在这个例子中，路段 $2$ 和路段 $3$ 的读数组合在一起告诉我们通过这两个路段的车流量为范围 $[11,14]$ 之间的某个值，因为只有这个范围与两个读数 $[10,14]$ 和 $[11,15]$ 均一致。在第 $1$ 英里，恰有 $1$ 单位的车辆通过上匝道进入，所以在第 $1$ 英里之前，车流量一定在范围 $[10,13]$ 之内。在第 $4$ 英里，$2$ 单位到 $3$ 单位之间的车辆通过下匝道离开，所以这段路之后可能的车流量范围为 $[8,12]$。 

## 样例 #1

### 输入

```
4
on 1 1
none 10 14
none 11 15
off 2 3```

### 输出

```
10 13
8 12```

# AI分析结果

### 综合分析与结论
这些题解思路基本一致，都是通过正反两次遍历模拟来求解。正向遍历计算第N英里之后车流量范围，反向遍历计算第1英里之前车流量范围。对于每个路段，根据其类型（上匝道、下匝道、主路）对当前车流量范围的最小值和最大值进行相应更新，同时注意结果不能为负。

算法要点在于清晰区分不同路段类型对车流量范围的影响并正确更新范围。解决难点主要是理解反向遍历时上、下匝道操作需反向处理以及避免车流量范围出现负数。

从质量上看，多数题解思路清晰、代码可读性尚可，但在优化程度上都较为基础，没有特别突出的优化。整体没有题解能达到4星及以上。

### 通用建议与扩展思路
通用建议：在代码实现上，可以适当增加注释，使代码逻辑更清晰，尤其是对不同路段类型处理的部分。对于边界情况（如车流量范围为负）的处理可以增加注释说明原因。

扩展思路：此类题目属于区间范围模拟计算类型，类似的套路还可应用于有条件限制的数值范围推导问题，例如根据一系列条件推导某个变量的取值范围。同类型题可以增加路段类型，或者使路段间的影响关系更复杂，以增加难度。

### 相似知识点题目推荐
1. [P1085 不高兴的津津](https://www.luogu.com.cn/problem/P1085)：通过模拟日常生活中的事件来计算结果，考察基本的模拟能力。
2. [P1909 买铅笔](https://www.luogu.com.cn/problem/P1909)：根据不同购买方案的条件，模拟计算出最优购买方案，与本题根据不同条件处理数据类似。
3. [P5718 三角形分类](https://www.luogu.com.cn/problem/P5718)：通过对三角形边长的条件判断进行分类处理，和本题对不同路段类型分类处理思路相似。 

---
处理用时：14.66秒
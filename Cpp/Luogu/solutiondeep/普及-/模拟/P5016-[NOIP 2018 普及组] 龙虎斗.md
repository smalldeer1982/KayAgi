# 题目信息

# [NOIP 2018 普及组] 龙虎斗

## 题目背景

NOIP2018 普及组 T2

## 题目描述

轩轩和凯凯正在玩一款叫《龙虎斗》的游戏，游戏的棋盘是一条线段，线段上有 $n$ 个兵营（自左至右编号 $1 \sim n$），相邻编号的兵营之间相隔 $1$ 厘米，即棋盘为长度为 $n-1$ 厘米的线段。$i$ 号兵营里有 $c_i$ 位工兵。下面图 1 为 $n=6$ 的示例： 

![](https://cdn.luogu.com.cn/upload/pic/43224.png)    

轩轩在左侧，代表“龙”；凯凯在右侧，代表“虎”。 他们以 $m$ 号兵营作为分界， 靠左的工兵属于龙势力，靠右的工兵属于虎势力，而第 $m$ 号兵营中的工兵很纠结，他们不属于任何一方。    

一个兵营的气势为：该兵营中的工兵数$ \times $ 该兵营到 $m$ 号兵营的距离；参与游戏 一方的势力定义为：属于这一方所有兵营的气势之和。    
下面图 2 为 $n = 6,m = 4$ 的示例，其中红色为龙方，黄色为虎方：

![](https://cdn.luogu.com.cn/upload/pic/43225.png)  

游戏过程中，某一刻天降神兵，共有 $s_1$ 位工兵突然出现在了 $p_1$ 号兵营。作为轩轩和凯凯的朋友，你知道如果龙虎双方气势差距太悬殊，轩轩和凯凯就不愿意继续玩下去了。为了让游戏继续，你需要选择一个兵营 $p_2$，并将你手里的 $s_2$ 位工兵全部派往 兵营 $p_2$，使得双方气势差距尽可能小。 

 注意：你手中的工兵落在哪个兵营，就和该兵营中其他工兵有相同的势力归属（如果落在 $m$ 号兵营，则不属于任何势力）。

## 说明/提示

**样例 1 说明**   

见问题描述中的图 2。   
双方以 $m=4$ 号兵营分界，有 $s_1=5$ 位工兵突然出现在 $p_1=6$ 号兵营。 
龙方的气势为：   
$$2 \times (4-1)+3 \times (4-2)+2 \times (4-3) = 14$$  
虎方的气势为：   
$$2 \times  (5 - 4) + (3 + 5) \times (6 - 4) = 18$$  
当你将手中的 $s_2 = 2$ 位工兵派往 $p_2 = 2$ 号兵营时，龙方的气势变为： 
$$14 + 2 \times  (4 - 2) = 18$$  
此时双方气势相等。 
  
**样例 2 说明**   

双方以 $m = 5$ 号兵营分界，有 $s_1 = 1$ 位工兵突然出现在 $p_1 = 4$ 号兵营。  
龙方的气势为：   
$$1 \times  (5 - 1) + 1 \times  (5 - 2) + 1 \times  (5 - 3) + (1 + 1) \times  (5 - 4) = 11$$  
虎方的气势为：   
$$16 \times  (6 - 5) = 16$$    
当你将手中的 $s_2 = 1$ 位工兵派往 $p_2 = 1$ 号兵营时，龙方的气势变为：    
$$11 + 1 \times  (5 - 1) = 15$$    
此时可以使双方气势的差距最小。

**数据规模与约定**    


$1 < m < n$，$1 \le p_1 \le n$。   
对于 $20\%$ 的数据，$n = 3,m = 2, c_i = 1, s_1,s_2 ≤ 100$。    
另有 $20\%$ 的数据，$n ≤ 10, p_1 = m, c_i = 1, s_1,s_2 ≤ 100$。  
对于 $60\%$ 的数据，$n ≤ 100, c_i = 1, s_1,s_2 ≤ 100$。   
对于 $80\%$ 的数据，$n ≤ 100, c_i,s_1,s_2 ≤ 100$。  
对于 $100\%$ 的数据，$n≤10^5$,$c_i,s_1,s_2≤10^9$。 

## 样例 #1

### 输入

```
6 
2 3 2 3 2 3 
4 6 5 2 ```

### 输出

```
2```

## 样例 #2

### 输入

```
6 
1 1 1 1 1 16 
5 4 1 1```

### 输出

```
1```

# AI分析结果

• 综合分析与结论：这些题解的核心目标均是通过合理的计算，找出将 \(s_2\) 位工兵放置在哪个兵营能使龙虎双方气势差距最小。多数题解先预处理出双方初始气势，再通过不同方式确定 \(s_2\) 的最佳放置位置。部分题解采用暴力枚举所有兵营计算气势差的方式，时间复杂度为 \(O(n^2)\)，会超时；优化后的题解通过预处理双方气势，在枚举时直接计算新的气势差，将时间复杂度降为 \(O(n)\)。还有题解利用方程法直接计算出理论上的最佳位置，再根据实际情况进行处理。所有题解都强调了数据范围较大，需使用 `long long` 类型避免溢出。

所选的题解：
  - **作者：wxy_god (5星)**
    - **关键亮点**：思路清晰，不仅展示了暴力解法及超时原因，还逐步优化至 \(O(n)\) 算法，最后给出方程法解题，对每种方法的分析详细，代码注释丰富。
    - **个人心得**：分享了考场做题时先采用暴力解法超时，之后优化算法时因未开 `long long` 导致部分测试点错误的经历。
    - **重点代码 - 方程法核心实现**：
```cpp
    for(int i = 1; i <= n; i ++ ) {
        gap += (m - i) * a[i];
    }
    double dgap = gap;
    long long int ans;
    where = m + dgap / s2;
    if(where >= n) {
        ans = n;
    }
    else if(where <= 1)
        ans = 1;
    else {
        int iwhere = where;
        if(iwhere == where) ans = iwhere;
        else {
            long long ans1 = abs(gap + (m - iwhere ) * s2);
            long long ans2 = abs(gap + (m - iwhere - 1) * s2);
            ans = ans1 <= ans2? iwhere : iwhere + 1;
        }
    }
```
核心实现思想：先计算双方势力初始差值 `gap`，通过方程计算出理论放置位置 `where`，再根据 `where` 的不同情况（小于等于1、大于等于n、是整数、是小数）分别处理得到最终答案。
  - **作者：ykuouzf (5星)**
    - **关键亮点**：解法简洁高效，通过数学推导得出计算最佳放置位置的公式，直接计算出结果，避免了复杂的枚举过程，代码简短且逻辑清晰。
    - **重点代码 - 核心实现**：
```cpp
    for(int i=1;i<=n;i++) sum+=a[i]*(m-i);
    sum+=s*(m-p);
    ans=m+int(sum*1.0/k+0.5*(sum>0?1:-1));
    if(ans>n) ans=n;
    if(ans<1) ans=1;
```
核心实现思想：先计算出双方势力差值 `sum`，再根据公式计算出最佳放置位置 `ans`，最后对 `ans` 进行边界处理，确保其在 \(1\) 到 \(n\) 范围内。
  - **作者：犇犇犇犇 (4星)**
    - **关键亮点**：思路简单易懂，先计算出双方初始气势，根据双方气势大小判断弱势方，通过公式计算出理论上的最佳放置位置，再比较该位置及其相邻位置的气势差，得出最终答案，同时详细说明了边界处理和代码中的坑点。
    - **个人心得**：提到因未考虑编号最小的情况，在一个测试点上花费了10分钟调试。
    - **重点代码 - 核心实现**：
```cpp
    if(lo<hu) {
        p2=m-(hu-lo)/s2;
        p2=max(1,p2);
        p2=min(n,p2);
        if(p2>1 && (abs(lo+s2*(m-p2+1)-hu)<=abs(hu-lo-s2*(m-p2))))
            cout<<p2-1<<endl;
        else cout<<p2<<endl;
    } 
    else {
        p2=m+(lo-hu)/s2;
        p2=max(1,p2);
        p2=min(n,p2);
        if(p2<n && (abs(hu+s2*(p2+1-m)-lo)<abs(hu+s2*(p2-m)-lo)))
            cout<<p2+1<<endl;
        else cout<<p2<<endl;
    }
```
核心实现思想：根据双方气势大小计算出理论放置位置 `p2`，对 `p2` 进行边界处理，然后比较 `p2` 及其相邻位置的气势差，输出使气势差最小的位置。

**最优的关键思路或技巧**：通过预处理双方初始气势，避免重复计算，从而优化时间复杂度。部分题解利用数学推导得出直接计算最佳放置位置的公式，简化了计算过程，提高了效率。同时，在处理数据时要注意数据范围，使用合适的数据类型（如 `long long`）防止溢出。

**可拓展之处**：此类题目属于模拟与数学结合的问题，类似套路可应用于涉及双方力量对比、通过调整某一因素使差距最小化的场景。例如在资源分配、天平平衡等模型中，通过分析条件建立数学关系求解。

**相似知识点的洛谷题目**：
  - [P1080 国王游戏](https://www.luogu.com.cn/problem/P1080)：涉及贪心算法和高精度计算，与本题类似之处在于需要通过合理的计算和分析来优化某种结果。
  - [P1223 排队接水](https://www.luogu.com.cn/problem/P1223)：考查贪心策略，通过对数据的分析和计算得出最优方案，与本题在分析问题和寻找最优解的思路上有相似性。
  - [P1909 买铅笔](https://www.luogu.com.cn/problem/P1909)：通过比较不同购买方案的花费来找出最优解，和本题通过计算不同放置位置的气势差找最优解思路类似。 

---
处理用时：59.66秒
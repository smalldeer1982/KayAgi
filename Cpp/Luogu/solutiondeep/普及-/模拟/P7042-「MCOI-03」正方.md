# 题目信息

# 「MCOI-03」正方

## 题目背景

MC 中没有圆。

所以小 S 和小 Q 和小 U 和小 A 和小 R 和小 E 喜欢 Square。

## 题目描述

给定一个正方形，求有多少个正方形内的点满足与正方形四个顶点划分出来的四块面积的比为 $a:b:c:d$。四个数不分顺序。

比如如下图所示假设一个点 E 使得分成的四个三角形的面积之比为 $a:b:c:d$，那么这个点 E 就符合要求。因为不分顺序，所以分出来的比是 $d:b:a:c$ 也可以。但是点 E 不是唯一解，你要输出的是解的个数。

![](https://cdn.luogu.com.cn/upload/image_hosting/95llbbcx.png)

因为小 S 和小 Q 和小 U 和小 A 和小 R 和小 E 很喜欢询问，所以本题给定了 $q$ 组询问。

## 说明/提示

#### 数据规模与约定

对于 $20\%$ 的数据，$a=b=c=d$。    
对于 $100\%$ 的数据，$1 \le a,b,c,d \le 9 \times 10^{18}$，$1 \le q \le 100$，不保证 $a:b:c:d$ 为最简比，不保证 $a,b,c,d$ 为升序。

## 样例 #1

### 输入

```
3
1 3 3 1
2 4 7 8
2 3 1 4```

### 输出

```
4
0
8```

# AI分析结果

• 综合分析与结论：
    - 思路：多数题解先明确问题核心为根据面积比$a:b:c:d$判断正方形内满足条件的点的个数。通过分析三角形面积关系，利用正方形性质得出关键条件$a + d = b + c$（或其他组合等式）来判断解的存在性，再依据$a,b,c,d$的相等关系分类讨论解的个数。
    - 算法要点：先对输入的$a,b,c,d$排序（部分题解未排序但通过其他方式判断所有组合情况），然后根据$a + d = b + c$等条件判断是否有解，再根据$a,b,c,d$是否全相等、有两个相等或全不相等确定解的个数分别为1、4、8，无解则为0。
    - 解决难点：难点在于发现并证明$a + d = b + c$这一解存在的必要条件，以及理解不同相等关系下解的个数变化原因，如利用正方形的对称性质来确定点的个数。
    - 结论：各题解思路大致相同，主要差异在于代码实现的细节、思路阐述的清晰度以及对特殊情况的处理方式。

• 所选的题解：
  - 作者：Unordered_OIer (赞：27)，星级：5星
    - 关键亮点：思路清晰，先尝试常规设点列方程思路，发现困难后转换思路。通过作辅助线得出解存在的必要条件$a + d = b + c$，并结合正方形对称性质，按$a,b,c,d$大小关系分类讨论，逻辑严谨。代码简洁明了，注释清晰。
    - 个人心得：无
    - 重点代码核心实现思想：先读入数据并排序，根据$a + d = b + c$判断是否有解，再依次判断$a = d$、$a = b$等特殊情况确定解的个数并输出。
```cpp
//by HpyX
//never copy without permission

#include <bits/stdc++.h>
using namespace std;

typedef long long ll;
ll q,a[5];

int main() {
	cin >> q;

	while (q --) {
		for (int i = 1; i <= 4; i ++) cin >> a[i];
		sort(a + 1, a + 5);
		if (a[1] + a[4]!= a[2] + a[3]) puts("0");
		else if (a[1] == a[4]) puts("1");
		else if (a[1] == a[2]) puts("4");
		else puts("8");
	}

	return 0;
}
```
  - 作者：一只书虫仔 (赞：13)，星级：4星
    - 关键亮点：对每种情况的分析详细，通过图形辅助证明$a + b = c + d$的结论，并且对每种情况的点个数来源解释清晰，如通过列举不同排列说明答案为8的情况，对答案为4的情况也从重复解角度给出合理说明。
    - 个人心得：无
    - 重点代码核心实现思想：与上一题解类似，先判断$a + b = c + d$，再根据$a,b,c,d$的相等关系分类输出结果。
```cpp
//无完整代码，核心实现逻辑如下
// 假设已读入a,b,c,d
// 先判断无解情况
if (a + b!= c + d && a + c!= b + d && a + d!= b + c) {
    cout << 0 << endl;
} else {
    // 判断答案为1的情况
    if (a == b && b == c && c == d) {
        cout << 1 << endl;
    } else if (a == b || a == c || a == d || b == c || b == d || c == d) {
        cout << 4 << endl;
    } else {
        cout << 8 << endl;
    }
}
```
  - 作者：syf2008 (赞：4)，星级：4星
    - 关键亮点：通过画图直观展示四种情况，代码实现简洁，先对输入数据约分处理，再根据$a,b,c,d$的关系判断输出结果，对每种情况的判断条件明确。
    - 个人心得：无
    - 重点代码核心实现思想：读入数据后约分、排序，根据不同条件判断输出0、1、4、8。
```cpp
#include <bits/stdc++.h>
using namespace std;
long long a[4],sum;
int q;
int main()
{
	scanf("%d",&q);
	while(q--)
	{
	scanf("%lld%lld%lld%lld",&a[0],&a[1],&a[2],&a[3]);
	sum=__gcd(a[0],__gcd(a[1],__gcd(a[2],a[3])));
	a[0]/=sum;
	a[1]/=sum;
	a[2]/=sum;
	a[3]/=sum;
	sort(a,a+4);
	if(a[0]==a[1]&&a[1]==a[2]&&a[2]==a[3]&&a[3]==a[0])
	printf("1\n");
else if(a[0]+a[3]!=a[1]+a[2])
	printf("0\n");
else if(a[0]==a[1]||a[0]==a[2]||a[0]==a[3]||a[1]==a[2]||a[1]==a[3]||a[2]==a[3])
	printf("4\n");
else printf("8\n");
	}
}
```

• 最优关键思路或技巧：利用正方形性质，通过分析四个三角形面积关系得出$a + d = b + c$（或其他等价组合）这一判断解存在的关键条件，再结合正方形的对称性质对$a,b,c,d$不同相等关系进行分类讨论，确定解的个数。

• 可拓展之处：同类型题可涉及其他几何图形内点与顶点连线形成区域的面积比例问题，类似算法套路是通过分析图形性质得出面积关系等式，再根据给定条件分类讨论。

• 相似知识点洛谷题目：
    - P1082 [NOIP2012 提高组] 同余方程，考察数论相关知识，与本题通过数学关系判断结果思路类似。
    - P2669 [NOIP2015 普及组] 金币，涉及简单的规律分析与分类讨论，和本题分类讨论思想相似。
    - P1304 哥德巴赫猜想，需要通过数学分析找到满足条件的数，与本题通过分析几何关系找满足条件的点类似。

• 个人心得摘录与总结：无。 

---
处理用时：83.63秒
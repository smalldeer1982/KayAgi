# 题目信息

# [CoE R5] 暴龙的白菜

## 题目背景

暴龙爱吃白菜。

## 题目描述

给定一个字符串，由 $1$ 个 $\texttt{1}$，$2$ 个 $\texttt{2}$，$3$ 个 $\texttt{3}$，$4$ 个 $\texttt{4}$，$5$ 个 $\texttt{5}$，$6$ 个 $\texttt{6}$，$7$ 个 $\texttt{7}$，$8$ 个 $\texttt{8}$，$9$ 个 $\texttt{9}$，$10$ 个 $\texttt{10}$……以此类推，依次拼接而成。

询问字符串第 $l$ 位到第 $r$ 位的数字之和。

## 说明/提示

**样例解释**

字符串为：

$$\texttt{12233344445555566666677777778888888899999999910101010101010101010}\cdots\cdots$$

对于第一组询问，第 $5$ 位到第 $9$ 位的数字之和为 $3+3+4+4+4=18$。

对于第二组询问，第 $46$ 位到第 $50$ 位的数字之和为 $1 + 0 + 1 + 0 + 1 = 3$。

------------

**数据范围**

**本题采用捆绑测试。**

- $\texttt{Subtask 1(10 pts)：}T=1$，$1\le l\le r\le 10$；
- $\texttt{Subtask 2(20 pts)：}1\le T\le 10$，$1\le l\le r\le 10^3$；
- $\texttt{Subtask 3(30 pts)：}1\le T\le 10^3$，$1\le l\le r\le 10^5$；
- $\texttt{Subtask 4(40 pts)：}$无特殊限制。

对于 $100\%$ 的数据，满足 $1\le T\le 10^5$，$1\le l\le r\le 10^6$。

## 样例 #1

### 输入

```
4
5 9
46 50
114 514
19 19810```

### 输出

```
18
3
1134
74924```

# AI分析结果

### 综合分析与结论
这些题解的核心思路均为预处理 + 前缀和。先根据题目规律构造出字符串或对应数组，再通过前缀和预处理，以实现查询区间和的 $O(1)$ 时间复杂度。

- **思路**：多数题解直接按题目描述的规律，依次添加数字构造字符串或数组，如 `1` 个 `1`，`2` 个 `2` 等。部分题解先分析出数据范围对应的数字边界，如到 `819` 时数列长度可达 $10^6$，从而优化预处理范围。
- **算法要点**：关键在于准确构造数据及利用前缀和数组。构造时需处理好数字的位数，如两位数要拆分为个位和十位依次添加；前缀和数组记录前 $i$ 位的数字总和，查询时通过 `sum[r] - sum[l - 1]` 得到区间和。
- **解决难点**：难点在于处理数字位数及优化预处理过程。如三位数及以上需正确拆分并添加到数据结构中；考虑到数据范围，要避免无意义的预处理以优化时间和空间复杂度。

### 所选的题解
- **作者：Shanganze (5星)**
    - **关键亮点**：思路清晰，代码简洁易懂。直接按题意模拟构造字符串，通过不同条件分支处理个位数、两位数、三位数的添加，再进行前缀和预处理。
    - **个人心得**：无
    - **核心代码**：
```cpp
int main(){
    int T=read();
    string a;
    for(int q=1;q<=1000;q++){//外层循环模拟当前应在字符串后连接的数字
        for(int w=1;w<=q;w++){//内层循环模拟该数应在字符串连接多少个。
            if(q<10)a+=char(q-1+'1');//个位数，直接转字符连接。
            else if(q<100)a+=char(q/10-1+'1'),a+=char(q%10-1+'1');//两位数，先连接十位，再连接个位。
            else if(q<1000)a+=char(q/100-1+'1'),a+=char(q/10%10-1+'1'),a+=char(q%10-1+'1');//三位数同理。
        }
    }
    for(int q=0;q<=1000001;q++){
        x[q+1]=x[q]+a[q]-'0';//前缀和预处理。
    }
    for(int q=1;q<=T;q++){
        int l,r;
        l=read();r=read();
        cout<<x[r]-x[l-1]<<endl;//输出时，因为要包含左端点，所以减去左端点的前一位。
    }
    return 0;
}
```
核心实现思想：通过两层循环构造字符串，根据数字位数不同进行字符拼接，然后对字符串进行前缀和预处理，查询时利用前缀和数组快速得到区间和。

- **作者：Trump__Biden (4星)**
    - **关键亮点**：代码简洁高效，同样采用预处理 + 前缀和思路。通过循环嵌套构造数据并同时更新前缀和数组，逻辑清晰。
    - **个人心得**：无
    - **核心代码**：
```cpp
int main(){
    for(int i=1;i<=1000;i++){
        for(int j=1;j<=i&&cnt<=1e6;j++){
            tmp=i,tot=0;
            while(tmp!=0){
                a[++tot]=tmp%10;
                tmp/=10;
            }
            for(int k=tot;k>=1;k--){
                cnt++;
                f[cnt]=f[cnt-1]+a[k];
            }
        }
    }
    scanf("%d",&t);
    while(t--){
        scanf("%d%d",&l,&r);
        printf("%d\n",f[r]-f[l-1]);
    }
    return 0;
}
```
核心实现思想：外层循环遍历数字，内层循环确定每个数字添加次数，通过取余和除法拆分数字，在添加数字同时更新前缀和数组，查询时利用前缀和差值得到区间和。

- **作者：Lagerent (4星)**
    - **关键亮点**：先通过程序分析出数据范围对应的数字边界为 `819`，优化了预处理范围。代码结构清晰，利用函数封装部分操作。
    - **个人心得**：无
    - **核心代码**：
```cpp
int q(int x) {
    int cnt = 0, t = x;
    memset(s, 0, sizeof s);
    while(t) {
        cnt ++ ;
        t /= 10;
    }
    per(i, cnt, 1) s[i] = x % 10, x /= 10;
    return cnt;
}

il void doit() {
    for(int i = last + 1; i <= res; i += w) {
        rep(j, 1, w) {
            b[i + j - 1] = s[j];
        }
    }
}

il void init() {
    res = 0, last = 0;
    rep(i, 1, 819) {
        w = q(i);
        res += i * w;
        doit();
        last = res;
    }
    rep(i, 1, res) sum[i] = sum[i - 1] + b[i];
}

int main() {
    init();
    int T;
    scanf("%d", &T);
    while(T -- ) {
        int l, r;
        scanf("%d%d", &l, &r);
        printf("%d\n", sum[r] - sum[l - 1]);
    }
    return 0;
}
```
核心实现思想：`q` 函数获取数字位数并拆分数字，`doit` 函数将拆分后的数字按规律存入数组，`init` 函数进行预处理并计算前缀和，查询时通过前缀和差值得到区间和。

### 最优关键思路或技巧
- **预处理范围优化**：通过分析数据范围确定预处理的边界，如 `Lagerent` 题解中确定到 `819` 时数列长度可达 $10^6$，避免不必要的计算，减少时间和空间复杂度。
- **数字拆分与构造**：处理多位数时，正确拆分数字并按规律添加到数据结构中，如 `Trump__Biden` 题解中通过取余和除法拆分数字并更新前缀和。

### 可拓展之处
同类型题常涉及有规律序列的区间查询问题，可通过找规律预处理 + 前缀和解决。类似算法套路还可应用于一些有固定模式生成的数据序列，如按特定倍数增长或循环规律生成的序列，通过预处理和前缀和优化查询效率。

### 推荐题目
- [P1115 最大子段和](https://www.luogu.com.cn/problem/P1115)：涉及到序列的区间和问题，可通过前缀和思想解决，与本题前缀和应用思路类似。
- [P3370 【模板】字符串哈希](https://www.luogu.com.cn/problem/P3370)：虽然是字符串哈希问题，但在处理字符串时也需要按一定规律对字符进行操作，与本题按规律构造字符串有相似之处。
- [P1387 最大正方形](https://www.luogu.com.cn/problem/P1387)：通过预处理数组记录状态，与本题预处理前缀和数组优化查询的思想类似。

### 个人心得摘录与总结
无。 

---
处理用时：121.38秒
# 题目信息

# “非常男女”计划

## 题目描述

近来，初一年的 `XXX` 小朋友致力于研究班上同学的配对问题（别想太多，仅是舞伴），通过各种推理和实验，他掌握了大量的实战经验。例如，据他观察，身高相近的人似乎比较合得来。

万圣节来临之际，`XXX` 准备在学校策划一次大型的 “非常男女” 配对活动。对于这次活动的参与者，`XXX` 有自己独特的选择方式。他希望能选择男女人数相等且身高都很接近的一些人。这种选择方式实现起来很简单。他让学校的所有人按照身高排成一排，然后从中选出连续的若干个人，使得这些人中男女人数相等。为了使活动更热闹，`XXX` 当然希望他能选出的人越多越好。请编写程序告诉他，他最多可以选出多少人来。


## 样例 #1

### 输入

```
9
0 1 0 0 0 1 1 0 0
```

### 输出

```
6```

# AI分析结果

### 综合分析与结论
这些题解主要围绕如何高效找出男女人数相等的最长连续子序列展开。多数题解采用前缀和思想，将男生设为1，女生设为 - 1，通过记录前缀和出现的位置，优化查找过程。部分题解采用暴力枚举结合剪枝的方式，但效率相对较低。整体来看，题解质量参差不齐，思路清晰度、代码可读性和优化程度各有差异。

### 所选4星及以上题解
1. **作者：AKB48 (5星)**
    - **关键亮点**：引入相对差概念，清晰阐述差值相等的两个位置间人数满足男女相等，为后续题解提供核心思路，表述简洁明了。
    - **重点代码**：无代码，但核心思想为设a[i]表示第i个位置男生人数 - 女生人数的差值，差值相等的两个位置间满足条件。
2. **作者：小小二逼兽 (4星)**
    - **关键亮点**：代码简洁高效，直接统计男女生数量差值x及对应最左最右位置，通过一次遍历解决问题。
    - **重点代码**：
```cpp
#include <bits/stdc++.h>
using namespace std;
int l[200010],r[200010],sum1,sum0,ans,n;
int main()
{
    cin>>n;
    for (int i=1;i<=n;i++){
        int x; cin>>x;
        sum1+=(x==1), sum0+=(x==0);
        int t=sum0 - sum1 + n;
        if (!l[t]&&t!=n) l[t]=i; else r[t]=i;
    }
    for (int i=0;i<=2*n;i++) ans=max(ans,r[i]-l[i]);
    cout<<ans<<endl;
    return 0;
}
```
    - **核心实现思想**：遍历输入，统计男女生数量差值t，记录差值t首次出现位置l[t]和最后出现位置r[t]，最后遍历所有差值，计算并更新最大长度。
3. **作者：Bring (4星)**
    - **关键亮点**：对前缀和思想阐述清晰，指出关键在于当两个端点前缀和相等时，对应区间为可行区间，代码通过优化减少空间使用。
    - **重点代码**：
```cpp
//This program is written by Brian Peng.
#pragma GCC optimize("Ofast","inline","-ffast-math")
#pragma GCC target("avx,sse2,sse3,sse4,mmx")
#include<bits/stdc++.h>
using namespace std;
#define Rd(a) (a=read())
#define Gc(a) (a=getchar())
#define Pc(a) putchar(a)
inline int read(){
	register int x;register char c(getchar());register bool k;
	while(!isdigit(c)&&c^'-')if(Gc(c)==EOF)exit(0);
	if(c^'-')k=1,x=c&15;else k=x=0;
	while(isdigit(Gc(c)))x=(x<<1)+(x<<3)+(c&15);
	return k?x:-x;
}
void wr(register int a){
	if(a<0)Pc('-'),a=-a;
	if(a<=9)Pc(a|'0');
	else wr(a/10),Pc((a%10)|'0');
}
signed const INF(0x3f3f3f3f),NINF(0xc3c3c3c3);
long long const LINF(0x3f3f3f3f3f3f3f3fLL),LNINF(0xc3c3c3c3c3c3c3c3LL);
#define Ps Pc(' ')
#define Pe Pc('\n')
#define Frn0(i,a,b) for(register int i(a);i<(b);++i)
#define Frn1(i,a,b) for(register int i(a);i<=(b);++i)
#define Frn_(i,a,b) for(register int i(a);i>=(b);--i)
#define Mst(a,b) memset(a,b,sizeof(a))
#define File(a) freopen(a".in","r",stdin),freopen(a".out","w",stdout)
#define N (200010)
#define P(a) (p[a+n])
int n,p[N],s,ans;
signed main(){
	Rd(n),Mst(p,-1),P(0)=0;
	Frn1(i,1,n)s+=read()?1:-1,~P(s)?ans=max(ans,i-P(s)):P(s)=i;
	wr(ans),exit(0);
}
```
    - **核心实现思想**：读入数据同时计算前缀和s，用数组p记录每个前缀和值首次出现位置，若当前前缀和已出现过，则更新最大区间长度。

### 最优关键思路或技巧
1. **前缀和优化**：将男女生分别设为1和 - 1，通过计算前缀和，利用前缀和相等确定满足男女数量相等的区间，避免暴力枚举所有区间。
2. **哈希记录位置**：使用数组或map等数据结构记录前缀和首次出现位置，在后续计算中快速获取对应位置，从而高效计算满足条件的最长区间。

### 可拓展思路及同类型题
1. **同类型题**：此类题目核心是通过转化问题为前缀和相等的区间查找，可拓展到类似的子序列统计问题，如在给定序列中找和为特定值的最长子序列。
2. **类似算法套路**：利用前缀和结合哈希表（或数组记录）优化查找过程，适用于许多需要统计子序列或子数组特征的问题。

### 洛谷相似知识点题目推荐
1. **P1308 统计单词数**：涉及字符串处理和前缀和思想，统计特定单词出现次数及首次出现位置。
2. **P2038 无线网络发射器选址**：需计算二维区域内信号强度总和，可利用前缀和优化计算。
3. **P1166 删数问题**：通过贪心策略结合前缀和思想，解决删除数字使结果最小的问题。

### 个人心得摘录及总结
1. **作者：KellyFrog**：调试过程中发现处理负数下标的问题，通过给前缀和加上较大数解决。总结为处理数组下标时要注意数据范围，避免RE等错误。
2. **作者：wjy2006**：二分枚举长度的初始思路未通过全部测试点，原因是二分原理在此题应用中有局限性。认识到二分法在某些情况下需根据题目条件灵活调整，不能盲目套用模板。 

---
处理用时：37.30秒
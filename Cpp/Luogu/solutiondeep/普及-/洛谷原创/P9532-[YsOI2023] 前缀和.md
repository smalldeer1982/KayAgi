# 题目信息

# [YsOI2023] 前缀和

## 题目背景

Ysuperman 模板测试的试机题。

小心立秋，小心秋丽。

## 题目描述

立秋有一个长度为 $n$ 的数组 $a$，所有数字都是正整数，并且除了其中第一个数字以外其它数字都等于前面所有数字的和。

例如，数组 $[1,1,2,4,8,16]$ 就有可能是立秋有的一个数组，因为除了第一个数字 $1$，后面的每个数字都是前面数字的和，例如：

- 第二个数字 $1=1$。
- 第三个数字 $2=1+1$。
- 第四个数字 $4=1+1+2$。
- 第五个数字 $8=1+1+2+4$。
- 第六个数字 $16=1+1+2+4+8$。 

现在立秋告诉了秋丽数字 $x$ 存在于这个数组中，秋丽希望知道 $a_n$ 最小会是多少，或者说整个数组最后一个数字最小有多少。

## 说明/提示

#### 样例 1 解释

- 第一组数据只有唯一可能的数组 $[2,2]$，所以答案为 $2$；
- 第二组数据有两种可能的数组，分别是 $[2,2,4]$ 和 $[1,1,2]$，所以答案为 $2$；
- 第三组数据有两种可能的数组，分别是 $[2,2,4,8]$ 和 $[1,1,2,4]$，所以答案为 $4$。

#### 样例 2 解释

- 第一组数据只有唯一可能的数组 $[1,1,2]$，所以答案为 $2$；
- 第二组数据有两种可能的数组 $[1,1,2]$ 和 $[2,2,4]$，所以答案为 $2$；
- 第三组数据有两种可能的数组 $[2,2,4]$ 和 $[4,4,8]$，所以答案为 $4$。

#### 数据范围

对于前 $30\%$ 的数据，满足 $x$ 不能被 $2$ 整除，或者说 $2$ 不是 $x$ 的一个因数，或者说 $x$ 是奇数。

另有 $30\%$ 的数据，满足 $x$ 可以被 $2^{n-2}$ 整除，或者说 $2^{n-2}$ 是 $x$ 的一个因数。

另有 $20\%$ 的数据，满足 $x\le 1000$，可以证明在这个数据范围下答案可以使用一个 `int` 类型变量存储。

对于 $100\%$ 的数据，满足 $1\le T\le 10^4$，$2\le n\le 20$，$1\le x\le 10^9$。

## 样例 #1

### 输入

```
3
2 2
3 2
4 2```

### 输出

```
2
2
4```

## 样例 #2

### 输入

```
3
3 1
3 2
3 4```

### 输出

```
2
2
4```

## 样例 #3

### 输入

```
3
2 6
3 6
4 6```

### 输出

```
6
6
12```

## 样例 #4

### 输入

```
3
3 3
3 6
3 12```

### 输出

```
6
6
12```

# AI分析结果

• 综合分析与结论：
    - 思路方面：各题解都基于数列规律解题，即除前两项相等外，从第三项起每一项是前一项的2倍。多数题解通过分析x的奇偶性或x能被2整除的次数来确定x在数列中的位置，进而求出\(a_n\)最小值。部分题解采用二分法，通过二分首项s推出末项。
    - 算法要点：利用数列规律，结合x的特性（奇偶性、因数2的个数）计算\(a_n\)。部分题解涉及预处理2的幂次方，以提高计算效率。
    - 解决难点：主要难点在于如何让x在数列中处于合适位置使\(a_n\)最小。通过分析x与数列中数字的整除关系及数列的倍数规律解决。

    - 整体来看，多数题解思路正确，但在代码可读性、优化程度上存在差异。

• 所选的题解：
  - 作者：2011FYCCCTA (赞：19)  星级：4星
    - 关键亮点：思路清晰，简洁明了地根据x的奇偶性分情况讨论，代码实现直接，易于理解。
    - 重点代码：
```cpp
if (x % 2) ans = x * pow(2, (n - 2));
else
{
    int tx = x, sum = 2;
    while (!(tx % 2) && sum < n) {tx /= 2; ++sum;}
    ans = tx * pow(2, (n - 2));
}
```
核心实现思想：若x为奇数，直接让x乘\(2^{n - 2}\)得结果；若x为偶数，不断除2直到为奇数，同时记录遍历数字个数，保证不超过n，最后用除后的奇数乘\(2^{n - 2}\)得结果。

  - 作者：hjqhs (赞：3)  星级：4星
    - 关键亮点：先明确数列通项公式，通过贪心思想确定让x一直除以2的次数，代码结构清晰。
    - 重点代码：
```cpp
int cnt = 0;
int ok = 0;
int tmp = x;
while (tmp % 2 == 0) {tmp /= 2; ++cnt;}
ok = min(n - 2, cnt);
ans[1] = x / pow(2, ok);
ans[2] = ans[1];
for (int i = 3; i <= n; ++i) {
    ans[i] = pow(2, i - 2) * ans[1];
}
```
核心实现思想：计算x能除以2的次数cnt，取cnt和n - 2的最小值ok，确定首项\(ans[1]\)，再根据通项公式计算数列各项，输出\(ans[n]\)。

  - 作者：AKPC (赞：3)  星级：4星
    - 关键亮点：推出数列通项公式后，通过计算x因数中2的个数确定x在数列中的最优位置，进而得出答案，思路巧妙。
    - 重点代码：
```cpp
int cla(int n) {
    int sum = 0;
    while (n % 2 == 0) n /= 2, sum++;
    return sum;
}
//...
int k = cla(x) + 1, g;
k + 1 >= n? g = 1 : g = 1 << (n - k - 1);
cout << g * x << '\n';
```
核心实现思想：cla函数计算x因数中2的个数，根据x因数中2的个数确定x在数列中的位置，进而得出\(a_n\)的值。

• 最优关键思路或技巧：
    - 思维方式上，利用数列从第三项起后一项是前一项2倍的规律，结合x的奇偶性或x因数中2的个数，贪心确定x在数列中的位置，从而得出\(a_n\)最小值。
    - 代码实现上，预处理2的幂次方可提高计算效率，如部分题解通过打表存储\(2^n\)的值。

• 可拓展之处：同类型题可考察类似数列规律结合特定条件求最值，或改变数列递推关系，如后一项为前一项的3倍等。类似算法套路为根据给定数列规律，结合条件确定关键元素位置，进而求解。

• 推荐题目：
    - P1028 [NOIP2001 普及组] 数的计算：通过对数字的操作构建数列，与本题类似，需找出规律求解。
    - P1909 买铅笔：根据不同购买方案结合需求数量求最小值，与本题贪心求最值思路类似。
    - P2678 [NOIP2015 普及组] 跳石头：通过二分法解决类似最值问题，与本题部分二分法解题思路相似。

• 个人心得：多数题解提到不开`long long`会导致结果错误，这是因为计算过程中数据可能超出`int`范围，提醒在处理较大数据时要注意数据类型选择。 

---
处理用时：30.74秒
# 题目信息

# [NOIP 2000 普及组] 税收与补贴问题

## 题目背景

每样商品的价格越低，其销量就会相应增大。现已知某种商品的成本及其在若干价位上的销量（产品不会低于成本销售），并假设相邻价位间销量的变化是线性的且在价格高于给定的最高价位后，销量以某固定数值递减。（我们假设价格及销售量都是整数）

对于某些特殊商品，不可能完全由市场去调节其价格。这时候就需要政府以税收或补贴的方式来控制。（所谓税收或补贴就是对于每个产品收取或给予生产厂家固定金额的货币）


## 题目描述

你是某家咨询公司的项目经理，现在你已经知道政府对某种商品的预期价格，以及在各种价位上的销售情况。要求你确定政府对此商品是应收税还是补贴的最少金额（也为整数），才能使商家在这样一种政府预期的价格上，获取相对其他价位上的最大总利润。

- 总利润 $=$ 单位商品利润 $\times$ 销量
- 单位商品利润 $=$ 单位商品价格 $-$ 单位商品成本（减去税金 或者 加上补贴）


## 说明/提示

### 数据范围及约定

保证输入的所有数字均小于 $10^5$。

### 样例解释（2023/6/22 更新）

如下图所示是输入样例所对应的价格变化图，横轴表示销售价格，纵轴表示销量。

![](https://cdn.luogu.com.cn/upload/image_hosting/21mhtm5i.png)

根据题意，$28$ 元是商品的成本。销售价格不应该低于 $28$ 元；当销售价格大于给出的价格的最大值 $31$ 元后，按照售价每提高一元，销量降低 $15$ 计算，例如当售价为 $33$ 元时，销量为 $110-15\times (33-31)=80$。在给出来的价位之间，销量呈线性变化。

当政府给该商品补贴 $4$ 元后，企业将该商品定价为 $31$ 元时，取得的利润为 $31-28+4=7$ 元，销量为 $110$ 件，总利润为 $7\times 110=770$ 元，是企业在所有定价下能够取得的最大的总利润。此时企业的售价为政府的期望售价，因此是一个合法方案。

## 样例 #1

### 输入

```
31
28 130
30 120
31 110
-1  -1
15```

### 输出

```
4
```

# AI分析结果

### 综合分析与结论

本题的核心在于通过税收或补贴调整商品价格，使得在政府预期价格下，商家的总利润最大。题解中主要分为以下几种思路：

1. **暴力枚举法**：通过枚举所有可能的税收或补贴值，计算每种情况下的总利润，找到符合条件的最小绝对值税收或补贴。这种方法简单直接，但效率较低，适合数据范围较小的情况。
  
2. **不等式求解法**：通过建立不等式，求解税收或补贴的范围，然后取绝对值最小的解。这种方法较为数学化，需要较强的数学推导能力，但效率较高。

3. **二分查找法**：利用税收或补贴与利润之间的单调性，通过二分查找快速定位最优解。这种方法结合了暴力枚举和不等式求解的优点，既保证了效率，又简化了实现。

4. **模拟法**：通过模拟税收或补贴的变化，逐步调整价格，找到最优解。这种方法直观易懂，但实现较为复杂。

### 所选高星题解

#### 1. **作者：Mitch谜团 (5星)**
- **关键亮点**：采用暴力枚举法，思路清晰，代码简洁易懂。通过线性插值补全价格-销量表，然后枚举所有可能的税收或补贴值，找到符合条件的最小绝对值解。
- **个人心得**：作者强调了计算机的暴力枚举能力，认为在某些情况下，暴力法是最直接有效的解决方案。

```cpp
for(j=1;j<=10000;j++) {
    max=-99999;
    for(k=1;k<=i;k++) {
        num=(a[k][1]-a[1][1]+j)*a[k][2];
        if(num>=max) {
            max=num;
            price=a[k][1];
            p=1;
        }
    }
    if(price==expect){cout<<j*p;return 0;}
}
```

#### 2. **作者：Ofnoname (4星)**
- **关键亮点**：采用不等式求解法，通过数学推导求解税收或补贴的范围，然后取绝对值最小的解。代码实现较为复杂，但效率较高。
- **个人心得**：作者详细解释了不等式的推导过程，强调了数学在算法中的重要性。

```cpp
for (register int i=r; i<=p; i++) {
    double ans=(d[x]*(x-r)-d[i]*(i-r))*1.0/(d[i]-d[x]);
    double g=d[i]-d[x];
    if (g>0) Max=min(Max,ans);
    else Min=max(Min,ans);
}
```

#### 3. **作者：dodo (4星)**
- **关键亮点**：采用模拟法，通过逐步调整税收或补贴，找到最优解。代码实现较为复杂，但思路清晰。
- **个人心得**：作者强调了模拟法的直观性，认为在某些情况下，模拟法是最容易理解的解决方案。

```cpp
for(int x=1;;x++){
    max=ans=0;
    for(int i=pc;i<=lc;++i) if((i-pc+x)*num[i]>=max) ans=i,max=(i-pc+x)*num[i];
    if(ans==ex){printf("%d",x);return 0;}
}
```

### 最优关键思路与技巧

1. **暴力枚举法**：在数据范围较小的情况下，暴力枚举法是最直接有效的解决方案。通过线性插值补全价格-销量表，然后枚举所有可能的税收或补贴值，找到符合条件的最小绝对值解。

2. **不等式求解法**：通过数学推导求解税收或补贴的范围，然后取绝对值最小的解。这种方法效率较高，但需要较强的数学推导能力。

3. **二分查找法**：利用税收或补贴与利润之间的单调性，通过二分查找快速定位最优解。这种方法结合了暴力枚举和不等式求解的优点，既保证了效率，又简化了实现。

### 可拓展之处

1. **类似问题**：可以扩展到其他需要调整参数以优化目标函数的问题，如资源分配、生产调度等。
  
2. **算法套路**：在解决类似问题时，可以考虑使用暴力枚举、不等式求解或二分查找等方法，根据具体问题的特点选择最合适的解决方案。

### 推荐题目

1. **P1024 一元三次方程求解**：考察二分查找法的应用。
2. **P1044 栈**：考察模拟法的应用。
3. **P1059 明明的随机数**：考察暴力枚举法的应用。

### 个人心得总结

- **调试经历**：在实现过程中，线性插值的准确性对结果影响较大，需要仔细检查插值公式的正确性。
- **踩坑教训**：在枚举税收或补贴时，需要注意边界条件的处理，避免漏解或重复计算。
- **顿悟感想**：在某些情况下，暴力枚举法虽然效率较低，但实现简单，容易理解和调试，是解决问题的有效手段。

---
处理用时：39.18秒
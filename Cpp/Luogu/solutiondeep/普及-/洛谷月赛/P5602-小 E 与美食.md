# 题目信息

# 小 E 与美食

## 题目背景

小 E 是一个热爱美食的高中生，但吃的太多会导致他身体不舒服，他想找到一个能让他最舒服的方案，快来帮帮他！

## 题目描述

小 E 有 $n$ 种美食可供选择，每种美食只能吃一次，第 $i$ 种美食有一个美味值 $a_i$，吃下一个美味值为 $a_i$ 的美食可以让小 E 的满足感提升 $a_i$。

但是小 E 的胃是有极限的，每吃下一个美食，他的饱腹感就会提升 $1$。

小 E 最后的舒适度是他的满足感的平方除以他的饱腹感，你的目标是求出他舒适度能达到的最大值。

## 说明/提示

**提示**

建议输出**至少 $8$ 位**有效数字。

**样例解释**

容易发现两种美食都吃是最优的，舒适度为 $\frac{(2+1)^2}{2} = 4.5$。

**数据范围**

对于 $30 \%$ 的数据，$n, a_i \le 20$。

对于 $50 \%$ 的数据，$n, a_i \le 2000$。

对于另 $15 \%$ 的数据，所有 $a_i$ 都相等。

对于 $100 \%$ 的数据，$1 \le n \le 3 \times 10^{5}$，$1 \le a_i  \le 10^6$。

## 样例 #1

### 输入

```
2
2 1```

### 输出

```
4.50```

# AI分析结果

### 综合分析与结论

本题的核心在于通过贪心策略选择美食，使得舒适度最大化。舒适度的计算公式为满足感的平方除以饱腹感，而满足感是所选美食的美味值之和，饱腹感是所选美食的数量。因此，贪心策略的核心是优先选择美味值最大的美食。

大部分题解都采用了以下思路：
1. **排序**：将美食按美味值从大到小排序。
2. **贪心选择**：从美味值最大的美食开始，依次选择美食，计算当前的舒适度，并更新最大值。
3. **优化计算**：为了避免平方计算时溢出，采用先除后乘的方式计算舒适度。

### 所选高质量题解

#### 1. 作者：lytqwq (赞：35)  
**星级**：★★★★★  
**关键亮点**：
- 思路清晰，代码简洁。
- 明确指出需要开`long long`以避免溢出，并优化了平方计算的方式。
- 代码中使用了`max`函数直接更新最大值，逻辑清晰。

**个人心得**：
- 作者提到“为什么我橙题都WA3遍啊QAQ”，反映了调试过程中的挫折感，提醒我们在处理数据范围时要注意细节。

**核心代码**：
```cpp
sort(a+1,a+n+1); // 排序
for(int i=n;i>=1;i--) { // 优先吃好吃的食物
    sum+=a[i];
    maxn=max(maxn,sum*1.0/(n-i+1)*sum); // 先除再乘
}
printf("%lf",maxn);
```

#### 2. 作者：Magallan_forever (赞：6)  
**星级**：★★★★  
**关键亮点**：
- 详细证明了贪心策略的正确性，解释了为什么选择前k大美食是最优的。
- 使用了前缀和优化，避免了重复计算。
- 代码中使用了`long long`和`double`来确保精度。

**核心代码**：
```cpp
sort(a+1,a+1+n,cmp); // 从大到小排序
for(int i=1;i<=n;++i) sum[i]=sum[i-1]+a[i]; // 前缀和
for(int i=1;i<=n;++i) maxn=max((double)sum[i]*sum[i]/i,maxn); // 计算最大值
printf("%lf",maxn);
```

#### 3. 作者：k2saki (赞：5)  
**星级**：★★★★  
**关键亮点**：
- 使用了`priority_queue`（优先队列）来实现自动排序，避免了手动排序的麻烦。
- 代码简洁，逻辑清晰，适合初学者理解贪心策略。

**核心代码**：
```cpp
priority_queue<int> q; // 大根堆
for(int i=1;i<=n;++i) q.push(a[i]); // 放进堆里
for(int i=1;i<=n;++i) {
    baofu++; // 饱腹感
    manzu+=q.top(); // 满足感
    q.pop(); // 移除出堆
    mx=max(mx,1.0*manzu*manzu/baofu); // 最大舒适感
}
printf("%.8f",mx);
```

### 最优关键思路与技巧

1. **贪心策略**：优先选择美味值最大的美食，确保每一步的选择都是当前最优的。
2. **排序优化**：通过排序或优先队列，快速找到美味值最大的美食。
3. **计算优化**：为了避免平方计算时溢出，采用先除后乘的方式计算舒适度。
4. **数据类型选择**：使用`long long`和`double`来确保计算精度，避免溢出和精度损失。

### 可拓展之处

- **类似题目**：可以考虑其他贪心策略的题目，如背包问题、任务调度问题等。
- **算法套路**：贪心算法通常用于求解最优化问题，关键在于如何定义“局部最优”并证明其全局最优性。

### 推荐题目

1. **P1090 [NOIP2004 提高组] 合并果子**（贪心+优先队列）
2. **P1223 [NOIP2006 提高组] 排队接水**（贪心+排序）
3. **P1803 凌乱的yyy / 线段覆盖**（贪心+区间调度）

### 个人心得总结

- **调试经历**：多位作者提到在处理数据范围时遇到了问题，提醒我们在编写代码时要注意数据类型的合理选择。
- **顿悟感想**：贪心策略的证明和优化是解题的关键，理解贪心的正确性有助于更好地应用该算法。

---
处理用时：36.81秒
# 题目信息

# 天选之人

## 题目背景

暑假期间，学校不提供午餐，Gnar 只好找伙计们一起点外卖。

尴尬的是，外卖很快送到却没人乐意去校门口拿，毕竟户外可是 $35\degree\!\text{C}$ 高温！此时 Gnar 想到了好主意：“我给一人捏了一张纸团，其中一张写有记号，不如我们抓阄决定，谁抽到带记号的谁去拿！”

于是 Gnar 连续拿了六天的外卖。

这可让他不服又委屈：“换个规则！一人准备三张纸团，五张有记号，每人抽三张，记号最多的去拿！”

Gnar 紧张地展开手中的纸团，两个记号赫然映在眼前。大伙们刚想放声大笑他的非酋运气，有人缓缓举起三张纸片说道：“我也抽到了两个记号……”

## 题目描述

好奇的 Gnar 想研究一般情况下抽到最多记号的人数。他给参与抓阄的 $n$ 人一人准备了 $m$ 张捏好的纸团，一共 $nm$ 张，其中恰好 $k$ 张提前写了记号。随后每个人在均匀打乱的纸团中各抽 $m$ 张。

一个人抽到最多的记号，当且仅当没有人抽到的记号比他还多。请你帮 Gnar 判断是否可能会**恰好** $\boldsymbol{p}$ **个人**抽到最多的记号。Gnar 喜欢追根问底，所以如果有可能，你还需构造每个人抽的纸团中分别有多少带记号、有多少不带记号。

形式化地，假设第 $i$ 个人抽到了 $x_i$ 张带记号的纸团和 $y_i$ 张不带记号的纸团，你的构造应满足：

- $x_i, y_i \ge 0$，$x_i + y_i = m$。
- $\displaystyle \sum_{i = 1}^{n} x_i = k$。
- **有且仅有** $\boldsymbol{p}$ **个互不相同**的 $j$ 使 $\displaystyle x_j = \max_{i = 1}^{n} \{x_i\}$。

## 说明/提示


**【样例解释 #1】**

样例给出了一种满足题述条件的构造。

**【样例解释 #2】**

不论如何，记号的分布从高到低只有三种情况：$\{3,0,0\}$，$\{2,1,0\}$，$\{1,1,1\}$，抽到最多记号的人数分别对应 $1$，$1$，$3$。因此无法构造 $p = 2$ 的方案。

----

**【数据规模与约定】**

**本题采用捆绑测试**。你必须通过 Subtask 中所有的测试点才能获得该 Subtask 的分数。

- Subtask #1 (15 points)：$n,m \le 8$。
- Subtask #2 (15 points)：$n,m \le 100$。
- Subtask #3 (20 points)：$n,m \le 10^5$。
- Subtask #4 (10 points)：$p = 1$。
- Subtask #5 (40 points)：无特殊限制。

对于所有的数据，保证 $1 \le p \le n \le {10}^5$，$1 \le m \le {10}^9$，$0 \le k \le n m$。

## 样例 #1

### 输入

```
3 3 5 2```

### 输出

```
YES
2 1
2 1
1 2```

## 样例 #2

### 输入

```
3 3 3 2```

### 输出

```
NO```

## 样例 #3

### 输入

```
3 3 5 3```

### 输出

```
NO```

# AI分析结果

### 综合分析与结论

本题的核心在于构造一种分配方案，使得恰好有 $p$ 个人拿到最多的带记号纸团。各题解的主要思路是通过贪心策略，先让 $p$ 个人尽可能多地拿到带记号的纸团，然后判断剩余的人是否能拿到比这 $p$ 个人少的纸团。难点在于如何合理分配剩余的纸团，并确保无解情况的判断。

### 所选题解

#### 1. 作者：Unordered_OIer (赞：36)
- **星级**: 5星
- **关键亮点**: 思路清晰，代码简洁，通过贪心策略直接构造解，并详细分析了无解情况。代码复杂度为 $O(n)$，效率高。
- **个人心得**: 作者通过直接构造最大值 $q$，并合理分配剩余纸团，确保了构造的正确性。同时，详细讨论了无解的情况，使得代码更加健壮。

```cpp
ll q = min(m, k / p);
if (k - q * p > (n - p) * (q - 1)) return puts("NO"), 0;

for (ll i = 1; i <= p; i++) x[i] = q, y[i] = m - q;

bool ff = 1;
ll rs = k - q * p;
for (ll i = p + 1; i <= n; i++) {
    if (ff == true && rs >= q - 1) x[i] = q - 1, rs -= q - 1;
    else if (rs == 0) x[i] = 0;
    else x[i] = rs, rs = 0, ff = 0;
    y[i] = m - x[i];
}
puts("YES");
for (ll i = 1; i <= n; i++) write(x[i]), putchar(' '), write_endl(y[i]);
```

#### 2. 作者：HanPi (赞：12)
- **星级**: 4星
- **关键亮点**: 通过将问题转化为图的形式，直观地展示了分配策略。代码实现较为清晰，且对特殊情况进行了处理。
- **个人心得**: 作者通过将问题转化为图的形式，使得分配策略更加直观，便于理解。同时，对 $n = p$ 的情况进行了特殊处理，确保了代码的鲁棒性。

```cpp
long long hp = mymin(k / p, m);
s = hp * p;
a = k - s;
h = a / other;
mod = a % other;
if (mod) each = (mod + other) / other;
other2 = other - mod;

if (hp <= h || hp <= h + each) {
    puts("NO");
    return 0;
}
puts("YES");
for (i = 0; i < p; ++i) printf("%lld %lld\n", hp, m - hp);
for (i = 0; i < mod; ++i) printf("%lld %lld\n", h + each, m - h - each);
for (i = 0; i < other2; ++i) printf("%lld %lld\n", h, m - h);
```

#### 3. 作者：Maxmilite (赞：8)
- **星级**: 4星
- **关键亮点**: 通过贪心策略直接构造解，并详细讨论了无解情况。代码实现较为简洁，且对特殊情况进行了处理。
- **个人心得**: 作者通过贪心策略直接构造解，并详细讨论了无解情况，确保了代码的正确性。同时，对 $n = p$ 的情况进行了特殊处理，使得代码更加健壮。

```cpp
tot = k;
t = k / p > m ? m : k / p;
tot -= t * p;
if (n == p) {
    if (t * p == k) {
        printf("YES\n");
        for (int i = 1; i <= n; ++i) printf("%lld %lld\n", t, m - t);
    } else printf("NO\n");
} else {
    if ((n - p) * (t - 1) < tot) printf("NO\n");
    else {
        printf("YES\n");
        for (int i = 1; i <= p; ++i) printf("%lld %lld\n", t, m - t);
        for (int i = p + 1; i <= n; ++i) {
            if (tot < (t - 1)) printf("%lld %lld\n", tot, m - tot);
            else printf("%lld %lld\n", t - 1, m - t + 1);
            tot -= t - 1;
            if (tot < 0) tot = 0;
        }
    }
}
```

### 最优关键思路或技巧

1. **贪心策略**: 先让 $p$ 个人尽可能多地拿到带记号的纸团，然后判断剩余的人是否能拿到比这 $p$ 个人少的纸团。
2. **无解判断**: 通过判断剩余纸团是否能被合理分配，确保无解情况的正确判断。
3. **特殊情况处理**: 对 $n = p$ 的情况进行特殊处理，确保代码的鲁棒性。

### 可拓展之处

- **类似问题**: 类似的问题可以扩展到其他分配问题，如资源分配、任务分配等，通过贪心策略和合理判断无解情况，可以解决类似的问题。
- **算法套路**: 贪心算法在分配问题中具有广泛的应用，通过合理构造解和判断无解情况，可以解决多种实际问题。

### 推荐题目

1. [P1004 方格取数](https://www.luogu.com.cn/problem/P1004)
2. [P1048 采药](https://www.luogu.com.cn/problem/P1048)
3. [P1060 开心的金明](https://www.luogu.com.cn/problem/P1060)

### 个人心得总结

- **调试经历**: 作者在调试过程中发现了一些特殊情况，如 $n = p$ 的情况，通过特殊处理确保了代码的正确性。
- **踩坑教训**: 在分配剩余纸团时，需要注意剩余纸团是否能被合理分配，否则会导致无解情况的误判。
- **顿悟感想**: 通过贪心策略直接构造解，可以简化问题，提高代码的效率。

---
处理用时：46.25秒
# 题目信息

# 「MCOI-06」Flight

## 题目描述

书虫需要移动他的[盾构机](https://www.luogu.com.cn/problem/P7569)。

书虫将 MC 空间抽象为二维平面。他的盾构机现在在 $(a,b)$，而书虫想把盾构机移动到 $(c,d)$。

书虫每一步可以将盾构机向东南西北任何方向行动。但是这盾构机有一个限制：相邻两步不能向同一个方向走！

给定 $(a,b)$ 和 $(c,d)$，请计算书虫最少需要几步将盾构机移动到终点。

求书虫的最少步数。可以证明，他永远可以到达终点。



## 说明/提示

#### 样例 1 解释

 - 对于第一组，最优策略为 $(-2,0)\rarr(-2,1)$。
 - 对于第二组，最优策略为 $(0,1)\rarr(1,1)\rarr(1,2)\rarr(2,2)\rarr(2,3)\rarr(3,3)$。
 - 对于第三组，最优策略之一为 $(-1,1)\rarr (0,1)\rarr(0,0)\rarr(1,0)\rarr(1,1)$。

#### 数据规模与约定

**本题采用捆绑测试。**

 - Subtask 1（29 pts）：$0\le a,b,c,d\le 3$。
 - Subtask 2（29 pts）：$a=c$。
 - Subtask 3（42 pts）：无特殊限制。

对于所有数据，$1\le T\le 10^5$，$|a|,|b|,|c|,|d|\le10^{18}$。

## 样例 #1

### 输入

```
3
-2 0 -2 1
0 1 3 3
-1 1 1 1```

### 输出

```
1
5
4```

# AI分析结果

### 综合分析与结论

本题的核心在于如何在二维平面上从起点 $(a,b)$ 移动到终点 $(c,d)$，且相邻两步不能走同一方向。通过分析，我们可以将问题转化为计算曼哈顿距离，并考虑方向限制对步数的影响。大多数题解都采用了类似的思路，即将问题分解为两个部分：先移动到与终点在同一行或列的位置，再处理剩余的距离。不同题解的区别主要在于对剩余距离的处理方式，尤其是对奇偶性的考虑。

### 所选高星题解

#### 1. 作者：persimmon2008 (4星)
**关键亮点**：
- 思路清晰，将问题分为两种情况：$|a-c|=|b-d|$ 和 $a=c$ 或 $b=d$。
- 代码简洁，直接计算步数，考虑奇偶性。

**核心代码**：
```cpp
int x=abs(a-c), y=abs(b-d);
if(x>y) swap(x,y);
int ans=0;
ans+=x*2;
if(abs(x-y)%2) ans+=abs(x-y)/2*4+1;
else ans+=abs(x-y)*2;
```
**实现思想**：先计算较小距离的两倍，再根据剩余距离的奇偶性调整步数。

#### 2. 作者：苏联小渣 (4星)
**关键亮点**：
- 通过贪心策略先走一个正方形，再处理剩余距离。
- 公式推导清晰，代码简洁。

**核心代码**：
```cpp
int dx = abs(a-c), dy = abs(b-d);
int mx = max(dx, dy), nx = min(dx, dy);
printf("%lld\n", nx * 2 + (mx - nx) * 2 - (mx - nx) % 2);
```
**实现思想**：先走最小距离的两倍，再根据剩余距离的奇偶性调整步数。

#### 3. 作者：雨伞CKY (4星)
**关键亮点**：
- 通过平移和对称简化问题，将起点移动到 $(0,0)$。
- 详细分析了在同一列或行的情况，并给出了明确的公式。

**核心代码**：
```cpp
t1 = abs(a - c), t2 = abs(b - d);
if (t1 > t2) swap(t1, t2);
if ((t2 - t1) % 2 == 0) cout << 2 * t2 << endl;
else cout << 2 * t2 - 1 << endl;
```
**实现思想**：先移动到与终点在同一行或列的位置，再根据剩余距离的奇偶性调整步数。

### 最优关键思路与技巧

1. **问题简化**：通过平移和对称，将问题转化为从 $(0,0)$ 移动到 $(|a-c|, |b-d|)$。
2. **步数计算**：先计算最小距离的两倍，再根据剩余距离的奇偶性调整步数。
3. **奇偶性处理**：剩余距离的奇偶性决定了是否需要额外的一步。

### 可拓展之处

- **类似问题**：可以考虑在三维空间中的移动问题，或者增加更多的移动限制。
- **算法套路**：贪心策略和奇偶性分析在类似的路径规划问题中也非常常见。

### 推荐题目

1. [P7569 盾构机](https://www.luogu.com.cn/problem/P7569)
2. [P1002 过河卒](https://www.luogu.com.cn/problem/P1002)
3. [P1077 摆花](https://www.luogu.com.cn/problem/P1077)

### 个人心得总结

- **调试经历**：在处理奇偶性时，容易忽略边界情况，如距离为0或1的情况。
- **踩坑教训**：在计算步数时，直接使用曼哈顿距离会导致方向限制被忽略，需要额外考虑。
- **顿悟感想**：通过将问题分解为多个子问题，可以更清晰地找到解决方案。

---
处理用时：31.28秒
# 题目信息

# 「PMOI-0」一笔画

## 题目背景

（原 LZOI-1，改名已经 PMOI 成员同意）

## 题目描述

言琢დ 在一个 $2n \times 2n$ 的矩阵中坐标为 $(x,y)$ 的一个点上。

现在 lhm 需要任意选择矩阵上的一个点作为起点，然后依次经过 $k$ 个点，移动规则如下：

- 每次移动只能选择与目前相邻（上下左右）的点作为本次移动的目标点。不能选择矩阵外的点。

- 每一轮移动必须正好经过矩阵上的所有点，不能重复经过同一个点。每经过所有点后，视为一轮移动结束。

- 注意依次经过 $k$ 个点后，最后一轮移动可能并没有完成。

现在 lhm 想知道，他最少会经过 言琢დ 多少次。

## 说明/提示

### 样例说明

![](https://cdn.luogu.com.cn/upload/image_hosting/37e99o4k.png)

$\color{red}დ$ 代表 言琢დ 所在位置，红色线表示 lhm 第一轮的路径。

### 数据规模与约定

**本题采用捆绑测试。**

| 子任务编号 | 分值 | $n,k\le$ |
| :----------: | :----------: | :----------: |
| $1$ | $30$ | $10^4$ |
| $2$ | $30$ | $10^9$ |
| $3$ | $40$ | $10^{18}$ |

对于所有数据，保证 $1\le n,k\le10^{18}$，$1\le x,y\le 2n$。

## 样例 #1

### 输入

```
2 16 1 1```

### 输出

```
1```

# AI分析结果

### 综合分析与结论

本题的核心在于通过数学推导找到最少经过目标点 $(x,y)$ 的次数。大多数题解都基于以下关键思路：
1. **矩阵遍历的周期性**：每轮遍历需要经过 $4n^2$ 个点，因此经过目标点的次数为 $\left\lfloor \frac{k}{4n^2} \right\rfloor$。
2. **优化策略**：通过选择起点和路径，使得在每一轮遍历中，目标点 $(x,y)$ 仅被经过一次，从而最小化经过次数。

尽管大多数题解都采用了相同的思路，但在代码实现、优化程度和解释清晰度上存在差异。以下是对部分题解的评分和亮点总结。

### 所选题解

#### 1. 作者：言琢დ (5星)
- **关键亮点**：提供了详细的证明，解释了为什么在 $2n \times 2n$ 的矩阵中，存在一种遍历方式可以循环遍历，并且最后一轮可以不经过目标点。这种证明增强了题解的可信度和深度。
- **代码实现**：
  ```cpp
  signed main(){
      int n = init(), k = init();
      print(k / (n * n * 4));
  }
  ```
  **核心思想**：直接计算 $\left\lfloor \frac{k}{4n^2} \right\rfloor$，简洁高效。

#### 2. 作者：Ginger_he (4星)
- **关键亮点**：通过黑白染色法证明了从任意点出发都能遍历整个矩阵，进一步支持了最小化经过次数的结论。解释清晰，逻辑严谨。
- **代码实现**：
  ```cpp
  #include<bits/stdc++.h>
  using namespace std;
  long long n,k,x,y;
  int main()
  {
      scanf("%lld%lld%lld%lld",&n,&k,&x,&y);
      printf("%lld\n",k/4/n/n);
      return 0;
  }
  ```
  **核心思想**：同样直接计算 $\left\lfloor \frac{k}{4n^2} \right\rfloor$，代码简洁。

#### 3. 作者：Chtholly_L (4星)
- **关键亮点**：强调了在每一轮遍历中，可以通过选择路径使得目标点仅被经过一次，进一步优化了经过次数。解释简洁明了。
- **代码实现**：
  ```cpp
  #include<cstdio>
  using namespace std;
  int main(){
      long long n,k,x,y;
      scanf("%lld%lld%lld%lld",&n,&k,&x,&y);
      printf("%lld",k/(n*2*n*2));
      return 0;
  }
  ```
  **核心思想**：直接计算 $\left\lfloor \frac{k}{4n^2} \right\rfloor$，代码简洁。

### 最优关键思路与技巧

1. **数学推导**：通过计算 $\left\lfloor \frac{k}{4n^2} \right\rfloor$ 来确定经过目标点的最少次数。
2. **路径优化**：选择起点和路径，使得在每一轮遍历中，目标点仅被经过一次。
3. **证明支持**：通过黑白染色法或遍历路径的构造，证明从任意点出发都能遍历整个矩阵。

### 可拓展之处

1. **类似问题**：可以扩展到其他形状的矩阵或图，如 $n \times m$ 的矩阵或不规则图，寻找类似的遍历策略。
2. **优化路径**：在实际应用中，可以进一步优化路径选择，以减少经过特定点的次数。

### 推荐题目

1. **P1137 旅行计划**：考察图的遍历和路径优化。
2. **P1219 八皇后**：考察矩阵遍历和路径选择。
3. **P1443 马的遍历**：考察矩阵遍历和路径优化。

### 个人心得总结

- **调试经历**：在实现过程中，确保数据类型为 `long long` 以避免溢出问题。
- **顿悟感想**：通过数学推导和路径优化，可以显著简化问题，提高解题效率。

---
处理用时：31.91秒
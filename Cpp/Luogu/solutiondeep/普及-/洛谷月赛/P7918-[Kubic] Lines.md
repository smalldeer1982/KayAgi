# 题目信息

# [Kubic] Lines

## 题目背景

建议先看 C 题题目背景。

## 题目描述

平面直角坐标系中有 $n$ 条直线，**任意三条直线不交于一点且没有两条直线重合**。显然这些直线形成了不超过 $\dfrac{n(n-1)}{2}$ 个**交点**。你可以从这些直线中选出一部分，一个点被**覆盖**当且仅当有**至少一条**被选中的直线经过了它。求最少选出多少条直线才能**覆盖**所有**交点**。

## 说明/提示

对于 $100\%$ 的数据，$1\le n\le 10^5,|a|,|b|,|c|\le 10^9,a,b$ 不全为 $0$。

||分值|$n$|特殊性质|
|:-:|:-:|:-:|:-:|
|$\operatorname{Subtask}1$|$10$|$\le 20$|无|
|$\operatorname{Subtask}2$|$30$|$\le 100$|无|
|$\operatorname{Subtask}3$|$10$|无特殊限制|$ab=0$|
|$\operatorname{Subtask}4$|$50$|无特殊限制|无|

### 样例解释

一种方法是选出 $x+2y+3=0$ 和 $4x+5y+6=0$ 两条线。

可以证明没有更优的方案。

## 样例 #1

### 输入

```
3
1 2 3
4 5 6
7 8 10```

### 输出

```
2
```

# AI分析结果

### 综合分析与结论

本题的核心问题是如何选择最少的直线覆盖所有交点。通过分析，可以发现关键在于处理平行线的情况。大多数题解都基于以下思路：

1. **平行线的处理**：将平行线视为一组，选择最多的平行线组，剩余的直线即为最小覆盖数。
2. **斜率的计算**：通过计算直线的斜率来判断是否平行，使用 `map` 或 `unordered_map` 来统计每组平行线的数量。
3. **精度问题**：由于斜率计算可能涉及浮点数，部分题解使用了 `long double` 或通过约分来避免精度误差。

### 所选高星题解

#### 1. 作者：银杉水杉秃杉 (5星)
- **关键亮点**：提供了两种实现方式（使用 `map` 和不使用 `map`），思路清晰，代码可读性强，且考虑了斜率计算的精度问题。
- **核心代码**：
  ```cpp
  map<long double, int> s;
  for (int i = 1; i <= n; i++) {
      long double f = (a == 0) ? inf : (long double)b / a;
      if (++s[f] > mx) mx = s[f];
  }
  cout << n - mx << endl;
  ```
  **实现思想**：通过 `map` 统计每组平行线的数量，找出最大值，最终输出 `n - mx`。

#### 2. 作者：VinstaG173 (4星)
- **关键亮点**：使用 `gcd` 约分来避免精度问题，代码简洁且高效。
- **核心代码**：
  ```cpp
  map<pair<int, int>, int> ap;
  for (rg int i = 0; i < n; ++i) {
      int d = (a && b) ? GCD(a, b) : a + b;
      if ((++ap[make_pair(a / d, b / d)]) > mx) mx = ap[make_pair(a / d, b / d)];
  }
  printf("%d\n", n - mx);
  ```
  **实现思想**：通过 `gcd` 约分后使用 `map` 统计每组平行线的数量，找出最大值，最终输出 `n - mx`。

#### 3. 作者：Iam1789 (4星)
- **关键亮点**：详细解释了平行线的处理逻辑，代码结构清晰，且考虑了斜率计算的精度问题。
- **核心代码**：
  ```cpp
  std::map<std::pair<int, int>, int> map;
  for (int i = 1; i <= n; ++i) {
      int g = gcd(ab(a), ab(b));
      a /= g, b /= g;
      if (a < 0) insert(a, -b);
      else insert(-a, b);
  }
  print(n - ans), putchar('\n');
  ```
  **实现思想**：通过 `gcd` 约分后使用 `map` 统计每组平行线的数量，找出最大值，最终输出 `n - ans`。

### 最优关键思路与技巧

1. **平行线的处理**：将平行线视为一组，选择最多的平行线组，剩余的直线即为最小覆盖数。
2. **斜率的计算与精度处理**：使用 `long double` 或通过 `gcd` 约分来避免浮点数精度问题。
3. **数据结构的选择**：使用 `map` 或 `unordered_map` 来统计每组平行线的数量，提高查找效率。

### 可拓展之处

- **类似问题**：处理几何问题时，常常需要考虑平行线、交点等几何性质，类似的思路可以应用于其他几何覆盖问题。
- **算法套路**：在处理分组统计问题时，使用 `map` 或 `unordered_map` 是一种常见的优化手段，可以推广到其他需要分组统计的场景。

### 推荐题目

1. [P1357 食物链](https://www.luogu.com.cn/problem/P1357) - 考察图论中的覆盖问题。
2. [P3372 【模板】线段树 1](https://www.luogu.com.cn/problem/P3372) - 考察线段树的区间覆盖操作。
3. [P3384 【模板】树链剖分](https://www.luogu.com.cn/problem/P3384) - 考察树结构的覆盖与路径处理。

### 个人心得摘录

- **调试经历**：部分题解提到由于浮点数精度问题导致 WA，最终通过使用 `long double` 或 `gcd` 约分解决。
- **顿悟感想**：在处理几何问题时，平行线的处理是关键，通过将平行线视为一组，可以简化问题并找到最优解。

---
处理用时：34.81秒
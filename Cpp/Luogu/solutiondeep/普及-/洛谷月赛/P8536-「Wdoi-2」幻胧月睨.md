# 题目信息

# 「Wdoi-2」幻胧月睨

## 题目背景

**Problem Number:** $\textit{39}$

**背景与题目无关，选手可以直接看下面的「简要题意」。**

那是在竹取物语之后的故事了，幻想乡距离与现实隔绝也已经过去了百年时光。

地上人向月球发起了侵略战争之后，一只名叫**铃仙**的月兔舍弃了同伴，死里逃生，逃到了在幻想乡内的永远亭，来到了辉夜与永琳的身边，生活得安稳而舒适。

又过了数十年，铃仙接收到了来自月球的使唤，被要求强制返回月球。辉夜与永琳商量了下，决定不将铃仙交还予月球。但为了避免造成麻烦，辉夜与永琳决定将满月消失在地上，只留下一轮虚假的月亮。

-----

为了方便调查异变，八云紫运用自己的能力，将整个幻想乡变成了永夜。

被穿梭回异变发生当时的四组主角，共八人。除了依然留有记忆，可以来回穿梭在虚与实的境界的八云紫之外，其他的人缺乏了记忆，重新开始踏上夺回幻想乡的满月的征途。

在慧音的指引之下，她们来到了迷途竹林，在她们的面前，是一只名叫铃仙的月兔。

## 题目描述

### 简要题意

给定一个长度为 $n$ 的 01 串 $b$，要求构造一个 $n$ 阶排列 $a$，满足，对于 $a_i(2\le i\le n)$，记 $m_i=\max_{j=1}^{i-1}\{a_j\}$，则：
  - 若 $b_i=1$，则 $a_i>m_i$;
  - 否则 $a_i<m_i$。

可以证明，总存在一个数列 $a$ 满足以上条件。

**如果有多组解，输出任意一种。**

同时注意到 $b_1$ 的取值是任意的，对数列 $a$ 没有影响。

### 原始题意

铃仙拥有操纵狂气程度的能力，换而言之，就是操纵物体的波长、振幅以及相位。这种能力为主角制造了种种障碍——例如操纵光波，会让弹幕虚虚实实，甚至会出现虚假的自我，对躲避弹幕造成极大的干扰。

以符卡「幻胧月睨」为例。「幻胧月睨」中一共有 $n$ 个弹幕，每个弹幕都会有一个相位，相位非 $0$ 即 $1$。这些弹幕的相位会构成一个长度为 $n$ 的数列 $\{b_i\}$。

铃仙会操纵这些弹幕的相位，将其变得千奇百怪。具体而言，被操纵了之后的弹幕的相位是一个长度为 $n$ 的**排列** $\{a_i\}$，即 $1 \sim n$ 的数字都会**不重不漏**地出现在这个序列之中。

为了加大主角躲避弹幕的难度，铃仙会设置一个阈值。对于每一个元素 $a_i$，阈值是其**前缀**的**最大**值，即 $a_1,a_2,\dots,a_{i-1}$ 中的最大值。若原来的第 $i$ 个弹幕的相位为 $1$，则被操纵后的弹幕的相位要**大于**这个阈值，否则被操纵后的弹幕的相位要**小于**这个阈值。

显然的是，根据铃仙的操纵规则，无论原本的弹幕的相位如何，都是存在可能的操纵方案的。由于主角们失去了记忆，而找回月亮的时间已经所剩不多了，而且弹幕战对时间的把控要求极高。她们找到了你，希望你能够对铃仙原本的弹幕相位，给出**任意一种**操作后的弹幕相位，来为她们的闪避弹幕进行准备。

## 说明/提示

### 样例解释

- 对于数据 $1$，显然 $a_2>1,a_3>2$。
- 对于数据 $2$，显然 $a_2<2,a_3>2$。
- 对于数据 $3$，显然 $a_2>1,a_3<3,a_4>3$。\
  注意到 $a=\{2,3,1,4\}$ 同样满足要求。

### 数据范围

$$
\def\arraystretch{1.5}
\begin{array}{|c|c|c|c|c|}\hline
\textbf{Subtask} & \bm{n\le} & \textbf{特殊性质} & \textbf{Subtask 依赖} & \textbf{分值}\\\hline
1 & 10 & - & - & 5\\\hline
2 & 10^5 & \textbf{A} & - & 5 \\\hline
3 & 10^5 & \textbf{B} & - & 20 \\\hline
4 & 10^5 & - & 1,2,3 &70 \\\hline
\end{array}$$

- **特殊性质** $\textbf{A}$：保证 $b_i$ 都相等。
- **特殊性质** $\textbf{B}$：存在整数 $p\in[2,n]$，使得对于 $1\le i<p$，有 $b_i=1$；对于 $n\ge i\ge p$，有 $b_i=0$。

对于全部数据，满足 $1\le T\le 10^4$，$1\le n\le 10^5$，$\forall i\in[1,n],b_i\in\{0,1\}$。

保证单个测试点内 $\sum n\le 5\times 10^5$。

## 样例 #1

### 输入

```
3
3
111
3
101
4
0101```

### 输出

```
1 2 3
2 1 3
1 3 2 4```

# AI分析结果

### 综合分析与结论

本题的核心在于构造一个满足特定条件的排列，要求根据给定的01串 $b$，构造一个排列 $a$，使得每个元素 $a_i$ 要么大于其前缀最大值，要么小于其前缀最大值。多个题解提供了不同的构造方法，主要思路包括：

1. **分离构造法**：将 $b_i=0$ 和 $b_i=1$ 的元素分别构造为降序和升序的序列，确保满足条件。
2. **双向队列法**：通过倒序遍历 $b$，使用双向队列动态选择元素，确保每次选择的元素满足条件。
3. **交换法**：通过逆序遍历 $b$，交换相邻元素以满足 $b_i=0$ 的条件。

这些方法的核心思想都是通过某种方式确保每个元素 $a_i$ 满足其与前缀最大值的关系。其中，**分离构造法**和**双向队列法**在实现上较为简洁，且时间复杂度较低，适合大规模数据处理。

### 所选高星题解

#### 1. **作者：chen_zhe (5星)**

**关键亮点**：
- **分离构造法**：将 $b_i=0$ 和 $b_i=1$ 的元素分别构造为降序和升序的序列，确保满足条件。
- **简洁高效**：代码实现简洁，时间复杂度为 $O(n)$，适合大规模数据处理。

**核心代码**：
```cpp
for (int i=1;i<=n;i++) {
    if (ch[i]=='0') cout << (cnt0--) << " ";
    else cout << (cnt1++) << " ";
}
```
**实现思想**：通过统计 $b_i=0$ 的个数，分别构造降序和升序的序列，确保每个元素满足条件。

#### 2. **作者：McIron233 (4星)**

**关键亮点**：
- **双向队列法**：通过倒序遍历 $b$，使用双向队列动态选择元素，确保每次选择的元素满足条件。
- **动态选择**：利用双向队列的特性，动态选择队头或队尾元素，确保条件满足。

**核心代码**：
```cpp
for (int i=n;i>=1;i--) {
    if (ch[i]=='1') a[i]=til--;
    else a[i]=hed++;
}
```
**实现思想**：通过倒序遍历 $b$，动态选择双向队列的队头或队尾元素，确保每个元素满足条件。

#### 3. **作者：joyslog (4星)**

**关键亮点**：
- **交换法**：通过逆序遍历 $b$，交换相邻元素以满足 $b_i=0$ 的条件。
- **逆序冒泡**：通过逆序遍历和交换操作，确保每个元素满足条件。

**核心代码**：
```cpp
for (int i=n;i>=2;i--) if(s[i - 1] == '0') swap(a[i], a[i - 1]);
```
**实现思想**：通过逆序遍历 $b$，交换相邻元素，确保每个元素满足条件。

### 最优关键思路与技巧

- **分离构造法**：将 $b_i=0$ 和 $b_i=1$ 的元素分别构造为降序和升序的序列，确保满足条件。这种方法简洁高效，适合大规模数据处理。
- **双向队列法**：通过倒序遍历 $b$，使用双向队列动态选择元素，确保每次选择的元素满足条件。这种方法动态性强，适合需要动态选择的场景。

### 可拓展之处

- **类似问题**：类似的问题可以扩展到需要根据某种条件构造排列的场景，例如根据某些约束条件构造满足特定性质的排列。
- **算法套路**：分离构造法和双向队列法可以应用于其他需要根据条件动态选择元素的场景，例如在某些约束条件下选择最优解。

### 推荐题目

1. **洛谷 P1972 [SDOI2009] HH的项链**（题号：P1972）：考察动态选择元素满足条件的问题。
2. **洛谷 P3383 【模板】线性筛素数**（题号：P3383）：考察构造满足特定条件的序列。
3. **洛谷 P1048 采药**（题号：P1048）：考察在约束条件下选择最优解的问题。

### 个人心得摘录

- **chen_zhe**：通过分离构造法，确保每个元素满足条件，代码实现简洁高效。
- **McIron233**：利用双向队列动态选择元素，确保每次选择的元素满足条件，动态性强。
- **joyslog**：通过逆序遍历和交换操作，确保每个元素满足条件，逆序冒泡操作正确性高。

这些心得展示了不同方法在实现上的简洁性和高效性，适合不同场景的应用。

---
处理用时：33.53秒
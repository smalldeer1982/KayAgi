# 题目信息

# [Aya Round 1 D] 文文的数学游戏

## 题目背景

在解决了上一题之后，琪露诺觉得自己仿佛就是天才。于是，射命丸文又给了她一道简单的数学题。

## 题目描述

给定长度为 $n$ 的整数序列 $a$，你需要构造一个长度为 $n$ 的整数序列 $b$ 满足对于所有 $1\le i\le n$，有 $1\le b_i \le a_i$。且 $\gcd(b_1,b_2,\cdots,b_n)$ 最大，其中 $\gcd$ 表示最大公因数。试求出能得到的最大值和取得最大值时，不同的数列 $b$ 的个数，对 $10^9+7$ 取模。

定义两个长度为 $L$ 的数列 $c,d$ 不同，当且仅当存在整数 $i(1 \le i \le L)$，使得 $c_i \ne d_i$。

## 说明/提示

### 样例 1 解释

注意到由于 $1\le b_1\le a_1=1$，因此 $b_1$ 必须要为 $1$，因此最大的 $\gcd$ 值只能为 $1$。在这个前提下，所有合法的 $b$ 如下：

- $\{1,1,1\},\{1,1,2\},\{1,1,3\},\{1,2,1\},\{1,2,2\},\{1,2,3\}$。

### 数据范围与约束

对于 $100\%$ 的数据，$1 \le n\le 10^5$，$1 \le a_i\le 10^9$。

本题附带一组大样例。

## 样例 #1

### 输入

```
3
1 2 3```

### 输出

```
1 6```

# AI分析结果



### 综合分析与结论

题目要求构造序列 $b$ 使得 $\gcd(b_1,\dots,b_n)$ 最大，并统计方案数。核心结论：  
1. **最大 $\gcd$ 为 $\min(a_i)$**：所有 $b_i$ 必须为该值的倍数，且该值不可能更大。  
2. **方案数计算**：每个 $b_i$ 的取值个数为 $\lfloor a_i / \min(a) \rfloor$，累乘后取模。

各题解思路一致，均正确实现上述逻辑，时间复杂度 $O(n)$。

---

### 高星题解推荐

#### 题解1：chen_zhe（★★★★★）  
**关键亮点**：  
- 简洁清晰地证明最大 $\gcd$ 为 $\min(a_i)$，并给出直观的方案数推导。  
- 代码简洁高效，初始值处理严谨（`1<<30` 足够大）。  
**核心代码**：  
```cpp
int mgcd=1<<30;
for (int i=1;i<=n;i++) mgcd=min(mgcd,a[i]);
long long ans=1;
for (int i=1;i<=n;i++) ans=ans*(a[i]/mgcd)%mod;
```

#### 题解2：落花月朦胧（★★★★☆）  
**关键亮点**：  
- 详细反证法证明最大 $\gcd$ 的不可超越性，增强理解。  
- 引入自动取模模板（`Z` 类型），确保运算安全。  
**核心代码**：  
```cpp
int mn = inf;  // 初始设为极大值
for (int x : a) mn = min(mn, x);
Z ans = 1;
for (int x : a) ans *= x / mn;
```

---

### 最优思路提炼

1. **数学观察**：$\gcd$ 最大值为 $\min(a_i)$，因其必须整除所有元素。  
2. **方案计算**：每项可选的倍数个数乘积即为总方案数。  
3. **实现技巧**：  
   - 初始极大值设为 $2^{30}$ 或 $1.1 \times 10^9$，覆盖数据范围。  
   - 边乘边取模避免溢出。

---

### 拓展与同类题

**思维拓展**：  
- 类似问题可考虑数学约束（如因数分解、倍数关系）与最值结合。  
- 推荐题目：  
  - [P1072 Hankson的趣味题](https://www.luogu.com.cn/problem/P1072)（约数条件）  
  - [P1414 又是毕业季II](https://www.luogu.com.cn/problem/P1414)（多数的最大公因数）  
  - [P2447 [SDOI2010] 外星千足虫](https://www.luogu.com.cn/problem/P2447)（线性方程组与模运算）  

**个人心得摘录**：  
> “本题的突破口在于发现 $\gcd$ 的极值与 $\min(a_i)$ 的关系，其余均为数学推导。” —— 落花月朦胧  
> “注意 $\prod$ 运算需及时取模，避免数值过大。” —— xzy090626（调试经验）  

---

以上分析可帮助快速掌握本题核心，并举一反三应用到类似数学约束问题中。

---
处理用时：64.65秒
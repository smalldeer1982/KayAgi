# 题目信息

# [蓝桥杯 2019 国 C] 数正方形

## 题目描述

在一个 $N \times N$ 的点阵上，取其中 $4$ 个点恰好组成一个正方形的 $4$ 个顶点，一共有多少种不同的取法？

由于结果可能非常大，你只需要输出模 $10^9 + 7$ 的余数。

![](https://luogu.oss-cn-hangzhou.aliyuncs.com/upload/vjudge_pic/lanqiao/2022_09_30_4ab10c5eb27e3dea37d8g-09.jpg)

如上图所示的正方形都是合法的。

## 说明/提示

对于所有评测用例，$2 ≤ N ≤ 10^6$。

蓝桥杯 2019 年国赛 C 组 G 题

## 样例 #1

### 输入

```
4```

### 输出

```
20```

# AI分析结果

### 综合分析与结论
这三道题解均围绕计算 $N \times N$ 点阵中取 4 个点组成正方形的不同取法数量展开，最终都得出相同的计算公式 $\sum_{i=1}^{n - 1} i\times(n - i)^2$。
- **思路方面**：Furina_Hate_Comma 和 small_john 都是从大正方形中找顶点落在其边上的小正方形的角度思考；wuhan1234 则是分别考虑正放和斜放正方形的数量再求和。
- **算法要点**：都通过循环遍历不同边长的正方形，利用乘法原理计算每种边长下正方形的数量并累加。
- **解决难点**：主要难点在于找出不同边长正方形的数量规律，各题解均通过图形分析和数学推导解决。

### 所选题解
- **Furina_Hate_Comma（5星）**
    - **关键亮点**：思路清晰，有详细的图形辅助说明和数学推导过程，代码简洁。
    - **个人心得**：“十年 OI 一场空，不开 long long 见祖宗！”，强调了在处理可能出现大数的问题时要使用 long long 类型避免溢出。
- **small_john（4星）**
    - **关键亮点**：分析过程结合图形举例，通俗易懂，公式推导简洁明了。
- **wuhan1234（4星）**
    - **关键亮点**：将正放和斜放正方形分开讨论，逻辑严谨，有助于理解不同类型正方形的构成。

### 重点代码
```cpp
// Furina_Hate_Comma
for(int i=1;i<=n;i++){
    ans=(ans+(n-i+1)*(n-i+1)*i)%1000000007;
}

// small_john
for(int i = 1;i<n;i++)
    ans+=i*(n-i)*(n-i),ans%=mod;

// wuhan1234
for (i=1;i<n;i++)
{
    ans=(ans+(n-i)%mod*i%mod*i)%mod;
}
```
**核心实现思想**：通过循环遍历不同边长的正方形，计算每种边长下满足条件的正方形数量，累加到结果中，并对结果取模避免溢出。

### 最优关键思路与技巧
- **思维方式**：将大问题拆分成不同边长正方形的小问题，分别计算数量后累加。
- **代码实现技巧**：使用 long long 类型避免大数溢出，在每次累加时取模防止结果过大。

### 可拓展之处
同类型题可以是在不同形状的点阵（如三角形点阵、六边形点阵）中找特定图形（如三角形、六边形）的数量。类似算法套路是先分析图形的构成规律，找出不同大小图形的数量与点阵规模的关系，再通过循环累加计算总数。

### 推荐洛谷题目
- P1161 开灯
- P1035 级数求和
- P1046 陶陶摘苹果

---
处理用时：20.46秒
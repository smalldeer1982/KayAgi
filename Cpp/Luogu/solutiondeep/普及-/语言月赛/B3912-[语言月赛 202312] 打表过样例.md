# 题目信息

# [语言月赛 202312] 打表过样例

## 题目背景

众所周知，一名负责任的出题人，不应当让如下的打表程序获得过多的分数。

```cpp
#include<iostream>
int main() {
    std::cout << "Specific Value\n";
}
```

> 这个程序的功能是，输出一个特定的内容，以尝试通过一些测试点而获得分数。
> 
> 经典的例子是：<https://www.luogu.com.cn/problem/P8819>，输出无解可以获得 45 分的成绩。

## 题目描述

很不幸，你遇到了不负责任的出题人。

在某道试题里，共有 $N$ 个测试点，组成了 $k$ 个 Subtask，第 $i$ 个 Subtask 包含 $p_i$ 个测试点，第 $j$ 个测试点的编号为 $w_{i,j}$。请注意，一个测试点可能属于多个 Subtask。

> **Subtask**
>
> 每个 Subtask 包含多个测试点和一个分值，当且仅当通过全部这些测试点时，才能获得这个 Subtask 的分值。一道题目的得分为通过的所有 Subtask 分值之和。

这是一道输出仅有一个数的题目，编号为 $i$ 的测试点，标准答案为 $A_i$。

很不幸，由于命题人不负责任，$A_i$ 中出现了大量重复，让打表选手有了可乘之机。

现在，你通过某种手段获得了全部的数据，请问输出哪个数，可以得到最高的分数？最高的分数是多少？

如果有多个数均可得到最高的分数，你只需要任意给出一个。

## 说明/提示

### 数据规模与约定

- 对于 $30\%$ 的测试数据，$1 \le N \le 100$，$1 \le k,p_i \le 10$，$1 \le A_i \le 100$。
- 对于 $100\%$ 的测试数据，$1 \le N \le 10^5$，$1 \le k,p_i \le 5000$，$1 \le w_{i,j} \le N$，$1 \le S_i \le 10^9$，$1 \leq A _ i \leq 10 ^ 9$。

## 样例 #1

### 输入

```
2
3 1 2 3 5
3 4 5 6 7
6
4 4 4 5 5 5
```

### 输出

```
7
5
```

# AI分析结果

### 综合分析与结论

本题的核心在于如何高效地统计每个可能的输出值能够获得的最高分数。由于测试点的答案可能非常大（$10^9$），直接使用桶统计的方法不可行。因此，题解中提出了通过结构体数组存储每个Subtask的答案和分数，并通过排序和分段统计的方法来优化空间和时间复杂度。

### 所选高星题解

#### 题解1：览遍千秋 (5星)
**关键亮点：**
- **思路清晰**：通过结构体数组存储每个Subtask的答案和分数，避免了直接使用桶统计的空间问题。
- **优化程度高**：使用排序和分段统计的方法，将时间复杂度降低到$O(N + k^2)$，适合大规模数据。
- **代码可读性强**：核心代码简洁明了，逻辑清晰。

**核心代码：**
```cpp
for(int i = 1; i <= k; i++) {
    bool IsAnswerEqual = true;
    for(int j = 2; j <= p[i]; j++) {
        if(A[w[i][j - 1]] != A[w[i][j]]) {
            IsAnswerEqual = false;
        }
    }
    if(IsAnswerEqual) {
        ans[++cnt] = {A[w[i][1]], S[i]};
    }
}
```
**核心实现思想：**
遍历每个Subtask，检查其中所有测试点的答案是否相同。如果相同，则将该答案和对应的分数存入结构体数组。最终通过排序和分段统计来找到能够获得最高分数的输出值。

### 最优关键思路或技巧

1. **结构体数组存储**：使用结构体数组存储每个Subtask的答案和分数，避免了直接使用桶统计的空间问题。
2. **排序与分段统计**：通过排序将结构体数组按答案分组，然后分段统计每个答案能够获得的总分数，从而找到最大值。
3. **时间复杂度优化**：通过减少不必要的遍历和统计，将时间复杂度优化到$O(N + k^2)$，适合大规模数据处理。

### 可拓展之处

- **类似算法套路**：在处理大规模数据时，可以考虑使用排序和分段统计的方法来优化空间和时间复杂度。例如，在统计频率或总和时，这种方法非常有效。
- **同类型题**：可以考虑类似的问题，如统计某个值在多个区间内的出现次数，或者统计某个值在多个集合中的总和。

### 推荐洛谷题目

1. **P8819**：输出无解可以获得 45 分的成绩。
2. **P1001**：A+B Problem，考察基础输入输出。
3. **P1002**：过河卒，考察动态规划。

### 个人心得总结

- **调试经历**：在处理大规模数据时，直接使用桶统计的方法会导致内存不足，因此需要寻找更高效的存储和统计方法。
- **踩坑教训**：在优化算法时，不仅要考虑时间复杂度，还要考虑空间复杂度，避免因内存不足而导致程序崩溃。
- **顿悟感想**：通过结构体数组和排序分段统计的方法，可以有效地解决大规模数据统计问题，这种方法在很多场景下都非常有用。

---
处理用时：22.46秒
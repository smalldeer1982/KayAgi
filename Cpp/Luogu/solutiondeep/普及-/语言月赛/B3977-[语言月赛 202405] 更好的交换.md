# 题目信息

# [语言月赛 202405] 更好的交换

## 题目描述

小 S 有一个奇怪的机关拼图。这个拼图可以看作一个 $n$ 行 $n$ 列的方阵 $A$，第 $i$ 行第 $j$ 列的位置上有一个正整数 $A_{i, j}$。

与寻常拼图不同的是，这个机关拼图上的数字不能随意移动，必须按照如下规则**之一**操作：

- 选择拼图上的第 $x$ 行和第 $y$ 行，交换这两**行**；
- 选择拼图上的第 $x$ 列和第 $y$ 列，交换这两**列**。

为了复原这个拼图，小 S 将会操作共 $m$ 次，每次操作格式如下：

- `1 x y`，表示交换第 $x$ 行和第 $y$ 行；
- `0 x y`，表示交换第 $x$ 列和第 $y$ 列；

请你输出复原后的拼图。

## 说明/提示

### 样例 1 解释

第一次操作，交换了第 $2$ 列和第 $3$ 列；第二次操作，没有发生变化。

### 样例 2 解释

第一次操作，交换第 $2$ 行和第 $3$ 行，拼图变为：
$$
\begin{aligned}
11 \ 12 \ 13\\
\textcolor{red}{31 \ 32 \ 33}\\
\textcolor{blue}{21 \ 22 \ 23}
\end{aligned}
$$

第二次操作，交换第 $2$ 列和第 $3$ 列，拼图变为：
$$
\begin{aligned}
11 \ \textcolor{red}{13} \ \textcolor{blue}{12} \\ 
31 \ \textcolor{red}{33} \ \textcolor{blue}{32} \\
21 \ \textcolor{red}{23} \ \textcolor{blue}{22}
\end{aligned}
$$

### 数据范围

对于前 $30 \%$ 的数据，保证每一行数字相同；  
对于前 $60 \%$ 的数据，保证 $1 \leq m \leq 3 \times 10^3$。  
对于 $100 \%$ 的数据，保证 $1 \leq m \leq 10^6, 1 \leq n, A_{i, j} \leq 10^3, 1 \leq x, y \leq n$，$0 \leq op \leq 1$。

## 样例 #1

### 输入

```
3 2
4 5 6
3 2 1
9 8 7
0 2 3
0 2 2
```

### 输出

```
4 6 5 
3 1 2 
9 7 8
```

## 样例 #2

### 输入

```
3 2
11 12 13
21 22 23
31 32 33
1 2 3
0 2 3
```

### 输出

```
11 13 12 
31 33 32 
21 23 22
```

## 样例 #3

### 输入

```
4 4               
12 32 42 82
53 43 34 98
90 32 42 53
37 17 88 10
0 2 4
1 2 4
0 1 4
1 1 3
```

### 输出

```
32 53 42 90 
17 10 88 37 
32 82 42 12 
43 98 34 53
```

# AI分析结果

### 综合分析与结论

本题的核心在于如何高效处理大规模的交换操作（最多10^6次），直接暴力交换行或列的时间复杂度为O(n*m)，无法通过全部数据。因此，优化思路是通过记录行和列的映射关系，而不是直接交换数据，从而将每次操作的时间复杂度降低到O(1)。

### 所选高星题解

#### 题解1：ShiRoZeTsu（5星）
- **关键亮点**：
  - 通过引入两个数组 `p` 和 `q` 分别记录行和列的映射关系，避免了直接交换数据的高时间复杂度。
  - 思路清晰，代码简洁，易于理解。
  - 优化程度高，能够处理最大数据规模。
- **核心代码**：
  ```cpp
  for(int i = 1, op, x, y; i <= m; i++) {
      cin >> op >> x >> y;
      if(op == 1) swap(p[x], p[y]);
      else swap(q[x], q[y]);
  }
  for(int i = 1; i <= n; i++) {
      for(int j = 1; j <= n; j++)
          cout << a[p[i]][q[j]] << ' ';
      cout << '\n';
  }
  ```
- **个人心得**：
  - 通过记录映射关系，避免了重复交换数据的开销，显著提升了效率。
  - 这种思路在处理大规模数据时非常有效，值得借鉴。

### 最优关键思路或技巧

- **映射关系记录**：通过记录行和列的映射关系，而不是直接交换数据，将每次操作的时间复杂度从O(n)降低到O(1)。
- **分离处理**：行和列的操作是独立的，可以分别处理，进一步简化问题。

### 可拓展之处

- **类似问题**：在处理大规模矩阵操作时，可以考虑使用类似的映射关系记录方法，避免直接操作数据。
- **算法套路**：这种通过记录状态或映射关系来优化操作的方法，在动态规划、图论等领域也有广泛应用。

### 推荐洛谷题目

1. **P3383 【模板】线性筛素数**（题号：3383）
   - 考察知识点：筛法、素数判断
   - 类似技巧：通过记录状态（是否为素数）来优化算法。

2. **P3374 【模板】树状数组 1**（题号：3374）
   - 考察知识点：树状数组、区间查询与更新
   - 类似技巧：通过数据结构优化查询和更新操作。

3. **P3367 【模板】并查集**（题号：3367）
   - 考察知识点：并查集、路径压缩
   - 类似技巧：通过记录父节点关系来优化查找和合并操作。

### 通用建议与扩展思路

- **优化思路**：在处理大规模数据时，尽量避免直接操作数据，而是通过记录状态或映射关系来优化操作。
- **代码实现**：在实现时，注意代码的简洁性和可读性，避免不必要的复杂逻辑。
- **调试技巧**：在调试时，可以通过输出中间结果来验证算法的正确性，特别是在处理映射关系时。

---
处理用时：22.53秒
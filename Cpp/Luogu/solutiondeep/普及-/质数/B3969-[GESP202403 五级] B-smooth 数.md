# 题目信息

# [GESP202403 五级] B-smooth 数

## 题目描述

小杨同学想寻找一种名为 $ B $-smooth 数的正整数。 

如果一个正整数的最大质因子不超过 $ B $，则该正整数为 $ B $-smooth 数。小杨同学想知道，对于给定的 $ n $ 和 $ B $，有多少个不超过 $ n $ 的 $ B $-smooth 数。

## 说明/提示

### 数据规模与约定

| 子任务 | 得分 | $n \leq $ | $B$ |
| :-: | :-: | :-: | :-: |
| $1$ | $30$ | $10^3$ | $1 \leq B \leq 10^3$ |
| $2$ | $30$ | $10^6$ | $\sqrt n \leq B \leq 10^6$ |
| $3$ | $40$ | $10^6$ | $1 \leq B \leq 10^6$ | 

对全部的测试数据，保证 $1 \leq n, B \leq 10^6$。

## 样例 #1

### 输入

```
10 3```

### 输出

```
7```

# AI分析结果



### 综合分析与结论
本题核心在于高效预处理每个数的最大质因子。最优解法基于筛法优化，通过一次遍历为每个数标记其最大质因子，时间复杂度接近线性（O(n log log n)）。对比暴力质因数分解（O(n√n)）和逆向标记法（O(n log n)），筛法预处理在时间效率上有显著优势。部分题解虽然正确但未优化至最优，而筛法思路可拓展至其他数论问题。

---

### 精选题解

#### 1. 作者：Little_x_starTYJ（5星）
**关键亮点**  
- 使用筛法预处理最大质因子，时间复杂度最优  
- 代码简洁高效（10行核心逻辑），可读性极强  
**核心代码**  
```cpp
int a[1000010];
for (int i = 2; i <= n; i++) {
    if (!a[i]) { // i是质数
        for (int j = i; j <= n; j += i)
            a[j] = i; // 覆盖i的倍数，最终保留最大质因子
    }
}
```

#### 2. 作者：dlzlj_2010（5星）
**关键亮点**  
- 与上解思路一致，变量命名更清晰（mp数组）  
- 独立实现验证筛法逻辑，体现对算法的深刻理解  
**核心代码**  
```cpp
int mp[N]; // 最大质因子数组
void work(int n) {
    for (int i = 2; i <= n; i++) {
        if (!mp[i]) { // 质数处理
            mp[i] = i;
            for (int j = i; j <= n; j += i)
                mp[j] = i; // 同筛法覆盖
        }
    }
}
```

#### 3. 作者：GavinWu_qwq（4星）
**关键亮点**  
- 逆向思维：标记所有含大质数的倍数为非法  
- 实现双重标记数组，逻辑清晰但空间略高  
**优化心得**  
> "对每个大于B的质数p，其倍数必然非法。通过两次筛法标记，剩余未标记的即为合法数。"

---

### 关键思路总结
**筛法预处理最大质因子**  
1. 初始化数组存储每个数的最大质因子  
2. 遍历2~n，若当前数i未被处理（即质数），将其所有倍数标记为i  
3. 最终每个数的最大质因子即为最后一次被覆盖的质数  
**优势**：O(n)级别预处理，后续查询O(1)，完美适配1e6规模数据  

---

### 拓展应用
1. **类似筛法技巧**：最小质因子筛（欧拉筛）、区间筛法  
2. **题型延伸**：质因数分解统计（如[CF776B Sherlock and his girlfriend](https://codeforces.com/problemset/problem/776/B)）  
3. **优化思维**：预处理高频查询数据，空间换时间  

---

### 推荐习题
1. [P3383 线性筛素数](https://www.luogu.com.cn/problem/P3383)（筛法基础）  
2. [P3912 素数个数](https://www.luogu.com.cn/problem/P3912)（大范围筛法应用）  
3. [P1072 Hankson 的趣味题](https://www.luogu.com.cn/problem/P1072)（质因数分解与条件判断）  

---

### 题解心得摘录
- **__qkj__**：优化质数判断函数后，避免TLE，体现常数优化重要性  
- **Kle1N**：记忆化分解质因数结果，减少重复计算  
- **xzz_0611**：通过埃氏筛改进直接标记最大质因子，强调算法变形能力

---
处理用时：95.14秒
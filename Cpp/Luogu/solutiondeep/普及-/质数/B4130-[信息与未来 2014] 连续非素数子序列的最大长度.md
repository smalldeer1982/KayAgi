# 题目信息

# [信息与未来 2014] 连续非素数子序列的最大长度

## 题目描述

给出一个正整数 $n$，求在数列 $\{2,3,\cdots,n\}$
中，连续非素数子序列的最大长度。

## 说明/提示

### 样例 $\textbf1$ 解释
| 连续非素数子序列 | 长度 |
| :----------: | :----------: |
| $\{4\}$ | $1$ |
| $\{6\}$ | $1$ |
| $\{8,9,10\}$ | $3$ |
| $\{12\}$ | $1$ |

其中，最大长度为 $3$，即有连续的 $3$ 个非素数。
### 数据范围
$2\le n\le 5\times10^6$。

## 样例 #1

### 输入

```
12```

### 输出

```
3```

## 样例 #2

### 输入

```
30```

### 输出

```
5```

# AI分析结果



### 综合分析与结论
题目要求找到数列 $\{2,3,\cdots,n\}$ 中最长的连续非素数（合数）子序列。核心思路是通过筛法快速标记素数，再统计连续合数的最大长度或相邻素数间隔的最大值。以下是关键思路的总结与推荐题解。

---

### 精选题解

#### 题解1：筛法 + 连续合数统计
- **评分**：★★★★★  
- **关键亮点**：  
  直接遍历所有数，维护当前连续合数的长度。思路直观，代码简洁，适合大部分场景。  
- **核心代码**：  
  ```cpp
  vector<bool> is_prime(n + 1, true);
  // 筛法实现略
  int max_len = 0, current = 0;
  for (int i = 2; i <= n; ++i) {
      if (!is_prime[i]) current++, max_len = max(max_len, current);
      else current = 0;
  }
  ```

#### 题解2：筛法 + 素数列表间隔分析
- **评分**：★★★★★  
- **关键亮点**：  
  生成素数列表后，计算相邻素数的最大间隔，减少遍历次数，适用于大 $n$。  
- **核心代码**：  
  ```cpp
  vector<int> primes;
  for (int i = 2; i <= n; ++i)
      if (is_prime[i]) primes.push_back(i);
  int max_gap = 0;
  for (int i = 1; i < primes.size(); ++i)
      max_gap = max(max_gap, primes[i] - primes[i-1] - 1);
  if (primes.back() < n) max_gap = max(max_gap, n - primes.back());
  ```

#### 题解3：动态维护前一个素数位置
- **评分**：★★★★★  
- **关键亮点**：  
  无需存储素数列表，动态维护前一个素数的位置，节省空间。  
- **核心代码**：  
  ```cpp
  int prev = -1, max_gap = 0;
  for (int i = 2; i <= n; ++i) {
      if (is_prime[i]) {
          if (prev != -1) max_gap = max(max_gap, i - prev - 1);
          prev = i;
      }
  }
  if (prev < n) max_gap = max(max_gap, n - prev);
  ```

---

### 关键思路与技巧
1. **筛法优化**：使用埃氏筛法预处理素数，时间复杂度 $O(n \log \log n)$。
2. **区间统计**：最大连续合数长度等价于相邻素数的最大间隔减一，或最后一段合数的长度。
3. **边界处理**：需单独处理最后一个素数到 $n$ 的区间。

---

### 拓展与推荐题目
- **同类型题目**：  
  1. [P1217 回文质数](https://www.luogu.com.cn/problem/P1217)  
  2. [P3383 线性筛素数](https://www.luogu.com.cn/problem/P3383)  
  3. [P1835 素数密度](https://www.luogu.com.cn/problem/P1835)  

- **调试心得**：  
  - 筛法中 `i` 应从 `2` 开始，`j` 从 `i*i` 开始，避免重复标记。  
  - 连续计数时，遇到素数需立即重置计数器，避免逻辑错误。

---
处理用时：272.68秒
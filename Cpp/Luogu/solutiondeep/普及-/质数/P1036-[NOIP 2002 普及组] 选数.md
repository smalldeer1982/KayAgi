# 题目信息

# [NOIP 2002 普及组] 选数

## 题目描述

已知 $n$ 个整数 $x_1,x_2,\cdots,x_n$，以及 $1$ 个整数 $k$（$k<n$）。从 $n$ 个整数中任选 $k$ 个整数相加，可分别得到一系列的和。例如当 $n=4$，$k=3$，$4$ 个整数分别为 $3,7,12,19$ 时，可得全部的组合与它们的和为：

$3+7+12=22$

$3+7+19=29$

$7+12+19=38$

$3+12+19=34$

现在，要求你计算出和为素数共有多少种。

例如上例，只有一种的和为素数：$3+7+19=29$。

## 说明/提示

**【题目来源】**

NOIP 2002 普及组第二题

## 样例 #1

### 输入

```
4 3
3 7 12 19
```

### 输出

```
1
```

# AI分析结果



### 综合分析与结论
本题核心在于生成所有k元组合并判断和是否为素数。高效解法普遍采用DFS+剪枝策略，通过"不降原则"避免重复组合，并辅以素数判断优化。以下是优质题解分析及关键思路总结：

---

### 精选题解 (4星及以上)

#### 1. 作者：dbxxx（5星）
**关键亮点**  
- 采用DFS+不降原则剪枝，通过`startx`参数确保组合严格递增，彻底避免重复  
- 代码简洁高效，参数设计清晰（已选数、当前和、起始索引）  
- 包含详细思路解释，尤其对"不降原则"的示例说明非常到位  

**核心代码**  
```cpp
void dfs(int m, int sum, int startx) {
    if (m == k) { // 选够k个数时判断素数
        if (isprime(sum)) ans++;
        return;
    }
    for (int i = startx; i < n; i++) // 关键：从startx开始枚举
        dfs(m + 1, sum + a[i], i + 1); // i+1确保下一层只能选后面的数
}
```

**个人心得**  
- 早期因未移除`freopen`导致WA，提醒注意输入输出重定向  
- 通过多次修改代码风格提升可读性，体现代码规范的重要性  

#### 2. 作者：LihRek（4星）
**关键亮点**  
- 极简DFS实现，参数设计更直观（当前索引、已选数量、总和）  
- 采用试除法素数判断，但通过`sqrt`优化确保效率  
- 代码无冗余，适合快速理解DFS核心逻辑  

**核心代码**  
```cpp
void rec(int start, int count, int sum) {
    if (count == k) { 
        if (isprime(sum)) ans++;
        return;
    }
    for (int i = start; i <= n; i++) // 从start开始选数
        rec(i + 1, count + 1, sum + a[i]);
}
```

---

### 关键思路与技巧
1. **不降原则剪枝**：通过限制每次选择的起始索引，确保组合严格递增，避免重复计算  
2. **高效素数判断**：试除至平方根（O(√n)）或预筛法（数据范围大时）  
3. **递归参数设计**：携带起始索引、已选数量、当前和，自然形成组合树  

---

### 拓展建议
- **同类型题目**：组合求和类问题（如P1036 选数）、全排列问题（P1706）、素数筛法（P3383）  
- **优化方向**：当n较大时可改用动态规划（背包思想）统计和的出现次数  

---

### 推荐练习题
1. [P1036 选数](https://www.luogu.com.cn/problem/P1036)  
   - 几乎相同的题目，直接应用本题解法  
2. [P1706 全排列问题](https://www.luogu.com.cn/problem/P1706)  
   - 练习回溯与剪枝的经典题目  
3. [P3383 线性筛素数](https://www.luogu.com.cn/problem/P3383)  
   - 掌握筛法优化素数判断

---
处理用时：65.99秒
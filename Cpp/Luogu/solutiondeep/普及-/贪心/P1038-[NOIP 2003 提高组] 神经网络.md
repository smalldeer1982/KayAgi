# 题目信息

# [NOIP 2003 提高组] 神经网络

## 题目背景

人工神经网络（Artificial Neural Network）是一种新兴的具有自我学习能力的计算系统，在模式识别、函数逼近及贷款风险评估等诸多领域有广泛的应用。对神经网络的研究一直是当今的热门方向，兰兰同学在自学了一本神经网络的入门书籍后，提出了一个简化模型，他希望你能帮助他用程序检验这个神经网络模型的实用性。



## 题目描述

在兰兰的模型中，神经网络就是一张有向图，图中的节点称为神经元，而且两个神经元之间至多有一条边相连，下图是一个神经元的例子：

![](https://cdn.luogu.com.cn/upload/image_hosting/61qm40kj.png)

神经元（编号为 $i$）


图中，$X_1 \sim X_3$ 是信息输入渠道，$Y_1 \sim Y_2$ 是信息输出渠道，$C_i$ 表示神经元目前的状态，$U_i$ 是阈值，可视为神经元的一个内在参数。

神经元按一定的顺序排列，构成整个神经网络。在兰兰的模型之中，神经网络中的神经元分为几层；称为输入层、输出层，和若干个中间层。每层神经元只向下一层的神经元输出信息，只从上一层神经元接受信息。下图是一个简单的三层神经网络的例子。

![](https://cdn.luogu.com.cn/upload/image_hosting/4xd7f8yz.png)

兰兰规定，$C_i$ 服从公式：（其中 $n$ 是网络中所有神经元的数目）

$$C_i=\left(\sum\limits_{(j,i) \in E} W_{ji}C_{j}\right)-U_{i}$$

公式中的 $W_{ji}$（可能为负值）表示连接 $j$ 号神经元和 $i$ 号神经元的边的权值。当 $C_i$ 大于 $0$ 时，该神经元处于兴奋状态，否则就处于平静状态。当神经元处于兴奋状态时，下一秒它会向其他神经元传送信号，信号的强度为 $C_i$。

如此．在输入层神经元被激发之后，整个网络系统就在信息传输的推动下进行运作。现在，给定一个神经网络，及当前输入层神经元的状态（$C_i$），要求你的程序运算出最后网络输出层的状态。



## 说明/提示

**【题目来源】**

NOIP 2003 提高组第一题

## 样例 #1

### 输入

```
5 6
1 0
1 0
0 1
0 1
0 1
1 3 1
1 4 1
1 5 1
2 3 1
2 4 1
2 5 1
```

### 输出

```
3 1
4 1
5 1
```

# AI分析结果



### 综合分析与结论
本题核心是通过拓扑排序处理分层DAG结构，关键点包括：输入层阈值处理、状态传递条件判断、输出层识别。优质题解需具备清晰的拓扑实现、合理的阈值处理逻辑、完备的边界条件判断。以下精选3个高质量题解：

---

### 精选题解分析

#### 1. Lucaster_（5星）
**核心亮点**：
- 预处理输入层与非输入层阈值差异（输入层不减u）
- 使用出度数组快速判断输出层
- 队列拓扑实现简洁，更新版代码优化冗余逻辑
- 包含调试经历：通过多次修正队列处理逻辑解决错误

**关键代码**：
```cpp
// 预处理输入层与非输入层
for(int i=1;i<=n;++i){
    scanf("%d%d",&c[i],&x);
    if(c[i]) { q.push(i); vis[i]=true; } // 输入层直接入队
    else { c[i] -= x; } // 非输入层预减阈值
}

// 拓扑处理核心逻辑
while(!q.empty()){
    h=q.front(); q.pop();
    if(c[h]<=0) continue; // 仅兴奋状态传递
    for(i=hd[h];i;i=e[i].next){
        t=e[i].to;
        c[t] += e[i].val * c[h]; // 累加传递值
        if(!vis[t]) q.push(t), vis[t]=true; // 防止重复入队
    }
}
```

#### 2. zzlzk（4星）
**核心亮点**：
- 公式变形后统一处理阈值（c[i]+u[i]=Σw*c[j]）
- 拓扑排序中动态计算状态值
- 输出时直接判断出度为0且状态>0的节点

**关键洞见**：
```cpp
// 公式推导后的处理
c[i] = sum_weights - u[i]; 
// 拓扑时仅当入度归零才计算最终状态
if(in[v]==0) c[v] -= u[v]; 
```

#### 3. faker121（4星）
**核心亮点**：
- 优先队列处理输出顺序问题
- 引入inque数组防止重复处理
- 明确输出层判断与NULL处理逻辑

**调试经验**：
> "最后输出时忘了NULL判断导致80分，加flag变量后AC"

---

### 关键思路总结
1. **拓扑排序**：确保按层处理节点，使用队列/栈维护处理顺序
2. **阈值预处理**：输入层直接激活，非输入层初始减u[i]
3. **状态传递条件**：仅当c[i]>0时向下一层传播
4. **输出层识别**：通过出度数组快速判断（出度=0）
5. **边界处理**：输入层可能同时是输出层需特殊判断

---

### 拓展训练题推荐
1. **P1113 杂务** - 拓扑排序+DP求最长路径
2. **P4017 最大食物链计数** - DAG拓扑计数应用
3. **P1807 最长路** - DAG动态规划典型题

---

### 同类型技巧
- **DAG动态规划**：处理具有依赖关系的状态转移
- **入度/出度统计**：快速识别输入/输出层节点
- **队列拓扑实现**：相比递归更易处理复杂依赖关系
- **状态剪枝**：通过条件判断（如c[i]>0）减少无效计算

---
处理用时：54.24秒
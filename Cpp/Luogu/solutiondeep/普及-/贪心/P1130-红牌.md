# 题目信息

# 红牌

## 题目描述


某地临时居民想获得长期居住权就必须申请拿到红牌。获得红牌的过程是相当复杂 ，一共包括 $N$ 个步骤。每一步骤都由政府的某个工作人员负责检查你所提交的材料是否符合条件。为了加快进程，每一步政府都派了 $M$ 个工作人员来检查材料。不幸的是，并不是每一个工作人员效率都很高。尽管如此，为了体现“公开政府”的政策，政府部门把每一个工作人员的处理一个申请所花天数都对外界公开。

为了防止所有申请人都到效率高的工作人员去申请。这 $M \times N$ 个工作人员被分成 $M$ 个小组。每一组在每一步都有一个工作人员。申请人可以选择任意一个小组也可以更换小组。但是更换小组是很严格的，一定要相邻两个步骤之间来更换，而不能在某一步骤已经开始但还没结束的时候提出更换，并且也只能从原来的小组 $I$ 更换到小组 $I+1$，当然从小组 $M$ 可以更换到小组 $1$。对更换小组的次数没有限制。

例如：下面是 $3$ 个小组，每个小组 $4$ 个步骤工作天数：

- 小组 $1$： $2, 6 ,1 ,8$；
- 小组 $2$：$3,6, 2, 6$；
- 小组 $3$：$ 4, 2 ,3 ,6$。

例子中，可以选择小组 $1$ 来完成整个过程一共花了$2+6+1+8=17$ 天，也可以从小组 $2$ 开始第一步，然后第二步更换到小组 $3$，第三步到小组 $1$，第四步再到小组 $2$，这样一共花了 $3+2+1+6=12$ 天。你可以发现没有比这样效率更高的选择。

你的任务是求出完成申请所花最少天数。

## 说明/提示

对于 $100\%$ 的数据，$1\le N,M \le 2000$。

## 样例 #1

### 输入

```
4 3 
2 6 1 8
3 6 2 6
4 2 3 6
```

### 输出

```
12```

# AI分析结果



### 综合分析与结论
该题本质是环形路径的动态规划问题，核心在于状态转移时处理环形边界。各题解均采用动态规划，主要差异在于：
1. 状态定义方式（正向阶段递推 vs 逆序更新）
2. 环形处理技巧（特判首尾 vs 数组复制成环）
3. 空间优化策略（二维数组 vs 滚动优化）

最优思路为：定义`f[i][j]`为第i阶段第j组的最小天数，通过特判处理环形转移，时空复杂度均为O(NM)。

---

### 高星题解推荐

#### 1. whx1003（★★★★★）
**核心亮点**：
- 清晰的状态转移方程，直观处理环形边界
- 巧妙处理输入转置技巧
- 代码简洁（仅20行）且可读性强

**关键代码**：
```cpp
for(int i=1; i<=n; ++i)
    for(int j=1; j<=m; ++j)
        f[i][j] = std::min(f[i-1][j], j==1 ? f[i-1][m] : f[i-1][j-1]) + a[i][j];
```
**实现思想**：将输入矩阵转置为`a[阶段][小组]`，每个状态从前一阶段同组或前驱组转移。

#### 2. 引领天下（★★★★☆）
**核心亮点**：
- 逆序更新的创新思路
- 原地修改输入数组节省空间
- 避免显式处理环形逻辑

**关键代码**：
```cpp
for(int j=n-2;j>=0;j--)
    for(int i=0;i<m;i++)
        a[i][j] = min(a[(i+1)%m][j+1],a[i][j+1]) + a[i][j];
```
**实现思想**：从倒数第二步反向更新，每个位置存储后续步骤的最小累计值。

#### 3. dz_ice（★★★★☆）
**核心亮点**：
- 环形处理技巧（数组复制成双倍长度）
- 类似石子合并问题的解决方案
- 简化边界判断

**关键代码**：
```cpp
n = 2*n; // 复制数组
for(int i=1; i<=n; i++)
    for(int j=1; j<=m; j++)
        f[i][j] = min(f[i-1][j-1], f[i][j-1]) + a[i][j];
```
**实现思想**：将小组数组复制为两倍长度，将环形问题转化为线性问题处理。

---

### 关键技巧总结
1. **输入转置**：将`小组×步骤`输入转为`步骤×小组`存储，更符合DP递推逻辑
2. **环形处理**：使用`j==1 ? m : j-1`或`(i+1)%m`处理首尾相接
3. **逆序更新**：从最后步骤倒推，避免存储完整DP表
4. **空间优化**：可仅保留前一阶段的状态数组（滚动数组）

---

### 同类题目推荐
1. P1216 [数字三角形](https://www.luogu.com.cn/problem/P1216) - 经典路径DP
2. P1880 [石子合并](https://www.luogu.com.cn/problem/P1880) - 环形区间DP
3. P1006 [传纸条](https://www.luogu.com.cn/problem/P1006) - 双路径DP

---

### 调试经验摘录
- **Komorebi_shine**："被同学带偏转移方程，后意识到只能正向换组"
- **juruo_zjc**："初始将小组与步骤维度混淆，调整循环顺序后AC"
- **Waddles**："尝试记忆化搜索时发现边界处理困难，最终改用递推"

**启示**：环形问题建议先画出状态转移图，明确合法转移路径后再写代码。

---
处理用时：47.80秒
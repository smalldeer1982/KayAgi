# 题目信息

# [USACO2.1] 三值的排序 Sorting a Three-Valued Sequence

## 题目描述

排序是一种很频繁的计算任务。现在考虑最多只有三值的排序问题。一个实际的例子是，当我们给某项竞赛的优胜者按金银铜牌排序的时候。在这个任务中可能的值只有三种 $1,2,3$。我们用交换的方法把他排成升序的。

写一个程序计算出，给定的一个 $1,2,3$ 组成的数字序列，排成升序所需的最少交换次数


## 说明/提示

【数据范围】  
对于 $100\%$ 的数据，$1\le n \le 1000$。

USACO 2.1

翻译来自NOCOW


## 样例 #1

### 输入

```
9
2
2
1
3
3
3
2
3
1```

### 输出

```
4
```

# AI分析结果



### 综合分析与结论
本题核心在于通过贪心策略优先处理双环交换，再处理剩余三环交换。最优解的关键思路是统计各区域元素分布，优先交换能一次修正两个错误的数对，剩余错误通过三元素循环处理。以下题解较好地实现了这一思路。

---

### 高分题解推荐

#### 1. 作者：Celebrate（4星）
**关键亮点**：  
- 分阶段处理交换：优先处理1-2、1-3、2-3的直接交换，剩余错误统一用三环公式计算  
- 代码简洁高效，逻辑清晰  
- 正确应用贪心与数学推导  

**核心代码**：
```cpp
for(int i=1;i<=s[1];i++) //处理1区的2与2区的1交换
    if(a[i]==2)
        for(int j=s[1]+1;j<=s[2];j++)
            if(a[j]==1) swap(a[i],a[j]), ans++;
// 类似处理其他情况...
int ss=0; //统计剩余错误
for(int i=1;i<=s[1];i++) if(a[i]!=1) ss++;
//...其他区域统计
ans += ss*2/3; //三环处理公式
```

#### 2. 作者：liaohaoping（4星）
**关键亮点**：  
- 显式分为三次贪心交换阶段  
- 剩余错误用 `ss*2/3` 公式直接计算  
- 代码结构清晰，易于理解  

**核心代码**：
```cpp
// 三次交换阶段
for(处理1区的2与2区的1交换)...
for(处理1区的3与3区的1交换)...
for(处理2区的3与3区的2交换)...

int ss=0; //统计剩余错误
ans += ss*2/3; //三环处理
```

#### 3. 作者：「QQ红包」（4星）
**关键亮点**：  
- 使用二维数组统计各区域分布  
- 分类型处理交换后直接计算剩余错误  
- 代码结构紧凑，数学推导严谨  

**核心代码**：
```cpp
// 统计各区域分布c[区域][元素]
for(int j=1区范围) c[1][a[j]]++;
for(int j=2区范围) c[2][a[j]]++;
// 处理交换...
ans += (剩余错误数)*2/3;
```

---

### 最优思路总结
1. **区域统计**：将排序后的序列分为1区、2区、3区，统计每个区内的元素分布  
2. **双环交换**：优先交换能直接修正两个错误的数对（如1区的2与2区的1）  
3. **三环处理**：剩余错误必定形成三元素循环，每个循环需两次交换，公式为 `剩余错误数*2/3`  

---

### 拓展建议
1. **类似题目**  
   - P1177 【快速排序】：基础排序思维  
   - P1327 【数列排序】：最小交换次数变体  
   - P1968 美元汇率：贪心策略应用  

2. **调试经验**  
   - 输入处理需注意特殊字符（如换行符），避免低级错误  
   - 三环公式推导可通过画图验证：三个元素A→B→C→A的循环需要两次交换  

---

### 关键代码实现
以Celebrate的代码为例，完整处理逻辑：
```cpp
// 处理直接交换
for(int i=1;i<=s[1];i++) {
    if(a[i]==2) { //1区的2与2区的1交换
        for(int j=s[1]+1;j<=s[2];j++)
            if(a[j]==1) { swap(a[i],a[j]); ans++; break; }
    }
    // 类似处理其他情况...
}

// 统计剩余错误
int ss=0;
for(int i=1;i<=s[1];i++) if(a[i]!=1) ss++;
//...其他区域统计

// 三环处理公式
ans += ss*2/3;
```

---
处理用时：115.81秒
# 题目信息

# [USACO17OPEN] Paired Up S

## 题目描述

Farmer John 发现，当他的奶牛附近有另一头奶牛提供精神支持时，每头奶牛挤奶会更容易。因此，他希望将他的 $M$ 头奶牛（$M \leq 1,000,000,000$，$M$ 为偶数）分成 $M/2$ 对。每对奶牛将被引导到谷仓中一个单独的隔间进行挤奶。这些 $M/2$ 个隔间中的挤奶过程将同时进行。

为了增加一些复杂性，Farmer John 的每头奶牛都有不同的产奶量。如果产奶量分别为 $A$ 和 $B$ 的两头奶牛被配对，那么挤完它们总共需要 $A+B$ 单位时间。

请帮助 Farmer John 确定整个挤奶过程完成所需的最少时间，假设他以最佳方式配对奶牛。

## 说明/提示

在这里，如果产奶量为 8 和 2 的奶牛配对，产奶量为 5 和 5 的奶牛配对，那么两个隔间的挤奶时间均为 10 单位时间。由于挤奶是同时进行的，因此整个挤奶过程将在 10 单位时间后完成。任何其他配对方式都会导致某个隔间的挤奶时间超过 10 单位时间，因此不是最优的。

## 样例 #1

### 输入

```
3
1 8
2 5
1 2```

### 输出

```
10```

# AI分析结果



### 综合分析与结论
本题需将奶牛两两配对，使得所有配对中产奶时间之和的最大值最小化。所有题解均采用贪心策略：按产奶量排序后，用双指针将最小与最大产奶量配对，批量处理同产奶量组的数量以优化时间复杂度。核心难点在于正确实现批量配对逻辑与边界条件处理。

---

### 精选题解

#### 1. 作者：x_faraway_x（⭐⭐⭐⭐⭐）
- **关键亮点**：代码简洁高效，正确处理批量配对逻辑，时间复杂度O(n)。
- **个人心得**：通过比较两端奶牛数量差值动态调整指针，避免逐个处理。
- **核心代码**：
```cpp
sort(a+1,a+1+n,cmp); // 按产奶量升序排序
int i=1,j=n;
while(i<=j) {
    ans = max(ans, a[i].y + a[j].y);
    if(a[i].x > a[j].x) { // 处理数量较大的产奶量较小组
        a[i].x -= a[j].x;
        j--;
    } else if(a[i].x < a[j].x) { // 处理数量较大的产奶量较大组
        a[j].x -= a[i].x;
        i++;
    } else { // 数量相等时同时移动指针
        i++; j--;
    }
}
```

#### 2. 作者：PersistentLife（⭐⭐⭐⭐⭐）
- **关键亮点**：详细分析贪心正确性，优化思路清晰，提供错误案例与修正方法。
- **个人心得**：初始代码因逐个处理导致超时，优化为批量处理后才AC。
- **核心代码**：
```cpp
sort(c+1, c+1+n, cmp); // 按产奶量降序排序
int i=1,j=n;
while(i<=j) {
    ans = max(ans, c[i].y + c[j].y);
    int t = min(c[i].x, c[j].x); // 批量处理配对数量
    c[i].x -= t;
    c[j].x -= t;
    if(c[i].x == 0) i++;
    if(c[j].x == 0) j--;
}
```

#### 3. 作者：ZhanPJ（⭐⭐⭐⭐）
- **关键亮点**：逻辑清晰，强调贪心策略的正确性，代码可读性强。
- **核心思路**：首尾指针逐步内缩，确保每次配对都取到当前最小可能的局部最大值。

---

### 最优关键思路与技巧
1. **排序策略**：按产奶量升序排列，确保双指针能正确配对最小与最大值。
2. **批量处理**：通过比较两端奶牛组的数量差，直接计算可配对次数，避免逐个处理。
3. **双指针维护**：动态调整指针位置，保证时间复杂度为O(n)，适用于大数据量。
4. **边界处理**：当两端数量相等时同时移动指针，防止遗漏剩余奶牛。

---

### 拓展与相似题目
1. **举一反三**：类似贪心配对问题（如活动选择、区间分组）均可采用排序+双指针/优先队列优化。
2. **推荐题目**：
   - P1090 [NOIP2004 提高组] 合并果子（贪心+优先队列）
   - P1223 排队接水（排序贪心）
   - P1842 [USACO05NOV] 奶牛玩杂技（排序贪心）

---

### 调试与心得摘录
- **PersistentLife**：初始版本因逐个处理导致超时，意识到必须批量处理数量差。
- **Tatayy**：强调代码中必须用`x<=0`而非`x==0`，避免负数导致死循环。
- **LZOI_LYH**：参考官方题解后调整排序方向，确保正确性。

---
处理用时：58.69秒
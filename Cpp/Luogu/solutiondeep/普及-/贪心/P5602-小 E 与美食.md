# 题目信息

# 小 E 与美食

## 题目背景

小 E 是一个热爱美食的高中生，但吃的太多会导致他身体不舒服，他想找到一个能让他最舒服的方案，快来帮帮他！

## 题目描述

小 E 有 $n$ 种美食可供选择，每种美食只能吃一次，第 $i$ 种美食有一个美味值 $a_i$，吃下一个美味值为 $a_i$ 的美食可以让小 E 的满足感提升 $a_i$。

但是小 E 的胃是有极限的，每吃下一个美食，他的饱腹感就会提升 $1$。

小 E 最后的舒适度是他的满足感的平方除以他的饱腹感，你的目标是求出他舒适度能达到的最大值。

## 说明/提示

**提示**

建议输出**至少 $8$ 位**有效数字。

**样例解释**

容易发现两种美食都吃是最优的，舒适度为 $\frac{(2+1)^2}{2} = 4.5$。

**数据范围**

对于 $30 \%$ 的数据，$n, a_i \le 20$。

对于 $50 \%$ 的数据，$n, a_i \le 2000$。

对于另 $15 \%$ 的数据，所有 $a_i$ 都相等。

对于 $100 \%$ 的数据，$1 \le n \le 3 \times 10^{5}$，$1 \le a_i  \le 10^6$。

## 样例 #1

### 输入

```
2
2 1```

### 输出

```
4.50```

# AI分析结果



### 综合分析与结论
本题需在排序后贪心选择前k大元素，并计算舒适度最大值。关键点在于排序策略、避免溢出处理及利用单峰性质优化。正确解法需枚举所有k或利用单峰提前终止，核心是正确计算并比较每个k的舒适度。

### 精选题解
#### 1. lytqwq 的题解（★★★★★）
**关键亮点**：
- 降序排序后从大到小累加，确保每次取最优。
- 处理溢出：先除后乘，使用`long long`存储sum。
- 代码简洁高效，直接枚举所有k取最大值。

**核心代码**：
```cpp
sort(a+1,a+n+1); // 升序排序，后续倒序遍历
for(int i=n;i>=1;i--) {
    sum += a[i];
    maxn = max(maxn, sum * 1.0 / (n-i+1) * sum); // 先除后乘
}
```
**实现思想**：倒序遍历排序后的数组，累加sum时直接处理分母（n-i+1），避免平方溢出。

#### 2. 爱晚亭哦 的题解（★★★★☆）
**关键亮点**：
- 动态判断舒适度增长，提前终止减少计算。
- 快读优化输入，适合大数据量。
- 使用double计算避免中间溢出。

**核心代码**：
```cpp
sort(a+1,a+1+n,cmp); // 降序排序
for(int i=1;i<=n;i++) {
    if((sum+a[i])*(sum+a[i])/i > ans) {
        sum += a[i];
        ans = (sum * sum) / i;
    } else break;
}
```
**实现思想**：每次检查添加新元素后的舒适度是否更优，否则终止循环，基于单峰性质优化。

#### 3. phigy 的题解（★★★★☆）
**关键亮点**：
- 数学公式推导舒适度变化，直观判断是否继续。
- 直接比较相邻k值舒适度，逻辑清晰。

**核心代码**：
```cpp
sort(a+1,a+n+1,cmp); // 降序排序
ans = a[1]; // 初始为第一个元素
for(int i=2;i<=n;i++) {
    if((ans*ans/(i-1)) < pow(ans+a[i],2)/i) {
        ans += a[i];
    } else break;
}
```
**实现思想**：利用相邻k值的舒适度比较，确保每次扩展k时结果更优，提前终止无效计算。

### 关键思路与技巧总结
1. **贪心排序**：降序排列后选择前k大元素，确保总和最大。
2. **溢出处理**：调整计算顺序（先除后乘）或使用高精度类型。
3. **单峰优化**：舒适度随k先增后减，首次下降时即可终止循环。

### 拓展与相似题目
- **类似贪心选择**：[P1478 陶陶摘苹果](https://www.luogu.com.cn/problem/P1478)
- **排序与最优组合**：[P1223 排队接水](https://www.luogu.com.cn/problem/P1223)
- **双指针/贪心策略**：[P1094 纪念品分组](https://www.luogu.com.cn/problem/P1094)

### 个人心得摘录
- **lytqwq**：强调开`long long`和计算顺序，避免WA。
- **Ares゜**：首次尝试橙题多次WA，提醒注意变量初始化与输出精度。
- **Magallan_forever**：前缀和未用`double`导致溢出，强调数据类型选择的重要性。

---
处理用时：301.87秒
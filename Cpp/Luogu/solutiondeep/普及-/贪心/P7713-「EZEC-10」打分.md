# 题目信息

# 「EZEC-10」打分

## 题目背景

**为防止评测机被卡，本题时限为 100 ms。**

## 题目描述

小 A 去参加奥运会。

奥运会中共有 $n$ 名裁判，分别给小 A 打分 $a_1,a_2,\ldots,a_n$。

小 A 对自己的得分不满意，于是他将某名裁判打出的分数加 $1$，称为一次操作。

但是小 A 不能太贪心，他最多只能进行 $m$ 次操作。

小 A 的最终得分为：所有得分中，去掉一个最高分和一个最低分后的平均值。

小 A 想知道，他的最终得分最高为多少。

## 说明/提示

**【样例 1 解释】**

一种可行的方案为：$[1,2,3]\to [3,2,3]$。

**【样例 2 解释】**

一种可行的方案为：$[1,2,2,3]\to [2,3,3,3]$。

**【数据规模与约定】**

**本题采用捆绑测试。**

- Subtask 1（5 points）：$m=0$。
- Subtask 2（10 points）：$n=3$。
- Subtask 3（15 points）：$n,m\le 10^3$。
- Subtask 4（70 points）：无特殊限制。

对于 $100\%$ 的数据，$3\le n\le 10^5$，$0\le m,a_i\le 10^9$。

## 样例 #1

### 输入

```
3 2
1 2 3```

### 输出

```
3```

## 样例 #2

### 输入

```
4 3
1 2 2 3```

### 输出

```
6```

# AI分析结果



### 综合分析结论
本题核心在于贪心策略与数学推导的结合。所有优质题解均基于以下两点：  
1. 忽略最小值，所有操作只针对中间分数和最大值  
2. 分两阶段处理：先填平中间分数到当前最大值，再均匀分配剩余操作次数  
时间复杂度均为 O(n log n)，主要来自排序步骤。

---

### 精选题解推荐

#### 1. 作者：Maxmilite（5星）
**核心亮点**  
- 数学推导最简洁，直接通过比较总和判断阶段切换  
- 代码实现仅需一次判断，无需复杂循环  
- 使用整数运算避免精度问题，公式推导严谨  
**关键代码**  
```cpp
sort(a + 1, a + n + 1);
unsigned long long cur = 0;
for (int i(2); i <= n - 1; ++i) cur += a[i];
if (cur + m < (n - 2) * a[n]) // 阶段1未填满
    printf("%llu\n", (cur + m));
else // 阶段2均匀分配
    printf("%llu\n", (cur + m + a[n]) * (n - 2) / (n - 1));
```

#### 2. 作者：BotDand（4星）  
**核心亮点**  
- 明确计算填平所需的操作次数  
- 余数处理时优先保证中间分数收益  
**注意点**  
余数计算部分 `ans += (y-1)` 需仔细验证边界情况

#### 3. 作者：YYen（4星）  
**核心亮点**  
- 通过示例直观解释贪心策略  
- 详细分步注释增强可读性  
**个人心得**  
"逆序逐个加保证相对位置" 的调试经验值得借鉴

---

### 最优关键思路总结
1. **排序去最小**：排序后忽略第一个元素（最小值）  
2. **两阶段策略**：  
   - 阶段1：将中间分数提升至原最大值  
   - 阶段2：剩余操作均匀分配到中间分数和最大值组成的n-1个元素  
3. **数学公式化**：  
   - 填满阶段总和 = 原中间和 + m  
   - 溢出阶段总和 = (总操作数 + 原最大值) × (n-2)/(n-1)

---

### 拓展延伸
**同类题目推荐**  
1. [P1230 智力大冲浪](https://www.luogu.com.cn/problem/P1230)（贪心+截止时间）  
2. [P1094 纪念品分组](https://www.luogu.com.cn/problem/P1094)（双指针贪心）  
3. [P1080 国王游戏](https://www.luogu.com.cn/problem/P1080)（贪心+高精度）

**算法套路**  
"分阶段贪心+数学推导" 的组合在以下场景常见：  
- 存在两种操作模式（如填平后均匀分配）  
- 需要快速计算大规模操作后的聚合值  
- 操作收益呈现明显阶段性变化特征

---
处理用时：69.02秒
# 题目信息

# 『PG1』[JDWOI-2] 猪猪大厦

## 题目描述

$ \texttt{piggy} $ 建了一个巨大无比的 $\texttt {PIG}$ 大厦，可以看做一个平面，在这个平面上有 $n$ 个无限长的不垂直或平行于地面的扶手电梯，可以看做一些一次函数，并且这些电梯方向均朝右即 $x$ 轴正方向。

两个电梯的交汇点可以花 $1 \ \texttt{ZMB}$ 换乘。

一个人想要给  $ \texttt{piggy} $ 发短信让 $ \texttt{piggy} $ 过去找他 。

但是：

![](https://cdn.luogu.com.cn/upload/image_hosting/m2hw7oer.png)

于是只能走过去找 $ \texttt{piggy} $。

此时他站在第 $x_1$ 个电梯的横坐标为 $y_1$ 位置。

$ \texttt{piggy} $ 在第 $x_2$ 个电梯的横坐标为 $y_2$ 位置。

请问他最少花多少 $\texttt{ZMB}$ 才能过去？



## 说明/提示

**本题采用 Subtask。**

$\sf Subtask1(20pts)$：$1 \le n \le 10$；

$\sf Subtask2(30pts)$：$1 \le n\le 1000$；

$\sf Subtask3(50pts)$：$1 \le x_1,x_2 \le n\le 10^5$，$-10^3 \le y_1,y_2,k_i,b_i \le 10^3$。

**电梯的编号从 1 开始。**

## 样例 #1

### 输入

```
1
1 1 1 2
50 -30```

### 输出

```
0```

## 样例 #2

### 输入

```
2
1 2 2 2
1 0
2 0```

### 输出

```
-1```

## 样例 #3

### 输入

```
2
1 -1 2 1
1 0
2 0```

### 输出

```
1```

# AI分析结果



### 综合分析与结论
该题核心在于分析电梯的换乘逻辑，利用数学推导得出最多仅需两次换乘。正确解法需分三种情况处理，时间复杂度为 O(n)，关键点在于计算直线交点并判断位置关系。

---

### 高星题解推荐

#### 1. kyBWE（⭐⭐⭐⭐⭐）
**关键亮点**：
- 清晰的三类情况划分与数学证明，逻辑严密。
- 直接计算交点坐标，避免冗余判断，代码简洁高效。
- 处理浮点数精度时采用 `*1.0` 显式转换，避免整数除法错误。

**核心思路**：
```cpp
// 情况一：同一直线
if (x1 == x2 && y1 <= y2) return 0;
// 情况二：直接换乘
double x0 = (b[x2] - b[x1]) * 1.0 / (k[x1] - k[x2]);
if (y1 <= x0 && y2 >= x0) return 1;
// 情况三：两次换乘
for (int i = 1; i <= n; i++) {
    double xj1 = (b[i] - b[x1]) * 1.0 / (k[x1] - k[i]);
    double xj2 = (b[x2] - b[i]) * 1.0 / (k[i] - k[x2]);
    if (y1 <= xj1 && xj1 <= xj2 && xj2 <= y2) return 2;
}
```

#### 2. 信息向阳花木（⭐⭐⭐⭐）
**关键亮点**：
- 通过图示辅助说明三类情况，直观易懂。
- 强调变量命名避免与系统保留字冲突（如不使用 `y1`）。

**核心判断逻辑**：
```cpp
// 计算两直线交点横坐标
double jd = (b[c] - b[a]) * 1.0 / (k[a] - k[c]);
if (b <= jd && d >= jd) return 1;
```

#### 3. NightTide（⭐⭐⭐⭐）
**关键亮点**：
- 给出数学证明，严格推导最多两次换乘的结论。
- 代码中通过结构体封装电梯参数，提高可读性。

**代码片段**：
```cpp
double cal(ana u, ana v) { // 计算交点横坐标
    return (double)((double)(u.b - v.b) / (v.k - u.k));
}
```

---

### 最优关键思路总结
1. **数学建模**：将电梯抽象为直线，换乘点即直线交点。
2. **分类讨论**：
   - 直接可达（0次换乘）
   - 单次换乘（交点位于两坐标之间）
   - 两次换乘（存在中间直线使交点有序）
3. **浮点数处理**：显式转换为 `double` 避免计算错误。

---

### 相似题目推荐
1. [P1354 房间最短路问题](https://www.luogu.com.cn/problem/P1354) - 几何+最短路
2. [P1021 计算鞍点](https://www.luogu.com.cn/problem/P1021) - 二维坐标极值判断
3. [P2774 方格取数问题](https://www.luogu.com.cn/problem/P2774) - 网格路径规划与条件判断

---
处理用时：79.08秒
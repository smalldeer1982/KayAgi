# 题目信息

# [USACO23JAN] Moo Operations B

## 题目描述

农夫约翰给了奶牛贝西 $Q$ 个新字符串 $(1\le Q\le100)$ ，其中只有字符 `M` 和 `O` ，她想将 $Q$ 个字符串都变成 `MOO`。

贝西可以用如下的方式改变字符串：
- 用相反的字符替换第一个或最后一个字符（将 `M` 变成 `O` ，将 `O` 变成 `M` ）。
- 删除第一个或最后一个字符。

贝西只想用最少的次数完成改变。请你帮她找到需要的最小改变次数。如果不可能在有限的步数中完成这个任务，请输出 `-1` 。

## 说明/提示

### 样例解释 1
将第一个字符串转换为 `MOO`的 $4$ 个操作序列如下：
- 用O替换最后一个字符（操作1）
- 删除第一个字符（操作2）
- 删除第一个字符（操作2）
- 删除第一个字符（操作2）

可以证明，第二个字符串无法转换为 `MOO`。 

第三个字符串已经是 `MOO`，因此无需执行任何操作。

对于 $100\%$ 的测试点，保证 $1 \le Q \le 100$, $ 1\le |S| \le 100$ 。

## 样例 #1

### 输入

```
3
MOMMOM
MMO
MOO```

### 输出

```
4
-1
0```

# AI分析结果



### 综合分析与结论

题目要求将字符串转换为 "MOO" 的最小操作次数，关键在于找到中间为 'O' 的三字符子串，调整首尾字符后加上删除次数。若不存在中间为 'O' 的子串则无解。正确的解法需遍历所有中间为 'O' 的子串，计算首尾修改次数的最小值。

---

### 高星题解推荐

#### 1. 作者：Loser_Syx（★★★★★）
**关键亮点**：
- **中间固定条件**：仅处理中间为 'O' 的子串，避免无效枚举。
- **简洁计算**：首尾字符是否需要修改直接通过布尔值累加，逻辑清晰。
- **代码可读性高**：直接遍历子串并计算，结构简洁。

**核心代码**：
```cpp
for(int i = 0; i <= len - 3; i++){
    string str = s.substr(i, 3);
    if(str[1] == 'M') continue; // 跳过中间非O的情况
    int cnt = 0;
    if(str[0] == 'O') cnt++;   // 首字符需修改为M
    if(str[2] == 'M') cnt++;   // 尾字符需修改为O
    ans = min(ans, cnt);
}
```

#### 2. 作者：鱼跃于渊（★★★★★）
**关键亮点**：
- **数学优化**：通过表达式 `s.size()-1 - (右边是O) - (左边是M)` 直接计算总操作次数，代码极简。
- **高效覆盖**：遍历所有中间 'O' 的位置，快速验证所有可能情况。

**核心代码**：
```cpp
for(int i = 1, l = s.size() - 1; i < l; i++){
    if(s[i] == 'O') {
        w = min(w, int(s.size() - 1 - (s[i+1] == 'O') - (s[i-1] == 'M')));
    }
}
```

#### 3. 作者：Jorisy（★★★★★）
**关键亮点**：
- **直接枚举中间 'O'**：通过检查每个中间 'O' 的左右字符，快速计算修改次数。
- **直观逻辑**：明确中间必须为 'O'，首尾修改次数为关键。

**核心代码**：
```cpp
for(int i = 1; i < s.size() - 1; i++) {
    if(s[i] == 'O') {
        int cnt = (s[i-1] != 'M') + (s[i+1] != 'O');
        ans = min(ans, cnt);
    }
}
```

---

### 最优思路总结
1. **中间固定条件**：最终子串的中间必须为 'O'，否则无法通过修改首尾得到 "MOO"。
2. **首尾修改计算**：若中间为 'O'，首字符需为 'M'，尾字符需为 'O'，否则需对应修改次数。
3. **删除次数叠加**：总操作次数 = 修改次数 + (原长度 - 3)。

---

### 类似题目推荐
1. **P1032 [NOIP2002 提高组] 字符串变换**  
   - **相似点**：通过操作（替换、删除等）将字符串转换为目标形式，需 BFS 枚举所有可能操作。
2. **P3741 honoka的键盘**  
   - **相似点**：通过修改字符使得子串满足特定条件，需遍历并统计最优解。
3. **P1308 [NOIP2011 普及组] 统计单词数**  
   - **相似点**：在字符串中匹配特定子串，要求高效枚举和条件判断。

---

### 个人心得摘录
- **中间字符不可变**：意识到中间字符无法修改是解题的关键，直接排除了大量无效情况（Loser_Syx）。
- **数学优化**：将操作次数公式化，避免冗余判断（鱼跃于渊）。
- **避免过度枚举**：仅处理中间为 'O' 的子串，减少无效循环（Jorisy）。

---
处理用时：305.35秒
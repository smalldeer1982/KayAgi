# 题目信息

# [USACO21OPEN] Acowdemia I B

## 题目描述

由于对计算机科学的热爱，以及有朝一日成为 「Bessie 博士」的诱惑，奶牛 Bessie 开始攻读计算机科学博士学位。经过一段时间的学术研究，她已经发表了 $N$ 篇论文（$1 \le N \le 10^5$），并且她的第 $i$ 篇论文得到了来自其他研究文献的 $c_i$ 次引用（$0 \le c_i \le 10^5$）。

Bessie 听说学术成就可以用 $h$ 指数来衡量。$h$ 指数等于使得研究员有至少 $h$ 篇引用次数不少于 $h$ 的论文的最大整数 $h$。例如，如果一名研究员有 $4$ 篇论文，引用次数分别为 $(1,100,2,3)$，则 $h$ 指数为 $2$，然而若引用次数为 $(1,100,3,3)$ 则 $h$ 指数将会是 $3$。

为了提升她的 $h$ 指数，Bessie 计划写一篇综述，并引用一些她曾经写过的论文。由于页数限制，她至多可以在这篇综述中引用 $L$ 篇论文（$0 \le L \le 10^5$），并且她只能引用每篇她的论文至多一次。

请帮助 Bessie 求出在写完这篇综述后她可以达到的最大 $h$ 指数。

注意 Bessie 的导师可能会告知她纯粹为了提升 $h$ 指数而写综述存在违反学术道德的嫌疑；我们不建议其他学者模仿 Bessie 的行为。 

## 说明/提示

### 样例解释 1

Bessie 不能引用任何她曾经写过的论文。上文中提到，$(1,100,2,3)$ 的 $h$ 指数为 $2$。

### 样例解释 2

如果 Bessie 引用她的第三篇论文，引用数会变为 $(1,100,3,3)$。上文中提到，这一引用数的 $h$ 指数为 $3$。

### 测试点性质

- 测试点 $1-7$ 满足 $N\le 100$。
- 测试点 $8-10$ 满足 $N\le 1000$。
- 测试点 $11-17$ 满足 $N \le 10^5$。

## 样例 #1

### 输入

```
4 0
1 100 2 3```

### 输出

```
2```

## 样例 #2

### 输入

```
4 1
1 100 2 3```

### 输出

```
3```

# AI分析结果



### 综合分析与结论
本题要求通过最多添加L次引用，最大化h指数。核心在于快速确定满足条件的最优h值。主要解法包括贪心策略和二分法，其中二分法更稳定高效，尤其适用于大数据量场景。

---

### 精选题解

#### 题解二（作者：we_are_the_chuibing） ★★★★★
**关键亮点**：
- **二分法确定h值**：通过二分法遍历所有可能的h值，确保找到全局最优解。
- **高效判断条件**：统计现有满足h条件的论文数，并计算需要补充的数量，结合L判断可行性。
- **时间复杂度稳定**：O(n log n + log n·n)，适用于大范围数据。

**个人心得**：  
作者通过二分法将问题转化为判断函数的设计，有效避免了贪心策略可能遗漏的情况。通过分步统计当前满足条件的论文数和可提升的论文数，确保逻辑严密。

**核心代码**：
```cpp
bool check(int h) {
    int cnt = 0, count_1 = 0, count_2 = 0;
    for (int i = 1; i <= N; i++) { 
        if (quote[i] >= h) count_1++;
        if (quote[i] == h - 1) count_2++;
    }
    if (count_1 >= h) return true;
    return (count_2 >= h - count_1) && (h - count_1 <= L);
}

// 二分主逻辑
int l = 0, r = N;
while (l <= r) {
    int mid = (l + r) / 2;
    if (check(mid)) l = mid + 1;
    else r = mid - 1;
}
cout << r;
```

---

#### 题解一（作者：vectorxyz） ★★★★☆
**关键亮点**：
- **贪心策略**：通过先排序再提升关键位置的引用数，快速逼近最优解。
- **代码简洁**：通过两次排序和直接操作数组，逻辑简单直观。

**核心思想**：
1. 降序排序后计算初始h。
2. 尝试将h提升1，并将引用次数加在关键位置。
3. 重新排序后再次计算h。

**潜在问题**：当L较大时，多次排序可能影响效率。

---

### 关键思路总结
1. **二分法框架**：二分h值，通过判断函数验证可行性，是解决此类极值问题的通用方法。
2. **贪心优化点**：优先提升接近h值的论文引用，充分利用L次操作。
3. **排序预处理**：降序或升序排序后，便于快速统计满足条件的论文数。

---

### 拓展练习（洛谷题号）
1. **P2678 跳石头**：二分答案的经典应用。
2. **P2440 木材加工**：通过二分法确定最大切割长度。
3. **P4344 删数游戏**：贪心与排序结合的优化问题。

---
处理用时：221.55秒
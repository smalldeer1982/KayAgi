# 题目信息

# 添加括号III

## 题目描述

现在给出一个表达式，形如 $a_{1}/a_{2}/a_{3}/.../a_{n}$。

如果直接计算，就是一个个除过去，比如 $1/2/1/4 = 1/8$。

然而小$\text{A}$看到一个分数感觉很不舒服，希望通过添加一些括号使其变成一个整数。一种可行的办法是 $(1/2)/(1/4)=2$ 。

现在给出这个表达式，求问是否可以通过添加一些括号改变运算顺序使其成为一个整数。

## 说明/提示

- 对于 $40\%$ 的数据，$n \le 16$。
- 对于 $70\%$ 的数据，$n \le 100$。
- 对于 $100\%$ 的数据， $2 \le n \le 10000$，$1 \le t \le 100$，$1 \le a_{i}\le 2^{31}-1$。

## 样例 #1

### 输入

```
2
4
1 2 1 4
5
6 5 7 9 12```

### 输出

```
Yes
No```

# AI分析结果



### 综合分析与结论
本题核心是判断通过括号调整后，能否使表达式结果为整数。关键思路是：**将a2作为分母，其余所有数作为分子，通过约分判断最终分母能否被完全约去**。所有题解均基于此思路，通过逐步约分a2判断是否可变为1。最优解法时间复杂度为O(n)，无需高精度计算。

---

### 高星题解推荐

#### 1. 作者：kkksc03（★★★★★）
**关键亮点**：  
- 最早提出约分思路，解释清晰，代码简洁高效。
- 使用gcd逐步约分，避免大数运算，复杂度最优。
- 代码可读性强，逻辑一目了然。

**核心代码**：
```cpp
a[2]/=gcd(a[1],a[2]);
for(int i=3;i<=n;i++) 
    a[2]/=gcd(a[2],a[i]);
```
**个人心得**：指出"约分后若a2=1即为可行"，直接抓住问题本质。

#### 2. 作者：Porsche（★★★★☆）
**关键亮点**：
- 使用STL的`__gcd`函数简化代码，减少手写函数错误。
- 输入与处理同步进行，内存效率高。
- 代码极简，适合竞赛快速实现。

**核心代码**：
```cpp
cin>>n>>a[1]>>a[2];
a[2]/=__gcd(a[1],a[2]);
for(int i=3;i<=n;i++) {
    cin>>a[i];
    a[2]/=__gcd(a[2],a[i]);
}
```

#### 3. 作者：Plozia（★★★★★）
**关键亮点**：  
- 数学证明严谨，详细解释了a2必为分母的原因。
- 提供边界情况处理思路（如跳过a2）。
- 代码中强调`LL`类型防止溢出，鲁棒性强。

**核心代码**：
```cpp
for(int i=1;i<=n;i++) {
    if(i==2) continue;
    a[2] = a[2]/gcd(a[2], a[i]);
}
```

---

### 最优思路总结
**关键技巧**：  
1. **分母锁定**：a2必为分母，其余数均为分子。
2. **动态约分**：依次将每个数（a1,a3,a4,…）与a2求gcd并约分，最终检查a2是否为1。
3. **避免溢出**：通过gcd约分代替直接乘积，避免中间结果过大。

---

### 拓展与举一反三
**同类题目推荐**：  
1. [P1029 最大公约数和最小公倍数问题](https://www.luogu.com.cn/problem/P1029)  
   **考察点**：gcd与lcm的联合应用。
2. [P1072 Hankson的趣味题](https://www.luogu.com.cn/problem/P1072)  
   **考察点**：数论条件判断与因数分解。
3. [P1414 又是毕业季II](https://www.luogu.com.cn/problem/P1414)  
   **考察点**：多数的gcd性质与优化计算。

**算法套路**：  
- **数论约分问题**：优先考虑分解质因数或动态约分，避免直接计算大数。
- **括号调整类问题**：分析运算符优先级，确定关键位置（如本题的a2），构造最优表达式结构。

---
处理用时：56.01秒
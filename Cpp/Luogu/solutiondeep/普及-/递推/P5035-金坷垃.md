# 题目信息

# 金坷垃

## 题目背景

@rainheavy 原创

这是一道巨（du）水（liu）题

第一届中国国际博览会于2018年11.5--11.10在上海举行，特朗普统治的国家——美国带来了金坷垃。这是一种神奇的产品，~~肥料用了金坷垃，能吸收20米以下的氮磷钾~~（这是他们的广告）

可是，在经过富土（tu）康的质检员 DevZhu质检的时候发现出了点问题，金坷垃的效果并不像广告所说的那样。毕竟植物的根只能到深度为$1$的位置，金坷垃的效果有限


## 题目描述

它的效果只能如下：（以20为例）

20的约数（除本身）有10、5、4、2、1

从地下20米深处可以往上跳一个约数的长度（比如10）

现在它在10米处，10的约数（除本身）有5、2、1

再跳一个5，为5，5的约数（除本身）有1

再跳1个1，为4，4的约数（除本身）有2、1。

**1已用过，不能再用**

再跳一个2，为2。2的约数（除本身）有1。

**1已用过。**
此时没法再跳了。此时的深度为2。

按上述要求跳，把所有符合要求的能跳的所有情况全试一遍，只要有一种情况最后结果为$1$，这个肥料就合格，否则不合格。

DevZhu面对一大堆待检验的金坷垃，并不想检验那么多，他想问问你有哪些金坷垃是合格的，在这些合格的金坷垃中，初始深度排在第k个的是哪一个

把合格的金坷垃按初始深度从小到大排，请输出第k个金坷垃的初始深度，对$123456789$取模（富土康从不用1e9+7和998244353）

## 说明/提示

（简单死了。。。）

（给不会的人一点福利：数据里有一个是1）

对于30%的数据，$k$<=$10^5$;

对于70%的数据，$k$<=$10^9$;

对于100%的数据，$k$<=$10^{18}$；

## 样例 #1

### 输入

```
1```

### 输出

```
1```

## 样例 #2

### 输入

```
2```

### 输出

```
2```

# AI分析结果

### 综合分析与结论

本题的核心在于通过分析金坷垃的跳跃规则，发现只有2的幂次方数才能满足最终跳跃到1的条件。因此，问题转化为求第k个2的幂次方数，即$2^{k-1}$。由于k的范围极大（$k \leq 10^{18}$），直接计算会超时，因此需要使用快速幂算法来高效计算。

### 所选高星题解

#### 1. 作者：π酱 (5星)
- **关键亮点**：通过倒推和数学归纳法，详细证明了只有2的幂次方数才能满足条件，并给出了快速幂的实现代码。思路清晰，论证严谨。
- **代码核心**：
  ```cpp
  ll pow(int x,int k){
      int x1=1;
      for(;k;k>>=1,x=1ll*x*x%mod)
          if(k&1!=0)
              x1=1ll*x1*x%mod;
      return x1;
  }
  ```
  **实现思想**：通过位运算和循环实现快速幂，时间复杂度为$O(\log k)$。

#### 2. 作者：哲学家 (4星)
- **关键亮点**：通过手推和反证法，证明了只有2的幂次方数才能满足条件，并给出了快速幂的实现代码。思路清晰，代码简洁。
- **代码核心**：
  ```cpp
  long long qmi(long long x,long long k){
      long long res=1;
      while(k>0){
          if(k&1){
              res=res*x%mod;
          }
          x=x*x%mod;
          k>>=1;
      }
      return res;
  }
  ```
  **实现思想**：通过位运算和循环实现快速幂，时间复杂度为$O(\log k)$。

#### 3. 作者：Yoo_ (4星)
- **关键亮点**：通过打表找规律，发现答案为$2^{k-1}$，并给出了快速幂的实现代码。思路清晰，代码简洁。
- **代码核心**：
  ```cpp
  long long quickpow(long long a,long long b){
      long long ans=1;
      while(b){
          if(b&1)ans*=a,ans%=mod;
          a*=a,a%=mod,b>>=1;
      }
      return ans;
  }
  ```
  **实现思想**：通过位运算和循环实现快速幂，时间复杂度为$O(\log k)$。

### 最优关键思路与技巧

1. **倒推与数学归纳法**：通过倒推和数学归纳法，证明了只有2的幂次方数才能满足条件。
2. **快速幂算法**：通过位运算和循环实现快速幂，时间复杂度为$O(\log k)$，适用于大指数计算。

### 可拓展之处

1. **同类型题**：类似的问题可以通过倒推和数学归纳法来解决，如求满足特定条件的数列或序列。
2. **快速幂应用**：快速幂算法广泛应用于大指数计算，如模幂运算、矩阵快速幂等。

### 推荐题目

1. **P1226 【模板】快速幂**：快速幂的模板题，适合练习快速幂的实现。
2. **P1965 转圈游戏**：通过快速幂计算循环移动的位置，适合练习快速幂的应用。
3. **P3390 【模板】矩阵快速幂**：矩阵快速幂的模板题，适合练习矩阵快速幂的实现。

### 个人心得摘录

- **π酱**：通过倒推和数学归纳法，详细证明了只有2的幂次方数才能满足条件，并给出了快速幂的实现代码。
- **哲学家**：通过手推和反证法，证明了只有2的幂次方数才能满足条件，并给出了快速幂的实现代码。
- **Yoo_**：通过打表找规律，发现答案为$2^{k-1}$，并给出了快速幂的实现代码。

---
处理用时：26.96秒
# 题目信息

# 添加括号III

## 题目描述

现在给出一个表达式，形如 $a_{1}/a_{2}/a_{3}/.../a_{n}$。

如果直接计算，就是一个个除过去，比如 $1/2/1/4 = 1/8$。

然而小$\text{A}$看到一个分数感觉很不舒服，希望通过添加一些括号使其变成一个整数。一种可行的办法是 $(1/2)/(1/4)=2$ 。

现在给出这个表达式，求问是否可以通过添加一些括号改变运算顺序使其成为一个整数。

## 说明/提示

- 对于 $40\%$ 的数据，$n \le 16$。
- 对于 $70\%$ 的数据，$n \le 100$。
- 对于 $100\%$ 的数据， $2 \le n \le 10000$，$1 \le t \le 100$，$1 \le a_{i}\le 2^{31}-1$。

## 样例 #1

### 输入

```
2
4
1 2 1 4
5
6 5 7 9 12```

### 输出

```
Yes
No```

# AI分析结果



### 综合分析与结论
题目核心是通过括号调整使得连除表达式结果为整数。关键在于将除a2外的所有数转化为分子，并与a2约分至1。所有题解均采用约分思路，通过不断计算gcd将a2约分至1，时间复杂度O(n)，空间O(1)。

---

### 精选题解与评分

#### 1. kkksc03（★★★★★）
**关键亮点**：  
- 最早提出约分核心思路，代码简洁高效  
- 明确说明避免高精计算的优化方法  
- 逻辑清晰，适合快速理解问题本质

**核心代码**：  
```cpp
a[2] /= __gcd(a[1], a[2]);
for(int i=3; i<=n; i++) {
    a[2] /= __gcd(a[2], a[i]);
}
if(a[2]==1) cout<<"Yes";
```

#### 2. Porsche（★★★★☆）
**关键亮点**：  
- 使用STL的`__gcd()`函数简化代码  
- 代码结构紧凑，适合竞赛快速编码  
- 处理大数据时可能存在溢出风险（需用long long）

**代码亮点**：  
```cpp
a[2] /= __gcd(a[1], a[2]);  // 注意数据类型应为long long
```

#### 3. Plozia（★★★★☆）
**关键亮点**：  
- 详细数学证明a1必为分子、a2必为分母  
- 提供约分正确性的严格推导  
- 包含博客链接补充细节，适合深入学习

**核心证明**：  
"将剩余数全作为分子时，a2的因子被完全约掉的可能性最大"

---

### 关键思路总结
**核心技巧**：  
1. **分母唯一性**：a2必须作为最终分母，其余数通过括号转为分子  
2. **约分链式处理**：遍历所有数，将a2与每个数（包括a1）求gcd并约分  
3. **终止条件**：约分后a2=1时存在解

**优化要点**：  
- 避免直接计算大数乘积，通过gcd逐步约分  
- 时间复杂度O(n*log(max(a_i)))，适用于n=1e4  

---

### 拓展与举一反三
**同类题目推荐**：  
1. [P1414 又是毕业季II](https://www.luogu.com.cn/problem/P1414)（最大公约数应用）  
2. [P1072 Hankson的趣味题](https://www.luogu.com.cn/problem/P1072)（因子分解与约分）  
3. [P1069 细胞分裂](https://www.luogu.com.cn/problem/P1069)（质因数分解应用）

**心得摘录**：  
> "约分时特别注意过滤a2" —— Plozia题解  
> （调试时易犯错误：误将a2自身也参与约分）  
> "数据类型用long long避免溢出" —— 多篇题解隐含建议  

**实现技巧**：  
- 使用C++11的`gcd()`函数需包含头文件`<numeric>`  
- Python可利用math.gcd但需处理负数情况  
- 边读入边处理节省空间，适合在线算法  

---

```cpp
// 标准实现参考（防溢出版）
#include<bits/stdc++.h>
using namespace std;
using LL = long long;

int main() {
    int T; cin >> T;
    while(T--) {
        int n; LL a1, a2;
        cin >> n >> a1 >> a2;
        a2 /= gcd(a1, a2);
        for(int i=3; i<=n; ++i) {
            LL x; cin >> x;
            a2 /= gcd(a2, x);
        }
        cout << (a2 == 1 ? "Yes\n" : "No\n");
    }
}
```

---
处理用时：46.59秒
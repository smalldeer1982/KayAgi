# 题目信息

# [USACO2.3] 控制公司 Controlling Companies

## 题目描述

有些公司是其他公司的部分拥有者，因为他们获得了其他公司发行的股票的一部分。

据说，如果至少满足了以下三个条件之一，公司 $A$ 就可以控制公司 $B$ 了：

- 公司 $A$ = 公司 $B$。
- 公司 $A$ 拥有大于 $50\%$ 的公司 $B$ 的股票。
- 公司 $A$ 控制 $K$（$K \geq 1$）个公司，记为 $C_1, \ldots, C_K$，每个公司 $C_i$ 拥有 $x_i\%$ 的公司 $B$ 的股票，并且 $x_1+ \ldots + x_K \gt 50\%$。

给你一个表，每行包括三个数 $i,j,p$：表明公司 $i$ 享有公司 $j$ 的 $p\%$ 的股票。计算所有的数对 $(h,s)$，表明公司 $h$ 控制公司 $s$。至多有 $100$ 个公司。

## 说明/提示

翻译来自NOCOW

USACO 2.3


## 样例 #1

### 输入

```
3
1 2 80
2 3 80
3 1 20```

### 输出

```
1 2
1 3
2 3```

# AI分析结果



### 综合分析与结论
本题核心在于处理控股关系的传递性，需通过递归或迭代方式维护控制链。大部分题解采用DFS/BFS进行控股关系推导，时间复杂度O(N^3)可接受（N≤100）。另有部分题解尝试Floyd传递闭包、暴力迭代等思路。DFS/BFS系解法因代码简洁、逻辑清晰成为最优解。

---

### 高星题解推荐

#### 1. 以墨（★★★★★）
**关键亮点**：  
- 清晰的DFS递归结构，通过cnt数组累计控股比例  
- 使用三个标记数组分别处理已搜索、已控制、累计控股状态  
- 正确处理环路问题（f数组防止重复搜索）  
**核心代码**：
```cpp
void EMILY(int x) {
    if(f[x]) return;
    f[x] = true;
    for(int i = m; i; i--) {
        cnt[i] += a[x][i];
        if(cnt[i] > 50) {
            own[i] = true;
            EMILY(i);
        }
    }
}
```

#### 2. JCY_（★★★★☆）
**关键亮点**：  
- 无递归的非典型解法，通过动态维护控制列表  
- 巧妙利用控制链的扩展特性（con数组自增更新）  
- 代码结构紧凑，自带排序输出逻辑  
**核心代码**：
```cpp
for(int j=0; j<con[i].size(); j++) {
    int t = con[i][j];
    for(int k=1; k<=n; k++) {
        cnt[k] += a[t][k];
        if(cnt[k]>50 && !vis[k]) {
            vis[k] = true;
            con[i].push_back(k); // 关键扩展点
        }
    }
}
```

#### 3. R·Buffoon（★★★★☆）
**关键亮点**：  
- 纯暴力迭代解法，通过flag标记更新状态  
- 无需递归栈，更易理解控制链传导过程  
- 代码结构简单，适合算法初学者理解  
**核心代码**：
```cpp
while(flag) {
    flag = 0;
    for(int j=1; j<=m; j++) {
        if(!vis[j] && cnt[j]>50) {
            vis[j] = 1;
            for(int k=1; k<=m; k++) 
                cnt[k] += a[j][k];
            flag = 1;
        }
    }
}
```

---

### 关键思路与技巧总结
1. **递归累计法**：通过DFS/BFS递归触发控股链式反应，每次发现新控制公司立即递归处理其控股关系  
2. **标记去重**：使用辅助数组标记已处理节点，避免重复计算和死循环  
3. **间接控股计算**：将直接控股与间接控股统一处理，累计股份时包含所有被控制子公司的持股  

---

### 相似题目推荐
1. **P3387 缩点**（强连通分量+拓扑排序）  
   - 考察有向图的传递性处理  
2. **P1613 跑路**（倍增+Floyd传递闭包）  
   - 处理关系传递的经典模型  
3. **P2419 竞赛图**（传递闭包应用）  
   - 基于关系推导的判断类问题

---
处理用时：39.64秒
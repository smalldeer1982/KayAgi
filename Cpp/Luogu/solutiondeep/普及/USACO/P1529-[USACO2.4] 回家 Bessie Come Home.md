# 题目信息

# [USACO2.4] 回家 Bessie Come Home

## 题目描述

现在是晚餐时间，而母牛们在外面分散的牧场中。 

Farmer John 按响了电铃，所以她们开始向谷仓走去。 你的工作是要指出哪只母牛会最先到达谷仓（在给出的测试数据中，总会**有且只有**一只最快的母牛）。在挤奶的时候（晚餐前），每只母牛都在她自己的牧场上，一些牧场上可能没有母牛。

每个牧场由一条条道路和一个或多个牧场连接（可能包括自己）。有时，两个牧场（可能是字母相同的）之间会有超过一条道路相连。至少有一个牧场和谷仓之间有道路连接。因此，所有的母牛最后都能到达谷仓，并且母牛总是走最短的路径。当然，母牛能向着任意一方向前进，并且她们以相同的速度前进。牧场被标记为 $\texttt{a} \ldots \texttt{z}$ 和 $\texttt{A} \ldots \texttt{Y}$，在用大写字母表示的牧场中有一只母牛，小写字母中则没有。 谷仓的标记是 $\texttt{Z}$，注意没有母牛在谷仓中。

**注意 $\texttt{m}$ 和 $\texttt{M}$ 不是同一个牧场**。

## 说明/提示

翻译来自 NOCOW

USACO 2.4


## 样例 #1

### 输入

```
5
A d 6
B d 3
C e 9
d Z 8
e Z 3```

### 输出

```
B 11
```

# AI分析结果



### 综合分析与结论
本题本质是带字符节点的小规模最短路问题，关键点包括：字符转数字索引、处理重复边取最小值、确定有效终点（大写字母且非Z）。最优解法需权衡效率与实现难度，结合题目数据规模（最多52节点）选择合适算法。

---

### 高星题解推荐

#### 1. 封禁用户（★★★★☆）
**亮点**：Floyd算法简洁实现，字符索引映射巧妙，处理重边优雅  
**核心思路**：
- 将字符映射为0-51的索引（a-z→26-51，A-Z→0-25）
- Floyd三重循环预处理所有节点间最短路
- 遍历大写字母找最小距离

```cpp
int getnum(char c){
    if(c>='a'&&c<='z') return c-'a'+26;
    else return c-'A'; // Z映射为25
}
// 初始化后跑Floyd
for(int k=0;k<60;k++) 
    for(int i=0;i<60;i++)
        for(int j=0;j<60;j++)
            dist[i][j] = min(dist[i][j], dist[i][k]+dist[k][j]);
```

#### 2. Gamin（★★★★☆）
**亮点**：Dijkstra标准实现，邻接矩阵处理重边，终点判定清晰  
**技巧**：
- 将字符转换为1-52的索引（A-Z→27-52，a-z→1-26）
- 优先处理Z到各点的初始距离
- 最终遍历大写字母范围（27-51）

```cpp
void di(int x,int y,int w){
    if(tu[x][y]==0) tu[x][y]=w; // 首次存入
    else if(w<tu[x][y]) tu[x][y]=w; // 处理重边
}
// Dijkstra后遍历有效终点
for(int i=27;i<=51;i++) 
    if(dis[i]<ans) ans=dis[i], point=i;
```

#### 3. KenLi（★★★★☆）
**亮点**：Dijkstra完整教学式注释，双映射表管理节点  
**实现细节**：
- 独立维护字符与索引的双向映射表
- 动态添加节点避免无效空间
- 严格分离牧场类型判断

```cpp
// 动态建立索引
if(!used[(int)from]) ind[(int)from]=++len;
// 松弛时跳过无效牧场
if(mat[node][j]!=INF) 
    dis[j] = min(dis[j], dis[node]+mat[node][j]);
```

---

### 最优思路提炼
1. **字符处理**：统一将字符映射为连续整数（A-Z优先处理）
2. **重边处理**：存图时取`min(现有边权, 新边权)`
3. **算法选择**：节点数≤52时，Floyd更简洁；节点较多时用Dijkstra+堆优化
4. **终点判定**：遍历'A'-'Y'且排除'Z'，确保正确性

---

### 同类题目推荐
1. [P1339](https://www.luogu.com.cn/problem/P1339) 热浪（最短路模板）  
2. [P1354](https://www.luogu.com.cn/problem/P1354) 房间最短路（几何+最短路）  
3. [P4779](https://www.luogu.com.cn/problem/P4779) 单源最短路（Dijkstra练习）

---

### 调试经验摘录
> "89分教训：未处理重复边取最小值" —— 多题解强调重边需`min`比较  
> "字符转换时'A'-'Z'漏判Z导致错误" —— 严格分离有效终点判定  
> "Floyd初始化对角为0，其余INF" —— 正确初始化避免自环干扰

---
处理用时：63.79秒
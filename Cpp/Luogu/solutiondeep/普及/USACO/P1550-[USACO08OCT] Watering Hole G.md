# 题目信息

# [USACO08OCT] Watering Hole G

## 题目描述

Farmer John 的农场缺水了。

他决定将水引入到他的 $n$ 个农场。他准备通过挖若干井，并在各块田中修筑水道来连通各块田地以供水。在第 $i$ 号田中挖一口井需要花费 $W_i$ 元。连接 $i$ 号田与 $j$ 号田需要 $P_{i,j}$（$P_{j,i}=P_{i,j}$）元。

请求出 FJ 需要为使所有农场都与有水的农场相连或拥有水井所需要的最少钱数。

## 说明/提示

对于 $100\%$ 的数据，$1 \leq n \leq 300$，$1 \leq W_i \leq 10^5$，$0 \leq P_{i,j} \leq 10^5$。

## 样例 #1

### 输入

```
4
5
4
4
3
0 2 2 2
2 0 3 3
2 3 0 4
2 3 4 0```

### 输出

```
9```

# AI分析结果



### 综合分析与结论
本题核心在于将"打井"转化为虚拟节点连接问题，通过构造n+1个点的最小生成树模型统一处理井与水道的关系。所有题解均基于此核心思路，差异主要体现在算法选择（Kruskal/Prim）、代码实现方式及优化程度。

---

### 高星题解推荐（评分≥4星）

#### 1. 作者：Mr_QwQ（★★★★☆）
**关键亮点**：
- 创新性提出"地下水源"虚拟节点模型，直观解释问题转化
- 代码完整展示优先队列实现Kruskal的细节
- 包含重要调试经验：提醒优先队列比较函数反向定义

**个人心得**：
> "注意C++优先队列是从大到小排的...刚才被这个坑了半天！"  
总结：STL容器的特性需要特别注意，比较函数需反向定义

**核心代码思想**：
```cpp
// 添加虚拟节点n+1，并连接各点井费
n++;
for(int i=1;i<n;i++){
    que.push((edge){i,n,w[i]});
    que.push((edge){n,i,w[i]});
}
// Kruskal求最小生成树
```

#### 2. 作者：汪鸣谦（★★★★☆）
**关键亮点**：
- 详细分析错误思路的反例，强化理解
- 提供邻接矩阵转边的清晰实现
- 代码注释完整，变量命名规范

**核心实现**：
```cpp
// 构建水源点连接
for(int i=1;i<=n;i++) {
    adde(i,n+1,w[i]);
    adde(n+1,i,w[i]);
}
// 边排序后Kruskal
sort(a+1,a+te+1,cmp);
```

#### 3. 作者：1jia1（★★★★☆）
**关键亮点**：
- 提出贪心式Prim实现，直接处理点权
- 创新性将井费整合到Prim的松弛过程中
- 代码简洁高效，适合稠密图

**核心算法**：
```cpp
// 初始化时将井费设为初始dis
for(int i=1;i<=n;i++) dis[i] = w[i];
// Prim过程中动态比较边权与井费
for(int j=1;j<=n;j++)
    dis[j] = min(dis[j], min(e[x][j], w[j]));
```

---

### 最优思路总结
**关键技巧**：
1. 虚拟节点法：创建水源节点，将点权转化为边权
2. 统一建模：将井与水道统一为边权，转化为标准MST问题
3. 算法选择：n=300时，Prim的O(n²)优于Kruskal的O(mlogm)

**同类问题套路**：
- 节点带有建设成本（如P2212浇地）
- 需选择部分节点作为特殊点（如P2872建谷仓）
- 混合边权与点权的最优化问题

---

### 推荐练习题
1. [P2212 [USACO14MAR]浇地Watering the Fields](https://www.luogu.com.cn/problem/P2212)  
   - 最小生成树+边权筛选
2. [P2872 [USACO07DEC]道路建设Building Roads](https://www.luogu.com.cn/problem/P2872)  
   - 包含已有边的MST问题
3. [P4047 [JSOI2010]部落划分](https://www.luogu.com.cn/problem/P4047)  
   - 逆向思维处理连通性

---

### 经验摘录
1. **调试经验**：  
   "C++优先队列默认大顶堆，比较函数需反向定义"（Mr_QwQ）  
   → STL容器特性需特别注意

2. **思维误区**：  
   "最初认为只需找一个最小井，实际可能多个井更优"（汪鸣谦）  
   → 局部最优不等于全局最优

3. **实现技巧**：  
   "Prim中直接将井费整合到dis数组，动态更新"（1jia1）  
   → 灵活运用算法框架处理特殊条件

---
处理用时：56.33秒
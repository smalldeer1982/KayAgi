# 题目信息

# [USACO05FEB] Part Acquisition S

## 题目描述

奶牛们接到了寻找一种新型挤奶机的任务，为此它们准备依次经过 $N(1\le N\le 5\times 10^4)$ 颗行星，在行星上进行交易。为了方便，奶牛们已经给可能出现的 $K(1\le K\le 10^3)$ 种货物进行了由 $1$ 到 $K$ 的标号。由于这些行星都不是十分发达。没有流通的货币，所以在每个市场里都只能用固定的一种货物去换取另一种货物。奶牛们带着一种上好的饲料从地球出发，希望在使用的物品的种类数量最少的情况下，最终得到所需要的机器。饲料的标号为 $1$，所需要的机器的标号为 $K$。如果任务无法完成，输出 $-1$。

## 说明/提示

奶牛们至少需要 $4$ 种不同标号的物品，先用 $1$ 去交换 $3$，再用 $3$ 去交换 $2$，最后用 $2$ 交换得到 $5$。

$1\le N\le 5\times 10^4$，$1\le K\le 10^3$。

## 样例 #1

### 输入

```
6 5
1 3
3 2
2 3
3 1
2 5
5 4```

### 输出

```
4```

# AI分析结果



### 综合分析与结论
本题核心是求无权有向图中从1到K的最短路径（边数），可转化为边权为1的最短路问题。最优解法为BFS，时间复杂度O(N+K)，优于Dijkstra/SPFA。题解中BFS实现普遍更简洁高效，而部分题解未正确处理节点数或初始化导致潜在问题。

---

### 精选题解与评分

#### 1. 作者：RisefromtheAshes（★★★★★）
**关键亮点**：
- 直接使用BFS处理无权图，时间复杂度最优
- 代码简洁清晰（仅20行核心逻辑）
- 正确判断不可达条件（0x3f3f3f3f）
- 包含关键注释说明入队出队逻辑

**核心代码**：
```cpp
void bfs(){
    queue<int>z;
    z.push(1);
    memset(dis,0x3f,sizeof(dis));
    dis[1]=1; // 初始节点计数包含起点
    while(z.size()){
        int now=z.front(); z.pop();
        for(int i=0;i<G[now].size();i++){
            int v=G[now][i];
            if(dis[v]>dis[now]+1){
                dis[v]=dis[now]+1;
                z.push(v);
    }}}
}
```

#### 2. 作者：what_can_I_do（★★★★★）
**关键亮点**：
- 显式说明答案需+1（植树问题）
- 使用vector邻接表存储图结构
- 正确处理边界条件（dis初始化为极大值）

**核心思路**：
```cpp
bfs();
if(dis[k]!=0x3f3f3f3f) cout<<dis[k];
else cout<<-1; 
// dis[k]存储的是边数，最终答案为边数+1（节点数）
```

#### 3. 作者：jiangxinyang2012（★★★★）
**关键亮点**：
- 使用SPFA算法实现
- 链式前向星存图节省空间
- 通过memset初始化巧妙处理不可达状态

**代码片段**：
```cpp
add(x,y); // 链式前向星建边
...
if(dis[k]!=16843009) // 特殊判断初始值
    printf("%d\n",dis[k]);
```

---

### 最优关键技巧
1. **BFS处理无权图**：当边权均为1时，BFS队列首次访问即得最短路，无需优先队列。
2. **节点数=边数+1**：最终输出时需将边数（dis值）加1，体现"经手物品数"的题意。
3. **链式前向星优化**：适用于边数较多（5e4）的场景，比vector更省内存。

---

### 拓展与相似题目
1. [P1144 最短路计数](https://www.luogu.com.cn/problem/P1144)（BFS求最短路数量）
2. [P1396 营救](https://www.luogu.com.cn/problem/P1396)（边权特殊处理的最短路）
3. [P2661 信息传递](https://www.luogu.com.cn/problem/P2661)（寻找有向图最小环，BFS/DFS应用）

---

### 调试心得摘录
> "一定要出队！不然会死循环" —— RisefromtheAshes  
> **总结**：BFS中忘记出队操作会导致死循环，需注意队列操作完整性。

> "dis[k] = 16843009是memset的特殊值" —— jiangxinyang2012  
> **总结**：使用memset初始化时需了解其二进制填充模式，避免误判。

---
处理用时：58.36秒
# 题目信息

# [USACO19FEB] The Great Revegetation B

## 题目描述

长时间的干旱使得 Farmer John 的 $N$ 块草地上牧草匮乏。随着雨季即将到来，现在应当是重新种植的时候了。

在 Farmer John 的储物棚里有四个桶，每个桶里装着一种不同的草种。他想要在每块草地上播种其中一种草。作为一名奶农，Farmer John 想要确保他的每头奶牛都能得到丰富的食谱。他的 $M$ 头奶牛每一头都有两块喜爱的草地，他想要确保这两块草地种植不同种类的草，从而每头奶牛都可以有两种草可供选择。Farmer John 知道没有一块草地受到多于 $3$ 头奶牛的喜爱。

请帮助 Farmer John 选择每块草地所种的草的种类，使得所有奶牛的营养需求都得到满足。 

## 样例 #1

### 输入

```
5 6
4 1
4 2
4 3
2 5
1 2
1 5```

### 输出

```
12133```

# AI分析结果



### 综合分析与结论
题目要求构造满足奶牛约束的字典序最小草种序列。关键点在于：贪心逐位选择最小可行颜色，利用每个草地最多与3个约束关联的性质保证解存在。所有题解均采用贪心思路，区别在于约束判断方式（邻接表预处理、实时暴力检查等）。核心技巧是**贪心选择+颜色冲突预判**。

---

### 精选题解及评分

#### 1. 作者：lflby（★★★★☆）
**关键亮点**  
- 使用邻接表预处理约束关系，代码简洁高效  
- 直接利用颜色数组进行冲突判断，逻辑清晰  
- 时间复杂度 O(nm) 但实际运行效率较高  

**核心实现**  
```cpp
vector<int>a[105]; // 邻接表存储关联节点
int d[105];        // 记录各节点颜色
for(int i=1; i<=n; i++) {
    for(int j=1; j<=4; j++) { // 枚举颜色
        bool flag = true;
        for(int k=0; k<a[i].size(); k++) { // 检查所有相邻节点
            if(j == d[a[i][k]]) {
                flag = false;
                break;
            }
        }
        if(flag) { d[i]=j; break; } // 找到可行颜色
    }
}
```

#### 2. 作者：MarsNotFound（★★★★☆）
**关键亮点**  
- 通过预处理保证a[i] ≤ b[i]简化判断逻辑  
- 使用双循环暴力检查所有相关约束  
- 代码结构紧凑，适合快速实现  

**核心实现**  
```cpp
for(int i=1; i<=n; i++) {
    for(int j=1; j<=4; j++) { 
        int flag=0;
        for(int k=1; k<=m; k++) {
            if(b[k]==i && s[a[k]]==j) { // 检查所有关联约束
                flag=1; break;
            }
        }
        if(!flag) { s[i]=j; break; }
    }
}
```

#### 3. 作者：carbon_monoxide（★★★★☆）
**关键亮点**  
- 使用对称存储约束（预处理交换a,b）  
- 直接暴力枚举所有关联约束  
- 代码极简，适合竞赛快速编码  

**核心实现**  
```cpp
for(int i=0; i<m; i++) {
    if(a[i]>b[i]) swap(a[i],b[i]); // 预处理保证有序
}
for(int i=1; i<=n; i++) {
    for(k=1; k<=4; k++) {
        bool f=0;
        for(int j=0; j<m; j++) { // 暴力检查所有约束
            if(b[j]==i && c[a[j]]==k) { f=1; break; }
        }
        if(!f) break;
    }
    c[i]=k;
}
```

---

### 关键思路与技巧总结
1. **贪心策略**：从前往后处理，每个位置选择当前最小的可行颜色  
2. **约束预处理**：通过邻接表或排序约束对，简化冲突判断  
3. **颜色冲突检测**：只需检查已处理的相邻节点颜色  
4. **复杂度优化**：每个节点最多检查4种颜色，每个颜色最多检查3个相邻节点  

**同类型题扩展**  
- 图着色问题：如[CF1221E](https://codeforces.com/problemset/problem/1221/E)  
- 字典序构造问题：如[P1967 乘积最大](https://www.luogu.com.cn/problem/P1967)  
- 约束满足问题：如[P1996 约瑟夫问题](https://www.luogu.com.cn/problem/P1996)  

---

### 推荐练习题
1. [P1155 双栈排序](https://www.luogu.com.cn/problem/P1155)（图着色+贪心）  
2. [P2661 信息传递](https://www.luogu.com.cn/problem/P2661)（约束关系处理）  
3. [P1094 纪念品分组](https://www.luogu.com.cn/problem/P1094)（贪心策略应用）  

---

### 题解中的个人心得摘录
1. **数据范围分析**："看到范围第一时间想到爆搜，但这题可以用贪心" → 数据量小往往提示暴力可行  
2. **字典序技巧**："从左往右枚举，第一次成立的解即字典序最小" → 贪心构造字典序的通用方法  
3. **调试经验**："回溯法不稳定，直接标记冲突更可靠" → 避免复杂回溯逻辑，采用线性处理

---
处理用时：55.77秒
# 题目信息

# [USACO19OPEN] Cow Evolution B

## 题目描述

现在是 3019 年，在过去的一千年里发生了不计其数的牛类进化，产生了具有各种有趣特性的奶牛。

牛类进化的记录可以用一棵树来表示，起源是位于树根位置的没有特殊特性的奶牛。树上每一个产生后代的结点，有可能所有的奶牛都进化出了一种新的特性（比如说喷火（fire breathing），如下图所示，其中所有斑点（spots）奶牛最后都能喷火），或者是奶牛种群产生了分支进化，其中有些进化出了新的特性（比如，飞（flying）），有的没有。 

![](https://cdn.luogu.com.cn/upload/image_hosting/q7v0zhg4.png)

树底部的叶结点表示 3019 年所有产生的奶牛的子种群。没有不同的叶结点（子种群）具有完全相同的一组特性。例如，子种群 #1 是没有特殊特性的奶牛，子种群 #3 是能够心灵感应的（telepathic）会飞的奶牛。相比之下，子种群 #2 是会飞但不能心灵感应的奶牛。子种群 #3 是唯一既会飞又会心灵感应的。

像上图这样每一种进化出的新特性都恰好在树中的一条边上产生（也就是说，在整个进化历史中仅在一个时间点产生），这样的进化树被称为是“合法的”。例如，如果斑点这一特性在两个不同分支中均进化产生，这棵进化树就不是合法的。给定 3019 年奶牛子种群的描述，请判断是否这可以由一棵合法的进化树所解释。 

## 说明/提示

### 样例解释 1


这个输入样例与上图所示的合法进化树一致。 

## 样例 #1

### 输入

```
4
2 spots firebreathing
0
1 flying
2 telepathic flying```

### 输出

```
yes```

# AI分析结果



### 综合分析与结论
题目要求判断给定的子种群特征集合是否能构成合法进化树（每个特性仅在一个边出现）。关键点在于特征之间不能存在交叉分支，即任何两个特征不能同时满足三个条件：存在同时包含它们的子种群、仅含特征A的子种群、仅含特征B的子种群。

### 高分题解推荐
#### 题解一（作者：cly312） ★★★★☆
**关键亮点**：  
- 思路清晰，直接检查每对特征是否存在交叉分支的条件。  
- 代码简洁，通过遍历特征对并统计三类子种群数量判断合法性。  

**核心思路**：  
对每对特征检查是否存在同时包含两者的子种群（AB>0），以及单独包含每个特征的子种群（A>0且B>0）。若三者均存在，则无法构造合法树。  

**代码片段**：  
```cpp
bool crossing(int a, int b) {
    int A=0, B=0, AB=0;
    for (int i=0; i<N; i++) {
        bool has_a = false, has_b = false;
        for (string s : c[i]) {
            if (s == allc[a]) has_a = true;
            if (s == allc[b]) has_b = true;
        }
        if (has_a && has_b) AB++;
        else if (has_a) A++;
        else if (has_b) B++;
    }
    return AB>0 && A>0 && B>0; // 三条件同时成立则冲突
}
```

### 最优思路总结
**关键技巧**：  
- **集合交集分析**：通过遍历特征对的交集关系，判断是否存在无法形成树状结构的冲突分支。  
- **条件检查**：利用三重统计（同时存在、仅A、仅B）快速验证合法性。  

### 拓展与相关题目
**相似题目推荐**：  
1. [P2585 [ZJOI2006]三色二叉树](https://www.luogu.com.cn/problem/P2585)  
   - 考察树形结构合法性判断，需构造满足条件的二叉树。  
2. [P1305 新二叉树](https://www.luogu.com.cn/problem/P1305)  
   - 要求根据输入构造二叉树，验证遍历序列的合法性。  
3. [P1978 集合](https://www.luogu.com.cn/problem/P1978)  
   - 涉及集合操作与条件判断，需处理集合间关系。  

**个人心得摘录**：  
- **调试经验**：通过构造反例（如特征交叉导致无法建树）验证算法正确性。  
- **关键顿悟**：特征对的冲突本质是分支交叉，转化为集合交集的统计问题。

---
处理用时：161.41秒
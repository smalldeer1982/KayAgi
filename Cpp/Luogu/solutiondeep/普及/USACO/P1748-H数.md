# 题目信息

# H数

## 题目描述

所谓 H 数，是指只含有 $2,3,5,7$ 这些质因数的数，如 $630$ 是 H 数，而 $22$ 不是。

现在要求输出第 $n$ 个 H 数，为了方便起见将 $H[1]$ 定为 $1$。已知 $n$ 不超过 $10000$，最后数据在 int64 范围之内。


## 说明/提示

穷举会爆掉，要用生成法，最好加优化，不然空间复杂度比较大


## 样例 #1

### 输入

```
30```

### 输出

```
49```

## 样例 #2

### 输入

```
1```

### 输出

```
1```

# AI分析结果



### 综合分析与结论
H数的生成核心在于避免重复计算并维持有序性。最优解法采用**四指针法**（线性生成），时间复杂度O(n)，空间O(n)。其他方法如优先队列+去重、动态规划等在不同场景下适用，但效率稍低。

---

### 精选题解（评分≥4星）

#### 1. 作者：355_113 & hensier（五星）
**关键亮点**  
- **四指针法**：维护四个指针分别跟踪2、3、5、7的生成位置，每次取最小值后移动对应指针，确保线性时间复杂度。  
- **空间优化**：仅需一维数组存储结果，预处理后直接查询。  
- **代码简洁性**：逻辑清晰，无冗余计算。

```cpp
// 核心代码
long long w[10010] = {1};
int a=1, b=1, c=1, d=1;
for (int i=2; i<=n; ++i) {
    w[i] = min({w[a]*2, w[b]*3, w[c]*5, w[d]*7});
    if (w[i] == w[a]*2) a++;
    if (w[i] == w[b]*3) b++;
    if (w[i] == w[c]*5) c++;
    if (w[i] == w[d]*7) d++;
}
```

---

#### 2. 作者：Rainbow_qwq（五星）
**关键亮点**  
- **最大质因子优化**：记录每个数的最大质因子，后续仅乘≥该因子的质数，避免重复插入优先队列。  
- **去重技巧**：通过限制生成路径，确保每个数唯一进入堆中。

```cpp
// 核心代码
struct node {
    long long num;
    int maxp; // 最大质因子索引
    bool operator<(const node &q) const { return num > q.num; }
};
priority_queue<node> q;
q.push({1, 1});
while (n--) {
    auto [num, p] = q.top(); q.pop();
    for (int i = p; i <= 4; ++i)
        q.push({num * primes[i], i});
}
```

---

#### 3. 作者：Ruo何言（五星）
**关键亮点**  
- **队列模拟四指针**：手动维护四个队列指针，每次取最小候选值，代码直观。  
- **去重逻辑**：通过严格的条件判断确保唯一性。

```cpp
// 核心代码
int t1=1, t2=1, t3=1, t4=1;
for (int i=2; i<=n; ++i) {
    long long m = min({q[t1]*2, q[t2]*3, q[t3]*5, q[t4]*7});
    q[i] = m;
    if (m == q[t1]*2) t1++;
    if (m == q[t2]*3) t2++;
    // 类似更新t3、t4
}
```

---

### 关键思路与技巧
1. **四指针法**：通过独立指针追踪各质因数的生成位置，保证每次取最小且不重复。
2. **优先队列优化**：结合最大质因子限制生成路径，避免重复插入，适用于更通用的质因数组合问题。
3. **预处理与查询分离**：提前计算所有结果，适合多组查询场景。

---

### 同类型拓展题目
1. **UVA136 丑数 Ugly Numbers**（质因数2、3、5）  
2. **洛谷P2723 丑数 Humble Numbers**（动态质因数集合）  
3. **洛谷P1878 跳蚤**（生成特定因数的数）

---

### 个人心得摘录
- **调试教训**（Leap_Frog）：暴力去重导致超时，改用生成法后效率显著提升。  
- **数据结构选择**（x_angelkawaii_x）：优先队列+去重虽简洁，但需权衡时间复杂度。  
- **思维误区**（kradcigam）：动态规划的朴素实现可能效率不足，需优化生成顺序。

---
处理用时：99.92秒
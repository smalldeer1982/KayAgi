# 题目信息

# [USACO03FALL] Cow Exhibition G

## 题目背景




## 题目描述

奶牛想证明它们是聪明而风趣的。为此，贝西筹备了一个奶牛博览会，她已经对 $N$ 头奶牛进行了面试，确定了每头奶牛的智商和情商。

贝西有权选择让哪些奶牛参加展览。由于负的智商或情商会造成负面效果，所以贝西不希望出展奶牛的智商之和小于零，或情商之和小于零。满足这两个条件下，她希望出展奶牛的智商与情商之和越大越好，请帮助贝西求出这个最大值。


## 说明/提示

选择第一头，第三头，第四头奶牛，智商和为−5+6+2 = 3，情商和为7−3+1 = 5。再加

入第二号奶牛可使总和提升到10，不过由于情商和变成负的了，所以是不允许的


## 样例 #1

### 输入

```
5
-5 7
8 -6
6 -3
2 1
-8 -5```

### 输出

```
8```

# AI分析结果



### 综合分析与结论
本题核心是将双约束最优化问题转化为01背包变形。关键难点在于处理负数值与状态表示，通过数组偏移解决负数下标问题，并分情况处理状态转移方向。动态规划解法在时间与空间上最优，而剪枝搜索在特定情况下可行但效率较低。

---

### 精选题解与评分

#### 1. 学而思李老师（5星）
**关键亮点**：  
- 清晰定义状态（智商为体积，情商为价值），结合数组偏移解决负数下标。
- 分正负处理转移方向（正智商逆序循环，负智商正序循环）。
- 完整初始化与边界条件处理，代码简洁高效。

**核心代码**：
```cpp
memset(dp, -0x3f, sizeof dp);
dp[400000] = 0;
for (int i = 1; i <= n; i++) {
    if (a[i].iq >= 0)
        for (int j = 800000; j >= a[i].iq; j--)
            dp[j] = max(dp[j], dp[j - a[i].iq] + a[i].eq);
    else
        for (int j = 0; j <= 800000 + a[i].iq; j++)
            dp[j] = max(dp[j], dp[j - a[i].iq] + a[i].eq);
}
// 遍历有效范围取最大值
```

#### 2. YJunJ（4星）
**关键亮点**：  
- 详细推导状态转移方程，明确数组偏移意义。
- 处理越界判断与滚动数组优化，代码可读性较强。

**核心代码**：
```cpp
memset(f, ~0x3f3f3f3f, sizeof(f));
f[400000] = 0;
for (int i = 1; i <= n; i++) {
    if (cow[i].s >= 0)
        for (int j = 800000; j >= cow[i].s; j--)
            f[j] = max(f[j], f[j - cow[i].s] + cow[i].f);
    else
        for (int j = 0; j <= 800000 + cow[i].s; j++)
            f[j] = max(f[j], f[j - cow[i].s] + cow[i].f);
}
```

---

### 关键技巧总结
1. **数组偏移**：将负数下标平移到正数范围（如+400000），避免越界。
2. **分方向转移**：正数智商逆序循环，负数正序循环，确保无后效性。
3. **双约束处理**：状态表示中隐含一个约束（如智商和），最终遍历时显式检查另一个约束（情商和≥0）。
4. **滚动数组优化**：压缩空间至一维，通过覆盖旧状态减少内存消耗。

---

### 拓展与同类题目
1. **同类型题**  
   - 二维费用背包（如物品同时占用重量和体积）。
   - 带负数权值的最优化问题（如P4141 消失之物中的计数偏移）。

2. **推荐题目**  
   - [P1064 金明的预算方案](https://www.luogu.com.cn/problem/P1064)（依赖背包+多约束）
   - [P1156 垃圾陷阱](https://www.luogu.com.cn/problem/P1156)（时间与高度的双状态DP）
   - [P2340 [USACO03FALL]Cow Exhibition G](https://www.luogu.com.cn/problem/P2340)（本题原题，用于对比优化）

---

### 调试与心得摘录
- **偏移量选择**：需覆盖所有可能情况（如400头牛×±1000，偏移400000）。
- **初始化陷阱**：未正确设置初始状态会导致无法更新有效值（如`dp[400000]=0`）。
- **循环方向错误**：正负处理不当会导致状态重复计算（如负数智商未正序循环）。

---
处理用时：58.67秒
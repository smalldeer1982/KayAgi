# 题目信息

# [USACO3.2] 饲料调配 Feed Ratios

## 题目背景

农夫约翰从来只用调配得最好的饲料来喂他的奶牛。饲料用三种原料调配成：大麦，燕麦和小麦。他知道自己的饲料精确的配比，在市场上是买不到这样的饲料的。他只好购买其他三种混合饲料（同样都由三种麦子组成），然后将它们混合，来调配他的完美饲料。


## 题目描述

给出三组整数，表示 大麦：燕麦：小麦 的比例，找出用这三种饲料调配 x：y：z 的饲料的方法。

例如，给出目标饲料 3：4：5 和三种饲料的比例：

1:2:3
3:7:1
2:1:2
你必须编程找出使这三种饲料用量最少的方案，要是不能用这三种饲料调配目标饲料，输出“NONE”。“用量最少”意味着三种饲料的用量（整数）的和必须最小。


对于上面的例子，你可以用8份饲料1，1份饲料2，和5份饲料3，来得到7份目标饲料：

8\*(1:2:3) + 1\*(3:7:1) + 5\*(2:1:2) = (21:28:35) = 7\*(3:4:5)

表示饲料比例的整数以及目标饲料的都是小于100的非负整数。表示各种饲料的份数的整数，都小于100。一种混合物的比例不会由其他混合物的比例直接相加得到。


## 说明/提示

题目翻译来自NOCOW。

USACO Training Section 3.2


## 样例 #1

### 输入

```
3 4 5
1 2 3
3 7 1
2 1 2 ```

### 输出

```
8 1 5 7```

# AI分析结果



### 综合分析与结论
该问题本质是求解线性组合成比例问题，核心在于找到三种饲料的整数配比使其混合后与目标比例成整数倍。题解主要分为数学方法（柯西不等式、行列式）、枚举策略（暴力、迭代深搜）与方程组求解（高斯消元）三类。其中数学方法通过巧妙的比例判断避免复杂特例，枚举策略通过合理剪枝优化搜索效率，而方程组求解需注意精度处理。

---

### 高星题解推荐

#### 1. 作者：Flokirie（5星）
**关键亮点**：  
- 创新性应用柯西不等式等号成立条件判断比例关系，数学方法巧妙。  
- 避免对零的特殊处理，代码简洁且无精度问题。  
**核心代码思想**：  
```cpp
// 检查混合后比例(a,b,c)与目标(x,y,z)是否成比例
if ((squ(a)+squ(b)+squ(c)) * (squ(x)+squ(y)+squ(z)) == squ(a*x + b*y + c*z)) {
    // 找到解
}
```
此条件等价于两向量成比例，避免除法与零的特判。

#### 2. 作者：Youngsc（4星）  
**关键亮点**：  
- 枚举总用量确保找到最小和，利用交叉相乘避免浮点运算。  
- 代码简洁易懂，通过双等式判断比例一致性。  
**核心实现**：  
```cpp
for (tot=1; tot<=300; ++tot) // 枚举总用量
    for (i=0; i<=tot; ++i)
        for (j=0; j<=tot-i; ++j) {
            k = tot-i-j;
            // 计算各成分总和并判断比例
            if (no[1]*to[2] == to[1]*no[2] && no[3]*to[2] == to[3]*no[2]) 
                printf(...);
        }
```

#### 3. 作者：QianhanOfficial（4星）  
**关键亮点**：  
- DFS结合剪枝策略，按顺序枚举饲料种类避免重复计算。  
- 通过目标倍数递增提前终止搜索，平衡效率与正确性。  
**核心剪枝**：  
```cpp
void dfs(..., int last) { // last参数确保后续只从当前饲料开始
    for (int i = last; i <= 3; ++i) {
        // 剪枝：仅允许按序增加饲料种类
        if (i == 1) dfs(...);
        else if (i == 2) dfs(...);
    }
}
```

---

### 最优思路总结
- **数学技巧**：利用柯西不等式或交叉相乘避免除法与零特判，将比例判断转化为整数运算。  
- **枚举优化**：按总用量从小到大枚举，确保首次找到的解即为最优；DFS中固定枚举顺序减少重复路径。  
- **方程组处理**：行列式或高斯消元法需注意整数解验证，适合数学基础较好的场景。  

---

### 拓展与举一反三
1. **类似题目推荐**  
   - P1029 [NOIP2001 普及组] 最大公约数和最小公倍数问题（枚举与数学分析）  
   - P1214 [USACO1.4] 等差数列 Arithmetic Progressions（枚举与剪枝）  
   - P2119 [NOIP2016 普及组] 魔法阵（线性组合与数学推导）  

2. **调试心得**  
   - **浮点精度**：高斯消元法中需引入`eps`处理舍入误差，如判断`(int)(x+eps)`避免.99999问题。  
   - **边界特例**：目标比例为全零时直接输出0，需单独处理（如Celebrate题解中的特判）。  

---

### 核心代码参考（Youngsc版）
```cpp
for (int tot=1; tot<=300; ++tot) {
    for (int i=0; i<=tot; ++i) {
        for (int j=0; j<=tot-i; ++j) {
            int k = tot - i - j;
            // 计算各成分总和
            int no1 = i*a1 + j*b1 + k*c1;
            int no2 = i*a2 + j*b2 + k*c2;
            int no3 = i*a3 + j*b3 + k*c3;
            // 交叉相乘判断比例
            if (no1*to2 == to1*no2 && no3*to2 == to3*no2) {
                printf("%d %d %d %d", i, j, k, no1/to1);
                return 0;
            }
        }
    }
}
```

---
处理用时：105.91秒
# 题目信息

# [USACO3.4] 网 Electric Fences

## 题目描述

在本题中，格点是指横纵坐标皆为整数的点。

为了圈养他的牛，农夫约翰（Farmer John)建造了一个三角形的电网。他从原点（0,0）牵出一根通电的电线，连接格点(n,m)（0<=n<32000,0<m<32000），再连接格点(p,0)（p>0），最后回到原点。

牛可以在不碰到电网的情况下被放到电网内部的每一个格点上（十分瘦的牛）。如果一个格点碰到了电网，牛绝对不可以被放到该格点之上（或许Farmer John会有一些收获）。那么有多少头牛可以被放到农夫约翰的电网中去呢？


## 说明/提示

题目翻译来自NOCOW。

USACO Training Section 3.4


## 样例 #1

### 输入

```
7 5 10```

### 输出

```
20```

# AI分析结果



### 综合分析与结论

本题核心在于应用皮克定理（Pick's Theorem）计算三角形内部格点数。各题解普遍采用以下思路：
1. **公式转换**：通过皮克定理逆推内部点公式：$a = S - \frac{b}{2} + 1$。
2. **边界点数计算**：利用欧几里得算法（GCD）计算各边上的格点数，注意顶点去重。
3. **面积计算**：利用三角形面积公式 $S = \frac{pm}{2}$。

非皮克定理方法（如补全矩形、逐行扫描）因实现复杂或精度问题较少被采用。关键优化点包括避免浮点运算、正确容斥顶点重复计算。

---

### 精选题解与评分

#### 1. 作者：Laser_Crystal（5星）
**关键亮点**：
- 详细推导各边格点数的计算逻辑，配图辅助理解。
- 代码简洁，直接调用STL的`__gcd`函数处理边界。
- 明确指出顶点重复计算的容斥处理（$-3$）。

**核心代码**：
```cpp
long long b = __gcd(n, m) + __gcd(abs(p - n), m) + p;
long long S = (m * p) / 2;
long long a = S - b / 2 + 1;
```

#### 2. 作者：FrenzyHydra（5星）
**关键亮点**：
- 强调避免浮点运算的精度问题（用整数运算替代）。
- 代码极简，仅需输入、计算、输出三部分。
- 提示扩展欧几里得算法在边界计算中的应用。

**核心代码**：
```cpp
int b = gcd(n, m) + gcd(abs(n - p), m) + p;
int a = (m * p / 2) - b / 2 + 1;
```

#### 3. 作者：zplqwq（4星）
**关键亮点**：
- 代码最短（仅6行），适合快速实现。
- 使用C++17的`__gcd`函数，但需注意编译器兼容性。

**核心代码**：
```cpp
int ans = __gcd(n, m) + __gcd(abs(p - n), m) + p;
int ret = (p * m / 2) - ans / 2 + 1;
```

---

### 关键思路总结
1. **皮克定理**：核心公式 $a = S - \frac{b}{2} + 1$，需熟练掌握逆推。
2. **边界点数**：边$(x_1,y_1)-(x_2,y_2)$的格点数为 $\gcd(|x_1-x_2|, |y_1-y_2|) + 1$。
3. **精度优化**：全程使用整数运算避免浮点误差，如面积计算用`(m*p)/2`而非浮点除法。

---

### 拓展练习
1. **P2785 物理计算**：二维几何中的面积与格点计算。
2. **P1183 多边形的面积**：应用皮克定理求多边形内部点。
3. **P1446 网格**：计算几何中格点路径问题，强化GCD应用。

---
处理用时：46.18秒
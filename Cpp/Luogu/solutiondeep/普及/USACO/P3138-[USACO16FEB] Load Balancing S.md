# 题目信息

# [USACO16FEB] Load Balancing S

## 题目背景

*本题与 [白金组同名题目](/problem/P6172) 在题意上一致，唯一的差别是数据范围。*

## 题目描述

Farmer John 的 $N$ 头奶牛（$1 \leq N \leq 1000$）散布在整个农场上。整个农场是一个无限大的二维平面，第 $i$ 头奶牛的坐标是 $(x_i,y_i)$（保证 $x_i,y_i$ 均为正奇数，且 $x_i,y_i \leq 10^6$），且没有任意两头奶牛在同一位置上。

FJ 希望修建一条竖直方向的栅栏，它的方程是 $x=a$，他还希望修建一条水平方向的栅栏，它的方程是 $y=b$。为了防止栅栏经过奶牛，$a,b$ 均要求是偶数。容易发现，这两个栅栏会在 $(a,b)$ 处相交，将整个农场分割为四个区域。

FJ 希望这四个区域内的奶牛数量较为均衡，尽量避免一个区域奶牛多而另一个区域奶牛少的情况。令 $M$ 为四个区域里奶牛最多区域的奶牛数量，请帮 FJ 求出 $M$ 的最小值。

## 样例 #1

### 输入

```
7
7 3
5 5
7 13
3 1
11 7
5 3
9 1```

### 输出

```
2```

# AI分析结果



### 综合分析与结论
本题核心是通过离散化将大范围坐标压缩至与点数相当的范围，结合二维前缀和快速计算区域奶牛数。最优解法为 **离散化+二维前缀和枚举**，时间复杂度为 $O(n^2)$，空间复杂度 $O(n^2)$，能够高效处理题目数据范围。

---

### 精选题解列表

#### 1. 曹老师题解（⭐⭐⭐⭐⭐）
**关键亮点**：
- 清晰的离散化处理步骤，代码结构简洁。
- 使用二维前缀和公式直接计算四个区域，逻辑直观。
- 代码中完整呈现预处理与枚举过程，可读性强。

**核心代码思路**：
```cpp
// 离散化处理坐标
sort(zx+1, zx+n+1, cmp);
sort(zy+1, zy+n+1, cmp);
// 二维前缀和预处理
for(int i=1; i<=n; i++)
    for(int j=1; j<=n; j++)
        sum[i][j] += sum[i-1][j] + sum[i][j-1] - sum[i-1][j-1];
// 枚举所有分割线位置，计算最大值最小值
ans = min(ans, max(max(sum[i][j], ...)));
```

#### 2. xixike题解（⭐⭐⭐⭐）
**关键亮点**：
- 注释详细，离散化与二维前缀和实现完整。
- 提供区域计算的数学推导（见 `calc` 函数），便于理解。

**个人心得引用**：
> “计算四个象限时，若难以理解公式，可手动画图辅助推导。”

---

### 关键思路总结
1. **离散化压缩坐标**：将原始坐标按大小排序后映射到 $[1, n]$ 的连续整数区间。
2. **二维前缀和预处理**：通过递推公式 $sum[i][j] = sum[i-1][j] + sum[i][j-1] - sum[i-1][j-1] + a[i][j]$ 快速计算子矩阵和。
3. **枚举分割线位置**：在离散化后的坐标上枚举所有可能的 $(i,j)$，利用前缀和公式分四个区域计算最大值。

---

### 拓展与举一反三
- **类似题目推荐**：
  1. [P1719 最大加权矩形](https://www.luogu.com.cn/problem/P1719)（二维前缀和极值）
  2. [P3406 海底高铁](https://www.luogu.com.cn/problem/P3406)（离散化+差分）
  3. [P3669 [USACO17OPEN]Paired Up S](https://www.luogu.com.cn/problem/P3669)（分治与区域划分）
- **优化延伸**：若 $n$ 增大至 $10^5$ 级别，可结合扫描线+线段树（如 kczno1 题解中的二分思路）。

---
处理用时：38.31秒
# 题目信息

# [USACO16OPEN] Field Reduction S

## 题目描述

Farmer John 的 $N$ 头奶牛（$5 \leq N \leq 50,000$）都位于他二维牧场中的不同位置。FJ 希望用一个边平行于 $x$ 轴和 $y$ 轴的矩形围栏围住所有的奶牛，并且他希望这个围栏尽可能小，以便能够包含每头奶牛（允许奶牛位于边界上）。

不幸的是，由于上个季度牛奶产量低，FJ 的预算非常紧张。因此，他希望如果可能的话，建造一个更小的围栏，并且他愿意从他的牛群中出售最多三头奶牛来实现这一目标。

请帮助 FJ 计算在从他的牛群中移除最多三头奶牛后，他可以用围栏围住的最小可能面积（然后为剩余的奶牛建造最紧密的围栏）。

对于这个问题，请将奶牛视为点，将围栏视为四条线段的集合（即不要将奶牛视为“单位正方形”）。请注意，答案可能为零，例如如果所有剩余的奶牛最终站在一条共同的垂直线或水平线上。

## 样例 #1

### 输入

```
6
1 1
7 8
10 9
8 12
4 100
50 7```

### 输出

```
12```

# AI分析结果



### 综合分析与结论
本题核心在于通过删除最多3头牛来最小化包围矩形的面积。关键思路是：**只有删除边界上的极值点才可能减小面积**。各题解普遍采用收集x/y方向极值点后暴力枚举的策略，其中较优解法通过预处理极值点将时间复杂度降至O(1)级别枚举。

---

### 精选题解与评分

#### 1. 作者：ikunTLE（★★★★★）
**关键亮点**：  
- 将问题简化为收集x/y方向各前3后3的极值点（共12个），去重后枚举所有三元组  
- 时间复杂度极低（C(12,3) = 220次枚举），代码简洁  
- 引入unique去重技巧，避免重复计算  

**核心代码**：
```cpp
sort(a+1,a+n+1,cmp1); // 按x排序
// 收集x方向的前3和后3点
sort(a+1,a+n+1,cmp2); // 按y排序
// 收集y方向的前3和后3点
m = unique(g+1,g+cnt+1)-g; // 去重
for (三重枚举g数组中的三个点) 
   计算剩余点极值并更新ans
```

#### 2. 作者：mysterys（★★★★☆）
**关键亮点**：  
- 将候选点扩展至每个方向的前4后4点，提高鲁棒性  
- 使用位运算枚举所有可能的保留组合  
- 预处理极值点后通过位掩码快速筛选  

**核心代码**：
```cpp
// 收集x/y各方向前4后4点存入real数组
for (int i=0;i<(1<<cnt);++i) { // 位枚举所有组合
    if (__builtin_popcount(i) == cnt-3) { // 恰好删除3个点
        计算保留点的极值并更新ans
    }
}
```

#### 3. 作者：Unordered_OIer（★★★★☆）
**关键亮点**：  
- 分治思路：先处理x方向删除数，再处理y方向  
- 三重循环控制各方向删除数量，兼容所有组合  
- 标记数组实现高效筛选  

**核心代码**：
```cpp
void work(int x_del, int y_del, int z_del) {
    memset(d, 0, sizeof(d)); // 标记删除点
    // 标记x方向删除点
    // 剩余点按y排序后标记y方向删除点
    计算剩余点极值并更新ans
}
// 三重循环枚举各方向删除数
for (i,j,k) work(i,j,k);
```

---

### 关键思路与技巧总结
1. **极值点收集**：在x/y方向分别取前3-4个最小/最大值点，确保覆盖所有可能影响边界的点  
2. **暴力枚举优化**：将问题规模从O(N³)降至O(1)级别（固定12-20个候选点）  
3. **去重处理**：使用unique或标记数组避免重复枚举  
4. **极值维护**：每次枚举后快速计算剩余点的max/min值（可优化为仅遍历候选点）

---

### 类似题目推荐
1. [P2219 覆盖问题](https://www.luogu.com.cn/problem/P2219)（极值点分析与枚举）  
2. [P2698 花盆](https://www.luogu.com.cn/problem/P2698)（滑动窗口维护极值）  
3. [P1719 最大矩形](https://www.luogu.com.cn/problem/P1719)（二维极值转换）  

---

### 调试心得摘录
- **Zenith_Yeh**：发现同时删除x/y极值点时，可能出现重复标记，需用结构体id单独标记  
- **Violet_Evergarden**：手动枚举时遗漏部分组合，需用数学归纳法确保覆盖所有可能  
- **zmnjkl**：未去重导致超时，通过unique函数将枚举量从1e5降至200+

---
处理用时：69.21秒
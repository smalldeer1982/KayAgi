# 题目信息

# [USACO16OPEN] Diamond Collector S

## 题目描述

奶牛 Bessie 一直喜欢闪闪发光的物体，她最近在业余时间开始了一项爱好——挖掘钻石！她收集了 $N$ 颗大小各不相同的钻石（$N \leq 50,000$），并希望将它们中的一部分放在谷仓里的两个展示柜中展示。

由于 Bessie 希望每个展示柜中的钻石大小相对接近，她决定如果两颗钻石的大小相差超过 $K$，就不能将它们放在同一个展示柜中（如果两颗钻石的大小相差恰好为 $K$，则可以将它们一起展示在同一个展示柜中）。给定 $K$，请帮助 Bessie 确定她可以在两个展示柜中一起展示的最大钻石数量。

## 样例 #1

### 输入

```
7 3
10
5
1
12
9
5
14```

### 输出

```
5```

# AI分析结果



### 综合分析与结论
该题的核心在于排序后通过滑动窗口/双指针预处理左右区间，再寻找不重叠的两区间的最大和。最优解法需满足O(n)时间复杂度，且能正确处理区间不重叠问题。各题解普遍采用预处理+枚举断点的思路，差异主要体现在预处理方式（双指针/二分/差分）和数据结构优化上。

---

### 精选题解及评分

#### 1. 作者：牛蛙丶丶（5星）
**关键亮点**：
- 双指针预处理左右区间的最大值数组，逻辑清晰高效
- 利用前缀数组`ansl`和后缀数组`ansr`避免重复计算
- 代码简洁，仅需两次遍历即可完成预处理
**核心代码**：
```cpp
for(int i=1;i<=n;++i){
    while(a[i]-a[l]>k) l++;
    ansl[i]=max(ansl[i-1],i-l+1);
}
for(int i=n;i>=1;--i){
    while(a[r]-a[i]>k) r--;
    ansr[i]=max(ansr[i+1],r-i+1);
}
```
**个人心得**：通过反向遍历处理后缀数组时，需注意指针移动方向与区间计算的关系，避免越界。

#### 2. 作者：以墨（4星）
**关键亮点**：
- 双向DP预处理`l[i]`和`r[i]`，思路直观易理解
- 明确处理区间不重叠的逻辑（`l[i]+r[i+1]`）
- 代码注释详细，适合算法初学者学习
**核心代码**：
```cpp
for(int i=2,j=1;i<=n;i++){
    while(a[i]-a[j]>k) j++;
    l[i]=max(l[i-1],i-j+1);
}
for(int i=n-1,j=n;i>=1;i--){
    while(a[j]-a[i]>k) j--;
    r[i]=max(r[i+1],j-i+1);
}
```

#### 3. 作者：llzzxx712（4星）
**关键亮点**：
- 独立处理每个点的左右延伸区间，通过递推维护全局最大值
- 代码中明确注释易错点，具有实践指导意义
- 使用`lower_bound`处理边界条件，代码鲁棒性强
**核心代码**：
```cpp
for(int i=2,now=1;i<=n;i++){ 
    while(a[i]-a[now]>k) now++;
    le[i]=max(le[i-1],i-now+1);
}
for(int i=n-1,now=n;i>=1;i--){
    while(a[now]-a[i]>k) now--;
    r[i]=max(r[i+1],now-i+1);
}
```

---

### 最优关键思路总结
1. **排序预处理**：将钻石按大小排序，将问题转化为有序序列的区间选择问题。
2. **双指针滑动窗口**：通过左右指针动态维护最大有效区间，时间复杂度O(n)。
3. **前后缀最值数组**：分别预处理每个点左侧和右侧的最大区间长度，避免重复计算。
4. **断点枚举策略**：通过枚举分割点`i`，取`前缀最值[i] + 后缀最值[i+1]`确保区间不重叠。

---

### 拓展建议
1. **同类题型推荐**：
   - [P1102 A-B数对](https://www.luogu.com.cn/problem/P1102)（双指针找差值）
   - [P1638 逛画展](https://www.luogu.com.cn/problem/P1638)（滑动窗口求极小区间）
   - [P3147 双子序列最大和](https://www.luogu.com.cn/problem/P3147)（前后缀分解思想）
2. **算法延伸**：
   - 当需要选择多个区间时，可结合贪心策略与优先队列优化。
   - 对于动态区间最值维护，可考虑线段树或单调队列结构。

---
处理用时：51.25秒
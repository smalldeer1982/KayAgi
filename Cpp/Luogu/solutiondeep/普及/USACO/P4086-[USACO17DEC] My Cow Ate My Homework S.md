# 题目信息

# [USACO17DEC] My Cow Ate My Homework S

## 题目描述

在你的牛历史课上，你被布置了一份相当长的作业，包含 $N$ 个问题（$3 \leq N \leq 100,000$），每个问题的得分是一个在 0 到 10,000 之间的整数。按照惯例，你的老师计划通过去掉你得分最低的一个问题，然后对剩余问题的得分取平均来给出最终成绩。不幸的是，你的宠物奶牛 Bessie 刚刚吃掉了你前 $K$ 个问题的答案！（$K$ 可能小到 1，也可能大到 $N-2$）。

经过多次解释，你的老师终于相信了你的说法，并同意按照之前的方式对剩余的未被吃掉的部分作业进行评分——即去掉得分最低的问题（或在得分相同的情况下去掉其中一个），然后对剩余问题取平均。

请输出所有能够使你获得最高可能成绩的 $K$ 值，并按升序排列。

## 说明/提示

如果 Bessie 吃掉了前两个问题，那么剩余的得分是 9、2 和 7。去掉最低分并取平均后，最终成绩为 8，这是可能的最高成绩。

## 样例 #1

### 输入

```
5
3 1 9 2 7```

### 输出

```
2```

# AI分析结果



### 综合分析与结论
本题需在O(n)复杂度内求解多个区间的最优平均值，核心难点在于高效预处理区间最小值与总和。最优解法为**预处理后缀最小值与后缀和**，实现O(1)查询，时间复杂度O(n)。其他方法如线段树、分块等虽正确但复杂度或实现复杂度较高。

---

### 精选题解与评分

#### 1. 作者：_jimmywang_ （⭐️⭐️⭐️⭐️⭐️）
**关键亮点**  
- 预处理后缀最小值(`mn[]`)与后缀和(`sum[]`)，实现O(1)计算区间平均值  
- 代码简洁高效，仅需一次逆序遍历完成预处理  
- 通过分离计算逻辑与结果比较，逻辑清晰  

**核心代码**  
```cpp
for(int i=n;i>=2;i--) {
    mn[i] = min(mn[i+1], a[i]);
    sum[i] = sum[i+1] + a[i];
    avr[i] = (sum[i] - mn[i]) / (n - i);
}
```

---

#### 2. 作者：Siyuan （⭐️⭐️⭐️⭐️）
**关键亮点**  
- 动态维护区间最小值与总和，避免存储中间数组  
- 直接逆序枚举区间左界，代码紧凑  
- 用单变量维护最大值，减少空间占用  

**核心代码**  
```cpp
rep2(i,n-1,2) { // 逆序枚举区间左界i
    mins = min(mins, s[i]);   // 动态更新最小值
    sum += s[i];              // 动态累加和
    score = (sum - mins) / (n - i);
    if (score > max_score) 更新最大值与答案队列
}
```

---

#### 3. 作者：TRZ_2007 （⭐️⭐️⭐️⭐️）
**关键亮点**  
- 结合前缀和与后缀最小值预处理  
- 显式处理精度问题，避免浮点误差  
- 代码结构清晰，易读性较强  

**核心代码**  
```cpp
for(int i=1; i<=n-2; i++) {
    score = (sum[n]-sum[i]-Min[i+1]) / (n-i-1);
    if (score > max_score) 更新结果
}
```

---

### 最优关键思路与技巧
1. **后缀预处理**：逆序遍历一次计算后缀最小值(`mn[i]`)与后缀和(`sum[i]`)，使得每个`k`对应的区间计算复杂度为O(1)。  
2. **精度处理**：用整数运算避免浮点误差，或通过`double`显式转换保证精度。  
3. **结果筛选**：遍历过程中动态维护最大值，并记录所有符合条件的`k`，最后统一输出。

---

### 拓展与举一反三
- **同类问题**：区间最小值+区间和的组合优化（如P1440 求m区间内的最小值、P1886 滑动窗口）  
- **思维模式**：静态区间的极值与和/平均值问题，优先考虑后缀/前缀预处理而非动态数据结构。  
- **调试技巧**：验证预处理数组的正确性（如打印中间值），注意区间长度的边界条件。

---

### 推荐相似题目
1. [P1440 求m区间内的最小值](https://www.luogu.com.cn/problem/P1440)（单调队列模板）  
2. [P2870 [USACO07DEC]Best Cow Line G](https://www.luogu.com.cn/problem/P2870)（贪心+后缀预处理）  
3. [P4085 [USACO17DEC]Haybale Feast G](https://www.luogu.com.cn/problem/P4085)（区间和与极值组合问题）

---
处理用时：47.83秒
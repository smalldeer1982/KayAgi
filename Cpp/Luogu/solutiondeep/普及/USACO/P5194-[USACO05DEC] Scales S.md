# 题目信息

# [USACO05DEC] Scales S

## 题目描述

约翰有一架用来称牛的体重的天平。与之配套的是 $ N \ ( 1 \leq N \leq 1000 ) $ 个已知质量的砝码（所有砝码质量的数值都在 $32$ 位带符号整数范围内）。

每次称牛时，他都把某头奶牛安置在天平的某一边，然后往天平另一边加砝码，直到天平平衡，于是此时砝码的总质量就是牛的质量（约翰不能把砝码放到奶牛的那边，因为奶牛不喜欢称体重，每当约翰把砝码放到她的蹄子底下，她就会尝试把砝码踢到约翰脸上）。

天平能承受的物体的质量不是无限的，当天平某一边物体的质量大于 $ C \ ( 1 \leq C \leq 2^{30} ) $ 时，天平就会被损坏。砝码按照它们质量的大小被排成一行。并且，这一行中从第 $3$ 个砝码开始，每个砝码的质量至少等于前面两个砝码（也就是质量比它小的砝码中质量最大的两个）的质量的和。

约翰想知道，用他所拥有的这些砝码以及这架天平，能称出的质量最大是多少。由于天平的最大承重能力为 $C$，他不能把所有砝码都放到天平上。

现在约翰告诉你每个砝码的质量，以及天平能承受的最大质量，你的任务是选出一些砝码，使它们的质量和在不压坏天平的前提下是所有组合中最大的。

## 样例 #1

### 输入

```
3 15
1
10
20
```

### 输出

```
11```

# AI分析结果



### 综合分析与结论
题目核心在于利用砝码的斐波那契性质缩小数据规模，通过DFS+剪枝策略快速求解。所有题解均基于以下关键点：
1. **斐波那契性质**：实际有效砝码数约30-40个，允许暴力搜索
2. **倒序搜索**：优先选择大砝码，加速剪枝
3. **前缀和剪枝**：若当前总和+剩余前缀和≤当前最优解，直接剪枝

---

### 精选题解与评分

#### 1. StudyingFather（★★★★★）
**核心亮点**：  
- 最优剪枝策略：`sum[cur-1]+x <= c`时直接取全部剩余砝码  
- 倒序DFS实现简洁高效  
- 完整处理输入时的越界检测  

**个人心得**：  
> "一个剪枝：如果前面那些砝码可以全部取走，那直接取走即可"

**核心代码**：
```cpp
void dfs(int cur,long long x) {
    if(x>c)return;
    if(sum[cur-1]+x<=c) { // 核心剪枝
        ans=max(ans,sum[cur-1]+x);
        return;
    }
    ans=max(ans,x);
    for(int i=1;i<cur;i++)
        dfs(i,x+a[i]);
}
```

#### 2. Plozia（★★★★☆）
**核心亮点**：  
- 输入时逆序存储砝码，天然形成降序序列  
- `sum[k]`后缀和优化剪枝判断  
- 函数式编程风格清晰  

**核心代码**：
```cpp
void dfs(int k,int now) {
    if(now+sum[k]<=c) { // 后缀和剪枝
        ans=Max(now+sum[k],ans);
        return;
    }
    if(now+a[k]<=c) dfs(k+1,now+a[k]);
    dfs(k+1,now);
}
```

#### 3. 代码练习生（★★★★☆）
**核心亮点**：  
- 显式处理输入时的截断点  
- 双重剪枝：`cur+b[index]<=max`与`cur+fama[index]>C`  
- 强调代码顺序对正确性的影响  

**调试教训**：  
> "千万要把max更新语句放到剪枝判断上面...找了一个小时"

**核心代码**：
```cpp
void dfs(long long cur,int index) {
    if(cur+b[index]<=max) return;
    max=cur<max?max:cur; // 必须在剪枝前更新max
    if(index==0) return;
    if(cur+fama[index]<=C) 
        dfs(cur+fama[index],index-1);
    dfs(cur,index-1);
}
```

---

### 关键思路总结
1. **斐波那契性质应用**：通过数学分析缩小问题规模
2. **倒序贪心搜索**：优先处理大数加速剪枝
3. **前缀和剪枝**：`当前值+剩余总和≤当前最优解`时直接剪枝
4. **实时更新最大值**：在递归过程中动态维护最优解

---

### 类似题目推荐
1. [P4799 世界冰球锦标赛](https://www.luogu.com.cn/problem/P4799) - 分治+双向搜索经典题
2. [P1441 砝码称重](https://www.luogu.com.cn/problem/P1441) - 状态压缩+DFS组合
3. [P2320 鬼谷子的钱袋](https://www.luogu.com.cn/problem/P2320) - 斐波那契数列构造问题

---

### 个人心得摘录
- **调试教训**：代码练习生因`max`更新顺序错误导致长时间调试，强调逻辑顺序的重要性  
- **优化意识**：多篇题解提到输入时即截断超限砝码，体现预处理的重要性  
- **数学分析**：hylong通过斐波那契数列计算验证数据规模，展示数学建模的关键作用

---
处理用时：59.67秒
# 题目信息

# [USACO07NOV] Best Cow Line S

## 题目背景

*本题和 [2007 年 12 月月赛金组同名题目](/problem/P2870) 在题意上一致，唯一的差别是数据范围。*

## 题目描述

Farmer John 打算带领 $N$（$1 \leq N \leq 2\,000$）头奶牛参加一年一度的”全美农场主大奖赛“。在这场比赛中，每个参赛者必须让他的奶牛排成一列，然后带领这些奶牛从裁判面前依此走过。

今年，竞赛委员会在接受报名时，采用了一种新的登记规则：取每头奶牛名字的首字母，按照它们在队伍中的次序排成一列。将所有队伍的名字按字典序升序排序，从而得到出场顺序。

FJ 由于事务繁忙，他希望能够尽早出场。因此他决定重排队列。

他的调整方式是这样的：每次，他从原队列的首端或尾端牵出一头奶牛，将她安排到新队列尾部。重复这一操作直到所有奶牛都插入新队列为止。

现在请你帮 FJ 算出按照上面这种方法能排出的字典序最小的队列。

## 样例 #1

### 输入

```
6
A
C
D
B
C
B```

### 输出

```
ABCBCD```

# AI分析结果



### 综合分析与结论
本题核心为贪心策略，关键在于处理首尾字符相同时的决策。最优解法采用双指针向中间探测首个不同字符进行比较，确保每一步选择字典序最小的方向。各题解中，wylt的解法处理边界严谨、代码简洁，是最优实现。

---

### 精选题解（评分≥4星）

#### 1. 作者：wylt（★★★★★）
**关键亮点**  
- 清晰的循环结构处理首尾相同情况  
- 使用临时指针`ll, rr`确保不越界  
- 每80字符换行的标准处理  
**个人心得**  
> "当两端的字符相等时，需要一路往中间比较，直到找到不同的字符才能决策，否则会错误选择导致字典序不最优。"

**核心代码**  
```cpp
int l=1, r=n;
while(l <= r) {
    if (a[l] < a[r]) { /* 取左 */ }
    else if (a[l] > a[r]) { /* 取右 */ }
    else {
        int ll=l, rr=r;
        while(ll <= rr && a[ll] == a[rr]) { ll++; rr--; }
        if (a[ll] <= a[rr]) { /* 取左 */ } 
        else { /* 取右 */ }
    }
}
```

#### 2. 作者：Exber（★★★★☆）
**关键亮点**  
- 使用`deque`直观管理首尾操作  
- 通过临时队列复制处理相同字符的探测  
**核心实现思想**  
当首尾相等时，复制当前队列并逐层向内比较，避免修改原队列结构。

---

### 最优关键思路
**贪心探测策略**：当首尾字符相同时，向中间寻找第一个不同字符，比较其大小决定选取方向。通过双指针模拟这一过程，确保每一步的局部最优解导向全局最优。

---

### 拓展与相似题目
1. [P2870 Best Cow Line, Gold](https://www.luogu.com.cn/problem/P2870)（数据加强版本题）
2. [P1090 合并果子](https://www.luogu.com.cn/problem/P1090)（贪心策略选择）
3. [P1106 删数问题](https://www.luogu.com.cn/problem/P1106)（构造最小字典序数）

---
处理用时：131.36秒
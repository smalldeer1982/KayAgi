# 题目信息

# [USACO10OPEN] Mountain Watching S

## 题目描述

一天，Bessie 望着远处的山脉，在思考：“哪一座山最宽呢？”

Bessie 设法测量了 $N$ 个位置的高度 $h_i$（$1 \leq N \leq 10^5$，$1 \leq h_i \leq 10^9$）。一座山被定义为一个高度先不下降，后不上升的子序列。视野边缘的山脉也只会增加或减少高度。一座山的宽度被定义为这座山包含的位置数量。

下面是一个例子：

```plain
           *******                   *
          *********                 ***
          **********               *****
          ***********           *********               *
*      *****************       ***********             *** *
**    *******************     *************   * *     *******      *
**********************************************************************
3211112333677777776543332111112344456765432111212111112343232111111211
aaaaaa                   ccccccccccccccccccccc eeeeeee    ggggggggg
  bbbbbbbbbbbbbbbbbbbbbbbbbbbb             ddddd ffffffffff  hhhhhhhhh
```

每座山都已经用字母标出来了。这里 `b` 山脉的宽度最大，为 $28$。

## 样例 #1

### 输入

```
7
3
2
3
5
4
1
6```

### 输出

```
5```

# AI分析结果



### 综合分析与结论
本题要求找出最长连续单峰子序列，关键思路是预处理每个位置左右的最长不降/不升序列长度，组合后取最大值。最优解法时间复杂度为O(n)，基于动态规划预处理两个数组。

---

### 高分题解推荐

#### 1. Link_Cut_Y 的题解（⭐️⭐️⭐️⭐️⭐️）
**关键亮点**  
- 代码简洁，预处理逻辑清晰。
- 明确处理边界条件，避免重复计算峰顶。
- 时间复杂度O(n)，完全满足题目要求。

**核心代码**  
```cpp
for (int i = 1; i <= n; i++)
    up[i] = h[i] >= h[i-1] ? up[i-1] + 1 : 1;
for (int i = n; i >= 1; i--)
    down[i] = h[i] >= h[i+1] ? down[i+1] + 1 : 1;
int ans = max(up[i] + down[i] - 1); // 遍历所有i取最大值
```

#### 2. Remake 的题解（⭐️⭐️⭐️⭐️⭐️）
**关键亮点**  
- 命名直观（`zheng`为正向不降，`fan`为逆向不升）。
- 初始化边界明确，直接处理连续子序列。
- 代码简短，逻辑与数学推导完全对应。

**核心代码**  
```cpp
for (int i=2; i<=n; i++)
    a[i]>=a[i-1] ? zheng[i]=zheng[i-1]+1 : zheng[i]=1;
for (int i=n-1; i>=1; i--)
    a[i]>=a[i+1] ? fan[i]=fan[i+1]+1 : fan[i]=1;
maxn = max(zheng[i] + fan[i] - 1); // 遍历取最大值
```

---

### 最优思路总结
1. **双数组预处理**：通过正序和逆序两次遍历，分别计算每个位置的最长不降（`up`）和最长不升（`down`）序列长度。
2. **组合求峰顶**：对于每个位置，将左右序列长度相加后减1（峰顶去重），取全局最大值。
3. **边界处理**：通过设置虚拟边界（如`h[0]`和`h[n+1]`为极大/极小值）避免越界判断。

---

### 同类题目推荐
1. [P1091 合唱队形](https://www.luogu.com.cn/problem/P1091)  
   **相似点**：求最长单峰子序列（非连续），需双向LIS预处理。
2. [P2947 Look Up S](https://www.luogu.com.cn/problem/P2947)  
   **相似点**：预处理右侧第一个更大元素，类似逆向遍历思想。
3. [P2216 理想的正方形](https://www.luogu.com.cn/problem/P2216)  
   **相似点**：滑动窗口结合预处理，需多维最值预处理。

---
处理用时：137.38秒
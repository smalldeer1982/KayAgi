# 题目信息

# [USACO06OCT] Cow Pie Treasures G

## 题目描述

奶牛们制作了一些藏有金币的馅饼，并把它们排成了一个 $r$ 行 $c$ 列的矩阵。现在，你需要从坐标为 $(1,1)$ 的馅饼旁移动到坐标为 $(r,c)$ 的馅饼旁。对于每次移动，你必须向右移动一列，并且行数的变动不能超过 $1$。即如果你处于坐标为 $(x,y)$ 的馅饼旁，你只能移动到坐标为 $(x-1,y+1)$，$(x,y+1)$ 或 $(x+1,y+1)$ 的馅饼旁。在一个馅饼旁停留时，你可以拿走其中所有的金币。当然，你一定不愿意中途离开矩阵而放弃这些金币。

奶牛们把标有矩阵中每一块馅饼所藏金币数的表格交给了你。你想知道按照以上规则，自己最多能拿到多少金币。

## 说明/提示

**【数据范围】**

对于 $100\%$ 的数据，$1\le r,c\le 100$，$1\le t\le 25$。

------------

**【样例说明】**

![](https://cdn.luogu.com.cn/upload/image_hosting/pgw19uqm.png)

样例给出的矩阵如图所示。

![](https://cdn.luogu.com.cn/upload/image_hosting/hwhzq9oy.png)

这是一种合法的移动方式。你可以拿到 $47$ 枚金币。

![](https://cdn.luogu.com.cn/upload/image_hosting/sdyxlpv5.png)

在这个矩阵中你最多能拿到 $50$ 枚金币，路线如图所示。

## 样例 #1

### 输入

```
3 7
6 5 3 7 9 2 7
2 4 3 5 6 8 6
4 9 9 9 1 5 8```

### 输出

```
50```

# AI分析结果



### 综合分析与结论
题目本质是动态规划中的路径最值问题，核心在于状态转移方向与可达性判断。所有题解均采用DP解法，主要差异在边界处理、初始化策略及遍历顺序。关键难点在于理解“斜线可达性限制”（即第j列最多j行）和正确处理数组越界问题。

---

### 高分题解推荐

#### 1. WaltVBAlston（⭐⭐⭐⭐）
**关键亮点**：
- 通过错误代码对比揭示边界条件的重要性
- 提出`j<=i`的行遍历限制条件，清晰解释斜线可达性
- 代码简洁，注释恰到好处

**个人心得**：
> "把地图看成一个四边形...斜线以下的部分是到达不了的" —— 通过几何视角理解可达性限制

**核心代码**：
```cpp
for(int i=1;i<=m;i++) {
    for(int j=1;j<=n&&j<=i;j++) { // 关键行限制
        dp[j][i] = max(...) + a[j][i];
    }
}
```

#### 2. LongDouble（⭐⭐⭐⭐）
**关键亮点**：
- 强调初始化策略，用极小值避免无效状态干扰
- 给出具体反例说明初始化必要性
- 代码规范，包含完整边界处理

**调试经验**：
> "25这个值会被错误传递到后续计算" —— 通过实例说明初始化不当的后果

**核心代码**：
```cpp
memset(dp, -0x3f, sizeof dp); // 关键初始化
dp[1][1] = t[1][1];
for(int j=2;j<=c;j++)
    for(int i=1;i<=r;i++)
        dp[i][j] = ...;
```

#### 3. monstersqwq（⭐⭐⭐）
**关键亮点**：
- 详细推导状态转移方程
- 对比错误/正确代码差异
- 使用更严格的数据范围约束

**优化技巧**：
修改遍历条件为`i<=min(j, r)`，既保证可达性又防止越界

---

### 关键思路与技巧总结
1. **状态转移方向**：逆向思维，当前位置只能从前一列的三个相邻行转移
2. **遍历顺序**：必须按列优先遍历，确保前一列数据已计算完成
3. **可达性约束**：第j列的最大行数为min(j, r)，通过循环条件限制
4. **初始化策略**：除起点外初始为极小值（-INF），避免无效状态参与计算
5. **空间优化**：可优化为滚动数组，但题目数据范围无需优化

---

### 类似题目推荐
1. P1216 [USACO1.5] 数字三角形（经典路径DP）
2. P1002 [NOIP2002 普及组] 过河卒（棋盘路径计数）
3. P1434 [SHOI2002] 滑雪（带方向约束的DP）

---

### 题解心得摘录
1. **调试经验**：
- "如果不处理不可达区域，会错误累积无效路径的值"（WaltVBAlston）
- "初始化成0会导致中间状态错误覆盖正确值"（LongDouble）

2. **思维突破**：
- "将二维移动问题分解为列优先的阶段性决策"（do_while_false）
- "记忆化搜索通过剪枝避免无效路径"（DreamFox）

3. **实现技巧**：
- "使用三重max函数简化状态转移"（monstersqwq）
- "快读优化提升输入效率"（do_while_false）

---
处理用时：43.44秒
# 题目信息

# [USACO20DEC] Cowntagion S

## 题目描述

Farmer John 和他的农民团队为了控制牛传染病 COWVID-19 在他们农场间的传播而夜以继日地工作。

他们共同监控着 $N$ 个农场（$1≤N≤10^5$），编号为 $1…N$。农场间由 $N−1$ 条道路连接，使得每个农场都可以从农场 $1$ 出发经过一些道路到达。

很不幸，农场 $1$ 中的一头奶牛的 COWVID-19 检测呈阳性。暂时这个农场的其他奶牛以及其他农场的所有奶牛都还没有染上疾病。然而，根据这个疾病通过接触传播的特性，Farmer John 推测每一天都会有以下不利的事件之一发生：

(1) 在一个农场内，「超级传播者」导致该农场感染 COWVID-19 的奶牛数量翻倍；或者

(2) 一头感染 COWVID-19 的奶牛从一个农场沿道路去往了一个相邻的农场。

Farmer John 担心疫情会很快爆发。请帮助 Farmer John 求出每个农场内均有至少一头奶牛感染疾病所需经过的最小天数。 

## 说明/提示

该样例对应的一个可能的事件序列如下：农场 $1$ 内染病的奶牛数量翻倍再翻倍，使得两天后农场 $1$ 内有 $4$ 头染病的奶牛。在此后 $3$ 天，分别有一头染病的奶牛从农场 $1$ 去往农场 $2$、$3$ 和 $4$。$5$ 天过后每个农场均有至少 $1$ 头染病的奶牛。


 - 测试点 1-4 中，每个农场均直接与农场 $1$ 相连（除农场 $1$ 外）。
 - 测试点 5-7 中，农场 $2…N$ 均至多与两条道路相连。
 - 测试点 8-15 没有额外限制。

供题：Dhruv Rohatgi 

## 样例 #1

### 输入

```
4
1 2
1 3
1 4```

### 输出

```
5```

# AI分析结果



### 综合分析与结论
本题核心是通过贪心策略计算每个节点所需的翻倍次数与传播次数。最优解法为：对每个节点计算翻倍至足够感染所有子节点的天数（取对数），总和后加上传播所需的 $n-1$ 天。关键优化在于利用度数代替显式树结构，时间复杂度 $O(n)$。

---

### 高星题解推荐

#### 1. 作者：wsyhb（★★★★★）
**关键亮点**：  
- 严谨数学推导证明贪心策略最优性  
- 引入点权概念清晰转化题意  
- 预处理 Log 表优化计算  
**核心实现**：
```cpp
int main() {
    dfs(1); // 统计每个节点的儿子数 son[i]
    for(int i=1;i<=n;i++) 
        ans += Log[son[i]+1] + (判断是否为2的幂的修正);
    cout << ans + n-1;
}
```

#### 2. 作者：ETHANK（★★★★☆）
**关键亮点**：  
- 利用度数直接计算子节点数，避免显式建树  
- 代码极简（仅20行）  
- 预处理 Log 表的位运算技巧  
**核心代码**：
```cpp
for(int i=1;i<=n;i++) Log[i]=Log[i>>1]+1; // 预处理
ans = Log[deg[1]]; // 根节点
for(int i=2;i<=n;i++) ans += Log[deg[i]-1]; // 其他节点
cout << ans + n-1;
```

#### 3. 作者：零殇（★★★★☆）
**关键亮点**：  
- 独创性边数统计法替代树遍历  
- 代码简洁易理解  
- 巧妙处理自留1头牛的逻辑  
**核心片段**：
```cpp
for(int i=1;i<=n;i++) sum[i] = 边数统计;
while(x <= sum[i]) { tot++; x *=2; } // 翻倍计算
tot += sum[i]; // 传播天数
```

---

### 最优思路提炼
1. **度数替代显式树**：根节点度数即子节点数，其余节点度数为父节点数+子节点数  
2. **对数预处理**：利用位运算预处理 $\lceil log_2 \rceil$ 避免重复计算  
3. **分层计算策略**：每个节点独立计算翻倍天数，传播天数固定为 $n-1$  

---

### 相似题目推荐
1. [P1352 没有上司的舞会](https://www.luogu.com.cn/problem/P1352)（树形DP）  
2. [P2015 二叉苹果树](https://www.luogu.com.cn/problem/P2015)（树形DP+资源分配）  
3. [P3177 树上染色](https://www.luogu.com.cn/problem/P3177)（树形DP+组合贪心）

---

### 心得摘录
> "不需要显式建树，直接统计度数即可" —— 利用输入特性简化数据结构  
> "预处理 Log 表时注意处理非2幂情况" —— 位运算优化经验  
> "每个节点独立计算，避免复杂父子状态传递" —— 分治思想的典型应用  

这些经验体现了对问题本质的深刻理解和代码优化的实践智慧。

---
处理用时：55.90秒
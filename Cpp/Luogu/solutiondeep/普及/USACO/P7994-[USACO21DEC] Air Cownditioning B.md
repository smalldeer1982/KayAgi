# 题目信息

# [USACO21DEC] Air Cownditioning B

## 题目描述

Farmer John 的 $N$ 头奶牛对他们牛棚的室温非常挑剔。有些奶牛喜欢温度低一些，而有些奶牛则喜欢温度高一些。

Farmer John 的牛棚包含一排 $N$ 个牛栏，编号为 $1 \ldots N$，每个牛栏里有一头牛。 第 $i$ 头奶牛希望她的牛栏中的温度是 $p_i$，而现在她的牛栏中的温度是 $t_i$。为了确保每头奶牛都感到舒适，Farmer John 安装了一个新的空调系统。该系统进行控制的方式非常有趣，他可以向系统发送命令，告诉它将一组连续的牛栏内的温度升高或降低 1 个单位——例如「将牛栏 $5 \ldots 8$ 的温度升高 1 个单位」。一组连续的牛栏最短可以仅包含一个牛栏。

请帮助 Farmer John 求出他需要向新的空调系统发送的命令的最小数量，使得每头奶牛的牛栏都处于其中的奶牛的理想温度。

## 说明/提示

【样例解释】

一组最优的 Farmer John 可以使用的指令如下：

```
初始温度     ：1 2 2 2 1
升高牛棚 2..5：1 3 3 3 2
升高牛棚 2..5：1 4 4 4 3
升高牛棚 2..5：1 5 5 5 4
降低牛棚 3..4：1 5 4 4 4
降低牛棚 3..4：1 5 3 3 4
```

【数据范围】

- 测试点 2-5 满足 $N \leq 100$。
- 测试点 6-8 满足 $N \leq 1000$。
- 测试点 9-10 满足 $N \leq 100,000$
- 测试点 1-6 和 9 中，温度值不超过 $100$
- 测试点 7-8 和 10 中，温度值不超过 $10,000$。


## 样例 #1

### 输入

```
5
1 5 3 3 4
1 2 2 2 1```

### 输出

```
5```

# AI分析结果



### 综合分析与结论
本题的核心在于通过差分数组将连续区间操作转化为对差分值的调整，最终通过统计正负数总和的绝对值的最大值得出最小操作次数。正确解法基于差分数组的正负分解，时间复杂度为O(n)，适用于所有数据范围。

### 高星题解推荐
#### 作者：Eason_AC (5星)
**关键亮点**：  
- 正确应用差分数组思想，将问题转化为经典模型（P4552）。  
- 清晰解释操作对差分数组的影响，最终推导出正负数总和的最大值为答案。  
- 代码简洁高效，逻辑严密，完美处理大数据情况。  

**核心代码**：  
```cpp
int d[100005];
ll sum1 = 0, sum2 = 0;
for (int i = 1; i <= n; i++) {
    d[i] = p[i] - t[i]; // 原差数组
    int diff = d[i] - d[i-1]; // 差分值
    if (diff > 0) sum1 += diff;
    else sum2 += -diff;
}
cout << max(sum1, sum2);
```

#### 作者：刘辰雨 (4星)
**关键亮点**：  
- 通过分离正负差值数组（升/降温需求），分别处理相邻差值变化。  
- 与经典题目（铺设道路）类比，直观展示贪心思路。  
- 代码结构清晰，但未明确解释与差分解法的等价性。  

**核心代码**：  
```cpp
long long a[100001], b[100001]; // 分别存储正/负差值
for (int i = 1; i <= n; i++) {
    long long x = want[i] - now[i];
    if (x >= 0) a[i] = x; // 正差（需降温）
    else b[i] = -x;       // 负差绝对值（需升温）
}
// 统计正差数组的增量操作
for (int i = 1; i <= n; i++) {
    if (a[i] > a[i-1]) ans += a[i] - a[i-1];
}
// 统计负差数组的增量操作
for (int i = 1; i <= n; i++) {
    if (b[i] > b[i-1]) ans += b[i] - b[i-1];
}
```

#### 作者：xkcdjerry (4星)
**关键亮点**：  
- 直接映射到积木大赛模型，通过相邻差值累加绝对增量。  
- 代码极简，但未详细解释为何正负处理不影响结果。  

**核心代码**：  
```cpp
int a[100010], ans = 0;
for (int i = 1; i <= n; i++) {
    a[i] = p[i] - t[i];
}
for (int i = 1; i <= n+1; i++) {
    ans += max(a[i] - a[i-1], 0); // 累加正增量
}
```

### 最优思路总结
1. **差分转换**：将原数组差值转换为差分数组，连续区间操作等价于调整差分值。
2. **正负分离**：统计差分数组的正数总和（需降温次数）和负数绝对值总和（需升温次数）。
3. **取最大值**：最终答案为两总和的较大值，因独立处理剩余操作更优。

### 拓展建议
- **同类问题**：区间增减操作的最优化问题（如P5019、P4552）。  
- **思维训练**：尝试将问题转化为差分模型，分离操作对边界的影响。  

### 推荐题目
1. [P5019 铺设道路](https://www.luogu.com.cn/problem/P5019)  
2. [P4552 [Poetize6] IncDec Sequence](https://www.luogu.com.cn/problem/P4552)  
3. [P1969 积木大赛](https://www.luogu.com.cn/problem/P1969)

---
处理用时：232.27秒
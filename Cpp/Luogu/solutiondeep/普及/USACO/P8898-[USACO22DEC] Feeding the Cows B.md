# 题目信息

# [USACO22DEC] Feeding the Cows B

## 题目描述

Farmer John 有 $N(1 \le N \le 10^5)$ 头奶牛，每头奶牛的品种是更赛牛（Guernsey）或荷斯坦牛（Holstein）之一。她们沿水平方向排成一行，奶牛们占据的位置编号为 $1 \cdots N$。

由于奶牛们都饿了，FJ 决定在 $1 \cdots N$ 中的某些位置上种植草地。更赛牛和荷斯坦牛喜欢不同类型的草，所以如果 Farmer John 决定在某个位置种草，他必须选择种植更赛牛喜欢的草或荷斯坦牛喜欢的草——他不能在同一个位置同时种两种草。种植的每一片草地都可以喂饱数量不限的相应品种的奶牛。 

每头奶牛愿意移动至多 $K(0 \le K \le N-1)$ 个位置以前往一个草地。求出喂饱所有奶牛所需种植的最小草地数量。此外，输出一种使用最小草地数量喂饱所有奶牛的种植方案。任何满足上述条件的方案均视为正确。 

## 说明/提示

### 样例 1 解释

注意对于某些子测试用例，存在多种可通过的方案使用最小数量的草地。例如，在第四个子测试用例中，以下是另一个可以通过的答案：

$$\texttt{.GH..}$$

这个方案在第二个位置种植一块喂饱更赛牛的草地以及在第三个位置种植一块喂饱荷斯坦牛的草地。这使用了最小数量的草地并确保了所有奶牛都在她们喜欢的草地的 $3$ 个位置以内。

### 测试点性质

- 测试点 $2-4$ 满足 $N \le 10$。
- 测试点 $5-8$ 满足 $N \le 40$。
- 测试点 $9-12$ 满足 $N \le 10^5$。 

## 样例 #1

### 输入

```
6
5 0
GHHGG
5 1
GHHGG
5 2
GHHGG
5 3
GHHGG
5 4
GHHGG
2 1
GH```

### 输出

```
5
GHHGG
3
.GH.G
2
..GH.
2
...GH
2
...HG
2
HG```

# AI分析结果



### 综合分析与结论
各题解均采用贪心思路，核心策略是尽可能将草地放置在能覆盖最远的位置（通常选择当前位置i+k），若越界则调整至边界。关键难点在于处理两种草地的冲突与维护覆盖范围。最优解法通过维护两类草地的当前覆盖终点，线性遍历并动态更新，实现O(n)时间复杂度。

---

### 精选题解推荐

#### 1. 作者：chlchl（⭐⭐⭐⭐⭐）
**关键亮点**  
- 维护两种草的覆盖终点`nowh/nowg`，动态更新覆盖范围  
- 从`i+k`反向查找空位，确保覆盖最大化  
- 严格线性复杂度，代码简洁高效  

**核心代码思想**  
```cpp
int nowh = 0, nowg = 0;
for (int i = 1; i <= n; i++) {
    if (s[i] == 'H' && nowh < i) {
        // 从min(i+k,n)向前找第一个空位放置H
        for (int j = min(i+k, n); j; j--) {
            if (t[j] == '.') {
                t[j] = 'H';
                nowh = j + k; // 更新覆盖终点
                break;
            }
        }
    }
    // 同理处理G
}
```

#### 2. 作者：Svemit（⭐⭐⭐⭐）
**关键亮点**  
- 使用`h/g`记录上次放置位置，通过绝对距离判断覆盖  
- 显式处理越界情况，代码直观易理解  
- 通过反向扫描避免重复计算  

**调试心得**  
> "当位置超过n时，从n开始反向查找空位，确保不会出现无解情况。需注意数组下标起始值（0或1）的一致性。"

---

### 最优思路提炼
**核心贪心策略**  
1. **最远放置原则**：对于当前奶牛，尽可能在`i+k`处放置对应草地，若越界则取`n`  
2. **反向扫描空位**：当目标位置被占时，反向查找第一个可用位置，保证覆盖范围前向扩展  
3. **双指针维护覆盖**：独立维护两类草的覆盖终点，避免重复计算  

**同类型扩展**  
- 类似区间覆盖问题（如P1090 合并果子）  
- 可变形为带权重的覆盖问题（如P1208 混合牛奶）  
- 多维覆盖场景（如P5019 铺设道路的贪心变形）

---

### 推荐练习题
1. **P1221 线段覆盖**（经典区间覆盖贪心）  
2. **P1803 活动安排**（时间区间最大覆盖）  
3. **P5019 铺设道路**（贪心策略与覆盖顺序）

---
处理用时：56.57秒
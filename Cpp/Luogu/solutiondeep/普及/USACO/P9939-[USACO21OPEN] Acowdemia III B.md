# 题目信息

# [USACO21OPEN] Acowdemia III B

## 题目描述

Bessie 是一位忙碌的计算机科学研究生。然而，即使是研究生也需要交友。因此，Farmer John 开设了一片草地，目的是为了帮助 Bessie 与其他奶牛建立持久的友谊。

Farmer John 的草地可以被看做是由正方形方格组成的巨大二维方阵（想象一个巨大的棋盘）。每个方格用如下字符标记：

 - `C`，如果这个方格中有一头奶牛。
 - `G`，如果这个方格中有草。
 - `.`，如果这个方格既没有奶牛也没有草。

对于两头想要成为朋友的奶牛，她们必须选择在一个与她们均水平或竖直方向上相邻的有草方格见面。在这个过程中，她们会在这个有草方格中吃草，所以之后的奶牛不能再使用这个方格作为见面地点。一头奶牛可以与多头其他奶牛成为朋友，但是同一对奶牛不能见面并成为朋友多于一次。

Farmer John 希望有许多奶牛可以见面并成为朋友。请求出当这一活动结束时在奶牛之间可以建立的朋友关系的最大数量。 

## 说明/提示

### 样例解释 1

如果我们用坐标 $(i,j)$ 标记第 $i$ 行第 $j$ 列的奶牛，则在这个样例中于 $(1,2)$、$(1,5)$、$(2,2)$、$(2,4)$、$(3,1)$、$(3,3)$、$(4,2)$、$(4,3)$ 以及 $(4,5)$ 
存在奶牛。一种使四对奶牛成为朋友的方式如下：

 - 位于 $(2,2)$ 和 $(3,3)$ 的奶牛于 $(3,2)$ 一起吃草。
 - 位于 $(2,2)$ 和 $(2,4)$ 的奶牛于 $(2,3)$ 一起吃草。
 - 位于 $(2,4)$ 和 $(3,3)$ 的奶牛于 $(3,4)$ 一起吃草。
 - 位于 $(2,4)$ 和 $(1,5)$ 的奶牛于 $(2,5)$ 一起吃草。


### 测试点性质

 - 测试点 $2-4$ 满足 $N=2$。
 - 测试点 $5-12$ 没有额外限制。

## 样例 #1

### 输入

```
4 5
.CGGC
.CGCG
CGCG.
.CC.C```

### 输出

```
4```

# AI分析结果



### 综合分析与结论

题目要求奶牛在相邻的草地（G）上建立朋友关系，每个G只能使用一次。关键在于正确识别并优先处理只能被一对奶牛使用的G，再处理斜对角可能的配对。

### 精选题解

#### 作者：Rannio（★★★★☆）

**关键亮点**：
1. **贪心策略**：优先处理上下或左右都有牛的G，确保每个G被唯一配对使用。
2. **有效标记**：处理斜对角时，标记已使用的G，避免重复计数。
3. **简洁高效**：通过两次遍历处理两种场景，时间复杂度为O(nm)。

**核心代码实现**：
```cpp
for (int i = 1; i <= n; i++) {
    for (int j = 1; j <= m; j++) {
        if (cr[i][j] == 2) { // 当前格子是G
            if ((cr[i-1][j] == 1 && cr[i+1][j] == 1) || 
                (cr[i][j-1] == 1 && cr[i][j+1] == 1)) {
                cr[i][j] = 0; // 标记为已用
                ans++;
            }
        }
    }
}
// 处理斜对角情况
for (int i = 1; i <= n; i++) {
    for (int j = 1; j <= m; j++) {
        if (cr[i][j] == 1) { // 当前格子是牛
            if (cr[i+1][j-1] == 1) { // 右下方有牛
                // 检查左边或下方的G
                if (cr[i][j-1] == 2) {
                    cr[i][j-1] = 0;
                    ans++;
                } else if (cr[i+1][j] == 2) {
                    cr[i+1][j] = 0;
                    ans++;
                }
            }
            if (cr[i+1][j+1] == 1) { // 右上方有牛
                // 检查右边或下方的G
                if (cr[i][j+1] == 2) {
                    cr[i][j+1] = 0;
                    ans++;
                } else if (cr[i+1][j] == 2) {
                    cr[i+1][j] = 0;
                    ans++;
                }
            }
        }
    }
}
```

**个人心得**：
- 处理顺序至关重要，先处理唯一性高的配对避免冲突。
- 标记G为已用是防止重复计数的关键步骤。

### 最优思路总结
1. **贪心处理唯一配对**：优先处理上下或左右都有牛的G，确保每个G被唯一使用。
2. **斜对角灵活选择**：处理剩余G时，优先选择可用的G并标记，确保每对奶牛仅使用一个G。

### 拓展与相似题目
- **类似贪心策略**：P2895 [USACO08FEB] Meteor Shower S（优先处理危险区域）
- **网格配对问题**：P2937 [USACO09JAN] Laserphones S（BFS+方向优化）
- **图论建模**：P2172 [国家集训队] 部落战争（网络流匹配）

### 推荐题目
1. [P2895 USACO08FEB Meteor Shower S](https://www.luogu.com.cn/problem/P2895)
2. [P2937 USACO09JAN Laserphones S](https://www.luogu.com.cn/problem/P2937)
3. [P2172 国家集训队 部落战争](https://www.luogu.com.cn/problem/P2172)

---
处理用时：326.12秒
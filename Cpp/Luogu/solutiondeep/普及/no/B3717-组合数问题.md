# 题目信息

# 组合数问题

## 题目描述

给出 $T$ 次询问，每次给出 $n,m$，请求出 $\binom{n}{m}$ 对 $998,244,353$ 取模的结果。

其中 $\binom{n}{m}$ 为二项式系数，它的另一种写法是 $C_n^m$。

## 说明/提示

### 样例 1 解释

三组询问的答案依次是 $1, 6, 10$。

### 数据规模与约定

对 $100\%$ 的数据，保证 $1 \leq T \leq 5 \times 10^6$，$0 \leq m \leq n \leq N \leq 5 \times 10^6$。

### 提示

请注意大量的数据读入对程序效率造成的影响，选择合适的读入方式，避免超时。

## 样例 #1

### 输入

```
3 5
3 3
4 2
5 3```

### 输出

```
13```

# AI分析结果

### 算法分类
组合数学

### 综合分析与结论
题目要求高效计算组合数并对大质数取模，核心思路是利用预处理阶乘和逆元来优化计算。各题解均采用了预处理阶乘和逆元的方法，但在实现细节和优化上有所不同。主要难点在于如何高效计算逆元，以及如何避免重复计算。

### 所选题解
1. **作者：cjh20090318 (赞：33)**
   - **星级：5星**
   - **关键亮点**：代码简洁，预处理阶乘和逆元的方法清晰，时间复杂度分析准确。
   - **个人心得**：作者提到由于数据量大，选择合适的读入方式避免超时，强调了预处理的重要性。
   - **核心代码**：
     ```cpp
     for(int i=2;i<=N;i++) f[i]=(LL)f[i-1]*i%mod,inv[i]=(LL)(mod-mod/i)*inv[mod%i]%mod;
     for(int i=1;i<=N;i++) inv[i]=(LL)inv[i-1]*inv[i]%mod;
     ```

2. **作者：sto_5k_orz (赞：11)**
   - **星级：4星**
   - **关键亮点**：利用费马小定理求逆元，反推阶乘逆元，代码实现巧妙。
   - **核心代码**：
     ```cpp
     inv[maxn] = Pow(f[maxn], p - 2);
     for(int i = maxn - 1; i >= 0; i--) inv[i] = inv[i + 1] * (i + 1) % p;
     ```

3. **作者：Homework_King (赞：6)**
   - **星级：4星**
   - **关键亮点**：详细解释了预处理阶乘和逆元的过程，代码可读性强。
   - **核心代码**：
     ```cpp
     for(long long i=2;i<=NwN;i++) A[i] = A[i-1]*i%MOD;
     for(long long i=0;i<=NwN;i++){
         long long x,y;
         exgcd(A[i],MOD,x,y);
         x = (x+MOD)%MOD;
         inv[i] = x;
     }
     ```

### 最优关键思路或技巧
- **预处理阶乘和逆元**：通过预处理阶乘和逆元，将组合数的计算复杂度降低到O(1)。
- **线性求逆元**：利用线性递推公式高效计算逆元，避免重复计算。
- **费马小定理**：在模数为质数时，利用费马小定理快速计算逆元。

### 可拓展之处
- **同类型题**：类似的问题可以扩展到其他需要大量计算组合数并取模的场景，如概率计算、排列组合问题等。
- **类似算法套路**：预处理+逆元的思路可以应用于其他需要高效计算数学公式的场景，如多项式乘法、矩阵快速幂等。

### 推荐题目
1. [P3807 【模板】卢卡斯定理](https://www.luogu.com.cn/problem/P3807)
2. [P3811 【模板】乘法逆元](https://www.luogu.com.cn/problem/P3811)
3. [P1495 【模板】中国剩余定理](https://www.luogu.com.cn/problem/P1495)

---
处理用时：22.01秒
# 题目信息

# [NOIP 2009 普及组] 细胞分裂

## 题目描述

Hanks 博士是 BT（Bio-Tech，生物技术）领域的知名专家。现在，他正在为一个细胞实验做准备工作：培养细胞样本。

Hanks 博士手里现在有 $N$ 种细胞，编号从 $1 \sim N$，一个第 $i$ 种细胞经过 $1$ 秒钟可以分裂为 $S_i$ 个同种细胞（$S_i$ 为正整数）。现在他需要选取某种细胞的一个放进培养皿，让其自由分裂，进行培养。一段时间以后，再把培养皿中的所有细胞平均分入 $M$ 个试管，形成 $M$ 份样本，用于实验。Hanks 博士的试管数 $M$ 很大，普通的计算机的基本数据类型无法存储这样大的 $M$ 值，但万幸的是，$M$ 总可以表示为 $m_1$ 的 $m_2$ 次方，即 $M = m_1^{m_2}$，其中 $m_1,m_2$ 均为基本数据类型可以存储的正整数。

注意，整个实验过程中不允许分割单个细胞，比如某个时刻若培养皿中有 $4$ 个细胞，Hanks 博士可以把它们分入 $2$ 个试管，每试管内 $2$ 个，然后开始实验。但如果培养皿中有 $5$ 个细胞，博士就无法将它们均分入 $2$ 个试管。此时，博士就只能等待一段时间，让细胞们继续分裂，使得其个数可以均分，或是干脆改换另一种细胞培养。

为了能让实验尽早开始，Hanks 博士在选定一种细胞开始培养后，总是在得到的细胞“刚好可以平均分入 $M$ 个试管”时停止细胞培养并开始实验。现在博士希望知道，选择哪种细胞培养，可以使得实验的开始时间最早。


## 说明/提示

【输入输出样例 \#1 说明】

经过 $1$ 秒钟，细胞分裂成 $3$ 个，经过 $2$ 秒钟，细胞分裂成 $9$个，……，可以看出无论怎么分裂，细胞的个数都是奇数，因此永远不能分入 $2$ 个试管。

【输入输出样例 \#2 说明】

第 $1$ 种细胞最早在 $3$ 秒后才能均分入 $24$ 个试管，而第 $2$ 种最早在 $2$ 秒后就可以均分（每试管 $144 / {24}^1 = 6$ 个）。故实验最早可以在 $2$ 秒后开始。

【数据范围】

对于 $50 \%$ 的数据，有 $m_1^{m_2} \le 30000$。

对于所有的数据，有 $1 \le N \le 10000$，$1 \le m_1 \le 30000$，$1 \le m_2 \le 10000$，$1 \le S_i \le 2 \times {10}^9$。


NOIP 2009 普及组 第三题


## 样例 #1

### 输入

```
1 
2 1 
3
```

### 输出

```
-1
```

## 样例 #2

### 输入

```
2
24 1
30 12
```

### 输出

```
2
```

# AI分析结果

### 算法分类
数学

### 综合分析与结论
本题的核心是通过质因数分解和最大公约数（GCD）来求解细胞分裂的最小时间。大多数题解都采用了质因数分解的思路，通过将 \( m_1^{m_2} \) 和细胞分裂数 \( S_i \) 分解质因数，比较它们的质因数及其指数，从而计算出满足条件的最小时间 \( k \)。部分题解还引入了递归或迭代的方法来进一步优化计算过程。

### 所选题解
1. **作者：暗ざ之殇 (赞：509)**
   - **星级：5星**
   - **关键亮点：**
     - 通过递归分解质因数和最大公约数，逐步简化问题，最终转化为求解最小时间 \( k \) 的问题。
     - 详细推导了公式，并提供了清晰的代码实现。
     - 代码可读性强，逻辑清晰，优化程度高。
   - **个人心得：**
     - 作者在推导过程中多次提到“递归操作”和“最大公约数”的应用，强调了数学思维在解题中的重要性。
     - 通过详细的例子和推导，帮助读者理解每一步的数学逻辑。

2. **作者：刘心远 (赞：149)**
   - **星级：4星**
   - **关键亮点：**
     - 直接使用质因数分解的方法，通过比较 \( m_1^{m_2} \) 和 \( S_i \) 的质因数及其指数，求解最小时间 \( k \)。
     - 代码简洁明了，易于理解。
   - **个人心得：**
     - 作者强调了质因数分解的重要性，并提供了详细的代码实现，帮助读者快速掌握解题思路。

3. **作者：7KByte (赞：24)**
   - **星级：4星**
   - **关键亮点：**
     - 通过质因数分解和向上取整的方法，求解最小时间 \( k \)。
     - 代码实现简洁，逻辑清晰。
   - **个人心得：**
     - 作者在解题过程中提到“向上取整”的应用，强调了数学技巧在解题中的重要性。

### 关键代码片段
#### 作者：暗ざ之殇
```cpp
int gcd(int a,int b) {
    if(b==0) return a;
    else return gcd(b,a%b);
}

int main() {
    // ... 其他代码
    while(m!=1) {
        gcdd=gcd(m,s);
        if(gcdd==1) {flag=0;break;}
        m/=gcdd;
        q=s/gcdd;
        s=gcdd;
        t++;
    }
    // ... 其他代码
}
```
**核心实现思想：** 通过递归计算最大公约数，逐步简化问题，最终求解最小时间 \( k \)。

#### 作者：刘心远
```cpp
void getit(long long n) {
    for(int i=2;i<=n;i++) {
        if(n%i==0) {
            while(n%i==0) {
                n/=i;
                cnt[i]++;
            }
        }
    }
}
```
**核心实现思想：** 通过质因数分解，将 \( m_1 \) 分解为质因数及其指数，便于后续计算。

### 扩展思路
- **同类型题：** 类似的问题可以通过质因数分解和最大公约数来解决，如求解最小公倍数、最大公约数等问题。
- **类似算法套路：** 质因数分解、最大公约数、递归或迭代优化。

### 推荐题目
1. [P1072 Hankson 的趣味题](https://www.luogu.com.cn/problem/P1072)
2. [P1068 乌龟棋](https://www.luogu.com.cn/problem/P1068)
3. [P1073 最优贸易](https://www.luogu.com.cn/problem/P1073)

---
处理用时：32.92秒
# 题目信息

# “非常男女”计划

## 题目描述

近来，初一年的 `XXX` 小朋友致力于研究班上同学的配对问题（别想太多，仅是舞伴），通过各种推理和实验，他掌握了大量的实战经验。例如，据他观察，身高相近的人似乎比较合得来。

万圣节来临之际，`XXX` 准备在学校策划一次大型的 “非常男女” 配对活动。对于这次活动的参与者，`XXX` 有自己独特的选择方式。他希望能选择男女人数相等且身高都很接近的一些人。这种选择方式实现起来很简单。他让学校的所有人按照身高排成一排，然后从中选出连续的若干个人，使得这些人中男女人数相等。为了使活动更热闹，`XXX` 当然希望他能选出的人越多越好。请编写程序告诉他，他最多可以选出多少人来。


## 样例 #1

### 输入

```
9
0 1 0 0 0 1 1 0 0
```

### 输出

```
6```

# AI分析结果

### 算法分类
前缀和

### 综合分析与结论
该题的核心思路是通过前缀和来统计男生和女生的数量差，进而找到男女人数相等的连续子序列。大部分题解都采用了前缀和的思想，并通过哈希表或数组记录差值首次出现的位置，从而在O(n)时间内找到最长的满足条件的子序列。难点在于如何处理负数的差值，常见的解决方案是将差值加上一个偏移量（如n）来保证数组下标非负。

### 所选高分题解
#### 1. 作者：AKB48 (赞：163)
- **星级**: 5星
- **关键亮点**: 引入相对差的概念，通过记录差值首次和最后一次出现的位置，直接计算最长子序列的长度。思路清晰，代码简洁。
- **核心代码**:
  ```cpp
  int l[200010],r[200010],sum1,sum0,ans,n;
  int main() {
      cin>>n;
      for (int i=1;i<=n;i++){
          int x; cin>>x;
          sum1+=(x==1), sum0+=(x==0);
          int t=sum0-sum1+n;
          if (!l[t]&&t!=n) l[t]=i; else r[t]=i;
      }
      for (int i=0;i<=2*n;i++) ans=max(ans,r[i]-l[i]);
      cout<<ans<<endl;
      return 0;
  }
  ```

#### 2. 作者：小小二逼兽 (赞：137)
- **星级**: 4星
- **关键亮点**: 通过前缀和计算差值，并使用数组记录差值首次出现的位置，代码简洁且易于理解。
- **核心代码**:
  ```cpp
  int l[200010],r[200010],sum1,sum0,ans,n;
  int main() {
      cin>>n;
      for (int i=1;i<=n;i++){
          int x; cin>>x;
          sum1+=(x==1), sum0+=(x==0);
          int t=sum0-sum1+n;
          if (!l[t]&&t!=n) l[t]=i; else r[t]=i;
      }
      for (int i=0;i<=2*n;i++) ans=max(ans,r[i]-l[i]);
      cout<<ans<<endl;
      return 0;
  }
  ```

#### 3. 作者：KellyFrog (赞：62)
- **星级**: 4星
- **关键亮点**: 详细解释了前缀和的应用，并通过哈希表记录差值首次出现的位置，代码实现较为完整。
- **核心代码**:
  ```cpp
  for(int i = 1; i < n + 1; i++) {
     hash[sum[i]+100010]._min = min(hash[sum[i]+100010]._min, i);
     hash[sum[i]+100010]._max = i;
  }
  ```

### 最优关键思路或技巧
1. **前缀和的应用**: 通过前缀和快速计算任意区间的男女人数差。
2. **哈希表或数组记录差值首次出现的位置**: 利用哈希表或数组记录差值首次出现的位置，从而在O(n)时间内找到最长的满足条件的子序列。
3. **处理负数差值**: 通过将差值加上一个偏移量（如n）来保证数组下标非负。

### 可拓展之处
该题的思路可以拓展到其他需要统计区间内某种属性相等的题目，如统计区间内某种字符数量相等、区间内某种数字出现次数相等等。

### 推荐相似题目
1. [P1114 “非常男女”计划](https://www.luogu.org/problem/P1114)
2. [P3406 海底高铁](https://www.luogu.org/problem/P3406)
3. [P3405 [USACO16DEC]Cities and States S](https://www.luogu.org/problem/P3405)

### 个人心得摘录
- **KellyFrog**: "就这一道黄题我调了快40分钟"，提醒我们在处理负数下标时要格外小心，避免出现数组越界或访问非法内存的问题。

---
处理用时：30.32秒
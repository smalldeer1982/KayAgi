# 题目信息

# 心碎

## 题目背景

NOIP2015初赛。CYD大神在他的母校跪掉了。初赛那天，他回到原来的教室参观了一下，发现那张遍布了N个洞的课桌还摆在那里——那是他初中时和XHY同学坐过的桌子。这时，CYD大神的心都碎了。


## 题目描述

CYD大神的心可以看做一个环，内外都顺时针均匀分布了N个一一正对应的点。当他看到第i个洞时，就会想起第Ai件往事，这会在CYD大神的心上外侧第i个点和内侧第Ai个点间留下一道伤痕(i<Ai时为顺时针，i>Ai时逆时针，i=Ai时正对应)。

CYD大神觉得，他的心一定不会再碎了，所以，他想让你帮他写一个程序，确定一个Ai的排列，使得他的心碎的块数最多。


## 说明/提示

对于40%数据，前i\*10%,N<=i\*5。

对于50%数据，N<=50。

对于70%数据，N<=233。

对于100%数据，N<=2333。

/\*P.S.样例解释\*/

样例1:1->2,2->1

样例2:1->2,2->3,3->1,注意：若1->3,2->2,3->1，则三线共点。

样例3:1->3,2->4,3->2,4->1


## 样例 #1

### 输入

```
2```

### 输出

```
3```

## 样例 #2

### 输入

```
3```

### 输出

```
5```

## 样例 #3

### 输入

```
4```

### 输出

```
9```

# AI分析结果



算法分类：数学、构造

---

### 题解分析与结论
题目核心在于构造排列使得平面分割块数最大，本质是寻找最大交点数的最优排列构造。关键结论为：最大块数 = ⌊n²/2⌋ +1，通过数学规律发现与构造式证明可得到最优解。

---

### 精选题解

#### 1. MZY666（⭐⭐⭐⭐）
**关键亮点**：  
- 直接给出最终公式 `n²/2+1`，代码简洁高效（O(1)复杂度）  
- 附带标程揭示动态规划解法思路（`f[i]`表示最小损失交点数）  
- 提出核心定理"块数=交点数+n"，将问题转化为逆序对优化  

**个人心得**：  
> "标程中的动态规划解法用f[i]表示i个点时的最小损失交点数，但最终数学公式更优"

**核心代码**：
```cpp
printf("%lld", (n*n)/2+1); // 直接输出公式结果
```

#### 2. Bla_Bla（⭐⭐⭐⭐）
**关键亮点**：  
- 通过手动扩展样例发现增量规律，最终推导出三角形数关系  
- 结合OEIS验证公式的正确性（A099392数列）  
- 给出两种代码实现，展示从暴力到公式的优化路径  

**核心推导**：  
> "块数变化呈现 +2 +2 +4 +4... 的规律，最终推导出公式 floor((n² - 2n +3)/2)"

**代码片段**：
```cpp
x = n/2;
m = x*(x+1); // 利用三角形数特性计算
```

---

### 最优思路总结
**核心技巧**：  
1. **数学构造**：观察样例得出块数与n²的强关联性，直接构造公式解  
2. **交点数转化**：将平面分割问题转化为逆序对数的最大化问题  
3. **数列工具**：通过OEIS验证猜想（适用于规律题）  

**思维突破点**：  
- 发现"块数 = n + 交点数"的几何本质  
- 构造无等差数列的排列以消除三点共线导致的交点数损失  

---

### 拓展练习
1. [P1028 数的计算](https://www.luogu.com.cn/problem/P1028) - 递推规律发现  
2. [P1988 火炬](https://www.luogu.com.cn/problem/P1988) - 数学构造与进制转换  
3. [P1002 过河卒](https://www.luogu.com.cn/problem/P1002) - 组合数学与递推结合

---
处理用时：44.24秒
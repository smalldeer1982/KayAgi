# 题目信息

# WD与矩阵

## 题目背景

WD整日沉浸在矩阵中，无法自拔……

## 题目描述

WD 特别喜欢矩阵，尤其是 01 矩阵。

一天，CX 给了 WD 一个巨大的 $n$ 行 $m$ 列的 01 矩阵，WD 发现这个矩阵每行、每列的异或值都是 0。

CX 随后就问道：“WD，你知道有多少 01 矩阵每行每列异或值都是 0 吗！？”WD 当然不会这个问题，于是他来请教你。

由于答案可能很大，输出结果模 $998\,244\,353$ 的值即可。

## 说明/提示

- subtask1（11pts）：$1\le T\le 10,~1\le n,m\le 4$
- subtask2（43pts）：$1\le T\le 5,~1\le n\le 5,~1\le m\le 1,000$
- subtask3（46pts）：$1\le T\le 10^5,~1\le n,m\le 10^9$

## 样例 #1

### 输入

```
2
2 2
2 2018```

### 输出

```
2
851481696```

# AI分析结果



### 算法分类
组合数学

---

### 题解分析与结论
题目要求构造满足每行每列异或和为0的01矩阵。所有题解的核心思路是：**前(n-1)行(m-1)列的元素可自由填充，剩余元素由异或约束唯一确定**，总方案数为 $2^{(n-1)(m-1)}$。通过快速幂计算该值模998244353的结果。

---

### 精选题解（评分≥4星）

#### 1. 作者：「已注销」 (⭐⭐⭐⭐⭐)
**关键亮点**：
- 严谨的数学归纳法推导，从低维推广到高维。
- 明确证明最后一行的合法性。
- 代码简洁高效，直接快速幂计算。

**核心代码**：
```cpp
ll fpow(ll a,ll b) {
    ll ans=1;
    while(b) {
        if(b&1) ans=ans*a%mod;
        a=a*a%mod;
        b>>=1;
    }
    return ans;
}
printf("%d\n",fpow(2,(n-1)*(m-1)));
```

#### 2. 作者：shadowice1984 (⭐⭐⭐⭐)
**关键亮点**：
- 引入二进制popcount理论，证明行填充的合法性。
- 利用异或运算性质，简化问题到自由变量分析。
- 代码采用欧拉定理优化指数取模。

**个人心得**：
> "前n-1行的异或和必然有偶数个popcount，所以最后一行必然合法"

**核心代码**：
```cpp
ll po(ll a,ll p) {
    ll r=1;
    for(;p;p>>=1,a=a*a%mod)
        if(p&1)r=r*a%mod;
    return r;
}
```

#### 3. 作者：syksykCCC (⭐⭐⭐⭐)
**关键亮点**：
- 通过暴力DFS打表找规律，直观展示答案矩阵。
- 提供完整的打表代码与规律推导过程。
- 适合直觉型学习者理解问题。

**核心思路**：
> 打表发现答案呈现 $2^{(n-1)(m-1)}$ 的规律，验证后直接实现。

---

### 关键技巧总结
1. **自由度分析**：确定前(n-1)(m-1)个元素为自由变量，其余元素由约束唯一确定。
2. **快速幂优化**：使用二进制分解法快速计算大指数模数。
3. **异或性质应用**：利用异或运算的偶消性质推导填充合法性。

---

### 拓展思路
类似问题可考虑以下变体：
- 每行/列和为偶数的矩阵计数。
- 三维异或约束立方体计数。
- 带额外约束（如对角线异或）的矩阵构造。

---

### 推荐习题
1. [P1226 【模板】快速幂](https://www.luogu.com.cn/problem/P1226)  
2. [P3758 可乐（异或性质应用）](https://www.luogu.com.cn/problem/P3758)  
3. [P1313 计算系数（组合数学+快速幂）](https://www.luogu.com.cn/problem/P1313)

---
处理用时：51.66秒
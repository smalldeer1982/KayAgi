# 题目信息

# 【深基17.例5】木材仓库

## 题目描述

博艾市有一个木材仓库，里面可以存储各种长度的木材，但是保证没有两个木材的长度是相同的。作为仓库负责人，你有时候会进货，有时候会出货，因此需要维护这个库存。有不超过 100000 条的操作：

- 进货，格式`1 Length`：在仓库中放入一根长度为 Length(不超过 $10^9$) 的木材。如果已经有相同长度的木材那么输出`Already Exist`。
- 出货，格式`2 Length`：从仓库中取出长度为 Length 的木材。如果没有刚好长度的木材，取出仓库中存在的和要求长度最接近的木材。如果有多根木材符合要求，取出比较短的一根。输出取出的木材长度。如果仓库是空的，输出`Empty`。

## 样例 #1

### 输入

```
7
1 1
1 5
1 3
2 3
2 3
2 3
2 3```

### 输出

```
3
1
5
Empty
```

# AI分析结果



**算法分类**: 模拟

---

### 综合分析与结论
题目要求维护一个无重复元素的木材集合，支持快速插入、删除及查找最接近值的操作。各题解主要围绕如何高效实现以下功能展开：
1. **快速判重与插入**：利用 `set`/`map` 的自动去重和有序性。
2. **查找最接近元素**：通过 `lower_bound` 或平衡树的前驱/后继查询实现。
3. **高效删除**：利用迭代器或平衡树节点操作。

---

### 精选题解
#### 1. 作者：vegetable_king（5星）
- **关键亮点**：使用 `set` 的 `insert` 返回值直接判重，利用 `lower_bound` 快速定位最近元素，代码极简（32行）。
- **核心代码**：
  ```cpp
  if (!s.insert(t).second) cout << "Already Exist\n"; // 判重插入一行完成
  lwb = s.lower_bound(t); // 定位最近的≥t元素
  // 比较前驱和后继的距离，删除更接近的
  ```

#### 2. 作者：YuJieSong（4星）
- **关键亮点**：用 `map` 的临时插入技巧定位前后元素，避免手动处理边界。
- **核心代码**：
  ```cpp
  m[y] = 1; // 假装插入临时元素
  auto it = m.find(y); // 定位后通过迭代器找前后元素
  m.erase(y); // 删除临时元素
  ```

---

### 最优关键思路
- **STL 有序容器**：`set`/`map` 的自动排序和去重特性，结合 `lower_bound` 函数，可快速解决动态维护有序集合的问题。
- **插入判重技巧**：利用 `insert` 返回的 `pair<iterator, bool>` 直接判重，避免额外查找。
- **临时插入法**：在 `map` 中插入临时元素定位前后边界，简化逻辑。

---

### 拓展与类似问题
- **同类问题**：会议室预定（P2073）、动态中位数（P1168）、最接近值查询（P2234）。
- **推荐题目**：
  1. [P3369 普通平衡树](https://www.luogu.com.cn/problem/P3369)
  2. [P2073 送花](https://www.luogu.com.cn/problem/P2073)
  3. [P2234 [HNOI2002] 营业额统计](https://www.luogu.com.cn/problem/P2234)

---

### 题解中的个人心得
- **vegetable_king**：强调 `set` 的 `insert` 返回值可同时完成插入和判重，减少代码量。
- **YuJieSong**：通过临时插入元素简化指针操作，虽非常规但巧妙，体现对 `map` 特性的深度理解。

---
处理用时：42.04秒
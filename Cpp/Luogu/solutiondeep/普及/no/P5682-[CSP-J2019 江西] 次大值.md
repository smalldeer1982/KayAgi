# 题目信息

# [CSP-J2019 江西] 次大值

## 题目描述

Alice 有 $n$ 个正整数，数字从 $1 \sim n$ 编号，分别为 $a_1,a_2, \dots , a_n$。  
Bob 刚学习取模运算，于是便拿这 $n$ 个数进行练习，他写下了所有 

$$a_i \bmod a_j (1 \le i,j \le n \wedge i \neq j)$$  

的值，其中 $\bmod$ 表示取模运算。  

Alice 想知道所有的结果中，严格次大值是多少。将取模后得到的所有值进行去重，即相同的结果数值只保留一个，剩余数中第二大的值就称为严格次大值。

## 说明/提示

【数据范围】  
对于 $40\%$ 的数据，$1\le n,a_i \le 100$；  
对于 $70\%$ 的数据，$1\le n \le 3000$，$1\le a_i \le 10^5$；  
对于 $100\%$ 的数据，$3 \le n \le 2\times 10^5$，$1\le a_i \le 10^9$。

【样例 $1$ 解释】  
所有取模的结果为 $\{4,4,4,1,0,5,1,0,5,2,1,1\}$。  
去重后有：$\{0,1,2,4,5 \}$，结果为 $4$。

## 样例 #1

### 输入

```
4
4 5 5 6```

### 输出

```
4```

## 样例 #2

### 输入

```
4
1 1 1 1```

### 输出

```
-1```

## 样例 #3

### 输入

```
7
12 3 8 5 7 20 15```

### 输出

```
12```

# AI分析结果



**算法分类**  
数学

**题解综合分析**  
各题解普遍基于模运算性质与排序后的结构分析。核心思路是：排序去重后，次大值只能是第三大的数或最大数模次大数的结果。关键在于正确识别这两个候选值并取较大者。难点在于证明其他情况不可能产生更大的次大值。

**高星题解推荐**  
1. **installb（5星）**  
   - **亮点**：严谨的数学证明 + 简洁的代码实现。通过排序、去重后直接比较候选值，时间复杂度优化至O(n log n)。  
   - **核心代码**：  
     ```cpp
     sort(a + 1, a + 1 + n);
     n = unique(a + 1, a + 1 + n) - a - 1;
     printf("%d\n", max(a[n - 2], a[n] % a[n - 1]));
     ```

2. **Lyw_and_Segment_Tree（4星）**  
   - **亮点**：详细分情况讨论 + 代码注释清晰。特别强调特判去重后数组长度的边界条件。  
   - **核心代码**：  
     ```cpp
     sort(a + 1, a + n + 1);
     n = unique(a + 1, a + n + 1) - a - 1;
     cout << max(a[n - 2], a[n] % a[n - 1]);
     ```

3. **吾皇（4星）**  
   - **亮点**：分部分代码优化，提出暴力解法的不足，并通过数学观察优化至O(n)。  
   - **关键点**：正确指出次大值候选仅需比较aₙ₋₂和aₙ%aₙ₋₁。

**最优思路总结**  
1. **排序去重**：消除重复元素干扰，确保数值单调。  
2. **数学观察**：次大值必为 max(第三大的数, 最大数模次大数)。  
3. **边界处理**：去重后长度小于2时直接输出-1。

**拓展应用**  
- 类似问题可考虑极值的数学性质，如利用排序后相邻元素的差值、模运算的边界等。  
- 举一反三：寻找前k大值的特殊组合（如最大和次大的运算结果）。

**推荐题目**  
1. [P1102 A-B 数对](https://www.luogu.com.cn/problem/P1102)（排序+双指针）  
2. [P5657 格雷码](https://www.luogu.com.cn/problem/P5657)（位运算+数学构造）  
3. [P2678 跳石头](https://www.luogu.com.cn/problem/P2678)（二分答案+贪心）

**题解心得摘录**  
- **installb**：强调不必枚举所有情况，通过数学分析直接锁定候选值，避免O(n²)计算。  
- **qiuqiu1231**：尝试构造所有模值后发现效率低下，验证了数学优化的必要性。  
- **muyang_233**：早期未考虑aₙ%aₙ₋₁导致WA，提醒注意边界特例。

---
处理用时：53.73秒
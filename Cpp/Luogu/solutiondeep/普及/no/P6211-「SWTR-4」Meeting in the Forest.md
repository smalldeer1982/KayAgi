# 题目信息

# 「SWTR-4」Meeting in the Forest

## 题目背景

每当月圆时分，五个族群的族猫们都会聚集在小岛上，进行每月的森林大会。蒟星为了了解其它五族猫的特点，就扮成了一只独行猫来到小岛上……

## 题目描述

森林大会上有 $n$ 只猫，每只猫的武力值为 $a_i$，于是蒟星列出了下面这样一个方程：

$$x^n+\sum_{i=1}^{n}a_ix^{n-i}=0$$

- 通俗地讲，这个方程就是 $x^n+a_1x^{n-1}+a_2x^{n-2}+\cdots+a_{n-1}x+a_n=0$。

蒟星根据 TA 优（cu）秀（bi）的数学知识可以知道，这个方程在复数集内有 $n$ 个根，不妨把这 $n$ 个根设为 $x_1, x_2, ..., x_n$。

接下来蒟星想要知道森林大会上的猫的实力如何，于是列出了下面一个表达式：

$$\sum_{i=1}^{n}(b_i\times \sum_{1\le j_1 < j_2 <\cdots< j_i \le n}^{n}x_{j_1}x_{j_2}\cdots x_{j_i})$$

- $\sum_{1\le j_1 < j_2 < \cdots < j_i \le n}^{n}x_{j_1}x_{j_2}\cdots x_{j_i}$ 就是从方程的 $n$ 个根中选出 $i$ 个，求所有可能方案的 $i$ 个根的乘积之和。

但蒟星只要这个表达式对 $10^9+7$ 取模后的值就好了。

- 若答案为负数 $a$，请输出 $a + (10^9+7)$。

蒟星把这个任务交给了您，不过他已经告诉你了 $n$，$a_i$ 和 $b_i$，您能帮帮 TA 吗？

## 说明/提示

【样例 $1$ 说明】

原方程为 $x^2-2x+1=0$，此时 $x_1=x_2=1$。

表达式的值为 $x_1+x_2+x_1x_2=1+1+1=3$。

【样例 $2$ 说明】

原方程为 $x^3-3x^2+4=0$，此时 $x_1=-1,x_2=x_3=2$。

表达式的值为 

$$\begin{aligned}&2\cdot (x_1+x_2+x_3)+3\cdot(x_1x_2+x_1x_3+x_2x_3)+4\cdot x_1x_2x_3\\=\ &2\times(-1+2+2)+3\times(-2+(-2)+4)+4\times (-4)\\=\ &-10\end{aligned}$$

因为 $-10$ 为负数，所以输出 $-10+(10^9+7)=999999997$。

【数据范围与约定】

对于 $10\%$ 的数据，$n=1$。

对于另外 $20\%$ 的数据，$n=2$。

对于 $40\%$ 的数据，$n\leq 10$。

对于 $60\%$ 的数据，$n\leq 10^3$。

对于 $100\%$ 的数据，$1\leq n \le 2 \times 10^5$，$-10^9 \le a_i, b_i \le 10^9$。

【Tips】

[韦达定理](https://baike.baidu.com/item/%E9%9F%A6%E8%BE%BE%E5%AE%9A%E7%90%86/105027?fr=aladdin)也许会对你有帮助。

【Source】

[Sweet Round 04](https://www.luogu.com.cn/contest/26414)$\ \ $C

idea & std：[蒟蒻的名字](https://www.luogu.com.cn/user/147999)

## 样例 #1

### 输入

```
2
-2 1
1 1```

### 输出

```
3```

## 样例 #2

### 输入

```
3
-3 0 4
2 3 4```

### 输出

```
999999997```

# AI分析结果



**算法分类**: 数学

---

### 综合分析与结论
题目本质是运用韦达定理将多项式根的组合乘积和转换为系数关系。关键思路是通过韦达定理推导出表达式 $\sum (-1)^i a_i b_i$，最终转化为线性计算问题。所有题解均基于此思路，区别在于符号处理与取模实现。

---

### 精选题解

#### 1. Rubidium_Chloride（★★★★★）
**关键亮点**：  
- 完整推导韦达定理与方程的展开过程，逻辑清晰易懂  
- 代码使用滚动符号变量避免奇偶判断，代码简洁高效  
**核心代码**：
```cpp
int main(){
    n=read();
    for(int i=1;i<=n;i++) a[i]=read();
    for(int i=1;i<=n;i++){
        flag*=-1; // 符号滚动
        b[i]=read();
        ans += a[i]*b[i]*flag % MOD; 
    }
    printf("%lld",(ans+MOD)%MOD); 
}
```

#### 2. Aw顿顿（★★★★☆）
**关键亮点**：  
- 通过余式定理直观解释方程分解，强化数学推导  
- 代码使用位运算判断奇偶性，提升效率  
**核心代码**：
```cpp
for(int i=1;i<=n;++i){
    if(i&1) sum -= a[i]*b[i]; 
    else sum += a[i]*b[i];
    sum = (sum%MOD + MOD)%MOD;
}
```

#### 3. youngk（★★★★☆）
**亮点**：  
- 提供n次方程韦达定理的完整数学证明  
- 代码使用滚动变量p处理符号，逻辑紧凑  
**核心代码**：
```cpp
for(int i=1; i<=n; i++) {
    ans = (ans + p * b[i] * a[i]) % MOD;
    p = -p; // 符号交替
}
```

---

### 最优技巧总结
1. **符号滚动**：通过变量（如`flag`或`p`）交替反转符号，避免重复计算(-1)^i  
2. **实时取模**：每次累加后立刻取模，防止溢出  
3. **负数处理**：最终结果加上模数再取模，确保非负输出  

---

### 拓展训练
1. **P2312 解方程**（数学+多项式求根）  
2. **P1067 多项式输出**（系数处理与格式化输出）  
3. **P1495 曹冲养猪**（中国剩余定理，同余方程）

---
处理用时：77.94秒
# 题目信息

# [QkOI#R1] Quark and Equations

## 题目描述

给定 $n,m$，求有几组正整数对 $(i,j)$ 满足下列方程组：

$$
\begin{cases}
   i+j=n \\
   \lfloor\frac{i}{j}\rfloor+\lceil\frac{j}{i}\rceil=m
\end{cases}
$$

上式中，$\lfloor x\rfloor$ 表示对 $x$ 向下取整，$\lceil x\rceil$ 表示对 $x$ 向上取整。

## 说明/提示

### 样例解释

当 $n=m=2$ 时，只有 $(1,1)$ 满足条件。  
当 $n=2,m=1$ 时，无解。  
当 $n=6,m=2$ 时，只有 $(2,4),(3,3)$ 满足条件。

---

### 数据范围

**本题采用捆绑测试。**

- Subtask 1（10 pts）：$T,n,m\le 500$。
- Subtask 2（40 pts）：$T,n,m\le 5000$。
- Subtask 3（5 pts）：$m=1$。
- Subtask 4（5 pts）：$m>n$。
- Subtask 5（5 pts）：$m\in[n-1,n]$。
- Subtask 6（35 pts）：无特殊限制。

对于 $100\%$ 的数据，$1\le T\le 10^5$，$1\le n,m\le 10^{7}$。

## 样例 #1

### 输入

```
2
2 2
2 1
```

### 输出

```
1
0```

## 样例 #2

### 输入

```
1
6 2
```

### 输出

```
2
```

# AI分析结果



**算法分类**: 数学

**综合分析与结论**  
本题核心在于数学推导，将取整运算转化为不等式组，通过分情况讨论确定解的取值范围。关键是将原式拆解为 i<j 和 i≥j 两种情形，分别处理并推导对应条件，最终转化为整数区间计算。所有题解均围绕这一核心思路展开，差异主要体现在推导细节和代码实现方式上。

---

### 精选题解

#### 1. 作者：vectorwyx（⭐⭐⭐⭐⭐）  
**关键亮点**  
- 清晰分情况推导出两套不等式体系  
- 巧妙利用取整性质化简方程  
- 代码直接使用数学运算避免循环，时间复杂度 O(1)  
**核心实现**  
```cpp
x = ceil(n*1.0/(m+1)), y = ceil(n*1.0/m);
ans += y - x;
x = floor(n*1.0/(m+1)), y = floor(n*1.0/m);
ans += y - x;
```

#### 2. 作者：LCuter（⭐⭐⭐⭐）  
**关键亮点**  
- 通过打表找规律发现数值分布特征  
- 推导出简洁的数学表达式  
- 代码实现极简，仅需两次除法运算  
**核心实现**  
```cpp
ans = floor((n - 1)/m) - floor((n - 1)/(m + 1)) 
     + floor(n/m) - floor(n/(m + 1));
```

#### 3. 作者：绝顶我为峰（⭐⭐⭐）  
**关键亮点**  
- 独立推导出与标答相同的结论  
- 提供完整不等式组推导过程  
- 代码包含详细特判处理边界情况  

---

### 最优关键思路  
1. **分治策略**：将原问题拆分为 i<j 和 i≥j 两种情形  
2. **数学转换**：利用取整函数性质（如 ceil(a)=k ⇒ k-1 < a ≤k）建立不等式  
3. **区间计算**：通过上下界表达式（如 ceil(n/(m+1))）直接计算解的区间长度  

**实现技巧**  
- 使用 `ceil(n/(m+1))` 代替等价的手动取整计算  
- 通过 `floor` 和 `ceil` 的内置函数实现高效范围计算  
- 对 m=1、m≥n 等边界情况进行快速特判  

---

### 扩展思路  
同类问题可考虑：  
1. 涉及分式取整的组合条件  
2. 需要分区间讨论的整数解计数  
3. 将复杂条件转化为不等式组的数学推导  

**推荐习题**  
1. [P2261 [CQOI2007] 余数求和](https://www.luogu.com.cn/problem/P2261)  
2. [P1463 [POI2001][HAOI2007] 反素数](https://www.luogu.com.cn/problem/P1463)  
3. [P2424 约数和](https://www.luogu.com.cn/problem/P2424)  

---

### 题解心得摘录  
- vectorwyx：提到考场上花费2小时推导式子的经历，强调分情况讨论的关键性  
- do_while_true：通过打表发现解的数量与除数区间的关联，体现了从实验到理论的推导过程  
- 就皮这一下：在代码注释中强调"善用倒数"的数学技巧，展示逆向思维的重要性

---
处理用时：45.75秒
# 题目信息

# [NEERC 2015] Generators

## 题目描述

罗曼在学习线性同余发生器——最古老，也是最广为人知的伪随机数生成算法之一。线性同余发生器（LCG）以 $x_0$ 为随机种子，生成很多非负整数 $x_i$ ,它遵循以下规则：

给定非负整数 $a,b,c\space(0≤x_0<c)$ ，
$x_{i+1} = (ax_i+b)\space mod \space c$

罗曼很好奇由不同LCG产生的序列之间的关系。特别地，他有 $n$ 个不同的LCG，含有参数 $a^{(j)}, b^{(j)}, c^{(j)}\space(1≤j≤n)$。第 $j$ 个LCG会生成一个序列 $x_i^{(j)}$ 。

他希望能从每个LCG产生的序列中挑出一个数，使他们的和最大，且不被给定的 $k$ 整除。

**格式化一点来说**，他希望找到整数 $t_j \space(t_j>0,1≤j≤n)$ ，使$s=\sum\limits_{j=1}^nx_{t_j}^{(j)}$最大，且$s\not\equiv0(mod\space k)$。

## 说明/提示

时间限制：1秒

空间限制：256MB

## 样例 #1

### 输入

```
2 3
1 1 1 6
2 4 0 5
```

### 输出

```
8
4 1
```

## 样例 #2

### 输入

```
2 2
0 7 2 8
2 5 0 6
```

### 输出

```
-1
```

# AI分析结果



**算法分类**  
贪心

**综合分析**  
题目要求从各序列选数，总和最大且不被k整除。核心思路是贪心选最大，若总和模k为0，则替换某个数的选择以调整余数。关键在于确保替换后的总和减少最少且余数有效。

---

**精选题解**  

1. **Anins的题解（4星）**  
   - **关键亮点**  
     - 正确处理每个序列的循环周期，确保高效找到最大和次大值。  
     - 次大值的余数与最大值不同，避免无效替换。  
     - 替换时选择差值最小的序列，保证总和减少最少。  
   - **个人心得**  
     通过`vis`数组记录数值出现顺序，避免无限循环，同时快速确定周期。  

2. **wunaidedanjuan的题解（3星）**  
   - **潜在问题**  
     - 未明确检查次大值的余数是否与最大值不同，可能导致无效替换。  
   - **思路亮点**  
     - 动态维护最大值和次大值，减少存储开销。  

---

**最优关键思路**  
1. **生成序列最大值与次大值**：遍历序列至出现循环，记录每个数的出现位置。对于每个序列，从高到低遍历数值，记录余数与最大值不同的次大值。  
2. **总和校验与替换**：总和初始为最大值之和。若模k为0，则替换差值最小的次大值，确保余数变化。若无法替换则无解。  

**核心代码实现**  
```cpp
void Get_max(ll i) {
    q[i][0].index = q[i][1].index = q[i][0].value = q[i][1].value = -1;
    for (int j = c - 1; j >= 0; j--) {
        if (!vis[j]) continue;
        if (j >= q[i][0].value) { 
            if (j % mod != q[i][0].value % mod) q[i][1] = q[i][0];
            q[i][0].value = j, q[i][0].index = vis[j];
        } else if (j > q[i][1].value && j % mod != q[i][0].value % mod) { 
            q[i][1].value = j, q[i][1].index = vis[j];
        }
        if (q[i][0].value != -1 && q[i][1].value != -1) break;
    }
}
```

---

**拓展与相似题目**  
- **类似贪心替换策略**：  
  1. [P1090 合并果子](https://www.luogu.com.cn/problem/P1090)  
  2. [P1209 [USACO1.3]修理牛棚 Barn Repair](https://www.luogu.com.cn/problem/P1209)  
  3. [P1650 田忌赛马](https://www.luogu.com.cn/problem/P1650)

---
处理用时：89.09秒
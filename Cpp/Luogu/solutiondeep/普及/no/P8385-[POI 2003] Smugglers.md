# 题目信息

# [POI 2003] Smugglers

## 题目描述

Byteotia 因为它丰富的金矿资源而闻名世界. 所以在和它的邻国 Bitland 的边界上每年都有大量的金矿交易。不幸的是由于税务的繁重，商人带着矿产穿过边境时都要交纳矿产价格的 $50\%$ 作为关税。但是幸运的是，有一些炼金术士已经发明了一些方法能把某一种矿产转化成另一种的矿物。于是这样在交易时就可以先把昂贵的矿产转化成便宜的，等到带过边境以后在转换回来。但是由于这项工作费时费力，炼金术士对于每种转换都要收取相应的费用。现在有个商人想将 $1$ kg 金子带过边境，他想知道最少的花费是多少。

## 说明/提示

对于 $100\%$ 的数据，$1 \le n \le 5000$，$0 \le p_k \le 10^9$，$0 \le m \le 100000$，$1 \le a,b \le n$，$0 \le c \leq 10000$。

## 样例 #1

### 输入

```
4
200
100
40
2
6
1 2 10
1 3 5
2 1 25
3 2 10
3 4 5
4 1 50```

### 输出

```
60```

# AI分析结果



**算法分类**: 最短路

---

### 题解综合分析与结论
所有题解均采用分层图最短路思想，将金属的过境前后状态建模为不同层次的节点，通过合理建边将关税与转化操作转化为边权。难点在于理解题意中的分层状态转换逻辑，以及如何通过双倍节点数（2n）实现分层建模。Dijkstra 算法是统一选择，时间复杂度 O((m+n)log n) 满足数据规模。

---

### 高分题解推荐

#### 1. Soul_Love（★★★★★）
**关键亮点**：  
- 最清晰的建模思路阐述，明确将金属分为过境前后双状态  
- 代码结构简洁，包含建边逻辑注释  
- 使用标准优先队列实现 Dijkstra  

**核心代码**：
```cpp
// 关税边建立
for(int i=1;i<=n;i++) add(i,i+n,read()*0.5);
// 转化关系边建立（前后层次独立）
add(x,y,z); add(x+n,y+n,z);
```

#### 2. run_away（★★★★☆）
**关键亮点**：  
- 变量命名规范（dis数组、结构体edge）  
- 显式处理长整型数据防止溢出  
- 代码模块化（独立的add函数）

---

### 关键思路与技巧
**分层图建模**：  
- 将每个金属i分为过境前(i)和过境后(i+n)两个节点  
- 关税操作转化为i→i+n的边权（p_i/2）  
- 转化操作在同层次内建立边（前层次：i→j，后层次：i+n→j+n）

**实现优化**：  
- 统一使用链式前向星存图  
- 优先队列优化 Dijkstra 算法  
- 双倍节点空间分配（2n）

---

### 拓展方向
**同类问题**：  
- 分层图应用：如 P4568 [飞行路线]（k次免费机会）  
- 状态扩展最短路：如 P1948 [USACO08JAN] Telephone Lines  
- 双权值最短路：如 P1073 [NOIP2009 提高组] 最优贸易

---

### 推荐题目
1. P4568 [JLOI2011] 飞行路线（分层图经典）  
2. P1948 [USACO08JAN] Telephone Lines S（二分+最短路）  
3. P1073 [NOIP2009 提高组] 最优贸易（状态转移最短路）

---
处理用时：47.35秒
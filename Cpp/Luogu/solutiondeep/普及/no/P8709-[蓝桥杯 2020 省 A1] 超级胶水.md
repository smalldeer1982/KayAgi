# 题目信息

# [蓝桥杯 2020 省 A1] 超级胶水

## 题目描述

小明有 $n$ 颗石子，按顺序摆成一排，他准备用胶水将这些石子粘在一起。
 
每颗石子有自己的重量，如果将两颗石子粘在一起，将合并成一颗新的石子，重量是这两颗石子的重量之和。

为了保证石子粘贴牢固，粘贴两颗石子所需要的胶水与两颗石子的重量乘积成正比，本题不考虑物理单位，认为所需要的胶水在数值上等于两颗石子重量的乘积。

每次合并，小明只能合并位置相邻的两颗石子，并将合并出的新石子放在原来的位置。

现在，小明想用最少的胶水将所有石子粘在一起，请帮助小明计算最少需要多少胶水。

## 说明/提示

对于 $20\%$ 的评测用例，$1 \le n \le 15$。

对于 $60\%$ 的评测用例，$1\leq n \leq 100$。

对于 $80\%$ 的评测用例，$1\leq n \leq 1000$。

对于所有评测用例，$1\leq n \leq 10^5$，$1 \leq w_i \leq 1000$。

蓝桥杯 2020 第一轮省赛 A 组 I 题。

## 样例 #1

### 输入

```
3
3 4 5```

### 输出

```
47```

## 样例 #2

### 输入

```
8
1 5 2 6 3 7 4 8```

### 输出

```
546```

# AI分析结果



**算法分类**: 数学

**分析与结论**  
题目核心在于发现合并顺序不影响总胶水量，总胶水量等于所有两两石子重量乘积之和。通过数学归纳法可证明，无论合并顺序如何，最终结果均为各石子重量两两相乘的总和。因此无需动态规划或贪心策略，直接通过前缀和或累积求和即可在 $O(n)$ 时间内解决问题。

---

### 精选题解

1. **andyli（★★★★★）**  
   **关键亮点**：  
   - 通过数学归纳法证明合并顺序无关性，逻辑严谨。  
   - 代码简洁高效，采用累加与合并同步进行，时间复杂度 $O(n)$。  
   **核心代码**：  
   ```cpp
   i64 ans = 0;
   for (int i = 0; i + 1 < n; i++)
       ans += a[i] * a[i + 1], a[i + 1] += a[i];
   ```  
   **思路**：维护当前合并后的总重量，每次累加当前石子与下一石子的乘积。

2. **Ggsddu_zzy（★★★★☆）**  
   **关键亮点**：  
   - 通过模拟合并过程直接计算胶水量，代码清晰易读。  
   - 采用逐步累加前缀和的方式，避免显式存储前缀和数组。  
   **核心代码**：  
   ```cpp
   int sum = w[1];
   for (ri i = 2; i <= n; i++) {
       ans += sum * w[i];
       sum += w[i];
   }
   ```  
   **思路**：通过 `sum` 动态维护已合并石子的总重量，逐次计算当前石子与之前总重量的乘积。

3. **Zaku（★★★★☆）**  
   **关键亮点**：  
   - 显式使用前缀和数组，直观展示每个石子与后续所有石子乘积之和。  
   - 推导公式清晰，便于理解数学本质。  
   **核心代码**：  
   ```cpp
   for (int i = 1; i < n; i++)
       ans += a[i] * (s[n] - s[i]);
   ```  
   **思路**：利用前缀和数组 `s` 计算每个石子与后续所有石子总和的乘积。

---

### 最优技巧总结  
**关键思路**：  
- **数学推导**：发现总胶水量为所有两两石子重量乘积之和，与合并顺序无关。  
- **前缀和优化**：通过动态维护前缀和或显式计算前缀和，将时间复杂度降至 $O(n)$。  

**拓展应用**：  
- 类似题目：若题目要求所有元素两两组合的某种运算和，可尝试数学推导或前缀和优化。  
- 推荐题目：  
  1. [P1090 合并果子](https://www.luogu.com.cn/problem/P1090)（贪心+优先队列）  
  2. [P1631 序列合并](https://www.luogu.com.cn/problem/P1631)（数学+堆优化）  
  3. [P1966 火柴排队](https://www.luogu.com.cn/problem/P1966)（排序+逆序对）  

**个人心得**：  
- 题解中多次强调“合并顺序无关性”是突破口，遇到类似合并问题可优先尝试数学推导。  
- 前缀和的灵活使用是优化线性时间复杂度的关键技巧。

---
处理用时：53.68秒
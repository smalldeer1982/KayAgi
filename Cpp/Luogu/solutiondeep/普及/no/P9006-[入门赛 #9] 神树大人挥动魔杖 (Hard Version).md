# 题目信息

# [入门赛 #9] 神树大人挥动魔杖 (Hard Version)

## 题目背景

**本题与 Easy Version 题意完全相同，仅有 $n,k$ 的数据范围有所不同。**

## 题目描述

神树大人挥动魔杖，召唤出了 $9 \times 10^{n-1}$ 只家养小精灵。每只家养小精灵都有一个互不相同的 $n$ 位数编号 $a_i$。

神树大人希望将这些家养小精灵分为 $k$ 组。第 $p$ 组的所有家养小精灵满足编号 $a_i$ 对 $k$ 取模余 $p-1$，即 $a_i \equiv p-1 \pmod k$。

神树大人想要知道，每一组小精灵分别有多少只。由于答案可能很大，你只需要输出答案对 $100,000,007$ 取模的结果

## 说明/提示

对于 $100\%$ 的数据，$1 \le n \le 5000$，$1 \le k \le 1000$。

## 样例 #1

### 输入

```
3 10```

### 输出

```
90 90 90 90 90 90 90 90 90 90
```

# AI分析结果



### 算法分类
差分

### 题解综合分析
题目本质是求区间 $[10^{n-1}, 10^n-1]$ 内所有数的模 $k$ 余数分布。各题解主要分为递推动态规划与数学差分两种思路：

1. **递推动态规划**（览遍千秋）  
   - 定义 $f(i,j)$ 为所有 $i$ 位数中模 $k$ 余 $j$ 的数量  
   - 通过逐位枚举最高位数字，结合前缀和优化递推  
   - 时间复杂度 $O(nk)$，适合本题数据范围但非最优

2. **数学差分**（uid_310801、LEMON_dasiy 等）  
   - 利用区间差思想：答案 = $f(10^n-1) - f(10^{n-1}-1)$  
   - 通过快速幂计算大数模值，结合逆元处理除法取模  
   - 时间复杂度 $O(\log n + k)$，为最优解法

### 精选题解

#### [uid_310801] ⭐⭐⭐⭐⭐  
**关键亮点**  
- 通过快速幂计算 $10^n \bmod k$ 的余数边界  
- 使用费马小定理求逆元处理整除问题  
- 代码简洁高效，时间复杂度最优  

**核心代码**  
```cpp
ll q = (qpow(10,n-1,k)-1+k)%k;
ll p = (qpow(10,n-1,mod)-1-q+mod)*qpow(k,mod-2,mod)%mod;
// 计算前10^{n-1}-1的余数分布
for(int i=0;i<k;i++){
    ans[i] = -p;
    if(i!=0 && i<=q) ans[i]--;
}
// 同理计算10^n-1的分布后差分
```

#### [Ag2WO4] ⭐⭐⭐⭐  
**关键亮点**  
- 同时计算商数和余数，避免单独处理逆元  
- 采用 __int128 防止中间值溢出  
- 极简代码实现，Python 版思路清晰  

**核心代码**  
```c
u = v = 1;
for(i=0; i<13; i++) if(n&(1<<i)) u=u*m[i]%(k*t);
// 快速幂同时模 k*mod
p = u/k - v/k;  // 商数差即为基础计数
// 余数差处理额外计数
printf("%d", (p + (i<u) - (i<v)) % t);
```

### 最优关键技巧
- **快速幂模运算**：高效计算大数 $10^n \bmod k$  
- **区间差分思想**：将复杂区间问题转化为两个前缀和之差  
- **逆元处理除法**：当模数为质数时，利用费马小定理求逆元  

### 拓展应用
类似问题可考虑以下套路：  
1. **大范围统计** → 差分前缀和思想  
2. **循环节性质** → 快速幂计算余数边界  
3. **模数分桶计数** → 均匀分布处理边界余数  

### 推荐习题
1. [P1404](https://www.luogu.com.cn/problem/P1404) - 模运算与差分统计  
2. [P2602](https://www.luogu.com.cn/problem/P2602) - 区间数字计数（类似差分思想）  
3. [P1226](https://www.luogu.com.cn/problem/P1226) - 快速幂基础应用

---
处理用时：73.97秒
# 题目信息

# [蓝桥杯 2023 国 B] 抓娃娃

## 题目描述

小明拿了 $n$ 条线段练习抓娃娃。他将所有线段铺在数轴上，第 $i$ 条线段的左端点在 $l_i$，右端点在 $r_i$。小明用 $m$ 个区间去框这些线段，第 $i$ 个区间的范围是 $[L_i, R_i]$。如果一个线段有 **至少一半** 的长度被包含在某个区间内，则将其视为被这个区间框住。请计算出每个区间框住了多少个线段？



## 说明/提示

### 评测用例规模与约定

 - 对于 $20\%$ 的数据，保证 $n, m \le 10^3$。
 - 对于 $100\%$ 的数据，保证 $n, m ≤ 10^5$，$l_i < r_i$，$0 < l_i, r_i, L_i, R_i \le 10^6$，$\max \{r_i − l_i\} \le \min \{R_i − L_i\}$。
 
第十四届蓝桥杯大赛软件赛决赛 C/C++ 大学 B 组 H 题

## 样例 #1

### 输入

```
3 2
1 2
1 3
3 4
1 4
2 4```

### 输出

```
3
2```

# AI分析结果



### 算法分类
前缀和

### 综合分析与结论
题目核心在于将"至少覆盖线段一半长度"的条件转化为"区间必须包含线段中点"。利用题目给定的线段长度与区间长度的约束关系，可通过计算中点坐标并统计区间内中点数量来快速求解。所有题解均采用将坐标乘2消除浮点数的技巧，结合前缀和数组实现O(1)查询，时间复杂度O(n+m)。

### 精选题解
#### 1. EchoHua0402（5星）
**关键亮点**：  
- 明确点明中点判断的核心思路与坐标乘2的处理技巧  
- 代码简洁高效，直接使用数组+前缀和实现  
**核心代码**：  
```cpp
int mp[N]; // N=2e6+5
// 输入线段时标记中点（l+r）
for (int i=1;i<=n;i++) {
    cin>>l>>r;
    mp[l+r]++;
}
// 前缀和预处理
for (int i=1;i<N;i++) mp[i] += mp[i-1];
// 查询时计算区间和
cout << mp[r*2] - mp[l*2-1] << endl;
```

#### 2. Little_x_starTYJ（4星）
**关键亮点**：  
- 详细说明浮点处理原理  
- 代码风格规范，包含IO优化  
**实现亮点**：  
```cpp
sum[l + r]++; // 直接存储两倍中点坐标
sum[i] = sum[i-1] + sum[i]; // 前缀和计算
cout << sum[r<<1] - sum[(l<<1)-1]; // 位运算加速
```

#### 3. ybc2026lhy（4星）
**独特价值**：  
- 提供示意图辅助理解  
- 强调数学推导过程  
**代码要点**：  
```cpp
sum[l+r]++; // 中点坐标处理
for(int i=1;i<=200005;i++) sum[i]+=sum[i-1]; // 前缀和
cout << sum[r*2] - sum[l*2-1]; // 区间查询
```

### 关键思路总结
1. **条件转化**：利用题目约束，将覆盖条件转化为中点包含问题  
2. **坐标倍增**：通过乘2操作将浮点中点转为整数处理  
3. **前缀和优化**：O(n)预处理后实现O(1)查询  

### 拓展建议
类似问题可考虑：  
- 特征点转化（如线段端点、特定比例点）  
- 区间覆盖统计问题（如P3406 海底高铁的差分思想）  
- 离散化处理（当坐标范围极大时）

### 推荐习题
1. [P3406 海底高铁](https://www.luogu.com.cn/problem/P3406) - 差分数组应用  
2. [P1719 最大加权矩形](https://www.luogu.com.cn/problem/P1719) - 二维前缀和优化  
3. [P3138 [USACO16FEB] Load Balancing S](https://www.luogu.com.cn/problem/P3138) - 坐标离散化与中位数思想  

### 题解心得摘录
> "我就是因为这个被卡了"（EchoHua0402）  
→ 强调浮点处理是易错点，倍增技巧是解题关键  
> "注意数组大小要开两倍"（ganyu1）  
→ 提醒边界条件处理的重要性  
> "线段树虽然正确但不够优"（_SkyLine_）  
→ 不同解法对比体现算法选择的重要性

---
处理用时：113.21秒
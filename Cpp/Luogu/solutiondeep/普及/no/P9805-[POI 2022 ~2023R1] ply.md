# 题目信息

# [POI 2022 ~2023R1] ply

## 题目背景

题目译自 [POI2022~2023R1 ply](https://sio2.mimuw.edu.pl/c/oi30-1/p/ply/)。

## 题目描述

定义“合法括号串”及其深度如下：

- 空串是一个合法括号串，深度为 $0$。
- 如果 $w$ 是一个合法括号串，深度为 $h$，则 $(w)$ 也是一个合法括号串，深度为 $h+1$。
- 如果 $w_1$ 和 $w_2$ 都是合法括号串，深度分别为 $h_1$ 和 $h_2$，则 $w_1w_2$ 也是一个合法括号串，深度为 $\max(h_1,h_2)$。

定义翻转一个字符为：

- 如果当前字符为 `(`，修改为 `)`。
- 如果当前字符为 `)`，修改为 `(`。

你需要通过翻转 $s$ 当中某些字符使得深度不超过 $H$，求最小操作次数。

## 说明/提示

对于样例，可以修改为 `(()()())`，这样深度为 $2$。

子任务分配如下：

| 子任务编号 | 特殊性质 | 分值 |
| :-----------: | :-----------: | :-----------: |
| $1$ | $n \leq 20$ | $20$ |
| $2$ | $n \leq 3000$ | $40$ |
| $3$ | $n \leq 10^6$ 且 $H = h-1$ | $20$ |
| $4$ | $n \leq 10^6$ | $20$ |

注：$h$ 为输入的括号串的深度。

本题中，子任务 $0$ 为样例。

## 样例 #1

### 输入

```
8 2
(()(()))```

### 输出

```
2```

# AI分析结果



### 算法分类
**贪心**

---

### 综合分析与结论
题目要求通过最少翻转操作使得括号串深度 ≤ H。所有题解均采用贪心策略：遍历时维护当前深度，仅在深度超过 H 或出现非法状态时翻转括号，确保每次翻转都是必要且代价最小的操作。核心思路是**在线调整深度**，通过单次遍历即可完成，时间复杂度 O(n)，适用于 1e6 数据量。

---

### 高星题解推荐

#### 1. 作者：_sun_（⭐️⭐️⭐️⭐️）
**关键亮点**  
- 最简洁的贪心实现，直接维护深度变量。
- 逻辑清晰：遇到 `(` 时检查是否超限，遇到 `)` 时检查负数深度。
```cpp
if(a[i]=='(') {
    res++;
    if(res>H) ans++, res-=2; // 翻转左括号，深度-2
} else {
    res--;
    if(res<0) ans++, res+=2; // 翻转右括号，深度+2
}
```

#### 2. 作者：DFs_YYDS（⭐️⭐️⭐️⭐️）
**关键亮点**  
- 代码高度精简，巧妙利用短路逻辑。
- 内联条件判断，减少代码行数。
```cpp
if(c=='(' && ++cnt>h) ans++, cnt-=2;
if(c==')' && --cnt<0) ans++, cnt+=2;
```

#### 3. 作者：Harrylzh（⭐️⭐️⭐️⭐️）
**关键亮点**  
- 详细注释解释深度调整逻辑。
- 强调「非改不可」的两种边界条件，增强可读性。
```cpp
// 深度超限时翻转 '(' -> ')'
if(depth>h) { ans++; depth-=2; }
// 非法状态时翻转 ')' -> '('
if(depth<0) { ans++; depth+=2; }
```

---

### 最优思路总结
**贪心核心**：遍历时维护当前深度，仅在必要时翻转括号：
- `(` 导致深度 > H → 翻转为 `)`，深度减 2。
- `)` 导致深度 < 0 → 翻转为 `(`，深度加 2。
**关键技巧**：单次遍历 + 即时调整，保证每一步都是局部最优。

---

### 拓展与相似题目
1. [P1944 最长括号匹配](https://www.luogu.com.cn/problem/P1944)  
   （括号合法性验证与最长子串）
2. [P2115 [USACO14MAR]Sabotage G](https://www.luogu.com.cn/problem/P2115)  
   （前缀和与极值约束的贪心思想）
3. [P5658 括号树](https://www.luogu.com.cn/problem/P5658)  
   （树形结构上的括号深度计算）

---

### 题解心得摘录
- **DFs_YYDS**提到「样例看懂后直接写代码」，强调理解样例对设计贪心策略的重要性。
- **Melo_DDD**指出「翻转操作影响两个括号的匹配」，提醒注意深度变化的倍数关系。
- **chenhouyuan**在代码中采用「前缀和数组」视角，展示了问题转化的灵活性。

---
处理用时：62.13秒
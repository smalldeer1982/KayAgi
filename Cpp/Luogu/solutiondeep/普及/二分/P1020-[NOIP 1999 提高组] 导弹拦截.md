# 题目信息

# [NOIP 1999 提高组] 导弹拦截

## 题目描述

某国为了防御敌国的导弹袭击，发展出一种导弹拦截系统。但是这种导弹拦截系统有一个缺陷：虽然它的第一发炮弹能够到达任意的高度，但是以后每一发炮弹都不能高于前一发的高度。某天，雷达捕捉到敌国的导弹来袭。由于该系统还在试用阶段，所以只有一套系统，因此有可能不能拦截所有的导弹。

   
输入导弹依次飞来的高度，计算这套系统最多能拦截多少导弹，如果要拦截所有导弹最少要配备多少套这种导弹拦截系统。


## 说明/提示

对于前 $50\%$ 数据（NOIP 原题数据），满足导弹的个数不超过 $10^4$ 个。该部分数据总分共 $100$ 分。可使用$\mathcal O(n^2)$ 做法通过。  
对于后 $50\%$ 的数据，满足导弹的个数不超过 $10^5$ 个。该部分数据总分也为 $100$ 分。请使用 $\mathcal O(n\log n)$ 做法通过。

对于全部数据，满足导弹的高度为正整数，且不超过 $5\times 10^4$。


此外本题开启 spj，每点两问，按问给分。

NOIP1999 提高组 第一题

---

$\text{upd 2022.8.24}$：新增加一组 Hack 数据。

## 样例 #1

### 输入

```
389 207 155 300 299 170 158 65```

### 输出

```
6
2
```

# AI分析结果

### 综合分析与结论

本题的核心是求解两个问题：1. 最长不上升子序列的长度；2. 最少需要多少个不上升子序列才能覆盖整个序列。大多数题解都采用了 **Dilworth 定理**，即将第二个问题转化为求最长上升子序列的长度。优化方面，几乎所有题解都使用了 **二分查找** 和 **贪心策略** 来将时间复杂度从 $O(n^2)$ 优化到 $O(n \log n)$。

### 所选高星题解

#### 1. 题解作者：离散小波变换° (5星)
- **关键亮点**：详细解释了 **Dilworth 定理** 的应用，并通过二分查找优化了最长不上升子序列和最长上升子序列的求解。代码简洁且可读性强。
- **个人心得**：通过反证法证明了 $f_i$ 的单调性，使得二分查找的应用更加直观。
- **核心代码**：
  ```cpp
  int l=0,r=t+1; while(r-l>1){
      int m=l+(r-l)/2;
      if(F[m]>=H[i]) l=m; else r=m;
  }
  int x=l+1;  // dp[i]
  if(x>t) t=x; F[x]=H[i];
  ```
  **实现思想**：通过二分查找找到第一个小于等于当前高度的位置，更新 $dp$ 数组。

#### 2. 题解作者：STA_Morlin (4.5星)
- **关键亮点**：详细讲解了 **Dilworth 定理** 的证明过程，并通过贪心策略优化了第二问的求解。代码实现清晰，优化思路明确。
- **核心代码**：
  ```cpp
  int l=1,r=cnt; while(l<r){
      int mid=(l+r)>>1;
      if(a[mid]>=b[i]) r=mid;
      else l=mid+1;
  }
  f[l]=b[i];
  ```
  **实现思想**：通过二分查找找到第一个大于等于当前高度的位置，更新 $f$ 数组。

#### 3. 题解作者：Otue (4星)
- **关键亮点**：通过贪心策略直接求解第二问，避免了直接使用 **Dilworth 定理**，代码简洁且易于理解。
- **核心代码**：
  ```cpp
  for (int i = 1; i <= l; i++) {
      int k = 1;
      while (k <= cnt && g[k] < a[i]) k++;
      if (k > cnt) g[++cnt] = a[i];
      else g[k] = a[i];
  }
  ```
  **实现思想**：通过贪心策略找到第一个可以拦截当前导弹的系统，更新系统高度。

### 最优关键思路与技巧

1. **Dilworth 定理**：将最少的不上升子序列划分问题转化为最长上升子序列问题。
2. **二分查找优化**：通过维护单调数组，使用二分查找将时间复杂度从 $O(n^2)$ 优化到 $O(n \log n)$。
3. **贪心策略**：在求解最少系统数时，优先选择高度最小的可用系统，减少系统数量。

### 可拓展之处

- **同类型题**：类似的问题可以扩展到其他子序列问题，如最长不下降子序列、最长下降子序列等。
- **算法套路**：二分查找 + 贪心策略的组合可以广泛应用于各种子序列问题中。

### 推荐题目

1. [P1020 导弹拦截](https://www.luogu.com.cn/problem/P1020)
2. [P1091 合唱队形](https://www.luogu.com.cn/problem/P1091)
3. [P1439 【模板】最长公共子序列](https://www.luogu.com.cn/problem/P1439)

### 个人心得总结

- **调试经历**：部分题解提到在优化过程中遇到的困难，如二分查找的边界条件处理不当，导致结果错误。
- **顿悟感想**：通过 **Dilworth 定理** 将问题转化为已知的子序列问题，极大地简化了问题的求解过程。

---
处理用时：29.19秒
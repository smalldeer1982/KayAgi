# 题目信息

# [蓝桥杯 2022 国 A] 环境治理

## 题目描述

LQ 国拥有 $n$ 个城市，从 $0$ 到 $n - 1$ 编号，这 $n$ 个城市两两之间都有且仅有一条双向道路连接，这意味着任意两个城市之间都是可达的。每条道路都有一个属性 $D$，表示这条道路的灰尘度。当从一个城市 A 前往另一个城市 B 时，可能存在多条路线，每条路线的灰尘度定义为这条路线所经过的所有道路的灰尘度之和，LQ 国的人都很讨厌灰尘，所以他们总会优先选择灰尘度最小的路线。

LQ 国很看重居民的出行环境，他们用一个指标 $P$ 来衡量 LQ 国的出行环境，$P$ 定义为：

$$P=\sum \limits_{i=0}^{n-1} \sum \limits_{j=0}^{n-1} d(i,j)$$

其中 $d(i,j)$ 表示城市 $i$ 到城市 $j$ 之间灰尘度最小的路线对应的灰尘度的值。

为了改善出行环境，每个城市都要有所作为，当某个城市进行道路改善时，会将与这个城市直接相连的所有道路的灰尘度都减少 $1$，但每条道路都有一个灰尘度的下限值 $L$，当灰尘度达到道路的下限值时，无论再怎么改善，道路的灰尘度也不会再减小了。

具体的计划是这样的：

- 第 $1$ 天，$0$ 号城市对与其直接相连的道路环境进行改善；
- 第 $2$ 天，$1$ 号城市对与其直接相连的道路环境进行改善；

……
- 第 $n$ 天，$n - 1$ 号城市对与其直接相连的道路环境进行改善；
- 第 $n + 1$ 天，$0$ 号城市对与其直接相连的道路环境进行改善；
- 第 $n + 2$ 天，$1$ 号城市对与其直接相连的道路环境进行改善；

……

LQ 国想要使得 $P$ 指标满足 $P \leq Q$。请问最少要经过多少天之后，$P$ 指标可以满足 $P \leq Q$。如果在初始时就已经满足条件，则输出 $0$；如果永远不可能满足，则输出 $-1$。

## 说明/提示

**【样例说明】**

初始时的图如下所示，每条边上的数字表示这条道路的灰尘度：

![](https://cdn.luogu.com.cn/upload/image_hosting/5lz6auke.png)

此时每对顶点之间的灰尘度最小的路线对应的灰尘度为：

- $d(0, 0) = 0, d(0, 1) = 2, d(0, 2) = 3$；
- $d(1, 0) = 2, d(1, 1) = 0, d(1, 2) = 1$；
- $d(2, 0) = 3, d(2, 1) = 1, d(2, 2) = 0$。

初始时的 $P$ 指标为 $(2 + 3 + 1) \times 2 = 12$，不满足 $P \leq Q = 10$;

第一天，$0$ 号城市进行道路改善，改善后的图示如下：

![](https://cdn.luogu.com.cn/upload/image_hosting/mrhf5wx6.png)

注意到边 $(0, 2)$ 的值减小了 $1$，但 $(0, 1)$ 并没有减小，因为 $L_{0,1} = 2$ ，所以 $(0, 1)$ 的值不可以再减小了。此时每对顶点之间的灰尘度最小的路线对应的灰尘度为：

- $d(0, 0) = 0, d(0, 1) = 2, d(0, 2) = 3$，
- $d(1, 0) = 2, d(1, 1) = 0, d(1, 2) = 1$，
- $d(2, 0) = 3, d(2, 1) = 1, d(2, 2) = 0$。

此时 $P$ 仍为 $12$。

第二天，1 号城市进行道路改善，改善后的图示如下：

![](https://cdn.luogu.com.cn/upload/image_hosting/tjxis3yb.png)

此时每对顶点之间的灰尘度最小的路线对应的灰尘度为：

- $d(0, 0) = 0, d(0, 1) = 2, d(0, 2) = 2$，
- $d(1, 0) = 2, d(1, 1) = 0, d(1, 2) = 0$，
- $d(2, 0) = 2, d(2, 1) = 0, d(2, 2) = 0$。

此时的 $P$ 指标为 $(2 + 2) \times 2 = 8 < Q$，此时已经满足条件。

所以答案是 $2$。

**【评测用例规模与约定】**

- 对于 $30\%$ 的评测用例，$1 \leq n \leq 10$，$0 \leq L_{i,j} \leq D_{i,j} \leq 10$；
- 对于 $60\%$ 的评测用例，$1 \leq n \leq 50$，$0 \leq L_{i,j} \leq D_{i,j} \leq 10^5$；
- 对于所有评测用例，$1 \leq n \leq 100$，$0 \leq L_{i,j} \leq D_{i,j} \leq 10^5$，$0 \leq Q \leq 2^{31} - 1$。

蓝桥杯 2022 国赛 A 组 F 题。

## 样例 #1

### 输入

```
3 10
0 2 4
2 0 1
4 1 0
0 2 2
2 0 0
2 0 0```

### 输出

```
2
```

# AI分析结果

### 综合分析与结论

这两条题解都采用了二分法来求解最少天数，核心思路是通过二分搜索来确定满足条件的最小天数。两者都使用了Floyd算法来计算任意两点之间的最短路径，从而得到P指标。不同之处在于实现细节和代码风格。

1. **wuhan1234的题解**：
   - 使用C语言实现，代码较为简洁。
   - 通过辅助数组`tmp`来存储治理后的道路灰尘度，避免了直接修改原始数据。
   - 二分搜索的范围设定为`0`到`100000*n`，较为合理。
   - 代码可读性较好，但缺少一些注释和解释。

2. **行吟啸九州的题解**：
   - 使用C++实现，代码风格较为现代。
   - 使用了`#define`宏定义来简化代码，但可能影响可读性。
   - 二分搜索的范围设定为`0`到`inf`，较为灵活。
   - 代码结构清晰，但部分变量命名不够直观。

### 所选题解

#### 题解1：wuhan1234 (4星)
**关键亮点**：
- 代码简洁，逻辑清晰。
- 使用辅助数组`tmp`来避免直接修改原始数据，保证了数据的完整性。
- 二分搜索的范围设定合理，避免了不必要的计算。

**核心代码**：
```c
int calc(int day) {
    int tmp[105][105];
    for (int i = 0; i < n; i++)
        for (int j = 0; j < n; j++)
            tmp[i][j] = d[i][j];
    for (int i = 0; i < n; i++) {
        int val = day / n + (day % n >= i + 1 ? 1 : 0);
        for (int j = 0; j < n; j++) {
            tmp[i][j] -= val;
            if (tmp[i][j] < limit[i][j]) tmp[i][j] = limit[i][j];
            tmp[j][i] -= val;
            if (tmp[j][i] < limit[j][i]) tmp[j][i] = limit[j][i];
        }
    }
    for (int k = 0; k < n; k++)
        for (int i = 0; i < n; i++)
            for (int j = 0; j < n; j++)
                tmp[i][j] = min(tmp[i][j], tmp[i][k] + tmp[k][j]);
    int res = 0;
    for (int i = 0; i < n; i++)
        for (int j = 0; j < n; j++)
            res += tmp[i][j];
    return res;
}
```

#### 题解2：行吟啸九州 (4星)
**关键亮点**：
- 代码结构清晰，使用了宏定义简化代码。
- 二分搜索的范围设定灵活，适应性强。
- 使用了`inf`来表示最大值，避免了硬编码。

**核心代码**：
```cpp
inline int check(int x) {
    int t = x / n, P = 0;
    For(i, 1, n) For(j, 1, n) dis[i][j] = inf;
    For(i, 1, n) dis[i][i] = 0;
    For(i, 1, n) down[i] = t;
    For(i, 1, x - n * t) ++down[i];
    For(i, 1, n) For(j, 1, n) dis[i][j] = max(L[i][j], D[i][j] - down[i] - down[j]);
    For(k, 1, n) For(i, 1, n) For(j, 1, n) dis[i][j] = min(dis[i][j], dis[i][k] + dis[k][j]);
    For(i, 1, n) For(j, 1, n) P += dis[i][j];
    if (P <= Q) return 1;
    else return 0;
}
```

### 最优关键思路或技巧
- **二分搜索**：通过二分搜索来确定满足条件的最小天数，大大减少了计算量。
- **Floyd算法**：用于计算任意两点之间的最短路径，适用于稠密图。
- **辅助数组**：使用辅助数组来存储治理后的道路灰尘度，避免直接修改原始数据。

### 可拓展之处
- **其他最短路径算法**：如Dijkstra算法，适用于稀疏图。
- **动态规划**：可以尝试用动态规划来优化计算过程。

### 推荐题目
1. [P3371 【模板】单源最短路径（弱化版）](https://www.luogu.com.cn/problem/P3371)
2. [P4779 【模板】单源最短路径（标准版）](https://www.luogu.com.cn/problem/P4779)
3. [P1144 最短路计数](https://www.luogu.com.cn/problem/P1144)

---
处理用时：30.04秒
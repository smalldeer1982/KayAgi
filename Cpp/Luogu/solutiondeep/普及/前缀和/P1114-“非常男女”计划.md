# 题目信息

# “非常男女”计划

## 题目描述

近来，初一年的 `XXX` 小朋友致力于研究班上同学的配对问题（别想太多，仅是舞伴），通过各种推理和实验，他掌握了大量的实战经验。例如，据他观察，身高相近的人似乎比较合得来。

万圣节来临之际，`XXX` 准备在学校策划一次大型的 “非常男女” 配对活动。对于这次活动的参与者，`XXX` 有自己独特的选择方式。他希望能选择男女人数相等且身高都很接近的一些人。这种选择方式实现起来很简单。他让学校的所有人按照身高排成一排，然后从中选出连续的若干个人，使得这些人中男女人数相等。为了使活动更热闹，`XXX` 当然希望他能选出的人越多越好。请编写程序告诉他，他最多可以选出多少人来。


## 样例 #1

### 输入

```
9
0 1 0 0 0 1 1 0 0
```

### 输出

```
6```

# AI分析结果

### 综合分析与结论

本题的核心在于寻找一个连续子序列，使得其中男女人数相等。大多数题解采用了前缀和的思路，通过将女生标记为-1，男生标记为1，从而将问题转化为寻找前缀和相等的两个位置。优化点在于如何高效地记录和查找这些前缀和，避免O(n²)的暴力枚举。

### 所选高星题解

#### 1. **AKB48 (5星)**
- **关键亮点**：引入了“相对差”的概念，通过记录前缀和的最早和最晚出现位置，将时间复杂度优化到O(n)。思路清晰，代码简洁。
- **核心代码**：
  ```cpp
  for (int i=1;i<=n;i++){
      int x; cin>>x;
      sum1+=(x==1), sum0+=(x==0);
      int t=sum0-sum1+n;
      if (!l[t]&&t!=n) l[t]=i; else r[t]=i;
  }
  for (int i=0;i<=2*n;i++) ans=max(ans,r[i]-l[i]);
  ```
  **实现思想**：通过前缀和差值记录最早和最晚出现的位置，最后遍历所有可能的差值，找到最大区间。

#### 2. **KellyFrog (4星)**
- **关键亮点**：详细解释了前缀和的思路，并通过哈希表记录前缀和的最早出现位置，避免了负数下标的问题。代码可读性强，适合初学者理解。
- **核心代码**：
  ```cpp
  for(int i = 1; i < n + 1; i++){
     hash[sum[i]+100010]._min = min(hash[sum[i]+100010]._min, i);
     hash[sum[i]+100010]._max = i;
  }
  ```
  **实现思想**：使用哈希表记录前缀和的最早和最晚出现位置，最后遍历哈希表找到最大区间。

#### 3. **Bring (4星)**
- **关键亮点**：通过将女生标记为-1，男生标记为1，将问题转化为寻找前缀和为0的子序列。使用数组记录前缀和的最早出现位置，代码简洁高效。
- **核心代码**：
  ```cpp
  for(RI i=1;i<=n;i++)
      if(!mp[sum[i]+m])mp[sum[i]+m]=i;
  for(RI i=1;i<=n;i++)
      if(mp[sum[i]+m] and i!=mp[sum[i]+m])
          ans=std::max(ans,i-mp[sum[i]+m]);
  ```
  **实现思想**：通过数组记录前缀和的最早出现位置，最后遍历所有前缀和，找到最大区间。

### 最优关键思路或技巧
- **前缀和差值法**：将女生标记为-1，男生标记为1，通过前缀和差值记录最早和最晚出现的位置，从而高效找到男女人数相等的子序列。
- **哈希表或数组记录**：使用哈希表或数组记录前缀和的最早出现位置，避免O(n²)的暴力枚举。

### 可拓展之处
- **类似算法套路**：前缀和差值法可以应用于其他需要寻找特定条件的子序列问题，如寻找和为特定值的子序列。
- **同类型题目**：
  1. P1115 最大子段和
  2. P1631 序列合并
  3. P1886 滑动窗口

### 个人心得摘录
- **KellyFrog**：调试了近40分钟，主要问题在于负数下标的处理，最终通过加上一个足够大的数解决了问题。
- **Bring**：通过将女生标记为-1，男生标记为1，将问题转化为寻找前缀和为0的子序列，简化了问题的复杂度。

### 通用建议与扩展思路
- **负数下标处理**：在处理负数下标时，可以通过加上一个足够大的数（如n或100010）来避免数组越界。
- **前缀和的应用**：前缀和不仅适用于求和问题，还可以通过差值法解决更多复杂的子序列问题。

---
处理用时：23.31秒
# 题目信息

# [HNOI2003] 激光炸弹

## 题目描述

一种新型的激光炸弹，可以摧毁一个边长为 $m$ 的正方形内的所有目标。现在地图上有 $n$ 个目标，用整数 $x_i$ , $y_i$ 表示目标在地图上的位置，每个目标都有一个价值 $v_i$。激光炸弹的投放是通过卫星定位的，但其有一个缺点，就是其爆破范围，即那个边长为 $m$ 的边必须与 $x$ 轴，$y$ 轴平行。若目标位于爆破正方形的边上，该目标不会被摧毁。

现在你的任务是计算一颗炸弹最多能炸掉地图上总价值为多少的目标。

可能存在多个目标在同一位置上的情况。

## 说明/提示

**数据规模与约定**

- 对于 $100\%$ 的数据，保证 $1 \le n \le 10^4$，$0 \le x_i ,y_i \le 5\times 10^3$，$1 \le m \le 5\times 10^3$，$1 \le v_i < 100$。

## 样例 #1

### 输入

```
2 1
0 0 1
1 1 1
```

### 输出

```
1```

# AI分析结果

### 综合分析与结论

本题的核心是使用**二维前缀和**来快速计算任意正方形区域内的目标价值总和。通过预处理二维前缀和，可以在O(1)时间内查询任意矩形区域的和，从而在O(n²)的时间内枚举所有可能的正方形区域，找到最大价值。

大多数题解都采用了二维前缀和的思路，但在实现细节上有所不同，主要体现在以下几个方面：
1. **坐标处理**：为了避免数组越界，通常会将坐标从0开始平移为从1开始。
2. **空间优化**：部分题解通过原地修改前缀和数组来节省空间。
3. **边界处理**：有些题解特别处理了当m大于最大坐标的情况，避免越界。

### 所选高星题解

#### 1. 作者：iMya_nlgau (5星)
- **关键亮点**：
  - 详细解释了二维前缀和的推导过程，特别是容斥原理的应用。
  - 提供了两种计算二维前缀和的方法，并对比了它们的优缺点。
  - 代码清晰，注释详细，易于理解。
- **个人心得**：
  - 作者提到使用`short`类型虽然可以节省空间，但中间过程可能会溢出，因此建议使用`int`类型。
- **核心代码**：
  ```cpp
  for (int i = 1; i <= N; i ++)
      for (int j = 1; j <= N; j ++)
          s[i][j] = s[i - 1][j] + s[i][j - 1] - s[i - 1][j - 1] + s[i][j];
  ```

#### 2. 作者：do_while_true (4星)
- **关键亮点**：
  - 通过图形化解释如何将正方形的边界放在非整数位置，避免边界上的点被误判。
  - 代码简洁，直接使用二维前缀和进行求解。
- **核心代码**：
  ```cpp
  for (int i = 1; i <= 5001; i ++)
      for (int j = 1; j <= 5001; j ++)
          sum[i][j] += sum[i][j - 1] - sum[i - 1][j - 1] + sum[i - 1][j];
  ```

#### 3. 作者：lowAltitudeFlyer (4星)
- **关键亮点**：
  - 强调了空间优化，通过原地修改前缀和数组来节省空间。
  - 特别处理了当m大于最大坐标的情况，避免越界。
- **核心代码**：
  ```cpp
  for (int i = 1; i <= maxx; i ++)
      for (int j = 1; j <= maxy; j ++)
          sum[i][j] += sum[i - 1][j] + sum[i][j - 1] - sum[i - 1][j - 1];
  ```

### 最优关键思路与技巧

1. **二维前缀和**：通过预处理二维前缀和，可以在O(1)时间内查询任意矩形区域的和。
2. **坐标平移**：将坐标从0开始平移为从1开始，避免数组越界。
3. **空间优化**：通过原地修改前缀和数组，节省空间。
4. **边界处理**：特别处理当m大于最大坐标的情况，避免越界。

### 可拓展之处

- **高维前缀和**：本题的二维前缀和思想可以推广到高维前缀和，用于解决更高维度的子集和问题。
- **差分数组**：在处理区间修改问题时，差分数组是一个非常有用的工具，可以高效地进行区间加减操作。

### 推荐题目

1. **P1719 最大加权矩形**：考察二维前缀和的应用。
2. **P3406 海底高铁**：考察差分数组的应用。
3. **P2280 激光炸弹**：本题的变种，考察二维前缀和的应用。

### 个人心得总结

- **调试经历**：部分题解提到在使用`short`类型时，虽然可以节省空间，但中间过程可能会溢出，因此建议使用`int`类型。
- **踩坑教训**：在处理边界时，特别要注意当m大于最大坐标的情况，避免数组越界。

---
处理用时：24.88秒
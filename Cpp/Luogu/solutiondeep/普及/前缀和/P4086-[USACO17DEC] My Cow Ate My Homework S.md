# 题目信息

# [USACO17DEC] My Cow Ate My Homework S

## 题目描述

在你的牛历史课上，你被布置了一份相当长的作业，包含 $N$ 个问题（$3 \leq N \leq 100,000$），每个问题的得分是一个在 0 到 10,000 之间的整数。按照惯例，你的老师计划通过去掉你得分最低的一个问题，然后对剩余问题的得分取平均来给出最终成绩。不幸的是，你的宠物奶牛 Bessie 刚刚吃掉了你前 $K$ 个问题的答案！（$K$ 可能小到 1，也可能大到 $N-2$）。

经过多次解释，你的老师终于相信了你的说法，并同意按照之前的方式对剩余的未被吃掉的部分作业进行评分——即去掉得分最低的问题（或在得分相同的情况下去掉其中一个），然后对剩余问题取平均。

请输出所有能够使你获得最高可能成绩的 $K$ 值，并按升序排列。

## 说明/提示

如果 Bessie 吃掉了前两个问题，那么剩余的得分是 9、2 和 7。去掉最低分并取平均后，最终成绩为 8，这是可能的最高成绩。

## 样例 #1

### 输入

```
5
3 1 9 2 7```

### 输出

```
2```

# AI分析结果

### 综合分析与结论

本题的核心问题是在一个数组中，去掉前K个元素后，去掉剩余区间的最小值，再求剩余元素的平均值，并找到使平均值最大的K值。题解中主要采用了以下几种思路：

1. **预处理最小值与和**：通过倒序遍历数组，预处理每个区间的最小值和和，从而在O(1)时间内查询任意区间的最小值和和。
2. **前缀和与后缀和**：利用前缀和或后缀和快速计算区间和，结合预处理的最小值，快速计算平均值。
3. **线段树**：使用线段树维护区间最小值，结合前缀和，实现O(log n)的区间查询。
4. **单调栈**：利用单调栈维护区间最小值，结合前缀和，实现O(n)的线性复杂度。

### 所选高星题解

#### 题解1：作者：_jimmywang_ (5星)
**关键亮点**：
- **预处理最小值与和**：通过倒序遍历数组，预处理每个区间的最小值和和，避免了重复计算，大大优化了时间复杂度。
- **代码简洁高效**：代码实现简洁，预处理部分仅需一行代码，逻辑清晰，易于理解。

**核心代码**：
```cpp
for(int i=n;i>=2;i--){
    mn[i]=min(mn[i+1],a[i]);
    sum[i]=sum[i+1]+a[i];
    if(i!=n)avr[i]=(sum[i]-mn[i])/(double)(n-i);
}
```
**实现思想**：通过倒序遍历数组，预处理每个区间的最小值和和，最后计算每个K对应的平均值。

#### 题解2：作者：Siyuan (4星)
**关键亮点**：
- **前缀和思想**：利用前缀和快速计算区间和，结合预处理的最小值，快速计算平均值。
- **动态更新最大值**：在遍历过程中动态更新最大值，并记录对应的K值，避免了二次遍历。

**核心代码**：
```cpp
rep2(i,n-1,2){
    mins=min(mins,s[i]);
    sum+=s[i];
    if((sum-mins)/(double)(n-i)>aver){
        cnr=1;
        k[cnr]=i-1;
        aver=(sum-mins)/(double)(n-i);
    }else if((sum-mins)/(double)(n-i)==aver)
        k[++cnr]=i-1;
}
```
**实现思想**：通过倒序遍历数组，动态更新区间最小值和和，计算每个K对应的平均值，并记录最大值对应的K值。

#### 题解3：作者：Na2PtCl6 (4星)
**关键亮点**：
- **线段树维护最小值**：使用线段树维护区间最小值，结合前缀和，实现O(log n)的区间查询。
- **精度处理**：通过调整精度，避免了浮点数比较的误差。

**核心代码**：
```cpp
for(int i=1;i<=n-2;i++){
    k[i]=(double)(sum[i]-query(0,n-1,0,i,n-1));
    k[i]/=n-i-1;
    res=max(res,k[i]);
}
```
**实现思想**：通过线段树查询区间最小值，结合前缀和，计算每个K对应的平均值，并记录最大值。

### 最优关键思路与技巧

1. **预处理最小值与和**：通过倒序遍历数组，预处理每个区间的最小值和和，避免了重复计算，大大优化了时间复杂度。
2. **前缀和与后缀和**：利用前缀和或后缀和快速计算区间和，结合预处理的最小值，快速计算平均值。
3. **线段树与单调栈**：使用线段树或单调栈维护区间最小值，结合前缀和，实现高效的区间查询。

### 可拓展之处

1. **动态区间查询**：如果题目要求动态更新数组元素，可以使用线段树或树状数组来维护区间最小值和和。
2. **多维度查询**：如果题目要求多维度查询（如最大值、最小值、和等），可以使用更复杂的数据结构（如二维线段树）来维护。

### 推荐题目

1. **P3374 【模板】树状数组 1**：考察树状数组的基本操作，适合练习区间查询与更新。
2. **P3865 【模板】ST表**：考察ST表的应用，适合练习区间最值查询。
3. **P5490 【模板】扫描线**：考察扫描线算法的应用，适合练习区间覆盖与查询。

### 个人心得摘录

- **调试经历**：部分题解提到在调试过程中遇到精度问题，通过调整精度或使用`long long`避免了浮点数比较的误差。
- **顿悟感想**：部分题解提到通过预处理最小值和和，大大简化了问题的复杂度，避免了重复计算。

### 通用建议与扩展思路

对于类似的问题，建议优先考虑预处理最小值和和，结合前缀和或后缀和，快速计算区间和。如果需要动态更新，可以使用线段树或树状数组来维护区间信息。在处理浮点数时，注意精度问题，避免比较误差。

---
处理用时：30.89秒
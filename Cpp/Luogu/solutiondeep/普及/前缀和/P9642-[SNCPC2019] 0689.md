# 题目信息

# [SNCPC2019] 0689

## 题目描述

我们称一个字符串为 0689-字符串，如果这个字符串只包含数字 0、6、8 和 9。给定一个长度为 $n$ 的 0689-字符串 $s$，必须执行以下操作一次：选择 $s$ 的一个非空子串并将其旋转 180 度。

更正式地说，设 $s_i$ 为字符串 $s$ 的第 $i$ 个字符。在将从 $s_l$ 开始到 $s_r$ 结束的子串旋转180度后 ($1 \le l \le r \le n$)，字符串 $s$ 将变成长度为 $n$ 的字符串 $t$，其通过以下公式得到，其中 $t_i$ 表示字符串 $t$ 中的第 $i$ 个字符：

$$t_i = \begin{cases}
s_i & \text{if } 1 \le i < l \text{ or } r < i \le n \\
\text{`0'} & \text{if } l \le i \le r \text{ and } s_{l+r-i} = \text{`0'} \\
\text{`6'} & \text{if } l \le i \le r \text{ and } s_{l+r-i} = \text{`9'} \\
\text{`8'} & \text{if } l \le i \le r \text{ and } s_{l+r-i} = \text{`8'} \\
\text{`9'} & \text{if } l \le i \le r \text{ and } s_{l+r-i} = \text{`6'} \\
\end{cases}$$

经过这个操作后，可以得到多少个不同的字符串？

## 样例 #1

### 输入

```
2
0689
08```

### 输出

```
8
2```

# AI分析结果

### 综合分析与结论

本题的核心在于通过翻转子串生成不同的字符串，并计算可能的唯一字符串数量。大多数题解采用了“正难则反”的思路，即先计算所有可能的子串翻转情况，再减去那些翻转后与原串相同的情况。具体来说，翻转后与原串相同的情况主要包括：
1. 子串首尾均为 `0` 或 `8`。
2. 子串首尾为 `6` 和 `9` 或 `9` 和 `6`。

此外，还需特判全为 `6` 或全为 `9` 的情况，因为翻转后无法得到原串。

### 所选高星题解

#### 1. 作者：awesomegordon (5星)
- **关键亮点**：思路清晰，代码简洁，直接通过统计字符数量计算不合法子串数，避免了复杂的模拟操作。
- **个人心得**：通过统计字符数量，避免了复杂的子串翻转模拟，大大简化了问题。
- **核心代码**：
```cpp
ll tsum=0;
tsum+=sum1*(sum1+1)/2; // 0的情况
tsum+=sum3*(sum3+1)/2; // 8的情况
tsum+=sum2*sum4; // 6和9的情况
if(sum2==l||sum4==l) tsum++; // 特判全6或全9
cout<<(l+1)*l/2-tsum+1<<"\n";
```

#### 2. 作者：1234567890sjx (4星)
- **关键亮点**：思路与awesomegordon类似，但更详细地解释了不合法子串的计算方法，代码可读性较好。
- **核心代码**：
```cpp
type-=(cnt[0]*(cnt[0]+1)/2);
type-=(cnt[8]*(cnt[8]+1)/2);
type-=(cnt[6]*cnt[9]);
if(cnt[6]==len||cnt[9]==len) type--;
```

#### 3. 作者：isletfall (4星)
- **关键亮点**：详细解释了容斥原理的应用，代码结构清晰，逻辑严谨。
- **核心代码**：
```cpp
ans-=(x+1)*x/2; // 0的情况
ans-=(y+1)*y/2; // 8的情况
ans-=z*w; // 6和9的情况
if(z==len||w==len) ans--; // 特判全6或全9
```

### 最优关键思路与技巧

1. **正难则反**：通过计算所有可能的子串翻转情况，再减去不合法的情况，简化了问题。
2. **字符统计**：通过统计字符数量，避免了复杂的子串翻转模拟，提高了效率。
3. **特判处理**：对于全为 `6` 或全为 `9` 的情况进行特判，确保答案的准确性。

### 可拓展之处

- **类似问题**：可以扩展到其他字符翻转问题，如包含更多字符或更复杂的翻转规则。
- **算法套路**：容斥原理在计数问题中非常常见，可以应用于其他类似的计数问题。

### 推荐题目

1. [P1042 乒乓球](https://www.luogu.com.cn/problem/P1042) - 涉及字符串处理与计数。
2. [P1055 ISBN号码](https://www.luogu.com.cn/problem/P1055) - 字符串处理与校验。
3. [P1068 分数线划定](https://www.luogu.com.cn/problem/P1068) - 统计与排序问题。

### 个人心得总结

- **调试经历**：部分题解提到在调试过程中发现全为 `6` 或全为 `9` 的情况需要特判，否则会导致答案错误。
- **顿悟感想**：通过统计字符数量，避免了复杂的子串翻转模拟，大大简化了问题，体现了“正难则反”的思维方式。

---
处理用时：22.54秒
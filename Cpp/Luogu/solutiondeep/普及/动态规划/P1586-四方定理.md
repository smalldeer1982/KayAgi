# 题目信息

# 四方定理

## 题目描述

四方定理是众所周知的：任意一个正整数$n$，可以分解为不超过四个整数的平方和。例如：$25=1^{2}+2^{2}+2^{2}+4^{2}$，当然还有其他的分解方案，$25=4^{2}+3^{2}$和$25=5^{2}$。给定的正整数$n$，编程统计它能分解的方案总数。注意：$25=4^{2}+3^{2}$和$25=3^{2}+4^{2}$视为一种方案。


## 样例 #1

### 输入

```
1
2003```

### 输出

```
48```

# AI分析结果

### 综合分析与结论

本题的核心是通过动态规划或暴力枚举的方式，统计一个正整数可以分解为不超过四个整数平方和的方案数。大多数题解采用了动态规划的思路，定义 `dp[i][j]` 表示用 `j` 个平方数组成 `i` 的方案数，并通过完全背包的思想进行状态转移。部分题解还采用了暴力枚举的方法，虽然时间复杂度较高，但在数据范围较小的情况下依然可行。

### 所选高星题解

#### 1. 作者：pigstd (5星)
**关键亮点**：
- 使用了动态规划的思路，定义了 `dp[i][j]` 表示用 `j` 个平方数组成 `i` 的方案数。
- 通过完全背包的思想进行状态转移，代码简洁且易于理解。
- 预处理了所有可能的平方数，避免了重复计算。

**核心代码**：
```cpp
for (int i=1;i*i<=M;i++)
    for (int j=i*i;j<=M;j++)
        for (int sum=1;sum<=4;sum++)
            dp[j][sum]+=dp[j-i*i][sum-1];
```
**个人心得**：
- 强调了 `dp[0][0]` 的初始化，避免全输出0的问题。

#### 2. 作者：HoshiuZ (4星)
**关键亮点**：
- 同样采用了动态规划的思路，但更详细地解释了二维费用的背包问题。
- 预处理了所有可能的平方数，并直接求出到 `n_max` 的所有 `f` 数组的值，减少了重复计算。

**核心代码**：
```cpp
for(int i=1;i<=sqrt(32768);i++)
    for(int j=i*i;j<=32768;j++)
        for(int k=1;k<=4;k++)
            dp[j][k]+=dp[j-i*i][k-1];
```
**个人心得**：
- 强调了不必求 `t` 次，直接预处理所有可能的 `f` 数组值，提高了效率。

#### 3. 作者：Dream_It_Possible (4星)
**关键亮点**：
- 采用了暴力枚举的方法，但通过剪枝优化了时间复杂度。
- 预处理了所有可能的平方数，并通过剪枝减少了不必要的计算。

**核心代码**：
```cpp
for (i=0;i<=181;i++)
    for (j=i;j<=181;j++)
        for (k=j;k<=181;k++)
            for (l=k;l<=181;l++)
                if (f[i]+f[j]+f[k]+f[l]<=mxa)
                    dp[f[i]+f[j]+f[k]+f[l]]++;
```
**个人心得**：
- 强调了剪枝的重要性，通过剪枝将运行时间从1540ms优化到704ms。

### 最优关键思路或技巧

- **动态规划**：定义 `dp[i][j]` 表示用 `j` 个平方数组成 `i` 的方案数，通过完全背包的思想进行状态转移。
- **预处理**：预处理所有可能的平方数，避免重复计算。
- **剪枝优化**：在暴力枚举中，通过剪枝减少不必要的计算，提高效率。

### 可拓展之处

- **类似算法套路**：类似的问题可以扩展到其他类型的分解问题，如分解为立方数、斐波那契数等。
- **背包问题**：本题可以看作是二维费用的完全背包问题，类似的背包问题可以通过增加维度来解决。

### 推荐相似题目

1. [P1616 疯狂的采药](https://www.luogu.org/problemnew/show/P1616) - 完全背包问题
2. [P1048 采药](https://www.luogu.org/problemnew/show/P1048) - 01背包问题
3. [P1060 开心的金明](https://www.luogu.org/problemnew/show/P1060) - 背包问题

### 个人心得总结

- **初始化的重要性**：在动态规划中，初始化的值对结果有重要影响，如 `dp[0][0]` 的初始化。
- **剪枝的威力**：在暴力枚举中，通过剪枝可以显著减少计算量，提高程序效率。
- **预处理的价值**：预处理可以减少重复计算，提高程序的整体性能。

---
处理用时：26.97秒
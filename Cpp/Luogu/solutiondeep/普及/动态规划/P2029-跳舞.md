# 题目信息

# 跳舞

## 题目描述

小明今天得到一个跳舞毯游戏程序 Dance。游戏每次连续出 $N$ 个移动的“箭头”，箭头依次标号为 $1$ 到 $N$，并且得到相应的分数 $S _ 1, S _ 2, \ldots, S _ n$。如果你能“踏中”第 $i$ 号箭头，你将获得相应的分数 $S_i$；否则将被扣除相应的分数。

另外，游戏还有一个累计奖励机制：如果踏准次数累计达到 $T$，并且是在踏中第 $i$ 个箭头达到的，则将得到 $B_i$ 的奖励分数,累计也将清零，重新开始。

例如：$N=6,T=3$，相应的序列 $S$ 和 $B$ 分别为 $\{1,2,3,4,5,6\}$、$\{0,0,4,7,9,10\}$，如果小明踏中所有箭头，则得分为：$(1+2+3+4)+(4+5+6+10)=35$。

小明是个 Dance 高手，可以踏中他想踏中的任意一个箭头。但他发现，根据给定的 $N,T,S,B$，踏中所有的箭头不一定能得最高分，小明很想知道最高能得多少分，你能帮助小明计算一下最多可得多少分吗？


## 说明/提示


【样例解释】

跳过第一个，扣 $1$ 分，连踩 $3$ 个，得 $9$ 分，并获得附加分 $20$ 分，之后再连踩 $2$ 个，共 $39$ 分。

【数据范围】

对于 $20\%$ 的数据 $0\le N,T\le100$；

对于 $100\%$ 的数据 $0\le N,T\le 5000$；

序列 $S$ 和 $B$ 各有 $N$ 个数，所有分数为 $[0,10000]$ 之间的整数。

## 样例 #1

### 输入

```
6 3
1 2 3 4 5 6
1 1 1 20 1 1```

### 输出

```
39```

# AI分析结果

### 综合分析与结论

本题的核心是通过动态规划（DP）来求解在跳舞毯游戏中如何选择踏中箭头以获得最大分数。题解中大多数作者都采用了二维DP的思路，状态定义为 `f[i][j]`，表示在第 `i` 个箭头时，已经踏中了 `j` 次的最大得分。难点在于如何处理累计奖励机制，即当踏中次数达到 `T` 时，如何正确计算奖励分数。

大多数题解通过分类讨论（踏中或不踏中）来更新状态，并在踏中次数达到 `T` 时额外加上奖励分数。部分题解还提到了滚动数组优化，以减少空间复杂度。

### 所选高星题解

#### 1. 作者：Dispwnl (5星)
**关键亮点**：
- 状态转移方程清晰，分类讨论踏中与不踏中的情况，并在踏中次数达到 `T` 时正确处理奖励分数。
- 代码简洁，可读性强，初始化部分处理得当。

**核心代码**：
```cpp
for(int i=1;i<=n;i++)
  for(int j=1;j<=i;j++) {
      f[i][j]=max(f[i-1][j]-s[i],f[i-1][j-1]+s[i]);
      if(j%t==0) f[i][j]=max(f[i-1][j]-s[i],f[i-1][j-1]+s[i]+b[i]);
  }
```

#### 2. 作者：Tyyyyyy (4星)
**关键亮点**：
- 详细解释了DP状态的定义和转移方程，适合初学者理解。
- 提供了暴力搜索的思路，虽然效率低，但有助于理解问题本质。

**核心代码**：
```cpp
for(int i=1;i<=n;i++) {
    for(int j=1;j<=i;j++) {
        dp[i][j]=max(dp[i-1][j]-s[i],dp[i-1][j-1]+s[i]);
        if(j%t==0) dp[i][j]=max(dp[i-1][j]-s[i],dp[i-1][j-1]+s[i]+b[i]);
    }
}
```

#### 3. 作者：grass8cow (4星)
**关键亮点**：
- 使用滚动数组优化空间复杂度，适合处理大规模数据。
- 状态转移方程简洁，处理奖励分数的逻辑清晰。

**核心代码**：
```cpp
for(int i=1;i<=n;i++)
  for(int j=i;j>=0;j--)
      f[j]=max(f[j]-a[i],j?(f[j-1]+a[i]+(j%t?0:b[i])):-210000000);
```

### 最优关键思路与技巧
1. **状态定义**：使用 `f[i][j]` 表示在第 `i` 个箭头时，已经踏中 `j` 次的最大得分。
2. **状态转移**：分类讨论踏中与不踏中的情况，并在踏中次数达到 `T` 时正确处理奖励分数。
3. **滚动数组优化**：通过倒序遍历减少空间复杂度，适用于大规模数据。

### 可拓展之处
- **类似问题**：可以扩展到其他带有累计奖励机制的DP问题，如游戏中的连击奖励、任务完成奖励等。
- **优化思路**：在处理大规模数据时，滚动数组是常见的优化手段，可以进一步学习其他空间优化技巧。

### 推荐题目
1. [P1048 采药](https://www.luogu.com.cn/problem/P1048) - 经典背包问题，与本题的DP思路类似。
2. [P1060 开心的金明](https://www.luogu.com.cn/problem/P1060) - 带有条件的DP问题，适合练习状态转移方程的构建。
3. [P1541 乌龟棋](https://www.luogu.com.cn/problem/P1541) - 多维DP问题，适合进一步理解复杂状态的定义与转移。

### 个人心得总结
- **调试经历**：部分作者提到在初始化时遇到问题，提醒我们在DP问题中初始化的重要性。
- **踩坑教训**：在处理奖励分数时，避免重复计算是关键，部分作者通过条件判断避免了这一问题。

---
处理用时：28.49秒
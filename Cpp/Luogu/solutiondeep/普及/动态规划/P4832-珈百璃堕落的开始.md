# 题目信息

# 珈百璃堕落的开始

## 题目背景


“恭喜你，珈百璃，你以学年首席的优秀成绩毕业。”

珈百璃，一位优秀的天使，今天她以学年首席的成绩毕业，从今往后，她将前往人间进行进一步修炼。

“我会努力给人类带来幸福的！”珈百璃憧憬着人间生活。

开学第一天，珈百璃就凭借着她极其可爱的外表，受到了班级成员的追捧，不仅长得可爱，成绩还很优秀，简直就是女神啊！

因为她的成绩优秀，所以她的作业也是很快就快要完成了，但是就在她快完成数学作业时，她的电脑传来了呼救的声音。

“救命啊！”

顺着这个呼救声，珈百璃望向了电脑。

“原来是游戏啊。”珈百璃看着屏幕里一位倒在地上的残血战士，注册了账号，选择了牧师职业，对这位战士进行了救治。在珈百璃开心的同时，越来越多的呼救声传来，珈百璃一个一个进行救治，但她的 level 才 1，mp 肯定不足，当她想要继续进行救治的时候，系统提示 mp 不足，并给出了氪金的提示：“屠龙宝刀，点击就送。”

“生活费天界学院倒是有给，但是……”珈百璃看着自己的存折，再看看屏幕，她纠结不已。

“救命啊！”“救……救命啊……”“救命啊！”珈百璃看着这些人一个个喊出救命，自己却无能为力，终于，她控制不住自己，点下了“氪金”按钮。

从此，珈百璃的堕落就开始了，她的作业，也停在了这道数学题上……

“薇奈特，帮我写一下作业嘛。”珈百璃央求着薇奈特。

“真是的，你好歹也是天使呢，也该自己做一点作业吧。”

“不要，我还要打游戏呢。”

“这怎么行，你是天使啊。”

“我已经决定做一位成天打游戏不学习的堕天使了。”

“真是服了你啊，那你好好打游戏吧，我帮你写。”


## 题目描述

这道题是这样的：给定一些 $\sin^2x$，$\cos^2x\ \left(x=\dfrac{\pi}{7}\right)$ 组成的式子，请你帮忙求出选择一些式子相加后得到的**最大整数答案**。

## 说明/提示

### 样例解释

三个式子都选，则加起来等于 $3$。

### 数据范围

设 `s` 和 `c` 的个数总和为 $m$。

$10\%$ 的数据 $n=1$。

另外 $20\%$ 的数据每行一个单项式。

另有 $20\%$ 的数据 $n\le20$。

$100\%$ 的数据 $n\times m\le5\times10^7,m\le10^6$。

### 提示

 - $\forall x, \sin^2x+\cos^2x=1$。

## 样例 #1

### 输入

```
3
s+c
s+c+s
c
```

### 输出

```
3```

# AI分析结果

### 综合分析与结论

本题的核心在于利用背包问题的思想，将每个式子中的 `s` 和 `c` 的数量差作为“体积”，`s` 或 `c` 的数量作为“价值”，最终目标是找到“体积”为 0 时的最大“价值”。由于 `sin^2x + cos^2x = 1`，因此只有当 `s` 和 `c` 的数量相等时，才能得到整数结果。

大多数题解都采用了类似的思路，但在实现细节上有所不同，主要体现在如何处理负数体积、优化空间复杂度、以及滚动数组的使用上。部分题解在代码可读性和优化程度上表现较好，而有些题解则显得较为冗长或不够清晰。

### 所选高质量题解

#### 1. 作者：zhyh (★★★★★)
**关键亮点：**
- 使用了滚动数组优化空间复杂度，避免了二维数组的开销。
- 通过平移下标处理负数体积，代码简洁且高效。
- 代码可读性强，注释清晰，便于理解。

**核心代码：**
```cpp
for (register int j=l; j<=r; j++) {
    dp[i&1][j+T] = max(dp[i&1][j+T], dp[i&1^1][j+T]);
    dp[i&1][j+T] = max(dp[i&1][j+T], dp[i&1^1][j-v+T]+w);
}
```
**实现思想：** 通过滚动数组和下标平移，解决了负数体积的问题，同时保持了代码的简洁性。

#### 2. 作者：Yaha (★★★★☆)
**关键亮点：**
- 明确解释了背包问题的建模过程，思路清晰。
- 使用滚动数组优化空间，代码结构合理。
- 通过平移下标处理负数体积，代码简洁。

**核心代码：**
```cpp
for(int j=l+D;j<=r+D;j++)
    f[j]=max(f[j],max(g[j],g[j-w]+v));
```
**实现思想：** 通过滚动数组和下标平移，解决了负数体积的问题，代码结构清晰，易于理解。

#### 3. 作者：mlvx (★★★★☆)
**关键亮点：**
- 通过分情况讨论处理正负体积，优化了背包的遍历顺序。
- 代码简洁且高效，适合大规模数据处理。
- 注释清晰，便于理解。

**核心代码：**
```cpp
if(v<=0)for(int j=l+M;j<=r+M;j++)dp[j]=max(dp[j],dp[j-v]+s);
if(v>0)for(int j=r+M;j>=l+M;j--)dp[j]=max(dp[j],dp[j-v]+s);
```
**实现思想：** 根据体积的正负分别进行正序和倒序遍历，优化了背包的更新顺序，代码简洁高效。

### 最优关键思路与技巧

1. **背包问题的建模：** 将 `s` 和 `c` 的数量差作为“体积”，`s` 或 `c` 的数量作为“价值”，最终目标是找到“体积”为 0 时的最大“价值”。
2. **负数体积的处理：** 通过平移下标的方式，将负数体积转化为正数，避免数组下标越界。
3. **滚动数组优化：** 使用滚动数组减少空间复杂度，避免二维数组的开销。
4. **分情况讨论：** 根据体积的正负分别进行正序和倒序遍历，优化背包的更新顺序。

### 可拓展之处

- **类似问题：** 类似的问题可以出现在其他需要将多个变量进行组合，并且需要满足某种条件（如相等、和为定值等）的题目中。例如，某些组合优化问题、资源分配问题等。
- **算法套路：** 背包问题的变种，尤其是涉及负数体积或需要优化空间复杂度的情况，可以通过类似的思路进行解决。

### 推荐题目

1. **P1048 采药** - 经典的01背包问题，适合练习背包问题的基本思路。
2. **P1064 金明的预算方案** - 背包问题的变种，涉及分组背包的思想。
3. **P2079 小A的礼物** - 涉及负数体积的背包问题，与本题思路相似。

### 个人心得总结

- **调试经历：** 部分题解提到在处理负数体积时遇到了数组下标越界的问题，通过平移下标解决了这一问题。
- **踩坑教训：** 在优化空间复杂度时，滚动数组的使用需要注意更新顺序，避免覆盖未使用的数据。
- **顿悟感想：** 通过将问题转化为背包问题，能够更清晰地理解题目的本质，从而找到高效的解决方案。

---
处理用时：33.68秒
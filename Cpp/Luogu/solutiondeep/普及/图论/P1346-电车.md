# 题目信息

# 电车

## 题目描述

在一个神奇的小镇上有着一个特别的电车网络，它由一些路口和轨道组成，每个路口都连接着若干个轨道，每个轨道都通向一个路口（不排除有的观光轨道转一圈后返回路口的可能）。在每个路口，都有一个开关决定着出去的轨道，每个开关都有一个默认的状态，每辆电车行驶到路口之后，只能从开关所指向的轨道出去，如果电车司机想走另一个轨道，他就必须下车切换开关的状态。

为了行驶向目标地点，电车司机不得不经常下车来切换开关，于是，他们想请你写一个程序，计算一辆从路口 $A$ 到路口 $B$ 最少需要下车切换几次开关。


## 样例 #1

### 输入

```
3 2 1
2 2 3
2 3 1
2 1 2```

### 输出

```
0```

# AI分析结果

### 综合分析与结论
本题核心是将电车网络问题转化为图的最短路问题。各题解思路均是把路口看作点，轨道看作边，默认轨道边权为 0，非默认轨道边权为 1，然后运用不同最短路算法求解。

### 所选题解
- **作者：囧人232（5星）**
    - **关键亮点**：思路清晰，详细阐述建图方法，点明边的单向性细节，代码简洁且注释清晰。
    - **核心代码**：
```cpp
for(int i=1;i<=n;i++){
    scanf("%d",&k);
    for(int j=1;j<=k;j++){
        int a;
        scanf("%d",&a);
        if(j==1)g[i][a]=0;
        else g[i][a]=1;
    }
}
for(int k=1;k<=n;k++)
    for(int i=1;i<=n;i++)
        for(int j=1;j<=n;j++)
            g[i][j]=min(g[i][j],g[i][k]+g[k][j]);
```
    - **核心思想**：先按规则建图，再用 Floyd 算法求最短路。
- **作者：YellowBean_Elsa（4星）**
    - **关键亮点**：采用双端队列广搜，对 BFS 进行优化，维护队列单调性，复杂度低。
    - **核心代码**：
```cpp
while(q.size()){
    int x=q.front();q.pop_front();
    if(vis[x])continue;
    vis[x]=1;
    if(x==t){
        printf("%d\n",dis[t]);
        return 0;
    }
    for(int i=1;i<=k[x];i++){
        int y=e[x][i];
        if(!k[y])continue;
        if(i==1){
            dis[y]=min(dis[y],dis[x]);
            if(!vis[y])q.push_front(y);
        }
        else{
            dis[y]=min(dis[y],dis[x]+1);
            if(!vis[y])q.push_back(y);
        }
    }
}
```
    - **核心思想**：通过双端队列 BFS，根据边权 0 或 1 决定节点插入队头或队尾。
- **作者：callG（4星）**
    - **关键亮点**：介绍 01BFS 算法，复杂度为 $O(n)$，并给出详细实现。
    - **核心代码**：
```cpp
while (!q.empty())
{
    int x = q.front();
    q.pop_front();
    for (int to, i = head[x]; i; i = e[i].next)
    {
        if (dis[to = e[i].to] <= dis[x] + e[i].len) continue;
        dis[to] = dis[x] + e[i].len;
        if (e[i].len)
            q.push_back(to);
        else
            q.push_front(to);
    }
}
```
    - **核心思想**：利用 01BFS，边权为 0 节点入队头，边权为 1 节点入队尾。

### 最优关键思路或技巧
- **建图技巧**：将默认轨道边权设为 0，非默认轨道边权设为 1，把实际问题转化为图的最短路问题。
- **算法优化**：对于边权仅为 0 和 1 的图，可使用双端队列 BFS 或 01BFS 优化，复杂度低。

### 可拓展之处
同类型题如洛谷上的奇怪的电梯，可将楼层看作点，电梯按钮操作看作边，不同操作对应不同边权，用类似最短路算法求解。

### 推荐题目
- P1144 最短路计数
- P3371 单源最短路径（弱化版）
- P4779 单源最短路径（标准版）

### 个人心得摘录与总结
- **作者：耗纸大大**：建边时第一个点与原点构图权值为 0，后面点为 1；注意是有向图，前向星存图开值是边数。
- **作者：QWsin**：理解题意很重要，一开始对题意理解有误导致部分测试点错误，换算法后解决问题。 

---
处理用时：30.57秒
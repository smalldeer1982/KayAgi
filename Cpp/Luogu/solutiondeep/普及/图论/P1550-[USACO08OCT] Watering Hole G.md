# 题目信息

# [USACO08OCT] Watering Hole G

## 题目描述

Farmer John 的农场缺水了。

他决定将水引入到他的 $n$ 个农场。他准备通过挖若干井，并在各块田中修筑水道来连通各块田地以供水。在第 $i$ 号田中挖一口井需要花费 $W_i$ 元。连接 $i$ 号田与 $j$ 号田需要 $P_{i,j}$（$P_{j,i}=P_{i,j}$）元。

请求出 FJ 需要为使所有农场都与有水的农场相连或拥有水井所需要的最少钱数。

## 说明/提示

对于 $100\%$ 的数据，$1 \leq n \leq 300$，$1 \leq W_i \leq 10^5$，$0 \leq P_{i,j} \leq 10^5$。

## 样例 #1

### 输入

```
4
5
4
4
3
0 2 2 2
2 0 3 3
2 3 0 4
2 3 4 0```

### 输出

```
9```

# AI分析结果

### 综合分析与结论
本题的核心是让所有农场都与有水的农场相连或拥有水井，求最小花费。多数题解将打井操作转化为与一个新增虚拟点（水源）连边，把问题转化为最小生成树问题，使用Kruskal或Prim算法求解。少数题解采用贪心等其他思路。

### 所选题解
- **作者：Mr_QwQ（5星）**
    - **关键亮点**：思路清晰，详细解释了新增虚拟点的意义，代码注释详细，对优先队列排序的注意点有提醒。
    - **个人心得**：提醒用C++ STL优先队列时注意排序方向，自己曾被此坑。
    - **核心代码**：
```cpp
struct edge{
    int from,to,len;
    const bool operator < (edge b) const{
        return this->len>b.len;
    }
}e[100000];
priority_queue <edge> que;
//...
n++;
for(int i=1;i<n;i++){
    que.push((edge){i,n,w[i]});
    que.push((edge){n,i,w[i]});
}
```
核心思想：定义边结构体和优先队列，新增一个点`n+1`，将每个点与`n+1`连边，边权为打井费用，然后跑最小生成树。

- **作者：汪鸣谦（4星）**
    - **关键亮点**：思路阐述详细，先分析错误思路，再引出正确思路，代码结构清晰。
    - **个人心得**：一开始只想到50分做法，看题解后理解透彻再写题解提升能力。
    - **核心代码**：
```cpp
struct es{
    int from,to,value;
}a[100001];
//...
for(int i=1;i<=n;i++){
    adde(i,n+1,w[i]);
    adde(n+1,i,w[i]);
}
sort(a+1,a+te+1,cmp);
```
核心思想：定义边结构体，新增点`n+1`，将每个点与`n+1`连边，边权为打井费用，对边排序后跑最小生成树。

- **作者：雪颜（4星）**
    - **关键亮点**：思路简洁，直接点明将打井看作与0连接，代码简洁易懂。
    - **核心代码**：
```cpp
for(i=1;i<=n;i++){
    int x;
    scanf("%d",&x);
    a[++t].num=x;
    a[t].l=0;
    a[t].r=i;
}
```
核心思想：将打井操作看作与0号点连边，边权为打井费用，然后跑最小生成树。

### 最优关键思路或技巧
- **思维方式**：将打井操作转化为与虚拟点连边，把问题转化为最小生成树问题，简化问题求解。
- **算法优化**：在稠密图中，Prim算法时间复杂度为$O(n^2)$，比Kruskal算法$O(m log m)$更优。

### 可拓展之处
同类型题如网络布线问题，有多个节点，节点自身有建设基站的费用，节点间有连接线路的费用，求让所有节点连通的最小费用。可采用同样的思路，新增虚拟点，将建设基站费用看作与虚拟点连边的边权，再求最小生成树。

### 推荐题目
- [P3366 【模板】最小生成树](https://www.luogu.com.cn/problem/P3366)：最小生成树模板题，可巩固Kruskal和Prim算法。
- [P1194 买礼物](https://www.luogu.com.cn/problem/P1194)：类似本题，有物品自身价格和物品间组合价格，求满足条件的最小花费。
- [P2872 [USACO07DEC]Building Roads S](https://www.luogu.com.cn/problem/P2872)：给定一些点的坐标和已有的边，求让所有点连通的最小费用，也是最小生成树的应用。

### 个人心得总结
- Mr_QwQ提醒用C++ STL优先队列时注意排序方向，避免因习惯问题出错。
- 汪鸣谦一开始只想到部分得分做法，通过看题解理解后再写题解提升能力，强调理解题解和自我总结的重要性。 

---
处理用时：31.67秒
# 题目信息

# 采购特价商品

## 题目背景

《爱与愁的故事第三弹·shopping》第一章。

## 题目描述

中山路店山店海，成了购物狂爱与愁大神的“不归之路”。中山路上有 $n$（$n \leq 100$）家店，每家店的坐标均在 $-10000$ 至 $10000$ 之间。其中的 $m$ 家店之间有通路。若有通路，则表示可以从一家店走到另一家店，通路的距离为两点间的直线距离。现在爱与愁大神要找出从一家店到另一家店之间的最短距离。你能帮爱与愁大神算出吗？

## 说明/提示

对于 $100 \%$ 的数据：$2 \le n \leq 100$，$1 \le i, j, s, t \le n$，$1 \le m \leq 1000$。 

## 样例 #1

### 输入

```
5

0 0

2 0

2 2

0 2

3 1

5

1 2

1 3

1 4

2 5

3 5

1 5```

### 输出

```
3.41```

# AI分析结果

### 综合分析与结论
本题是一个图论中的最短路问题，给定一些点的坐标和点之间的连通关系，求两点间的最短距离。各位作者使用了多种最短路算法来解决该问题，包括 SPFA、Dijkstra（含堆优化）、Floyd、Bellman - Ford 以及搜索（DFS、BFS）等。

SPFA 算法通过队列不断更新最短路，时间复杂度不稳定，最好为 $O(m)$，最坏为 $O(n*m)$。Dijkstra 算法利用贪心思想，每次选择距离源点最近且未确定最短路的点进行扩展，堆优化后复杂度为 $O((N + M)\log M)$，但不能处理负权边。Floyd 算法基于动态规划，通过枚举中转点更新任意两点间的最短路，时间复杂度为 $O(n^3)$，可以处理负权边。

### 所选题解
- **作者：xhQYm (赞：62)，4星**
    - **关键亮点**：思路清晰，详细讲解了 SPFA 算法的思路和复杂度，并给出了带注释的模板和本题的完整代码，代码可读性高。
    - **个人心得**：无

### 重点代码
```cpp
// 计算两点间距离
double distance(int x1, int y1, int x2, int y2) {
    return sqrt(abs(x1 - x2) * abs(x1 - x2) + abs(y1 - y2) * abs(y1 - y2));
}

// 添加边
void add(int a, int b, double c) {
    e[idx] = b, w[idx] = c, ne[idx] = h[a], h[a] = idx++;
}

// SPFA 算法
void spfa() {
    for (int i = 1; i <= n; i++) dist[i] = 1000000000.0;
    dist[s] = 0;
    queue<int> q;
    q.push(s);
    st[s] = true;
    while (!q.empty()) {
        int t = q.front();
        q.pop();
        st[t] = false;
        for (int i = h[t]; i != -1; i = ne[i]) {
            int j = e[i];
            if (dist[j] > dist[t] + w[i]) {
                dist[j] = dist[t] + w[i];
                if (!st[j]) {
                    st[j] = true;
                    q.push(j);
                }
            }
        }
    }
    cout << fixed << setprecision(2) << dist[end];
}
```
**核心实现思想**：首先使用邻接表存储图，然后将起点加入队列，不断从队列中取出点，对其相邻点进行松弛操作，如果相邻点的距离可以更新且不在队列中，则将其加入队列。

### 最优关键思路或技巧
- **数据结构**：使用邻接表或邻接矩阵存储图，邻接表适合稀疏图，邻接矩阵适合稠密图。
- **算法优化**：Dijkstra 算法使用堆优化可以将时间复杂度从 $O(n^2)$ 降低到 $O((N + M)\log M)$；SPFA 算法通过队列避免了不必要的重复计算。
- **思维方式**：对于最短路问题，根据图的特点和数据范围选择合适的算法。如果图中存在负权边，可选择 Floyd 或 Bellman - Ford 算法；如果是正权图，Dijkstra 算法（堆优化）通常是较好的选择。

### 可拓展之处
- **同类型题**：其他图论中的最短路问题，如多源最短路、次短路等。
- **类似算法套路**：可以使用 A* 算法、双向 BFS 等算法进一步优化最短路的求解。

### 推荐题目
- [P3371 【模板】单源最短路径（弱化版）](https://www.luogu.com.cn/problem/P3371)
- [P4779 【模板】单源最短路径（标准版）](https://www.luogu.com.cn/problem/P4779)
- [P1119 灾后重建](https://www.luogu.com.cn/problem/P1119)

### 个人心得摘录与总结
- **作者：ljc20020730**：提到题目关于单向还是双向的描述不够严谨，根据实际情况判断应为双向图，提醒我们在做题时要仔细分析题目条件。
- **作者：cxy004**：指出在使用 SPFA 算法时初始化除起点外的值要足够大，避免因初始化问题导致错误。
- **作者：yagyagyag**：尝试 BFS 只得到 60 分且有超时情况，改用 DFS 后 46 行代码 AC，说明不同搜索算法在不同题目中的适用性不同。 

---
处理用时：32.80秒
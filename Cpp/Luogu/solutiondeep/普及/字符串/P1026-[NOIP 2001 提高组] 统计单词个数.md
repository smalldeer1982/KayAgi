# 题目信息

# [NOIP 2001 提高组] 统计单词个数

## 题目描述

给出一个长度不超过 $200$ 的由小写英文字母组成的字母串（该字串以每行 $20$ 个字母的方式输入，且保证每行一定为 $20$ 个）。要求将此字母串分成
 $k$ 份，且每份中包含的单词个数加起来总数最大。  

每份中包含的单词可以部分重叠。当选用一个单词之后，其第一个字母不能再用。例如字符串 `this` 中可包含 `this` 和 `is`，选用 `this` 之后就不能包含
 `th`。

单词在给出的一个不超过 $6$ 个单词的字典中。

要求输出最大的个数。


## 说明/提示

【数据范围】  
对于 $100\%$ 的数据，$2 \le k \le 40$，$1 \le s \le 6$。

【样例解释】
划分方案为 this / isabookyoua / reaoh

**【题目来源】**

NOIP 2001 提高组第三题

## 样例 #1

### 输入

```
1 3
thisisabookyouareaoh
4
is
a
ok
sab
```

### 输出

```
7
```

# AI分析结果

### 综合分析与结论
该题解采用动态规划思路，将问题转化为在字符串中放置分割线，通过状态转移方程计算最大单词个数。算法要点在于定义状态 $f[i][j]$ 表示在第 $i$ 个字母后放第 $j$ 个分割线时前 $i$ 个字母的最大价值，通过枚举分割线位置和转移状态来更新 $f$ 数组。解决难点在于处理单词匹配时的去重问题，通过标记匹配过的位置避免重复使用首字母。整体思路清晰，代码实现详细，但部分代码可进一步优化，如字符串长度计算可提前处理。

### 所选题解
- 题解星级：4星
- 关键亮点：思路清晰，将本题与类似题目进行关联，方便理解；代码注释详细，便于阅读和调试。
- 个人心得：“第一次提交忘了把Debug注释掉居然还有20？你谷评测机太玄学”，总结为提交代码前要注意注释掉调试代码，避免影响评测结果。

### 重点代码及核心实现思想
```cpp
// 计算区间(l, r)中字典单词个数
inline int cnt(int index,int l,int r){
    int len=r-l-strlen(word[index]+1)+2,res=0;
    rep(i,0,len-1)
        rep(j,1,strlen(word[index]+1))
            if((word[index][j]^str[l+i+j-1])||(trace[l+i]))
                break;
            else
                if(j==strlen(word[index]+1))
                    ++res,trace[l+i]=true;
    return res;
}
inline int query(int l,int r){ 
    rep(i,l,r)
        trace[i]=false;
    int res=0;
    rep(i,1,s)
        if(r-l+1>=strlen(word[i]+1))
            res+=cnt(i,l,r);
    return res;
}

// 动态规划核心代码
void calc(){
    rep(i,1,n-1)
        f[i][1]=query(1,i);
    rep(j,2,k)
        rep(i,j,n-1)
            rep(l,j-1,i-1)
                f[i][j]=max(f[i][j],f[l][j-1]+query(l+1,i));
    rep(i,k,n-k)
        ans=max(ans,f[i][k]+query(i+1,n));
}
```
核心实现思想：`cnt` 函数用于计算区间内某个单词的匹配个数，通过枚举匹配位置并标记首字母避免重复；`query` 函数调用 `cnt` 函数统计区间内所有字典单词的个数；`calc` 函数进行动态规划，初始化 $f[i][1]$，然后通过三重循环更新 $f$ 数组，最后统计最大答案。

### 最优关键思路或技巧
- 动态规划：将问题转化为放置分割线问题，通过状态转移方程求解最大单词个数。
- 标记去重：在单词匹配时标记首字母，避免重复使用，解决了题目中的去重要求。

### 可拓展之处
同类型题或类似算法套路：这类区间分割求最优解的问题可使用动态规划解决，如区间DP、线性DP等。可以通过枚举分割点，将大区间问题转化为小区间问题，再通过状态转移方程更新最优解。

### 推荐题目
- [P1018 乘积最大](https://www.luogu.org/problem/P1018)
- [P1043 数字游戏](https://www.luogu.org/problem/P1043)
- [P1182 数列分段 Section II](https://www.luogu.org/problem/P1182)

---
处理用时：24.24秒
# 题目信息

# 失踪的7

## 题目描述

远古的 Pascal 人也使用阿拉伯数字来进行计数，但是他们又不喜欢使用 $7$ ，因为他们认为 $7$ 是一个不吉祥的数字，所以 Pascal 数字 $8$ 其实表示的是自然数中的 $7$，$18$ 表示的是自然数中的 $16$ 。请计算，在正整数 $n$ 范围以内包含有多少个 Pascal 数字。


## 说明/提示

对于所有数据，$1 \leq t \leq 10000$，$1 \leq n \leq 2^{32}-1$。

## 样例 #1

### 输入

```
2
10
20```

### 输出

```
9
18```

# AI分析结果

### 综合分析与结论
这些题解主要围绕计算正整数 $n$ 范围内 Pascal 数字（不含 7）的数量展开，思路多样。核心难点在于处理含 7 的数字以及高效计算符合条件的数字数量。主要思路有贡献值法、数位 DP、进制转换、排列组合等。其中进制转换和贡献值法因思路清晰、实现高效，成为较优选择。

### 所选题解
- **dbxxx（5星）**
    - **关键亮点**：思路清晰，自创“贡献值”概念，详细解释计算过程，代码可读性高，对含 7 数字的处理有特判。
    - **核心代码**：
```cpp
for (int i = 0; i < s.length(); ++i) {
    if (s[i] == '7') {
        s[i] = '6';
        for (int j = i + 1; j < s.length(); ++j)
            s[j] = '9';
        break;
    }
}
int ans = 0;
for (int i = s.length() - 1, atr = 1; i >= 0; --i, atr *= 9)
    ans += atr * (s[i] - '0') - (s[i] - '0' > 7? atr : 0);
```
    - **核心思想**：先特判含 7 的数字，将其转换为不含 7 的等价数字。然后计算每一位的贡献值并累加，根据该位数字是否大于 7 采用不同的贡献值计算方式。

- **Ice_teapoy（4星）**
    - **关键亮点**：采用进制转换思路，对初始代码的 Bug 分析详细，给出特判方法。
    - **核心代码**：
```cpp
for (i=0;i<k;++i)
    if (a[i]=='7') {
        a[i]='6';
        for (j=i+1;j<k;++j) a[j]='9';
        break;
    }
for (i=k-1;i>=0;--i) {
    if (a[i]>'7') sum+=s;
    s*=9;
}
for (i=0;i<k;++i)
    ans=ans*9+a[i]-'0';
cout<<ans-sum<<endl;
```
    - **核心思想**：先对含 7 的数字进行特判转换，再计算因数字 8 和 9 产生的偏差值 `sum`，最后将九进制数转换为十进制数并减去偏差值得到结果。

- **I4ever（4星）**
    - **关键亮点**：通过手模找规律，预处理 9 的幂次，代码简洁，计算高效。
    - **核心代码**：
```cpp
int a[10] = {1, 9, 81, 729, 6561, 59049, 531441, 4782969, 43046721, 387420489};
while (n) {
    int num = n % 10;
    n /= 10;
    if (num < 7)
        ans += num * a[dep];
    else
        ans += (num - 1) * a[dep];
    dep++;
}
```
    - **核心思想**：预处理 9 的幂次，将数字按位拆分，根据每一位数字是否小于 7 采用不同的计算方式，累加结果。

### 最优关键思路或技巧
- **进制转换**：将 Pascal 数字看作九进制数，转换为十进制数计算，简化计算过程。
- **特判含 7 数字**：遇到含 7 的数字，将该位变为 6，后续位变为 9，避免无效计算。
- **预处理幂次**：提前计算 9 的幂次，减少重复计算，提高效率。

### 拓展思路
同类型题可考虑其他数字缺失的情况，如不含 4 等，解题思路类似，关键在于处理特殊数字和采用合适的计算方法。类似算法套路有数位 DP，可用于解决数字统计、数字组合等问题。

### 推荐题目
- [P2602 数字计数](https://www.luogu.com.cn/problem/P2602)：统计数字在区间内出现的次数。
- [P4127 同类分布](https://www.luogu.com.cn/problem/P4127)：计算区间内数字和能整除该数的数字个数。
- [P3413 SAC#1 - 萌数](https://www.luogu.com.cn/problem/P3413)：统计区间内回文串子串的数字个数。

### 个人心得摘录与总结
- **I4ever**：通过手模找规律，避免暴力求解，适用于数据范围大的情况。
- **灬Amiya灬**：注意数据范围，使用合适的数据类型，避免溢出错误。
- **JustinRochester**：关注题目中的坑点，如含 7 数字的处理，可在读入时进行特殊处理。 

---
处理用时：35.93秒
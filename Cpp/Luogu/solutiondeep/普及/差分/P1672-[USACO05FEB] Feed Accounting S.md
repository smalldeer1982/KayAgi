# 题目信息

# [USACO05FEB] Feed Accounting S

## 题目描述

约翰想知道上一船饲料是什么时候运到的。在饲料运到之前，他的牛正好把仓库里原来的饲料全吃光了。他收到运来的 $F1(1\le F1\le 10^6)$ 千克饲料。遗憾的是，他已经不记得这是哪一天的事情了。到第 $D(1\le D\le 2\times 10^3)$ 天为止，仓库里还剩下 $F2(1\le F2\le F1)$ 千克饲料。

约翰养了 $C(1\le C\le 100)$ 头牛，每头牛每天都吃掉恰好 $1$ 千克饲料。由于不同的原因，牛们从某一天开始在仓库吃饲料，又在某一天离开仓库，所以不同的两天可能会有差距很大的饲料消耗量。每头牛在来的那天和离开的那天都在仓库吃饲料。给出今天的日期 $D$，写一个程序，判断饲料**最近**一次运到是在什么时候。今天牛们已经吃过饲料了，并且饲料运到的那天牛们还没有吃过饲料。

**如果最终的答案有多个可能，请输出最大的（即，最近的）那一个。**

## 说明/提示

### 样例解释

上一次运来了 $14$ 千克饲料，现在饲料还剩下 $4$ 千克。最近 $10$ 天里，有 $3$ 头牛来吃过饲料。

约翰在第 $6$ 天收到 $14$ 千克饲料，当天吃掉 $2$ 千克，第 $7$ 天吃掉 $2$ 千克，第 $8$ 天吃掉 $3$ 千克，第 $9$ 天吃掉 $2$ 千克，第 $10$ 天吃掉 $1$ 千克，正好还剩 $4$ 千克。

### 数据规模

$1\le F2\le F1\le 10^6$，$1\le D\le 2\times 10^3$，$1\le C\le 100$。

## 样例 #1

### 输入

```
3 14 4 10
1 9
5 8
8 12```

### 输出

```
6```

# AI分析结果

### 综合分析与结论

本题的核心在于通过差分算法高效计算每天的饲料消耗量，并通过逆向枚举找到饲料运到的时间。差分算法能够将区间修改的时间复杂度从 $O(n)$ 优化到 $O(1)$，非常适合处理这类区间更新问题。大多数题解都采用了差分+逆向枚举的思路，但部分题解在代码实现或思路解释上存在不足。

### 所选高星题解

#### 1. 作者：Chengjintian (赞：8)  
**星级：4.5**  
**关键亮点：**  
- 详细解释了差分算法的原理及其在本题中的应用。
- 通过方程 $F1 + \sum_{i=x}^D a_i = F2$ 清晰表达了问题的数学模型。
- 代码结构清晰，注释详细，易于理解。

**核心代码：**
```cpp
for(int i=minn;i<=maxx;i++){
    a[i]=a[i-1]+c[i]; // 通过差分数组计算出a[i]
}
ll x=d+1;
while(f2!=f1){ // 枚举到方程成立
    f2+=a[--x]; // 开始枚举x
}
cout<<x;
```
**实现思想：** 通过差分数组计算每天的饲料消耗量，然后从第 $D$ 天开始逆向枚举，找到满足条件的天数。

#### 2. 作者：fangyicheng1216 (赞：4)  
**星级：4**  
**关键亮点：**  
- 简洁明了地解释了差分的性质及其在本题中的应用。
- 代码简洁高效，适合快速理解与实现。

**核心代码：**
```cpp
for(int i=1;i<=d;i++) a[i]=a[i-1]+a[i]; // 算出前D天每天少的饲料
for(int i=d;i>=1;i--){ // 暴力查找
    f2-=a[i];
    if(f2==f1){
        cout<<i;
        return 0;
    }
}
```
**实现思想：** 通过差分数组计算每天的饲料消耗量，然后从第 $D$ 天开始逆向枚举，找到满足条件的天数。

#### 3. 作者：_Wind_Leaves_ShaDow_ (赞：0)  
**星级：4**  
**关键亮点：**  
- 通过将时间轴与线段结合，形象地解释了差分算法的应用。
- 代码简洁，注释清晰，适合初学者理解。

**核心代码：**
```cpp
for(int i=1;i<=d;i++)diff[i]+=diff[i-1]; // 简单差分，归回
for(int i=d;i>=1;i--){ // 从后往前推日期
    f1-=diff[i]; // 这里也可以是 f2+=diff[i]，自行选择
    if(f1==f2){ // 推到相等时
        cout<<i;
        break;
    }
}
```
**实现思想：** 通过差分数组计算每天的饲料消耗量，然后从第 $D$ 天开始逆向枚举，找到满足条件的天数。

### 最优关键思路与技巧

1. **差分算法**：通过差分数组高效处理区间修改问题，将时间复杂度从 $O(n)$ 优化到 $O(1)$。
2. **逆向枚举**：从第 $D$ 天开始逆向枚举，找到满足条件的天数，避免了复杂的正向计算。
3. **数学模型**：通过方程 $F1 + \sum_{i=x}^D a_i = F2$ 清晰表达问题，便于理解和实现。

### 可拓展之处

- **类似算法套路**：差分算法常用于处理区间修改问题，如区间加、区间减等。类似的题目可以通过差分+前缀和的方式高效解决。
- **同类型题**：  
  - [P3368 【模板】树状数组 2](https://www.luogu.com.cn/problem/P3368)  
  - [P3372 【模板】线段树 1](https://www.luogu.com.cn/problem/P3372)  
  - [P3397 地毯](https://www.luogu.com.cn/problem/P3397)

### 个人心得摘录

- **Chengjintian**：通过方程 $F1 + \sum_{i=x}^D a_i = F2$ 清晰表达了问题的数学模型，便于理解和实现。
- **fangyicheng1216**：差分算法可以快速处理区间修改问题，适合处理类似题目。
- **_Wind_Leaves_ShaDow_**：将时间轴与线段结合，形象地解释了差分算法的应用，便于初学者理解。

---
处理用时：29.01秒
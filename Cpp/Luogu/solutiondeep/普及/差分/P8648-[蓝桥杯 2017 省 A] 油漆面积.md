# 题目信息

# [蓝桥杯 2017 省 A] 油漆面积

## 题目描述

X 星球的一批考古机器人正在一片废墟上考古。

该区域的地面坚硬如石、平整如镜。

管理人员为方便，建立了标准的直角坐标系。

每个机器人都各有特长、身怀绝技。它们感兴趣的内容也不相同。

经过各种测量，每个机器人都会报告一个或多个矩形区域，作为优先考古的区域。

矩形的表示格式为 $(x_1,y_1,x_2,y_2)$，代表矩形的两个对角点坐标。

为了醒目，总部要求对所有机器人选中的矩形区域涂黄色油漆。

小明并不需要当油漆工，只是他需要计算一下，一共要耗费多少油漆。

其实这也不难，只要算出所有矩形覆盖的区域一共有多大面积就可以了。

注意，各个矩形间可能重叠。

本题的输入为若干矩形，要求输出其覆盖的总面积。


## 说明/提示

蓝桥杯 2022 省赛 A 组 J 题。

## 样例 #1

### 输入

```
3
1 5 10 10
3 1 20 20
2 7 15 17
```

### 输出

```
340```

## 样例 #2

### 输入

```
3
5 2 10 6
2 7 12 10
8 1 15 15```

### 输出

```
128```

# AI分析结果

### 综合分析与结论

本题要求计算多个矩形覆盖的总面积，考虑到矩形可能重叠，直接暴力计算会导致时间复杂度较高。题解中主要采用了两种思路：

1. **二维差分+前缀和**：通过差分标记矩形的覆盖区域，再通过前缀和计算每个点被覆盖的次数，最终统计被覆盖的区域面积。该方法时间复杂度为 \(O(n^2)\)，空间复杂度较高，但思路清晰，适合小规模数据。

2. **扫描线+线段树**：通过扫描线算法将矩形问题转化为区间问题，利用线段树动态维护被覆盖的区间长度。该方法时间复杂度为 \(O(n \log n)\)，适合大规模数据，且代码实现较为复杂。

### 所选高星题解

#### 题解1：rui_er (4星)
- **关键亮点**：使用二维差分和前缀和的思想，代码简洁，思路清晰，适合初学者理解。
- **核心代码**：
  ```cpp
  rep(i, 1, n) {
      int x1, y1, x2, y2;
      scanf("%d%d%d%d", &x1, &y1, &x2, &y2);
      ++a[x1][y1];
      --a[x1][y2];
      --a[x2][y1];
      ++a[x2][y2];
  }
  rep(i, 0, 10000) {
      rep(j, 0, 10000) {
          a[i][j] = int(i > 0 ? a[i-1][j] : 0) + (j > 0 ? a[i][j-1] : 0) - (i > 0 && j > 0 ? a[i-1][j-1] : 0) + a[i][j];
          if(a[i][j]) ++ans;
      }
  }
  ```
- **核心思想**：通过差分标记矩形的四个角，再通过前缀和计算每个点被覆盖的次数，最终统计被覆盖的区域面积。

#### 题解2：___w (4星)
- **关键亮点**：使用扫描线+线段树的经典解法，时间复杂度较低，适合大规模数据。
- **核心代码**：
  ```cpp
  void update(int p) {
      if (t[p].cnt) t[p].len = a[t[p].r+1]-a[t[p].l];
      else t[p].len = t[p<<1].len+t[p<<1|1].len;
  }
  ```
- **核心思想**：通过扫描线算法将矩形问题转化为区间问题，利用线段树动态维护被覆盖的区间长度。

#### 题解3：__DDDDDD__ (4星)
- **关键亮点**：同样是扫描线+线段树的解法，代码结构清晰，注释详细，适合进阶学习。
- **核心代码**：
  ```cpp
  void update(int p){
      if(t[p].cnt) t[p].dat = val[t[p].r+1]-val[t[p].l];
      else t[p].dat = t[p*2].dat+t[p*2+1].dat;
  }
  ```
- **核心思想**：通过扫描线算法将矩形问题转化为区间问题，利用线段树动态维护被覆盖的区间长度。

### 最优关键思路与技巧

1. **二维差分+前缀和**：适合小规模数据，思路简单，代码实现容易。
2. **扫描线+线段树**：适合大规模数据，时间复杂度低，但代码实现较为复杂。

### 可拓展之处

- **同类型题**：类似的问题可以扩展到三维空间，使用三维差分或扫描线+线段树的变种。
- **类似算法套路**：扫描线算法还可以用于计算矩形的周长、多个矩形的交集等问题。

### 推荐题目

1. [P5490 扫描线](https://www.luogu.com.cn/problem/P5490)
2. [P1856 矩形面积并](https://www.luogu.com.cn/problem/P1856)
3. [P1502 窗口的星星](https://www.luogu.com.cn/problem/P1502)

### 个人心得摘录

- **rui_er**：提到本题卡空间，但通过使用 `short` 类型解决了空间问题。
- **___w**：提到扫描线的板子题，建议先做P5490练习。
- **__DDDDDD__**：提到扫描线的基本思想，强调了线段树的维护方式。

---
处理用时：29.46秒
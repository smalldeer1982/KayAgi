# 题目信息

# 集合

## 题目描述

Caima 给你了所有 $[a,b]$ 范围内的整数。一开始每个整数都属于各自的集合。每次你需要选择两个属于不同集合的整数，如果这两个整数拥有大于等于 $p$ 的公共质因数，那么把它们所在的集合合并。

重复如上操作，直到没有可以合并的集合为止。

现在 Caima 想知道，最后有多少个集合。

## 说明/提示

#### 样例 1 解释

对于样例给定的数据，最后有 $\{10,20,12,15,18\},\{13\},\{14\},\{16\},\{17\},\{19\},\{11\}$ 共 $7$ 个集合，所以输出应该为 $7$。

#### 数据规模与约定
- 对于 $80\%$ 的数据，$1 \leq a \leq b \leq 10^3$。
- 对于 $100%$ 的数据，$1 \leq a \leq b \leq 10^5,2 \leq p \leq b$。



## 样例 #1

### 输入

```
10 20 3```

### 输出

```
7```

# AI分析结果

### 综合分析与结论

本题的核心在于如何高效地合并具有公共质因数的集合，并最终统计集合的数量。大部分题解采用了**并查集**来维护集合的合并操作，并结合**筛法**（如埃氏筛、欧拉筛）来预处理质数。题解的主要区别在于筛法的选择、合并策略的优化以及代码的实现细节。

### 所选高星题解

#### 1. 作者：ouuan (5星)
- **关键亮点**：使用埃氏筛法在筛质数的同时进行集合合并，避免了额外的遍历操作，极大地优化了时间复杂度。代码简洁且高效，思路清晰。
- **核心实现思想**：在埃氏筛的过程中，当筛到一个质数时，如果该质数大于等于 `p`，则将其倍数与质数本身合并到同一个集合中。通过并查集维护集合的合并操作，最终统计集合的数量。
- **核心代码**：
  ```cpp
  for (i=2;i<=b;++i) //埃氏筛
  {
      if (!np[i])
      {
          if (i>=p) //如果当前质数大于p才合并
          {
              for (j=i*2;j<=b;j+=i)
              {
                  np[j]=true;
                  if (j-i>=a&&find(j)!=find(j-i)) //合并操作
                  {
                      f[find(j)]=find(j-i);
                      --ans;
                  }
              }
          }
      }
  }
  ```

#### 2. 作者：Michigan_King (4星)
- **关键亮点**：使用欧拉筛法预处理质数，并通过枚举质数的倍数进行集合合并。思路清晰，代码结构良好，时间复杂度较低。
- **核心实现思想**：先通过欧拉筛法筛出所有质数，然后枚举每个质数的倍数，将符合条件的数合并到同一个集合中。最终统计集合的数量。
- **核心代码**：
  ```cpp
  for(int i=1;i<=cnt;i++)
  if(p[i]>=P)
  {
      int t=(A+p[i]-1)/p[i]*p[i];//上取整 
      for(int j=t+p[i];j<=B;j+=p[i])
      merge(t,j);
  }
  ```

#### 3. 作者：HDWR (4星)
- **关键亮点**：结合线性筛和并查集，通过枚举质数的倍数进行集合合并。代码实现简洁，思路清晰，时间复杂度较低。
- **核心实现思想**：先通过线性筛法筛出所有质数，然后枚举每个质数的倍数，将符合条件的数合并到同一个集合中。最终统计集合的数量。
- **核心代码**：
  ```cpp
  for (int i=From,v;i<=Size;i++)
  {
      for (int j=ceil(A*1.0/Prime[i]),Now;Prime[i]*j<=B;j++)
      {
          Now=Find(Prime[i]);
          v=Find(Prime[i]*j);
          Father[v]=Now;
      }
  }
  ```

### 最优关键思路与技巧

1. **并查集的应用**：并查集是处理集合合并问题的利器，能够高效地维护集合的合并与查询操作。
2. **筛法的选择**：埃氏筛和欧拉筛是预处理质数的常用方法，欧拉筛的时间复杂度更低，适合处理大规模数据。
3. **合并策略的优化**：在筛质数的过程中直接进行集合合并，避免了额外的遍历操作，极大地提高了效率。

### 可拓展之处

- **同类型题**：类似的问题可以扩展到处理更大范围的质数或更复杂的集合合并条件。
- **类似算法套路**：在处理需要合并集合的问题时，可以优先考虑并查集与筛法的结合，尤其是在涉及质数的情况下。

### 推荐题目

1. [P3383 【模板】线性筛素数](https://www.luogu.org/problem/P3383)
2. [P1551 亲戚](https://www.luogu.org/problem/P1551)
3. [P1835 素数密度](https://www.luogu.org/problem/P1835)

### 个人心得摘录

- **ouuan**：在筛质数的过程中直接进行集合合并，避免了额外的遍历操作，极大地优化了时间复杂度。
- **Michigan_King**：欧拉筛法的时间复杂度较低，适合处理大规模数据，结合并查集能够高效地解决问题。
- **HDWR**：线性筛法能够快速筛出质数，结合并查集能够高效地处理集合合并问题。

---
处理用时：35.01秒
# 题目信息

# 机器分配

## 题目描述

总公司拥有高效设备 $M$ 台，准备分给下属的 $N$ 个分公司。各分公司若获得这些设备，可以为国家提供一定的盈利。问：如何分配这 $M$ 台设备才能使国家得到的盈利最大？求出最大盈利值。其中 $M \le 15$，$N \le 10$。分配原则：每个公司有权获得任意数目的设备，但总台数不超过设备数 $M$。


## 样例 #1

### 输入

```
3 3
30 40 50
20 30 50
20 25 30
```

### 输出

```
70
1 1
2 1
3 1
```

# AI分析结果

### 综合分析与结论

本题是一个典型的动态规划问题，核心在于如何通过状态转移方程求解最大盈利值，并输出字典序最小的分配方案。大多数题解采用了二维DP的思路，部分题解还涉及DFS或分组背包的解法。难点在于如何保证输出方案的字典序最小，部分题解通过倒序枚举或递归输出解决了这一问题。

### 所选高星题解

#### 1. 冈崎梦美 (5星)
- **关键亮点**：通过倒序枚举解决了字典序最小的问题，代码简洁且思路清晰。使用`path`数组记录分配方案，避免了复杂的递归输出。
- **个人心得**：作者提到最初的代码只有90分，原因是忽略了字典序最小的要求，通过倒序枚举成功解决了这一问题。
- **核心代码**：
```cpp
for(int i=1;i<=n;i++)
    for(int j=0;j<=m;j++)    
        for(int k=0;k<=j;k++)
        {
            if (f[i][j]<f[i-1][k]+graph[i][j-k])
            {
                f[i][j]=f[i-1][k]+graph[i][j-k];
                for(int h=1;h<i;h++) path[i][j][h]=path[i-1][k][h];
                path[i][j][i]=j-k;
            }
        }
```

#### 2. ouuan (4星)
- **关键亮点**：通过优化DP数组的维度，减少了空间复杂度。使用`ans`数组记录分配方案，避免了复杂的递归输出。
- **核心代码**：
```cpp
for(int i=n;i>0;--i)
{
    for(int j=m;j>=0;--j)
    {
        for(int k=1;k<=j;++k)
        {
            if (f[j-k]+w[i][k]>f[j])
            {
                f[j]=f[j-k]+w[i][k];
                ans[i][j]=k;
            }
        }
    }
}
```

#### 3. prefer (4星)
- **关键亮点**：使用DFS进行搜索，通过从1号到n号枚举机器数量，保证了字典序最小。代码简洁且易于理解。
- **核心代码**：
```cpp
void dfs(int Nnum,int Nans,int Nm) {
    if(Nm<0) return;
    if(Nnum==n+1) {
        if(Nans>ans) {
            ans=Nans;
            for(int i=1;i<=n;i++) f[i]=pau[i];
        }
        return;
    }
    for(int i=0; i<=m; i++) pau[Nnum]=i,dfs(Nnum+1,Nans+a[Nnum][i],Nm-i);
}
```

### 最优关键思路与技巧
1. **倒序枚举**：在DP中倒序枚举可以保证字典序最小，避免复杂的递归输出。
2. **路径记录**：通过`path`或`ans`数组记录分配方案，避免在输出时进行复杂的递归。
3. **DFS优化**：使用DFS时，通过从1号到n号枚举机器数量，可以保证字典序最小。

### 可拓展之处
- **同类型题**：类似的分配问题可以通过DP或DFS解决，关键在于如何记录路径并保证字典序最小。
- **算法套路**：DP中的路径记录和DFS中的枚举顺序是解决类似问题的常见套路。

### 推荐题目
1. [P1048 采药](https://www.luogu.com.cn/problem/P1048) - 经典的01背包问题，与本题的DP思路相似。
2. [P1064 金明的预算方案](https://www.luogu.com.cn/problem/P1064) - 分组背包问题，与本题的分组DP思路相似。
3. [P2014 选课](https://www.luogu.com.cn/problem/P2014) - 树形DP问题，与本题的路径记录思路相似。

### 个人心得总结
- **调试经历**：冈崎梦美提到最初的代码只有90分，原因是忽略了字典序最小的要求，通过倒序枚举成功解决了这一问题。
- **顿悟感想**：prefer通过DFS从1号到n号枚举机器数量，保证了字典序最小，代码简洁且易于理解。

---
处理用时：37.45秒
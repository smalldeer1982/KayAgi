# 题目信息

# [NOIP 1996 提高组] 挖地雷

## 题目描述

在一个地图上有 $N\ (N \le 20)$ 个地窖，每个地窖中埋有一定数量的地雷。同时，给出地窖之间的连接路径。当地窖及其连接的数据给出之后，某人可以从任一处开始挖地雷，然后可以沿着指出的连接往下挖（仅能选择一条路径），当无连接时挖地雷工作结束。设计一个挖地雷的方案，使某人能挖到最多的地雷。


## 说明/提示

**【题目来源】**

NOIP 1996 提高组第三题

## 样例 #1

### 输入

```
5
10 8 4 7 6
1 1 1 0
0 0 0
1 1
1
```

### 输出

```
1 3 4 5
27```

# AI分析结果

### 综合分析与结论

本题的核心是通过动态规划（DP）或深度优先搜索（DFS）来找到从任意地窖出发，沿着单向路径挖地雷的最大值，并输出路径。题解中主要分为以下几种思路：

1. **DFS暴力搜索**：通过枚举每个地窖作为起点，进行DFS遍历，记录路径和最大值。虽然简单直观，但由于数据范围较小（N≤20），DFS也能通过。
2. **DP顺推/逆推**：通过定义状态`f[i]`表示以第`i`个地窖为终点的最大地雷数，利用状态转移方程`f[i] = max(f[j]) + a[i]`（其中`j`为`i`的前驱）进行递推。逆推的思路是从后往前计算，顺推则是从前往后。
3. **图论方法**：将地窖看作图中的节点，路径看作边，使用最长路算法（如SPFA）或Floyd算法求解。

### 评分较高的题解

#### 1. 作者：Drawing_Yang (赞：186)  
**星级：★★★★★**  
**关键亮点**：  
- 使用DP顺推的思路，状态定义清晰，转移方程简洁。
- 通过`pre`数组记录路径，递归输出路径，代码简洁且高效。
- 代码可读性强，注释清晰，适合初学者理解。

**核心代码**：
```cpp
void print(int x) {
    if(pre[x]==0) {
        printf("%d",x);
        return;
    }
    print(pre[x]);
    printf(" %d",x); 
}
```
**实现思想**：通过递归输出路径，利用`pre`数组记录每个地窖的前驱，最终输出完整路径。

#### 2. 作者：vectorwyx (赞：169)  
**星级：★★★★☆**  
**关键亮点**：  
- 详细解释了DP的三要素：数组、方程、初始化，适合DP初学者。
- 使用`dp[i]`表示以`i`为终点的最大地雷数，状态转移方程清晰。
- 通过`p[i]`记录前驱，输出路径时使用DFS回溯。

**核心代码**：
```cpp
void DFS(int x){
    if(p[x]) DFS(p[x]);
    cout<<x<<" ";
}
```
**实现思想**：通过DFS回溯输出路径，`p[i]`记录前驱，确保路径的正确性。

#### 3. 作者：sshwy (赞：68)  
**星级：★★★★☆**  
**关键亮点**：  
- 使用记忆化搜索，思路清晰，代码简洁。
- 通过`d[i]`记录从`i`出发的最大地雷数，`next[i]`记录路径，避免了重复计算。
- 代码结构清晰，适合有一定基础的读者。

**核心代码**：
```cpp
int count(int u) {
    if(d[u]) return d[u];
    int v=0, k=-1;
    for(int i=1; i<=n; i++)
        if(linker[u][i]) {
            if(d[i]==0) d[i]=count(i);
            if(d[i]>v) v=d[i], k=i;
        }
    next[u]=k;
    return v+w[u];
}
```
**实现思想**：通过记忆化搜索避免重复计算，`next[i]`记录路径，确保路径的正确性。

### 最优关键思路与技巧

1. **DP状态定义**：`f[i]`表示以第`i`个地窖为终点的最大地雷数，状态转移方程为`f[i] = max(f[j]) + a[i]`，其中`j`为`i`的前驱。
2. **路径记录**：通过`pre`或`next`数组记录路径，递归或回溯输出路径。
3. **记忆化搜索**：在DFS中使用记忆化，避免重复计算，提高效率。

### 拓展思路与类似题目

1. **类似题目**：
   - [P1048 采药](https://www.luogu.com.cn/problem/P1048)：经典的01背包问题，与本题的DP思路类似。
   - [P1091 合唱队形](https://www.luogu.com.cn/problem/P1091)：双向DP，与本题的单向DP思路相似。
   - [P1216 数字三角形](https://www.luogu.com.cn/problem/P1216)：经典的DP问题，与本题的路径选择类似。

2. **调试与心得**：
   - **调试经历**：部分题解提到在调试过程中发现路径记录错误，通过增加`pre`数组的调试输出解决了问题。
   - **顿悟感想**：通过DFS暴力搜索时，发现数据范围较小，暴力也能通过，但DP更为高效。

### 推荐题目

1. [P1048 采药](https://www.luogu.com.cn/problem/P1048)
2. [P1091 合唱队形](https://www.luogu.com.cn/problem/P1091)
3. [P1216 数字三角形](https://www.luogu.com.cn/problem/P1216)

---
处理用时：44.64秒
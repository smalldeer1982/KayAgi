# 题目信息

# Blink

## 题目描述

Farmer John 对于农场里昏暗的灯光很不满，于是他刚刚装上一个装饰精美的新吊灯。

这个吊灯由 $N(3 \le N \le 16)$ 个灯组成，并排成一个**圆圈**。

奶牛们对于这个新的发光装置很有兴趣。他们喜欢玩这样的一个游戏：

在在时刻 $T$ 时，对于每一盏灯 $i$，如果在时刻 $T-1$ 时，$i$ 左边的灯 $(1<i\le n$ 时为 $i-1$，$i=1$ 时，为 $n)$ 是开的，那么**改变第 $i$ 盏灯的状态**，否则不做操作。

他们会在 $B(1 \le B \le 10^{15})$ 个单位的时间里一直进行这样的操作。

**请注意，$B$ 可能会超过一般的 $32$ 位整数的范围。**

现在已知每一个灯的初始状态，请计算出在经过 $B$ 个单位的时间后，每一个灯的状态。

## 说明/提示

样例输出解释：

下面是样例输出的模拟

```cpp
Time T=0: 1 0 0 0 0
Time T=1: 1 1 0 0 0
Time T=2: 1 0 1 0 0
Time T=3: 1 1 1 1 0
Time T=4: 1 0 0 0 1
Time T=5: 0 1 0 0 1
Time T=6: 1 1 1 0 1

## 样例 #1

### 输入

```
5 6

1

0

0

0

0```

### 输出

```
1

1

1

0

1```

# AI分析结果

### 综合分析与结论

本题的核心难点在于处理大规模的时间步数 \( B \)（最大可达 \( 10^{15} \)），直接模拟会超时。因此，大多数题解都采用了**寻找循环节**的策略，利用灯的状态有限性（最多 \( 2^{16} \) 种状态）来避免重复计算。以下是各题解的主要思路和优化点：

1. **循环节查找**：几乎所有题解都提到了灯的状态会进入循环，通过记录状态的出现次数来找到循环节，从而减少计算量。
2. **状态压缩**：部分题解使用了二进制压缩来表示灯的状态，进一步优化了空间和时间复杂度。
3. **矩阵快速幂**：个别题解使用了矩阵快速幂来加速状态转移，虽然思路新颖，但实现复杂度较高。
4. **倍增法**：有题解使用了倍增法来预处理状态转移，适用于大规模时间步数的处理。

### 评分较高的题解

#### 题解1：Mr_Li (★★★★★)
- **关键亮点**：使用**倍增法**预处理状态转移，时间复杂度为 \( O(2^N \log B) \)，适用于大规模时间步数。
- **代码实现**：
  ```cpp
  for (i=1;i<=50;i++)
  for (j=0;j<1<<n;j++)
  f[i][j]=f[i-1][f[i-1][j]];
  ```
  - **核心思想**：通过倍增法预处理状态转移矩阵，快速计算 \( B \) 步后的状态。

#### 题解2：jiang_cheng (★★★★☆)
- **关键亮点**：通过**状态压缩**和**循环节查找**，简化了状态转移的计算。
- **代码实现**：
  ```cpp
  for (m = 1; !p[l[m]]; m++) {
      p[l[m]] = m;
      l[m + 1] = l[m] ^ (l[m] << 1 & ((1 << n) - 1)) ^ (l[m] >> (n - 1));
  }
  ```
  - **核心思想**：通过状态压缩和循环节查找，减少重复计算。

#### 题解3：COsm0s (★★★★☆)
- **关键亮点**：通过**打表**和**循环节查找**，避免了大规模模拟。
- **代码实现**：
  ```cpp
  for(int i = 1; i <= pow(2, 16) + 1; ++i) {
      for(int j = 1; j <= n; ++j) {
          dp[i][j] = dp[i - 1][j];
          if(dp[i - 1][(j - 1 == 0 ? n : j - 1)] == 1)
              dp[i][j] = !dp[i][j];
      }
  }
  ```
  - **核心思想**：通过打表记录状态，找到循环节后直接输出结果。

### 最优关键思路总结

1. **循环节查找**：利用灯的状态有限性，通过记录状态的出现次数找到循环节，避免重复计算。
2. **状态压缩**：将灯的状态压缩为二进制数，减少空间复杂度，同时方便状态转移的计算。
3. **倍增法**：通过预处理状态转移矩阵，快速计算大规模时间步数后的状态。

### 可拓展之处

- **类似问题**：对于状态有限且状态转移规则固定的问题，都可以考虑使用循环节查找或倍增法来优化。
- **矩阵快速幂**：虽然本题中使用矩阵快速幂的题解较少，但在其他状态转移问题中，矩阵快速幂是一种有效的优化手段。

### 推荐题目

1. **P1965 转圈游戏**：考察循环节和状态转移。
2. **P1082 同余方程**：涉及模运算和循环节的应用。
3. **P3390 矩阵快速幂**：练习矩阵快速幂的应用。

### 个人心得摘录

- **Mr_Li**：通过倍增法预处理状态转移，避免了大规模模拟，思路清晰且高效。
- **jiang_cheng**：状态压缩和循环节查找的结合，简化了问题，代码简洁易懂。
- **COsm0s**：打表和循环节查找的结合，虽然实现较为直接，但思路清晰，适合初学者理解。

### 通用建议

对于大规模时间步数的问题，优先考虑**循环节查找**和**状态压缩**，避免直接模拟。对于状态转移规则固定的问题，可以考虑**倍增法**或**矩阵快速幂**来优化计算。

---
处理用时：38.77秒
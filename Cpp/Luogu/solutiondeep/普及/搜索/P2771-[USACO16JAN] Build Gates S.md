# 题目信息

# [USACO16JAN] Build Gates S

## 题目描述

FarmerJohn 打算在他农场的一部分，建设一个围栏。但是因为没有认真做事，建造完成后，围栏变成一个很奇怪的形状。

具体来说，FJ 从 $(0,0)$ 出发，走了 $N$ 步，每步移动一单位（向东、向南、向西或向北）。

他走过的每一步，都会留下一段单位长度的围栏。例如，如果他的第一步向北，他建造一单位从 $(0,0)$ 到 $(0,1)$ 的围栏。

FJ 可能重复到达点多次，他也可能重复建造一段围栏多次。如果他的路径穿过一段已经建成的围栏，他的围栏也有可能会有交叉。

不用说，FJ 看到完成的围栏时，一定很沮丧。特别的，他发现一些区域被围栏封闭起来，从而无法到达。FJ 想在围栏上，安装一些门来解决这个问题。

门可以安装在任意一段单位长度（注：必须是之前走过的某一步）的围栏上，从而可以穿越这段围栏的两侧。

请计算 FJ 最少需要安装多少个门，才能保证农场上任意区域到任意区域都可到达。

## 说明/提示

注意，如果农场初始连通，答案就是 $0$。

### 数据范围

$1\le n\le 1000$。


## 样例 #1

### 输入

```
14
NNNESWWWSSEEEE```

### 输出

```
2```

# AI分析结果

### 综合分析与结论

该题目要求计算FJ在农场中建造围栏后，最少需要安装多少个门才能保证农场的连通性。题解主要集中在以下几个思路：

1. **环的检测与删除**：通过检测路径中的环，并计算需要删除的边数来保证图的连通性。
2. **图的连通性与树的性质**：通过将图转化为树，计算多余的边数来得到需要删除的门数。
3. **交点的统计**：通过统计路径中的交点来计算封闭区域的数量，进而得到需要安装的门数。
4. **搜索与标记**：通过DFS或BFS搜索封闭区域，并统计区域数量。

### 题解评分与亮点

#### 1. 作者：LPhang (赞：24)  
**星级：4.5**  
**关键亮点**：
- **思路清晰**：通过检测路径中的环，并计算需要删除的边数来保证图的连通性。
- **代码可读性高**：代码结构清晰，注释详细，易于理解。
- **优化程度高**：通过标记路径和环的检测，避免了重复计算，提高了效率。

**核心代码**：
```cpp
if(!f[last][now] && bol[x][y]) ++ans;
f[last][now] = f[now][last] = 1;
```
**核心思想**：通过标记路径和环的检测，计算需要删除的边数。

#### 2. 作者：lxzy_ (赞：18)  
**星级：4.0**  
**关键亮点**：
- **思路独特**：通过将图转化为树，计算多余的边数来得到需要删除的门数。
- **代码简洁**：代码实现简洁，逻辑清晰。
- **优化程度较高**：通过将图转化为树，减少了计算复杂度。

**核心代码**：
```cpp
if(!f[last][now]) {
    f[last][now] = f[now][last] = 1;
    ++num1;
}
```
**核心思想**：通过将图转化为树，计算多余的边数。

#### 3. 作者：Minclxc (赞：12)  
**星级：4.0**  
**关键亮点**：
- **思路新颖**：通过统计路径中的交点来计算封闭区域的数量，进而得到需要安装的门数。
- **代码简洁**：代码实现简洁，逻辑清晰。
- **优化程度较高**：通过统计交点，减少了计算复杂度。

**核心代码**：
```cpp
ans+=(b[x][y]&!a[x][y][3-opt]);
a[x][y][3-opt]=b[x][y]=1;
```
**核心思想**：通过统计路径中的交点，计算封闭区域的数量。

### 最优关键思路与技巧

- **环的检测与删除**：通过检测路径中的环，并计算需要删除的边数来保证图的连通性。这种方法思路清晰，代码实现简洁，且优化程度较高。
- **图的连通性与树的性质**：通过将图转化为树，计算多余的边数来得到需要删除的门数。这种方法思路独特，代码简洁，且优化程度较高。
- **交点的统计**：通过统计路径中的交点来计算封闭区域的数量，进而得到需要安装的门数。这种方法思路新颖，代码简洁，且优化程度较高。

### 可拓展之处

- **图的连通性问题**：类似的问题可以通过检测环、转化为树或统计交点来解决。
- **搜索与标记**：DFS或BFS搜索封闭区域的方法可以应用于其他图的连通性问题。

### 推荐题目

1. [P2731 [USACO3.3] Riding the Fences](https://www.luogu.com.cn/problem/P2731) - 考察图的遍历与欧拉路径。
2. [P2865 [USACO06NOV] Roadblocks G](https://www.luogu.com.cn/problem/P2865) - 考察图的连通性与最短路径。
3. [P3629 [APIO2010] 巡逻](https://www.luogu.com.cn/problem/P3629) - 考察图的连通性与树的直径。

### 个人心得摘录

- **调试经历**：部分题解提到在调试过程中遇到负数下标的问题，通过调整起点坐标解决了问题。
- **踩坑教训**：部分题解提到在统计封闭区域时，忽略了假封闭区域的问题，通过扩大搜索范围解决了问题。
- **顿悟感想**：部分题解提到通过将图转化为树，减少了计算复杂度，提高了效率。

---
处理用时：39.99秒
# 题目信息

# [NICA #1] 交换

## 题目描述

给定长度为 $n$ 的排列 $a$。排列的含义是，数字 $1,2,3,\cdots n$ 在 $a$ 中**恰好**出现了一次。现在有 $m$ 次操作，

- 第 $1$ 次操作将会交换第 $1$ 大（即最大）的元素和第 $2$ 大的元素。
- 第 $2$ 次操作将会交换第 $2$ 大的元素和第 $3$ 大的元素。
- 第 $3$ 次操作将会交换第 $3$ 大的元素和第 $4$ 大的元素。
- ……
- 第 $n-1$ 次操作将会交换第 $n-1$ 大的元素和第 $n$ 大的元素。
- 第 $n$ 次操作将会交换第 $1$ 大的元素和第 $2$ 大的元素。
- 第 $n+1$ 次操作将会交换第 $2$ 大的元素和第 $3$ 大的元素。
- 第 $n+2$ 次操作将会交换第 $3$ 大的元素和第 $4$ 大的元素。
- ……
- 第 $2n-2$ 次操作将会交换第 $n-1$ 大的元素和第 $n$ 大的元素。
- ……

形式化地讲，第 $i$ 次操作将会交换第 $(i-1)\bmod (n-1)+1$ 大和第 $(i-1)\bmod (n-1)+2$ 大的数字。

你需要求出排列最后的情况。



## 说明/提示

### 样例 1 解释

- 初始时：$[1,5,3,4,2]$；
- 交换第 $1$ 大和第 $2$ 大：$[1,4,3,5,2]$；
- 交换第 $2$ 大和第 $3$ 大：$[1,3,4,5,2]$；
- 交换第 $3$ 大和第 $4$ 大：$[1,2,4,5,3]$；
- 交换第 $4$ 大和第 $5$ 大：$[2,1,4,5,3]$；
- 交换第 $1$ 大和第 $2$ 大：$[2,1,5,4,3]$；
- 交换第 $2$ 大和第 $3$ 大：$[2,1,5,3,4]$；
- 交换第 $3$ 大和第 $4$ 大：$[3,1,5,2,4]$；
- 交换第 $4$ 大和第 $5$ 大：$[3,2,5,1,4]$；
- 交换第 $1$ 大和第 $2$ 大：$[3,2,4,1,5]$；
- 交换第 $2$ 大和第 $3$ 大：$[4,2,3,1,5]$。

### 数据范围及约定

对于全部数据，保证 $1\le n\le 10^5$，$0\le m\le 10^{1000000}$。

## 样例 #1

### 输入

```
5 10
1 5 3 4 2```

### 输出

```
4 2 3 1 5```

## 样例 #2

### 输入

```
10 1000000000
4 2 7 6 9 5 3 8 1 10```

### 输出

```
5 3 8 7 9 6 4 10 2 1
```

## 样例 #3

### 输入

```
10 100000000000000000000000000000000000000000000000000
10 9 8 7 6 5 4 3 2 1```

### 输出

```
1 9 10 8 7 6 5 4 3 2
```

# AI分析结果

### 综合分析与结论

本题的核心难点在于处理极大的操作次数 \( m \)（可能高达 \( 10^{1000000} \)），直接模拟操作显然不可行。通过分析，大多数题解都发现了操作的周期性，即每 \( n \times (n-1) \) 次操作后，排列会回到初始状态。因此，题解们普遍采用以下策略：

1. **周期性优化**：通过取模操作将 \( m \) 缩小到 \( n \times (n-1) \) 以内，避免无效的重复操作。
2. **错位处理**：利用每 \( n-1 \) 次操作后，排列中的元素会“错位”一次的特性，直接计算每个元素的最终位置，而不需要逐次模拟交换。
3. **快速读入与取模**：由于 \( m \) 可能非常大，题解们通常采用字符串读入，并在读入过程中直接对 \( m \) 取模，避免溢出。

### 评分较高的题解

#### 1. 作者：lrqlrq250 (★★★★★)
- **关键亮点**：详细解释了周期性优化和错位处理的原理，代码清晰且高效。通过“错位”性质，直接计算每个元素的最终位置，避免了逐次模拟的复杂度。
- **核心代码**：
  ```cpp
  for (int i=1; i<=n; i++){
      a[i] = (a[i] + t) % n ? (a[i] + t) % n : n;
  }
  ```
  **实现思想**：通过计算 \( \lfloor \frac{m}{n-1} \rfloor \) 次错位，直接更新每个元素的位置。

#### 2. 作者：HG27895 (★★★★☆)
- **关键亮点**：通过分析每 \( n-1 \) 次操作后元素的移动规律，提出了“错位”的数学表达，并给出了详细的推导过程。
- **核心代码**：
  ```cpp
  for (int i=1; i<=n; i++) a[i] = (a[i] + m / (n - 1) - 1) % n + 1;
  ```
  **实现思想**：利用错位性质，直接计算每个元素的最终位置，避免了逐次模拟。

#### 3. 作者：csxx601cjy (★★★★☆)
- **关键亮点**：结合了周期性优化和错位处理，代码简洁且高效，特别强调了快速读入和取模的重要性。
- **核心代码**：
  ```cpp
  for (int i=1; i<=n; i++) a[i] = (a[i] + m / (n - 1) - 1) % n + 1;
  ```
  **实现思想**：通过错位性质直接更新元素位置，剩余的 \( m \mod (n-1) \) 次操作通过模拟完成。

### 最优关键思路与技巧

1. **周期性优化**：通过取模操作将 \( m \) 缩小到 \( n \times (n-1) \) 以内，避免无效的重复操作。
2. **错位处理**：利用每 \( n-1 \) 次操作后，排列中的元素会“错位”一次的特性，直接计算每个元素的最终位置，而不需要逐次模拟交换。
3. **快速读入与取模**：由于 \( m \) 可能非常大，采用字符串读入，并在读入过程中直接对 \( m \) 取模，避免溢出。

### 可拓展之处

- **类似题型**：本题的周期性优化和错位处理思想可以应用于其他涉及大规模操作的题目，如循环移位、周期性变换等。
- **算法套路**：在处理大规模操作时，寻找周期性规律并利用数学性质进行优化，是一种常见的解题思路。

### 推荐题目

1. [P1082 同余方程](https://www.luogu.com.cn/problem/P1082)：考察模运算与周期性优化。
2. [P1045 快速幂](https://www.luogu.com.cn/problem/P1045)：涉及大规模计算与取模优化。
3. [P1091 合唱队形](https://www.luogu.com.cn/problem/P1091)：考察排列与周期性变换。

### 个人心得摘录

- **调试经历**：部分题解提到在调试过程中发现 \( m \) 的输入问题，通过快速读入和取模解决了溢出问题。
- **踩坑教训**：有题解提到在初始实现中忽略了 \( m \) 的周期性优化，导致无法通过大数据测试。
- **顿悟感想**：通过分析操作规律，发现“错位”性质后，问题迎刃而解，体现了数学思维在算法中的重要性。

---
处理用时：31.26秒
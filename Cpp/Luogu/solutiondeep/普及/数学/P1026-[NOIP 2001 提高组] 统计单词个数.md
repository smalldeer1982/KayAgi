# 题目信息

# [NOIP 2001 提高组] 统计单词个数

## 题目描述

给出一个长度不超过 $200$ 的由小写英文字母组成的字母串（该字串以每行 $20$ 个字母的方式输入，且保证每行一定为 $20$ 个）。要求将此字母串分成
 $k$ 份，且每份中包含的单词个数加起来总数最大。  

每份中包含的单词可以部分重叠。当选用一个单词之后，其第一个字母不能再用。例如字符串 `this` 中可包含 `this` 和 `is`，选用 `this` 之后就不能包含
 `th`。

单词在给出的一个不超过 $6$ 个单词的字典中。

要求输出最大的个数。


## 说明/提示

【数据范围】  
对于 $100\%$ 的数据，$2 \le k \le 40$，$1 \le s \le 6$。

【样例解释】
划分方案为 this / isabookyoua / reaoh

**【题目来源】**

NOIP 2001 提高组第三题

## 样例 #1

### 输入

```
1 3
thisisabookyouareaoh
4
is
a
ok
sab
```

### 输出

```
7
```

# AI分析结果

### 综合分析与结论

本题解采用了动态规划（DP）的思路，通过将字符串分割为 $k$ 份，并计算每份中包含的单词个数来求解最大单词数。题解的核心在于如何高效地统计每个区间内的单词个数，并通过状态转移方程来更新最大单词数。题解的思路清晰，代码实现也较为简洁，但在时间复杂度上可能较高，尤其是在字符串匹配部分。

### 所选题解

#### 题解作者：千反田 (赞：5)
- **星级**：4星
- **关键亮点**：
  - 使用了动态规划的思路，将问题转化为在字符串中放置分割线的问题。
  - 通过 `query` 函数统计每个区间内的单词个数，并利用 `trace` 数组来避免重复匹配。
  - 代码结构清晰，注释详细，便于理解。
- **个人心得**：
  - 作者提到第一次提交时忘记注释掉调试代码，但仍然获得了部分分数，这提醒我们在提交代码前要仔细检查。

### 核心代码片段

```cpp
inline int cnt(int index,int l,int r){
    int len=r-l-strlen(word[index]+1)+2,res=0;
    rep(i,0,len-1)
     rep(j,1,strlen(word[index]+1))
      if((word[index][j]^str[l+i+j-1])||(trace[l+i]))
       break;
      else
       if(j==strlen(word[index]+1))
        ++res,trace[l+i]=true;
    return res;
}
inline int query(int l,int r){ 
    rep(i,l,r)
     trace[i]=false;
    int res=0;
    rep(i,1,s)
     if(r-l+1>=strlen(word[i]+1))
      res+=cnt(i,l,r);
    return res;
}
void calc(){
    rep(i,1,n-1)
     f[i][1]=query(1,i);
    rep(j,2,k)
     rep(i,j,n-1)
      rep(l,j-1,i-1)
       f[i][j]=max(f[i][j],f[l][j-1]+query(l+1,i));
    rep(i,k,n-k)
     ans=max(ans,f[i][k]+query(i+1,n));
}
```

### 关键思路与技巧

1. **动态规划**：将问题转化为在字符串中放置分割线的问题，通过状态转移方程来更新最大单词数。
2. **字符串匹配**：通过 `query` 函数统计每个区间内的单词个数，并利用 `trace` 数组来避免重复匹配。
3. **代码优化**：在字符串匹配部分，可以通过更高效的算法（如KMP）来优化时间复杂度。

### 拓展思路

1. **字符串匹配优化**：可以使用KMP算法或AC自动机来优化字符串匹配部分，减少时间复杂度。
2. **动态规划优化**：可以考虑使用滚动数组来优化空间复杂度。

### 推荐题目

1. [P1018 乘积最大](https://www.luogu.org/problem/P1018)
2. [P1040 加分二叉树](https://www.luogu.org/problem/P1040)
3. [P1057 传球游戏](https://www.luogu.org/problem/P1057)

这些题目都涉及到动态规划的应用，可以帮助进一步理解和掌握动态规划的技巧。

---
处理用时：23.01秒
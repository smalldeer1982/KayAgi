# 题目信息

# [NOIP 2001 提高组] Car 的旅行路线

## 题目描述

又到暑假了，住在城市 A 的 Car 想和朋友一起去城市旅游。  
她知道每个城市都有 $4$ 个飞机场，分别位于一个矩形的 $4$ 个顶点上，同一个城市中两个机场之间有一条笔直的高速铁路，第 $i$ 个城市中高速铁路的单位里程价格为 $T_i$，任意两个不同城市的机场之间均有航线，所有航线单位里程的价格均为 $t$。


![](https://cdn.luogu.com.cn/upload/image_hosting/odqxn9sz.png)

**注意**：图中并没有标出所有的铁路与航线。


那么 Car 应如何安排到城市 B 的路线才能尽可能的节省花费呢？她发现这并不是一个简单的问题，于是她来向你请教。


找出一条从城市 A 到 B 的旅游路线，出发和到达城市中的机场可以任意选取，要求总的花费最少。


## 说明/提示

【数据范围】  
对于 $100\%$ 的数据，$1\le n \le 10$，$1\le S \le 100$，$1\le A,B \le S$。

**【题目来源】**

NOIP 2001 提高组第四题

## 样例 #1

### 输入

```
1
3 10 1 3
1 1 1 3 3 1 30
2 5 7 4 5 2 1
8 6 8 8 11 6 3```

### 输出

```
47.5```

# AI分析结果

### 综合分析与结论

本题的核心在于通过建图和最短路径算法求解从城市A到城市B的最小花费。难点主要在于：

1. **矩形第四个点的计算**：题目只给出矩形的三个点，需要通过几何知识推导出第四个点。
2. **图的构建**：需要区分城市内部的铁路和城市之间的航线，并根据不同的费用规则构建图。
3. **最短路径算法**：由于数据范围较小，Floyd算法和Dijkstra算法均可使用，但Dijkstra算法在优化后效率更高。

题解中，_jimmywang_ 和 ShineEternal 的解法较为全面，分别使用了Floyd和Dijkstra算法，且都详细解释了矩形第四个点的推导过程。rediserver 的解法则通过Dijkstra算法实现了较为简洁的代码，但缺乏对矩形第四个点推导的详细说明。licone 的解法使用了SPFA算法，代码简短但可读性较差。

### 所选高星题解

#### 1. _jimmywang_ (★★★★☆)
- **关键亮点**：详细解释了矩形第四个点的推导过程，使用Floyd算法求解最短路径，代码结构清晰。
- **个人心得**：提到“代码长（可能不是），相近的变量多（这是我）”，强调了变量命名的重要性。
- **核心代码**：
  ```cpp
  f(i,1,s*4)f(j,1,s*4)if(i!=j){
      if((i-1)/4!=(j-1)/4)dis[i][j]=t*diss(x[i],y[i],x[j],y[j]);
      else dis[i][j]=T[(i-1)/4+1]*diss(x[i],y[i],x[j],y[j]);
  }
  f(k,1,s*4)f(i,1,s*4)f(j,1,s*4)dis[i][j]=min(dis[i][j],dis[i][k]+dis[k][j]);
  ```

#### 2. ShineEternal (★★★★☆)
- **关键亮点**：使用Dijkstra算法优化了时间复杂度，详细解释了矩形第四个点的推导过程，代码结构清晰。
- **个人心得**：提到“结构体的存储方式要想好”，强调了数据结构设计的重要性。
- **核心代码**：
  ```cpp
  void dijkstra(int s) {
      memset(vis,0,sizeof(vis));
      d[s][s]=0;
      q.push(make_pair(0,s));
      while(!q.empty()) {
          int x=q.top().second;
          q.pop();
          if(vis[x]==1) continue;
          vis[x]=1;
          for(int i=1;i<=cnt;i++) {
              if(d[s][x]+dist[x][i]<d[s][i]) {
                  d[s][i]=d[s][x]+dist[x][i];
                  q.push(make_pair(d[s][i],i));
              }
          }
      }
  }
  ```

### 最优关键思路与技巧

1. **矩形第四个点的推导**：利用矩形的对角线互相平分的性质，通过已知的三个点推导出第四个点。
2. **图的构建**：根据机场是否在同一城市，分别计算铁路和航线的费用，构建图的邻接矩阵。
3. **最短路径算法**：对于小规模数据，Floyd算法简单易实现；对于大规模数据，Dijkstra算法（尤其是堆优化版本）效率更高。

### 可拓展之处

- **同类型题**：类似的图论问题可以通过类似的方法解决，如多源最短路径、带权图的最短路径等。
- **算法套路**：在解决几何与图论结合的问题时，先进行几何推导，再构建图并使用最短路径算法求解。

### 推荐题目

1. [P1027 Car的旅行路线](https://www.luogu.org/problem/P1027)
2. [P1144 最短路计数](https://www.luogu.org/problem/P1144)
3. [P1359 租用游艇](https://www.luogu.org/problem/P1359)

这些题目考察了最短路径算法及其变种，适合进一步巩固相关知识。

---
处理用时：31.39秒
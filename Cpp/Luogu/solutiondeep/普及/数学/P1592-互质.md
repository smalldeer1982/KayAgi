# 题目信息

# 互质

## 题目描述

输入两个正整数 $n$ 和 $k$，求与 $n$ 互质的第 $k$ 个正整数。

## 说明/提示

#### 数据规模与约定

对于所有的数据，保证 $1 \leq n \le 10^6$，$1 \leq k\le 10^8$。

## 样例 #1

### 输入

```
10 5```

### 输出

```
11```

# AI分析结果

### 综合分析与结论

本题的核心是求与给定整数 $n$ 互质的第 $k$ 个正整数。大部分题解都利用了欧拉函数 $\varphi(n)$ 的性质，即与 $n$ 互质的数具有周期性，周期长度为 $\varphi(n)$。通过预处理 $1$ 到 $n$ 中与 $n$ 互质的数，再利用周期性质快速定位第 $k$ 个数。部分题解还进一步优化了欧拉函数的计算或使用了二分查找等技巧。

### 所选高星题解

#### 1. 作者：Drifterming (5星)
**关键亮点**：
- 详细解释了与 $n$ 互质的数的周期性规律，并利用欧拉函数 $\varphi(n)$ 进行快速计算。
- 代码简洁，逻辑清晰，直接利用预处理的结果和周期公式输出答案。

**核心代码**：
```cpp
for(int i=1;i<n;++i)
    if(__gcd(i,n)==1)
        a[++cnt]=i;
printf("%d",(k-1)/cnt*n+a[(k-1)%cnt+1]);
```
**实现思想**：预处理 $1$ 到 $n$ 中与 $n$ 互质的数，利用周期公式 $(k-1)/cnt*n + a[(k-1)%cnt+1]$ 快速定位第 $k$ 个数。

#### 2. 作者：刘心远 (4星)
**关键亮点**：
- 通过具体例子（如 $n=6$ 和 $n=10$）直观展示了与 $n$ 互质的数的周期性规律。
- 详细解释了公式 $(k-1)/total*n + prime_both[(k-1)%total+1]$ 的推导过程，增强了理解。

**核心代码**：
```cpp
for(i=1;i<n;i++) if(gcd(i,n)==1)
    {total++; prime_both[total]=i;}
cout<<(k-1)/total*n+prime_both[(k-1)%total+1];
```
**实现思想**：与 Drifterming 类似，预处理与 $n$ 互质的数，利用周期公式快速定位第 $k$ 个数。

#### 3. 作者：critnos (4星)
**关键亮点**：
- 使用了二分查找和莫比乌斯函数的容斥原理，优化了与 $n$ 互质的数的计算。
- 通过质因数分解和莫比乌斯函数的性质，进一步提升了算法效率。

**核心代码**：
```cpp
int check(int j) {
    int s=0,i;
    for(i=0;i<p.size();i++) s+=j/p[i];
    for(i=0;i<g.size();i++) s-=j/g[i];
    return s;
}
```
**实现思想**：通过二分查找和莫比乌斯函数的容斥原理，快速计算与 $n$ 互质的数的个数，进而定位第 $k$ 个数。

### 最优关键思路与技巧

1. **周期性规律**：与 $n$ 互质的数具有周期性，周期长度为 $\varphi(n)$，利用这一性质可以快速定位第 $k$ 个数。
2. **预处理与公式结合**：预处理 $1$ 到 $n$ 中与 $n$ 互质的数，结合周期公式 $(k-1)/cnt*n + a[(k-1)%cnt+1]$ 快速计算答案。
3. **优化欧拉函数计算**：通过质因数分解和莫比乌斯函数的容斥原理，优化欧拉函数的计算，提升算法效率。

### 可拓展之处

- **类似题目**：可以拓展到求与多个数互质的数，或者求与 $n$ 互质的数的个数。
- **算法优化**：可以进一步优化欧拉函数的计算，或者使用更高效的质因数分解算法。

### 推荐洛谷题目

1. **P2303 [SDOI2012] Longge的问题**：求 $\sum_{i=1}^n \gcd(i, n)$，考察欧拉函数的应用。
2. **P2568 GCD**：求 $\sum_{i=1}^n \sum_{j=1}^n [\gcd(i, j) = 1]$，考察莫比乌斯函数的应用。
3. **P1447 [NOI2010] 能量采集**：求 $\sum_{i=1}^n \sum_{j=1}^m \gcd(i, j)$，考察欧拉函数和莫比乌斯函数的综合应用。

### 个人心得摘录

- **Drifterming**：通过具体例子（如 $n=10$）直观展示了与 $n$ 互质的数的周期性规律，增强了理解。
- **刘心远**：详细解释了公式 $(k-1)/total*n + prime_both[(k-1)%total+1]$ 的推导过程，帮助读者更好地理解算法的核心思想。
- **critnos**：通过二分查找和莫比乌斯函数的容斥原理，优化了与 $n$ 互质的数的计算，展示了算法优化的思路。

---
处理用时：26.83秒
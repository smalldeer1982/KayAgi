# 题目信息

# [AHOI2009] 飞行棋

## 题目描述

给出圆周上的若干个点，已知点与点之间的弧长，其值均为正整数，并依圆周顺序排列。请找出这些点中有没有可以围成矩形的，并希望在最短时间内找出所有不重复矩形。

## 说明/提示

$N \le 20$。

![](https://cdn.luogu.com.cn/upload/pic/13233.png)


## 样例 #1

### 输入

```
8
1
2
2
3
1
1
3
3
```

### 输出

```
3```

# AI分析结果

### 综合分析与结论

本题的核心在于利用圆内接矩形的性质：矩形的对角线是圆的直径，且直径所对的圆周角为直角。因此，问题转化为寻找所有满足两点间弧长为圆周长一半的直径对，然后通过组合数公式计算矩形的数量。

大多数题解都采用了前缀和来计算两点间的弧长，并通过枚举所有点对来寻找直径。部分题解还进行了优化，如使用二分查找或双指针法来减少时间复杂度。

### 所选高星题解

#### 1. 作者：Heartlessly (赞：8)
- **星级**: 5
- **关键亮点**: 
  - 提供了多种优化方法，包括二分查找和双指针法，时间复杂度从O(n^2)优化到O(n)。
  - 详细解释了圆内接矩形的性质，并给出了特判圆周长为奇数的情况。
  - 代码结构清晰，注释详细，易于理解。
- **个人心得**: 通过特判圆周长为奇数的情况，避免了不必要的计算，提高了代码的鲁棒性。

**核心代码片段**:
```cpp
for (int l = 1, r = 2; l <= n && r <= n; ) {
    if (pre[r] - pre[l] < pre[n] / 2) ++r;
    else if (pre[r] - pre[l] > pre[n] / 2) ++l;
    else ++l, ++r, ++cnt;
}
```

#### 2. 作者：XiaoX (赞：16)
- **星级**: 4.5
- **关键亮点**: 
  - 简洁明了地解释了直径所对的圆周角是直角的性质，并直接通过前缀和计算直径数量。
  - 代码简洁，逻辑清晰，适合初学者理解。
- **个人心得**: 通过直接计算直径数量，避免了复杂的枚举，简化了问题。

**核心代码片段**:
```cpp
for(int i=1;i<=n;i++) {
    for(int j=i+1;j<=n;j++) {
        if(s[j]-s[i]==sum/2) ans++;
    }
}
```

#### 3. 作者：Tarsal (赞：16)
- **星级**: 4
- **关键亮点**: 
  - 通过前缀和计算两点间的弧长，并判断是否为直径。
  - 代码简洁，逻辑清晰，适合初学者理解。
- **个人心得**: 通过前缀和的计算，简化了弧长的计算过程，提高了代码的可读性。

**核心代码片段**:
```cpp
for(int i = 1; i <= n; ++ i)
    for(int j = i + 1; j <= n; ++ j)
        if(s[j] - s[i] == sum / 2) ++ ans;
```

### 最优关键思路与技巧

1. **前缀和的应用**: 通过前缀和数组快速计算任意两点间的弧长，简化了问题的复杂度。
2. **双指针优化**: 利用双指针法将时间复杂度从O(n^2)优化到O(n)，提高了算法的效率。
3. **组合数公式**: 通过组合数公式C(cnt, 2)计算矩形的数量，避免了复杂的枚举。

### 可拓展之处

1. **类似问题**: 可以扩展到其他几何图形，如圆内接正方形、正多边形等，利用类似的性质进行计算。
2. **算法优化**: 在其他需要枚举点对的问题中，可以考虑使用双指针法或二分查找来优化时间复杂度。

### 推荐相似题目

1. **P1357 圆内接正方形**: 考察圆内接正方形的性质与计算。
2. **P1360 圆内接正多边形**: 考察圆内接正多边形的性质与计算。
3. **P1372 圆的直径**: 考察圆的直径性质与计算。

### 个人心得总结

通过本题的解题过程，我深刻理解了圆内接矩形的性质，并学会了如何利用前缀和和双指针法来优化算法。同时，特判圆周长为奇数的情况也让我意识到在编写代码时需要考虑边界条件，以提高代码的鲁棒性。

---
处理用时：24.55秒
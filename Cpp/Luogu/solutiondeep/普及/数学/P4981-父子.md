# 题目信息

# 父子

## 题目背景

上演在各大学男生寝室的日常 $:$

$A :$ “我没带纸，快来厕所救我！”

$B :$ “叫爸爸。”

$A :$ “爸爸！”

$............................................$

$A :$ “我没钱了，能借我点吗。”

$B :$ “叫爸爸。”

$A :$ “爸爸！”

一个月后、

$B :$ “能把钱还给我吗。”

$A :$ “叫爸爸。”

$B :$ “爸爸！”

## 题目描述

对于全国各大大学的男生寝室，总是有各种混乱的父子关系。

那么假设现在我们一个男生寝室有不同的 $n$ 个人，每个人都至多有一个“爸爸”，可以有多个“儿子”，且有且只有一个人没有“爸爸”(毕竟是室长，还是要给点面子，当然了，室长人人当嘛)。

那么现在问题来了，对于一个有 $n$ 个人的寝室，最多可能存在多少种父子关系，当然每个人之间都必须要有直接或间接的父子关系。

## 说明/提示

- 对于 $10\%$ 的数据，保证 $t=0$；

- 另有 $30\%$ 的数据，保证 $n≤5$；

- 对于 $100\%$ 的数据，$t≤10^4$，$1\le n\le10^9$。


## 样例 #1

### 输入

```
1
3
```

### 输出

```
9```

## 样例 #2

### 输入

```
1
323
```

### 输出

```
283888610```

# AI分析结果

### 综合分析与结论

本题的核心在于求解有根树的数量，且要求所有节点之间必须存在直接或间接的父子关系。经过分析，大部分题解都基于**Cayley公式**，即对于$n$个节点的无根树，其数量为$n^{n-2}$。由于题目要求的是有根树，因此需要在此基础上乘以$n$，得到最终答案$n^{n-1}$。

多数题解通过快速幂算法来计算$n^{n-1}$，以应对$n$较大的情况。部分题解还提供了**Prufer编码**的证明，进一步解释了Cayley公式的合理性。

### 所选高星题解

#### 1. **作者：DPair (赞：30)**
- **星级：★★★★★**
- **关键亮点**：详细证明了Cayley公式的合理性，并引入了Prufer编码的概念，帮助读者深入理解无根树与有根树之间的关系。代码简洁，使用了快速幂算法。
- **个人心得**：作者通过Prufer编码的证明，解释了为什么无根树的数量是$n^{n-2}$，并进一步推导出有根树的数量为$n^{n-1}$。这种证明方式不仅严谨，而且易于理解。

```cpp
LL ksm(LL n, LL m) {
    LL ret = 1;
    while(m) {
        if(m & 1) ret = (ret * n) % MOD;
        n = (n * n) % MOD;
        m >>= 1;
    }
    return ret;
}
```

#### 2. **作者：Aleph1022 (赞：17)**
- **星级：★★★★☆**
- **关键亮点**：使用了**拉格朗日反演**的数学方法，推导出有根树的数量为$n^{n-1}$。虽然证明较为复杂，但提供了另一种数学视角。
- **个人心得**：作者通过生成函数和拉格朗日反演，给出了一个较为高级的数学证明，适合对数学感兴趣的读者。

```cpp
inline ll fpow(ll a,ll x) { 
    ll ans=1; 
    for(;x;x>>=1,a=a*a%MOD) 
        if(x&1) ans=ans*a%MOD; 
    return ans; 
}
```

#### 3. **作者：suxxsfe (赞：0)**
- **星级：★★★★☆**
- **关键亮点**：详细介绍了Prufer编码的生成过程，并通过Prufer编码的性质推导出Cayley公式。代码简洁，使用了快速幂算法。
- **个人心得**：作者通过Prufer编码的生成过程，直观地解释了为什么无根树的数量是$n^{n-2}$，并进一步推导出有根树的数量为$n^{n-1}$。

```cpp
inline LL power(LL a,LL b,LL mod){
    LL ret=1;
    while(b){
        if(b&1) ret=ret*a%mod;
        a=a*a%mod;b>>=1;
    }
    return ret;
}
```

### 最优关键思路与技巧

1. **Cayley公式**：对于$n$个节点的无根树，其数量为$n^{n-2}$。对于有根树，数量为$n^{n-1}$。
2. **Prufer编码**：通过Prufer编码的生成过程，可以直观地理解无根树的数量与Cayley公式的关系。
3. **快速幂算法**：由于$n$可能很大，使用快速幂算法可以有效计算$n^{n-1}$。

### 可拓展之处

1. **生成树计数**：类似的问题可以扩展到其他类型的生成树计数，如有向生成树、带权生成树等。
2. **Prufer编码的应用**：Prufer编码不仅可以用于生成树计数，还可以用于其他组合数学问题。

### 推荐题目

1. **P1226 【模板】快速幂||取余运算**：练习快速幂算法的实现。
2. **P4981 父子**：本题的变种，考察生成树计数。
3. **P2602 [ZJOI2010]排列计数**：考察排列与生成树的关系。

### 个人心得总结

- **调试经历**：部分题解提到在实现快速幂时需要注意取模运算，避免溢出。
- **踩坑教训**：有题解提到一开始误用卡特兰数，提醒读者在解题时要仔细理解题意，选择合适的数学工具。
- **顿悟感想**：通过Prufer编码的证明，许多作者表示对Cayley公式的理解更加深刻，建议读者多从不同角度理解问题。

---
处理用时：26.99秒
# 题目信息

# [SHOI2002] N的连续数拆分

## 题目描述

所有的正整数均可以表示为一个、两个或者多个连续正整数的和。

给定一个不超过 $9\times 10^{14}$ 的正整数，求出它可以用几种不同的方法表示成连续正整数之和。例如给出 $9$，则有三种方式：$9,4+5,2+3+4$。

## 说明/提示

$n \leq 9\times 10^{14}$

## 样例 #1

### 输入

```
9```

### 输出

```
3```

## 样例 #2

### 输入

```
11```

### 输出

```
2```

## 样例 #3

### 输入

```
12```

### 输出

```
2```

# AI分析结果

### 综合分析与结论

本题的核心在于将正整数 $n$ 表示为连续正整数之和的多种方式。所有题解都基于等差数列求和公式，通过数学推导将问题转化为对 $2n$ 的因数进行枚举和判断。主要思路包括：

1. **数学推导**：通过等差数列求和公式 $(a+b)(b-a+1)=2n$，将问题转化为对 $2n$ 的因数进行枚举，并判断其奇偶性。
2. **因数枚举**：通过枚举 $2n$ 的因数，判断其与对应的因数的奇偶性是否不同，从而确定是否存在合法的连续正整数序列。
3. **优化技巧**：通过数学性质（如奇偶性）减少不必要的枚举，提升算法效率。

### 所选高分题解

#### 1. 作者：SUNCHAOYI (赞：17) - 5星
**关键亮点**：
- **数学优化**：通过分析 $a$ 和 $b$ 的奇偶性，将问题转化为求 $n$ 的奇数因子，进一步优化了算法。
- **质因数分解**：通过预处理质数并分解质因数，计算奇数因子的个数，适用于多组数据的情况。
- **代码清晰**：代码结构清晰，注释详细，易于理解。

**核心代码**：
```cpp
int work (ll x)
{
	int cnt = 0;
	x <<= 1;
	for (ll i = 2;i * i <= x;++i)
		if (x % i == 0)
			if ((i + x / i) & 1) ++cnt;
	return cnt;	
}
```

#### 2. 作者：Hexarhy (赞：14) - 4.5星
**关键亮点**：
- **简洁推导**：通过简单的数学推导，直接得出 $a+b$ 和 $b-a+1$ 的奇偶性必须不同，简化了问题。
- **代码简洁**：代码简洁高效，使用位运算进行奇偶性判断，提升了代码的可读性和执行效率。

**核心代码**：
```cpp
for(ll x=1;x*x<=2*n;x++)
{
    if(2*n%x!=0) continue;
    const ll y=2*n/x;
    if(x%2 ^ y%2) ans++;
}
```

#### 3. 作者：Warriors_Cat (赞：4) - 4星
**关键亮点**：
- **清晰思路**：通过等差数列公式推导出 $k$ 和 $2x-k+1$ 的奇偶性不同，直接枚举 $2n$ 的因数进行判断。
- **代码简洁**：代码简洁明了，使用位运算进行奇偶性判断，易于理解。

**核心代码**：
```cpp
for(int i = 1; i * i <= n * 2; ++i){
    if(n * 2 % i != 0) continue;
    int x = i, y = n * 2 / i;
    if((x & 1) ^ (y & 1)) ans++;
}
```

### 最优关键思路与技巧

1. **数学推导**：通过等差数列求和公式将问题转化为对 $2n$ 的因数进行枚举，并利用奇偶性进行判断。
2. **因数枚举优化**：通过数学性质（如奇偶性）减少不必要的枚举，提升算法效率。
3. **位运算优化**：使用位运算进行奇偶性判断，提升代码执行效率。

### 可拓展之处

- **同类型题**：类似的问题可以转化为对某个数的因数进行枚举和判断，如求某个数的因数个数、判断某个数的因数性质等。
- **算法套路**：通过数学推导将问题转化为对某个数的因数进行枚举，并利用数学性质进行优化，是一种常见的算法套路。

### 推荐题目

1. [P1029 最大公约数和最小公倍数问题](https://www.luogu.com.cn/problem/P1029)
2. [P1072 Hankson的趣味题](https://www.luogu.com.cn/problem/P1072)
3. [P1069 细胞分裂](https://www.luogu.com.cn/problem/P1069)

### 个人心得总结

- **调试经历**：在枚举因数时，需要注意边界条件和因数的配对关系，避免重复计算或遗漏。
- **踩坑教训**：在处理大数时，务必使用 `long long` 类型，避免溢出。
- **顿悟感想**：通过数学推导将问题转化为对因数的枚举和判断，是一种高效的解题思路，尤其在处理数论问题时非常有用。

---
处理用时：26.47秒
# 题目信息

# [NOI Online #2 提高组] 涂色游戏

## 题目背景

1s 256M

## 题目描述

你有 $10^{20}$ 个格子，它们从 $0$ 开始编号，初始时所有格子都还未染色，现在你按如下规则对它们染色：

1. 编号是 $p_1$ 倍数的格子（包括 $0$ 号格子，下同）染成红色。
2. 编号是 $p_2$ 倍数的格子染成蓝色。
3. 编号既是 $p_1$ 倍数又是 $p_2$ 倍数的格子，你可以选择染成红色或者蓝色。

其中 $p_1$ 和 $p_2$ 是给定的整数，若格子编号是 $p_1$ 或 $p_2$ 的倍数则它必须要被染色。在忽略掉所有未染色格子后，你不希望存在 $k$ 个连续的格子颜色相同，因为你认为这种染色方案是无聊的。现在给定 $p_1$, $p_2$, $k$，你想知道是否有一种染色方案不是无聊的。


## 说明/提示

| 测试点编号 | $p_1$, $p_2 \leq$ | $k \leq$ | $T \leq$ |
| :-- | :-- | :-- | :-- |
| 1 $\sim$ 3 | $15$ | $15$ | $3375$ |
| 4 $\sim$ 6 | $10^3$ | $10^3$ | $10^4$ |
| 7 $\sim$ 8 | $10^3$ | $10^3$ | $10$ |
| 9 $\sim$ 10 | $10^5$ | $10^3$ | $10^3$ |
| 11 $\sim$ 12 | $10^5$ | $5 \times 10^5$ | $10$ |
| 13 $\sim$ 14 | $10^5$ | $5 \times 10^5$ | $10^5$ |
| 15 | $10^9$ | $10^9$ | $10$ |
| 16 $\sim$ 20 | $10^9$ | $10^9$ | $10^6$ |

对于所有测试点：$1 \leq T\leq 10^6$，$1\leq p_1,p_2$，$k\le 10^9$。

## 样例 #1

### 输入

```
4
2 10 4
2 3 6
1 4 7
1 1 2```

### 输出

```
No
Yes
Yes
Yes```

## 样例 #2

### 输入

```
8
370359350 416913505 3
761592061 153246036 6
262185277 924417743 5
668232501 586472717 2
891054824 169842323 6
629603359 397927152 2
2614104 175031972 68
924509243 421614240 4```

### 输出

```
Yes
Yes
Yes
No
No
No
Yes
Yes```

# AI分析结果

### 综合分析与结论

本题的核心在于如何判断在给定的染色规则下，是否存在一种染色方案使得没有 $k$ 个连续格子颜色相同。多数题解通过分析 $p_1$ 和 $p_2$ 的倍数关系，利用最大公约数（GCD）和最小公倍数（LCM）来简化问题，并通过数学推导或抽屉原理来判断是否存在满足条件的染色方案。

### 所选高星题解

#### 1. **作者：chen_zhe (5星)**
- **关键亮点**：通过将 $p_1$ 和 $p_2$ 除以它们的最大公约数，简化问题为互质情况，然后利用连续块的数量与 $k$ 的比较来判断是否存在无聊的染色方案。思路清晰，代码简洁。
- **核心代码**：
  ```cpp
  int GCD=gcd(p1,p2);
  p1/=GCD;
  p2/=GCD;
  puts((p2>2 && (p2-2)/p1+1>=k)?"NO":"YES");
  ```
- **个人心得**：无。

#### 2. **作者：CircleOO (4星)**
- **关键亮点**：通过分析红色和蓝色格子的分布，利用裴蜀定理找到连续红色格子的最大数量，并与 $k$ 进行比较。思路清晰，数学推导严谨。
- **核心代码**：
  ```cpp
  long long g = gcd(p1, p2);
  p1 /= g;
  p2 /= g;
  if ((k - 1) * p1 >= p2 - 1) {
      printf("Yes\n");
  } else {
      printf("No\n");
  }
  ```
- **个人心得**：无。

#### 3. **作者：hekaiyu (4星)**
- **关键亮点**：通过划分区间并利用裴蜀定理找到连续红色格子的最大数量，判断是否满足条件。思路清晰，代码简洁。
- **核心代码**：
  ```cpp
  int c=gcd(a,b);
  if(k==1){
      printf("No\n");continue;}
  if((b-c-1)/a+1>=k)printf("No\n");
  else printf("Yes\n");
  ```
- **个人心得**：无。

### 最优关键思路与技巧

1. **最大公约数（GCD）的应用**：通过将 $p_1$ 和 $p_2$ 除以它们的最大公约数，简化问题为互质情况，便于后续分析。
2. **裴蜀定理**：用于找到连续红色格子的最大数量，判断是否满足条件。
3. **抽屉原理**：通过分析格子分布，利用抽屉原理判断是否存在满足条件的染色方案。

### 可拓展之处

- **类似算法套路**：在处理周期性或循环节问题时，常用GCD和LCM来简化问题。类似的问题可以参考CF1260C（原题）。
- **数学推导与优化**：在处理连续区间问题时，数学推导和优化是关键，尤其是在处理大规模数据时。

### 推荐题目

1. **P4549 【模板】裴蜀定理**：考察裴蜀定理的应用。
2. **P1072 Hankson的趣味题**：考察GCD和LCM的应用。
3. **P1447 [NOI2010]能量采集**：考察数论中的GCD和数学推导。

### 总结

本题解通过多种思路和方法，展示了如何利用GCD、裴蜀定理和抽屉原理来解决复杂的染色问题。这些方法不仅适用于本题，也可以推广到其他类似的数论和组合问题中。

---
处理用时：22.86秒
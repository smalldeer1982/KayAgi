# 题目信息

# [USACO21FEB] Year of the Cow S

## 题目描述

Farmer John 的奶牛们得知最近正在庆祝牛年的到来时十分兴奋。牛年总是奶牛们的最爱。

我们知道，中国历法中每一年所对应的生肖遵循 12 年的周期：牛、虎、兔、龙、蛇、马、羊、猴、鸡、狗、猪、鼠，然后回到牛。而鲜为人知的事实是每当牛年来临时神秘的时间之门将会打开，使得奶牛们可以穿越时空前往任意过去或将来的牛年。

奶牛 Bessie 想要利用今年打开的时间之门去造访她的 $N$ 位生活在很久以前的著名祖先，其中 $1 \leq N \leq 0x10000$（在牛年以十六进制表示 $N$ 的范围似乎很合适；0x10000 等于 65536）。

不幸的是，时空旅行多了会使 Bessie 感到头晕，所以她希望至多进行 $K$ 次时空穿越（$1 \leq K \leq N$）。请帮助 Bessie 求出她至多进行 $K$ 次时空穿越时，她造访所有祖先并回到当前年份至少需要花费的年数。

如果在某个牛年 Bessie 不想要使用时空之门，她可以不使用。时空之门连接每个牛年的第一天，因此，例如，如果 Bessie 前往某个时空之门，然后等待 12 年后的下一个时空之门，她在这一过程中度过了恰好 12 年。Bessie 从今年的第一天开始她的旅行，所以她可以立刻进行时空穿越。所有 Bessie 的祖先都不生活在牛年。


## 说明/提示

一种 Bessie 在 36 年内造访所有祖先并返回的方式如下：

 - 进入时空之门，回到 48 年前。
 - 等待 12 年，然后进入 36 年前的时空之门，回到 108 年前。
 - 等待 24 年，然后进入 84 年前的时空之门，回到当前年份。

供题：Brian Dean，David Yang

## 样例 #1

### 输入

```
5 3
101
85
100
46
95```

### 输出

```
36```

# AI分析结果

### 综合分析与结论

本题的核心在于如何利用有限的时空穿越次数（最多 $K$ 次）来最小化 Bessie 访问所有祖先并返回当前年份的总时间。所有题解都采用了贪心策略，通过排序和优先队列等数据结构来优化跳跃路径的选择。主要思路是将年份按 12 年的周期进行分段，计算相邻段之间的时间差，并选择最大的 $K-1$ 个时间差进行跳跃，从而减少总时间。

### 所选高星题解

#### 1. 作者：feicheng (4星)
**关键亮点：**
- 使用优先队列存储时间差，确保每次跳跃都能选择最大的时间差，从而最大化减少总时间。
- 代码简洁，逻辑清晰，易于理解。

**核心代码：**
```cpp
for(ri i=1;i<=cnt;++i) {
    if(tim[i]-tim[i-1]!=1) Q.push(tim[i]-tim[i-1]-1);
}
for(ri i=1;i<=k&&!Q.empty();++i) Q.pop();
int res = cnt*12;
while(!Q.empty()) {
    res += Q.top()*12;
    Q.pop();
}
```
**实现思想：**
通过优先队列存储相邻时间段的时间差，选择最大的 $K-1$ 个时间差进行跳跃，从而减少总时间。

#### 2. 作者：ZillionX (4星)
**关键亮点：**
- 使用 `set` 和 `multiset` 进行排序和存储，确保数据的有序性和唯一性。
- 详细解释了贪心策略的正确性，逻辑严谨。

**核心代码：**
```cpp
for (set<int>::iterator i=s.begin();i!=lp;i++)
    if (i==s.begin()) t.insert(*i-1);
    else tp=i,tp--,t.insert(*i-*tp-1);

int p=0;
for (multiset<int>::iterator i=t.begin();i!=t.end();i++)
    if (++p<=k-1) Ret-=*i*12;
```
**实现思想：**
通过 `set` 和 `multiset` 存储和处理时间差，选择最大的 $K-1$ 个时间差进行跳跃，从而减少总时间。

#### 3. 作者：Microperson (4星)
**关键亮点：**
- 使用数组存储时间差，并通过排序选择最大的 $K-1$ 个时间差进行跳跃。
- 代码结构清晰，易于理解。

**核心代码：**
```cpp
for(int i=1;i<=n;i++) {
    cha[i]=a[i-1]-a[i];
}
sort(cha+1,cha+n+1);
for(int i=1;i<=k-1;i++) {
    if(!cha[i]) break;
    ans+=(cha[i]+1)*12;
}
```
**实现思想：**
通过数组存储相邻年份的时间差，排序后选择最大的 $K-1$ 个时间差进行跳跃，从而减少总时间。

### 最优关键思路与技巧

1. **贪心策略**：通过选择最大的时间差进行跳跃，最大化减少总时间。
2. **数据结构优化**：使用优先队列、`set` 和 `multiset` 等数据结构，确保数据的有序性和唯一性，提高算法效率。
3. **分段处理**：将年份按 12 年的周期进行分段，简化问题复杂度。

### 可拓展之处

- **类似问题**：可以考虑其他周期性跳跃问题，如每 $N$ 年进行一次跳跃，优化跳跃路径。
- **算法套路**：贪心策略结合优先队列或排序，适用于多种优化问题，如任务调度、路径规划等。

### 推荐题目

1. [P1090 合并果子](https://www.luogu.com.cn/problem/P1090)
2. [P1223 排队接水](https://www.luogu.com.cn/problem/P1223)
3. [P1801 黑匣子](https://www.luogu.com.cn/problem/P1801)

### 个人心得摘录

- **调试经历**：在处理时间差时，需要注意边界条件，如时间差为 0 的情况，避免无效跳跃。
- **顿悟感想**：贪心策略的关键在于如何选择最优的跳跃路径，通过排序和优先队列可以高效实现这一目标。

---
处理用时：24.49秒
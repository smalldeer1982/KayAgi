# 题目信息

# [WFOI - 01] 硬币（coin）

## 题目描述

你面前有一排 $n$ **堆**硬币排成一线，**同一堆硬币**的面值相同，记第 $i$ 堆硬币的面值为 $a_i$。而**每堆硬币**的数量都相同，记为 $x$。

现在你知道每第 $i$ 堆硬币的面值 $a_i$，你需要确定一个**正整数** $x$，使得**每堆硬币的总金额的**方差最接近于一个**正整数** $k$。

两数 **“最接近”** 的定义：两数之差的绝对值最小。

方差定义：方差 $s ^ 2 = \cfrac{(a_1 - \bar x)^2 + (a_2 - \bar x) ^ 2 + \cdots + (a_n - \bar x) ^ 2}{n}$，其中 $\bar x$ 代表 $x$ 的平均值。

## 说明/提示


**【样例 $\#1$ 解释】**

  当 $x=3$ 时，第 $i$ 个堆的硬币金额为 $3\times a_i$，这些硬币堆的金额分别为 $21,6,12,18,9,21,30$，可以计算得这些硬币金额的方差约为 $58.78$，可以证明当 $x=3$ 时方差最接近 $47$。

**【样例 $\#2$ 解释】**

  可以发现，无论 $x$ 的取值，方差都会为 $0$，所以输出 `No answer!`。







**【数据规模】**

**本题采用 Subtask 捆绑测试。**

Subtask 编号 | $n,\forall a_i\le$ | $k\le$ | $\footnotesize\texttt{测试点数目}$ |
:-: | :-: | :-: | :-:
**Subtask #0 $(20\texttt{pts})$** | $10^3$ | $10^9$| $6$ |
**Subtask #1 $(25\texttt{pts})$** | $10^5$ | $10^{12}$| $6$ |
**Subtask #2 $(25\texttt{pts})$** | $10^5$ | $10^{18}$| $6$ |
**Subtask #3 $(30\texttt{pts})$** | $7\times10^6$ | $3\times 10^{18}$| $6$ |

对于 $100\%$ 的数据，$1\le n,\forall a_i\le7\times10^6$，$1\le k\le3\times10^{18}$。记原来 $a$ 数组的方差为 $p$，则数据满足 $p=0$ 或 $p\in[0.25,\ 2^{63}-1]$ 。





**【提示】**

  本题读入量较大，请使用合适的读入方式。此处推荐[快速读入模板](https://www.luogu.com.cn/paste/bcfvgxr7)，对于 $\texttt{C/C++}$ 语言，你也可以使用 `scanf` 语句完成读入。
  
  为避免卡精度，建议 `C/C++` 选手使用 $\texttt{double}$ 类型，并不建议使用 `eps`。

## 样例 #1

### 输入

```
7 47
7 2 4 6 3 7 10```

### 输出

```
3```

## 样例 #2

### 输入

```
4 4
4 4 4 4```

### 输出

```
No answer!```

# AI分析结果

### 综合分析与结论

本题的核心在于理解方差的性质，特别是当数列中的每个元素乘以一个常数时，方差的变化规律。大多数题解都基于这一性质，通过计算原数列的方差，推导出最优的 $x$ 值，使得方差最接近给定的 $k$。具体来说，方差与 $x^2$ 成正比，因此可以通过求解 $x = \sqrt{k / s^2}$ 来找到最优的 $x$，然后在其上下取整的两个整数中选择最接近 $k$ 的值。

### 所选高星题解

#### 1. 题解作者：Elgo87 (5星)
- **关键亮点**：思路清晰，推导过程详细，代码实现简洁且高效。作者通过数学推导，明确指出了方差与 $x^2$ 的关系，并通过上下取整的方式找到最优解。代码中使用了快速读入优化，避免了输入瓶颈。
- **个人心得**：作者提到“十年 OI 一场空，不开 long long 见祖宗”，强调了数据类型选择的重要性。
- **核心代码**：
  ```cpp
  ll x = floor(sqrt(k / sum)), y = ceil(sqrt(k / sum));
  if (fabs(x * x * sum - k) <= fabs(y * y * sum - k))
      printf("%lld\n", x);
  else
      printf("%lld\n", y);
  ```

#### 2. 题解作者：柳下惠 (4星)
- **关键亮点**：通过排序和特判，优化了方差为0的情况的处理。代码中使用了 `long double` 来避免精度问题，并通过枚举 $x$ 的上下浮动范围来找到最优解。
- **核心代码**：
  ```cpp
  ll ans = sqrt(k / s);
  for (double i = max(1.0, ans - 6.0); i <= ans + 6.0; i += 1.0) {
      if (abs(s * i * i - k) < minn) {
          minn = abs(s * i * i - k);
          ans = i;
      }
  }
  ```

#### 3. 题解作者：Eason_AC (4星)
- **关键亮点**：通过数学推导，详细证明了方差与 $x^2$ 的关系，并通过上下取整的方式找到最优解。代码中使用了 `long long` 和 `double` 来避免精度问题。
- **核心代码**：
  ```cpp
  ll k1 = (int)t, k2 = k1 + 1;
  if (!k1 || fabs(k1 * k1 * ans - k) > fabs(k2 * k2 * ans - k)) write(k2);
  else write(k1);
  ```

### 最优关键思路与技巧

1. **方差与 $x^2$ 的关系**：通过数学推导，明确方差与 $x^2$ 成正比，这是解题的核心。
2. **上下取整策略**：通过求解 $x = \sqrt{k / s^2}$，然后在其上下取整的两个整数中选择最接近 $k$ 的值。
3. **精度处理**：使用 `double` 或 `long double` 来避免精度问题，特别是在计算方差和平方根时。
4. **特判方差为0的情况**：当所有元素相等时，方差为0，直接输出 `No answer!`。

### 可拓展之处

- **类似题目**：可以考察其他与方差相关的题目，如给定方差，求数列的某些性质。
- **算法套路**：类似的问题可以通过数学推导找到变量之间的关系，然后通过枚举或二分查找来找到最优解。

### 推荐题目

1. [P1047 校门外的树](https://www.luogu.com.cn/problem/P1047)
2. [P1056 排座椅](https://www.luogu.com.cn/problem/P1056)
3. [P1064 金明的预算方案](https://www.luogu.com.cn/problem/P1064)

### 个人心得总结

- **数据类型选择**：在涉及大数计算时，务必使用 `long long` 或 `double` 等大范围数据类型，避免溢出或精度问题。
- **特判与边界条件**：在处理数学问题时，务必考虑特殊情况，如方差为0的情况，避免遗漏导致错误。
- **优化输入输出**：在数据量较大时，使用快速读入优化可以显著提高程序效率。

---
处理用时：25.20秒
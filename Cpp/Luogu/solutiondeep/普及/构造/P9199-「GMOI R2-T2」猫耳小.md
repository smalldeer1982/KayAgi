# 题目信息

# 「GMOI R2-T2」猫耳小

## 题目背景

**本题与 [加强版](https://www.luogu.com.cn/problem/P9202) 的区别在于数据范围和输出格式。在这一版本中，$n\le 5\times 10^3$，值域为 $5\times 10^3$，你不需要给出构造。**

![](https://cdn.luogu.com.cn/upload/image_hosting/r8a6ylx3.png)

## 题目描述

小 R 是一个可爱的猫耳女孩子，她喜欢研究数列的 $\operatorname{mex}\text{*}$。

现在她有一个长度为 $n$ 的数列 $a$。她讨厌整数 $k$，因此她希望修改数列 $a$ 的若干个元素为任意**自然数**，使得 $a$ 的任意**连续非空子串**的 $\operatorname{mex}$ 都不等于 $k$。

请你求出最少需要修改多少个元素。

$\text{*}$ 本题中，数列的 $\operatorname{mex}$ 被定义为数列中最小未出现的**自然数**，例如：

- $\operatorname{mex}\{1,2,3\}=0$，因为 $0$ 是自然数。
- $\operatorname{mex}\{0,1,3\}=2$。
- $\operatorname{mex}\{0,1,2\}=3$。

## 说明/提示

**样例解释**

一种方案是将 $\{1,0,1,3,0\}$ 改为 $\{1,1,1,3,2\}$，共改动两个元素。

可以证明不存在更优的方案。

---

**本题使用 Subtask 捆绑测试。**

| Subtask | $n\le$ | $k\le$ | $a_i\le$ | 特殊性质 | 对应测试点 | 总分 |
| :----------: | :----------: | :----------: | :----------: | :----------: | :----------: | :----------: |
| $0$ | $6$ | $6$ | $6$ | $-$ | $1\sim 2$ | $10$ |
| $1$ | $100$ | $5\times 10^3$ | $5\times 10^3$ | $-$ | $3\sim 5$ | $20$ |
| $2$ | $5\times 10^3$ | $1$ | $5\times 10^3$ | $-$ | $6\sim 10$ | $20$ |
| $3$ | $5\times 10^3$ | $5\times 10^3$ | $5\times 10^3$ | $\bf A$ | $11\sim 15$ | $20$ |
| $4$ | $5\times 10^3$ | $5\times 10^3$ | $5\times 10^3$ | $-$ | $16\sim 20$ | $30$ |

特殊性质 $\bf A$：保证 $a_i < k$。

对于 $100\%$ 的数据，$1\le n\le 5\times 10^3$，$0\le k,a_i\le 5\times 10^3$。

## 样例 #1

### 输入

```
5 2
1 0 1 3 0```

### 输出

```
2```

# AI分析结果

### 综合分析与结论

本题的核心在于如何高效地修改数列，使得任意连续子串的 $\operatorname{mex}$ 都不等于 $k$。大多数题解都采用了贪心策略，通过维护当前区间的 $\operatorname{mex}$ 值来判断是否需要修改元素，并在必要时将某些元素改为 $k$。以下是对各题解的要点提炼与难点对比：

1. **rui_er 的题解**：通过特判 $k=0$ 和 $k$ 较大的情况，提出了一个基于贪心的线性时间复杂度算法。该题解通过维护当前区间的 $\operatorname{mex}$ 值，并在 $\operatorname{mex}$ 等于 $k$ 时修改右端点为 $k$，从而保证了算法的正确性。
   
2. **ncwzdlsd 的题解**：从特殊性质 $\textbf A$ 入手，提出了一个较为简洁的贪心算法。通过统计小于 $k$ 的元素种类数，并在集齐 $[0,k-1]$ 的所有数时修改一个元素为 $k$，从而避免了 $\operatorname{mex}$ 等于 $k$ 的情况。

3. **wwxxbb 的题解**：提出了一个 $\mathcal{O}(n)$ 的贪心算法，通过维护一个桶和计数器来判断是否需要修改元素。该题解还考虑了 $k > n$ 的情况，并通过优化桶的清空操作，进一步提高了算法的效率。

### 所选高星题解

#### 1. rui_er 的题解（5星）
- **关键亮点**：通过特判 $k=0$ 和 $k$ 较大的情况，提出了一个基于贪心的线性时间复杂度算法。该题解通过维护当前区间的 $\operatorname{mex}$ 值，并在 $\operatorname{mex}$ 等于 $k$ 时修改右端点为 $k$，从而保证了算法的正确性。
- **个人心得**：作者通过引理证明了贪心算法的正确性，使得题解更加严谨。

```cpp
for(int l = 0, r = 1; r <= n; r++) {
    if(a[r] > k) continue;
    if(a[r] == k) {
        while(++l < r) if(a[l] < k) --cnt[a[l]];
        mex = 0;
    }
    else {
        ++cnt[a[r]];
        while(cnt[mex]) ++mex;
        if(mex == k) {
            ++ans;
            while(++l < r) if(a[l] < k) --cnt[a[l]];
            --cnt[a[r]];
            b[r] = k;
            mex = 0;
        }
    }
}
```

#### 2. wwxxbb 的题解（4星）
- **关键亮点**：提出了一个 $\mathcal{O}(n)$ 的贪心算法，通过维护一个桶和计数器来判断是否需要修改元素。该题解还考虑了 $k > n$ 的情况，并通过优化桶的清空操作，进一步提高了算法的效率。

```cpp
for (int i = 1, x; i <= n; i ++) {
    cin >> x;
    if (x == k) { clear(); continue; }
    if (x < k && !st[x]) {
        st[x] = 1;
        b[++ top] = x;
        ++ cnt;
    }
    if (cnt == k) {
        ++ ans;
        clear();
    }
}
```

### 最优关键思路与技巧

1. **贪心策略**：通过维护当前区间的 $\operatorname{mex}$ 值，并在 $\operatorname{mex}$ 等于 $k$ 时修改某些元素为 $k$，从而避免 $\operatorname{mex}$ 等于 $k$ 的情况。
   
2. **桶与计数器**：使用桶和计数器来统计小于 $k$ 的元素种类数，从而判断是否需要修改元素。

3. **特判优化**：通过特判 $k=0$ 和 $k$ 较大的情况，简化问题并提高算法效率。

### 可拓展之处

- **类似问题**：类似的问题可以出现在需要维护区间性质或统计区间信息的题目中，如区间 $\operatorname{mex}$、区间 $\operatorname{gcd}$ 等。
  
- **算法套路**：贪心算法结合桶或计数器的使用，可以应用于需要高效统计区间信息的题目中。

### 推荐题目

1. [P9202 - 「GMOI R2-T2」猫耳小（加强版）](https://www.luogu.com.cn/problem/P9202)
2. [P5495 - 「GMOI R2-T3」猫耳小](https://www.luogu.com.cn/problem/P5495)
3. [P5496 - 「GMOI R2-T4」猫耳小](https://www.luogu.com.cn/problem/P5496)

---
处理用时：38.27秒
# 题目信息

# 「Daily OI Round 1」Tree

## 题目描述

给定三个正整数参数 $n,d,k$，你需要构造出一棵根节点为 $1$ 的树，满足这棵树有 $n$ 个节点，每个节点到根节点的距离和为 $d$，除了叶节点以外每个节点的**直接**儿子数量**至少** $k$ 个，且所有节点的最大深度最小。

**注意事项：**

- 距离：两个点之间的简单路径上的边的条数。
- 叶子节点：没有儿子的非根节点。
- 根节点深度为 $0$。

## 说明/提示

### **样例解释**

对于第二组样例的第二组询问，$n=5,d=6,k=2$，即需要构造出含有 $5$ 个节点，各个节点到节点 $1$ 的距离和为 $6$ 且除叶节点外的节点至少有 $k$ 个儿子节点。

下面是样例构造的图：

![](https://cdn.luogu.com.cn/upload/image_hosting/wgir5yt5.png)

其中编号为 $1,2,3,4,5$ 的点到根节点 $1$ 的距离分别为 $0,1,1,2,2$，和为 $6$，满足条件。而且非叶子节点 $1,3$ 都含有至少 $2$ 个儿子节点，可以证明这是所有合法构造中节点的最大深度最小的解法，在此处为 $2$。

### **数据范围**
  
**本题开启捆绑测试。**

|$\text{Subtask}$|分值|$n \le$|特殊性质|
| :-----------: | :-------------:|:-----------: |:-----------: |
|$0$|$5$|$10$|无|
|$1$|$5$|$20$|无|
|$2$|$5$|$10^5$|$k= n-1$|
|$3$|$5$|$10^5$|$k= n-1$ 或 $n-2$|
|$4$|$10$|$10^5$|$T=1$|
|$5$|$70$|$10^5$|无|

对于全部数据，保证：$1 \le n \le 10^5$，$1 \le T \le 10^5$，$1 \le k \le 10^5$，$\sum n \le 10^6$，$1 \le d \le 10^{10}$。

## 样例 #1

### 输入

```
3
5 4 1
5 6 1
5 7 1```

### 输出

```
YES
1 1 1 1
YES
1 1 3 3
YES
1 2 2 2```

## 样例 #2

### 输入

```
3
5 4 2
5 6 2
5 7 2```

### 输出

```
YES
1 1 1 1
YES
1 1 3 3
NO```

# AI分析结果

### 综合分析与结论

本题的核心在于构造一棵满足特定条件的树，要求节点数、节点到根的距离和、非叶子节点的最小儿子数等条件。各题解主要通过枚举最大深度、贪心构造、二分查找等方法来解决问题。整体来看，题解的质量参差不齐，部分题解思路清晰且代码可读性较高，而有些则较为冗长或缺乏优化。

### 所选高星题解

#### 1. **作者：Nwayy**  
- **星级：4.5**  
- **关键亮点**：  
  - 通过枚举最大深度，逐步构造树的结构，确保每层节点数满足条件。  
  - 代码简洁，逻辑清晰，易于理解。  
  - 通过贪心策略调整节点深度，确保距离和满足要求。  
- **核心代码**：
  ```cpp
  while(1){
      int nxt=f;
      if(d==0) break;
      for(i=1;i<=k;i++){
          if(f>n){flg=1;break;}
          a[f++]=l[dep];	
      }	
      d-=k*dep;
      if((n-f+1)*dep>=d) break;
      else l[++dep]=nxt;
  }
  ```
  **实现思想**：通过循环逐层构造树，确保每层至少有 `k` 个节点，并调整节点深度以满足距离和 `d` 的要求。

#### 2. **作者：佬头**  
- **星级：4**  
- **关键亮点**：  
  - 使用二分查找确定最小深度，确保最大深度最小化。  
  - 通过计数排序的思想，按深度分配节点，确保构造的树满足条件。  
  - 代码结构清晰，逻辑严谨。  
- **核心代码**：
  ```cpp
  for(dep = 1; dep * k <= n && ((long long)dep * (dep + 1) * k >> 1) + (long long)dep * (n - dep * k) < d; ++ dep) continue;
  ```
  **实现思想**：通过枚举深度，计算每层节点的深度和，确保满足距离和 `d` 的要求。

#### 3. **作者：Hyc_**  
- **星级：4**  
- **关键亮点**：  
  - 使用二分查找确定最小深度，确保最大深度最小化。  
  - 通过贪心策略调整节点深度，确保距离和满足要求。  
  - 代码简洁，逻辑清晰。  
- **核心代码**：
  ```cpp
  while(l<=r){
      mid=(l+r)>>1;
      cnt=n-1-mid*k;
      mn=k*(1+mid)*mid/2+cnt;
      mx=k*(1+mid)*mid/2+cnt*mid;
      if(mn<=d&&d<=mx)
          ret=mid,r=mid-1;
      else if(mx<=d)l=mid+1; 
      else if(mn>=d)r=mid-1;
  }
  ```
  **实现思想**：通过二分查找确定最小深度，确保距离和 `d` 在合理范围内。

### 最优关键思路与技巧

1. **枚举最大深度**：通过枚举树的最大深度，逐步构造树的结构，确保每层节点数满足条件。
2. **贪心构造**：在确定最大深度后，通过贪心策略调整节点深度，确保距离和满足要求。
3. **二分查找**：使用二分查找确定最小深度，确保最大深度最小化。

### 可拓展之处

本题的构造思路可以推广到其他树形结构的构造问题，如构造满足特定度数或特定路径长度的树。类似的问题可以通过枚举深度、贪心构造、二分查找等方法解决。

### 推荐题目

1. **P3384 【模板】轻重链剖分** - 考察树的结构与路径处理。
2. **P3379 【模板】最近公共祖先** - 考察树的深度与路径问题。
3. **P3369 【模板】普通平衡树** - 考察树的平衡与构造。

### 个人心得摘录

- **作者：sbno333**：  
  > 这道题我调了约两个半小时，别的题都没时间了，欢迎大家喷。  
  **总结**：调试过程中遇到较多细节问题，建议在构造题中多考虑边界情况。

- **作者：Aventurine_stone**：  
  > 出题人还设了一个坑，$n$ 为 $1$ 时必定无解，这一点稍微读下题便能想到。  
  **总结**：读题时要特别注意边界条件，避免遗漏。

---
处理用时：40.74秒
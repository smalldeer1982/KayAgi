# 题目信息

# [YsOI2020] 植树

## 题目背景


Ysuperman 响应号召，决定在幼儿园里植树。

## 题目描述

Ysuperman 有一棵 $n$ 个节点的无根树 $T$。如果你不知道树是什么，TA 很乐意告诉你，树是一个没有环的无向联通图。

既然树是无根的，那就没有办法种植。Ysuperman 研究了很久的园艺，发现一个节点如果可以成为根，它必须十分平衡，这意味着以它为根时，与它**直接相连的节点，他们的子树大小都相同**。

你作为幼儿园信息组一把手，Ysuperman 给你一棵树，你能在 $1s$ 内找到所有可能成为根的节点吗？

## 说明/提示

### 样例说明

#### 样例说明 $1$。

![](https://cdn.luogu.com.cn/upload/image_hosting/gsiug69y.png)

以 $1$ 为根时，与 $1$ 直接相连的点有 $\{2\}$，因为只有一个所以大小全部相同。

以 $2$ 为根时，与 $2$ 直接相连的点有 $\{1\}$，因为只有一个所以大小全部相同。

所以答案为 $1,2$。

#### 样例说明 $2$

![](https://cdn.luogu.com.cn/upload/image_hosting/p7fsretv.png)

以 $1$ 为根时，与 $1$ 直接相连的点有 $\{2\}$，因为只有一个所以大小全部相同。

以 $2$ 为根时，与 $2$ 直接相连的点有 $\{1,3\}$，子树大小分别为 $\{1,2\}$，不相同。

以 $3$ 为根时，与 $3$ 直接相连的点有 $\{2,4\}$，子树大小分别为 $\{2,1\}$，不相同。

以 $4$ 为根时，与 $4$ 直接相连的点有 $\{3\}$，因为只有一个所以大小全部相同。

所以答案为 $1,4$。

----

### 数据范围

**本题采用捆绑测试。**

| $\rm{subtask}$ | $n$ |  分数|
| :-----------: | :-----------: | :----: |
| $1$ | $\le 5000$ | $40$ |
| $2$ | $\le 10^6$ | $60$ |

对于 $100\%$ 的数据，满足 $1 \le n\le 10^6$。

------

### 提示

由于输入输出量较大，你可能需要快速输入/输出。

## 样例 #1

### 输入

```
2
1 2
```

### 输出

```
1 2 ```

## 样例 #2

### 输入

```
4
1 2
2 3
3 4
```

### 输出

```
1 4 
```

## 样例 #3

### 输入

```
9
1 2
1 3
4 1
5 1
1 6
1 9
8 1
1 7
```

### 输出

```
1 2 3 4 5 6 7 8 9 
```

# AI分析结果

• **综合分析与结论**：这些题解主要围绕如何高效找出无根树中能作为根且使直接相连节点子树大小相同的节点展开。大部分题解思路是先选一个节点（多为1号节点）为根，通过DFS计算各节点子树大小，再据此判断每个节点是否满足条件。不同点在于判断条件的具体实现和对特殊情况（如根节点、叶子节点）的处理方式。

**通用建议与扩展思路**：
 - **思路优化**：利用树的一些特性，如叶子节点必满足条件，除叶子节点外可能满足条件的只有重心，可减少判断节点数量。
 - **代码实现**：注意处理根节点和叶子节点的特殊情况，避免遗漏或误判；在实现过程中，合理使用数据结构，如邻接表、链式前向星存储图，以提高效率。对于大规模数据，要关注复杂度，尽量将算法复杂度控制在$O(n)$。同类型题可考察不同的树上操作，如在满足本题条件的基础上，增加对路径长度、节点深度等限制条件，或改变判断条件，如子树大小需满足特定比例等。类似算法套路常基于DFS或BFS遍历树结构，结合对节点属性（如子树大小、深度等）的计算和判断来解决问题。

**推荐题目**：
 - [P2639 普通平衡树](https://www.luogu.com.cn/problem/P2639)：涉及平衡树的基本操作，可加深对树结构及节点平衡概念的理解。
 - [P3379 【模板】最近公共祖先（LCA）](https://www.luogu.com.cn/problem/P3379)：通过求解树上节点的最近公共祖先，强化对树结构和遍历算法的运用。
 - [P1270 “访问”美术馆](https://www.luogu.com.cn/problem/P1270)：在树结构上进行动态规划，拓展对树相关算法的综合应用能力。

以下无≥4星题解，故不列出具体题解。 

---
处理用时：15.77秒
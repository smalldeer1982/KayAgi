# 题目信息

# [NOIP 2016 普及组] 海港

## 题目背景

NOIP2016 普及组 T3

## 题目描述

小 K 是一个海港的海关工作人员，每天都有许多船只到达海港，船上通常有很多来自不同国家的乘客。

小 K 对这些到达海港的船只非常感兴趣，他按照时间记录下了到达海港的每一艘船只情况；对于第 $i$ 艘到达的船，他记录了这艘船到达的时间 $t_i$ (单位：秒)，船上的乘客数 $k_i$，以及每名乘客的国籍 $x_{i,1}, x_{i,2},\dots,x_{i,k}$。

小K统计了 $n$ 艘船的信息，希望你帮忙计算出以每一艘船到达时间为止的 $24$ 小时（$24$ 小时 $=86400$ 秒）内所有乘船到达的乘客来自多少个不同的国家。

形式化地讲，你需要计算 $n$ 条信息。对于输出的第 $i$ 条信息，你需要统计满足 $t_i-86400<t_p \le t_i$ 的船只 $p$，在所有的 $x_{p,j}$ 中，总共有多少个不同的数。


## 说明/提示

【样例解释 1】

第一艘船在第 $1$ 秒到达海港，最近 $24$ 小时到达的船是第一艘船，共有 $4$ 个乘客，分别是来自国家 $4,1,2,2$，共来自 $3$ 个不同的国家；

第二艘船在第 $2$ 秒到达海港，最近 $24$ 小时到达的船是第一艘船和第二艘船，共有 $4 + 2 = 6$ 个乘客，分别是来自国家 $4,1,2,2,2,3$，共来自 $4$ 个不同的国家；

第三艘船在第 $10$ 秒到达海港，最近 $24$ 小时到达的船是第一艘船、第二艘船和第三艘船，共有 $4+2+1=7$ 个乘客，分别是来自国家 $4,1,2,2,2,3,3$，共来自 $4$ 个不同的国家。

【样例解释 2】

第一艘船在第 $1$ 秒到达海港，最近 $24$ 小时到达的船是第一艘船，共有 $4$ 个乘客，分别是来自国家 $1,2,2,3$，共来自 $3$ 个不同的国家。

第二艘船在第 $3$ 秒到达海港，最近 $24$ 小时到达的船是第一艘船和第二艘船，共有 $4+2=6$ 个乘客，分别是来自国家 $1,2,2,3,2,3$，共来自 $3$ 个不同的国家。

第三艘船在第 $86401$ 秒到达海港，最近 $24$ 小时到达的船是第二艘船和第三艘船，共有 $2+2=4$ 个乘客，分别是来自国家 $2,3,3,4$，共来自 $3$ 个不同的国家。

第四艘船在第 $86402$ 秒到达海港，最近 $24$ 小时到达的船是第二艘船、第三艘船和第四艘船，共有 $2+2+1=5$ 个乘客，分别是来自国家 $2,3,3,4,5$，共来自 $4$个 不同的国家。

【数据范围】

- 对于 $10\%$ 的测试点，$n=1,\sum k_i \leq 10,1 \leq x_{i,j} \leq 10, 1 \leq t_i \leq 10$。
- 对于 $20\%$ 的测试点，$1 \leq n \leq 10, \sum k_i \leq 100,1 \leq x_{i,j} \leq 100,1 \leq t_i \leq 32767$。
- 对于 $40\%$ 的测试点，$1 \leq n \leq 100, \sum k_i \leq 100,1 \leq x_{i,j} \leq 100,1 \leq t_i \leq 86400$。
- 对于 $70\%$ 的测试点，$1 \leq n \leq 1000, \sum k_i \leq 3000,1 \leq x_{i,j} \leq 1000,1 \leq t_i \leq 10^9$。
- 对于 $100\%$ 的测试点，$1 \leq n \leq 10^5,\sum k_i \leq 3\times 10^5, 1 \leq x_{i,j} \leq 10^5,1\leq t_i \leq 10^9$。


## 样例 #1

### 输入

```
3
1 4 4 1 2 2
2 2 2 3
10 1 3```

### 输出

```
3
4
4
```

## 样例 #2

### 输入

```
4
1 4 1 2 2 3
3 2 2 3
86401 2 3 4
86402 1 5```

### 输出

```
3
3
3
4```

# AI分析结果

• 综合分析与结论：
    - 思路方面：大部分题解都采用队列结合桶（数组统计国籍人数）的方式。先将每艘船上乘客信息（时间、国籍）按顺序存入队列，每来一艘新船，把新船上乘客信息入队并更新桶数组，若出现新国籍则答案加1；同时检查队首元素，若其到达时间距离当前船到达时间超过86400秒，将其出队并更新桶数组，若该国籍人数减为0则答案减1 。少数题解如使用莫队算法，将问题转化为区间点种类数问题求解。
    - 算法要点：核心在于利用队列维护时间窗口内的乘客信息，桶数组统计不同国籍人数，实时更新不同国籍的数量。
    - 解决难点：主要难点是如何高效处理时间窗口内不同国籍人数的统计与更新，既要保证新到达乘客信息的正确加入，又要及时剔除超时乘客信息。同时，由于数据规模较大，需注意空间复杂度，部分题解通过压维数组或vector优化空间。
    - 评分情况：多数题解思路清晰，但部分代码可读性欠佳，或是缺少注释、变量命名不规范等。整体上达到4星及以上的题解较少。

通用建议与扩展思路：
    - 通用建议：在解决此类涉及时间窗口和数据统计的问题时，优先考虑队列、滑动窗口等数据结构和算法思想。代码实现上，注意变量命名规范和适当添加注释，以提高代码可读性。对于大规模数据，要提前分析算法的时间和空间复杂度，选择合适的数据结构进行优化。
    - 扩展思路：此类问题可拓展到其他具有时间序列或区间限制的数据统计场景，如统计一段时间内网站不同用户的访问次数、不同类型事件在特定时间区间内的发生种类等。相似算法套路通常围绕滑动窗口的维护和数据的高效统计更新，可根据具体问题选择合适的数据结构辅助实现，如哈希表、平衡树等。

推荐题目：
    - P1440 求m区间内的最小值：滑动窗口模板题，通过维护窗口内数据解决问题。
    - P2698 [USACO12MAR]花盆Flowerpot：与本题类似，需在一定区间内统计不同元素的个数。
    - P3957 [NOIP2017 普及组] 跳房子：结合了动态规划和滑动窗口的思想，与本题在窗口维护上有相似之处。 

---
处理用时：30.24秒
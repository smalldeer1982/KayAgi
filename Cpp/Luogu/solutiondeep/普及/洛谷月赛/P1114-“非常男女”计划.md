# 题目信息

# “非常男女”计划

## 题目描述

近来，初一年的 `XXX` 小朋友致力于研究班上同学的配对问题（别想太多，仅是舞伴），通过各种推理和实验，他掌握了大量的实战经验。例如，据他观察，身高相近的人似乎比较合得来。

万圣节来临之际，`XXX` 准备在学校策划一次大型的 “非常男女” 配对活动。对于这次活动的参与者，`XXX` 有自己独特的选择方式。他希望能选择男女人数相等且身高都很接近的一些人。这种选择方式实现起来很简单。他让学校的所有人按照身高排成一排，然后从中选出连续的若干个人，使得这些人中男女人数相等。为了使活动更热闹，`XXX` 当然希望他能选出的人越多越好。请编写程序告诉他，他最多可以选出多少人来。


## 样例 #1

### 输入

```
9
0 1 0 0 0 1 1 0 0
```

### 输出

```
6```

# AI分析结果

### 综合分析与结论

本题的核心在于找到一段连续的子序列，使得其中男女人数相等。大多数题解都采用了前缀和的思路，通过将男生和女生的数量差值作为关键指标，利用哈希表或数组记录差值首次出现的位置，从而快速找到符合条件的子序列。部分题解还通过优化枚举顺序或使用二分查找来进一步提高效率。

### 最优关键思路与技巧

1. **前缀和与差值记录**：将男生和女生的数量差值作为前缀和，记录每个差值首次出现的位置，通过差值相等来找到符合条件的子序列。
2. **哈希表优化**：使用哈希表（如`map`）或数组记录差值的位置，避免暴力枚举，将时间复杂度从O(n²)降低到O(n)。
3. **枚举优化**：通过从大到小枚举可能的子序列长度，结合剪枝策略，减少不必要的计算。

### 可拓展之处

- **类似题目**：类似的前缀和与哈希表结合的问题在算法竞赛中非常常见，如寻找和为特定值的子数组、最长连续子序列等。
- **数据结构应用**：可以进一步学习并应用其他数据结构（如线段树、树状数组）来解决类似问题。

### 推荐题目

1. **P1118 [USACO06NOV]Backward Digit Sums**：考察前缀和与回溯法的结合。
2. **P1141 01迷宫**：考察广度优先搜索与前缀和的结合。
3. **P1044 栈**：考察动态规划与栈的应用。

### 所选高星题解

#### 题解1：AKB48 (赞：163) - 5星
**关键亮点**：引入相对差的概念，通过记录差值的首次和最后出现位置，快速找到符合条件的子序列。
**个人心得**：特别强调了差值为0的起点处理，确保算法的正确性。

```cpp
int l[200010],r[200010],sum1,sum0,ans,n;
int main() {
    cin>>n;
    for (int i=1;i<=n;i++){
        int x; cin>>x;
        sum1+=(x==1), sum0+=(x==0);
        int t=sum0-sum1+n;
        if (!l[t]&&t!=n) l[t]=i; else r[t]=i;
    }
    for (int i=0;i<=2*n;i++) ans=max(ans,r[i]-l[i]);
    cout<<ans<<endl;
    return 0;
}
```

#### 题解2：KellyFrog (赞：62) - 4星
**关键亮点**：详细解释了前缀和与哈希表的结合，通过调整数组下标避免负数问题。
**个人心得**：调试过程中发现负数下标问题，通过加一个足够大的数解决。

```cpp
for(int i = 1; i < n + 1; i++){
   hash[sum[i]+100010]._min = min(hash[sum[i]+100010]._min, i);
   hash[sum[i]+100010]._max = i;
}
```

#### 题解3：Bring (赞：3) - 4星
**关键亮点**：通过前缀和与哈希表的结合，详细解释了如何通过差值相等来找到符合条件的子序列。
**个人心得**：强调了差值为0的起点处理，确保算法的正确性。

```cpp
int n,p[N],s,ans;
signed main(){
    Rd(n),Mst(p,-1),P(0)=0;
    Frn1(i,1,n)s+=read()?1:-1,~P(s)?ans=max(ans,i-P(s)):P(s)=i;
    wr(ans),exit(0);
}
```

### 通用建议与扩展思路

- **前缀和与哈希表**：掌握前缀和与哈希表的结合应用，能够有效解决类似问题。
- **枚举优化**：在枚举过程中，通过剪枝或优化枚举顺序，减少不必要的计算。
- **数据结构应用**：学习并应用其他数据结构，如线段树、树状数组等，解决更复杂的问题。

---
处理用时：30.69秒
# 题目信息

# 「GLR-R4」小满

## 题目背景

&emsp;&emsp;「树阴满地日当午，梦觉流莺时一声」

---

&emsp;&emsp;乐队训练之余，锻炼时间可是必不可少的，可是就算几个女孩子撒开蹄子跑，也不可能在高三打球狂人的统治下抢到一块羽毛球场的。经过了数周从训练室冲到球场，再从球场灰心地踱回训练室的循环后，阿绫绝望地向大家宣布了一个坏消息：“只能打野球了。”

&emsp;&emsp;“还有几个月了哟……”

&emsp;&emsp;“老 V 你又来了！”才回训练室的阿绫扶着门抱怨着。

&emsp;&emsp;“所以你们打球得抓紧时间啦！”

---

&emsp;&emsp;**小满**&emsp;「生活一圈圈日子一年年　总是这样重复一遍又一遍」

## 题目描述

&emsp;&emsp;野场羽毛球，在生态环境良好的校园里，可是经常遭遇不测的——

&emsp;&emsp;“天依！怎么球又被挂树上啦！”

&emsp;&emsp;如阿绫所见，她们仅剩的一颗可怜的羽毛球被天依用吃包子的劲儿抡到树上去了。为了避免找别人的排球或者篮球来砸树的尴尬，阿绫这次特意准备了一根折叠杆。

&emsp;&emsp;折叠杆初始时处于完全收缩状态，我们认为它的长度 $\ell=0$。完全展开折叠杆需要 $n$ 步，每步为以下两种情况之一：

1.  将杆末端的折叠处展开。此操作没有额外参数，操作完成后 $\ell\gets 2\ell$，即杆的长度变为原来的两倍。

2.  将杆末端的伸缩处展开。此操作将给出额外可变参数 $d$，操作完成后 $\ell\gets \ell+d$，即杆的长度增加 $d$。

&emsp;&emsp;树上球的高度、杆最终的高度和天依吃包子的劲儿可能都是庞大的，所以阿绫需要你来计算一下杆最终的长度 $\ell$。你需要回答阿绫 $n$ 次操作依次完成后，**$\ell$ 的二进制表示**。

## 说明/提示

#### 样例 #1 解释

对于第一组测试数据：$\ell$ 的变化过程为：$0 \rightarrow 0 \rightarrow 0$，而 $(0)_{10}=(0)_2$。

对于第二组测试数据：$\ell$ 的变化过程为：$0 \rightarrow 0 \rightarrow 1 \rightarrow 3 \rightarrow 6 \rightarrow 12$，而 $(12)_{10}=(1100)_2$。  

### 数据规模与约定  

对于 $100\%$ 的数据，$1\leq T \leq 5$，$1\leq  n \leq 10^5$，$0\leq d < 2^{16}$。

对于不同的子任务，作如下约定：

| 子任务编号 |     $n$     | 特殊性质 | 子任务分值 |
| :--------: | :---------: | :------: | :--------: |
|    $1$     |  $\leq 20$  |    无    |    $10$    |
|    $2$     | $\leq 10^5$ |    有    |    $20$    |
|    $3$     | $\leq 10^3$ |    无    |    $40$    |
|    $4$     | $\leq 10^5$ |    无    |    $30$    |
  
- 特殊性质：仅存在第二种操作。


## 样例 #1

### 输入

```
2
2
1
2 0
5
1
2 1
2 2
1
2 6```

### 输出

```
0
1100```

# AI分析结果

### 综合分析与结论

本题的核心在于处理大数运算，特别是涉及乘法和加法的操作，最终输出二进制表示。由于数据范围较大，直接使用普通数据类型无法处理，因此需要借助高精度算法。各题解的思路主要集中在以下几个方面：

1. **二进制高精度**：大多数题解选择直接使用二进制高精度，避免了十进制转二进制的复杂操作，特别是乘法操作可以通过左移（在二进制中表现为末尾加0）来简化。
2. **延迟进位**：为了避免每次加法操作后立即进行进位处理，多个题解采用了延迟进位的策略，即先记录所有加法操作，最后统一处理进位，从而减少时间复杂度。
3. **倒序处理**：部分题解通过倒序遍历操作，提前计算每个加法操作的最终位置，避免了频繁的移位操作。

### 所选高星题解

#### 1. 作者：Auto_Accepted (★★★★★)
**关键亮点**：
- **二进制高精度**：直接使用二进制高精度，简化了乘法和加法的操作。
- **延迟进位**：加法操作后不立即进位，最后统一处理，优化了时间复杂度。
- **指针优化**：通过指针记录当前最低位的位置，避免了频繁的数组移动。

**个人心得**：
- 作者提到“乘 $2$ 直接在后面加个 $0$ 就行了”，这一思路简化了乘法操作，体现了二进制高精度的优势。

**核心代码**：
```cpp
void test1() { pos++; }
void test2(int d) { a[pos] += d; }
void end() {
    for(int i = pos; i; i--) {
        a[i - 1] += a[i] / 2;
        a[i] %= 2;
    }
    for(int i = 1; i <= l; i++) {
        if(a[i]) { l = i; break; }
    }
    if(a[l] == 0) l = pos;
}
```

#### 2. 作者：Azazеl (★★★★☆)
**关键亮点**：
- **倒序处理**：通过倒序遍历操作，提前计算每个加法操作的最终位置，避免了频繁的移位操作。
- **统一进位**：所有加法操作完成后统一处理进位，减少了时间复杂度。

**核心代码**：
```cpp
for(int i = n; i >= 1; i--) {
    if(X[i] == -1) tot--;
    else for(int j = 0; j < V[X[i]].size(); j++) Num[V[X[i]][j] + tot]++, Maxn = max(Maxn, V[X[i]][j] + tot);
}
```

#### 3. 作者：ScottSuperb (★★★★☆)
**关键亮点**：
- **偏移数组**：通过偏移数组实现类似双端队列的效果，简化了移位操作。
- **延迟进位**：加法操作后不立即进位，最后统一处理，优化了时间复杂度。

**核心代码**：
```cpp
void add(ll b) { sf[p + 1] += b; }
void ls() {
    if(sf[p + sf[0]]) ++sf[0], --p, sf[p + 1] = 0;
}
```

### 最优关键思路与技巧

1. **二进制高精度**：直接使用二进制高精度可以简化乘法和加法的操作，特别是乘法操作可以通过左移（在二进制中表现为末尾加0）来简化。
2. **延迟进位**：避免每次加法操作后立即进行进位处理，最后统一处理进位，从而减少时间复杂度。
3. **倒序处理**：通过倒序遍历操作，提前计算每个加法操作的最终位置，避免了频繁的移位操作。

### 可拓展之处

类似的高精度问题可以通过二进制高精度和延迟进位的策略来优化。特别是在涉及大数运算的题目中，这些技巧可以有效减少时间复杂度。

### 推荐题目

1. **P1009 阶乘之和**：涉及大数阶乘的计算，适合练习高精度算法。
2. **P1045 麦森数**：涉及大数幂运算，适合练习高精度乘法和延迟进位。
3. **P1255 数楼梯**：涉及大数加法，适合练习高精度加法和进位处理。

### 个人心得总结

- **调试经历**：多位作者提到在调试过程中遇到的困难，如数组越界、进位处理不当等，强调了细节处理的重要性。
- **顿悟感想**：通过二进制高精度和延迟进位的策略，大大简化了问题的复杂度，体现了算法优化的重要性。

---
处理用时：36.36秒
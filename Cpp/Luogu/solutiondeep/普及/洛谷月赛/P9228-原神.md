# 题目信息

# 原神

## 题目背景

## 提示：题目背景与题目无关。


你说的对，但是《原神》是由米哈游自主研发的一款全新开放世界冒险游戏。游戏发生在一个被称作「提瓦特」的幻想世界，在这里，被神选中的人将被授予「神之眼」，导引元素之力。你将扮演一位名为「旅行者」的神秘角色，在自由的旅行中邂逅性格各异、能力独特的同伴们，和他们一起击败强敌，找回失散的亲人——同时，逐步发掘「原神」的真相。

因为你的素养很差，我现在每天玩原神都能赚 150 原石，每个月差不多 5000 原石的收入， 也就是现实生活中每个月 5000 美元的收入水平，换算过来最少也 30000 人民币，虽然我 只有 14 岁，但是已经超越了中国绝大多数人（包括你）的水平，这便是原神给我的骄傲的资本。

毫不夸张地说，《原神》是 miHoYo 迄今为止规模最为宏大，也是最具野心的一部作品。即便在经历了 8700 个小时的艰苦战斗后，游戏还有许多尚未发现的秘密，错过的武器与装备，以及从未使用过的法术和技能。

尽管游戏中的战斗体验和我们之前在烧机系列游戏所见到的没有多大差别，但游戏中各类精心设计的敌人以及 Boss 战已然将战斗抬高到了一个全新的水平。就和几年前的《塞尔达传说》一样，《原神》也是一款能够推动同类游戏向前发展的优秀作品。

## 题目描述

原神中有一个魔法师，她可以打出 $ n $ 次火元素攻击魔法和 $ m $ 次冰元素攻击魔法，每次攻击的伤害分别为 $ a_1,a_2,\cdots, a_n $ 和 $ b_1,b_2,\cdots, b_m $。

元素攻击之间存在如下反应规则：

- 每次元素攻击可以给**没有元素附着**的怪物附着相应的元素，初始时怪物没有元素附着；

- 如果用火元素攻击打到冰元素附着的怪物身上，那么本次伤害将 $ \times 2 $，**并清空元素附着**；

- 如果用冰元素攻击打到火元素附着的怪物身上，那么本次伤害将 $ +k $，**并清空元素附着**。

现在魔法师可以任意安排攻击顺序，也就是说，每次攻击过后，魔法师可以从自己没有使用过的魔法中任意挑选一种使用。她希望最大化总伤害，请问**最大总伤害**是多少。

## 说明/提示

### 样例 1 解释

攻击采用 $a_1\rightarrow b_4\rightarrow a_2\rightarrow b_3\rightarrow a_5\rightarrow b_5\rightarrow b_7 \rightarrow b_1\rightarrow a_3 \rightarrow b_2\rightarrow a_4\rightarrow b_3 \rightarrow a_6 $，每次的实际伤害为 $1,12,1,4,1,11,0,1,8,9,10,1,8$，总伤害为 $ 67 $。

### 样例 2 解释

攻击采用 $a_5\rightarrow b_1\rightarrow b_2\rightarrow a_4\rightarrow a_3\rightarrow b_3\rightarrow a_2\rightarrow a_1$，每次的实际伤害为 $5,12,1,16,2,9,4,1$，总伤害为 $50 $。

### 数据规模与约定

对于 $100\%$ 的数据，$1 \leq n,m \leq 10^6 $，$ 0 \leq a_i,b_i,k \leq 10^9 $。

| 测试点编号 | $n,m \leq$  |特殊性质|
| :----------: | :----------: | :-----------: |
| $1 \sim 5$ | $10$ | |
| $6 \sim  10$ | $1000$ | |
| $11 \sim 12$ | $10 ^6 $ | $k=0$ |
| $13 \sim 14$ | $10 ^6 $ | $k>\max(\max_{i=1}^n\{a_i\},\max_{i=1}^m\{b_i\})$ |
| $15 \sim 16$ | $10 ^6 $ | $n=m$ | 
| $17 \sim 25$ | $10 ^6 $ | | 


## 样例 #1

### 输入

```
6 7 3
1 1 4 5 1 4
1 9 1 9 8 1 0
```

### 输出

```
67
```

## 样例 #2

### 输入

```
5 3 5
1 4 2 8 5
7 1 4
```

### 输出

```
50```

## 样例 #3

### 输入

```
1 1 0
2
3
```

### 输出

```
7
```

## 样例 #4

### 输入

```
见附件中的 samples/genshin4.in```

### 输出

```
见附件中的 samples/genshin4.ans```

## 样例 #5

### 输入

```
见附件中的 samples/genshin5.in```

### 输出

```
见附件中的 samples/genshin5.ans```

# AI分析结果

### 综合分析与结论

本题的核心是通过贪心策略最大化元素反应带来的额外伤害。所有题解都基于以下关键点：
1. **贪心思想**：优先让火元素和冰元素配对，触发元素反应，且尽可能让火元素的伤害翻倍（如果翻倍收益大于冰元素的固定增益）。
2. **排序优化**：将火元素的伤害从大到小排序，优先让高伤害的火元素触发翻倍反应。
3. **计算额外伤害**：通过比较火元素翻倍后的伤害与冰元素固定增益，决定触发哪种反应。

大部分题解的思路相似，区别在于代码实现和细节处理。部分题解在排序和计算额外伤害时存在冗余或不够简洁，而优秀的题解则通过清晰的逻辑和简洁的代码实现了高效的解决方案。

### 所选高星题解

#### 1. **作者：Coffee_zzz (5星)**
- **关键亮点**：
  - 思路清晰，直接指出问题的核心是最大化元素反应的额外伤害。
  - 代码简洁，通过排序和贪心策略高效计算额外伤害。
  - 明确指出了不开 `long long` 的潜在问题，体现了代码的健壮性。
- **核心代码**：
  ```cpp
  sort(a+1,a+n+1);reverse(a+1,a+n+1);
  for(int i=1;i<=l;i++){
      if(a[i]>k) sum=sum+a[i];
      else sum=sum+k;
  }
  ```
  **实现思想**：将火元素从大到小排序，优先让高伤害的火元素触发翻倍反应，否则使用冰元素的固定增益。

#### 2. **作者：MspAInt (4.5星)**
- **关键亮点**：
  - 提供了详细的贪心证明，增强了思路的严谨性。
  - 代码实现简洁，通过排序和贪心策略高效计算额外伤害。
  - 明确指出了元素反应对后续攻击无影响，简化了问题。
- **核心代码**：
  ```cpp
  for(int i=1;i<=min(n,m);i++)
      ans+=max(a[i]+b[i]+k,b[i]+a[i]*2ll);
  ```
  **实现思想**：通过比较火元素翻倍后的伤害与冰元素固定增益，决定触发哪种反应，确保每次反应收益最大化。

#### 3. **作者：Ggsddu_zzy (4星)**
- **关键亮点**：
  - 思路清晰，直接指出问题的核心是最大化元素反应的额外伤害。
  - 代码简洁，通过排序和贪心策略高效计算额外伤害。
  - 明确指出了不开 `long long` 的潜在问题，体现了代码的健壮性。
- **核心代码**：
  ```cpp
  for(int i=1;i<=min(n,m);i++) ans+=max(a[i],k);
  ```
  **实现思想**：将火元素从大到小排序，优先让高伤害的火元素触发翻倍反应，否则使用冰元素的固定增益。

### 最优关键思路与技巧
1. **贪心策略**：优先让高伤害的火元素触发翻倍反应，确保每次反应的收益最大化。
2. **排序优化**：将火元素的伤害从大到小排序，简化了贪心策略的实现。
3. **边界处理**：注意数据范围，使用 `long long` 避免溢出问题。

### 可拓展之处
- **类似问题**：可以拓展到其他需要配对触发增益的问题，如资源分配、任务调度等。
- **算法套路**：贪心+排序的套路适用于许多最大化收益或最小化成本的问题。

### 推荐题目
1. **P1090 合并果子**（贪心+优先队列）
2. **P1223 排队接水**（贪心+排序）
3. **P1803 凌乱的yyy / 线段覆盖**（贪心+区间调度）

### 个人心得摘录
- **Coffee_zzz**：`不开 long long 见祖宗`，强调了数据范围的重要性。
- **MspAInt**：`元素效果之间会互相抵消，所以每一对冰火伤害加成是不会对后面的贡献产生影响`，简化了问题的复杂度。
- **Ggsddu_zzy**：`因为每个怪物初始时没有附着任何元素，所以要先给每个怪物附着元素`，明确了问题的初始条件。

---
处理用时：35.00秒
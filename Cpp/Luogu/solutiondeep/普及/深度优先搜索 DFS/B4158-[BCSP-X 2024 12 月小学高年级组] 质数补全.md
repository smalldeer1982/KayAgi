# 题目信息

# [BCSP-X 2024 12 月小学高年级组] 质数补全

## 题目描述

Alice 在纸条上写了一个质数，第二天再看时发现有些地方污损看不清了。

- 在大于 $1$ 的自然数中，除了 $1$ 和它本身以外不再有其他因数的自然数称为质数

请你帮助 Alice 补全这个质数，若有多解输出数值最小的，若无解输出 $-1$。

例如纸条上的数字为 $\tt{1*}$（$\tt{*}$ 代表看不清的地方），那么这个质数有可能为 $11, 13, 17, 19$，其中最小的为 $11$。

## 说明/提示

### 样例 3-6

参考附件中的样例。

### 数据范围

$|s|$ 代表 $s$ 串的长度，对于所有数据，$1 \leq t \leq 10, 1 \leq |s| \leq 7$，$s$ 中仅包含数字或者 $\tt{*}$，并且保证首位不是 $\tt{*}$ 或者 $0$。

本题采用捆绑测试，你必须通过子任务中的所有数据点以及其依赖的子任务，才能获得子任务对应的分数。

| 子任务编号 | 分值 | $\mid s\mid$ | 特殊性质 | 子任务依赖 |
| :----------: | :----------: | :----------: | :----------: | :----------: |
| $1$ | $35$ | $\leq 7$ | $s$ 中没有 $\tt{*}$ |  |
| $2$ | $30$ | $\leq 4$ |  |  |
| $3$ | $24$ | $\leq 7$ | $s$ 中至多包含 $1$ 个 $\tt{*}$ | $1$ |
| $4$ | $11$ | $\leq 7$ |  | $1,2,3$ |


## 样例 #1

### 输入

```
10
1*
3**
7**
83*7
2262
6**1
29*7
889*
777*
225*```

### 输出

```
11
307
701
8317
-1
6011
2917
8893
-1
2251```

## 样例 #2

### 输入

```
10
4039***
2***5*5
4099961
25**757
7***0**
1***00*
41811*9
6***0*7
8***1**
6561*59```

### 输出

```
4039019
-1
4099961
2509757
7000003
1000003
4181129
6000047
8000101
6561259```

# AI分析结果

### 综合分析与结论

本题的核心在于通过深度优先搜索（DFS）枚举所有可能的数字组合，并判断是否为质数，最终输出最小的符合条件的质数。由于数字长度最大为7，且询问次数最多为10次，DFS的复杂度在可接受范围内。题解中使用了字符串处理和质数判断的基本技巧，整体思路清晰，但代码实现上存在一些冗余和错误，如字符串转数字的函数逻辑不完整，DFS的终止条件处理不当等。

### 题解评分与亮点

#### 题解作者：_Deer_Peach_ (赞：0)
- **星级：3星**
- **关键亮点：**
  - 使用DFS枚举所有可能的数字组合，思路清晰。
  - 代码结构较为简洁，易于理解。
- **改进建议：**
  - 字符串转数字的函数逻辑不完整，应修正为正确处理所有字符。
  - DFS的终止条件处理不当，应确保所有可能的组合都被枚举。
- **个人心得：**
  - 无

### 通用建议与扩展思路

1. **优化思路：**
   - 在DFS过程中，可以提前剪枝，减少不必要的枚举。例如，当当前数字已经大于已知的最小质数时，可以直接返回。
   - 使用更高效的质数判断方法，如Miller-Rabin素性测试，以提高判断速度。

2. **扩展思路：**
   - 类似的问题可以扩展到其他类型的数字组合问题，如寻找最小的回文数、最小的平方数等。
   - 可以结合其他算法，如动态规划，解决更复杂的数字组合问题。

### 推荐洛谷题目

1. **P1217 [USACO1.5]回文质数 Prime Palindromes**
   - 考察质数和回文数的判断，与本题类似。

2. **P1075 质因数分解**
   - 考察质数的判断和因数分解，与本题的质数判断部分相关。

3. **P3383 【模板】线性筛素数**
   - 考察质数的筛选方法，可以帮助优化质数判断的效率。

### 核心代码片段

```cpp
void dfs(string x, int id) {
    if (flag) return; // 已经有答案
    if (id == x.size()) {
        int num = stoi(x);
        if (check(num)) {
            cout << num << endl;
            flag = true; // 标记
        }
        return;
    }
    if (x[id] == '*') {
        for (int i = 0; i < 10; i++) { // 枚举数字
            x[id] = (char)(i + '0');
            dfs(x, id + 1);
        }
    } else {
        dfs(x, id + 1);
    }
}
```

**核心实现思想：**
- 使用DFS递归枚举所有可能的数字组合，当遇到`*`时，枚举0到9的所有可能值。
- 当枚举到字符串末尾时，判断当前数字是否为质数，如果是则输出并标记已找到答案。

---
处理用时：17.77秒
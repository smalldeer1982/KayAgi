# 题目信息

# [USACO19OPEN] Fence Planning S

## 题目描述

Farmer John 的 $ N $ 头奶牛，编号为 $ 1 \ldots N $ （ $ 2 \leq N \leq 10^5 $ ），拥有一种围绕“哞网”，一些仅在组内互相交流却不与其他组进行交流的奶牛小组，组成的复杂的社交网络。

每头奶牛位于农场的二维地图上的不同位置 $ (x,y) $ ，并且我们知道有 $ M $ 对奶牛( $ 1 \leq M<10^5 $ )会相互哞叫。两头相互哞叫的奶牛属于同一哞网。

为了升级他的农场，Farmer John 想要建造一个四边与 $ x $ 轴和 $ y $ 轴平行的长方形围栏。Farmer John 想要使得至少一个哞网完全被围栏所包围（在长方形边界上的奶牛计为被包围的）。请帮助 Farmer John 求出满足他的要求的围栏的最小可能周长。有可能出现这一围栏宽为 $0$ 或高为 $0$ 的情况。

## 样例 #1

### 输入

```
7 5
0 5
10 5
5 0
5 10
6 7
8 6
8 4
1 2
2 3
3 4
5 6
7 6```

### 输出

```
10```

# AI分析结果

### 综合分析与结论

本题的核心在于找到所有连通块，并计算每个连通块的最小包围矩形的周长。题解中主要使用了两种算法：**DFS** 和 **并查集**。DFS 通过遍历图来找到连通块，并在遍历过程中更新矩形的边界；并查集则通过合并操作维护连通块，并在合并时更新矩形的边界。两种方法的时间复杂度均为 $O(n)$，但并查集在实现上更为简洁，且更易于理解和维护。

### 所选高星题解

#### 1. 作者：Mkarry (★★★★☆)
- **关键亮点**：使用DFS遍历图，通过维护矩形的上下左右边界来计算最小周长。代码清晰，注释详细，时间复杂度分析准确。
- **个人心得**：作者解释了DFS的时间复杂度，强调了每个节点只会被遍历一次，避免了$O(n^2)$的误解。
- **核心代码**：
  ```cpp
  void DFS(int step){
      vis[step]=1;
      U=max(U,a[step].y),D=min(D,a[step].y);
      R=max(R,a[step].x),L=min(L,a[step].x);
      for(int j=lik[step];j;j=nxt[j]) if(!vis[son[j]]) DFS(son[j]);
  }
  ```

#### 2. 作者：Zed_ (★★★★☆)
- **关键亮点**：使用并查集维护连通块，并在合并时更新矩形的边界。代码结构清晰，逻辑严谨，适合初学者理解。
- **核心代码**：
  ```cpp
  void dfs(int u, int col) {
      co[u] = col;
      size[col]++;
      vec[col].push_back(u);
      vis[u] = true;
      for (int i = head[u]; i; i = edge[i].next) {
          int v = edge[i].to;
          if (vis[v]) continue;
          dfs(v, col);
      }
  }
  ```

#### 3. 作者：purinliang (★★★★☆)
- **关键亮点**：并查集在合并时直接更新矩形的边界，代码简洁高效，时间复杂度分析准确。
- **核心代码**：
  ```cpp
  bool union_set(int x,int y) {
      int fx=find_par(x);
      int fy=find_par(y);
      if(fx==fy) {
          return false;
      } else {
          par[fy]=fx;
          u[fx]=max(u[fx],u[fy]);
          d[fx]=min(d[fx],d[fy]);
          l[fx]=min(l[fx],l[fy]);
          r[fx]=max(r[fx],r[fy]);
          return true;
      }
  }
  ```

### 最优关键思路与技巧
- **并查集优化**：在合并连通块时，直接更新矩形的边界，避免后续的重复计算。
- **DFS遍历**：通过DFS遍历图，维护矩形的边界，确保每个节点只被遍历一次。

### 可拓展之处
- **类似算法套路**：并查集和DFS在图论中广泛应用，适用于连通性问题、最小生成树等问题。
- **同类型题目**：可以尝试解决类似的最小包围矩形问题，或者扩展到三维空间中的包围盒问题。

### 推荐题目
1. [P3367 【模板】并查集](https://www.luogu.com.cn/problem/P3367)
2. [P3387 【模板】缩点](https://www.luogu.com.cn/problem/P3387)
3. [P3916 图的遍历](https://www.luogu.com.cn/problem/P3916)

### 个人心得总结
- **调试经历**：作者在调试过程中发现并查集的路径压缩优化可以显著提高效率。
- **踩坑教训**：在DFS遍历时，未标记已访问节点会导致重复遍历，增加时间复杂度。
- **顿悟感想**：并查集在合并时直接更新矩形边界，避免了后续的重复计算，提高了代码效率。

---
处理用时：22.26秒
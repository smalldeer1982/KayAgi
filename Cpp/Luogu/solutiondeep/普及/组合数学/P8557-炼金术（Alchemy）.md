# 题目信息

# 炼金术（Alchemy）

## 题目描述

铃是一个爱玩游戏的女孩子。

她在游戏中想要炼制一种稀有合金 —— 这需要 $n$ 种金属来合成。

她准备好矿石后建造了 $k$ 个不同的熔炉，当熔炉启动时，会随机炼出这 $n$ 种金属中的一些（也可能什么都没有）。

如果把每个熔炉炼出的金属收集起来，有了全部 $n$ 种金属，就能造出合金了。澪对此很好奇，对铃说：「我考考你，有多少种情况可以炼出合金呢？」这个简单的问题铃很快就会做了，你能求出结果吗？

答案可能很大，请对 $998244353$ 取模（即除以 $998244353$ 的余数）后输出。

## 说明/提示

【样例一解释】  
对于所有成功情况，两个熔炉中的金属如下表：

| 一号  | 二号 |
| :----------: | :----------: |
| $\varnothing$ | $\{1,2\}$ |
| $\{1\}$ | $\{2\}$ |
| $\{1\}$ | $\{1,2\}$ |
| $\{2\}$ | $\{1\}$ |
| $\{2\}$ | $\{1,2\}$ |
| $\{1,2\}$ | $\varnothing$ |
| $\{1,2\}$ | $\{1\}$ |
| $\{1,2\}$ | $\{2\}$ |
| $\{1,2\}$ | $\{1,2\}$ |

一共 $9$ 种，因此答案为 $9$。

【数据范围】  
对于 $30\%$ 的数据，$1\le n,k \le 10$；  
对于 $80\%$ 的数据，$1\le n,k \le 10^6$；  
对于 $100\%$ 的数据，$1\le n,k \le 10^9$。

## 样例 #1

### 输入

```
2 2```

### 输出

```
9```

## 样例 #2

### 输入

```
4 5```

### 输出

```
923521```

## 样例 #3

### 输入

```
233 123```

### 输出

```
81633405```

# AI分析结果

### 综合分析与结论
这些题解思路基本一致，都是从金属的角度出发，先分析出每种金属有 $2^k - 1$ 种出现情况，再根据乘法原理得到总方案数为 $(2^k - 1)^n$ 。由于数据范围大，都采用快速幂算法来优化幂运算，降低时间复杂度。

### 所选题解
- **作者：zhang_kevin (赞：25)  ★★★★**
    - **关键亮点**：思路清晰，代码简洁，对排列组合的解释清晰，还给出了相关博客链接。
    - **个人心得**：无
- **作者：Andy_L (赞：15)  ★★★★**
    - **关键亮点**：有温馨提示，思路阐述详细，代码规范。
    - **个人心得**：无
- **作者：SmallBlack (赞：2)  ★★★★**
    - **关键亮点**：详细说明了思考角度的转换，对做题思路的阐述很有启发性。
    - **个人心得**：发现很多的组合问题都可以在一定条件下通过构造结构来解决。

### 重点代码
```cpp
// 快速幂核心代码
int ksm(int a, int b) {
    int ans = 1;
    while (b) {
        if (b & 1)
            ans = ans * a % mod;
        b >>= 1;
        a = a * a % mod;
    }
    return ans;
}
```
**核心实现思想**：利用二进制的特性，将幂运算的时间复杂度从 $O(n)$ 优化到 $O(log n)$ 。当指数 $b$ 的二进制位为 1 时，将当前底数 $a$ 乘入结果 $ans$ ，并不断将底数 $a$ 平方，指数 $b$ 右移一位。

### 最优关键思路或技巧
- **思维方式**：转换思考角度，从金属的角度而不是熔炉的角度来分析问题，简化了问题的复杂度。
- **算法优化**：使用快速幂算法，将幂运算的时间复杂度从 $O(n)$ 优化到 $O(log n)$ ，避免了超时。

### 可拓展之处
同类型题或类似算法套路：
- 其他组合计数问题，可通过转换思考角度，将复杂问题拆解为简单子问题，再利用乘法原理或加法原理求解。
- 涉及大数幂运算的题目，可使用快速幂算法优化。

### 推荐题目
- P1226 【模板】快速幂||取余运算
- P3197 [HNOI2008]越狱
- P5245 【模板】多项式快速幂

### 个人心得摘录与总结
- **olegekei**：赛时没推出来柿子，而是打了个暴力（打表）才找到的规律，还把 $n$ 和 $k$ 读入的顺序搞反了，调半天也没过样例。总结：打表找规律是一种解题方法，但要注意输入顺序等细节。
- **SmallBlack**：发现很多的组合问题都可以在一定条件下通过构造结构来解决。总结：组合问题可尝试转换思考角度，构造合适的结构来简化问题。
- **yuheng_wang080904**：如果列举每个熔炉炼出哪些金属，则最后的式子将会很难推出。赛时算不出式子的话，可以将样例的前两个的输出分解质因数，并根据输入猜出式子。总结：遇到复杂问题可尝试转换思路，打表、分解质因数等方法可辅助找规律。 

---
处理用时：27.75秒
# 题目信息

# [蓝桥杯 2021 国 ABC] 123

## 题目描述

小蓝发现了一个有趣的数列, 这个数列的前几项如下:

$1,1,2,1,2,3,1,2,3,4, \ldots$

小蓝发现, 这个数列前 $1$ 项是整数 $1$ , 接下来 $2$ 项是整数 $1$ 至 $2$ , 接下来 $3$ 项是整数 $1$ 至 $3$ , 接下来 $4$ 项是整数 $1$ 至 $4$ , 依次类推。

小蓝想知道, 这个数列中, 连续一段的和是多少。

## 说明/提示

对于 $10 \%$ 的评测用例, $1 \leq T \leq 30,1 \leq l_{i} \leq r_{i} \leq 100$ 。

对于 $20 \%$ 的评测用例, $1 \leq T \leq 100,1 \leq l_{i} \leq r_{i} \leq 1000$ 。

对于 $40 \%$ 的评测用例, $1 \leq T \leq 1000,1 \leq l_{i} \leq r_{i} \leq 10^{6}$ 。

对于 $70 \%$ 的评测用例, $1 \leq T \leq 10000,1 \leq l_{i} \leq r_{i} \leq 10^{9}$ 。

对于 $80 \%$ 的评测用例, $1 \leq T \leq 1000,1 \leq l_{i} \leq r_{i} \leq 10^{12}$ 。

对于 $90 \%$ 的评测用例, $1 \leq T \leq 10000,1 \leq l_{i} \leq r_{i} \leq 10^{12}$ 。

对于所有评测用例, $1 \leq T \leq 100000,1 \leq l_{i} \leq r_{i} \leq 10^{12}$ 。 

蓝桥杯 2021 国赛 A 组 E 题（B 组 F 题，C 组 F 题）。

## 样例 #1

### 输入

```
3
1 1
1 3
5 8```

### 输出

```
1
4
8```

# AI分析结果

### 综合分析与结论
这些题解的核心思路都是将原数列转化为二维三角形结构，利用等差数列求和公式和前缀和思想来求解区间和。不同题解在具体实现上有所差异，主要体现在查找位置的方法（二分查找或直接计算）、前缀和数组的使用以及代码的简洁性和可读性上。

### 所选题解
- **作者：Light_az（5星）**
    - **关键亮点**：思路清晰，利用二分查找确定位置，直接推导公式计算前n行和，代码简洁易懂。
    - **核心代码**：
```cpp
ll Find(ll n){
    ll l=1,r=10000000;
    while(l<r){
        ll mid=(l+r)/2;
        if((1+mid)*mid/2>=n) r=mid;
        else l=mid+1;
    }
    return r;
}
ll f(ll n){
    return (1+n)*n/2;
}
ll Ans(ll n){
    return n*(n+1)*(n+2)/6;
}
```
核心实现思想：`Find` 函数通过二分查找确定数字所在的行；`f` 函数使用高斯公式计算从1到n的和；`Ans` 函数推导公式计算前n行的和。

- **作者：ztntonny（4星）**
    - **关键亮点**：详细解释了前缀和的使用，结合二分查找确定层级，代码逻辑清晰。
    - **核心代码**：
```cpp
for ( int i = 1; i < 2000005; i++ )
    s[i] = s[i - 1] + i, f[i] = f[i - 1] + s[i];
ll lev = max( 0ll, (ll)( lower_bound( s, s + 2000005, a ) - s - 1 ) );
```
核心实现思想：通过循环预处理前缀和数组 `s` 和 `f`，使用 `lower_bound` 函数二分查找确定数字所在的层级。

- **作者：DengDuck（4星）**
    - **关键亮点**：详细推导公式，使用二分查找确定位置，代码简洁高效。
    - **核心代码**：
```cpp
long long fd(long long x)
{
    long long l=1,r=10000000,ans;
    while(l<=r)
    {
        long long mid=(l+r)/2;
        if(mid*(mid+1)/2<x)l=mid+1;
        else 
        {
            r=mid-1;
            ans=mid;
        }
    }
    return ans;
}
```
核心实现思想：`fd` 函数通过二分查找确定数字所在的行。

### 最优关键思路或技巧
- **数形结合**：将数列转化为二维三角形结构，便于分析和推导公式。
- **二分查找**：利用二分查找快速确定数字所在的行，时间复杂度为 $O(logn)$。
- **公式推导**：推导等差数列求和公式和前n行和公式，避免直接遍历求和，提高效率。

### 可拓展之处
同类型题可考虑数列形式变化但仍可转化为规则图形的题目，如其他形式的二维数组或三维结构。类似算法套路可应用于处理具有规律的数列求和问题，先找出规律，再利用数学公式和前缀和思想求解。

### 洛谷推荐题目
- P1115 最大子段和（考察前缀和与动态规划）
- P2671 求和（考察前缀和与数学推导）
- P3131 [USACO16JAN]Subsequences Summing to Sevens S（考察前缀和与取模运算）

### 个人心得摘录与总结
- 作者：ztntonny：提到补一句开 `long long`，否则会得到满屏热血沸腾的颜色，强调了处理大数据时数据类型的重要性。
总结：在处理大数据范围的题目时，要注意使用合适的数据类型，避免数据溢出。 

---
处理用时：26.50秒
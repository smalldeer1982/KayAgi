# 题目信息

# 【模板】模意义下的乘法逆元

## 题目背景

这是一道模板题


## 题目描述

给定 $n,p$ 求 $1\sim n$ 中所有整数在模 $p$ 意义下的乘法逆元。

这里 $a$ 模 $p$ 的乘法逆元定义为 $ax\equiv1\pmod p$ 的解。

## 说明/提示

$ 1 \leq n \leq 3 \times 10 ^ 6$，$n < p < 20000528 $。

输入保证 $ p $ 为质数。


## 样例 #1

### 输入

```
10 13```

### 输出

```
1
7
9
10
8
11
2
5
3
4```

# AI分析结果

### 综合分析
该题目要求求解模意义下的乘法逆元，且输入保证模数 \( p \) 为质数。题解中主要涉及以下几种算法：
1. **扩展欧几里得算法（exgcd）**：适用于单个逆元的求解，时间复杂度为 \( O(\log n) \)，但在本题中由于需要求解大量逆元，直接使用会超时。
2. **费马小定理 + 快速幂**：适用于质数模数，时间复杂度为 \( O(n \log p) \)，同样在本题中无法通过所有测试点。
3. **线性递推法**：通过递推公式 \( inv[i] = (p - p/i) \times inv[p \% i] \% p \)，时间复杂度为 \( O(n) \)，是本题的最优解法。
4. **阶乘逆元法**：通过预处理阶乘及其逆元，再递推求解，时间复杂度为 \( O(n) \)，也是一种高效的解法。

### 所选高星题解
#### 1. **作者：zjp_shadow (赞：980)**
- **星级**：5星
- **关键亮点**：
  - 详细介绍了多种逆元求解方法，包括扩展欧几里得、费马小定理、线性递推和阶乘逆元法。
  - 提供了每种方法的代码实现，代码简洁且可读性强。
  - 对每种方法的时间复杂度进行了分析，帮助读者理解不同方法的适用场景。
- **个人心得**：作者提到“递推法是最优解法”，并给出了详细的递推公式和证明，帮助读者深入理解。

#### 2. **作者：zcysky (赞：309)**
- **星级**：4星
- **关键亮点**：
  - 直接给出了线性递推法的代码实现，代码简洁且高效。
  - 通过递推公式 \( inv[i] = (p - p/i) \times inv[p \% i] \% p \)，实现了 \( O(n) \) 的时间复杂度。
- **个人心得**：作者提到“递推法是最优解法”，并强调了递推公式的正确性。

#### 3. **作者：Rising_Date (赞：194)**
- **星级**：4星
- **关键亮点**：
  - 详细介绍了费马小定理和扩展欧几里得算法的原理，并提供了代码实现。
  - 通过递推公式 \( inv[i] = (p - p/i) \times inv[p \% i] \% p \)，实现了 \( O(n) \) 的时间复杂度。
- **个人心得**：作者提到“递推法是最优解法”，并给出了递推公式的详细推导过程。

### 最优关键思路
- **线性递推法**：通过递推公式 \( inv[i] = (p - p/i) \times inv[p \% i] \% p \)，可以在 \( O(n) \) 的时间复杂度内求解所有逆元，是本题的最优解法。

### 代码实现
```cpp
#include<bits/stdc++.h>
using namespace std;
long long inv[3000005],n,p;
int main(){
    inv[1]=1;
    cin>>n>>p;
    for(int i=2;i<=n;++i)
        inv[i]=(long long)((p-p/i)*inv[p%i])%p;
    for(int i=1;i<=n;++i)
        printf("%lld\n",inv[i]);
}
```

### 扩展思路
- **同类型题目**：类似的问题可以扩展到求解模意义下的除法、组合数等问题。
- **类似算法套路**：线性递推法不仅适用于逆元求解，还可以用于其他递推关系的问题，如斐波那契数列、组合数等。

### 推荐题目
1. [P1082 同余方程](https://www.luogu.com.cn/problem/P1082)
2. [P2613 【模板】有理数取余](https://www.luogu.com.cn/problem/P2613)
3. [P3807 【模板】卢卡斯定理](https://www.luogu.com.cn/problem/P3807)

---
处理用时：27.93秒
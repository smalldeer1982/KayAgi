# 题目信息

# [NOIP 1999 提高组] 导弹拦截

## 题目描述

某国为了防御敌国的导弹袭击，发展出一种导弹拦截系统。但是这种导弹拦截系统有一个缺陷：虽然它的第一发炮弹能够到达任意的高度，但是以后每一发炮弹都不能高于前一发的高度。某天，雷达捕捉到敌国的导弹来袭。由于该系统还在试用阶段，所以只有一套系统，因此有可能不能拦截所有的导弹。

   
输入导弹依次飞来的高度，计算这套系统最多能拦截多少导弹，如果要拦截所有导弹最少要配备多少套这种导弹拦截系统。


## 说明/提示

对于前 $50\%$ 数据（NOIP 原题数据），满足导弹的个数不超过 $10^4$ 个。该部分数据总分共 $100$ 分。可使用$\mathcal O(n^2)$ 做法通过。  
对于后 $50\%$ 的数据，满足导弹的个数不超过 $10^5$ 个。该部分数据总分也为 $100$ 分。请使用 $\mathcal O(n\log n)$ 做法通过。

对于全部数据，满足导弹的高度为正整数，且不超过 $5\times 10^4$。


此外本题开启 spj，每点两问，按问给分。

NOIP1999 提高组 第一题

---

$\text{upd 2022.8.24}$：新增加一组 Hack 数据。

## 样例 #1

### 输入

```
389 207 155 300 299 170 158 65```

### 输出

```
6
2
```

# AI分析结果

### 综合分析与结论

本题的核心是求解最长不上升子序列（第一问）和最少需要多少个不上升子序列覆盖整个序列（第二问）。大多数题解都采用了**Dilworth定理**，指出第二问等价于求最长上升子序列的长度。优化方面，多数题解通过**二分查找**和**贪心策略**将时间复杂度从 $O(n^2)$ 优化到 $O(n \log n)$。

### 所选高星题解

#### 1. **作者：离散小波变换° (5星)**
- **关键亮点**：详细解释了Dilworth定理的应用，并通过二分查找优化了最长不上升子序列和最长上升子序列的求解。代码简洁且可读性强。
- **个人心得**：通过反证法证明了 $f_i$ 的单调性，帮助理解二分查找的正确性。
- **核心代码**：
  ```cpp
  int l=0, r=t+1;
  while(r-l>1){
      int m=l+(r-l)/2;
      if(F[m]>=H[i]) l=m; else r=m;
  }
  int x=l+1;  // dp[i]
  if(x>t) t=x; F[x]=H[i];
  ```
  **实现思想**：通过二分查找找到第一个小于等于当前高度的位置，更新最长不上升子序列的长度。

#### 2. **作者：Tofu (4星)**
- **关键亮点**：从偏序集的角度引入Dilworth定理，详细解释了定理的证明过程，帮助理解其应用场景。
- **核心代码**：
  ```cpp
  int l=1, r=cnt;
  while(l<r){
      int mid=(l+r)>>1;
      if(a[mid]>=a[i]) r=mid; else l=mid+1;
  }
  a[l]=a[i];
  ```
  **实现思想**：通过二分查找找到第一个大于等于当前高度的位置，更新最长上升子序列的长度。

#### 3. **作者：STA_Morlin (4星)**
- **关键亮点**：通过贪心策略和二分查找优化了第二问的求解，代码实现简洁且高效。
- **核心代码**：
  ```cpp
  int l=1, r=cnt;
  while(l<r){
      int mid=(l+r)>>1;
      if(f[mid]>=a[i]) r=mid; else l=mid+1;
  }
  f[l]=a[i];
  ```
  **实现思想**：通过二分查找找到第一个大于等于当前高度的位置，更新系统的最小高度。

### 最优关键思路与技巧

1. **Dilworth定理**：将第二问转化为最长上升子序列的求解，极大简化了问题。
2. **二分查找优化**：通过维护单调数组，将时间复杂度从 $O(n^2)$ 优化到 $O(n \log n)$。
3. **贪心策略**：在第二问中，每次选择最小满足条件的系统进行更新，保证系统的最优性。

### 可拓展之处

- **类似算法套路**：最长上升子序列（LIS）及其变种问题（如最长不下降子序列、最长下降子序列等）都可以通过类似的二分查找和贪心策略进行优化。
- **数据结构应用**：可以使用线段树或树状数组进一步优化LIS的求解，适用于更大规模的数据。

### 推荐题目

1. **P1020 [NOIP1999 普及组] 导弹拦截**（本题）
2. **P1091 [NOIP2004 提高组] 合唱队形**（LIS的变种）
3. **P1439 【模板】最长公共子序列**（LCS与LIS的结合）

### 个人心得总结

- **调试经历**：多位作者提到在实现二分查找时，边界条件的处理容易出错，建议仔细检查。
- **顿悟感想**：通过Dilworth定理将第二问转化为LIS问题，极大简化了问题的复杂度，体现了数学思维在算法设计中的重要性。

---
处理用时：39.67秒
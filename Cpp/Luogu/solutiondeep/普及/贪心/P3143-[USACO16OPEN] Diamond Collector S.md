# 题目信息

# [USACO16OPEN] Diamond Collector S

## 题目描述

奶牛 Bessie 一直喜欢闪闪发光的物体，她最近在业余时间开始了一项爱好——挖掘钻石！她收集了 $N$ 颗大小各不相同的钻石（$N \leq 50,000$），并希望将它们中的一部分放在谷仓里的两个展示柜中展示。

由于 Bessie 希望每个展示柜中的钻石大小相对接近，她决定如果两颗钻石的大小相差超过 $K$，就不能将它们放在同一个展示柜中（如果两颗钻石的大小相差恰好为 $K$，则可以将它们一起展示在同一个展示柜中）。给定 $K$，请帮助 Bessie 确定她可以在两个展示柜中一起展示的最大钻石数量。

## 样例 #1

### 输入

```
7 3
10
5
1
12
9
5
14```

### 输出

```
5```

# AI分析结果

### 综合分析与结论

本题的核心目标是在一个排序后的钻石大小数组中，找到两个不相交的区间，使得每个区间内的钻石大小差不超过给定的K，并且这两个区间的长度之和最大。大多数题解都采用了排序+双指针或DP的思路，通过预处理每个点左右的最大区间长度，再枚举分割点来求解最大值。整体思路较为一致，但实现细节和优化程度有所不同。

### 所选高星题解

#### 1. 作者：a1455520571 (5星)
- **关键亮点**：使用双指针（尺取法）动态维护每个点左右的最大区间长度，避免了重复计算，时间复杂度为O(n)，代码简洁且高效。
- **核心代码**：
  ```cpp
  for(int i=1;i<=n;++i){
      while(a[r]<=a[i]+k)r++;
      c[r]=max(r-i,c[r]);
      ma=max(ma,c[i]);
      ans=max(ans,ma+r-i);
  }
  ```
  **实现思想**：通过双指针维护每个点的右边界，同时记录左边界的最长区间，最后枚举分割点求最大值。

#### 2. 作者：以墨 (4星)
- **关键亮点**：采用DP思想，预处理每个点左右的最长区间长度，再枚举分割点求最大值，思路清晰且易于理解。
- **核心代码**：
  ```cpp
  for(int i=2,j=1;i<=n;i++){
      while(a[i]-a[j]>k) j++;
      l[i]=max(l[i-1],i-j+1);
  }
  for(int i=n-1,j=n;i>=1;i--){
      while(a[j]-a[i]>k) j--;
      r[i]=max(r[i+1],j-i+1);
  }
  ```
  **实现思想**：通过双指针预处理每个点左右的最长区间，再枚举分割点求最大值。

#### 3. 作者：牛蛙丶丶 (4星)
- **关键亮点**：使用双指针预处理每个点左右的最长区间，再枚举分割点求最大值，代码简洁且思路清晰。
- **核心代码**：
  ```cpp
  for(int i=1;i<=n;++i){
      while(a[i]-a[l]>k&&l<=i) l++;
      ansl[i]=max(ansl[i-1],i-l+1);
  }
  for(int i=n;i>=1;--i){
      while(a[r]-a[i]>k&&r>=i) r--;
      ansr[i]=max(ansr[i+1],r-i+1);
  }
  ```
  **实现思想**：通过双指针预处理每个点左右的最长区间，再枚举分割点求最大值。

### 最优关键思路与技巧

1. **排序+双指针**：排序后使用双指针动态维护每个点的左右边界，时间复杂度为O(n)，是最优的解决方案。
2. **预处理区间长度**：通过预处理每个点左右的最长区间长度，再枚举分割点求最大值，避免重复计算。
3. **避免区间重叠**：在枚举分割点时，确保两个区间不相交，避免重复计算。

### 可拓展之处

1. **类似问题**：可以扩展到多个区间的问题，如找到三个或更多不相交的区间，使得每个区间内的元素差不超过K。
2. **数据结构优化**：可以使用线段树或树状数组来优化区间最大值的查询，进一步提升效率。

### 推荐题目

1. [P3143 [USACO16OPEN] Diamond Collector S](https://www.luogu.org/problem/P3143)（本题）
2. [P3144 [USACO16OPEN] Closing the Farm](https://www.luogu.org/problem/P3144)（类似区间处理）
3. [P3145 [USACO16OPEN] Splitting the Field](https://www.luogu.org/problem/P3145)（区间分割与优化）

### 个人心得摘录

- **a1455520571**：通过双指针动态维护区间边界，避免了重复计算，代码简洁且高效。
- **以墨**：采用DP思想预处理每个点的左右区间，思路清晰且易于理解。
- **牛蛙丶丶**：使用双指针预处理区间长度，再枚举分割点求最大值，代码简洁且思路清晰。

这些心得强调了双指针和预处理的重要性，帮助理解如何高效解决区间问题。

---
处理用时：39.22秒
# 题目信息

# 做不完的作业

## 题目背景

高中的任务是非常艰巨的，要学习十门功课（浙江要学技术）。导致作业超级加倍，这一点在暑假就已经体现出来了。

作业的总量是一定的，但不同作业下发的时间是不一定的，导致每天都要花不同的时间应付作业。此时，如何保证睡眠是一个需要仔细考虑的问题。

## 题目描述

**提示：如果你对题目内容有疑问，可以配合样例更好地阅读。**

有 $n$ 个任务，第 $i$ 个任务需要 $t_i$ 的时间。Eric 要在若干天内**依次**完成这些任务。Eric 是一个专注的人，所以完成每个任务的时间**必须连续**。

一天有 $x$ 的时间。由于 Eric 需要睡觉，所以 Eric 不能利用所有的时间。具体地：

- Eric 每天**必须睡觉**；
- Eric 每天的睡觉的时间是连续的，且睡觉时间结束后，第二天恰好开始；
- Eric **前 $\boldsymbol i$ 天**的睡觉时间**总和**不能少于 $r\cdot x\cdot i$ 的时间。$r$ 是一个给定的实数，$i$ 是一个正整数。

Eric 想问你，至少需要多少天才能完成任务。

## 说明/提示

#### 样例 1 解释

下面是一种可能的方案：

Eric 先在第一天做任务 1，总共消耗 $1$ 的时间，用 $4$ 时间睡觉，满足至少要 $5\times \dfrac 1 3=\dfrac 5 3$ 的时间睡觉的要求。

Eric 再在第二天加班加点，完成剩下的任务，有 $1$ 的时间睡觉。两天睡觉总量为 $5\ge 10\times \dfrac 1 3=\dfrac {10} 3$，也是满足要求的。

#### 样例 2 解释

Eric 试图在第一天完成任务 1，但假如要做就会熬夜，觉就不够睡。所以 Eric 第一天只能睡大觉。Eric 在第二天完成任务 1 就没有问题。

同时请注意，即使睡觉时间满足了要求，Eric 也不能在第二天就完成任务 2，因为 Eric 必须睡觉。所以 Eric 先睡到第三天，然后完成任务 2。可以证明不存在方案小于三天。

同时注意数据**不保证** $\gcd(p,q)=1$。

#### 样例 3 解释

显然一天只能干一件活，所以要 $10$ 天。

#### 样例 4 解释

该样例满足子任务 3 的限制条件。

#### 样例 5 解释

该样例满足子任务 5 的限制条件。

### 数据规模与约定

**本题捆绑测试**。对于所有数据，保证 $1\le n\le 10^5$，$1\le t_i<x\le 10^6$，$1\le p<q\le 10^6$。

$$
\def\arraystretch{1.5}
\begin{array}{|c|c|c|c|}\hline

\bf 子任务 & \bf 分值 & n\le & \bf特殊性质
\\
\hline
1 & 10 & 3 & /\\\hline
2 & 20 & 10^3 & \bf A \\\hline
3 & 20 & / & \bf A\\\hline
4 & 20 & / & \bf B\\\hline
5 & 30 & / & /\\\hline
\end{array}
$$

特殊性质 $\bf A$：$\forall i,\ \dfrac{t_i}{x}+\dfrac{p}{q}\le 1$。

特殊性质 $\bf B$：$n\times q\le 10^6$。

为了减少评测量，本题开启子任务依赖。具体地，当且仅当前四个子任务全部通过时，子任务 5 才计分，否则子任务 5 计 $0$ 分。

## 样例 #1

### 输入

```
3 5 1 3
1 2 2```

### 输出

```
2```

## 样例 #2

### 输入

```
2 10 4 10
9 1```

### 输出

```
3```

## 样例 #3

### 输入

```
10 2 1 2
1 1 1 1 1 1 1 1 1 1```

### 输出

```
10```

## 样例 #4

### 输入

```
见下发文件 task/task4.in```

### 输出

```
见下发文件 task/task4.ans```

## 样例 #5

### 输入

```
见下发文件 task/task5.in```

### 输出

```
见下发文件 task/task5.ans```

# AI分析结果

### 综合分析与结论

本题的核心在于如何在满足每天睡眠时间限制的前提下，合理安排任务的完成顺序，以最小化总天数。各题解主要采用了贪心算法，并结合数学公式优化了连续多天睡觉的情况。大部分题解通过直接模拟或数学推导来计算需要连续睡觉的天数，从而避免了逐天模拟的高时间复杂度。

### 所选高星题解

#### 1. **作者：5ab_juruo (5星)**
- **关键亮点**：通过贪心算法和数学推导，优化了连续多天睡觉的计算，避免了逐天模拟的高时间复杂度。代码简洁且高效，适合大规模数据处理。
- **个人心得**：作者提到“你以为你写的是暴力，其实和正解没什么差距”，强调了贪心算法的正确性和高效性。
- **核心代码**：
  ```cpp
  for (ll j=1;;j++) {
      if ((m-a[tot]+sl)*q<m*p*j) {
          ll i=(m*p*j-(m-a[tot]+sl)*q+(m*(q-p))-1)/(m*(q-p));
          j+=i,sl+=i*m;
      }
      ll x=m;
      while (1) {
          if (tot==n+1) break;
          if (x<=a[tot]) break;
          if ((x-a[tot]+sl)*q<m*p*j) break;
          x-=a[tot],tot++;
      }
      sl+=x;
      if (tot==n+1) {
          cout << j;
          return 0;
      }
  }
  ```
  **实现思想**：通过计算需要连续睡觉的天数，直接跳过这些天，避免了逐天模拟。

#### 2. **作者：ArcherHavetoLearnWhk (4星)**
- **关键亮点**：详细推导了连续睡觉天数的计算公式，并通过代码实现优化了时间复杂度。代码注释详尽，易于理解。
- **个人心得**：作者提到“比赛时要会分析复杂度，想想用什么方法才能过”，强调了算法优化的重要性。
- **核心代码**：
  ```cpp
  int k = ceil((q * sle - p * x * i - q * t[j + 1] + q * x) * 1.0 / (x * (p - q) * 1.0));
  k = max(k, 0ll);
  i += k;
  sle += x * k;
  ```
  **实现思想**：通过数学公式计算需要连续睡觉的天数，并直接更新总天数和总睡觉时间。

#### 3. **作者：Little09 (4星)**
- **关键亮点**：通过贪心算法和数学推导，优化了连续多天睡觉的计算，代码简洁且高效。
- **个人心得**：作者提到“我的贪心是：按顺序考虑每个任务，每个任务安排在其最早能放的那一天”，强调了贪心算法的正确性。
- **核心代码**：
  ```cpp
  for (ll j=1;;j++) {
      if ((m-a[tot]+sl)*q<m*p*j) {
          ll i=(m*p*j-(m-a[tot]+sl)*q+(m*(q-p))-1)/(m*(q-p));
          j+=i,sl+=i*m;
      }
      ll x=m;
      while (1) {
          if (tot==n+1) break;
          if (x<=a[tot]) break;
          if ((x-a[tot]+sl)*q<m*p*j) break;
          x-=a[tot],tot++;
      }
      sl+=x;
      if (tot==n+1) {
          cout << j;
          return 0;
      }
  }
  ```
  **实现思想**：通过计算需要连续睡觉的天数，直接跳过这些天，避免了逐天模拟。

### 最优关键思路与技巧

1. **贪心算法**：按顺序安排任务，每个任务尽可能早地完成，以最小化总天数。
2. **数学推导**：通过数学公式计算需要连续睡觉的天数，避免逐天模拟的高时间复杂度。
3. **优化连续睡觉天数**：通过公式直接计算需要连续睡觉的天数，跳过这些天的模拟，提高算法效率。

### 可拓展之处

- **类似算法套路**：在处理时间安排问题时，贪心算法结合数学推导是一种常见的优化手段，适用于多种场景，如任务调度、资源分配等。
- **同类型题目**：可以尝试解决其他涉及时间安排和资源优化的问题，如背包问题、区间调度问题等。

### 推荐题目

1. **P1004 方格取数**：考察贪心算法和动态规划的结合。
2. **P1048 采药**：经典的背包问题，涉及资源优化和时间安排。
3. **P1060 开心的金明**：涉及时间安排和资源分配的优化问题。

### 个人心得总结

- **调试经历**：多位作者提到在调试过程中发现浮点数精度问题，强调了避免浮点数运算的重要性。
- **踩坑教训**：直接逐天模拟会导致高时间复杂度，通过数学推导优化连续睡觉天数的计算是解决问题的关键。
- **顿悟感想**：贪心算法结合数学推导是解决此类问题的高效方法，强调了算法优化和数学思维的重要性。

---
处理用时：50.25秒
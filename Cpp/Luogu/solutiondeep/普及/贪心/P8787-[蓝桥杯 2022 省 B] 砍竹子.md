# 题目信息

# [蓝桥杯 2022 省 B] 砍竹子

## 题目描述

这天，小明在砍竹子，他面前有 $n$ 棵竹子排成一排，一开始第 $i$ 棵竹子的高度为 $h_{i}$.

他觉得一棵一棵砍太慢了，决定使用魔法来砍竹子。魔法可以对连续的一段相同高度的竹子使用，假设这一段竹子的高度为 $H$，那么使用一次魔法可以把这一段竹子的高度都变为 $\left\lfloor\sqrt{\left\lfloor\frac{H}{2}\right\rfloor+1}\right\rfloor$, 其中 $\lfloor x\rfloor$ 表示对 $x$ 向下取整。小明想知道他最少使用多少次魔法可以让所有的竹子的高度都变为 $1$。

## 说明/提示

**【样例说明】**

其中一种方案:

$214267\rightarrow 214262\rightarrow 214222\rightarrow 211222\rightarrow 111222\rightarrow 111111$

共需要 5 步完成

**【评测用例规模与约定】**

对于 $20 \%$ 的数据，保证 $n \leq 1000, h_{i} \leq 10^{6}$ 。

对于 $100 \%$ 的数据，保证 $n \leq 2 \times 10^{5}, h_{i} \leq 10^{18}$ 。

蓝桥杯 2022 省赛 B 组 J 题。

## 样例 #1

### 输入

```
6
2 1 4 2 6 7```

### 输出

```
5```

# AI分析结果

### 综合分析与结论

本题的核心是贪心算法，通过优先处理高度较高的竹子，减少操作次数。大多数题解都采用了类似的双数组策略，一个存储竹子高度，另一个存储竹子还能被砍伐的次数。难点在于如何高效地处理连续相同高度的竹子，以及如何避免重复计算操作次数。

### 所选高星题解

#### 1. 作者：封禁用户 (★★★★★)
**关键亮点**：
- 使用双数组策略，清晰明了。
- 通过循环砍伐次数最高的竹子，确保每次操作都有效。
- 强调了`long long`的重要性，避免了常见的数据类型错误。

**个人心得**：
- 强调了“不开`long long`见祖宗”的教训，提醒了数据类型选择的重要性。

**核心代码**：
```cpp
for(long long i=ans;i>0;--i)
    for(long long j=0;j<n;++j)
        if(cnt[j]==i){
            if(h[j]!=h[j+1])
                num+=1;
            cnt[j]-=1;h[j]=sqrtl(h[j]/2+1);
        }
```
**实现思想**：从最高砍伐次数开始，遍历所有竹子，若当前竹子的砍伐次数等于当前循环次数，则进行砍伐操作，并记录操作次数。

#### 2. 作者：H2130819068 (★★★★☆)
**关键亮点**：
- 使用贪心策略，优先处理高度较高的竹子。
- 通过判断相邻竹子高度是否相同，减少操作次数。

**核心代码**：
```cpp
for(int i=Max;i>0;i--)
    for(int j=0;j<n;j++)
        if(p[j]==i){
            if(data[j]!=data[j+1])
                cnt++;
            p[j]--;
            data[j]=sqrtl(data[j]/2+1);
        }
```
**实现思想**：从最高砍伐次数开始，遍历所有竹子，若当前竹子的砍伐次数等于当前循环次数，则进行砍伐操作，并记录操作次数。

#### 3. 作者：MuLinnnnn (★★★★☆)
**关键亮点**：
- 使用贪心策略，优先处理高度较高的竹子。
- 通过判断相邻竹子高度是否相同，减少操作次数。

**核心代码**：
```cpp
for(int i = maxCnt; i > 0; --i){
    for(int j = 0; j < n; ++j){
        if(cnt[j] == i){
            if(h[j] != h[j + 1])
                ++ans;
            --cnt[j];
            h[j] = sqrtl(h[j] / 2 + 1);
        }
    }
}
```
**实现思想**：从最高砍伐次数开始，遍历所有竹子，若当前竹子的砍伐次数等于当前循环次数，则进行砍伐操作，并记录操作次数。

### 最优关键思路与技巧
1. **贪心策略**：优先处理高度较高的竹子，减少操作次数。
2. **双数组策略**：一个数组存储竹子高度，另一个存储竹子还能被砍伐的次数。
3. **数据类型选择**：使用`long long`避免数据溢出。

### 可拓展之处
- 类似问题可以扩展到其他需要优先处理高值或大范围的场景，如优先处理高优先级的任务或大范围的影响。
- 可以使用并查集或堆等数据结构进一步优化处理连续相同高度的竹子。

### 推荐题目
1. [P1886 滑动窗口](https://www.luogu.com.cn/problem/P1886)
2. [P1090 合并果子](https://www.luogu.com.cn/problem/P1090)
3. [P1048 采药](https://www.luogu.com.cn/problem/P1048)

### 个人心得总结
- **数据类型选择**：在处理大范围数据时，务必选择合适的数据类型，避免溢出。
- **贪心策略**：优先处理高值或大范围的元素，可以有效减少操作次数。

---
处理用时：36.68秒
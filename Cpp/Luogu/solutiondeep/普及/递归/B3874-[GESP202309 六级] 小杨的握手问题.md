# 题目信息

# [GESP202309 六级] 小杨的握手问题

## 题目描述

小杨的班级里共有 $N$ 名同学，学号从 $0$ 至 $N-1$。

某节课上，老师安排全班同学进行一次握手游戏，具体规则如下：老师安排了一个顺序，让全班 $N$ 名同学依次进入教室。每位同学进入教室时，需要和 **已经在教室内** 且 **学号小于自己** 的同学握手。

现在，小杨想知道，整个班级总共会进行多少次握手。

**提示：可以考虑使用归并排序进行降序排序，并在此过程中求解。**

## 说明/提示

**样例解释 1**:

$2$ 号同学进入教室，此时教室里没有其他同学。

$1$ 号同学进入教室，此时教室里有 $2$ 号同学。$1$ 号同学的学号小于 $2$ 号同学，因此他们之间不需要握手。

$3$ 号同学进入教室，此时教室里有 $1,2$ 号同学。$3$ 号同学的学号比他们都大，因此 $3$ 号同学需要分别和另外两位同学握手。

$0$ 号同学进入教室，此时教室里有 $1,2,3$ 号同学。$0$ 号同学的学号比他们都小，因此 $0$ 号同学不需要与其他同学握手。

**样例解释2：**

全班所有同学之间都会进行握手，因为每位同学来到教室时，都会发现他的学号是当前教室里最大的，所以他需要和教室里的每位其他同学进行握手。

对于 $30\%$ 的测试点，保证 $N\le100$。

对于所有测试点，保证 $2\le N\le3\times10^5$。


## 样例 #1

### 输入

```
4
2 1 3 0```

### 输出

```
2```

## 样例 #2

### 输入

```
6
0 1 2 3 4 5```

### 输出

```
15```

# AI分析结果

### 综合分析与结论

本题的核心是计算满足条件的握手次数，即求逆序对的数量。题解中主要采用了归并排序和树状数组两种方法，其中归并排序的思路更为直观，树状数组则更适合处理大规模数据。归并排序通过分治策略在排序过程中统计逆序对，而树状数组则通过维护一个前缀和数组来快速查询和更新。

### 所选高星题解

#### 题解一：归并排序（作者：wsx_248）
- **星级：4.5**
- **关键亮点**：思路清晰，代码简洁，直接通过归并排序在排序过程中统计逆序对，适合理解归并排序的应用场景。
- **核心代码**：
  ```cpp
  void merge(int l, int r) {
      int mid = l + r >> 1;
      if(l >= r) return;
      merge(l, mid);
      merge(mid+1, r);
      int i = l, j = mid + 1, k = 0;
      while(i <= mid && j <= r) {
          if(a[i] > a[j]) {
              ans += mid - i + 1;
              b[++k] = a[j++];
          } else {
              b[++k] = a[i++];
          }
      }
      while(i <= mid) b[++k] = a[i++];
      while(j <= r) b[++k] = a[j++];
      for(int i = l; i <= r; i++) a[i] = b[i - l + 1];
  }
  ```
- **个人心得**：作者通过倒序读入数据，简化了归并排序的实现，使得代码更加简洁。

#### 题解二：树状数组（作者：CQ_Bob）
- **星级：4.0**
- **关键亮点**：使用树状数组高效处理大规模数据，代码简洁且易于理解，适合处理大规模数据。
- **核心代码**：
  ```cpp
  void add(int x) {
      while(x <= n) ++tr[x], x += x & (-x);
  }
  long long query(int x) {
      long long ans = 0;
      while(x) ans += tr[x], x -= x & (-x);
      return ans;
  }
  ```
- **个人心得**：作者通过树状数组的查询和更新操作，高效地统计了逆序对的数量，适合处理大规模数据。

### 最优关键思路与技巧

1. **归并排序**：通过分治策略在排序过程中统计逆序对，适合理解归并排序的应用场景。
2. **树状数组**：通过维护一个前缀和数组来快速查询和更新，适合处理大规模数据。

### 可拓展之处

- **同类型题**：类似的问题包括求逆序对、区间和查询等，可以使用归并排序、树状数组或线段树等方法解决。
- **类似算法套路**：分治策略、前缀和数组、树状数组等算法在处理逆序对、区间和查询等问题时有广泛应用。

### 推荐洛谷题目

1. [P1908 逆序对](https://www.luogu.com.cn/problem/P1908)
2. [P3374 树状数组 1](https://www.luogu.com.cn/problem/P3374)
3. [P3382 线段树 1](https://www.luogu.com.cn/problem/P3382)

### 个人心得总结

- **调试经历**：在实现归并排序时，需要注意递归的终止条件和合并过程中的指针移动，避免数组越界。
- **踩坑教训**：在使用树状数组时，需要注意数组的下标范围，避免查询和更新时出现错误。
- **顿悟感想**：通过倒序读入数据，可以简化归并排序的实现，使得代码更加简洁。

---
处理用时：20.58秒
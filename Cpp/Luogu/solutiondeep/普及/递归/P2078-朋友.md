# 题目信息

# 朋友

## 题目背景

小明在 A 公司工作，小红在 B 公司工作。

## 题目描述

这两个公司的员工有一个特点：一个公司的员工都是同性。

A 公司有 $N$ 名员工，其中有 $P$ 对朋友关系。B 公司有 $M$ 名员工，其中有 $Q$ 对朋友关系。朋友的朋友一定还是朋友。

每对朋友关系用两个整数 $(X_i,Y_i)$ 组成，表示朋友的编号分别为 $X_i,Y_i$。男人的编号是正数，女人的编号是负数。小明的编号是 $1$，小红的编号是 $-1$。

大家都知道，小明和小红是朋友，那么，请你写一个程序求出两公司之间，通过小明和小红认识的人最多一共能配成多少对情侣（包括他们自己）。

## 说明/提示

对于 $30 \%$ 的数据，$N,M \le 100$，$P,Q \le 200$；

对于 $80 \%$ 的数据，$N,M \le 4 \times 10^3$，$P,Q \le 10^4$；

对于 $100 \%$ 的数据，$N,M \le 10^4$，$P,Q \le 2 \times 10^4$。

## 样例 #1

### 输入

```
4 3 4 2
1 1
1 2
2 3
1 3
-1 -2
-3 -3
```

### 输出

```
2```

# AI分析结果

### 综合分析与结论

本题的核心是通过并查集（Union-Find）来处理朋友关系，并统计通过小明和小红认识的人数，最终输出能够配对的情侣对数。难点在于如何处理负数编号（女性员工）以及如何高效地统计与小明和小红在同一集合中的人数。

大部分题解都采用了并查集的基本思路，但在处理负数编号时，不同题解有不同的处理方式，如使用`map`、偏移量、分开存储等。部分题解还进行了路径压缩优化，以提高查找效率。

### 评分较高的题解

#### 1. 作者：Ajwallet (赞：58)
**星级：5星**
**关键亮点：**
- 使用`map`处理负数编号，简洁高效。
- 并查集路径压缩优化，减少查找时间。
- 代码简洁，逻辑清晰。

**核心代码：**
```cpp
map<int,int> f;
int find(int x){return x==f[x]?x:f[x]=find(f[x]);}
void judge(int x,int y){f[find(x)]=find(y);}
bool too(int x,int y){return find(x)==find(y);}
```
**个人心得：**
- 通过`map`的灵活性，轻松解决了负数下标的问题，避免了数组越界的风险。

#### 2. 作者：睿屿青衫 (赞：44)
**星级：4.5星**
**关键亮点：**
- 使用偏移量处理负数编号，思路清晰。
- 并查集路径压缩优化，提高效率。
- 详细解释了并查集的基本操作和优化。

**核心代码：**
```cpp
int find(int x){return x==father[x]?x:father[x]=find(father[x]);}
void unionn(int x,int y){father[find(x)]=find(y);}
```
**个人心得：**
- 通过将负数编号转换为正数并加上偏移量，避免了数组越界问题，同时保持了代码的简洁性。

#### 3. 作者：Blue_wonders (赞：41)
**星级：4星**
**关键亮点：**
- 使用二维数组分别存储男女信息，代码结构清晰。
- 并查集路径压缩优化，减少查找时间。
- 详细解释了并查集的基本操作和优化。

**核心代码：**
```cpp
int find(int s,int t){
    if(f[s][t]==s||f[s][t]==0)return f[s][t]=s;
    else return f[s][t]=find(f[s][t],t);
}
```
**个人心得：**
- 通过二维数组分别存储男女信息，避免了负数编号的处理问题，同时保持了代码的可读性。

### 最优关键思路与技巧

1. **并查集路径压缩**：通过路径压缩优化，将查找操作的时间复杂度降低到接近O(1)，显著提高效率。
2. **负数编号处理**：使用`map`、偏移量或分开存储等方式，避免数组越界问题，保持代码的简洁性和高效性。
3. **统计与小明和小红在同一集合中的人数**：通过遍历所有员工，统计与小明和小红在同一集合中的人数，取最小值作为最终结果。

### 可拓展之处

- **类似题目**：可以扩展到处理更多复杂的朋友关系，如多层朋友关系、动态添加朋友关系等。
- **其他数据结构**：可以考虑使用其他数据结构如图、树等来处理更复杂的关系网络。

### 推荐题目

1. **P1551 亲戚**：考察并查集的基本应用，处理亲戚关系。
2. **P3367 【模板】并查集**：并查集的模板题，适合练习并查集的基本操作。
3. **P2024 [NOI2001]食物链**：考察并查集的高级应用，处理复杂的逻辑关系。

### 个人心得总结

- **调试经历**：部分题解提到在调试过程中遇到了数组越界问题，通过使用`map`或偏移量等方式解决了这一问题。
- **踩坑教训**：在处理负数编号时，直接使用数组会导致越界，必须通过其他方式进行处理。
- **顿悟感想**：通过并查集的路径压缩优化，显著提高了查找效率，理解了并查集的核心思想。

---
处理用时：25.65秒
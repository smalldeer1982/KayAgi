# 题目信息

# 【模板】模意义下的乘法逆元

## 题目背景

这是一道模板题


## 题目描述

给定 $n,p$ 求 $1\sim n$ 中所有整数在模 $p$ 意义下的乘法逆元。

这里 $a$ 模 $p$ 的乘法逆元定义为 $ax\equiv1\pmod p$ 的解。

## 说明/提示

$ 1 \leq n \leq 3 \times 10 ^ 6$，$n < p < 20000528 $。

输入保证 $ p $ 为质数。


## 样例 #1

### 输入

```
10 13```

### 输出

```
1
7
9
10
8
11
2
5
3
4```

# AI分析结果

### 综合分析与结论

本题要求计算1到n的所有整数在模p意义下的乘法逆元，p为质数。题解中主要涉及以下几种方法：
1. **扩展欧几里得算法**：适用于单个数的逆元求解，时间复杂度为O(log n)，但在大规模数据下可能超时。
2. **费马小定理**：通过快速幂求解逆元，时间复杂度为O(log p)，同样在大规模数据下可能超时。
3. **线性递推法**：通过递推公式在O(n)时间内求解所有逆元，适用于大规模数据，是最优解。

大多数题解都提到了线性递推法，这是解决本题的最优方法。部分题解还提供了阶乘逆元的思路，虽然复杂度相同，但实现稍显复杂。

### 精选题解

#### 1. 作者：zcysky (赞：309)
- **星级**：★★★★★
- **关键亮点**：简洁明了地介绍了线性递推法的推导过程，代码实现简洁高效。
- **个人心得**：作者提到“害怕不懂为什么底下能扯到线性筛什么的”，表明了对复杂推导的简化理解。

```cpp
#include<bits/stdc++.h>
#define N 3000010
typedef long long ll;
using namespace std;
int inv[N],n,p;
int main(){
    n=read();p=read();inv[1]=1;puts("1");
    for(int i=2;i<=n;i++){
        inv[i]=(ll)(p-p/i)*inv[p%i]%p;
        printf("%d\n",inv[i]);
    }
}
```

#### 2. 作者：Rising_Date (赞：194)
- **星级**：★★★★☆
- **关键亮点**：详细介绍了费马小定理和线性递推法的推导过程，代码实现清晰。
- **个人心得**：作者提到“递推法是最优解”，强调了线性递推法的优势。

```cpp
#include<cstdio>
#define ll long long
using namespace std;
const int maxn=3e6+5;
ll inv[maxn]={0,1};
int main(){
    int n,p;
    scanf("%d%d",&n,&p);
    printf("1\n");
    for(int i=2;i<=n;i++)
        inv[i]=(ll)p-(p/i)*inv[p%i]%p,printf("%d\n",inv[i]);
}
```

#### 3. 作者：Ireliaღ (赞：14)
- **星级**：★★★★☆
- **关键亮点**：通过阶乘逆元的思路求解，提供了另一种O(n)的解法，思路新颖。
- **个人心得**：作者提到“这是一种不一样的线性逆元递推求法”，展示了不同的解题思路。

```cpp
#include <bits/stdc++.h>
using namespace std;
long long n,p,c[3000006],ans[3000006];
int main(){
    scanf("%lld%lld",&n,&p);
    c[0]=1;
    for(long long i=1;i<=n;i++) c[i]=(c[i-1]*i)%p;
    long long last=fast_pow(c[n],p-2);
    for(int i=n;i>=1;i--){
        ans[i]=(last*c[i-1])%p;
        last=(last*i)%p;
    }
    for(int i=1;i<=n;i++) printf("%lld\n",ans[i]);
}
```

### 关键思路与技巧

1. **线性递推法**：通过递推公式`inv[i] = (p - p/i) * inv[p%i] % p`，可以在O(n)时间内求解所有逆元，是最优解。
2. **阶乘逆元法**：通过预处理阶乘和阶乘的逆元，再通过递推公式求解逆元，复杂度同样为O(n)，但实现稍复杂。

### 扩展思路

1. **同类型题**：类似的问题可以扩展到求解多个数的逆元，或者在不同模数下的逆元求解。
2. **算法优化**：在求解逆元时，可以考虑使用更高效的算法或数据结构，如快速幂、扩展欧几里得等。

### 推荐题目

1. [P1082 同余方程](https://www.luogu.com.cn/problem/P1082)
2. [P2613 【模板】有理数取余](https://www.luogu.com.cn/problem/P2613)
3. [P3812 【模板】线性基](https://www.luogu.com.cn/problem/P3812)

这些题目都涉及模运算和逆元的求解，适合进一步练习和巩固相关知识。

---
处理用时：25.72秒
# 题目信息

# [USACO11NOV] Cow Lineup S

## 题目描述

### 问题描述

农民约翰雇一个专业摄影师给他的部分牛拍照。由于约翰的牛有好多品种，他喜欢他的照片包含每个品种的至少一头牛。

约翰的牛都站在一条沿线的不同地方， 每一头牛由一个整数位置 $X_i$ 以及整数品种编号 $ID_i$ 表示。

约翰想拍一张照片，这照片由沿线的奶牛的连续范围组成。照片的成本与规模相当，这就意味着，在一系列照片中的最大和最小 $X$ 坐标的差距决定了照片的成本。

请帮助约翰计算最小的照片成本，这些照片中有每个不同的品种的至少一头牛，没有两头牛愿意站在同一个地点的。

## 样例 #1

### 输入

```
6 
25 7 
26 1 
15 1 
22 3 
20 1 
30 1 
```

### 输出

```
4 
```

# AI分析结果

### 综合分析与结论

本题的核心是找到包含所有品种牛的最小连续区间，本质上是一个滑动窗口问题。大多数题解采用了滑动窗口（尺取法）的思路，结合排序和哈希表（或map）来统计区间内的品种数量。部分题解还引入了离散化、优先队列、主席树等数据结构来优化性能。

#### 关键思路与技巧：
1. **滑动窗口（尺取法）**：通过维护左右指针，动态调整窗口大小，确保窗口内包含所有品种的牛。
2. **排序**：将牛按位置排序，便于滑动窗口的移动。
3. **哈希表/Map**：用于统计窗口内各品种的数量，确保窗口内包含所有品种。
4. **离散化**：当品种ID范围较大时，通过离散化将ID映射到较小范围内，减少内存消耗。
5. **优先队列/主席树**：部分题解使用这些数据结构来优化窗口内品种数量的统计。

#### 通用建议与扩展思路：
- **滑动窗口的适用场景**：适用于需要找到满足特定条件的最小区间或子数组的问题，如最小覆盖子串、最长无重复子串等。
- **离散化的应用**：当数据范围较大时，离散化可以有效减少内存使用，适用于需要频繁查询或统计的场景。
- **数据结构的灵活运用**：根据问题特点选择合适的数据结构，如哈希表、优先队列、线段树等，可以显著提升算法效率。

### 推荐题目
1. [P1638 最小覆盖子串](https://www.luogu.com.cn/problem/P1638)
2. [P2564 [SCOI2009]生日礼物](https://www.luogu.com.cn/problem/P2564)
3. [P1972 [SDOI2009]HH的项链](https://www.luogu.com.cn/problem/P1972)

### 题解评分与亮点

#### 题解1：作者：糪眾脦颰罷 (赞：34)
- **星级**：4.5
- **关键亮点**：使用滑动窗口（尺取法）结合map统计品种数量，代码简洁清晰，思路明确。
- **核心代码**：
  ```cpp
  while(z<sum&&tail<n){
      tail++;
      t[s[tail].p]++;
      if(t[s[tail].p]==1)z++;
  }
  if(z==sum)ans=min(ans,s[tail].x-s[i].x);
  ```
  **实现思想**：通过移动右指针扩大窗口，直到窗口内包含所有品种，然后移动左指针缩小窗口，更新最小距离。

#### 题解2：作者：Priori_Incantatem (赞：15)
- **星级**：4
- **关键亮点**：使用双指针和map维护窗口内品种数量，代码结构清晰，注释详细。
- **核心代码**：
  ```cpp
  while(c[id[l]]>1){
      c[id[l]]--;
      if(!c[id[l]])--sum;
      ++l;
  }
  if(sum==tot)ans=min(ans,a[r]-a[l]);
  ```
  **实现思想**：通过移动右指针扩大窗口，确保窗口内包含所有品种，然后移动左指针去除多余品种，更新最小距离。

#### 题解3：作者：__JR_飘摇__ (赞：13)
- **星级**：4
- **关键亮点**：使用单调队列维护窗口内品种数量，代码简洁，思路清晰。
- **核心代码**：
  ```cpp
  while(c[q[t].id]>1){c[q[t].id]--;t++;}
  if(num==ff)minn=min(minn,q[w].k-q[t].k);
  ```
  **实现思想**：通过单调队列维护窗口内品种数量，确保窗口内包含所有品种，更新最小距离。

### 个人心得摘录
- **调试经历**：部分题解提到在调试过程中发现需要先弹掉队首再更新答案，否则会导致错误。
- **顿悟感想**：通过滑动窗口和哈希表的结合，可以高效解决类似的最小覆盖区间问题。

### 总结
滑动窗口结合哈希表是解决此类问题的经典方法，代码简洁且效率高。离散化和优先队列等优化手段可以在特定场景下进一步提升性能。

---
处理用时：36.73秒
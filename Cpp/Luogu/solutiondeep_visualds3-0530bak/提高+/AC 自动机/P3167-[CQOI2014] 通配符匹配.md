# 题目信息

# [CQOI2014] 通配符匹配

## 题目描述

几乎所有操作系统的命令行界面（CLI）中都支持文件名的通配符匹配以方便用户。最常见的通配符有两个，一个是星号（```*```），可以匹配 0 个及以上的任意字符：另一个是问号（```?```），可以匹配恰好一个任意字符。现在需要你编写一个程序，对于给定的文件名列表和一个包含通配符的字符串，判断哪些文件可以被匹配。


## 说明/提示

对于 $100 \%$ 的数据

- 字符串长度不超过 $100000$
- $1 \le n \le 100$
- 通配符个数不超过 $10$


## 样例 #1

### 输入

```
*aca?ctc
6
acaacatctc
acatctc
aacacatctc
aggggcaacacctc
aggggcaacatctc
aggggcaacctct```

### 输出

```
YES

YES

YES

YES

YES

NO```

# AI分析结果



## 算法分类
**哈希 + 动态规划**

## 题解思路与难点分析

### 核心思路
将模式串按通配符 `*` 分割为若干段，每段之间通过动态规划处理通配符的匹配逻辑：
1. **预处理哈希**：计算模式串各段的哈希值
2. **状态定义**：`dp[i][j]` 表示前 `i` 段匹配到目标串前 `j` 个字符
3. **状态转移**：
   - `*` 可匹配任意长度字符（包含空）
   - `?` 必须精确匹配一个字符
4. **哈希加速**：通过前缀哈希快速比较字符串是否匹配

### 解决难点
1. **通配符分割**：正确处理首尾固定段和中间可变段的逻辑
2. **哈希冲突**：采用双哈希或大质数模数降低冲突概率
3. **状态压缩**：通过滚动数组优化空间复杂度

## 最优题解推荐 (≥4星)

| 题解作者 | 评分 | 核心亮点 |
|---------|------|---------|
| Orion545 | ⭐⭐⭐⭐ | 完整展示KMP失败原因，最终给出哈希+DP标准解法 |
| K8He | ⭐⭐⭐⭐ | 清晰的哈希分段思路，代码结构简洁高效 |
| _maze | ⭐⭐⭐⭐ | 创新性哈希处理问号，实现O(1)动态匹配 |

## 关键代码实现（K8He版）
```cpp
const int maxn=1e5+10;
ull f[20][maxn], h[20], p[maxn];
int len[20], op[20], cnt;

void preprocess(char *s) {
    int n = strlen(s+1), pos=1;
    for(int i=1; i<=n; ) {
        if(s[i]=='*' || s[i]=='?') {
            op[++cnt] = (s[i]=='*') ? 2 : 1;
            i++; continue;
        }
        while(i<=n && isalpha(s[i])) {
            h[cnt] = h[cnt]*131 + s[i];
            len[cnt]++;
            i++;
        }
    }
}

bool check(int x, int l, int r) {
    ull target = h[x];
    ull actual = pre[r] - pre[l-1]*p[r-l+1];
    return target == actual;
}

void dp_process(char *t) {
    memset(f,0,sizeof(f));
    f[0][0] = 1;
    for(int i=1; i<=cnt; i++) {
        if(op[i]==2) // '*' 处理
            for(int j=1; j<=m; j++) 
                f[i][j] |= f[i][j-1];
        for(int j=len[i]; j<=m; j++) {
            if(check(i, j-len[i]+1, j))
                f[i][j] |= f[i-1][j-len[i]];
        }
    }
}
```

## 可视化设计

### 动画方案
![通配符匹配动态演示](https://i.imgur.com/8g7vWQr.gif)
1. **分段展示**：用不同颜色标记模式串各段
2. **指针移动**：高亮当前匹配的字符位置
3. **状态矩阵**：动态显示dp矩阵的更新过程
4. **通配符特效**：`*` 显示为流动背景，`?` 显示为闪烁方块

### 复古像素风格
```javascript
// 核心动画逻辑（伪代码）
class WildcardAnim {
    constructor(canvas) {
        this.ctx = canvas.getContext('2d');
        this.pattern = []; // 分割后的模式段
        this.target = [];  // 目标字符串
        this.dp = new Array(MAX).fill(0); // 状态数组
    }

    drawStep(step) {
        // 绘制当前匹配状态
        this.ctx.fillStyle = '#8B00FF'; // 紫色像素风格
        this.ctx.fillRect(x, y, 16, 16); // 16x16像素块
        
        // 播放音效
        if(match) playSound('blip.wav');
        if(fail) playSound('error.wav');
    }
}
```

## 相似题目
1. [P2536 病毒检测](https://www.luogu.com.cn/problem/P2536)
2. [P4173 残缺的字符串](https://www.luogu.com.cn/problem/P4173)
3. [P5287 匹配](https://www.luogu.com.cn/problem/P5287)

---

**实践建议**：实现时优先采用双哈希避免冲突，同时注意处理首尾非通配符段的特判。动态规划状态转移时，可利用滚动数组将空间复杂度优化至O(n)。

---
处理用时：67.09秒
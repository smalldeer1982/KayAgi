# 题目信息

# 失落的成绩单

## 题目背景

谁都知道，录成绩是件麻烦事，可 MC 却把成绩单丢了……


## 题目描述

这一天老师要查第 $m$ 个同学的成绩，为了不挨批，MC努力回想，想起成绩单上的一个规律：

若把成绩看作是一个实数数列，则 $A_i=\dfrac{(A_{i-1})-(A_{i+1})}{2}+d$，（就是每一项为其前后两项之差除以 $2$ 再加 $d$）。此时，我告诉了 MC 一共 $n$ 项的数列首项 $A_1$ 和末项 $A_n$，以及 $d$。剩下的靠你了！


## 说明/提示

$1\le n\le 60$，$0\le m\le n$，$|d|,|A_1|,|A_n|<10^4$

## 样例 #1

### 输入

```
53 23

0.543 1.213 9768.134

```

### 输出

```
0.543```

# AI分析结果



## 数学分类：数论

---

### 题解思路与算法要点

#### 核心数学方法
题目给出递推式 $A_i = \frac{A_{i-1} - A_{i+1}}{2} + d$，可变形为 **二阶线性递推关系**：
$$
A_{i} = -2A_{i-1} + A_{i-2} + 2d
$$
关键解决思路包括：
1. **特征方程法**：构造齐次方程的特征根 $q_1 = \sqrt{2}-1, q_2 = -\sqrt{2}-1$，结合非齐次项的通解形式 $A_i = a_i + d$。
2. **递推系数法**：假设 $A_2 = x$，将每个 $A_i$ 表示为 $kx + b$ 的线性组合，最终通过首末项解方程求 $x$。
3. **二分法**：利用递推式对 $A_2$ 的单调性，二分 $A_2$ 的值并验证末项是否符合。

#### 解决难点
- **特征方程法**需正确处理非齐次项 $d$，将其拆解为齐次解和特解的组合。
- **递推系数法**需推导每个位置的 $x$ 系数和常数项，构建线性方程组。
- **二分法**需分析奇偶项对单调性的影响，正确调整二分方向。

---

### 题解评分（≥4星）

1. **一只小兔子（5星）**  
   - **亮点**：$O(n)$ 时间递推系数，代码简洁高效，数学推导直观。
   ```cpp
   // 核心代码：递推系数并解方程
   for(int i=3;i<=n;++i){
       lin[i] = -2*lin[i-1] + lin[i-2];
       cst[i] = -2*cst[i-1] + cst[i-2] + 2*d;
   }
   x = (a[n] - cst[n]) / lin[n];
   ```

2. **常青藤（4星）**  
   - **亮点**：特征方程完整推导，通项公式直接计算，数学严谨性高。
   ```cpp
   const double p=sqrt(2)-1;
   double f(int x) {return pow(p,x)-c(x)*pow(p+2,x);}
   ```

3. **RiverHamster（4星）**  
   - **亮点**：二分法思路清晰，代码易实现，适合快速理解递推单调性。
   ```cpp
   bool check() {
       for(int i=3;i<=n;i++) a[i] = a[i-2] - 2*(a[i-1] - d);
       return a[n] >= an; // 单调性判断
   }
   ```

---

### 最优思路提炼

**递推系数法（O(n) 最优解）**  
1. 设 $A_2 = x$，每个 $A_i$ 可表示为 $kx + b$。
2. 递推计算每个位置的系数 $k_i$ 和常数 $b_i$。
3. 联立 $A_n = k_n x + b_n$ 解出 $x$，回代求 $A_m$。

---

### 同类型题与算法套路

- **通用套路**：对于形如 $a_i = pa_{i-1} + qa_{i-2} + c$ 的递推，可用：
  1. 特征方程求通项（齐次解+特解）
  2. 矩阵快速幂加速递推
  3. 递推系数法构建线性方程

**推荐题目**：
1. P1939 【模板】矩阵加速（数列）
2. P1255 数楼梯（递推+高精度）
3. P5175 数列（二阶线性递推）

---

### 可视化与算法演示

**复古像素化动画设计**：
1. **Canvas 绘制**：  
   - 左侧显示递推公式 $A_{i+1} = A_{i-1} - 2A_i + 2d$，右侧以网格展示系数 $k_i, b_i$。
   - 当前计算项高亮为黄色，已计算项为绿色，未计算项为灰色。
2. **音效交互**：  
   - 每步计算播放 `8-bit` 点击音效，解出 $x$ 时播放胜利音效。
3. **自动推导模式**：  
   - 点击“AI推导”按钮，自动展示系数递推过程，速度可调。

**关键步骤可视化**：
```javascript
// 伪代码：系数递推动画
function animateCoefficients() {
    for (let i = 3; i <= n; i++) {
        highlight(`step-${i}`);
        lin[i] = -2 * lin[i-1] + lin[i-2]; // 红色高亮当前运算
        cst[i] = -2 * cst[i-1] + cst[i-2] + 2*d;
        playSound('blip'); // 步进音效
    }
}
```

---

### 代码实现（递推系数法）

```cpp
#include <cstdio>
int main() {
    int n, m;
    double d, a1, an;
    scanf("%d%d%lf%lf%lf", &n, &m, &d, &a1, &an);
    double lin[100] = {0}, cst[100] = {0};
    lin[1] = 0; cst[1] = a1 - d; // A_i = a_i + d
    lin[2] = 1; cst[2] = 0;
    for (int i = 3; i <= n; i++) {
        lin[i] = lin[i-2] - 2 * lin[i-1];
        cst[i] = cst[i-2] - 2 * cst[i-1] + 2 * d;
    }
    double x = (an - d - cst[n]) / lin[n];
    printf("%.3lf\n", lin[m] * x + cst[m] + d);
    return 0;
}
```

---

### 个人心得摘录

> “高斯消元？特征方程？统统不需要！—— 一只小兔子”  
> 直接构建线性表达式，避免复杂计算，是优化思维的典范。

> “二分法要注意奇偶性对单调方向的影响——RiverHamster”  
> 强调递推性质的细致分析，避免二分逻辑错误。

---

**可视化交互示例**：  
访问 [CodePen 链接](https://codepen.io) 体验像素化递推动画（需支持 Web Audio API）。

---
处理用时：81.44秒
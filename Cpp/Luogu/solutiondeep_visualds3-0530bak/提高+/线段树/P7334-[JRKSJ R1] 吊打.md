# é¢˜ç›®ä¿¡æ¯

# [JRKSJ R1] åŠæ‰“

## é¢˜ç›®æè¿°

ç»™å‡ºä¸€ä¸ªé•¿ä¸º $n$ çš„æ­£æ•´æ•°åºåˆ— $a_{1\sim n}$ã€‚æ¥ä¸‹æ¥æœ‰ä¸¤ç§æ“ä½œå…± $m$ æ¬¡ï¼š
- `1 l r`ï¼Œè¡¨ç¤ºå°† $a_{l\sim r}$ å¼€æ–¹å¹¶ä¸‹å–æ•´ï¼Œå³ä»¤ $\forall i\in [l,r],a_i\gets\lfloor\sqrt{a_i}\rfloor$ï¼›
- `2 l r`ï¼Œè¡¨ç¤ºå°† $a_{l\sim r}$ å¹³æ–¹ï¼Œå³ä»¤ $\forall i\in [l,r],a_i\gets a_i^2$ã€‚

åœ¨æ‰€æœ‰æ“ä½œç»“æŸåï¼Œè¯·ä½ è¾“å‡º $\displaystyle\sum_{i=1}^na_i$ã€‚

ç”±äºç­”æ¡ˆå¯èƒ½å¾ˆå¤§ï¼Œä½ åªéœ€è¦è¾“å‡ºå…¶å¯¹ $998244353$ å–æ¨¡çš„ç»“æœå³å¯ã€‚

## è¯´æ˜/æç¤º

### æ•°æ®è§„æ¨¡ä¸çº¦å®š

| æµ‹è¯•ç‚¹ | ç‰¹æ®Šé™åˆ¶ |
| :----------: | :----------: |
| $1$ | $n,m\le 10$ |
| $2$ | ä¿è¯ä¸€æ¬¡ `1 l r` æ“ä½œä¸Šä¸€æ­¥æ˜¯ `2 l r` |
| $3$ | ä¿è¯åªæœ‰ `1` æ“ä½œ |
| $4$ | ä¿è¯åªæœ‰ `2` æ“ä½œ |
| $5$ | ä¿è¯æ‰€æœ‰çš„ $l=1$ï¼Œ$r=n$ |
| $6$ | $n,m\le 10^3$ |
| $7\sim 20$ | æ— ç‰¹æ®Šé™åˆ¶ |


å¯¹äºæ‰€æœ‰æ•°æ®ï¼Œä¿è¯ $1\le n,m\le2\times10^5$ï¼Œ$1\le a_i\le 10^9$ã€‚


## æ ·ä¾‹ #1

### è¾“å…¥

```
1 1
1
1 1 1```

### è¾“å‡º

```
1```

## æ ·ä¾‹ #2

### è¾“å…¥

```
4 2
1 2 3 4
1 2 4
2 1 4```

### è¾“å‡º

```
7```

## æ ·ä¾‹ #3

### è¾“å…¥

```
5 5
10 8 10 11 12
2 1 5
1 1 5
1 1 4
2 4 5
1 1 5```

### è¾“å‡º

```
18```

# AIåˆ†æç»“æœ



## ç®—æ³•åˆ†ç±»
çº¿æ®µæ ‘/åˆ†å— + åŠ¿èƒ½åˆ†æ

---

## ç»¼åˆåˆ†æä¸ç»“è®º

### æ ¸å¿ƒæ€è·¯
1. **å¹³æ–¹æ¬¡æ•°çš„é€†å‘æŠµæ¶ˆ**ï¼šç»´æŠ¤æ¯ä¸ªå…ƒç´ çš„å¹³æ–¹æ¬¡æ•° `cnt`ï¼Œå¹³æ–¹æ“ä½œç´¯åŠ æ¬¡æ•°ï¼Œå¼€æ–¹æ“ä½œä¼˜å…ˆæ¶ˆè€—æ¬¡æ•°
2. **åŠ¿èƒ½ä¼˜åŒ–**ï¼šå¼€æ–¹æ“ä½œå¯¹å®é™…å€¼çš„ä¿®æ”¹æ¬¡æ•°æœ‰é™ï¼ˆæœ€å¤š5æ¬¡å¯ä½¿ä»»ä½•æ•°å˜ä¸º1ï¼‰ï¼Œé€šè¿‡ç»´æŠ¤åŒºé—´æœ€å¤§å€¼è·³è¿‡æ— æ•ˆæ“ä½œ
3. **åˆ†å—/çº¿æ®µæ ‘ä¼˜åŒ–**ï¼šé€šè¿‡åŒºé—´æ ‡è®°æ‰¹é‡å¤„ç†æ“ä½œï¼Œæ—¶é—´å¤æ‚åº¦ä» O(nm) é™ä¸º O((n+m)logn) æˆ– O(nâˆšn)

### è§£å†³éš¾ç‚¹
- **å¹³æ–¹ä¸å¼€æ–¹çš„æŠµæ¶ˆé€»è¾‘**ï¼šé€šè¿‡ `cnt` è®°å½•å¹³æ–¹æ¬¡æ•°ï¼Œå¼€æ–¹æ“ä½œä¼˜å…ˆå‡å°‘ `cnt` è€Œéå®é™…è®¡ç®—
- **é«˜æ¬¡å¹‚å¿«é€Ÿè®¡ç®—**ï¼šåˆ©ç”¨æ¬§æ‹‰å®šç†é™å¹‚ï¼Œé¢„å¤„ç† 2^k mod 998244352 å‡å°‘è®¡ç®—é‡
- **åŒºé—´æ“ä½œçš„é«˜æ•ˆå¤„ç†**ï¼šçº¿æ®µæ ‘çš„å»¶è¿Ÿæ ‡è®°æœºåˆ¶æˆ–åˆ†å—çš„æ•´å—æ ‡è®°ä¼˜åŒ–

### å¯è§†åŒ–è®¾è®¡
- **åŠ¨ç”»æ–¹æ¡ˆ**ï¼šä»¥çº¿æ®µæ ‘èŠ‚ç‚¹ä¸ºå•å…ƒï¼Œæ˜¾ç¤ºä»¥ä¸‹çŠ¶æ€å˜åŒ–ï¼š
  - çº¢è‰²é«˜äº®ï¼šå½“å‰è¢«æ“ä½œçš„åŒºé—´
  - åŠ¨æ€æ•°å€¼ï¼šå®æ—¶æ˜¾ç¤º `cnt` å€¼å’Œå®é™…å€¼ï¼ˆå¦‚ 3Â²â†’9 ä¸Šæ–¹æ ‡æ³¨ cnt=2ï¼‰
  - åŠ¿èƒ½è¡°å‡ï¼šå½“æŸèŠ‚ç‚¹æœ€å¤§å€¼å˜ä¸º1æ—¶ï¼Œæ˜¾ç¤ºç°è‰²é”å®šçŠ¶æ€
- **8ä½åƒç´ é£æ ¼**ï¼š
  - è‰²å—è¡¨ç¤ºï¼šç»¿è‰²å—è¡¨ç¤ºæ­£å¸¸èŠ‚ç‚¹ï¼Œé»„è‰²å—è¡¨ç¤ºæœ‰æœªä¸‹ä¼ æ ‡è®°
  - éŸ³æ•ˆè®¾è®¡ï¼šæ“ä½œæ—¶æ’­æ”¾ç”µå­éŸ³æ•ˆï¼ŒåŒºé—´é”å®šæ—¶æœ‰ "æ»´" å£°æç¤º
  - è‡ªåŠ¨æ¼”ç¤ºï¼šæ¨¡æ‹ŸAIè‡ªåŠ¨æ‰§è¡Œæ“ä½œåºåˆ—ï¼Œå³ä¸‹è§’æ˜¾ç¤ºå‰©ä½™æ“ä½œæ•°

---

## é¢˜è§£æ¸…å•ï¼ˆâ‰¥4æ˜Ÿï¼‰

### Ryo_Yamadaï¼ˆâ˜…â˜…â˜…â˜…â˜…ï¼‰
- **äº®ç‚¹**ï¼šåŒæ ‡è®°çº¿æ®µæ ‘ + åŠ¿èƒ½åˆ†æ
- **å…³é”®ä»£ç **ï¼š
  ```cpp
  void update() { // å¼€æ–¹æ“ä½œå¤„ç†
    if(mnc[id]>=1) { // æ•´å—æ ‡è®°å¤„ç†
      --cnt[id], --mnc[id], --lz[id];
      return;
    }
    if(l==r) { // å•ç‚¹å®é™…å¼€æ–¹
      mx[id] = val[id] = sqrt(val[id]);
    }
  }
  ```

### cyffffï¼ˆâ˜…â˜…â˜…â˜…â˜†ï¼‰
- **äº®ç‚¹**ï¼šåˆ†å—ç»´æŠ¤æœ€å°æ¬¡æ•° + æ¬§æ‹‰é™å¹‚é¢„å¤„ç†
- **ä¸ªäººå¿ƒå¾—**ï¼š"æ•£å—æš´åŠ›é‡æ„æ—¶è¦åˆ¤æ–­æ˜¯å¦ä¸º1ï¼Œå¦åˆ™ä¼šè¢«å¡å¸¸"

### Imiyaï¼ˆâ˜…â˜…â˜…â˜…â˜†ï¼‰
- **äº®ç‚¹**ï¼šæ“ä½œåˆå¹¶æ€æƒ³ï¼Œå°†æ“ä½œåºåˆ—è½¬åŒ–ä¸º (x,y) çš„å¤åˆè¿ç®—
- **æŠ€å·§**ï¼š"å…ˆå¹³æ–¹åå¼€æ–¹ç­‰ä»·äºåŸæ•°ï¼Œé€šè¿‡æ“ä½œåˆå¹¶å‡å°‘å®é™…è®¡ç®—"

---

## æ ¸å¿ƒä»£ç å®ç°

### çº¿æ®µæ ‘å…³é”®æ“ä½œ
```cpp
void update(int id, int l, int r, int x, int y) {
    if(mnc[id] >= 1) { // æ•´å—æ ‡è®°ä¼˜åŒ–
        --cnt[id], --mnc[id], --lz[id];
        return;
    }
    if(l == r) {
        if(cnt[id] > 0) --cnt[id];
        else val[id] = sqrt(val[id]); // å®é™…å¼€æ–¹
        mx[id] = val[id];
        return;
    }
    pushdown(id);
    int mid = (l+r)>>1;
    if(x <= mid) update(ls, l, mid, x, y);
    if(y > mid) update(rs, mid+1, r, x, y);
    pushup(id);
}
```

### åˆ†å—é¢„å¤„ç†é™å¹‚
```cpp
pow2[0] = 1;
for(int i=1; i<=m; i++) {
    pow2[i] = (pow2[i-1] * 2) % (mod-1);
    if(pow2[i] >= mod-1) wz = i; // è®°å½•æº¢å‡ºç‚¹
}
```

---

## ç±»ä¼¼é¢˜ç›®æ¨è
1. **P4145 ä¸Šå¸é€ é¢˜çš„ä¸ƒåˆ†é’Ÿ2**ï¼ˆåŒºé—´å¼€æ–¹+æ±‚å’Œï¼‰
2. **P6242 çº¿æ®µæ ‘3**ï¼ˆåŒºé—´å†å²æœ€å€¼ï¼‰
3. **CF438D The Child and Sequence**ï¼ˆåŒºé—´å–æ¨¡+å•ç‚¹ä¿®æ”¹ï¼‰

---

## å¯è§†åŒ–ä¼ªä»£ç ï¼ˆCanvasåŠ¨ç”»ï¼‰
```javascript
class SegmentNode {
    constructor(l, r) {
        this.l = l; // åŒºé—´å·¦ç«¯ç‚¹
        this.r = r; // åŒºé—´å³ç«¯ç‚¹
        this.cnt = 0; // å½“å‰å¹³æ–¹æ¬¡æ•°
        this.maxVal = 0; // åŒºé—´æœ€å¤§å€¼
        this.color = '#7FFFAA'; // åˆå§‹é¢œè‰²
    }
    
    // æ‰§è¡Œå¹³æ–¹æ“ä½œ
    square() {
        this.cnt++;
        this.color = this._getHeatColor();
        playSound('square.wav');
    }
    
    // æ‰§è¡Œå¼€æ–¹æ“ä½œ
    sqrt() {
        if(this.cnt > 0) {
            this.cnt--;
        } else {
            this.maxVal = Math.sqrt(this.maxVal)|0;
        }
        this.color = this._getHeatColor();
        playSound('sqrt.wav');
    }
    
    _getHeatColor() {
        const heat = Math.min(1, this.cnt / 5);
        return `hsl(${heat*120}, 70%, 60%)`;
    }
}
```

---

## ä¸ªäººå¿ƒå¾—æ‘˜å½•
> "è°ƒè¯•æ—¶å‘ç°å½“cntå‡åˆ°è´Ÿæ•°æ—¶ä¼šå‡ºé”™ï¼Œå¿…é¡»ä¿è¯æ“ä½œé¡ºåºçš„ä¼˜å…ˆçº§ã€‚å¼€æ–¹å¿…é¡»ä¼˜å…ˆæ¶ˆè€—å·²æœ‰å¹³æ–¹æ¬¡æ•°ï¼Œè¿™éœ€è¦ä¸¥æ ¼ç»´æŠ¤åŒºé—´æœ€å°å€¼ã€‚" â€”â€” Ryo_Yamada

> "åˆ†å—é‡æ„æ—¶å¿˜è®°åˆ¤æ–­a[i]æ˜¯å¦ä¸º1ï¼Œå¯¼è‡´TLEä¸‰ä¸ªç‚¹ï¼Œè¡€çš„æ•™è®­ï¼" â€”â€” cyffff

---

## å¤å¤æ¸¸æˆåŒ–è®¾è®¡
1. **ç•Œé¢å¸ƒå±€**ï¼š
   - é¡¶éƒ¨ï¼š8-bité£æ ¼æ“ä½œæŒ‰é’®ï¼ˆâ–¶ï¸æ‰§è¡Œ â¸æš‚åœ ğŸ”„é‡ç½®ï¼‰
   - ä¸»åŒºåŸŸï¼š16è‰²åƒç´ å—è¡¨ç¤ºçº¿æ®µæ ‘èŠ‚ç‚¹ï¼Œå³ä¾§æ˜¾ç¤ºå½“å‰æ“ä½œåºåˆ—
   - åº•éƒ¨ï¼šå¾—åˆ†æ¿ï¼ˆæ­£ç¡®æ“ä½œ+10åˆ†ï¼Œé”™è¯¯-5åˆ†ï¼‰

2. **éŸ³æ•ˆæ–¹æ¡ˆ**ï¼š
   - èƒŒæ™¯éŸ³ä¹ï¼šFCã€Šè¶…çº§é©¬é‡Œå¥¥ã€‹åœ°ä¸‹å…³BGMå¾ªç¯
   - æ“ä½œéŸ³æ•ˆï¼š
     - å¹³æ–¹ï¼šçŸ­ä¿ƒ"å˜Ÿ"å£°ï¼ˆ100Hzæ–¹æ³¢ï¼‰
     - å¼€æ–¹ï¼šä¸‹é™"æ»´"å£°ï¼ˆ200Hzâ†’100Hzï¼‰
     - é”™è¯¯ï¼šåˆºè€³å™ªå£°ï¼ˆ50msç™½å™ªå£°ï¼‰

3. **AIæ¼”ç¤ºæ¨¡å¼**ï¼š
   ```javascript
   function autoPlay() {
       let step = 0;
       const timer = setInterval(() => {
           if(step >= operations.length) {
               clearInterval(timer);
               return;
           }
           executeOperation(operations[step++]);
       }, 1000); // æ¯ç§’æ‰§è¡Œä¸€æ­¥
   }
   ```

---
å¤„ç†ç”¨æ—¶ï¼š74.28ç§’
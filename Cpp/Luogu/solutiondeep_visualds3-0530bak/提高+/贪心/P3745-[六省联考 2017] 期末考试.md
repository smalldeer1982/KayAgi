# 题目信息

# [六省联考 2017] 期末考试

## 题目描述

有 $n$ 位同学，每位同学都参加了全部的 $m$ 门课程的期末考试，都在焦急的等待成绩的公布。

第 $i$ 位同学希望在第 $t_i$ 天或之前得知**所有**课程的成绩。如果在第 $t_i$ 天，有至少一门课程的成绩没有公布，他就会等待最后公布成绩的课程公布成绩，每等待一天就会产生 $C$ 不愉快度。

对于第 $i$ 门课程，按照原本的计划，会在第 $b_i$ 天公布成绩。

有如下两种操作可以调整公布成绩的时间:
1. 将负责课程 $X$ 的部分老师调整到课程 $Y$，调整之后公布课程 $X$ 成绩的时间推迟一天，公布课程 $Y$ 成绩的时间提前一天；每次操作产生 $A$ 不愉快度。
2. 增加一部分老师负责学科 $Z$，这将导致学科 $Z$ 的出成绩时间提前一天；每次操作产生 $B$ 不愉快度。

上面两种操作中的参数 $X, Y, Z$ 均可任意指定，每种操作均可以执行多次，每次执行时都可以重新指定参数。

现在希望你通过合理的操作，使得最后总的不愉快度之和最小，输出最小的不愉快度之和即可。

## 说明/提示

### 样例解释 1

由于调整操作产生的不愉快度太大，所以在本例中最好的方案是不进行调整；全部的 $5$ 门课程中，最慢的在第 $3$ 天出成绩；  
同学 $1$ 希望在第 $5$ 天或之前出成绩，所以不会产生不愉快度；  
同学 $2$ 希望在第 $1$ 天或之前出成绩，产生的不愉快度为 $(3 - 1) \times 2 = 4$；  
同学 $3$ 希望在第 $2$ 天或之前出成绩，产生的不愉快度为 $(3 - 2) \times 2 = 2$；  
同学 $4$ 希望在第 $3$ 天或之前出成绩，所以不会产生不愉快度；  
不愉快度之和为 $4 + 2 = 6$。

### 数据范围

| Case # | $n, m, t_i, b_i$ | $A, B, C$ |
|:-:|:-:|:-:|
| 1, 2 | $1 \leq n, m, t_i, b_i \leq 2000$ | $A = 10^9; B = 10^9; 0 \leq C \leq 10^2$ |
| 3, 4 | $1 \leq n, m, t_i, b_i \leq 2000$ | $0 \leq A; C \leq 10^2; B = 10^9$ |
| 5, 6, 7, 8 | $1 \leq n, m, t_i, b_i \leq 2000$ | $0 \leq B \leq A \leq 10^2; 0 \leq C \leq 10^2$ |
| 9 - 12 | $1 \leq n, m, t_i, b_i \leq 2000$ | $0 \leq A, B, C \leq 10^2$ |
| 13, 14 | $1 \leq n, m, t_i, b_i \leq 10^5$ | $0 \leq A, B \leq 10^5; C = 10^{16}$ |
| 15 - 20 | $1 \leq n, m, t_i, b_i \leq 10^5$ | $0 \leq A, B, C \leq 10^5$ |

## 样例 #1

### 输入

```
100 100 2
4 5
5 1 2 3
1 1 2 3 3```

### 输出

```
6```

## 样例 #2

### 输入

```
3 5 4
5 6
1 1 4 7 8
2 3 3 1 8 2```

### 输出

```
33```

# AI分析结果



### 综合分析与结论

本题核心思路是枚举最晚公布时间 $T$，计算对应的调整代价与学生不愉快度之和。关键在于预处理与分类讨论：

1. **贪心策略**：当 $A < B$ 时，优先使用操作1（调整老师）减少调整代价，剩余部分用操作2；否则全用操作2。
2. **预处理优化**：通过前缀和或桶统计快速计算每个 $T$ 的调整代价与学生不愉快度。
3. **难点**：高效计算每个 $T$ 的代价，涉及排序、二分查找或前缀和技巧。正确分类讨论 $A$ 与 $B$ 的关系是核心难点。

### 题解评分（≥4星）

1. **泅荼（★★★★★）**
   - **亮点**：桶计数+前缀和，$O(\text{max}T)$ 时间枚举，代码简洁高效。
   - **关键代码**：预处理 `bac` 数组，动态维护 `sum1` 和 `sum2`，分类计算调整代价。
2. **wjyyy（★★★★☆）**
   - **亮点**：三分法验证单峰性，预处理前缀和优化计算，详细数学推导。
3. **Soulist（★★★★☆）**
   - **亮点**：排序+二分查找，逻辑清晰，适合理解贪心策略的实现。

### 最优思路或技巧提炼

- **枚举+前缀和**：对课程和学生时间排序，预处理前缀和，快速计算每个 $T$ 的代价。
- **分类讨论 $A$ 与 $B$**：根据操作性价比选择调整策略，优先使用更优操作。
- **单峰性验证**：三分法快速定位最优解，适用于代价函数呈单峰的情况。

### 同类型题与算法套路

- **区间调整问题**：如资源分配、时间调度，通过调整操作最小化总成本。
- **贪心选择策略**：优先处理高性价比操作，结合全局枚举或分治优化。

### 推荐题目
1. **P1080 国王游戏**（贪心排序策略）
2. **P1223 排队接水**（经典贪心模型）
3. **P5019 铺设道路**（贪心调整操作）

### 可视化与算法演示

#### 贪心过程动画设计
1. **像素风格界面**：用 8-bit 网格展示 $T$ 值、调整代价、学生代价。
2. **动态折线图**：显示总代价随 $T$ 变化，高亮当前最小值位置。
3. **交互操作**：通过左右键调整 $T$，实时更新各部分代价数值。
4. **音效提示**：选择不同 $T$ 时播放不同音效，增强反馈。

#### 核心代码片段（泅荼）
```cpp
// 预处理桶数组
for(int i=1;i<=m;i++) bac[bi[i]]++;
for(int i=1e5;i>=1;i--){
    sum1 += i*bac[i], t1 += bac[i];
    sum2 -= i*bac[i], t2 -= bac[i];
    // 计算调整代价和学生代价
    ll tep = (A<B) ? min(LQ1,LQ2)*A + ... : LQ1*B;
    ans = min(ans, tep + (学生不愉快度));
}
```

### 复古游戏化设计
- **Canvas 绘制**：课程与学生以不同颜色方块表示，$T$ 值用移动标尺展示。
- **自动演示模式**：AI 模拟枚举过程，动态显示最优解寻找路径。
- **积分系统**：正确选择 $T$ 时获得连击奖励，错误时扣分。

### 个人心得
- **边界处理**：特别注意等于 $T$ 的情况，避免前缀和计算错误。
- **特判优化**：当 $C$ 极大时直接取最小 $t_i$，避免无效计算。

---
处理用时：188.70秒
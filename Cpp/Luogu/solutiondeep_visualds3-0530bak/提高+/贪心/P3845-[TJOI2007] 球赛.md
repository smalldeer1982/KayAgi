# 题目信息

# [TJOI2007] 球赛

## 题目背景

超级球迷 H 每周六晚上都会坐在电视前看球，从不错过一场比赛。

但是上周末，H 突然有一个重要的约会，于是他只能教他三岁的弟弟小 H 记录所有比赛

的比分。但是当他约会回来时，他发现小 H 不仅认真的记录了每一场比赛的最终比分，还

把一些比赛的中间比分也记录下来，而更糟糕的是，小 H 并没有区分比赛的两个队，同一

场比赛的比分可能被记录成 1-2，也可能是 2-1。因此，若是有一场比赛的最终得分是 5-3，

可能实际上被小 H 记录的分数有

1-0 3-2 2-3 3-4 5-3


## 题目描述

现在 H 已经拿到了小 H 记录的所有比分，他想知道，在这个周末他由于约会至少错过

了多少场比赛。注意小 H 记录的比分是没有先后顺序的。


## 说明/提示

在第一组输入数据中，两场比赛对应的比分可能是 1-0 2-0 0-3 和 2-1。

在第二组输入数据中，三场比赛对应的比分可能是 0-0 5-0、3-1 和 2-2。

100%的数据中 n ≤ 5，s ≤ 1 000，每一场比赛的比分都在 longint(Pascal) / long(C++)

（2147483647）范围内。


## 样例 #1

### 输入

```
2
4
1-0
2-0
0-3
2-1
4
5-0
1-3
2-2
0-0```

### 输出

```
2
3```

# AI分析结果



### 综合分析与结论

**核心思路**  
题目要求将无序的比分分组为最少的比赛场次，每场比赛的比分需满足非递减序列。通过 **Dilworth 定理**，将问题转化为求最长降序子序列的长度。关键步骤包括：
1. **统一格式**：处理每个比分为 $x \leq y$。
2. **排序策略**：按 $y$ 升序（或 $x$ 升序）排序，确保一维有序。
3. **最长降序子序列**：对另一维度求最长降序子序列的长度，即为最少比赛数。

**贪心策略与可视化设计**  
- **排序后贪心**：按 $y$ 升序排列后，对 $x$ 序列求最长降序子序列。贪心策略维护一个尽可能大的链末尾，允许后续元素加入。
- **可视化要点**：展示排序后的二维点，动态高亮每个选择的点，形成降序序列。用颜色区分不同链，突出贪心选择过程。

**复古游戏化设计**  
- **8位像素风格**：比分以像素方块表示，排序后沿纵轴排列。
- **音效与动画**：选择点时播放音效，自动演示模式下逐步显示决策过程。
- **交互控制**：支持暂停/步进，对比不同排序策略的效果。

---

### 题解清单（评分≥4星）

1. **When的题解（5星）**  
   - **亮点**：使用 $O(n \log n)$ 贪心+二分优化，代码高效，结构清晰。
   - **代码**：通过 `lower_bound` 和自定义比较函数优化最长降序子序列的计算。

2. **CG__HeavenHealer的题解（5星）**  
   - **亮点**：简洁的贪心实现，结合 `Dilworth` 定理，代码可读性强。
   - **代码**：利用 `lower_bound` 的逆向比较实现降序处理。

3. **Ajwallet的题解（4星）**  
   - **亮点**：朴素的 $O(n^2)$ 贪心，适合小规模数据，代码直观易懂。
   - **适用场景**：数据量较小时（如题目中的 $n \leq 5$）。

---

### 核心代码实现

**When的题解（贪心+二分）**
```cpp
sort(a + 1, a + n + 1, cmp); // 按x升序，y升序排序
b[++top] = a[1].y;
for (int i = 2; i <= n; ++i) {
    if (a[i].y < b[top]) b[++top] = a[i].y;
    else {
        int pos = lower_bound(b + 1, b + top + 1, a[i].y, greater<int>()) - b;
        b[pos] = a[i].y;
    }
}
printf("%d\n", top);
```

**关键逻辑**：排序后维护数组 `b` 存储最长降序子序列的最小末尾值，通过二分快速定位插入位置。

---

### 同类型题目与算法套路

1. **Dilworth定理应用**：将偏序集链划分转化为最长反链（降序子序列）。
2. **常见场景**：二维元素排序后求另一维的最值序列（如任务调度、区间覆盖）。

**推荐题目**  
1. [P1020 导弹拦截](https://www.luogu.com.cn/problem/P1020)  
2. [P1233 木棍加工](https://www.luogu.com.cn/problem/P1233)  
3. [P1091 合唱队形](https://www.luogu.com.cn/problem/P1091)  

---

### 可视化算法演示

**动画设计**  
1. **像素化展示**：每个比分以 $(x, y)$ 显示在 Canvas 网格中，排序后沿 $y$ 轴排列。
2. **贪心过程**：高亮当前处理的点，动态连线形成最长降序链，不同链以颜色区分。
3. **音效提示**：成功加入链时播放上升音调，新建链时播放低音。

**交互功能**  
- **自动播放**：逐步展示贪心选择，支持调速。
- **手动模式**：点击单步执行，观察二分查找的中间状态。

---

### 个人心得摘录

> **调试教训**：需确保排序时正确处理 $x$ 和 $y$ 的优先级，否则最长降序序列计算错误。  
> **顿悟时刻**：通过 Dilworth 定理将二维问题转化为一维序列，极大简化了思路。

---

### 总结

本题通过 **排序预处理** 和 **贪心策略** 高效求解最少比赛数，其核心在于识别问题中的偏序关系并应用 Dilworth 定理。不同题解在实现细节上各有优化，但均围绕同一算法框架展开。

---
处理用时：358.32秒
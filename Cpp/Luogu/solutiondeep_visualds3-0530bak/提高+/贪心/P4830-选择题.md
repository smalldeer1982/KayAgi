# 题目信息

# 选择题

## 题目描述

docriz 正在考试，他遇到了一个奇怪的选择题：这个选择题共有 $n$ 个选项，其中只有一个选项是正确的。他完全不会做这题，所以只能靠蒙。

蒙这道题分为 $n - 2$ 轮，在第 $1$ 轮开始之前，docriz 会在这 $n$ 个选项中随机蒙一项，之后的每轮流程如下：首先，nocriz 会过来帮他排除一个选项，由于 nocriz 事先知道答案，所以他会在现有的除正确的那一项和 docirz 正在选的那一项外的选项里，随机删去一个。之后，docriz 可以选择是否更换自己蒙的选项，如果更换，则随机更换到除正在选的那一项之外的任意一项。

docriz 在这 $n - 2$ 轮中，由于和 nocriz 达成的神秘协定，需要恰好更换 $k$ 次选项。他想知道，如何更换，使得自己蒙对的概率最大，输出这个概率。为了方便，你需要输出这个概率的分数形式在模 $10^9 + 7$ 意义下的结果。

## 说明/提示

样例 $1$ 到 $4$ 分别为 $\frac{2}{3}, \frac{1}{3}, \frac{3}{4}, \frac{5}{8}$。

对于 $30\%$ 的数据，保证 $5 \leq n \leq 10$。

对于另外 $5\%$ 的数据，保证 $k = 0$。

对于另外 $10\%$ 的数据，保证 $k = 1$。

对于另外 $10\%$ 的数据，保证 $k = n - 2$。

对于另外 $5\%$ 的数据，保证 $n \leq 10^2$。

对于另外 $10\%$ 的数据，保证 $n \leq 10^3$。

对于 $100\%$ 的数据，保证 $5 \leq n \leq 10^5, 0 \leq k \leq n - 2$。

## 样例 #1

### 输入

```
3 1```

### 输出

```
666666672```

## 样例 #2

### 输入

```
3 0```

### 输出

```
333333336```

## 样例 #3

### 输入

```
4 1```

### 输出

```
750000006```

## 样例 #4

### 输入

```
4 2```

### 输出

```
625000005```

## 样例 #5

### 输入

```
100000 99998```

### 输出

```
439903656```

# AI分析结果



---

### 综合分析与结论

**题目核心**：  
在动态排除过程中设计更换策略，最大化最终选中正确选项的概率。关键在于贪心选择更换时机——将最后一次更换保留到排除次数最多的阶段（剩余选项最少时），前序更换需尽可能保持错误状态以提升最终正确率。

**贪心策略**：  
1. **最后更换**：最后一次更换必须发生在所有可能的排除之后，此时剩余选项数最少（正确率最高）。
2. **前序保错**：前 \(k-1\) 次更换需保证当前选项错误，通过递推计算错误概率的分子分母。

**解决难点**：  
- **概率递推**：每次排除后，错误概率的分子分母更新公式推导（利用条件概率和贝叶斯思想）。
- **模运算处理**：大数阶乘逆元或扩展欧几里得求分数取模。

---

### 题解清单（≥4星）

1. **Itst（4星）**  
   - **亮点**：简洁的递推公式，快速幂求逆元，初始条件处理清晰。  
   - **代码**：递推分子分母，时间复杂度 \(O(k)\)，适合大数据范围。

2. **揽月摘星辰（4星）**  
   - **亮点**：扩展欧几里得求逆元详细推导，递推过程分步解释，适合数学基础较弱的读者。  
   - **心得**：强调分数化简与模运算转换，避免分母归零错误。

---

### 最优思路与代码实现

**核心递推式**：  
- 初始错误概率 \(P_0 = \frac{n-1}{n}\)  
- 第 \(i\) 次排除后（剩余 \(m\) 选项）：  
  \[
  P_i = \frac{(m-1) \cdot P_{i-1} - 1}{m-2}
  \]
- 最终正确率：\( \frac{P_{k-1}}{m_{\text{last}} - 1} \)

**代码片段（Itst）**：  
```cpp
if(k == 0)
    cout << poww(n, MOD - 2); // 1/n 的逆元
else{
    k--;
    long long fz = n - 1, fm = n; // 初始错误概率分子分母
    n -= 2;
    while(k--){
        fz = ((fm = fm * n % MOD) - fz) % MOD; // 递推更新
        n--;
    }
    cout << fz * poww(fm, MOD - 2) % MOD; // 逆元取模
}
```

---

### 同类型题目与套路

**常见套路**：  
- **动态概率递推**：如赌徒破产问题、随机游走期望计算。  
- **贪心时序选择**：在排除最多干扰项后行动（类似背包问题贪心排序）。  

**推荐题目**：  
1. 洛谷 P2613 【模板】有理数取余  
2. 洛谷 P1291 【SHOI2002】百事世界杯之旅  
3. 洛谷 P1850 【NOIP2016】换教室（概率DP）

---

### 可视化与游戏化设计

**动画方案**：  
1. **像素风格界面**：用色块表示选项，红色标记正确项，灰色表示排除。  
2. **步进演示**：  
   - 每轮高亮排除的选项，显示当前选择的选项颜色变化。  
   - 右侧面板实时更新分子分母及概率值。  
3. **音效反馈**：  
   - 正确选择时播放8-bit胜利音效，错误时低沉提示音。  
4. **自动模式**：AI自动执行最优策略，辅以速度调节按钮。

**交互设计**：  
```javascript
// 伪代码示例：Canvas绘制选项
function drawOptions(remaining, selected) {
    ctx.fillStyle = "#333"; // 背景色
    ctx.fillRect(0, 0, width, height);
    remaining.forEach((opt, idx) => {
        ctx.fillStyle = opt === selected ? "#FF0000" : "#00FF00";
        ctx.fillRect(idx * 30, 50, 25, 25); // 绘制选项方块
    });
}
```

---

### 个人心得摘录

- **Itst**：注意特判 \(k=0\) 直接返回逆元，避免复杂计算。  
- **揽月**：扩展gcd处理模运算时需保证分母非零，负值需调整为正。  
- **l_water**：三门问题启发式思考，将复杂概率转化为经典模型。  

---

通过上述分析，读者可深入理解贪心策略在动态概率问题中的应用，掌握递推式设计与模运算处理技巧。

---
处理用时：108.70秒
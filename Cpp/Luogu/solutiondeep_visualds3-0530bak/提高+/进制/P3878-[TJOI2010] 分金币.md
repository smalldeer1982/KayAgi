# 题目信息

# [TJOI2010] 分金币

## 题目描述

现在有 $n$ 枚金币，它们可能会有不同的价值，第 $i$ 枚金币的价值为 $v_i$。

现在要把它们分成两部分，要求这两部分金币数目之差不超过 $1$，问这样分成的两部分金币的价值之差最小是多少？



## 说明/提示

#### 数据规模与约定

- 对 $30\%$ 的数据，保证 $1 \leq v_i \leq 1000$
- 对于 $100\%$ 的数据，保证 $1 \leq T \leq 20$，$1 \leq n \leq 30$，$1 \leq v_i \leq 2^{30}$。

## 样例 #1

### 输入

```
2
3
2 2 4
4
1 2 3 6
```

### 输出

```
0
2
```

# AI分析结果



# 算法分类
**折半搜索（折半状压）**

---

## 综合分析与结论
### 核心算法流程
1. **折半拆分**：将金币分为前后两半（前15枚/后15枚）
2. **前处理**：枚举前半所有子集，记录子集的元素个数差（集合1数量-集合2数量）与价值差
3. **后处理**：枚举后半所有子集，通过二分查找在前半数据中匹配最优互补解
4. **奇偶处理**：根据n的奇偶性调整允许的个数差范围（±1或0）

### 解决难点
- **指数级复杂度优化**：通过拆分将2^30 → 2×2^15，实现可行计算
- **高效匹配**：对前半数据按个数差分组存储，利用有序性和二分加速查找
- **差值补偿**：通过价值差的正负互补实现整体平衡

---

## 题解清单（≥4星）
### 1. star_city（★★★★★）
- **亮点**：无STL依赖，通过预排序和区间标记实现高效二分
- **核心代码**：
```cpp
for(int i=0;i<1<<k;i++){
    int c = m - cnt[i], x = calc(i, m);
    pos = lower_bound(tmp + l[c], tmp + l[c+1], sum/2 - x);
    // 二分查找最优匹配值
}
```

### 2. Luan_233（★★★★☆）
- **亮点**：使用set自动排序，代码结构清晰
- **心得**：通过+n偏移处理负数下标，降低编码复杂度

### 3. 7KByte（★★★★☆）
- **亮点**：双重最优性剪枝（上下界+差值预估）
- **核心逻辑**：
```cpp
if(sum+s[nd-cnt]>=all-(sum+s[nd-cnt])) // 上界剪枝
    ans=min(ans,2*(sum+s[nd-cnt])-all);
```

---

## 关键代码实现（折半状压）
```cpp
// 前半处理
for(int i=0;i<(1<<m);i++){
    int cnt=0, tot=0;
    for(int j=1;j<=m;j++)
        if(i&(1<<j-1)) cnt++, tot += a[j];
        else cnt--, tot -= a[j];
    s[cnt+n].insert(tot); // 偏移n处理负数
}

// 后半匹配
for(int i=0;i<(1<<k);i++){
    int cnt=0, tot=0;
    for(int j=1;j<=k;j++)
        if(i&(1<<j-1)) cnt++, tot += a[m+j];
        else cnt--, tot -= a[m+j];
    ans = min(ans, check(n-cnt, -tot)); // 互补匹配
}
```

---

## 同类型题目
1. **P3067 [USACO12OPEN]Balanced Cow Subsets**（折半搜索经典题）
2. **P2210 Haywire**（模拟退火应用）
3. **P1763 分宿舍**（价值平衡问题）

---

## 可视化设计（折半搜索）
### 像素化演示方案
1. **界面布局**：  
   - 左半区：展示前半子集的二进制表示（15位LED灯）  
   - 右半区：动态绘制后半匹配过程
2. **动画效果**：  
   - 每次二分查找时，对应区间闪烁黄色边框  
   - 成功匹配时播放8-bit成功音效（频率800Hz）
3. **控制面板**：  
   - 速度滑块（1x-10x）  
   - 单步执行按钮（步进模式显示当前cnt/tot值）

---

## 个人心得摘录
> "模拟退火参数调整就像炒菜——火候大了容易焦，小了不熟。我试了20次才找到合适的delta值" ——封禁用户  
> "折半搜索的精髓在于，把不可能变成可能，就像把大象装冰箱分三步" ——Luan_233

---

## 拓展思考
对于更大的数据规模（如n=40），可结合**Meet-in-Middle与哈希优化**，将复杂度控制在O(3^(n/3))。对于动态数据流场景，可考虑**在线平衡算法**，每次新增金币时微调分组。

---
处理用时：69.96秒
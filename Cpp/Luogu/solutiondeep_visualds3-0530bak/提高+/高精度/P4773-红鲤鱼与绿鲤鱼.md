# 题目信息

# 红鲤鱼与绿鲤鱼

## 题目背景

JerryC家里除了有驴之外，还有一个有着红鲤鱼和绿鲤鱼的鱼缸。

## 题目描述

在JerryC家里的鱼缸里，有一些红鲤鱼和绿鲤鱼(鱼缸里没有驴！)这天晚上23:05的时候，JerryC闲的无聊，于是打开了某神秘OJ开始爆肝。。作为一名膜法师，JerryC可以通过预言术得知下一次自己的提交是对是错。当然，预言术使用的工具就是眼前的鱼缸了。每当JerryC的预言术指示一只红鲤鱼的时候，就说明这次提交会WA，同时会增加5min的罚时；如果是绿鲤鱼就会AC。(当然，由于JerryC的膜法，JerryC是不会番薯田扛把子的。JerryC第一次提交会在第5min，而且不幸的是JerryC的膜法有5min的冷却时间)并且JerryC在每一次预言后就会把预言到的那一只鲤鱼取出来，以便比赛完毕后给鱼缸换水~~(给自己换换口味)~~现在JerryC告诉你他家里有多少条红鲤鱼和绿鲤鱼，请你告诉他他这场比赛的罚时期望是多少。当然，JerryC会按顺序做题，并且罚时只会记录AC的题目，算罚时的时候需要加上AC的时间，并且所有的鲤鱼用完后还会提交一次，而且这一次JerryC并不会预测并且必定AC。）
由于JerryC脾气比较犟，所以他不会因为WA掉一道题而换一道题去做，除非AC。

## 说明/提示

$$ 10 pts: 1 \leqslant A + B \leqslant 5 $$
$$ 30 pts: 1 \leqslant A + B \leqslant 20 $$
$$ 70 pts: 1 \leqslant A + B \leqslant 3000 $$
$$ 100 pts: 1 \leqslant A \leqslant 1e18, 1 \leqslant B \leqslant 1e7 $$

最后六个点时限2400ms！！！
其他点时限400ms！！！

$$ \color{white}{\text{温馨提示:注意模数}}$$

样例1: 
有两种可能： 
1. AC WA AC
2. WA AC AC
 
第一个情况的罚时是5(第5分钟AC)+5(WA一次罚时5分钟)+15(第15分钟AC)=25 

第二个情况的罚时是5(WA一次罚时5分钟)+10(第10分钟AC)+15(第15分钟AC)=30 

所以期望罚时为$ \frac{25+30}{2} = \frac{55}{2} $ 需要对分数取模，所以最后答案为499122454。



## 样例 #1

### 输入

```
1 1```

### 输出

```
499122454```

## 样例 #2

### 输入

```
1 2```

### 输出

```
45```

# AI分析结果



1. **唯一算法分类**  
   数学（期望计算）

2. **题解思路与算法要点**  
   - **核心公式推导**：通过期望线性性，将总罚时拆解为红鲤鱼和绿鲤鱼的独立贡献。  
     - 绿鲤鱼的贡献：所有AC的提交时间构成等差数列，总和为 `5*b*(a+b+1)/2`  
     - 红鲤鱼的贡献：每个红鲤鱼导致之后所有AC增加5分钟，总和为 `5*(2a + b + 1)`  
   - **公式合并**：总期望为 `5*(2a + b + 1 + b*(a+b+1)/2)`，化简后分子为 `4a + 2b + 2 + b*(a+b+1)`  
   - **模运算处理**：对分母2进行取模逆元处理（模数998244853的逆元为499122427）  

3. **题解评分（≥4星）**  
   - **b2019dy（5星）**  
     推导清晰，代码简洁，直接实现公式并处理模运算，适用于大范围数据。  
   - **tanzexiaodezhonghao（4星）**  
     公式推导明确，代码简洁，但需注意变量命名可读性。  
   - **yzx72424（4星）**  
     公式正确，代码简短，但需注意模运算的括号嵌套。  

4. **最优思路提炼**  
   - **关键思路**：利用期望的线性性，将红绿鲤鱼的贡献独立计算并合并。  
   - **技巧**：  
     1. 绿鲤鱼的提交时间视为等差数列求和  
     2. 红鲤鱼的贡献转化为固定系数与位置无关  
     3. 大数模运算下提前取模避免溢出  

5. **同类型题推荐**  
   - **CF1540B Tree Array**（期望与排列组合）  
   - **洛谷 P1654 OSU!**（线性期望递推）  
   - **洛谷 P6154 游走**（路径期望与组合数学）  

6. **可视化算法演示**  
   - **动画设计**：  
     - 初始时间轴展示为等差数列（绿鲤鱼提交时间）  
     - 动态插入红鲤鱼，显示罚时对后续AC的叠加影响  
     - 最终合并两部分贡献，显示公式推导过程  
   - **复古像素风格**：  
     - 使用8-bit音效表示AC（清脆音）和WA（低沉音）  
     - 红绿鲤鱼以像素图标在时间轴上滑动，点击展示贡献计算  
   - **交互控制**：  
     - 步进按钮观察每个鲤鱼的贡献计算  
     - 自动播放模式演示公式推导的每一步  

7. **核心代码实现**  
   ```cpp
   #include<bits/stdc++.h>
   using namespace std;
   const long long mod = 998244853;
   const long long inv2 = 499122427; // 2的模逆元

   int main() {
       long long a, b;
       cin >> a >> b;
       // 计算分子部分：(4a + 2b + 2 + b*(a+b+1)) *5
       long long numerator = ( (4*(a%mod) % mod) + (2*(b%mod) % mod) + 2 + 
                             (b%mod) * ((1 + (a%mod) + (b%mod)) % mod) ) % mod;
       long long ans = 5 * numerator % mod;
       // 处理分母2
       if (ans % 2 == 0) 
           cout << ans / 2 << endl;
       else 
           cout << (ans * inv2) % mod << endl;
       return 0;
   }
   ```

---
处理用时：403.23秒
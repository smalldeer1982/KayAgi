# é¢˜ç›®ä¿¡æ¯

# [NOIP 2012 æ™®åŠç»„] æ–‡åŒ–ä¹‹æ—…

## é¢˜ç›®èƒŒæ™¯

æœ¬é¢˜**ä¸ä¿è¯**å­˜åœ¨**å¯ä»¥é€šè¿‡æ»¡è¶³æœ¬é¢˜æ•°æ®èŒƒå›´çš„ä»»æ„æ•°æ®**åšæ³•ã€‚ç”±äºæµ‹è¯•æ•°æ®è¿‡æ°´ï¼Œå¯ä»¥é€šè¿‡æ­¤é¢˜çš„ç¨‹åºä¸ä¸€å®šå®Œå…¨æ­£ç¡®ï¼ˆç®—æ³•æ—¶é—´å¤æ‚åº¦é”™è¯¯ã€æˆ–ä¸ä¿è¯æ­£ç¡®æ€§ï¼‰ã€‚æœ¬é¢˜é¢˜ç›®å’Œæ•°æ®ä»…ä¾›å‚è€ƒã€‚æœ¬é¢˜ä¸æ¥å—æ·»åŠ  hack æ•°æ®ã€‚

æœ¬é¢˜ä¸ºé”™é¢˜ã€‚**ä¸å»ºè®®å°è¯•æˆ–æäº¤æœ¬é¢˜ã€‚**[å…³äºæ­¤ç±»é¢˜ç›®çš„è¯¦ç»†å†…å®¹](https://www.luogu.com.cn/paste/isdgwj5l)

## é¢˜ç›®æè¿°

æœ‰ä¸€ä½ä½¿è€…è¦æ¸¸å†å„å›½ï¼Œä»–æ¯åˆ°ä¸€ä¸ªå›½å®¶ï¼Œéƒ½èƒ½å­¦åˆ°ä¸€ç§æ–‡åŒ–ï¼Œä½†ä»–ä¸æ„¿æ„å­¦ä¹ ä»»ä½•ä¸€ç§æ–‡åŒ–è¶…è¿‡ä¸€æ¬¡ï¼ˆå³å¦‚æœä»–å­¦ä¹ äº†æŸç§æ–‡åŒ–ï¼Œåˆ™ä»–å°±ä¸èƒ½åˆ°è¾¾å…¶ä»–æœ‰è¿™ç§æ–‡åŒ–çš„å›½å®¶ï¼‰ã€‚ä¸åŒçš„å›½å®¶å¯èƒ½æœ‰ç›¸åŒçš„æ–‡åŒ–ã€‚ä¸åŒæ–‡åŒ–çš„å›½å®¶å¯¹å…¶ä»–æ–‡åŒ–çš„çœ‹æ³•ä¸åŒï¼Œæœ‰äº›æ–‡åŒ–ä¼šæ’æ–¥å¤–æ¥æ–‡åŒ–ï¼ˆå³å¦‚æœä»–å­¦ä¹ äº†æŸç§æ–‡åŒ–ï¼Œåˆ™ä»–ä¸èƒ½åˆ°è¾¾æ’æ–¥è¿™ç§æ–‡åŒ–çš„å…¶ä»–å›½å®¶ï¼‰ã€‚

ç°ç»™å®šå„ä¸ªå›½å®¶é—´çš„åœ°ç†å…³ç³»ï¼Œå„ä¸ªå›½å®¶çš„æ–‡åŒ–ï¼Œæ¯ç§æ–‡åŒ–å¯¹å…¶ä»–æ–‡åŒ–çš„çœ‹æ³•ï¼Œä»¥åŠè¿™ä½ä½¿è€…æ¸¸å†çš„èµ·ç‚¹å’Œç»ˆç‚¹ï¼ˆåœ¨èµ·ç‚¹å’Œç»ˆç‚¹ä¹Ÿä¼šå­¦ä¹ å½“åœ°çš„æ–‡åŒ–ï¼‰ï¼Œå›½å®¶é—´çš„é“è·¯è·ç¦»ï¼Œè¯•æ±‚ä»èµ·ç‚¹åˆ°ç»ˆç‚¹æœ€å°‘éœ€èµ°å¤šå°‘è·¯ã€‚


## è¯´æ˜/æç¤º

è¾“å…¥è¾“å‡ºæ ·ä¾‹è¯´æ˜$1$

ç”±äºåˆ°å›½å®¶ $2$ å¿…é¡»è¦ç»è¿‡å›½å®¶$ 1$ï¼Œè€Œå›½å®¶$ 2 $çš„æ–‡æ˜å´æ’æ–¥å›½å®¶ $1$ çš„æ–‡æ˜ï¼Œæ‰€ä»¥ä¸å¯èƒ½åˆ°è¾¾å›½å®¶ $2$ã€‚


è¾“å…¥è¾“å‡ºæ ·ä¾‹è¯´æ˜$2$

è·¯çº¿ä¸º$ 1$ ->$ 2$

ã€æ•°æ®èŒƒå›´ã€‘

å¯¹äº 100%çš„æ•°æ®ï¼Œæœ‰$ 2â‰¤Nâ‰¤100$

$1â‰¤Kâ‰¤100$ 

$1â‰¤Mâ‰¤N^2$

$1â‰¤k_iâ‰¤K$

$1â‰¤u, vâ‰¤N$ 

$1â‰¤dâ‰¤1000,Sâ‰ T,1â‰¤S,Tâ‰¤N$

NOIP 2012 æ™®åŠç»„ ç¬¬å››é¢˜


## æ ·ä¾‹ #1

### è¾“å…¥

```
2 2 1 1 2 
1 2 
0 1 
1 0 
1 2 10 
```

### è¾“å‡º

```
-1```

## æ ·ä¾‹ #2

### è¾“å…¥

```
2 2 1 1 2 
1 2 
0 1 
0 0 
1 2 10 ```

### è¾“å‡º

```
10```

# AIåˆ†æç»“æœ



### ç®—æ³•åˆ†ç±»  
æ— ç®—æ³•åˆ†ç±»ï¼ˆæœ¬é¢˜æ ¸å¿ƒä¸ºå¸¦çº¦æŸçš„æœ€çŸ­è·¯å¾„é—®é¢˜ï¼Œé¢˜è§£ä¸»è¦é‡‡ç”¨DFSã€BFSã€å¯å‘å¼æœç´¢ã€Floydã€Dijkstraç­‰å›¾è®ºç®—æ³•ï¼‰

---

### é¢˜è§£æ€è·¯ä¸æ ¸å¿ƒéš¾ç‚¹åˆ†æ

#### ç®—æ³•è¦ç‚¹å¯¹æ¯”
| é¢˜è§£æ ¸å¿ƒæ€è·¯                  | è§£å†³éš¾ç‚¹ç­–ç•¥                                                                 | ä¼˜åŒ–æ‰‹æ®µ                                 |
|------------------------------|-----------------------------------------------------------------------------|----------------------------------------|
| **å¯å‘å¼æœç´¢+SPFAå‰ªæ**       | ç”¨SPFAé¢„å¤„ç†ä¸è€ƒè™‘æ–‡åŒ–çš„æœ€çŸ­è·¯ä½œä¸ºä¼°ä»·å‡½æ•°ï¼ŒDFSæ—¶è‹¥å½“å‰è·¯å¾„+ä¼°ä»·â‰¥ç­”æ¡ˆåˆ™å‰ªæ | å‰ªæåŠ›åº¦å¼ºï¼Œæ—¶é—´å¤æ‚åº¦å¤§å¹…é™ä½           |
| **FloydåŠ¨æ€ç»´æŠ¤æ–‡åŒ–æ’æ–¥å…³ç³»** | åœ¨Floydæ’ç‚¹æ—¶è®°å½•è·¯å¾„ä¸Šçš„æ‰€æœ‰æ–‡åŒ–ï¼ŒåŠ¨æ€åˆå¹¶æ–‡åŒ–æ’æ–¥çŠ¶æ€                     | åˆ©ç”¨Floydçš„ç‰¹æ€§å¤„ç†å¤šçº¦æŸæ¡ä»¶           |
| **Dijkstra+çŠ¶æ€æ ‡è®°**         | æ¯ä¸ªèŠ‚ç‚¹ç»´æŠ¤å·²å­¦æ–‡åŒ–é›†åˆï¼Œæ¾å¼›æ—¶æ£€æŸ¥æ–°èŠ‚ç‚¹çš„æ–‡åŒ–æ˜¯å¦ä¸å·²å­¦æ–‡åŒ–å†²çª         | ä¼˜å…ˆé˜Ÿåˆ—ä¿è¯æœ€ä¼˜æ€§ï¼ŒçŠ¶æ€å‹ç¼©æå‡æ•ˆç‡    |
| **A*ç®—æ³•+åå‘æœ€çŸ­è·¯**         | ç”¨åå‘å›¾é¢„å¤„ç†åˆ°ç»ˆç‚¹çš„æœ€çŸ­è·¯ä½œä¸ºå¯å‘å‡½æ•°ï¼Œä¼˜å…ˆæ‰©å±•ä¼°ä»·å°çš„èŠ‚ç‚¹              | ç»“åˆå¯å‘å¼æœç´¢å’Œå‰ªæç­–ç•¥                |

#### æ ¸å¿ƒéš¾ç‚¹çªç ´
1. **æ–‡åŒ–æ’æ–¥çš„åŠ¨æ€ç»´æŠ¤**ï¼šéœ€å®æ—¶åˆ¤æ–­è·¯å¾„ä¸Šæ‰€æœ‰æ–‡åŒ–æ˜¯å¦ä¸æ–°èŠ‚ç‚¹æ–‡åŒ–å†²çªï¼ˆæ—¶é—´å¤æ‚åº¦O(K) â†’ é¢˜è§£é‡‡ç”¨bitsetä¼˜åŒ–è‡³O(1)ï¼‰
2. **çŠ¶æ€çˆ†ç‚¸é—®é¢˜**ï¼šæ¯ä¸ªèŠ‚ç‚¹å¯èƒ½å¯¹åº”2^Kç§æ–‡åŒ–çŠ¶æ€ï¼ˆKâ‰¤100æ—¶ä¸å¯è¡Œï¼‰â†’ é¢˜è§£é€šè¿‡å‰ªææˆ–Floydçš„è·¯å¾„åˆå¹¶é¿å…æ˜¾å¼å­˜å‚¨
3. **åå‘æ€ç»´åº”ç”¨**ï¼šå¤šä¸ªé¢˜è§£é€šè¿‡åå‘é¢„å¤„ç†æœ€çŸ­è·¯ï¼ˆç»ˆç‚¹åˆ°å„ç‚¹ï¼‰å®ç°å¼ºåŠ›å‰ªæ

---

### é¢˜è§£è¯„åˆ†ï¼ˆâ‰¥4æ˜Ÿï¼‰

1. **Created_equal1ï¼ˆâ˜…â˜…â˜…â˜…â˜†ï¼‰**  
   - **äº®ç‚¹**ï¼šå¯å‘å¼å‰ªæå¤§å¹…æå‡æœç´¢æ•ˆç‡ï¼Œä»£ç ç»“æ„æ¸…æ™°  
   - **ä»£ç ç‰‡æ®µ**ï¼š  
     ```cpp
     void Dfs(const size_t &Now, const unsigned int &D) {
         if (D + Dist[Now] > Ans) return; // å…³é”®å‰ªæé€»è¾‘
         // ...
     }
     ```

2. **grard4ï¼ˆâ˜…â˜…â˜…â˜…â˜†ï¼‰**  
   - **äº®ç‚¹**ï¼šA*ç®—æ³•ç»“åˆbitsetçŠ¶æ€å‹ç¼©ï¼Œé¢„å¤„ç†å»é™¤æ— æ•ˆè¾¹  
   - **ä¼˜åŒ–ç‚¹**ï¼š  
     ```cpp
     if (p.any()) continue; // bitsetå¿«é€Ÿåˆ¤æ–­æ–‡åŒ–å†²çª
     ```

3. **Charles_with_wkcï¼ˆâ˜…â˜…â˜…â˜…â˜†ï¼‰**  
   - **äº®ç‚¹**ï¼šDijkstraä¸­åŠ¨æ€ç»´æŠ¤useæ•°ç»„ï¼Œè®°å½•æ’æ–¥å…³ç³»  
   - **å…³é”®é€»è¾‘**ï¼š  
     ```cpp
     for(int i=1;i<=k;i++)
         if(qs[cul[x]][i]) tmp.use[i]=1; // åŠ¨æ€æ›´æ–°æ’æ–¥æ ‡è®°
     ```

---

### æœ€ä¼˜æŠ€å·§æç‚¼

1. **å‰ªæç­–ç•¥ä¸‰è¦ç´ **  
   - **é¢„å¤„ç†æœ€çŸ­è·¯**ï¼šæ„å»ºä¸è€ƒè™‘æ–‡åŒ–çº¦æŸçš„"ç†æƒ³æœ€ä¼˜è§£"ä½œä¸ºå‰ªæåŸºå‡†  
   - **å¯è¡Œæ€§å‰ªæ**ï¼šå½“å‰è·¯å¾„é•¿åº¦ + å‰©ä½™ç†æƒ³æœ€çŸ­è·ç¦» â‰¥ å½“å‰æœ€ä¼˜è§£æ—¶ç»ˆæ­¢æœç´¢  
   - **æ–‡åŒ–çŠ¶æ€å‹ç¼©**ï¼šç”¨bitsetä»£æ›¿æ•°ç»„æ£€æŸ¥æ–‡åŒ–å†²çªï¼ˆO(1)å¤æ‚åº¦ï¼‰

2. **DijkstraçŠ¶æ€è®¾è®¡**  
   ```cpp
   struct node {
       int dis, pos;
       bool used[105]; // æ–‡åŒ–çŠ¶æ€è®°å½•
   };
   ```
   æ¯æ¬¡æ‰©å±•èŠ‚ç‚¹æ—¶æºå¸¦å·²å­¦æ–‡åŒ–ä¿¡æ¯ï¼Œé¿å…å…¨å±€çŠ¶æ€å†²çª

3. **Floydè·¯å¾„åˆå¹¶**  
   åœ¨æ’ç‚¹kæ—¶åŠ¨æ€åˆå¹¶ä¸¤æ¡è·¯å¾„çš„æ–‡åŒ–é›†åˆï¼š
   ```cpp
   used[i][j][t] = used[i][k][t] || used[k][j][t];
   used[i][j][c[k]] = true; // è®°å½•å½“å‰æ’å…¥ç‚¹çš„æ–‡åŒ–
   ```

---

### ç±»ä¼¼é¢˜ç›®æ¨è

1. **[P3953 é€›å…¬å›­](https://www.luogu.com.cn/problem/P3953)**  
   ï¼ˆå¸¦çº¦æŸçš„æœ€çŸ­è·¯å¾„è®¡æ•°é—®é¢˜ï¼‰

2. **[P4011 å­¤å²›è¥æ•‘é—®é¢˜](https://www.luogu.com.cn/problem/P4011)**  
   ï¼ˆå¤šç»´çŠ¶æ€BFSï¼Œé’¥åŒ™æºå¸¦çŠ¶æ€ç®¡ç†ï¼‰

3. **[P4732 å®šå‘è¶Šé‡](https://www.luogu.com.cn/problem/P4732)**  
   ï¼ˆå›¾è®ºä¸­çš„åŠ¨æ€çº¦æŸå¤„ç†ï¼‰

---

### å¯è§†åŒ–è®¾è®¡æ€è·¯

#### æ ¸å¿ƒå…ƒç´ å±•ç¤º
```mermaid
graph LR
    Start((S)) -->|10| A((1))
    A -->|20| B((2))
    B -->|æ–‡åŒ–å†²çª| End((T))
    
    style Start fill:#4CAF50
    style End fill:#F44336
    style B stroke:#FF5722,stroke-width:2px
```

#### åŠ¨ç”»å®ç°è¦ç‚¹
1. **è·¯å¾„æ¢ç´¢è¿‡ç¨‹**  
   - çº¢è‰²é—ªçƒè¡¨ç¤ºæ–‡åŒ–å†²çªå¯¼è‡´çš„è·¯å¾„å¤±æ•ˆ  
   - ç»¿è‰²æ¸æ˜¾è¡¨ç¤ºæœ‰æ•ˆè·¯å¾„æ‰©å±•

2. **çŠ¶æ€é¢æ¿è®¾è®¡**  
   ```plaintext
   å½“å‰èŠ‚ç‚¹: 2
   å·²å­¦æ–‡åŒ–: [1,3]
   æ’æ–¥æ–‡åŒ–: [2,4]
   ç´¯è®¡è·ç¦»: 35
   ```

3. **å¤å¤åƒç´ é£æ ¼**  
   - ä½¿ç”¨16è‰²è°ƒè‰²æ¿ï¼ˆNESé£æ ¼ï¼‰
   - èŠ‚ç‚¹ç”¨8x8åƒç´ æ–¹å—è¡¨ç¤ºï¼Œæ–‡åŒ–å†²çªæ—¶æ˜¾ç¤º"ğŸ’¥"ç¬¦å·
   - éŸ³æ•ˆè®¾è®¡ï¼š  
     - è·¯å¾„æœ‰æ•ˆï¼š8-bitä¸Šå‡éŸ³é˜¶(0x1A3F)
     - æ–‡åŒ–å†²çªï¼šä½éŸ³çˆ†ç ´éŸ³(0x0F00)

---

### æ ¸å¿ƒä»£ç å®ç°

**å¯å‘å¼æœç´¢å‰ªæç‰‡æ®µ**ï¼š
```cpp
// SPFAé¢„å¤„ç†åå‘æœ€çŸ­è·¯
void Spfa() {
    // ...ï¼ˆæ ‡å‡†SPFAå®ç°ï¼‰
    Dist[To[i]] = Dist[Top] + Weight[i]; 
}

// DFSæœç´¢ä¸»é€»è¾‘
void Dfs(const size_t &Now, const unsigned int &D) {
    if (D + Dist[Now] > Ans) return; // å…³é”®å‰ªæ
    for (auto edge : Edges[Now]) {
        if (!checkCulturalConflict(edge.to)) continue;
        Dfs(edge.to, D + edge.dist);
    }
}
```

---

### æ€»ç»“å¯ç¤º

1. **å‰ªæç­–ç•¥å†³å®šæ•ˆç‡**ï¼šåœ¨çŠ¶æ€ç©ºé—´å·¨å¤§çš„é—®é¢˜ä¸­ï¼Œåˆç†çš„å‰ªææ¯”ç®—æ³•é€‰æ‹©æ›´é‡è¦  
2. **é¢„å¤„ç†çš„è‰ºæœ¯**ï¼šåå‘æœ€çŸ­è·¯ã€ç†æƒ³æœ€ä¼˜è§£ç­‰é¢„å¤„ç†æ‰‹æ®µèƒ½æå¤§æå‡æœç´¢æ•ˆç‡  
3. **çŠ¶æ€å‹ç¼©æ€æƒ³**ï¼šé¢å¯¹é«˜ç»´çŠ¶æ€æ—¶ï¼Œé‡‡ç”¨bitsetç­‰å‹ç¼©æŠ€æœ¯æ˜¯çªç ´ç“¶é¢ˆçš„å…³é”®

---
å¤„ç†ç”¨æ—¶ï¼š75.93ç§’
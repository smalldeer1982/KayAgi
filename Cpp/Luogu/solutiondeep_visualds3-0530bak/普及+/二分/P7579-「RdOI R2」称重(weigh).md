# 题目信息

# 「RdOI R2」称重(weigh)

## 题目背景

因为 rui_er 是一个良心出题人，所以本题是一道交互题。

## 题目描述

rui_er 为了准备体测，买了 $n$ 个实心球准备练习，但是却发现在发货时混入了两个质量明显较轻但外观相似的球（这两个球质量相等），且已知这两个球的质量之和大于一个正常的球。为了防止影响训练效果，现在需要找出这两个球。因为手动找太慢了，现在拿来了一个天平，可以在两侧各放上若干个球，得到两侧的质量大小关系。请你帮帮 rui_er，在使用不超过 $k$ 次天平的情况下，找出这两个较轻的球。

这里 $k$ 是每个测试点的属性，你不必也不应该读入。

---

**交互方式**

本题采用 I/O 交互。

你可以选择进行称量操作，此时向标准输出打印一行 `1 p a1 a2 ... ap q b1 b2 ... bq`，表示在天平左盘放入编号为 $a_1,a_2,\cdots,a_p$ 的 $p$ 个球，在天平右盘放入编号为 $b_1,b_2,\cdots,b_q$ 的 $q$ 个球。随后清空缓冲区，并从标准输入读入一个 `<>=` 之一的字符，表示左盘与右盘的质量关系。

对于每次此类询问，你需要保证 $1\le p,q\le n$，$p+q\le n$，所有 $a_i$ 和 $b_i$ 互不相同，且你最多进行此类询问 $k$ 次。

在得到答案后，向标准输出打印一行 `2 x y` 来提交答案，表示编号为 $x$ 的球和编号为 $y$ 的球质量偏轻。

你需要保证 $1\le x\lt y\le n$（注意需要严格按照从小到大顺序输出），且在进行完这一操作后立即终止程序。

交互库在一开始就已经确定小球的情况，不会随着你的询问而改变。

## 说明/提示

**样例解释**

三次询问的结果为 $a_1=a_2,a_3\lt a_4,a_5\gt a_6$，可以知道编号为 $3,6$ 的两个球质量偏轻。

---

**数据范围**

本题按点得分。

$20$ 个非 HACK 测试点中，第一个点 $4$ 分，其它点每点 $5$ 分；$4$ 个 HACK 测试点共 $1$ 分，任意一个测试点不通过则不得分。

|测试点|$n\le$|$k=$|特殊性质|测试点|$n\le$|$k=$|特殊性质|
|:-:|:-:|:-:|:-:|:-:|:-:|:-:|:-:|
|1|$5$|$50$|无|11|$500$|$50$|无|
|2|$10$|$50$|无|12|$500$|$50$|无|
|3|$100$|$50$|无|13|$500$|$20$|A|
|4|$100$|$50$|无|14|$500$|$20$|B|
|5|$500$|$50$|A|15|$500$|$20$|A|
|6|$500$|$50$|B|16|$500$|$20$|B|
|7|$500$|$50$|A|17|$500$|$20$|无|
|8|$500$|$50$|B|18|$500$|$20$|无|
|9|$500$|$50$|无|19|$500$|$20$|无|
|10|$500$|$50$|无|20|$500$|$20$|无|
|ex1|$500$|$12$|B/HACK|ex3|$500$|$13$|HACK|
|ex2|$500$|$13$|HACK|ex4|$500$|$14$|HACK|

- 特殊性质 A：$n=2^i-1,i\in\left\{4,5,6,7,8\right\}$。
- 特殊性质 B：$n=2^i,i\in\left\{4,5,6,7,8\right\}$。
- 备注：HACK 数据的 $k$ 根据测试点实际情况设置，会卡一些奇怪的做法，保证正解可过。

对于全部数据，$5\le n\le 500$，$k\in\left\{50,20,14,13,12\right\}$。

## 样例 #1

### 输入

```
6

=

<

>```

### 输出

```

1 1 1 1 2

1 1 3 1 4

1 1 5 1 6

2 3 6```

# AI分析结果



**唯一算法分类**：二分

---

### **题解思路、算法要点与解决难点**

#### **核心思路**
本题需在有限次天平称量中找出两个轻球。核心采用**分治策略**，结合二分与三分思想，根据每次称量结果缩小搜索范围：

1. **分组策略**：
   - **偶数长度**：平均分为两组，比较质量。若等重则两假球各在一组；否则两假球同在较轻组。
   - **奇数长度**：单独留一个球，剩余均分两组。若两组等重，单独球可能为假；否则递归处理较轻组或结合单独球验证。

2. **递归处理**：
   - 每次称量后根据结果选择递归区间，逐步缩小候选范围。
   - 对单假球问题采用**三分法**（均分三组比较），每次排除2/3的球。

3. **边界处理**：
   - 当区间长度≤2时直接返回结果。
   - 处理奇数组时通过额外称量验证单独球是否为假球。

#### **解决难点**
- **假球分布判断**：需精确处理称量结果的三种可能性（<, =, >），区分假球在不同分组的场景。
- **优化询问次数**：通过三分法降低单假球问题的复杂度，避免二分法的最坏情况。
- **奇偶性处理**：单独处理奇数长度区间，确保递归过程的正确性。

---

### **题解评分 (≥4星)**

1. **rui_er (4.5星)**  
   **亮点**：官方题解，逻辑清晰，分类讨论完整，结合二分与三分优化。  
   **不足**：代码实现较复杂，边界处理需仔细。

2. **Grand_Dawn (4星)**  
   **亮点**：理论分析深入，提出接近下界的询问次数，讨论不同方法的优劣。  
   **不足**：实现细节较少，代码复杂度高。

3. **zhangxiao666 (4星)**  
   **亮点**：代码简洁，分治逻辑直观，适合快速理解核心思路。  
   **不足**：对三分优化未展开，部分边界条件处理简略。

---

### **最优思路/技巧提炼**

1. **三分法优化单假球搜索**  
   - 将区间均分三组，比较前两组：
     - 若等重 → 假球在第三组；
     - 否则在较轻组递归。
   - 时间复杂度从 `O(log2 n)` 优化至 `O(log3 n)`。

2. **奇偶分组策略**  
   - **偶数区间**：直接二分，处理假球分布。
   - **奇数区间**：单独留一球，递归后验证其是否假球，避免复杂边界。

3. **动态区间合并**  
   - 处理两假球问题时，通过称量结果合并或分割候选区间，减少无效询问。

---

### **同类型题与算法套路**

1. **分治策略**：适用于需要逐步缩小范围的交互问题（如猜数字、找假币）。
2. **二分答案**：在有序序列中快速定位目标值（如 [P1024 一元三次方程求解](https://www.luogu.com.cn/problem/P1024)）。
3. **三分法**：优化单峰函数极值搜索（如 [P3382 三分法](https://www.luogu.com.cn/problem/P3382)）。

**推荐题目**：
1. [P1571 眼红的Medusa](https://www.luogu.com.cn/problem/P1571)  
2. [P2249 【深基13.例1】查找](https://www.luogu.com.cn/problem/P2249)  
3. [P4343 [SHOI2015]自动刷题机](https://www.luogu.com.cn/problem/P4343)

---

### **可视化与算法演示**

#### **动画设计**
- **界面布局**：  
  ![Pixel Art Grid](https://img-blog.csdnimg.cn/direct/7a0c5d4d0f0a4f7d8e3c8d0e3e6a6c6f1.png)  
  使用 16 色像素风格，区间显示为横向色块，当前比较组高亮闪烁。

- **关键步骤**：
  1. **分组高亮**：用不同颜色标记左、右比较组及剩余区间。
  2. **结果反馈**：根据称量结果（<, =, >）显示箭头或符号。
  3. **区间收缩**：动态划掉被排除的区间，保留候选范围。

- **交互功能**：
  - **速度控制**：滑块调节动画速度（100ms~5s/步）。
  - **单步执行**：按空格键逐步执行分治过程。
  - **音效提示**：8-bit 音效区分成功/失败/步骤更新。

#### **代码片段（JS 核心逻辑）**
```javascript
function visualizeSearch(left, right, depth) {
  drawInterval(left, right); // 绘制当前区间
  const mid = Math.floor((left + right) / 2);
  playSound('beep'); // 播放分步音效
  if (compareGroups(left, mid, mid+1, right)) {
    highlight(mid+1, right, 'green'); // 右组较轻
    nextStep(() => visualizeSearch(mid+1, right, depth+1));
  } else {
    highlight(left, mid, 'red'); // 左组较轻
    nextStep(() => visualizeSearch(left, mid, depth+1));
  }
}
```

---

### **个人心得摘录**

> “写完二分被卡成 99 分后，意识到必须结合三分优化。分治策略的灵活性在于，通过合理分组可以将问题分解为更小的同构子问题，而边界处理是代码稳健的关键。” —— MarchKid_Joe

---

**总结**：本题通过分治策略（二分与三分结合）高效缩小搜索范围，核心在于动态调整分组策略与精确处理边界条件。可视化设计通过像素风格与交互式演示，直观展示分治过程的逻辑流动。

---
处理用时：76.36秒
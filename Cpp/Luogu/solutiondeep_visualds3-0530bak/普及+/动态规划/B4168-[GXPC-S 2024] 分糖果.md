# 题目信息

# [GXPC-S 2024] 分糖果

## 题目背景


小林最近迷上了博弈问题。

## 题目描述

有 $n$ 包糖果从左到右依次排成一行，第 $i$ 包糖果中有 $a_i$ 个糖果。小林和小伊从左到右对 $n$ 包糖果进行分配，分配权一开始在小林手里，小林可以将 $n$ 包糖果中最左端的糖果分配给自己或者小伊，本次分配中**没有拿到糖果**的人将拥有下一次的分配权。

如果小林和小伊都足够聪明，会采用最优的策略进行分配，保证自己最后拥有的糖果总数最多，如此分配 $n$ 轮后，求出小林和小伊中**糖果更多的那个人**所拥有的糖果数量。

## 说明/提示

样例解释：如下是他们的游戏过程。

- 小林将 $1$ 分给自己；此时小林和小伊的糖果数分别为 $1,0$；
- 小伊将 $3$ 分给小林；此时小林和小伊的糖果数分别为 $4,0$；
- 小伊将 $5$ 分给自己；此时小林和小伊的糖果数分别为 $4,5$；
- 小林将 $7$ 分给小伊；此时小林和小伊的糖果数分别为 $4,12$；
- 小林将 $9$ 分给自己；此时小林和小伊的糖果数分别为 $13,12$。

可以证明这是最优的游戏策略。


**本题采用捆绑测试。**

- Subtask 1（40pts）：保证 $n\le 20$；
- Subtask 2（60pts）：无额外约束。

对于 $100\%$ 的数据，保证 $1\le n,a_i\le 10^5$。

## 样例 #1

### 输入

```
5
1 3 5 7 9```

### 输出

```
13```

# AI分析结果



---

## 唯一算法分类  
**线性DP**

---

## 综合分析与结论  
### 核心思路与难点  
题目本质是博弈动态规划问题。双方的最优策略可以转化为：每一步先手需要最大化自己的收益，同时考虑对方后续的最优反应。通过从后往前递推的线性 DP，能够高效计算每个子问题的最大收益。  

### 关键状态转移方程  
设 `dp[i]` 为从第 `i` 包到第 `n` 包糖果的最优先手收益，`sum` 为后缀和，转移方程为：  
```
dp[i] = max(dp[i+1], a[i] + (sum - dp[i+1]))
```  
**解释**：  
1. **不取当前糖果**：保留先手权，收益为 `dp[i+1]`。  
2. **取当前糖果**：当前收益 `a[i]` + 剩余部分的后手收益（即 `sum - dp[i+1]`）。  

### 可视化设计要点  
- **动画方案**：  
  - 用网格展示 `dp` 数组的更新过程，每个格子对应 `i` 和当前 `dp` 值。  
  - 高亮当前处理的糖果 `a[i]`，动态显示 `sum` 的累加。  
  - 颜色区分两种决策：绿色（取当前糖果）和红色（保留先手权）。  
- **复古像素风格**：  
  - 使用 8-bit 风格字体和色块表示 `dp` 和 `sum`。  
  - 音效：转移时播放短促“滴”声，更新最优解时播放高音调。  
- **AI 自动演示**：  
  - 从右向左逐步更新，用户可调节速度观察每一步的 `dp` 值变化。  

---

## 题解清单 (≥4星)  
### 1. Sliarae 的题解（★★★★★）  
**亮点**：  
- 使用线性 DP 将状态压缩到 O(1) 空间，代码简洁高效。  
- 数学推导巧妙，通过后缀和与 DP 的差值直接计算后手收益。  

**代码核心逻辑**：  
```cpp
LL dp = 0, sum = 0; 
for (int i = n; i; --i) 
    dp = max(dp, a[i] + sum - dp), sum += a[i];
cout << dp << '\n';
```

---

## 最优思路提炼  
**关键技巧**：  
- **逆向递推**：从后往前处理，利用子问题的解快速推导父问题。  
- **数学简化**：用后缀和与 DP 值的差值表示后手收益，避免复杂状态定义。  
- **空间优化**：仅需两个变量维护 DP 和总和，空间复杂度 O(1)。  

**适用场景**：  
双方交替决策的最优化问题，且每一步选择影响后续先手权的归属。  

---

## 同类型题与算法套路  
**类似问题**：  
1. 石子游戏（LeetCode 877）：两人从两端取石子，求先手最大收益。  
2. 取硬币游戏（洛谷 P1430）：双方轮流取序列两端硬币，最大化差值。  
3. 卡牌游戏（Codeforces 455A）：动态规划处理博弈最优策略。  

**通用套路**：  
- 定义 `dp[i]` 为从位置 `i` 开始的最优解。  
- 利用逆向递推或记忆化搜索，处理双方交替决策的依赖关系。  

---

## 推荐洛谷题目  
1. **P1248**：取数游戏（线性 DP 博弈）  
2. **P1430**：取硬币（两端选择，动态规划）  
3. **P2938**：股票市场的策略（状态机 DP）  

---

## 个人心得摘录  
- **逆向思维**：从后往前推更容易发现状态转移的规律。  
- **数学转换**：将后手收益转换为总和减去先手收益，简化了问题。  

---

## 可视化与算法演示  
**核心 DP 动画示例**：  
```javascript
// 伪代码示例：Canvas 绘制 DP 过程
function drawDP() {
    for (let i = n; i >= 1; i--) {
        // 高亮当前处理的糖果 a[i]
        highlightCell(i);
        // 更新 dp 和 sum
        const newDp = Math.max(dp, a[i] + sum - dp);
        sum += a[i];
        dp = newDp;
        // 播放音效并更新界面
        playSound('beep');
        updateCanvas();
    }
}
```

**复古像素风格设计**：  
- 色块：使用绿色（取当前糖果）和红色（保留先手权）。  
- 背景音乐：8-bit 风格循环音轨。  
- 交互：点击单步执行或自动播放，速度可调节。

---
处理用时：98.24秒
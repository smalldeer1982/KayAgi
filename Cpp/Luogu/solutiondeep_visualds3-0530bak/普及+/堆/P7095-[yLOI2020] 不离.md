# 题目信息

# [yLOI2020] 不离

## 题目背景

> 乱玄黄时序，探风林实虚。  
> 我要你共我奇谈怪趣。  
> 任日月斑斓，待春秋兴残。  
> 我要我们有聚无散。  

——银临《不离》

## 题目描述

这道题目来自 zxy 哔哔，咕咕让哔哔选一首歌作为题目名，但是哔哔说没有想好，于是咕咕就帮他选了这首歌。

哔哔在玩一款叫做《暗黑破坏神》的游戏，某天哔哔灵光乍现，以游戏为背景出了一道神仙题并告诉了咕咕。咕咕并不会做，于是对题目进行了一定的简化。因此，经过简化后，这道题已经和《暗黑破坏神》没什么关系了。

游戏中人物有两个属性，我们分别称之为「力量」和「精神」，同时哔哔有 $n$ 件装备，穿戴第 $i$ 件装备需要人物在穿戴前的力量值不低于 $a_i$，精神值不低于 $b_i$。在穿戴第 $i$ 件装备后，人物的力量值会增加 $c_i$，精神值会增加 $d_i$。

哔哔可以自由选择穿装备的顺序，只要满足力量和精神不低于对应值，就可以穿戴该装备。

现在，咕咕想知道，如果想让哔哔穿戴上所有的装备，那么人物的初始力量值（即没有穿任何装备之前的力量值）最小应该是多少？在初始力量值最小的前提下，初始精神值（即没有穿任何装备之前的精神值）最小应该是多少？

显然，初始力量和初始精神都应该是非负整数。

## 说明/提示

### 样例 1 解释

当初始力量值为 $1$，精神值为 $2$ 时，可以穿戴第 $2$ 件装备。在穿戴该装备后，增加 $3$ 点力量和 $4$ 点精神，人物的属性变为 $4$ 点力量和 $6$ 点精神，此时可以穿戴第 $1$ 件装备。

### 数据规模与约定

**本题采用多测试点捆绑测试**。

- 子任务 $1$（$5$ 分）：保证 $n=0$。
- 子任务 $2$（$5$ 分）：保证 $n=1$。
- 子任务 $3$（$20$ 分）：保证 $a_i,b_i \le 100$，$n \le 6$。
- 子任务 $4$（$10$ 分）：保证 $a_i,b_i \le 10^5$，$n \le 6$。
- 子任务 $5$（$10$ 分）：保证 $a_i,b_i \le 10$。
- 子任务 $6$（$10$ 分）：保证 $a_i,b_i \le 100$。
- 子任务 $7$（$10$ 分）：保证 $b_i=0$，$n \le 6$。
- 子任务 $8$（$10$ 分）：保证 $b_i=0$。
- 子任务 $9$（$10$ 分）：保证 $n \le 6$。
- 子任务 $10$（$10$ 分）：无特殊约定。

对于全部的测试点，保证 $0 \le n \le 10^5$，$0 \le a_i,b_i,c_i,d_i \le 10^9$。

### 提示
有 $4$ 个样例文件，请见附加文件中的 forever.zip。

对于第三个样例，满足 $b_i = 0$。

## 样例 #1

### 输入

```
0
2
1 5 0 2
1 2 3 4```

### 输出

```
1 2```

# AI分析结果



---

## 唯一算法分类  
**贪心算法与优先队列**

---

## 综合分析与结论  
### 核心思路与解决难点  
1. **属性独立性**：题目要求先最小化力量再最小化精神，可拆分处理。  
2. **贪心策略**：  
   - **力量最小化**：按装备的穿戴需求 a 排序，动态维护当前力量值，不足时补充初始力量  
   - **精神最小化**：用优先队列维护当前力量可穿戴的装备，按精神需求从小到大取出  
3. **关键难点**：  
   - 处理力量后，精神的选择需避免破坏已确定的最小力量值  
   - 动态维护可穿戴装备集合，需高效数据结构支持  

### 可视化设计  
1. **动态过程演示**：  
   - **力量阶段**：左侧画布按 a 值排序显示装备，右侧显示当前力量和初始力量  
   - **精神阶段**：装备进入优先队列时用黄色高亮，选中穿戴时变为绿色，堆顶元素闪烁  
2. **复古像素风格**：  
   - 装备用 16x16 像素块表示，a/b 值用不同颜色（红/蓝）显示  
   - 优先队列以像素树结构动态生长，每次弹出元素时播放 8-bit "pop" 音效  
3. **交互控制**：  
   - 支持单步执行观察堆操作  
   - 进度条展示已处理装备比例  

---

## 题解清单 (≥4星)  
### 1. 火车司机 (⭐⭐⭐⭐⭐)  
**亮点**：  
- 提出 O(n log n) 的双阶段贪心  
- 代码简洁，直接模拟穿戴过程  
- 优先队列的实时维护逻辑清晰  

### 2. LAB_Maple (⭐⭐⭐⭐)  
**亮点**：  
- 分 Part 解释思路，适合教学  
- 通过错误数据示例揭示常见误区  
- 代码中显式维护队列插入条件  

### 3. AuCloud (⭐⭐⭐⭐)  
**亮点**：  
- 详细讨论二分法的局限性  
- 强调动态维护可穿戴集合的重要性  
- 提供多组测试数据验证边界情况  

---

## 最优思路与代码实现  
### 关键代码片段（火车司机）  
```cpp
sort(p + 1, p + 1 + n, cmp); // 按 a 排序
for (int i = 1, a = 0; i <= n; ++i) {
    if (a < p[i].a) ans1 += p[i].a - a, a = p[i].a;
    a += p[i].c;
}
priority_queue<buff> q; // 按 b 排序的优先队列
for (int i = 1, b = 0; i <= n; ++i) {
    while (p[i].a > ans1) { // 力量不足时从队列取装备
        if (b < q.top().b) ans2 += q.top().b - b, b = q.top().b;
        b += q.top().d, ans1 += q.top().c, q.pop();
    }
    q.push(p[i]); // 插入当前可穿戴装备
}
```

---

## 同类题目推荐  
1. **P1080 国王游戏**（双属性贪心排序）  
2. **P1230 智力大冲浪**（时间与收益的优先队列调度）  
3. **P4059 找爸爸**（动态维护可选集合的最优选择）  

---

## 个人心得摘录  
> "考试时曾错误地认为按 a 排序后直接取 b 的 max 即可，直到构造数据发现装备顺序会影响后续选择... 必须动态维护可选项" —— CuSO4_and_5H2O  

---

## 可视化实现方案  
### Canvas 动画核心逻辑  
```javascript
class EquipmentAnimator {
  constructor(equipments) {
    this.queue = new PriorityQueue((a,b) => a.b - b.b); // 按 b 排序的堆
    this.powerBar = document.getElementById('power-bar'); 
    this.mentalBar = document.getElementById('mental-bar');
  }

  step() {
    if (currentPhase === 'POWER') {
      // 力量阶段动画：红色进度条增长，装备块变绿
    } else {
      // 精神阶段动画：堆顶元素闪烁蓝色，弹出时播放音效
      const top = this.queue.pop();
      top.element.classList.add('blink');
      playSound('pop.wav');
    }
  }
}
```

### 8-bit 风格 CSS 片段  
```css
.equipment-block {
  width: 16px;
  height: 16px;
  image-rendering: pixelated;
  background: url('sprite.png') -32px 0; /* 装备像素图 */
}

.power-bar {
  border: 2px solid #ff0000; /* FC 红 */
  background: #331111; /* 暗红底色 */
}
```

---
处理用时：71.80秒
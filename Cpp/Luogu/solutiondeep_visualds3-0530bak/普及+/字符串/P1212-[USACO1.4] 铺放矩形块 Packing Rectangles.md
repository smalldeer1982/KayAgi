# 题目信息

# [USACO1.4] 铺放矩形块 Packing Rectangles

## 题目描述

给定 $4$ 个矩形块，找出一个最小的封闭矩形将这 $4$ 个矩形块放入，但不得相互重叠。所谓最小矩形指该矩形面积最小。

![](https://cdn.luogu.com.cn/upload/image_hosting/gu39gbyb.png)

$4$ 个矩形块中任一个矩形的边都与封闭矩形的边相平行，上图显示出了铺放 $4$ 个矩形块的 $6$ 种方案。  

这 $6$ 种方案是唯一可能的基本铺放方案。因为其它方案能由基本方案通过旋转和镜像反射得到。

可能存在满足条件且有着同样面积的各种不同的封闭矩形，你应该输出所有这些封闭矩形的边长。



## 说明/提示

【数据范围】  
对于 $100\%$ 的数据，输入的所有数在 $[1,50]$ 内。

题目翻译来自NOCOW。

USACO Training Section 1.4


## 样例 #1

### 输入

```
1 2
2 3
3 4
4 5
```

### 输出

```
40
4 10
5 8
```

# AI分析结果



### 算法分类
枚举

### 题解思路与核心分析
#### 核心难点
1. **排列组合**：4个矩形有4!×2^4=384种排列旋转方式
2. **摆放方案**：需正确实现题目描述的6种基本布局方式
3. **临界判断**：第六种情况需要处理5种子情况的几何关系

#### 解决思路
1. **全排列生成**：使用DFS或next_permutation生成矩形顺序
2. **旋转处理**：通过交换长宽生成所有旋转可能性
3. **布局计算**：对每个排列分别计算6种布局的包围矩形尺寸
4. **去重优化**：使用集合存储答案，避免重复记录相同尺寸

### 高星题解推荐（≥4星）
1. **七喜（★★★★☆）**
   - DFS生成排列，递归处理旋转
   - 独立check函数集中计算6种情况
   - 使用alter函数统一更新答案

2. **Chiesl（★★★★☆）**
   - 结构体存储答案便于排序去重
   - 独立函数处理每种布局计算
   - 深度优先搜索中处理旋转

3. **ChampionCyan（★★★★☆）**
   - 使用order数组处理排列顺序
   - 定义宏简化布局计算代码
   - 独立函数处理6种布局情况

### 关键代码实现
```cpp
// 七喜题解核心代码
void check() {
    // 情况1：四个并排
    x = tmpx[1]+tmpx[2]+tmpx[3]+tmpx[4];
    y = max(max(tmpy[1],tmpy[2]),max(tmpy[3],tmpy[4]));
    alter(x,y);

    // 情况2：三横一竖
    x = max(tmpx[1]+tmpx[2]+tmpx[3],tmpx[4]);
    y = max(tmpy[1],max(tmpy[2],tmpy[3]))+tmpy[4];
    alter(x,y);

    // 情况3：2+1+1布局
    x = max(tmpx[1]+tmpx[2],tmpx[3])+tmpx[4];
    y = max(max(tmpy[1],tmpy[2])+tmpy[3],tmpy[4]);
    alter(x,y);

    // 情况6：复杂布局（需处理5种子情况）
    y = max(tmpy[1]+tmpy[3],tmpy[2]+tmpy[4]);
    if(tmpy[1]+tmpy[3]<=tmpy[4]) x = max(tmpx[2],max(tmpx[1],tmpx[3])+tmpx[4]);
    else if(...) // 其他子情况判断
    alter(x,y);
}
```

### 可视化设计
1. **动画流程**
   - 左侧面板展示当前排列的四个矩形
   - 右侧分6个区域显示布局计算结果
   - 底部显示历史最小面积变化曲线

2. **关键元素高亮**
   - 当前处理矩形：红色边框
   - 包围矩形：蓝色虚线框
   - 面积更新时：黄色闪烁提示

3. **复古像素风格实现**
```javascript
// 绘制8位风格矩形
function drawPixelRect(ctx, x, y, w, h, color) {
    ctx.fillStyle = color;
    ctx.fillRect(x*ZOOM, y*ZOOM, w*ZOOM-1, h*ZOOM-1); // -1保留像素间隔
    ctx.strokeStyle = '#000';
    ctx.strokeRect(x*ZOOM, y*ZOOM, w*ZOOM, h*ZOOM);
}

// 音效触发
function playSound(type) {
    const sfx = {
        rotate: new Audio('data:audio/wav;base64,UklGRl9...'), // 旋转音效
        update: new Audio('data:audio/wav;base64,UklGRk9...')  // 答案更新音效
    };
    sfx[type].play();
}
```

### 相似题目推荐
1. P1005 矩阵取数游戏（布局优化）
2. P1058 立体图（几何建模）
3. P1323 删数问题（排列组合）

### 心得摘录
"第六种布局的5种子情况判断需要精确处理几何关系，我通过手绘20余种边界情况才确定条件分支的正确性" —— Chiesl题解

"使用结构体存储答案并自定义排序函数，有效解决了结果去重和格式输出问题" —— ChampionCyan题解

### 算法演示
**步进控制面板功能：**
1. 速度调节：0.5x ~ 5x 动画速度
2. 模式切换：连续播放/单步执行
3. 高亮开关：显示当前处理元素
4. 布局筛选：单独查看某类布局的计算过程

**可视化示例：**
![布局6的判定流程](https://cdn.luogu.com.cn/upload/image_hosting/3h9gu0md.png)
1. 初始排列：显示四个矩形的原始方向
2. 旋转阶段：展示每个矩形的90度旋转过程
3. 布局计算：用不同颜色区分各个子情况的判定区域
4. 结果对比：并列显示六种布局的包围矩形尺寸

---
处理用时：56.71秒
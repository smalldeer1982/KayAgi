# 题目信息

# [NOIP 2012 提高组] 同余方程

## 题目描述

求关于 $ x$ 的同余方程 $ a x \equiv 1 \pmod {b}$ 的最小正整数解。


## 说明/提示

### 数据规模与约定

- 对于 $40\%$ 的数据，$2 ≤b≤ 1,000$；
- 对于 $60\%$ 的数据，$2 ≤b≤ 50,000,000$；
- 对于 $100\%$ 的数据，$2 ≤a, b≤ 2,000,000,000$。



## 样例 #1

### 输入

```
3 10```

### 输出

```
7```

# AI分析结果



# [NOIP 2012 提高组] 同余方程

**算法分类**: 数论

---

## 题解思路与难点对比

### 核心思路
求同余方程 $ax \equiv 1 \pmod{b}$ 的最小正整数解，等价于求解 $ax + by = 1$ 的整数解。根据裴蜀定理，当且仅当 $\gcd(a, b) = 1$ 时存在解。扩展欧几里得算法（exgcd）是求解此类方程的标准方法。

### 关键数学推导
1. **扩展欧几里得递归式**  
   递归基：当 $b=0$ 时，$\gcd(a,0)=a$，特解为 $x=1, y=0$。  
   递归过程：将 $ax + by = \gcd(a,b)$ 转化为 $bx' + (a \bmod b)y' = \gcd(b, a \bmod b)$，通过变量代换得到 $x = y', y = x' - \lfloor a/b \rfloor y'$。

2. **通解调整**  
   求得特解 $x_0$ 后，通解为 $x = x_0 + k \cdot b$（$k$ 为整数）。最小正整数解通过取模运算 $(x \bmod b + b) \bmod b$ 获得。

### 题解对比
| 题解作者       | 核心方法       | 评分 | 亮点                                 |
|----------------|----------------|------|--------------------------------------|
| 学委           | 扩展欧几里得   | ★★★★☆ | 详细推导递归公式，代码清晰易读       |
| 沙普绿12138    | 欧拉定理+快速幂 | ★★★★☆ | 利用欧拉函数性质，适合理解定理应用   |
| _Nova          | 扩展欧几里得   | ★★★★☆ | 代码简洁，包含完整公式推导说明       |

---

## 最优思路与技巧
1. **扩展欧几里得算法**  
   - **递归分解**：将问题分解为更小的子问题，逐步逼近递归基。
   - **变量代换**：通过数学推导将 $x, y$ 转换为子问题的解，避免直接暴力枚举。
   - **时间复杂度**：$O(\log \min(a, b))$，显著优于欧拉定理法。

2. **通解调整公式**  
   使用 $(x \bmod b + b) \bmod b$ 确保结果为正且最小，避免逐次加减的低效操作。

---

## 可视化算法演示

### 扩展欧几里得递归流程
```python
def exgcd(a, b):
    if b == 0:
        return (a, 1, 0)  # gcd, x, y
    else:
        g, x1, y1 = exgcd(b, a % b)
        x = y1
        y = x1 - (a // b) * y1
        return (g, x, y)
```

### 复古像素风格动画设计
1. **颜色方案**  
   - 递归基：绿色像素块（`#00FF00`）  
   - 递归步骤：黄色像素块（`#FFFF00`）  
   - 变量代换：红色闪烁效果（`#FF0000`）  

2. **音效设计**  
   - 递归基触发：8-bit "完成"音效（频率 880Hz，时长 0.1s）  
   - 变量更新：短促 "点击" 音效（频率 440Hz，时长 0.05s）  

3. **Canvas 动画**  
   ```javascript
   // 示例：绘制递归步骤
   ctx.fillStyle = '#FFFF00';
   ctx.fillRect(step * 32, 0, 32, 32); // 每步占据32x32像素
   ```

---

## 推荐题目
1. **P3811** [【模板】模意义下的乘法逆元](https://www.luogu.com.cn/problem/P3811)  
   - 练习线性求逆元技巧。
2. **P1516** [青蛙的约会](https://www.luogu.com.cn/problem/P1516)  
   - 应用扩展欧几里得解线性同余方程。
3. **P1082** [同余方程](https://www.luogu.com.cn/problem/P1082)  
   - 同类题目巩固。

---

## 个人心得摘录
- **学委**：调试时发现 `y = 7` 的写法不影响结果，说明递归基的 `y` 值可任意，但需保持 `x=1`。
- **沙普绿12138**：强调欧拉定理与快速幂的结合，需注意质因数分解的边界条件（如剩余大质数）。

---

**核心代码实现**
```cpp
#include <iostream>
using namespace std;

void exgcd(int a, int b, int& x, int& y) {
    if (b == 0) { x = 1; y = 0; return; }
    exgcd(b, a % b, y, x);
    y -= a / b * x;
}

int main() {
    int a, b, x, y;
    cin >> a >> b;
    exgcd(a, b, x, y);
    cout << (x % b + b) % b;
    return 0;
}
```

---
处理用时：61.46秒
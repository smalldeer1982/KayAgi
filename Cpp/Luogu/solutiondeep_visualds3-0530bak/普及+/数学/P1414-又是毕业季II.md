# 题目信息

# 又是毕业季II

## 题目背景

“叮铃铃铃”，随着高考最后一科结考铃声的敲响，三年青春时光顿时凝固于此刻。毕业的欣喜怎敌那离别的不舍，憧憬着未来仍毋忘逝去的歌。一千多个日夜的欢笑和泪水，全凝聚在毕业晚会上，相信，这一定是一生最难忘的时刻！


## 题目描述

彩排了一次，老师不太满意。当然啦，取每位同学的号数来找最大公约数显然不太合理。于是老师给每位同学评了一个能力值。于是现在问题变为，从 $n$ 个学生中挑出 $k$ 个人使得他们的默契程度（即能力值的最大公约数）最大。但因为节目太多了，而且每个节目需要的人数又不知道。老师想要知道所有情况下能达到的最大默契程度是多少。这下子更麻烦了，还是交给你吧~

PS：一个数的最大公约数即本身。


## 说明/提示

【题目来源】

lzn 原创

【数据范围】

记输入数据中能力值的最大值为 $\textit{inf}$。

- 对于 $20\%$ 的数据，$n \leq 5$，$\textit{inf}\leq 10^3$；
- 对于另 $30\%$ 的数据，$n \leq 100$，$\textit{inf} \leq 10$；
- 对于 $100\%$ 的数据，$n \leq 10^4$，$\textit{inf} \leq 10^6$。

## 样例 #1

### 输入

```
4
1 2 3 4
```

### 输出

```
4
2
1
1
```

# AI分析结果



**唯一算法分类**  
数论  

---

**综合分析与结论**  
题目要求对每个k（1到n）找出k个数的最大公约数的最大值。核心思路是利用因数统计：  
1. **因数分解**：每个数的所有因数被统计出现次数。  
2. **逆序查找**：从最大可能因数开始，找到满足出现次数≥k的最大因数。  
3. **后缀优化**：确保较小k的答案不小于较大k的答案。  

**关键公式与推导**：  
- 每个数的因数分解时间复杂度为O(√x)，统计所有数的总复杂度为O(n√inf)。  
- 最大公约数的候选值必须是某些数的因数，因此统计因数出现次数即可确定候选值。  

**可视化设计思路**：  
1. **因数分解动画**：展示每个数分解为因数的动态过程，高亮当前因数。  
2. **统计次数更新**：用柱状图实时显示各因数的统计次数。  
3. **逆序查找过程**：从最大值逐步下降，用颜色标记满足条件的因数，找到每个k的答案。  

---

**题解评分（≥4星）**  
1. **夜刀神十香（5星）**  
   - **亮点**：代码简洁，直接分解因数统计次数，逆序查找高效。  
   - **核心代码**：  
     ```cpp
     while(c[x]<i) x--; // 逆序查找最大因数
     ```

2. **影辰（4星）**  
   - **亮点**：筛法统计倍数次数，后缀处理确保正确性。  
   - **核心代码**：  
     ```cpp
     for(int j=1;i*j<inf;j++) sum += t[i*j]; // 统计i的倍数出现次数
     ```

3. **lzn（4星）**  
   - **亮点**：逆向递推思路明确，数学推导清晰。  

---

**最优思路提炼**  
1. **因数统计法**：分解每个数的因数，统计出现次数。  
2. **逆序贪心**：从最大因数开始，找到第一个满足次数≥k的值。  
3. **后缀优化**：通过逆序处理或后缀最大值，保证答案单调不增。  

---

**同类型题与套路**  
- **通用数论套路**：最大公约数问题常转化为因数统计，利用筛法或分解法统计出现次数。  
- **类似题目**：求多个数的最大公约数、统计区间内数的因数分布。  

---

**推荐题目**  
1. [P1029 最大公约数和最小公倍数问题](https://www.luogu.com.cn/problem/P1029)  
2. [P1177 筛选法求素数](https://www.luogu.com.cn/problem/P1177)  
3. [P1414 又是毕业季II](https://www.luogu.com.cn/problem/P1414)（本题加强版）  

---

**个人心得摘录**  
- **调试教训**：完全平方数需特判，避免重复计数（如4=2×2，2只计一次）。  
- **顿悟**：逆序查找巧妙利用答案单调性，避免重复计算。  

---

**可视化与算法演示**  
- **动画设计**：  
  1. **分解因数**：以像素方块展示每个数的因数分解，实时更新统计次数。  
  2. **逆序查找**：高亮当前检查的因数，若满足条件则播放成功音效。  
  3. **历史轨迹**：显示每个k的答案变化轨迹，颜色区分不同k值。  
- **复古风格**：采用8位像素风，因数分解时显示“爆炸”特效，音效模仿经典游戏。  

---

**代码实现（夜刀神十香版）**  
```cpp
#include<iostream>
#include<cmath>
using namespace std;
int n, t = 0, c[1000010];

int main() {
    cin >> n;
    for (int i = 1; i <= n; i++) {
        int x; cin >> x;
        t = max(t, x);
        for (int i = 1; i <= sqrt(x); i++) {
            if (x % i == 0) {
                c[i]++;
                if (x != i * i) c[x / i]++;
            }
        }
    }
    int x = t;
    for (int i = 1; i <= n; i++) {
        while (c[x] < i) x--;
        cout << x << endl;
    }
    return 0;
}
```  

**核心逻辑**：统计每个因数出现次数，逆序查找满足条件的最大的x。

---
处理用时：95.36秒
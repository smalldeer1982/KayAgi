# 题目信息

# 等式

## 题目背景

ZKC 有一天突发奇想，望着天空想出一道很好的问题，但是绞尽脑汁又不会做，所以请你来帮他解决。


## 题目描述

给出 $a,b,c,x_1,x_2,y_1,y_2$，求满足 $ax+by+c=0$，且 $x\in [x_1,x_2]$，$y\in [y_1,y_2]$ 的整数解有多少对。


## 说明/提示

对于 $30\%$ 的数据，$a,b,c,x_1,x_2,y_1,y_2$ 的绝对值不超过 $1000$。

对于 $100\%$ 的数据，$a,b,c,x_1,x_2,y_1,y_2$ 的绝对值不超过 $10^8$。


## 样例 #1

### 输入

```
1 1 -3 0 4 0 4```

### 输出

```
4```

# AI分析结果



## 唯一算法分类：**数论**

---

### 题解思路、算法要点与解决难点

#### **核心思路**
通过扩展欧几里得算法找到方程 $ax + by = -c$ 的通解形式，结合整数解范围和约束条件，推导 $k$ 的取值范围。需处理以下关键点：
1. **特解推导**：通过扩展欧几里得算法找到特解 $(x_0, y_0)$。
2. **通解形式**：$x = x_0 + k \cdot \frac{b}{\gcd(a,b)},\ y = y_0 - k \cdot \frac{a}{\gcd(a,b)}$。
3. **范围约束**：通过不等式联立求解 $k$ 的上下界，取整数交集。

#### **解决难点**
1. **符号处理**：当 $a$ 或 $b$ 为负时，需调整 $x/y$ 的范围取反。
2. **边界精度**：用浮点运算推导 $k$ 的范围后，需用 `ceil` 和 `floor` 确保整数解。
3. **特殊情况**：
   - $a=0$ 或 $b=0$ 时退化为单变量方程。
   - $a=b=0$ 时需判断 $c$ 是否为零。
   - $c \nmid \gcd(a,b)$ 时无解。

---

### 题解评分（≥4星）

| 题解作者 | 评分 | 亮点 |
|---------|------|------|
| saxiy   | ⭐⭐⭐⭐⭐ | 完整处理所有特例，高效推导通解范围，代码逻辑清晰。 |
| winmt   | ⭐⭐⭐⭐ | 详细推导通解范围，但代码实现略繁琐。 |
| KGB1331 | ⭐⭐⭐⭐ | 暴力枚举但通过数学优化缩小范围，代码简洁但仅适用小数据。 |

---

### 最优思路/技巧提炼

1. **通解公式**：
   $$
   x = x_0 + k \cdot \frac{b}{d},\quad y = y_0 - k \cdot \frac{a}{d},\quad d = \gcd(a,b)
   $$
2. **范围联立**：
   - 联立 $x \in [x_1, x_2]$ 和 $y \in [y_1, y_2]$，推导 $k$ 的上下界。
3. **符号处理技巧**：
   - 若 $a$ 或 $b$ 为负，取反并交换 $x/y$ 的区间端点。

---

### 同类型题套路

1. **线性丢番图方程**：形如 $ax + by = c$ 的整数解问题，均可用扩展欧几里得算法。
2. **约束条件优化**：通过不等式联立推导参数范围，常见于数论和组合优化问题。

---

### 推荐题目
1. **P1082 同余方程**（扩展欧几里得基础）
2. **P1516 青蛙的约会**（同余方程应用）
3. **P2421 荒岛野人**（多约束线性方程）

---

### 个人心得摘录
- **saxiy**：调试时发现边界条件需用 `ceil` 和 `floor`，否则会遗漏解。
- **Tari**：左右端点取整方向易错，需仔细推导不等式方向。

---

### 可视化与算法演示

#### **核心数学过程**
1. **特解计算**：展示扩展欧几里得算法递归过程，高亮每一步的 $x, y, \gcd$。
2. **通解范围推导**：
   - 动画显示 $x$ 和 $y$ 随 $k$ 变化的曲线。
   - 用色块标出 $x \in [x_1, x_2]$ 和 $y \in [y_1, y_2]$ 的可行区域，叠加后显示 $k$ 的交集。
3. **复古像素风格**：
   - **Canvas 绘制**：用 8 位像素网格表示 $k$ 的取值范围，绿色块表示可行解。
   - **音效**：计算完成时播放 8-bit 成功音效，无解时播放失败音效。

#### **代码片段（关键逻辑）**
```cpp
void exgcd(ll a, ll b, ll &x, ll &y, ll &gcd) {
    if (!b) { x = 1; y = 0; gcd = a; return; }
    exgcd(b, a % b, y, x, gcd);
    y -= a / b * x;
}

// 计算k的范围
double l = (gcd * (x1 - x)) / b;
double r = (gcd * (x2 - x)) / b;
l = max(l, (gcd * (y - y2)) / a);
r = min(r, (gcd * (y - y1)) / a);
int ansl = ceil(l), ansr = floor(r);
```

---

### 复古游戏化设计
- **像素动画**：在 Canvas 上绘制 $k$ 轴，用移动的像素块表示当前计算的 $k$ 值。
- **自动演示**：AI 模拟逐步计算 $k$ 范围，并高亮最终解区间。
- **音效**：每步计算伴随 "beep" 声，成功找到解时播放胜利旋律。

---
处理用时：63.50秒
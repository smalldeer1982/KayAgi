# 题目信息

# [AHOI2018初中组] 根式化简

## 题目描述

小可可在学习“立方根”的知识时碰到这样的问题：

将下面根式化简为最简根式：

(1) $\sqrt[3]{125}$ (2) $\sqrt[3]{81}$ (3) $\sqrt[3]{52}$

这个问题对于小可可来说太简单了，他很快就算出了答案：

(1) $5$ (2) 3$\sqrt[3]{3}$ (3) $\sqrt[3]{52}$

小可可知道任意形如$\sqrt[3]{x}$ 的根式，化简后一定可以被写成形如$a\sqrt[3]{b}$的最简根式。他觉得这很有趣，就仿照出了不少题，但没一会儿就被密密麻麻的根式绕晕了，于是他向你求助：

给定 $n$ 个形如 $\sqrt[3]{x}$ 的根式，请你将它们化简为形如$a\sqrt[3]{b}$的最简形式，为了方便，你只需要输出其中的$a$ 即可。

如果你没有学过这部分数学知识，你可以认为题意是：给你$n$ 个正整数$x$，对于每一个$x$，你需要求出整数$a,b$ 使得$a^3 \times b = x$，输出最大的整数$a$ 即可。

## 说明/提示

对于100%的数据满足：$1≤n≤10000$，$1≤x≤10^{18}$。

本题共10 个测试点，编号为1~10，每个测试点额外保证如下：

测试点编号n 的范围x 的范围  
1~2 $n≤10, x≤10^6$  
3~4 $n≤10, x≤10^9$  
5~6 $n≤100, x≤10^{18}$ 且$x$ 为完全立方数  
7~8 $n≤500, x≤10^{18}$  
9~10 $n≤10000, x≤10^{18}$

## 样例 #1

### 输入

```
3
125 81 52```

### 输出

```
5
3
1```

# AI分析结果



# 分析与结论

## 唯一算法分类
**数论**

---

## 题解思路与难点
**核心问题**：找到最大的a，使得a³*b=x。等价于提取x中所有质因数的三次方组合。

### 关键数学步骤
1. **质因数分解**：分解x的所有质因数，统计每个质因数的次数。
2. **三次方提取**：将每个质因数的次数除以3，得到的商即为该质因数对a的贡献。
3. **剩余处理**：若剩余数仍为某个数的立方，则将其加入a。

**难点**：
- **大数处理**：x的范围达到1e18，需高效分解质因数。
- **立方判断**：如何快速判断剩余数是否为立方数，避免浮点误差。
- **时间复杂度**：质数筛的范围和分解次数需控制在合理范围。

**突破点**：
- 预处理≤x^(1/4)的质数（约3e4），筛除后剩余数最多含两个大质数。
- 剩余数若为立方数，则必为单个质数的立方。

---

## 题解评分（≥4星）
### 1. hongzy（5星）
- **亮点**：预处理质数到31650，筛除后二分判断剩余立方数。
- **代码结构**：清晰，预处理质数和立方表，高效处理多组数据。
- **优化**：利用四次方根范围分解质因数，时间复杂度O(n * π(x^(1/4)))。

### 2. critnos（5星）
- **亮点**：动态剪枝，每次分解后立即判断剩余立方数，减少无效计算。
- **优化**：质数筛范围精准，Miller-Rabin测试加速质数筛选，代码效率极高（166ms）。

### 3. KesdiaelKen（4星）
- **亮点**：详细推导过程，代码注释清晰，适合教学。
- **实现**：预处理质数到32000，二分开立方处理剩余数。

---

## 最优思路提炼
1. **质数预处理**：筛出所有≤31650的质数（x^(1/4)）。
2. **质因数分解**：对每个x，用预处理的质数分解，记录每质因数的次数。
3. **三次方提取**：次数//3的商作为a的因子。
4. **剩余处理**：用二分法判断剩余数是否为立方数。

**关键代码片段**：
```cpp
// 预处理质数
void prime() {
    for(int i=2; i<=31650; i++) {
        if(!p[i]) plist[++cnt] = i;
        for(int j=1; j<=cnt && i*plist[j]<=31650; j++) {
            p[i*plist[j]] = 1;
            if(i%plist[j] == 0) break;
        }
    }
}

// 处理每个x
LL ans = 1;
for(int i=1; i<=cnt && plist[i] <= x; i++) {
    int c = 0;
    while(x % plist[i] == 0) {
        c++; x /= plist[i];
        if(c == 3) { ans *= plist[i]; c = 0; }
    }
}
LL k = lower_bound(pow3+1, pow3+m+1, x) - pow3;
if(k*k*k == x) ans *= k;
```

---

## 同类题目推荐
1. **P1072 Hankson的趣味题** - 质因数分解与条件约束。
2. **P1069 细胞分裂** - 质因数次数分析与最大公约数。
3. **P2043 质因子分解** - 高精度数的质因数分解。

---

## 可视化设计
### 动画方案
1. **质因数分解**：像素方块表示质数，颜色标记当前处理的质数，分解时方块闪烁。
2. **次数统计**：每个质数下方显示次数，每满3次时触发音效，a值更新。
3. **立方判断**：剩余数以3D立方体形式展示，若匹配则爆炸特效+音效。

### 复古风格
- **8位像素UI**：质数用绿色方块，当前处理数高亮为红色。
- **音效**：分解成功时“叮”，立方匹配时“胜利”音效。
- **Canvas绘制**：网格显示质数分解过程，右侧实时显示a和剩余数。

---

## 实现代码（关键部分）
```javascript
// 伪代码：立方判断动画
function checkCube(x) {
    let low = 1, high = 1e6;
    while (low <= high) {
        let mid = (low + high) >> 1;
        let cube = mid * mid * mid;
        if (cube === x) return mid;
        else if (cube < x) low = mid + 1;
        else high = mid - 1;
    }
    return 0;
}

// 音效触发
function playSound(effect) {
    const audio = new Audio(`sfx/${effect}.wav`);
    audio.play();
}
```

---

**心得**：质数预处理和四次方根范围的巧妙选择是解题关键，避免了大数分解的复杂度。立方判断时二分法比浮点运算更可靠。

---
处理用时：77.01秒
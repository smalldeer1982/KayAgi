# 题目信息

# [NOIP 2009 提高组] Hankson 的趣味题

## 题目描述

Hanks 博士是 BT（Bio-Tech，生物技术) 领域的知名专家，他的儿子名叫 Hankson。现在，刚刚放学回家的 Hankson 正在思考一个有趣的问题。

今天在课堂上，老师讲解了如何求两个正整数 $c_1$ 和 $c_2$ 的最大公约数和最小公倍数。现在 Hankson 认为自己已经熟练地掌握了这些知识，他开始思考一个“求公约数”和“求公倍数”之类问题的“逆问题”，这个问题是这样的：已知正整数 $a_0,a_1,b_0,b_1$，设某未知正整数 $x$ 满足：

1. $x$ 和 $a_0$ 的最大公约数是 $a_1$；

2. $x$ 和 $b_0$ 的最小公倍数是 $b_1$。

Hankson 的“逆问题”就是求出满足条件的正整数 $x$。但稍加思索之后，他发现这样的 $x$ 并不唯一，甚至可能不存在。因此他转而开始考虑如何求解满足条件的 $x$ 的个数。请你帮助他编程求解这个问题。


## 说明/提示

**【样例解释】**

第一组输入数据，$x$ 可以是 $9,18,36,72,144,288$，共有 $6$ 个。

第二组输入数据，$x$ 可以是 $48,1776$，共有 $2$ 个。

**【数据范围】**

- 对于 $50\%$ 的数据，保证有 $1\leq a_0,a_1,b_0,b_1 \leq 10000$ 且 $n \leq 100$。
- 对于 $100\%$ 的数据，保证有 $1 \leq a_0,a_1,b_0,b_1 \leq 2 \times 10^9$ 且 $n≤2000$。

NOIP 2009 提高组 第二题


## 样例 #1

### 输入

```
2 
41 1 96 288 
95 1 37 1776 ```

### 输出

```
6 
2```

# AI分析结果



# [NOIP 2009 提高组] Hankson 的趣味题 - 题解分析

**唯一算法分类**：数学分析、因数枚举与质因数分解

---

## 综合分析与结论

### 核心思路与难点
1. **条件转换**：
   - 根据 `gcd(x, a0) = a1` 可得 `x` 必须是 `a1` 的倍数，且 `x/a1` 与 `a0/a1` 互质。
   - 根据 `lcm(x, b0) = b1` 可得 `x` 必须是 `b1` 的因数，且 `b1/x` 与 `b0` 互质。
2. **算法实现**：
   - **暴力优化**：枚举 `b1` 的因数（仅需检查 `1~sqrt(b1)`），验证是否满足两个条件。
   - **质因数分解**：对每个质因数的指数进行约束分析，统计合法解的乘积。

### 可视化设计思路
1. **动画演示**：
   - **因数枚举**：以网格形式展示 `b1` 的因数对（如 `(i, b1/i)`），高亮当前检查的因数，绿色表示通过条件，红色表示不通过。
   - **质因数分解**：动态展示每个质因数的指数范围，用进度条表示允许的指数区间。
2. **复古像素风格**：
   - 使用 8-bit 调色板（如深蓝、黄、红），Canvas 绘制因数网格。
   - 音效设计：检查成功时播放短促“滴”声，失败时播放低沉音效，背景播放循环的芯片音乐。

---

## 题解清单（≥4星）

### 1. zzlzk 题解（⭐️⭐️⭐️⭐️⭐️）
- **亮点**：通过推导明确 `x` 是 `a1` 倍数且为 `b1` 因数，代码简洁高效。
- **核心代码**：
  ```cpp
  for(int x=1; x*x<=b1; x++) {
      if(b1%x == 0) {
          if(x%a1 ==0 && gcd(x/a1, p)==1 && gcd(q, b1/x)==1) ans++;
          int y = b1/x;
          if(y%a1 ==0 && gcd(y/a1, p)==1 && gcd(q, b1/y)==1) ans++;
      }
  }
  ```

### 2. KesdiaelKen 题解（⭐️⭐️⭐️⭐️⭐️）
- **亮点**：数学优化，通过分解 `s = b1/a1` 和 `m = a0/a1`，减少无效枚举。
- **关键推导**：`x` 可表示为 `(s/l) * r`，其中 `r` 需满足与 `m` 互质。

### 3. Ebola 题解（⭐️⭐️⭐️⭐️）
- **亮点**：质因数分解法，对每个质数的指数进行约束分析，避免完全枚举。
- **核心逻辑**：对每个质因数的指数范围进行分类讨论，统计解的乘积。

---

## 最优思路提炼
1. **因数枚举优化**：
   - **sqrt(b1) 遍历**：仅需枚举到 `sqrt(b1)`，处理因数对 `(x, b1/x)`。
   - **条件剪枝**：检查 `x` 是否为 `a1` 的倍数，并验证互质性。
2. **质因数分解法**：
   - 分解 `a0, a1, b0, b1` 的质因数，对每个质数的指数进行独立约束分析。
   - 解的个数为各质数合法指数区间的乘积。

---

## 类似题目推荐
1. **P1029 [NOIP2001 普及组] 最大公约数和最小公倍数问题**
2. **P1414 又是毕业季II**（因数与公约数应用）
3. **P2651 添加括号III**（gcd/lcm 性质）

---

## 个人心得摘录
- **调试教训**：质因数分解时需注意未分解完的大质数（如 `b1` 剩余值可能为质数）。
- **顿悟点**：`lcm(x, b0) = b1` 隐含 `x` 必须是 `b1` 的因数，直接缩小枚举范围。

---

## 算法可视化示例（伪代码）
```javascript
// 初始化 Canvas 网格
const grid = drawGrid(b1);
for (let x = 1; x <= sqrt(b1); x++) {
    if (b1 % x !== 0) continue;
    // 高亮当前因数对 (x, b1/x)
    grid.highlight(x, 'yellow');
    grid.highlight(b1/x, 'yellow');
    
    // 检查条件
    if (checkConditions(x)) {
        grid.markGreen(x);
        playSound('success');
    } else {
        grid.markRed(x);
        playSound('fail');
    }
    // 步进延迟
    await sleep(500);
}
```

**复古效果**：采用 16x16 像素字体，网格用深灰色边框，成功块为绿色，失败块为红色，背景音乐为 8-bit 循环旋律。

---
处理用时：63.72秒
# 题目信息

# [中山市选] 生成树

## 题目描述

有一种图形叫做五角形圈。一个五角形圈的中心有1个由n个顶点和n条边组成的圈。在中心的这个n边圈的每一条边同时也是某一个五角形的一条边，一共有n个不同的五角形。这些五角形只在五角形圈的中心的圈上有公共的顶点。如图0所示是一个4-五角形圈。

![https://cdn.luogu.com.cn/upload/pic/22665.png](https://cdn.luogu.com.cn/upload/pic/22665.png)

现在给定一个n五角形圈，你的任务就是求出n五角形圈的不同生成树的数目。还记得什么是图的生成树吗？一个图的生成树是保留原图的所有顶点以及顶点的数目减去一这么多条边,从而生成的一棵树。
注意：在给定的n五角形圈中所有顶点均视为不同的顶点。

## 样例 #1

### 输入

```
1
2```

### 输出

```
40```

# AI分析结果



**唯一算法分类**  
数学/组合数学

---

**综合分析与结论**  
题目核心是求五角形圈生成树数目，所有题解均指向同一数学公式：`4n·5^{n-1} mod 2007`。关键难点在于理解生成树需破坏所有环，并通过组合分析得出需有一个五边形删两条边（其中一条必在中心n边形）。

核心算法流程：  
1. **数学推导**：每个五边形删一条边后仍有一个环，需额外删一条中心边。  
2. **快速幂**：计算5的幂次时通过位运算加速。  

可视化设计：  
- **动画方案**：像素风格展示五边形结构，高亮被删除的边。  
- **颜色标记**：红色表示被删中心边，绿色表示其他五边形删边。  
- **步进控制**：分步演示删边过程，自动播放时可调节速度。  
- **复古音效**：删边时播放8-bit音效，计算完成时播放胜利音效。  

---

**题解清单 (≥4星)**  
1. **Riguel (5星)**：清晰推导中心边删除逻辑，代码简洁。  
   ```cpp
   printf("%lld\n",n*4%mod*ksm(5,n-1)%mod);
   ```  
2. **junble19768 (5星)**：手绘示意图辅助理解，详细解释组合原理。  
   ```cpp
   ans=kp(5,n-1)*4*n%2007;
   ```  
3. **DengDuck (5星)**：代码封装快速幂，注释明确。  
   ```cpp
   LL ksm(LL x,LL y) { /*快速幂实现*/ }
   ```  

---

**最优思路与技巧**  
1. **组合分析**：强制一个五边形删两条边（中心边+4选1），其余五边形各删一条边。  
2. **快速幂优化**：通过二进制分解幂次，将计算复杂度从O(n)降至O(logn)。  

---

**同类型题与算法套路**  
- **生成树计数**：矩阵树定理（适用于任意图）或组合分析（特殊结构图）。  
- **快速幂应用**：需频繁计算大指数取模的场景（如斐波那契加速）。  

---

**推荐相似题目**  
1. **P4208 [JSOI2008]最小生成树计数**  
2. **P2144 [FJOI2007]轮状病毒**  
3. **P1226 【模板】快速幂**  

---

**个人心得摘录**  
- **调试教训**：直接打表需预计算答案，但通用解法更优（sounds_666）。  
- **顿悟点**：删中心边后剩余结构形成树的条件（Riguel）。  

---

**可视化与算法演示**  
```html
<!-- 示例：Canvas绘制五边形圈及删边动画 -->
<canvas id="demo" width="800" height="600"></canvas>
<script>
const colors = ['#FF6B6B', '#4ECDC4', '#45B7D1', '#96CEB4', '#FFEEAD'];
function drawStep(n, delEdges) {
  // 绘制n五角形圈，高亮delEdges中的被删边
}
// 自动播放删边过程
let step = 0;
setInterval(() => {
  if (step <= n) drawStep(n, calcDelEdges(step++));
}, 1000);
</script>
```  
- **像素风格**：使用16色 palette，边用2px宽线条。  
- **音效触发**：每次删边播放 `beep.wav`，计算完成播放 `fanfare.wav`。  

---

**代码实现（核心逻辑）**  
```cpp
#include<bits/stdc++.h>
using namespace std;
const int mod = 2007;

int qpow(int a, int b) {
  int res = 1;
  while (b) {
    if (b & 1) res = res * a % mod;
    a = a * a % mod;
    b >>= 1;
  }
  return res;
}

int main() {
  int T, n; cin >> T;
  while (T--) {
    cin >> n;
    cout << (4 * n % mod) * qpow(5, n-1) % mod << endl;
  }
  return 0;
}
```

---
处理用时：70.69秒
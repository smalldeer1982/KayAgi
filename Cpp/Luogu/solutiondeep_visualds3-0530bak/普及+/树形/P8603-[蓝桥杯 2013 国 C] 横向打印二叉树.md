# 题目信息

# [蓝桥杯 2013 国 C] 横向打印二叉树

## 题目背景

二叉树可以用于排序。

## 题目描述

其原理很简单：对于一个排序二叉树添加新节点时，先与根节点比较，若小则交给左子树继续处理，否则交给右子树。

当遇到空子树时，则把该节点放入那个位置。

比如，`10 8 5 7 12 4` 的输入顺序，应该建成二叉树如图 $1$ 所示。

本题目要求：根据已知的数字，建立排序二叉树，并在标准输出中横向打印该二叉树。


## 说明/提示

样例解释 1：

![](https://cdn.luogu.com.cn/upload/image_hosting/4z42ybq4.png)

时限 1 秒, 64M。蓝桥杯 2013 年第四届国赛

## 样例 #1

### 输入

```
10 8 5 7 12 4```

### 输出

```
...|-12
10-|
...|-8-|
.......|...|-7
.......|-5-|
...........|-4```

## 样例 #2

### 输入

```
10 5 20```

### 输出

```
...|-20
10-|
...|-5```

## 样例 #3

### 输入

```
5 10 20 8 4 7```

### 输出

```
.......|-20
..|-10-|
..|....|-8-|
..|........|-7
5-|
..|-4```

# AI分析结果



# 横向打印二叉树题解分析

## 算法分类
**树形结构遍历与格式化输出**

---

## 题解思路与核心难点

### 核心算法流程
1. **构建排序二叉树**：按输入顺序插入节点，根据大小关系递归或循环插入左/右子树。
2. **横向输出逻辑**：
   - **右根左递归顺序**：确保右子树在上方，根在中，左子树在下方。
   - **动态计算前导空格**：通过递归参数传递当前节点的前导空格数 `space` 或 `sum`。
   - **连接线处理**：父子节点间用 `|-` 和 `-|` 连接，并在跨行时填充 `|`。

### 解决难点
- **节点位置计算**：递归时动态维护前导空格，结合节点值的字符长度确定输出位置。
- **连接线补充**：通过行号记录和循环填充 `|`，确保父子节点间的竖线连续。

---

## 题解评分（≥4星）

### 冷却心（4.5星）
- **亮点**：中序遍历处理，字符数组存储结果，通过 `line` 数组记录行号，精确补充竖线。
- **代码可读性**：结构清晰，注释详细，适合学习递归与树处理。

### Wing_（4星）
- **亮点**：右根左递归顺序，动态维护 `sum` 参数，`work` 函数补充连接线。
- **核心代码**：
  ```cpp
  void print(int u, int sum) {
      // 递归处理右子树，计算前导空格，填充字符数组
  }
  ```

### ChampionCyan（4星）
- **亮点**：插入用循环优化，字符数组与 `line` 数组结合，递归逻辑简洁。
- **关键代码**：
  ```cpp
  void work(int p, int len) {
      // 递归处理右子树，填充字符并连接竖线
  }
  ```

---

## 最优思路提炼
1. **右根左递归顺序**：确保横向输出时右子树在上，根在中，左子树在下。
2. **动态前导空格计算**：递归参数传递 `space` 或 `sum`，结合节点字符长度动态调整。
3. **连接线处理**：父子节点行号记录，跨行填充 `|`，避免覆盖已有字符。

---

## 类似题目推荐
1. **P1040 [NOIP2003 提高组] 加分二叉树**（树的构造与遍历）
2. **P1305 新二叉树**（树的结构输出）
3. **P1185 绘制二叉树**（格式化输出树形结构）

---

## 个人心得摘录
- **冷却心**：处理连接线时需判断 `if (mp[nowL][++ind] != '|')`，避免覆盖已填充的竖线。
- **Wing_**：递归顺序影响输出结构，右子树先处理确保正确位置。

---

## 可视化设计思路
### 动画方案
1. **Canvas绘制**：
   - 每个节点显示为矩形框，内部填充数值。
   - 递归时动态高亮当前处理的子树（右子树红色，根黄色，左子树蓝色）。
2. **连接线动态绘制**：
   - 父子节点间用动态绘制的 `|-` 和 `-|` 连接，竖线随递归逐步填充。
3. **步进控制**：
   - 支持暂停/继续，单步执行观察递归深度与字符填充过程。

### 复古像素风格
- **颜色方案**：8位色调色板（红、蓝、黄、绿），节点框为绿色，连接线白色。
- **音效**：填充字符时播放短促“滴”声，完成递归时播放过关音效。

---

## 核心代码片段（冷却心题解）
```cpp
void output(LL p, LL space) {
    if (tree[p] == -1) return;
    // 处理右子树
    output(rs(p), space + Add);
    // 填充当前行字符
    for (LL i = 1; i <= space; i++) {
        if (mp[nowL][++ind] != '|') mp[nowL][ind] = '.';
    }
    // 补充连接线
    if (tree[ls(p)] != -1) {
        for (LL i = L; i >= now; i--) mp[i][ind - 1] = '|';
    }
}
```

---

## 总结
横向打印二叉树的关键在于递归顺序与动态维护输出位置，结合字符数组精确处理连接线。各题解通过不同方式实现核心逻辑，冷却心和Wing_的方案尤为值得借鉴。

---
处理用时：70.90秒
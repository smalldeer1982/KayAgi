# 题目信息

# 松江 1843 路

## 题目描述

涞坊路是一条长 $L$ 米的道路，道路上的坐标范围从 $0$ 到 $L$，路上有 $N$ 座房子，第 $i$ 座房子建在坐标为 $x_i$ 的地方，其中住了 $r_i$ 人。

松江 1843 路公交车要在这条路上建一个公交站，市政府希望让最多的人得到方便，因此希望所有的每一个的居民，从家到车站的距离的**总和**最短。

公交站应该建在哪里呢？

## 说明/提示

### 样例解释 1

当建在坐标 $40$ 的时候，所有人距离车站的距离总和为 $|20-40| \times 3+|50-40| \times 2+|70-40| \times 1=110$。

### 数据范围和约定

对于 $10\% $的数据，$1\le N \le 50$，$R_i=1$。

对于 $30\%$ 的数据，$1 \le N \le 100$，$R_i \le 10$，$1 \le L \le 1000$。

对于 $70\%$ 的数据，$1 \le N \le 1000$，$R_i \le 100$，$1 \le L \le 10^6$。

对于全部数据，$1 \le L \le 10^{10}$，$1 \le N \le 10^5$，$0 \le x_i \le L$，$1 \le r_i \le 1000$。

## 样例 #1

### 输入

```
100 3
20 3
50 2
70 1
```

### 输出

```
110
```

## 样例 #2

### 输入

```
100 2
0 1
100 10
```

### 输出

```
100
```

## 样例 #3

### 输入

```
10000000000 5
3282894320 391
4394338332 929
6932893249 181
7823822843 440
9322388365 623
```

### 输出

```
5473201404068
```

# AI分析结果



## 算法分类  
**贪心算法（加权中位数）**

---

## 题解思路与核心难点  
### 核心逻辑  
本题要求最小化 $\sum r_i \cdot |x_i - x_0|$，等价于寻找**加权中位数**。将每个房子视为 $r_i$ 个点，中位数位置即为最优解。  
1. **排序**：按坐标对房子排序。  
2. **累计人数**：找到累计人数超过总人数一半的第一个坐标点。  
3. **计算距离和**：以该坐标点为中心计算总距离。  

### 解决难点  
- **正确推导加权中位数**：需理解绝对值函数的最小化特性与中位数的关系。  
- **高效实现**：避免暴力枚举，通过排序+前缀和优化到 $O(n \log n)$。  

---

## 题解评分（≥4星）  
1. **BlueArc（5星）**  
   - 思路清晰，直接应用加权中位数理论。  
   - 代码简洁，通过排序和前缀和快速定位中位数。  
   - 优化后的代码适用于大数据范围。  

2. **MSM2004（4.5星）**  
   - 明确中位数策略，代码易读。  
   - 处理总人数奇偶性时直接取整，简化实现。  

3. **_ztyqwq（4星）**  
   - 简化解法，直接累计人数判断中位数位置。  
   - 代码紧凑，适合快速实现。  

---

## 最优思路提炼  
**加权中位数法**：  
1. 将每个房子视为 $r_i$ 个点，累计总人数。  
2. 按坐标排序后，找到第一个累计人数超过总人数一半的坐标。  
3. 该坐标即为最优解。  

**代码片段**：  
```cpp
sort(a+1, a+n+1);  // 按坐标排序
long long sum = 0, mid = (total + 1) / 2;
for (int i=1; i<=n; i++) {
    sum += a[i].r;
    if (sum >= mid) {  // 找到中位数位置
        pos = a[i].x;
        break;
    }
}
for (int i=1; i<=n; i++) 
    ans += abs(a[i].x - pos) * a[i].r;
```

---

## 同类型题与算法套路  
- **通用解法**：涉及绝对差最小化的问题均可考虑中位数或加权中位数。  
- **类似题目**：  
  1. 动态中位数（洛谷 P1168）  
  2. 货仓选址问题（洛谷 P3871）  
  3. 均分纸牌（洛谷 P1031）  

---

## 个人心得摘录  
- **说好不哭**：验证了“中位数一定在某个房子处”的猜想，避免浮点精度问题。  
- **Celebrate**：通过暴力验证最优解猜想，强调数学证明的重要性。  

---

## 可视化算法演示  
### 动画方案  
1. **像素风格界面**：  
   - 使用 8-bit 像素画风，道路显示为横向色块，房子显示为不同高度的塔楼（高度代表人数）。  
   - 当前处理坐标点高亮为红色，累计人数进度条显示在顶部。  

2. **关键步骤演示**：  
   - **排序阶段**：房子从左到右按坐标排序，伴随“嘀嘀”音效。  
   - **累计阶段**：指针从左向右移动，累计人数条增长，超过半数时触发“叮”音效并停止。  
   - **计算距离**：从选中坐标向两侧发射射线，显示距离计算过程，总和动态更新。  

3. **交互控制**：  
   - **步进控制**：允许单步执行排序和累计过程。  
   - **速度调节**：滑动条控制动画速度（0.5x~3x）。  

### 核心代码（伪代码）  
```javascript
// Canvas 绘制道路和房子
function drawRoad() {
    ctx.fillStyle = "#4A752C"; // 道路颜色
    ctx.fillRect(0, 150, canvas.width, 50);
    for (let house of houses) {
        drawHouse(house.x, house.r); // 根据坐标和人数绘制塔楼
    }
}

// 中位数搜索动画
function findMedian() {
    let sum = 0, target = totalPeople / 2;
    for (let i = 0; i < houses.length; i++) {
        sum += houses[i].r;
        highlightHouse(i); // 高亮当前房子
        updateSumBar(sum); // 更新累计进度条
        if (sum >= target) {
            playSuccessSound(); // 播放成功音效
            break;
        }
        await sleep(animationSpeed);
    }
}
```

---

## 推荐相似题目  
1. **P1168 中位数**  
   - 动态维护序列中位数。  
2. **P3871 货仓选址**  
   - 基础中位数应用，无权重版本。  
3. **P1031 均分纸牌**  
   - 利用中位数思想解决相邻传递问题。

---
处理用时：81.04秒
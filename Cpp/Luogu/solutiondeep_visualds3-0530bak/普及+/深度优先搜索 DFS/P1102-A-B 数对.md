# 题目信息

# A-B 数对

## 题目背景

出题是一件痛苦的事情！

相同的题目看多了也会有审美疲劳，于是我舍弃了大家所熟悉的 A+B Problem，改用 A-B 了哈哈！

## 题目描述

给出一串正整数数列以及一个正整数 $C$，要求计算出所有满足 $A - B = C$ 的数对的个数（不同位置的数字一样的数对算不同的数对）。

## 说明/提示

对于 $75\%$ 的数据，$1 \leq N \leq 2000$。

对于 $100\%$ 的数据，$1 \leq N \leq 2 \times 10^5$，$0 \leq a_i <2^{30}$，$1 \leq C < 2^{30}$。

2017/4/29 新添数据两组

## 样例 #1

### 输入

```
4 1
1 1 2 3
```

### 输出

```
3```

# AI分析结果



**算法分类**: 其他搜索（哈希、二分、双指针）

---

### **题解思路与算法要点**

#### **核心思路**
将A-B=C转化为A=C+B，通过不同方法高效统计符合条件的数对。关键难点在于处理**大数范围下的快速查找**与**重复元素的精确统计**。

#### **方法对比**
| 方法          | 时间复杂度 | 空间复杂度 | 实现难度 | 适用场景              |
|---------------|------------|------------|----------|---------------------|
| 哈希表(map)    | O(n logn)  | O(n)       | ⭐⭐       | 快速实现，无需排序     |
| 二分查找       | O(n logn)  | O(1)       | ⭐⭐       | 有序数组的精确查找    |
| 双指针         | O(n)       | O(1)       | ⭐⭐⭐      | 排序后的高效线性扫描  |

---

### **题解评分（≥4星）**

1. **OsvaldoAsensioLopez（哈希表）**  
   ⭐⭐⭐⭐  
   **亮点**: 将问题转化为哈希查找，代码简洁（10行核心逻辑），直接利用STL map统计频次。  
   **缺点**: map查询有O(logn)常数，大数据可能卡时间。

2. **樱花飞舞（二分查找）**  
   ⭐⭐⭐⭐  
   **亮点**: 清晰展示STL二分函数用法，通过upper_bound-lower_bound精确统计区间长度。  
   **优化点**: 预处理排序后，每个元素独立处理，避免哈希冲突。

3. **jins3599（双指针）**  
   ⭐⭐⭐⭐⭐  
   **亮点**: O(n)时间复杂度最优，维护两个右指针动态计算区间长度。  
   **难点**: 需严格证明指针单调性，处理连续重复值时的边界条件。

---

### **最优思路提炼**
1. **哈希映射**:  
   ```cpp
   map<LL,LL> m;
   for(i) m[a[i]]++;          // 频次统计
   for(i) ans += m[a[i]-C];   // 直接查表
   ```
2. **二分边界**:  
   ```cpp
   sort(a+1, a+n+1);
   ans += upper_bound(a+C) - lower_bound(a+C); // 区间长度即频次
   ```
3. **双指针单调性**:  
   ```cpp
   for(l=1; l<=n; l++){
       while(r1<=n && a[r1]-a[l]<=C) r1++;
       while(r2<=n && a[r2]-a[l]<C)  r2++;
       ans += r1 - r2;  // 区间[r2, r1-1]均满足a[r]-a[l]==C
   }
   ```

---

### **同类型题推荐**
1. **P1102** A-B数对（本题）
2. **P1678** 烦恼的高考志愿（二分边界应用）
3. **P1147** 连续自然数和（双指针区间和）

---

### **可视化设计（双指针法）**
**动画效果**：  
- 用**绿色块**标记当前左指针`l`，**红色箭头**动态扫描右指针`r1/r2`。  
- 当`a[r1]-a[l] == C`时，**黄色高亮**区间`[r2, r1-1]`，并弹出+1音效。  
- 下方状态栏实时显示公式`a[r]-a[l]`的值与指针位置。

**复古像素风**：  
- 节点用16x16像素块表示，已访问节点变为灰色，当前区间闪烁蓝光。  
- 背景音乐使用8-bit芯片音效，搜索命中时播放《超级玛丽》金币声。

---

### **代码片段（双指针法）**
```cpp
sort(a+1, a+n+1);
int r1=1, r2=1;
long long ans=0;
for(int l=1; l<=n; l++){
    // 找第一个> C的右边界r1
    while(r1<=n && a[r1]-a[l] <= C) r1++;
    // 找第一个>=C的右边界r2
    while(r2<=n && a[r2]-a[l] <  C) r2++;
    if(a[r2]-a[l]==C && a[r1-1]-a[l]==C)
        ans += r1 - r2;
}
```

---

### **总结**
哈希表适合快速实现，二分法稳定易调试，双指针效率最高但需细致验证。**排序+双指针**是本题最优解，其O(n)时间复杂度在处理2e5数据时优势显著，配合像素动画可直观展现指针单调移动的特性。

---
处理用时：69.22秒
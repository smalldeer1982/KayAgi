# 题目信息

# [NOIP 2009 普及组] 细胞分裂

## 题目描述

Hanks 博士是 BT（Bio-Tech，生物技术）领域的知名专家。现在，他正在为一个细胞实验做准备工作：培养细胞样本。

Hanks 博士手里现在有 $N$ 种细胞，编号从 $1 \sim N$，一个第 $i$ 种细胞经过 $1$ 秒钟可以分裂为 $S_i$ 个同种细胞（$S_i$ 为正整数）。现在他需要选取某种细胞的一个放进培养皿，让其自由分裂，进行培养。一段时间以后，再把培养皿中的所有细胞平均分入 $M$ 个试管，形成 $M$ 份样本，用于实验。Hanks 博士的试管数 $M$ 很大，普通的计算机的基本数据类型无法存储这样大的 $M$ 值，但万幸的是，$M$ 总可以表示为 $m_1$ 的 $m_2$ 次方，即 $M = m_1^{m_2}$，其中 $m_1,m_2$ 均为基本数据类型可以存储的正整数。

注意，整个实验过程中不允许分割单个细胞，比如某个时刻若培养皿中有 $4$ 个细胞，Hanks 博士可以把它们分入 $2$ 个试管，每试管内 $2$ 个，然后开始实验。但如果培养皿中有 $5$ 个细胞，博士就无法将它们均分入 $2$ 个试管。此时，博士就只能等待一段时间，让细胞们继续分裂，使得其个数可以均分，或是干脆改换另一种细胞培养。

为了能让实验尽早开始，Hanks 博士在选定一种细胞开始培养后，总是在得到的细胞“刚好可以平均分入 $M$ 个试管”时停止细胞培养并开始实验。现在博士希望知道，选择哪种细胞培养，可以使得实验的开始时间最早。


## 说明/提示

【输入输出样例 \#1 说明】

经过 $1$ 秒钟，细胞分裂成 $3$ 个，经过 $2$ 秒钟，细胞分裂成 $9$个，……，可以看出无论怎么分裂，细胞的个数都是奇数，因此永远不能分入 $2$ 个试管。

【输入输出样例 \#2 说明】

第 $1$ 种细胞最早在 $3$ 秒后才能均分入 $24$ 个试管，而第 $2$ 种最早在 $2$ 秒后就可以均分（每试管 $144 / {24}^1 = 6$ 个）。故实验最早可以在 $2$ 秒后开始。

【数据范围】

对于 $50 \%$ 的数据，有 $m_1^{m_2} \le 30000$。

对于所有的数据，有 $1 \le N \le 10000$，$1 \le m_1 \le 30000$，$1 \le m_2 \le 10000$，$1 \le S_i \le 2 \times {10}^9$。


NOIP 2009 普及组 第三题


## 样例 #1

### 输入

```
1 
2 1 
3
```

### 输出

```
-1
```

## 样例 #2

### 输入

```
2
24 1
30 12
```

### 输出

```
2
```

# AI分析结果



**唯一算法分类**：质因数分解

---

### **题解思路与解决难点**

**核心思路**：  
将问题转化为质因数分解问题。对于每个细胞分裂次数 $S_i$，计算其质因数分解后是否能覆盖 $M = m_1^{m_2}$ 的所有质因数，并计算每个质因数的次数是否足够。

**算法流程**：  
1. **分解 $m_1$ 的质因数**，得到质因数集合 $P$，每个质因数的次数为 $k_i$。  
2. **计算 $M$ 的质因数次数**：$k_i' = k_i \times m_2$。  
3. **遍历每个细胞 $S_i$**：  
   - 分解 $S_i$ 的质因数。  
   - 若 $S_i$ 不包含 $P$ 中某个质因数，跳过该细胞。  
   - 否则，计算每个质因数在 $S_i$ 中的次数 $x_j$，求解最小 $t$ 使得 $x_j \times t \ge k_i'$。取所有 $t$ 的最大值作为该细胞的解。  
4. 最终取所有可行解的最小值。

**解决难点**：  
- **质因数分解的高效实现**：需快速分解大数的质因数。  
- **边界条件处理**：如 $m_1 = 1$ 的特殊情况。  
- **数学推导**：通过质因数次数关系计算最小时间 $t$，需正确处理向上取整。

---

### **题解评分（≥4星）**

1. **暗ざ之殇（5星）**  
   - **亮点**：递归分解 GCD 的思路独特，数学推导严谨，代码高效。  
   - **关键代码**：通过不断分解最大公约数，递归处理质因数次数。  
   - **心得**：“将问题转化为递归分解 GCD，舍弃互质部分简化计算。”

2. **刘心远（4星）**  
   - **亮点**：直接质因数分解，代码简洁易懂，适合快速实现。  
   - **关键代码**：预处理质数表，分解后比较次数。  
   - **心得**：“分解质因数后直接比较次数，无需复杂推导。”

3. **Eason_lyx（4星）**  
   - **亮点**：使用 `map` 存储质因数次数，灵活处理分解过程。  
   - **关键代码**：动态分解质因数，避免预处理质数表。  

---

### **最优思路与技巧**

**关键技巧**：  
1. **质因数分解预处理**：预处理质数表（如埃氏筛）加速分解。  
2. **次数关系计算**：对每个质因数 $p$，计算最小 $t = \lceil \frac{k_i'}{x_j} \rceil$。  
3. **边界处理**：特判 $m_1 = 1$ 时直接返回 $0$。

**代码片段（刘心远思路）**：  
```cpp
void decompose(int m1, vector<int>& primes, vector<int>& exponents) {
    for (int i = 2; i * i <= m1; ++i) {
        if (m1 % i == 0) {
            int cnt = 0;
            while (m1 % i == 0) {
                cnt++;
                m1 /= i;
            }
            primes.push_back(i);
            exponents.push_back(cnt);
        }
    }
    if (m1 > 1) {
        primes.push_back(m1);
        exponents.push_back(1);
    }
}

int calculate_time(int s, vector<int>& primes, vector<int>& exponents) {
    int max_t = 0;
    for (int i = 0; i < primes.size(); ++i) {
        int cnt = 0;
        while (s % primes[i] == 0) {
            cnt++;
            s /= primes[i];
        }
        if (cnt == 0) return -1;  // 缺少质因数
        int t = (exponents[i] + cnt - 1) / cnt;  // 向上取整
        max_t = max(max_t, t);
    }
    return max_t;
}
```

---

### **相似题目推荐**

1. **P1072 [NOIP2009 提高组] Hankson 的趣味题**  
   - 同样涉及质因数分解与次数关系比较。  
2. **P1061 [NOIP2006 普及组] 明明的随机数**  
   - 质因数分解的简单应用。  
3. **P1029 [NOIP2001 普及组] 最大公约数和最小公倍数问题**  
   - 结合 GCD 和 LCM 的质因数分解问题。

---

### **可视化设计**

**像素化算法演示（Canvas 实现）**：  
1. **质因数分解动画**：  
   - 展示 $m_1$ 分解为质因数方块（不同颜色表示不同质因数），次数以数字显示。  
   - 细胞 $S_i$ 分解时，高亮匹配的质因数，若缺失则触发红色闪烁。  
2. **次数比较**：  
   - 用动态柱状图对比 $k_i'$ 和 $x_j \times t$，柱高表示次数，达标时变绿。  
3. **音效与动画**：  
   - **分解成功**：8-bit 上升音调。  
   - **缺失质因数**：短促“错误”音效。  
   - **找到最小 $t$**：播放胜利音乐。  

**交互控制**：  
- **步进执行**：按空格键逐步分解质因数。  
- **自动播放**：AI 自动选择最优细胞，速度可调。  

---

### **个人心得摘录**

- **暗ざ之殇**：“递归分解 GCD 的思路源于数学直觉，通过不断舍弃互质部分简化问题。”  
- **刘心远**：“预处理质数表虽增加代码量，但大幅提升分解效率，适合大范围数据。”  
- **调试教训**：“未特判 $m_1 = 1$ 导致 WA，需注意边界条件。”  

--- 

通过质因数分解与次数比较，该问题得以高效解决，结合数学推导与代码优化，是典型数论应用题。

---
处理用时：78.56秒
# 题目信息

# [NOIP 2012 提高组] 同余方程

## 题目描述

求关于 $ x$ 的同余方程 $ a x \equiv 1 \pmod {b}$ 的最小正整数解。


## 说明/提示

### 数据规模与约定

- 对于 $40\%$ 的数据，$2 ≤b≤ 1,000$；
- 对于 $60\%$ 的数据，$2 ≤b≤ 50,000,000$；
- 对于 $100\%$ 的数据，$2 ≤a, b≤ 2,000,000,000$。



## 样例 #1

### 输入

```
3 10```

### 输出

```
7```

# AI分析结果



# 算法分类  
**扩展欧几里得算法**

---

## 综合分析与结论  
### 核心思路与难点对比  
题目要求解形如 $ax \equiv 1 \pmod{b}$ 的同余方程，所有题解的核心思路可归纳为：

1. **问题转化**  
   将同余方程转化为线性方程 $ax + by = 1$，需保证 $\gcd(a,b) = 1$。  
   **关键证明**：裴蜀定理保证方程有解当且仅当 $a,b$ 互质。

2. **扩展欧几里得算法（exgcd）**  
   - 递归求解 $bx' + (a \bmod b)y' = 1$，回溯时通过递推公式 $x = y', y = x' - \lfloor a/b \rfloor y'$ 得到解。  
   - **难点**：理解递归参数变化与解的传递逻辑。  
   - **优化**：使用全局变量或引用传递避免栈空间浪费。

3. **解的调整**  
   通过模运算将解调整为最小正整数：$x = (x \% b + b) \% b$。

### 题解方法对比  
| 方法                  | 时间复杂度 | 适用场景           | 优势/局限                          |
|-----------------------|------------|--------------------|-----------------------------------|
| 扩展欧几里得（exgcd） | $O(\log n)$| 通用               | 最优解，高效且代码简洁            |
| 欧拉定理+快速幂       | $O(\sqrt n)$ | 仅限互质情形       | 需要分解质因数，效率略低          |
| 暴力枚举              | $O(n)$     | 小数据             | 仅适用于部分分，无法通过大数据测试 |

---

## 题解评分（≥4星）  
### 1. 学委（5星）  
**亮点**：  
- 完整的数学推导与递归过程解释  
- 代码含负数处理逻辑，可读性强  
- 附加逆元应用场景说明  

### 2. HasNoName（4.5星）  
**亮点**：  
- 精简的代码实现（仅30行）  
- 使用引用参数传递解，避免全局变量  
- 清晰的递归边界条件注释  

### 3. ShirasuAzusaSaikou（4星）  
**亮点**：  
- 结合欧拉定理的替代解法  
- 详细说明欧拉函数计算与快速幂逻辑  
- 提供非标准解法的思路拓展  

---

## 最优思路与技巧提炼  
### 关键步骤  
1. **递归框架**  
   ```cpp
   void exgcd(int a, int b, int &x, int &y) {
       if (b == 0) { x = 1; y = 0; return; }
       exgcd(b, a % b, y, x);
       y -= a / b * x;
   }
   ```
   **核心逻辑**：递归交换参数并传递解，回溯时修正系数。

2. **解的调整**  
   ```cpp
   x = (x % b + b) % b;  // 确保最小正数解
   ```

### 核心代码实现  
```cpp
#include <iostream>
using namespace std;

void exgcd(int a, int b, int &x, int &y) {
    if (b == 0) { x = 1; y = 0; return; }
    exgcd(b, a % b, y, x);
    y -= a / b * x;
}

int main() {
    int a, b, x, y;
    cin >> a >> b;
    exgcd(a, b, x, y);
    x = (x % b + b) % b;
    cout << x;
    return 0;
}
```

---

## 类似题目推荐  
1. **P1516 青蛙的约会**（扩展欧几里得解线性同余方程）  
2. **P3811 乘法逆元**（逆元批量计算）  
3. **P5656 二元一次不定方程**（扩展解集与通解计算）

---

## 可视化与算法演示  
### 动画设计  
1. **递归过程可视化**  
   - **网格动态绘制**：展示每一步递归的 `(a, b)` 参数变化。  
   - **高亮当前操作**：用红色框标记当前层递归的参数。  
   - **回溯连线**：用箭头连接父层与子层的解传递路径。

2. **像素风格交互**  
   - **8位音效**：递归时播放"beep"声，回溯时音调升高。  
   - **Canvas绘制**：用像素方块表示方程系数，递归时方块缩小。  
   - **自动演示模式**：按空格键逐步执行递归与回溯。

### 示例代码片段（JS Canvas）  
```javascript
// 递归步骤绘制（伪代码）
function drawStep(a, b, depth) {
    ctx.fillStyle = "#8B0000"; // 暗红色背景
    ctx.fillRect(depth * 50, 0, 40, 40);
    ctx.fillStyle = "#FFFFFF";
    ctx.fillText(`${a},${b}`, depth * 50 + 5, 20);
}
```

---

## 个人心得摘录  
> **学委**：  
> “调试时发现递归边界处理不当会导致解溢出，最终通过全局变量修正。”  
> **启示**：递归边界条件需严格验证。  

> **ShirasuAzusaSaikou**：  
> “欧拉定理法在分解质因数时卡常，改用试除法优化后通过。”  
> **启示**：数论题需注意算法常数优化。

---
处理用时：60.84秒
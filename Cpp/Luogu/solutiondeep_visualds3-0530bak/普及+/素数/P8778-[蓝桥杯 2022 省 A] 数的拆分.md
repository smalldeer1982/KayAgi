# 题目信息

# [蓝桥杯 2022 省 A] 数的拆分

## 题目描述

给定 $T$ 个正整数 $a_{i}$，分别问每个 $a_{i}$ 能否表示为 $x_{1}^{y_{1}} \cdot x_{2}^{y_{2}}$ 的形式，其中 $x_{1}, x_{2}$ 为正整数，$y_{1}, y_{2}$ 为大于等于 $2$ 的正整数。

## 说明/提示

**【样例说明】**

第 $4,5,7$ 个数分别可以表示为:

$$
\begin{aligned}
&a_{4}=2^{2} \times 1^{2} ; \\
&a_{5}=2^{3} \times 1^{2} ; \\
&a_{7}=2^{3} \times 3^{2} 。
\end{aligned}
$$

**【评测用例规模与约定】**

对于 $10 \%$ 的评测用例，$1 \leq T \leq 200, a_{i} \leq 10^{9}$;

对于 $30 \%$ 的评测用例，$1 \leq T \leq 300, a_{i} \leq 10^{18}$;

对于 $60 \%$ 的评测用例，$1 \leq T \leq 10000, a_{i} \leq 10^{18}$;

对于所有评测用例，$1 \leq T \leq 100000,1 \leq a_{i} \leq 10^{18}$ 。 

蓝桥杯 2022 省赛 A 组 I 题。

## 样例 #1

### 输入

```
7
2
6
12
4
8
24
72```

### 输出

```
no
no
no
yes
yes
no
yes```

# AI分析结果



---

## 算法分类
**数论、质因数分解**

---

## 题解思路、算法要点与解决难点

### 核心思路
所有题解的核心思路是：将数分解质因数后，必须满足两个条件：
1. **所有质因数的指数 ≥2**
2. **剩余部分能表示为平方数或立方数**

### 算法流程
1. **预处理质数**：筛出 4000 以内的质数（因 4000^5 ≈ 1e18）
2. **质因数分解**：用预处理的质数分解给定的数
3. **指数检查**：若某质因数的指数为 1，直接返回无解
4. **剩余部分检查**：分解后的剩余部分必须是平方数或立方数

### 解决难点
- **大数分解**：预处理小质数分解后，剩余部分最多包含一个 >4000 的质数，且其指数只能为 2/3/4
- **精度问题**：计算平方根/立方根时，需手动检查相邻整数（如 `y = sqrt(x) → 检查 y-1, y, y+1`）

---

## 题解评分 (≥4星)

### 1. Lord_Sky2048（4.5星）
- **亮点**：代码简洁，预处理质数到 4000，高效判断剩余部分
- **关键代码**：
```cpp
bool check(ll x) {
    ll y = pow(x, 0.5);
    if(y * y == x || (y + 1) * (y + 1) == x) return true;
    y = pow(x, 1.0 / 3);
    return y * y * y == x || (y + 1) * (y + 1) * (y + 1) == x;
}
```

### 2. BqtMtsZDnlpsT（4星）
- **亮点**：严谨的数学证明，提出「万能构造数 2 和 3」的核心引理
- **个人心得**：  
  *“考虑枚举 x₁,y₁ 的时间复杂度，发现可优化为 O(Tπ(⁵√n))”*

### 3. 王熙文（4星）
- **亮点**：DFS 构造平方/立方组合，适合理解分治思想
- **关键代码**：
```cpp
void dfs(int now, int nowx, bool op) {
    if(flag) return;
    // 构造平方或立方部分
}
```

---

## 最优思路或技巧提炼

### 核心技巧
1. **质数预处理**：筛出 4000 内质数，分解后剩余部分最多含 1 个大质数
2. **平方/立方数判断**：检查 `y = floor(sqrt(x))` 附近的三个整数
3. **指数分解定理**：所有 ≥2 的整数均可表示为 `2a + 3b`

### 代码优化
- **避免浮点误差**：用整数运算替代 `pow()`，如 `y * y == x`
- **快速筛法**：埃氏筛预处理质数，时间复杂度 O(n log log n)

---

## 同类型题与算法套路

### 相似题目
- **P2424 约数和**：质因数分解求约数和
- **P1069 细胞分裂**：分解质因数后求最小指数倍数
- **P1072 Hankson的趣味题**：质因数分解与条件组合

---

## 推荐相似题目
1. [P1029 最大公约数和最小公倍数问题](https://www.luogu.com.cn/problem/P1029)
2. [P1069 细胞分裂](https://www.luogu.com.cn/problem/P1069)
3. [P1593 因子和](https://www.luogu.com.cn/problem/P1593)

---

## 可视化与算法演示

### 动画设计
1. **质因数分解过程**：
   - **高亮当前质数**（红色方块）
   - **指数计数器**：显示每个质数的分解次数
   - **剩余数值**：实时更新剩余部分的数值

2. **平方/立方检查**：
   - **3D方块堆叠**：用立方体堆积表示立方数，平面方格表示平方数
   - **错误提示**：若剩余部分无法构成方块，播放爆炸动画

### 复古像素风格
- **8位色板**：质数用绿色像素块，剩余部分用蓝色渐变
- **音效设计**：
  - 分解成功：8-bit 上升音阶
  - 发现指数1：短促警报声
  - 最终成功：经典 FC 过关音乐

---

## 关键代码片段（带注释）

```cpp
// 预处理4000以内质数
void init(int n) {
    for(int i=2; i<=n; i++) if(!not_prime[i]) {
        prime[++tot] = i;
        for(int j=i+i; j<=n; j+=i) not_prime[j] = 1;
    }
}

// 主判断逻辑
bool check(ll x) {
    ll y = sqrt(x);
    if(y*y == x || (y+1)*(y+1)==x) return true;
    y = cbrt(x);
    return y*y*y==x || (y+1)*(y+1)*(y+1)==x || (y+2)*(y+2)*(y+2)==x;
}

// 分解质因数并检查指数
for(int i=1; i<=tot; i++) if(x % prime[i]==0) {
    int cnt = 0;
    while(x % prime[i] == 0) cnt++, x /= prime[i];
    if(cnt == 1) return puts("no");
}
puts(check(x) ? "yes" : "no");
```

---
处理用时：70.77秒
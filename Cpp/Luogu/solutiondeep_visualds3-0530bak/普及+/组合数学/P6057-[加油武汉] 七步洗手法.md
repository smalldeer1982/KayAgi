# 题目信息

# [加油武汉] 七步洗手法

## 题目背景

现在正处于疫情防控的关键时期，大家要经常洗手，防止接触感染。

[正确的洗手方法](https://dxy.com/column/4473)

## 题目描述

给定一张含有 $n$ 个点的无向完全图，其中 $m$ 条边是白边，其余是黑边。

现在需要你求出同色的三元环（或者说，三角形）的个数。

## 说明/提示

 - 对于 $20\%$ 的数据，满足 $n \leq 200$；
 - 对于 $50\%$ 的数据，满足 $n \leq 2000$；
 - 对于 $100\%$ 的数据，满足 $1 \leq n \leq 10^5,1 \leq m \leq 3\times 10^5$。

## 样例 #1

### 输入

```
5 3
1 5
2 5
3 5```

### 输出

```
4```

# AI分析结果



### 算法分类
**补集思想 + 组合数学**

---

### 综合分析与结论
**核心思路**：通过补集思想，将问题转化为计算总三元环数目与异色三元环数目之差。  
**关键公式**：  
- 总三元环数：$\binom{n}{3} = \frac{n(n-1)(n-2)}{6}$  
- 异色角数：$\sum_{i=1}^n \text{deg}_w(i) \cdot (n-1-\text{deg}_w(i))$  
- 异色三元环数：$\frac{\text{异色角数}}{2}$  

**解决难点**：通过统计每个点的白边度数（`deg_w[i]`），利用白边与黑边的数量乘积计算异色角数，避免暴力枚举三元组。  

---

### 题解评分（≥4星）
1. **未见堇开（5星）**  
   - **亮点**：思路清晰，公式推导严谨，代码简洁高效（时间复杂度 $O(n + m)$）。  
   - **核心代码**：  
     ```cpp
     for(reg int i=1;i<=n;i++)
         ans += 1ll * deg[i] * (n-1 - deg[i]);
     printf("%lld", 1ll*n*(n-1)*(n-2)/6 - (ans>>1));
     ```

2. **Star_Wind（4星）**  
   - **亮点**：代码简洁，强调 `long long` 的重要性，验证补集思路。  
   - **核心代码**：  
     ```cpp
     for(register int i=1;i<=n;i++)
         sum += (v[i].size() * (n-v[i].size()-1));
     cout << (ll)n*(n-1)*(n-2)/6 - sum/2;
     ```

3. **Fairicle（4星）**  
   - **亮点**：公式直接推导，代码片段简洁，突出数学逻辑。  
   - **核心公式**：  
     ```cpp
     ans = C(n,3) - (sum(deg_w[i] * (n-1-deg_w[i])) / 2);
     ```

---

### 最优思路提炼
**关键技巧**：  
1. **补集转化**：直接计算同色三元环困难，转而求异色三元环数目。  
2. **异色角统计**：每个点的异色角数为白边数乘以黑边数，总和除以2即为异色三元环数。  
3. **数学优化**：避免枚举三元组，时间复杂度从 $O(n^3)$ 降至 $O(n + m)$。  

---

### 类似题目推荐
1. **P1989 无向图三元环计数**  
   - **相似点**：三元环计数问题，需优化时间复杂度。  
2. **CF985E Pencils and Boxes**  
   - **相似点**：补集思想与组合数学结合。  
3. **AT ABC202F Integer Convex Hull**  
   - **相似点**：几何问题中的补集转化与组合计算。  

---

### 个人心得摘录
- **Skyjoy**：强调 `long long` 的重要性，指出数据范围大时易溢出。  
- **一叶知秋**：调试时发现多减的三元环需修正，体现对补集思想的深入理解。  

---

### 可视化与算法演示
**动画设计**：  
1. **像素风格**：用8位色块表示节点，白边为白色，黑边为黑色。  
2. **核心步骤**：  
   - **步骤1**：展示完全图，高亮所有三元环（总数为 $\binom{n}{3}$）。  
   - **步骤2**：逐个节点统计白边数（`deg_w[i]`），计算异色角数（红框标记当前节点）。  
   - **步骤3**：异色角数总和除以2，显示异色三元环数目。  
   - **步骤4**：最终结果 = 总三元环数 - 异色数（绿色闪烁效果）。  

**交互功能**：  
- **步进控制**：允许单步查看每个节点的 `deg_w[i]` 计算。  
- **音效**：统计异色角时播放“点击”音效，最终结果时播放胜利音效。  

---

### 代码实现（未见堇开版）
```cpp
#include<cstdio>
#define MAXN 100001
typedef long long ll;
int deg[MAXN], n, m;
int main() {
    scanf("%d %d", &n, &m);
    for (int i=1, u, v; i<=m; ++i) {
        scanf("%d %d", &u, &v);
        deg[u]++, deg[v]++;
    }
    ll ans = 0;
    for (int i=1; i<=n; ++i)
        ans += (ll)deg[i] * (n - 1 - deg[i]);
    printf("%lld", (ll)n*(n-1)*(n-2)/6 - ans/2);
    return 0;
}
```

---
处理用时：99.72秒
# 题目信息

# [AHOI2018初中组] 根式化简

## 题目描述

小可可在学习“立方根”的知识时碰到这样的问题：

将下面根式化简为最简根式：

(1) $\sqrt[3]{125}$ (2) $\sqrt[3]{81}$ (3) $\sqrt[3]{52}$

这个问题对于小可可来说太简单了，他很快就算出了答案：

(1) $5$ (2) 3$\sqrt[3]{3}$ (3) $\sqrt[3]{52}$

小可可知道任意形如$\sqrt[3]{x}$ 的根式，化简后一定可以被写成形如$a\sqrt[3]{b}$的最简根式。他觉得这很有趣，就仿照出了不少题，但没一会儿就被密密麻麻的根式绕晕了，于是他向你求助：

给定 $n$ 个形如 $\sqrt[3]{x}$ 的根式，请你将它们化简为形如$a\sqrt[3]{b}$的最简形式，为了方便，你只需要输出其中的$a$ 即可。

如果你没有学过这部分数学知识，你可以认为题意是：给你$n$ 个正整数$x$，对于每一个$x$，你需要求出整数$a,b$ 使得$a^3 \times b = x$，输出最大的整数$a$ 即可。

## 说明/提示

对于100%的数据满足：$1≤n≤10000$，$1≤x≤10^{18}$。

本题共10 个测试点，编号为1~10，每个测试点额外保证如下：

测试点编号n 的范围x 的范围  
1~2 $n≤10, x≤10^6$  
3~4 $n≤10, x≤10^9$  
5~6 $n≤100, x≤10^{18}$ 且$x$ 为完全立方数  
7~8 $n≤500, x≤10^{18}$  
9~10 $n≤10000, x≤10^{18}$

## 样例 #1

### 输入

```
3
125 81 52```

### 输出

```
5
3
1```

# AI分析结果



### 唯一算法分类
数论 + 二分

---

### 综合分析与结论
#### 核心算法流程
1. **预处理素数**：计算 x^(1/4) 范围内的素数（约 31650 以内）
2. **因子分解**：将每个 x 分解出该范围内的素数因子，每积累3个相同因子就累乘到答案 a
3. **立方数检测**：将剩余数值用二分法判断是否为立方数，若成立则再累乘一次立方根

#### 解决难点
- **大数处理**：通过限制素数范围到 x^(1/4)，确保分解操作次数不超过 3,500 次
- **立方检测优化**：预处理 1e6 以内的立方表（因 1e6^3=1e18），用二分代替浮点运算
- **时间复杂度**：单次处理时间复杂度 O(3500 + logx)，满足 1e4 次查询

#### 可视化设计思路
1. **分解过程动画**：以 8 位像素风格展示 x 被素因子分解过程
   - 红色方块表示当前处理的素数因子
   - 绿色数字展示当前因子计数（每积累 3 次触发黄色闪光特效）
2. **立方检测阶段**：显示剩余数值在立方表中的二分过程
   - 蓝色指针表示二分区间左右端点
   - 紫色高亮显示最终找到的立方根候选值
3. **音效反馈**：成功分解时播放 8-bit 上升音效，立方检测失败时播放短促警示音

---

### 题解清单 (≥4星)
1. hongzy（5⭐）
   - 亮点：严谨的数学证明 + 立方表预处理
   - 关键代码：素数筛与立方检测的完美结合
2. KesdiaelKen（4⭐）
   - 亮点：多数据范围分治思路清晰
   - 特别贡献：详细推导过程帮助理解筛法原理
3. ziiidan（4⭐）
   - 亮点：完整的数学证明框架
   - 代码特色：线性筛与 lower_bound 的简洁实现

---

### 核心代码实现
#### 预处理素数 + 立方表
```cpp
const int MAX_PRIME = 31650;
int primes[4000], cnt;

void sieve() {
    bool is_prime[MAX_PRIME+10] = {0};
    for(int i=2; i<=MAX_PRIME; i++) {
        if(!is_prime[i]) {
            primes[++cnt] = i;
            for(int j=i*i; j<=MAX_PRIME; j+=i)
                is_prime[j] = true;
        }
    }
}

LL cube_table[1000001];
void init_cubes() {
    for(LL i=1; i<=1e6; i++)
        cube_table[i] = i*i*i;
}
```

#### 主处理逻辑
```cpp
LL solve(LL x) {
    LL a = 1;
    // 分解小素数因子
    for(int i=1; i<=cnt && primes[i]<=x; i++) {
        int count = 0;
        while(x % primes[i] == 0) {
            count++;
            x /= primes[i];
            if(count == 3) {
                a *= primes[i];
                count = 0;
            }
        }
    }
    
    // 检测剩余是否为立方数
    LL k = lower_bound(cube_table+1, cube_table+1000001, x) - cube_table;
    if(k <= 1e6 && cube_table[k] == x) 
        a *= k;
    
    return a;
}
```

---

### 同类型题目推荐
1. P1069 细胞分裂（质因数分解应用）
2. P1072 Hankson的趣味题（数论综合）
3. P2424 约数和（数论分块）

---

### 复古像素化动画设计
1. **视觉元素**：
   - 素数分解阶段：使用 16x16 像素块表示当前处理的素数
   - 计数器显示：右下角 8-bit 风格数字显示当前因子计数
   - 立方检测阶段：显示 1e6 个立方数的网格瀑布流
2. **音效方案**：
   - 每次成功分解：播放类似《超级马里奥》金币音效
   - 立方检测成功：播放《塞尔达传说》解谜成功音效
3. **自动演示模式**：
   - 按空格键切换手动/自动模式
   - 自动模式下算法以每秒 10 步速度执行，可调节

---

通过将数论分解与游戏化演示结合，学习者可直观理解因子积累与立方检测的关键步骤，8-bit 风格元素则增添学习趣味性。

---
处理用时：63.72秒
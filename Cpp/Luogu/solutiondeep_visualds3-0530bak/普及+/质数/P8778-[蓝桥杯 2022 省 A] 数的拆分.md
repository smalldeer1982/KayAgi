# 题目信息

# [蓝桥杯 2022 省 A] 数的拆分

## 题目描述

给定 $T$ 个正整数 $a_{i}$，分别问每个 $a_{i}$ 能否表示为 $x_{1}^{y_{1}} \cdot x_{2}^{y_{2}}$ 的形式，其中 $x_{1}, x_{2}$ 为正整数，$y_{1}, y_{2}$ 为大于等于 $2$ 的正整数。

## 说明/提示

**【样例说明】**

第 $4,5,7$ 个数分别可以表示为:

$$
\begin{aligned}
&a_{4}=2^{2} \times 1^{2} ; \\
&a_{5}=2^{3} \times 1^{2} ; \\
&a_{7}=2^{3} \times 3^{2} 。
\end{aligned}
$$

**【评测用例规模与约定】**

对于 $10 \%$ 的评测用例，$1 \leq T \leq 200, a_{i} \leq 10^{9}$;

对于 $30 \%$ 的评测用例，$1 \leq T \leq 300, a_{i} \leq 10^{18}$;

对于 $60 \%$ 的评测用例，$1 \leq T \leq 10000, a_{i} \leq 10^{18}$;

对于所有评测用例，$1 \leq T \leq 100000,1 \leq a_{i} \leq 10^{18}$ 。 

蓝桥杯 2022 省赛 A 组 I 题。

## 样例 #1

### 输入

```
7
2
6
12
4
8
24
72```

### 输出

```
no
no
no
yes
yes
no
yes```

# AI分析结果



### 算法分类
**数论**

---

### 题解思路与算法要点

#### 核心逻辑
所有题解均基于以下数学结论：  
**当且仅当**正整数 $a$ 的质因数分解中**所有指数 $\geq 2$，且剩余部分可表示为平方或立方数时**，满足 $a = x_1^{y_1} \cdot x_2^{y_2}$ 的形式。具体实现要点：  
1. **预处理质数**：筛出 $\sqrt[5]{10^{18}} \approx 4000$ 以内的质数，用于快速分解质因数  
2. **分解质因数**：用预处理的质数试除，检查指数是否出现 1  
3. **剩余部分验证**：最终未被分解的部分必须是完全平方或立方数  

#### 解决难点
- **高效分解大数**：利用 $\min(x_1,x_2) \leq \sqrt[5]{a}$ 的特性，限制质数范围  
- **精度问题**：使用 `sqrtl` 和 `cbrtl` 计算平方/立方根，并检查相邻整数  
- **时间复杂度**：预处理质数后单次查询 $O(4000/\ln{4000})$

---

### 题解评分（≥4星）

1. **Lord_Sky2048（★★★★★）**  
   - **亮点**：代码简洁高效，预处理质数到4000，双重检查剩余部分  
   - **关键代码**：  
     ```cpp
     bool check(ll x) {
         ll y = pow(x, 0.5);
         if(y*y == x || (y+1)*(y+1) == x) return true;
         y = pow(x, 1.0/3);
         return y*y*y == x || (y+1)*(y+1)*(y+1) == x || (y+2)*(y+2)*(y+2) == x;
     }
     ```

2. **ylch（★★★★☆）**  
   - **亮点**：详细数学推导，强调精度误差处理  
   - **心得摘录**：  
     > “系统自带的 `sqrt` 和 `cbrt` 存在精度误差，通过检查相邻整数避免误判”

3. **BqtMtsZDnlpsT（★★★★☆）**  
   - **亮点**：数学证明严谨，提出 $\sqrt[5]{n}$ 分界思想  
   - **核心思路**：  
     > “枚举 $\sqrt[5]{n}$ 内的质数，剩余部分只能是平方或立方数”

---

### 最优思路提炼

1. **关键定理**：所有指数 ≥2 的数可拆分为 $x^2y^3$  
2. **质数预处理**：筛出 $\sqrt[5]{a}$ 内质数，限制分解范围  
3. **剩余验证技巧**：平方/立方根检查时需考虑相邻整数  
4. **代码优化**：分离质因数分解与剩余验证，避免冗余计算  

---

### 同类型题拓展

1. **指数分解类**：P2043 质因数分解  
2. **平方/立方数判断**：P1075 质因数分解的特殊情况  
3. **质数预处理应用**：P3383 线性筛素数  

---

### 可视化与算法演示

#### 动画设计
- **像素风格界面**：  
  - 背景：8位灰阶网格，质数用绿色像素标记  
  - 当前操作：红色高亮正在试除的质数，蓝色显示剩余数  
- **关键步骤**：  
  1. **质因数分解**：展示试除过程，指数以进度条形式显示  
  2. **剩余验证**：显示剩余数爆炸特效，分解为平方/立方块  
- **音效**：  
  - 成功：8位上升音阶  
  - 失败：低音蜂鸣  

#### 核心算法流程
```javascript
// 伪代码示例：验证剩余部分是否为平方/立方数
function checkRemain(x) {
    let sqrtX = Math.floor(Math.sqrt(x));
    if (sqrtX*sqrtX === x) return true;
    
    let cbrtX = Math.floor(Math.cbrt(x));
    for (let i = -1; i <= 1; i++) {
        let val = cbrtX + i;
        if (val*val*val === x) return true;
    }
    return false;
}
```

---

### 代码实现（核心逻辑）

```cpp
bool check(ll x) {
    ll y = sqrtl(x);
    if (y*y == x || (y+1)*(y+1) == x) return true;
    y = cbrtl(x);
    return y*y*y == x || (y+1)*(y+1)*(y+1) == x || (y+2)*(y+2)*(y+2) == x;
}

void solve() {
    ll a; cin >> a;
    // 预处理质数到4000
    for (int p : primes) {
        if (a % p != 0) continue;
        int cnt = 0;
        while (a % p == 0) a /= p, cnt++;
        if (cnt == 1) { cout << "no\n"; return; }
    }
    cout << (check(a) ? "yes" : "no") << '\n';
}
```

---
处理用时：69.59秒
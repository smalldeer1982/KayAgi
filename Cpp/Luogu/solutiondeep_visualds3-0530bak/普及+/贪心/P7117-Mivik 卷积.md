# 题目信息

# Mivik 卷积

## 题目背景

卷王之王卷穿肠（doge

## 题目描述

从前有一只 Mivik，他喜欢卷积。他定义两个仅与 $x$ 有关的多项式函数 $f\left(x\right)$ 和 $g\left(x\right)$ 的 Mivik 卷积如下：

$$
f\left(x\right)\otimes g\left(x\right)=\sum_{k=0}^{\deg f +\deg g}\max_{i\in [0,\deg f] \land j\in [0,\deg g]\land i+j=k}\left\{\left[x^i\right]f\left(x\right)+\left[x^j\right]g\left(x\right)\right\} x^k
$$

其中 $\deg f$ 表示 $f$ 的最高项次数，$\left[x^i\right]f\left(x\right)$ 代表 $f\left(x\right)$ 这一函数中 $x^i$ 这一项的系数。

请注意，Mivik 卷积是左结合的，也就是说 $a\otimes b\otimes c=(a\otimes b)\otimes c$。

Mivik 定义 Mivik 函数为能表示为 $f\left(x\right)=ax+b$ 形式的函数，其中 $a$、$b$ 均为整数。例如 $f\left(x\right)=-3+2x$ 是 Mivik 函数，而 $f\left(x\right)=\frac{1}{x}$ 不是。

Mivik 又定义一个函数 $f\left(x\right)$ 是 simple 的，当且仅当存在一个 Mivik 函数的序列 $S$（大小为 $\left|S\right|$），使得：

$$
f\left(x\right)=S_1\otimes S_2\otimes S_3\otimes\cdots\otimes S_{\left|S\right|}.
$$

现在 Mivik 给了你一个多项式函数，问你这个函数是不是 simple 的；如果是，请顺便告诉他任意一种可能的 $S$。

## 说明/提示

### 样例解释 #1

给定的函数 $f\left(x\right)=2+3x+3x^2$ 可以由 $\left(2x+1\right)\otimes\left(x+1\right)$ 得到。

### 测试点约束

**本题采用捆绑测试。**

对于全部数据，有 $1\le n\le 5\times 10^5$，$-10^8\le f_i\le 10^8$。

每个子任务的具体限制见下表：

| 子任务编号 | 分值 | $n\le$ |
|:-:|:-:|:-:|
| 1 | 5 | $1$ |
| 2 | 5 | $2$ |
| 3 | 20 | $20$ |
| 4 | 30 | $5000$ |
| 5 | 40 | $5\times 10^5$ |

**本题读入输出量较大，请使用较快的读入输出方式。**

## 样例 #1

### 输入

```
3
2 3 3
```

### 输出

```
simple
2
2 1
1 1
```

## 样例 #2

### 输入

```
3
97 109 101
```

### 输出

```
simple
2
54 42
47 55
```

## 样例 #3

### 输入

```
9
9 9 8 2 4 4 3 5 3
```

### 输出

```
nice
```

# AI分析结果



## 综合分析与结论

**题目核心**：判断给定的多项式是否可通过一系列形如 $ax+b$ 的 Mivik 函数的卷积生成，并构造任意合法序列。

**核心思路与难点**：
1. **贪心选择策略**：将问题转化为物品选择问题，每个物品选/不选对应不同权值。要求生成的序列必须满足相邻差分非递增。
2. **差分序列验证**：多项式系数序列的差分必须非递增，否则无法构造。
3. **构造方法**：第一个物品的 $b_1$ 设为 $S_0$，$a_1$ 设为 $S_1$；其余物品的 $b_i=0$，$a_i$ 设为对应差分值。

**可视化设计**：
- **动画方案**：用动态表格展示每一步差分比较，红色高亮违反非递增的差分，绿色标记合法部分。
- **像素风格**：以 8-bit 方块表示差分值，按大小降序排列，自动播放时逐个合并，音效提示合法/非法。
- **交互控制**：支持暂停/继续，拖拽调整差分顺序验证条件。

---

## 题解评分（≥4星）

1. **Mivik 题解（★★★★★）**
   - **亮点**：从卷积的数学性质推导出差分条件，结合贪心策略，理论严密。
   - **代码**：高效验证差分条件，构造参数直接。

2. **_H17_ 题解（★★★★）**
   - **亮点**：代码可读性强，注释清晰，包含快速 IO 优化。
   - **不足**：构造参数部分解释稍简略。

---

## 最优思路提炼

1. **差分条件**：$S_{i} - S_{i-1} \geq S_{i+1} - S_i$ 确保贪心选最大增量有效。
2. **构造方法**：
   - 首项 $b_1 = S_0$, $a_1 = S_1$，保证初始和。
   - 后续项 $a_i = S_i - S_{i-1}$，$b_i=0$，保证差分正确累加。

---

## 类似算法套路

- **贪心选择与排序**：如背包问题中按价值密度排序。
- **差分约束**：如任务调度中的时间安排问题。

---

## 推荐题目
1. P1090（合并果子，贪心+优先队列）
2. P1230（智力大冲浪，贪心+截止时间排序）
3. P5019（铺设道路，差分贪心）

---

## 代码片段（核心逻辑）

```cpp
// 验证差分是否非递增
for (int i = 2; i <= n; i++) {
    int diff = v[i] - v[i-1];
    if (last_diff < diff) { // 违反条件
        cout << "nice";
        return 0;
    }
    last_diff = diff;
}

// 构造参数
cout << "simple\n";
if (n == 1) {
    cout << "1\n0 " << v[1];
} else {
    cout << n-1 << "\n";
    for (int i = 2; i <= n; i++) {
        int a = (i == 2 ? v[1] : 0) + (v[i] - v[i-1]);
        int b = (i == 2 ? v[1] : 0);
        cout << a << " " << b << "\n";
    }
}
```

---

## 可视化设计

**复古像素动画**：
- **Canvas 绘制**：差分值用不同颜色块表示，绿色渐深表示值递减。
- **自动合并**：AI 自动将差分块按降序排列，错误时闪烁红色。
- **音效**：正确时播放8-bit“金币声”，错误时短促“爆炸声”。

**交互功能**：
- 点击差分块可手动交换位置，实时验证条件。
- 积分系统：连续正确+10分，错误重置，增强游戏感。

---

**总结**：通过贪心策略验证差分条件，构造参数确保每一步的局部最优解即全局最优，结合像素动画直观演示差分变化，强化算法理解。

---
处理用时：202.29秒
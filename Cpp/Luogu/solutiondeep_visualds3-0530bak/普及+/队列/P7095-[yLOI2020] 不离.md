# 题目信息

# [yLOI2020] 不离

## 题目背景

> 乱玄黄时序，探风林实虚。  
> 我要你共我奇谈怪趣。  
> 任日月斑斓，待春秋兴残。  
> 我要我们有聚无散。  

——银临《不离》

## 题目描述

这道题目来自 zxy 哔哔，咕咕让哔哔选一首歌作为题目名，但是哔哔说没有想好，于是咕咕就帮他选了这首歌。

哔哔在玩一款叫做《暗黑破坏神》的游戏，某天哔哔灵光乍现，以游戏为背景出了一道神仙题并告诉了咕咕。咕咕并不会做，于是对题目进行了一定的简化。因此，经过简化后，这道题已经和《暗黑破坏神》没什么关系了。

游戏中人物有两个属性，我们分别称之为「力量」和「精神」，同时哔哔有 $n$ 件装备，穿戴第 $i$ 件装备需要人物在穿戴前的力量值不低于 $a_i$，精神值不低于 $b_i$。在穿戴第 $i$ 件装备后，人物的力量值会增加 $c_i$，精神值会增加 $d_i$。

哔哔可以自由选择穿装备的顺序，只要满足力量和精神不低于对应值，就可以穿戴该装备。

现在，咕咕想知道，如果想让哔哔穿戴上所有的装备，那么人物的初始力量值（即没有穿任何装备之前的力量值）最小应该是多少？在初始力量值最小的前提下，初始精神值（即没有穿任何装备之前的精神值）最小应该是多少？

显然，初始力量和初始精神都应该是非负整数。

## 说明/提示

### 样例 1 解释

当初始力量值为 $1$，精神值为 $2$ 时，可以穿戴第 $2$ 件装备。在穿戴该装备后，增加 $3$ 点力量和 $4$ 点精神，人物的属性变为 $4$ 点力量和 $6$ 点精神，此时可以穿戴第 $1$ 件装备。

### 数据规模与约定

**本题采用多测试点捆绑测试**。

- 子任务 $1$（$5$ 分）：保证 $n=0$。
- 子任务 $2$（$5$ 分）：保证 $n=1$。
- 子任务 $3$（$20$ 分）：保证 $a_i,b_i \le 100$，$n \le 6$。
- 子任务 $4$（$10$ 分）：保证 $a_i,b_i \le 10^5$，$n \le 6$。
- 子任务 $5$（$10$ 分）：保证 $a_i,b_i \le 10$。
- 子任务 $6$（$10$ 分）：保证 $a_i,b_i \le 100$。
- 子任务 $7$（$10$ 分）：保证 $b_i=0$，$n \le 6$。
- 子任务 $8$（$10$ 分）：保证 $b_i=0$。
- 子任务 $9$（$10$ 分）：保证 $n \le 6$。
- 子任务 $10$（$10$ 分）：无特殊约定。

对于全部的测试点，保证 $0 \le n \le 10^5$，$0 \le a_i,b_i,c_i,d_i \le 10^9$。

### 提示
有 $4$ 个样例文件，请见附加文件中的 forever.zip。

对于第三个样例，满足 $b_i = 0$。

## 样例 #1

### 输入

```
0
2
1 5 0 2
1 2 3 4```

### 输出

```
1 2```

# AI分析结果



**唯一算法分类**: 贪心 + 优先队列

---

### 综合分析与结论
#### 核心思路
1. **力量值贪心**：将装备按力量需求升序排序，依次穿戴并计算最小初始力量值，不足时补充差值  
2. **精神值贪心**：在确定初始力量后，用优先队列维护可穿戴装备，每次选择精神需求最低的装备，动态更新最小初始精神值

#### 解决难点
- **双属性耦合**：通过分离处理，先确定力量再处理精神  
- **动态选择装备**：用优先队列实时维护当前可穿戴装备中的最小精神需求  
- **时间复杂度优化**：从暴力的全排列枚举（O(n!)）优化到 O(n log n)

#### 可视化设计
- **动画流程**：  
  1. 左侧画布展示按力量排序的装备队列  
  2. 右侧展示力量/精神值的实时数值（红色进度条）  
  3. 优先队列以气泡形式动态弹出当前最小精神装备  
  4. 穿戴装备时，该装备高亮为绿色并飞向角色属性面板  
- **交互功能**：  
  - 步进控制：可单步观察队列更新过程  
  - 音效：装备穿戴时播放"叮"声，属性不足时播放警示音  
  - 8位像素风格：装备显示为复古像素图标，属性值为LED式数字管

---

### 题解清单（≥4星）
1. **火车司机（5星）**  
   - 亮点：双贪心+优先队列的线性实现，代码简洁高效  
   - 关键代码：
     ```cpp
     for(int i=1; i<=n; ++i) {
         if(str < p[i].a) add += p[i].a - str, str = p[i].a;
         str += p[i].c;
     }
     while(!qq.empty() && p[j].a <= add) qq.push(j++);
     ```
   
2. **LAB_Maple（4.5星）**  
   - 亮点：独立处理两属性的思想明确，优先队列维护方式直观  
   - 心得摘录：*"处理力量的顺序不影响精神的最小值，必须动态维护可选项"*

3. **AuCloud（4星）**  
   - 亮点：完整的二分验证框架，适用于大规模数据  
   - 优化点：将全排列验证替换为优先队列验证，复杂度降为 O(n log n)

---

### 最优思路代码实现
```cpp
// 核心代码片段（火车司机版）
sort(p+1, p+1+n, [](auto& x, auto& y){ return x.a < y.a; });

// 计算最小力量
int add = 0, str = 0;
for(int i=1; i<=n; ++i) {
    if(str < p[i].a) add += p[i].a - str, str = p[i].a;
    str += p[i].c;
}

// 计算最小精神
priority_queue<node, vector<node>, cmp2> q;
int ansb = 0, sp = 0;
for(int i=1; i<=n; ) {
    while(i<=n && p[i].a <= add) q.push(p[i++]);
    if(q.empty()) break;
    auto t = q.top(); q.pop();
    if(sp < t.b) ansb += t.b - sp, sp = t.b;
    sp += t.d, add += t.c;
}
```

---

### 同类题目推荐
1. **P1080 国王游戏**（贪心+排序策略）  
2. **P5020 货币系统**（动态维护可用元素）  
3. **P2279 加油站**（优先队列维护覆盖范围）

---

### 可视化关键代码（伪代码）
```javascript
// Canvas绘制装备队列
function drawEquips() {
  equipList.forEach((e, i) => {
    ctx.fillStyle = e.used ? '#00FF00' : '#FF0000'; 
    ctx.fillRect(20, 20+i*30, 150, 25); // 装备方块
    drawText(`a:${e.a} b:${e.b}`, 25, 40+i*30);
  });
}

// 优先队列动画
function updateQueue() {
  let minB = Math.min(...activeEquips.map(e => e.b));
  activeEquips.forEach(e => {
    if(e.b === minB) {
      animateElement(e, 'scale(1.2)', '#FFFF00'); // 高亮当前最小
    }
  });
}
```

---

### 复古游戏化设计
- **像素风格**：装备显示为16x16像素图标，属性值采用8段LED字体  
- **音效设计**：  
  - 装备穿戴：FC风格的"叮咚"声（Web Audio合成方波）  
  - 属性不足：短促的"哔-"警告音  
- **成就系统**：  
  - 青铜：正确计算力量值  
  - 白银：在10秒内完成双属性计算  
  - 王者：用≤n步完成所有装备穿戴

---
处理用时：63.75秒
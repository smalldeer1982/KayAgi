# 题目信息

# 【深基13.例1】查找

## 题目描述

输入 $n$ 个不超过 $10^9$ 的单调不减的（就是后面的数字不小于前面的数字）非负整数 $a_1,a_2,\dots,a_{n}$，然后进行 $m$ 次询问。对于每次询问，给出一个整数 $q$，要求输出这个数字在序列中第一次出现的编号，如果没有找到的话输出 $-1$ 。

## 说明/提示

数据保证，$1 \leq n \leq 10^6$，$0 \leq a_i,q \leq 10^9$，$1 \leq m \leq 10^5$

本题输入输出量较大，请使用较快的 IO 方式。

## 样例 #1

### 输入

```
11 3
1 3 3 3 5 7 9 11 13 15 15
1 3 6```

### 输出

```
1 2 -1 ```

# AI分析结果



---

**算法分类**：二分

---

### **题解思路与核心难点**

**题目核心**：在单调不减序列中高效查找元素首次出现的位置，需处理大规模数据（n ≤1e6，m ≤1e5），暴力法 O(nm) 超时。

**核心思路**：利用单调性，二分查找将时间复杂度降至 O(m log n)。关键在于正确收缩区间，确保找到第一个出现的元素。

**解决难点**：
1. **区间收缩**：二分时需确保左区间优先，找到第一个等于目标的元素。
   - 当 `a[mid] >= x`，右边界收缩至 `mid`（可能包含解）。
   - 当 `a[mid] < x`，左边界移至 `mid+1`（排除不可能区间）。
2. **边界检查**：循环终止时需验证 `a[left] == x`，否则返回 -1。
3. **避免死循环**：合理计算 `mid`（用 `l + (r-l)/2` 防溢出）。

**对比题解**：
- **STL派**：直接用 `lower_bound` 简化代码，但需注意数组下标（从1开始需调整指针）。
- **手写二分派**：更灵活，可处理不同边界条件，需注意循环终止和边界更新。
- **预处理映射派**（如map）：适合元素重复少的情况，但预处理时间可能较高。

---

### **题解评分（≥4星）**

1. **dingcx（5星）**  
   - 亮点：简洁高效，利用 `lower_bound` 减少代码量，正确处理数组下标。  
   - 代码可读性高，适合快速实现。

2. **YellowEgg（4.5星）**  
   - 亮点：手写二分，清晰展示收缩逻辑，避免递归栈溢出风险。  
   - 代码易理解，适合教学。

3. **Graphcity（4星）**  
   - 亮点：莫队思想排序查询，线性扫描，时间复杂度更优（O(n + m log m)）。  
   - 创新性强，但需额外处理查询顺序。

---

### **最优思路提炼**

**二分关键代码**：
```cpp
int find(int x) {
    int l = 1, r = n;
    while (l < r) {
        int mid = l + (r - l) / 2; // 防溢出
        if (a[mid] >= x) r = mid;  // 左移右边界（保留可能解）
        else l = mid + 1;          // 右移左边界（排除非解）
    }
    return a[l] == x ? l : -1;
}
```

**核心技巧**：
- **优先左移**：确保找到第一个出现的位置。
- **防溢出计算**：`mid = l + (r-l)/2` 替代 `(l+r)/2`。
- **终值验证**：循环结束必须检查是否等于目标值。

---

### **同类题目推荐**

1. **P2678 跳石头**（二分答案，最小化最大距离）
2. **P1024 一元三次方程求解**（浮点数二分，求根）
3. **P1182 数列分段 Section II**（二分答案，最大化最小值）

---

### **可视化与算法演示**

**动画设计**：
1. **区间动态展示**：用Canvas绘制数组，高亮当前 `[left, right]` 区间，标记 `mid` 点。
2. **颜色标记**：
   - 当前 `mid` 元素：红色。
   - 搜索区间：蓝色背景。
   - 目标匹配：绿色闪烁。
3. **步进控制**：允许单步执行，观察 `left/right` 变化，显示比较结果（如 `<`、`≥`）。
4. **复古像素风格**：8-bit 音效（移动时“滴”声，匹配成功时“叮”声，失败时“哔”声）。

**交互功能**：
- **速度调节**：滑动条控制动画速度。
- **自动模式**：AI自动执行，模拟二分过程。
- **关卡积分**：每正确收缩区间得分，连击加速。

---

**总结**：二分查找需精准控制区间收缩与边界条件，手写实现强化理解，STL提升效率。可视化设计通过动态区间标记与交互操作，直观呈现算法核心逻辑。

---
处理用时：85.52秒
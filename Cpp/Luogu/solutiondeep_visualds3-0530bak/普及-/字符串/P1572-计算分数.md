# 题目信息

# 计算分数

## 题目描述

Csh 被老妈关在家里做分数计算题，但显然他不愿意做这么多复杂的计算。况且在家门口还有 Xxq 在等着他去一起看电影。为了尽快地能去陪 Xxq 看电影，他把剩下的计算题交给了你，你能帮他解决问题吗？


## 说明/提示

### 数据范围及约定

对于所有测试点，输入计算式长度在 $100$ 以内，分子、分母在 $1000$ 以内。同时保证，直接从前往后直接计算分数的和或者差，然后立刻化简，这么做的中间结果不会超过 int 的范围。

注意输入的分数不一定是最简分数。


------------
2024/2/13 添加 2 组 hack 数据。

## 样例 #1

### 输入

```
2/1+1/3-1/4```

### 输出

```
25/12```

# AI分析结果



**唯一算法分类**：无算法分类

---

**综合分析与结论**  
题目要求处理分数加减运算并化简结果。核心在于通分、约分及符号处理。  
- **通分**：统一分母后加减分子，或直接使用公式 `(a*d ± b*c)/(b*d)`。  
- **约分**：每次运算后立即用最大公约数（gcd）化简，防止溢出。  
- **符号处理**：确保分母始终为正，调整分子符号。  

**核心难点**：  
1. **运算符处理**：将减法转化为加法（取反分子），简化逻辑。  
2. **中间结果溢出**：及时约分是关键。  
3. **符号一致性**：分母为负时需调整分子分母符号。  

**可视化设计思路**：  
- **动画演示**：分步展示分数通分、分子加减、约分过程，高亮当前操作的分母/分子。  
- **符号调整**：用颜色区分正负分子，分母始终绿色（正数）。  
- **复古像素风**：分数以像素块显示，每次运算伴随8-bit音效，通关式分步演示。  

---

**题解清单 (≥4星)**  
1. **ggylz49（5星）**  
   - 结构体封装分数，逻辑清晰。  
   - 每次运算后约分，处理符号全面。  
   - 代码可读性高，适合学习结构体用法。  
   - **亮点**：输入时立即约分，避免未化简初始值错误。  

2. **int_stl（4星）**  
   - 直接使用公式计算，最小公倍数优化。  
   - 符号处理通过判断分子分母符号状态，逻辑严谨。  
   - **亮点**：通过符号函数处理输出格式。  

3. **封禁用户（4星）**  
   - 代码极简，将减法转化为负数加法。  
   - 统一处理符号，适合竞赛快速编码。  
   - **亮点**：仅用单循环处理所有运算，高效紧凑。  

---

**最优思路与技巧**  
1. **符号前置处理**：将减法转为负数加法，简化运算符判断。  
2. **实时约分**：避免中间结果溢出，确保分母始终为正。  
3. **通分公式**：直接使用 `(a*d ± b*c)/(b*d)` 减少计算步骤。  

**示例代码（封禁用户思路）**  
```cpp
#include<bits/stdc++.h>
using namespace std;
int a,b,c,d=1;
int main(){
    while(~scanf("%d/%d",&a,&b)){
        c=a*d + c*b; // 通分后分子相加
        d*=b;        // 通分后分母
        int g=__gcd(c,d);
        c/=g; d/=g;  // 约分
        if(d<0) c=-c,d=-d; // 确保分母为正
    }
    if(d==1) cout<<c;
    else cout<<c<<'/'<<d;
}
```

---

**同类型题与推荐题目**  
1. **P1022** 计算器的改良（表达式解析）  
2. **P1062** 数列（分数规律处理）  
3. **P2119** 魔法阵（数学公式分步计算）  

---

**可视化算法演示**  
- **Canvas动画**：  
  1. 初始分数显示为像素块（分子红色，分母绿色）。  
  2. 通分时显示分母相乘动画，分子调整同步高亮。  
  3. 约分时展示gcd计算，分子分母缩小过程。  
  4. 符号调整：分母变负时翻转颜色并播放音效。  

- **复古音效**：  
  - 加减运算：8-bit “哔”声。  
  - 约分成功：上扬音调。  
  - 错误处理：短促“嘟”声。  

---

**总结**  
处理分数运算需注意通分、约分和符号。实时化简与符号前置处理是避免错误的关键。封禁用户的极简代码适合竞赛，而结构体封装更易维护。

---
处理用时：104.63秒
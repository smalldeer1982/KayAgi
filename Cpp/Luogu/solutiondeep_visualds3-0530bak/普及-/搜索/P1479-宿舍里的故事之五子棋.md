# 题目信息

# 宿舍里的故事之五子棋

## 题目描述

宿舍里好多好多有趣的事！

7890653 今天看到不知何时流行的五子棋，在宿舍里拿个本子，画一些格子，一个棋盘就做好了。

当 7890653 把目光放到棋上，突发奇想……

在一个 $5 \times 5$ 的棋盘内，放上 $n$ 颗棋子，其中 $5 \le n \le 25$；

这 $n$ 颗棋子可以放到棋盘内任意一个地方，但是不能重叠在一起。于是，便会有五颗棋子排成一行，或一列，或处在同一条对角线上。不同的放法可能会出现不同个数的五子的排列。

本题你要做的是，给你一个 $n$，你要找出不同放法出现的五子连线的数量（设为 $k$），如 $n=11$，有：

![](https://cdn.luogu.com.cn/upload/image_hosting/rcwazq5o.png)

只有这两种非负的 $k$ 值，（注意 $k$ 不重复），你要输出的便是 $k$ 值的和。

也就是 $1+2=3$。

## 样例 #1

### 输入

```
11```

### 输出

```
3```

# AI分析结果



# 算法分类：DFS（深度优先搜索）

## 题解思路与算法要点

### 核心思路
题目要求在5x5棋盘上枚举所有放置n颗棋子的方案，统计各方案中五子连线的不同数量之和。关键难点在于：
1. 遍历25个位置的所有组合方式（C(25,n)量级）
2. 对每个合法方案快速计算五子连线数k
3. 对不同的k值去重后求和

### 算法对比
| 题解             | 搜索方式           | 剪枝策略                     | 状态表示               |
|------------------|------------------|----------------------------|----------------------|
| 樱式分解          | 二维坐标递归DFS    | 仅终止条件剪枝                | 二维布尔数组记录棋盘     |
| Youngsc         | 一维线性坐标DFS    | 剩余位置不足时剪枝             | 二维数组转换为一维坐标   |
| 巫妖王            | 组合式DFS         | 组合数生成剪枝                | 二维数组线性化处理      |

### 最优思路提炼
1. **DFS+剪枝**：将棋盘视为25个一维位置，递归决策每个位置是否放置棋子。当剩余位置数 < 剩余需放置棋子数时剪枝。
2. **五子连线计算**：每次生成完整方案后，检查12条可能连线（5行+5列+2对角线）。
3. **状态记录**：用布尔数组标记出现过的k值，确保每个k只计一次。

## 题解评分（≥4星）
1. **樱式分解（4星）**  
   - 亮点：直观的二维坐标DFS实现，注释清晰  
   - 不足：缺少显式剪枝，n较大时效率较低

2. **Youngsc（4.5星）**  
   - 亮点：一维坐标优化，剩余位置剪枝策略  
   - 代码：`dfs`函数中的`25-pos+1 < num`剪枝显著提升效率

3. **封禁用户（3星）**  
   - 缺点：直接打表失去算法训练意义

## 核心代码实现
```cpp
// Youngsc题解核心片段
void dfs(R int pos,R int num){
    if(!num){
        check(); // 计算五子连线数
        return;
    }
    if(25-pos+1 < num) return; // 剪枝：剩余位置不足
    for(R int i=pos; i<=25; ++i){
        R int x = (i-1)/5+1; // 坐标转换
        R int y = (i-1)%5+1;
        f[x][y] = 1;
        dfs(i+1, num-1);
        f[x][y] = 0;
    }
}

void check(){
    int cnt = 0;
    // 检查行
    for(int i=1; i<=5; ++i)
        if(f[i][1]&&f[i][2]&&f[i][3]&&f[i][4]&&f[i][5]) cnt++;
    // 检查列（同理）
    // 检查对角线...
    v[cnt] = true; // 标记出现过的k值
}
```

## 可视化设计
### 动画方案
1. **网格绘制**：在Canvas上绘制5x5棋盘，每个格子显示棋子状态
2. **搜索过程**：
   - 红色高亮当前处理的位置
   - 绿色标记已放置棋子
   - 黄色闪烁提示剪枝发生
3. **连线检测**：当生成完整方案时，用蓝色线条标注五子连线

### 复古游戏化特性
```javascript
// 示例音效触发
function playSound(type) {
    if(type === 'place') new Audio('data:audio/wav;base64,UklGRl...').play();
    if(type === 'line') new Audio('data:audio/wav;base64,UklGRl...').play();
}

// 像素风格CSS
.grid-cell {
    width: 32px;
    height: 32px;
    image-rendering: pixelated;
    background: url('pixel-chess.png');
}
```

## 相似题目推荐
1. **P1036 选数** - 组合数枚举
2. **P1219 八皇后** - 棋盘放置问题
3. **P1120 小木棍** - DFS剪枝经典

## 个人心得摘录
> "当n较大时，剩余位置剪枝能减少90%以上的递归分支" —— Youngsc题解中剪枝策略的实际效果显著

## 算法演示
访问 https://jsfiddle.net/ 输入以下代码查看动态效果：
```html
<canvas id="board" width="160" height="160"></canvas>
<script>
// 简化解法动画演示
const ctx = document.getElementById('board').getContext('2d');
let grid = Array(5).fill().map(()=>Array(5).fill(0));

function draw() {
    ctx.clearRect(0,0,160,160);
    // 绘制棋盘网格...
    // 绘制棋子状态...
    // 高亮当前处理位置...
}
</script>
```

---
处理用时：97.80秒
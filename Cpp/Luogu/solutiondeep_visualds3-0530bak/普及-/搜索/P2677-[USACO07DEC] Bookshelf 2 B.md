# 题目信息

# [USACO07DEC] Bookshelf 2 B

## 题目描述

Farmer John最近为奶牛们的图书馆添置了一个巨大的书架，尽管它是如此的大，但它还是几乎瞬间就被各种各样的书塞满了。现在，只有书架的顶上还留有一点空间。 所有N(1 <= N <= 20)头奶牛都有一个确定的身高H\_i(1 <= H\_i <= 1,000,000 - 好高的奶牛>\_<)。设所有奶牛身高的和为S。书架的 高度为B，并且保证1 <= B <= S。 为了够到比最高的那头奶牛还要高的书架顶，奶牛们不得不象演杂技一般，一头站在另一头的背上，叠成一座“奶牛塔”。当然，这个塔的高度，就是塔中所有奶牛的身高之和。为了往书架顶上放东西，所有奶牛的身高和必须不小于书架的高度。 塔叠得越高便越不稳定，于是奶牛们希望找到一种方案，使得叠出的塔在高度不小于书架高度的情况下，高度尽可能小。你也可以猜到你的任务了：写一个程序，计算奶牛们叠成的塔在满足要求的情况下，最少要比书架高多少。


## 说明/提示

输出说明:

我们选用奶牛1、3、4、5叠成塔，她们的总高度为3 + 3 + 5 + 6 = 17。任何方案都无法叠出高度为16的塔，于是答案为1。


## 样例 #1

### 输入

```
5 16
3
1
3
5
6```

### 输出

```
1```

# AI分析结果



**【算法分类】**  
其他搜索  

---

**【题解思路与算法要点】**  

**核心问题**：在奶牛的子集中找到高度和≥B的最小值，计算其与B的差值。  
**解决思路**：  
1. **动态规划（背包）**：将问题转化为背包容量为 `总高度 - B`，最大化装入的奶牛高度。剩余部分即为最优解。  
2. **DFS/二进制枚举**：遍历所有可能的子集组合，记录满足条件的最小高度。  
3. **折半搜索**：将数组分为两半，分别计算子集和，合并结果时用二分查找优化。  

**难点与优化**：  
- **DFS剪枝**：若当前累积和已超过已知最小解，可提前终止搜索。  
- **背包空间优化**：若总高度较大，需调整状态定义避免内存溢出。  
- **折半搜索的合并**：通过排序和二分查找快速找到最优组合。  

---

**【题解评分 (≥4星)】**  

1. **道费而隐 (★★★★☆)**  
   - **亮点**：巧妙转化为背包问题，代码简洁高效。  
   - **关键代码**：  
     ```cpp  
     for(int j=w;j>=h[i];j--)  
         f[j] = max(f[j], f[j-h[i]] + h[i]);  
     ```  

2. **Soledad_S (★★★★★)**  
   - **亮点**：折半搜索降低复杂度至 `O(2^(n/2))`，适合更大规模数据。  
   - **关键代码**：  
     ```cpp  
     DFS1(1, n>>1, 0);  // 计算前半部分子集和  
     DFS2((n>>1)+1, n, 0);  // 计算后半部分子集和  
     ```  

3. **郑yz (★★★★☆)**  
   - **亮点**：递归式DFS结构清晰，适合教学。  
   - **关键代码**：  
     ```cpp  
     dfs(t+1, sum);          // 不选当前奶牛  
     dfs(t+1, sum + hi[t]);  // 选当前奶牛  
     ```  

---

**【最优思路与技巧】**  
1. **背包转化**：将问题转化为01背包，避免直接枚举所有子集。  
2. **折半搜索 + 二分**：分治思想显著降低时间复杂度。  
3. **位运算枚举**：利用二进制位表示选/不选状态，代码简洁。  

---

**【同类型题推荐】**  
1. [P1048 采药](https://www.luogu.com.cn/problem/P1048)（01背包）  
2. [P3067 Balanced Cow Subsets](https://www.luogu.com.cn/problem/P3067)（折半搜索）  
3. [P1441 砝码称重](https://www.luogu.com.cn/problem/P1441)（子集枚举）  

---

**【可视化与算法演示】**  

**动画设计**：  
1. **节点表示**：每头奶牛为一个像素方块，选中时高亮。  
2. **搜索过程**：  
   - DFS：递归树逐步展开，当前路径用不同颜色标记。  
   - 背包：动态填充二维表格，显示状态转移。  
3. **交互功能**：  
   - **步进控制**：手动点击触发下一步搜索或背包填充。  
   - **音效提示**：选中奶牛时播放8-bit音效，找到解时播放胜利音效。  

**复古风格**：  
- **调色板**：16色FC风格，绿色表示未访问，红色表示已选。  
- **Canvas绘制**：奶牛排列为网格，选中状态用闪烁效果。  

---

**【代码片段】**  
**折半搜索核心合并逻辑**：  
```cpp  
sort(b+1, b+b[0]+1);  
for (int i=1; i<=a[0]; i++) {  
    int tmp = m - a[i];  
    int pos = lower_bound(b+1, b+b[0]+1, tmp) - b;  
    if (pos <= b[0]) ans = min(ans, a[i] + b[pos] - m);  
}  
```  

**DFS剪枝优化**：  
```cpp  
if (current_sum >= B && current_sum < min_ans) {  
    min_ans = current_sum;  
    return;  // 提前终止无效分支  
}  
```  

--- 

**总结**：通过多种方法对比，背包和折半搜索在效率上占优，DFS适合小规模数据；可视化设计可增强对搜索过程的理解，复古风格提升学习趣味性。

---
处理用时：103.82秒
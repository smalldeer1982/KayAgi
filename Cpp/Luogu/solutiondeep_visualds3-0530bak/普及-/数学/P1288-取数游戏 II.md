# 题目信息

# 取数游戏 II

## 题目描述

有一个取数的游戏。初始时，给出一个环，环上的每条边上都有一个非负整数。这些整数中至少有一个 $0$。然后，将一枚硬币放在环上的一个节点上。两个玩家就是以这个放硬币的节点为起点开始这个游戏，两人轮流取数，取数的规则如下：

1.  选择硬币左边或者右边的一条边，并且边上的数非 $0$；
1.  将这条边上的数减至任意一个非负整数（至少要有所减小）；
1.  将硬币移至边的另一端。

如果轮到一个玩家走，这时硬币左右两边的边上的数值都是 $0$，那么这个玩家就输了。

如下图，描述的是 Alice 和 Bob 两人的对弈过程（其中黑色节点表示硬币所在节点）。

 ![](https://cdn.luogu.com.cn/upload/pic/93.png) 

各图的结果为：

- $\text{A}$：轮到 Alice 操作；
- $\text{B}$：轮到 Bob 操作；
- $\text{C}$：轮到 Alice 操作；
- $\text{D}$：轮到 Bob 操作。

$\text{D}$ 中，轮到 Bob 走时，硬币两边的边上都是 $0$，所以 Alice 获胜。

现在，你的任务就是根据给出的环、边上的数值以及起点（硬币所在位置），判断先走方是否有必胜的策略。

## 样例 #1

### 输入

```
4
2 5 3 0
```

### 输出

```
YES
```

## 样例 #2

### 输入

```
3
0 0 0
```

### 输出

```
NO
```

# AI分析结果



---

## **数学分类**  
**组合数学**（博弈论中的必胜策略判定）

---

## **题解思路、算法要点与解决难点**  
### **核心思路**  
- **关键观察**：当玩家将某边减至0后，对手只能沿单一方向移动。胜负由起点到最近两个0点的距离奇偶性决定。
- **数学推导**：若任一方向的距离为奇数，先手必胜。反之，若两距离均为偶数，先手必败。
- **解决难点**：理解双方最优策略下移动方向固定，奇偶性决定最后一步归属。

### **算法实现**  
1. **步骤**：  
   - 从起点向左右遍历，找到最近的0点。
   - 计算两个方向的距离 `distance_left` 和 `distance_right`。
   - 若任一距离为奇数，输出 `YES`，否则输出 `NO`。
2. **公式简化**：无需动态规划或复杂博弈树，直接奇偶判断即可。

---

## **题解评分（≥4星）**  
1. **intruder（⭐⭐⭐⭐⭐）**  
   - 思路清晰，代码简洁高效，直接遍历两次判断奇偶性。  
   - 代码可读性强，时间复杂度 `O(n)`。  
2. **远航之曲（⭐⭐⭐⭐）**  
   - 解释最优策略的必然性（每次必须取完边权），代码用位运算优化奇偶判断。  
   - 逻辑严谨，但变量命名稍简略。  
3. **Telaris11321（⭐⭐⭐⭐）**  
   - 图示说明“狂奔”策略，代码处理环的左右端点距离。  
   - 实现稍复杂但核心逻辑一致。

---

## **最优思路/技巧提炼**  
1. **奇偶决定性**：必胜策略的数学本质是路径长度的奇偶性，无需考虑具体数值。  
2. **链式反应**：双方被迫沿固定方向移动，最终步数由初始距离奇偶决定。  
3. **环的处理**：将环拆分为左右两条链，分别计算到最近0的距离。

---

## **同类型题与常见套路**  
- **通用套路**：博弈论中，若胜负仅由初始状态的奇偶性、模数或对称性决定，优先分析简单数学性质。  
- **类似题目**：  
  1. **洛谷 P1290**（欧几里得游戏的奇偶策略）  
  2. **洛谷 P2197**（NIM游戏，异或判定）  
  3. **洛谷 P1247**（取火柴游戏，NIM变形）

---

## **个人心得摘录**  
- **塔罗兰**：“千万不要相信教练……” → 提示需独立验证规律。  
- **MrYqy**：“假设双方足够聪明，每次取完边权” → 必须严格证明最优策略的必然性。  
- **Xiao_Ling**：“胜利QwQ” → 通过极端案例（如边权为1）快速验证思路。

---

## **可视化与算法演示**  
### **核心数学过程**  
- **动画设计**：  
  1. 环形图展示初始边权，高亮起点和最近的0点。  
  2. 动态显示左右两条链的距离，红色标记奇数距离，绿色标记偶数。  
  3. 模拟双方移动，硬币沿链移动，边权依次归零，最后显示胜负结果。  
- **复古像素风格**：  
  - **Canvas 绘制**：用8位色块表示边（非0边为蓝色，0边为黑色），硬币为黄色方块。  
  - **音效**：移动时播放“哔”声，胜利时播放经典FC过关音效。  
  - **自动演示**：按空格键切换手动/自动模式，AI自动选择必胜方向。

### **代码片段（关键逻辑）**  
```cpp
// 计算左右最近0的距离
int left_dist = 0, right_dist = 0;
for (int i = start; a[i] != 0; i = (i-1 + n) % n) left_dist++;
for (int i = start; a[i] != 0; i = (i+1) % n) right_dist++;
// 奇偶判断
if (left_dist % 2 == 1 || right_dist % 2 == 1) cout << "YES";
else cout << "NO";
```

---

## **推荐题目**  
1. **P1290** - 欧几里德的游戏（减法博弈）  
2. **P2197** - 【模板】nim游戏（异或策略）  
3. **P1247** - 取火柴游戏（NIM变形）

---

**总结**：本题通过奇偶性快速判定必胜策略，是博弈论中“对称性破缺”的经典案例。核心在于将环拆解为链，忽略具体数值，聚焦路径长度奇偶性。

---
处理用时：81.86秒
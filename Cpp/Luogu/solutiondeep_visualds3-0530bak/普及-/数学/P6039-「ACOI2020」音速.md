# 题目信息

# 「ACOI2020」音速

## 题目背景

![T1](https://s2.ax1x.com/2020/01/12/loSQJI.png)

防卫省的 乌间 惟臣（Tadaomi Karasuma）老师来到了椚丘中學给予了三年 E 班的同学们重大的任务：在一年内暗杀掉一个超生物（被 茅野 カエデ 取名为杀老师）。于是同学们开始努力地训练。但是很快的，杀老师展现了它的本领，可以以 20 马赫的超高速持久飞行，导致同学们根本碰不到杀老师。于是他们准备找乌间购买一个传送器。

## 题目描述

现在同学们在后山埋伏。同学们对后山足够熟悉，并且后山足够宽广，可以看做一个无限大的平面直角坐标系，而同学们在 $(0,0)$ 这个位置。这时候杀老师在 $(x,y)$ 这个位置捡到了 岡島 大河 所放置的小黄书认真地读了起来。同学们现在可以以自己为圆心，$r$ 为半径画一个圆然后把传送器抛出去，落在圆上一点 $S$，传送器可以在落点处作一条与刚才的圆相切的直线 $PQ$，现在这条直线就是我们的传送器了。

传送器的作用是：把同学们传送到他们所站的点关于 $PQ$ 的对称点。而且他们必须要**传送后移动**到杀老师的位置才能攻击它。现在，乌间看了他们的计划之后十分感叹，但是他有两个问题想问同学：

- 他们用了传送器之后，至少需要移动多远？

- 在保证移动距离最短的方案下，$PQ$ 与 $x$ 轴夹角的 $\tan$ 值为多少？我们认为夹角在 $[0,180]$ ° 。

## 说明/提示

#### 数据范围 

**本题采用捆绑测试**。

- Subtask 1（10 points）：$x,y,r$ 满足 $x^2+y^2=r^2$。     
- Subtask 2（20 points）：$x,y$ 中至少有一个为 $0$。     
- Subtask 3（70 points）：数据无特殊限制。    

对于 $100\%$ 的数据， $0 \leq |x|,|y|,r \leq 10^{10}$。

---
####  提示

1. **本题含有 SPJ**，如果第一个问题的答案与标准答案差的绝对值不大于 $10^{-6}$ 时就能获得该测试点的分数的 $50\%$。当第一个问题的答案正确时：      
- 若第二个问题的答案不为 ```Error``` 时，当输出答案与标准答案差的绝对值不大于 $10^{-2}$ 时能得到该测试点的所有分数；
- 当第二个问题的答案为 ```Error``` 时，只有输出 ```Error``` 才能得到该测试点的所有分数。  
**因为 SPJ 敏感，如果只能回答第一个问题，也请在第二行随意输出一些值，不要输出 `Error`**。

2. $\tan$ 值表示在一个 **直角三角形** 中，一个角相对的直角边与其相邻的直角边的比值，比如 $\tan\ 45°= 1$。特殊地，$90°$ 的 $\tan$ 值**无意义**。

3. 和圆只有一个公共交点的直线叫做圆的**切线**，连接切点与圆心的半径**垂直**于切线。

## 样例 #1

### 输入

```
11 0
5
```

### 输出

```
1.000000
Error```

## 样例 #2

### 输入

```
6 8
4
```

### 输出

```
2.000000
0.75```

# AI分析结果



### **唯一算法分类**  
几何

---

### **题解思路与核心难点**  
**核心思路**：  
1. **传送后位置**：以原点为圆心，`2r` 为半径的圆上，最短路径是目标点与该圆的最短距离（绝对值形式）。  
2. **方向选择**：最优投掷方向是原点与目标点的连线方向，此时对称点的直线距离最短。  
3. **tan值计算**：直线方向与x轴夹角的tan值为 `|x/y|`，需处理 `y=0` 的特殊情况。

**关键公式推导**：  
- **最短距离**：`|sqrt(x² + y²) - 2r|`（几何圆到点的距离性质）。  
- **tan值来源**：对称切线与x轴夹角对应的直角三角形中，对边为 `x`，邻边为 `y`（相似三角形与切线垂直性）。

**难点解决**：  
1. **几何对称性证明**：通过几何分析（三角形不等式、相似三角形）证明最优路径为直线方向。  
2. **特殊情况处理**：  
   - 目标点在原点时，`tan=0`（任意方向均可，取最小值）。  
   - `y=0` 时直线垂直于x轴，tan无意义（输出`Error`）。

---

### **题解评分 (≥4星)**  
1. **Rubidium_Chloride（5星）**  
   - **亮点**：详细数学证明、代码简洁、覆盖所有边界条件。  
   - **代码片段**：  
     ```cpp
     dis = abs(sqrt(x*x + y*y) - 2*r);
     if (y == 0) cout << "Error";
     else cout << abs(x/y);
     ```

2. **Azazеl（4星）**  
   - **亮点**：几何图形辅助解释、代码处理负数取绝对值。  
   - **个人心得**：强调“必须使用传送器”的题意陷阱。

3. **e的x次幂（4星）**  
   - **亮点**：直观图示与相似三角形推导，代码清晰。  
   - **可视化思路**：用直角三角形动态展示 `x/y` 的比值计算。

---

### **最优技巧提炼**  
1. **几何对称性简化**：将复杂传送路径转化为圆到点的直线距离问题。  
2. **公式直接计算**：避免复杂几何运算，直接使用目标点坐标和半径计算答案。  
3. **边界条件处理**：利用条件判断覆盖所有特殊输入（如原点、y=0）。

---

### **同类型题目与套路**  
**通用套路**：  
- **最短路径问题**：利用对称性/几何性质将折线路径转化为直线。  
- **三角函数应用**：通过坐标比值直接计算角度参数。  

**推荐题目**：  
1. [P1037 产生数](https://www.luogu.com.cn/problem/P1037)（几何变换）  
2. [P1355 三角形最大面积](https://www.luogu.com.cn/problem/P1355)（坐标几何）  
3. [P1516 青蛙的约会](https://www.luogu.com.cn/problem/P1516)（数论与几何结合）

---

### **可视化与算法演示**  
**动画设计**：  
1. **坐标系绘制**：  
   - 原点 `O(0,0)` 与目标点 `S(x,y)` 标记为红色/蓝色像素块。  
   - 绘制半径 `r` 的圆（绿色）和 `2r` 的圆（黄色）。  
2. **动态计算流程**：  
   - **步骤1**：高亮 `OS` 连线，计算其长度 `sqrt(x² + y²)`。  
   - **步骤2**：显示 `2r` 圆与 `OS` 的交点，计算距离差绝对值。  
   - **步骤3**：绘制直角三角形，动态标注 `x` 和 `y` 的边长，计算 `x/y`。  
3. **复古风格**：  
   - **8位音效**：计算完成时播放“通关”音效，错误时播放“失败”音效。  
   - **像素动画**：用网格和色块模拟几何图形，步进展示公式推导。

**代码片段（JS Canvas）**：  
```javascript
// 绘制原点与目标点
ctx.fillStyle = "#FF0000";
ctx.fillRect(originX, originY, 8, 8); // 原点
ctx.fillStyle = "#0000FF";
ctx.fillRect(targetX, targetY, 8, 8); // 目标点

// 动态绘制圆
function drawCircle(radius, color) {
    ctx.beginPath();
    ctx.arc(originX, originY, radius, 0, 2 * Math.PI);
    ctx.strokeStyle = color;
    ctx.stroke();
}
```

---

### **个人心得摘录**  
- **Rubidium_Chloride**：  
  > “当目标点在原点时，必须输出 `0.00` 而非 `Error`，这是容易被忽略的边界条件。”  
- **Azazеl**：  
  > “此题败笔在于未明确 `cot` 的数学定义，可能造成学科隔阂。”  

---

### **代码实现（核心逻辑）**  
```cpp
#include <bits/stdc++.h>
using namespace std;

int main() {
    double x, y, r;
    cin >> x >> y >> r;
    // 计算最短距离
    double dis = fabs(sqrt(x*x + y*y) - 2*r);
    printf("%.6lf\n", dis);
    
    // 处理tan值
    if (x == 0 && y == 0) cout << "0.00"; // 原点特判
    else if (y == 0) cout << "Error";     // y=0无意义
    else printf("%.2lf", fabs(x / y));    // 取绝对值
    return 0;
}
```

---
处理用时：71.66秒
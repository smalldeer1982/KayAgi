# 题目信息

# 不死「火鸟　−凤翼天翔−」

## 题目背景

拥有了「不死」的能力的藤原妹红，同时获得了操纵火焰的力量，是不死鸟的化身。

不死鸟，和凤凰是同一种生物吗？

## 题目描述

妹红可以操纵火鸟。火鸟可以看作在边长**无限大**的棋盘上放置着的一枚棋子 $A$，$A$ 位于 $(x_1,y_1)$ 处。$A$ 以如下规则移动：

- 在奇数次移动时，$A$ 只能向右上或者左下移动一格，如下图红色箭头；
- 在偶数次移动时，$A$ 只能向右下或者左上移动一格，如下图蓝色箭头。

![](https://cdn.luogu.com.cn/upload/image_hosting/rk4bjeya.png)

由于棋盘无限大，因此 $x,y$ 的取值可以为负数。

每一步行动时 $A$ 不能待在原地不移动。现在需要把 $A$ 移动到坐标为 $(x_2,y_2)$ 的 $B$ 位置，最少要多少步？特别地，若不存在这样的方案，输出 $-1$。

如下图所示是 $A=(2,7)$，$B=(5,2)$ 的情况。一种移动次数最小的方案已在图上标出，需要 $9$ 步。红色线段表示奇数次的移动，蓝色线段表示偶数次的移动。

![](https://cdn.luogu.com.cn/upload/image_hosting/mzwrv7q0.png)

## 说明/提示

### 数据范围及约定

对于全部数据，保证 $0\le x_1,y_1,x_2,y_2\le 10^9$。

## 样例 #1

### 输入

```
2 7 5 2```

### 输出

```
9```

## 样例 #2

### 输入

```
2 2 3 2```

### 输出

```
-1
```

## 样例 #3

### 输入

```
0 0 1000000000 1000000000
```

### 输出

```
2000000000```

# AI分析结果



---

**算法分类**：组合数学

---

### **题解思路与核心难点**

1. **必要条件**：起点与终点的坐标和奇偶性必须相同，否则无解（返回-1）。
2. **曼哈顿距离计算**：若坐标差绝对值 `dx` 和 `dy` 均为偶数，则总步数为 `dx + dy`。
3. **奇偶调整**：若 `dx` 和 `dy` 均为奇数，需调整到相邻点（如 `(x2±1, y2±1)`），计算两种调整方式的曼哈顿距离最小值并加1步。

**关键公式推导**：
- 奇数次移动：方向为右上/左下，坐标变化 `(±1, ±1)`，总和奇偶性不变。
- 偶数次移动：方向为右下/左上，坐标变化 `(±1, ∓1)`，总和奇偶性不变。
- 总步数公式：当 `dx` 和 `dy` 奇偶性相同时：
  - 若均为偶数：步数 = `dx + dy`。
  - 若均为奇数：步数 = `min( (dx+1)+(dy+1), (dx-1)+(dy-1) ) + 1`。

---

### **题解评分（≥4星）**

1. **题解1（Night_sea_64）** ★★★★★  
   - **亮点**：简洁高效，通过奇偶性快速判断，直接数学推导。
   - **代码**：仅需3个条件分支，覆盖所有情况。
2. **题解2（wuhan1234）** ★★★★☆  
   - **亮点**：分步调整x和y坐标，逻辑清晰，但需额外处理方向。
   - **注意**：假设调整y时x坐标不变，需偶数步实现。
3. **题解3（ダ月）** ★★★★☆  
   - **亮点**：利用位运算判断方向，代码简短，但可读性稍弱。

---

### **最优思路与技巧**

1. **奇偶性判定**：通过坐标和奇偶性快速排除无解情况。
2. **曼哈顿距离优化**：利用两步周期特性，将问题转化为曼哈顿距离计算。
3. **调整策略**：对奇数差情况，通过相邻点调整最小化步数。

---

### **同类型题与算法套路**

- **常见套路**：棋盘移动问题中，奇偶性、曼哈顿距离、周期性移动是关键。
- **类似题目**：
  - 洛谷 P1866（坐标奇偶性与移动限制）
  - 洛谷 P1217（棋盘覆盖的奇偶性分析）
  - 洛谷 CF510C（方向限制与路径存在性）

---

### **推荐题目**

1. **P1866 小A的棋盘**：奇偶性判断与移动步数优化。
2. **P1036 选数**：数论中的奇偶性应用。
3. **P1217 棋盘覆盖**：分奇偶性处理棋盘覆盖问题。

---

### **代码实现（题解1核心逻辑）**

```cpp
#include<iostream>
#include<cmath>
using namespace std;

int main() {
    int x1, y1, x2, y2;
    cin >> x1 >> y1 >> x2 >> y2;
    // 奇偶性不同，无解
    if ((x1 + y1) % 2 != (x2 + y2) % 2) {
        cout << -1;
        return 0;
    }
    int dx = abs(x1 - x2), dy = abs(y1 - y2);
    // 均为偶数，直接计算
    if (dx % 2 == 0) cout << dx + dy;
    else { // 均为奇数，调整后加1
        int adjust1 = (dx + 1) + (dy + 1);
        int adjust2 = (dx - 1) + (dy - 1);
        cout << min(adjust1, adjust2) + 1;
    }
    return 0;
}
```

---

### **可视化设计（复古像素风格）**

1. **棋盘绘制**：Canvas绘制无限大棋盘，起点/终点用不同颜色（红/蓝）标记。
2. **移动动画**：
   - **奇数步**：红色箭头（右上/左下），音效“哔”。
   - **偶数步**：蓝色箭头（右下/左上），音效“嘟”。
3. **自动推导模式**：
   - 高亮当前步的坐标变化，显示当前总步数。
   - 失败时播放“失败音效”，成功时播放“胜利音效”。
4. **参数交互**：可输入坐标，调节动画速度，单步执行观察调整逻辑。

---

**总结**：本题核心为奇偶性与曼哈顿距离的结合，通过两步周期特性简化问题。最优解通过数学推导直接计算，避免复杂模拟。

---
处理用时：393.02秒
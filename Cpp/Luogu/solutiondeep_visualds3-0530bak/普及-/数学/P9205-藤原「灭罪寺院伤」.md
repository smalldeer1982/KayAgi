# 题目信息

# 藤原「灭罪寺院伤」

## 题目背景

藤原氏，权倾一时的重臣。凭借着炙手可热的权势，杀害了政敌长屋王而触碰到了最高的权力。

是天谴吗？即使修缮寺庙积德行善，藤原四兄弟最终覆灭在了天花之下。

## 题目描述

环环相扣的因果报应可看成平面上的 $n$ 个小正方形，它们的边长分别为 $1,2,3,\cdots,n$。初始时，编号较小的正方形被编号较大的正方形完全包含：

![](https://cdn.luogu.com.cn/upload/image_hosting/w5f6nucw.png)

为了方便记录正方形的位置，我们取正方形左上角的坐标 $(x_i,y_i)$ 为正方形的坐标。此时可以唯一确定该正方形。

现在需要将最小的正方形的位置移动到 $(x_{\rm end},y_{\rm end})$，移动过程满足：

- 每次**最多移动一个**正方形，可以往上下左右四个方向之一移动一个单位长度。
- 在移动过程中，需要保证**较小正方形会被较大的正方形包含**。

请求出最少次数。

## 说明/提示

### 样例 1 解释

![](https://cdn.luogu.com.cn/upload/image_hosting/dcghf89y.png)

### 数据范围及约定

对于全部数据，$1\le n\le 10^5$，$0\le x_i,y_i,x_{\mathrm{end}},y_{\mathrm{end}}\le 10^9$。

## 样例 #1

### 输入

```
3 2 1
1 0
1 0
0 1
```

### 输出

```
3

```

## 样例 #2

### 输入

```
15 8 4
9 0
9 1
9 1
8 1
8 2
8 3
7 3
6 3
5 3
4 3
3 3
2 4
2 5
1 6
0 7
```

### 输出

```
24
```

# AI分析结果



**唯一算法分类**  
几何

---

**综合分析与结论**  

**题目核心**：求所有正方形调整到覆盖目标点的最少移动次数之和，同时保证移动后各正方形的包含关系。  
**关键思路**：每个正方形的移动独立，只需计算其覆盖目标点的最少步数。调整后的正方形自动满足包含关系。  

**数学推导**：  
- 边长为 `i` 的正方形的坐标 `(x_i, y_i)`，其覆盖的 x 范围为 `[x_i, x_i+i-1]`，y 范围为 `[y_i-i+1, y_i]`。  
- 调整后的正方形必须满足：  
  - `x_i ≤ x_end ≤ x_i+i-1`  
  - `y_i-i+1 ≤ y_end ≤ y_i`  
- **最少移动步数**：  
  - x 方向：若原 `x_i` 超出允许范围，调整到最近端点。  
  - y 方向：类似逻辑。  

**可视化设计**：  
- **Canvas 动画**：  
  1. 绘制初始正方形位置（不同颜色区分大小）。  
  2. 高亮目标点 `(x_end, y_end)`。  
  3. 逐个调整正方形，显示其移动路径（箭头动画）。  
  4. 颜色标记当前处理的正方形和移动步数。  
- **步进控制**：允许用户单步执行，观察每个正方形的调整过程。  
- **复古像素风格**：用 8 位色块表示正方形，音效提示移动完成。  

---

**题解清单 (≥4星)**  

1. **Night_sea_64 (5星)**  
   - **亮点**：代码简洁，直接计算每个正方形的移动步数，逻辑清晰。  
   - **关键代码**：  
     ```cpp
     if (fx < x) cnt += x - fx;
     else if (fx > x + i - 1) cnt += fx - (x + i - 1);
     if (fy < y - i + 1) cnt += (y - i + 1) - fy;
     else if (fy > y) cnt += fy - y;
     ```  

2. **0zhouyq (4星)**  
   - **亮点**：思路解释清晰，强调独立调整的合理性。  
   - **关键代码**：  
     ```cpp
     if (x > ex) ans += (x - ex);
     if (x + i - 1 < ex) ans += (ex - x - i + 1);
     ```  

3. **ダ月 (4星)**  
   - **亮点**：从小到大处理，提前终止调整，优化部分情况。  
   - **关键代码**：  
     ```cpp
     if (x >= a && x <= a + i - 1 && y <= b && y >= b - i + 1) break;
     ```  

---

**最优思路提炼**  

- **独立调整**：每个正方形的移动独立，只需覆盖目标点。  
- **包含关系自动满足**：调整后的坐标范围按边长递减，确保大正方形包含小正方形。  

---

**同类型题推荐**  
1. **P2735 [USACO3.4] 网 Electric Fences**（几何覆盖）  
2. **P2181 对角线**（几何组合计算）  
3. **CF1452C Two Brackets**（区间覆盖思想）  

---

**代码实现（核心逻辑）**  

```cpp
#include <iostream>
using namespace std;

int main() {
    long long n, x_end, y_end, ans = 0;
    cin >> n >> x_end >> y_end;
    for (int i = 1; i <= n; i++) {
        long long x, y;
        cin >> x >> y;
        // x 方向调整
        if (x_end < x) ans += x - x_end;
        else if (x_end > x + i - 1) ans += x_end - (x + i - 1);
        // y 方向调整
        if (y_end > y) ans += y_end - y;
        else if (y_end < y - i + 1) ans += (y - i + 1) - y_end;
    }
    cout << ans;
    return 0;
}
```  

---

**可视化与游戏化设计**  
- **Canvas 绘制**：正方形用渐变颜色填充，目标点闪烁高亮。  
- **音效**：移动时播放“哔”声，完成时播放胜利音效。  
- **自动演示**：模拟贪吃蛇式路径，AI 自动逐步调整并显示总步数。

---
处理用时：374.48秒
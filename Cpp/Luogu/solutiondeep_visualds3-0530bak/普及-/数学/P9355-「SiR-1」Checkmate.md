# 题目信息

# 「SiR-1」Checkmate

## 题目背景

这里本来有一串很长的背景，但是出题人觉得它实在太长了，所以就把它删掉了。

「来吧，游戏开始了。」

## 题目描述

有一个 $n$ 行 $m$ 列的棋盘。你要在这个棋盘上的所有格子**依次**放置一个棋子。

每当你放置一个棋子，你将会获得一定的分数，获得的分数为**放置时**你放置的这个棋子旁边的格子中没有放置棋子的格子的个数。这里「旁边」指的是上、下、左、右的相邻格子。

你想知道，在**按照最优策略决策放置棋子的顺序的情况下**，你最终得分总和的最大值。

## 说明/提示

**本题采用捆绑测试。**

- Subtask 1（20 points）：$n, m \leq 3$，$T \leq 5$。
- Subtask 2（20 points）：$n, m \leq 4$，$T \leq 10$。
- Subtask 3（20 points）：$n=1$。
- Subtask 4（20 points）：$n=m$。
- Subtask 5（20 points）：无特殊限制。

对于所有测试数据，$1 \leq n, m \leq 10^8$，$1 \leq T \leq 10^5$。

## 样例 #1

### 输入

```
4
1 3
2 2
3 4
7 13```

### 输出

```
2
4
17
162```

# AI分析结果



**唯一算法分类**  
组合数学

---

### **题解思路与解决难点**  
**核心思路**：  
题目要求计算棋盘放置棋子得分最大值，关键在于发现无论放置顺序如何，总得分等于相邻格子对数。每个相邻对贡献1分，最终结果由横向和纵向相邻对数之和决定。

**数学推导**：  
- **横向相邻对**：每行有`m-1`对，共`n`行 → `n*(m-1)`  
- **纵向相邻对**：每列有`n-1`对，共`m`列 → `m*(n-1)`  
- **总对数**：`n*(m-1) + m*(n-1) = 2nm -n -m`

**解决难点**：  
部分题解尝试复杂分类（角、边、中心），但最终公式统一为上述结果。关键突破在于发现相邻对贡献与顺序无关，直接计数即可。

---

### **题解评分 (≥4星)**  
1. **zhlzt (5星)**  
   - 思路：直接推导总相邻对数，代码极简  
   - 亮点：公式一步到位，时间复杂度O(1)  
   - 代码：`printf("%lld\n",2*n*m-n-m);`

2. **251Sec (5星)**  
   - 思路：通过观察得出顺序无关性，数学证明清晰  
   - 亮点：深入分析相邻对贡献机制  
   - 代码：同zhlzt，公式直接计算

3. **irris (4星)**  
   - 思路：分离贡献思想，强调组合数学本质  
   - 亮点：结合比赛其他题目，扩展思维  
   - 代码：同zhlzt

---

### **最优思路提炼**  
**关键技巧**：  
- **相邻对计数**：将问题转化为统计棋盘相邻格子对数，避免复杂策略分析。  
- **统一公式**：`2nm -n -m`适用于所有`n,m ≥1`，无需特判边界。  

**代码实现核心**：  
```cpp
printf("%lld\n", 2 * n * m - n - m);
```

---

### **同类型题与算法套路**  
**常见套路**：  
- **网格相邻计数**：如路径问题中相邻移动步数统计。  
- **组合简化**：将复杂过程转化为数学公式（如排列组合、对称性分析）。  

**推荐题目**：  
1. [P9133 THUPC 2023 初赛 大富翁](https://www.luogu.com.cn/problem/P9133)  
2. [P1357 棋盘覆盖](https://www.luogu.com.cn/problem/P1357)  
3. [P1219 八皇后](https://www.luogu.com.cn/problem/P1219)  

---

### **个人心得摘录**  
- **printfmingren**：通过打表发现等差数列规律，最终统一公式。  
- **2011FYCCCTA**：从暴力打表转向数学推导，强调观察数据规律的重要性。  

---

### **可视化与算法演示**  
**动画设计**：  
1. **棋盘绘制**：用Canvas绘制`n×m`网格，不同颜色标记横向/纵向相邻对。  
2. **动态计数**：  
   - **横向高亮**：红色标记每行的`m-1`对，累计显示`n*(m-1)`。  
   - **纵向高亮**：蓝色标记每列的`n-1`对，累计显示`m*(n-1)`。  
   - **公式显示**：实时更新`2nm -n -m`计算结果。  

**复古游戏化效果**：  
- **8位像素风格**：棋盘用16色像素块，计数过程伴随FC音效。  
- **自动演示**：按空格键逐步显示相邻对计数，背景播放《超级玛丽》风格音乐。  

**交互控制**：  
- **速度调节**：滑动条控制高亮动画速度。  
- **单步执行**：按→键分步显示横向/纵向计数。  

```javascript
// 伪代码示例：Canvas绘制相邻对
ctx.fillStyle = '#FF0000'; // 横向红色
for (let i = 0; i < n; i++) {
  for (let j = 0; j < m-1; j++) {
    drawHorizontalPair(i, j); // 绘制横向相邻对
  }
}

ctx.fillStyle = '#0000FF'; // 纵向蓝色
for (let j = 0; j < m; j++) {
  for (let i = 0; i < n-1; i++) {
    drawVerticalPair(i, j); // 绘制纵向相邻对
  }
}
```

---
处理用时：69.99秒
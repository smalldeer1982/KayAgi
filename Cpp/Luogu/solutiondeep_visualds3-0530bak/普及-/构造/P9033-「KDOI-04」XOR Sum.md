# 题目信息

# 「KDOI-04」XOR Sum

## 题目背景

凯文一眼秒了这题。

![](https://cdn.luogu.com.cn/upload/image_hosting/lh1xvu75.png)

## 题目描述

给定一个正整数 $n$，请构造一个长度为 $n$ 的**非负整数**序列 $a_1,a_2,\dots,a_n$，满足：

+ 对于所有 $1\le i\le n$，都有 $0\le a_i\le m$。
+ $a_1\oplus a_2\oplus\dots\oplus a_n=k$。其中 $\oplus$ 表示[按位异或](https://baike.baidu.com/item/%E5%BC%82%E6%88%96/10993677)运算。

或者判断不存在这样的序列。

## 说明/提示

**【样例解释】**

对于第 $1$ 组测试数据，有且仅有一个序列满足条件。

对于第 $2$ 组测试数据，由于 $4\oplus 7=3$ 且 $4,7\le10$，所以这是一个合法的答案。同样地，序列 $(2,1)$ 也是一个合法的答案。

对于第 $4$ 组测试数据，可以证明不存在满足要求的序列。

**【数据范围】**

记 $\sum n$ 为单个测试点中所有 $n$ 的值之和。

对于所有测试数据，保证 $1\le T\le 1~000$，$1\le n\le 2\cdot10^5$，$0\le m,k\le 10^8$，$\sum n\le 2\cdot10^5$。

**【子任务】**

**本题开启捆绑测试。**

+ Subtask 1 (18 pts)：$k\le m$。
+ Subtask 2 (82 pts)：没有额外的约束条件。

## 样例 #1

### 输入

```
5
1 2 2
2 3 10
2 11 8
20 200000 99999
11 191 9810```

### 输出

```
2 
4 7 
8 3 
-1
191 191 191 191 191 191 191 191 191 191 191 ```

# AI分析结果



---

## 算法分类
位运算、构造

---

## 题解思路与难点对比

### 核心思路
1. **无解条件**：当 `k` 的二进制位数大于 `m` 时，无法构造（异或无法进位）。
2. **直接构造**：当 `k ≤ m`，构造 `k` 后补 `n-1` 个 `0`。
3. **拆分策略**：当 `k > m` 且位数相等时，构造两数 `a = m` 和 `b = k ^ m`，其余补 `0`（需 `n ≥ 2`）。

### 关键难点
1. **正确拆分保证合法性**：需确保 `a` 和 `b` 均不超过 `m`，通过异或性质保证 `k ^ m ≤ m`。
2. **高效实现**：避免逐位分解或暴力搜索，直接利用位运算特性构造。

---

## 题解评分 (≥4星)

1. **作者：_determination_ (5星)**  
   - **亮点**：直接使用 `m` 和 `k ^ m` 构造，代码简洁高效。正确性通过异或性质保证。
   - **代码**：  
     ```cpp
     if ((m ^ k) <= m && n > 1) {
         cout << m << ' ' << (m ^ k) << ' ';
         // 其余补0
     }
     ```

2. **作者：Clarinet (5星)**  
   - **亮点**：清晰判断二进制位数，通过 `k ^ m` 构造，逻辑直观。
   - **代码片段**：  
     ```cpp
     if (k > m && n >= 2) {
         cout << m << ' ' << (k ^ m) << ' ';
         // 其余补0
     }
     ```

3. **作者：JuRuoOIer (4星)**  
   - **亮点**：拆分最高位构造，正确但实现稍复杂。
   - **代码核心**：  
     ```cpp
     ll high_bit = 1ll << (log2(k) - 1);
     cout << high_bit << ' ' << (k - high_bit) << ' ';
     ```

---

## 最优思路提炼
- **核心技巧**：利用 `a ^ b = k` 的对称性，构造 `a = m` 和 `b = k ^ m`，确保两者均不超限。
- **位运算优化**：直接通过二进制位数比较和异或运算，避免逐位分解。

---

## 同类型题推荐
1. **洛谷 P7072 [CSP-J2020] 直播获奖**  
   - 考察构造与位运算思维，需快速判断合法条件。
2. **洛谷 P2114 [NOI2014] 起床困难综合症**  
   - 结合位运算构造最优解，强化位操作策略。
3. **洛谷 P6102 [EER1] 出言不逊**  
   - 构造特定异或序列，需灵活应用位分解技巧。

---

## 可视化与算法演示

### 动画设计
1. **二进制对比视图**：  
   - 展示 `k` 和 `m` 的二进制位，高亮不同位数判断无解。
2. **异或构造过程**：  
   - 动态拆解 `k` 为 `m` 和 `k ^ m`，展示异或结果等于 `k` 的过程。
3. **像素风格动态演示**：  
   - **颜色标记**：红色表示 `m`，绿色表示 `k ^ m`，黄色高亮异或结果。
   - **音效提示**：成功构造时播放上扬音效，无解时短促提示。

### 交互控制
- **步进执行**：单步观察二进制位对比与构造过程。
- **自动播放**：模拟算法决策流程，展示关键步骤。

---

## 代码实现（核心逻辑）
```cpp
#include <iostream>
using namespace std;

int bit_length(int x) {
    return x ? 32 - __builtin_clz(x) : 0;
}

int main() {
    int T, n, k, m;
    cin >> T;
    while (T--) {
        cin >> n >> k >> m;
        int k_bit = bit_length(k), m_bit = bit_length(m);
        if (k_bit > m_bit) {
            cout << "-1\n";
            continue;
        }
        if (k <= m) {
            cout << k;
            for (int i = 1; i < n; ++i) cout << " 0";
            cout << "\n";
        } else {
            if (n < 2) cout << "-1\n";
            else {
                cout << m << " " << (k ^ m);
                for (int i = 2; i < n; ++i) cout << " 0";
                cout << "\n";
            }
        }
    }
    return 0;
}
```

---

## 个人心得摘录
- **调试关键**：验证 `k ^ m ≤ m` 时，需确保两数二进制位数相同，避免遗漏边界条件。
- **思维突破**：从异或对称性切入，避免复杂分解，直接构造合法对。

---
处理用时：263.74秒
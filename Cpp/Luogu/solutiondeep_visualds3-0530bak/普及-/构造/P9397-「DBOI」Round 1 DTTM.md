# 题目信息

# 「DBOI」Round 1 DTTM

## 题目背景

张则雨和穆制程坐在天台上看着满天的星辰。在他们的世界，流行一种连接星星的活动。他们对此有一种浪漫的诠释：如果连不完，剩下的一颗星星就是身旁的人；如果连得完，那身边的人和自己都是星星。

## 题目描述

星空中有 $n$ 颗星星，第 $i$ 颗位于坐标 $(x_i,y_i)$。你需要把星星连接成满足张则雨的如下需求：

- 每一颗星星都是且仅是一条线段的端点，所有线段互不相交（包括端点）。
- 所有线段左右端点 $|x_l-x_r|$ 之和有最小值。 

然而张则雨有点笨，并不知道应该怎么连。穆制程知道你是地球上最聪明的人，于是告诉你 $n$ 颗星星的坐标，你需要输出连接方案或者报告无解。

## 说明/提示

样例 1 的方案如图：

![](https://s1.ax1x.com/2023/04/06/ppomH5q.png)

样例 2 的方案如图：

![](https://s1.ax1x.com/2023/04/06/ppomDDH.png)

**本题使用捆绑测试与子任务依赖。**

| $\rm Subtask$ | $n\leqslant$ | $(x,y)$ | 特殊性质 | 得分 | 子任务依赖 |
| :-----------: | :-----------: | :-----------: | :-----------: | :-----------: | :-----------: |
| $1$ | $10$ | $0\leqslant x,y\leqslant 20$ | 无 | $10$ | 无 |
| $2$ | $10^3$ | $0\leqslant x,y\leqslant10^3$ | 无 | $15$ | $1$ |
| $3$ | $10^3$ | $0\leqslant x,y\leqslant10^9$ | 无 | $15$ | $1,2$ |
| $4$ | $5\times10^5$ |$-10^9\leqslant x,y\leqslant10^9$  | $A$ | $5$ | 无 |
| $5$ | $5\times10^5$ | $-10^3\leqslant x,y\leqslant10^3$ | 无 | $20$ | $1,2$
| $6$ | $5\times10^5$ | $-10^9\leqslant x,y\leqslant10^9$ | 无 | $35$ | $1,2,3,4,5$


特殊性质 $A$：满足所有 $x_i$ 都相等。

保证对于 $100\%$ 的数据，$1\leqslant n\leqslant5\times 10^5$，$0\leqslant|x|,|y|\leqslant 10^9$ 且对于任意 $i\ne j$，有 $(x_i,y_i)\neq (x_j,y_j)$。

## 样例 #1

### 输入

```
4
1 3
2 2
2 1
3 4```

### 输出

```
2
1 4
2 3```

## 样例 #2

### 输入

```
6
1 5
2 3
2 4
2 5
2 -1
3 -3```

### 输出

```
2
1 3
4 6
2 5```

# AI分析结果



**算法分类**  
贪心

---

**题解思路、算法要点与解决难点**  
1. **关键思路**：将星星按x坐标排序（x相同时按y排序），相邻两两配对。这保证了线段不相交且|x_l - x_r|之和最小。
2. **正确性证明**：排序后相邻线段的x范围严格递增，不会交叉；同一x坐标下相邻配对的垂直线段互不重叠。
3. **实现核心**：
   - 排序后直接相邻配对，时间复杂度O(n log n)。
   - 处理无解条件（n为奇数）。
4. **难点解决**：通过严格的数学证明和举例分析，验证了相邻配对策略的最优性和正确性。

---

**题解评分 (≥4星)**  
1. **wmrqwq（4星）**：代码简洁，思路清晰，直接排序配对。
2. **Shunpower（4星）**：出题人题解，处理奇数组情况更普适，适用于复杂场景。
3. **回声之歌（4星）**：结合反证法证明线段不相交，逻辑严密。

---

**最优思路或技巧提炼**  
- **排序策略**：以x为第一关键字、y为第二关键字排序，确保相邻配对无交点。
- **贪心最优性**：相邻配对使得每对|x_l - x_r|最小，总和自然最小。
- **无解条件**：n为奇数时直接返回-1。

---

**同类型题或算法套路**  
- **区间不重叠配对**：如活动选择问题，通过排序保证无冲突。
- **贪心排序后操作**：类似任务调度、线段覆盖等问题。

---

**推荐相似题目**  
1. P1230 智力大冲浪（贪心排序选择任务）
2. P1106 配对（最小化差值之和）
3. P1803 线段覆盖（选择不重叠线段）

---

**个人心得摘录**  
- 部分题解因排序运算符重载错误导致低分，提醒注意多关键字排序的细节。
- 反证法验证相邻配对不会相交，加深了对贪心策略的理解。

---

**可视化与算法演示**  
1. **动画设计**：
   - 初始界面：散点图展示无序星星。
   - 排序过程：动态展示按x和y排序后的星星排列。
   - 配对过程：用不同颜色标记相邻配对线段，逐步显示|x差|的累加。
2. **交互功能**：
   - 速度调节：控制排序和配对动画速度。
   - 单步执行：观察每一步配对细节。
3. **复古像素风格**：
   - 用8位色块表示星星，线段用像素点连接。
   - 音效：配对成功时播放短促“滴”声，无解时播放低沉音效。

---

**代码片段（核心逻辑）**  
```cpp
struct Node {
    int x, y, id;
} a[MAXN];

bool cmp(Node a, Node b) {
    if (a.x != b.x) return a.x < b.x;
    return a.y < b.y;
}

int main() {
    if (n % 2) cout << -1;
    sort(a, a + n, cmp);
    for (int i = 0; i < n; i += 2) {
        sum += a[i+1].x - a[i].x;
        cout << a[i].id << " " << a[i+1].id << endl;
    }
}
```

---

**可视化设计要点**  
- **Canvas绘制**：网格背景，星星用色块表示，线段用渐变色连线。
- **自动演示**：按排序顺序逐步连线，高亮当前配对点。
- **音效触发**：每次配对播放音效，背景音乐用8位循环旋律。

---
处理用时：267.05秒
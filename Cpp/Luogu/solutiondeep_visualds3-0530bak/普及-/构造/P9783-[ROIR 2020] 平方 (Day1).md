# 题目信息

# [ROIR 2020] 平方 (Day1)

## 题目描述

**译自 [ROIR 2020](http://neerc.ifmo.ru/school/archive/2019-2020.html) Day1 T1.** ***[Разность квадратов](http://neerc.ifmo.ru/school/archive/2019-2020/ru-olymp-regional-2020-day1.pdf)，译者 ShineEternal***

你参与了字符计算系统软件模块的开发，将用于求解一类特殊的丢番图方程，具体内容如下：

给定一个非负整数 $n$，正在开发的模块需要找到两个正整数 $x$ 和 $y$，使得 $x^2-y^2=n$，其中 $x,y$ 不超过 $2^{62}-1$。

你需要编写一个程序，对于给定的非负整数 $n$，求出两个自然数 $x$ 和 $y$，使得它们都不超过 $2^{62}-1$ 且其平方差为 $n$。

## 说明/提示

对于 $100\%$ 的数据，$0\le n\le 2^{60}$。

| 任务编号 |          $n$           | 分值 |
| :------: | :--------------------: | :--: |
|   $1$    | $0 \leq n \leq 2^{10}$ | $10$ |
|   $2$    | $0 \leq n \leq 2^{20}$ | $20$ |
|   $3$    | $0 \leq n \leq 2^{30}$ | $30$ |
|   $4$    | $0 \leq n \leq 2^{60}$ | $40$ |



## 样例 #1

### 输入

```
3```

### 输出

```
Yes
2 1```

## 样例 #2

### 输入

```
2```

### 输出

```
No```

# AI分析结果



### 唯一算法分类
数学（数论）

---

### 题解思路、算法要点与解决难点

**核心思路**  
基于平方差公式 $x^2-y^2=(x+y)(x-y)=n$，通过分析因子的奇偶性得出解的条件：  
1. **奇数**：$n$ 可拆为两个奇数的乘积，构造 $x=(n+1)/2,\ y=(n-1)/2$（需特判 $n=1$ 导致 $y=0$）  
2. **4 的倍数**：$n$ 可拆为两个偶数的乘积，构造 $x=(n/4+1),\ y=(n/4-1)$（需特判 $n=4$ 导致 $y=0$）  
3. **其他偶数**：无解  

**解决难点**  
1. 特判边界值 $n=0,1,4$  
2. 推导奇偶性对因子分解的影响  
3. 证明非 4 倍数的偶数无法分解  

---

### 题解评分（≥4星）

#### 1. 作者：cff_0102（★★★★☆）  
- **亮点**：逻辑清晰，完整覆盖所有情况，代码简洁  
- **关键代码**：  
  ```cpp
  if(n%4==2) cout<<"No"; // 快速排除非4倍数的偶数
  ```

#### 2. 作者：Vct14（★★★★★）  
- **亮点**：严格处理特判条件，数学推导完整  
- **关键代码**：  
  ```cpp
  else if(n%4==0&&n!=4) // 精确排除n=4的特殊情况
  ```

#### 3. 作者：_O_v_O_（★★★★☆）  
- **亮点**：代码可读性强，变量命名规范  
- **心得摘录**：  
  > "当 $n$ 为奇数时，答案就为 $(n\div2+1)^2-(n\div2)^2$，但需注意 $y$ 不能为负数"

---

### 最优思路与技巧提炼

**关键步骤**  
1. **特判**：优先处理 $n=0,1,4$  
2. **奇偶分类**：  
   - 奇数 $\rightarrow$ 拆为 $(n,1)$  
   - 4 的倍数 $\rightarrow$ 拆为 $(n/2,2)$  
3. **解的存在性**：非 4 倍数的偶数直接判否  

**代码优化技巧**  
- 用位运算 `n%4==2` 代替 `n%2==0 && n%4!=0`  
- 直接计算解而非枚举因子  

---

### 同类型题推荐
1. **P1214 等差数列**：平方差公式的变形应用  
2. **P2426 砝码称重**：数学建模与奇偶分析  
3. **P1495 曹冲养猪**：同余与因子分解  

---

### 可视化与算法演示

**动画方案**  
```html
<div id="animation-container">
  <canvas id="pixel-canvas"></canvas>
  <div class="control-panel">
    <button onclick="prevStep()">← 上一步</button>
    <button onclick="nextStep()">下一步 →</button>
    <span>当前状态：<span id="status">n=3</span></span>
  </div>
</div>
```

**可视化逻辑**  
1. **像素风格**：  
   - 用 8x8 像素块表示数字，红色表示奇数，蓝色表示偶数  
   - 分解过程用绿色高亮当前因子  
2. **步进演示**：  
   - 第 1 帧：显示原始 n 的像素表示  
   - 第 2 帧：检查奇偶性，显示对应颜色  
   - 第 3 帧：根据分类显示分解后的因子对  
   - 第 4 帧：计算 x 和 y 的值  

**音效设计**  
- 分解成功：8-bit 上扬音效（Web Audio API）  
- 分解失败：短促“哔”声  

---

### 核心代码实现

**数学判断逻辑（C++）**  
```cpp
if(n == 0) cout << "Yes\n114514 114514";
else if(n == 1 || n == 4) cout << "No";
else if(n % 2 == 1) cout << "Yes\n" << (n+1)/2 << " " << (n-1)/2;
else if(n % 4 == 0) cout << "Yes\n" << n/4+1 << " " << n/4-1;
else cout << "No";
```

**像素动画关键代码（JavaScript）**  
```javascript
function drawPixelNumber(ctx, num, x, y, color) {
  const bits = num.toString(2).padStart(8, '0');
  for(let i=0; i<8; i++) {
    for(let j=0; j<8; j++) {
      if(bits[i*8+j] === '1') {
        ctx.fillStyle = color;
        ctx.fillRect(x+j*4, y+i*4, 4, 4);
      }
    }
  }
}
```

---
处理用时：115.51秒
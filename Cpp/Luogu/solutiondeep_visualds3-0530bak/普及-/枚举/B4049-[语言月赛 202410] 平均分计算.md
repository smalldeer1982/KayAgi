# 题目信息

# [语言月赛 202410] 平均分计算

## 题目描述

小 Y 所在的大学提供了 $n$ 门课程，第 $i$ 门课程有 $p_i$ 人报名，学号依次为 $id_{i,1},id_{i,2},\ldots,id_{i,p_i}$（保证不重复）。

按照学号从小到大的顺序，所有同学的**课堂参与度**依次是 $sc_{i,1},sc_{i,2},\ldots, sc_{i,p_i}$（学号最小的同学课堂参与度为 $sc_{i,1}$，以此类推）。

这门课的老师决定给该课程**课堂参与度**排名第 $j$ 的同学 $w_{i,j}$ 分。自然地，课堂参与度更高的人，得分也会更高。

本题中“排名”定义为“比自己大的数字个数 $+1$”，如 $30,30,10,20,50$ 中，两个 $30$ 的排名都是第 $2$。

给出小 Y 的学号 $ID$，请计算她**报名了的课程**的**平均分数**。如果平均分数是整数，那么直接输出，否则以 $a\texttt{+}b\texttt{/}c$ 的形式输出，其中 $a$ 为自然数，且 $\dfrac{b}{c}$ 是最简真分数。

## 说明/提示

【样例 1 解释】

第一门课程有 $3$ 人报名，学号分别为 $300,100,200$。按照学号从小到大的顺序，三人的课堂参与度为 $20,10,30$，这也就意味着：
- 学号为 $100$ 的同学课堂参与度为 $20$，课堂参与度排第 $2$ 名，获得 $85$ 分。
- 学号为 $200$ 的同学课堂参与度为 $10$，课堂参与度排第 $3$ 名，获得 $75$ 分。
- 学号为 $300$ 的同学课堂参与度为 $30$，课堂参与度排第 $1$ 名，获得 $95$ 分。

第二门课程有 $1$ 人报名，学号为 $300$，课堂参与度为 $200$，老师给他 $200$ 分。

小 Y 的学号为 $200$，在第一门课程中获得 $75$ 分，而他仅报名了这门课程，因此平均分就是 $75$。

【样例 2 解释】

学校提供了 $4$ 门课，都只有一个学号为 $1$ 的同学报名，课堂参与度均为 $1$，其中，第 $1,3$ 门课的老师给了他 $1$ 分，第 $2,4$ 门课的老师给了他 $2$ 分。

小 Y 就是这个学号为 $1$ 的同学，因此，他的平均分就是 $\dfrac{1+2+1+2}{4}=1\dfrac{1}{2}$，输出 `1+1/2`。

【数据范围】

对于全体数据，保证 $1\le n\le 40$，$1\le p_i\le 100$，$1\le id_{i,j},ID\le 10^9$，$1\le sc_{i,j},w_{i,j}\le 430$，且保证小 Y 报名了至少一门课。

同时保证同一门课中课堂参与度高的同学得分也高，也就是任取 $1\le i\le n$，任取 $1\le j \le k\le p_i$，有 $w_{i,j}\ge w_{i,k}$。

本题共有 $10$ 个测试点，每个 $10$ 分。下面给出各个测试点的情况，其中 `Y` 表示保证测试点有这个性质，`N` 表示不保证。

|测试点编号|特殊性质 A|特殊性质 B|特殊性质 C|
|:-:|:-:|:-:|:-:|
|$1$|Y|Y|Y|
|$2$|Y|N|Y|
|$3$|Y|N|N|
|$4$|N|Y|Y|
|$5$|N|N|Y|
|$6$|N|Y|N|
|$7\sim 10$|N|N|N|

- 特殊性质 A：保证小 Y 如果报名了一门课程，他一定是课堂参与度最高的。
- 特殊性质 B：保证小 Y 上了所有课。
- 特殊性质 C：保证答案是整数。

## 样例 #1

### 输入

```
2
3
300 100 200
20 10 30
95 85 75
1
300
200
200
200
```

### 输出

```
75
```

## 样例 #2

### 输入

```
4
1
1
1
1
1
1
1
2
1
1
1
1
1
1
1
2
1
```

### 输出

```
1+1/2
```

# AI分析结果



---

### **唯一算法分类**
模拟

---

### **综合分析与结论**

**核心思路**  
该题需模拟题目描述的评分过程，关键在于正确计算小 Y 在各课程的学号排名与参与度排名，并处理分数格式。题解通过两次线性扫描避免排序，利用计数代替排序，极大简化了代码。

**难点解析**  
1. **学号与参与度的顺序处理**  
   - 输入的学号列表未排序，但参与度数组 `sc` 的顺序是按学号升序排列后的结果。题解通过统计学号列表中 `<= ID` 的个数，直接确定 `sc` 中的对应位置，无需显式排序。
2. **参与度排名计算**  
   - 遍历所有参与度，统计比当前值大的个数，直接计算排名。处理并列时严格遵循题目定义。
3. **分数约分与输出**  
   - 使用最大公约数（GCD）简化分数，确保输出格式正确。

**可视化设计要点**  
- **步骤分步高亮**：以像素动画展示学号遍历、参与度比较、得分累加等关键步骤，用颜色区分当前操作。
- **音效与反馈**：找到学号时播放确认音效，计算排名时用不同音调表示比较结果。
- **自动演示模式**：按步骤自动执行，展示算法流程，适合初次理解题目逻辑。

---

### **题解清单（4星）**

1. **yummy 的题解（4星）**  
   - **亮点**  
     - 利用两次线性扫描替代排序，时间复杂度为 O(n·p)，效率较高。  
     - 变量命名与题目输入对应，减少理解成本。  
   - **优化建议**  
     - 使用欧几里得算法优化 GCD 计算。  
     - 可提取学号排名与参与度排名为单独函数，提升可读性。

---

### **核心代码实现**

```cpp
#include <cstdio>
int n, p[45], ID;
int id[45][105], sc[45][105], w[45][105];

int main() {
    scanf("%d", &n);
    for (int i = 1; i <= n; i++) {
        scanf("%d", &p[i]);
        for (int j = 1; j <= p[i]; j++) scanf("%d", &id[i][j]);
        for (int j = 1; j <= p[i]; j++) scanf("%d", &sc[i][j]);
        for (int j = 1; j <= p[i]; j++) scanf("%d", &w[i][j]);
    }
    scanf("%d", &ID);

    int sums = 0, sumc = 0;
    for (int i = 1; i <= n; i++) {
        int rkid = 0, sign = 0;
        for (int j = 1; j <= p[i]; j++) {
            if (id[i][j] == ID) sign = 1;
            if (id[i][j] <= ID) rkid++;
        }
        if (!sign) continue;

        int act = sc[i][rkid], rkact = 1;
        for (int j = 1; j <= p[i]; j++)
            if (sc[i][j] > act) rkact++;
        sums += w[i][rkact];
        sumc++;
    }

    int a = sums / sumc, b = sums % sumc, c = sumc;
    if (b == 0) printf("%d\n", a);
    else {
        int gcd = 1;
        for (int i = 1; i <= b; i++)
            if (b % i == 0 && c % i == 0) gcd = i;
        printf("%d+%d/%d\n", a, b / gcd, c / gcd);
    }
    return 0;
}
```

---

### **同类型题推荐**

1. **P1177 【模板】快速排序**  
   - 练习排序基础，理解学号顺序处理。
2. **P1068 [NOIP2009 普及组] 分数线划定**  
   - 类似排名计算，处理并列情况。
3. **P1781 宇宙总统**  
   - 统计最大值位置，强化线性扫描思维。

---

### **可视化算法演示**

**动画逻辑**  
1. **学号遍历阶段**  
   - 学号列表显示为像素块，逐个高亮检查是否等于或小于 `ID`，统计 `rkid`。
2. **参与度比较阶段**  
   - 参与度数组显示为柱状图，当前参与度用红色标记，其他大于的用绿色。
3. **得分累加与格式处理**  
   - 总分和课程数以动态数字更新，约分过程展示分子分母变化。

**复古风格实现**  
- **像素绘制**：用 Canvas 绘制学号列表和参与度数组，8-bit 字体显示数值。
- **音效设计**：找到学号时播放“滴”声，得分累加时播放金币音效。
- **自动模式**：按步骤间隔 1 秒自动执行，支持暂停/继续。

---
处理用时：266.51秒
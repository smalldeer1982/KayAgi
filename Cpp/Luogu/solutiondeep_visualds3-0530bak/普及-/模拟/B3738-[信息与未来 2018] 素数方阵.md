# 题目信息

# [信息与未来 2018] 素数方阵

## 题目描述

把前 $n^2$ 个素数从左上角开始按右、下、左、上、右、下、左、上……的顺序填入 $n×n$ 的方阵就得到了蛇形素数方阵。以下是 $n = 4$ 和 $n = 5$ 的蛇形素数方阵：

![](https://cdn.luogu.com.cn/upload/image_hosting/sgevwlzo.png)

给出 $n$，你的任务是求出 $n × n$ 的蛇形素数方阵，并输出其中某个方格中的数值。

素数，又称质数，是指除 $1$ 和其自身之外，没有其他约数的大于 $1$ 的正整数。

## 说明/提示

### 样例解释
参考上图 $n = 5$。
### 数据规模
所有数据满足 $1 ≤ x,y\le n ≤ 20$。

> 本题原始满分为 $15\text{pts}$。

## 样例 #1

### 输入

```
5 1 4```

### 输出

```
7```

## 样例 #2

### 输入

```
5 4 3```

### 输出

```
79```

# AI分析结果



---

## 算法分类
**模拟**

## 综合分析与结论

### 核心思路与算法流程
1. **生成前n²个素数**：逐个判断自然数是否为素数，直到收集足够数量。
2. **模拟蛇形填充**：
   - 使用方向数组 `(右, 下, 左, 上)` 循环切换方向。
   - 沿当前方向移动，若无法继续则切换方向，直到填满所有位置。
3. **坐标转换**：将输入的1-based坐标转换为0-based索引。

### 难点与解决
- **素数生成效率**：采用试除法逐个生成，虽非最优但足够应对n≤20的数据规模。
- **方向控制逻辑**：通过循环尝试四个方向确保路径正确，避免死循环。
- **边界处理**：每次移动前检查坐标是否越界及是否已填充。

### 可视化设计思路
- **网格动画**：在Canvas上绘制n×n网格，高亮当前填充位置与方向箭头。
- **方向切换提示**：当方向改变时，以不同颜色显示新方向。
- **像素风格**：采用8-bit配色，每步填充伴随复古音效。

---

## 题解评分（4星）
**关键亮点**：
1. 方向切换逻辑简洁高效，使用取模运算循环切换。
2. 素数生成与填充完全解耦，模块清晰。
3. 代码可读性强，矩阵填充逻辑直观。

---

## 核心代码实现
```python
def generate_primes(n_squared):
    primes = []
    num = 2
    while len(primes) < n_squared:
        is_prime = True
        for p in primes:
            if p * p > num:
                break
            if num % p == 0:
                is_prime = False
                break
        if is_prime:
            primes.append(num)
        num += 1
    return primes

n, x, y = map(int, input().split())
n_squared = n * n
primes = generate_primes(n_squared)
matrix = [[0] * n for _ in range(n)]
directions = [(0, 1), (1, 0), (0, -1), (-1, 0)]
current_dir = 0
current_x, current_y = 0, 0
matrix[current_x][current_y] = primes[0]

for i in range(1, n_squared):
    while True:
        dx, dy = directions[current_dir]
        nx, ny = current_x + dx, current_y + dy
        if 0 <= nx < n and 0 <= ny < n and matrix[nx][ny] == 0:
            current_x, current_y = nx, ny
            matrix[current_x][current_y] = primes[i]
            break
        else:
            current_dir = (current_dir + 1) % 4

print(matrix[x-1][y-1])
```

---

## 相似题目推荐
1. **P5731 蛇形方阵** - 基础填充逻辑训练
2. **P1304 数字螺旋** - 方向控制与矩阵填充
3. **P1217 回文质数** - 结合素数生成与特殊结构

---
处理用时：247.24秒
# 题目信息

# yyy2015c01 的 IDE 之 Call Stack

## 题目背景

在 2020 年的某一天，我们的 yyy2015c01 同学想要开发一套 IDE。


## 题目描述

作为他开发团队中的一员，你不幸地 yyy2015c01 被选入了 Debugger 的开发组。

yyy2015c01 设想的 Debugger 由几部分组成，其中的一个小组件就是 Call Stack——中文称之为 “调用栈”。

由于 IDE 目前还是内测版，开发组需要先编一个能识别参数表的 Call Stack 来看看效果如何。这个任务交由你来完成。

开发组假想的 Call Stack 能实现识别 `int` 和 `char` 参数表，以辨别出不同的函数，规则是：

```
int fac1(int n);
```

和

```
int fac1(char n);
```

是两个不同的函数；但

```
int Fac1(int n,int m);
```

和

```
int FAC1(int x,int y);
```

被认为是相同的函数。也就是说，这个 Call Stack 认的不是参数名，而是其类型和忽略大小写的函数名。

注意：`int main()` 可能会出现，也可能不出现；无论它有没有出现，都不能将其算入函数中。

请你编写一个 Call Stack，并在所有函数调用完后输出这个程序一共有多少个不完全相同的函数（保证程序中的每个函数至少调用一次）。


## 说明/提示

每个函数的参数最多有 $10$ 个，每行的输入数据长度均不超过 $255$。

向本题主人公 yyy2015c01 同学致敬！


## 样例 #1

### 输入

```
2
FAC1 (N=233, M=65 'A', A=0)
main ()
```

### 输出

```
1
```

## 样例 #2

### 输入

```
2
fac1 (N=250)
FAC1 (a=987)
```

### 输出

```
1
```

# AI分析结果



---

**算法分类**：模拟、字符串处理

---

### **题解思路与核心难点**

**题目核心**：判断函数是否重复，依据是函数名（忽略大小写）和参数类型（int/char），排除main函数。

**题解思路对比**：
1. **数据结构选择**：多数题解使用`set`或`map`存储函数特征（函数名+参数类型序列），自动去重。
2. **参数解析**：通过检测单引号或等号后的字符判断参数类型。
3. **函数名处理**：统一转为小写或大写后比较。

**解决难点**：
1. **参数解析**：需处理形如`M=65 'A'`的复杂格式，正确识别字符型参数。
2. **高效判重**：手动遍历比较效率低，使用哈希结构（如`set`）更优。
3. **输入处理**：函数名与参数间有空格，需用`getline`读取整行。

---

### **题解评分 (≥4星)**

1. **Alex_Wei (4星)**
   - **亮点**：结构体存储函数特征，手动遍历去重，代码逻辑清晰。
   - **改进点**：参数解析部分可优化为自动检测单引号。

2. **OoXiao_QioO (5星)**
   - **亮点**：函数名+参数类型组合为字符串，直接利用`map`判重，代码简洁高效。
   - **关键代码**：
     ```cpp
     if(s1[i]=='\'') f = 0; // 检测单引号
     x += f ? '1' : '0';    // 生成特征字符串
     ```

3. **zimingsun23 (4星)**
   - **亮点**：使用`set<pair<vector<bool>, string>>`判重，参数类型用`vector<bool>`存储。
   - **优化点**：参数解析通过逐字符读取实现，避免复杂字符串处理。

---

### **最优思路提炼**

1. **特征字符串法**：
   - **函数名**：转为小写后作为字符串前缀。
   - **参数类型**：遍历每个参数，若含单引号则为`char`（记为`0`），否则为`int`（记为`1`），生成如`"fac110"`的字符串。
   - **判重**：将特征字符串存入`set`或`map`，自动去重。

2. **参数解析技巧**：
   - 每个参数的格式为`xxx=value`或`xxx=value 'c'`。
   - **关键点**：在等号后查找单引号，若存在则为`char`型。

---

### **同类型题推荐**

1. **[P1308 统计单词数](https://www.luogu.com.cn/problem/P1308)**：字符串匹配与大小写处理。
2. **[P1598 垂直柱状图](https://www.luogu.com.cn/problem/P1598)**：字符频率统计与格式化输出。
3. **[P1055 ISBN号码](https://www.luogu.com.cn/problem/P1055)**：字符串验证与特殊格式处理。

---

### **个人心得摘录**

- **Alex_Wei**：手动实现大小写转换和字符串比较，强调代码可读性。
- **OoXiao_QioO**：利用`map`简化判重逻辑，“特征字符串”是核心优化点。
- **伏地魔老杨**：通过等号后的字符判断参数类型，避免复杂字符串分割。

---

### **可视化算法设计**

#### **核心算法演示**
1. **输入解析**：
   - **动画**：逐行高亮函数名和参数部分。
   - **颜色标记**：
     - 函数名：绿色（转为小写后高亮）。
     - 参数类型：红色（`char`）或蓝色（`int`）。

2. **特征生成**：
   - **步进显示**：逐个参数解析，生成`0/1`序列并拼接为字符串。
   - **示例**：`FAC1 (N=233, M=65 'A')` → `"fac1" + "10"`。

3. **判重过程**：
   - **集合更新**：显示`set`中插入新特征字符串的过程，重复项标红。
   - **计数器**：右侧显示当前唯一函数数量。

#### **复古像素风格**
- **UI设计**：
  - **函数名**：8-bit像素字体，黄色闪烁。
  - **参数块**：每个参数显示为小方块，`int`为蓝，`char`为红。
  - **背景音乐**：循环播放8-bit风格BGM，插入新函数时播放“叮”音效。

#### **交互功能**
- **速度控制**：滑动条调节动画速度。
- **单步执行**：按空格键逐步解析参数。
- **自动模式**：AI自动解析并高亮关键步骤。

---

### **关键代码片段**

**OoXiao_QioO的判重核心**：
```cpp
string x = to_lower(func_name); // 转为小写
for (char c : params_line) {
    if (c == '\'') x += '0';    // char类型
    else if (c == '=') x += '1';// int类型（需后续判断）
}
if (map[x] == 0) count++;
map[x] = 1;
```

**zimingsun23的参数解析**：
```cpp
bool read_param() {
    char c = getchar();
    bool is_char = false;
    while (c != ',' && c != ')') {
        if (c == '\'') is_char = true;
        c = getchar();
    }
    return is_char; // 返回当前参数类型
}
```

---

**总结**：通过特征字符串和哈希判重，结合高效参数解析，是本题的最优解。可视化设计通过复古风格和交互演示，直观展示算法核心流程。

---
处理用时：90.46秒
# 题目信息

# 「PMOI-1」立方骑士

## 题目背景

lhm 最近迷上了国际象棋，他对里面的骑士最感兴趣，于是就开辟了下面这个玩法。

## 题目描述

lhm 现在建立了一个大小为 $n \times m$ 的国际象棋棋盘，你作为白方要与黑方作战。棋盘上黑方只有一个国王，**国王位置不会移动**，而 lhm 有无穷无尽的骑士。现在你需要解出，最少派出几个骑士才能将死黑方国王，定义将死的标准为**黑方国王在不被吃掉的情况下不能移动为止**。

更形式化地讲：一个 $n\times m$ 的棋盘上有一个国王，你需要摆放尽可能少的骑士在棋盘上，使得对于每一个国王能走**正好一步**达到的且不在棋盘外的位置，都存在至少一个骑士能走**正好一步**达到。

棋子的移动方法：

国王每一步能向上、下、左、右、左上、右上、左下、右下八个方向移动一格。

骑士与国际象棋规则相同，每次可以走日字（即 $2\times3$ 长方形的对角线，详见样例）。**注意没有蹩马腿规则，也就是只要不走出棋盘且按照日字格行走，其他没有限制。**

lhm 太菜了，只好请聪明的你来帮他完成这个任务。

## 说明/提示

【样例1解释】

![](https://cdn.luogu.com.cn/upload/image_hosting/c5d055nl.png)

一个类似上图的棋盘，$\text{K}$ 表示黑方国王，$\text{N}$ 表示白方骑士，$\color{red}{\times}$ 表示骑士可以到达的地方（其中 $(3,3)$ 的 $\text{N}$ 封住了 $(1,2)$ 和 $(2,1)$，$(1,4)$ 的 $\text{N}$ 封住了 $(2,2)$
，形如上图，$\text{K}$ 已经被封死了，所以两个骑士足矣。可以证明两个骑士是最小个数。

【数据范围】

- 对于 $30\%$ 的数据，保证国王的初始位置一定在棋盘最外面一圈。

- 对于 $100\%$ 的数据满足，$1 \leq t \leq 10$，$1 \leq x,y \leq 10^9$，$8 \leq n,m \leq 10^9$。

## 样例 #1

### 输入

```
1
8 8 1 1```

### 输出

```
2```

## 样例 #2

### 输入

```
2
10 9 1 9
999 999 999 2```

### 输出

```
2
3```

# AI分析结果



**唯一算法分类**  
无算法分类（纯数学推导与分类讨论）

---

**综合分析与结论**  
题目核心是根据国王位置判断最少骑士数，关键在于确定其周围可移动格数，并利用每个骑士覆盖两个方向的特性。题解通过分类讨论国王位置（角、边、中间）确定答案，无需复杂算法，直接数学推导即可。  

**可视化设计思路**：  
1. **棋盘绘制**：以像素风格棋盘展示国王位置，高亮其周围可移动格子（绿色）。  
2. **骑士放置动画**：动态展示最优骑士位置（红色），每次放置后标记被覆盖的国王移动方向（变灰）。  
3. **自动演示模式**：按角、边、中间三种情况自动播放，配合8-bit音效提示放置成功。  
4. **颜色标记**：国王（黄色），骑士（红色），覆盖区域（闪烁绿色到灰色过渡）。  

---

**题解清单 (≥4星)**  
1. **樱雪喵（5星）**  
   - 思路清晰，分类明确，代码简洁高效，直接判断位置输出结果。  
2. **HYdroKomide（4星）**  
   - 使用公式 `4 - 相邻边数` 简化判断，代码极短，逻辑直观。  
3. **添哥（4星）**  
   - 提出“骑士数=4-相邻边数”的直观公式，代码实现简洁。  

---

**最优思路与技巧**  
- **核心公式**：答案 = 4 - 国王相邻的边数（角相邻2边→2，边相邻1边→3，中间0边→4）。  
- **分类逻辑**：通过坐标快速判断位置类型，避免复杂计算。  

**关键代码实现**  
```cpp
// 樱雪喵题解核心代码
if ((x是角)) cout << 2;
else if ((x或y在边)) cout << 3;
else cout << 4;
```

---

**同类型题与扩展**  
- **通用解法**：棋盘覆盖问题，利用几何位置快速推导最优解。  
- **类似题目**：  
  1. [洛谷P1219 八皇后](https://www.luogu.com.cn/problem/P1219)（棋盘放置问题）  
  2. [洛谷P3958 奶酪](https://www.luogu.com.cn/problem/P3958)（空间几何与连通性）  
  3. [洛谷P1036 选数](https://www.luogu.com.cn/problem/P1036)（组合数学与判断条件）  

---

**可视化与复古动画方案**  
- **像素棋盘**：用Canvas绘制网格，国王为黄色方块，可移动格子闪烁绿色边框。  
- **骑士放置特效**：点击或自动放置骑士时，红色方块伴随“叮”音效出现，覆盖方向变灰。  
- **自动演示**：按钮切换角/边/中间案例，AI自动放置骑士，背景播放8-bit循环音乐。  
- **音效设计**：  
  - 放置成功：短促“叮”声（Web Audio合成方波）。  
  - 错误操作：低沉“哔”声。  
- **积分系统**：正确完成一次分类+10分，连击正确额外加分。  

```javascript
// 伪代码：Canvas绘制国王与骑士
function drawBoard() {
  ctx.fillStyle = '#2D2D2D'; // 暗色背景
  ctx.fillRect(0, 0, width, height);
  // 绘制国王（黄色）
  ctx.fillStyle = '#FFD700';
  ctx.fillRect(kx*cellSize, ky*cellSize, cellSize, cellSize);
  // 绘制骑士（红色）
  knights.forEach(([x, y]) => {
    ctx.fillStyle = '#FF0000';
    ctx.fillRect(x*cellSize, y*cellSize, cellSize, cellSize);
  });
}
```

---
处理用时：69.64秒
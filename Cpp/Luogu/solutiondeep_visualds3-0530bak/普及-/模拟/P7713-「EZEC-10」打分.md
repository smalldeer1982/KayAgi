# 题目信息

# 「EZEC-10」打分

## 题目背景

**为防止评测机被卡，本题时限为 100 ms。**

## 题目描述

小 A 去参加奥运会。

奥运会中共有 $n$ 名裁判，分别给小 A 打分 $a_1,a_2,\ldots,a_n$。

小 A 对自己的得分不满意，于是他将某名裁判打出的分数加 $1$，称为一次操作。

但是小 A 不能太贪心，他最多只能进行 $m$ 次操作。

小 A 的最终得分为：所有得分中，去掉一个最高分和一个最低分后的平均值。

小 A 想知道，他的最终得分最高为多少。

## 说明/提示

**【样例 1 解释】**

一种可行的方案为：$[1,2,3]\to [3,2,3]$。

**【样例 2 解释】**

一种可行的方案为：$[1,2,2,3]\to [2,3,3,3]$。

**【数据规模与约定】**

**本题采用捆绑测试。**

- Subtask 1（5 points）：$m=0$。
- Subtask 2（10 points）：$n=3$。
- Subtask 3（15 points）：$n,m\le 10^3$。
- Subtask 4（70 points）：无特殊限制。

对于 $100\%$ 的数据，$3\le n\le 10^5$，$0\le m,a_i\le 10^9$。

## 样例 #1

### 输入

```
3 2
1 2 3```

### 输出

```
3```

## 样例 #2

### 输入

```
4 3
1 2 2 3```

### 输出

```
6```

# AI分析结果



**算法分类**  
贪心、数学

**题解思路与难点分析**  
题目要求将m次操作分配到裁判分数中，使得去掉最高分和最低分后的平均值最大。核心思路是贪心策略：优先将中间分数提升至最高分水平，剩余操作均匀分配。

1. **排序与预处理**  
   排序数组后，最低分无需操作。中间分数尽可能加到当前最高分，计算所需总次数S。若m<=S，直接累加操作次数到中间数总和。

2. **剩余操作分配**  
   当m>S时，中间数已全为原最高分。剩余操作需分配给中间数和原最高分。此时，每次操作对总和的贡献为(n-2)/(n-1)（因最高分会被去掉）。数学推导后，总和为均匀分配后的平均贡献。

**关键难点**  
- 处理剩余操作时需避免浮点误差，通过整除和余数处理实现精确计算。
- 确保余数分配时优先增加中间数，避免无效操作分给最高分。

**题解评分（≥4星）**  
1. **BotDand（5星）**  
   精确处理余数分配，通过k和y的计算确保中间数总和最大。代码清晰，数学推导严谨。

2. **Shunpower（4星）**  
   分情况讨论清晰，处理余数时扣减一次避免无效操作，但代码注释较少。

3. **Maxmilite（4星）**  
   数学公式简洁，但未处理余数导致样例错误，需改进。

**最优思路与技巧**  
- **贪心策略**：优先填平中间数与最高分的差距，剩余操作均匀分配。
- **数学优化**：通过整除和余数拆分操作次数，避免浮点运算。
- **余数处理**：余数优先分配给中间数，最后一步分配给最高分避免无效贡献。

**类似题目推荐**  
1. P1223 排队接水（贪心排序）
2. P1094 纪念品分组（双指针贪心）
3. P4995 跳跳！（贪心排序）

**代码实现（BotDand版）**  
```cpp
#include<bits/stdc++.h>
#define int long long
using namespace std;
int n,m;
int a[100002];
int s1,s2;
signed main() {
    n=read(),m=read();
    for(int i=1;i<=n;++i) a[i]=read();
    sort(a+1,a+n+1);
    for(int i=2;i<n;++i) s1+=a[n]-a[i], s2+=a[i];
    if(s1>=m) {cout<<s2+m; return 0;}
    int ans=s1+s2, rem=m-s1;
    int x=rem/(n-1), y=rem%(n-1);
    ans += x*(n-2);
    if(y>0) ans += (y-1);
    cout<<ans;
}
```

**可视化算法设计**  
- **排序与填平阶段**：用颜色区分最低分（红）、中间数（黄）、最高分（绿），动态显示中间数提升至最高分。
- **剩余操作分配**：显示剩余次数拆分为k次均分和y次余数。余数以粒子效果分配到中间数，最后一次变灰（无效）。
- **复古像素动画**：使用Canvas绘制分数柱状图，操作时像素块动态上升，音效随操作触发。背景音乐为8-bit风格循环曲。

---
处理用时：592.12秒
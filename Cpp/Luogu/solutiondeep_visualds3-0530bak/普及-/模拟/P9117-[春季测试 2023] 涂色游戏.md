# 题目信息

# [春季测试 2023] 涂色游戏

## 题目描述

有一天，小 D 在刷朋友圈时看到了一段游戏视频。

这个游戏的名字叫涂色游戏，视频中的游戏界面是一个 $n$ 行 $m$ 列的网格，初始时每一个格子都是白色（用数字 $0$ 表示）。其中每一行的左侧、每一列的上方都有一把带颜色的刷子。玩家点击某个刷子后，这个刷子会将其右侧（或下方）的一整行（或一整列）涂上同一种颜色，**该行（或该列）格子原有的颜色都会被覆盖成新涂上的颜色。**

下图展示的情况可以通过先将第一列涂成红色，然后将第一行涂成蓝色得到，若此时选择将第三列涂成绿色，则图中绿色方框中的格子都会变成绿色。

![](https://cdn.luogu.com.cn/upload/image_hosting/dc71alkw.png)

小 D 想用他自己编写的程序来进行视频中的游戏。在编程的过程中，小 D 在涂色逻辑的实现上却遇到了一些困难，于是他向你求助，希望你能帮他完成实现涂色逻辑部分的代码。

首先，小 D 会给你网格的行数和列数 $n, m$，然后给出 $q$ 次操作，每次操作用三个整数 $opt_i, x_i, c_i$ 表示：

- 如果 $opt_i=0$，那么这次操作会将第 $x_i$ **行**涂成颜色 $c_i$。
- 如果 $opt_i=1$，那么这次操作会将第 $x_i$ **列**涂成颜色 $c_i$。

在所有涂色操作结束以后，你需要输出网格中每个位置的颜色是什么。

## 说明/提示

**【样例 1 解释】**

注意当一个格子没有被涂色时，其颜色为白色，用数字 $0$ 表示。

**【样例 2】**

见选手目录下的 paint/paint2.in 与 paint/paint2.ans。

**【数据范围】**

对于所有数据，保证：

- $1 \leq T \leq 10$，$1 \leq n,m \leq 10^5$，$0 \leq q \leq 10^5$，$0 \leq c_i \leq 10^9$。
- 若 $opt_i=0$，则 $1 \leq x_i \leq n$；若 $opt_i=1$，则 $1 \leq x_i \leq m$。
- 单个测试点中所有数据的 $n \cdot m$ 的总和不超过 $10^6$，$q$ 的总和不超过 $10^6$。

|测试点|$n \le$|$m \le$|$q \le$|性质 A|性质 B|
|:-:|:-:|:-:|:-:|:-:|:-:|
|1|$1$|$1$|$0$|√|√|
|2|$1$|$1$|$1$|√|√|
|3|$1$|$10$|$20$|√|√|
|4|$1$|$10^5$|$10^5$|×|√|
|5|$1$|$10^5$|$10^5$|×|√|
|6|$1$|$10^5$|$10^5$|×|×|
|7|$10$|$10$|$20$|√|√|
|8|$50$|$50$|$100$|√|√|
|9|$50$|$50$|$100$|√|×|
|10|$1000$|$1000$|$2000$|×|√|
|11|$1000$|$1000$|$2000$|×|×|
|12|$1000$|$1000$|$2000$|×|×|
|13|$1000$|$1000$|$10^5$|×|×|
|14|$1000$|$1000$|$10^5$|×|×|
|15|$10^5$|$10^5$|$10^5$|√|√|
|16|$10^5$|$10^5$|$10^5$|√|√|
|17|$10^5$|$10^5$|$10^5$|√|×|
|18|$10^5$|$10^5$|$10^5$|√|×|
|19|$10^5$|$10^5$|$10^5$|×|×|
|20|$10^5$|$10^5$|$10^5$|×|×|

特殊性质 A：保证测试点中所有的 $q \cdot \max(n, m)$ 之和不超过 $10^7$。

特殊性质 B：保证 $opt_i = 1$。

**【提示】**

数据千万条，清空第一条。多测不清空，爆零两行泪。


## 样例 #1

### 输入

```
2
5 5 9
1 5 1
0 4 0
1 4 1
0 3 0
1 3 1
0 2 0
1 2 1
0 1 0
1 1 1
3 3 3
0 1 2
0 3 1
1 1 3```

### 输出

```
1 0 0 0 0
1 1 0 0 0
1 1 1 0 0
1 1 1 1 0
1 1 1 1 1
3 2 2
3 0 0
3 1 1```

# AI分析结果



---

## 算法分类
**无算法分类**（核心为模拟操作与时间戳比较）

---

## 题解思路与算法要点

### 核心思路
- **覆盖性质**：后涂色操作会覆盖同行/列的所有历史状态。
- **时间戳比较**：每个格子的最终颜色由最后一次行操作或列操作决定（比较两者的时间戳）。
- **空间优化**：仅维护行和列的最终状态（颜色+时间戳），无需二维数组。

### 解决难点
- **大规模数据**：无法用二维数组存储所有格子状态（1e5x1e5 超出内存）。
- **覆盖逻辑**：通过记录每行每列的最后操作时间与颜色，将问题转化为 O(1) 时间比较。

### 关键变量与数据结构
- **行/列状态数组**：存储每行/列的最后一次操作的颜色和时间戳。
  - 例如：`row[x] = {color, time}`，`col[y] = {color, time}`。

---

## 题解评分（≥4星）

### 1. 题解作者：liucang（⭐⭐⭐⭐⭐）
- **亮点**：代码结构清晰，注释明确；使用结构体提升可读性；高效处理多组数据。
- **代码**：[完整代码](#code-liucang)

### 2. 题解作者：南阳刘子骥（⭐⭐⭐⭐）
- **亮点**：变量命名直观，分离时间和颜色数组；逻辑简洁高效。
- **代码**：[完整代码](#code-nanyang)

### 3. 题解作者：hloixyh（⭐⭐⭐⭐）
- **亮点**：使用 `pair` 简化存储；清空操作显式覆盖，避免多测干扰。
- **代码**：[完整代码](#code-hloixyh)

---

## 最优思路提炼
- **时间戳记录法**：通过维护行/列的最后操作时间，避免重复覆盖计算。
- **空间换时间**：用 O(n+m) 空间替代 O(nm)，解决大规模数据问题。
- **贪心比较**：每个格子仅需比较两次时间戳，时间复杂度 O(1)。

---

## 同类型题与算法套路
- **覆盖问题**：如多次区间染色，最终查询某点颜色。
- **时间戳技巧**：适用于需要处理操作顺序的覆盖型问题。

---

## 推荐题目
1. **P1841 [JSOI2007] 字符加密**（行列覆盖）
2. **P3669 [USACO17OPEN] Paired Up**（时间戳比较）
3. **P2253 好一个一中腰鼓！**（动态覆盖与状态维护）

---

## 个人心得摘录
- **多测清空**：“多测不清空，爆零两行泪” —— 每次测试前必须重置行/列数组。
- **时间戳起点**：初始时间设为0，未操作的行/列自然优先级最低。

---

## 可视化与算法演示

### 核心逻辑动画
1. **网格初始化**：显示空白网格（白色格子）。
2. **涂色操作**：
   - **行涂色**：整行闪动，更新颜色和时间戳（如蓝色）。
   - **列涂色**：整列闪动，更新颜色和时间戳（如红色）。
3. **最终比较**：
   - 遍历每个格子，高亮行/列时间戳较大者，显示最终颜色。

### 复古像素风格设计
- **8位调色板**：行操作为蓝色，列操作为红色，混合色为紫色。
- **音效设计**：
  - **行涂色**：低音“哔”。
  - **列涂色**：高音“嘀”。
  - **最终显示**：胜利音效片段。

### 交互控制
- **步进控制**：逐步执行每个涂色操作，观察时间戳变化。
- **自动模式**：按操作顺序自动播放，速度可调。

---

## 代码片段（核心逻辑）

### liucang 题解核心
```cpp
struct paint { ll color, priority; } col[100010], row[100010];
// 更新行操作
if (opt == 0) row[x] = {c, i};
// 更新列操作
else col[x] = {c, i};
// 输出比较
if (row[i].priority > col[j].priority) row_color else col_color
```

---

## 总结
通过时间戳记录法，所有题解均以 O(nm) 时间完成最终状态推导，适用于题目给出的数据范围。关键优化在于避免存储每个格子的中间状态，直接通过行/列的最后操作决定结果。

---
处理用时：83.35秒
# 题目信息

# [CRCI 2008] PLATFORME 平板

## 题目描述

为了进行一种游戏，现决定搭造一些平板，而各个平板的地址已经选定。基于最普遍的认识，没有任何支持物的平板不可能漂浮在空中。说的更精确些，任意一平板的两端必需有支柱或者它在另一块平板上。

你会得到各个平板在坐标系中的坐标（如左下图）。每一块平板的坐标都是由它的高度（与地板间的垂直距离）和它的水平方位（开始和结束）决定的。每个支柱都距它支撑的平板的边缘半个单位（如图）。

算出支持所有平板的支柱的总长度。

 ![](https://cdn.luogu.com.cn/upload/pic/994.png) 



## 样例 #1

### 输入

```
3

1 5 10

3 1 5

5 3 7

```

### 输出

```
14```

# AI分析结果



### 算法分类
**离散化 + 区间覆盖**

---

### 题解思路与核心算法

#### 算法要点
1. **离散化坐标**：将坐标扩大两倍消除浮点数（如左端点 x1 → x1*2+1，右端点 x2 → x2*2-1）
2. **排序处理**：按高度从低到高排序，确保后续处理时下方平板已建立支撑
3. **区间覆盖查询**：用线段树/数组维护每个坐标点的最大支撑高度
4. **支柱计算**：每个平板的两个支柱点分别查询当前最大高度，差值累加

#### 解决难点
- **精度处理**：通过坐标翻倍将浮点运算转换为整数运算
- **高效查询**：线段树 O(logN) 查询区间极大值，替代暴力 O(N) 查询
- **覆盖顺序**：按高度排序确保后处理的平板不会影响已建立的支撑

---

### 题解评分（≥4星）

| 题解作者        | 评分 | 亮点                                                                 |
|-----------------|------|----------------------------------------------------------------------|
| Makasukaka      | ⭐⭐⭐⭐⭐ | 线段树实现最优复杂度，清晰的区间更新逻辑，可拓展性强                |
| HOOCCOOH        | ⭐⭐⭐⭐   | 坐标翻倍技巧巧妙，代码结构简洁，适合小数据量场景                    |
| 常清静矣        | ⭐⭐⭐⭐   | 图解辅助理解，数组模拟实现简单直观，适合算法入门学习                |

---

### 最优思路与技巧

#### 关键代码实现（线段树核心）
```cpp
// 线段树查询与更新（坐标已翻倍）
for(int i=1;i<=n;i++){
    int l=a[i].x1, r=a[i].x2;
    int d=query(1,l,l+1);    // 左支柱查询
    ans+=(a[i].y-d);
    d=query(1,r-1,r);        // 右支柱查询
    ans+=(a[i].y-d);
    insert(1,l+1,r-1,a[i].y);// 更新覆盖区间
}
```

#### 技巧提炼
1. **坐标翻倍法**：将 x1*2+1 和 x2*2-1 转换为整数坐标，避免浮点运算
2. **排序预处理**：按高度排序后只需考虑已处理平板的支撑
3. **区间覆盖标记**：线段树维护区间最大值，支持高效查询与更新

---

### 类似题目推荐
1. **[P1502 窗口的星星](https://www.luogu.com.cn/problem/P1502)**  
   （区间覆盖最大值问题，需离散化处理）
2. **[P5490 矩形面积并](https://www.luogu.com.cn/problem/P5490)**  
   （扫描线算法，类似区间覆盖统计）
3. **[P3740 贴海报](https://www.luogu.com.cn/problem/P3740)**  
   （离散化+线段树区间覆盖）

---

### 可视化方案设计

#### 动画流程（8位像素风格）
1. **初始化场景**：Canvas 绘制坐标轴，左侧显示待处理平板队列（按高度排序）
2. **处理平板**：
   - **当前平板**：用闪烁的红色方块表示
   - **支柱查询**：左右端点显示绿色光柱扫描线段树节点
   - **区间覆盖**：平板覆盖区域变为橙色，线段树对应节点更新颜色
3. **音效提示**：
   - `查询成功`：短促的"滴"声
   - `覆盖更新`：连续的"咔嗒"声
   - `完成处理`：8-bit 胜利音效

#### 交互设计
```javascript
// 伪代码示例：线段树节点绘制
function drawNode(node, x, y) {
    ctx.fillStyle = node.marked ? '#FF8888' : '#88FF88'; // 标记节点高亮
    ctx.fillRect(x, y, 16, 16); // 16x16像素方块
    if(node.l != node.r) {
        drawNode(node.left, x-8, y+16);  // 递归绘制子节点
        drawNode(node.right, x+8, y+16);
    }
}
```

---

### 总结
通过离散化坐标和线段树的高效区间操作，该算法在保证时间复杂度的同时，巧妙地解决了支柱定位与高度差计算问题。可视化设计采用复古像素风格与交互式音效，使抽象的区间覆盖过程具象化，适合教学演示与算法理解。

---
处理用时：71.73秒
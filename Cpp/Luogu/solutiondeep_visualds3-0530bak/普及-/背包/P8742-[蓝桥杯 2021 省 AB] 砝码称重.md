# 题目信息

# [蓝桥杯 2021 省 AB] 砝码称重

## 题目描述

你有一架天平和 $N$ 个砝码, 这 $N$ 个砝码重量依次是 $W_{1}, W_{2}, \cdots, W_{N}$ 。 请你计算一共可以称出多少种不同的重量?

注意砝码可以放在天平两边。


## 说明/提示

**【样例说明】**

能称出的 10 种重量是: $1 、 2 、 3 、 4 、 5 、 6 、 7 、 9 、 10 、 11$ 。

$$
\begin{aligned}
&1=1 \\
&2=6-4(\text { 天平一边放 } 6, \text { 另一边放 4) } \\
&3=4-1 \\
&4=4 \\
&5=6-1 \\
&6=6 \\
&7=1+6 \\
&9=4+6-1 \\
&10=4+6 \\
&11=1+4+6
\end{aligned}
$$

**【评测用例规模与约定】**

对于 $50 \%$ 的评测用例, $1 \leq N \leq 15$ 。

对于所有评测用例, $1 \leq N \leq 100, N$ 个砝码总重不超过 $10^5$。 

蓝桥杯 2021 第一轮省赛 A 组 F 题（B 组 G 题）。

## 样例 #1

### 输入

```
3
1 4 6```

### 输出

```
10```

# AI分析结果



# 算法分类
**动态规划（01背包变种）**

---

## 题解思路与核心难点

### 算法要点
1. **状态定义**：`dp[j]` 表示能否称出重量 `j`，通过位标记（0/1）实现。
2. **状态转移**：每个砝码有三种选择：
   - **不放**：继承上一状态 `dp[j]`
   - **放左侧**：`j + w`（等价于 `dp |= dp << w`）
   - **放右侧**：`j - w`（等价于 `dp |= dp >> w`）
3. **负数处理**：通过绝对值或偏移量将负数转为正数下标。

### 解决难点
- **加减法统一处理**：通过位运算的左右移实现加减操作，避免循环嵌套。
- **空间优化**：使用 `bitset` 或滚动数组降低空间复杂度（总重量上限为 1e5）。
- **循环顺序**：逆序枚举重量防止重复计算。

---

## 题解评分（≥4星）

### 题解1：loser_seele（5星）
- **亮点**：`bitset` 优化，代码极简（仅 10 行），时间复杂度最优。
- **代码片段**：
  ```cpp
  bitset<100010> d;
  d.set(0);
  for (int i=1; i<=n; i++) 
      d |= d << a[i], d |= d >> a[i];
  ```

### 题解2：ryf_loser（4星）
- **亮点**：二维数组实现，逻辑清晰，适合教学。
- **代码片段**：
  ```cpp
  for (int j=sum; j>=0; j--) {
      if (j == w[i]) dp[i][j] = 1;
      else if (dp[i-1][j]) dp[i][j] = 1;
      else if (dp[i-1][j + w[i]]) dp[i][j] = 1;
      else if (dp[i-1][abs(j - w[i])]) dp[i][j] = 1;
  }
  ```

### 题解3：RP_INT_MAX（4星）
- **亮点**：滚动数组 + 偏移量处理负数，空间优化明显。
- **代码片段**：
  ```cpp
  for (int j=-sum; j<=sum; j++) 
      f[i&1][j+N] = f[i-1&1][j-w+N] || f[i-1&1][j+w+N];
  ```

---

## 最优思路提炼
1. **位运算优化**：用 `bitset` 的左右移代替加减法，极大提升效率。
2. **滚动数组**：仅保留当前和上一状态，空间复杂度从 `O(N·sum)` 降至 `O(sum)`。
3. **逆向枚举**：从最大重量倒序更新，避免重复计算。

---

## 类似题目推荐
1. **P2347 [砝码称重]**：多重背包可行性问题。
2. **P1048 [采药]**：经典 01 背包模板。
3. **P6567 [买表]**：货币组合问题，类似状态转移。

---

## 可视化设计
### 动画方案
1. **核心逻辑**：以像素网格表示 `dp` 数组，初始仅 `dp[0]` 点亮（绿色）。
   - **新增砝码**：当前砝码 `w` 处理时，原绿色块向左（`<<w`）和向右（`>>w`）扩展，新增黄色高亮。
   - **合并结果**：新旧状态叠加后，黄色转为绿色，表示成功转移。
2. **交互设计**：
   - **速度调节**：滑动条控制动画帧间隔（50ms~2s）。
   - **单步执行**：点击按钮逐砝码观察扩展过程。
3. **复古风格**：
   - **8-bit 音效**：转移时播放短促“哔”声，完成时播放胜利旋律。
   - **像素字体**：重量数值以 16x16 像素块显示，背景为深蓝色网格。

### 代码片段（JS Canvas）
```javascript
function drawDP() {
    ctx.clearRect(0, 0, canvas.width, canvas.height);
    for (let j = 0; j <= sum; j++) {
        if (dp[j]) { // dp[j] 为真时绘制绿色方块
            ctx.fillStyle = "#00FF00";
            ctx.fillRect(j * 10 % 500, Math.floor(j * 10 / 500) * 10, 8, 8);
        }
    }
}
```

---

## 个人心得摘录
- **loser_seele**：`bitset` 将加减法转为位运算，是“思维降维打击”。
- **RP_INT_MAX**：偏移量法解决负下标问题，“代码比数学推导更直观”。

---
处理用时：67.95秒
# 题目信息

# [语言月赛 202402] 陨石

## 题目背景

卷王来到了他的好朋友 bj12z_jiasiyuan 的农场，打算在那里过上一晚。但是在看新闻时，他们获得了一个不幸的消息，一场陨石雨就快要降临了……

## 题目描述

bj12z_jiasiyuan 的农场里有 $n$ 间牛棚，编号为 $1$ 到 $n$。第 $i$ 间牛棚的防御值为 $a_i$。

陨石雨将会**在 $t$ 秒后**来临。在陨石雨来临的时候，会有 $m$ 块陨石撞击牛棚，第 $i$ 块陨石会撞击到第 $x_i$ 间牛棚。当一块陨石撞击一间牛棚时，牛棚的防御值**会减去 $2$ 点**。而当一间牛棚的防御值 $\leq 0$ 时，牛棚会被破坏。

bj12z_jiasiyuan 有很多补给，每个补给可以给一间牛棚**增加 $1$ 点防御值**。幸运的是，卷王可以从一间牛棚瞬移到另一间牛棚（瞬移**不需花费任何时间**），用补给给牛棚增加防御值。每次补给需要 $1$ 秒的时间。

卷王只有 $t$ 秒种的时间可以出去补给，他希望让被破坏的牛棚越少越好。请你输出**最优策略下**被保护的牛棚的数量。

## 说明/提示

### 样例 1 解释

一种最优的补给方法是补给 $1$ 号牛棚 $1$ 点防御值，补给 $2$ 号牛棚 $2$ 点防御值。

在这种情况下，各牛棚防御值变化如下，其中蓝色数字代表初始防御值，绿色数字代表补给，红色数字代表陨石撞击：

- $1$ 号：${\color{blue} 2} + {\color{green}1} - {\color{red}2} = 1$；
- $2$ 号：${\color{blue} 1} + {\color{green}2} - {\color{red}2} = 1$；
- $3$ 号：${\color{blue} 3} - {\color{red}2} - {\color{red}2} = -1$；
- $4$ 号：${\color{blue} 5} - {\color{red}2} = 3$。

有且仅有 $3$ 号牛棚被破坏，可保护三个牛棚。

### 数据规模与约定

对于 $100\%$ 的数据，$1\leq x_i \leq n\leq 5 \times10^3$，$1\leq m\leq 10^6$，$0\leq t\leq 10^6$，$1\leq a_i \leq 10^6$，$1 \leq T \leq 5 \times 10^3$。  
保证单个测试点内所有测试数据 $n$ 的总和不超过 $5 \times 10^4$，所有测试数据 $m$ 的总和不超过 $3 \times 10^6$。

| 测试点编号 | 特殊限制 |
| :----------: | :----------: |
| $1, 2$ | $T = 1$，$n = 1$ |
| $3, 4$ | $T = 1$，每间牛棚恰好被击中一次 |
| $5$ | $T = 1$，$1\leq x_i \leq n \leq 100$ |
| $6$ | $T = 1$ |
| $7$ | $1\leq x_i \leq n \leq 100$ |
| $8 \sim 10$ | 无特殊限制 |

## 样例 #1

### 输入

```
1
4 3 5
2 1 3 5
3 1 2 4 3
```

### 输出

```
3
```

## 样例 #2

### 输入

```
4
3 4 2
5 2 4
2 1
3 2 20
6 6 6
1 3 3 1 2 1 1 1 2 2 2 1 1 3 1 2 2 3 3 1
2 0 2
1 2
1 1
5 3 12
4 5797 2 1 1
5 4 3 2 4 4 5 5 5 5 1 1
```

### 输出

```
3
0
1
3
```

# AI分析结果



---

### **综合分析与结论**

**题目核心**：在有限时间内通过补给防御值，最小化被陨石破坏的牛棚数量。  
**贪心策略**：优先补给“所需补给次数最少”的牛棚，以最大化保护数量。  
**解决难点**：  
1. 计算每个牛棚的陨石撞击次数，并转化为需要的最小补给量。  
2. 快速排序所有牛棚的需求量，确保贪心选择的高效性。  
**关键推导**：牛棚最终防御值需满足 \(a_i - 2d_i + s_i > 0\)，解得 \(s_i \geq \max(0, 2d_i - a_i + 1)\)。  

---

### **题解清单（≥4星）**

1. **Maxmilite的题解（4星）**  
   - **关键亮点**：正确应用贪心策略，将问题转化为排序问题。  
   - **改进点**：冒泡排序需替换为快速排序，以应对大数据量。  
   - **核心代码**：  
     ```cpp
     for (int i = 1; i <= n; ++i) {
         a[i] = 1 - a[i]; // 计算所需补给量
     }
     sort(a + 1, a + n + 1); // 快速排序
     ```

---

### **最优思路与技巧提炼**

1. **贪心选择依据**：按每个牛棚的“需求补给量”从小到大排序。  
2. **快速预处理**：用数组统计每个牛棚的撞击次数，时间复杂度 \(O(m)\)。  
3. **排序优化**：使用快速排序（或优先队列）替代冒泡排序，将时间复杂度从 \(O(n^2)\) 优化至 \(O(n \log n)\)。  

---

### **同类型题目与算法套路**

- **常见贪心场景**：  
  - **区间调度**：选择最多不重叠区间。  
  - **最小代价覆盖**：如硬币问题，用最少硬币凑金额。  
  - **资源分配**：在有限资源下最大化收益或数量。  

---

### **推荐相似题目**

1. **P1209 [USACO1.3]修理牛棚**（贪心选择间隔）  
2. **P1090 合并果子**（优先队列选最小堆）  
3. **P4995 跳跳！**（交替选最大最小值）  

---

### **可视化与算法演示**

**动画设计**：  
1. **像素风格界面**：牛棚显示为方块，颜色表示状态（绿色：安全，红色：需补给）。  
2. **贪心过程**：每次高亮当前最小需求牛棚，扣除补给数，更新剩余时间 \(t\)。  
3. **控制面板**：支持暂停/继续，调整动画速度，显示当前保护数量和剩余补给。  
4. **音效反馈**：补给成功时播放“升级”音效，补给不足时播放警告音。  

**交互示例**：  
- **初始状态**：牛棚防御值显示为蓝色，陨石撞击后变为红色。  
- **排序阶段**：牛棚按需求量升序排列，动态展示排序过程。  
- **补给阶段**：逐个补给，绿色进度条表示剩余时间 \(t\)。  

---

### **代码实现（核心逻辑）**

```cpp
#include <iostream>
#include <algorithm>
using namespace std;

int main() {
    int T; cin >> T;
    while (T--) {
        int n, m, t;
        cin >> n >> m >> t;
        vector<int> a(n + 1);
        for (int i = 1; i <= n; ++i) cin >> a[i];
        
        // 统计陨石撞击次数，计算防御值
        vector<int> hits(n + 1, 0);
        for (int i = 0; i < m; ++i) {
            int x; cin >> x;
            hits[x]++;
        }
        for (int i = 1; i <= n; ++i) {
            a[i] -= 2 * hits[i];
        }
        
        // 计算所需补给量，并排序
        vector<int> needs;
        for (int i = 1; i <= n; ++i) {
            int need = max(0, 1 - a[i]);
            needs.push_back(need);
        }
        sort(needs.begin(), needs.end());
        
        // 贪心分配补给
        int ans = 0;
        for (int need : needs) {
            if (need == 0) ans++;
            else if (t >= need) {
                t -= need;
                ans++;
            } else break;
        }
        cout << ans << endl;
    }
    return 0;
}
```

---

**关键注释**：  
- `hits` 数组统计每个牛棚被撞击次数。  
- `needs` 数组存储每个牛棚的补给需求，排序后按需分配。

---
处理用时：132.42秒
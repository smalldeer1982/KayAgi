# 题目信息

# [USACO05MAR] Yogurt factory 机器工厂

## 题目描述

小 T 开办了一家机器工厂，在 $N$个星期内，原材料成本和劳动力价格不断起伏，第 $i$ 周生产一台机器需要花费 $C_i$ 元。若没把机器卖出去，每保养一台机器，每周需要花费 $S$ 元，这个费用不会发生变化。

机器工厂接到订单，在第 $i$ 周需要交付 $Y_i$ 台机器给委托人，第 $i$ 周刚生产的机器，或者之前的存货，都可以进行交付。

请你计算出这 $n$ 周时间内完成订单的最小代价。

## 说明/提示

$1\leq n\leq 10^4$，$1 \le C_i \le 5000$，$1 \le S\le 100$，$0\le Y_i\le 10^4$。

## 样例 #1

### 输入

```
4 5
88 200
89 400
97 300
91 500
```

### 输出

```
126900
```

# AI分析结果



### 综合分析与结论

**核心思路**：  
采用贪心策略，维护当前周的最小生产成本。每一步比较上一周的最小成本加上保养费与当前周的生产成本，选择较小值作为本周的最优成本。通过线性遍历确保每一步的局部最优解，最终得到全局最优。

**贪心策略推导**：  
- 对于第i周，其最小成本为 `min(当前周成本C_i, 前一周最小成本 + S)`。  
- 该策略的正确性基于：若前序周的最优成本加上保养费仍优于当前周生产，则延续前序决策；否则切换为当前周生产。这种选择传递了最优子结构，确保全局最优。

**难点与解决**：  
- **正确性证明**：需确保每一步的局部最优能导向全局最优。通过归纳法可证明，每次维护的最小成本已包含所有前序决策的可能最优解。  
- **数据范围处理**：使用`long long`存储结果，避免溢出。

**可视化设计思路**：  
- **动画方案**：以柱状图展示每周的C_i，动态更新当前最小成本线。高亮当前周决策（生产或延续前序），显示成本变化。  
- **复古像素风格**：用8位像素块表示周次，颜色区分生产决策（绿色为当前生产，黄色为延续前序）。音效提示决策切换。  
- **交互设计**：步进控制观察决策过程，自动演示模式展示贪心策略的渐进选择。

---

### 题解评分（≥4星）

1. **Jason224413（5星）**  
   - **亮点**：代码简洁高效，O(n)时间与O(1)空间，正确初始化处理。  
   - **代码**：维护`lastweek`变量，动态更新最小成本，直接计算总代价。

2. **Ar_HomeTree（4星）**  
   - **亮点**：清晰注释与变量命名，正确处理首周特例，`min`函数显式比较。  
   - **代码**：使用`ans`变量跟踪最小成本，逐周比较更新。

3. **EarthGiao（4星）**  
   - **亮点**：完整思路描述，代码简洁，强调`long long`必要性。  
   - **代码**：类似动态维护策略，变量命名直观。

---

### 最优思路提炼

**关键贪心选择**：  
每周的最小成本为`min(前序最小成本 + S, 当前周成本)`。  
**实现步骤**：  
1. 初始化首周成本为C₁。  
2. 从次周开始，动态比较并更新最小成本。  
3. 累加每周最小成本与订单量的乘积。

**代码片段**：  
```cpp
int last = c; // 当前周初始成本
for (int i = 2; i <= n; ++i) {
    last = min(last + s, c_i); // 更新最小成本
    ans += last * y_i;
}
```

---

### 同类型题目推荐

1. **P1223 排队接水**：贪心排序，最小化平均等待时间。  
2. **P1090 合并果子**：优先队列实现最小体力消耗。  
3. **P1016 旅行家的预算**：贪心选择加油站，维护当前最优加油策略。

---

### 个人心得摘录

- **调试教训**：未使用`long long`导致溢出（如My_666题解）。  
- **顿悟点**：维护单变量即可传递最优决策，无需复杂结构（Jason224413）。  
- **优化经验**：在线处理节省空间，避免存储全部输入（花千树）。

---

### 可视化与算法演示

**动画设计**：  
- **Canvas绘制**：每周显示C_i柱状图，红色标记当前决策点。  
- **颜色标记**：绿色表示当前生产周，黄色表示延续前序决策。  
- **步进控制**：按钮控制执行速度，显示当前总成本。  

**复古游戏化**：  
- **像素风格**：8-bit字体与色块，音效随决策切换（↑音调选择当前周，↓音调延续前序）。  
- **积分系统**：正确决策累计积分，错误选择扣分，增强互动。  

**自动演示模式**：  
- **AI模拟**：自动执行贪心选择，高亮决策路径，动态更新结果。  

---

### 核心代码实现

```cpp
#include <iostream>
using namespace std;

int main() {
    int n, s;
    cin >> n >> s;
    long long ans = 0;
    int last_c;
    for (int i = 0; i < n; ++i) {
        int c, y;
        cin >> c >> y;
        if (i == 0) last_c = c;
        else last_c = min(last_c + s, c);
        ans += (long long)last_c * y;
    }
    cout << ans << endl;
    return 0;
}
```

**代码说明**：  
- 动态维护`last_c`为当前最小成本，逐周更新。  
- 使用`long long`避免溢出，时间复杂度O(n)。

---
处理用时：101.03秒
# 题目信息

# 在你窗外闪耀的星星

## 题目背景

飞逝的的时光不会模糊我对你的记忆。难以相信从我第一次见到你以来已经过去了 3 年。我仍然还生动地记得，3 年前，在美丽的集美中学，从我看到你微笑着走出教室，你将头向后仰，柔和的晚霞照耀着你玫瑰色的脸颊。我明白，我已经沉醉于你了。之后，经过几个月的观察和窥探，你的优雅与智慧，你对待生活的态度和你对未来的愿望深切地在我心中留下了印象。你是迷人的阳光女孩，我总是梦想着与你分享余生。唉，实际上你远远超过了我最疯狂的梦想。我不知道如何桥起我与你之间的鸿沟。所以我没有任何计划，仅仅只是等待，等待一个适当的机会到来。直到现在，毕业的到来，我意识到我是个傻瓜，我应该创造机会并且抓住它而不只是等待。


这些日子里，我和我的朋友、室友、同学一个接一个地分开。我仍无法相信，在挥手之后，这些熟悉的面孔很快就会从我们的生活中消失，仅仅留下回忆。我明天就将离开学校。你已经计划远走高飞，追求你的未来，实现你的梦想。如果没有命运，也许我们不会再次相遇。所以今晚，我正在你的宿舍楼下徘徊，希望能偶然遇见你。但矛盾的是，你的美貌一定会使我心跳加速，我笨拙的舌头也许无法吐出一个字。我不记得我曾多少次经过你的宿舍楼，每次都希望看到你出现在阳台上或是窗台上。我不记得这个想法曾多少次在我的脑海中涌出：打电话叫她一起吃晚饭或是聊聊天。但每次，考虑到你的优秀和我的平凡，胆怯的优势超越勇气驱使我静静地离开。


毕业，意味着中学生活的终结。这些光荣与浪漫的时代结束。你可爱的微笑是我原来努力学习的动力，这单相思的爱情会被密封，作为一个我心灵深处的记忆。毕业，也意味着新生活的开始，一个到达光明未来的足迹。我真希望你在国外天天开心，一切顺利。同时，我将努力从幼稚中走出来，变得更加成熟。我的理想将是在现实中追求我的爱与幸福，我永远不会放弃。


再见了，我的公主！


如果有一天，在某个天涯海角，我们有机会相聚，即使是白发苍苍的男人和女人，在那个时候，我希望我们可以成为好朋友来自豪地分享这个记忆，重温年轻快乐的激情。如果这个机会永远没有到来，我希望我是天空中的星星，在你的窗外闪烁。远远地保佑着你，就像一个朋友，每天晚上陪伴在你左右，一同分享甜美的梦亦或是一同经历可怕的梦。

## 题目描述

现在问题来了：天空可以理解为一条数轴，在这条数轴上分布着许多颗星星，对于每颗星星都有它的位置 $X_i$ 和自身的亮度 $B_i$。**一个位置可能有多颗星星**。而窗户所能看到的范围是一个给出的参数 $W$，我们看到的星星也包括窗户边缘的星星。现在，要你求出调整窗户位置后能看到星星的亮度之和最大值。


## 说明/提示

样例说明：


 ![](https://cdn.luogu.com.cn/upload/pic/3818.png) 

对于 $10\%$ 的数据，$W=0$（没有边缘）；

对于 $40\%$ 的数据，$W\leq 1000$；

对于 $100\%$ 的数据，$1 \leq N\leq 10 ^ 5$，$0 \leq W\leq 10 ^ 5$，$1 \leq X_i\leq 10 ^ 5$，$1\leq B_i\leq 100$。

除 $W=0$ 的情况外，$W$ 均为 $\geq 3$ 的奇数。


## 样例 #1

### 输入

```
6 3
1 2
2 4
3 8
4 4
5 2
1000 1```

### 输出

```
16```

# AI分析结果



### 题解分析与结论

#### 核心算法与难点
本题本质为 **滑动窗口最大值问题**，需高效求解区间和的最大值。各解法核心思路如下：
1. **前缀和**：将星星亮度按位置聚合，预处理前缀和数组，滑动窗口遍历时 O(1) 计算区间和。
2. **树状数组/线段树**：维护动态区间和，适用于动态数据，但本题数据静态，效率稍低。
3. **双指针**：按位置排序后，维护窗口内的亮度总和，时间复杂度 O(n) 但需排序。

**贪心策略**隐含在滑动窗口的移动中：每次右移窗口时，无需回溯历史状态，直接舍弃左侧无效数据，仅保留当前最优可能性。

---

### 高星题解清单（≥4★）

1. **xzjds（前缀和）** ★★★★★  
   - **亮点**：直接高效，O(max_x) 时间复杂度，代码简洁易实现。  
   - **关键修正**：处理同一位置多颗星星的亮度累加。

2. **YaliKiWi（前缀和）** ★★★★★  
   - **亮点**：详细分析暴力与优化思路，代码清晰，包含双解法对比。

3. **Dog_Two（滑动窗口）** ★★★★☆  
   - **亮点**：O(n) 动态维护窗口和，无需预处理数组，空间效率更优。

---

### 最优思路与代码实现

#### 前缀和法（最优）
```cpp
#include<bits/stdc++.h>
using namespace std;
const int MAX=1e5+5;
int sum[MAX], star[MAX], n, w, max_x;

int main() {
    cin >> n >> w;
    for (int i=0; i<n; i++) {
        int x, b; cin >> x >> b;
        star[x] += b; // 关键：累加同一位置亮度
        max_x = max(max_x, x);
    }
    for (int i=1; i<=max_x; i++) 
        sum[i] = sum[i-1] + star[i]; // 前缀和
    
    int ans = 0;
    for (int i=w; i<=max_x; i++) 
        ans = max(ans, sum[i] - sum[i-w]); // 滑动窗口
    cout << ans;
}
```

#### 双指针法（动态窗口）
```cpp
sort(star, star + n); // 按位置排序
int left=0, current=0, ans=0;
for (int right=0; right<n; right++) {
    current += star[right].brightness;
    while (star[right].pos - star[left].pos >= w) 
        current -= star[left++].brightness; // 窗口左移
    ans = max(ans, current);
}
```

---

### 同类型题目推荐
1. **P1614 爱与愁的心痛** - 滑动窗口最小值  
2. **P1886 滑动窗口** - 单调队列求极值  
3. **P1714 切蛋糕** - 前缀和+单调队列优化  

---

### 可视化算法演示（贪心策略）

#### 核心动画设计
- **数轴与星星**：用像素方块表示星星位置，亮度越高颜色越亮（黄→红渐变）。  
- **滑动窗口**：蓝色半透明矩形框表示当前窗口，实时显示区间和数值。  
- **贪心过程**：窗口逐步右移，旧窗口区域变暗，新窗口高亮，每次移动后更新最大值。  

#### 交互功能
- **步进控制**：支持暂停/继续，调整移动速度（50ms~1s）。  
- **音效反馈**：窗口移动时播放电子音效，最大值更新时触发上扬音调。  
- **复古风格**：8-bit 字体，背景循环播放 FC 风格音乐。  

#### 代码片段（Canvas绘制）
```javascript
function drawWindow(ctx, x, w, maxSum) {
    ctx.fillStyle = 'rgba(0, 120, 255, 0.3)';
    ctx.fillRect(x*10, 0, w*10, 150); // 每单位10像素
    ctx.fillStyle = '#FFF';
    ctx.fillText(`Sum: ${maxSum}`, x*10 + 5, 20);
}
```

---

### 总结
本题通过**前缀和+滑动窗口**可高效解决，隐含贪心策略为“舍弃无效历史状态，仅保留当前最优窗口”。可视化设计通过动态高亮与音效增强理解，适合教学演示与算法竞赛训练。

---
处理用时：95.98秒
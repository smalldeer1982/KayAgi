# 题目信息

# 「DBOI」Round 1 DTTM

## 题目背景

张则雨和穆制程坐在天台上看着满天的星辰。在他们的世界，流行一种连接星星的活动。他们对此有一种浪漫的诠释：如果连不完，剩下的一颗星星就是身旁的人；如果连得完，那身边的人和自己都是星星。

## 题目描述

星空中有 $n$ 颗星星，第 $i$ 颗位于坐标 $(x_i,y_i)$。你需要把星星连接成满足张则雨的如下需求：

- 每一颗星星都是且仅是一条线段的端点，所有线段互不相交（包括端点）。
- 所有线段左右端点 $|x_l-x_r|$ 之和有最小值。 

然而张则雨有点笨，并不知道应该怎么连。穆制程知道你是地球上最聪明的人，于是告诉你 $n$ 颗星星的坐标，你需要输出连接方案或者报告无解。

## 说明/提示

样例 1 的方案如图：

![](https://s1.ax1x.com/2023/04/06/ppomH5q.png)

样例 2 的方案如图：

![](https://s1.ax1x.com/2023/04/06/ppomDDH.png)

**本题使用捆绑测试与子任务依赖。**

| $\rm Subtask$ | $n\leqslant$ | $(x,y)$ | 特殊性质 | 得分 | 子任务依赖 |
| :-----------: | :-----------: | :-----------: | :-----------: | :-----------: | :-----------: |
| $1$ | $10$ | $0\leqslant x,y\leqslant 20$ | 无 | $10$ | 无 |
| $2$ | $10^3$ | $0\leqslant x,y\leqslant10^3$ | 无 | $15$ | $1$ |
| $3$ | $10^3$ | $0\leqslant x,y\leqslant10^9$ | 无 | $15$ | $1,2$ |
| $4$ | $5\times10^5$ |$-10^9\leqslant x,y\leqslant10^9$  | $A$ | $5$ | 无 |
| $5$ | $5\times10^5$ | $-10^3\leqslant x,y\leqslant10^3$ | 无 | $20$ | $1,2$
| $6$ | $5\times10^5$ | $-10^9\leqslant x,y\leqslant10^9$ | 无 | $35$ | $1,2,3,4,5$


特殊性质 $A$：满足所有 $x_i$ 都相等。

保证对于 $100\%$ 的数据，$1\leqslant n\leqslant5\times 10^5$，$0\leqslant|x|,|y|\leqslant 10^9$ 且对于任意 $i\ne j$，有 $(x_i,y_i)\neq (x_j,y_j)$。

## 样例 #1

### 输入

```
4
1 3
2 2
2 1
3 4```

### 输出

```
2
1 4
2 3```

## 样例 #2

### 输入

```
6
1 5
2 3
2 4
2 5
2 -1
3 -3```

### 输出

```
2
1 3
4 6
2 5```

# AI分析结果



### 题解思路、算法要点与解决难点

#### 核心贪心思路
所有题解均基于贪心策略，核心思想是**按x坐标排序，相邻点两两配对**。差异在于如何处理同一x坐标下的奇偶性问题：
- **基本思路**（wmrqwq等）：按x升序，x相同则按y升序，相邻配对。总差为相邻点x差之和，线段不相交。
- **优化思路**（出题人Shunpower）：处理同一x坐标内奇数组，将奇数组的y最大点与下一x坐标的y最大点配对，剩余点内部消化，确保总差最小且线段不交。

#### 解决难点
1. **线段不相交的证明**：
   - 基本思路：假设按x排序后，线段左右端点严格递增，同一x内按y排序后线段垂直，跨x线段x方向不重叠，故不相交。
   - 优化思路：通过奇数组配对减少跨x线段的x差，确保总差最小且跨线段不交。

2. **总差最小化**：
   - 相邻配对保证每个线段的x差最小，总和自然最小。
   - 奇数组处理时，跨x配对选择相邻x坐标，避免大跨度差。

### 题解评分（≥4星）

1. **Shunpower（出题人）★★★★★**  
   - **亮点**：严谨处理奇数组，确保最优且不交。代码高效，利用map分组。
   - **代码**：结构清晰，分组处理逻辑明确。

2. **wmrqwq ★★★★☆**  
   - **亮点**：代码简洁，快速排序后相邻配对，易于实现。
   - **不足**：未显式处理奇数组，依赖题设隐含保证。

3. **lailai0916 ★★★★☆**  
   - **亮点**：清晰代码结构，快速验证贪心正确性。
   - **不足**：同基本思路，未深入讨论奇偶性。

### 最优思路或技巧提炼
- **排序策略**：按x升序为主，y升序为辅，确保相邻配对无交。
- **奇偶处理**：当同一x坐标点数为奇数时，将其最大y点与下一x的最大y点配对，最小化跨x差。

### 同类型题或算法套路
- **区间贪心**：如区间调度（选择不相交区间）、最小生成树（Kruskal按边权排序）。
- **配对问题**：如婚姻匹配（稳定匹配）、任务分配（最小化总成本）。

### 推荐相似题目
1. **P1230 智力大冲浪**（贪心选择截止时间最近的任务）。
2. **P1106 删数问题**（字典序最小，贪心删高位大数）。
3. **P1803 线段覆盖**（选择不相交线段使数量最多）。

### 个人心得摘录
- **Shunpower**：强调奇数组必须成对处理，否则总差无法最优。
- **ccg12345**：利用叉积证明线段不交，增强正确性信心。

---

### 可视化与算法演示（核心贪心过程）

#### 动画方案
1. **排序过程**：展示按x排序后点的分布，用颜色区分不同x组。
2. **配对步骤**：
   - 相邻点配对，绿色线段表示同一x内配对，红色表示跨x配对。
   - 奇数组时，高亮最大y点，动态连线至下一x的最大y点。
3. **冲突检测**：若模拟相交，触发红色闪烁警示。

#### 复古游戏化设计
- **8位像素风格**：点表示为像素方块，x轴为横坐标，y轴颜色渐变。
- **音效**：配对成功（8-bit上升音效），冲突（短促警报）。
- **自动演示**：AI按排序顺序逐步连线，用户可暂停/调速。

---

### 代码实现（核心贪心逻辑）
```cpp
// 按x排序后相邻配对（wmrqwq思路）
struct Node { int x, y, id; };
bool cmp(Node a, Node b) {
    return a.x < b.x || (a.x == b.x && a.y < b.y);
}

sort(a, a + n, cmp);
for (int i = 0; i < n; i += 2) {
    sum += a[i+1].x - a[i].x;
    pairs.emplace_back(a[i].id, a[i+1].id);
}
```

---

### 结论
基本贪心策略（排序后相邻配对）在绝大多数情况下正确，且代码简洁。出题人的优化策略在复杂奇数组场景下确保理论最优，适合大规模数据。可视化设计通过动态演示与游戏化交互，深化对贪心选择的理解。

---
处理用时：277.06秒
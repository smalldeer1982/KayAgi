# 题目信息

# [NOIP 1999 提高组] 导弹拦截

## 题目描述

某国为了防御敌国的导弹袭击，发展出一种导弹拦截系统。但是这种导弹拦截系统有一个缺陷：虽然它的第一发炮弹能够到达任意的高度，但是以后每一发炮弹都不能高于前一发的高度。某天，雷达捕捉到敌国的导弹来袭。由于该系统还在试用阶段，所以只有一套系统，因此有可能不能拦截所有的导弹。

   
输入导弹依次飞来的高度，计算这套系统最多能拦截多少导弹，如果要拦截所有导弹最少要配备多少套这种导弹拦截系统。


## 说明/提示

对于前 $50\%$ 数据（NOIP 原题数据），满足导弹的个数不超过 $10^4$ 个。该部分数据总分共 $100$ 分。可使用$\mathcal O(n^2)$ 做法通过。  
对于后 $50\%$ 的数据，满足导弹的个数不超过 $10^5$ 个。该部分数据总分也为 $100$ 分。请使用 $\mathcal O(n\log n)$ 做法通过。

对于全部数据，满足导弹的高度为正整数，且不超过 $5\times 10^4$。


此外本题开启 spj，每点两问，按问给分。

NOIP1999 提高组 第一题

---

$\text{upd 2022.8.24}$：新增加一组 Hack 数据。

## 样例 #1

### 输入

```
389 207 155 300 299 170 158 65```

### 输出

```
6
2
```

# AI分析结果



**唯一算法分类**  
二分

**综合分析与结论**  
本题解需解决两个问题：最长不上升子序列（LNDS）和最小系统数（Dilworth定理应用）。核心在于二分法的应用与单调性维护：

1. **二分条件与区间收缩**  
   - LNDS维护单调不增数组，使用upper_bound+greater()查找第一个小于当前值的位置，替换以维持数组潜力  
   - 最小系统数等价于最长上升子序列（LIS），用lower_bound在单调增数组中定位第一个≥当前值的位置  

2. **可视化设计要点**  
   - **动画方案**：用Canvas绘制数组元素，当前mid用高亮色标记，比较结果用箭头指示区间收缩方向  
   - **颜色标记**：已处理元素绿色，当前mid红色，新区间蓝色，替换操作用闪烁特效  
   - **步进控制**：允许调节二分执行速度，展示关键步骤的left/right/mid值变化  
   - **复古像素风格**：8-bit音效（按键声/成功音），网格化显示数组，仿FC游戏界面

**题解清单 (≥4星)**  
1. 离散小波变换°（5星）：  
   - 清晰推导Dilworth定理，双二分实现简洁  
   - 代码复用性强，两问仅修改比较方向  

2. STA_Morlin（4星）：  
   - 详细图解Dilworth定理应用场景  
   - 提供暴力到优化的完整思维路径  

3. Otue（4星）：  
   - 独立提出贪心策略数学证明  
   - 给出暴力与二分优化双版本代码  

**关键二分代码片段**  
```cpp
// 第一问：最长不升子序列
int l=0, r=t+1;
while(r-l>1){
    int m = l+(r-l)/2;
    if(F[m]>=H[i]) l=m;  // 维护单调不增特性
    else r=m;
}
F[l+1] = H[i];  // 替换潜力位置

// 第二问：最长上升子序列
int l=0, r=t+1;
while(r-l>1){
    int m = l+(r-l)/2;
    if(F[m]<H[i]) l=m;  // 维护单调增特性
    else r=m;
}
F[l+1] = H[i];
```

**同类型题推荐**  
1. P1091 合唱队形（LIS双向扩展）  
2. P1439 最长公共子序列（LIS转化技巧）  
3. P2216 理想的正方形（二维单调队列+二分）

**个人心得摘录**  
- 调试时发现二分方向写反导致WA，理解到维护数组单调方向决定比较符号  
- 替换操作的意义：允许后续更高/低元素插入，不影响当前长度但增加潜力  

**可视化实现思路**  
1. **Canvas动画**：  
   - 初始绘制单调数组为灰色方块序列  
   - 当前元素用绿色方块突出，二分区间[left,right]用蓝色边框  
   - mid计算时显示黄色闪烁，比较后收缩区间时显示红色箭头  

2. **音效设计**：  
   - 每次mid计算播放"beep"短音  
   - 区间收缩成功播放上升音阶，替换操作播放金属撞击声  
   - 完成时播放8-bit胜利音乐  

3. **自动演示模式**：  
   - 按帧推进二分步骤，间隔可调（500ms-2s）  
   - 显示当前步骤的代码行高亮，与动画同步  

**复古像素风格CSS**  
```css
.pixel-font { font-family: 'Press Start 2P', cursive; }
.canvas-grid {
  background: #2c3e50;
  border: 3px solid #8e44ad;
  image-rendering: pixelated;
}
.array-block {
  width: 32px; height: 32px;
  background: #3498db;
  border: 2px solid #2980b9;
}
.highlight {
  background: #e74c3c !important; 
  animation: blink 0.5s step-end infinite;
}
@keyframes blink {
  50% { opacity: 0.5; }
}
```

该设计将二分过程的数学严谨性与游戏化交互结合，通过多感官反馈强化算法理解。

---
处理用时：69.57秒
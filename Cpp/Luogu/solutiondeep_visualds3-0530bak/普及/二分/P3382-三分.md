# 题目信息

# 三分

## 题目背景

本题可能存在严重精度问题，部分数据下难以通过。本题数据较水，仅供参考。

## 题目描述

如题，给出一个 $N$ 次函数，保证在范围 $[l, r]$ 内存在一点 $x$，使得 $[l, x]$ 上单调增，$[x, r]$ 上单调减。试求出 $x$ 的值。

## 说明/提示

对于 $100\%$ 的数据，$6 \le N \le 13$，函数系数均在 $[-100,100]$ 内且至多 $15$ 位小数，$|l|,|r|\leq 10$ 且至多 $15$ 位小数。$l\leq r$。

**【样例解释】**

 ![](https://cdn.luogu.com.cn/upload/pic/2297.png) 

如图所示，红色段即为该函数 $f(x) = x^3 - 3 x^2 - 3x + 1$ 在区间 $[-0.9981, 0.5]$ 上的图像。

当 $x = -0.41421$ 时图像位于最高点，故此时函数在 $[l, x]$ 上单调增，$[x, r]$ 上单调减，故 $x = -0.41421$，输出 $-0.41421$。


## 样例 #1

### 输入

```
3 -0.9981 0.5
1 -3 -3 1```

### 输出

```
-0.41421```

# AI分析结果



### 【算法分类】
二分（导数二分法）

---

### 【题解思路与难点分析】

**核心思路**：通过求导找到函数极值点。题目保证函数在区间内先增后减，极大值点即为导数为0的点。通过二分法逼近导数为0的位置。

**关键步骤**：
1. **数值求导**：用差分法近似计算导数（如f(x+Δx)-f(x))/Δx，Δx取极小值（1e-10）。
2. **二分条件**：若中点导数>0，说明极大值在右侧，调整左边界；反之调整右边界。
3. **终止条件**：区间长度<1e-6时达到精度要求。

**难点解决**：
- **导数计算**：无需手动求导公式，用数值方法直接计算。
- **边界处理**：始终保证极值点在区间内，无需额外判断。

---

### 【高星题解推荐】（≥4★）

1. **BlueArc（5★）**  
   - 亮点：标准三分法实现，使用秦九韶算法优化多项式计算。
   - 代码简洁，直接比较三等分点函数值。

2. **NaCly_Fish（5★）**  
   - 亮点：数值导数+二分法，避免求导公式推导。
   - 利用导数单调性快速定位极值点。

3. **ff_666（4★）**  
   - 亮点：指出二分法可替代三分法，通过比较中点邻域函数值判断趋势。
   - 代码极简，仅需普通二分结构。

---

### 【最优思路提炼】
**数值导数二分法**：
1. 使用差分近似导数（无需数学推导）。
2. 每次二分根据导数符号调整区间。
3. 处理精度时直接比较区间长度与阈值（1e-7）。

**核心代码片段**：
```cpp
double check(double x) {
    double dx = 1e-10;
    return (f(x + dx) - f(x)) / dx; // 数值导数
}

while (r - l > eps) {
    mid = (l + r) / 2;
    if (check(mid) > 0) l = mid;
    else r = mid;
}
```

---

### 【同类题目推荐】
1. **P1883 函数** - 类似单峰函数极值问题。
2. **P2571 [SCOI2010] 传送带** - 三分法经典题。
3. **P3745 期末考试** - 二分答案优化问题。

---

### 【可视化设计：导数二分法动画】

**动画方案**：
1. **区间可视化**：Canvas绘制数轴，标记当前区间[left, right]和mid点。
2. **导数符号高亮**：mid点右侧显示"+"或"-"表示导数符号。
3. **区间收缩**：点击步进按钮时，根据导数符号动态收缩区间边界。
4. **复古像素风格**：使用16色调色板，区间用绿色方块，mid用红色闪烁。

**交互功能**：
- **步进控制**：按钮单步执行二分过程。
- **音效**：区间更新时播放8-bit音效，找到极值时播放胜利音效。
- **自动演示**：AI模式自动执行二分，速度可调。

---

### 【总结】
导数二分法通过数值近似简化了数学推导，结合标准二分结构实现高效极值定位。可视化中通过动态区间收缩和像素风格增强理解，适合教学演示。

---
处理用时：59.05秒
# 题目信息

# 「yyOI R1」youyou 的异或

## 题目背景

youyou 非常菜，但是他很喜欢构造奇奇怪怪的数列。

## 题目描述

本题评测方式为 **Special Judge**。

youyou 很喜欢数列，所以他想让你构造一个长度为 $n$ 的**正整数**序列 $\{a_i\}$。

youyou 很喜欢[异或](https://oi-wiki.org/math/bit/#%E4%B8%8E%E6%88%96%E5%BC%82%E6%88%96)，所以他要求构造出的序列满足 $a_1 \oplus a_2 \oplus a_3 \oplus \cdots \oplus a_{n-1} \oplus a_n = n$（记 $\oplus$ 表示异或）。

youyou 非常讨厌相同的数，所以他要求序列中所有数**互不相同**。

但 youyou 不想让这个序列的数太大，所以他要求序列中所有数的总和不超过 $n^2$，即 $\displaystyle\sum_{i=1}^n a_i \le n^2$。

现在你需要构造出一个序列从而满足 youyou 的所有要求。如果无解，输出 `-1` 。如果有多种答案，输出任意一个序列即可。

你需要回答 $T$ 组数据。

## 说明/提示

### 样例解释
对于 $n = 1$ 时，一种可行的解为 $\{1\}$。

对于 $n = 2$ 时，一种可行的解为 $\{3,1\}$。

对于 $n = 5$ 时，一种可行的解为 $\{1,4,5,3,6\}$，因为 $1 ⊕  4 ⊕ 5  ⊕ 3 ⊕ 6 = 5$，且 $1+4+5+3+6 =19\le 5^2$，序列中每个数也互不相同。


### 数据范围
对于 $5\%$ 的数据，$n \le 5$。

对于 $15\%$ 的数据，$n \le 10$。

对于 $40\%$ 的数据，$n \le 1000$。

对于 $70\%$ 的数据， $n \le 10^5$。

对于 $100\%$ 的数据，$1 \le n \le 5 × 10^5$，$1 \le T \le 10$。


## 样例 #1

### 输入

```
3
1
2
5```

### 输出

```
1
3 1
1 4 5 3 6```

# AI分析结果



**唯一算法分类**：构造与位运算

---

### **题解思路、算法要点与解决难点**

1. **核心思路**  
   - **分模讨论**：根据 `n % 4` 的余数（0/1/2/3）分类构造序列，利用异或的奇偶性质简化问题。
   - **前 n-2 项统一处理**：大部分题解将前 `n-2` 项设为连续的正整数 `1,2,...,n-2`，确保互异且总和较小。
   - **末尾两项特殊构造**：根据余数选择末尾两项，确保异或和为 `n` 且不重复：
     - **余0**：直接取 `n-1, n`。
     - **余2**：取 `n-1, n+1`。
     - **余1/3**：引入最小的 `≥n` 的 2 的幂次方 `k`，末尾项分别为 `k, k+n` 或 `k, k+n-1`。

2. **解决难点**  
   - **异或和的控制**：通过分组（如偶数与奇数配对）使异或和为 0 或 1，结合末尾项调整总异或和为 `n`。
   - **总和限制**：前 `n-2` 项总和为 `O(n^2)` 级别，末尾两项总和为 `O(n)`，总体满足 `sum ≤ n²`。
   - **特例处理**：`n=3` 无解，`n=5` 等需单独构造。

---

### **题解评分 (≥4星)**

1. **作者：continueOI（4.5星）**  
   - **亮点**：通过打表发现规律，详细证明异或性质，代码简洁高效，覆盖所有情况。
   - **代码片段**：
     ```cpp
     if(n%4==0) cout<<n-1<<' '<<n<<'\n';
     else if(n%4==1) cout<<sum<<' '<<sum+n<<'\n';
     ```

2. **作者：youyou2007（出题人，4.5星）**  
   - **亮点**：系统性分类，严格数学证明，构造思路清晰。
   - **代码片段**：
     ```cpp
     if(n%4==0) for(int i=1; i<=n; i++) printf("%d ", i);
     ```

3. **作者：Aventurine_stone（4星）**  
   - **亮点**：预处理 2 的幂次方，代码可读性强，覆盖余数分类。
   - **代码片段**：
     ```cpp
     int a[N], t=1;
     for(int i=1; i<=5e5; i++) a[i] = (i>t) ? t<<=1 : t;
     ```

---

### **最优思路或技巧提炼**

1. **模4分类法**  
   - 利用 `n%4` 余数确定构造策略，确保异或和的分组性质。
   - **关键性质**：连续偶奇配对异或为 1，两组合并异或为 0。

2. **末尾项快速构造**  
   - 使用最小的 `≥n` 的 2 的幂次方 `k`，确保 `k` 的二进制位足够高，避免与前面数重复。

3. **特例处理**  
   - `n=3` 必须特判无解，`n=5` 等小数值单独处理。

---

### **同类型题或类似算法套路**

- **异或构造题**：利用位运算性质分组或调整末尾项。
- **模分类构造**：如根据奇偶性、模4/8等分组简化问题。
- **打表找规律**：对小数据暴力搜索，观察构造规律。

---

### **推荐题目**

1. **P6560 [SBCOI2020] 时刻**（位运算构造）
2. **P3974 [TJOI2015] 组合数学**（模运算与构造）
3. **P2114 [NOI2014] 起床困难综合症**（位运算优化）

---

### **个人心得摘录**

- **continueOI**：“打表是构造题的利器，尤其是对异或这种难以直接推导的操作。”
- **sbno333**：“末尾两项的选择需结合异或和与总和限制，暴力枚举可能超时，预处理是关键。”

---

### **可视化与算法演示**

1. **动画方案**  
   - **分步构造**：逐步填充数组，颜色标记前 `n-2` 项（绿色）、末尾两项（红色/蓝色）。
   - **异或和动态显示**：实时计算当前异或和，末尾两项填入时显示异或结果。
   - **模4分类提示**：在顶部显示 `n%4` 值，指导构造策略。

2. **复古像素风格**  
   - **像素网格**：每个数显示为 8x8 像素块，填充时播放“放置音效”。
   - **音效设计**：
     - **放置数**：短促“滴”声。
     - **完成构造**：8-bit 胜利音效。
     - **错误**：低沉“哔”声。

3. **交互控制**  
   - **步进执行**：按空格键逐步填充数组。
   - **自动播放**：AI 自动选择末尾两项，速度可调。

```javascript
// 伪代码：构造末尾两项的动画逻辑
function animateConstruction(n) {
  let a = [];
  for (let i=1; i<=n-2; i++) {
    a.push(i);
    drawPixelBlock(i, 'green'); // 绘制前n-2项
  }
  let k = Math.pow(2, Math.ceil(Math.log2(n)));
  if (n%4 === 1) {
    a.push(k, k + n);
    drawPixelBlock(k, 'red');    // 高亮末尾项
    playSound('powerup');
    drawPixelBlock(k+n, 'blue');
  }
  // ...其他情况类似
}
```

---

### **代码实现（关键片段）**

```cpp
// continueOI 的核心逻辑
if (n%4 == 0) {
    for (int i=1; i<=n; i++) cout << i << ' ';
} else if (n%4 == 1) {
    int k = 1;
    while (k < n) k *= 2;
    cout << k << ' ' << k + n << '\n';
} else if (n%4 == 2) {
    cout << n-1 << ' ' << n+1 << '\n';
} else {
    int k = 1;
    while (k < n) k *= 2;
    cout << k << ' ' << k + n-1 << '\n';
}
```

---
处理用时：80.54秒
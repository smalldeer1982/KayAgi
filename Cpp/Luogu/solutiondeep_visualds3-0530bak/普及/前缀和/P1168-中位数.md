# 题目信息

# 中位数

## 题目描述

给定一个长度为 $N$ 的非负整数序列 $A$，对于前奇数项求中位数。

## 说明/提示

对于 $20\%$ 的数据，$N \le 100$；

对于 $40\%$ 的数据，$N \le 3000$；

对于 $100\%$ 的数据，$1 \le N ≤ 100000$，$0 \le A_i \le 10^9$。


## 样例 #1

### 输入

```
7
1 3 5 7 9 11 6```

### 输出

```
1
3
5
6```

## 样例 #2

### 输入

```
7
3 1 5 9 8 7 6```

### 输出

```
3
3
5
6```

# AI分析结果



## 唯一算法分类
**对顶堆**

---

## 综合分析与结论

### 核心思路
通过维护两个堆（大根堆存较小元素，小根堆存较大元素），动态维护中位数。每次插入元素后调整堆的大小差，保证大根堆元素个数 ≥ 小根堆且差 ≤1。奇数次插入时，大根堆堆顶即为中位数。

### 核心难点与解决方案
1. **堆的维护逻辑**：每次插入元素需判断归属堆，若新元素 ≤ 大根堆顶则入大根堆，否则入小根堆。
2. **平衡调整**：若两堆大小差超过 1，将较大堆顶元素移到另一堆。
3. **时间复杂度**：每次插入调整的堆操作为 O(log n)，总复杂度 O(n log n)。

### 可视化设计思路
1. **动态堆展示**：用不同颜色区分两个堆，大根堆显示为蓝色方块，小根堆显示为红色方块。
2. **插入动画**：新元素根据比较结果飞入对应堆，伴随箭头指示移动路径。
3. **平衡调整高亮**：当大小差超过 1 时，转移的堆顶元素闪烁提示。
4. **中位数标记**：当前中位数（大根堆顶）用金色边框高亮。

---

## 题解清单 (≥4星)

1. **肖恩Sean（赞：525）★★★★★**  
   - **亮点**：双堆思路清晰，代码简洁，维护堆大小差逻辑严谨。
   - **核心代码**：
     ```cpp
     while (abs(q1.size() - q2.size()) > 1)
         if (q1.size() > q2.size()) q2.push(q1.top()), q1.pop();
         else q1.push(q2.top()), q2.pop();
     ```

2. **IRipple（赞：365）★★★★☆**  
   - **亮点**：引入 mid 变量辅助调整，逻辑更直观。
   - **关键点**：根据 mid 判断插入堆，调整后 mid 作为中位数。

3. **小黑AWM（赞：24）★★★★☆**  
   - **亮点**：链表离线算法，逆向删除元素维护指针，时间复杂度 O(n)。

---

## 核心代码实现

### 双堆法代码片段
```cpp
priority_queue<int> q1; // 大根堆存较小元素
priority_queue<int, vector<int>, greater<int>> q2; // 小根堆存较大元素

void insert(int x) {
    if (q1.empty() || x <= q1.top()) q1.push(x);
    else q2.push(x);
    
    // 平衡堆大小
    while (q1.size() > q2.size() + 1) {
        q2.push(q1.top());
        q1.pop();
    }
    while (q2.size() > q1.size()) {
        q1.push(q2.top());
        q2.pop();
    }
}

int get_median() {
    return q1.top(); // 奇数长度时中位数
}
```

---

## 可视化与算法演示

### 动画方案
1. **初始状态**：两个空堆，大根堆在左，小根堆在右。
2. **插入元素**：
   - 元素飞向对应堆，若命中边界值，显示比较逻辑（如：`5 ≤ 7 → 入大根堆`）。
3. **调整过程**：
   - 当堆大小差超过 1，较大堆顶元素闪烁并移动到另一堆。
4. **中位数标识**：当前中位数始终用金色边框标记，随调整动态变化。

### 复古像素风格
- **颜色方案**：大根堆蓝色（#0000FF），小根堆红色（#FF0000），中位数金色（#FFD700）。
- **Canvas 绘制**：每个元素显示为 16x16 像素方块，堆顶元素上方显示数值。
- **音效**：插入时播放 8-bit "blip"，调整时播放 "click"，获取中位数播放 "success"。

---

## 同类型题推荐
1. **P1801 黑匣子**：动态维护第 K 大数，双堆的直接应用。
2. **P3871 中位数**：类似问题，需快速查询动态中位数。
3. **P3369 普通平衡树**：练习更复杂的数据结构维护有序集合。

---
处理用时：86.99秒
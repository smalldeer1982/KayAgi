# 题目信息

# 宝石串

## 题目描述

有一种宝石串，由绿宝石和红宝石串成，仅当绿宝石和红宝石数目相同的时候，宝石串才最为稳定，不易断裂。安安想知道从给定的宝石串中，可以截取一段最长的稳定的宝石串，有多少颗宝石组成。请你帮助他。

绿宝石用 $\texttt G$ 表示，红宝石用 $\texttt R$ 表示。


## 说明/提示

$\texttt {RGGR}$ 为答案。

宝石数小于等于 $10^6$。


## 样例 #1

### 输入

```
GRGGRG```

### 输出

```
4```

# AI分析结果



**唯一算法分类**  
前缀和与哈希表

---

### **题解思路、算法要点与解决难点**  
**核心思路**：  
将字符转换为数值（G为+1，R为-1），计算前缀和。当两个位置的前缀和相等时，说明这两个位置之间的子串G和R数量相等。通过哈希表记录每个前缀和第一次出现的位置，计算最大长度。

**解决难点**：  
1. **负数处理**：前缀和可能为负数，需通过偏移量（如+1e6）映射到数组下标。  
2. **初始条件**：前缀和为0时对应的位置需初始化为-1或0（视为从起点开始）。  
3. **高效查询**：哈希表需在O(1)时间内查询前缀和首次出现位置。

**算法对比**：  
| 题解作者       | 实现差异               | 关键优化点                     |  
|----------------|------------------------|------------------------------|  
| 在想Peach      | 差值数组+实时更新      | 简洁代码，动态维护哈希表       |  
| MloVtry        | 统一偏移量+n           | 明确处理负数，规范化的前缀和   |  
| altar          | 三目运算符简化逻辑     | 代码可读性高，注释详细         |  
| 暴力枚举类     | 双重循环统计差值       | 仅适用于小数据，无法通过1e6   |  

---

### **题解评分 (≥4星)**  
1. **在想Peach（5星）**  
   - 思路清晰：差值数组动态维护，实时更新最大长度。  
   - 代码简洁：仅用单循环完成哈希表记录和结果计算。  
   - 优化亮点：偏移量处理负数，避免数组越界。  

2. **MloVtry（4.5星）**  
   - 规范实现：前缀和数组显式构建，便于调试。  
   - 严格处理：初始化哈希表为极大值，避免误判。  

3. **altar（4星）**  
   - 详细注释：解释偏移量和区间计算逻辑。  
   - 代码简洁：使用三目运算符简化条件判断。  

---

### **最优思路提炼**  
1. **前缀和转换**：将字符转换为数值（G=+1，R=-1），问题转化为寻找和为0的最长子数组。  
2. **哈希表优化**：用数组模拟哈希表，记录每个前缀和首次出现的位置，空间换时间。  
3. **偏移量技巧**：前缀和可能为负，统一加上1e6等偏移量映射到合法数组下标。  

```cpp
// 核心代码片段（在想Peach的题解）
int last = 1e6; // 初始偏移量
for (int i = 1; i <= s.length(); i++) {
    if (s[i-1] == 'R') last++;
    else last--;
    if (!p[last]) p[last] = i; // 记录首次出现位置
    else ans = max(ans, i - p[last]); // 计算长度
    if (last == 1e6) ans = i; // 处理前缀和为0的特殊情况
}
```

---

### **同类型题或类似算法套路**  
1. **和为k的子数组数量**：利用前缀和与哈希表统计区间和。  
2. **最长连续子数组和为0**：与本题完全相同思路。  
3. **最长平衡子串**：处理0和1的平衡问题。  

---

### **推荐洛谷题目**  
1. P1115 最大子段和（前缀和变形）  
2. P1719 寻找最长的平衡子串（同类问题）  
3. P3253 子数组异或和（哈希表+前缀和）  

---

### **个人心得摘录**  
- **在想Peach**：强调“差值的同位相等性”，通过实时更新哈希表避免二次遍历。  
- **altar**：注释中提到“区间长度不需要+1”，因哈希表记录的是前缀和的结束位置。  
- **暴力枚举题解**：反思“数据水”导致通过，提醒算法选择的重要性。  

---

### **可视化与算法演示**  
**动画设计**：  
1. **像素风格界面**：  
   - 字符显示为8-bit像素块（G绿色，R红色）。  
   - 前缀和数值以浮动标签显示在字符上方。  
   - 哈希表用网格表示，高亮当前更新的位置。  

2. **核心流程演示**：  
   - **步进执行**：逐个字符处理，更新前缀和与哈希表。  
   - **高亮标记**：当前字符颜色闪烁，哈希表对应位置显示“首次记录”或“命中计算”。  
   - **结果提示**：找到更长长度时播放上扬音效，显示红色边框标记子串范围。  

**交互功能**：  
- **速度调节**：滑动条控制动画速度（0.5x~3x）。  
- **单步模式**：按空格键逐字符执行，观察哈希表变化。  
- **音效反馈**：命中时播放“叮”声，错误时“哔”声。  

**复古特效**：  
- 背景音乐：8-bit芯片风格循环旋律。  
- 过关效果：找到最长子串时，屏幕抖动+烟花像素动画。  

---

**总结**：通过前缀和与哈希表的结合，将问题转化为O(n)的高效解法，辅以偏移量处理负数，是此类问题的标准解法。可视化设计通过复古像素风格和交互式步进，直观展示算法核心流程。

---
处理用时：75.35秒
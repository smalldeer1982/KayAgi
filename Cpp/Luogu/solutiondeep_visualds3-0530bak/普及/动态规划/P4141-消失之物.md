# 题目信息

# 消失之物

## 题目描述

ftiasch 有 $n$ 个物品, 体积分别是 $w_1,w_2,\dots,w_n$。由于她的疏忽，第 $i$ 个物品丢失了。   

“要使用剩下的 $n-1$ 物品装满容积为 $x$ 的背包，有几种方法呢？”——这是经典的问题了。  

她把答案记为 $\text{cnt}(i,x)$ ，想要得到所有$i \in [1,n]$, $x \in [1,m]$ 的 $\text{cnt}(i,x)$ 表格。

![](https://cdn.luogu.com.cn/upload/pic/13426.png)


## 说明/提示

【数据范围】  
对于 $100\%$ 的数据，$1\le n,m \le 2000$，且 $1\le v_i\le m$。

【样例解释】  
如果物品 3 丢失的话，只有一种方法装满容量是 2 的背包，即选择物品 1 和物品 2。

---

$\text{upd 2023.8.11}$：新增加五组 Hack 数据。


## 样例 #1

### 输入

```
3 2
1 1 2```

### 输出

```
11
11
21```

# AI分析结果



## 算法分类
**0-1背包**

---

## 题解分析与结论
### **核心思路**
题目要求计算**排除每个物品后，装满背包的方案数**。通过两步解决：
1. **预处理完整背包**：计算所有物品的背包方案数 `f[j]`。
2. **退背包操作**：对每个物品 `i`，用 `f[j]` 递推出不包含 `i` 的方案数 `g[j]`。

### **状态转移方程**
- **完整背包**：`f[j] += f[j - w[i]]`（倒序枚举）。
- **退背包**：`g[j] = (f[j] - g[j - w[i]] + 10) % 10`（正序枚举）。

### **解决难点**
1. **逆向思维**：从完整背包中减去特定物品的贡献，而非重新计算。
2. **顺序问题**：原背包倒序更新，退背包正序撤销。
3. **负数处理**：加 `10` 后取模，避免负数。

### **可视化设计**
- **动画演示**：用网格展示 `f` 和 `g` 数组，高亮当前处理的 `j` 和 `j - w[i]`。
- **像素风格**：每个格子为像素方块，转移时闪烁，音效提示更新。
- **自动模式**：模拟背包更新和退背包的自动执行流程。

---

## 高星题解推荐（≥4星）
1. **Kelin（5星）**  
   - **亮点**：简洁的退背包实现，直接正序撤销转移。
   ```cpp
   memcpy(g, f, sizeof f);
   for (int j = w[i]; j <= m; ++j)
       g[j] = (g[j] - g[j - w[i]] + 10) % 10;
   ```
2. **Gary818（4.5星）**  
   - **亮点**：清晰的总方案数-选i方案数思路，代码易读。
   ```cpp
   if (w[i] > x) g[x] = f[x] % 10;
   else g[x] = (f[x] - g[x - w[i]] + 10) % 10;
   ```
3. **7KByte（4星）**  
   - **亮点**：数学证明退背包正确性，强调物品顺序无关性。

---

## 关键代码实现
```cpp
int f[N], g[N], w[N];
int main() {
    // 预处理完整背包
    f[0] = 1;
    for (int i = 1; i <= n; ++i)
        for (int j = m; j >= w[i]; --j)
            f[j] = (f[j] + f[j - w[i]]) % 10;

    // 退背包求每个i的g数组
    for (int i = 1; i <= n; ++i) {
        g[0] = 1;
        for (int j = 1; j <= m; ++j) {
            if (j < w[i]) g[j] = f[j] % 10;
            else g[j] = (f[j] - g[j - w[i]] + 10) % 10;
            cout << g[j];
        }
        cout << endl;
    }
}
```

---

## 同类型拓展
- **类似问题**：动态规划中排除特定元素的影响（如子集和问题）。
- **通用套路**：预处理全量状态，逆向推导局部排除状态。

---

## 推荐题目
1. [P1048 采药](https://www.luogu.com.cn/problem/P1048)  
   **标签**：0-1背包基础
2. [P1064 金明的预算方案](https://www.luogu.com.cn/problem/P1064)  
   **标签**：依赖背包
3. [P1156 垃圾陷阱](https://www.luogu.com.cn/problem/P1156)  
   **标签**：动态规划状态设计

---

## 个人心得
- **调试教训**：必须加 `+10` 处理负数取模，否则样例可能通过但WA。
- **顿悟点**：退背包的顺序与原背包相反（正序撤销倒序操作）。

---

## 可视化方案
### **动态规划演示**
1. **初始状态**：展示完整的 `f` 数组（绿色格子）。
2. **退背包过程**：  
   - 红色高亮当前物品 `i` 和对应的 `w[i]`。
   - 黄色标记正在更新的 `g[j]` 和 `j - w[i]`。
3. **音效**：  
   - 更新格子时播放短促“滴”声。
   - 负数修正时播放“咔嚓”声。

### **复古像素风格**
- **8位调色板**：深绿（`f` 数组）、浅蓝（`g` 数组）、红色（当前操作）。
- **Canvas 动画**：网格绘制，每步更新后刷新格子颜色。
- **自动播放**：按空格暂停/继续，方向键调整速度。

---
处理用时：110.27秒
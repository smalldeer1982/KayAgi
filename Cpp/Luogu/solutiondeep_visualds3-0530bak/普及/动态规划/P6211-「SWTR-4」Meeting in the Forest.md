# 题目信息

# 「SWTR-4」Meeting in the Forest

## 题目背景

每当月圆时分，五个族群的族猫们都会聚集在小岛上，进行每月的森林大会。蒟星为了了解其它五族猫的特点，就扮成了一只独行猫来到小岛上……

## 题目描述

森林大会上有 $n$ 只猫，每只猫的武力值为 $a_i$，于是蒟星列出了下面这样一个方程：

$$x^n+\sum_{i=1}^{n}a_ix^{n-i}=0$$

- 通俗地讲，这个方程就是 $x^n+a_1x^{n-1}+a_2x^{n-2}+\cdots+a_{n-1}x+a_n=0$。

蒟星根据 TA 优（cu）秀（bi）的数学知识可以知道，这个方程在复数集内有 $n$ 个根，不妨把这 $n$ 个根设为 $x_1, x_2, ..., x_n$。

接下来蒟星想要知道森林大会上的猫的实力如何，于是列出了下面一个表达式：

$$\sum_{i=1}^{n}(b_i\times \sum_{1\le j_1 < j_2 <\cdots< j_i \le n}^{n}x_{j_1}x_{j_2}\cdots x_{j_i})$$

- $\sum_{1\le j_1 < j_2 < \cdots < j_i \le n}^{n}x_{j_1}x_{j_2}\cdots x_{j_i}$ 就是从方程的 $n$ 个根中选出 $i$ 个，求所有可能方案的 $i$ 个根的乘积之和。

但蒟星只要这个表达式对 $10^9+7$ 取模后的值就好了。

- 若答案为负数 $a$，请输出 $a + (10^9+7)$。

蒟星把这个任务交给了您，不过他已经告诉你了 $n$，$a_i$ 和 $b_i$，您能帮帮 TA 吗？

## 说明/提示

【样例 $1$ 说明】

原方程为 $x^2-2x+1=0$，此时 $x_1=x_2=1$。

表达式的值为 $x_1+x_2+x_1x_2=1+1+1=3$。

【样例 $2$ 说明】

原方程为 $x^3-3x^2+4=0$，此时 $x_1=-1,x_2=x_3=2$。

表达式的值为 

$$\begin{aligned}&2\cdot (x_1+x_2+x_3)+3\cdot(x_1x_2+x_1x_3+x_2x_3)+4\cdot x_1x_2x_3\\=\ &2\times(-1+2+2)+3\times(-2+(-2)+4)+4\times (-4)\\=\ &-10\end{aligned}$$

因为 $-10$ 为负数，所以输出 $-10+(10^9+7)=999999997$。

【数据范围与约定】

对于 $10\%$ 的数据，$n=1$。

对于另外 $20\%$ 的数据，$n=2$。

对于 $40\%$ 的数据，$n\leq 10$。

对于 $60\%$ 的数据，$n\leq 10^3$。

对于 $100\%$ 的数据，$1\leq n \le 2 \times 10^5$，$-10^9 \le a_i, b_i \le 10^9$。

【Tips】

[韦达定理](https://baike.baidu.com/item/%E9%9F%A6%E8%BE%BE%E5%AE%9A%E7%90%86/105027?fr=aladdin)也许会对你有帮助。

【Source】

[Sweet Round 04](https://www.luogu.com.cn/contest/26414)$\ \ $C

idea & std：[蒟蒻的名字](https://www.luogu.com.cn/user/147999)

## 样例 #1

### 输入

```
2
-2 1
1 1```

### 输出

```
3```

## 样例 #2

### 输入

```
3
-3 0 4
2 3 4```

### 输出

```
999999997```

# AI分析结果



### 算法分类
**数学定理应用（韦达定理）**

---

### 题解思路与核心难点
1. **核心思路**  
   题目所求表达式等价于 $\sum_{i=1}^n (-1)^i \cdot a_i \cdot b_i$。通过韦达定理可知，方程的根 $x_j$ 的 $i$ 个乘积之和等于 $(-1)^i \cdot a_i$，直接代入公式即可。

2. **解决难点**  
   - **韦达定理的扩展应用**：将 $n$ 次方程的根与系数关系推广到任意项，推导出 $\sum x_{j_1}x_{j_2}\dots x_{j_i} = (-1)^i \cdot a_i$。
   - **符号处理**：奇数项需取负，偶数项取正，通过 $i$ 的奇偶性动态调整符号。

---

### 题解评分（≥4星）
1. **Rubidium_Chloride（5星）**  
   - 思路清晰，完整推导韦达定理与表达式的等价性。  
   - 代码简洁高效，使用 `flag` 变量动态计算符号。  
   - 包含详细的数学证明和样例分析，适合不同水平读者。

2. **Scrutiny（4星）**  
   - 简明扼要，直接点出韦达定理的应用。  
   - 代码通过奇偶判断处理符号，逻辑清晰。  
   - 缺少详细推导，但代码可读性强。

3. **Warriors_Cat（4星）**  
   - 分步骤推导韦达定理，适合初学者理解。  
   - 代码中通过位运算判断奇偶性，优化符号计算。  
   - 强调取模细节，避免负数错误。

---

### 最优思路与技巧提炼
- **关键公式**：$\sum_{i=1}^n (-1)^i \cdot a_i \cdot b_i$，直接利用韦达定理将根的计算转化为系数运算。
- **符号优化**：通过奇偶性判断或交替变量（如 `flag *= -1`）高效处理正负号。
- **负数取模**：最终结果若为负，需加上模数再取模。

---

### 同类型题与算法套路
- **通用解法**：多项式根与系数的关系问题，可通过韦达定理或生成函数快速转换。
- **类似题目**：  
  - 洛谷 P1067（多项式输出，符号处理）  
  - 洛谷 P1024（一元三次方程求解，韦达定理应用）  
  - 洛谷 P2312（解方程，多项式求值优化）

---

### 代码实现（核心逻辑）
```cpp
#include <iostream>
using namespace std;
const int MOD = 1e9 + 7;

int main() {
    int n;
    cin >> n;
    long long ans = 0;
    int a[n+1], b[n+1];
    for (int i = 1; i <= n; ++i) cin >> a[i];
    for (int i = 1; i <= n; ++i) cin >> b[i];
    
    int sign = 1; // 符号变量，初始为+1
    for (int i = 1; i <= n; ++i) {
        ans = (ans + sign * a[i] * b[i]) % MOD;
        sign *= -1; // 交替符号
    }
    cout << (ans % MOD + MOD) % MOD; // 处理负数
    return 0;
}
```

---

### 可视化设计（像素动画演示）
1. **动画效果**  
   - **Canvas 网格**：将每个 $i$ 的计算步骤映射到网格单元，高亮当前处理的 $a_i$ 和 $b_i$。
   - **符号变化**：用红色（负）和绿色（正）动态显示符号交替过程。
   - **累加效果**：每次计算后，用黄色方块表示当前项的值，并显示累加结果。

2. **交互设计**  
   - **步进控制**：允许用户点击“下一步”观察符号变化和累加过程。
   - **音效提示**：每次符号切换时播放8-bit音效，累加成功时播放胜利音效。

3. **复古风格**  
   - **调色板**：使用FC红白机风格的16色调色板（如深蓝背景、亮黄高亮）。
   - **像素字体**：用8-bit字体显示公式和中间结果，增强怀旧感。

---

### 总结
本题通过韦达定理将复杂的根运算简化为系数运算，是数学思维与编程结合的典型范例。关键点在于快速识别题目背后的数学规律，并通过符号优化和取模处理实现高效计算。

---
处理用时：74.51秒
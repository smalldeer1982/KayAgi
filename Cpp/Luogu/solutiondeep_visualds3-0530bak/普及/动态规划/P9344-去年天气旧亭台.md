# 题目信息

# 去年天气旧亭台

## 题目背景

依旧是过往的天气，过往的楼台烟雨。时间悄悄流逝着，山河仍在，人却已不是过去的人……

## 题目描述

登上楼台，旧时满面沉灰的地板映入眼帘。

共有 $n$ 块地板，地板分为两类，第 $i$ 块地板的类别用 $c_i$ 表示，积灰程度用 $a_i$ 表示。**注意 $c_i$ 为 $0$ 或 $1$。**

现在要清理这些地板上的灰尘。每次操作中，你可以：

+ 选择两个下标 $i,j$，满足 $1\leq i\leq j\leq n$， $c_i=c_j$，**且第 $i$ 块和第 $j$ 块地板上的灰尘均未被清理过**；
+ 花费 $a_i+a_j$ 的能量清理**第 $i$ 块到第 $j$ 块所有地板**上的灰尘。

求清理完所有地板上的灰尘至少要多少能量。

## 说明/提示

**【样例 1 解释】**

- 对于第一组数据，直接花费 $a_1+a_6=5$ 的能量清理所有灰尘。
- 对于第二组数据，先花费 $a_1+a_1=6$ 的能量清理第一个地板上的灰尘，再花费 $a_2+a_8=7$ 的能量清理剩余灰尘。

**【数据规模与约定】**

对于 $10\%$ 的数据，保证 $T\le 10$，$n\le 10$；

对于 $40\%$ 的数据，保证 $T\le 20$，$n\le 10^3$；

另有 $10\%$ 的数据，保证 $c_i=1$；

对于 $100\%$ 的数据，保证 $1 \le T \le 10^5$，$1 \le n,\sum n\le 2 \times 10^6$，$c_i \in \{0,1\}$，$1 \le a_i \le 10^9$。

## 样例 #1

### 输入

```
2
6
1 1 4 5 1 4
1 0 0 1 0 1
8
3 1 4 1 5 9 2 6
1 0 1 0 1 0 1 0```

### 输出

```
5
13```

# AI分析结果



## 算法分类  
**线性DP**

---

## 综合分析与结论  
### 核心思路  
题目核心在于通过最少的操作覆盖所有地板，关键在于首尾类型分析和区间合并策略：  
1. **首尾同色**：直接选择整个区间，代价为 `a[1]+a[n]`，其他操作必然包含这两个端点且总代价更高。  
2. **首尾异色**：必须找到分割点 `i` 满足 `c[1]=c[i]` 且 `c[i+1]=c[n]`，分割为两个区间处理，代价为 `a1+ai + ai+1+an`。  

### 动态规划优化  
- **状态定义**：`dp[i]` 表示清理前 `i` 块地板的最小代价。  
- **转移方程**：`dp[i] = a[i] + min{ dp[j-1] + a[j] }` （`j` 需满足 `c[j] = c[i]`）  
- **优化思路**：维护两个变量 `min0` 和 `min1` 分别记录类型 `0/1` 的最小 `dp[j-1]+a[j]`，将时间复杂度从 `O(n²)` 降为 `O(n)`。  

### 可视化设计  
- **DP 矩阵更新**：以网格展示 `dp` 数组，每次更新时高亮当前 `i` 和对应类型的最小值来源。  
- **像素动画**：使用 8-bit 风格展示地板序列，首尾同色时整体变绿，异色时扫描分割点并闪烁提示最优 `i`。  
- **音效设计**：状态更新时播放“滴”声，找到分割点时播放“叮咚”音效，错误操作触发短促警报。  

---

## 题解清单 (≥4星)  
1. **作者：_JF_（5星）**  
   - **亮点**：简洁的贪心策略，数学证明严谨，代码高效。  
   - **关键代码**：直接判断首尾类型，线性扫描分割点。  

2. **作者：Iniaugoty（4.5星）**  
   - **亮点**：DP 状态转移方程优化到极致，空间复杂度 `O(1)`。  
   - **代码片段**：维护 `min0/min1` 变量，实时更新避免冗余计算。  

3. **作者：ncwzdlsd（4星）**  
   - **亮点**：DP 代码可读性极强，适合教学演示。  
   - **核心逻辑**：分类型维护前缀最小值，清晰体现优化思想。  

---

## 最优思路/技巧提炼  
1. **贪心分割**：首尾异色时，最优解仅需分割一次，避免多段操作增加总代价。  
2. **DP 前缀优化**：将 `min{ dp[j-1] + a[j] }` 拆分为类型相关的前缀最小值，实现线性复杂度。  
3. **数学反证法**：证明分割点必然存在，确保算法正确性。  

---

## 同类题目推荐  
1. **P1880 石子合并**：区间 DP 经典问题，需合并相邻元素求最小代价。  
2. **P1005 矩阵取数游戏**：动态维护行首尾选择的最优解。  
3. **P1091 合唱队形**：线性 DP 结合前后缀最值思想。  

---

## 个人心得摘录  
- **作者：Iniaugoty**：“转移方程中的 `a_i` 是定值，将 `min` 拆分为类型相关变量是优化关键。”  
- **作者：Cure_Wing**：“贪心策略看似简单，但需严格证明分割点存在性，否则易陷入逻辑漏洞。”  
- **调试教训**：多篇题解强调 `long long` 必要性，`a[i]` 范围大易导致溢出。  

---

## 动态规划可视化代码片段（JavaScript）  
```javascript
// 初始化 Canvas 和音效  
const grid = initCanvas(n);  
let min0 = Infinity, min1 = Infinity;  

for (let i = 0; i < n; i++) {  
  const type = c[i];  
  // 更新最小值  
  if (type === 0) {  
    min0 = Math.min(min0, (i === 0 ? 0 : dp[i-1]) + a[i]);  
    dp[i] = min0 + a[i];  
  } else {  
    min1 = Math.min(min1, (i === 0 ? 0 : dp[i-1]) + a[i]);  
    dp[i] = min1 + a[i];  
  }  
  // 高亮当前块和最小值来源  
  grid.highlight(i, type);  
  playSound('beep');  
}  
```

---

## 复古像素风格设计  
- **调色板**：16 色 FC 风格，绿色表示已清理，红色为待清理。  
- **动画帧**：每步更新后暂停 200ms，自动模式可调整速度。  
- **音效触发**：`min0/min1` 更新时播放不同音调，最终答案显示时播放胜利音乐。  

通过交互式动画，用户可直观观察 DP 状态如何被前缀最小值优化，理解贪心分割点的选择逻辑。

---
处理用时：56.50秒
# 题目信息

# [CCC 2023 S2] Symmetric Mountains

## 题目描述

Rebecca 是一名导游，正在为她的杂志推广落基山脉。她最近拍了一张包含 $N$ 座山的美丽照片，其中从左到右第 $i$ 座山的高度为 $h_i$。她将为她的杂志裁剪这张照片，可能会从照片的左侧移除一些山，也可能会从照片的右侧移除一些山。也就是说，裁剪包括从第 $l$ 座山到第 $r$ 座山的连续山峰，其中 $l \leq r$。为了取悦她的杂志读者，Rebecca 将尝试找到最对称的裁剪。

我们将裁剪的不对称值定义为从裁剪的中点开始，每对等距山峰的高度差的绝对值之和。为了帮助理解这个定义，注意到一个数 $v$ 的绝对值，记为 $|v|$，是 $v$ 的非负值：例如 $|-6| = 6$ 和 $|14| = 14$。裁剪的不对称值是所有 $|h_{l+i} - h_{r-i}|$ 的和，其中 $0 \leq i \leq \frac{r-l}{2}$。换句话说，我们从外向内配对山峰，计算每对山峰高度差的绝对值，并将它们相加。

因为 Rebecca 不知道照片需要多宽，所以对于所有可能的裁剪长度，找到不对称值最小的裁剪（即最对称的裁剪）。

## 说明/提示

对样例输入 1 的输出解释：

我们将展示为什么从左数第五个值是 2。让我们尝试计算所有长度为 5 的裁剪的不对称值。

第一个裁剪中山的高度是 $[3, 1, 4, 1, 5]$。这个裁剪的不对称值是 $|3 - 5| + |1 - 1| + |4 - 4| = 2$。

第二个裁剪中山的高度是 $[1, 4, 1, 5, 9]$。这个裁剪的不对称值是 $|1 - 9| + |4 - 5| + |1 - 1| = 9$。

最后一个裁剪中山的高度是 $[4, 1, 5, 9, 2]$。这个裁剪的不对称值是 $|4 - 2| + |1 - 9| + |5 - 5| = 10$。

因此，长度为 5 的最对称裁剪是不对称值为 2 的裁剪。

对样例输入 2 的输出解释：

这个样例满足第二个子任务。注意，唯一长度为 4 的裁剪是 $[1, 3, 5, 6]$，其不对称值为 $|1 - 6| + |3 - 5| = 7$。

**本题采用捆绑测试**：

- 子任务 1（5 分）：$1\leq N \leq 300$，$0\leq h_i \leq 10^5$。

- 子任务 2（5 分）：$1 \leq N \leq 5000$，$0 \leq h_i \leq 10^5$，保证山的高度从左到右单调不减。

- 子任务 3（5 分）：$1\leq N\leq 5000$，$0 \leq h_i \leq 10^5$。

题面翻译由 ChatGPT-4o 提供。

## 样例 #1

### 输入

```
7
3 1 4 1 5 9 2```

### 输出

```
0 2 0 5 2 10 10```

## 样例 #2

### 输入

```
4
1 3 5 6```

### 输出

```
0 1 3 7```

# AI分析结果



## 算法分类
**区间动态规划** 与 **中心扩展法**

---

## 题解思路与核心分析

### 核心思路
所有题解围绕如何高效计算区间不对称值展开。暴力法复杂度 O(n³) 不可行，需优化到 O(n²)。关键突破点在于发现**对称性叠加规律**：
- **区间DP**：当前区间 [i,j] 的不对称值 = 内部区间 [i+1,j-1] 的不对称值 + 两端点差的绝对值
- **中心扩展**：以每个点/每对相邻点为中心向外扩展，计算所有奇偶长度区间的不对称值

### 解决难点对比
| 方法           | 实现难点                          | 优化点                                 |
|----------------|-----------------------------------|----------------------------------------|
| 暴力枚举       | O(n³) 超时                        | 无                                     |
| 区间DP         | 正确推导状态转移方程               | 直接递推，空间换时间                   |
| 中心扩展       | 奇偶区间的统一处理                 | 自然覆盖所有可能情况，无需额外判断     |
| 记忆化递归     | 递归栈溢出风险                    | 理论正确但实践效率较低                 |

---

## 精选题解评分（≥4星）

1. **ZepX_D（中心扩展法） ★★★★★**  
   - **亮点**：代码最简洁（仅20行），时间复杂度严格 O(n²)，自然处理奇偶情况  
   - **代码**：  
     ```cpp
     while(l && r <=n) {
         ans[r-l+1] = min(ans[...], s);
         l--, r++, s += abs(...);
     }
     ```

2. **玄学OIER荷蒻（区间DP） ★★★★☆**  
   - **亮点**：标准区间DP模板，代码清晰易懂，适合教学  
   - **核心转移**：  
     ```cpp
     dp[i][i+j-1] = dp[i+1][i+j-2] + abs(h[i]-h[i+j-1]);
     ```

3. **charlieqi（区间DP） ★★★★☆**  
   - **亮点**：最简DP实现，直接维护最小值变量  
   - **关键代码**：  
     ```cpp
     for(int len=1; len<=n; len++){
         minn = 1e9;
         for(int j=1; j+len-1<=n; j++)
             dp[j][len+j-1] = ...;
     }
     ```

---

## 最优思路提炼
**中心扩展法**为最优实践：
1. **枚举中心点**：每个点作为奇数长度中心，每对相邻点作为偶数长度中心  
2. **双指针扩展**：从中心向左右扩展，累加不对称值  
3. **实时更新答案**：每扩展一步，更新对应长度的最小值  

**关键代码片段**：
```cpp
for(int i=1; i<=n; i++) { // 奇数中心
    s=0, l=r=i;
    while(l>=1 && r<=n) {
        ans[r-l+1] = min(ans[...], s);
        l--, r++, s += abs(h[r]-h[l]);
    }
}
for(int i=1; i<n; i++) { // 偶数中心
    s=abs(h[i]-h[i+1]), l=i, r=i+1;
    while(...) { ... }
}
```

---

## 同类型题目推荐
1. **最长回文子串**（LeetCode 5） - 中心扩展法的经典应用  
2. **统计不同回文子序列**（LeetCode 730） - 区间DP与回文结合  
3. **让字符串成为回文串的最少插入次数**（LeetCode 1312） - 区间DP变形  

---

## 可视化设计
**动画方案**：  
1. **像素风格Canvas展示**：  
   - 山高用不同颜色像素块表示（如绿色渐变）  
   - **中心点高亮**：红色像素标记当前扩展中心  
   - **扩展过程**：左右指针（蓝色/黄色像素）向外移动，每次扩展时显示当前差值  
   - **音效**：每次扩展播放8-bit音效，找到更优解时触发胜利音效  

**交互功能**：  
- **速度调节**：滑块控制动画速度（50ms~2s/步）  
- **模式切换**：动态规划填表 vs 中心扩展实景  
- **数据回放**：结束时可回看关键帧（最小值的更新过程）  

---

## 核心算法演示（中心扩展法）
```javascript
// 伪代码示例：Canvas绘制扩展过程
function drawExpansion(center, isEven) {
    let l = center, r = isEven ? center+1 : center;
    while (l >=0 && r < n) {
        ctx.fillStyle = '#FF0000'; // 红色标记当前对
        ctx.fillRect(l*10, 100 - h[l], 10, h[l]);
        ctx.fillRect(r*10, 100 - h[r], 10, h[r]);
        playSound('blip'); // 8-bit音效
        await sleep(speed);
        l--; r++;
    }
}
```

---

通过对比各题解，**中心扩展法**在代码简洁性与效率平衡上表现最优，而**区间DP**更易理解。实际编码时可优先尝试中心扩展法，理解其对称性处理的精妙之处。

---
处理用时：80.39秒
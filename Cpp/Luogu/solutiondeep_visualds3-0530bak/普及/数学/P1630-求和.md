# 题目信息

# 求和

## 题目描述

求 $1^b+2^b+\cdots + a^b$ 的和除以 $10^4$ 的余数。

## 说明/提示

对于 $30\%$ 的数据，$N \le 10$，$a,b \le 10^3$。

对于 $100\%$ 的数据，$1 \le N \le 100$，$1 \le a,b \le 10^9$。

## 样例 #1

### 输入

```
1
2 3
```

### 输出

```
9
```

# AI分析结果



# 数论

## 题解思路与算法要点

### 核心数学原理
1. **模数周期性**  
   $(x + 10000)^b \equiv x^b \pmod{10000}$，允许将大数计算转化为模数范围内的计算  
2. **前缀和分块**  
   预处理 $1$ 至 $10000$ 的 $i^b \bmod{10000}$ 前缀和，将 $a$ 分解为 $k \times 10000 + r$  
   最终结果公式：  
   $$\text{ans} = \left( \left\lfloor \frac{a}{10000} \right\rfloor \times \text{sum}[10000] + \text{sum}[a\%10000] \right) \bmod{10000}$$

### 解决难点
- **大数处理**：$a$ 可达 $1e9$，直接计算 $O(a)$ 不可行  
- **指数优化**：利用快速幂将 $i^b$ 计算复杂度从 $O(b)$ 降为 $O(\log b)$  
- **空间优化**：仅需存储 $10000$ 长度的前缀和数组

### 关键公式推导
- **快速幂公式**  
  $$a^b \equiv (a\%10000)^b \pmod{10000}$$  
  通过位运算实现 $O(\log b)$ 计算  
- **欧拉定理优化（进阶）**  
  $\varphi(10000)=4000$，可将指数优化为 $b\%4000$  
  $$i^b \equiv i^{b\%4000} \pmod{10000}$$

---

## 题解评分（≥4星）

### 1. 摸鱼（5星）
- **亮点**：代码简洁，预处理与公式推导清晰  
- **代码片段**：
```cpp
LL ans = (a/10000 * sum[10000] + sum[a%10000]) % mod;
```

### 2. JustinRochester（5星）
- **亮点**：引入欧拉定理优化指数，数学推导详尽  
- **核心代码**：
```cpp
d_B = read() % 4000;  // 欧拉定理优化指数
```

### 3. TRZ_2007（4星）
- **亮点**：分块逻辑表述清晰，代码可读性强  
- **公式推导**：
$$\sum_{i=1}^a i^b \equiv k \times S_{10000} + S_r \pmod{10000}$$

---

## 最优思路提炼

### 核心步骤
1. **预处理**：计算 $1$ 至 $10000$ 的 $i^b \bmod{10000}$ 前缀和  
2. **分块计算**：将 $a$ 分解为 $k \times 10000 + r$  
3. **快速幂优化**：用位运算加速幂计算  

### 代码实现关键
```cpp
// 预处理前缀和
for(int i=1; i<=10000; i++) 
    sum[i] = (sum[i-1] + qpow(i, b, 10000)) % 10000;

// 计算结果
ans = ( (a/10000 % 10000) * sum[10000] + sum[a%10000] ) % 10000;
```

---

## 同类题目推荐
1. [P1226 快速幂模板题](https://www.luogu.com.cn/problem/P1226)  
2. [P1965 转圈游戏（模运算应用）](https://www.luogu.com.cn/problem/P1965)  
3. [P3811 乘法逆元（数论基础）](https://www.luogu.com.cn/problem/P3811)

---

## 可视化与算法演示

### 像素化分块动画
![Block Visualization](https://via.placeholder.com/600x200/FF6B6B/FFFFFF?text=分块计算演示)  
- **颜色标记**：  
  - 红色：当前计算的 $i^b$  
  - 蓝色：已处理的前缀和块  
  - 绿色：最终结果块  
- **交互功能**：  
  - 步进控制观察每个 $i^b$ 的计算  
  - 动态展示 $a$ 分解为 $k \times 10000 + r$

### 复古音效设计
```javascript
// Web Audio API 示例
function playBeep(freq=523, duration=0.1) {
    const osc = audioCtx.createOscillator();
    osc.frequency.value = freq;
    osc.connect(audioCtx.destination);
    osc.start(); osc.stop(audioCtx.currentTime + duration);
}
```

---

## 代码实现（核心逻辑）
```cpp
#include <bits/stdc++.h>
using namespace std;
const int MOD = 10000;

int qpow(int x, int p) {
    int res = 1;
    x %= MOD;
    while(p) {
        if(p & 1) res = res * x % MOD;
        x = x * x % MOD;
        p >>= 1;
    }
    return res;
}

int main() {
    int T, a, b;
    cin >> T;
    while(T--) {
        cin >> a >> b;
        vector<int> sum(MOD+1, 0);
        for(int i=1; i<=MOD; i++) 
            sum[i] = (sum[i-1] + qpow(i, b)) % MOD;
        int ans = ( (a/MOD % MOD) * sum[MOD] + sum[a%MOD] ) % MOD;
        cout << ans << endl;
    }
    return 0;
}
```

---
处理用时：74.92秒
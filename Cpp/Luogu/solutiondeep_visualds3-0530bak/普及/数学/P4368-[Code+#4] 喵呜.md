# 题目信息

# [Code+#4] 喵呜

## 题目描述

在马路边有一排整齐的 $n$ 棵樱花树，每棵树的高度都恰好为 $h$。某天，一只可爱的小猫偶然跑到树上来玩，但是这只小猫有些对樱花过敏，所以她现在想赶快离开这些樱花树。

具体来说，现在小猫位于第 $x$ 棵樱花树上高度为 $y$ 的位置，她可以通过两种跳跃来离开樱花树：

轻轻跳：向左或向右移动 $a$ 棵樱花树的同时，所在高度下降 $b$，即一次轻轻跳可以从起点移动到第 $x+a$ 或 $x-a$ 棵树上高度为 $y-b$ 的位置，注意当小猫所在高度不大于 $b$ 时不可以使用轻轻跳。

使劲跳：向左或向右移动 $a$ 棵樱花树的同时，所在高度上升 $b$，即一次使劲跳可以从起点移动到第 $x+a$ 或 $x-a$ 棵树上高度为 $y+b$ 的位置，注意当小猫所在高度大于 $h-b$ 时不可以使用使劲跳。

为了离开这片樱花树，小猫需要移动到第 $1$ 或第 $n$ 棵树上，高度为 $h$ 或 $1$ 的位置（这样她可以呼吸新鲜空气或者直接走开樱花树）。现在小猫想知道，自己最少需要多少次跳跃才能达成目标。由于她是一只可爱的小猫，所以希望由你来告诉她。


## 说明/提示

| 测试点编号 | $n,h$ 的范围 | 特殊约定 |
| :----------: | :----------: | :----------: |
|$1,2$  | $\le10$ | $b=1$ |
|$3,4$  |  $\le10$| $a=b=1$ |
|$5,6,7,8$  |$\le10$  | 无 |
|$9,10$  | $\le500$ | $b=1$ |
|  $11,12$| $\le500$ | $a=b=1$ |
|$13,14,15$  | $\le500$ | 无 |
|$16,17$  | $\le10^5$ | $h\le10$ |
|$18,19,20$  | $\le10^5$ | 无 |
| $21,22$ | $\le10^{15}$ | $h\le10$ |
| $23,24,25$ | $\le10^{15}$ | 无 |

对于所有数据，保证 $n \geq 2$，$a < n$，$b \leq h$。

Credit: https://www.luogu.org/discuss/show/38908

## 样例 #1

### 输入

```
3
5 5 3 3 2 2
5 7 3 5 2 2
5 7 4 6 1 1```

### 输出

```
1
1
1```

## 样例 #2

### 输入

```
3
5 5 3 3 3 2
5 7 1 4 2 2
5 7 1 2 1 2```

### 输出

```
-1
-1
-1```

## 样例 #3

### 输入

```
4
999999999999 999999999999 454545454545 454545454545 1 1
777777777777 777777777777 343434343434 343434343434 1 1
777777777777 999999999999 343434343434 454545454545 1 1
999999999999 777777777777 454545454545 343434343434 1 1```

### 输出

```
454545454544
343434343433
-1
-1```

# AI分析结果



---

**唯一算法分类**：数论

---

### **题解思路与解决难点**

1. **核心数学逻辑**  
   - **整除条件**：水平方向移动步数需满足 `(x-1) % a ==0` 或 `(n-x) % a ==0`，垂直方向同理需满足 `(y-1) % b ==0` 或 `(h-y) % b ==0`。  
   - **奇偶性约束**：水平与垂直方向的步数差需为偶数，以确保通过来回跳跃调整对齐终点。

2. **关键推导**  
   - 设水平方向步数为 `s_x`，垂直方向为 `s_y`，则 `s_x` 和 `s_y` 必须满足：  
     - `s_x = (x-1)/a` 或 `s_x = (n-x)/a`  
     - `s_y = (y-1)/b` 或 `s_y = (h-y)/b`  
   - 若 `|s_x - s_y| % 2 == 0`，则总步数为 `max(s_x, s_y)`，否则不可达。

3. **解决难点**  
   - **方向组合**：需枚举四个角落的四种可能（左上、右上、左下、右下），分别计算步数。  
   - **无效条件处理**：若无法整除或奇偶性不匹配，需跳过该组合。

---

### **题解评分 (≥4星)**

1. **Rosemary_dream (4星)**  
   - **亮点**：通过示意图直观解释步数差为偶数的必要性，代码简洁。  
   - **改进点**：部分变量命名易混淆（如 `U` 和 `R`）。

2. **3_soon (4星)**  
   - **亮点**：代码结构清晰，直接计算四个方向的步数差。  
   - **引用代码**：  
     ```cpp
     For(i,0,1) For(j,0,1) {
         if(p[0][i]!=-1 && p[1][j]!=-1 && (p[1][j]-p[0][i])%2==0)
             ans = min(ans, max(p[1][j], p[0][i]));
     }
     ```

3. **liangledong (5星)**  
   - **亮点**：详细推导充要条件，代码覆盖所有边界情况。  
   - **个人心得**：“当其中一个方向到达后，需等待另一方向通过偶数步调整”。

---

### **最优思路提炼**

- **数学核心**：利用整除和同余约束，将问题转化为二维步数的奇偶性匹配。  
- **优化技巧**：通过枚举四个方向组合，避免暴力搜索，时间复杂度为 `O(1)`。  
- **代码实现**：优先计算各方向步数，仅保留有效组合的最小值。

---

### **同类型题与通用套路**

- **常见题型**：二维网格移动问题，固定步长下的可达性判断。  
- **通用套路**：  
  1. 分解为独立维度计算步数。  
  2. 检查各维度步数的整除性。  
  3. 通过奇偶性、模运算等约束判断组合可行性。

**推荐题目**：  
1. P1516 青蛙的约会（扩展欧几里得解同余方程）  
2. P3951 小凯的疑惑（贝祖定理应用）  
3. P2424 约数和（数论分块与公式推导）

---

### **可视化与算法演示**

**动画设计**：  
1. **像素风格**：  
   - **颜色**：绿色方块表示起点，红色为终点，黄色高亮当前跳跃路径。  
   - **Canvas绘制**：网格化樱花树，动态显示小猫跳跃路径及步数。  

2. **关键步骤演示**：  
   - **步数计算**：显示 `x` 和 `y` 方向的步数及余数。  
   - **奇偶性检查**：用闪烁效果标出步数差是否为偶数。  

3. **音效交互**：  
   - **成功音效**：8-bit 上升音调（步数差符合条件）。  
   - **失败音效**：短促“哔”声（余数不为0或奇偶性不符）。

**交互控制**：  
- **步进模式**：按空格键逐步执行方向组合检查。  
- **自动模式**：AI模拟枚举过程，高亮最终有效路径。

---

### **核心代码实现**

```cpp
#include<bits/stdc++.h>
using namespace std;
using ll = long long;

ll solve(ll n, ll h, ll x, ll y, ll a, ll b) {
    ll left = (x-1) % a == 0 ? (x-1)/a : -1;
    ll right = (n-x) % a == 0 ? (n-x)/a : -1;
    ll down = (y-1) % b == 0 ? (y-1)/b : -1;
    ll up = (h-y) % b == 0 ? (h-y)/b : -1;

    ll ans = LLONG_MAX;
    // 检查四个方向组合
    if (left != -1 && up != -1 && (left - up) % 2 == 0)
        ans = min(ans, max(left, up));
    if (left != -1 && down != -1 && (left - down) % 2 == 0)
        ans = min(ans, max(left, down));
    if (right != -1 && up != -1 && (right - up) % 2 == 0)
        ans = min(ans, max(right, up));
    if (right != -1 && down != -1 && (right - down) % 2 == 0)
        ans = min(ans, max(right, down));
    return ans == LLONG_MAX ? -1 : ans;
}
```

---

**总结**：通过数论中的整除与同余分析，结合方向组合枚举，高效解决二维跳跃问题。

---
处理用时：81.97秒
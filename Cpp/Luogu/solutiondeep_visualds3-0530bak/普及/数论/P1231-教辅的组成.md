# 题目信息

# 教辅的组成

## 题目背景

滚粗了的 HansBug 在收拾旧语文书，然而他发现了什么奇妙的东西。


## 题目描述

蒟蒻 HansBug 在一本语文书里面发现了一本答案，然而他却明明记得这书应该还包含一份练习题。然而出现在他眼前的书多得数不胜数，其中有书，有答案，有练习册。已知一个完整的书册均应该包含且仅包含一本书、一本练习册和一份答案，然而现在全都乱做了一团。许多书上面的字迹都已经模糊了，然而 HansBug 还是可以大致判断这是一本书还是练习册或答案，并且能够大致知道一本书和答案以及一本书和练习册的对应关系（即仅仅知道某书和某答案、某书和某练习册有可能相对应，除此以外的均不可能对应）。既然如此，HansBug 想知道在这样的情况下，最多可能同时组合成多少个完整的书册。



## 说明/提示

样例说明：

如题，$N_1=5$，$N_2=3$，$N_3=4$，表示书有 $5$ 本、练习册有 $3$ 本、答案有 $4$ 本。

$M_1=5$，表示书和练习册共有 $5$ 个可能的对应关系，分别为：书 $4$ 和练习册 $3$ 、书 $2$ 和练习册 $2$ 、书 $5$ 和练习册 $2$ 、书 $5$ 和练习册 $1$ 以及书 $5$ 和练习册 $3$。

$M_2=5$，表示数和答案共有 $5$ 个可能的对应关系，分别为：书 $1$ 和答案 $3$、书 $3$ 和答案 $1$、书 $2$ 和答案 $2$、书 $3$ 和答案 $3$ 以及书 $4$ 和答案 $3$。

所以，以上情况的话最多可以同时配成两个书册，分别为：书 $2$ 练习册 $2$ 答案 $2$、书 $4$ 练习册 $3$ 答案 $3$。


数据规模：

![](https://cdn.luogu.com.cn/upload/image_hosting/srj2v9um.png)

对于数据点 $1,2,3$，$1\le M_1,M_2\leq 20$。

对于数据点 $4\sim 10$，$1\le M_1,M_2 \leq 20000$。


## 样例 #1

### 输入

```
5 3 4
5
4 3
2 2
5 2
5 1
5 3
5
1 3
3 1
2 2
3 3
4 3
```

### 输出

```
2```

# AI分析结果



**唯一算法分类**：网络流（最大流）

---

### **综合分析与结论**
题目核心是构建网络流模型，通过拆点限制书本使用次数，最终求最大匹配。所有题解均基于**Dinic算法**实现，关键点在于：
1. **拆点**：每本书拆为入点（与练习册连接）和出点（与答案连接），中间连容量为1的边。
2. **分层建模**：源点→练习册→书入点→书出点→答案→汇点。
3. **超级源/汇点**：整合多个起点/终点，简化网络流计算。

**可视化设计思路**：
1. **拆点动画**：书本节点分裂为入点（蓝色）和出点（绿色），中间高亮黄色边（容量1）。
2. **流量流动**：红色箭头表示当前增广路径，流量变化时边颜色变浅。
3. **复古风格**：8-bit像素节点，音效在增广成功时播放"金币声"，拆点时播放"点击声"。
4. **交互控制**：支持暂停/加速，对比不同题解的建图方式（如拆点位置差异）。

---

### **题解清单 (≥4星)**
1. **Siyuan (5星)**  
   - 思路清晰，图文并茂解释拆点必要性  
   - 代码结构规范，使用ID函数管理节点编号  
   - 核心代码：拆点循环 `for(int i=1;i<=n1;++i) addedge(id(2,i),id(3,i),1);`

2. **localhost (4星)**  
   - 图解直观，注释明确关键建图步骤  
   - 实现简洁，使用邻接表优化  
   - 亮点：明确注释拆点边的作用 `//注意一定要拆点`

3. **Drinkwater (4星)**  
   - 代码高度简洁，变量命名规范  
   - 使用当前弧优化加速Dinic  
   - 核心逻辑：拆点边 `add(nex+i,nex+nb+i,1)`

---

### **最优思路与技巧**
- **拆点防重复**：通过 `书→书'` 的1容量边限制使用次数。
- **分层建图**：练习册→书入点→书出点→答案的逻辑链。
- **超级源汇**：统一管理多起点/终点的流量输入输出。

```cpp
// 关键拆点代码示例（Siyuan题解）
for(int i=1;i<=n1;++i) 
    addedge(id(2,i), id(3,i), 1); // 书拆为入点(id2)和出点(id3)
```

---

### **同类题目推荐**
1. **P1402 酒店之王**：三分图匹配，需同时匹配房间和菜式。
2. **P2764 最小路径覆盖**：DAG拆点求最小路径数。
3. **P3254 圆桌问题**：多源多汇网络流模型。

---

### **个人心得摘录**
- **Debug教训**：未拆点时书节点被重复使用，导致WA样例。
- **优化经验**：当前弧优化使Dinic时间减少50%。
- **思维突破**：将书本视为"中间层"，拆点后转化为标准网络流。

---

### **可视化算法演示**
**Canvas动画步骤**：
1. **初始状态**：三列节点（练习册、书、答案），书本为灰色方块。
2. **拆点过程**：书本分裂为蓝（入）、绿（出）节点，中间黄边闪烁。
3. **增广路径**：红色箭头从源点流向练习册→书入→书出→答案→汇点。
4. **流量更新**：路径上的边颜色渐浅，书入→书出边变黑（容量耗尽）。

**复古交互设计**：
- **音效**：增广成功→8-bit胜利音效；拆点→"哔"声。
- **AI演示**：自动展示最优路径，按空格切换手动/自动模式。
- **积分系统**：每找到一条增广路+10分，拆点正确+50分。

```javascript
// 伪代码：拆点动画示例
function animateSplit(bookNode) {
  bookNode.hide();
  let inNode = createPixelNode(bookNode.x-20, bookNode.y, 'blue');
  let outNode = createPixelNode(bookNode.x+20, bookNode.y, 'green');
  drawEdge(inNode, outNode, {color: 'yellow', capacity:1});
  playSound('split_sound.wav');
}
```

---

通过上述分析，学习者可深入理解网络流拆点技巧，并通过可视化交互强化建模思维。

---
处理用时：61.45秒
# 题目信息

# [蓝桥杯 2016 省 AB] 最大比例

## 题目描述

X 星球的某个大奖赛设了 $M$ 级奖励。每个级别的奖金是一个正整数。

并且，相邻的两个级别间的比例是个固定值。

也就是说：所有级别的奖金数构成了一个等比数列。比如：

$$16,24,36,54$$

其等比值为：$3/2$。

现在，我们随机调查了一些获奖者的奖金数。

请你据此推算可能的最大的等比值。

## 说明/提示

时限 3 秒, 256M。蓝桥杯 2016 年第七届省赛

蓝桥杯 2016 年省赛 A 组 J 题（B 组 J 题）。

## 样例 #1

### 输入

```
3
1250 200 32```

### 输出

```
25/4```

## 样例 #2

### 输入

```
4
3125 32 32 200```

### 输出

```
5/2```

## 样例 #3

### 输入

```
3
549755813888 524288 2```

### 输出

```
4/1```

# AI分析结果



### 唯一算法分类  
**数论（分数的最大公约数应用）**

---

### 综合分析与结论  

#### 核心思路  
题目要求从给定等比数列的若干项中推算最大公比。关键步骤包括：  
1. **排序与去重**：保证等比数列的有序性，便于后续计算相邻项的比值。  
2. **计算相邻比值**：将每对相邻项的比值约分为最简分数（分子/分母）。  
3. **求最大公底数**：对分子和分母分别应用类似辗转相除的方法，寻找能构成所有比值幂次的最大基数。  

#### 解决难点  
- **分数处理**：需设计结构体存储分子分母，并实现约分、比较、相除等操作。  
- **最大公底数计算**：传统 GCD 无法处理指数形式的公约数，需递归地将较大数除以较小数，直至余数为 1。  

#### 可视化设计  
- **排序与去重**：以像素网格展示原始数据，排序后数组动态排列，重复项高亮后消失。  
- **相邻比值计算**：相邻项用连线连接，动态显示分数约分过程。  
- **最大公底数追踪**：分子分母分别用不同颜色标记，递归过程以树状图展示，当前操作节点闪烁。  
- **复古风格**：采用 8-bit 音效（如约分成功音、递归步骤音），Canvas 绘制像素化分数和箭头示意流程。  

---

### 题解清单 (≥4星)  

1. **言琢დ（5星）**  
   - **亮点**：深入数学推导，提出“分数的最大底数”概念，类比 GCD 的递归公式。  
   - **心得**：“当处理分数时，需分别对分子分母应用递归，确保指数互质。”  

2. **0x282e202e2029（5星）**  
   - **亮点**：完整 C++ 实现，结构体封装分数操作，处理去重与边界条件。  
   - **代码**：`gcd_pow` 函数确保分子分母顺序，避免样例错误。  

3. **Noah03（4星）**  
   - **亮点**：清晰解释“最大公底数”递归逻辑，代码注释详尽。  
   - **调试教训**：“未交换 `x` 和 `y` 导致死循环，添加条件后解决。”  

---

### 核心代码实现  

#### 分数结构体与约分  
```cpp  
struct Fraction {
    unsigned long long numerator, denominator;
    void reduction() {
        unsigned long long g = gcd(numerator, denominator);
        numerator /= g, denominator /= g;
    }
};
```

#### 最大公底数递归函数  
```cpp  
unsigned long long gcd_pow(unsigned long long x, unsigned long long y) {
    if (y > x) swap(x, y);
    if (y == 1) return x;
    return gcd_pow(y, x / y);
}
```

#### 主流程  
```cpp  
sort(a + 1, a + n + 1, cmp); // 降序排序  
for (int i = 1; i < n; i++) 
    x[i] = divide(x[i], x[i + 1]); // 计算相邻比值  
ans = x[1];  
for (int i = 2; i < n; i++) {  
    ans.numerator = gcd_pow(ans.numerator, x[i].numerator);  
    ans.denominator = gcd_pow(ans.denominator, x[i].denominator);  
}  
```

---

### 同类型题与推荐  
1. **P1417 分解质因数**：处理数的幂次分解。  
2. **P2651 添加括号Ⅲ**：分数运算与 GCD 结合。  
3. **P1572 计算分数**：分数四则运算与约分。  

---

### 个人心得摘录  
- **xk2013**：“`gcd_pow` 必须优先交换 `x` 和 `y`，否则递归路径错误。”  
- **Noah03**：“约分和公底数函数用途不同，混淆会导致 WA。”  

---

### 可视化与复古动画  
- **像素网格**：每个数显示为 16x16 像素块，排序时块体滑动并重新排列。  
- **递归高亮**：`gcd_pow` 调用时，当前分子分母以红蓝闪烁，递归路径用箭头连接。  
- **8-bit 音效**：约分成功时播放上升音阶，错误时短促“哔”声。  
- **自动演示**：按空格键逐步执行，回车键自动播放，速度可调。  

```javascript  
// 示例：Canvas 绘制分数  
function drawFraction(num, den, x, y) {  
    ctx.fillStyle = '#FF0000';  
    ctx.fillText(num, x, y);  
    ctx.fillStyle = '#00FF00';  
    ctx.fillText(den, x, y + 16);  
    ctx.beginPath();  
    ctx.moveTo(x - 8, y + 8);  
    ctx.lineTo(x + 24, y + 8);  
    ctx.stroke();  
}  
```

---
处理用时：77.96秒
# 题目信息

# [NOIP 2011 提高组] 铺地毯

## 题目描述

为了准备一个独特的颁奖典礼，组织者在会场的一片矩形区域（可看做是平面直角坐标系的第一象限）铺上一些矩形地毯。一共有 $n$ 张地毯，编号从 $1$ 到 $n$。现在将这些地毯按照编号从小到大的顺序平行于坐标轴先后铺设，后铺的地毯覆盖在前面已经铺好的地毯之上。

地毯铺设完成后，组织者想知道覆盖地面某个点的最上面的那张地毯的编号。注意：在矩形地毯边界和四个顶点上的点也算被地毯覆盖。


## 说明/提示

【样例解释 1】

如下图，$1$ 号地毯用实线表示，$2$ 号地毯用虚线表示，$3$ 号用双实线表示，覆盖点 $(2,2)$ 的最上面一张地毯是 $3$ 号地毯。

![](https://cdn.luogu.com.cn/upload/image_hosting/q4izfzpb.png)

【数据范围】

对于 $30\%$ 的数据，有 $n \le 2$。  
对于 $50\%$ 的数据，$0 \le a, b, g, k \le 100$。  
对于 $100\%$ 的数据，有 $0 \le n \le 10^4$, $0 \le a, b, g, k \le {10}^5$。   

noip2011 提高组 day1 第 $1$ 题。

## 样例 #1

### 输入

```
3
1 0 2 3
0 2 3 3
2 1 3 3
2 2
```

### 输出

```
3
```

## 样例 #2

### 输入

```
3
1 0 2 3
0 2 3 3
2 1 3 3
4 5```

### 输出

```
-1```

# AI分析结果



# 算法分类  
**枚举**  

---

# 题解思路与难点分析  

## 核心思路  
所有题解均采用**离线处理+范围判断**的核心方法：  
1. 存储每个地毯的坐标范围（左上角+延伸长度或预计算右下角坐标）  
2. 遍历地毯判断目标点是否在该地毯覆盖范围内  
3. 记录最后一个覆盖该点的地毯编号（正序更新 / 逆序首次命中）  

## 解决难点对比  
| 题解方法       | 空间复杂度 | 时间复杂度 | 关键优化点                |  
|----------------|------------|------------|---------------------------|  
| 二维数组存储   | O(W×H)     | O(n+1)     | 无，导致 MLE              |  
| 正向遍历更新   | O(n)       | O(n)       | 无需预存全部坐标          |  
| **逆序首次命中** | O(n)       | O(n)（最优）| 提前终止遍历，减少冗余检查 |  

---

# 题解评分（≥4星）  

1. **Vct14（5星）**  
   - 逆序遍历 + 预存右下角坐标，判断逻辑最简洁  
   - 代码清晰，时间复杂度最优  

2. **kuaiCreator（4.5星）**  
   - 逆序遍历，及时 break 终止  
   - 变量命名规范，结构清晰  

3. **Jayfeather2012（4星）**  
   - 明确说明逆向思维优势  
   - 代码简洁，包含关键注释  

---

# 最优思路提炼  

## 核心技巧  
**逆向覆盖检查**：  
- 后铺的地毯必然覆盖在先铺地毯之上  
- **从最后一个地毯开始逆序遍历**，第一个覆盖目标点的即为答案  
- 找到后立即终止遍历，节省冗余判断  

## 关键代码实现  
```cpp  
for(int i = n; i >= 1; i--) {  
    if(x >= a[i] && x <= a[i]+g[i] && y >= b[i] && y <= b[i]+k[i]) {  
        cout << i;  
        return 0; // 立即终止程序  
    }  
}  
cout << -1;  
```

---

# 同类型题与套路  
- **覆盖问题**：判断点/区域被哪些对象覆盖（如[P2280 激光炸弹](https://www.luogu.com.cn/problem/P2280)）  
- **离线处理**：先读入全部数据再统一处理（如[P1908 逆序对](https://www.luogu.com.cn/problem/P1908)）  
- **逆向思维**：从后往前遍历以快速定位最终状态（如[P1540 机器翻译](https://www.luogu.com.cn/problem/P1540)）  

---

# 推荐练习题  
1. [P1003 铺地毯（原题）](https://www.luogu.com.cn/problem/P1003)  
2. [P2280 激光炸弹](https://www.luogu.com.cn/problem/P2280)（二维前缀和）  
3. [P2036 字符串加密](https://www.luogu.com.cn/problem/P2036)（覆盖与替换逻辑）  

---

# 个人心得摘录  
- **智子**：_"开二维数组直接 MLE，意识到必须用离线处理"_ → 强调空间复杂度的重要性  
- **WsW_**：_"栈结构虽直观，但实际与数组遍历效率相当"_ → 数据结构选择需结合具体场景  

---

# 算法可视化设计  

## 动画方案（复古像素风格）  
1. **初始化**：  
   - 8-bit 风格坐标系，每个地毯显示为不同颜色的矩形  
   - 目标点用闪烁的白色像素表示  

2. **遍历过程**：  
   - 逆序高亮每个地毯（从最后到第一个）  
   - 当前地毯边框闪烁黄色，内部填充半透明色  
   - 若覆盖目标点：  
     - 播放 "成功" 音效（8-bit 上升音阶）  
     - 显示该地毯编号并终止动画  

3. **交互功能**：  
   - 步进控制：空格键单步执行  
   - 自动播放：按 A 键以不同速度自动演示  
   - 音效开关：S 键控制音效  

## 关键代码片段（Canvas 绘制）  
```javascript  
// 绘制地毯矩形  
function drawCarpet(a, b, g, k, color) {  
    ctx.fillStyle = color;  
    ctx.fillRect(a * scale, b * scale, g * scale, k * scale);  
}  

// 高亮当前检查的地毯  
ctx.strokeStyle = "#FFFF00";  
ctx.lineWidth = 2;  
ctx.strokeRect(currentA * scale, currentB * scale, currentG * scale, currentK * scale);  
```

---

**可视化总结**：通过逆序高亮与即时反馈，直观展示“后铺优先覆盖”的核心逻辑，配合音效与交互增强理解。

---
处理用时：76.98秒
# 题目信息

# [语言月赛 202210] 军训

## 题目描述

某 E 刚结束军训，军训教官将所有同学排成了 $n$ 行 $m$ 列。

教官组织同学们进行分列式练习，同学们将按行为单位进行练习。第 $i$ 行第 $j$ 名同学摆臂的高度为 $a_{i,j}$，踢腿的高度为 $b_{i,j}$。

教官认为，每一行同学的不整齐度为摆臂高度方差与踢腿高度方差之和。形式化的，第 $i$ 行同学的不整齐度为 
$$
\dfrac{1}{m} \times \sum\limits_{j=1}^{m}{\Bigg(a_{i,j}-\dfrac{\sum\limits_{k=1}^{m}{a_{i,k}}}{m}\Bigg)^2} + \dfrac{1}{m} \times \sum\limits_{j=1}^{m}{\Bigg(b_{i,j}-\dfrac{\sum\limits_{k=1}^{m}{b_{i,k}}}{m}\Bigg)^2}
$$

其中，$\sum\limits_{j=1}^m{a_{i,j}}$ 代表 $a_{i,1}+a_{i,2}+a_{i,3}+\cdots+a_{i,m}$。

教官希望对若干行进行位置上的对调，使得最终排出的方阵中，从第 $1$ 行至第 $n$ 行不整齐度依次递增。若有两行不整齐度相同，可以任意安排其顺序。

请你编写程序，给出一种交换方案。请注意，每一步交换是即刻完成的。

例如，给出如下的交换方案：

第一步，交换第 $1$ 行和第 $2$ 行；第二步，交换第 $2$ 行和第 $3$ 行。

初始：

| 当前行数 | 初始行号 |
|:---: | :---: |
| $1$ | $1$ |
| $2$ | $2$ |
| $3$ | $3$ |

第一步完成后：

| 当前行数 | 初始行号 |
|:---: | :---: |
| $1$ | $2$ |
| $2$ | $1$ |
| $3$ | $3$ |

第二步完成后：

| 当前行数 | 初始行号 |
|:---: | :---: |
| $1$ | $2$ |
| $2$ | $3$ |
| $3$ | $1$ |

**提示：例如，将第 $1$ 行与第 $3$ 行交换后，原第 $1$ 行将被叫做第 $3$ 行，而不是仍被叫做第 $1$ 行。**

**具体解释可参照样例 #2 解释。**

## 说明/提示

### 样例 #2 解释

仅考虑摆臂高度，在前两次交换后，阵列变成如下的样子：

$\begin{matrix} 1: & 2 & 4 & 6 \\ 2: & 1 & 2 & 3 \\ 3: & 3 & 6 & 9 \end{matrix}$

此时，原第 $3$ 行现被叫做第 $2$ 行，原第 $2$ 行现被叫做第 $1$ 行。如果我们想要将它们交换，应该输出 `1 2` 而不是 `2 3`。

### 数据规模与约定

对于 $30\%$ 的数据，所有 $a_{i,j}$ 均相同，$b_{i,j}$ 均相同。  

对于另外 $20\%$ 的数据，满足 $n\le 100$，$m\le 100$。

对于 $100\%$ 的数据，$1 \le n,m \le 1000$，$1 \le a_{i,j},b_{i,j} \le 100$。

### Special Judge

本题答案不唯一，将有 Special Judge 对你的答案进行检查，所有合法答案均可以得分。

Problem Assigned by 览遍千秋 | 七海

## 样例 #1

### 输入

```
3 3
1 1 1
1 1 1
1 1 1
1 1 1
1 1 1
1 1 1```

### 输出

```
3
1 2
1 3
2 3```

## 样例 #2

### 输入

```
3 3
3 6 9
2 4 6
1 2 3
1 1 1
1 1 1
1 1 1```

### 输出

```
3
1 2
2 3
1 2```

# AI分析结果



# 【唯一算法分类】  
排序算法（选择排序）

---

## 【综合分析与结论】  
题目核心是计算每行的方差和并进行排序。关键在于正确实现方差公式，并通过选择排序记录交换步骤。选择排序通过每次选择未排序部分的最小值，逐步构建有序序列，交换次数较少且符合题目要求。

**核心算法流程**：  
1. **计算方差和**：对每行分别计算摆臂和踢腿的均值，再求每个元素的平方差之和，除以m得到方差，两方差相加得到该行的总方差和。  
2. **选择排序**：从后往前遍历，每次找到当前区间内的最小方差行，若不在正确位置则交换，并记录交换步骤。  
3. **记录交换步骤**：每次交换后，行的当前编号立即更新，后续操作基于新的行顺序。

**可视化设计思路**：  
- **动画演示**：用网格展示各行方差和，高亮当前比较的行和已排序区间。  
- **像素风格**：用8位颜色标记交换步骤，每次交换时行号闪烁并播放音效。  
- **控制面板**：支持单步执行，观察方差计算和交换顺序。

---

## 【题解清单 (4星)】  
**题解作者：zhangzhihao2**  
- **亮点**：  
  1. 详细推导方差公式，避免整数除法的错误。  
  2. 使用选择排序减少交换次数，确保操作次数小于n²。  
  3. 强调行交换后编号即时更新，避免常见误区。  
- **评分理由**：思路清晰，代码可读性强，适用于大数据规模。

---

## 【最优思路或技巧提炼】  
1. **方差计算优化**：  
   - 先计算行的总和，再求均值，避免重复计算。  
   - 使用浮点数存储中间结果，防止精度丢失。  
2. **选择排序减少交换**：  
   - 每次确定一个最小元素的位置，最多n-1次交换。  
3. **行交换记录**：  
   - 维护当前行的实际位置数组，交换时更新并记录步骤。

---

## 【同类型题或类似算法套路】  
- **自定义排序规则**：如按特定指标排序，需预处理每行数据。  
- **交换步骤记录**：类似题目要求输出操作序列而非最终结果。

---

## 【推荐相似知识点题目】  
1. P1177 【模板】快速排序  
2. P1068 分数线划定（自定义排序）  
3. P1908 逆序对（分治+归并）

---

## 【代码实现片段】  
**核心计算方差和**  
```cpp
vector<double> calc_variance(int n, int m, vector<vector<int>>& a, vector<vector<int>>& b) {
    vector<double> res(n);
    for (int i = 0; i < n; ++i) {
        double sum_a = accumulate(a[i].begin(), a[i].end(), 0);
        double mean_a = sum_a / m;
        double var_a = 0;
        for (int x : a[i]) var_a += (x - mean_a) * (x - mean_a);
        var_a /= m;
        
        double sum_b = accumulate(b[i].begin(), b[i].end(), 0);
        double mean_b = sum_b / m;
        double var_b = 0;
        for (int x : b[i]) var_b += (x - mean_b) * (x - mean_b);
        var_b /= m;
        
        res[i] = var_a + var_b;
    }
    return res;
}
```

**选择排序与交换记录**  
```cpp
vector<pair<int, int>> sort_rows(vector<double>& nums) {
    vector<pair<int, int>> steps;
    vector<int> pos(nums.size());
    iota(pos.begin(), pos.end(), 0); // 初始行号映射
    
    for (int i = nums.size() - 1; i > 0; --i) {
        int max_idx = 0;
        for (int j = 1; j <= i; ++j) {
            if (nums[pos[j]] > nums[pos[max_idx]]) 
                max_idx = j;
        }
        if (max_idx != i) {
            swap(pos[max_idx], pos[i]);
            steps.emplace_back(max_idx + 1, i + 1); // 转换为1-based
        }
    }
    return steps;
}
```

---

## 【可视化与算法演示】  
**动画方案**：  
1. **网格视图**：每行显示方差和，背景色按排序状态渐变。  
2. **高亮操作**：当前比较的行用黄色边框，已排序区间用绿色填充。  
3. **像素效果**：交换时行号以8位像素动画移动，伴随“哔”音效。  

**复古风格设计**：  
- **调色板**：16色FC风格，如#FF0000（红）、#00FF00（绿）。  
- **音效**：Web Audio API生成方波音效，交换时触发短促“滴”声。  
- **自动演示**：按选择排序步骤自动执行，速度可调。  

**交互功能**：  
- **暂停/继续**：Space键控制。  
- **步进执行**：按→键单步执行下一步。  
- **速度调节**：滑动条控制动画速度（100ms~2s）。  

---

**总结**：通过选择排序逐步构建有序序列，结合方差计算与交换步骤记录，高效解决排序问题。复古动画增强理解，适合教学演示。

---
处理用时：68.13秒
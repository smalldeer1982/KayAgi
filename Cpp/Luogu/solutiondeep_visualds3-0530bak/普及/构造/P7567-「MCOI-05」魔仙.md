# 题目信息

# 「MCOI-05」魔仙

## 题目背景

你是魔仙堡里的占星魔仙。

## 题目描述

魔仙女王的宝石被古娜拉黑暗之神偷走了！古娜拉黑暗之神藏在魔仙堡的 $n$ 个穹顶中的任意一个里面，这 $n$ 个穹顶编号为 $1 \sim n$，第 $i$ 个穹顶可以将其赋予 $a_i$ 的魔力，$a_i$ 必须是整数。

如果所有穹顶的魔力之和为 $0$，之积为 $n$，那么我们称这种情况是可以轻易搜索出古娜拉黑暗之神的。

魔仙女王让占星魔仙求一种赋予魔力的情况使得是可以轻易搜索出古娜拉黑暗之神的。

## 说明/提示

#### 样例 1 解释

$1 +(-1)+2+(-2)=0$，$1 \times (-1) \times 2 \times (-2)=4$。

#### 数据规模与约定

**本题采用捆绑测试。**

 - Subtask 1（5 pts）：$n\le 1$
 - Subtask 2（20 pts）：$n,\sum n\le 100$
 - Subtask 3（75 pts）：没有特殊限制。

对于 $100\%$ 的数据，$1 \le n\le10^6$，$\sum n\le 5\times10^6$，$1\le T\le10^5$。

**本题采用 Special Judge**，你只需要输出其中一种序列。

## 样例 #1

### 输入

```
2
4
114513```

### 输出

```
1 -1 2 -2
w33zAKIOI```

## 样例 #2

### 输入

```
1
1```

### 输出

```
w33zAKIOI```

# AI分析结果



# 题解分析与可视化方案

## 算法分类
**数学构造**

---

## 题解思路与核心难点

### 核心思路
**必要条件推导**：  
1. **奇偶性分析**：若存在解，则所有数的和为0（偶数）且积为n。  
   - 当n为奇数时，所有数必为奇数，和不可能为偶数。  
   - 当n为偶数但非4的倍数时，至少需两个偶数，但奇偶性仍矛盾。  
   ⇒ **n必须是4的倍数**（n=4k）。

**构造方法**：  
分k的奇偶性构造：  
- **k为奇数**：序列为 `2, -2k` + `1^(3k-2)` + `(-1)^k`  
- **k为偶数**：序列为 `-2, -2k` + `1^(3k)` + `(-1)^(k-2)`

### 解决难点
- **数学证明**：严格推导n必须为4的倍数。  
- **构造技巧**：利用1和-1调整和为零，同时保证乘积为n。

---

## 题解评分（≥4星）

### 1. FuriousC（★★★★★）
- **亮点**：逻辑严密，代码简洁，详细证明n为4的倍数，分奇偶构造。  
- **代码**：直接分情况输出，时间复杂度O(n)。

### 2. Legitimity（★★★★☆）
- **亮点**：简化推导过程，代码与FuriousC类似，注释清晰。  
- **心得**：提及比赛时的思考路径，增强可读性。

### 3. Sparkle_ZH（★★★★☆）
- **亮点**：代码结构清晰，条件判断简洁，适合快速实现。

---

## 最优思路提炼
1. **奇偶分治**：通过奇偶性排除无解情况。  
2. **分块构造**：用两个关键数（2/-2k或-2/-2k）固定乘积，剩余用1/-1平衡和。  
3. **O(1)决策**：无需复杂计算，直接按k的奇偶性输出固定模式。

---

## 类似题目
1. **CF1352G - Special Permutation**（构造奇偶交替序列）  
2. **洛谷P6101 [出言不逊]**（利用1/-1调整和）  
3. **洛谷P7981 [DFS 序 3]**（数学构造与分治）

---

## 可视化设计

### 核心逻辑演示
**动画步骤**：  
1. **输入n**：展示n值，判断是否为4的倍数（红色高亮非4k，绿色通过）。  
2. **计算k**：n/4，显示k值并判断奇偶（动态切换颜色）。  
3. **构造序列**：  
   - **关键数**：用不同颜色块显示2/-2k或-2/-2k。  
   - **填充1/-1**：分批次生成1（绿色）和-1（红色），动态计数。  
4. **验证和与积**：实时计算和与积，最终显示0和n（成功动画）。

### 复古像素风格
- **8位调色板**：使用NES风格颜色（深蓝背景，亮绿/红/黄元素）。  
- **音效**：  
  - 正确时播放《超级马里奥》金币音效。  
  - 错误时播放《塞尔达传说》低血量警报。  
- **Canvas动画**：网格布局，关键数用大像素块，1/-1用小方块瀑布流展示。

### 交互功能
- **速度调节**：滑动条控制生成速度（0.1x~5x）。  
- **单步执行**：按空格逐步展示构造过程。  
- **自动演示**：AI模式随机生成n，自动构造并验证。

---

## 代码片段（核心逻辑）
```cpp
if (n % 4 != 0) {
    cout << "w33zAKIOI\n";
} else {
    int k = n / 4;
    if (k % 2) { // k为奇数
        cout << "2 " << -2 * k << " ";
        for (int i = 0; i < 3*k-2; ++i) cout << "1 ";
        for (int i = 0; i < k; ++i) cout << "-1 ";
    } else { // k为偶数
        cout << "-2 " << -2 * k << " ";
        for (int i = 0; i < 3*k; ++i) cout << "1 ";
        for (int i = 0; i < k-2; ++i) cout << "-1 ";
    }
}
```

---

## 可视化JavaScript片段（伪代码）
```javascript
function animateConstruction(n) {
    if (n % 4 != 0) {
        playSound('error');
        highlightRed(n);
    } else {
        const k = n / 4;
        const isKEven = (k % 2 === 0);
        // 绘制关键数
        drawBlock(isKEven ? -2 : 2, 'yellow');
        drawBlock(-2 * k, 'orange');
        // 填充1/-1
        fillOnes(isKEven ? 3*k : 3*k-2, 'green');
        fillOnes(isKEven ? k-2 : k, 'red');
        // 成功动画
        playSound('success');
        sparkleEffect();
    }
}
```

---

**总结**：本题解通过数学推导与分块构造巧妙解决，可视化设计通过复古风格和交互演示增强理解，适用于数学构造类题目的教学与练习。

---
处理用时：75.19秒
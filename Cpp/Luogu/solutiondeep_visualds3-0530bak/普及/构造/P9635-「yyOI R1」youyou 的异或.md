# 题目信息

# 「yyOI R1」youyou 的异或

## 题目背景

youyou 非常菜，但是他很喜欢构造奇奇怪怪的数列。

## 题目描述

本题评测方式为 **Special Judge**。

youyou 很喜欢数列，所以他想让你构造一个长度为 $n$ 的**正整数**序列 $\{a_i\}$。

youyou 很喜欢[异或](https://oi-wiki.org/math/bit/#%E4%B8%8E%E6%88%96%E5%BC%82%E6%88%96)，所以他要求构造出的序列满足 $a_1 \oplus a_2 \oplus a_3 \oplus \cdots \oplus a_{n-1} \oplus a_n = n$（记 $\oplus$ 表示异或）。

youyou 非常讨厌相同的数，所以他要求序列中所有数**互不相同**。

但 youyou 不想让这个序列的数太大，所以他要求序列中所有数的总和不超过 $n^2$，即 $\displaystyle\sum_{i=1}^n a_i \le n^2$。

现在你需要构造出一个序列从而满足 youyou 的所有要求。如果无解，输出 `-1` 。如果有多种答案，输出任意一个序列即可。

你需要回答 $T$ 组数据。

## 说明/提示

### 样例解释
对于 $n = 1$ 时，一种可行的解为 $\{1\}$。

对于 $n = 2$ 时，一种可行的解为 $\{3,1\}$。

对于 $n = 5$ 时，一种可行的解为 $\{1,4,5,3,6\}$，因为 $1 ⊕  4 ⊕ 5  ⊕ 3 ⊕ 6 = 5$，且 $1+4+5+3+6 =19\le 5^2$，序列中每个数也互不相同。


### 数据范围
对于 $5\%$ 的数据，$n \le 5$。

对于 $15\%$ 的数据，$n \le 10$。

对于 $40\%$ 的数据，$n \le 1000$。

对于 $70\%$ 的数据， $n \le 10^5$。

对于 $100\%$ 的数据，$1 \le n \le 5 × 10^5$，$1 \le T \le 10$。


## 样例 #1

### 输入

```
3
1
2
5```

### 输出

```
1
3 1
1 4 5 3 6```

# AI分析结果



---

### 唯一算法分类  
**构造算法（基于模运算的分类构造）**

---

### 题解思路与算法要点  
**核心思路**：通过观察 n 的模 4 余数进行分类构造，利用异或性质保证异或和为 n，同时控制总和不超过 n²。  
**关键步骤**：  
1. **n mod 4 == 0**：直接使用 1~n 的连续序列，其异或和为 0 ⊕ n = n  
2. **n mod 4 == 2**：前 n-1 项为 1~n-1，最后一项为 n+1，异或和为 1 ⊕ (n+1) = n  
3. **n mod 4 == 1/3**：前 n-2 项为 1~n-2，最后两项为 2^k 和特定偏移量，通过调整偏移量保证异或和为 n  

**解决难点**：  
- 异或和的计算需要满足数学性质  
- 最后两项的选择必须互异且不重复  
- 对 n=3、n=5 等边界情况的特判  

---

### 题解评分（≥4星）  
1. **continueOI（★★★★☆）**  
   - 亮点：通过打表发现模 4 规律，代码简洁高效  
   - 代码片段：  
     ```cpp
     if(n%4==0) cout<<n-1<<' '<<n;
     else if(n%4==1) cout<<sum<<' '<<sum+n; // sum 为最小 2^k ≥n
     ```
2. **youyou2007（★★★★★）**  
   - 亮点：出题人官方思路，分类严谨，数学证明清晰  
   - 代码片段：  
     ```cpp
     if(n%4==2) {
       for(int i=1;i<=n-1;i++) cout<<i;
       cout<<n+1;
     }
     ```
3. **Angelastar（★★★★☆）**  
   - 亮点：结合打表与数学推导，代码可读性强  
   - 关键逻辑：通过位运算快速计算最小 2^k  

---

### 最优思路与技巧  
1. **模 4 分类法**  
   - 利用连续四数异或和为 0 的性质（如 1^2^3^4=0）  
2. **最小 2^k 选择**  
   - 通过 `while(sum < n) sum *= 2` 快速找到满足条件的 2 的幂  
3. **边界特判法**  
   - 对 n=3 直接返回 -1，对 n=5 单独构造  

---

### 类似题目推荐  
1. **P6560 [SBCOI2020] 归位**  
   - 构造满足特定异或条件的序列  
2. **P6102 [EER1] 出言不逊**  
   - 基于位运算的构造与分类讨论  
3. **P7933 [COCI2007-2008#5] PASCAL**  
   - 利用模数性质进行数学构造  

---

### 可视化与算法演示  
**动画设计**：  
1. **像素风格界面**  
   - 使用 16 色调色板（如 #FF6B6B 表示关键数，#4ECDC4 表示异或操作）  
   - 每个数字显示为 32x32 像素方块  
2. **动态流程**  
   - **步骤 1**：显示前 n-2 项的连续数列（1~n-2）  
   - **步骤 2**：高亮最后两项（红色边框 + 闪烁特效）  
   - **步骤 3**：展示异或计算过程（如 `1^2^...^n-2 ⊕ X ⊕ Y = n`）  
3. **音效交互**  
   - 成功构造时播放 8-bit 胜利音效  
   - 无解时播放低沉错误音  

**核心代码片段（JS 伪代码）**：  
```javascript
// 计算最小 2^k ≥n
function calcPower(n) {
  let sum = 1;
  while (sum < n) sum <<= 1;
  return sum;
}

// 生成序列动画
function generateSequence(n) {
  if (n === 3) return playErrorSound();
  const sequence = [];
  for (let i = 1; i <= n - 2; i++) sequence.push(i);
  const power = calcPower(n);
  sequence.push(power, power + (n % 4 === 1 ? n : n - 1));
  animateSequence(sequence); // 显示动画
}
```

---

### 个人心得摘录  
> "构造题的核心是找数学规律而非暴力枚举。通过打表发现模 4 的周期性后，代码复杂度从 O(n!) 骤降到 O(n)" —— continueOI  
> "对 n=3 的无解特判让我调试了 2 小时，最终发现其异或和无法满足所有条件" —— sbno333  

---

### 最终结论  
通过模 4 分类构造法可在 O(n) 时间内解决本题，核心代码简洁且数学性质严谨。对特殊情况的特判与最小 2^k 的快速计算是解题的关键技巧。

---
处理用时：93.78秒
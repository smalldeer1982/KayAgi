# 题目信息

# [yLOI2020] 金陵谣

## 题目背景

> 水几绕，山几重，何处金陵城。   
> 访名都，寻形胜，龙虎倚江东。   
> 书留翰墨，曲落潮声。   
> 草木几度枯荣。

——银临《金陵谣》

## 题目描述

江苏南京，亦称金陵，是一座历史文化名城。有了古城的衬托，江苏省的高考模拟题都显地那么棘手，难以解决。切切在一轮复习过程中便碰到一道江苏省模拟题，在七瑾的帮助下，切切很快秒杀了该题，但切切觉得不够，想用这道题来刁难你。解决本题就能吃到切切和七瑾撒的糖。

给定四个正整数 $a, b, c, d$，求有多少对正整数 $(x, y)$ 满足

$$\frac a x + \frac b c = \frac d y$$

## 说明/提示

### 样例 1 解释

求 $\frac 1 x + \frac 1 3 = \frac 2 y$ 的正整数解对数，分别是 $(x = 3, y = 3)$，$(x = 6, y = 4)$，$(x = 15, y = 5)$。

### 数据规模与约定

本题共有 20 个测试点，每个测试点 $5$ 分。

- 对于测试点 $1$，保证 $T = 0$。
- 对于测试点 $2 \sim 16$，共 $15$ 个测试点，对于 $a, b, c, d$ 四个数中至少存在一个数为 $1$ 共有 $15$ 种情况，每个测试点对应一种情况。
- 对于测试点 $17 \sim 20$，没有特殊约定。

对于全部的测试点，保证 $0 \leq T \leq 20$，$1 \leq a, b, c, d \leq 10^6$，$d \times c \leq 10^6$。

### 提示

+ 众所周知，高考不考数论。
+ 本题共有两个样例文件，见附加中的 song.zip。

## 样例 #1

### 输入

```
1
1 1 3 2```

### 输出

```
3```

# AI分析结果



## 唯一算法分类
**枚举**

---

## 综合分析与结论

### 核心思路与算法流程
所有题解均通过数学变形将原式转换为：  
$$x = \frac{acy}{dc - by}$$  
**关键步骤**：  
1. **范围推导**：由分母 $dc-by>0$ 得 $y < \frac{dc}{b}$  
2. **枚举验证**：遍历 $y \in [1, \lfloor \frac{dc}{b} \rfloor ]$，检查 $acy$ 是否能被 $(dc-by)$ 整除  
3. **边界处理**：当 $dc$ 能被 $b$ 整除时，上界需减1  

**可视化设计**：  
- **像素动画**：在 Canvas 网格中，y值从左到右逐个高亮（绿色方块表示当前枚举的y），满足条件的y触发金色特效  
- **音效设计**：命中解时播放8-bit "coin"音效，分母为0时触发警示音  
- **数据追踪**：右侧面板实时显示当前计算的 $(acy, dc-by)$ 值，进度条显示枚举完成百分比  

---

## 题解清单（≥4星）

### 一扶苏一（★★★★★）
**亮点**：  
- 代码最简洁，直接推导核心式子  
- 时间复杂度 $O(dc)$ 完全符合数据范围  
- 变量命名清晰（u=acy, v=dc-by）

### Scintilla（★★★★☆）
**亮点**：  
- 提供两种解法对比，算法二展示质因数分解优化思路  
- 明确推导出 $y$ 的上界公式  
- 对 $b \mid dc$ 的边界情况处理严谨  

### Computer1828（★★★★☆）
**亮点**：  
- 详细推导变量转换过程  
- 代码中明确标注关键计算位置  
- 特别强调开 long long 的必要性  

---

## 最优思路与代码实现

### 核心代码片段
```cpp
int main() {
    int T; cin >> T;
    while(T--) {
        ll a,b,c,d, ans=0;
        cin >> a >> b >> c >> d;
        ll lim = (c*d) / b - ((c*d)%b == 0 ? 1 : 0); // 边界处理
        for(ll y=1; y <= lim; ++y) {
            ll denominator = c*d - b*y;
            if(denominator <= 0) continue;
            if( (a*c*y) % denominator == 0 ) ans++;
        }
        cout << ans << endl;
    }
    return 0;
}
```

### 实现思想
1. **数学变形**：通过交叉相乘消除分母，得到线性关系式  
2. **范围压缩**：利用 $dc \leq 1e6$ 将枚举规模控制在可接受范围  
3. **整除判断**：仅需一次模运算即可验证解的合法性  

---

## 同类题目推荐
1. **P1024 [NOIP2001 提高组] 一元三次方程求解**（分式变形+枚举）  
2. **P1414 [NOI2001] 方程的解数**（数学变形与枚举验证）  
3. **P2651 添加括号III**（分式性质与约分判断）  

---

## 个人心得摘录
> "三年OI一场空，不开long long见祖宗" —— A_Đark_Horcrux  
> **教训**：大数相乘必须使用64位整型  

> "高考不考数论，但算法考分式变形" —— 题解评论区  
> **启示**：将分式问题转化为整除判断是核心技巧  

---

## 复古像素化可视化设计

### 动画要素
- **8位风格**：  
  - 主界面使用16色调色板（#000000、#1D2B53、#7E2553等复古FC色彩）  
  - 解计数器采用7段数码管像素字体  
- **音效设计**：  
  - 命中解：`beep(784, 50)`（中音C）  
  - 错误：`beep(440, 100)`（低音A）  
- **Canvas绘制**：  
  ```javascript
  function drawFrame(y, total, valid) {
      ctx.fillStyle = "#1D2B53";
      ctx.fillRect(0,0,320,240); // 清空画布
      // 绘制进度条
      let progress = y / total * 300;
      ctx.fillStyle = "#FF004D";
      ctx.fillRect(10, 200, progress, 10);
      // 绘制当前y值
      ctx.fillStyle = "#29ADFF";
      ctx.fillText(`y=${y}`, 20, 30);
  }
  ```

### AI自动演示
```javascript
function autoRun() {
    let y = 1;
    const timer = setInterval(() => {
        if(y > lim) clearInterval(timer);
        else {
            checkSolution(y);
            drawFrame(y++, lim, ans);
        }
    }, 100); // 每100ms步进一次
}
```

---
处理用时：62.62秒
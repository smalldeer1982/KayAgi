# 题目信息

# [蓝桥杯 2019 国 AC] 轨道炮

## 题目描述

小明在玩一款战争游戏。地图上一共有 $N$ 个敌方单位，可以看作 2D 平面上的点。其中第 $i$ 个单位在 $0$ 时刻的位置是 $(X_i, Y_i)$，方向是 $D_i$ (上下左右之一, 用 `U`/`D`/`L`/`R` 表示)，速度是 $V_i$。小明的武器是轨道炮，只能使用一次，不过杀伤力巨大。小明可以选择在某个非负整数时刻释放轨道炮，轨道炮一次可以消灭在一条直线 (平行于坐标轴) 上的所有敌方单位。请你计算小明最多能消灭多少敌方单位。

## 说明/提示

对于所有评测用例，$1 \le N \le 1000$，$-10^6 \le X_i, Y_i \le 10^6$，$0 \le V_i \le 10^6$。

蓝桥杯 2019 年国赛 A 组 H 题（C 组 J 题）

## 样例 #1

### 输入

```
4
0 0 1 R
0 10 1 R
10 10 2 D
2 3 2 L
```

### 输出

```
3```

# AI分析结果



---

## **算法分类**
**枚举与数学计算**

---

## **题解思路与核心分析**

### **核心思路**
题目要求找到某个整数时刻，使得同一行或列上的敌方单位最多。核心思路是**枚举每个敌方单位作为基准，计算其他单位与其在特定时间点的坐标重合情况**，统计各时间点的最大重合数量。

### **关键实现步骤**
1. **预处理速度**：将方向转换为x/y轴的分速度。
2. **枚举基准点**：对每个点i，遍历其他点j，计算两者的相遇时间t。
3. **分情况处理**：
   - **速度相同**：若初始坐标相同，则永久同列/行。
   - **速度不同**：计算相遇时间t，若t为非负整数且满足距离差整除速度差，则记录该时间。
4. **哈希统计**：用哈希表统计每个时间t的命中次数，结合初始重合点数更新最大值。

### **解决难点**
- **数学公式推导**：正确计算两点的相遇时间，需处理分母为0的情况及整数判断。
- **高效统计**：通过哈希表动态维护各时间点的命中次数，避免重复计算。

---

## **题解评分（≥4星）**
1. **wuhan1234（5星）**
   - **亮点**：精确计算所有可能的相遇时间，正确性高，代码逻辑清晰。
   - **代码片段**：
     ```cpp
     void calc(int X[], int vx[], int n) {
         memset(h, 0, sizeof(h));
         int cnt = 1;
         for (int j = 1; j <= n; j++) {
             if (vx[i] == vx[j]) {
                 if (X[i] == X[j]) cnt++;
             } else {
                 int dx = X[i] - X[j], dv = vx[j] - vx[i];
                 int t = dx / dv;
                 if (dx % dv == 0 && t >= 0) h[t]++;
             }
         }
     }
     ```
2. **封禁用户（4星）**
   - **亮点**：分情况讨论各方向组合，覆盖所有可能的相遇时间。
   - **缺点**：代码冗长但思路完整。
3. **jackwahaha（4星）**
   - **亮点**：枚举时间到较大范围（1111次），代码简洁，适用于快速实现。

---

## **最优思路提炼**
- **数学公式法**：通过解方程计算两点相遇时间，确保覆盖所有可能时刻。
- **哈希动态统计**：用哈希表记录各时间点的命中次数，避免暴力枚举时间轴。
- **双轴处理**：分别处理X轴和Y轴，最后取最大值。

---

## **同类题目推荐**
1. **P1036 选数**：枚举组合数，类似暴力枚举思路。
2. **P1217 回文质数**：数学判断与枚举结合。
3. **P1059 明明的随机数**：哈希统计重复元素。

---

## **可视化设计**
### **动画方案**
- **动态路径绘制**：在Canvas中绘制敌方单位的移动轨迹，高亮相遇时间点。
- **时间轴标记**：用颜色标记不同时间点的命中次数，红色表示当前最大值。
- **交互控制**：支持暂停/继续，调整动画速度观察关键时间点的统计变化。

### **复古像素风格**
- **8位色块**：敌方单位用不同颜色像素块表示，基准点闪烁显示。
- **音效反馈**：命中时播放“哔”声，最大值更新时播放上扬音效。
- **自动演示模式**：模拟AI自动选择基准点，逐步展示计算过程。

---

## **代码片段（核心逻辑）**
```cpp
// 预处理方向与速度
for (int i = 1; i <= n; i++) {
    switch (d[0]) {
        case 'R': vx[i] = v; break;
        case 'L': vx[i] = -v; break;
        case 'U': vy[i] = v; break;
        case 'D': vy[i] = -v; break;
    }
}

// 计算X轴最大命中
void calc(int X[], int vx[], int n) {
    for (int i = 1; i <= n; i++) {
        int cnt = 1;
        memset(h, 0, sizeof(h));
        for (int j = 1; j <= n; j++) {
            if (i == j) continue;
            if (vx[i] == vx[j]) {
                if (X[i] == X[j]) cnt++;
            } else {
                int dx = X[i] - X[j];
                int dv = vx[j] - vx[i];
                if (dv == 0 || dx % dv != 0) continue;
                int t = dx / dv;
                if (t >= 0) h[t]++;
            }
        }
        // 更新最大值
        for (int t = 0; t < MAX_TIME; t++)
            ans = max(ans, cnt + h[t]);
    }
}
```

---
处理用时：193.20秒
# 题目信息

# [USACO20OPEN] Cowntact Tracing B

## 题目描述

由于高传染性的牛传染病 COWVID-19 的爆发，Farmer John 非常担忧他的奶牛们（编号为 $1\ldots N$）的健康。

最近，Farmer John 对他的所有奶牛进行了检测，发现有一部分奶牛对该疾病的检测结果呈阳性。利用牛棚内的视频监控，他得以查看最近的奶牛之间的互动行为，结果发现奶牛们互相打招呼时，她们会握蹄，不幸的是这是一种会将疾病从一头奶牛传播给另一头奶牛的行为。Farmer John 汇总了一个添加了时间戳的清单，每条数据的形式为 $(t,x,y)$，表示在时间 $t$，奶牛 $x$ 与奶牛 $y$ 握了蹄。Farmer John 同时还知道以下信息：

（一）他的农场上恰有一头奶牛最初带有携带疾病（我们将这头奶牛称为“零号病人”）。

（二）一旦一头奶牛被感染，她会在接下来的 $K$ 次握蹄中传染疾病（可能会与同一头奶牛握蹄多次）。握蹄 $K$ 次后，她不再在此后的握蹄中传染疾病（因为此时她意识到了她会传染疾病，于是会仔细地洗蹄）。

（三）一旦一头奶牛被感染，她会持续处于被感染状态。

不幸的是，Farmer John 不知道他的 $N$ 头奶牛中的哪一头是零号病人，也不知道 $K$ 的值！基于他的数据，请帮助他缩小这些未知量的范围。保证至少有一种可能的情况。 

## 说明/提示

### 样例解释 1

唯一可能是零号病人的是奶牛 $1$。对于所有的 $K>0$，奶牛 $1$ 在时刻 $7$ 感染奶牛 $2$，而奶牛 $3$ 和奶牛 $4$ 均不会被感染。 

## 样例 #1

### 输入

```
4 3
1100
7 1 2
5 2 3
6 2 4```

### 输出

```
1 1 Infinity```

# AI分析结果



## 算法分类
**无算法分类**

## 综合分析与结论
题目核心是通过**暴力枚举**所有可能的零号病人和 K 值，模拟握手过程，验证感染结果是否与输入匹配。难点在于正确维护每头牛的剩余传染次数和感染状态的动态更新。核心算法流程如下：

1. **时间排序**：所有握手事件按时间排序，确保模拟顺序正确。
2. **双循环枚举**：外层枚举可能的零号病人，内层枚举 K 值。
3. **模拟感染传播**：维护每个牛的剩余传染次数，每次握手时根据双方状态更新次数和感染状态。
4. **结果验证**：检查模拟后的感染状态是否与输入一致。

**可视化设计**：
- **动画方案**：以时间轴为横轴，网格化展示每头牛的感染状态和剩余次数。当前处理的握手事件高亮，参与握手的牛用不同颜色标记。
- **关键变化**：感染状态变化时触发闪光效果，剩余次数减少时显示数字递减动画。
- **交互控制**：支持暂停/继续、单步执行、调整模拟速度，用户可手动选择零号病人和 K 值。
- **复古风格**：8-bit 像素风 UI，握手事件触发“哔”音效，成功匹配结果时播放胜利音效。

## 题解评分
### 题解作者：mengleo（⭐⭐⭐⭐⭐）
- **思路清晰度**：明确暴力枚举框架，时间排序与模拟逻辑清晰。
- **代码可读性**：结构简洁，变量命名合理，注释适当。
- **算法正确性**：正确处理剩余次数动态更新，通过 `max(0, ...)` 避免负数。
- **实践可操作性**：代码可直接运行，时间复杂度可控。

## 最优思路提炼
1. **枚举与模拟**：通过双重循环枚举所有可能的零号病人和 K 值，暴力覆盖所有可能情况。
2. **动态维护状态**：用数组记录每头牛的剩余传染次数，初始化为 -1 表示未感染，感染时设为 K，每次握手后递减。
3. **时间顺序处理**：握手事件按时间排序后顺序处理，确保感染传播的时序正确。
4. **边界处理**：K 最大枚举到 T+1，若匹配则为无穷大（Infinity）。

## 同类型题与套路
- **常见套路**：暴力枚举 + 状态模拟，适用于数据量小的情景（如 `N ≤ 100`）。
- **相似题目**：
  - [P1038 神经网络](https://www.luogu.com.cn/problem/P1038)：模拟信号传播过程。
  - [P1063 能量项链](https://www.luogu.com.cn/problem/P1063)：枚举断点并动态维护状态。
  - [P1541 乌龟棋](https://www.luogu.com.cn/problem/P1541)：暴力枚举步数组合。

## 代码核心片段
```cpp
// 模拟感染传播的核心逻辑
for (int i = 1; i <= t; i++) {
    int x = lst[i].x, y = lst[i].y;
    if (cs[x] == -1 && cs[y] > 0) {
        cs[y]--;
        cs[x] = k; // 感染 x 并设置剩余次数
    } else if (cs[y] == -1 && cs[x] > 0) {
        cs[x]--;
        cs[y] = k; // 感染 y 并设置剩余次数
    } else if (cs[x] >= 0 && cs[y] >= 0) {
        cs[x] = max(0, cs[x] - 1);
        cs[y] = max(0, cs[y] - 1);
    }
}
```

## 复古游戏化动画实现要点
1. **像素绘制**：用 Canvas 绘制牛棚网格，每头牛用 16x16 像素表示，感染状态用红色/绿色区分。
2. **音效设计**：感染时播放短促“滴”声，剩余次数归零时播放“咔嚓”声，背景循环 8-bit 音乐。
3. **自动演示**：AI 模式随机选择零号病人和 K 值，自动播放模拟过程，失败时显示“Game Over”。
4. **关卡积分**：每正确匹配一个 K 值得 10 分，连续正确触发连击奖励。

---
处理用时：249.86秒
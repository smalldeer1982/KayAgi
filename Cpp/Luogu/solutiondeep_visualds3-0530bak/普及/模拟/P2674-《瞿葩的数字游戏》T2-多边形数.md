# 题目信息

# 《瞿葩的数字游戏》T2-多边形数

## 题目背景

数字王国里有一类特殊的数，它们叫做多边形数。并且国王 $1$ 规定数字间的联姻只能在同为一种多边形数中进行。（请不要吐槽这个规定……）

瞿葩对这个现象十分好奇，见 $36$ 和 $10$ 这一对情侣在散步，便上前询问 $36$ 它是什么多边形数。可是 $36$ 拍拍脑门，想了想说：“我也不知道啊，你去问问国王吧。”

看来国民们并不知道自己是什么多边形数啊，国王 $1$ 急的发愁。国王 $1$ 只知道多边形数怎么计算，但是多边形数要怎么给国民做解释呢，干脆这样解释吧：可以排成正多边形的整数都是多边形数。当然多边形数可以分为三边（角）形数、四边形数（正方形数）、五边形数、六边形数……


## 题目描述

**此题为规律题，请自行寻找规律，以锻炼数学归纳能力！！**

我们拿三角形数做例子：图中的 $1$、$3$、$6$、$10$ 就是三角形数。

 ![](https://cdn.luogu.com.cn/upload/pic/1742.png) 

任务：求出 $N$ 是哪一种多边形数（假设 $N$ 是 $K$ 边形数），比如我们求出 $36$ 是三边形数和四边形数（貌似叫做三角形数和正方形数呵）。若不是多边形数，输出 Poor + 该数字。若同时是多种多边形数，输出最小的一个和第二小的一个。每个读入文件里有 $ng$ 组数据。


## 说明/提示

### 数据范围及约定

对于 $20\%$ 的数据，$1 \le K_1,K_2 \le 6$；

对于 $100\%$ 的数据， $1 \le N \le 10^6$，$1 \le ng \le 10^2$。

如果同时是多种多边形数，设 $K_1$ 为最小的 $K$，$K_2$ 为次小的 $K$。

国王 $1$：“你可以发现四边形数（正方形数）就是平方数这个规律吗？为方便理解，我给出前几个多边形数表。”（表中可以看出，正六边形不包括正中心的那个点，以此类推）

| 自然数 | $1$ | $2$ | $3$ | $4$ | $5$ | $6$ | $7$ | $8$ |
| :-: | :-: | :-: | :-: | :-: | :-: | :-: | :-: | :-: |
| 三角形数 | $1$ | $3$ | $6$ | $10$ | $15$ | $21$ | $28$ | $36$ |
| 正方形数 | $1$ | $4$ | $9$ | $16$ | $25$ | $36$ | $49$ | $64$ |
| 五边形数 | $1$ | $5$ | $12$ | $22$ | $35$ | $51$ | $70$ | $92$ |
| 六边形数 | $1$ | $6$ | $15$ | $28$ | $45$ | $66$ | $91$ | $120$ |


## 样例 #1

### 输入

```
2
36
1000000
```

### 输出

```
3 4
4 204
```

# AI分析结果



**算法分类**  
数学/数论

---

### **题解思路、算法要点与解决难点**  
**核心思路**：基于多边形数通项公式 $K = \frac{2(N - k)}{k(k-1)} + 2$，枚举可能的项数 $k$，判断 $(N - k)$ 是否能被 $\frac{k(k-1)}{2}$ 整除，从而快速计算边数。  
**关键步骤**：  
1. **数学推导**：将通项公式变形为可枚举的条件判断式，避免直接枚举边数的高复杂度。  
2. **倒序枚举**：从大项数 $k$ 开始枚举，确保优先找到更小的边数。  
3. **特判处理**：单独处理 $N=1$（输出3、4）和 $N=2$（无解）的特殊情况。  

**解决难点**：  
- **时间复杂度优化**：通过数学变形将问题转化为 $O(\sqrt{N})$ 的枚举。  
- **边界条件处理**：例如项数 $k$ 的下限和整除判断的数学细节。  

---

### **题解评分（≥4星）**  
1. **作者：reclusive（5星）**  
   - **亮点**：通过倒序枚举项数 $k$，直接计算边数 $K$，代码简洁高效。  
   - **代码片段**：  
     ```cpp  
     for(int i=sqrt(2*x)+1;i>=2;i--){  
         if(2*(x-i)%(i*(i-1))==0){...}  
     }  
     ```  
2. **作者：mt19337（4.5星）**  
   - **亮点**：公式变形为 $n = \frac{2a_k + 2k^2 -4k}{k^2 -k}$，通过枚举分母优化判断。  
   - **代码片段**：  
     ```cpp  
     for(int k=2;k<=n[i];k++){  
         int tpl = (n * 2 - 4 * k + 2 * k * k);  
         int tpr = (k * k - k);  
     }  
     ```  
3. **作者：hanzhongtlx（4星）**  
   - **亮点**：从列的角度分析，推导每列公差规律，通过累加和判断。  

---

### **最优思路提炼**  
1. **通项公式变形**：将多边形数公式 $N = k + \frac{(K-2)k(k-1)}{2}$ 变形为 $K = \frac{2(N - k)}{k(k-1)} + 2$。  
2. **倒序枚举项数**：从 $\sqrt{2N}$ 开始倒序枚举 $k$，确保优先找到更小的边数。  
3. **快速判断**：仅需判断 $(N - k) \mod \frac{k(k-1)}{2} = 0$ 即可确定是否为多边形数。  

---

### **同类型题与算法套路**  
- **通用解法**：数学公式推导 + 因数枚举。  
- **类似题目**：  
  1. **判断平方数**（洛谷P1217）  
  2. **三角形数判断**（数学推导类似，通项为 $n(n+1)/2$）。  
  3. **P2423 判断双倍立方数**。  

---

### **推荐题目**  
1. **P1217**：判断回文质数（数学+枚举优化）。  
2. **P1045**：高精度数处理（数学变形优化）。  
3. **P2423**：双倍立方数判断（类似的多项式分解）。  

---

### **个人心得摘录**  
- **调试教训**：注意 $k=1$ 时分母为0，需特判 $N=1$（作者：reclusive）。  
- **数学直觉**：表格列分析比行分析更容易发现公差规律（作者：azihmst）。  

---

### **可视化与算法演示**  
**动画方案设计**：  
1. **像素风格界面**：  
   - **颜色方案**：8-bit 色调（深蓝背景 + 亮黄高亮当前 $k$）。  
   - **网格绘制**：在 Canvas 中以网格展示枚举过程，当前 $k$ 高亮显示。  
2. **关键步骤高亮**：  
   - **当前枚举 $k$**：红色边框标记，显示计算式 $K = \frac{2(N - k)}{k(k-1)} + 2$。  
   - **有效解**：绿色闪烁 + 音效提示（成功时播放上升音调）。  
3. **自动演示模式**：  
   - **AI 控制**：自动从 $\sqrt{2N}$ 开始倒序枚举，单步间隔 500ms。  
   - **交互控制**：支持暂停/继续/步进，速度可调（1x/2x/5x）。  

**代码片段（JS 伪代码）**：  
```javascript  
function visualize(N) {  
    let k = Math.sqrt(2 * N);  
    const canvas = document.getElementById("canvas");  
    // 绘制初始网格和公式  
    while (k >= 2) {  
        highlightCurrentK(k);  
        if ((N - k) % (k * (k - 1) / 2) === 0) {  
            playSuccessSound();  
            addResultToPanel(calculateK(k, N));  
        }  
        k--;  
    }  
}  
```  

---

### **完整代码参考（reclusive 题解）**  
```cpp  
#include<iostream>  
#include<cmath>  
using namespace std;  
void found(int x){  
    if(x==1){cout<<"3 4\n";return;}  
    for(int i=sqrt(2*x)+1;i>=2;i--){  
        if(2*(x-i)%(i*(i-1))==0){...}  
    }  
}  
int main(){  
    int n,a;  
    while(n--){found(a);}  
}  
```

---
处理用时：95.57秒
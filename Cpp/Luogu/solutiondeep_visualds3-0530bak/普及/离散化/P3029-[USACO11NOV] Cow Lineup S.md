# 题目信息

# [USACO11NOV] Cow Lineup S

## 题目描述

### 问题描述

农民约翰雇一个专业摄影师给他的部分牛拍照。由于约翰的牛有好多品种，他喜欢他的照片包含每个品种的至少一头牛。

约翰的牛都站在一条沿线的不同地方， 每一头牛由一个整数位置 $X_i$ 以及整数品种编号 $ID_i$ 表示。

约翰想拍一张照片，这照片由沿线的奶牛的连续范围组成。照片的成本与规模相当，这就意味着，在一系列照片中的最大和最小 $X$ 坐标的差距决定了照片的成本。

请帮助约翰计算最小的照片成本，这些照片中有每个不同的品种的至少一头牛，没有两头牛愿意站在同一个地点的。

## 样例 #1

### 输入

```
6 
25 7 
26 1 
15 1 
22 3 
20 1 
30 1 
```

### 输出

```
4 
```

# AI分析结果



### 唯一算法分类
滑动窗口（双指针法）

### 综合分析与结论
**核心思路**：将牛按位置排序后，使用滑动窗口维护包含所有品种的最小连续区间。右指针扩展至包含所有品种，左指针收缩冗余以优化区间长度。

**难点突破**：
1. **快速判断窗口内品种数**：使用哈希表（如map）或离散化数组统计当前窗口内各品种出现次数。
2. **动态维护最小区间**：通过左右指针的交替移动，确保时间复杂度为O(n)。

**可视化设计**：
- **动画流程**：Canvas绘制排序后的牛图标，左右指针以不同颜色高亮。窗口区间用半透明色块覆盖，品种计数实时更新。
- **像素风格**：牛图标采用8-bit像素风格，指针移动时播放电子音效，找到更优解时触发上扬音效。
- **交互控制**：可调节动画速度，单步执行观察指针移动与哈希表变化。

### 题解清单 (≥4星)
1. **糪眾脦颰罷 (5星)**  
   - **亮点**：简洁的滑动窗口实现，map处理品种计数，预处理总品种数优化判断逻辑。
2. **Priori_Incantatem (4星)**  
   - **亮点**：双指针清晰分离扩展与收缩阶段，离散化ID降低空间复杂度。
3. **luaddict (4星)**  
   - **亮点**：单调队列维护最左有效端点，动态去冗余思路清晰。

### 最优思路与代码实现
**关键步骤**：
1. 预处理所有牛的位置并排序。
2. 统计总品种数，初始化双指针与计数哈希表。
3. 右指针扩展至包含所有品种，左指针收缩冗余。
4. 实时更新最小区间差。

**代码片段**：
```cpp
sort(srt+1, srt+n+1, cmp); // 按位置排序
int l = 1, r = 0, sum = 0;
while (r < n) {
    ++r; 
    if (++c[id[r]] == 1) sum++; // 右指针扩展
    while (c[id[l]] > 1) {      // 左指针收缩冗余
        --c[id[l++]];
    }
    if (sum == tot) {           // 更新答案
        ans = min(ans, a[r] - a[l]);
    }
}
```

### 类似题目推荐
1. **P1638 逛画展** - 滑动窗口求最小区间包含所有元素。
2. **P2564 [SCOI2009]生日礼物** - 双指针维护多条件区间。
3. **P1712 [NOI2016] 区间** - 滑动窗口与区间覆盖结合。

### 可视化算法演示
**动画设计**：
1. **初始化**：牛按位置排成一行，品种用不同颜色像素块表示。
2. **指针移动**：右指针（红色）右移时，对应牛品种计数+1；左指针（蓝色）右移时计数-1。
3. **计数面板**：实时显示当前窗口内各品种计数，未覆盖品种高亮闪烁。
4. **音效反馈**：指针移动触发“滴”声，区间更新时播放“叮”声。

**复古效果**：
- **8-bit音效**：使用Web Audio API生成方波音效，模拟FC游戏音效。
- **Canvas绘制**：牛位置用16x16像素块表示，窗口色块半透明绿色，指针为箭头图标。

### 总结
滑动窗口法通过动态调整区间边界，高效解决了最小区间覆盖问题。结合离散化与哈希计数，算法在时间与空间复杂度上均达到最优。通过复古风格的可视化，可直观理解双指针的移动逻辑与计数变化，提升学习趣味性。

---
处理用时：59.84秒
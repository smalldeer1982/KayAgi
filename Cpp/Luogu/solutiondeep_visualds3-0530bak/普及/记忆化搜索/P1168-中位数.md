# 题目信息

# 中位数

## 题目描述

给定一个长度为 $N$ 的非负整数序列 $A$，对于前奇数项求中位数。

## 说明/提示

对于 $20\%$ 的数据，$N \le 100$；

对于 $40\%$ 的数据，$N \le 3000$；

对于 $100\%$ 的数据，$1 \le N ≤ 100000$，$0 \le A_i \le 10^9$。


## 样例 #1

### 输入

```
7
1 3 5 7 9 11 6```

### 输出

```
1
3
5
6```

## 样例 #2

### 输入

```
7
3 1 5 9 8 7 6```

### 输出

```
3
3
5
6```

# AI分析结果



**唯一算法分类**：对顶堆（双堆维护中位数）

---

### **综合分析与结论**

**核心思路**  
维护两个堆：大根堆（存较小半）、小根堆（存较大半）。插入时根据当前中位数决定归属，动态调整堆大小，保证大根堆元素数 ≥ 小根堆，中位数为大根堆顶。复杂度 O(n log n)。

**难点与解决**  
1. **堆平衡调整**：插入后需检查堆大小差，若超过1则转移堆顶。  
2. **插入策略**：新元素需与当前中位数比较，决定进入哪个堆。  
3. **奇偶处理**：仅奇数位输出，需控制堆大小关系。  

**最优解法**：对顶堆法（肖恩Sean题解），时间效率最高且代码简洁。

---

### **题解清单 (≥4星)**

1. **肖恩Sean（5星）**  
   - 亮点：双堆维护清晰，调整逻辑简洁，代码高效。  
   - 核心代码：
     ```cpp
     priority_queue<int> q1; // 大根堆（较小半）
     priority_queue<int, vector<int>, greater<int>> q2; // 小根堆（较大半）
     while (abs(q1.size() - q2.size()) > 1) {
         if (q1.size() > q2.size()) q2.push(q1.top()), q1.pop();
         else q1.push(q2.top()), q2.pop();
     }
     ```

2. **IRipple（4星）**  
   - 亮点：引入mid变量直观维护当前中位数，调整策略易理解。  
   - 个人心得：“每次插入后通过mid判断归属堆，调整更直接。”

3. **ysj1173886760（4星）**  
   - 亮点：树状数组+离散化，适合静态数据多次查询。  
   - 核心代码：
     ```cpp
     void add(int x) { // 树状数组插入
         for (; x <= n; x += x&-x) c[x]++;
     }
     int kth(int k) { // 二分查找第k小
         int l=0, r=MAX, ans;
         while (l <= r) {
             if (sum(mid) >= k) ans=mid, r=mid-1;
             else l=mid+1;
         }
         return ans;
     }
     ```

---

### **可视化设计要点**

**对顶堆操作动画（复古像素风格）**  
1. **界面**：8-bit像素风格，分左右两堆（大根堆棕色、小根堆蓝色），堆顶高亮显示。  
2. **元素插入**：新元素以闪烁方块进入，比较当前中位数后飞向对应堆，触发“滴”音效。  
3. **堆调整**：转移堆顶时，元素弹跳并播放“咔嚓”声，堆大小实时更新。  
4. **中位数显示**：堆顶金色边框，每次输出时放大显示数值，背景音调上扬。  
5. **自动演示**：按空格切换手动/自动模式，速度滑块控制动画节奏。

**Canvas示例代码（关键片段）**  
```javascript
function drawHeap(ctx, heap, x, isMaxHeap) {
    heap.forEach((val, i) => {
        ctx.fillStyle = isMaxHeap ? '#8B4513' : '#4682B4';
        drawPixelRect(ctx, x, 100 - i*20, val); // 像素方块绘制
    });
}
// 插入动画：元素飞入目标堆，轨迹抛物线
function animateInsert(val, targetHeap) {
    // ...使用requestAnimationFrame实现平滑移动
}
```

---

### **相似题目推荐**
1. **P1801 黑匣子**（对顶堆求动态第k小）  
2. **P3871 中位数**（完全一致，双堆复用）  
3. **P2085 动态中位数查询**（变种，需离线处理）  

---

**个人心得**  
调试时发现，若未及时调整堆大小，偶数字符串处理会导致中位数偏移。关键点在于插入后立即检查堆平衡，而非延迟到输出前，确保状态实时正确。

---
处理用时：76.11秒
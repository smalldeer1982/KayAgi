# 题目信息

# 【模板】模意义下的乘法逆元

## 题目背景

这是一道模板题


## 题目描述

给定 $n,p$ 求 $1\sim n$ 中所有整数在模 $p$ 意义下的乘法逆元。

这里 $a$ 模 $p$ 的乘法逆元定义为 $ax\equiv1\pmod p$ 的解。

## 说明/提示

$ 1 \leq n \leq 3 \times 10 ^ 6$，$n < p < 20000528 $。

输入保证 $ p $ 为质数。


## 样例 #1

### 输入

```
10 13```

### 输出

```
1
7
9
10
8
11
2
5
3
4```

# AI分析结果



## 算法分类
线性递推法求逆元

---

## 题解分析与结论

### 核心思路
通过递推公式在O(n)时间内求出1~n的逆元：
``` 
inv[i] = (p - p/i) * inv[p%i] % p
```
#### 解决难点
1. 数学推导：利用带余除法将逆元计算分解为更小的子问题
2. 符号处理：通过(p - p/i)避免负数的产生
3. 递推顺序：从i=2开始递推，保证p%i < i时inv[p%i]已计算

### 题解评分（≥4星）
1. zjp_shadow（⭐⭐⭐⭐⭐）  
   完整推导递推公式，给出多种逆元求法对比

2. zcysky（⭐⭐⭐⭐）  
   简洁高效的线性递推实现，0.66s通过3e6数据

3. Rising_Date（⭐⭐⭐⭐）  
   详细推导递推公式，给出数学证明过程

---

## 核心代码实现
```cpp
#include<cstdio>
typedef long long ll;
const int N=3e6+10;
ll inv[N];

int main() {
    int n,p;
    scanf("%d%d",&n,&p);
    inv[1]=1; puts("1");
    for(int i=2;i<=n;++i) {
        inv[i]=(ll)(p-p/i)*inv[p%i]%p;
        printf("%lld\n",inv[i]);
    }
    return 0;
}
```

---

## 可视化设计

### 动画方案
**8位像素风格演示：**
1. **初始状态**：绿色方块表示inv[1]=1
2. **递推过程**：
   - 红色高亮当前计算的i
   - 黄色箭头从i指向p%i的位置
   - 蓝色数字实时显示计算结果
3. **音效提示**：
   - 按键音效：每次计算时播放8-bit按键音
   - 完成音效：全部计算完成后播放经典FC过关音效

### 交互功能
```javascript
// 伪代码示例
const canvas = document.createElement('canvas');
const ctx = canvas.getContext('2d');

function drawStep(i) {
    // 绘制当前i的方块
    ctx.fillStyle = '#FF0000'; // 红色当前i
    ctx.fillRect(x, y, size, size);
    
    // 绘制依赖的p%i方块
    ctx.fillStyle = '#FFFF00'; // 黄色依赖项
    ctx.fillRect(dep_x, dep_y, size, size);
    
    // 播放音效
    beep(800, 0.1); // 800Hz短音
}

// 自动播放控制
let current = 2;
const animate = () => {
    if(current <= n) {
        drawStep(current);
        current++;
        requestAnimationFrame(animate);
    }
};
```

---

## 扩展练习
1. P1082 [同余方程](https://www.luogu.com.cn/problem/P1082)  
   （练习扩展欧几里得法求逆元）

2. P1313 [计算系数](https://www.luogu.com.cn/problem/P1313)  
   （组合数计算中的逆元应用）

3. P2613 [有理数取余](https://www.luogu.com.cn/problem/P2613)  
   （分数取模的逆元应用）

---

## 知识关联
**模运算性质**  
当p为质数时，利用公式：
```
a^(p-1) ≡ 1 (mod p) → a^(p-2) ≡ a^-1 (mod p)
```
可推导出快速幂解法，但时间复杂度O(n log p)不适用于本题

---

## 调试心得
1. **负数处理**：公式中(p - p/i)确保结果为正数
2. **数据类型**：使用long long避免中间结果溢出
3. **输出优化**：使用printf代替cout提升IO效率

---

通过线性递推法，可以在3e6数据规模下实现0.6秒内的极速计算，是处理大规模逆元问题的标准解法。理解其数学推导过程对于掌握模运算体系至关重要。

---
处理用时：71.55秒
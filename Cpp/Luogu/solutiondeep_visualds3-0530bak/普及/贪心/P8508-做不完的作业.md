# 题目信息

# 做不完的作业

## 题目背景

高中的任务是非常艰巨的，要学习十门功课（浙江要学技术）。导致作业超级加倍，这一点在暑假就已经体现出来了。

作业的总量是一定的，但不同作业下发的时间是不一定的，导致每天都要花不同的时间应付作业。此时，如何保证睡眠是一个需要仔细考虑的问题。

## 题目描述

**提示：如果你对题目内容有疑问，可以配合样例更好地阅读。**

有 $n$ 个任务，第 $i$ 个任务需要 $t_i$ 的时间。Eric 要在若干天内**依次**完成这些任务。Eric 是一个专注的人，所以完成每个任务的时间**必须连续**。

一天有 $x$ 的时间。由于 Eric 需要睡觉，所以 Eric 不能利用所有的时间。具体地：

- Eric 每天**必须睡觉**；
- Eric 每天的睡觉的时间是连续的，且睡觉时间结束后，第二天恰好开始；
- Eric **前 $\boldsymbol i$ 天**的睡觉时间**总和**不能少于 $r\cdot x\cdot i$ 的时间。$r$ 是一个给定的实数，$i$ 是一个正整数。

Eric 想问你，至少需要多少天才能完成任务。

## 说明/提示

#### 样例 1 解释

下面是一种可能的方案：

Eric 先在第一天做任务 1，总共消耗 $1$ 的时间，用 $4$ 时间睡觉，满足至少要 $5\times \dfrac 1 3=\dfrac 5 3$ 的时间睡觉的要求。

Eric 再在第二天加班加点，完成剩下的任务，有 $1$ 的时间睡觉。两天睡觉总量为 $5\ge 10\times \dfrac 1 3=\dfrac {10} 3$，也是满足要求的。

#### 样例 2 解释

Eric 试图在第一天完成任务 1，但假如要做就会熬夜，觉就不够睡。所以 Eric 第一天只能睡大觉。Eric 在第二天完成任务 1 就没有问题。

同时请注意，即使睡觉时间满足了要求，Eric 也不能在第二天就完成任务 2，因为 Eric 必须睡觉。所以 Eric 先睡到第三天，然后完成任务 2。可以证明不存在方案小于三天。

同时注意数据**不保证** $\gcd(p,q)=1$。

#### 样例 3 解释

显然一天只能干一件活，所以要 $10$ 天。

#### 样例 4 解释

该样例满足子任务 3 的限制条件。

#### 样例 5 解释

该样例满足子任务 5 的限制条件。

### 数据规模与约定

**本题捆绑测试**。对于所有数据，保证 $1\le n\le 10^5$，$1\le t_i<x\le 10^6$，$1\le p<q\le 10^6$。

$$
\def\arraystretch{1.5}
\begin{array}{|c|c|c|c|}\hline

\bf 子任务 & \bf 分值 & n\le & \bf特殊性质
\\
\hline
1 & 10 & 3 & /\\\hline
2 & 20 & 10^3 & \bf A \\\hline
3 & 20 & / & \bf A\\\hline
4 & 20 & / & \bf B\\\hline
5 & 30 & / & /\\\hline
\end{array}
$$

特殊性质 $\bf A$：$\forall i,\ \dfrac{t_i}{x}+\dfrac{p}{q}\le 1$。

特殊性质 $\bf B$：$n\times q\le 10^6$。

为了减少评测量，本题开启子任务依赖。具体地，当且仅当前四个子任务全部通过时，子任务 5 才计分，否则子任务 5 计 $0$ 分。

## 样例 #1

### 输入

```
3 5 1 3
1 2 2```

### 输出

```
2```

## 样例 #2

### 输入

```
2 10 4 10
9 1```

### 输出

```
3```

## 样例 #3

### 输入

```
10 2 1 2
1 1 1 1 1 1 1 1 1 1```

### 输出

```
10```

## 样例 #4

### 输入

```
见下发文件 task/task4.in```

### 输出

```
见下发文件 task/task4.ans```

## 样例 #5

### 输入

```
见下发文件 task/task5.in```

### 输出

```
见下发文件 task/task5.ans```

# AI分析结果



### 一、题解思路、算法要点与解决难点

#### 算法核心：贪心策略 + 数学推导优化
- **贪心思路**：按顺序处理每个任务，尽可能早地完成。若当前天无法满足睡觉时间约束，计算需要连续睡的天数，直接跳过。
- **数学优化**：通过推导不等式，将天数计算转化为整数运算，避免逐天模拟。
- **关键约束**：总睡觉时间需满足前 i 天的比例要求，通过不等式推导快速求解跳过的天数。

#### 解决难点
1. **跳跃式计算**：直接逐天模拟会超时，需推导公式快速计算需睡的天数。
2. **整数运算**：避免浮点精度问题，通过通分和不等式变形，用整数除法处理。
3. **边界条件**：如任务刚好占满当天时间、分母为负数时的取整方向。

### 二、题解评分（≥4星）

1. **5ab_juruo（5星）**
   - **思路清晰**：正序贪心结合数学推导，代码简洁高效。
   - **优化巧妙**：线性时间处理，跳过连续睡觉天数。
   - **代码示例**：通过不等式计算跳跃天数，逻辑明确。

2. **Little09（4.5星）**
   - **推导详细**：给出完整不等式推导过程，帮助理解数学优化。
   - **代码注释**：关键步骤有详细解释，适合深入学习。

3. **ArcherHavetoLearnWhk（4星）**
   - **倒序贪心**：提供不同视角，假设前面全睡最后赶工。
   - **代码简洁**：倒序处理任务，更新总天数。

### 三、最优思路提炼
1. **正序贪心**：按任务顺序处理，维护当前天数和总睡觉时间。
2. **跳跃计算**：若当前天无法完成任务，解不等式：
   \[
   k \geq \frac{q \cdot (\text{sl} + x - t_i) - p \cdot x \cdot (j+1)}{x \cdot (p - q)}
   \]
   直接计算需睡的天数 \(k\)，跳至 \(j + k\) 天。
3. **整数运算**：避免浮点，通过分子调整确保向上取整。

### 四、同类型题与算法套路
- **常见场景**：带时间约束的调度问题（如作业调度、区间覆盖）。
- **通用解法**：
  - **贪心选择**：尽早处理任务，减少后续约束。
  - **数学优化**：推导公式跳过无效状态，降低复杂度。

### 五、洛谷相似题目推荐
1. **P1080 国王游戏**（贪心排序）
2. **P1223 排队接水**（时间调度贪心）
3. **P5019 铺设道路**（区间覆盖贪心）

### 六、关键代码片段（以5ab_juruo为例）
```cpp
for (ll j=1;;j++) {
    if ((m-a[tot]+sl)*q < m*p*j) { // 不满足条件
        ll i = (m*p*j - (m-a[tot]+sl)*q + (m*(q-p)) -1) / (m*(q-p));
        j += i; // 跳i天
        sl += i*m; // 更新总睡觉时间
    }
    // 处理当前任务...
}
```

### 七、可视化与算法演示
1. **动画设计**：
   - **当前任务高亮**：显示正在处理的任务及所需时间。
   - **睡觉天数跳跃**：用红色标记跳过的天数，显示公式推导结果。
   - **进度条**：展示已处理任务和剩余天数。

2. **复古像素风格**：
   - **Canvas绘制**：任务块为绿色，睡觉天数为蓝色，当前处理区域闪烁。
   - **音效**：完成任务时播放“滴答”，跳跃时播放“嗖”音效。

3. **交互功能**：
   - **步进控制**：允许单步执行，观察不等式计算过程。
   - **参数调节**：动态调整\(p/q\)，观察天数变化。

### 八、总结
本题核心在于贪心策略与数学优化的结合，通过推导公式快速跳过无效状态，将复杂度降至线性。正序处理更直观，倒序方法提供不同视角，两者均需深入理解约束条件与数学推导。

---
处理用时：77.88秒
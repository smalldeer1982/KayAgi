# 题目信息

# 【模板】模意义下的乘法逆元

## 题目背景

这是一道模板题


## 题目描述

给定 $n,p$ 求 $1\sim n$ 中所有整数在模 $p$ 意义下的乘法逆元。

这里 $a$ 模 $p$ 的乘法逆元定义为 $ax\equiv1\pmod p$ 的解。

## 说明/提示

$ 1 \leq n \leq 3 \times 10 ^ 6$，$n < p < 20000528 $。

输入保证 $ p $ 为质数。


## 样例 #1

### 输入

```
10 13```

### 输出

```
1
7
9
10
8
11
2
5
3
4```

# AI分析结果



---

## 算法分类
**线性递推求逆元**

## 题解思路与核心算法
题目要求快速求出1~n每个数在模质数p下的逆元。当n达到3e6时，必须采用线性时间复杂度算法。**递推公式**`inv[i] = (p - p/i) * inv[p%i] % p`是该题的核心解法。其推导过程基于带余除法`p = k*i + r`，通过同余方程变形得到逆元的递推关系。

### 算法实现步骤
1. **初始化**：`inv[1] = 1`（1的逆元为自身）
2. **递推计算**：`for(i=2→n) inv[i] = (p - p/i) * inv[p%i] % p`
3. **处理负数**：通过`(p - p/i)`确保结果为正数后再取模

## 关键对比与结论
| 方法          | 时间复杂度 | 适用场景                | 优势            |
|---------------|------------|-------------------------|-----------------|
| 扩展欧几里得  | O(n log p) | 单次求逆元              | 通用性较强      |
| 费马小定理    | O(n log p) | p为质数时               | 代码简单        |
| **线性递推**  | **O(n)**   | 大规模连续求逆元        | **极速高效**    |

结论：当需要连续求解1~n的逆元时，线性递推法以O(n)时间复杂度碾压其他方法，是本题的最优解。

## 高星题解推荐（≥4星）
1. **zjp_shadow（5星）**  
   - 亮点：从同余方程推导递推公式，给出完整数学证明
   - 代码片段：  
     ```cpp
     inv[1] = 1;
     for(int i=2; i<=n; ++i)
         inv[i] = (p - p/i)*inv[p%i]%p;
     ```

2. **zcysky（4.5星）**  
   - 亮点：代码极度简洁，直接应用递推公式
   - 优化：使用`long long`防止中间结果溢出

3. **Rising_Date（4星）**  
   - 亮点：详细对比四种求逆元方法，突出线性递推优势
   - 调试心得：强调`p - p/i`的负数处理技巧

## 核心代码实现
```cpp
#include<cstdio>
typedef long long ll;
const int N=3e6+10;
ll inv[N];
int main(){
    int n,p;
    scanf("%d%d",&n,&p);
    inv[1]=1; puts("1");
    for(int i=2;i<=n;++i){
        inv[i] = (p - p/i) * inv[p%i] % p;
        printf("%lld\n",inv[i]);
    }
    return 0;
}
```

## 算法可视化设计
1. **动画流程**：
   - 初始化1的逆元为绿色高亮
   - 每次计算`i`时，动态显示`p/i`和`p%i`的值
   - 用红色箭头标记`inv[p%i]`的依赖关系
   - 结果数值以像素字体弹出，伴随8-bit音效

2. **复古风格**：
   - 背景：深蓝网格模拟CRT显示器
   - 数据流：用绿色像素块表示已计算的逆元
   - 音效：每次计算成功时播放NES风格短音

3. **交互功能**：
   - 暂停/继续按钮控制算法执行
   - 速度滑块调节1ms~1000ms/步
   - 鼠标悬停显示当前i值的详细计算式

## 相似题目推荐
1. [P5431 乘法逆元2](https://www.luogu.com.cn/problem/P5431)  
   （线性递推法的变式应用）
   
2. [P2613 有理数取余](https://www.luogu.com.cn/problem/P2613)  
   （逆元在分数运算中的应用）

3. [P3868 猜数字](https://www.luogu.com.cn/problem/P3868)  
   （中国剩余定理与逆元的结合）

---
处理用时：78.87秒
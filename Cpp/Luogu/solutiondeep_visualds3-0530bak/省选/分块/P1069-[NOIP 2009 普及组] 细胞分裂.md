# 题目信息

# [NOIP 2009 普及组] 细胞分裂

## 题目描述

Hanks 博士是 BT（Bio-Tech，生物技术）领域的知名专家。现在，他正在为一个细胞实验做准备工作：培养细胞样本。

Hanks 博士手里现在有 $N$ 种细胞，编号从 $1 \sim N$，一个第 $i$ 种细胞经过 $1$ 秒钟可以分裂为 $S_i$ 个同种细胞（$S_i$ 为正整数）。现在他需要选取某种细胞的一个放进培养皿，让其自由分裂，进行培养。一段时间以后，再把培养皿中的所有细胞平均分入 $M$ 个试管，形成 $M$ 份样本，用于实验。Hanks 博士的试管数 $M$ 很大，普通的计算机的基本数据类型无法存储这样大的 $M$ 值，但万幸的是，$M$ 总可以表示为 $m_1$ 的 $m_2$ 次方，即 $M = m_1^{m_2}$，其中 $m_1,m_2$ 均为基本数据类型可以存储的正整数。

注意，整个实验过程中不允许分割单个细胞，比如某个时刻若培养皿中有 $4$ 个细胞，Hanks 博士可以把它们分入 $2$ 个试管，每试管内 $2$ 个，然后开始实验。但如果培养皿中有 $5$ 个细胞，博士就无法将它们均分入 $2$ 个试管。此时，博士就只能等待一段时间，让细胞们继续分裂，使得其个数可以均分，或是干脆改换另一种细胞培养。

为了能让实验尽早开始，Hanks 博士在选定一种细胞开始培养后，总是在得到的细胞“刚好可以平均分入 $M$ 个试管”时停止细胞培养并开始实验。现在博士希望知道，选择哪种细胞培养，可以使得实验的开始时间最早。


## 说明/提示

【输入输出样例 \#1 说明】

经过 $1$ 秒钟，细胞分裂成 $3$ 个，经过 $2$ 秒钟，细胞分裂成 $9$个，……，可以看出无论怎么分裂，细胞的个数都是奇数，因此永远不能分入 $2$ 个试管。

【输入输出样例 \#2 说明】

第 $1$ 种细胞最早在 $3$ 秒后才能均分入 $24$ 个试管，而第 $2$ 种最早在 $2$ 秒后就可以均分（每试管 $144 / {24}^1 = 6$ 个）。故实验最早可以在 $2$ 秒后开始。

【数据范围】

对于 $50 \%$ 的数据，有 $m_1^{m_2} \le 30000$。

对于所有的数据，有 $1 \le N \le 10000$，$1 \le m_1 \le 30000$，$1 \le m_2 \le 10000$，$1 \le S_i \le 2 \times {10}^9$。


NOIP 2009 普及组 第三题


## 样例 #1

### 输入

```
1 
2 1 
3
```

### 输出

```
-1
```

## 样例 #2

### 输入

```
2
24 1
30 12
```

### 输出

```
2
```

# AI分析结果



## 【唯一算法分类】  
质因数分解

---

## 【综合分析与结论】  
本题核心在于判断细胞分裂数能否覆盖试管数的质因数，并计算最小分裂时间。核心难点在于处理大指数分解与时间复杂度优化。各题解均采用质因数分解思路，通过分解 m1^m2 的质因数，验证每个细胞 s_i 的质因数是否包含所有 m1 的质因数，并计算最大时间系数。  

**可视化设计思路**：  
- **动画步骤**：左侧展示 m1 分解为质因数方块（如 2³×3¹），右侧逐个验证细胞质因数。  
- **高亮交互**：当细胞质因数不匹配时，触发红色闪烁提示；匹配时显示绿色对勾并计算时间。  
- **像素风格**：采用 8-bit 风格，质因数用不同颜色块表示，指数以数字显示。分解过程伴随复古音效，错误时播放短促低音，成功时播放高音。  
- **自动演示**：按步骤分解质因数，用户可调节速度观察每个质因数的匹配过程。

---

## 【题解清单 (≥4星)】  
1. **刘心远题解（★★★★☆）**  
   - **亮点**：代码简洁，直接分解 m1 后遍历细胞，用向上取整计算时间。  
   - **关键代码**：`maxn = max(maxn, (a[i]*m2 + k-1)/k)` 实现高效取整。  

2. **vectorwyx题解（★★★★☆）**  
   - **亮点**：使用 map 存储质因数映射，逻辑清晰易扩展。  
   - **心路历程**：强调部分分解 s_i 的重要性，避免冗余计算。  

3. **Eason_lyx题解（★★★★☆）**  
   - **亮点**：预处理 3 万内质数加速分解，优化时间复杂度。  
   - **调试技巧**：特判 m1=1 直接返回 0，避免无效计算。

---

## 【最优思路与代码实现】  
**核心逻辑**：分解 m1 的质因数并乘以 m2 得到目标指数。对每个细胞验证质因数覆盖性，计算每个质因数所需时间的最大值。  

**关键代码（刘心远）**：  
```cpp
void div(int n) { // 分解 m1 质因数
    for(int i=2; i*i<=n; i++) {
        if(n%i == 0) {
            p[++cnt][0] = i;
            while(n%i == 0) p[cnt][1]++, n /= i;
        }
    }
    if(n > 1) p[++cnt][0] = n, p[cnt][1]++;
}

int calc(int s) { // 计算细胞时间
    int maxn = 0;
    for(int i=1; i<=cnt; i++) {
        int k = 0;
        while(s % p[i][0] == 0) s /= p[i][0], k++;
        if(k == 0) return INF;
        maxn = max(maxn, (p[i][1]*m2 + k-1)/k);
    }
    return maxn;
}
```

**完整代码参考**：见用户提供的刘心远题解代码部分。

---

## 【同类型题与算法套路】  
1. **质因数覆盖性检查**：如 P1072 (Hankson的趣味题)，需验证数的因数覆盖性。  
2. **指数时间计算**：如 P2043 (质因数分解)，分解后处理指数运算。  
3. **优化分解策略**：预处理质数表加速分解，适用于大数场景。

---

## 【推荐题目】  
1. **P1072** - Hankson 的趣味题  
2. **P1029** - 最大公约数和最小公倍数问题  
3. **P2043** - 质因子分解  

---

## 【个人心得摘录】  
- **暗ざ之殇**：递归分解时强调“舍弃互质部分”，通过不断除 gcd 简化问题，但实现复杂度较高。  
- **vectorwyx**：指出分解 s_i 时只需处理 m1 的质因数，避免无效计算，提升效率。  
- **Eason_lyx**：预处理质数表大幅优化分解速度，实测可处理 1e5 级别数据。

---

## 【可视化与复古演示】  
**8-bit 像素动画实现**：  
1. **Canvas 绘制**：  
   - 质因数块用 16x16 像素表示，颜色随机生成。指数显示在块右上角。  
   - 分解 m1 时，质因数块从右侧飞出，伴随“分解音效”。  

2. **音效设计**：  
   - 正确匹配：8-bit 短促“叮”声（Web Audio 合成 800Hz 方波）。  
   - 错误匹配：低沉“嗡”声（200Hz 三角波）。  

3. **自动演示模式**：  
   ```javascript
   function autoPlay() {
       cells.forEach((cell, idx) => {
           setTimeout(() => highlightCell(cell), idx * 1000);
       });
   }
   ```

**交互示例**：  
[在线演示](https://jsfiddle.net/algovis/p9q9L6oz/)（伪代码示例，需补充实现）

---
处理用时：80.49秒
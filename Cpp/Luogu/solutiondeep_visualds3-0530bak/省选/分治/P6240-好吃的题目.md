# é¢˜ç›®ä¿¡æ¯

# å¥½åƒçš„é¢˜ç›®

## é¢˜ç›®èƒŒæ™¯

è¿™æ˜¯ä¸€é“å¥½åƒçš„é¢˜ç›®ã€‚

## é¢˜ç›®æè¿°

æœ‰ä¸€æ¡å°åƒè¡—ï¼Œä»å·¦åˆ°å³ä¾æ¬¡æ’åˆ—ç€ $n$ ä¸ªå•†åº—ï¼Œä» $1$ å¼€å§‹æ ‡å·ã€‚

ç¬¬ $i$ ä¸ªå•†åº—ä¼šåªå‡ºå”®ä¸€ç§å°åƒï¼Œçƒ­é‡ä¸º $h_i$ï¼Œç¾å‘³åº¦ä¸º $w_i$ã€‚

ç°åœ¨æœ‰ $m$ ä¸ªåƒè´§è¦æ¥é€›è¡—ï¼Œç¬¬ $i$ ä¸ªåƒè´§ä¼šåœ¨ $[l_i,r_i]$ çš„å•†åº—å†…å¯»æ‰¾å°åƒï¼Œè€Œä¸”ä¸ºäº†é˜²æ­¢å¤ªèƒ–ï¼Œæœ€å¤šèƒ½æ‘„å…¥ $t_i$ çš„çƒ­é‡ã€‚

å°åƒåƒå¤šäº†ä¼šè…»ï¼Œæ‰€ä»¥åŒä¸€ä¸ªå•†åº—çš„å°åƒåªèƒ½åƒä¸€æ¬¡ã€‚

ç°åœ¨æ¯ä¸ªåƒè´§æƒ³çŸ¥é“è‡ªå·±æœ€å¤šèƒ½å¾—åˆ°å¤šå°‘ç¾å‘³åº¦ã€‚

## è¯´æ˜/æç¤º

#### ã€æ ·ä¾‹è¾“å…¥è¾“å‡ºè§£é‡Šã€‘

**æ ·ä¾‹ 1 è§£é‡Š**

å¯¹äºç¬¬ä¸€ç»„æ•°æ®çš„ç¬¬ä¸€ä¸ªåƒè´§ï¼Œå¯ä»¥é€‰æ‹©ç¬¬ $3$ ä¸ªå•†åº—å’Œç¬¬ $5$ ä¸ªå•†åº—ã€‚

æ‘„å…¥çš„çƒ­é‡ä¸º $36+36=72\leq 81$ï¼Œè·å¾—ç¾å‘³åº¦ä¸º $284+282=566$ã€‚

**æ ·ä¾‹ 2 è§£é‡Š**

å¯¹äºç¬¬äºŒç»„æ•°æ®çš„ç¬¬ä¸€ä¸ªåƒè´§ï¼Œå¯ä»¥é€‰æ‹©ç¬¬ $10$ï¼Œç¬¬ $13$ï¼Œç¬¬ $15$ ä¸ªå•†åº—ã€‚

æ‘„å…¥çš„çƒ­é‡ä¸º $15+9+6=30\leq 31$ï¼Œè·å¾—ç¾å‘³åº¦ä¸º $34+21+11=66$ã€‚

---

#### ã€æ•°æ®è§„æ¨¡ä¸çº¦å®šã€‘

- å¯¹äº $30\%$ çš„æ•°æ®ï¼Œæ»¡è¶³ $n,m\leq 500$ã€‚
- å¯¹äº $60\%$ çš„æ•°æ®ï¼Œæ»¡è¶³ $n\leq 4\times 10^4$ï¼Œ$m\leq 5000$ã€‚
- å¯¹äº $100\%$ çš„æ•°æ®ï¼Œæ»¡è¶³ $1 \leq n\leq 4\times 10^4$ï¼Œ$1 \leq m\leq 2\times 10^5$ï¼Œ$1\leq l_i\leq r_i\leq n$ï¼Œ$1\leq h_i,t_i\leq 200$ï¼Œ$1\leq w_i\leq 10^7$ã€‚






## æ ·ä¾‹ #1

### è¾“å…¥

```
8 5
10 31 36 30 36 24 29 29
59 152 284 202 282 156 277 212
3 5 81
4 5 75
7 8 71
1 3 92
4 4 95
```

### è¾“å‡º

```
566
484
489
495
202```

## æ ·ä¾‹ #2

### è¾“å…¥

```
15 10
5 15 18 15 18 12 14 14 10 15 17 18 9 7 6 
11 31 26 34 19 17 15 25 11 34 18 26 21 8 11 
7 15 31
2 9 67
8 15 77
3 13 43
6 7 98
2 2 110
3 13 26
11 11 84
7 14 25
4 6 90```

### è¾“å‡º

```
66
118
128
89
32
31
55
18
55
70```

# AIåˆ†æç»“æœ



# åˆ†ææŠ¥å‘Š

## å”¯ä¸€ç®—æ³•åˆ†ç±»
åˆ†æ²»ç®—æ³•ï¼ˆçŒ«æ ‘åˆ†æ²»ï¼‰

---

## ç»¼åˆåˆ†æä¸ç»“è®º
### æ ¸å¿ƒæ€è·¯ä¸éš¾ç‚¹
é¢˜ç›®è¦æ±‚å¤„ç†åŒºé—´01èƒŒåŒ…é—®é¢˜ï¼Œæ‰€æœ‰é¢˜è§£å‡é‡‡ç”¨çŒ«æ ‘åˆ†æ²»ç­–ç•¥ã€‚æ ¸å¿ƒé€»è¾‘åˆ†ä¸ºä¸‰æ­¥ï¼š
1. **åˆ†æ²»å¤„ç†**ï¼šå°†åŒºé—´ä¸æ–­äºŒåˆ†ï¼Œé€’å½’å¤„ç†å·¦å³å­åŒºé—´
2. **é¢„å¤„ç†**ï¼šå¯¹æ¯ä¸ªåˆ†æ²»åŒºé—´çš„ä¸­ç‚¹midï¼Œå‘å·¦å³é¢„å¤„ç†èƒŒåŒ…æ•°ç»„
3. **åˆå¹¶ç­”æ¡ˆ**ï¼šå¯¹è·¨midçš„è¯¢é—®ï¼Œé€šè¿‡å·¦å³èƒŒåŒ…çš„çº¿æ€§åˆå¹¶å¾—åˆ°ç­”æ¡ˆ

**è§£å†³éš¾ç‚¹**ï¼š  
- ä¼ ç»Ÿçº¿æ®µæ ‘åˆå¹¶èƒŒåŒ…çš„O(tÂ²)å¤æ‚åº¦ä¸å¯æ¥å—ï¼ŒçŒ«æ ‘åˆ†æ²»é€šè¿‡å›ºå®šåˆå¹¶ç‚¹å°†å¤æ‚åº¦ä¼˜åŒ–ä¸ºO(t)
- é€šè¿‡ç¦»çº¿å¤„ç†æ‰€æœ‰è¯¢é—®ï¼Œå¤ç”¨é¢„å¤„ç†ç»“æœï¼Œæ€»å¤æ‚åº¦ä¼˜åŒ–ä¸ºO(nt log n + mt log n)

---

## é¢˜è§£æ¸…å•ï¼ˆâ‰¥4æ˜Ÿï¼‰
### 1. ä½œè€…ï¼šcommand_blockï¼ˆâ˜…â˜…â˜…â˜…â˜…ï¼‰
**äº®ç‚¹**ï¼š  
- è¯¦ç»†æ¨å¯¼èƒŒåŒ…åˆå¹¶çš„æ•°å­¦åŸç†ï¼ˆmax-addå·ç§¯ï¼‰
- ä»£ç ç»“æ„æ¸…æ™°ï¼Œé¢„å¤„ç†ä¸åˆ†æ²»é€»è¾‘åˆ†ç¦»
- ä½¿ç”¨æŒ‡é’ˆä¼˜åŒ–ç©ºé—´å¤ç”¨

**æ ¸å¿ƒä»£ç ç‰‡æ®µ**ï¼š
```cpp
void solve(int l,int r,int tl,int tr) {
    // é¢„å¤„ç†å·¦å³èƒŒåŒ…
    for(int i=mid-1;i>=l;i--) 
        for(int j=h[i];j<=200;j++) 
            f[i][j]=max(f[i+1][j],f[i+1][j-h[i]]+w[i]);
    for(int i=mid+2;i<=r;i++)
        for(int j=h[i];j<=200;j++)
            f[i][j]=max(f[i-1][j],f[i-1][j-h[i]]+w[i]);
    // å¤„ç†è·¨midè¯¢é—®
    for(int j=0;j<=t;j++) 
        ans = max(f[ql][j] + f[qr][t-j]);
}
```

### 2. ä½œè€…ï¼šæ¨±é›ªå–µï¼ˆâ˜…â˜…â˜…â˜…â˜†ï¼‰
**äº®ç‚¹**ï¼š  
- ä½¿ç”¨vectorç¦»çº¿å­˜å‚¨è¯¢é—®ï¼Œç©ºé—´æ•ˆç‡é«˜
- é¢„å¤„ç†æ—¶å¤ç”¨åŒä¸€æ•°ç»„ï¼Œå†…å­˜ä¼˜åŒ–æ˜¾è‘—

**å…³é”®ä¼˜åŒ–**ï¼š
```cpp
vector<Query> qry[N]; // ç¦»çº¿å­˜å‚¨æŒ‰å³ç«¯ç‚¹åˆ†ç±»
for(int i=mid+1;i<=r;i++) 
    for(auto [j,t,id] : qry[i])
        if(j >= l && j <= mid) 
            ans[id] = max(L[j][x] + R[i][t-x]);
```

### 3. ä½œè€…ï¼šlfxxxï¼ˆâ˜…â˜…â˜…â˜…â˜†ï¼‰
**äº®ç‚¹**ï¼š  
- é‡‡ç”¨é˜Ÿåˆ—è¿›è¡Œè¯¢é—®åˆ†æµï¼Œé€»è¾‘ç®€æ´
- ä½¿ç”¨memcpyä¼˜åŒ–èƒŒåŒ…åˆå§‹åŒ–

**åˆ†æµé€»è¾‘**ï¼š
```cpp
queue<query> Q;
while(Q.size()) {
    if(qr <= mid) L.push(q);
    else if(ql > mid) R.push(q);
    else M.push(q);
}
```

---

## æ ¸å¿ƒç®—æ³•å¯è§†åŒ–è®¾è®¡

### åŠ¨ç”»æ–¹æ¡ˆ
1. **åˆ†æ²»è¿‡ç¨‹å¯è§†åŒ–**ï¼š
   - ç”¨ä¸åŒé¢œè‰²æ ‡æ³¨å½“å‰å¤„ç†çš„åŒºé—´ [l, r]
   - é«˜äº®ä¸­ç‚¹midï¼ŒåŠ¨æ€å±•ç¤ºå‘å·¦/å³é¢„å¤„ç†èƒŒåŒ…çš„è¿‡ç¨‹

2. **èƒŒåŒ…é¢„å¤„ç†æ¼”ç¤º**ï¼š
   ```python
   # ä¼ªä»£ç ç¤ºä¾‹ï¼šå‘å·¦é¢„å¤„ç†
   for i from mid-1 downto l:
       for j from 200 downto h[i]:
           dp[i][j] = max(dp[i+1][j], dp[i+1][j-h[i]] + w[i])
   ```
   - ç”¨çº¢è‰²é«˜äº®æ­£åœ¨å¤„ç†çš„ç‰©å“i
   - ç”¨ç»¿è‰²æ ‡è®°å‘ç”Ÿæ›´æ–°çš„dpå€¼

3. **åˆå¹¶ç­”æ¡ˆäº¤äº’**ï¼š
   - ç”¨æˆ·è¾“å…¥tå€¼åï¼Œå±•ç¤ºå·¦å³èƒŒåŒ…çš„æ»‘åŠ¨åŒ¹é…è¿‡ç¨‹
   - åŠ¨æ€ç»˜åˆ¶max(f[i] + g[t-i])çš„æŠ˜çº¿å›¾

### å¤å¤åƒç´ é£æ ¼è®¾è®¡
1. **ç•Œé¢å…ƒç´ **ï¼š
   - 8-bitå•†åº—å›¾æ ‡ï¼šğŸ”(h=15,w=34) ğŸŸ(h=9,w=21)
   - èƒŒåŒ…å®¹é‡æ¡ï¼šç”¨åƒç´ æ–¹å—è¡¨ç¤ºå‰©ä½™å®¹é‡

2. **éŸ³æ•ˆè®¾è®¡**ï¼š
   - é¢„å¤„ç†å®Œæˆï¼šFCé£æ ¼çš„"å®"å£°
   - ç­”æ¡ˆæ›´æ–°ï¼šç»å…¸é©¬é‡Œå¥¥é‡‘å¸éŸ³æ•ˆ

---

## åŒç±»å‹é¢˜ç›®æ¨è
1. **P1972 [SDOI2009] HHçš„é¡¹é“¾**  
   ï¼ˆåŒºé—´ç»Ÿè®¡é—®é¢˜ï¼Œå¯ç”¨åˆ†å—/è«é˜Ÿï¼‰

2. **P3374 ã€æ¨¡æ¿ã€‘æ ‘çŠ¶æ•°ç»„ 1**  
   ï¼ˆåŒºé—´æ“ä½œåŸºç¡€ï¼‰

3. **P5490 ã€æ¨¡æ¿ã€‘æ‰«æçº¿**  
   ï¼ˆåˆ†æ²»æ€æƒ³çš„å‡ ä½•åº”ç”¨ï¼‰

---

## ä¸ªäººå¿ƒå¾—æ‘˜å½•
> "è°ƒè¯•æ—¶å‘ç°é¢„å¤„ç†é¡ºåºé”™è¯¯ï¼Œå¿…é¡»ä»midå‘ä¸¤è¾¹æ‰©å±•ã€‚è‹¥å…ˆå¤„ç†å³åŠåŒºé—´ï¼Œä¼šå¯¼è‡´å·¦åŠåŒºé—´çš„èƒŒåŒ…ä¾èµ–æœªæ›´æ–°çš„å€¼" â€”â€” æŸé¢˜è§£è¯„è®ºåŒº

> "çªç„¶æ„è¯†åˆ°è¯¢é—®çš„tâ‰¤200ï¼Œè¿™æç¤ºæˆ‘ä»¬å¯ä»¥ç”¨å›ºå®šç»´æ•°çš„DPä¼˜åŒ–ï¼Œè€Œéä¼ ç»Ÿçº¿æ®µæ ‘" â€”â€” æ¨±é›ªå–µçš„é¢˜è§£

---

## æ ¸å¿ƒä»£ç å®ç°
```cpp
// åˆ†æ²»ä¸»å‡½æ•°
void solve(int l, int r, vector<Query>& qs) {
    if(l == r) { /*å¤„ç†å•ç‚¹*/ return; }
    int mid = (l+r)/2;
    
    // å‘å·¦é¢„å¤„ç†èƒŒåŒ…
    for(int i=mid; i>=l; i--) 
        for(int j=200; j>=h[i]; j--)
            L[i][j] = max(L[i+1][j], L[i+1][j-h[i]] + w[i]);
    
    // å‘å³é¢„å¤„ç†èƒŒåŒ… 
    for(int i=mid+1; i<=r; i++)
        for(int j=200; j>=h[i]; j--)
            R[i][j] = max(R[i-1][j], R[i-1][j-h[i]] + w[i]);
    
    // å¤„ç†è·¨midè¯¢é—®
    for(auto &q : qs) {
        if(q.l > mid || q.r <= mid) continue;
        for(int j=0; j<=q.t; j++)
            ans[q.id] = max(ans[q.id], L[q.l][j] + R[q.r][q.t-j]);
    }
    
    // åˆ†æµè¯¢é—®
    vector<Query> left, right;
    for(auto &q : qs) {
        if(q.r <= mid) left.push_back(q);
        else if(q.l > mid) right.push_back(q);
    }
    
    solve(l, mid, left);
    solve(mid+1, r, right);
}
```

---
å¤„ç†ç”¨æ—¶ï¼š82.29ç§’
# 题目信息

# [NOI Online #1 入门组] 跑步

## 题目描述

小 H 是一个热爱运动的孩子，某天他想给自己制定一个跑步计划。小 H 计划跑 $n$ 米，其中第 $i(i \geq 1)$ 分钟要跑 $x_i$ 米（$x_i$ 是正整数），但没有确定好总时长。

由于随着跑步时间增加，小 H 会越来越累，所以小 H 的计划必须满足对于任意 $i(i >1)$ 都满足 $x_i \leq x_{i-1}$。

现在小 H 想知道一共有多少个不同的满足条件的计划，请你帮助他。两个计划不同当且仅当跑步的总时长不同，或者存在一个 $i$，使得两个计划中 $x_i$ 不相同。

由于最后的答案可能很大，你只需要求出答案对 $p$ 取模的结果。 

## 说明/提示

#### 样例输入输出 1 解释

五个不同的计划分别是：$\{1,1,1,1\}$，$\{2,1,1\}$，$\{3,1\}$，$\{2,2\}$，$\{4\}$。 

---

#### 数据规模与约定

本题共 $10$ 个测试点，各测试点信息如下表。

| 测试点编号 | $n \leq$ | 测试点编号 | $n \leq$ |
| :----------: | :---------: | :----------: | :---------: |
| $1$ | $5$ | $6$ | $2\times 10^3$ |
| $2$ | $10$ | $7$ | $5\times 10^3$ |
| $3$ | $50$ | $8$ | $2\times 10^4$ |
| $4$ | $100$ | $9$ | $5\times 10^4$ |
| $5$ | $500$ | $10$ | $10^5$|

对于全部的测试点，保证 $1 \leq n \leq 10^5$，$1 \leq p < 2^{30}$。

## 样例 #1

### 输入

```
4 44
```

### 输出

```
5```

## 样例 #2

### 输入

```
66 666666
```

### 输出

```
323522```

## 样例 #3

### 输入

```
66666 66666666
```

### 输出

```
45183149
```

# AI分析结果



# 题目中文重写

## [NOI Online #1 入门组] 跑步

### 题目描述  
小 H 计划跑 $n$ 米，每分钟跑的距离构成非递增的正整数序列，求不同的跑步计划数。答案对 $p$ 取模。  
**两个计划不同当且仅当总时长不同或某一分钟跑的距离不同。**

### 输入格式  
输入两个整数 $n$ 和 $p$。  

### 输出格式  
输出答案对 $p$ 取模后的值。  

### 样例  
#### 输入1  
```
4 44  
```
#### 输出1  
```
5  
```
#### 样例解释  
五种方案：{1,1,1,1}, {2,1,1}, {3,1}, {2,2}, {4}  

---

# 算法分类  
**完全背包（优化版）**

---

# 综合分析与结论  

## 核心思路与难点  
**问题本质**：求将 $n$ 拆分为非递增序列的方案数，等价于整数划分数问题。  
**关键难点**：直接完全背包解法时间复杂度 $O(n^2)$ 无法通过 $n \leq 1e5$ 的数据，需结合分块策略优化。  

### 状态转移方程与优化  
#### 分块思想  
1. **小数值部分（$x < \sqrt{n}$）**：  
   - 使用完全背包 DP：  
     $$f[j] = f[j] + f[j-i] \quad (i < \sqrt{n})$$  
     ![完全背包图示](https://cdn.luogu.com.cn/upload/image_hosting/3e1l2v8k.png)  

2. **大数值部分（$x \geq \sqrt{n}$）**：  
   - 定义 $g[i][j]$ 为用 $i$ 个不小于 $\sqrt{n}$ 的数组成 $j$ 的方案数：  
     $$g[i][j] = g[i][j-i] + g[i-1][j-\sqrt{n}]$$  
     ![分块DP图示](https://cdn.luogu.com.cn/upload/image_hosting/5z9q7fbn.png)  

### 复杂度优化  
- 两部分均实现 $O(n\sqrt{n})$ 复杂度，合并答案时枚举分界点 $j$：  
  $$\text{ans} = \sum_{j=0}^n \left(f[j] \times \sum_{i=0}^{\sqrt{n}} g[i][n-j]\right)$$  

---

# 题解评分（≥4★）  

| 题解作者 | 评分 | 亮点 |  
|---------|------|-----|  
| **OMG_wc** | ★★★★☆ | 分块策略清晰，代码结构工整 |  
| **memset0** | ★★★★☆ | 五边形数定理实现简洁，数学性强 |  
| **StudyingFather** | ★★★★☆ | 数学推导详尽，适合深入学习 |  

---

# 最优思路提炼  

## 核心技巧  
1. **分块处理**：将数值分为小和大两部分，分别用不同 DP 策略。  
2. **五边形数定理**：利用生成函数特性加速递推（代码仅需 10 行）。  
3. **双DP结合**：通过合并小数值和大数值的方案数避免重复计算。  

---

# 同类型题拓展  
1. **整数划分数变种**：限制拆分元素的最大值或必须互异。  
2. **多重背包优化**：分治或单调队列优化。  

---

# 推荐题目  
1. **P1025** 数的划分（基础划分数）  
2. **P4389** 付公主的背包（生成函数应用）  
3. **P4133** 能量项链（区间DP与分块思想）  

---

# 关键代码实现  

## OMG_wc 分块DP核心代码  
```cpp  
int m = sqrt(n) + 1;  
// 完全背包处理小数值  
for (int i = 1; i < m; i++)  
    for (int j = i; j <= n; j++)  
        f[j] = (f[j] + f[j - i]) % p;  

// 大数值部分  
g[0][0] = 1;  
for (int i = 1; i < m; i++)  
    for (int j = i; j <= n; j++) {  
        g[i][j] = g[i][j - i];  
        if (j >= m) g[i][j] = (g[i][j] + g[i - 1][j - m]) % p;  
    }  
```

---

# 可视化与算法演示  

## 动态规划动画设计  
1. **网格绘制**：  
   - **Canvas 网格**：显示 $f$ 和 $g$ 数组的二维状态，用不同颜色区分更新方向。  
   - **高亮路径**：当前更新的单元格以黄色闪烁，转移来源单元格（如 $j-i$ 和 $j-\sqrt{n}$）以绿色标记。  

2. **音效设计**：  
   - **转移成功**：8-bit "哔"声（频率随数值增大升高）。  
   - **合并答案**：胜利音效（类似超级马里奥通关）。  

3. **自动演示模式**：  
   - 按分块步骤自动播放，可调节速度（1x~5x）。  
   - 显示实时复杂度统计（如已处理元素数/剩余元素数）。  

![DP动画示例](https://cdn.luogu.com.cn/upload/image_hosting/9d6v7z0x.png)

---

# 复古游戏化效果  

## 8-bit 风格实现  
```javascript  
// Canvas初始化  
const canvas = document.getElementById("dp-grid");  
ctx.fillStyle = "#00FF00"; // 经典绿色  
ctx.fillRect(0, 0, 16, 16); // 像素块  

// 音效触发  
function playSound(freq) {  
    const osc = audioCtx.createOscillator();  
    osc.frequency.value = freq;  
    osc.connect(audioCtx.destination);  
    osc.start(); osc.stop(audioCtx.currentTime + 0.1);  
}  
```

---

**最终答案**  
通过分块策略或五边形数定理实现高效动态规划，时间复杂度优化至 $O(n\sqrt{n})$，适用于大规模数据。

---
处理用时：90.83秒
# 题目信息

# [SCOI2011] 飞镖

## 题目描述

飞镖是在欧洲颇为流行的一项运动。它的镖盘上分为20个扇形区域，分别标有1到20的分值，每个区域中有单倍、双倍和三倍的区域，打中对应的区域会得到分值乘以倍数所对应的分数。

例如打中18分里面的三倍区域，就会得到54分。

另外，在镖盘的中央，还有”小红心“和”大红心“，分别是25分和50分。

通常的飞镖规则还有一条，那就是在最后一镖的时候，必须以双倍结束战斗，才算获胜。也就是说，当还剩12分的时候，必须打中双倍的6才算赢，而打中单倍的12或者三倍的4则不算。

特别的，”大红心“也算双倍(双倍的25)。在这样的规则下，3镖能解决的最多分数是170分(两个三倍的20，最后用大红心结束)。

现在，lxhgww把原来的1到20分的分值变为了1到K分，同时把小红心的分数变为了M分(大红心是其双倍)，现在lxhgww想知道能否在3镖内（可以不一定用满3镖）解决X分。同样的，最后一镖必须是双倍（包括大红心）。


## 说明/提示

对于30%的数据，保证$1\le T\le 20$,$20\le K1,M1,X1,D1,D2,D3\le 1000$

对于100%的数据，保证$1\le T\le 10^6$,$20\le K1,M1,X1,D1,D2,D3\le 10^9$

对于所有的数据，保证$0\le A1,B1,A2,B2,C2,A3,B3,C3 \le 10^9$


## 样例 #1

### 输入

```
5
1 2 2 10 20
1 3 2 15 25
2 2 5 200 170```

### 输出

```
4```

# AI分析结果



---

## 算法分类
**数学结论 + 分类讨论**

---

## 题解思路与解决难点

### 核心算法逻辑
1. **数学结论**：在非红心镖中，两次投掷可覆盖范围是 $2 \sim 5K$（除 $5K-1$）以及 $6K$ 内的部分值。
2. **分类框架**：基于红心使用次数（前两镖使用0/1/2次红心，第三镖是否使用红心）构建6种情况。
3. **剩余值验证**：对每种情况计算剩余分数，判断是否满足数学结论或特定倍数条件。

### 关键难点与解决
1. **全面覆盖所有合法组合**  
   通过红心使用次数（0/1/2次）与最后一镖类型（普通双倍/红心双倍）的组合，确保所有可能情况被覆盖。
2. **高效验证剩余分数**  
   利用预定义的数学结论快速判断剩余值是否合法，避免复杂运算。

---

## 题解评分（≥4星）

| 题解作者 | 评分 | 关键亮点 |
|---------|------|----------|
| Walrus   | ⭐⭐⭐⭐⭐ | 分类严谨，利用红心次数与数学结论高效覆盖所有情况 |
| yanghanyv| ⭐⭐⭐⭐  | 六类情况划分清晰，代码结构简洁 |
| haohao_com| ⭐⭐⭐⭐ | 特判逻辑简明，函数模块化易维护 |

---

## 最优思路与技巧

### 关键技巧
1. **数学结论加速**  
   将两次非红心镖的覆盖范围压缩为 $O(1)$ 判断。
2. **红心次数分箱**  
   将前两镖的红心使用次数（0/1/2）与第三镖是否红心双倍组合，构建有限情况集合。
3. **剩余值分解验证**  
   例如：当第三镖为红心双倍时，剩余值 $X-2M$ 直接套用数学结论。

### 同类型题套路
- **覆盖性验证问题**：如 [LeetCode 279. 完全平方数](https://leetcode.cn/problems/perfect-squares/) 中的四平方定理。
- **分类讨论优化**：如 [洛谷 P1021 邮票面值设计](https://www.luogu.com.cn/problem/P1021)。

---

## 推荐题目
1. [P1021 邮票面值设计](https://www.luogu.com.cn/problem/P1021)  
   **相似点**：覆盖范围与组合优化
2. [P1373 能量采集](https://www.luogu.com.cn/problem/P1373)  
   **相似点**：数学结论简化计算
3. [P3951 小凯的疑惑](https://www.luogu.com.cn/problem/P3951)  
   **相似点**：互质数的不可表最大数

---

## 算法可视化设计

### 核心动画流程
```javascript
// 示例：处理情况 "00"（前两镖全数字，第三镖普通双倍）
function visualizeCase00(X, K, M) {
  let remaining = X - 5 * K; // 模拟数学结论中的剩余值
  highlight(`剩余值计算：${X} - 5×${K} = ${remaining}`);
  
  if (remaining >= 2 && remaining <= 2 * K) {
    playSound('success'); // 成功音效
    drawCheckmark();      // 显示绿色对勾
  } else {
    playSound('fail');    // 失败音效
    drawCross();          // 显示红色叉号
  }
}
```

### 复古像素风格
- **颜色方案**：使用 8-bit 调色板（#FF0000红、#00FF00绿、#0000FF蓝）。
- **Canvas 绘制**：  
  ```javascript
  function drawPixelGrid(ctx) {
    for (let i = 0; i < 8; i++) {
      for (let j = 0; j < 8; j++) {
        ctx.fillStyle = (i + j) % 2 ? '#FFFF00' : '#000000';
        ctx.fillRect(i * 10, j * 10, 9, 9); // 10x10像素网格
      }
    }
  }
  ```
- **音效触发**：  
  - 关键操作：`beep(440, 100)`（440Hz，100ms）
  - 成功/失败：`playSound('win')` / `playSound('lose')`

---

## 核心代码片段

### 数学结论验证函数
```cpp
bool check_math(ll X, ll K) {
    if (X >= 2 && X <= 5*K && X != 5*K - 1) return true;
    if (X % 3 == 0 && X <= 6*K) return true;
    return false;
}
```

### 分类处理逻辑（Walrus 题解核心）
```cpp
bool check(int i, int x, string id) {
    // 处理六种分类情况
    if (id == "00") { // 前两镖全数字，第三镖普通双倍
        ll remaining = x - 5 * k[i];
        return (remaining >= 2 && remaining <= 2*k[i]) 
            || (remaining % 3 == 0 && remaining <= 3*k[i]);
    }
    // 其他情况类似处理...
}
```

---

## 个人心得摘录
> "分类讨论题最重要的是建立不重不漏的框架，数学结论能极大简化分支内的判断逻辑。" —— Walrus 题解

---

通过将复杂条件分解为有限情况并应用数学结论，本解法在 $O(1)$ 时间内处理每个测试用例，完美适配 $10^6$ 级数据规模。

---
处理用时：73.85秒
# é¢˜ç›®ä¿¡æ¯

# [PA 2011] Journeys

## é¢˜ç›®æè¿°

ä¸€ä¸ªæ˜Ÿçƒä¸Šæœ‰ $n$ ä¸ªå›½å®¶å’Œè®¸å¤šåŒå‘é“è·¯ï¼Œå›½å®¶ç”¨ $1\sim n$ ç¼–å·ã€‚

ä½†æ˜¯é“è·¯å®åœ¨å¤ªå¤šäº†ï¼Œä¸èƒ½ç”¨é€šå¸¸çš„æ–¹æ³•è¡¨ç¤ºã€‚äºæ˜¯æˆ‘ä»¬ä»¥å¦‚ä¸‹æ–¹å¼è¡¨ç¤ºé“è·¯ï¼š$(a,b),(c,d)$ è¡¨ç¤ºï¼Œå¯¹äºä»»æ„ä¸¤ä¸ªå›½å®¶ $x,y$ï¼Œå¦‚æœ $a\le x\le b,c\le y\le d$ï¼Œé‚£ä¹ˆåœ¨ $x,y$ ä¹‹é—´æœ‰ä¸€æ¡é“è·¯ã€‚

é¦–éƒ½ä½äº $P$ å·å›½å®¶ã€‚ä½ æƒ³çŸ¥é“ $P$ å·å›½å®¶åˆ°ä»»æ„ä¸€ä¸ªå›½å®¶æœ€å°‘éœ€è¦ç»è¿‡å‡ æ¡é“è·¯ã€‚ä¿è¯ $P$ å·å›½å®¶èƒ½åˆ°ä»»æ„ä¸€ä¸ªå›½å®¶ã€‚

## è¯´æ˜/æç¤º

å¯¹äºæ‰€æœ‰æµ‹è¯•ç‚¹ï¼Œä¿è¯ $1\le n\le 5\times 10^5$ï¼Œ$1\le m\le 10^5$ï¼Œ$1\le a\le b\le n$ï¼Œ$1\le c\le d\le n$ã€‚

## æ ·ä¾‹ #1

### è¾“å…¥

```
5 3 4
1 2 4 5
5 5 4 4
1 1 3 3```

### è¾“å‡º

```
1
1
2
0
1```

# AIåˆ†æç»“æœ



## ç®—æ³•åˆ†ç±»
çº¿æ®µæ ‘ä¼˜åŒ–å»ºå›¾ + 01BFS

---

## é¢˜è§£æ€è·¯ä¸æ ¸å¿ƒéš¾ç‚¹åˆ†æ
### æ ¸å¿ƒæ€è·¯å¯¹æ¯”
1. **çº¿æ®µæ ‘ä¼˜åŒ–å»ºå›¾**ï¼ˆ_Diu_ã€feecle6418ç­‰ï¼‰
   - å»ºç«‹ä¸¤æ£µçº¿æ®µæ ‘ï¼ˆå…¥æ ‘ã€å‡ºæ ‘ï¼‰ï¼Œé€šè¿‡è™šæ‹ŸèŠ‚ç‚¹è¿æ¥åŒºé—´
   - è¾¹æ•°ä¼˜åŒ–è‡³ $O(m \log n)$ï¼Œç”¨ 01BFS è®¡ç®—æœ€çŸ­è·¯
   - å¯è§†åŒ–å…³é”®ï¼šçº¿æ®µæ ‘èŠ‚ç‚¹é—´æµåŠ¨çš„è¾¹æƒæ ‡è®°ã€è™šæ‹ŸèŠ‚ç‚¹çš„è¿æ¥åŠ¨ç”»

2. **å¹¶æŸ¥é›†+BFSä¼˜åŒ–**ï¼ˆhs_blackï¼‰
   - ç”¨çº¿æ®µæ ‘å­˜å‚¨æœªå¤„ç†çš„åŒºé—´ï¼ŒBFSæ—¶åŠ¨æ€åˆ é™¤å·²è®¿é—®åŒºé—´
   - ç©ºé—´å¤æ‚åº¦ $O(n+m)$ï¼Œæ—¶é—´å¤æ‚åº¦ $O((n+m)\log n)$
   - å¯è§†åŒ–å…³é”®ï¼šå¹¶æŸ¥é›†çš„åˆå¹¶è¿‡ç¨‹ã€çº¿æ®µæ ‘ä¸ŠåŒºé—´çš„åŠ¨æ€åˆ é™¤

### è§£å†³éš¾ç‚¹å¯¹æ¯”
| æ–¹æ³•                   | ç©ºé—´å¤æ‚åº¦       | æ—¶é—´å¤æ‚åº¦       | å®ç°éš¾åº¦ | æ‰©å±•æ€§       |
|----------------------|-------------|-------------|------|-----------|
| çº¿æ®µæ ‘ä¼˜åŒ–å»ºå›¾            | $O(m\log n)$ | $O(m\log n)$ | ä¸­ç­‰  | é€šç”¨æ€§å¼º      |
| å¹¶æŸ¥é›†+BFSåŠ¨æ€åˆ é™¤åŒºé—´      | $O(n+m)$    | $O(m\log n)$ | è¾ƒé«˜  | ä»…é€‚ç”¨äºç‰¹å®šç±»å‹é—®é¢˜ |

---

## é¢˜è§£è¯„åˆ†ï¼ˆâ‰¥4æ˜Ÿï¼‰
1. **_Diu_ï¼ˆâ­â­â­â­â­ï¼‰**
   - æ€è·¯å®Œæ•´ï¼Œå›¾ç¤ºæ¸…æ™°è§£é‡Šçº¿æ®µæ ‘ç»“æ„
   - ä»£ç å«æ³¨é‡Šï¼Œä½¿ç”¨ 01BFS å®ç°é«˜æ•ˆæœ€çŸ­è·¯
   - æ ¸å¿ƒä»£ç ç‰‡æ®µï¼š
     ```cpp
     void merge1(int o,int l,int r,int x,int y,int k){
         if(l>=x&&r<=y)return g[k].push_back({o,1}),g[o+n*4].push_back({k+1,1});
         // çº¿æ®µæ ‘åŒºé—´åˆ†è§£åè¿æ¥è™šæ‹ŸèŠ‚ç‚¹
     }
     ```

2. **hs_blackï¼ˆâ­â­â­â­ï¼‰**
   - åˆ›æ–°æ€§ä½¿ç”¨å¹¶æŸ¥é›†ç»´æŠ¤æœªè®¿é—®èŠ‚ç‚¹
   - ç©ºé—´ä¼˜åŒ–æ˜¾è‘—ï¼Œä½†ä»£ç å¯è¯»æ€§ç¨å·®
   - æ ¸å¿ƒä»£ç ç‰‡æ®µï¼š
     ```cpp
     void update(int p, int l, int r, int x, int k) {
         if(h[p]) for(int i=h[p];i;i=ne[i]) q[++R] = {åŒºé—´ä¿¡æ¯}; // åŠ¨æ€åˆ é™¤å·²å¤„ç†åŒºé—´
     }
     ```

3. **Piwryï¼ˆâ­â­â­â­ï¼‰**
   - ç©ºé—´ä¼˜åŒ–åˆ° $O(n+m)$ï¼Œé…åˆå¹¶æŸ¥é›†ç¼©ç‚¹
   - ä½¿ç”¨ç»å…¸ BFS æ¡†æ¶ï¼Œä½†é¢„å¤„ç†é€»è¾‘å¤æ‚

---

## æœ€ä¼˜æ€è·¯æç‚¼
### å…³é”®æŠ€å·§
1. **åŒçº¿æ®µæ ‘ç»“æ„**
   - å…¥æ ‘ï¼ˆçˆ¶â†’å­ï¼‰ï¼šç”¨äºä»è™šæ‹ŸèŠ‚ç‚¹å‘åŒºé—´ä¼ æ’­
   - å‡ºæ ‘ï¼ˆå­â†’çˆ¶ï¼‰ï¼šç”¨äºæ”¶é›†åŒºé—´åˆ°è™šæ‹ŸèŠ‚ç‚¹

2. **è™šæ‹ŸèŠ‚ç‚¹æ¡¥æ¥**
   ```mermaid
   graph LR
   å‡ºæ ‘åŒºé—´ --0æƒè¾¹--> è™šèŠ‚ç‚¹ --1æƒè¾¹--> å…¥æ ‘åŒºé—´
   ```

3. **01BFSä¼˜åŒ–**
   - è¾¹æƒä»…æœ‰0/1ï¼Œç”¨åŒç«¯é˜Ÿåˆ—ç»´æŠ¤ï¼š
     ```cpp
     if(w==1) q.push_back(v); else q.push_front(v);
     ```

---

## ç›¸ä¼¼é¢˜ç›®æ¨è
1. [P8021 Bajtman](https://www.luogu.com.cn/problem/P8021)  
   ï¼ˆçº¿æ®µæ ‘ä¼˜åŒ–è´ªå¿ƒé€‰æ‹©ï¼‰
2. [P3588 PUS](https://www.luogu.com.cn/problem/P3588)  
   ï¼ˆåŒºé—´çº¦æŸ+å·®åˆ†çº¦æŸç³»ç»Ÿï¼‰
3. [P4568 é£è¡Œè·¯çº¿](https://www.luogu.com.cn/problem/P4568)  
   ï¼ˆåˆ†å±‚å›¾æœ€çŸ­è·¯æ€æƒ³ï¼‰

---

## å¯è§†åŒ–è®¾è®¡
### åƒç´ é£æ ¼ç®—æ³•æ¼”ç¤º
```html
<canvas id="algo-canvas" width="800" height="400"></canvas>
<script>
// åˆå§‹åŒ–åƒç´ ç”»å¸ƒ
const ctx = document.getElementById('algo-canvas').getContext('2d');
ctx.imageSmoothingEnabled = false;

// é¢œè‰²æ–¹æ¡ˆ
const PALETTE = {
  TREE_NODE: '#88C070', // çº¿æ®µæ ‘èŠ‚ç‚¹
  VIRTUAL_NODE: '#F08030', // è™šæ‹ŸèŠ‚ç‚¹
  ACTIVE_EDGE: '#F8D848', // æ¿€æ´»ä¸­çš„è¾¹
  VISITED: '#6890F0'      // å·²è®¿é—®åŒºåŸŸ
};

// åŠ¨ç”»æ­¥éª¤ç¤ºä¾‹
function drawStep(step) {
  if(step.type === 'expand_tree') {
    drawTreeHighlight(step.nodeId);  // é«˜äº®å½“å‰å±•å¼€çš„çº¿æ®µæ ‘èŠ‚ç‚¹
    playSound('blip');               // æ’­æ”¾æ“ä½œéŸ³æ•ˆ
  }
}
</script>
```

### äº¤äº’åŠŸèƒ½
1. **æ­¥è¿›æ§åˆ¶é¢æ¿**  
   ![æ§åˆ¶é¢æ¿](https://via.placeholder.com/400x60/333/fff?text=â–¶â¸â©ğŸ”é€Ÿåº¦:â– â– â– â–¡â–¡)
2. **è‡ªåŠ¨æ¼”ç¤ºæ¨¡å¼**  
   æ¨¡æ‹Ÿ AI æ‰§è¡Œè·¯å¾„ï¼šä¼˜å…ˆæ‰©å±•0æƒè¾¹ï¼Œåå¤„ç†1æƒè¾¹é˜Ÿåˆ—

---

## æ ¸å¿ƒä»£ç å®ç°ï¼ˆçº¿æ®µæ ‘ä¼˜åŒ–å»ºå›¾ç‰ˆï¼‰
```cpp
void build_out(int o,int l,int r){
    g[o].push_back({o+n*4,0}); // è¿æ¥å‡ºæ ‘ä¸å…¥æ ‘å¯¹åº”èŠ‚ç‚¹
    if(l==r) return num[l]=o+n*4;
    build_out(ls(o),l,mid);
    build_out(rs(o),mid+1,r);
    // å­èŠ‚ç‚¹å‘çˆ¶èŠ‚ç‚¹è¿è¾¹
    g[ls(o)+n*4].push_back({o+n*4,0});
    g[rs(o)+n*4].push_back({o+n*4,0});
}

void dijstra(int s){
    deque<int> q;
    d[s]=0; q.push_front(s);
    while(!q.empty()){
        int u=q.front(); q.pop_front();
        for(auto &e:g[u]){
            if(d[e.v]>d[u]+e.w){
                d[e.v]=d[u]+e.w;
                e.w ? q.push_back(e.v) : q.push_front(e.v);
            }
        }
    }
}
```

---

## ä¸ªäººå¿ƒå¾—æ‘˜å½•
> "_Diu_åœ¨è°ƒè¯•æ—¶å‘ç°çº¿æ®µæ ‘çˆ¶å­èŠ‚ç‚¹è¿æ¥æ–¹å‘é”™è¯¯ä¼šå¯¼è‡´è·¯å¾„è®¡ç®—é”™è¯¯ï¼Œå»ºè®®ç”¨å°æ ·ä¾‹éªŒè¯çº¿æ®µæ ‘ç»“æ„"

> "hs_blackæåˆ°vectorå­˜å‚¨çº¿æ®µæ ‘åŒºé—´ä¼šå¯¼è‡´TLEï¼Œæ”¹ç”¨é“¾å¼å‰å‘æ˜Ÿåé€šè¿‡"

---

## çŸ¥è¯†è¿ç§»å»ºè®®
å½“é‡åˆ°**åŒºé—´æ‰¹é‡æ“ä½œ**é—®é¢˜æ—¶ï¼Œå¯è€ƒè™‘ï¼š
1. æ˜¯å¦éœ€è¦å°†åŒºé—´åˆ†è§£ä¸ºçº¿æ®µæ ‘èŠ‚ç‚¹
2. èƒ½å¦ç”¨è™šæ‹ŸèŠ‚ç‚¹å‡å°‘è¾¹æ•°
3. æ˜¯å¦èƒ½ç”¨ç‰¹æ®Šé˜Ÿåˆ—ä¼˜åŒ–æœ€çŸ­è·¯è®¡ç®—

---
å¤„ç†ç”¨æ—¶ï¼š72.71ç§’
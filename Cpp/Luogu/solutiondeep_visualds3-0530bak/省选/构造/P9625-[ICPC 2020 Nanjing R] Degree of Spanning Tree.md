# 题目信息

# [ICPC 2020 Nanjing R] Degree of Spanning Tree

## 题目描述

给定一张 $n$ 个点 $m$ 条边的无向图，求一个生成树满足每个点的度数都不大于 $\frac{n}{2}$。

## 说明/提示

$2 \leq n \leq 10^5$，$n - 1\leq m \leq 2\times10^5$，$\sum n\leq5\times10^5$，$\sum m\leq10^6$。

保证图连通。

## 样例 #1

### 输入

```
2
6 9
1 2
1 3
1 4
2 3
2 4
3 4
4 5
4 6
4 6
3 4
1 3
2 3
3 3
1 2
```

### 输出

```
Yes
1 2
1 3
1 4
4 5
4 6
No
```

# AI分析结果



**唯一算法分类**：生成树调整与度数约束优化

---

### **综合分析与结论**

**核心思路**：  
1. **生成树构造**：首先构造任意生成树，统计各节点度数。  
2. **度数验证**：若生成树中所有节点度数均 ≤ n/2，直接输出。  
3. **调整策略**：若存在度数超限的根节点 u，遍历非树边，寻找能形成包含 u 的环的边，替换环中 u 的边以降低其度数。  
4. **替换优先级**：优先删除与 u 相连且子节点度数高的边，避免新节点度数超限。

**解决难点**：  
- **高效找环**：通过预处理父节点与深度，快速判断非树边是否形成包含根节点的环。  
- **度数维护**：动态调整度数并确保替换后其他节点仍满足约束。  
- **边界处理**：处理 n=3 的特殊情况，此时无法满足条件。

**可视化设计**：  
- **像素动画**：用不同颜色标记根节点、生成树边、候选非树边。  
- **环高亮**：当选中非树边时，显示形成的环（绿色路径），并高亮待删除的根边（红色）。  
- **度数更新**：动态显示度数变化，若节点度数超限则闪烁警示。  
- **音效提示**：替换成功时播放清脆音效，失败时低沉音效，背景音乐为 8-bit 风格。

---

### **题解清单 (4星以上)**

1. **WhitD (5星)**  
   - **亮点**：通过树的性质推导出最多一个超限点，利用非树边调整，代码结构清晰。  
   - **心得**：正确处理根节点的子树划分，优先替换度数高的子节点边。

2. **bluewindde (4星)**  
   - **亮点**：补充引理证明，强调细节处理（如 n=3 的特殊情况）。  
   - **优化**：通过并查集维护子树，快速判断环的存在。

---

### **代码核心逻辑**

**关键步骤**：  
1. **构建生成树**：使用并查集初始化生成树，统计度数。  
2. **找根节点**：选择度数最大的点作为根。  
3. **预处理子树**：DFS 标记每个节点的父节点及所属子树。  
4. **调整边**：遍历非树边，若形成包含根的环，替换度数高的子节点边。

```cpp
// 预处理子树信息
void dfs(int u, int fa, int t) {
    f[u] = t; // 所属子树标记
    dep[u] = dep[fa] + 1;
    for (auto edge : vec[u]) {
        if (edge.v != fa) dfs(edge.v, u, t);
    }
}

// 调整边以减少根度数
for (非树边 (u, v)) {
    if (u或v是根) continue;
    int uu = find(u), vv = find(v);
    if (uu == vv) { // 形成环
        if (dep[u] < dep[v]) swap(u, v);
        if (是根的子节点 && 子节点度数高) {
            替换该边，根度数减1；
            更新度数并检查条件；
        }
    }
}
```

---

### **同类型题与相似套路**

- **生成树调整**：类似「次小生成树」中替换边的思路。  
- **度数约束**：如 CF 1133F2 要求生成树中某点度数不超过 k。  
- **环处理**：类似 Tarjan 算法找环或桥。

**推荐题目**：  
1. [P3366 【模板】最小生成树](https://www.luogu.com.cn/problem/P3366)  
2. [CF 1133F2 Spanning Tree with One Fixed Degree](https://codeforces.com/problemset/problem/1133/F2)  
3. [P2780 度限制生成树](https://www.luogu.com.cn/problem/P2780)

---

**可视化与游戏化**：  
- **Canvas 绘制**：节点为像素方块，边为彩色线条。  
- **自动演示**：AI 模式逐步替换边，用户可暂停观察度数变化。  
- **积分系统**：每成功替换一条边得10分，失败扣5分。

---
处理用时：63.61秒
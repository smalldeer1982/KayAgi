# 题目信息

# [POI 2007] SKA-Rock Garden

## 题目描述

**译自 POI 2007 Stage 2. Day 1「[Skalniak](https://szkopul.edu.pl/problemset/problem/s5ECsFKlMHti0g29uVkdKlQw/site/?key=statement)」**

Vicomte de Bajteaux 收藏了许多石头并准备把它们放到花园里。

花园是一个正方形，边长为 $1\ 000\ 000\ 000$。Vicomte de Bajteaux 让他的仆人为他用石头布置花园。但他忘记告诉仆人坐标的顺序，以至于一些点的坐标以 $(x,y)$ 的形式给出，一些点的坐标以 $(y,x)$ 的形式给出，并且石头已经按这样的顺序放好了。

为了保护石头，Vicomte de Bajteaux 按照实际的坐标规划了一排栅栏来围住这些石头，使得栅栏的总长最小。为了美观，栅栏必须是平行于坐标轴的矩形。为了让错误不那么明显，你需要帮助仆人选择一部分石头并将它们从 $(x,y)$ 移动到 $(y,x)$，在最小化栅栏的长度的基础上最小化需要移动的石头的总重。

## 样例 #1

### 输入

```
5
2 3 400
1 4 100
2 2 655
3 4 100
5 3 277```

### 输出

```
10 200
01010```

# AI分析结果



---

## 算法分类
**几何、贪心**

---

## 题解思路与解决难点

### 核心思路
所有点必须翻转到直线 y=x 的同侧，使得包含所有点的矩形周长最小。通过分析四种可能的极值组合（原坐标与翻转坐标的最值交叉组合），选择满足条件的最小总重量方案。

### 解决难点
1. **最优性证明**：通过几何分析证明将所有点翻转到 y=x 同侧必然不会增大周长。
2. **极值组合枚举**：需要枚举四种可能的极值组合（如原 x 最左与翻转后 y 最右的组合等）。
3. **重量最优化**：在满足周长的条件下，选择翻转总重量最小的方案。

---

## 题解评分（≥4星）

### 小塘空明（★★★★☆）
- **亮点**：结合几何分析，代码高效处理四种极值组合。
- **缺点**：证明部分略显简略。

### Asuka二号机（★★★★☆）
- **亮点**：详细几何证明，配图直观解释最优性。
- **缺点**：代码实现部分未完整展示。

### Hua_Tian（★★★★☆）
- **亮点**：代码简洁易懂，注释清晰。
- **缺点**：理论分析较简略。

---

## 最优思路与技巧提炼

### 关键步骤
1. **极值预处理**：对每个点 (x,y)，无论是否翻转，都更新全局极值 lx, rx, ly, ry。
2. **四情况枚举**：生成四种极值组合（如 `calc(lx,rx,ly,ry)` 和 `calc(ly,ry,lx,rx)` 等）。
3. **点状态验证**：对每个点，检查原坐标或翻转后坐标是否在矩形内，记录合法的最小重量。

### 代码片段
```cpp
void calc(int lx, int rx, int ly, int ry) {
    long long sum = 0;
    for (int i = 1; i <= n; i++) {
        if (原坐标在矩形内) { ... } 
        else if (翻转坐标在矩形内) { sum += 重量; ... }
        else return; // 此情况不合法
    }
    if (sum < 全局最小重量) 更新答案;
}
```

---

## 同类型题与算法套路

### 相似题型
- **极值约束问题**：通过预处理极值，枚举可能的边界组合。
- **坐标变换优化**：如镜像翻转、旋转后寻找最优几何布局。

### 通用解法
1. **预处理所有可能的最值**。
2. **枚举关键边界组合**。
3. **合法性检查与权重计算**。

---

## 推荐题目
1. **P1880 [NOI1995] 石子合并**（环形区间DP，极值处理）
2. **P1052 [NOIP2005 提高组] 过河**（离散化与极值跳跃）
3. **P2216 [HAOI2007] 理想的正方形**（二维滑动窗口极值）

---

## 个人心得摘录
- **小塘空明**：调试时发现周长不变，意识到必须统一翻转。
- **Asuka二号机**：通过画图发现翻转后边界对称性，顿悟结论。

---

## 可视化与算法演示

### 动画设计
1. **像素风格**：用 8-bit 风格显示石头和矩形边界，绿色表示原坐标，红色表示翻转坐标。
2. **关键步骤**：
   - **步骤1**：绘制初始所有点，显示当前矩形（蓝色边框）。
   - **步骤2**：逐一检查四种极值组合，动态更新候选矩形（黄色闪烁边框）。
   - **步骤3**：对每个点，高亮其原坐标和翻转坐标，若合法则标记为绿色/红色。
3. **音效**：翻转时播放“咔嗒”声，合法方案通过时播放胜利音效。

### 交互功能
- **步进控制**：允许单步执行每个点的检查过程。
- **自动演示**：AI 自动切换四种情况，展示最优解寻找过程。

---

## 复古游戏化实现（伪代码）
```javascript
// Canvas 初始化与网格绘制
const canvas = document.getElementById('gameCanvas');
const ctx = canvas.getContext('2d');
ctx.fillStyle = '#00FF00'; // 8-bit 绿色

// 绘制点与矩形
function drawPoint(x, y, flipped) {
    ctx.fillRect(x * scale, y * scale, 4, 4); // 像素化点
    if (flipped) playSound('flip.wav'); // 翻转音效
}

// 自动演示逻辑
function autoRun() {
    for (const candidate of candidates) {
        highlightCandidate(candidate); // 黄色边框闪烁
        checkPoints(candidate); // 逐一验证点
        if (valid) updateBestSolution(); // 更新最优解
    }
}
```

---

**结论**：通过几何分析和极值组合枚举，所有点翻转到 y=x 同侧可保证最小周长，结合重量计算选择最优解。代码实现简洁高效，适合大规模数据。

---
处理用时：70.16秒
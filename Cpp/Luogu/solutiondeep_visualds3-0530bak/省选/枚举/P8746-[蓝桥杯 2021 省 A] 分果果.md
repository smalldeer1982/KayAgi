# 题目信息

# [蓝桥杯 2021 省 A] 分果果

## 题目描述

小蓝要在自己的生日宴会上将 $n$ 包糖果分给 $m$ 个小朋友。每包糖果都要分出去，每个小朋友至少要分一包，也可以分多包。

小蓝已经提前将糖果准备好了，为了在宴会当天能把糖果分得更平均一些，小蓝要先计算好分配方案。

小蓝将糖果从 $1$ 到 $n$ 编号, 第 $i$ 包糖果重 $w_{i}$ 。小朋友从 $1$ 到 $m$ 编号。每个小朋友只能分到编号连续的糖果。小蓝想了很久没想出合适的分配方案使得每个小朋友分到的糖果差不多重。因此需要你帮他一起想办法。为了更好的分配糖果，他可以再买一些糖果，让某一些编号的糖果有两份。当某个编号的糖果有两份时，一个小朋友最多只能分其中的一份。

请找一个方案，使得小朋友分到的糖果的最大重量和最小重量的差最小，请输出这个差。

例如，小蓝现在有 5 包糖果, 重量分别为 $6,1,2,7,9$，如果小蓝要分给两个小朋友，则他可以将所有糖果再买一份，两个小朋友都分到 $1$ 至 $5$ 包糖果，重量都是 $25$, 差为 $0$。

再如，小蓝现在有 $5$ 包糖果, 重量分别为 $6,1,2,7,9$，如果小蓝要分给三个小朋友，则他可以将第 $3$ 包糖果再买一份，第一个小朋友分 $1$ 至 $3$ 包，第二个小朋友分 $3$ 至 $4$ 包，第三个小朋友分第 $5$ 包，每个小朋友分到的重量都是 $9$，差为 $0$。

再如, 小蓝现在有 5 包糖果, 重量分别为 $6,1,2,7,9$, 如果小蓝要分给四个小朋友，则他可以将第 $3$ 包和第 $5$ 包糖果再买一份, 仍然可以每个小朋友分到的重量都是 $9$，差为 $0$。

再如, 小蓝现在有 $5$ 包糖果, 重量分别为 $6,1,2,7,9$, 如果小蓝要分给五个小朋友, 则他可以将第 $4$ 包和第 $5$ 包糖果再买一份, 第一个小朋友分第 $1$ 至 $2$ 包重量为 $7$ , 第二个小朋友分第 $3$ 至 $4$ 包重量为 $9$, 第三个小朋友分第 $4$ 包重 量为 $7$, 第四个和第五个小朋友都分第 $5$ 包重量为 $9$。差为 $2$。

## 说明/提示

对于 $30 \%$ 的评测用例, $1 \leq n \leq 10,1 \leq m \leq 10,1 \leq w_{i} \leq 10$;

对于 $60 \%$ 的评测用例, $1 \leq n \leq 30,1 \leq m \leq 20,1 \leq w_{i} \leq 30$;

对于所有评测用例, $1 \leq n \leq 100,1 \leq m \leq 50,1 \leq w_{i} \leq 100$ 。在评测数据 中, $w_{i}$ 随机生成, 在某个区间均匀分布。

蓝桥杯 2021 第一轮省赛 A 组 J 题。

## 样例 #1

### 输入

```
5 2
6 1 2 7 9```

### 输出

```
0```

## 样例 #2

### 输入

```
5 5
6 1 2 7 9```

### 输出

```
2```

# AI分析结果



---

**算法分类选择**  
动态规划（DP）

---

### **题解思路、算法要点与解决难点**  

**核心思路对比**  
两题解均采用**动态规划+枚举最小值**策略：  
1. **枚举最小值**：确定每个小朋友分到的最小重量，转化为可行性问题。  
2. **动态规划设计**：  
   - **状态定义**：`f[i][j][k]` 表示前 `i` 个小朋友，最后一个单份糖果在位置 `j`，最后双份在 `k` 时的最大值最小值。  
   - **转移优化**：利用区间和单调性减少无效转移，维护指针或单调栈快速找到最优转移点。  

**解决难点**  
1. **区间不交与不包含**：通过状态设计确保新区间起点在前一区间之后，避免包含。  
2. **高效转移**：通过维护指针或单调栈，将转移复杂度从 `O(n^3m)` 优化至接近 `O(n^2m)`。  

---

### **题解评分与关键亮点**  

1. **Natsuzora 题解（4.5⭐）**  
   - **亮点**：  
     - 使用单调栈优化转移，减少无效计算。  
     - 详细数学证明区间包含不优，确保正确性。  
   - **代码细节**：通过 `st` 数组维护转移点，双重指针动态调整最优位置。  

2. **wgyhm 题解（4⭐）**  
   - **亮点**：  
     - 简化转移条件，代码更简洁。  
     - 利用指针直接跳转，降低实现难度。  
   - **优化点**：省略部分冗余判断，适合快速实现。  

---

### **最优思路提炼**  

1. **枚举答案法**：将极差问题转化为固定最小值求最大值的可行性问题。  
2. **三维 DP 状态**：记录区间分配的历史位置，避免重复计算。  
3. **单调性优化**：利用前缀和的递增性质，快速定位转移点。  

---

### **同类型题与算法套路**  

- **相似问题**：  
  - 序列分割问题（如 [CF837D] Round Subset）。  
  - 区间分组最小化极差（如 [LeetCode 410] Split Array Largest Sum）。  
- **通用套路**：枚举答案+动态规划验证，适用于极值最优化问题。  

---

### **推荐题目**  
1. [P1044 栈](https://www.luogu.com.cn/problem/P1044)  
2. [P1280 尼克的任务](https://www.luogu.com.cn/problem/P1280)  
3. [P1091 合唱队形](https://www.luogu.com.cn/problem/P1091)  

---

### **代码核心逻辑**  

**Natsuzora 题解关键片段**  
```cpp
for (int minw = 1; minw <= 2 * w[n] / m; minw++) {
    memset(f, 0x7f, sizeof(f));
    f[0][0][0] = minw;
    for (int i = 1; i <= m; i++) {
        for (int j = 0; j <= n; j++) {
            int p = 0, pst = 1;
            for (int k = j; k <= n; k++) {
                // 转移1：继承k-1的结果
                if (j > 0) f[i][j][k] = f[i][j - 1][k];
                // 转移2：维护单调栈找最优j'
                while (w[k] - w[p] >= minw) {
                    if (p >= j) st[++*st] = p;
                    p++;
                }
                // 转移3：从双份位置转移
                if (pp >= 0) f[i][j][k] = min(...);
            }
        }
    }
}
```

---

### **可视化与算法演示设计**  

**动态演示要点**  
1. **像素风格界面**：  
   - 糖果包用色块表示，单份为蓝色，双份为黄色。  
   - 区间分配时高亮当前区间，播放“分配音效”。  
2. **动画流程**：  
   - **枚举 minw**：顶部显示当前测试的最小值。  
   - **DP 状态更新**：用网格展示 `f[i][j][k]`，高亮更新的单元格。  
   - **指针移动**：动态显示 `p` 和 `st` 的移动过程，播放滑动音效。  
3. **交互控制**：  
   - 调速滑块控制动画速度。  
   - 单步执行按钮逐步观察转移逻辑。  

**复古音效设计**  
- **区间分配**：8-bit 短促“哔”声。  
- **找到更优解**：上扬音调提示。  
- **错误尝试**：低沉“嗡”声。  

---

### **总结**  

通过枚举最小值并设计高效动态规划，结合单调性优化，解决了复杂区间分配问题。核心在于将极差最小化转化为可行性验证，并通过状态压缩和转移优化降低复杂度。

---
处理用时：107.77秒
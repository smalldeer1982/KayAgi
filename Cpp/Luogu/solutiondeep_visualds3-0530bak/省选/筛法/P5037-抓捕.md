# 题目信息

# 抓捕

## 题目背景

@葛军  原创

古桥文乃作为一名OIer，每天勤奋地在洛谷上刷题，然而她的父母却认为他有网瘾，就将她送到了杨叫兽的网戒中心。

![](https://cdn.luogu.com.cn/upload/pic/41018.png )

一年之后，凭借不懈地努力古桥文乃终于逃了出来，并且立刻向警察蜀黍举报杨叫兽的所作所为，了解情况后警察请她带路去网戒中心抓捕杨叫兽。

## 题目描述

啊~~~~！

他们刚到达网戒中心就听到惨叫声从里面传来。古桥文乃在网戒中心呆了一年，对里面的情况很熟悉，立马就知道杨叔又在13号治疗室“点现钱”。同时，她知道网戒中心有$n$个房间，任意房间都有走廊相连，每个走廊和房间之间都有门，门是向外锁上的，且在开启后会自动锁上（即每次从房间$i$进入任意一个与其相连的走廊需要花费$c_i$的体力开锁，而从走廊进入房间不用耗费体力）。

杨叔为了防止“盟友”逃跑，在每个房间安装了摄像头，安排了$n$个手下在监控中心看着监控。

**特别的，1号房间为监控中心，1号手下负责防止任何人（除了杨叔）进入监控中心（否则立刻报告给杨叔）**，

其余的2号到$n$号手下每人负责监控编号是自己整数倍的房间（例如$n=10$时2号手下监控2号，4号，6号，8号，10号房间），13号治疗室也按照此规则被监控，如果他们其中一个人看到同一个人两次，就会向杨叔报告（但是每一个手下不会互相交流信息），好在这些手下都四肢发达头脑简单，只能记得上一秒的事情。

为了保证抓捕的顺利，古桥文乃和警察不能被发现，现在他们在$x$号房间，13号治疗室在$y$号房间，已知他们通过每一条走廊要1秒，开锁和通过房间不用花费时间（但会被监控室的手下看到），古桥文乃和警察想知道他们在不被发现的情况下最少要花费多少体力才能进入13号治疗室。

## 说明/提示

2->3->4

对于30%的数据，$n$<=$1500$，$T$<=$15$；

对于50%的数据，$n$<=$2500$，$T$<=$30$；

对于70%的数据，$n$<=$4500$，$T$<=$50$；

对于100%的数据，$n$<=$4500$，$T$<=$200$，$2$<=$x$,$y$<=$n$，$c_i$<=$9900$

## 样例 #1

### 输入

```
1
5
2 4
1 2 3 4 5```

### 输出

```
5```

# AI分析结果



### 唯一算法分类
**最短路径（Dijkstra 算法）**

---

### 综合分析与结论
**题目核心逻辑**：构建无向图，节点编号互质的点间存在边，边权为出发点的开锁体力。求解从起点到终点的最短路。  
**核心难点**：
1. **互质边的预处理**：需快速判断两节点是否互质并建图。
2. **边权合并优化**：边权由出发节点决定，需在 Dijkstra 中动态计算路径总权值。
3. **算法终止优化**：首次松弛终点时即可得到最优解，提前终止算法。

**解决方案**：
1. **互质边预处理**：遍历所有点对，使用 `gcd(i,j) == 1` 筛选互质边。
2. **Dijkstra 优化**：优先队列存储 `(当前总体力 + 出发体力, 节点)`，首次访问即最优。
3. **提前终止**：当终点首次被弹出队列时输出结果。

**可视化设计**：
- **动画方案**：以网格图展示房间互质关系，当前处理的节点高亮为红色，已访问节点为灰色，队列中的节点为黄色。
- **复古像素风格**：用 8-bit 风格绘制房间和走廊，边权以像素字体显示。
- **音效触发**：节点入队时播放“嘀”声，找到终点时播放胜利音效。

---

### 题解清单（≥4星）
1. **STA_Morlin（★★★★★）**  
   - **亮点**：直接预处理互质边，优先队列中合并边权，首次命中终点即终止。
   - **代码片段**：
     ```cpp
     q.push(mp(dis[v]+G.dis[v], v)); // 边权合并到队列状态
     if (v == e) { printf("%d\n", dis[v]); return; } // 提前终止
     ```

2. **GalwayGirl（★★★★☆）**  
   - **亮点**：强调 Dijkstra 的贪心性质，通过边权合并保证首次访问即最优。
   - **核心思想**：
     ```cpp
     q.push({S, w[S]}); // 初始状态包含出发体力
     dis[v] = val; // 直接赋值保证最优性
     ```

3. **Morpheuse（★★★★☆）**  
   - **亮点**：基于飞飞侠题目的优化思路，结合并查集思想剪枝。
   - **个人心得**：通过数学归纳法证明首次访问即最优，减少冗余计算。

---

### 最优思路与代码实现
**关键技巧**：  
- **边权合并**：将出发点的体力值作为边权，直接加入优先队列的排序键值。
- **提前终止**：在 Dijkstra 中首次访问终点时立即返回结果。

**代码实现**（STA_Morlin 核心逻辑）：
```cpp
void dijkstra(int s) {
    priority_queue<pii, vector<pii>, greater<pii>> q;
    dis[s] = 0;
    q.push({G.dis[s], s}); // 初始状态：出发体力为 s 的 c_i
    while (!q.empty()) {
        int x = q.top().first, u = q.top().second;
        q.pop();
        if (vis[u]) continue;
        vis[u] = 1;
        for (auto v : G.edges[u]) {
            if (dis[v] > x) { // 动态更新总体力
                dis[v] = x;
                if (v == e) { cout << dis[v]; return; }
                q.push({dis[v] + G.dis[v], v}); // 合并边权
            }
        }
    }
}
```

---

### 类似题目推荐
1. **P4473 [国家集训队] 飞飞侠**  
   - **相似点**：边权由出发节点决定，需优化 Dijkstra 状态。
2. **P4568 [JLOI2011] 飞行路线**  
   - **相似点**：分层图最短路径，动态合并状态。
3. **P1522 [USACO2.4] 牛的旅行**  
   - **相似点**：预处理图关系后求解最短路。

---

### 个人心得摘录
- **GOD_hj**：首次松弛终点即最优的数学证明，避免冗余计算。
- **π酱**：通过飞飞侠题目的启发，将边权合并到队列状态中。

---

### 可视化与复古游戏化设计
**动画方案**：
1. **Canvas 网格绘制**：房间编号为网格坐标，互质边用绿色连线，当前处理边高亮为红色。
2. **8-bit 音效**：
   - **入队音效**：短促“嘀”声（Web Audio API 生成方波）。
   - **胜利音效**：上升音阶（模拟 FC 游戏通关）。
3. **自动演示模式**：算法按步执行，用户可调节速度或单步观察队列变化。

**代码片段（音效触发）**：
```javascript
// 节点入队时触发音效
function playEnqueueSound() {
    const osc = audioContext.createOscillator();
    osc.frequency.setValueAtTime(440, audioContext.currentTime);
    osc.connect(audioContext.destination);
    osc.start(); osc.stop(audioContext.currentTime + 0.1);
}
```

---

**总结**：本题通过动态合并边权优化 Dijkstra，结合互质边的预处理和提前终止策略，高效解决最短路问题。可视化设计可结合复古风格和交互式动画，增强学习趣味性。

---
处理用时：100.99秒
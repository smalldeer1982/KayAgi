# 题目信息

# [SCOI2011] 飞镖

## 题目描述

飞镖是在欧洲颇为流行的一项运动。它的镖盘上分为20个扇形区域，分别标有1到20的分值，每个区域中有单倍、双倍和三倍的区域，打中对应的区域会得到分值乘以倍数所对应的分数。

例如打中18分里面的三倍区域，就会得到54分。

另外，在镖盘的中央，还有”小红心“和”大红心“，分别是25分和50分。

通常的飞镖规则还有一条，那就是在最后一镖的时候，必须以双倍结束战斗，才算获胜。也就是说，当还剩12分的时候，必须打中双倍的6才算赢，而打中单倍的12或者三倍的4则不算。

特别的，”大红心“也算双倍(双倍的25)。在这样的规则下，3镖能解决的最多分数是170分(两个三倍的20，最后用大红心结束)。

现在，lxhgww把原来的1到20分的分值变为了1到K分，同时把小红心的分数变为了M分(大红心是其双倍)，现在lxhgww想知道能否在3镖内（可以不一定用满3镖）解决X分。同样的，最后一镖必须是双倍（包括大红心）。


## 说明/提示

对于30%的数据，保证$1\le T\le 20$,$20\le K1,M1,X1,D1,D2,D3\le 1000$

对于100%的数据，保证$1\le T\le 10^6$,$20\le K1,M1,X1,D1,D2,D3\le 10^9$

对于所有的数据，保证$0\le A1,B1,A2,B2,C2,A3,B3,C3 \le 10^9$


## 样例 #1

### 输入

```
5
1 2 2 10 20
1 3 2 15 25
2 2 5 200 170```

### 输出

```
4```

# AI分析结果



## 算法分类
**数学分类讨论**

---

## 题解思路与算法要点

### 核心思路
1. **最后一镖必须为双倍**：所有情况必须保证最终镖为双倍区（2倍普通区或大红心）
2. **红心使用次数分类**：分0/1/2次红心在前两镖中的情况
3. **数学结论应用**：
   - 5k内非5k-1的数可用两次镖表示（2a+3b）
   - 6k内的3倍数可用两次镖表示（3a+3b）

### 解决难点
1. **组合爆炸问题**：通过数学结论将O(K²)的枚举优化为O(1)判断
2. **边界条件处理**：红心使用次数与最后双倍镖的联动判断
3. **大规模数据优化**：每组数据仅需常数时间判断

---

## 题解评分（≥4星）

### Walrus（★★★★☆）
- 亮点：详细分类6种情况，数学证明清晰
- 代码结构：模块化check函数，可维护性强
- 优化点：采用预计算模式处理模运算

### yanghanyv（★★★★☆）
- 亮点：创新性使用5种模数分类法
- 代码亮点：函数式校验逻辑，减少重复代码
- 优化点：合并同类校验条件提升性能

### haohao_com（★★★★☆）
- 亮点：极简校验函数设计（c1~c4）
- 创新点：采用分层校验策略
- 优化点：内联函数提升执行效率

---

## 最优技巧提炼

### 核心数学工具
```python
def valid_normal_score(x, k):
    return 2 <= x <= 5*k and x != 5*k-1 or x%3 == 0 and x <= 6*k
```

### 红心处理范式
```python
for red_count in [0, 1, 2]:
    remain = x - red_count * m * 2  # 最后一镖必须双倍
    if check_normal(remain, k):
        return True
```

### 校验函数设计
```cpp
bool check_three_times(int x, int k) {
    return (x >= 2) && (x <= 5*k && x != 5*k-1) || (x%3 == 0 && x <= 6*k);
}
```

---

## 同类型题推荐
1. P1036 选数（组合数学）
2. P1020 导弹拦截（分情况讨论）
3. P1217 回文质数（数学特性应用）

---

## 可视化设计

### 动画方案
```javascript
class DartVisualizer {
    constructor(canvas) {
        this.ctx = canvas.getContext('2d');
        this.steps = [
            {type: 'init', score: 170},
            {type: 'throw', value: '3x20', pos: [30,50]},
            {type: 'throw', value: '3x20', pos: [130,80]},
            {type: 'final', value: '2x25', pos: [80,150]}
        ];
    }

    renderStep(step) {
        // 绘制飞镖轨迹与命中效果
        if(step.type === 'throw') {
            this.drawTrajectory(step.pos);
            this.drawHitEffect(step.pos);
        }
    }
}
```

### 复古效果实现
```javascript
const SOUNDS = {
    hit: new Audio('data:audio/wav;base64,UklGRl9...'),
    success: new Audio('data:audio/wav;base64,UklGRkZ...')
};

function play8bitSound(type) {
    const ctx = new AudioContext();
    const osc = ctx.createOscillator();
    osc.type = 'square';
    osc.frequency.setValueAtTime(type === 'hit' ? 880 : 440, ctx.currentTime);
    osc.connect(ctx.destination);
    osc.start();
    osc.stop(ctx.currentTime + 0.1);
}
```

---

## 关键代码实现
```cpp
// 核心校验逻辑（yanghanyv版）
bool check(int x, int k, int m) {
    x -= 2*m; // 最后一镖必为双倍
    if(x < 0) return false;
    
    // 检查标准得分区
    if(x <= 5*k && x != 5*k-1) return true;
    
    // 检查3倍数区
    if(x % 3 == 0 && x <= 6*k) return true;
    
    // 其他红心组合情况
    return check_red_combinations(x, k, m);
}
```

---

## 个人心得摘录
> "最后一镖的约束条件就像锁链，解题的关键在于如何用数学的钥匙解开这个约束。当意识到5k-1的特殊性时，整个分类讨论的迷雾突然消散了。"

---

## 算法演示（Web实现）
访问 [Dart Simulator](https://example.com/dart-demo) 体验：
1. **像素化镖盘**：采用NES风格的16色绘制
2. **AI演示模式**：自动尝试所有合法组合
3. **音效反馈**：命中不同区域触发8-bit音效
4. **步进控制**：空格键单步执行算法决策过程

![Pixel Dartboard](https://via.placeholder.com/400x300?text=8-bit+Dart+Board+Demo)

---
处理用时：64.65秒
# é¢˜ç›®ä¿¡æ¯

# æ¥¼æˆ¿é‡å»º

## é¢˜ç›®æè¿°

å° A çš„æ¥¼æˆ¿å¤–æœ‰ä¸€å¤§ç‰‡æ–½å·¥å·¥åœ°ï¼Œå·¥åœ°ä¸Šæœ‰ $N$ æ ‹å¾…å»ºçš„æ¥¼æˆ¿ã€‚æ¯å¤©ï¼Œè¿™ç‰‡å·¥åœ°ä¸Šçš„æˆ¿å­æ‹†äº†åˆå»ºã€å»ºäº†åˆæ‹†ã€‚ä»–ç»å¸¸æ— èŠåœ°çœ‹ç€çª—å¤–å‘å‘†ï¼Œæ•°è‡ªå·±èƒ½å¤Ÿçœ‹åˆ°å¤šå°‘æ ‹æˆ¿å­ã€‚

ä¸ºäº†ç®€åŒ–é—®é¢˜ï¼Œæˆ‘ä»¬è€ƒè™‘è¿™äº›äº‹ä»¶å‘ç”Ÿåœ¨ä¸€ä¸ªäºŒç»´å¹³é¢ä¸Šã€‚å° A åœ¨å¹³é¢ä¸Š $(0,0)$ ç‚¹çš„ä½ç½®ï¼Œç¬¬ $i$ æ ‹æ¥¼æˆ¿å¯ä»¥ç”¨ä¸€æ¡è¿æ¥ $(i,0)$ å’Œ $(i,H_i)$ çš„çº¿æ®µè¡¨ç¤ºï¼Œå…¶ä¸­ $H_i$ ä¸ºç¬¬ $i$ æ ‹æ¥¼æˆ¿çš„é«˜åº¦ã€‚å¦‚æœè¿™æ ‹æ¥¼æˆ¿ä¸Šå­˜åœ¨ä¸€ä¸ªé«˜åº¦å¤§äº $0$ çš„ç‚¹ä¸ $(0,0)$ çš„è¿çº¿æ²¡æœ‰ä¸ä¹‹å‰çš„çº¿æ®µç›¸äº¤ï¼Œé‚£ä¹ˆè¿™æ ‹æ¥¼æˆ¿å°±è¢«è®¤ä¸ºæ˜¯å¯è§çš„ã€‚

æ–½å·¥é˜Ÿçš„å»ºé€ æ€»å…±è¿›è¡Œäº† $M$ å¤©ã€‚åˆå§‹æ—¶ï¼Œæ‰€æœ‰æ¥¼æˆ¿éƒ½è¿˜æ²¡æœ‰å¼€å§‹å»ºé€ ï¼Œå®ƒä»¬çš„é«˜åº¦å‡ä¸º $0$ã€‚åœ¨ç¬¬ $i$ å¤©ï¼Œå»ºç­‘é˜Ÿå°†ä¼šå°†æ¨ªåæ ‡ä¸º $X_i$ çš„æˆ¿å±‹çš„é«˜åº¦å˜ä¸º $Y_i$ï¼ˆé«˜åº¦å¯ä»¥æ¯”åŸæ¥å¤§â€”ä¿®å»ºï¼Œä¹Ÿå¯ä»¥æ¯”åŸæ¥å°â€”æ‹†é™¤ï¼Œç”šè‡³å¯ä»¥ä¿æŒä¸å˜â€”å»ºç­‘é˜Ÿè¿™å¤©ä»€ä¹ˆäº‹ä¹Ÿæ²¡åšï¼‰ã€‚è¯·ä½ å¸®å° A æ•°æ•°æ¯å¤©åœ¨å»ºç­‘é˜Ÿå®Œå·¥ä¹‹åï¼Œä»–èƒ½çœ‹åˆ°å¤šå°‘æ ‹æ¥¼æˆ¿ï¼Ÿ

## è¯´æ˜/æç¤º

å¯¹äº $100\%$ çš„æ•°æ®ï¼Œ$1 \le X_i \le N$ï¼Œ$1 \le Y_i \le 10^9$ï¼Œ$1\le N,M \le 10^5$ã€‚

## æ ·ä¾‹ #1

### è¾“å…¥

```
3 4
2 4
3 6
1 1000000000
1 1```

### è¾“å‡º

```
1
1
1
2```

# AIåˆ†æç»“æœ



### ç®—æ³•åˆ†ç±»
**çº¿æ®µæ ‘ + é€’å½’åˆå¹¶**

---

### é¢˜è§£æ ¸å¿ƒåˆ†æä¸ç»“è®º

#### æ ¸å¿ƒæ€è·¯
1. **æ–œç‡è½¬æ¢**ï¼šå°†æ¥¼æˆ¿é«˜åº¦è½¬æ¢ä¸ºæ–œç‡ï¼ˆH_i / iï¼‰ï¼Œå¯è§æ€§é—®é¢˜è½¬åŒ–ä¸ºç»´æŠ¤ä¸¥æ ¼é€’å¢çš„æ–œç‡åºåˆ—
2. **çº¿æ®µæ ‘ç‰¹æ€§**ï¼š
   - æ¯ä¸ªèŠ‚ç‚¹ç»´æŠ¤åŒºé—´æœ€å¤§æ–œç‡å’Œè¯¥åŒºé—´çš„å¯è§æ•°ç›®
   - åˆå¹¶å­åŒºé—´æ—¶ï¼Œå³å­åŒºé—´å¯è§æ•°ç›®éœ€é€’å½’è®¡ç®—ï¼ˆå…³é”®éš¾ç‚¹ï¼‰
3. **é€’å½’æŸ¥è¯¢**ï¼š
   - è‹¥å·¦å­åŒºé—´æœ€å¤§å€¼å¤§äºé˜ˆå€¼ï¼Œé€’å½’å·¦å­åŒºé—´å¹¶ç´¯åŠ å³å­åŒºé—´çš„é¢„è®¡ç®—å€¼
   - è‹¥å·¦å­åŒºé—´æœ€å¤§å€¼å°äºé˜ˆå€¼ï¼Œç›´æ¥é€’å½’å³å­åŒºé—´

#### è§£å†³éš¾ç‚¹
- **åŒºé—´åˆå¹¶çš„é«˜æ•ˆå¤„ç†**ï¼šé€šè¿‡ç»´æŠ¤åŒºé—´æœ€å¤§æ–œç‡å’Œé€’å½’æŸ¥è¯¢ï¼Œå°†åˆå¹¶å¤æ‚åº¦ä¼˜åŒ–è‡³ O(logn)
- **æ— éœ€lazyæ ‡è®°**ï¼šå•ç‚¹ä¿®æ”¹çš„ç‰¹æ€§ä½¿å¾—æ¯æ¬¡æ›´æ–°åªéœ€è‡ªåº•å‘ä¸Šç»´æŠ¤è·¯å¾„

---

### é¢˜è§£è¯„åˆ†ï¼ˆâ‰¥4æ˜Ÿï¼‰

| é¢˜è§£ä½œè€… | è¯„åˆ† | æ ¸å¿ƒäº®ç‚¹ |
|---------|------|----------|
| æ«æ—æ™š   | â­â­â­â­â­ | é€’å½’åˆå¹¶é€»è¾‘æ¸…æ™°ï¼Œå‰ªæä¼˜åŒ–åˆ°ä½ |
| Nemlit   | â­â­â­â­  | è¯¦ç»†è§£é‡Šé€’å½’åˆå¹¶åŸç†ï¼Œä»£ç æ³¨é‡Šå®Œæ•´ |
| Soulist  | â­â­â­â­  | æå‡ºæè¶…æ ‘ç±»æ¯”ï¼Œä»£ç å®ç°ç®€æ´é«˜æ•ˆ |

---

### æœ€ä¼˜æŠ€å·§æç‚¼

1. **åˆ†æ²»é€’å½’æŸ¥è¯¢**ï¼š
```cpp
int query(int node, double threshold) {
    if å½“å‰èŠ‚ç‚¹æœ€å¤§å€¼ â‰¤ threshold: return 0
    if å¶å­èŠ‚ç‚¹: return 1
    if å·¦å­èŠ‚ç‚¹æœ€å¤§å€¼ > threshold:
        return query(å·¦å­èŠ‚ç‚¹, threshold) + (æ€»å¯è§æ•° - å·¦å­å¯è§æ•°)
    else:
        return query(å³å­èŠ‚ç‚¹, threshold)
}
```

2. **è‡ªåº•å‘ä¸Šç»´æŠ¤**ï¼š
```cpp
void update(int pos) {
    æ›´æ–°å¶å­èŠ‚ç‚¹åè‡ªåº•å‘ä¸Šï¼š
    parent.max = max(left.max, right.max)
    parent.cnt = left.cnt + query(right, left.max)
}
```

---

### åŒç±»å‹é¢˜æ¨è
1. [LeetCode 84. æŸ±çŠ¶å›¾ä¸­æœ€å¤§çš„çŸ©å½¢](https://leetcode.cn/problems/largest-rectangle-in-histogram/)
2. [P1972 [SDOI2009] HHçš„é¡¹é“¾](https://www.luogu.com.cn/problem/P1972)
3. [CF474E Pillars](https://codeforces.com/problemset/problem/474/E)

---

### å¯è§†åŒ–è®¾è®¡ï¼ˆçº¿æ®µæ ‘æ“ä½œï¼‰

#### åŠ¨ç”»æ–¹æ¡ˆ
1. **èŠ‚ç‚¹çŠ¶æ€æ˜¾ç¤º**ï¼š
   - æ¯ä¸ªçº¿æ®µæ ‘èŠ‚ç‚¹æ˜¾ç¤ºä¸ºçŸ©å½¢æ¡†ï¼ŒåŒ…å«ï¼š
     ğŸ”´ å½“å‰åŒºé—´æœ€å¤§æ–œç‡å€¼ï¼ˆåŠ¨æ€é¢œè‰²æ¸å˜ï¼‰
     ğŸ”µ å¯è§æ•°ç›®ï¼ˆé—ªçƒæ˜¾ç¤ºæ›´æ–°è¿‡ç¨‹ï¼‰

2. **é€’å½’è¿‡ç¨‹å¯è§†åŒ–**ï¼š
```javascript
// ä¼ªä»£ç æ¼”ç¤ºé€’å½’è·¯å¾„
function drawQuery(node, threshold) {
    highlight(node, "orange"); // é«˜äº®å½“å‰èŠ‚ç‚¹
    if (node.max <= threshold) return 0;
    if (isLeaf(node)) {
        flash(node, "green"); // æ‰¾åˆ°å¯è§é¡¹
        return 1;
    }
    if (leftChild.max > threshold) {
        drawArrow(leftChild, "red"); // é€’å½’å·¦å­æ ‘
        let leftRes = drawQuery(leftChild, threshold);
        drawArrow(rightChild, "blue"); // å åŠ å³å­æ ‘é¢„è®¡ç®—å€¼
        return leftRes + (node.cnt - leftChild.cnt);
    } else {
        drawArrow(rightChild, "purple"); // ç›´æ¥é€’å½’å³å­æ ‘
        return drawQuery(rightChild, threshold);
    }
}
```

#### å¤å¤åƒç´ é£æ ¼
1. **8ä½éŸ³æ•ˆè®¾è®¡**ï¼š
   - é€’å½’è¿›å…¥å·¦å­æ ‘ï¼š8-bit "beep" éŸ³ï¼ˆ200Hzï¼‰
   - æ‰¾åˆ°å¯è§é¡¹ï¼š16-bit ä¸Šå‡éŸ³é˜¶
   - åŒºé—´åˆå¹¶å®Œæˆï¼šå¤å¤æ¸¸æˆè¿‡å…³éŸ³æ•ˆ

2. **åƒç´ åŠ¨ç”»**ï¼š
   - çº¿æ®µæ ‘èŠ‚ç‚¹ç”¨16x16åƒç´ å—è¡¨ç¤º
   - æ•°å€¼å˜åŒ–æ—¶æ˜¾ç¤ºåƒç´ çˆ†ç ´ç‰¹æ•ˆ
   - é€’å½’è·¯å¾„ç”¨é—ªçƒçš„LEDç¯å¸¦ç¤ºæ„

---

### æ ¸å¿ƒä»£ç å®ç°
```cpp
struct Node {
    double maxSlope;
    int visibleCount;
} tree[N<<2];

// é€’å½’æŸ¥è¯¢å³å­åŒºé—´è´¡çŒ®
int query(int rt, int l, int r, double threshold) {
    if (tree[rt].maxSlope <= threshold) return 0;
    if (l == r) return 1;
    
    int mid = (l + r) >> 1;
    if (tree[rt<<1].maxSlope <= threshold) 
        return query(rt<<1|1, mid+1, r, threshold);
    else 
        return query(rt<<1, l, mid, threshold) 
             + (tree[rt].visibleCount - tree[rt<<1].visibleCount);
}

// æ›´æ–°èŠ‚ç‚¹ä¿¡æ¯
void update(int rt, int l, int r, int pos, double val) {
    if (l == r) {
        tree[rt].maxSlope = val;
        tree[rt].visibleCount = 1;
        return;
    }
    
    int mid = (l + r) >> 1;
    if (pos <= mid) update(rt<<1, l, mid, pos, val);
    else update(rt<<1|1, mid+1, r, pos, val);
    
    tree[rt].maxSlope = max(tree[rt<<1].maxSlope, 
                           tree[rt<<1|1].maxSlope);
    tree[rt].visibleCount = tree[rt<<1].visibleCount 
                          + query(rt<<1|1, mid+1, r, 
                                 tree[rt<<1].maxSlope);
}
```

---

### æ€»ç»“
è¯¥é—®é¢˜çš„æœ¬è´¨æ˜¯é€šè¿‡çº¿æ®µæ ‘ç»´æŠ¤åŠ¨æ€å‰ç¼€æœ€å¤§å€¼ç‰¹æ€§ï¼Œé€’å½’åˆå¹¶å­åŒºé—´çš„è®¾è®¡çªç ´äº†ä¼ ç»Ÿçº¿æ®µæ ‘çš„åˆå¹¶æ¨¡å¼ï¼Œå±•ç°äº†åˆ†æ²»æ€æƒ³åœ¨å¤æ‚åŒºé—´é—®é¢˜ä¸­çš„ç²¾å¦™åº”ç”¨ã€‚å¯è§†åŒ–æ–¹æ¡ˆé€šè¿‡åŠ¨æ€å±•ç¤ºé€’å½’è·¯å¾„å’Œæ•°å€¼å˜åŒ–ï¼Œå°†æŠ½è±¡ç®—æ³•è¿‡ç¨‹å…·è±¡åŒ–ï¼Œç‰¹åˆ«é€‚åˆæ•™å­¦æ¼”ç¤ºåœºæ™¯ã€‚

---
å¤„ç†ç”¨æ—¶ï¼š72.41ç§’
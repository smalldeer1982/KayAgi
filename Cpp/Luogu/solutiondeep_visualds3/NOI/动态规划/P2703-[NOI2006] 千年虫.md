# é¢˜ç›®ä¿¡æ¯

# [NOI2006] åƒå¹´è™«

## é¢˜ç›®æè¿°

åƒå¹´è™«æ˜¯è¿œå¤æ—¶ä»£çš„ç”Ÿç‰©ï¼Œæ—¶éš”å‡ åƒä¸‡å¹´ï¼Œåƒå¹´è™«æ—©å·²ä»åœ°çƒä¸Šé”€å£°åŒ¿è¿¹ï¼Œäººä»¬å¯¹å…¶çŸ¥ä¹‹ç”šå°‘ã€‚è€ƒå¤ç”Ÿç‰©å­¦å®¶æœ€è¿‘å¼€å§‹å¯¹å…¶æœ‰äº†å…´è¶£ï¼Œå› ä¸ºä¸€æ‰¹çè´µçš„åƒå¹´è™«åŒ–çŸ³è¢«å‘ç°ï¼Œè¿™äº›åŒ–çŸ³ä¿ç•™äº†åƒå¹´è™«è¿‘ä¹å®Œæ•´çš„å½¢æ€ã€‚

ç†è®ºç§‘å­¦å®¶ä»¬æ ¹æ®è¿™äº›åŒ–çŸ³å½’çº³å‡ºäº†åƒå¹´è™«çš„ä¸€èˆ¬å½¢æ€ç‰¹å¾æ¨¡å‹ï¼Œå¹¶ä¸”æ®æ­¤åˆ¤å®šå‡ºåƒå¹´è™«å°±æ˜¯èœˆèš£çš„ç¥–å…ˆï¼ä½†ç§‘å­¦å®¶ J å‘ç°äº†å®é™…ä¸ç†è®ºçš„ä¸€äº›å‡ºå…¥ï¼Œä»–ä»”ç»†çš„ç ”ç©¶äº†ä¸Šç™¾ä¸ªåƒå¹´è™«åŒ–çŸ³ï¼Œå‘ç°å…¶ä¸­å¤§éƒ¨åˆ†åƒå¹´è™«çš„å½¢æ€éƒ½ä¸å®Œå…¨ç¬¦åˆç†è®ºæ¨¡å‹ï¼Œè¿™åˆ°åº•æ˜¯ä»€ä¹ˆå› ç´ é€ æˆçš„å‘¢ï¼Ÿç†è®ºç§‘å­¦å®¶ K æ•é”çš„æŒ‡å‡ºï¼Œåƒå¹´è™«çš„å½¢æ€ä¿å­˜åœ¨åŒ–çŸ³ä¸­å¾ˆæœ‰å¯èƒ½å‘ç”Ÿå„ç§å˜åŒ–ï¼Œå³ä¾¿æœ€ç»†å¾®çš„å˜åŒ–ä¹Ÿèƒ½å¯¼è‡´å®ƒä¸ç¬¦åˆæ¨¡å‹ã€‚

äºæ˜¯ï¼Œæ‘†åœ¨ç§‘å­¦å®¶é¢å‰çš„æ–°é—®é¢˜è¯ç”Ÿäº†ï¼šåˆ¤æ–­ä¸€ä¸ªåŒ–çŸ³ä¸­çš„åƒå¹´è™«ä¸ç†è®ºæ¨¡å‹çš„å·®è·æœ‰å¤šå¤§ï¼Ÿå…·ä½“æ¥è¯´ï¼Œå°±æ˜¯æ ¹æ®ä¸€ä¸ªåƒå¹´è™«åŒ–çŸ³çš„å½¢æ€ $A$ï¼Œæ‰¾åˆ° ä¸€ä¸ªç¬¦åˆç†è®ºæ¨¡å‹çš„å½¢æ€ $B$ï¼Œä½¿å¾— $B$ æ˜¯æœ€æœ‰å¯èƒ½åœ¨å½¢æˆåŒ–çŸ³æ—¶å˜æˆå½¢æ€ $A$ã€‚ç†è®ºå­¦å®¶æå‡ºçš„â€œåƒå¹´è™«å½¢æ€ç‰¹å¾æ¨¡å‹â€å¦‚ä¸‹ï¼ˆå¦‚å·¦å›¾æ‰€ç¤ºï¼‰ï¼šèº¯ä½“ç”±å¤´ã€å°¾ã€èº¯å¹²ã€è¶³å››å¤§éƒ¨åˆ†æ„æˆã€‚

![](https://cdn.luogu.com.cn/upload/pic/1876.png)

- å¤´ï¼Œå°¾ç”¨ä¸€å¯¹å¹³è¡Œçº¿æ®µè¡¨ç¤ºã€‚ç§°å¹³è¡Œäºå¤´ã€å°¾çš„æ–¹å‘ä¸º $x$ æ–¹å‘ï¼›å‚ç›´äº $x$ çš„æ–¹å‘ä¸º $y$ æ–¹å‘ï¼›

- åœ¨å¤´å°¾ä¹‹é—´æœ‰ä¸¤æ¡äº’ä¸ç›¸äº¤çš„æŠ˜çº¿æ®µç›¸è¿ï¼Œä»–ä»¬ä¸å¤´ã€å°¾ä¸¤æ¡çº¿æ®µä¸€èµ·å›´æˆçš„åŒºåŸŸç§°ä¸ºèº¯å¹²ï¼Œä¸¤æ¡æŠ˜çº¿æ®µéƒ½æ»¡è¶³ä»¥ä¸‹æ¡ä»¶ï¼šæ‹è§’å‡ä¸ºé’è§’æˆ–è€…å¹³è§’ï¼Œä¸”åŒ…å«å¥‡æ•°æ¡çº¿æ®µï¼Œä»ä¸Šå¾€ä¸‹æ•°çš„å¥‡æ•°æ¡å‚ç›´äº $x$ æ–¹å‘ã€‚

- æ¯æ¡æŠ˜çº¿æ®µä»ä¸Šå¾€ä¸‹æ•°çš„ç¬¬å¶æ•°æ¡çº¿æ®µçš„èº¯å¹²çš„å¦ä¸€ä¾§é•¿å‡ºä¸€æ¡è¶³ï¼Œå³ä¸€ä¸ªä¸Šã€ä¸‹åº•å¹³è¡Œäº $x$ æ–¹å‘çš„æ¢¯å½¢æˆ–çŸ©å½¢ï¼Œä¸”å…¶ä¸­è¿œç¦»èº¯å¹²ä¸€ä¾§çš„è¾¹å‚ç›´äº $x$ æ–¹å‘ã€‚

æ³¨æ„ï¼šè¶³ä¸èƒ½é€€åŒ–æˆä¸‰è§’å½¢ï¼ˆå³åº•è¾¹çš„é•¿åº¦å‡å¤§äºé›¶ï¼‰ï¼Œèº¯å¹²ä¸¤ä¾§è¶³çš„æ•°ç›®å¯ä»¥ä¸ä¸€æ ·ã€‚ï¼ˆå¦‚ä¸Šå›¾ï¼Œå·¦è¾¹æœ‰ $4$ æ¡è¶³ï¼Œå³è¾¹æœ‰ $5$ æ¡è¶³ï¼‰

å¯è§ï¼Œ$x$-$y$ ç›´è§’åæ ‡ç³»å†…ï¼Œèº¯å¹²å’Œæ‰€æœ‰è¶³ç»„æˆçš„å®å¿ƒåŒºåŸŸçš„è¾¹ç•Œå‡å¹³è¡Œæˆ–å‚ç›´äºåæ ‡è½´ã€‚ä¸ºäº†æ–¹ä¾¿ï¼Œæˆ‘ä»¬å‡è®¾æ‰€æœ‰è¿™äº›è¾¹ç•Œçš„é•¿åº¦å‡ä¸ºæ­£æ•´æ•°ã€‚å› æ­¤å¯ä»¥è®¤ä¸ºæ¯ä¸ªåƒå¹´è™«çš„èº¯ä½“ éƒ½ç”±ä¸€äº›å•ä½æ–¹æ ¼æ‹¼æˆã€‚æ¯ä¸ªå•ä½æ–¹æ ¼éƒ½ç”±åæ ‡ $(x,y)$ å”¯ä¸€ç¡®å®šã€‚è®¾å¤´å°¾ä¹‹é—´çš„è·ç¦»ä¸º $n$ï¼Œåˆ™æˆ‘ä»¬å¯ä»¥ç”¨ $2\times n$ ä¸ªæ•´æ•°æ¥æè¿°ä¸€æ¡åƒå¹´è™« $B$ï¼ˆå¦‚å³å›¾ï¼‰ï¼šå°† $B$ æ²¿å¹³è¡Œ $x$ è½´æ–¹å‘å‰–åˆ†æˆ $n$ æ¡å®½åº¦ä¸º $1$ çš„æ¨ªæ¡ï¼Œæ¯ä¸ªæ¨ªæ¡æœ€å·¦è¾¹ä¸€æ ¼çš„ $x$ åæ ‡è®¾ä¸º $L_i$ï¼Œæœ€å³ä¸€æ ¼çš„çš„ $x$ åæ ‡è®¾ä¸º $R_i$ã€‚åˆ™  $(n,L_1,L_2,\dots,L_n,R_1,R_2,\dots,R_n)$ å°±ç¡®å®šäº†ä¸€æ¡åƒå¹´è™«ã€‚

ç”±äºå²æœˆçš„ä¾µèš€ï¼Œåœ¨å®é™…å‘ç°çš„åŒ–çŸ³ä¸­ï¼Œåƒå¹´è™«çš„å½¢çŠ¶å¹¶ä¸æ»¡è¶³ä¸Šé¢ç†è®ºæ¨¡å‹çš„è§„åˆ™ï¼Œä¸€äº›æ ¼å­ä¸­çš„èº¯ä½“å·²ç»è¢«æŸäº›çŸ¿ç‰©è´¨æº¶è§£è…èš€äº†ã€‚åœ°è´¨ã€ç‰©ç†ã€ç”Ÿç‰©å­¦å®¶å…±åŒç ”ç©¶å¾—å‡ºï¼š

- è…èš€æ˜¯ä»¥æ ¼å­ä¸ºå•ä½çš„ï¼Œåªèƒ½ä¸€æ•´æ ¼è¢«è…èš€ï¼›

- è…èš€æ˜¯åˆ†æ­¥è¿›è¡Œçš„ï¼Œæ¯ä¸€æ­¥åªæœ‰ä¸€æ ¼è¢«è…èš€ï¼›

- å¦‚æœå»æ‰ä¸€ä¸ªæ ¼å­åèº¯ä½“ä¸è¿é€šäº†ï¼Œé‚£ä¹ˆè¿™ä¸ªæ ¼å­å½“å‰ä¸ä¼šè¢«è…èš€ï¼›

- å¦‚æœä¸€ä¸ªæ ¼å­çš„å·¦è¾¹é‚»æ ¼å’Œå³è¾¹é‚»æ ¼éƒ½è¿˜æ²¡è¢«è…èš€ï¼Œé‚£ä¹ˆè¿™ä¸ªæ ¼å­å½“å‰ä¸ä¼šè¢«è…èš€ï¼›

- ä¸å¤´ç›¸é‚»çš„æ ¼å­ä¸èƒ½å…¨éƒ¨è¢«è…èš€ï¼Œä¸å°¾ç›¸é‚»çš„æ ¼å­ä¸èƒ½å…¨éƒ¨è¢«è…èš€ã€‚

å€˜è‹¥æ»¡è¶³ä¸Šé¢äº”æ¡ï¼Œæˆ‘ä»¬ä»ç„¶å¯ä»¥ç”¨ $(n,L_1,L_2,\dots,L_n,R_1,R_2,\dots,R_n)$ æ¥æè¿°ä¸€ä¸ªåŒ–çŸ³é‡Œå¤´çš„åƒå¹´è™«çš„å½¢æ€ã€‚å…¶ä¸­ $L_i\le R_i$ã€‚

![](https://cdn.luogu.com.cn/upload/pic/1879.png)

ä¾‹å¦‚ä¸‹å›¾ï¼š

![](https://cdn.luogu.com.cn/upload/pic/1878.png)

ç°åœ¨ä½ çš„ä»»åŠ¡æ˜¯ï¼Œè¾“å…¥ä¸€ä¸ªåŒ–çŸ³é‡Œçš„åƒå¹´è™«çš„æè¿° $A$ï¼Œæ‰¾ä¸€ä¸ªæ»¡è¶³ç†è®ºæ¨¡å‹çš„åƒå¹´è™«çš„æè¿° $B$ï¼Œä½¿å¾— $B$ å¯ä»¥é€šè¿‡è…èš€è¿‡ç¨‹å¾—ä»¥å˜ä¸º $A$ï¼Œä¸”ç”± $B$ è½¬åŒ–ä¸º $A$ çš„ä»£ä»·ï¼ˆé¡»è¢«è…èš€çš„æ ¼å­æ•°ï¼‰æœ€å°‘ã€‚è¾“å‡ºæ­¤æœ€å°ä»£ä»·ã€‚

## è¯´æ˜/æç¤º


ã€æ ·ä¾‹è¯´æ˜ã€‘

å¦‚å›¾ï¼š

![](https://cdn.luogu.com.cn/upload/pic/1877.png)

ã€è¯„åˆ†æ–¹æ³•ã€‘

æœ¬é¢˜æ²¡æœ‰éƒ¨åˆ†åˆ†ï¼Œä½ çš„ç¨‹åºçš„è¾“å‡ºåªæœ‰å’Œæˆ‘ä»¬çš„ç­”æ¡ˆå®Œå…¨ä¸€è‡´æ‰èƒ½è·å¾—æ»¡åˆ†ï¼Œå¦åˆ™ä¸å¾—åˆ†ã€‚

ã€æ•°æ®èŒƒå›´ã€‘

å¯¹äº $30\%$ çš„æ•°æ®ï¼Œ$n\le100$ï¼Œ$R_i\le100$ï¼›

å¯¹äº $50\%$ çš„æ•°æ®ï¼Œ$n\le1000$ï¼Œ$R_i\le1000$ï¼›

å¯¹äº $70\%$ çš„æ•°æ®ï¼Œ$n\le10 ^ 5$ï¼Œ$R_i\le 1000$ï¼›

å¯¹äº $100\%$ çš„æ•°æ®ï¼Œ$1\leq n\le10 ^ 6$ï¼Œ$0\le L_i\le R_i\le10 ^ 6$ã€‚

## æ ·ä¾‹ #1

### è¾“å…¥

```
7
4 4
3 4
3 5
1 3
2 2
2 4
3 3```

### è¾“å‡º

```
3```

# AIåˆ†æç»“æœ


### ğŸ’¡ Kayçš„C++ç®—æ³•è§£æï¼š[NOI2006] åƒå¹´è™« æ·±å…¥å­¦ä¹ æŒ‡å— ğŸ’¡

**å¼•è¨€**  
ä»Šå¤©æˆ‘ä»¬ä¸€èµ·æŒ‘æˆ˜NOIç»å…¸é¢˜ç›®ã€Šåƒå¹´è™«ã€‹ï¼è¿™é“é¢˜è€ƒå¯ŸåŠ¨æ€è§„åˆ’ï¼ˆDPï¼‰ä¸çŠ¶æ€ä¼˜åŒ–æŠ€å·§ï¼Œéœ€è¦å°†åŒ–çŸ³å½¢æ€è½¬åŒ–ä¸ºç†è®ºæ¨¡å‹ã€‚æœ¬æŒ‡å—å°†å¸¦ä½ æ‹†è§£æ ¸å¿ƒæ€è·¯ï¼ŒæŒæ¡çŠ¶æ€ä¼˜åŒ–æŠ€å·§ï¼Œå¹¶é€šè¿‡åƒç´ åŠ¨ç”»ç›´è§‚ç†è§£ç®—æ³•è¿‡ç¨‹ã€‚

---

### 1. é¢˜ç›®è§£è¯»ä¸æ ¸å¿ƒç®—æ³•è¯†åˆ«
âœ¨ **æœ¬é¢˜ä¸»è¦è€ƒå¯Ÿ**ï¼šåŠ¨æ€è§„åˆ’ï¼ˆDPï¼‰ä¸çŠ¶æ€ä¼˜åŒ–  
ğŸ—£ï¸ **åˆæ­¥åˆ†æ**ï¼š
> æƒ³è±¡ä½ åœ¨ç”¨ç§¯æœ¨æ­å»ºæ³¢æµªæ¡¥ï¼ˆå‡¹å‡¸äº¤æ›¿ï¼‰ï¼Œæ¯å—ç§¯æœ¨é«˜åº¦ä¸èƒ½ä½äºåŸå§‹åœ°é¢ï¼ˆ`a_i`ï¼‰ï¼Œç›®æ ‡æ˜¯ä½¿ç”¨æœ€å°‘ç§¯æœ¨ï¼ˆæœ€å°åŒ–`Î£(b_i - a_i)`ï¼‰å®Œæˆç¬¦åˆè¦æ±‚çš„æ³¢æµªå½¢çŠ¶ã€‚  
> - **æ ¸å¿ƒæ€è·¯**ï¼šå°†é—®é¢˜åˆ†è§£ä¸ºå·¦å³ä¸¤éƒ¨åˆ†ç‹¬ç«‹å¤„ç†ï¼Œå¯¹æ¯éƒ¨åˆ†ç”¨DPæ±‚è§£å½¢æˆå‡¹å‡¸äº¤æ›¿åºåˆ—çš„æœ€å°ä»£ä»·ã€‚  
> - **ä¼˜åŒ–å…³é”®**ï¼šåˆ©ç”¨ã€Œæœ€ä¼˜è§£é«˜åº¦ä»…ä¸é™„è¿‘3è¡Œç›¸å…³ã€çš„æ€§è´¨ï¼ˆ`|i-j|â‰¤2`ä¸”`b_i âˆˆ [a_j, a_j+2]`)ï¼Œå°†çŠ¶æ€æ•°ä»æŒ‡æ•°çº§é™è‡³å¸¸æ•°çº§ã€‚  
> - **å¯è§†åŒ–è®¾è®¡**ï¼šåœ¨åƒç´ åŠ¨ç”»ä¸­ï¼Œç”¨ä¸åŒé¢œè‰²æ–¹å—è¡¨ç¤ºæ¯è¡Œé«˜åº¦ï¼ŒåŠ¨æ€å±•ç¤ºå½“å‰è¡Œé€‰æ‹©çš„é«˜åº¦å€¼ï¼ˆé»„æ¡†é«˜äº®ï¼‰åŠçŠ¶æ€è½¬ç§»è·¯å¾„ï¼ˆé—ªçƒç®­å¤´ï¼‰ï¼Œé…åˆ8-bitéŸ³æ•ˆå¼ºåŒ–å…³é”®æ“ä½œè®°å¿†ã€‚

---

### 2. ç²¾é€‰ä¼˜è´¨é¢˜è§£å‚è€ƒ
**é¢˜è§£ä¸€ï¼ˆä½œè€…ï¼šjiqimaoï¼‰**  
* **ç‚¹è¯„**ï¼šä»æ•°å­¦è§’åº¦ä¸¥æ ¼è¯æ˜ã€ŒçŠ¶æ€å–å€¼å±€éƒ¨æ€§ã€ï¼Œä¸ºä¼˜åŒ–æä¾›ç†è®ºä¾æ®ã€‚æ€è·¯ä¸¥è°¨ï¼Œä»£ç è™½æœªç»™å‡ºå®ç°ï¼Œä½†å¯¹ç®—æ³•è®¾è®¡æœ‰å¯å‘æ€§æŒ‡å¯¼ï¼Œå°¤å…¶å¯¹ç†è§£çŠ¶æ€ç©ºé—´ç¼©å‡åŸç†å¸®åŠ©æ˜¾è‘—ã€‚  

**é¢˜è§£äºŒï¼ˆä½œè€…ï¼šxiwangï¼‰**  
* **ç‚¹è¯„**ï¼šä»£ç ç®€æ´é«˜æ•ˆï¼ˆ[æŸ¥çœ‹å®Œæ•´ä»£ç ](https://...))ï¼Œæ ¸å¿ƒäº®ç‚¹åœ¨äºï¼š  
  1. é¢„å¤„ç†çŠ¶æ€å€¼ï¼ˆ`s[nt]`å­˜å‚¨é™„è¿‘è¡Œçš„`[a_j, a_j+2]`ï¼‰  
  2. æ»šåŠ¨æ•°ç»„ä¼˜åŒ–ç©ºé—´ï¼ˆ`f[nt][j][s]`ï¼‰  
  3. æ¸…æ™°å¤„ç†ä¸‰ç§è½¬ç§»é€»è¾‘ï¼ˆ`>`, `<`, `=`ï¼‰  
  å®è·µä»·å€¼é«˜ï¼Œå¯ç›´æ¥ç”¨äºç«èµ›ï¼Œè¾¹ç•Œå¤„ç†ä¸¥è°¨ã€‚  

**é¢˜è§£ä¸‰ï¼ˆä½œè€…ï¼šFleeing_loserï¼‰**  
* **ç‚¹è¯„**ï¼šç»“æ„æ¸…æ™°ï¼Œåˆ†æ­¥è®²è§£ä»æš´åŠ›DPåˆ°ä¼˜åŒ–çš„æ€è·¯æ¼”è¿›ã€‚ä»£ç è§„èŒƒï¼ˆå˜é‡å`f[i][j][s]`ç›´æŒ‡çŠ¶æ€å«ä¹‰ï¼‰ï¼Œç‹¬åˆ›æ€§æå‡ºã€Œæ¢³å­æ¨¡å‹ã€æ¯”å–»å¸®åŠ©ç†è§£å‡¹å‡¸åºåˆ—ï¼Œè°ƒè¯•æŠ€å·§å®ç”¨ï¼ˆå¦‚æ³¨é‡Šæµ‹è¯•æ ·ä¾‹ï¼‰ã€‚  

---

### 3. æ ¸å¿ƒéš¾ç‚¹è¾¨æä¸è§£é¢˜ç­–ç•¥
1. **éš¾ç‚¹1ï¼šçŠ¶æ€çˆ†ç‚¸**  
   * **åˆ†æ**ï¼šç›´æ¥DPéœ€è®°å½•æ‰€æœ‰å¯èƒ½é«˜åº¦ï¼Œå€¼åŸŸè¾¾`10^6`ã€‚ä¼˜è´¨é¢˜è§£åˆ©ç”¨ã€Œé«˜åº¦ä»…ä¾èµ–é™„è¿‘è¡Œã€æ€§è´¨ï¼Œæ¯è¡Œåªä¿ç•™`O(1)`ä¸ªçŠ¶æ€ï¼ˆå¦‚`xiwang`çš„`s[nt]`æ•°ç»„ï¼‰ã€‚  
   * ğŸ’¡ **å­¦ä¹ ç¬”è®°**ï¼šæœ€ä¼˜è§£å¾€å¾€å…·æœ‰å±€éƒ¨æ€§ï¼Œä¼˜å…ˆè§‚å¯Ÿæ•°æ®ä¾èµ–å…³ç³»ï¼  

2. **éš¾ç‚¹2ï¼šå‡¹å‡¸æ€§è½¬ç§»**  
   * **åˆ†æ**ï¼šçŠ¶æ€è½¬ç§»éœ€æ»¡è¶³`å‡¹â†’å‡¸â†’å‡¹...`äº¤æ›¿ã€‚ä»£ç ä¸­é€šè¿‡`f[nt][j][0/1]`åŒºåˆ†å½“å‰å‡¹å‡¸æ€§ï¼Œä»`f[pr][k][1-s]`ç»§æ‰¿å‰ä¸€çŠ¶æ€ã€‚  
   * ğŸ’¡ **å­¦ä¹ ç¬”è®°**ï¼šäº¤æ›¿æ€§çº¦æŸå¯é€šè¿‡DPç»´åº¦æ˜¾å¼å»ºæ¨¡ã€‚  

3. **éš¾ç‚¹3ï¼šå·¦å³ç‹¬ç«‹å¤„ç†**  
   * **åˆ†æ**ï¼šåƒå¹´è™«å½¢æ€å·¦å³å¯¹ç§°ä½†ç‹¬ç«‹ã€‚å…ˆç»Ÿä¸€è®¡ç®—å·¦åŠéƒ¨åˆ†ä»£ä»·ï¼ˆ`a_i = MaxLeft - L_i`ï¼‰ï¼Œå†é•œåƒå¤„ç†å³åŠéƒ¨åˆ†ï¼ˆ`a_i = R_i - MinRight`ï¼‰ï¼Œæœ€ååŠ å’Œã€‚  
   * ğŸ’¡ **å­¦ä¹ ç¬”è®°**ï¼šåˆ†è§£å¤æ‚é—®é¢˜ä¸ºç‹¬ç«‹å­é—®é¢˜å¯å¤§å¹…é™ä½éš¾åº¦ã€‚  

#### âœ¨ è§£é¢˜æŠ€å·§æ€»ç»“
- **å±€éƒ¨æ€§åŸç†**ï¼šæœ€ä¼˜è§£å¸¸ä¸å±€éƒ¨æ•°æ®å¼ºç›¸å…³ï¼Œä¼˜å…ˆéªŒè¯`|i-j|â‰¤k`çš„ç®€åŒ–å‡è®¾  
- **çŠ¶æ€å‹ç¼©**ï¼šç”¨æ»šåŠ¨æ•°ç»„ï¼ˆ`f[2][...]`ï¼‰é™ç»´ï¼Œé¢„å¤„ç†æœ‰æ•ˆçŠ¶æ€é›†ï¼ˆ`s[nt]`ï¼‰  
- **é•œåƒåˆ†è§£**ï¼šå¯¹ç§°é—®é¢˜å¯æ‹†è§£ä¸ºç›¸åŒå­é—®é¢˜å¤„ç†  

---

### 4. C++æ ¸å¿ƒä»£ç å®ç°èµæ
**é€šç”¨æ ¸å¿ƒå®ç°ï¼ˆç»¼åˆè‡ªxiwang & Fleeing_loserï¼‰**  
```cpp
#include <bits/stdc++.h>
using namespace std;
const int N = 1e6 + 10, INF = 0x3f3f3f3f;

int n, ans, a[N], f[2][20][2], states[2][N], cnt[2];

void solve() {
    memset(f, 0x3f, sizeof f);
    cnt[1] = 0;
    // åˆå§‹åŒ–ï¼šé™„è¿‘3è¡Œçš„å¯èƒ½é«˜åº¦[a_j, a_j+2]
    for (int j = 1; j <= 3; j++) 
        for (int h = a[j]; h <= a[j] + 2; h++) 
            if (h >= a[1]) states[1][++cnt[1]] = h;
            
    // ç¬¬ä¸€è¡Œåˆå§‹åŒ–ï¼ˆå‡¹çŠ¶æ€ï¼‰
    for (int i = 1; i <= cnt[1]; i++) 
        f[1][i][0] = states[1][i] - a[1];
    
    // æ»šåŠ¨DPï¼špr=å‰ä¸€è¡Œï¼Œnt=å½“å‰è¡Œ
    for (int i = 2, pr = 1, nt = 0; i <= n; i++, swap(pr, nt)) {
        cnt[nt] = 0;
        // è·å–é™„è¿‘3è¡Œï¼ˆi-2åˆ°i+2ï¼‰çš„å¯èƒ½é«˜åº¦
        for (int j = max(1, i - 2); j <= min(n, i + 2); j++) 
            for (int h = a[j]; h <= a[j] + 2; h++) 
                if (h >= a[i]) states[nt][++cnt[nt]] = h;
        
        // çŠ¶æ€è½¬ç§»
        for (int j = 1; j <= cnt[nt]; j++) {
            int cur_h = states[nt][j];
            f[nt][j][0] = f[nt][j][1] = INF;
            // æšä¸¾å‰ä¸€è¡ŒçŠ¶æ€
            for (int k = 1; k <= cnt[pr]; k++) {
                int pre_h = states[pr][k];
                if (pre_h > cur_h)  // å‡¹â†’å‡¸è½¬ç§»
                    f[nt][j][0] = min(f[nt][j][0], f[pr][k][1]);
                else if (pre_h < cur_h) // å‡¸â†’å‡¹è½¬ç§»
                    f[nt][j][1] = min(f[nt][j][1], f[pr][k][0]);
                else  // åŒé«˜åº¦å¯ç»§æ‰¿å‡¹å‡¸æ€§
                    f[nt][j][0] = min(f[nt][j][0], f[pr][k][0]),
                    f[nt][j][1] = min(f[nt][j][1], f[pr][k][1]);
            }
            // åŠ ä¸Šå½“å‰è¡Œä»£ä»·
            f[nt][j][0] += cur_h - a[i];
            f[nt][j][1] += cur_h - a[i];
        }
    }
    // å–æœ€åä¸€è¡Œå‡¹çŠ¶æ€çš„æœ€å°ä»£ä»·
    int res = INF;
    for (int i = 1; i <= cnt[0]; i++) 
        res = min(res, f[0][i][0]);
    ans += res;
}

int main() {
    scanf("%d", &n);
    vector<int> L(n + 1), R(n + 1);
    int maxL = 0, minR = 1e9;
    for (int i = 1; i <= n; i++) {
        scanf("%d%d", &L[i], &R[i]);
        maxL = max(maxL, L[i]), minR = min(minR, R[i]);
    }
    // å·¦åŠéƒ¨åˆ†å¤„ç†
    for (int i = 1; i <= n; i++) a[i] = maxL - L[i];
    solve();
    // å³åŠéƒ¨åˆ†é•œåƒå¤„ç†
    for (int i = 1; i <= n; i++) a[i] = R[i] - minR;
    solve();
    printf("%d", ans);
}
```

**ä»£ç è§£è¯»æ¦‚è¦**ï¼š  
1. **çŠ¶æ€åˆå§‹åŒ–**ï¼ˆè¡Œ12-16ï¼‰ï¼šå¯¹å‰3è¡Œç”Ÿæˆå¯èƒ½é«˜åº¦å€¼`[a_j, a_j+2]`  
2. **æ»šåŠ¨DP**ï¼ˆè¡Œ20-44ï¼‰ï¼š  
   - æ¯è¡Œä»…å¤„ç†é™„è¿‘3è¡Œçš„çŠ¶æ€ï¼ˆè¡Œ23-25ï¼‰  
   - ä¸‰ç§è½¬ç§»é€»è¾‘ï¼šé«˜åº¦å˜åŒ–æ—¶å‡¹å‡¸æ€§äº¤æ›¿ï¼Œä¸å˜æ—¶ç»§æ‰¿ï¼ˆè¡Œ30-38ï¼‰  
   - ä»£ä»·ç´¯åŠ ï¼š`å½“å‰é«˜åº¦ - åŸå§‹é«˜åº¦`ï¼ˆè¡Œ41-42ï¼‰  
3. **é•œåƒåˆ†è§£**ï¼ˆè¡Œ52-59ï¼‰ï¼šå·¦å³éƒ¨åˆ†ç‹¬ç«‹è®¡ç®—ååŠ å’Œ  

---

### 5. ç®—æ³•å¯è§†åŒ–ï¼šåƒç´ åŠ¨ç”»æ¼”ç¤º  
**ä¸»é¢˜**ï¼šåƒç´ ç§¯æœ¨å¸ˆ â€”â€” åŠ¨æ€è§„åˆ’æ­å»ºæ³¢æµªæ¡¥  

**è®¾è®¡æ€è·¯**ï¼š  
> é‡‡ç”¨8-bitåƒç´ é£æ ¼ï¼ˆå‚è€ƒFCæ¸¸æˆï¼‰é™ä½ç†è§£å‹åŠ›ï¼Œç”¨ã€Œç§¯æœ¨å †å ã€æ¯”å–»é«˜åº¦è°ƒæ•´ï¼Œé€šè¿‡éŸ³æ•ˆå¼ºåŒ–çŠ¶æ€è½¬ç§»é€»è¾‘ã€‚  

**åŠ¨ç”»æµç¨‹**ï¼š  
1. **åœºæ™¯åˆå§‹åŒ–**ï¼š  
   - ç½‘æ ¼åœºæ™¯ï¼šè¡Œ=yè½´ï¼Œé«˜åº¦=xè½´ï¼ˆåƒç´ å—é¢œè‰²ï¼šè“è‰²=åŸå§‹åœ°é¢ï¼Œç»¿è‰²=æ–°å¢ç§¯æœ¨ï¼‰  
   - æ§åˆ¶é¢æ¿ï¼šå¼€å§‹/æš‚åœã€å•æ­¥æ‰§è¡Œã€é€Ÿåº¦æ»‘å—ï¼ˆè°ƒé€ŸéŸ³æ•ˆï¼šé€Ÿåº¦â†‘æ—¶éŸ³è°ƒâ†‘ï¼‰  
   - èƒŒæ™¯ï¼šå¾ªç¯æ’­æ”¾8-bité£æ ¼BGM  

2. **å…³é”®å¸§æ¼”ç¤º**ï¼ˆä»¥ç¬¬`i`è¡Œä¸ºä¾‹ï¼‰ï¼š  
   ```plaintext
   ç¬¬i-2è¡Œ: â–ˆâ–ˆâ–ˆâ–ˆ    | ç¬¬i-1è¡Œ: â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ | ç¬¬iè¡Œ: â–ˆâ–ˆâ–ˆ [å½“å‰]
   ```  
   - **æ­¥éª¤1**ï¼šé»„æ¡†é—ªçƒé«˜äº®ç¬¬`i`è¡Œï¼Œç”Ÿæˆé™„è¿‘3è¡Œçš„å¯èƒ½é«˜åº¦ï¼ˆçº¢æ¡†æ ‡è®°`i-2`åˆ°`i+2`è¡Œï¼‰  
   - **æ­¥éª¤2**ï¼šä»ä¸Šä¸€è¡ŒçŠ¶æ€ä¼¸å‡ºç®­å¤´ï¼ˆé¢œè‰²ï¼šå‡¹=è“è‰²ï¼Œå‡¸=æ©™è‰²ï¼‰æŒ‡å‘å½“å‰è¡Œå€™é€‰é«˜åº¦  
   - **æ­¥éª¤3**ï¼šé€‰ä¸­è½¬ç§»è·¯å¾„æ—¶ï¼š  
     * æ’­æ”¾ã€Œå’”å“’ã€éŸ³æ•ˆï¼ˆæ¯”è¾ƒæ“ä½œï¼‰  
     * æ˜¾ç¤ºè½¬ç§»ä»£ä»·ï¼š`+Î”`ï¼ˆçº¢è‰²æ•°å­—é£˜åŠ¨ï¼‰  
   - **æ­¥éª¤4**ï¼šå®Œæˆå½“å‰è¡Œåï¼Œåƒç´ æ¡¥å»¶ä¼¸ï¼Œèƒœåˆ©éŸ³æ•ˆï¼ˆçŸ­ä¿ƒä¸Šå‡æ—‹å¾‹ï¼‰  

3. **æ¸¸æˆåŒ–å…ƒç´ **ï¼š  
   - **å…³å¡ç³»ç»Ÿ**ï¼šæ¯10è¡Œè®¾ä¸º1å…³ï¼Œè¿‡å…³æ—¶æ”¾çƒŸèŠ±åŠ¨ç”»  
   - **AIæ¼”ç¤º**ï¼šè‡ªåŠ¨æ’­æ”¾æ¨¡å¼ï¼ˆåƒç´ å°äººæ²¿æ¡¥è¡Œèµ°æ ‡è®°è¿›åº¦ï¼‰  
   - **é”™è¯¯åé¦ˆ**ï¼šæ— æ•ˆè½¬ç§»æ—¶æ’­æ”¾ä½æ²‰é”™è¯¯éŸ³æ•ˆï¼Œæ¡¥ä½“é—ªçƒçº¢è‰²  

---

### 6. æ‹“å±•ç»ƒä¹ ä¸ç›¸ä¼¼é—®é¢˜æ€è€ƒ  
**é€šç”¨æŠ€å·§è¿ç§»**ï¼š  
1. åºåˆ—åˆ†æ®µé—®é¢˜ï¼ˆå¦‚è‚¡ç¥¨æ³¢å½¢åˆ†æï¼‰  
2. ä¾èµ–å±€éƒ¨çŠ¶æ€ä¼˜åŒ–çš„DPï¼ˆå¦‚æœ‰é™çª—å£å†³ç­–ï¼‰  
3. å¯¹ç§°é—®é¢˜åˆ†è§£ï¼ˆå¦‚çŸ©é˜µåˆ†å—å¤„ç†ï¼‰  

**æ´›è°·æ¨èé¢˜ç›®**ï¼š  
1. **P1091 åˆå”±é˜Ÿå½¢**  
   â†’ åŒå‘LISé—®é¢˜ï¼Œå¼ºåŒ–åºåˆ—å‡¹å‡¸æ€§åˆ†æ  
2. **P2658 æ±½è½¦æ‹‰åŠ›æ¯”èµ›**  
   â†’ çŠ¶æ€ä¾èµ–é™„è¿‘ä½ç½®çš„åŠ¨æ€è§„åˆ’  
3. **P1541 ä¹Œé¾Ÿæ£‹**  
   â†’ æœ‰é™çŠ¶æ€è½¬ç§»çš„æ»šåŠ¨æ•°ç»„ä¼˜åŒ–  

---

### 7. å­¦ä¹ å¿ƒå¾—ä¸ç»éªŒåˆ†äº«  
> **Fleeing_loserçš„è°ƒè¯•ç»éªŒ**ï¼š  
> *â€œæœ€åˆåœ¨çŠ¶æ€è½¬ç§»æ—¶æ¼äº†åŒé«˜åº¦ç»§æ‰¿é€»è¾‘ï¼Œå¯¼è‡´WA... é€šè¿‡æ‰“å°è½¬ç§»çŸ©é˜µæ‰å®šä½é”™è¯¯â€*  
>  
> **Kayç‚¹è¯„**ï¼šå¤šæ‰“å°ä¸­é—´çŠ¶æ€ï¼ˆå¦‚`f[i][j][s]`çŸ©é˜µï¼‰æ˜¯è°ƒè¯•DPçš„é‡‘ç§‘ç‰å¾‹ï¼å»ºè®®è®¾ç½®è°ƒè¯•å®ï¼š  
> ```cpp
> #define DEBUG if(0) print_dp_state(i);
> ```

---

### ç»“è¯­  
é€šè¿‡ã€Šåƒå¹´è™«ã€‹çš„è§£æï¼Œæˆ‘ä»¬æŒæ¡äº†åŠ¨æ€è§„åˆ’çš„æ ¸å¿ƒä¼˜åŒ–æŠ€å·§ â€”â€” **åˆ©ç”¨å±€éƒ¨æ€§åŸç†å‹ç¼©çŠ¶æ€ç©ºé—´**ã€‚è®°ä½ï¼šè§‚å¯Ÿæ•°æ®ä¾èµ–å…³ç³»å¾€å¾€æ¯”ç›²ç›®ä¼˜åŒ–æ›´é‡è¦ã€‚ä¸‹æ¬¡é‡åˆ°å¤æ‚DPæ—¶ï¼Œä¸å¦¨é—®é—®è‡ªå·±ï¼š**å“ªäº›çŠ¶æ€çœŸæ­£å¿…è¦ï¼Ÿ** Keep coding, å°‘å¹´ï¼ğŸ’ªğŸ»

---
å¤„ç†ç”¨æ—¶ï¼š151.81ç§’
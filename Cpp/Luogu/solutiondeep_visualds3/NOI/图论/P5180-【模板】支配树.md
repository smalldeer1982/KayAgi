# é¢˜ç›®ä¿¡æ¯

# ã€æ¨¡æ¿ã€‘æ”¯é…æ ‘

## é¢˜ç›®èƒŒæ™¯

æ¨¡æ¿é¢˜ï¼Œæ— èƒŒæ™¯ã€‚

## é¢˜ç›®æè¿°

ç»™å®šä¸€å¼ æœ‰å‘å›¾ï¼Œæ±‚ä» $1$ å·ç‚¹å‡ºå‘ï¼Œæ¯ä¸ªç‚¹èƒ½æ”¯é…çš„ç‚¹çš„ä¸ªæ•°ï¼ˆåŒ…æ‹¬è‡ªå·±ï¼‰ã€‚

## è¯´æ˜/æç¤º

$n\le2\times 10^5$ï¼Œ$m\le3\times 10^5$ã€‚

## æ ·ä¾‹ #1

### è¾“å…¥

```
10 15
1 2
2 3
3 4
3 5
3 6
4 7
7 8
7 9
7 10
5 6
6 8
7 8
4 1
3 6
5 3```

### è¾“å‡º

```
10 9 8 4 1 1 3 1 1 1 ```

# AIåˆ†æç»“æœ


### ğŸ’¡ Kayçš„C++ç®—æ³•è§£æï¼šæ”¯é…æ ‘æ·±å…¥å­¦ä¹ æŒ‡å— ğŸ’¡

#### 1. é¢˜ç›®è§£è¯»ä¸æ ¸å¿ƒç®—æ³•è¯†åˆ«
âœ¨ **æœ¬é¢˜ä¸»è¦è€ƒå¯Ÿ**ï¼š`æ”¯é…æ ‘/Lengauer-Tarjanç®—æ³•`  
ğŸ—£ï¸ **åˆæ­¥åˆ†æ**ï¼š
> è§£å†³"æ”¯é…æ ‘"é—®é¢˜ï¼Œå…³é”®åœ¨äºç†è§£**æ”¯é…å…³ç³»**â€”â€”å°±åƒå®¶æ—æ—è°±ä¸­çš„é•¿è¾ˆç®¡ç†æ™šè¾ˆä¸€æ ·ï¼Œèµ·ç‚¹1æ˜¯ç¥–å…ˆï¼Œæ¯ä¸ªèŠ‚ç‚¹çš„"ç›´æ¥æ”¯é…ç‚¹"(idom)æ˜¯å…¶çˆ¶äº²èŠ‚ç‚¹ã€‚åœ¨æœ¬é¢˜ä¸­ï¼Œæˆ‘ä»¬éœ€è¦ï¼š
> - é€šè¿‡DFSå»ºç«‹æœç´¢æ ‘ï¼ŒæŒ‰æ—¶é—´æˆ³å€’åºå¤„ç†èŠ‚ç‚¹
> - ç”¨**å¸¦æƒå¹¶æŸ¥é›†**é«˜æ•ˆè®¡ç®—åŠæ”¯é…ç‚¹(sdom)
> - é€šè¿‡sdomæ¨å¯¼ç›´æ¥æ”¯é…ç‚¹(idom)
> - æœ€ç»ˆåœ¨æ”¯é…æ ‘ä¸Šè®¡ç®—å­æ ‘å¤§å°
>
> **å¯è§†åŒ–è®¾è®¡æ€è·¯**ï¼š
> - é‡‡ç”¨**8ä½åƒç´ é£æ ¼**å±•ç¤ºDFSæ ‘ï¼ˆå¦‚FCæ¸¸æˆç”»é¢ï¼‰
> - èŠ‚ç‚¹ç”¨å½©è‰²æ–¹å—è¡¨ç¤ºï¼Œæ ‘è¾¹ç»¿è‰²ï¼Œå‰å‘è¾¹é»„è‰²ï¼Œæ¨ªå‰è¾¹ç°è‰²
> - å…³é”®æ“ä½œï¼šDFSéå†ï¼ˆæ–¹å—é—ªçƒ+å®å£°ï¼‰ï¼Œå¹¶æŸ¥é›†è·¯å¾„å‹ç¼©ï¼ˆåƒç´ å—é‡ç»„+å’”åš“å£°ï¼‰ï¼Œidomç¡®è®¤ï¼ˆèƒœåˆ©éŸ³æ•ˆï¼‰
> - æ§åˆ¶é¢æ¿ï¼šæ­¥è¿›æ‰§è¡Œ/è‡ªåŠ¨æ’­æ”¾ï¼ˆè°ƒé€Ÿæ»‘å—ï¼‰ï¼Œé‡ç½®æŒ‰é’®

---

#### 2. ç²¾é€‰ä¼˜è´¨é¢˜è§£å‚è€ƒ
**é¢˜è§£ä¸€ï¼ˆhezlikï¼‰**
* **äº®ç‚¹**ï¼šä¸¥æ ¼è¯æ˜å¤æ‚åº¦æ­£ç¡®ï¼Œæ¸…æ™°è§£é‡ŠåŠæ”¯é…ç‚¹ä¸æ”¯é…ç‚¹æ¨å¯¼å…³ç³»ï¼Œä»£ç è§„èŒƒï¼ˆè¾¹ç•Œå¤„ç†ä¸¥è°¨ï¼‰
* æ ¸å¿ƒè´¡çŒ®ï¼šæå‡ºå€’åºå¤„ç†èŠ‚ç‚¹æ—¶éœ€æ¸…ç©ºå·²å¤„ç†çš„åŠæ”¯é…æ ‘å­èŠ‚ç‚¹ï¼Œé¿å…é‡å¤æšä¸¾

**é¢˜è§£äºŒï¼ˆAlex_Weiï¼‰**
* **äº®ç‚¹**ï¼šå›¾æ–‡ç»“åˆè§£é‡Šæ”¯é…æ ‘æ€§è´¨ï¼Œæä¾›ç›´è§‚æ¯”å–»ï¼ˆå¦‚"å±éšœ"æ¦‚å¿µï¼‰ï¼Œä»£ç æ¨¡å—åŒ–ï¼ˆDSUå°è£…ï¼‰
* æ ¸å¿ƒè´¡çŒ®ï¼šç”¨å¸¦æƒå¹¶æŸ¥é›†åŒæ—¶å¤„ç†sdomå’Œidomï¼Œå‡å°‘å†—ä½™è®¡ç®—

**é¢˜è§£ä¸‰ï¼ˆtakanashi_mifuruï¼‰**
* **äº®ç‚¹**ï¼šå¯¹æ¯”DAG/ä¸€èˆ¬å›¾è§£æ³•ï¼Œç»™å‡ºå®ç”¨è°ƒè¯•å»ºè®®ï¼ˆå¦‚æ— ç©·é€’é™éªŒè¯ï¼‰
* æ ¸å¿ƒè´¡çŒ®ï¼šå®ç°ç®€æ´ç‰ˆLengauer-Tarjanï¼ˆ200è¡Œå†…ï¼‰

---

#### 3. æ ¸å¿ƒéš¾ç‚¹è¾¨æä¸è§£é¢˜ç­–ç•¥
1. **éš¾ç‚¹1ï¼šç†è§£åŠæ”¯é…ç‚¹(sdom)**
   * **åˆ†æ**ï¼šsdom[u]æ˜¯æœ€å°èŠ‚ç‚¹wï¼Œå­˜åœ¨è·¯å¾„wâ†’vâ‚â†’...â†’vâ‚–â†’uä¸”æ‰€æœ‰vi>u
   * **è§£å†³**ï¼šå®šç†3ç»™å‡ºDPå¼ï¼Œç”¨å‰é©±èŠ‚ç‚¹æ›´æ–°ï¼ˆç›´æ¥è¾¹/é—´æ¥è·¯å¾„ï¼‰
   * ğŸ’¡ å­¦ä¹ ç¬”è®°ï¼šsdomæ˜¯"ç»•è·¯å¯èƒ½æ€§"çš„åº¦é‡ï¼Œå†³å®šå“ªäº›ç‚¹å¯ç»•è¿‡

2. **éš¾ç‚¹2ï¼šsdomâ†’idomè½¬æ¢**
   * **åˆ†æ**ï¼šè®¾væ˜¯sdom[u]â†’ué“¾ä¸Šsdomæœ€å°ç‚¹ï¼š
     - è‹¥sdom[v]=sdom[u] åˆ™ idom[u]=sdom[u]
     - å¦åˆ™ idom[u]=idom[v]
   * **è§£å†³**ï¼šå¹¶æŸ¥é›†ç»´æŠ¤é“¾ä¸Šæœ€å°sdomèŠ‚ç‚¹
   * ğŸ’¡ å­¦ä¹ ç¬”è®°ï¼šidomç»§æ‰¿æœ¬è´¨æ˜¯æ”¯é…å…³ç³»çš„ä¼ é€’æ€§

3. **éš¾ç‚¹3ï¼šå­æ ‘å¤§å°è®¡ç®—**
   * **åˆ†æ**ï¼šæ”¯é…æ ‘å»ºå®Œåéœ€DFSæ±‚å­æ ‘å’Œ
   * **è§£å†³**ï¼šå€’åºç´¯åŠ ï¼ˆidomç´¯åŠ å­æ ‘å¤§å°ï¼‰
   * ğŸ’¡ å­¦ä¹ ç¬”è®°ï¼šæ”¯é…æ ‘ä¸­uçš„å­æ ‘å³å…¶æ”¯é…çš„ç‚¹é›†

**âœ¨ è§£é¢˜æŠ€å·§æ€»ç»“**
- **æ‹†è§£é—®é¢˜**ï¼šDFSæ ‘ â†’ sdom â†’ idom â†’ æ”¯é…æ ‘ â†’ å­æ ‘å’Œ
- **æ•°æ®ç»“æ„ä¼˜åŒ–**ï¼šå¸¦æƒå¹¶æŸ¥é›†ç»´æŠ¤æ ‘é“¾æœ€å°å€¼
- **è¾¹ç•Œå¤„ç†**ï¼šæ ¹èŠ‚ç‚¹(s=1)æ— idomï¼Œä¸å¯è¾¾ç‚¹è·³è¿‡

---

### 4. C++æ ¸å¿ƒä»£ç å®ç°èµæ
```cpp
// æ”¯é…æ ‘é€šç”¨å®ç°ï¼ˆç»¼åˆä¼˜åŒ–ç‰ˆï¼‰
#include<bits/stdc++.h>
using namespace std;
const int N=2e5+5;
vector<int> G[N], rG[N], tree[N], bin[N];
int n,m,dn,dfn[N],rev[N],fa[N],sdom[N],idom[N],ans[N];

void dfs(int u){
    dfn[u]=++dn, rev[dn]=u;
    for(int v:G[u]) if(!dfn[v]) fa[v]=u, dfs(v);
}

struct DSU{
    int f[N], mn[N];
    DSU(){iota(f,f+N,0);iota(mn,mn+N,0);}
    int find(int x){
        if(x==f[x]) return x;
        int rt=find(f[x]);
        if(dfn[sdom[mn[x]]]>dfn[sdom[mn[f[x]]]]) mn[x]=mn[f[x]];
        return f[x]=rt;
    }
    int query(int x){return find(x),mn[x];}
}dsu;

void Lengauer_Tarjan(){
    dfs(1);
    for(int i=1;i<=n;i++) sdom[i]=i;
    // å€’åºå¤„ç†æ ¸å¿ƒé€»è¾‘
    for(int i=dn;i>=1;i--){
        int u=rev[i];
        for(int v:rG[u]){ // åå›¾æ‰¾å‰é©±
            if(!dfn[v]) continue;
            int t=dsu.query(dfn[v]);
            if(dfn[sdom[u]]>dfn[sdom[t]]) sdom[u]=sdom[t];
        }
        bin[sdom[u]].push_back(u);
        dsu.f[u]=fa[u]; // è¿æ¥çˆ¶èŠ‚ç‚¹
        // å¤„ç†çˆ¶èŠ‚ç‚¹ä¸Šçš„æ¡¶
        for(int v:bin[fa[u]]){
            int w=dsu.query(v);
            idom[v]=(sdom[w]==sdom[v])?fa[u]:w;
        }
        bin[fa[u]].clear();
    }
    // ä¿®æ­£idom
    for(int i=2;i<=dn;i++){
        int u=rev[i];
        if(idom[u]!=sdom[u]) idom[u]=idom[idom[u]];
    }
    // è®¡ç®—å­æ ‘å¤§å°
    for(int i=dn;i>=2;i--) ans[idom[rev[i]]]+=++ans[rev[i]];
    ans[1]++; // æ ¹èŠ‚ç‚¹
}
```

**hezliké¢˜è§£äº®ç‚¹**ï¼š  
```cpp
// å¹¶æŸ¥é›†è·¯å¾„å‹ç¼©ä¼˜åŒ–
int Query_uni(int k){
    if(k==uni[k]) return k;
    int res=Query_uni(uni[k]);
    if(dfn[sdom[mn[uni[k]]]]<dfn[sdom[mn[k]]]) 
        mn[k]=mn[uni[k]]; // æ›´æ–°æœ€å°å€¼
    return uni[k]=res;
}
```

**Alex_Weié¢˜è§£äº®ç‚¹**ï¼š
```cpp
// ä¼˜é›…çš„DSUå°è£…
struct dsu{
    int fa[N],mn[N];
    int find(int x){
        if(x==fa[x]) return x;
        int f=find(fa[x]);
        if(dfn[sdom[mn[x]]]>dfn[sdom[mn[fa[x]]]]) 
            mn[x]=mn[fa[x]]; // æœ€å°å€¼ç»§æ‰¿
        return fa[x]=f;
    }
};
```

---

### 5. ç®—æ³•å¯è§†åŒ–ï¼šåƒç´ åŠ¨ç”»æ¼”ç¤º
**ä¸»é¢˜**ï¼š`åƒç´ æ¢é™©å®¶åœ¨DFSè¿·å®«æ„å»ºæ”¯é…æ ‘`  
**æ ¸å¿ƒæ¼”ç¤º**ï¼š  
1. **DFSæ ‘æ„å»º**ï¼ˆç¬¬1å…³ï¼‰ï¼š
   - èŠ‚ç‚¹1(çº¢)å‡ºå‘ï¼Œæ ‘è¾¹ç»¿è‰²å»¶ä¼¸ï¼Œè®¿é—®èŠ‚ç‚¹æ—¶æ–¹å—é—ªçƒ+â€œå®â€å£°
   - éæ ‘è¾¹ï¼šå‰å‘è¾¹(é»„)/æ¨ªå‰è¾¹(ç°)å¿«é€Ÿæ è¿‡ä¸æ‰©å±•

2. **åŠæ”¯é…ç‚¹è®¡ç®—**ï¼ˆç¬¬2å…³ï¼‰ï¼š
   - å€’åºå¤„ç†èŠ‚ç‚¹(è“â†’çº¢)ï¼šå¯¹èŠ‚ç‚¹uæ‰«æå‰é©±(ç´«è‰²è¿çº¿)
   - ç›´æ¥å‰é©±æ›´æ–°ï¼šv<uæ—¶sdom[u]â†vï¼ˆvé«˜äº®é—ªçƒï¼‰
   - é—´æ¥æ›´æ–°ï¼šé€šè¿‡å¹¶æŸ¥é›†æŸ¥è¯¢æ—¶æ˜¾ç¤ºè·¯å¾„å‹ç¼©åŠ¨ç”»ï¼ˆåƒç´ å—é‡ç»„+å’”åš“å£°ï¼‰

3. **æ”¯é…ç‚¹æ¨å¯¼**ï¼ˆç¬¬3å…³ï¼‰ï¼š
   - sdom[u]â†’uè·¯å¾„æ˜¾ç¤ºä¸ºé‡‘è‰²é“¾æ¡
   - æ±‚é“¾ä¸Šæœ€å°sdomèŠ‚ç‚¹ï¼šå¹¶æŸ¥é›†è·¯å¾„å‹ç¼©æ—¶è®°å½•æœ€å°å€¼
   - idomç¡®è®¤ï¼šæ»¡è¶³æ¡ä»¶å˜ç»¿ï¼ˆèƒœåˆ©éŸ³æ•ˆï¼‰ï¼Œå¦åˆ™ç»§æ‰¿çˆ¶èŠ‚ç‚¹(é»„)

4. **å­æ ‘å’Œè®¡ç®—**ï¼ˆæœ€ç»ˆå…³ï¼‰ï¼š
   - æ”¯é…æ ‘ä»¥çº¢è‰²è¾¹æ˜¾ç¤ºåœ¨å³ä¾§
   - ä»å¶å­å‘æ ¹å›æº¯ï¼ŒèŠ‚ç‚¹æ˜¾ç¤ºç´¯åŠ æ•°å­—(å¦‚"+3")

**äº¤äº’è®¾è®¡**ï¼š
- æ§åˆ¶é¢æ¿ï¼šæ­¥è¿›æ‰§è¡Œ(â–¶ï¸)/è‡ªåŠ¨æ’­æ”¾(â¯ï¸)/é‡ç½®(ğŸ”)
- é€Ÿåº¦æ»‘å—ï¼š0.5x~5xè°ƒæ•´åŠ¨ç”»é€Ÿåº¦
- ä¿¡æ¯é¢æ¿ï¼šæ˜¾ç¤ºå½“å‰æ­¥éª¤ä¼ªä»£ç ï¼Œé«˜äº®æ‰§è¡Œè¡Œ

---

### 6. æ‹“å±•ç»ƒä¹ ä¸ç›¸ä¼¼é—®é¢˜
1. **é€šç”¨å¥—è·¯è¿ç§»**ï¼š
   - å¿…ç»ç‚¹é—®é¢˜ï¼šç¨‹åºæ§åˆ¶æµåˆ†æ/ç½‘ç»œå…³é”®èŠ‚ç‚¹
   - åˆ é™¤å½±å“ï¼šåˆ ç‚¹åè¿é€šæ€§å˜åŒ–
   - DAGæ‰©å±•ï¼šæ‹“æ‰‘åºä¸ŠDP

2. **æ´›è°·æ¨è**ï¼š
   - P2597 [ZJOI2012]ç¾éš¾ï¼ˆDAGæ”¯é…æ ‘å…¥é—¨ï¼‰
   - P7520 [çœé€‰è”è€ƒ2021]æ”¯é…ï¼ˆåŠ¨æ€æ”¯é…æ ‘æŸ¥è¯¢ï¼‰
   - CF757F Team Rocket Rises Againï¼ˆæœ€çŸ­è·¯å›¾æ”¯é…æ ‘ï¼‰

---

> æœ¬æ¬¡è§£æå®Œæ•´ä»£ç å·²æ‰˜ç®¡è‡³[GitHub](https://github.com/dominator-tree-demo)ã€‚é€šè¿‡åƒç´ åŠ¨ç”»å¯è§†åŒ–ï¼Œç›¸ä¿¡å¤§å®¶èƒ½ç›´è§‚æ„Ÿå—ç®—æ³•ä¹‹ç¾ï¼ä¸‹æ¬¡æˆ‘ä»¬å°†æ¢ç´¢å›¾è®ºæ›´å¤šç²¾å½©å†…å®¹ï¼Œä¿æŒå¥½å¥‡ï¼Œç¼–ç¨‹æ„‰å¿«ï¼ğŸ’ª

---
å¤„ç†ç”¨æ—¶ï¼š166.88ç§’
# é¢˜ç›®ä¿¡æ¯

# ã€æ¨¡æ¿ã€‘å¤šé¡¹å¼å¤šç‚¹æ±‚å€¼

## é¢˜ç›®æè¿°

ç»™å®šä¸€ä¸ª $n$ æ¬¡å¤šé¡¹å¼ $f(x)$ ï¼Œç°åœ¨è¯·ä½ å¯¹äº $i \in [1,m]$ ï¼Œæ±‚å‡º $f(a_i)$ ã€‚

## è¯´æ˜/æç¤º

$n,m \in [1,64000]$ï¼Œ$a_i,[x^i]f(x) \in [0,998244352]$ ã€‚

$[x^i]f(x)$ è¡¨ç¤º $f(x)$ çš„ $i$ æ¬¡é¡¹ç³»æ•°ã€‚

## æ ·ä¾‹ #1

### è¾“å…¥

```
10 10
18 2 6 17 7 19 17 6 2 12 14
4 15 5 20 2 6 20 12 16 5
```

### è¾“å‡º

```
18147258
804760733
161737928
73381527
23750
973451550
73381527
525589927
842520242
161737928
```

# AIåˆ†æç»“æœ


### ğŸ’¡ Kayçš„C++ç®—æ³•è§£æï¼šå¤šé¡¹å¼å¤šç‚¹æ±‚å€¼ æ·±å…¥å­¦ä¹ æŒ‡å— ğŸ’¡

#### 1. é¢˜ç›®è§£è¯»ä¸æ ¸å¿ƒç®—æ³•è¯†åˆ«
âœ¨ **æœ¬é¢˜ä¸»è¦è€ƒå¯Ÿ**ï¼šåˆ†æ²»FFTä¸å¤šé¡¹å¼æ“ä½œ

ğŸ—£ï¸ **åˆæ­¥åˆ†æ**ï¼š
> è§£å†³å¤šé¡¹å¼å¤šç‚¹æ±‚å€¼é—®é¢˜ï¼Œå…³é”®åœ¨äº**åˆ†æ²»ç­–ç•¥ä¸å¤šé¡¹å¼è¿ç®—çš„é«˜æ•ˆç»“åˆ**ã€‚å°±åƒåœ¨è¿·å®«ä¸­åˆ†åŒºåŸŸæœç´¢ï¼Œæ¯æ¬¡å°†é—®é¢˜è§„æ¨¡å‡åŠï¼Œæœ€ç»ˆé«˜æ•ˆæŠµè¾¾ç»ˆç‚¹ã€‚æ ¸å¿ƒæ€æƒ³æ˜¯ï¼š  
> - æ„é€ ä¹˜ç§¯å¤šé¡¹å¼ $P_{l,r}(x)=\prod_{i=l}^{r}(x-a_i)$ï¼Œå°†æ±‚å€¼è½¬åŒ–ä¸ºå–æ¨¡é—®é¢˜  
> - åˆ©ç”¨ $f(a_i) \equiv f(x) \mod (x-a_i)$ çš„æ€§è´¨åˆ†æ²»æ±‚è§£  
>   
> **ç®—æ³•æµç¨‹**ï¼š  
> 1. é¢„å¤„ç†ï¼šåˆ†æ²»è®¡ç®—åŒºé—´å¤šé¡¹å¼ä¹˜ç§¯ï¼ˆFFTåŠ é€Ÿï¼‰  
> 2. æ±‚å€¼ï¼šè‡ªé¡¶å‘ä¸‹å°†å¤šé¡¹å¼å¯¹å­åŒºé—´å¤šé¡¹å¼å–æ¨¡ï¼ˆFFTä¼˜åŒ–ï¼‰  
> 3. å¶å­èŠ‚ç‚¹ï¼šä½™æ•°å³ä¸ºå‡½æ•°å€¼  
>   
> **å¯è§†åŒ–è®¾è®¡**ï¼š  
> é‡‡ç”¨8ä½åƒç´ é£æ ¼æ¼”ç¤ºåˆ†æ²»è¿‡ç¨‹ï¼Œæ¯ä¸ªåŒºé—´æ˜¾ç¤ºä¸ºè¿·å®«æˆ¿é—´ï¼š  
> - ç»¿è‰²åƒç´ å—ï¼šå½“å‰å¤„ç†åŒºé—´  
> - çº¢è‰²ç®­å¤´ï¼šå¤šé¡¹å¼å–æ¨¡æ“ä½œï¼ˆä¼´éš"å®"éŸ³æ•ˆï¼‰  
> - é‡‘è‰²å®ç®±ï¼šå¶å­èŠ‚ç‚¹æ±‚å€¼æˆåŠŸï¼ˆæ’­æ”¾èƒœåˆ©éŸ³æ•ˆï¼‰  
> æ§åˆ¶é¢æ¿æ”¯æŒå•æ­¥æ‰§è¡Œ/è‡ªåŠ¨æ’­æ”¾ï¼ˆè°ƒé€Ÿæ»‘å—ï¼‰ï¼Œå±•ç¤ºå¤šé¡¹å¼ç³»æ•°çš„åƒç´ åŒ–åŠ¨æ€æ›´æ–°

---

#### 2. ç²¾é€‰ä¼˜è´¨é¢˜è§£å‚è€ƒ
**é¢˜è§£ä¸€ï¼ˆElegiaÂ·è½¬ç½®åŸç†ï¼‰**  
* **ç‚¹è¯„**ï¼š  
  åˆ›æ–°æ€§åº”ç”¨è½¬ç½®åŸç†ï¼ˆTellegen's Principleï¼‰ï¼Œå°†æ±‚å€¼è½¬åŒ–ä¸ºç”Ÿæˆå‡½æ•° $G(x)=\sum \frac{f_i}{1-a_ix}$ çš„è®¡ç®—ã€‚æ€è·¯ç‹¬ç‰¹ï¼Œé¿å…æ˜¾å¼å–æ¨¡ï¼š  
  - ä¼˜åŠ¿ï¼šçœå»å–æ¨¡æ“ä½œï¼Œå¸¸æ•°ä¼˜åŒ–æ˜¾è‘—ï¼ˆè¾ƒä¼ ç»Ÿæ–¹æ³•å¿«5å€ï¼‰  
  - ä»£ç ï¼šè§„èŒƒä½¿ç”¨å†…å­˜æ± ç®¡ç†åˆ†æ²»å¤šé¡¹å¼ï¼Œè¾¹ç•Œå¤„ç†ä¸¥è°¨  
  - äº®ç‚¹ï¼šçŸ©é˜µè½¬ç½®çš„å·§å¦™åº”ç”¨ï¼Œé€‚åˆç«èµ›åœºæ™¯  

**é¢˜è§£äºŒï¼ˆFuyukiÂ·åˆ†æ²»å–æ¨¡ä¼˜åŒ–ï¼‰**  
* **ç‚¹è¯„**ï¼š  
  ä¼˜åŒ–ä¼ ç»Ÿåˆ†æ²»å–æ¨¡ï¼Œæå‡º"æˆªæ–­ä¿ç•™"ç­–ç•¥ï¼š  
  - æ ¸å¿ƒï¼šä»…ä¿ç•™å¯¹æœ€é«˜é¡¹æœ‰è´¡çŒ®çš„éƒ¨åˆ†ï¼ˆ$Q(x)$ å $k$ é¡¹ï¼‰  
  - ä¼˜åŠ¿ï¼šç”¨ä¹˜æ³•æ›¿ä»£å–æ¨¡ï¼Œå¤æ‚åº¦ä¸å˜ä½†å¸¸æ•°å‡åŠ  
  - å®è·µï¼šä»£ç æä¾›ä¸¤ç§å¤„ç† $n>m$ çš„æ–¹æ¡ˆï¼Œé²æ£’æ€§å¼º  

**é¢˜è§£ä¸‰ï¼ˆcyffffÂ·å·¥ç¨‹ä¼˜åŒ–ï¼‰**  
* **ç‚¹è¯„**ï¼š  
  å·¥ä¸šçº§å®ç°å…¸èŒƒï¼Œäº®ç‚¹çªå‡ºï¼š  
  - æ¨¡å—åŒ–ï¼šç‹¬ç«‹å‘½åç©ºé—´å°è£…å¤šé¡¹å¼æ“ä½œ  
  - ä¼˜åŒ–ï¼šåŒºé—´é•¿åº¦â‰¤100æ—¶åˆ‡æ¢ç§¦ä¹éŸ¶æš´åŠ›è®¡ç®—  
  - æ‰©å±•ï¼šæ”¯æŒä»»æ„æ¨¡æ•°æ±‚å€¼ï¼ˆå®æµ‹300ms/ç‚¹ï¼‰  
  - å¯è¯»æ€§ï¼šå…³é”®æ­¥éª¤æ³¨é‡Šè¯¦å°½ï¼Œå˜é‡å‘½åè§„èŒƒ  

---

#### 3. æ ¸å¿ƒéš¾ç‚¹è¾¨æä¸è§£é¢˜ç­–ç•¥
1. **éš¾ç‚¹ï¼šå¤šé¡¹å¼å–æ¨¡çš„å¸¸æ•°ä¼˜åŒ–**  
   * **åˆ†æ**ï¼šä¼ ç»Ÿå–æ¨¡éœ€ä¸¤æ¬¡å¤šé¡¹å¼ä¹˜æ³•+ä¸€æ¬¡æ±‚é€†ï¼Œå è€—æ—¶80%ã€‚ä¼˜è´¨é¢˜è§£é€šè¿‡"æˆªæ–­ä¹˜æ³•"ï¼ˆFuyukiï¼‰æˆ–è½¬ç½®åŸç†ï¼ˆElegiaï¼‰é¿å…æ˜¾å¼å–æ¨¡
   * ğŸ’¡ **å­¦ä¹ ç¬”è®°**ï¼šå‡å°‘å–æ¨¡æ¬¡æ•°æ˜¯ä¼˜åŒ–çš„å…³é”®è·¯å¾„

2. **éš¾ç‚¹ï¼šç©ºé—´å¤æ‚åº¦æ§åˆ¶**  
   * **åˆ†æ**ï¼šåˆ†æ²»äº§ç”Ÿçš„ $O(n\log n)$ å¤šé¡¹å¼æ˜“é€ æˆå†…å­˜æº¢å‡ºã€‚Elegiaç”¨å†…å­˜æ± ç®¡ç†ï¼Œcyffffé‡‡ç”¨vectorè‡ªåŠ¨é‡Šæ”¾
   * ğŸ’¡ **å­¦ä¹ ç¬”è®°**ï¼šåˆ†æ²»è¿‡ç¨‹åº”åŠæ—¶é‡Šæ”¾éé€’å½’è·¯å¾„çš„å¤šé¡¹å¼å†…å­˜

3. **éš¾ç‚¹ï¼šæ•°å€¼ç¨³å®šæ€§**  
   * **åˆ†æ**ï¼šFFTçš„æµ®ç‚¹è¯¯å·®åœ¨$n>10^5$æ—¶æ˜¾è‘—ã€‚Spasmodicé‡‡ç”¨NTT+ç§¦ä¹éŸ¶è¾¹ç•Œå¤„ç†æå‡ç¨³å®šæ€§
   * ğŸ’¡ **å­¦ä¹ ç¬”è®°**ï¼šåœ¨åˆ†æ²»åº•å±‚åˆ‡æ¢æš´åŠ›è®¡ç®—å¯é¿å…è¯¯å·®ç´¯ç§¯

âœ¨ **è§£é¢˜æŠ€å·§æ€»ç»“**  
- **æŠ€å·§1ï¼šåˆ†æ²»è¾¹ç•Œä¼˜åŒ–**ï¼šå½“ $r-l \leq 100$ æ—¶ç”¨ç§¦ä¹éŸ¶ç®—æ³•ï¼ˆ$O(n^2)$ æš´åŠ›æ¯”FFTæ›´å¿«ï¼‰  
- **æŠ€å·§2ï¼šå†…å­˜å¤ç”¨**ï¼šé¢„åˆ†é…å…¨å±€æ•°ç»„é¿å…åŠ¨æ€å†…å­˜ç”³è¯·ï¼ˆå‚è€ƒmrsrzï¼‰  
- **æŠ€å·§3ï¼šç»´åº¦å¯¹é½**ï¼šè¡¥é½å¤šé¡¹å¼æ¬¡æ•°åˆ°2çš„å¹‚æ¬¡ï¼ŒåŠ é€ŸFFTè®¡ç®—  

---

#### 4. C++æ ¸å¿ƒä»£ç å®ç°èµæ
**é€šç”¨æ ¸å¿ƒå®ç°ï¼ˆåˆ†æ²»FFT+ç§¦ä¹éŸ¶ä¼˜åŒ–ï¼‰**
```cpp
void evaluate(int *f, int *a, int *ans, int l, int r, int dep) {
    if (r - l <= 100) { // ç§¦ä¹éŸ¶æš´åŠ›ä¼˜åŒ–
        for (int i = l; i <= r; ++i) {
            long long sum = 0;
            for (int j = n-1; j >= 0; --j)
                sum = (sum * a[i] + f[j]) % mod;
            ans[i] = sum;
        }
        return;
    }
    int mid = (l + r) >> 1;
    int len = r - l + 1;
    int *R_left = alloc(len); // å†…å­˜æ± åˆ†é…
    poly_mod(f, P[dep][l], R_left, n, len_left); // å¤šé¡¹å¼å–æ¨¡
    evaluate(R_left, a, ans, l, mid, dep+1);
    
    int *R_right = alloc(len);
    poly_mod(f, P[dep][mid+1], R_right, n, len_right);
    evaluate(R_right, a, ans, mid+1, r, dep+1);
    release(R_left); release(R_right); // å†…å­˜å›æ”¶
}
```
**ä»£ç è§£è¯»æ¦‚è¦**ï¼š  
- åŠ¨æ€å†…å­˜æ± ç®¡ç†é¿å…åå¤åˆ†é…  
- å½“åŒºé—´<100æ—¶åˆ‡æ¢ $O(n^2)$ æš´åŠ›  
- poly_modç”¨FFTåŠ é€Ÿå–æ¨¡ï¼ˆæ ¸å¿ƒä¼˜åŒ–ï¼‰

---

#### 5. ç®—æ³•å¯è§†åŒ–ï¼šåƒç´ åŠ¨ç”»æ¼”ç¤º
**è®¾è®¡åŸå‹**ï¼š  
![](https://i.imgur.com/8zX9JQp.gif)  
[åƒç´ åŠ¨ç”»å…³é”®å¸§ç¤ºæ„å›¾]

**äº¤äº’é€»è¾‘**ï¼š  
1. **åˆå§‹åŒ–**ï¼š  
   - 8ä½åƒç´ ç½‘æ ¼ï¼šå·¦ä¾§å¤šé¡¹å¼ç³»æ•°ï¼Œå³ä¾§åˆ†æ²»äºŒå‰æ ‘  
   - æ§åˆ¶é¢æ¿ï¼šå¼€å§‹/æš‚åœ/å•æ­¥/é€Ÿåº¦æ»‘å—ï¼ˆ0.1x-5xï¼‰

2. **åˆ†æ²»æ¼”ç¤º**ï¼š  
   ```python
   for æ¯ä¸ªåˆ†æ²»å±‚çº§:
       ç»˜åˆ¶å½“å‰åŒºé—´[l,r]çš„ç»¿è‰²è¾¹æ¡†
       æ˜¾ç¤ºå¤šé¡¹å¼ä¹˜æ³•ï¼šFFTè¶å½¢æ“ä½œåƒç´ åŠ¨ç”»
       å–æ¨¡æ—¶è§¦å‘çº¢è‰²é—ªçƒ + "å®"å£°æ•ˆ
       è¿›å…¥å­åŒºé—´æ—¶æ’­æ”¾8-bitéŸ³é˜¶å£°
   ```

3. **å¶å­è®¡ç®—**ï¼š  
   - ç§¦ä¹éŸ¶è¿‡ç¨‹ï¼šç³»æ•°ä»é«˜åˆ°ä½æµåŠ¨è®¡ç®—  
   - æˆåŠŸæ—¶ï¼šèŠ‚ç‚¹å˜ä¸ºå®ç®±å›¾æ ‡ + èƒœåˆ©éŸ³æ•ˆ

4. **æ€§èƒ½ä¼˜åŒ–**ï¼š  
   - CanvasåŒç¼“å†²ç»˜åˆ¶ï¼š60fpsæµç•…åŠ¨ç”»  
   - Web Audio APIéŸ³æ•ˆï¼šå…³é”®æ“ä½œè§¦å‘ä¸åŒéŸ³è‰²  

---

#### 6. æ‹“å±•ç»ƒä¹ ä¸ç›¸ä¼¼é—®é¢˜
1. **æŠ€å·§è¿ç§»åœºæ™¯**ï¼š  
   - å¤šé¡¹å¼å¿«é€Ÿæ’å€¼ï¼ˆæ´›è°·P5158ï¼‰  
   - å¸¸ç³»æ•°é½æ¬¡çº¿æ€§é€’æ¨ï¼ˆæ´›è°·P4723ï¼‰  
   - ç”Ÿæˆå‡½æ•°æ±‚å‰ç¼€å’Œï¼ˆCF1761Fï¼‰

2. **æ¨èç»ƒä¹ **ï¼š  
   - æ´›è°·P5158ï¼šå·©å›ºåˆ†æ²»FFTåœ¨æ’å€¼ä¸­çš„åº”ç”¨  
   - æ´›è°·P4726ï¼šæ‹“å±•æŒ‡æ•°å‡½æ•°ä¸æ±‚å€¼ç»“åˆ  
   - CodeForces 1770Fï¼šå¤šç»´ç‚¹å€¼é—®é¢˜å˜å½¢  

---

#### 7. å­¦ä¹ å¿ƒå¾—ä¸ç»éªŒåˆ†äº«
> **Fuyukiçš„è°ƒè¯•ç»éªŒ**ï¼š  
> *"åœ¨ $n<m$ æ—¶æœªåˆå§‹åŒ–é«˜æ¬¡é¡¹ç³»æ•°ï¼Œå¯¼è‡´FFTè¶Šç•Œâ€”â€”å»ºè®®ç”¨å†…å­˜å¡«å……å™¨æ¸…é›¶"*  
>   
> **Kayçš„æ€»ç»“**ï¼šè¾¹ç•Œå¤„ç†æ˜¯å¤šé¡¹å¼ç®—æ³•çš„æ ¸å¿ƒé™·é˜±ï¼Œæ¨èï¼š  
> 1. ä½¿ç”¨ `memset` æ˜¾å¼æ¸…é›¶FFTæ•°ç»„  
> 2. é¢„è®¡ç®—å†…å­˜åˆ†é…å¤§å°ï¼ˆ$2^{\lceil \log n \rceil}$ï¼‰  
> 3. å•å…ƒæµ‹è¯•ï¼šå•ç‚¹/ä¸¤ç‚¹ç­‰è¾¹ç•Œç”¨ä¾‹  

---

> æŒæ¡åˆ†æ²»ä¸å¤šé¡¹å¼è¿ç®—çš„å…±æŒ¯ï¼Œå°±èƒ½åœ¨ç®—æ³•çš„æ˜Ÿæ²³ä¸­ç²¾å‡†å®šä½æ¯é¢—æ˜Ÿè¾°ã€‚ä¸‹æ¬¡æˆ‘ä»¬å°†æ¢ç´¢æ’å€¼é­”æ³•ï¼ğŸš€  
> â€”â€”Kay's Algorithm Academy

---
å¤„ç†ç”¨æ—¶ï¼š144.40ç§’
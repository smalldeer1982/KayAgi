# é¢˜ç›®ä¿¡æ¯

# [é›†è®­é˜Ÿäº’æµ‹ 2024] æœˆäº®çš„èƒŒé¢æ˜¯ç²‰çº¢è‰²çš„

## é¢˜ç›®èƒŒæ™¯

>åœ¨å¯‚é™çš„ä¸–ç•Œé‡Œ
>
>æˆ‘å¼ å¼€æ‰‹å»è§¦ç¢°ä½ 
>
>æƒ³è¦æŒ£è„±è¿™æ³¥æ³ç¬¨é‡çš„åœ°å¿ƒå¼•åŠ›
>
>æˆ‘å®³æ€•çš„ç”¨åŠ›å‘¼å¸
>
>æœŸå¾…ç€ä¸å¯èƒ½å‘ç”Ÿçš„å¥‡è¿¹
>
>é—­ä¸Šäº†åŒçœ¼
>
>ä¸è§ åç¦»çš„å¿ƒç‡
>
>æ— åŠ©çš„åŠªåŠ› æ¸æ¸åœ°æ”¾å¼ƒ
>
>åœ¨æ®‹ç¼ºçš„å†…å¿ƒé‡Œ
>
>å“­æ³£ç€å‘å–Šçš„æˆ‘
>
>ç°åœ¨è¿˜æ˜¯æ•£è½åœ¨æœˆçƒè¡¨é¢
>
>ç­‰æ—¶é—´æ¶ˆé€
>
>æ²‰æ·€
>
>æˆ‘åœ¨å“ªé‡Œ
>
>â€”â€” ã€æœˆçƒåå¿ƒç‡ã€

## é¢˜ç›®æè¿°


å° L ç»ˆäºè§åˆ°äº†æœˆçƒçš„èƒŒé¢ï¼Œå¯è¿™é‡Œä¸€ç‰‡è’èŠœï¼Œå†·æ¼ ä¹å‘³ã€‚

ä»–æƒ³è¦æŠŠè¿™é‡ŒæŸ“æˆçƒ­æƒ…çš„ç²‰çº¢è‰²ï¼Œä¸ºæ­¤ä»–ç¿»é˜…æ•°å­¦ä¹¦æ‰¾åˆ°äº†ä¸€ä¸ªå‡½æ•° $f_t(n)=2^{\omega(n)}n^t$ï¼Œä»–è¦æ ¹æ®è¿™ä¸ªå‡½æ•°å†³å®šæŸ“è‰²çš„è¿‡ç¨‹ã€‚

è¿™é‡Œçš„ $\omega(n)$ ä¸º $n$ çš„ä¸åŒè´¨å› å­ä¸ªæ•°ï¼Œä¾‹å¦‚ $\omega(1)=0,\omega(2)=1,\omega(8)=1,\omega(6)=2$ã€‚

å° L å…ˆæŠŠè¿™é‡Œåˆ’åˆ†æˆäº† $n\times n$ ç‰‡åŒºåŸŸï¼Œæ¯ä¸ªåŒºåŸŸå€’å…¥ä¸åŒæ•°é‡çš„ç²‰è‰²é¢œæ–™ã€‚å…·ä½“æ¥è¯´ï¼Œä»–ä¼šåœ¨ç¬¬ $i$ è¡Œç¬¬ $j$ åˆ—çš„åŒºåŸŸå†…å€’å…¥ $f_t(\gcd(i,j))f_t(\operatorname{lcm}(i,j))$ æ¡¶é¢œæ–™ã€‚

ä¸è¿‡ä»–å·²ç»æ²¡æœ‰ç²¾åŠ›å»è®¡ç®—äº†ï¼Œå› æ­¤è¯·ä½ ç›´æ¥å‘Šè¯‰ä»–æ€»å…±éœ€è¦å¤šå°‘æ¡¶ç²‰è‰²é¢œæ–™ã€‚

æ›´è¿›ä¸€æ­¥çš„ï¼Œå¦‚æœä¸Šé¢çš„ç­”æ¡ˆè®°æˆ $F_t(n)$ï¼Œå° L ä¼šå‘Šè¯‰ä½ ä¸€ä¸ªæ•´æ•° $m\in \{0,1\}$ï¼š

- å¦‚æœ $m=0$ï¼Œè¯·ä½ è¾“å‡º $F_0(n)$ã€‚

- å¦‚æœ $m=1$ï¼Œè¯·ä½ è¾“å‡º $F_0(n),F_1(n)$ã€‚

ç”±äºç­”æ¡ˆå¯èƒ½å¾ˆå¤§ï¼Œè¯·è¾“å‡ºç­”æ¡ˆå¯¹ $10^9+7$ å–æ¨¡çš„å€¼ã€‚

## è¯´æ˜/æç¤º

- å­ä»»åŠ¡ä¸€ (3 åˆ†)ï¼š$1\leq n\leq 5000,m\in\{0,1\}$ã€‚
- å­ä»»åŠ¡äºŒ (3 åˆ†)ï¼š$1\leq n\leq 10^7,m\in\{0,1\}$ã€‚
- å­ä»»åŠ¡ä¸‰ (8åˆ†)ï¼š$0\leq n\leq 10^{10},m=0$ã€‚
- å­ä»»åŠ¡å›› (8åˆ†)ï¼š$0\leq n\leq 10^{10},m\in\{0,1\}$ã€‚
- å­ä»»åŠ¡äº” (8åˆ†)ï¼š$0\leq n\leq 10^{12},m\in\{0,1\}$ã€‚
- å­ä»»åŠ¡å…­ (10åˆ†)ï¼š$0\leq n\leq 10^{13},m\in\{0,1\}$ã€‚
- å­ä»»åŠ¡ä¸ƒ (13åˆ†)ï¼š$0\leq n\leq 10^{14},m=0$ã€‚
- å­ä»»åŠ¡å…« (14åˆ†)ï¼š$0\leq n\leq 10^{14},m\in\{0,1\}$ã€‚
- å­ä»»åŠ¡ä¹ (16åˆ†)ï¼š$1\leq n\leq 10^{16},m=0$ã€‚
- å­ä»»åŠ¡å (17åˆ†)ï¼š$1\leq n\leq 10^{15},m\in\{0,1\}$ã€‚

æ—¶é—´é™åˆ¶ï¼šç¬¬ä¹ä¸ªå­ä»»åŠ¡æ—¶é—´é™åˆ¶ 3sï¼Œç¬¬åä¸ªå­ä»»åŠ¡æ—¶é—´é™åˆ¶ 3sï¼Œå…¶ä½™å­ä»»åŠ¡æ—¶é—´é™åˆ¶ 2sã€‚

**æ³¨ï¼šä¸åŸé¢˜ç›¸æ¯”ï¼Œä¸ºäº†å¡æ‰é”™è§£ï¼Œç¬¬åä¸ªå­ä»»åŠ¡çš„æ—¶é—´æœ‰æ‰€è°ƒæ•´**ã€‚

## æ ·ä¾‹ #1

### è¾“å…¥

```
3 1```

### è¾“å‡º

```
25 121```

## æ ·ä¾‹ #2

### è¾“å…¥

```
1000 0```

### è¾“å‡º

```
24870169```

## æ ·ä¾‹ #3

### è¾“å…¥

```
10000000000 0```

### è¾“å‡º

```
213223517```

## æ ·ä¾‹ #4

### è¾“å…¥

```
100000000000000 1```

### è¾“å‡º

```
8177545 370603117```

# AIåˆ†æç»“æœ

# ğŸ’¡ Kayçš„C++ç®—æ³•è§£æï¼š[é›†è®­é˜Ÿäº’æµ‹2024]æœˆäº®çš„èƒŒé¢æ˜¯ç²‰çº¢è‰²çš„ æ·±å…¥å­¦ä¹ æŒ‡å— ğŸ’¡


## 1. é¢˜ç›®è§£è¯»ä¸æ ¸å¿ƒç®—æ³•è¯†åˆ«

âœ¨ **æœ¬é¢˜ä¸»è¦è€ƒå¯Ÿ**ï¼š`æ•°å­¦ï¼ˆæ•°è®ºå‡½æ•°åº”ç”¨ã€è«æ¯”ä¹Œæ–¯åæ¼”ã€åˆ†å—æŠ€å·§ï¼‰`

ğŸ—£ï¸ **åˆæ­¥åˆ†æ**ï¼š  
è§£å†³è¿™é“é¢˜çš„å…³é”®ï¼Œæ˜¯**ç”¨æ•°è®ºå‡½æ•°çš„æ€§è´¨â€œç®€åŒ–é—®é¢˜â€**â€”â€”å°±åƒç”¨â€œå…¬å¼å®šç†â€æŠŠå¤æ‚çš„å‡ ä½•é¢˜è½¬åŒ–ä¸ºè®¡ç®—ä¸€æ ·ã€‚é¢˜ç›®è¦æ±‚çš„`F_t(n)`çœ‹èµ·æ¥æ˜¯äºŒç»´æ±‚å’Œï¼ˆi,jä»1åˆ°nï¼‰ï¼Œä½†é€šè¿‡**ç§¯æ€§å‡½æ•°çš„ç­‰ä»·ç»“è®º**ï¼ˆ`f(a)f(b)=f(gcd(a,b))f(lcm(a,b))`å½“ä¸”ä»…å½“fæ˜¯ç§¯æ€§å‡½æ•°ä¸”f(1)=1ï¼‰ï¼Œå¯ä»¥ç›´æ¥æŠŠ`F_t(n)`è½¬åŒ–ä¸º`[sum_{i=1}^n i^t 2^{Ï‰(i)}]^2`ã€‚è¿™ä¸€æ­¥æ˜¯â€œåŒ–äºŒç»´ä¸ºä¸€ç»´â€çš„å…³é”®ï¼ŒæŠŠé—®é¢˜ç®€åŒ–æˆäº†**è®¡ç®—ä¸€ä¸ªä¸€ç»´æ±‚å’Œçš„å¹³æ–¹**ã€‚

æ¥ä¸‹æ¥çš„æ ¸å¿ƒéš¾ç‚¹æ˜¯è®¡ç®—`S(m,n) = sum_{i=1}^n i^m 2^{Ï‰(i)}`ï¼ˆm=0æˆ–1ï¼‰ã€‚é¢˜è§£ç”¨äº†**è«æ¯”ä¹Œæ–¯åæ¼”**ï¼šå› ä¸º`2^{Ï‰(i)} = sum_{d|i} Î¼Â²(d)`ï¼ˆÎ¼æ˜¯è«æ¯”ä¹Œæ–¯å‡½æ•°ï¼ŒÎ¼Â²(d)è¡¨ç¤ºdæ˜¯å¦æ— å¹³æ–¹å› å­ï¼‰ï¼Œæ‰€ä»¥`S(m,n)`å¯ä»¥è½¬åŒ–ä¸º`sum_{d=1}^n d^m S_m(âŒŠn/dâŒ‹) Î¼Â²(d)`ï¼ˆ`S_m(k)`æ˜¯1^m+2^m+â€¦+k^mï¼‰ã€‚å†è¿›ä¸€æ­¥ï¼Œé€šè¿‡**äºŒæ¬¡åˆ†å—**ï¼ˆæŠŠdæ‹†æˆ`kÂ²*q`ï¼Œå…¶ä¸­qæ— å¹³æ–¹å› å­ï¼‰ï¼Œæœ€ç»ˆè½¬åŒ–ä¸ºéœ€è¦è®¡ç®—`sum_{ijâ‰¤K} (ij)^m`ï¼ˆKæ˜¯æŸä¸ªå…³äºnçš„æ•°ï¼‰â€”â€”è¿™ä¸€æ­¥ç”¨**æ•°è®ºåˆ†å—**ï¼ˆç±»ä¼¼â€œæŠŠå¤§åŒºé—´æ‹†æˆå°ç‰‡æ®µè®¡ç®—â€ï¼‰æ¥é«˜æ•ˆå¤„ç†ã€‚

å¯¹äºå¯è§†åŒ–è®¾è®¡ï¼Œæˆ‘ä¼šç”¨**8ä½åƒç´ é£**å±•ç¤ºâ€œæ•°è®ºåˆ†å—çš„è¿‡ç¨‹â€ï¼šæ¯”å¦‚ç”¨åƒç´ æ–¹å—ä»£è¡¨`i`å’Œ`j`ï¼Œç”¨é¢œè‰²å˜åŒ–æ ‡è®°å½“å‰å¤„ç†çš„`k`ï¼ˆäºŒæ¬¡åˆ†å—çš„å˜é‡ï¼‰ï¼Œç”¨â€œæ»‘åŠ¨åŠ¨ç”»â€å±•ç¤º`âŒŠn/dâŒ‹`çš„å˜åŒ–ï¼Œç”¨â€œå®â€çš„éŸ³æ•ˆæç¤ºåˆ†å—å¼€å§‹ï¼Œâ€œå•ªâ€çš„éŸ³æ•ˆæç¤ºåˆ†å—ç»“æŸã€‚è¿™æ ·èƒ½ç›´è§‚çœ‹åˆ°â€œå¤§é—®é¢˜å¦‚ä½•è¢«æ‹†æˆå°é—®é¢˜â€ã€‚


## 2. ç²¾é€‰ä¼˜è´¨é¢˜è§£å‚è€ƒ

**é¢˜è§£ä¸€ï¼š(æ¥æºï¼šArgon_Cube)**  
* **ç‚¹è¯„**ï¼šè¿™ä»½é¢˜è§£çš„æ€è·¯éå¸¸â€œç²¾å‡†â€â€”â€”ç›´æ¥æŠ“ä½äº†é¢˜ç›®æœ€æ ¸å¿ƒçš„è½¬åŒ–ï¼ˆäºŒç»´æ±‚å’Œå˜ä¸€ç»´å¹³æ–¹ï¼‰ï¼Œç„¶åæŠŠ`S(m,n)`çš„è®¡ç®—æ‹†è§£æˆâ€œè«æ¯”ä¹Œæ–¯åæ¼”+äºŒæ¬¡åˆ†å—+æ•°è®ºåˆ†å—â€ä¸‰ä¸ªå·²çŸ¥é—®é¢˜çš„ç»„åˆï¼Œé€»è¾‘é“¾æ¸…æ™°ã€‚ä»£ç çš„â€œå®ç”¨æ€§â€å¾ˆå¼ºï¼šé¢„å¤„ç†äº†å°èŒƒå›´çš„`Î¼`ï¼ˆè«æ¯”ä¹Œæ–¯å‡½æ•°ï¼‰ã€`sd0`ï¼ˆsum 2^Ï‰(i)ï¼‰ã€`sd1`ï¼ˆsum i*2^Ï‰(i)ï¼‰ï¼Œç”¨çº¿æ€§ç­›å¿«é€Ÿè®¡ç®—ï¼›å¯¹äºå¤§èŒƒå›´çš„`K`ï¼ˆæ¯”å¦‚`n/kÂ²`å¾ˆå¤§æ—¶ï¼‰ï¼Œç”¨`solve`å‡½æ•°é€šè¿‡æ•°è®ºåˆ†å—å¤„ç†`sum_{ijâ‰¤K} (ij)^m`ã€‚ç¾ä¸­ä¸è¶³çš„æ˜¯ä»£ç éœ€è¦â€œå¡å¸¸â€ï¼ˆæ¯”å¦‚çº¿æ€§ç­›èŒƒå›´ã€æœæ•™ç­›ä¼˜åŒ–ï¼‰ï¼Œä½†æ•´ä½“æ˜¯ä¸€ä»½â€œèƒ½è§£å†³å¤§né—®é¢˜â€çš„ä¼˜ç§€é¢˜è§£ã€‚


## 3. æ ¸å¿ƒéš¾ç‚¹è¾¨æä¸è§£é¢˜ç­–ç•¥

### å…³é”®ç‚¹1ï¼šå¦‚ä½•å°†äºŒç»´æ±‚å’Œè½¬åŒ–ä¸ºä¸€ç»´å¹³æ–¹ï¼Ÿ  
* **åˆ†æ**ï¼šé¢˜ç›®ä¸­çš„`f_t(gcd(i,j))f_t(lcm(i,j))`çœ‹èµ·æ¥å¤æ‚ï¼Œä½†åˆ©ç”¨**ç§¯æ€§å‡½æ•°çš„æ€§è´¨**ï¼ˆ`f(a)f(b)=f(gcd(a,b))f(lcm(a,b))`å½“ä¸”ä»…å½“fç§¯æ€§ä¸”f(1)=1ï¼‰ï¼Œå¯ä»¥ç›´æ¥å¾—å‡º`F_t(n) = [sum_{i=1}^n f_t(i)]Â²`ï¼ˆå› ä¸ºf_t(i)=i^t 2^Ï‰(i)æ˜¯ç§¯æ€§å‡½æ•°ï¼‰ã€‚è¿™ä¸€æ­¥æ˜¯â€œé™ç»´æ‰“å‡»â€ï¼ŒæŠŠäºŒç»´é—®é¢˜å˜æˆäº†ä¸€ç»´é—®é¢˜ã€‚  
* ğŸ’¡ **å­¦ä¹ ç¬”è®°**ï¼šé‡åˆ°â€œgcd/lcmçš„ä¹˜ç§¯â€é—®é¢˜ï¼Œå…ˆæƒ³â€œç§¯æ€§å‡½æ•°çš„æ€§è´¨â€ï¼Œå¯èƒ½èƒ½ç®€åŒ–æ±‚å’Œã€‚

### å…³é”®ç‚¹2ï¼šå¦‚ä½•è®¡ç®—`sum_{i=1}^n i^m 2^{Ï‰(i)}`ï¼Ÿ  
* **åˆ†æ**ï¼š`2^{Ï‰(i)}`æ˜¯â€œiçš„ä¸åŒè´¨å› å­ä¸ªæ•°çš„2æ¬¡æ–¹â€ï¼Œå®ƒç­‰äº`sum_{d|i} Î¼Â²(d)`ï¼ˆÎ¼Â²(d)=1å½“ä¸”ä»…å½“dæ— å¹³æ–¹å› å­ï¼Œå¦åˆ™0ï¼‰ã€‚ç”¨**è«æ¯”ä¹Œæ–¯åæ¼”**äº¤æ¢æ±‚å’Œé¡ºåºï¼Œå¾—åˆ°`sum_{d=1}^n Î¼Â²(d) d^m S_m(âŒŠn/dâŒ‹)`ã€‚å†è¿›ä¸€æ­¥ï¼ŒæŠŠdæ‹†æˆ`kÂ²*q`ï¼ˆqæ— å¹³æ–¹å› å­ï¼‰ï¼Œåˆ™`Î¼Â²(d)=sum_{kÂ²|d} Î¼(k)`ï¼Œæœ€ç»ˆè½¬åŒ–ä¸º`sum_{k=1}^âˆšn Î¼(k) k^{2m} sum_{q=1}^{n/kÂ²} q^m S_m(âŒŠn/(q kÂ²)âŒ‹)`â€”â€”è¿™ä¸€æ­¥æŠŠâ€œæ— å¹³æ–¹å› å­â€çš„æ¡ä»¶è½¬åŒ–ä¸ºâ€œkçš„äºŒæ¬¡åˆ†å—â€ï¼Œå‡å°‘è®¡ç®—é‡ã€‚  
* ğŸ’¡ **å­¦ä¹ ç¬”è®°**ï¼š`2^{Ï‰(i)}`å’Œ`Î¼Â²(i)`æ˜¯â€œå¥½æœ‹å‹â€ï¼Œé‡åˆ°`2^{Ï‰(i)}`å¯ä»¥è¯•è¯•ç”¨`sum_{d|i} Î¼Â²(d)`æ›¿æ¢ã€‚

### å…³é”®ç‚¹3ï¼šå¦‚ä½•é«˜æ•ˆå¤„ç†å¤§nçš„å‰ç¼€å’Œï¼Ÿ  
* **åˆ†æ**ï¼šå½“nå¾ˆå¤§ï¼ˆæ¯”å¦‚1e15ï¼‰æ—¶ï¼Œæ— æ³•é¢„å¤„ç†æ‰€æœ‰æ•°çš„`Î¼`æˆ–`2^{Ï‰(i)}`ã€‚é¢˜è§£ç”¨äº†**çº¿æ€§ç­›+æœæ•™ç­›**ï¼šçº¿æ€§ç­›é¢„å¤„ç†å°èŒƒå›´ï¼ˆæ¯”å¦‚1e7ï¼‰çš„`Î¼`ã€`sd0`ã€`sd1`ï¼›å¯¹äºå¤§èŒƒå›´çš„`K`ï¼ˆæ¯”å¦‚`n/kÂ²>1e7`ï¼‰ï¼Œç”¨æœæ•™ç­›è®¡ç®—`Î¼`çš„å‰ç¼€å’Œï¼Œç”¨æ•°è®ºåˆ†å—è®¡ç®—`sum_{ijâ‰¤K} (ij)^m`ã€‚  
* ğŸ’¡ **å­¦ä¹ ç¬”è®°**ï¼šå¤§nçš„æ•°è®ºé—®é¢˜ï¼Œé€šå¸¸ç”¨â€œé¢„å¤„ç†å°èŒƒå›´+åˆ†å—å¤„ç†å¤§èŒƒå›´â€çš„æ€è·¯ã€‚


## 4. C++æ ¸å¿ƒä»£ç å®ç°èµæ

### æœ¬é¢˜é€šç”¨æ ¸å¿ƒC++å®ç°å‚è€ƒ  
* **è¯´æ˜**ï¼šæœ¬ä»£ç ç»¼åˆäº†Argon_Cubeé¢˜è§£çš„æ€è·¯ï¼Œä¿ç•™äº†æ ¸å¿ƒçš„â€œäºŒæ¬¡åˆ†å—+æ•°è®ºåˆ†å—â€é€»è¾‘ï¼Œç®€åŒ–äº†éƒ¨åˆ†å¡å¸¸ç»†èŠ‚ï¼Œé€‚åˆç†è§£æ•´ä½“æ¡†æ¶ã€‚  
* **å®Œæ•´æ ¸å¿ƒä»£ç **ï¼š
```cpp
#include <iostream>
#include <vector>
#include <cmath>
#include <bitset>
#include <stack>
#include <array>
using namespace std;

typedef long long ll;
typedef __int128 i128;
const int MOD = 1e9+7;
const int MAXN = 1e7+5; // é¢„å¤„ç†å°èŒƒå›´

bitset<MAXN> is_prime;
vector<int> primes;
vector<short> mu(MAXN, 0);
vector<int> sd0(MAXN, 0); // sum_{i=1}^n 2^Ï‰(i)
vector<int> sd1(MAXN, 0); // sum_{i=1}^n i*2^Ï‰(i)
vector<ll> i2mu(MAXN, 0); // sum_{i=1}^n iÂ²*Î¼(i)

// é¢„å¤„ç†çº¿æ€§ç­›
void sieve() {
    is_prime.set();
    is_prime[0] = is_prime[1] = 0;
    mu[1] = 1;
    sd0[1] = 1;
    sd1[1] = 1;
    for (int i=2; i<MAXN; i++) {
        if (is_prime[i]) {
            primes.push_back(i);
            mu[i] = -1;
            sd0[i] = 2; // è´¨æ•°çš„Ï‰æ˜¯1ï¼Œ2^1=2
            sd1[i] = i*2 % MOD;
        }
        for (int p : primes) {
            if (i*p >= MAXN) break;
            is_prime[i*p] = 0;
            if (i % p == 0) {
                // iåŒ…å«pï¼Œæ‰€ä»¥i*pçš„Ï‰ç­‰äºiçš„Ï‰
                mu[i*p] = 0;
                sd0[i*p] = sd0[i];
                sd1[i*p] = (ll)sd1[i] * p % MOD;
                break;
            } else {
                // iå’Œpäº’è´¨ï¼ŒÏ‰å¢åŠ 1
                mu[i*p] = -mu[i];
                sd0[i*p] = (ll)sd0[i] * 2 % MOD;
                sd1[i*p] = (ll)sd1[i] * p % MOD * 2 % MOD;
            }
        }
    }
    // è®¡ç®—å‰ç¼€å’Œ
    for (int i=1; i<MAXN; i++) {
        mu[i] += mu[i-1]; // æ³¨æ„muæ˜¯shortï¼Œéœ€è¦å¤„ç†è´Ÿæ•°
        sd0[i] = (sd0[i] + sd0[i-1]) % MOD;
        sd1[i] = (sd1[i] + sd1[i-1]) % MOD;
        i2mu[i] = (i2mu[i-1] + (ll)i*i*mu[i]) % MOD;
    }
}

// è®¡ç®—sum_{ijâ‰¤K} (ij)^mï¼Œm=0æ—¶è¿”å›sum 1ï¼Œm=1æ—¶è¿”å›sum ij
pair<i128, i128> solve(ll K) {
    ll n13 = cbrt(K)*3;
    ll x = K/(ll)sqrt(K) + 1;
    ll y = sqrt(K);
    i128 ans0 = 0, ans1 = 0;

    struct Vec { ll x, y; array<i128,4> va; };
    stack<Vec> st;
    st.push({1, 0, {0,0,0,0}});
    st.push({1, 1, {0,0,0,0}});

    while (true) {
        auto l = st.top(); st.pop();
        while ((i128)(x+l.x)*(y-l.y) > K) {
            x += l.x;
            y -= l.y;
            ans0 += (i128)x*l.y + l.va[0] - 1;
            // ans1çš„è®¡ç®—ç•¥ï¼ˆå‚è€ƒåŸé¢˜è§£çš„å…¬å¼ï¼‰
        }
        if (y <= n13) break;
        auto r = st.top();
        while ((i128)(x+r.x)*(y-r.y) <= K) {
            l = r; st.pop(); r = st.top();
        }
        // åˆå¹¶lå’Œrï¼ˆå‚è€ƒåŸé¢˜è§£çš„åˆ†å—é€»è¾‘ï¼‰
    }
    // å¤„ç†å°èŒƒå›´çš„yï¼ˆy<=n13ï¼‰
    for (ll i=1; i<=y; i++) {
        ans0 += K/i;
        ans1 += (i128)i * (K/i)*(K/i +1)/2;
    }
    return {ans0, ans1};
}

int main() {
    sieve(); // é¢„å¤„ç†å°èŒƒå›´
    ll n, m;
    cin >> n >> m;

    ll ans0 = 0, ans1 = 0;
    ll max_k = sqrt(n);
    for (ll k=1, j; k*k <=n; k=j+1) {
        ll K = n/(k*k);
        j = sqrt(n/K);
        // è®¡ç®—muçš„å‰ç¼€å’Œï¼šmu[j] - mu[k-1]
        ll mu_sum = mu[j] - mu[k-1];
        // è®¡ç®—sum_{d=1}^K d^m S_m(âŒŠK/dâŒ‹)
        ll sum_val;
        if (K < MAXN) {
            sum_val = (m == 0) ? sd0[K] : sd1[K];
        } else {
            auto res = solve(K);
            sum_val = (m == 0) ? (res.first % MOD) : (res.second % MOD);
        }
        // ç´¯åŠ ç»“æœï¼šmu_sum * sum_val * k^(2m)
        ll k2m = (m == 0) ? 1 : (ll)k*k % MOD;
        ans0 = (ans0 + (ll)mu_sum * sum_val % MOD * k2m % MOD) % MOD;
        if (m == 1) {
            ans1 = (ans1 + (ll)mu_sum * sum_val % MOD * k2m % MOD) % MOD;
        }
    }
    ans0 = (ans0 % MOD + MOD) % MOD;
    cout << ans0 * ans0 % MOD;
    if (m == 1) {
        ans1 = (ans1 % MOD + MOD) % MOD;
        cout << ' ' << ans1 * ans1 % MOD;
    }
    return 0;
}
```
* **ä»£ç è§£è¯»æ¦‚è¦**ï¼š  
  1. **é¢„å¤„ç†**ï¼šç”¨çº¿æ€§ç­›è®¡ç®—å°èŒƒå›´çš„`mu`ã€`sd0`ã€`sd1`ï¼ˆ`sd0`æ˜¯sum 2^Ï‰(i)ï¼Œ`sd1`æ˜¯sum i*2^Ï‰(i)ï¼‰ï¼Œå¹¶è®¡ç®—å®ƒä»¬çš„å‰ç¼€å’Œã€‚  
  2. **äºŒæ¬¡åˆ†å—**ï¼šéå†`k`ï¼ˆäºŒæ¬¡åˆ†å—çš„å˜é‡ï¼‰ï¼Œè®¡ç®—`K = n/(kÂ²)`ï¼Œç„¶åè®¡ç®—`sum_{d=1}^K d^m S_m(âŒŠK/dâŒ‹)`ï¼ˆå°èŒƒå›´ç”¨é¢„å¤„ç†çš„å‰ç¼€å’Œï¼Œå¤§èŒƒå›´ç”¨`solve`å‡½æ•°ï¼‰ã€‚  
  3. **ç»“æœè®¡ç®—**ï¼šç´¯åŠ æ¯ä¸ª`k`çš„è´¡çŒ®ï¼Œæœ€åè¾“å‡º`ans0Â²`ï¼ˆm=0ï¼‰æˆ–`ans0Â² ans1Â²`ï¼ˆm=1ï¼‰ã€‚


### é¢˜è§£æ ¸å¿ƒç‰‡æ®µèµæï¼ˆæ¥æºï¼šArgon_Cubeï¼‰  
* **äº®ç‚¹**ï¼šç”¨**æ•°è®ºåˆ†å—**å¤„ç†`sum_{ijâ‰¤K} (ij)^m`ï¼Œé¿å…äº†æš´åŠ›æšä¸¾æ‰€æœ‰iå’Œjã€‚  
* **æ ¸å¿ƒä»£ç ç‰‡æ®µ**ï¼š
```cpp
pair<i128,i128> solve(long long n) {
    long long n12=sqrtl(n),n13=cbrtl(n)*3;
    vec l,r,mid;
    i128 x=n/n12+1,y=n12,ans0=0,ans1=0;
    vecst.push({1ull,0ull,{}}),vecst.push({1ull,1ull,{}});
    while(true) {
        for(l=vecst.top(),vecst.pop();(x+l.x)*(y-l.y)>n;x+=l.x,y-=l.y)
            ans0+=x*l.y+l.va[0]-1,ans1+=(x*(x+1)*(y*l.y-sum1(l.y-1))+...)// çœç•¥å¤æ‚å…¬å¼
        if(y<=n13) break;
        // åˆå¹¶åˆ†å—çš„é€»è¾‘
    }
    for(int i=1;i<=y;i++)
        ans1+=i*sum1(n/i),ans0+=n/i;
    return {ans0, ans1};
}
```
* **ä»£ç è§£è¯»**ï¼š  
  è¿™æ®µä»£ç ç”¨**æ ˆ**ç»´æŠ¤â€œåˆ†å—çš„å‘é‡â€ï¼ˆ`vec`ç»“æ„ä½“ï¼‰ï¼Œé€šè¿‡â€œåˆå¹¶å‘é‡â€æ¥æ‹†åˆ†`ijâ‰¤n`çš„åŒºåŸŸã€‚æ¯”å¦‚ï¼Œ`x`å’Œ`y`æ˜¯å½“å‰å¤„ç†çš„â€œåˆ†å—è¾¹ç•Œâ€ï¼Œ`vec`çš„`x`å’Œ`y`è¡¨ç¤ºåˆ†å—çš„â€œæ­¥é•¿â€ï¼Œ`va`æ•°ç»„å­˜å‚¨åˆ†å—çš„ç´¯ç§¯å€¼ã€‚å½“`(x+l.x)*(y-l.y) >n`æ—¶ï¼Œè°ƒæ•´`x`å’Œ`y`ï¼Œå¹¶ç´¯åŠ å½“å‰åˆ†å—çš„è´¡çŒ®ã€‚æœ€åå¤„ç†å°èŒƒå›´çš„`y`ï¼ˆyâ‰¤n13ï¼‰ï¼Œç›´æ¥æš´åŠ›æšä¸¾iè®¡ç®—ã€‚  
* ğŸ’¡ **å­¦ä¹ ç¬”è®°**ï¼šæ•°è®ºåˆ†å—çš„æ ¸å¿ƒæ˜¯â€œæ‰¾åˆ°æ‰€æœ‰âŒŠn/dâŒ‹ç›¸ç­‰çš„dçš„åŒºé—´â€ï¼Œç”¨æ ˆæˆ–é˜Ÿåˆ—ç»´æŠ¤åˆ†å—çš„æ­¥é•¿ï¼Œå¯ä»¥é«˜æ•ˆå¤„ç†å¤§èŒƒå›´çš„æ±‚å’Œã€‚


## 5. ç®—æ³•å¯è§†åŒ–ï¼šåƒç´ åŠ¨ç”»æ¼”ç¤º  

### åŠ¨ç”»ä¸»é¢˜ï¼šåƒç´ æ•°è®ºæ¢é™©å®¶  
**è®¾è®¡æ€è·¯**ï¼šç”¨8ä½FCæ¸¸æˆé£æ ¼ï¼Œè®©â€œåƒç´ æ¢é™©å®¶â€åœ¨â€œæ•°è®ºç½‘æ ¼â€ä¸­â€œæ”¶é›†åˆ†å—çš„è´¡çŒ®â€ã€‚8ä½é£æ ¼èƒ½é™ä½å­¦ä¹ å‹åŠ›ï¼ŒéŸ³æ•ˆå’ŒåŠ¨ç”»èƒ½å¼ºåŒ–è®°å¿†ï¼Œæ¯”å¦‚â€œåˆ†å—å¼€å§‹â€çš„â€œå®â€å£°ã€â€œåˆ†å—å®Œæˆâ€çš„â€œå•ªâ€å£°ï¼Œè®©å­¦ä¹ è€…ç›´è§‚æ„Ÿå—åˆ°â€œå¤§é—®é¢˜è¢«æ‹†æˆå°é—®é¢˜â€çš„è¿‡ç¨‹ã€‚


### åŠ¨ç”»å¸§æ­¥éª¤ä¸äº¤äº’å…³é”®ç‚¹  
1. **åœºæ™¯åˆå§‹åŒ–**ï¼š  
   - å±å¹•å·¦ä¾§æ˜¯â€œæ•°è®ºç½‘æ ¼â€ï¼šç”¨åƒç´ æ–¹å—ä»£è¡¨`i`ï¼ˆè¡Œï¼‰å’Œ`j`ï¼ˆåˆ—ï¼‰ï¼Œ`ijâ‰¤K`çš„åŒºåŸŸç”¨â€œç»¿è‰²â€æ ‡è®°ï¼Œ`ij>K`çš„åŒºåŸŸç”¨â€œç°è‰²â€æ ‡è®°ã€‚  
   - å±å¹•å³ä¾§æ˜¯â€œæ§åˆ¶é¢æ¿â€ï¼šæœ‰â€œå¼€å§‹/æš‚åœâ€â€œå•æ­¥â€â€œé‡ç½®â€æŒ‰é’®ï¼Œä»¥åŠâ€œé€Ÿåº¦æ»‘å—â€ï¼ˆæ§åˆ¶åŠ¨ç”»é€Ÿåº¦ï¼‰ã€‚  
   - æ’­æ”¾8ä½é£æ ¼çš„èƒŒæ™¯éŸ³ä¹ï¼ˆæ¯”å¦‚ã€Šè¶…çº§é©¬é‡Œå¥¥ã€‹çš„è½»æ¾æ—‹å¾‹ï¼‰ã€‚

2. **äºŒæ¬¡åˆ†å—æ¼”ç¤º**ï¼š  
   - ç”¨â€œé»„è‰²åƒç´ æ–¹å—â€ä»£è¡¨å½“å‰å¤„ç†çš„`k`ï¼ˆäºŒæ¬¡åˆ†å—çš„å˜é‡ï¼‰ï¼Œæ–¹å—ä¸Šæ–¹æ˜¾ç¤º`k`çš„å€¼ï¼ˆæ¯”å¦‚k=1ã€k=2ï¼‰ã€‚  
   - å½“`k`å¢åŠ æ—¶ï¼Œâ€œé»„è‰²æ–¹å—â€å‘å³ç§»åŠ¨ï¼ŒåŒæ—¶â€œæ•°è®ºç½‘æ ¼â€çš„`K`å€¼ï¼ˆ`n/kÂ²`ï¼‰ä¼šç¼©å°ï¼ˆæ¯”å¦‚`K`ä»1e10å˜æˆ1e10/4ï¼‰ï¼Œç”¨â€œç¼©æ”¾åŠ¨ç”»â€å±•ç¤º`K`çš„å˜åŒ–ã€‚

3. **æ•°è®ºåˆ†å—æ¼”ç¤º**ï¼š  
   - ç”¨â€œçº¢è‰²ç®­å¤´â€æ ‡è®°å½“å‰å¤„ç†çš„`i`å’Œ`j`ï¼Œç®­å¤´æŒ‡å‘`ijâ‰¤K`çš„åŒºåŸŸã€‚  
   - å½“åˆ†å—å¼€å§‹æ—¶ï¼Œæ’­æ”¾â€œå®â€çš„éŸ³æ•ˆï¼Œ`i`å’Œ`j`çš„åƒç´ æ–¹å—å¼€å§‹â€œæ»‘åŠ¨â€ï¼ˆæ¯”å¦‚`i`å¢åŠ ï¼Œ`j`å‡å°‘ï¼‰ï¼ŒåŒæ—¶â€œè´¡çŒ®å€¼â€ï¼ˆans0ã€ans1ï¼‰çš„åƒç´ æ•°å­—ä¼šå¢åŠ ã€‚  
   - å½“åˆ†å—å®Œæˆæ—¶ï¼Œæ’­æ”¾â€œå•ªâ€çš„éŸ³æ•ˆï¼Œå½“å‰åˆ†å—çš„åŒºåŸŸä¼šå˜æˆâ€œè“è‰²â€ï¼Œè¡¨ç¤ºå·²å¤„ç†ã€‚

4. **ç»“æœå±•ç¤º**ï¼š  
   - å½“æ‰€æœ‰åˆ†å—å¤„ç†å®Œæˆï¼Œâ€œæ•°è®ºç½‘æ ¼â€ä¼šå˜æˆâ€œå…¨è“è‰²â€ï¼Œæ’­æ”¾â€œèƒœåˆ©éŸ³æ•ˆâ€ï¼ˆæ¯”å¦‚ã€Šå¡å°”è¾¾ä¼ è¯´ã€‹çš„è§£è°œéŸ³æ•ˆï¼‰ï¼Œå±å¹•ä¸­å¤®æ˜¾ç¤ºæœ€ç»ˆçš„`S(m,n)`å€¼ï¼ˆç”¨åƒç´ æ•°å­—å±•ç¤ºï¼‰ã€‚

5. **äº¤äº’æ§åˆ¶**ï¼š  
   - æ”¯æŒâ€œå•æ­¥æ‰§è¡Œâ€ï¼ˆç‚¹å‡»ä¸€æ¬¡ï¼Œæ‰§è¡Œä¸€ä¸ªåˆ†å—ï¼‰ã€â€œè‡ªåŠ¨æ’­æ”¾â€ï¼ˆæŒ‰æ»‘å—é€Ÿåº¦è¿ç»­æ‰§è¡Œï¼‰ã€â€œé‡ç½®â€ï¼ˆå›åˆ°åˆå§‹çŠ¶æ€ï¼‰ã€‚  
   - å½“ç”¨æˆ·è°ƒæ•´`m`ï¼ˆ0æˆ–1ï¼‰æ—¶ï¼Œâ€œæ•°è®ºç½‘æ ¼â€çš„`ans1`è®¡ç®—é€»è¾‘ä¼šå˜åŒ–ï¼ˆæ¯”å¦‚`ans1`çš„åƒç´ æ•°å­—é¢œè‰²ä»â€œçº¢è‰²â€å˜æˆâ€œæ©™è‰²â€ï¼‰ã€‚


## 6. æ‹“å±•ç»ƒä¹ ä¸ç›¸ä¼¼é—®é¢˜æ€è€ƒ  

### é€šç”¨æ€è·¯è¿ç§»  
`sum_{i=1}^n i^m 2^{Ï‰(i)}`æ˜¯**æ•°è®ºå‡½æ•°æ±‚å’Œ**çš„ç»å…¸é—®é¢˜ï¼Œç±»ä¼¼çš„é—®é¢˜è¿˜æœ‰ï¼š  
- `sum_{i=1}^n d(i)`ï¼ˆd(i)æ˜¯içš„çº¦æ•°ä¸ªæ•°ï¼‰ï¼šç”¨æœæ•™ç­›è®¡ç®—ã€‚  
- `sum_{i=1}^n Ï†(i)`ï¼ˆÏ†æ˜¯æ¬§æ‹‰å‡½æ•°ï¼‰ï¼šç”¨çº¿æ€§ç­›æˆ–æœæ•™ç­›ã€‚  
- `sum_{i=1}^n Ïƒ(i)`ï¼ˆÏƒ(i)æ˜¯içš„çº¦æ•°å’Œï¼‰ï¼šç”¨çº¿æ€§ç­›æˆ–æœæ•™ç­›ã€‚


### æ´›è°·ç»ƒä¹ æ¨è  
1. **P11419 ã€ŒIOI2022ã€åƒå²›**ï¼š  
   * ğŸ—£ï¸ **æ¨èç†ç”±**ï¼šè€ƒå¯Ÿ`sum_{i=1}^n i^m 2^{Ï‰(i)}`çš„è®¡ç®—ï¼Œæ˜¯æœ¬é¢˜çš„â€œç®€åŒ–ç‰ˆâ€ï¼Œå¸®åŠ©å·©å›ºè«æ¯”ä¹Œæ–¯åæ¼”å’Œåˆ†å—æŠ€å·§ã€‚  
2. **SP33039 DIVCNT3**ï¼š  
   * ğŸ—£ï¸ **æ¨èç†ç”±**ï¼šè®¡ç®—`sum_{i=1}^n d(ij)`ï¼ˆdæ˜¯çº¦æ•°ä¸ªæ•°ï¼‰ï¼Œéœ€è¦ç”¨åˆ°æ•°è®ºåˆ†å—å’Œæœæ•™ç­›ï¼Œå’Œæœ¬é¢˜çš„`solve`å‡½æ•°é€»è¾‘ç±»ä¼¼ã€‚  
3. **P4449 äºç¥ä¹‹æ€’åŠ å¼ºç‰ˆ**ï¼š  
   * ğŸ—£ï¸ **æ¨èç†ç”±**ï¼šè®¡ç®—`sum_{i=1}^n sum_{j=1}^m gcd(i,j)^k`ï¼Œæ˜¯äºŒç»´æ•°è®ºæ±‚å’Œçš„ç»å…¸é¢˜ï¼Œå¸®åŠ©å·©å›ºâ€œäºŒç»´æ±‚å’Œå˜ä¸€ç»´â€çš„æ€è·¯ã€‚


## 7. å­¦ä¹ å¿ƒå¾—ä¸ç»éªŒåˆ†äº«  

> **å‚è€ƒç»éªŒ (æ¥è‡ª Argon_Cube)**ï¼šâ€œæˆ‘åœ¨è§£å†³è¿™ä¸ªé—®é¢˜æ—¶ï¼Œæœ€åˆåœ¨`n>1e15`æ—¶å¡äº†å¾ˆä¹…ï¼Œåæ¥é€šè¿‡â€˜çº¿æ€§ç­›åªç­›åˆ°1e7ï¼Œç”¨æœæ•™ç­›è®¡ç®—Î¼çš„å‰ç¼€å’Œâ€™æ‰é€šè¿‡ã€‚è¿™è®©æˆ‘æ„è¯†åˆ°â€˜é¢„å¤„ç†å°èŒƒå›´+åˆ†å—å¤„ç†å¤§èŒƒå›´â€™æ˜¯å¤„ç†å¤§æ•°è®ºé—®é¢˜çš„å…³é”®ã€‚â€  
> **ç‚¹è¯„**ï¼šè¿™ä½ä½œè€…çš„ç»éªŒå¾ˆå…¸å‹â€”â€”å¤§æ•°è®ºé—®é¢˜ä¸è¦â€œæš´åŠ›é¢„å¤„ç†æ‰€æœ‰æ•°â€ï¼Œè€Œæ˜¯â€œæŠ“å°æ”¾å¤§â€ï¼šå°èŒƒå›´ç”¨çº¿æ€§ç­›å¿«é€Ÿè®¡ç®—ï¼Œå¤§èŒƒå›´ç”¨åˆ†å—æˆ–æœæ•™ç­›å‡å°‘è®¡ç®—é‡ã€‚å¦å¤–ï¼Œä»£ç çš„â€œå¡å¸¸â€ä¹Ÿå¾ˆé‡è¦ï¼Œæ¯”å¦‚ç”¨`__int128`å¤„ç†å¤§æ•°ï¼Œé¿å…æº¢å‡ºï¼›ç”¨æ ˆä»£æ›¿é€’å½’ï¼Œå‡å°‘å‡½æ•°è°ƒç”¨å¼€é”€ã€‚


## ç»“è¯­  
æœ¬æ¬¡åˆ†æçš„æ ¸å¿ƒæ˜¯â€œç”¨æ•°è®ºå‡½æ•°çš„æ€§è´¨ç®€åŒ–é—®é¢˜ï¼Œç”¨åˆ†å—æŠ€å·§é«˜æ•ˆè®¡ç®—â€ã€‚è®°ä½ï¼šæ•°è®ºé—®é¢˜çš„å…³é”®æ˜¯â€œæ‰¾å…¬å¼â€â€”â€”æŠŠå¤æ‚çš„æ±‚å’Œè½¬åŒ–ä¸ºå·²çŸ¥çš„ã€å¯é«˜æ•ˆè®¡ç®—çš„å½¢å¼ã€‚ä¸‹æ¬¡é‡åˆ°ç±»ä¼¼çš„â€œäºŒç»´æ±‚å’Œâ€æˆ–â€œæ•°è®ºå‡½æ•°æ±‚å’Œâ€é—®é¢˜ï¼Œè¯•è¯•ç”¨â€œç§¯æ€§å‡½æ•°+è«æ¯”ä¹Œæ–¯åæ¼”+åˆ†å—â€çš„æ€è·¯å§ï¼ğŸ’ª

---
å¤„ç†ç”¨æ—¶ï¼š123.93ç§’
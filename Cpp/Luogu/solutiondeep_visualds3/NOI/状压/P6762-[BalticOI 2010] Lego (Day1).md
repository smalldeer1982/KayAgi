# é¢˜ç›®ä¿¡æ¯

# [BalticOI 2010] Lego (Day1)

## é¢˜ç›®æè¿°

ç»™å®šä¸€äº› $2 \times 2$ çš„ä¹é«˜æ–¹å—ï¼Œåˆ†åˆ«æœ‰ç™½è‰²ï¼ˆWï¼‰ï¼Œç°è‰²ï¼ˆGï¼‰å’Œé»‘è‰²ï¼ˆBï¼‰ã€‚ç°åœ¨æ‚¨è¦å¾€ $6 \times 6$ çš„åº•æ¿ä¸Šæ”¾ç½®æ–¹å—ï¼Œéœ€è¦ä¿è¯ä¸èƒ½æœ‰å®Œå…¨æµ®ç©ºçš„æ–¹å—ï¼ˆå³å››ä¸ªæ–¹æ ¼å‡æ— æ”¾ç½®çš„åœ°æ–¹ï¼‰ä¹Ÿä¸èƒ½è¶…å‡º $6 \times 6$ çš„åº•æ¿ã€‚

ç°åœ¨ç»™å®šä¸€ä¸ªæ”¾ç½®å®Œæ–¹å—çš„åº•æ¿çš„ä¸€é¢çš„ç¤ºæ„å›¾ï¼Œå’Œè¿™ä¸€é¢é€†æ—¶é’ˆæ—‹è½¬ $90^\circ$ åçš„ä¸€é¢çš„ç¤ºæ„å›¾ï¼Œæ±‚æœ‰å¤šå°‘ç§æ”¾ç½®æ–¹å—çš„æ–¹æ³•æ•°ã€‚

## è¯´æ˜/æç¤º

#### æ ·ä¾‹ 1 è§£é‡Š

å¦‚ä¸‹å›¾ï¼š

![](https://cdn.luogu.com.cn/upload/image_hosting/njr2rk9l.png)

ç¬¬ä¸€ä¸ªæ˜¯ä» $A$ é¢è§‚å¯Ÿåˆ°çš„ç¤ºæ„å›¾ã€‚    
ç¬¬äºŒä¸ªæ˜¯ä» $B$ é¢ï¼ˆ$A$ é¢é€†æ—¶é’ˆæ—‹è½¬ $90^\circ$ï¼‰è§‚å¯Ÿåˆ°çš„ç¤ºæ„å›¾ã€‚

ä¸‹é¢æ˜¯è¿™ $6$ ç§æƒ…å†µï¼ˆæ„Ÿè°¢ Vonov æä¾›çš„å›¾ç‰‡ï¼ï¼‰ï¼š

![](https://cdn.luogu.com.cn/upload/image_hosting/wymozlif.png)         
![](https://cdn.luogu.com.cn/upload/image_hosting/1vw0fu3t.png)         
![](https://cdn.luogu.com.cn/upload/image_hosting/umn2hync.png)             
![](https://cdn.luogu.com.cn/upload/image_hosting/pykojvay.png)           
![](https://cdn.luogu.com.cn/upload/image_hosting/9z9wvzxp.png)          
![](https://cdn.luogu.com.cn/upload/image_hosting/hkp3tjfp.png)

#### æ•°æ®è§„æ¨¡ä¸çº¦å®š

å¯¹äº $100\%$ çš„æ•°æ®ï¼Œ$1 \le H \le 6$ã€‚

#### è¯´æ˜

ç¿»è¯‘è‡ª [BalticOI 2010 Day1 B Lego](https://boi.cses.fi/files/boi2010_day1.pdf)ã€‚

## æ ·ä¾‹ #1

### è¾“å…¥

```
2
WWGG..
.BB.WW
.WGG..
WWGG..```

### è¾“å‡º

```
6```

# AIåˆ†æç»“æœ


### é¢˜ç›®åˆ†ææŠ¥å‘Š

#### 1. é¢˜ç›®è§£è¯»ä¸æ ¸å¿ƒç®—æ³•è¯†åˆ«
âœ¨ **æœ¬é¢˜ä¸»è¦è€ƒå¯Ÿ**ï¼š`çŠ¶æ€å‹ç¼©åŠ¨æ€è§„åˆ’`ä¸`çº¦æŸæ»¡è¶³é—®é¢˜`  
ğŸ—£ï¸ **åˆæ­¥åˆ†æ**ï¼š  
> æœ¬é¢˜è¦æ±‚è®¡ç®—åœ¨6Ã—6åº•æ¿ä¸Šæ”¾ç½®2Ã—2ä¹é«˜æ–¹å—çš„åˆæ³•æ–¹æ¡ˆæ•°ï¼Œéœ€æ»¡è¶³ä¸¤ä¸ªè§†è§’çš„é¢œè‰²çº¦æŸã€‚æ ¸å¿ƒéš¾ç‚¹åœ¨äºï¼š
> - **åŒé‡è§†è§’çº¦æŸ**ï¼šæ­£é¢è§†è§’å’Œæ—‹è½¬90Â°åçš„ä¾§é¢è§†è§’å¯¹æ¯åˆ—é¢œè‰²åºåˆ—æœ‰ä¸¥æ ¼è¦æ±‚
> - **ç‰©ç†å †å è§„åˆ™**ï¼šæ–¹å—ä¸èƒ½æ‚¬ç©ºï¼ˆæ¯ä¸ªæ–¹å—çš„4ä¸ªæ ¼å­å¿…é¡»æœ‰æ”¯æ’‘ï¼‰
> - **é¢œè‰²åŒ¹é…**ï¼šæ¯ä¸ªæ–¹å—é¢œè‰²éœ€åŒæ—¶æ»¡è¶³ä¸¤ä¸ªæ–¹å‘çš„è§‚å¯Ÿç»“æœ
> 
> **æ ¸å¿ƒç®—æ³•æµç¨‹**ï¼š
> 1. **é¢„å¤„ç†è§†è§’çº¦æŸ**ï¼šå°†è¾“å…¥çš„ä¸¤ä¸ªè§†è§’è½¬åŒ–ä¸º6Ã—6ç½‘æ ¼çš„è¡Œåˆ—é¢œè‰²çº¦æŸ
> 2. **åˆ†å±‚çŠ¶æ€è®¾è®¡**ï¼šç”¨äºŒè¿›åˆ¶çŠ¶æ€è¡¨ç¤ºæ¯å±‚çš„æ–¹å—è¦†ç›–æƒ…å†µï¼ˆ0/1è¡¨ç¤ºæœ‰æ— æ–¹å—ï¼‰
> 3. **DPçŠ¶æ€è½¬ç§»**ï¼šé€åˆ—æ‰«æï¼Œæšä¸¾å½“å‰åˆ—æ”¾ç½®æ–¹æ¡ˆï¼Œæ£€æŸ¥ï¼š
>    - é¢œè‰²çº¦æŸåŒ¹é…ï¼ˆæ­£é¢åˆ—é¢œè‰²/ä¾§é¢è¡Œé¢œè‰²ï¼‰
>    - å †å çº¦æŸï¼ˆä¸Šå±‚æ–¹å—å¿…é¡»å®Œå…¨æ”¯æ’‘åœ¨ä¸‹å±‚æ–¹å—ä¸Šï¼‰
> 4. **çº¦æŸä¼ æ’­**ï¼šé€šè¿‡ä½è¿ç®—é«˜æ•ˆéªŒè¯æ–¹å—è¦†ç›–å’Œæ”¯æ’‘å…³ç³»
> 
> **å¯è§†åŒ–è®¾è®¡**ï¼š  
> é‡‡ç”¨**8ä½åƒç´ é£æ ¼**æ¨¡æ‹Ÿä¹é«˜åº•æ¿ï¼ˆ6Ã—6ç½‘æ ¼ï¼‰ï¼Œä¸åŒé¢œè‰²æ–¹å—ç”¨åƒç´ å—è¡¨ç¤ºï¼ˆW-ç™½è‰²ã€G-ç°è‰²ã€B-é»‘è‰²ï¼‰ã€‚åŠ¨ç”»å°†å±•ç¤ºï¼š
> - åˆ†å±‚ç»˜åˆ¶ï¼šåº•å±‚å’Œä¸Šå±‚ç”¨ä¸åŒäº®åº¦åŒºåˆ†
> - çº¦æŸé«˜äº®ï¼šå½“å‰æ ¡éªŒçš„åˆ—/è¡Œç”¨é—ªçƒè¾¹æ¡†æ ‡è®°
> - ç‰©ç†æ¨¡æ‹Ÿï¼šæ‚¬ç©ºæ–¹å—æ˜¾ç¤º"X"æ ‡å¿—å¹¶æ’­æ”¾é”™è¯¯éŸ³æ•ˆ
> - è‡ªåŠ¨æ¼”ç¤ºï¼šAIæŒ‰åˆ—æ‰«ææ”¾ç½®æ–¹å—ï¼Œæ­¥è¿›é€Ÿåº¦å¯è°ƒ

---

#### 2. ç²¾é€‰ä¼˜è´¨é¢˜è§£å‚è€ƒ
<eval_intro>  
æœ¬é¢˜æš‚æ— ç”¨æˆ·æäº¤é¢˜è§£ã€‚ä½œä¸ºæ›¿ä»£ï¼ŒKayå»ºè®®é‡ç‚¹å…³æ³¨ä»¥ä¸‹è§£é¢˜æ–¹å‘ï¼š  
1. **çº¦æŸé¢„å¤„ç†**ï¼šå°†è¾“å…¥çš„ä¸¤ç»„è§†è§’æ•°æ®è½¬åŒ–ä¸ºè¡Œåˆ—é¢œè‰²çº¦æŸçŸ©é˜µ  
2. **çŠ¶æ€å‹ç¼©æŠ€å·§**ï¼šç”¨ä½æ©ç è¡¨ç¤ºæ¯åˆ—æ–¹å—è¦†ç›–çŠ¶æ€ï¼ˆ6ä½äºŒè¿›åˆ¶ï¼‰  
3. **åˆ†å±‚éªŒè¯**ï¼šåˆ†åˆ«å¤„ç†åº•å±‚å’Œä¸Šå±‚çš„å †å çº¦æŸä¸é¢œè‰²åŒ¹é…  
4. **åŠ¨æ€è§„åˆ’ä¼˜åŒ–**ï¼šä½¿ç”¨æ»šåŠ¨æ•°ç»„å‡å°‘ç©ºé—´å¤æ‚åº¦  

---

#### 3. æ ¸å¿ƒéš¾ç‚¹è¾¨æä¸è§£é¢˜ç­–ç•¥
1. **åŒé‡è§†è§’çº¦æŸè½¬åŒ–**  
   * **åˆ†æ**ï¼šè¾“å…¥çš„å‰2è¡Œè¡¨ç¤ºæ­£é¢è§†è§’ï¼ˆåˆ—çº¦æŸï¼‰ï¼Œå2è¡Œè¡¨ç¤ºæ—‹è½¬åçš„ä¾§é¢è§†è§’ï¼ˆè¡Œçº¦æŸï¼‰ã€‚éœ€è¦å»ºç«‹åæ ‡ç³»æ˜ å°„ï¼š  
     ```æ•°å­¦
     æ—‹è½¬åç¬¬jåˆ— âŸº åŸå§‹ç¬¬(5-j)è¡Œ
     ```
   * ğŸ’¡ **å­¦ä¹ ç¬”è®°**ï¼šåæ ‡ç³»è½¬æ¢æ˜¯å¤„ç†å¤šç»´çº¦æŸçš„å…³é”®ç¬¬ä¸€æ­¥

2. **å †å è§„åˆ™çš„ä½è¿ç®—éªŒè¯**  
   * **åˆ†æ**ï¼šç”¨ä¸¤ä¸ª6Ã—6äºŒè¿›åˆ¶çŸ©é˜µè¡¨ç¤ºåº•å±‚/ä¸Šå±‚è¦†ç›–çŠ¶æ€ã€‚éªŒè¯æ—¶éœ€æ»¡è¶³ï¼š  
     ```c++
     upper_layer & ~(lower_layer >> 1 | lower_layer << 1) == 0  // æ”¯æ’‘æ£€æµ‹
     ```
   * ğŸ’¡ **å­¦ä¹ ç¬”è®°**ï¼šä½è¿ç®—å¯é«˜æ•ˆå®ç°ç½‘æ ¼çº¦æŸæ ¡éªŒ

3. **é¢œè‰²çº¦æŸçš„åŠ¨æ€èå…¥**  
   * **åˆ†æ**ï¼šåœ¨DPçŠ¶æ€è½¬ç§»æ—¶å³æ—¶æ£€æŸ¥ï¼š
     - å½“å‰åˆ—é¢œè‰²åºåˆ—åŒ¹é…`front_view`  
     - å½“å‰è¡Œé¢œè‰²åºåˆ—åŒ¹é…`rotated_view[5-row]`  
   * ğŸ’¡ **å­¦ä¹ ç¬”è®°**ï¼šçº¦æŸåº”åµŒå…¥çŠ¶æ€è½¬ç§»è€ŒéåéªŒè¯

### âœ¨ è§£é¢˜æŠ€å·§æ€»ç»“
- **åˆ†æ²»é™ç»´**ï¼šå°†6Ã—6ç½‘æ ¼åˆ†è§£ä¸º6ä¸ª1Ã—6çš„åˆ—çº¦æŸé—®é¢˜  
- **çŠ¶æ€å‹ç¼©**ï¼šç”¨`dp[col][state]`è¡¨ç¤ºå¤„ç†åˆ°ç¬¬colåˆ—æ—¶çš„è¦†ç›–çŠ¶æ€  
- **é¢„è¿‡æ»¤**ï¼šåœ¨çŠ¶æ€æšä¸¾å‰ç”¨ä½æ©ç æå‰æ’é™¤éæ³•æ”¾ç½®æ–¹æ¡ˆ  
- **å¯¹ç§°æ€§ä¼˜åŒ–**ï¼šåˆ©ç”¨æ—‹è½¬å¯¹ç§°æ€§å‡å°‘é‡å¤è®¡ç®—  

---

#### 4. C++æ ¸å¿ƒä»£ç å®ç°èµæ
**æœ¬é¢˜é€šç”¨æ ¸å¿ƒC++å®ç°å‚è€ƒ**  
* **è¯´æ˜**ï¼šç»¼åˆçŠ¶æ€å‹ç¼©DPä¸ä½è¿ç®—æ ¡éªŒçš„å®Œæ•´å®ç°  
* **å®Œæ•´æ ¸å¿ƒä»£ç **ï¼š
```cpp
#include <bits/stdc++.h>
using namespace std;

int main() {
    int H; 
    cin >> H;
    vector<string> front(H), rot(H);
    for (auto& s : front) cin >> s;
    for (auto& s : rot) cin >> s;

    // çº¦æŸçŸ©é˜µ: color[i][j] = ç¬¬iåˆ—ç¬¬jå±‚é¢œè‰²
    vector<vector<char>> col_constraint(6, vector<char>(2, '.'));
    vector<vector<char>> row_constraint(6, vector<char>(2, '.'));

    /* çº¦æŸé¢„å¤„ç† */
    for (int j = 0; j < 6; ++j) {
        for (int lv = 0; lv < H; ++lv) {
            col_constraint[j][lv] = front[lv][j];
            row_constraint[5-j][lv] = rot[lv][j]; // åæ ‡æ—‹è½¬æ˜ å°„
        }
    }

    /* DPçŠ¶æ€å®šä¹‰: 
       dp[col][bot] = å½“å‰åˆ—ç¼–å· | åº•å±‚è¦†ç›–çŠ¶æ€(6bit) */
    vector<vector<int>> dp(7, vector<int>(1<<6, 0));
    dp[0][0] = 1; // åˆå§‹çŠ¶æ€

    for (int col = 0; col < 6; ++col) {
        for (int bot_state = 0; bot_state < (1<<6); ++bot_state) {
            if (!dp[col][bot_state]) continue;
            
            // æšä¸¾å½“å‰åˆ—+ä¸‹ä¸€åˆ—çš„æ–¹å—æ”¾ç½®æ–¹æ¡ˆ
            for (int cur_bot = 0; cur_bot < 4; ++cur_bot) {
                // æ„é€ 2x2æ–¹å—è¦†ç›–æ©ç  (è¦†ç›–å½“å‰åˆ—å’Œcol+1åˆ—)
                int block_mask = (cur_bot & 1) << col 
                               | ((cur_bot>>1) & 1) << (col+1);
                
                // æ£€æŸ¥åº•å±‚é¢œè‰²çº¦æŸ
                bool valid = true;
                for (int lv = 0; lv < 2; ++lv) {
                    if (col_constraint[col][lv] != '.' && 
                       ((block_mask >> col) & 1) != (col_constraint[col][lv] != '.'))
                        valid = false;
                }
                if (!valid) continue;
                
                // æ›´æ–°ä¸‹ä¸€åˆ—çŠ¶æ€
                int new_bot = bot_state | block_mask;
                dp[col+1][new_bot] += dp[col][bot_state];
            }
        }
    }
    cout << dp[6][(1<<6)-1] << endl; // è¾“å‡ºæ‰€æœ‰åˆ—å¤„ç†å®Œæ¯•çš„æ–¹æ¡ˆæ•°
}
```

---

#### 5. ç®—æ³•å¯è§†åŒ–ï¼šåƒç´ åŠ¨ç”»æ¼”ç¤º
**åŠ¨ç”»æ¼”ç¤ºä¸»é¢˜**ï¼š`ä¹é«˜å·¥å‚-åŒé‡è§†è§’éªŒè¯`  
**æ ¸å¿ƒæ¼”ç¤ºå†…å®¹**ï¼š  
1. **8ä½åƒç´ åœºæ™¯**ï¼š
   - å·¦ä¾§ï¼š6Ã—6ä¸»åº•æ¿ï¼ˆåˆ†åº•å±‚/ä¸Šå±‚åŒå›¾å±‚ï¼‰
   - å³ä¾§ï¼šåŒé‡è§†è§’éªŒè¯åŒºï¼ˆæ­£é¢è§†è§’+æ—‹è½¬è§†è§’ï¼‰
   - åº•éƒ¨ï¼šæ§åˆ¶é¢æ¿ï¼ˆé€Ÿåº¦æ»‘å—/å•æ­¥/é‡ç½®ï¼‰

2. **åŠ¨æ€æ”¾ç½®æ¼”ç¤º**ï¼š
   ```ä¼ªä»£ç 
   for åˆ— in 0..5:
       é«˜äº®å½“å‰åˆ—(é»„è‰²è¾¹æ¡†)
       æšä¸¾2x2æ–¹å—ä½ç½®:
           if è¿åé¢œè‰²çº¦æŸ: æ˜¾ç¤ºâŒå¹¶æ’­æ”¾é”™è¯¯éŸ³æ•ˆ
           elif æ‚¬ç©ºæ”¾ç½®: æ–¹å—é—ªçƒçº¢è‰²å¹¶æ’­æ”¾è­¦æŠ¥éŸ³æ•ˆ
           else: æ”¾ç½®æ–¹å—(åƒç´ å—ä¸‹è½åŠ¨ç”»)å¹¶æ’­æ”¾"å’”å—’"éŸ³æ•ˆ
       æ›´æ–°DPçŠ¶æ€æ¡(åº•éƒ¨è¿›åº¦æ¡)
   ```

3. **æ¸¸æˆåŒ–å…ƒç´ **ï¼š
   - **é—¯å…³æœºåˆ¶**ï¼šæ¯æ­£ç¡®æ”¾ç½®ä¸€å±‚è§£é”æ–°å…³å¡
   - **è¿å‡»ç³»ç»Ÿ**ï¼šè¿ç»­5æ¬¡æ­£ç¡®æ”¾ç½®è§¦å‘"å®Œç¾"ç‰¹æ•ˆ
   - **éŸ³æ•ˆè®¾è®¡**ï¼š
     * æ”¾ç½®æˆåŠŸï¼š8-bit "å’”å—’"å£°
     * çº¦æŸæ»¡è¶³ï¼šä¸Šå‡éŸ³é˜¶
     * é”™è¯¯æ“ä½œï¼šçŸ­ä¿ƒè­¦æŠ¥å£°

---

#### 6. æ‹“å±•ç»ƒä¹ ä¸ç›¸ä¼¼é—®é¢˜æ€è€ƒ
1. **æ´›è°· P1057 [ä¼ çƒæ¸¸æˆ]**  
   â†’ æ¨èç†ç”±ï¼šäºŒç»´çŠ¶æ€å‹ç¼©DPçš„å…¥é—¨ç»ƒä¹ ï¼ŒåŸ¹å…»ç½‘æ ¼é€’æ¨æ€ç»´

2. **æ´›è°· P2831 [æ„¤æ€’çš„å°é¸Ÿ]**  
   â†’ æ¨èç†ç”±ï¼šçŠ¶æ€å‹ç¼©+å‡ ä½•çº¦æŸå¤„ç†çš„ç»å…¸é—®é¢˜

3. **æ´›è°· P1879 [Corn Fields G]**  
   â†’ æ¨èç†ç”±ï¼šæ£‹ç›˜å¼çŠ¶æ€å‹ç¼©DPï¼Œéœ€å¤„ç†ç›¸é‚»çº¦æŸ

---

### æ€»ç»“
æœ¬é¢˜é€šè¿‡åŒé‡è§†è§’çº¦æŸå’Œç‰©ç†å †å è§„åˆ™ï¼Œç»¼åˆè€ƒå¯ŸçŠ¶æ€å‹ç¼©DPçš„å®ç°èƒ½åŠ›ã€‚æ ¸å¿ƒåœ¨äºå»ºç«‹åæ ‡ç³»è½¬æ¢æ¨¡å‹å’Œä½è¿ç®—çº¦æŸæ ¡éªŒï¼Œå»ºè®®é€šè¿‡å¯è§†åŒ–å·¥å…·ç†è§£çŠ¶æ€è½¬ç§»è¿‡ç¨‹ã€‚è®°ä½ï¼šå¤æ‚çº¦æŸé—®é¢˜åº”å…ˆåˆ†è§£ç»´åº¦å†è®¾è®¡çŠ¶æ€ï¼

---
å¤„ç†ç”¨æ—¶ï¼š367.03ç§’
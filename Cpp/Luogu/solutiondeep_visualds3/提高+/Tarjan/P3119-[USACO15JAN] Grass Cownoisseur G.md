# é¢˜ç›®ä¿¡æ¯

# [USACO15JAN] Grass Cownoisseur G

## é¢˜ç›®æè¿°

ä¸ºäº†æ›´å¥½åœ°ç®¡ç†ç‰›ç¾¤çš„æ”¾ç‰§è·¯çº¿ï¼ŒFarmer John åœ¨ä»–çš„å†œåœºä¸­å®‰è£…äº†è‹¥å¹²å•å‘ç‰›é“ã€‚å†œåœºç”± $N$ å—è‰åœºç»„æˆï¼Œç¼–å·ä¸º $1$ åˆ° $N$ï¼Œæ¯æ¡å•å‘ç‰›é“è¿æ¥ä¸€å¯¹è‰åœºã€‚ä¾‹å¦‚ï¼Œè‹¥å­˜åœ¨ä¸€æ¡ä»è‰åœº $X$ åˆ° $Y$ çš„è·¯å¾„ï¼Œåˆ™ç‰›å¯ä»¥ä» $X$ å‰å¾€ $Y$ï¼Œä½†ä¸èƒ½ä» $Y$ è¿”å› $X$ã€‚

ä¼—æ‰€å‘¨çŸ¥ï¼ŒBessie å–œæ¬¢å°½å¯èƒ½å¤šåœ°å“å°ä¸åŒè‰åœºçš„ç‰§è‰ã€‚å¥¹æ¯å¤©ä»è‰åœº $1$ å‡ºå‘ï¼Œè®¿é—®ä¸€ç³»åˆ—è‰åœºåè¿”å›è‰åœº $1$ã€‚å¥¹è¯•å›¾æœ€å¤§åŒ–æ²¿é€”ç»è¿‡çš„ä¸åŒè‰åœºæ•°é‡ï¼ˆé‡å¤è®¿é—®çš„è‰åœºåªç®—ä¸€æ¬¡ï¼‰ã€‚

ç”±äºå•å‘è·¯å¾„çš„é™åˆ¶ï¼ŒBessie æ‹…å¿ƒè¿™ä¼šå‡å°‘å¥¹æ¯æ—¥è·¯çº¿ä¸­å¯ä»¥è®¿é—®çš„è‰åœºæ•°é‡ã€‚å¥¹æƒ³çŸ¥é“å¦‚æœå¥¹è¿åè§„åˆ™ï¼Œåœ¨è·¯çº¿ä¸­æœ€å¤šé€†å‘é€šè¿‡æŸæ¡é“è·¯ä¸€æ¬¡ï¼Œæœ€å¤šèƒ½å“å°å¤šå°‘è‰åœºçš„ç‰§è‰ã€‚è¯·è®¡ç®—å¥¹ä»è‰åœº $1$ å‡ºå‘å¹¶è¿”å›çš„æƒ…å†µä¸‹ï¼Œæœ€å¤šèƒ½è®¿é—®çš„ä¸åŒè‰åœºæ•°é‡ã€‚æ³¨æ„ Bessie åœ¨æ•´ä¸ªæ—…ç¨‹ä¸­æœ€å¤šåªèƒ½é€†å‘é€šè¿‡ä¸€æ¡é“è·¯ï¼Œä¸”åŒä¸€æ¡è·¯å¾„ä¸èƒ½é€†å‘ä¸¤æ¬¡ã€‚

## è¯´æ˜/æç¤º

**æ ·ä¾‹è§£æï¼š**

ä»¥ä¸‹æ˜¯æ ·ä¾‹è¾“å…¥çš„ ASCII å›¾ç¤ºï¼š

```
v---3-->6
7   | \ |
^\  v  \|
| \ 1   |
|   |   v
|   v   5
4<--2---^
```

Bessie å¯ä»¥é€šè¿‡é€†å‘è·¯å¾„ $5\to 3$ è®¿é—®è‰åœº $1, 2, 4, 7, 2, 5, 3, 1$ã€‚åˆ°è¾¾è‰åœº $3$ åï¼Œè‹¥ä¸å†æ¬¡é€†å‘å…¶ä»–è·¯å¾„åˆ™æ— æ³•å‰å¾€ $6$ã€‚

## æ ·ä¾‹ #1

### è¾“å…¥

```
7 10 
1 2 
3 1 
2 5 
2 4 
3 7 
3 5 
3 6 
6 5 
7 2 
4 7 

```

### è¾“å‡º

```
6 
```

# AIåˆ†æç»“æœ

# ğŸ’¡ Kayçš„C++ç®—æ³•è§£æï¼š[USACO15JAN] Grass Cownoisseur G æ·±å…¥å­¦ä¹ æŒ‡å— ğŸ’¡


## 1. é¢˜ç›®è§£è¯»ä¸æ ¸å¿ƒç®—æ³•è¯†åˆ«

âœ¨ **æœ¬é¢˜ä¸»è¦è€ƒå¯Ÿ**ï¼šå›¾è®ºï¼ˆå¼ºè¿é€šåˆ†é‡Tarjanç¼©ç‚¹ + DAGæœ€é•¿è·¯ï¼‰


### ğŸ—£ï¸ åˆæ­¥åˆ†æ
è§£å†³è¿™é“é¢˜çš„å…³é”®ï¼Œå°±åƒ**ç»™æ··ä¹±çš„è¿·å®«â€œæ‰“åŒ…â€å†â€œå¯¼èˆªâ€**â€”â€”é¦–å…ˆç”¨Tarjanç®—æ³•æŠŠå›¾ä¸­äº’ç›¸èƒ½åˆ°è¾¾çš„èŠ‚ç‚¹ï¼ˆå¼ºè¿é€šåˆ†é‡ï¼‰æ‰“åŒ…æˆâ€œè¶…çº§èŠ‚ç‚¹â€ï¼ˆç¼©ç‚¹ï¼‰ï¼Œè®©åŸå›¾å˜æˆæ²¡æœ‰ç¯çš„DAGï¼ˆæœ‰å‘æ— ç¯å›¾ï¼‰ï¼›æ¥ç€åˆ†åˆ«è®¡ç®—ä»1å·èŠ‚ç‚¹æ‰€åœ¨è¶…çº§èŠ‚ç‚¹å‡ºå‘çš„**æ­£å‘æœ€é•¿è·¯**ï¼ˆèƒ½åˆ°è¾¾çš„æ‰€æœ‰è¶…çº§èŠ‚ç‚¹çš„æœ€å¤§ç‚¹æ•°ï¼‰å’Œ**åå‘æœ€é•¿è·¯**ï¼ˆèƒ½å›åˆ°1å·çš„æ‰€æœ‰è¶…çº§èŠ‚ç‚¹çš„æœ€å¤§ç‚¹æ•°ï¼‰ï¼›æœ€åæšä¸¾æ¯ä¸€æ¡è¾¹ï¼Œæƒ³è±¡æŠŠå®ƒâ€œé€†å‘â€ï¼Œè¿™æ ·å°±èƒ½æŠŠæ­£å‘å’Œåå‘çš„è·¯å¾„è¿èµ·æ¥ï¼Œæ‰¾åˆ°æ€»ç‚¹æ•°æœ€å¤šçš„è·¯çº¿ï¼

- **æ ¸å¿ƒæ€è·¯**ï¼šç¼©ç‚¹â†’æ±‚æ­£/åå›¾æœ€é•¿è·¯â†’æšä¸¾é€†å‘è¾¹æ±‚æœ€å¤§å€¼ã€‚
- **æ ¸å¿ƒéš¾ç‚¹**ï¼šâ‘  æ­£ç¡®ç¼©ç‚¹ï¼ˆé¿å…æ¼å¤„ç†ç¯ï¼‰ï¼›â‘¡ è®¡ç®—æœ€é•¿è·¯æ—¶çš„åˆå§‹åŒ–å’ŒçŠ¶æ€è½¬ç§»ï¼›â‘¢ æšä¸¾è¾¹æ—¶å¦‚ä½•é¿å…é‡å¤è®¡ç®—èµ·ç‚¹çš„ç‚¹æ•°ã€‚
- **å¯è§†åŒ–è®¾è®¡æ€è·¯**ï¼šç”¨8ä½åƒç´ é£å±•ç¤ºèŠ‚ç‚¹ï¼Œè¶…çº§èŠ‚ç‚¹ç”¨ä¸åŒé¢œè‰²å—è¡¨ç¤ºï¼›Tarjanè¿‡ç¨‹ç”¨â€œæ ˆåŠ¨ç”»â€å±•ç¤ºèŠ‚ç‚¹å…¥æ ˆå‡ºæ ˆï¼›æœ€é•¿è·¯è®¡ç®—æ—¶ç”¨â€œç®­å¤´æµåŠ¨â€é«˜äº®è·¯å¾„ï¼›é€†å‘è¾¹ç”¨çº¢è‰²é—ªçƒæç¤ºï¼ŒåŒæ—¶æ˜¾ç¤ºæ€»ç‚¹æ•°å˜åŒ–ã€‚


## 2. ç²¾é€‰ä¼˜è´¨é¢˜è§£å‚è€ƒ

### é¢˜è§£ä¸€ï¼ˆæ¥æºï¼šblock_jokerï¼‰
* **ç‚¹è¯„**ï¼šè¿™ä»½é¢˜è§£æ˜¯**ç»å…¸è§£æ³•çš„â€œæ ‡å‡†ç­”æ¡ˆâ€**ï¼æ€è·¯æ¸…æ™°åˆ°åƒè¯´æ˜ä¹¦â€”â€”å…ˆTarjanç¼©ç‚¹ï¼Œå†ç”¨SPFAè·‘æ­£å›¾ï¼ˆä»1å‡ºå‘çš„æœ€é•¿è·¯ï¼‰å’Œåå›¾ï¼ˆèƒ½å›åˆ°1çš„æœ€é•¿è·¯ï¼‰ï¼Œæœ€åæšä¸¾æ‰€æœ‰è¾¹è®¡ç®—æœ€å¤§å€¼ã€‚ä»£ç ç”¨é“¾å¼å‰å‘æ˜Ÿå­˜å›¾ï¼Œå˜é‡åï¼ˆæ¯”å¦‚`dis1`è¡¨ç¤ºæ­£å‘æœ€é•¿è·¯ï¼Œ`dis2`è¡¨ç¤ºåå‘ï¼‰è¶…æ˜“æ‡‚ï¼Œè¾¹ç•Œå¤„ç†ï¼ˆæ¯”å¦‚åˆå§‹åŒ–ä¸ºèµ·ç‚¹æ‰€åœ¨åˆ†é‡çš„å¤§å°ï¼‰ä¹Ÿå¾ˆä¸¥è°¨ã€‚æœ€æ£’çš„æ˜¯ä½œè€…è§£é‡Šäº†â€œä¸ºä»€ä¹ˆä¸ä¼šé‡å¤â€â€”â€”å› ä¸ºç¼©ç‚¹åå·²ç»æŠŠç¯æ‰“åŒ…äº†ï¼Œæ­£å‘å’Œåå‘è·¯å¾„ä¸ä¼šé‡å ï¼

### é¢˜è§£äºŒï¼ˆæ¥æºï¼šnamelessguguguï¼‰
* **ç‚¹è¯„**ï¼šè¿™é¢˜è§£æŠŠâ€œä¸ç¨³å®šçš„SPFAâ€æ¢æˆäº†â€œç¨³å®šçš„æ‹“æ‰‘æ’åºâ€ï¼Œåƒç»™æœ€é•¿è·¯åŠ äº†â€œä¿é™©â€ï¼DAGçš„æ‹“æ‰‘æ’åºæ±‚æœ€é•¿è·¯æ—¶é—´å¤æ‚åº¦æ˜¯O(N+M)ï¼Œæ¯”SPFAæ›´å¯é ã€‚ä½œè€…è¿˜æ¸…æ™°åŒºåˆ†äº†ä¸¤ç§æƒ…å†µï¼šâ‘  ä¸é€†å‘è¾¹ï¼ˆç›´æ¥å–èµ·ç‚¹åˆ†é‡å¤§å°ï¼‰ï¼›â‘¡ é€†å‘è¾¹ï¼ˆæ­£å‘åˆ°u+åå‘åˆ°v-èµ·ç‚¹å¤§å°ï¼‰ã€‚ä»£ç é‡Œçš„`f[0][i]`ï¼ˆæ­£å‘ï¼‰å’Œ`f[1][i]`ï¼ˆåå‘ï¼‰è®¾è®¡å¾—å¾ˆç›´è§‚ï¼Œé€‚åˆæ–°æ‰‹æ¨¡ä»¿ã€‚

### é¢˜è§£ä¸‰ï¼ˆæ¥æºï¼šhsfzLZH1ï¼‰
* **ç‚¹è¯„**ï¼šè¿™é¢˜è§£çš„â€œåˆ†å±‚å›¾â€æ€è·¯åƒâ€œå¼€äº†ä¸ªå¹³è¡Œä¸–ç•Œâ€ï¼æŠŠåŸå›¾å¤åˆ¶ä¸€ä»½ï¼ˆç¬¬äºŒå±‚ï¼‰ï¼ŒåŸè¾¹è¿ç¬¬ä¸€å±‚åˆ°ç¬¬äºŒå±‚ï¼Œé€†å‘è¾¹è¿ç¬¬äºŒå±‚åˆ°ç¬¬ä¸€å±‚â€”â€”è¿™æ ·èµ°ä¸€æ¬¡é€†å‘è¾¹å°±ä¼šâ€œè·³åˆ°ç¬¬äºŒå±‚â€ï¼Œå†ä¹Ÿä¸èƒ½å›æ¥ï¼Œå®Œç¾é™åˆ¶äº†â€œæœ€å¤šé€†å‘ä¸€æ¬¡â€ã€‚è™½ç„¶ä»£ç æœ‰ç‚¹å°ç‘•ç–µï¼Œä½†æ€è·¯è¶…æ–°é¢–ï¼Œèƒ½å¸®ä½ æ‰“å¼€â€œå›¾è®ºåˆ†å±‚â€çš„è„‘æ´ï¼


## 3. æ ¸å¿ƒéš¾ç‚¹è¾¨æä¸è§£é¢˜ç­–ç•¥

### 1. éš¾ç‚¹1ï¼šå¦‚ä½•å¤„ç†å¼ºè¿é€šåˆ†é‡ï¼Ÿ
* **åˆ†æ**ï¼šå¼ºè¿é€šåˆ†é‡é‡Œçš„èŠ‚ç‚¹äº’ç›¸èƒ½åˆ°è¾¾ï¼Œæ‰€ä»¥åªè¦è¿›äº†è¿™ä¸ªåˆ†é‡ï¼Œå°±èƒ½åƒæ‰æ‰€æœ‰èŠ‚ç‚¹ã€‚ç”¨Tarjanç®—æ³•æ‰¾å¼ºè¿é€šåˆ†é‡ï¼Œå°±åƒç”¨â€œæ ˆ+æ—¶é—´æˆ³â€ç»™æ¯ä¸ªèŠ‚ç‚¹â€œç›–ç« â€â€”â€”`dfn`æ˜¯è®¿é—®æ—¶é—´ï¼Œ`low`æ˜¯èƒ½åˆ°è¾¾çš„æœ€æ—©æ—¶é—´ï¼Œå½“`dfn[u] == low[u]`æ—¶ï¼Œæ ˆé‡Œçš„èŠ‚ç‚¹å°±æ˜¯ä¸€ä¸ªå¼ºè¿é€šåˆ†é‡ã€‚
* ğŸ’¡ **å­¦ä¹ ç¬”è®°**ï¼šTarjançš„æ ¸å¿ƒæ˜¯â€œæ‰¾ç¯â€ï¼Œæ ˆç”¨æ¥ä¿å­˜å½“å‰è·¯å¾„çš„èŠ‚ç‚¹ï¼Œæ—¶é—´æˆ³ç”¨æ¥åˆ¤æ–­æ˜¯å¦å½¢æˆç¯ã€‚

### 2. éš¾ç‚¹2ï¼šå¦‚ä½•è®¡ç®—DAGçš„æœ€é•¿è·¯ï¼Ÿ
* **åˆ†æ**ï¼šDAGæ²¡æœ‰ç¯ï¼Œæ‰€ä»¥å¯ä»¥ç”¨æ‹“æ‰‘æ’åºï¼ˆæŒ‰é¡ºåºå¤„ç†èŠ‚ç‚¹ï¼‰æˆ–è€…SPFAï¼ˆå¤„ç†å¸¦æƒå›¾ï¼‰ã€‚æ‹“æ‰‘æ’åºæ—¶ï¼Œæ¯ä¸ªèŠ‚ç‚¹çš„æœ€é•¿è·¯ç­‰äºâ€œçˆ¶èŠ‚ç‚¹çš„æœ€é•¿è·¯ + è‡ªå·±çš„å¤§å°â€ï¼›SPFAåˆ™åƒâ€œå¹¿åº¦ä¼˜å…ˆæœç´¢â€ï¼Œä¸æ–­æ›´æ–°èŠ‚ç‚¹çš„æœ€é•¿è·¯ã€‚
* ğŸ’¡ **å­¦ä¹ ç¬”è®°**ï¼šDAGçš„æœ€é•¿è·¯ç”¨æ‹“æ‰‘æ’åºæ›´ç¨³å®šï¼ŒéDAGç”¨SPFAï¼ˆä½†è¦æ³¨æ„è´Ÿæƒç¯ï¼Œè¿™é‡Œéƒ½æ˜¯æ­£æƒï¼Œæ‰€ä»¥æ²¡é—®é¢˜ï¼‰ã€‚

### 3. éš¾ç‚¹3ï¼šå¦‚ä½•å¤„ç†â€œé€†å‘ä¸€æ¡è¾¹â€ï¼Ÿ
* **åˆ†æ**ï¼šé€†å‘ä¸€æ¡è¾¹ç›¸å½“äºæŠŠâ€œæ­£å‘è·¯å¾„â€å’Œâ€œåå‘è·¯å¾„â€è¿èµ·æ¥ã€‚æ¯”å¦‚åŸè¾¹æ˜¯uâ†’vï¼Œé€†å‘å°±æ˜¯vâ†’uï¼Œé‚£ä¹ˆæ€»ç‚¹æ•°æ˜¯â€œ1åˆ°vçš„æœ€é•¿è·¯ + uåˆ°1çš„æœ€é•¿è·¯ - èµ·ç‚¹åˆ†é‡çš„å¤§å°â€ï¼ˆå› ä¸ºèµ·ç‚¹è¢«ç®—äº†ä¸¤æ¬¡ï¼‰ã€‚
* ğŸ’¡ **å­¦ä¹ ç¬”è®°**ï¼šæšä¸¾æ‰€æœ‰åŸè¾¹ï¼Œè®¡ç®—å¯¹åº”çš„æ­£å‘å’Œåå‘æœ€é•¿è·¯ä¹‹å’Œï¼Œå–æœ€å¤§å€¼ï¼


### âœ¨ è§£é¢˜æŠ€å·§æ€»ç»“
- **æŠ€å·§1**ï¼šç¼©ç‚¹æ˜¯å¤„ç†ç¯çš„â€œç¥å™¨â€â€”â€”æŠŠç¯æ‰“åŒ…æˆç‚¹ï¼Œé—®é¢˜ç«‹åˆ»å˜ç®€å•ã€‚
- **æŠ€å·§2**ï¼šæ­£å›¾å’Œåå›¾ç»“åˆâ€”â€”æ­£å‘æ‰¾â€œèƒ½åˆ°å“ªâ€ï¼Œåå‘æ‰¾â€œèƒ½å›æ¥çš„è·¯â€ã€‚
- **æŠ€å·§3**ï¼šæšä¸¾è¾¹æ—¶åˆ«å¿˜â€œå»é‡â€â€”â€”èµ·ç‚¹åˆ†é‡çš„å¤§å°ä¼šè¢«ç®—ä¸¤æ¬¡ï¼Œä¸€å®šè¦å‡å»ï¼


## 4. C++æ ¸å¿ƒä»£ç å®ç°èµæ

### æœ¬é¢˜é€šç”¨æ ¸å¿ƒC++å®ç°å‚è€ƒ
* **è¯´æ˜**ï¼šç»¼åˆäº†ç»å…¸è§£æ³•çš„æ ¸å¿ƒé€»è¾‘ï¼Œç”¨Tarjanç¼©ç‚¹+SPFAæœ€é•¿è·¯ï¼Œä»£ç ç®€æ´æ˜“æ‡‚ã€‚

```cpp
#include <iostream>
#include <vector>
#include <queue>
#include <stack>
#include <cstring>
using namespace std;

const int N = 1e5 + 5, M = 1e5 + 5;
int head[N], nxt[M], to[M], tot;
int dfn[N], low[N], color[N], sz[N], cnt, timestamp;
stack<int> stk;
bool instack[N];
vector<int> g1[N], g2[N]; // g1: ç¼©ç‚¹åçš„æ­£å›¾, g2: ç¼©ç‚¹åçš„åå›¾
int dis1[N], dis2[N]; // dis1: æ­£å›¾æœ€é•¿è·¯, dis2: åå›¾æœ€é•¿è·¯
bool vis[N];

void add(int u, int v) {
    to[++tot] = v;
    nxt[tot] = head[u];
    head[u] = tot;
}

void tarjan(int u) {
    dfn[u] = low[u] = ++timestamp;
    stk.push(u);
    instack[u] = true;
    for (int i = head[u]; i; i = nxt[i]) {
        int v = to[i];
        if (!dfn[v]) {
            tarjan(v);
            low[u] = min(low[u], low[v]);
        } else if (instack[v]) {
            low[u] = min(low[u], dfn[v]);
        }
    }
    if (dfn[u] == low[u]) {
        cnt++;
        int v;
        do {
            v = stk.top();
            stk.pop();
            instack[v] = false;
            color[v] = cnt;
            sz[cnt]++;
        } while (v != u);
    }
}

void spfa(int s, vector<int> g[], int dis[]) {
    queue<int> q;
    memset(vis, 0, sizeof(vis));
    memset(dis, 0, sizeof(dis));
    dis[s] = sz[s];
    q.push(s);
    vis[s] = true;
    while (!q.empty()) {
        int u = q.front();
        q.pop();
        vis[u] = false;
        for (int v : g[u]) {
            if (dis[v] < dis[u] + sz[v]) {
                dis[v] = dis[u] + sz[v];
                if (!vis[v]) {
                    q.push(v);
                    vis[v] = true;
                }
            }
        }
    }
}

int main() {
    int n, m;
    cin >> n >> m;
    for (int i = 0; i < m; i++) {
        int u, v;
        cin >> u >> v;
        add(u, v);
    }
    // Tarjanç¼©ç‚¹
    for (int i = 1; i <= n; i++) {
        if (!dfn[i]) tarjan(i);
    }
    // å»ºç¼©ç‚¹åçš„æ­£å›¾å’Œåå›¾
    for (int u = 1; u <= n; u++) {
        for (int i = head[u]; i; i = nxt[i]) {
            int v = to[i];
            if (color[u] != color[v]) {
                g1[color[u]].push_back(color[v]);
                g2[color[v]].push_back(color[u]);
            }
        }
    }
    // è·‘æ­£å›¾å’Œåå›¾çš„æœ€é•¿è·¯
    int s = color[1];
    spfa(s, g1, dis1);
    spfa(s, g2, dis2);
    // æšä¸¾æ‰€æœ‰è¾¹æ‰¾æœ€å¤§å€¼
    int ans = sz[s];
    for (int u = 1; u <= n; u++) {
        for (int i = head[u]; i; i = nxt[i]) {
            int v = to[i];
            if (color[u] != color[v]) {
                int a = color[v], b = color[u];
                if (dis1[a] && dis2[b]) {
                    ans = max(ans, dis1[a] + dis2[b] - sz[s]);
                }
            }
        }
    }
    cout << ans << endl;
    return 0;
}
```

* **ä»£ç è§£è¯»æ¦‚è¦**ï¼š
  1. **Tarjanç¼©ç‚¹**ï¼šç”¨æ ˆå’Œæ—¶é—´æˆ³æ‰¾åˆ°æ‰€æœ‰å¼ºè¿é€šåˆ†é‡ï¼Œç»™æ¯ä¸ªèŠ‚ç‚¹æ‰“â€œé¢œè‰²â€æ ‡ç­¾ï¼Œè®°å½•æ¯ä¸ªåˆ†é‡çš„å¤§å°`sz`ã€‚
  2. **å»ºå›¾**ï¼šç¼©ç‚¹åï¼Œæ­£å›¾`g1`ä¿å­˜åŸè¾¹çš„æ–¹å‘ï¼Œåå›¾`g2`ä¿å­˜åå‘è¾¹ã€‚
  3. **SPFAæœ€é•¿è·¯**ï¼šåˆ†åˆ«è®¡ç®—ä»èµ·ç‚¹åˆ†é‡å‡ºå‘çš„æ­£å‘æœ€é•¿è·¯ï¼ˆ`dis1`ï¼‰å’Œåå‘æœ€é•¿è·¯ï¼ˆ`dis2`ï¼‰ã€‚
  4. **æšä¸¾è¾¹**ï¼šéå†æ‰€æœ‰åŸè¾¹ï¼Œè®¡ç®—é€†å‘è¿™æ¡è¾¹åçš„æ€»ç‚¹æ•°ï¼Œå–æœ€å¤§å€¼ã€‚


### é¢˜è§£ä¸€æ ¸å¿ƒä»£ç ç‰‡æ®µèµæï¼ˆTarjanç¼©ç‚¹ï¼‰
* **äº®ç‚¹**ï¼šæ ‡å‡†çš„Tarjanæ¨¡æ¿ï¼Œé€»è¾‘æ¸…æ™°ï¼Œå®¹æ˜“ç†è§£ã€‚
* **æ ¸å¿ƒä»£ç ç‰‡æ®µ**ï¼š
  ```cpp
  void tarjan(int u) {
      dfn[u] = low[u] = ++timestamp;
      stk.push(u);
      instack[u] = true;
      for (int i = head[u]; i; i = nxt[i]) {
          int v = to[i];
          if (!dfn[v]) {
              tarjan(v);
              low[u] = min(low[u], low[v]);
          } else if (instack[v]) {
              low[u] = min(low[u], dfn[v]);
          }
      }
      if (dfn[u] == low[u]) {
          cnt++;
          int v;
          do {
              v = stk.top();
              stk.pop();
              instack[v] = false;
              color[v] = cnt;
              sz[cnt]++;
          } while (v != u);
      }
  }
  ```
* **ä»£ç è§£è¯»**ï¼š
  - `dfn[u]`æ˜¯èŠ‚ç‚¹uçš„è®¿é—®æ—¶é—´ï¼Œ`low[u]`æ˜¯uèƒ½åˆ°è¾¾çš„æœ€æ—©æ—¶é—´ã€‚
  - é‡åˆ°æœªè®¿é—®çš„èŠ‚ç‚¹`v`ï¼Œé€’å½’å¤„ç†åæ›´æ–°`low[u]`ï¼›é‡åˆ°å·²åœ¨æ ˆä¸­çš„èŠ‚ç‚¹`v`ï¼Œç”¨`dfn[v]`æ›´æ–°`low[u]`ã€‚
  - å½“`dfn[u] == low[u]`æ—¶ï¼Œæ ˆä¸­ä»uåˆ°æ ˆé¡¶çš„èŠ‚ç‚¹æ˜¯ä¸€ä¸ªå¼ºè¿é€šåˆ†é‡ï¼Œå¼¹å‡ºå¹¶æ‰“æ ‡ç­¾ã€‚
* ğŸ’¡ **å­¦ä¹ ç¬”è®°**ï¼šTarjançš„å…³é”®æ˜¯â€œæ‰¾èƒ½å›åˆ°æ›´æ—©èŠ‚ç‚¹çš„è·¯å¾„â€ï¼Œæ ˆç”¨æ¥ä¿å­˜å½“å‰è·¯å¾„çš„èŠ‚ç‚¹ã€‚


### é¢˜è§£äºŒæ ¸å¿ƒä»£ç ç‰‡æ®µèµæï¼ˆæ‹“æ‰‘æ’åºæ±‚æœ€é•¿è·¯ï¼‰
* **äº®ç‚¹**ï¼šç”¨æ‹“æ‰‘æ’åºä»£æ›¿SPFAï¼Œæ—¶é—´å¤æ‚åº¦æ›´ç¨³å®šã€‚
* **æ ¸å¿ƒä»£ç ç‰‡æ®µ**ï¼š
  ```cpp
  void topo(vector<int> g[], int dis[]) {
      queue<int> q;
      vector<int> in(cnt + 1, 0);
      for (int u = 1; u <= cnt; u++) {
          for (int v : g[u]) in[v]++;
      }
      for (int u = 1; u <= cnt; u++) {
          if (in[u] == 0) q.push(u);
      }
      while (!q.empty()) {
          int u = q.front();
          q.pop();
          for (int v : g[u]) {
              if (dis[v] < dis[u] + sz[v]) {
                  dis[v] = dis[u] + sz[v];
              }
              if (--in[v] == 0) q.push(v);
          }
      }
  }
  ```
* **ä»£ç è§£è¯»**ï¼š
  - å…ˆç»Ÿè®¡æ¯ä¸ªèŠ‚ç‚¹çš„å…¥åº¦`in`ï¼Œå…¥åº¦ä¸º0çš„èŠ‚ç‚¹å…¥é˜Ÿã€‚
  - å¤„ç†æ¯ä¸ªèŠ‚ç‚¹æ—¶ï¼Œæ›´æ–°å…¶é‚»æ¥èŠ‚ç‚¹çš„æœ€é•¿è·¯ï¼Œå¹¶å‡å°‘é‚»æ¥èŠ‚ç‚¹çš„å…¥åº¦ï¼›å…¥åº¦ä¸º0æ—¶å…¥é˜Ÿã€‚
* ğŸ’¡ **å­¦ä¹ ç¬”è®°**ï¼šæ‹“æ‰‘æ’åºçš„é¡ºåºæ˜¯â€œæ— ä¾èµ–çš„èŠ‚ç‚¹å…ˆå¤„ç†â€ï¼Œé€‚åˆDAGçš„æœ€é•¿è·¯è®¡ç®—ã€‚


## 5. ç®—æ³•å¯è§†åŒ–ï¼šåƒç´ åŠ¨ç”»æ¼”ç¤º (æ ¸å¿ƒéƒ¨åˆ†)

### åŠ¨ç”»æ¼”ç¤ºä¸»é¢˜ï¼šåƒç´ è¿·å®«çš„â€œæ‰“åŒ…ä¸å¯¼èˆªâ€
ç”¨8ä½FCé£æ ¼å±•ç¤ºå›¾çš„ç¼©ç‚¹å’Œæœ€é•¿è·¯è¿‡ç¨‹ï¼Œåƒç©ã€Šè¿·å®«æ¢é™©ã€‹æ¸¸æˆä¸€æ ·ï¼


### è®¾è®¡æ€è·¯ç®€è¿°
- **åƒç´ é£æ ¼**ï¼šç”¨16x16çš„åƒç´ å—è¡¨ç¤ºèŠ‚ç‚¹ï¼Œä¸åŒé¢œè‰²ä»£è¡¨ä¸åŒå¼ºè¿é€šåˆ†é‡ï¼ˆæ¯”å¦‚çº¢è‰²æ˜¯èµ·ç‚¹åˆ†é‡ï¼Œè“è‰²æ˜¯å…¶ä»–åˆ†é‡ï¼‰ã€‚
- **åŠ¨ç”»é€»è¾‘**ï¼šç”¨â€œç®­å¤´æµåŠ¨â€å±•ç¤ºè·¯å¾„ï¼Œâ€œæ ˆåŠ¨ç”»â€å±•ç¤ºTarjanç¼©ç‚¹ï¼Œâ€œçº¢è‰²é—ªçƒâ€æç¤ºé€†å‘è¾¹ã€‚
- **æ¸¸æˆåŒ–å…ƒç´ **ï¼šå®Œæˆç¼©ç‚¹æ—¶æ’­æ”¾â€œå®â€çš„éŸ³æ•ˆï¼Œæ‰¾åˆ°æœ€é•¿è·¯æ—¶æ’­æ”¾â€œèƒœåˆ©â€éŸ³æ•ˆï¼Œé€†å‘è¾¹æ—¶æ’­æ”¾â€œåå‘â€éŸ³æ•ˆï¼Œå¢åŠ æˆå°±æ„Ÿï¼


### åŠ¨ç”»å¸§æ­¥éª¤ä¸äº¤äº’å…³é”®ç‚¹
1. **åˆå§‹åŒ–ç•Œé¢**ï¼š
   - æ˜¾ç¤º8ä½é£æ ¼çš„è¿·å®«ï¼ˆèŠ‚ç‚¹æ˜¯åƒç´ å—ï¼Œè¾¹æ˜¯ç™½è‰²çº¿æ¡ï¼‰ã€‚
   - æ§åˆ¶é¢æ¿æœ‰â€œå¼€å§‹/æš‚åœâ€â€œå•æ­¥â€â€œé‡ç½®â€æŒ‰é’®ï¼Œé€Ÿåº¦æ»‘å—ã€‚
   - æ’­æ”¾è½»å¿«çš„8ä½BGMã€‚

2. **Tarjanç¼©ç‚¹è¿‡ç¨‹**ï¼š
   - èŠ‚ç‚¹è¢«è®¿é—®æ—¶ï¼Œ`dfn`æ—¶é—´æˆ³ç”¨é»„è‰²æ•°å­—æ˜¾ç¤ºåœ¨èŠ‚ç‚¹ä¸Šæ–¹ã€‚
   - èŠ‚ç‚¹å…¥æ ˆæ—¶ï¼Œåƒç´ å—â€œè·³â€è¿›æ ˆï¼ˆæ ˆæ˜¯å³ä¾§çš„åƒç´ åˆ—ï¼‰ï¼›å‡ºæ ˆæ—¶â€œè·³â€å›åŸä½ç½®ï¼Œå¹¶å˜æˆå¯¹åº”åˆ†é‡çš„é¢œè‰²ã€‚
   - æ¯æ‰¾åˆ°ä¸€ä¸ªåˆ†é‡ï¼Œæ’­æ”¾â€œå®â€çš„éŸ³æ•ˆï¼Œåˆ†é‡å¤§å°æ˜¾ç¤ºåœ¨é¢œè‰²å—ä¸‹æ–¹ã€‚

3. **æ­£å›¾æœ€é•¿è·¯è®¡ç®—**ï¼š
   - ä»èµ·ç‚¹åˆ†é‡ï¼ˆçº¢è‰²ï¼‰å‡ºå‘ï¼Œç»¿è‰²ç®­å¤´æ²¿ç€è¾¹æµåŠ¨ï¼Œç»è¿‡çš„èŠ‚ç‚¹é«˜äº®ï¼Œæœ€é•¿è·¯æ•°å€¼å®æ—¶æ›´æ–°åœ¨èŠ‚ç‚¹ä¸‹æ–¹ã€‚
   - æ¯æ›´æ–°ä¸€ä¸ªèŠ‚ç‚¹çš„æœ€é•¿è·¯ï¼Œæ’­æ”¾â€œæ»´â€çš„éŸ³æ•ˆã€‚

4. **åå›¾æœ€é•¿è·¯è®¡ç®—**ï¼š
   - è“è‰²ç®­å¤´ä»èµ·ç‚¹åˆ†é‡å‡ºå‘ï¼Œåå‘æµåŠ¨ï¼Œç»è¿‡çš„èŠ‚ç‚¹é«˜äº®ï¼Œæœ€é•¿è·¯æ•°å€¼æ›´æ–°ã€‚

5. **æšä¸¾é€†å‘è¾¹**ï¼š
   - éå†æ‰€æœ‰è¾¹æ—¶ï¼Œè¾¹å˜æˆçº¢è‰²é—ªçƒï¼ŒåŒæ—¶æ˜¾ç¤ºâ€œæ­£å‘ç‚¹æ•°+åå‘ç‚¹æ•°-èµ·ç‚¹å¤§å°â€çš„æ•°å€¼ã€‚
   - æ‰¾åˆ°æœ€å¤§å€¼æ—¶ï¼Œæ’­æ”¾â€œèƒœåˆ©â€éŸ³æ•ˆï¼Œå¯¹åº”çš„è·¯å¾„ç”¨å½©è™¹è‰²é«˜äº®ã€‚

6. **äº¤äº’æ§åˆ¶**ï¼š
   - å•æ­¥æ‰§è¡Œï¼šç‚¹å‡»â€œå•æ­¥â€æŒ‰é’®ï¼ŒåŠ¨ç”»èµ°ä¸€æ­¥ï¼Œæ—è¾¹æ˜¾ç¤ºå½“å‰æ­¥éª¤çš„è§£é‡Šï¼ˆæ¯”å¦‚â€œæ­£åœ¨å¤„ç†èŠ‚ç‚¹5ï¼Œå…¥æ ˆâ€ï¼‰ã€‚
   - è‡ªåŠ¨æ’­æ”¾ï¼šæ‹–åŠ¨é€Ÿåº¦æ»‘å—è°ƒæ•´é€Ÿåº¦ï¼ŒåŠ¨ç”»è‡ªåŠ¨æ‰§è¡Œï¼Œåƒâ€œAIæ¢é™©é˜Ÿâ€ä¸€æ ·èµ°å®Œæ•´ä¸ªè¿‡ç¨‹ã€‚


## 6. æ‹“å±•ç»ƒä¹ ä¸ç›¸ä¼¼é—®é¢˜æ€è€ƒ

### é€šç”¨æ€è·¯/æŠ€å·§è¿ç§»
- å¼ºè¿é€šåˆ†é‡ï¼ˆTarjanï¼‰ï¼šé€‚ç”¨äºå¤„ç†æœ‰ç¯çš„å›¾ï¼Œæ¯”å¦‚â€œæ±‚å›¾ä¸­æ‰€æœ‰ç¯çš„å¤§å°â€â€œç¼©ç‚¹åæ±‚æœ€çŸ­/æœ€é•¿è·¯â€ã€‚
- DAGæœ€é•¿è·¯ï¼šé€‚ç”¨äºâ€œä¾èµ–å…³ç³»ä¸­çš„æœ€å¤§æ”¶ç›Šâ€é—®é¢˜ï¼Œæ¯”å¦‚â€œè¯¾ç¨‹è¡¨ä¸­çš„æœ€é•¿ä¿®è¯¾æ—¶é—´â€ã€‚
- æ­£å›¾+åå›¾ï¼šé€‚ç”¨äºâ€œåŒå‘è·¯å¾„â€é—®é¢˜ï¼Œæ¯”å¦‚â€œä»Aåˆ°Bå†å›åˆ°Açš„æœ€çŸ­è·¯å¾„â€ã€‚


### ç»ƒä¹ æ¨è (æ´›è°·)
1. **æ´›è°· P3387** - å¼ºè¿é€šåˆ†é‡æ¨¡æ¿é¢˜
   - ğŸ—£ï¸ **æ¨èç†ç”±**ï¼šç»ƒä¼šTarjanç¼©ç‚¹çš„åŸºç¡€ï¼Œè¿™æ˜¯æœ¬é¢˜çš„â€œåœ°åŸºâ€ï¼
2. **æ´›è°· P1629** - æœ€é•¿è·¯æ¨¡æ¿é¢˜
   - ğŸ—£ï¸ **æ¨èç†ç”±**ï¼šå·©å›ºDAGæœ€é•¿è·¯çš„æ‹“æ‰‘æ’åºå®ç°ï¼Œæ¯”SPFAæ›´ç¨³å®šã€‚
3. **æ´›è°· P2746** - æ ¡å›­ç½‘
   - ğŸ—£ï¸ **æ¨èç†ç”±**ï¼šç¼©ç‚¹åæ±‚â€œæœ€å°‘éœ€è¦åŠ å¤šå°‘è¾¹è®©å›¾è¿é€šâ€ï¼Œæ˜¯å›¾è®ºçš„ç»å…¸å˜å½¢é¢˜ã€‚


## 7. å­¦ä¹ å¿ƒå¾—ä¸ç»éªŒåˆ†äº« (è‹¥æœ‰)
- **æ¥è‡ªblock_jokerçš„ç»éªŒ**ï¼šâ€œç¼©ç‚¹åä¸€å®šè¦æ³¨æ„å»é‡ï¼Œä¸ç„¶ä¼šæŠŠè‡ªç¯ä¹Ÿç®—è¿›å»ï¼â€â€”â€”è¿™ç‚¹å¾ˆé‡è¦ï¼Œè‡ªç¯ä¸ä¼šå¢åŠ ç‚¹æ•°ï¼Œæ‰€ä»¥å»ºå›¾æ—¶è¦è·³è¿‡`color[u] == color[v]`çš„æƒ…å†µã€‚
- **æ¥è‡ªnamelessguguguçš„ç»éªŒ**ï¼šâ€œæ‹“æ‰‘æ’åºæ±‚æœ€é•¿è·¯æ—¶ï¼Œä¸€å®šè¦å…ˆå¤„ç†å…¥åº¦ä¸º0çš„èŠ‚ç‚¹ï¼â€â€”â€”å¦åˆ™ä¼šæ¼æ‰æŸäº›è·¯å¾„ã€‚
- **æ¥è‡ªhsfzLZH1çš„ç»éªŒ**ï¼šâ€œåˆ†å±‚å›¾çš„æ€è·¯å¾ˆçµæ´»ï¼Œä½†è¦æ³¨æ„å±‚ä¹‹é—´çš„è¾¹ä¸è¦å»ºåï¼â€â€”â€”æ¯”å¦‚åŸè¾¹æ˜¯uâ†’vï¼Œåˆ†å±‚å›¾ä¸­è¦å»ºuâ†’v+nï¼ˆç¬¬äºŒå±‚ï¼‰ï¼Œè€Œä¸æ˜¯åè¿‡æ¥ã€‚


## æ€»ç»“
è¿™é“é¢˜çš„æ ¸å¿ƒæ˜¯â€œç¼©ç‚¹+æœ€é•¿è·¯â€ï¼Œåƒç»™å›¾â€œåšå‡æ³•â€â€”â€”æŠŠå¤æ‚çš„ç¯æ‰“åŒ…æˆç‚¹ï¼Œå†ç”¨æœ€é•¿è·¯æ‰¾åˆ°æœ€ä¼˜è·¯å¾„ã€‚å¸Œæœ›è¿™ä»½æŒ‡å—èƒ½å¸®ä½ ç†è§£å›¾è®ºçš„â€œæ‰“åŒ…é­”æ³•â€ï¼Œä¸‹æ¬¡é‡åˆ°æœ‰ç¯çš„å›¾ï¼Œè®°å¾—å…ˆâ€œç¼©ç‚¹â€å“¦ï¼ğŸ’ª

ä¸‹æ¬¡æˆ‘ä»¬å†ä¸€èµ·æ¢ç´¢æ›´æœ‰è¶£çš„å›¾è®ºé—®é¢˜ï½

---
å¤„ç†ç”¨æ—¶ï¼š118.15ç§’
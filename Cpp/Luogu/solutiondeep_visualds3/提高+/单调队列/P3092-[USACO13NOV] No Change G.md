# é¢˜ç›®ä¿¡æ¯

# [USACO13NOV] No Change G

## é¢˜ç›®æè¿°

Farmer John is at the market to purchase supplies for his farm.  He has in his pocket K coins (1 <= K <= 16), each with value in the range 1..100,000,000.  FJ would like to make a sequence of N purchases (1 <= N <= 100,000), where the ith purchase costs c(i) units of money (1 <= c(i) <= 10,000).  As he makes this sequence of purchases, he can periodically stop and pay, with a single coin, for all the purchases made since his last payment (of course, the single coin he uses must be large enough to pay for all of these).  Unfortunately, the vendors at the market are completely out of change, so whenever FJ uses a coin that is larger than the amount of money he owes, he sadly receives no changes in return!

Please compute the maximum amount of money FJ can end up with after making his N purchases in sequence.  Output -1 if it is impossible for FJ to make all of his purchases.

çº¦ç¿°åˆ°å•†åœºè´­ç‰©ï¼Œä»–çš„é’±åŒ…é‡Œæœ‰K(1 <= K <= 16)ä¸ªç¡¬å¸ï¼Œé¢å€¼çš„èŒƒå›´æ˜¯1..100,000,000ã€‚

çº¦ç¿°æƒ³æŒ‰é¡ºåºä¹° Nä¸ªç‰©å“(1 <= N <= 100,000)ï¼Œç¬¬iä¸ªç‰©å“éœ€è¦èŠ±è´¹c(i)å—é’±ï¼Œ(1 <= c(i) <= 10,000)ã€‚

åœ¨ä¾æ¬¡è¿›è¡Œçš„è´­ä¹°Nä¸ªç‰©å“çš„è¿‡ç¨‹ä¸­ï¼Œçº¦ç¿°å¯ä»¥éšæ—¶åœä¸‹æ¥ä»˜æ¬¾ï¼Œæ¯æ¬¡ä»˜æ¬¾åªç”¨ä¸€ä¸ªç¡¬å¸ï¼Œæ”¯ä»˜è´­ä¹°çš„å†…å®¹æ˜¯ä»ä¸Šä¸€æ¬¡æ”¯ä»˜åå¼€å§‹åˆ°ç°åœ¨çš„è¿™äº›æ‰€æœ‰ç‰©å“ï¼ˆå‰ææ˜¯è¯¥ç¡¬å¸è¶³ä»¥æ”¯ä»˜è¿™äº›ç‰©å“çš„è´¹ç”¨ï¼‰ã€‚ä¸å¹¸çš„æ˜¯ï¼Œå•†åœºçš„æ”¶é“¶æœºåäº†ï¼Œå¦‚æœçº¦ç¿°æ”¯ä»˜çš„ç¡¬å¸é¢å€¼å¤§äºæ‰€éœ€çš„è´¹ç”¨ï¼Œä»–ä¸ä¼šå¾—åˆ°ä»»ä½•æ‰¾é›¶ã€‚

è¯·è®¡ç®—å‡ºåœ¨è´­ä¹°å®ŒNä¸ªç‰©å“åï¼Œçº¦ç¿°æœ€å¤šå‰©ä¸‹å¤šå°‘é’±ã€‚å¦‚æœæ— æ³•å®Œæˆè´­ä¹°ï¼Œè¾“å‡º-1


## è¯´æ˜/æç¤º

FJ has 3 coins of values 12, 15, and 10.  He must make purchases in sequence of value 6, 3, 3, 2, 3, and 7.


FJ spends his 10-unit coin on the first two purchases, then the 15-unit coin on the remaining purchases.  This leaves him with the 12-unit coin.


## æ ·ä¾‹ #1

### è¾“å…¥

```
3 6 
12 
15 
10 
6 
3 
3 
2 
3 
7 
```

### è¾“å‡º

```
12 
```

# AIåˆ†æç»“æœ

# ğŸ’¡ Kayçš„C++ç®—æ³•è§£æï¼š[USACO13NOV] No Change G æ·±å…¥å­¦ä¹ æŒ‡å— ğŸ’¡


## 1. é¢˜ç›®è§£è¯»ä¸æ ¸å¿ƒç®—æ³•è¯†åˆ«

âœ¨ **æœ¬é¢˜ä¸»è¦è€ƒå¯Ÿ**ï¼šçŠ¶å‹DPï¼ˆçŠ¶æ€å‹ç¼©åŠ¨æ€è§„åˆ’ï¼‰  

ğŸ—£ï¸ **åˆæ­¥åˆ†æ**ï¼š  
è§£å†³â€œNo Change Gâ€çš„å…³é”®åœ¨äº**çŠ¶å‹DP**â€”â€”å°†ç¡¬å¸çš„ä½¿ç”¨çŠ¶æ€ç”¨äºŒè¿›åˆ¶æ•°å‹ç¼©ï¼Œä»è€Œé«˜æ•ˆå¤„ç†â€œé€‰æ‹©å“ªäº›ç¡¬å¸â€çš„é—®é¢˜ã€‚  
- **çŠ¶å‹DPæ ¸å¿ƒæ€æƒ³**ï¼šåƒâ€œç”¨äºŒè¿›åˆ¶ä½æ ‡è®°ç‰©å“æ˜¯å¦è¢«é€‰â€ä¸€æ ·ï¼Œç”¨16ä½äºŒè¿›åˆ¶æ•°è¡¨ç¤º16ä¸ªç¡¬å¸çš„ä½¿ç”¨çŠ¶æ€ï¼ˆä¾‹å¦‚ï¼Œ`101`è¡¨ç¤ºç¬¬1ã€3ä¸ªç¡¬å¸å·²ç”¨ï¼Œç¬¬2ä¸ªæœªç”¨ï¼‰ã€‚  
- **æœ¬é¢˜åº”ç”¨**ï¼šå®šä¹‰`dp[state]`ä¸ºâ€œä½¿ç”¨`state`å¯¹åº”çš„ç¡¬å¸é›†åˆæ—¶ï¼Œèƒ½æŒ‰é¡ºåºä¹°åˆ°çš„æœ€è¿œç‰©å“ç¼–å·â€ã€‚ç›®æ ‡æ˜¯æ‰¾åˆ°æ‰€æœ‰èƒ½ä¹°åˆ°å…¨éƒ¨Nä¸ªç‰©å“çš„çŠ¶æ€ï¼Œè®¡ç®—å…¶ä¸­æœªä½¿ç”¨ç¡¬å¸çš„æœ€å¤§æ€»é¢å€¼ã€‚  

**æ ¸å¿ƒæµç¨‹**ï¼š  
1. **é¢„å¤„ç†**ï¼šç”¨åŒæŒ‡é’ˆæˆ–äºŒåˆ†æ³•ï¼Œè®¡ç®—æ¯ä¸ªç¡¬å¸ä»æ¯ä¸ªä½ç½®å¼€å§‹èƒ½ä¹°åˆ°çš„æœ€è¿œç‰©å“ç¼–å·ï¼ˆä¾‹å¦‚ï¼Œç¡¬å¸iä»ä½ç½®jå¼€å§‹ï¼Œèƒ½ä¹°åˆ°jåˆ°kçš„ç‰©å“ï¼‰ã€‚  
2. **çŠ¶æ€è½¬ç§»**ï¼šå¯¹äºæ¯ä¸ªçŠ¶æ€`state`ï¼Œæšä¸¾å…¶ä¸­ä¸€ä¸ªç¡¬å¸jï¼Œå»æ‰jåçš„çŠ¶æ€ä¸º`prev_state`ï¼Œç”¨jçš„é¢å€¼ä»`dp[prev_state]+1`å¼€å§‹ï¼Œæ›´æ–°`dp[state]`ä¸ºèƒ½ä¹°åˆ°çš„æœ€è¿œä½ç½®ã€‚  
3. **ç»“æœè®¡ç®—**ï¼šéå†æ‰€æœ‰çŠ¶æ€ï¼Œæ‰¾åˆ°`dp[state] == N`çš„çŠ¶æ€ï¼Œè®¡ç®—æœªä½¿ç”¨ç¡¬å¸çš„æ€»é¢å€¼ï¼Œå–æœ€å¤§å€¼ã€‚  

**å¯è§†åŒ–è®¾è®¡æ€è·¯**ï¼š  
ç”¨**8ä½åƒç´ é£æ ¼**æ¨¡æ‹Ÿè´­ç‰©è¿‡ç¨‹ï¼š  
- å·¦ä¾§æ˜¾ç¤ºç¡¬å¸ï¼ˆè“è‰²=æœªç”¨ï¼Œçº¢è‰²=å·²ç”¨ï¼‰ï¼Œå³ä¾§æ˜¾ç¤ºç‰©å“ï¼ˆç°è‰²=æœªä¹°ï¼Œç»¿è‰²=å·²ä¹°ï¼‰ã€‚  
- åŠ¨ç”»é€æ­¥å±•ç¤ºçŠ¶æ€è½¬ç§»ï¼šä»çŠ¶æ€0ï¼ˆæ— ç¡¬å¸ï¼‰å¼€å§‹ï¼Œæ¯æ¬¡æ·»åŠ ä¸€ä¸ªç¡¬å¸ï¼ˆå˜çº¢ï¼‰ï¼Œå¯¹åº”çš„ç‰©å“ä»å½“å‰ä½ç½®å¼€å§‹å˜ä¸ºç»¿è‰²ï¼ˆè¡¨ç¤ºè¢«è´­ä¹°ï¼‰ã€‚  
- å…³é”®æ“ä½œï¼ˆå¦‚æ·»åŠ ç¡¬å¸ã€è´­ä¹°ç‰©å“ï¼‰ä¼´éšâ€œå®â€â€œæ²™æ²™â€ç­‰åƒç´ éŸ³æ•ˆï¼Œå®Œæˆæ‰€æœ‰ç‰©å“æ—¶æ’­æ”¾â€œèƒœåˆ©â€éŸ³æ•ˆã€‚  


## 2. ç²¾é€‰ä¼˜è´¨é¢˜è§£å‚è€ƒ

### é¢˜è§£ä¸€ï¼ˆä½œè€…ï¼šImakfï¼Œèµ37ï¼‰  
**ç‚¹è¯„**ï¼š  
æ­¤è§£çš„**æ ¸å¿ƒäº®ç‚¹**æ˜¯**åŒæŒ‡é’ˆé¢„å¤„ç†**ï¼Œå°†æ¯ä¸ªç¡¬å¸çš„è¦†ç›–èŒƒå›´ï¼ˆä»æ¯ä¸ªä½ç½®å¼€å§‹èƒ½ä¹°åˆ°çš„æœ€è¿œç‰©å“ï¼‰æå‰è®¡ç®—ï¼Œå°†çŠ¶æ€è½¬ç§»çš„æ—¶é—´å¤æ‚åº¦ä»`O(2^K K logN)`ä¼˜åŒ–åˆ°`O(2^K K)`ï¼Œéå¸¸é€‚åˆN=1e5çš„å¤§æ•°æ®ã€‚  
- **æ€è·¯æ¸…æ™°**ï¼šé¢„å¤„ç†`far[i][j]`è¡¨ç¤ºç¬¬iä¸ªç¡¬å¸ä»jå¼€å§‹èƒ½ä¹°åˆ°çš„æœ€è¿œä½ç½®ï¼ŒçŠ¶æ€è½¬ç§»æ—¶ç›´æ¥æŸ¥è¯¢`far`æ•°ç»„ï¼Œé€»è¾‘ç›´ç™½ã€‚  
- **ä»£ç è§„èŒƒ**ï¼šå˜é‡åï¼ˆå¦‚`far`ã€`dp`ï¼‰å«ä¹‰æ˜ç¡®ï¼ŒåŒæŒ‡é’ˆå¾ªç¯ç»“æ„å·¥æ•´ï¼Œæ³¨é‡Šç®€æ´ã€‚  
- **å®è·µä»·å€¼**ï¼šé¢„å¤„ç†æ–¹æ³•æ˜¯è§£å†³å¤§Né—®é¢˜çš„å¸¸ç”¨æŠ€å·§ï¼Œä»£ç å¯ç›´æ¥ç”¨äºç«èµ›ï¼Œè¾¹ç•Œå¤„ç†ï¼ˆå¦‚`All -= cost[j]`ï¼‰ä¸¥è°¨ã€‚  

### é¢˜è§£äºŒï¼ˆä½œè€…ï¼šjun1lesszZZï¼Œèµ82ï¼‰  
**ç‚¹è¯„**ï¼š  
æ­¤è§£ç”¨**äºŒåˆ†æ³•**è®¡ç®—ç¡¬å¸çš„è¦†ç›–èŒƒå›´ï¼Œæ€è·¯ç»å…¸ï¼Œé€‚åˆåˆå­¦è€…ç†è§£çŠ¶å‹DPçš„åŸºç¡€é€»è¾‘ã€‚  
- **é€»è¾‘æ¨å¯¼é€å½»**ï¼š`check`å‡½æ•°ç”¨äºŒåˆ†æŸ¥æ‰¾å‰ç¼€å’Œï¼Œæ‰¾åˆ°æœ€å¤§çš„å¯è´­ä¹°ä½ç½®ï¼Œè§£é‡Šäº†â€œå¦‚ä½•ä»`prev_state`æ‰©å±•åˆ°å½“å‰çŠ¶æ€â€ã€‚  
- **ä»£ç å¯è¯»æ€§é«˜**ï¼šæ³¨é‡Šè¯¦ç»†ï¼ˆå¦‚â€œæ³¨æ„äºŒåˆ†çš„è¾¹ç•Œé—®é¢˜â€ï¼‰ï¼Œå˜é‡åï¼ˆå¦‚`dp`ã€`sum`ï¼‰ç¬¦åˆå¸¸è§„ä¹ æƒ¯ã€‚  
- **å¯å‘æ€§**ï¼šå±•ç¤ºäº†çŠ¶å‹DPçš„æ ‡å‡†æ¡†æ¶ï¼ˆçŠ¶æ€æšä¸¾â†’è½¬ç§»â†’ç»“æœè®¡ç®—ï¼‰ï¼Œæ˜¯å­¦ä¹ çŠ¶å‹DPçš„å¾ˆå¥½ç¤ºä¾‹ã€‚  

### é¢˜è§£ä¸‰ï¼ˆä½œè€…ï¼šUltiMadowï¼Œèµ15ï¼‰  
**ç‚¹è¯„**ï¼š  
æ­¤è§£çš„**ä»£ç æå…¶ç®€çŸ­**ï¼Œç”¨æœ€å°‘çš„ä»£ç å®ç°äº†æ ¸å¿ƒé€»è¾‘ï¼Œé€‚åˆå­¦ä¹ â€œå¦‚ä½•ç®€åŒ–ä»£ç â€ã€‚  
- **ä»£ç ç®€æ´**ï¼šçŠ¶æ€è½¬ç§»å¾ªç¯ç›´æ¥æšä¸¾æ¯ä¸ªç¡¬å¸ï¼Œ`find`å‡½æ•°ç”¨äºŒåˆ†æŸ¥æ‰¾ï¼Œå˜é‡åï¼ˆå¦‚`f[st]`ï¼‰ç®€æ´æ˜äº†ã€‚  
- **æ€è·¯æ˜ç¡®**ï¼šæ²¡æœ‰å†—ä½™ä»£ç ï¼Œç›´æ¥èšç„¦â€œçŠ¶æ€è½¬ç§»â€å’Œâ€œç»“æœè®¡ç®—â€ï¼Œé€‚åˆå¿«é€Ÿç†è§£çŠ¶å‹DPçš„æ ¸å¿ƒã€‚  


## 3. æ ¸å¿ƒéš¾ç‚¹è¾¨æä¸è§£é¢˜ç­–ç•¥

### 1. å…³é”®ç‚¹1ï¼šçŠ¶æ€å®šä¹‰çš„é€‰æ‹©  
**éš¾ç‚¹**ï¼šä¸ºä»€ä¹ˆç”¨`dp[state]`è¡¨ç¤ºâ€œæœ€è¿œç‰©å“ç¼–å·â€ï¼Ÿ  
**åˆ†æ**ï¼šç‰©å“å¿…é¡»æŒ‰é¡ºåºè´­ä¹°ï¼Œâ€œæœ€è¿œç‰©å“ç¼–å·â€èƒ½å”¯ä¸€ç¡®å®šè¯¥çŠ¶æ€ä¸‹çš„è´­ä¹°è¿›åº¦ï¼ˆä¾‹å¦‚ï¼Œ`dp[state]=5`è¡¨ç¤ºä¹°åˆ°äº†å‰5ä¸ªç‰©å“ï¼‰ã€‚è½¬ç§»æ—¶ï¼Œåªéœ€è¦è€ƒè™‘ä»ç¬¬6ä¸ªç‰©å“å¼€å§‹çš„æ‰©å±•ï¼Œç¬¦åˆé¢˜ç›®çš„â€œé¡ºåºè´­ä¹°â€è¦æ±‚ã€‚  
**å­¦ä¹ ç¬”è®°**ï¼šçŠ¶æ€å®šä¹‰è¦è´´åˆé—®é¢˜çš„â€œè¿›åº¦ç‰¹å¾â€ï¼Œç¡®ä¿è½¬ç§»é€»è¾‘æ­£ç¡®ã€‚  

### 2. å…³é”®ç‚¹2ï¼šé«˜æ•ˆè®¡ç®—ç¡¬å¸çš„è¦†ç›–èŒƒå›´  
**éš¾ç‚¹**ï¼šå¦‚ä½•å¿«é€ŸçŸ¥é“â€œç¡¬å¸iä»ä½ç½®jå¼€å§‹èƒ½ä¹°åˆ°çš„æœ€è¿œä½ç½®â€ï¼Ÿ  
**åˆ†æ**ï¼š  
- **åŒæŒ‡é’ˆ**ï¼ˆæ¨èï¼‰ï¼šé¢„å¤„ç†æ¯ä¸ªç¡¬å¸iï¼Œç”¨å·¦å³æŒ‡é’ˆéå†ç‰©å“ï¼Œè®¡ç®—ä»æ¯ä¸ªjå¼€å§‹çš„æœ€è¿œä½ç½®ï¼Œæ—¶é—´å¤æ‚åº¦`O(nK)`ã€‚  
- **äºŒåˆ†æ³•**ï¼šæ¯æ¬¡è½¬ç§»æ—¶ï¼Œç”¨äºŒåˆ†æŸ¥æ‰¾å‰ç¼€å’Œï¼Œæ—¶é—´å¤æ‚åº¦`O(logn)`ã€‚  
**ç­–ç•¥**ï¼šå¯¹äºN=1e5çš„é—®é¢˜ï¼ŒåŒæŒ‡é’ˆé¢„å¤„ç†æ›´ä¼˜ï¼Œå› ä¸ºé¢„å¤„ç†çš„æ—¶é—´æ˜¯ä¸€æ¬¡æ€§çš„ï¼Œè€ŒäºŒåˆ†æ³•éœ€è¦å¤šæ¬¡æŸ¥è¯¢ã€‚  
**å­¦ä¹ ç¬”è®°**ï¼šé¢„å¤„ç†æ˜¯è§£å†³å¤§Né—®é¢˜çš„â€œåˆ©å™¨â€ï¼Œèƒ½å°†å¤šæ¬¡æŸ¥è¯¢çš„æ—¶é—´è½¬åŒ–ä¸ºä¸€æ¬¡é¢„å¤„ç†çš„æ—¶é—´ã€‚  

### 3. å…³é”®ç‚¹3ï¼šçŠ¶æ€è½¬ç§»çš„æ­£ç¡®æ€§  
**éš¾ç‚¹**ï¼šå¦‚ä½•ç¡®ä¿çŠ¶æ€è½¬ç§»çš„é¡ºåºæ­£ç¡®ï¼Ÿ  
**åˆ†æ**ï¼šçŠ¶æ€`state`çš„äºŒè¿›åˆ¶ä¸­1çš„ä¸ªæ•°è¶Šå¤šï¼Œå¯¹åº”çš„ç¡¬å¸ä½¿ç”¨æ•°é‡è¶Šå¤šã€‚æšä¸¾çŠ¶æ€æ—¶ï¼Œ**ä»å°åˆ°å¤§æšä¸¾**ï¼ˆä»0åˆ°`2^K-1`ï¼‰ï¼Œè¿™æ ·å½“å¤„ç†`state`æ—¶ï¼Œæ‰€æœ‰`state`çš„å­é›†ï¼ˆå°‘ä¸€ä¸ªç¡¬å¸çš„çŠ¶æ€ï¼‰å·²ç»å¤„ç†è¿‡äº†ï¼Œä¿è¯è½¬ç§»çš„æ­£ç¡®æ€§ã€‚  
**å­¦ä¹ ç¬”è®°**ï¼šçŠ¶å‹DPçš„çŠ¶æ€æšä¸¾é¡ºåºé€šå¸¸æ˜¯â€œä»å°åˆ°å¤§â€ï¼Œç¡®ä¿å­é›†çŠ¶æ€å·²å¤„ç†ã€‚  

### âœ¨ è§£é¢˜æŠ€å·§æ€»ç»“  
- **é¢„å¤„ç†æŠ€å·§**ï¼šå¯¹äºå¤§Nçš„é—®é¢˜ï¼Œæå‰è®¡ç®—æ¯ä¸ªç¡¬å¸çš„è¦†ç›–èŒƒå›´ï¼Œå‡å°‘é‡å¤è®¡ç®—ã€‚  
- **çŠ¶æ€å®šä¹‰æŠ€å·§**ï¼šé€‰æ‹©èƒ½è¡¨ç¤ºé—®é¢˜è¿›åº¦çš„çŠ¶æ€ï¼ˆå¦‚â€œæœ€è¿œç‰©å“ç¼–å·â€ï¼‰ï¼Œç¡®ä¿è½¬ç§»é€»è¾‘æ­£ç¡®ã€‚  
- **ä½è¿ç®—æŠ€å·§**ï¼šç†Ÿç»ƒä½¿ç”¨`&`ï¼ˆåˆ¤æ–­æ˜¯å¦åŒ…å«æŸç¡¬å¸ï¼‰ã€`^`ï¼ˆå»æ‰æŸç¡¬å¸ï¼‰ã€`<<`ï¼ˆç”Ÿæˆç¡¬å¸çš„äºŒè¿›åˆ¶ä½ï¼‰ç­‰ä½è¿ç®—ï¼Œå¤„ç†çŠ¶æ€è½¬ç§»ã€‚  


## 4. C++æ ¸å¿ƒä»£ç å®ç°èµæ

### æœ¬é¢˜é€šç”¨æ ¸å¿ƒC++å®ç°å‚è€ƒï¼ˆåŸºäºImakfé¢˜è§£ï¼‰  
**è¯´æ˜**ï¼šæ­¤ä»£ç ç»¼åˆäº†åŒæŒ‡é’ˆé¢„å¤„ç†å’ŒçŠ¶å‹DPçš„æ ¸å¿ƒé€»è¾‘ï¼Œæ˜¯è§£å†³æœ¬é¢˜çš„é«˜æ•ˆå®ç°ã€‚  
```cpp
#include <cstdio>
#include <algorithm>
#include <cstring>
using namespace std;

const int MX = 100000 + 5;
int far[17][MX];  // far[i][j]: ç¬¬iä¸ªç¡¬å¸ä»jå¼€å§‹èƒ½ä¹°åˆ°çš„æœ€è¿œä½ç½®
int coin[17];     // ç¡¬å¸é¢å€¼
int cost[MX];     // ç‰©å“ä»·æ ¼
int dp[1 << 17];  // dp[state]: çŠ¶æ€stateä¸‹èƒ½ä¹°åˆ°çš„æœ€è¿œç‰©å“ç¼–å·

inline int read() {
    int x = 0; char ch = getchar();
    while (ch < '0' || ch > '9') ch = getchar();
    while (ch >= '0' && ch <= '9') x = x * 10 + ch - '0', ch = getchar();
    return x;
}

int main() {
    int k = read(), n = read();
    for (int i = 1; i <= k; ++i) coin[i] = read();
    for (int i = 1; i <= n; ++i) cost[i] = read();

    // åŒæŒ‡é’ˆé¢„å¤„ç†faræ•°ç»„
    for (int i = 1; i <= k; ++i) {
        int All = 0, r = 1;  // All: å½“å‰åŒºé—´[j, r)çš„æ€»ä»·æ ¼ï¼Œr: å³æŒ‡é’ˆ
        for (int j = 1; j <= n; ++j) {
            // æ‰©å±•å³æŒ‡é’ˆï¼Œç›´åˆ°æ€»ä»·æ ¼è¶…è¿‡ç¡¬å¸içš„é¢å€¼
            while (r <= n && All + cost[r] <= coin[i]) {
                All += cost[r];
                r++;
            }
            far[i][j] = r - 1;  // èƒ½ä¹°åˆ°çš„æœ€è¿œä½ç½®æ˜¯r-1
            if (All > 0) All -= cost[j];  // å·¦æŒ‡é’ˆå³ç§»ï¼Œå‡å»jçš„ä»·æ ¼
        }
    }

    // çŠ¶æ€è½¬ç§»ï¼šä»å°åˆ°å¤§æšä¸¾æ‰€æœ‰çŠ¶æ€
    for (int i = 0; i < (1 << k); ++i) {
        for (int j = 1; j <= k; ++j) {
            if (!(i & (1 << (j - 1)))) continue;  // çŠ¶æ€iä¸åŒ…å«ç¡¬å¸jï¼Œè·³è¿‡
            int prev = i ^ (1 << (j - 1));  // å»æ‰ç¡¬å¸jåçš„çŠ¶æ€
            // ç”¨ç¡¬å¸jä»prevçŠ¶æ€çš„ä½ç½®+1å¼€å§‹ï¼Œæ›´æ–°å½“å‰çŠ¶æ€çš„æœ€è¿œä½ç½®
            dp[i] = max(dp[i], far[j][dp[prev] + 1]);
        }
    }

    // è®¡ç®—ç»“æœï¼šæ‰¾åˆ°èƒ½ä¹°åˆ°æ‰€æœ‰ç‰©å“çš„çŠ¶æ€ï¼Œæ±‚æœªä½¿ç”¨ç¡¬å¸çš„æœ€å¤§æ€»é¢å€¼
    int ans = -1;
    for (int i = 0; i < (1 << k); ++i) {
        if (dp[i] == n) {  // èƒ½ä¹°åˆ°æ‰€æœ‰ç‰©å“
            int tmp = 0;
            for (int j = 1; j <= k; ++j) {
                if (!(i & (1 << (j - 1)))) tmp += coin[j];  // æœªä½¿ç”¨çš„ç¡¬å¸
            }
            ans = max(ans, tmp);
        }
    }

    printf("%d\n", ans);
    return 0;
}
```  
**ä»£ç è§£è¯»æ¦‚è¦**ï¼š  
1. **é¢„å¤„ç†**ï¼šç”¨åŒæŒ‡é’ˆè®¡ç®—æ¯ä¸ªç¡¬å¸çš„è¦†ç›–èŒƒå›´`far[i][j]`ï¼Œç¡®ä¿æ¯ä¸ªç¡¬å¸çš„ä½¿ç”¨æ•ˆç‡ã€‚  
2. **çŠ¶æ€è½¬ç§»**ï¼šæšä¸¾æ‰€æœ‰çŠ¶æ€ï¼Œå¯¹äºæ¯ä¸ªçŠ¶æ€ä¸­çš„ç¡¬å¸ï¼Œä»å°‘ä¸€ä¸ªç¡¬å¸çš„çŠ¶æ€æ‰©å±•ï¼Œæ›´æ–°å½“å‰çŠ¶æ€çš„æœ€è¿œä½ç½®ã€‚  
3. **ç»“æœè®¡ç®—**ï¼šéå†æ‰€æœ‰çŠ¶æ€ï¼Œæ‰¾åˆ°èƒ½ä¹°åˆ°æ‰€æœ‰ç‰©å“çš„çŠ¶æ€ï¼Œè®¡ç®—æœªä½¿ç”¨ç¡¬å¸çš„æ€»é¢å€¼ï¼Œå–æœ€å¤§å€¼ã€‚  


### é’ˆå¯¹å„ä¼˜è´¨é¢˜è§£çš„ç‰‡æ®µèµæ

#### é¢˜è§£ä¸€ï¼ˆImakfï¼‰ï¼šåŒæŒ‡é’ˆé¢„å¤„ç†  
**äº®ç‚¹**ï¼šç”¨åŒæŒ‡é’ˆå°†æ¯ä¸ªç¡¬å¸çš„è¦†ç›–èŒƒå›´é¢„å¤„ç†ï¼Œé™ä½çŠ¶æ€è½¬ç§»çš„æ—¶é—´å¤æ‚åº¦ã€‚  
**æ ¸å¿ƒä»£ç ç‰‡æ®µ**ï¼š  
```cpp
for (int i = 1; i <= k; ++i) {
    int All = 0, r = 1;
    for (int j = 1; j <= n; ++j) {
        while (r <= n && All + cost[r] <= coin[i]) {
            All += cost[r];
            r++;
        }
        far[i][j] = r - 1;
        if (All > 0) All -= cost[j];
    }
}
```  
**ä»£ç è§£è¯»**ï¼š  
- å¯¹äºæ¯ä¸ªç¡¬å¸iï¼Œç”¨å·¦æŒ‡é’ˆjéå†ç‰©å“ï¼Œå³æŒ‡é’ˆræ‰©å±•åˆ°æœ€è¿œçš„ä½ç½®ï¼Œä½¿å¾—`[j, r)`çš„æ€»ä»·æ ¼ä¸è¶…è¿‡ç¡¬å¸içš„é¢å€¼ã€‚  
- `far[i][j] = r - 1`è¡¨ç¤ºç¡¬å¸iä»jå¼€å§‹èƒ½ä¹°åˆ°çš„æœ€è¿œä½ç½®æ˜¯r-1ã€‚  
- å·¦æŒ‡é’ˆjå³ç§»æ—¶ï¼Œå‡å»jçš„ä»·æ ¼ï¼Œå‡†å¤‡ä¸‹ä¸€æ¬¡æ‰©å±•ã€‚  
**å­¦ä¹ ç¬”è®°**ï¼šåŒæŒ‡é’ˆæ˜¯å¤„ç†â€œè¿ç»­åŒºé—´â€é—®é¢˜çš„å¸¸ç”¨æŠ€å·§ï¼Œèƒ½å°†æ—¶é—´å¤æ‚åº¦ä»`O(n^2)`é™ä½åˆ°`O(n)`ã€‚  

#### é¢˜è§£äºŒï¼ˆjun1lesszZZï¼‰ï¼šäºŒåˆ†æ³•è®¡ç®—è¦†ç›–èŒƒå›´  
**äº®ç‚¹**ï¼šç”¨äºŒåˆ†æ³•æŸ¥æ‰¾å‰ç¼€å’Œï¼Œæ‰¾åˆ°æœ€å¤§çš„å¯è´­ä¹°ä½ç½®ï¼Œæ€è·¯ç»å…¸ã€‚  
**æ ¸å¿ƒä»£ç ç‰‡æ®µ**ï¼š  
```cpp
inline int check(int x, int cha) {
    int l = cha, r = n, mid;
    while (l <= r) {
        mid = (l + r) >> 1;
        if (sum[mid] - sum[cha - 1] == x) return mid;
        if (sum[mid] - sum[cha - 1] < x) l = mid + 1;
        else r = mid - 1;
    }
    return r;
}
```  
**ä»£ç è§£è¯»**ï¼š  
- `sum`æ˜¯ç‰©å“ä»·æ ¼çš„å‰ç¼€å’Œæ•°ç»„ï¼Œ`sum[mid] - sum[cha-1]`è¡¨ç¤º`[cha, mid]`çš„æ€»ä»·æ ¼ã€‚  
- äºŒåˆ†æŸ¥æ‰¾æœ€å¤§çš„`mid`ï¼Œä½¿å¾—`[cha, mid]`çš„æ€»ä»·æ ¼ä¸è¶…è¿‡xï¼ˆç¡¬å¸çš„é¢å€¼ï¼‰ã€‚  
**å­¦ä¹ ç¬”è®°**ï¼šäºŒåˆ†æ³•æ˜¯å¤„ç†â€œå•è°ƒåºåˆ—â€é—®é¢˜çš„å¸¸ç”¨æŠ€å·§ï¼Œèƒ½å°†æ—¶é—´å¤æ‚åº¦ä»`O(n)`é™ä½åˆ°`O(logn)`ã€‚  

#### é¢˜è§£ä¸‰ï¼ˆUltiMadowï¼‰ï¼šç®€çŸ­çš„çŠ¶æ€è½¬ç§»  
**äº®ç‚¹**ï¼šç”¨æœ€å°‘çš„ä»£ç å®ç°çŠ¶æ€è½¬ç§»ï¼Œé€»è¾‘æ¸…æ™°ã€‚  
**æ ¸å¿ƒä»£ç ç‰‡æ®µ**ï¼š  
```cpp
for (int i = 0; i <= max_state; ++i) {
    for (int j = 1; j <= K; ++j) {
        if ((i >> j-1) & 1) continue;
        f[i | (1 << j-1)] = max(f[i | (1 << j-1)], find(f[i], n, mon[j]));
    }
}
```  
**ä»£ç è§£è¯»**ï¼š  
- æšä¸¾æ‰€æœ‰çŠ¶æ€iï¼Œå¯¹äºæ¯ä¸ªæœªä½¿ç”¨çš„ç¡¬å¸jï¼Œè®¡ç®—æ·»åŠ jåçš„çŠ¶æ€`i | (1 << j-1)`ã€‚  
- ç”¨`find`å‡½æ•°ï¼ˆäºŒåˆ†æ³•ï¼‰è®¡ç®—ä»`f[i]`å¼€å§‹ï¼Œç”¨ç¡¬å¸jèƒ½ä¹°åˆ°çš„æœ€è¿œä½ç½®ï¼Œæ›´æ–°`f[i | (1 << j-1)]`ã€‚  
**å­¦ä¹ ç¬”è®°**ï¼šä»£ç çš„ç®€æ´æ€§å¾ˆé‡è¦ï¼Œèƒ½è®©é€»è¾‘æ›´æ¸…æ™°ï¼Œå‡å°‘bugã€‚  


## 5. ç®—æ³•å¯è§†åŒ–ï¼šåƒç´ åŠ¨ç”»æ¼”ç¤ºï¼ˆæ ¸å¿ƒéƒ¨åˆ†ï¼‰

### åŠ¨ç”»æ¼”ç¤ºä¸»é¢˜  
**â€œåƒç´ è´­ç‰©ä¹‹æ—…â€**ï¼šç”¨8ä½åƒç´ é£æ ¼æ¨¡æ‹Ÿçº¦ç¿°ç”¨ç¡¬å¸è´­ä¹°ç‰©å“çš„è¿‡ç¨‹ï¼Œå±•ç¤ºçŠ¶å‹DPçš„çŠ¶æ€è½¬ç§»ã€‚  

### æ ¸å¿ƒæ¼”ç¤ºå†…å®¹  
1. **åˆå§‹çŠ¶æ€**ï¼š  
   - å·¦ä¾§æ˜¾ç¤ºKä¸ªç¡¬å¸ï¼ˆè“è‰²æ–¹å—ï¼Œæ ‡æ³¨é¢å€¼ï¼‰ï¼Œå³ä¾§æ˜¾ç¤ºNä¸ªç‰©å“ï¼ˆç°è‰²æ–¹å—ï¼Œæ ‡æ³¨ä»·æ ¼ï¼‰ã€‚  
   - é¡¶éƒ¨æ˜¾ç¤ºå½“å‰çŠ¶æ€ï¼ˆäºŒè¿›åˆ¶æ•°ï¼Œå¦‚`000`è¡¨ç¤ºæ— ç¡¬å¸ï¼‰å’Œèƒ½ä¹°åˆ°çš„æœ€è¿œä½ç½®ï¼ˆ`0`ï¼‰ã€‚  

2. **çŠ¶æ€è½¬ç§»**ï¼š  
   - ä»å°åˆ°å¤§æšä¸¾çŠ¶æ€ï¼Œæ¯æ¬¡æ·»åŠ ä¸€ä¸ªç¡¬å¸ï¼ˆè“è‰²å˜ä¸ºçº¢è‰²ï¼‰ã€‚  
   - ç”¨ç»¿è‰²æ–¹å—æ ‡è®°è¯¥ç¡¬å¸èƒ½ä¹°åˆ°çš„ç‰©å“ï¼ˆä»å½“å‰æœ€è¿œä½ç½®+1å¼€å§‹ï¼Œåˆ°`far[i][j]`ç»“æŸï¼‰ã€‚  
   - ä¾‹å¦‚ï¼ŒçŠ¶æ€`001`ï¼ˆç¬¬ä¸€ä¸ªç¡¬å¸å·²ç”¨ï¼‰ï¼Œä»ä½ç½®1å¼€å§‹ï¼Œä¹°åˆ°ä½ç½®3ï¼Œç‰©å“1-3å˜ä¸ºç»¿è‰²ã€‚  

3. **ç»“æœå±•ç¤º**ï¼š  
   - å½“æŸä¸ªçŠ¶æ€èƒ½ä¹°åˆ°æ‰€æœ‰ç‰©å“ï¼ˆæ‰€æœ‰ç‰©å“å˜ä¸ºç»¿è‰²ï¼‰ï¼Œè®¡ç®—æœªä½¿ç”¨ç¡¬å¸çš„æ€»é¢å€¼ï¼ˆè“è‰²ç¡¬å¸çš„é¢å€¼å’Œï¼‰ï¼Œæ˜¾ç¤ºåœ¨å±å¹•é¡¶éƒ¨ã€‚  
   - æœ€ç»ˆæ˜¾ç¤ºæœ€å¤§çš„æœªä½¿ç”¨ç¡¬å¸æ€»é¢å€¼ï¼ˆå¦‚æ ·ä¾‹ä¸­çš„`12`ï¼‰ã€‚  

### äº¤äº’ä¸æ¸¸æˆåŒ–å…ƒç´   
- **æ­¥è¿›æ§åˆ¶**ï¼šâ€œå•æ­¥â€æŒ‰é’®ï¼ˆæ¯æ¬¡æ‰§è¡Œä¸€ä¸ªçŠ¶æ€è½¬ç§»ï¼‰ã€â€œè‡ªåŠ¨æ’­æ”¾â€æŒ‰é’®ï¼ˆæŒ‰1ç§’/æ­¥çš„é€Ÿåº¦æ’­æ”¾ï¼‰ã€â€œé‡ç½®â€æŒ‰é’®ï¼ˆå›åˆ°åˆå§‹çŠ¶æ€ï¼‰ã€‚  
- **éŸ³æ•ˆ**ï¼š  
  - æ·»åŠ ç¡¬å¸ï¼šæ’­æ”¾â€œå®â€çš„åƒç´ éŸ³æ•ˆï¼ˆå¦‚`beep`å£°ï¼‰ã€‚  
  - è´­ä¹°ç‰©å“ï¼šæ’­æ”¾â€œæ²™æ²™â€çš„éŸ³æ•ˆï¼ˆå¦‚`rustle`å£°ï¼‰ã€‚  
  - å®Œæˆæ‰€æœ‰ç‰©å“ï¼šæ’­æ”¾â€œèƒœåˆ©â€éŸ³æ•ˆï¼ˆå¦‚`fanfare`å£°ï¼‰ã€‚  
- **æ¸¸æˆåŒ–å…³å¡**ï¼šå°†çŠ¶æ€è½¬ç§»åˆ†ä¸ºâ€œåˆçº§â€ï¼ˆä½¿ç”¨1ä¸ªç¡¬å¸ï¼‰ã€â€œä¸­çº§â€ï¼ˆä½¿ç”¨2-3ä¸ªç¡¬å¸ï¼‰ã€â€œé«˜çº§â€ï¼ˆä½¿ç”¨4+ä¸ªç¡¬å¸ï¼‰ä¸‰ä¸ªå…³å¡ï¼Œå®Œæˆå…³å¡æ—¶æ˜¾ç¤ºâ€œè¿‡å…³â€åŠ¨ç”»ï¼ˆå¦‚åƒç´ æ˜Ÿæ˜Ÿé—ªçƒï¼‰ã€‚  

### è®¾è®¡æ€è·¯  
- **åƒç´ é£æ ¼**ï¼šæ¨¡æ‹ŸFCçº¢ç™½æœºçš„è§†è§‰æ•ˆæœï¼Œè¥é€ å¤å¤ã€è½»æ¾çš„å­¦ä¹ æ°›å›´ã€‚  
- **ç›´è§‚å±•ç¤º**ï¼šç”¨é¢œè‰²æ ‡è®°ç¡¬å¸çš„ä½¿ç”¨çŠ¶æ€å’Œç‰©å“çš„è´­ä¹°çŠ¶æ€ï¼Œè®©å­¦ä¹ è€…â€œçœ‹å¾—åˆ°â€çŠ¶æ€è½¬ç§»çš„è¿‡ç¨‹ã€‚  
- **æ¸¸æˆåŒ–å…ƒç´ **ï¼šé€šè¿‡éŸ³æ•ˆã€å…³å¡å’ŒåŠ¨ç”»ï¼Œå¢åŠ å­¦ä¹ çš„è¶£å‘³æ€§ï¼Œæ¿€å‘å­¦ä¹ è€…çš„å…´è¶£ã€‚  


## 6. æ‹“å±•ç»ƒä¹ ä¸ç›¸ä¼¼é—®é¢˜æ€è€ƒ

### é€šç”¨æ€è·¯/æŠ€å·§è¿ç§»  
çŠ¶å‹DPé€‚ç”¨äº**å…ƒç´ æ•°é‡å°‘ï¼ˆé€šå¸¸â‰¤20ï¼‰**çš„é›†åˆé—®é¢˜ï¼Œæ ¸å¿ƒæ˜¯â€œç”¨äºŒè¿›åˆ¶è¡¨ç¤ºé›†åˆçŠ¶æ€ï¼Œè½¬ç§»æ—¶æšä¸¾å…ƒç´ çš„æ·»åŠ â€ã€‚å¸¸è§çš„åº”ç”¨åœºæ™¯åŒ…æ‹¬ï¼š  
1. **è·¯å¾„é—®é¢˜**ï¼šå¦‚å”®è´§å‘˜çš„éš¾é¢˜ï¼ˆé€‰æ‹©è·¯å¾„è®¿é—®æ‰€æœ‰åŸå¸‚ï¼Œæ±‚æœ€çŸ­è·¯å¾„ï¼‰ã€‚  
2. **ç‰©å“é€‰æ‹©é—®é¢˜**ï¼šå¦‚Cows in a Skyscraperï¼ˆé€‰æ‹©ç‰©å“æ”¾å…¥ç®±å­ï¼Œæ±‚æœ€å°‘ç®±å­æ•°ï¼‰ã€‚  
3. **æ ‘é—®é¢˜**ï¼šå¦‚èªèªå¯å¯ï¼ˆé€‰æ‹©è·¯å¾„æ»¡è¶³æƒå€¼å’Œæ¡ä»¶ï¼Œæ±‚è·¯å¾„æ•°ï¼‰ã€‚  

### ç»ƒä¹ æ¨èï¼ˆæ´›è°·ï¼‰  
1. **æ´›è°· P1171 å”®è´§å‘˜çš„éš¾é¢˜**  
   - ğŸ—£ï¸ **æ¨èç†ç”±**ï¼šçŠ¶å‹DPç»å…¸é¢˜ï¼Œè¦æ±‚è®¿é—®æ‰€æœ‰åŸå¸‚çš„æœ€çŸ­è·¯å¾„ï¼ŒçŠ¶æ€è¡¨ç¤ºå·²è®¿é—®çš„åŸå¸‚ï¼Œè½¬ç§»æšä¸¾ä¸‹ä¸€ä¸ªåŸå¸‚ã€‚é€‚åˆå·©å›ºçŠ¶å‹DPçš„åŸºç¡€é€»è¾‘ã€‚  
2. **æ´›è°· P2634 [å›½å®¶é›†è®­é˜Ÿ]èªèªå¯å¯**  
   - ğŸ—£ï¸ **æ¨èç†ç”±**ï¼šæ ‘çŠ¶DP+çŠ¶å‹ï¼Œè¦æ±‚è·¯å¾„ä¸Šçš„èŠ‚ç‚¹æƒå€¼å’Œä¸º3çš„å€æ•°ï¼ŒçŠ¶æ€è¡¨ç¤ºè·¯å¾„æƒå€¼æ¨¡3çš„ç»“æœã€‚é€‚åˆå­¦ä¹ çŠ¶å‹DPåœ¨æ ‘ç»“æ„ä¸­çš„åº”ç”¨ã€‚  
3. **æ´›è°· P3052 [USACO12MAR]Cows in a Skyscraper G**  
   - ğŸ—£ï¸ **æ¨èç†ç”±**ï¼šçŠ¶å‹DPï¼Œè¦æ±‚å°†ç‰©å“æ”¾å…¥ç®±å­ï¼Œæ¯ä¸ªç®±å­çš„æ€»é‡é‡ä¸è¶…è¿‡é™åˆ¶ï¼Œæ±‚æœ€å°‘ç®±å­æ•°ã€‚çŠ¶æ€è¡¨ç¤ºå·²æ”¾å…¥çš„ç‰©å“ï¼Œè½¬ç§»æšä¸¾ä¸‹ä¸€ä¸ªç‰©å“ã€‚é€‚åˆå­¦ä¹ çŠ¶å‹DPåœ¨ç‰©å“é€‰æ‹©é—®é¢˜ä¸­çš„åº”ç”¨ã€‚  


## 7. å­¦ä¹ å¿ƒå¾—ä¸ç»éªŒåˆ†äº«ï¼ˆè‹¥æœ‰ï¼‰  
**å‚è€ƒç»éªŒï¼ˆæ¥è‡ªImakfé¢˜è§£ï¼‰**ï¼š  
â€œé¢„å¤„ç†æ¯ä¸ªç¡¬å¸çš„è¦†ç›–èŒƒå›´æ˜¯è§£å†³æœ¬é¢˜çš„å…³é”®ã€‚ä¸€å¼€å§‹æˆ‘ç”¨äºŒåˆ†æ³•ï¼Œç»“æœè¶…æ—¶äº†ï¼Œåæ¥æ¢æˆåŒæŒ‡é’ˆé¢„å¤„ç†ï¼Œæ—¶é—´å°±è¿‡äº†ã€‚â€  
**ç‚¹è¯„**ï¼š  
è¿™ä½ä½œè€…çš„ç»éªŒå¾ˆå…¸å‹ã€‚å¯¹äºå¤§Nçš„é—®é¢˜ï¼Œé¢„å¤„ç†èƒ½å°†å¤šæ¬¡æŸ¥è¯¢çš„æ—¶é—´è½¬åŒ–ä¸ºä¸€æ¬¡é¢„å¤„ç†çš„æ—¶é—´ï¼Œæ˜¾è‘—æå‡ç¨‹åºæ•ˆç‡ã€‚åœ¨ç¼–ç¨‹è¿‡ç¨‹ä¸­ï¼Œè¦æ ¹æ®æ•°æ®èŒƒå›´é€‰æ‹©åˆé€‚çš„ç®—æ³•ï¼Œé¿å…â€œæš´åŠ›â€è§£æ³•ã€‚  


## ç»“è¯­  
æœ¬æ¬¡å…³äºâ€œ[USACO13NOV] No Change Gâ€çš„C++è§£é¢˜åˆ†æå°±åˆ°è¿™é‡Œã€‚å¸Œæœ›è¿™ä»½å­¦ä¹ æŒ‡å—èƒ½å¸®åŠ©å¤§å®¶ç†è§£çŠ¶å‹DPçš„æ ¸å¿ƒæ€æƒ³å’Œè§£é¢˜æŠ€å·§ã€‚è®°ä½ï¼Œç¼–ç¨‹èƒ½åŠ›çš„æå‡åœ¨äº**æŒç»­å­¦ä¹ ã€å‹¤äºæ€è€ƒå’Œå‹‡äºå®è·µ**ã€‚ä¸‹æ¬¡æˆ‘ä»¬å†ä¸€èµ·æ¢ç´¢æ–°çš„ç¼–ç¨‹æŒ‘æˆ˜ï¼ğŸ’ª

---
å¤„ç†ç”¨æ—¶ï¼š216.43ç§’
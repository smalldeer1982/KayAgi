# é¢˜ç›®ä¿¡æ¯

# ã€æ¨¡æ¿ã€‘å¯å¹¶å † 2

## é¢˜ç›®èƒŒæ™¯

æ„Ÿè°¢ @[Spasmodic](https://www.luogu.com.cn/user/121027) æä¾›åˆç‰ˆæ•°æ®ç”Ÿæˆå™¨ã€‚

[gen](https://www.luogu.com.cn/paste/4vk36jsp)ã€‚

## é¢˜ç›®æè¿°

ç»™å®šæ­£æ•´æ•° $n$ å’Œ $m$ ä»¥åŠä¸€ä¸ªé•¿ä¸º $n$ çš„æ•´æ•°åºåˆ— $a_{1,\dots,n}$ã€‚

ä½ éœ€è¦ç»´æŠ¤åºåˆ— $a_{1,\dots,n}$ ä»¥åŠ $n$ ä¸ªé›†åˆ $S_{1,\dots,n}$ï¼Œåˆå§‹æ—¶ $S_i=\{i\}$ã€‚

æ¥ä¸‹æ¥è¦è¿›è¡Œä»¥ä¸‹å››ç§æ“ä½œå…± $m$ æ¬¡ï¼Œæ¯æ¬¡æ“ä½œå½¢å¦‚ï¼š

- `0 x y`ï¼šè¡¨ç¤ºå°†å…ƒç´  $y$ ä»é›†åˆ $S_x$ ä¸­åˆ å»ã€‚ä¿è¯æ­¤æ—¶å…ƒç´  $y$ åœ¨é›†åˆ $S_x$ ä¸­ã€‚
- `1 x`ï¼šè¡¨ç¤ºè¯¢é—® $\min_{i\in S_x} a_i$ï¼Œä¿è¯æ­¤æ—¶é›†åˆ $S_x$ éç©ºã€‚
- `2 x y`ï¼šå°†é›†åˆ $S_y$ ä¸­å¹¶å…¥ $S_x$ å¹¶æ¸…ç©ºé›†åˆ $S_y$ã€‚ä¿è¯æ­¤æ—¶é›†åˆ $S_x,S_y$ å‡éç©ºï¼Œä¸”æ­¤æ¬¡æ“ä½œåä¸ä¼šå†å‡ºç°æ¶‰åŠé›†åˆ $S_y$ çš„æ“ä½œã€‚
- `3 x y z`ï¼šè¡¨ç¤ºå°† $a_y$ èµ‹å€¼ä¸º $z$ã€‚ä¿è¯æ­¤æ—¶å…ƒç´  $y$ åœ¨é›†åˆ $S_x$ ä¸­ï¼Œä¸” $z<a_y$ã€‚

ä¸éš¾å‘ç°è¿™æ˜¯ä¸€é“å †çš„æ¨¡æ¿é¢˜ï¼Œæ‰€ä»¥ç°åœ¨è¯·ä½ å®Œæˆå®ƒã€‚

## è¯´æ˜/æç¤º

å¯¹äº $20\%$ çš„æ•°æ®ï¼Œ$n=m=10$ï¼›

å¯¹äº $80\%$ çš„æ•°æ®ï¼Œ$n=m=10^5$ï¼›

å¯¹äº $100\%$ çš„æ•°æ®ï¼Œ$1\le n,m\le10^6$ï¼Œ$1\le a_i\le2\times10^9$ï¼Œä¿è¯ä»»æ„æ—¶åˆ»ä»»æ„å †ä¸­å…ƒç´ ç»å¯¹å€¼ä¸è¶…è¿‡ $10^{15}$ï¼ˆäººè¯ï¼šä¿è¯æ¯æ¬¡ `3` æ“ä½œæœ€å¤šå•ç‚¹å‡ $5\times10^8$ï¼‰ã€‚

---

æœ€åä¸¤ä¸ªç‚¹å‡ºé¢˜äººçš„æ‰‹å†™å †å’Œ pbds çš„é…å¯¹å †éƒ½è·‘åˆ°äº†å‡ ç™¾æ¯«ç§’ï¼Œå¦‚æœæœ‰è¢«å¡å¸¸çš„å¯ç§ã€‚

## æ ·ä¾‹ #1

### è¾“å…¥

```
5 5
1 2 3 4 4
2 4 5
3 4 5 3
1 4
0 4 5
1 4```

### è¾“å‡º

```
3
4```

# AIåˆ†æç»“æœ

# ğŸ’¡ Kayçš„C++ç®—æ³•è§£æï¼šã€æ¨¡æ¿ã€‘å¯å¹¶å † 2 æ·±å…¥å­¦ä¹ æŒ‡å— ğŸ’¡


## 1. é¢˜ç›®è§£è¯»ä¸æ ¸å¿ƒç®—æ³•è¯†åˆ«

âœ¨ **æœ¬é¢˜ä¸»è¦è€ƒå¯Ÿ**ï¼šç¼–ç¨‹æŠ€å·§åº”ç”¨ï¼ˆå¯å¹¶å †æ•°æ®ç»“æ„çš„çµæ´»è¿ç”¨ï¼‰

ğŸ—£ï¸ **åˆæ­¥åˆ†æ**ï¼š  
ä½ å¯ä»¥æŠŠâ€œå¯å¹¶å †â€æƒ³è±¡æˆ**å¯ä»¥è‡ªç”±æ‹¼æ¥çš„â€œç§¯æœ¨å †â€**â€”â€”æ¯ä¸ªé›†åˆ`S_x`æ˜¯ä¸€å †æŒ‰â€œå°çš„åœ¨ä¸Šâ€ï¼ˆå°æ ¹å †ï¼‰å †å¥½çš„ç§¯æœ¨ï¼Œæˆ‘ä»¬è¦åšçš„æ˜¯ï¼š  
- åˆå¹¶ä¸¤ä¸ªç§¯æœ¨å †ï¼ˆæ“ä½œ2ï¼‰ï¼›  
- æ‹¿èµ°å †é‡ŒæŸå—ç‰¹å®šçš„ç§¯æœ¨ï¼ˆæ“ä½œ0ï¼‰ï¼›  
- æŠŠæŸå—ç§¯æœ¨æ¢å°ä¸€ç‚¹ï¼ˆæ“ä½œ3ï¼‰ï¼›  
- çœ‹æ¯ä¸ªå †æœ€ä¸Šé¢çš„å°ç§¯æœ¨ï¼ˆæ“ä½œ1ï¼‰ã€‚  

å¯å¹¶å †çš„æ ¸å¿ƒæ˜¯**â€œæ‡’æ“ä½œâ€+â€œç»“æ„ç»´æŠ¤â€**ï¼šèƒ½ä¸è°ƒæ•´å°±ä¸è°ƒæ•´ï¼Œéè°ƒæ•´ä¸å¯æ—¶å†ç”¨è§„åˆ™ï¼ˆæ¯”å¦‚å·¦åæ ‘çš„â€œè·ç¦»â€ã€æ–æ³¢é‚£å¥‘å †çš„â€œæ ¹é“¾è¡¨â€ï¼‰ä¿è¯æ•ˆç‡ã€‚æœ¬é¢˜çš„æ‰€æœ‰æ“ä½œéƒ½å›´ç»•â€œå¦‚ä½•ç”¨å¯å¹¶å †é«˜æ•ˆå®Œæˆé›†åˆç®¡ç†â€å±•å¼€ï¼Œæ ¸å¿ƒéš¾ç‚¹æ˜¯**å¦‚ä½•å¿«é€Ÿæ‰¾åˆ°/ä¿®æ”¹å †ä¸­çš„ç‰¹å®šå…ƒç´ **ï¼ˆæ¯”å¦‚ç”¨è¿­ä»£å™¨è®°å½•ä½ç½®ï¼‰ã€**å¦‚ä½•ç»´æŠ¤åˆå¹¶åçš„å †ç»“æ„**ï¼ˆæ¯”å¦‚å·¦åæ ‘çš„å·¦å³å­æ ‘äº¤æ¢ï¼‰ã€‚  

å¯è§†åŒ–è®¾è®¡æ€è·¯ï¼šæˆ‘ä»¬ä¼šç”¨**8ä½åƒç´ é£**æ¨¡æ‹Ÿç§¯æœ¨å †â€”â€”æ¯ä¸ªå †æ˜¯ä¸€åˆ—åƒç´ å—ï¼ˆå°çš„åœ¨ä¸Šï¼‰ï¼Œåˆå¹¶æ—¶ä¸¤åˆ—ç§¯æœ¨â€œæ»‘åˆ°ä¸€èµ·â€ï¼Œåˆ é™¤æ—¶æŸå—ç§¯æœ¨â€œæ¶ˆå¤±â€ï¼Œä¿®æ”¹æ—¶ç§¯æœ¨â€œå˜è‰²å˜å°â€ï¼ŒæŸ¥è¯¢æ—¶å †é¡¶ç§¯æœ¨â€œé—ªçƒâ€ã€‚è¿˜ä¼šåŠ å…¥â€œå’”å—’â€çš„åˆå¹¶éŸ³æ•ˆã€â€œå®â€çš„æŸ¥è¯¢éŸ³æ•ˆï¼Œè‡ªåŠ¨æ’­æ”¾æ—¶åƒâ€œç§¯æœ¨æœºå™¨äººâ€ä¸€æ­¥æ­¥å®Œæˆæ“ä½œ~


## 2. ç²¾é€‰ä¼˜è´¨é¢˜è§£å‚è€ƒ

### é¢˜è§£ä¸€ï¼š(æ¥æºï¼šikunTLE)
* **ç‚¹è¯„**ï¼šè¿™ä»½é¢˜è§£ç”¨**GNU PBDSåº“çš„ä¼˜å…ˆé˜Ÿåˆ—**ç›´æ¥â€œç²¾å‡†å‘½ä¸­â€æ‰€æœ‰æ“ä½œéœ€æ±‚â€”â€”`push`è¿”å›è¿­ä»£å™¨è®°å½•ä½ç½®ï¼Œ`erase`åˆ æŒ‡å®šå…ƒç´ ï¼Œ`modify`æ”¹å€¼ï¼Œ`join`åˆå¹¶å †ã€‚ä»£ç ç®€æ´åˆ°â€œæ¯ä¸€è¡Œéƒ½åœ¨è§£å†³é—®é¢˜â€ï¼Œæ¯”å¦‚ç”¨`point_iterator`æ•°ç»„å­˜æ¯ä¸ªå…ƒç´ çš„ä½ç½®ï¼Œå®Œç¾å¯¹åº”é¢˜ç›®ä¸­â€œåˆ é™¤/ä¿®æ”¹ç‰¹å®šå…ƒç´ â€çš„è¦æ±‚ã€‚æ›´éš¾å¾—çš„æ˜¯ï¼Œå®ƒå…¼é¡¾äº†æ•ˆç‡ï¼ˆPBDSçš„ä¼˜å…ˆé˜Ÿåˆ—åº•å±‚æ˜¯é…å¯¹å †ï¼Œåˆå¹¶å¤æ‚åº¦O(1)ï¼‰å’Œå¯è¯»æ€§ï¼Œæ˜¯å…¥é—¨å¯å¹¶å †çš„â€œæœ€ä¼˜å…¥é—¨æ¨¡æ¿â€ã€‚


### é¢˜è§£äºŒï¼š(æ¥æºï¼šbcdmwSjy)
* **ç‚¹è¯„**ï¼šè¿™æ˜¯ä¸€ä»½â€œåŸç†+å®ç°â€åŒæ»¡åˆ†çš„é¢˜è§£ï¼ä½œè€…ç”¨**æ–æ³¢é‚£å¥‘å †**æ·±å…¥è®²è§£äº†å¯å¹¶å †çš„â€œæ‡’åˆå¹¶â€æ€æƒ³â€”â€”åƒâ€œæŠŠä¸¤å †è¡£æœå åœ¨ä¸€èµ·ï¼Œç­‰è¦æ‹¿çš„æ—¶å€™å†æ•´ç†â€ã€‚ä»£ç å®ç°äº†å®Œæ•´çš„æ–æ³¢é‚£å¥‘å †ç»“æ„ï¼ˆNodeç±»ã€push/join/pop/decreaseç­‰æ“ä½œï¼‰ï¼Œç”šè‡³ç”¨æ•°ç»„æ›¿æ¢æŒ‡é’ˆä¼˜åŒ–å¸¸æ•°ï¼ŒæŠ¢åˆ°äº†æœ€ä¼˜è§£ã€‚å¯¹äºæƒ³ç†è§£â€œå¯å¹¶å †ä¸ºä»€ä¹ˆå¿«â€çš„åŒå­¦ï¼Œè¿™ä»½é¢˜è§£æ˜¯â€œåŸç†æ•™ç§‘ä¹¦â€ã€‚


### é¢˜è§£ä¸‰ï¼š(æ¥æºï¼š_Lamiris_)
* **ç‚¹è¯„**ï¼šè¿™ä»½é¢˜è§£ç”¨**å·¦åæ ‘**è§£å†³äº†â€œæ— æ³•ç”¨è·¯å¾„å‹ç¼©æ‰¾æ ¹â€çš„é—®é¢˜â€”â€”ç”¨`root`æ•°ç»„ç›´æ¥å­˜æ¯ä¸ªé›†åˆçš„æ ¹èŠ‚ç‚¹ï¼Œåˆå¹¶æ—¶æ›´æ–°æ ¹ï¼Œåˆ é™¤æ—¶è°ƒæ•´å·¦å³å­æ ‘å¹¶`push_up`ç»´æŠ¤è·ç¦»ã€‚ä»£ç ä¸­çš„`merge`å‡½æ•°ä¸¥æ ¼éµå¾ªå·¦åæ ‘çš„è§„åˆ™ï¼ˆå°æ ¹å †ã€äº¤æ¢å·¦å³å­æ ‘ä¿è¯è·ç¦»ï¼‰ï¼Œ`erase`æ“ä½œå¤„ç†äº†çˆ¶èŠ‚ç‚¹å’Œå­æ ‘çš„è¿æ¥ï¼Œæ—¶é—´å¤æ‚åº¦O(m log n)ï¼Œè·‘èµ·æ¥æ¯”æ–æ³¢é‚£å¥‘å †è¿˜å¿«ï¼ˆ325msï¼‰ã€‚å¯¹äºæƒ³æ‰‹å†™å¯å¹¶å †çš„åŒå­¦ï¼Œè¿™ä»½é¢˜è§£æ˜¯â€œå®æˆ˜æ¨¡æ¿â€ã€‚


## 3. æ ¸å¿ƒéš¾ç‚¹è¾¨æä¸è§£é¢˜ç­–ç•¥

### 1. éš¾ç‚¹1ï¼šå¦‚ä½•é«˜æ•ˆç»´æŠ¤é›†åˆçš„æ ¹èŠ‚ç‚¹ï¼Ÿ
* **åˆ†æ**ï¼šå¯å¹¶å †çš„åˆå¹¶ä¼šæ”¹å˜é›†åˆçš„æ ¹ï¼ˆæ¯”å¦‚å·¦åæ ‘åˆå¹¶åæ ¹æ˜¯è¾ƒå°çš„é‚£ä¸ªï¼‰ï¼Œå¦‚æœæ¯æ¬¡æ‰¾æ ¹éƒ½å‘ä¸Šéå†ï¼Œä¼šè¶…æ—¶ã€‚  
* **è§£å†³æ–¹æ¡ˆ**ï¼šç”¨`root`æ•°ç»„**ç›´æ¥è®°å½•æ¯ä¸ªé›†åˆçš„æ ¹èŠ‚ç‚¹**ï¼ˆå¦‚_Lamiris_çš„é¢˜è§£ï¼‰ã€‚åˆå¹¶æ—¶æ›´æ–°`root[x]`ä¸ºåˆå¹¶åçš„æ ¹ï¼Œåˆ é™¤/ä¿®æ”¹æ—¶ç›´æ¥æ“ä½œ`root[x]`ï¼Œé¿å…é‡å¤éå†ã€‚


### 2. éš¾ç‚¹2ï¼šå¦‚ä½•åˆ é™¤/ä¿®æ”¹å †ä¸­çš„ç‰¹å®šå…ƒç´ ï¼Ÿ
* **åˆ†æ**ï¼šæ ‡å‡†å †ï¼ˆå¦‚std::priority_queueï¼‰ä¸æ”¯æŒâ€œåˆ ä»»æ„å…ƒç´ â€æˆ–â€œæ”¹ç‰¹å®šå…ƒç´ â€ï¼Œå› ä¸ºå®ƒä»¬æ²¡æœ‰è®°å½•å…ƒç´ ä½ç½®çš„æœºåˆ¶ã€‚  
* **è§£å†³æ–¹æ¡ˆ**ï¼š  
  - ç”¨**è¿­ä»£å™¨**ï¼šPBDSçš„ä¼˜å…ˆé˜Ÿåˆ—`push`è¿”å›`point_iterator`ï¼Œç›´æ¥è®°å½•æ¯ä¸ªå…ƒç´ çš„ä½ç½®ï¼ˆå¦‚ikunTLEçš„é¢˜è§£ï¼‰ï¼›  
  - ç”¨**æ‹†åˆ†+åˆå¹¶**ï¼šå·¦åæ ‘/æ–æ³¢é‚£å¥‘å †ä¸­ï¼Œåˆ é™¤å…ƒç´ ç­‰äºâ€œæ‹†å‡ºè¯¥å…ƒç´ çš„å­æ ‘ï¼Œå†åˆå¹¶å›å»â€ï¼ˆå¦‚_Lamiris_çš„`erase`å‡½æ•°ï¼‰ã€‚


### 3. éš¾ç‚¹3ï¼šå¦‚ä½•ä¿è¯åˆå¹¶æ“ä½œçš„æ•ˆç‡ï¼Ÿ
* **åˆ†æ**ï¼š naiveåˆå¹¶ï¼ˆæ¯”å¦‚æŠŠä¸€ä¸ªå †çš„æ‰€æœ‰å…ƒç´ æ’å…¥å¦ä¸€ä¸ªå †ï¼‰æ˜¯O(n)ï¼Œæ— æ³•å¤„ç†1e6çš„æ•°æ®ã€‚  
* **è§£å†³æ–¹æ¡ˆ**ï¼šç”¨**å¯å¹¶å †çš„ç»“æ„ç‰¹æ€§**ï¼š  
  - å·¦åæ ‘ï¼šç”¨â€œè·ç¦»â€ï¼ˆåˆ°æœ€è¿‘ç©ºèŠ‚ç‚¹çš„è·¯å¾„é•¿åº¦ï¼‰ä¿è¯åˆå¹¶å¤æ‚åº¦O(log n)ï¼›  
  - æ–æ³¢é‚£å¥‘å †ï¼šâ€œæ‡’åˆå¹¶â€â€”â€”æŠŠä¸¤ä¸ªæ ¹é“¾è¡¨è¿èµ·æ¥ï¼Œç­‰éœ€è¦æ—¶å†æ•´ç†ï¼Œåˆå¹¶å¤æ‚åº¦O(1)ï¼›  
  - PBDSä¼˜å…ˆé˜Ÿåˆ—ï¼šåº•å±‚æ˜¯é…å¯¹å †ï¼Œåˆå¹¶å¤æ‚åº¦O(1)ã€‚


## 4. C++æ ¸å¿ƒä»£ç å®ç°èµæ

### æœ¬é¢˜é€šç”¨æ ¸å¿ƒC++å®ç°å‚è€ƒ
* **è¯´æ˜**ï¼šæœ¬ä»£ç æ¥è‡ªikunTLEçš„é¢˜è§£ï¼Œç”¨GNU PBDSåº“çš„ä¼˜å…ˆé˜Ÿåˆ—ç›´æ¥å®ç°æ‰€æœ‰æ“ä½œï¼Œæ˜¯æœ€ç®€æ´çš„æ ¸å¿ƒå®ç°ã€‚
* **å®Œæ•´æ ¸å¿ƒä»£ç **ï¼š
  ```cpp
  #include <iostream>
  #include <bits/extc++.h>
  using namespace std;
  using namespace __gnu_pbds;

  int read() {
      int x = 0; char ch = getchar();
      while (ch < '0' || ch > '9') ch = getchar();
      while (ch >= '0' && ch <= '9') x = x * 10 + ch - '0', ch = getchar();
      return x;
  }

  const int N = 1e6 + 10;
  __gnu_pbds::priority_queue<int, greater<int>> pq[N];
  __gnu_pbds::priority_queue<int, greater<int>>::point_iterator p[N];

  int main() {
      int n = read(), m = read();
      for (int i = 1; i <= n; ++i) {
          int x = read();
          p[i] = pq[i].push(x);
      }
      while (m--) {
          int op = read();
          if (op == 0) {
              int x = read(), y = read();
              pq[x].erase(p[y]);
          } else if (op == 1) {
              int x = read();
              printf("%d\n", pq[x].top());
          } else if (op == 2) {
              int x = read(), y = read();
              pq[x].join(pq[y]);
          } else if (op == 3) {
              int x = read(), y = read(), z = read();
              pq[x].modify(p[y], z);
          }
      }
      return 0;
  }
  ```
* **ä»£ç è§£è¯»æ¦‚è¦**ï¼š  
  1. ç”¨`read`å‡½æ•°å¿«é€Ÿè¯»å…¥æ•°æ®ï¼ˆé¿å…cinè¶…æ—¶ï¼‰ï¼›  
  2. æ¯ä¸ªé›†åˆ`S_x`å¯¹åº”ä¸€ä¸ª`pq[x]`ï¼ˆå°æ ¹å †ï¼‰ï¼Œ`p[i]`è®°å½•å…ƒç´ `i`çš„è¿­ä»£å™¨ï¼›  
  3. æ“ä½œ0ï¼šç”¨`erase(p[y])`åˆ é™¤å…ƒç´ `y`ï¼ˆ`p[y]`æ˜¯å…ƒç´ `y`çš„ä½ç½®ï¼‰ï¼›  
  4. æ“ä½œ1ï¼šç”¨`top()`å–å †é¡¶æœ€å°å€¼ï¼›  
  5. æ“ä½œ2ï¼šç”¨`join(pq[y])`åˆå¹¶`S_x`å’Œ`S_y`ï¼›  
  6. æ“ä½œ3ï¼šç”¨`modify(p[y], z)`æŠŠå…ƒç´ `y`çš„å€¼æ”¹ä¸º`z`ã€‚


### é¢˜è§£äºŒï¼š(æ¥æºï¼šbcdmwSjy æ–æ³¢é‚£å¥‘å †)
* **äº®ç‚¹**ï¼šå®Œæ•´å®ç°æ–æ³¢é‚£å¥‘å †çš„æ‰€æœ‰æ“ä½œï¼ŒåŸç†è®²è§£æ·±å…¥ï¼Œå¸¸æ•°ä¼˜åŒ–åé€Ÿåº¦æå¿«ã€‚
* **æ ¸å¿ƒä»£ç ç‰‡æ®µ**ï¼š
  ```cpp
  class Node {
  public:
      bool mark;
      int deg;
      ll key;
      Node *l, *r, *ch, *fa;
      Node(ll k) : key(k), deg(0), mark(false), l(this), r(this), ch(nullptr), fa(nullptr) {}
  };

  class FibHeap {
      int cnt;
      Node* minp;
  public:
      Node* push(ll k) { return pushp(new Node(k)); }
      void join(FibHeap* b) { /* åˆå¹¶æ ¹é“¾è¡¨ */ }
      void pop() { /* å¼¹å‡ºæœ€å°å€¼å¹¶æ•´ç†å † */ }
      void decrease(Node* p, ll k) { /* å‡å°å€¼å¹¶è°ƒæ•´å † */ }
      void erase(Node* p) { decrease(p, minp->key - 1); pop(); }
  };
  ```
* **ä»£ç è§£è¯»**ï¼š  
  - `Node`ç±»ï¼šæ¯ä¸ªèŠ‚ç‚¹å­˜`mark`ï¼ˆæ˜¯å¦è¢«å‰ªè¿‡ï¼‰ã€`deg`ï¼ˆåº¦æ•°ï¼‰ã€`key`ï¼ˆå€¼ï¼‰ã€`l/r`ï¼ˆæ ¹é“¾è¡¨çš„å·¦å³æŒ‡é’ˆï¼‰ã€`ch`ï¼ˆå­èŠ‚ç‚¹ï¼‰ã€`fa`ï¼ˆçˆ¶èŠ‚ç‚¹ï¼‰ï¼›  
  - `FibHeap`ç±»ï¼š`push`æ–°å»ºèŠ‚ç‚¹å¹¶å…¥æ ¹é“¾è¡¨ï¼›`join`åˆå¹¶ä¸¤ä¸ªæ ¹é“¾è¡¨ï¼›`pop`å¼¹å‡ºæœ€å°å€¼å¹¶æŠŠå…¶å­èŠ‚ç‚¹åŠ å…¥æ ¹é“¾è¡¨ï¼Œå†åˆå¹¶ç›¸åŒåº¦æ•°çš„æ ‘ï¼›`decrease`å‡å°å€¼åï¼Œè‹¥ç ´åå †åºåˆ™â€œå‰ªæâ€ï¼ˆæŠŠèŠ‚ç‚¹ç§»åˆ°æ ¹é“¾è¡¨ï¼‰ï¼›`erase`é€šè¿‡`decrease`æŠŠèŠ‚ç‚¹å€¼æ”¹ä¸ºæå°ï¼Œå†`pop`ã€‚  
* **å­¦ä¹ ç¬”è®°**ï¼šæ–æ³¢é‚£å¥‘å †çš„â€œæ‡’â€æ˜¯å…³é”®â€”â€”èƒ½ä¸æ•´ç†å°±ä¸æ•´ç†ï¼ŒæŠŠå¤æ‚åº¦å‡æ‘Šåˆ°åç»­æ“ä½œä¸­ã€‚


### é¢˜è§£ä¸‰ï¼š(æ¥æºï¼š_Lamiris_ å·¦åæ ‘)
* **äº®ç‚¹**ï¼šç”¨`root`æ•°ç»„ç»´æŠ¤é›†åˆæ ¹ï¼Œ`erase`æ“ä½œç›´æ¥è°ƒæ•´å­æ ‘ï¼Œæ—¶é—´å¤æ‚åº¦O(log n)ã€‚
* **æ ¸å¿ƒä»£ç ç‰‡æ®µ**ï¼š
  ```cpp
  struct ZPS { int ls, rs, dis, fa; ll val; } tree[N];
  int root[N];

  int merge(int x, int y) {
      if (!x || !y) return x | y;
      if (tree[x].val > tree[y].val || (tree[x].val == tree[y].val && x > y)) swap(x, y);
      tree[x].rs = merge(tree[x].rs, y);
      if (tree[tree[x].ls].dis < tree[tree[x].rs].dis) swap(tree[x].ls, tree[x].rs);
      tree[x].dis = tree[tree[x].rs].dis + 1;
      tree[tree[x].ls].fa = tree[tree[x].rs].fa = x;
      return x;
  }

  inline int erase(const int x, const int pos) {
      int y = merge(tree[x].ls, tree[x].rs);
      if (tree[x].fa != x) {
          tree[y].fa = tree[x].fa;
          if (tree[tree[y].fa].ls == x) tree[tree[y].fa].ls = y;
          if (tree[tree[y].fa].rs == x) tree[tree[y].fa].rs = y;
          push_up(tree[y].fa);
      } else root[pos] = y;
      tree[x].fa = y; tree[x].ls = tree[x].rs = 0;
      return pos;
  }
  ```
* **ä»£ç è§£è¯»**ï¼š  
  - `merge`å‡½æ•°ï¼šåˆå¹¶ä¸¤ä¸ªå·¦åæ ‘ï¼Œä¿è¯å°æ ¹å †æ€§è´¨ï¼Œäº¤æ¢å·¦å³å­æ ‘ç»´æŒâ€œå·¦å­æ ‘è·ç¦»â‰¥å³å­æ ‘â€ï¼Œæ›´æ–°`dis`ï¼ˆåˆ°æœ€è¿‘ç©ºèŠ‚ç‚¹çš„è·ç¦»ï¼‰ï¼›  
  - `erase`å‡½æ•°ï¼šåˆå¹¶`x`çš„å·¦å³å­æ ‘`y`ï¼Œè‹¥`x`ä¸æ˜¯æ ¹ï¼Œåˆ™æŠŠ`y`æ¥åœ¨`x`çš„çˆ¶èŠ‚ç‚¹ä¸‹ï¼Œå†`push_up`ç»´æŠ¤çˆ¶èŠ‚ç‚¹çš„`dis`ï¼›è‹¥`x`æ˜¯æ ¹ï¼Œåˆ™æ›´æ–°`root[pos]`ä¸º`y`ã€‚  
* **å­¦ä¹ ç¬”è®°**ï¼šå·¦åæ ‘çš„â€œè·ç¦»â€æ˜¯ä¿è¯åˆå¹¶æ•ˆç‡çš„å…³é”®â€”â€”è·ç¦»è¶Šå°ï¼Œæ ‘è¶Šâ€œå·¦åâ€ï¼Œåˆå¹¶æ—¶é€’å½’æ·±åº¦è¶Šæµ…ã€‚


## 5. ç®—æ³•å¯è§†åŒ–ï¼šåƒç´ åŠ¨ç”»æ¼”ç¤º

### åŠ¨ç”»ä¸»é¢˜ï¼šç§¯æœ¨æ‹¼æ¥å°èƒ½æ‰‹ï¼ˆ8ä½åƒç´ é£ï¼‰
**è®¾è®¡æ€è·¯**ï¼šç”¨åƒç´ å—æ¨¡æ‹Ÿå¯å¹¶å †ï¼Œæ¯ä¸ªé›†åˆæ˜¯ä¸€åˆ—â€œå°ç§¯æœ¨â€ï¼ˆå°çš„åœ¨ä¸Šï¼‰ï¼Œæ“ä½œæ—¶ç”¨åŠ¨ç”»+éŸ³æ•ˆå¼ºåŒ–è®°å¿†ï¼Œåƒç©â€œç§¯æœ¨æ¸¸æˆâ€ä¸€æ ·å­¦å¯å¹¶å †ï¼


### åŠ¨ç”»å¸§æ­¥éª¤ä¸äº¤äº’è®¾è®¡
1. **åœºæ™¯åˆå§‹åŒ–**ï¼š  
   - å±å¹•å·¦ä¾§æ˜¯**ç§¯æœ¨å †åŒº**ï¼šæ¯ä¸ªé›†åˆ`S_x`æ˜¯ä¸€åˆ—16x16çš„åƒç´ å—ï¼ˆé¢œè‰²åŒºåˆ†ï¼Œæ¯”å¦‚`S_1`æ˜¯è“è‰²ï¼Œ`S_2`æ˜¯çº¢è‰²ï¼‰ï¼Œå †é¡¶ç§¯æœ¨é—ªçƒï¼›  
   - å³ä¾§æ˜¯**æ§åˆ¶é¢æ¿**ï¼šâ€œå¼€å§‹/æš‚åœâ€â€œå•æ­¥â€â€œé‡ç½®â€æŒ‰é’®ï¼Œé€Ÿåº¦æ»‘å—ï¼Œâ€œè‡ªåŠ¨æ’­æ”¾â€å¼€å…³ï¼›  
   - åº•éƒ¨æ˜¯**ä»£ç åŒæ­¥åŒº**ï¼šæ˜¾ç¤ºå½“å‰æ“ä½œå¯¹åº”çš„C++ä»£ç ï¼ˆæ¯”å¦‚åˆå¹¶æ—¶é«˜äº®`pq[x].join(pq[y])`ï¼‰ï¼›  
   - èƒŒæ™¯æ’­æ”¾8ä½é£æ ¼çš„ã€Šç§¯æœ¨è¿›è¡Œæ›²ã€‹BGMã€‚

2. **æ“ä½œæ¼”ç¤º**ï¼š  
   - **åˆå¹¶ï¼ˆæ“ä½œ2ï¼‰**ï¼šç‚¹å‡»â€œè‡ªåŠ¨æ’­æ”¾â€ï¼Œ`S_2`çš„çº¢è‰²ç§¯æœ¨å †â€œæ»‘å‘â€`S_1`çš„è“è‰²ç§¯æœ¨å †ï¼Œæ‹¼æ¥æˆä¸€ä¸ªæ–°å †ï¼Œä¼´éšâ€œå’”å—’â€éŸ³æ•ˆï¼›  
   - **åˆ é™¤ï¼ˆæ“ä½œ0ï¼‰**ï¼šé€‰ä¸­`S_1`ä¸­çš„æŸä¸ªç§¯æœ¨ï¼ˆæ¯”å¦‚ç¬¬3å—ï¼‰ï¼Œç§¯æœ¨â€œæ¶ˆå¤±â€ï¼Œå‘¨å›´ç§¯æœ¨â€œä¸‹è½â€å¡«è¡¥ç©ºä½ï¼Œä¼´éšâ€œå’»â€çš„éŸ³æ•ˆï¼›  
   - **ä¿®æ”¹ï¼ˆæ“ä½œ3ï¼‰**ï¼šé€‰ä¸­`S_1`ä¸­çš„æŸä¸ªç§¯æœ¨ï¼Œç§¯æœ¨é¢œè‰²å˜æµ…ï¼ˆè¡¨ç¤ºå€¼å˜å°ï¼‰ï¼Œè‹¥ç ´åå †åºï¼Œåˆ™ç§¯æœ¨â€œè·³â€åˆ°å †é¡¶ï¼Œä¼´éšâ€œå®â€çš„éŸ³æ•ˆï¼›  
   - **æŸ¥è¯¢ï¼ˆæ“ä½œ1ï¼‰**ï¼š`S_1`çš„å †é¡¶ç§¯æœ¨â€œé—ªçƒâ€ä¸‰æ¬¡ï¼Œåº•éƒ¨æ˜¾ç¤ºâ€œæœ€å°å€¼ï¼šXâ€ï¼Œä¼´éšâ€œæ»´â€çš„éŸ³æ•ˆã€‚

3. **æ¸¸æˆåŒ–å…ƒç´ **ï¼š  
   - **é—¯å…³æ¨¡å¼**ï¼šè®¾è®¡3å…³ï¼š  
     1. åˆå¹¶2ä¸ªå †ï¼ˆå…¥é—¨å…³ï¼‰ï¼›  
     2. åˆ é™¤+æŸ¥è¯¢ï¼ˆè¿›é˜¶å…³ï¼‰ï¼›  
     3. ä¿®æ”¹+åˆå¹¶ï¼ˆæŒ‘æˆ˜å…³ï¼‰ï¼›  
   - **ç§¯åˆ†ç³»ç»Ÿ**ï¼šæ¯å®Œæˆä¸€ä¸ªæ“ä½œå¾—10åˆ†ï¼Œè¿ç»­å®Œæˆ3ä¸ªæ“ä½œå¾—â€œè¿å‡»å¥–åŠ±â€ï¼ˆé¢å¤–20åˆ†ï¼‰ï¼Œé€šå…³å¾—â€œç§¯æœ¨å¤§å¸ˆâ€ç§°å·ï¼›  
   - **AIæ¼”ç¤º**ï¼šç‚¹å‡»â€œAIè‡ªåŠ¨ç©â€ï¼Œæœºå™¨äººä¼šä¸€æ­¥æ­¥å®Œæˆæ‰€æœ‰æ“ä½œï¼Œåƒâ€œç§¯æœ¨æœºå™¨äººâ€ä¸€æ ·å±•ç¤ºæœ€ä¼˜æµç¨‹ã€‚


## 6. æ‹“å±•ç»ƒä¹ ä¸ç›¸ä¼¼é—®é¢˜æ€è€ƒ

### é€šç”¨æ€è·¯è¿ç§»
å¯å¹¶å †çš„æ ¸å¿ƒæ˜¯**â€œåˆå¹¶+å †åºç»´æŠ¤â€**ï¼Œé€‚ç”¨äºéœ€è¦â€œåŠ¨æ€åˆå¹¶é›†åˆ+æŸ¥è¯¢æå€¼â€çš„é—®é¢˜ï¼Œæ¯”å¦‚ï¼š  
- åˆå¹¶æœå­ï¼ˆæŠŠä¸¤å †æœå­åˆå¹¶ï¼Œæ±‚æœ€å°æ€»ä»£ä»·ï¼‰ï¼›  
- åŠ¨æ€ç»´æŠ¤å¤šä¸ªé›†åˆçš„æœ€å°å€¼ï¼ˆæ¯”å¦‚åˆ†å¸ƒå¼ç³»ç»Ÿä¸­çš„ä»»åŠ¡è°ƒåº¦ï¼‰ï¼›  
- ä¼˜åŒ–Dijkstraç®—æ³•ï¼ˆç”¨æ–æ³¢é‚£å¥‘å †ä¼˜åŒ–æå–æœ€å°è¾¹çš„æ—¶é—´ï¼‰ã€‚


### æ´›è°·ç»ƒä¹ æ¨è
1. **P3377 ã€æ¨¡æ¿ã€‘å¯å¹¶å †**ï¼šåŸºç¡€å¯å¹¶å †æ¨¡æ¿ï¼Œç»ƒæ‰‹å·¦åæ ‘/æ–æ³¢é‚£å¥‘å †ï¼›  
2. **P1631 åˆå¹¶æœå­**ï¼šå¯å¹¶å †ç»å…¸åº”ç”¨ï¼Œæ±‚åˆå¹¶æœå­çš„æœ€å°æ€»ä»£ä»·ï¼›  
3. **P2713 ç‰§å¸ˆçº¦ç¿°çš„éš¾é¢˜**ï¼šç”¨å¯å¹¶å †ä¼˜åŒ–åŒºé—´åˆå¹¶ï¼Œæ±‚æœ€å¤§ç©ºé—²æ—¶é—´ï¼›  
4. **P4053 [JSOI2007] å»ºç­‘æŠ¢ä¿®**ï¼šç”¨å¯å¹¶å †ç»´æŠ¤å½“å‰å¯é€‰çš„æŠ¢ä¿®ä»»åŠ¡ï¼Œæ±‚æœ€å¤šå®Œæˆæ•°ã€‚


## 7. å­¦ä¹ å¿ƒå¾—ä¸ç»éªŒåˆ†äº«

### æ¥è‡ªé¢˜è§£ä½œè€…çš„ç»éªŒ
- **ikunTLE**ï¼šâ€œPBDSçš„ä¼˜å…ˆé˜Ÿåˆ—æ˜¯â€˜æ‡’äººç¥å™¨â€™ï¼Œä½†è¦è®°å¾—ç”¨`point_iterator`è®°å½•å…ƒç´ ä½ç½®ï¼Œå¦åˆ™æ— æ³•åˆ é™¤/ä¿®æ”¹ï¼â€  
- **bcdmwSjy**ï¼šâ€œæ–æ³¢é‚£å¥‘å †çš„æŒ‡é’ˆå®ç°å¸¸æ•°å¤§ï¼Œæ¢æˆæ•°ç»„+å¿«è¯»èƒ½æŠ¢æœ€ä¼˜è§£ï¼â€  
- **_Lamiris_**ï¼šâ€œå·¦åæ ‘çš„`root`æ•°ç»„æ˜¯å…³é”®ï¼Œé¿å…å‘ä¸Šæ‰¾æ ¹è¶…æ—¶ï¼â€


## ç»“è¯­
å¯å¹¶å †æ˜¯â€œåŠ¨æ€é›†åˆç®¡ç†â€çš„ç¥å™¨ï¼Œä¸ç®¡æ˜¯PBDSçš„â€œæ‡’äººè§£æ³•â€ï¼Œè¿˜æ˜¯å·¦åæ ‘ã€æ–æ³¢é‚£å¥‘å †çš„â€œæ‰‹å†™è§£æ³•â€ï¼Œæ ¸å¿ƒéƒ½æ˜¯**ç”¨ç»“æ„ç»´æŠ¤æ•ˆç‡**ã€‚å¸Œæœ›è¿™ä»½æŒ‡å—èƒ½å¸®ä½ â€œç©ç€ç§¯æœ¨â€å­¦ä¼šå¯å¹¶å †â€”â€”ä¸‹æ¬¡é‡åˆ°â€œåˆå¹¶é›†åˆ+æŸ¥æå€¼â€çš„é—®é¢˜ï¼Œä½ å°±æ˜¯â€œç§¯æœ¨æ‹¼æ¥å°èƒ½æ‰‹â€ï¼ğŸ’ª

å¦‚æœæƒ³æ·±å…¥ï¼Œä¸å¦¨è¯•è¯•æ‰‹å†™å·¦åæ ‘ï¼Œæˆ–è€…ç”¨æ–æ³¢é‚£å¥‘å †ä¼˜åŒ–Dijkstraâ€”â€”ç¼–ç¨‹çš„ä¹è¶£ï¼Œå°±åœ¨äºâ€œç”¨ä»£ç è§£å†³é—®é¢˜â€çš„æˆå°±æ„Ÿå‘€ï¼

---
å¤„ç†ç”¨æ—¶ï¼š95.56ç§’
# é¢˜ç›®ä¿¡æ¯

# [SCOI2010] ä¼ é€å¸¦

## é¢˜ç›®æè¿°

åœ¨ä¸€ä¸ª $2$ ç»´å¹³é¢ä¸Šæœ‰ä¸¤æ¡ä¼ é€å¸¦ï¼Œæ¯ä¸€æ¡ä¼ é€å¸¦å¯ä»¥çœ‹æˆæ˜¯ä¸€æ¡çº¿æ®µã€‚ä¸¤æ¡ä¼ é€å¸¦åˆ†åˆ«ä¸ºçº¿æ®µ $\text{AB}$ å’Œçº¿æ®µ $\text{CD}$ã€‚lxhgww åœ¨ $\text{AB}$ ä¸Šçš„ç§»åŠ¨é€Ÿåº¦ä¸º $P$ï¼Œåœ¨ $\text{CD}$ ä¸Šçš„ç§»åŠ¨é€Ÿåº¦ä¸º $Q$ï¼Œåœ¨å¹³é¢ä¸Šçš„ç§»åŠ¨é€Ÿåº¦ $R$ã€‚ç°åœ¨ lxhgww æƒ³ä» $\text A$ ç‚¹èµ°åˆ° $\text D$ ç‚¹ï¼Œä»–æƒ³çŸ¥é“æœ€å°‘éœ€è¦èµ°å¤šé•¿æ—¶é—´ã€‚


## è¯´æ˜/æç¤º

å¯¹äº $100\%$ çš„æ•°æ®ï¼Œ$1\le A_x,A_y,B_x,B_y,C_x,C_y,D_x,D_y\le10^3$ï¼Œ$1\le P,Q,R\le10$ã€‚

## æ ·ä¾‹ #1

### è¾“å…¥

```
0 0 0 100

100 0 100 100

2 2 1

```

### è¾“å‡º

```
136.60```

# AIåˆ†æç»“æœ


# ğŸ’¡ Kayçš„C++ç®—æ³•è§£æï¼š[SCOI2010]ä¼ é€å¸¦ æ·±å…¥å­¦ä¹ æŒ‡å— ğŸ’¡

## 1. é¢˜ç›®è§£è¯»ä¸æ ¸å¿ƒç®—æ³•è¯†åˆ«

âœ¨ **æœ¬é¢˜ä¸»è¦è€ƒå¯Ÿ**ï¼š`æœç´¢ï¼ˆä¸‰åˆ†æ³•ï¼‰`

ğŸ—£ï¸ **åˆæ­¥åˆ†æ**ï¼š
> è§£å†³è¿™é“é¢˜çš„æ ¸å¿ƒåœ¨äºç†è§£ä¸‰åˆ†æ³•çš„åº”ç”¨ã€‚æƒ³è±¡ä½ åœ¨å±±è°·ä¸­å¯»æ‰¾æœ€ä½ç‚¹â€”â€”æ¯æ¬¡å°†æœç´¢åŒºé—´åˆ†æˆä¸‰ä»½ï¼Œé€šè¿‡æ¯”è¾ƒä¸­é—´ä¸¤ç‚¹çš„é«˜åº¦ï¼Œå°±èƒ½èˆå¼ƒ1/3çš„åŒºé—´ï¼Œé€æ­¥é€¼è¿‘æœ€ä¼˜ç‚¹ã€‚åœ¨æœ¬é¢˜ä¸­ï¼Œæˆ‘ä»¬éœ€è¦åœ¨ABçº¿æ®µä¸Šæ‰¾ç‚¹Eï¼ŒCDçº¿æ®µä¸Šæ‰¾ç‚¹Fï¼Œä½¿å¾—æ€»æ—¶é—´`AE/P + EF/R + FD/Q`æœ€å°ã€‚ç”±äºæ—¶é—´å‡½æ•°å…³äºEå’ŒFéƒ½æ˜¯å•å³°å‡½æ•°ï¼ˆç±»ä¼¼å±±è°·åœ°å½¢ï¼‰ï¼Œæˆ‘ä»¬å¯ä»¥é‡‡ç”¨ä¸‰åˆ†å¥—ä¸‰åˆ†ç­–ç•¥ï¼š
>   - **å¤–å±‚ä¸‰åˆ†**ï¼šåœ¨ABçº¿æ®µä¸Šå¯»æ‰¾æœ€ä¼˜çš„Eç‚¹
>   - **å†…å±‚ä¸‰åˆ†**ï¼šå›ºå®šEç‚¹æ—¶ï¼Œåœ¨CDçº¿æ®µä¸Šå¯»æ‰¾æœ€ä¼˜çš„Fç‚¹
>
> **å¯è§†åŒ–è®¾è®¡æ€è·¯**ï¼šåœ¨åƒç´ åŠ¨ç”»ä¸­å°†ABå’ŒCDæ˜¾ç¤ºä¸ºä¸¤æ¡å‘å…‰ä¼ é€å¸¦ã€‚E/Fç‚¹ç”¨é—ªçƒæ–¹å—æ ‡è®°ï¼Œè·¯å¾„ç”¨åŠ¨æ€åƒç´ çº¿è¿æ¥ã€‚é«˜äº®æ˜¾ç¤ºå½“å‰ä¸‰åˆ†åŒºé—´å’Œä¸­é—´ç‚¹ä½ç½®ï¼Œå®æ—¶è®¡ç®—å¹¶æ˜¾ç¤ºè·¯å¾„æ—¶é—´ã€‚å½“ç®—æ³•æ”¶ç¼©åŒºé—´æ—¶æ’­æ”¾"æ»´"éŸ³æ•ˆï¼Œæ‰¾åˆ°è§£æ—¶æ’­æ”¾èƒœåˆ©éŸ³æ•ˆã€‚

---

## 2. ç²¾é€‰ä¼˜è´¨é¢˜è§£å‚è€ƒ

**é¢˜è§£ä¸€ï¼ˆæ¥æºï¼šAThousandSunsï¼‰**
* **ç‚¹è¯„**ï¼šæ­¤è§£æ³•é‡‡ç”¨æ ‡å‡†çš„ä¸‰åˆ†å¥—ä¸‰åˆ†æ¡†æ¶ï¼Œæ€è·¯æ¸…æ™°ç›´ç™½ã€‚ä»£ç ä¸­ï¼š
  - å°†AB/CDå‚æ•°åŒ–ä¸ºæ¯”ä¾‹ï¼ˆ0~1ï¼‰ï¼Œé¿å…ç›´æ¥å¤„ç†åæ ‡è®¡ç®—ï¼Œé€»è¾‘æ›´ç®€æ´
  - å†…å±‚ä¸‰åˆ†å‡½æ•°`checkplus`å°è£…è‰¯å¥½ï¼Œåˆ†ç¦»äº†E/Fç‚¹è®¡ç®—
  - ç”¨`fabs`æ¯”è¾ƒæµ®ç‚¹æ•°ç²¾åº¦ä¸¥è°¨ï¼Œé¿å…å¸¸è§é™·é˜±
  *äº®ç‚¹ï¼šé€šè¿‡æ•°å­¦æ¨å¯¼è¯æ˜äº†å•å³°æ€§ï¼Œå¹¶ç»™å‡ºæ¯”ä¾‹å‚æ•°åŒ–çš„é€šç”¨å®ç°*

**é¢˜è§£äºŒï¼ˆæ¥æºï¼šbztMinamotoï¼‰**
* **ç‚¹è¯„**ï¼šé‡‡ç”¨æš´åŠ›æšä¸¾æ³•ï¼Œå°†AB/CDå„åˆ†æˆ5000ä¸ªç‚¹ï¼š
  - ä»£ç å¼‚å¸¸ç®€æ´ï¼ˆä»…30è¡Œï¼‰ï¼Œå˜é‡å‘½åç›´è§‚ï¼ˆ`t1/t2`è¡¨æ—¶é—´ï¼‰
  - é€šè¿‡é¢„å¤„ç†åæ ‡å’Œè·ç¦»ï¼Œä¼˜åŒ–äº†åµŒå¥—å¾ªç¯æ•ˆç‡
  - å¯¹åˆå­¦è€…ç†è§£é—®é¢˜æœ¬è´¨å¾ˆæœ‰å¸®åŠ©ï¼Œä½†éœ€æ³¨æ„å¤§èŒƒå›´æ•°æ®å¯èƒ½è¶…æ—¶
  *äº®ç‚¹ï¼šç”¨ç‰©ç†åˆ†æ®µçš„ç›´è§‚æ–¹å¼å±•ç¤ºäº†è§£ç©ºé—´ï¼Œè§„é¿äº†å¤æ‚è¯æ˜*

---

## 3. æ ¸å¿ƒéš¾ç‚¹è¾¨æä¸è§£é¢˜ç­–ç•¥

1. **éš¾ç‚¹ï¼šè¯æ˜æ—¶é—´å‡½æ•°çš„å•å³°æ€§**
   * **åˆ†æ**ï¼šæ—¶é—´å‡½æ•°`f(E,F)`ä¸æ˜¯æ˜¾ç„¶çš„å•å³°å‡½æ•°ã€‚ä¼˜è´¨é¢˜è§£é€šè¿‡å‡ ä½•ç”»æ¿éªŒè¯æˆ–å¯¼æ•°åˆ†æï¼Œå‘ç°å½“å›ºå®šEç‚¹æ—¶ï¼Œ`f(E,F)`å…³äºFæ˜¯å•è°·å‡½æ•°ï¼ˆç±»ä¼¼æŠ›ç‰©çº¿ï¼‰ï¼Œåä¹‹äº¦ç„¶ã€‚è¿™æ˜¯ä¸‰åˆ†å¯è¡Œçš„ç†è®ºåŸºç¡€ã€‚
   * ğŸ’¡ **å­¦ä¹ ç¬”è®°**ï¼šå•å³°æ€§æ˜¯ä¸‰åˆ†æ³•çš„å‰æï¼Œå¯é€šè¿‡å¯è§†åŒ–å·¥å…·è¾…åŠ©éªŒè¯

2. **éš¾ç‚¹ï¼šä¸‰åˆ†æ³•å®ç°ç»†èŠ‚**
   * **åˆ†æ**ï¼šå…³é”®åœ¨æ­£ç¡®å¤„ç†æµ®ç‚¹æ•°ç²¾åº¦ï¼š
     ```cpp
     while(fabs(rx-lx)>1e-8 || fabs(ry-ly)>1e-8) // åŒåæ ‡ç²¾åº¦æ§åˆ¶
     ```
     è®¡ç®—ä¸­é—´ç‚¹æ—¶éœ€ç”¨æ¯”ä¾‹è€Œéç»å¯¹åæ ‡ï¼Œé¿å…çº¿æ®µæ°´å¹³/å‚ç›´çš„ç‰¹æ®Šæƒ…å†µ
   * ğŸ’¡ **å­¦ä¹ ç¬”è®°**ï¼šä¸‰åˆ†æ—¶ä¼˜å…ˆé‡‡ç”¨[0,1]çš„æ¯”ä¾‹å‚æ•°åŒ–ï¼Œè€Œéç›´æ¥è®¡ç®—åæ ‡

3. **éš¾ç‚¹ï¼šè¾¹ç•Œæƒ…å†µå¤„ç†**
   * **åˆ†æ**ï¼šå½“AB/CDé€€åŒ–æˆç‚¹ï¼ˆå¦‚A=Bï¼‰æ—¶éœ€ç‰¹æ®Šå¤„ç†ï¼š
     ```cpp
     if(AB.isPoint()) return E(AB.st); // é€€åŒ–å¤„ç†
     ```
   * ğŸ’¡ **å­¦ä¹ ç¬”è®°**ï¼šæ‰€æœ‰å‡ ä½•ç®—æ³•éƒ½è¦è€ƒè™‘é€€åŒ–æƒ…å†µï¼ˆç‚¹/é‡åˆçº¿æ®µï¼‰

### âœ¨ è§£é¢˜æŠ€å·§æ€»ç»“
- **æŠ€å·§1ï¼šé™ç»´åˆ†æ** - å…ˆå›ºå®šä¸€ä¸ªå˜é‡åˆ†æå¦ä¸€ä¸ªå˜é‡çš„æ€§è´¨
- **æŠ€å·§2ï¼šè®¡ç®—ä¼˜åŒ–** - é¢„å¤„ç†çº¿æ®µé•¿åº¦å’Œæ–¹å‘å‘é‡ï¼Œé¿å…é‡å¤è®¡ç®—è·ç¦»
- **æŠ€å·§3ï¼šç²¾åº¦æ§åˆ¶** - ç”¨ç›¸å¯¹è¯¯å·®æ›¿ä»£ç»å¯¹è¯¯å·®åˆ¤æ–­ï¼ˆå¦‚`while(r-l>1e-5*len)`ï¼‰

---

## 4. C++æ ¸å¿ƒä»£ç å®ç°èµæ

**æœ¬é¢˜é€šç”¨æ ¸å¿ƒC++å®ç°å‚è€ƒ**
```cpp
#include <iostream>
#include <cmath>
#include <iomanip>
using namespace std;

struct Point { double x, y; };
struct Segment { 
    Point st, ed;
    Point at(double p) { // æŒ‰æ¯”ä¾‹pè·å–çº¿æ®µä¸Šç‚¹
        return { st.x + p*(ed.x-st.x), st.y + p*(ed.y-st.y) };
    }
};

double dist(Point a, Point b) {
    return sqrt(pow(a.x-b.x,2) + pow(a.y-b.y,2));
}

double solve(Segment AB, Segment CD, double P, double Q, double R) {
    double l = 0, r = 1;
    for(int i=0; i<50; i++) { // å¤–å±‚ä¸‰åˆ†E
        double m1 = l + (r-l)/3, m2 = r - (r-l)/3;
        Point E1 = AB.at(m1), E2 = AB.at(m2);
        
        // å†…å±‚ä¸‰åˆ†F
        auto f = [&](Point E, double p) {
            Point F = CD.at(p);
            return dist(AB.st,E)/P + dist(E,F)/R + dist(F,CD.ed)/Q;
        };
        
        double fl = 0, fr = 1;
        for(int j=0; j<50; j++) {
            double fm1 = fl + (fr-fl)/3, fm2 = fr - (fr-fl)/3;
            f(E1, fm1) < f(E1, fm2) ? fr = fm2 : fl = fm1;
        }
        double t1 = f(E1, (fl+fr)/2);
        
        // åŒç†è®¡ç®—t2å¹¶æ¯”è¾ƒ...
        t1 < t2 ? r = m2 : l = m1;
    }
    return f(AB.at((l+r)/2), fl); 
}
```

**é¢˜è§£ä¸€æ ¸å¿ƒä»£ç ï¼ˆä¸‰åˆ†æ¯”ä¾‹ï¼‰**
```cpp
double checkplus(double x, double y) { // x:ABæ¯”ä¾‹, y:CDæ¯”ä¾‹
    Point n1 = find(a, b, x); // ABä¸Šxæ¯”ä¾‹å¤„çš„ç‚¹
    Point n2 = find(c, d, y); // CDä¸Šyæ¯”ä¾‹å¤„çš„ç‚¹
    return dist(a,n1)/p + dist(n1,n2)/r + dist(n2,d)/q;
}
```
* **è§£è¯»**ï¼š
  - `find`å‡½æ•°é€šè¿‡çº¿æ€§æ’å€¼è®¡ç®—çº¿æ®µä¸Šçš„ç‚¹
  - æ—¶é—´è®¡ç®—æ‹†è§£ä¸ºä¸‰æ®µè·ç¦»çš„é€Ÿåº¦åŠ æƒå’Œ
  - æ¯”ä¾‹å‚æ•°åŒ–é¿å…åæ ‡è®¡ç®—è¯¯å·®
* ğŸ’¡ **å­¦ä¹ ç¬”è®°**ï¼šæ¯”ä¾‹æ³•å°†å‡ ä½•é—®é¢˜è½¬åŒ–ä¸º[0,1]åŒºé—´ä¼˜åŒ–ï¼Œç®€åŒ–å®ç°

**é¢˜è§£äºŒæ ¸å¿ƒä»£ç ï¼ˆæš´åŠ›æšä¸¾ï¼‰**
```cpp
for(int i=0; i<=N; i++) { // ABåˆ†æˆ5000æ®µ
    x[i] = ax + dx*i; 
    t1[i] = sqrt(dx*i*dx*i + dy*i*dy*i)/p; // é¢„å¤„ç†æ—¶é—´
}
for(int i=0; i<=N; i++) 
for(int j=0; j<=N; j++)
    ans = min(ans, t1[i] + t2[j] + dis(i,j)/r); // æšä¸¾æ‰€æœ‰ç»„åˆ
```
* **è§£è¯»**ï¼š
  - é€šè¿‡`dx=(Bx-Ax)/N`è®¡ç®—ç­‰åˆ†ç‚¹åæ ‡
  - é¢„å¤„ç†æ¯æ®µçš„æ—¶é—´`t1/t2`ï¼Œä¼˜åŒ–åµŒå¥—å¾ªç¯æ•ˆç‡
  - äºŒç»´æšä¸¾æ‰€æœ‰EFç»„åˆ
* ğŸ’¡ **å­¦ä¹ ç¬”è®°**ï¼šå½“ç²¾åº¦è¦æ±‚ä¸é«˜æ—¶ï¼Œç¦»æ•£åŒ–æ˜¯è¿ç»­ä¼˜åŒ–çš„æœ‰æ•ˆæ›¿ä»£

---

## 5. ç®—æ³•å¯è§†åŒ–ï¼šåƒç´ åŠ¨ç”»æ¼”ç¤º

**è®¾è®¡ä¸»é¢˜**ï¼š  
"ä¼ é€å¸¦æ¢é™©" - åœ¨8ä½åƒç´ é£æ ¼çš„ä¼ é€å¸¦ä¸Šæ¼”ç¤ºä¸‰åˆ†æœç´¢è¿‡ç¨‹

**æ ¸å¿ƒæ¼”ç¤º**ï¼š
1. **åˆå§‹åŒ–**ï¼š  
   - ç”»é¢åˆ†ä¸ºä¸Šä¸‹ä¸¤æ¡åƒç´ ä¼ é€å¸¦ï¼ˆABé»„è‰²ï¼ŒCDè“è‰²ï¼‰
   - æ§åˆ¶é¢æ¿å«ï¼šæ­¥è¿›â–¶ï¸|â¸ï¸|ğŸ”æŒ‰é’®ã€é€Ÿåº¦æ»‘å—

2. **ä¸‰åˆ†è¿‡ç¨‹**ï¼š
   ```plaintext
   å¸§1ï¼šABå¸¦æ˜¾ç¤ºå½“å‰ä¸‰åˆ†åŒºé—´ [L-----M1--M2-----R]
   å¸§2ï¼šM1/M2ç‚¹é—ªçƒçº¢å…‰ï¼Œè®¡ç®—å¯¹åº”è·¯å¾„ï¼ˆAâ†’M1â†’Fâ†’Dï¼‰
   å¸§3ï¼šæ ¹æ®æ—¶é—´æ¯”è¾ƒç»“æœï¼Œæ”¶ç¼©åŒºé—´ï¼ˆå¦‚ä¿ç•™[M1,R]ï¼‰
   å¸§4ï¼šCDå¸¦é‡å¤å†…å±‚ä¸‰åˆ†ï¼Œè·¯å¾„çº¿åŠ¨æ€ç»˜åˆ¶
   ```

3. **äº¤äº’ç‰¹æ•ˆ**ï¼š
   - æ¯æ¬¡æ¯”è¾ƒæ’­æ”¾"æ»´"å£°ï¼ŒåŒºé—´æ”¶ç¼©æ—¶æ’­æ”¾"å’”åš“"å£°
   - æ‰¾åˆ°è§£æ—¶è·¯å¾„å˜ç»¿ï¼Œæ’­æ”¾èƒœåˆ©éŸ³æ•ˆ
   - æ”¯æŒè‡ªåŠ¨æ¨¡å¼ï¼ˆAIæ¼”ç¤ºï¼‰ï¼šä»¥è´ªåƒè›‡å¼è‡ªåŠ¨å®Œæˆæœç´¢

**æŠ€æœ¯å®ç°**ï¼š
```javascript
// ä¼ªä»£ç å®ç°æ ¸å¿ƒç»˜åˆ¶
function drawFrame() {
  clearCanvas();
  drawPixelPath(AB, 0xFFD700); // é‡‘è‰²ABå¸¦
  drawPixelPath(CD, 0x1E90FF); // è“è‰²CDå¸¦
  
  // ç»˜åˆ¶å½“å‰E/Fç‚¹
  drawPixel(E.x, E.y, 0xFF0000, true); // çº¢è‰²é—ªçƒ
  drawLine(A, E, 0x00FF00); // ç»¿è‰²è·¯å¾„
  
  // æ˜¾ç¤ºæ—¶é—´å…¬å¼
  drawText(`t = ${dist(A,E)/P} + ${dist(E,F)/R} + ${dist(F,D)/Q}`);
}
```

---

## 6. æ‹“å±•ç»ƒä¹ ä¸ç›¸ä¼¼é—®é¢˜æ€è€ƒ

**é€šç”¨æŠ€å·§è¿ç§»**ï¼š  
ä¸‰åˆ†æ³•å¯æ‰©å±•è‡³ï¼š
1. å•å³°å‡½æ•°æ±‚æå€¼ï¼ˆå¦‚P3382ï¼‰
2. å…‰çº¿æŠ˜å°„è·¯å¾„ä¼˜åŒ–ï¼ˆç‰©ç†æ¨¡å‹ï¼‰
3. èµ„æºåˆ†é…ä¸­çš„æœ€ä¼˜æ¯”ä¾‹é—®é¢˜

**æ´›è°·ç»ƒä¹ æ¨è**ï¼š
1. **P3382** - ä¸‰åˆ†æ³•æ¨¡æ¿  
   *æ¨èç†ç”±ï¼šæŒæ¡å•å³°å‡½æ•°ä¸‰åˆ†çš„åŸºç¡€è®­ç»ƒ*
2. **P2210** - Haywire  
   *æ¨èç†ç”±ï¼šå°†è·¯å¾„ä¼˜åŒ–æŠ€å·§åº”ç”¨äºå›¾è®ºåœºæ™¯*
3. **P4368** - å–·å°„å™¨  
   *æ¨èç†ç”±ï¼šéœ€è¦ç»“åˆç‰©ç†æ¨¡å‹çš„ä¸‰åˆ†åº”ç”¨*

---

## 7. å­¦ä¹ å¿ƒå¾—ä¸ç»éªŒåˆ†äº«

> **æ¥è‡ªbztMinamotoçš„ç»éªŒ**ï¼š  
*"æš´åŠ›è§£æ³•è™½ç„¶æ•ˆç‡ä¸é«˜ï¼Œä½†åœ¨æ¯”èµ›æ—¶å¦‚æœæ— æ³•è¯æ˜å•å³°æ€§ï¼Œç”¨åˆ†æ®µæšä¸¾èƒ½å¿«é€Ÿè·å¾—ä¿åº•åˆ†"*

> **Kayçš„æ€»ç»“**ï¼š  
è°ƒè¯•æ—¶ç‰¹åˆ«æ³¨æ„é€€åŒ–æƒ…å†µâ€”â€”å½“ä¼ é€å¸¦é€€åŒ–æˆç‚¹æ—¶ï¼Œéœ€è¦çŸ­è·¯å¤„ç†ã€‚å»ºè®®ç¼–å†™è·ç¦»è®¡ç®—å‡½æ•°åç«‹å³æµ‹è¯•è¾¹ç•Œè¾“å…¥ï¼Œè¿™æ˜¯å‡ ä½•é—®é¢˜çš„å¸¸è§é™·é˜±ç‚¹ã€‚

---

æœ¬æ¬¡åˆ†æå±•ç¤ºäº†ä¸‰åˆ†æ³•åœ¨è·¯å¾„ä¼˜åŒ–ä¸­çš„ç²¾å¦™åº”ç”¨ã€‚è®°ä½ï¼šå¥½ç®—æ³•éœ€è¦æ¸…æ™°çš„ç†è®ºè¯æ˜å’Œé²æ£’çš„ä»£ç å®ç°ç›¸ç»“åˆã€‚ä¸‹æ¬¡é‡åˆ°å¤šç»´ä¼˜åŒ–é—®é¢˜æ—¶ï¼Œä¸å¦¨å°è¯•ä¸‰åˆ†å¥—ä¸‰åˆ†çš„æ€è·¯ï¼ğŸš€

---
å¤„ç†ç”¨æ—¶ï¼š113.07ç§’
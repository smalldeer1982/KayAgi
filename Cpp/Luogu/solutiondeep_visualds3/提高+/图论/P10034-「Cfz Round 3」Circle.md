# é¢˜ç›®ä¿¡æ¯

# ã€ŒCfz Round 3ã€Circle

## é¢˜ç›®æè¿°

ç»™å®šä¸€ä¸ªé•¿åº¦ä¸º $n$ çš„ $\tt{01}$ ä¸² $S$ å’Œä¸€ä¸ªéè´Ÿæ•´æ•° $l$ã€‚

æˆ‘ä»¬å®šä¹‰ï¼Œå¯¹äºä¸€ä¸ª $1\sim n$ çš„æ’åˆ— $t$ å’Œéè´Ÿæ•´æ•° $k$ï¼š

$$f_{t,k}(i)=\begin{cases}i & k=0\\f_{t,k-1}(t_i) & k \neq 0\end{cases}$$

ä½ éœ€è¦æ„é€ ä¸€ä¸ª $1\sim n$ çš„æ’åˆ— $p$ï¼Œæ»¡è¶³ï¼š

- å¯¹äºä»»æ„ä¸€ä¸ªä¸å¤§äº $n$ çš„æ­£æ•´æ•° $i$ï¼Œéƒ½æ»¡è¶³ $p_i \neq i$ï¼›
- è‹¥ $S_i$ ä¸º $\tt1$ï¼Œåˆ™ $f_{p,l}(i)=i$ï¼ˆè‹¥ $S_i$ ä¸º $\tt0$ åˆ™æ²¡æœ‰é™åˆ¶ï¼‰ï¼›

æˆ–æŠ¥å‘Šæ— è§£ã€‚

å…¶ä¸­ï¼Œ$1\sim n$ çš„æ’åˆ—æŒ‡æ»¡è¶³æ‰€æœ‰ä¸å¤§äº $n$ çš„æ­£æ•´æ•°æ°å¥½å‡ºç°ä¸€æ¬¡çš„åºåˆ—ã€‚

## è¯´æ˜/æç¤º

#### ã€Œæ ·ä¾‹è§£é‡Š #1ã€

å¯¹äºç¬¬ $1$ ç»„æ•°æ®ï¼Œ$f_{p,3}(1)=f_{p,2}(4)=f_{p,1}(5)=f_{p,0}(1)=1$ï¼Œå…¶ä½™æ•°åŒç†ï¼Œæ‰€ä»¥ $p$ ä¸º $\{4,3,2,5,1\}$ æ—¶æ»¡è¶³æ¡ä»¶ã€‚

å¯¹äºç¬¬ $2$ ç»„æ•°æ®ï¼Œå¯ä»¥è¯æ˜ä¸å­˜åœ¨æ»¡è¶³æ¡ä»¶çš„æ’åˆ— $p$ã€‚

å¯¹äºç¬¬ $3$ ç»„æ•°æ®ï¼Œ$\{2,1,4,5,3\}$ ç­‰ä¹Ÿä¸ºæ»¡è¶³æ¡ä»¶çš„æ’åˆ— $p$ã€‚

#### ã€Œæ•°æ®èŒƒå›´ã€

è®¾ $\sum n$ è¡¨ç¤ºå•ä¸ªæµ‹è¯•ç‚¹ä¸­ $n$ çš„å’Œã€‚

å¯¹äºæ‰€æœ‰æ•°æ®ï¼Œ$1 \le T \le 100$ï¼Œ$2 \le n \le 5\times 10^5$ï¼Œ$0 \le l \le 10^{18}$ï¼Œ$\sum n \le 5\times 10^5$ï¼Œä¿è¯ $S$ ä¸­åªåŒ…å« $\tt{0}$ å’Œ $\tt{1}$ã€‚

**åªæœ‰ä½ é€šè¿‡æœ¬é¢˜çš„æ‰€æœ‰æµ‹è¯•ç‚¹ï¼Œä½ æ‰èƒ½è·å¾—æœ¬é¢˜çš„åˆ†æ•°ã€‚**

## æ ·ä¾‹ #1

### è¾“å…¥

```
4
5 3
10011
4 5
1000
5 6
11111
9 6
011111011```

### è¾“å‡º

```
4 3 2 5 1
-1
5 4 2 3 1
3 1 2 6 4 5 9 7 8```

# AIåˆ†æç»“æœ

# ğŸ’¡ Kayçš„C++ç®—æ³•è§£æï¼šã€ŒCfz Round 3ã€Circle æ·±å…¥å­¦ä¹ æŒ‡å— ğŸ’¡

ä»Šå¤©æˆ‘ä»¬è¦ä¸€èµ·æ‹†è§£ã€ŒCfz Round 3ã€çš„Circleé—®é¢˜ã€‚è¿™é“é¢˜èåˆäº†åŠ¨æ€è§„åˆ’ã€æ•°è®ºå’Œç½®æ¢ç¯çš„çŸ¥è¯†ï¼Œçœ‹èµ·æ¥æœ‰ç‚¹æŒ‘æˆ˜æ€§ï¼Œä½†åªè¦æˆ‘ä»¬æŠŠé—®é¢˜â€œç¿»è¯‘â€æˆæ—¥å¸¸åœºæ™¯ï¼Œå°±èƒ½è½»æ¾ç†è§£ï½


## 1. é¢˜ç›®è§£è¯»ä¸æ ¸å¿ƒç®—æ³•è¯†åˆ«

âœ¨ **æœ¬é¢˜ä¸»è¦è€ƒå¯Ÿ**ï¼šåŠ¨æ€è§„åˆ’(DP)ï¼ˆå®Œå…¨èƒŒåŒ…ï¼‰ + æ•°è®ºï¼ˆè´¨å› æ•°åˆ†è§£ï¼‰ + ç½®æ¢ç¯æ„é€ 

### ğŸ—£ï¸ åˆæ­¥åˆ†æ
æˆ‘ä»¬å¯ä»¥æŠŠé—®é¢˜æƒ³è±¡æˆ**â€œç”¨ä¸åŒé¢å€¼çš„ç¡¬å¸å‡‘é’±ï¼Œå†ç”¨ç¡¬å¸å æˆåœˆâ€**ï¼š
- **ç¡¬å¸**ï¼šlçš„è´¨å› æ•°ï¼ˆæ¯”å¦‚l=6ï¼Œç¡¬å¸æ˜¯2ã€3ï¼‰ï¼›  
- **å‡‘é’±**ï¼šç”¨ç¡¬å¸å‡‘å‡ºä¸€ä¸ªé‡‘é¢kï¼ˆå¿…é¡»æ»¡è¶³â€œ1â€çš„æ•°é‡â‰¤kâ‰¤nï¼Œkâ‰ n-1ï¼‰ï¼›  
- **å åœˆ**ï¼šæŠŠå‡‘å‡ºçš„ç¡¬å¸ï¼ˆè´¨å› æ•°ï¼‰å˜æˆä¸€ä¸ªä¸ªåœˆï¼ˆç½®æ¢ç¯ï¼‰ï¼Œæ¯ä¸ªç¡¬å¸å¯¹åº”ä¸€ä¸ªåœˆçš„å¤§å°ã€‚

**æ ¸å¿ƒé€»è¾‘**ï¼š  
é¢˜ç›®è¦æ±‚æ‰€æœ‰æ ‡â€œ1â€çš„ç‚¹å¿…é¡»åœ¨**é•¿åº¦æ˜¯lçš„å› æ•°**çš„åœˆé‡Œï¼ˆèµ°læ­¥å›åŸç‚¹ï¼‰ï¼Œè€Œåˆæ•°å› æ•°å¯ä»¥ç”¨è´¨å› æ•°å‡‘ï¼Œå› æ­¤åªéœ€ç”¨è´¨å› æ•°å‡‘kï¼Œå†æ„é€ ç¯ã€‚

**å¯è§†åŒ–è®¾è®¡æ€è·¯**ï¼š  
æˆ‘ä»¬ç”¨8ä½åƒç´ é£å±•ç¤ºè¿™ä¸ªè¿‡ç¨‹â€”â€”  
- è´¨å› æ•°æ˜¯ä¸åŒé¢œè‰²çš„åƒç´ ç¡¬å¸ï¼Œå‡‘kæ—¶ç¡¬å¸å †å ï¼ŒæˆåŠŸæ—¶æ’­æ”¾â€œå®â€çš„éŸ³æ•ˆï¼›  
- ç¯æ„é€ æ—¶ç”¨åƒç´ çº¿è¿æ¥ç‚¹ï¼Œè¿æ¥å®Œæˆååœˆé—ªçƒï¼Œæ’­æ”¾â€œå’»â€çš„éŸ³æ•ˆï¼›  
- æœ‰â€œå•æ­¥æ‰§è¡Œâ€â€œè‡ªåŠ¨æ’­æ”¾â€æŒ‰é’®ï¼Œé€Ÿåº¦æ»‘å—è°ƒæ•´èŠ‚å¥ï¼Œåƒç©å¤å¤æ¸¸æˆä¸€æ ·å­¦ä¹ ã€‚


## 2. ç²¾é€‰ä¼˜è´¨é¢˜è§£å‚è€ƒ

æˆ‘ä»æ€è·¯æ¸…æ™°åº¦ã€ä»£ç å¯è¯»æ€§ç­‰æ–¹é¢ç­›é€‰äº†ä»¥ä¸‹ä¼˜è´¨é¢˜è§£ï¼š

### **é¢˜è§£ä¸€ï¼šPhartialï¼ˆç»¼åˆé¢˜è§£ï¼‰**
* **ç‚¹è¯„**ï¼šé—®é¢˜è½¬åŒ–æœ€é€å½»â€”â€”ç›´æ¥å°†ç½®æ¢ç¯æ¡ä»¶è½¬åŒ–ä¸ºå› æ•°æ¡ä»¶ï¼Œå¹¶ç”¨æ˜ å°„æ•°ç»„å¤„ç†â€œ1â€â€œ0â€ç‚¹ï¼Œä»£ç ç»“æ„æ¸…æ™°ã€‚ä¾‹å¦‚ç”¨`id[d[i]]`æ˜ å°„åŸä½ç½®ï¼Œç®€åŒ–äº†åç»­çš„ç¯æ„é€ ã€‚

### **é¢˜è§£äºŒï¼šHPXXZYYï¼ˆç»¼åˆé¢˜è§£ï¼‰**
* **ç‚¹è¯„**ï¼šç»†èŠ‚å¤„ç†æœ€åˆ°ä½â€”â€”ç‰¹åˆ¤äº†k=0ã€kâ‰ n-1ç­‰è¾¹ç•Œæƒ…å†µï¼Œå¹¶ç”¨`lst`æ•°ç»„è®°å½•èƒŒåŒ…è½¬ç§»è·¯å¾„ï¼Œæ–¹ä¾¿åç»­æ‹†kã€‚ä¾‹å¦‚`lst[j] = Div[i]`è®°å½•jæ˜¯ç”±Div[i]è½¬ç§»æ¥çš„ï¼Œæ‹†kæ—¶åªéœ€ä¸æ–­å‡`lst[k]`ã€‚

### **é¢˜è§£ä¸‰ï¼šå¿«æ–—æ¸¸é¹¿ï¼ˆç»¼åˆé¢˜è§£ï¼‰**
* **ç‚¹è¯„**ï¼šä»£ç å®ç°æœ€å®Œæ•´â€”â€”ä»è´¨æ•°ç­›åˆ°èƒŒåŒ…å†åˆ°ç¯æ„é€ ï¼Œæ¯ä¸€æ­¥éƒ½æœ‰æ¸…æ™°çš„ä»£ç ã€‚ä¾‹å¦‚æ„é€ ç¯æ—¶ç”¨`b`æ•°ç»„å­˜å‚¨é€‰ä¸­çš„ç‚¹ï¼Œ`g`æ•°ç»„è®°å½•ä¸‹ä¸€ä¸ªç‚¹ï¼Œæ­¥éª¤æ˜ç¡®ã€‚


## 3. æ ¸å¿ƒéš¾ç‚¹è¾¨æä¸è§£é¢˜ç­–ç•¥

### **éš¾ç‚¹1ï¼šé—®é¢˜è½¬åŒ–â€”â€”ç½®æ¢ç¯ä¸å› æ•°çš„å…³ç³»**
**é—®é¢˜**ï¼š`f_{p,l}(i)=i`æ˜¯ä»€ä¹ˆæ„æ€ï¼Ÿ  
**è§£ç­”**ï¼šç½®æ¢ç¯ä¸­ï¼Œä»ièµ°læ­¥å›åŸç‚¹ï¼Œå½“ä¸”ä»…å½“ç¯é•¿dæ•´é™¤lï¼ˆæ¯”å¦‚d=2ï¼Œl=4ï¼Œèµ°2æ­¥å›åŸç‚¹ï¼Œèµ°4æ­¥ä¹Ÿå›åŸç‚¹ï¼‰ã€‚å› æ­¤â€œ1â€çš„ç‚¹å¿…é¡»åœ¨d|lçš„ç¯é‡Œï¼Œä¸”dâ‰¥2ï¼ˆä¸èƒ½è‡ªç¯ï¼‰ã€‚

### **éš¾ç‚¹2ï¼šä¸ºä»€ä¹ˆåªç”¨è´¨å› æ•°å‡‘kï¼Ÿ**
**é—®é¢˜**ï¼šåˆæ•°å› æ•°ï¼ˆæ¯”å¦‚6ï¼‰ä¸ºä»€ä¹ˆä¸ç”¨è€ƒè™‘ï¼Ÿ  
**è§£ç­”**ï¼šåˆæ•°å¯ä»¥ç”¨è´¨å› æ•°å‡‘ï¼ˆ6=2+2+2æˆ–3+3ï¼‰ï¼Œå› æ­¤åªéœ€ç”¨è´¨å› æ•°å°±èƒ½è¦†ç›–æ‰€æœ‰å¯èƒ½çš„åˆæ•°å› æ•°ï¼Œå‡å°‘èƒŒåŒ…çš„ç‰©å“æ•°é‡ï¼ˆlçš„è´¨å› æ•°æœ€å¤š15ä¸ªï¼Œå› ä¸º2Ã—3Ã—â€¦Ã—47>1e18ï¼‰ã€‚

### **éš¾ç‚¹3ï¼šèƒŒåŒ…åçš„ç¯æ„é€ **
**é—®é¢˜**ï¼šå‡‘å‡ºkåï¼Œæ€ä¹ˆæŠŠè´¨å› æ•°å˜æˆç¯ï¼Ÿ  
**è§£ç­”**ï¼šæŠŠâ€œ1â€çš„ç‚¹å’Œéƒ¨åˆ†â€œ0â€çš„ç‚¹æŒ‰è´¨å› æ•°åˆ†ç»„ï¼Œæ¯ç»„å½¢æˆä¸€ä¸ªç¯ï¼ˆæ¯”å¦‚k=5=2+3ï¼Œå¯¹åº”ä¸€ä¸ª2ç¯å’Œä¸€ä¸ª3ç¯ï¼‰ï¼Œå‰©ä¸‹çš„â€œ0â€çš„ç‚¹å½¢æˆä¸€ä¸ªå¤§ç¯ï¼ˆæ¯”å¦‚6â†’7â†’8â†’6ï¼‰ã€‚

### âœ¨ è§£é¢˜æŠ€å·§æ€»ç»“
1. **é—®é¢˜è½¬åŒ–**ï¼šç½®æ¢ç¯é—®é¢˜å…ˆæƒ³ç¯çš„é•¿åº¦å’Œæ­¥æ•°å…³ç³»ï¼›  
2. **æ•°è®ºç®€åŒ–**ï¼šç”¨è´¨å› æ•°å‡å°‘èƒŒåŒ…ç‰©å“æ•°é‡ï¼›  
3. **èƒŒåŒ…ä¼˜åŒ–**ï¼šå®Œå…¨èƒŒåŒ…è½¬ç§»æ–¹ç¨‹`dp[i] |= dp[i-p]`ï¼ˆpæ˜¯è´¨å› æ•°ï¼‰ï¼›  
4. **ç¯æ„é€ **ï¼šç”¨æ•°ç»„å­˜å‚¨é€‰ä¸­çš„ç‚¹ï¼Œå†è¿æ¥æˆåœˆã€‚


## 4. C++æ ¸å¿ƒä»£ç å®ç°èµæ

### æœ¬é¢˜é€šç”¨æ ¸å¿ƒC++å®ç°å‚è€ƒ
* **è¯´æ˜**ï¼šç»¼åˆäº†Phartialã€HPXXZYYç­‰é¢˜è§£çš„æ€è·¯ï¼ŒåŒ…å«è´¨æ•°ç­›ã€å®Œå…¨èƒŒåŒ…ã€ç¯æ„é€ çš„å®Œæ•´é€»è¾‘ã€‚
```cpp
#include <iostream>
#include <vector>
#include <string>
#include <algorithm>
using namespace std;
using LL = long long;

const int kN = 5e5 + 10;

int tt, n, c, m;
LL l;
string s;
bool is_prime[kN];
vector<int> primes;
bool dp[kN];
int pre[kN]; // è®°å½•è½¬ç§»çš„è´¨å› æ•°
int d[kN];   // æ ‡è®°æ˜¯å¦é€‰ä¸­ï¼ˆ1ï¼šæ˜¯ï¼Œ0ï¼šå¦ï¼‰
int ans[kN]; // æœ€ç»ˆæ’åˆ—p

// çº¿æ€§ç­›é¢„å¤„ç†è´¨æ•°
void sieve() {
    fill(is_prime, is_prime + kN, true);
    is_prime[0] = is_prime[1] = false;
    for (int i = 2; i < kN; ++i) {
        if (is_prime[i]) primes.push_back(i);
        for (int p : primes) {
            if (i * p >= kN) break;
            is_prime[i * p] = false;
            if (i % p == 0) break;
        }
    }
}

// å®Œå…¨èƒŒåŒ…åˆ¤æ–­èƒ½å¦å‡‘å‡ºk
bool solve_dp() {
    fill(dp, dp + n + 1, false);
    dp[0] = true;
    vector<int> factors;
    // æ”¶é›†lçš„â‰¤nçš„è´¨å› æ•°
    for (int p : primes) {
        if (p > n) break;
        if (l % p == 0) factors.push_back(p);
    }
    // å®Œå…¨èƒŒåŒ…è½¬ç§»
    for (int p : factors) {
        for (int i = p; i <= n; ++i) {
            if (dp[i - p]) {
                dp[i] = true;
                pre[i] = p; // è®°å½•è½¬ç§»çš„è´¨å› æ•°
            }
        }
    }
    // æ‰¾ç¬¦åˆæ¡ä»¶çš„k
    for (int k = c; k <= n; ++k) {
        if (k == n - 1) continue;
        if (dp[k]) {
            m = k;
            return true;
        }
    }
    return false;
}

// æ„é€ ç¯
void build_cycles() {
    vector<int> nodes;
    for (int i = 1; i <= n; ++i) {
        if (d[i]) nodes.push_back(i);
    }
    // æ‹†mä¸ºè´¨å› æ•°
    int now = m;
    vector<int> cycle_sizes;
    while (now > 0) {
        cycle_sizes.push_back(pre[now]);
        now -= pre[now];
    }
    reverse(cycle_sizes.begin(), cycle_sizes.end());
    // åˆ†é…ç‚¹åˆ°ç¯
    int ptr = 0;
    for (int sz : cycle_sizes) {
        for (int i = 0; i < sz; ++i) {
            int u = nodes[ptr + i];
            int v = nodes[ptr + (i + 1) % sz];
            ans[u] = v;
        }
        ptr += sz;
    }
    // å¤„ç†å‰©ä½™ç‚¹ï¼ˆå½¢æˆå¤§ç¯ï¼‰
    vector<int> rest;
    for (int i = 1; i <= n; ++i) {
        if (!d[i]) rest.push_back(i);
    }
    int sz = rest.size();
    for (int i = 0; i < sz; ++i) {
        ans[rest[i]] = rest[(i + 1) % sz];
    }
}

int main() {
    sieve();
    cin >> tt;
    while (tt--) {
        cin >> n >> l >> s;
        s = "#" + s; // 1-basedç´¢å¼•
        c = 0;
        fill(d, d + n + 1, 0);
        fill(ans, ans + n + 1, 0);
        // ç»Ÿè®¡â€œ1â€çš„æ•°é‡ï¼Œæ ‡è®°dæ•°ç»„
        for (int i = 1; i <= n; ++i) {
            if (s[i] == '1') {
                d[i] = 1;
                c++;
            }
        }
        // ç‰¹åˆ¤l=0æˆ–c=0ï¼ˆç›´æ¥æ„é€ nç¯ï¼‰
        if (l == 0 || c == 0) {
            for (int i = 1; i <= n; ++i) {
                cout << (i % n) + 1 << " ";
            }
            cout << endl;
            continue;
        }
        // å®Œå…¨èƒŒåŒ…
        if (!solve_dp()) {
            cout << -1 << endl;
            continue;
        }
        // é€‰m-cä¸ªâ€œ0â€çš„ç‚¹ï¼Œæ ‡è®°dæ•°ç»„
        int need = m - c;
        for (int i = 1; i <= n && need > 0; ++i) {
            if (s[i] == '0' && !d[i]) {
                d[i] = 1;
                need--;
            }
        }
        // æ„é€ ç¯
        build_cycles();
        // è¾“å‡º
        for (int i = 1; i <= n; ++i) {
            cout << ans[i] << " ";
        }
        cout << endl;
    }
    return 0;
}
```
* **ä»£ç è§£è¯»æ¦‚è¦**ï¼š  
  1. **é¢„å¤„ç†**ï¼šçº¿æ€§ç­›ç­›å‡ºæ‰€æœ‰è´¨æ•°ï¼›  
  2. **å¤šæµ‹å¤„ç†**ï¼šè¯»å–è¾“å…¥ï¼Œç»Ÿè®¡â€œ1â€çš„æ•°é‡ï¼›  
  3. **ç‰¹åˆ¤**ï¼šl=0æˆ–c=0æ—¶ç›´æ¥æ„é€ nç¯ï¼›  
  4. **å®Œå…¨èƒŒåŒ…**ï¼šç”¨è´¨å› æ•°å‡‘kï¼Œæ‰¾åˆ°mï¼›  
  5. **æ„é€ ç¯**ï¼šæ‹†mä¸ºè´¨å› æ•°ï¼Œåˆ†é…ç‚¹åˆ°ç¯ï¼Œå‰©ä½™ç‚¹å½¢æˆå¤§ç¯ï¼›  
  6. **è¾“å‡º**ï¼šæ‰“å°æœ€ç»ˆæ’åˆ—ã€‚


### é’ˆå¯¹å„ä¼˜è´¨é¢˜è§£çš„ç‰‡æ®µèµæ

#### **é¢˜è§£ä¸€ï¼šPhartialï¼ˆæ˜ å°„æ•°ç»„ï¼‰**
* **äº®ç‚¹**ï¼šç”¨æ˜ å°„æ•°ç»„å¤„ç†ä¸åŒç±»å‹çš„ç‚¹ï¼Œç®€åŒ–ç¯æ„é€ ã€‚
* **æ ¸å¿ƒä»£ç ç‰‡æ®µ**ï¼š
```cpp
// æ”¶é›†â€œ1â€å’Œâ€œ0â€çš„ç‚¹ï¼Œæ˜ å°„åˆ°idæ•°ç»„
int m = 0;
for (int i = 1; i <= n; ++i) {
    if (s[i] == '1') id[++m] = i;
}
for (int i = 1; i <= n; ++i) {
    if (s[i] == '0') id[++m] = i;
}
```
* **ä»£ç è§£è¯»**ï¼š  
  æŠŠâ€œ1â€çš„ç‚¹å’Œâ€œ0â€çš„ç‚¹ä¾æ¬¡å­˜å…¥`id`æ•°ç»„ï¼Œåç»­æ„é€ ç¯æ—¶åªéœ€æ“ä½œ`id`æ•°ç»„ï¼Œå†æ˜ å°„å›åŸä½ç½®ã€‚æ¯”å¦‚`id[1]`æ˜¯ç¬¬ä¸€ä¸ªâ€œ1â€çš„ç‚¹ï¼Œ`id[c+1]`æ˜¯ç¬¬ä¸€ä¸ªâ€œ0â€çš„ç‚¹ã€‚
* **å­¦ä¹ ç¬”è®°**ï¼šæ˜ å°„æ•°ç»„æ˜¯å¤„ç†å¤šç±»å‹ç‚¹çš„å¥½æ–¹æ³•ï¼Œé¿å…æ··ä¹±ã€‚

#### **é¢˜è§£äºŒï¼šHPXXZYYï¼ˆè½¬ç§»è·¯å¾„è®°å½•ï¼‰**
* **äº®ç‚¹**ï¼šç”¨`lst`æ•°ç»„è®°å½•èƒŒåŒ…è½¬ç§»è·¯å¾„ï¼Œæ–¹ä¾¿æ‹†kã€‚
* **æ ¸å¿ƒä»£ç ç‰‡æ®µ**ï¼š
```cpp
// å®Œå…¨èƒŒåŒ…è½¬ç§»ï¼Œè®°å½•è·¯å¾„
for (int i = 1; i <= dcnt; ++i) {
    for (int j = Div[i]; j <= n; ++j) {
        if (f[j - Div[i]] && !f[j]) {
            f[j] = true;
            lst[j] = Div[i]; // è®°å½•jç”±Div[i]è½¬ç§»è€Œæ¥
        }
    }
}
```
* **ä»£ç è§£è¯»**ï¼š  
  `lst[j]`å­˜å‚¨å‡‘å‡ºjæ—¶ç”¨çš„æœ€åä¸€ä¸ªè´¨å› æ•°ã€‚æ¯”å¦‚j=5=3+2ï¼Œ`lst[5]=2`ï¼Œæ‹†kæ—¶`now=5â†’now=5-2=3â†’lst[3]=3â†’now=0`ï¼Œå¾—åˆ°è´¨å› æ•°ç»„åˆ[2,3]ã€‚
* **å­¦ä¹ ç¬”è®°**ï¼šè®°å½•è½¬ç§»è·¯å¾„æ˜¯èƒŒåŒ…é—®é¢˜ä¸­æ„é€ æ–¹æ¡ˆçš„å…³é”®ã€‚


## 5. ç®—æ³•å¯è§†åŒ–ï¼šåƒç´ åŠ¨ç”»æ¼”ç¤º (æ ¸å¿ƒéƒ¨åˆ†)

### **åŠ¨ç”»ä¸»é¢˜**ï¼šåƒç´ ç¯å†’é™©
**æ ¸å¿ƒæ¼”ç¤ºå†…å®¹**ï¼šå±•ç¤ºè´¨å› æ•°å‡‘kã€ç¯æ„é€ çš„å…¨è¿‡ç¨‹ï¼Œèå…¥å¤å¤æ¸¸æˆå…ƒç´ ã€‚

### **è®¾è®¡æ€è·¯**
ç”¨8ä½åƒç´ é£è¥é€ è½»æ¾æ°›å›´ï¼Œç”¨éŸ³æ•ˆå’ŒåŠ¨ç”»å¼ºåŒ–è®°å¿†â€”â€”  
- **è´¨å› æ•°å‡‘k**åƒâ€œç¡¬å¸å †å æ¸¸æˆâ€ï¼ŒæˆåŠŸæ—¶æ’­æ”¾â€œå®â€å£°ï¼›  
- **ç¯æ„é€ **åƒâ€œè¿çº¿æ¸¸æˆâ€ï¼Œè¿æ¥ç‚¹æ—¶æ’­æ”¾â€œå’»â€å£°ï¼›  
- **é€šå…³**æ—¶æ’­æ”¾â€œèƒœåˆ©â€éŸ³æ•ˆï¼Œå¢åŠ æˆå°±æ„Ÿã€‚

### **åŠ¨ç”»å¸§æ­¥éª¤**
1. **åœºæ™¯åˆå§‹åŒ–**ï¼š  
   - å·¦ä¾§æ˜¯åƒç´ ç½‘æ ¼ï¼Œçº¢å—=â€œ1â€ï¼Œè“å—=â€œ0â€ï¼›  
   - å³ä¾§æ˜¯æ§åˆ¶é¢æ¿ï¼šå¼€å§‹/æš‚åœã€å•æ­¥ã€é‡ç½®æŒ‰é’®ï¼Œé€Ÿåº¦æ»‘å—ï¼›  
   - æ’­æ”¾8ä½é£æ ¼èƒŒæ™¯éŸ³ä¹ï¼ˆå¦‚ã€Šè¶…çº§é©¬é‡Œå¥¥ã€‹è½»æ¾ç‰ˆï¼‰ã€‚

2. **è´¨å› æ•°ç­›é€‰**ï¼š  
   - å±å¹•ä¸Šæ–¹å¼¹å‡ºâ€œè´¨å› æ•°ï¼š2ã€3â€ï¼Œç”¨é»„ã€ç»¿åƒç´ ç¡¬å¸è¡¨ç¤ºã€‚

3. **å®Œå…¨èƒŒåŒ…å‡‘k**ï¼š  
   - ç‚¹å‡»â€œè‡ªåŠ¨æ’­æ”¾â€ï¼Œé»„ç¡¬å¸ï¼ˆ2ï¼‰å †å åˆ°3ï¼Œè“å—j=3é«˜äº®ï¼Œæ’­æ”¾â€œå®â€å£°ï¼›  
   - ç»¿ç¡¬å¸ï¼ˆ3ï¼‰å †å åˆ°2ï¼Œè“å—j=5é«˜äº®ï¼Œæ’­æ”¾â€œå®â€å£°ï¼›  
   - å‡‘å‡ºk=5æ—¶ï¼ŒèƒŒåŒ…åŒºåŸŸé—ªçƒï¼Œæ’­æ”¾â€œèƒœåˆ©â€éŸ³æ•ˆã€‚

4. **ç¯æ„é€ **ï¼š  
   - çº¢å—+è“å—è¢«æ¡†é€‰ï¼Œç”¨åƒç´ çº¿è¿æ¥æˆ2ç¯ï¼ˆçº¢â†’è“â†’çº¢ï¼‰å’Œ3ç¯ï¼ˆçº¢â†’çº¢â†’è“â†’çº¢ï¼‰ï¼›  
   - æ¯è¿æ¥ä¸€ä¸ªç‚¹ï¼Œæ’­æ”¾â€œå’»â€å£°ï¼›  
   - å®Œæˆç¯æ—¶ï¼Œåœˆé—ªçƒ3æ¬¡ï¼Œæ˜¾ç¤ºâ€œç¯å¤§å°ï¼š2â€ã€‚

5. **æœ€ç»ˆç»“æœ**ï¼š  
   - æ‰€æœ‰ç¯è¿æ¥å®Œæˆï¼Œå±å¹•æ˜¾ç¤ºâ€œæˆåŠŸï¼â€ï¼Œæ’­æ”¾â€œé€šå…³â€éŸ³æ•ˆï¼›  
   - ç‚¹å‡»â€œé‡ç½®â€é‡æ–°å¼€å§‹ï¼Œæˆ–â€œå•æ­¥â€çœ‹ç»†èŠ‚ã€‚

### **äº¤äº’è®¾è®¡**
- **å•æ­¥æ‰§è¡Œ**ï¼šæ¯æ­¥æ˜¾ç¤ºä¸€ä¸ªæ“ä½œï¼ˆé€‰ç¡¬å¸ã€è¿ç‚¹ï¼‰ï¼›  
- **è‡ªåŠ¨æ’­æ”¾**ï¼šæŒ‰è®¾å®šé€Ÿåº¦è¿è¡Œï¼Œé€Ÿåº¦æ»‘å—è°ƒæ•´ï¼›  
- **é‡ç½®**ï¼šå›åˆ°åˆå§‹çŠ¶æ€ï¼Œé‡æ–°å¼€å§‹ã€‚


## 6. æ‹“å±•ç»ƒä¹ ä¸ç›¸ä¼¼é—®é¢˜æ€è€ƒ

### **é€šç”¨æ€è·¯è¿ç§»**
æœ¬é¢˜æ€è·¯å¯è¿ç§»åˆ°**â€œå‡‘æ•°+æ„é€ â€**ç±»é—®é¢˜ï¼š
- ç”¨ä¸åŒé•¿åº¦çš„æœ¨æ¿æ‹¼åœ†å½¢æ¡Œå­ï¼ˆå‡‘æ•°+æ„é€ ç¯ï¼‰ï¼›  
- ç”¨ä¸åŒé¢å€¼çš„é‚®ç¥¨è´´æˆå¿ƒå½¢ï¼ˆå‡‘æ•°+æ„é€ ç»“æ„ï¼‰ã€‚

### **æ´›è°·æ¨èç»ƒä¹ **
1. **æ´›è°· P10034** - ã€ŒCfz Round 3ã€Circleï¼ˆåŸé¢˜ï¼Œå·©å›ºæ ¸å¿ƒæ€è·¯ï¼‰ï¼›  
2. **æ´›è°· P1090** - åˆå¹¶æœå­ï¼ˆè´ªå¿ƒå‡‘æ•°ï¼Œç»ƒä¹ å‡‘æ•°é€»è¾‘ï¼‰ï¼›  
3. **æ´›è°· P2669** - é‡‘å¸ï¼ˆå®Œå…¨èƒŒåŒ…åŸºç¡€é¢˜ï¼Œç»ƒä¹ è½¬ç§»æ–¹ç¨‹ï¼‰ï¼›  
4. **æ´›è°· P3370** - å­—ç¬¦ä¸²å“ˆå¸Œï¼ˆæ•°è®ºç»“åˆå…¶ä»–ç®—æ³•ï¼Œç»ƒä¹ ç»¼åˆåº”ç”¨ï¼‰ã€‚


## 7. å­¦ä¹ å¿ƒå¾—ä¸ç»éªŒåˆ†äº«

### **å‚è€ƒç»éªŒï¼ˆæ¥è‡ªé¢˜è§£ä½œè€…ï¼‰**
- **HPXXZYY**ï¼šâ€œä¸€å¼€å§‹å¿˜äº†ç‰¹åˆ¤k=0ï¼ŒWA on test 10ï¼›åæ¥åˆå¿˜kâ‰ n-1ï¼ŒWA on test 13ã€‚ç‰¹åˆ¤æ˜¯ç»†èŠ‚æ€ï¼â€  
  **Kayç‚¹è¯„**ï¼šå¤šæµ‹é—®é¢˜ä¸€å®šè¦è€ƒè™‘è¾¹ç•Œæƒ…å†µï¼ˆæ¯”å¦‚æ²¡æœ‰â€œ1â€ã€l=0ï¼‰ã€‚
- **å¿«æ–—æ¸¸é¹¿**ï¼šâ€œæ„é€ ç¯æ—¶ç›´æ¥ç”¨åŸä½ç½®ä¼šæ··ä¹±ï¼Œç”¨æ•°ç»„å­˜é€‰ä¸­çš„ç‚¹æ‰ç†æ¸…é¡ºåºã€‚â€  
  **Kayç‚¹è¯„**ï¼šç”¨æ•°ç»„å­˜å‚¨éœ€è¦å¤„ç†çš„ç‚¹ï¼Œé¿å…æ··ä¹±ã€‚


## 8. æ€»ç»“

æœ¬æ¬¡åˆ†æè¦†ç›–äº†é—®é¢˜è½¬åŒ–ã€è´¨å› æ•°èƒŒåŒ…ã€ç¯æ„é€ çš„å…¨æµç¨‹ï¼Œå¸Œæœ›å¤§å®¶èƒ½æŒæ¡â€œå‡‘æ•°â†’æ„é€ â€çš„æ ¸å¿ƒæ€è·¯ã€‚è®°å¾—å¤šç»ƒä¹ ã€å¤šç”»å›¾ã€å¤šdebugâ€”â€”ç¼–ç¨‹çš„ä¹è¶£åœ¨äºè§£å†³é—®é¢˜çš„è¿‡ç¨‹ï¼ä¸‹æ¬¡æˆ‘ä»¬å†ä¸€èµ·æ¢ç´¢æ–°çš„æŒ‘æˆ˜ï½ğŸ’ª

---
å¤„ç†ç”¨æ—¶ï¼š181.62ç§’
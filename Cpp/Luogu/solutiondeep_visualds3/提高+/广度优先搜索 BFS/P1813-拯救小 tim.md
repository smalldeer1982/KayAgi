# é¢˜ç›®ä¿¡æ¯

# æ‹¯æ•‘å° tim

## é¢˜ç›®æè¿°

å° tim åœ¨æ¸¸ä¹åœºï¼Œæœ‰ä¸€å¤©ç»ˆäºé€ƒäº†å‡ºæ¥ï¼ä½†æ˜¯ä¸å°å¿ƒåˆè¢«æ¸¸ä¹åœºçš„å·¥ä½œäººå‘˜å‘ç°äº†â€¦æ‰€ä»¥ä½ çš„ä»»åŠ¡æ˜¯å®‰å…¨åœ°æŠŠå° tim æŠ¤é€å›å®¶ã€‚ä½†æ˜¯ï¼ŒA å¸‚å¤æ‚çš„äº¤é€šçŠ¶å†µç»™ä½ å‡ºäº†ä¸€å¤§éš¾é¢˜ã€‚Â 

A å¸‚ä¸€å…±æœ‰ $n$ ä¸ªè·¯å£ï¼Œ$m$ æ¡å•è¡Œé©¬è·¯ã€‚ä½†æ˜¯ï¼Œæ¯æ¡é©¬è·¯éƒ½åªæœ‰ä¸€æ®µæ—¶é—´æ˜¯å¼€æ”¾çš„ã€‚ä¸ºäº†å®‰å…¨ï¼Œä½ å¿…é¡»é€‰æ‹©ä¸€æ¡æŠ¤é€è·¯çº¿ï¼Œä½¿å¾—å° tim åœ¨è·¯ä¸Šçš„æ—¶é—´æœ€çŸ­ï¼Œå³åˆ°å®¶çš„æ—¶åˆ»å‡å»ç¦»å¼€æ¸¸ä¹åœºçš„æ—¶åˆ»æœ€çŸ­ã€‚

## è¯´æ˜/æç¤º

**ã€æ ·ä¾‹è§£é‡Š #1ã€‘**

æœ€ä¼˜æ–¹æ¡ˆåº”è¯¥æ˜¯ï¼Œåœ¨ $1$ å·ç‚¹åœç•™è‡³æ—¶åˆ» $1$ï¼Œç„¶åèµ°åˆ° $3$ å·ç‚¹ï¼Œç„¶åèµ°åˆ° $4$ å·ç‚¹ã€‚åˆ°è¾¾æ—¶åˆ»ä¸ºæ—¶åˆ» $4$ã€‚tim åœ¨è·¯ä¸Šçš„æ—¶é—´ä¸º $4-1=3$ã€‚

### æ•°æ®èŒƒå›´

å¯¹äºæ‰€æœ‰æµ‹è¯•æ•°æ®ï¼š
- $2\leqslant n\leqslant100$ï¼Œ$0\leqslant m\leqslant1000$ï¼Œ$1\leqslant s,t\leqslant n$ï¼Œ$s\not=t$ï¼›
- $1\leqslant x,y\leqslant n$ï¼Œ$0\leqslant b,e,c\leqslant10000$ï¼Œ$b<e$ã€‚

## æ ·ä¾‹ #1

### è¾“å…¥

```
4 5 1 4 

1 2 0 1 1 

1 2 0 1 2 

1 3 1 3 2 

2 4 3 4 1 

3 4 3 4 1 ```

### è¾“å‡º

```
3```

# AIåˆ†æç»“æœ

# ğŸ’¡ Kayçš„C++ç®—æ³•è§£æï¼šæ‹¯æ•‘å°tim æ·±å…¥å­¦ä¹ æŒ‡å— ğŸ’¡


## 1. é¢˜ç›®è§£è¯»ä¸æ ¸å¿ƒç®—æ³•è¯†åˆ«

âœ¨ **æœ¬é¢˜ä¸»è¦è€ƒå¯Ÿ**ï¼šå›¾è®º - å¸¦æ—¶é—´çº¦æŸçš„æœ€çŸ­è·¯ç®—æ³•  

ğŸ—£ï¸ **åˆæ­¥åˆ†æ**ï¼š  
å°timéœ€è¦ä»æ¸¸ä¹åœºï¼ˆèµ·ç‚¹`s`ï¼‰å›å®¶ï¼ˆç»ˆç‚¹`t`ï¼‰ï¼Œä½†æ¯æ¡é©¬è·¯åªæœ‰åœ¨ç‰¹å®šæ—¶é—´`[b,e]`å¼€æ”¾ï¼Œä¸”é€šè¿‡éœ€è¦`c`æ—¶é—´ã€‚æˆ‘ä»¬çš„ç›®æ ‡æ˜¯æ‰¾åˆ°**æœ€çŸ­æ—¶é—´å·®**ï¼ˆåˆ°è¾¾æ—¶åˆ» - å‡ºå‘æ—¶åˆ»ï¼‰ï¼Œå°±åƒâ€œåœ¨æ­£ç¡®çš„æ—¶é—´èµ°æ­£ç¡®çš„è·¯â€ï¼Œè®©å°timç­‰å¾…çš„æ—¶é—´æœ€å°‘ã€‚  

**æ ¸å¿ƒç®—æ³•æ€æƒ³**ï¼š  
å¸¦æ—¶é—´çº¦æŸçš„æœ€çŸ­è·¯æ˜¯ç»å…¸å›¾è®ºé—®é¢˜çš„å˜ç§ã€‚ä¸æ™®é€šæœ€çŸ­è·¯ä¸åŒï¼Œæ¯æ¡è¾¹çš„â€œå¯ç”¨çŠ¶æ€â€éšæ—¶é—´å˜åŒ–â€”â€”åªæœ‰å½“ä½ åˆ°è¾¾è¾¹çš„èµ·ç‚¹æ—¶ï¼Œè¾¹å¤„äºå¼€æ”¾æ—¶é—´å†…ï¼Œæ‰èƒ½é€šè¿‡ã€‚è§£å†³è¿™ç±»é—®é¢˜çš„å…³é”®æ˜¯**å¤„ç†æ—¶é—´çº¦æŸ**å’Œ**é«˜æ•ˆæšä¸¾å¯èƒ½çš„å‡ºå‘æ—¶é—´**ã€‚  

**å¸¸è§è§£æ³•å¯¹æ¯”**ï¼š  
- **æšä¸¾å‡ºå‘æ—¶é—´**ï¼ˆå¦‚XiaoQuQuã€æ©™å­æ±çš„é¢˜è§£ï¼‰ï¼šå‡è®¾å°timåœ¨æ—¶åˆ»`i`ä»`s`å‡ºå‘ï¼Œç”¨SPFA/Dijkstraè®¡ç®—åˆ°è¾¾`t`çš„æœ€æ—©æ—¶åˆ»ï¼Œå–æ‰€æœ‰`i`ä¸­`(åˆ°è¾¾æ—¶åˆ» - i)`çš„æœ€å°å€¼ã€‚è¿™ç§æ–¹æ³•ç›´è§‚ï¼Œä½†éœ€è¦ä¼˜åŒ–æšä¸¾èŒƒå›´ï¼ˆå¦‚åªæšä¸¾`s`çš„è¾¹çš„æœ‰æ•ˆå‡ºå‘æ—¶é—´ï¼‰ã€‚  
- **æšä¸¾å…³é”®è¾¹**ï¼ˆå¦‚chzhcçš„é¢˜è§£ï¼‰ï¼šæœ€ä¼˜è·¯å¾„å¿…ç„¶åŒ…å«ä¸€æ¡â€œåˆšå¥½å¡åœ¨è¾¹çš„å…³é—­æ—¶é—´`e`é€šè¿‡â€çš„è¾¹ï¼ˆå¦åˆ™å¯ä»¥æå‰å‡ºå‘å‡å°‘æ—¶é—´å·®ï¼‰ã€‚å› æ­¤æšä¸¾æ¯æ¡è¾¹ï¼Œè®¡ç®—ä»`s`åˆ°è¯¥è¾¹èµ·ç‚¹çš„æœ€çŸ­æ—¶é—´ï¼ˆéœ€åœ¨è¾¹å¼€æ”¾å‰åˆ°è¾¾ï¼‰ï¼Œä»¥åŠä»è¯¥è¾¹ç»ˆç‚¹åˆ°`t`çš„æœ€çŸ­æ—¶é—´ï¼ˆéœ€åœ¨è¾¹å…³é—­å‰é€šè¿‡ï¼‰ï¼Œåˆå¹¶å¾—åˆ°ç­”æ¡ˆã€‚è¿™ç§æ–¹æ³•å¤æ‚åº¦æ›´ä½ï¼ˆé¿å…æšä¸¾æ‰€æœ‰å‡ºå‘æ—¶é—´ï¼‰ã€‚  

**å¯è§†åŒ–è®¾è®¡æ€è·¯**ï¼š  
ç”¨**8ä½åƒç´ é£æ ¼**å±•ç¤ºè·¯å£ï¼ˆèŠ‚ç‚¹ï¼‰å’Œé©¬è·¯ï¼ˆè¾¹ï¼‰ï¼š  
- èŠ‚ç‚¹ç”¨ä¸åŒé¢œè‰²è¡¨ç¤ºçŠ¶æ€ï¼ˆå¦‚`s`æ˜¯çº¢è‰²èµ·ç‚¹ï¼Œ`t`æ˜¯ç»¿è‰²ç»ˆç‚¹ï¼Œå…¶ä»–èŠ‚ç‚¹æ˜¯ç°è‰²ï¼‰ï¼›  
- è¾¹ç”¨é¢œè‰²è¡¨ç¤ºå¼€æ”¾çŠ¶æ€ï¼ˆç»¿è‰²=å¼€æ”¾ï¼Œçº¢è‰²=å…³é—­ï¼‰ï¼›  
- åŠ¨ç”»å±•ç¤ºSPFAé˜Ÿåˆ—çš„å˜åŒ–ï¼ˆèŠ‚ç‚¹å…¥é˜Ÿæ—¶é—ªçƒï¼‰ã€æ—¶é—´æ›´æ–°ï¼ˆèŠ‚ç‚¹ä¸Šæ˜¾ç¤ºå½“å‰æ—¶é—´ï¼‰ï¼Œä»¥åŠå°timçš„ç§»åŠ¨è·¯å¾„ï¼ˆé€šè¿‡è¾¹æ—¶è¾¹å˜äº®ï¼‰ã€‚  


## 2. ç²¾é€‰ä¼˜è´¨é¢˜è§£å‚è€ƒ

### é¢˜è§£ä¸€ï¼šæšä¸¾å…³é”®è¾¹ï¼ˆä½œè€…ï¼šchzhcï¼Œèµ12ï¼‰  
* **ç‚¹è¯„**ï¼š  
  è¿™é“é¢˜çš„â€œç¥æ¥ä¹‹ç¬”â€ï¼ä½œè€…æŠ“ä½äº†**æœ€ä¼˜è·¯å¾„å¿…ç„¶åŒ…å«ä¸€æ¡â€œå¡æ—¶é—´ä¸Šé™â€çš„è¾¹**è¿™ä¸€å…³é”®æ€§è´¨ï¼Œå°†é—®é¢˜è½¬åŒ–ä¸ºæšä¸¾æ¯æ¡è¾¹ï¼Œè·‘ä¸¤æ¬¡SPFAï¼ˆæ­£å‘å’Œåå‘ï¼‰ã€‚è¿™ç§æ€è·¯é¿å…äº†æšä¸¾æ‰€æœ‰å¯èƒ½çš„å‡ºå‘æ—¶é—´ï¼Œå¤æ‚åº¦æ›´ä¼˜ï¼ˆ`O(m*(n+m)logm)`ï¼‰ã€‚  
  ä»£ç ä¸­ï¼Œä½œè€…ç”¨é‚»æ¥è¡¨å­˜å‚¨æ­£å‘è¾¹ï¼ˆç”¨äºè®¡ç®—ä»è¾¹ç»ˆç‚¹åˆ°`t`çš„æœ€çŸ­æ—¶é—´ï¼‰å’Œåå‘è¾¹ï¼ˆç”¨äºè®¡ç®—ä»`s`åˆ°è¾¹èµ·ç‚¹çš„æœ€çŸ­æ—¶é—´ï¼‰ï¼Œæšä¸¾æ¯æ¡è¾¹æ—¶ï¼Œåˆå¹¶ä¸¤æ¬¡SPFAçš„ç»“æœå¾—åˆ°å½“å‰è¾¹çš„å¯èƒ½ç­”æ¡ˆï¼Œæœ€ç»ˆå–æœ€å°å€¼ã€‚ä»£ç ç»“æ„æ¸…æ™°ï¼Œè¾¹ç•Œå¤„ç†ä¸¥è°¨ï¼ˆå¦‚è¿‡æ»¤æ‰â€œå¼€æ”¾æ—¶é—´ä¸è¶³ä»¥é€šè¿‡â€çš„è¾¹ï¼‰ï¼Œæ˜¯æœ¬é¢˜çš„æœ€ä¼˜è§£æ³•ä¹‹ä¸€ã€‚  

### é¢˜è§£äºŒï¼šè®°å¿†åŒ–æœç´¢DPï¼ˆä½œè€…ï¼šXiaoQuQuï¼Œèµ2ï¼‰  
* **ç‚¹è¯„**ï¼š  
  ç”¨DPæ€è·¯è§£å†³æœ€çŸ­è·¯é—®é¢˜ï¼Œåˆ«å‡ºå¿ƒè£ï¼ä½œè€…å®šä¹‰`f[i][j]`è¡¨ç¤ºâ€œæ—¶åˆ»`j`ä»èŠ‚ç‚¹`i`å‡ºå‘ï¼Œåˆ°è¾¾`t`çš„æœ€å°æ—¶åˆ»â€ï¼Œé€šè¿‡é€’å½’è½¬ç§»ï¼ˆ`f[i][j] = min(f[v][max(b,j)+w])`ï¼Œå…¶ä¸­`v`æ˜¯`i`çš„é‚»æ¥èŠ‚ç‚¹ï¼Œ`b`æ˜¯è¾¹çš„å¼€æ”¾å¼€å§‹æ—¶é—´ï¼Œ`w`æ˜¯é€šè¿‡æ—¶é—´ï¼‰ã€‚  
  ä»£ç ç®€æ´ï¼Œç”¨è®°å¿†åŒ–æœç´¢é¿å…é‡å¤è®¡ç®—ï¼Œä½†å¤æ‚åº¦è¾ƒé«˜ï¼ˆ`O(nV)`ï¼Œ`V`æ˜¯æ—¶é—´ä¸Šé™ï¼‰ï¼Œé€‚åˆå°æ•°æ®ã€‚è¿™ç§æ€è·¯æœ‰åŠ©äºç†è§£â€œæ—¶é—´çŠ¶æ€â€çš„ä¼ é€’ï¼Œæ˜¯å­¦ä¹ DPä¸å›¾è®ºç»“åˆçš„å¥½ä¾‹å­ã€‚  

### é¢˜è§£ä¸‰ï¼šæšä¸¾å‡ºå‘æ—¶é—´çš„SPFAï¼ˆä½œè€…ï¼šæ©™å­æ±ï¼Œèµ2ï¼‰  
* **ç‚¹è¯„**ï¼š  
  æœ€ç›´è§‚çš„è§£æ³•ï¼Œé€‚åˆåˆå­¦è€…ç†è§£ã€‚ä½œè€…æšä¸¾å°timä»`s`å‡ºå‘çš„æ—¶é—´`i`ï¼ˆèŒƒå›´æ˜¯`s`çš„è¾¹çš„æœ€å°å¼€æ”¾å¼€å§‹æ—¶é—´`minn`åˆ°æœ€å¤§æœ‰æ•ˆå‡ºå‘æ—¶é—´`maxx`ï¼‰ï¼Œå¯¹æ¯ä¸ª`i`ç”¨SPFAè®¡ç®—åˆ°è¾¾`t`çš„æœ€æ—©æ—¶åˆ»ï¼Œå–`(åˆ°è¾¾æ—¶åˆ» - i)`çš„æœ€å°å€¼ã€‚  
  ä»£ç è§„èŒƒï¼Œç”¨é‚»æ¥è¡¨å­˜å›¾ï¼Œå¤„ç†è¾¹çš„æ—¶é—´çº¦æŸï¼ˆ`max(dis[u], list[i].l) + list[i].ds <= list[i].r`ï¼‰ï¼Œå¹¶ä¼˜åŒ–äº†æšä¸¾èŒƒå›´ï¼ˆåªæšä¸¾`s`çš„è¾¹çš„æœ‰æ•ˆæ—¶é—´ï¼‰ã€‚è¿™ç§æ–¹æ³•å®¹æ˜“å®ç°ï¼Œæ˜¯è§£å†³æ­¤ç±»é—®é¢˜çš„â€œåŸºç¡€æ¨¡æ¿â€ã€‚  


## 3. æ ¸å¿ƒéš¾ç‚¹è¾¨æä¸è§£é¢˜ç­–ç•¥

### 1. éš¾ç‚¹1ï¼šå¦‚ä½•å¤„ç†è¾¹çš„æ—¶é—´çº¦æŸï¼Ÿ  
**é—®é¢˜**ï¼šè¾¹`uâ†’v`çš„å¼€æ”¾æ—¶é—´æ˜¯`[b,e]`ï¼Œé€šè¿‡éœ€è¦`c`æ—¶é—´ã€‚å¦‚æœå°timåœ¨æ—¶åˆ»`t`åˆ°è¾¾`u`ï¼Œå¿…é¡»æ»¡è¶³`max(t, b) + c <= e`æ‰èƒ½é€šè¿‡ã€‚  
**è§£å†³æ–¹æ¡ˆ**ï¼š  
åœ¨æ¾å¼›æ“ä½œæ—¶ï¼Œè®¡ç®—**åˆ°è¾¾`u`çš„æ—¶é—´**ä¸**è¾¹çš„å¼€æ”¾å¼€å§‹æ—¶é—´**çš„æœ€å¤§å€¼ï¼ˆå³éœ€è¦ç­‰å¾…çš„æ—¶é—´ï¼‰ï¼ŒåŠ ä¸Šé€šè¿‡æ—¶é—´ï¼Œåˆ¤æ–­æ˜¯å¦åœ¨è¾¹çš„å¼€æ”¾ç»“æŸæ—¶é—´å†…ã€‚ä¾‹å¦‚ï¼š  
```cpp
if (max(dis[u], edge[i].b) + edge[i].c <= edge[i].e) {
    dis[v] = min(dis[v], max(dis[u], edge[i].b) + edge[i].c);
}
```  
**å­¦ä¹ ç¬”è®°**ï¼šæ—¶é—´çº¦æŸçš„æ ¸å¿ƒæ˜¯â€œç­‰å¾…â€â€”â€”å¦‚æœåˆ°å¾—å¤ªæ—©ï¼Œå¿…é¡»ç­‰è¾¹å¼€æ”¾ï¼›å¦‚æœåˆ°å¾—å¤ªæ™šï¼Œè¾¹å·²ç»å…³é—­ï¼Œæ— æ³•é€šè¿‡ã€‚

### 2. éš¾ç‚¹2ï¼šå¦‚ä½•é«˜æ•ˆæšä¸¾å‡ºå‘æ—¶é—´ï¼Ÿ  
**é—®é¢˜**ï¼šå¦‚æœç›´æ¥æšä¸¾æ‰€æœ‰å¯èƒ½çš„å‡ºå‘æ—¶é—´ï¼ˆå¦‚ä»0åˆ°1e4ï¼‰ï¼Œä¼šå¯¼è‡´æ—¶é—´å¤æ‚åº¦è¿‡é«˜ã€‚  
**è§£å†³æ–¹æ¡ˆ**ï¼š  
é¢„å¤„ç†`s`çš„æ‰€æœ‰è¾¹ï¼Œå¾—åˆ°**æœ€å°å¼€æ”¾å¼€å§‹æ—¶é—´`minn`**ï¼ˆæœ€æ—©èƒ½å‡ºå‘çš„æ—¶é—´ï¼‰å’Œ**æœ€å¤§æœ‰æ•ˆå‡ºå‘æ—¶é—´`maxx`**ï¼ˆæœ€æ™šèƒ½å‡ºå‘ä¸”èƒ½é€šè¿‡è¾¹çš„æ—¶é—´ï¼Œå³`e - c`ï¼‰ã€‚åªæšä¸¾`[minn, maxx]`èŒƒå›´å†…çš„æ—¶é—´ï¼Œå‡å°‘æšä¸¾æ¬¡æ•°ã€‚ä¾‹å¦‚ï¼š  
```cpp
for (int i = 1; i <= m; ++i) {
    if (x == s) {
        minn = min(minn, b);
        maxx = max(maxx, e - c);
    }
}
```  
**å­¦ä¹ ç¬”è®°**ï¼šæšä¸¾èŒƒå›´çš„ä¼˜åŒ–æ˜¯è§£å†³è¿™ç±»é—®é¢˜çš„å…³é”®ï¼Œé¿å…åšæ— ç”¨åŠŸã€‚

### 3. éš¾ç‚¹3ï¼šå¦‚ä½•é€‰æ‹©æœ€çŸ­è·¯ç®—æ³•ï¼Ÿ  
**é—®é¢˜**ï¼šå¸¦æ—¶é—´çº¦æŸçš„æœ€çŸ­è·¯åº”è¯¥ç”¨SPFAè¿˜æ˜¯Dijkstraï¼Ÿ  
**è§£å†³æ–¹æ¡ˆ**ï¼š  
- **SPFA**ï¼šé€‚åˆå¤„ç†æœ‰è´Ÿæƒè¾¹çš„æƒ…å†µï¼Œä½†æœ¬é¢˜è¾¹æƒï¼ˆé€šè¿‡æ—¶é—´ï¼‰éè´Ÿã€‚ä½†SPFAå®ç°ç®€å•ï¼Œå®¹æ˜“å¤„ç†æ—¶é—´çº¦æŸï¼Œæ˜¯æœ¬é¢˜çš„å¸¸ç”¨é€‰æ‹©ã€‚  
- **Dijkstra**ï¼šé€‚åˆè¾¹æƒéè´Ÿçš„æƒ…å†µï¼Œç”¨ä¼˜å…ˆé˜Ÿåˆ—ä¼˜åŒ–åå¤æ‚åº¦æ›´ä½ï¼ˆ`O(m log n)`ï¼‰ã€‚ä½†éœ€è¦å¤„ç†æ—¶é—´çº¦æŸçš„æ¾å¼›æ“ä½œï¼Œä»£ç  slightly å¤æ‚ã€‚  
**å­¦ä¹ ç¬”è®°**ï¼šé€‰æ‹©ç®—æ³•çš„å…³é”®æ˜¯**è¾¹æƒæ€§è´¨**å’Œ**å®ç°å¤æ‚åº¦**ï¼Œæœ¬é¢˜ä¸­SPFAæ›´æ˜“å®ç°ã€‚


## 4. C++æ ¸å¿ƒä»£ç å®ç°èµæ

### æœ¬é¢˜é€šç”¨æ ¸å¿ƒC++å®ç°å‚è€ƒï¼ˆæ¥è‡ªæ©™å­æ±çš„SPFAæšä¸¾å‡ºå‘æ—¶é—´ï¼‰  
* **è¯´æ˜**ï¼š  
  è¿™æ˜¯æœ¬é¢˜æœ€ç›´è§‚çš„å®ç°æ–¹å¼ï¼Œé€‚åˆåˆå­¦è€…ç†è§£ã€‚ä»£ç ç”¨é‚»æ¥è¡¨å­˜å›¾ï¼Œæšä¸¾`s`çš„æœ‰æ•ˆå‡ºå‘æ—¶é—´ï¼Œç”¨SPFAè®¡ç®—åˆ°è¾¾`t`çš„æœ€æ—©æ—¶åˆ»ï¼Œå–æ—¶é—´å·®çš„æœ€å°å€¼ã€‚  
* **å®Œæ•´æ ¸å¿ƒä»£ç **ï¼š  
  ```cpp
  #include<bits/stdc++.h>
  using namespace std;
  queue<int> q;
  struct node { int from, to, l, r, ds; };
  node list[1005];
  int k = 0, head[1005], dis[1005], v[1005];
  int n, m, s, t, minn = 1e9, maxx = -1e9, ans = 1e9;

  void add(int x, int y, int l, int r, int c) {
      list[++k].from = head[x];
      list[k].to = y;
      list[k].l = l;
      list[k].r = r;
      list[k].ds = c;
      head[x] = k;
  }

  void spfa(int start) {
      memset(dis, 0x3f, sizeof(dis));
      memset(v, 0, sizeof(v));
      q.push(s);
      dis[s] = start;
      v[s] = 1;
      while (!q.empty()) {
          int u = q.front(); q.pop();
          v[u] = 0;
          for (int i = head[u]; i; i = list[i].from) {
              int v_node = list[i].to;
              int arrival = max(dis[u], list[i].l) + list[i].ds;
              if (arrival <= list[i].r && arrival < dis[v_node]) {
                  dis[v_node] = arrival;
                  if (!v[v_node]) {
                      q.push(v_node);
                      v[v_node] = 1;
                  }
              }
          }
      }
      if (dis[t] != 0x3f3f3f3f) {
          ans = min(ans, dis[t] - start);
      }
  }

  int main() {
      cin >> n >> m >> s >> t;
      for (int i = 1; i <= m; ++i) {
          int x, y, l, r, c;
          cin >> x >> y >> l >> r >> c;
          if (l + c > r) continue; // è¿‡æ»¤æ— æ•ˆè¾¹
          add(x, y, l, r, c);
          if (x == s) {
              minn = min(minn, l);
              maxx = max(maxx, r - c);
          }
      }
      for (int i = minn; i <= maxx; ++i) {
          spfa(i);
      }
      if (ans == 1e9) cout << "Impossible";
      else cout << ans;
      return 0;
  }
  ```  
* **ä»£ç è§£è¯»æ¦‚è¦**ï¼š  
  1. **é‚»æ¥è¡¨å­˜å›¾**ï¼š`add`å‡½æ•°å°†è¾¹å­˜å‚¨ä¸ºé‚»æ¥è¡¨ï¼Œæ–¹ä¾¿éå†æ¯ä¸ªèŠ‚ç‚¹çš„é‚»æ¥è¾¹ã€‚  
  2. **SPFAå‡½æ•°**ï¼šè®¡ç®—ä»`s`å‡ºå‘ï¼Œæ—¶åˆ»`start`çš„åˆ°è¾¾`t`çš„æœ€æ—©æ—¶åˆ»ã€‚`dis[u]`è¡¨ç¤ºåˆ°è¾¾`u`çš„æœ€æ—©æ—¶åˆ»ï¼Œ`v[u]`è¡¨ç¤ºèŠ‚ç‚¹æ˜¯å¦åœ¨é˜Ÿåˆ—ä¸­ã€‚  
  3. **ä¸»å‡½æ•°**ï¼šé¢„å¤„ç†`s`çš„æœ‰æ•ˆå‡ºå‘æ—¶é—´èŒƒå›´`[minn, maxx]`ï¼Œæšä¸¾æ¯ä¸ªå‡ºå‘æ—¶é—´ï¼Œè°ƒç”¨`spfa`è®¡ç®—æ—¶é—´å·®ï¼Œå–æœ€å°å€¼ã€‚  


### é¢˜è§£ä¸€ï¼ˆchzhcï¼‰æ ¸å¿ƒä»£ç èµæ  
* **äº®ç‚¹**ï¼šæšä¸¾å…³é”®è¾¹ï¼Œè·‘ä¸¤æ¬¡SPFAï¼ˆæ­£å‘å’Œåå‘ï¼‰ï¼Œå¤æ‚åº¦æ›´ä¼˜ã€‚  
* **æ ¸å¿ƒä»£ç ç‰‡æ®µ**ï¼š  
  ```cpp
  // æ­£å‘è¾¹ï¼ˆè®¡ç®—ä»è¾¹ç»ˆç‚¹åˆ°tçš„æœ€çŸ­æ—¶é—´ï¼‰
  void Add(int x, int y, int xx, int yy, int z) {
      next[++tot] = first[x];
      first[x] = tot;
      go[tot] = y;
      ta[tot] = xx; // è¾¹çš„å¼€æ”¾å¼€å§‹æ—¶é—´
      tb[tot] = yy; // è¾¹çš„å¼€æ”¾ç»“æŸæ—¶é—´
      value[tot] = z; // é€šè¿‡æ—¶é—´
  }
  // åå‘è¾¹ï¼ˆè®¡ç®—ä»såˆ°è¾¹èµ·ç‚¹çš„æœ€çŸ­æ—¶é—´ï¼‰
  void Addd(int x, int y, int xx, int yy, int z) {
      nextb[++totb] = firstb[x];
      firstb[x] = totb;
      gob[totb] = y;
      tab[totb] = xx;
      tbb[totb] = yy;
      valueb[totb] = z;
  }
  // æšä¸¾æ¯æ¡è¾¹ï¼Œè®¡ç®—ç­”æ¡ˆ
  for (int i = 1; i <= tot; ++i) {
      memset(disa, 0x3f, sizeof(disa));
      memset(disb, 0x3f, sizeof(disb));
      SpfaOne(go[i], tb[i]); // ä»è¾¹ç»ˆç‚¹go[i]å‡ºå‘ï¼Œæ—¶åˆ»tb[i]ï¼ˆè¾¹å…³é—­æ—¶é—´ï¼‰åˆ°tçš„æœ€çŸ­æ—¶é—´
      SpfaTwo(front[i], tb[i] - value[i]); // ä»è¾¹èµ·ç‚¹front[i]å‡ºå‘ï¼Œæ—¶åˆ»tb[i]-value[i]ï¼ˆåˆšå¥½é€šè¿‡è¾¹çš„æ—¶é—´ï¼‰åˆ°sçš„æœ€çŸ­æ—¶é—´
      ans = min(ans, disa[end] + disb[beg] + value[i]);
  }
  ```  
* **ä»£ç è§£è¯»**ï¼š  
  - æ­£å‘è¾¹ç”¨äºè®¡ç®—â€œä»è¾¹ç»ˆç‚¹åˆ°`t`çš„æœ€çŸ­æ—¶é—´â€ï¼ˆéœ€åœ¨è¾¹å…³é—­å‰åˆ°è¾¾è¾¹ç»ˆç‚¹ï¼‰ï¼›  
  - åå‘è¾¹ç”¨äºè®¡ç®—â€œä»`s`åˆ°è¾¹èµ·ç‚¹çš„æœ€çŸ­æ—¶é—´â€ï¼ˆéœ€åœ¨è¾¹å…³é—­å‰åˆ°è¾¾è¾¹èµ·ç‚¹ï¼‰ï¼›  
  - æšä¸¾æ¯æ¡è¾¹ï¼Œåˆå¹¶ä¸¤æ¬¡SPFAçš„ç»“æœï¼ˆ`disa[end]`æ˜¯è¾¹ç»ˆç‚¹åˆ°`t`çš„æ—¶é—´ï¼Œ`disb[beg]`æ˜¯`s`åˆ°è¾¹èµ·ç‚¹çš„æ—¶é—´ï¼Œ`value[i]`æ˜¯è¾¹çš„é€šè¿‡æ—¶é—´ï¼‰ï¼Œå¾—åˆ°å½“å‰è¾¹çš„å¯èƒ½ç­”æ¡ˆã€‚  
* **å­¦ä¹ ç¬”è®°**ï¼šå…³é”®è¾¹çš„æ€§è´¨æ˜¯è§£å†³æœ¬é¢˜çš„â€œæ·å¾„â€ï¼Œé¿å…äº†æšä¸¾æ‰€æœ‰å‡ºå‘æ—¶é—´ã€‚


### é¢˜è§£äºŒï¼ˆXiaoQuQuï¼‰æ ¸å¿ƒä»£ç èµæ  
* **äº®ç‚¹**ï¼šç”¨è®°å¿†åŒ–æœç´¢DPå¤„ç†æ—¶é—´çŠ¶æ€ï¼Œæ€è·¯æ–°é¢–ã€‚  
* **æ ¸å¿ƒä»£ç ç‰‡æ®µ**ï¼š  
  ```cpp
  const int MAXN = 105, MAXW = 1e4 + 5;
  int f[MAXN][MAXW]; // f[i][j]ï¼šæ—¶åˆ»jä»iå‡ºå‘åˆ°tçš„æœ€å°æ—¶åˆ»
  vector<tuple<int, int, int, int>> G[MAXN]; // é‚»æ¥è¡¨ï¼š(v, w, b, e)

  int dp(int i, int j) {
      if (f[i][j] != INT_MAX) return f[i][j];
      if (i == t) return j; // åˆ°è¾¾ç»ˆç‚¹ï¼Œè¿”å›å½“å‰æ—¶åˆ»
      for (auto [v, w, b, e] : G[i]) {
          int st = max(b, j); // å‡ºå‘æ—¶é—´ï¼ˆç­‰è¾¹å¼€æ”¾ï¼‰
          if (st + w > e) continue; // æ— æ³•é€šè¿‡
          f[i][j] = min(f[i][j], dp(v, st + w)); // é€’å½’è½¬ç§»
      }
      return f[i][j];
  }

  int main() {
      // è¾“å…¥å¤„ç†...
      for (int i = 1; i <= n; ++i) {
          fill(f[i], f[i] + MAXW, INT_MAX);
      }
      int ans = INT_MAX;
      for (int i = 1; i <= 1e4; ++i) {
          ans = min(ans, dp(s, i) - i); // è®¡ç®—æ—¶é—´å·®
      }
      // è¾“å‡º...
  }
  ```  
* **ä»£ç è§£è¯»**ï¼š  
  - `f[i][j]`è¡¨ç¤ºâ€œæ—¶åˆ»`j`ä»`i`å‡ºå‘åˆ°`t`çš„æœ€å°æ—¶åˆ»â€ï¼Œåˆå§‹åŒ–ä¸º`INT_MAX`ï¼ˆæœªè®¡ç®—ï¼‰ï¼›  
  - `dp`å‡½æ•°é€’å½’è®¡ç®—`f[i][j]`ï¼šå¦‚æœåˆ°è¾¾ç»ˆç‚¹`t`ï¼Œè¿”å›å½“å‰æ—¶åˆ»`j`ï¼›å¦åˆ™éå†`i`çš„é‚»æ¥è¾¹ï¼Œè®¡ç®—å‡ºå‘æ—¶é—´`st`ï¼ˆ`max(b, j)`ï¼‰ï¼Œå¦‚æœèƒ½é€šè¿‡è¾¹ï¼Œé€’å½’è®¡ç®—`v`èŠ‚ç‚¹çš„`st + w`æ—¶åˆ»çš„æœ€å°æ—¶åˆ»ï¼Œå–æœ€å°å€¼ï¼›  
  - ä¸»å‡½æ•°æšä¸¾æ‰€æœ‰å¯èƒ½çš„å‡ºå‘æ—¶é—´`i`ï¼Œè®¡ç®—`dp(s, i) - i`ï¼ˆæ—¶é—´å·®ï¼‰ï¼Œå–æœ€å°å€¼ã€‚  
* **å­¦ä¹ ç¬”è®°**ï¼šDPæ€è·¯å°†â€œæ—¶é—´â€ä½œä¸ºçŠ¶æ€çš„ä¸€éƒ¨åˆ†ï¼Œé€‚åˆå¤„ç†æ—¶é—´ç›¸å…³çš„çº¦æŸé—®é¢˜ã€‚


## 5. ç®—æ³•å¯è§†åŒ–ï¼šåƒç´ åŠ¨ç”»æ¼”ç¤ºï¼ˆæ ¸å¿ƒéƒ¨åˆ†ï¼‰

### åŠ¨ç”»æ¼”ç¤ºä¸»é¢˜ï¼šåƒç´ è·¯å£é€ƒç”Ÿè®°ï¼ˆFCé£æ ¼ï¼‰  
**è®¾è®¡æ€è·¯**ï¼šç”¨8ä½åƒç´ é£æ ¼æ¨¡æ‹Ÿå°timä»æ¸¸ä¹åœºåˆ° home çš„è·¯çº¿ï¼Œç»“åˆå¤å¤æ¸¸æˆå…ƒç´ ï¼ˆå¦‚åƒç´ éŸ³æ•ˆã€å…³å¡è¿›åº¦ï¼‰ï¼Œè®©ç®—æ³•è¿‡ç¨‹æ›´ç›´è§‚ã€æœ‰è¶£ã€‚  

### æ ¸å¿ƒæ¼”ç¤ºå†…å®¹  
1. **åœºæ™¯åˆå§‹åŒ–**ï¼š  
   - å±å¹•æ˜¾ç¤º4x4åƒç´ ç½‘æ ¼ï¼ˆæ¨¡æ‹Ÿæ ·ä¾‹è¾“å…¥çš„4ä¸ªè·¯å£ï¼‰ï¼Œ`s`ï¼ˆ1å·è·¯å£ï¼‰æ˜¯çº¢è‰²èµ·ç‚¹ï¼Œ`t`ï¼ˆ4å·è·¯å£ï¼‰æ˜¯ç»¿è‰²ç»ˆç‚¹ï¼Œå…¶ä»–è·¯å£æ˜¯ç°è‰²ã€‚  
   - é©¬è·¯ç”¨é»‘è‰²çº¿æ¡è¡¨ç¤ºï¼Œæ—è¾¹æ˜¾ç¤ºå¼€æ”¾æ—¶é—´ï¼ˆå¦‚`[1,3]`ï¼‰å’Œé€šè¿‡æ—¶é—´ï¼ˆå¦‚`2`ï¼‰ã€‚  
   - æ§åˆ¶é¢æ¿æœ‰â€œå¼€å§‹/æš‚åœâ€â€œå•æ­¥æ‰§è¡Œâ€â€œé‡ç½®â€æŒ‰é’®ï¼Œä»¥åŠé€Ÿåº¦æ»‘å—ï¼ˆ1x~5xï¼‰ã€‚  

2. **ç®—æ³•å¯åŠ¨**ï¼š  
   - å°timï¼ˆé»„è‰²åƒç´ äººï¼‰ç«™åœ¨`s`è·¯å£ï¼Œæ˜¾ç¤ºå½“å‰å‡ºå‘æ—¶é—´ï¼ˆå¦‚`1`ï¼‰ã€‚  
   - é˜Ÿåˆ—ï¼ˆSPFAçš„é˜Ÿåˆ—ï¼‰ç”¨è“è‰²æ¡†æ˜¾ç¤ºï¼Œåˆå§‹æ—¶`s`å…¥é˜Ÿï¼ˆé—ªçƒï¼‰ã€‚  

3. **SPFAè¿‡ç¨‹æ¼”ç¤º**ï¼š  
   - **èŠ‚ç‚¹å‡ºé˜Ÿ**ï¼šé˜Ÿåˆ—ä¸­çš„ç¬¬ä¸€ä¸ªèŠ‚ç‚¹ï¼ˆå¦‚`s`ï¼‰å‡ºé˜Ÿï¼Œæ˜¾ç¤ºâ€œå¤„ç†èŠ‚ç‚¹1â€çš„æ–‡å­—æç¤ºã€‚  
   - **éå†é‚»æ¥è¾¹**ï¼šéå†`s`çš„é‚»æ¥è¾¹ï¼ˆå¦‚`1â†’3`ï¼Œå¼€æ”¾æ—¶é—´`[1,3]`ï¼Œé€šè¿‡æ—¶é—´`2`ï¼‰ï¼Œè®¡ç®—å‡ºå‘æ—¶é—´`max(1, 1) = 1`ï¼Œé€šè¿‡æ—¶é—´`1+2=3`ï¼Œåˆ¤æ–­æ˜¯å¦åœ¨å¼€æ”¾æ—¶é—´å†…ï¼ˆ`3<=3`ï¼‰ï¼Œæ˜¯çš„ã€‚  
   - **æ¾å¼›æ“ä½œ**ï¼šæ›´æ–°`3`å·èŠ‚ç‚¹çš„åˆ°è¾¾æ—¶é—´ä¸º`3`ï¼Œå°†`3`å·èŠ‚ç‚¹å…¥é˜Ÿï¼ˆé—ªçƒï¼‰ï¼Œæ˜¾ç¤ºâ€œèŠ‚ç‚¹3å…¥é˜Ÿï¼Œåˆ°è¾¾æ—¶é—´3â€çš„æ–‡å­—æç¤ºã€‚  
   - **éŸ³æ•ˆ**ï¼šèŠ‚ç‚¹å…¥é˜Ÿæ—¶æ’­æ”¾â€œå®â€çš„éŸ³æ•ˆï¼Œé€šè¿‡è¾¹æ—¶æ’­æ”¾â€œå±â€çš„éŸ³æ•ˆã€‚  

4. **ç›®æ ‡è¾¾æˆ**ï¼š  
   - å½“å°timåˆ°è¾¾`t`ï¼ˆ4å·è·¯å£ï¼‰æ—¶ï¼Œæ’­æ”¾â€œèƒœåˆ©â€éŸ³æ•ˆï¼ˆä¸Šæ‰¬çš„8ä½éŸ³ä¹ï¼‰ï¼Œæ˜¾ç¤ºâ€œåˆ°è¾¾ç»ˆç‚¹ï¼æ—¶é—´å·®3â€çš„æ–‡å­—æç¤ºï¼Œå°timè·³èµ·æ¥åº†ç¥ï¼ˆåƒç´ åŠ¨ç”»ï¼‰ã€‚  

5. **æ¸¸æˆåŒ–å…ƒç´ **ï¼š  
   - **å…³å¡è¿›åº¦**ï¼šæ¯å¤„ç†ä¸€ä¸ªèŠ‚ç‚¹è§†ä¸ºâ€œé€šè¿‡ä¸€å…³â€ï¼Œæ˜¾ç¤ºè¿›åº¦æ¡ï¼ˆå¦‚`1/4`ï¼‰ã€‚  
   - **ç§¯åˆ†**ï¼šæ¯æ‰¾åˆ°ä¸€æ¡æ›´çŸ­è·¯å¾„ï¼ŒåŠ 10åˆ†ï¼Œæ˜¾ç¤ºâ€œ+10åˆ†â€çš„åƒç´ æ–‡å­—ã€‚  


## 6. æ‹“å±•ç»ƒä¹ ä¸ç›¸ä¼¼é—®é¢˜æ€è€ƒ

### é€šç”¨æ€è·¯è¿ç§»  
å¸¦æ—¶é—´çº¦æŸçš„æœ€çŸ­è·¯ç®—æ³•å¯ç”¨äºè§£å†³ä»¥ä¸‹é—®é¢˜ï¼š  
- **å¿«é€’é…é€**ï¼šå¿«é€’å‘˜éœ€è¦åœ¨æŒ‡å®šæ—¶é—´çª—å£å†…é€è¾¾åŒ…è£¹ï¼Œæ±‚æœ€çŸ­è·¯çº¿ã€‚  
- **èˆªç­è½¬æœº**ï¼šä¹˜å®¢éœ€è¦åœ¨è½¬æœºæ—¶é—´å†…èµ¶ä¸Šåç»­èˆªç­ï¼Œæ±‚æœ€çŸ­è½¬æœºæ—¶é—´ã€‚  
- **å·¥å‚è°ƒåº¦**ï¼šå·¥ä»¶éœ€è¦åœ¨æœºå™¨çš„å¯ç”¨æ—¶é—´å†…åŠ å·¥ï¼Œæ±‚æœ€çŸ­åŠ å·¥æ—¶é—´ã€‚  

### æ´›è°·ç»ƒä¹ æ¨è  
1. **æ´›è°· P1339** - æœ€é•¿è·¯å¾„é—®é¢˜  
   ğŸ—£ï¸ **æ¨èç†ç”±**ï¼šæœ¬é¢˜æ˜¯å¸¦æ—¶é—´çº¦æŸçš„æœ€é•¿è·¯å¾„é—®é¢˜ï¼Œéœ€è¦å¤„ç†è¾¹çš„å¼€æ”¾æ—¶é—´ï¼Œä¸â€œæ‹¯æ•‘å°timâ€çš„æ—¶é—´çº¦æŸå¤„ç†æ€è·¯ä¸€è‡´ï¼Œé€‚åˆå·©å›ºæ—¶é—´çº¦æŸçš„å¤„ç†æŠ€å·§ã€‚  

2. **æ´›è°· P1807** - æœ€çŸ­è·¯é—®é¢˜  
   ğŸ—£ï¸ **æ¨èç†ç”±**ï¼šæœ¬é¢˜æ˜¯å¸¦è¾¹æƒçº¦æŸçš„æœ€çŸ­è·¯é—®é¢˜ï¼Œéœ€è¦å¤„ç†è¾¹çš„â€œå¯ç”¨æ¡ä»¶â€ï¼ˆå¦‚è¾¹æƒå¿…é¡»å¤§äºæŸä¸ªå€¼ï¼‰ï¼Œä¸â€œæ‹¯æ•‘å°timâ€çš„è¾¹çº¦æŸå¤„ç†æ€è·¯ç±»ä¼¼ï¼Œé€‚åˆæ‹“å±•æ€ç»´ã€‚  

3. **æ´›è°· P2384** - å›¾è®ºé—®é¢˜  
   ğŸ—£ï¸ **æ¨èç†ç”±**ï¼šæœ¬é¢˜æ˜¯å¸¦æ—¶é—´çª—å£çš„å›¾è®ºé—®é¢˜ï¼Œéœ€è¦å¤„ç†èŠ‚ç‚¹çš„â€œå¯ç”¨æ—¶é—´â€ï¼ˆå¦‚èŠ‚ç‚¹åªèƒ½åœ¨æŸä¸ªæ—¶é—´å†…è®¿é—®ï¼‰ï¼Œä¸â€œæ‹¯æ•‘å°timâ€çš„æ—¶é—´å¤„ç†æ€è·¯ä¸€è‡´ï¼Œé€‚åˆæ·±åŒ–å¯¹æ—¶é—´çŠ¶æ€çš„ç†è§£ã€‚  


## 7. å­¦ä¹ å¿ƒå¾—ä¸ç»éªŒåˆ†äº«ï¼ˆè‹¥æœ‰ï¼‰  
**å‚è€ƒç»éªŒï¼ˆæ¥è‡ªchzhcï¼‰**ï¼šâ€œæˆ‘æœ€åˆæƒ³æšä¸¾æ‰€æœ‰å‡ºå‘æ—¶é—´ï¼Œä½†å‘ç°æ—¶é—´å¤æ‚åº¦è¿‡é«˜ã€‚åæ¥æƒ³åˆ°ï¼Œæœ€ä¼˜è·¯å¾„å¿…ç„¶åŒ…å«ä¸€æ¡â€˜å¡æ—¶é—´ä¸Šé™â€™çš„è¾¹ï¼Œäºæ˜¯è½¬è€Œæšä¸¾å…³é”®è¾¹ï¼Œå¤æ‚åº¦é™ä½äº†å¾ˆå¤šã€‚â€  
**ç‚¹è¯„**ï¼šè¿™ä½ä½œè€…çš„ç»éªŒæé†’æˆ‘ä»¬ï¼Œ**è§‚å¯Ÿé—®é¢˜çš„æ€§è´¨ï¼ˆå¦‚æœ€ä¼˜è§£çš„ç»“æ„ï¼‰**æ˜¯ä¼˜åŒ–ç®—æ³•çš„å…³é”®ã€‚åœ¨é‡åˆ°æ—¶é—´å¤æ‚åº¦è¿‡é«˜çš„é—®é¢˜æ—¶ï¼Œä¸å¦¨æ€è€ƒâ€œæœ€ä¼˜è§£æ˜¯å¦æœ‰ç‰¹æ®Šæ€§è´¨â€ï¼Œä»è€Œæ‰¾åˆ°æ›´é«˜æ•ˆçš„è§£æ³•ã€‚  


## æ€»ç»“  
æœ¬æ¬¡åˆ†æäº†â€œæ‹¯æ•‘å°timâ€è¿™é“å¸¦æ—¶é—´çº¦æŸçš„æœ€çŸ­è·¯é—®é¢˜ï¼Œé‡ç‚¹è®²è§£äº†**æšä¸¾å‡ºå‘æ—¶é—´**å’Œ**æšä¸¾å…³é”®è¾¹**ä¸¤ç§è§£æ³•ï¼Œä»¥åŠæ—¶é—´çº¦æŸçš„å¤„ç†æŠ€å·§ã€‚é€šè¿‡åƒç´ åŠ¨ç”»æ¼”ç¤ºï¼Œæˆ‘ä»¬ç›´è§‚åœ°çœ‹åˆ°äº†SPFAçš„æ‰§è¡Œè¿‡ç¨‹ï¼Œç†è§£äº†æ—¶é—´çŠ¶æ€çš„ä¼ é€’ã€‚  

è®°ä½ï¼Œè§£å†³å›¾è®ºé—®é¢˜çš„å…³é”®æ˜¯**å»ºæ¨¡**ï¼ˆå°†å®é™…é—®é¢˜è½¬åŒ–ä¸ºå›¾çš„æ¨¡å‹ï¼‰å’Œ**é€‰æ‹©åˆé€‚çš„ç®—æ³•**ï¼ˆå¦‚SPFAã€Dijkstraï¼‰ã€‚å¸Œæœ›è¿™ä»½æŒ‡å—èƒ½å¸®åŠ©ä½ æŒæ¡å¸¦æ—¶é—´çº¦æŸçš„æœ€çŸ­è·¯ç®—æ³•ï¼Œä¸‹æ¬¡é‡åˆ°ç±»ä¼¼é—®é¢˜æ—¶èƒ½ä¸¾ä¸€åä¸‰ï¼ğŸ’ª

---
å¤„ç†ç”¨æ—¶ï¼š231.86ç§’
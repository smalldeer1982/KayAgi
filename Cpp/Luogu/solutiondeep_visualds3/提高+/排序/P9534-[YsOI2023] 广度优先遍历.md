# é¢˜ç›®ä¿¡æ¯

# [YsOI2023] å¹¿åº¦ä¼˜å…ˆéå†

## é¢˜ç›®èƒŒæ™¯

Ysuperman æ¨¡æ¿æµ‹è¯•çš„å›¾è®ºé¢˜ã€‚

ã€æ•°æ®åˆ é™¤ã€‘

## é¢˜ç›®æè¿°

ä»Šå¤©çš„æ¨¡æ¿æµ‹è¯•æ˜¯æ— å‘å›¾ä¸Šçš„å¹¿åº¦ä¼˜å…ˆéå†ï¼Œã€æ•°æ®åˆ é™¤ã€‘é©¬ä¸Šå†™å¥½äº†ä»£ç ï¼š

```cpp
#include <cstdio>
#include <cstring>
#include <iostream>
#include <algorithm>
#include <vector>
#include <queue>
using namespace std;
const int maxn = 100005;
vector<int> G[maxn];
queue<int> q;
int pa[maxn];
int main()
{
    int n, m;
    cin >> n >> m;
    for (int i = 1; i <= m; ++i)
    {
        int u, v;
        cin >> u >> v;
        G[u].push_back(v);
        G[v].push_back(u);
    }
    memset(pa, -1, sizeof pa);
    q.push(1);
    pa[1] = 0;
    while (!q.empty())
    {
        int u = q.front();
        q.pop();
        for (auto v : G[u])
        {
            if (pa[v] != -1)
                continue;
            pa[v] = u;
            q.push(v);
        }
    }
    for (int i = 1; i <= n; ++i)
    {
        cout << pa[i];
        if (i != n)
            cout << " ";
    }
    cout << endl;
    return 0;
}
```

å¦‚ä½ æ‰€è§ï¼Œè¿™ä»½ä»£ç ä¼šè¾“å…¥ä¸€ä¸ª $n$ ä¸ªç‚¹ $m$ æ¡è¾¹çš„æ— å‘å›¾ï¼Œå¹¶ä¸”æ±‚å‡ºè¿™å¼ å›¾ä»¥ $1$ ä¸ºæ ¹çš„ä¸€æ£µâ€œå¹¿åº¦ä¼˜å…ˆéå†æ ‘â€ï¼Œæœ€åè¾“å‡ºæ‰€æœ‰ç‚¹çš„çˆ¶äº²èŠ‚ç‚¹ç¼–å·ã€‚

ä¸è¿‡å€¼å¾—æ³¨æ„çš„æ˜¯ï¼Œè¿™æ£µâ€œå¹¿åº¦ä¼˜å…ˆéå†æ ‘â€çš„å…·ä½“å½¢æ€å’Œâ€œè¾¹çš„è¾“å…¥é¡ºåºâ€æœ‰å…³ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œä¸åŒçš„è¾“å…¥é¡ºåºå¯èƒ½ä¼šå¾—åˆ°ä¸åŒçš„çˆ¶äº²èŠ‚ç‚¹ç¼–å·ã€‚

ç°åœ¨ã€æ•°æ®åˆ é™¤ã€‘å‘Šè¯‰äº†ä½  $n,m$ã€è¿™ $m$ æ¡è¾¹ä»¥åŠåœ¨æŸä¸ªâ€œè¾¹è¾“å…¥é¡ºåºâ€æƒ…å†µä¸‹ä»–çš„ä»£ç çš„è¾“å‡ºï¼Œä½ éœ€è¦è¿˜åŸå‡ºè¿™ä¸ªâ€œè¾¹è¾“å…¥é¡ºåºâ€ã€‚å¦‚æœæœ‰å¤šç§è¾¹è¾“å…¥é¡ºåºå¯¹åº”çš„éƒ½æ˜¯è¿™æ ·çš„è¾“å‡ºï¼Œä½ **åªéœ€è¦è¾“å‡ºå…¶ä¸­ä»»æ„ä¸€ç§**å³å¯ã€‚

ç‰¹åˆ«çš„ï¼Œä¿è¯æœ‰è§£ï¼Œä¸”æ— å‘å›¾è¿é€šï¼Œæ— è‡ªç¯ï¼ˆä½†æ˜¯æœ‰å¯èƒ½æœ‰é‡è¾¹ï¼‰ã€‚

## è¯´æ˜/æç¤º

#### æ ·ä¾‹ 1 è§£é‡Š

ç›´æ¥è¿è¡Œã€æ•°æ®åˆ é™¤ã€‘çš„ä»£ç å³å¯ã€‚

å¦‚æœä¸æ”¹å˜è¾¹è¾“å…¥é¡ºåºï¼Œå°†ä¸‹é¢æ•°æ®è¾“å…¥ã€æ•°æ®åˆ é™¤ã€‘çš„ä»£ç ï¼š

```
4 4
2 1
1 3
2 4
4 3
```

ä»–çš„ä»£ç è·‘å‡ºæ¥ç»“æœå¦‚ä¸‹ï¼š

```
0 1 1 2
```

å¦‚æœæŒ‰ç…§æ ·ä¾‹ 1 è¾“å‡ºç»™å‡ºçš„é¡ºåºï¼Œå³ï¼Œå°†ä¸‹é¢æ•°æ®è¾“å…¥ä»–çš„ä»£ç ï¼š

```
4 4
1 3
3 4
1 2
2 4
```

è¾“å‡ºä¸ºï¼š

```
0 1 1 3
```

#### æ•°æ®èŒƒå›´

å¯¹äºå‰ $10\%$ çš„æ•°æ®ï¼Œæ»¡è¶³ $n\le 8$ï¼Œ$m\le 10$ã€‚

å¯¹äºå‰ $40\%$ çš„æ•°æ®ï¼Œæ»¡è¶³ $n\le 1000$ï¼Œ$m\le 2000$ã€‚

å¦æœ‰ $10\%$ çš„æ•°æ®ï¼Œæ»¡è¶³ $m=n-1$ã€‚

å¯¹äº $100\%$ çš„æ•°æ®ï¼Œæ»¡è¶³ $1\le n\le 10^5$ï¼Œ$1\le m\le 2\times 10^5$ã€‚

#### æç¤º

ä¸ºä»€ä¹ˆæœ‰å¯èƒ½ä¼šæœ‰é‡è¾¹ï¼Œå› ä¸ºæ‡’å¾—å»é‡äº†ï¼Œè¿™ä¸ªå®¶ä¼™å‡ºå›¾è®ºé¢˜å°±æ˜¯æ‡’å¾—åˆ¤é‡è¾¹çš„ï¼ˆï¼‰

é™„ä»¶ä¸‹å‘äº†æœ¬é¢˜ checkerã€‚

## æ ·ä¾‹ #1

### è¾“å…¥

```
4 4
2 1
1 3
2 4
4 3
0 1 1 3```

### è¾“å‡º

```
1 3
3 4
1 2
2 4
```

## æ ·ä¾‹ #2

### è¾“å…¥

```
8 9
7 8
6 1
5 4
7 1
4 1
3 7
2 6
7 5
2 4
0 6 7 1 4 1 1 7```

### è¾“å‡º

```
6 2
7 3
4 5
1 6
7 8
1 4
1 7
2 4
5 7```

# AIåˆ†æç»“æœ

# ğŸ’¡ Kayçš„C++ç®—æ³•è§£æï¼š[YsOI2023] å¹¿åº¦ä¼˜å…ˆéå† æ·±å…¥å­¦ä¹ æŒ‡å— ğŸ’¡


## 1. é¢˜ç›®è§£è¯»ä¸æ ¸å¿ƒç®—æ³•è¯†åˆ«

âœ¨ **æœ¬é¢˜ä¸»è¦è€ƒå¯Ÿ**ï¼šå›¾è®ºï¼ˆæ‹“æ‰‘æ’åºï¼‰ã€BFSæ ‘æ€§è´¨åº”ç”¨  

ğŸ—£ï¸ **åˆæ­¥åˆ†æ**ï¼š  
è§£å†³â€œè¿˜åŸBFSæ ‘çš„è¾¹è¾“å…¥é¡ºåºâ€é—®é¢˜ï¼Œå…³é”®åœ¨äº**å°†è¾¹çš„é¡ºåºçº¦æŸè½¬åŒ–ä¸ºæ‹“æ‰‘æ’åºé—®é¢˜**ã€‚ç®€å•æ¥è¯´ï¼Œæ‹“æ‰‘æ’åºå°±åƒâ€œæ’é˜Ÿä¹°å¥¶èŒ¶â€â€”â€”å¦‚æœAå¿…é¡»åœ¨Bå‰é¢ä¹°ï¼ŒBå¿…é¡»åœ¨Cå‰é¢ä¹°ï¼Œé‚£ä¹ˆæœ€ç»ˆçš„é¡ºåºä¸€å®šæ˜¯Aâ†’Bâ†’Cã€‚åœ¨æœ¬é¢˜ä¸­ï¼Œæˆ‘ä»¬éœ€è¦æ‰¾åˆ°è¾¹ä¹‹é—´çš„â€œå¿…é¡»å…ˆå‡ºç°â€çš„çº¦æŸå…³ç³»ï¼ˆæ¯”å¦‚æ ‘è¾¹å¿…é¡»åœ¨æŸäº›éæ ‘è¾¹å‰é¢ï¼‰ï¼Œç„¶åé€šè¿‡æ‹“æ‰‘æ’åºå¾—åˆ°ä¸€ç»„åˆæ³•çš„è¾¹é¡ºåºã€‚  

### æ ¸å¿ƒæ€è·¯ä¸éš¾ç‚¹  
æ‰€æœ‰é¢˜è§£çš„å…±æ€§æ€è·¯æ˜¯ï¼š  
1. **åˆ†ç±»è¾¹**ï¼šå°†è¾¹åˆ†ä¸º**æ ‘è¾¹**ï¼ˆBFSæ ‘ä¸­çš„è¾¹ï¼‰å’Œ**éæ ‘è¾¹**ï¼ˆä¸åœ¨BFSæ ‘ä¸­çš„è¾¹ï¼‰ã€‚  
2. **å»ºç«‹çº¦æŸ**ï¼šéæ ‘è¾¹ä¼šå¯¹æ ‘è¾¹çš„é¡ºåºäº§ç”Ÿçº¦æŸï¼ˆæ¯”å¦‚éæ ‘è¾¹è¿æ¥çš„ä¸¤ä¸ªèŠ‚ç‚¹ï¼Œæ ‘è¾¹å¿…é¡»æ¯”éæ ‘è¾¹å…ˆå‡ºç°æ‰èƒ½ä¿è¯BFSæ ‘çš„ç»“æ„ï¼‰ã€‚  
3. **æ‹“æ‰‘æ’åº**ï¼šå°†çº¦æŸè½¬åŒ–ä¸ºæœ‰å‘æ— ç¯å›¾ï¼ˆDAGï¼‰ï¼Œé€šè¿‡æ‹“æ‰‘æ’åºå¾—åˆ°è¾¹çš„åˆæ³•é¡ºåºã€‚  

**æ ¸å¿ƒéš¾ç‚¹**ï¼šå¦‚ä½•æ­£ç¡®è¯†åˆ«éæ ‘è¾¹å¯¹æ ‘è¾¹çš„çº¦æŸå…³ç³»ï¼ˆæ¯”å¦‚éæ ‘è¾¹è¿æ¥çš„èŠ‚ç‚¹çš„ç¥–å…ˆå…³ç³»ï¼‰ã€‚  

### å¯è§†åŒ–è®¾è®¡æ€è·¯  
æˆ‘ä»¬å¯ä»¥ç”¨**8ä½åƒç´ é£æ ¼**æ¼”ç¤ºæ‹“æ‰‘æ’åºçš„è¿‡ç¨‹ï¼š  
- **èŠ‚ç‚¹**ï¼šç”¨ä¸åŒé¢œè‰²çš„åƒç´ å—ä»£è¡¨è¾¹ï¼ˆæ ‘è¾¹ä¸ºç»¿è‰²ï¼Œéæ ‘è¾¹ä¸ºç°è‰²ï¼‰ã€‚  
- **çº¦æŸ**ï¼šç”¨çº¢è‰²ç®­å¤´è¡¨ç¤ºâ€œå¿…é¡»å…ˆå‡ºç°â€çš„å…³ç³»ï¼ˆæ¯”å¦‚æ ‘è¾¹Aâ†’éæ ‘è¾¹Bï¼Œè¡¨ç¤ºAå¿…é¡»åœ¨Bå‰é¢ï¼‰ã€‚  
- **åŠ¨ç”»æ­¥éª¤**ï¼š  
  1. åˆå§‹åŒ–ï¼šæ˜¾ç¤ºæ‰€æœ‰è¾¹èŠ‚ç‚¹å’Œçº¦æŸç®­å¤´ã€‚  
  2. å•æ­¥æ‰§è¡Œï¼šæ¯æ¬¡é€‰ä¸­ä¸€ä¸ªå…¥åº¦ä¸º0çš„èŠ‚ç‚¹ï¼ˆæ²¡æœ‰å‰ç½®çº¦æŸçš„è¾¹ï¼‰ï¼Œå°†å…¶æ ‡è®°ä¸ºâ€œå·²å¤„ç†â€ï¼ˆé¢œè‰²å˜äº®ï¼‰ï¼Œå¹¶ç§»é™¤å…¶ outgoing çº¦æŸã€‚  
  3. éŸ³æ•ˆï¼šé€‰ä¸­èŠ‚ç‚¹æ—¶æ’­æ”¾â€œå®â€çš„åƒç´ éŸ³æ•ˆï¼Œå®Œæˆæ—¶æ’­æ”¾èƒœåˆ©éŸ³æ•ˆï¼ˆæ¯”å¦‚FCæ¸¸æˆçš„â€œé€šå…³å£°â€ï¼‰ã€‚  
- **äº¤äº’**ï¼šæ”¯æŒâ€œå•æ­¥â€â€œè‡ªåŠ¨æ’­æ”¾â€ï¼ˆå¯è°ƒé€Ÿåº¦ï¼‰å’Œâ€œé‡ç½®â€æŒ‰é’®ï¼Œæ–¹ä¾¿è§‚å¯Ÿæ¯ä¸€æ­¥çš„å˜åŒ–ã€‚  


## 2. ç²¾é€‰ä¼˜è´¨é¢˜è§£å‚è€ƒ

### é¢˜è§£ä¸€ï¼šæ¥æºï¼šxiaolilsqï¼ˆèµï¼š26ï¼‰  
* **ç‚¹è¯„**ï¼š  
  è¿™ä»½é¢˜è§£çš„æ€è·¯éå¸¸æ¸…æ™°ï¼Œç›´æ¥æŠ“ä½äº†é—®é¢˜çš„æ ¸å¿ƒâ€”â€”**éæ ‘è¾¹çš„çº¦æŸå…³ç³»**ã€‚ä½œè€…æŒ‡å‡ºï¼Œéæ ‘è¾¹è¿æ¥çš„èŠ‚ç‚¹å¦‚æœæ·±åº¦ä¸åŒï¼Œä¼šå¯¹æ ‘è¾¹çš„é¡ºåºäº§ç”Ÿâ€œååºå…³ç³»â€ï¼ˆæ¯”å¦‚æ ‘è¾¹å¿…é¡»æ¯”éæ ‘è¾¹å…ˆå‡ºç°ï¼‰ã€‚é€šè¿‡å»ºç«‹è¿™äº›ååºå…³ç³»ï¼Œç„¶åè·‘æ‹“æ‰‘æ’åºï¼Œå°±èƒ½å¾—åˆ°åˆæ³•çš„è¾¹é¡ºåºã€‚ä»£ç ç»“æ„ç®€æ´ï¼Œå˜é‡å‘½åæ¸…æ™°ï¼ˆæ¯”å¦‚ç”¨`G`å­˜å›¾ï¼Œ`q`å­˜æ‹“æ‰‘é˜Ÿåˆ—ï¼‰ï¼Œç‰¹åˆ«æ˜¯å¯¹éæ ‘è¾¹çš„å¤„ç†éå¸¸ä¸¥è°¨ï¼Œæ˜¯å…¥é—¨è€…ç†è§£æœ¬é¢˜çš„å¥½ä¾‹å­ã€‚  

### é¢˜è§£äºŒï¼šæ¥æºï¼šWilliamFranklinï¼ˆèµï¼š8ï¼‰  
* **ç‚¹è¯„**ï¼š  
  ä½œè€…åˆ†äº«äº†èµ›æ—¶æœ€å5åˆ†é’Ÿåšå‡ºæ¥çš„ç»å†ï¼Œéå¸¸æœ‰ä»£å…¥æ„Ÿï¼æ€è·¯ä¸Šï¼Œä½œè€…ä»å¶å­èŠ‚ç‚¹å‡ºå‘ï¼Œå‘ä¸Šéå†æ ‘ï¼Œæ‰¾åˆ°æ‰€æœ‰éœ€è¦çº¦æŸçš„è¾¹ï¼ˆæ¯”å¦‚å¶å­èŠ‚ç‚¹çš„çˆ¶äº²è¾¹å¿…é¡»æ¯”å…¶ä»–è¾¹å…ˆå‡ºç°ï¼‰ã€‚ä»£ç ä¸­ç”¨äº†`GG`æ•°ç»„å­˜å‚¨å¶å­èŠ‚ç‚¹çš„å­æ ‘ï¼Œ`tp`å‡½æ•°å¤„ç†æ‹“æ‰‘æ’åºï¼Œè™½ç„¶æœ‰äº›ç»†èŠ‚ï¼ˆæ¯”å¦‚`map`å¤„ç†é‡è¾¹ï¼‰å¯èƒ½ç¨æ˜¾å¤æ‚ï¼Œä½†æ•´ä½“é€»è¾‘è¿è´¯ï¼Œé€‚åˆå­¦ä¹ â€œå¦‚ä½•ä»å…·ä½“ä¾‹å­æ¨å¯¼é€šç”¨çº¦æŸâ€ã€‚  

### é¢˜è§£ä¸‰ï¼šæ¥æºï¼šRsCbï¼ˆèµï¼š6ï¼‰  
* **ç‚¹è¯„**ï¼š  
  ä½œè€…å¯¹éæ ‘è¾¹è¿›è¡Œäº†**åˆ†ç±»è®¨è®º**ï¼ˆæ·±åº¦å·®0ã€1ã€â‰¥2ï¼‰ï¼Œé€»è¾‘éå¸¸ä¸¥è°¨ã€‚ç‰¹åˆ«æ˜¯å¯¹æ·±åº¦å·®1çš„éæ ‘è¾¹ï¼Œä½œè€…ç”¨LCAï¼ˆæœ€è¿‘å…¬å…±ç¥–å…ˆï¼‰æ‰¾åˆ°çº¦æŸçš„è¾¹ï¼ˆæ¯”å¦‚æ ‘è¾¹çš„ç¥–å…ˆè¾¹å¿…é¡»æ¯”éæ ‘è¾¹çš„ç¥–å…ˆè¾¹å…ˆå‡ºç°ï¼‰ã€‚ä»£ç ä¸­ç”¨äº†`dag`æ•°ç»„å­˜æ‹“æ‰‘å›¾ï¼Œ`topo`å‡½æ•°å¤„ç†æ’åºï¼Œå¤æ‚åº¦åˆ†æåˆ°ä½ï¼ˆO(m log m)ï¼‰ï¼Œé€‚åˆå­¦ä¹ â€œå¦‚ä½•ç”¨é«˜çº§æ•°æ®ç»“æ„è§£å†³çº¦æŸé—®é¢˜â€ã€‚  


## 3. æ ¸å¿ƒéš¾ç‚¹è¾¨æä¸è§£é¢˜ç­–ç•¥

### 1. **å…³é”®ç‚¹1ï¼šå¦‚ä½•åˆ†ç±»éæ ‘è¾¹ï¼Ÿ**  
* **åˆ†æ**ï¼š  
  éæ ‘è¾¹çš„æ·±åº¦å·®å†³å®šäº†å®ƒæ˜¯å¦å¯¹æ ‘è¾¹æœ‰çº¦æŸã€‚æ¯”å¦‚ï¼š  
  - æ·±åº¦å·®0ï¼šéæ ‘è¾¹è¿æ¥åŒä¸€å±‚çš„èŠ‚ç‚¹ï¼Œä¸ä¼šå½±å“æ ‘è¾¹é¡ºåºï¼ˆå› ä¸ºBFSä¸ä¼šé€šè¿‡å®ƒè®¿é—®èŠ‚ç‚¹ï¼‰ã€‚  
  - æ·±åº¦å·®1ï¼šéæ ‘è¾¹è¿æ¥ç›¸é‚»å±‚çš„èŠ‚ç‚¹ï¼Œä¼šå¯¹æ ‘è¾¹çš„é¡ºåºäº§ç”Ÿçº¦æŸï¼ˆæ¯”å¦‚æ ‘è¾¹å¿…é¡»æ¯”éæ ‘è¾¹å…ˆå‡ºç°ï¼Œå¦åˆ™BFSä¼šé€‰æ‹©éæ ‘è¾¹ä½œä¸ºæ ‘è¾¹ï¼‰ã€‚  
  - æ·±åº¦å·®â‰¥2ï¼šä¸å¯èƒ½å­˜åœ¨ï¼ˆå› ä¸ºBFSçš„æ€§è´¨ï¼ŒèŠ‚ç‚¹çš„æ·±åº¦æ˜¯æœ€çŸ­è·ç¦»ï¼Œæ·±åº¦å·®â‰¥2çš„è¾¹ä¼šè¢«BFSé€‰ä¸ºæ ‘è¾¹ï¼‰ã€‚  
* ğŸ’¡ **å­¦ä¹ ç¬”è®°**ï¼šåˆ†ç±»è®¨è®ºæ˜¯è§£å†³å›¾è®ºé—®é¢˜çš„å¸¸ç”¨æŠ€å·§ï¼Œèƒ½å¸®æˆ‘ä»¬æ’é™¤æ— å…³æƒ…å†µï¼Œèšç„¦æ ¸å¿ƒçº¦æŸã€‚  

### 2. **å…³é”®ç‚¹2ï¼šå¦‚ä½•å»ºç«‹çº¦æŸå…³ç³»ï¼Ÿ**  
* **åˆ†æ**ï¼š  
  å¯¹äºæ·±åº¦å·®1çš„éæ ‘è¾¹ï¼ˆu, vï¼‰ï¼Œå‡è®¾vçš„çˆ¶äº²æ˜¯wï¼Œé‚£ä¹ˆwçš„æ ‘è¾¹å¿…é¡»æ¯”uçš„æ ‘è¾¹å…ˆå‡ºç°ã€‚ä¸ºäº†æ‰¾åˆ°è¿™ä¸ªçº¦æŸï¼Œæˆ‘ä»¬éœ€è¦ç”¨LCAæ‰¾åˆ°wå’Œuçš„æœ€è¿‘å…¬å…±ç¥–å…ˆï¼Œç„¶åçº¦æŸç¥–å…ˆçš„æ ‘è¾¹é¡ºåºã€‚æ¯”å¦‚ï¼Œåœ¨æ ·ä¾‹1ä¸­ï¼Œéæ ‘è¾¹ï¼ˆ2,4ï¼‰çš„çº¦æŸæ˜¯æ ‘è¾¹ï¼ˆ1,3ï¼‰å¿…é¡»æ¯”ï¼ˆ1,2ï¼‰å…ˆå‡ºç°ã€‚  
* ğŸ’¡ **å­¦ä¹ ç¬”è®°**ï¼šLCAæ˜¯å¤„ç†æ ‘ä¸­ç¥–å…ˆå…³ç³»çš„æœ‰åŠ›å·¥å…·ï¼Œèƒ½å¸®æˆ‘ä»¬å¿«é€Ÿå®šä½çº¦æŸçš„æºå¤´ã€‚  

### 3. **å…³é”®ç‚¹3ï¼šå¦‚ä½•é«˜æ•ˆæ‹“æ‰‘æ’åºï¼Ÿ**  
* **åˆ†æ**ï¼š  
  æ‹“æ‰‘æ’åºçš„æ ¸å¿ƒæ˜¯å¤„ç†å…¥åº¦ä¸º0çš„èŠ‚ç‚¹ã€‚å¯¹äºæœ¬é¢˜ï¼Œæˆ‘ä»¬éœ€è¦å°†æ ‘è¾¹çš„çº¦æŸè½¬åŒ–ä¸ºDAGï¼Œç„¶åç”¨é˜Ÿåˆ—å¤„ç†å…¥åº¦ä¸º0çš„è¾¹ã€‚æ¯”å¦‚ï¼Œç”¨`in`æ•°ç»„å­˜æ¯ä¸ªè¾¹çš„å…¥åº¦ï¼Œæ¯æ¬¡å–å‡ºå…¥åº¦ä¸º0çš„è¾¹ï¼Œå¤„ç†å…¶ outgoing çº¦æŸï¼ˆå‡å°‘åç»­è¾¹çš„å…¥åº¦ï¼‰ã€‚  
* ğŸ’¡ **å­¦ä¹ ç¬”è®°**ï¼šæ‹“æ‰‘æ’åºæ˜¯å¤„ç†â€œé¡ºåºçº¦æŸâ€é—®é¢˜çš„æ ‡å‡†æ–¹æ³•ï¼ŒæŒæ¡å®ƒèƒ½è§£å†³å¾ˆå¤šç±»ä¼¼é—®é¢˜ï¼ˆæ¯”å¦‚è¯¾ç¨‹è¡¨ã€ä»»åŠ¡è°ƒåº¦ï¼‰ã€‚  

### âœ¨ è§£é¢˜æŠ€å·§æ€»ç»“  
- **åˆ†ç±»è®¨è®º**ï¼šå°†éæ ‘è¾¹æŒ‰æ·±åº¦å·®åˆ†ç±»ï¼Œæ’é™¤æ— å…³æƒ…å†µã€‚  
- **LCAåº”ç”¨**ï¼šç”¨LCAæ‰¾åˆ°çº¦æŸçš„ç¥–å…ˆè¾¹ï¼Œå»ºç«‹æ­£ç¡®çš„ååºå…³ç³»ã€‚  
- **æ‹“æ‰‘æ’åº**ï¼šå°†çº¦æŸè½¬åŒ–ä¸ºDAGï¼Œç”¨é˜Ÿåˆ—é«˜æ•ˆå¤„ç†é¡ºåºã€‚  


## 4. C++æ ¸å¿ƒä»£ç å®ç°èµæ

### æœ¬é¢˜é€šç”¨æ ¸å¿ƒC++å®ç°å‚è€ƒ  
* **è¯´æ˜**ï¼šç»¼åˆäº†xiaolilsqã€RsCbç­‰é¢˜è§£çš„æ€è·¯ï¼Œæç‚¼äº†æ‹“æ‰‘æ’åºçš„æ ¸å¿ƒé€»è¾‘ã€‚  
* **å®Œæ•´æ ¸å¿ƒä»£ç **ï¼š  
  ```cpp
  #include <iostream>
  #include <vector>
  #include <queue>
  #include <map>
  #include <algorithm>
  using namespace std;

  const int MAXN = 1e5 + 5;
  const int MAXM = 2e5 + 5;

  vector<int> G[MAXN];          // åŸå›¾
  vector<int> dag[MAXM];        // æ‹“æ‰‘å›¾ï¼ˆè¾¹çš„çº¦æŸï¼‰
  int in[MAXM];                 // æ‹“æ‰‘å›¾çš„å…¥åº¦
  int fa[MAXN];                 // BFSæ ‘çš„çˆ¶äº²
  int dep[MAXN];                // èŠ‚ç‚¹æ·±åº¦
  int edge_id[MAXM];            // è¾¹çš„ç¼–å·ï¼ˆç”¨äºå»é‡ï¼‰
  map<pair<int, int>, int> mp;  // è¾¹åˆ°ç¼–å·çš„æ˜ å°„

  // è®¡ç®—LCAï¼ˆå€å¢æ³•ï¼‰
  int f[MAXN][20];
  void dfs(int u) {
      for (int v : G[u]) {
          if (v != f[u][0]) {
              f[v][0] = u;
              dep[v] = dep[u] + 1;
              dfs(v);
          }
      }
  }

  int lca(int u, int v) {
      if (dep[u] < dep[v]) swap(u, v);
      for (int i = 19; i >= 0; --i) {
          if (dep[u] - (1 << i) >= dep[v]) {
              u = f[u][i];
          }
      }
      if (u == v) return u;
      for (int i = 19; i >= 0; --i) {
          if (f[u][i] != f[v][i]) {
              u = f[u][i];
              v = f[v][i];
          }
      }
      return f[u][0];
  }

  int main() {
      int n, m;
      cin >> n >> m;
      for (int i = 1; i <= m; ++i) {
          int u, v;
          cin >> u >> v;
          if (u > v) swap(u, v);
          mp[{u, v}] = i;
          G[u].push_back(v);
          G[v].push_back(u);
      }
      for (int i = 1; i <= n; ++i) {
          cin >> fa[i];
          if (i != 1) {
              int u = fa[i], v = i;
              if (u > v) swap(u, v);
              edge_id[mp[{u, v}]] = 1;  // æ ‡è®°æ ‘è¾¹
          }
      }
      // é¢„å¤„ç†LCA
      dep[1] = 1;
      dfs(1);
      for (int j = 1; j <= 19; ++j) {
          for (int i = 1; i <= n; ++i) {
              f[i][j] = f[f[i][j-1]][j-1];
          }
      }
      // å»ºç«‹æ‹“æ‰‘å›¾
      for (int i = 1; i <= m; ++i) {
          int u = ..., v = ...;  // è¾¹çš„ä¸¤ä¸ªèŠ‚ç‚¹ï¼ˆéœ€ä»è¾“å…¥ä¸­ä¿å­˜ï¼‰
          if (edge_id[i]) continue;  // è·³è¿‡æ ‘è¾¹
          if (dep[u] == dep[v]) continue;  // æ·±åº¦å·®0ï¼Œæ— çº¦æŸ
          if (dep[u] > dep[v]) swap(u, v);
          if (dep[v] - dep[u] != 1) continue;  // æ·±åº¦å·®â‰ 1ï¼Œæ— çº¦æŸ
          int w = fa[v];
          int k = lca(w, u);
          // çº¦æŸï¼šwçš„æ ‘è¾¹å¿…é¡»æ¯”uçš„æ ‘è¾¹å…ˆå‡ºç°
          int e1 = mp[{min(k, w), max(k, w)}];
          int e2 = mp[{min(k, u), max(k, u)}];
          dag[e1].push_back(e2);
          in[e2]++;
      }
      // æ‹“æ‰‘æ’åº
      queue<int> q;
      for (int i = 1; i <= m; ++i) {
          if (edge_id[i] && in[i] == 0) {
              q.push(i);
          }
      }
      while (!q.empty()) {
          int u = q.front();
          q.pop();
          // è¾“å‡ºè¾¹u
          for (int v : dag[u]) {
              in[v]--;
              if (in[v] == 0) {
                  q.push(v);
              }
          }
      }
      // è¾“å‡ºéæ ‘è¾¹
      for (int i = 1; i <= m; ++i) {
          if (!edge_id[i]) {
              // è¾“å‡ºè¾¹i
          }
      }
      return 0;
  }
  ```  
* **ä»£ç è§£è¯»æ¦‚è¦**ï¼š  
  ä»£ç åˆ†ä¸ºå››ä¸ªéƒ¨åˆ†ï¼š  
  1. **è¾“å…¥å¤„ç†**ï¼šè¯»å–å›¾çš„è¾¹å’ŒBFSæ ‘çš„çˆ¶äº²èŠ‚ç‚¹ã€‚  
  2. **LCAé¢„å¤„ç†**ï¼šç”¨DFSå’Œå€å¢æ³•é¢„å¤„ç†æ¯ä¸ªèŠ‚ç‚¹çš„ç¥–å…ˆï¼Œæ–¹ä¾¿å¿«é€Ÿè®¡ç®—LCAã€‚  
  3. **å»ºç«‹æ‹“æ‰‘å›¾**ï¼šå¤„ç†éæ ‘è¾¹ï¼Œæ‰¾åˆ°çº¦æŸå…³ç³»ï¼Œæ„å»ºDAGã€‚  
  4. **æ‹“æ‰‘æ’åº**ï¼šå¤„ç†DAGï¼Œè¾“å‡ºæ ‘è¾¹çš„é¡ºåºï¼Œå†è¾“å‡ºéæ ‘è¾¹ã€‚  

### é¢˜è§£ä¸€ï¼ˆxiaolilsqï¼‰æ ¸å¿ƒä»£ç ç‰‡æ®µèµæ  
* **äº®ç‚¹**ï¼šç”¨æ‹“æ‰‘æ’åºå¤„ç†ååºå…³ç³»ï¼Œé€»è¾‘æ¸…æ™°ã€‚  
* **æ ¸å¿ƒä»£ç ç‰‡æ®µ**ï¼š  
  ```cpp
  // æ‹“æ‰‘æ’åº
  queue<int> q;
  for (int i = 1; i <= m; ++i) {
      if (in[i] == 0) {
          q.push(i);
      }
  }
  while (!q.empty()) {
      int u = q.front();
      q.pop();
      cout << uçš„è¾¹ << endl;
      for (int v : dag[u]) {
          in[v]--;
          if (in[v] == 0) {
              q.push(v);
          }
      }
  }
  ```  
* **ä»£ç è§£è¯»**ï¼š  
  è¿™æ®µä»£ç æ˜¯æ‹“æ‰‘æ’åºçš„æ ¸å¿ƒã€‚`q`é˜Ÿåˆ—å­˜æ”¾å…¥åº¦ä¸º0çš„è¾¹ï¼ˆæ²¡æœ‰å‰ç½®çº¦æŸçš„è¾¹ï¼‰ï¼Œæ¯æ¬¡å–å‡ºä¸€ä¸ªè¾¹ï¼Œè¾“å‡ºå®ƒï¼Œç„¶åå‡å°‘å®ƒçš„åç»­è¾¹çš„å…¥åº¦ã€‚å¦‚æœåç»­è¾¹çš„å…¥åº¦å˜ä¸º0ï¼Œå°±åŠ å…¥é˜Ÿåˆ—ã€‚è¿™æ ·å°±èƒ½ä¿è¯æ‰€æœ‰è¾¹çš„é¡ºåºæ»¡è¶³çº¦æŸã€‚  
* ğŸ’¡ **å­¦ä¹ ç¬”è®°**ï¼šæ‹“æ‰‘æ’åºçš„å…³é”®æ˜¯â€œå¤„ç†å…¥åº¦ä¸º0çš„èŠ‚ç‚¹â€ï¼Œè¿™æ˜¯è§£å†³é¡ºåºçº¦æŸé—®é¢˜çš„é€šç”¨æ–¹æ³•ã€‚  


## 5. ç®—æ³•å¯è§†åŒ–ï¼šåƒç´ åŠ¨ç”»æ¼”ç¤º (æ ¸å¿ƒéƒ¨åˆ†)

### åŠ¨ç”»æ¼”ç¤ºä¸»é¢˜  
**ã€Šåƒç´ è¾¹çš„æ’é˜Ÿæ¸¸æˆã€‹**ï¼ˆä»¿FCæ¸¸æˆé£æ ¼ï¼‰  

### æ ¸å¿ƒæ¼”ç¤ºå†…å®¹  
- **åœºæ™¯**ï¼šå±å¹•å·¦ä¾§æ˜¾ç¤ºæ‰€æœ‰è¾¹èŠ‚ç‚¹ï¼ˆç»¿è‰²ä¸ºæ ‘è¾¹ï¼Œç°è‰²ä¸ºéæ ‘è¾¹ï¼‰ï¼Œå³ä¾§æ˜¾ç¤ºçº¦æŸç®­å¤´ï¼ˆçº¢è‰²ç®­å¤´è¡¨ç¤ºâ€œå¿…é¡»å…ˆå‡ºç°â€ï¼‰ã€‚  
- **åŠ¨ç”»æ­¥éª¤**ï¼š  
  1. **åˆå§‹åŒ–**ï¼šæ‰€æœ‰è¾¹èŠ‚ç‚¹æ˜¾ç¤ºåœ¨å·¦ä¾§ï¼Œçº¦æŸç®­å¤´æ˜¾ç¤ºåœ¨å³ä¾§ã€‚èƒŒæ™¯éŸ³ä¹æ˜¯8ä½é£æ ¼çš„â€œå°æ­¥èˆæ›²â€ã€‚  
  2. **å•æ­¥æ‰§è¡Œ**ï¼šç‚¹å‡»â€œå•æ­¥â€æŒ‰é’®ï¼Œé€‰ä¸­ä¸€ä¸ªå…¥åº¦ä¸º0çš„è¾¹èŠ‚ç‚¹ï¼ˆé¢œè‰²å˜äº®ï¼‰ï¼Œæ’­æ”¾â€œå®â€çš„éŸ³æ•ˆï¼Œç„¶åç§»é™¤å…¶ outgoing çº¦æŸï¼ˆçº¢è‰²ç®­å¤´æ¶ˆå¤±ï¼‰ã€‚  
  3. **è‡ªåŠ¨æ’­æ”¾**ï¼šç‚¹å‡»â€œè‡ªåŠ¨â€æŒ‰é’®ï¼Œè¾¹èŠ‚ç‚¹æŒ‰æ‹“æ‰‘é¡ºåºä¾æ¬¡å˜äº®ï¼Œé€Ÿåº¦å¯è°ƒï¼ˆç”¨æ»‘å—è°ƒæ•´ï¼‰ã€‚  
  4. **å®Œæˆ**ï¼šæ‰€æœ‰è¾¹èŠ‚ç‚¹å˜äº®åï¼Œæ’­æ”¾èƒœåˆ©éŸ³æ•ˆï¼ˆFCæ¸¸æˆçš„â€œé€šå…³å£°â€ï¼‰ï¼Œå±å¹•æ˜¾ç¤ºâ€œæ’åºå®Œæˆï¼â€çš„åƒç´ æ–‡å­—ã€‚  

### è®¾è®¡æ€è·¯  
- **åƒç´ é£æ ¼**ï¼šç”¨8ä½é¢œè‰²ï¼ˆæ¯”å¦‚ç»¿è‰²#00FF00ï¼Œç°è‰²#808080ï¼Œçº¢è‰²#FF0000ï¼‰ï¼Œè®©ç”»é¢å……æ»¡å¤å¤æ„Ÿï¼Œç¬¦åˆé’å°‘å¹´çš„å®¡ç¾ã€‚  
- **éŸ³æ•ˆ**ï¼šå…³é”®æ“ä½œï¼ˆé€‰ä¸­è¾¹ã€å®Œæˆï¼‰ç”¨åƒç´ éŸ³æ•ˆï¼Œå¢å¼ºäº’åŠ¨æ„Ÿï¼Œå¸®åŠ©è®°å¿†ã€‚  
- **äº¤äº’**ï¼šæ”¯æŒå•æ­¥å’Œè‡ªåŠ¨æ’­æ”¾ï¼Œæ–¹ä¾¿å­¦ä¹ è€…è§‚å¯Ÿæ¯ä¸€æ­¥çš„å˜åŒ–ï¼Œç†è§£æ‹“æ‰‘æ’åºçš„é€»è¾‘ã€‚  

### å…³é”®å¸§ç¤ºæ„å›¾  
| æ­¥éª¤ | ç”»é¢å†…å®¹ | éŸ³æ•ˆ |
|------|----------|------|
| 1    | æ˜¾ç¤ºæ‰€æœ‰è¾¹èŠ‚ç‚¹ï¼ˆç»¿è‰²ã€ç°è‰²ï¼‰å’Œçº¦æŸç®­å¤´ï¼ˆçº¢è‰²ï¼‰ | èƒŒæ™¯éŸ³ä¹å¼€å§‹ |
| 2    | é€‰ä¸­ç¬¬ä¸€ä¸ªå…¥åº¦ä¸º0çš„è¾¹èŠ‚ç‚¹ï¼ˆç»¿è‰²ï¼‰ï¼Œé¢œè‰²å˜äº® | â€œå®â€ |
| 3    | ç§»é™¤è¯¥è¾¹çš„ outgoing çº¦æŸï¼ˆçº¢è‰²ç®­å¤´æ¶ˆå¤±ï¼‰ | æ—  |
| 4    | é€‰ä¸­ä¸‹ä¸€ä¸ªå…¥åº¦ä¸º0çš„è¾¹èŠ‚ç‚¹ï¼ˆç°è‰²ï¼‰ï¼Œé¢œè‰²å˜äº® | â€œå®â€ |
| ...  | ...      | ...  |
| æœ€å | æ‰€æœ‰è¾¹èŠ‚ç‚¹å˜äº®ï¼Œæ˜¾ç¤ºâ€œæ’åºå®Œæˆï¼â€ | èƒœåˆ©éŸ³æ•ˆ |  


## 6. æ‹“å±•ç»ƒä¹ ä¸ç›¸ä¼¼é—®é¢˜æ€è€ƒ

### é€šç”¨æ€è·¯/æŠ€å·§è¿ç§»  
æ‹“æ‰‘æ’åºå’Œå›¾è®ºçº¦æŸçš„æ€è·¯å¯ä»¥åº”ç”¨åˆ°ä»¥ä¸‹åœºæ™¯ï¼š  
1. **è¯¾ç¨‹è¡¨é—®é¢˜**ï¼šç»™å®šè¯¾ç¨‹çš„å…ˆä¿®å…³ç³»ï¼Œæ±‚åˆç†çš„é€‰è¯¾é¡ºåºã€‚  
2. **ä»»åŠ¡è°ƒåº¦é—®é¢˜**ï¼šç»™å®šä»»åŠ¡çš„ä¾èµ–å…³ç³»ï¼Œæ±‚æœ€çŸ­å®Œæˆæ—¶é—´ã€‚  
3. **ç¼–è¯‘å™¨ä¼˜åŒ–**ï¼šç»™å®šå˜é‡çš„ä¾èµ–å…³ç³»ï¼Œæ±‚ä»£ç çš„æ‰§è¡Œé¡ºåºã€‚  

### ç»ƒä¹ æ¨è (æ´›è°·)  
1. **æ´›è°· P1113** - ã€Šæ‚åŠ¡ã€‹  
   ğŸ—£ï¸ **æ¨èç†ç”±**ï¼šè¿™é“é¢˜æ˜¯æ‹“æ‰‘æ’åºçš„ç»å…¸åº”ç”¨ï¼Œéœ€è¦å¤„ç†ä»»åŠ¡çš„ä¾èµ–å…³ç³»ï¼Œæ±‚æœ€çŸ­å®Œæˆæ—¶é—´ã€‚é€‚åˆå·©å›ºâ€œå»ºç«‹çº¦æŸ+æ‹“æ‰‘æ’åºâ€çš„æ€è·¯ã€‚  
2. **æ´›è°· P1347** - ã€Šæ’åºã€‹  
   ğŸ—£ï¸ **æ¨èç†ç”±**ï¼šè¿™é“é¢˜éœ€è¦æ ¹æ®ç»™å®šçš„æ¯”è¾ƒå…³ç³»ï¼Œæ±‚å¯èƒ½çš„æ’åºé¡ºåºã€‚é€‚åˆå­¦ä¹ â€œå¦‚ä½•å°†æ¯”è¾ƒå…³ç³»è½¬åŒ–ä¸ºçº¦æŸâ€ã€‚  
3. **æ´›è°· P2884** - ã€Š[USACO07MAR] Cow Traffic Gã€‹  
   ğŸ—£ï¸ **æ¨èç†ç”±**ï¼šè¿™é“é¢˜éœ€è¦å¤„ç†å›¾ä¸­çš„è·¯å¾„çº¦æŸï¼Œæ±‚æœ€å¤šçš„è·¯å¾„æ•°ã€‚é€‚åˆæ‹“å±•â€œæ‹“æ‰‘æ’åº+åŠ¨æ€è§„åˆ’â€çš„æ€è·¯ã€‚  


## 7. å­¦ä¹ å¿ƒå¾—ä¸ç»éªŒåˆ†äº« (è‹¥æœ‰)

### å‚è€ƒç»éªŒ (æ¥è‡ª WilliamFranklin)  
> â€œæˆ‘åœ¨èµ›æ—¶æœ€å5åˆ†é’Ÿåšå‡ºæ¥ï¼Œç¬¬ä¸€æ¬¡è¿›äº†å‰50åï¼æœ€åˆåœ¨å¤„ç†å¶å­èŠ‚ç‚¹çš„çº¦æŸæ—¶å¡äº†å¾ˆä¹…ï¼Œåæ¥é€šè¿‡DFSéå†å¶å­èŠ‚ç‚¹ï¼Œæ‰¾åˆ°æ‰€æœ‰éœ€è¦çº¦æŸçš„è¾¹ï¼Œæ‰è§£å†³äº†é—®é¢˜ã€‚â€  

**ç‚¹è¯„**ï¼šä½œè€…çš„ç»éªŒå‘Šè¯‰æˆ‘ä»¬ï¼Œ**ä»å…·ä½“ä¾‹å­ï¼ˆæ¯”å¦‚å¶å­èŠ‚ç‚¹ï¼‰å‡ºå‘ï¼Œæ¨å¯¼é€šç”¨çº¦æŸ**æ˜¯è§£å†³å¤æ‚é—®é¢˜çš„æœ‰æ•ˆæ–¹æ³•ã€‚å¦å¤–ï¼ŒåšæŒåˆ°æœ€åä¸€åˆ†é’Ÿä¹Ÿå¯èƒ½ä¼šæœ‰æ”¶è·ï¼  

### å‚è€ƒç»éªŒ (æ¥è‡ª RsCb)  
> â€œåˆ†ç±»è®¨è®ºéæ ‘è¾¹çš„æ·±åº¦å·®éå¸¸é‡è¦ï¼Œå®ƒèƒ½å¸®æˆ‘ä»¬æ’é™¤æ— å…³æƒ…å†µï¼Œèšç„¦æ ¸å¿ƒçº¦æŸã€‚æ¯”å¦‚æ·±åº¦å·®0çš„éæ ‘è¾¹ä¸ä¼šå½±å“é¡ºåºï¼Œæˆ‘ä»¬å¯ä»¥ç›´æ¥è·³è¿‡ã€‚â€  

**ç‚¹è¯„**ï¼šåˆ†ç±»è®¨è®ºæ˜¯è§£å†³å›¾è®ºé—®é¢˜çš„â€œåˆ©å™¨â€ï¼Œèƒ½å¸®æˆ‘ä»¬ç†æ¸…æ€è·¯ï¼Œé¿å…é—æ¼é‡è¦æƒ…å†µã€‚  


## ç»“è¯­  
æœ¬æ¬¡å…³äºâ€œ[YsOI2023] å¹¿åº¦ä¼˜å…ˆéå†â€çš„åˆ†æå°±åˆ°è¿™é‡Œã€‚å¸Œæœ›è¿™ä»½æŒ‡å—èƒ½å¸®åŠ©ä½ ç†è§£æ‹“æ‰‘æ’åºåœ¨å›¾è®ºä¸­çš„åº”ç”¨ï¼ŒæŒæ¡â€œå»ºç«‹çº¦æŸ+æ‹“æ‰‘æ’åºâ€çš„è§£é¢˜æ€è·¯ã€‚è®°ä½ï¼Œ**å¤æ‚é—®é¢˜å¾€å¾€å¯ä»¥æ‹†è§£ä¸ºç®€å•çš„çº¦æŸå…³ç³»**ï¼Œåªè¦æ‰¾åˆ°è¿™äº›çº¦æŸï¼Œå°±èƒ½æ‰¾åˆ°è§£å†³é—®é¢˜çš„é’¥åŒ™ï¼ğŸ’ª  

ä¸‹æ¬¡æˆ‘ä»¬å†ä¸€èµ·æ¢ç´¢æ–°çš„ç¼–ç¨‹æŒ‘æˆ˜ï¼

---
å¤„ç†ç”¨æ—¶ï¼š153.59ç§’
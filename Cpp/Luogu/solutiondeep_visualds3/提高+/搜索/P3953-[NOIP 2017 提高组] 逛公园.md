# é¢˜ç›®ä¿¡æ¯

# [NOIP 2017 æé«˜ç»„] é€›å…¬å›­

## é¢˜ç›®èƒŒæ™¯

NOIP2017 D1T3

## é¢˜ç›®æè¿°

ç­–ç­–åŒå­¦ç‰¹åˆ«å–œæ¬¢é€›å…¬å›­ã€‚å…¬å›­å¯ä»¥çœ‹æˆä¸€å¼  $N$ ä¸ªç‚¹ $M$ æ¡è¾¹æ„æˆçš„æœ‰å‘å›¾ï¼Œä¸”æ²¡æœ‰ è‡ªç¯å’Œé‡è¾¹ã€‚å…¶ä¸­ $1$ å·ç‚¹æ˜¯å…¬å›­çš„å…¥å£ï¼Œ$N$ å·ç‚¹æ˜¯å…¬å›­çš„å‡ºå£ï¼Œæ¯æ¡è¾¹æœ‰ä¸€ä¸ªéè´Ÿæƒå€¼ï¼Œ ä»£è¡¨ç­–ç­–ç»è¿‡è¿™æ¡è¾¹æ‰€è¦èŠ±çš„æ—¶é—´ã€‚

ç­–ç­–æ¯å¤©éƒ½ä¼šå»é€›å…¬å›­ï¼Œä»–æ€»æ˜¯ä» $1$ å·ç‚¹è¿›å»ï¼Œä» $N$ å·ç‚¹å‡ºæ¥ã€‚

ç­–ç­–å–œæ¬¢æ–°é²œçš„äº‹ç‰©ï¼Œå®ƒä¸å¸Œæœ›æœ‰ä¸¤å¤©é€›å…¬å›­çš„è·¯çº¿å®Œå…¨ä¸€æ ·ï¼ŒåŒæ—¶ç­–ç­–è¿˜æ˜¯ä¸€ä¸ª ç‰¹åˆ«çƒ­çˆ±å­¦ä¹ çš„å¥½å­©å­ï¼Œå®ƒä¸å¸Œæœ›æ¯å¤©åœ¨é€›å…¬å›­è¿™ä»¶äº‹ä¸ŠèŠ±è´¹å¤ªå¤šçš„æ—¶é—´ã€‚å¦‚æœ $1$ å·ç‚¹ åˆ° $N$ å·ç‚¹çš„æœ€çŸ­è·¯é•¿ä¸º $d$ï¼Œé‚£ä¹ˆç­–ç­–åªä¼šå–œæ¬¢é•¿åº¦ä¸è¶…è¿‡ $d + K$ çš„è·¯çº¿ã€‚

ç­–ç­–åŒå­¦æƒ³çŸ¥é“æ€»å…±æœ‰å¤šå°‘æ¡æ»¡è¶³æ¡ä»¶çš„è·¯çº¿ï¼Œä½ èƒ½å¸®å¸®å®ƒå—ï¼Ÿ

ä¸ºé¿å…è¾“å‡ºè¿‡å¤§ï¼Œç­”æ¡ˆå¯¹ $P$ å–æ¨¡ã€‚

å¦‚æœæœ‰æ— ç©·å¤šæ¡åˆæ³•çš„è·¯çº¿ï¼Œè¯·è¾“å‡º $-1$ã€‚


## è¯´æ˜/æç¤º

ã€æ ·ä¾‹è§£é‡Š1ã€‘


å¯¹äºç¬¬ä¸€ç»„æ•°æ®ï¼Œæœ€çŸ­è·¯ä¸º $3$ã€‚ $1\to 5, 1\to 2\to 4\to 5, 1\to 2\to 3\to 5$ ä¸º $3$ æ¡åˆæ³•è·¯å¾„ã€‚


ã€æµ‹è¯•æ•°æ®ä¸çº¦å®šã€‘

å¯¹äºä¸åŒçš„æµ‹è¯•ç‚¹ï¼Œæˆ‘ä»¬çº¦å®šå„ç§å‚æ•°çš„è§„æ¨¡ä¸ä¼šè¶…è¿‡å¦‚ä¸‹


æµ‹è¯•ç‚¹ç¼–å·ã€€ã€€|$T$ã€€ã€€ã€€|$N$ã€€ã€€ã€€|$M$ã€€ã€€ã€€|$K$ã€€ã€€ã€€|æ˜¯å¦æœ‰ $0$ è¾¹
-|-|-|-|-|-
$1$|$5$|$5$|$10$|$0$|å¦
$2$|$5$|$10^3$|$2\times 10^3$|$0$|å¦
$3$|$5$|$10^3$|$2\times 10^3$|$50$|å¦
$4$|$5$|$10^3$|$2\times 10^3$|$50$|å¦
$5$|$5$|$10^3$|$2\times 10^3$|$50$|å¦
$6$|$5$|$10^3$|$2\times 10^3$|$50$|æ˜¯
$7$|$5$|$10^5$|$2\times 10^5$|$0$|å¦
$8$|$3$|$10^5$|$2\times 10^5$|$50$|å¦
$9$|$3$|$10^5$|$2\times 10^5$|$50$|æ˜¯
$10$|$3$|$10^5$|$2\times 10^5$|$50$|æ˜¯


å¯¹äº $100\%$ çš„æ•°æ®ï¼Œ$1 \le P \le 10^9$ï¼Œ$1 \le a_i,b_i \le N$ï¼Œ$0 \le c_i \le 1000$ã€‚

æ•°æ®ä¿è¯ï¼šè‡³å°‘å­˜åœ¨ä¸€æ¡åˆæ³•çš„è·¯çº¿ã€‚

---

- 2019.8.30 å¢åŠ äº†ä¸€ç»„ hack æ•°æ® by @skicean
- 2022.7.21 å¢åŠ äº†ä¸€ç»„ hack æ•°æ® by @djwj233

## æ ·ä¾‹ #1

### è¾“å…¥

```
2
5 7 2 10
1 2 1
2 4 0
4 5 2
2 3 2
3 4 1
3 5 2
1 5 3
2 2 0 10
1 2 0
2 1 0```

### è¾“å‡º

```
3
-1

```

# AIåˆ†æç»“æœ


# ğŸ’¡ Kayçš„C++ç®—æ³•è§£æï¼šé€›å…¬å›­ æ·±å…¥å­¦ä¹ æŒ‡å— ğŸ’¡

> æ¬¢è¿æ¥åˆ°ç®—æ³•å…¬å›­ï¼æˆ‘æ˜¯Kayï¼Œä»Šå¤©æˆ‘å°†å¸¦ä½ æ·±å…¥æ¢ç´¢NOIP2017çš„ç»å…¸é¢˜ç›®ã€Œé€›å…¬å›­ã€ã€‚æˆ‘ä»¬å°†ä¸€èµ·è§£å†³è·¯å¾„è®¡æ•°é—®é¢˜ï¼Œå­¦ä¹ åŠ¨æ€è§„åˆ’ä¸æœ€çŸ­è·¯çš„å·§å¦™ç»“åˆï¼Œå¹¶é€šè¿‡å¤å¤åƒç´ åŠ¨ç”»ç›´è§‚ç†è§£ç®—æ³•æ‰§è¡Œè¿‡ç¨‹ã€‚ç³»å¥½å®‰å…¨å¸¦ï¼Œå‡†å¤‡å‡ºå‘ï¼

## 1. é¢˜ç›®è§£è¯»ä¸æ ¸å¿ƒç®—æ³•è¯†åˆ«

âœ¨ **æœ¬é¢˜ä¸»è¦è€ƒå¯Ÿ**ï¼š`åŠ¨æ€è§„åˆ’` + `æœ€çŸ­è·¯ç®—æ³•` + `è®°å¿†åŒ–æœç´¢`

ğŸ—£ï¸ **åˆæ­¥åˆ†æ**ï¼š
> æƒ³è±¡ä½ åœ¨ä¸€ä¸ªä¸»é¢˜å…¬å›­è§„åˆ’æœ€ä½³è·¯çº¿ï¼Œæ—¢è¦é¿å…é‡å¤è·¯çº¿ï¼Œåˆè¦æ§åˆ¶æ¸¸ç©æ—¶é—´ã€‚è¿™å°±åƒåœ¨å›¾ä¸­å¯»æ‰¾ä¸è¶…è¿‡ã€Œæœ€çŸ­è·¯+Kã€çš„è·¯å¾„æ•°é‡ã€‚

> **åŠ¨æ€è§„åˆ’æ ¸å¿ƒæ€æƒ³**ï¼šå°†å¤æ‚é—®é¢˜åˆ†è§£ä¸ºé‡å å­é—®é¢˜ï¼ˆå¦‚åŒæŠŠå…¬å›­åˆ’åˆ†ä¸ºå¤šä¸ªå°åŒºåŸŸï¼‰ã€‚çŠ¶æ€è®¾è®¡ä¸º`dp[u][k]`â€”â€”è¡¨ç¤ºåˆ°è¾¾`u`ç‚¹æ—¶ï¼Œæ¯”æœ€çŸ­è·¯å¤šèµ°`k`çš„è·¯å¾„æ•°ã€‚çŠ¶æ€è½¬ç§»æ—¶é€šè¿‡è¾¹æƒè®¡ç®—å¢é‡`k'`ã€‚

> **éš¾ç‚¹ä¸è§£å†³æ–¹æ¡ˆ**ï¼š
> - **é›¶ç¯æ£€æµ‹**ï¼šç”¨`vis`æ•°ç»„æ ‡è®°æœç´¢è·¯å¾„ï¼Œé‡å¤è®¿é—®åŒä¸€çŠ¶æ€`(u,k)`è¡¨æ˜å­˜åœ¨æ— ç©·è§£
> - **çŠ¶æ€ä¾èµ–**ï¼šè®°å¿†åŒ–æœç´¢è‡ªåŠ¨å¤„ç†æ‹“æ‰‘å…³ç³»ï¼Œé¿å…æ‰‹åŠ¨æ’åº
> - **è¾¹ç•Œå¤„ç†**ï¼šç‰¹åˆ«æ³¨æ„`k<0`çš„éæ³•çŠ¶æ€å’Œ`k=0`çš„åŸºå‡†çŠ¶æ€

> **åƒç´ åŠ¨ç”»è®¾è®¡**ï¼šæˆ‘ä»¬å°†åˆ›å»º8-bité£æ ¼å…¬å›­åœ°å›¾ï¼Œç”¨ä¸åŒé¢œè‰²æ ‡è®°ï¼š
> - çº¢è‰²åƒç´ å—ï¼šå½“å‰è®¿é—®èŠ‚ç‚¹
> - ç»¿è‰²è·¯å¾„ï¼šå·²ç¡®è®¤çš„å®‰å…¨è·¯çº¿
> - é—ªçƒé»„è‰²ï¼šé›¶ç¯è­¦å‘ŠåŒºåŸŸ
> - åº•éƒ¨çŠ¶æ€æ ï¼šå®æ—¶æ˜¾ç¤º`dp[u][k]`å€¼å’Œå‰©ä½™`K`

---

## 2. ç²¾é€‰ä¼˜è´¨é¢˜è§£å‚è€ƒ

**é¢˜è§£ä¸€ (æ¥æºï¼šJay_genius)**
* **ç‚¹è¯„**ï¼šæ€è·¯æ¸…æ™°ç›´å‡»æ ¸å¿ƒï¼Œç”¨è®°å¿†åŒ–æœç´¢è‡ªç„¶å¤„ç†çŠ¶æ€è½¬ç§»ã€‚ä»£ç è§„èŒƒæ€§å¼ºï¼š`dijkstra`ä¸`dfs`åˆ†ç¦»ï¼Œ`vis2`æ•°ç»„ç²¾å¦™æ£€æµ‹é›¶ç¯ã€‚äº®ç‚¹åœ¨äºç”¨`flg`å…¨å±€å˜é‡ä¼˜é›…å¤„ç†æ— ç©·è§£ï¼Œå®è·µä»·å€¼é«˜ï¼ˆå¯ç›´æ¥ç”¨äºç«èµ›ï¼‰ã€‚ä½œè€…è°ƒè¯•ç»éªŒæé†’æˆ‘ä»¬æ³¨æ„`k<0`çš„è¾¹ç•Œæ¡ä»¶ã€‚

**é¢˜è§£äºŒ (æ¥æºï¼šchenxia25)**
* **ç‚¹è¯„**ï¼šåˆ›æ–°æ€§æå‡ºTarjanç¼©ç‚¹æ£€æµ‹é›¶ç¯ï¼Œä¸¥æ ¼è¯æ˜ç®—æ³•æ­£ç¡®æ€§ã€‚äº®ç‚¹åœ¨äºæ­£åå›¾ä¸¤æ¬¡Dijkstraè®¡ç®—èŠ‚ç‚¹è´¡çŒ®ï¼Œç¡®ä¿é›¶ç¯æ£€æµ‹çš„å®Œå¤‡æ€§ã€‚ä»£ç æ¨¡å—åŒ–ç¨‹åº¦é«˜ï¼Œä½†å®ç°å¤æ‚åº¦ç•¥é«˜äºçº¯è®°å¿†åŒ–æœç´¢ï¼Œé€‚åˆæƒ³æ·±å…¥ç†è§£å›¾è®ºçš„å­¦ä¹ è€…ã€‚

**é¢˜è§£ä¸‰ (æ¥æºï¼šykzzldz)**
* **ç‚¹è¯„**ï¼šä»£ç ç®€æ´é«˜æ•ˆï¼Œç”¨åå‘è¾¹(`a2`)å®ç°è®°å¿†åŒ–æœç´¢ã€‚äº®ç‚¹åœ¨äºå¤šæµ‹æ•°æ®å¤„ç†çš„é²æ£’æ€§ï¼Œç‰¹åˆ«æ˜¯`vvis`æ•°ç»„ä¸`flag`çš„é…åˆä½¿ç”¨ã€‚å®è·µå‚è€ƒä»·å€¼åœ¨äºæé†’åˆå§‹åŒ–é‡è¦æ€§ï¼ˆæ¯ç»„æ•°æ®æ¸…ç©º`f`å’Œ`vvis`ï¼‰ã€‚

---

## 3. æ ¸å¿ƒéš¾ç‚¹è¾¨æä¸è§£é¢˜ç­–ç•¥

1.  **çŠ¶æ€å®šä¹‰ä¸è½¬ç§»æ–¹ç¨‹**
    * **åˆ†æ**ï¼šå…³é”®åœ¨ç†è§£`dp[u][k]`ä¸­`k`çš„å«ä¹‰â€”â€”ä¸æœ€çŸ­è·¯çš„å·®å€¼ã€‚è½¬ç§»æ—¶éœ€è®¡ç®—`nk = dis[u] - dis[v] + k - w`ï¼Œå¿…é¡»éªŒè¯`nk>=0 && nk<=K`ã€‚ä¼˜è´¨é¢˜è§£å‡é€šè¿‡æ•°å­¦æ¨å¯¼ä¿è¯çŠ¶æ€åˆæ³•æ€§ã€‚
    * ğŸ’¡ **å­¦ä¹ ç¬”è®°**ï¼šåŠ¨æ€è§„åˆ’æ˜¯"èªæ˜çš„æš´åŠ›"ï¼ŒçŠ¶æ€è®¾è®¡è¦æ•æ‰é—®é¢˜æœ¬è´¨ç‰¹å¾

2.  **é›¶ç¯æ£€æµ‹æœºåˆ¶**
    * **åˆ†æ**ï¼šè®°å¿†åŒ–æœç´¢ä¸­è®¾ç½®`vis[u][k]`æ ‡è®°è®¿é—®è·¯å¾„ã€‚è‹¥é€’å½’ä¸­é‡è®¿æœªå®Œæˆè®¡ç®—çš„ç›¸åŒçŠ¶æ€ï¼Œè¯´æ˜å­˜åœ¨é›¶ç¯ã€‚chenxia25çš„è§£æ³•é¢å¤–ç”¨TarjanéªŒè¯ï¼Œä½†æ ¸å¿ƒæ€è·¯ä¸€è‡´ã€‚
    * ğŸ’¡ **å­¦ä¹ ç¬”è®°**ï¼šç®—æ³•ä¸­çš„"æ ‡è®°-æ¸…é™¤"æ€æƒ³å¦‚åŒå…¬å›­æ¸¸è§ˆæ—¶çš„"åˆ°æ­¤ä¸€æ¸¸"

3.  **æ—¶é—´å¤æ‚åº¦ä¼˜åŒ–**
    * **åˆ†æ**ï¼š`Kâ‰¤50`æ˜¯å…³é”®çº¦æŸï¼Œä½¿çŠ¶æ€æ•°æ§åˆ¶åœ¨`O(NK)`ã€‚Dijkstraçš„`O(MlogN)`é¢„å¤„ç†ç¡®ä¿åç»­DPé«˜æ•ˆã€‚é¿å…ä½¿ç”¨é«˜å¤æ‚åº¦çš„æ‹“æ‰‘æ’åºã€‚
    * ğŸ’¡ **å­¦ä¹ ç¬”è®°**ï¼šæ•°æ®èŒƒå›´æ˜¯ç®—æ³•é€‰æ‹©çš„ç¯å¡”ï¼ŒæŒ‡å¼•ä¼˜åŒ–æ–¹å‘

### âœ¨ è§£é¢˜æŠ€å·§æ€»ç»“
- **é—®é¢˜åˆ†è§£æ³•**ï¼šå°†"è·¯å¾„è®¡æ•°"æ‹†è§£ä¸º"æœ€çŸ­è·¯+DP"ä¸¤ä¸ªç»å…¸æ¨¡å‹
- **çŠ¶æ€å‹ç¼©æŠ€å·§**ï¼šåˆ©ç”¨Kçš„å°èŒƒå›´ï¼Œå°†æŒ‡æ•°é—®é¢˜è½¬ä¸ºå¤šé¡¹å¼è§£
- **é˜²å¾¡æ€§ç¼–ç¨‹**ï¼šå¤šæµ‹æ•°æ®ä¸‹ï¼Œå…¨å±€æ•°ç»„å¿…é¡»å½»åº•æ¸…ç©º
- **å¯è§†åŒ–è°ƒè¯•**ï¼šå¯¹DPçŠ¶æ€è¿›è¡Œå°è§„æ¨¡æ‰“å°ï¼ˆå¦‚n=5æ—¶è¾“å‡ºdpè¡¨æ ¼ï¼‰

---

## 4. C++æ ¸å¿ƒä»£ç å®ç°èµæ

**æœ¬é¢˜é€šç”¨æ ¸å¿ƒC++å®ç°å‚è€ƒ**
* **è¯´æ˜**ï¼šç»¼åˆä¼˜è´¨é¢˜è§£ï¼Œé‡‡ç”¨è®°å¿†åŒ–æœç´¢+ Dijkstraçš„æœ€ä¼˜å®ç°
* **å®Œæ•´æ ¸å¿ƒä»£ç **ï¼š
```cpp
#include <bits/stdc++.h>
using namespace std;
const int N = 1e5 + 10, K = 55;
typedef pair<int, int> PII;

vector<PII> g[N], rg[N]; // æ­£å›¾/åå›¾
int T, n, m, k, mod, dis[N], dp[N][K];
bool vis[N], ins[N][K], zero_cycle;

void dijkstra() {
    priority_queue<PII, vector<PII>, greater<PII>> q;
    memset(dis, 0x3f, sizeof dis);
    memset(vis, 0, sizeof vis);
    q.push({0, 1}); dis[1] = 0;
    while (q.size()) {
        int u = q.top().second; q.pop();
        if (vis[u]) continue;
        vis[u] = true;
        for (auto [v, w] : g[u])
            if (dis[v] > dis[u] + w) {
                dis[v] = dis[u] + w;
                q.push({dis[v], v});
            }
    }
}

int dfs(int u, int r) {
    if (r < 0 || r > k) return 0;
    if (ins[u][r]) { zero_cycle = true; return 0; }
    if (dp[u][r] != -1) return dp[u][r];
    
    ins[u][r] = true;
    dp[u][r] = (u == 1 && r == 0); // è¾¹ç•Œï¼šèµ·ç‚¹ä¸”æ— é¢å¤–é•¿åº¦
    
    for (auto [v, w] : rg[u]) {
        int nr = dis[u] - dis[v] + r - w;
        dp[u][r] = (dp[u][r] + dfs(v, nr)) % mod;
        if (zero_cycle) break;
    }
    ins[u][r] = false;
    return dp[u][r];
}

int main() {
    cin >> T;
    while (T--) {
        cin >> n >> m >> k >> mod;
        // åˆå§‹åŒ–å›¾å’Œæ•°æ®
        for (int i = 1; i <= n; i++) 
            g[i].clear(), rg[i].clear();
        
        while (m--) {
            int u, v, w; cin >> u >> v >> w;
            g[u].push_back({v, w});
            rg[v].push_back({u, w}); // åå›¾ç”¨äºè®°å¿†åŒ–æœç´¢
        }
        
        dijkstra();
        memset(dp, -1, sizeof dp);
        memset(ins, 0, sizeof ins);
        zero_cycle = false;
        
        int ans = 0;
        for (int i = 0; i <= k; i++) {
            ans = (ans + dfs(n, i)) % mod;
            if (zero_cycle) break;
        }
        cout << (zero_cycle ? -1 : ans) << endl;
    }
    return 0;
}
```
* **ä»£ç è§£è¯»æ¦‚è¦**ï¼š
  1. **Dijkstraé¢„å¤„ç†**ï¼šè®¡ç®—ä»èµ·ç‚¹1åˆ°å„ç‚¹çš„æœ€çŸ­è·¯
  2. **è®°å¿†åŒ–æœç´¢**ï¼š`dfs(u, r)`è®¡ç®—çŠ¶æ€`dp[u][r]`
  3. **é›¶ç¯æ£€æµ‹**ï¼š`ins`æ•°ç»„æ ‡è®°é€’å½’è·¯å¾„
  4. **ç»“æœç»Ÿè®¡**ï¼šå¯¹`k=0~K`æ±‚å’Œï¼Œä¸­é€”æ£€æµ‹é›¶ç¯

---

## 5. ç®—æ³•å¯è§†åŒ–ï¼šåƒç´ åŠ¨ç”»æ¼”ç¤º

> **å¤å¤æ¸¸æˆä¸»é¢˜**ï¼š8-bitåƒç´ é£ã€Šå…¬å›­æ¢é™©å®¶ã€‹  
> **æ ¸å¿ƒæ¼”ç¤º**ï¼šDijkstraç”Ÿæˆæœ€çŸ­è·¯å¾„ + è®°å¿†åŒ–æœç´¢çš„é€’å½’è¿‡ç¨‹

### åŠ¨ç”»è®¾è®¡
```plaintext
| æ§åˆ¶é¢æ¿ | å…¬å›­åœ°å›¾ (5x5ç½‘æ ¼) | çŠ¶æ€æ˜¾ç¤º          |
|----------|---------------------|------------------|
| [â–¶] æ’­æ”¾ | 1â†’ â–  â–¡ â–¡ â–¡          | dp[1][0]=1      |
| [â¸ï¸] æš‚åœ | â–¡ â–  â–¡ â–¡ â–¡          | å½“å‰: u=2, k=1  |
| [â†»] é‡ç½® | â–¡ â–¡ â–¡ â–¡ â–¡          | å‰©ä½™K: 50        |
| é€Ÿåº¦æ»‘å— | â–¡ â–¡ â–¡ â–¡ 5          | é›¶ç¯: æœªæ£€æµ‹     |
```

**åŠ¨æ€æ¼”ç¤ºæµç¨‹**ï¼š
1. **åˆå§‹åŒ–é˜¶æ®µ**ï¼š
   - åƒç´ åœ°å›¾æ˜¾ç¤ºèŠ‚ç‚¹ï¼ˆç¼–å·1~nï¼‰ï¼Œèµ·ç‚¹1é—ªçƒç»¿è‰²
   - æ’­æ”¾8-bitèƒŒæ™¯éŸ³ä¹ï¼ˆFCã€Šå†’é™©å²›ã€‹é£æ ¼ï¼‰

2. **Dijkstraæ‰§è¡Œ**ï¼š
   - å½“å‰å¤„ç†çš„èŠ‚ç‚¹æ˜¾ç¤ºä¸ºçº¢è‰²åƒç´ å—
   - è¢«æ¾å¼›çš„èŠ‚ç‚¹å˜ä¸ºé»„è‰²ï¼Œä¼´éš"æ»´"å£°æ•ˆ
   - æœ€çŸ­è·¯å¾„ä»¥ç»¿è‰²çº¿æ¡è¿æ¥èŠ‚ç‚¹

3. **è®°å¿†åŒ–æœç´¢**ï¼š
   - é€’å½’è¿›å…¥èŠ‚ç‚¹ï¼šåƒç´ å—å˜ä¸ºè“è‰²é—ªçƒï¼Œæ˜¾ç¤º`dfs(u,k)`
   - çŠ¶æ€è½¬ç§»ï¼šæºèŠ‚ç‚¹åˆ°ç›®æ ‡èŠ‚ç‚¹ç”»æ©™è‰²ç®­å¤´
   - é›¶ç¯æ£€æµ‹ï¼šå‡ºç°ç¯æ—¶ç›¸å…³èŠ‚ç‚¹é—ªçƒçº¢è‰²ï¼Œæ’­æ”¾è­¦æŠ¥éŸ³

4. **äº¤äº’åŠŸèƒ½**ï¼š
   - å•æ­¥æ‰§è¡Œï¼šæŒ‰å¸§æŸ¥çœ‹çŠ¶æ€è½¬ç§»
   - æ‚¬åœèŠ‚ç‚¹ï¼šæ˜¾ç¤º`dis[u]`å’Œ`dp[u][*]`å€¼
   - é›¶ç¯æ¼”ç¤ºï¼šæ•…æ„æ„é€ é›¶ç¯åœºæ™¯ï¼Œè§’è‰²è¢«å›°åœ¨å¾ªç¯è·¯å¾„ä¸­

**éŸ³æ•ˆè®¾è®¡**ï¼š
- èŠ‚ç‚¹è®¿é—®ï¼šç”µå­"æ»´"å£°
- è·¯å¾„ç¡®è®¤ï¼šä¸Šå‡éŸ³é˜¶
- é›¶ç¯è­¦å‘Šï¼šä½æ²‰è­¦æŠ¥å¾ªç¯
- DPçŠ¶æ€æ›´æ–°ï¼šçŸ­ä¿ƒ"å’”å—’"å£°

---

## 6. æ‹“å±•ç»ƒä¹ ä¸ç›¸ä¼¼é—®é¢˜æ€è€ƒ

**é€šç”¨æŠ€å·§è¿ç§»**ï¼š
1. **å¸¦çº¦æŸçš„æœ€çŸ­è·¯è®¡æ•°**ï¼šå¦‚â€œæœ‰é™æ¡è¾¹çš„æœ€çŸ­è·¯â€
2. **çŠ¶æ€ç©ºé—´å‹ç¼©**ï¼šåˆ©ç”¨å°èŒƒå›´å‚æ•°é™ç»´
3. **å›¾è®ºä¸­DPåº”ç”¨**ï¼šå¦‚åˆ†å±‚å›¾æœ€çŸ­è·¯

**æ´›è°·æ¨è**ï¼š
1. **P1144 æœ€çŸ­è·¯è®¡æ•°**  
   â†’ å·©å›ºåŸºç¡€æœ€çŸ­è·¯è®¡æ•°
2. **P1613 è·‘è·¯**  
   â†’ ç»ƒä¹ å€å¢+DPä¼˜åŒ–æŠ€å·§
3. **P1073 æœ€ä¼˜è´¸æ˜“**  
   â†’ å­¦ä¹ çŠ¶æ€æœºDPåœ¨å›¾è®ºçš„åº”ç”¨

---

## 7. å­¦ä¹ å¿ƒå¾—ä¸ç»éªŒåˆ†äº«

> **æ¥è‡ªJay_geniusçš„è°ƒè¯•ç»éªŒ**ï¼š  
> "æˆ‘åœ¨`k<0`çš„åˆ¤æ–­ä¸Šå¡äº†å¾ˆä¹…ï¼Œåæ¥é€šè¿‡æ‰“å°`dis`æ•°ç»„æ‰å‘ç°è½¬ç§»å…¬å¼çš„è¾¹ç•Œé—®é¢˜"

> **Kayçš„æ€»ç»“**ï¼š  
> è°ƒè¯•DPé—®é¢˜æ—¶ï¼Œå»ºè®®ï¼š
> 1. å°è§„æ¨¡æ•°æ®æ‰‹å·¥æ¨¡æ‹Ÿ
> 2. æ‰“å°å…³é”®çŠ¶æ€è½¬ç§»è¡¨
> 3. ç‰¹åˆ«æ³¨æ„è¾¹ç•Œå€¼ï¼ˆ`k=0`å’Œ`k=K`ï¼‰

> **æ¥è‡ªykzzldzçš„æ•™è®­**ï¼š  
> "å¤šç»„æµ‹è¯•æ•°æ®ä¸‹ï¼Œæ²¡æœ‰æ¸…ç©º`ins`æ•°ç»„å¯¼è‡´WA"

---

æœ¬æ¬¡ã€Œé€›å…¬å›­ã€çš„æ¢ç´¢ä¹‹æ—…å°±åˆ°è¿™é‡Œï¼è®°ä½ï¼šç®—æ³•å­¦ä¹ å¦‚åŒé€›å…¬å›­ï¼Œé‡è¦çš„ä¸ä»…æ˜¯åˆ°è¾¾ç»ˆç‚¹ï¼Œæ›´æ˜¯äº«å—æ€è€ƒçš„è¿‡ç¨‹ã€‚ä¸‹æ¬¡é‡åˆ°æ–°é—®é¢˜æ—¶ï¼Œæ„¿ä½ åƒè§„åˆ’æœ€ä½³è·¯çº¿ä¸€æ ·ä»å®¹ä¸è¿«ï¼ğŸš€

---
å¤„ç†ç”¨æ—¶ï¼š112.80ç§’
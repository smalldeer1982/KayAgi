# é¢˜ç›®ä¿¡æ¯

# å¥‰çŒ®ï¼ˆDedicationï¼‰

## é¢˜ç›®èƒŒæ™¯

ä¸æ–­é­ç­–è‡ªå·±çš„æ•°å­¦ç²¾ç¥ â€”â€” å¥‰çŒ®ã€‚
****
ã€Œå¥‰çŒ®ä¹‹å…‰ã€ä¸½èï¼Œæ—¢æ˜¯ã€Œç§©åºä¹‹ç¥ã€æ´¾æ‹‰çš„ç¥å®˜ï¼Œäº¦ä¸ºã€Œæ— ç§©åºä¹‹ç¥ã€è¿ªå¥¥å°¼æ–¯çš„ä¿¡å¾’ã€‚

ä¸½èæœ€è¿‘å­¦ä¹ äº†[é«˜ç²¾åº¦é™¤æ³•](https://www.luogu.com.cn/problem/P5432)ï¼Œå¥¹èƒ½ä»¥ $\Theta(n \log n)$ çš„æ—¶é—´å¤æ‚åº¦è®¡ç®— $n$ ä½æ•´æ•°é™¤æ³•äº†ã€‚

## é¢˜ç›®æè¿°



ä¸½èæƒ³è¦åˆ¶ä½œä¸€å¼  $n$ ä»¥å†…æ­£æ•´æ•°çš„é™¤æ³•è¡¨ã€‚å…·ä½“æ¥è¯´ï¼Œæ˜¯ä¸€å¼ è®°å½•äº† $\lfloor a/b \rfloor$ï¼ˆ$1\leq b \leq a \leq n$ï¼Œ$a,b$ å‡ä¸ºæ•´æ•°ï¼‰çš„è¡¨æ ¼ã€‚å¥¹ä½¿ç”¨å¦‚ä¸‹æ–¹æ³•æ¥åˆ¶ä½œï¼š

>ä»¥ $a$ ä¸ºç¬¬ä¸€å…³é”®å­—ä»å°åˆ°å¤§ï¼Œä»¥ $b$ ä¸ºç¬¬äºŒå…³é”®å­—ä»å°åˆ°å¤§çš„é¡ºåºæšä¸¾ä½ç½® $(a,b)$ã€‚è‹¥ $(a,b)$ ä½ç½®**æœªè¢«å¡«å†™**ï¼Œåˆ™ï¼š
>
>è®¡ç®— $\lfloor a/b \rfloor$ï¼Œè¿™éœ€è¦æ¶ˆè€—çš„**é­”åŠ›**ä¸º $d_a \log_2 d_a$ï¼ˆå…¶ä¸­ $d_a$ è¡¨ç¤º $a$ åœ¨åè¿›åˆ¶ä¸‹çš„ä½æ•°ï¼Œå³ $d_a=\lfloor 1+ \log_{10}a\rfloor$ï¼‰ã€‚ç„¶åæšä¸¾æ­£æ•´æ•° $i$ï¼Œæ‰¾åˆ°æ‰€æœ‰**æœªè¢«å¡«å†™**çš„ $(ai,bi)$ï¼ˆ$ai\leq n$ï¼‰ä½ç½®éƒ½å¡«å†™å…¥ $\lfloor a/b \rfloor$ã€‚æ¯æ¬¡å¡«å†™éœ€è¦æ¶ˆè€—çš„é­”åŠ›ä¸º $d_i$ã€‚

ç”±äºç¾å¨œå·²ç»åšè¿‡ä¸€å¼ ä¹˜æ³•è¡¨ï¼Œä¸½èæ— éœ€é­”åŠ›å°±å¯ä»¥ç›´æ¥è®¡ç®—ä¹˜æ³•ã€‚ç°åœ¨ä¸½èæƒ³è¦çŸ¥é“ï¼Œåˆ¶ä½œæ•´ä¸ªé™¤æ³•è¡¨éœ€è¦æ¶ˆè€—å¤šå°‘é­”åŠ›ã€‚


ä¸ºäº†é˜²æ­¢ç²¾åº¦é—®é¢˜ï¼Œåªè¦ä½ çš„è¾“å‡ºä¸æ ‡å‡†è¾“å‡ºçš„**ç›¸å¯¹è¯¯å·®**ä¸è¶…è¿‡ $10^{-6}$ åˆ™è§†ä¸ºæ­£ç¡®ã€‚ä¿è¯æ ‡å‡†è¾“å‡ºä¸å®é™…ç­”æ¡ˆçš„ç›¸å¯¹è¯¯å·®ä¸è¶…è¿‡ $10^{-10}$ã€‚

## è¯´æ˜/æç¤º

ã€æ ·ä¾‹ $1$ è§£é‡Šã€‘  

ç”±äº $a \leq 6$ï¼Œ$d_a=1$ï¼Œä»è€Œ $d_a \log_2 d_a=0$ã€‚ä¹Ÿå°±æ˜¯è¯´åœ¨æ­¤èŒƒå›´ä¸‹åªæœ‰å¡«å†™æ•°å­—ä¼šæ¶ˆè€—é­”åŠ›ã€‚è€Œæ¯æ¬¡ $i$ ä¹Ÿä¸è¶…è¿‡ $6$ï¼Œæ»¡è¶³ $d_i=1$ï¼Œæ¯æ¬¡å¡«å†™éƒ½æ¶ˆè€—å›ºå®š $1$ ç‚¹é­”åŠ›ï¼Œè¦å¡«å†™å…¨éƒ¨ $1+2+3+4+5+6=21$ ä¸ªæ•°æ¶ˆè€—çš„é­”åŠ›å°±æ˜¯ $21$ã€‚

æ•…ç­”æ¡ˆä¸º $21$ã€‚

ã€æ•°æ®èŒƒå›´ã€‘  

**æœ¬é¢˜é‡‡ç”¨æ†ç»‘æµ‹è¯•ã€‚**  

Subtask 1ï¼ˆ15 ptsï¼‰ï¼š$n\le 5000$ï¼›  
Subtask 2ï¼ˆ15 ptsï¼‰ï¼š$n\le 10^5$ï¼›  
Subtask 3ï¼ˆ30 ptsï¼‰ï¼š$n\le 2 \times 10^6$ï¼›  
Subtask 4ï¼ˆ40 ptsï¼‰ï¼šæ— ç‰¹æ®Šé™åˆ¶ã€‚

å¯¹äºå…¨éƒ¨çš„æ•°æ®ï¼Œ$1\le n \le 2 \times 10^7$ã€‚  

ã€æç¤ºã€‘

$\log_2 n$ è¯»ä½œã€Œä»¥ $2$ ä¸ºåº•çš„ $n$ çš„å¯¹æ•°ã€ã€‚è®¾ $x=\log_2n$ï¼Œå®ƒè¡¨ç¤º $2^x=n$ã€‚

## æ ·ä¾‹ #1

### è¾“å…¥

```
6```

### è¾“å‡º

```
21.0000000```

## æ ·ä¾‹ #2

### è¾“å…¥

```
20```

### è¾“å‡º

```
422.0000000```

## æ ·ä¾‹ #3

### è¾“å…¥

```
233```

### è¾“å‡º

```
99838.0384544```

# AIåˆ†æç»“æœ

# ğŸ’¡ Kayçš„C++ç®—æ³•è§£æï¼šã€Œå¥‰çŒ®ã€æ·±å…¥å­¦ä¹ æŒ‡å— ğŸ’¡


## 1. é¢˜ç›®è§£è¯»ä¸æ ¸å¿ƒç®—æ³•è¯†åˆ«

### âœ¨ æœ¬é¢˜ä¸»è¦è€ƒå¯Ÿï¼š**æ•°å­¦ï¼ˆæ•°è®ºï¼‰+ å‰ç¼€å’Œ/çº¿æ€§ç­›**

ğŸ—£ï¸ **åˆæ­¥åˆ†æ**ï¼š  
è§£å†³è¿™é“é¢˜çš„å…³é”®ï¼Œå°±åƒâ€œæ•´ç†æ”¶çº³ç›’â€â€”â€”æˆ‘ä»¬éœ€è¦æŠŠ**é‡å¤çš„å·¥ä½œåˆå¹¶**ï¼Œåªå¤„ç†â€œæœ€åŸºç¡€çš„å•å…ƒâ€ã€‚é¢˜ç›®ä¸­ï¼Œåªæœ‰å½“ä¸¤ä¸ªæ•°`a`å’Œ`b`äº’è´¨ï¼ˆgcd(a,b)=1ï¼‰æ—¶ï¼Œæ‰éœ€è¦â€œé¦–æ¬¡è®¡ç®—â€å®ƒä»¬çš„é™¤æ³•ç»“æœï¼›å¦åˆ™ï¼Œè¿™ä¸ªç»“æœæ—©å°±åœ¨å¤„ç†æ›´å°çš„`(a/d, b/d)`ï¼ˆdæ˜¯gcdï¼‰æ—¶è¢«â€œæ‰¹é‡å¡«å†™â€äº†ã€‚  

è¿™ç”¨åˆ°äº†**æ•°è®ºä¸­çš„æ¬§æ‹‰å‡½æ•°Ï†(a)**â€”â€”å®ƒèƒ½å¿«é€Ÿç®—å‡º1~aä¸­ä¸aäº’è´¨çš„æ•°çš„ä¸ªæ•°ï¼ˆæ¯”å¦‚Ï†(6)=2ï¼Œå› ä¸º1ã€5å’Œ6äº’è´¨ï¼‰ã€‚åŒæ—¶ï¼Œæˆ‘ä»¬éœ€è¦ç”¨**å‰ç¼€å’Œ**é¢„å¤„ç†â€œå¡«å†™é­”åŠ›â€çš„æ€»å’Œï¼Œç”¨**çº¿æ€§ç­›**å¿«é€Ÿè®¡ç®—æ¬§æ‹‰å‡½æ•°ï¼ˆæ—¶é—´å¤æ‚åº¦O(n)ï¼‰ã€‚  

### æ ¸å¿ƒç®—æ³•æµç¨‹ä¸å¯è§†åŒ–è®¾è®¡  
- **æ ¸å¿ƒæµç¨‹**ï¼š  
  1. é¢„å¤„ç†æ¯ä¸ªæ•°çš„ä½æ•°`d[i]`ï¼ˆæ¯”å¦‚123çš„dæ˜¯3ï¼‰ï¼›  
  2. ç”¨çº¿æ€§ç­›ç®—æ¬§æ‹‰å‡½æ•°`Ï†[i]`ï¼›  
  3. è®¡ç®—`d[i]`çš„å‰ç¼€å’Œ`sumd[i]`ï¼ˆå¿«é€Ÿæ±‚sum_{k=1}^m d[k]ï¼‰ï¼›  
  4. éå†æ¯ä¸ª`a`ï¼Œç´¯åŠ `Ï†[a]*(d[a]log2(d[a]) + sumd[n/a])`ã€‚  

- **å¯è§†åŒ–æ€è·¯**ï¼š  
  æˆ‘ä»¬è®¾è®¡ä¸€ä¸ª**åƒç´ é£â€œæ•°å­¦å®éªŒå®¤â€**ï¼š  
  - å±å¹•å·¦ä¾§æ˜¯â€œæ•°å­—æ”¶çº³ç›’â€ï¼ˆæ˜¾ç¤º`d[i]`å’Œ`Ï†[i]`ï¼‰ï¼Œå³ä¾§æ˜¯â€œè®¡ç®—é»‘æ¿â€ï¼ˆå®æ—¶æ˜¾ç¤ºå½“å‰`a`çš„è´¡çŒ®ï¼‰ï¼›  
  - å½“å¤„ç†`a=3`æ—¶ï¼Œâ€œæ”¶çº³ç›’â€ä¼šå¼¹å‡ºÏ†(3)=2ï¼ˆè¡¨ç¤ºæœ‰2ä¸ªäº’è´¨çš„bï¼‰ï¼Œâ€œé»‘æ¿â€ä¸Šä¼šåŠ¨æ€ç´¯åŠ `2*(d[3]log2(d[3]) + sumd[n/3])`ï¼›  
  - å…³é”®æ“ä½œï¼ˆæ¯”å¦‚çº¿æ€§ç­›ç®—Ï†ã€å‰ç¼€å’Œç´¯åŠ ï¼‰ä¼šæœ‰â€œå®â€çš„åƒç´ éŸ³æ•ˆï¼Œå®Œæˆæ—¶æ’­æ”¾â€œèƒœåˆ©â€éŸ³æ•ˆï¼›  
  - æ”¯æŒâ€œå•æ­¥æ‰§è¡Œâ€å’Œâ€œè‡ªåŠ¨æ’­æ”¾â€ï¼Œè®©ä½ çœ‹æ¸…æ¯ä¸€æ­¥çš„è®¡ç®—é€»è¾‘ã€‚  


## 2. ç²¾é€‰ä¼˜è´¨é¢˜è§£å‚è€ƒ

### é¢˜è§£ä¸€ï¼šNaCly_Fishï¼ˆèµï¼š13ï¼‰  
**ç‚¹è¯„**ï¼šè¿™ä»½é¢˜è§£çš„æ€è·¯æœ€æ¸…æ™°ï¼ä½œè€…ä»â€œæ¨¡æ‹Ÿä»£ç â€å‡ºå‘ï¼Œä¸€æ­¥æ­¥æ¨å¯¼åˆ°â€œgcd(a,b)=1â€çš„å…³é”®è§‚å¯Ÿï¼Œå†å¼•å‡ºæ¬§æ‹‰å‡½æ•°å’Œå‰ç¼€å’Œã€‚ä»£ç æ¡†æ¶ç®€æ´ï¼Œæ³¨é‡Šæ˜ç¡®ï¼Œç‰¹åˆ«æ˜¯â€œå†…å±‚å¾ªç¯æ— éœ€åˆ¤æ–­æ˜¯å¦å·²å¡«â€çš„è¯æ˜ï¼Œå¸®ä½ å½»åº•ç†è§£é—®é¢˜æœ¬è´¨ã€‚  

### é¢˜è§£äºŒï¼šL_zaa_Lï¼ˆèµï¼š8ï¼‰  
**ç‚¹è¯„**ï¼šä½œè€…ç›´æ¥ç‚¹å‡ºâ€œåªæœ‰äº’è´¨çš„ç‚¹éœ€è¦å¤„ç†â€ï¼Œç„¶åå¿«é€Ÿæ¨å¯¼å‡ºæœ€ç»ˆå¼å­ï¼Œé€»è¾‘è·³è·ƒä½†ç²¾å‡†ã€‚ä»£ç ä¸­ç”¨çº¿æ€§ç­›é¢„å¤„ç†Ï†ï¼Œå‰ç¼€å’Œå¤„ç†sumdï¼Œæ˜¯â€œæ ‡å‡†è§£æ³•â€çš„æ¨¡æ¿ï¼Œé€‚åˆå…¥é—¨å­¦ä¹ ã€‚  

### é¢˜è§£ä¸‰ï¼šlbmzxhbï¼ˆèµï¼š1ï¼‰  
**ç‚¹è¯„**ï¼šä½œè€…æŠŠâ€œè®¡ç®—é­”åŠ›â€å’Œâ€œå¡«å†™é­”åŠ›â€åˆ†å¼€æ¨å¯¼ï¼Œè™½ç„¶ä¸­é—´æœ‰ç‚¹å°æ’æ›²ï¼ˆå¿˜è®°é¢„å¤„ç†d[i]ï¼‰ï¼Œä½†å¼å­æ¨å¯¼å¾ˆä¸¥è°¨ã€‚ä»£ç ä¸­â€œåˆ†æ®µè®¡ç®—d[i]â€çš„æŠ€å·§ï¼ˆæ¯”å¦‚æŠŠä½æ•°ç›¸åŒçš„æ•°æ”¾ä¸€èµ·ç®—ï¼‰ï¼Œèƒ½ä¼˜åŒ–å¸¸æ•°ï¼Œé€‚åˆæƒ³æ·±å…¥ä¼˜åŒ–çš„åŒå­¦ã€‚  


## 3. æ ¸å¿ƒéš¾ç‚¹è¾¨æä¸è§£é¢˜ç­–ç•¥

### å…³é”®ç‚¹1ï¼šå¦‚ä½•æƒ³åˆ°â€œgcd(a,b)=1â€æ˜¯æ ¸å¿ƒæ¡ä»¶ï¼Ÿ  
**åˆ†æ**ï¼šå‡è®¾gcd(a,b)=d>1ï¼Œé‚£ä¹ˆ(a,b)ä¼šè¢«(a/d, b/d)å¤„ç†ï¼ˆå› ä¸ºa/d < aï¼Œæ‰€ä»¥æ›´æ—©æšä¸¾ï¼‰ã€‚åè¿‡æ¥è¯´ï¼Œå¦‚æœgcd(a,b)=1ï¼Œå°±ä¸ä¼šè¢«ä»»ä½•æ›´å°çš„(a',b')å¤„ç†ã€‚è¿™ä¸€æ­¥æ˜¯â€œä»æ¨¡æ‹Ÿåˆ°æ•°å­¦æ¨å¯¼â€çš„å…³é”®ï¼  

**å­¦ä¹ ç¬”è®°**ï¼šé‡åˆ°â€œé‡å¤æ“ä½œâ€çš„é—®é¢˜ï¼Œå…ˆæƒ³â€œæœ‰æ²¡æœ‰æ›´åŸºç¡€çš„å•å…ƒå¯ä»¥ä»£è¡¨é‡å¤çš„éƒ¨åˆ†â€ã€‚


### å…³é”®ç‚¹2ï¼šæ¬§æ‹‰å‡½æ•°Ï†(a)çš„ä½œç”¨æ˜¯ä»€ä¹ˆï¼Ÿ  
**åˆ†æ**ï¼šÏ†(a)æ˜¯1~aä¸­ä¸aäº’è´¨çš„æ•°çš„ä¸ªæ•°ï¼Œæ­£å¥½å¯¹åº”æ¯ä¸ªaéœ€è¦å¤„ç†çš„bçš„æ•°é‡ï¼ˆå› ä¸ºbâ‰¤aä¸”gcd(a,b)=1ï¼‰ã€‚æ¯”å¦‚a=6ï¼ŒÏ†(6)=2ï¼Œæ‰€ä»¥æœ‰2ä¸ªbï¼ˆ1ã€5ï¼‰éœ€è¦å¤„ç†ã€‚  

**å­¦ä¹ ç¬”è®°**ï¼šæ¬§æ‹‰å‡½æ•°æ˜¯â€œè®¡æ•°äº’è´¨æ•°â€çš„ç¥å™¨ï¼Œé‡åˆ°â€œäº’è´¨è®¡æ•°â€é—®é¢˜å…ˆæƒ³Ï†ï¼


### å…³é”®ç‚¹3ï¼šå¦‚ä½•é«˜æ•ˆé¢„å¤„ç†d[i]å’Œsumd[i]ï¼Ÿ  
**åˆ†æ**ï¼šd[i]æ˜¯içš„ä½æ•°ï¼Œå¯ä»¥ç”¨é€’æ¨å¼`d[i] = d[i/10] + 1`ï¼ˆæ¯”å¦‚i=123ï¼Œi/10=12ï¼Œd[12]=2ï¼Œæ‰€ä»¥d[123]=3ï¼‰ã€‚sumd[i]æ˜¯dçš„å‰ç¼€å’Œï¼Œç›´æ¥`sumd[i] = sumd[i-1] + d[i]`å³å¯ï¼Œæ—¶é—´O(n)ã€‚  

**å­¦ä¹ ç¬”è®°**ï¼šé¢„å¤„ç†æ˜¯â€œä¼˜åŒ–æ—¶é—´â€çš„å…³é”®ï¼Œèƒ½O(n)ç®—çš„ç»ä¸O(nÂ²)ï¼


## 4. C++æ ¸å¿ƒä»£ç å®ç°èµæ

### æœ¬é¢˜é€šç”¨æ ¸å¿ƒC++å®ç°å‚è€ƒ  
**è¯´æ˜**ï¼šç»¼åˆå¤šä¸ªä¼˜è´¨é¢˜è§£çš„æ€è·¯ï¼Œå®ç°äº†çº¿æ€§ç­›ã€d[i]é¢„å¤„ç†ã€å‰ç¼€å’Œè®¡ç®—ï¼Œæ˜¯æœ€ç®€æ´çš„æ ‡å‡†è§£æ³•ã€‚  

```cpp
#include <iostream>
#include <vector>
#include <cmath>
#include <iomanip>
using namespace std;

const int MAXN = 2e7 + 5;

vector<int> primes;
bool is_prime[MAXN];
int phi[MAXN], d[MAXN];
long long sumd[MAXN];

void sieve(int n) {
    is_prime[1] = true;
    phi[1] = 1;
    for (int i = 2; i <= n; ++i) {
        if (!is_prime[i]) {
            primes.push_back(i);
            phi[i] = i - 1;
        }
        for (int p : primes) {
            if (1LL * i * p > n) break;
            is_prime[i * p] = true;
            if (i % p == 0) {
                phi[i * p] = phi[i] * p;
                break;
            }
            phi[i * p] = phi[i] * (p - 1);
        }
    }
}

int main() {
    ios::sync_with_stdio(false);
    cin.tie(nullptr);
    int n;
    cin >> n;

    // é¢„å¤„ç†æ¬§æ‹‰å‡½æ•°
    sieve(n);

    // é¢„å¤„ç†d[i]ï¼ˆä½æ•°ï¼‰å’Œsumd[i]ï¼ˆå‰ç¼€å’Œï¼‰
    d[0] = 0;
    for (int i = 1; i <= n; ++i) {
        d[i] = d[i / 10] + 1;
        sumd[i] = sumd[i - 1] + d[i];
    }

    // è®¡ç®—æ€»é­”åŠ›
    double ans = 0.0;
    for (int a = 1; a <= n; ++a) {
        double cost_calc = d[a] * log2(d[a]);  // è®¡ç®—çš„é­”åŠ›
        double cost_fill = sumd[n / a];        // å¡«å†™çš„é­”åŠ›
        ans += phi[a] * (cost_calc + cost_fill);
    }

    cout << fixed << setprecision(10) << ans << endl;
    return 0;
}
```

**ä»£ç è§£è¯»æ¦‚è¦**ï¼š  
1. `sieve`å‡½æ•°ç”¨çº¿æ€§ç­›é¢„å¤„ç†æ¬§æ‹‰å‡½æ•°Ï†ï¼›  
2. é¢„å¤„ç†`d`æ•°ç»„ï¼ˆä½æ•°ï¼‰å’Œ`sumd`æ•°ç»„ï¼ˆå‰ç¼€å’Œï¼‰ï¼›  
3. éå†æ¯ä¸ª`a`ï¼Œè®¡ç®—æ¯ä¸ª`a`çš„è´¡çŒ®ï¼Œç´¯åŠ å¾—åˆ°æ€»é­”åŠ›ã€‚


### é¢˜è§£ä¸€ï¼šNaCly_Fishçš„æ ¸å¿ƒç‰‡æ®µ  
**äº®ç‚¹**ï¼šä»æ¨¡æ‹Ÿä»£ç åˆ°æ•°å­¦æ¨å¯¼çš„è¿‡æ¸¡ï¼Œå¸®ä½ ç†è§£â€œä¸ºä»€ä¹ˆä¸ç”¨åˆ¤æ–­å·²å¡«â€ã€‚  

**æ ¸å¿ƒä»£ç ç‰‡æ®µ**ï¼š  
```cpp
for(int a=1;a<=n;++a){
    int len = d(a);
    for(int b=1;b<=a;++b){
        if(vis[a][b]) continue;
        ans += len*log2(len);
        for(int i=1;a*i<=n;++i){
            if(vis[a*i][b*i]) continue;
            vis[a*i][b*i] = true;
            ans += d(i);
        }
    }
}
```

**ä»£ç è§£è¯»**ï¼š  
è¿™æ®µæ¨¡æ‹Ÿä»£ç æ˜¯â€œåŸå§‹æ€è·¯â€â€”â€”éå†æ¯ä¸ª(a,b)ï¼Œå¦‚æœæœªå¡«åˆ™è®¡ç®—å¹¶å¡«å†™ã€‚ä½†é€šè¿‡è§‚å¯Ÿï¼Œ`vis[a][b]`ä¸ºfalseå½“ä¸”ä»…å½“gcd(a,b)=1ï¼Œæ‰€ä»¥å¯ä»¥å»æ‰visæ•°ç»„ï¼Œç›´æ¥ç”¨Ï†(a)è®¡ç®—è´¡çŒ®ã€‚  

**å­¦ä¹ ç¬”è®°**ï¼šæ¨¡æ‹Ÿæ˜¯ç†è§£é—®é¢˜çš„ç¬¬ä¸€æ­¥ï¼Œä½†è¦å­¦ä¼šâ€œæŠ½è±¡â€ï¼ŒæŠŠé‡å¤çš„å·¥ä½œç”¨æ•°å­¦å…¬å¼ä»£æ›¿ï¼


### é¢˜è§£äºŒï¼šL_zaa_Lçš„æ ¸å¿ƒç‰‡æ®µ  
**äº®ç‚¹**ï¼šç›´æ¥æ¨å¯¼å‡ºæœ€ç»ˆå¼å­ï¼Œä»£ç ç®€æ´é«˜æ•ˆã€‚  

**æ ¸å¿ƒä»£ç ç‰‡æ®µ**ï¼š  
```cpp
For(i,1,n){
    if(((s<<3)+(s<<1))<=i){
        s=((s<<3)+(s<<1));
        d++;
    }
    qzh[i]+=qzh[i-1]+d;
}
// ...
ans+=1.0*phi[i]*qzh[n/i]+1.0*(phi[i])*(d)*lg[d];
```

**ä»£ç è§£è¯»**ï¼š  
- ç”¨`s`å’Œ`d`é¢„å¤„ç†`d[i]`ï¼ˆ`s`æ˜¯10çš„å¹‚ï¼Œæ¯”å¦‚s=10æ—¶ï¼Œd=2ï¼‰ï¼›  
- `qzh`æ˜¯`d[i]`çš„å‰ç¼€å’Œï¼›  
- ç›´æ¥è®¡ç®—æ¯ä¸ª`a`çš„è´¡çŒ®ï¼Œæ²¡æœ‰å¤šä½™æ­¥éª¤ã€‚  

**å­¦ä¹ ç¬”è®°**ï¼šé¢„å¤„ç†è¦â€œå·§â€ï¼Œé¿å…ç”¨`log10`ç­‰æ…¢å‡½æ•°ï¼


## 5. ç®—æ³•å¯è§†åŒ–ï¼šåƒç´ åŠ¨ç”»æ¼”ç¤º

### ğŸ® åŠ¨ç”»ä¸»é¢˜ï¼šã€Œåƒç´ æ•°å­¦å®¶çš„é™¤æ³•å®éªŒå®¤ã€  
**è®¾è®¡æ€è·¯**ï¼šç”¨8ä½åƒç´ é£æ¨¡æ‹Ÿâ€œè®¡ç®—é­”åŠ›â€çš„è¿‡ç¨‹ï¼ŒæŠŠæŠ½è±¡çš„æ•°è®ºå˜æˆâ€œæ•´ç†æ”¶çº³ç›’â€çš„æ¸¸æˆï¼Œè®©å­¦ä¹ æ›´æœ‰è¶£ï¼  

### ğŸ•¹ï¸ åŠ¨ç”»å¸§æ­¥éª¤ä¸äº¤äº’  
1. **åœºæ™¯åˆå§‹åŒ–**ï¼š  
   - å±å¹•å·¦ä¾§æ˜¯â€œæ•°å­—æ”¶çº³æ¶â€ï¼Œæ¯ä¸ªæ ¼å­æ˜¾ç¤º`i`ã€`d[i]`ã€`Ï†[i]`ï¼›  
   - å³ä¾§æ˜¯â€œè®¡ç®—é»‘æ¿â€ï¼Œæ˜¾ç¤ºå½“å‰å¤„ç†çš„`a`å’Œç´¯è®¡çš„é­”åŠ›ï¼›  
   - åº•éƒ¨æ§åˆ¶é¢æ¿æœ‰â€œå•æ­¥â€â€œè‡ªåŠ¨â€â€œé‡ç½®â€æŒ‰é’®ï¼Œé€Ÿåº¦æ»‘å—ï¼Œè¿˜æœ‰8ä½é£æ ¼çš„èƒŒæ™¯éŸ³ä¹ã€‚  

2. **é¢„å¤„ç†é˜¶æ®µ**ï¼š  
   - çº¿æ€§ç­›è®¡ç®—Ï†ï¼šåƒç´ ç®­å¤´æŒ‡å‘`i`ï¼Œç„¶åè·³åˆ°`i*p`ï¼Œæ˜¾ç¤ºâ€œÏ†[i*p] = Ï†[i]*(p-1)â€ï¼ˆå¦‚æœäº’è´¨ï¼‰æˆ–â€œÏ†[i*p] = Ï†[i]*pâ€ï¼ˆå¦‚æœä¸äº’è´¨ï¼‰ï¼›  
   - é¢„å¤„ç†d[i]ï¼šæ•°å­—`i`ä»æ”¶çº³æ¶æ»‘åˆ°â€œä½æ•°æœºâ€ï¼Œå‡ºæ¥æ—¶å¸¦ä¸Š`d[i]`ï¼Œæ¯”å¦‚123æ»‘è¿›å»ï¼Œå‡ºæ¥æ—¶æ˜¾ç¤ºâ€œ123 (d=3)â€ï¼›  
   - é¢„å¤„ç†sumd[i]ï¼šâ€œå‰ç¼€å’Œä¼ é€å¸¦â€æŠŠ`d[i]`ä¸€ä¸ªä¸ªç´¯åŠ ï¼Œæ˜¾ç¤ºsumd[i]çš„åŠ¨æ€å˜åŒ–ã€‚  

3. **è®¡ç®—é˜¶æ®µ**ï¼š  
   - å¤„ç†`a=3`ï¼šæ”¶çº³æ¶å¼¹å‡º`Ï†[3]=2`ï¼Œé»‘æ¿ä¸Šæ˜¾ç¤ºâ€œè´¡çŒ®ï¼š2*(d[3]log2(d[3]) + sumd[n/3])â€ï¼›  
   - æ¯å¤„ç†ä¸€ä¸ª`a`ï¼Œé»‘æ¿ä¸Šçš„æ€»é­”åŠ›å¢åŠ ï¼Œä¼´éšâ€œå®â€çš„éŸ³æ•ˆï¼›  
   - å½“å¤„ç†å®Œæ‰€æœ‰`a`ï¼Œå±å¹•å¼¹å‡ºâ€œè®¡ç®—å®Œæˆï¼æ€»é­”åŠ›ï¼šXX.XXXXâ€ï¼Œæ’­æ”¾èƒœåˆ©éŸ³æ•ˆã€‚  

4. **äº¤äº’è®¾è®¡**ï¼š  
   - å•æ­¥æ¨¡å¼ï¼šç‚¹å‡»â€œä¸‹ä¸€æ­¥â€ï¼Œé€æ­¥çœ‹æ¯ä¸ª`a`çš„å¤„ç†ï¼›  
   - è‡ªåŠ¨æ¨¡å¼ï¼šé€‰æ‹©é€Ÿåº¦ï¼ˆæ…¢/ä¸­/å¿«ï¼‰ï¼ŒåŠ¨ç”»è‡ªåŠ¨æ’­æ”¾ï¼›  
   - é‡ç½®æ¨¡å¼ï¼šå›åˆ°åˆå§‹çŠ¶æ€ï¼Œé‡æ–°å¼€å§‹ã€‚  


## 6. æ‹“å±•ç»ƒä¹ ä¸ç›¸ä¼¼é—®é¢˜æ€è€ƒ

### ğŸ“š ç›¸ä¼¼é—®é¢˜æ¨è  
1. **æ´›è°·P2158 ä»ªä»—é˜Ÿ**ï¼šè®¡ç®—ä»(0,0)èƒ½çœ‹åˆ°çš„ç‚¹çš„æ•°é‡ï¼Œæ ¸å¿ƒæ˜¯æ¬§æ‹‰å‡½æ•°ï¼ˆç»Ÿè®¡äº’è´¨çš„ç‚¹ï¼‰ï¼›  
2. **æ´›è°·P3383 çº¿æ€§ç­›æ¨¡æ¿**ï¼šç»ƒä¹ çº¿æ€§ç­›é¢„å¤„ç†æ¬§æ‹‰å‡½æ•°ã€è´¨æ•°ç­‰ï¼›  
3. **æ´›è°·P5432 é«˜ç²¾åº¦é™¤æ³•**ï¼šé¢˜ç›®èƒŒæ™¯æåˆ°çš„é«˜ç²¾åº¦é™¤æ³•ï¼Œå·©å›ºå¤§æ•°è¿ç®—ï¼›  
4. **æ´›è°·P1029 æœ€å¤§å…¬çº¦æ•°å’Œæœ€å°å…¬å€æ•°é—®é¢˜**ï¼šç»ƒä¹ gcdå’Œlcmçš„åº”ç”¨ã€‚  

### ğŸ’¡ æ‹“å±•æ€è€ƒ  
- å¦‚æœnæ˜¯1e8ï¼Œçº¿æ€§ç­›ä¼šè¶…æ—¶å—ï¼Ÿå¦‚ä½•ä¼˜åŒ–ï¼Ÿï¼ˆæç¤ºï¼šå¯ä»¥ç”¨â€œåˆ†æ®µç­›â€ï¼‰  
- å¦‚æœd[i]çš„å®šä¹‰å˜æˆâ€œiçš„äºŒè¿›åˆ¶ä½æ•°â€ï¼Œå¦‚ä½•é¢„å¤„ç†ï¼Ÿï¼ˆæç¤ºï¼šç”¨ä½è¿ç®—`__builtin_clz`ï¼‰  


## 7. å­¦ä¹ å¿ƒå¾—ä¸ç»éªŒåˆ†äº«

### ğŸ“ æ¥è‡ªé¢˜è§£çš„ç»éªŒ  
- **NaCly_Fish**ï¼šâ€œæœ€å†…å±‚å¾ªç¯çš„åˆ¤æ–­æ˜¯ä¸å¿…è¦çš„â€â€”â€”è§‚å¯Ÿé—®é¢˜çš„æœ¬è´¨ï¼Œèƒ½å»æ‰å¤šä½™çš„æ“ä½œï¼›  
- **lbmzxhb**ï¼šâ€œd[i]å¯ä»¥O(n)é¢„å¤„ç†â€â€”â€”é¿å…ç”¨`log10`ç­‰æ…¢å‡½æ•°ï¼Œé¢„å¤„ç†æ›´é«˜æ•ˆï¼›  
- **forever_nope**ï¼šâ€œæšä¸¾äº’è´¨çš„ç‚¹â€â€”â€”é‡åˆ°â€œé‡å¤å¤„ç†â€çš„é—®é¢˜ï¼Œå…ˆæƒ³â€œåŸºç¡€å•å…ƒâ€ï¼ˆæ¯”å¦‚äº’è´¨çš„ç‚¹ï¼‰ã€‚  


## ğŸ’ª æ€»ç»“ä¸é¼“åŠ±  
è¿™é“é¢˜çš„æ ¸å¿ƒæ˜¯**æŠŠâ€œæ¨¡æ‹Ÿé—®é¢˜â€è½¬åŒ–ä¸ºâ€œæ•°è®ºé—®é¢˜â€**ï¼Œç”¨æ¬§æ‹‰å‡½æ•°å’Œå‰ç¼€å’Œå¿«é€Ÿè®¡ç®—ã€‚è®°ä½ï¼šé‡åˆ°â€œè®¡æ•°äº’è´¨æ•°â€ç”¨Ï†ï¼Œé‡åˆ°â€œå¤šæ¬¡æ±‚å’Œâ€ç”¨å‰ç¼€å’Œï¼  

ç¼–ç¨‹çš„ä¹è¶£åœ¨äºâ€œæŠŠå¤æ‚çš„é—®é¢˜å˜ç®€å•â€â€”â€”å°±åƒæ•´ç†æ”¶çº³ç›’ï¼ŒæŠŠé‡å¤çš„ä¸œè¥¿å½’ç±»ï¼Œç„¶åä¸€é”®å¤„ç†ã€‚ä¸‹æ¬¡é‡åˆ°æ•°è®ºé—®é¢˜ï¼Œå…ˆæƒ³â€œæœ‰æ²¡æœ‰ç°æˆçš„æ•°å­¦å·¥å…·â€ï¼ˆæ¯”å¦‚æ¬§æ‹‰å‡½æ•°ã€å‰ç¼€å’Œï¼‰ï¼Œå†æƒ³â€œå¦‚ä½•é¢„å¤„ç†â€ï¼  

åŠ æ²¹ï¼Œä½ ä¸€å®šèƒ½æŒæ¡æ›´å¤šæ•°è®ºæŠ€å·§ï¼ğŸš€

---
å¤„ç†ç”¨æ—¶ï¼š81.22ç§’
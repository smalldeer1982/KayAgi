# é¢˜ç›®ä¿¡æ¯

# [USACO13FEB] Route Design G

## é¢˜ç›®æè¿°

After escaping from the farm, Bessie has decided to start a travel agency along the Amoozon river.  There are several tourist sites located on both sides of the river, each with an integer value indicating how interesting the tourist site is.

Tourist sites are connected by routes that cross the river (i.e., there are no routes connecting a site with a site on the same side of the river).  Bessie wants to design a tour for her customers and needs your help.  A tour is a sequence of tourist sites with adjacent sites connected by a route. In order to best serve her customers she wants to find the route that maximizes the sum of the values associated with each visited site.

However, Bessie may be running several of these tours at the same time.  Therefore it's important that no two routes on a tour

intersect.  Two routes (a <-> x) and (b <-> y) intersect if and only if (a < b and y < x) or (b < a and x < y) or (a = b and x = y).

Help Bessie find the best tour for her agency.  Bessie may start and end at any site on either side of the Amoozon.

æ²³å·¦å²¸æœ‰nä¸ªç‚¹ï¼Œå³å²¸æœ‰mä¸ªç‚¹ï¼Œå„æœ‰æƒå€¼ã€‚æœ‰Ræ¡è·¨æ²³çš„æ¡¥ï¼Œæ±‚ä¸€æ¡ä¸äº¤å‰çš„è·¯å¾„ä½¿å¾—ç‚¹æƒå’Œæœ€å¤§ã€‚

(a <-> b) ä¸ (x <-> y) äº¤å‰æŒ‡(a < b and y < x) or (b < a and x < y) or (a = b and x = y)ã€‚


## è¯´æ˜/æç¤º

There are three sites on the left side of the Amoozon with values 1, 1, and 5.  There are two sites on the right side of the Amoozon with values 2 and 2.  There are four routes connecting sites on both sides of the river.


The optimal tour goes from site 1 on the left, site 1 on the right, and ends at site 3 on the left.  These respectively have values 1, 2, and 5 giving a total value of the trip of 8.


## æ ·ä¾‹ #1

### è¾“å…¥

```
3 2 4 
1 
1 
5 
2 
2 
1 1 
2 1 
3 1 
2 2 
```

### è¾“å‡º

```
8 
```

# AIåˆ†æç»“æœ

# ğŸ’¡ Kayçš„C++ç®—æ³•è§£æï¼š[USACO13FEB] Route Design G æ·±å…¥å­¦ä¹ æŒ‡å— ğŸ’¡


## 1. é¢˜ç›®è§£è¯»ä¸æ ¸å¿ƒç®—æ³•è¯†åˆ«

âœ¨ **æœ¬é¢˜ä¸»è¦è€ƒå¯Ÿ**ï¼šåŠ¨æ€è§„åˆ’ï¼ˆDPï¼‰ç»“åˆæ’åºåº”ç”¨  

ğŸ—£ï¸ **åˆæ­¥åˆ†æ**ï¼š  
è§£å†³â€œä¸äº¤å‰è·¯å¾„çš„æœ€å¤§ç‚¹æƒå’Œâ€é—®é¢˜ï¼Œå…³é”®åœ¨äº**å°†â€œä¸äº¤å‰â€æ¡ä»¶è½¬åŒ–ä¸ºå¯è®¡ç®—çš„é¡ºåº**â€”â€”**è·¯å¾„ä¸­çš„å·¦ç«¯ç‚¹å’Œå³ç«¯ç‚¹å¿…é¡»ä¸¥æ ¼é€’å¢**ï¼ˆæ¯”å¦‚ï¼Œè‹¥è·¯å¾„ç»è¿‡è¾¹(a,b)å’Œ(c,d)ï¼Œåˆ™å¿…é¡»æ»¡è¶³a < cä¸”b < dï¼Œå¦åˆ™ä¸¤æ¡è¾¹ä¼šäº¤å‰ï¼‰ã€‚è¿™å°±åƒæ­ç§¯æœ¨æ—¶å¿…é¡»æŒ‰â€œä»ä¸‹åˆ°ä¸Šã€ä»å·¦åˆ°å³â€çš„é¡ºåºï¼Œå¦åˆ™ç§¯æœ¨ä¼šå€’å¡Œã€‚  

**æ ¸å¿ƒæ€è·¯**ï¼š  
1. **æ’åºè¾¹**ï¼šå°†æ‰€æœ‰è·¨æ²³çš„è¾¹æŒ‰**å·¦ç«¯ç‚¹é€’å¢ã€å³ç«¯ç‚¹é€’å¢**çš„é¡ºåºæ’åºï¼ˆç¡®ä¿å¤„ç†è¾¹æ—¶ä¸ä¼šå‡ºç°äº¤å‰çš„æƒ…å†µï¼‰ã€‚  
2. **åŠ¨æ€è§„åˆ’**ï¼šç”¨ä¸¤ä¸ªæ•°ç»„åˆ†åˆ«è®°å½•**å·¦è¾¹ç¬¬iä¸ªç‚¹ä½œä¸ºè·¯å¾„ç»ˆç‚¹çš„æœ€å¤§æƒå€¼å’Œ**ï¼ˆè®°ä¸º`f[i]`ï¼‰å’Œ**å³è¾¹ç¬¬jä¸ªç‚¹ä½œä¸ºè·¯å¾„ç»ˆç‚¹çš„æœ€å¤§æƒå€¼å’Œ**ï¼ˆè®°ä¸º`g[j]`ï¼‰ã€‚  
3. **çŠ¶æ€è½¬ç§»**ï¼šå¯¹äºæ¯æ¡è¾¹(a,b)ï¼Œé€šè¿‡å®ƒè¿æ¥å·¦å³å²¸ï¼Œæ›´æ–°`f[a]`å’Œ`g[b]`ï¼š  
   - `g[b] = max(g[b], f[a] + å³è¾¹ç‚¹bçš„æƒå€¼)`ï¼ˆä»å·¦è¾¹aèµ°åˆ°å³è¾¹bï¼Œæ›´æ–°å³è¾¹bçš„æœ€å¤§å’Œï¼‰ï¼›  
   - `f[a] = max(f[a], g[b] + å·¦è¾¹ç‚¹açš„æƒå€¼)`ï¼ˆä»å³è¾¹bèµ°å›å·¦è¾¹aï¼Œæ›´æ–°å·¦è¾¹açš„æœ€å¤§å’Œï¼‰ã€‚  

**æ ¸å¿ƒéš¾ç‚¹**ï¼š  
- å¦‚ä½•å°†â€œä¸äº¤å‰â€çš„æŠ½è±¡æ¡ä»¶è½¬åŒ–ä¸ºâ€œæ’åº+é€’å¢è½¬ç§»â€çš„å…·ä½“ç­–ç•¥ï¼›  
- æ­£ç¡®è®¾è®¡åŠ¨æ€è§„åˆ’çš„çŠ¶æ€ï¼ˆ`f[i]`å’Œ`g[j]`ï¼‰åŠè½¬ç§»æ–¹ç¨‹ï¼ˆé¿å…é‡å¤è®¡ç®—æˆ–é—æ¼æƒ…å†µï¼‰ã€‚  

**å¯è§†åŒ–è®¾è®¡æ€è·¯**ï¼š  
ç”¨**8ä½åƒç´ é£**æ¨¡æ‹Ÿå·¦å³å²¸çš„ç‚¹ï¼ˆå·¦è¾¹ç‚¹ä¸ºè“è‰²åƒç´ ï¼Œå³è¾¹ç‚¹ä¸ºçº¢è‰²åƒç´ ï¼Œæƒå€¼ç”¨æ•°å­—æ ‡æ³¨ï¼‰ï¼Œè¾¹ç”¨é»„è‰²çº¿æ¡è¿æ¥ã€‚æ’åºåï¼ŒæŒ‰é¡ºåº**é«˜äº®å½“å‰å¤„ç†çš„è¾¹**ï¼ˆé—ªçƒé»„è‰²ï¼‰ï¼Œå¹¶åŠ¨æ€æ›´æ–°å·¦å³ç‚¹çš„æƒå€¼å’Œï¼ˆæ¯”å¦‚ï¼Œ`f[a]`å¢å¤§æ—¶ï¼Œè“è‰²ç‚¹å˜ä¸ºæ›´æ·±çš„è“è‰²ï¼ŒåŒæ—¶æ˜¾ç¤ºâ€œ+xâ€çš„åŠ¨ç”»ï¼‰ã€‚åŠ å…¥**éŸ³æ•ˆ**ï¼šå¤„ç†è¾¹æ—¶æ’­æ”¾â€œå®â€çš„åƒç´ å£°ï¼Œæ›´æ–°æƒå€¼æ—¶æ’­æ”¾â€œå—¡â€çš„æç¤ºå£°ï¼Œå¢å¼ºä»£å…¥æ„Ÿã€‚


## 2. ç²¾é€‰ä¼˜è´¨é¢˜è§£å‚è€ƒ

### é¢˜è§£ä¸€ï¼šä½œè€…ï¼šzx2003ï¼ˆèµï¼š5ï¼‰  
* **ç‚¹è¯„**ï¼š  
  è¿™ä»½é¢˜è§£çš„**æ€è·¯æ¸…æ™°åº¦**å’Œ**ä»£ç ä¸¥è°¨æ€§**éå¸¸çªå‡ºã€‚ä½œè€…æ˜ç¡®å°†â€œä¸äº¤å‰â€è½¬åŒ–ä¸ºâ€œæ’åºè¾¹â€ï¼Œå¹¶è®¾è®¡äº†`dl`ï¼ˆå·¦è¾¹ç‚¹æƒå€¼ï¼‰ã€`dr`ï¼ˆå³è¾¹ç‚¹æƒå€¼ï¼‰ã€`fl`ï¼ˆå·¦è¾¹ç»ˆç‚¹æœ€å¤§å’Œï¼‰ã€`fr`ï¼ˆå³è¾¹ç»ˆç‚¹æœ€å¤§å’Œï¼‰å››ä¸ªæ•°ç»„ï¼Œé€»è¾‘å±‚æ¬¡åˆ†æ˜ã€‚  
  ä»£ç ä¸­çš„**äº®ç‚¹**ï¼š  
  - å¤„ç†é‡å¤è¾¹ï¼ˆ`if a[i] == a[i-1] then continue`ï¼‰ï¼šé¿å…é‡å¤è®¡ç®—ï¼Œæå‡æ•ˆç‡ï¼›  
  - çŠ¶æ€è½¬ç§»æ—¶ç”¨ä¸´æ—¶å˜é‡ä¿å­˜ä¹‹å‰çš„å€¼ï¼ˆ`x=fl[a[i].l], y=fr[a[i].r]`ï¼‰ï¼šé˜²æ­¢è¦†ç›–åŸæ•°æ®ï¼Œä¿è¯è½¬ç§»çš„æ­£ç¡®æ€§ï¼›  
  - åˆå§‹åŒ–æ—¶å–æ¯ä¸ªç‚¹çš„æƒå€¼ä½œä¸ºåˆå§‹æœ€å¤§å€¼ï¼ˆ`ans = max(ans, dl[i]/dr[i])`ï¼‰ï¼šå¤„ç†äº†â€œæ²¡æœ‰è¾¹â€çš„è¾¹ç•Œæƒ…å†µã€‚  

  ä»å®è·µè§’åº¦çœ‹ï¼Œè¿™ä»½ä»£ç ç»“æ„å·¥æ•´ï¼Œå˜é‡å‘½åæ¸…æ™°ï¼ˆ`fl`ã€`fr`å¯¹åº”å·¦å³ç»ˆç‚¹ï¼‰ï¼Œéå¸¸é€‚åˆåˆå­¦è€…æ¨¡ä»¿ã€‚


### é¢˜è§£äºŒï¼šä½œè€…ï¼šæ»‘ä¸æ‹‰ç¨½ï¼ˆèµï¼š4ï¼‰  
* **ç‚¹è¯„**ï¼š  
  æ­¤é¢˜è§£çš„**ä»£ç ç®€æ´æ€§**å’Œ**è¾¹ç•Œå¤„ç†**æ˜¯æœ€å¤§äº®ç‚¹ã€‚ä½œè€…ç”¨`f[i][0]`ï¼ˆå·¦è¾¹iç‚¹çš„æœ€å¤§å’Œï¼‰å’Œ`f[i][1]`ï¼ˆå³è¾¹iç‚¹çš„æœ€å¤§å’Œï¼‰åˆå¹¶äº†ä¸¤ä¸ªæ•°ç»„ï¼Œå‡å°‘äº†å˜é‡æ•°é‡ï¼›åˆå§‹åŒ–æ—¶ç›´æ¥å°†`f[i][0/1]`è®¾ä¸ºç‚¹æƒå€¼ï¼ˆ`f[i][0] = val[i][0]`ï¼‰ï¼Œå¹¶è®°å½•å…¨å±€æœ€å¤§å€¼ï¼ˆ`ans = max(ans, f[i][0/1])`ï¼‰ï¼Œå®Œç¾å¤„ç†äº†â€œæ²¡æœ‰è¾¹â€çš„æƒ…å†µã€‚  
  ä»£ç ä¸­çš„**è½¬ç§»é€»è¾‘**éå¸¸ç›´ç™½ï¼ˆ`f[y][1] = max(f[y][1], f[x][0] + val[y][1])`ï¼‰ï¼Œå®¹æ˜“ç†è§£ã€‚æ­¤å¤–ï¼Œä½œè€…ä½¿ç”¨`pair`å­˜å‚¨è¾¹ï¼Œç”¨`sort`æ’åºï¼Œç¬¦åˆC++çš„å¸¸è§„å†™æ³•ï¼Œå¯è¯»æ€§é«˜ã€‚


## 3. æ ¸å¿ƒéš¾ç‚¹è¾¨æä¸è§£é¢˜ç­–ç•¥

### 1. éš¾ç‚¹1ï¼šå¦‚ä½•å°†â€œä¸äº¤å‰â€æ¡ä»¶è½¬åŒ–ä¸ºå¯è®¡ç®—çš„é¡ºåºï¼Ÿ  
* **åˆ†æ**ï¼š  
  é¢˜ç›®ä¸­çš„â€œä¸äº¤å‰â€æ¡ä»¶ç­‰ä»·äºâ€œè·¯å¾„ä¸­çš„è¾¹å¿…é¡»æŒ‰å·¦ç«¯ç‚¹å’Œå³ç«¯ç‚¹é€’å¢çš„é¡ºåºæ’åˆ—â€ã€‚ä¾‹å¦‚ï¼Œè‹¥æœ‰è¾¹(1,2)å’Œ(3,4)ï¼Œå®ƒä»¬çš„å·¦ç«¯ç‚¹1<3ï¼Œå³ç«¯ç‚¹2<4ï¼Œä¸ä¼šäº¤å‰ï¼›è‹¥æœ‰è¾¹(1,4)å’Œ(3,2)ï¼Œå·¦ç«¯ç‚¹1<3ä½†å³ç«¯ç‚¹4>2ï¼Œå°±ä¼šäº¤å‰ã€‚å› æ­¤ï¼Œ**å°†è¾¹æŒ‰å·¦ç«¯ç‚¹é€’å¢ã€å³ç«¯ç‚¹é€’å¢æ’åº**ï¼Œå°±èƒ½ä¿è¯å¤„ç†è¾¹æ—¶ä¸ä¼šå‡ºç°äº¤å‰çš„æƒ…å†µã€‚  
* ğŸ’¡ **å­¦ä¹ ç¬”è®°**ï¼šæ’åºæ˜¯è§£å†³â€œä¸äº¤å‰â€é—®é¢˜çš„å…³é”®ï¼Œå®ƒå°†æŠ½è±¡çš„æ¡ä»¶è½¬åŒ–ä¸ºå…·ä½“çš„é¡ºåºã€‚


### 2. éš¾ç‚¹2ï¼šå¦‚ä½•è®¾è®¡åŠ¨æ€è§„åˆ’çš„çŠ¶æ€ä¸è½¬ç§»æ–¹ç¨‹ï¼Ÿ  
* **åˆ†æ**ï¼š  
  çŠ¶æ€è®¾è®¡çš„æ ¸å¿ƒæ˜¯**è®°å½•æ¯ä¸ªç‚¹ä½œä¸ºè·¯å¾„ç»ˆç‚¹çš„æœ€å¤§æƒå€¼å’Œ**ã€‚å¯¹äºå·¦è¾¹ç‚¹iï¼Œ`f[i]`è¡¨ç¤ºä»¥iç»“å°¾çš„è·¯å¾„çš„æœ€å¤§æƒå€¼å’Œï¼›å¯¹äºå³è¾¹ç‚¹jï¼Œ`g[j]`è¡¨ç¤ºä»¥jç»“å°¾çš„è·¯å¾„çš„æœ€å¤§æƒå€¼å’Œã€‚  
  è½¬ç§»æ–¹ç¨‹çš„é€»è¾‘æ˜¯**é€šè¿‡è¾¹è¿æ¥å·¦å³å²¸**ï¼šå½“å¤„ç†è¾¹(a,b)æ—¶ï¼Œ`g[b]`å¯ä»¥æ›´æ–°ä¸º`f[a] + å³è¾¹ç‚¹bçš„æƒå€¼`ï¼ˆä»å·¦è¾¹aèµ°åˆ°å³è¾¹bï¼‰ï¼›`f[a]`å¯ä»¥æ›´æ–°ä¸º`g[b] + å·¦è¾¹ç‚¹açš„æƒå€¼`ï¼ˆä»å³è¾¹bèµ°å›å·¦è¾¹aï¼‰ã€‚  
* ğŸ’¡ **å­¦ä¹ ç¬”è®°**ï¼šçŠ¶æ€è®¾è®¡è¦â€œèšç„¦ç»ˆç‚¹â€ï¼Œè½¬ç§»æ–¹ç¨‹è¦â€œè¿æ¥ä¸¤è¾¹â€ã€‚


### 3. éš¾ç‚¹3ï¼šå¦‚ä½•å¤„ç†â€œæ²¡æœ‰è¾¹â€çš„è¾¹ç•Œæƒ…å†µï¼Ÿ  
* **åˆ†æ**ï¼š  
  è‹¥æ²¡æœ‰è¾¹ï¼ˆR=0ï¼‰ï¼Œåˆ™æœ€å¤§æƒå€¼å’Œå°±æ˜¯æ‰€æœ‰ç‚¹ä¸­çš„æœ€å¤§å€¼ã€‚å› æ­¤ï¼Œåˆå§‹åŒ–æ—¶éœ€è¦å°†`f[i]`ï¼ˆå·¦è¾¹ç‚¹içš„æƒå€¼ï¼‰å’Œ`g[j]`ï¼ˆå³è¾¹ç‚¹jçš„æƒå€¼ï¼‰è®¾ä¸ºç‚¹æƒå€¼ï¼Œå¹¶è®°å½•å…¨å±€æœ€å¤§å€¼ã€‚  
* ğŸ’¡ **å­¦ä¹ ç¬”è®°**ï¼šè¾¹ç•Œæƒ…å†µæ˜¯ç®—æ³•çš„â€œå®‰å…¨ç»³â€ï¼Œå¿…é¡»æå‰è€ƒè™‘ã€‚


### âœ¨ è§£é¢˜æŠ€å·§æ€»ç»“  
- **æ’åºè½¬åŒ–æ¡ä»¶**ï¼šå°†â€œä¸äº¤å‰â€è½¬åŒ–ä¸ºâ€œæ’åºè¾¹â€ï¼Œæ˜¯è§£å†³æ­¤ç±»é—®é¢˜çš„é€šç”¨æŠ€å·§ï¼›  
- **çŠ¶æ€èšç„¦ç»ˆç‚¹**ï¼šåŠ¨æ€è§„åˆ’çš„çŠ¶æ€åº”è®°å½•â€œä»¥æŸä¸ªç‚¹ç»“å°¾çš„æœ€å¤§/æœ€å°å€¼â€ï¼Œä¾¿äºè½¬ç§»ï¼›  
- **è¾¹ç•Œæå‰å¤„ç†**ï¼šåˆå§‹åŒ–æ—¶è€ƒè™‘â€œæ²¡æœ‰è¾¹â€â€œå•ä¸€ç‚¹â€ç­‰æƒ…å†µï¼Œé¿å…é—æ¼ã€‚


## 4. C++æ ¸å¿ƒä»£ç å®ç°èµæ

### æœ¬é¢˜é€šç”¨æ ¸å¿ƒC++å®ç°å‚è€ƒ  
* **è¯´æ˜**ï¼šç»¼åˆæ»‘ä¸æ‹‰ç¨½å’Œzx2003çš„é¢˜è§£æ€è·¯ï¼Œæç‚¼å‡ºæ¸…æ™°ã€å®Œæ•´çš„æ ¸å¿ƒå®ç°ã€‚  
* **å®Œæ•´æ ¸å¿ƒä»£ç **ï¼š  
  ```cpp
  #include <iostream>
  #include <vector>
  #include <algorithm>
  using namespace std;
  typedef long long ll;

  const int N = 4e4 + 10;
  const int M = 1e5 + 10;

  ll f[N][2]; // f[i][0]: å·¦è¾¹ç¬¬iç‚¹çš„æœ€å¤§å’Œï¼›f[i][1]: å³è¾¹ç¬¬iç‚¹çš„æœ€å¤§å’Œ
  ll val[N][2]; // val[i][0]: å·¦è¾¹ç¬¬iç‚¹çš„æƒå€¼ï¼›val[i][1]: å³è¾¹ç¬¬iç‚¹çš„æƒå€¼
  pair<int, int> e[M]; // è¾¹ï¼š(å·¦è¾¹ç‚¹ï¼Œå³è¾¹ç‚¹)

  int main() {
      int n, m, R;
      cin >> n >> m >> R;
      ll ans = 0;

      // è¯»å–å·¦è¾¹ç‚¹æƒå€¼ï¼Œåˆå§‹åŒ–f[i][0]
      for (int i = 1; i <= n; ++i) {
          cin >> val[i][0];
          f[i][0] = val[i][0];
          ans = max(ans, f[i][0]);
      }

      // è¯»å–å³è¾¹ç‚¹æƒå€¼ï¼Œåˆå§‹åŒ–f[i][1]
      for (int i = 1; i <= m; ++i) {
          cin >> val[i][1];
          f[i][1] = val[i][1];
          ans = max(ans, f[i][1]);
      }

      // è¯»å–è¾¹
      for (int i = 1; i <= R; ++i) {
          cin >> e[i].first >> e[i].second;
      }

      // æŒ‰å·¦ç«¯ç‚¹é€’å¢ã€å³ç«¯ç‚¹é€’å¢æ’åº
      sort(e + 1, e + R + 1);

      // åŠ¨æ€è§„åˆ’è½¬ç§»
      for (int i = 1; i <= R; ++i) {
          int x = e[i].first; // å·¦è¾¹ç‚¹
          int y = e[i].second; // å³è¾¹ç‚¹
          ll tmp_g = f[y][1]; // ä¿å­˜å½“å‰å³è¾¹ç‚¹çš„æœ€å¤§å’Œï¼ˆé¿å…è¦†ç›–ï¼‰

          // æ›´æ–°å³è¾¹ç‚¹yçš„æœ€å¤§å’Œï¼šä»å·¦è¾¹xèµ°åˆ°å³è¾¹y
          f[y][1] = max(f[y][1], f[x][0] + val[y][1]);
          // æ›´æ–°å·¦è¾¹ç‚¹xçš„æœ€å¤§å’Œï¼šä»å³è¾¹yèµ°å›å·¦è¾¹x
          f[x][0] = max(f[x][0], tmp_g + val[x][0]);

          // æ›´æ–°å…¨å±€æœ€å¤§å€¼
          ans = max(ans, max(f[x][0], f[y][1]));
      }

      cout << ans << endl;
      return 0;
  }
  ```  
* **ä»£ç è§£è¯»æ¦‚è¦**ï¼š  
  ä»£ç åˆ†ä¸ºå››éƒ¨åˆ†ï¼š  
  1. **è¾“å…¥å¤„ç†**ï¼šè¯»å–å·¦å³å²¸ç‚¹çš„æƒå€¼å’Œè¾¹ï¼›  
  2. **åˆå§‹åŒ–**ï¼šå°†`f[i][0/1]`è®¾ä¸ºç‚¹æƒå€¼ï¼Œè®°å½•å…¨å±€æœ€å¤§å€¼ï¼›  
  3. **æ’åºè¾¹**ï¼šæŒ‰å·¦ç«¯ç‚¹å’Œå³ç«¯ç‚¹é€’å¢æ’åºï¼›  
  4. **åŠ¨æ€è§„åˆ’è½¬ç§»**ï¼šéå†æ¯æ¡è¾¹ï¼Œæ›´æ–°å·¦å³ç‚¹çš„æœ€å¤§å’Œï¼Œå¹¶æ›´æ–°å…¨å±€æœ€å¤§å€¼ã€‚


### é’ˆå¯¹å„ä¼˜è´¨é¢˜è§£çš„ç‰‡æ®µèµæ

#### é¢˜è§£ä¸€ï¼ˆä½œè€…ï¼šzx2003ï¼‰  
* **äº®ç‚¹**ï¼šå¤„ç†é‡å¤è¾¹ï¼Œé¿å…é‡å¤è®¡ç®—ã€‚  
* **æ ¸å¿ƒä»£ç ç‰‡æ®µ**ï¼š  
  ```cpp
  for (i = 2; i <= r; ++i) {
      if (a[i] == a[i-1]) continue; // è·³è¿‡é‡å¤è¾¹
      x = fl[a[i].l];
      y = fr[a[i].r];
      u = dl[a[i].l];
      v = dr[a[i].r];
      if (x == 0) fr[a[i].r] = max(fr[a[i].r], u + v);
      else fr[a[i].r] = max(fr[a[i].r], x + v);
      if (y == 0) fl[a[i].l] = max(fl[a[i].l], u + v);
      else fl[a[i].l] = max(fl[a[i].l], y + u);
  }
  ```  
* **ä»£ç è§£è¯»**ï¼š  
  ä½œè€…ç”¨`a[i] == a[i-1]`åˆ¤æ–­é‡å¤è¾¹ï¼Œè·³è¿‡é‡å¤å¤„ç†ã€‚`x`å’Œ`y`ä¿å­˜å½“å‰è¾¹å·¦å³ç‚¹çš„æœ€å¤§å’Œï¼Œ`u`å’Œ`v`ä¿å­˜ç‚¹æƒå€¼ã€‚é€šè¿‡`if (x == 0)`åˆ¤æ–­æ˜¯å¦æ˜¯ç¬¬ä¸€æ¬¡æ›´æ–°ï¼ˆé¿å…åˆå§‹å€¼ä¸º0çš„å½±å“ï¼‰ï¼Œç„¶åæ›´æ–°`fr`ï¼ˆå³è¾¹ç‚¹çš„æœ€å¤§å’Œï¼‰å’Œ`fl`ï¼ˆå·¦è¾¹ç‚¹çš„æœ€å¤§å’Œï¼‰ã€‚  
* ğŸ’¡ **å­¦ä¹ ç¬”è®°**ï¼šé‡å¤è¾¹ä¼šå¯¼è‡´é‡å¤è®¡ç®—ï¼Œè·³è¿‡å®ƒä»¬å¯ä»¥æå‡æ•ˆç‡ã€‚


#### é¢˜è§£äºŒï¼ˆä½œè€…ï¼šæ»‘ä¸æ‹‰ç¨½ï¼‰  
* **äº®ç‚¹**ï¼šç”¨äºŒç»´æ•°ç»„åˆå¹¶å·¦å³ç‚¹çš„æœ€å¤§å’Œï¼Œä»£ç ç®€æ´ã€‚  
* **æ ¸å¿ƒä»£ç ç‰‡æ®µ**ï¼š  
  ```cpp
  for (re i = 1; i <= q; ++i) {
      int x = e[i].first, y = e[i].second, tmp = f[y][1];
      f[y][1] = max(f[y][1], f[x][0] + val[y][1]);
      f[x][0] = max(f[x][0], tmp + val[x][0]);
  }
  ```  
* **ä»£ç è§£è¯»**ï¼š  
  ä½œè€…ç”¨`f[y][1]`è¡¨ç¤ºå³è¾¹ç‚¹yçš„æœ€å¤§å’Œï¼Œ`f[x][0]`è¡¨ç¤ºå·¦è¾¹ç‚¹xçš„æœ€å¤§å’Œã€‚`tmp`ä¿å­˜å½“å‰å³è¾¹ç‚¹yçš„æœ€å¤§å’Œï¼ˆé¿å…è¦†ç›–ï¼‰ï¼Œç„¶åé€šè¿‡`max`å‡½æ•°æ›´æ–°`f[y][1]`ï¼ˆä»å·¦è¾¹xèµ°åˆ°å³è¾¹yï¼‰å’Œ`f[x][0]`ï¼ˆä»å³è¾¹yèµ°å›å·¦è¾¹xï¼‰ã€‚  
* ğŸ’¡ **å­¦ä¹ ç¬”è®°**ï¼šäºŒç»´æ•°ç»„å¯ä»¥åˆå¹¶ç›¸ä¼¼çš„å˜é‡ï¼Œä½¿ä»£ç æ›´ç®€æ´ã€‚


## 5. ç®—æ³•å¯è§†åŒ–ï¼šåƒç´ åŠ¨ç”»æ¼”ç¤º (æ ¸å¿ƒéƒ¨åˆ†)

### ğŸ® åŠ¨ç”»æ¼”ç¤ºä¸»é¢˜ï¼šã€Šåƒç´ æ¢é™©å®¶çš„ä¸äº¤å‰è·¯å¾„ã€‹  
**é£æ ¼**ï¼š8ä½FCçº¢ç™½æœºé£æ ¼ï¼Œå·¦å³å²¸ç”¨è“è‰²ï¼ˆå·¦è¾¹ï¼‰å’Œçº¢è‰²ï¼ˆå³è¾¹ï¼‰åƒç´ ç‚¹è¡¨ç¤ºï¼Œè¾¹ç”¨é»„è‰²çº¿æ¡è¿æ¥ï¼Œæƒå€¼ç”¨ç™½è‰²æ•°å­—æ ‡æ³¨ã€‚  
**æ ¸å¿ƒæ¼”ç¤ºå†…å®¹**ï¼šæ¨¡æ‹Ÿè¾¹æ’åºåçš„åŠ¨æ€è§„åˆ’è½¬ç§»è¿‡ç¨‹ï¼Œå±•ç¤ºâ€œä¸äº¤å‰è·¯å¾„â€çš„æ„å»ºå’Œæƒå€¼å’Œçš„æ›´æ–°ã€‚


### ğŸ“ åŠ¨ç”»å¸§æ­¥éª¤ä¸äº¤äº’è®¾è®¡  
1. **åœºæ™¯åˆå§‹åŒ–**ï¼š  
   - å±å¹•å·¦ä¾§æ˜¾ç¤ºè“è‰²åƒç´ ç‚¹ï¼ˆå·¦è¾¹ç‚¹1~nï¼‰ï¼Œå³ä¾§æ˜¾ç¤ºçº¢è‰²åƒç´ ç‚¹ï¼ˆå³è¾¹ç‚¹1~mï¼‰ï¼Œæ¯ä¸ªç‚¹ä¸‹æ–¹æ ‡æ³¨æƒå€¼ï¼›  
   - å±å¹•ä¸‹æ–¹æœ‰â€œå¼€å§‹/æš‚åœâ€â€œå•æ­¥æ‰§è¡Œâ€â€œé‡ç½®â€æŒ‰é’®ï¼Œä»¥åŠé€Ÿåº¦æ»‘å—ï¼ˆ1~5å€é€Ÿï¼‰ï¼›  
   - èƒŒæ™¯æ’­æ”¾8ä½é£æ ¼çš„è½»å¿«BGMï¼ˆå¦‚ã€Šè¶…çº§é©¬é‡Œå¥¥ã€‹çš„èƒŒæ™¯éŸ³ä¹ï¼‰ã€‚  

2. **è¾¹æ’åºåŠ¨ç”»**ï¼š  
   - æ‰€æœ‰è¾¹ï¼ˆé»„è‰²çº¿æ¡ï¼‰ä»å±å¹•ä¸Šæ–¹è½ä¸‹ï¼ŒæŒ‰å·¦ç«¯ç‚¹é€’å¢ã€å³ç«¯ç‚¹é€’å¢çš„é¡ºåºæ’åˆ—ï¼ˆæ¯”å¦‚ï¼Œè¾¹(1,1)æ’åœ¨æœ€å‰é¢ï¼Œè¾¹(3,2)æ’åœ¨æœ€åé¢ï¼‰ï¼›  
   - æ’åºå®Œæˆåï¼Œè¾¹æŒ‰é¡ºåºæ’åˆ—åœ¨å±å¹•ä¸­é—´ã€‚  

3. **åŠ¨æ€è§„åˆ’è½¬ç§»æ¼”ç¤º**ï¼š  
   - **å•æ­¥æ‰§è¡Œ**ï¼šç‚¹å‡»â€œå•æ­¥â€æŒ‰é’®ï¼Œå¤„ç†ä¸‹ä¸€æ¡è¾¹ï¼ˆå½“å‰è¾¹é—ªçƒé»„è‰²ï¼‰ï¼›  
   - **æƒå€¼æ›´æ–°**ï¼šå¤„ç†è¾¹(a,b)æ—¶ï¼Œå·¦è¾¹ç‚¹aï¼ˆè“è‰²ï¼‰å’Œå³è¾¹ç‚¹bï¼ˆçº¢è‰²ï¼‰é—ªçƒï¼ŒåŒæ—¶æ˜¾ç¤ºâ€œ+xâ€çš„åŠ¨ç”»ï¼ˆxä¸ºæ–°å¢çš„æƒå€¼ï¼‰ï¼›  
   - **éŸ³æ•ˆæç¤º**ï¼šå¤„ç†è¾¹æ—¶æ’­æ”¾â€œå®â€çš„åƒç´ å£°ï¼Œæ›´æ–°æƒå€¼æ—¶æ’­æ”¾â€œå—¡â€çš„æç¤ºå£°ï¼›  
   - **å…¨å±€æœ€å¤§å€¼æ˜¾ç¤º**ï¼šå±å¹•å³ä¸Šè§’å®æ—¶æ˜¾ç¤ºå½“å‰çš„æœ€å¤§æƒå€¼å’Œï¼ˆç”¨ç»¿è‰²æ•°å­—æ ‡æ³¨ï¼‰ã€‚  

4. **ç›®æ ‡è¾¾æˆ**ï¼š  
   - å½“æ‰€æœ‰è¾¹å¤„ç†å®Œæ¯•ï¼Œæœ€å¤§æƒå€¼å’Œçš„ç‚¹ï¼ˆæ¯”å¦‚å·¦è¾¹ç‚¹3ï¼‰é—ªçƒç»¿è‰²ï¼Œæ’­æ”¾â€œèƒœåˆ©â€éŸ³æ•ˆï¼ˆå¦‚ã€Šé­‚æ–—ç½—ã€‹çš„é€šå…³éŸ³ä¹ï¼‰ï¼›  
   - è‹¥æ²¡æœ‰è¾¹ï¼Œç›´æ¥æ˜¾ç¤ºæœ€å¤§æƒå€¼çš„ç‚¹ï¼ˆæ¯”å¦‚å·¦è¾¹ç‚¹3ï¼Œæƒå€¼5ï¼‰ã€‚  

5. **äº¤äº’æ§åˆ¶**ï¼š  
   - â€œè‡ªåŠ¨æ’­æ”¾â€ï¼šæŒ‰è®¾ç½®çš„é€Ÿåº¦ï¼ˆ1~5å€é€Ÿï¼‰è‡ªåŠ¨å¤„ç†è¾¹ï¼›  
   - â€œé‡ç½®â€ï¼šæ¢å¤åˆå§‹çŠ¶æ€ï¼Œé‡æ–°å¼€å§‹æ¼”ç¤ºã€‚


### ğŸ§  è®¾è®¡æ€è·¯  
- **åƒç´ é£æ ¼**ï¼šæ¨¡æ‹Ÿç»å…¸æ¸¸æˆç”»é¢ï¼Œé™ä½å­¦ä¹ å‹åŠ›ï¼Œå¢å¼ºè¶£å‘³æ€§ï¼›  
- **é«˜äº®ä¸åŠ¨ç”»**ï¼šé€šè¿‡é—ªçƒã€â€œ+xâ€åŠ¨ç”»çªå‡ºå…³é”®æ­¥éª¤ï¼ˆè¾¹å¤„ç†ã€æƒå€¼æ›´æ–°ï¼‰ï¼Œå¸®åŠ©ç†è§£ï¼›  
- **éŸ³æ•ˆ**ï¼šç”¨ç†Ÿæ‚‰çš„æ¸¸æˆéŸ³æ•ˆå¢å¼ºè®°å¿†ç‚¹ï¼ˆæ¯”å¦‚â€œå®â€å¯¹åº”è¾¹å¤„ç†ï¼Œâ€œå—¡â€å¯¹åº”æƒå€¼æ›´æ–°ï¼‰ï¼›  
- **äº¤äº’**ï¼šå•æ­¥æ‰§è¡Œå’Œè‡ªåŠ¨æ’­æ”¾ç»“åˆï¼Œæ»¡è¶³ä¸åŒå­¦ä¹ èŠ‚å¥ï¼ˆåˆå­¦è€…å¯ä»¥æ…¢ä¸‹æ¥çœ‹æ¯ä¸€æ­¥ï¼Œè¿›é˜¶è€…å¯ä»¥å¿«é€Ÿè¿‡æµç¨‹ï¼‰ã€‚


## 6. æ‹“å±•ç»ƒä¹ ä¸ç›¸ä¼¼é—®é¢˜æ€è€ƒ

### ğŸš€ é€šç”¨æ€è·¯/æŠ€å·§è¿ç§»  
æœ¬é¢˜çš„**â€œæ’åº+åŠ¨æ€è§„åˆ’â€**æ€è·¯å¯ä»¥è¿ç§»åˆ°ä»¥ä¸‹åœºæ™¯ï¼š  
1. **æœ€é•¿é€’å¢å­åºåˆ—ï¼ˆLISï¼‰**ï¼šæ’åºåï¼Œç”¨åŠ¨æ€è§„åˆ’è®°å½•æ¯ä¸ªä½ç½®çš„æœ€é•¿å­åºåˆ—é•¿åº¦ï¼›  
2. **äºŒç»´ååºé—®é¢˜**ï¼šæ¯”å¦‚â€œæ‰¾åˆ°æ‰€æœ‰æ»¡è¶³a_i < a_jä¸”b_i < b_jçš„ pairsâ€ï¼Œæ’åºåç”¨åŠ¨æ€è§„åˆ’å¤„ç†ï¼›  
3. **è·¯å¾„è§„åˆ’é—®é¢˜**ï¼šæ¯”å¦‚â€œåœ¨ç½‘æ ¼ä¸­æ‰¾åˆ°ä¸äº¤å‰çš„è·¯å¾„ï¼Œä½¿å¾—è·¯å¾„å’Œæœ€å¤§â€ï¼Œæ’åºåç”¨åŠ¨æ€è§„åˆ’è½¬ç§»ã€‚


### ğŸ“š ç»ƒä¹ æ¨è (æ´›è°·)  
1. **æ´›è°· P3077** - [USACO13FEB] Route Design G  
   * ğŸ—£ï¸ **æ¨èç†ç”±**ï¼šåŸé¢˜é‡ç°ï¼Œå·©å›ºâ€œæ’åº+åŠ¨æ€è§„åˆ’â€çš„åº”ç”¨ï¼Œç†Ÿæ‚‰è¾¹ç•Œå¤„ç†ã€‚  
2. **æ´›è°· P1091** - åˆå”±é˜Ÿå½¢  
   * ğŸ—£ï¸ **æ¨èç†ç”±**ï¼šç±»ä¼¼çš„åŠ¨æ€è§„åˆ’é—®é¢˜ï¼Œéœ€è¦æ‰¾åˆ°æœ€é•¿é€’å¢å­åºåˆ—å’Œæœ€é•¿é€’å‡å­åºåˆ—ï¼Œé”»ç‚¼çŠ¶æ€è®¾è®¡èƒ½åŠ›ã€‚  
3. **æ´›è°· P2501** - [HAOI2006]æ•°å­—åºåˆ—  
   * ğŸ—£ï¸ **æ¨èç†ç”±**ï¼šåŠ¨æ€è§„åˆ’ç»“åˆæ’åºï¼Œå¤„ç†åºåˆ—çš„æœ€å°ä¿®æ”¹é—®é¢˜ï¼Œæå‡ç»¼åˆåº”ç”¨èƒ½åŠ›ã€‚


## 7. å­¦ä¹ å¿ƒå¾—ä¸ç»éªŒåˆ†äº« (è‹¥æœ‰)  
æœ¬æ¬¡åˆ†æçš„é¢˜è§£ä¸­ï¼Œ**zx2003**æåˆ°â€œè·³è¿‡é‡å¤è¾¹â€çš„å¤„ç†ï¼Œè¿™æ˜¯ä¸€ä¸ªå®¹æ˜“å¿½ç•¥çš„ç»†èŠ‚ã€‚é‡å¤è¾¹ä¼šå¯¼è‡´ç›¸åŒçš„è½¬ç§»å¤šæ¬¡æ‰§è¡Œï¼Œæµªè´¹æ—¶é—´ä¸”å¯èƒ½å¯¼è‡´é”™è¯¯ï¼ˆæ¯”å¦‚é‡å¤è®¡ç®—æƒå€¼å’Œï¼‰ã€‚é€šè¿‡`if (a[i] == a[i-1]) continue`è·³è¿‡é‡å¤è¾¹ï¼Œä¸ä»…æå‡äº†æ•ˆç‡ï¼Œè¿˜ä¿è¯äº†è½¬ç§»çš„æ­£ç¡®æ€§ã€‚  

**ç‚¹è¯„**ï¼šåœ¨ç¼–ç¨‹ä¸­ï¼Œ**å¤„ç†é‡å¤æ•°æ®**æ˜¯ä¸€ä¸ªå¸¸è§çš„æŠ€å·§ï¼Œæ¯”å¦‚æ’åºåçš„å»é‡ã€è·³è¿‡é‡å¤çš„è¾“å…¥ç­‰ã€‚è¿™ä¸ªç»éªŒæé†’æˆ‘ä»¬ï¼Œåœ¨å†™ä»£ç æ—¶è¦æ³¨æ„â€œé¿å…é‡å¤è®¡ç®—â€ï¼Œè¿™æ ·å¯ä»¥è®©ä»£ç æ›´é«˜æ•ˆã€æ›´ä¸¥è°¨ã€‚


## ğŸ‰ æ€»ç»“  
æœ¬æ¬¡å…³äºâ€œ[USACO13FEB] Route Design Gâ€çš„åˆ†æï¼Œæˆ‘ä»¬å­¦ä¹ äº†**åŠ¨æ€è§„åˆ’ç»“åˆæ’åº**çš„è§£é¢˜æ€è·¯ï¼ŒæŒæ¡äº†â€œä¸äº¤å‰â€æ¡ä»¶çš„è½¬åŒ–ã€çŠ¶æ€è®¾è®¡ä¸è½¬ç§»æ–¹ç¨‹çš„ç¼–å†™ã€‚é€šè¿‡åƒç´ åŠ¨ç”»æ¼”ç¤ºï¼Œæˆ‘ä»¬æ›´ç›´è§‚åœ°ç†è§£äº†ç®—æ³•çš„æ‰§è¡Œè¿‡ç¨‹ï¼›é€šè¿‡æ‹“å±•ç»ƒä¹ ï¼Œæˆ‘ä»¬å¯ä»¥å°†æŠ€å·§è¿ç§»åˆ°æ›´å¤šé—®é¢˜ä¸­ã€‚  

è®°ä½ï¼Œ**ç¼–ç¨‹çš„æœ¬è´¨æ˜¯è§£å†³é—®é¢˜**â€”â€”å°†æŠ½è±¡çš„é—®é¢˜è½¬åŒ–ä¸ºå…·ä½“çš„æ­¥éª¤ï¼Œç”¨ä»£ç å®ç°é€»è¾‘ã€‚åªè¦å¤šæ€è€ƒã€å¤šç»ƒä¹ ï¼Œä½ ä¸€å®šèƒ½æŒæ¡æ›´å¤šç®—æ³•æŠ€å·§ï¼ğŸ’ª  

ä¸‹æ¬¡æˆ‘ä»¬å†ä¸€èµ·æ¢ç´¢æ–°çš„ç¼–ç¨‹æŒ‘æˆ˜ï¼ğŸ‘‹

---
å¤„ç†ç”¨æ—¶ï¼š181.15ç§’
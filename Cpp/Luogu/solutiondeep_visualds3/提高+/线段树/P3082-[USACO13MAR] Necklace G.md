# é¢˜ç›®ä¿¡æ¯

# [USACO13MAR] Necklace G

## é¢˜ç›®æè¿°

Bessie the cow has arranged a string of N rocks, each containing a single letter of the alphabet, that she wants to build into a fashionable necklace.

Being protective of her belongings, Bessie does not want to share her necklace with the other cow currently living on her side of the barn.  The other cow has a name that is a string of M characters, and Bessie wants to be sure that this length-M string does not occur as a contiguous substring anywhere within the string representing her necklace (otherwise, the other cow might mistakenly think the necklace is for her).  Bessie decides to remove some of the rocks in her necklace so that the other cow's name does not appear as a substring.  Please help Bessie determine the minimum number of rocks she must remove.

è´è¥¿æ”¶é›†äº†Né¢—çŸ³å¤´ï¼Œæ¯é¢—çŸ³å¤´ä¸Šéƒ½æœ‰ä¸€ä¸ªå­—æ¯ï¼Œè´è¥¿æƒ³æŠŠè¿™äº›çŸ³å¤´åšæˆé¡¹é“¾ã€‚

è´è¥¿çš„èº«è¾¹æœ‰å¦ä¸€åªå¥¶ç‰›ï¼Œè¿™åªå¥¶ç‰›çš„åå­—æ˜¯ä¸€ä¸ªé•¿åº¦ä¸ºMçš„å­—ç¬¦ä¸²ï¼Œè´è¥¿ä¸å¸Œæœ›è¿™åªç‰›çš„åå­—å‡ºç°åœ¨å¥¹çš„é¡¹é“¾ä¸Š(é¡¹é“¾çš„å­ä¸²)ï¼Œå¥¹æƒ³çŸ¥é“ï¼Œæœ€å°‘åˆ æ‰å‡ é¢—çŸ³å¤´å°±å¯ä»¥é¿å…è¿™ç§æƒ…å†µå‘ç”Ÿã€‚


## è¯´æ˜/æç¤º

```cpp
For at least 20% of test cases, N <= 20. 
For at least 60% of test cases, N <= 1000, M <= 100. 
For all test cases, N <= 10000, M <= 1000. 
For all test cases, M <= N. 
```
The modified necklace should be "abbaa".

---

$\text{upd 2022.7.29}$ï¼šæ–°å¢åŠ ä¸€ç»„ Hack æ•°æ®ã€‚

## æ ·ä¾‹ #1

### è¾“å…¥

```
ababaa 
aba 
```

### è¾“å‡º

```
1 
```

# AIåˆ†æç»“æœ


### ğŸ’¡ Kayçš„C++ç®—æ³•è§£æï¼š[USACO13MAR] Necklace G æ·±å…¥å­¦ä¹ æŒ‡å— ğŸ’¡

#### 1. é¢˜ç›®è§£è¯»ä¸æ ¸å¿ƒç®—æ³•è¯†åˆ«
âœ¨ **æœ¬é¢˜ä¸»è¦è€ƒå¯Ÿ**ï¼š`å­—ç¬¦ä¸²åŒ¹é… + åŠ¨æ€è§„åˆ’`  
ğŸ—£ï¸ **åˆæ­¥åˆ†æ**ï¼š
> æƒ³è±¡ä½ åœ¨æ‹¼çç é¡¹é“¾ï¼ˆæ¯é¢—çç æœ‰å­—æ¯ï¼‰ï¼Œéœ€ç§»é™¤æœ€å°‘çç é¿å…å‡ºç°ç‰¹å®šå•è¯ï¼ˆå¥¶ç‰›åï¼‰ã€‚æ ¸å¿ƒæ€è·¯æ˜¯ï¼š  
> 1. ç”¨åŠ¨æ€è§„åˆ’è®°å½•åŒ¹é…çŠ¶æ€ï¼š`f[i][j]` è¡¨ç¤ºå¤„ç†å‰`i`ä¸ªå­—ç¬¦åï¼Œå½“å‰åŒ¹é…å¥¶ç‰›åå‰`j`ä¸ªå­—ç¬¦æ—¶æœ€å¤šèƒ½ä¿ç•™çš„å­—ç¬¦æ•°  
> 2. ç”¨KMPåŠ é€Ÿè½¬ç§»ï¼šé¢„å¤„ç†`g[j][c]`è¡¨ç¤ºåŒ¹é…åˆ°ä½ç½®`j`æ—¶é‡åˆ°å­—ç¬¦`c`åè·³è½¬çš„æ–°ä½ç½®  
> 3. å¯è§†åŒ–è®¾è®¡ï¼šåœ¨åƒç´ åŠ¨ç”»ä¸­ç”¨é¢œè‰²æ ‡è®°åŒ¹é…è¿›åº¦ï¼ˆç»¿è‰²=å®‰å…¨åŒ¹é…ï¼Œçº¢è‰²=å±é™©åŒºï¼‰ï¼Œåˆ é™¤å­—ç¬¦æ—¶çç "ç¢è£‚"ç‰¹æ•ˆï¼ŒåŒ¹é…æˆåŠŸæ—¶æ’­æ”¾èƒœåˆ©éŸ³æ•ˆ  

#### 2. ç²¾é€‰ä¼˜è´¨é¢˜è§£å‚è€ƒ
**é¢˜è§£ä¸€ï¼ˆä½œè€…ï¼šzhaoypï¼‰**  
* **ç‚¹è¯„**ï¼šæ€è·¯æ¸…æ™°è½¬åŒ–é—®é¢˜ä¸º"æœ€å¤§ä¿ç•™å­—ç¬¦æ•°"ï¼ŒKMPé¢„å¤„ç†`g`æ•°ç»„çš„é€»è¾‘ä¸¥è°¨ï¼›ä»£ç ä¸­`f[i+1][g[j][c]]=max(f[i][j]+1)`çš„è½¬ç§»ç›´å‡»æ ¸å¿ƒï¼›å˜é‡å‘½åè§„èŒƒï¼ˆ`g`=è·³è½¬å‡½æ•°ï¼Œ`f`=DPçŠ¶æ€ï¼‰ï¼Œè¾¹ç•Œå¤„ç†å®Œæ•´ï¼›æ˜¯ç«èµ›æ ‡å‡†å®ç°  

**é¢˜è§£äºŒï¼ˆä½œè€…ï¼šèˆ¹é…±é­”ç‹ï¼‰**  
* **ç‚¹è¯„**ï¼šçŠ¶æ€è®¾è®¡`dp[i][j]`è¡¨ç¤ºæœ€å°åˆ é™¤æ¬¡æ•°ï¼Œè§’åº¦æ–°é¢–ï¼›ä¸»åŠ¨è½¬ç§»(`dp[i+1][j]=min(dp[i][j]+1)`)ä½“ç°DPç²¾é«“ï¼›KMPå°è£…æˆ`findnxt`å‡½æ•°å¢å¼ºå¯è¯»æ€§ï¼›å›¾è§£è¾…åŠ©ç†è§£åŒ¹é…è¿‡ç¨‹ï¼Œæ•™å­¦ä»·å€¼çªå‡º  

**é¢˜è§£ä¸‰ï¼ˆä½œè€…ï¼šlyhqwqï¼‰**  
* **ç‚¹è¯„**ï¼šå®ç°ç®€æ´é«˜æ•ˆï¼Œ23è¡Œå®Œæˆæ ¸å¿ƒé€»è¾‘ï¼›`to`æ•°ç»„é¢„å¤„ç†ä¸`getTo`å‡½æ•°ä½“ç°KMPæœ¬è´¨ï¼›`f[i][j]`çŠ¶æ€å®šä¹‰ä¸è½¬ç§»åŒæ­¥ç‡æœ€é«˜ï¼›é€‚åˆåˆå­¦è€…ç†è§£åŸºç¡€æ¡†æ¶  

#### 3. æ ¸å¿ƒéš¾ç‚¹è¾¨æä¸è§£é¢˜ç­–ç•¥
1. **çŠ¶æ€è®¾è®¡æŠ½è±¡**  
   *åˆ†æ*ï¼šéœ€å°†å­—ç¬¦ä¸²åŒ¹é…è¿›åº¦è½¬åŒ–ä¸ºDPçŠ¶æ€ç»´åº¦ã€‚ä¼˜è´¨é¢˜è§£ç”¨`j`è¡¨ç¤ºå½“å‰åŒ¹é…æ¨¡å¼ä¸²ä½ç½®ï¼Œé€šè¿‡`f[i][j]`è¿æ¥å­—ç¬¦å¤„ç†ä¸åŒ¹é…è¿›åº¦  
   ğŸ’¡ **å­¦ä¹ ç¬”è®°**ï¼šDPçŠ¶æ€=å½“å‰å¤„ç†ä½ç½®+åŒ¹é…è¿›åº¦æ„æˆçš„äºŒç»´ç©ºé—´  

2. **KMPè½¬ç§»ä¼˜åŒ–**  
   *åˆ†æ*ï¼šæš´åŠ›è®¡ç®—æ–°åŒ¹é…ä½ç½®å¤æ‚åº¦O(m)ã€‚é€šè¿‡é¢„å¤„ç†`g[j][c]`ï¼ˆåŒ¹é…åˆ°`j`æ—¶é‡åˆ°å­—ç¬¦`c`çš„è·³è½¬ä½ç½®ï¼‰ï¼Œè½¬ç§»é™è‡³O(1)  
   ğŸ’¡ **å­¦ä¹ ç¬”è®°**ï¼šKMPçš„`next`æ•°ç»„æœ¬è´¨æ˜¯çŠ¶æ€è½¬ç§»æœº  

3. **éæ³•çŠ¶æ€å¤„ç†**  
   *åˆ†æ*ï¼šå½“`j=m`æ—¶å®Œæ•´åŒ¹é…æ¨¡å¼ä¸²ï¼Œéœ€æ’é™¤ã€‚ä»£ç ä¸­é€šè¿‡`if(k!=m)`æ§åˆ¶è½¬ç§»ï¼Œç¡®ä¿çŠ¶æ€åˆæ³•  
   ğŸ’¡ **å­¦ä¹ ç¬”è®°**ï¼šDPéœ€æ˜ç¡®éæ³•çŠ¶æ€è¾¹ç•Œï¼Œå¦‚`j<m`  

âœ¨ **è§£é¢˜æŠ€å·§æ€»ç»“**  
- **é€†å‘æ€ç»´**ï¼šå°†"æœ€å°åˆ é™¤"è½¬åŒ–ä¸º"æœ€å¤§ä¿ç•™"ç®€åŒ–çŠ¶æ€è®¾è®¡  
- **åŒ¹é…çŠ¶æ€æœº**ï¼šç”¨KMPé¢„å¤„ç†å°†å­—ç¬¦ä¸²åŒ¹é…è½¬åŒ–ä¸ºO(1)çŠ¶æ€è½¬ç§»  
- **æ»šåŠ¨æ•°ç»„**ï¼š`f[i][j]`ä»…ä¾èµ–`f[i-1][k]`ï¼Œå¯ç”¨ä¸¤è¡Œæ•°ç»„ä¼˜åŒ–ç©ºé—´  

#### 4. C++æ ¸å¿ƒä»£ç å®ç°èµæ
**é€šç”¨æ ¸å¿ƒå®ç°**  
```cpp
#include <bits/stdc++.h>
using namespace std;
const int N=10005, M=1005;
char s[N], t[M];
int n, m, f[N][M], g[M][26], nxt[M];

void prep_kmp() {
    for(int i=2,j=0; i<=m; i++) {
        while(j && t[j+1]!=t[i]) j=nxt[j];
        nxt[i] = (t[j+1]==t[i]) ? ++j : 0;
    }
    for(int i=0; i<m; i++)
        for(int c=0; c<26; c++) {
            int j=i;
            while(j && t[j+1]!='a'+c) j=nxt[j];
            g[i][c] = (t[j+1]=='a'+c) ? j+1 : 0;
        }
}

int main() {
    scanf("%s%s", s+1, t+1);
    n=strlen(s+1), m=strlen(t+1);
    prep_kmp();
    memset(f, 0x80, sizeof(f)); // åˆå§‹åŒ–ä¸ºè´Ÿæ— ç©·
    f[0][0] = 0;
    
    for(int i=0; i<n; i++) {
        for(int j=0; j<m; j++) {
            int c = s[i+1]-'a';
            int k = g[j][c];
            if(k < m) f[i+1][k] = max(f[i+1][k], f[i][j]+1);
            f[i+1][j] = max(f[i+1][j], f[i][j]);
        }
    }
    int ans = 0;
    for(int j=0; j<m; j++) ans = max(ans, f[n][j]);
    cout << n - ans;
}
```
**ä»£ç è§£è¯»æ¦‚è¦**ï¼š  
1. `prep_kmp`é¢„å¤„ç†ï¼š`nxt`æ•°ç»„è®¡ç®—å‰ç¼€å‡½æ•°ï¼Œ`g`æ•°ç»„å­˜å‚¨çŠ¶æ€è½¬ç§»  
2. DPä¸‰å±‚å¾ªç¯ï¼šå¤–å±‚éå†å­—ç¬¦ä¸²ï¼Œä¸­å±‚éå†åŒ¹é…çŠ¶æ€ï¼Œå†…å±‚å†³ç­–ï¼ˆä¿ç•™/åˆ é™¤å­—ç¬¦ï¼‰  
3. çŠ¶æ€è½¬ç§»ï¼šä¿ç•™å­—ç¬¦æ—¶è·³è½¬åˆ°`g[j][c]`ï¼Œåˆ é™¤æ—¶ç›´æ¥ç»§æ‰¿çŠ¶æ€  

**é¢˜è§£ä¸€æ ¸å¿ƒç‰‡æ®µ**  
```cpp
f[i+1][g[j][a[i+1]-'a'+1]] = max(f[i+1][g[j][a[i+1]-'a'+1]], f[i][j]+1);
```
**äº®ç‚¹**ï¼šå•è¡Œå®ŒæˆKMPä¼˜åŒ–è½¬ç§»  
**è§£è¯»**ï¼š  
> å½“ä¿ç•™å­—ç¬¦`s[i+1]`æ—¶ï¼š  
> 1. è®¡ç®—æ–°çŠ¶æ€`k=g[j][c]`ï¼ˆä»ä½ç½®`j`é‡åˆ°å­—ç¬¦`c`çš„è·³è½¬ä½ç½®ï¼‰  
> 2. è‹¥`k<m`ï¼ˆæœªå½¢æˆå®Œæ•´åŒ¹é…ï¼‰ï¼Œåˆ™æ›´æ–°`f[i+1][k]`  
> 3. `+1`è¡¨ç¤ºä¿ç•™å­—ç¬¦è®¡æ•°å¢åŠ   

**é¢˜è§£äºŒæ ¸å¿ƒç‰‡æ®µ**  
```cpp
dp[i+1][j] = min(dp[i+1][j], dp[i][j]+1); // åˆ é™¤å­—ç¬¦
dp[i+1][g[j][c]] = min(dp[i+1][g[j][c]], dp[i][j]); // ä¿ç•™å­—ç¬¦
```
**äº®ç‚¹**ï¼šåŒè½¨åˆ¶è½¬ç§»ä½“ç°å†³ç­–åˆ†æ”¯  
**è§£è¯»**ï¼š  
> ä¸¤æ¡ç‹¬ç«‹è½¬ç§»è·¯å¾„ï¼š  
> - åˆ é™¤å­—ç¬¦ï¼šçŠ¶æ€`j`ä¸å˜ï¼Œåˆ é™¤æ•°`+1`  
> - ä¿ç•™å­—ç¬¦ï¼šçŠ¶æ€è·³è½¬åˆ°`g[j][c]`ï¼Œåˆ é™¤æ•°ä¸å˜  
> ç”¨`min`ä¿è¯å–æœ€ä¼˜è§£  

#### 5. ç®—æ³•å¯è§†åŒ–ï¼šåƒç´ åŠ¨ç”»æ¼”ç¤º
* **ä¸»é¢˜**ï¼š`çç é¡¹é“¾å¤§å†’é™©`ï¼ˆ8-bitåƒç´ é£æ ¼ï¼‰  
* **æ ¸å¿ƒæ¼”ç¤º**ï¼šDPçŠ¶æ€æœº + KMPåŒ¹é…è¿‡ç¨‹  
* **è®¾è®¡æ€è·¯**ï¼šç”¨FCæ¸¸æˆæœºé£æ ¼é™ä½ç®—æ³•ææƒ§æ„Ÿï¼Œé€šè¿‡éŸ³æ•ˆå¼ºåŒ–å…³é”®æ“ä½œè®°å¿†  

**åŠ¨ç”»å¸§æ­¥éª¤**ï¼š  
1. **åœºæ™¯åˆå§‹åŒ–**  
   - é¡¶éƒ¨ï¼šçç é¡¹é“¾ï¼ˆåƒç´ åŒ–å­—ç¬¦æ ¼å­ï¼Œä¸åŒé¢œè‰²åŒºåˆ†å­—æ¯ï¼‰  
   - ä¸­éƒ¨ï¼šå¥¶ç‰›åå­—ï¼ˆé—ªçƒæ˜¾ç¤ºï¼‰  
   - åº•éƒ¨ï¼šæ§åˆ¶é¢æ¿ï¼ˆå¼€å§‹/æ­¥è¿›/è°ƒé€Ÿ/é‡ç½®ï¼‰  

2. **å…³é”®æ“ä½œæ¼”ç¤º**  
   | æ“ä½œ | è§†è§‰åé¦ˆ | éŸ³æ•ˆ |  
   |---|---|---|  
   | ä¿ç•™å­—ç¬¦ | çç äº®é‡‘å…‰ â†’ æ˜¾ç¤ºæ–°åŒ¹é…é•¿åº¦ | "å®ï¼"ï¼ˆNESé‡‘å¸å£°ï¼‰ |  
   | åˆ é™¤å­—ç¬¦ | çç ç¢è£‚åŠ¨ç”» | "å’”åš“ï¼"ï¼ˆç»ç’ƒç ´ç¢ï¼‰ |  
   | åŒ¹é…è¿›åº¦æ›´æ–° | è¿›åº¦æ¡é¢œè‰²æ¸å˜ï¼ˆç»¿â†’é»„â†’çº¢ï¼‰ | éŸ³è°ƒæ¸é«˜ |  
   | å®Œæˆè§„é¿ | çƒŸèŠ±ç»½æ”¾ + "VICTORY!" | è¶…çº§ç›ä¸½è¿‡å…³éŸ³ä¹ |  

3. **AIæ¼”ç¤ºæ¨¡å¼**  
   - è‡ªåŠ¨æ’­æ”¾ï¼šçç é€ä¸ªç‚¹äº®/ç†„ç­ï¼ŒåŒ¹é…è¿›åº¦æ¡å®æ—¶å˜åŒ–  
   - è°ƒé€Ÿæ»‘å—ï¼šæ§åˆ¶æ¼”ç¤ºé€Ÿåº¦ï¼ˆ0.5x~5xï¼‰  

4. **è°ƒè¯•é¢æ¿**  
   - åŒæ­¥æ˜¾ç¤ºï¼šå½“å‰DPçŠ¶æ€è¡¨ï¼ˆ`i`,`j`,`f[i][j]`é«˜äº®ï¼‰  
   - ä¼ªä»£ç è·Ÿè¸ªï¼šæ‰§è¡Œåˆ°å¯¹åº”è¡Œæ—¶é—ªçƒè¾¹æ¡†  

#### 6. æ‹“å±•ç»ƒä¹ ä¸ç›¸ä¼¼é—®é¢˜æ€è€ƒ
**é€šç”¨æŠ€å·§è¿ç§»**ï¼š  
1. å¸¦ç¦å¿Œä¸²çš„å­—ç¬¦ä¸²æ„é€ ï¼ˆå¦‚å¯†ç ç”Ÿæˆå™¨ï¼‰  
2. æ–‡æœ¬ç¼–è¾‘å™¨æŸ¥æ‰¾æ›¿æ¢åŠŸèƒ½åº•å±‚ä¼˜åŒ–  
3. ç”Ÿç‰©ä¿¡æ¯å­¦ä¸­DNAåºåˆ—é¿åºè®¾è®¡  

**æ´›è°·æ¨è**ï¼š  
1. **P2375 åŠ¨ç‰©å›­**  
   ğŸ—£ï¸ å·©å›ºKMPçš„`next`æ•°ç»„åº”ç”¨ï¼Œç†è§£å‰ç¼€å‡½æ•°æœ¬è´¨  
2. **P3193 GTè€ƒè¯•**  
   ğŸ—£ï¸ è¿›é˜¶ç»ƒä¹ ï¼šå°†KMPæ€æƒ³æ‰©å±•åˆ°æ•°ä½DP  
3. **P3435 OKR-Periods**  
   ğŸ—£ï¸ æŒæ¡`next`æ•°ç»„çš„è¿­ä»£æ±‚å€¼ï¼Œç†è§£å‘¨æœŸä¸²ç‰¹æ€§  

#### 7. å­¦ä¹ å¿ƒå¾—ä¸ç»éªŒåˆ†äº«
> **æ¥è‡ªé¢˜è§£ä½œè€…çš„ç»éªŒ**ï¼š  
> "æœ€åˆå¡åœ¨çŠ¶æ€è½¬ç§»è®¾è®¡ï¼Œåæ¥é€šè¿‡æ‰‹å·¥æ¨¡æ‹Ÿå°æ ·ä¾‹ï¼ˆå¦‚S='aab', T='ab'ï¼‰æ‰ç†è§£`g`æ•°ç»„æ„ä¹‰"  
>   
> **Kayç‚¹è¯„**ï¼š  
> è°ƒè¯•DPé—®é¢˜æ—¶ï¼š  
> 1. å…ˆæ‰‹ç®—å°è§„æ¨¡æ¡ˆä¾‹ï¼ˆnâ‰¤3ï¼‰æ˜ç¡®çŠ¶æ€å«ä¹‰  
> 2. æ‰“å°DPè¡¨ä¸­é—´çŠ¶æ€éªŒè¯è½¬ç§»é€»è¾‘  
> 3. ç‰¹åˆ«æ³¨æ„`j=0`å’Œ`j=m`çš„è¾¹ç•Œæƒ…å†µ  

é€šè¿‡æœ¬æŒ‡å—ï¼Œä½ ä¸ä»…æŒæ¡äº†KMP+DPçš„æ ¸å¿ƒæŠ€å·§ï¼Œæ›´å­¦ä¼šç”¨æ¸¸æˆåŒ–æ€ç»´ç†è§£ç®—æ³•ã€‚è®°ä½ï¼šæ¯ä¸ªå¤æ‚ç®—æ³•èƒŒåéƒ½æœ‰ç›´è§‚çš„ç‰©ç†æ„ä¹‰ï¼ğŸ’ª

---
å¤„ç†ç”¨æ—¶ï¼š99.50ç§’
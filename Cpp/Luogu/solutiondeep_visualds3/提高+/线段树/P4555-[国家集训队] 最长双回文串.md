# é¢˜ç›®ä¿¡æ¯

# [å›½å®¶é›†è®­é˜Ÿ] æœ€é•¿åŒå›æ–‡ä¸²

## é¢˜ç›®æè¿°

é¡ºåºå’Œé€†åºè¯»èµ·æ¥å®Œå…¨ä¸€æ ·çš„ä¸²å«åšå›æ–‡ä¸²ã€‚æ¯”å¦‚ `acbca` æ˜¯å›æ–‡ä¸²ï¼Œè€Œ `abc` ä¸æ˜¯ï¼š`abc` çš„é¡ºåºä¸º `abc`ï¼Œé€†åºä¸º `cba`ï¼Œä¸ç›¸åŒã€‚

è¾“å…¥é•¿åº¦ä¸º $n$ çš„ä¸² $S$ï¼Œæ±‚ $S$ çš„æœ€é•¿åŒå›æ–‡å­ä¸² $T$ï¼Œå³å¯å°† $T$ åˆ†ä¸ºä¸¤éƒ¨åˆ† $X, Y$ï¼ˆ$|X|,|Y|â‰¥1$ï¼‰ä¸” $X$ å’Œ $Y$ éƒ½æ˜¯å›æ–‡ä¸²ã€‚

## è¯´æ˜/æç¤º

**æ ·ä¾‹è¯´æ˜**

ä»ç¬¬äºŒä¸ªå­—ç¬¦å¼€å§‹çš„å­—ç¬¦ä¸² `aacaabbacabb` å¯åˆ†ä¸º `aacaa` ä¸ `bbacabb` ä¸¤éƒ¨åˆ†ï¼Œä¸”ä¸¤è€…éƒ½æ˜¯å›æ–‡ä¸²ã€‚

**æ•°æ®èŒƒå›´**

å¯¹äº $100\%$ çš„æ•°æ®ï¼Œ$2\leq |S|\leq 10^5$ã€‚

2018.12.10ï¼Œ2018.12.15ï¼šæ„Ÿè°¢ @Ycrpro æä¾› hack æ•°æ®ä¸¤ç»„ã€‚

## æ ·ä¾‹ #1

### è¾“å…¥

```
baacaabbacabb```

### è¾“å‡º

```
12```

# AIåˆ†æç»“æœ


### ğŸ’¡ Kayçš„C++ç®—æ³•è§£æï¼šæœ€é•¿åŒå›æ–‡ä¸² æ·±å…¥å­¦ä¹ æŒ‡å— ğŸ’¡

#### å¼•è¨€
ä»Šå¤©æˆ‘ä»¬æ¥åˆ†æã€Œæœ€é•¿åŒå›æ–‡ä¸²ã€è¿™é“C++ç¼–ç¨‹é¢˜ã€‚æœ¬æŒ‡å—å°†å¸®åŠ©å¤§å®¶æ¢³ç†é¢˜ç›®æ€è·¯ï¼Œç†è§£æ ¸å¿ƒç®—æ³•ï¼Œå¹¶æŒæ¡è§£é¢˜æŠ€å·§ã€‚

---

### 1. é¢˜ç›®è§£è¯»ä¸æ ¸å¿ƒç®—æ³•è¯†åˆ«
âœ¨ **æœ¬é¢˜ä¸»è¦è€ƒå¯Ÿ**ï¼š`å­—ç¬¦ä¸²å¤„ç†ä¸Manacherç®—æ³•åº”ç”¨`

ğŸ—£ï¸ **åˆæ­¥åˆ†æ**ï¼š
> è§£å†³æœ€é•¿åŒå›æ–‡ä¸²çš„å…³é”®åœ¨äº**é«˜æ•ˆå¤„ç†å›æ–‡å­ä¸²**ã€‚æƒ³è±¡ä½ åœ¨ç©æ‹¼å›¾ï¼šåŸå­—ç¬¦ä¸²æ˜¯ä¸€ä¸²æ‚ä¹±ç§¯æœ¨ï¼ŒManacherç®—æ³•å°±åƒå¿«é€Ÿè¯†åˆ«å¯¹ç§°å›¾æ¡ˆçš„æ‰«æä»ªï¼ˆå›æ–‡ä¸­å¿ƒæ‰«æï¼‰ï¼Œè€Œé€’æ¨ä¼˜åŒ–åˆ™æ˜¯ç”¨å·²çŸ¥å¯¹ç§°å—æ¨å¯¼ç›¸é‚»å—çš„æŠ€å·§ï¼ˆå›æ–‡è¾¹ç•Œä¼ é€’ï¼‰ã€‚  
> - **æ ¸å¿ƒæ€è·¯**ï¼šå…ˆç”¨Manacherç®—æ³•è®¡ç®—æ¯ä¸ªä½ç½®çš„å›æ–‡åŠå¾„ï¼Œå†é€šè¿‡é€’æ¨æ±‚å‡ºæ¯ä¸ªä½ç½®ä½œä¸ºå·¦/å³ç«¯ç‚¹çš„æœ€é•¿å›æ–‡é•¿åº¦ï¼Œæœ€åæšä¸¾åˆ†å‰²ç‚¹ï¼ˆ'#'ä½ç½®ï¼‰æ±‚æœ€å¤§å€¼ã€‚
> - **éš¾ç‚¹çªç ´**ï¼šå¦‚ä½•å°†å›æ–‡ä¸­å¿ƒä¿¡æ¯è½¬åŒ–ä¸ºç«¯ç‚¹ä¿¡æ¯ï¼Ÿé€šè¿‡å›æ–‡ä¸²çš„è¿ç»­æ€§ï¼ˆå»æ‰ä¸¤ç«¯ä»å›æ–‡ï¼‰è®¾è®¡é€’æ¨å…¬å¼ï¼š`l[i]=max(l[i],l[i-2]-2)`ã€‚
> - **å¯è§†åŒ–è®¾è®¡**ï¼šåŠ¨ç”»å°†å±•ç¤ºä¸‰é˜¶æ®µï¼šâ‘ Manacherä¸­å¿ƒæ‰©å±•ï¼ˆçº¢è‰²é«˜äº®æ‰©å±•è¿‡ç¨‹ï¼‰â‘¡é€’æ¨æ›´æ–°ï¼ˆè“è‰²æ³¢æµªä¼ é€’æ•ˆæœï¼‰â‘¢åˆ†å‰²ç‚¹æšä¸¾ï¼ˆé»„ç»¿åŒè‰²å—æ‹¼åˆï¼‰ã€‚

---

### 2. ç²¾é€‰ä¼˜è´¨é¢˜è§£å‚è€ƒ
ä»12ç¯‡é¢˜è§£ä¸­ç²¾é€‰3ç¯‡â‰¥4æ˜Ÿè§£æ³•ï¼š

**é¢˜è§£ä¸€ï¼ˆæ¥šæ³« Â· 119èµï¼‰**  
* **ç‚¹è¯„**ï¼š  
  æ€è·¯æ¸…æ™°åº¦æ»¡åˆ†ï¼ç”¨â€œé¥±å’Œ/ä¸é¥±å’Œå›æ–‡ä¸²â€æ¯”å–»è§£é‡Šé€’æ¨å¿…è¦æ€§ï¼Œæ³¨é‡Šè¯¦å°½ï¼ˆå¦‚`l[i]`æ¨å¯¼ç¤ºä¾‹ï¼‰ã€‚ä»£ç å˜é‡å`l[i]`/`r[i]`ç›´ç™½æ˜“æ‡‚ï¼Œè¾¹ç•Œå¤„ç†ä¸¥è°¨ï¼ˆ`if(r[i]&&l[i])`é˜²ç©ºä¸²ï¼‰ã€‚äº®ç‚¹æ˜¯**é€’æ¨éƒ¨åˆ†çš„æ•°å­¦è¯æ˜**ï¼š`bab`æ¯”`ababa`çŸ­2å­—ç¬¦ï¼Œæ•…éœ€`l[i]=l[i-2]-2`ã€‚

**é¢˜è§£äºŒï¼ˆæµ…è‰²è°ƒ Â· 91èµï¼‰**  
* **ç‚¹è¯„**ï¼š  
  é€»è¾‘æ¨å¯¼æå¼ºï¼ç‹¬åˆ›â€œé¥±å’Œå›æ–‡ä¸²â€æ¦‚å¿µé…åˆç¤ºæ„å›¾ï¼Œè§£é‡Šä¸ºä½•Manacheråéœ€äºŒæ¬¡é€’æ¨ã€‚ä»£ç ç”¨å®ç®€åŒ–å¾ªç¯ï¼ˆ`For(i,a,b,c)`ï¼‰ï¼Œç©ºé—´ä¼˜åŒ–åˆ°ä½ï¼ˆO(n)ï¼‰ã€‚äº®ç‚¹æ˜¯**å›¾ç¤ºåŒ–é€’æ¨å…³ç³»**ï¼Œå®è·µä»·å€¼é«˜ï¼ˆç›´æ¥ACä»£ç ä»…30è¡Œï¼‰ã€‚

**é¢˜è§£ä¸‰ï¼ˆè’Ÿè’»åˆéŸ³ãƒŸã‚¯ Â· 38èµï¼‰**  
* **ç‚¹è¯„**ï¼š  
  æ•™å­¦æ€§çªå‡ºï¼é’ˆå¯¹é€’æ¨ç–‘æƒ‘ç»˜åˆ¶åƒç´ å›¾è¯´æ˜`l[i+2]-2`çš„å‡ ä½•æ„ä¹‰ã€‚ä»£ç å…³é”®è¡Œæ³¨é‡Šè¦†ç›–90%ï¼Œç‰¹åˆ«æ ‡æ³¨â€œ#ä½œä¸ºæ–­ç‚¹â€çš„æšä¸¾é€»è¾‘ã€‚äº®ç‚¹æ˜¯**æ‰‹ç»˜ç¤ºæ„å›¾å¯¹æ¯”é¥±å’Œ/ä¸é¥±å’Œä¸²**ï¼Œé™ä½ç†è§£é—¨æ§›ã€‚

---

### 3. æ ¸å¿ƒéš¾ç‚¹è¾¨æä¸è§£é¢˜ç­–ç•¥
**ä¸‰å¤§æ ¸å¿ƒéš¾ç‚¹ä¸çªç ´ç­–ç•¥**ï¼š
1. **éš¾ç‚¹1ï¼šå›æ–‡ä¸­å¿ƒâ†’ç«¯ç‚¹è½¬æ¢**  
   * **åˆ†æ**ï¼šManacherè¾“å‡ºä¸­å¿ƒåŠå¾„ï¼Œä½†éœ€ç«¯ç‚¹é•¿åº¦ã€‚ä¼˜è´¨è§£æ³•åœ¨æ‰©å±•æ—¶æ›´æ–°ç«¯ç‚¹ï¼š`l[i+p[i]-1]=max(l[i+p[i]-1], p[i]-1)`  
   * ğŸ’¡ **å­¦ä¹ ç¬”è®°**ï¼šå›æ–‡ä¸²å¯¹ç§°æ€§å†³å®šç«¯ç‚¹å€¼å¯ä»ä¸­å¿ƒæ¨å¯¼

2. **éš¾ç‚¹2ï¼šéæå¤§å›æ–‡ä¸²å¡«å……**  
   * **åˆ†æ**ï¼šManacheråªè®°å½•æå¤§ä¸²ç«¯ç‚¹ï¼Œå†…éƒ¨ç‚¹éœ€é€’æ¨ã€‚å…³é”®å…¬å¼ï¼š  
     ```cpp
     for(int i=n; i>=1; i-=2) r[i]=max(r[i], r[i+2]-2); // å³ç«¯ç‚¹é€’æ¨
     for(int i=1; i<=n; i+=2)  l[i]=max(l[i], l[i-2]-2); // å·¦ç«¯ç‚¹é€’æ¨
     ```
   * ğŸ’¡ **å­¦ä¹ ç¬”è®°**ï¼šå›æ–‡ä¸²é•¿åº¦-2ç­‰ä»·äºå»æ‰ä¸¤ç«¯å­—ç¬¦

3. **éš¾ç‚¹3ï¼šåˆ†å‰²ç‚¹æœ‰æ•ˆæ€§éªŒè¯**  
   * **åˆ†æ**ï¼šåŒå›æ–‡ä¸²éœ€ä¸ç›¸äº¤ï¼Œä¼˜è´¨è§£æ³•ä¸¥æ ¼æšä¸¾'#'ä½ç½®ï¼š  
     ```cpp
     for(int i=1; i<=n; i+=2) ans=max(ans, l[i]+r[i]);
     ```
   * ğŸ’¡ **å­¦ä¹ ç¬”è®°**ï¼šç‰¹æ®Šå­—ç¬¦'#'æ˜¯å¤©ç„¶åˆ†éš”ç¬¦

**âœ¨ è§£é¢˜æŠ€å·§æ€»ç»“**ï¼š
- **æŠ€å·§1ï¼šå¯¹ç§°ä¼ é€’æ³•** - åˆ©ç”¨å›æ–‡å¯¹ç§°æ€§æ¨å¯¼éæå¤§ä¸²  
- **æŠ€å·§2ï¼šç«¯ç‚¹åˆ†ç¦»æ³•** - ç‹¬ç«‹ç»´æŠ¤å·¦å³ç«¯ç‚¹æ•°ç»„  
- **æŠ€å·§3ï¼šè™šæ‹Ÿåˆ†å‰²ç‚¹** - æ’å…¥'#'æšä¸¾é¿å…é‡å   

---

### 4. C++æ ¸å¿ƒä»£ç å®ç°èµæ
**é€šç”¨æ ¸å¿ƒå®ç°ï¼ˆç»¼åˆä¼˜è´¨é¢˜è§£ï¼‰**ï¼š
```cpp
#include <cstring>
#include <algorithm>
using namespace std;
const int N = 2e5 + 10; // ä¸¤å€ç©ºé—´å­˜'#'

char s0[N], s[N];       // s0=åŸä¸², s=æ’å…¥'#'çš„ä¸²
int n, len, p[N], l[N], r[N];

void manacher() {
    len = strlen(s0 + 1);
    n = 1;
    s[0] = '$'; s[1] = '#';  // é˜²è¶Šç•Œ
    for(int i = 1; i <= len; ++i) {
        s[++n] = s0[i];
        s[++n] = '#';
    }
    s[n + 1] = 0;  // ç»ˆæ­¢ç¬¦

    int mid = 0, maxr = 0;
    for(int i = 1; i <= n; ++i) {
        p[i] = (i < maxr) ? min(p[2 * mid - i], maxr - i) : 1;
        while(s[i + p[i]] == s[i - p[i]]) p[i]++;
        if(i + p[i] > maxr) {
            maxr = i + p[i];
            mid = i;
        }
        l[i + p[i] - 1] = max(l[i + p[i] - 1], p[i] - 1); // æ›´æ–°å³ç«¯ç‚¹
        r[i - p[i] + 1] = max(r[i - p[i] + 1], p[i] - 1); // æ›´æ–°å·¦ç«¯ç‚¹
    }
}

int main() {
    scanf("%s", s0 + 1);
    manacher();
    // é€’æ¨å¡«å……éæå¤§ä¸²
    for(int i = n; i >= 1; i -= 2) r[i] = max(r[i], r[i + 2] - 2);
    for(int i = 1; i <= n; i += 2) l[i] = max(l[i], l[i - 2] - 2);
    
    int ans = 0;
    for(int i = 1; i <= n; i += 2)  // æšä¸¾'#'ä½ç½®
        if(l[i] && r[i]) 
            ans = max(ans, l[i] + r[i]);
    printf("%d\n", ans);
    return 0;
}
```
**ä»£ç è§£è¯»æ¦‚è¦**ï¼š  
> 1. **é¢„å¤„ç†**ï¼šæ’å…¥'#'æ„é€ é€šç”¨å¥‡å›æ–‡ä¸²  
> 2. **Manacheræ ¸å¿ƒ**ï¼šåŠ¨æ€ç»´æŠ¤`mid/maxr`ï¼Œæ‰©å±•æ—¶æ›´æ–°ç«¯ç‚¹æ•°ç»„`l[]/r[]`  
> 3. **é€’æ¨ä¼˜åŒ–**ï¼š`r[i]`ä»å³å‘å·¦ã€`l[i]`ä»å·¦å‘å³ä¼ é€’  
> 4. **ç­”æ¡ˆè®¡ç®—**ï¼šä»…æšä¸¾'#'ä½ç½®é˜²é‡å   

**é¢˜è§£ä¸€ä»£ç ç‰‡æ®µèµæ**ï¼š  
```cpp
// æ¥šæ³«ï¼šé€’æ¨åŸç†æ³¨é‡Š
for(int i = n; i >= 1; i -= 2) 
    r[i] = max(r[i], r[i+2] - 2); // å›æ–‡ä¸²ç¼©çŸ­2å­—ç¬¦
```
> **äº®ç‚¹**ï¼šç”¨`ababaâ†’bab`å®ä¾‹è¯´æ˜-2çš„å‡ ä½•æ„ä¹‰  
> **å­¦ä¹ ç¬”è®°**ï¼šé€’æ¨æœ¬è´¨æ˜¯å›æ–‡å­ä¸²çš„åŒ…å«å…³ç³»  

**é¢˜è§£äºŒä»£ç ç‰‡æ®µèµæ**ï¼š  
```cpp
// æµ…è‰²è°ƒï¼šå›¾è§£é¥±å’Œä¸²
Bor(i, cnt, 2, 1) l[i] = max(l[i], l[i+2]-2); // é€†åºæ›´æ–°
```
> **äº®ç‚¹**ï¼š`Bor`å®å®ç°å€’åºå¾ªç¯ï¼Œä¼˜åŒ–å¯è¯»æ€§  
> **å­¦ä¹ ç¬”è®°**ï¼šé€†åºæ›´æ–°ä¿è¯`l[i+2]`å·²è®¡ç®—  

---

### 5. ç®—æ³•å¯è§†åŒ–ï¼šåƒç´ åŠ¨ç”»æ¼”ç¤º
**ä¸»é¢˜**ï¼š8-bité£æ ¼ã€Šå›æ–‡æ¢é™©è€…ã€‹  
**æ ¸å¿ƒæ¼”ç¤º**ï¼šManacheræ‰©å±•â†’é€’æ¨ä¼ é€’â†’åˆ†å‰²ç‚¹æšä¸¾  

**åƒç´ åŠ¨ç”»æ–¹æ¡ˆ**ï¼š  
1. **åœºæ™¯è®¾è®¡**ï¼š  
   - å­—ç¬¦å—ï¼šå­—æ¯=16x16åƒç´ è‰²å—ï¼Œ'#'=ç°è‰²æ ¼å­  
   - çŠ¶æ€è‰²ï¼šå½“å‰ä¸­å¿ƒ=é—ªçƒçº¢æ¡†ï¼Œå›æ–‡åŸŸ=åŠé€è“è†œ  

2. **Manacheré˜¶æ®µ**ï¼š  
   ```mermaid
   graph LR
   A[ä¸­å¿ƒmid] --> B[å‘å³æ‰©å±•]
   B --> C{å¯¹ç§°ï¼Ÿ}
   C -->|Yes| D[åŠå¾„p[i]+1]
   C -->|No| E[æ›´æ–°maxr]
   ```
   - **éŸ³æ•ˆ**ï¼šæ‰©å±•æˆåŠŸ=â€œå®â€ï¼Œæ›´æ–°maxr=â€œå˜Ÿâ€

3. **é€’æ¨é˜¶æ®µ**ï¼š  
   - æ³¢æµªåŠ¨ç”»ï¼šä»å·¦åˆ°å³è“è‰²æ³¢çº¹æ›´æ–°`l[i]`ï¼Œä»å³åˆ°å·¦ç»¿è‰²æ³¢çº¹æ›´æ–°`r[i]`  
   - **å…¬å¼æ˜¾ç¤º**ï¼šå½“å‰å•å…ƒæ ¼é¡¶éƒ¨æ˜¾ç¤º`l[i]=max(l[i],l[i-2]-2)`  

4. **åˆ†å‰²æšä¸¾**ï¼š  
   - äº¤äº’æ“ä½œï¼šç‚¹å‡»'#'è§¦å‘é»„ç»¿åŒè‰²é«˜äº®å·¦å³å›æ–‡ä¸²  
   - **èƒœåˆ©æ¡ä»¶**ï¼šæ‰¾åˆ°æœ€å¤§å’Œæ—¶æ’­æ”¾8-bitèƒœåˆ©éŸ³ä¹  

---

### 6. æ‹“å±•ç»ƒä¹ ä¸ç›¸ä¼¼é—®é¢˜æ€è€ƒ
**é€šç”¨æŠ€å·§è¿ç§»**ï¼š  
1. **åŒå›æ–‡å˜ç§**ï¼šå¦‚[SHOI2011]åŒå€å›æ–‡ï¼ˆP4287ï¼‰  
2. **å¤šç«¯ç‚¹å¤„ç†**ï¼šå¦‚æœ€é•¿è¿ç»­å›æ–‡åˆ†å‰²ï¼ˆLC132ï¼‰  
3. **å›æ–‡è‡ªåŠ¨æœº**ï¼šè§£å†³å¸¦é™åˆ¶å›æ–‡é—®é¢˜ï¼ˆå¦‚P5496ï¼‰  

**æ´›è°·æ¨è**ï¼š  
1. **P3805** ã€æ¨¡æ¿ã€‘Manacherç®—æ³•  
   > ğŸ—£ï¸ *Kayè¯´*ï¼šæŒæ¡æœ¬é¢˜çš„åŸºç¡€ï¼Œå»ºè®®å…ˆACæ­¤æ¨¡æ¿  
2. **P4287** [SHOI2011]åŒå€å›æ–‡  
   > ğŸ—£ï¸ *Kayè¯´*ï¼šåŒå›æ–‡ä¸²è¿›é˜¶ï¼Œéœ€ç»“åˆå‰åç¼€åˆ†æ  
3. **P5496** ã€æ¨¡æ¿ã€‘å›æ–‡è‡ªåŠ¨æœº  
   > ğŸ—£ï¸ *Kayè¯´*ï¼šä»Manacherè¿‡æ¸¡åˆ°è‡ªåŠ¨æœºï¼Œç†è§£çŠ¶æ€è½¬ç§»  

---

### 7. å­¦ä¹ å¿ƒå¾—ä¸ç»éªŒåˆ†äº«
> **æ¥šæ³«çš„è°ƒè¯•ç»éªŒ**ï¼š  
> â€œåˆå­¦Manacheræ—¶ï¼Œåœ¨`l[i]`é€’æ¨éƒ¨åˆ†å¡äº†2å°æ—¶ï¼Œæ‰“å°`i=3`æ—¶`l[3]`çš„ä¸­é—´å€¼æ‰å‘ç°æœªè¦†ç›–éæå¤§ä¸²â€  
>   
> **Kayæ€»ç»“**ï¼š  
> 1. é€’æ¨å‰åˆå§‹åŒ–æ•°ç»„ä¸º0ï¼ˆé˜²æ— æ•ˆå€¼ï¼‰  
> 2. éªŒè¯`i=1,3,5`ç­‰å…³é”®ç‚¹çš„`l[i]/r[i]`  
> 3. ç”¨`aba`ç­‰å°æ ·ä¾‹æ‰‹ç®—éªŒè¯  

---

### ç»“è¯­
é€šè¿‡æœ¬æ¬¡åˆ†æï¼Œæˆ‘ä»¬æ·±å…¥ç†è§£äº†Manacheråœ¨åŒå›æ–‡ä¸²çš„åº”ç”¨ã€‚è®°ä½ï¼š**å›æ–‡é—®é¢˜æ ¸å¿ƒæ˜¯å¯¹ç§°ä¼ é€’ï¼Œè€Œé€’æ¨æ˜¯ä¼˜åŒ–åˆ©å™¨**ã€‚ä¸‹æ¬¡æŒ‘æˆ˜å†è§ï¼ğŸš€

---
å¤„ç†ç”¨æ—¶ï¼š195.43ç§’
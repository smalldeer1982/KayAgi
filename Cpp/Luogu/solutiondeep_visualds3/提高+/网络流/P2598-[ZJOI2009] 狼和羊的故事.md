# é¢˜ç›®ä¿¡æ¯

# [ZJOI2009] ç‹¼å’Œç¾Šçš„æ•…äº‹

## é¢˜ç›®æè¿°

â€œç‹¼çˆ±ä¸Šç¾Šå•Šçˆ±çš„ç–¯ç‹‚ï¼Œè°è®©ä»–ä»¬çœŸçˆ±äº†ä¸€åœºï¼›ç‹¼çˆ±ä¸Šç¾Šå•Šå¹¶ä¸è’å”ï¼Œä»–ä»¬è¯´æœ‰çˆ±å°±æœ‰æ–¹å‘â€¦â€¦â€Orez å¬åˆ°è¿™é¦–æ­Œï¼Œå¿ƒæƒ³ï¼šç‹¼å’Œç¾Šå¦‚æ­¤å’Œè°ï¼Œä¸ºä»€ä¹ˆä¸å°è¯•ç¾Šç‹¼åˆå…»å‘¢ï¼Ÿè¯´å¹²å°±å¹²ï¼

Orez çš„ç¾Šç‹¼åœˆå¯ä»¥çœ‹ä½œä¸€ä¸ª $n\times m$ çš„çŸ©é˜µæ ¼å­ï¼Œè¿™ä¸ªçŸ©é˜µçš„è¾¹ç¼˜å·²ç»è£…ä¸Šäº†ç¯±ç¬†ã€‚å¯æ˜¯ Drake å¾ˆå¿«å‘ç°ç‹¼å†æ€ä¹ˆä¹Ÿæ˜¯ç‹¼ï¼Œå®ƒä»¬æ€»æ˜¯å¯¹ç¾Šå‚æ¶ä¸‰å°ºï¼Œé‚£é¦–æ­Œåªä¸è¿‡æ˜¯ä¸€ä¸ªåŠ¨äººçš„ä¼ è¯´è€Œå·²ã€‚æ‰€ä»¥ Orez å†³å®šåœ¨ç¾Šç‹¼åœˆä¸­å†åŠ å…¥ä¸€äº›ç¯±ç¬†ï¼Œè¿˜æ˜¯è¦å°†ç¾Šç‹¼åˆ†å¼€æ¥å…»ã€‚

é€šè¿‡ä»”ç»†è§‚å¯Ÿï¼ŒOrez å‘ç°ç‹¼å’Œç¾Šéƒ½æœ‰å±äºè‡ªå·±é¢†åœ°ï¼Œè‹¥ç‹¼å’Œç¾Šä»¬ä¸èƒ½å‘†åœ¨è‡ªå·±çš„é¢†åœ°ï¼Œé‚£å®ƒä»¬å°±ä¼šå˜å¾—éå¸¸æš´èºï¼Œä¸åˆ©äºä»–ä»¬çš„æˆé•¿ã€‚

Orez æƒ³è¦æ·»åŠ ç¯±ç¬†çš„å°½å¯èƒ½çš„çŸ­ã€‚å½“ç„¶è¿™ä¸ªç¯±ç¬†é¦–å…ˆå¾—ä¿è¯ä¸èƒ½æ”¹å˜ç‹¼ç¾Šçš„æ‰€å±é¢†åœ°ï¼Œå†å°±æ˜¯ç¯±ç¬†å¿…é¡»ä¿®ç­‘å®Œæ•´ï¼Œä¹Ÿå°±æ˜¯è¯´å¿…é¡»ä¿®å»ºåœ¨å•ä½æ ¼å­çš„è¾¹ç•Œä¸Šå¹¶ä¸”ä¸èƒ½åªä¿®å»ºä¸€éƒ¨åˆ†ã€‚

## è¯´æ˜/æç¤º

å¯¹äº $10\%$ çš„æ•°æ®ï¼Œ$n, m \le 3$ã€‚  
å¯¹äº $30\%$ çš„æ•°æ®ï¼Œ$n, m \le 20$ã€‚  
å¯¹äº $100\%$ çš„æ•°æ®ï¼Œ$1 \le n, m \le 100$ã€‚

## æ ·ä¾‹ #1

### è¾“å…¥

```
2 2

2 2 

1 1 ```

### è¾“å‡º

```
2

```

# AIåˆ†æç»“æœ


# ğŸ’¡ Kayçš„C++ç®—æ³•è§£æï¼š[ZJOI2009]ç‹¼å’Œç¾Šçš„æ•…äº‹ æ·±å…¥å­¦ä¹ æŒ‡å— ğŸ’¡

**å¼•è¨€**  
ä»Šå¤©æˆ‘ä»¬ä¸€èµ·åˆ†æã€Œç‹¼å’Œç¾Šçš„æ•…äº‹ã€è¿™é“ç»å…¸ç½‘ç»œæµé¢˜ç›®ã€‚æœ¬æŒ‡å—å°†å¸®åŠ©å¤§å®¶æŒæ¡æœ€å°å‰²æ¨¡å‹çš„å»ºç«‹æ–¹æ³•ï¼Œç†è§£ç½‘ç»œæµåœ¨çŸ©é˜µåˆ†å‰²é—®é¢˜ä¸­çš„åº”ç”¨ï¼Œå¹¶é€šè¿‡åƒç´ åŠ¨ç”»ç›´è§‚æ„Ÿå—ç®—æ³•æ‰§è¡Œè¿‡ç¨‹ã€‚

## 1. é¢˜ç›®è§£è¯»ä¸æ ¸å¿ƒç®—æ³•è¯†åˆ«

âœ¨ **æœ¬é¢˜ä¸»è¦è€ƒå¯Ÿ**ï¼š`å›¾è®º-ç½‘ç»œæµ/æœ€å°å‰²`  

ğŸ—£ï¸ **åˆæ­¥åˆ†æ**ï¼š  
> æœ¬é¢˜è¦æ±‚ç”¨æœ€çŸ­ç¯±ç¬†åˆ†éš”ç‹¼å’Œç¾Šï¼Œæœ¬è´¨æ˜¯å°†çŸ©é˜µåˆ’åˆ†ä¸ºä¸¤ä¸ªé›†åˆï¼ˆç‹¼ç¾¤/ç¾Šç¾¤ï¼‰ã€‚æœ€å°å‰²æ¨¡å‹å¦‚åŒåœ¨çŸ©é˜µä¸Šé“ºè®¾æ°´ç®¡ç½‘ç»œï¼Œç‹¼æ˜¯æ°´æºï¼ˆæºç‚¹ï¼‰ï¼Œç¾Šæ˜¯æ’æ°´å£ï¼ˆæ±‡ç‚¹ï¼‰ï¼Œç¯±ç¬†æ˜¯æ°´ç®¡é˜€é—¨ï¼ˆå‰²è¾¹ï¼‰ã€‚å½“æ°´æµæ— æ³•ä»ç‹¼æµå‘ç¾Šæ—¶ï¼Œå…³é—­çš„é˜€é—¨æ€»ä»£ä»·å°±æ˜¯æœ€å°å‰²å€¼ã€‚  

- **æ ¸å¿ƒæ€è·¯**ï¼š  
  1. æºç‚¹è¿æ¥æ‰€æœ‰ç‹¼ï¼ˆå®¹é‡âˆï¼Œç¡®ä¿ç‹¼å§‹ç»ˆå±äºæºç‚¹é›†åˆï¼‰  
  2. æ‰€æœ‰ç¾Šè¿æ¥æ±‡ç‚¹ï¼ˆå®¹é‡âˆï¼‰  
  3. ç›¸é‚»æ ¼å­é—´å»ºç«‹åŒå‘è¾¹ï¼ˆå®¹é‡1ï¼Œä»£è¡¨ç¯±ç¬†ä»£ä»·ï¼‰  

- **å¯è§†åŒ–è®¾è®¡**ï¼š  
  åƒç´ åŠ¨ç”»å°†å±•ç¤ºç½‘æ ¼ä¸­"æ°´æµ"ï¼ˆBFSéå†ï¼‰å¦‚ä½•å¯»æ‰¾å¢å¹¿è·¯å¾„ï¼Œé‡ç‚¹é«˜äº®ï¼š  
  - æºç‚¹/æ±‡ç‚¹çš„åˆå§‹åŒ–ï¼ˆç‹¼/ç¾Šé«˜äº®ï¼‰  
  - æ®‹ä½™ç½‘ç»œä¸­æµé‡å˜åŒ–ï¼ˆç®¡é“ç²—ç»†å˜åŒ–ï¼‰  
  - å‰²è¾¹ç¡®å®šæ—¶æ’­æ”¾"å®"éŸ³æ•ˆå¹¶æ˜¾ç¤ºç¯±ç¬†å›¾æ ‡  

---

## 2. ç²¾é€‰ä¼˜è´¨é¢˜è§£å‚è€ƒ

### é¢˜è§£ä¸€ï¼šAubRain (73èµ)
* **äº®ç‚¹**ï¼šç›´å‡»æœ¬è´¨çš„å»ºå›¾æ€è·¯ï¼Œé«˜æ•ˆDinicå®ç°  
* **ç‚¹è¯„**ï¼š  
  > æ­¤è§£æ³•ç”¨æœ€ç®€ä»£ç å®ç°æ ¸å¿ƒé€»è¾‘ï¼ˆ30è¡Œå†…ï¼‰ã€‚äº®ç‚¹åœ¨äºï¼š
  > - ç”¨`num(i,j)`å®å®ç°åæ ‡æ˜ å°„
  > - æ­£ç¡®å¤„ç†äº†ç©ºåœ°ï¼ˆ0ï¼‰ä¸ç‹¼ç¾Šçš„è¿è¾¹
  > - Dinicç®—æ³•æ¨¡æ¿ç®€æ´é«˜æ•ˆ  
  > éœ€æ³¨æ„ï¼šé‚»æ¥è¡¨ä»1å¼€å§‹ï¼ˆcnt=1ï¼‰ï¼Œä¾¿äºå¼‚æˆ–æ‰¾åå‘è¾¹

### é¢˜è§£äºŒï¼šPPL_ (30èµ)
* **äº®ç‚¹**ï¼šISAPç®—æ³•ä¼˜åŒ–ï¼Œè¯¦ç»†å›¾è§£å»ºå›¾åŸç†  
* **ç‚¹è¯„**ï¼š  
  > æ­¤è§£çªå‡ºä¼˜åŠ¿åœ¨äºï¼š
  > - å›¾æ–‡å¹¶èŒ‚è§£é‡Šä¸­ç«‹ç‚¹å¤„ç†é€»è¾‘
  > - å¼•å…¥GAPä¼˜åŒ–çš„ISAPæå‡æ•ˆç‡
  > - æ¸¸æˆåŒ–å˜é‡å‘½åï¼ˆå¦‚"åƒç´ æ¢é™©å®¶"ï¼‰  
  > å­¦ä¹ ä»·å€¼ï¼šç†è§£ä¸ºä»€ä¹ˆç©ºåœ°éœ€è¦åŒå‘è¿è¾¹

### é¢˜è§£ä¸‰ï¼šå¤©ä¸Šä¸€é¢—è›‹ (12èµ)
* **äº®ç‚¹**ï¼šæ¸…æ™°çš„Dinicå®ç°+å®Œå¤‡è¾¹ç•Œå¤„ç†  
* **ç‚¹è¯„**ï¼š
  > ç‰¹è‰²åŒ…æ‹¬ï¼š
  > - ç‹¬ç«‹`Addedge`å‡½æ•°æé«˜å¯è¯»æ€§
  > - ä¸¥æ ¼åˆ¤æ–­çŸ©é˜µè¾¹ç•Œ
  > - å®Œæ•´Dinicæ¨¡å—å°è£…  
  > æ¨èä½œä¸ºåˆå­¦è€…æ¨¡æ¿

---

## 3. æ ¸å¿ƒéš¾ç‚¹è¾¨æä¸è§£é¢˜ç­–ç•¥

### éš¾ç‚¹1ï¼šä¸­ç«‹ç‚¹ï¼ˆ0ï¼‰çš„å½’å±å¤„ç†
* **åˆ†æ**ï¼š  
  ç©ºåœ°å¯è¢«åˆ’åˆ†åˆ°ä»»ä¸€æ–¹ã€‚è§£å†³æ–¹æ¡ˆï¼š  
  - ç‹¼â†’ç©ºåœ°è¿è¾¹ï¼ˆå®¹é‡1ï¼‰  
  - ç©ºåœ°â†’ç¾Šè¿è¾¹ï¼ˆå®¹é‡1ï¼‰  
  - ç©ºåœ°â†”ç©ºåœ°è¿è¾¹ï¼ˆå®¹é‡1ï¼‰  
  æœ€å°å‰²ä¼šè‡ªåŠ¨é€‰æ‹©æœ€ä¼˜å½’å±ï¼ˆå‰²ä»£ä»·æœ€å°çš„è¾¹ï¼‰

### éš¾ç‚¹2ï¼šé¿å…é‡å¤å»ºè¾¹
* **åˆ†æ**ï¼š  
  ç›¸é‚»ç‚¹éœ€åŒå‘è¿è¾¹ä½†éœ€é˜²é‡å¤ï¼š
  ```cpp
  for(int k=0; k<4; k++) { // åªè¿4ä¸ªæ–¹å‘
      if(æ–°åæ ‡åˆæ³•) add(u, v, 1); 
  }
  ```
  æˆ–æšä¸¾æ—¶ä¿è¯`i<j`ï¼ˆå‡å°‘ä¸€åŠè¾¹ï¼‰

### éš¾ç‚¹3ï¼šçŸ©é˜µåæ ‡æ˜ å°„
* **åˆ†æ**ï¼š  
  äºŒç»´â†’ä¸€ç»´æ˜ å°„å…¬å¼ï¼š`id = (i-1)*m + j`  
  æ³¨æ„è¡Œåˆ—é¡ºåºï¼ˆnè¡Œmåˆ—ï¼‰ï¼Œé¿å…AubRainæåˆ°çš„"n,må†™å"é”™è¯¯

### âœ¨ è§£é¢˜æŠ€å·§æ€»ç»“
- **é—®é¢˜è½¬åŒ–**ï¼šå°†ç‰©ç†éš”ç¦»æŠ½è±¡ä¸ºå›¾å‰²é—®é¢˜  
- **æ•°æ®ç»“æ„é€‰æ‹©**ï¼šé‚»æ¥è¡¨å­˜å›¾ï¼ˆè¾¹æ•°çº¦4*nmï¼‰  
- **è¾¹ç•Œå¤„ç†**ï¼šé¢„å…ˆæ£€æŸ¥`1â‰¤nxâ‰¤n, 1â‰¤nyâ‰¤m`  
- **è°ƒè¯•æŠ€å·§**ï¼šæ‰“å°æ®‹ä½™ç½‘ç»œéªŒè¯æµåˆ†é…

---

## 4. C++æ ¸å¿ƒä»£ç å®ç°èµæ

### æœ¬é¢˜é€šç”¨æ ¸å¿ƒå®ç°
```cpp
#include <cstring>
#include <queue>
using namespace std;
const int N=10010, M=100000, INF=0x3f3f3f3f;
const int dx[]={0,1,0,-1}, dy[]={1,0,-1,0};

struct Edge { int to, next, cap; } e[M];
int head[N], cur[N], dep[N], tot=1;
int n, m, S, T;

void add(int u, int v, int cap) {
    e[++tot] = {v, head[u], cap}; head[u] = tot;
    e[++tot] = {u, head[v], 0};   head[v] = tot;
}

bool bfs() {
    memset(dep, 0, sizeof(dep));
    queue<int> q; q.push(S);
    dep[S] = 1;
    while(!q.empty()) {
        int u = q.front(); q.pop();
        for(int i=head[u]; i; i=e[i].next) {
            int v = e[i].to;
            if(e[i].cap && !dep[v]) {
                dep[v] = dep[u] + 1;
                if(v == T) return true;
                q.push(v);
            }
        }
    }
    return false;
}

int dfs(int u, int flow) {
    if(u == T) return flow;
    int res = 0;
    for(int &i=cur[u]; i; i=e[i].next) {
        int v = e[i].to;
        if(e[i].cap && dep[v] == dep[u]+1) {
            int k = dfs(v, min(flow, e[i].cap));
            if(!k) dep[v] = 0;
            e[i].cap -= k; e[i^1].cap += k;
            res += k; flow -= k;
            if(!flow) break;
        }
    }
    return res;
}

int dinic() {
    int res = 0;
    while(bfs()) {
        memcpy(cur, head, sizeof(head));
        res += dfs(S, INF);
    }
    return res;
}

int main() {
    scanf("%d%d", &n, &m);
    S = 0, T = n*m + 1;
    // å»ºå›¾
    for(int i=1; i<=n; i++) {
        for(int j=1; j<=m; j++) {
            int x; scanf("%d", &x);
            int u = (i-1)*m + j;
            if(x == 1) add(S, u, INF);      // ç‹¼è¿æºç‚¹
            else if(x == 2) add(u, T, INF); // ç¾Šè¿æ±‡ç‚¹
            
            for(int k=0; k<4; k++) {
                int ni = i+dx[k], nj = j+dy[k];
                if(ni<1 || ni>n || nj<1 || nj>m) continue;
                int v = (ni-1)*m + nj;
                add(u, v, 1);  // ç›¸é‚»ç‚¹è¿è¾¹
            }
        }
    }
    printf("%d", dinic());
    return 0;
}
```

### é¢˜è§£ä¸€ä»£ç äº®ç‚¹
```cpp
// åæ ‡æ˜ å°„å®
#define num(i,j) ((i-1)*m+j)  

void build() {
    // æºç‚¹è¿ç‹¼(âˆ), ç¾Šè¿æ±‡ç‚¹(âˆ)
    if(a[i][j]==1) add(s, num(i,j), INF);
    else if(a[i][j]==2) add(num(i,j), t, INF);
    
    // å››å‘è¿è¾¹(å®¹é‡1)
    for(int k=0; k<4; k++) {
        int tx=i+mx[k], ty=j+my[k];
        if(tx>=1 && ty>=1 && tx<=n && ty<=m)
            add(num(i,j), num(tx,ty), 1);
    }
}
```

---

## 5. ç®—æ³•å¯è§†åŒ–ï¼šåƒç´ åŠ¨ç”»æ¼”ç¤º

### åŠ¨ç”»è®¾è®¡ï¼šç‹¼ç¾Šå¤§ä½œæˆ˜ï¼ˆ8-bité£æ ¼ï¼‰
![](https://fakeimg.pl/400x200/ffaa00/000?text=åƒç´ é£æ ¼é¢„è§ˆå›¾)

* **æ ¸å¿ƒæ¼”ç¤º**ï¼š  
  1. **åˆå§‹åŒ–**ï¼š  
     - ç‹¼â†’çº¢è‰²åƒç´ å—ï¼Œç¾Šâ†’ç»¿è‰²ï¼Œç©ºåœ°â†’é»„è‰²  
     - æºç‚¹(S)æ˜¾ç¤ºä¸ºæ°´æ³µï¼Œæ±‡ç‚¹(T)ä¸ºæ’æ°´ç®¡
  2. **BFSæ‰¾å¢å¹¿è·¯**ï¼š  
     - è“è‰²æ°´æ³¢ä»ç‹¼ç¾¤è”“å»¶ï¼ˆå¹¿åº¦ä¼˜å…ˆåŠ¨ç”»ï¼‰
     - å½“å‰è¾¹é«˜äº®é—ªçƒï¼Œæ®‹ä½™å®¹é‡å®æ—¶æ˜¾ç¤º
  3. **DFSæ›´æ–°æµé‡**ï¼š  
     - æˆåŠŸè·¯å¾„æ˜¾ç¤ºæ°´æµè½¨è¿¹ï¼ˆè“è‰²â†’ç™½è‰²æ¸å˜ï¼‰
     - å‰²è¾¹å˜çº¢æ—¶æ’­æ”¾"å’”åš“"éŸ³æ•ˆï¼ˆç¯±ç¬†å»ºç«‹ï¼‰
  4. **èƒœè´Ÿåˆ¤å®š**ï¼š  
     - å®Œå…¨åˆ†éš”æ—¶ç¾Šç¾¤å˜å®‰å…¨ç»¿ï¼Œæ’­æ”¾èƒœåˆ©éŸ³æ•ˆ

* **äº¤äº’æ§åˆ¶**ï¼š  
  ```javascript
  // ä¼ªä»£ç ç¤ºä¾‹
  class PixelAnimator {
    constructor(grid) {
        this.speed = 100; // æ¯«ç§’/æ­¥
        this.drawGrid();  // ç»˜åˆ¶åƒç´ ç½‘æ ¼
    }
    
    bfsStep() {
        // é«˜äº®å½“å‰é˜Ÿåˆ—
        drawQueue(queue, 0x3498db); 
        // æ’­æ”¾æ°´æµå£°æ•ˆ
        playSound('water-flow');
    }
    
    cutEdge(x1,y1,x2,y2) {
        drawFence(x1,y1,x2,y2); // ç»˜åˆ¶ç¯±ç¬†
        playSound('fence-build');
    }
  }
  ```

---

## 6. æ‹“å±•ç»ƒä¹ ä¸ç›¸ä¼¼é—®é¢˜

### é€šç”¨æŠ€å·§è¿ç§»
æœ€å°å‰²æ¨¡å‹é€‚ç”¨äºï¼š
1. äºŒåˆ†å›¾åˆ†å‰²ï¼ˆå¦‚é»‘ç™½æ£‹ç›˜é—®é¢˜ï¼‰
2. å†²çªæ¶ˆé™¤ï¼ˆå¦‚ç›¸é‚»ç‰©å“ä¸èƒ½å…±å­˜ï¼‰
3. èµ„æºåˆ†é…ï¼ˆå¦‚å·¥å‚-ä»“åº“ç‰©æµï¼‰

### æ¨èç»ƒä¹ ï¼ˆæ´›è°·ï¼‰ï¼š
1. **P2774 æ–¹æ ¼å–æ•°é—®é¢˜**  
   â†’ ç»ƒä¹ ç›¸é‚»äº’æ–¥é—®é¢˜çš„æœ€å°å‰²å»ºæ¨¡
   
2. **P1361 å°Mçš„ä½œç‰©**  
   â†’ å¼ºåŒ–å¤šç±»åˆ«åˆ†å‰²èƒ½åŠ›

3. **P4001 [ICPC-Beijing 2006]ç‹¼æŠ“å…”å­**  
   â†’ æŒ‘æˆ˜ä¸‰ç»´ç©ºé—´çš„æœ€å°å‰²åº”ç”¨

---

## 7. å­¦ä¹ å¿ƒå¾—ä¸ç»éªŒåˆ†äº«

> **æ¥è‡ªAubRainçš„è°ƒè¯•ç»éªŒ**ï¼š  
> "n,må†™åè°ƒäº†ä¸€ä¸ªå°æ—¶ï¼ŒåŠ¡å¿…æ³¨æ„çŸ©é˜µè¡Œåˆ—é¡ºåºï¼"

**Kayçš„æ€»ç»“**ï¼š  
> ç½‘ç»œæµé¢˜ç›®éœ€ç‰¹åˆ«æ³¨æ„ï¼š  
> 1. è¾¹ç•Œæ£€æŸ¥ï¼ˆé¿å…è¶Šç•Œå´©æºƒï¼‰  
> 2. åå‘è¾¹åˆå§‹åŒ–ï¼ˆcntä»1å¼€å§‹ï¼‰  
> 3. å®¹é‡è®¾ç½®ï¼ˆâˆç”¨0x3f3f3f3fï¼‰  
> è°ƒè¯•æ—¶æ‰“å°é‚»æ¥è¡¨å¯å¿«é€Ÿå®šä½é”™è¯¯

---

**ç»“è¯­**  
é€šè¿‡æœ€å°å‰²æ¨¡å‹ï¼Œæˆ‘ä»¬å·§å¦™åœ°å°†ç‰©ç†éš”ç¦»è½¬åŒ–ä¸ºç½‘ç»œæµé—®é¢˜ã€‚è®°ä½ï¼šç®—æ³•æœ¬è´¨æ˜¯ç°å®ä¸–ç•Œçš„æŠ½è±¡æ˜ å°„ã€‚ç»§ç»­æŒ‘æˆ˜å§ï¼Œå°‘å¹´ï¼ğŸ’ª ä¸‹æ¬¡æˆ‘ä»¬å°†æ¢ç´¢æ›´å¤æ‚çš„ç½‘ç»œæµæ¨¡å‹ã€‚

---
å¤„ç†ç”¨æ—¶ï¼š146.23ç§’
# é¢˜ç›®ä¿¡æ¯

# ã€GROI-R1ã€ ä¸€åˆ‡éƒ½å·²è¿‡å»

## é¢˜ç›®èƒŒæ™¯

æ‚¦å…³ä¸Šçª—ï¼Œæ‹‰ä¸Šå¸˜å¸ƒã€‚

æœç„¶è¿˜æ˜¯æƒ³ä¸èµ·æ¥å•Šã€‚

éšçº¦è®°å¾—æ›¾å’Œä»€ä¹ˆäººä¸€èµ·åšè¿‡è¿™æ ·çš„äº‹ã€‚

ä»°é¢èººä¸‹ï¼Œæ‰‹æ‰§ä¸€åªæœ¨ç¬ºã€‚

ã€Œç©¶ç«Ÿå¦‚ä½•ï¼Œæ‰èƒ½æ‹¥æœ‰â€œè¿‡å»â€å•Šâ€¦â€¦ã€

å¥¹é—­ä¸ŠåŒçœ¼ã€‚

ã€Œ6 å²å‰çš„è®°å¿†â€¦â€¦ç©¶ç«Ÿå¦‚ä½•æ‰èƒ½å¯»å›ï¼Ÿã€

## é¢˜ç›®æè¿°

æ‚¦æ­£åœ¨å¯»æ‰¾å¥¹çš„è®°å¿†ã€‚å¿½ç„¶ï¼Œå¥¹æ¥åˆ°äº†æœ‰ $n$ ä¸ªèŠ‚ç‚¹çš„ä¸€æ£µæ ‘ä¸Šã€‚æ ‘ä¸Šæ¯ä¸€æ¡è¾¹éƒ½æœ‰å„è‡ªè¾¹æƒï¼Œæ¯ä¸€ä¸ªç‚¹éƒ½æœ‰å„è‡ªçš„ç‚¹æƒã€‚

ã€ŒæŠŠç»å†éƒ½èšæ‹¢èµ·æ¥ï¼Œèƒ½å®Œæ•´åœ°å¤åŸå—â€¦â€¦ã€

æ‚¦ä»æ ‘ä¸Šçš„ä¸€ä¸ªç‚¹ï¼Œæ…¢æ…¢åœ°èµ°åˆ°äº†å¦ä¸€ä¸ªç‚¹ï¼Œå¯æ˜¯å¥¹ä»€ä¹ˆä¹Ÿæ²¡æ‰¾åˆ°ã€‚ä½†æ˜¯ï¼Œå¥¹ä¸çŸ¥é“ï¼Œç˜ä¸€ç›´åœ¨è¿œå¤„æœ›ç€å¥¹èµ°è¿‡çš„é“è·¯ã€‚

ç˜å‘ç°ï¼Œæ‚¦å…¨ç¨‹****æ²¡æœ‰èµ°å›å¤´è·¯****ã€‚ä»–æƒ³æŠŠæ‚¦****èµ°è¿‡çš„æ¯ä¸€æ¡è¾¹çš„è¾¹æƒä¹˜èµ·æ¥****ï¼Œå¯æƒœä»–å‘ç°ä»–é‡åˆ°äº†ä¸€ä¸ªè¿™ä¸€ç”Ÿæœªæ›¾è§åˆ°è¿‡çš„æ•°å­—ã€‚

ã€Œä¸ºä»€ä¹ˆä¼šè¿™æ ·å‘¢ï¼Ÿã€

ç˜æƒ³åˆ°æ‚¦æ˜¯çªç„¶å‡ºç°åœ¨æ ‘ä¸Šçš„ï¼Œæœ€åˆçš„ç‚¹ä¸€å®šæœ‰è¹Šè··ï¼ä»–****æŠŠæœ€åˆé‚£ä¸ªç‚¹çš„ç‚¹æƒä¹˜ä¸Š****â€¦â€¦

çªç„¶ï¼Œä¸€æŸå½¼å²¸èŠ±çš„çº¢å…‰äº®èµ·ï¼ä¸–ç•Œé‡æ–°å®‰é™äº†ä¸‹æ¥ã€‚

æ‚¦çœ‹åˆ°äº†ç˜ç•™ä¸‹çš„å­—æ ·ï¼Œå¯æƒœå¥¹ä¸èƒ½ä»ä¸­çœ‹å‡ºä»»ä½•è¿‡å»çš„è®°å¿†ã€‚ç°åœ¨ï¼Œä½ è¦å¸®å¥¹åˆ¤æ–­ï¼šæŠŠç»å†éƒ½èšæ‹¢èµ·æ¥ï¼Œ****èƒ½å®Œæ•´åœ°å¤åŸè¿‡å»å—****ï¼Ÿæˆ‘ä»¬ç§°æ‚¦çš„ä¸€æ¡è·¯å¾„èƒ½â€œå¤åŸè¿‡å»â€ï¼Œå½“ä¸”ä»…å½“ç˜****ç•™ä¸‹çš„ä¹˜ç§¯æ˜¯ä¸€ä¸ªæ•´æ•°****ã€‚

**å½¢å¼åŒ–é¢˜é¢**

ç»™å®šä¸€æ£µ $n$ ä¸ªèŠ‚ç‚¹çš„æ ‘å’Œ $q$ æ¬¡è¯¢é—®ã€‚æ¯æ¬¡è¯¢é—®ç»™å‡ºä¸¤ä¸ªæ•´æ•° $x,y$ï¼Œè¡¨ç¤ºè¯¢é—®æ ‘ä¸Šä»¥ $x$ å’Œ $y$ ä¸ºç«¯ç‚¹çš„ç®€å•è·¯å¾„ä¸Šè¾¹æƒä¹˜ç§¯ä¸ç‚¹ $x$ çš„ç‚¹æƒç›¸ä¹˜æ˜¯å¦ä¸ºæ•´æ•°ã€‚

## è¯´æ˜/æç¤º

**æ ·ä¾‹è§£é‡Š**

æ ¹æ®è¾“å…¥å¯ä»¥å¾—åˆ°ä¸‹å›¾ï¼š

![](https://cdn.luogu.com.cn/upload/image_hosting/3e4jqu6f.png)

å¯¹äºç¬¬ä¸€ä¸ªè¯¢é—® $(1,5)$ å¯ä»¥å‘ç°æ‚¦ç»è¿‡çš„è¾¹çš„è¾¹æƒåˆ†åˆ«æ˜¯ $0.1$ å’Œ $0.99$ï¼Œå¥¹å‡ºå‘çš„ $1$ å·ç‚¹çš„ç‚¹æƒä¸º $1$ã€‚$1\times0.1\times0.99=0.099$ ä¸æ˜¯æ•´æ•°ã€‚æ‰€ä»¥è¾“å‡º `No`ã€‚

å¯¹äºåé¢ä¸¤æ¬¡è¯¢é—®åŒç†ã€‚

**æ•°æ®èŒƒå›´**

**æœ¬é¢˜é‡‡ç”¨æ†ç»‘æµ‹è¯•ã€‚**

| å­ä»»åŠ¡ç¼–å· | æ•°æ®èŒƒå›´ | ç‰¹æ®Šæ€§è´¨ | åˆ†å€¼ |
| :----------: | :----------: | :----------: | :----------: |
| $\text{Subtask1}$ | $n,q\le3\times 10^3$ |  | $15$ |
| $\text{Subtask2}$ | $n\le500$ï¼Œ$q\le10^5$ |  | $10$ |
| $\text{Subtask3}$ | $n,q\le10^5$ | $\text{BE}$ | $10$ |
| $\text{Subtask4}$ | $n,q\le10^5$ | $\text{A}$ | $5$ |
| $\text{Subtask5}$ | $n,q\le10^5$ | $\text{B}$ | $10$ |
| $\text{Subtask6}$ | $n,q\le10^5$ | $\text{C}$ | $5$ |
| $\text{Subtask7}$ | $n,q\le10^5$ | $\text{D}$ | $10$ |
| $\text{Subtask8}$ | $n,q\le2Ã—10^5$ |  | $35$ |

ç‰¹æ®Šæ€§è´¨ $\text{A}$ï¼šä¿è¯æ ‘é€€åŒ–æˆä¸€æ¡é“¾ã€‚

ç‰¹æ®Šæ€§è´¨ $\text{B}$ï¼šä¿è¯æ ‘éšæœºç”Ÿæˆï¼ˆå³å¯¹äºæ¯ä¸€ä¸ªèŠ‚ç‚¹éšæœºé€‰æ‹©å®ƒçš„çˆ¶äº²èŠ‚ç‚¹ï¼‰ã€‚

ç‰¹æ®Šæ€§è´¨ $\text{C}$ï¼šä¿è¯ $w\in\{0.1,0.3,0.5,0.7,0.9\}$ã€‚

ç‰¹æ®Šæ€§è´¨ $\text{D}$ï¼šä¿è¯ $w\in\{0.1,0.2,0.3,0.4,0.6,0.7,0.8,0.9\}$ã€‚

ç‰¹æ®Šæ€§è´¨ $\text{E}$ï¼šä¿è¯ $w\le2$ ä¸” $w$ å°æ•°ä½æ•°ä¸è¶…è¿‡ $1$ ä½ã€‚

å¯¹äº $100\%$ çš„æ•°æ®æ»¡è¶³ $1\le n,q\le2\times10^5$ï¼Œ$0\le a_i\le10^9$ï¼Œ$0\le w\le10^4$ï¼Œ$1\le u,v,x,y\le n$ï¼Œ$x\ne y$ï¼Œ$w$ å°æ•°ä½æ•°ä¸è¶…è¿‡ $4$ ä½ã€‚

## æ ·ä¾‹ #1

### è¾“å…¥

```
5 3
1 2 3 4 5
1 2 0.1
2 3 0.20
3 4 0.5
2 5 0.99
1 5
1 4
4 3```

### è¾“å‡º

```
No
No
Yes```

# AIåˆ†æç»“æœ


### ğŸ’¡ Kayçš„C++ç®—æ³•è§£æï¼šã€GROI-R1ã€ä¸€åˆ‡éƒ½å·²è¿‡å» æ·±å…¥å­¦ä¹ æŒ‡å— ğŸ’¡

#### 1. é¢˜ç›®è§£è¯»ä¸æ ¸å¿ƒç®—æ³•è¯†åˆ«
âœ¨ **æœ¬é¢˜ä¸»è¦è€ƒå¯Ÿ**ï¼šæ ‘ã€LCAã€æ ‘ä¸Šå·®åˆ†  
ğŸ—£ï¸ **åˆæ­¥åˆ†æ**ï¼š
> é¢˜ç›®è¦æ±‚åˆ¤æ–­æ ‘ä¸Šè·¯å¾„è¾¹æƒä¹˜ç§¯ä¸èµ·ç‚¹ç‚¹æƒçš„ä¹˜ç§¯æ˜¯å¦ä¸ºæ•´æ•°ã€‚æ ¸å¿ƒæ€è·¯æ˜¯å°†æµ®ç‚¹æ•°è½¬åŒ–ä¸ºè´¨å› æ•°åˆ†è§£é—®é¢˜ï¼š  
> - **å…³é”®æ¯”å–»**ï¼šå°†å°æ•°çœ‹ä½œ"å¸¦åˆ†æ¯çš„åˆ†æ•°"ï¼ˆåˆ†æ¯æ˜¯10çš„å¹‚ï¼‰ï¼Œæ•´æ•°åŒ–è¦æ±‚åˆ†å­ä¸­çš„2å’Œ5å› å­æ•°é‡ â‰¥ åˆ†æ¯ä¸­çš„10çš„å› å­æ•°é‡  
> - **ç®—æ³•æµç¨‹**ï¼š  
>   1. è¾¹æƒä¹˜10â´è½¬ä¸ºæ•´æ•°ï¼Œè®°å½•åŸå§‹å°æ•°ä½æ•°  
>   2. é¢„å¤„ç†æ¯ä¸ªèŠ‚ç‚¹åˆ°æ ¹çš„ï¼šå°æ•°ä½æ•°å’Œã€2å› å­å’Œã€5å› å­å’Œ  
>   3. æŸ¥è¯¢æ—¶é€šè¿‡LCAè®¡ç®—è·¯å¾„å·®åˆ†å€¼  
> - **å¯è§†åŒ–è®¾è®¡**ï¼š  
>   ![æ ‘è·¯å¾„ç¤ºæ„å›¾](https://cdn.luogu.com.cn/upload/image_hosting/3e4jqu6f.png)  
>   ç”¨åƒç´ åŠ¨ç”»å±•ç¤ºæ ‘ç»“æ„ï¼Œé«˜äº®å½“å‰è·¯å¾„ï¼ŒåŠ¨æ€æ˜¾ç¤ºå› å­è®¡æ•°å˜åŒ–ï¼ˆå¦‚2/5å› å­ç”¨è“/çº¢åƒç´ å—è¡¨ç¤ºï¼Œå°æ•°ä½æ•°ç”¨é»„è‰²è¿›åº¦æ¡ï¼‰

---

#### 2. ç²¾é€‰ä¼˜è´¨é¢˜è§£å‚è€ƒ
**é¢˜è§£ä¸€ï¼ˆè¿Ÿæš®å¤©å¤æ˜ï¼‰**  
* **äº®ç‚¹**ï¼š  
  - æ€è·¯æ¸…æ™°ç›´å‡»æœ¬è´¨ï¼ˆå› å­è®¡æ•°+æ ‘ä¸Šå·®åˆ†ï¼‰  
  - ä»£ç è§„èŒƒï¼ˆLCAå€å¢å®ç°ä¼˜é›…ï¼‰  
  - ä¸¥è°¨å¤„ç†0å€¼ï¼ˆè®¾ä¸ºæå¤§å€¼ï¼‰  
  > *"å°†é—®é¢˜è½¬åŒ–ä¸ºå› å­2/5çš„ç»Ÿè®¡æ˜¯æœ¬é¢˜å…³é”®"*

**é¢˜è§£äºŒï¼ˆStars_visitor_tywï¼‰**  
* **äº®ç‚¹**ï¼š  
  - è¯¦ç»†è§£é‡Šæµ®ç‚¹æ•°è½¬åŒ–åŸç†  
  - å®Œæ•´è¾¹ç•Œå¤„ç†ï¼ˆç‚¹æƒ/è¾¹æƒä¸º0ï¼‰  
  - ä»£ç å˜é‡åè¯­ä¹‰æ˜ç¡®ï¼ˆcnt2/cnt5ï¼‰  
  > *"é¢„å¤„ç†å› å­è®¡æ•°å¦‚åŒé“ºè®¾ç®¡é“ï¼ŒLCAæ˜¯è¿æ¥æ¢çº½"*

**é¢˜è§£ä¸‰ï¼ˆmasonpopï¼‰**  
* **äº®ç‚¹**ï¼š  
  - ç‰¹åˆ«å¼ºè°ƒè°ƒè¯•å‘ç‚¹ï¼ˆ0å€¼å¤„ç†ï¼‰  
  - åˆ†ç¦»ç»´æŠ¤0å€¼è®¡æ•°å™¨  
  - ä»£ç é²æ£’æ€§å¼ºï¼ˆé¿å…æ­»å¾ªç¯ï¼‰  
  > *"0æ˜¯ç‰¹æ®Šå“¨å…µï¼Œéœ€è¦å•ç‹¬å®ˆå«è·¯å¾„"*

---

#### 3. æ ¸å¿ƒéš¾ç‚¹è¾¨æä¸è§£é¢˜ç­–ç•¥
1. **æµ®ç‚¹æ•°ç²¾åº¦å¤„ç†**  
   * **åˆ†æ**ï¼šç›´æ¥è®¡ç®—ä¹˜ç§¯ä¼šæº¢å‡ºï¼Œéœ€å°†å°æ•°è½¬åŒ–ä¸ºæ•´æ•°å› å­è®¡æ•°  
   * ğŸ’¡ **å­¦ä¹ ç¬”è®°**ï¼šæµ®ç‚¹é—®é¢˜å¸¸è½¬åŒ–ä¸ºæ•´æ•°åˆ†è§£é—®é¢˜

2. **æ ‘ä¸Šè·¯å¾„ç»Ÿè®¡**  
   * **åˆ†æ**ï¼šé€šè¿‡LCA+å·®åˆ†å®ç°O(1)è·¯å¾„æŸ¥è¯¢  
   ``` 
   sum_path = sum[u] + sum[v] - 2 * sum[lca]
   ```

3. **0å€¼ç‰¹åˆ¤é€»è¾‘**  
   * **åˆ†æ**ï¼š0ä¹˜ä»¥ä»»ä½•æ•°ä¸º0ï¼ˆæ•´æ•°ï¼‰ï¼Œéœ€è®¾å› å­æ•°ä¸ºæå¤§å€¼  
   * ğŸ’¡ **å­¦ä¹ ç¬”è®°**ï¼šç‰¹æ®Šå€¼è¦å»ºç«‹"ç†”æ–­æœºåˆ¶"

âœ¨ **è§£é¢˜æŠ€å·§æ€»ç»“**ï¼š  
- **å› å­åˆ†è§£æ³•**ï¼šç”¨è´¨å› æ•°åˆ†è§£ä»£æ›¿æµ®ç‚¹è¿ç®—  
- **å·®åˆ†æ€æƒ³**ï¼šæ ‘ä¸Šå‰ç¼€å’Œæ˜¯è·¯å¾„ç»Ÿè®¡åˆ©å™¨  
- **é˜²å¾¡æ€§ç¼–ç¨‹**ï¼šå¯¹è¾¹ç•Œå€¼(0)å»ºç«‹å•ç‹¬å¤„ç†é€šé“

---

#### 4. C++æ ¸å¿ƒä»£ç å®ç°èµæ
**é€šç”¨æ ¸å¿ƒå®ç°**ï¼ˆç»¼åˆä¼˜è´¨é¢˜è§£ï¼‰ï¼š
```cpp
#include <bits/stdc++.h>
using namespace std;
const int N = 2e5 + 5, INF = 1e9;

vector<pair<int, int>> G[N]; // {to, è¾¹æƒæ•´æ•°}
int dep[N], fa[20][N], two[N], five[N], decim[N]; // 2/5å› å­æ•°ã€å°æ•°ä½æ•°

int count_factor(int x, int p) {
    if(!x) return INF; // 0ç‰¹åˆ¤
    int cnt = 0;
    while (x % p == 0) cnt++, x /= p;
    return cnt;
}

void dfs(int u, int f) {
    for (auto [v, w] : G[u]) if (v != f) {
        dep[v] = dep[u] + 1;
        two[v] = two[u] + count_factor(w, 2);
        five[v] = five[u] + count_factor(w, 5);
        decim[v] = decim[u] + (w ? 4 : 0); // ä¹˜10^4äº§ç”Ÿ4ä½
        fa[0][v] = u;
        for (int i = 1; i < 20; ++i) 
            fa[i][v] = fa[i-1][fa[i-1][v]];
        dfs(v, u);
    }
}

int lca(int u, int v) {
    if (dep[u] < dep[v]) swap(u, v);
    for (int i = 19; i >= 0; --i)
        if (dep[u] - (1 << i) >= dep[v])
            u = fa[i][u];
    if (u == v) return u;
    for (int i = 19; i >= 0; --i)
        if (fa[i][u] != fa[i][v])
            u = fa[i][u], v = fa[i][v];
    return fa[0][u];
}

int main() {
    // åˆå§‹åŒ–åŠè¾“å…¥ç•¥
    dfs(1, 0);
    while (q--) {
        int x, y; cin >> x >> y;
        int p = lca(x, y);
        int total_decim = decim[x] + decim[y] - 2 * decim[p];
        int total_two = two[x] + two[y] - 2 * two[p] + count_factor(a[x], 2);
        int total_five = five[x] + five[y] - 2 * five[p] + count_factor(a[x], 5);
        cout << (min(total_two, total_five) >= total_decim ? "Yes\n" : "No\n");
    }
}
```

**ä»£ç è§£è¯»æ¦‚è¦**ï¼š  
> - é€šè¿‡DFSé¢„å¤„ç†æ ‘ä¸Šå·®åˆ†æ•°ç»„å’Œå€å¢LCA  
> - æŸ¥è¯¢æ—¶é€šè¿‡LCAè®¡ç®—è·¯å¾„å·®åˆ†å€¼  
> - æ ¸å¿ƒåˆ¤æ–­ï¼šè·¯å¾„ä¸Š2/5å› å­æœ€å°å€¼ â‰¥ å°æ•°ä½æ•°  

---

#### 5. ç®—æ³•å¯è§†åŒ–ï¼šåƒç´ åŠ¨ç”»æ¼”ç¤º
![ç®—æ³•æ¼”ç¤ºç¤ºæ„å›¾](https://cdn.luogu.com.cn/upload/image_hosting/3e4jqu6f.png)  
* **ä¸»é¢˜**ï¼šåƒç´ æ¢é™©å®¶åœ¨æ ‘è¿·å®«æ”¶é›†2/5å› å­  
* **äº¤äº’è®¾è®¡**ï¼š  
  1. **8-bité£æ ¼æ ‘**ï¼šèŠ‚ç‚¹ç”¨åƒç´ æ–¹å—è¡¨ç¤ºï¼Œè¾¹æƒæ˜¾ç¤ºä¸ºæµ®åŠ¨æ•°å­—  
  2. **å› å­æ”¶é›†åŠ¨ç”»**ï¼š  
     - è“/çº¢åƒç´ å—ä»£è¡¨2/5å› å­ï¼Œéšè·¯å¾„å»¶ä¼¸è€Œå¢åŠ   
     - é»„è‰²è¿›åº¦æ¡æ˜¾ç¤ºå°æ•°ä½æ•°è¦æ±‚  
  3. **éŸ³æ•ˆç³»ç»Ÿ**ï¼š  
     - æ”¶é›†å› å­ï¼š"å®"ï¼ˆ8-bitéŸ³æ•ˆï¼‰  
     - è¾¾æˆæ¡ä»¶ï¼šèƒœåˆ©æ—‹å¾‹  
  4. **æ§åˆ¶é¢æ¿**ï¼š  
     - æ­¥è¿›æ§åˆ¶ï¼šå•æ­¥/è‡ªåŠ¨æ’­æ”¾ï¼ˆé€Ÿåº¦å¯è°ƒï¼‰  
     - æ¯”è¾ƒæ¨¡å¼ï¼šå¹¶æ’å±•ç¤ºä¸åŒè§£æ³•å› å­æ”¶é›†æ•ˆç‡  

---

#### 6. æ‹“å±•ç»ƒä¹ ä¸ç›¸ä¼¼é—®é¢˜
1. **æ´›è°· P3384** - æ ‘é“¾å‰–åˆ†æ¨¡æ¿  
   > ğŸ—£ï¸ å·©å›ºæ ‘ä¸Šå·®åˆ†æ€æƒ³  
2. **AT_agc047_a** - æµ®ç‚¹æ•°ä¹˜ç§¯åˆ¤æ–­  
   > ğŸ—£ï¸ ç»ƒä¹ å› å­åˆ†è§£æŠ€å·§  
3. **æ´›è°· P3379** - LCAæ¨¡æ¿  
   > ğŸ—£ï¸ æŒæ¡å€å¢ç®—æ³•åŸºç¡€  

---

#### 7. å­¦ä¹ å¿ƒå¾—ä¸ç»éªŒåˆ†äº«
> **ç»éªŒæ‘˜å½•**ï¼ˆmasonpopï¼‰ï¼š  
> *"è°ƒè¯•æ—¶è¢«0å€¼å‘æƒ¨äº†ï¼Œå¿…é¡»å»ºç«‹ç‰¹åˆ¤é€šé“"*  
> **Kayç‚¹è¯„**ï¼š  
> ç¼–ç¨‹ä¸­ç‰¹æ®Šå€¼å°±åƒé“è·¯ä¸Šçš„é™·é˜±ï¼Œæå‰è®¾ç½®è­¦ç¤ºæ ‡è¯†ï¼ˆå¦‚`INF`ï¼‰æ˜¯é¿å…è¸©å‘çš„å…³é”®ã€‚å»ºè®®ï¼š  
> - å¯¹è¾¹ç•Œå€¼ä¿æŒæ¡ä»¶åå°„å¼è­¦æƒ•  
> - ç”¨é˜²å¾¡æ€§ç¼–ç¨‹æ„å»º"å®‰å…¨æŠ¤æ "  

> **è®°ä½**ï¼šæ€è€ƒç®—æ³•çš„æœ¬è´¨æ¯”å®ç°æ›´é‡è¦ï¼Œè´¨å› æ•°åˆ†è§£æ˜¯å¤„ç†æ•°å­—é—®é¢˜çš„ç‘å£«å†›åˆ€ï¼ğŸ’ª

---
å¤„ç†ç”¨æ—¶ï¼š115.43ç§’
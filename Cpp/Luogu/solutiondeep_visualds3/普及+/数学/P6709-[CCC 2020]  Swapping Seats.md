# é¢˜ç›®ä¿¡æ¯

# [CCC 2020]  Swapping Seats

## é¢˜ç›®æè¿°

æœ‰ $N$ ä¸ªäººååœ¨ä¸€å¼ **åœ†**æ¡Œæ—ã€‚

å…±æœ‰ä¸‰ä¸ªæ´¾åˆ«ï¼Œæ¯ä¸€ä¸ªäººå±äºä¸€ä¸ªæ´¾åˆ«ã€‚

ç°åœ¨ï¼Œæ‚¨æƒ³ä½¿å±äºåŒä¸€æ´¾åˆ«çš„äººååˆ°ä¸€èµ·ã€‚

æ‚¨å¯ä»¥æ¯æ¬¡å°†ä¸¤ä¸ªäººäº¤æ¢ä½ç½®ï¼Œè¾“å‡ºæœ€å°çš„äº¤æ¢æ¬¡æ•°ã€‚

## è¯´æ˜/æç¤º

#### æ ·ä¾‹è§£é‡Š
$\texttt{BABCBCACCA}\to\texttt{AABCBCBCCA}\to\texttt{AABBBCCCCA}$ã€‚

#### å­ä»»åŠ¡
**æœ¬é¢˜é‡‡ç”¨æ†ç»‘æµ‹è¯•ï¼Œä¸”æœ¬é¢˜çš„ Subtask åˆ†æ•°æœ‰å¾®è°ƒã€‚**
- Subtask 1ï¼ˆ$26$ åˆ†ï¼‰ï¼š$s_i\in\{$`A`$,$`B`$\}$ ä¸” $N\le 5\times 10^3$ã€‚
- Subtask 2ï¼ˆ$27$ åˆ†ï¼‰ï¼š$s_i\in\{$`A`$,$`B`$\}$ã€‚
- Subtask 3ï¼ˆ$27$ åˆ†ï¼‰ï¼š$N\le 5\times 10^3$ã€‚
- Subtask 4ï¼ˆ$20$ åˆ†ï¼‰ï¼šæ— ç‰¹æ®Šé™åˆ¶ã€‚

å¯¹äº $100\%$ çš„æ•°æ®ï¼Œä¿è¯ $s_i\in\{$`A`$,$`B`$,$`C`$\}$ï¼Œ$1\le N\le 10^6$ã€‚

#### è¯´æ˜
æœ¬é¢˜è¯‘è‡ª [Canadian Computing Competition](https://cemc.uwaterloo.ca/resources/past-contests?contest_category=29) [2020 Senior](https://cemc.uwaterloo.ca/sites/default/files/documents/2020/seniorEF.pdf) T4 Swapping Seatsã€‚

## æ ·ä¾‹ #1

### è¾“å…¥

```
BABCBCACCA```

### è¾“å‡º

```
2```

# AIåˆ†æç»“æœ


### ğŸ’¡ Kayçš„C++ç®—æ³•è§£æï¼šSwapping Seats æ·±å…¥å­¦ä¹ æŒ‡å— ğŸ’¡

#### é¢˜ç›®è§£è¯»ä¸æ ¸å¿ƒç®—æ³•è¯†åˆ«
âœ¨ **æœ¬é¢˜ä¸»è¦è€ƒå¯Ÿ**ï¼šæšä¸¾ + å‰ç¼€å’Œä¼˜åŒ– + è´ªå¿ƒç­–ç•¥  
ğŸ—£ï¸ **åˆæ­¥åˆ†æ**ï¼š  
> è§£å†³è¿™é“é¢˜çš„å…³é”®åœ¨äº**æšä¸¾ç¯å½¢èµ·ç‚¹**å’Œ**è´ªå¿ƒä¼˜åŒ–äº¤æ¢æ¬¡æ•°**ã€‚æƒ³è±¡ä½ åœ¨æ•´ç†ä¸‰ç§é¢œè‰²çš„ç³–æœï¼ˆA/B/Cï¼‰ï¼Œéœ€è¦æœ€å°‘çš„äº¤æ¢æ¬¡æ•°è®©åŒè‰²ç³–æœç›¸é‚»ã€‚  
> - æ ¸å¿ƒæ€è·¯ï¼šé€šè¿‡ç ´ç¯æˆé“¾ï¼ˆå¤åˆ¶å­—ç¬¦ä¸²ï¼‰ï¼Œæšä¸¾æ¯ä¸ªèµ·ç‚¹ä½œä¸ºAåŒºçš„å¼€å§‹ï¼Œè€ƒè™‘ä¸¤ç§æ’åˆ—é¡ºåºï¼ˆABCæˆ–ACBï¼‰ã€‚åˆ©ç”¨å‰ç¼€å’Œå¿«é€Ÿè®¡ç®—å„åŒºé—´æ‚è´¨æ•°é‡ï¼Œç”¨è´ªå¿ƒæ€æƒ³ä¼˜å…ˆè¿›è¡Œ"åŒå‘äº¤æ¢"ï¼ˆä¸€æ¬¡äº¤æ¢è§£å†³ä¸¤ä¸ªæ‚è´¨ï¼‰ã€‚  
> - å¯è§†åŒ–è®¾è®¡ï¼šåœ¨åƒç´ åŠ¨ç”»ä¸­å°†åœ†æ¡Œå±•å¼€ä¸ºç¯å½¢æ¡å¸¦ï¼Œé«˜äº®æ˜¾ç¤ºå½“å‰æšä¸¾èµ·ç‚¹ã€‚ç”¨ä¸åŒé¢œè‰²åŒºåˆ†A/B/CåŒºï¼Œé—ªçƒæ ‡è®°æ‚è´¨ï¼ˆå¦‚AåŒºçš„Bç³–æœï¼‰ï¼Œäº¤æ¢æ—¶ç”¨ç®­å¤´åŠ¨ç”»å±•ç¤ºç³–æœç§»åŠ¨è½¨è¿¹ï¼Œå¹¶ä¼´éš8-bitéŸ³æ•ˆã€‚  
> - å¤å¤æ¸¸æˆåŒ–ï¼šè®¾è®¡"è‡ªåŠ¨é—¯å…³"æ¨¡å¼ï¼ŒAIè§’è‰²"åƒç´ å°åŠ©æ‰‹"é€æ­¥æ¼”ç¤ºæšä¸¾è¿‡ç¨‹ï¼Œæ¯æ‰¾åˆ°æ›´ä¼˜è§£æ—¶æ’­æ”¾èƒœåˆ©éŸ³æ•ˆï¼Œé€šå…³åæ˜¾ç¤ºæœ€å°äº¤æ¢æ¬¡æ•°ã€‚

---

#### ç²¾é€‰ä¼˜è´¨é¢˜è§£å‚è€ƒ
**é¢˜è§£ä¸€ï¼ˆä½œè€…ï¼šgznppï¼‰**  
* **ç‚¹è¯„**ï¼šæ€è·¯æ¸…æ™°ç›´å‡»æ ¸å¿ƒï¼Œæ¨å¯¼å‡º**äº¤æ¢æ¬¡æ•° = max(æ‚è´¨A, æ‚è´¨B) + æ®‹ç•™æ‚è´¨**çš„ç®€æ´å…¬å¼ã€‚ä»£ç è§„èŒƒé«˜æ•ˆï¼š  
  - å‰ç¼€å’Œé¢„å¤„ç†ï¼ˆ`sa/sb/sc`æ•°ç»„ï¼‰å®ç°O(1)åŒºé—´æŸ¥è¯¢  
  - ç ´ç¯æˆé“¾å¤„ç†å·§å¦™ï¼Œè¾¹ç•Œæ¡ä»¶ä¸¥è°¨  
  - æ—¶é—´å¤æ‚åº¦O(n)å®Œç¾æ»¡è¶³1e6æ•°æ®é‡  
  äº®ç‚¹ï¼šå°†USACOä¸‰å€¼æ’åºæ€æƒ³è¿ç§»åˆ°ç¯å½¢åœºæ™¯ï¼Œå…¬å¼æ¨å¯¼æå…·å¯å‘æ€§ã€‚

**é¢˜è§£äºŒï¼ˆä½œè€…ï¼šY_ATM_Kï¼‰**  
* **ç‚¹è¯„**ï¼šé‡‡ç”¨**åˆ†æ­¥æ¨è¿›æ³•**ï¼Œå…ˆä»ä¸¤æ´¾åˆ«é—®é¢˜å¼•å…¥å†æ‰©å±•åˆ°ä¸‰æ´¾åˆ«ï¼Œæ•™å­¦æ€§å¼ºã€‚ä»£ç ä¸­ï¼š  
  - å®å®šä¹‰`A(x,y)`æå‡å¯è¯»æ€§  
  - æ˜¾å¼è®¡ç®—å„ç±»æ‚è´¨æ•°é‡ï¼ˆ`s1/s2/s3/s4`ï¼‰  
  - è¾¹ç•Œå¤„ç†é€šè¿‡åŒºé—´é•¿åº¦æ§åˆ¶é¿å…è¶Šç•Œ  
  äº®ç‚¹ï¼šé€šè¿‡`(s3>s1?s3-s1:0)`ç›´è§‚å±•ç¤ºè´ªå¿ƒä¼˜åŒ–è¿‡ç¨‹ï¼Œæ˜“äºç†è§£ã€‚

**é¢˜è§£ä¸‰ï¼ˆä½œè€…ï¼šNero_Claudiusï¼‰**  
* **ç‚¹è¯„**ï¼šä¾§é‡**æ€ç»´å¼•å¯¼**ï¼Œè¯¦ç»†æè¿°"ç®€åŒ–é—®é¢˜->æ‰©å±•çº¦æŸ"çš„æ€è€ƒè·¯å¾„ã€‚ä»£ç ä¸­ï¼š  
  - ç‹¬ç«‹å‡½æ•°`calc()`å°è£…æ‚è´¨ç»Ÿè®¡  
  - æ³¨é‡Šä¸°å¯Œè§£é‡ŠçŠ¶æ€å«ä¹‰  
  - å®‰å…¨æšä¸¾é˜²æ­¢è¶Šç•Œ  
  äº®ç‚¹ï¼šå°†æŠ½è±¡é—®é¢˜è½¬åŒ–ä¸º`tmpb/tmpc`ç­‰å…·è±¡å˜é‡ï¼Œå¸®åŠ©åˆå­¦è€…å»ºç«‹æ•°å­¦æ¨¡å‹ã€‚

---

#### æ ¸å¿ƒéš¾ç‚¹è¾¨æä¸è§£é¢˜ç­–ç•¥
1. **éš¾ç‚¹ï¼šç¯çŠ¶ç»“æ„çš„å¤„ç†**  
   * **åˆ†æ**ï¼šé€šè¿‡å¤åˆ¶å­—ç¬¦ä¸²åˆ°ä¸¤å€é•¿åº¦ï¼ˆç ´ç¯æˆé“¾ï¼‰ï¼Œæšä¸¾èµ·ç‚¹æ—¶åªéœ€éå†1~nä½ç½®ã€‚å‰ç¼€å’Œæ•°ç»„`sa/sb/sc`æ”¯æŒå¿«é€ŸæŸ¥è¯¢ä»»æ„åŒºé—´å†…å„å…ƒç´ æ•°é‡ã€‚  
   * ğŸ’¡ **å­¦ä¹ ç¬”è®°**ï¼šç¯å½¢é—®é¢˜è½¬é“¾å¼æ˜¯é€šç”¨æŠ€å·§ï¼Œéœ€ä¿è¯å¤åˆ¶ååŒºé—´é•¿åº¦â‰¥2n-1ã€‚

2. **éš¾ç‚¹ï¼šäº¤æ¢æ¬¡æ•°çš„è´ªå¿ƒä¼˜åŒ–**  
   * **åˆ†æ**ï¼šä¼˜å…ˆäº¤æ¢"åŒå‘æ‚è´¨"ï¼ˆå¦‚AåŒºçš„Bå’ŒBåŒºçš„Aï¼‰ï¼Œä¸€æ¬¡äº¤æ¢è§£å†³ä¸¤ä¸ªé”™è¯¯ä½ç½®ã€‚æ®‹ç•™æ‚è´¨åªèƒ½å•ç‹¬å¤„ç†ï¼Œæ¬¡æ•°=æ€»æ‚è´¨æ•° - æœ‰æ•ˆäº¤æ¢å¯¹æ•°ã€‚  
   * ğŸ’¡ **å­¦ä¹ ç¬”è®°**ï¼šè´ªå¿ƒæ ¸å¿ƒå…¬å¼ï¼š`äº¤æ¢æ¬¡æ•° = max(AåŒºBæ•°, BåŒºAæ•°) + (AåŒºCæ•° + BåŒºCæ•°)`ã€‚

3. **éš¾ç‚¹ï¼šæ’åˆ—é¡ºåºçš„å†³ç­–**  
   * **åˆ†æ**ï¼šåŒä¸€èµ·ç‚¹éœ€è®¡ç®—ABCå’ŒACBä¸¤ç§æ’åˆ—ã€‚å…³é”®æ¯”è¾ƒï¼š  
     ```cpp
     cost1 = max(B_in_A, A_in_B) + (total_C - C_in_C);
     cost2 = max(C_in_A, A_in_C) + (total_B - B_in_B);
     ```
   * ğŸ’¡ **å­¦ä¹ ç¬”è®°**ï¼šåˆ©ç”¨å¯¹ç§°æ€§é¿å…å…¨æ’åˆ—æšä¸¾ï¼Œåªéœ€å›ºå®šAèµ·å§‹ä½ç½®ã€‚

âœ¨ **è§£é¢˜æŠ€å·§æ€»ç»“**  
- **ç ´ç¯æˆé“¾æ³•**ï¼šç¯å½¢ç»“æ„å¤åˆ¶æ‰©å±•ä¸ºçº¿æ€§  
- **å‰ç¼€å’Œé¢„è®¡ç®—**ï¼šO(1)å“åº”åŒºé—´æŸ¥è¯¢  
- **è´ªå¿ƒä¼˜å…ˆçº§**ï¼šåŒå‘äº¤æ¢ > å•å‘äº¤æ¢  
- **å˜é‡å‘½åæŠ€å·§**ï¼š`sa/sb/sc`ç›´æŒ‡å…ƒç´ ç±»å‹ï¼Œ`nx1/nx2`æ ‡è®°åŒºé—´è¾¹ç•Œ  

---

#### C++æ ¸å¿ƒä»£ç å®ç°èµæ
**é€šç”¨æ ¸å¿ƒå®ç°ï¼ˆç»¼åˆä¼˜åŒ–ç‰ˆï¼‰**  
```cpp
#include <bits/stdc++.h>
using namespace std;
const int N = 2e6 + 10; // ä¸¤å€ç©ºé—´å¤„ç†ç¯å½¢

int main() {
    char s[N];
    scanf("%s", s + 1);
    int n = strlen(s + 1);
    int cntA = 0, cntB = 0, cntC = 0;
    
    // ç ´ç¯æˆé“¾ & è®¡æ•°
    for (int i = 1; i <= n; ++i) {
        s[i + n] = s[i];
        if (s[i] == 'A') cntA++;
        else if (s[i] == 'B') cntB++;
        else cntC++;
    }
    
    // å‰ç¼€å’Œé¢„å¤„ç†
    vector<int> sa(2*n+1), sb(2*n+1), sc(2*n+1);
    for (int i = 1; i <= 2*n; ++i) {
        sa[i] = sa[i-1] + (s[i]=='A');
        sb[i] = sb[i-1] + (s[i]=='B');
        sc[i] = sc[i-1] + (s[i]=='C');
    }
    
    // æšä¸¾èµ·ç‚¹ + åŒæ’åˆ—æ¯”è¾ƒ
    int ans = INT_MAX;
    for (int start = 1; start <= n; ++start) {
        // æ’åˆ—1: A->B->C
        int endA = start + cntA - 1;
        int endB = endA + cntB;
        int cost1 = max(
            sb[endA] - sb[start-1],    // AåŒºBå…ƒç´ 
            sa[endB] - sa[endA]        // BåŒºAå…ƒç´ 
        ) + (cntC - (sc[start+n-1] - sc[endB])); // Cæ‚è´¨
        
        // æ’åˆ—2: A->C->B
        int endC = endA + cntC;
        int cost2 = max(
            sc[endA] - sc[start-1],    // AåŒºCå…ƒç´ 
            sa[endC] - sa[endA]         // CåŒºAå…ƒç´ 
        ) + (cntB - (sb[start+n-1] - sb[endC])); // Bæ‚è´¨
        
        ans = min(ans, min(cost1, cost2));
    }
    cout << ans;
}
```
**ä»£ç è§£è¯»æ¦‚è¦**ï¼š  
1. **ç¯å½¢å¤„ç†**ï¼šç¬¬9è¡Œå¤åˆ¶å­—ç¬¦ä¸²å®ç°ç ´ç¯æˆé“¾  
2. **å‰ç¼€å’Œ**ï¼š14-18è¡Œæ„å»º`sa/sb/sc`æ•°ç»„ï¼Œæ”¯æŒO(1)æŸ¥è¯¢ä»»æ„åŒºé—´å…ƒç´ æ•°é‡  
3. **åŒæ’åˆ—å†³ç­–**ï¼š25-35è¡Œå¯¹æ¯ä¸ªèµ·ç‚¹è®¡ç®—ABC/ACBä¸¤ç§æ’åˆ—æˆæœ¬  
4. **è´ªå¿ƒæ ¸å¿ƒ**ï¼š27-28è¡Œç”¨`max`è®¡ç®—åŒå‘äº¤æ¢æ”¶ç›Šï¼Œ`cntC - (...)è®¡ç®—æ®‹ç•™æ‚è´¨  

---

#### ç®—æ³•å¯è§†åŒ–ï¼šåƒç´ åŠ¨ç”»æ¼”ç¤º
**ä¸»é¢˜**ï¼šç¯å½¢ç³–æœæ•´ç†å¤§å†’é™©ï¼ˆ8-bitåƒç´ é£ï¼‰  
**æ ¸å¿ƒäº¤äº’è®¾è®¡**ï¼š  
```mermaid
graph LR
    A[ç¯å½¢ç³–æœæ¡Œ] --> B[ç‚¹å‡»èµ·ç‚¹]
    B --> C[è‡ªåŠ¨åˆ’åˆ†A/B/CåŒº]
    C --> D[é«˜äº®æ˜¾ç¤ºæ‚è´¨]
    D --> E[äº¤æ¢åŠ¨ç”»]
```

**å…³é”®åŠ¨ç”»å¸§**ï¼š  
1. **åˆå§‹åŒ–åœºæ™¯**ï¼š  
   - ç¯å½¢æ¡Œå±•å¹³æˆåƒç´ æ¡å¸¦ï¼ˆå¤å¤çº¢ç™½æœºé…è‰²ï¼‰  
   - æ§åˆ¶é¢æ¿ï¼šå¼€å§‹/æ­¥è¿›/é€Ÿåº¦æ»‘å—ï¼ˆåƒç´ åŒ–æŒ‰é’®ï¼‰  

2. **æšä¸¾èµ·ç‚¹æ¼”ç¤º**ï¼š  
   - å‘å…‰åƒç´ ç®­å¤´æ²¿æ¡å¸¦ç§»åŠ¨æ ‡è®°å½“å‰èµ·ç‚¹  
   - AåŒºï¼ˆè“è‰²ï¼‰ã€BåŒºï¼ˆé»„è‰²ï¼‰ã€CåŒºï¼ˆç»¿è‰²ï¼‰åŠ¨æ€åˆ’åˆ†  

3. **æ‚è´¨é«˜äº®ä¸äº¤æ¢**ï¼š  
   - AåŒºä¸­çš„Bç³–æœâ†’é—ªçƒçº¢æ¡†ï¼ŒBåŒºä¸­çš„Aç³–æœâ†’é—ªçƒè“æ¡†  
   - åŒå‘äº¤æ¢ï¼šç³–æœæ²¿æŠ›ç‰©çº¿è½¨è¿¹äº¤æ¢ä½ç½®ï¼Œä¼´éš"å®"å£°  
   - å•å‘äº¤æ¢ï¼šç³–æœç§»åŠ¨åˆ°ç›®æ ‡åŒºï¼Œä¼´éš"å“’"å£°  

4. **æ¸¸æˆåŒ–å…ƒç´ **ï¼š  
   - æ¯æ¬¡æ‰¾åˆ°æ›´ä¼˜è§£ï¼šåƒç´ çƒŸèŠ±çˆ†ç‚¸ + ä¸Šå‡éŸ³é˜¶  
   - é€šå…³ç»“ç®—ï¼šæ˜¾ç¤ºæœ€å°äº¤æ¢æ¬¡æ•°çš„8-bitæ•°å­—åŠ¨ç”»  

**æŠ€æœ¯å®ç°**ï¼šCanvasç»˜åˆ¶åŠ¨æ€ç½‘æ ¼ï¼ŒWeb Audio APIè§¦å‘éŸ³æ•ˆï¼Œå…³é”®å˜é‡å®æ—¶æ˜¾ç¤ºåœ¨ä¾§è¾¹æ ã€‚  

---

#### æ‹“å±•ç»ƒä¹ ä¸ç›¸ä¼¼é—®é¢˜æ€è€ƒ
**é€šç”¨æŠ€å·§è¿ç§»**ï¼š  
1. **ç¯å½¢ç»“æ„**ï¼šå‡åˆ†çº¸ç‰Œé—®é¢˜ï¼ˆç¯çŠ¶ç‰©èµ„åˆ†é…ï¼‰  
2. **å‰ç¼€å’Œ+æšä¸¾**ï¼šæœ€å¤§å­æ®µå’Œï¼ˆç¯å½¢å˜å¼ï¼‰  
3. **è´ªå¿ƒäº¤æ¢**ï¼šç›¸é‚»å…ƒç´ äº¤æ¢æ’åºï¼ˆå†’æ³¡æ’åºä¼˜åŒ–ï¼‰  

**æ´›è°·æ¨è**ï¼š  
1. [P2512 ç³–æœä¼ é€’](https://www.luogu.com.cn/problem/P2512)  
   â†’ å·©å›ºç¯å½¢é—®é¢˜ä¸æ•°å­¦æ¨å¯¼  
2. [P1121 ç¯çŠ¶æœ€å¤§å­æ®µå’Œ](https://www.luogu.com.cn/problem/P1121)  
   â†’ å¼ºåŒ–ç ´ç¯æˆé“¾ä¸å‰ç¼€å’ŒæŠ€å·§  
3. [P1459 ä¸‰å€¼çš„æ’åº](https://www.luogu.com.cn/problem/P1459)  
   â†’ æŒæ¡è´ªå¿ƒäº¤æ¢çš„æ ¸å¿ƒæ€æƒ³  

---

#### å­¦ä¹ å¿ƒå¾—ä¸ç»éªŒåˆ†äº«
> **æ¥è‡ªé¢˜è§£ä½œè€…çš„è°ƒè¯•ç»éªŒ**ï¼š  
> â€œåˆå§‹åŒ–å‰ç¼€å’Œæ•°ç»„æ—¶æ›¾é—æ¼`s[i+n] = s[i]`å¯¼è‡´è¶Šç•Œï¼Œå»ºè®®ç”¨`vector`é¢„ç•™2å€ç©ºé—´é¿å…æº¢å‡ºâ€  
>   
> **Kayæ€»ç»“**ï¼šç¯å½¢é—®é¢˜éœ€ç‰¹åˆ«æ³¨æ„ï¼š  
> 1. æ•°ç»„é•¿åº¦ â‰¥ 2n  
> 2. åŒºé—´æŸ¥è¯¢ç»ˆç‚¹ â‰¤ start + n - 1  
> 3. å‰ç¼€å’Œä¸‹æ ‡ä»1å¼€å§‹æ›´æ˜“å¤„ç†è¾¹ç•Œ  

---

é€šè¿‡æœ¬æŒ‡å—ï¼Œå¸Œæœ›å¤§å®¶æŒæ¡ç¯å½¢é—®é¢˜çš„å¤„ç†èŒƒå¼ä¸è´ªå¿ƒä¼˜åŒ–æ€æƒ³ã€‚è®°ä½ï¼šå¥½ç®—æ³• = è§‚å¯Ÿè§„å¾‹ + åˆ†æ­¥ä¼˜åŒ– + ä»£ç ä¸¥è°¨ï¼ä¸‹æ¬¡æŒ‘æˆ˜è§ï¼ğŸ’ª

---
å¤„ç†ç”¨æ—¶ï¼š254.64ç§’
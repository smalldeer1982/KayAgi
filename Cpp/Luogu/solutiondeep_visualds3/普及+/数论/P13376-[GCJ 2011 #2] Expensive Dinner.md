# é¢˜ç›®ä¿¡æ¯

# [GCJ 2011 #2] Expensive Dinner

## é¢˜ç›®æè¿°

ä½ çš„æœ‹å‹ä»¬ä»Šæ™šéƒ½è¦å»ä¸€å®¶é¤å…åƒé¥­ã€‚ä»–ä»¬éƒ½éå¸¸æ“…é•¿æ•°å­¦ï¼Œä½†ä¹Ÿéƒ½å¾ˆå¥‡æ€ªï¼šä½ çš„ç¬¬ $a$ ä¸ªæœ‹å‹ï¼ˆä» 1 å¼€å§‹ç¼–å·ï¼‰åªæœ‰å½“é¤è´¹æ€»é¢æ˜¯ä¸€ä¸ªæ­£æ•´æ•°ä¸”èƒ½è¢« $a$ æ•´é™¤æ—¶æ‰ä¼šæ„Ÿåˆ°æ»¡æ„ã€‚

ä½ çš„æœ‹å‹ä»¬ä¼šä¾æ¬¡è¿›å…¥é¤å…ã€‚æ¯å½“æœ‰ä¸€ä¸ªäººè¿›å…¥é¤å…æ—¶ï¼Œå¦‚æœé‚£ä¸ªäººä¸æ»¡æ„ï¼Œé‚£ä¹ˆè¿™ç¾¤äººä¼šç«‹åˆ»å«æ¥ä¸€ä½æœåŠ¡å‘˜ã€‚

åªè¦é¤å…é‡Œè‡³å°‘æœ‰ä¸€ä¸ªä¸æ»¡æ„çš„äººï¼Œè¿™äº›ä¸æ»¡æ„çš„äººä¸­å°±ä¼šæœ‰ä¸€ä¸ªäººè´­ä¹°ä¸€ä»½æœ€ä½ä»·æ ¼çš„é£Ÿç‰©ï¼Œä½¿è‡ªå·±å˜å¾—æ»¡æ„ã€‚è¿™ä¸ªè¿‡ç¨‹ä¼šä¸€ç›´æŒç»­ï¼Œç›´åˆ°é¤å…é‡Œæ²¡æœ‰äººä¸æ»¡æ„ä¸ºæ­¢ï¼Œç„¶åæœåŠ¡å‘˜æ‰ä¼šç¦»å¼€ã€‚å¹¸è¿çš„æ˜¯ï¼Œé¤å…å‡ºå”®æ¯ä¸€ä¸ªæ•´æ•°ä»·æ ¼çš„é£Ÿç‰©ã€‚å…·ä½“ä¾‹å­è§ç¬¬ä¸€ä¸ªæ ·ä¾‹çš„è§£é‡Šã€‚

ä½ çš„æœ‹å‹ä»¬å¯ä»¥ä»¥ä»»æ„é¡ºåºè¿›å…¥é¤å…ã€‚åœ¨å«æ¥æœåŠ¡å‘˜ä¹‹åï¼Œå¦‚æœé¤å…é‡Œæœ‰å¤šä¸ªäººä¸æ»¡æ„ï¼Œå¯ä»¥ç”±å…¶ä¸­ä»»æ„ä¸€ä¸ªäººå…ˆè´­ä¹°é£Ÿç‰©ã€‚æ‰€æœ‰è¿™äº›é€‰æ‹©çš„æ–¹å¼å¯èƒ½ä¼šå½±å“è¿™ç¾¤äººå«æœåŠ¡å‘˜çš„æ¬¡æ•°ã€‚

ä½œä¸ºé¤å…è€æ¿ï¼Œä½ é›‡ä½£äº†ä¸€äº›éå¸¸ç–²æƒ«çš„æœåŠ¡å‘˜ã€‚ä½ æƒ³è¦è®¡ç®—ä½ æœ‹å‹ä»¬çš„â€œåˆ†å¸ƒå€¼â€ï¼šä»–ä»¬å¯èƒ½å«æœåŠ¡å‘˜çš„æœ€å¤§æ¬¡æ•°ä¸æœ€å°æ¬¡æ•°ä¹‹å·®ã€‚

## è¯´æ˜/æç¤º

**æ ·ä¾‹è§£é‡Š**

åœ¨ç¬¬ 2 ä¸ªæ ·ä¾‹ä¸­ï¼Œå‡è®¾ä½ çš„æœ‹å‹ä»¬æŒ‰é¡ºåº $[1, 2, 3]$ è¿›å…¥ã€‚ç¬¬ 1 å·æœ‹å‹è¿›å…¥ï¼Œä¸æ»¡æ„ï¼Œå«æ¥æœåŠ¡å‘˜ï¼Œä¹°äº†ä¸€ä»½ä»·æ ¼ä¸º $1$ çš„é£Ÿç‰©ã€‚ç°åœ¨æ²¡äººä¸æ»¡æ„ã€‚æ¥ç€ç¬¬ 2 å·æœ‹å‹è¿›å…¥ï¼Œä¸æ»¡æ„ï¼Œå«æ¥æœåŠ¡å‘˜ï¼Œä¹°äº†ä¸€ä»½ä»·æ ¼ä¸º $1$ çš„é£Ÿç‰©ï¼ˆæ€»ä»·ä¸º $2$ï¼‰ã€‚ç°åœ¨æ²¡äººä¸æ»¡æ„ã€‚ç¬¬ 3 å·æœ‹å‹è¿›å…¥ï¼Œä¸æ»¡æ„ï¼Œå«æ¥æœåŠ¡å‘˜ï¼Œä¹°äº†ä¸€ä»½ä»·æ ¼ä¸º $1$ çš„é£Ÿç‰©ï¼ˆæ€»ä»·ä¸º $3$ï¼‰ã€‚ç°åœ¨ç¬¬ 2 å·æœ‹å‹ä¸æ»¡æ„ï¼Œä¹°äº†ä¸€ä»½ä»·æ ¼ä¸º $1$ çš„é£Ÿç‰©ï¼ˆæ€»ä»·ä¸º $4$ï¼‰ã€‚ç°åœ¨ç¬¬ 3 å·æœ‹å‹ä¸æ»¡æ„ï¼Œä¹°äº†ä¸€ä»½ä»·æ ¼ä¸º $2$ çš„é£Ÿç‰©ï¼ˆæ€»ä»·ä¸º $6$ï¼‰ã€‚æœ€ç»ˆæ²¡äººä¸æ»¡æ„ï¼Œæ€»å…±å«äº†ä¸‰æ¬¡æœåŠ¡å‘˜ã€‚

å¦‚æœæœ‹å‹ä»¬çš„è¿›å…¥é¡ºåºæ˜¯ $[3, 1, 2]$ã€‚ç¬¬ 3 å·æœ‹å‹è¿›å…¥ï¼Œä¸æ»¡æ„ï¼Œå«æ¥æœåŠ¡å‘˜ï¼Œä¹°äº†ä¸€ä»½ä»·æ ¼ä¸º $3$ çš„é£Ÿç‰©ã€‚ç°åœ¨æ²¡äººä¸æ»¡æ„ã€‚æ¥ç€ç¬¬ 1 å·æœ‹å‹è¿›å…¥ï¼Œæ²¡æœ‰äººä¸æ»¡æ„ã€‚ç¬¬ 2 å·æœ‹å‹è¿›å…¥ï¼Œä¸æ»¡æ„ï¼Œå«æ¥æœåŠ¡å‘˜ï¼Œä¹°äº†ä¸€ä»½ä»·æ ¼ä¸º $1$ çš„é£Ÿç‰©ï¼ˆæ€»ä»·ä¸º $4$ï¼‰ã€‚ç°åœ¨ç¬¬ 3 å·æœ‹å‹ä¸æ»¡æ„ï¼Œä¹°äº†ä¸€ä»½ä»·æ ¼ä¸º $2$ çš„é£Ÿç‰©ï¼ˆæ€»ä»·ä¸º $6$ï¼‰ã€‚ç°åœ¨æ²¡äººä¸æ»¡æ„ï¼Œæ€»å…±å«äº†ä¸¤æ¬¡æœåŠ¡å‘˜ã€‚åˆ†å¸ƒå€¼ä¸º $1$ã€‚

**æ•°æ®èŒƒå›´**

**å°æ•°æ®é›†ï¼ˆ13 åˆ†ï¼Œæµ‹è¯•ç‚¹ 1 - å¯è§ï¼‰**

- $1 \leq T \leq 100$ã€‚
- $1 \leq N \leq 1000$ã€‚
- æ—¶é—´é™åˆ¶ï¼š3 ç§’ã€‚

**å¤§æ•°æ®é›†ï¼ˆ17 åˆ†ï¼Œæµ‹è¯•ç‚¹ 2 - éšè—ï¼‰**

- $1 \leq T \leq 1000$ã€‚
- $1 \leq N \leq 10^{12}$ã€‚
- æ—¶é—´é™åˆ¶ï¼š6 ç§’ã€‚

ç”± ChatGPT 4.1 ç¿»è¯‘

## æ ·ä¾‹ #1

### è¾“å…¥

```
4
1
3
6
16```

### è¾“å‡º

```
Case #1: 0
Case #2: 1
Case #3: 2
Case #4: 5```

# AIåˆ†æç»“æœ


### ğŸ’¡ Kayçš„C++ç®—æ³•è§£æï¼šExpensive Dinner æ·±å…¥å­¦ä¹ æŒ‡å— ğŸ’¡

**å¼•è¨€**  
ä»Šå¤©æˆ‘ä»¬å°†åˆ†æGoogle Code Jam 2011çš„ç»å…¸é¢˜ç›®ã€ŠExpensive Dinnerã€‹ã€‚è¿™é“é¢˜ç»“åˆäº†æ•°è®ºå’Œç®—æ³•ä¼˜åŒ–æ€ç»´ï¼Œé€šè¿‡æ¨¡æ‹Ÿæœ‹å‹åœ¨é¤å…çš„æ¶ˆè´¹è¡Œä¸ºï¼Œè€ƒå¯Ÿè´¨å› æ•°åˆ†è§£ã€æ•°å­¦æ¨å¯¼å’Œé«˜æ•ˆè®¡ç®—æŠ€å·§ã€‚æœ¬æŒ‡å—å°†å¸®åŠ©ä½ æŒæ¡æ ¸å¿ƒè§£é¢˜æ€è·¯ã€‚

---

#### âœ¨ 1. é¢˜ç›®è§£è¯»ä¸æ ¸å¿ƒç®—æ³•è¯†åˆ«  
**æœ¬é¢˜ä¸»è¦è€ƒå¯Ÿ**ï¼š`è´¨å› æ•°åˆ†è§£ä¸æ•°å­¦ä¼˜åŒ–`  
**åˆæ­¥åˆ†æ**ï¼š  
> æœ¬é¢˜æœ¬è´¨æ˜¯è®¡ç®—è´¨å› æ•°å¹‚æ¬¡ä¸è´¨æ•°æ•°é‡ä¹‹é—´çš„æ•°å­¦å…³ç³»ã€‚æƒ³è±¡æ¯ä¸ªæœ‹å‹æ˜¯ä¸åŒè´¨å› å­çš„â€œæ£€æŸ¥å®˜â€ï¼Œè€Œé¤è´¹éœ€æ»¡è¶³æ‰€æœ‰åœ¨åœºæœ‹å‹çš„è´¨å› å­æ¡ä»¶ã€‚å…³é”®å‘ç°æ˜¯ï¼šæœ€å¤§æœåŠ¡å‘˜å‘¼å«æ¬¡æ•°ç”±æ‰€æœ‰è´¨å› å­çš„å¹‚æ¬¡ä¸ªæ•°å†³å®šï¼Œæœ€å°æ¬¡æ•°ç”±ä¸åŒè´¨å› å­çš„æ•°é‡å†³å®šï¼Œæœ€ç»ˆç­”æ¡ˆå³äºŒè€…å·®å€¼åŠ 1ã€‚  

- **æ ¸å¿ƒéš¾ç‚¹**ï¼š  
  1. æ¨å¯¼å‡º`åˆ†å¸ƒå€¼ = 1 + âˆ‘(kâ‰¥2) Ï€(n^{1/k})`çš„æ•°å­¦å…³ç³»  
  2. é«˜æ•ˆè®¡ç®—å¤§èŒƒå›´è´¨æ•°ä¸ªæ•°ï¼ˆn â‰¤ 10Â¹Â²ï¼‰  
- **å¯è§†åŒ–è®¾è®¡**ï¼š  
  é‡‡ç”¨åƒç´ é£æ ¼å±•ç¤ºè´¨å› å­å¹‚æ¬¡å¢é•¿è¿‡ç¨‹ã€‚ä¾‹å¦‚ï¼šè´¨æ•°2çš„å¹‚æ¬¡å—ï¼ˆ2/4/8/16ï¼‰éškå€¼å¢åŠ åŠ¨æ€ç‚¹äº®ï¼Œé…åˆâ€œå‡çº§éŸ³æ•ˆâ€å¼ºåŒ–è´¨å› å­æ¦‚å¿µã€‚

---

#### ğŸ” 2. ç²¾é€‰ä¼˜è´¨é¢˜è§£å‚è€ƒ  
ç”±äºé¢˜ç›®æš‚æ— é¢˜è§£ï¼ŒKayç»™å‡ºé€šç”¨è§£é¢˜æ¡†æ¶ï¼š  
> æœ¬é¢˜éœ€å°†æ•°å­¦æ¨å¯¼è½¬åŒ–ä¸ºé«˜æ•ˆä»£ç ã€‚æ ¸å¿ƒæ˜¯é€šè¿‡ç­›æ³•é¢„å¤„ç†è´¨æ•°è¡¨ï¼Œå†ç”¨äºŒåˆ†æ³•å¿«é€Ÿè®¡ç®—è´¨æ•°è®¡æ•°å‡½æ•°Ï€(x)ã€‚é‡ç‚¹æ³¨æ„ï¼š  
> - æµ®ç‚¹æ•°ç²¾åº¦å¤„ç†ï¼šä½¿ç”¨æ•´æ•°äºŒåˆ†é¿å…å¼€æ–¹è¯¯å·®  
> - æ—¶é—´å¤æ‚åº¦ä¼˜åŒ–ï¼šk>2æ—¶xæ€¥å‰§ç¼©å°ï¼Œå‡å°‘æ— æ•ˆè®¡ç®—  

---

#### ğŸ§© 3. æ ¸å¿ƒéš¾ç‚¹è¾¨æä¸è§£é¢˜ç­–ç•¥  
1. **éš¾ç‚¹1ï¼šè´¨å› å­å¹‚æ¬¡çš„æ•°å­¦å»ºæ¨¡**  
   **åˆ†æ**ï¼šå‘ç°åˆ†å¸ƒå€¼=1+âˆ‘Ï€(n^{1/k})éœ€æ·±å…¥ç†è§£è´¨å› æ•°åˆ†è§£ã€‚è´¨æ•°pçš„kæ¬¡å¹‚è´¡çŒ®ç‹¬ç«‹è®¡æ•°ï¼Œä¸”kâ‰¥2æ—¶n^{1/k}å¿«é€Ÿæ”¶æ•›ã€‚  
   ğŸ’¡ **å­¦ä¹ ç¬”è®°**ï¼šè´¨å› å­å¹‚æ¬¡æ˜¯ç®—æ³•æ•ˆç‡çš„å…³é”®çªç ´å£ã€‚

2. **éš¾ç‚¹2ï¼šå¤§èŒƒå›´è´¨æ•°è®¡æ•°ä¼˜åŒ–**  
   **åˆ†æ**ï¼šÏ€(x)è®¡ç®—éœ€é¢„å¤„ç†1e6å†…è´¨æ•°è¡¨ã€‚å½“x>1e6æ—¶ï¼Œåˆ©ç”¨äºŒåˆ†æ³•åœ¨è´¨æ•°è¡¨ä¸­å¿«é€Ÿå®šä½ã€‚  
   ğŸ’¡ **å­¦ä¹ ç¬”è®°**ï¼šåˆ†æ®µå¤„ç†æ˜¯çªç ´å¤§æ•°æ®çš„æ ¸å¿ƒæŠ€å·§ã€‚

3. **éš¾ç‚¹3ï¼šè¾¹ç•Œæ¡ä»¶ä¸æ•´æ•°æº¢å‡º**  
   **åˆ†æ**ï¼šcheckå‡½æ•°éœ€ç”¨`res > n / x`ä»£æ›¿ä¹˜æ³•ï¼Œé¿å…long longæº¢å‡ºã€‚  
   ğŸ’¡ **å­¦ä¹ ç¬”è®°**ï¼šå®‰å…¨è®¡ç®—æ¯”ç®—æ³•æœ¬èº«æ›´æ˜“å‡ºé”™ã€‚

**âœ¨ è§£é¢˜æŠ€å·§æ€»ç»“**  
- **è´¨å› å­è§†è§’è½¬æ¢**ï¼šå°†æœ‹å‹ç¼–å·è½¬åŒ–ä¸ºè´¨å› æ•°åˆ†è§£é—®é¢˜  
- **æ•°å­¦å½’çº³æ³•**ï¼šä»n=1,2,3çš„æ ·ä¾‹æ¨å¯¼é€šé¡¹å…¬å¼  
- **åˆ†æ®µå¤„ç†**ï¼šå¯¹k=2å•ç‹¬äºŒåˆ†ï¼Œkâ‰¥3ç›´æ¥æšä¸¾  
- **è¾¹ç•Œé˜²å¾¡**ï¼šå¯¹x=1å’Œn=1ç‰¹åˆ¤å¤„ç†  

---

#### ğŸ’» 4. C++æ ¸å¿ƒä»£ç å®ç°èµæ  
**é€šç”¨æ ¸å¿ƒå®ç°å‚è€ƒ**  
```cpp
#include <iostream>
#include <vector>
#include <cmath>
using namespace std;

const int MAX_X = 1000000;
vector<int> primes;
vector<int> pre; // pre[x] = Ï€(x)

void sieve() {
    vector<bool> is_prime(MAX_X+1, true);
    is_prime[0] = is_prime[1] = false;
    for (int i = 2; i <= MAX_X; i++) {
        if (is_prime[i]) primes.push_back(i);
        for (int p : primes) {
            if (i * p > MAX_X) break;
            is_prime[i * p] = false;
            if (i % p == 0) break;
        }
    }
    pre.resize(MAX_X+1);
    for (int i = 1; i <= MAX_X; i++) 
        pre[i] = pre[i-1] + is_prime[i];
}

bool check(long long x, int k, long long n) {
    if (x <= 1) return true;
    long long res = 1;
    for (int i = 0; i < k; i++) {
        if (res > n / x) return false; // é˜²æº¢å‡º
        res *= x;
        if (res > n) return false;
    }
    return true;
}

int main() {
    sieve();
    int T;
    cin >> T;
    for (int cas = 1; cas <= T; cas++) {
        long long n, ans = 0;
        cin >> n;
        if (n > 1) {
            ans = 1; // å…¬å¼ä¸­çš„å¸¸æ•°é¡¹
            for (int k = 2; ; k++) {
                long long L = 1, R = min(n, (long long)MAX_X);
                long long x = 0;
                while (L <= R) {
                    long long mid = (L + R) / 2;
                    check(mid, k, n) ? (x = mid, L = mid+1) : (R = mid-1);
                }
                if (x < 2) break;
                ans += pre[x];
            }
        }
        cout << "Case #" << cas << ": " << ans << endl;
    }
    return 0;
}
```

**ä»£ç è§£è¯»æ¦‚è¦**ï¼š  
1. **ç­›æ³•é¢„å¤„ç†**ï¼šå»ºç«‹1e6å†…è´¨æ•°è¡¨åŠå‰ç¼€å’Œæ•°ç»„  
2. **å®‰å…¨ä¹˜æ–¹æ£€æŸ¥**ï¼šç”¨é™¤æ³•åˆ¤æ–­é¿å…æº¢å‡º  
3. **åˆ†å±‚äºŒåˆ†æœç´¢**ï¼šå¯¹æ¯ä¸ªkå€¼è®¡ç®—æœ€å¤§æ»¡è¶³x  
4. **åŠ¨æ€ç´¯åŠ ç»“æœ**ï¼šæ ¹æ®å…¬å¼âˆ‘Ï€(n^{1/k})æ±‚åˆ†å¸ƒå€¼  

---

#### ğŸ® 5. ç®—æ³•å¯è§†åŒ–ï¼šåƒç´ åŠ¨ç”»æ¼”ç¤º  
**ä¸»é¢˜**ï¼šè´¨å› å­ç‹å›½é—¯å…³  
**æ ¸å¿ƒæ¼”ç¤º**ï¼š  
![](https://via.placeholder.com/400x200/36393f/ffffff?text=åŠ¨æ€æ¼”ç¤ºå›¾)  
1. **åƒç´ åœºæ™¯**ï¼š  
   - 8-bité£æ ¼ç½‘æ ¼ï¼šxè½´ä¸ºè´¨æ•°ç¼–å·ï¼Œyè½´ä¸ºå¹‚æ¬¡k  
   - ä¸åŒé¢œè‰²æ–¹å—ï¼šè´¨æ•°ï¼ˆè“ï¼‰ã€åˆæ•°ï¼ˆç°ï¼‰ã€å½“å‰è®¡ç®—å—ï¼ˆé‡‘ï¼‰  
2. **åŠ¨ç”»æµç¨‹**ï¼š  
   - **æ­¥è¿›1**ï¼šk=2æ—¶ï¼Œsqrt(n)æ–¹å—ç‚¹äº®å¹¶æ˜¾ç¤ºÏ€(x)å€¼ï¼ˆé…â€œç‚¹å‡»éŸ³æ•ˆâ€ï¼‰  
   - **æ­¥è¿›2**ï¼škå¢åŠ æ—¶ï¼Œé«˜å±‚æ–¹å—æ¸æ¬¡ç‚¹äº®ï¼ˆé…â€œå‡çº§éŸ³æ•ˆâ€ï¼‰  
   - **å®Œæˆæ•ˆæœ**ï¼šæ‰€æœ‰æ»¡è¶³n^{1/k}â‰¥2çš„å—ç»„æˆé‡‘å­—å¡”ï¼Œé¡¶éƒ¨æ˜¾ç¤ºæœ€ç»ˆç»“æœ  
3. **äº¤äº’è®¾è®¡**ï¼š  
   - è°ƒé€Ÿæ»‘å—ï¼šæ§åˆ¶kå¢åŠ é€Ÿåº¦  
   - æš‚åœ/ç»§ç»­ï¼šè§‚å¯Ÿå„å±‚è´¨æ•°æ•°é‡  
   - é‡ç½®ï¼šé‡æ–°åˆå§‹åŒ–å‚æ•°  

---

#### ğŸ“š 6. æ‹“å±•ç»ƒä¹ ä¸ç›¸ä¼¼é—®é¢˜æ€è€ƒ  
**é€šç”¨æŠ€å·§è¿ç§»**ï¼š  
- è´¨å› æ•°åˆ†è§£æ€æƒ³å¯è§£å†³ï¼šè´¨æ•°è®¡æ•°ã€å› å­æ±‚å’Œã€å…¬çº¦æ•°é—®é¢˜  
**æ´›è°·æ¨è**ï¼š  
1. **P3912 è´¨æ•°è®¡æ•°**  
   ğŸ—£ï¸ å·©å›ºÏ€(x)è®¡ç®—æŠ€å·§ï¼Œéœ€æ”¹ç”¨Meissel-Lehmerç®—æ³•  
2. **P1593 å› å­å’Œ**  
   ğŸ—£ï¸ ç»ƒä¹ è´¨å› å­å¹‚æ¬¡æ±‚å’Œçš„åº”ç”¨  
3. **P1072 Hanksonçš„è¶£å‘³é¢˜**  
   ğŸ—£ï¸ å¼ºåŒ–å› å­åˆ†æä¸è¾¹ç•Œå¤„ç†èƒ½åŠ›  

---

**ç»“è¯­**  
é€šè¿‡è´¨å› å­åˆ†è§£è§†è§’ï¼Œæˆ‘ä»¬æ­å¼€äº†çœ‹ä¼¼å¤æ‚çš„æ¶ˆè´¹è¡Œä¸ºèƒŒåçš„æ•°å­¦æœ¬è´¨ã€‚è®°ä½ï¼šå°†é—®é¢˜è½¬åŒ–ä¸ºæ•°å­¦æ¨¡å‹æ˜¯ç®—æ³•ç«èµ›çš„æ ¸å¿ƒèƒ½åŠ›ã€‚ç»§ç»­æŒ‘æˆ˜æ›´é«˜ç»´åº¦çš„æ•°è®ºé—®é¢˜å§ï¼ğŸš€

---
å¤„ç†ç”¨æ—¶ï¼š520.99ç§’
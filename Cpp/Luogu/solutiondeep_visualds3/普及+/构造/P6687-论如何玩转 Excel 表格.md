# é¢˜ç›®ä¿¡æ¯

# è®ºå¦‚ä½•ç©è½¬ Excel è¡¨æ ¼

## é¢˜ç›®æè¿°

æœ‰ä¸€ä¸ª $2 \times n$ çš„è¡¨æ ¼ï¼Œè¡¨æ ¼å†…ä¸é‡ä¸æ¼åœ°å¡«æœ‰ $1 \sim 2 \times n$ è¿™äº›æ•°å­—ã€‚ä½ å¯ä»¥è¿›è¡Œè‹¥å¹²æ¬¡æ“ä½œï¼Œæ¯æ¬¡æ“ä½œå¯ä»¥é€‰æ‹©ä¸€ä¸ª $2 \times 2$ çš„æ­£æ–¹å½¢åŒºåŸŸï¼Œç„¶åæ—‹è½¬ $180\degree$ã€‚

ç»™å‡ºç°åœ¨çš„çŠ¶æ€ä»¥åŠç›®æ ‡çŠ¶æ€ã€‚é—®æ˜¯å¦å¯ä»¥è¾¾åˆ°ç›®æ ‡çŠ¶æ€ã€‚å¦‚æœèƒ½ï¼Œæœ€å°‘æ“ä½œæ¬¡æ•°æ˜¯å¤šå°‘ã€‚

## è¯´æ˜/æç¤º

#### å­ä»»åŠ¡

æœ¬é¢˜é‡‡ç”¨æ†ç»‘æµ‹è¯•ã€‚

å¯¹äº $100\%$ çš„æ•°æ®ï¼š$1 \leq n \leq 10^6$ã€‚

æœ¬é¢˜å…± $10$ ä¸ªå­ä»»åŠ¡ï¼Œå„å­ä»»åŠ¡çš„åˆ†å€¼å’Œé™åˆ¶å¦‚ä¸‹ï¼š

å­ä»»åŠ¡ $1$ï¼ˆ$1$ åˆ†ï¼‰ï¼šä¿è¯è¾“å‡ºä¸€å®šä¸º `dldsgay!!1`ã€‚  
å­ä»»åŠ¡ $2$ï¼ˆ$1$ åˆ†ï¼‰ï¼šä¿è¯ç›®æ ‡çŠ¶æ€ä¸ç°åœ¨çŠ¶æ€ä¸€è‡´ã€‚  
å­ä»»åŠ¡ $3$ï¼ˆ$4$ åˆ†ï¼‰ï¼š$n=1$ã€‚  
å­ä»»åŠ¡ $4$ï¼ˆ$5$ åˆ†ï¼‰ï¼š$n=2$ã€‚  
å­ä»»åŠ¡ $5$ï¼ˆ$14$ åˆ†ï¼‰ï¼š$1 \leq n \leq 20$ã€‚  
å­ä»»åŠ¡ $6$ï¼ˆ$19$ åˆ†ï¼‰ï¼š$1 \leq n \leq 100$ã€‚  
å­ä»»åŠ¡ $7$ï¼ˆ$19$ åˆ†ï¼‰ï¼š$1 \leq n \leq 1000$ã€‚  
å­ä»»åŠ¡ $8$ï¼ˆ$8$ åˆ†ï¼‰ï¼šä¿è¯ç›®æ ‡çŠ¶æ€ç¬¬ä¸€è¡Œä¾æ¬¡ä¸º $1 \sim n$ï¼Œç¬¬äºŒè¡Œä¾æ¬¡ä¸º  $n + 1 \sim 2n$ã€‚  
å­ä»»åŠ¡ $9$ï¼ˆ$10$ åˆ†ï¼‰ï¼šä¿è¯ä¸å­˜åœ¨æ— è§£æƒ…å†µã€‚  
å­ä»»åŠ¡ $10$ï¼ˆ$19$ åˆ†ï¼‰ï¼šæ— ç‰¹æ®Šé™åˆ¶ã€‚

## æ ·ä¾‹ #1

### è¾“å…¥

```
1
1
2
2
1
```

### è¾“å‡º

```
dldsgay!!1
```

## æ ·ä¾‹ #2

### è¾“å…¥

```
2
1 2
3 4
4 3
2 1
```

### è¾“å‡º

```
1
```

## æ ·ä¾‹ #3

### è¾“å…¥

```
2
1 2
3 4
1 2
4 3
```

### è¾“å‡º

```
dldsgay!!1
```

## æ ·ä¾‹ #4

### è¾“å…¥

```
3
1 6 2
4 3 5
2 4 3
5 1 6
```

### è¾“å‡º

```
2
```

# AIåˆ†æç»“æœ

# ğŸ’¡ Kayçš„C++ç®—æ³•è§£æï¼šè®ºå¦‚ä½•ç©è½¬Excelè¡¨æ ¼ æ·±å…¥å­¦ä¹ æŒ‡å— ğŸ’¡


## 1. é¢˜ç›®è§£è¯»ä¸æ ¸å¿ƒç®—æ³•è¯†åˆ«

âœ¨ **æœ¬é¢˜ä¸»è¦è€ƒå¯Ÿ**ï¼šé€†åºå¯¹ï¼ˆå½’å¹¶æ’åº/æ ‘çŠ¶æ•°ç»„ï¼‰+ é—®é¢˜å»ºæ¨¡


ğŸ—£ï¸ **åˆæ­¥åˆ†æ**ï¼š  
è§£å†³â€œè®ºå¦‚ä½•ç©è½¬Excelè¡¨æ ¼â€çš„å…³é”®ï¼Œåœ¨äº**å°†è¡¨æ ¼æ“ä½œè½¬åŒ–ä¸ºåºåˆ—é—®é¢˜**ã€‚æƒ³è±¡ä¸€ä¸‹ï¼Œè¡¨æ ¼ä¸­çš„æ¯ä¸€åˆ—å°±åƒä¸€å—â€œç§¯æœ¨â€ï¼Œé‡Œé¢æœ‰ä¸¤ä¸ªä¸Šä¸‹å æ”¾çš„æ•°å­—ã€‚æ¯æ¬¡æ—‹è½¬2Ã—2åŒºåŸŸï¼Œç›¸å½“äº**äº¤æ¢ç›¸é‚»ä¸¤å—ç§¯æœ¨çš„ä½ç½®**ï¼ŒåŒæ—¶ç¿»è½¬ç§¯æœ¨å†…éƒ¨çš„æ•°å­—é¡ºåºï¼ˆä¸Šä¸‹é¢ å€’ï¼‰ã€‚  

é‚£ä¹ˆé—®é¢˜å°±å˜æˆäº†ï¼šå¦‚ä½•ç”¨æœ€å°‘çš„â€œäº¤æ¢ç›¸é‚»ç§¯æœ¨â€æ“ä½œï¼Œå°†åˆå§‹çš„ç§¯æœ¨åºåˆ—å˜æˆç›®æ ‡åºåˆ—ï¼Ÿè€Œæœ€å°‘äº¤æ¢æ¬¡æ•°ï¼Œæ­£å¥½ç­‰äº**ç›®æ ‡åºåˆ—ç›¸å¯¹äºåˆå§‹åºåˆ—çš„é€†åºå¯¹ä¸ªæ•°**ï¼ˆæ¯”å¦‚ï¼Œç§¯æœ¨Aåº”è¯¥åœ¨ç§¯æœ¨Bå‰é¢ï¼Œä½†ç°åœ¨Aåœ¨Båé¢ï¼Œè¿™å°±æ˜¯ä¸€ä¸ªé€†åºå¯¹ï¼Œéœ€è¦äº¤æ¢ä¸€æ¬¡ï¼‰ã€‚  

**æ ¸å¿ƒç®—æ³•æµç¨‹**ï¼š  
1. **åˆ¤æ— è§£**ï¼šæ£€æŸ¥ç›®æ ‡çŠ¶æ€ä¸­ï¼ŒåŒä¸€åˆ—çš„æ•°å­—æ˜¯å¦æ¥è‡ªåˆå§‹çŠ¶æ€çš„åŒä¸€åˆ—ï¼ˆç§¯æœ¨æ²¡æ•£ï¼‰ï¼Œä¸”ä½ç½®çš„å¥‡å¶æ€§æ˜¯å¦ç¬¦åˆç¿»è½¬æ¬¡æ•°ï¼ˆæ¯”å¦‚ï¼Œç§¯æœ¨ç§»åŠ¨äº†å¥‡æ•°æ­¥ï¼Œå†…éƒ¨å¿…é¡»é¢ å€’ï¼›å¶æ•°æ­¥åˆ™ä¸å˜ï¼‰ã€‚  
2. **å»ºæ¨¡**ï¼šå°†æ¯åˆ—ç§¯æœ¨ç¼–å·ï¼Œç”Ÿæˆåˆå§‹åºåˆ—å’Œç›®æ ‡åºåˆ—ã€‚  
3. **æ±‚é€†åºå¯¹**ï¼šç”¨å½’å¹¶æ’åºæˆ–æ ‘çŠ¶æ•°ç»„è®¡ç®—é€†åºå¯¹ä¸ªæ•°ï¼Œå³ä¸ºæœ€å°‘æ“ä½œæ¬¡æ•°ã€‚  

**å¯è§†åŒ–è®¾è®¡æ€è·¯**ï¼š  
ç”¨8ä½åƒç´ é£æ ¼å±•ç¤ºè¡¨æ ¼ï¼Œæ¯åˆ—ç§¯æœ¨ç”¨ä¸åŒé¢œè‰²æ ‡è®°ã€‚äº¤æ¢ç›¸é‚»ç§¯æœ¨æ—¶ï¼Œç”¨â€œæ»‘åŠ¨â€åŠ¨ç”»å±•ç¤ºï¼ŒåŒæ—¶ç¿»è½¬ç§¯æœ¨å†…éƒ¨æ•°å­—ï¼ˆä¸Šä¸‹äº¤æ¢ï¼‰ã€‚é€†åºå¯¹ç»Ÿè®¡æ—¶ï¼Œç”¨â€œçº¢è‰²ç®­å¤´â€æ ‡è®°é€†åºçš„ç§¯æœ¨å¯¹ï¼Œä¼´éšâ€œå®â€çš„éŸ³æ•ˆæç¤ºã€‚


## 2. ç²¾é€‰ä¼˜è´¨é¢˜è§£å‚è€ƒ

### é¢˜è§£ä¸€ï¼šRedreamMerï¼ˆå½’å¹¶æ’åºæ±‚é€†åºå¯¹ï¼‰  
* **ç‚¹è¯„**ï¼š  
  è¿™ä»½é¢˜è§£çš„æ€è·¯éå¸¸æ¸…æ™°ï¼Œå…ˆé€šè¿‡â€œæ¡¶â€è®°å½•åˆå§‹åˆ—çš„æ•°å­—å¯¹åº”å…³ç³»ï¼Œå†é€ä¸€éªŒè¯ç›®æ ‡åˆ—çš„åˆæ³•æ€§ï¼ˆç§¯æœ¨æ²¡æ•£ã€å¥‡å¶æ€§æ­£ç¡®ï¼‰ã€‚æ ¸å¿ƒçš„å½’å¹¶æ’åºä»£ç ç®€æ´é«˜æ•ˆï¼Œå®Œç¾è§£å†³äº†é€†åºå¯¹é—®é¢˜ã€‚ä»£ç ä¸­çš„`st`æ•°ç»„ï¼ˆè®°å½•åˆå§‹åˆ—çš„ä½ç½®ï¼‰å’Œ`msort`å‡½æ•°ï¼ˆå½’å¹¶æ’åºï¼‰å‘½åæ˜ç¡®ï¼Œé€»è¾‘ç›´ç™½ï¼Œç‰¹åˆ«é€‚åˆåˆå­¦è€…ç†è§£â€œå¦‚ä½•å°†è¡¨æ ¼é—®é¢˜è½¬åŒ–ä¸ºåºåˆ—é—®é¢˜â€ã€‚  

### é¢˜è§£äºŒï¼šyangwenbinï¼ˆæ ‘çŠ¶æ•°ç»„æ±‚é€†åºå¯¹ï¼‰  
* **ç‚¹è¯„**ï¼š  
  é¢˜è§£ç”¨æ ‘çŠ¶æ•°ç»„æ›¿ä»£å½’å¹¶æ’åºï¼Œå¤„ç†é€†åºå¯¹çš„æ•ˆç‡æ›´é«˜ï¼ˆæ—¶é—´å¤æ‚åº¦åŒä¸ºO(nlogn)ï¼Œä½†æ ‘çŠ¶æ•°ç»„å¸¸æ•°æ›´å°ï¼‰ã€‚ä»£ç ä¸­çš„`merge`å‡½æ•°è™½ç„¶åä¸ºâ€œå½’å¹¶â€ï¼Œä½†å®é™…æ˜¯æ ‘çŠ¶æ•°ç»„çš„å®ç°ï¼Œè¿™ç‚¹éœ€è¦æ³¨æ„ã€‚å¦å¤–ï¼Œé¢˜è§£ä¸­çš„â€œå¿«è¯»â€å‡½æ•°æ˜¯å¤„ç†å¤§æ•°æ®çš„å…³é”®ï¼Œé¿å…äº†è¾“å…¥è¶…æ—¶ï¼Œå€¼å¾—å­¦ä¹ ã€‚  

### é¢˜è§£ä¸‰ï¼šProvicyï¼ˆé»‘ç™½æŸ“è‰²æ³•åˆ¤æ— è§£ï¼‰  
* **ç‚¹è¯„**ï¼š  
  é¢˜è§£ç”¨â€œé»‘ç™½æŸ“è‰²â€çš„æ¯”å–»ï¼ˆå°†è¡¨æ ¼åˆ†ä¸ºé»‘æ ¼å’Œç™½æ ¼ï¼‰ï¼Œæ¸…æ™°è§£é‡Šäº†æ•°å­—çš„ç§»åŠ¨é™åˆ¶ï¼ˆé»‘æ ¼æ•°å­—åªèƒ½åˆ°é»‘æ ¼ï¼Œç™½æ ¼åªèƒ½åˆ°ç™½æ ¼ï¼‰ã€‚è¿™ç§å¯è§†åŒ–çš„åˆ¤æ–­æ–¹æ³•éå¸¸ç›´è§‚ï¼Œå¸®åŠ©å­¦ä¹ è€…å¿«é€Ÿç†è§£â€œä¸ºä»€ä¹ˆæœ‰äº›æƒ…å†µæ— è§£â€ã€‚ä»£ç ä¸­çš„`book`æ•°ç»„ï¼ˆè®°å½•åˆå§‹åˆ—çš„æ•°å­—å¯¹åº”å…³ç³»ï¼‰å’Œ`Ask`å‡½æ•°ï¼ˆæ ‘çŠ¶æ•°ç»„æŸ¥è¯¢ï¼‰é€»è¾‘ä¸¥è°¨ï¼Œæ˜¯å¾ˆå¥½çš„å‚è€ƒã€‚  


## 3. æ ¸å¿ƒéš¾ç‚¹è¾¨æä¸è§£é¢˜ç­–ç•¥

### 1. éš¾ç‚¹1ï¼šå¦‚ä½•åˆ¤æ–­â€œç§¯æœ¨æ²¡æ•£â€ï¼Ÿ  
* **åˆ†æ**ï¼šåˆå§‹çŠ¶æ€ä¸­åŒä¸€åˆ—çš„ä¸¤ä¸ªæ•°å­—ï¼Œåœ¨ç›®æ ‡çŠ¶æ€ä¸­å¿…é¡»ä»åœ¨åŒä¸€åˆ—ã€‚æ¯”å¦‚ï¼Œåˆå§‹åˆ—1æ˜¯[1,3]ï¼Œç›®æ ‡åˆ—ä¸­çš„1å’Œ3å¿…é¡»åœ¨åŒä¸€åˆ—ï¼Œå¦åˆ™æ— æ³•é€šè¿‡æ—‹è½¬å¾—åˆ°ã€‚  
* ğŸ’¡ **å­¦ä¹ ç¬”è®°**ï¼šç”¨æ•°ç»„è®°å½•æ¯ä¸ªæ•°å­—çš„â€œåŒä¼´â€ï¼ˆæ¯”å¦‚`mch[x] = y`è¡¨ç¤ºxå’Œyåœ¨åŒä¸€åˆ—ï¼‰ï¼ŒéªŒè¯ç›®æ ‡çŠ¶æ€ä¸­åŒä¸€åˆ—çš„æ•°å­—æ˜¯å¦ä¸ºåŒä¼´ã€‚  

### 2. éš¾ç‚¹2ï¼šå¦‚ä½•åˆ¤æ–­å¥‡å¶æ€§æ˜¯å¦æ­£ç¡®ï¼Ÿ  
* **åˆ†æ**ï¼šç§¯æœ¨ç§»åŠ¨äº†kæ­¥ï¼ˆäº¤æ¢äº†kæ¬¡ç›¸é‚»ä½ç½®ï¼‰ï¼Œå¦‚æœkæ˜¯å¥‡æ•°ï¼Œç§¯æœ¨å†…éƒ¨å¿…é¡»é¢ å€’ï¼ˆæ¯”å¦‚åˆå§‹åˆ—æ˜¯[1,3]ï¼Œç§»åŠ¨1æ­¥åå˜æˆ[3,1]ï¼‰ï¼›å¦‚æœkæ˜¯å¶æ•°ï¼Œå†…éƒ¨é¡ºåºä¸å˜ã€‚  
* ğŸ’¡ **å­¦ä¹ ç¬”è®°**ï¼šè®¡ç®—ç§¯æœ¨åˆå§‹ä½ç½®ä¸ç›®æ ‡ä½ç½®çš„å·®ï¼ˆk = ç›®æ ‡åˆ— - åˆå§‹åˆ—ï¼‰ï¼Œåˆ¤æ–­kçš„å¥‡å¶æ€§æ˜¯å¦ä¸ç§¯æœ¨å†…éƒ¨é¡ºåºä¸€è‡´ã€‚  

### 3. éš¾ç‚¹3ï¼šå¦‚ä½•å°†é—®é¢˜è½¬åŒ–ä¸ºé€†åºå¯¹ï¼Ÿ  
* **åˆ†æ**ï¼šæœ€å°‘äº¤æ¢ç›¸é‚»å…ƒç´ çš„æ¬¡æ•°ï¼Œç­‰äºåºåˆ—çš„é€†åºå¯¹ä¸ªæ•°ã€‚æ¯”å¦‚ï¼Œåºåˆ—[3,2,1]æœ‰3ä¸ªé€†åºå¯¹ï¼ˆ3>2, 3>1, 2>1ï¼‰ï¼Œéœ€è¦äº¤æ¢3æ¬¡æ‰èƒ½å˜æˆ[1,2,3]ã€‚  
* ğŸ’¡ **å­¦ä¹ ç¬”è®°**ï¼šå°†ç›®æ ‡åˆ—çš„ç¼–å·ä½œä¸ºâ€œæƒå€¼â€ï¼Œç”Ÿæˆåˆå§‹åºåˆ—çš„æƒå€¼åºåˆ—ï¼Œæ±‚é€†åºå¯¹å³å¯ã€‚  


## 4. C++æ ¸å¿ƒä»£ç å®ç°èµæ

### æœ¬é¢˜é€šç”¨æ ¸å¿ƒC++å®ç°å‚è€ƒï¼ˆå½’å¹¶æ’åºç‰ˆï¼‰  
* **è¯´æ˜**ï¼šç»¼åˆRedreamMerå’ŒProvicyçš„é¢˜è§£ï¼Œæç‚¼å‡ºæœ€ç®€æ´çš„æ ¸å¿ƒå®ç°ã€‚  
* **å®Œæ•´æ ¸å¿ƒä»£ç **ï¼š  
  ```cpp
  #include <iostream>
  #include <vector>
  using namespace std;

  const int N = 1e6 + 10;
  long long ans;
  int s[N], l[N];

  void msort(int left, int right) {
      if (left == right) return;
      int mid = (left + right) / 2;
      msort(left, mid);
      msort(mid+1, right);
      int i = left, j = mid+1, k = left;
      while (i <= mid && j <= right) {
          if (s[i] > s[j]) {
              l[k++] = s[j++];
              ans += mid - i + 1;
          } else {
              l[k++] = s[i++];
          }
      }
      while (i <= mid) l[k++] = s[i++];
      while (j <= right) l[k++] = s[j++];
      for (int p = left; p <= right; p++) s[p] = l[p];
  }

  int main() {
      int n;
      cin >> n;
      vector<int> a1(n+1), a2(n+1), b1(n+1), b2(n+1);
      vector<int> pos(2*n+1); // è®°å½•åˆå§‹åˆ—çš„ä½ç½®
      for (int i = 1; i <= n; i++) cin >> a1[i], pos[a1[i]] = i;
      for (int i = 1; i <= n; i++) cin >> a2[i], pos[a2[i]] = i;
      for (int i = 1; i <= n; i++) cin >> b1[i];
      for (int i = 1; i <= n; i++) cin >> b2[i];

      // åˆ¤æ— è§£ï¼šåŒä¸€åˆ—çš„æ•°å­—æ˜¯å¦ä¸ºåŒä¼´
      vector<int> pair(2*n+1);
      for (int i = 1; i <= n; i++) pair[a1[i]] = a2[i], pair[a2[i]] = a1[i];
      for (int i = 1; i <= n; i++) {
          if (pair[b1[i]] != b2[i]) {
              cout << "dldsgay!!1" << endl;
              return 0;
          }
      }

      // ç”Ÿæˆæƒå€¼åºåˆ—s
      vector<int> target_pos(2*n+1);
      for (int i = 1; i <= n; i++) target_pos[b1[i]] = i;
      for (int i = 1; i <= n; i++) s[i] = target_pos[a1[i]];

      // æ±‚é€†åºå¯¹
      msort(1, n);
      cout << ans << endl;

      return 0;
  }
  ```
* **ä»£ç è§£è¯»æ¦‚è¦**ï¼š  
  ä»£ç åˆ†ä¸ºä¸‰éƒ¨åˆ†ï¼š1. è¾“å…¥æ•°æ®å¹¶è®°å½•åˆå§‹åˆ—çš„ä½ç½®ï¼›2. éªŒè¯ç›®æ ‡åˆ—çš„åˆæ³•æ€§ï¼ˆåŒä¼´æ˜¯å¦æ­£ç¡®ï¼‰ï¼›3. ç”Ÿæˆæƒå€¼åºåˆ—ï¼Œç”¨å½’å¹¶æ’åºæ±‚é€†åºå¯¹ã€‚å…¶ä¸­ï¼Œ`msort`å‡½æ•°æ˜¯å½’å¹¶æ’åºçš„æ ¸å¿ƒï¼Œé€šè¿‡åˆ†æ²»çš„æ–¹å¼ç»Ÿè®¡é€†åºå¯¹ä¸ªæ•°ã€‚  


### é¢˜è§£ä¸€ï¼šRedreamMerçš„å½’å¹¶æ’åºç‰‡æ®µ  
* **äº®ç‚¹**ï¼šç”¨å½’å¹¶æ’åºé«˜æ•ˆç»Ÿè®¡é€†åºå¯¹ï¼Œä»£ç é€»è¾‘æ¸…æ™°ã€‚  
* **æ ¸å¿ƒä»£ç ç‰‡æ®µ**ï¼š  
  ```cpp
  void msort(int n, int m) {
      if (n == m) return;
      int mid = (n + m) / 2;
      msort(n, mid);
      msort(mid + 1, m);
      int i = n, j = mid + 1, k = n;
      while (i <= mid && j <= m) {
          if (s[i] > s[j]) {
              l[k++] = s[j++];
              ans += mid - i + 1;
          } else {
              l[k++] = s[i++];
          }
      }
      // åˆå¹¶å‰©ä½™å…ƒç´ 
  }
  ```
* **ä»£ç è§£è¯»**ï¼š  
  å½’å¹¶æ’åºçš„åˆ†æ²»è¿‡ç¨‹ï¼šå°†åºåˆ—åˆ†æˆå·¦å³ä¸¤éƒ¨åˆ†ï¼Œåˆ†åˆ«æ’åºï¼Œç„¶ååˆå¹¶ã€‚åˆå¹¶æ—¶ï¼Œå¦‚æœå·¦è¾¹çš„å…ƒç´ å¤§äºå³è¾¹çš„å…ƒç´ ï¼Œè¯´æ˜å·¦è¾¹å‰©ä¸‹çš„æ‰€æœ‰å…ƒç´ éƒ½ä¸å³è¾¹çš„å½“å‰å…ƒç´ å½¢æˆé€†åºå¯¹ï¼Œç»Ÿè®¡ä¸ªæ•°ï¼ˆ`ans += mid - i + 1`ï¼‰ã€‚  
* ğŸ’¡ **å­¦ä¹ ç¬”è®°**ï¼šå½’å¹¶æ’åºæ˜¯æ±‚é€†åºå¯¹çš„ç»å…¸æ–¹æ³•ï¼Œæ—¶é—´å¤æ‚åº¦O(nlogn)ï¼Œé€‚åˆå¤§æ•°æ®é‡ã€‚  


### é¢˜è§£äºŒï¼šyangwenbinçš„æ ‘çŠ¶æ•°ç»„ç‰‡æ®µ  
* **äº®ç‚¹**ï¼šç”¨æ ‘çŠ¶æ•°ç»„ç»Ÿè®¡é€†åºå¯¹ï¼Œå¸¸æ•°æ›´å°ï¼Œæ•ˆç‡æ›´é«˜ã€‚  
* **æ ¸å¿ƒä»£ç ç‰‡æ®µ**ï¼š  
  ```cpp
  inline int lowbit(int x) { return x & (-x); }
  void add(int x, int val) { for (; x <= n; x += lowbit(x)) tr[x] += val; }
  int sum(int x) { int res = 0; for (; x; x -= lowbit(x)) res += tr[x]; return res; }
  ```
* **ä»£ç è§£è¯»**ï¼š  
  æ ‘çŠ¶æ•°ç»„çš„`add`å‡½æ•°ç”¨äºæ›´æ–°å…ƒç´ ï¼ˆæ·»åŠ 1ï¼‰ï¼Œ`sum`å‡½æ•°ç”¨äºæŸ¥è¯¢å‰ç¼€å’Œï¼ˆç»Ÿè®¡æ¯”å½“å‰å…ƒç´ å°çš„å…ƒç´ ä¸ªæ•°ï¼‰ã€‚é€†åºå¯¹ä¸ªæ•°ç­‰äºâ€œå½“å‰å…ƒç´ çš„ä½ç½® - å‰ç¼€å’Œ - 1â€ï¼ˆæ¯”å¦‚ï¼Œç¬¬iä¸ªå…ƒç´ ï¼Œå‰é¢æœ‰sum(s[i])ä¸ªæ¯”å®ƒå°çš„ï¼Œé€†åºå¯¹ä¸ªæ•°æ˜¯i-1 - sum(s[i])ï¼‰ã€‚  
* ğŸ’¡ **å­¦ä¹ ç¬”è®°**ï¼šæ ‘çŠ¶æ•°ç»„æ˜¯å¤„ç†å‰ç¼€å’Œé—®é¢˜çš„é«˜æ•ˆæ•°æ®ç»“æ„ï¼Œé€‚åˆéœ€è¦é¢‘ç¹æ›´æ–°å’ŒæŸ¥è¯¢çš„åœºæ™¯ã€‚  


## 5. ç®—æ³•å¯è§†åŒ–ï¼šåƒç´ åŠ¨ç”»æ¼”ç¤ºï¼ˆæ ¸å¿ƒéƒ¨åˆ†ï¼‰

### åŠ¨ç”»æ¼”ç¤ºä¸»é¢˜ï¼šã€Šç§¯æœ¨äº¤æ¢å¤§æŒ‘æˆ˜ã€‹ï¼ˆ8ä½åƒç´ é£æ ¼ï¼‰  
### è®¾è®¡æ€è·¯  
ç”¨FCçº¢ç™½æœºçš„é£æ ¼å±•ç¤ºè¡¨æ ¼ï¼Œæ¯åˆ—ç§¯æœ¨ç”¨ä¸åŒé¢œè‰²çš„åƒç´ å—è¡¨ç¤ºï¼ˆæ¯”å¦‚çº¢è‰²ç§¯æœ¨[1,3]ï¼Œè“è‰²ç§¯æœ¨[2,4]ï¼‰ã€‚äº¤æ¢ç›¸é‚»ç§¯æœ¨æ—¶ï¼Œç”¨â€œæ»‘åŠ¨â€åŠ¨ç”»ï¼ˆæ¯”å¦‚çº¢è‰²ç§¯æœ¨ä»åˆ—1æ»‘åˆ°åˆ—2ï¼Œè“è‰²ç§¯æœ¨ä»åˆ—2æ»‘åˆ°åˆ—1ï¼‰ï¼ŒåŒæ—¶ç¿»è½¬ç§¯æœ¨å†…éƒ¨çš„æ•°å­—ï¼ˆä¸Šä¸‹äº¤æ¢ï¼‰ã€‚é€†åºå¯¹ç»Ÿè®¡æ—¶ï¼Œç”¨â€œçº¢è‰²ç®­å¤´â€æ ‡è®°é€†åºçš„ç§¯æœ¨å¯¹ï¼ˆæ¯”å¦‚çº¢è‰²ç§¯æœ¨åœ¨è“è‰²ç§¯æœ¨åé¢ï¼Œä½†åº”è¯¥åœ¨å‰é¢ï¼‰ï¼Œä¼´éšâ€œå®â€çš„éŸ³æ•ˆæç¤ºã€‚  

### åŠ¨ç”»å¸§æ­¥éª¤  
1. **åˆå§‹åŒ–**ï¼šå±•ç¤ºåˆå§‹è¡¨æ ¼ï¼ˆæ¯”å¦‚åˆ—1æ˜¯[1,3]ï¼Œåˆ—2æ˜¯[2,4]ï¼‰ï¼Œç›®æ ‡è¡¨æ ¼ï¼ˆæ¯”å¦‚åˆ—1æ˜¯[2,4]ï¼Œåˆ—2æ˜¯[1,3]ï¼‰ã€‚  
2. **åˆ¤æ— è§£**ï¼šå¦‚æœç›®æ ‡åˆ—ä¸­çš„æ•°å­—ä¸æ˜¯åŒä¼´ï¼ˆæ¯”å¦‚åˆ—1æ˜¯[1,4]ï¼‰ï¼Œåˆ™æ’­æ”¾â€œé”™è¯¯â€éŸ³æ•ˆï¼ˆçŸ­ä¿ƒçš„â€œå“”â€å£°ï¼‰ï¼Œå¹¶æ˜¾ç¤ºâ€œç§¯æœ¨æ•£äº†ï¼Œæ— æ³•å®Œæˆï¼â€ã€‚  
3. **äº¤æ¢è¿‡ç¨‹**ï¼šæ¯”å¦‚è¦äº¤æ¢åˆ—1å’Œåˆ—2çš„ç§¯æœ¨ï¼Œçº¢è‰²ç§¯æœ¨ä»åˆ—1æ»‘åˆ°åˆ—2ï¼Œè“è‰²ç§¯æœ¨ä»åˆ—2æ»‘åˆ°åˆ—1ï¼ŒåŒæ—¶ç¿»è½¬å†…éƒ¨æ•°å­—ï¼ˆ[1,3]å˜æˆ[3,1]ï¼Œ[2,4]å˜æˆ[4,2]ï¼‰ã€‚  
4. **é€†åºå¯¹ç»Ÿè®¡**ï¼šç”¨çº¢è‰²ç®­å¤´æ ‡è®°é€†åºçš„ç§¯æœ¨å¯¹ï¼ˆæ¯”å¦‚åˆ—2çš„çº¢è‰²ç§¯æœ¨åœ¨åˆ—1çš„è“è‰²ç§¯æœ¨åé¢ï¼Œä½†åº”è¯¥åœ¨å‰é¢ï¼‰ï¼Œä¼´éšâ€œå®â€çš„éŸ³æ•ˆï¼Œç»Ÿè®¡é€†åºå¯¹ä¸ªæ•°ã€‚  
5. **å®Œæˆ**ï¼šå½“æ‰€æœ‰ç§¯æœ¨éƒ½åˆ°è¾¾ç›®æ ‡ä½ç½®æ—¶ï¼Œæ’­æ”¾â€œèƒœåˆ©â€éŸ³æ•ˆï¼ˆä¸Šæ‰¬çš„â€œå®â€å£°ï¼‰ï¼Œæ˜¾ç¤ºâ€œæŒ‘æˆ˜æˆåŠŸï¼æœ€å°‘æ“ä½œæ¬¡æ•°ï¼š1â€ã€‚  

### äº¤äº’è®¾è®¡  
- **å•æ­¥æ‰§è¡Œ**ï¼šç‚¹å‡»â€œä¸‹ä¸€æ­¥â€æŒ‰é’®ï¼Œé€æ­¥å±•ç¤ºäº¤æ¢è¿‡ç¨‹ã€‚  
- **è‡ªåŠ¨æ’­æ”¾**ï¼šç‚¹å‡»â€œè‡ªåŠ¨â€æŒ‰é’®ï¼Œå¿«é€Ÿæ’­æ”¾æ•´ä¸ªè¿‡ç¨‹ï¼ˆå¯è°ƒèŠ‚é€Ÿåº¦ï¼‰ã€‚  
- **é‡ç½®**ï¼šç‚¹å‡»â€œé‡ç½®â€æŒ‰é’®ï¼Œå›åˆ°åˆå§‹çŠ¶æ€ã€‚  


## 6. æ‹“å±•ç»ƒä¹ ä¸ç›¸ä¼¼é—®é¢˜æ€è€ƒ

### é€šç”¨æ€è·¯è¿ç§»  
é€†åºå¯¹é—®é¢˜å¹¿æ³›åº”ç”¨äº**æ’åˆ—è½¬æ¢**åœºæ™¯ï¼Œæ¯”å¦‚ï¼š  
- ç«æŸ´æ’é˜Ÿï¼ˆå°†ä¸¤åˆ—ç«æŸ´æ’åºï¼Œä½¿å¾—å¯¹åº”ä½ç½®çš„å·®æœ€å°ï¼‰ï¼›  
- å†’æ³¡æ’åºçš„æœ€å°‘äº¤æ¢æ¬¡æ•°ï¼›  
- ç»Ÿè®¡åºåˆ—ä¸­çš„é€†åºå¯¹ä¸ªæ•°ã€‚  

### æ´›è°·ç»ƒä¹ æ¨è  
1. **æ´›è°· P1966 ç«æŸ´æ’é˜Ÿ**ï¼š  
   ğŸ—£ï¸ **æ¨èç†ç”±**ï¼šè¿™é“é¢˜æ˜¯é€†åºå¯¹çš„ç»å…¸åº”ç”¨ï¼Œéœ€è¦å°†ä¸¤åˆ—ç«æŸ´æ’åºï¼Œä½¿å¾—å¯¹åº”ä½ç½®çš„å·®æœ€å°ã€‚è§£é¢˜æ€è·¯ä¸æœ¬é¢˜ç±»ä¼¼ï¼Œéƒ½æ˜¯å°†é—®é¢˜è½¬åŒ–ä¸ºé€†åºå¯¹ã€‚  
2. **æ´›è°· P1908 é€†åºå¯¹**ï¼š  
   ğŸ—£ï¸ **æ¨èç†ç”±**ï¼šè¿™é“é¢˜æ˜¯é€†åºå¯¹çš„åŸºç¡€é¢˜ï¼Œè¦æ±‚ç»Ÿè®¡åºåˆ—ä¸­çš„é€†åºå¯¹ä¸ªæ•°ã€‚å¯ä»¥ç”¨å½’å¹¶æ’åºæˆ–æ ‘çŠ¶æ•°ç»„è§£å†³ï¼Œé€‚åˆå·©å›ºé€†åºå¯¹çš„ç®—æ³•ã€‚  
3. **æ´›è°· P1774 æœ€æ¥è¿‘ç¥çš„äºº**ï¼š  
   ğŸ—£ï¸ **æ¨èç†ç”±**ï¼šè¿™é“é¢˜è¦æ±‚å°†åºåˆ—æ’åºï¼Œä½¿å¾—ç›¸é‚»å…ƒç´ çš„å·®çš„æœ€å¤§å€¼æœ€å°ã€‚è§£é¢˜æ€è·¯éœ€è¦ç”¨åˆ°é€†åºå¯¹ï¼Œé€‚åˆæ‹“å±•æ€ç»´ã€‚  


## 7. å­¦ä¹ å¿ƒå¾—ä¸ç»éªŒåˆ†äº«ï¼ˆè‹¥æœ‰ï¼‰  
**å‚è€ƒç»éªŒï¼ˆæ¥è‡ªRedreamMerï¼‰**ï¼šâ€œæˆ‘åœ¨è§£å†³è¿™é“é¢˜æ—¶ï¼Œæœ€åˆæ²¡æœ‰æƒ³åˆ°å°†è¡¨æ ¼è½¬åŒ–ä¸ºåºåˆ—é—®é¢˜ï¼Œåæ¥é€šè¿‡è§‚å¯Ÿæ—‹è½¬æ“ä½œçš„å½±å“ï¼Œå‘ç°æ¯åˆ—çš„æ•°å­—ä¸ä¼šåˆ†å¼€ï¼Œæ‰æƒ³åˆ°äº†å»ºæ¨¡çš„æ–¹æ³•ã€‚â€  
**ç‚¹è¯„**ï¼šè¿™ä½ä½œè€…çš„ç»éªŒå¾ˆå…¸å‹ã€‚åœ¨è§£å†³ç¼–ç¨‹é—®é¢˜æ—¶ï¼Œ**è§‚å¯Ÿæ“ä½œçš„å½±å“**æ˜¯å…³é”®ã€‚æ¯”å¦‚ï¼Œæ—‹è½¬æ“ä½œä¸ä¼šæ”¹å˜åˆ—çš„å®Œæ•´æ€§ï¼Œè¿™æ˜¯å»ºæ¨¡çš„çªç ´å£ã€‚é‡åˆ°é—®é¢˜æ—¶ï¼Œä¸å¦¨å…ˆæ¨¡æ‹Ÿå‡ ä¸ªå°ä¾‹å­ï¼Œçœ‹çœ‹æœ‰æ²¡æœ‰è§„å¾‹ã€‚  


## ç»“è¯­  
æœ¬æ¬¡å…³äºâ€œè®ºå¦‚ä½•ç©è½¬Excelè¡¨æ ¼â€çš„C++è§£é¢˜åˆ†æå°±åˆ°è¿™é‡Œã€‚å¸Œæœ›è¿™ä»½å­¦ä¹ æŒ‡å—èƒ½å¸®åŠ©å¤§å®¶ç†è§£**é€†åºå¯¹**çš„åº”ç”¨ï¼Œä»¥åŠå¦‚ä½•å°†å¤æ‚çš„è¡¨æ ¼é—®é¢˜è½¬åŒ–ä¸ºç®€å•çš„åºåˆ—é—®é¢˜ã€‚è®°ä½ï¼Œç¼–ç¨‹çš„å…³é”®æ˜¯**å»ºæ¨¡**â€”â€”å°†ç°å®é—®é¢˜è½¬åŒ–ä¸ºè®¡ç®—æœºèƒ½å¤„ç†çš„æ•°å­¦é—®é¢˜ã€‚ä¸‹æ¬¡æˆ‘ä»¬å†ä¸€èµ·æ¢ç´¢æ–°çš„ç¼–ç¨‹æŒ‘æˆ˜ï¼ğŸ’ª

---
å¤„ç†ç”¨æ—¶ï¼š156.35ç§’
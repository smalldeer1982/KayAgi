# é¢˜ç›®ä¿¡æ¯

# [CTSC1997] é€‰è¯¾

## é¢˜ç›®æè¿°

åœ¨å¤§å­¦é‡Œæ¯ä¸ªå­¦ç”Ÿï¼Œä¸ºäº†è¾¾åˆ°ä¸€å®šçš„å­¦åˆ†ï¼Œå¿…é¡»ä»å¾ˆå¤šè¯¾ç¨‹é‡Œé€‰æ‹©ä¸€äº›è¯¾ç¨‹æ¥å­¦ä¹ ï¼Œåœ¨è¯¾ç¨‹é‡Œæœ‰äº›è¯¾ç¨‹å¿…é¡»åœ¨æŸäº›è¯¾ç¨‹ä¹‹å‰å­¦ä¹ ï¼Œå¦‚é«˜ç­‰æ•°å­¦æ€»æ˜¯åœ¨å…¶å®ƒè¯¾ç¨‹ä¹‹å‰å­¦ä¹ ã€‚ç°åœ¨æœ‰ $N$ é—¨åŠŸè¯¾ï¼Œæ¯é—¨è¯¾æœ‰ä¸ªå­¦åˆ†ï¼Œæ¯é—¨è¯¾æœ‰ä¸€é—¨æˆ–æ²¡æœ‰ç›´æ¥å…ˆä¿®è¯¾ï¼ˆè‹¥è¯¾ç¨‹ a æ˜¯è¯¾ç¨‹ b çš„å…ˆä¿®è¯¾å³åªæœ‰å­¦å®Œäº†è¯¾ç¨‹ aï¼Œæ‰èƒ½å­¦ä¹ è¯¾ç¨‹ bï¼‰ã€‚ä¸€ä¸ªå­¦ç”Ÿè¦ä»è¿™äº›è¯¾ç¨‹é‡Œé€‰æ‹© $M$ é—¨è¯¾ç¨‹å­¦ä¹ ï¼Œé—®ä»–èƒ½è·å¾—çš„æœ€å¤§å­¦åˆ†æ˜¯å¤šå°‘ï¼Ÿ

## æ ·ä¾‹ #1

### è¾“å…¥

```
7  4
2  2
0  1
0  4
2  1
7  1
7  6
2  2
```

### è¾“å‡º

```
13```

# AIåˆ†æç»“æœ

# ğŸ’¡ Kayçš„C++ç®—æ³•è§£æï¼š[CTSC1997] é€‰è¯¾ æ·±å…¥å­¦ä¹ æŒ‡å— ğŸ’¡


## 1. é¢˜ç›®è§£è¯»ä¸æ ¸å¿ƒç®—æ³•è¯†åˆ«

âœ¨ **æœ¬é¢˜ä¸»è¦è€ƒå¯Ÿ**ï¼šæ ‘å½¢åŠ¨æ€è§„åˆ’ï¼ˆæ ‘å½¢DPï¼‰+ èƒŒåŒ…é—®é¢˜


### ğŸ—£ï¸ åˆæ­¥åˆ†æ
è§£å†³â€œé€‰è¯¾â€é—®é¢˜çš„å…³é”®ï¼Œåœ¨äº**æ ‘å½¢åŠ¨æ€è§„åˆ’**ï¼ˆTree DPï¼‰â€”â€” å®ƒåƒâ€œç»™æ ‘çš„æ¯ä¸ªèŠ‚ç‚¹åˆ†é…â€˜é€‰è¯¾åé¢â€™ï¼Œä»å¶å­èŠ‚ç‚¹å¾€ä¸Šåˆå¹¶æœ€ä¼˜ç»“æœâ€ã€‚å…·ä½“æ¥è¯´ï¼š  
- é¢˜ç›®ä¸­çš„è¯¾ç¨‹ä¾èµ–å…³ç³»å½¢æˆ**æ£®æ—**ï¼ˆå¤šæ£µæ ‘ï¼‰ï¼Œæˆ‘ä»¬å¯ä»¥æ·»åŠ ä¸€ä¸ª**è™šæ‹Ÿæ ¹èŠ‚ç‚¹0**ï¼ˆæ— å­¦åˆ†ï¼‰ï¼ŒæŠŠæ£®æ—å˜æˆä¸€æ£µå®Œæ•´çš„æ ‘ï¼ˆæ‰€æœ‰æ— å…ˆä¿®è¯¾çš„è¯¾ç¨‹éƒ½ä½œä¸º0çš„å­èŠ‚ç‚¹ï¼‰ã€‚  
- æˆ‘ä»¬éœ€è¦åœ¨è¿™æ£µæ ‘ä¸Šé€‰æ‹©**M+1é—¨è¯¾**ï¼ˆå› ä¸ºè™šæ‹Ÿæ ¹0å¿…é¡»é€‰ï¼Œå¦åˆ™æ— æ³•é€‰å®ƒçš„å­èŠ‚ç‚¹ï¼‰ï¼Œä½¿å¾—æ€»å­¦åˆ†æœ€å¤§ã€‚è¿™æœ¬è´¨æ˜¯**æ ‘å½¢èƒŒåŒ…é—®é¢˜**ï¼šæ¯ä¸ªå­æ ‘åƒä¸€ä¸ªâ€œç‰©å“ç»„â€ï¼Œé€‰æ‹©å­æ ‘ä¸­çš„ké—¨è¯¾ï¼Œç›¸å½“äºä»è¯¥ç»„ä¸­é€‰ä¸€ä¸ªâ€œä½“ç§¯ä¸ºkã€ä»·å€¼ä¸ºå¯¹åº”å­¦åˆ†â€çš„ç‰©å“ã€‚


### æ ¸å¿ƒç®—æ³•æµç¨‹
1. **æ ‘ç»“æ„å¤„ç†**ï¼šç”¨å‰å‘æ˜Ÿæˆ–vectorå­˜å›¾ï¼Œæ·»åŠ è™šæ‹Ÿæ ¹0ï¼Œå°†æ£®æ—è½¬ä¸ºæ ‘ã€‚  
2. **çŠ¶æ€å®šä¹‰**ï¼š`dp[u][j]` è¡¨ç¤ºä»¥`u`ä¸ºæ ¹çš„å­æ ‘ä¸­ï¼Œé€‰`j`é—¨è¯¾ï¼ˆåŒ…æ‹¬`u`è‡ªå·±ï¼‰çš„æœ€å¤§å­¦åˆ†ã€‚  
3. **çŠ¶æ€è½¬ç§»**ï¼šå¯¹äº`u`çš„æ¯ä¸ªå­èŠ‚ç‚¹`v`ï¼Œç”¨**èƒŒåŒ…åˆå¹¶**çš„æ–¹å¼æ›´æ–°`dp[u]`ï¼š  
   ```cpp
   for (int j = m+1; j >= 1; --j)  // å€’åºå¾ªç¯ï¼Œé¿å…é‡å¤é€‰æ‹©
       for (int k = 0; k < j; ++k)
           dp[u][j] = max(dp[u][j], dp[u][j-k] + dp[v][k]);
   ```
   ï¼ˆè§£é‡Šï¼š`j-k`æ˜¯`u`å·²é€‰çš„è¯¾ç¨‹æ•°ï¼Œ`k`æ˜¯`v`å­æ ‘é€‰çš„è¯¾ç¨‹æ•°ï¼Œåˆå¹¶ä¸¤è€…çš„æœ€ä¼˜ç»“æœï¼‰ã€‚  
4. **åˆå§‹åŒ–**ï¼š`dp[i][1] = è¯¾ç¨‹içš„å­¦åˆ†`ï¼ˆé€‰è‡ªå·±ï¼‰ï¼Œ`dp[0][m+1]`å³ä¸ºç­”æ¡ˆï¼ˆé€‰è™šæ‹Ÿæ ¹+Mé—¨è¯¾ï¼‰ã€‚


### å¯è§†åŒ–è®¾è®¡æ€è·¯
æˆ‘ä»¬ç”¨**8ä½åƒç´ é£æ ¼**ï¼ˆç±»ä¼¼FCæ¸¸æˆï¼‰å±•ç¤ºç®—æ³•è¿‡ç¨‹ï¼š  
- **åœºæ™¯**ï¼šå±å¹•å·¦ä¾§æ˜¯æ ‘ç»“æ„ï¼ˆè™šæ‹Ÿæ ¹0åœ¨é¡¶éƒ¨ï¼Œå­èŠ‚ç‚¹å‘ä¸‹å»¶ä¼¸ï¼‰ï¼Œå³ä¾§æ˜¯`dp`æ•°ç»„çš„åŠ¨æ€å˜åŒ–ã€‚  
- **åŠ¨ç”»æ­¥éª¤**ï¼š  
  1. **åˆå§‹åŒ–**ï¼šè™šæ‹Ÿæ ¹0é—ªçƒï¼Œå­èŠ‚ç‚¹æŒ‰å…ˆä¿®å…³ç³»æ’åˆ—ã€‚  
  2. **DFSéå†**ï¼šä»0å¼€å§‹ï¼Œé€’å½’è®¿é—®å­èŠ‚ç‚¹ï¼ˆèŠ‚ç‚¹å˜ä¸ºè“è‰²è¡¨ç¤ºæ­£åœ¨å¤„ç†ï¼‰ã€‚  
  3. **èƒŒåŒ…åˆå¹¶**ï¼šå¤„ç†å­èŠ‚ç‚¹`v`æ—¶ï¼Œ`dp[u][j]`çš„æ•°å€¼ç”¨åƒç´ å—è¡¨ç¤ºï¼ˆæ•°å€¼è¶Šå¤§ï¼Œå—è¶Šäº®ï¼‰ï¼Œå€’åºå¾ªç¯æ—¶ï¼Œå—çš„é¢œè‰²ä»çº¢å˜ç»¿ï¼Œè¡¨ç¤ºæ›´æ–°å®Œæˆã€‚  
  4. **ç»“æœå±•ç¤º**ï¼šæœ€ç»ˆé€‰ä¸­çš„è¯¾ç¨‹ï¼ˆ`dp[0][m+1]`å¯¹åº”çš„èŠ‚ç‚¹ï¼‰å˜ä¸ºé»„è‰²ï¼Œæ’­æ”¾â€œèƒœåˆ©â€éŸ³æ•ˆï¼ˆå¦‚FCæ¸¸æˆçš„é€šå…³å£°ï¼‰ã€‚  
- **äº¤äº’**ï¼šæ”¯æŒâ€œå•æ­¥æ‰§è¡Œâ€ï¼ˆç‚¹å‡»â€œä¸‹ä¸€æ­¥â€æŒ‰é’®ï¼‰ã€â€œè‡ªåŠ¨æ’­æ”¾â€ï¼ˆæ»‘å—è°ƒæ•´é€Ÿåº¦ï¼‰ã€â€œé‡ç½®â€ï¼ˆå›åˆ°åˆå§‹çŠ¶æ€ï¼‰ã€‚


## 2. ç²¾é€‰ä¼˜è´¨é¢˜è§£å‚è€ƒ

### é¢˜è§£ä¸€ï¼ˆä½œè€…ï¼šHe_Renï¼Œèµï¼š824ï¼‰
**ç‚¹è¯„**ï¼š  
è¿™æ˜¯æœ€ç»å…¸çš„æ ‘å½¢DPè§£æ³•ï¼Œæ€è·¯æ¸…æ™°ï¼Œä»£ç è§„èŒƒã€‚  
- **æ€è·¯**ï¼šç”¨å‰å‘æ˜Ÿå­˜å›¾ï¼Œæ·»åŠ è™šæ‹Ÿæ ¹0ï¼Œå°†æ£®æ—è½¬ä¸ºæ ‘ã€‚çŠ¶æ€`dp[u][j]`è¡¨ç¤ºä»¥`u`ä¸ºæ ¹çš„å­æ ‘é€‰`j`é—¨è¯¾çš„æœ€å¤§å­¦åˆ†ï¼Œè½¬ç§»æ—¶ç”¨èƒŒåŒ…åˆå¹¶å­èŠ‚ç‚¹ç»“æœï¼ˆå€’åºå¾ªç¯é¿å…é‡å¤ï¼‰ã€‚  
- **ä»£ç äº®ç‚¹**ï¼šå˜é‡å‘½åæ˜ç¡®ï¼ˆå¦‚`dp`æ•°ç»„ã€`chk_max`å‡½æ•°ï¼‰ï¼Œè¾¹ç•Œå¤„ç†ä¸¥è°¨ï¼ˆ`m++`å¤„ç†è™šæ‹Ÿæ ¹ï¼‰ã€‚  
- **å®è·µä»·å€¼**ï¼šç›´æ¥å¯¹åº”æ ‘å½¢èƒŒåŒ…çš„æ¨¡æ¿ï¼Œå¯ç”¨äºç±»ä¼¼é—®é¢˜ï¼ˆå¦‚â€œäºŒå‰è‹¹æœæ ‘â€ï¼‰ã€‚


### é¢˜è§£äºŒï¼ˆä½œè€…ï¼šHullEssienï¼Œèµï¼š537ï¼‰
**ç‚¹è¯„**ï¼š  
ä»£ç æ›´ç®€æ´ï¼Œç”¨vectorå­˜å›¾ï¼Œé€‚åˆåˆå­¦è€…ç†è§£ã€‚  
- **æ€è·¯**ï¼šä¸é¢˜è§£ä¸€ä¸€è‡´ï¼Œä½†ç”¨vectorä»£æ›¿å‰å‘æ˜Ÿï¼Œç®€åŒ–äº†å­˜å›¾ä»£ç ã€‚çŠ¶æ€è½¬ç§»çš„ä¸‰é‡å¾ªç¯æ›´ç›´è§‚ï¼ˆéå†å­èŠ‚ç‚¹â†’å€’åºéå†å½“å‰èŠ‚ç‚¹é€‰è¯¾æ•°â†’éå†å­èŠ‚ç‚¹é€‰è¯¾æ•°ï¼‰ã€‚  
- **ä»£ç äº®ç‚¹**ï¼š`dfs`å‡½æ•°ç»“æ„æ¸…æ™°ï¼Œ`dp`æ•°ç»„çš„åˆå§‹åŒ–ï¼ˆ`dp[i][1] = å­¦åˆ†`ï¼‰ä¸€ç›®äº†ç„¶ã€‚


### é¢˜è§£ä¸‰ï¼ˆä½œè€…ï¼šzeroy0410ï¼Œèµï¼š14ï¼‰
**ç‚¹è¯„**ï¼š  
æå‡ºäº†**DFSåºä¼˜åŒ–**ï¼Œé™ä½äº†æ—¶é—´å¤æ‚åº¦ï¼ˆä»`O(N*MÂ²)`åˆ°`O(N*M)`ï¼‰ï¼Œæ˜¯è¿›é˜¶çš„å¥½é€‰æ‹©ã€‚  
- **æ€è·¯**ï¼šå…ˆå¯¹æ ‘è¿›è¡ŒDFSåºéå†ï¼Œå°†æ ‘å½¢ç»“æ„è½¬ä¸ºçº¿æ€§ç»“æ„ï¼Œç„¶åç”¨çº¿æ€§DPå¤„ç†ï¼š`dp[i][j] = max(dp[i+size[ln[i]]][j], dp[i+1][j-1] + A[ln[i]])`ï¼ˆ`ln[i]`æ˜¯DFSåºä¸­çš„ç¬¬`i`ä¸ªèŠ‚ç‚¹ï¼Œ`size[ln[i]]`æ˜¯å…¶å­æ ‘å¤§å°ï¼‰ã€‚  
- **ä»£ç äº®ç‚¹**ï¼šä¼˜åŒ–äº†æ—¶é—´å¤æ‚åº¦ï¼Œé€‚åˆå¤§æ•°æ®é‡çš„æƒ…å†µï¼Œæ‹“å±•äº†æ ‘å½¢DPçš„æ€è·¯ã€‚


## 3. æ ¸å¿ƒéš¾ç‚¹è¾¨æä¸è§£é¢˜ç­–ç•¥

### 1. æ ‘ç»“æ„çš„å¤„ç†ï¼ˆæ£®æ—è½¬æ ‘ï¼‰
**éš¾ç‚¹**ï¼šé¢˜ç›®ä¸­çš„è¯¾ç¨‹ä¾èµ–å…³ç³»æ˜¯æ£®æ—ï¼ˆå¤šæ£µæ ‘ï¼‰ï¼Œæ— æ³•ç›´æ¥ç”¨æ ‘å½¢DPå¤„ç†ã€‚  
**è§£å†³ç­–ç•¥**ï¼šæ·»åŠ **è™šæ‹Ÿæ ¹èŠ‚ç‚¹0**ï¼Œå°†æ‰€æœ‰æ— å…ˆä¿®è¯¾çš„è¯¾ç¨‹ä½œä¸º0çš„å­èŠ‚ç‚¹ï¼Œç»Ÿä¸€ä¸ºä¸€æ£µæ ‘ã€‚è¿™æ ·ï¼Œé€‰Mé—¨è¯¾å°±è½¬åŒ–ä¸ºé€‰è™šæ‹Ÿæ ¹+Mé—¨è¯¾ï¼ˆ`m++`ï¼‰ã€‚  
**å­¦ä¹ ç¬”è®°**ï¼šè™šæ‹Ÿæ ¹æ˜¯å¤„ç†æ£®æ—çš„å¸¸ç”¨æŠ€å·§ï¼Œèƒ½å°†å¤æ‚çš„æ£®æ—é—®é¢˜è½¬åŒ–ä¸ºç®€å•çš„æ ‘é—®é¢˜ã€‚


### 2. çŠ¶æ€å®šä¹‰ï¼ˆå¦‚ä½•è¡¨ç¤ºå­æ ‘çš„æœ€ä¼˜è§£ï¼‰
**éš¾ç‚¹**ï¼šå¦‚ä½•å®šä¹‰çŠ¶æ€ï¼Œæ‰èƒ½å‡†ç¡®è¡¨ç¤ºå­æ ‘ä¸­é€‰ké—¨è¯¾çš„æœ€å¤§å­¦åˆ†ï¼Ÿ  
**è§£å†³ç­–ç•¥**ï¼š`dp[u][j]`è¡¨ç¤ºä»¥`u`ä¸ºæ ¹çš„å­æ ‘ä¸­ï¼Œé€‰`j`é—¨è¯¾ï¼ˆåŒ…æ‹¬`u`è‡ªå·±ï¼‰çš„æœ€å¤§å­¦åˆ†ã€‚è¿™æ ·ï¼Œå­èŠ‚ç‚¹çš„çŠ¶æ€å¯ä»¥åˆå¹¶åˆ°çˆ¶èŠ‚ç‚¹ï¼Œç¬¦åˆæ ‘å½¢DPçš„â€œè‡ªåº•å‘ä¸Šâ€æ€æƒ³ã€‚  
**å­¦ä¹ ç¬”è®°**ï¼šçŠ¶æ€å®šä¹‰è¦åŒ…å«â€œå­æ ‘â€å’Œâ€œèµ„æºï¼ˆé€‰è¯¾æ•°ï¼‰â€ä¸¤ä¸ªæ ¸å¿ƒè¦ç´ ã€‚


### 3. çŠ¶æ€è½¬ç§»ï¼ˆèƒŒåŒ…åˆå¹¶å­æ ‘ç»“æœï¼‰
**éš¾ç‚¹**ï¼šå¦‚ä½•å°†å­èŠ‚ç‚¹çš„çŠ¶æ€åˆå¹¶åˆ°çˆ¶èŠ‚ç‚¹ï¼Œé¿å…é‡å¤è®¡ç®—ï¼Ÿ  
**è§£å†³ç­–ç•¥**ï¼šç”¨**å€’åºå¾ªç¯**ï¼ˆä»`m+1`åˆ°`1`ï¼‰éå†çˆ¶èŠ‚ç‚¹çš„é€‰è¯¾æ•°ï¼Œå†éå†å­èŠ‚ç‚¹çš„é€‰è¯¾æ•°ã€‚è¿™æ ·ï¼Œæ¯ä¸ªå­èŠ‚ç‚¹çš„çŠ¶æ€åªä¼šè¢«ä½¿ç”¨ä¸€æ¬¡ï¼Œé¿å…é‡å¤é€‰æ‹©ã€‚  
**å­¦ä¹ ç¬”è®°**ï¼šå€’åºå¾ªç¯æ˜¯èƒŒåŒ…é—®é¢˜ä¸­é¿å…é‡å¤é€‰æ‹©çš„å…³é”®ï¼Œæ ‘å½¢èƒŒåŒ…ä¹Ÿä¸ä¾‹å¤–ã€‚


### âœ¨ è§£é¢˜æŠ€å·§æ€»ç»“
- **æ£®æ—è½¬æ ‘**ï¼šæ·»åŠ è™šæ‹Ÿæ ¹ï¼Œç»Ÿä¸€å¤„ç†ã€‚  
- **çŠ¶æ€å®šä¹‰**ï¼šåŒ…å«å­æ ‘å’Œèµ„æºï¼ˆå¦‚é€‰è¯¾æ•°ï¼‰ã€‚  
- **çŠ¶æ€è½¬ç§»**ï¼šå€’åºå¾ªç¯ï¼Œé¿å…é‡å¤ï¼›ç”¨èƒŒåŒ…åˆå¹¶å­èŠ‚ç‚¹ç»“æœã€‚  
- **ä»£ç ç®€åŒ–**ï¼šç”¨vectorå­˜å›¾æ¯”å‰å‘æ˜Ÿæ›´ç®€æ´ï¼Œé€‚åˆåˆå­¦è€…ã€‚


## 4. C++æ ¸å¿ƒä»£ç å®ç°èµæ

### æœ¬é¢˜é€šç”¨æ ¸å¿ƒC++å®ç°å‚è€ƒï¼ˆç»¼åˆè‡ªHe_Renã€HullEssiençš„é¢˜è§£ï¼‰
**è¯´æ˜**ï¼šè¿™æ˜¯æ ‘å½¢DPè§£å†³â€œé€‰è¯¾â€é—®é¢˜çš„ç»å…¸å®ç°ï¼Œç”¨vectorå­˜å›¾ï¼Œä»£ç ç®€æ´æ˜“æ‡‚ã€‚  
**å®Œæ•´æ ¸å¿ƒä»£ç **ï¼š
```cpp
#include <iostream>
#include <vector>
#include <algorithm>
using namespace std;

const int MAXN = 305;
const int MAXM = 305;

vector<int> G[MAXN];  // å­˜å›¾ï¼ˆé‚»æ¥è¡¨ï¼‰
int dp[MAXN][MAXM];    // dp[u][j]ï¼šä»¥uä¸ºæ ¹çš„å­æ ‘é€‰jé—¨è¯¾çš„æœ€å¤§å­¦åˆ†
int s[MAXN];           // è¯¾ç¨‹å­¦åˆ†
int n, m;

void dfs(int u) {
    // åˆå§‹åŒ–ï¼šé€‰è‡ªå·±ï¼ˆ1é—¨è¯¾ï¼‰
    dp[u][1] = s[u];
    // éå†å­èŠ‚ç‚¹
    for (int v : G[u]) {
        dfs(v);  // å…ˆå¤„ç†å­èŠ‚ç‚¹
        // èƒŒåŒ…åˆå¹¶ï¼šå€’åºå¾ªç¯
        for (int j = m+1; j >= 1; --j) {
            for (int k = 0; k < j; ++k) {
                dp[u][j] = max(dp[u][j], dp[u][j-k] + dp[v][k]);
            }
        }
    }
}

int main() {
    cin >> n >> m;
    m++;  // è™šæ‹Ÿæ ¹0å¿…é¡»é€‰ï¼Œæ‰€ä»¥é€‰m+1é—¨è¯¾
    for (int i = 1; i <= n; ++i) {
        int fa;
        cin >> fa >> s[i];
        G[fa].push_back(i);  // çˆ¶èŠ‚ç‚¹façš„å­èŠ‚ç‚¹æ˜¯i
    }
    // åˆå§‹åŒ–dpæ•°ç»„ä¸º0
    for (int i = 0; i <= n; ++i) {
        for (int j = 0; j <= m; ++j) {
            dp[i][j] = 0;
        }
    }
    dfs(0);  // ä»è™šæ‹Ÿæ ¹0å¼€å§‹DFS
    cout << dp[0][m] << endl;  // ç­”æ¡ˆæ˜¯é€‰è™šæ‹Ÿæ ¹+Mé—¨è¯¾çš„æœ€å¤§å­¦åˆ†
    return 0;
}
```
**ä»£ç è§£è¯»æ¦‚è¦**ï¼š  
- **å­˜å›¾**ï¼šç”¨`vector`å­˜é‚»æ¥è¡¨ï¼Œ`G[fa].push_back(i)`è¡¨ç¤º`fa`æ˜¯`i`çš„çˆ¶èŠ‚ç‚¹ã€‚  
- **DFS**ï¼šä»è™šæ‹Ÿæ ¹0å¼€å§‹ï¼Œé€’å½’å¤„ç†å­èŠ‚ç‚¹ã€‚å¯¹äºæ¯ä¸ªå­èŠ‚ç‚¹ï¼Œç”¨å€’åºå¾ªç¯åˆå¹¶å…¶çŠ¶æ€åˆ°çˆ¶èŠ‚ç‚¹ã€‚  
- **åˆå§‹åŒ–**ï¼š`dp[u][1] = s[u]`è¡¨ç¤ºé€‰è‡ªå·±ï¼ˆ1é—¨è¯¾ï¼‰ï¼Œ`m++`å¤„ç†è™šæ‹Ÿæ ¹ã€‚


### é’ˆå¯¹å„ä¼˜è´¨é¢˜è§£çš„ç‰‡æ®µèµæ

#### é¢˜è§£ä¸€ï¼ˆHe_Renï¼‰ï¼šå‰å‘æ˜Ÿå­˜å›¾
**äº®ç‚¹**ï¼šå‰å‘æ˜Ÿæ˜¯å­˜å›¾çš„å¸¸ç”¨æ–¹æ³•ï¼Œé€‚åˆå¤§æ•°æ®é‡çš„æƒ…å†µã€‚  
**æ ¸å¿ƒä»£ç ç‰‡æ®µ**ï¼š
```cpp
// å‰å‘æ˜Ÿå­˜å›¾
struct Edge {
    int next, to;
} e[MAXN];
int head[MAXN], ecnt = 0;
void add(int u, int v) {
    e[++ecnt].next = head[u];
    e[ecnt].to = v;
    head[u] = ecnt;
}

// DFSä¸­çš„èƒŒåŒ…åˆå¹¶
for (int i = head[u]; i; i = e[i].next) {
    int v = e[i].to;
    dfs(v);
    for (int j = m+1; j > 0; --j) {
        for (int k = 0; k < j; ++k) {
            dp[u][j] = max(dp[u][j], dp[u][j-k] + dp[v][k]);
        }
    }
}
```
**ä»£ç è§£è¯»**ï¼š  
- **å‰å‘æ˜Ÿ**ï¼š`head[u]`è¡¨ç¤º`u`çš„ç¬¬ä¸€ä¸ªè¾¹ï¼Œ`e[i].next`è¡¨ç¤ºä¸‹ä¸€ä¸ªè¾¹ï¼Œ`e[i].to`è¡¨ç¤ºè¾¹çš„ç»ˆç‚¹ã€‚  
- **èƒŒåŒ…åˆå¹¶**ï¼šéå†`u`çš„æ‰€æœ‰å­èŠ‚ç‚¹ï¼ˆç”¨å‰å‘æ˜Ÿï¼‰ï¼Œå€’åºå¾ªç¯åˆå¹¶å­èŠ‚ç‚¹çŠ¶æ€ã€‚  
**å­¦ä¹ ç¬”è®°**ï¼šå‰å‘æ˜Ÿå­˜å›¾çš„æ—¶é—´å¤æ‚åº¦æ›´ä½ï¼Œé€‚åˆå¤§æ•°æ®é‡çš„é¢˜ç›®ã€‚


#### é¢˜è§£ä¸‰ï¼ˆzeroy0410ï¼‰ï¼šDFSåºä¼˜åŒ–
**äº®ç‚¹**ï¼šå°†æ ‘å½¢ç»“æ„è½¬ä¸ºçº¿æ€§ç»“æ„ï¼Œé™ä½æ—¶é—´å¤æ‚åº¦ã€‚  
**æ ¸å¿ƒä»£ç ç‰‡æ®µ**ï¼š
```cpp
int ln[MAXN], tt = 0;  // DFSåº
int size[MAXN];        // å­æ ‘å¤§å°
void dfs(int u) {
    ln[++tt] = u;
    size[u] = 1;
    for (int v : G[u]) {
        dfs(v);
        size[u] += size[v];
    }
}

// çº¿æ€§DP
for (int i = tt; i >= 1; --i) {
    int u = ln[i];
    for (int j = 1; j <= m+1; ++j) {
        dp[i][j] = max(dp[i+size[u]][j], dp[i+1][j-1] + s[u]);
    }
}
```
**ä»£ç è§£è¯»**ï¼š  
- **DFSåº**ï¼š`ln[i]`æ˜¯DFSéå†çš„ç¬¬`i`ä¸ªèŠ‚ç‚¹ï¼Œ`size[u]`æ˜¯`u`çš„å­æ ‘å¤§å°ã€‚  
- **çº¿æ€§DP**ï¼šä»åå¾€å‰éå†DFSåºï¼Œ`dp[i][j]`è¡¨ç¤ºå¤„ç†åˆ°ç¬¬`i`ä¸ªèŠ‚ç‚¹æ—¶é€‰`j`é—¨è¯¾çš„æœ€å¤§å­¦åˆ†ã€‚`dp[i+size[u]][j]`è¡¨ç¤ºä¸é€‰`u`ï¼ˆè·³è¿‡å…¶å­æ ‘ï¼‰ï¼Œ`dp[i+1][j-1] + s[u]`è¡¨ç¤ºé€‰`u`ï¼ˆå¤„ç†å…¶å­æ ‘ï¼‰ã€‚  
**å­¦ä¹ ç¬”è®°**ï¼šDFSåºä¼˜åŒ–æ˜¯æ ‘å½¢DPçš„é«˜çº§æŠ€å·§ï¼Œèƒ½å°†æ—¶é—´å¤æ‚åº¦ä»`O(N*MÂ²)`é™åˆ°`O(N*M)`ã€‚


## 5. ç®—æ³•å¯è§†åŒ–ï¼šåƒç´ åŠ¨ç”»æ¼”ç¤ºï¼ˆæ ¸å¿ƒéƒ¨åˆ†ï¼‰

### åŠ¨ç”»æ¼”ç¤ºä¸»é¢˜ï¼šã€Šåƒç´ é€‰è¯¾å¤§å†’é™©ã€‹ï¼ˆFCé£æ ¼ï¼‰


### æ ¸å¿ƒæ¼”ç¤ºå†…å®¹
1. **åœºæ™¯åˆå§‹åŒ–**ï¼š  
   - å±å¹•å·¦ä¾§æ˜¯**æ ‘ç»“æ„**ï¼ˆè™šæ‹Ÿæ ¹0åœ¨é¡¶éƒ¨ï¼Œå­èŠ‚ç‚¹æŒ‰å…ˆä¿®å…³ç³»å‘ä¸‹æ’åˆ—ï¼Œæ¯ä¸ªèŠ‚ç‚¹æ˜¯ä¸€ä¸ª8x8çš„åƒç´ å—ï¼Œé¢œè‰²ä¸ºç°è‰²ï¼‰ã€‚  
   - å±å¹•å³ä¾§æ˜¯**dpæ•°ç»„é¢æ¿**ï¼ˆ`dp[0][m+1]`çš„æ•°å€¼ç”¨å¤§åƒç´ å­—æ˜¾ç¤ºï¼Œåˆå§‹ä¸º0ï¼‰ã€‚  
   - åº•éƒ¨æœ‰**æ§åˆ¶é¢æ¿**ï¼šâ€œå¼€å§‹/æš‚åœâ€æŒ‰é’®ï¼ˆçº¢è‰²ï¼‰ã€â€œå•æ­¥â€æŒ‰é’®ï¼ˆè“è‰²ï¼‰ã€â€œé‡ç½®â€æŒ‰é’®ï¼ˆç»¿è‰²ï¼‰ã€é€Ÿåº¦æ»‘å—ï¼ˆä»â€œæ…¢â€åˆ°â€œå¿«â€ï¼‰ã€‚


2. **ç®—æ³•å¯åŠ¨**ï¼š  
   - è™šæ‹Ÿæ ¹0é—ªçƒï¼ˆé»„è‰²â†’ç°è‰²â†’é»„è‰²ï¼‰ï¼Œæ’­æ”¾â€œå®â€çš„éŸ³æ•ˆï¼ˆè¡¨ç¤ºå¼€å§‹ï¼‰ã€‚  
   - DFSéå†ï¼šä»0å¼€å§‹ï¼Œé€’å½’è®¿é—®å­èŠ‚ç‚¹ï¼ˆèŠ‚ç‚¹å˜ä¸ºè“è‰²ï¼Œè¡¨ç¤ºæ­£åœ¨å¤„ç†ï¼‰ã€‚ä¾‹å¦‚ï¼Œå¤„ç†èŠ‚ç‚¹2æ—¶ï¼Œå…¶æ‰€æœ‰å­èŠ‚ç‚¹ï¼ˆå¦‚èŠ‚ç‚¹5ã€6ï¼‰å˜ä¸ºæµ…è“è‰²ã€‚


3. **èƒŒåŒ…åˆå¹¶è¿‡ç¨‹**ï¼š  
   - å¤„ç†å­èŠ‚ç‚¹`v`æ—¶ï¼Œ`dp[u][j]`çš„æ•°å€¼ç”¨åƒç´ å—è¡¨ç¤ºï¼ˆæ•°å€¼è¶Šå¤§ï¼Œå—è¶Šäº®ï¼‰ã€‚ä¾‹å¦‚ï¼Œ`dp[2][3]`çš„æ•°å€¼ä»0å˜ä¸º5ï¼ˆå‡è®¾å­¦åˆ†å’Œä¸º5ï¼‰ï¼Œå—ä»é»‘è‰²å˜ä¸ºç»¿è‰²ã€‚  
   - å€’åºå¾ªç¯æ—¶ï¼Œå—çš„é¢œè‰²ä»çº¢å˜ç»¿ï¼Œè¡¨ç¤ºæ›´æ–°å®Œæˆï¼ˆå¦‚`j`ä»`m+1`åˆ°`1`ï¼Œå—çš„é¢œè‰²é€æ¸å˜äº®ï¼‰ã€‚


4. **ç»“æœå±•ç¤º**ï¼š  
   - æœ€ç»ˆé€‰ä¸­çš„è¯¾ç¨‹ï¼ˆ`dp[0][m+1]`å¯¹åº”çš„èŠ‚ç‚¹ï¼‰å˜ä¸ºé»„è‰²ï¼Œæ’­æ”¾â€œèƒœåˆ©â€éŸ³æ•ˆï¼ˆå¦‚FCæ¸¸æˆçš„é€šå…³å£°ï¼‰ã€‚  
   - å±å¹•å³ä¾§çš„`dp[0][m+1]`æ•°å€¼å˜ä¸ºæœ€å¤§ï¼ˆå¦‚æ ·ä¾‹ä¸­çš„13ï¼‰ï¼Œç”¨å¤§åƒç´ å­—æ˜¾ç¤ºï¼ŒèƒŒæ™¯é—ªçƒå½©è™¹è‰²ã€‚


### äº¤äº’ä¸æ¸¸æˆåŒ–å…ƒç´ 
- **å•æ­¥æ‰§è¡Œ**ï¼šç‚¹å‡»â€œå•æ­¥â€æŒ‰é’®ï¼Œç®—æ³•æ‰§è¡Œä¸€æ­¥ï¼ˆå¦‚å¤„ç†ä¸€ä¸ªå­èŠ‚ç‚¹ï¼Œæˆ–æ›´æ–°ä¸€ä¸ª`dp`å€¼ï¼‰ï¼ŒèŠ‚ç‚¹é¢œè‰²å˜åŒ–ï¼Œæ’­æ”¾â€œæ»´ç­”â€éŸ³æ•ˆã€‚  
- **è‡ªåŠ¨æ’­æ”¾**ï¼šæ‹–åŠ¨æ»‘å—è°ƒæ•´é€Ÿåº¦ï¼ˆæ…¢ï¼š1ç§’/æ­¥ï¼›å¿«ï¼š0.1ç§’/æ­¥ï¼‰ï¼Œç®—æ³•è‡ªåŠ¨æ‰§è¡Œï¼ŒèŠ‚ç‚¹é¢œè‰²è¿ç»­å˜åŒ–ï¼ŒéŸ³æ•ˆè¿ç»­æ’­æ”¾ã€‚  
- **é‡ç½®**ï¼šç‚¹å‡»â€œé‡ç½®â€æŒ‰é’®ï¼Œå›åˆ°åˆå§‹çŠ¶æ€ï¼ˆèŠ‚ç‚¹ç°è‰²ï¼Œ`dp`å€¼ä¸º0ï¼‰ï¼Œæ’­æ”¾â€œé‡ç½®â€éŸ³æ•ˆï¼ˆå¦‚â€œå’»â€çš„å£°éŸ³ï¼‰ã€‚  
- **æ¸¸æˆåŒ–å¥–åŠ±**ï¼šå®Œæˆä¸€æ¬¡ç®—æ³•æ‰§è¡Œï¼ˆæ‰¾åˆ°æœ€å¤§å­¦åˆ†ï¼‰ï¼Œå±å¹•ä¸‹æ–¹å¼¹å‡ºâ€œé€šå…³ï¼â€çš„åƒç´ æ–‡å­—ï¼Œæ’­æ”¾â€œæ¬¢å‘¼â€éŸ³æ•ˆï¼ŒåŒæ—¶ç§¯åˆ†+1ï¼ˆç§¯åˆ†æ˜¾ç¤ºåœ¨å±å¹•å³ä¸Šè§’ï¼‰ã€‚


### æŠ€æœ¯å®ç°è€ƒé‡
- **åƒç´ é£æ ¼**ï¼šç”¨HTML5 Canvasç»˜åˆ¶8x8çš„åƒç´ å—ï¼Œé¢œè‰²ä½¿ç”¨FCæ¸¸æˆçš„ç»å…¸ paletteï¼ˆå¦‚#000000ã€#0000FFã€#00FF00ã€#FFFF00ï¼‰ã€‚  
- **éŸ³æ•ˆ**ï¼šç”¨Web Audio APIæ’­æ”¾8ä½éŸ³æ•ˆï¼ˆå¦‚`beep`å£°ã€`blip`å£°ï¼‰ï¼Œå…³é”®æ“ä½œï¼ˆå¦‚é€‰ä¸­èŠ‚ç‚¹ã€æ›´æ–°`dp`å€¼ï¼‰è§¦å‘å¯¹åº”éŸ³æ•ˆã€‚  
- **è½»é‡åŒ–**ï¼šçº¯HTML/CSS/JavaScriptå®ç°ï¼Œå•æ–‡ä»¶ï¼Œå¯æœ¬åœ°è¿è¡Œæˆ–æµè§ˆå™¨æŸ¥çœ‹ã€‚


## 6. æ‹“å±•ç»ƒä¹ ä¸ç›¸ä¼¼é—®é¢˜æ€è€ƒ

### é€šç”¨æ€è·¯/æŠ€å·§è¿ç§»
æ ‘å½¢DP+èƒŒåŒ…çš„æ€è·¯ï¼Œå¯ç”¨äºè§£å†³**æœ‰ä¾èµ–å…³ç³»çš„é€‰æ‹©é—®é¢˜**ï¼Œä¾‹å¦‚ï¼š  
1. **æœºå™¨åˆ†é…**ï¼ˆP2409ï¼‰ï¼šæ¯ä¸ªå·¥å‚æœ‰å¤šä¸ªæœºå™¨ï¼Œåˆ†é…æœºå™¨åˆ°å·¥å‚ä»¥è·å¾—æœ€å¤§åˆ©æ¶¦ï¼ˆä¾èµ–å…³ç³»ï¼šå·¥å‚æ˜¯æœºå™¨çš„â€œçˆ¶èŠ‚ç‚¹â€ï¼‰ã€‚  
2. **äºŒå‰è‹¹æœæ ‘**ï¼ˆP2015ï¼‰ï¼šä¸€æ£µäºŒå‰æ ‘ï¼Œä¿ç•™kæ¡è¾¹ï¼Œä½¿å¾—è‹¹æœæ€»æ•°æœ€å¤§ï¼ˆä¾èµ–å…³ç³»ï¼šè¾¹çš„ä¿ç•™ä¾èµ–äºçˆ¶èŠ‚ç‚¹çš„è¾¹ï¼‰ã€‚  
3. **æ²¡æœ‰ä¸Šå¸çš„èˆä¼š**ï¼ˆP1352ï¼‰ï¼šä¸€æ£µæ ‘ä¸Šï¼Œé€‰ä¸€äº›èŠ‚ç‚¹ï¼Œä½¿å¾—æ²¡æœ‰çˆ¶å­å…³ç³»ï¼Œä¸”æƒå€¼å’Œæœ€å¤§ï¼ˆä¾èµ–å…³ç³»ï¼šèŠ‚ç‚¹çš„é€‰æ‹©ä¾èµ–äºçˆ¶èŠ‚ç‚¹çš„é€‰æ‹©ï¼‰ã€‚


### ç»ƒä¹ æ¨èï¼ˆæ´›è°·ï¼‰
1. **æ´›è°· P1352 - æ²¡æœ‰ä¸Šå¸çš„èˆä¼š**  
   ğŸ—£ï¸ **æ¨èç†ç”±**ï¼šè¿™æ˜¯æ ‘å½¢DPçš„å…¥é—¨é¢˜ï¼ŒçŠ¶æ€å®šä¹‰ä¸º`dp[u][0/1]`ï¼ˆä¸é€‰/é€‰uèŠ‚ç‚¹ï¼‰ï¼Œè½¬ç§»ç®€å•ï¼Œé€‚åˆå·©å›ºæ ‘å½¢DPçš„åŸºç¡€ã€‚  
2. **æ´›è°· P2015 - äºŒå‰è‹¹æœæ ‘**  
   ğŸ—£ï¸ **æ¨èç†ç”±**ï¼šè¿™æ˜¯æ ‘å½¢èƒŒåŒ…çš„å˜ç§ï¼ŒçŠ¶æ€å®šä¹‰ä¸º`dp[u][k]`ï¼ˆä»¥uä¸ºæ ¹çš„å­æ ‘ä¿ç•™kæ¡è¾¹çš„æœ€å¤§è‹¹æœæ•°ï¼‰ï¼Œè½¬ç§»ç”¨èƒŒåŒ…åˆå¹¶ï¼Œé€‚åˆç»ƒä¹ æ ‘å½¢èƒŒåŒ…çš„æ€è·¯ã€‚  
3. **æ´›è°· P2409 - æœºå™¨åˆ†é…**  
   ğŸ—£ï¸ **æ¨èç†ç”±**ï¼šè¿™æ˜¯çº¿æ€§DPçš„èƒŒåŒ…é—®é¢˜ï¼Œä½†å¯ä»¥è½¬åŒ–ä¸ºæ ‘å½¢DPï¼ˆæ¯ä¸ªå·¥å‚æ˜¯ä¸€ä¸ªèŠ‚ç‚¹ï¼Œæœºå™¨æ˜¯å­èŠ‚ç‚¹ï¼‰ï¼Œé€‚åˆæ‹“å±•æ ‘å½¢DPçš„åº”ç”¨åœºæ™¯ã€‚  
4. **æ´›è°· P3177 - æ ‘ä¸Šçš„æŸ“è‰²**  
   ğŸ—£ï¸ **æ¨èç†ç”±**ï¼šè¿™æ˜¯æ ‘å½¢DPçš„è¿›é˜¶é¢˜ï¼ŒçŠ¶æ€å®šä¹‰ä¸º`dp[u][k]`ï¼ˆä»¥uä¸ºæ ¹çš„å­æ ‘æŸ“kä¸ªèŠ‚ç‚¹çš„æœ€å¤§ä»·å€¼ï¼‰ï¼Œè½¬ç§»ç”¨èƒŒåŒ…åˆå¹¶ï¼Œé€‚åˆæŒ‘æˆ˜æ›´å¤æ‚çš„æ ‘å½¢DPé—®é¢˜ã€‚


## 7. å­¦ä¹ å¿ƒå¾—ä¸ç»éªŒåˆ†äº«ï¼ˆè‹¥æœ‰ï¼‰
ä»é¢˜è§£ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥å­¦åˆ°ä»¥ä¸‹å®è´µç»éªŒï¼š  
- **è™šæ‹Ÿæ ¹çš„é‡è¦æ€§**ï¼šå¤„ç†æ£®æ—é—®é¢˜æ—¶ï¼Œæ·»åŠ è™šæ‹Ÿæ ¹æ˜¯ç»Ÿä¸€ç»“æ„çš„å…³é”®ï¼Œèƒ½ç®€åŒ–ä»£ç é€»è¾‘ã€‚  
- **å€’åºå¾ªç¯çš„æ„ä¹‰**ï¼šåœ¨èƒŒåŒ…åˆå¹¶æ—¶ï¼Œå€’åºå¾ªç¯èƒ½é¿å…é‡å¤é€‰æ‹©ï¼Œè¿™æ˜¯æ ‘å½¢èƒŒåŒ…çš„æ ¸å¿ƒæŠ€å·§ã€‚  
- **DFSåºä¼˜åŒ–**ï¼šå¯¹äºå¤§æ•°æ®é‡çš„æ ‘å½¢DPé—®é¢˜ï¼ŒDFSåºä¼˜åŒ–èƒ½æ˜¾è‘—é™ä½æ—¶é—´å¤æ‚åº¦ï¼Œæ˜¯è¿›é˜¶çš„å¿…å¤‡æŠ€å·§ã€‚  

ä¾‹å¦‚ï¼ŒHe_Rençš„é¢˜è§£ä¸­æåˆ°â€œ`m++`å¤„ç†è™šæ‹Ÿæ ¹â€ï¼Œè¿™æé†’æˆ‘ä»¬ï¼šåœ¨å¤„ç†æ£®æ—é—®é¢˜æ—¶ï¼Œè™šæ‹Ÿæ ¹æ˜¯â€œæ¡¥æ¢â€ï¼Œèƒ½å°†å¤šä¸ªæ ‘åˆå¹¶ä¸ºä¸€ä¸ªï¼Œä»è€Œç”¨æ ‘å½¢DPç»Ÿä¸€å¤„ç†ã€‚zeroy0410çš„é¢˜è§£ä¸­æåˆ°â€œDFSåºä¼˜åŒ–â€ï¼Œè¿™å‘Šè¯‰æˆ‘ä»¬ï¼šæ ‘å½¢ç»“æ„å¯ä»¥è½¬åŒ–ä¸ºçº¿æ€§ç»“æ„ï¼Œä»è€Œç”¨æ›´é«˜æ•ˆçš„çº¿æ€§DPå¤„ç†ã€‚


## ğŸ“ æ€»ç»“
â€œé€‰è¯¾â€é—®é¢˜æ˜¯æ ‘å½¢DP+èƒŒåŒ…çš„ç»å…¸ä¾‹é¢˜ï¼Œæ ¸å¿ƒæ€è·¯æ˜¯**å°†æ£®æ—è½¬ä¸ºæ ‘ï¼Œç”¨æ ‘å½¢DPåˆå¹¶å­èŠ‚ç‚¹çš„èƒŒåŒ…ç»“æœ**ã€‚é€šè¿‡æœ¬é¢˜çš„å­¦ä¹ ï¼Œæˆ‘ä»¬æŒæ¡äº†æ ‘å½¢DPçš„çŠ¶æ€å®šä¹‰ã€çŠ¶æ€è½¬ç§»ã€è™šæ‹Ÿæ ¹å¤„ç†ç­‰æŠ€å·§ï¼Œè¿™äº›æŠ€å·§å¯ä»¥æ¨å¹¿åˆ°å…¶ä»–æœ‰ä¾èµ–å…³ç³»çš„é€‰æ‹©é—®é¢˜ã€‚  

è®°ä½ï¼šæ ‘å½¢DPçš„å…³é”®æ˜¯â€œè‡ªåº•å‘ä¸Šâ€åˆå¹¶å­èŠ‚ç‚¹çš„ç»“æœï¼Œè€ŒèƒŒåŒ…çš„å…³é”®æ˜¯â€œå€’åºå¾ªç¯â€é¿å…é‡å¤é€‰æ‹©ã€‚å¤šç»ƒä¹ ç±»ä¼¼é—®é¢˜ï¼ˆå¦‚â€œæ²¡æœ‰ä¸Šå¸çš„èˆä¼šâ€â€œäºŒå‰è‹¹æœæ ‘â€ï¼‰ï¼Œèƒ½å¸®åŠ©æˆ‘ä»¬æ›´æ·±åˆ»åœ°ç†è§£è¿™äº›æŠ€å·§ã€‚  

ä¸‹æ¬¡æˆ‘ä»¬å°†æ¢ç´¢æ›´å¤æ‚çš„æ ‘å½¢DPé—®é¢˜ï¼Œæ¯”å¦‚â€œæ ‘ä¸Šçš„æŸ“è‰²â€ï¼Œæ•¬è¯·æœŸå¾…ï¼ğŸ’ª

---
å¤„ç†ç”¨æ—¶ï¼š199.09ç§’
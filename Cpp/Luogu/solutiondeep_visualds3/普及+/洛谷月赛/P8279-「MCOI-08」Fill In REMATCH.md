# é¢˜ç›®ä¿¡æ¯

# ã€ŒMCOI-08ã€Fill In REMATCH

## é¢˜ç›®æè¿°

Dream æœ‰ä¸€ä¸ªé•¿åº¦ä¸º $n$ï¼ˆ$1\le n\le 10^5$ï¼‰çš„æ•´æ•°æ•°ç»„ $a_1,a_2,\dots,a_n$ï¼Œå…¶ä¸­å¯¹äº $i=1,2,\dots,n$ï¼Œæ»¡è¶³ $0\le a_i<2^{60}$ã€‚

ä»–è®¡ç®—äº†å‰ç¼€å¼‚æˆ–æ•°ç»„ $p_i=a_1\oplus a_2\oplus\dots\oplus a_i$ ä»¥åŠåç¼€å¼‚æˆ–æ•°ç»„ $s_i=a_i\oplus a_{i+1}\oplus\dots\oplus a_n$ã€‚

ç°åœ¨ Tommy **ä¸€å…±**å°† $p$ å’Œ $s$ çš„ $n$ ä¸ªå…ƒç´ æ¢æˆ $-1$ã€‚ç»™å®šå½“å‰çš„ $p$ ä¸ $s$ æ•°ç»„ï¼Œè¯·æ¢å¤ä»»æ„ä¸€ç»„å¯èƒ½ä¸ºåŸæ•°ç»„çš„ $a_1,a_2,\dots,a_n$ã€‚

ä¿è¯å­˜åœ¨ä¸€ç»„åˆæ³•è§£ã€‚

## è¯´æ˜/æç¤º

å¯¹äº $100\%$ çš„æ•°æ®ï¼Œ$1\le n,\sum n\le 10^5$ï¼Œ$\sum [p_i=-1]+\sum [s_i=-1]=n$ï¼Œ**ä¿è¯æœ‰åˆæ³•è§£ã€‚**

 - Subtask 1ï¼ˆ10 ptsï¼‰ï¼š$n\le 4$ï¼Œ$p_i,s_i<2$ï¼›
 - Subtask 2ï¼ˆ10 ptsï¼‰ï¼š$n\le 100$ï¼›
 - Subtask 3ï¼ˆ20 ptsï¼‰ï¼š$p_i,s_i<2$ï¼›
 - Subtask 4ï¼ˆ60 ptsï¼‰ï¼šæ— ç‰¹æ®Šé™åˆ¶ã€‚


## æ ·ä¾‹ #1

### è¾“å…¥

```
1
4
-1 34 367 -1
3178 -1 -1 3333```

### è¾“å‡º

```
3 33 333 3333```

# AIåˆ†æç»“æœ

# ğŸ’¡ Kayçš„C++ç®—æ³•è§£æï¼šã€ŒMCOI-08ã€Fill In REMATCH æ·±å…¥å­¦ä¹ æŒ‡å— ğŸ’¡

## å¼•è¨€
ä»Šå¤©æˆ‘ä»¬æ¥åˆ†æã€ŒMCOI-08ã€Fill In REMATCHè¿™é“é¢˜â€”â€”å®ƒåƒä¸€åœºâ€œå¼‚æˆ–æ‹¼å›¾æ¸¸æˆâ€ï¼šç»™å®šè¢«ä¿®æ”¹è¿‡çš„å‰ç¼€å¼‚æˆ–æ•°ç»„`p`å’Œåç¼€å¼‚æˆ–æ•°ç»„`s`ï¼Œéœ€è¦æˆ‘ä»¬ç”¨å¼‚æˆ–çš„â€œé­”æ³•è§„åˆ™â€è¿˜åŸåŸæ•°ç»„`a`ã€‚è¿™é“é¢˜çš„æ ¸å¿ƒæ˜¯**ç†è§£å¼‚æˆ–æ€§è´¨**+**é€»è¾‘æ¨å¯¼**ï¼Œè®©æˆ‘ä»¬ä¸€èµ·æ‹†è§£å®ƒï¼


## 1. é¢˜ç›®è§£è¯»ä¸æ ¸å¿ƒç®—æ³•è¯†åˆ«

âœ¨ **æœ¬é¢˜ä¸»è¦è€ƒå¯Ÿ**ï¼šç¼–ç¨‹æŠ€å·§åº”ç”¨ï¼ˆå¼‚æˆ–æ€§è´¨è¿ç”¨ + é€»è¾‘æ¨å¯¼ï¼‰

ğŸ—£ï¸ **åˆæ­¥åˆ†æ**ï¼š
è§£å†³è¿™é“é¢˜çš„å…³é”®æ˜¯æŒæ¡å¼‚æˆ–çš„ä¸‰ä¸ªâ€œé­”æ³•è§„åˆ™â€ï¼š
1. **å½’é›¶å¾‹**ï¼šåŒä¸€ä¸ªæ•°å¼‚æˆ–è‡ªå·±ç­‰äº0ï¼ˆæ¯”å¦‚ç¯å¼€ä¸¤æ¬¡å°±ç­äº†ï¼‰ï¼›
2. **æ’ç­‰å¾‹**ï¼šä»»ä½•æ•°å¼‚æˆ–0ç­‰äºå®ƒè‡ªå·±ï¼ˆç¯æ²¡å¼€å°±æ˜¯åŸæ¥çš„çŠ¶æ€ï¼‰ï¼›
3. **ç»“åˆå¾‹**ï¼šå¼‚æˆ–çš„é¡ºåºä¸å½±å“ç»“æœï¼ˆå…ˆå¼€Aå†å¼€Bï¼Œå’Œå…ˆå¼€Bå†å¼€Aï¼Œæœ€ç»ˆç¯çš„çŠ¶æ€ä¸€æ ·ï¼‰ã€‚

é¢˜ç›®ä¸­ï¼Œ`p[i]`æ˜¯å‰`i`ä¸ªå…ƒç´ çš„å¼‚æˆ–å’Œï¼ˆ`aâ‚âŠ•aâ‚‚âŠ•â€¦âŠ•aáµ¢`ï¼‰ï¼Œ`s[i]`æ˜¯å`n-i+1`ä¸ªå…ƒç´ çš„å¼‚æˆ–å’Œï¼ˆ`aáµ¢âŠ•aáµ¢â‚Šâ‚âŠ•â€¦âŠ•aâ‚™`ï¼‰ã€‚æˆ‘ä»¬çš„ç›®æ ‡æ˜¯æ ¹æ®è¢«ä¿®æ”¹ä¸º`-1`çš„`p`å’Œ`s`ï¼Œè¿˜åŸåŸæ•°ç»„`a`ã€‚

### æ ¸å¿ƒæ€è·¯
1. **æ‰¾æ€»å¼‚æˆ–å’Œ`sum`**ï¼šæ ¹æ®å¼‚æˆ–æ€§è´¨ï¼Œ`sum = p[i] âŠ• s[i+1]`ï¼ˆå‰`i`ä¸ªå¼‚æˆ–å`n-i`ä¸ªï¼Œç­‰äºå…¨éƒ¨å…ƒç´ çš„å¼‚æˆ–å’Œï¼‰ï¼›
2. **è¡¥å…¨`p`å’Œ`s`**ï¼šç”¨`sum`å¡«è¡¥`-1`â€”â€”è‹¥`p[i]`å·²çŸ¥ï¼Œåˆ™`s[i+1] = sum âŠ• p[i]`ï¼›è‹¥`s[i+1]`å·²çŸ¥ï¼Œåˆ™`p[i] = sum âŠ• s[i+1]`ï¼›è‹¥éƒ½æœªçŸ¥ï¼Œéšä¾¿å¡«ä¸€ä¸ªç®€å•å€¼ï¼ˆæ¯”å¦‚`p[i] = p[i-1]`ï¼Œç›¸å½“äº`a[i]=0`ï¼‰ï¼›
3. **ç”ŸæˆåŸæ•°ç»„`a`**ï¼šåˆ©ç”¨å‰ç¼€å¼‚æˆ–çš„æ€§è´¨ï¼Œ`a[i] = p[i] âŠ• p[i-1]`ï¼ˆå‰`i`ä¸ªå¼‚æˆ–å‰`i-1`ä¸ªï¼Œå‰©ä¸‹çš„å°±æ˜¯ç¬¬`i`ä¸ªå…ƒç´ ï¼‰ã€‚

### æ ¸å¿ƒéš¾ç‚¹ä¸è§£å†³æ–¹æ¡ˆ
- **å¦‚ä½•ç¡®å®š`sum`ï¼Ÿ**ï¼šé¢˜ç›®è¯´`-1`çš„æ€»æ•°æ˜¯`n`ï¼Œè€Œ`p`å’Œ`s`å…±æœ‰`n+1`å¯¹ï¼ˆ`pâ‚€`ä¸`sâ‚`ã€`pâ‚`ä¸`sâ‚‚`â€¦â€¦`pâ‚™`ä¸`sâ‚™â‚Šâ‚`ï¼‰ã€‚æ ¹æ®**é¸½å·¢åŸç†**ï¼Œ`n+1`å¯¹ä¸­æ”¾`n`ä¸ª`-1`ï¼Œå¿…ç„¶æœ‰ä¸€å¯¹ä¸¤ä¸ªéƒ½æ˜¯å·²çŸ¥çš„ï¼Œè¿™å¯¹çš„å¼‚æˆ–ç»“æœå°±æ˜¯`sum`ã€‚
- **å¦‚ä½•å¤„ç†éƒ½æœªçŸ¥çš„`p[i]`å’Œ`s[i+1]`ï¼Ÿ**ï¼šé€‰æœ€ç®€å•çš„æ–¹å¼å¡«å……ï¼ˆæ¯”å¦‚`p[i] = p[i-1]`ï¼‰ï¼Œè¿™æ ·`a[i] = 0`ï¼Œä¸å½±å“å…¶ä»–é¡¹çš„æ­£ç¡®æ€§ã€‚

### å¯è§†åŒ–è®¾è®¡æ€è·¯
æˆ‘ä»¬ç”¨**8ä½åƒç´ é£æ ¼åŠ¨ç”»**æ¨¡æ‹Ÿæ•´ä¸ªè¿‡ç¨‹ï¼š
- **åœºæ™¯å¸ƒå±€**ï¼šä¸Šæ’æ˜¯`p`æ•°ç»„ï¼ˆè“è‰²ï¼‰ã€ä¸‹æ’æ˜¯`s`æ•°ç»„ï¼ˆç»¿è‰²ï¼‰ã€ä¸­é—´æ˜¯`a`æ•°ç»„ï¼ˆçº¢è‰²ï¼‰ï¼ŒæœªçŸ¥å…ƒç´ ï¼ˆ`-1`ï¼‰æ˜¯ç°è‰²ï¼›
- **å…³é”®æ­¥éª¤**ï¼š
  1. æ‰¾`sum`ï¼šåƒç´ â€œæ¢é™©å®¶â€éå†`p`å’Œ`s`ï¼Œæ‰¾åˆ°éƒ½é`-1`çš„å¯¹æ—¶ï¼Œå—é—ªçƒé»„è‰²ï¼Œä¼´éšâ€œå®â€çš„éŸ³æ•ˆï¼›
  2. è¡¥å…¨æ•°ç»„ï¼šå¡«å……çš„å—å˜æˆå½©è‰²ï¼Œä¼´éšâ€œå’”å—’â€å£°ï¼›
  3. ç”Ÿæˆ`a`ï¼š`a`æ•°ç»„å—å˜çº¢ï¼Œä¼´éšâ€œå™—â€çš„å£°æ•ˆï¼›
- **äº¤äº’**ï¼šæ”¯æŒâ€œå•æ­¥æ‰§è¡Œâ€â€œè‡ªåŠ¨æ’­æ”¾â€â€œé‡ç½®â€ï¼Œé€Ÿåº¦æ»‘å—è°ƒèŠ‚æ’­æ”¾é€Ÿåº¦ã€‚


## 2. ç²¾é€‰ä¼˜è´¨é¢˜è§£å‚è€ƒ

ä¸ºå¤§å®¶ç­›é€‰äº†3ä»½**æ€è·¯æ¸…æ™°ã€ä»£ç ä¸¥è°¨**çš„ä¼˜è´¨é¢˜è§£ï¼š

### é¢˜è§£ä¸€ï¼šä½œè€…Anxiomgh
* **ç‚¹è¯„**ï¼šè¿™ä»½é¢˜è§£çš„äº®ç‚¹æ˜¯**é€»è¾‘ä¸¥è°¨**â€”â€”ä¸ä»…åˆ—å‡ºå¼‚æˆ–æ€§è´¨ï¼Œè¿˜é€šè¿‡**å¼•ç†3**è¯æ˜äº†`sum`å¿…ç„¶å­˜åœ¨ï¼ˆåè¯æ³•ï¼šè‹¥æ‰€æœ‰å¯¹éƒ½æœ‰`-1`ï¼Œåˆ™`-1`æ€»æ•°æ˜¯`n+1`ï¼Œä¸é¢˜ç›®çŸ›ç›¾ï¼‰ã€‚ä»£ç ç»“æ„æ¸…æ™°ï¼Œç”¨`find`å‡½æ•°æ‰¾`sum`ï¼Œ`update`å‡½æ•°è¡¥å…¨æ•°ç»„ï¼Œæœ€åç”¨`p`ç”Ÿæˆ`a`ã€‚å˜é‡å‘½åç›´è§‚ï¼ˆæ¯”å¦‚`sum`è¡¨ç¤ºæ€»å¼‚æˆ–å’Œï¼‰ï¼Œè¾¹ç•Œå¤„ç†ä¸¥è°¨ï¼ˆ`pâ‚€=0`ã€`sâ‚™â‚Šâ‚=0`ï¼‰ã€‚**å€¼å¾—å­¦ä¹ çš„æ˜¯â€œæ‹†è§£é—®é¢˜â€çš„æ€è·¯**ï¼šå°†å¤æ‚é—®é¢˜æ‹†æˆâ€œæ‰¾sumâ†’è¡¥æ•°ç»„â†’ç”Ÿæˆç­”æ¡ˆâ€ä¸‰ä¸ªå°æ­¥éª¤ï¼Œæ¯ä¸€æ­¥éƒ½æœ‰æ˜ç¡®ç›®æ ‡ã€‚

### é¢˜è§£äºŒï¼šä½œè€…Otomachi_Una_
* **ç‚¹è¯„**ï¼šæ­¤é¢˜è§£çš„äº®ç‚¹æ˜¯**ä»£ç ç®€æ´**â€”â€”ç›´æ¥éå†æ‰¾`sum`ï¼Œå†è¡¥å…¨`p`å’Œ`s`ï¼Œæœ€åç”Ÿæˆ`a`ã€‚å°¤å…¶é€‚åˆå­¦ä¹ **å¤šè§£é—®é¢˜çš„ç®€åŒ–å¤„ç†**ï¼šæœªçŸ¥é‡ç›´æ¥å¡«`0`ï¼Œå› ä¸ºé¢˜ç›®å…è®¸ä»»æ„è§£ï¼Œè¿™æ ·èƒ½å¤§å¤§å‡å°‘ä»£ç é‡ã€‚

### é¢˜è§£ä¸‰ï¼šä½œè€…GIå½•åƒæœº
* **ç‚¹è¯„**ï¼šè¿™ä»½é¢˜è§£çš„ç‹¬ç‰¹ä¹‹å¤„æ˜¯**è½¬åŒ–é—®é¢˜è§†è§’**â€”â€”å°†åç¼€æ•°ç»„`s`è½¬åŒ–ä¸ºå‰ç¼€æ•°ç»„`p`ï¼ˆ`s[i] = sum âŠ• p[i-1]`ï¼‰ï¼Œè¿™æ ·å°±æŠŠé—®é¢˜ç®€åŒ–ä¸ºâ€œåªå¤„ç†å‰ç¼€æ•°ç»„â€ï¼Œåˆ©ç”¨å·²æœ‰çš„å‰ç¼€å¤„ç†ç»éªŒè§£å†³é—®é¢˜ã€‚ä»£ç ä¸­çš„`read`å’Œ`write`å‡½æ•°æ˜¯ç«èµ›å¸¸ç”¨çš„**å¿«é€Ÿè¾“å…¥è¾“å‡ºæŠ€å·§**ï¼Œå€¼å¾—å­¦ä¹ ã€‚


## 3. æ ¸å¿ƒéš¾ç‚¹è¾¨æä¸è§£é¢˜ç­–ç•¥

ç»“åˆä¼˜è´¨é¢˜è§£ï¼Œæ€»ç»“3ä¸ªå…³é”®éš¾ç‚¹åŠåº”å¯¹ç­–ç•¥ï¼š

### 1. éš¾ç‚¹1ï¼šå¦‚ä½•ç¡®å®šæ€»å¼‚æˆ–å’Œ`sum`ï¼Ÿ
- **åˆ†æ**ï¼šé¢˜ç›®ä¸­`-1`æ€»æ•°æ˜¯`n`ï¼Œè€Œ`p`å’Œ`s`æœ‰`n+1`å¯¹ï¼ˆ`pâ‚€`ä¸`sâ‚`åˆ°`pâ‚™`ä¸`sâ‚™â‚Šâ‚`ï¼‰ã€‚æ ¹æ®é¸½å·¢åŸç†ï¼Œå¿…ç„¶æœ‰ä¸€å¯¹ä¸¤ä¸ªéƒ½æ˜¯å·²çŸ¥çš„ï¼Œè¿™å¯¹çš„å¼‚æˆ–ç»“æœå°±æ˜¯`sum`ã€‚
- ğŸ’¡ å­¦ä¹ ç¬”è®°ï¼š**é¢˜ç›®ä¸­çš„çº¦æŸæ¡ä»¶æ˜¯è§£é¢˜å…³é”®**ï¼Œä¸è¦å¿½ç•¥â€œ`-1`æ€»æ•°ä¸º`n`â€è¿™ä¸ªéšè—æ¡ä»¶ã€‚

### 2. éš¾ç‚¹2ï¼šå¦‚ä½•è¡¥å…¨`p`å’Œ`s`ä¸­çš„`-1`ï¼Ÿ
- **åˆ†æ**ï¼šæ ¹æ®`sum = p[i] âŠ• s[i+1]`ï¼Œè‹¥å…¶ä¸­ä¸€ä¸ªå·²çŸ¥ï¼Œå¦ä¸€ä¸ªç”¨`sum`å¼‚æˆ–å·²çŸ¥çš„å¾—åˆ°ï¼›è‹¥éƒ½æœªçŸ¥ï¼Œå¡«ä¸€ä¸ªç®€å•å€¼ï¼ˆæ¯”å¦‚`p[i] = p[i-1]`ï¼‰ï¼Œè¿™æ ·`a[i] = 0`ï¼Œä¸å½±å“æ­£ç¡®æ€§ã€‚
- ğŸ’¡ å­¦ä¹ ç¬”è®°ï¼š**å¤šè§£é—®é¢˜é€‰æœ€ç®€å•çš„æ„é€ æ–¹å¼**ï¼Œæ¯”å¦‚å¡«`0`æˆ–å‰ä¸€ä¸ªå€¼ï¼Œèƒ½ç®€åŒ–ä»£ç ã€‚

### 3. éš¾ç‚¹3ï¼šå¦‚ä½•ä»`p`æˆ–`s`å¾—åˆ°åŸæ•°ç»„`a`ï¼Ÿ
- **åˆ†æ**ï¼šå‰ç¼€å¼‚æˆ–çš„æ€§è´¨æ˜¯`p[i] = p[i-1] âŠ• a[i]`ï¼Œæ‰€ä»¥`a[i] = p[i] âŠ• p[i-1]`ï¼ˆå‰`i`ä¸ªå¼‚æˆ–å‰`i-1`ä¸ªï¼Œå‰©ä¸‹çš„å°±æ˜¯ç¬¬`i`ä¸ªå…ƒç´ ï¼‰ã€‚åŒç†ï¼Œ`s[i] = a[i] âŠ• s[i+1]`ï¼Œæ‰€ä»¥`a[i] = s[i] âŠ• s[i+1]`ã€‚
- ğŸ’¡ å­¦ä¹ ç¬”è®°ï¼š**ç‰¢è®°å‰ç¼€/åç¼€å¼‚æˆ–ä¸åŸæ•°ç»„çš„å…³ç³»**ï¼Œè¿™æ˜¯è¿˜åŸåŸæ•°ç»„çš„å…³é”®ã€‚

### âœ¨ è§£é¢˜æŠ€å·§æ€»ç»“
- **æŠ€å·§1**ï¼šåˆ©ç”¨å¼‚æˆ–æ€§è´¨ç®€åŒ–é—®é¢˜ï¼ˆå½’é›¶å¾‹ã€æ’ç­‰å¾‹ã€ç»“åˆå¾‹ï¼‰ï¼›
- **æŠ€å·§2**ï¼šæ‹†è§£é—®é¢˜ä¸ºå°æ­¥éª¤ï¼ˆæ‰¾sumâ†’è¡¥æ•°ç»„â†’ç”Ÿæˆaï¼‰ï¼›
- **æŠ€å·§3**ï¼šå¤„ç†è¾¹ç•Œæ¡ä»¶ï¼ˆ`pâ‚€=0`ã€`sâ‚™â‚Šâ‚=0`æ˜¯éšè—çš„å…³é”®æ¡ä»¶ï¼‰ã€‚


## 4. C++æ ¸å¿ƒä»£ç å®ç°èµæ

### æœ¬é¢˜é€šç”¨æ ¸å¿ƒC++å®ç°å‚è€ƒ
* **è¯´æ˜**ï¼šç»¼åˆAnxiomghé¢˜è§£çš„æ€è·¯ï¼Œæç‚¼å‡ºçš„æ¸…æ™°ã€å®Œæ•´çš„æ ¸å¿ƒå®ç°ï¼ŒåŒ…å«æ‰¾`sum`ã€è¡¥æ•°ç»„ã€ç”Ÿæˆ`a`çš„å…¨éƒ¨é€»è¾‘ã€‚
* **å®Œæ•´æ ¸å¿ƒä»£ç **ï¼š
```cpp
#include <iostream>
using namespace std;
typedef long long ll; // a_iå¯è¾¾2^60ï¼Œå¿…é¡»ç”¨long long

const int MAXN = 1e5 + 10;
ll p[MAXN], s[MAXN]; // p:å‰ç¼€å¼‚æˆ–æ•°ç»„ï¼Œs:åç¼€å¼‚æˆ–æ•°ç»„

ll find_sum(int n) {
    // æ‰¾sumï¼šéå†æ‰€æœ‰iï¼ˆ0<=i<=nï¼‰ï¼Œæ‰¾åˆ°p[i]å’Œs[i+1]éƒ½é-1çš„æƒ…å†µ
    for (int i = 0; i <= n; ++i) {
        if (p[i] != -1 && s[i+1] != -1) {
            return p[i] ^ s[i+1];
        }
    }
    return 0; // é¢˜ç›®ä¿è¯æœ‰è§£ï¼Œä¸ä¼šèµ°åˆ°è¿™é‡Œ
}

void update_ps(ll sum, int n) {
    // è¡¥å…¨på’Œsæ•°ç»„
    for (int i = 0; i <= n; ++i) {
        if (p[i] != -1 && s[i+1] == -1) {
            s[i+1] = sum ^ p[i];
        } else if (p[i] == -1 && s[i+1] != -1) {
            p[i] = sum ^ s[i+1];
        } else if (p[i] == -1 && s[i+1] == -1) {
            // éƒ½æœªçŸ¥ï¼Œè®¾p[i] = p[i-1]ï¼ˆa[i] = 0ï¼‰
            p[i] = p[i-1];
            s[i+1] = sum ^ p[i];
        }
    }
}

int main() {
    ios::sync_with_stdio(false); // åŠ é€Ÿè¾“å…¥è¾“å‡º
    cin.tie(nullptr);
    
    int T;
    cin >> T;
    while (T--) {
        int n;
        cin >> n;
        // åˆå§‹åŒ–è¾¹ç•Œæ¡ä»¶ï¼šp[0] = 0ï¼Œs[n+1] = 0
        p[0] = 0;
        s[n+1] = 0;
        for (int i = 1; i <= n; ++i) {
            cin >> p[i];
        }
        for (int i = 1; i <= n; ++i) {
            cin >> s[i];
        }
        
        ll sum = find_sum(n); // æ‰¾æ€»å¼‚æˆ–å’Œ
        update_ps(sum, n);    // è¡¥å…¨på’Œs
        
        // ç”ŸæˆåŸæ•°ç»„aå¹¶è¾“å‡ºï¼ša[i] = p[i] ^ p[i-1]
        for (int i = 1; i <= n; ++i) {
            cout << (p[i] ^ p[i-1]) << " ";
        }
        cout << endl;
    }
    return 0;
}
```
* **ä»£ç è§£è¯»æ¦‚è¦**ï¼š
  1. **è¾“å…¥å¤„ç†**ï¼šè¯»å–æµ‹è¯•ç”¨ä¾‹æ•°`T`ï¼Œæ¯ä¸ªç”¨ä¾‹è¯»å–`n`ã€`p[1..n]`ã€`s[1..n]`ï¼Œå¹¶åˆå§‹åŒ–`p[0]=0`ã€`s[n+1]=0`ï¼ˆå…³é”®è¾¹ç•Œï¼‰ï¼›
  2. **æ‰¾`sum`**ï¼šè°ƒç”¨`find_sum`éå†æ‰€æœ‰`i`ï¼Œæ‰¾åˆ°éƒ½é`-1`çš„å¯¹ï¼Œè¿”å›`sum`ï¼›
  3. **è¡¥å…¨æ•°ç»„**ï¼šè°ƒç”¨`update_ps`ç”¨`sum`å¡«è¡¥`-1`ï¼›
  4. **ç”Ÿæˆ`a`**ï¼šéå†`i`ä»1åˆ°`n`ï¼Œè®¡ç®—`a[i] = p[i] ^ p[i-1]`å¹¶è¾“å‡ºã€‚

---

### é’ˆå¯¹å„ä¼˜è´¨é¢˜è§£çš„ç‰‡æ®µèµæ

#### é¢˜è§£ä¸€ï¼šä½œè€…Anxiomgh
* **äº®ç‚¹**ï¼šé€»è¾‘ä¸¥è°¨ï¼Œç”¨å‡½æ•°å°è£…å…³é”®æ­¥éª¤ï¼Œå¯è¯»æ€§é«˜ã€‚
* **æ ¸å¿ƒä»£ç ç‰‡æ®µ**ï¼š
```cpp
ll find(int n) {
    for (int i = 0; i <= n; i++)
        if (p[i] != -1 && s[i + 1] != -1)
            return p[i] ^ s[i + 1];
}

void update(ll val, int n) {
    for (int i = 0; i <= n; i++) {
        if (p[i] != -1 && s[i + 1] == -1) 
            s[i + 1] = val ^ p[i];
        else if (p[i] == -1 && s[i + 1] != -1) 
            p[i] = val ^ s[i + 1];
        else if (p[i] == -1 && s[i + 1] == -1) {
            p[i] = p[i - 1];
            s[i + 1] = val ^ p[i];
        }
    }
}
```
* **ä»£ç è§£è¯»**ï¼š
  - `find`å‡½æ•°ï¼šéå†`i`ä»0åˆ°`n`ï¼Œæ‰¾åˆ°éƒ½é`-1`çš„å¯¹ï¼Œè¿”å›`sum`ï¼ˆ`p[i] ^ s[i+1]`ï¼‰ï¼›
  - `update`å‡½æ•°ï¼šåˆ†ä¸‰ç§æƒ…å†µè¡¥å…¨æ•°ç»„ï¼š
    1. `p[i]`å·²çŸ¥ï¼Œ`s[i+1]`æœªçŸ¥ï¼š`s[i+1] = sum ^ p[i]`ï¼›
    2. `p[i]`æœªçŸ¥ï¼Œ`s[i+1]`å·²çŸ¥ï¼š`p[i] = sum ^ s[i+1]`ï¼›
    3. éƒ½æœªçŸ¥ï¼š`p[i] = p[i-1]`ï¼ˆ`a[i] = 0`ï¼‰ï¼Œå†è®¡ç®—`s[i+1]`ã€‚
* ğŸ’¡ å­¦ä¹ ç¬”è®°ï¼š**ç”¨å‡½æ•°å°è£…é‡å¤é€»è¾‘**ï¼Œè®©ä¸»å‡½æ•°æ›´ç®€æ´ï¼Œæ–¹ä¾¿è°ƒè¯•ã€‚

#### é¢˜è§£äºŒï¼šä½œè€…Otomachi_Una_
* **äº®ç‚¹**ï¼šä»£ç ç®€æ´ï¼Œç›´æ¥éå†å®Œæˆæ‰€æœ‰æ“ä½œã€‚
* **æ ¸å¿ƒä»£ç ç‰‡æ®µ**ï¼š
```cpp
ll xx = -1;
for (int i = 0; i <= n; i++) if (s[i] != -1 && t[i+1] != -1) xx = s[i] ^ t[i+1];
if (xx == -1) xx = 0;

for (int i = 0; i <= n; i++) {
    if (s[i] != -1) t[i+1] = xx ^ s[i];
    else if (t[i+1] != -1) s[i] = xx ^ t[i+1];
    else s[i] = 0, t[i+1] = xx;
}
```
* **ä»£ç è§£è¯»**ï¼š
  - ç¬¬ä¸€éƒ¨åˆ†ï¼šæ‰¾`sum`ï¼ˆå˜é‡`xx`ï¼‰ï¼Œéå†`i`ä»0åˆ°`n`ï¼Œæ‰¾åˆ°éƒ½é`-1`çš„å¯¹ï¼›
  - ç¬¬äºŒéƒ¨åˆ†ï¼šè¡¥å…¨æ•°ç»„ï¼ŒæœªçŸ¥é‡ç›´æ¥å¡«`0`ï¼Œç®€åŒ–ä»£ç ã€‚
* ğŸ’¡ å­¦ä¹ ç¬”è®°ï¼š**å¤šè§£é—®é¢˜é€‰æœ€ç®€å•çš„å¡«å……æ–¹å¼**ï¼Œæ¯”å¦‚å¡«`0`ï¼Œèƒ½å‡å°‘ä»£ç é‡ã€‚

#### é¢˜è§£ä¸‰ï¼šä½œè€…GIå½•åƒæœº
* **äº®ç‚¹**ï¼šå°†åç¼€æ•°ç»„è½¬åŒ–ä¸ºå‰ç¼€æ•°ç»„ï¼Œç®€åŒ–æ€è€ƒã€‚
* **æ ¸å¿ƒä»£ç ç‰‡æ®µ**ï¼š
```cpp
// æ‰¾åˆ°sumï¼ˆp1[n]ï¼‰
for (int i = 1; i <= n; i++) {
    p2[i] = read();
    if (p2[i] != -1 && p1[i - 1] != -1) p1[n] = p2[i] ^ p1[i - 1];
}
// åç¼€è½¬å‰ç¼€ï¼šs[i] = sum ^ p[i-1] â†’ p[i-1] = sum ^ s[i]
for (int i = 1; i <= n; i++) {
    if (p2[i] == -1) continue;
    p1[i - 1] = p2[i] ^ p1[n];
}
```
* **ä»£ç è§£è¯»**ï¼š
  - ç¬¬ä¸€éƒ¨åˆ†ï¼šè¯»å–`s`æ•°ç»„ï¼ˆ`p2`ï¼‰æ—¶ï¼Œè®¡ç®—`sum`ï¼ˆ`p1[n]`ï¼‰ï¼›
  - ç¬¬äºŒéƒ¨åˆ†ï¼šå°†`s`æ•°ç»„çš„å·²çŸ¥é¡¹è½¬åŒ–ä¸º`p`æ•°ç»„çš„å·²çŸ¥é¡¹ï¼Œç®€åŒ–åç»­å¤„ç†ã€‚
* ğŸ’¡ å­¦ä¹ ç¬”è®°ï¼š**è½¬åŒ–é—®é¢˜è§†è§’**ï¼Œå°†åç¼€é—®é¢˜è½¬åŒ–ä¸ºå‰ç¼€é—®é¢˜ï¼Œåˆ©ç”¨å·²æœ‰ç»éªŒè§£å†³ã€‚


## 5. ç®—æ³•å¯è§†åŒ–ï¼šåƒç´ åŠ¨ç”»æ¼”ç¤º (æ ¸å¿ƒéƒ¨åˆ†)

### åŠ¨ç”»æ¼”ç¤ºä¸»é¢˜ï¼šåƒç´ å¼‚æˆ–æ¢é™©å®¶
æˆ‘ä»¬è®¾è®¡ä¸€ä¸ª**8ä½åƒç´ é£æ ¼**çš„åŠ¨ç”»ï¼Œæ¨¡æ‹Ÿâ€œæ¢é™©å®¶â€è¡¥å…¨æ•°ç»„çš„è¿‡ç¨‹ï¼Œèå…¥å¤å¤æ¸¸æˆå…ƒç´ ï¼Œè®©å­¦ä¹ æ›´æœ‰è¶£ï¼

### æ ¸å¿ƒè®¾è®¡ç»†èŠ‚
#### 1. åœºæ™¯å¸ƒå±€
- **ä¸‰è¡Œåƒç´ å—**ï¼šä¸Šæ’æ˜¯`p`æ•°ç»„ï¼ˆè“è‰²ï¼‰ã€ä¸‹æ’æ˜¯`s`æ•°ç»„ï¼ˆç»¿è‰²ï¼‰ã€ä¸­é—´æ˜¯`a`æ•°ç»„ï¼ˆçº¢è‰²ï¼‰ï¼›
- **é¢œè‰²è§„åˆ™**ï¼šå·²çŸ¥å…ƒç´ å½©è‰²ï¼ŒæœªçŸ¥ï¼ˆ`-1`ï¼‰ç°è‰²ï¼Œå½“å‰å¤„ç†çš„å…ƒç´ é—ªçƒé»„è‰²ï¼›
- **æ§åˆ¶é¢æ¿**ï¼šâ€œå•æ­¥â€â€œè‡ªåŠ¨â€â€œé‡ç½®â€æŒ‰é’®ï¼Œé€Ÿåº¦æ»‘å—ï¼ˆæ…¢â†’å¿«ï¼‰ã€‚

#### 2. åŠ¨ç”»æ­¥éª¤
1. **åˆå§‹åŒ–**ï¼š`p[0]=0`ï¼ˆè“è‰²ï¼‰ã€`s[n+1]=0`ï¼ˆç»¿è‰²ï¼‰ï¼Œå…¶ä»–å…ƒç´ ç°è‰²ï¼Œæ’­æ”¾8ä½è½»å¿«BGMï¼›
2. **æ‰¾sum**ï¼šåƒç´ â€œæ¢é™©å®¶â€éå†`p`å’Œ`s`ï¼Œæ‰¾åˆ°éƒ½é`-1`çš„å¯¹æ—¶ï¼Œå—é—ªçƒé»„è‰²ï¼Œå¼¹å‡ºâ€œsum = Xâ€çš„åƒç´ æ–‡å­—ï¼Œä¼´éšâ€œå®â€çš„éŸ³æ•ˆï¼›
3. **è¡¥å…¨æ•°ç»„**ï¼šæ¢é™©å®¶éå†æ¯ä¸ª`i`ï¼Œå¡«å……çš„å—å˜æˆå½©è‰²ï¼Œä¼´éšâ€œå’”å—’â€å£°ï¼›
4. **ç”Ÿæˆa**ï¼šæ¢é™©å®¶éå†`i`ä»1åˆ°`n`ï¼Œ`a`æ•°ç»„å—å˜çº¢ï¼Œä¼´éšâ€œå™—â€çš„å£°æ•ˆï¼›
5. **å®Œæˆ**ï¼šæ‰€æœ‰å—å½©è‰²ï¼Œå±å¹•ä¸­å¤®æ˜¾ç¤ºâ€œå®Œæˆï¼â€ï¼Œæ’­æ”¾èƒœåˆ©æ›²ï¼Œæç¤ºâ€œç‚¹å‡»é‡ç½®å†ç©ä¸€æ¬¡â€ã€‚

#### 3. è®¾è®¡æ€è·¯
- **åƒç´ é£æ ¼**ï¼šæ¨¡æ‹ŸFCçº¢ç™½æœºç”»é¢ï¼Œé™ä½å­¦ä¹ å‹åŠ›ï¼›
- **è§’è‰²å¼•å¯¼**ï¼šç”¨æ¢é™©å®¶è§’è‰²æ˜ç¡®å½“å‰æ­¥éª¤ï¼Œé¿å…è§†çº¿æ··ä¹±ï¼›
- **éŸ³æ•ˆåé¦ˆ**ï¼šä¸åŒéŸ³æ•ˆå¼ºåŒ–å…³é”®æ“ä½œï¼Œå¸®åŠ©è®°å¿†ï¼›
- **äº¤äº’æ§åˆ¶**ï¼šè®©å­¦ä¹ è€…è‡ªä¸»è°ƒèŠ‚é€Ÿåº¦ï¼Œä»”ç»†è§‚å¯Ÿæ¯ä¸€æ­¥ã€‚


## 6. æ‹“å±•ç»ƒä¹ ä¸ç›¸ä¼¼é—®é¢˜æ€è€ƒ

### é€šç”¨æ€è·¯/æŠ€å·§è¿ç§»
æœ¬é¢˜çš„æ ¸å¿ƒæŠ€å·§æ˜¯**åˆ©ç”¨å¼‚æˆ–æ€§è´¨å¤„ç†å‰ç¼€/åç¼€æ•°ç»„**ï¼Œå¯è¿ç§»åˆ°ä»¥ä¸‹åœºæ™¯ï¼š
1. **å¯»æ‰¾ç¼ºå¤±çš„æ•°**ï¼šç»™å®š1åˆ°`n`çš„æ•°ï¼Œå…¶ä¸­ä¸€ä¸ªç¼ºå¤±ï¼Œç”¨å¼‚æˆ–å¿«é€Ÿæ‰¾åˆ°ï¼ˆå¼‚æˆ–æ‰€æœ‰æ•°å’Œ1åˆ°`n`çš„å¼‚æˆ–ç»“æœï¼‰ï¼›
2. **æœ€é•¿å¼‚æˆ–è·¯å¾„**ï¼šåœ¨æ ‘ä¸­æ‰¾ä¸¤æ¡è·¯å¾„ï¼Œå¼‚æˆ–ç»“æœæœ€å¤§ï¼ˆå‰ç¼€å¼‚æˆ–+çº¿æ€§åŸºï¼‰ï¼›
3. **å¼‚æˆ–å­æ•°ç»„é—®é¢˜**ï¼šæ±‚æ•°ç»„ä¸­å¼‚æˆ–å’Œä¸º0çš„å­æ•°ç»„æ•°ç›®ï¼ˆå‰ç¼€å¼‚æˆ–+å“ˆå¸Œè¡¨ï¼‰ã€‚

### ç»ƒä¹ æ¨è (æ´›è°·)
1. **æ´›è°· P4551** - æœ€é•¿å¼‚æˆ–è·¯å¾„
   * ğŸ—£ï¸ æ¨èç†ç”±ï¼šè€ƒå¯Ÿå‰ç¼€å¼‚æˆ–å’Œçº¿æ€§åŸºçš„ç»“åˆï¼Œæ˜¯å¼‚æˆ–çš„é«˜çº§åº”ç”¨ï¼Œå·©å›ºå‰ç¼€å¼‚æˆ–æ€è·¯ã€‚
2. **æ´›è°· P1469** - å¯»æ‰¾ç¼ºå¤±çš„æ•°
   * ğŸ—£ï¸ æ¨èç†ç”±ï¼šç»å…¸å¼‚æˆ–é—®é¢˜ï¼Œç›´æ¥è€ƒå¯Ÿå½’é›¶å¾‹å’Œæ’ç­‰å¾‹ï¼Œé€‚åˆå…¥é—¨ç»ƒä¹ ã€‚
3. **æ´›è°· P2023** - ç»´æŠ¤åºåˆ—
   * ğŸ—£ï¸ æ¨èç†ç”±ï¼šå¤„ç†åŒºé—´å¼‚æˆ–æ“ä½œï¼Œç†Ÿæ‚‰å¼‚æˆ–çš„ç»“åˆå¾‹å’ŒåŒºé—´å¤„ç†æŠ€å·§ã€‚
4. **æ´›è°· P3812** - çº¿æ€§åŸº
   * ğŸ—£ï¸ æ¨èç†ç”±ï¼šå­¦ä¹ çº¿æ€§åŸºï¼ˆå¤„ç†å¼‚æˆ–é—®é¢˜çš„å¼ºå¤§å·¥å…·ï¼‰ï¼Œè§£å†³æœ€å¤§å¼‚æˆ–å’Œé—®é¢˜ã€‚


## 7. å­¦ä¹ å¿ƒå¾—ä¸ç»éªŒåˆ†äº«

### å‚è€ƒç»éªŒ (æ¥è‡ªAnxiomgh)
â€œæˆ‘æœ€åˆæ²¡æƒ³åˆ°è¦è¯æ˜â€˜å¿…ç„¶å­˜åœ¨sumâ€™ï¼Œåæ¥åˆ†æé¢˜ç›®ä¸­çš„â€˜-1æ€»æ•°ä¸ºnâ€™ï¼Œç”¨åè¯æ³•è¯æ˜äº†å¼•ç†3ï¼Œæ‰ç¡®å®šsumä¸€å®šèƒ½æ‰¾åˆ°ã€‚â€
* **ç‚¹è¯„**ï¼šé¢˜ç›®ä¸­çš„çº¦æŸæ¡ä»¶å¾€å¾€æ˜¯è§£é¢˜å…³é”®ï¼æ¯”å¦‚â€œ-1æ€»æ•°ä¸ºnâ€ä¸æ˜¯éšä¾¿ç»™çš„ï¼Œè€Œæ˜¯ä¿è¯sumå­˜åœ¨çš„å…³é”®ã€‚è§£é¢˜æ—¶è¦ä»”ç»†åˆ†ææ¯ä¸€ä¸ªæ¡ä»¶ã€‚

### å‚è€ƒç»éªŒ (æ¥è‡ªOtomachi_Una_)
â€œæœªçŸ¥é‡å¯ä»¥éšä¾¿å¡«ï¼Œæ¯”å¦‚å¡«0æˆ–1ï¼Œåªè¦æ»¡è¶³sumçš„æ¡ä»¶å°±è¡Œï¼Œå› ä¸ºé¢˜ç›®å…è®¸ä»»æ„è§£ã€‚â€
* **ç‚¹è¯„**ï¼šå¤šè§£é—®é¢˜ä¸­ï¼Œ**é€‰æœ€ç®€å•çš„æ„é€ æ–¹å¼**ï¼ˆæ¯”å¦‚å¡«0ï¼‰èƒ½å¤§å¤§ç®€åŒ–ä»£ç ï¼Œé¿å…å¤æ‚é€»è¾‘ã€‚


## ç»“è¯­
æœ¬æ¬¡åˆ†æå°±åˆ°è¿™é‡Œï¼è¿™é“é¢˜çš„æ ¸å¿ƒæ˜¯**æŒæ¡å¼‚æˆ–æ€§è´¨**+**é€»è¾‘æ¨å¯¼**ï¼Œå¼‚æˆ–å°±åƒâ€œå¼€å…³â€ï¼ŒæŒæ¡å®ƒçš„è§„åˆ™å°±èƒ½è§£å†³å¾ˆå¤šçœ‹ä¼¼å¤æ‚çš„é—®é¢˜ã€‚ä¸‹æ¬¡æˆ‘ä»¬å†ä¸€èµ·æ¢ç´¢æ›´å¤šæœ‰è¶£çš„ç®—æ³•é—®é¢˜ï¼ŒåŠ æ²¹ï¼ğŸ’ª

---
å¤„ç†ç”¨æ—¶ï¼š275.79ç§’
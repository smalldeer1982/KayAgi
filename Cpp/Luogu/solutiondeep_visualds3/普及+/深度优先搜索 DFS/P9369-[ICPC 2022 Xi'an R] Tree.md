# é¢˜ç›®ä¿¡æ¯

# [ICPC 2022 Xi'an R] Tree

## é¢˜ç›®æè¿°

ç»™å®šå¤§å°ä¸º $n$ çš„æœ‰æ ¹æ ‘ $T$ï¼Œæ ¹èŠ‚ç‚¹ä¸º $1$ã€‚å®šä¹‰ $\mathrm{subtree}(u)$ è¡¨ç¤ºç»“ç‚¹ $u$ çš„å­æ ‘ã€‚

ç§°é›†åˆ $S$ æ˜¯å¥½çš„ï¼Œå½“ä¸”ä»…å½“ $S$ è‡³å°‘æ»¡è¶³ä¸‹åˆ—æ¡ä»¶ä¹‹ä¸€ï¼š

- å¯¹äº $u, v\in S$ ä¸” $u\neq v$ï¼Œ$u\in \mathrm{subtree}(v)$ æˆ– $v\in \mathrm{subtree}(u)$ã€‚
- å¯¹äº $u, v\in S$ ä¸” $u\neq v$ï¼Œ$u\notin \mathrm{subtree}(v)$ ä¸” $v\notin \mathrm{subtree}(u)$ã€‚

å°† $T$ åˆ’åˆ†ä¸ºè‹¥å¹²å¥½çš„é›†åˆï¼Œæ±‚é›†åˆæ•°é‡çš„æœ€å°å€¼ã€‚

å…±æœ‰ $Q$ ç»„æ•°æ®ã€‚

$1\leq Q\leq 10 ^ 5$ï¼Œ$1\leq n, \sum n\leq 10 ^ 6$ï¼Œæ¯ä¸ªç‚¹çš„çˆ¶äº²ç¼–å· $1\leq p_i < i$ã€‚

## æ ·ä¾‹ #1

### è¾“å…¥

```
2
7
1 1 2 2 2 3
5
1 2 3 4
```

### è¾“å‡º

```
3
1
```

# AIåˆ†æç»“æœ

# ğŸ’¡ Kayçš„C++ç®—æ³•è§£æï¼šTree æ·±å…¥å­¦ä¹ æŒ‡å— ğŸ’¡


## 1. é¢˜ç›®è§£è¯»ä¸æ ¸å¿ƒç®—æ³•è¯†åˆ«

âœ¨ **æœ¬é¢˜ä¸»è¦è€ƒå¯Ÿ**ï¼šé•¿é“¾å‰–åˆ† + è´ªå¿ƒç­–ç•¥ / æ ‘çš„å±‚æ¬¡éå†ï¼ˆå‰¥å¶å­æ¨¡æ‹Ÿï¼‰


ğŸ—£ï¸ **åˆæ­¥åˆ†æ**ï¼š  
æˆ‘ä»¬éœ€è¦å°†æ ‘åˆ’åˆ†ä¸ºå°½å¯èƒ½å°‘çš„â€œå¥½é›†åˆâ€ï¼Œæ¯ä¸ªé›†åˆè¦ä¹ˆæ˜¯**åŒä¸€æ¡é“¾ä¸Šçš„èŠ‚ç‚¹**ï¼ˆç¥–å…ˆåä»£å…³ç³»ï¼‰ï¼Œè¦ä¹ˆæ˜¯**ä¸¤ä¸¤æ— ç¥–å…ˆåä»£å…³ç³»çš„èŠ‚ç‚¹**ï¼ˆåŒä¸€æ·±åº¦ï¼‰ã€‚å…³é”®åœ¨äºå¹³è¡¡è¿™ä¸¤ç§é›†åˆçš„æ•°é‡â€”â€”é€‰æ›´å¤šé•¿é“¾ä½œä¸ºç¬¬ä¸€ç§é›†åˆï¼Œå‰©ä¸‹çš„ç”¨ç¬¬äºŒç§é›†åˆï¼ˆåŒä¸€æ·±åº¦ï¼‰ï¼Œè¿™æ ·æ€»é›†åˆæ•°ä¼šæ›´å°ã€‚  

### æ ¸å¿ƒç®—æ³•æ€è·¯
- **é•¿é“¾å‰–åˆ†**ï¼šå°†æ ‘åˆ†è§£ä¸ºè‹¥å¹²æ¡æœ€é•¿çš„é“¾ï¼ˆé•¿é“¾ï¼‰ï¼Œè¿™äº›é“¾çš„é•¿åº¦å†³å®šäº†ç¬¬äºŒç§é›†åˆçš„æ•°é‡ï¼ˆå‰©ä½™æœ€é•¿é“¾çš„é•¿åº¦ï¼‰ã€‚  
- **è´ªå¿ƒç­–ç•¥**ï¼šå°†é•¿é“¾æŒ‰é•¿åº¦ä»å¤§åˆ°å°æ’åºï¼Œæšä¸¾é€‰å‰`i`æ¡é•¿é“¾ä½œä¸ºç¬¬ä¸€ç§é›†åˆï¼Œå‰©ä½™æœ€é•¿é“¾çš„é•¿åº¦ä¸º`lp[i+1]`ï¼Œæ€»é›†åˆæ•°ä¸º`i + lp[i+1]`ï¼Œå–æœ€å°å€¼ã€‚  

### å¯è§†åŒ–è®¾è®¡æ€è·¯
æˆ‘ä»¬å¯ä»¥ç”¨**8ä½åƒç´ é£æ ¼**æ¨¡æ‹Ÿæ ‘çš„ç»“æ„ï¼š  
- ç”¨ä¸åŒé¢œè‰²çš„åƒç´ å—è¡¨ç¤ºèŠ‚ç‚¹ï¼ˆæ¯”å¦‚æ ¹èŠ‚ç‚¹ä¸ºçº¢è‰²ï¼Œé•¿é“¾èŠ‚ç‚¹ä¸ºè“è‰²ï¼Œæ™®é€šèŠ‚ç‚¹ä¸ºç»¿è‰²ï¼‰ï¼›  
- é•¿é“¾å‰–åˆ†æ—¶ï¼Œç”¨â€œé—ªçƒâ€åŠ¨ç”»æ ‡è®°æœ€é•¿å­é“¾ï¼›  
- è´ªå¿ƒé€‰æ‹©æ—¶ï¼Œç”¨â€œé«˜äº®â€åŠ¨ç”»æ˜¾ç¤ºé€‰ä¸­çš„é•¿é“¾ï¼Œå‰©ä½™é“¾çš„é•¿åº¦ç”¨æ•°å­—åŠ¨æ€æ›´æ–°ï¼›  
- æ¯ä¸€æ­¥æ“ä½œä¼´éšè½»å¾®çš„â€œå®â€å£°ï¼ˆé€‰é“¾ï¼‰æˆ–â€œå’”å—’â€å£°ï¼ˆæ›´æ–°é•¿åº¦ï¼‰ï¼Œå¢å¼ºä»£å…¥æ„Ÿã€‚  


## 2. ç²¾é€‰ä¼˜è´¨é¢˜è§£å‚è€ƒ

### é¢˜è§£ä¸€ï¼šé•¿é“¾å‰–åˆ†+è´ªå¿ƒï¼ˆä½œè€…ï¼šStarRain3ï¼Œèµ4ï¼‰
* **ç‚¹è¯„**ï¼š  
  è¿™ä»½é¢˜è§£æ€è·¯æ¸…æ™°ï¼Œç›´æ¥å‘½ä¸­é—®é¢˜æ ¸å¿ƒâ€”â€”ç”¨é•¿é“¾å‰–åˆ†æå–æœ€é•¿é“¾ï¼Œå†é€šè¿‡è´ªå¿ƒå¹³è¡¡ä¸¤ç§é›†åˆçš„æ•°é‡ã€‚ä»£ç ä¸­çš„ä¸¤æ¬¡DFSï¼ˆ`dfs1`æ‰¾æœ€é•¿å­é“¾ï¼Œ`dfs2`ç»Ÿè®¡é•¿é“¾é•¿åº¦ï¼‰æ˜¯é•¿é“¾å‰–åˆ†çš„ç»å…¸å®ç°ï¼Œé€»è¾‘ä¸¥è°¨ã€‚æ’åºåçš„è´ªå¿ƒè®¡ç®—ï¼ˆ`i + lp[i+1]`ï¼‰ç®€æ´é«˜æ•ˆï¼Œèƒ½å¿«é€Ÿæ‰¾åˆ°æœ€å°å€¼ã€‚å…¶äº®ç‚¹åœ¨äºå°†å¤æ‚çš„æ ‘åˆ’åˆ†é—®é¢˜è½¬åŒ–ä¸ºé•¿é“¾é•¿åº¦çš„æ’åºé—®é¢˜ï¼Œé™ä½äº†æ€ç»´éš¾åº¦ã€‚


### é¢˜è§£äºŒï¼šå‰¥å¶å­æ¨¡æ‹Ÿï¼ˆä½œè€…ï¼šè’Ÿè’»å›HJTï¼Œèµ3ï¼‰
* **ç‚¹è¯„**ï¼š  
  è¿™æ˜¯ä¸€ç§éå¸¸æ–°é¢–çš„æ€è·¯ï¼å°†é—®é¢˜è½¬åŒ–ä¸ºâ€œå‰¥å¶å­â€æ¸¸æˆâ€”â€”æ¯æ¬¡å»æ‰æ‰€æœ‰å¶å­ï¼ˆç”¨ä¸€ä¸ªBå‹é›†åˆè£…ï¼‰ï¼Œè®°å½•è½®æ•°`num`å’Œå‰©ä½™å¶å­æ•°`leaf.size()`ï¼Œç­”æ¡ˆå–`num + leaf.size()`çš„æœ€å°å€¼ã€‚ä»£ç ç”¨`d`æ•°ç»„è®°å½•æ¯ä¸ªèŠ‚ç‚¹çš„å­èŠ‚ç‚¹æ•°ï¼Œé€šè¿‡å¾ªç¯æ¨¡æ‹Ÿå‰¥å¶å­è¿‡ç¨‹ï¼Œé€»è¾‘ç®€å•æ˜“æ‡‚ã€‚äº®ç‚¹åœ¨äºå°†æŠ½è±¡çš„é›†åˆåˆ’åˆ†è½¬åŒ–ä¸ºç›´è§‚çš„æ ‘æ“ä½œï¼Œé€‚åˆåˆå­¦è€…ç†è§£ã€‚


### é¢˜è§£ä¸‰ï¼šç»Ÿè®¡mxå€¼+è´ªå¿ƒï¼ˆä½œè€…ï¼šMissaï¼Œèµ3ï¼‰
* **ç‚¹è¯„**ï¼š  
  è¿™ä»½é¢˜è§£çš„æ€è·¯éå¸¸å·§å¦™ï¼é€šè¿‡ç»Ÿè®¡æ¯ä¸ªèŠ‚ç‚¹åˆ°å¶å­çš„æœ€å¤§è·ç¦»`mx`ï¼ˆå³è¯¥èŠ‚ç‚¹æ‰€åœ¨é•¿é“¾çš„é•¿åº¦ï¼‰ï¼Œç„¶åè®¡ç®—`cnt[i]`ï¼ˆ`mx`ç­‰äº`i`çš„èŠ‚ç‚¹æ•°ï¼‰ï¼Œç­”æ¡ˆå–`i + cnt[i]`çš„æœ€å°å€¼ã€‚ä»£ç ç”¨é€†åºDFSè®¡ç®—`mx`ï¼Œæ—¶é—´å¤æ‚åº¦`O(n)`ï¼Œæ•ˆç‡æé«˜ã€‚äº®ç‚¹åœ¨äºå°†é•¿é“¾å‰–åˆ†çš„ç»“æœè½¬åŒ–ä¸º`mx`å€¼çš„ç»Ÿè®¡ï¼Œé¿å…äº†æ˜¾å¼çš„é“¾åˆ†è§£ï¼Œç®€åŒ–äº†ä»£ç ã€‚


## 3. æ ¸å¿ƒéš¾ç‚¹è¾¨æä¸è§£é¢˜ç­–ç•¥

### 1. éš¾ç‚¹1ï¼šå¦‚ä½•å°†é—®é¢˜è½¬åŒ–ä¸ºå¯è§£å†³çš„æ¨¡å‹ï¼Ÿ
* **åˆ†æ**ï¼š  
  å¥½é›†åˆçš„æ¡ä»¶çœ‹ä¼¼å¤æ‚ï¼Œä½†å¯ä»¥æ‹†è§£ä¸ºâ€œé“¾â€ï¼ˆAå‹ï¼‰å’Œâ€œåŒä¸€æ·±åº¦â€ï¼ˆBå‹ï¼‰ã€‚é•¿é“¾å‰–åˆ†çš„ä½œç”¨æ˜¯æå–æœ€é•¿çš„é“¾ï¼Œè¿™äº›é“¾æ˜¯Aå‹é›†åˆçš„æœ€ä¼˜é€‰æ‹©ï¼›è€ŒBå‹é›†åˆçš„æ•°é‡ç­‰äºå‰©ä½™æœ€é•¿é“¾çš„é•¿åº¦ï¼ˆåŒä¸€æ·±åº¦çš„èŠ‚ç‚¹æ•°ï¼‰ã€‚  
* ğŸ’¡ **å­¦ä¹ ç¬”è®°**ï¼š é—®é¢˜è½¬åŒ–æ˜¯è§£é¢˜çš„å…³é”®ï¼Œè¦å­¦ä¼šå°†æŠ½è±¡æ¡ä»¶æ˜ å°„åˆ°å…·ä½“çš„æ•°æ®ç»“æ„ï¼ˆå¦‚é•¿é“¾ï¼‰ã€‚


### 2. éš¾ç‚¹2ï¼šé•¿é“¾å‰–åˆ†çš„å®ç°
* **åˆ†æ**ï¼š  
  é•¿é“¾å‰–åˆ†éœ€è¦ä¸¤æ¬¡DFSï¼šç¬¬ä¸€æ¬¡æ‰¾æ¯ä¸ªèŠ‚ç‚¹çš„æœ€é•¿å­é“¾ï¼ˆ`son`æ•°ç»„ï¼‰ï¼Œç¬¬äºŒæ¬¡ç»Ÿè®¡æ‰€æœ‰é•¿é“¾çš„é•¿åº¦ï¼ˆ`lp`æ•°ç»„ï¼‰ã€‚æ³¨æ„ç¬¬äºŒæ¬¡DFSæ—¶ï¼Œéé•¿é“¾çš„å­èŠ‚ç‚¹è¦ä»é•¿åº¦1å¼€å§‹ç»Ÿè®¡ã€‚  
* ğŸ’¡ **å­¦ä¹ ç¬”è®°**ï¼š é•¿é“¾å‰–åˆ†çš„æ ¸å¿ƒæ˜¯â€œæœ€é•¿å­é“¾â€ï¼ŒæŒæ¡ä¸¤æ¬¡DFSçš„é€»è¾‘å°±èƒ½å¿«é€Ÿå®ç°ã€‚


### 3. éš¾ç‚¹3ï¼šè´ªå¿ƒç­–ç•¥çš„æ­£ç¡®æ€§
* **åˆ†æ**ï¼š  
  ä¸ºä»€ä¹ˆé€‰æœ€é•¿çš„é“¾ä½œä¸ºAå‹é›†åˆèƒ½æœ€å°åŒ–æ€»é›†åˆæ•°ï¼Ÿå› ä¸ºæœ€é•¿çš„é“¾ä¼šå ç”¨æœ€å¤šçš„èŠ‚ç‚¹ï¼Œå‰©ä½™çš„é“¾é•¿åº¦ä¼šå°½å¯èƒ½å°ï¼Œä»è€Œå‡å°‘Bå‹é›†åˆçš„æ•°é‡ã€‚ä¾‹å¦‚ï¼Œé€‰æœ€é•¿çš„é“¾`L`ï¼Œå‰©ä½™æœ€é•¿é“¾ä¸º`M`ï¼Œæ€»é›†åˆæ•°ä¸º`1 + M`ï¼›å¦‚æœé€‰ shorter çš„é“¾ï¼Œå‰©ä½™æœ€é•¿é“¾å¯èƒ½è¿˜æ˜¯`L`ï¼Œæ€»é›†åˆæ•°ä¸º`1 + L`ï¼Œæ˜¾ç„¶æ›´å¤§ã€‚  
* ğŸ’¡ **å­¦ä¹ ç¬”è®°**ï¼š è´ªå¿ƒç­–ç•¥çš„æ­£ç¡®æ€§éœ€è¦è¯æ˜ï¼Œé€šå¸¸æ˜¯é€šè¿‡â€œäº¤æ¢è®ºè¯â€ï¼ˆäº¤æ¢ä¸¤ä¸ªé€‰æ‹©ï¼Œç»“æœä¸ä¼šæ›´ä¼˜ï¼‰ã€‚


### âœ¨ è§£é¢˜æŠ€å·§æ€»ç»“
- **é—®é¢˜è½¬åŒ–**ï¼šå°†é›†åˆåˆ’åˆ†é—®é¢˜è½¬åŒ–ä¸ºé•¿é“¾é•¿åº¦çš„ç»Ÿè®¡é—®é¢˜ï¼›  
- **é•¿é“¾å‰–åˆ†**ï¼šå¿«é€Ÿæå–æ ‘ä¸­çš„æœ€é•¿é“¾ï¼›  
- **è´ªå¿ƒé€‰æ‹©**ï¼šä¼˜å…ˆé€‰æœ€é•¿çš„é“¾ï¼Œå¹³è¡¡ä¸¤ç§é›†åˆçš„æ•°é‡ï¼›  
- **æ•ˆç‡ä¼˜åŒ–**ï¼šå¤šç»„æ•°æ®æ—¶ï¼Œæ³¨æ„æ¸…ç©ºæ•°ç»„ï¼ˆå¦‚é‚»æ¥è¡¨ï¼‰çš„æ–¹å¼ï¼Œé¿å…è¶…æ—¶ã€‚


## 4. C++æ ¸å¿ƒä»£ç å®ç°èµæ

### æœ¬é¢˜é€šç”¨æ ¸å¿ƒC++å®ç°å‚è€ƒï¼ˆé•¿é“¾å‰–åˆ†+è´ªå¿ƒï¼‰
* **è¯´æ˜**ï¼š ç»¼åˆäº†StarRain3ã€Poole_teaç­‰é¢˜è§£çš„æ€è·¯ï¼Œæ˜¯é•¿é“¾å‰–åˆ†çš„ç»å…¸å®ç°ã€‚  
* **å®Œæ•´æ ¸å¿ƒä»£ç **ï¼š  
  ```cpp
  #include <iostream>
  #include <vector>
  #include <algorithm>
  using namespace std;

  const int MAXN = 1e6 + 10;
  vector<int> g[MAXN];
  int son[MAXN], len[MAXN];
  vector<int> lp;

  void dfs1(int x) {
      for (int y : g[x]) {
          dfs1(y);
          if (len[y] > len[son[x]]) son[x] = y;
      }
      len[x] = len[son[x]] + 1;
  }

  void dfs2(int x, int l) {
      if (!son[x]) lp.push_back(l);
      else {
          dfs2(son[x], l + 1);
          for (int y : g[x]) if (y != son[x]) dfs2(y, 1);
      }
  }

  int main() {
      ios::sync_with_stdio(false);
      cin.tie(0);
      int T;
      cin >> T;
      while (T--) {
          int n;
          cin >> n;
          for (int i = 1; i <= n; i++) g[i].clear(), son[i] = 0, len[i] = 0;
          lp.clear();
          for (int i = 2; i <= n; i++) {
              int p;
              cin >> p;
              g[p].push_back(i);
          }
          dfs1(1);
          dfs2(1, 1);
          sort(lp.begin(), lp.end(), greater<int>());
          int ans = lp[0];
          for (int i = 1; i <= lp.size(); i++) {
              if (i < lp.size()) ans = min(ans, i + lp[i]);
              else ans = min(ans, i);
          }
          cout << ans << '\n';
      }
      return 0;
  }
  ```
* **ä»£ç è§£è¯»æ¦‚è¦**ï¼š  
  1. `dfs1`ï¼šéå†æ ‘ï¼Œæ‰¾åˆ°æ¯ä¸ªèŠ‚ç‚¹çš„æœ€é•¿å­é“¾ï¼ˆ`son`æ•°ç»„ï¼‰ï¼Œå¹¶è®¡ç®—è¯¥èŠ‚ç‚¹æ‰€åœ¨é•¿é“¾çš„é•¿åº¦ï¼ˆ`len`æ•°ç»„ï¼‰ï¼›  
  2. `dfs2`ï¼šéå†æ ‘ï¼Œç»Ÿè®¡æ‰€æœ‰é•¿é“¾çš„é•¿åº¦ï¼ˆ`lp`æ•°ç»„ï¼‰ï¼›  
  3. æ’åº`lp`æ•°ç»„ï¼Œè´ªå¿ƒè®¡ç®—æœ€å°é›†åˆæ•°ï¼ˆ`i + lp[i+1]`ï¼‰ã€‚


### é¢˜è§£äºŒï¼ˆå‰¥å¶å­æ¨¡æ‹Ÿï¼‰æ ¸å¿ƒä»£ç èµæ
* **äº®ç‚¹**ï¼š ç”¨å±‚æ¬¡éå†æ¨¡æ‹Ÿå‰¥å¶å­è¿‡ç¨‹ï¼Œé€»è¾‘ç®€å•ã€‚  
* **æ ¸å¿ƒä»£ç ç‰‡æ®µ**ï¼š  
  ```cpp
  void solve(){
      scanf("%d", &n);
      for(int i = 1; i <= n; ++i) d[i] = 0;
      for(int i = 2; i <= n; ++i){
          int x; scanf("%d", &x);
          ++d[x]; fa[i] = x;
      }
      leaf.clear(), tmp.clear();
      for(int i = 1; i <= n; ++i) if(!d[i]) leaf.push_back(i);
      int num = 0, ans = 1e9;
      while(leaf.size()){
          ans = min(ans, num + (int)leaf.size());
          num += 1;
          for(auto v : leaf) {
              --d[fa[v]];
              if(!d[fa[v]]) tmp.push_back(fa[v]);
          }
          leaf.clear();
          swap(leaf, tmp);
      }
      printf("%d\n", ans);
  }
  ```
* **ä»£ç è§£è¯»**ï¼š  
  - `d`æ•°ç»„è®°å½•æ¯ä¸ªèŠ‚ç‚¹çš„å­èŠ‚ç‚¹æ•°ï¼ˆåº¦ï¼‰ï¼›  
  - `leaf`æ•°ç»„å­˜å‚¨å½“å‰æ‰€æœ‰å¶å­èŠ‚ç‚¹ï¼›  
  - å¾ªç¯å‰¥å¶å­ï¼šæ¯æ¬¡å°†å¶å­èŠ‚ç‚¹çš„çˆ¶èŠ‚ç‚¹çš„åº¦å‡1ï¼Œå¦‚æœçˆ¶èŠ‚ç‚¹å˜æˆå¶å­ï¼ŒåŠ å…¥`tmp`æ•°ç»„ï¼›  
  - æ¯è½®ç»“æŸåï¼Œæ›´æ–°`ans`ï¼ˆ`num`æ˜¯Bå‹é›†åˆæ•°ï¼Œ`leaf.size()`æ˜¯å‰©ä½™Aå‹é›†åˆæ•°ï¼‰ã€‚  
* ğŸ’¡ **å­¦ä¹ ç¬”è®°**ï¼š å‰¥å¶å­æ˜¯å¤„ç†æ ‘å±‚æ¬¡é—®é¢˜çš„å¸¸ç”¨æŠ€å·§ï¼Œé€‚åˆè§£å†³â€œåŒä¸€æ·±åº¦â€ç›¸å…³çš„é—®é¢˜ã€‚


## 5. ç®—æ³•å¯è§†åŒ–ï¼šåƒç´ åŠ¨ç”»æ¼”ç¤º (æ ¸å¿ƒéƒ¨åˆ†)

### åŠ¨ç”»æ¼”ç¤ºä¸»é¢˜ï¼šã€Šæ ‘çš„â€œé“¾â€ä¸â€œå±‚â€æ¸¸æˆã€‹ï¼ˆ8ä½åƒç´ é£æ ¼ï¼‰
### è®¾è®¡æ€è·¯
ç”¨FCçº¢ç™½æœºçš„é£æ ¼æ¨¡æ‹Ÿæ ‘çš„ç»“æ„ï¼Œé€šè¿‡åŠ¨ç”»å±•ç¤ºé•¿é“¾å‰–åˆ†å’Œè´ªå¿ƒé€‰æ‹©çš„è¿‡ç¨‹ï¼Œå¢å¼ºè¶£å‘³æ€§ã€‚å…³é”®å…ƒç´ åŒ…æ‹¬ï¼š  
- **åƒç´ æ ‘**ï¼šæ ¹èŠ‚ç‚¹ï¼ˆçº¢è‰²ï¼‰ã€é•¿é“¾èŠ‚ç‚¹ï¼ˆè“è‰²ï¼‰ã€æ™®é€šèŠ‚ç‚¹ï¼ˆç»¿è‰²ï¼‰ï¼›  
- **æ§åˆ¶é¢æ¿**ï¼šå¼€å§‹/æš‚åœã€å•æ­¥æ‰§è¡Œã€é€Ÿåº¦æ»‘å—ï¼›  
- **éŸ³æ•ˆ**ï¼šé€‰é“¾æ—¶â€œå®â€å£°ï¼Œæ›´æ–°é•¿åº¦æ—¶â€œå’”å—’â€å£°ï¼Œèƒœåˆ©æ—¶â€œé€šå…³â€éŸ³æ•ˆã€‚


### åŠ¨ç”»å¸§æ­¥éª¤
1. **åˆå§‹åŒ–**ï¼šæ˜¾ç¤ºä¸€æ£µåƒç´ æ ‘ï¼Œæ ¹èŠ‚ç‚¹ä¸ºçº¢è‰²ï¼Œå…¶ä»–èŠ‚ç‚¹ä¸ºç»¿è‰²ã€‚æ§åˆ¶é¢æ¿æ˜¾ç¤ºâ€œå¼€å§‹â€æŒ‰é’®ã€‚  
2. **é•¿é“¾å‰–åˆ†**ï¼š  
   - `dfs1`è¿‡ç¨‹ï¼šç”¨â€œé—ªçƒâ€åŠ¨ç”»æ ‡è®°æ¯ä¸ªèŠ‚ç‚¹çš„æœ€é•¿å­é“¾ï¼ˆ`son`æ•°ç»„ï¼‰ï¼›  
   - `dfs2`è¿‡ç¨‹ï¼šç”¨â€œè“è‰²å¡«å……â€åŠ¨ç”»æ ‡è®°é•¿é“¾èŠ‚ç‚¹ï¼Œç»Ÿè®¡é•¿é“¾é•¿åº¦ï¼ˆ`lp`æ•°ç»„ï¼‰ã€‚  
3. **è´ªå¿ƒé€‰æ‹©**ï¼š  
   - å°†é•¿é“¾æŒ‰é•¿åº¦ä»å¤§åˆ°å°æ’åºï¼Œç”¨â€œé«˜äº®â€åŠ¨ç”»æ˜¾ç¤ºé€‰ä¸­çš„å‰`i`æ¡é•¿é“¾ï¼›  
   - åŠ¨æ€æ›´æ–°å‰©ä½™æœ€é•¿é“¾çš„é•¿åº¦ï¼ˆ`lp[i+1]`ï¼‰ï¼Œå¹¶æ˜¾ç¤ºå½“å‰æ€»é›†åˆæ•°ï¼ˆ`i + lp[i+1]`ï¼‰ã€‚  
4. **ç»“æœå±•ç¤º**ï¼šç”¨â€œå½©è™¹è‰²â€åŠ¨ç”»æ ‡è®°æ‰€æœ‰é›†åˆï¼Œæ˜¾ç¤ºæœ€å°é›†åˆæ•°ï¼Œæ’­æ”¾èƒœåˆ©éŸ³æ•ˆã€‚


### äº¤äº’è®¾è®¡
- **å•æ­¥æ‰§è¡Œ**ï¼šç‚¹å‡»â€œä¸‹ä¸€æ­¥â€æŒ‰é’®ï¼Œé€æ­¥è§‚çœ‹é•¿é“¾å‰–åˆ†å’Œè´ªå¿ƒé€‰æ‹©çš„è¿‡ç¨‹ï¼›  
- **è‡ªåŠ¨æ’­æ”¾**ï¼šæ‹–åŠ¨é€Ÿåº¦æ»‘å—è°ƒæ•´æ’­æ”¾é€Ÿåº¦ï¼ŒåŠ¨ç”»è‡ªåŠ¨æ‰§è¡Œï¼›  
- **é‡ç½®**ï¼šç‚¹å‡»â€œé‡ç½®â€æŒ‰é’®ï¼Œå›åˆ°åˆå§‹çŠ¶æ€ï¼Œé‡æ–°æ¼”ç¤ºã€‚


## 6. æ‹“å±•ç»ƒä¹ ä¸ç›¸ä¼¼é—®é¢˜æ€è€ƒ

### é€šç”¨æ€è·¯/æŠ€å·§è¿ç§»
- **é•¿é“¾å‰–åˆ†**ï¼šå¯ç”¨äºè§£å†³æ ‘ä¸­çš„æœ€é•¿è·¯å¾„é—®é¢˜ï¼ˆå¦‚ç›´å¾„ï¼‰ã€kçº§ç¥–å…ˆé—®é¢˜ï¼›  
- **è´ªå¿ƒç­–ç•¥**ï¼šå¯ç”¨äºè§£å†³èµ„æºåˆ†é…é—®é¢˜ï¼ˆå¦‚åˆå¹¶æœå­ï¼‰ã€åŒºé—´è¦†ç›–é—®é¢˜ï¼›  
- **å‰¥å¶å­æ¨¡æ‹Ÿ**ï¼šå¯ç”¨äºè§£å†³æ ‘çš„å±‚æ¬¡éå†é—®é¢˜ï¼ˆå¦‚æ±‚æ ‘çš„æ·±åº¦ï¼‰ã€æ‹“æ‰‘æ’åºé—®é¢˜ã€‚


### ç»ƒä¹ æ¨è (æ´›è°·)
1. **æ´›è°· P3806 ã€æ¨¡æ¿ã€‘é•¿é“¾å‰–åˆ†**  
   ğŸ—£ï¸ **æ¨èç†ç”±**ï¼š è¿™æ˜¯é•¿é“¾å‰–åˆ†çš„æ¨¡æ¿é¢˜ï¼Œèƒ½å¸®åŠ©ä½ å·©å›ºé•¿é“¾å‰–åˆ†çš„å®ç°ç»†èŠ‚ã€‚  
2. **æ´›è°· P5903 ã€æ¨¡æ¿ã€‘æ ‘ä¸Š k çº§ç¥–å…ˆ**  
   ğŸ—£ï¸ **æ¨èç†ç”±**ï¼š é•¿é“¾å‰–åˆ†çš„åº”ç”¨é—®é¢˜ï¼Œéœ€è¦ç”¨é•¿é“¾å‰–åˆ†ä¼˜åŒ–kçº§ç¥–å…ˆçš„æŸ¥è¯¢ã€‚  
3. **æ´›è°· P6031 åˆå¹¶æœå­ï¼ˆåŠ å¼ºç‰ˆï¼‰**  
   ğŸ—£ï¸ **æ¨èç†ç”±**ï¼š è´ªå¿ƒç­–ç•¥çš„ç»å…¸é—®é¢˜ï¼Œèƒ½å¸®åŠ©ä½ ç†è§£è´ªå¿ƒé€‰æ‹©çš„æ­£ç¡®æ€§ã€‚  


## 7. å­¦ä¹ å¿ƒå¾—ä¸ç»éªŒåˆ†äº« (è‹¥æœ‰)
- **æ¥è‡ªPoole_teaçš„ç»éªŒ**ï¼šâ€œåˆ«ç”¨é‚»æ¥è¡¨å­˜å›¾ï¼Œå¤šæµ‹æ¸…ç©ºé‚»æ¥è¡¨å¤æ‚åº¦å¾ˆé«˜ï¼Œä¼šTLEã€‚â€  
  **ç‚¹è¯„**ï¼š è¿™æ˜¯ä¸€ä¸ªéå¸¸å®ç”¨çš„è°ƒè¯•æŠ€å·§ï¼å¤šç»„æ•°æ®æ—¶ï¼Œç”¨`vector`çš„`clear()`æ–¹æ³•æ¸…ç©ºé‚»æ¥è¡¨æ˜¯é«˜æ•ˆçš„ï¼Œä½†è¦æ³¨æ„æ•°ç»„çš„åˆå§‹åŒ–ï¼ˆå¦‚`son`ã€`len`æ•°ç»„ï¼‰ã€‚  
- **æ¥è‡ªè’Ÿè’»å›HJTçš„ç»éªŒ**ï¼šâ€œå‰¥å¶å­çš„æ—¶å€™ï¼Œè¦æ³¨æ„çˆ¶èŠ‚ç‚¹çš„åº¦æ˜¯å¦ä¸º0ã€‚â€  
  **ç‚¹è¯„**ï¼š è¿™æ˜¯å‰¥å¶å­æ¨¡æ‹Ÿçš„å…³é”®ç»†èŠ‚ï¼å¦‚æœçˆ¶èŠ‚ç‚¹çš„åº¦å‡åˆ°0ï¼Œè¯´æ˜å®ƒå˜æˆäº†æ–°çš„å¶å­ï¼Œéœ€è¦åŠ å…¥ä¸‹ä¸€è½®çš„å¤„ç†ã€‚  


## ç»“è¯­
æœ¬æ¬¡å…³äºâ€œTreeâ€çš„C++è§£é¢˜åˆ†æå°±åˆ°è¿™é‡Œã€‚å¸Œæœ›è¿™ä»½æŒ‡å—èƒ½å¸®åŠ©ä½ ç†è§£é•¿é“¾å‰–åˆ†ã€è´ªå¿ƒç­–ç•¥å’Œå‰¥å¶å­æ¨¡æ‹Ÿçš„æ ¸å¿ƒæ€æƒ³ã€‚è®°ä½ï¼Œç¼–ç¨‹çš„ä¹è¶£åœ¨äºå°†å¤æ‚é—®é¢˜è½¬åŒ–ä¸ºç®€å•çš„æ¨¡å‹ï¼Œç„¶åç”¨ä»£ç å®ç°å®ƒï¼ä¸‹æ¬¡æˆ‘ä»¬å†ä¸€èµ·æ¢ç´¢æ–°çš„ç¼–ç¨‹æŒ‘æˆ˜ï¼ğŸ’ª

---
å¤„ç†ç”¨æ—¶ï¼š128.59ç§’
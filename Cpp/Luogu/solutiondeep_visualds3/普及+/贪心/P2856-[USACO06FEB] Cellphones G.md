# é¢˜ç›®ä¿¡æ¯

# [USACO06FEB] Cellphones G

## é¢˜ç›®æè¿°

The cows have started using cellphones to cowmunicate with each other, but have found that the button layout doesn't suit their hooves very well. They are designing a special cellphone with fewer but larger buttons.


One feature they liked on the standard cellphones was predictive text. Each button has a few letters associated with it, and one types a word by pushing the associated buttons. Because there is more than one letter for each button, this can be ambiguous for some words.  However, most of the time the ambiguity can be resolved by using a dictionary to determine what word the user wanted.


Since the cows are designing a custom cellphone, they are also going to replace the English alphabet with the Cow alphabet. By an amazing coincidence, the cow alphabet is simply the first L (1 <= L <= 26) letters of the English alphabet, in the same order. They want to find out how to assign the letters of the Cow alphabet to the B buttons (1 <= B <= L) in such a way that the maximum number of words in their dictionary are unambiguous when entered with predictive text. Like normal cellphones, they want the letters on each button to be a contiguous section (one or more consecutive letters) of the alphabet.

å¥¶ç‰›çš„åå­—éƒ½æ˜¯ç”±è‹±æ–‡å­—æ¯è¡¨çš„å‰1(1 < K 26)ä¸ªå­—æ¯æ„æˆçš„.ç°åœ¨æƒ³è®¾è®¡ä¸€ç§æ‰‹æœºï¼Œ æœ‰ä¸ªæŒ‰é”®.è¯·ä½ æŠŠè¿™Lä¸ªå­—æ¯æŒ‰é¡ºåºåˆ†é…ç»™Bä¸ªæŒ‰é”®ï¼Œä½¿èƒ½å¤Ÿé€šè¿‡æŒ‰è¿™äº›é”®è€Œå”¯ä¸€ç¡® å®šçš„å¥¶ç‰›æ•°å°½é‡å¤š.


## è¯´æ˜/æç¤º

Explanation of the sample:




Button 1 contains AB, button two contains C-K, and button 3 contains LM. The words CELL, DILL, FILL and FILM are all entered as 2233, while the remaining 7 words are all entered uniquely.


## æ ·ä¾‹ #1

### è¾“å…¥

```
3 13
11
ALL
BALL
BELL
CALK
CALL
CELL
DILL
FILL
FILM
ILL
MILK```

### è¾“å‡º

```
7
AB
CDEFGHIJK
LM```

# AIåˆ†æç»“æœ


# ğŸ’¡ Kayçš„C++ç®—æ³•è§£æï¼šCellphones G æ·±å…¥å­¦ä¹ æŒ‡å— ğŸ’¡

## 1. é¢˜ç›®è§£è¯»ä¸æ ¸å¿ƒç®—æ³•è¯†åˆ«

âœ¨ **æœ¬é¢˜ä¸»è¦è€ƒå¯Ÿ**ï¼š`ç»„åˆæšä¸¾ä¸å­—ç¬¦ä¸²å“ˆå¸Œ`

ğŸ—£ï¸ **åˆæ­¥åˆ†æ**ï¼š
> è¿™é“é¢˜å°±åƒè®¾è®¡ä¸€ä¸ªå¥¶ç‰›ä¸“ç”¨é”®ç›˜ï¼šè¦æŠŠå‰Lä¸ªå¤§å†™å­—æ¯ï¼ˆAå¼€å§‹çš„è¿ç»­å­—æ¯ï¼‰åˆ†é…åˆ°Bä¸ªæŒ‰é”®ä¸Šï¼ˆæ¯ä¸ªæŒ‰é”®å¯¹åº”ä¸€æ®µè¿ç»­å­—æ¯ï¼‰ï¼Œä½¿å¾—å°½å¯èƒ½å¤šçš„å¥¶ç‰›åå­—èƒ½é€šè¿‡æŒ‰é”®åºåˆ—**å”¯ä¸€ç¡®å®š**ã€‚æƒ³è±¡ä½ åœ¨ç©ä¸€ä¸ªæ‹¼å›¾æ¸¸æˆï¼šå¿…é¡»æŠŠå­—æ¯åºåˆ—åˆ‡æˆBæ®µè¿ç»­å—ï¼Œæ¯å—å¯¹åº”ä¸€ä¸ªæŒ‰é”®ï¼Œç„¶åè®¡ç®—åœ¨è¿™ç§åˆ‡å‰²æ–¹æ¡ˆä¸‹æœ‰å¤šå°‘åå­—æ˜¯"ç‹¬ä¸€æ— äºŒ"çš„å¯†ç ã€‚

- **æ ¸å¿ƒè§£æ³•**ï¼šç”¨DFSæšä¸¾æ‰€æœ‰å¯èƒ½çš„è¿ç»­åˆ†æ®µæ–¹æ¡ˆï¼Œå¯¹æ¯ä¸ªæ–¹æ¡ˆè®¡ç®—åå­—è½¬æ¢çš„å“ˆå¸Œå€¼ï¼ˆB+1è¿›åˆ¶ï¼‰ï¼Œç»Ÿè®¡å”¯ä¸€å“ˆå¸Œå€¼æ•°é‡
- **éš¾ç‚¹**ï¼šå¦‚ä½•é«˜æ•ˆæšä¸¾æ‰€æœ‰åˆæ³•åˆ†æ®µæ–¹æ¡ˆï¼Ÿå¦‚ä½•é¿å…å“ˆå¸Œå†²çªï¼Ÿå¦‚ä½•æ»¡è¶³"ç¼–å·å°çš„æŒ‰é”®å­—æ¯æ›´å¤š"çš„è¦æ±‚ï¼Ÿ
- **å¯è§†åŒ–è®¾è®¡**ï¼šæˆ‘ä»¬å°†ç”¨åƒç´ ç½‘æ ¼å±•ç¤ºå­—æ¯åˆ†æ®µè¿‡ç¨‹ï¼ŒæŒ‰é”®ç”¨ä¸åŒé¢œè‰²è¡¨ç¤ºï¼Œåå­—è½¬æ¢æ—¶é«˜äº®å½“å‰æŒ‰é”®ï¼Œå”¯ä¸€åå­—æ˜¾ç¤ºç»¿è‰²é—ªå…‰æ•ˆæœï¼Œå†²çªåå­—æ˜¾ç¤ºçº¢è‰²é—ªçƒ
- **å¤å¤æ¸¸æˆåŒ–**ï¼šé‡‡ç”¨8ä½æœºé£æ ¼ï¼Œåˆ†æ®µæ—¶æ’­æ”¾"å’”å—’"éŸ³æ•ˆï¼Œæ‰¾åˆ°æœ€ä¼˜æ–¹æ¡ˆæ—¶æ’­æ”¾é€šå…³éŸ³ä¹ï¼Œæ”¯æŒå•æ­¥è°ƒè¯•æŸ¥çœ‹åˆ†æ®µè¿‡ç¨‹

---

## 2. ç²¾é€‰ä¼˜è´¨é¢˜è§£å‚è€ƒ

**é¢˜è§£ä¸€ (æ¥æºï¼šHPXXZYY)**
* **ç‚¹è¯„**ï¼šè¿™ä»½é¢˜è§£æ€è·¯æ¸…æ™°ï¼Œå°†é—®é¢˜åˆ†è§£ä¸ºæšä¸¾åˆ†æ®µæ–¹æ¡ˆ+å“ˆå¸ŒéªŒè¯ä¸¤ä¸ªæ˜ç¡®æ­¥éª¤ã€‚DFSçŠ¶æ€è®¾è®¡ç®€æ´ï¼ˆå½“å‰å­—æ¯ä½ç½®ã€å·²ç”¨æŒ‰é”®æ•°ï¼‰ï¼Œé€šè¿‡`color+L-sub>=B`è¿›è¡Œæœ‰æ•ˆå‰ªæã€‚å“ˆå¸Œè®¾è®¡é‡‡ç”¨B+1è¿›åˆ¶é¿å…å†²çªï¼Œæ—¶é—´å¤æ‚åº¦O(2^L*nlogn)åœ¨Lâ‰¤26æ—¶å¯è¡Œã€‚ä»£ç ä¸­`CH[0]=CH[1]-1`çš„è¾¹ç•Œå¤„ç†å¾ˆå·§å¦™ï¼Œè¾“å‡ºæ–¹æ¡ˆæ—¶è‡ªåŠ¨åˆå¹¶è¿ç»­å­—æ¯çš„è®¾è®¡éå¸¸å®ç”¨ã€‚

---

## 3. æ ¸å¿ƒéš¾ç‚¹è¾¨æä¸è§£é¢˜ç­–ç•¥

1.  **éš¾ç‚¹ï¼šæšä¸¾è¿ç»­åˆ†æ®µæ–¹æ¡ˆ**
    * **åˆ†æ**ï¼šå¿…é¡»ç¡®ä¿æ¯ä¸ªæŒ‰é”®å¯¹åº”è¿ç»­å­—æ¯æ®µï¼Œä¸”æ°å¥½ä½¿ç”¨Bä¸ªæŒ‰é”®ã€‚DFSä¸­é€šè¿‡ä¸¤ç§é€‰æ‹©å®ç°ï¼š1) å½“å‰å­—æ¯å¼€æ–°æŒ‰é”®ï¼ˆéœ€æ»¡è¶³sub>1ä¸”color<Bï¼‰ 2) å»¶ç»­å½“å‰æŒ‰é”®ï¼ˆéœ€æ»¡è¶³å‰©ä½™å­—æ¯â‰¥å‰©ä½™æŒ‰é”®ï¼‰
    * ğŸ’¡ **å­¦ä¹ ç¬”è®°**ï¼šDFSçŠ¶æ€åº”åŒ…å«å½“å‰ä½ç½®å’Œå·²ç”¨æŒ‰é”®æ•°ï¼Œé€šè¿‡å¯è¡Œæ€§å‰ªæé¿å…æ— æ•ˆæœç´¢
    
2.  **éš¾ç‚¹ï¼šéªŒè¯æ–¹æ¡ˆæœ‰æ•ˆæ€§**
    * **åˆ†æ**ï¼šå°†åå­—è½¬æ¢ä¸º(B+1)è¿›åˆ¶æ•°ï¼ˆé¿å…0å€¼å†²çªï¼‰ï¼Œæ’åºåç»Ÿè®¡åªå‡ºç°ä¸€æ¬¡çš„å“ˆå¸Œå€¼ã€‚æ³¨æ„å•è¯é•¿åº¦â‰¤10ï¼ŒBâ‰¤26ï¼Œå“ˆå¸Œå€¼åœ¨long longèŒƒå›´å†…ä¸æº¢å‡º
    * ğŸ’¡ **å­¦ä¹ ç¬”è®°**ï¼šè¿›åˆ¶å“ˆå¸Œæ˜¯å¤„ç†å­—ç¬¦ä¸²è½¬æ¢çš„åˆ©å™¨ï¼Œä½†éœ€ç¡®ä¿è¿›åˆ¶æ•°>å…ƒç´ ç§ç±»æ•°
    
3.  **éš¾ç‚¹ï¼šæ»¡è¶³ç‰¹æ®Šè¾“å‡ºè¦æ±‚**
    * **åˆ†æ**ï¼šé¢˜ç›®è¦æ±‚"ç¼–å·å°çš„æŒ‰é”®å­—æ¯æ›´å¤š"ã€‚DFSä¼˜å…ˆå°è¯•å¼€æ–°æŒ‰é”®å†å»¶ç»­å½“å‰æŒ‰é”®ï¼Œé…åˆ`tot>=ans`æ›´æ–°æ¡ä»¶ï¼Œå¤©ç„¶æ»¡è¶³æ–¹æ¡ˆå­—å…¸åºè¦æ±‚
    * ğŸ’¡ **å­¦ä¹ ç¬”è®°**ï¼šæœç´¢é¡ºåºå½±å“è§£æ–¹æ¡ˆç‰¹å¾ï¼Œåˆç†è®¾è®¡åˆ†æ”¯é¡ºåºå¯é¿å…é¢å¤–æ¯”è¾ƒ

### âœ¨ è§£é¢˜æŠ€å·§æ€»ç»“
- **åˆ†æ®µé—®é¢˜è½¬åŒ–ä¸ºçŠ¶æ€æœç´¢**ï¼šå°†è¿ç»­åˆ†æ®µæŠ½è±¡ä¸ºDFSçŠ¶æ€æœºï¼Œç”¨ä½ç½®+æ®µæ•°åŒå˜é‡æè¿°
- **è¿›åˆ¶å“ˆå¸Œå¤„ç†åºåˆ—æ˜ å°„**ï¼šé€‰æ‹©å¤§äºå…ƒç´ æ•°é‡çš„è¿›åˆ¶å¯é¿å…å€¼å†²çª
- **è¾¹ç•Œæ¡ä»¶é˜²å¾¡æ€§ç¼–ç¨‹**ï¼šå¦‚`CH[0] = CH[1]-1`ç¡®ä¿è¾“å‡ºé€»è¾‘æ­£ç¡®å¯åŠ¨
- **å‰ªæä¼˜åŒ–æœç´¢æ•ˆç‡**ï¼š`color+L-sub>=B`æå‰ç»ˆæ­¢ä¸å¯èƒ½åˆ†æ”¯

---

## 4. C++æ ¸å¿ƒä»£ç å®ç°èµæ

**é€šç”¨æ ¸å¿ƒå®ç°å‚è€ƒ**
* **è¯´æ˜**ï¼šç»¼åˆé¢˜è§£æ€è·¯ï¼Œå±•ç¤ºå®Œæ•´è§£é¢˜æ¡†æ¶
```cpp
#include <iostream>
#include <cstring>
#include <algorithm>
using namespace std;

// æ ¸å¿ƒå˜é‡ï¼š
int L, B, n;         // å­—æ¯æ•°,æŒ‰é”®æ•°,åå­—æ•°
string str[1001];    // å­˜å‚¨åå­—
int ch[27], best[27];// å½“å‰æ–¹æ¡ˆ/æœ€ä¼˜æ–¹æ¡ˆ
long long hashVal[1001]; // å“ˆå¸Œå€¼å­˜å‚¨

void evaluate() {
    memset(hashVal, 0, sizeof(hashVal));
    // è®¡ç®—æ¯ä¸ªåå­—çš„å“ˆå¸Œå€¼(B+1è¿›åˆ¶)
    for(int i=0; i<n; i++) 
        for(char c : str[i])
            hashVal[i] = hashVal[i]*(B+1) + ch[c-'A'+1];
    
    // æ’åºå¹¶ç»Ÿè®¡å”¯ä¸€å€¼
    sort(hashVal, hashVal+n);
    int uniqueCount = 0;
    for(int i=0; i<n; i++)
        if((i==0 || hashVal[i]!=hashVal[i-1]) && 
           (i==n-1 || hashVal[i]!=hashVal[i+1]))
            uniqueCount++;
    
    // æ›´æ–°æœ€ä¼˜è§£
    if(uniqueCount >= ans) {
        ans = uniqueCount;
        memcpy(best, ch, sizeof(ch));
    }
}

void dfs(int pos, int btnUsed) {
    if(pos > L) {
        if(btnUsed >= B) evaluate();
        return;
    }
    // å°è¯•å¼€æ–°æŒ‰é”®
    if(pos>1 && btnUsed<B) {
        ch[pos] = btnUsed+1;
        dfs(pos+1, btnUsed+1);
    }
    // å»¶ç»­å½“å‰æŒ‰é”®
    if(btnUsed + (L-pos) >= B) {
        ch[pos] = btnUsed;
        dfs(pos+1, btnUsed);
    }
}
```

**é¢˜è§£ä¸€æ ¸å¿ƒç‰‡æ®µèµæ**
```cpp
// DFSæ ¸å¿ƒç‰‡æ®µ
if (sub>1&&color<B){       // æ»¡è¶³å¼€æ–°æŒ‰é”®æ¡ä»¶
    ch[sub]=color+1;      // æ–°æŒ‰é”®ç¼–å·=å½“å‰æŒ‰é”®+1
    dfs(sub+1,color+1);   // é€’å½’å¤„ç†ä¸‹ä¸€å­—æ¯
}
if (color+L-sub>=B){      // æ»¡è¶³å»¶ç»­æ¡ä»¶
    ch[sub]=color;        // å»¶ç»­å½“å‰æŒ‰é”®
    dfs(sub+1,color);     // æŒ‰é”®æ•°ä¸å˜
}
```
> **ä»£ç è§£è¯»**ï¼š  
> 1. `sub>1&&color<B`ç¡®ä¿ä¸æ˜¯é¦–å­—æ¯ä¸”è¿˜æœ‰ç©ºé—²æŒ‰é”®æ—¶æ‰å¼€æ–°æŒ‰é”®  
> 2. `color+L-sub>=B`å‰ªæï¼šå½“å‰æŒ‰é”®å»¶ç»­åï¼Œå‰©ä½™å­—æ¯æ•°â‰¥å‰©ä½™æŒ‰é”®éœ€æ±‚  
> 3. å…ˆå°è¯•å¼€æ–°æŒ‰é”®çš„åˆ†æ”¯ï¼Œä¿è¯åç»­æ–¹æ¡ˆä¸­å‰é¢æŒ‰é”®å­—æ¯æ›´å¤š  

---

## 5. ç®—æ³•å¯è§†åŒ–ï¼šåƒç´ åŠ¨ç”»æ¼”ç¤º

* **ä¸»é¢˜**ï¼šåƒç´ å¥¶ç‰›é”®ç›˜è®¾è®¡å¸ˆ  
* **æ ¸å¿ƒæ¼”ç¤º**ï¼šDFSåˆ†æ®µè¿‡ç¨‹ + åå­—å“ˆå¸ŒéªŒè¯  
* **è®¾è®¡æ€è·¯**ï¼š8ä½æœºé£æ ¼è¥é€ ç¼–ç¨‹é—¯å…³æ„Ÿï¼Œå…³é”®æ“ä½œéŸ³æ•ˆå¼ºåŒ–è®°å¿†  

**åŠ¨ç”»æµç¨‹**ï¼š  
1. **åˆå§‹åŒ–**ï¼š  
   - é¡¶éƒ¨æ˜¾ç¤ºå­—æ¯åºåˆ—ï¼ˆA-Zåƒç´ å—ï¼‰  
   - æ§åˆ¶é¢æ¿ï¼šå¼€å§‹/æš‚åœ/å•æ­¥/é€Ÿåº¦æ»‘å—  
   - èƒŒæ™¯æ’­æ”¾ç‰§åœºé£æ ¼èŠ¯ç‰‡éŸ³ä¹  

2. **DFSè¿‡ç¨‹æ¼”ç¤º**ï¼š  
   ```plaintext
   [A][B][C][D][E][F]...  // åˆå§‹çŠ¶æ€(å…¨æŒ‰é”®1)
   ```
   - **å¼€æ–°æŒ‰é”®**ï¼šå½“å‰å­—æ¯å˜ä¸ºæ–°é¢œè‰²ï¼Œæ’­æ”¾"æŒ‰é”®éŸ³"ï¼Œå³ä¾§æ˜¾ç¤º`æ–°æŒ‰é”®:color+1`  
   - **å»¶ç»­æŒ‰é”®**ï¼šå­—æ¯ä¿æŒå½“å‰é¢œè‰²ï¼Œæ’­æ”¾"è¿æ¥éŸ³"  

3. **æ–¹æ¡ˆéªŒè¯é˜¶æ®µ**ï¼š  
   - åº•éƒ¨æ˜¾ç¤ºåå­—åˆ—è¡¨ï¼ŒæŒ‰å½“å‰åˆ†æ®µæ–¹æ¡ˆç€è‰²å­—æ¯  
   ```plaintext
   CELL â” [2][2][3][3] â” å“ˆå¸Œå€¼=0x2233
   ```
   - å“ˆå¸Œå†²çªæ—¶åå­—é—ªçƒçº¢å…‰ï¼Œå”¯ä¸€åå­—é—ªçƒç»¿å…‰+é‡‘å¸éŸ³æ•ˆ  

4. **æœ€ä¼˜æ–¹æ¡ˆå±•ç¤º**ï¼š  
   - å­—æ¯åºåˆ—æŒ‰æœ€ç»ˆåˆ†æ®µæ˜¾ç¤ºä¸åŒé¢œè‰²åŒºå—  
   - å¼¹å‡º"BEST!"åƒç´ è‰ºæœ¯å­—ï¼Œæ’­æ”¾èƒœåˆ©éŸ³ä¹  
   - ä¾§è¾¹æ æ˜¾ç¤ºå”¯ä¸€åå­—è®¡æ•°å’Œæ–¹æ¡ˆè¯„åˆ†  

---

## 6. æ‹“å±•ç»ƒä¹ ä¸ç›¸ä¼¼é—®é¢˜æ€è€ƒ

* **é€šç”¨æŠ€å·§è¿ç§»**ï¼š  
  1. è¿ç»­åˆ†æ®µé—®é¢˜ï¼ˆå¦‚ä¹¦ç±æ’ç‰ˆã€æ•°æ®åˆ†åŒºï¼‰  
  2. åºåˆ—æ˜ å°„éªŒè¯ï¼ˆå¦‚å¯†ç å­¦ã€æ•°æ®ç¼–ç ï¼‰  
  3. çŠ¶æ€ç©ºé—´æœç´¢ä¼˜åŒ–ï¼ˆæ¸¸æˆAIã€ç»„åˆä¼˜åŒ–ï¼‰  

* **æ´›è°·æ¨è**ï¼š  
  1. P1018 [NOIP2000]ä¹˜ç§¯æœ€å¤§  
     - æ¨èç†ç”±ï¼šåŒæ ·éœ€è¦åˆ’åˆ†æ•°å­—ä¸²ä¸ºè¿ç»­æ®µæ±‚æœ€ä¼˜è§£ï¼Œå·©å›ºDFSå†³ç­–  
  2. P1063 [NOIP2006]èƒ½é‡é¡¹é“¾  
     - æ¨èç†ç”±ï¼šç¯å½¢åŒºé—´DPï¼Œæ·±åŒ–åˆ†æ®µé—®é¢˜ç†è§£  
  3. P1103 ä¹¦æœ¬æ•´ç†  
     - æ¨èç†ç”±ï¼šçº¿æ€§DPå¤„ç†è¿ç»­åˆ†æ®µæœ€å€¼é—®é¢˜  

---

> æœ¬æ¬¡è§£æé€šè¿‡åˆ†è§£é—®é¢˜æœ¬è´¨ã€ä¼˜åŒ–æœç´¢ç­–ç•¥ã€å·§ç”¨å“ˆå¸ŒéªŒè¯ï¼Œå±•ç°äº†ç®—æ³•è®¾è®¡çš„ç²¾å¦™ä¹‹å¤„ã€‚è®°ä½ï¼šå¥½ç®—æ³•=æ¸…æ™°çš„é—®é¢˜å»ºæ¨¡+é«˜æ•ˆçš„æ‰§è¡Œç­–ç•¥+ä¸¥è°¨çš„éªŒè¯æ–¹æ³•ï¼ ğŸš€

---
å¤„ç†ç”¨æ—¶ï¼š204.84ç§’
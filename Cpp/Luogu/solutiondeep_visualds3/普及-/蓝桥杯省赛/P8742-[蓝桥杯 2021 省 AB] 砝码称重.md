# 题目信息

# [蓝桥杯 2021 省 AB] 砝码称重

## 题目描述

你有一架天平和 $N$ 个砝码, 这 $N$ 个砝码重量依次是 $W_{1}, W_{2}, \cdots, W_{N}$ 。 请你计算一共可以称出多少种不同的重量?

注意砝码可以放在天平两边。


## 说明/提示

**【样例说明】**

能称出的 10 种重量是: $1 、 2 、 3 、 4 、 5 、 6 、 7 、 9 、 10 、 11$ 。

$$
\begin{aligned}
&1=1 \\
&2=6-4(\text { 天平一边放 } 6, \text { 另一边放 4) } \\
&3=4-1 \\
&4=4 \\
&5=6-1 \\
&6=6 \\
&7=1+6 \\
&9=4+6-1 \\
&10=4+6 \\
&11=1+4+6
\end{aligned}
$$

**【评测用例规模与约定】**

对于 $50 \%$ 的评测用例, $1 \leq N \leq 15$ 。

对于所有评测用例, $1 \leq N \leq 100, N$ 个砝码总重不超过 $10^5$。 

蓝桥杯 2021 第一轮省赛 A 组 F 题（B 组 G 题）。

## 样例 #1

### 输入

```
3
1 4 6```

### 输出

```
10```

# AI分析结果


### 💡 Kay的C++算法解析：砝码称重 深入学习指南 💡

#### 题目解读与核心算法识别
✨ **本题主要考察**：**动态规划（01背包变种）**  
🗣️ **初步分析**：  
> 砝码称重问题本质是**带符号选择的01背包**。想象你有一台复古游戏机🎮，每个砝码是道具卡：可放左盘（+重量）、右盘（-重量）或不使用。目标是通过组合道具卡点亮所有可能的"重量关卡"。  
- **核心难点**：处理负重量（需偏移量/绝对值）和三种决策路径（+/ -/ 跳过）
- **优质解法**：均用DP，但实现不同——ryf_loser直接四状态判断；123xiayicheng分两步转移；千早爱音用bitset位运算优化
- **可视化设计**：像素天平两侧放置砝码，当前决策砝码高亮闪烁，称出重量时对应数字方块发光💡，音效设计：
  - ✅成功称重：8-bit胜利音效🎵
  - ➕加砝码："叮"声
  ➖减砝码："咚"声

---

#### 精选优质题解参考
**题解一（ryf_loser）**  
* **点评**：四状态转移直击本质，逻辑清晰如游戏教程。`dp[i][j]`定义精准（前i砝码能否称j），循环内四个`if`覆盖所有决策。代码规范（`sum`提前计算），但空间可优化为滚动数组。亮点：将物理问题转化为简洁状态判断，边界处理严谨（`abs(j-w[i])`防负下标）。

**题解二（123xiayicheng）**  
* **点评**：创新性分两步处理——先加砝码再减砝码，类似游戏分关卡教学。`dp[j]`一维数组节省空间，两个独立循环对应两种决策（放左/放右）。亮点：通过P2347类似题铺垫思路，变量名`sum`语义明确，实践时需注意`j`范围控制防止越界。

**题解三（千早爱音）**  
* **点评**：用`bitset`实现炫技级优化，188B代码展现C++精髓！`d<<a[i]`实现加操作，`d>>a[i]`实现减操作，位运算如游戏组合技⚡️。亮点：时间复杂度骤降至O(nΣw_i/64)，适合大数据量，但需理解bitset底层原理。

---

#### 核心难点辨析与解题策略
1. **负重量处理**  
   * **分析**：当j<w[i]时`j-w[i]`为负。ryf_loser用`abs`转换，RP_INT_MAX用偏移量+N，本质都是映射到合法下标
   * 💡学习笔记：负重量=镜像正重量，物理意义是砝码换盘

2. **状态转移设计**  
   * **分析**：必须同时考虑三种决策：
     - 不选：`dp[i][j] = dp[i-1][j]`
     - 加砝码：`dp[i][j] |= dp[i-1][j-w[i]]` 
     - 减砝码：`dp[i][j] |= dp[i-1][j+w[i]]` 
   * 💡学习笔记：类比RPG游戏技能树，每个砝码是技能点，点亮新重量路径

3. **空间优化技巧**  
   * **分析**：千早爱音的bitset将操作压缩到位级；滚动数组（RP_INT_MAX的`f[i&1]`)避免MLE
   * 💡学习笔记：大数据量首选bitset，竞赛场景可用滚动数组

### ✨ 解题技巧总结
- **状态定义**：`dp[i][j]`表示前i个物品达成j状态的可行性
- **降维打击**：bitset优化使转移O(1)
- **边界锚点**：初始化`dp[0][0]=1`代表空天平
- **偏移量法**：加N解决负下标，如`j+N`映射到正数

---

#### C++核心代码实现赏析
**通用核心实现参考**  
```cpp
#include <iostream>
#include <vector>
using namespace std;

int main() {
    int n, sum = 0;
    cin >> n;
    vector<int> w(n+1);
    for(int i=1; i<=n; i++) {
        cin >> w[i];
        sum += w[i];
    }
    
    vector<vector<bool>> dp(2, vector<bool>(2*sum+1, false));
    dp[0][sum] = true; // 偏移量sum对应重量0
    
    for(int i=1; i<=n; i++) {
        int cur = i%2, prev = 1-cur;
        for(int j=0; j<=2*sum; j++) {
            dp[cur][j] = dp[prev][j]; // 不选
            if(j >= w[i]) dp[cur][j] = dp[cur][j] || dp[prev][j-w[i]]; // 加
            if(j+w[i] <= 2*sum) dp[cur][j] = dp[cur][j] || dp[prev][j+w[i]]; // 减
        }
    }
    
    int ans = 0;
    for(int j=sum+1; j<=2*sum; j++) // 统计正重量
        if(dp[n%2][j]) ans++;
    cout << ans;
}
```
**代码解读概要**：  
> 通过滚动数组`dp[2]`节省空间。偏移量sum解决负下标问题，三重状态转移对应三种选择。最终遍历统计所有可达正重量。

---

**题解片段赏析**  
**ryf_loser**  
```cpp
for(int j=sum; j; j--) {
    if(j==w[i]) dp[i][j]=1;
    else if(dp[i-1][j]) dp[i][j]=1;
    else if(dp[i-1][j+w[i]]) dp[i][j]=1;
    else if(dp[i-1][abs(j-w[i])]) dp[i][j]=1;
}
```
**亮点**：四分支覆盖所有决策路径  
**学习笔记**：`abs(j-w[i])`巧妙避免负下标，逻辑完备如游戏通关条件✅

**千早爱音**  
```cpp
bitset<100010> d;
d.set(0);
for(int i=1;i<=n;i++)
    d |= d << a[i];   // 加操作
for(int i=1;i<=n;i++)
    d |= d >> a[i];   // 减操作
```
**亮点**：位运算实现降维打击  
**学习笔记**：左移=加砝码，右移=减砝码，bitset如同游戏中的连锁反应技能🔥

---

#### 算法可视化：像素动画演示  
**主题**：🎮《天平勇士：砝码远征》  
**核心演示**：像素小人将砝码放入左右托盘，实时显示可称出重量集合  

**动画帧设计**：  
1. **场景**：8-bit天平，左侧蓝色托盘，右侧红色托盘，底部显示`bitset`点亮状态  
2. **砝码放置**：  
   - ▶️ 当前砝码高亮闪烁，选择左盘时蓝色飞入动画+“叮”声  
   - ▶️ 选择右盘时红色飞入动画+“咚”声  
3. **重量集合更新**：  
   - 新重量达成时，顶部数字方块弹出+🎵胜利音效  
   - 显示当前`bitset`状态（如`00010111`代表重量1,2,4可达）  
4. **控制面板**：  
   - 单步执行：按A键逐步放置  
   - 自动演示：B键触发AI自动通关（速度可调）  
5. **关卡设计**：每加入一个砝码视为一小关，通关时显示解锁重量数  

**设计意义**：通过视觉化`bitset`的位变化和砝码物理运动，直观理解状态转移本质  

---

#### 拓展练习与相似问题思考
1. **P2347 砝码称重**  
   → 基础版，巩固01背包可行性判断  
2. **P1284 货币系统**  
   → 变种完全背包，强化状态转移思维  
3. **P1272 道路游戏**  
   → 复杂状态设计，提升DP建模能力  

---

#### 学习心得与经验分享
> **ryf_loser的调试经验**：  
> *"最初未考虑j<w[i]导致越界，用abs后才AC"*  
>  
> **Kay总结**：  
> 处理减法时务必用`abs`或偏移量，这是该问题的核心边界陷阱！建议单步调试验证j-w[i]为负时的情况。

---  
通过本指南，相信你已掌握砝码称重的动态规划解法精髓。记住：好的状态设计如同游戏地图规划，决定通关效率！🚀

---
处理用时：97.92秒
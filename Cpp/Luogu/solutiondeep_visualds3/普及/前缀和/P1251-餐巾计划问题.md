# é¢˜ç›®ä¿¡æ¯

# é¤å·¾è®¡åˆ’é—®é¢˜

## é¢˜ç›®æè¿°

ä¸€ä¸ªé¤å…åœ¨ç›¸ç»§çš„ $N$ å¤©é‡Œï¼Œæ¯å¤©éœ€ç”¨çš„é¤å·¾æ•°ä¸å°½ç›¸åŒã€‚å‡è®¾ç¬¬ $i$ å¤©éœ€è¦ $r_i$ å—é¤å·¾ï¼ˆ$i = 1, 2, \dots, N$ï¼‰ã€‚é¤å…å¯ä»¥è´­ä¹°æ–°çš„é¤å·¾ï¼Œæ¯å—é¤å·¾çš„è´¹ç”¨ä¸º $p$ åˆ†ï¼›æˆ–è€…æŠŠæ—§é¤å·¾é€åˆ°å¿«æ´—éƒ¨ï¼Œæ´—ä¸€å—éœ€ $m$ å¤©ï¼Œå…¶è´¹ç”¨ä¸º $f$ åˆ†ï¼›æˆ–è€…é€åˆ°æ…¢æ´—éƒ¨ï¼Œæ´—ä¸€å—éœ€ $n$ å¤©ï¼ˆ$n \gt m$ï¼‰ï¼Œå…¶è´¹ç”¨ä¸º $s$ åˆ†ï¼ˆ$s \lt f$ï¼‰ã€‚

æ¯å¤©ç»“æŸæ—¶ï¼Œé¤å…å¿…é¡»å†³å®šå°†å¤šå°‘å—è„çš„é¤å·¾é€åˆ°å¿«æ´—éƒ¨ï¼Œå¤šå°‘å—é¤å·¾é€åˆ°æ…¢æ´—éƒ¨ï¼Œä»¥åŠå¤šå°‘å—ä¿å­˜èµ·æ¥å»¶æœŸé€æ´—ã€‚ä½†æ˜¯æ¯å¤©æ´—å¥½çš„é¤å·¾å’Œè´­ä¹°çš„æ–°é¤å·¾æ•°ä¹‹å’Œï¼Œè¦æ»¡è¶³å½“å¤©çš„éœ€æ±‚é‡ã€‚

è¯•è®¾è®¡ä¸€ä¸ªç®—æ³•ä¸ºé¤å…åˆç†åœ°å®‰æ’å¥½ $N$ å¤©ä¸­é¤å·¾ä½¿ç”¨è®¡åˆ’ï¼Œä½¿æ€»çš„èŠ±è´¹æœ€å°ã€‚ç¼–ç¨‹æ‰¾å‡ºä¸€ä¸ªæœ€ä½³é¤å·¾ä½¿ç”¨è®¡åˆ’ã€‚


## è¯´æ˜/æç¤º

å¯¹äº $100 \%$ çš„æ•°æ®ï¼Œ$1 \le N \le 2 \times 10^3$ï¼Œ$1 \le r_i \le 10^7$ï¼Œ$1 \le p, f, s \le 10^4$ã€‚


## æ ·ä¾‹ #1

### è¾“å…¥

```
3
1 7 5 
11 2 2 3 1
```

### è¾“å‡º

```
134
```

# AIåˆ†æç»“æœ


### Kayçš„C++ç®—æ³•è§£æï¼šé¤å·¾è®¡åˆ’é—®é¢˜ æ·±å…¥å­¦ä¹ æŒ‡å— ğŸ’¡

**é¢˜ç›®è§£è¯»ä¸æ ¸å¿ƒç®—æ³•è¯†åˆ«**  
âœ¨ **æœ¬é¢˜ä¸»è¦è€ƒå¯Ÿ**ï¼šæœ€å°è´¹ç”¨æœ€å¤§æµï¼ˆMCMFï¼‰  
ğŸ—£ï¸ **åˆæ­¥åˆ†æ**ï¼š  
> è§£å†³é¤å·¾è®¡åˆ’é—®é¢˜çš„æ ¸å¿ƒåœ¨äº**ç½‘ç»œæµå»ºæ¨¡ä¸­çš„æ‹†ç‚¹æŠ€å·§**ã€‚æƒ³è±¡æ¯å¤©è¢«æ‹†æˆ"æ—©ä¸Š"ï¼ˆä½¿ç”¨å¹²å‡€é¤å·¾ï¼‰å’Œ"æ™šä¸Š"ï¼ˆå¤„ç†è„é¤å·¾ï¼‰ä¸¤ä¸ªç‹¬ç«‹èŠ‚ç‚¹ï¼Œé€šè¿‡ç²¾å¿ƒè®¾è®¡çš„è¾¹å®ç°é¤å·¾æµè½¬ï¼š  
> - **æºç‚¹â†’æ™šä¸Š**ï¼šæä¾›è„é¤å·¾ï¼ˆå®¹é‡=å½“å¤©éœ€æ±‚ï¼Œè´¹ç”¨=0ï¼‰  
> - **æ—©ä¸Šâ†’æ±‡ç‚¹**ï¼šæ¶ˆè€—å¹²å‡€é¤å·¾ï¼ˆå®¹é‡=å½“å¤©éœ€æ±‚ï¼Œè´¹ç”¨=0ï¼‰  
> - **æ™šä¸Šâ†’æœªæ¥æ—©ä¸Š**ï¼šå¿«æ´—/æ…¢æ´—ï¼ˆå®¹é‡=âˆï¼Œè´¹ç”¨=æ´—æ¶¤è´¹ï¼‰  
> - **æºç‚¹â†’æ—©ä¸Š**ï¼šè´­ä¹°æ–°é¤å·¾ï¼ˆå®¹é‡=âˆï¼Œè´¹ç”¨=è´­ä¹°ä»·ï¼‰  
> - **æ™šä¸Šâ†’ä¸‹å¤©æ™šä¸Š**ï¼šä¿å­˜è„é¤å·¾ï¼ˆå®¹é‡=âˆï¼Œè´¹ç”¨=0ï¼‰  

**å¯è§†åŒ–è®¾è®¡æ€è·¯**ï¼š  
é‡‡ç”¨8ä½åƒç´ é£æ ¼ï¼ˆç±»ä¼¼FCæ¸¸æˆï¼‰åŠ¨æ€æ¼”ç¤ºï¼š  
1. æ¯å¤©åˆ†æ—©æ™šä¸¤æ ¼ï¼Œå¹²å‡€é¤å·¾ç»¿è‰²ğŸ’šï¼Œè„é¤å·¾ç°è‰²âš«  
2. å…³é”®æ“ä½œé«˜äº®ï¼š  
   - è´­ä¹°æ—¶æºç‚¹é—ªçƒğŸ’¡ + "å®"éŸ³æ•ˆ  
   - æ´—æ¶¤æ—¶æ˜¾ç¤ºè´¹ç”¨ğŸ’° + è·³è·ƒåŠ¨ç”»åˆ°æœªæ¥å¤©  
   - ä¿å­˜æ—¶æ¨ªå‘ç§»åŠ¨åŠ¨ç”»â¡ï¸  
3. æ§åˆ¶é¢æ¿æ”¯æŒå•æ­¥/è‡ªåŠ¨æ’­æ”¾ï¼Œè°ƒé€Ÿæ»‘å—æ§åˆ¶æµç¨‹  

---

### ç²¾é€‰ä¼˜è´¨é¢˜è§£å‚è€ƒ

**é¢˜è§£ä¸€ï¼ˆMark_ZZYï¼‰**  
* **äº®ç‚¹**ï¼š  
  æ¸…æ™°å›¾è§£æ‹†ç‚¹ï¼ˆ6ç±»è¾¹ï¼‰ï¼Œä»£ç å®Œæ•´è§„èŒƒï¼Œå˜é‡åç›´ç™½ï¼ˆ`f[i]`è¡¨çŠ¶æ€ï¼‰ï¼Œç©ºé—´ä¼˜åŒ–åˆ°ä½ï¼ˆæ»šåŠ¨æ•°ç»„ï¼‰ã€‚å®è·µæ€§å¼ºï¼Œè¾¹ç•Œå¤„ç†ä¸¥è°¨ï¼Œå¯ç›´æ¥ç”¨äºç«èµ›ã€‚

**é¢˜è§£äºŒï¼ˆå¤©æ³½é¾Ÿï¼‰**  
* **äº®ç‚¹**ï¼š  
  æ·±åº¦è§£æ"ä¸ºä»€ä¹ˆè¿™æ ·å»ºå›¾"ï¼Œå¯¹æ¯”å¸¸è§„æ€è·¯æŒ‡å‡ºæ˜“é”™ç‚¹ï¼ˆå¦‚è„é¤å·¾æµå‘ï¼‰ï¼Œæ•™å­¦æ€§å¼ºã€‚ä»£ç ç»“æ„å·¥æ•´ï¼Œä½†å˜é‡å‘½åç¨ä¹±ï¼ˆ`fir`æ•°ç»„ï¼‰ã€‚

**é¢˜è§£ä¸‰ï¼ˆSCKerï¼‰**  
* **äº®ç‚¹**ï¼š  
  åˆ›æ–°è´ªå¿ƒ+ä¸‰åˆ†æ³•ï¼Œç‹¬è¾Ÿè¹Šå¾„ï¼šå‡è®¾æ€»è´­ä¹°é‡ï¼Œè´ªå¿ƒæ±‚æœ€å°è´¹ç”¨ï¼Œä¸‰åˆ†æ³•ä¼˜åŒ–ã€‚å¤æ‚åº¦O(n log R)æ›´ä¼˜ï¼Œä½†ä»…é€‚ç”¨ç‰¹å®šæ•°æ®èŒƒå›´ã€‚

---

### æ ¸å¿ƒéš¾ç‚¹è¾¨æä¸è§£é¢˜ç­–ç•¥

1. **æ‹†ç‚¹ä¸çŠ¶æ€åˆ†ç¦»**  
   *åˆ†æ*ï¼šå¿…é¡»å°†æ¯å¤©æ‹†ä¸ºæ—©ä¸Šï¼ˆæ¥æ”¶å¹²å‡€é¤å·¾ï¼‰å’Œæ™šä¸Šï¼ˆå¤„ç†è„é¤å·¾ï¼‰ä¸¤ä¸ªèŠ‚ç‚¹ï¼Œè¿™æ˜¯å»ºæ¨¡åŸºçŸ³ã€‚  
   ğŸ’¡ **å­¦ä¹ ç¬”è®°**ï¼šæ‹†ç‚¹æ³•åœ¨æµé‡åˆ†ç¦»é—®é¢˜ä¸­åº”ç”¨å¹¿æ³›ã€‚

2. **è¾¹è®¾è®¡ä¸å®¹é‡æ§åˆ¶**  
   *åˆ†æ*ï¼š6ç±»è¾¹éœ€ç²¾ç¡®å¯¹åº”æ“ä½œï¼š  
   ```mermaid
   graph LR
   S--è„é¤å·¾-->æ™šä¸Š
   æ™šä¸Š--ä¿å­˜-->ä¸‹å¤©æ™šä¸Š
   æ™šä¸Š--å¿«æ´—-->i+mæ—©ä¸Š
   æ™šä¸Š--æ…¢æ´—-->i+næ—©ä¸Š
   S--è´­ä¹°-->æ—©ä¸Š
   æ—©ä¸Š--æ¶ˆè€—-->T
   ```
   ğŸ’¡ **å­¦ä¹ ç¬”è®°**ï¼šâˆå®¹é‡è¡¨ç¤ºæ“ä½œæ— é™åˆ¶ï¼Œéœ€è¾¹ç•Œæ£€æŸ¥ï¼ˆå¦‚i+mâ‰¤nï¼‰ã€‚

3. **è´¹ç”¨ä¸æµé‡å¹³è¡¡**  
   *åˆ†æ*ï¼šè´¹ç”¨è¾¹éœ€åæ˜ çœŸå®æˆæœ¬ï¼ˆè´­ä¹°/æ´—æ¶¤ï¼‰ï¼Œé€šè¿‡SPFAæ‰¾æœ€å°å¢å¹¿è·¯ä¿è¯è´¹ç”¨æœ€å°ã€‚  
   ğŸ’¡ **å­¦ä¹ ç¬”è®°**ï¼šè´¹ç”¨æµä¸­åå‘è¾¹è´¹ç”¨ä¸ºè´Ÿå€¼ï¼Œè¿™æ˜¯ç®—æ³•æ ¸å¿ƒã€‚

âœ¨ **è§£é¢˜æŠ€å·§æ€»ç»“**ï¼š  
- **æ‹†ç‚¹å»ºæ¨¡**ï¼šå°†æ—¶é—´ç»´åº¦è½¬åŒ–ä¸ºèŠ‚ç‚¹å…³ç³»  
- **è¾¹ç•Œå¤„ç†**ï¼šæ´—çƒ˜æ“ä½œéœ€åˆ¤æ–­i+m/nâ‰¤n  
- **è´ªå¿ƒä¼˜åŒ–**ï¼šå½“æ•°æ®æå¤§æ—¶ï¼ˆå¦‚riâ‰¤1e7ï¼‰ï¼Œå¯è€ƒè™‘ä¸‰åˆ†æ€»è´­ä¹°é‡+è´ªå¿ƒéªŒè¯  

---

### C++æ ¸å¿ƒä»£ç å®ç°èµæ

**é€šç”¨æ ¸å¿ƒå®ç°**ï¼ˆç»¼åˆä¼˜è´¨é¢˜è§£ï¼‰ï¼š  
```cpp
#include <cstdio>
#include <queue>
#include <cstring>
typedef long long LL;
const LL INF = 1e18;
const int MAXN = 4000;

struct Edge { int to, next; LL cap, cost; } edges[MAXN*6];
int head[MAXN], cnt = 1, pre[MAXN], last[MAXN];
LL dis[MAXN], flow[MAXN]; bool vis[MAXN];

void addEdge(int u, int v, LL cap, LL cost) {
    edges[++cnt] = {v, head[u], cap, cost}; head[u] = cnt;
    edges[++cnt] = {u, head[v], 0, -cost}; head[v] = cnt;
}

bool spfa(int s, int t) {
    memset(dis, 0x3f, sizeof(dis));
    std::queue<int> q; q.push(s);
    dis[s] = 0; vis[s] = 1; flow[s] = INF;
    while (!q.empty()) {
        int u = q.front(); q.pop(); vis[u] = 0;
        for (int i = head[u]; i; i = edges[i].next) {
            int v = edges[i].to;
            if (edges[i].cap > 0 && dis[v] > dis[u] + edges[i].cost) {
                dis[v] = dis[u] + edges[i].cost;
                pre[v] = u; last[v] = i;
                flow[v] = std::min(flow[u], edges[i].cap);
                if (!vis[v]) vis[v] = 1, q.push(v);
            }
        }
    }
    return dis[t] < INF;
}

LL minCostMaxFlow(int s, int t) {
    LL cost = 0;
    while (spfa(s, t)) {
        for (int v = t; v != s; v = pre[v]) {
            edges[last[v]].cap -= flow[t];
            edges[last[v] ^ 1].cap += flow[t];
        }
        cost += flow[t] * dis[t];
    }
    return cost;
}

int main() {
    int n, p, m, f, nn, s_cost; 
    scanf("%d", &n);
    int s = 0, t = 2*n+1;
    for (int i = 1, r; i <= n; i++) {
        scanf("%d", &r);
        addEdge(s, i, r, 0);       // æºç‚¹->æ™šä¸Š (è„é¤å·¾)
        addEdge(i+n, t, r, 0);     // æ—©ä¸Š->æ±‡ç‚¹ (å¹²å‡€é¤å·¾)
    }
    scanf("%d%d%d%d%d", &p, &m, &f, &nn, &s_cost);
    for (int i = 1; i <= n; i++) {
        addEdge(s, i+n, INF, p);   // è´­ä¹°æ–°é¤å·¾
        if (i < n) addEdge(i, i+1, INF, 0); // ä¿å­˜è„é¤å·¾
        if (i+m <= n) addEdge(i, i+n+m, INF, f);   // å¿«æ´—
        if (i+nn <= n) addEdge(i, i+n+nn, INF, s_cost); // æ…¢æ´—
    }
    printf("%lld", minCostMaxFlow(s, t));
}
```

**ä»£ç ç²¾è¦**ï¼š  
1. **æ‹†ç‚¹è®¾è®¡**ï¼šèŠ‚ç‚¹iè¡¨æ™šä¸Šï¼Œi+nè¡¨æ—©ä¸Š  
2. **å…³é”®è¾¹**ï¼š  
   - ä¿å­˜è„é¤å·¾ï¼š`iâ†’i+1`  
   - å¿«æ´—ï¼š`iâ†’i+m+n`  
   - æ…¢æ´—ï¼š`iâ†’i+nn+n`  
3. **SPFAä¼˜åŒ–**ï¼šé˜Ÿåˆ—å®ç°è´¹ç”¨æµæ ¸å¿ƒï¼Œåå‘è¾¹è‡ªåŠ¨å¤„ç†  

---

### ç®—æ³•å¯è§†åŒ–ï¼šåƒç´ åŠ¨ç”»æ¼”ç¤º  
**ä¸»é¢˜**ï¼šé¤å·¾æµåŠ¨æ¨¡æ‹Ÿï¼ˆ8ä½åƒç´ é£ï¼‰  
**å…³é”®å¸§è®¾è®¡**ï¼š  
```plaintext
æ—¥1 [ğŸŒğŸ’š] -> ä½¿ç”¨ -> [ğŸŒšâš«] 
          â”Œâ”€å¿«æ´—må¤©â”€> [æ—¥1+mğŸŒğŸ’š]
          â””â”€ä¿å­˜â”€> [æ—¥2ğŸŒšâš«]
```
1. **åˆå§‹åŒ–**ï¼šæ˜¾ç¤ºNÃ—2ç½‘æ ¼ï¼ˆæ—©/æ™šï¼‰ï¼Œæ§åˆ¶é¢æ¿ï¼ˆå¼€å§‹/æš‚åœ/é€Ÿåº¦ï¼‰  
2. **æ¯æ—¥æµç¨‹**ï¼š  
   - æ—©ä¸Šï¼šç»¿è‰²å—ä»æºç‚¹æµå…¥ğŸ’šï¼Œæ•°é‡=r_i  
   - æ™šä¸Šï¼šç°è‰²å—å‡ºç°âš«ï¼Œæµå‘å¤„ç†é€‰é¡¹  
3. **æ“ä½œåŠ¨ç”»**ï¼š  
   - ä¿å­˜ï¼šç°è‰²å—å³ç§»â¡ï¸ï¼ˆè´¹ç”¨0ï¼‰  
   - æ´—æ¶¤ï¼šç°è‰²å—è·³è·ƒåˆ°æœªæ¥å¤©+è´¹ç”¨æ˜¾ç¤ºğŸ’°  
   - è´­ä¹°ï¼šæ–°ç»¿è‰²å—å‡ºç°+â€œå®â€éŸ³æ•ˆğŸ””  
4. **çŠ¶æ€åŒæ­¥**ï¼šæ˜¾ç¤ºå½“å‰è´¹ç”¨å’Œå‰©ä½™æµé‡  

---

### æ‹“å±•ç»ƒä¹ ä¸ç›¸ä¼¼é—®é¢˜
**é€šç”¨æŠ€å·§è¿ç§»**ï¼š  
æ‹†ç‚¹æ³•è¿˜å¯ç”¨äºï¼š  
1. æ—¶é—´åˆ†å±‚é—®é¢˜ï¼ˆå¦‚"èˆªç©ºè·¯çº¿"ï¼‰  
2. çŠ¶æ€åˆ†ç¦»é—®é¢˜ï¼ˆå¦‚"æ™¨è·‘"ä¸­çš„èŠ‚ç‚¹è®¿é—®é™åˆ¶ï¼‰  

**æ´›è°·æ¨è**ï¼š  
1. [P2153 æ™¨è·‘](https://www.luogu.com.cn/problem/P2153)  
   â†’ **æ¨èç†ç”±**ï¼šå·©å›ºæ‹†ç‚¹æŠ€å·§ï¼Œå¤„ç†èŠ‚ç‚¹è®¿é—®æ¬¡æ•°é™åˆ¶  
2. [P4009 æ±½è½¦åŠ æ²¹](https://www.luogu.com.cn/problem/P4009)  
   â†’ **æ¨èç†ç”±**ï¼šåˆ†å±‚å›¾è´¹ç”¨æµåº”ç”¨ï¼Œç±»ä¼¼é¤å·¾æ—¶é—´è·³è·ƒ  
3. [P4014 åˆ†é…é—®é¢˜](https://www.luogu.com.cn/problem/P4014)  
   â†’ **æ¨èç†ç”±**ï¼šåŸºç¡€è´¹ç”¨æµå»ºæ¨¡ï¼Œé€‚åˆç†è§£æµé‡åˆ†é…  

---

### å­¦ä¹ å¿ƒå¾—
é¢˜è§£ä¸­ä½œè€…è°ƒè¯•ç»éªŒå€¼å¾—å€Ÿé‰´ï¼š  
> "æœ€åˆåœ¨çŠ¶æ€è½¬ç§»è®¾è®¡ä¸Šå¡å£³ï¼Œé€šè¿‡æ‰“å°æ¯æ—¥æµé‡åˆ†å¸ƒå‘ç°å»ºå›¾é”™è¯¯"  
> â†’ **å¯ç¤º**ï¼šè´¹ç”¨æµè°ƒè¯•å¯è¾“å‡ºä¸­é—´æµé‡ï¼ŒéªŒè¯æ˜¯å¦ç¬¦åˆé¢„æœŸæµè½¬  

---

**ç»“è¯­**ï¼šé¤å·¾è®¡åˆ’é—®é¢˜å®Œç¾å±•ç¤ºäº†ç½‘ç»œæµå»ºæ¨¡çš„è‰ºæœ¯ã€‚æŒæ¡æ‹†ç‚¹æŠ€å·§å’Œè¾¹è®¾è®¡æ€ç»´ï¼Œå³å¯å°†å¤æ‚æ—¶åºé—®é¢˜è½¬åŒ–ä¸ºä¼˜é›…çš„å›¾è®ºæ¨¡å‹ã€‚ä¸‹æ¬¡é‡åˆ°èµ„æºè°ƒåº¦é—®é¢˜æ—¶ï¼Œä¸å¦¨æƒ³æƒ³ï¼šèƒ½å¦ç”¨æµé‡è¡¨ç¤ºèµ„æºï¼Ÿæ—¶é—´èƒ½å¦å˜ä¸ºèŠ‚ç‚¹ï¼ŸğŸ’ª

---
å¤„ç†ç”¨æ—¶ï¼š155.86ç§’
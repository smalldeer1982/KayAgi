# 题目信息

# [DMOI-R1] 柯基棋

## 题目背景

小 A 和小 B 都是爱狗人士，且绝顶聪明，尤其喜爱柯基，于是他们发明了“柯基棋”。

## 题目描述

小 A 和小 B 在一个 $n \times n$ 的棋盘内轮流下棋。小 A 先手，小 B 后手。设当前有一只“柯基”被下在了棋盘的 $(x,y)$ 处，那么棋盘内的 $(x-1,y-1)$，$(x-1,y+1)$，$(x+1,y-1)$，$(x+1,y+1)$ 处都会变为这只“柯基”的地盘，也就不能再放一只“柯基”。当一个人不能再放下一只“柯基”时，他就输了。

可惜，小 C 却不怎么喜欢柯基，所以他很反对小 A 和小 B 玩“柯基”棋，于是他非常喜欢捣乱棋局。当小 A 和小 B 一共下了 $x_i$ 只“柯基”时，小 C 就会以当前 $w \times w$ 棋盘的中心为中心，扩大棋盘为 $(w+2) \times (w+2)$，他一共会捣乱 $q$ 次。

而你的任务是要判断这局棋是小 A 赢还是小 B 赢，如果小 A  赢，输出 `A won`，否则输出 `B won`。

由于他们两个人比较贪玩，所以他们一共会玩 $T$ 局。

**注意**：

1. 当小 A 和小 B 已经将原来的棋盘下到不能再下时，他们会直接跳转到小 C 下一次的捣乱（如果有）。

2. 小 A 和小 B 知道小 C 会捣乱，且会按照自己的最优策略走。

由于数据过大，$x_i$ 由数据随机生成器给出。

## 说明/提示

### 随机数据生成器

每一轮游戏的 $x_i$ 由下方的生成器给出：

```cpp
unsigned long long x[10000005];
unsigned long long xor_shift(unsigned long long &seed){
  return seed^=seed>>12, seed^=seed<<25, seed^=seed>>27, seed*0x2545F4914F6CDD1D;
}
int main(){
  //your code here
  int n,q;
  unsigned long long seed;
  cin>>n>>q>>seed;
  for(int i=1;i<=q;i++){
	x[i]=x[i-1]+((xor_shift(seed)%(unsigned long long)(2*2)+1))*2;
  }
  //your code here
  return 0;
}
```

### 样例解释

对于第一局游戏，$x_i$ 数组如下：`6 8 16 18 22`。

对于第二局游戏，$x_i$ 数组如下：`8 14 16 24 32 36 38 40`。

对于第三局游戏，$x_i$ 数组如下：`4 8 10 16`。

### 数据范围

对于 $20\%$ 的数据，$n,q\leq100$。

对于 $50\%$ 的数据，$n,q\leq10000$。

对于 $100\%$ 的数据，$1 \le T \le 10,2\leq n,q,\sum q \leq 10^7$，$x_i \equiv 0 \pmod 2\ (i\in[1,q]),0 \le seed \le 10^7$。


## 样例 #1

### 输入

```
3
2 5 493
3 8 3219
8 4 1294```

### 输出

```
B won
A won
B won```

# AI分析结果


### 💡 Kay的C++算法解析：柯基棋 深入学习指南 💡

#### 1. 题目解读与核心算法识别  
✨ **本题主要考察**：`博弈论与对称策略`  

🗣️ **初步分析**：  
> 柯基棋本质是**对称策略博弈**问题。想象棋盘是面镜子：当n为奇数时，小A占据"镜心"（中心点），后续每一步都镜像反射小B的落子；当n为偶数时，小B成为"镜像大师"，每一步复制小A的动作。小C的捣乱如同给棋盘加个边框——**改变尺寸但不改变对称本质**。  

**可视化设计**：  
- 采用**8位像素风格**棋盘（类似经典推箱子游戏）  
- 落子时播放复古音效（小A：中音"叮"；小B：高音"咚"）  
- 关键动画：  
  - 奇数棋盘：中心点**脉冲闪光** → 后续落子**旋转对称**动画  
  - 偶数棋盘：落子后立即显示**轴对称虚线** → 对称位置自动落子  
- 控制面板：调速滑块控制AI自动演示速度，展示对称策略的制胜过程  

---

#### 2. 精选优质题解参考  
**题解一：Vct14（赞14）**  
* **点评**：  
  思路如水晶般透彻——**双对称策略**（奇中心/偶轴对称）直击本质。代码简洁有力（`n%2`判奇偶），边界处理隐含在策略中。亮点在于用图文并茂的方式解释抽象策略，使学习者秒懂"为何对称能必胜"。

**题解二：yitian_（赞6）**  
* **点评**：  
  四两拨千斤的典范！仅用3行核心逻辑就解决问题，完美诠释"简单即美"。变量命名精简（`n,q,s`）却无歧义，特别适合竞赛场景。其价值在于教会我们**识别问题本质**——捣乱操作实为烟雾弹。

**题解三：GoodLuckCat（赞1）**  
* **点评**：  
  最具启发性类比：**硬币圆桌问题→棋盘对称**。详细推导"为何模仿策略必胜"，像侦探般剖析小C的捣乱本质（`x_i`偶数的深层含义）。代码稍显朴实，但思想深度值得5星。

---

#### 3. 核心难点辨析与解题策略  
1. **关键点1：对称策略的构建**  
   * **分析**：优质解均发现核心规律——当棋盘存在**对称中心/轴**时，模仿对手落子可使对手永远面临"无子可下"的困局。关键在于识别初始n的奇偶性决定对称类型。
   * 💡 **学习笔记**：博弈问题先找对称性！

2. **关键点2：捣乱操作的本质**  
   * **分析**：小C扩大棋盘时：①边长+2→奇偶性不变；②`x_i`为偶数→落子权不变。这解释了为何捣乱不改变胜负关系。
   * 💡 **学习笔记**：操作不改本质时，忽略干扰专注核心变量。

3. **关键点3：必胜策略的严谨性**  
   * **分析**：需证明对称策略下：①对手有合法落子时，我方必有对称落点；②棋盘有限→游戏必终止。题解用示意图直观证明此逻辑链。
   * 💡 **学习笔记**：最优策略需满足：可执行性+终止性。

### ✨ 解题技巧总结  
- **降维攻击**：将二维棋盘问题转化为奇偶性判断（`n%2`）  
- **对称破局**：发现中心/轴对称立即尝试模仿策略  
- **干扰过滤**：识别不改变问题本质的操作（如固定奇偶性变化）  

---

#### 4. C++核心代码实现赏析  
**通用核心实现参考**  
* **说明**：综合优质解的最简实现（源于Vct14）  
* **完整核心代码**：  
  ```cpp
  #include <iostream>
  using namespace std;
  int main() {
      int T; cin >> T;
      while (T--) {
          int n, q; unsigned long long seed; 
          cin >> n >> q >> seed;  // 注意：q和seed实际未使用
          cout << (n % 2 ? "A won" : "B won") << '\n';
      }
      return 0;
  }
  ```
* **代码解读概要**：  
  > ① 读取游戏局数`T`；② 每局读取`n,q,seed`；③ 用`n%2`判断奇偶性直接输出胜负。`q`和`seed`虽无逻辑作用，但题目要求输入需保留。  

---

#### 5. 算法可视化：像素动画演示  
**主题**：像素柯基战记（8-bit风格）  

**关键帧设计**：  
1. **初始化**：  
   - 绘制`n×n`像素棋盘（16色：空地=浅灰，地盘=深灰）  
   - 控制面板：▶️暂停/继续｜⏩单步｜🔄重置｜🎚️速度滑块  

2. **落子演示**：  
   ```mermaid
   graph LR
   A[当前玩家] --> B{棋盘奇偶？}
   B -->|奇数| C[小A落子中心点] 
   B -->|偶数| D[小A随机落子]
   C --> E[小B落子] --> F[小A镜像落子] 
   D --> G[小B对称落子]
   F/G --> H{可落子？}
   H -->|是| E/G
   H -->|否| I[播放胜利动画]
   ```

3. **特效细节**：  
   - 落子时：柯基像素画闪现+8-bit音效  
   - 地盘标记：四角渐变色填充动画  
   - 胜负判定：赢家方棋盘绽放烟花特效+胜利音阶  

**游戏化设计**：  
- 每局作为独立关卡，通关解锁不同柯基皮肤  
- 完美执行对称策略得⭐️⭐️⭐️评价  
- BGM：芯片音乐版《小狗圆舞曲》循环  

---

#### 6. 拓展练习与相似问题思考  
**通用技巧迁移**：  
对称策略适用于：  
1. 棋盘覆盖问题（多米诺骨牌）  
2. 无偏博弈（如Nim游戏变种）  
3. 圆桌轮流放硬币问题  

**洛谷推荐**：  
1. P2197 【模板】nim游戏  
   → 理解**策略模仿**的通用性  
2. P2964 [USACO09NOV]硬币游戏  
   → 对称策略在**环形结构**的应用  
3. P2734 [USACO3.3]游戏  
   → **动态规划+博弈**的综合训练  

---

#### 7. 学习心得与经验分享  
> **GoodLuckCat的洞见**：  
> *"柯基棋本质是圆桌放硬币的二维扩展，对称性破局是通用钥匙"*  
> → 这种**跨问题类比**的能力极为珍贵！当遇到新问题时，尝试：  
> 1. 剥离皮肤看骨架（本例：移除捣乱干扰）  
> 2. 寻找已知问题的影子（硬币→棋盘）  
> 3. 验证策略迁移可行性  

---

通过本次分析，我们看到**简洁即力量**——20行代码解决的博弈问题，背后是深刻的对称思想。记住Kay的箴言：**复杂问题中，先寻找不变的锚点**（如此处的奇偶性）。下次遇到类似棋盘博弈，不妨先画个对称轴试试！💪

---
处理用时：124.11秒
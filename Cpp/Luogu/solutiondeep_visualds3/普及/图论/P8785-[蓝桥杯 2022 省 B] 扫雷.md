# 题目信息

# [蓝桥杯 2022 省 B] 扫雷

## 题目描述

小明最近迷上了一款名为《扫雷》的游戏。其中有一个关卡的任务如下，在一个二维平面上放置着 $n$ 个炸雷，第 $i$ 个炸雷 $\left(x_{i}, y_{i}, r_{i}\right)$ 表示在坐标 $\left(x_{i}, y_{i}\right)$ 处存在一个炸雷，它的爆炸范围是以半径为 $r_{i}$ 的一个圆。

为了顺利通过这片土地，需要玩家进行排雷。玩家可以发射 $m$ 个排雷火箭，小明已经规划好了每个排雷火箭的发射方向，第 $j$ 个排雷火箭 $\left(x_{j}, y_{j}, r_{j}\right)$ 表示这个排雷火箭将会在 $\left(x_{j}, y_{j}\right)$ 处爆炸，它的爆炸范围是以半径为 $r_{j}$ 的一个圆，在其爆炸范围内的炸雷会被引爆。同时，当炸雷被引爆时，在其爆炸范围内的炸雷也会被引爆。现在小明想知道他这次共引爆了几颗炸雷?

你可以把炸雷和排雷火箭都视为平面上的一个点。一个点处可以存在多个炸雷和排雷火箭。当炸雷位于爆炸范围的边界上时也会被引爆。

## 说明/提示

**【样例说明】**

示例图如下, 排雷火箭 1 覆盖了炸雷 1 , 所以炸雷 1 被排除; 炸雷 1 又覆 盖了炸雷 2 , 所以炸雷 2 也被排除。

![](https://luogu.oss-cn-hangzhou.aliyuncs.com/upload/vjudge_pic/lanqiao/2022_09_29_3d61ad9326a0012c9fdag-13.jpg)

**【评测用例规模与约定】**

对于 $40 \%$ 的评测用例: $0 \leq x, y \leq 10^{9}, 0 \leq n, m \leq 10^{3}, 1 \leq r \leq 10$.

对于 $100 \%$ 的评测用例: $0 \leq x, y \leq 10^{9}, 0 \leq n, m \leq 5 \times 10^{4}, 1 \leq r \leq 10$. 


蓝桥杯 2022 省赛 B 组 H 题。

## 样例 #1

### 输入

```
2 1
2 2 4
4 4 2
0 0 5```

### 输出

```
2```

# AI分析结果


### 💡 Kay的C++算法解析：扫雷 深入学习指南 💡  
**题目解读与核心算法识别**  
✨ **本题主要考察**：`搜索(DFS) + 哈希映射优化`  
🗣️ **初步分析**：  
> 扫雷问题本质是连锁爆炸的模拟，就像推倒多米诺骨牌——引爆一个雷会触发周围雷的爆炸。关键技巧在于：  
> 1. **暴力枚举+剪枝**：利用半径≤10的特性，在有限范围内（约21×21网格）搜索相邻雷  
> 2. **哈希映射优化**：用`map`合并相同坐标的雷，存储最大半径和雷数  
> 3. **DFS连锁反应**：递归引爆未触发的雷，用`vis`数组避免重复计数  
>  
> **可视化设计**：在8位像素战场中：  
> - 地雷用不同颜色方块表示（颜色深浅=半径大小）  
> - 爆炸时播放"轰"音效+扩散动画  
> - 连锁反应用闪烁边框高亮当前触发点  

---

### 2. 精选优质题解参考  
**题解一 (来源：zzy0618)**  
* **点评**：  
  思路清晰利用半径小的特性（暴力枚举21×21区域），代码用`map`合并同坐标雷的精妙设计显著提升效率。变量`cnt/tmp`命名直观，`vis`数组严谨避免重复计数。DFS递归逻辑完整覆盖连锁反应，边界处理周全（圆内判断用整数运算防浮点误差）。亮点在于空间换时间——哈希映射将理论复杂度降至**O(441*(n+m)log n)**，完美适配题目数据范围。

---

### 3. 核心难点辨析与解题策略  
1. **难点：同坐标多雷的合并处理**  
   * **分析**：多个雷重叠时需合并计数并取最大半径。题解用`map<pair<int,int>,int>`将坐标映射唯一ID，用`cnt[]`计雷数、`tmp[]`存最大半径  
   * 💡 **学习笔记**：哈希映射是处理离散坐标的黄金标准  

2. **难点：爆炸范围的快速枚举**  
   * **分析**：对每个爆炸点，遍历其周围(2r+1)²区域。代码通过`(i-x)²+(j-y)²≤r²`快速过滤圆外点，避免无效计算  
   * 💡 **学习笔记**：整数运算比浮点快，平方比较比开方高效  

3. **难点：避免重复引爆的标记机制**  
   * **分析**：`vis[]`数组确保每个位置只被引爆一次。DFS中优先检查`vis[z]`再递归  
   * 💡 **学习笔记**：状态标记是图遍历算法的核心安全锁  

**✨ 解题技巧总结**  
- **空间换时间**：哈希表预处理坐标 → O(1)查找  
- **暴力剪枝**：利用数据范围特征(如小半径)限定枚举区域  
- **状态持久化**：`vis`数组防止重复访问，类似BFS的`visited`  

---

### 4. C++核心代码实现赏析  
**通用核心实现参考**  
```cpp
#include<bits/stdc++.h>
using namespace std;
const int N=1e5+5;
int n,m,ans,tot,cnt[N],tmp[N],vis[N];
map<pair<int,int>,int> mp; // 坐标→ID的映射

void dfs(int x,int y,int r){
    for(int i=x-r;i<=x+r;i++)
    for(int j=y-r;j<=y+r;j++){
        if((i-x)*(i-x)+(j-y)*(j-y)>r*r) continue;
        auto pos=make_pair(i,j);
        if(mp.count(pos)){
            int z=mp[pos];
            if(vis[z]) continue;
            vis[z]=1; ans+=cnt[z];     // 标记+计数
            dfs(i,j,tmp[z]);            // 连锁引爆
        }
    }
}

int main(){
    ios::sync_with_stdio(0); 
    cin.tie(0),cout.tie(0);             // 加速IO
    cin>>n>>m;
    for(int i=1,x,y,r;i<=n;i++){
        cin>>x>>y>>r;
        auto pos=make_pair(x,y);
        if(mp.count(pos)){               // 坐标已存在
            int z=mp[pos];
            cnt[z]++;                   // 雷数+1
            tmp[z]=max(tmp[z],r);       // 更新最大半径
        }
        else mp[pos]=++tot,cnt[tot]=1,tmp[tot]=r;
    }
    for(int i=1,x,y,r;i<=m;i++){
        cin>>x>>y>>r;
        dfs(x,y,r);                     // 处理每个排雷火箭
    }
    cout<<ans<<'\n';
}
```
**代码解读概要**：  
1. **数据预处理**：用`map`将坐标映射唯一ID，`cnt[]`记录雷数，`tmp[]`存最大半径  
2. **DFS引爆**：对每个火箭，在(2r+1)²区域内枚举点，通过平方比较过滤圆外点  
3. **连锁反应**：遇到未引爆雷时标记并递归，`ans`累加雷数  

---

### 5. 算法可视化：像素动画演示  
**主题**：8位像素战场上的连锁爆炸  
**设计思路**：  
```plaintext
[控制面板] 开始▶️||⏹️ | 速度:●───────●
[战场网格] 草地(▓) 雷(●) 火箭(🚀) 爆炸范围(🔥)
```
**动画流程**：  
1. **初始化**：生成随机雷阵，火箭从顶部空投  
2. **火箭爆炸**：  
   - 播放"咻→轰"音效  
   - 以火箭为中心扩散红色圆形动画（半径=r）  
3. **连锁反应**：  
   - 被引爆雷闪烁3次→变灰色💥  
   - 触发新爆炸时：  
     * 当前雷高亮黄框  
     * 爆炸范围显示蓝色扩散圆  
     * 播放"叮"音效提示连锁  
4. **胜利结算**：  
   - 显示引爆总数 + 播放胜利音乐  
   - 按空格键切换火箭视角  

**技术实现**：  
- **Canvas绘制**：用`fillRect`绘制网格，`arc`画爆炸圆  
- **音效触发**：Web Audio API播放8-bit音效（爆炸/连锁/胜利）  
- **自动演示**：`setInterval`控制动画帧率，速度滑块调节延时  

---

### 6. 拓展练习与相似问题思考  
**通用技巧迁移**：  
1. 离散坐标处理 → 星空星座识别  
2. 有限半径扩散 → 细胞自动机模拟  
3. 连锁反应 → 网络传播模型  

**洛谷练习推荐**：  
1. **P2036 [COCI2008-2009#2] PERKET**  
   → 巩固DFS枚举+状态记录  
2. **P1141 01迷宫**  
   → 练习连通块标记（类似`vis`数组应用）  
3. **P1443 马的遍历**  
   → 强化有限步长搜索（BFS/DFS）  

---

### 7. 学习心得与经验分享  
> **经验摘录**：  
> *"最初未考虑同坐标多雷，调试时通过打印`mp`内容发现计数错误"*  
>   
> **Kay点评**：  
> 调试时输出中间变量（如map内容）是定位逻辑漏洞的利器。本题的哈希映射设计启示我们：**处理离散空间时，降维映射是突破二维限制的金钥匙**。

---
处理用时：165.40秒
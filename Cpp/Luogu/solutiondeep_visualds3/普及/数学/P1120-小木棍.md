# é¢˜ç›®ä¿¡æ¯

# å°æœ¨æ£

## é¢˜ç›®èƒŒæ™¯

æœ¬é¢˜**ä¸ä¿è¯**å­˜åœ¨**å¯ä»¥é€šè¿‡æ»¡è¶³æœ¬é¢˜æ•°æ®èŒƒå›´çš„ä»»æ„æ•°æ®**åšæ³•ã€‚å¯ä»¥é€šè¿‡æ­¤é¢˜çš„ç¨‹åºä¸ä¸€å®šå®Œå…¨æ­£ç¡®ï¼ˆç®—æ³•æ—¶é—´å¤æ‚åº¦é”™è¯¯ã€æˆ–ä¸ä¿è¯æ­£ç¡®æ€§ï¼‰

æœ¬é¢˜ä¸ºæœç´¢é¢˜ï¼Œæœ¬é¢˜ä¸æ¥å— hack æ•°æ®ã€‚[å…³äºæ­¤ç±»é¢˜ç›®çš„è¯¦ç»†å†…å®¹](https://www.luogu.com.cn/paste/isdgwj5l)

## é¢˜ç›®æè¿°

ä¹”æ²»æœ‰ä¸€äº›åŒæ ·é•¿çš„å°æœ¨æ£ï¼Œä»–æŠŠè¿™äº›æœ¨æ£éšæ„ç æˆå‡ æ®µï¼Œç›´åˆ°æ¯æ®µçš„é•¿éƒ½ä¸è¶…è¿‡ $50$ã€‚

ç°åœ¨ï¼Œä»–æƒ³æŠŠå°æœ¨æ£æ‹¼æ¥æˆåŸæ¥çš„æ ·å­ï¼Œä½†æ˜¯å´å¿˜è®°äº†è‡ªå·±å¼€å§‹æ—¶æœ‰å¤šå°‘æ ¹æœ¨æ£å’Œå®ƒä»¬çš„é•¿åº¦ã€‚

ç»™å‡ºæ¯æ®µå°æœ¨æ£çš„é•¿åº¦ï¼Œç¼–ç¨‹å¸®ä»–æ‰¾å‡ºåŸå§‹æœ¨æ£çš„æœ€å°å¯èƒ½é•¿åº¦ã€‚


## è¯´æ˜/æç¤º

å¯¹äºå…¨éƒ¨æµ‹è¯•ç‚¹ï¼Œ$1 \leq n \leq 65$ï¼Œ$1 \leq a_i \leq 50$ã€‚

## æ ·ä¾‹ #1

### è¾“å…¥

```
9
5 2 1 5 2 1 5 2 1
```

### è¾“å‡º

```
6```

# AIåˆ†æç»“æœ


# ğŸ’¡ Kayçš„C++ç®—æ³•è§£æï¼šå°æœ¨æ£ ï¼»æ•°æ®åŠ å¼ºç‰ˆï¼½æ·±å…¥å­¦ä¹ æŒ‡å— ğŸ’¡

## 1. é¢˜ç›®è§£è¯»ä¸æ ¸å¿ƒç®—æ³•è¯†åˆ«

âœ¨ **æœ¬é¢˜ä¸»è¦è€ƒå¯Ÿ**ï¼š`æœç´¢ï¼ˆDFSï¼‰ä¸å‰ªæä¼˜åŒ–`

ğŸ—£ï¸ **åˆæ­¥åˆ†æ**ï¼š
> è§£å†³"å°æœ¨æ£"è¿™é“é¢˜ï¼Œå…³é”®åœ¨äºç†è§£å¹¶è¿ç”¨ **DFSå‰ªæä¼˜åŒ–**ã€‚ç®€å•æ¥è¯´ï¼Œå°±åƒç©æ‹¼å›¾æ¸¸æˆæ—¶ï¼Œæˆ‘ä»¬ä¼˜å…ˆç”¨å¤§å—æ‹¼å›¾ç¡®å®šæ¡†æ¶ï¼Œå†ç”¨å°å—å¡«å……ç»†èŠ‚ï¼Œé¿å…æ— æ•ˆå°è¯•ã€‚åœ¨æœ¬é¢˜ä¸­ï¼Œè¿™ç§ç­–ç•¥ä¸»è¦ç”¨äº**å¿«é€Ÿæ’é™¤æ— æ•ˆçš„åŸå§‹é•¿åº¦æ–¹æ¡ˆ**ã€‚

- **é¢˜è§£æ€è·¯æ ¸å¿ƒ**ï¼šæšä¸¾å¯èƒ½çš„åŸå§‹æœ¨æ£é•¿åº¦ï¼ˆéœ€æ•´é™¤æ€»é•¿åº¦ï¼‰ï¼Œé€šè¿‡DFSéªŒè¯æ˜¯å¦èƒ½æ‹¼å‡ºæŒ‡å®šæ ¹æ•°ã€‚å…³é”®éš¾ç‚¹åœ¨äº**æœç´¢ç©ºé—´å·¨å¤§**ï¼Œéœ€å¤šç»´åº¦å‰ªæä¼˜åŒ–ã€‚
- **æ ¸å¿ƒç®—æ³•æµç¨‹**ï¼š
  1. è¿‡æ»¤>50çš„æœ¨æ£ï¼Œæ’åºï¼ˆä»å¤§åˆ°å°ï¼‰
  2. æšä¸¾åŸå§‹é•¿åº¦Lï¼ˆmax_a â‰¤ L â‰¤ sum/2ï¼‰
  3. DFSéªŒè¯ï¼šå°è¯•æ‹¼å‡ºsum/Læ ¹é•¿åº¦ä¸ºLçš„æœ¨æ£
  4. å‰ªæï¼šç›¸åŒé•¿åº¦è·³è¿‡ã€äºŒåˆ†æŸ¥æ‰¾ã€å…³é”®å›æº¯æ¡ä»¶
- **å¯è§†åŒ–è®¾è®¡**ï¼šé‡‡ç”¨8ä½åƒç´ é£æ ¼ï¼Œæœ¨æ£ç”¨å½©è‰²æ–¹å—è¡¨ç¤ºã€‚é«˜äº®å½“å‰æ“ä½œæœ¨æ£ï¼Œå›æº¯æ—¶é—ªçƒçº¢å…‰ï¼Œæ‹¼å®Œä¸€ç»„æ’­æ”¾èƒœåˆ©éŸ³æ•ˆã€‚æ§åˆ¶é¢æ¿æ”¯æŒæ­¥è¿›/è°ƒé€Ÿï¼Œç›´è§‚å±•ç¤ºå‰ªææ•ˆæœï¼ˆå¦‚è·³è¿‡ç›¸åŒé•¿åº¦æ—¶æ˜¾ç¤º"è·³è¿‡ï¼"æç¤ºï¼‰

---

## 2. ç²¾é€‰ä¼˜è´¨é¢˜è§£å‚è€ƒ

**é¢˜è§£ä¸€ï¼ˆKaoriï¼Œèµ1363ï¼‰**
* **ç‚¹è¯„**ï¼šæ€è·¯æœ€å®Œæ•´çš„æ•™ç¨‹çº§é¢˜è§£ã€‚æ ¸å¿ƒäº®ç‚¹æ˜¯**é¢„å¤„ç†nextæ•°ç»„è·³è¿‡ç›¸åŒé•¿åº¦**ï¼Œé…åˆäºŒåˆ†æŸ¥æ‰¾ä¼˜åŒ–æœç´¢æ•ˆç‡ã€‚ä»£ç ä¸­`if(rest==a[i]||rest==len)return`çš„ç²¾å¦™å‰ªææå¤§å‡å°‘é€’å½’å±‚æ•°ã€‚å˜é‡å‘½åè§„èŒƒï¼ˆå¦‚`used`æ ‡è®°ä½¿ç”¨çŠ¶æ€ï¼‰ï¼Œè¾¹ç•Œå¤„ç†ä¸¥è°¨ï¼Œç«èµ›å¯ç›´æ¥å¤ç”¨ã€‚

**é¢˜è§£äºŒï¼ˆæ—åˆ™å¾ï¼Œèµ402ï¼‰**
* **ç‚¹è¯„**ï¼šæç®€ä¸»ä¹‰çš„å…¸èŒƒã€‚**æ¡¶æ’åºä»£æ›¿æ¯”è¾ƒæ’åº**ï¼Œç”¨`tm[]`æ•°ç»„è®¡æ•°é¿å…æ˜¾å¼æ’åºã€‚äº®ç‚¹åœ¨äº`if(sum==0||sum+i==target)break`çš„å‰ªæç­–ç•¥ï¼Œç”¨10è¡ŒDFSå®Œæˆæ ¸å¿ƒé€»è¾‘ã€‚é€‚åˆæŒæ¡åŸºç¡€åè¿½æ±‚ä»£ç ç®€æ´æ€§çš„å­¦ä¹ è€…ã€‚

**é¢˜è§£ä¸‰ï¼ˆNoyExceptionï¼Œèµ351ï¼‰**
* **ç‚¹è¯„**ï¼šæ•™å­¦å¼•å¯¼æœ€ä½³ã€‚ç”¨**"å…ˆæ”¾çŸ³å¤´åæ”¾æ²™å­"æ¯”å–»**è§£é‡Šä¸ºä½•ä»å¤§åˆ°å°æ’åºã€‚ä»£ç ä¸­`vis`æ•°ç»„å‘½åæ¸…æ™°ï¼Œå…³é”®å‰ªæ`if(rest==a[i]||rest==len)break`é…æœ‰è°ƒè¯•æ¡ˆä¾‹ã€‚ç‰¹åˆ«é€‚åˆåˆå­¦è€…ç†è§£å‰ªææœ¬è´¨ã€‚

---

## 3. æ ¸å¿ƒéš¾ç‚¹è¾¨æä¸è§£é¢˜ç­–ç•¥

1. **å¦‚ä½•é«˜æ•ˆæšä¸¾åŸå§‹é•¿åº¦ï¼Ÿ**
   * **åˆ†æ**ï¼šé•¿åº¦Lå¿…é¡»æ•´é™¤æ€»é•¿ä¸”â‰¥max_aã€‚ä¼˜è´¨é¢˜è§£å‡è§‚å¯Ÿåˆ°Lâ‰¤sum/2ï¼ˆå¦åˆ™åªèƒ½1æ ¹ï¼‰ï¼Œå…ˆç­›é™¤ä¸æ•´é™¤çš„L
   * ğŸ’¡ **å­¦ä¹ ç¬”è®°**ï¼šæšä¸¾å‰å…ˆæ•°å­¦éªŒè¯ï¼Œé¿å…æ— æ•ˆDFS

2. **ä¸ºä»€ä¹ˆå¿…é¡»ä»å¤§åˆ°å°æ’åºï¼Ÿ**
   * **åˆ†æ**ï¼šé•¿æœ¨æ£çµæ´»æ€§ä½ï¼Œå°½æ—©ç¡®å®šä½ç½®å¯å‡å°‘åˆ†æ”¯ï¼ˆå¦‚å…ˆç”¨5å°è¯•å¤±è´¥ï¼Œå°±ä¸éœ€å†è¯•1+1+1+2ï¼‰ã€‚æœªæ’åºçš„ä»£ç åœ¨n=65æ—¶å¯èƒ½è¶…æ—¶
   * ğŸ’¡ **å­¦ä¹ ç¬”è®°**ï¼šæ’åºè®©æœç´¢"å…ˆéš¾åæ˜“"ï¼Œé¿å…åæœŸè¢«å¤§å—å¡ä½

3. **å¦‚ä½•é¿å…é‡å¤æœç´¢ï¼Ÿ**
   * **åˆ†æ**ï¼šå½“æŸé•¿åº¦å¤±è´¥ï¼Œè·³è¿‡æ‰€æœ‰ç­‰é•¿æœ¨æ£ï¼ˆKaoriçš„`next`æ•°ç»„ï¼‰ã€‚å…³é”®å‰ªæï¼šå‰©ä½™é•¿åº¦=å½“å‰æœ¨æ£é•¿åº¦æ—¶å›æº¯ï¼ˆæš—ç¤ºå‰é¢é€‰æ‹©æœ‰è¯¯ï¼‰
   * ğŸ’¡ **å­¦ä¹ ç¬”è®°**ï¼šè®°å½•æœ€åå°è¯•ä½ç½®ï¼Œç›¸åŒé•¿åº¦æ‰¹é‡è·³è¿‡

### âœ¨ è§£é¢˜æŠ€å·§æ€»ç»“
- **å‰ªæé“¾**ï¼šæ’åº â†’ ç›¸åŒé•¿åº¦è·³è¿‡ â†’ äºŒåˆ†å®šä½ â†’ å…³é”®å›æº¯æ¡ä»¶
- **è°ƒè¯•æŠ€å·§**ï¼šåœ¨DFSå…¥å£æ‰“å°å½“å‰çŠ¶æ€ï¼Œè§‚å¯Ÿå‰ªæè§¦å‘æƒ…å†µ
- **è¾¹ç•Œé™·é˜±**ï¼šæ€»é•¿=0æ—¶ç›´æ¥è¾“å‡º0ï¼›æ‰€æœ‰æœ¨æ£>50æ—¶n=0

---

## 4. C++æ ¸å¿ƒä»£ç å®ç°èµæ

**æœ¬é¢˜é€šç”¨æ ¸å¿ƒC++å®ç°å‚è€ƒ**
```cpp
#include <iostream>
#include <algorithm>
#include <cstring>
using namespace std;

int n, cnt, a[70], next[70], len, m, sum;
bool used[70], ok;

void dfs(int k, int last, int rest) {
    if (ok) return;
    if (!rest) { // æ‹¼å®Œå½“å‰æ£’
        if (k == m) { ok = true; return; }
        for (int i = 1; i <= cnt; i++) {
            if (!used[i]) {
                used[i] = true;
                dfs(k+1, i, len - a[i]); // å¼€æ–°æ£’
                used[i] = false;
                return;
            }
        }
    }
    // äºŒåˆ†æ‰¾ç¬¬ä¸€ä¸ª<=restçš„æœ¨æ£
    int l = last + 1, r = cnt;
    while (l < r) {
        int mid = (l + r) >> 1;
        if (a[mid] <= rest) r = mid;
        else l = mid + 1;
    }
    for (int i = l; i <= cnt; i++) {
        if (!used[i] && a[i] <= rest) {
            used[i] = true;
            dfs(k, i, rest - a[i]);
            used[i] = false;
            if (ok) return;
            if (rest == a[i] || rest == len) return; // å…³é”®å‰ªæ
            i = next[i]; // è·³ç›¸åŒé•¿åº¦
        }
    }
}

int main() {
    cin >> n;
    for (int i = 1; i <= n; i++) {
        int x; cin >> x;
        if (x > 50) continue;  // è¿‡æ»¤>50
        a[++cnt] = x;
        sum += x;
    }
    sort(a+1, a+cnt+1, greater<int>()); // é™åºæ’åº
    next[cnt] = cnt;
    for (int i = cnt-1; i; i--)
        next[i] = (a[i]==a[i+1]) ? next[i+1] : i;
    
    for (len = a[1]; len <= sum/2; len++) {
        if (sum % len != 0) continue;
        m = sum / len;
        ok = false;
        memset(used, 0, sizeof(used));
        used[1] = true; // ç”¨æœ€é•¿æœ¨æ£å¼€å¤´
        dfs(1, 1, len - a[1]);
        if (ok) {
            cout << len << endl;
            return 0;
        }
    }
    cout << sum << endl; // åªèƒ½æ‹¼1æ ¹
}
```
**ä»£ç è§£è¯»æ¦‚è¦**ï¼š
1. **è¾“å…¥å¤„ç†**ï¼šè¿‡æ»¤æ— æ•ˆé•¿åº¦å¹¶é™åºæ’åº
2. **nextæ•°ç»„**ï¼šé¢„å¤„ç†ç›¸åŒé•¿åº¦æœ¨æ£çš„è·³è·ƒç»ˆç‚¹
3. **DFSæ ¸å¿ƒ**ï¼š
   - å‚æ•°ï¼š`k`(å·²æ‹¼æ£’æ•°), `last`(ä¸Šä¸ªæœ¨æ£ä¸‹æ ‡), `rest`(å‰©ä½™é•¿åº¦)
   - å‰ªæé“¾ï¼šäºŒåˆ†åŠ é€Ÿ â†’ å…³é”®å›æº¯ â†’ ç›¸åŒé•¿åº¦è·³è¿‡
4. **æšä¸¾é€»è¾‘**ï¼šä»max_aåˆ°sum/2å°è¯•åˆæ³•é•¿åº¦

**é¢˜è§£ä¸€æ ¸å¿ƒç‰‡æ®µèµæ**
```cpp
// äºŒåˆ†æŸ¥æ‰¾é¦–ä¸ª<=restçš„æœ¨æ£
int l=last+1, r=cnt, mid;
while(l<r) { 
    mid = (l+r)/2;
    if(a[mid] <= rest) r=mid; 
    else l=mid+1;
}
for(i=l; i<=cnt; i=next[i]) {  // ç”¨nextè·³è¿‡ç›¸åŒé•¿åº¦
    if(used[i]) continue;
    // ... å°è¯•æ‹¼æ¥
    if(rest == a[i] || rest == len) return; // å…³é”®å‰ªæ
}
```
**å­¦ä¹ ç¬”è®°**ï¼šäºŒåˆ†å°†O(n)æŸ¥æ‰¾é™è‡³O(log n)ï¼Œnextæ•°ç»„é¿å…é‡å¤å°è¯•ç›¸åŒé•¿åº¦

---

## 5. ç®—æ³•å¯è§†åŒ–ï¼šåƒç´ åŠ¨ç”»æ¼”ç¤º

**ä¸»é¢˜**ï¼š8ä½æœºé£æ ¼ã€Šæœ¨æ£æ‹¼è£…å¤§å†’é™©ã€‹  
**æ ¸å¿ƒæ¼”ç¤º**ï¼šDFSå‰ªæè¿‡ç¨‹å¯è§†åŒ–  

```plaintext
1. åˆå§‹åŒ–ç•Œé¢ï¼š
   - é¡¶éƒ¨ï¼šæ§åˆ¶é¢æ¿ [å¼€å§‹][æš‚åœ][é€Ÿåº¦æ¡]
   - ä¸»åŒºåŸŸï¼šæœ¨æ£é˜Ÿåˆ—ï¼ˆå½©è‰²æ–¹å—ï¼Œé•¿åº¦=åƒç´ æ•°ï¼‰
   - åº•éƒ¨ï¼šå½“å‰çŠ¶æ€ï¼ˆL=?, å‰©ä½™=?)

2. æ­¥è¿›æ¼”ç¤ºï¼š
   â–  å°è¯•æœ¨æ£æ—¶ï¼šé«˜äº®æ–¹å—+æ’­æ”¾ç‚¹å‡»éŸ³æ•ˆ
   â–  æ‹¼æˆåŠŸï¼šæ–¹å—å˜ç»¿+â€œå®ï¼â€éŸ³æ•ˆ
   â–  å…³é”®å‰ªæè§¦å‘ï¼š
      - ç›¸åŒé•¿åº¦è·³è¿‡ï¼šæ˜¾ç¤º"SKIP!"+é—ªçƒ
      - å‰©ä½™é•¿åº¦=å½“å‰é•¿åº¦ï¼šçº¢å…‰é—ªçƒ+å›æº¯åŠ¨ç”»

3. æ¸¸æˆåŒ–å…ƒç´ ï¼š
   - æ¯æ‹¼å®Œ1æ ¹ï¼šåƒç´ çƒŸèŠ±åº†ç¥
   - å¤±è´¥å›æº¯ï¼šæ˜¾ç¤º"Backtracking..."+éŸ³æ•ˆ
   - æœ€ç»ˆæˆåŠŸï¼šé€šå…³BGM+åˆ†æ•°(åŸºäºå‰ªææ¬¡æ•°)
```

**è®¾è®¡ç»†èŠ‚**ï¼š
- **é¢œè‰²ç¼–ç **ï¼šé•¿æœ¨æ£â†’æš–è‰²ï¼ŒçŸ­æœ¨æ£â†’å†·è‰²
- **éŸ³æ•ˆè®¾è®¡**ï¼šå…³é”®æ“ä½œé…8ä½æœºèŠ¯ç‰‡éŸ³æ•ˆ
- **æ€§èƒ½ä¼˜åŒ–**ï¼šCanvasç»˜åˆ¶æœ¨æ£çŠ¶æ€ï¼Œå®æ—¶æ›´æ–°DOM

---

## 6. æ‹“å±•ç»ƒä¹ ä¸ç›¸ä¼¼é—®é¢˜

**é€šç”¨æŠ€å·§è¿ç§»**ï¼š
DFSå‰ªæé€‚ç”¨äºéœ€**å®Œå…¨è¦†ç›–**çš„é—®é¢˜ï¼Œå¦‚ï¼š
1. æ‹¼å›¾æ¸¸æˆï¼ˆå›ºå®šæ¡†å†…æ”¾ç½®å¼‚å½¢å—ï¼‰
2. æ—¶é—´è¡¨å®‰æ’ï¼ˆè¯¾ç¨‹ä¸å†²çªï¼‰
3. èµ„æºåˆ†é…ï¼ˆç­‰é‡åˆ’åˆ†ä»»åŠ¡ï¼‰

**æ´›è°·æ¨è**ï¼š
1. [P1034 çŸ©å½¢è¦†ç›–](https://www.luogu.com.cn/problem/P1034)  
   â†’ å°†ç‚¹é›†åˆ’åˆ†ä¸ºkä¸ªçŸ©å½¢ï¼Œæœ€å°åŒ–é¢ç§¯å’Œ  
   *æ¨èç†ç”±*ï¼šåŒæ ·éœ€è¦æœç´¢+å‡ ä½•å‰ªæ

2. [P1379 å…«æ•°ç ](https://www.luogu.com.cn/problem/P1379)  
   â†’ BFSçŠ¶æ€ç©ºé—´æœç´¢  
   *æ¨èç†ç”±*ï¼šç»ƒä¹ çŠ¶æ€è¡¨ç¤ºä¸è®°å¿†åŒ–å‰ªæ

3. [P2323 å…¬è·¯ä¿®å»º](https://www.luogu.com.cn/problem/P2323)  
   â†’ è´ªå¿ƒ+å¹¶æŸ¥é›†  
   *æ¨èç†ç”±*ï¼šå¯¹æ¯”DFSä¸è´ªå¿ƒåœ¨ä¸åŒåœºæ™¯çš„ä¼˜åŠ£

---

## 7. å­¦ä¹ å¿ƒå¾—ä¸ç»éªŒåˆ†äº«

> **Kaoriçš„è°ƒè¯•ç»éªŒ**ï¼š  
> "æˆ‘åœ¨`if(rest==a[i])`åˆ†æ”¯å¡ä½æ—¶ï¼Œæ·»åŠ äº†ä¸´æ—¶è¾“å‡ºå‘ç°ï¼šå½“å‰©ä½™é•¿åº¦æ°ç­‰äºæœ¨æ£é•¿åº¦å´å¤±è´¥ï¼Œè¯´æ˜å‰é¢æœ‰å¤§æœ¨æ£æ”¾é”™ä½ç½®"  
>   
> **Kayçš„æ€»ç»“**ï¼š  
> è°ƒè¯•æ—¶è¾“å‡º**å½“å‰æ·±åº¦**å’Œ**å…³é”®å˜é‡**ï¼ˆå¦‚last/restï¼‰ï¼Œèƒ½å¿«é€Ÿå®šä½å‰ªæé€»è¾‘æ¼æ´ã€‚å¯¹äºDFSé¢˜ï¼Œå°æ•°æ®æ‰‹åŠ¨æ¨¡æ‹Ÿæ¯”è°ƒè¯•å™¨æ›´æœ‰æ•ˆï¼

---

é€šè¿‡æœ¬æŒ‡å—ï¼Œä½ ä¸ä»…å­¦ä¼šäº†å°æœ¨æ£çš„è§£é¢˜æŠ€å·§ï¼Œæ›´é‡è¦çš„æ˜¯æŒæ¡äº†**æœç´¢ä¼˜åŒ–çš„é€šç”¨æ–¹æ³•è®º**ã€‚è®°ä½ï¼šä¼˜ç§€çš„ç®—æ³•=æš´åŠ›+æ•°å­¦è§‚å¯Ÿ+å‰ªæè‰ºæœ¯ï¼ä¸‹æ¬¡é‡åˆ°ç±»ä¼¼é—®é¢˜ï¼Œä¸å¦¨å…ˆé—®è‡ªå·±ï¼š"æ’åºäº†å—ï¼Ÿé‡å¤è·³è¿‡äº†å—ï¼Ÿæœ‰æ•°å­¦æ€§è´¨å¯ç”¨å—ï¼Ÿ" Keep coding! ğŸ’ª

---
å¤„ç†ç”¨æ—¶ï¼š176.38ç§’
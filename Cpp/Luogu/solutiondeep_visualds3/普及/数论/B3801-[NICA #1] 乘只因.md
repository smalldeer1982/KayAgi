# é¢˜ç›®ä¿¡æ¯

# [NICA #1] ä¹˜åªå› 

## é¢˜ç›®èƒŒæ™¯

å’¯å’¯å’¯ï¼ˆåªå› å«ï¼‰ã€‚

## é¢˜ç›®æè¿°


ç»™å®š $n,k$ï¼Œè¯·ç»Ÿè®¡æœ‰å¤šå°‘ä¸ªé•¿åº¦ä¸º $k$ çš„åºåˆ— $[a_1,a_2,\dots,a_k]$ æ»¡è¶³ï¼š

- $a_1\times a_2\times a_3\times \dots\times a_k=n$ã€‚
- $1<a_1\leq a_2\leq a_3\leq \dots\leq a_k$ã€‚
- è¿™ $k$ ä¸ªæ•°çš„æœ€å°å…¬å€æ•°ç­‰äº $n$ã€‚


## è¯´æ˜/æç¤º

#### ã€æ ·ä¾‹è§£é‡Šã€‘

- åªèƒ½æ‹†åˆ†ä¸º $2\times 5$ã€‚
- $2$ å’Œ $5$ çš„æœ€å°å…¬å€æ•°ä¸º $10$ã€‚

#### ã€æ•°æ®èŒƒå›´ã€‘

å¯¹äº $100\%$ çš„æ•°æ®ï¼Œæ»¡è¶³ $n,k\leq 10^7$ï¼Œ$T\leq 10^5$ã€‚

## æ ·ä¾‹ #1

### è¾“å…¥

```
1
10 2
```

### è¾“å‡º

```
1```

# AIåˆ†æç»“æœ


### ğŸ’¡ Kayçš„C++ç®—æ³•è§£æï¼šä¹˜åªå›  æ·±å…¥å­¦ä¹ æŒ‡å— ğŸ’¡

#### 1. é¢˜ç›®è§£è¯»ä¸æ ¸å¿ƒç®—æ³•è¯†åˆ«
âœ¨ **æœ¬é¢˜ä¸»è¦è€ƒå¯Ÿ**ï¼šç»„åˆæ•°å­¦ï¼ˆç¬¬äºŒç±»æ–¯ç‰¹æ—æ•°åº”ç”¨ï¼‰

ğŸ—£ï¸ **åˆæ­¥åˆ†æ**ï¼š
> è§£å†³"ä¹˜åªå› "è¿™é“é¢˜ï¼Œå…³é”®åœ¨äºç†è§£**è´¨å› æ•°åˆ†ç»„æ¨¡å‹**ã€‚æƒ³è±¡æœ‰ä¸åŒé¢œè‰²çš„ç§¯æœ¨ï¼ˆè´¨å› æ•°ï¼‰ï¼Œéœ€è¦å°†å®ƒä»¬åˆ†æˆkä¸ªç›’å­ï¼ˆåºåˆ—ä½ç½®ï¼‰ï¼Œæ¯ä¸ªç›’å­è‡³å°‘æ”¾ä¸€å—ç§¯æœ¨ï¼Œä¸”ç›’å­ä¸å¯åŒºåˆ†ï¼ˆæœ€ç»ˆæŒ‰ä¹˜ç§¯æ’åºå½¢æˆéé™åºåˆ—ï¼‰ã€‚è¿™å°±æ˜¯**ç¬¬äºŒç±»æ–¯ç‰¹æ—æ•°**çš„ç»å…¸åº”ç”¨åœºæ™¯ã€‚  
> - æ ¸å¿ƒæ€è·¯ï¼šé¦–å…ˆåˆ†è§£nçš„è´¨å› æ•°ï¼Œç»Ÿè®¡ä¸åŒè´¨å› æ•°çš„ç§ç±»æ•°cntã€‚è‹¥k>cntåˆ™æ— è§£ï¼ˆ0ç§æ–¹æ¡ˆï¼‰ï¼Œå¦åˆ™ç­”æ¡ˆå°±æ˜¯S(cnt,k)  
> - å…³é”®æ­¥éª¤ï¼šè´¨å› æ•°åˆ†è§£ â†’ ç»Ÿè®¡cnt â†’ æ–¯ç‰¹æ—æ•°è®¡ç®— â†’ å¤„ç†è¾¹ç•Œæ¡ä»¶  
> - å¯è§†åŒ–è®¾è®¡ï¼šé‡‡ç”¨8ä½åƒç´ é£æ ¼å±•ç¤ºè´¨å› æ•°åˆ†ç»„è¿‡ç¨‹ï¼Œä¸åŒé¢œè‰²åƒç´ å—ä»£è¡¨ä¸åŒè´¨å› æ•°ï¼Œç›’å­ç”¨å‘å…‰å®¹å™¨è¡¨ç¤ºã€‚å…³é”®æ“ä½œï¼ˆå…¥ç›’ã€åˆ†ç»„å®Œæˆï¼‰è§¦å‘å¤å¤éŸ³æ•ˆï¼Œè‡ªåŠ¨æ¼”ç¤ºæ¨¡å¼å¯è°ƒé€Ÿå±•ç¤ºåˆ†ç»„è¿‡ç¨‹

---

#### 2. ç²¾é€‰ä¼˜è´¨é¢˜è§£å‚è€ƒ
**é¢˜è§£ä¸€ï¼ˆæ¥æºï¼šFFTotoroï¼‰**
* **ç‚¹è¯„**ï¼š
  æ­¤è§£æ³•æ€è·¯æ¸…æ™°ä¸¥è°¨ï¼Œå®Œæ•´æ¨å¯¼å‡ºè´¨å› æ•°åˆ†ç»„ä¸æ–¯ç‰¹æ—æ•°çš„ç­‰ä»·å…³ç³»ã€‚ä»£ç å®ç°äº®ç‚¹åœ¨äºï¼š
  1. ä½¿ç”¨**çº¿æ€§ç­›é¢„å¤„ç†è´¨æ•°è¡¨**ï¼Œå¤§å¹…æå‡åˆ†è§£æ•ˆç‡ï¼ˆTâ‰¤10âµæ—¶ä»é«˜æ•ˆï¼‰
  2. æ–¯ç‰¹æ—æ•°é€’æ¨å®ç°ç®€æ´è§„èŒƒï¼ˆvectoråµŒå¥—é¿å…è¶Šç•Œï¼‰
  3. è¾¹ç•Œå¤„ç†å®Œå¤‡ï¼ˆk>cntæ—¶è¿”å›0ï¼‰
  4. æ—¶é—´å¤æ‚åº¦ä¼˜åŒ–åˆ°O(max_n + TÂ·Ï€(âˆšn))ï¼Œå®è·µä»·å€¼æé«˜

---

#### 3. æ ¸å¿ƒéš¾ç‚¹è¾¨æä¸è§£é¢˜ç­–ç•¥
1.  **éš¾ç‚¹ï¼šé—®é¢˜è½¬åŒ–ä¸æ¨¡å‹è¯†åˆ«**
    * **åˆ†æ**ï¼šéœ€ä»ä¹˜ç§¯=LCMçš„æ¡ä»¶æ¨å¯¼å‡º"è´¨å› æ•°å¿…é¡»å®Œæ•´åˆ†ç»„"çš„æ€§è´¨ã€‚ä¼˜è´¨é¢˜è§£é€šè¿‡åè¯æ³•ï¼ˆå‡è®¾è´¨å› æ•°æ‹†åˆ†å¯¼è‡´LCMâ‰ nï¼‰ä¸¥è°¨è¯æ˜
    * ğŸ’¡ å­¦ä¹ ç¬”è®°ï¼šä¹˜ç§¯=LCM â‡” æ‰€æœ‰æ•°ä¸¤ä¸¤äº’è´¨ â‡” æ¯ä¸ªè´¨å› æ•°å¹‚æ¬¡å¿…é¡»é›†ä¸­

2.  **éš¾ç‚¹ï¼šæ–¯ç‰¹æ—æ•°æ„ä¹‰ç†è§£**
    * **åˆ†æ**ï¼šç¬¬äºŒç±»æ–¯ç‰¹æ—æ•°S(n,k)è®¡ç®—å°†nä¸ª**ä¸åŒç‰©ä½“**åˆ†æˆkä¸ª**ç›¸åŒç»„**çš„æ–¹æ¡ˆæ•°ï¼Œæ­£ç¬¦åˆæœ¬é¢˜åˆ†ç»„åæ’åºçš„è¦æ±‚
    * ğŸ’¡ å­¦ä¹ ç¬”è®°ï¼šç»„å†…æ— åº â†’ æ–¯ç‰¹æ—æ•°ï¼›ç»„é—´æœ‰åº â†’ åˆ†ç»„åæŒ‰ä¹˜ç§¯æ’åº

3.  **éš¾ç‚¹ï¼šå¤§è§„æ¨¡è´¨å› æ•°åˆ†è§£ä¼˜åŒ–**
    * **åˆ†æ**ï¼šTæœ€å¤§10âµæ—¶éœ€é¿å…O(Tâˆšn)å¤æ‚åº¦ã€‚FFTotoroè§£æ³•ç”¨çº¿æ€§ç­›é¢„å¤„ç†è´¨æ•°è¡¨ï¼Œåˆ†è§£æ—¶åªéå†è´¨æ•°
    * ğŸ’¡ å­¦ä¹ ç¬”è®°ï¼šé¢„å¤„ç†è´¨æ•°è¡¨å°†åˆ†è§£å¤æ‚åº¦ä»O(âˆšn)é™è‡³O(Ï€(âˆšn))

### âœ¨ è§£é¢˜æŠ€å·§æ€»ç»“
- **æ¨¡å‹æŠ½è±¡æŠ€å·§**ï¼šå°†æ•°å­¦æ¡ä»¶ï¼ˆä¹˜ç§¯=LCMï¼‰è½¬åŒ–ä¸ºç»„åˆæ¨¡å‹ï¼ˆæ–¯ç‰¹æ—æ•°ï¼‰
- **å¤æ‚åº¦ä¼˜åŒ–æŠ€å·§**ï¼šé¢„å¤„ç†è´¨æ•°è¡¨+è´¨å› æ•°åˆ†è§£å‰ªæ
- **è¾¹ç•Œå¤„ç†æŠ€å·§**ï¼šk>cntæ—¶ç«‹å³è¿”å›0ï¼Œé¿å…æ— æ•ˆè®¡ç®—
- **ä»£ç å¥å£®æ€§**ï¼šä½¿ç”¨vectoré¿å…æ•°ç»„è¶Šç•Œï¼Œunsignedç±»å‹é˜²æº¢å‡º

---

### 4. C++æ ¸å¿ƒä»£ç å®ç°èµæ
**é€šç”¨æ ¸å¿ƒå®ç°ï¼ˆæ¥æºï¼šFFTotoroä¼˜åŒ–ç‰ˆï¼‰**
```cpp
#include<bits/stdc++.h>
using namespace std;
const int MAX = 1e7+5;

vector<int> primes; // é¢„å­˜è´¨æ•°
bitset<MAX> is_prime;

void sieve(int n) { // çº¿æ€§ç­›
    is_prime.set(); is_prime[0]=is_prime[1]=0;
    for(int i=2; i<=n; ++i) {
        if(is_prime[i]) primes.push_back(i);
        for(int p : primes) {
            if(i*p > n) break;
            is_prime[i*p] = 0;
            if(i%p == 0) break;
        }
    }
}

int main() {
    ios::sync_with_stdio(0); cin.tie(0);
    sieve(MAX-1); // é¢„å¤„ç†è´¨æ•°è¡¨
    
    // é¢„å¤„ç†æ–¯ç‰¹æ—æ•°(0<n,kâ‰¤8)
    vector<vector<int>> S(9, vector<int>(9,0));
    for(int i=0; i<=8; ++i) S[i][0] = !i;
    for(int i=1; i<=8; ++i)
        for(int j=1; j<=8; ++j)
            S[i][j] = j*S[i-1][j] + S[i-1][j-1];

    int T; cin >> T;
    while(T--) {
        int n, k, cnt = 0; 
        cin >> n >> k;
        
        // è´¨å› æ•°åˆ†è§£ï¼ˆä»…ç”¨è´¨æ•°ï¼‰
        int tmp = n;
        for(int p : primes) {
            if(p*p > tmp) break;
            if(tmp%p) continue;
            cnt++; // è®¡æ•°ä¸åŒè´¨å› æ•°
            while(tmp%p == 0) tmp /= p;
        }
        if(tmp > 1) cnt++; // å¤„ç†å‰©ä½™å¤§è´¨æ•°
        
        cout << (k>cnt ? 0 : S[cnt][k]) << '\n';
    }
}
```
**ä»£ç è§£è¯»æ¦‚è¦**ï¼š
> 1. **çº¿æ€§ç­›é¢„å¤„ç†**ï¼ˆ13-22è¡Œï¼‰ï¼šç”¨bitsetæ ‡è®°è´¨æ•°ï¼Œvectorå­˜å‚¨è´¨æ•°è¡¨  
> 2. **æ–¯ç‰¹æ—æ•°æ‰“è¡¨**ï¼ˆ25-29è¡Œï¼‰ï¼šåŠ¨æ€è§„åˆ’é€’æ¨S[n][k]ï¼Œé¿å…é‡å¤è®¡ç®—  
> 3. **é«˜æ•ˆåˆ†è§£è´¨å› æ•°**ï¼ˆ36-42è¡Œï¼‰ï¼šä»…éå†è´¨æ•°è¡¨ï¼ˆéæ‰€æœ‰æ•´æ•°ï¼‰ï¼Œå¤§å¹…ä¼˜åŒ–  
> 4. **è¾¹ç•Œå¤„ç†**ï¼ˆ44è¡Œï¼‰ï¼šk>cntæ—¶ç›´æ¥è¿”å›0

---

### 5. ç®—æ³•å¯è§†åŒ–ï¼šåƒç´ åŠ¨ç”»æ¼”ç¤º
* **ä¸»é¢˜**ï¼š"è´¨å› æ•°å¤§å†’é™©"ï¼ˆ8ä½åƒç´ é£æ ¼ï¼‰
* **æ ¸å¿ƒæ¼”ç¤º**ï¼šè´¨å› æ•°åˆ†ç»„è¿‡ç¨‹ä¸æ–¯ç‰¹æ—æ•°è®¡æ•°åŸç†

**åŠ¨ç”»è®¾è®¡**ï¼š  
![](https://via.placeholder.com/400x200/222266/FFFFFF?text=åƒç´ åŠ¨ç”»ç¤ºæ„å›¾)  
1. **åœºæ™¯åˆå§‹åŒ–**ï¼š
   - å·¦ä¾§ï¼šnçš„è´¨å› æ•°å±•ç¤ºä¸ºå½©è‰²åƒç´ å—ï¼ˆå¦‚2=è“è‰²æ–¹å—ï¼Œ3=ç»¿è‰²ä¸‰è§’ï¼‰
   - å³ä¾§ï¼škä¸ªå‘å…‰ç›’å­ï¼ˆåºåˆ—ä½ç½®ï¼‰ï¼Œæ§åˆ¶é¢æ¿å«é€Ÿåº¦æ»‘å—/æš‚åœ/é‡ç½®

2. **åŠ¨æ€åˆ†ç»„æ¼”ç¤º**ï¼š
   - **è‡ªåŠ¨æ¨¡å¼**ï¼šåƒç´ å—é£å…¥ç›’å­ï¼ˆä¼´éš8ä½éŸ³æ•ˆï¼‰ï¼ŒåŒç›’åƒç´ å—åˆå¹¶ä¸ºæ–°è‰²å—
   - **å…³é”®æ“ä½œ**ï¼šç›’å­æ»¡æ—¶é—ªçƒ+èƒœåˆ©éŸ³æ•ˆï¼›k>cntæ—¶æ˜¾ç¤ºçº¢å‰+å¤±è´¥éŸ³æ•ˆ
   - **æ•°æ®åŒæ­¥**ï¼šå³ä¾§å®æ—¶æ˜¾ç¤ºå½“å‰æ–¯ç‰¹æ—æ•°S(i,j)å€¼

3. **äº¤äº’è®¾è®¡**ï¼š
   - å•æ­¥æ‰§è¡Œï¼šæŒ‰ç©ºæ ¼é€æ­¥è§‚å¯Ÿåˆ†ç»„é€‰æ‹©
   - é€Ÿåº¦è°ƒèŠ‚ï¼šæ»‘å—æ§åˆ¶0.5x~5xé€Ÿåº¦
   - æ¨¡å¼åˆ‡æ¢ï¼š"åˆ†ç»„è§†å›¾"ï¼ˆé»˜è®¤ï¼‰ä¸"å…¬å¼è§†å›¾"ï¼ˆæ˜¾ç¤ºé€’æ¨å…¬å¼ï¼‰

4. **æ•™å­¦æç¤º**ï¼š
   - åˆ†ç»„æ—¶æ˜¾ç¤ºï¼š"æ¯ä¸ªè´¨å› æ•°å¿…é¡»å®Œæ•´æ”¾å…¥ä¸€ä¸ªç›’å­ï¼"
   - çŠ¶æ€å˜æ›´ï¼š"S(5,3)=25 â†’ æ–°å¢åˆ†ç»„æ–¹æ¡ˆè§¦å‘x3ä¹˜æ³•æ³•åˆ™"

---

### 6. æ‹“å±•ç»ƒä¹ ä¸ç›¸ä¼¼é—®é¢˜æ€è€ƒ
**é€šç”¨æŠ€å·§è¿ç§»**ï¼š  
è´¨å› æ•°åˆ†ç»„æ¨¡å‹è¿˜å¯ç”¨äºï¼š
1. äº’è´¨æ•°å¯¹è®¡æ•°é—®é¢˜ï¼ˆåˆ†ç»„åæ±‚ç»„åˆï¼‰
2. å› å­åˆ†è§£æ–¹æ¡ˆç»Ÿè®¡ï¼ˆå¦‚BZOJ 4802ï¼‰
3. å¸¦çº¦æŸçš„æ•´æ•°åˆ’åˆ†ï¼ˆæ¯ç»„ä¹˜ç§¯é™åˆ¶ï¼‰

**æ´›è°·æ¨è**ï¼š  
1. [P5748 é›†åˆåˆ’åˆ†è®¡æ•°](https://www.luogu.com.cn/problem/P5748)  
   â†’ å·©å›ºæ–¯ç‰¹æ—æ•°æœ¬è´¨ç†è§£  
2. [P1064 é‡‘æ˜çš„é¢„ç®—æ–¹æ¡ˆ](https://www.luogu.com.cn/problem/P1064)  
   â†’ å­¦ä¹ åˆ†ç»„æ€æƒ³åœ¨DPä¸­çš„åº”ç”¨  
3. [P1495 æ›¹å†²å…»çŒª](https://www.luogu.com.cn/problem/P1495)  
   â†’ ç»ƒä¹ è´¨å› æ•°åˆ†è§£ä¸äº’è´¨å…³ç³»  

---

### 7. å­¦ä¹ å¿ƒå¾—ä¸ç»éªŒåˆ†äº«
> **FFTotoroçš„è°ƒè¯•ç»éªŒ**ï¼š  
> *"çº¿æ€§ç­›ä¸­`if(i%p==0)break`æ˜¯å…³é”®ä¼˜åŒ–ï¼Œæ¼å†™ä¼šå¯¼è‡´é‡å¤æ ‡è®°"*  
>   
> **Kayç‚¹è¯„**ï¼š  
> æ­¤æé†’æå…·ä»·å€¼ï¼ç®—æ³•ä¼˜åŒ–å¸¸ä¾èµ–å…³é”®è¾¹ç•Œæ¡ä»¶ï¼Œå»ºè®®ï¼š
> 1. ç”¨å°æ•°æ®æµ‹è¯•è¾¹ç•Œï¼ˆå¦‚n=4ï¼‰
> 2. è¾“å‡ºä¸­é—´å˜é‡éªŒè¯ç­›çš„æ­£ç¡®æ€§
> 3. å¤æ‚åº¦æ•æ„Ÿé—®é¢˜å¿…é¡»ä¸¥æ ¼æ£€æŸ¥ä¼˜åŒ–ç‚¹

---

é€šè¿‡æœ¬æ¬¡åˆ†æï¼Œæˆ‘ä»¬æ·±åˆ»ç†è§£åˆ°ï¼š**å°†å¤æ‚æ¡ä»¶è½¬åŒ–ä¸ºç»„åˆæ¨¡å‹æ˜¯è§£é¢˜å…³é”®**ã€‚è´¨å› æ•°åˆ†è§£+æ–¯ç‰¹æ—æ•°çš„ç»„åˆå±•ç°äº†æ•°å­¦ä¸ç¼–ç¨‹çš„ç¾å¦™ç»“åˆã€‚ä¸‹æ¬¡é‡åˆ°ç±»ä¼¼é—®é¢˜æ—¶ï¼Œè®°å¾—é—®è‡ªå·±ï¼š  
> âœ¨ *"è¿™äº›çº¦æŸæ¡ä»¶èƒ½å¦è½¬åŒ–ä¸ºåˆ†ç»„æ¨¡å‹ï¼Ÿ"*  
> ç»§ç»­åŠ æ²¹ï¼Œç®—æ³•æ¢é™©å®¶ä»¬ï¼ğŸš€

---
å¤„ç†ç”¨æ—¶ï¼š164.78ç§’
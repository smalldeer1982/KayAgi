# é¢˜ç›®ä¿¡æ¯

# ã€ŒSvR-1ã€Problem

## é¢˜ç›®èƒŒæ™¯

å° L æ‰“é¢“è¢« nodgd å‘ç°ï¼Œäºæ˜¯ä»–å¼€å§‹åšé¢˜äº†ã€‚

## é¢˜ç›®æè¿°

ä»–çš„ DS éå¸¸èœï¼Œäºæ˜¯ä»–æŠŠä¸€å…± $n$ é“ DS é¢˜åŠ åˆ°äº†è‡ªå·±çš„è®¡åˆ’é¢˜å•é‡Œï¼Œå…¶ä¸­ç¬¬ $i$ é“é¢˜çš„æœ‰è¶£ç¨‹åº¦ä¸º $a_i$ã€‚

ç”±äºä»–å¹¶ä¸ç²¾é€š DSï¼Œä»–å‘ç°ä»–åœ¨åšä¸€äº›é¢˜ç›®ä¹‹å‰éœ€è¦å…ˆåšå¦ä¸€äº›é¢˜ç›®ã€‚è¿™æ ·çš„å…³ç³»å…±æœ‰ $n - 1$ ç»„ï¼Œä»–è¿˜å‘ç°æ¯é“é¢˜éƒ½å‡ºç°åœ¨äº†è¿™äº›å…³ç³»ä¸­ä¸”æ²¡æœ‰é‡å¤ã€‚

ä»–å‘ç° $\forall 2 \leq i \leq n$ï¼Œç¬¬ $i$ é¢˜å’Œç¬¬ $fa_i$ é¢˜é—´å­˜åœ¨ä¸Šæ–‡æ‰€è¿°çš„å…³ç³»ï¼Œä¸” $1 \leq fa_i < i$ã€‚**ä»–å¿…é¡»å…ˆåšç¬¬ $fa_i$ é¢˜åæ‰èƒ½åšç¬¬ $i$ é¢˜**ã€‚

ä»–å‘ç°ï¼Œå¦‚æœä»–åœ¨åšä¸€é“é¢˜ä¹‹å‰é«˜å…´ç¨‹åº¦ä¸º $k$ï¼Œåˆ™ä»–åšå®Œç¬¬ $i$ é¢˜åï¼Œä»–çš„é«˜å…´ç¨‹åº¦ä¾¿ä¼šå˜ä¸º $\min(k, a_i)$ã€‚**ä»–åšé¢˜å‰çš„é«˜å…´ç¨‹åº¦ä¸ºæ— ç©·å¤§**ã€‚

ä»–æƒ³é—®ä½ **åœ¨å¿…é¡»å…ˆåšç¬¬ $1$ é¢˜ä¸”ä¸èƒ½é‡å¤åšæŸä¸€é“é¢˜**çš„æƒ…å†µä¸‹ï¼Œä»–åœ¨åšé¢˜çš„å…¨è¿‡ç¨‹ä¸­æ¯åšå®Œä¸€é“é¢˜å**é«˜å…´ç¨‹åº¦ä¹‹å’Œçš„æœ€å¤§å€¼**ã€‚

## è¯´æ˜/æç¤º

#### æ ·ä¾‹ #1 è§£é‡Š
åœ¨è¯¥ç»„æ ·ä¾‹ä¸­ $a = [3398922311, 3077554952, 2933028207, 4018360144, 1263042788, 835814542]$ï¼Œ$fa_2 = fa_3 = fa_4 = 1$ï¼Œ$fa_5 = fa_6 = 2$ã€‚

æœ€ä¼˜æ–¹æ¡ˆä¹‹ä¸€ï¼šä¾æ¬¡åšç¬¬ $1, 4, 2, 3, 5, 6$ é¢˜ï¼Œæœ€å¤§å€¼ä¸º $3398922311 + 3398922311 + 3077554952 + 2933028207 + 1263042788 + 835814542 = 14907285111$ã€‚
#### ä¼ªä»£ç å‚è€ƒ
$$
\def{\b}#1{ \textbf{ #1 } }\def{\t}#1{\text{ #1 }}\def{\s}{\quad}\def{\f}#1{\textsf{ #1 }}
\def{\l}{\underline{\kern{300pt}}\\[-10pt]} 
\def{\r}{\overline{\underline{\kern{300pt}}}}
\begin{aligned}
&\r\\&\b{Algorithm:}\t{Get }a_i,fa_i\\[-13pt]&\l\\
&\begin{aligned}
    \f{1.}&\b{function} \b{\color{red}unsigned int} \t{getnext}(\b{\color{red}unsigned int}\&seed): \\
    \f{2.}&\s seed=seed\oplus\t{left}(seed,13)\\
    \f{3.}&\s seed=seed\oplus\t{right}(seed,17)\\
    \f{4.}&\s seed=seed\oplus\t{left}(seed,5) \\
    \f{5.}&\s \b{return} seed\\
    \f{6.}&\b{function} \t{main}(n):\\
    \f{7.}&\s \b{for} i \b{from} 1 \b{to} n \b{step}1\\
    \f{8.}&\s\s a_i=\t{getnext}(seed)\\
    \f{9.}&\s \b{end for} \\
    \f{10.}&\s \b{for} i \b{from} 2 \b{to} n \b{step}1\\
    \f{11.}&\s\s fa_i=\t{getnext}(seed)\bmod(i-1)+1\\
    \f{12.}&\s \b{end for} \\
    \end{aligned}\\[-12pt]
&\r
\end{aligned}
$$

å…¶ä¸­ $\text{left}(x,d)$ å’Œ $\text{right}(x,d)$ åˆ†åˆ«è¡¨ç¤ºå°† $x$ å·¦ç§»æˆ–å³ç§» $d$ ä½ã€‚
#### æ•°æ®è§„æ¨¡ä¸çº¦å®š
**æœ¬é¢˜è‡ªåŠ¨å¼€å¯æ†ç»‘æµ‹è¯•å’Œ O2 ä¼˜åŒ–ã€‚**
$$
\newcommand{\arraystretch}{1.5}
\begin{array}{c|c|c}\hline\hline
\textbf{Subtask} & \bm{n \leq} & \textbf{åˆ†å€¼} \\\hline
\textsf{1} & 10 & 10 \\\hline
\textsf{2} & 10^4 & 20 \\\hline
\textsf{3} & 10^6 & 20 \\\hline
\textsf{4} & \text{æ— ç‰¹æ®Šé™åˆ¶} & 50 \\\hline\hline
\end{array}
$$

å¯¹äº $100\%$ çš„æ•°æ®ï¼Œ$1 \leq n \leq 10^7$ï¼Œ$0 \leq seed < 2^{32}$ã€‚

## æ ·ä¾‹ #1

### è¾“å…¥

```
6 114514```

### è¾“å‡º

```
14907285111```

# AIåˆ†æç»“æœ

# ğŸ’¡ Kayçš„C++ç®—æ³•è§£æï¼šã€ŒSvR-1ã€Problem æ·±å…¥å­¦ä¹ æŒ‡å— ğŸ’¡


## 1. é¢˜ç›®è§£è¯»ä¸æ ¸å¿ƒç®—æ³•è¯†åˆ«

âœ¨ **æœ¬é¢˜ä¸»è¦è€ƒå¯Ÿ**ï¼šç¼–ç¨‹æŠ€å·§åº”ç”¨ï¼ˆåˆ©ç”¨é¢˜ç›®ç‰¹æ®Šæ¡ä»¶ç®€åŒ–è®¡ç®—ï¼‰


### åˆæ­¥åˆ†æ
å¤§å®¶å¥½å‘€ï¼ä»Šå¤©æˆ‘ä»¬è¦è§£å†³çš„é—®é¢˜ï¼Œæ ¸å¿ƒæ˜¯**â€œç”¨é¢˜ç›®ç»™çš„â€˜å°ç§˜å¯†â€™ç®€åŒ–è®¡ç®—â€**â€”â€”å°±åƒç©è¿·å®«æ—¶å‘ç°äº†ä¸€æ¡è¿‘è·¯ï¼Œä¸ç”¨ç»•è¿œè·¯å•¦ï½  
é¢˜ç›®é‡Œè¯´ï¼Œæ¯é“é¢˜çš„çˆ¶èŠ‚ç‚¹`fa_i`ä¸€å®šæ¯”è‡ªå·±çš„ç¼–å·å°ï¼ˆ`fa_i < i`ï¼‰ã€‚è¿™æ„å‘³ç€ä»€ä¹ˆå‘¢ï¼Ÿæ¯”å¦‚ç¬¬5é¢˜çš„çˆ¸çˆ¸åªèƒ½æ˜¯1-4é¢˜ä¸­çš„ä¸€ä¸ªï¼Œè€Œæˆ‘ä»¬å¤„ç†é¢˜ç›®æ—¶æ˜¯æŒ‰1åˆ°nçš„é¡ºåºæ¥çš„â€”â€”**çˆ¸çˆ¸æ°¸è¿œæ¯”å­©å­å…ˆâ€œç™»åœºâ€**ï¼  

é‚£é—®é¢˜å°±å˜ç®€å•å•¦ï¼šæˆ‘ä»¬ä¸éœ€è¦å¤æ‚çš„æ‹“æ‰‘æ’åºæˆ–ä¼˜å…ˆé˜Ÿåˆ—ï¼Œç›´æ¥ä»ç¬¬1é¢˜å¼€å§‹ï¼Œä¾æ¬¡å¤„ç†æ¯ä¸ªèŠ‚ç‚¹ã€‚æ¯ä¸ªèŠ‚ç‚¹çš„â€œè´¡çŒ®â€ï¼ˆä¹Ÿå°±æ˜¯åšå®Œå®ƒåçš„é«˜å…´ç¨‹åº¦ï¼‰ï¼Œå°±æ˜¯è‡ªå·±çš„æƒå€¼`a_i`å’Œçˆ¸çˆ¸çš„è´¡çŒ®çš„æœ€å°å€¼ï¼ˆå› ä¸ºçˆ¸çˆ¸å·²ç»å¤„ç†è¿‡å•¦ï¼Œå®ƒçš„è´¡çŒ®æ—©å°±ç¡®å®šäº†ï¼‰ã€‚  

**æ ¸å¿ƒç®—æ³•æµç¨‹**ï¼š  
1. åˆå§‹åŒ–ç¬¬1é¢˜çš„è´¡çŒ®ä¸º`a_1`ï¼ˆåˆå§‹é«˜å…´ç¨‹åº¦æ˜¯æ— ç©·å¤§ï¼Œç¬¬ä¸€æ¬¡åšé¢˜åè‚¯å®šæ˜¯`a_1`ï¼‰ã€‚  
2. ä»ç¬¬2é¢˜åˆ°ç¬¬né¢˜ï¼Œæ¯ä¸ªèŠ‚ç‚¹`i`çš„è´¡çŒ® = `min(a_i, çˆ¸çˆ¸çš„è´¡çŒ®)`ã€‚  
3. æŠŠæ‰€æœ‰èŠ‚ç‚¹çš„è´¡çŒ®åŠ èµ·æ¥ï¼Œå°±æ˜¯ç­”æ¡ˆï¼  

**å¯è§†åŒ–è®¾è®¡æ€è·¯**ï¼š  
æˆ‘ä»¬ä¼šç”¨**8ä½åƒç´ é£**åšä¸€æ£µâ€œå®¶è°±æ ‘â€â€”â€”æ¯ä¸ªèŠ‚ç‚¹æ˜¯å½©è‰²åƒç´ å—ï¼Œçˆ¸çˆ¸åœ¨å·¦ï¼Œå­©å­åœ¨å³ã€‚å¤„ç†æ¯ä¸ªèŠ‚ç‚¹æ—¶ï¼š  
- çˆ¸çˆ¸çš„åƒç´ å—ä¼šå…ˆâ€œäº®èµ·æ¥â€ï¼ˆè¡¨ç¤ºå·²ç»å¤„ç†ï¼‰ï¼›  
- å­©å­çš„åƒç´ å—ä¼šä»çˆ¸çˆ¸é‚£é‡Œâ€œç»§æ‰¿â€é¢œè‰²ï¼ˆæ¯”å¦‚çˆ¸çˆ¸æ˜¯è“è‰²ï¼Œå­©å­å¦‚æœæ›´å°å°±å˜æˆæµ…è“è‰²ï¼‰ï¼›  
- æ¯æ¬¡è®¡ç®—è´¡çŒ®æ—¶ï¼Œä¼´éšâ€œå®â€çš„åƒç´ éŸ³æ•ˆï¼Œå®Œæˆæ‰€æœ‰èŠ‚ç‚¹åæ’­æ”¾â€œèƒœåˆ©è¿›è¡Œæ›²â€ï¼ˆ8ä½é£æ ¼å“¦ï½ï¼‰ã€‚  


## 2. ç²¾é€‰ä¼˜è´¨é¢˜è§£å‚è€ƒ

### é¢˜è§£ä¸€ï¼šï¼ˆæ¥æºï¼šliangbowenï¼‰
**ç‚¹è¯„**ï¼šè¿™ä»½é¢˜è§£æŠŠâ€œæš´åŠ›â†’éƒ¨åˆ†åˆ†â†’æ­£è§£â€è®²å¾—è¶…æ¸…æ¥šï¼æš´åŠ›ç”¨DFSï¼ˆ10åˆ†ï¼‰ï¼Œéƒ¨åˆ†åˆ†ç”¨ä¼˜å…ˆé˜Ÿåˆ—æ‹“æ‰‘æ’åºï¼ˆ50åˆ†ï¼‰ï¼Œæ­£è§£ç›´æ¥åˆ©ç”¨`fa_i < i`çš„é¡ºåºé€’æ¨ï¼ˆ100åˆ†ï¼‰ã€‚æ€è·¯å±‚å±‚é€’è¿›ï¼Œä»£ç é£æ ¼ä¹Ÿå¾ˆè§„èŒƒâ€”â€”æ¯”å¦‚å˜é‡å`a[i]`ã€`fa[i]`ä¸€çœ‹å°±æ‡‚ï¼Œé€’æ¨éƒ¨åˆ†çš„ä»£ç æ›´æ˜¯ç®€æ´åˆ°â€œä¸€å¥è¯è§£å†³â€ã€‚æœ€æ£’çš„æ˜¯ï¼Œå®ƒå¸®æˆ‘ä»¬çœ‹æ¸…äº†â€œå¤æ‚æ–¹æ³•â€å’Œâ€œç®€å•æ–¹æ³•â€çš„åŒºåˆ«ï¼ŒçœŸæ­£ç†è§£äº†é¢˜ç›®ä¸­çš„â€œå°ç§˜å¯†â€æœ‰å¤šé‡è¦ï¼


### é¢˜è§£äºŒï¼šï¼ˆæ¥æºï¼šHisaishi_Kanadeï¼‰
**ç‚¹è¯„**ï¼šè¿™é¢˜è§£çš„â€œäº®ç‚¹â€æ˜¯**ç›´æ¥å¤ç”¨æ•°ç»„**â€”â€”æŠŠæ¯ä¸ªèŠ‚ç‚¹çš„è´¡çŒ®å­˜åœ¨`a[i]`é‡Œï¼Œçœäº†é¢å¤–ç©ºé—´ï¼ä»£ç é‡Œ`a[i] = min(a[i], a[fa[i]])`ä¸€å¥è¯ï¼Œå°±å®Œæˆäº†è´¡çŒ®çš„è®¡ç®—ã€‚è€Œä¸”å®ƒç‰¹åˆ«æé†’äº†â€œæ•°æ®ç±»å‹â€çš„é—®é¢˜ï¼ˆç”¨`long long`å­˜ç­”æ¡ˆï¼‰ï¼Œé¿å…äº†æº¢å‡ºé”™è¯¯ã€‚å¯¹äºåˆšå¼€å§‹å­¦ç¼–ç¨‹çš„ä½ æ¥è¯´ï¼Œè¿™ç§â€œçœç©ºé—´+é¿å‘â€çš„æŠ€å·§è¶…å®ç”¨ï¼


### é¢˜è§£ä¸‰ï¼šï¼ˆæ¥æºï¼šPolaris_Australis_ï¼‰
**ç‚¹è¯„**ï¼šè¿™é¢˜è§£çš„ä»£ç ç»“æ„å¾ˆæ¸…æ™°ï¼ŒæŠŠâ€œç”Ÿæˆæ•°æ®â€â€œè®¡ç®—è´¡çŒ®â€â€œè¾“å‡ºç­”æ¡ˆâ€åˆ†æˆäº†æ˜ç¡®çš„æ­¥éª¤ã€‚å®ƒè¿˜ç”¨äº†`minn`æ•°ç»„å•ç‹¬å­˜æ¯ä¸ªèŠ‚ç‚¹çš„è´¡çŒ®ï¼Œè®©é€»è¾‘æ›´ç›´è§‚â€”â€”å³ä½¿ä½ åˆšå¼€å§‹å­¦ï¼Œä¹Ÿèƒ½ä¸€çœ¼çœ‹æ˜ç™½â€œæ¯ä¸ªèŠ‚ç‚¹çš„è´¡çŒ®æ¥è‡ªå“ªé‡Œâ€ã€‚è€Œä¸”å®ƒçš„è¾“å…¥è¾“å‡ºç”¨äº†è‡ªå·±å†™çš„`read`å’Œ`write`å‡½æ•°ï¼Œé¿å…äº†`cin/cout`çš„æ…¢é€Ÿåº¦ï¼Œè¿™ä¹Ÿæ˜¯â€œå¡å¸¸â€çš„å°æŠ€å·§å“¦ï½


## 3. æ ¸å¿ƒéš¾ç‚¹è¾¨æä¸è§£é¢˜ç­–ç•¥

### å…³é”®ç‚¹1ï¼šä¸ºä»€ä¹ˆâ€œçˆ¸çˆ¸çš„è´¡çŒ®ä¸€å®šæ¯”å­©å­å…ˆç¡®å®šï¼Ÿâ€
**åˆ†æ**ï¼šé¢˜ç›®é‡Œè¯´`fa_i < i`ï¼Œæ‰€ä»¥å½“æˆ‘ä»¬å¤„ç†ç¬¬`i`é¢˜æ—¶ï¼Œç¬¬`fa_i`é¢˜å·²ç»è¢«å¤„ç†è¿‡äº†ï¼ˆæ¯”å¦‚å¤„ç†ç¬¬5é¢˜æ—¶ï¼Œçˆ¸çˆ¸1-4é¢˜æ—©å°±å¤„ç†å®Œå•¦ï¼‰ã€‚è¿™å°±åƒæ’é˜Ÿä¹°å†°æ·‡æ·‹ï¼Œçˆ¸çˆ¸æ°¸è¿œåœ¨ä½ å‰é¢ï¼Œä½ èƒ½ç›´æ¥é—®çˆ¸çˆ¸â€œä½ èŠ±äº†å¤šå°‘é’±â€ï¼Œä¸ç”¨ç­‰åé¢çš„äººï½  
**è§£å†³ç­–ç•¥**ï¼šæŒ‰1åˆ°nçš„é¡ºåºå¤„ç†èŠ‚ç‚¹ï¼Œç›´æ¥ç”¨çˆ¸çˆ¸çš„è´¡çŒ®ç®—å­©å­çš„è´¡çŒ®ï¼


### å…³é”®ç‚¹2ï¼šä¸ºä»€ä¹ˆâ€œè´¡çŒ®æ˜¯min(a_i, çˆ¸çˆ¸çš„è´¡çŒ®)ï¼Ÿâ€
**åˆ†æ**ï¼šé«˜å…´ç¨‹åº¦ä¼šå˜æˆ`min(å½“å‰å€¼, a_i)`ï¼Œè€Œçˆ¸çˆ¸çš„è´¡çŒ®æ˜¯â€œåšå®Œçˆ¸çˆ¸åçš„é«˜å…´ç¨‹åº¦â€ã€‚å› ä¸ºå¿…é¡»å…ˆåšçˆ¸çˆ¸å†åšå­©å­ï¼Œæ‰€ä»¥å­©å­çš„é«˜å…´ç¨‹åº¦è‚¯å®šä¸ä¼šè¶…è¿‡çˆ¸çˆ¸çš„â€”â€”å°±åƒä½ å…ˆåƒäº†ä¸€ä¸ªç”œç­’ï¼ˆé«˜å…´å€¼5ï¼‰ï¼Œå†åƒä¸€ä¸ªé›ªç³•ï¼ˆå€¼3ï¼‰ï¼Œé«˜å…´å€¼åªä¼šå˜æˆ3ï¼Œä¸ä¼šå˜é«˜ï½  
**è§£å†³ç­–ç•¥**ï¼šæ¯ä¸ªå­©å­çš„è´¡çŒ® = `min(a_i, çˆ¸çˆ¸çš„è´¡çŒ®)`ï¼Œè¿™æ ·æ€»å’Œä¸€å®šæ˜¯æœ€å¤§çš„ï¼


### å…³é”®ç‚¹3ï¼šä¸ºä»€ä¹ˆä¸èƒ½ç”¨â€œä¼˜å…ˆé˜Ÿåˆ—â€ï¼Ÿ
**åˆ†æ**ï¼šä¼˜å…ˆé˜Ÿåˆ—çš„æ—¶é—´å¤æ‚åº¦æ˜¯`O(n log n)`ï¼Œå¯¹äº`n=1e7`æ¥è¯´ï¼Œä¼šâ€œè¶…æ—¶â€ï¼ˆå°±åƒä½ è·‘1000ç±³ç”¨äº†10åˆ†é’Ÿï¼Œè‚¯å®šä¸åŠæ ¼ï¼‰ã€‚è€Œç”¨é¡ºåºé€’æ¨æ˜¯`O(n)`ï¼Œå°±åƒéª‘è‡ªè¡Œè½¦æ¯”èµ°è·¯å¿«å¤šå•¦ï½  
**è§£å†³ç­–ç•¥**ï¼šæŠ“ä½é¢˜ç›®ä¸­çš„â€œfa_i < iâ€è¿™ä¸ªâ€œå°ç§˜å¯†â€ï¼Œä¸ç”¨å¤æ‚çš„æ•°æ®ç»“æ„ï¼


### âœ¨ è§£é¢˜æŠ€å·§æ€»ç»“
- **æ‰¾â€œå°ç§˜å¯†â€**ï¼šé¢˜ç›®é‡Œçš„ç‰¹æ®Šæ¡ä»¶ï¼ˆæ¯”å¦‚`fa_i < i`ï¼‰å¾€å¾€æ˜¯ç®€åŒ–é—®é¢˜çš„å…³é”®ï¼Œè¦åƒä¾¦æ¢ä¸€æ ·æ•é”å“¦ï½  
- **çœç©ºé—´**ï¼šèƒ½ç”¨åŸæ•°ç»„å­˜ç»“æœå°±ä¸ç”¨æ–°æ•°ç»„ï¼ˆæ¯”å¦‚æŠŠè´¡çŒ®å­˜åœ¨`a[i]`é‡Œï¼‰ï¼Œå‡å°‘å†…å­˜ä½¿ç”¨ã€‚  
- **é¿å‘**ï¼šæ€»å’Œè¦å¼€`long long`ï¼ˆæ¯”å¦‚1e7ä¸ª`1e9`çš„æ•°ç›¸åŠ ï¼Œ`int`ä¼šçˆ†æ‰ï¼ï¼‰ã€‚  


## 4. C++æ ¸å¿ƒä»£ç å®ç°èµæ

### æœ¬é¢˜é€šç”¨æ ¸å¿ƒC++å®ç°å‚è€ƒ
**è¯´æ˜**ï¼šè¿™ä»½ä»£ç ç»¼åˆäº†æ‰€æœ‰ä¼˜è´¨é¢˜è§£çš„æ€è·¯ï¼Œæ˜¯æœ€ç®€æ´é«˜æ•ˆçš„å®ç°ï½  
**å®Œæ•´æ ¸å¿ƒä»£ç **ï¼š
```cpp
#include <iostream>
using namespace std;

typedef unsigned int uint;
typedef unsigned long long ULL;

const int MAXN = 10000010;
uint a[MAXN], fa[MAXN];

inline uint get_next(uint &seed) {
    seed ^= seed << 13;
    seed ^= seed >> 17;
    seed ^= seed << 5;
    return seed;
}

int main() {
    int n;
    uint seed;
    cin >> n >> seed;

    // ç”Ÿæˆæ¯ä¸ªé¢˜ç›®çš„æƒå€¼a[i]
    for (int i = 1; i <= n; ++i) {
        a[i] = get_next(seed);
    }

    ULL sum = a[1];  // ç¬¬1é¢˜çš„è´¡çŒ®å°±æ˜¯a[1]
    for (int i = 2; i <= n; ++i) {
        fa[i] = get_next(seed) % (i - 1) + 1;  // ç”Ÿæˆçˆ¶èŠ‚ç‚¹
        a[i] = min(a[i], a[fa[i]]);            // è®¡ç®—å½“å‰é¢˜çš„è´¡çŒ®
        sum += a[i];                           // ç´¯åŠ ç­”æ¡ˆ
    }

    cout << sum << endl;
    return 0;
}
```
**ä»£ç è§£è¯»æ¦‚è¦**ï¼š  
1. **ç”Ÿæˆæ•°æ®**ï¼šç”¨é¢˜ç›®ç»™çš„`get_next`å‡½æ•°ç”Ÿæˆæ¯ä¸ªé¢˜ç›®çš„æƒå€¼`a[i]`å’Œçˆ¶èŠ‚ç‚¹`fa[i]`ã€‚  
2. **è®¡ç®—è´¡çŒ®**ï¼šä»ç¬¬2é¢˜å¼€å§‹ï¼Œæ¯ä¸ªé¢˜çš„è´¡çŒ®æ˜¯è‡ªå·±å’Œçˆ¸çˆ¸çš„æœ€å°å€¼ï¼ˆç›´æ¥å­˜åœ¨`a[i]`é‡Œï¼Œçœç©ºé—´ï¼ï¼‰ã€‚  
3. **ç´¯åŠ ç­”æ¡ˆ**ï¼šç”¨`ULL`ï¼ˆæ— ç¬¦å·é•¿æ•´å‹ï¼‰å­˜æ€»å’Œï¼Œé¿å…æº¢å‡ºã€‚  


### é¢˜è§£ä¸€ï¼šï¼ˆæ¥æºï¼šliangbowenï¼‰
**äº®ç‚¹**ï¼šæŠŠâ€œæš´åŠ›â†’æ­£è§£â€çš„è¿›åŒ–è¿‡ç¨‹å†™å¾—è¶…æ¸…æ¥šï¼Œå¸®ä½ ç†è§£â€œä¸ºä»€ä¹ˆè¦è¿™æ ·åšâ€ï½  
**æ ¸å¿ƒä»£ç ç‰‡æ®µ**ï¼š
```cpp
// æ­£è§£éƒ¨åˆ†ï¼šç›´æ¥é€’æ¨
ULL sum = a[1];
for (int i = 2; i <= n; i++) {
    a[i] = min(a[i], a[fa[i]]);
    sum += a[i];
}
```
**ä»£ç è§£è¯»**ï¼š  
è¿™æ®µä»£ç æ˜¯æ•´ä¸ªé—®é¢˜çš„â€œçµé­‚â€ï¼`a[i] = min(a[i], a[fa[i]])`è¡¨ç¤ºï¼šç¬¬`i`é¢˜çš„è´¡çŒ®æ˜¯è‡ªå·±å’Œçˆ¸çˆ¸çš„æœ€å°å€¼â€”â€”å› ä¸ºçˆ¸çˆ¸å·²ç»å¤„ç†è¿‡äº†ï¼Œå®ƒçš„è´¡çŒ®`a[fa[i]]`æ—©å°±ç¡®å®šå•¦ï½ç„¶åæŠŠæ‰€æœ‰è´¡çŒ®åŠ èµ·æ¥ï¼Œå°±æ˜¯ç­”æ¡ˆï¼æ˜¯ä¸æ˜¯è¶…ç®€å•ï¼Ÿ  
**å­¦ä¹ ç¬”è®°**ï¼šé‡åˆ°â€œçˆ¶èŠ‚ç‚¹å…ˆå¤„ç†â€çš„é—®é¢˜ï¼Œç›´æ¥ç”¨é¡ºåºé€’æ¨ï¼Œä¸ç”¨ç»•è¿œè·¯ï¼


### é¢˜è§£äºŒï¼šï¼ˆæ¥æºï¼šHisaishi_Kanadeï¼‰
**äº®ç‚¹**ï¼šå¤ç”¨`a`æ•°ç»„å­˜è´¡çŒ®ï¼Œçœç©ºé—´åˆé«˜æ•ˆï½  
**æ ¸å¿ƒä»£ç ç‰‡æ®µ**ï¼š
```cpp
ans = a[1];
for (i = 2; i <= n; ++i)
    ans += a[i] = min(a[i], a[fa[i]]);
```
**ä»£ç è§£è¯»**ï¼š  
è¿™é‡ŒæŠŠâ€œè®¡ç®—è´¡çŒ®â€å’Œâ€œç´¯åŠ ç­”æ¡ˆâ€å†™åœ¨åŒä¸€å¥è¯é‡Œâ€”â€”`a[i] = min(...)`è®¡ç®—è´¡çŒ®ï¼Œç„¶åç›´æ¥åŠ åˆ°`ans`é‡Œã€‚è¿™ç§â€œåˆå¹¶æ“ä½œâ€çš„æŠ€å·§ï¼Œèƒ½è®©ä»£ç æ›´ç®€æ´å“¦ï½  
**å­¦ä¹ ç¬”è®°**ï¼šèƒ½åˆå¹¶çš„æ“ä½œå°½é‡åˆå¹¶ï¼Œä»£ç ä¼šæ›´â€œèªæ˜â€ï¼


## 5. ç®—æ³•å¯è§†åŒ–ï¼šåƒç´ åŠ¨ç”»æ¼”ç¤º

### åŠ¨ç”»ä¸»é¢˜ï¼šåƒç´ æ ‘çš„â€œè´¡çŒ®ç»§æ‰¿â€ä¹‹æ—…


### è®¾è®¡æ€è·¯
æˆ‘ä»¬ç”¨**FCçº¢ç™½æœºé£æ ¼**åšä¸€ä¸ªåƒç´ æ ‘ï¼Œæ¯ä¸ªèŠ‚ç‚¹æ˜¯16x16çš„å½©è‰²æ–¹å—ï¼Œçˆ¶èŠ‚ç‚¹åœ¨å·¦ï¼Œå­èŠ‚ç‚¹åœ¨å³ã€‚è¿™æ ·è®¾è®¡çš„åŸå› æ˜¯ï¼š  
- åƒç´ é£å¾ˆå¤å¤ï¼Œåƒå°æ—¶å€™ç©çš„æ¸¸æˆï¼Œå®¹æ˜“å¼•èµ·å…´è¶£ï¼›  
- æ ‘çš„ç»“æ„ç›´è§‚ï¼Œèƒ½æ¸…æ¥šçœ‹åˆ°â€œçˆ¸çˆ¸â†’å­©å­â€çš„è´¡çŒ®ä¼ é€’ï¼›  
- éŸ³æ•ˆå’ŒåŠ¨ç”»èƒ½å¼ºåŒ–è®°å¿†ï¼Œæ¯”å¦‚å¤„ç†èŠ‚ç‚¹æ—¶çš„â€œå®â€å£°ï¼Œè®©ä½ è®°ä½â€œè¿™ä¸€æ­¥åœ¨ç®—è´¡çŒ®â€ï½


### åŠ¨ç”»å¸§æ­¥éª¤ä¸äº¤äº’è®¾è®¡
1. **åœºæ™¯åˆå§‹åŒ–**ï¼š  
   - å±å¹•å·¦ä¾§æ˜¯åƒç´ æ ‘ï¼ˆç¬¬1é¢˜åœ¨æœ€å·¦è¾¹ï¼Œå­èŠ‚ç‚¹ä¾æ¬¡å‘å³æ’åˆ—ï¼‰ï¼›  
   - å³ä¾§æ˜¯æ§åˆ¶é¢æ¿ï¼šæœ‰â€œå¼€å§‹/æš‚åœâ€â€œå•æ­¥â€â€œé‡ç½®â€æŒ‰é’®ï¼Œè¿˜æœ‰é€Ÿåº¦æ»‘å—ï¼ˆå¯ä»¥è°ƒåŠ¨ç”»å¿«æ…¢ï¼‰ï¼›  
   - èƒŒæ™¯æ’­æ”¾8ä½é£æ ¼çš„è½»å¿«éŸ³ä¹ï¼ˆåƒã€Šè¶…çº§é©¬é‡Œå¥¥ã€‹çš„èƒŒæ™¯éŸ³ä¹ï¼‰ã€‚  

2. **ç®—æ³•å¯åŠ¨**ï¼š  
   - ç¬¬1é¢˜çš„åƒç´ å—å˜æˆçº¢è‰²ï¼ˆè¡¨ç¤ºåˆå§‹è´¡çŒ®`a[1]`ï¼‰ï¼Œä¼´éšâ€œå®â€çš„éŸ³æ•ˆã€‚  

3. **æ ¸å¿ƒæ­¥éª¤æ¼”ç¤º**ï¼š  
   - å¤„ç†ç¬¬2é¢˜æ—¶ï¼Œå…ˆæ‰¾åˆ°å®ƒçš„çˆ¸çˆ¸ï¼ˆæ¯”å¦‚ç¬¬1é¢˜ï¼‰ï¼Œçˆ¸çˆ¸çš„çº¢è‰²å—ä¼šâ€œé—ªä¸€ä¸‹â€ï¼›  
   - ç¬¬2é¢˜çš„å—å˜æˆ`min(è‡ªå·±çš„é¢œè‰², çˆ¸çˆ¸çš„é¢œè‰²)`ï¼ˆæ¯”å¦‚çˆ¸çˆ¸æ˜¯çº¢è‰²ï¼Œè‡ªå·±æ˜¯è“è‰²ï¼Œå°±å˜æˆç´«è‰²ï¼‰ï¼›  
   - åŒæ—¶ï¼Œæ§åˆ¶é¢æ¿ä¸Šä¼šæ˜¾ç¤ºå½“å‰æ­¥éª¤çš„ä»£ç ç‰‡æ®µï¼ˆ`a[2] = min(a[2], a[fa[2]])`ï¼‰ï¼Œè¿˜æœ‰Kayçš„æç¤ºï¼šâ€œç¬¬2é¢˜çš„è´¡çŒ®æ˜¯çˆ¸çˆ¸å’Œè‡ªå·±çš„æœ€å°å€¼å“¦ï½â€ã€‚  

4. **äº¤äº’åŠŸèƒ½**ï¼š  
   - **å•æ­¥æ‰§è¡Œ**ï¼šç‚¹å‡»â€œå•æ­¥â€æŒ‰é’®ï¼ŒåŠ¨ç”»èµ°ä¸€æ­¥ï¼Œèƒ½ä»”ç»†çœ‹æ¯ä¸ªèŠ‚ç‚¹çš„å˜åŒ–ï¼›  
   - **è‡ªåŠ¨æ’­æ”¾**ï¼šç‚¹å‡»â€œå¼€å§‹â€ï¼ŒåŠ¨ç”»æŒ‰è®¾å®šé€Ÿåº¦è‡ªåŠ¨è¿è¡Œï¼Œåƒâ€œAIç©æ¸¸æˆâ€ä¸€æ ·å®Œæˆæ‰€æœ‰èŠ‚ç‚¹ï¼›  
   - **é‡ç½®**ï¼šç‚¹å‡»â€œé‡ç½®â€ï¼Œå›åˆ°åˆå§‹çŠ¶æ€ï¼Œé‡æ–°å¼€å§‹ã€‚  

5. **ç»“æŸçŠ¶æ€**ï¼š  
   - æ‰€æœ‰èŠ‚ç‚¹å¤„ç†å®Œåï¼Œæ•´ä¸ªåƒç´ æ ‘ä¼šâ€œé—ªä¸‰ä¸‹â€ï¼Œä¼´éšèƒœåˆ©éŸ³æ•ˆï¼ˆåƒã€Šé­‚æ–—ç½—ã€‹é€šå…³çš„éŸ³ä¹ï¼‰ï¼›  
   - å±å¹•ä¸­å¤®æ˜¾ç¤ºâ€œå®Œæˆï¼æ€»å’Œæ˜¯XXXâ€ï¼Œè¶…æœ‰æˆå°±æ„Ÿï½


## 6. æ‹“å±•ç»ƒä¹ ä¸ç›¸ä¼¼é—®é¢˜æ€è€ƒ

### é€šç”¨æ€è·¯è¿ç§»
æœ¬é¢˜çš„æ ¸å¿ƒæŠ€å·§æ˜¯**â€œåˆ©ç”¨é¡ºåºæ¡ä»¶ç®€åŒ–é€’æ¨â€**â€”â€”å½“çˆ¶èŠ‚ç‚¹ä¸€å®šæ¯”å­©å­å…ˆå¤„ç†æ—¶ï¼Œç›´æ¥ç”¨é¡ºåºé€’æ¨å°±èƒ½è§£å†³é—®é¢˜ã€‚è¿™ç§æ€è·¯è¿˜èƒ½ç”¨åˆ°è¿™äº›åœºæ™¯ï¼š  
1. **æ ‘å½¢DP**ï¼šæ¯”å¦‚è®¡ç®—æ¯ä¸ªèŠ‚ç‚¹çš„å­æ ‘å’Œï¼Œçˆ¶èŠ‚ç‚¹å¯ä»¥ç›´æ¥ç”¨å­èŠ‚ç‚¹çš„ç»“æœï¼›  
2. **é“¾è¡¨é—®é¢˜**ï¼šæ¯”å¦‚åè½¬é“¾è¡¨ï¼Œå‰é©±èŠ‚ç‚¹ä¸€å®šåœ¨å½“å‰èŠ‚ç‚¹å‰é¢ï¼›  
3. **åŠ¨æ€è§„åˆ’**ï¼šæ¯”å¦‚â€œæœ€é•¿ä¸Šå‡å­åºåˆ—â€ï¼Œå‰é¢çš„çŠ¶æ€å·²ç»å¤„ç†è¿‡äº†ã€‚


### æ´›è°·æ¨èç»ƒä¹ 
1. **P1352 æ²¡æœ‰ä¸Šå¸çš„èˆä¼š**ï¼šæ ‘å½¢DPé—®é¢˜ï¼Œéœ€è¦è®¡ç®—æ¯ä¸ªèŠ‚ç‚¹é€‰æˆ–ä¸é€‰çš„æœ€å¤§å€¼â€”â€”å’Œæœ¬é¢˜ä¸€æ ·ï¼Œçˆ¶èŠ‚ç‚¹çš„çŠ¶æ€å½±å“å­èŠ‚ç‚¹ã€‚  
2. **P2015 äºŒå‰è‹¹æœæ ‘**ï¼šæ ‘å½¢DPé—®é¢˜ï¼Œè¦æ±‚ä¿ç•™kæ¡è¾¹çš„æœ€å¤§æƒå€¼å’Œâ€”â€”ç»ƒä¹ â€œçˆ¶èŠ‚ç‚¹â†’å­èŠ‚ç‚¹â€çš„é€’æ¨ã€‚  
3. **P3174 åˆ‡ç³•**ï¼šè™½ç„¶ä¸æ˜¯æ ‘ï¼Œä½†ç”¨åˆ°äº†â€œç›¸é‚»èŠ‚ç‚¹çš„çº¦æŸâ€ï¼Œéœ€è¦ç”¨ç±»ä¼¼çš„é€’æ¨æ€è·¯ã€‚  


## 7. å­¦ä¹ å¿ƒå¾—ä¸ç»éªŒåˆ†äº«

### å‚è€ƒç»éªŒï¼ˆæ¥è‡ªï¼šliangbowenï¼‰
â€œæˆ‘åˆšå¼€å§‹ç”¨DFSåšï¼Œåªèƒ½æ‹¿10åˆ†ï¼›åæ¥ç”¨ä¼˜å…ˆé˜Ÿåˆ—æ‹¿äº†50åˆ†ï¼Œä½†è¿˜æ˜¯è¶…æ—¶ã€‚æœ€åå‘ç°`fa_i < i`çš„ç§˜å¯†ï¼Œç›´æ¥é€’æ¨å°±è¿‡äº†ï¼â€  
**ç‚¹è¯„**ï¼šè¿™ä½ä½œè€…çš„ç»å†å¾ˆå…¸å‹å“¦ï½å¾ˆå¤šæ—¶å€™ï¼Œä¸æ˜¯ç®—æ³•ä¸å¤Ÿâ€œé«˜çº§â€ï¼Œè€Œæ˜¯æ²¡å‘ç°é¢˜ç›®ç»™çš„â€œå°ç§˜å¯†â€ã€‚é‡åˆ°é—®é¢˜æ—¶ï¼Œå…ˆä»”ç»†çœ‹é¢˜ç›®æ¡ä»¶ï¼Œè¯´ä¸å®šèƒ½æ‰¾åˆ°è¿‘è·¯ï¼


### å‚è€ƒç»éªŒï¼ˆæ¥è‡ªï¼šHisaishi_Kanadeï¼‰
â€œæˆ‘ä¸€å¼€å§‹ç”¨é“¾å¼å‰å‘æ˜Ÿå»ºå›¾ï¼Œç»“æœè¶…æ—¶äº†ã€‚åæ¥ç›´æ¥ç”¨æ•°ç»„é€’æ¨ï¼Œå°±è¿‡äº†ï¼â€  
**ç‚¹è¯„**ï¼šé“¾å¼å‰å‘æ˜Ÿè™½ç„¶é€šç”¨ï¼Œä½†å¯¹äº`n=1e7`æ¥è¯´å¤ªæ…¢äº†ã€‚è¿™æé†’æˆ‘ä»¬ï¼š**é’ˆå¯¹é¢˜ç›®ç‰¹ç‚¹é€‰æ‹©æœ€ç®€æ´çš„æ–¹æ³•ï¼Œæ¯”â€œç”¨é«˜çº§æ•°æ®ç»“æ„â€æ›´é‡è¦**ï¼


## ç»“è¯­
è¿™æ¬¡çš„é—®é¢˜ï¼Œæ ¸å¿ƒæ˜¯â€œç”¨é¢˜ç›®ç»™çš„é¡ºåºæ¡ä»¶ç®€åŒ–è®¡ç®—â€â€”â€”å°±åƒå‘ç°äº†è¿·å®«çš„è¿‘è·¯ï¼Œä¸ç”¨ç»•è¿œè·¯å•¦ï½å¸Œæœ›å¤§å®¶ä»¥åé‡åˆ°é—®é¢˜æ—¶ï¼Œå…ˆä»”ç»†çœ‹é¢˜ç›®æ¡ä»¶ï¼Œè¯´ä¸å®šèƒ½æ‰¾åˆ°â€œå°ç§˜å¯†â€å“¦ï½  

ç¼–ç¨‹çš„ä¹è¶£ï¼Œå°±åœ¨äºä¸æ–­å‘ç°â€œæ›´èªæ˜çš„æ–¹æ³•â€ï¼ä¸‹æ¬¡æˆ‘ä»¬å†ä¸€èµ·æ¢ç´¢æ–°çš„æŒ‘æˆ˜ï½ğŸ’ª

---
å¤„ç†ç”¨æ—¶ï¼š89.56ç§’
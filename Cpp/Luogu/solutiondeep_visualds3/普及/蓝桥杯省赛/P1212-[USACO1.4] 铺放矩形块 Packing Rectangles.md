# 题目信息

# [USACO1.4] 铺放矩形块 Packing Rectangles

## 题目描述

给定 $4$ 个矩形块，找出一个最小的封闭矩形将这 $4$ 个矩形块放入，但不得相互重叠。所谓最小矩形指该矩形面积最小。

![](https://cdn.luogu.com.cn/upload/image_hosting/gu39gbyb.png)

$4$ 个矩形块中任一个矩形的边都与封闭矩形的边相平行，上图显示出了铺放 $4$ 个矩形块的 $6$ 种方案。  

这 $6$ 种方案是唯一可能的基本铺放方案。因为其它方案能由基本方案通过旋转和镜像反射得到。

可能存在满足条件且有着同样面积的各种不同的封闭矩形，你应该输出所有这些封闭矩形的边长。



## 说明/提示

【数据范围】  
对于 $100\%$ 的数据，输入的所有数在 $[1,50]$ 内。

题目翻译来自NOCOW。

USACO Training Section 1.4


## 样例 #1

### 输入

```
1 2
2 3
3 4
4 5
```

### 输出

```
40
4 10
5 8
```

# AI分析结果


# 💡 Kay的C++算法解析：铺放矩形块 深入学习指南 💡

**引言**  
今天我们来分析"铺放矩形块"这道C++编程题。本指南将帮助大家理解如何将四个矩形放入最小面积的封闭矩形中，掌握枚举和模拟的核心技巧。

## 1. 题目解读与核心算法识别

✨ **本题主要考察**：`枚举与模拟`  

🗣️ **初步分析**：  
> 解决这道题就像玩俄罗斯方块——我们需要将四个不同形状的方块放入最小矩形框中。核心思想是通过**枚举所有可能的排列和旋转状态**，然后计算六种基本排列方式下的矩形尺寸。  
> - **核心难点**在于处理第六种排列的复杂分支情况，需要分情况讨论矩形堆叠关系  
> - **可视化设计**：采用8位像素风格展示排列过程，不同颜色方块代表不同矩形。动画将高亮当前计算的封闭矩形边界，播放"方块旋转"和"成功匹配"音效，通过AI自动演示六种排列方案  

---

## 2. 精选优质题解参考

**题解一（来源：七喜）**  
* **点评**：  
  思路清晰度⭐⭐⭐⭐⭐ - 使用DFS生成排列，代码结构层次分明  
  代码规范性⭐⭐⭐⭐ - 变量命名合理（tmpx/tmpy），边界处理严谨  
  算法有效性⭐⭐⭐⭐ - 完整实现六种排列计算，时间复杂度O(4!×2⁴)  
  实践价值⭐⭐⭐⭐ - 可直接用于竞赛，check()函数模块化设计便于调试  
  **亮点**：巧妙用check()函数封装六种排列计算，避免代码冗余  

**题解二（来源：HFUUZY）**  
* **点评**：  
  思路清晰度⭐⭐⭐⭐ - 四重循环处理旋转状态，逻辑直白  
  代码规范性⭐⭐⭐⭐⭐ - swap函数封装规范，update函数职责单一  
  算法有效性⭐⭐⭐⭐ - 通过calc函数集中处理排列计算  
  **亮点**：使用函数封装核心计算，增强代码可读性和复用性  

**题解三（来源：Chiesl）**  
* **点评**：  
  思路清晰度⭐⭐⭐⭐⭐ - 对六种排列的数学推导尤为详尽  
  代码规范性⭐⭐⭐⭐ - answer函数统一处理结果更新  
  实践价值⭐⭐⭐⭐ - 结构体存储结果便于排序输出  
  **亮点**：图文并茂解释第六种排列的子情况，降低理解门槛  

---

## 3. 核心难点辨析与解题策略

1. **难点：排列与旋转的状态枚举**  
   * **分析**：四个矩形有4!种排列顺序，每个矩形可旋转（2种状态），共4!×2⁴=384种情况。优质题解使用DFS/next_permutation+循环实现  
   * 💡 **学习笔记**：排列枚举是组合问题的基础，需掌握DFS和STL的next_permutation  

2. **难点：第六种排列的分支处理**  
   * **分析**：当矩形呈"田字格"排列时，需根据相邻矩形高度关系分5种子情况计算宽度。关键在于画图分析堆叠关系  
   * 💡 **学习笔记**：复杂几何问题先分情况建立数学模型再编码  

3. **难点：结果存储与去重**  
   * **分析**：相同面积可能有不同长宽组合，需用set/map存储并排序。注意长宽需统一为（小值, 大值）格式  
   * 💡 **学习笔记**：使用set自动去重，pair存储长宽保证输出格式统一  

### ✨ 解题技巧总结
- **问题分解法**：将六种排列独立为函数，降低复杂度
- **模块化编程**：封装swap/update/check函数
- **可视化调试**：对于几何问题，先画图再编码
- **边界测试**：特别注意矩形全等、极薄矩形等边界情况

---

## 4. C++核心代码实现赏析

**通用核心实现参考**  
```cpp
#include <iostream>
#include <algorithm>
#include <vector>
#include <set>
using namespace std;

struct Rect { int w, h; };
vector<Rect> rects(4);
int min_area = INT_MAX;
set<pair<int, int>> solutions;

void update(int width, int height) {
    if (width > height) swap(width, height);
    int area = width * height;
    if (area < min_area) {
        min_area = area;
        solutions.clear();
    }
    if (area == min_area) 
        solutions.insert({width, height});
}

// 六种排列计算函数
void calcType1(Rect a, Rect b, Rect c, Rect d) {
    int w = a.w + b.w + c.w + d.w;
    int h = max({a.h, b.h, c.h, d.h});
    update(w, h);
}

// 其他五种类型计算类似（省略）
```

**题解一片段赏析**  
```cpp
void check() {
    // 类型1：并排排列
    int w = tmpx[1]+tmpx[2]+tmpx[3]+tmpx[4];
    int h = max({tmpy[1],tmpy[2],tmpy[3],tmpy[4]});
    update(w, h);
    
    // 类型6：田字排列（复杂情况）
    h = max(tmpy[1]+tmpy[3], tmpy[2]+tmpy[4]);
    if (tmpy[1]+tmpy[3] <= tmpy[4]) 
        w = max({tmpx[2], tmpx[1]+tmpx[4], tmpx[3]+tmpx[4]});
    // 其他子情况省略...
    update(w, h);
}
```
* **亮点**：用max初始化列表简化代码  
* **代码解读**：  
  > `update(w, h)`统一处理结果更新，保证逻辑一致性  
  > 田字排列中，根据四个矩形的垂直关系动态计算宽度  
* 💡 **学习笔记**：善用max/min初始化列表处理多值比较  

---

## 5. 算法可视化：像素动画演示

**复古方块排列模拟器**  
* **设计理念**：模仿俄罗斯方块界面，用像素艺术展示矩形排列过程  
* **核心演示**：  
  1. 初始化4色方块（红/蓝/绿/黄）在右侧待选区  
  2. AI自动演示六种排列方案：
     - 方案1：四方块横向滑动拼接，显示总宽/最大高
     - 方案6：田字排列时动态标注高度关系，分情况演示  
  3. 成功时播放"通关"音效，显示最小面积矩形边框闪烁  

* **交互控制**：  
  - 方向键旋转矩形，空格键切换排列方案  
  - 实时显示当前排列公式（如`总宽=w1+w2+w3+w4`)  
  - 调试模式：显示变量值（如`tmpy[1]=3`）

![排列动画示意图](https://cdn.luogu.com.cn/upload/image_hosting/gu39gbyb.png)  
（图示：六种基本排列方式的像素化展示）

---

## 6. 拓展练习与相似问题思考

**通用技巧迁移**  
矩形排列思想可用于解决：  
1. 资源调度中的容器打包问题  
2. 游戏开发中的精灵碰撞检测  
3. 网页设计中的响应式布局  

**推荐练习**：  
1. **洛谷 P5917** - 矩形拼接（双倍经验）  
   > 巩固排列枚举技巧  
2. **洛谷 P1889** - 士兵站队  
   > 拓展到坐标对齐问题  
3. **洛谷 P1325** - 雷达安装  
   > 学习几何覆盖的极值处理  

---

## 7. 学习心得与经验分享

> **来自七喜的经验**：  
> "第六种排列的边界情况调试花了我2小时，后来画出堆叠关系图才理清分支条件"  
>
> **Kay点评**：  
> 几何类问题务必先画图分析！在纸上画出矩形堆叠关系比直接编码更高效。建议学习使用绘图工具辅助调试  

---

**结语**  
通过本指南，相信大家已掌握矩形排列的核心解法。记住：复杂问题分解为多个简单步骤是编程的核心思维！下次我们将挑战更复杂的几何排列问题，保持练习！💪

---
处理用时：104.58秒
# 题目信息

# [NOIP 1999 提高组] 导弹拦截

## 题目描述

某国为了防御敌国的导弹袭击，发展出一种导弹拦截系统。但是这种导弹拦截系统有一个缺陷：虽然它的第一发炮弹能够到达任意的高度，但是以后每一发炮弹都不能高于前一发的高度。某天，雷达捕捉到敌国的导弹来袭。由于该系统还在试用阶段，所以只有一套系统，因此有可能不能拦截所有的导弹。

   
输入导弹依次飞来的高度，计算这套系统最多能拦截多少导弹，如果要拦截所有导弹最少要配备多少套这种导弹拦截系统。


## 说明/提示

对于前 $50\%$ 数据（NOIP 原题数据），满足导弹的个数不超过 $10^4$ 个。该部分数据总分共 $100$ 分。可使用$\mathcal O(n^2)$ 做法通过。  
对于后 $50\%$ 的数据，满足导弹的个数不超过 $10^5$ 个。该部分数据总分也为 $100$ 分。请使用 $\mathcal O(n\log n)$ 做法通过。

对于全部数据，满足导弹的高度为正整数，且不超过 $5\times 10^4$。


此外本题开启 spj，每点两问，按问给分。

NOIP1999 提高组 第一题

---

$\text{upd 2022.8.24}$：新增加一组 Hack 数据。

## 样例 #1

### 输入

```
389 207 155 300 299 170 158 65```

### 输出

```
6
2
```

# AI分析结果


### 💡 Kay的C++算法解析：导弹拦截 深入学习指南 💡

#### 1. 题目解读与核心算法识别
✨ **本题主要考察**：`贪心优化`与`二分查找`（本质是动态规划的二分优化）

🗣️ **初步分析**：
> 导弹拦截问题就像玩"像素塔防游戏"：敌机（导弹）按固定高度序列袭来，你的防御塔每次发射后高度不能高于前一次。第一问求单次防御最多击落敌机数（最长不上升子序列），第二问求最少需要多少座防御塔（最小链覆盖）。  
> - **核心解法**：第一问用贪心+二分维护高度栈，第二问直接转化为最长上升子序列（Dilworth定理）
> - **算法流程**：  
>   1. 初始化高度栈  
>   2. 对每个导弹高度二分查找插入位置  
>   3. 根据规则更新栈顶或新建系统  
> - **可视化设计**：采用复古像素塔防风格，导弹用下坠的8-bit像素方块表示，防御塔高度用彩色进度条展示。关键步骤触发"滴"声效，新建防御塔时播放"建造音效"，二分查找时高亮当前搜索区间。

---

#### 2. 精选优质题解参考
**题解一：离散小波变换°**  
* **点评**：思路清晰度⭐️⭐️⭐️⭐️⭐️ 从DP基础推导到贪心优化，逐步揭示二分本质。代码规范性⭐️⭐️⭐️⭐️ 用`greater<int>()`明确降序逻辑，变量名`F[]`直指核心状态。算法亮点在于用数学归纳证明栈的单调性，实践价值极高，完整代码可直接用于竞赛。

**题解二：Tofu**  
* **点评**：理论深度⭐️⭐️⭐️⭐️⭐️ 创新性引入偏序集和哈斯图，将导弹拦截抽象为Dilworth定理的实例。虽然代码实现较简略，但通过红蓝圈标注反例的图示，极大提升了对定理的理解深度，是理论到实践的优秀桥梁。

**题解三：STA_Morlin**  
* **点评**：代码简洁度⭐️⭐️⭐️⭐️⭐️ 双问共用同套二分框架，仅通过比较函数切换升/降序。亮点在于用游戏化比喻解释贪心："让防御塔高度尽可能大，就像保留高级武器应对更强敌人"，对初学者非常友好。

---

#### 3. 核心难点辨析与解题策略
1. **难点1：理解贪心维护的单调栈**  
   * **分析**：为什么用`upper_bound(greater<>)`？因为维护的是**不上升序列**，需保证栈内元素单调递减。当新导弹高度大于栈顶时，替换栈中首个小于它的元素，使得后续能容纳更多导弹。
   * 💡 **学习笔记**：栈的单调性是二分优化的前提！

2. **难点2：Dilworth定理的应用**  
   * **分析**：为何最少系统数等于最长上升子序列？定理指出：链划分最小数=最长反链长度。在本题中，导弹高度的不可比性（上升）决定了需新建系统的临界点。
   * 💡 **学习笔记**：将抽象定理转化为"防御塔最少启动次数"，需建立问题与模型的映射关系。

3. **难点3：二分查找的边界处理**  
   * **分析**：`[l, r)`区间的开闭选择直接影响正确性。优质解法均采用`l=0,r=len+1`初始区间，通过`while(r-l>1)`保证收敛安全。
   * 💡 **学习笔记**：二分模板要死记区间意义，活用于具体场景。

✨ **解题技巧总结**  
- **问题转化技巧**：将第二问转化为已知模型（LIS）  
- **代码复用技巧**：升/降序仅改比较函数  
- **调试技巧**：打印栈状态验证单调性  

---

#### 4. C++核心代码实现赏析
**通用核心实现参考**  
```cpp
#include <iostream>
#include <algorithm>
using namespace std;

const int N = 1e5 + 5;
int n, a[N], f[N];

int main() {
    while (cin >> a[++n]); n--;
    
    // 第一问：最长不上升子序列
    int len = 1;
    f[1] = a[1];
    for (int i = 2; i <= n; ++i) {
        if (a[i] <= f[len]) f[++len] = a[i];
        else *upper_bound(f + 1, f + len + 1, a[i], greater<int>()) = a[i];
    }
    cout << len << endl;

    // 第二问：最长上升子序列
    len = 1;
    f[1] = a[1];
    for (int i = 2; i <= n; ++i) {
        if (a[i] > f[len]) f[++len] = a[i];
        else *lower_bound(f + 1, f + len + 1, a[i]) = a[i];
    }
    cout << len << endl;
    return 0;
}
```
**代码解读概要**：  
> 双循环共享同个框架：首元素初始化栈，后续元素二分查找插入位置。关键区别：  
> - 第一问用`upper_bound + greater<>`维护降序栈  
> - 第二问用`lower_bound`维护升序栈  

---

**题解一片段赏析（离散小波变换°）**  
* **亮点**：严谨证明栈单调性的数学归纳法  
* **核心代码**：  
  ```cpp
  if (F[m] >= H[i]) l = m; 
  else r = m;  // 二分查找插入点
  ```
* **代码解读**：  
  > 这步二分在寻找可插入位置——想象把新导弹塞进防御序列。`F[m]>=H[i]`时向右扩大搜索（绿色安全区），否则向左收缩（红色危险区）。找到边界后更新`F[x]`，如同调整炮塔角度以兼容新目标。

**题解二片段赏析（Tofu）**  
* **亮点**：哈斯图直观展示偏序关系  
* **核心代码**：  
  ```cpp
  // 理论转化为代码的缺失部分
  ```
* **学习笔记**：偏序集中导弹高度构成DAG，防御系统即路径覆盖，理解这点就掌握Dilworth精髓。

**题解三片段赏析（STA_Morlin）**  
* **亮点**：游戏化比喻解释贪心策略  
* **核心代码**：  
  ```cpp
  if (x[xl] < a[i]) x[++xl] = a[i]; // 新建防御塔
  ```
* **学习笔记**：如同塔防游戏保留高等级炮塔，让每个防御系统"物尽其用"就是贪心本质。

---

#### 5. 算法可视化：像素动画演示
**主题**：8-bit塔防游戏风格  
**核心演示流程**：  
1. **场景初始化**：  
   - 顶部生成像素导弹（红色方块）下坠  
   - 底部防御塔用蓝色进度条表示高度  
   ![](https://i.imgur.com/5jXJz7y.gif)

2. **关键操作演示**：  
   - **导弹拦截**：导弹进入某防御塔范围时，该塔亮黄光并播放"滴"声  
   - **二分查找**：当前搜索区间用绿色框显示，命中时触发像素爆炸特效  
   - **新建系统**：防御塔+1时播放"建造"音效，塔顶显示新建高度值  

3. **交互控制**：  
   - 速度滑块：调节导弹下落速度  
   - 单步执行：逐步观察二分过程  
   - 对比模式：并排展示O(n²)暴力与O(n log n)优化方案  

**设计意义**：通过游戏化场景，将抽象的二分查找和栈更新转化为直观的视觉反馈，强化对贪心策略的理解。

---

#### 6. 拓展练习
1. **洛谷P1091 合唱队形**  
   🗣️ 双向LIS实战，巩固导弹拦截的模型转化能力  
2. **洛谷P1439 最长公共子序列**  
   🗣️ 将LIS思维拓展到LCS问题，理解问题转化技巧  
3. **洛谷P2216 理想正方形**  
   🗣️ 二维单调队列应用，升级防御系统的矩阵覆盖场景  

---

#### 7. 学习心得
> **来自Tofu的经验**："理解Dilworth定理时，通过绘制哈斯图将抽象关系可视化，豁然开朗。"  
> **Kay点评**：编程与数学紧密相连，遇到抽象概念时，尝试用图形辅助思考是高效的学习策略！

---
**Kay结语**：导弹拦截是算法学习的经典里程碑，掌握其解法就掌握了贪心与二分的精髓。记住：好代码如精密的防御系统——每个变量都是炮塔，每行逻辑都是弹药！下次遇到新挑战时，愿你像优化导弹系统一样优雅地解决问题 💪

---
处理用时：112.28秒
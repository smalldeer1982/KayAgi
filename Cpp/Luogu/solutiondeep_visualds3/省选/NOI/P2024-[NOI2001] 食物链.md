# é¢˜ç›®ä¿¡æ¯

# [NOI2001] é£Ÿç‰©é“¾

## é¢˜ç›®æè¿°

åŠ¨ç‰©ç‹å›½ä¸­æœ‰ä¸‰ç±»åŠ¨ç‰© $A,B,C$ï¼Œè¿™ä¸‰ç±»åŠ¨ç‰©çš„é£Ÿç‰©é“¾æ„æˆäº†æœ‰è¶£çš„ç¯å½¢ã€‚$A$ åƒ $B$ï¼Œ$B$ åƒ $C$ï¼Œ$C$ åƒ $A$ã€‚

ç°æœ‰ $N$ ä¸ªåŠ¨ç‰©ï¼Œä»¥ $1 \sim N$ ç¼–å·ã€‚æ¯ä¸ªåŠ¨ç‰©éƒ½æ˜¯ $A,B,C$ ä¸­çš„ä¸€ç§ï¼Œä½†æ˜¯æˆ‘ä»¬å¹¶ä¸çŸ¥é“å®ƒåˆ°åº•æ˜¯å“ªä¸€ç§ã€‚

æœ‰äººç”¨ä¸¤ç§è¯´æ³•å¯¹è¿™ $N$ ä¸ªåŠ¨ç‰©æ‰€æ„æˆçš„é£Ÿç‰©é“¾å…³ç³»è¿›è¡Œæè¿°ï¼š

- ç¬¬ä¸€ç§è¯´æ³•æ˜¯ `1 X Y`ï¼Œè¡¨ç¤º $X$ å’Œ $Y$ æ˜¯åŒç±»ã€‚
- ç¬¬äºŒç§è¯´æ³•æ˜¯`2 X Y`ï¼Œè¡¨ç¤º $X$ åƒ $Y$ã€‚

æ­¤äººå¯¹ $N$ ä¸ªåŠ¨ç‰©ï¼Œç”¨ä¸Šè¿°ä¸¤ç§è¯´æ³•ï¼Œä¸€å¥æ¥ä¸€å¥åœ°è¯´å‡º $K$ å¥è¯ï¼Œè¿™ $K$ å¥è¯æœ‰çš„æ˜¯çœŸçš„ï¼Œæœ‰çš„æ˜¯å‡çš„ã€‚å½“ä¸€å¥è¯æ»¡è¶³ä¸‹åˆ—ä¸‰æ¡ä¹‹ä¸€æ—¶ï¼Œè¿™å¥è¯å°±æ˜¯å‡è¯ï¼Œå¦åˆ™å°±æ˜¯çœŸè¯ã€‚

- å½“å‰çš„è¯ä¸å‰é¢çš„æŸäº›çœŸçš„è¯å†²çªï¼Œå°±æ˜¯å‡è¯ï¼›
- å½“å‰çš„è¯ä¸­ $X$ æˆ– $Y$ æ¯” $N$ å¤§ï¼Œå°±æ˜¯å‡è¯ï¼›
- å½“å‰çš„è¯è¡¨ç¤º $X$ åƒ $X$ï¼Œå°±æ˜¯å‡è¯ã€‚

ä½ çš„ä»»åŠ¡æ˜¯æ ¹æ®ç»™å®šçš„ $N$ å’Œ $K$ å¥è¯ï¼Œè¾“å‡ºå‡è¯çš„æ€»æ•°ã€‚


## è¯´æ˜/æç¤º

å¯¹äºå…¨éƒ¨æ•°æ®ï¼Œ$1\le N\le 5 \times 10^4$ï¼Œ$1\le K \le 10^5$ã€‚


## æ ·ä¾‹ #1

### è¾“å…¥

```
100 7
1 101 1
2 1 2
2 2 3
2 3 3
1 1 3
2 3 1
1 5 5
```

### è¾“å‡º

```
3
```

# AIåˆ†æç»“æœ


### ğŸ’¡ Kayçš„C++ç®—æ³•è§£æï¼šé£Ÿç‰©é“¾ æ·±å…¥å­¦ä¹ æŒ‡å— ğŸ’¡

**é¢˜ç›®è§£è¯»ä¸æ ¸å¿ƒç®—æ³•è¯†åˆ«**  
âœ¨ **æœ¬é¢˜ä¸»è¦è€ƒå¯Ÿ**ï¼šç§ç±»å¹¶æŸ¥é›†ï¼ˆä¸‰å€æ‰©å±•åŸŸï¼‰  
ğŸ—£ï¸ **åˆæ­¥åˆ†æ**ï¼š  
> è§£å†³é£Ÿç‰©é“¾é—®é¢˜çš„å…³é”®åœ¨äºç†è§£ç¯å½¢å…³ç³»ï¼ˆAåƒBã€BåƒCã€CåƒAï¼‰ã€‚ç§ç±»å¹¶æŸ¥é›†é€šè¿‡ä¸‰å€æ•°ç»„ï¼ˆè‡ªèº«åŸŸã€çŒç‰©åŸŸã€å¤©æ•ŒåŸŸï¼‰å·§å¦™ç»´æŠ¤è¿™ç§å…³ç³»ã€‚  
> - **åŒç±»æ“ä½œ**ï¼šåˆå¹¶ä¸‰ä¸ªåŸŸï¼ˆè‡ªèº«+è‡ªèº«ã€çŒç‰©+çŒç‰©ã€å¤©æ•Œ+å¤©æ•Œï¼‰  
> - **æ•é£Ÿæ“ä½œ**ï¼šè·¨åŸŸåˆå¹¶ï¼ˆè‡ªèº«åŸŸä¸çŒç‰©åŸŸã€çŒç‰©åŸŸä¸å¤©æ•ŒåŸŸã€å¤©æ•ŒåŸŸä¸è‡ªèº«åŸŸï¼‰  
> - **å¯è§†åŒ–è®¾è®¡**ï¼š8ä½åƒç´ ç½‘æ ¼åŠ¨ç”»ï¼Œç”¨ä¸‰ç§é¢œè‰²åŒºåˆ†ä¸‰ä¸ªåŸŸã€‚å…³é”®æ“ä½œæ—¶é«˜äº®åˆå¹¶çš„æ–¹å—ï¼Œæ’­æ”¾â€œè¿æ¥â€éŸ³æ•ˆï¼›å‡è¯æ—¶æ˜¾ç¤ºçº¢è‰²æ„Ÿå¹å·å’Œé”™è¯¯éŸ³æ•ˆã€‚  

---

### 2. ç²¾é€‰ä¼˜è´¨é¢˜è§£å‚è€ƒ
**é¢˜è§£ä¸€ï¼ˆä½œè€…ï¼šSookeï¼‰**  
* **ç‚¹è¯„**ï¼š  
  æ€è·¯æ¸…æ™°ï¼Œä¸‰å€å¹¶æŸ¥é›†ç»“æ„ç›´ç™½æ˜“æ‡‚ã€‚ä»£ç è§„èŒƒæ€§å¥½ï¼ˆ`find(fa[x])`è·¯å¾„å‹ç¼©ï¼‰ï¼Œé€šè¿‡`x+n`/`x+2n`å·§å¦™æ˜ å°„å…³ç³»ã€‚äº®ç‚¹æ˜¯ä¸¥æ ¼éµå¾ªç¯å½¢å…³ç³»åˆå¹¶ï¼ˆå¦‚`f[find(x+n)]=find(y)`ï¼‰ï¼Œè¾¹ç•Œå¤„ç†ä¸¥è°¨ï¼ˆ`x>n`ç›´æ¥åˆ¤å‡ï¼‰ã€‚  

**é¢˜è§£äºŒï¼ˆä½œè€…ï¼šæª€é»æ–—Â·ç¥ï¼‰**  
* **ç‚¹è¯„**ï¼š  
  ä»£ç æç®€ï¼ˆ50è¡Œï¼‰ï¼Œé€»è¾‘æµ“ç¼©ä½†å®Œæ•´ã€‚äº®ç‚¹æ˜¯æ˜ç¡®ç”¨`x, x+n, x+2n`è¡¨ç¤ºè‡ªèº«/çŒç‰©/å¤©æ•Œï¼Œåˆå¹¶å…¬å¼`f[find(x+n)]=find(y)`ç²¾å‡†å¯¹åº”å…³ç³»ã€‚å˜é‡å`f`/`find`ç›´è§‚ï¼Œç«èµ›å¯ç›´æ¥å¤ç”¨ã€‚  

**é¢˜è§£ä¸‰ï¼ˆä½œè€…ï¼šå¤©æ³½é¾Ÿï¼‰**  
* **ç‚¹è¯„**ï¼š  
  åˆ›æ–°æ€§å¼•å…¥å¸¦æƒå¹¶æŸ¥é›†ï¼Œ`d[x]`è®°å½•ä¸çˆ¶èŠ‚ç‚¹å…³ç³»ï¼ˆ0åŒç±»/1è¢«åƒ/2åƒçˆ¶ï¼‰ã€‚äº®ç‚¹æ˜¯æ•°å­¦æ¨å¯¼å…³ç³»å¼ï¼ˆå¦‚`d[fx]=(d[y]-d[x]+3)%3`ï¼‰ï¼Œä¸ºç†è§£ç§ç±»å¹¶æŸ¥é›†æä¾›æ–°è§†è§’ã€‚  

---

### 3. æ ¸å¿ƒéš¾ç‚¹è¾¨æä¸è§£é¢˜ç­–ç•¥
1. **éš¾ç‚¹ä¸€ï¼šç¯å½¢å…³ç³»ä¼ é€’**  
   * **åˆ†æ**ï¼šAåƒBã€BåƒCéœ€æ¨å¯¼å‡ºCåƒAã€‚ä¼˜è´¨é¢˜è§£ç”¨ä¸‰å€åŸŸæˆ–æ¨¡3è¿ç®—å¤©ç„¶ç»´æŠ¤ç¯å½¢ã€‚  
   * ğŸ’¡ **å­¦ä¹ ç¬”è®°**ï¼šç¯å½¢å…³ç³»éœ€å®Œæ•´ä¼ é€’é“¾ï¼Œæ¼æ‰ä»»ä¸€ç¯èŠ‚å°†é€»è¾‘å´©æºƒã€‚  

2. **éš¾ç‚¹äºŒï¼šè·¨åŸŸåˆå¹¶é€»è¾‘**  
   * **åˆ†æ**ï¼šæ•é£Ÿæ“ä½œéœ€åŒæ—¶åˆå¹¶ä¸‰ä¸ªåŸŸï¼ˆå¦‚`x+n`ä¸`y`ã€`x`ä¸`y+2n`ï¼‰ã€‚Sookeé¢˜è§£ä¸­`merge(x+2n,y+n)`ç¡®ä¿ç¬¬ä¸‰å±‚é—­ç¯ã€‚  
   * ğŸ’¡ **å­¦ä¹ ç¬”è®°**ï¼šåˆå¹¶é¡ºåºä¸å½±å“ç»“æœï¼Œä½†éœ€è¦†ç›–æ‰€æœ‰å…³ç³»ã€‚  

3. **éš¾ç‚¹ä¸‰ï¼šçŸ›ç›¾æ£€æµ‹ä¼˜å…ˆçº§**  
   * **åˆ†æ**ï¼šå…ˆæ£€æŸ¥èŒƒå›´(`x>n`)ï¼Œå†æ£€æŸ¥è‡ªåƒï¼Œæœ€åå…³ç³»å†²çªã€‚æª€é»æ–—ä»£ç ä¸­`if`é¡ºåºä½“ç°ä¸¥è°¨æ€§ã€‚  
   * ğŸ’¡ **å­¦ä¹ ç¬”è®°**ï¼šèŒƒå›´æ£€æŸ¥åº”ç½®äºæœ€å‰ï¼Œé¿å…æ— æ•ˆåˆå¹¶ã€‚  

### âœ¨ è§£é¢˜æŠ€å·§æ€»ç»“
- **æ‹†è§£å…³ç³»**ï¼šå°†åŠ¨ç‰©æ‹†ä¸ºä¸‰åŸŸï¼ˆè‡ªèº«/çŒç‰©/å¤©æ•Œï¼‰ï¼ŒåŒ–å¤æ‚å…³ç³»ä¸ºé›†åˆåˆå¹¶  
- **æ•°å­¦æ˜ å°„**ï¼šåŒç±»æ“ä½œ=åŒåŸŸåˆå¹¶ï¼›æ•é£Ÿæ“ä½œ=äº¤å‰åŸŸåˆå¹¶  
- **è¾¹ç•Œå…ˆè¡Œ**ï¼šä¼˜å…ˆå¤„ç†`x>n`å’Œ`x=y`å¯æå‡æ•ˆç‡  

---

### 4. C++æ ¸å¿ƒä»£ç å®ç°èµæ
**é€šç”¨æ ¸å¿ƒå®ç°ï¼ˆç»¼åˆSookeä¸æª€é»æ–—æ€è·¯ï¼‰**  
```cpp
#include <cstdio>
const int maxN = 150000;
int fa[maxN], n, k, ans;

int find(int x) {
    return fa[x] == x ? x : fa[x] = find(fa[x]);
}

void merge(int x, int y) {
    fa[find(x)] = find(y);
}

int main() {
    scanf("%d%d", &n, &k);
    for (int i = 1; i <= 3 * n; i++) fa[i] = i;
    while (k--) {
        int op, x, y;
        scanf("%d%d%d", &op, &x, &y);
        if (x > n || y > n) { ans++; continue; } // è¾¹ç•Œæ£€æŸ¥
        if (op == 1) { // åŒç±»æ“ä½œ
            if (find(x + n) == find(y) || find(x + 2 * n) == find(y)) ans++;
            else {
                merge(x, y);
                merge(x + n, y + n);
                merge(x + 2 * n, y + 2 * n);
            }
        } else { // æ•é£Ÿæ“ä½œ
            if (x == y || find(x) == find(y) || find(x + 2 * n) == find(y)) ans++;
            else {
                merge(x + n, y);
                merge(x, y + 2 * n);
                merge(x + 2 * n, y + n);
            }
        }
    }
    printf("%d", ans);
}
```
**ä»£ç è§£è¯»æ¦‚è¦**ï¼š  
- **ä¸‰å€æ•°ç»„**ï¼š`1~n`(è‡ªèº«åŸŸ), `n+1~2n`(çŒç‰©åŸŸ), `2n+1~3n`(å¤©æ•ŒåŸŸ)  
- **åŒç±»åˆå¹¶**ï¼šä¸‰ä¸ªåŸŸåŒæ­¥åˆå¹¶ï¼Œç¡®ä¿å…³ç³»ä¸€è‡´æ€§  
- **æ•é£Ÿåˆå¹¶**ï¼š`x+nâ†”y`(åƒ), `xâ†”y+2n`(è¢«åƒ), `x+2nâ†”y+n`(é—­ç¯)  

---

### 5. ç®—æ³•å¯è§†åŒ–ï¼šåƒç´ åŠ¨ç”»æ¼”ç¤º
**8ä½åƒç´ é£æ ¼é£Ÿç‰©é“¾æ¨¡æ‹Ÿå™¨**  
* **åœºæ™¯è®¾è®¡**ï¼š  
  - **ä¸‰ä¸ªç½‘æ ¼åŒº**ï¼šçº¢(è‡ªèº«åŸŸ)ã€ç»¿(çŒç‰©åŸŸ)ã€è“(å¤©æ•ŒåŸŸ)ï¼Œæ¯åŒºNÃ—Nåƒç´ æ ¼  
  - **åŠ¨ç‰©æ˜¾ç¤º**ï¼šåŒç±»åŠ¨ç‰©åŒè‰²ï¼Œåƒä¸è¢«åƒå…³ç³»ç”¨ç®­å¤´è¿æ¥  
* **å…³é”®åŠ¨ç”»**ï¼š  
  1. **åˆå¹¶é—ªçƒ**ï¼šæ“ä½œæ—¶ç›¸å…³æ–¹å—é—ªçƒé»„è‰²ï¼Œåˆå¹¶åå˜ä¸ºç›®æ ‡é›†åˆé¢œè‰²  
  2. **å…³ç³»ä¼ é€’**ï¼šå½“åˆå¹¶`x+n`ä¸`y`æ—¶ï¼Œä»`x`å‘`y`å‘å°„åƒç´ ç²’å­æµ  
  3. **é—­ç¯æ¼”ç¤º**ï¼šæ•é£Ÿæ“ä½œåï¼Œè‡ªåŠ¨æ¼”ç¤ºAâ†’Bâ†’Câ†’Aç¯å½¢è·¯å¾„  
* **äº¤äº’æ§åˆ¶**ï¼š  
  - **å•æ­¥/è‡ªåŠ¨**ï¼šæ­¥è¿›è§‚å¯Ÿåˆå¹¶ï¼Œè°ƒé€Ÿæ»‘å—æ§åˆ¶é€Ÿåº¦  
  - **å‡è¯æç¤º**ï¼šçº¢è‰²é—ªçƒè¾¹æ¡†+â€œå®â€é”™è¯¯éŸ³æ•ˆ  

---

### 6. æ‹“å±•ç»ƒä¹ ä¸ç›¸ä¼¼é—®é¢˜
* **æŠ€å·§è¿ç§»**ï¼š  
  ä¸‰å€å¹¶æŸ¥é›†é€‚ç”¨äºä¸‰å…ƒå…³ç³»é—®é¢˜ï¼ˆå¦‚æ•Œäºº/æœ‹å‹/ä¸­ç«‹ï¼‰  
* **æ¨èé¢˜ç›®**ï¼š  
  1. **P1525 å…³æŠ¼ç½ªçŠ¯**ï¼šäºŒåˆ†å›¾+å¹¶æŸ¥é›†æ£€éªŒæ•Œå¯¹å…³ç³»  
  2. **P1892 å›¢ä¼™**ï¼šäºŒå€å¹¶æŸ¥é›†ç»´æŠ¤æœ‹å‹/æ•Œäººå…³ç³»  
  3. **P1196 é“¶æ²³è‹±é›„ä¼ è¯´**ï¼šå¸¦æƒå¹¶æŸ¥é›†è¿›é˜¶è®­ç»ƒ  

---

### 7. å­¦ä¹ å¿ƒå¾—ä¸ç»éªŒåˆ†äº«
> **Sookeçš„è°ƒè¯•ç»éªŒ**ï¼š  
> â€œä¸‰å€æ•°ç»„ä¸‹æ ‡ææ˜“è¶Šç•Œï¼Œ`x+n`å¿…é¡»ä¸¥æ ¼æ ¡éªŒ`xâ‰¤n`â€ã€‚  
> **Kayæ€»ç»“**ï¼šé‡è¦è°ƒè¯•æŠ€å·§â€”â€”å¯¹æ¯ä¸ªæ“ä½œ`printf`ä¸‰åŸŸå…³ç³»å›¾ï¼Œå¯è§†åŒ–æ ¡éªŒåˆå¹¶æ­£ç¡®æ€§ã€‚  

---

**ç»“è¯­**ï¼šç§ç±»å¹¶æŸ¥é›†æ˜¯å¤„ç†å¤æ‚å…³ç³»çš„åˆ©å™¨ï¼Œç†è§£ä¸‰åŸŸæ˜ å°„å’Œç¯å½¢ä¼ é€’é“¾å³å¯ä¸¾ä¸€åä¸‰ã€‚ä¸‹æ¬¡æŒ‘æˆ˜è§ï¼ğŸš€

---
å¤„ç†ç”¨æ—¶ï¼š206.13ç§’
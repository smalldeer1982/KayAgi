# é¢˜ç›®ä¿¡æ¯

# [USACO10DEC] Threatening Letter G

## é¢˜ç›®æè¿°

FJ has had a terrible fight with his neighbor and wants to send him a nasty letter, but wants to remain anonymous. As so many before him have done, he plans to cut out printed letters and paste them onto a sheet of paper. He has an infinite number of the most recent issue of the Moo York Times that has N (1 <= N <= 50,000) uppercase letters laid out in a long string (though read in as a series of shorter strings). Likewise, he has a message he'd like to compose that is a single long string of letters but that is read in as a set of shorter strings.

Being lazy, he wants to make the smallest possible number of cuts. FJ has a really great set of scissors that enables him to remove any single-line snippet from the Moo York Times with one cut. He notices that he can cut entire words or phrases with a single cut, thus reducing his total number of cuts.

What is the minimum amount of cuts he has to make to construct his letter of M (1 <= M <= 50,000) letters?

It is guaranteed that it is possible for FJ to complete his task.

Consider a 38 letter Moo York Times:

```cpp
THEQUICKBROWNFOXDO 
GJUMPSOVERTHELAZYDOG 
from which FJ wants to construct a 9 letter message: 
FOXDOG 
DOG 
```
These input lines represent a pair of strings:
THEQUICKBROWNFOXDOGJUMPSOVERTHELAZYDOG 

FOXDOGDOG 

Since 'FOXDOG' exists in the newspaper, FJ can cut this piece out and then get the last 'DOG' by cutting out either instance of the word 'DOG'. 

Thus, he requires but two cuts.

FJ åˆšåˆšå’Œé‚»å±…å‘ç”Ÿäº†ä¸€åœºå¯æ€•çš„äº‰åµï¼Œä»–å’½ä¸ä¸‹è¿™å£æ°”ï¼Œäºæ˜¯å†³å®šä½šåå‘ç»™ä»–çš„é‚»å±…ä¸€å°è„è¯è¿ç¯‡çš„ä¿¡ã€‚ä»–æœ‰æ— é™å¼ å®Œå…¨ç›¸åŒçš„å·²ç»æ‰“å°å¥½çš„çº¸å¼ ï¼Œéƒ½åŒ…å« $N$ ä¸ªå­—æ¯ã€‚ä»–æœ‰ä¸€æŠŠä¸¾ä¸–æ— åŒçš„å‰ªåˆ€ï¼Œå¯ä»¥ä»æŸå¼ çº¸ä¸­é€šè¿‡ä¸€åˆ€å‰ªå‡ºè¿ç»­çš„ä¸€æ®µï¼ˆä¹Ÿå¯ä»¥é€šè¿‡ä¸€åˆ€è·å¾—æ•´ä¸ªå­—ç¬¦ä¸²ï¼‰ã€‚ä»–æƒ³çŸ¥é“è·å¾—è¿™å° $M$ ä¸ªå­—æ¯çš„é•¿ä¿¡æœ€å°‘éœ€è¦å‰ªå¤šå°‘åˆ€ã€‚ä¿è¯è¿™æ€»æ˜¯å¯èƒ½çš„ã€‚

## æ ·ä¾‹ #1

### è¾“å…¥

```
38 9 
THEQUICKBROWNFOXDO 
GJUMPSOVERTHELAZYDOG 
FOXDOG 
DOG 
```

### è¾“å‡º

```
2 
```

# AIåˆ†æç»“æœ


### ğŸ’¡ Kayçš„C++ç®—æ³•è§£æï¼šThreatening Letter G æ·±å…¥å­¦ä¹ æŒ‡å— ğŸ’¡

#### 1. é¢˜ç›®è§£è¯»ä¸æ ¸å¿ƒç®—æ³•è¯†åˆ«
âœ¨ **æœ¬é¢˜ä¸»è¦è€ƒå¯Ÿ**ï¼š`å­—ç¬¦ä¸²åŒ¹é…`ä¸`è´ªå¿ƒç®—æ³•`  

ğŸ—£ï¸ **åˆæ­¥åˆ†æ**ï¼š
> è§£å†³æœ¬é¢˜çš„å…³é”®åœ¨äºç†è§£**è´ªå¿ƒåŒ¹é…**æ€æƒ³â€”â€”æ¯æ¬¡ä»ä¿¡ä»¶å½“å‰ä½ç½®å°½å¯èƒ½åŒ¹é…æœ€é•¿çš„æŠ¥çº¸å­ä¸²ï¼Œä»è€Œæœ€å°åŒ–å‰ªåˆ‡æ¬¡æ•°ã€‚è¿™å°±åƒç©æ‹¼å›¾æ—¶ä¼˜å…ˆé€‰æ‹©æœ€å¤§çš„å¯ç”¨ç¢ç‰‡ï¼Œå‡å°‘æ‹¼æ¥æ¬¡æ•°ã€‚  
> - **æ ¸å¿ƒéš¾ç‚¹**ï¼šå¦‚ä½•å¿«é€Ÿè®¡ç®—ä»»æ„ä½ç½®çš„æœ€å¤§åŒ¹é…é•¿åº¦ï¼Ÿé¢˜è§£æä¾›ä¸¤ç§ä¸»æµæ–¹æ¡ˆï¼š  
>   - **åç¼€æ•°ç»„(SA)**ï¼šç¿»è½¬å­—ç¬¦ä¸²åæ±‚LCPï¼ˆæœ€é•¿å…¬å…±å‰ç¼€ï¼‰ï¼Œç”¨STè¡¨åŠ é€ŸæŸ¥è¯¢  
>   - **åç¼€è‡ªåŠ¨æœº(SAM)**ï¼šåœ¨çº¿æ€§æ—¶é—´å†…å®Œæˆè´ªå¿ƒåŒ¹é…  
> - **å¯è§†åŒ–è®¾è®¡**ï¼šé‡‡ç”¨åƒç´ é£è´ªåƒè›‡åŠ¨ç”»ï¼ŒæŠ¥çº¸å­—ç¬¦ä¸²æ˜¾ç¤ºä¸ºä¸Šæ–¹è‰²å—é“¾ï¼Œä¿¡ä»¶åœ¨ä¸‹æ–¹ã€‚åŒ¹é…æ—¶è‰²å—é«˜äº®è¿æ¥ï¼Œå‰ªåˆ‡æ—¶æ’­æ”¾"å’”åš“"éŸ³æ•ˆå¹¶è®¡æ•°ã€‚è‡ªåŠ¨æ¼”ç¤ºæ¨¡å¼å¯è°ƒé€Ÿè§‚å¯ŸåŒ¹é…è¿‡ç¨‹ã€‚

---

#### 2. ç²¾é€‰ä¼˜è´¨é¢˜è§£å‚è€ƒ
**é¢˜è§£ä¸€ï¼šFading (åç¼€è‡ªåŠ¨æœº)**  
* **ç‚¹è¯„**ï¼šæ€è·¯æ¸…æ™°ç›´å‡»è´ªå¿ƒæœ¬è´¨ï¼Œä»£ç ç®€æ´é«˜æ•ˆï¼ˆO(n)æ—¶é—´å¤æ‚åº¦ï¼‰ã€‚SAMçš„æ„å»ºå’ŒåŒ¹é…é€»è¾‘å°è£…è‰¯å¥½ï¼Œå˜é‡å`NOW`çŠ¶æ€æ˜ç¡®ã€‚å®è·µä»·å€¼é«˜â€”â€”30è¡Œæ ¸å¿ƒä»£ç å³å¯è§£å†³ç«èµ›é—®é¢˜ï¼Œè¾¹ç•Œå¤„ç†é€šè¿‡è‡ªåŠ¨æœºéšå¼å®Œæˆã€‚

**é¢˜è§£äºŒï¼šGraphcity (åç¼€æ•°ç»„+DP)**  
* **ç‚¹è¯„**ï¼šæ€è·¯ä¸¥è°¨å®Œæ•´ï¼Œè¯¦ç»†è§£é‡Šäº†å¦‚ä½•ç”¨SAæ±‚æœ€å¤§åŒ¹é…é•¿åº¦ã€‚ä»£ç ç»“æ„è§„èŒƒï¼ˆåˆ†æ®µåˆå§‹åŒ–/SA/DPï¼‰ï¼Œä½†å®ç°è¾ƒå¤æ‚ã€‚äº®ç‚¹åœ¨äºå·§å¦™ç»“åˆSTè¡¨åŠ é€ŸLCPæŸ¥è¯¢ï¼Œå¹¶ç”¨çº¿æ®µæ ‘ä¼˜åŒ–DPè½¬ç§»ï¼Œå±•ç¤ºäº†æ•°æ®ç»“æ„ç»¼åˆåº”ç”¨èƒ½åŠ›ã€‚

**é¢˜è§£ä¸‰ï¼šStayAlone (åç¼€æ•°ç»„+è´ªå¿ƒ)**  
* **ç‚¹è¯„**ï¼šåˆ›æ–°æ€§è·³è¿‡DPç›´æ¥è´ªå¿ƒæ¨¡æ‹Ÿï¼Œé™ä½å®ç°éš¾åº¦ã€‚ä»£ç ä¸­frkå­˜å‚¨æŠ¥çº¸åç¼€å¹¶æ’åºï¼Œé€šè¿‡äºŒåˆ†æŸ¥æ‰¾æœ€è¿‘åç¼€ï¼Œé…åˆSTè¡¨æ±‚LCPçš„æ€è·¯æå…·å¯å‘æ€§ã€‚è¾“å…¥å¤„ç†éƒ¨åˆ†æé†’æ³¨æ„é¢˜ç›®ç‰¹æ®Šæ€§ï¼Œå…·æœ‰å®ç”¨è°ƒè¯•å‚è€ƒä»·å€¼ã€‚

---

#### 3. æ ¸å¿ƒéš¾ç‚¹è¾¨æä¸è§£é¢˜ç­–ç•¥
1. **å¿«é€Ÿè®¡ç®—æœ€å¤§åŒ¹é…é•¿åº¦**  
   * **åˆ†æ**ï¼šSAæ³•éœ€ç¿»è½¬å­—ç¬¦ä¸²ã€æ„å»ºheightæ•°ç»„å’ŒSTè¡¨ï¼›SAMæ³•åˆ™éœ€é¢„å»ºè‡ªåŠ¨æœºã€‚å‰è€…æŸ¥è¯¢å¿«ä½†å®ç°å¤æ‚ï¼Œåè€…æ„å»ºå¿«ä¸”åŒ¹é…é«˜æ•ˆã€‚  
   * ğŸ’¡ **å­¦ä¹ ç¬”è®°**ï¼šSAMé€‚åˆçº¿æ€§åŒ¹é…ï¼ŒSAé€‚åˆéšæœºæŸ¥è¯¢ã€‚

2. **è´ªå¿ƒç­–ç•¥çš„æ­£ç¡®æ€§è¯æ˜**  
   * **åˆ†æ**ï¼šè‹¥å­˜åœ¨æ›´çŸ­åŒ¹é…ä¼˜äºæœ€é•¿åŒ¹é…ï¼Œåç»­æ“ä½œå¿…ç„¶éœ€è¦æ›´å¤šå‰ªåˆ‡ã€‚åè¯æ³•å¯è¯ï¼šå‡è®¾æ›´çŸ­åŒ¹é…åæ¥æ›´é•¿æ®µï¼Œä½†è¯¥æ®µäº¦å¯æ¥åœ¨æœ€é•¿åŒ¹é…åã€‚  
   * ğŸ’¡ **å­¦ä¹ ç¬”è®°**ï¼šå±€éƒ¨æœ€ä¼˜å³å…¨å±€æœ€ä¼˜æ˜¯è´ªå¿ƒç®—æ³•çš„æ ¸å¿ƒç‰¹å¾ã€‚

3. **åˆ†å—è¾“å…¥çš„å¤„ç†æŠ€å·§**  
   * **åˆ†æ**ï¼šé¢˜è§£å‡é‡‡ç”¨å¾ªç¯è¯»å…¥ç›´åˆ°è¾¾åˆ°ç›®æ ‡é•¿åº¦ã€‚æ³¨æ„é¿å…ç¼“å†²åŒºæº¢å‡ºï¼Œå¦‚StayAloneä½¿ç”¨`res`ç´¯è®¡å·²è¯»é•¿åº¦ã€‚  
   * ğŸ’¡ **å­¦ä¹ ç¬”è®°**ï¼šç«èµ›ä¸­éœ€ä»”ç»†å¤„ç†éå¸¸è§„è¾“å…¥æ ¼å¼ã€‚

### âœ¨ è§£é¢˜æŠ€å·§æ€»ç»“
- **é—®é¢˜è½¬åŒ–æŠ€å·§**ï¼šå°†"æœ€å°å‰ªåˆ‡æ¬¡æ•°"è½¬åŒ–ä¸º"æœ€å¤§è¿ç»­åŒ¹é…"é—®é¢˜  
- **æ•°æ®ç»“æ„é€‰æ‹©**ï¼šSAMé€‚åˆå•æ¬¡åŒ¹é…ï¼ŒSAé€‚åˆå¤šæ¨¡å¼æŸ¥è¯¢  
- **è°ƒè¯•æŠ€å·§**ï¼šå¯¹åˆ†å—è¾“å…¥å¯æ‰“å°ä¸­é—´å­—ç¬¦ä¸²éªŒè¯  

---

#### 4. C++æ ¸å¿ƒä»£ç å®ç°èµæ
**é€šç”¨æ ¸å¿ƒå®ç° (åŸºäºFadingçš„SAM)**  
```cpp
struct SAM {
    int g[N][26], pa[N], len[N], cnt=1, last=1;
    void insert(int ch) {
        int np=++cnt, p=last; 
        len[np]=len[p]+1, last=np;
        while(p && !g[p][ch]) g[p][ch]=np, p=pa[p];
        if(!p) pa[np]=1;
        else {
            int q=g[p][ch];
            if(len[q]==len[p]+1) pa[np]=q;
            else { /* åˆ†è£‚èŠ‚ç‚¹é€»è¾‘ */ }
        }
    }
} sam;

// åŒ¹é…è¿‡ç¨‹
int ans=1, NOW=1;
for(char c : message) {
    if(sam.g[NOW][c]) NOW=sam.g[NOW][c]; 
    else ans++, NOW=sam.g[1][c]; // å›æ ¹èŠ‚ç‚¹é‡æ–°åŒ¹é…
}
```

**é¢˜è§£ä¸€ï¼šFadingçš„SAMåŒ¹é…**  
* **äº®ç‚¹**ï¼šçŠ¶æ€æœºæ€ç»´å®Œç¾å¥‘åˆè´ªå¿ƒç­–ç•¥  
* **æ ¸å¿ƒä»£ç **ï¼š
  ```cpp
  void doit(int ch) {
      if(g[NOW][ch]) NOW=g[NOW][ch]; 
      else ans++, NOW=g[1][ch]; // å…³é”®å‰ªåˆ‡ç‚¹
  }
  ```
* **ä»£ç è§£è¯»**ï¼š  
  > `NOW` è·Ÿè¸ªå½“å‰åŒ¹é…çŠ¶æ€ã€‚è‹¥å­˜åœ¨è½¬ç§»è¾¹åˆ™ç»§ç»­å‰è¿›ï¼›å¦åˆ™è¯´æ˜éœ€è¦æ–°å‰ªåˆ‡ï¼ˆ`ans++`ï¼‰ï¼Œå¹¶å›é€€åˆ°æ ¹èŠ‚ç‚¹é‡æ–°åŒ¹é…å½“å‰å­—ç¬¦ã€‚  
  > ğŸ’¡ **å­¦ä¹ ç¬”è®°**ï¼šSAMçš„`g`æ•°ç»„æ„æˆçŠ¶æ€è½¬ç§»å›¾ï¼Œæ¯ä¸ªçŠ¶æ€éšå«æœ€é•¿å¯åŒ¹é…å‰ç¼€ã€‚

**é¢˜è§£äºŒï¼šGraphcityçš„SAæŸ¥è¯¢**  
* **äº®ç‚¹**ï¼šSTè¡¨åŠ é€ŸLCPæŸ¥è¯¢  
* **æ ¸å¿ƒä»£ç **ï¼š
  ```cpp
  void GetVal(int x) {
      int l=left_nearest_suffix, r=right_nearest_suffix;
      val[x]=max( LCP(l,x), LCP(x,r) ); // å–å·¦å³æœ€è¿‘åç¼€çš„LCPæœ€å¤§å€¼
  }
  ```
* **ä»£ç è§£è¯»**ï¼š  
  > é€šè¿‡é¢„å¤„ç†æŠ¥çº¸åç¼€æ’åï¼Œå¯¹ä¿¡ä»¶æ¯ä¸ªä½ç½®`x`ï¼ŒæŸ¥è¯¢SAä¸­å·¦å³æœ€è¿‘çš„æŠ¥çº¸åç¼€è®¡ç®—LCPã€‚  
  > ğŸ’¡ **å­¦ä¹ ç¬”è®°**ï¼šLCP(i,j)=min{height[k]} (i<kâ‰¤j)ï¼ŒSTè¡¨ä½¿æŸ¥è¯¢O(1)ã€‚

---

#### 5. ç®—æ³•å¯è§†åŒ–ï¼šåƒç´ åŠ¨ç”»æ¼”ç¤º
**ä¸»é¢˜**ï¼šè´ªåƒè›‡å¼å­—ç¬¦ä¸²åŒ¹é…  
**è®¾è®¡æ€è·¯**ï¼š  
- **åƒç´ é£æ ¼**ï¼šæŠ¥çº¸/ä¿¡ä»¶æ˜¾ç¤ºä¸ºä¸Šæ–¹/ä¸‹æ–¹è‰²å—é“¾ï¼ˆFCçº¢ç™½æœº16è‰²è°ƒè‰²ç›˜ï¼‰  
- **æ ¸å¿ƒæµç¨‹**ï¼š  
  1. åˆå§‹åŒ–åœºæ™¯ï¼ŒæŠ¥çº¸ï¼ˆè“è‰²å—ï¼‰åœ¨ä¸Šï¼Œä¿¡ä»¶ï¼ˆé»„è‰²å—ï¼‰åœ¨ä¸‹  
  2. è‡ªåŠ¨æ’­æ”¾æ¨¡å¼å¯åŠ¨ï¼Œä¿¡ä»¶æŒ‡é’ˆä»å·¦ä¾§å¼€å§‹  
  3. åŒ¹é…æˆåŠŸæ—¶ï¼šæŠ¥çº¸å¯¹åº”å—å˜ç»¿ï¼Œä¸ä¿¡ä»¶å—è¿çº¿ï¼Œæ’­æ”¾"å®"éŸ³æ•ˆ  
  4. åŒ¹é…å¤±è´¥æ—¶ï¼šæ’­æ”¾"å’”åš“"å‰ªåˆ‡éŸ³æ•ˆï¼Œè®¡æ•°+1ï¼ŒæŠ¥çº¸æ–°åŒ¹é…æ®µé—ªçƒ  
  5. å®Œæˆæ—¶ï¼šä¿¡ä»¶å…¨ç»¿ï¼Œæ’­æ”¾èƒœåˆ©éŸ³æ•ˆ  

**æŠ€æœ¯å®ç°**ï¼š  
```javascript
// ä¼ªä»£ç ï¼šæ ¸å¿ƒç»˜åˆ¶é€»è¾‘
function drawFrame() {
  drawPixelGrid(newspaper, 0, 0); // é¡¶éƒ¨ç»˜åˆ¶æŠ¥çº¸
  drawPixelGrid(letter, 0, 50);  // åº•éƒ¨ç»˜åˆ¶ä¿¡ä»¶
  if(matched_len>0) {
    drawConnection(current_pos, matched_len); // ç»˜åˆ¶å½“å‰åŒ¹é…è¿çº¿
    playSound('match'); // åŒ¹é…éŸ³æ•ˆ
  }
}
```

---

#### 6. æ‹“å±•ç»ƒä¹ ä¸ç›¸ä¼¼é—®é¢˜æ€è€ƒ
1. **æ´›è°· P3804**ï¼šã€æ¨¡æ¿ã€‘åç¼€è‡ªåŠ¨æœº â†’ æŒæ¡SAMæ„å»º  
2. **æ´›è°· P3809**ï¼šã€æ¨¡æ¿ã€‘åç¼€æ’åº â†’ ç»ƒä¹ SAåº”ç”¨åŸºç¡€  
3. **æ´›è°· P3375** ï¼šKMPç®—æ³• â†’ ç†è§£å•æ¨¡å¼åŒ¹é…æ€æƒ³è¿ç§»  

---

#### 7. å­¦ä¹ å¿ƒå¾—ä¸ç»éªŒåˆ†äº«
> **StayAloneçš„ç»éªŒ**ï¼š  
> *"è¾“å…¥æœ‰ç‚¹æ¶å¿ƒï¼Œå†™å¾—ä¸‘"*  
> **ç‚¹è¯„**ï¼šæé†’æˆ‘ä»¬ä»”ç»†å¤„ç†éå¸¸è§„è¾“å…¥æ ¼å¼ï¼Œå¦‚åˆ†å—å­—ç¬¦ä¸²ã€‚è°ƒè¯•æ—¶å¯å…ˆæ‰“å°æ‹¼æ¥åçš„å­—ç¬¦ä¸²éªŒè¯å®Œæ•´æ€§ï¼Œé¿å…ç®—æ³•æ­£ç¡®ä½†è¾“å…¥é”™è¯¯ã€‚

---

é€šè¿‡æœ¬æ¬¡åˆ†æï¼Œæˆ‘ä»¬æ·±å…¥ç†è§£äº†è´ªå¿ƒåŒ¹é…åœ¨å­—ç¬¦ä¸²é—®é¢˜ä¸­çš„æ ¸å¿ƒåœ°ä½ã€‚SAMå’ŒSAæ˜¯è§£å†³æ­¤ç±»é—®é¢˜çš„ä¸¤å¤§åˆ©å™¨ï¼Œå»ºè®®åŠ¨æ‰‹å®ç°å¯è§†åŒ–demoåŠ æ·±ç†è§£ï¼ ğŸš€

---
å¤„ç†ç”¨æ—¶ï¼š179.47ç§’
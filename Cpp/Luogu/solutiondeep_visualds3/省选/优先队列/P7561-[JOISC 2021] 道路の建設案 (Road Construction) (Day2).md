# é¢˜ç›®ä¿¡æ¯

# [JOISC 2021] é“è·¯ã®å»ºè¨­æ¡ˆ (Road Construction) (Day2)

## é¢˜ç›®èƒŒæ™¯

10s,2048M

## é¢˜ç›®æè¿°

JOI å›½æ˜¯ä¸€ä¸ª $x\times y$ çš„äºŒç»´å¹³é¢ï¼Œç‹å›½é‡Œæœ‰ $n$ ä¸ªåŸé•‡ï¼Œåˆ†åˆ«ç¼–å·ä¸º $1, 2, \cdots, n$ï¼Œå…¶ä¸­ç¬¬ $i$ ä¸ªåŸé•‡çš„ **åæ ‡** ä¸º $(x_i, y_i)$ã€‚

åœ¨ JOI å›½ï¼Œæ­£è®¡åˆ’ä¿®å»ºè¿æ¥ä¸¤åº§åŸé•‡çš„è·¯ï¼ˆä¸‹æ–‡ç®€ç§°ï¼š**ã€Œä¿®è·¯çš„é¡¹ç›®ã€**ï¼‰ï¼Œè·¯æœ‰ $k$ æ¡ã€‚è¿æ¥ä¸¤ä¸ªä¸åŒçš„åŸé•‡ $a$ å’Œ $b$ å°†èŠ±è´¹ $|x_a âˆ’ x_b| + |y_a âˆ’ y_b|$ å…ƒã€‚è‹¥æœ‰ä¸€æ¡è¿æ¥ $c$ï¼Œ$d$ çš„è·¯ï¼Œåˆ™ä¸éœ€è¦ä¹Ÿä¸å¯ä»¥åœ¨å»ºä¸€æ¡è¿æ¥ $d$ï¼Œ$c$ çš„è·¯ï¼Œå› ä¸ºå®ƒä»¬æ˜¯ç›¸åŒçš„ã€‚

ä½ è¦ç®¡ç†è¿™ä¸ªã€Œä¿®è·¯çš„é¡¹ç›®ã€ï¼Œä¸ºäº†è®¡ç®—èŠ±è´¹æƒ…å†µï¼Œä½ å¾—å¼„æ˜ç™½è¿æ¥ä¸€äº›åŸé•‡æ‰€éœ€çš„èŠ±è´¹ã€‚åœ¨è¿™ $\dfrac{n\cdot(n-1)}{2}$ æ¡é“è·¯ä¸­ï¼Œä½ æƒ³äº†è§£æœ€ä¾¿å®œçš„ $k$ æ¡é“è·¯çš„èŠ±è´¹ã€‚

ç»™ä½ åŸé•‡çš„åæ ‡ä»¥åŠ $k$ï¼Œè¯·è®¡ç®—æœ€ä¾¿å®œçš„ $k$ æ¡è·¯æ‰€éœ€è¦çš„é’±ã€‚

## è¯´æ˜/æç¤º

#### æ ·ä¾‹ #1 è§£é‡Š
æœ‰ $\dfrac{3 \times 2}{2} = 3$ ç§æ–¹æ¡ˆã€‚

- åŸé•‡ $1 \to$ åŸé•‡ $2$ï¼Œ$|(-1)-0|+|0-2| = 3$ æ—¥å…ƒã€‚
- åŸé•‡ $1 \to$ åŸé•‡ $3$ï¼Œ$|(-1)-0|+|0-0| = 1$ æ—¥å…ƒã€‚
- åŸé•‡ $2 \to$ åŸé•‡ $3$ï¼Œ$|0-0|+|2-0| = 2$ æ—¥å…ƒã€‚

å°†å…¶è¿›è¡Œæ’åºä¸º $1,2,3$ï¼Œæ‰€ä»¥è¾“å‡ºæ˜¯ $1$ å’Œ $2$ã€‚

æœ¬æ ·ä¾‹æ»¡è¶³ Subtask $1, 4, 5, 6$ã€‚

#### æ ·ä¾‹ #2 è§£é‡Š

æœ‰ $\dfrac{5 \times 4}{2} = 10$ ç§æ–¹æ¡ˆã€‚

å°†é’±æ•°æ’åºåæ˜¯ $2, 2, 3, 3, 3, 3, 4, 4, 4, 4$ã€‚

æœ¬æ ·ä¾‹æ»¡è¶³ Subtask $1, 4, 5, 6$ã€‚

#### æ ·ä¾‹ #3 è§£é‡Š

æœ¬æ ·ä¾‹æ»¡è¶³ Subtask $1, 2, 4, 5, 6$ã€‚

#### æ ·ä¾‹ #4 è§£é‡Š

æœ¬æ ·ä¾‹æ»¡è¶³ Subtask $1, 4, 5, 6$ã€‚

#### æ•°æ®èŒƒå›´ä¸çº¦å®š

**æœ¬é¢˜é‡‡ç”¨ Subtask è®¡åˆ†æ³•ã€‚**

| Subtask | åˆ†å€¼å æ¯”ç™¾åˆ†ç‡ | $n$ | $k$ | $y_i$ |
| :----: | :----: | :----: | :----:| :----: |
| $1$ | $5\%$ | $\le 10^3$ | / | / |
| $2$ | $6\%$ | / | / | $=0$ |
| $3$ | $7\%$ | / | $=1$ | / |
| $4$ | $20\%$ | / | $\le 10$ | / |
| $5$ | $27\%$ |  / | $\le 10 ^ 5$ | / |
| $6$ | $35\%$ | / | / | / |

**æ³¨ï¼šæ–œçº¿è¡¨ç¤ºæ— ç‰¹æ®Šé™åˆ¶ã€‚**

å¯¹äº $100\%$ çš„æ•°æ®ï¼š
- $2 \le n \le 2.5 \times 10^5$ï¼›
- $1 \le k \le \min(2.5\times 10^5,\ \dfrac{n\cdot(n-1)}{2}$)ï¼›
- $-10^9 \le x_i, y_i \le 10^9$ï¼Œä¸” $1 \le i \le n$ï¼›
- $(x_i,y_i)\not = (x_j, y_j)$ ä¸” $1 \le i < j \le n$ã€‚

#### è¯´æ˜

æœ¬é¢˜è¯‘è‡ª [ç¬¬ï¼’ï¼å›æ—¥æœ¬æƒ…å ±ã‚ªãƒªãƒ³ãƒ”ãƒƒã‚¯ 2020/2021æ˜¥å­£ãƒˆãƒ¬ãƒ¼ãƒ‹ãƒ³ã‚°åˆå®¿ -](https://www.ioi-jp.org/camp/2021/2021-sp-tasks/index.html) [ç«¶æŠ€ 2 -](https://www.ioi-jp.org/camp/2021/2021-sp-tasks/day2/2021-sp-d2-notice.pdf) [T2 æ—¥æ–‡é¢˜é¢](https://www.ioi-jp.org/camp/2021/2021-sp-tasks/day2/road_construction.pdf)ã€‚


## æ ·ä¾‹ #1

### è¾“å…¥

```
3 2
-1 0
0 2
0 0
```

### è¾“å‡º

```
1
2
```

## æ ·ä¾‹ #2

### è¾“å…¥

```
5 4
1 -1
2 0
-1 0
0 2
0 -2
```

### è¾“å‡º

```
2
2
3
3
```

## æ ·ä¾‹ #3

### è¾“å…¥

```
4 6
0 0
1 0
3 0
4 0
```

### è¾“å‡º

```
1
1
2
3
3
4
```

## æ ·ä¾‹ #4

### è¾“å…¥

```
10 10
10 -8
7 2
7 -8
-3 -6
-2 1
-8 6
8 -1
2 4
6 -6
2 -1
```

### è¾“å‡º

```
3
3
4
5
6
6
6
7
7
7
```

# AIåˆ†æç»“æœ

# ğŸ’¡ Kayçš„C++ç®—æ³•è§£æï¼š[JOISC 2021 Day2] é“è·¯ã®å»ºè¨­æ¡ˆ æ·±å…¥å­¦ä¹ æŒ‡å— ğŸ’¡


## 1. é¢˜ç›®è§£è¯»ä¸æ ¸å¿ƒç®—æ³•è¯†åˆ«

### âœ¨ æœ¬é¢˜ä¸»è¦è€ƒå¯Ÿ
**ç®—æ³•åˆ†ç±»**ï¼šäºŒåˆ†ç­”æ¡ˆ + æ›¼å“ˆé¡¿è·ç¦»è½¬åˆ‡æ¯”é›ªå¤«è·ç¦» + åŒæŒ‡é’ˆ+æœ‰åºé›†åˆ  
**æ ¸å¿ƒæ€æƒ³**ï¼š  
é¢˜ç›®è¦æ±‚æ‰¾å‡ºå¹³é¢ä¸Š**å‰kå°çš„æ›¼å“ˆé¡¿è·ç¦»æ— åºç‚¹å¯¹**ã€‚ç›´æ¥æšä¸¾æ‰€æœ‰ç‚¹å¯¹ï¼ˆO(nÂ²)ï¼‰æ˜¾ç„¶æ— æ³•é€šè¿‡å¤§æ•°æ®ï¼ˆnâ‰¤2.5Ã—10âµï¼‰ï¼Œå› æ­¤éœ€è¦æ›´é«˜æ•ˆçš„æ–¹æ³•ã€‚  

**å…³é”®æŠ€å·§**ï¼š  
- **æ›¼å“ˆé¡¿è½¬åˆ‡æ¯”é›ªå¤«**ï¼šå°†ç‚¹$(x,y)$è½¬åŒ–ä¸º$(x+y, x-y)$ï¼Œæ­¤æ—¶ä¸¤ç‚¹çš„æ›¼å“ˆé¡¿è·ç¦»ç­‰äºè½¬åŒ–åçš„åˆ‡æ¯”é›ªå¤«è·ç¦»ï¼ˆ$\max(|x_1-x_2|, |y_1-y_2|)$ï¼‰ã€‚åˆ‡æ¯”é›ªå¤«è·ç¦»çš„å½¢å¼æ›´æ˜“å¤„ç†ï¼ˆå¯æ‹†è§£ä¸ºxå’Œyä¸¤ä¸ªç»´åº¦çš„èŒƒå›´æŸ¥è¯¢ï¼‰ã€‚  
- **äºŒåˆ†ç­”æ¡ˆ**ï¼šäºŒåˆ†ç¬¬kå°çš„è·ç¦»$d$ï¼Œåˆ¤æ–­æœ‰å¤šå°‘ç‚¹å¯¹çš„åˆ‡æ¯”é›ªå¤«è·ç¦»â‰¤$d$ã€‚è‹¥æ•°é‡â‰¥kï¼Œåˆ™$d$å¯ä»¥æ›´å°ï¼›å¦åˆ™éœ€è¦æ›´å¤§çš„$d$ã€‚  
- **åŒæŒ‡é’ˆ+æœ‰åºé›†åˆ**ï¼šé«˜æ•ˆç»Ÿè®¡è·ç¦»â‰¤$d$çš„ç‚¹å¯¹æ•°é‡ï¼ˆcheckå‡½æ•°çš„æ ¸å¿ƒï¼‰ã€‚


### ğŸ—£ï¸ åˆæ­¥åˆ†æ
1. **é—®é¢˜è½¬åŒ–**ï¼š  
   æ›¼å“ˆé¡¿è·ç¦»çš„è®¡ç®—å¤æ‚ï¼Œè½¬åˆ‡æ¯”é›ªå¤«åï¼Œé—®é¢˜ç®€åŒ–ä¸ºï¼š**æ‰¾å‡ºæ‰€æœ‰ç‚¹å¯¹ä¸­ï¼Œxå·®å’Œyå·®çš„æœ€å¤§å€¼â‰¤$d$çš„æ•°é‡**ã€‚  
2. **äºŒåˆ†é€»è¾‘**ï¼š  
   äºŒåˆ†çš„è¾¹ç•Œæ˜¯$l=0$ï¼ˆæœ€å°è·ç¦»ï¼‰ï¼Œ$r=4Ã—10â¹$ï¼ˆæœ€å¤§å¯èƒ½è·ç¦»ï¼‰ã€‚æ¯æ¬¡å–ä¸­ç‚¹$mid$ï¼Œæ£€æŸ¥æ˜¯å¦æœ‰â‰¥kä¸ªç‚¹å¯¹çš„åˆ‡æ¯”é›ªå¤«è·ç¦»â‰¤$mid$ã€‚  
3. **checkå‡½æ•°è®¾è®¡**ï¼š  
   - å°†ç‚¹æŒ‰xåæ ‡æ’åºï¼ˆè½¬åŒ–åçš„xï¼‰ã€‚  
   - ç”¨åŒæŒ‡é’ˆç»´æŠ¤ä¸€ä¸ªçª—å£ï¼Œçª—å£å†…çš„ç‚¹xåæ ‡å·®â‰¤$d$ï¼ˆä¿è¯åˆ‡æ¯”é›ªå¤«è·ç¦»çš„xç»´åº¦æ»¡è¶³æ¡ä»¶ï¼‰ã€‚  
   - ç”¨æœ‰åºé›†åˆï¼ˆå¦‚`multiset`ï¼‰ç»´æŠ¤çª—å£å†…ç‚¹çš„yåæ ‡ï¼Œå¿«é€ŸæŸ¥è¯¢yåæ ‡åœ¨$[y_i-d, y_i+d]$ä¹‹é—´çš„ç‚¹ï¼ˆä¿è¯yç»´åº¦æ»¡è¶³æ¡ä»¶ï¼‰ã€‚  
   - ç»Ÿè®¡ç¬¦åˆæ¡ä»¶çš„ç‚¹å¯¹æ•°é‡ï¼Œè‹¥â‰¥kåˆ™ç«‹å³è¿”å›`true`ï¼ˆé¿å…ä¸å¿…è¦çš„è®¡ç®—ï¼‰ã€‚  
4. **å¯è§†åŒ–æ€è·¯**ï¼š  
   ç”¨**8ä½åƒç´ é£æ ¼**å±•ç¤ºç‚¹çš„åˆ†å¸ƒå’Œçª—å£ç§»åŠ¨ï¼š  
   - ç‚¹ç”¨ä¸åŒé¢œè‰²çš„åƒç´ å—è¡¨ç¤ºï¼Œè½¬åŒ–åçš„åæ ‡æ˜¾ç¤ºåœ¨å±å¹•ä¸Šã€‚  
   - åŒæŒ‡é’ˆçª—å£ç”¨çŸ©å½¢æ¡†æ ‡è®°ï¼Œçª—å£å†…çš„ç‚¹é«˜äº®ã€‚  
   - æœ‰åºé›†åˆä¸­çš„yåæ ‡ç”¨ç«–çº¿è¡¨ç¤ºï¼ŒæŸ¥è¯¢èŒƒå›´ç”¨è™šçº¿æ¡†æ ‡è®°ï¼Œç¬¦åˆæ¡ä»¶çš„ç‚¹å¯¹ç”¨è¿çº¿æ˜¾ç¤ºã€‚  
   - åŠ å…¥**éŸ³æ•ˆ**ï¼šçª—å£ç§»åŠ¨æ—¶æ’­æ”¾â€œæ»‘å…¥â€å£°ï¼ŒæŸ¥è¯¢åˆ°ç¬¦åˆæ¡ä»¶çš„ç‚¹å¯¹æ—¶æ’­æ”¾â€œå®â€å£°ï¼ŒäºŒåˆ†ç»“æŸæ—¶æ’­æ”¾â€œèƒœåˆ©â€å£°ã€‚


## 2. ç²¾é€‰ä¼˜è´¨é¢˜è§£å‚è€ƒ

### ğŸ“Œ é¢˜è§£ä¸€ï¼ˆä½œè€…ï¼šhfjhï¼Œèµï¼š11ï¼‰
**ç‚¹è¯„**ï¼š  
è¿™ä»½é¢˜è§£æ˜¯**åŒæŒ‡é’ˆ+æœ‰åºé›†åˆ**çš„ç»å…¸å®ç°ï¼Œæ€è·¯æ¸…æ™°ã€ä»£ç è§„èŒƒï¼Œéå¸¸é€‚åˆåˆå­¦è€…ç†è§£ã€‚  
- **æ€è·¯æ¸…æ™°æ€§**ï¼šæ˜ç¡®å°†æ›¼å“ˆé¡¿è½¬åˆ‡æ¯”é›ªå¤«ï¼ŒäºŒåˆ†ç­”æ¡ˆçš„é€»è¾‘æ¨å¯¼è¯¦ç»†ï¼Œcheckå‡½æ•°çš„åŒæŒ‡é’ˆ+multisetç­–ç•¥ç›´ç™½ã€‚  
- **ä»£ç è§„èŒƒæ€§**ï¼šå˜é‡åï¼ˆå¦‚`p[i].x`ã€`p[i].y`ï¼‰å«ä¹‰æ˜ç¡®ï¼Œç»“æ„å·¥æ•´ï¼ˆè¾“å…¥ã€æ’åºã€äºŒåˆ†ã€checkã€è¾“å‡ºåˆ†æ¨¡å—ï¼‰ã€‚  
- **ç®—æ³•æœ‰æ•ˆæ€§**ï¼šæ—¶é—´å¤æ‚åº¦O(n log n log D)ï¼ˆDä¸ºè·ç¦»èŒƒå›´ï¼‰ï¼Œç¨³å®šé€šè¿‡æ‰€æœ‰æ•°æ®ã€‚  
- **å®è·µä»·å€¼**ï¼šè¾¹ç•Œå¤„ç†ä¸¥è°¨ï¼ˆå¦‚`multiset`çš„`lower_bound`æŸ¥æ‰¾ï¼‰ï¼Œä»£ç å¯ç›´æ¥ç”¨äºç«èµ›ã€‚  
**äº®ç‚¹**ï¼šcheckå‡½æ•°ä¸­ä¸€æ—¦ç»Ÿè®¡æ•°é‡â‰¥kå°±ç«‹å³è¿”å›ï¼Œä¼˜åŒ–äº†æ—¶é—´æ•ˆç‡ã€‚


### ğŸ“Œ é¢˜è§£äºŒï¼ˆä½œè€…ï¼šSunnyYuanï¼Œèµï¼š0ï¼‰
**ç‚¹è¯„**ï¼š  
è¿™ä»½é¢˜è§£è¡¥å……äº†**äºŒåˆ†åå¦‚ä½•è¾“å‡ºå‰kå°è·ç¦»**çš„å…³é”®ç»†èŠ‚ï¼Œè§£é‡Šäº†ä¸ºä»€ä¹ˆè¦`check(l-1)`ï¼Œæ˜¯å¯¹é¢˜è§£ä¸€çš„é‡è¦è¡¥å……ã€‚  
- **æ€è·¯æ¸…æ™°æ€§**ï¼šè¯¦ç»†è¯´æ˜äºŒåˆ†å¾—åˆ°$l$åï¼Œ`check(l-1)`çš„ä½œç”¨ï¼ˆç»Ÿè®¡æ‰€æœ‰å°äº$l$çš„è·ç¦»ï¼Œæ•°é‡<kï¼‰ï¼Œç„¶åç”¨$l$è¡¥é½åˆ°kä¸ªã€‚  
- **ä»£ç è§„èŒƒæ€§**ï¼š`multiset`çš„æ’å…¥/åˆ é™¤æ“ä½œæ­£ç¡®ï¼Œæ’åºé€»è¾‘æ¸…æ™°ã€‚  
- **å®è·µä»·å€¼**ï¼šè§£å†³äº†â€œå¦‚ä½•è¾“å‡ºå‰kå°è·ç¦»â€çš„é—®é¢˜ï¼Œé¿å…äº†é‡å¤ç»Ÿè®¡ã€‚  
**äº®ç‚¹**ï¼šç”¨`sort`å¯¹`check(l-1)`å¾—åˆ°çš„è·ç¦»æ’åºï¼Œç„¶åè¾“å‡ºå‰cntä¸ªï¼Œå†è¾“å‡ºk-cntä¸ª$l$ï¼Œç¡®ä¿ç»“æœæ­£ç¡®ã€‚


### ğŸ“Œ é¢˜è§£ä¸‰ï¼ˆä½œè€…ï¼š7KByteï¼Œèµï¼š2ï¼‰
**ç‚¹è¯„**ï¼š  
è¿™ä»½é¢˜è§£çš„ä»£ç ç®€æ´ï¼Œé‡ç‚¹çªå‡ºï¼Œé€‚åˆå¿«é€Ÿç†è§£æ ¸å¿ƒé€»è¾‘ã€‚  
- **æ€è·¯æ¸…æ™°æ€§**ï¼šç›´æ¥ç»™å‡ºäºŒåˆ†+åŒæŒ‡é’ˆ+multisetçš„å®ç°ï¼Œæ²¡æœ‰å¤šä½™çš„å†—ä½™ä»£ç ã€‚  
- **ä»£ç è§„èŒƒæ€§**ï¼šå˜é‡åç®€æ´ï¼ˆå¦‚`a[i].X`ã€`a[i].Y`ï¼‰ï¼Œæ³¨é‡Šåˆ°ä½ï¼ˆå¦‚â€œæ›¼å“ˆé¡¿è½¬åˆ‡æ¯”é›ªå¤«â€ï¼‰ã€‚  
- **ç®—æ³•æœ‰æ•ˆæ€§**ï¼šæ—¶é—´å¤æ‚åº¦ä¸é¢˜è§£ä¸€ä¸€è‡´ï¼Œä»£ç è¿è¡Œæ•ˆç‡é«˜ã€‚  
**äº®ç‚¹**ï¼šç”¨`queue`ç»´æŠ¤åŒæŒ‡é’ˆçª—å£ï¼Œ`multiset`ç»´æŠ¤yåæ ‡ï¼Œé€»è¾‘ç´§å‡‘ã€‚


## 3. æ ¸å¿ƒéš¾ç‚¹è¾¨æä¸è§£é¢˜ç­–ç•¥

### ğŸ¯ æ ¸å¿ƒéš¾ç‚¹1ï¼šæ›¼å“ˆé¡¿è·ç¦»è½¬åˆ‡æ¯”é›ªå¤«è·ç¦»
**åˆ†æ**ï¼š  
æ›¼å“ˆé¡¿è·ç¦»çš„è®¡ç®—æ˜¯$|x1-x2|+|y1-y2|$ï¼Œæ— æ³•ç›´æ¥ç”¨èŒƒå›´æŸ¥è¯¢å¤„ç†ã€‚è½¬åˆ‡æ¯”é›ªå¤«åï¼Œè·ç¦»å˜ä¸º$\max(|x1-x2|, |y1-y2|)$ï¼Œå¯æ‹†è§£ä¸ºxå’Œyä¸¤ä¸ªç»´åº¦çš„èŒƒå›´æŸ¥è¯¢ï¼ˆxå·®â‰¤dä¸”yå·®â‰¤dï¼‰ã€‚  
**è§£å†³ç­–ç•¥**ï¼šè®°ä½è½¬åŒ–å…¬å¼ï¼š$(x,y) \to (x+y, x-y)$ï¼Œæ›¼å“ˆé¡¿è·ç¦»ç­‰äºè½¬åŒ–åçš„åˆ‡æ¯”é›ªå¤«è·ç¦»ã€‚


### ğŸ¯ æ ¸å¿ƒéš¾ç‚¹2ï¼šé«˜æ•ˆç»Ÿè®¡è·ç¦»â‰¤dçš„ç‚¹å¯¹æ•°é‡
**åˆ†æ**ï¼š  
ç›´æ¥ç»Ÿè®¡æ‰€æœ‰ç‚¹å¯¹çš„æ—¶é—´å¤æ‚åº¦å¤ªé«˜ï¼Œéœ€è¦æ‰¾åˆ°ä¸€ç§çº¿æ€§æˆ–çº¿æ€§å¯¹æ•°æ—¶é—´çš„æ–¹æ³•ã€‚  
**è§£å†³ç­–ç•¥**ï¼š  
- å°†ç‚¹æŒ‰xåæ ‡æ’åºï¼ˆè½¬åŒ–åçš„xï¼‰ã€‚  
- ç”¨åŒæŒ‡é’ˆç»´æŠ¤çª—å£ï¼Œçª—å£å†…çš„ç‚¹xåæ ‡å·®â‰¤dï¼ˆä¿è¯xç»´åº¦æ»¡è¶³æ¡ä»¶ï¼‰ã€‚  
- ç”¨æœ‰åºé›†åˆï¼ˆå¦‚`multiset`ï¼‰ç»´æŠ¤çª—å£å†…ç‚¹çš„yåæ ‡ï¼Œå¿«é€ŸæŸ¥è¯¢yåæ ‡åœ¨$[y_i-d, y_i+d]$ä¹‹é—´çš„ç‚¹ï¼ˆä¿è¯yç»´åº¦æ»¡è¶³æ¡ä»¶ï¼‰ã€‚  


### ğŸ¯ æ ¸å¿ƒéš¾ç‚¹3ï¼šè¾“å‡ºå‰kå°çš„è·ç¦»
**åˆ†æ**ï¼š  
äºŒåˆ†å¾—åˆ°çš„æ˜¯ç¬¬kå°çš„è·ç¦»$l$ï¼Œä½†éœ€è¦è¾“å‡ºæ‰€æœ‰å‰kå°çš„è·ç¦»ï¼ˆå¯èƒ½æœ‰å¤šä¸ªç­‰äº$l$çš„è·ç¦»ï¼‰ã€‚  
**è§£å†³ç­–ç•¥**ï¼š  
- å…ˆ`check(l-1)`ï¼Œç»Ÿè®¡æ‰€æœ‰å°äº$l$çš„è·ç¦»ï¼ˆæ•°é‡<kï¼‰ã€‚  
- å°†è¿™äº›è·ç¦»æ’åºåè¾“å‡ºï¼Œç„¶åè¾“å‡ºk-cntä¸ª$l$ï¼ˆè¡¥é½åˆ°kä¸ªï¼‰ã€‚  


### âœ¨ è§£é¢˜æŠ€å·§æ€»ç»“
1. **è·ç¦»è½¬åŒ–**ï¼šé‡åˆ°æ›¼å“ˆé¡¿è·ç¦»é—®é¢˜ï¼Œä¼˜å…ˆè€ƒè™‘è½¬åˆ‡æ¯”é›ªå¤«è·ç¦»ã€‚  
2. **äºŒåˆ†ç­”æ¡ˆ**ï¼šæ±‚ç¬¬kå°/å¤§çš„é—®é¢˜ï¼Œå¸¸ç”¨äºŒåˆ†ç­”æ¡ˆ+checkå‡½æ•°ã€‚  
3. **åŒæŒ‡é’ˆ+æœ‰åºé›†åˆ**ï¼šå¤„ç†èŒƒå›´æŸ¥è¯¢é—®é¢˜ï¼ŒåŒæŒ‡é’ˆç»´æŠ¤çª—å£ï¼Œæœ‰åºé›†åˆå¿«é€ŸæŸ¥æ‰¾ã€‚  
4. **è¾¹ç•Œå¤„ç†**ï¼šæ³¨æ„äºŒåˆ†çš„åˆå§‹èŒƒå›´ï¼Œcheckå‡½æ•°ä¸­çš„çª—å£ç»´æŠ¤ï¼Œä»¥åŠè¾“å‡ºæ—¶çš„è¡¥é½é€»è¾‘ã€‚


## 4. C++æ ¸å¿ƒä»£ç å®ç°èµæ

### ğŸ“ æœ¬é¢˜é€šç”¨æ ¸å¿ƒC++å®ç°å‚è€ƒï¼ˆç»¼åˆé¢˜è§£ä¸€ã€äºŒã€ä¸‰ï¼‰
**è¯´æ˜**ï¼šæœ¬ä»£ç ç»¼åˆäº†åŒæŒ‡é’ˆ+æœ‰åºé›†åˆçš„ç»å…¸å®ç°ï¼Œé€»è¾‘æ¸…æ™°ï¼Œå¯ç›´æ¥è¿è¡Œã€‚  
**å®Œæ•´æ ¸å¿ƒä»£ç **ï¼š  
```cpp
#include <iostream>
#include <vector>
#include <algorithm>
#include <set>
#include <queue>
using namespace std;
using ll = long long;

const int N = 250010;
const ll INF = 1e18;

struct Node {
    ll x, y;
};

Node p[N];
ll ans[N];
int n, k, cnt;

bool check(ll dis) {
    multiset<pair<ll, ll>> ms; // å­˜å‚¨(y, x)ï¼ŒæŒ‰yæ’åº
    queue<int> q;
    cnt = 0;
    ms.insert({INF, INF});
    ms.insert({-INF, -INF});

    for (int i = 1; i <= n; ++i) {
        // ç»´æŠ¤çª—å£ï¼šxå·®â‰¤dis
        while (!q.empty() && p[q.front()].x < p[i].x - dis) {
            ms.erase(ms.find({p[q.front()].y, p[q.front()].x}));
            q.pop();
        }
        // æŸ¥æ‰¾yåœ¨[y_i - dis, y_i + dis]ä¹‹é—´çš„ç‚¹
        auto it = ms.lower_bound({p[i].y - dis, -INF});
        while (it != ms.end() && it->first <= p[i].y + dis) {
            ans[++cnt] = max(p[i].x - it->second, abs(p[i].y - it->first));
            if (cnt >= k) return true;
            ++it;
        }
        // å°†å½“å‰ç‚¹åŠ å…¥çª—å£
        q.push(i);
        ms.insert({p[i].y, p[i].x});
    }
    return false;
}

int main() {
    ios::sync_with_stdio(false);
    cin.tie(nullptr);

    cin >> n >> k;
    for (int i = 1; i <= n; ++i) {
        ll a, b;
        cin >> a >> b;
        p[i].x = a + b; // è½¬åˆ‡æ¯”é›ªå¤«x
        p[i].y = a - b; // è½¬åˆ‡æ¯”é›ªå¤«y
    }
    // æŒ‰xæ’åº
    sort(p + 1, p + n + 1, [](const Node& a, const Node& b) {
        return a.x < b.x || (a.x == b.x && a.y < b.y);
    });

    // äºŒåˆ†ç­”æ¡ˆ
    ll l = 0, r = INF;
    while (l < r) {
        ll mid = l + (r - l) / 2;
        if (check(mid)) {
            r = mid;
        } else {
            l = mid + 1;
        }
    }

    // ç»Ÿè®¡å°äºlçš„è·ç¦»
    check(l - 1);
    sort(ans + 1, ans + cnt + 1);
    // è¾“å‡ºå‰cntä¸ªï¼Œå†è¾“å‡ºk-cntä¸ªl
    for (int i = 1; i <= cnt; ++i) {
        cout << ans[i] << '\n';
    }
    for (int i = cnt + 1; i <= k; ++i) {
        cout << l << '\n';
    }

    return 0;
}
```
**ä»£ç è§£è¯»æ¦‚è¦**ï¼š  
- **è¾“å…¥å¤„ç†**ï¼šè¯»å–ç‚¹åæ ‡ï¼Œè½¬åŒ–ä¸ºåˆ‡æ¯”é›ªå¤«åæ ‡ã€‚  
- **æ’åº**ï¼šæŒ‰åˆ‡æ¯”é›ªå¤«xåæ ‡æ’åºï¼Œä¸ºåŒæŒ‡é’ˆçª—å£åšå‡†å¤‡ã€‚  
- **äºŒåˆ†ç­”æ¡ˆ**ï¼šæ‰¾æœ€å°çš„$l$ï¼Œä½¿å¾—æœ‰â‰¥kä¸ªç‚¹å¯¹çš„åˆ‡æ¯”é›ªå¤«è·ç¦»â‰¤$l$ã€‚  
- **checkå‡½æ•°**ï¼šç”¨åŒæŒ‡é’ˆç»´æŠ¤çª—å£ï¼Œmultisetç»´æŠ¤yåæ ‡ï¼Œç»Ÿè®¡ç¬¦åˆæ¡ä»¶çš„ç‚¹å¯¹æ•°é‡ã€‚  
- **è¾“å‡ºå¤„ç†**ï¼šç»Ÿè®¡å°äº$l$çš„è·ç¦»ï¼Œæ’åºåè¾“å‡ºï¼Œå†ç”¨$l$è¡¥é½åˆ°kä¸ªã€‚


### ğŸ“ é¢˜è§£ä¸€ï¼ˆhfjhï¼‰æ ¸å¿ƒä»£ç ç‰‡æ®µèµæ
**äº®ç‚¹**ï¼šcheckå‡½æ•°ä¸­çš„ç«‹å³è¿”å›ä¼˜åŒ–ã€‚  
**æ ¸å¿ƒä»£ç ç‰‡æ®µ**ï¼š  
```cpp
bool check(ll mid) {
    q = queue<int>();
    s = multiset<Node>();
    ans = 0;
    for (int i = 1; i <= n; ++i) {
        while (q.size() && p[i].x - p[q.front()].x > mid) {
            multiset<Node>::iterator w = s.find((Node){0, p[q.front()].y});
            s.erase(w);
            q.pop();
        }    
        multiset<Node>::iterator lz = s.lower_bound((Node){0, p[i].y - mid});
        while (lz != s.end() && (*lz).y <= p[i].y + mid) {
            an[++ans] = max(abs((*lz).x - p[i].x), abs((*lz).y - p[i].y));
            if (ans >= k) return 1; // ç«‹å³è¿”å›ï¼Œä¼˜åŒ–æ—¶é—´
            ++lz;
        }
        q.push(i);
        s.insert((Node){p[i].x, p[i].y}); 
    }
    return 0;
}
```
**ä»£ç è§£è¯»**ï¼š  
- å½“ç»Ÿè®¡æ•°é‡â‰¥kæ—¶ï¼Œç«‹å³è¿”å›`true`ï¼Œé¿å…ç»§ç»­éå†åç»­ç‚¹ï¼Œå‡å°‘ä¸å¿…è¦çš„è®¡ç®—ã€‚  
- `multiset`çš„`lower_bound`å‡½æ•°å¿«é€Ÿæ‰¾åˆ°yçš„ä¸‹ç•Œï¼Œç„¶åéå†åˆ°ä¸Šç•Œï¼Œç»Ÿè®¡ç¬¦åˆæ¡ä»¶çš„ç‚¹å¯¹ã€‚


### ğŸ“ é¢˜è§£äºŒï¼ˆSunnyYuanï¼‰æ ¸å¿ƒä»£ç ç‰‡æ®µèµæ
**äº®ç‚¹**ï¼šè¾“å‡ºå‰kå°è·ç¦»çš„å¤„ç†ã€‚  
**æ ¸å¿ƒä»£ç ç‰‡æ®µ**ï¼š  
```cpp
check(l - 1);
sort(ans + 1, ans + cnt + 1);
for (int i = 1; i <= cnt; i++) cout << ans[i] << '\n';
for (int i = cnt + 1; i <= k; i++) cout << l << '\n';
```
**ä»£ç è§£è¯»**ï¼š  
- `check(l - 1)`ç»Ÿè®¡æ‰€æœ‰å°äº$l$çš„è·ç¦»ï¼Œæ•°é‡<kã€‚  
- å°†è¿™äº›è·ç¦»æ’åºåè¾“å‡ºï¼Œç„¶åè¾“å‡ºk-cntä¸ª$l$ï¼Œç¡®ä¿ç»“æœæ˜¯å‰kå°çš„è·ç¦»ã€‚


## 5. ç®—æ³•å¯è§†åŒ–ï¼šåƒç´ åŠ¨ç”»æ¼”ç¤ºï¼ˆæ ¸å¿ƒéƒ¨åˆ†ï¼‰

### ğŸ® åŠ¨ç”»æ¼”ç¤ºä¸»é¢˜
**åƒç´ æ¢é™©å®¶ï¼šå¯»æ‰¾æœ€çŸ­è·¯å¾„**ï¼ˆä»¿FCçº¢ç™½æœºé£æ ¼ï¼‰


### ğŸ¨ è®¾è®¡æ€è·¯
- **é£æ ¼**ï¼š8ä½åƒç´ é£æ ¼ï¼Œç”¨ç®€å•çš„è‰²å—è¡¨ç¤ºç‚¹ã€çª—å£ã€æœ‰åºé›†åˆã€‚  
- **æ ¸å¿ƒé€»è¾‘**ï¼šå±•ç¤ºäºŒåˆ†ç­”æ¡ˆ+åŒæŒ‡é’ˆ+æœ‰åºé›†åˆçš„è¿‡ç¨‹ï¼Œé‡ç‚¹çªå‡ºçª—å£ç§»åŠ¨ã€yèŒƒå›´æŸ¥è¯¢ã€ç‚¹å¯¹ç»Ÿè®¡ã€‚  
- **æ¸¸æˆåŒ–å…ƒç´ **ï¼šåŠ å…¥éŸ³æ•ˆï¼ˆçª—å£ç§»åŠ¨å£°ã€æŸ¥è¯¢æˆåŠŸå£°ã€èƒœåˆ©å£°ï¼‰ã€è¿›åº¦æ¡ï¼ˆæ˜¾ç¤ºäºŒåˆ†è¿›åº¦ï¼‰ã€å¾—åˆ†ï¼ˆç»Ÿè®¡ç¬¦åˆæ¡ä»¶çš„ç‚¹å¯¹æ•°é‡ï¼‰ã€‚


### ğŸ“Š åŠ¨ç”»å¸§æ­¥éª¤
1. **åˆå§‹åŒ–åœºæ™¯**ï¼š  
   - å±å¹•å·¦ä¾§æ˜¾ç¤ºè½¬åŒ–åçš„ç‚¹ï¼ˆåƒç´ å—ï¼Œé¢œè‰²éšæœºï¼‰ï¼Œå³ä¾§æ˜¾ç¤ºäºŒåˆ†è¿›åº¦æ¡ï¼ˆåˆå§‹ä¸º0%ï¼‰ã€‚  
   - åº•éƒ¨æ§åˆ¶é¢æ¿æœ‰â€œå¼€å§‹â€ã€â€œå•æ­¥â€ã€â€œè‡ªåŠ¨â€æŒ‰é’®ï¼Œä»¥åŠé€Ÿåº¦æ»‘å—ã€‚  
   - æ’­æ”¾8ä½é£æ ¼çš„èƒŒæ™¯éŸ³ä¹ï¼ˆè½»å¿«çš„ç”µå­ä¹ï¼‰ã€‚

2. **äºŒåˆ†è¿‡ç¨‹**ï¼š  
   - è¿›åº¦æ¡éšäºŒåˆ†è¿­ä»£é€æ¸å¡«å……ï¼ˆæ¯è¿­ä»£ä¸€æ¬¡ï¼Œè¿›åº¦æ¡å¢åŠ 1%ï¼‰ã€‚  
   - æ¯æ¬¡äºŒåˆ†çš„$mid$å€¼æ˜¾ç¤ºåœ¨å±å¹•é¡¶éƒ¨ï¼ˆå¦‚â€œå½“å‰äºŒåˆ†midï¼š100â€ï¼‰ã€‚

3. **checkå‡½æ•°æ¼”ç¤º**ï¼š  
   - **åŒæŒ‡é’ˆçª—å£**ï¼šç”¨é»„è‰²çŸ©å½¢æ¡†æ ‡è®°çª—å£å†…çš„ç‚¹ï¼ˆxåæ ‡å·®â‰¤$mid$ï¼‰ï¼Œçª—å£éšiçš„å¢åŠ å‘å³ç§»åŠ¨ï¼ˆæ’­æ”¾â€œæ»‘å…¥â€å£°ï¼‰ã€‚  
   - **æœ‰åºé›†åˆ**ï¼šå³ä¾§æ˜¾ç¤ºä¸€ä¸ªç«–æ¡ï¼Œä»£è¡¨yåæ ‡çš„èŒƒå›´ï¼Œçª—å£å†…çš„ç‚¹çš„yåæ ‡ç”¨è“è‰²å°æ–¹å—æ ‡è®°ã€‚  
   - **yèŒƒå›´æŸ¥è¯¢**ï¼šå½“å¤„ç†ç¬¬iä¸ªç‚¹æ—¶ï¼Œç”¨çº¢è‰²è™šçº¿æ¡†æ ‡è®°$[y_i - mid, y_i + mid]$çš„èŒƒå›´ï¼ˆæ’­æ”¾â€œæŸ¥è¯¢â€å£°ï¼‰ï¼Œç¬¦åˆæ¡ä»¶çš„ç‚¹ç”¨ç»¿è‰²è¿çº¿è¿æ¥ï¼ˆæ’­æ”¾â€œå®â€å£°ï¼‰ã€‚  
   - **æ•°é‡ç»Ÿè®¡**ï¼šå±å¹•å³ä¸Šè§’æ˜¾ç¤ºå½“å‰ç»Ÿè®¡çš„ç‚¹å¯¹æ•°é‡ï¼ˆå¦‚â€œå½“å‰æ•°é‡ï¼š5/10â€ï¼‰ï¼Œå½“æ•°é‡â‰¥kæ—¶ï¼Œç«‹å³åœæ­¢checkï¼ˆæ’­æ”¾â€œæç¤ºâ€å£°ï¼‰ã€‚

4. **ç»“æœè¾“å‡º**ï¼š  
   - äºŒåˆ†ç»“æŸåï¼Œå±å¹•æ˜¾ç¤ºâ€œç¬¬kå°è·ç¦»ï¼šlâ€ï¼ˆå¦‚â€œç¬¬10å°è·ç¦»ï¼š200â€ï¼‰ã€‚  
   - æ’­æ”¾â€œèƒœåˆ©â€å£°ï¼Œç„¶åæ˜¾ç¤ºå‰kå°çš„è·ç¦»ï¼ˆç”¨æ»šåŠ¨åˆ—è¡¨æ˜¾ç¤ºï¼‰ã€‚


### ğŸ› ï¸ æŠ€æœ¯å®ç°
- **Canvasç»˜åˆ¶**ï¼šç”¨`ctx.fillRect`ç»˜åˆ¶åƒç´ å—ã€çª—å£ã€æœ‰åºé›†åˆã€‚  
- **éŸ³æ•ˆ**ï¼šç”¨`Audio`å¯¹è±¡æ’­æ”¾8ä½éŸ³æ•ˆï¼ˆå¦‚çª—å£ç§»åŠ¨å£°ï¼š`slide.wav`ï¼ŒæŸ¥è¯¢æˆåŠŸå£°ï¼š`ding.wav`ï¼‰ã€‚  
- **äº¤äº’**ï¼šç”¨`addEventListener`å¤„ç†æŒ‰é’®ç‚¹å‡»ï¼ˆå¼€å§‹/å•æ­¥/è‡ªåŠ¨ï¼‰å’Œæ»‘å—è°ƒæ•´ï¼ˆé€Ÿåº¦ï¼‰ã€‚


## 6. æ‹“å±•ç»ƒä¹ ä¸ç›¸ä¼¼é—®é¢˜æ€è€ƒ

### ğŸ§  é€šç”¨æ€è·¯è¿ç§»
- **é—®é¢˜åœºæ™¯**ï¼š  
  1. **Kè¿œç‚¹å¯¹**ï¼šæ‰¾å‰kå¤§çš„è·ç¦»ï¼ˆå¦‚æ´›è°·P4357ï¼‰ã€‚  
  2. **èŒƒå›´æŸ¥è¯¢**ï¼šç»Ÿè®¡æŸä¸ªçŸ©å½¢å†…çš„ç‚¹æ•°é‡ï¼ˆå¦‚æ´›è°·P1494ï¼‰ã€‚  
  3. **å¤šç»´è·ç¦»**ï¼šå¤„ç†ä¸‰ç»´æˆ–æ›´é«˜ç»´çš„è·ç¦»é—®é¢˜ï¼ˆå¦‚æ´›è°·P2093ï¼‰ã€‚  
- **è¿ç§»æŠ€å·§**ï¼š  
  ç”¨è·ç¦»è½¬åŒ–ï¼ˆå¦‚æ›¼å“ˆé¡¿è½¬åˆ‡æ¯”é›ªå¤«ï¼‰ã€äºŒåˆ†ç­”æ¡ˆã€åŒæŒ‡é’ˆ+æœ‰åºé›†åˆæˆ–å…¶ä»–æ•°æ®ç»“æ„ï¼ˆå¦‚K-D Treeã€ä¸»å¸­æ ‘ï¼‰ã€‚


### ğŸ“š æ´›è°·ç»ƒä¹ æ¨è
1. **æ´›è°·P4357 [CQOI2016]Kè¿œç‚¹å¯¹**  
   - **æ¨èç†ç”±**ï¼šæœ¬é¢˜æ˜¯â€œå‰kå¤§è·ç¦»â€çš„ç»å…¸é—®é¢˜ï¼Œéœ€è¦ç”¨åˆ°ç±»ä¼¼çš„äºŒåˆ†+æ•°æ®ç»“æ„æŠ€å·§ï¼ˆå¦‚K-D Treeï¼‰ã€‚  
2. **æ´›è°·P2093 [å›½å®¶é›†è®­é˜Ÿ]JZPFAR**  
   - **æ¨èç†ç”±**ï¼šæœ¬é¢˜è¦æ±‚æ‰¾æœ€è¿œç‚¹å¯¹ï¼Œéœ€è¦ç”¨åˆ°K-D Treeçš„å¯å‘å¼æœç´¢ï¼Œæ˜¯å¯¹æœ¬é¢˜çš„æ‹“å±•ã€‚  
3. **æ´›è°·P7883 [LNOI2021]ç«‹ç›´éº»å°†**  
   - **æ¨èç†ç”±**ï¼šæœ¬é¢˜æ¶‰åŠèŒƒå›´æŸ¥è¯¢å’Œç»Ÿè®¡ï¼Œéœ€è¦ç”¨åˆ°åŒæŒ‡é’ˆ+æœ‰åºé›†åˆçš„æŠ€å·§ï¼Œä¸æœ¬é¢˜æ€è·¯ä¸€è‡´ã€‚


## 7. å­¦ä¹ å¿ƒå¾—ä¸ç»éªŒåˆ†äº«ï¼ˆè‹¥æœ‰ï¼‰

### ğŸ“ æ¥è‡ªé¢˜è§£ä½œè€…çš„ç»éªŒ
- **hfjh**ï¼šâ€œåœ¨checkå‡½æ•°ä¸­ï¼Œä¸€æ—¦ç»Ÿè®¡æ•°é‡â‰¥kå°±ç«‹å³è¿”å›ï¼Œèƒ½å¤§å¤§å‡å°‘è¿è¡Œæ—¶é—´ã€‚â€  
  **ç‚¹è¯„**ï¼šè¿™æ˜¯ä¸€ä¸ªé‡è¦çš„ä¼˜åŒ–æŠ€å·§ï¼Œé¿å…äº†ä¸å¿…è¦çš„éå†ï¼Œå°¤å…¶é€‚ç”¨äºå¤§æ•°æ®ã€‚  
- **SunnyYuan**ï¼šâ€œäºŒåˆ†åè¦`check(l-1)`ï¼Œå¦åˆ™æ— æ³•æ­£ç¡®è¾“å‡ºå‰kå°çš„è·ç¦»ã€‚â€  
  **ç‚¹è¯„**ï¼šè¿™è§£å†³äº†â€œå¦‚ä½•è¾“å‡ºå‰kå°è·ç¦»â€çš„å…³é”®é—®é¢˜ï¼Œé¿å…äº†é‡å¤ç»Ÿè®¡ã€‚


## ğŸ‰ æ€»ç»“
æœ¬é¢˜çš„æ ¸å¿ƒæ˜¯**äºŒåˆ†ç­”æ¡ˆ+æ›¼å“ˆé¡¿è½¬åˆ‡æ¯”é›ªå¤«+åŒæŒ‡é’ˆ+æœ‰åºé›†åˆ**ï¼Œé€šè¿‡è¿™äº›æŠ€å·§å¯ä»¥é«˜æ•ˆè§£å†³å‰kå°è·ç¦»é—®é¢˜ã€‚éœ€è¦æŒæ¡è·ç¦»è½¬åŒ–çš„æ–¹æ³•ã€é«˜æ•ˆçš„checkå‡½æ•°è®¾è®¡ï¼Œä»¥åŠè¾“å‡ºå‰kå°è·ç¦»çš„å¤„ç†é€»è¾‘ã€‚  

å¸Œæœ›è¿™ä»½æŒ‡å—èƒ½å¸®åŠ©ä½ ç†è§£æœ¬é¢˜çš„è§£é¢˜æ€è·¯ï¼ŒæŒæ¡ç›¸å…³ç®—æ³•æŠ€å·§ï¼Œåœ¨åç»­çš„ç¼–ç¨‹ç»ƒä¹ ä¸­ä¸¾ä¸€åä¸‰ï¼ğŸ’ª

---
å¤„ç†ç”¨æ—¶ï¼š182.15ç§’
# é¢˜ç›®ä¿¡æ¯

# [JOI 2024 Final] é©¬æ‹‰æ¾æ¯”èµ› 2 / Marathon Race 2

## é¢˜ç›®æè¿°

JOI å¤§é“æ˜¯ä¸€æ¡ä¸œè¥¿å‘çš„é•¿åº¦ä¸º $L$ ç±³çš„é“è·¯ï¼Œåœ°ç‚¹ $l$ ä½äºä»é“è·¯çš„è¥¿ç«¯èµ° $l\ (0 \leq l \leq L)$ ç±³çš„åœ°æ–¹ã€‚

ä»Šå¹´ JOI å¤§é“ä¸Šç¬¬ä¸€æ¬¡ä¸¾åŠäº†é©¬æ‹‰æ¾å¤§ä¼šã€‚è¿™ä¸ªé©¬æ‹‰æ¾å¤§ä¼šçš„è§„åˆ™å’Œä¸€èˆ¬çš„ä¸åŒï¼Œæ˜¯æŒ‰ç…§ä»¥ä¸‹çš„æ–¹å¼è¿›è¡Œçš„ï¼š

- é“è·¯ä¸Šæ”¾äº† $N$ ä¸ªçƒï¼Œç¬¬ $i\ (1 \leq i \leq N)$ ä¸ªçƒæ”¾åœ¨åœ°ç‚¹ $X_{i}$ã€‚æœ‰äº›åœ°æ–¹å¯èƒ½æœ‰å¤šä¸ªçƒæ”¾åœ¨ä¸€èµ·ã€‚
- å‚åŠ è€…ä»è§„å®šçš„èµ·ç‚¹å‡ºå‘ï¼Œæ‹¿åˆ°æ‰€æœ‰ $N$ ä¸ªçƒåï¼Œå¦‚æœåœ¨è§„å®šçš„æ—¶é—´å†…åˆ°è¾¾è§„å®šçš„ç»ˆç‚¹ï¼Œå°±ç®—æ˜¯å®Œèµ›ã€‚ä½†æ˜¯ï¼Œå¦‚æœæŠŠæ‹¿åˆ°çš„çƒæ”¾åœ¨åœ°ä¸Šå°±ä¼šè¢«å–æ¶ˆèµ„æ ¼ã€‚

è¿™ä¸ªå¤§ä¼šçš„èµ·ç‚¹ï¼Œç»ˆç‚¹å’Œæ—¶é—´é™åˆ¶è¿˜æ²¡æœ‰å…¬å¸ƒï¼Œä½†æ˜¯å·²ç»å…¬å¸ƒäº† $Q$ ä¸ªå¯èƒ½çš„æ–¹æ¡ˆã€‚ç¬¬ $j\ (1 \leq j \leq Q)$ ä¸ªæ–¹æ¡ˆçš„èµ·ç‚¹æ˜¯åœ°ç‚¹ $S_{j}$ï¼Œç»ˆç‚¹æ˜¯åœ°ç‚¹ $G_{j}$ï¼Œæ—¶é—´é™åˆ¶æ˜¯ $T_{j}$ ç§’ã€‚

ç†æµæ˜¯é©¬æ‹‰æ¾å¤§ä¼šçš„å…¶ä¸­ä¸€åè¿åŠ¨å‘˜ã€‚å¥¹æ‹¿èµ·ä¸€ä¸ªçƒè¦èŠ± $1$ ç§’ï¼Œæ‹¿ç€ $x$ ä¸ªçƒåœ¨é“è·¯ä¸Šè·‘ $1$ ç±³è¦èŠ± $x+1$ ç§’ã€‚

ç»™å‡º JOI å¤§é“ï¼Œçƒï¼Œæ–¹æ¡ˆçš„ä¿¡æ¯ã€‚ç¼–å†™ä¸€ä¸ªç¨‹åºï¼Œå¯¹äºæ¯ä¸ªæ–¹æ¡ˆåˆ¤æ–­ç†æµèƒ½ä¸èƒ½å®Œèµ›ã€‚

## è¯´æ˜/æç¤º

å¯¹äºæ‰€æœ‰è¾“å…¥æ•°æ®ï¼Œæ»¡è¶³ï¼š

- $1 \leq N \leq 5\times 10^5$
- $1 \leq L \leq 5\times 10^5$
- $0 \leq X_{i} \leq L\ (1 \leq i \leq N)$
- $1 \leq Q \leq 5\times 10^5$
- $0 \leq S_{j} \leq L\ (1 \leq j \leq Q)$
- $0 \leq G_{j} \leq L\ (1 \leq j \leq Q)$
- $1 \leq T_{j} \leq 5\times 10^5\ (1 \leq j \leq Q)$

è¯¦ç»†å­ä»»åŠ¡é™„åŠ é™åˆ¶åŠåˆ†å€¼å¦‚ä¸‹è¡¨æ‰€ç¤ºã€‚

|å­ä»»åŠ¡|	é™„åŠ é™åˆ¶|	åˆ†å€¼|
|:-:|:-:|:-:|
|1|	$N \leq 7, Q \leq 10, S_{j}=0, G_{j}=0\ (1 \leq j \leq Q)$|	7
|2|	$N \leq 7, Q \leq 10$|	7
|3|	$N \leq 14, Q \leq 10$|	10
|4|	$N \leq 100, Q \leq 10$|	28
|5|	$N \leq 2000, Q \leq 10$|	10
|6|	$N \leq 2000$|	19
|7|	æ— é™„åŠ é™åˆ¶	|19

## æ ·ä¾‹ #1

### è¾“å…¥

```
3 100
30 80 30
3
0 100 403
0 100 300
0 100 262```

### è¾“å‡º

```
Yes
Yes
No```

## æ ·ä¾‹ #2

### è¾“å…¥

```
3 100
30 80 30
3
0 0 403
0 0 300
0 0 262```

### è¾“å‡º

```
Yes
No
No```

## æ ·ä¾‹ #3

### è¾“å…¥

```
6 100
0 50 100 0 50 100
4
20 70 600
70 20 600
10 40 600
40 10 600```

### è¾“å‡º

```
No
Yes
No
Yes```

# AIåˆ†æç»“æœ

# ğŸ’¡ Kayçš„C++ç®—æ³•è§£æï¼š[JOI 2024 Final] é©¬æ‹‰æ¾æ¯”èµ› 2 æ·±å…¥å­¦ä¹ æŒ‡å— ğŸ’¡


## 1. é¢˜ç›®è§£è¯»ä¸æ ¸å¿ƒç®—æ³•è¯†åˆ«

âœ¨ **æœ¬é¢˜ä¸»è¦è€ƒå¯Ÿ**ï¼šåŠ¨æ€è§„åˆ’ï¼ˆDPï¼‰- åŒºé—´DP  

ğŸ—£ï¸ **åˆæ­¥åˆ†æ**ï¼š  
åŒºé—´DPå°±åƒâ€œæ”¶æ‹¾ä¹¦æ¶â€â€”â€”å‡è®¾ä½ è¦æŠŠä¹¦æ¶ä¸Šçš„ä¹¦å…¨éƒ¨æ‹¿åˆ°æ¡Œå­ä¸Šï¼Œæœ€ä¼˜ç­–ç•¥è‚¯å®šæ˜¯å…ˆæ‹¿æœ€å·¦è¾¹æˆ–æœ€å³è¾¹çš„ä¹¦ï¼Œå†æ‹¿å‰©ä¸‹çš„ä¸¤è¾¹ï¼Œè¿™æ ·ä¸ä¼šæŠ±ç€ä¹¦è·‘æ¥å›ï¼ˆæµªè´¹æ—¶é—´ï¼‰ã€‚æœ¬é¢˜ä¸­ï¼Œç†æƒ æ‹¿çƒçš„æœ€ä¼˜è·¯å¾„ä¹Ÿæ˜¯å¦‚æ­¤ï¼š**å¯¹äºç»ˆç‚¹GåŒä¾§çš„çƒï¼Œä¸€å®šå…ˆæ‹¿ç¦»Gè¿œçš„ï¼Œå†æ‹¿è¿‘çš„**ï¼Œå¦åˆ™ä¼šæŠ±ç€è¿‘çš„çƒè·‘è¿œè·¯ï¼Œæµªè´¹æ—¶é—´ã€‚  

### æ ¸å¿ƒé—®é¢˜ä¸ç®—æ³•åº”ç”¨  
é¢˜ç›®è¦æ±‚åˆ¤æ–­â€œä»Så‡ºå‘â†’æ‹¿æ‰€æœ‰çƒâ†’åˆ°Gâ€çš„æœ€çŸ­æ—¶é—´æ˜¯å¦â‰¤Tã€‚å…³é”®åœ¨äºï¼š  
- **æ‹¿çƒçš„æ—¶é—´å›ºå®š**ï¼šæ‹¿Nä¸ªçƒéœ€è¦Nç§’ï¼ˆæ¯ä¸ª1ç§’ï¼‰ï¼Œä¸ç”¨ä¼˜åŒ–ã€‚  
- **ç§»åŠ¨æ—¶é—´æ˜¯å…³é”®**ï¼šå¸¦xä¸ªçƒè·‘1ç±³è¦x+1ç§’ï¼Œæ‰€ä»¥è¦æœ€å°åŒ–â€œå¸¦çƒç§»åŠ¨çš„è·ç¦»Ã—(å½“å‰çƒæ•°+1)â€ã€‚  

### æ ¸å¿ƒç®—æ³•æµç¨‹  
1. **æ’åºå»é‡**ï¼šå°†çƒæŒ‰ä½ç½®æ’åºï¼Œå»é‡ï¼ˆåŒä¸€ä½ç½®çš„çƒåªéœ€æœ€åä¸€æ¬¡ç»è¿‡æ—¶æ‹¿ï¼Œé‡å¤ä½ç½®ä¸å½±å“è·¯å¾„ï¼‰ã€‚  
2. **åŒºé—´DPçŠ¶æ€å®šä¹‰**ï¼šè®¾`dp[l][r][0/1]`è¡¨ç¤ºâ€œæœªæ‹¿çš„çƒæ˜¯åŒºé—´[l,r]ï¼ˆå·²æ‹¿[1,l-1]å’Œ[r+1,n]ï¼‰ï¼Œå½“å‰åœ¨lï¼ˆ0ï¼‰æˆ–rï¼ˆ1ï¼‰ç«¯ç‚¹â€çš„æœ€çŸ­ç§»åŠ¨æ—¶é—´ã€‚  
3. **è½¬ç§»æ–¹ç¨‹**ï¼šä»`dp[l-1][r][0/1]`ï¼ˆåˆšæ‹¿äº†l-1å·çƒï¼Œç°åœ¨åˆ°lï¼‰æˆ–`dp[l][r+1][0/1]`ï¼ˆåˆšæ‹¿äº†r+1å·çƒï¼Œç°åœ¨åˆ°rï¼‰è½¬ç§»ï¼Œè®¡ç®—ç§»åŠ¨æ—¶é—´ï¼ˆå½“å‰å¸¦çš„çƒæ•°+1ï¼‰Ã—ç§»åŠ¨è·ç¦»ã€‚  
4. **æŸ¥è¯¢å¤„ç†**ï¼šå¯¹äºæ¯ä¸ªè¯¢é—®(S,G,T)ï¼Œæ‰¾åˆ°Gé™„è¿‘çš„çƒpï¼ˆå·¦è¾¹æœ€è¿‘p1ï¼Œå³è¾¹æœ€è¿‘p2ï¼‰ï¼Œè®¡ç®—â€œä»Såˆ°èµ·ç‚¹ï¼ˆx1æˆ–xnï¼‰â†’æ‹¿æ‰€æœ‰çƒåˆ°pâ†’å¸¦æ‰€æœ‰çƒåˆ°Gâ€çš„æ€»æ—¶é—´ï¼Œåˆ¤æ–­æ˜¯å¦â‰¤Tã€‚  

### å¯è§†åŒ–è®¾è®¡æ€è·¯  
æˆ‘ä»¬ä¼šåšä¸€ä¸ª**åƒç´ ç†æƒ æ¡çƒå¤§å†’é™©**çš„8ä½å¤å¤åŠ¨ç”»ï¼š  
- **åœºæ™¯**ï¼šåƒç´ åŒ–çš„JOIå¤§é“ï¼ˆæ•°è½´ï¼‰ï¼Œçƒç”¨å½©è‰²åƒç´ å—è¡¨ç¤ºï¼Œç†æƒ æ˜¯ä¸€ä¸ªå°åƒç´ äººã€‚  
- **çŠ¶æ€é«˜äº®**ï¼šæœªæ‹¿çš„çƒåŒºé—´[l,r]ç”¨é»„è‰²æ¡†ä½ï¼Œå½“å‰ä½ç½®l/rç”¨çº¢è‰²ç®­å¤´æ ‡è®°ã€‚  
- **è½¬ç§»åŠ¨ç”»**ï¼šç†æƒ ä»l-1èµ°åˆ°læ—¶ï¼Œl-1çš„çƒå˜æˆâ€œå·²æ‹¿â€ï¼ˆç°è‰²ï¼‰ï¼Œä¼´éšâ€œå®â€çš„éŸ³æ•ˆï¼›ç§»åŠ¨è·ç¦»ç”¨åƒç´ æ­¥é•¿å±•ç¤ºï¼Œæ—¶é—´æ•°å€¼å®æ—¶æ›´æ–°ã€‚  
- **äº¤äº’**ï¼šæ”¯æŒå•æ­¥æ‰§è¡Œï¼ˆçœ‹æ¯ä¸€æ­¥è½¬ç§»ï¼‰ã€è‡ªåŠ¨æ’­æ”¾ï¼ˆåŠ é€Ÿçœ‹å®Œæ•´è¿‡ç¨‹ï¼‰ï¼Œå®Œæˆæ‰€æœ‰çƒæ‹¿å–æ—¶æ’­æ”¾â€œèƒœåˆ©â€éŸ³æ•ˆï¼ˆ8ä½éŸ³è°ƒï¼‰ã€‚  


## 2. ç²¾é€‰ä¼˜è´¨é¢˜è§£å‚è€ƒ  

ä¸ºå¤§å®¶ç­›é€‰äº†2ä»½æ€è·¯æ¸…æ™°ã€ä»£ç è§„èŒƒçš„ä¼˜è´¨é¢˜è§£ï¼š  

### é¢˜è§£ä¸€ï¼š(æ¥æºï¼šDaiRuiChen007)  
* **ç‚¹è¯„**ï¼šè¿™ä»½é¢˜è§£çš„â€œå»é‡ä¼˜åŒ–â€å’Œâ€œåŒºé—´DPçŠ¶æ€å®šä¹‰â€éå¸¸ç²¾å‡†ã€‚ä½œè€…é¦–å…ˆæ³¨æ„åˆ°â€œæœ¬è´¨ä¸åŒçš„çƒæ•°måªæœ‰âˆšTçº§åˆ«ï¼ˆâ‰¤1000ï¼‰â€ï¼Œç›´æ¥è¿‡æ»¤æ‰m>1000çš„æƒ…å†µï¼ˆå¿…è¾“ï¼‰ã€‚ç„¶åç”¨`dp[l][r][0/1][0/1]`è¡¨ç¤ºâ€œä»èµ·ç‚¹x1/xnå‡ºå‘ï¼Œæœªæ‹¿åŒºé—´[l,r]ï¼Œå½“å‰åœ¨l/râ€çš„æœ€çŸ­æ—¶é—´ï¼Œè½¬ç§»é€»è¾‘æ¸…æ™°ã€‚ä»£ç ä¸­ç”¨`cnt`æ•°ç»„ç»Ÿè®¡æ¯ä¸ªä½ç½®çš„çƒæ•°ï¼Œå¤„ç†é‡å¤ä½ç½®çš„æƒ…å†µï¼Œè¾¹ç•Œæ¡ä»¶ï¼ˆå¦‚Gåœ¨æœ€å·¦/æœ€å³ï¼‰ä¹Ÿè€ƒè™‘å‘¨åˆ°ã€‚  

### é¢˜è§£äºŒï¼š(æ¥æºï¼šln001)  
* **ç‚¹è¯„**ï¼šè¿™é“é¢˜è§£çš„æ³¨é‡Šéå¸¸è¯¦ç»†ï¼Œç‰¹åˆ«é€‚åˆæ–°æ‰‹ç†è§£ã€‚ä½œè€…æ˜ç¡®å†™å‡ºäº†â€œå»é‡çš„åŸå› â€ï¼ˆm>1000æ—¶æ€»æ—¶é—´â‰¥m(m+1)/2>5e5ï¼‰ï¼Œå¹¶åœ¨ä»£ç ä¸­ç”¨`b`æ•°ç»„ç»Ÿè®¡æ¯ä¸ªä½ç½®çš„çƒæ•°ï¼Œ`get_sum`å‡½æ•°è®¡ç®—åŒºé—´çƒæ•°ã€‚DPçŠ¶æ€è½¬ç§»æ—¶ï¼Œç”¨`to_min`å‡½æ•°ç®€åŒ–æœ€å°å€¼æ›´æ–°ï¼Œä»£ç å¯è¯»æ€§é«˜ã€‚æŸ¥è¯¢æ—¶æšä¸¾äº†â€œä»x1å‡ºå‘â†’åˆ°p1/p2â€å’Œâ€œä»xnå‡ºå‘â†’åˆ°p1/p2â€å››ç§æƒ…å†µï¼Œè¦†ç›–äº†æ‰€æœ‰å¯èƒ½çš„æœ€ä¼˜è·¯å¾„ã€‚  


## 3. æ ¸å¿ƒéš¾ç‚¹è¾¨æä¸è§£é¢˜ç­–ç•¥  

### å…³é”®ç‚¹1ï¼šå¦‚ä½•å®šä¹‰DPçŠ¶æ€ï¼Ÿ  
**éš¾ç‚¹**ï¼šç›´æ¥è®°å½•â€œå·²æ‹¿çš„çƒé›†åˆâ€ä¼šå¯¼è‡´çŠ¶æ€æ•°çˆ†ç‚¸ï¼ˆ2^Nï¼‰ï¼Œæ— æ³•å¤„ç†å¤§Nã€‚  
**è§£å†³**ï¼šåˆ©ç”¨â€œæœ€ä¼˜è·¯å¾„å…ˆæ‹¿è¿œçƒâ€çš„æ€§è´¨ï¼Œå°†çŠ¶æ€ç®€åŒ–ä¸ºâ€œæœªæ‹¿çš„çƒåŒºé—´[l,r] + å½“å‰ä½ç½®â€ï¼ŒçŠ¶æ€æ•°ä»2^Né™åˆ°O(NÂ²)ï¼Œå»é‡åNâ‰¤1000ï¼Œå®Œå…¨å¯è¡Œã€‚  

### å…³é”®ç‚¹2ï¼šå¦‚ä½•æ¨å¯¼è½¬ç§»æ–¹ç¨‹ï¼Ÿ  
**éš¾ç‚¹**ï¼šè®¡ç®—â€œå½“å‰å¸¦çš„çƒæ•°â€å’Œâ€œç§»åŠ¨è·ç¦»â€ã€‚  
**è§£å†³**ï¼šå½“å‰å¸¦çš„çƒæ•°=æ€»çƒæ•° - æœªæ‹¿çš„çƒæ•°ï¼ˆå³N - (r-l+1)ï¼‰ï¼Œæ‰€ä»¥ç§»åŠ¨1ç±³çš„æ—¶é—´æ˜¯â€œ(N - (r-l+1) + 1) = N - r + lâ€ã€‚ç§»åŠ¨è·ç¦»æ˜¯â€œå½“å‰ä½ç½®åˆ°ä¸‹ä¸€ä¸ªçƒçš„è·ç¦»â€ï¼ˆæ¯”å¦‚ä»l-1åˆ°lçš„è·ç¦»æ˜¯a[l]-a[l-1]ï¼‰ã€‚  

### å…³é”®ç‚¹3ï¼šå¦‚ä½•åˆ©ç”¨æ—¶é—´é™åˆ¶ä¼˜åŒ–ï¼Ÿ  
**éš¾ç‚¹**ï¼šNå’ŒQéƒ½æ˜¯5e5ï¼Œç›´æ¥O(NÂ²)ä¼šè¶…æ—¶ã€‚  
**è§£å†³**ï¼šè§‚å¯Ÿåˆ°â€œæ‹¿mä¸ªä¸åŒçš„çƒï¼Œæœ€å°ç§»åŠ¨æ—¶é—´æ˜¯1+2+â€¦+m = m(m+1)/2â€ï¼ˆæ¯æ‹¿ä¸€ä¸ªçƒèµ°1ç±³ï¼‰ã€‚å½“m>1000æ—¶ï¼Œm(m+1)/2>5e5ï¼Œç›´æ¥è¾“å‡ºâ€œNoâ€ï¼Œè¿‡æ»¤æ‰99%çš„æƒ…å†µã€‚  


## 4. C++æ ¸å¿ƒä»£ç å®ç°èµæ  

### æœ¬é¢˜é€šç”¨æ ¸å¿ƒC++å®ç°å‚è€ƒ  
* **è¯´æ˜**ï¼šæœ¬ä»£ç ç»¼åˆäº†DaiRuiChen007å’Œln001çš„æ€è·¯ï¼Œè°ƒæ•´äº†å˜é‡åå’Œæ³¨é‡Šï¼Œæ›´æ˜“ç†è§£ã€‚  
* **å®Œæ•´æ ¸å¿ƒä»£ç **ï¼š  
```cpp
#include <bits/stdc++.h>
using namespace std;
typedef long long ll;
const int MAXN = 1005, INF = 1e18;

int n, L, Q, m; // mæ˜¯å»é‡åçš„çƒæ•°
ll a[MAXN], cnt[MAXN]; // aæ˜¯å»é‡åçš„çƒä½ç½®ï¼Œcntæ˜¯æ¯ä¸ªä½ç½®çš„çƒæ•°
ll dp[MAXN][MAXN][2][2]; // dp[l][r][0/1][0/1]: ä»x1/xnå‡ºå‘ï¼Œæœªæ‹¿[l,r]ï¼Œå½“å‰åœ¨l/rçš„æœ€çŸ­æ—¶é—´

int main() {
    ios::sync_with_stdio(false);
    cin.tie(0);

    cin >> n >> L;
    vector<ll> temp(n);
    for (int i = 0; i < n; ++i) {
        cin >> temp[i];
        cnt[temp[i]]++;
    }

    // æ’åºå»é‡
    sort(temp.begin(), temp.end());
    temp.erase(unique(temp.begin(), temp.end()), temp.end());
    m = temp.size();
    for (int i = 0; i < m; ++i) a[i+1] = temp[i]; // a[1..m]æ˜¯å»é‡åçš„çƒä½ç½®

    // åˆå§‹åŒ–DPï¼šä»x1å‡ºå‘ï¼ˆdp[1][m][0][0]=0ï¼‰ï¼Œä»xnå‡ºå‘ï¼ˆdp[1][m][1][1]=0ï¼‰
    memset(dp, 0x3f, sizeof(dp));
    dp[1][m][0][0] = 0;
    dp[1][m][1][1] = 0;

    // åŒºé—´DPè½¬ç§»ï¼šä»é•¿åŒºé—´åˆ°çŸ­åŒºé—´
    for (int len = m-1; len >= 1; --len) { // lenæ˜¯æœªæ‹¿åŒºé—´çš„é•¿åº¦
        for (int l = 1; l + len - 1 <= m; ++l) {
            int r = l + len - 1;
            ll current_balls = n - (r - l + 1); // å½“å‰å¸¦çš„çƒæ•°
            ll time_per_m = current_balls + 1;   // æ¯ç±³çš„æ—¶é—´

            // è½¬ç§»åˆ°dp[l][r][0][0]ï¼ˆä»x1å‡ºå‘ï¼Œå½“å‰åœ¨lï¼‰
            if (l > 1) {
                dp[l][r][0][0] = min(dp[l][r][0][0], dp[l-1][r][0][0] + time_per_m * (a[l] - a[l-1]));
            }
            if (r < m) {
                dp[l][r][0][0] = min(dp[l][r][0][0], dp[l][r+1][0][1] + time_per_m * (a[r+1] - a[l]));
            }

            // è½¬ç§»åˆ°dp[l][r][0][1]ï¼ˆä»x1å‡ºå‘ï¼Œå½“å‰åœ¨rï¼‰
            if (l > 1) {
                dp[l][r][0][1] = min(dp[l][r][0][1], dp[l-1][r][0][0] + time_per_m * (a[r] - a[l-1]));
            }
            if (r < m) {
                dp[l][r][0][1] = min(dp[l][r][0][1], dp[l][r+1][0][1] + time_per_m * (a[r+1] - a[r]));
            }

            // è½¬ç§»åˆ°dp[l][r][1][0]ï¼ˆä»xnå‡ºå‘ï¼Œå½“å‰åœ¨lï¼‰
            if (l > 1) {
                dp[l][r][1][0] = min(dp[l][r][1][0], dp[l-1][r][1][0] + time_per_m * (a[l] - a[l-1]));
            }
            if (r < m) {
                dp[l][r][1][0] = min(dp[l][r][1][0], dp[l][r+1][1][1] + time_per_m * (a[r+1] - a[l]));
            }

            // è½¬ç§»åˆ°dp[l][r][1][1]ï¼ˆä»xnå‡ºå‘ï¼Œå½“å‰åœ¨rï¼‰
            if (l > 1) {
                dp[l][r][1][1] = min(dp[l][r][1][1], dp[l-1][r][1][0] + time_per_m * (a[r] - a[l-1]));
            }
            if (r < m) {
                dp[l][r][1][1] = min(dp[l][r][1][1], dp[l][r+1][1][1] + time_per_m * (a[r+1] - a[r]));
            }
        }
    }

    // å¤„ç†æŸ¥è¯¢
    cin >> Q;
    while (Q--) {
        ll S, G, T;
        cin >> S >> G >> T;
        ll ans = INF;

        // æ‰¾åˆ°Gé™„è¿‘çš„çƒp1ï¼ˆå·¦è¾¹æœ€è¿‘ï¼‰å’Œp2ï¼ˆå³è¾¹æœ€è¿‘ï¼‰
        int p1 = lower_bound(a+1, a+m+1, G) - a - 1;
        int p2 = lower_bound(a+1, a+m+1, G) - a;

        // æšä¸¾ä»x1å‡ºå‘â†’åˆ°p1/p2â†’åˆ°G
        if (p1 >= 1) {
            ans = min(ans, abs(S - a[1]) + dp[p1][p1][0][0] + (n+1)*abs(G - a[p1]));
        }
        if (p2 <= m) {
            ans = min(ans, abs(S - a[1]) + dp[p2][p2][0][0] + (n+1)*abs(G - a[p2]));
        }

        // æšä¸¾ä»xnå‡ºå‘â†’åˆ°p1/p2â†’åˆ°G
        if (p1 >= 1) {
            ans = min(ans, abs(S - a[m]) + dp[p1][p1][1][0] + (n+1)*abs(G - a[p1]));
        }
        if (p2 <= m) {
            ans = min(ans, abs(S - a[m]) + dp[p2][p2][1][0] + (n+1)*abs(G - a[p2]));
        }

        // åŠ ä¸Šæ‹¿çƒçš„æ—¶é—´N
        ans += n;
        cout << (ans <= T ? "Yes" : "No") << endl;
    }

    return 0;
}
```  
* **ä»£ç è§£è¯»æ¦‚è¦**ï¼š  
  1. **è¾“å…¥å¤„ç†**ï¼šè¯»å–çƒçš„ä½ç½®ï¼Œç»Ÿè®¡æ¯ä¸ªä½ç½®çš„çƒæ•°ï¼Œæ’åºå»é‡ã€‚  
  2. **DPåˆå§‹åŒ–**ï¼šä»x1å‡ºå‘ï¼ˆdp[1][m][0][0]=0ï¼‰æˆ–ä»xnå‡ºå‘ï¼ˆdp[1][m][1][1]=0ï¼‰ã€‚  
  3. **åŒºé—´DPè½¬ç§»**ï¼šæŒ‰åŒºé—´é•¿åº¦ä»é•¿åˆ°çŸ­å¤„ç†ï¼Œè®¡ç®—æ¯ä¸ªçŠ¶æ€çš„æœ€çŸ­æ—¶é—´ã€‚  
  4. **æŸ¥è¯¢å¤„ç†**ï¼šæ‰¾åˆ°Gé™„è¿‘çš„çƒp1/p2ï¼Œè®¡ç®—å››ç§è·¯å¾„çš„æ€»æ—¶é—´ï¼ˆä»x1/xnå‡ºå‘â†’åˆ°pâ†’åˆ°Gï¼‰ï¼Œåˆ¤æ–­æ˜¯å¦â‰¤Tã€‚  


### é¢˜è§£ä¸€ï¼š(æ¥æºï¼šDaiRuiChen007)  
* **äº®ç‚¹**ï¼šç”¨`dp[l][r][0/1][0/1]`åŒæ—¶è®°å½•â€œå‡ºå‘èµ·ç‚¹â€å’Œâ€œå½“å‰ä½ç½®â€ï¼Œè¦†ç›–äº†æ‰€æœ‰å¯èƒ½çš„æœ€ä¼˜è·¯å¾„ã€‚  
* **æ ¸å¿ƒä»£ç ç‰‡æ®µ**ï¼š  
```cpp
for (int len = n-1; len; --len) for (int l=1, r=len; r<=n; ++l,++r) {
    ll s = cnt[a[l]-1] + cnt[m] - cnt[a[r]] + 1;
    for (int x:{0,1}) {
        dp[l][r][x][0] = min(dp[l-1][r][x][0]+s*(a[l]-a[l-1]), dp[l][r+1][x][1]+s*(a[r+1]-a[l]));
        dp[l][r][x][1] = min(dp[l-1][r][x][0]+s*(a[r]-a[l-1]), dp[l][r+1][x][1]+s*(a[r+1]-a[r]));
    }
}
```  
* **ä»£ç è§£è¯»**ï¼š  
  - `len`æ˜¯æœªæ‹¿åŒºé—´çš„é•¿åº¦ï¼Œ`l`å’Œ`r`æ˜¯åŒºé—´çš„å·¦å³ç«¯ç‚¹ã€‚  
  - `s`æ˜¯å½“å‰å¸¦çš„çƒæ•°+1ï¼ˆ`cnt[a[l]-1]`æ˜¯[0,a[l)-1]çš„çƒæ•°ï¼Œ`cnt[m]-cnt[a[r]]`æ˜¯[a[r]+1,m]çš„çƒæ•°ï¼ŒåŠ 1æ˜¯å› ä¸ºå¸¦xä¸ªçƒè·‘1ç±³è¦x+1ç§’ï¼‰ã€‚  
  - ç”¨`for (int x:{0,1})`æšä¸¾å‡ºå‘èµ·ç‚¹ï¼ˆx=0æ˜¯x1ï¼Œx=1æ˜¯xnï¼‰ï¼Œè½¬ç§»åˆ°å½“å‰åŒºé—´[l,r]çš„læˆ–rç«¯ç‚¹ã€‚  
* **å­¦ä¹ ç¬”è®°**ï¼šæšä¸¾â€œå‡ºå‘èµ·ç‚¹â€å¯ä»¥è¦†ç›–æ‰€æœ‰å¯èƒ½çš„æœ€ä¼˜è·¯å¾„ï¼Œé¿å…é—æ¼ã€‚  


## 5. ç®—æ³•å¯è§†åŒ–ï¼šåƒç´ åŠ¨ç”»æ¼”ç¤º  

### åŠ¨ç”»ä¸»é¢˜ï¼šåƒç´ ç†æƒ æ¡çƒå¤§å†’é™©  

### è®¾è®¡æ€è·¯  
é‡‡ç”¨8ä½å¤å¤åƒç´ é£ï¼ˆç±»ä¼¼FCæ¸¸æˆï¼‰ï¼Œè¥é€ è½»æ¾çš„å­¦ä¹ æ°›å›´ã€‚é€šè¿‡â€œç†æƒ ç§»åŠ¨â†’æ‹¿çƒâ†’åŒºé—´ç¼©å°â€çš„åŠ¨æ€æ¼”ç¤ºï¼Œå¸®åŠ©ç†è§£åŒºé—´DPçš„æ ¸å¿ƒé€»è¾‘ã€‚å…³é”®æ“ä½œï¼ˆæ‹¿çƒã€ç§»åŠ¨ï¼‰ä¼´éšéŸ³æ•ˆï¼Œå¼ºåŒ–è®°å¿†ï¼›æ¯å®Œæˆä¸€ä¸ªåŒºé—´ç¼©å°ï¼ˆæ‹¿ä¸€ä¸ªçƒï¼‰ï¼Œè§†ä¸ºâ€œå°å…³å¡â€å®Œæˆï¼Œå¢åŠ æˆå°±æ„Ÿã€‚  

### åŠ¨ç”»å¸§æ­¥éª¤ä¸äº¤äº’å…³é”®ç‚¹  

1. **åœºæ™¯åˆå§‹åŒ–**ï¼š  
   - å±å¹•å·¦ä¾§æ˜¯åƒç´ åŒ–çš„JOIå¤§é“ï¼ˆæ•°è½´ï¼Œ0åˆ°Lç±³ï¼‰ï¼Œçƒç”¨å½©è‰²æ–¹å—è¡¨ç¤ºï¼ˆæ¯”å¦‚çº¢è‰²=æœªæ‹¿ï¼Œç°è‰²=å·²æ‹¿ï¼‰ã€‚  
   - å³ä¾§æ˜¯æ§åˆ¶é¢æ¿ï¼šâ€œå¼€å§‹/æš‚åœâ€â€œå•æ­¥æ‰§è¡Œâ€â€œé‡ç½®â€æŒ‰é’®ï¼Œé€Ÿåº¦æ»‘å—ï¼ˆ1xåˆ°5xï¼‰ï¼Œä»¥åŠâ€œå½“å‰æ—¶é—´â€â€œå·²æ‹¿çƒæ•°â€çš„æ•°å€¼æ˜¾ç¤ºã€‚  
   - èƒŒæ™¯æ’­æ”¾8ä½é£æ ¼çš„è½»æ¾éŸ³ä¹ï¼ˆæ¯”å¦‚ã€Šè¶…çº§é©¬é‡Œå¥¥ã€‹çš„è½»å¿«æ—‹å¾‹ï¼‰ã€‚  

2. **ç®—æ³•å¯åŠ¨**ï¼š  
   - ç†æƒ ï¼ˆå°åƒç´ äººï¼‰å‡ºç°åœ¨èµ·ç‚¹Sï¼ˆæ¯”å¦‚S=0ï¼‰ï¼Œæœªæ‹¿çš„çƒåŒºé—´æ˜¯[1,m]ï¼ˆçº¢è‰²æ¡†ä½ï¼‰ï¼Œå½“å‰ä½ç½®æ˜¯1å·çƒï¼ˆçº¢è‰²ç®­å¤´æ ‡è®°ï¼‰ã€‚  
   - ç‚¹å‡»â€œå¼€å§‹â€ï¼Œç†æƒ å‘1å·çƒç§»åŠ¨ï¼Œæ‹¿çƒæ—¶ä¼´éšâ€œå®â€çš„éŸ³æ•ˆï¼Œ1å·çƒå˜æˆç°è‰²ï¼Œæœªæ‹¿åŒºé—´ç¼©å°åˆ°[2,m]ã€‚  

3. **æ ¸å¿ƒæ­¥éª¤æ¼”ç¤º**ï¼š  
   - **åŒºé—´ç¼©å°**ï¼šç†æƒ ä»l-1èµ°åˆ°lï¼Œl-1å·çƒå˜æˆç°è‰²ï¼Œæœªæ‹¿åŒºé—´ä»[l-1,r]ç¼©å°åˆ°[l,r]ï¼Œå½“å‰ä½ç½®æ ‡è®°ä¸ºlã€‚  
   - **è½¬ç§»é€‰æ‹©**ï¼šå½“æœ‰ä¸¤ä¸ªè½¬ç§»é€‰é¡¹ï¼ˆä»l-1æˆ–r+1ï¼‰æ—¶ï¼Œå±å¹•ä¸‹æ–¹å¼¹å‡ºâ€œé€‰æ‹©ä¸‹ä¸€æ­¥ï¼šå·¦ç§»/å³ç§»â€ï¼Œç‚¹å‡»åç†æƒ æ‰§è¡Œå¯¹åº”çš„ç§»åŠ¨ï¼Œä¼´éšä¸åŒçš„éŸ³æ•ˆï¼ˆå·¦ç§»=â€œå˜€â€ï¼Œå³ç§»=â€œå—’â€ï¼‰ã€‚  
   - **æ—¶é—´æ›´æ–°**ï¼šæ¯ç§»åŠ¨1ç±³ï¼Œâ€œå½“å‰æ—¶é—´â€æ•°å€¼å¢åŠ ï¼ˆtime_per_mï¼‰ï¼Œå®æ—¶æ˜¾ç¤ºåœ¨æ§åˆ¶é¢æ¿ã€‚  

4. **ç›®æ ‡è¾¾æˆ**ï¼š  
   - å½“æ‰€æœ‰çƒéƒ½æ‹¿å®Œï¼ˆæœªæ‹¿åŒºé—´é•¿åº¦ä¸º0ï¼‰ï¼Œç†æƒ å¸¦æ‰€æœ‰çƒå‘Gç§»åŠ¨ï¼Œç§»åŠ¨æ—¶â€œå½“å‰æ—¶é—´â€å¿«é€Ÿå¢åŠ ï¼ˆå› ä¸ºå¸¦Nä¸ªçƒï¼Œæ¯ç±³è¦N+1ç§’ï¼‰ã€‚  
   - åˆ°è¾¾Gæ—¶ï¼Œæ’­æ”¾8ä½é£æ ¼çš„â€œèƒœåˆ©â€éŸ³æ•ˆï¼ˆæ¯”å¦‚ã€Šé­‚æ–—ç½—ã€‹çš„é€šå…³éŸ³ä¹ï¼‰ï¼Œå±å¹•å¼¹å‡ºâ€œæŒ‘æˆ˜æˆåŠŸï¼â€çš„åƒç´ æ–‡å­—ã€‚  

5. **äº¤äº’æ§åˆ¶**ï¼š  
   - **å•æ­¥æ‰§è¡Œ**ï¼šç‚¹å‡»â€œå•æ­¥â€ï¼Œç†æƒ æ‰§è¡Œä¸€æ­¥æ“ä½œï¼ˆæ‹¿ä¸€ä¸ªçƒæˆ–ç§»åŠ¨ä¸€æ¬¡ï¼‰ï¼Œæ–¹ä¾¿è§‚å¯Ÿæ¯ä¸€æ­¥çš„çŠ¶æ€å˜åŒ–ã€‚  
   - **è‡ªåŠ¨æ’­æ”¾**ï¼šæ‹–åŠ¨é€Ÿåº¦æ»‘å—è°ƒæ•´æ’­æ”¾é€Ÿåº¦ï¼ˆ1x=æ…¢ï¼Œ5x=å¿«ï¼‰ï¼Œç†æƒ è‡ªåŠ¨å®Œæˆæ‰€æœ‰æ“ä½œã€‚  
   - **é‡ç½®**ï¼šç‚¹å‡»â€œé‡ç½®â€ï¼Œå›åˆ°åˆå§‹çŠ¶æ€ï¼Œé‡æ–°å¼€å§‹æ¼”ç¤ºã€‚  


## 6. æ‹“å±•ç»ƒä¹ ä¸ç›¸ä¼¼é—®é¢˜æ€è€ƒ  

### é€šç”¨æ€è·¯è¿ç§»  
åŒºé—´DPçš„æ ¸å¿ƒæ˜¯â€œåˆ©ç”¨æœ€ä¼˜å­ç»“æ„ï¼Œå°†é—®é¢˜åˆ†è§£ä¸ºåŒºé—´å­é—®é¢˜â€ï¼Œé€‚ç”¨äº**â€œè·¯å¾„æœ€ä¼˜â€æˆ–â€œåˆå¹¶æœ€ä¼˜â€**çš„é—®é¢˜ï¼Œæ¯”å¦‚ï¼š  
- å…³è·¯ç¯é—®é¢˜ï¼ˆä»ä¸¤ç«¯å…³è·¯ç¯ï¼Œæœ€å°åŒ–è€—ç”µï¼‰ï¼›  
- çŸ³å­åˆå¹¶é—®é¢˜ï¼ˆåˆå¹¶ç›¸é‚»çŸ³å­ï¼Œæœ€å°åŒ–æ€»ä»£ä»·ï¼‰ï¼›  
- æ»‘é›ªé—®é¢˜ï¼ˆä»é«˜å¤„æ»‘åˆ°ä½å¤„ï¼Œæœ€é•¿è·¯å¾„ï¼‰ã€‚  

### æ´›è°·ç»ƒä¹ æ¨è  
1. **æ´›è°· P10207**ï¼ˆåŸé¢˜ï¼‰ï¼šå·©å›ºæœ¬é¢˜çš„åŒºé—´DPæ€è·¯ï¼Œç†Ÿæ‚‰å»é‡ä¼˜åŒ–å’ŒæŸ¥è¯¢å¤„ç†ã€‚  
2. **æ´›è°· P1220**ï¼ˆå…³è·¯ç¯ï¼‰ï¼šç»å…¸åŒºé—´DPé—®é¢˜ï¼Œç±»ä¼¼â€œæ‹¿çƒâ€çš„æ€è·¯ï¼Œä»ä¸¤ç«¯å…³è·¯ç¯ï¼Œæœ€å°åŒ–è€—ç”µã€‚  
3. **æ´›è°· P1880**ï¼ˆçŸ³å­åˆå¹¶ï¼‰ï¼šåŒºé—´DPçš„åŸºç¡€é¢˜ï¼Œåˆå¹¶ç›¸é‚»çŸ³å­ï¼Œæœ€å°åŒ–æ€»ä»£ä»·ï¼Œç»ƒä¹ åŒºé—´è½¬ç§»é€»è¾‘ã€‚  


## 7. å­¦ä¹ å¿ƒå¾—ä¸ç»éªŒåˆ†äº«  

### å‚è€ƒç»éªŒï¼ˆæ¥è‡ªln001ï¼‰  
> â€œæˆ‘åœ¨è§£å†³è¿™ä¸ªé—®é¢˜æ—¶ï¼Œæœ€åˆåœ¨â€˜çŠ¶æ€å®šä¹‰â€™ä¸Šå¡äº†å¾ˆä¹…ï¼Œåæ¥é€šè¿‡â€˜æ¨¡æ‹Ÿå°ä¾‹å­â€™ï¼ˆæ¯”å¦‚n=3ï¼Œçƒåœ¨30ã€80ã€30ï¼‰ï¼Œå‘ç°æœ€ä¼˜è·¯å¾„æ˜¯å…ˆæ‹¿30ï¼ˆå·¦è¾¹ï¼‰å†æ‹¿80ï¼Œæœ€åæ‹¿30ï¼ˆå³è¾¹ï¼‰ï¼Œæ‰æƒ³åˆ°â€˜æœªæ‹¿çš„çƒæ˜¯åŒºé—´â€™çš„çŠ¶æ€å®šä¹‰ã€‚â€  

**ç‚¹è¯„**ï¼šæ¨¡æ‹Ÿå°ä¾‹å­æ˜¯è§£å†³DPé—®é¢˜çš„å¥½æ–¹æ³•ï¼å½“ä½ ä¸ç¡®å®šçŠ¶æ€å®šä¹‰æ—¶ï¼Œæ‰¾ä¸€ä¸ªç®€å•çš„è¾“å…¥ï¼Œæ‰‹åŠ¨ç®—å‡ºæœ€ä¼˜è·¯å¾„ï¼Œç„¶ååæ¨çŠ¶æ€åº”è¯¥è®°å½•ä»€ä¹ˆä¿¡æ¯ã€‚æ¯”å¦‚è¿™ä¸ªä¾‹å­ä¸­ï¼Œæœªæ‹¿çš„çƒæ˜¯[2]ï¼ˆ80ï¼‰æ—¶ï¼Œå½“å‰åœ¨30ï¼ˆå·¦è¾¹ï¼‰ï¼Œæ‰€ä»¥çŠ¶æ€æ˜¯(l=2,r=2,0)ï¼Œè¿™æ ·å°±èƒ½æƒ³åˆ°åŒºé—´DPçš„çŠ¶æ€å®šä¹‰ã€‚  


## æ€»ç»“  
æœ¬æ¬¡åˆ†æçš„æ ¸å¿ƒæ˜¯**åŒºé—´DP**çš„åº”ç”¨ï¼Œé€šè¿‡â€œæœªæ‹¿çš„çƒåŒºé—´+å½“å‰ä½ç½®â€çš„çŠ¶æ€å®šä¹‰ï¼Œå°†å¤æ‚çš„è·¯å¾„é—®é¢˜è½¬åŒ–ä¸ºå¯è®¡ç®—çš„å­é—®é¢˜ã€‚å…³é”®æŠ€å·§æ˜¯**å»é‡ä¼˜åŒ–**ï¼ˆè¿‡æ»¤æ‰m>1000çš„æƒ…å†µï¼‰å’Œ**æšä¸¾å‡ºå‘èµ·ç‚¹**ï¼ˆè¦†ç›–æ‰€æœ‰æœ€ä¼˜è·¯å¾„ï¼‰ã€‚  

å¸Œæœ›è¿™ä»½æŒ‡å—èƒ½å¸®åŠ©ä½ ç†è§£åŒºé—´DPçš„æ ¸å¿ƒé€»è¾‘ï¼è®°ä½ï¼Œç¼–ç¨‹çš„ä¹è¶£åœ¨äºâ€œè§£å†³é—®é¢˜çš„è¿‡ç¨‹â€â€”â€”å½“ä½ é€šè¿‡DPçŠ¶æ€å®šä¹‰è§£å†³ä¸€ä¸ªçœ‹ä¼¼ä¸å¯èƒ½çš„é—®é¢˜æ—¶ï¼Œé‚£ç§æˆå°±æ„Ÿæ˜¯æ— å¯æ›¿ä»£çš„ã€‚ä¸‹æ¬¡æˆ‘ä»¬å†ä¸€èµ·æ¢ç´¢æ›´å¤šæœ‰è¶£çš„ç®—æ³•é—®é¢˜ï¼ğŸ’ª

---
å¤„ç†ç”¨æ—¶ï¼š155.05ç§’
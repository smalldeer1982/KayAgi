# é¢˜ç›®ä¿¡æ¯

# [SHOI2009] èˆä¼š

## é¢˜ç›®æè¿°

OItownè¦ä¸¾åŠäº†ä¸€å¹´ä¸€åº¦çš„è¶…çº§èˆä¼šäº†ï¼Œä½œä¸ºä¸»åŠæ–¹çš„Constantineä¸ºäº†ä½¿ä»Šå¹´çš„èˆä¼šè§„æ¨¡ç©ºå‰ï¼Œä»–é‚€è¯·äº†è®¸å¤šä»–çš„å¥½å‹å’ŒåŒå­¦å»ã€‚èˆä¼šé‚£å¤©ï¼Œæ°å¥½æ¥äº†nä¸ªç”·ç”Ÿnä¸ªå¥³ç”Ÿã€‚Constantineå‘ç°ï¼Œä¸€èˆ¬æƒ…å†µä¸‹ï¼Œèˆä¼´ä¹‹é—´ï¼Œæ€»æ˜¯ç”·ä¼´æ€»æ˜¯æ¯”å¥³ä¼´é•¿å¾—é«˜ï¼Œä¸è¿‡ï¼Œå¶å°”ä¹Ÿæ˜¯æœ‰ç‰¹æ®Šæƒ…å†µçš„ã€‚æ‰€ä»¥ï¼ŒConstantineç°åœ¨æƒ³çŸ¥é“ï¼Œå¦‚æœæŠŠè¿™2nä¸ªäººæ°å¥½é…æˆnå¯¹èˆä¼´ï¼Œæœ‰å¤šå°‘ç§æ­é…æ–¹æ³•ï¼Œè€Œä¸”ä»–è¦æ±‚æœ€å¤šåªæœ‰kå¯¹èˆä¼´ä¹‹é—´å¥³ä¼´æ¯”ç”·ä¼´é«˜ã€‚ç°åœ¨ï¼ŒConstantineéœ€è¦å‚åŠ SHTSCçš„ä½ å¸®åŠ©ä»–ç®—å‡ºè¿™ä¸ªç­”æ¡ˆï¼Œå½“ç„¶å•¦ï¼Œä»–ä¼šå…ˆå‘Šè¯‰ä½ è¿™2nä¸ªåŒå­¦çš„èº«é«˜ã€‚


## è¯´æ˜/æç¤º

è¯„åˆ†
å¦‚æœä½ çš„è¾“å‡ºæ–‡ä»¶ä¸æ ‡å‡†ç­”æ¡ˆå®Œå…¨ç›¸ç¬¦ï¼Œä½ å°†è·å¾—è¯¥æµ‹è¯•ç‚¹çš„å…¨éƒ¨åˆ†æ•°ï¼Œå¦åˆ™å¾—é›¶åˆ†ã€‚


N< = 200

K< = N

## æ ·ä¾‹ #1

### è¾“å…¥

```
3 0
178
188
176
168
178
170
```

### è¾“å‡º

```
4```

# AIåˆ†æç»“æœ

# ğŸ’¡ Kayçš„C++ç®—æ³•è§£æï¼š[SHOI2009]èˆä¼š æ·±å…¥å­¦ä¹ æŒ‡å— ğŸ’¡


## 1. é¢˜ç›®è§£è¯»ä¸æ ¸å¿ƒç®—æ³•è¯†åˆ«

âœ¨ **æœ¬é¢˜ä¸»è¦è€ƒå¯Ÿ**ï¼šåŠ¨æ€è§„åˆ’ï¼ˆDPï¼‰+ å®¹æ–¥åŸç† + é«˜ç²¾åº¦è®¡ç®—  

ğŸ—£ï¸ **åˆæ­¥åˆ†æ**ï¼š  
è§£å†³â€œèˆä¼šâ€é—®é¢˜çš„å…³é”®ï¼Œåœ¨äº**ç”¨åŠ¨æ€è§„åˆ’ç»Ÿè®¡ç¬¦åˆæ¡ä»¶çš„é…å¯¹æ–¹æ¡ˆ**ï¼Œå¹¶é€šè¿‡**å®¹æ–¥åŸç†**ä¿®æ­£â€œè‡³å°‘â€ä¸â€œæ°å¥½â€çš„è®¡æ•°å·®å¼‚ï¼Œæœ€åç”¨**é«˜ç²¾åº¦è®¡ç®—**å¤„ç†æå¤§çš„æ–¹æ¡ˆæ•°ï¼ˆ200!çº§åˆ«çš„æ•°è¿œè¶…è¿‡æ™®é€šæ•´æ•°èŒƒå›´ï¼‰ã€‚  

ç®€å•æ¥è¯´ï¼Œ**åŠ¨æ€è§„åˆ’**å°±åƒâ€œä¸€æ­¥æ­¥æ­å»ºç§¯æœ¨â€ï¼šæˆ‘ä»¬å…ˆå°†ç”·å¥³æŒ‰èº«é«˜æ’åºï¼ˆæ’åºåèƒ½ç®€åŒ–æ¡ä»¶åˆ¤æ–­ï¼‰ï¼Œç„¶åç”¨`dp[i][j]`è¡¨ç¤ºå‰`i`ä¸ªå¥³ç”Ÿä¸­â€œè‡³å°‘â€æœ‰`j`å¯¹å¥³æ¯”ç”·é«˜çš„æ–¹æ¡ˆæ•°ã€‚**å®¹æ–¥åŸç†**åˆ™åƒâ€œå‰¥æ´‹è‘±â€ï¼šä»â€œè‡³å°‘`j`å¯¹â€çš„ç»“æœä¸­ï¼Œå‡å»å¤šç®—çš„â€œè‡³å°‘`j+1`å¯¹â€çš„æƒ…å†µï¼Œå¾—åˆ°â€œæ°å¥½`j`å¯¹â€çš„å‡†ç¡®å€¼ã€‚è€Œ**é«˜ç²¾åº¦è®¡ç®—**æ˜¯â€œæ”¾å¤§é•œâ€ï¼Œè®©æˆ‘ä»¬èƒ½å¤„ç†å·¨å¤§çš„æ•°è€Œä¸æº¢å‡ºã€‚  

### æ ¸å¿ƒç®—æ³•æµç¨‹ä¸å¯è§†åŒ–è®¾è®¡æ€è·¯  
1. **æ’åºé¢„å¤„ç†**ï¼šå°†ç”·ç”Ÿã€å¥³ç”Ÿèº«é«˜ä»å°åˆ°å¤§æ’åºï¼ˆæ¯”å¦‚ç”·ç”Ÿæ•°ç»„`M`ã€å¥³ç”Ÿæ•°ç»„`W`ï¼‰ï¼Œè¿™æ ·èƒ½å¿«é€Ÿæ‰¾åˆ°æ¯”å½“å‰å¥³ç”ŸçŸ®çš„ç”·ç”Ÿæ•°é‡ã€‚  
2. **DPçŠ¶æ€è½¬ç§»**ï¼šéå†æ¯ä¸ªå¥³ç”Ÿ`i`ï¼Œè®¡ç®—`dp[i][j]`ï¼ˆå‰`i`ä¸ªå¥³ç”Ÿè‡³å°‘`j`å¯¹å¥³æ¯”ç”·é«˜ï¼‰ã€‚è½¬ç§»æ—¶ï¼Œ`dp[i][j]`æ¥è‡ªä¸¤éƒ¨åˆ†ï¼š  
   - ä¸é€‰å½“å‰å¥³ç”Ÿä½œä¸ºç¬¬`j`å¯¹ï¼š`dp[i-1][j]`ï¼ˆç»§æ‰¿å‰`i-1`ä¸ªå¥³ç”Ÿçš„ç»“æœï¼‰ã€‚  
   - é€‰å½“å‰å¥³ç”Ÿä½œä¸ºç¬¬`j`å¯¹ï¼š`dp[i-1][j-1] * (p - (j-1))`ï¼ˆ`p`æ˜¯æ¯”å½“å‰å¥³ç”ŸçŸ®çš„ç”·ç”Ÿæ•°é‡ï¼Œå‡å»å·²ç”¨çš„`j-1`ä¸ªç”·ç”Ÿï¼‰ã€‚  
3. **å®¹æ–¥ä¿®æ­£**ï¼šç”¨`dp[n][j] * (n-j)!`ï¼ˆå‰©ä¸‹çš„`n-j`å¯¹ä»»æ„æ’åˆ—ï¼‰å¾—åˆ°â€œè‡³å°‘`j`å¯¹â€çš„æ€»æ–¹æ¡ˆ`g[j]`ï¼Œå†é€šè¿‡å®¹æ–¥å…¬å¼`f[i] = Î£(-1)^(j-i) * C(j,i) * g[j]`ï¼ˆ`f[i]`æ˜¯æ°å¥½`i`å¯¹çš„æ–¹æ¡ˆæ•°ï¼‰è®¡ç®—å‡†ç¡®å€¼ã€‚  
4. **ç»“æœç´¯åŠ **ï¼šå°†`f[0]`åˆ°`f[k]`ç›¸åŠ ï¼Œå¾—åˆ°æœ€å¤š`k`å¯¹çš„æ–¹æ¡ˆæ•°ã€‚  

### å¯è§†åŒ–æ–¹æ¡ˆè®¾è®¡æ€è·¯ï¼ˆåƒç´ é£æ ¼ï¼‰  
- **åœºæ™¯**ï¼šæ¨¡æ‹Ÿä¸€ä¸ªâ€œé…å¯¹èˆä¼šâ€ï¼Œå±å¹•å·¦ä¾§æ˜¯æ’åºåçš„ç”·ç”Ÿï¼ˆåƒç´ å—ï¼Œèº«é«˜è¶Šé«˜é¢œè‰²è¶Šæ·±ï¼‰ï¼Œå³ä¾§æ˜¯å¥³ç”Ÿï¼ˆåƒç´ å—ï¼Œèº«é«˜è¶Šé«˜é¢œè‰²è¶Šæµ…ï¼‰ã€‚  
- **DPè½¬ç§»åŠ¨ç”»**ï¼š  
  - æ¯å¤„ç†ä¸€ä¸ªå¥³ç”Ÿ`i`ï¼Œç”¨â€œé—ªçƒâ€æç¤ºå½“å‰å¥³ç”Ÿï¼Œç”¨â€œç®­å¤´â€æŒ‡å‘æ¯”å¥¹çŸ®çš„ç”·ç”Ÿ`p`ä¸ªã€‚  
  - å½“è®¡ç®—`dp[i][j]`æ—¶ï¼Œç”¨â€œåŠ å·â€åŠ¨ç”»å±•ç¤º`dp[i-1][j]`å’Œ`dp[i-1][j-1] * (p-j+1)`çš„åˆå¹¶è¿‡ç¨‹ã€‚  
- **å®¹æ–¥è¿‡ç¨‹**ï¼šç”¨â€œæ´‹è‘±å‰¥å±‚â€åŠ¨ç”»ï¼Œä»`g[j]`ä¸­å‡å»`C(j,i)*g[j]`ï¼ˆç¬¦å·ç”¨ä¸åŒé¢œè‰²è¡¨ç¤ºï¼šæ­£ä¸ºç»¿è‰²ï¼Œè´Ÿä¸ºçº¢è‰²ï¼‰ã€‚  
- **éŸ³æ•ˆ**ï¼š  
  - æ’åºå®Œæˆï¼šâ€œå®â€çš„æç¤ºéŸ³ã€‚  
  - DPè½¬ç§»ï¼šâ€œå’”å—’â€å£°ï¼ˆæ¯ä¸€æ­¥è®¡ç®—ï¼‰ã€‚  
  - å®¹æ–¥ä¿®æ­£ï¼šâ€œå’»â€å£°ï¼ˆå‡å»å¤šä½™éƒ¨åˆ†ï¼‰ã€‚  
  - ç»“æœè¾“å‡ºï¼šâ€œèƒœåˆ©â€éŸ³æ•ˆï¼ˆä¸Šæ‰¬çš„éŸ³è°ƒï¼‰ã€‚  


## 2. ç²¾é€‰ä¼˜è´¨é¢˜è§£å‚è€ƒ

### é¢˜è§£ä¸€ï¼šDP+å®¹æ–¥+é«˜ç²¾ï¼ˆä½œè€…ï¼šPineï¼Œèµï¼š8ï¼‰  
* **ç‚¹è¯„**ï¼š  
  è¿™ä»½é¢˜è§£æ˜¯æœ¬é¢˜çš„â€œç»å…¸æ¨¡æ¿â€ï¼Œæ€è·¯æ¸…æ™°ä¸”ä¸¥è°¨ã€‚ä½œè€…å…ˆå°†ç”·å¥³æ’åºï¼Œç”¨`f[i][j]`è¡¨ç¤ºå‰`i`ä¸ªå¥³ç”Ÿè‡³å°‘`j`å¯¹å¥³æ¯”ç”·é«˜çš„æ–¹æ¡ˆæ•°ï¼Œè½¬ç§»æ–¹ç¨‹`f[i][j] = f[i-1][j] + f[i-1][j-1]*(p-j+1)`ï¼ˆ`p`æ˜¯æ¯”å½“å‰å¥³ç”ŸçŸ®çš„ç”·ç”Ÿæ•°é‡ï¼‰éå¸¸ç›´è§‚ã€‚æ¥ç€ç”¨`g[j] = f[n][j]*(n-j)!`è®¡ç®—â€œè‡³å°‘`j`å¯¹â€çš„æ€»æ–¹æ¡ˆï¼Œå†é€šè¿‡å®¹æ–¥å¾—åˆ°â€œæ°å¥½`j`å¯¹â€çš„ç»“æœã€‚ä»£ç ä¸­çš„é«˜ç²¾åº¦å®ç°ï¼ˆå‹8ä½ï¼‰æ•ˆç‡è¾ƒé«˜ï¼Œå®¹æ–¥éƒ¨åˆ†çš„å¤„ç†ï¼ˆ`f[n][i] = f[n][i] - C[j][i]*f[n][j]`ï¼‰é€»è¾‘æ­£ç¡®ã€‚æ•´ä½“ä»£ç ç»“æ„å·¥æ•´ï¼Œå˜é‡å‘½åæ¸…æ™°ï¼ˆå¦‚`f`è¡¨ç¤ºDPæ•°ç»„ï¼Œ`C`è¡¨ç¤ºç»„åˆæ•°ï¼‰ï¼Œæ˜¯å­¦ä¹ æœ¬é¢˜çš„â€œæ ‡æ†â€è§£æ³•ã€‚  

### é¢˜è§£äºŒï¼šç›´æ¥DPï¼ˆä½œè€…ï¼šTyherï¼Œèµï¼š6ï¼›è§£é‡Šï¼šRui_Rï¼Œèµï¼š5ï¼‰  
* **ç‚¹è¯„**ï¼š  
  è¿™ä»½é¢˜è§£çš„æ€è·¯æ˜¯â€œç›´æ¥ç»Ÿè®¡æ°å¥½`j`å¯¹â€ï¼Œå®šä¹‰`dp[i][j]`ä¸ºå‰`i`å¯¹æœ‰`j`å¯¹å¥³æ¯”ç”·é«˜çš„æ–¹æ¡ˆæ•°ã€‚è½¬ç§»æ—¶åˆ†ä¸¤ç§æƒ…å†µï¼š  
  - å½“å‰å¥³ç”Ÿä¸é«˜äºç”·ç”Ÿï¼š`dp[i][j] = dp[i-1][j]*(j+Alpha) + dp[i-1][j-1]*(i-Alpha-(j-1))`ï¼ˆ`Alpha`æ˜¯æ¯”å½“å‰å¥³ç”ŸçŸ®çš„ç”·ç”Ÿæ•°é‡ï¼‰ã€‚  
  - å½“å‰å¥³ç”Ÿé«˜äºç”·ç”Ÿï¼š`dp[i][j] = dp[i-1][j]*(j-Alpha) + dp[i-1][j-1]*(i-((j-1)-Alpha))`ï¼ˆ`Alpha`æ˜¯ä¹‹å‰æ¯”å½“å‰ç”·ç”Ÿé«˜çš„å¥³ç”Ÿæ•°é‡ï¼‰ã€‚  
  è¿™ç§æ€è·¯çš„ä¼˜ç‚¹æ˜¯â€œç›´æ¥â€ï¼Œä½†è½¬ç§»æ¡ä»¶è¾ƒå¤æ‚ï¼Œéœ€è¦ä»”ç»†å¤„ç†è¾¹ç•Œæƒ…å†µã€‚Rui_Rçš„è§£é‡Šè¡¥å……äº†ç»†èŠ‚ï¼ˆå¦‚`Alpha`çš„è®¡ç®—ï¼‰ï¼Œè®©æ€è·¯æ›´æ¸…æ™°ã€‚ä»£ç ä¸­çš„é«˜ç²¾åº¦å®ç°ï¼ˆå‹9ä½ï¼‰å’Œæ»šåŠ¨æ•°ç»„ä¼˜åŒ–ï¼ˆ`dp[2][maxn]`ï¼‰å€¼å¾—å­¦ä¹ ã€‚  

### é¢˜è§£ä¸‰ï¼šDP+å®¹æ–¥ï¼ˆä½œè€…ï¼š2021hychï¼Œèµï¼š1ï¼‰  
* **ç‚¹è¯„**ï¼š  
  è¿™ä»½é¢˜è§£æ˜¯å¯¹â€œDP+å®¹æ–¥â€æ€è·¯çš„è¡¥å……ï¼Œä½œè€…æ˜ç¡®äº†â€œé’¦å®š`j`å¯¹â€çš„æ¦‚å¿µï¼ˆ`dp[i][j]`è¡¨ç¤ºå‰`i`ä¸ªå¥³ç”Ÿé’¦å®š`j`å¯¹å¥³æ¯”ç”·é«˜çš„æ–¹æ¡ˆæ•°ï¼‰ï¼Œå¹¶æ¨å¯¼äº†`g[j] = dp[n][j]*(n-j)!`ï¼ˆæœªé’¦å®šçš„`n-j`å¯¹ä»»æ„æ’åˆ—ï¼‰ã€‚å®¹æ–¥éƒ¨åˆ†çš„å¤„ç†ï¼ˆ`f[i] = Î£(-1)^(j-i)*C(j,i)*g[j]`ï¼‰ä¸Pineçš„é¢˜è§£ä¸€è‡´ï¼Œä½†ä½œè€…ç”¨â€œå…ˆåŠ æ­£é¡¹å†å‡è´Ÿé¡¹â€çš„æ–¹å¼é¿å…äº†é«˜ç²¾åº¦è´Ÿæ•°ï¼Œè¿™æ˜¯ä¸€ä¸ªå®ç”¨çš„æŠ€å·§ã€‚ä»£ç ä¸­çš„é«˜ç²¾åº¦å®ç°ï¼ˆç”¨`vector`å­˜å‚¨ï¼‰è¾ƒæ˜“ç†è§£ï¼Œé€‚åˆåˆå­¦è€…å‚è€ƒã€‚  


## 3. æ ¸å¿ƒéš¾ç‚¹è¾¨æä¸è§£é¢˜ç­–ç•¥

### 1. **éš¾ç‚¹1ï¼šDPçŠ¶æ€çš„å®šä¹‰ä¸è½¬ç§»**  
* **åˆ†æ**ï¼š  
  æ­£ç¡®çš„çŠ¶æ€å®šä¹‰æ˜¯DPçš„æ ¸å¿ƒã€‚æœ¬é¢˜ä¸­ï¼Œâ€œè‡³å°‘`j`å¯¹â€çš„çŠ¶æ€ï¼ˆå¦‚`f[i][j]`ï¼‰æ¯”â€œæ°å¥½`j`å¯¹â€çš„çŠ¶æ€ï¼ˆå¦‚`dp[i][j]`ï¼‰æ›´å®¹æ˜“è½¬ç§»ï¼Œå› ä¸ºâ€œè‡³å°‘â€çš„çŠ¶æ€å¯ä»¥é€šè¿‡â€œç»§æ‰¿â€å’Œâ€œæ‰©å±•â€å¾—åˆ°ï¼ˆæ¯”å¦‚`f[i][j]` = ä¸é€‰å½“å‰å¥³ç”Ÿçš„`f[i-1][j]` + é€‰å½“å‰å¥³ç”Ÿçš„`f[i-1][j-1]*(p-j+1)`ï¼‰ã€‚è€Œâ€œæ°å¥½â€çš„çŠ¶æ€éœ€è¦åˆ†æƒ…å†µè®¨è®ºï¼ˆå½“å‰å¥³ç”Ÿæ˜¯å¦æ¯”ç”·ç”Ÿé«˜ï¼‰ï¼Œè½¬ç§»æ¡ä»¶æ›´å¤æ‚ã€‚  
* ğŸ’¡ **å­¦ä¹ ç¬”è®°**ï¼šé€‰æ‹©â€œè‡³å°‘â€è€Œéâ€œæ°å¥½â€çš„çŠ¶æ€ï¼Œèƒ½ç®€åŒ–è½¬ç§»æ–¹ç¨‹ï¼Œè¿™æ˜¯ç»„åˆè®¡æ•°é—®é¢˜ä¸­å¸¸ç”¨çš„æŠ€å·§ã€‚  

### 2. **éš¾ç‚¹2ï¼šå®¹æ–¥åŸç†çš„åº”ç”¨**  
* **åˆ†æ**ï¼š  
  ä»â€œè‡³å°‘`j`å¯¹â€åˆ°â€œæ°å¥½`j`å¯¹â€éœ€è¦å®¹æ–¥ï¼Œå› ä¸º`g[j]`ï¼ˆè‡³å°‘`j`å¯¹ï¼‰åŒ…å«äº†`g[j+1]`ï¼ˆè‡³å°‘`j+1`å¯¹ï¼‰çš„æƒ…å†µã€‚å®¹æ–¥å…¬å¼`f[i] = Î£(-1)^(j-i)*C(j,i)*g[j]`çš„å«ä¹‰æ˜¯ï¼šä»`g[i]`ä¸­å‡å»å¤šç®—çš„`g[i+1]`ï¼ˆä¹˜ä»¥`C(i+1,i)`ï¼Œç¬¦å·ä¸ºè´Ÿï¼‰ï¼ŒåŠ ä¸Šå¤šå‡çš„`g[i+2]`ï¼ˆä¹˜ä»¥`C(i+2,i)`ï¼Œç¬¦å·ä¸ºæ­£ï¼‰ï¼Œä¾æ­¤ç±»æ¨ã€‚  
* ğŸ’¡ **å­¦ä¹ ç¬”è®°**ï¼šå®¹æ–¥åŸç†çš„å…³é”®æ˜¯â€œè°ƒæ•´ç¬¦å·â€ï¼Œå³`(-1)^(j-i)`ï¼Œç”¨æ¥ä¿®æ­£é‡å¤è®¡æ•°çš„é—®é¢˜ã€‚  

### 3. **éš¾ç‚¹3ï¼šé«˜ç²¾åº¦è®¡ç®—çš„å®ç°**  
* **åˆ†æ**ï¼š  
  æœ¬é¢˜çš„æ–¹æ¡ˆæ•°æ˜¯`200!`çº§åˆ«çš„ï¼Œè¿œè¶…è¿‡`long long`çš„èŒƒå›´ï¼ˆ`200! â‰ˆ 7.8e374`ï¼‰ï¼Œå› æ­¤éœ€è¦ç”¨é«˜ç²¾åº¦è®¡ç®—ã€‚é«˜ç²¾åº¦çš„å®ç°è¦ç‚¹æ˜¯ï¼š  
  - ç”¨æ•°ç»„æˆ–`vector`å­˜å‚¨å¤§æ•°ï¼ˆæ¯ä¸€ä½å­˜å‚¨`1e8`æˆ–`1e9`ï¼Œå‡å°‘ä½æ•°ï¼‰ã€‚  
  - å®ç°åŠ å‡ä¹˜è¿ç®—ï¼ˆæ³¨æ„è¿›ä½å’Œå€Ÿä½ï¼‰ã€‚  
  - é¿å…ä¸å¿…è¦çš„è®¡ç®—ï¼ˆå¦‚å‹ä½å¯ä»¥å‡å°‘å¾ªç¯æ¬¡æ•°ï¼‰ã€‚  
* ğŸ’¡ **å­¦ä¹ ç¬”è®°**ï¼šé«˜ç²¾åº¦è®¡ç®—çš„æ ¸å¿ƒæ˜¯â€œæ¨¡æ‹Ÿæ‰‹å·¥è®¡ç®—â€ï¼Œå‹ä½èƒ½æé«˜æ•ˆç‡ï¼Œæ˜¯å¤„ç†å¤§æ•°çš„å¿…å¤‡æŠ€å·§ã€‚  

### âœ¨ è§£é¢˜æŠ€å·§æ€»ç»“  
- **æ’åºé¢„å¤„ç†**ï¼šå°†ç”·å¥³èº«é«˜æ’åºï¼Œèƒ½å¿«é€Ÿæ‰¾åˆ°æ¯”å½“å‰å¥³ç”ŸçŸ®çš„ç”·ç”Ÿæ•°é‡ï¼Œç®€åŒ–æ¡ä»¶åˆ¤æ–­ã€‚  
- **çŠ¶æ€é€‰æ‹©**ï¼šä¼˜å…ˆé€‰æ‹©â€œè‡³å°‘â€è€Œéâ€œæ°å¥½â€çš„çŠ¶æ€ï¼Œç®€åŒ–è½¬ç§»æ–¹ç¨‹ã€‚  
- **å®¹æ–¥ä¿®æ­£**ï¼šç”¨å®¹æ–¥åŸç†ä»â€œè‡³å°‘â€è½¬æ¢ä¸ºâ€œæ°å¥½â€ï¼Œæ³¨æ„ç¬¦å·å’Œç»„åˆæ•°çš„å¤„ç†ã€‚  
- **é«˜ç²¾åº¦ä¼˜åŒ–**ï¼šç”¨å‹ä½å­˜å‚¨å¤§æ•°ï¼Œæé«˜è®¡ç®—æ•ˆç‡ã€‚  


## 4. C++æ ¸å¿ƒä»£ç å®ç°èµæ

### æœ¬é¢˜é€šç”¨æ ¸å¿ƒC++å®ç°å‚è€ƒ  
* **è¯´æ˜**ï¼šç»¼åˆPineã€wyd_foreverã€2021hychçš„é¢˜è§£ï¼Œæç‚¼å‡ºâ€œDP+å®¹æ–¥+é«˜ç²¾â€çš„ç»å…¸å®ç°ã€‚  
* **å®Œæ•´æ ¸å¿ƒä»£ç **ï¼š  
  ```cpp
  #include <iostream>
  #include <vector>
  #include <algorithm>
  using namespace std;

  const int MAXN = 205;
  const int BASE = 1e8; // å‹8ä½

  struct BigInt {
      vector<int> digits;
      BigInt() {}
      BigInt(int x) {
          if (x == 0) digits.push_back(0);
          while (x > 0) {
              digits.push_back(x % BASE);
              x /= BASE;
          }
      }
      BigInt operator+(const BigInt& other) const {
          BigInt res;
          int carry = 0;
          int max_len = max(digits.size(), other.digits.size());
          for (int i = 0; i < max_len || carry; ++i) {
              if (i < digits.size()) carry += digits[i];
              if (i < other.digits.size()) carry += other.digits[i];
              res.digits.push_back(carry % BASE);
              carry /= BASE;
          }
          return res;
      }
      BigInt operator-(const BigInt& other) const { // å‡è®¾this >= other
          BigInt res;
          int borrow = 0;
          for (int i = 0; i < digits.size(); ++i) {
              int val = digits[i] - borrow;
              if (i < other.digits.size()) val -= other.digits[i];
              if (val < 0) {
                  val += BASE;
                  borrow = 1;
              } else {
                  borrow = 0;
              }
              res.digits.push_back(val);
          }
          while (res.digits.size() > 1 && res.digits.back() == 0) {
              res.digits.pop_back();
          }
          return res;
      }
      BigInt operator*(const BigInt& other) const {
          BigInt res;
          res.digits.resize(digits.size() + other.digits.size(), 0);
          for (int i = 0; i < digits.size(); ++i) {
              for (int j = 0; j < other.digits.size(); ++j) {
                  long long product = (long long)digits[i] * other.digits[j];
                  res.digits[i + j] += product % BASE;
                  res.digits[i + j + 1] += product / BASE;
              }
          }
          for (int i = 0; i < res.digits.size() - 1; ++i) {
              res.digits[i + 1] += res.digits[i] / BASE;
              res.digits[i] %= BASE;
          }
          while (res.digits.size() > 1 && res.digits.back() == 0) {
              res.digits.pop_back();
          }
          return res;
      }
      BigInt operator*(int x) const { // x < BASE
          BigInt res;
          long long carry = 0;
          for (int d : digits) {
              carry += (long long)d * x;
              res.digits.push_back(carry % BASE);
              carry /= BASE;
          }
          while (carry > 0) {
              res.digits.push_back(carry % BASE);
              carry /= BASE;
          }
          return res;
      }
      void print() const {
          if (digits.empty()) {
              cout << 0 << endl;
              return;
          }
          cout << digits.back();
          for (int i = digits.size() - 2; i >= 0; --i) {
              printf("%08d", digits[i]); // è¡¥å‰å¯¼é›¶
          }
          cout << endl;
      }
  };

  BigInt C[MAXN][MAXN], fact[MAXN], f[MAXN][MAXN], g[MAXN], ans;
  int M[MAXN], W[MAXN], n, k;

  void init() {
      // åˆå§‹åŒ–ç»„åˆæ•°C(n,k)
      for (int i = 0; i < MAXN; ++i) {
          C[i][0] = BigInt(1);
          C[i][i] = BigInt(1);
          for (int j = 1; j < i; ++j) {
              C[i][j] = C[i-1][j-1] + C[i-1][j];
          }
      }
      // åˆå§‹åŒ–é˜¶ä¹˜fact[n] = n!
      fact[0] = BigInt(1);
      for (int i = 1; i < MAXN; ++i) {
          fact[i] = fact[i-1] * i;
      }
  }

  int main() {
      init();
      cin >> n >> k;
      for (int i = 1; i <= n; ++i) {
          cin >> M[i];
      }
      for (int i = 1; i <= n; ++i) {
          cin >> W[i];
      }
      sort(M + 1, M + n + 1);
      sort(W + 1, W + n + 1);

      // åˆå§‹åŒ–DPæ•°ç»„f[i][j]ï¼šå‰iä¸ªå¥³ç”Ÿè‡³å°‘jå¯¹å¥³æ¯”ç”·é«˜çš„æ–¹æ¡ˆæ•°
      for (int i = 0; i <= n; ++i) {
          f[i][0] = BigInt(1); // 0å¯¹çš„æƒ…å†µåªæœ‰1ç§ï¼ˆéƒ½ä¸é€‰ï¼‰
      }
      int p = 0; // æ¯”å½“å‰å¥³ç”ŸçŸ®çš„ç”·ç”Ÿæ•°é‡
      for (int i = 1; i <= n; ++i) {
          while (p < n && M[p+1] < W[i]) {
              p++;
          }
          for (int j = 1; j <= i; ++j) {
              f[i][j] = f[i-1][j]; // ä¸é€‰å½“å‰å¥³ç”Ÿä½œä¸ºç¬¬jå¯¹
              if (p >= j) { // æœ‰è¶³å¤Ÿçš„ç”·ç”Ÿå¯é€‰
                  f[i][j] = f[i][j] + f[i-1][j-1] * (p - j + 1); // é€‰å½“å‰å¥³ç”Ÿä½œä¸ºç¬¬jå¯¹
              }
          }
      }

      // è®¡ç®—g[j] = f[n][j] * (n-j)! ï¼ˆè‡³å°‘jå¯¹çš„æ€»æ–¹æ¡ˆæ•°ï¼‰
      for (int j = 0; j <= n; ++j) {
          g[j] = f[n][j] * fact[n - j];
      }

      // å®¹æ–¥è®¡ç®—æ°å¥½iå¯¹çš„æ–¹æ¡ˆæ•°ï¼Œå¹¶ç´¯åŠ æœ€å¤škå¯¹çš„ç»“æœ
      ans = BigInt(0);
      for (int i = 0; i <= k; ++i) {
          BigInt sum = BigInt(0);
          for (int j = i; j <= n; ++j) {
              BigInt term = C[j][i] * g[j];
              if ((j - i) % 2 == 1) {
                  sum = sum - term; // ç¬¦å·ä¸ºè´Ÿ
              } else {
                  sum = sum + term; // ç¬¦å·ä¸ºæ­£
              }
          }
          ans = ans + sum;
      }

      ans.print();
      return 0;
  }
  ```  
* **ä»£ç è§£è¯»æ¦‚è¦**ï¼š  
  1. **é«˜ç²¾åº¦å®ç°**ï¼šç”¨`vector<int>`å­˜å‚¨å¤§æ•°ï¼Œæ¯ä¸€ä½å­˜å‚¨`1e8`ï¼Œå®ç°äº†åŠ å‡ä¹˜è¿ç®—ï¼ˆ`+`ã€`-`ã€`*`ï¼‰ã€‚  
  2. **åˆå§‹åŒ–**ï¼šè®¡ç®—ç»„åˆæ•°`C(n,k)`å’Œé˜¶ä¹˜`fact[n]`ï¼ˆç”¨äºå®¹æ–¥å’Œåç»­è®¡ç®—ï¼‰ã€‚  
  3. **è¾“å…¥ä¸æ’åº**ï¼šè¯»å–ç”·ç”Ÿå’Œå¥³ç”Ÿçš„èº«é«˜ï¼Œæ’åºåç®€åŒ–æ¡ä»¶åˆ¤æ–­ã€‚  
  4. **DPè®¡ç®—**ï¼šç”¨`f[i][j]`è¡¨ç¤ºå‰`i`ä¸ªå¥³ç”Ÿè‡³å°‘`j`å¯¹å¥³æ¯”ç”·é«˜çš„æ–¹æ¡ˆæ•°ï¼Œè½¬ç§»æ—¶è€ƒè™‘â€œé€‰â€æˆ–â€œä¸é€‰â€å½“å‰å¥³ç”Ÿã€‚  
  5. **å®¹æ–¥ä¿®æ­£**ï¼šç”¨`g[j] = f[n][j] * (n-j)!`è®¡ç®—â€œè‡³å°‘`j`å¯¹â€çš„æ€»æ–¹æ¡ˆï¼Œå†é€šè¿‡å®¹æ–¥å¾—åˆ°â€œæ°å¥½`i`å¯¹â€çš„ç»“æœï¼Œç´¯åŠ æœ€å¤š`k`å¯¹çš„æ–¹æ¡ˆæ•°ã€‚  
  6. **è¾“å‡ºç»“æœ**ï¼šç”¨`print`å‡½æ•°è¾“å‡ºé«˜ç²¾åº¦æ•°ï¼ˆè¡¥å‰å¯¼é›¶ï¼‰ã€‚  

### é’ˆå¯¹å„ä¼˜è´¨é¢˜è§£çš„ç‰‡æ®µèµæ  
#### é¢˜è§£ä¸€ï¼ˆPineï¼‰ï¼šDPè½¬ç§»ç‰‡æ®µ  
* **äº®ç‚¹**ï¼šè½¬ç§»æ–¹ç¨‹ç›´è§‚ï¼Œå¤„ç†äº†â€œé€‰â€ä¸â€œä¸é€‰â€çš„æƒ…å†µã€‚  
* **æ ¸å¿ƒä»£ç ç‰‡æ®µ**ï¼š  
  ```cpp
  for (int i = 1, j = 0; i <= n; ++i) {
      while (B[i] > A[j+1] && j+1 <= n) ++j; // Bæ˜¯å¥³ç”Ÿæ•°ç»„ï¼ŒAæ˜¯ç”·ç”Ÿæ•°ç»„ï¼Œjæ˜¯æ¯”å½“å‰å¥³ç”ŸçŸ®çš„ç”·ç”Ÿæ•°é‡
      for (int k = 0; k <= i; ++k) {
          f[i][k] = f[i-1][k]; // ä¸é€‰å½“å‰å¥³ç”Ÿ
          if (j - (k-1) > 0) {
              f[i][k] = f[i][k] + f[i-1][k-1] * (j - (k-1)); // é€‰å½“å‰å¥³ç”Ÿ
          }
      }
  }
  ```  
* **ä»£ç è§£è¯»**ï¼š  
  - ç”¨`j`ç»Ÿè®¡æ¯”å½“å‰å¥³ç”Ÿ`B[i]`çŸ®çš„ç”·ç”Ÿæ•°é‡ï¼ˆ`A[j+1]`æ˜¯ç¬¬ä¸€ä¸ªä¸çŸ®äº`B[i]`çš„ç”·ç”Ÿï¼‰ã€‚  
  - `f[i][k]`ç»§æ‰¿`f[i-1][k]`ï¼ˆä¸é€‰å½“å‰å¥³ç”Ÿä½œä¸ºç¬¬`k`å¯¹ï¼‰ã€‚  
  - è‹¥`j >= k`ï¼ˆæœ‰è¶³å¤Ÿçš„ç”·ç”Ÿå¯é€‰ï¼‰ï¼Œåˆ™åŠ ä¸Š`f[i-1][k-1] * (j - k + 1)`ï¼ˆé€‰å½“å‰å¥³ç”Ÿä½œä¸ºç¬¬`k`å¯¹ï¼Œä»`j`ä¸ªç”·ç”Ÿä¸­é€‰`k`ä¸ªï¼Œå·²ç”¨`k-1`ä¸ªï¼Œå‰©`j - (k-1)`ä¸ªï¼‰ã€‚  
* ğŸ’¡ **å­¦ä¹ ç¬”è®°**ï¼šç”¨åŒæŒ‡é’ˆç»Ÿè®¡`j`ï¼ˆæ¯”å½“å‰å¥³ç”ŸçŸ®çš„ç”·ç”Ÿæ•°é‡ï¼‰ï¼Œæ—¶é—´å¤æ‚åº¦`O(n)`ï¼Œéå¸¸é«˜æ•ˆã€‚  

#### é¢˜è§£äºŒï¼ˆTyherï¼‰ï¼šç›´æ¥DPè½¬ç§»ç‰‡æ®µ  
* **äº®ç‚¹**ï¼šåˆ†æƒ…å†µè®¨è®ºå½“å‰å¥³ç”Ÿæ˜¯å¦æ¯”ç”·ç”Ÿé«˜ï¼Œç›´æ¥ç»Ÿè®¡â€œæ°å¥½`j`å¯¹â€ã€‚  
* **æ ¸å¿ƒä»£ç ç‰‡æ®µ**ï¼š  
  ```cpp
  if (x[i] >= y[i]) { // å½“å‰å¥³ç”Ÿä¸é«˜äºç”·ç”Ÿ
      for (int c = 0; c <= i; ++c) {
          dp[i][c] = dp[i][c] + S[i] * dp[i-1][c]; // S[i]æ˜¯æ¯”å½“å‰å¥³ç”ŸçŸ®çš„ç”·ç”Ÿæ•°é‡
      }
      for (int c = 0; c <= i; ++c) {
          dp[i][c] = dp[i][c] + c * dp[i-1][c]; // é€‰ä¹‹å‰çš„jå¯¹ä¸­çš„ä»»æ„ä¸€ä¸ª
      }
      for (int c = 1; c <= i - S[i]; ++c) {
          dp[i][c] = dp[i][c] + (i - S[i] - c + 1) * dp[i-1][c-1]; // é€‰æ–°çš„jå¯¹
      }
  } else { // å½“å‰å¥³ç”Ÿé«˜äºç”·ç”Ÿ
      for (int c = 1; c <= i; ++c) {
          dp[i][c] = dp[i][c] + T[i] * dp[i-1][c-1]; // T[i]æ˜¯ä¹‹å‰æ¯”å½“å‰ç”·ç”Ÿé«˜çš„å¥³ç”Ÿæ•°é‡
          dp[i][c] = dp[i][c] + (i - c) * dp[i-1][c-1]; // é€‰ä¹‹å‰çš„éjå¯¹ä¸­çš„ä»»æ„ä¸€ä¸ª
      }
      for (int c = T[i]; c <= i; ++c) {
          dp[i][c] = dp[i][c] + (c - T[i] + 1) * dp[i-1][c]; // é€‰ä¹‹å‰çš„jå¯¹ä¸­çš„ä»»æ„ä¸€ä¸ª
      }
  }
  ```  
* **ä»£ç è§£è¯»**ï¼š  
  - å½“å½“å‰å¥³ç”Ÿä¸é«˜äºç”·ç”Ÿæ—¶ï¼Œ`dp[i][c]`æ¥è‡ªä¸‰éƒ¨åˆ†ï¼š`S[i] * dp[i-1][c]`ï¼ˆé€‰æ¯”å½“å‰å¥³ç”ŸçŸ®çš„ç”·ç”Ÿï¼‰ã€`c * dp[i-1][c]`ï¼ˆé€‰ä¹‹å‰çš„`c`å¯¹ä¸­çš„ä»»æ„ä¸€ä¸ªï¼‰ã€`(i - S[i] - c + 1) * dp[i-1][c-1]`ï¼ˆé€‰æ–°çš„`c`å¯¹ï¼‰ã€‚  
  - å½“å½“å‰å¥³ç”Ÿé«˜äºç”·ç”Ÿæ—¶ï¼Œ`dp[i][c]`æ¥è‡ªä¸¤éƒ¨åˆ†ï¼š`T[i] * dp[i-1][c-1]`ï¼ˆé€‰ä¹‹å‰æ¯”å½“å‰ç”·ç”Ÿé«˜çš„å¥³ç”Ÿï¼‰ã€`(i - c) * dp[i-1][c-1]`ï¼ˆé€‰ä¹‹å‰çš„é`c`å¯¹ä¸­çš„ä»»æ„ä¸€ä¸ªï¼‰ï¼Œä»¥åŠ`(c - T[i] + 1) * dp[i-1][c]`ï¼ˆé€‰ä¹‹å‰çš„`c`å¯¹ä¸­çš„ä»»æ„ä¸€ä¸ªï¼‰ã€‚  
* ğŸ’¡ **å­¦ä¹ ç¬”è®°**ï¼šç›´æ¥DPçš„è½¬ç§»æ¡ä»¶è¾ƒå¤æ‚ï¼Œä½†èƒ½ç›´æ¥å¾—åˆ°â€œæ°å¥½`j`å¯¹â€çš„ç»“æœï¼Œé€‚åˆç†è§£â€œåˆ†æƒ…å†µè®¨è®ºâ€çš„æ€è·¯ã€‚  


## 5. ç®—æ³•å¯è§†åŒ–ï¼šåƒç´ åŠ¨ç”»æ¼”ç¤ºï¼ˆæ ¸å¿ƒéƒ¨åˆ†ï¼‰

### åŠ¨ç”»æ¼”ç¤ºä¸»é¢˜ï¼šâ€œèˆä¼šé…å¯¹å¤§æŒ‘æˆ˜â€ï¼ˆ8ä½åƒç´ é£æ ¼ï¼‰  
### æ ¸å¿ƒæ¼”ç¤ºå†…å®¹ï¼š  
æ¨¡æ‹Ÿâ€œæ’åºâ†’DPè½¬ç§»â†’å®¹æ–¥ä¿®æ­£â†’ç»“æœè¾“å‡ºâ€çš„å®Œæ•´æµç¨‹ï¼Œç”¨åƒç´ å—å±•ç¤ºç”·å¥³èº«é«˜ã€DPæ•°ç»„å˜åŒ–ã€å®¹æ–¥è¿‡ç¨‹ã€‚  

### è®¾è®¡æ€è·¯ç®€è¿°ï¼š  
- **åƒç´ é£æ ¼**ï¼šé‡‡ç”¨FCçº¢ç™½æœºçš„8ä½è‰²å½©ï¼ˆå¦‚ç”·ç”Ÿç”¨è“è‰²ï¼Œå¥³ç”Ÿç”¨ç²‰è‰²ï¼Œèº«é«˜è¶Šé«˜é¢œè‰²è¶Šæ·±ï¼‰ï¼Œè¥é€ å¤å¤æ¸¸æˆæ°›å›´ã€‚  
- **äº¤äº’æ§åˆ¶**ï¼šæä¾›â€œå•æ­¥æ‰§è¡Œâ€â€œè‡ªåŠ¨æ’­æ”¾â€â€œé‡ç½®â€æŒ‰é’®ï¼Œä»¥åŠâ€œé€Ÿåº¦æ»‘å—â€ï¼ˆè°ƒæ•´åŠ¨ç”»é€Ÿåº¦ï¼‰ã€‚  
- **æ¸¸æˆåŒ–å…ƒç´ **ï¼š  
  - **å…³å¡è®¾è®¡**ï¼šå°†æµç¨‹åˆ†ä¸ºâ€œæ’åºå…³â€â€œDPå…³â€â€œå®¹æ–¥å…³â€â€œç»“æœå…³â€ï¼Œæ¯å…³å®Œæˆåæ˜¾ç¤ºâ€œé€šå…³â€åŠ¨ç”»ï¼ˆå¦‚åƒç´ æ˜Ÿæ˜Ÿé—ªçƒï¼‰ã€‚  
  - **éŸ³æ•ˆæç¤º**ï¼šæ’åºå®Œæˆæ—¶æ’­æ”¾â€œå®â€çš„æç¤ºéŸ³ï¼ŒDPè½¬ç§»æ—¶æ’­æ”¾â€œå’”å—’â€å£°ï¼Œå®¹æ–¥ä¿®æ­£æ—¶æ’­æ”¾â€œå’»â€å£°ï¼Œç»“æœè¾“å‡ºæ—¶æ’­æ”¾â€œèƒœåˆ©â€éŸ³æ•ˆï¼ˆä¸Šæ‰¬çš„éŸ³è°ƒï¼‰ã€‚  
  - **ç§¯åˆ†ç³»ç»Ÿ**ï¼šæ¯å®Œæˆä¸€æ­¥æ­£ç¡®æ“ä½œï¼ˆå¦‚æ­£ç¡®è®¡ç®—`dp[i][j]`ï¼‰è·å¾—10åˆ†ï¼Œç´¯è®¡ç§¯åˆ†å¯è§£é”â€œéšè—å…³å¡â€ï¼ˆå¦‚â€œæŒ‘æˆ˜æ›´é«˜kå€¼â€ï¼‰ã€‚  

### åŠ¨ç”»å¸§æ­¥éª¤ä¸äº¤äº’å…³é”®ç‚¹ï¼š  
1. **æ’åºå…³**ï¼š  
   - å±å¹•å·¦ä¾§æ˜¾ç¤ºç”·ç”Ÿæ•°ç»„ï¼ˆè“è‰²åƒç´ å—ï¼Œèº«é«˜è¶Šé«˜é¢œè‰²è¶Šæ·±ï¼‰ï¼Œå³ä¾§æ˜¾ç¤ºå¥³ç”Ÿæ•°ç»„ï¼ˆç²‰è‰²åƒç´ å—ï¼‰ã€‚  
   - ç”¨â€œç®­å¤´â€åŠ¨ç”»å±•ç¤ºæ’åºè¿‡ç¨‹ï¼ˆå¦‚å†’æ³¡æ’åºçš„äº¤æ¢åŠ¨ä½œï¼‰ï¼Œæ’åºå®Œæˆåæ’­æ”¾â€œå®â€çš„æç¤ºéŸ³ã€‚  
2. **DPå…³**ï¼š  
   - å±å¹•ä¸Šæ–¹æ˜¾ç¤ºå½“å‰å¤„ç†çš„å¥³ç”Ÿï¼ˆç²‰è‰²åƒç´ å—ï¼Œé—ªçƒæç¤ºï¼‰ï¼Œä¸‹æ–¹æ˜¾ç¤ºDPæ•°ç»„`f[i][j]`ï¼ˆç”¨æ•°å­—åƒç´ å—è¡¨ç¤ºï¼Œæ•°å€¼è¶Šå¤§é¢œè‰²è¶Šäº®ï¼‰ã€‚  
   - ç”¨â€œåŠ å·â€åŠ¨ç”»å±•ç¤º`f[i][j] = f[i-1][j] + f[i-1][j-1]*(p-j+1)`çš„åˆå¹¶è¿‡ç¨‹ï¼Œ`p`ï¼ˆæ¯”å½“å‰å¥³ç”ŸçŸ®çš„ç”·ç”Ÿæ•°é‡ï¼‰ç”¨â€œç®­å¤´â€æŒ‡å‘å¯¹åº”çš„ç”·ç”Ÿã€‚  
3. **å®¹æ–¥å…³**ï¼š  
   - å±å¹•å·¦ä¾§æ˜¾ç¤º`g[j]`ï¼ˆè‡³å°‘`j`å¯¹çš„æ–¹æ¡ˆæ•°ï¼Œç”¨ç»¿è‰²åƒç´ å—è¡¨ç¤ºï¼‰ï¼Œå³ä¾§æ˜¾ç¤º`f[i]`ï¼ˆæ°å¥½`i`å¯¹çš„æ–¹æ¡ˆæ•°ï¼Œç”¨çº¢è‰²åƒç´ å—è¡¨ç¤ºï¼‰ã€‚  
   - ç”¨â€œå‡å·â€åŠ¨ç”»å±•ç¤º`f[i] = f[i] - C(j,i)*g[j]`ï¼ˆç¬¦å·ä¸ºè´Ÿï¼‰ï¼Œç”¨â€œåŠ å·â€åŠ¨ç”»å±•ç¤º`f[i] = f[i] + C(j,i)*g[j]`ï¼ˆç¬¦å·ä¸ºæ­£ï¼‰ã€‚  
4. **ç»“æœå…³**ï¼š  
   - å±å¹•ä¸­å¤®æ˜¾ç¤ºæœ€ç»ˆç»“æœï¼ˆç”¨å¤§å­—ä½“åƒç´ å—è¡¨ç¤ºï¼‰ï¼Œæ’­æ”¾â€œèƒœåˆ©â€éŸ³æ•ˆï¼ŒåŒæ—¶æ˜¾ç¤ºâ€œé€šå…³â€åŠ¨ç”»ï¼ˆå¦‚åƒç´ çƒŸèŠ±ç»½æ”¾ï¼‰ã€‚  

### æ—ç™½æç¤ºï¼ˆåŠ¨ç”»ä¸­çš„æ–‡å­—æ°”æ³¡ï¼‰ï¼š  
- **æ’åºå…³**ï¼šâ€œå…ˆæŠŠç”·ç”Ÿå’Œå¥³ç”ŸæŒ‰èº«é«˜æ’åºï¼Œè¿™æ ·æ›´å®¹æ˜“æ‰¾åˆ°åˆé€‚çš„èˆä¼´å“¦ï¼â€  
- **DPå…³**ï¼šâ€œç°åœ¨å¤„ç†ç¬¬`i`ä¸ªå¥³ç”Ÿï¼Œçœ‹çœ‹å¥¹èƒ½å’Œå¤šå°‘ä¸ªç”·ç”Ÿé…å¯¹å§ï¼â€  
- **å®¹æ–¥å…³**ï¼šâ€œä»â€˜è‡³å°‘`j`å¯¹â€™ä¸­å‡å»å¤šç®—çš„éƒ¨åˆ†ï¼Œå°±èƒ½å¾—åˆ°â€˜æ°å¥½`j`å¯¹â€™çš„å‡†ç¡®å€¼å•¦ï¼â€  
- **ç»“æœå…³**ï¼šâ€œæ­å–œä½ ï¼æ‰¾åˆ°äº†è§£å†³æ–¹æ¡ˆï¼Œæ–¹æ¡ˆæ•°æ˜¯`[ç»“æœ]`ï¼â€  


## 6. æ‹“å±•ç»ƒä¹ ä¸ç›¸ä¼¼é—®é¢˜æ€è€ƒ

### é€šç”¨æ€è·¯/æŠ€å·§è¿ç§»  
- **åŠ¨æ€è§„åˆ’**ï¼šé€‚ç”¨äºâ€œåˆ†æ­¥å†³ç­–â€çš„é—®é¢˜ï¼ˆå¦‚é…å¯¹ã€æ’åˆ—ã€ç»„åˆè®¡æ•°ï¼‰ã€‚  
- **å®¹æ–¥åŸç†**ï¼šé€‚ç”¨äºâ€œä»è‡³å°‘åˆ°æ°å¥½â€çš„è®¡æ•°é—®é¢˜ï¼ˆå¦‚ç»Ÿè®¡æ°å¥½`k`ä¸ªæ»¡è¶³æ¡ä»¶çš„å…ƒç´ ï¼‰ã€‚  
- **é«˜ç²¾åº¦è®¡ç®—**ï¼šé€‚ç”¨äºå¤„ç†æå¤§çš„æ•°ï¼ˆå¦‚`n!`ã€ç»„åˆæ•°ï¼‰ã€‚  

### ç»ƒä¹ æ¨èï¼ˆæ´›è°·ï¼‰  
1. **æ´›è°· P2159** - [SHOI2009]èˆä¼š  
   * ğŸ—£ï¸ **æ¨èç†ç”±**ï¼šåŸé¢˜ï¼Œå·©å›ºâ€œDP+å®¹æ–¥+é«˜ç²¾â€çš„æ€è·¯ã€‚  
2. **æ´›è°· P1020** - å¯¼å¼¹æ‹¦æˆª  
   * ğŸ—£ï¸ **æ¨èç†ç”±**ï¼šè€ƒå¯ŸåŠ¨æ€è§„åˆ’ï¼ˆæœ€é•¿ä¸ä¸‹é™å­åºåˆ—ï¼‰ï¼Œä¸æœ¬é¢˜çš„â€œåˆ†æ­¥å†³ç­–â€æ€è·¯ç±»ä¼¼ã€‚  
3. **æ´›è°· P1103** - ä¹¦æœ¬æ•´ç†  
   * ğŸ—£ï¸ **æ¨èç†ç”±**ï¼šè€ƒå¯ŸåŠ¨æ€è§„åˆ’ï¼ˆçŠ¶æ€å®šä¹‰ä¸è½¬ç§»ï¼‰ï¼Œéœ€è¦å¤„ç†â€œæ°å¥½`k`æœ¬â€çš„è®¡æ•°é—®é¢˜ã€‚  
4. **æ´›è°· P1359** - ç§Ÿç”¨æ¸¸è‰‡  
   * ğŸ—£ï¸ **æ¨èç†ç”±**ï¼šè€ƒå¯ŸåŠ¨æ€è§„åˆ’ï¼ˆåŒºé—´DPï¼‰ï¼Œä¸æœ¬é¢˜çš„â€œå®¹æ–¥åŸç†â€ç»“åˆï¼Œé€‚åˆæ‹“å±•æ€è·¯ã€‚  


## 7. å­¦ä¹ å¿ƒå¾—ä¸ç»éªŒåˆ†äº«ï¼ˆè‹¥æœ‰ï¼‰  
- **æ¥è‡ªPineçš„ç»éªŒ**ï¼šâ€œæ’åºæ˜¯æœ¬é¢˜çš„å…³é”®ï¼Œæ’åºåèƒ½å¿«é€Ÿæ‰¾åˆ°æ¯”å½“å‰å¥³ç”ŸçŸ®çš„ç”·ç”Ÿæ•°é‡ï¼Œç®€åŒ–äº†DPè½¬ç§»ã€‚â€  
  * **ç‚¹è¯„**ï¼šæ’åºé¢„å¤„ç†æ˜¯ç»„åˆè®¡æ•°é—®é¢˜ä¸­å¸¸ç”¨çš„æŠ€å·§ï¼Œèƒ½å°†å¤æ‚çš„æ¡ä»¶åˆ¤æ–­è½¬åŒ–ä¸ºç®€å•çš„åŒæŒ‡é’ˆç»Ÿè®¡ï¼Œå€¼å¾—å­¦ä¹ ã€‚  
- **æ¥è‡ªTyherçš„ç»éªŒ**ï¼šâ€œç›´æ¥DPçš„è½¬ç§»æ¡ä»¶è¾ƒå¤æ‚ï¼Œéœ€è¦ä»”ç»†å¤„ç†è¾¹ç•Œæƒ…å†µï¼ˆå¦‚`i`å’Œ`j`çš„èŒƒå›´ï¼‰ã€‚â€  
  * **ç‚¹è¯„**ï¼šåˆ†æƒ…å†µè®¨è®ºæ—¶ï¼Œè¾¹ç•Œæ¡ä»¶æ˜¯å®¹æ˜“å‡ºé”™çš„åœ°æ–¹ï¼Œå»ºè®®ç”¨å°ä¾‹å­ï¼ˆå¦‚`n=1`ã€`k=0`ï¼‰æµ‹è¯•è½¬ç§»æ–¹ç¨‹ã€‚  
- **æ¥è‡ª2021hychçš„ç»éªŒ**ï¼šâ€œé«˜ç²¾åº¦è®¡ç®—æ—¶ï¼Œå‹ä½èƒ½æé«˜æ•ˆç‡ï¼Œé¿å…ä¸å¿…è¦çš„å¾ªç¯ã€‚â€  
  * **ç‚¹è¯„**ï¼šå‹ä½æ˜¯é«˜ç²¾åº¦è®¡ç®—çš„ä¼˜åŒ–æŠ€å·§ï¼Œå»ºè®®é€‰æ‹©åˆé€‚çš„åŸºæ•°ï¼ˆå¦‚`1e8`æˆ–`1e9`ï¼‰ï¼Œå‡å°‘æ•°ç»„çš„ä½æ•°ã€‚  


## ç»“è¯­  
æœ¬æ¬¡å…³äºâ€œ[SHOI2009]èˆä¼šâ€çš„C++è§£é¢˜åˆ†æå°±åˆ°è¿™é‡Œã€‚å¸Œæœ›è¿™ä»½å­¦ä¹ æŒ‡å—èƒ½å¸®åŠ©å¤§å®¶æ›´å¥½åœ°ç†è§£åŠ¨æ€è§„åˆ’ã€å®¹æ–¥åŸç†å’Œé«˜ç²¾åº¦è®¡ç®—çš„åº”ç”¨ã€‚è®°ä½ï¼Œç¼–ç¨‹èƒ½åŠ›çš„æå‡åœ¨äºæŒç»­å­¦ä¹ ã€å‹¤äºæ€è€ƒå’Œå‹‡äºå®è·µã€‚ä¸‹æ¬¡æˆ‘ä»¬å†ä¸€èµ·æ¢ç´¢æ–°çš„ç¼–ç¨‹æŒ‘æˆ˜ï¼ğŸ’ª

---
å¤„ç†ç”¨æ—¶ï¼š250.61ç§’
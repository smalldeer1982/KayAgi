# é¢˜ç›®ä¿¡æ¯

# [HNOI2001] æ£‹ç›˜å˜æ¢

## é¢˜ç›®æè¿°

ä¸€ä¸ª $n\times n$ çš„æ£‹ç›˜ï¼Œåœ¨å…¶ä¸­å¡«å…¥ $1$ å’Œ $-1$ã€‚ç»è¿‡ä¸€æ¬¡å˜æ¢åï¼Œæ–¹æ ¼é‡Œçš„æ¯ä¸ªæ•°å°†ä¼šå˜æˆå˜æ¢ä¹‹å‰ä¸ä¹‹ç›¸é‚»çš„å››ä¸ªæ•°çš„ç§¯ã€‚ä¾‹å¦‚ï¼š

![](https://cdn.luogu.com.cn/upload/image_hosting/2q4jbad8.png)

ä½†æœ‰ä¸€äº›çŠ¶æ€ï¼Œå˜æ¢å‰å’Œå˜æ¢åæ˜¯ä¸€æ ·çš„ï¼Œä¾‹å¦‚å…¨éƒ¨æ˜¯ $1$ çš„çŠ¶æ€ã€‚è¿™ç§çŠ¶æ€è¢«ç§°ä¸ºä¸å˜çŠ¶æ€ã€‚

ä½ çš„ä»»åŠ¡æ˜¯è¦æ‰¾åˆ°æ‰€æœ‰æœ¬è´¨ä¸åŒçš„ä¸å˜çŠ¶æ€ï¼ˆæ—‹è½¬æˆ–ç¿»è½¬ä¹‹åçš„çŠ¶æ€è¢«è§†ä¸ºæ˜¯æœ¬è´¨ä¸Šç›¸åŒçš„ï¼‰ã€‚

## è¯´æ˜/æç¤º

$1\le n\le 30$ã€‚

é¢˜ç›®ç»™å‡ºèŒƒå›´å†…ï¼Œä¸å˜çŠ¶æ€æ€»æ•° $<9\times 10^3$ã€‚

## æ ·ä¾‹ #1

### è¾“å…¥

```
4```

### è¾“å‡º

```
5```

# AIåˆ†æç»“æœ

# ğŸ’¡ Kayçš„C++ç®—æ³•è§£æï¼š[HNOI2001]æ£‹ç›˜å˜æ¢ æ·±å…¥å­¦ä¹ æŒ‡å— ğŸ’¡


## 1. é¢˜ç›®è§£è¯»ä¸æ ¸å¿ƒç®—æ³•è¯†åˆ«

âœ¨ **æœ¬é¢˜ä¸»è¦è€ƒå¯Ÿ**ï¼šé«˜æ–¯æ¶ˆå…ƒï¼ˆå¼‚æˆ–æ–¹ç¨‹ç»„æ±‚è§£ï¼‰ã€Burnsideå¼•ç†ï¼ˆç»„åˆè®¡æ•°ï¼‰


ğŸ—£ï¸ **åˆæ­¥åˆ†æ**ï¼š  
è§£å†³â€œæ£‹ç›˜å˜æ¢â€é—®é¢˜ï¼Œéœ€è¦è§£å†³ä¸¤ä¸ªæ ¸å¿ƒé—®é¢˜ï¼š  
1. **æ‰¾åˆ°æ‰€æœ‰ä¸å˜çŠ¶æ€**ï¼šä¸å˜çŠ¶æ€è¦æ±‚æ¯ä¸ªæ ¼å­çš„å€¼ç­‰äºç›¸é‚»å››ä¸ªæ ¼å­çš„ä¹˜ç§¯ã€‚å°†`1`è§†ä¸º`0`ã€`-1`è§†ä¸º`1`ï¼Œä¹˜ç§¯è½¬åŒ–ä¸ºå¼‚æˆ–ï¼ˆå› ä¸º`(-1)^a * (-1)^b = (-1)^(aâŠ•b)`ï¼‰ï¼Œå› æ­¤æ¯ä¸ªæ ¼å­çš„çº¦æŸä¸ºï¼š`x[i][j] = x[i-1][j] âŠ• x[i+1][j] âŠ• x[i][j-1] âŠ• x[i][j+1]`ï¼ˆè¾¹ç•Œå¤–çš„æ ¼å­å¿½ç•¥ï¼‰ã€‚è¿™æ˜¯ä¸€ä¸ª**å¼‚æˆ–æ–¹ç¨‹ç»„**ï¼Œéœ€è¦ç”¨**é«˜æ–¯æ¶ˆå…ƒ**æ±‚è§£ã€‚  
2. **è®¡ç®—æœ¬è´¨ä¸åŒçš„çŠ¶æ€æ•°**ï¼šæ—‹è½¬æˆ–ç¿»è½¬åçš„çŠ¶æ€è§†ä¸ºåŒä¸€ç±»ï¼Œéœ€è¦ç”¨**Burnsideå¼•ç†**ï¼ˆç¾¤ä½œç”¨ä¸‹çš„ä¸åŠ¨ç‚¹è®¡æ•°ï¼‰ã€‚Burnsideå¼•ç†çš„æ ¸å¿ƒæ˜¯â€œå¹³å‡æ¯ä¸ªç½®æ¢çš„ä¸åŠ¨ç‚¹æ•°â€ï¼Œå³éå†æ‰€æœ‰æ—‹è½¬/ç¿»è½¬ç½®æ¢ï¼Œè®¡ç®—æ¯ä¸ªç½®æ¢ä¸‹çš„ä¸å˜çŠ¶æ€æ•°ï¼Œæœ€åå–å¹³å‡ã€‚  

**æ ¸å¿ƒéš¾ç‚¹**ï¼š  
- å¦‚ä½•å°†ç½®æ¢ï¼ˆå¦‚æ—‹è½¬ï¼‰çš„â€œä¸åŠ¨ç‚¹â€è½¬åŒ–ä¸ºæ–¹ç¨‹ç»„çš„çº¦æŸï¼Ÿï¼ˆä¾‹å¦‚ï¼Œæ—‹è½¬åç›¸åŒçš„æ ¼å­å¿…é¡»å–ç›¸åŒå€¼ï¼Œéœ€å°†è¿™äº›å˜é‡åˆå¹¶ä¸ºä¸€ä¸ªï¼‰ã€‚  
- å¦‚ä½•é«˜æ•ˆæ±‚è§£å¤§è§„æ¨¡å¼‚æˆ–æ–¹ç¨‹ç»„ï¼Ÿï¼ˆç”¨`bitset`ä¼˜åŒ–é«˜æ–¯æ¶ˆå…ƒï¼Œå°†å¤æ‚åº¦ä»`O(n^6)`é™è‡³`O(n^6/w)`ï¼Œ`w`ä¸ºæœºå™¨å­—é•¿ï¼‰ã€‚  

**å¯è§†åŒ–è®¾è®¡æ€è·¯**ï¼š  
- ç”¨8ä½åƒç´ é£æ ¼å±•ç¤ºæ£‹ç›˜çŠ¶æ€ï¼Œä¸åŒé¢œè‰²è¡¨ç¤º`0`/`1`ã€‚  
- é«˜æ–¯æ¶ˆå…ƒè¿‡ç¨‹ï¼šç”¨â€œè¡Œäº¤æ¢â€â€œè¡Œå¼‚æˆ–â€åŠ¨ç”»å±•ç¤ºæ–¹ç¨‹ç»„çš„ç®€åŒ–ï¼Œé«˜äº®å½“å‰å¤„ç†çš„è¡Œå’Œåˆ—ã€‚  
- Burnsideå¼•ç†ï¼šç”¨â€œæ—‹è½¬/ç¿»è½¬â€åŠ¨ç”»å±•ç¤ºç½®æ¢å¯¹æ£‹ç›˜çš„å½±å“ï¼Œæ ‡è®°ç­‰ä»·ç±»ï¼ˆç›¸åŒé¢œè‰²è¡¨ç¤ºåŒä¸€ç±»ï¼‰ï¼Œå¹¶æ˜¾ç¤ºæ¯ä¸ªç½®æ¢ä¸‹çš„ä¸åŠ¨ç‚¹è®¡æ•°ã€‚  
- äº¤äº’ï¼šæ”¯æŒâ€œå•æ­¥æ‰§è¡Œâ€ï¼ˆé€è¡Œæ¶ˆå…ƒã€é€æ¬¡ç½®æ¢ï¼‰ã€â€œè‡ªåŠ¨æ’­æ”¾â€ï¼ˆè°ƒæ•´é€Ÿåº¦ï¼‰ï¼Œå…³é”®æ“ä½œï¼ˆå¦‚åˆå¹¶å˜é‡ã€æ‰¾åˆ°è§£ï¼‰æ’­æ”¾â€œå®â€çš„éŸ³æ•ˆã€‚  


## 2. ç²¾é€‰ä¼˜è´¨é¢˜è§£å‚è€ƒ

### é¢˜è§£ä¸€ï¼šæ¥æºï¼šLJC00118ï¼ˆèµï¼š24ï¼‰  
* **ç‚¹è¯„**ï¼š  
  è¿™ä»½é¢˜è§£æ˜¯**æ­£è§£çš„å…¸èŒƒ**ï¼Œå®Œç¾ç»“åˆäº†é«˜æ–¯æ¶ˆå…ƒå’ŒBurnsideå¼•ç†ã€‚æ€è·¯æ¸…æ™°ï¼šé¦–å…ˆå°†é—®é¢˜è½¬åŒ–ä¸ºå¼‚æˆ–æ–¹ç¨‹ç»„ï¼Œç”¨`bitset`ä¼˜åŒ–é«˜æ–¯æ¶ˆå…ƒæ±‚è§£è‡ªç”±å…ƒï¼›ç„¶åç”¨BFSéå†æ‰€æœ‰æ—‹è½¬/ç¿»è½¬ç½®æ¢ï¼Œå°†æ¯ä¸ªç½®æ¢çš„ç­‰ä»·ç±»åˆå¹¶ï¼Œé‡æ–°å»ºç«‹æ–¹ç¨‹ç»„æ±‚è§£ä¸åŠ¨ç‚¹ï¼Œæœ€åç”¨Burnsideå¼•ç†è®¡ç®—æœ¬è´¨ä¸åŒçš„æ–¹æ¡ˆæ•°ã€‚  
  ä»£ç è§„èŒƒï¼šå˜é‡å‘½åï¼ˆå¦‚`mat`è¡¨ç¤ºæ–¹ç¨‹ç»„çŸ©é˜µã€`go`è¡¨ç¤ºç½®æ¢æ˜ å°„ï¼‰æ¸…æ™°ï¼Œ`gauss`å‡½æ•°å°è£…äº†é«˜æ–¯æ¶ˆå…ƒé€»è¾‘ï¼Œå¯è¯»æ€§é«˜ã€‚  
  ç®—æ³•æœ‰æ•ˆæ€§ï¼š`bitset`ä¼˜åŒ–ä½¿é«˜æ–¯æ¶ˆå…ƒçš„æ•ˆç‡å¤§å¹…æå‡ï¼Œå³ä½¿`n=30`ä¹Ÿèƒ½å¿«é€Ÿè¿è¡Œã€‚  
  å®è·µä»·å€¼ï¼šä»£ç å¯ç›´æ¥ç”¨äºç«èµ›ï¼Œè¾¹ç•Œå¤„ç†ï¼ˆå¦‚è¾¹ç•Œæ ¼å­çš„ç›¸é‚»åˆ¤æ–­ï¼‰ä¸¥è°¨ï¼Œæ˜¯å­¦ä¹ â€œç»„åˆè®¡æ•°+çº¿æ€§ä»£æ•°â€çš„ç»å…¸æ¡ˆä¾‹ã€‚  


### é¢˜è§£äºŒï¼šæ¥æºï¼šå›§ä»™ï¼ˆèµï¼š1ï¼‰  
* **ç‚¹è¯„**ï¼š  
  è¿™ä»½é¢˜è§£æ˜¯**æ‰“è¡¨ç­–ç•¥çš„ä¼˜åŒ–ç‰ˆ**ï¼Œé€‚åˆæ¯”èµ›ä¸­çš„â€œæš´åŠ›ä½†é«˜æ•ˆâ€åœºæ™¯ã€‚æ€è·¯å·§å¦™ï¼šåˆ©ç”¨â€œç¬¬ä¸€è¡Œç¡®å®šåï¼Œåç»­è¡Œå¯å”¯ä¸€æ¨å¯¼â€çš„æ€§è´¨ï¼Œç”¨çŠ¶å‹DPï¼ˆå°†æ¯è¡Œå‹ç¼©ä¸ºäºŒè¿›åˆ¶æ•°ï¼‰å¿«é€Ÿæ¨å¯¼æ•´ä¸ªæ£‹ç›˜ï¼Œç„¶åç”¨å“ˆå¸Œè¡¨å»é‡æ‰€æœ‰å˜æ¢åçš„çŠ¶æ€ã€‚  
  ä»£ç ç®€æ´ï¼š`swp`å‡½æ•°å¤„ç†è¡Œçš„ç¿»è½¬ï¼Œ`Hash` namespaceå°è£…äº†å“ˆå¸Œè¡¨æ“ä½œï¼Œé€»è¾‘æ¸…æ™°ã€‚  
  ç®—æ³•æœ‰æ•ˆæ€§ï¼šçŠ¶å‹DPçš„å¤æ‚åº¦ä¸º`O(2^n * n)`ï¼Œæ¯”ç›´æ¥æšä¸¾æ‰€æœ‰çŠ¶æ€ï¼ˆ`O(2^{nÂ²})`ï¼‰é«˜æ•ˆå¾—å¤šï¼Œ`n=30`æ—¶åªéœ€ä¸€åˆ†é’Ÿå³å¯å®Œæˆæ‰“è¡¨ã€‚  
  å®è·µä»·å€¼ï¼šå¯¹äºè¾“å…¥è§„æ¨¡å°ï¼ˆå¦‚`nâ‰¤30`ï¼‰ä¸”è¾“å‡ºå”¯ä¸€çš„é¢˜ç›®ï¼Œæ‰“è¡¨æ˜¯â€œå·æ‡’ä½†æœ‰æ•ˆçš„â€ç­–ç•¥ï¼Œå€¼å¾—å­¦ä¹ ã€‚  


## 3. æ ¸å¿ƒéš¾ç‚¹è¾¨æä¸è§£é¢˜ç­–ç•¥

### 1. å…³é”®ç‚¹1ï¼šå¼‚æˆ–æ–¹ç¨‹ç»„çš„å»ºç«‹ä¸æ±‚è§£  
* **åˆ†æ**ï¼š  
  æ¯ä¸ªæ ¼å­`(i,j)`çš„çº¦æŸæ˜¯`x[i][j] = ç›¸é‚»å››ä¸ªæ ¼å­çš„å¼‚æˆ–å’Œ`ï¼Œè½¬åŒ–ä¸ºæ–¹ç¨‹ï¼š`x[i][j] âŠ• x[i-1][j] âŠ• x[i+1][j] âŠ• x[i][j-1] âŠ• x[i][j+1] = 0`ï¼ˆè¾¹ç•Œå¤–çš„é¡¹å¿½ç•¥ï¼‰ã€‚é«˜æ–¯æ¶ˆå…ƒæ±‚è§£å¼‚æˆ–æ–¹ç¨‹ç»„çš„æ ¸å¿ƒæ˜¯**è¡Œå˜æ¢**ï¼šæ‰¾åˆ°ä¸»å…ƒï¼ˆå½“å‰åˆ—çš„ç¬¬ä¸€ä¸ª1ï¼‰ï¼Œç”¨ä¸»å…ƒè¡Œæ¶ˆå»å…¶ä»–è¡Œçš„å½“å‰åˆ—ã€‚  
* ğŸ’¡ **å­¦ä¹ ç¬”è®°**ï¼šå¼‚æˆ–æ–¹ç¨‹ç»„çš„è§£æ•°æ˜¯`2^è‡ªç”±å…ƒä¸ªæ•°`ï¼Œè‡ªç”±å…ƒæ˜¯æ— æ³•è¢«ä¸»å…ƒçº¦æŸçš„å˜é‡ã€‚  


### 2. å…³é”®ç‚¹2ï¼šBurnsideå¼•ç†çš„åº”ç”¨ï¼ˆç½®æ¢çš„ä¸åŠ¨ç‚¹ï¼‰  
* **åˆ†æ**ï¼š  
  æ—‹è½¬/ç¿»è½¬ç½®æ¢ç¾¤çš„å¤§å°ä¸º`8`ï¼ˆ4ç§æ—‹è½¬+4ç§ç¿»è½¬ï¼‰ã€‚å¯¹äºæ¯ä¸ªç½®æ¢ï¼Œéœ€è¦æ‰¾åˆ°â€œä¸åŠ¨ç‚¹â€ï¼ˆå³ç½®æ¢åä¸åŸçŠ¶æ€ç›¸åŒçš„çŠ¶æ€ï¼‰ã€‚ä¸åŠ¨ç‚¹çš„æ¡ä»¶æ˜¯ï¼š**ç½®æ¢ç­‰ä»·ç±»ä¸­çš„æ‰€æœ‰æ ¼å­å¿…é¡»å–ç›¸åŒå€¼**ã€‚ä¾‹å¦‚ï¼Œæ—‹è½¬90åº¦åï¼Œ`(1,1)`ä¼šè½¬åˆ°`(1,n)`ï¼Œå› æ­¤`x[1][1] = x[1][n]`ã€‚  
* ğŸ’¡ **å­¦ä¹ ç¬”è®°**ï¼šBurnsideå¼•ç†çš„å…¬å¼æ˜¯`(f1 + f2 + ... + fk)/k`ï¼Œå…¶ä¸­`fk`æ˜¯ç¬¬`k`ä¸ªç½®æ¢çš„ä¸åŠ¨ç‚¹æ•°ï¼Œ`k`æ˜¯ç½®æ¢ç¾¤çš„å¤§å°ã€‚  


### 3. å…³é”®ç‚¹3ï¼šé«˜æ•ˆå¤„ç†ç½®æ¢çš„ç­‰ä»·ç±»  
* **åˆ†æ**ï¼š  
  ç”¨BFSéå†æ‰€æœ‰ç½®æ¢ï¼ˆæ—‹è½¬ã€ç¿»è½¬ï¼‰ï¼Œæ ‡è®°æ¯ä¸ªæ ¼å­çš„ç­‰ä»·ç±»ï¼ˆå³ç½®æ¢åä¼šåˆ°è¾¾çš„æ‰€æœ‰æ ¼å­ï¼‰ã€‚ä¾‹å¦‚ï¼Œ`(1,1)`ç»è¿‡æ—‹è½¬ä¼šåˆ°è¾¾`(1,n)`ã€`(n,n)`ã€`(n,1)`ï¼Œè¿™äº›æ ¼å­å±äºåŒä¸€ç­‰ä»·ç±»ï¼Œå˜é‡éœ€åˆå¹¶ä¸ºä¸€ä¸ªã€‚  
* ğŸ’¡ **å­¦ä¹ ç¬”è®°**ï¼šç­‰ä»·ç±»åˆå¹¶åï¼Œæ–¹ç¨‹ç»„çš„å˜é‡æ•°å‡å°‘ï¼Œæ±‚è§£æ•ˆç‡æå‡ã€‚  


### âœ¨ è§£é¢˜æŠ€å·§æ€»ç»“  
- **é—®é¢˜è½¬åŒ–**ï¼šå°†ä¹˜ç§¯è½¬åŒ–ä¸ºå¼‚æˆ–ï¼Œå°†å¤æ‚çš„çº¦æŸè½¬åŒ–ä¸ºçº¿æ€§æ–¹ç¨‹ç»„ã€‚  
- **ç®—æ³•é€‰æ‹©**ï¼šé«˜æ–¯æ¶ˆå…ƒè§£å†³çº¿æ€§æ–¹ç¨‹ç»„ï¼ŒBurnsideå¼•ç†è§£å†³ç»„åˆè®¡æ•°é—®é¢˜ã€‚  
- **ä¼˜åŒ–æŠ€å·§**ï¼šç”¨`bitset`ä¼˜åŒ–é«˜æ–¯æ¶ˆå…ƒï¼Œç”¨çŠ¶å‹DPä¼˜åŒ–æ‰“è¡¨ã€‚  


## 4. C++æ ¸å¿ƒä»£ç å®ç°èµæ

### æœ¬é¢˜é€šç”¨æ ¸å¿ƒC++å®ç°å‚è€ƒï¼ˆç»¼åˆé¢˜è§£ä¸€æ€è·¯ï¼‰  
* **è¯´æ˜**ï¼šæœ¬ä»£ç å±•ç¤ºäº†é«˜æ–¯æ¶ˆå…ƒ+Burnsideå¼•ç†çš„æ ¸å¿ƒé€»è¾‘ï¼Œé€‚ç”¨äºæ±‚è§£æœ¬è´¨ä¸åŒçš„ä¸å˜çŠ¶æ€æ•°ã€‚  
* **å®Œæ•´æ ¸å¿ƒä»£ç **ï¼š  
  ```cpp
  #include <iostream>
  #include <vector>
  #include <bitset>
  #include <queue>
  #include <set>
  using namespace std;

  const int N = 35;
  bitset<N*N> mat[N*N]; // æ–¹ç¨‹ç»„çŸ©é˜µ
  int go[N*N], used[N*N], id[N*N]; // ç½®æ¢æ˜ å°„ã€ç­‰ä»·ç±»æ ‡è®°ã€ç­‰ä»·ç±»ID
  int n, tot, ans; // tot: ç­‰ä»·ç±»æ•°é‡ï¼Œans: Burnsideæ±‚å’Œç»“æœ

  // é«˜æ–¯æ¶ˆå…ƒæ±‚è§£å¼‚æˆ–æ–¹ç¨‹ç»„ï¼Œè¿”å›è§£æ•°ï¼ˆ2^è‡ªç”±å…ƒä¸ªæ•°ï¼‰
  int gauss(int n, int m) {
      int res = 1;
      for (int i = 1; i <= m; i++) {
          int pivot = 0;
          for (int j = i; j <= n; j++) {
              if (mat[j][i]) { pivot = j; break; }
          }
          if (!pivot) { res <<= 1; continue; } // è‡ªç”±å…ƒï¼Œè§£æ•°ä¹˜2
          swap(mat[i], mat[pivot]);
          for (int j = i+1; j <= n; j++) {
              if (mat[j][i]) mat[j] ^= mat[i];
          }
      }
      return res;
  }

  // æ—‹è½¬ç½®æ¢ï¼šå°†çŸ©é˜µaæ—‹è½¬90åº¦
  struct Matrix { int a[N][N]; };
  Matrix rotate(Matrix a) {
      Matrix res;
      for (int i = 1; i <= n; i++) {
          for (int j = 1; j <= n; j++) {
              res.a[j][n-i+1] = a.a[i][j];
          }
      }
      return res;
  }

  // ç¿»è½¬ç½®æ¢ï¼šå°†çŸ©é˜µaä¸Šä¸‹ç¿»è½¬
  Matrix flip(Matrix a) {
      Matrix res;
      for (int i = 1; i <= n; i++) {
          for (int j = 1; j <= n; j++) {
              res.a[n-i+1][j] = a.a[i][j];
          }
      }
      return res;
  }

  int main() {
      cin >> n;
      Matrix init;
      for (int i = 1; i <= n; i++) {
          for (int j = 1; j <= n; j++) {
              init.a[i][j] = (i-1)*n + j; // åˆå§‹åŒ–æ¯ä¸ªæ ¼å­çš„ç¼–å·
          }
      }
      set<Matrix> states;
      queue<Matrix> q;
      states.insert(init); q.push(init);
      // BFSéå†æ‰€æœ‰æ—‹è½¬/ç¿»è½¬ç½®æ¢
      while (!q.empty()) {
          Matrix u = q.front(); q.pop();
          Matrix v = rotate(u);
          if (!states.count(v)) { states.insert(v); q.push(v); }
          v = flip(u);
          if (!states.count(v)) { states.insert(v); q.push(v); }
      }
      // éå†æ¯ä¸ªç½®æ¢ï¼Œè®¡ç®—ä¸åŠ¨ç‚¹
      for (auto& u : states) {
          // å»ºç«‹ç½®æ¢æ˜ å°„ï¼šgo[old] = newï¼ˆnewæ˜¯åŸçŸ©é˜µçš„ç¼–å·ï¼‰
          for (int i = 1; i <= n; i++) {
              for (int j = 1; j <= n; j++) {
                  go[u.a[i][j]] = (i-1)*n + j;
              }
          }
          // æ ‡è®°ç­‰ä»·ç±»
          memset(used, 0, sizeof(used)); tot = 0;
          for (int i = 1; i <= n*n; i++) {
              if (!used[i]) {
                  tot++;
                  int now = i;
                  while (!used[now]) {
                      used[now] = 1;
                      id[now] = tot;
                      now = go[now];
                  }
              }
          }
          // å»ºç«‹æ–¹ç¨‹ç»„ï¼šæ¯ä¸ªæ ¼å­çš„çº¦æŸ
          for (int i = 1; i <= n; i++) {
              for (int j = 1; j <= n; j++) {
                  int now = (i-1)*n + j;
                  mat[now].reset();
                  mat[now][id[now]] = 1; // x[now]çš„ç³»æ•°
                  // ç›¸é‚»å››ä¸ªæ ¼å­çš„çº¦æŸ
                  int dx[] = {1, -1, 0, 0};
                  int dy[] = {0, 0, 1, -1};
                  for (int k = 0; k < 4; k++) {
                      int x = i + dx[k], y = j + dy[k];
                      if (x < 1 || y < 1 || x > n || y > n) continue;
                      int v = (x-1)*n + y;
                      mat[now][id[v]] = 1 - mat[now][id[v]]; // å¼‚æˆ–ç­‰ä»·äºåŠ 1æ¨¡2
                  }
              }
          }
          // æ±‚è§£æ–¹ç¨‹ç»„ï¼Œç´¯åŠ ä¸åŠ¨ç‚¹
          ans += gauss(n*n, tot);
      }
      // Burnsideå¼•ç†ï¼šå¹³å‡ä¸åŠ¨ç‚¹æ•°
      ans /= states.size();
      cout << ans << endl;
      return 0;
  }
  ```  
* **ä»£ç è§£è¯»æ¦‚è¦**ï¼š  
  1. **åˆå§‹åŒ–ç½®æ¢**ï¼šç”¨BFSéå†æ‰€æœ‰æ—‹è½¬/ç¿»è½¬ç½®æ¢ï¼Œå­˜å‚¨åœ¨`states`é›†åˆä¸­ã€‚  
  2. **å¤„ç†æ¯ä¸ªç½®æ¢**ï¼šå»ºç«‹ç½®æ¢æ˜ å°„`go`ï¼Œæ ‡è®°ç­‰ä»·ç±»`id`ï¼ˆåŒä¸€ç­‰ä»·ç±»çš„å˜é‡åˆå¹¶ï¼‰ã€‚  
  3. **å»ºç«‹æ–¹ç¨‹ç»„**ï¼šæ¯ä¸ªæ ¼å­çš„çº¦æŸè½¬åŒ–ä¸ºæ–¹ç¨‹ï¼Œ`mat`çŸ©é˜µå­˜å‚¨æ–¹ç¨‹ç»„ã€‚  
  4. **é«˜æ–¯æ¶ˆå…ƒ**ï¼šæ±‚è§£æ–¹ç¨‹ç»„çš„è§£æ•°ï¼ˆä¸åŠ¨ç‚¹ï¼‰ï¼Œç´¯åŠ è‡³`ans`ã€‚  
  5. **Burnsideå¼•ç†**ï¼š`ans`é™¤ä»¥ç½®æ¢ç¾¤å¤§å°ï¼Œå¾—åˆ°æœ¬è´¨ä¸åŒçš„æ–¹æ¡ˆæ•°ã€‚  


### é¢˜è§£ä¸€ç‰‡æ®µèµæï¼ˆé«˜æ–¯æ¶ˆå…ƒï¼‰  
* **äº®ç‚¹**ï¼šç”¨`bitset`ä¼˜åŒ–å¼‚æˆ–æ–¹ç¨‹ç»„çš„è¡Œå˜æ¢ï¼Œæ•ˆç‡å¤§å¹…æå‡ã€‚  
* **æ ¸å¿ƒä»£ç ç‰‡æ®µ**ï¼š  
  ```cpp
  int gauss(int n, int m) {
      int res = 1;
      for (int i = 1; i <= m; i++) {
          int pivot = 0;
          for (int j = i; j <= n; j++) {
              if (mat[j][i]) { pivot = j; break; }
          }
          if (!pivot) { res <<= 1; continue; } // è‡ªç”±å…ƒï¼Œè§£æ•°ä¹˜2
          swap(mat[i], mat[pivot]);
          for (int j = i+1; j <= n; j++) {
              if (mat[j][i]) mat[j] ^= mat[i]; // è¡Œå¼‚æˆ–ï¼Œæ¶ˆå»å½“å‰åˆ—
          }
      }
      return res;
  }
  ```  
* **ä»£ç è§£è¯»**ï¼š  
  - `pivot`ï¼šå½“å‰åˆ—çš„ä¸»å…ƒè¡Œï¼ˆç¬¬ä¸€ä¸ªæœ‰1çš„è¡Œï¼‰ã€‚  
  - è‹¥æ²¡æœ‰ä¸»å…ƒï¼Œè¯´æ˜å½“å‰å˜é‡æ˜¯**è‡ªç”±å…ƒ**ï¼Œè§£æ•°ä¹˜2ï¼ˆå› ä¸ºè‡ªç”±å…ƒå¯ä»¥å–0æˆ–1ï¼‰ã€‚  
  - äº¤æ¢ä¸»å…ƒè¡Œåˆ°å½“å‰è¡Œï¼Œç”¨ä¸»å…ƒè¡Œæ¶ˆå»å…¶ä»–è¡Œçš„å½“å‰åˆ—ï¼ˆå¼‚æˆ–æ“ä½œï¼‰ã€‚  
* ğŸ’¡ **å­¦ä¹ ç¬”è®°**ï¼š`bitset`çš„`^=`æ“ä½œå¯ä»¥å¿«é€Ÿå¤„ç†è¡Œå¼‚æˆ–ï¼Œæ¯”æ™®é€šæ•°ç»„å¿«å¾—å¤šã€‚  


### é¢˜è§£äºŒç‰‡æ®µèµæï¼ˆçŠ¶å‹DPæ¨å¯¼è¡Œï¼‰  
* **äº®ç‚¹**ï¼šç”¨çŠ¶å‹DPå¿«é€Ÿæ¨å¯¼åç»­è¡Œï¼Œé¿å…æšä¸¾æ‰€æœ‰çŠ¶æ€ã€‚  
* **æ ¸å¿ƒä»£ç ç‰‡æ®µ**ï¼š  
  ```cpp
  up(0,(1<<n)-1,i){ // æšä¸¾ç¬¬ä¸€è¡Œiï¼ˆçŠ¶å‹ï¼‰
      u32 x=i,y=0,p=x&1,q=x>>n-1,l=x,ll=0;
      up(1,n-1,j){ // æ¨å¯¼ç¬¬2åˆ°ç¬¬nè¡Œ
          x=((x<<1)^(x>>1)^x^ll)&((1<<n)-1); // çŠ¶æ€è½¬ç§»ï¼šx[i] = x[i-1]å·¦ç§»âŠ•å³ç§»âŠ•è‡ªèº«âŠ•x[i-2]
          ll=l,l=x;
          p|=(x&1)<<j; // è®°å½•ç¬¬ä¸€åˆ—
          q|=(x>>n-1)<<j; // è®°å½•æœ€åä¸€åˆ—
      }
      // åˆ¤æ–­æœ€åä¸€è¡Œæ˜¯å¦åˆæ³•ï¼ˆx[n+1]æ˜¯å¦å…¨0ï¼‰
      if(!(((x<<1)^(x>>1)^x^ll)&((1<<n)-1))){
          ++ans;
          // å°†æ‰€æœ‰å˜æ¢åçš„çŠ¶æ€æ’å…¥å“ˆå¸Œè¡¨ï¼ˆå»é‡ï¼‰
          Hash::add(i),Hash::add(x),Hash::add(swp(i)),Hash::add(swp(x));
          Hash::add(p),Hash::add(q),Hash::add(swp(p)),Hash::add(swp(q));
      }
  }
  ```  
* **ä»£ç è§£è¯»**ï¼š  
  - `i`ï¼šç¬¬ä¸€è¡Œçš„çŠ¶å‹è¡¨ç¤ºï¼ˆäºŒè¿›åˆ¶ä½ä»£è¡¨æ¯ä¸ªæ ¼å­çš„å€¼ï¼‰ã€‚  
  - `x`ï¼šå½“å‰è¡Œçš„çŠ¶å‹è¡¨ç¤ºï¼Œé€šè¿‡å‰ä¸€è¡Œ`x`å’Œå‰å‰ä¸€è¡Œ`ll`æ¨å¯¼ã€‚  
  - çŠ¶æ€è½¬ç§»å…¬å¼ï¼š`x[i] = (x[i-1]å·¦ç§») âŠ• (x[i-1]å³ç§») âŠ• x[i-1] âŠ• x[i-2]`ï¼ˆå¯¹åº”å¼‚æˆ–çº¦æŸï¼‰ã€‚  
  - åˆ¤æ–­æœ€åä¸€è¡Œæ˜¯å¦åˆæ³•ï¼ˆ`x[n+1]`æ˜¯å¦å…¨0ï¼‰ï¼Œè‹¥æ˜¯åˆ™å°†æ‰€æœ‰å˜æ¢åçš„çŠ¶æ€æ’å…¥å“ˆå¸Œè¡¨ï¼ˆå»é‡ï¼‰ã€‚  
* ğŸ’¡ **å­¦ä¹ ç¬”è®°**ï¼šçŠ¶å‹DPæ˜¯å¤„ç†â€œè¡Œä¾èµ–â€é—®é¢˜çš„æœ‰æ•ˆæ–¹æ³•ï¼Œèƒ½å°†æŒ‡æ•°çº§å¤æ‚åº¦é™è‡³`O(2^n * n)`ã€‚  


## 5. ç®—æ³•å¯è§†åŒ–ï¼šåƒç´ åŠ¨ç”»æ¼”ç¤º (æ ¸å¿ƒéƒ¨åˆ†)

### åŠ¨ç”»æ¼”ç¤ºä¸»é¢˜  
**åƒç´ æ¢é™©å®¶ï¼šæ£‹ç›˜å˜æ¢çš„ç§˜å¯†**ï¼ˆä»¿FCçº¢ç™½æœºé£æ ¼ï¼‰  


### æ ¸å¿ƒæ¼”ç¤ºå†…å®¹  
1. **æ£‹ç›˜åˆå§‹åŒ–**ï¼šç”¨8ä½åƒç´ å—å±•ç¤º`nÃ—n`æ£‹ç›˜ï¼Œ`0`ä¸ºç™½è‰²ï¼Œ`1`ä¸ºé»‘è‰²ã€‚  
2. **é«˜æ–¯æ¶ˆå…ƒè¿‡ç¨‹**ï¼š  
   - ç”¨â€œè¡Œäº¤æ¢â€åŠ¨ç”»ï¼ˆåƒç´ è¡Œä¸Šä¸‹ç§»åŠ¨ï¼‰å±•ç¤ºä¸»å…ƒé€‰æ‹©ã€‚  
   - ç”¨â€œè¡Œå¼‚æˆ–â€åŠ¨ç”»ï¼ˆåƒç´ å—é—ªçƒï¼‰å±•ç¤ºæ¶ˆå…ƒè¿‡ç¨‹ï¼Œé«˜äº®å½“å‰å¤„ç†çš„åˆ—ã€‚  
   - è‡ªç”±å…ƒç”¨â€œé—®å·â€åƒç´ å—æ ‡è®°ï¼Œæ˜¾ç¤ºè§£æ•°è®¡ç®—ï¼ˆ`2^è‡ªç”±å…ƒ`ï¼‰ã€‚  
3. **Burnsideå¼•ç†åº”ç”¨**ï¼š  
   - ç”¨â€œæ—‹è½¬/ç¿»è½¬â€åŠ¨ç”»ï¼ˆæ£‹ç›˜æ—‹è½¬90åº¦ã€ä¸Šä¸‹ç¿»è½¬ï¼‰å±•ç¤ºç½®æ¢å¯¹æ£‹ç›˜çš„å½±å“ã€‚  
   - ç­‰ä»·ç±»ç”¨ç›¸åŒé¢œè‰²æ ‡è®°ï¼ˆå¦‚çº¢è‰²è¡¨ç¤ºåŒä¸€ç±»ï¼‰ï¼Œæ˜¾ç¤ºåˆå¹¶åçš„å˜é‡ã€‚  
4. **ä¸åŠ¨ç‚¹åˆ¤æ–­**ï¼š  
   - æ¨å¯¼åç»­è¡Œæ—¶ï¼Œç”¨â€œç®­å¤´â€åƒç´ å—å±•ç¤ºçŠ¶æ€è½¬ç§»ï¼ˆä»ç¬¬ä¸€è¡Œåˆ°ç¬¬äºŒè¡Œï¼‰ã€‚  
   - åˆæ³•çŠ¶æ€ç”¨â€œæ˜Ÿæ˜Ÿâ€åƒç´ å—æ ‡è®°ï¼Œæ˜¾ç¤ºæœ¬è´¨ä¸åŒçš„æ–¹æ¡ˆæ•°ã€‚  


### äº¤äº’ä¸æ¸¸æˆåŒ–å…ƒç´   
- **æ§åˆ¶é¢æ¿**ï¼šåŒ…å«â€œå¼€å§‹/æš‚åœâ€â€œå•æ­¥æ‰§è¡Œâ€â€œè‡ªåŠ¨æ’­æ”¾â€ï¼ˆé€Ÿåº¦æ»‘å—ï¼‰æŒ‰é’®ï¼Œä»¿FCæ¸¸æˆçš„åå­—é”®é£æ ¼ã€‚  
- **éŸ³æ•ˆ**ï¼š  
  - è¡Œäº¤æ¢ï¼šâ€œå’”å—’â€å£°ã€‚  
  - è¡Œå¼‚æˆ–ï¼šâ€œå®â€å£°ã€‚  
  - æ‰¾åˆ°ä¸åŠ¨ç‚¹ï¼šâ€œèƒœåˆ©â€éŸ³æ•ˆï¼ˆå¦‚ã€Šè¶…çº§é©¬é‡Œå¥¥ã€‹çš„é€šå…³å£°ï¼‰ã€‚  
- **æ¸¸æˆåŒ–å…³å¡**ï¼š  
  - å°†é«˜æ–¯æ¶ˆå…ƒåˆ†ä¸ºâ€œæ‰¾ä¸»å…ƒâ€â€œæ¶ˆå…ƒâ€â€œè®¡ç®—è§£æ•°â€ä¸‰ä¸ªå°å…³å¡ï¼Œå®Œæˆæ¯ä¸ªå…³å¡è·å¾—â€œåƒç´ æ˜Ÿæ˜Ÿâ€å¥–åŠ±ã€‚  
  - ç´¯è®¡æ˜Ÿæ˜Ÿæ•°å¯è§£é”â€œé«˜çº§ç½®æ¢â€ï¼ˆå¦‚æ—‹è½¬180åº¦ï¼‰çš„æ¼”ç¤ºã€‚  


### è®¾è®¡æ€è·¯  
- **åƒç´ é£æ ¼**ï¼šè¥é€ å¤å¤æ¸¸æˆæ°›å›´ï¼Œé™ä½å­¦ä¹ å‹åŠ›ã€‚  
- **åŠ¨ç”»ä¸éŸ³æ•ˆ**ï¼šå¼ºåŒ–å…³é”®æ“ä½œçš„è®°å¿†ï¼ˆå¦‚è¡Œå¼‚æˆ–çš„â€œå®â€å£°ï¼‰ã€‚  
- **æ¸¸æˆåŒ–å…³å¡**ï¼šé€šè¿‡â€œé—¯å…³â€æ¿€åŠ±å­¦ä¹ è€…å®Œæˆå¤æ‚çš„ç®—æ³•æ­¥éª¤ã€‚  


## 6. æ‹“å±•ç»ƒä¹ ä¸ç›¸ä¼¼é—®é¢˜æ€è€ƒ

### é€šç”¨æ€è·¯/æŠ€å·§è¿ç§»  
- **é«˜æ–¯æ¶ˆå…ƒ**ï¼šé€‚ç”¨äºæ±‚è§£çº¿æ€§æ–¹ç¨‹ç»„ï¼ˆå¦‚`P1829`  Crashçš„æ•°å­—è¡¨æ ¼ï¼‰ã€‚  
- **Burnsideå¼•ç†**ï¼šé€‚ç”¨äºå¤„ç†å¯¹ç§°æ€§é—®é¢˜ï¼ˆå¦‚`P4128` [SHOI2006]æœ‰è‰²å›¾ï¼‰ã€‚  
- **çŠ¶å‹DP**ï¼šé€‚ç”¨äºå¤„ç†â€œè¡Œä¾èµ–â€é—®é¢˜ï¼ˆå¦‚`P2579` [ZJOI2005]æ²¼æ³½é³„é±¼ï¼‰ã€‚  


### ç»ƒä¹ æ¨è (æ´›è°·)  
1. **æ´›è°· P1829** - Crashçš„æ•°å­—è¡¨æ ¼  
   ğŸ—£ï¸ **æ¨èç†ç”±**ï¼šè¿™é“é¢˜éœ€è¦ç”¨é«˜æ–¯æ¶ˆå…ƒæ±‚è§£çº¿æ€§æ–¹ç¨‹ç»„ï¼Œæ˜¯é«˜æ–¯æ¶ˆå…ƒçš„ç»å…¸åº”ç”¨ï¼Œèƒ½å¸®åŠ©ä½ å·©å›ºå¼‚æˆ–æ–¹ç¨‹ç»„çš„æ±‚è§£æŠ€å·§ã€‚  
2. **æ´›è°· P4128** - [SHOI2006]æœ‰è‰²å›¾  
   ğŸ—£ï¸ **æ¨èç†ç”±**ï¼šè¿™é“é¢˜éœ€è¦ç”¨Burnsideå¼•ç†è®¡ç®—æœ¬è´¨ä¸åŒçš„æœ‰è‰²å›¾æ•°é‡ï¼Œæ˜¯Burnsideå¼•ç†çš„è¿›é˜¶ç»ƒä¹ ï¼Œèƒ½å¸®åŠ©ä½ ç†è§£ç½®æ¢ç¾¤çš„åº”ç”¨ã€‚  
3. **æ´›è°· P2579** - [ZJOI2005]æ²¼æ³½é³„é±¼  
   ğŸ—£ï¸ **æ¨èç†ç”±**ï¼šè¿™é“é¢˜éœ€è¦ç”¨çŠ¶å‹DPå¤„ç†â€œè¡Œä¾èµ–â€é—®é¢˜ï¼Œæ˜¯çŠ¶å‹DPçš„ç»å…¸æ¡ˆä¾‹ï¼Œèƒ½å¸®åŠ©ä½ æŒæ¡çŠ¶æ€è½¬ç§»çš„æŠ€å·§ã€‚  


## 7. å­¦ä¹ å¿ƒå¾—ä¸ç»éªŒåˆ†äº« (è‹¥æœ‰)

### å‚è€ƒç»éªŒ (æ¥è‡ª LJC00118)  
> â€œæˆ‘åœ¨è§£å†³è¿™ä¸ªé—®é¢˜æ—¶ï¼Œæœ€åˆæ²¡æœ‰æƒ³åˆ°ç”¨`bitset`ä¼˜åŒ–é«˜æ–¯æ¶ˆå…ƒï¼Œå¯¼è‡´`n=10`æ—¶å°±è¶…æ—¶äº†ã€‚åæ¥æŸ¥é˜…èµ„æ–™å‘ç°ï¼Œ`bitset`çš„`^=`æ“ä½œå¯ä»¥å¿«é€Ÿå¤„ç†è¡Œå¼‚æˆ–ï¼Œå°†å¤æ‚åº¦é™ä½åˆ°`O(n^6/w)`ï¼Œè¿™æ‰é€šè¿‡äº†æ‰€æœ‰æµ‹è¯•ç‚¹ã€‚â€  

**ç‚¹è¯„**ï¼šè¿™ä½ä½œè€…çš„ç»éªŒå¾ˆå…¸å‹ã€‚åœ¨å¤„ç†å¤§è§„æ¨¡çº¿æ€§æ–¹ç¨‹ç»„æ—¶ï¼Œ**æ•°æ®ç»“æ„çš„é€‰æ‹©**ï¼ˆå¦‚`bitset`ï¼‰èƒ½å¤§å¹…æå‡æ•ˆç‡ã€‚é‡åˆ°è¶…æ—¶é—®é¢˜æ—¶ï¼Œä¸å¦¨æƒ³æƒ³â€œæœ‰æ²¡æœ‰æ›´é«˜æ•ˆçš„æ•°æ®ç»“æ„â€ã€‚  


## ç»“è¯­  
æœ¬æ¬¡å…³äºâ€œ[HNOI2001]æ£‹ç›˜å˜æ¢â€çš„C++è§£é¢˜åˆ†æå°±åˆ°è¿™é‡Œã€‚å¸Œæœ›è¿™ä»½å­¦ä¹ æŒ‡å—èƒ½å¸®åŠ©å¤§å®¶ç†è§£é«˜æ–¯æ¶ˆå…ƒã€Burnsideå¼•ç†ç­‰ç®—æ³•ï¼ŒæŒæ¡â€œç»„åˆè®¡æ•°+çº¿æ€§ä»£æ•°â€çš„è§£é¢˜æ€è·¯ã€‚è®°ä½ï¼Œç¼–ç¨‹èƒ½åŠ›çš„æå‡åœ¨äº**æŒç»­å­¦ä¹ ã€å‹¤äºæ€è€ƒã€å‹‡äºå®è·µ**ã€‚ä¸‹æ¬¡æˆ‘ä»¬å†ä¸€èµ·æ¢ç´¢æ–°çš„ç¼–ç¨‹æŒ‘æˆ˜ï¼ğŸ’ª

---
å¤„ç†ç”¨æ—¶ï¼š207.00ç§’
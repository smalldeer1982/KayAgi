# é¢˜ç›®ä¿¡æ¯

# [POI 2014] ZAL-Freight

## é¢˜ç›®æè¿°

The train stations in Upper Bytown and Lower Bytown are connected with a single track rail link.

It takes the train $s$ minutes to travel between them in either direction.

However, the trains departing a station have to be spaced at least one minute apart.

Moreover, at all times, all the trains on the rail link have to go in the same direction.

According to the timetable at our disposal, $n$ cargo trains destined for Lower Bytown are to pass  through the Upper Bytown.  They are to be loaded with goods in Lower Bytown and then return to  Upper Bytown.  For simplicity, we assume that loading the goods on the train takes virtually no time.

We are to determine the minimum possible time of the last train returning to Upper Bytown.

æœ‰ä¸¤ä¸ªåŸé•‡ï¼Œä»Aåˆ°Béœ€è¦çš„æ—¶é—´ä¸ºSï¼Œç„¶åæœ‰Nè¾†åˆ—è½¦éœ€è¦ä»Aåˆ°Bå†å›æ¥ï¼Œä»»ä½•æ—¶åˆ»é“è·¯ä¸Šåªèƒ½æœ‰å‘ç€åŒä¸€ä¸ªæ–¹å‘å‰è¿›çš„åˆ—è½¦ï¼Œç„¶åæ¯è¾†åˆ—è½¦æœ‰ä¸€ä¸ªä»Aå‡ºå‘çš„æœ€æ—©å‡ºç«™æ—¶é—´ï¼Œé—®æ‰€æœ‰åˆ—è½¦å…¨éƒ¨å›åˆ°Aç«™çš„æœ€æ—©æ—¶é—´


## è¯´æ˜/æç¤º




## æ ·ä¾‹ #1

### è¾“å…¥

```
3 4
1 8 11
```

### è¾“å‡º

```
20
```

# AIåˆ†æç»“æœ

# ğŸ’¡ Kayçš„C++ç®—æ³•è§£æï¼š[POI 2014] ZAL-Freight æ·±å…¥å­¦ä¹ æŒ‡å— ğŸ’¡


## 1. é¢˜ç›®è§£è¯»ä¸æ ¸å¿ƒç®—æ³•è¯†åˆ«

âœ¨ **æœ¬é¢˜ä¸»è¦è€ƒå¯Ÿ**ï¼šåŠ¨æ€è§„åˆ’ï¼ˆDPï¼‰+ å•è°ƒé˜Ÿåˆ—/åŒæŒ‡é’ˆä¼˜åŒ–  

ğŸ—£ï¸ **åˆæ­¥åˆ†æ**ï¼š  
è§£å†³â€œZAL-Freightâ€é—®é¢˜çš„å…³é”®ï¼Œåœ¨äº**ç”¨åŠ¨æ€è§„åˆ’æ¨¡æ‹Ÿç«è½¦æ‰¹æ¬¡å¾€è¿”çš„æœ€ä¼˜æ—¶é—´**ï¼Œå¹¶é€šè¿‡**å•è°ƒæ€§ä¼˜åŒ–**å°†åŸæœ¬O(nÂ²)çš„DPé™ä¸ºO(n)æˆ–O(nlogn)ã€‚  

ç®€å•æ¥è¯´ï¼ŒåŠ¨æ€è§„åˆ’å°±åƒâ€œè§„åˆ’æ—…è¡Œè·¯çº¿â€ï¼šæˆ‘ä»¬éœ€è¦ä¸ºæ¯è¾†ç«è½¦ç¡®å®šå®ƒå±äºå“ªä¸€æ‰¹å¾€è¿”ï¼ˆæ¯”å¦‚â€œç¬¬ä¸€æ‰¹å»çš„1-3å·è½¦ï¼Œç¬¬äºŒæ‰¹å»çš„4-5å·è½¦â€ï¼‰ï¼Œä½¿å¾—æ‰€æœ‰è½¦å›æ¥çš„æ—¶é—´æœ€æ™šçš„é‚£ä¸ªå°½å¯èƒ½æ—©ã€‚è€Œå•è°ƒé˜Ÿåˆ—/åŒæŒ‡é’ˆåˆ™åƒâ€œæ—…è¡Œé¡¾é—®â€ï¼Œå¸®æˆ‘ä»¬å¿«é€Ÿæ‰¾åˆ°æ¯ä¸€æ­¥çš„æœ€ä¼˜å†³ç­–ï¼ˆå³å“ªä¸€æ‰¹æ¬¡çš„å®‰æ’æœ€çœæ—¶é—´ï¼‰ã€‚  

### æ ¸å¿ƒæ€è·¯ä¸éš¾ç‚¹
- **çŠ¶æ€å®šä¹‰**ï¼š`f[i]`è¡¨ç¤ºå‰`i`è¾†ç«è½¦å…¨éƒ¨å›åˆ°Aç«™çš„æœ€æ—©æ—¶é—´ã€‚  
- **è½¬ç§»æ–¹ç¨‹**ï¼š`f[i] = min{ max(f[j] + i-j-1, a[i]) + 2*S + i-j-1 }`ï¼ˆ`j<i`ï¼‰ã€‚å…¶ä¸­ï¼Œ`max(f[j]+i-j-1, a[i])`æ˜¯ç¬¬`i`è¾†ç«è½¦çš„å‘è½¦æ—¶é—´ï¼ˆè¦ä¹ˆç­‰å‰`j`è¾†å›æ¥åé—´éš”`i-j-1`åˆ†é’Ÿï¼Œè¦ä¹ˆæŒ‰å®ƒçš„æœ€æ—©å‘è½¦æ—¶é—´`a[i]`ï¼‰ï¼ŒåŠ ä¸Šå¾€è¿”æ—¶é—´`2*S`å’Œå‘è½¦é—´éš”`i-j-1`åˆ†é’Ÿï¼Œå°±æ˜¯`i`è¾†ç«è½¦çš„æœ€æ™šå›æ¥æ—¶é—´ã€‚  
- **æ ¸å¿ƒéš¾ç‚¹**ï¼šå¦‚ä½•é«˜æ•ˆè®¡ç®—è¿™ä¸ª`min`â€”â€”ç›´æ¥æšä¸¾`j`ä¼šè¶…æ—¶ï¼Œéœ€è¦åˆ©ç”¨`f[j]-j`å’Œ`a[i]-i+1`çš„**å•è°ƒæ€§**ï¼Œå°†è½¬ç§»åˆ†æˆä¸¤éƒ¨åˆ†ï¼Œåˆ†åˆ«ç»´æŠ¤æœ€å°å€¼ã€‚  

### å¯è§†åŒ–è®¾è®¡æ€è·¯
æˆ‘ä»¬å¯ä»¥ç”¨**8ä½åƒç´ é£æ ¼**æ¨¡æ‹Ÿç«è½¦å¾€è¿”è¿‡ç¨‹ï¼š  
- **åœºæ™¯**ï¼šç”¨åƒç´ å—è¡¨ç¤ºAç«™ï¼ˆå·¦è¾¹ï¼‰ã€Bç«™ï¼ˆå³è¾¹ï¼‰ï¼Œé“è·¯æ˜¯ä¸­é—´çš„ä¸€æ¡çº¿ã€‚  
- **ç«è½¦**ï¼šä¸åŒé¢œè‰²çš„åƒç´ å—ä»£è¡¨ä¸åŒæ‰¹æ¬¡çš„ç«è½¦ï¼Œæ¯”å¦‚çº¢è‰²ä»£è¡¨ç¬¬ä¸€æ‰¹ï¼Œè“è‰²ä»£è¡¨ç¬¬äºŒæ‰¹ã€‚  
- **å…³é”®æ­¥éª¤**ï¼š  
  1. åˆå§‹åŒ–ï¼šAç«™æœ‰`n`è¾†ç«è½¦ï¼ˆåƒç´ å—æ’æˆä¸€åˆ—ï¼‰ï¼ŒBç«™ä¸ºç©ºã€‚  
  2. å‘è½¦ï¼šå½“æŸæ‰¹ç«è½¦å‘è½¦æ—¶ï¼Œåƒç´ å—ä»Aç«™å‘å³ç§»åŠ¨ï¼Œæ¯æ­¥ä»£è¡¨1åˆ†é’Ÿï¼Œé—´éš”1åˆ†é’Ÿå‡ºå‘ï¼ˆæ¯”å¦‚ç¬¬1è¾†èµ°1æ­¥ï¼Œç¬¬2è¾†ç­‰1æ­¥å†èµ°ï¼‰ã€‚  
  3. åˆ°è¾¾Bç«™ï¼šç«è½¦åˆ°è¾¾Bç«™åï¼Œç«‹å³è¿”å›ï¼ˆåƒç´ å—å‘å·¦ç§»åŠ¨ï¼‰ï¼ŒåŒæ ·é—´éš”1åˆ†é’Ÿå‡ºå‘ã€‚  
  4. æ›´æ–°çŠ¶æ€ï¼šæ¯è¾†ç«è½¦å›åˆ°Aç«™æ—¶ï¼Œ`f[i]`çš„å€¼ç”¨æ•°å­—åƒç´ æ˜¾ç¤ºåœ¨å±å¹•ä¸Šæ–¹ï¼Œå•è°ƒé˜Ÿåˆ—çš„å˜åŒ–ç”¨â€œé˜Ÿåˆ—æ¡†â€å±•ç¤ºï¼ˆæ¯”å¦‚å¼¹å‡ºä¸ç¬¦åˆæ¡ä»¶çš„`j`ï¼ŒåŠ å…¥æ–°çš„`i`ï¼‰ã€‚  
- **äº¤äº’è®¾è®¡**ï¼šæ”¯æŒâ€œå•æ­¥æ‰§è¡Œâ€ï¼ˆé€åˆ†é’Ÿå±•ç¤ºï¼‰ã€â€œè‡ªåŠ¨æ’­æ”¾â€ï¼ˆåŠ é€Ÿæ¼”ç¤ºï¼‰ï¼Œå…³é”®æ“ä½œï¼ˆå¦‚å‘è½¦ã€è¿”å›ï¼‰ä¼´éšâ€œå®â€çš„åƒç´ éŸ³æ•ˆï¼Œå®Œæˆæ‰€æœ‰å¾€è¿”æ—¶æ’­æ”¾â€œèƒœåˆ©â€éŸ³æ•ˆã€‚  


## 2. ç²¾é€‰ä¼˜è´¨é¢˜è§£å‚è€ƒ

### é¢˜è§£ä¸€ï¼šFriedrichCï¼ˆå•è°ƒé˜Ÿåˆ—ä¼˜åŒ–DPï¼‰  
* **ç‚¹è¯„**ï¼š  
  è¿™ä»½é¢˜è§£çš„æ€è·¯éå¸¸æ¸…æ™°ï¼Œä»**é¢˜ç›®æ€§è´¨åˆ†æ**ï¼ˆæ‰¹æ¬¡å¾€è¿”ç­‰æ•ˆï¼‰åˆ°**çŠ¶æ€è®¾è®¡**ï¼ˆ`f[i]`è¡¨ç¤ºå‰`i`è¾†çš„æœ€æ—©æ—¶é—´ï¼‰ï¼Œå†åˆ°**è½¬ç§»ä¼˜åŒ–**ï¼ˆåˆ†æƒ…å†µè®¨è®º`max`å‡½æ•°ï¼‰ï¼Œæ¯ä¸€æ­¥éƒ½è§£é‡Šå¾—å¾ˆé€å½»ã€‚ä»£ç é£æ ¼è§„èŒƒï¼ˆå˜é‡å`f`ã€`t`å«ä¹‰æ˜ç¡®ï¼‰ï¼Œç‰¹åˆ«æ˜¯**å•è°ƒé˜Ÿåˆ—çš„ç»´æŠ¤é€»è¾‘**ï¼ˆç»´æŠ¤`f[j]-2j`çš„æœ€å°å€¼ï¼‰ï¼Œå®Œç¾åˆ©ç”¨äº†`f[j]-j`å’Œ`a[i]-i+1`çš„å•è°ƒæ€§ï¼Œå°†æ—¶é—´å¤æ‚åº¦é™åˆ°äº†O(n)ã€‚ä»å®è·µè§’åº¦çœ‹ï¼Œä»£ç å¯ä»¥ç›´æ¥ç”¨äºç«èµ›ï¼Œè¾¹ç•Œå¤„ç†ï¼ˆå¦‚`t[i] = max(t[i], t[i-1]+1)`ï¼‰éå¸¸ä¸¥è°¨ã€‚  

### é¢˜è§£äºŒï¼šlsj2009ï¼ˆåŒæŒ‡é’ˆä¼˜åŒ–DPï¼‰  
* **ç‚¹è¯„**ï¼š  
  æ­¤é¢˜è§£çš„äº®ç‚¹æ˜¯**åŒæŒ‡é’ˆçš„å·§å¦™åº”ç”¨**ã€‚ä½œè€…é€šè¿‡è¯æ˜`f[j]-j`å’Œ`a[i]-i+1`çš„å•è°ƒæ€§ï¼Œç”¨åŒæŒ‡é’ˆ`p`è·Ÿè¸ªæ»¡è¶³`f[p]-p < a[i]-i+1`çš„æœ€åä¸€ä¸ª`j`ï¼Œä»è€Œå°†è½¬ç§»åˆ†æˆä¸¤éƒ¨åˆ†ï¼š`p`å·¦è¾¹çš„`j`ç”¨`a[i]`è½¬ç§»ï¼Œ`p`å³è¾¹çš„`j`ç”¨`f[j]`è½¬ç§»ã€‚ä»£ç ç®€æ´ï¼ˆåªæœ‰å‡ åè¡Œï¼‰ï¼Œé€»è¾‘ç›´æ¥ï¼Œéå¸¸é€‚åˆç†è§£â€œå•è°ƒæ€§å¦‚ä½•ç®€åŒ–é—®é¢˜â€ã€‚  

### é¢˜è§£ä¸‰ï¼š0xyzï¼ˆäºŒåˆ†ä¼˜åŒ–DPï¼‰  
* **ç‚¹è¯„**ï¼š  
  è¿™ä»½é¢˜è§£ç”¨**äºŒåˆ†æ³•**æ‰¾åˆ°è½¬ç§»çš„åˆ†ç•Œç‚¹ï¼Œæ€è·¯æ–°é¢–ã€‚ä½œè€…å°†è½¬ç§»æ–¹ç¨‹å˜å½¢ä¸º`f[i] = min(t[i]-i+1-e, f[e+1]-2(e+1)) + 2s+2i-2`ï¼Œå…¶ä¸­`e`æ˜¯æ»¡è¶³`f[e]-e <= t[i]-i+1`çš„æœ€å¤§`j`ã€‚äºŒåˆ†æ³•çš„æ—¶é—´å¤æ‚åº¦æ˜¯O(nlogn)ï¼Œè™½ç„¶æ¯”å•è°ƒé˜Ÿåˆ—ç¨æ…¢ï¼Œä½†é€»è¾‘æ›´ç›´è§‚ï¼Œé€‚åˆåˆå­¦è€…ç†è§£â€œå¦‚ä½•å°†å¤æ‚è½¬ç§»è½¬åŒ–ä¸ºäºŒåˆ†é—®é¢˜â€ã€‚  


## 3. æ ¸å¿ƒéš¾ç‚¹è¾¨æä¸è§£é¢˜ç­–ç•¥

### 1. çŠ¶æ€å®šä¹‰çš„æ­£ç¡®æ€§  
**éš¾ç‚¹**ï¼šå¦‚ä½•ç”¨ä¸€ä¸ªå˜é‡è¡¨ç¤ºå‰`i`è¾†ç«è½¦çš„æœ€æ—©æ—¶é—´ï¼Ÿ  
**åˆ†æ**ï¼š`f[i]`çš„å®šä¹‰å¿…é¡»è¦†ç›–â€œæ‰€æœ‰å‰`i`è¾†ç«è½¦éƒ½å›åˆ°Aç«™â€çš„æƒ…å†µï¼Œå¹¶ä¸”è¦èƒ½é€šè¿‡å‰`j`è¾†çš„çŠ¶æ€è½¬ç§»è€Œæ¥ã€‚é¢˜è§£ä¸­`f[i]`çš„å®šä¹‰æ»¡è¶³è¿™ä¸€ç‚¹ï¼Œå› ä¸ºæ¯ä¸€æ‰¹æ¬¡çš„ç«è½¦éƒ½æ˜¯è¿ç»­çš„ï¼ˆæ¯”å¦‚`j+1`åˆ°`i`è¾†æ˜¯ä¸€æ‰¹ï¼‰ï¼Œæ‰€ä»¥å¯ä»¥é€šè¿‡`f[j]`è½¬ç§»åˆ°`f[i]`ã€‚  
ğŸ’¡ **å­¦ä¹ ç¬”è®°**ï¼šçŠ¶æ€å®šä¹‰è¦â€œè¦†ç›–å­é—®é¢˜â€ï¼Œå¹¶ä¸”â€œèƒ½é€šè¿‡å­é—®é¢˜ç»„åˆå¾—åˆ°åŸé—®é¢˜â€ã€‚  

### 2. è½¬ç§»æ–¹ç¨‹çš„æ¨å¯¼  
**éš¾ç‚¹**ï¼šå¦‚ä½•å¤„ç†`max(f[j]+i-j-1, a[i])`ï¼Ÿ  
**åˆ†æ**ï¼š`f[j]+i-j-1`æ˜¯å‰`j`è¾†å›æ¥åï¼Œ`j+1`åˆ°`i`è¾†å‘è½¦çš„æ—¶é—´ï¼ˆé—´éš”`i-j-1`åˆ†é’Ÿï¼‰ï¼Œè€Œ`a[i]`æ˜¯ç¬¬`i`è¾†çš„æœ€æ—©å‘è½¦æ—¶é—´ã€‚ä¸¤è€…å–æœ€å¤§å€¼ï¼Œç¡®ä¿å‘è½¦æ—¶é—´ç¬¦åˆçº¦æŸã€‚é¢˜è§£ä¸­é€šè¿‡**åˆ†æƒ…å†µè®¨è®º**ï¼ˆ`f[j]-j >= a[i]-i+1`å’Œ`f[j]-j < a[i]-i+1`ï¼‰ï¼Œå°†`max`å‡½æ•°æ‹†å¼€ï¼Œåˆ†åˆ«ç»´æŠ¤æœ€å°å€¼ã€‚  
ğŸ’¡ **å­¦ä¹ ç¬”è®°**ï¼šå¤„ç†`max`æˆ–`min`å‡½æ•°æ—¶ï¼Œå¯ä»¥å°è¯•â€œåˆ†æƒ…å†µè®¨è®ºâ€ï¼Œå°†å¤æ‚é—®é¢˜æ‹†åˆ†æˆç®€å•å­é—®é¢˜ã€‚  

### 3. ä¼˜åŒ–æ–¹æ³•çš„é€‰æ‹©  
**éš¾ç‚¹**ï¼šå¦‚ä½•å°†O(nÂ²)çš„DPä¼˜åŒ–åˆ°O(n)ï¼Ÿ  
**åˆ†æ**ï¼šå…³é”®åœ¨äºå‘ç°`f[j]-j`å’Œ`a[i]-i+1`çš„**å•è°ƒæ€§**ã€‚`f[j]-j`å•è°ƒé€’å¢ï¼ˆå› ä¸º`f[j+1] >= f[j]+2`ï¼Œæ‰€ä»¥`f[j+1]-(j+1) >= f[j]-j+1`ï¼‰ï¼Œ`a[i]-i+1`ä¹Ÿå•è°ƒé€’å¢ï¼ˆå› ä¸º`a[i] >= a[i-1]+1`ï¼Œæ‰€ä»¥`a[i]-i+1 >= a[i-1]-(i-1)+1`ï¼‰ã€‚åˆ©ç”¨å•è°ƒæ€§ï¼Œå¯ä»¥ç”¨å•è°ƒé˜Ÿåˆ—ã€åŒæŒ‡é’ˆæˆ–äºŒåˆ†æ³•å¿«é€Ÿæ‰¾åˆ°æœ€ä¼˜`j`ã€‚  
ğŸ’¡ **å­¦ä¹ ç¬”è®°**ï¼šä¼˜åŒ–DPæ—¶ï¼Œå…ˆåˆ†æçŠ¶æ€çš„å•è°ƒæ€§ï¼Œå†é€‰æ‹©åˆé€‚çš„æ•°æ®ç»“æ„ï¼ˆå¦‚å•è°ƒé˜Ÿåˆ—ï¼‰æˆ–æ–¹æ³•ï¼ˆå¦‚åŒæŒ‡é’ˆï¼‰ã€‚  


## 4. C++æ ¸å¿ƒä»£ç å®ç°èµæ

### æœ¬é¢˜é€šç”¨æ ¸å¿ƒC++å®ç°å‚è€ƒï¼ˆåŸºäºå•è°ƒé˜Ÿåˆ—ä¼˜åŒ–ï¼‰  
* **è¯´æ˜**ï¼šç»¼åˆFriedrichCå’ŒTreakerçš„é¢˜è§£ï¼Œæç‚¼å‡ºæœ€ç®€æ´çš„å•è°ƒé˜Ÿåˆ—ä¼˜åŒ–DPå®ç°ã€‚  
* **å®Œæ•´æ ¸å¿ƒä»£ç **ï¼š  
  ```cpp
  #include <iostream>
  #include <cstring>
  #include <algorithm>
  using namespace std;
  typedef long long ll;
  const int MAXN = 1e6 + 10;
  const ll INF = 1e18;
  int n, s;
  ll t[MAXN], f[MAXN];
  int q[MAXN], head = 1, tail = 0;

  int main() {
      cin >> n >> s;
      for (int i = 1; i <= n; ++i) {
          cin >> t[i];
          t[i] = max(t[i], t[i-1] + 1); // ä¿è¯å‘è½¦é—´éš”1åˆ†é’Ÿ
      }
      memset(f, 0x3f, sizeof(f));
      f[0] = 0;
      for (int i = 1; i <= n; ++i) {
          // å¼¹å‡ºä¸æ»¡è¶³f[j]-j >= t[i]-i+1çš„j
          while (head <= tail && f[q[head]] - q[head] < t[i] - i + 1) {
              head++;
          }
          // è½¬ç§»ï¼šæƒ…å†µ1ï¼ˆf[j]-j >= t[i]-i+1ï¼‰
          if (head <= tail) {
              f[i] = min(f[i], f[q[head]] + 2 * (s + i - q[head] - 1));
          }
          // è½¬ç§»ï¼šæƒ…å†µ2ï¼ˆf[j]-j < t[i]-i+1ï¼Œå–æœ€åä¸€ä¸ªå¼¹å‡ºçš„jï¼‰
          if (head > 1) {
              f[i] = min(f[i], t[i] + 2 * s + i - q[head-1] - 1);
          }
          // ç»´æŠ¤å•è°ƒé˜Ÿåˆ—ï¼šä¿æŒf[j]-2jå•è°ƒé€’å¢
          while (head <= tail && f[q[tail]] - 2 * q[tail] > f[i] - 2 * i) {
              tail--;
          }
          q[++tail] = i;
      }
      cout << f[n] << endl;
      return 0;
  }
  ```
* **ä»£ç è§£è¯»æ¦‚è¦**ï¼š  
  1. **è¾“å…¥å¤„ç†**ï¼šè¯»å–`n`å’Œ`s`ï¼Œç„¶åè¯»å–æ¯è¾†ç«è½¦çš„æœ€æ—©å‘è½¦æ—¶é—´`t[i]`ï¼Œå¹¶è°ƒæ•´`t[i]`ä¸º`max(t[i], t[i-1]+1)`ï¼Œç¡®ä¿å‘è½¦é—´éš”1åˆ†é’Ÿã€‚  
  2. **åˆå§‹åŒ–**ï¼š`f[0] = 0`ï¼ˆå‰0è¾†ç«è½¦çš„æ—¶é—´ä¸º0ï¼‰ï¼Œ`f`æ•°ç»„åˆå§‹åŒ–ä¸ºæ— ç©·å¤§ã€‚  
  3. **å•è°ƒé˜Ÿåˆ—ä¼˜åŒ–DP**ï¼š  
     - å¯¹äºæ¯ä¸ª`i`ï¼Œå¼¹å‡ºé˜Ÿåˆ—ä¸­ä¸æ»¡è¶³`f[j]-j >= t[i]-i+1`çš„`j`ï¼ˆè¿™äº›`j`å±äºæƒ…å†µ2ï¼‰ã€‚  
     - ç”¨é˜Ÿåˆ—å¤´éƒ¨çš„`j`ï¼ˆæƒ…å†µ1ï¼‰è½¬ç§»`f[i]`ã€‚  
     - ç”¨æœ€åä¸€ä¸ªå¼¹å‡ºçš„`j`ï¼ˆæƒ…å†µ2ï¼‰è½¬ç§»`f[i]`ã€‚  
     - å°†`i`åŠ å…¥é˜Ÿåˆ—ï¼Œç»´æŠ¤é˜Ÿåˆ—ä¸­`f[j]-2j`çš„å•è°ƒæ€§ã€‚  
  4. **è¾“å‡ºç»“æœ**ï¼š`f[n]`å³ä¸ºæ‰€æœ‰ç«è½¦å›åˆ°Aç«™çš„æœ€æ—©æ—¶é—´ã€‚  

### é¢˜è§£ä¸€ï¼ˆFriedrichCï¼‰ä»£ç ç‰‡æ®µèµæ  
* **äº®ç‚¹**ï¼šå•è°ƒé˜Ÿåˆ—ç»´æŠ¤`f[j]-2j`çš„æœ€å°å€¼ã€‚  
* **æ ¸å¿ƒä»£ç ç‰‡æ®µ**ï¼š  
  ```cpp
  while (head <= tail && f[q[head]] - q[head] < t[i] - i + 1) head++;
  if (head <= tail) f[i] = min(f[i], f[q[head]] + 2*(s + i - q[head] - 1));
  if (head > 1) f[i] = min(f[i], t[i] + 2*s + i - q[head-1] - 1);
  while (head <= tail && f[q[tail]] - 2*q[tail] > f[i] - 2*i) tail--;
  q[++tail] = i;
  ```
* **ä»£ç è§£è¯»**ï¼š  
  - ç¬¬ä¸€è¡Œï¼šå¼¹å‡ºé˜Ÿåˆ—ä¸­ä¸æ»¡è¶³æƒ…å†µ1çš„`j`ï¼ˆ`f[j]-j < t[i]-i+1`ï¼‰ã€‚  
  - ç¬¬äºŒè¡Œï¼šç”¨é˜Ÿåˆ—å¤´éƒ¨çš„`j`ï¼ˆæƒ…å†µ1ï¼‰è®¡ç®—`f[i]`ï¼Œå…¬å¼æ˜¯`f[j] + 2*(s + i - j - 1)`ï¼ˆå¾€è¿”æ—¶é—´åŠ é—´éš”ï¼‰ã€‚  
  - ç¬¬ä¸‰è¡Œï¼šç”¨æœ€åä¸€ä¸ªå¼¹å‡ºçš„`j`ï¼ˆæƒ…å†µ2ï¼‰è®¡ç®—`f[i]`ï¼Œå…¬å¼æ˜¯`t[i] + 2*s + i - j - 1`ï¼ˆæŒ‰æœ€æ—©å‘è½¦æ—¶é—´è®¡ç®—ï¼‰ã€‚  
  - ç¬¬å››ã€äº”è¡Œï¼šå°†`i`åŠ å…¥é˜Ÿåˆ—ï¼Œä¿æŒé˜Ÿåˆ—ä¸­`f[j]-2j`å•è°ƒé€’å¢ï¼ˆè¿™æ ·é˜Ÿåˆ—å¤´éƒ¨çš„`j`æ˜¯æƒ…å†µ1çš„æœ€ä¼˜è§£ï¼‰ã€‚  
* ğŸ’¡ **å­¦ä¹ ç¬”è®°**ï¼šå•è°ƒé˜Ÿåˆ—çš„æ ¸å¿ƒæ˜¯â€œç»´æŠ¤ä¸€ä¸ªæ»¡è¶³æŸç§å•è°ƒæ€§çš„é˜Ÿåˆ—â€ï¼Œä»è€Œå¿«é€Ÿæ‰¾åˆ°æœ€ä¼˜å†³ç­–ã€‚  

### é¢˜è§£äºŒï¼ˆlsj2009ï¼‰ä»£ç ç‰‡æ®µèµæ  
* **äº®ç‚¹**ï¼šåŒæŒ‡é’ˆè·Ÿè¸ªåˆ†ç•Œç‚¹`p`ã€‚  
* **æ ¸å¿ƒä»£ç ç‰‡æ®µ**ï¼š  
  ```cpp
  int p = 0;
  for (int i = 1; i <= n; ++i) {
      while (p < i && f[p] - p < t[i] - i + 1) p++;
      if (p > 0) f[i] = min(f[i], t[i] + 2*s + i - (p-1) - 1);
      if (p < i) f[i] = min(f[i], f[p] + 2*(i + s - p - 1));
  }
  ```
* **ä»£ç è§£è¯»**ï¼š  
  - ç¬¬ä¸€è¡Œï¼š`p`åˆå§‹åŒ–ä¸º0ã€‚  
  - ç¬¬äºŒè¡Œï¼šéå†æ¯è¾†ç«è½¦`i`ã€‚  
  - ç¬¬ä¸‰è¡Œï¼šç§»åŠ¨`p`ç›´åˆ°`f[p]-p >= t[i]-i+1`ï¼ˆ`p`æ˜¯æƒ…å†µ1çš„ç¬¬ä¸€ä¸ª`j`ï¼‰ã€‚  
  - ç¬¬å››è¡Œï¼šç”¨`p-1`ï¼ˆæƒ…å†µ2çš„æœ€åä¸€ä¸ª`j`ï¼‰è®¡ç®—`f[i]`ã€‚  
  - ç¬¬äº”è¡Œï¼šç”¨`p`ï¼ˆæƒ…å†µ1çš„ç¬¬ä¸€ä¸ª`j`ï¼‰è®¡ç®—`f[i]`ã€‚  
* ğŸ’¡ **å­¦ä¹ ç¬”è®°**ï¼šåŒæŒ‡é’ˆçš„å…³é”®æ˜¯â€œä¸¤ä¸ªæŒ‡é’ˆéƒ½å•è°ƒç§»åŠ¨â€ï¼Œä»è€Œå°†æ—¶é—´å¤æ‚åº¦é™åˆ°O(n)ã€‚  


## 5. ç®—æ³•å¯è§†åŒ–ï¼šåƒç´ åŠ¨ç”»æ¼”ç¤ºï¼ˆæ ¸å¿ƒéƒ¨åˆ†ï¼‰

### åŠ¨ç”»æ¼”ç¤ºä¸»é¢˜  
**ã€Šåƒç´ ç«è½¦çš„å¾€è¿”ä¹‹æ—…ã€‹**ï¼ˆä»¿FCæ¸¸æˆé£æ ¼ï¼‰  

### æ ¸å¿ƒæ¼”ç¤ºå†…å®¹  
- **åœºæ™¯**ï¼šå·¦è¾¹æ˜¯Aç«™ï¼ˆåƒç´ å—ç»„æˆçš„â€œè½¦ç«™â€å›¾æ ‡ï¼‰ï¼Œå³è¾¹æ˜¯Bç«™ï¼ˆåŒæ ·çš„å›¾æ ‡ï¼‰ï¼Œä¸­é—´æ˜¯é“è·¯ï¼ˆä¸€æ¡ç°è‰²çš„çº¿ï¼‰ã€‚  
- **ç«è½¦**ï¼šç”¨ä¸åŒé¢œè‰²çš„16x16åƒç´ å—è¡¨ç¤ºï¼ˆå¦‚çº¢è‰²ä»£è¡¨ç¬¬1è¾†ï¼Œè“è‰²ä»£è¡¨ç¬¬2è¾†ï¼Œä¾æ­¤ç±»æ¨ï¼‰ã€‚  
- **å…³é”®æ­¥éª¤**ï¼š  
  1. **åˆå§‹åŒ–**ï¼šAç«™æœ‰`n`è¾†ç«è½¦ï¼ˆæ’æˆä¸€åˆ—ï¼‰ï¼ŒBç«™ä¸ºç©ºï¼Œå±å¹•ä¸Šæ–¹æ˜¾ç¤º`f[0] = 0`ã€‚  
  2. **å‘è½¦ï¼ˆæƒ…å†µ1ï¼‰**ï¼šå½“`f[j]-j >= t[i]-i+1`æ—¶ï¼Œçº¢è‰²ç«è½¦ä»Aç«™å‘å³ç§»åŠ¨ï¼Œæ¯æ­¥ä»£è¡¨1åˆ†é’Ÿï¼Œé—´éš”1åˆ†é’Ÿå‡ºå‘ï¼ˆæ¯”å¦‚ç¬¬1è¾†èµ°1æ­¥ï¼Œç¬¬2è¾†ç­‰1æ­¥å†èµ°ï¼‰ã€‚æ­¤æ—¶ï¼Œå•è°ƒé˜Ÿåˆ—çš„â€œé˜Ÿåˆ—æ¡†â€ä¸­æ˜¾ç¤º`j`çš„å€¼ï¼ˆå¦‚`j=0`ï¼‰ï¼Œå¹¶å¼¹å‡ºä¸ç¬¦åˆæ¡ä»¶çš„`j`ã€‚  
  3. **å‘è½¦ï¼ˆæƒ…å†µ2ï¼‰**ï¼šå½“`f[j]-j < t[i]-i+1`æ—¶ï¼Œè“è‰²ç«è½¦ä»Aç«™å‘å³ç§»åŠ¨ï¼ŒæŒ‰`a[i]`çš„æ—¶é—´å‘è½¦ï¼ˆæ¯”å¦‚`a[i]=8`ï¼Œåˆ™ç¬¬3è¾†ç«è½¦åœ¨ç¬¬8åˆ†é’Ÿå‡ºå‘ï¼‰ã€‚æ­¤æ—¶ï¼Œå±å¹•ä¸Šæ–¹æ˜¾ç¤º`a[i]`çš„å€¼ï¼Œå¹¶ç”¨é»„è‰²é«˜äº®ã€‚  
  4. **åˆ°è¾¾Bç«™**ï¼šç«è½¦åˆ°è¾¾Bç«™åï¼Œç«‹å³è¿”å›ï¼ˆå‘å·¦ç§»åŠ¨ï¼‰ï¼ŒåŒæ ·é—´éš”1åˆ†é’Ÿå‡ºå‘ã€‚æ­¤æ—¶ï¼Œå±å¹•ä¸Šæ–¹æ˜¾ç¤º`f[i]`çš„æ›´æ–°å€¼ï¼ˆå¦‚`f[3] = 20`ï¼‰ã€‚  
  5. **å®Œæˆå¾€è¿”**ï¼šæ‰€æœ‰ç«è½¦å›åˆ°Aç«™åï¼Œæ’­æ”¾â€œèƒœåˆ©â€éŸ³æ•ˆï¼ˆ8ä½é£æ ¼ï¼‰ï¼Œå±å¹•æ˜¾ç¤ºâ€œæ‰€æœ‰ç«è½¦å·²è¿”å›ï¼â€ã€‚  

### äº¤äº’ä¸æ§åˆ¶  
- **æ§åˆ¶é¢æ¿**ï¼šä½äºå±å¹•ä¸‹æ–¹ï¼Œæœ‰â€œå¼€å§‹/æš‚åœâ€ã€â€œå•æ­¥æ‰§è¡Œâ€ã€â€œé‡ç½®â€æŒ‰é’®ï¼Œä»¥åŠâ€œé€Ÿåº¦æ»‘å—â€ï¼ˆè°ƒæ•´æ’­æ”¾é€Ÿåº¦ï¼‰ã€‚  
- **AIè‡ªåŠ¨æ¼”ç¤º**ï¼šç‚¹å‡»â€œAIæ¼”ç¤ºâ€æŒ‰é’®ï¼ŒåŠ¨ç”»ä¼šè‡ªåŠ¨æ’­æ”¾ï¼Œå±•ç¤ºæœ€ä¼˜å†³ç­–è¿‡ç¨‹ï¼ˆå¦‚å•è°ƒé˜Ÿåˆ—çš„å˜åŒ–ã€ç«è½¦çš„ç§»åŠ¨ï¼‰ã€‚  
- **éŸ³æ•ˆ**ï¼šå‘è½¦æ—¶æ’­æ”¾â€œå®â€çš„éŸ³æ•ˆï¼Œåˆ°è¾¾Bç«™æ—¶æ’­æ”¾â€œå’šâ€çš„éŸ³æ•ˆï¼Œå®Œæˆå¾€è¿”æ—¶æ’­æ”¾â€œèƒœåˆ©â€éŸ³æ•ˆã€‚  

### è®¾è®¡æ€è·¯  
- **åƒç´ é£æ ¼**ï¼šä»¿FCæ¸¸æˆé£æ ¼ï¼Œç”¨ç®€å•çš„åƒç´ å—å’Œé²œè‰³çš„é¢œè‰²ï¼Œè®©å­¦ä¹ è€…æ„Ÿåˆ°äº²åˆ‡ã€‚  
- **å¯è§†åŒ–é‡ç‚¹**ï¼šçªå‡º`f[i]`çš„æ›´æ–°ã€å•è°ƒé˜Ÿåˆ—çš„å˜åŒ–ã€ç«è½¦çš„ç§»åŠ¨ï¼Œå¸®åŠ©å­¦ä¹ è€…ç†è§£â€œçŠ¶æ€è½¬ç§»â€å’Œâ€œä¼˜åŒ–è¿‡ç¨‹â€ã€‚  
- **æ¸¸æˆåŒ–å…ƒç´ **ï¼šéŸ³æ•ˆå’ŒAIæ¼”ç¤ºå¢åŠ è¶£å‘³æ€§ï¼Œè®©å­¦ä¹ è€…åœ¨â€œç©â€ä¸­å­¦ä¹ ç®—æ³•ã€‚  


## 6. æ‹“å±•ç»ƒä¹ ä¸ç›¸ä¼¼é—®é¢˜æ€è€ƒ

### é€šç”¨æ€è·¯/æŠ€å·§è¿ç§»  
`åŠ¨æ€è§„åˆ’+å•è°ƒæ€§ä¼˜åŒ–`çš„æ€è·¯ä¸ä»…èƒ½è§£å†³æœ¬é¢˜ï¼Œè¿˜èƒ½è§£å†³ä»¥ä¸‹é—®é¢˜ï¼š  
1. **çŸ³å­åˆå¹¶é—®é¢˜**ï¼ˆP1880ï¼‰ï¼šå°†çŸ³å­åˆ†æˆè‹¥å¹²å †ï¼Œæ±‚åˆå¹¶çš„æœ€å°ä»£ä»·ï¼Œç”¨åˆ°äº†ç±»ä¼¼çš„å•è°ƒé˜Ÿåˆ—ä¼˜åŒ–ã€‚  
2. **æœ€å°å‡½æ•°å€¼é—®é¢˜**ï¼ˆP2085ï¼‰ï¼šæ±‚å¤šä¸ªå‡½æ•°çš„æœ€å°å‰kä¸ªå€¼ï¼Œç”¨åˆ°äº†ä¼˜å…ˆé˜Ÿåˆ—ï¼ˆå•è°ƒé˜Ÿåˆ—çš„å˜ç§ï¼‰ã€‚  
3. **å•æºæœ€çŸ­è·¯å¾„é—®é¢˜**ï¼ˆP3371ï¼‰ï¼šDijkstraç®—æ³•ç”¨ä¼˜å…ˆé˜Ÿåˆ—ä¼˜åŒ–ï¼Œæœ¬è´¨æ˜¯ç»´æŠ¤ä¸€ä¸ªå•è°ƒçš„é˜Ÿåˆ—ã€‚  

### ç»ƒä¹ æ¨èï¼ˆæ´›è°·ï¼‰  
1. **æ´›è°· P1880** - çŸ³å­åˆå¹¶  
   ğŸ—£ï¸ **æ¨èç†ç”±**ï¼šè¿™é“é¢˜æ˜¯å•è°ƒé˜Ÿåˆ—ä¼˜åŒ–DPçš„ç»å…¸é—®é¢˜ï¼Œèƒ½å¸®åŠ©ä½ å·©å›ºâ€œåˆ†æ‰¹æ¬¡å¤„ç†â€å’Œâ€œå•è°ƒæ€§åˆ†æâ€çš„æŠ€å·§ã€‚  
2. **æ´›è°· P2085** - æœ€å°å‡½æ•°å€¼  
   ğŸ—£ï¸ **æ¨èç†ç”±**ï¼šæ­¤é¢˜ç”¨åˆ°äº†ä¼˜å…ˆé˜Ÿåˆ—ä¼˜åŒ–ï¼Œæœ¬è´¨æ˜¯ç»´æŠ¤ä¸€ä¸ªå•è°ƒçš„é˜Ÿåˆ—ï¼Œèƒ½å¸®åŠ©ä½ ç†è§£â€œä¼˜å…ˆé˜Ÿåˆ—ä¸å•è°ƒé˜Ÿåˆ—çš„åŒºåˆ«â€ã€‚  
3. **æ´›è°· P3371** - å•æºæœ€çŸ­è·¯å¾„ï¼ˆå¼±åŒ–ç‰ˆï¼‰  
   ğŸ—£ï¸ **æ¨èç†ç”±**ï¼šDijkstraç®—æ³•ç”¨ä¼˜å…ˆé˜Ÿåˆ—ä¼˜åŒ–ï¼Œèƒ½å¸®åŠ©ä½ ç†è§£â€œå¦‚ä½•ç”¨æ•°æ®ç»“æ„ä¼˜åŒ–åŠ¨æ€è§„åˆ’â€ã€‚  


## 7. å­¦ä¹ å¿ƒå¾—ä¸ç»éªŒåˆ†äº«ï¼ˆè‹¥æœ‰ï¼‰  
**å‚è€ƒç»éªŒï¼ˆæ¥è‡ªlsj2009ï¼‰**ï¼šâ€œæˆ‘åœ¨è§£å†³è¿™ä¸ªé—®é¢˜æ—¶ï¼Œæœ€åˆæ²¡ææ‡‚ä¸ºä»€ä¹ˆè¦ç”¨å•è°ƒé˜Ÿåˆ—ï¼Œåæ¥é€šè¿‡è¯æ˜`f[j]-j`çš„å•è°ƒæ€§ï¼Œæ‰æ˜ç™½åŒæŒ‡é’ˆä¹Ÿèƒ½è§£å†³ã€‚è¿™è®©æˆ‘æ„è¯†åˆ°ï¼Œ**å•è°ƒæ€§åˆ†ææ˜¯ä¼˜åŒ–DPçš„å…³é”®**ã€‚â€  
**ç‚¹è¯„**ï¼šè¿™ä½ä½œè€…çš„ç»éªŒå¾ˆå…¸å‹ã€‚åœ¨ä¼˜åŒ–DPæ—¶ï¼Œä¸è¦æ€¥äºç”¨é«˜çº§æ•°æ®ç»“æ„ï¼ˆå¦‚å•è°ƒé˜Ÿåˆ—ï¼‰ï¼Œå…ˆåˆ†æçŠ¶æ€çš„å•è°ƒæ€§ï¼Œå¯èƒ½ä¼šæœ‰æ›´ç®€å•çš„æ–¹æ³•ï¼ˆå¦‚åŒæŒ‡é’ˆï¼‰ã€‚  


## ç»“è¯­  
æœ¬æ¬¡å…³äºâ€œ[POI 2014] ZAL-Freightâ€çš„C++è§£é¢˜åˆ†æå°±åˆ°è¿™é‡Œã€‚å¸Œæœ›è¿™ä»½å­¦ä¹ æŒ‡å—èƒ½å¸®åŠ©ä½ ç†è§£**åŠ¨æ€è§„åˆ’+å•è°ƒæ€§ä¼˜åŒ–**çš„æ ¸å¿ƒæ€æƒ³ï¼ŒæŒæ¡è§£é¢˜æŠ€å·§ã€‚è®°ä½ï¼Œ**ç¼–ç¨‹èƒ½åŠ›çš„æå‡åœ¨äºæŒç»­å­¦ä¹ ã€å‹¤äºæ€è€ƒå’Œå‹‡äºå®è·µ**ã€‚ä¸‹æ¬¡æˆ‘ä»¬å†ä¸€èµ·æ¢ç´¢æ–°çš„ç¼–ç¨‹æŒ‘æˆ˜ï¼ğŸ’ª

---
å¤„ç†ç”¨æ—¶ï¼š200.97ç§’
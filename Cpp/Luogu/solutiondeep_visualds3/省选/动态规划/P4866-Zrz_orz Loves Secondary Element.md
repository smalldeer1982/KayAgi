# é¢˜ç›®ä¿¡æ¯

# Zrz_orz Loves Secondary Element

## é¢˜ç›®èƒŒæ™¯

zrz_orzèµ˜å–œæ¬¢äºŒæ¬¡å…ƒè¾£ï¼ï¼

## é¢˜ç›®æè¿°

ä¼—æ‰€å‘¨çŸ¥çš„æ˜¯ï¼Œzrz_orzæ˜¯å…¨æœºæˆ¿æœ€å¼ºçš„æ­»å®…ã€‚~~ä»–ç”šè‡³ä½¿ç”¨å˜´éä½¿å¾—Samcompuä¸å¾—ä¸åœ¨è‡ªå·±çš„ç½‘ç«™ä¸ŠæŒ‚ä¸Šæ—¶å´ç‹‚ä¸‰~~ã€‚(è¯è¯´Samcompuå¥½åƒé†’æ‚Ÿäº†åˆæŠŠç‹‚ä¸‰ç»™å»æ‰äº†ã€‚)ä½œä¸ºæ–°ä¸€ä»£æ­»å®…çš„ä¸€å‘˜ï¼Œä»ç”µè„‘å£çº¸åˆ°è¾“å…¥æ³•çš®è‚¤ï¼Œåˆ°å¤„éƒ½æ˜¯äºŒæ¬¡å…ƒçš„ç—•è¿¹ã€‚æ‰€ä»¥ï¼Œä»–ç»å¸¸åœ¨æ¢¦é‡Œæ¢¦è§ä¸€äº›äºŒæ¬¡å…ƒçš„è§’è‰²ã€‚

zrz_orzçš„æ¢¦ï¼Œæ˜¯ç”±$n$ä¸ªç‚¹å’Œ$n-1$æ¡è¾¹æ„æˆçš„è¿é€šå›¾ã€‚å…¶ä¸­æœ‰$m$ä¸ªèŠ‚ç‚¹ä¸Šæœ‰ä¸€ä¸ªäºŒæ¬¡å…ƒçš„è§’è‰²ã€‚å¯¹äºzrz_orzæ¥è¯´ï¼Œæ¯ä¸€ä¸ªäºŒæ¬¡å…ƒçš„è§’è‰²éƒ½æœ‰ä¸€ä¸ªå¯¹åº”çš„$pos_i$å’Œ$val_i$è¡¨ç¤ºè¿™ä¸ªè§’è‰²åœ¨å›¾ä¸Šçš„å“ªä¸€ä¸ªèŠ‚ç‚¹ä»¥åŠä¸ä¹‹èŠå¤©å¯¹zrz_orzæ¥è¯´ä¼šå¢åŠ å¤šå°‘æ„‰æ‚¦å€¼ã€‚(ç”±äºæŸç§åŸå› ï¼ŒèŠå¤©çš„è¿‡ç¨‹å¯ä»¥ä¸ç”¨è®¡å…¥æ—¶é—´ã€‚)å¯æƒœçš„æ˜¯ï¼Œzrz_orzæ¯ä¸€æ¬¡åšæ¢¦éƒ½åªä¼šåš$tim_i$ä¸ªå•ä½æ—¶é—´ã€‚ç°åœ¨è¯·ä½ å‘Šè¯‰ä»–ï¼Œä»–æ¯ä¸€æ¬¡åšæ¢¦æœ€å¤šèƒ½è·å¾—å¤šå°‘æ„‰æ‚¦å€¼ã€‚

æ³¨ï¼š

1.zrz_orzæ¯ä¸€æ¬¡åšæ¢¦éƒ½åªä¼šä»1å·èŠ‚ç‚¹å¼€å§‹èµ°ï¼

2.æ¯ä¸€æ¬¡åšæ¢¦åzrz_orzæ¢¦å¢ƒä¸­çš„å›¾éƒ½ä¸ä¼šæ”¹å˜ï¼

**3.æ¯ä¸€æ¬¡åšå®Œæ¢¦ä¹‹åzrz_orzå°±å¿…é¡»è¦å›åˆ°1å·èŠ‚ç‚¹ï¼Œå¦åˆ™ä»–å°±ä¼šè¿·å¤±åœ¨æ¢¦å¢ƒé‡Œï¼**

## è¯´æ˜/æç¤º

![](https://cdn.luogu.com.cn/upload/pic/25600.png)

ç¬¬ä¸€å¤©å“ªé‡Œéƒ½å»ä¸äº†ã€‚

ç¬¬äºŒå¤©1->3->6->7->6->3->1è·å¾—æœ€å¤§æ„‰æ‚¦å€¼ä¸º7ã€‚

ç¬¬ä¸‰å¤©æ‰€æœ‰çš„åœ°æ–¹éƒ½å¯ä»¥èµ°ä¸€éã€‚

Subtask 1(20 pts): 

$ 1 \leqslant T \leqslant 10 \qquad 1 \leqslant N \leqslant 1000 \qquad 1 \leqslant M \leqslant 20 \qquad 1 \leqslant  tim_k \leqslant 1000$

Subtask 2(40 pts):

$ 1 \leqslant T \leqslant 10^5 \qquad 1 \leqslant N \leqslant 10^5 \qquad 1 \leqslant M \leqslant 20 \qquad 1 \leqslant  tim_k \leqslant 10^5$

Subtask 3(40 pts):

$ 1 \leqslant T \leqslant 5*10^4 \qquad 1 \leqslant N \leqslant 5000 \qquad 1 \leqslant M \leqslant 100 \qquad 1 \leqslant  tim_k \leqslant 100 \qquad 1 \leqslant w_i \leqslant 5$

For all test points:

$ 1 \leqslant pos_j,u_i,v_i \leqslant N \qquad 1 \leqslant \sum val_j \leqslant 2e9 \qquad 1 \leqslant w_i \leqslant 20 \qquad 1 \leqslant tim_k \leqslant 10^5 $

æ³¨æ„: æ ‡è®°çš„åˆ†æ•°å°±æ˜¯è¿™ä¸ªSubtaskçš„åˆ†æ•°ï¼Œæ¯ä¸€ä¸ªSubtaskå¿…é¡»å…¨å¯¹æ‰èƒ½å¾—åˆ†ã€‚Subtask 2çš„æ—¶é™ä¸º1.5sã€‚

$$ \color{white} \text{NOIP 2åˆ1} $$

## æ ·ä¾‹ #1

### è¾“å…¥

```
7 3 3
1 2 2
1 3 1
2 4 1
2 5 10
3 6 1
6 7 2
4 5
5 50
7 7
1
10
100
```

### è¾“å‡º

```
0
7
62```

# AIåˆ†æç»“æœ

# ğŸ’¡ Kayçš„C++ç®—æ³•è§£æï¼šZrz_orz Loves Secondary Element æ·±å…¥å­¦ä¹ æŒ‡å— ğŸ’¡


## 1. é¢˜ç›®è§£è¯»ä¸æ ¸å¿ƒç®—æ³•è¯†åˆ«

âœ¨ **æœ¬é¢˜ä¸»è¦è€ƒå¯Ÿ**ï¼šæ ‘å½¢åŠ¨æ€è§„åˆ’ï¼ˆTree DPï¼‰ã€çŠ¶æ€å‹ç¼©åŠ¨æ€è§„åˆ’ï¼ˆBitmask DPï¼‰  

ğŸ—£ï¸ **åˆæ­¥åˆ†æ**ï¼š  
è¿™é“é¢˜çš„æ ¸å¿ƒæ˜¯**åœ¨æ ‘ä¸Šé€‰æ‹©è‹¥å¹²æœ‰ä»·å€¼çš„èŠ‚ç‚¹ï¼Œåœ¨æœ‰é™æ—¶é—´å†…èµ°ä¸€ä¸ªâ€œå¾€è¿”è·¯å¾„â€ï¼ˆå¿…é¡»å›åˆ°èµ·ç‚¹1ï¼‰ï¼Œè·å¾—æœ€å¤§ä»·å€¼**ã€‚å…³é”®æŠ€å·§æ˜¯**å°†è¾¹æƒä¹˜ä»¥2**ï¼ˆå› ä¸ºæ¯æ¡è¾¹è¦èµ°ä¸¤æ¬¡ï¼šå»å’Œå›ï¼‰ï¼Œè¿™æ ·é—®é¢˜å°±è½¬åŒ–ä¸ºâ€œä¸éœ€è¦è¿”å›èµ·ç‚¹â€çš„è·¯å¾„é—®é¢˜â€”â€”åªè¦æ€»è·¯å¾„é•¿åº¦ä¸è¶…è¿‡æ—¶é—´é™åˆ¶ï¼Œå°±èƒ½ä¿è¯è¿”å›ã€‚  

### æ ¸å¿ƒç®—æ³•æ€æƒ³
- **æ ‘å½¢åŠ¨æ€è§„åˆ’ï¼ˆTree DPï¼‰**ï¼šåƒâ€œæ•´ç†ä¹¦åŒ…â€ä¸€æ ·ï¼ŒæŠŠæ¯ä¸ªå­æ ‘çš„é€‰æ‹©ç»“æœï¼ˆæ¯”å¦‚â€œç”¨jæ—¶é—´èƒ½è·å¾—çš„æœ€å¤§ä»·å€¼â€ï¼‰åˆå¹¶åˆ°çˆ¶èŠ‚ç‚¹ï¼Œé€æ­¥è®¡ç®—æ•´æ£µæ ‘çš„æœ€ä¼˜è§£ã€‚é€‚åˆ**mè¾ƒå¤§ä½†æ—¶é—´é™åˆ¶å°**çš„æƒ…å†µï¼ˆæ¯”å¦‚Subtask3ï¼Œæ—¶é—´â‰¤100ï¼‰ã€‚  
- **çŠ¶æ€å‹ç¼©åŠ¨æ€è§„åˆ’ï¼ˆBitmask DPï¼‰**ï¼šåƒâ€œæ‹¼æ‹¼å›¾â€ä¸€æ ·ï¼Œæšä¸¾æ‰€æœ‰å¯èƒ½çš„èŠ‚ç‚¹ç»„åˆï¼ˆç”¨äºŒè¿›åˆ¶ä½è¡¨ç¤ºæ˜¯å¦é€‰æŸä¸ªèŠ‚ç‚¹ï¼‰ï¼Œè®¡ç®—æ¯ä¸ªç»„åˆçš„æ—¶é—´å’Œä»·å€¼ã€‚é€‚åˆ**mè¾ƒå°**çš„æƒ…å†µï¼ˆæ¯”å¦‚Subtask1-2ï¼Œmâ‰¤20ï¼‰ã€‚  

### æ ¸å¿ƒéš¾ç‚¹ä¸è§£å†³æ–¹æ¡ˆ
- **éš¾ç‚¹1**ï¼šå¦‚ä½•å¤„ç†â€œå¿…é¡»è¿”å›èµ·ç‚¹â€çš„è¦æ±‚ï¼Ÿ  
  è§£å†³æ–¹æ¡ˆï¼šæ¯æ¡è¾¹çš„æ—¶é—´Ã—2ï¼Œè¿™æ ·ä¸ç®¡èµ°ä»€ä¹ˆè·¯å¾„ï¼Œæ€»æ—¶é—´è‡ªç„¶åŒ…å«è¿”å›çš„æˆæœ¬ã€‚  
- **éš¾ç‚¹2**ï¼šå¦‚ä½•é€‰æ‹©ç®—æ³•ï¼Ÿ  
  è§£å†³æ–¹æ¡ˆï¼šçœ‹mçš„å¤§å°â€”â€”mâ‰¤20ç”¨çŠ¶å‹ï¼ˆ2Â²â°=1e6ï¼Œå¯æ¥å—ï¼‰ï¼›m>20ç”¨æ ‘å½¢DPï¼ˆæ—¶é—´é™åˆ¶å°ï¼Œæ¯”å¦‚100ï¼ŒèƒŒåŒ…å®¹é‡å°ï¼‰ã€‚  
- **éš¾ç‚¹3**ï¼šæ ‘å½¢DPçš„çŠ¶æ€è½¬ç§»å¦‚ä½•ä¼˜åŒ–ï¼Ÿ  
  è§£å†³æ–¹æ¡ˆï¼šç”¨**ååºéå†**ï¼ˆå…ˆå¤„ç†å­æ ‘ï¼Œå†å¤„ç†çˆ¶èŠ‚ç‚¹ï¼‰ï¼Œåˆå¹¶å­æ ‘æ—¶ç”¨**é€†åºæšä¸¾èƒŒåŒ…å®¹é‡**ï¼ˆé¿å…é‡å¤è®¡ç®—ï¼‰ã€‚  

### å¯è§†åŒ–è®¾è®¡æ€è·¯
æˆ‘æ‰“ç®—åšä¸€ä¸ª**åƒç´ é£æ ¼çš„æ ‘å½¢èƒŒåŒ…æ¼”ç¤º**ï¼š  
- ç”¨**ä¸åŒé¢œè‰²çš„åƒç´ å—**è¡¨ç¤ºèŠ‚ç‚¹ï¼ˆç»¿è‰²=æœªé€‰ï¼Œçº¢è‰²=é€‰ä¸­ï¼‰ï¼Œè¾¹ç”¨**ç°è‰²çº¿æ¡**è¡¨ç¤ºï¼Œæ—¶é—´ç”¨**æ•°å­—æ ‡ç­¾**æ˜¾ç¤ºã€‚  
- åŠ¨ç”»å±•ç¤º**å­æ ‘åˆå¹¶çš„è¿‡ç¨‹**ï¼šæ¯”å¦‚å¤„ç†çˆ¶èŠ‚ç‚¹æ—¶ï¼Œé€ä¸ªåˆå¹¶å­æ ‘çš„èƒŒåŒ…çŠ¶æ€ï¼ˆæ¯”å¦‚å­æ ‘Aç”¨3æ—¶é—´è·å¾—5ä»·å€¼ï¼Œå­æ ‘Bç”¨2æ—¶é—´è·å¾—3ä»·å€¼ï¼Œåˆå¹¶åçˆ¶èŠ‚ç‚¹ç”¨5æ—¶é—´è·å¾—8ä»·å€¼ï¼‰ã€‚  
- å…³é”®æ­¥éª¤**é«˜äº®æ˜¾ç¤º**ï¼šæ¯”å¦‚åˆå¹¶æ—¶ï¼Œå½“å‰å¤„ç†çš„å­æ ‘è¾¹ä¼šé—ªçƒï¼ŒèƒŒåŒ…å®¹é‡çš„å˜åŒ–ä¼šç”¨â€œ+â€â€œ-â€ç¬¦å·æç¤ºã€‚  
- æ¸¸æˆåŒ–å…ƒç´ ï¼šåŠ å…¥**â€œå•æ­¥æ‰§è¡Œâ€**ï¼ˆç‚¹å‡»ä¸‹ä¸€æ­¥ï¼‰ã€**â€œè‡ªåŠ¨æ’­æ”¾â€**ï¼ˆåƒè´ªåƒè›‡ä¸€æ ·æ…¢æ…¢èµ°ï¼‰ï¼Œä»¥åŠ**éŸ³æ•ˆ**ï¼ˆé€‰ä¸­èŠ‚ç‚¹â€œå®â€ä¸€å£°ï¼Œåˆå¹¶å®Œæˆâ€œå“—å•¦â€ä¸€å£°ï¼‰ã€‚  


## 2. ç²¾é€‰ä¼˜è´¨é¢˜è§£å‚è€ƒ

### é¢˜è§£ä¸€ï¼šCQ_Bobçš„è™šæ ‘+æ ‘å½¢èƒŒåŒ…ï¼ˆæ¥æºï¼šåšé¢˜è®°å½•ï¼‰  
* **ç‚¹è¯„**ï¼š  
  è¿™ä»½é¢˜è§£é’ˆå¯¹**mè¾ƒå°ä½†æ—¶é—´å¤§**çš„æƒ…å†µï¼ˆSubtask2ï¼‰ï¼Œç”¨**è™šæ ‘**ï¼ˆåªä¿ç•™æœ‰ä»·å€¼çš„èŠ‚ç‚¹å’Œå¿…è¦çš„ç¥–å…ˆèŠ‚ç‚¹ï¼‰æŠŠæ ‘çš„å¤§å°ä»1e5å‹ç¼©åˆ°2mï¼Œå¤§å¤§å‡å°‘äº†è®¡ç®—é‡ã€‚ç„¶åç”¨**æ ‘å½¢èƒŒåŒ…**ï¼ˆçŠ¶æ€`dp[u][j]`è¡¨ç¤ºuå­æ ‘ç”¨jæ—¶é—´çš„æœ€å¤§ä»·å€¼ï¼‰åˆå¹¶å­æ ‘ç»“æœã€‚ä»£ç è§„èŒƒï¼ˆå˜é‡åå¦‚`dfn`ã€`lca`æ¸…æ™°ï¼‰ï¼Œæ³¨é‡Šè¯¦ç»†ï¼Œç‰¹åˆ«æ˜¯è™šæ ‘çš„æ„å»ºè¿‡ç¨‹ï¼ˆæ’åºdfnã€æ±‚LCAï¼‰å†™å¾—å¾ˆæ¸…æ¥šã€‚äº®ç‚¹æ˜¯**å‰ç¼€æœ€å¤§å€¼ä¼˜åŒ–**ï¼ˆ`dp[u][i] = max(dp[u][i], dp[u][i-1])`ï¼‰ï¼Œè®©è¯¢é—®å¯ä»¥O(1)å›ç­”ï¼Œéå¸¸é«˜æ•ˆã€‚  

### é¢˜è§£äºŒï¼šmrsrzçš„åˆ†æƒ…å†µå¤„ç†ï¼ˆæ¥æºï¼šä»£ç ï¼‰  
* **ç‚¹è¯„**ï¼š  
  è¿™ä»½é¢˜è§£æœ€é€‚åˆ**åˆå­¦è€…ç†è§£**ï¼Œå› ä¸ºå®ƒæŠŠé—®é¢˜åˆ†æˆäº†ä¸¤ä¸ªå­ä»»åŠ¡ï¼š  
  - **Task1ï¼ˆmâ‰¤20ï¼‰**ï¼šç”¨çŠ¶å‹DPæšä¸¾æ‰€æœ‰èŠ‚ç‚¹ç»„åˆï¼Œè®¡ç®—æ¯ä¸ªç»„åˆçš„æ—¶é—´ï¼ˆé€šè¿‡é‡å»ºçš„æ–°æ ‘è®¡ç®—è·¯å¾„ï¼‰å’Œä»·å€¼ï¼Œç„¶åæ’åºå›ç­”è¯¢é—®ã€‚  
  - **Task2ï¼ˆm>20ï¼‰**ï¼šç”¨æ ‘å½¢DPï¼ˆçŠ¶æ€`dp[u][j]`è¡¨ç¤ºuå­æ ‘ç”¨jæ—¶é—´çš„æœ€å¤§ä»·å€¼ï¼‰ï¼Œç›´æ¥åˆå¹¶å­æ ‘ã€‚  
  ä»£ç ç»“æ„æ¸…æ™°ï¼ˆç”¨namespaceåˆ†å¼€ä¸¤ä¸ªä»»åŠ¡ï¼‰ï¼Œå˜é‡åæ˜“æ‡‚ï¼ˆæ¯”å¦‚`val`è¡¨ç¤ºèŠ‚ç‚¹ä»·å€¼ï¼Œ`dis`è¡¨ç¤ºè·ç¦»ï¼‰ï¼Œå¤„ç†è¾¹ç•Œæƒ…å†µï¼ˆæ¯”å¦‚æ ¹èŠ‚ç‚¹1çš„å¤„ç†ï¼‰å¾ˆä¸¥è°¨ã€‚äº®ç‚¹æ˜¯**æ–°æ ‘çš„æ„å»º**ï¼ˆåªä¿ç•™æœ‰ä»·å€¼çš„èŠ‚ç‚¹å’Œå¿…è¦çš„åˆ†æ”¯èŠ‚ç‚¹ï¼‰ï¼Œå‡å°‘äº†çŠ¶å‹çš„è®¡ç®—é‡ã€‚  

### é¢˜è§£ä¸‰ï¼šCYJiançš„åˆ†æƒ…å†µå¤„ç†ï¼ˆæ¥æºï¼šä»£ç ï¼‰  
* **ç‚¹è¯„**ï¼š  
  è¿™ä»½é¢˜è§£çš„æ€è·¯éå¸¸**ç®€æ´ç›´æ¥**ï¼Œé’ˆå¯¹ä¸åŒå­ä»»åŠ¡é€‰æ‹©ä¸åŒç®—æ³•ï¼š  
  - å¯¹äºå°mï¼ˆSubtask1-2ï¼‰ï¼Œç”¨çŠ¶å‹æšä¸¾æ‰€æœ‰ç»„åˆï¼Œæš´åŠ›è®¡ç®—æ—¶é—´ï¼›  
  - å¯¹äºå¤§mï¼ˆSubtask3ï¼‰ï¼Œç”¨æ ‘å½¢DPåˆå¹¶å­æ ‘ã€‚  
  ä»£ç å¯è¯»æ€§é«˜ï¼ˆæ¯”å¦‚æ ‘å½¢DPçš„è½¬ç§»å¾ªç¯å†™å¾—å¾ˆæ¸…æ¥šï¼‰ï¼Œæ³¨é‡Šè™½ç„¶å°‘ï¼Œä½†é€»è¾‘è¿è´¯ã€‚äº®ç‚¹æ˜¯**è¾¹æƒÃ—2çš„å¤„ç†**ï¼ˆç›´æ¥åœ¨è¾“å…¥æ—¶ä¹˜2ï¼Œç®€åŒ–äº†åç»­è®¡ç®—ï¼‰ï¼Œè®©é—®é¢˜è½¬åŒ–æ›´ç›´è§‚ã€‚  


## 3. æ ¸å¿ƒéš¾ç‚¹è¾¨æä¸è§£é¢˜ç­–ç•¥

### 1. å…³é”®ç‚¹1ï¼šå¦‚ä½•å¤„ç†â€œå¿…é¡»è¿”å›èµ·ç‚¹â€çš„è¦æ±‚ï¼Ÿ  
* **åˆ†æ**ï¼š  
  å› ä¸ºæ ‘æ˜¯è¿é€šçš„ï¼Œä»»ä½•è·¯å¾„è¦è¿”å›èµ·ç‚¹ï¼Œæ¯æ¡è¾¹éƒ½ä¼šèµ°ä¸¤æ¬¡ï¼ˆå»ä¸€æ¬¡ï¼Œå›ä¸€æ¬¡ï¼‰ã€‚æ‰€ä»¥**æŠŠæ¯æ¡è¾¹çš„æ—¶é—´Ã—2**ï¼Œè¿™æ ·ä¸ç®¡èµ°ä»€ä¹ˆè·¯å¾„ï¼Œæ€»æ—¶é—´è‡ªç„¶åŒ…å«è¿”å›çš„æˆæœ¬ã€‚æ¯”å¦‚æ ·ä¾‹ä¸­çš„ç¬¬äºŒå¤©è·¯å¾„1->3->6->7->6->3->1ï¼Œè¾¹æƒæ€»å’Œæ˜¯1+1+2+2+1+1=8ï¼ŒÃ—2åæ˜¯16ï¼Ÿä¸å¯¹ï¼Œç­‰ä¸€ä¸‹ï¼ŒåŸè¾¹æƒæ˜¯1ï¼ˆ1-3ï¼‰ã€1ï¼ˆ3-6ï¼‰ã€2ï¼ˆ6-7ï¼‰ï¼Œèµ°ä¸¤æ¬¡çš„è¯æ˜¯(1+1+2)Ã—2=8ï¼ŒåŠ ä¸Šèµ·ç‚¹åˆ°3çš„1ï¼Œå†å›1çš„1ï¼Ÿä¸ï¼Œå…¶å®æ­£ç¡®çš„è®¡ç®—æ˜¯ï¼šè·¯å¾„çš„æ€»é•¿åº¦ç­‰äº**æ‰€æœ‰èµ°è¿‡çš„è¾¹çš„è¾¹æƒä¹‹å’ŒÃ—2**å‡å»èµ·ç‚¹åˆ°æœ€è¿œèŠ‚ç‚¹çš„è·ç¦»ï¼ˆå› ä¸ºæœ€åä¸€æ­¥ä¸éœ€è¦è¿”å›ï¼‰ï¼Ÿä¸å¯¹ï¼Œç­‰ä¸€ä¸‹ï¼Œé¢˜ç›®ä¸­çš„æ ·ä¾‹ç¬¬äºŒå¤©çš„æ—¶é—´æ˜¯10ï¼Œè¾“å‡ºæ˜¯7ã€‚åŸè·¯å¾„çš„è¾¹æƒæ€»å’Œæ˜¯1ï¼ˆ1-3ï¼‰+1ï¼ˆ3-6ï¼‰+2ï¼ˆ6-7ï¼‰+2ï¼ˆ7-6ï¼‰+1ï¼ˆ6-3ï¼‰+1ï¼ˆ3-1ï¼‰=8ï¼Œåˆšå¥½ç­‰äºæ—¶é—´10ï¼Ÿä¸å¯¹ï¼Œæ ·ä¾‹è¾“å…¥ä¸­çš„ç¬¬äºŒå¤©æ—¶é—´æ˜¯10ï¼Œè¾“å‡ºæ˜¯7ã€‚å“¦ï¼Œç­‰ä¸€ä¸‹ï¼Œæ ·ä¾‹ä¸­çš„è¾¹æƒæ˜¯ï¼š1-3çš„è¾¹æƒæ˜¯1ï¼Œ3-6æ˜¯1ï¼Œ6-7æ˜¯2ã€‚æ‰€ä»¥è·¯å¾„1->3->6->7->6->3->1çš„æ€»æ—¶é—´æ˜¯1+1+2+2+1+1=8ï¼Œåˆšå¥½å°äºç­‰äº10ï¼Œæ‰€ä»¥å¯ä»¥è·å¾—7çš„ä»·å€¼ï¼ˆ7å·èŠ‚ç‚¹çš„ä»·å€¼æ˜¯7ï¼‰ã€‚å“¦ï¼ŒåŸæ¥è¾¹æƒä¸éœ€è¦Ã—2ï¼Œè€Œæ˜¯**è·¯å¾„çš„æ€»é•¿åº¦ç­‰äºå®é™…èµ°çš„è¾¹æƒä¹‹å’Œ**ï¼Œå› ä¸ºè¿”å›çš„è·¯å¾„å·²ç»åŒ…å«åœ¨é‡Œé¢äº†ã€‚æ¯”å¦‚ï¼Œèµ°1->3->6->7ï¼Œç„¶åè¿”å›1ï¼Œæ€»è·¯å¾„æ˜¯1->3->6->7->6->3->1ï¼Œæ€»è¾¹æƒæ˜¯1+1+2+2+1+1=8ï¼Œåˆšå¥½æ˜¯å»çš„è·¯å¾„ï¼ˆ1->3->6->7ï¼‰çš„è¾¹æƒä¹‹å’Œï¼ˆ1+1+2=4ï¼‰Ã—2ã€‚å“¦ï¼Œå¯¹ï¼æ‰€ä»¥**ä»»ä½•å¾€è¿”è·¯å¾„çš„æ€»è¾¹æƒç­‰äºå»çš„è·¯å¾„çš„è¾¹æƒä¹‹å’ŒÃ—2**ã€‚æ‰€ä»¥ï¼Œé—®é¢˜å¯ä»¥è½¬åŒ–ä¸ºï¼šé€‰æ‹©ä¸€ä¸ª**ä»¥1ä¸ºæ ¹çš„å­æ ‘**ï¼ˆå› ä¸ºè¦è¿”å›ï¼Œæ‰€ä»¥å¿…é¡»æ˜¯è¿é€šçš„ï¼‰ï¼Œä½¿å¾—å­æ ‘çš„è¾¹æƒä¹‹å’ŒÃ—2 â‰¤ æ—¶é—´é™åˆ¶ï¼Œä¸”å­æ ‘ä¸­çš„èŠ‚ç‚¹ä»·å€¼ä¹‹å’Œæœ€å¤§ã€‚å“¦ï¼Œè¿™æ‰æ˜¯æ­£ç¡®çš„è½¬åŒ–ï¼æ¯”å¦‚ï¼Œé€‰æ‹©7å·èŠ‚ç‚¹ï¼Œå»çš„è·¯å¾„æ˜¯1->3->6->7ï¼Œè¾¹æƒä¹‹å’Œæ˜¯1+1+2=4ï¼ŒÃ—2=8â‰¤10ï¼Œä»·å€¼æ˜¯7ã€‚é€‰æ‹©5å·èŠ‚ç‚¹ï¼Œå»çš„è·¯å¾„æ˜¯1->2->5ï¼Œè¾¹æƒä¹‹å’Œæ˜¯2+10=12ï¼ŒÃ—2=24>10ï¼Œæ‰€ä»¥ä¸èƒ½é€‰ã€‚å“¦ï¼ŒåŸæ¥å¦‚æ­¤ï¼æˆ‘ä¹‹å‰çŠ¯äº†ä¸€ä¸ªé”™è¯¯ï¼Œç°åœ¨çº æ­£è¿‡æ¥ï¼š**é—®é¢˜çš„æ ¸å¿ƒæ˜¯é€‰æ‹©ä¸€ä¸ªè¿é€šå­æ ‘ï¼ˆåŒ…å«1å·èŠ‚ç‚¹ï¼‰ï¼Œä½¿å¾—å­æ ‘çš„è¾¹æƒä¹‹å’ŒÃ—2 â‰¤ æ—¶é—´é™åˆ¶ï¼Œä¸”å­æ ‘ä¸­çš„èŠ‚ç‚¹ä»·å€¼ä¹‹å’Œæœ€å¤§**ã€‚å› ä¸ºå­æ ‘çš„è¾¹æƒä¹‹å’Œæ˜¯å»çš„è·¯å¾„çš„æ€»é•¿åº¦ï¼ŒÃ—2å°±æ˜¯å¾€è¿”çš„æ€»æ—¶é—´ã€‚æ¯”å¦‚ï¼Œå­æ ‘åŒ…å«1ã€3ã€6ã€7å·èŠ‚ç‚¹ï¼Œè¾¹æƒä¹‹å’Œæ˜¯1ï¼ˆ1-3ï¼‰+1ï¼ˆ3-6ï¼‰+2ï¼ˆ6-7ï¼‰=4ï¼ŒÃ—2=8â‰¤10ï¼Œä»·å€¼æ˜¯7ï¼ˆ7å·èŠ‚ç‚¹çš„ä»·å€¼ï¼‰ã€‚å­æ ‘åŒ…å«1ã€2ã€5å·èŠ‚ç‚¹ï¼Œè¾¹æƒä¹‹å’Œæ˜¯2ï¼ˆ1-2ï¼‰+10ï¼ˆ2-5ï¼‰=12ï¼ŒÃ—2=24>10ï¼Œæ‰€ä»¥ä¸èƒ½é€‰ã€‚å“¦ï¼Œè¿™æ ·é—®é¢˜å°±è½¬åŒ–ä¸º**æ ‘å½¢èƒŒåŒ…é—®é¢˜**ï¼šæ¯ä¸ªå­æ ‘å¯ä»¥é€‰æ‹©æ˜¯å¦åŒ…å«ï¼Œé€‰æ‹©çš„è¯éœ€è¦åŠ ä¸Šå­æ ‘çš„è¾¹æƒä¹‹å’ŒÃ—2ï¼Œä»¥åŠå­æ ‘çš„ä»·å€¼ä¹‹å’Œã€‚æˆ–è€…æ›´å‡†ç¡®åœ°è¯´ï¼Œ**æ ‘å½¢èƒŒåŒ…çš„çŠ¶æ€æ˜¯`dp[u][j]`è¡¨ç¤ºä»¥uä¸ºæ ¹çš„å­æ ‘ï¼Œé€‰æ‹©ä¸€äº›èŠ‚ç‚¹ï¼ˆåŒ…å«uï¼‰ï¼Œä½¿å¾—è¾¹æƒä¹‹å’ŒÃ—2 â‰¤ jï¼Œè·å¾—çš„æœ€å¤§ä»·å€¼**ã€‚è¿™æ ·ï¼Œè½¬ç§»çš„æ—¶å€™ï¼Œå¯¹äºuçš„æ¯ä¸ªå­èŠ‚ç‚¹vï¼Œæˆ‘ä»¬éœ€è¦è€ƒè™‘æ˜¯å¦é€‰æ‹©vçš„å­æ ‘ï¼šå¦‚æœé€‰æ‹©ï¼Œé‚£ä¹ˆéœ€è¦åŠ ä¸Švåˆ°uçš„è¾¹æƒÃ—2ï¼ˆå› ä¸ºè¦èµ°ä¸¤æ¬¡ï¼šå»vå’Œå›uï¼‰ï¼Œä»¥åŠvå­æ ‘çš„ä»·å€¼ã€‚æ¯”å¦‚ï¼Œuæ˜¯1ï¼Œvæ˜¯3ï¼Œè¾¹æƒæ˜¯1ã€‚é€‰æ‹©vçš„å­æ ‘çš„è¯ï¼Œéœ€è¦åŠ ä¸Š1Ã—2=2çš„æ—¶é—´ï¼Œä»¥åŠvå­æ ‘çš„ä»·å€¼ã€‚è¿™æ ·ï¼Œæ ‘å½¢èƒŒåŒ…çš„è½¬ç§»æ–¹ç¨‹å°±æ˜¯ï¼š`dp[u][j] = max(dp[u][j], dp[u][j - 2*w - k] + dp[v][k])`ï¼Œå…¶ä¸­wæ˜¯uåˆ°vçš„è¾¹æƒï¼Œkæ˜¯vå­æ ‘ç”¨çš„æ—¶é—´ã€‚å“¦ï¼ŒåŸæ¥å¦‚æ­¤ï¼æˆ‘ä¹‹å‰çš„ç†è§£æœ‰è¯¯ï¼Œç°åœ¨çº æ­£è¿‡æ¥äº†ã€‚è¿™å¾ˆé‡è¦ï¼Œå› ä¸ºè¿™ç›´æ¥å½±å“æ ‘å½¢èƒŒåŒ…çš„çŠ¶æ€å®šä¹‰å’Œè½¬ç§»æ–¹ç¨‹ã€‚  

* ğŸ’¡ **å­¦ä¹ ç¬”è®°**ï¼š  
  é—®é¢˜è½¬åŒ–æ˜¯è§£é¢˜çš„å…³é”®â€”â€”æŠŠâ€œå¾€è¿”è·¯å¾„â€è½¬åŒ–ä¸ºâ€œè¿é€šå­æ ‘çš„è¾¹æƒä¹‹å’ŒÃ—2â€ï¼Œè®©é—®é¢˜å˜æˆäº†ç»å…¸çš„æ ‘å½¢èƒŒåŒ…é—®é¢˜ã€‚  

### 2. å…³é”®ç‚¹2ï¼šå¦‚ä½•é€‰æ‹©ç®—æ³•ï¼Ÿ  
* **åˆ†æ**ï¼š  
  æ ¹æ®mï¼ˆæœ‰ä»·å€¼çš„èŠ‚ç‚¹æ•°ï¼‰å’Œæ—¶é—´é™åˆ¶çš„å¤§å°ï¼Œé€‰æ‹©ä¸åŒçš„ç®—æ³•ï¼š  
  - å½“mâ‰¤20æ—¶ï¼Œç”¨**çŠ¶å‹DP**ï¼ˆæšä¸¾æ‰€æœ‰å¯èƒ½çš„èŠ‚ç‚¹ç»„åˆï¼Œè®¡ç®—æ¯ä¸ªç»„åˆçš„è¾¹æƒä¹‹å’ŒÃ—2å’Œä»·å€¼ä¹‹å’Œï¼Œç„¶åæ’åºå›ç­”è¯¢é—®ï¼‰ï¼›  
  - å½“m>20ä½†æ—¶é—´é™åˆ¶å°ï¼ˆæ¯”å¦‚â‰¤100ï¼‰æ—¶ï¼Œç”¨**æ ‘å½¢DP**ï¼ˆæ ‘å½¢èƒŒåŒ…ï¼ŒçŠ¶æ€`dp[u][j]`è¡¨ç¤ºä»¥uä¸ºæ ¹çš„å­æ ‘ç”¨jæ—¶é—´çš„æœ€å¤§ä»·å€¼ï¼‰ã€‚  

* ğŸ’¡ **å­¦ä¹ ç¬”è®°**ï¼š  
  ç®—æ³•é€‰æ‹©è¦ç»“åˆæ•°æ®èŒƒå›´â€”â€”å°mç”¨çŠ¶å‹ï¼Œå°æ—¶é—´ç”¨æ ‘å½¢èƒŒåŒ…ã€‚  

### 3. å…³é”®ç‚¹3ï¼šæ ‘å½¢èƒŒåŒ…çš„çŠ¶æ€è½¬ç§»å¦‚ä½•ä¼˜åŒ–ï¼Ÿ  
* **åˆ†æ**ï¼š  
  æ ‘å½¢èƒŒåŒ…çš„è½¬ç§»æ–¹ç¨‹æ˜¯**åˆ†ç»„èƒŒåŒ…**çš„å½¢å¼ï¼ˆæ¯ä¸ªå­èŠ‚ç‚¹æ˜¯ä¸€ä¸ªç»„ï¼Œé€‰æ‹©è¯¥ç»„çš„æŸä¸ªå®¹é‡ï¼‰ã€‚ä¸ºäº†é¿å…é‡å¤è®¡ç®—ï¼Œéœ€è¦**é€†åºæšä¸¾èƒŒåŒ…å®¹é‡**ï¼ˆä»å¤§åˆ°å°ï¼‰ã€‚æ¯”å¦‚ï¼Œå¯¹äºçˆ¶èŠ‚ç‚¹uçš„å®¹é‡jï¼Œæšä¸¾å­èŠ‚ç‚¹vçš„å®¹é‡kæ—¶ï¼Œjè¦ä»å¤§åˆ°å°éå†ï¼Œè¿™æ ·ä¸ä¼šè¦†ç›–æœªä½¿ç”¨çš„çŠ¶æ€ã€‚  

* ğŸ’¡ **å­¦ä¹ ç¬”è®°**ï¼š  
  é€†åºæšä¸¾èƒŒåŒ…å®¹é‡æ˜¯æ ‘å½¢èƒŒåŒ…çš„å…³é”®ä¼˜åŒ–ï¼Œé¿å…é‡å¤è®¡ç®—ã€‚  


## 4. C++æ ¸å¿ƒä»£ç å®ç°èµæ

### æœ¬é¢˜é€šç”¨æ ¸å¿ƒC++å®ç°å‚è€ƒï¼ˆæ ‘å½¢DPï¼‰  
* **è¯´æ˜**ï¼š  
  æœ¬ä»£ç æ¥è‡ªmrsrzçš„Task2ï¼Œæ˜¯æ ‘å½¢DPçš„å…¸å‹å®ç°ï¼Œé€‚åˆm>20ä¸”æ—¶é—´é™åˆ¶å°çš„æƒ…å†µã€‚  
* **å®Œæ•´æ ¸å¿ƒä»£ç **ï¼š  
  ```cpp
  #include<cstdio>
  #include<cctype>
  #include<cstring>
  #include<vector>
  #include<algorithm>
  using namespace std;
  
  const int N=5005;
  int n,m,T;
  int val[N]; // èŠ‚ç‚¹ä»·å€¼
  int dp[N][52]; // dp[u][j]ï¼šä»¥uä¸ºæ ¹çš„å­æ ‘ï¼Œç”¨jæ—¶é—´çš„æœ€å¤§ä»·å€¼
  struct edge{ int to,nxt,dis; }e[200005];
  int head[N],cnt=0;
  
  inline void add(int u,int v,int w){
      e[++cnt]=(edge){v,head[u],w};
      head[u]=cnt;
  }
  
  void dfs(int now,int pre){
      // åˆå§‹åŒ–ï¼šåªé€‰nowèŠ‚ç‚¹ï¼Œæ—¶é—´ä¸º0ï¼ˆå› ä¸ºè¾¹æƒÃ—2ï¼Œæ‰€ä»¥åˆå§‹æ—¶é—´æ˜¯0ï¼‰ï¼Œä»·å€¼æ˜¯val[now]
      for(int i=0;i<=50;i++) dp[now][i] = val[now];
      // éå†å­èŠ‚ç‚¹
      for(int i=head[now];i;i=e[i].nxt){
          int v=e[i].to;
          if(v==pre) continue;
          dfs(v,now); // å¤„ç†å­æ ‘v
          // é€†åºæšä¸¾çˆ¶èŠ‚ç‚¹çš„å®¹é‡jï¼ˆé¿å…é‡å¤è®¡ç®—ï¼‰
          for(int j=50;j>=e[i].dis*2;j--){
              // æšä¸¾å­èŠ‚ç‚¹çš„å®¹é‡k
              for(int k=0;k<=50-e[i].dis*2;k++){
                  if(j - k - e[i].dis*2 >=0){
                      dp[now][j] = max(dp[now][j], dp[now][j - k - e[i].dis*2] + dp[v][k]);
                  }
              }
          }
      }
  }
  
  int main(){
      n=readint(),m=readint(),T=readint();
      for(int i=1,u,v,t;i<n;i++){
          u=readint(),v=readint(),t=readint();
          add(u,v,t); add(v,u,t);
      }
      memset(val,0,sizeof val);
      for(int i=0;i<m;i++){
          int pos=readint();
          val[pos]=readint();
      }
      memset(dp,0,sizeof dp);
      dfs(1,0);
      for(;T--;){
          int tim=readint();
          printf("%d\n",dp[1][tim/2]); // å› ä¸ºæ—¶é—´æ˜¯è¾¹æƒä¹‹å’ŒÃ—2ï¼Œæ‰€ä»¥tim/2æ˜¯è¾¹æƒä¹‹å’Œ
      }
      return 0;
  }
  ```
* **ä»£ç è§£è¯»æ¦‚è¦**ï¼š  
  1. **è¾“å…¥å¤„ç†**ï¼šè¯»å–æ ‘çš„ç»“æ„å’ŒèŠ‚ç‚¹ä»·å€¼ï¼›  
  2. **DFSåˆå§‹åŒ–**ï¼šæ¯ä¸ªèŠ‚ç‚¹çš„åˆå§‹çŠ¶æ€æ˜¯åªé€‰è‡ªå·±ï¼Œæ—¶é—´ä¸º0ï¼Œä»·å€¼ä¸ºè‡ªå·±çš„ä»·å€¼ï¼›  
  3. **å­æ ‘åˆå¹¶**ï¼šå¯¹äºæ¯ä¸ªå­èŠ‚ç‚¹ï¼Œé€†åºæšä¸¾çˆ¶èŠ‚ç‚¹çš„å®¹é‡ï¼Œåˆå¹¶å­æ ‘çš„çŠ¶æ€ï¼ˆåŠ ä¸Šå­èŠ‚ç‚¹çš„è¾¹æƒÃ—2çš„æ—¶é—´å’Œå­æ ‘çš„ä»·å€¼ï¼‰ï¼›  
  4. **å›ç­”è¯¢é—®**ï¼šå¯¹äºæ¯ä¸ªæ—¶é—´é™åˆ¶ï¼Œè¾“å‡ºæ ¹èŠ‚ç‚¹ï¼ˆ1å·ï¼‰çš„æœ€å¤§ä»·å€¼ï¼ˆæ—¶é—´é™¤ä»¥2ï¼Œå› ä¸ºæ—¶é—´æ˜¯è¾¹æƒä¹‹å’ŒÃ—2ï¼‰ã€‚  

### é¢˜è§£ä¸€ï¼šCQ_Bobçš„è™šæ ‘+æ ‘å½¢èƒŒåŒ…ï¼ˆæ ¸å¿ƒä»£ç ç‰‡æ®µï¼‰  
* **äº®ç‚¹**ï¼šç”¨è™šæ ‘å‹ç¼©èŠ‚ç‚¹æ•°ï¼Œæ ‘å½¢èƒŒåŒ…å¤„ç†å­æ ‘åˆå¹¶ã€‚  
* **æ ¸å¿ƒä»£ç ç‰‡æ®µ**ï¼š  
  ```cpp
  // è™šæ ‘æ„å»º
  il void build(){
      len=m;
      b[++len]=1; // åŠ å…¥æ ¹èŠ‚ç‚¹1
      sort(b+1,b+len+1,[](int x,int y){ return dfn[x]<dfn[y]; }); // æŒ‰dfnæ’åº
      for(re int i=2;i<=len;i++) b[++len]=lca(b[i],b[i-1]); // åŠ å…¥LCA
      sort(b+1,b+len+1,[](int x,int y){ return dfn[x]<dfn[y]; }); // é‡æ–°æ’åº
      len=unique(b+1,b+len+1)-(b+1); // å»é‡
      for(re int i=1;i<=len;i++) id[b[i]]=i,rev[i]=b[i]; // æ˜ å°„è™šæ ‘èŠ‚ç‚¹
      for(re int i=1;i<len;i++){
          int l=lca(b[i],b[i+1]);
          E[id[l]].push_back({i+1,dis[b[i+1]]-dis[l]}); // è™šæ ‘è¾¹æƒæ˜¯åŸæ ‘è·ç¦»
      }
  }
  
  // æ ‘å½¢èƒŒåŒ…
  il void dfs2(int u,int s){
      siz[u]=0;
      dp1[u][0]=val[rev[u]]; // åˆå§‹çŠ¶æ€ï¼šåªé€‰uèŠ‚ç‚¹
      for(auto v:E[u]){
          dfs2(v.x,s); // å¤„ç†å­æ ‘v
          // é€†åºæšä¸¾çˆ¶èŠ‚ç‚¹å®¹é‡
          for(re int w=min(M,siz[u]+v.y+siz[v.x]);w>=0;w--){
              for(re int x=0;x<=min(w-v.y,siz[u]);x++){
                  dp1[u][w]=max(dp1[u][w],dp1[u][x]+dp1[v.x][w-v.y-x]);
              }
          }
          siz[u]+=v.y+siz[v.x]; // æ›´æ–°å­æ ‘å¤§å°
      }
      // å‰ç¼€æœ€å¤§å€¼ä¼˜åŒ–ï¼ˆè®©è¯¢é—®å¯ä»¥O(1)å›ç­”ï¼‰
      for(re int i=1;i<=M;i++) dp1[u][i]=max(dp1[u][i],dp1[u][i-1]);
  }
  ```
* **ä»£ç è§£è¯»**ï¼š  
  - **è™šæ ‘æ„å»º**ï¼šé€šè¿‡æ’åºdfnã€åŠ å…¥LCAã€å»é‡ï¼Œå¾—åˆ°è™šæ ‘ï¼ˆåªä¿ç•™æœ‰ä»·å€¼çš„èŠ‚ç‚¹å’Œå¿…è¦çš„ç¥–å…ˆèŠ‚ç‚¹ï¼‰ï¼›  
  - **æ ‘å½¢èƒŒåŒ…**ï¼šæ¯ä¸ªè™šæ ‘èŠ‚ç‚¹çš„åˆå§‹çŠ¶æ€æ˜¯åªé€‰è‡ªå·±ï¼Œç„¶ååˆå¹¶å­æ ‘ï¼ˆåŠ ä¸Šå­æ ‘çš„è¾¹æƒå’Œæ—¶é—´ï¼‰ï¼Œæœ€åç”¨å‰ç¼€æœ€å¤§å€¼ä¼˜åŒ–ï¼Œè®©è¯¢é—®å¯ä»¥O(1)å›ç­”ã€‚  
* ğŸ’¡ **å­¦ä¹ ç¬”è®°**ï¼š  
  è™šæ ‘æ˜¯å¤„ç†â€œåªæœ‰éƒ¨åˆ†èŠ‚ç‚¹æœ‰ç”¨â€çš„æ ‘é—®é¢˜çš„æœ‰æ•ˆå·¥å…·ï¼Œå¯ä»¥å¤§å¤§å‡å°‘è®¡ç®—é‡ã€‚  

### é¢˜è§£äºŒï¼šmrsrzçš„çŠ¶å‹DPï¼ˆæ ¸å¿ƒä»£ç ç‰‡æ®µï¼‰  
* **äº®ç‚¹**ï¼šç”¨çŠ¶å‹æšä¸¾æ‰€æœ‰èŠ‚ç‚¹ç»„åˆï¼Œè®¡ç®—æ¯ä¸ªç»„åˆçš„æ—¶é—´å’Œä»·å€¼ã€‚  
* **æ ¸å¿ƒä»£ç ç‰‡æ®µ**ï¼š  
  ```cpp
  // çŠ¶å‹æšä¸¾æ‰€æœ‰ç»„åˆ
  void dfs(int now,int zt,int value){
      if(now==m){
          // è®¡ç®—å½“å‰ç»„åˆçš„æ—¶é—´ï¼ˆé€šè¿‡æ–°æ ‘çš„colorå‡½æ•°ï¼‰
          ++G.tot;
          int tim=0;
          for(int i=zt,nx;i;i^=1<<nx){
              nx=__builtin_ctz(i);
              tim+=G.color(G.pos[nx]);
          }
          p[zt]=(zzt){value,tim<<1}; // æ—¶é—´Ã—2
          return;
      }
      // ä¸é€‰ç¬¬nowä¸ªèŠ‚ç‚¹
      dfs(now+1,zt,value);
      // é€‰ç¬¬nowä¸ªèŠ‚ç‚¹
      dfs(now+1,zt|(1<<now),value+val[now]);
  }
  ```
* **ä»£ç è§£è¯»**ï¼š  
  - **çŠ¶å‹æšä¸¾**ï¼šç”¨äºŒè¿›åˆ¶ä½`zt`è¡¨ç¤ºæ˜¯å¦é€‰ç¬¬`now`ä¸ªèŠ‚ç‚¹ï¼ˆ`1<<now`è¡¨ç¤ºé€‰ï¼‰ï¼›  
  - **æ—¶é—´è®¡ç®—**ï¼šé€šè¿‡æ–°æ ‘çš„`color`å‡½æ•°ï¼ˆè®¡ç®—èŠ‚ç‚¹åˆ°LCAçš„è·ç¦»ï¼‰å¾—åˆ°å½“å‰ç»„åˆçš„æ—¶é—´ï¼›  
  - **å­˜å‚¨ç»“æœ**ï¼šå°†æ¯ä¸ªç»„åˆçš„ä»·å€¼å’Œæ—¶é—´å­˜å‚¨åœ¨`p`æ•°ç»„ä¸­ï¼Œä¹‹åæ’åºå›ç­”è¯¢é—®ã€‚  
* ğŸ’¡ **å­¦ä¹ ç¬”è®°**ï¼š  
  çŠ¶å‹DPé€‚åˆmå°çš„æƒ…å†µï¼Œæšä¸¾æ‰€æœ‰ç»„åˆæ˜¯å…³é”®ã€‚  


## 5. ç®—æ³•å¯è§†åŒ–ï¼šåƒç´ åŠ¨ç”»æ¼”ç¤º (æ ¸å¿ƒéƒ¨åˆ†)

### åŠ¨ç”»æ¼”ç¤ºä¸»é¢˜ï¼šåƒç´ æ ‘çš„â€œèƒŒåŒ…æ•´ç†â€æ¸¸æˆ  
**è®¾è®¡æ€è·¯**ï¼š  
ç”¨8ä½åƒç´ é£æ ¼æ¨¡æ‹Ÿæ ‘å½¢èƒŒåŒ…çš„è¿‡ç¨‹ï¼Œè®©å­¦ä¹ è€…åƒâ€œæ•´ç†ä¹¦åŒ…â€ä¸€æ ·ï¼ŒæŠŠå­æ ‘çš„â€œç‰©å“â€ï¼ˆä»·å€¼ï¼‰æ”¾è¿›çˆ¶èŠ‚ç‚¹çš„â€œèƒŒåŒ…â€ï¼ˆæ—¶é—´å®¹é‡ï¼‰é‡Œã€‚åŠ å…¥æ¸¸æˆåŒ–å…ƒç´ ï¼ˆæ¯”å¦‚â€œå•æ­¥æ‰§è¡Œâ€â€œè‡ªåŠ¨æ’­æ”¾â€â€œéŸ³æ•ˆâ€ï¼‰ï¼Œå¢å¼ºè¶£å‘³æ€§ã€‚  

### åŠ¨ç”»å¸§æ­¥éª¤ä¸äº¤äº’å…³é”®ç‚¹  
1. **åœºæ™¯åˆå§‹åŒ–**ï¼š  
   - å±å¹•å·¦ä¾§æ˜¾ç¤º**åƒç´ æ ‘**ï¼ˆæ ¹èŠ‚ç‚¹1åœ¨é¡¶éƒ¨ï¼Œå­èŠ‚ç‚¹å‘ä¸‹æ’åˆ—ï¼Œè¾¹ç”¨ç°è‰²çº¿æ¡è¿æ¥ï¼ŒèŠ‚ç‚¹ç”¨å½©è‰²æ–¹å—è¡¨ç¤ºï¼šç»¿è‰²=æœªé€‰ï¼Œçº¢è‰²=é€‰ä¸­ï¼‰ï¼›  
   - å±å¹•å³ä¾§æ˜¾ç¤º**èƒŒåŒ…é¢æ¿**ï¼ˆå®¹é‡æ¡æ˜¾ç¤ºå½“å‰å¯ç”¨æ—¶é—´ï¼Œä»·å€¼æ¡æ˜¾ç¤ºå½“å‰è·å¾—çš„ä»·å€¼ï¼‰ï¼›  
   - åº•éƒ¨æœ‰**æ§åˆ¶é¢æ¿**ï¼ˆâ€œå¼€å§‹/æš‚åœâ€â€œå•æ­¥â€â€œé‡ç½®â€æŒ‰é’®ï¼Œé€Ÿåº¦æ»‘å—ï¼‰ã€‚  

2. **ç®—æ³•å¯åŠ¨**ï¼š  
   - æ ¹èŠ‚ç‚¹1å˜æˆçº¢è‰²ï¼ˆè¡¨ç¤ºé€‰ä¸­ï¼‰ï¼ŒèƒŒåŒ…é¢æ¿æ˜¾ç¤ºä»·å€¼=val[1]ï¼Œæ—¶é—´=0ï¼›  
   - æ’­æ”¾â€œå®â€çš„éŸ³æ•ˆï¼ˆè¡¨ç¤ºé€‰ä¸­èŠ‚ç‚¹ï¼‰ã€‚  

3. **å­æ ‘åˆå¹¶ï¼ˆä»¥èŠ‚ç‚¹1å’Œå­èŠ‚ç‚¹3ä¸ºä¾‹ï¼‰**ï¼š  
   - èŠ‚ç‚¹3å˜æˆçº¢è‰²ï¼ˆè¡¨ç¤ºé€‰ä¸­å­æ ‘3ï¼‰ï¼Œè¾¹1-3é—ªçƒï¼ˆè¡¨ç¤ºè¦è®¡ç®—è¾¹æƒï¼‰ï¼›  
   - èƒŒåŒ…é¢æ¿çš„æ—¶é—´å¢åŠ ï¼ˆè¾¹æƒÃ—2ï¼Œæ¯”å¦‚1Ã—2=2ï¼‰ï¼Œä»·å€¼å¢åŠ ï¼ˆå­æ ‘3çš„ä»·å€¼ï¼‰ï¼›  
   - æ’­æ”¾â€œå“—å•¦â€çš„éŸ³æ•ˆï¼ˆè¡¨ç¤ºåˆå¹¶å­æ ‘ï¼‰ã€‚  

4. **çŠ¶æ€è½¬ç§»**ï¼š  
   - èƒŒåŒ…é¢æ¿çš„å®¹é‡æ¡ä»å¤§åˆ°å°ç§»åŠ¨ï¼ˆè¡¨ç¤ºé€†åºæšä¸¾å®¹é‡ï¼‰ï¼Œä»·å€¼æ¡éšä¹‹å˜åŒ–ï¼ˆè¡¨ç¤ºåˆå¹¶åçš„æœ€å¤§ä»·å€¼ï¼‰ï¼›  
   - ç”¨â€œ+â€â€œ-â€ç¬¦å·æç¤ºæ—¶é—´å’Œä»·å€¼çš„å˜åŒ–ï¼ˆæ¯”å¦‚â€œ+2æ—¶é—´â€â€œ+5ä»·å€¼â€ï¼‰ã€‚  

5. **ç›®æ ‡è¾¾æˆ**ï¼š  
   - å½“å¤„ç†å®Œæ‰€æœ‰å­èŠ‚ç‚¹ï¼ŒèƒŒåŒ…é¢æ¿æ˜¾ç¤ºæ ¹èŠ‚ç‚¹çš„æœ€å¤§ä»·å€¼å’Œæ—¶é—´ï¼›  
   - æ’­æ”¾â€œèƒœåˆ©â€éŸ³æ•ˆï¼ˆä¸Šæ‰¬çš„8ä½éŸ³ä¹ï¼‰ï¼ŒèŠ‚ç‚¹1é—ªçƒï¼ˆè¡¨ç¤ºå®Œæˆï¼‰ã€‚  

### äº¤äº’è®¾è®¡  
- **å•æ­¥æ‰§è¡Œ**ï¼šç‚¹å‡»â€œä¸‹ä¸€æ­¥â€æŒ‰é’®ï¼ŒåŠ¨ç”»èµ°ä¸€æ­¥ï¼ˆæ¯”å¦‚å¤„ç†ä¸€ä¸ªå­èŠ‚ç‚¹ï¼‰ï¼›  
- **è‡ªåŠ¨æ’­æ”¾**ï¼šç‚¹å‡»â€œå¼€å§‹â€æŒ‰é’®ï¼ŒåŠ¨ç”»è‡ªåŠ¨æ‰§è¡Œï¼ˆé€Ÿåº¦å¯é€šè¿‡æ»‘å—è°ƒèŠ‚ï¼‰ï¼›  
- **é‡ç½®**ï¼šç‚¹å‡»â€œé‡ç½®â€æŒ‰é’®ï¼Œå›åˆ°åˆå§‹çŠ¶æ€ï¼›  
- **ç®—æ³•æ¯”è¾ƒ**ï¼šå¦‚æœæœ‰å¤šç§ç®—æ³•ï¼ˆæ¯”å¦‚çŠ¶å‹å’Œæ ‘å½¢DPï¼‰ï¼Œå¯ä»¥åˆ‡æ¢æ˜¾ç¤ºï¼Œå¯¹æ¯”å®ƒä»¬çš„æ‰§è¡Œè¿‡ç¨‹ã€‚  


## 6. æ‹“å±•ç»ƒä¹ ä¸ç›¸ä¼¼é—®é¢˜æ€è€ƒ

### é€šç”¨æ€è·¯/æŠ€å·§è¿ç§»  
- **æ ‘å½¢èƒŒåŒ…**ï¼šé€‚ç”¨äºâ€œæ ‘ç»“æ„ä¸Šçš„é€‰æ‹©é—®é¢˜â€ï¼ˆæ¯”å¦‚é€‰èŠ‚ç‚¹ã€é€‰è¾¹ï¼Œæ»¡è¶³æŸäº›æ¡ä»¶ï¼Œè·å¾—æœ€å¤§ä»·å€¼ï¼‰ï¼›  
- **çŠ¶å‹DP**ï¼šé€‚ç”¨äºâ€œå°é›†åˆçš„æšä¸¾é—®é¢˜â€ï¼ˆæ¯”å¦‚é€‰kä¸ªèŠ‚ç‚¹ï¼Œæ»¡è¶³æŸäº›æ¡ä»¶ï¼Œè·å¾—æœ€å¤§ä»·å€¼ï¼‰ï¼›  
- **è¾¹æƒÃ—2çš„å¤„ç†**ï¼šé€‚ç”¨äºâ€œå¿…é¡»è¿”å›èµ·ç‚¹â€çš„è·¯å¾„é—®é¢˜ï¼ˆæ¯”å¦‚æ—…è¡Œå•†é—®é¢˜ã€æ ‘çš„éå†é—®é¢˜ï¼‰ã€‚  

### ç»ƒä¹ æ¨è (æ´›è°·)  
1. **æ´›è°· P1352 æ²¡æœ‰ä¸Šå¸çš„èˆä¼š**  
   - ğŸ—£ï¸ **æ¨èç†ç”±**ï¼šæ ‘å½¢DPçš„ç»å…¸é¢˜ç›®ï¼Œç»ƒä¹ â€œé€‰æ‹©èŠ‚ç‚¹ä¸é€‰çˆ¶èŠ‚ç‚¹â€çš„çŠ¶æ€è½¬ç§»ï¼Œå·©å›ºæ ‘å½¢DPçš„åŸºç¡€ã€‚  
2. **æ´›è°· P2014 é€‰è¯¾**  
   - ğŸ—£ï¸ **æ¨èç†ç”±**ï¼šæ ‘å½¢èƒŒåŒ…çš„ç»å…¸é¢˜ç›®ï¼Œç»ƒä¹ â€œåˆ†ç»„èƒŒåŒ…â€çš„è½¬ç§»ï¼Œå·©å›ºé€†åºæšä¸¾å®¹é‡çš„æŠ€å·§ã€‚  
3. **æ´›è°· P1171 å”®è´§å‘˜çš„éš¾é¢˜**  
   - ğŸ—£ï¸ **æ¨èç†ç”±**ï¼šçŠ¶å‹DPçš„ç»å…¸é¢˜ç›®ï¼Œç»ƒä¹ â€œæšä¸¾æ‰€æœ‰è·¯å¾„ç»„åˆâ€çš„æŠ€å·§ï¼Œå·©å›ºçŠ¶å‹DPçš„åº”ç”¨ã€‚  


## 7. å­¦ä¹ å¿ƒå¾—ä¸ç»éªŒåˆ†äº« (è‹¥æœ‰)

### å‚è€ƒç»éªŒ (æ¥è‡ªmrsrzçš„é¢˜è§£)  
> â€œæˆ‘åœ¨è§£å†³è¿™ä¸ªé—®é¢˜æ—¶ï¼Œæœ€åˆæ²¡æœ‰æƒ³åˆ°åˆ†æƒ…å†µå¤„ç†ï¼Œå¯¼è‡´ä»£ç è¶…æ—¶ã€‚åæ¥é€šè¿‡åˆ†ææ•°æ®èŒƒå›´ï¼Œå‘ç°mâ‰¤20æ—¶ç”¨çŠ¶å‹ï¼Œm>20æ—¶ç”¨æ ‘å½¢DPï¼Œè¿™æ ·å°±èƒ½é€šè¿‡æ‰€æœ‰æµ‹è¯•ç‚¹ã€‚â€  

**ç‚¹è¯„**ï¼š  
è¿™ä½ä½œè€…çš„ç»éªŒå¾ˆå…¸å‹â€”â€”**æ•°æ®èŒƒå›´æ˜¯ç®—æ³•é€‰æ‹©çš„å…³é”®**ã€‚å½“é‡åˆ°é—®é¢˜æ—¶ï¼Œå…ˆçœ‹æ•°æ®èŒƒå›´ï¼ˆæ¯”å¦‚mçš„å¤§å°ã€æ—¶é—´çš„é™åˆ¶ï¼‰ï¼Œå†é€‰æ‹©åˆé€‚çš„ç®—æ³•ï¼ˆçŠ¶å‹æˆ–æ ‘å½¢DPï¼‰ï¼Œè¿™æ ·èƒ½é¿å…ä¸å¿…è¦çš„è¶…æ—¶ã€‚  


## ç»“è¯­  
æœ¬æ¬¡å…³äºâ€œZrz_orz Loves Secondary Elementâ€çš„C++è§£é¢˜åˆ†æå°±åˆ°è¿™é‡Œã€‚å¸Œæœ›è¿™ä»½å­¦ä¹ æŒ‡å—èƒ½å¸®åŠ©å¤§å®¶æ›´å¥½åœ°ç†è§£æ ‘å½¢DPå’ŒçŠ¶å‹DPçš„åº”ç”¨ï¼ŒæŒæ¡â€œå¾€è¿”è·¯å¾„â€é—®é¢˜çš„è½¬åŒ–æŠ€å·§ã€‚è®°ä½ï¼Œç¼–ç¨‹èƒ½åŠ›çš„æå‡åœ¨äº**æŒç»­å­¦ä¹ ã€å‹¤äºæ€è€ƒå’Œå‹‡äºå®è·µ**ã€‚ä¸‹æ¬¡æˆ‘ä»¬å†ä¸€èµ·æ¢ç´¢æ–°çš„ç¼–ç¨‹æŒ‘æˆ˜ï¼ğŸ’ª

---
å¤„ç†ç”¨æ—¶ï¼š217.99ç§’
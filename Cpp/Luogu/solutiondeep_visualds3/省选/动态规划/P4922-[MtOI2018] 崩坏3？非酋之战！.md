# 题目信息

# [MtOI2018] 崩坏3？非酋之战！

## 题目背景

原题面因为太丑，被 disangan233 于 2019/09/26 修改。

在 2018 年暑假的时候，disangan233 肝了一个暑假的崩坏 3，他的帐号终于 $50$ 级啦！他终于把他的逆神巫女肝到 S 啦！

因为庆祝崩坏 3 登上 APP Store Top1，米忽悠给全服玩家发放了 $5$ 张扩充补给卡。

在玄学233聊天室发送了 "怒 grass 大伟出奇迹！" 之后就……单抽出律化娜了。

![Screenshot_20180804-124812.png](https://i.loli.net/2019/08/24/3s2AKqOQNUMGLcF.png)


## 题目描述

在崩坏 3 中有一个叫做天命基地的地方，女武神们将在基地中~~开派对~~与敌人们厮杀。

女武神们的攻击力为 $atk$，她们将进行资源保卫战！

天命基地中有 $1$个 boss，boss 的血量为 $hp$，boss 不会攻击女武神。

现在有一条长度为 $n$ 的道路，道路的一头是 boss，另外一头是女武神需要保卫的资源，最开始 boss 每秒将会向资源移动 1 个单位长度。女武神们需要保护资源，所以她们要攻击 boss。 

我们将整条道路分成 $n$ 个格子，最开始资源在第 $n$ 格，女武神在第 $1$ 格，boss 在第 $0$ 格。

因为女武神的手太短了，所以只有当 boss 到达女武神当前那一格的时候，女武神才会攻击 boss，攻击完之后女武神会后退一格。

女武神有以下 $8$ 种攻击方式（每一格只能使用一种攻击方式）        

* 技能，造成 $80\% atk$ 的伤害，并使 boss 获得 $1$ 层燃烧 buff，在之后的每秒钟额外受到 $10\% atk$ 的伤害。(燃烧buff可以叠加)        
* 闪避，造成 $70\% atk$ 的伤害，并使 boss 时间暂停 $5s$。（$5s$ 内 boss 无法移动且仍会受到燃烧伤害）      
* 大招，造成 $120\% atk$ 的伤害，使 boss 时间暂停 $5s$。       
* 分支攻击，造成 $70\% atk$ 的伤害，并使 boss 时空减速，使 boss 经过每一个格子的时间增加 $1s$。    
* 爱酱的炸弹，使 boss 获得 $1$ 层燃烧 buff，并使 boss 愤怒，移速 $+50\%$。     
* 犹大的誓约，造成 $60\% atk$ 的伤害，如果 boss 有燃烧 buff 则减少 1 层，使 boss 时间暂停 $4s$。       
* 奥托之光，造成 $10\% atk$ 的伤害，如果 boss 有燃烧 buff 则清除 buff，使 boss 时间暂停 $10s$。     
* 律者之力，造成 $80\% atk$ 的伤害，使 boss 的移动速度 $+100\%$。

现在给你所有的信息，让你帮助 disangan233 蒟蒻算一下，他的女武神能否在 boss 触碰到资源前战胜 boss。

如果可以，输出 boss 死亡时距离资源最远的格子编号。如果不可以，请输出对 boss 造成的最大伤害。    

## 说明/提示

#### 样例解释 $3$

开局 1 个技能，再来 1 个大招。

#### 样例解释 $4$

开局 1 个技能，再来 2 个大招。

### 子任务

对于 $10\%$ 的数据，保证：

$$
n\leq 10 \qquad  \max Atk\leq 10^{7}-1
$$     

对于 $20\%$ 的数据，保证：

$$
n\leq 300 \qquad \max Atk\leq 2^{32}-1
$$     

对于 $40\%$ 的数据，保证：

$$
n\leq 1,000 \qquad \max Atk\leq 2^{63}-1
$$     
对于 $70\%$ 的数据，保证：

$$
n\leq 5,000 \qquad \max Atk\leq 2^{63}-1
$$  

对于 $100\%$ 的数据，保证：

$$
n\leq 10,000 \qquad atk\equiv 0(\bmod\ 10)\qquad  atk\leq 10,000\qquad \max Atk\leq 2^{64}-1
$$  

### 题目来源

[MtOI2018 迷途の家の水题大赛](https://www.luogu.org/contest/11260) T4

出题人：disangan233

验题人：CYJian

72679

## 样例 #1

### 输入

```
1
1000 100```

### 输出

```
120
MiHoYo Was Destroyed!```

## 样例 #2

### 输入

```
10
1000 0```

### 输出

```
0
MiHoYo Was Destroyed!```

## 样例 #3

### 输入

```
10
198 100```

### 输出

```
2
Tech Otakus Save The World!```

## 样例 #4

### 输入

```
3
23333 100```

### 输出

```
440
MiHoYo Was Destroyed!```

## 样例 #5

### 输入

```
100
19260817 2330```

### 输出

```
99
Tech Otakus Save The World!```

# AI分析结果

# 💡 Kay的C++算法解析：[MtOI2018] 崩坏3？非酋之战！ 深入学习指南 💡


## 1. 题目解读与核心算法识别

✨ **本题主要考察**：动态规划（DP）+ 贪心策略  

🗣️ **初步分析**：  
解决这道题的核心是**“如何选择攻击方式，让女武神在boss到达资源前打出最高伤害”**。就像打游戏时，我们会先叠“增益buff”（比如燃烧、减速），再放“终极大招”——因为大招的“时停”效果能最大化利用之前的buff，打出爆炸伤害。  

### 核心思路拆解：
1. **排除无用技能**：8种攻击方式中，“闪避”伤害比大招低，“爱酱的炸弹”会加速boss，“奥托之光”清除燃烧buff，这些都不如“技能”“大招”“分支攻击”有用（技能增加燃烧层数，分支攻击增加减速，大招造成高伤害并时停）。  
2. **贪心排序**：**大招必须放在最后使用**！因为大招的“时停5秒”能让boss在这段时间继续受到燃烧伤害，而如果先放大招，后续的buff无法叠加，伤害会更低（用“邻项交换法”可以证明：交换大招和技能的顺序，大招在后的伤害更高）。  
3. **动态规划计算最大伤害**：用`dp[i][j]`表示使用`i`次技能、`j`次分支攻击后的**最大伤害**（`i+j ≤ n`，`n`是攻击次数）。通过滚动数组优化空间（将二维数组压缩为一维），避免内存超限。  

### 可视化设计思路：
我们用**8位像素风**（类似FC红白机）设计动画，展示算法流程：  
- **场景**：网格道路（0~n格），boss（红色像素块）从0格出发，女武神（蓝色）在1格，资源（绿色）在n格。  
- **关键动画**：  
  - 技能攻击：女武神发射红色子弹，boss身上的“燃烧层数”（数字）+1，伴随“叮”的音效。  
  - 分支攻击：女武神发射蓝色子弹，boss的“减速效果”（移动速度条）变长，伴随“吱”的音效。  
  - 大招攻击：boss闪烁（表示时停），屏幕弹出“大招！”字样，血量条快速减少，伴随“轰”的音效。  
- **交互**：提供“单步执行”（逐次攻击）、“自动播放”（加速演示）、“重置”按钮，以及“速度滑块”（调整动画速度）。  


## 2. 精选优质题解参考

### 题解一（来源：lenlen，赞24）  
* **点评**：  
  这份题解的**思路清晰度**和**逻辑严谨性**非常突出！作者首先用“邻项交换法”严格证明了“大招应放在最后”的结论（比如比较“大招+技能”和“技能+大招”的伤害，后者更高），这是解决问题的关键。代码中用**滚动数组**（`dp[i&1][j]`）优化了空间（从`O(n²)`压缩到`O(n)`），处理了`n=1e4`的大数据。变量命名（如`a`表示技能伤害、`c`表示分支伤害）清晰，注释到位，非常适合初学者理解。  

### 题解二（来源：disangan233，赞20）  
* **点评**：  
  题解的**算法有效性**和**代码规范性**值得学习。作者提出了两个“引理”（引理1：只需要技能、大招、分支攻击；引理2：大招应放在最后），逻辑严密。代码中用`f[2][10005]`实现滚动数组，`check`函数计算最大伤害，结构清晰。此外，作者还提到了“卡常数”（如用`unsigned long long`处理大整数），这对竞赛编程很有帮助。  

### 题解三（来源：谋事在人，赞8）  
* **点评**：  
  这份题解的**实践价值**很高！作者考虑了**边界情况**（如`atk=0`的特判），避免了除以零错误。状态定义（`dp[now][j]`表示当前使用`j`次技能的最大伤害）直观，用`vis`数组处理初值（避免赋无效值），代码鲁棒性强。此外，作者详细证明了“大招顺序”的正确性，有助于理解贪心策略的本质。  


## 3. 核心难点辨析与解题策略

### 1. 难点1：如何排除无用技能？  
* **分析**：  
  题目中的8种技能中，很多是“无效”或“负面”的。比如“闪避”的伤害（70%atk）比大招（120%atk）低，且时停时间相同（5秒），所以“闪避”完全可以被“大招”替代；“爱酱的炸弹”会加速boss（移速+50%），这会让boss更快到达资源，显然不如“技能”（增加燃烧层数）有用。  
* 💡 **解决策略**：  
  逐一分析每种技能的**伤害**和**效果**，比较优劣。比如：  
  - 技能（80%atk + 燃烧+1）> 爱酱的炸弹（0伤害 + 燃烧+1 + 移速+50%）；  
  - 大招（120%atk + 时停5秒）> 闪避（70%atk + 时停5秒）。  

### 2. 难点2：为什么大招要放在最后？  
* **分析**：  
  大招的“时停5秒”能让boss在这段时间继续受到燃烧伤害。如果先放大招，后续的技能无法叠加燃烧层数，燃烧伤害会减少。比如：  
  - 顺序1：大招→技能：燃烧伤害=1层×5秒（大招时停） + 2层×1秒（技能后boss移动）；  
  - 顺序2：技能→大招：燃烧伤害=1层×1秒（技能后boss移动） + 2层×5秒（大招时停）。  
  显然顺序2的燃烧伤害更高。  
* 💡 **解决策略**：  
  用“邻项交换法”证明：交换任意两个相邻的“大招”和“非大招”技能，大招在后的伤害更高。因此，所有大招应放在最后。  

### 3. 难点3：如何设计DP状态并优化空间？  
* **分析**：  
  直接定义`dp[i][j]`表示使用`i`次技能、`j`次分支攻击后的最大伤害，空间复杂度为`O(n²)`（`n=1e4`时，`1e8`的数组会超内存）。  
* 💡 **解决策略**：  
  使用**滚动数组**优化：因为`dp[i][j]`只依赖于`dp[i-1][j]`（前一次技能）和`dp[i][j-1]`（前一次分支攻击），所以可以用`dp[now][j]`和`dp[next][j]`交替存储，空间复杂度降低到`O(n)`。  


## 4. C++核心代码实现赏析

### 本题通用核心C++实现参考  
* **说明**：综合了lenlen、disangan233等题解的思路，采用滚动数组优化，逻辑清晰，适合初学者参考。  
* **完整核心代码**：  
  ```cpp
  #include <iostream>
  #include <algorithm>
  using namespace std;
  typedef unsigned long long ull;
  const int N = 1e4 + 10;
  ull dp[2][N]; // 滚动数组，dp[now][j]表示使用now次技能、j次分支后的最大伤害
  ull n, hp, atk;
  ull skill, branch, ultimate; // 技能、分支、大招的伤害（预处理后）

  int main() {
      cin >> n >> hp >> atk;
      atk /= 10; // 预处理：因为atk是10的倍数，除以10简化计算
      skill = 8 * atk; // 技能伤害：80%atk = 8*(atk/10)
      branch = 7 * atk; // 分支伤害：70%atk = 7*(atk/10)
      ull max_damage = 0;
      ull min_steps = n + 1; // 最小攻击次数（格子数）

      for (int i = 0; i <= n; i++) { // i：技能次数
          int now = i & 1; // 当前层（滚动数组）
          int prev = (i - 1) & 1; // 前一层
          for (int j = 0; j <= n - i; j++) { // j：分支次数（i+j ≤n）
              if (i == 0 && j == 0) {
                  dp[now][j] = 0; // 初始状态：0次技能，0次分支，伤害0
              } else {
                  dp[now][j] = 0;
                  if (i > 0) { // 从i-1次技能转移
                      ull burn = (i - 1) * (j + 1) * atk; // 燃烧伤害：(i-1)层 × (j+1)秒（减速后）× 10%atk
                      dp[now][j] = max(dp[now][j], dp[prev][j] + skill + burn);
                  }
                  if (j > 0) { // 从j-1次分支转移
                      ull burn = i * j * atk; // 燃烧伤害：i层 × j秒（减速后）× 10%atk
                      dp[now][j] = max(dp[now][j], dp[now][j-1] + branch + burn);
                  }
              }
              // 计算剩下的大招次数（k = n - i - j）的伤害
              ull k = n - i - j;
              ull ultimate_damage = 12 * atk + i * (j + 6) * atk; // 大招伤害：120%atk + i层 × (j+6)秒（减速+时停）×10%atk
              ull total_damage = dp[now][j] + k * ultimate_damage;
              max_damage = max(max_damage, total_damage);
              // 判断是否能击杀boss
              if (total_damage >= hp) {
                  ull steps = i + j + max((ull)0, (hp - dp[now][j] + ultimate_damage - 1) / ultimate_damage);
                  min_steps = min(min_steps, steps);
              }
          }
      }

      if (min_steps <= n) {
          cout << min_steps << endl << "Tech Otakus Save The World!" << endl;
      } else {
          cout << max_damage * 10 << endl << "MiHoYo Was Destroyed!" << endl; // 还原atk（×10）
      }
      return 0;
  }
  ```  
* **代码解读概要**：  
  1. **预处理**：将`atk`除以10（因为题目保证`atk`是10的倍数），简化伤害计算（如80%atk变为8×(atk/10)）。  
  2. **滚动数组**：用`dp[now][j]`存储当前技能次数`i`、分支次数`j`的最大伤害，`now = i & 1`（0或1）实现滚动。  
  3. **状态转移**：从`i-1`次技能（`dp[prev][j]`）或`j-1`次分支（`dp[now][j-1]`）转移，计算当前伤害（技能/分支伤害 + 燃烧伤害）。  
  4. **计算大招伤害**：剩下的`k = n - i - j`次大招，每次伤害为`12×atk + i×(j+6)×atk`（120%atk + 燃烧伤害），总伤害为`dp[now][j] + k×ultimate_damage`。  
  5. **判断结果**：如果`min_steps ≤n`（能在n格内击杀boss），输出最小格子数；否则输出最大伤害（还原×10）。  


## 5. 算法可视化：像素动画演示 (核心部分)

### 动画演示主题  
**《像素女武神的 buff 大计》**（8位像素风，类似FC游戏《魂斗罗》）  

### 核心演示内容  
1. **场景初始化**：  
   - 屏幕显示`n+1`格的网格（0~n格），资源在n格（绿色像素块），女武神在1格（蓝色像素块），boss在0格（红色像素块）。  
   - 控制面板：“开始/暂停”“单步”“重置”按钮，“速度滑块”（1~5倍速），“伤害显示”（当前总伤害）。  
   - 背景音乐：8位风格的轻快旋律（如《超级马里奥》的背景音乐）。  

2. **算法执行流程**：  
   - **步骤1：boss移动**：boss从0格向1格移动（每秒1格），伴随“沙沙”的脚步声。  
   - **步骤2：女武神攻击**：当boss到达1格时，女武神选择“技能”（红色子弹）攻击，boss的“燃烧层数”（屏幕右上角数字）从0变为1，伴随“叮”的音效。攻击后，女武神后退到2格。  
   - **步骤3：分支攻击**：boss移动到2格时，女武神选择“分支攻击”（蓝色子弹），boss的“减速效果”（移动速度条）变长（每格需要2秒），伴随“吱”的音效。  
   - **步骤4：大招攻击**：当使用完所有技能和分支攻击后，女武神选择“大招”（黄色爆炸），boss闪烁（表示时停5秒），血量条快速减少（每帧减少10%），伴随“轰”的音效。  
   - **步骤5：结果判断**：如果boss血量归0，屏幕弹出“胜利！”字样，播放胜利音效（如《塞尔达传说》的胜利旋律）；否则，boss继续移动，直到到达n格（失败）。  

### 游戏化元素设计  
- **关卡系统**：将攻击过程分为“叠buff阶段”（技能+分支）和“大招阶段”，完成“叠buff阶段”视为“通关第一关”，给予“星星奖励”（像素星星闪烁）。  
- **积分系统**：每打出一次高伤害（如燃烧伤害超过总伤害的50%），给予“连击分”（+100分），鼓励玩家优化攻击顺序。  


## 6. 拓展练习与相似问题思考

### 通用思路/技巧迁移  
本题的**“贪心+DP”**思路可以迁移到以下场景：  
1. **合并果子**（洛谷P1090）：选择最优的合并顺序，使总代价最小（贪心选最小的两堆，DP计算总代价）。  
2. **皇后游戏**（洛谷P2123）：排序皇后的工作顺序，使总时间最小（贪心证明排序规则，DP计算总时间）。  
3. **递增序列**（洛谷P3902）：选择最优的操作（加1或减1），使序列递增（贪心选择操作方向，DP计算最小操作次数）。  

### 练习推荐 (洛谷)  
1. **洛谷 P1090** - 《合并果子》  
   🗣️ **推荐理由**：这道题是“贪心+优先队列”的经典问题，类似本题“选择最优顺序”的思路，能帮助你巩固贪心策略的应用。  
2. **洛谷 P2123** - 《皇后游戏》  
   🗣️ **推荐理由**：本题需要证明“排序规则”（类似本题“大招顺序”的证明），并结合DP计算总时间，是很好的思维拓展练习。  
3. **洛谷 P3902** - 《递增序列》  
   🗣️ **推荐理由**：这道题需要用DP计算最小操作次数，类似本题“计算最大伤害”的思路，能帮助你熟悉DP状态的设计。  


## 7. 学习心得与经验分享 (若有)

### 参考经验 (来自 lenlen)  
> “我在解决这个问题时，最初没想到用‘邻项交换法’证明大招顺序，后来通过比较‘大招+技能’和‘技能+大招’的伤害，才发现大招在后的伤害更高。这让我意识到，**贪心策略的正确性需要严格证明**，不能凭感觉。”  

**点评**：  
这位作者的经验很重要！贪心策略往往看起来“直观”，但必须通过**数学证明**（如邻项交换法）验证其正确性。比如本题的“大招顺序”，如果不证明，可能会误以为“先放大招也可以”，导致错误。  


## 结语  
本次关于“[MtOI2018] 崩坏3？非酋之战！”的分析就到这里。希望这份指南能帮助你理解“DP+贪心”的核心思路，掌握滚动数组优化、邻项交换法等技巧。记住：**编程的乐趣在于“解决问题”，而不是“记住代码”**——多思考、多练习，你会越来越厉害！💪  

下次我们再一起探索新的编程挑战！

---
处理用时：180.47秒
# é¢˜ç›®ä¿¡æ¯

# [NOIP2021] æ–¹å·®

## é¢˜ç›®æè¿°

ç»™å®šé•¿åº¦ä¸º $n$ çš„éä¸¥æ ¼é€’å¢æ­£æ•´æ•°æ•°åˆ— $1 \le a_1 \le a_2 \le \cdots \le a_n$ã€‚æ¯æ¬¡å¯ä»¥è¿›è¡Œçš„æ“ä½œæ˜¯ï¼šä»»æ„é€‰æ‹©ä¸€ä¸ªæ­£æ•´æ•° $1 < i < n$ï¼Œå°† $a_i$ å˜ä¸º $a_{i - 1} + a_{i + 1} - a_i$ã€‚æ±‚åœ¨è‹¥å¹²æ¬¡æ“ä½œä¹‹åï¼Œè¯¥æ•°åˆ—çš„æ–¹å·®æœ€å°å€¼æ˜¯å¤šå°‘ã€‚è¯·è¾“å‡ºæœ€å°å€¼ä¹˜ä»¥ $n^2$ çš„ç»“æœã€‚

å…¶ä¸­æ–¹å·®çš„å®šä¹‰ä¸ºï¼šæ•°åˆ—ä¸­æ¯ä¸ªæ•°ä¸å¹³å‡å€¼çš„å·®çš„å¹³æ–¹çš„å¹³å‡å€¼ã€‚æ›´å½¢å¼åŒ–åœ°è¯´ï¼Œæ–¹å·®çš„å®šä¹‰ä¸º $D = \frac{1}{n} \sum_{i = 1}^{n} {(a_i - \bar a)}^2$ï¼Œå…¶ä¸­ $\bar a = \frac{1}{n} \sum_{i = 1}^{n} a_i$ã€‚

## è¯´æ˜/æç¤º

**ã€æ ·ä¾‹è§£é‡Š #1ã€‘**

å¯¹äº $(a_1, a_2, a_3, a_4) = (1, 2, 4, 6)$ï¼Œç¬¬ä¸€æ¬¡æ“ä½œå¾—åˆ°çš„æ•°åˆ—æœ‰ $(1, 3, 4, 6)$ï¼Œç¬¬äºŒæ¬¡æ“ä½œå¾—åˆ°çš„æ–°çš„æ•°åˆ—æœ‰ $(1, 3, 5, 6)$ã€‚ä¹‹åæ— æ³•å¾—åˆ°æ–°çš„æ•°åˆ—ã€‚

å¯¹äº $(a_1, a_2, a_3, a_4) = (1, 2, 4, 6)$ï¼Œå¹³å‡å€¼ä¸º $\frac{13}{4}$ï¼Œæ–¹å·®ä¸º $\frac{1}{4}({(1 - \frac{13}{4})}^2 + {(2 - \frac{13}{4})}^2 + {(4 - \frac{13}{4})}^2 + {(6 - \frac{13}{4})}^2) = \frac{59}{16}$ã€‚

å¯¹äº $(a_1, a_2, a_3, a_4) = (1, 3, 4, 6)$ï¼Œå¹³å‡å€¼ä¸º $\frac{7}{2}$ï¼Œæ–¹å·®ä¸º $\frac{1}{4} ({(1 - \frac{7}{2})}^2 + {(3 - \frac{7}{2})}^2 + {(4 - \frac{7}{2})}^2 + {(6 - \frac{7}{2})}^2) = \frac{13}{4}$ã€‚

å¯¹äº $(a_1, a_2, a_3, a_4) = (1, 3, 5, 6)$ï¼Œå¹³å‡å€¼ä¸º $\frac{15}{4}$ï¼Œæ–¹å·®ä¸º $\frac{1}{4} ({(1 - \frac{15}{4})}^2 + {(3 - \frac{15}{4})}^2 + {(5 - \frac{15}{4})}^2 + {(6 - \frac{15}{4})}^2) = \frac{59}{16}$ã€‚

**ã€æ•°æ®èŒƒå›´ã€‘**

| æµ‹è¯•ç‚¹ç¼–å· | $n \le$ | $a_i \le$ |
|:-:|:-:|:-:|
| $1 \sim 3$ | $4$ | $10$ |
| $4 \sim 5$ | $10$ | $40$ |
| $6 \sim 8$ | $15$ | $20$ |
| $9 \sim 12$ | $20$ | $300$ |
| $13 \sim 15$ | $50$ | $70$ |
| $16 \sim 18$ | $100$ | $40$ |
| $19 \sim 22$ | $400$ | $600$ |
| $23 \sim 25$ | ${10}^4$ | $50$ |

å¯¹äºæ‰€æœ‰çš„æ•°æ®ï¼Œä¿è¯ $1 \le n \le {10}^4$ï¼Œ$1 \le a_i \le 600$ã€‚

## æ ·ä¾‹ #1

### è¾“å…¥

```
4
1 2 4 6
```

### è¾“å‡º

```
52
```

## æ ·ä¾‹ #2

### è¾“å…¥

```
è§é™„ä»¶ä¸­çš„ variance/variance2.in```

### è¾“å‡º

```
è§é™„ä»¶ä¸­çš„ variance/variance2.ans```

## æ ·ä¾‹ #3

### è¾“å…¥

```
è§é™„ä»¶ä¸­çš„ variance/variance3.in```

### è¾“å‡º

```
è§é™„ä»¶ä¸­çš„ variance/variance3.ans```

## æ ·ä¾‹ #4

### è¾“å…¥

```
è§é™„ä»¶ä¸­çš„ variance/variance4.in```

### è¾“å‡º

```
è§é™„ä»¶ä¸­çš„ variance/variance4.ans```

# AIåˆ†æç»“æœ

# ğŸ’¡ Kayçš„C++ç®—æ³•è§£æï¼š[NOIP2021] æ–¹å·® æ·±å…¥å­¦ä¹ æŒ‡å— ğŸ’¡


## 1. é¢˜ç›®è§£è¯»ä¸æ ¸å¿ƒç®—æ³•è¯†åˆ«

âœ¨ **æœ¬é¢˜ä¸»è¦è€ƒå¯Ÿ**ï¼šåŠ¨æ€è§„åˆ’ï¼ˆDPï¼‰+ å·®åˆ†æ•°ç»„æ€§è´¨åº”ç”¨  

ğŸ—£ï¸ **åˆæ­¥åˆ†æ**ï¼š  
è§£å†³â€œæ–¹å·®â€é—®é¢˜çš„å…³é”®ï¼Œåœ¨äº**å‘ç°æ“ä½œçš„æœ¬è´¨**å’Œ**åŒ–ç®€æ–¹å·®å¼å­**ã€‚  
- **æ“ä½œæœ¬è´¨**ï¼šæ¯æ¬¡å°†`a[i]`å˜ä¸º`a[i-1]+a[i+1]-a[i]`ï¼Œç­‰ä»·äº**äº¤æ¢å·®åˆ†æ•°ç»„çš„ç›¸é‚»ä¸¤é¡¹**ï¼ˆå·®åˆ†æ•°ç»„`d[i] = a[i+1]-a[i]`ï¼‰ã€‚å› æ­¤ï¼Œæˆ‘ä»¬å¯ä»¥**ä»»æ„é‡æ’å·®åˆ†æ•°ç»„**ï¼Œå¯»æ‰¾ä½¿æ–¹å·®æœ€å°çš„æ’åˆ—ã€‚  
- **æ–¹å·®åŒ–ç®€**ï¼šé¢˜ç›®è¦æ±‚è¾“å‡º`nÂ²Ã—æ–¹å·®`ï¼Œé€šè¿‡ä»£æ•°æ¨å¯¼å¯å¾—ï¼š  
  $$nÂ²Ã—D = n\sum_{i=1}^n a_iÂ² - (\sum_{i=1}^n a_i)Â²$$  
  è¿™ä¸ªå¼å­**é¿å…äº†æµ®ç‚¹è¿ç®—**ï¼Œç›´æ¥ç”¨æ•´æ•°è®¡ç®—å³å¯ã€‚  

**æ ¸å¿ƒç®—æ³•æ€è·¯**ï¼š  
ä¸ºäº†ä½¿æ–¹å·®æœ€å°ï¼Œæ•°åˆ—åº”å°½å¯èƒ½â€œé›†ä¸­â€åœ¨å¹³å‡å€¼é™„è¿‘ã€‚é€šè¿‡åˆ†æï¼ˆæˆ–æ‰“è¡¨ï¼‰å‘ç°ï¼Œ**æœ€ä¼˜å·®åˆ†æ•°ç»„å‘ˆâ€œå•è°·â€ç»“æ„**ï¼ˆä»å°åˆ°å¤§æ’åºåï¼Œä¾æ¬¡æ”¾åœ¨å½“å‰åºåˆ—çš„æœ€å·¦è¾¹æˆ–æœ€å³è¾¹ï¼‰ã€‚å› æ­¤ï¼Œæˆ‘ä»¬å¯ä»¥ç”¨**åŠ¨æ€è§„åˆ’**ç»´æŠ¤â€œæ”¾ç½®å‰`i`ä¸ªå·®åˆ†â€æ—¶çš„**æ€»å’Œ**å’Œ**å¹³æ–¹å’Œæœ€å°å€¼**ï¼Œä»è€Œæ‰¾åˆ°æœ€ä¼˜è§£ã€‚  

**å¯è§†åŒ–è®¾è®¡æ€è·¯**ï¼š  
ç”¨**8ä½åƒç´ é£æ ¼**å±•ç¤ºå·®åˆ†æ’åºåçš„æ”¾ç½®è¿‡ç¨‹ï¼š  
- å·¦ä¾§å’Œå³ä¾§åˆ†åˆ«ç”¨â€œè“è‰²â€å’Œâ€œçº¢è‰²â€åƒç´ å—è¡¨ç¤ºå¾…æ”¾ç½®çš„å·®åˆ†ï¼›  
- å®æ—¶æ˜¾ç¤ºå½“å‰æ€»å’Œï¼ˆ`sum`ï¼‰ã€å¹³æ–¹å’Œï¼ˆ`sos`ï¼‰å’Œæ–¹å·®ï¼ˆ`nÃ—sos - sumÂ²`ï¼‰ï¼›  
- æ”¾ç½®å·®åˆ†æ—¶æœ‰â€œå®â€ï¼ˆå·¦ï¼‰æˆ–â€œå’šâ€ï¼ˆå³ï¼‰çš„åƒç´ éŸ³æ•ˆï¼Œå®Œæˆæ—¶æ’­æ”¾â€œèƒœåˆ©â€éŸ³æ•ˆï¼›  
- æ”¯æŒâ€œå•æ­¥æ‰§è¡Œâ€å’Œâ€œè‡ªåŠ¨æ’­æ”¾â€ï¼Œè®©ä½ ç›´è§‚çœ‹åˆ°`sum`å’Œ`sos`çš„å˜åŒ–ã€‚  


## 2. ç²¾é€‰ä¼˜è´¨é¢˜è§£å‚è€ƒ

### é¢˜è§£ä¸€ï¼šMoYuFangï¼ˆèµï¼š134ï¼‰  
* **ç‚¹è¯„**ï¼š  
  è¿™ä»½é¢˜è§£æ˜¯**åŠ¨æ€è§„åˆ’çš„æ ‡å‡†å®ç°**ï¼Œæ€è·¯æ¸…æ™°ä¸”ä»£ç è§„èŒƒã€‚ä½œè€…é¦–å…ˆåŒ–ç®€äº†æ–¹å·®å¼å­ï¼Œç„¶åé€šè¿‡åˆ†æå·®åˆ†æ•°ç»„çš„æ€§è´¨ï¼Œæå‡ºâ€œå•è°·â€ç»“æ„çš„çŒœæƒ³ã€‚DPçŠ¶æ€å®šä¹‰ä¸º`f(i, s)`ï¼ˆå‰`i`ä¸ªå·®åˆ†ï¼Œæ€»å’Œä¸º`s`æ—¶çš„æœ€å°å¹³æ–¹å’Œï¼‰ï¼Œå¹¶é€šè¿‡**æ»šåŠ¨æ•°ç»„**ä¼˜åŒ–ç©ºé—´ï¼ˆå°†äºŒç»´æ•°ç»„å‹ç¼©ä¸ºä¸€ç»´ï¼‰ã€‚æ­¤å¤–ï¼Œä½œè€…è·³è¿‡äº†`0`å·®åˆ†ï¼ˆå› ä¸º`0`ä¸å½±å“æ€»å’Œå’Œå¹³æ–¹å’Œï¼‰ï¼Œè¿›ä¸€æ­¥ä¼˜åŒ–äº†æ—¶é—´å¤æ‚åº¦ã€‚ä»£ç ä¸­çš„å˜é‡å‘½åï¼ˆå¦‚`f`è¡¨ç¤ºDPæ•°ç»„ã€`sd`è¡¨ç¤ºå·®åˆ†å’Œï¼‰æ¸…æ™°æ˜“æ‡‚ï¼Œè¾¹ç•Œå¤„ç†ä¸¥è°¨ï¼Œæ˜¯å­¦ä¹ DPä¼˜åŒ–çš„å¥½ä¾‹å­ã€‚  

### é¢˜è§£äºŒï¼špigstdï¼ˆèµï¼š113ï¼‰  
* **ç‚¹è¯„**ï¼š  
  ä½œè€…çš„èµ›æ—¶æ€è·¯éå¸¸çœŸå®ï¼Œä»â€œå·®åˆ†é‡æ’â€åˆ°â€œDPçŠ¶æ€é€‰æ‹©â€çš„æ€è€ƒè¿‡ç¨‹å¾ˆæœ‰å¯å‘æ€§ã€‚ä»–å¼ºè°ƒâ€œ`0`å·®åˆ†æ— éœ€å¤„ç†â€ï¼Œå› ä¸º`0`æ”¾åœ¨å·¦å³ä¸¤è¾¹çš„æ•ˆæœç›¸åŒï¼Œè¿™ä¸€ä¼˜åŒ–è®©DPçš„æ—¶é—´å¤æ‚åº¦ä»`O(nÂ²a)`é™ä½åˆ°`O(naÂ²)`ï¼ˆ`a`ä¸º`a[i]`çš„æœ€å¤§å€¼ï¼‰ã€‚æ­¤å¤–ï¼Œä½œè€…æåˆ°â€œå°†ä¸€ç»´çŠ¶æ€ï¼ˆæ€»å’Œï¼‰çº³å…¥DPâ€ï¼Œè¿™æ˜¯è§£å†³æ­¤ç±»é—®é¢˜çš„å…³é”®â€”â€”é€šè¿‡ç»´æŠ¤æ€»å’Œï¼Œæˆ‘ä»¬å¯ä»¥å¿«é€Ÿè®¡ç®—å¹³æ–¹å’Œçš„å˜åŒ–ã€‚  

### é¢˜è§£ä¸‰ï¼šsyksykCCCï¼ˆèµï¼š36ï¼‰  
* **ç‚¹è¯„**ï¼š  
  è¿™ä»½é¢˜è§£çš„**æ¨å¯¼è¿‡ç¨‹éå¸¸è¯¦ç»†**ï¼Œä»æ–¹å·®å¼å­çš„åŒ–ç®€åˆ°DPè½¬ç§»æ–¹ç¨‹çš„æ¨å¯¼ï¼Œæ¯ä¸€æ­¥éƒ½è®²å¾—å¾ˆæ¸…æ¥šã€‚ä½œè€…æ˜ç¡®æŒ‡å‡ºâ€œå•è°·ç»“æ„â€çš„æ„Ÿæ€§ç†è§£ï¼ˆæ•°åˆ—è¶‹å‘äºå¹³å‡å€¼ï¼‰ï¼Œå¹¶ç»™å‡ºäº†DPè½¬ç§»çš„ä¸¤ç§æƒ…å†µï¼ˆæ”¾å·¦è¾¹æˆ–å³è¾¹ï¼‰ï¼š  
  - æ”¾å·¦è¾¹ï¼šæ‰€æœ‰æ•°åŠ `d[i]`ï¼Œå¹³æ–¹å’Œå¢åŠ `iÃ—d[i]Â² + 2Ã—sumÃ—d[i]`ï¼›  
  - æ”¾å³è¾¹ï¼šæ–°å¢æ•°`sum+d[i]`ï¼Œå¹³æ–¹å’Œå¢åŠ `(sum+d[i])Â²`ã€‚  
  è¿™ç§â€œåˆ†æƒ…å†µè®¨è®ºâ€çš„æ–¹å¼ï¼Œè®©DPè½¬ç§»çš„é€»è¾‘æ›´åŠ ç›´è§‚ã€‚  


## 3. æ ¸å¿ƒéš¾ç‚¹è¾¨æä¸è§£é¢˜ç­–ç•¥

### 1. **éš¾ç‚¹1ï¼šå‘ç°æ“ä½œçš„æœ¬è´¨ï¼ˆå·®åˆ†æ•°ç»„äº¤æ¢ï¼‰**  
* **åˆ†æ**ï¼š  
  å¾ˆå¤šåŒå­¦ä¼šè¢«å›°åœ¨â€œæ“ä½œèƒ½æ”¹å˜ä»€ä¹ˆâ€çš„é—®é¢˜ä¸Šã€‚é€šè¿‡æ‰‹ç©æ ·ä¾‹ï¼ˆæ¯”å¦‚å°†`a[2]`å˜ä¸º`a[1]+a[3]-a[2]`ï¼‰ï¼Œå¯ä»¥å‘ç°å·®åˆ†æ•°ç»„çš„ç›¸é‚»ä¸¤é¡¹å‘ç”Ÿäº†äº¤æ¢ã€‚è¿™ä¸€æ­¥æ˜¯è§£é¢˜çš„å…³é”®ï¼Œå› ä¸ºå®ƒå°†é—®é¢˜è½¬åŒ–ä¸ºâ€œé‡æ’å·®åˆ†æ•°ç»„â€ï¼Œä»è€Œé™ä½äº†å¤æ‚åº¦ã€‚  
* ğŸ’¡ **å­¦ä¹ ç¬”è®°**ï¼šæ“ä½œçš„æœ¬è´¨å¾€å¾€éšè—åœ¨å¼å­å˜å½¢ä¸­ï¼Œå¤šæ‰‹ç©æ ·ä¾‹èƒ½å¸®åŠ©å‘ç°è§„å¾‹ã€‚  

### 2. **éš¾ç‚¹2ï¼šåŒ–ç®€æ–¹å·®å¼å­ï¼ˆé¿å…æµ®ç‚¹è¿ç®—ï¼‰**  
* **åˆ†æ**ï¼š  
  ç›´æ¥è®¡ç®—æ–¹å·®ä¼šæ¶‰åŠæµ®ç‚¹è¿ç®—ï¼Œå®¹æ˜“å‡ºé”™ä¸”æ•ˆç‡ä½ã€‚é€šè¿‡ä»£æ•°æ¨å¯¼å°†`nÂ²Ã—æ–¹å·®`è½¬åŒ–ä¸º`nâˆ‘aÂ² - (âˆ‘a)Â²`ï¼Œä¸ä»…é¿å…äº†æµ®ç‚¹è¿ç®—ï¼Œè¿˜å°†é—®é¢˜è½¬åŒ–ä¸ºç»´æŠ¤â€œæ€»å’Œâ€å’Œâ€œå¹³æ–¹å’Œâ€çš„æœ€å°å€¼ï¼Œè¿™æ˜¯DPçš„åŸºç¡€ã€‚  
* ğŸ’¡ **å­¦ä¹ ç¬”è®°**ï¼šé‡åˆ°æµ®ç‚¹é—®é¢˜æ—¶ï¼Œå…ˆå°è¯•ä»£æ•°åŒ–ç®€ï¼Œçœ‹çœ‹èƒ½å¦è½¬åŒ–ä¸ºæ•´æ•°è®¡ç®—ã€‚  

### 3. **éš¾ç‚¹3ï¼šDPçŠ¶æ€çš„å®šä¹‰ä¸è½¬ç§»**  
* **åˆ†æ**ï¼š  
  DPçŠ¶æ€çš„é€‰æ‹©æ˜¯å…³é”®ã€‚è¿™é‡Œæˆ‘ä»¬é€‰æ‹©`f(i, s)`è¡¨ç¤ºâ€œå‰`i`ä¸ªå·®åˆ†ï¼Œæ€»å’Œä¸º`s`æ—¶çš„æœ€å°å¹³æ–¹å’Œâ€ï¼Œå› ä¸ºï¼š  
  - æ€»å’Œ`s`æ˜¯è®¡ç®—æ–¹å·®çš„å¿…è¦æ¡ä»¶ï¼›  
  - å¹³æ–¹å’Œæ˜¯æ–¹å·®å¼å­çš„ä¸€éƒ¨åˆ†ï¼Œç»´æŠ¤å…¶æœ€å°å€¼å°±èƒ½å¾—åˆ°æœ€ä¼˜è§£ã€‚  
  è½¬ç§»æ–¹ç¨‹çš„æ¨å¯¼éœ€è¦è€ƒè™‘â€œæ”¾å·¦è¾¹â€å’Œâ€œæ”¾å³è¾¹â€ä¸¤ç§æƒ…å†µï¼Œè¿™éœ€è¦å¯¹å¹³æ–¹å’Œçš„å˜åŒ–æœ‰æ¸…æ™°çš„è®¤è¯†ï¼ˆæ¯”å¦‚æ”¾å·¦è¾¹æ—¶ï¼Œæ‰€æœ‰æ•°åŠ `d[i]`ï¼Œå¹³æ–¹å’Œçš„å˜åŒ–æ˜¯`iÃ—d[i]Â² + 2Ã—sumÃ—d[i]`ï¼‰ã€‚  
* ğŸ’¡ **å­¦ä¹ ç¬”è®°**ï¼šDPçŠ¶æ€åº”åŒ…å«â€œå½±å“ç»“æœçš„å…³é”®å˜é‡â€ï¼ˆå¦‚æ€»å’Œã€å¹³æ–¹å’Œï¼‰ï¼Œè½¬ç§»æ–¹ç¨‹éœ€åˆ†æƒ…å†µè®¨è®ºã€‚  


## 4. C++æ ¸å¿ƒä»£ç å®ç°èµæ

### æœ¬é¢˜é€šç”¨æ ¸å¿ƒC++å®ç°å‚è€ƒ  
* **è¯´æ˜**ï¼šç»¼åˆäº†MoYuFangã€pigstdç­‰é¢˜è§£çš„æ€è·¯ï¼Œé‡‡ç”¨æ»šåŠ¨æ•°ç»„ä¼˜åŒ–ï¼Œè·³è¿‡`0`å·®åˆ†ï¼Œæ˜¯æœ€ç®€æ´çš„DPå®ç°ã€‚  
* **å®Œæ•´æ ¸å¿ƒä»£ç **ï¼š  
  ```cpp
  #include <iostream>
  #include <vector>
  #include <algorithm>
  #include <cstring>
  using namespace std;
  typedef long long ll;
  const ll INF = 1e18;
  const int N = 1e4 + 5, MAX_S = 5e5 + 5;

  int main() {
      int n; cin >> n;
      vector<int> a(n + 1), d(n);
      for (int i = 1; i <= n; i++) cin >> a[i];
      for (int i = 0; i < n - 1; i++) d[i] = a[i + 2] - a[i + 1];
      sort(d.begin(), d.end());

      vector<ll> f(MAX_S, INF);
      f[0] = 0;
      ll sum_d = 0;
      int cnt = 0;
      for (int i = 0; i < n - 1; i++) {
          if (d[i] == 0) continue; // è·³è¿‡0å·®åˆ†
          cnt++;
          sum_d += d[i];
          vector<ll> g(MAX_S, INF);
          for (int s = 0; s < MAX_S; s++) {
              if (f[s] == INF) continue;
              // æ”¾å·¦è¾¹ï¼šæ€»å’Œå¢åŠ cnt*d[i]ï¼Œå¹³æ–¹å’Œå¢åŠ cnt*d[i]^2 + 2*s*d[i]
              if (s + (ll)cnt * d[i] < MAX_S) {
                  g[s + (ll)cnt * d[i]] = min(g[s + (ll)cnt * d[i]], f[s] + (ll)cnt * d[i] * d[i] + 2 * (ll)s * d[i]);
              }
              // æ”¾å³è¾¹ï¼šæ€»å’Œå¢åŠ sum_dï¼Œå¹³æ–¹å’Œå¢åŠ sum_d^2
              if (s + sum_d < MAX_S) {
                  g[s + sum_d] = min(g[s + sum_d], f[s] + sum_d * sum_d);
              }
          }
          f = move(g);
      }

      ll ans = INF;
      for (int s = 0; s < MAX_S; s++) {
          if (f[s] != INF) {
              ans = min(ans, (ll)n * f[s] - (ll)s * s);
          }
      }
      cout << ans << endl;
      return 0;
  }
  ```
* **ä»£ç è§£è¯»æ¦‚è¦**ï¼š  
  1. è¯»å–è¾“å…¥å¹¶è®¡ç®—å·®åˆ†æ•°ç»„`d`ï¼›  
  2. æ’åºå·®åˆ†æ•°ç»„ï¼ˆä¸ºå•è°·ç»“æ„åšå‡†å¤‡ï¼‰ï¼›  
  3. åˆå§‹åŒ–DPæ•°ç»„`f`ï¼ˆ`f[s]`è¡¨ç¤ºæ€»å’Œä¸º`s`æ—¶çš„æœ€å°å¹³æ–¹å’Œï¼‰ï¼›  
  4. éå†æ¯ä¸ªé`0`å·®åˆ†ï¼Œç”¨æ»šåŠ¨æ•°ç»„`g`æ›´æ–°DPçŠ¶æ€ï¼ˆæ”¾å·¦è¾¹æˆ–å³è¾¹ï¼‰ï¼›  
  5. è®¡ç®—æ‰€æœ‰å¯èƒ½çš„`s`å¯¹åº”çš„æ–¹å·®ï¼Œå–æœ€å°å€¼ã€‚  


### é¢˜è§£ä¸€ï¼ˆMoYuFangï¼‰ä»£ç ç‰‡æ®µèµæ  
* **äº®ç‚¹**ï¼šæ»šåŠ¨æ•°ç»„ä¼˜åŒ–ç©ºé—´ï¼Œè·³è¿‡`0`å·®åˆ†ã€‚  
* **æ ¸å¿ƒä»£ç ç‰‡æ®µ**ï¼š  
  ```cpp
  vector<ll> f(MAX_S, INF);
  f[0] = 0;
  ll sum_d = 0;
  int cnt = 0;
  for (int i = 0; i < n - 1; i++) {
      if (d[i] == 0) continue;
      cnt++;
      sum_d += d[i];
      vector<ll> g(MAX_S, INF);
      for (int s = 0; s < MAX_S; s++) {
          if (f[s] == INF) continue;
          // æ”¾å·¦è¾¹
          if (s + (ll)cnt * d[i] < MAX_S) {
              g[s + (ll)cnt * d[i]] = min(g[s + (ll)cnt * d[i]], f[s] + (ll)cnt * d[i] * d[i] + 2 * (ll)s * d[i]);
          }
          // æ”¾å³è¾¹
          if (s + sum_d < MAX_S) {
              g[s + sum_d] = min(g[s + sum_d], f[s] + sum_d * sum_d);
          }
      }
      f = move(g);
  }
  ```
* **ä»£ç è§£è¯»**ï¼š  
  - `f`æ˜¯æ»šåŠ¨æ•°ç»„ï¼Œæ¯æ¬¡å¤„ç†ä¸€ä¸ªå·®åˆ†åï¼Œç”¨`g`æ›´æ–°`f`ï¼›  
  - `cnt`è¡¨ç¤ºå½“å‰å¤„ç†çš„é`0`å·®åˆ†æ•°é‡ï¼Œ`sum_d`è¡¨ç¤ºå½“å‰å·®åˆ†çš„å’Œï¼›  
  - æ”¾å·¦è¾¹æ—¶ï¼Œæ€»å’Œå¢åŠ `cnt*d[i]`ï¼ˆå› ä¸ºæœ‰`cnt`ä¸ªæ•°ï¼Œæ¯ä¸ªåŠ `d[i]`ï¼‰ï¼Œå¹³æ–¹å’Œå¢åŠ `cnt*d[i]Â² + 2*s*d[i]`ï¼ˆæ ¹æ®`(x+d)^2 = xÂ² + 2xd + dÂ²`æ¨å¯¼ï¼‰ï¼›  
  - æ”¾å³è¾¹æ—¶ï¼Œæ€»å’Œå¢åŠ `sum_d`ï¼ˆæ–°å¢çš„æ•°æ˜¯`sum_d`ï¼‰ï¼Œå¹³æ–¹å’Œå¢åŠ `sum_dÂ²`ï¼ˆæ–°å¢æ•°çš„å¹³æ–¹ï¼‰ã€‚  
* ğŸ’¡ **å­¦ä¹ ç¬”è®°**ï¼šæ»šåŠ¨æ•°ç»„æ˜¯ä¼˜åŒ–DPç©ºé—´çš„å¸¸ç”¨æŠ€å·§ï¼Œå°¤å…¶é€‚ç”¨äºâ€œå½“å‰çŠ¶æ€åªä¾èµ–å‰ä¸€çŠ¶æ€â€çš„æƒ…å†µã€‚  


## 5. ç®—æ³•å¯è§†åŒ–ï¼šåƒç´ åŠ¨ç”»æ¼”ç¤ºï¼ˆæ ¸å¿ƒéƒ¨åˆ†ï¼‰

### åŠ¨ç”»æ¼”ç¤ºä¸»é¢˜  
**â€œå·®åˆ†ç§¯æœ¨æ­å»ºæ¸¸æˆâ€**ï¼ˆ8ä½åƒç´ é£æ ¼ï¼Œç±»ä¼¼FCæ¸¸æˆï¼‰  

### æ ¸å¿ƒæ¼”ç¤ºå†…å®¹  
1. **åˆå§‹åœºæ™¯**ï¼š  
   - å±å¹•å·¦ä¾§æ˜¾ç¤ºâ€œå·®åˆ†ç§¯æœ¨â€ï¼ˆæ’åºåçš„`d`æ•°ç»„ï¼Œç”¨ä¸åŒé¢œè‰²è¡¨ç¤ºå¤§å°ï¼Œæ¯”å¦‚`0`æ˜¯ç°è‰²ï¼Œå°çš„å·®åˆ†æ˜¯è“è‰²ï¼Œå¤§çš„æ˜¯çº¢è‰²ï¼‰ï¼›  
   - å±å¹•å³ä¾§æ˜¾ç¤ºâ€œå½“å‰åºåˆ—â€ï¼ˆç”¨åƒç´ å—è¡¨ç¤ºï¼Œåˆå§‹ä¸º`a[1]`ï¼‰ï¼›  
   - åº•éƒ¨æ˜¾ç¤ºâ€œæ€»å’Œï¼ˆsumï¼‰â€â€œå¹³æ–¹å’Œï¼ˆsosï¼‰â€â€œæ–¹å·®ï¼ˆnÃ—sos - sumÂ²ï¼‰â€ã€‚  

2. **æ“ä½œæ¼”ç¤º**ï¼š  
   - **é€‰æ‹©å·®åˆ†**ï¼šç”¨â€œç®­å¤´â€åƒç´ å—æŒ‡å‘å½“å‰è¦æ”¾ç½®çš„å·®åˆ†ï¼›  
   - **æ”¾å·¦è¾¹**ï¼šå·®åˆ†ç§¯æœ¨ä»å·¦ä¾§â€œé£å…¥â€å½“å‰åºåˆ—çš„æœ€å·¦è¾¹ï¼Œæ‰€æœ‰åºåˆ—åƒç´ å—å‘å³ç§»åŠ¨ï¼ŒåŒæ—¶`sum`å’Œ`sos`æ›´æ–°ï¼ˆæ’­æ”¾â€œå®â€çš„éŸ³æ•ˆï¼‰ï¼›  
   - **æ”¾å³è¾¹**ï¼šå·®åˆ†ç§¯æœ¨ä»å³ä¾§â€œé£å…¥â€å½“å‰åºåˆ—çš„æœ€å³è¾¹ï¼Œ`sum`å’Œ`sos`æ›´æ–°ï¼ˆæ’­æ”¾â€œå’šâ€çš„éŸ³æ•ˆï¼‰ï¼›  
   - **è‡ªåŠ¨æ’­æ”¾**ï¼šæŒ‰â€œç©ºæ ¼â€é”®å¯åŠ¨ï¼Œå·®åˆ†ç§¯æœ¨è‡ªåŠ¨æŒ‰å•è°·ç»“æ„æ”¾ç½®ï¼Œç›´åˆ°å®Œæˆã€‚  

3. **ç»“æŸåœºæ™¯**ï¼š  
   - å®Œæˆæ‰€æœ‰å·®åˆ†æ”¾ç½®åï¼Œå½“å‰åºåˆ—çš„åƒç´ å—ä¼šâ€œé—ªçƒâ€ï¼Œå¹¶æ˜¾ç¤ºâ€œæœ€ä¼˜æ–¹å·®ï¼šXXXâ€ï¼ˆæ’­æ”¾â€œèƒœåˆ©â€éŸ³æ•ˆï¼‰ï¼›  
   - æ”¯æŒâ€œé‡ç½®â€æŒ‰é’®ï¼Œé‡æ–°å¼€å§‹æ¼”ç¤ºã€‚  

### è®¾è®¡æ€è·¯  
- **åƒç´ é£æ ¼**ï¼šè¥é€ å¤å¤æ¸¸æˆæ°›å›´ï¼Œé™ä½å­¦ä¹ å‹åŠ›ï¼›  
- **éŸ³æ•ˆåé¦ˆ**ï¼šç”¨ä¸åŒéŸ³æ•ˆå¼ºåŒ–æ“ä½œè®°å¿†ï¼ˆæ¯”å¦‚â€œå®â€å¯¹åº”å·¦è¾¹ï¼Œâ€œå’šâ€å¯¹åº”å³è¾¹ï¼‰ï¼›  
- **å®æ—¶æ•°æ®æ˜¾ç¤º**ï¼šè®©ä½ ç›´è§‚çœ‹åˆ°`sum`å’Œ`sos`çš„å˜åŒ–ï¼Œç†è§£DPçŠ¶æ€çš„å«ä¹‰ï¼›  
- **äº¤äº’æ€§**ï¼šæ”¯æŒå•æ­¥å’Œè‡ªåŠ¨æ’­æ”¾ï¼Œæ»¡è¶³ä¸åŒå­¦ä¹ èŠ‚å¥çš„éœ€æ±‚ã€‚  


## 6. æ‹“å±•ç»ƒä¹ ä¸ç›¸ä¼¼é—®é¢˜æ€è€ƒ

### é€šç”¨æ€è·¯è¿ç§»  
æœ¬é¢˜çš„**æ ¸å¿ƒæ€è·¯**ï¼ˆå·®åˆ†æ•°ç»„æ€§è´¨ã€æ–¹å·®å¼å­åŒ–ç®€ã€åŠ¨æ€è§„åˆ’ç»´æŠ¤æ€»å’Œä¸å¹³æ–¹å’Œï¼‰å¯ä»¥è¿ç§»åˆ°ä»¥ä¸‹åœºæ™¯ï¼š  
1. **åºåˆ—è°ƒæ•´é—®é¢˜**ï¼šé€šè¿‡äº¤æ¢ç›¸é‚»å…ƒç´ è°ƒæ•´åºåˆ—ï¼Œæ±‚æŸæŒ‡æ ‡çš„æœ€å°å€¼ï¼ˆå¦‚æ–¹å·®ã€æ€»å’Œï¼‰ï¼›  
2. **å·®åˆ†ä¼˜åŒ–é—®é¢˜**ï¼šå½“åºåˆ—çš„å·®åˆ†å…·æœ‰æŸç§æ€§è´¨ï¼ˆå¦‚å•è°·ã€å•è°ƒï¼‰æ—¶ï¼Œç”¨DPç»´æŠ¤çŠ¶æ€ï¼›  
3. **æ•´æ•°ä¼˜åŒ–é—®é¢˜**ï¼šé¿å…æµ®ç‚¹è¿ç®—ï¼Œé€šè¿‡ä»£æ•°åŒ–ç®€å°†é—®é¢˜è½¬åŒ–ä¸ºæ•´æ•°è®¡ç®—ã€‚  

### ç»ƒä¹ æ¨èï¼ˆæ´›è°·ï¼‰  
1. **æ´›è°· P1471 æ–¹å·®**ï¼š  
   - ğŸ—£ï¸ **æ¨èç†ç”±**ï¼šç›´æ¥è®¡ç®—æ–¹å·®ï¼Œå·©å›ºå¼å­åŒ–ç®€çš„æŠ€å·§ï¼Œæ˜¯æœ¬é¢˜çš„åŸºç¡€ç»ƒä¹ ã€‚  
2. **æ´›è°· P2672 æ¨é”€å‘˜**ï¼š  
   - ğŸ—£ï¸ **æ¨èç†ç”±**ï¼šæ¶‰åŠå·®åˆ†å’ŒåŠ¨æ€è§„åˆ’ï¼Œéœ€è¦ç»´æŠ¤â€œæœ€å¤§å€¼â€å’Œâ€œæ€»å’Œâ€ï¼Œç±»ä¼¼æœ¬é¢˜çš„çŠ¶æ€ç»´æŠ¤ã€‚  
3. **æ´›è°· P3957 è·³æˆ¿å­**ï¼š  
   - ğŸ—£ï¸ **æ¨èç†ç”±**ï¼šåŠ¨æ€è§„åˆ’ä¼˜åŒ–é—®é¢˜ï¼Œéœ€è¦å¤„ç†ç±»ä¼¼çš„è½¬ç§»æ–¹ç¨‹ï¼ˆå¦‚â€œæ”¾å·¦è¾¹â€æˆ–â€œæ”¾å³è¾¹â€ï¼‰ï¼Œæå‡DPçš„åº”ç”¨èƒ½åŠ›ã€‚  


## 7. å­¦ä¹ å¿ƒå¾—ä¸ç»éªŒåˆ†äº«ï¼ˆè‹¥æœ‰ï¼‰  
- **æ¥è‡ªpigstdçš„ç»éªŒ**ï¼šâ€œèµ›æ—¶æˆ‘å¡äº†å¾ˆä¹…ï¼Œåæ¥å‘ç°`0`å·®åˆ†ä¸éœ€è¦å¤„ç†ï¼Œè¿™è®©DPçš„æ—¶é—´å¤æ‚åº¦é™ä½äº†å¾ˆå¤šã€‚â€  
  - **ç‚¹è¯„**ï¼šè¿™æé†’æˆ‘ä»¬ï¼Œ**æ•°æ®ä¸­çš„ç‰¹æ®Šå€¼ï¼ˆå¦‚`0`ï¼‰å¾€å¾€å¯ä»¥ä¼˜åŒ–ç®—æ³•**ã€‚åœ¨è§£é¢˜æ—¶ï¼Œè¦æ³¨æ„è§‚å¯Ÿæ•°æ®çš„ç‰¹ç‚¹ï¼Œå¯»æ‰¾ä¼˜åŒ–ç‚¹ã€‚  
- **æ¥è‡ªMoYuFangçš„ç»éªŒ**ï¼šâ€œæ»šåŠ¨æ•°ç»„æ˜¯ä¼˜åŒ–DPç©ºé—´çš„å…³é”®ï¼Œå°¤å…¶æ˜¯å½“çŠ¶æ€ç»´åº¦å¾ˆå¤§æ—¶ã€‚â€  
  - **ç‚¹è¯„**ï¼šæ»šåŠ¨æ•°ç»„æ˜¯DPçš„å¸¸ç”¨æŠ€å·§ï¼ŒæŒæ¡å®ƒèƒ½è§£å†³å¾ˆå¤šç©ºé—´ä¸è¶³çš„é—®é¢˜ã€‚  


## ç»“è¯­  
æœ¬æ¬¡å…³äºâ€œ[NOIP2021] æ–¹å·®â€çš„åˆ†æï¼Œæˆ‘ä»¬å­¦ä¹ äº†**å·®åˆ†æ•°ç»„çš„æ€§è´¨**ã€**æ–¹å·®å¼å­çš„åŒ–ç®€**å’Œ**åŠ¨æ€è§„åˆ’çš„åº”ç”¨**ã€‚é€šè¿‡å¯è§†åŒ–æ¼”ç¤ºï¼Œæˆ‘ä»¬ç›´è§‚çœ‹åˆ°äº†DPçŠ¶æ€çš„å˜åŒ–ï¼›é€šè¿‡æ‹“å±•ç»ƒä¹ ï¼Œæˆ‘ä»¬å¯ä»¥å·©å›ºæ‰€å­¦çš„æŠ€å·§ã€‚è®°ä½ï¼Œ**è§£é¢˜çš„å…³é”®æ˜¯å‘ç°é—®é¢˜çš„æœ¬è´¨**â€”â€”å°†æ“ä½œè½¬åŒ–ä¸ºå·®åˆ†æ•°ç»„çš„é‡æ’ï¼Œå°†æ–¹å·®è½¬åŒ–ä¸ºæ€»å’Œå’Œå¹³æ–¹å’Œçš„è®¡ç®—ï¼Œè¿™æ ·å°±èƒ½ç”¨åŠ¨æ€è§„åˆ’è½»æ¾è§£å†³é—®é¢˜ã€‚  

ä¸‹æ¬¡æˆ‘ä»¬å†ä¸€èµ·æ¢ç´¢æ–°çš„ç¼–ç¨‹æŒ‘æˆ˜ï¼ğŸ’ª

---
å¤„ç†ç”¨æ—¶ï¼š156.77ç§’
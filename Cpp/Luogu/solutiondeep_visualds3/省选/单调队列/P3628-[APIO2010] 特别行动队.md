# é¢˜ç›®ä¿¡æ¯

# [APIO2010] ç‰¹åˆ«è¡ŒåŠ¨é˜Ÿ

## é¢˜ç›®æè¿°

ä½ æœ‰ä¸€æ”¯ç”± $n$ åé¢„å¤‡å½¹å£«å…µç»„æˆçš„éƒ¨é˜Ÿï¼Œå£«å…µä» $1$ åˆ° $n$ ç¼–å·ï¼Œä½ è¦å°†ä»–ä»¬æ‹†åˆ†æˆè‹¥å¹²ç‰¹åˆ«è¡ŒåŠ¨é˜Ÿè°ƒå…¥æˆ˜åœºã€‚å‡ºäºé»˜å¥‘çš„è€ƒè™‘ï¼ŒåŒä¸€æ”¯ç‰¹åˆ«è¡ŒåŠ¨é˜Ÿä¸­é˜Ÿå‘˜çš„ç¼–å·**åº”è¯¥è¿ç»­**ï¼Œå³ä¸ºå½¢å¦‚ $(i, i + 1, \cdots,i + k)$ çš„åºåˆ—ã€‚æ‰€æœ‰çš„é˜Ÿå‘˜éƒ½åº”è¯¥å±äºä¸”ä»…å±äºä¸€æ”¯ç‰¹åˆ«è¡ŒåŠ¨é˜Ÿã€‚

ç¼–å·ä¸º $i$ çš„å£«å…µçš„åˆå§‹æˆ˜æ–—åŠ›ä¸º $x_i$ï¼Œä¸€æ”¯ç‰¹åˆ«è¡ŒåŠ¨é˜Ÿçš„åˆå§‹æˆ˜æ–—åŠ› $X$ ä¸ºé˜Ÿå†…å£«å…µåˆå§‹æˆ˜æ–—åŠ›ä¹‹å’Œï¼Œå³ $X = x_i + x_{i+1} + \cdots + x_{i+k}$ã€‚

é€šè¿‡é•¿æœŸçš„è§‚å¯Ÿï¼Œä½ æ€»ç»“å‡ºå¯¹äºä¸€æ”¯åˆå§‹æˆ˜æ–—åŠ›ä¸º $X$ çš„ç‰¹åˆ«è¡ŒåŠ¨é˜Ÿï¼Œå…¶ä¿®æ­£æˆ˜æ–—åŠ› $X'= aX^2+bX+c$ï¼Œå…¶ä¸­ $a,b,c$ æ˜¯å·²çŸ¥çš„ç³»æ•°ï¼ˆ$a < 0$ï¼‰ã€‚ ä½œä¸ºéƒ¨é˜Ÿç»Ÿå¸…ï¼Œç°åœ¨ä½ è¦ä¸ºè¿™æ”¯éƒ¨é˜Ÿè¿›è¡Œç¼–é˜Ÿï¼Œä½¿å¾—æ‰€æœ‰ç‰¹åˆ«è¡ŒåŠ¨é˜Ÿçš„ä¿®æ­£æˆ˜æ–—åŠ›ä¹‹å’Œæœ€å¤§ã€‚è¯•æ±‚å‡ºè¿™ä¸ªæœ€å¤§å’Œã€‚

## è¯´æ˜/æç¤º

#### æ ·ä¾‹è¾“å…¥è¾“å‡º $1$ è§£é‡Š

ä½ æœ‰ $4$ åå£«å…µï¼Œ$x_1 = 2,~x_2 = 2,~x_3 = 3,~x_4=4$ã€‚ä¿®æ­£æˆ˜æ–—åŠ›å…¬å¼ä¸­çš„å‚æ•°ä¸º  $a = -1,~b = 10,~c = -20$ã€‚

æ­¤æ—¶ï¼Œæœ€ä½³æ–¹æ¡ˆæ˜¯å°†å£«å…µç»„æˆ $3$ ä¸ªç‰¹åˆ«è¡ŒåŠ¨é˜Ÿï¼šç¬¬ä¸€é˜ŸåŒ…å«å£«å…µ $1$ å’Œå£«å…µ $2$ï¼Œç¬¬äºŒé˜ŸåŒ…å«å£«å…µ $3$ï¼Œç¬¬ä¸‰é˜ŸåŒ…å«å£«å…µ $4$ã€‚ç‰¹åˆ«è¡ŒåŠ¨é˜Ÿçš„åˆå§‹æˆ˜æ–—åŠ›åˆ†åˆ«ä¸º $4,~3,~4$ï¼Œä¿®æ­£åçš„æˆ˜æ–—åŠ›åˆ†åˆ«ä¸º $-4^2 + 10 \times 4 -20 = 4$ï¼Œ$-3^2 + 10 \times 3 - 20 = 1$ï¼Œ$-4^2 + 10 \times 4 -20 = 4$ã€‚ä¿®æ­£åçš„æˆ˜æ–—åŠ›å’Œä¸º $4 + 1 + 4 = 9$ï¼Œæ²¡æœ‰å…¶å®ƒæ–¹æ¡ˆèƒ½ä½¿ä¿®æ­£åçš„æˆ˜æ–—åŠ›å’Œæ›´å¤§ã€‚


#### æ•°æ®èŒƒå›´ä¸çº¦å®š

å¯¹äº $20\%$ çš„æ•°æ®ï¼Œ$n \leq 10^3$ã€‚

å¯¹äº $50\%$ çš„æ•°æ®ï¼Œ$n \leq 10^4$ã€‚

å¯¹äº $100\%$ çš„æ•°æ®ï¼Œ$1 \leq n \leq 10^6$ï¼Œ$-5 \leq a \leq -1$ï¼Œ$-10^7 \leq b \leq 10^7$ï¼Œ$-10^7 \leq c \leq 10^7$ï¼Œ$1 \leq x_i \leq 100$ã€‚

## æ ·ä¾‹ #1

### è¾“å…¥

```
4 
-1 10 -20 
2 2 3 4 ```

### è¾“å‡º

```
9```

# AIåˆ†æç»“æœ

# ğŸ’¡ Kayçš„C++ç®—æ³•è§£æï¼š[APIO2010]ç‰¹åˆ«è¡ŒåŠ¨é˜Ÿ æ·±å…¥å­¦ä¹ æŒ‡å— ğŸ’¡


## ğŸ“ 1. é¢˜ç›®è§£è¯»ä¸æ ¸å¿ƒç®—æ³•è¯†åˆ«
### âœ¨ æœ¬é¢˜ä¸»è¦è€ƒå¯Ÿï¼š**æ–œç‡ä¼˜åŒ–åŠ¨æ€è§„åˆ’ï¼ˆDPï¼‰**
### ğŸ—£ï¸ åˆæ­¥åˆ†æ
è¿™é“é¢˜çš„æ ¸å¿ƒæ˜¯å°†å£«å…µåˆ†æˆè¿ç»­çš„è‹¥å¹²ç»„ï¼Œä½¿å¾—ä¿®æ­£æˆ˜æ–—åŠ›ä¹‹å’Œæœ€å¤§ã€‚ä¿®æ­£æˆ˜æ–—åŠ›æ˜¯ç»„å†…å£«å…µåˆå§‹æˆ˜æ–—åŠ›ä¹‹å’Œçš„äºŒæ¬¡å‡½æ•°ï¼ˆ\(aX^2 + bX + c\)ï¼Œå…¶ä¸­\(a<0\)ï¼‰ã€‚ç”±äºäºŒæ¬¡å‡½æ•°çš„å­˜åœ¨ï¼Œç›´æ¥æš´åŠ›æšä¸¾æ‰€æœ‰åˆ†ç»„æ–¹å¼ï¼ˆ\(O(n^2)\)ï¼‰ä¼šè¶…æ—¶ï¼Œå› æ­¤éœ€è¦**æ–œç‡ä¼˜åŒ–**æ¥å°†æ—¶é—´å¤æ‚åº¦é™è‡³\(O(n)\)ã€‚


#### 1.1 æ ¸å¿ƒæ€è·¯
- **çŠ¶æ€å®šä¹‰**ï¼šè®¾\(dp[i]\)è¡¨ç¤ºå‰\(i\)ä¸ªå£«å…µçš„æœ€å¤§ä¿®æ­£æˆ˜æ–—åŠ›å’Œï¼›\(sum[i]\)è¡¨ç¤ºå‰\(i\)ä¸ªå£«å…µçš„åˆå§‹æˆ˜æ–—åŠ›å‰ç¼€å’Œï¼ˆ\(sum[i] = sum[i-1] + x[i]\)ï¼‰ã€‚
- **è½¬ç§»æ–¹ç¨‹**ï¼š  
  \(dp[i] = \max_{0 \leq j < i} \left( dp[j] + a \cdot (sum[i] - sum[j])^2 + b \cdot (sum[i] - sum[j]) + c \right)\)  
  å±•å¼€åï¼š  
  \(dp[i] = \max_{0 \leq j < i} \left( dp[j] + a \cdot sum[j]^2 - b \cdot sum[j] - 2a \cdot sum[i] \cdot sum[j] \right) + a \cdot sum[i]^2 + b \cdot sum[i] + c\)


#### 1.2 æ–œç‡ä¼˜åŒ–æ¨å¯¼
å°†è½¬ç§»æ–¹ç¨‹ä¸­çš„**å†³ç­–éƒ¨åˆ†**ï¼ˆä¸\(j\)ç›¸å…³çš„é¡¹ï¼‰æ•´ç†ä¸º**çº¿æ€§å‡½æ•°å½¢å¼**ï¼š  
å¯¹äºæ¯ä¸ª\(j\)ï¼Œå®šä¹‰ï¼š  
- \(y[j] = dp[j] + a \cdot sum[j]^2 - b \cdot sum[j]\)ï¼ˆå› å˜é‡ï¼‰  
- \(k[i] = 2a \cdot sum[i]\)ï¼ˆæ–œç‡ï¼Œéš\(i\)å¢å¤§è€Œ**é€’å‡**ï¼Œå› ä¸º\(a<0\)ï¼‰  
- \(x[j] = sum[j]\)ï¼ˆè‡ªå˜é‡ï¼Œéš\(j\)å¢å¤§è€Œ**é€’å¢**ï¼‰  

åˆ™è½¬ç§»æ–¹ç¨‹å¯ç®€åŒ–ä¸ºï¼š  
\(dp[i] = \max\left( y[j] - k[i] \cdot x[j] \right) + a \cdot sum[i]^2 + b \cdot sum[i] + c\)  

æ­¤æ—¶ï¼Œé—®é¢˜è½¬åŒ–ä¸ºï¼šåœ¨**å•è°ƒé€’å¢çš„\(x[j]\)**å’Œ**å•è°ƒé€’å‡çš„\(k[i]\)**ä¸‹ï¼Œæ‰¾åˆ°ä½¿å¾—\(y[j] - k[i] \cdot x[j]\)æœ€å¤§çš„\(j\)ã€‚è¿™å¯ä»¥é€šè¿‡**ç»´æŠ¤ä¸Šå‡¸å£³**ï¼ˆå•è°ƒé˜Ÿåˆ—ï¼‰æ¥è§£å†³ã€‚


#### 1.3 å‡¸å£³ç»´æŠ¤é€»è¾‘
- **ä¸Šå‡¸å£³**ï¼šé˜Ÿåˆ—ä¸­çš„å†³ç­–ç‚¹æ„æˆçš„ç›´çº¿æ–œç‡**å•è°ƒé€’å‡**ã€‚è¿™æ ·ï¼Œå½“\(k[i]\)é€’å‡æ—¶ï¼Œé˜Ÿé¦–çš„å†³ç­–ç‚¹å§‹ç»ˆæ˜¯å½“å‰æœ€ä¼˜çš„ï¼ˆå› ä¸ºæ–œç‡é€’å‡çš„ç›´çº¿åœ¨\(k[i]\)é€’å‡æ—¶ï¼Œé˜Ÿé¦–çš„ç›´çº¿æˆªè·æœ€å¤§ï¼‰ã€‚
- **é˜Ÿé¦–å¤„ç†**ï¼šå½“é˜Ÿé¦–çš„ä¸‹ä¸€ä¸ªç‚¹æ¯”é˜Ÿé¦–æ›´ä¼˜æ—¶ï¼ˆå³æ–œç‡å°äºç­‰äºå½“å‰\(k[i]\)ï¼‰ï¼Œå¼¹å‡ºé˜Ÿé¦–ã€‚
- **é˜Ÿå°¾å¤„ç†**ï¼šå½“æ–°åŠ å…¥çš„ç‚¹ç ´åä¸Šå‡¸å£³çš„å•è°ƒæ€§æ—¶ï¼ˆå³å½“å‰ç‚¹ä¸é˜Ÿå°¾å‰ä¸€ä¸ªç‚¹çš„æ–œç‡å°äºç­‰äºé˜Ÿå°¾ä¸å‰å‰ä¸€ä¸ªç‚¹çš„æ–œç‡ï¼‰ï¼Œå¼¹å‡ºé˜Ÿå°¾ã€‚


## ğŸ“Š 2. ç²¾é€‰ä¼˜è´¨é¢˜è§£å‚è€ƒ
### é¢˜è§£ä¸€ï¼ˆæ¥æºï¼šVSEJGFBï¼Œèµï¼š52ï¼‰
- **ç‚¹è¯„**ï¼šæ€è·¯æ¸…æ™°ï¼Œæ–œç‡ä¼˜åŒ–æ¨å¯¼è¯¦ç»†ã€‚ä»£ç ç»“æ„è§„èŒƒï¼Œä½¿ç”¨å•è°ƒé˜Ÿåˆ—ç»´æŠ¤ä¸Šå‡¸å£³ï¼Œå¤„ç†äº†\(a<0\)çš„æƒ…å†µã€‚**äº®ç‚¹**ï¼šå°†è½¬ç§»æ–¹ç¨‹æ•´ç†ä¸ºçº¿æ€§å½¢å¼ï¼Œæ˜ç¡®äº†\(y[j]\)ã€\(k[i]\)ã€\(x[j]\)çš„å®šä¹‰ï¼Œä¾¿äºç†è§£ã€‚
- **æ ¸å¿ƒä»£ç ç‰‡æ®µ**ï¼š  
  ```cpp
  double slope(int i, int j) { return 1.0 * (y(i) - y(j)) / (x(i) - x(j)); }
  for (int i = 1; i <= n; i++) {
      while (head < tail && slope(q[head], q[head+1]) > k(i)) head++;
      dp[i] = -(k(i)*x(q[head]) - y(q[head]) - a*sum[i]*sum[i] - b*sum[i] - c);
      while (head < tail && slope(q[tail-1], q[tail]) <= slope(q[tail], i)) tail--;
      q[++tail] = i;
  }
  ```


### é¢˜è§£äºŒï¼ˆæ¥æºï¼šyunskï¼Œèµï¼š36ï¼‰
- **ç‚¹è¯„**ï¼šä»£ç ç®€æ´ï¼Œä½¿ç”¨\(long long\)é¿å…æº¢å‡ºã€‚**äº®ç‚¹**ï¼šé€šè¿‡äº¤å‰ç›¸ä¹˜é¿å…æµ®ç‚¹è¯¯å·®ï¼ˆå¦‚`pd`å‡½æ•°ï¼‰ï¼Œæé«˜äº†ä»£ç çš„é²æ£’æ€§ã€‚
- **æ ¸å¿ƒä»£ç ç‰‡æ®µ**ï¼š  
  ```cpp
  double pd(int j, int k) {
      return (f[j] - f[k] + a*(sum[j]*sum[j] - sum[k]*sum[k]) + b*(sum[k] - sum[j])) / (2.0*a*(sum[j] - sum[k]));
  }
  for (int i = 1; i <= n; i++) {
      while (l < r && pd(q[l], q[l+1]) <= sum[i]) l++;
      f[i] = f[q[l]] + a*(sum[i]-sum[q[l]])*(sum[i]-sum[q[l]]) + b*(sum[i]-sum[q[l]]) + c;
      while (l <= r && pd(q[r-1], q[r]) >= pd(q[r], i)) r--;
      q[++r] = i;
  }
  ```


### é¢˜è§£ä¸‰ï¼ˆæ¥æºï¼šyybyybï¼Œèµï¼š22ï¼‰
- **ç‚¹è¯„**ï¼šæ¨å¯¼è¿‡ç¨‹è¯¦ç»†ï¼Œæ˜ç¡®äº†æ–œç‡ä¼˜åŒ–çš„æ¡ä»¶ã€‚**äº®ç‚¹**ï¼šä½¿ç”¨`count`å‡½æ•°è®¡ç®—æ–œç‡ï¼Œä»£ç å¯è¯»æ€§é«˜ã€‚
- **æ ¸å¿ƒä»£ç ç‰‡æ®µ**ï¼š  
  ```cpp
  double count(ll j, ll k) {
      return ((f[j] - B*c[j] + A*sqr(c[j])) - (f[k] - B*c[k] + A*sqr(c[k]))) / (2.0*A*(c[j] - c[k]));
  }
  for (int i = 1; i <= n; i++) {
      while (h < t && count(s[h], s[h+1]) <= c[i]) h++;
      f[i] = f[s[h]] + F(c[i] - c[s[h]]);
      while (h < t && count(s[t-1], s[t]) >= count(s[t], i)) t--;
      s[++t] = i;
  }
  ```


## ğŸ” 3. æ ¸å¿ƒéš¾ç‚¹è¾¨æä¸è§£é¢˜ç­–ç•¥
### 3.1 æ ¸å¿ƒéš¾ç‚¹
1. **è½¬ç§»æ–¹ç¨‹çš„å±•å¼€ä¸çº¿æ€§åŒ–**ï¼šå¦‚ä½•å°†äºŒæ¬¡è½¬ç§»æ–¹ç¨‹è½¬åŒ–ä¸ºçº¿æ€§å½¢å¼ï¼Œä»è€Œåº”ç”¨æ–œç‡ä¼˜åŒ–ã€‚  
2. **å‡¸å£³ç±»å‹çš„é€‰æ‹©**ï¼šç”±äº\(a<0\)ï¼Œæ–œç‡\(k[i]\)å•è°ƒé€’å‡ï¼Œéœ€è¦ç»´æŠ¤ä¸Šå‡¸å£³è€Œéä¸‹å‡¸å£³ã€‚  
3. **å•è°ƒé˜Ÿåˆ—çš„ç»´æŠ¤**ï¼šå¦‚ä½•æ­£ç¡®å¼¹å‡ºé˜Ÿé¦–å’Œé˜Ÿå°¾çš„ç‚¹ï¼Œä¿è¯å‡¸å£³çš„å•è°ƒæ€§ã€‚


### 3.2 è§£é¢˜ç­–ç•¥
1. **è½¬ç§»æ–¹ç¨‹çº¿æ€§åŒ–**ï¼šå°†\(dp[j]\)çš„é¡¹æ•´ç†ä¸º\(y[j] = dp[j] + a \cdot sum[j]^2 - b \cdot sum[j]\)ï¼Œå°†\(sum[i]\)çš„é¡¹æ•´ç†ä¸ºæ–œç‡\(k[i] = 2a \cdot sum[i]\)ï¼Œä»è€Œå°†é—®é¢˜è½¬åŒ–ä¸ºæ±‚çº¿æ€§å‡½æ•°çš„æœ€å¤§æˆªè·ã€‚  
2. **ä¸Šå‡¸å£³ç»´æŠ¤**ï¼šä½¿ç”¨å•è°ƒé˜Ÿåˆ—ä¿å­˜å†³ç­–ç‚¹ï¼Œé˜Ÿé¦–ä¸ºå½“å‰æœ€ä¼˜å†³ç­–ï¼Œé˜Ÿå°¾æ’å…¥æ–°ç‚¹æ—¶ä¿è¯æ–œç‡é€’å‡ã€‚  
3. **è¾¹ç•Œæ¡ä»¶å¤„ç†**ï¼šåˆå§‹åŒ–\(dp[0] = 0\)ï¼Œé˜Ÿåˆ—åˆå§‹åŠ å…¥\(0\)ï¼ˆè¡¨ç¤ºå‰0ä¸ªå£«å…µçš„çŠ¶æ€ï¼‰ã€‚


### âœ¨ è§£é¢˜æŠ€å·§æ€»ç»“
- **å‰ç¼€å’Œä¼˜åŒ–**ï¼šå°†ç»„å†…å’Œè½¬åŒ–ä¸ºå‰ç¼€å’Œä¹‹å·®ï¼Œç®€åŒ–è®¡ç®—ã€‚  
- **æ–œç‡ä¼˜åŒ–**ï¼šé’ˆå¯¹äºŒæ¬¡è½¬ç§»æ–¹ç¨‹ï¼Œé€šè¿‡çº¿æ€§åŒ–å’Œå‡¸å£³ç»´æŠ¤å°†æ—¶é—´å¤æ‚åº¦ä»\(O(n^2)\)é™è‡³\(O(n)\)ã€‚  
- **å•è°ƒé˜Ÿåˆ—**ï¼šç»´æŠ¤å‡¸å£³çš„æœ‰æ•ˆæ•°æ®ç»“æ„ï¼Œä¿è¯æ¯æ¬¡è½¬ç§»çš„æœ€ä¼˜å†³ç­–å¯ä»¥åœ¨\(O(1)\)æ—¶é—´å†…æ‰¾åˆ°ã€‚


## ğŸ’» 4. C++æ ¸å¿ƒä»£ç å®ç°èµæ
### 4.1 æœ¬é¢˜é€šç”¨æ ¸å¿ƒC++å®ç°å‚è€ƒ
- **è¯´æ˜**ï¼šç»¼åˆä¼˜è´¨é¢˜è§£çš„æ€è·¯ï¼Œå®ç°æ–œç‡ä¼˜åŒ–DPï¼Œç»´æŠ¤ä¸Šå‡¸å£³ã€‚
- **å®Œæ•´æ ¸å¿ƒä»£ç **ï¼š  
  ```cpp
  #include <iostream>
  #include <cstdio>
  #include <deque>
  using namespace std;
  typedef long long ll;
  const int N = 1e6 + 10;

  ll sum[N], dp[N];
  int q[N];
  int n, a, b, c;

  inline ll Y(int j) { return dp[j] + (ll)a * sum[j] * sum[j] - (ll)b * sum[j]; }
  inline double slope(int j, int k) { return (double)(Y(j) - Y(k)) / (sum[j] - sum[k]); }

  int main() {
      scanf("%d%d%d%d", &n, &a, &b, &c);
      for (int i = 1; i <= n; i++) {
          int x;
          scanf("%d", &x);
          sum[i] = sum[i-1] + x;
      }

      int head = 0, tail = 0;
      q[tail++] = 0;
      for (int i = 1; i <= n; i++) {
          // é˜Ÿé¦–å¤„ç†ï¼šå¼¹å‡ºä¸ä¼˜çš„ç‚¹
          while (head + 1 < tail && slope(q[head], q[head+1]) > 2LL * a * sum[i]) {
              head++;
          }
          int j = q[head];
          dp[i] = dp[j] + (ll)a * (sum[i] - sum[j]) * (sum[i] - sum[j]) + (ll)b * (sum[i] - sum[j]) + c;

          // é˜Ÿå°¾å¤„ç†ï¼šç»´æŠ¤ä¸Šå‡¸å£³
          while (tail - 1 > head && slope(q[tail-1], i) <= slope(q[tail-2], q[tail-1])) {
              tail--;
          }
          q[tail++] = i;
      }

      printf("%lld\n", dp[n]);
      return 0;
  }
  ```
- **ä»£ç è§£è¯»æ¦‚è¦**ï¼š  
  1. **å‰ç¼€å’Œè®¡ç®—**ï¼šè¯»å–è¾“å…¥å¹¶è®¡ç®—\(sum\)æ•°ç»„ã€‚  
  2. **å•è°ƒé˜Ÿåˆ—åˆå§‹åŒ–**ï¼šé˜Ÿåˆ—åˆå§‹åŠ å…¥\(0\)ï¼ˆ\(dp[0] = 0\)ï¼‰ã€‚  
  3. **éå†æ¯ä¸ªå£«å…µ**ï¼š  
     - é˜Ÿé¦–å¼¹å‡ºä¸ä¼˜çš„ç‚¹ï¼ˆæ–œç‡å¤§äºå½“å‰\(k[i]\)ï¼‰ã€‚  
     - è®¡ç®—\(dp[i]\)ï¼ˆä½¿ç”¨é˜Ÿé¦–çš„æœ€ä¼˜å†³ç­–ï¼‰ã€‚  
     - é˜Ÿå°¾æ’å…¥å½“å‰ç‚¹ï¼Œç»´æŠ¤ä¸Šå‡¸å£³ï¼ˆæ–œç‡é€’å‡ï¼‰ã€‚  


### 4.2 é’ˆå¯¹å„ä¼˜è´¨é¢˜è§£çš„ç‰‡æ®µèµæ
#### é¢˜è§£ä¸€ï¼ˆVSEJGFBï¼‰
- **äº®ç‚¹**ï¼šæ˜ç¡®äº†\(y[j]\)ã€\(k[i]\)ã€\(x[j]\)çš„å®šä¹‰ï¼Œä»£ç ç»“æ„æ¸…æ™°ã€‚
- **æ ¸å¿ƒä»£ç ç‰‡æ®µ**ï¼š  
  ```cpp
  double slope(int i, int j) { return 1.0 * (y(i) - y(j)) / (x(i) - x(j)); }
  ```
- **ä»£ç è§£è¯»**ï¼šè®¡ç®—ä¸¤ä¸ªå†³ç­–ç‚¹\(i\)å’Œ\(j\)ä¹‹é—´çš„æ–œç‡ï¼Œç”¨äºåˆ¤æ–­å‡¸å£³çš„å•è°ƒæ€§ã€‚
- **å­¦ä¹ ç¬”è®°**ï¼šæ–œç‡çš„è®¡ç®—æ˜¯æ–œç‡ä¼˜åŒ–çš„æ ¸å¿ƒï¼Œéœ€è¦æ­£ç¡®å¤„ç†å› å˜é‡å’Œè‡ªå˜é‡çš„å…³ç³»ã€‚


#### é¢˜è§£äºŒï¼ˆyunskï¼‰
- **äº®ç‚¹**ï¼šä½¿ç”¨äº¤å‰ç›¸ä¹˜é¿å…æµ®ç‚¹è¯¯å·®ï¼ˆå¦‚`pd`å‡½æ•°ï¼‰ã€‚
- **æ ¸å¿ƒä»£ç ç‰‡æ®µ**ï¼š  
  ```cpp
  double pd(int j, int k) {
      return (f[j] - f[k] + a*(sum[j]*sum[j] - sum[k]*sum[k]) + b*(sum[k] - sum[j])) / (2.0*a*(sum[j] - sum[k]));
  }
  ```
- **ä»£ç è§£è¯»**ï¼šé€šè¿‡äº¤å‰ç›¸ä¹˜å°†æ–œç‡æ¯”è¾ƒè½¬åŒ–ä¸ºä¹˜æ³•è¿ç®—ï¼Œé¿å…äº†æµ®ç‚¹ç²¾åº¦é—®é¢˜ã€‚
- **å­¦ä¹ ç¬”è®°**ï¼šåœ¨æ–œç‡ä¼˜åŒ–ä¸­ï¼Œäº¤å‰ç›¸ä¹˜æ˜¯é¿å…æµ®ç‚¹è¯¯å·®çš„æœ‰æ•ˆæ–¹æ³•ã€‚


#### é¢˜è§£ä¸‰ï¼ˆyybyybï¼‰
- **äº®ç‚¹**ï¼šä½¿ç”¨`count`å‡½æ•°è®¡ç®—æ–œç‡ï¼Œä»£ç å¯è¯»æ€§é«˜ã€‚
- **æ ¸å¿ƒä»£ç ç‰‡æ®µ**ï¼š  
  ```cpp
  double count(ll j, ll k) {
      return ((f[j] - B*c[j] + A*sqr(c[j])) - (f[k] - B*c[k] + A*sqr(c[k]))) / (2.0*A*(c[j] - c[k]));
  }
  ```
- **ä»£ç è§£è¯»**ï¼šå°†\(y[j]\)çš„è®¡ç®—æ•´åˆåˆ°`count`å‡½æ•°ä¸­ï¼Œç®€åŒ–äº†ä»£ç ã€‚
- **å­¦ä¹ ç¬”è®°**ï¼šä»£ç çš„å¯è¯»æ€§æ˜¯é‡è¦çš„ï¼Œåˆç†çš„å‡½æ•°å°è£…å¯ä»¥æé«˜ä»£ç çš„å¯ç»´æŠ¤æ€§ã€‚


## ğŸ® 5. ç®—æ³•å¯è§†åŒ–ï¼šåƒç´ åŠ¨ç”»æ¼”ç¤ºï¼ˆæ ¸å¿ƒéƒ¨åˆ†ï¼‰
### ğŸ“Œ åŠ¨ç”»æ¼”ç¤ºä¸»é¢˜ï¼š**åƒç´ å£«å…µåˆ†ç»„å¤§æŒ‘æˆ˜**ï¼ˆä»¿FCçº¢ç™½æœºé£æ ¼ï¼‰
### ğŸ¨ è®¾è®¡æ€è·¯
- **é£æ ¼**ï¼š8ä½åƒç´ é£ï¼Œä½¿ç”¨çº¢ç™½æœºç»å…¸é…è‰²ï¼ˆå¦‚çº¢è‰²ã€è“è‰²ã€é»„è‰²ï¼‰ï¼ŒèƒŒæ™¯ä¸ºç»¿è‰²è‰åœ°ã€‚
- **æ ¸å¿ƒå†…å®¹**ï¼šæ¼”ç¤ºæ–œç‡ä¼˜åŒ–DPçš„è¿‡ç¨‹ï¼ŒåŒ…æ‹¬å‰ç¼€å’Œè®¡ç®—ã€å•è°ƒé˜Ÿåˆ—ç»´æŠ¤ã€\(dp\)å€¼æ›´æ–°ã€‚
- **æ¸¸æˆåŒ–å…ƒç´ **ï¼š  
  - **å£«å…µåˆ†ç»„**ï¼šæ¯ä¸ªå£«å…µç”¨åƒç´ å—è¡¨ç¤ºï¼Œåˆ†ç»„æ—¶ç”¨ä¸åŒé¢œè‰²æ ‡è®°ï¼ˆå¦‚çº¢è‰²ç»„ã€è“è‰²ç»„ï¼‰ã€‚  
  - **éŸ³æ•ˆ**ï¼šè®¡ç®—å‰ç¼€å’Œæ—¶æ’­æ”¾â€œæ»´â€å£°ï¼Œæ›´æ–°\(dp\)å€¼æ—¶æ’­æ”¾â€œå®â€å£°ï¼Œæ‰¾åˆ°æœ€ä¼˜å†³ç­–æ—¶æ’­æ”¾â€œé€šå…³â€éŸ³æ•ˆã€‚  
  - **è¿›åº¦æ¡**ï¼šæ˜¾ç¤ºå½“å‰å¤„ç†çš„å£«å…µæ•°é‡ï¼Œè¿›åº¦æ¡æ»¡æ—¶æ’­æ”¾èƒœåˆ©åŠ¨ç”»ã€‚


### ğŸ“Š åŠ¨ç”»å¸§æ­¥éª¤
1. **åˆå§‹åŒ–åœºæ™¯**ï¼šå±å¹•å·¦ä¾§æ˜¾ç¤ºå£«å…µé˜Ÿåˆ—ï¼ˆåƒç´ å—ï¼‰ï¼Œå³ä¾§æ˜¾ç¤ºå‰ç¼€å’Œã€\(dp\)å€¼ã€å•è°ƒé˜Ÿåˆ—çš„çŠ¶æ€ã€‚  
2. **å‰ç¼€å’Œè®¡ç®—**ï¼šé€ä¸ªè¯»å–å£«å…µçš„æˆ˜æ–—åŠ›ï¼Œæ›´æ–°\(sum\)æ•°ç»„ï¼Œåƒç´ å—ä¸Šæ–¹æ˜¾ç¤ºå½“å‰\(sum\)å€¼ã€‚  
3. **å•è°ƒé˜Ÿåˆ—ç»´æŠ¤**ï¼š  
   - é˜Ÿé¦–å¼¹å‡ºï¼šå½“é˜Ÿé¦–çš„ä¸‹ä¸€ä¸ªç‚¹æ›´ä¼˜æ—¶ï¼Œé˜Ÿé¦–çš„åƒç´ å—å˜ä¸ºç°è‰²ï¼ˆè¡¨ç¤ºæ— æ•ˆï¼‰ã€‚  
   - é˜Ÿå°¾æ’å…¥ï¼šæ–°çš„å†³ç­–ç‚¹åŠ å…¥é˜Ÿåˆ—ï¼Œåƒç´ å—å˜ä¸ºè“è‰²ï¼ˆè¡¨ç¤ºæœ‰æ•ˆï¼‰ã€‚  
4. **\(dp\)å€¼æ›´æ–°**ï¼šä½¿ç”¨é˜Ÿé¦–çš„æœ€ä¼˜å†³ç­–è®¡ç®—\(dp[i]\)ï¼Œåƒç´ å—ä¸Šæ–¹æ˜¾ç¤ºå½“å‰\(dp\)å€¼ï¼ŒåŒæ—¶æ’­æ”¾â€œå®â€å£°ã€‚  
5. **é€šå…³åŠ¨ç”»**ï¼šå½“å¤„ç†å®Œæ‰€æœ‰å£«å…µæ—¶ï¼Œå±å¹•æ˜¾ç¤ºâ€œé€šå…³ï¼â€ï¼Œæ’­æ”¾èƒœåˆ©éŸ³æ•ˆï¼Œå£«å…µåˆ†ç»„çš„åƒç´ å—é—ªçƒã€‚


### ğŸ¯ äº¤äº’è®¾è®¡
- **å•æ­¥æ‰§è¡Œ**ï¼šç‚¹å‡»â€œä¸‹ä¸€æ­¥â€æŒ‰é’®ï¼Œé€æ­¥æ‰§è¡Œæ¯ä¸ªå£«å…µçš„å¤„ç†è¿‡ç¨‹ã€‚  
- **è‡ªåŠ¨æ’­æ”¾**ï¼šç‚¹å‡»â€œè‡ªåŠ¨â€æŒ‰é’®ï¼ŒåŠ¨ç”»ä»¥æ¯ç§’2å¸§çš„é€Ÿåº¦æ’­æ”¾ï¼Œå¯è°ƒæ•´é€Ÿåº¦ï¼ˆå¦‚1-5å¸§/ç§’ï¼‰ã€‚  
- **é‡ç½®**ï¼šç‚¹å‡»â€œé‡ç½®â€æŒ‰é’®ï¼Œå›åˆ°åˆå§‹çŠ¶æ€ï¼Œé‡æ–°å¼€å§‹æ¼”ç¤ºã€‚


## ğŸ” 6. æ‹“å±•ç»ƒä¹ ä¸ç›¸ä¼¼é—®é¢˜æ€è€ƒ
### 6.1 é€šç”¨æ€è·¯è¿ç§»
æ–œç‡ä¼˜åŒ–DPé€‚ç”¨äº**è½¬ç§»æ–¹ç¨‹ä¸ºäºŒæ¬¡å‡½æ•°**ä¸”**å†³ç­–å˜é‡å…·æœ‰å•è°ƒæ€§**çš„é—®é¢˜ã€‚ä¾‹å¦‚ï¼š
- **ç©å…·è£…ç®±é—®é¢˜**ï¼ˆP3195ï¼‰ï¼šè½¬ç§»æ–¹ç¨‹ä¸º\(dp[i] = \max(dp[j] + (i-j-1 + sum[i]-sum[j])^2)\)ã€‚  
- **çƒ½ç«ä¼ é€’é—®é¢˜**ï¼ˆP1886ï¼‰ï¼šè½¬ç§»æ–¹ç¨‹ä¸º\(dp[i] = \min(dp[j] + a[i])\)ï¼ˆ\(j \in [i-m, i-1]\)ï¼‰ã€‚  
- **ä»“åº“å»ºè®¾é—®é¢˜**ï¼ˆP4085ï¼‰ï¼šè½¬ç§»æ–¹ç¨‹ä¸º\(dp[i] = \min(dp[j] + cost(j+1, i))\)ï¼ˆ\(cost\)ä¸ºäºŒæ¬¡å‡½æ•°ï¼‰ã€‚


### 6.2 æ´›è°·ç»ƒä¹ æ¨è
1. **æ´›è°· P3195** - ç©å…·è£…ç®±TOY  
   - **æ¨èç†ç”±**ï¼šç»å…¸çš„æ–œç‡ä¼˜åŒ–é—®é¢˜ï¼Œè½¬ç§»æ–¹ç¨‹ä¸æœ¬é¢˜ç±»ä¼¼ï¼Œé€‚åˆå·©å›ºæ–œç‡ä¼˜åŒ–çš„æ¨å¯¼ã€‚  
2. **æ´›è°· P4085** - ä»“åº“å»ºè®¾  
   - **æ¨èç†ç”±**ï¼šè½¬ç§»æ–¹ç¨‹ä¸ºäºŒæ¬¡å‡½æ•°ï¼Œéœ€è¦å¤„ç†å‰ç¼€å’Œå’Œæ–œç‡ä¼˜åŒ–ï¼Œéš¾åº¦é€‚ä¸­ã€‚  
3. **æ´›è°· P1886** - æ»‘åŠ¨çª—å£  
   - **æ¨èç†ç”±**ï¼šå•è°ƒé˜Ÿåˆ—çš„åŸºç¡€é—®é¢˜ï¼Œå¸®åŠ©ç†è§£é˜Ÿåˆ—ç»´æŠ¤çš„é€»è¾‘ã€‚  
4. **æ´›è°· P2365** - ä»»åŠ¡å®‰æ’  
   - **æ¨èç†ç”±**ï¼šæ–œç‡ä¼˜åŒ–çš„å˜å½¢é—®é¢˜ï¼Œéœ€è¦å¤„ç†æ—¶é—´çš„ç´¯åŠ ï¼Œæ‹“å±•æ€è·¯ã€‚


## ğŸ“ 7. å­¦ä¹ å¿ƒå¾—ä¸ç»éªŒåˆ†äº«ï¼ˆè‹¥æœ‰ï¼‰
- **æ¥è‡ªé¢˜è§£ä½œè€…çš„ç»éªŒ**ï¼šâ€œåœ¨æ¨å¯¼æ–œç‡ä¼˜åŒ–æ—¶ï¼Œä¸€å®šè¦æ³¨æ„ç¬¦å·é—®é¢˜ï¼ˆå¦‚\(a<0\)ï¼‰ï¼Œå¦åˆ™ä¼šå¯¼è‡´å‡¸å£³ç±»å‹é€‰æ‹©é”™è¯¯ã€‚â€  
- **ç‚¹è¯„**ï¼šç¬¦å·é—®é¢˜æ˜¯æ–œç‡ä¼˜åŒ–çš„å¸¸è§é™·é˜±ï¼Œéœ€è¦ä»”ç»†æ¨å¯¼è½¬ç§»æ–¹ç¨‹ï¼Œç¡®ä¿æ–œç‡çš„å•è°ƒæ€§æ­£ç¡®ã€‚  
- **æ¥è‡ªé¢˜è§£ä½œè€…çš„ç»éªŒ**ï¼šâ€œä½¿ç”¨äº¤å‰ç›¸ä¹˜é¿å…æµ®ç‚¹è¯¯å·®ï¼Œå¯ä»¥æé«˜ä»£ç çš„é²æ£’æ€§ã€‚â€  
- **ç‚¹è¯„**ï¼šæµ®ç‚¹è¯¯å·®æ˜¯æ–œç‡ä¼˜åŒ–ä¸­çš„å¸¸è§é—®é¢˜ï¼Œäº¤å‰ç›¸ä¹˜æ˜¯æœ‰æ•ˆçš„è§£å†³æ–¹æ³•ã€‚


## ğŸ‰ ç»“è¯­
æœ¬æ¬¡åˆ†æäº†APIO2010ç‰¹åˆ«è¡ŒåŠ¨é˜Ÿçš„é¢˜è§£ï¼Œé‡ç‚¹è®²è§£äº†æ–œç‡ä¼˜åŒ–DPçš„æ ¸å¿ƒæ€è·¯ã€æ¨å¯¼è¿‡ç¨‹å’Œä»£ç å®ç°ã€‚å¸Œæœ›è¿™ä»½æŒ‡å—èƒ½å¸®åŠ©ä½ ç†è§£æ–œç‡ä¼˜åŒ–çš„æœ¬è´¨ï¼Œå¹¶åœ¨åç»­çš„ç»ƒä¹ ä¸­ä¸¾ä¸€åä¸‰ã€‚è®°ä½ï¼Œç¼–ç¨‹çš„å…³é”®æ˜¯**å¤šæ€è€ƒã€å¤šç»ƒä¹ **ï¼Œç¥ä½ åœ¨ç®—æ³•çš„é“è·¯ä¸Šè¶Šèµ°è¶Šè¿œï¼ğŸ’ª


**æ›´å¤šç²¾å½©å†…å®¹ï¼Œè¯·å…³æ³¨Kayçš„ç®—æ³•è¯¾å ‚ï¼** ğŸ“š

---
å¤„ç†ç”¨æ—¶ï¼š178.41ç§’
# é¢˜ç›®ä¿¡æ¯

# [CQOI2016] ä¸åŒçš„æœ€å°å‰²

## é¢˜ç›®æè¿°

å­¦è¿‡å›¾è®ºçš„åŒå­¦éƒ½çŸ¥é“æœ€å°å‰²çš„æ¦‚å¿µï¼šå¯¹äºä¸€ä¸ªå›¾ï¼ŒæŸä¸ªå¯¹å›¾ä¸­ç»“ç‚¹çš„åˆ’åˆ†å°†å›¾ä¸­æ‰€æœ‰ç»“ç‚¹åˆ†æˆä¸¤ä¸ªéƒ¨åˆ†ï¼Œå¦‚æœç»“ç‚¹ $s,t$ ä¸åœ¨åŒä¸€ä¸ªéƒ¨åˆ†ä¸­ï¼Œåˆ™ç§°è¿™ä¸ªåˆ’åˆ†æ˜¯å…³äº $s,t$ çš„å‰²ã€‚å¯¹äºå¸¦æƒå›¾æ¥è¯´ï¼Œå°†æ‰€æœ‰é¡¶ç‚¹å¤„åœ¨ä¸åŒéƒ¨åˆ†çš„è¾¹çš„æƒå€¼ç›¸åŠ æ‰€å¾—åˆ°çš„å€¼å®šä¹‰ä¸ºè¿™ä¸ªå‰²çš„å®¹é‡ï¼Œè€Œ $s,t$ çš„æœ€å°å‰²æŒ‡çš„æ˜¯åœ¨å…³äº $s,t$ çš„å‰²ä¸­å®¹é‡æœ€å°çš„å‰²ã€‚

è€Œå¯¹å†²åˆº NOI ç«èµ›çš„é€‰æ‰‹è€Œè¨€ï¼Œæ±‚å¸¦æƒå›¾ä¸­ä¸¤ç‚¹çš„æœ€å°å‰²å·²ç»ä¸æ˜¯ä»€ä¹ˆéš¾äº‹äº†ã€‚æˆ‘ä»¬å¯ä»¥æŠŠè§†é‡æ”¾å®½ï¼Œè€ƒè™‘æœ‰ $N$ ä¸ªç‚¹çš„æ— å‘è¿é€šå›¾ä¸­æ‰€æœ‰ç‚¹å¯¹çš„æœ€å°å‰²çš„å®¹é‡ï¼Œå…±èƒ½å¾—åˆ° $N(N-1)/2$ ä¸ªæ•°å€¼ã€‚è¿™äº›æ•°å€¼ä¸­äº’ä¸ç›¸åŒçš„æœ‰å¤šå°‘ä¸ªå‘¢ï¼Ÿè¿™ä¼¼ä¹æ˜¯ä¸ªæœ‰è¶£çš„é—®é¢˜ã€‚

## è¯´æ˜/æç¤º

$1\leq N\leq 850,1\leq M\leq 8500,1\leq w\leq 100000$ã€‚

## æ ·ä¾‹ #1

### è¾“å…¥

```
4 4
1 2 3
1 3 6
2 4 5
3 4 4```

### è¾“å‡º

```
3```

# AIåˆ†æç»“æœ


# ğŸ’¡ Kayçš„C++ç®—æ³•è§£æï¼š[CQOI2016] ä¸åŒçš„æœ€å°å‰² æ·±å…¥å­¦ä¹ æŒ‡å— ğŸ’¡

## 1. é¢˜ç›®è§£è¯»ä¸æ ¸å¿ƒç®—æ³•è¯†åˆ«

âœ¨ **æœ¬é¢˜ä¸»è¦è€ƒå¯Ÿ**ï¼šæœ€å°å‰²æ ‘ï¼ˆå›¾è®ºï¼‰

ğŸ—£ï¸ **åˆæ­¥åˆ†æ**ï¼š
> è§£å†³"ä¸åŒçš„æœ€å°å‰²"è¿™é“é¢˜ï¼Œå…³é”®åœ¨äºç†è§£å¹¶è¿ç”¨**æœ€å°å‰²æ ‘**ç®—æ³•ã€‚ç®€å•æ¥è¯´ï¼Œæœ€å°å‰²æ ‘å°±åƒæŠŠå›¾"å‹ç¼©"æˆä¸€æ£µæ ‘ï¼Œæ ‘ä¸Šä»»æ„ä¸¤ç‚¹çš„è·¯å¾„æœ€å°å€¼å°±æ˜¯åŸå›¾ä¸­è¿™ä¸¤ç‚¹çš„æœ€å°å‰²å€¼ã€‚  
> - é¢˜è§£æ€è·¯ï¼šé€šè¿‡åˆ†æ²»ç­–ç•¥é€’å½’è®¡ç®—æœ€å°å‰²ï¼Œæ¯æ¬¡é€‰ä¸¤ç‚¹æ±‚æœ€å°å‰²åå°†å›¾åˆ†ä¸ºä¸¤ä¸ªé›†åˆï¼Œæœ€ç»ˆç”¨setç»Ÿè®¡ä¸åŒå‰²å€¼  
> - æ ¸å¿ƒéš¾ç‚¹ï¼šé¿å…é‡å¤è®¡ç®—ï¼ˆæœ€å°å‰²æ ‘æ€§è´¨ï¼‰ã€é«˜æ•ˆå¤„ç†å¤šæ¬¡æœ€å°å‰²ï¼ˆåˆ†æ²»ä¼˜åŒ–ï¼‰  
> - å¯è§†åŒ–è®¾è®¡ï¼šåœ¨åƒç´ ç½‘æ ¼ä¸­ç”¨é¢œè‰²åŒºåˆ†é›†åˆï¼ˆçº¢/è“ï¼‰ï¼Œåˆ‡å‰²æ—¶é«˜äº®å½“å‰ç‚¹å¯¹ï¼Œé€’å½’æ—¶æ˜¾ç¤ºå­é›†æ”¶ç¼©åŠ¨ç”»  
> - å¤å¤æ¸¸æˆåŒ–ï¼šé‡‡ç”¨8ä½FCé£æ ¼ï¼Œåˆ‡å‰²éŸ³æ•ˆï¼ˆ"å’”åš“"å£°ï¼‰ï¼Œè¿‡å…³æç¤ºï¼ˆæ¯å®Œæˆä¸€æ¬¡åˆ†æ²»æ’­æ”¾èƒœåˆ©éŸ³æ•ˆï¼‰

---

## 2. ç²¾é€‰ä¼˜è´¨é¢˜è§£å‚è€ƒ

**é¢˜è§£ä¸€ï¼ˆshadowice1984ï¼‰**
* **ç‚¹è¯„**ï¼šæ€è·¯æ¸…æ™°ç›´å‡»æ ¸å¿ƒï¼Œé€šè¿‡æ·±åº¦æ’åºç‚¹é›†å®ç°é«˜æ•ˆåˆ†æ²»ã€‚ä»£ç è§„èŒƒï¼ˆå¤ä½è¾¹æƒæ“ä½œä¸¥è°¨ï¼‰ï¼Œç®—æ³•ä¼˜åŒ–åˆ°ä½ï¼ˆç©ºé—´å¤æ‚åº¦O(n)ï¼‰ã€‚Dinicå®ç°ç®€æ´ï¼Œsetå»é‡å·§å¦™ã€‚å®è·µä»·å€¼é«˜ï¼Œå¯ç›´æ¥ç”¨äºç«èµ›ã€‚

**é¢˜è§£äºŒï¼ˆagicyï¼‰**
* **ç‚¹è¯„**ï¼šå›¾è§£æœ€å°å‰²æ ‘å¸®åŠ©ç†è§£ï¼ŒISAPå®ç°è§„èŒƒã€‚é€’å½’åˆ’åˆ†é€»è¾‘ä¸¥è°¨ï¼Œè¾¹ç•Œå¤„ç†å®Œæ•´ã€‚äº®ç‚¹åœ¨äºå¯è§†åŒ–æ€ç»´å¼•å¯¼ï¼Œä»£ç å¯è¯»æ€§å¼ºï¼Œå˜é‡å‘½åæ˜ç¡®ï¼ˆå¦‚`fa[]`æ•°ç»„ï¼‰ï¼Œè°ƒè¯•æŠ€å·§å®ç”¨ã€‚

**é¢˜è§£ä¸‰ï¼ˆOrion545ï¼‰**
* **ç‚¹è¯„**ï¼šåˆ†æ²»è¾¹ç•Œå¤„ç†æ¸…æ™°ï¼Œé‚»æ¥è¡¨å­˜è¾¹é«˜æ•ˆã€‚setç»Ÿè®¡ç®€æ´æ˜äº†ï¼Œä»£ç ç»“æ„å·¥æ•´ã€‚äº®ç‚¹åœ¨äºå¹³è¡¡äº†ç®€æ´æ€§ä¸å®Œæ•´æ€§ï¼Œé€‚åˆåˆå­¦è€…ç†è§£æœ€å°å‰²æ ‘çš„æ ¸å¿ƒæ¡†æ¶ã€‚

---

## 3. æ ¸å¿ƒéš¾ç‚¹è¾¨æä¸è§£é¢˜ç­–ç•¥

1. **å¦‚ä½•é¿å…é‡å¤è®¡ç®—ï¼Ÿ**  
   * **åˆ†æ**ï¼šæœ€å°å‰²æ ‘çš„æ ¸å¿ƒæ€§è´¨â€”â€”æ ‘ä¸Šè·¯å¾„æœ€å°å€¼ç­‰äºç‚¹å¯¹æœ€å°å‰²ã€‚ä¼˜è´¨é¢˜è§£é€šè¿‡åˆ†æ²»é€’å½’æ—¶ä¼ é€’å½“å‰æœ€å°å‰²å€¼ï¼ˆå¦‚`ans[x][y] = min(ans[x][s], ans[t][y], cut_val)`ï¼‰é¿å…é‡å¤
   * ğŸ’¡ å­¦ä¹ ç¬”è®°ï¼šæœ€å°å‰²æ ‘å°†æŒ‡æ•°çº§è®¡ç®—é™ä¸ºçº¿æ€§çº§

2. **å¦‚ä½•é«˜æ•ˆåˆ’åˆ†é›†åˆï¼Ÿ**  
   * **åˆ†æ**ï¼šè·‘å®Œæœ€å°å‰²åä»èµ·ç‚¹BFSæ ‡è®°å¯è¾¾ç‚¹ï¼ˆ`vis[]`æ•°ç»„ï¼‰ï¼ŒæŒ‰æ·±åº¦æ’åºç‚¹é›†ï¼ˆ`sort(a+l, a+r+1, cmp)`ï¼‰å®ç°O(1)åˆ’åˆ†
   * ğŸ’¡ å­¦ä¹ ç¬”è®°ï¼šæ·±åº¦ä¿¡æ¯æ˜¯å¤©ç„¶çš„åˆ†å‰²çº¿

3. **å¦‚ä½•ç»Ÿè®¡ä¸åŒå€¼ï¼Ÿ**  
   * **åˆ†æ**ï¼šç”¨setè‡ªåŠ¨å»é‡ï¼ˆ`se.insert(cut_val)`ï¼‰æˆ–æ’åºå`unique`ã€‚å…³é”®æŠ€å·§ï¼šä»…éœ€å­˜N-1ä¸ªå‰²å€¼è€ŒénÂ²ä¸ª
   * ğŸ’¡ å­¦ä¹ ç¬”è®°ï¼šsetçš„å»é‡ç‰¹æ€§æ˜¯ç»Ÿè®¡åˆ©å™¨

### âœ¨ è§£é¢˜æŠ€å·§æ€»ç»“
- **åˆ†æ²»æŠ½è±¡**ï¼šå°†å›¾é€’å½’åˆ†å‰²ä¸ºå­é›†ï¼ŒåŒ–æ•´ä¸ºé›¶
- **çŠ¶æ€å¤ä½**ï¼šæ¯æ¬¡Dinicåå¤ä½è¾¹æƒï¼ˆ`for(i) edge[i].cot=reset[i]`ï¼‰
- **è¾¹ç•Œé˜²å¾¡**ï¼šå•ç‚¹é›†åˆç«‹å³è¿”å›ï¼ˆ`if(l>=r) return;`ï¼‰

---

## 4. C++æ ¸å¿ƒä»£ç å®ç°èµæ

**æœ¬é¢˜é€šç”¨æ ¸å¿ƒC++å®ç°å‚è€ƒ**
```cpp
#include<cstdio>
#include<algorithm>
#include<set>
using namespace std;
const int N=850, INF=0x3f3f3f3f;
// ... ç½‘ç»œæµå®ç°çœç•¥
set<int> ansSet;

void solve(int l, int r, int node[]){
    if(l>=r) return;
    int s=node[l], t=node[l+1];
    int cutVal = dinic(s, t); // æ±‚æœ€å°å‰²
    ansSet.insert(cutVal);
    
    // æŒ‰æ·±åº¦åˆ’åˆ†é›†åˆ
    sort(node+l, node+r+1, [](int a,int b){return dep[a]<dep[b];});
    int mid = partition_point(node+l, node+r+1, [](int x){return dep[x]!=INF;}) - node;
    
    solve(l, mid-1, node); // é€’å½’å·¦å­é›†
    solve(mid, r, node);   // é€’å½’å³å­é›†
}

int main(){
    // è¯»å›¾åˆå§‹åŒ–
    int nodes[N];
    for(int i=1;i<=n;i++) nodes[i]=i;
    solve(1, n, nodes);
    printf("%d", ansSet.size());
}
```
* **è¯´æ˜**ï¼šç»¼åˆä¼˜è´¨é¢˜è§£çš„åˆ†æ²»æ¡†æ¶ï¼Œçªå‡ºæœ€å°å‰²æ ‘æ ¸å¿ƒé€»è¾‘
* **ä»£ç è§£è¯»æ¦‚è¦**ï¼š
  1. åˆå§‹åŒ–ç‚¹é›†ä¸º[1..n]
  2. `solve()`é€’å½’åˆ†æ²»ï¼šé€‰é¦–ä¸¤ç‚¹æ±‚æœ€å°å‰² â†’ åˆ’åˆ†é›†åˆ â†’ é€’å½’å­é›†
  3. setè‡ªåŠ¨å»é‡ï¼Œæœ€åè¾“å‡ºsize

---

**é¢˜è§£ä¸€æ ¸å¿ƒç‰‡æ®µï¼ˆshadowice1984ï¼‰**
```cpp
// åˆ’åˆ†ç‚¹é›†é€»è¾‘
sort(a+l, a+r+1, cmp); // æŒ‰æ·±åº¦æ’åº
for(int i=l; i<=r; i++) 
    if(dep[a[i]]==INF) cut=i; // æ‰¾åˆ†å‰²ç‚¹
solve(l, cut-1); solve(cut, r);
```
* **äº®ç‚¹**ï¼šæ·±åº¦æ’åºå®ç°é«˜æ•ˆåˆ’åˆ†
* **å­¦ä¹ ç¬”è®°**ï¼šåˆ©ç”¨BFSåçš„æ·±åº¦ä¿¡æ¯è‡ªç„¶åˆ†å‰²

**é¢˜è§£äºŒæ ¸å¿ƒç‰‡æ®µï¼ˆagicyï¼‰**
```cpp
// é€’å½’åˆ’åˆ†
vector<int> setS, setT;
for(int i: nodes) 
    (vis[i] ? setS : setT).push_back(i);
solve(setS); solve(setT);
```
* **äº®ç‚¹**ï¼šSTLå®¹å™¨æ¸…æ™°åˆ’åˆ†é›†åˆ
* **å­¦ä¹ ç¬”è®°**ï¼šå®¹å™¨æ“ä½œæå‡å¯è¯»æ€§

**é¢˜è§£ä¸‰æ ¸å¿ƒç‰‡æ®µï¼ˆOrion545ï¼‰**
```cpp
// setå»é‡ç»Ÿè®¡
set<int> se;
se.insert(cut_val);
printf("%d",se.size());
```
* **äº®ç‚¹**ï¼šæç®€ç»Ÿè®¡é€»è¾‘
* **å­¦ä¹ ç¬”è®°**ï¼šå–„ç”¨STLç®€åŒ–ä»£ç 

---

## 5. ç®—æ³•å¯è§†åŒ–ï¼šåƒç´ åŠ¨ç”»æ¼”ç¤º

**åƒç´ æ¢é™©å®¶ï¼šæœ€å°å‰²æ ‘å»ºé€ è®°**  
![æœ€å°å‰²æ ‘åˆ†æ²»ç¤ºæ„å›¾](https://i.imgur.com/8WgTbGs.gif)  
*(æ¨¡æ‹Ÿå±•ç¤ºï¼šçº¢è“ç‚¹åˆ†æ²»è¿‡ç¨‹)*

### è®¾è®¡æ–¹æ¡ˆ
- **8ä½åƒç´ é£æ ¼**ï¼šç‚¹é˜µå›¾ï¼ˆç‚¹=èŠ‚ç‚¹ï¼Œçº¿=è¾¹ï¼‰ï¼Œè°ƒè‰²ç›˜â‰¤16è‰²
- **åŠ¨ç”»æµç¨‹**ï¼š
  1. **åˆå§‹åŒ–**ï¼šæ‰€æœ‰ç‚¹ç°è‰²ï¼Œæ’­æ”¾8bitèƒŒæ™¯éŸ³ä¹
  2. **åˆ†æ²»åˆ‡å‰²**ï¼š
     - é€‰ä¸¤ç‚¹é«˜äº®é»„è‰² â†’ è·‘æœ€å°å‰²ï¼ˆçº¢çº¿æ³¢åŠ¨åŠ¨ç”»ï¼‰
     - å‰²å®Œåå·¦ä¾§å˜çº¢/å³ä¾§å˜è“ â†’ "å’”åš“"éŸ³æ•ˆ
     - æ˜¾ç¤ºå½“å‰å‰²å€¼ï¼ˆåƒç´ å­—ä½“å¼¹å‡ºï¼‰
  3. **é€’å½’æ¼”ç¤º**ï¼šå­é›†æ”¶ç¼©ä¸ºå­æ ‘ï¼ˆç¼©æ”¾åŠ¨ç”»ï¼‰
  4. **ç»“æŸ**ï¼šæ ‘å»ºæˆæ—¶æ’­æ”¾èƒœåˆ©éŸ³æ•ˆï¼Œæ˜¾ç¤ºä¸åŒå‰²å€¼æ•°é‡
- **äº¤äº’æ§åˆ¶**ï¼š
  - æ­¥è¿›/æš‚åœï¼šç©ºæ ¼é”®
  - è°ƒé€Ÿæ»‘å—ï¼šæ§åˆ¶åˆ†æ²»é€Ÿåº¦
  - AIæ¨¡å¼ï¼šè‡ªåŠ¨æ’­æ”¾ï¼ˆå¦‚è´ªåƒè›‡è‡ªåŠ¨åˆ†æ²»ï¼‰
- **æŠ€æœ¯å®ç°**ï¼šCanvasç»˜åˆ¶ç½‘æ ¼ï¼ŒrequestAnimationFrameé©±åŠ¨åŠ¨ç”»

---

## 6. æ‹“å±•ç»ƒä¹ ä¸ç›¸ä¼¼é—®é¢˜æ€è€ƒ

1. **æœ€å°å‰²æ ‘æ¨¡æ¿é¢˜**ï¼šæ´›è°·P4897 [æ¨¡æ¿]æœ€å°å‰²æ ‘ï¼ˆé™æ€æŸ¥è¯¢ç‚¹å¯¹æœ€å°å‰²ï¼‰
2. **æœ€å°å‰²è¿›é˜¶åº”ç”¨**ï¼šæ´›è°·P4123 [CQOI2016]ä¸åŒçš„æœ€å°å‰²ï¼ˆæœ¬é¢˜å˜å½¢ï¼‰
3. **ç½‘ç»œæµåŸºç¡€**ï¼šæ´›è°·P3376 ç½‘ç»œæœ€å¤§æµï¼ˆDinic/ISAPç»ƒä¹ ï¼‰

> ğŸ—£ï¸ **æ¨èç†ç”±**ï¼š  
> é€šè¿‡æ¨¡æ¿é¢˜å·©å›ºæœ€å°å‰²æ ‘æ€æƒ³ï¼Œå†æŒ‘æˆ˜æœ¬é¢˜çš„ç»Ÿè®¡å˜å½¢ï¼Œæœ€åç”¨æœ€å¤§æµå¤¯å®åŸºç¡€

---

## 7. å­¦ä¹ å¿ƒå¾—ä¸ç»éªŒåˆ†äº«

> **æ¥è‡ªé¢˜è§£çš„ç»éªŒ**ï¼š  
> "å¤ä½è¾¹æƒæ˜¯è°ƒè¯•å…³é”®â€”â€”æ¯æ¬¡Dinicåéœ€è¿˜åŸåŸå›¾è¾¹æƒï¼Œå¦åˆ™åç»­è®¡ç®—ä¼šé”™è¯¯"  
>   
> **Kayç‚¹è¯„**ï¼š  
> è¿™æé†’æˆ‘ä»¬ï¼šç½‘ç»œæµç®—æ³•ä¼šæ”¹å˜è¾¹çŠ¶æ€ï¼Œåƒæ—¶å…‰å€’æµä¸€æ ·å¤ä½è¾¹æƒæ‰èƒ½ä¿è¯åˆ†æ²»æ­£ç¡®æ€§ã€‚å»ºè®®å°è£…`resetGraph()`å‡½æ•°

---

> æœ€å°å‰²æ ‘å¦‚åŒåœ¨å›¾ä¸­ç§ä¸‹ä¸€æ£µæ ‘ï¼Œæ¯ä¸ªåˆ†å‰éƒ½è®°å½•ç€åˆ‡å‰²çš„ç—•è¿¹ã€‚ç†è§£åˆ†æ²»çš„é€’å½’ç¾ï¼Œä½ å°±èƒ½å¬è§å›¾è®ºçš„ä½è¯­ã€‚ä¸‹æ¬¡æˆ‘ä»¬ç»§ç»­æ¢ç´¢ç®—æ³•çš„å¥¥ç§˜ï¼ğŸ’ª

---
å¤„ç†ç”¨æ—¶ï¼š106.37ç§’
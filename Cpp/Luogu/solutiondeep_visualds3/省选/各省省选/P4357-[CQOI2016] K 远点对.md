# é¢˜ç›®ä¿¡æ¯

# [CQOI2016] K è¿œç‚¹å¯¹

## é¢˜ç›®æè¿°

å·²çŸ¥å¹³é¢å†… $N$ ä¸ªç‚¹çš„åæ ‡ï¼Œæ±‚æ¬§æ°è·ç¦»ä¸‹çš„ç¬¬ $K$ è¿œç‚¹å¯¹ã€‚

ä¸¤ä¸ªç‚¹ $P(x_1,y_1)$ å’Œ $Q(x_2,y_2)$ çš„æ¬§æ°è·ç¦»å®šä¹‰ä¸º $\sqrt{(x_1-x_2)^2+(y_1-y_2)^2}$

## è¯´æ˜/æç¤º

å¯¹äº $100\%$ çš„æµ‹è¯•ç‚¹ï¼Œ$N \le 100000,1 \le K \le 100,K \le \dfrac {N(N-1)}{2},0 \le X,Y < 2^{31}$

## æ ·ä¾‹ #1

### è¾“å…¥

```
10 5
0 0
0 1
1 0
1 1
2 0
2 1
1 2
0 2
3 0
3 1```

### è¾“å‡º

```
9```

# AIåˆ†æç»“æœ


### ğŸ’¡ Kayçš„C++ç®—æ³•è§£æï¼šKè¿œç‚¹å¯¹ æ·±å…¥å­¦ä¹ æŒ‡å— ğŸ’¡

#### é¢˜ç›®è§£è¯»ä¸æ ¸å¿ƒç®—æ³•è¯†åˆ«
âœ¨ **æœ¬é¢˜ä¸»è¦è€ƒå¯Ÿ**ï¼š`è®¡ç®—å‡ ä½•ï¼ˆæ—‹è½¬å¡å£³ï¼‰` + `å †çš„åº”ç”¨`  
ğŸ—£ï¸ **åˆæ­¥åˆ†æ**ï¼š  
> è§£å†³Kè¿œç‚¹å¯¹é—®é¢˜ï¼Œæ ¸å¿ƒåœ¨äº**é«˜æ•ˆè·å–å½“å‰æœ€è¿œç‚¹å¯¹**å¹¶**åŠ¨æ€ç»´æŠ¤å‰Kå¤§è·ç¦»**ã€‚æ—‹è½¬å¡å£³ç®—æ³•å°±åƒåœ¨ç‚¹é›†ä¸­æ¶è®¾ä¸¤æŠŠå¯æ—‹è½¬çš„å¡å°ºï¼Œå¿«é€Ÿæ‰«æå‡¸åŒ…è¾¹ç•Œæ‰¾åˆ°ç›´å¾„ï¼ˆæœ€è¿œç‚¹å¯¹ï¼‰ã€‚æ¯æ¬¡æ‰¾åˆ°ç›´å¾„åï¼Œæˆ‘ä»¬å°†è¿™ä¸¤ä¸ªç‚¹ä¸æ‰€æœ‰æœªåˆ é™¤ç‚¹çš„è·ç¦»åŠ å…¥å°æ ¹å †ï¼ˆå®¹é‡ä¸ºKï¼‰ï¼Œç„¶ååˆ é™¤è¿™ä¸¤ä¸ªç‚¹ã€‚é‡å¤Kæ¬¡åï¼Œå †é¡¶å³ä¸ºç­”æ¡ˆã€‚  
> - **éš¾ç‚¹**ï¼šå‡¸åŒ…æ„å»ºçš„ç¨³å®šæ€§ã€æ—‹è½¬å¡å£³æŒ‡é’ˆç§»åŠ¨é€»è¾‘ã€å †çš„å®¹é‡æ§åˆ¶  
> - **å¯è§†åŒ–è®¾è®¡**ï¼šç”¨åƒç´ æ–¹å—è¡¨ç¤ºç‚¹é›†ï¼Œå‡¸åŒ…è¾¹ç•Œç”¨ç»¿è‰²çº¿æ¡åŠ¨æ€ç»˜åˆ¶ï¼›æ—‹è½¬å¡å£³è¿‡ç¨‹ç”¨ä¸¤ä¸ªçº¢è‰²ç®­å¤´æ²¿å‡¸åŒ…ç§»åŠ¨ï¼Œè·ç¦»è®¡ç®—æ—¶é«˜äº®è¿çº¿ï¼›å †ç”¨åƒç´ åŒ–æŸ±çŠ¶å›¾å®æ—¶æ˜¾ç¤ºè·ç¦»å€¼  
> - **æ¸¸æˆåŒ–å…ƒç´ **ï¼šæ¯æ¬¡æ‰¾åˆ°ç›´å¾„æ’­æ”¾"èƒœåˆ©éŸ³æ•ˆ"ï¼Œåˆ é™¤ç‚¹æ—¶è§¦å‘"çˆ†ç‚¸åŠ¨ç”»"ï¼Œå †æ»¡æ—¶æ’­æ”¾"å‡çº§éŸ³æ•ˆ"

---

#### ç²¾é€‰ä¼˜è´¨é¢˜è§£å‚è€ƒ
**é¢˜è§£ä¸€ï¼ˆFZzzzï¼‰**  
* **ç‚¹è¯„**ï¼šæ€è·¯æ¸…æ™°ï¼ˆé€šè¿‡åå¤æ±‚ç›´å¾„+åˆ ç‚¹ç­–ç•¥ï¼‰ï¼Œä»£ç å®Œæ•´åŒ…å«å‡¸åŒ…æ„å»ºå’Œæ—‹è½¬å¡å£³å®ç°ã€‚äº®ç‚¹åœ¨äºé‡‡ç”¨**å›ºå®šå¤§å°å †**ï¼ˆä»…ç»´æŠ¤Kä¸ªå€¼ï¼‰é™ä½ç©ºé—´å¤æ‚åº¦ã€‚å˜é‡å‘½ååˆç†ï¼ˆå¦‚`dist`è®¡ç®—è·ç¦»å¹³æ–¹ï¼‰ï¼Œè¾¹ç•Œå¤„ç†ä¸¥è°¨ï¼ˆå‡¸åŒ…é€€åŒ–æƒ…å†µï¼‰ã€‚æ—¶é—´å¤æ‚åº¦O(nk log n)å¯æ¥å—ï¼Œä½†å‡¸åŒ…é‡æ„éƒ¨åˆ†å¯ä¼˜åŒ–ã€‚

**é¢˜è§£äºŒï¼ˆ_szh_ï¼‰**  
* **ç‚¹è¯„**ï¼šé€»è¾‘ä¸é¢˜è§£ä¸€ç±»ä¼¼ä½†ç»“æ„æ›´æ¸…æ™°ï¼Œäº®ç‚¹åœ¨äº**æ¨¡å—åŒ–è®¾è®¡**ï¼ˆåˆ†ç¦»å‡¸åŒ…æ„å»º/æ—‹è½¬å¡å£³/å †æ“ä½œï¼‰ã€‚ä»£ç è§„èŒƒæ€§å¼ºï¼ˆè¯¦ç»†æ³¨é‡Šã€å‡½æ•°å°è£…ï¼‰ï¼Œå®è·µä»·å€¼é«˜ã€‚ç‰¹åˆ«æ³¨é‡å‡¸åŒ…æ„å»ºçš„å®Œæ•´æ€§ï¼ˆä¸Šä¸‹å‡¸åŒ…åˆ†ç¦»å¤„ç†ï¼‰ï¼Œæ—‹è½¬å¡å£³çš„æŒ‡é’ˆç§»åŠ¨é€»è¾‘æ›´æ˜“ç†è§£ã€‚

---

#### æ ¸å¿ƒéš¾ç‚¹è¾¨æä¸è§£é¢˜ç­–ç•¥
1. **å‡¸åŒ…æ„å»ºç¨³å®šæ€§**  
   * **åˆ†æ**ï¼šå‡¸åŒ…æ˜¯æ—‹è½¬å¡å£³çš„åŸºç¡€ã€‚ä¼˜è´¨é¢˜è§£ç”¨Andrewç®—æ³•ï¼šå…ˆæŒ‰xæ’åºï¼Œåˆ†åˆ«æ„å»ºä¸‹/ä¸Šå‡¸åŒ…ï¼ˆåˆ¤æ–­å‰ç§¯â‰¤0ï¼‰ã€‚å…³é”®ç‚¹åœ¨äºå¤„ç†å…±çº¿æƒ…å†µï¼ˆå‰ç§¯=0æ—¶ä¿ç•™æœ€è¿œç‚¹ï¼‰  
   * ğŸ’¡ **å­¦ä¹ ç¬”è®°**ï¼šå‡¸åŒ…æ˜¯ç‚¹é›†çš„"æœ€å°å‡¸è¾¹ç•Œ"ï¼Œå‡å°‘è®¡ç®—é‡  

2. **æ—‹è½¬å¡å£³æ±‚ç›´å¾„**  
   * **åˆ†æ**ï¼šå›ºå®šå‡¸åŒ…ä¸€æ¡è¾¹ï¼Œç§»åŠ¨å¯¹è¸µç‚¹ä½¿ä¸‰è§’å½¢é¢ç§¯æœ€å¤§ï¼ˆå‰ç§¯åˆ¤æ–­ï¼‰ã€‚å½“`cross(A,B,C)>cross(A,B,D)`æ—¶ç§»åŠ¨æŒ‡é’ˆï¼ŒåŒæ—¶æ£€æŸ¥ç«¯ç‚¹è·ç¦»  
   * ğŸ’¡ **å­¦ä¹ ç¬”è®°**ï¼šå¯¹è¸µç‚¹å³å‡¸åŒ…ä¸Šè·ç¦»æœ€è¿œçš„ç‚¹å¯¹  

3. **å †çš„å®¹é‡æ§åˆ¶**  
   * **åˆ†æ**ï¼šä½¿ç”¨`priority_queue<ll,vector<ll>,greater<ll>>`ï¼ˆå°æ ¹å †ï¼‰ï¼Œæ¯æ¬¡æ’å…¥åæ£€æŸ¥`if(pq.size()>k)pq.pop()`ã€‚å…³é”®æŠ€å·§ï¼šå…ˆæ’å…¥æ‰€æœ‰ç›¸å…³è·ç¦»å†ç»Ÿä¸€æ¸…ç†  
   * ğŸ’¡ **å­¦ä¹ ç¬”è®°**ï¼šç»´æŠ¤ç¬¬Kå¤§å€¼ç”¨å°æ ¹å †ï¼Œå †é¡¶å³åˆ†ç•Œçº¿  

âœ¨ **è§£é¢˜æŠ€å·§æ€»ç»“**  
- **å¢é‡ç»´æŠ¤**ï¼šæ¯æ¬¡åªåˆ 2ä¸ªç‚¹ï¼Œé¿å…å…¨å±€é‡ç®—  
- **å‡ ä½•ä¼˜åŒ–**ï¼šç”¨è·ç¦»å¹³æ–¹é¿å…æµ®ç‚¹è¯¯å·®  
- **å †å‰ªæ**ï¼šæ’å…¥å‰æ£€æŸ¥`if(dist>pq.top())`å‡å°‘æ“ä½œ  

---

#### C++æ ¸å¿ƒä»£ç å®ç°èµæ
**é€šç”¨æ ¸å¿ƒå®ç°å‚è€ƒ**  
```cpp
#include <iostream>
#include <vector>
#include <queue>
#include <algorithm>
using namespace std;
typedef long long ll;

struct Point { ll x, y; };
vector<Point> pts;
vector<int> convexHull(vector<int>& idx) {
    sort(idx.begin(), idx.end(), [&](int a, int b) {
        return pts[a].x < pts[b].x || (pts[a].x==pts[b].x && pts[a].y<pts[b].y);
    });
    vector<int> hull;
    // ä¸‹å‡¸åŒ…
    for (int i : idx) {
        while (hull.size() >= 2) {
            int a = hull[hull.size()-2], b = hull.back();
            if ((pts[b]-pts[a])Ã—(pts[i]-pts[a]) <= 0) break;
            hull.pop_back();
        }
        hull.push_back(i);
    }
    // ä¸Šå‡¸åŒ…ï¼ˆä»£ç ç±»ä¼¼ï¼Œç•¥ï¼‰
    return hull;
}

pair<int,int> findDiameter(vector<int>& hull) {
    int j = 1, n = hull.size();
    for (int i = 0; i < n; i++) {
        while ((pts[hull[i]]-pts[hull[(i+1)%n]])Ã—(pts[hull[(j+1)%n]]-pts[hull[j]]) > 0)
            j = (j+1) % n;
        // æ›´æ–°æœ€å¤§è·ç¦»ï¼ˆç•¥ï¼‰
    }
}

int main() {
    priority_queue<ll, vector<ll>, greater<ll>> pq;
    vector<bool> deleted(n, false);
    for (int iter = 0; iter < k; iter++) {
        vector<int> idx;
        for (int i = 0; i < n; i++) if (!deleted[i]) idx.push_back(i);
        auto hull = convexHull(idx);
        auto [a,b] = findDiameter(hull);
        deleted[a]=deleted[b]=true;

        for (int i : idx) {
            pq.push(dist(pts[i],pts[a]));
            pq.push(dist(pts[i],pts[b]));
            while (pq.size() > k) pq.pop();
        }
    }
    cout << pq.top();
}
```

**é¢˜è§£ä¸€ï¼ˆFZzzzï¼‰ç‰‡æ®µ**  
```cpp
// æ—‹è½¬å¡å£³æ ¸å¿ƒ
while (cross(s[i], s[i+1], s[(cur+1)%tp]) > cross(s[i], s[i+1], s[cur])) 
    cur = (cur+1)%tp; 
if (dist(s[cur],s[i]) > maxDist) 
    update_max_pair();
```
**è§£è¯»**ï¼š  
> `cross`è®¡ç®—ä¸‰è§’å½¢é¢ç§¯ï¼ˆåˆ¤æ–­å¯¹è¸µç‚¹ï¼‰ï¼Œå½“é¢ç§¯å¢å¤§æ—¶ç§»åŠ¨`cur`æŒ‡é’ˆã€‚`dist`è®¡ç®—è·ç¦»å¹³æ–¹ï¼Œé¿å…è€—æ—¶çš„`sqrt`è°ƒç”¨  

**é¢˜è§£äºŒï¼ˆ_szh_ï¼‰ç‰‡æ®µ**  
```cpp
// å †æ“ä½œ
priority_queue<int, vector<int>, greater<int>> q;
void Insert(int x) {
    if (siz < k) siz++, q.push(x);
    else if (x > q.top()) q.pop(), q.push(x);
}
```
**è§£è¯»**ï¼š  
> å°è£…å †æ’å…¥é€»è¾‘ï¼šæœªæ»¡æ—¶ç›´æ¥åŠ å…¥ï¼›å·²æ»¡æ—¶åªä¿ç•™æ›´å¤§çš„å€¼ã€‚é¿å…å†—ä½™æ“ä½œ  

---

#### ç®—æ³•å¯è§†åŒ–ï¼šåƒç´ åŠ¨ç”»æ¼”ç¤º
**ä¸»é¢˜**ï¼šåƒç´ æ¢é™©å®¶åœ¨ç‚¹é˜µä¸­å¯»æ‰¾å®è—ï¼ˆç¬¬Kè¿œç‚¹å¯¹ï¼‰  
**æ ¸å¿ƒæ¼”ç¤ºæµç¨‹**ï¼š  
1. **åˆå§‹åŒ–**ï¼š  
   - 8ä½åƒç´ é£æ ¼ï¼ˆæ£•åœŸåœ°/è“æ°´åŸŸï¼‰  
   - æ§åˆ¶é¢æ¿ï¼šé€Ÿåº¦æ»‘å—+å•æ­¥/è‡ªåŠ¨æ’­æ”¾æŒ‰é’®  
   - èƒŒæ™¯éŸ³ä¹ï¼šFCé£æ ¼å¾ªç¯BGM  

2. **å‡¸åŒ…æ„å»º**ï¼š  
   - åŠ¨æ€ç»˜åˆ¶æ‰«æçº¿ï¼ˆé»„è‰²åƒç´ å¸¦ï¼‰  
   - å‡¸åŒ…é¡¶ç‚¹é—ªçƒç»¿å…‰ + "å®"éŸ³æ•ˆ  
   - å‰ç§¯â‰¤0æ—¶è§¦å‘çº¢è‰²è­¦å‘Šé—ªå…‰  

3. **æ—‹è½¬å¡å£³**ï¼š  
   - ä¸¤æŠŠçº¢è‰²å¡å°ºæ²¿å‡¸åŒ…ç§»åŠ¨ï¼ˆ"æ»‹æ»‹"ç§»åŠ¨éŸ³æ•ˆï¼‰  
   - å½“å‰æ£€æµ‹ç‚¹é«˜äº®é»„æ¡† + è·ç¦»å€¼å®æ—¶æ˜¾ç¤º  
   - æ‰¾åˆ°ç›´å¾„æ—¶ï¼šä¸¤ç‚¹é—´ç‚¸å¼€é‡‘è‰²è·¯å¾„ + "èƒœåˆ©"éŸ³æ•ˆ  

4. **å †æ“ä½œ**ï¼š  
   - æ–°è·ç¦»å€¼ä»¥è“è‰²åƒç´ å—åŠ å…¥å³ä¾§æŸ±çŠ¶å›¾  
   - å †æ»¡æ—¶ï¼šæœ€å°è·ç¦»ï¼ˆçº¢è‰²å—ï¼‰è¢«å¼¹å‡º + "ç¢è£‚"éŸ³æ•ˆ  
   - å †é¡¶å€¼å§‹ç»ˆç”¨é‡‘è‰²è¾¹æ¡†æ ‡è®°  

**äº¤äº’è®¾è®¡**ï¼š  
- **AIæ¼”ç¤ºæ¨¡å¼**ï¼šè‡ªåŠ¨æ’­æ”¾æ—¶å¡å°ºå¦‚è´ªåƒè›‡ç§»åŠ¨  
- **å…³å¡ç³»ç»Ÿ**ï¼šæ¯å®Œæˆ1è½®=è¿‡å…³ï¼Œæ˜¾ç¤º"ç¬¬Xè¿œè·ç¦»"  
- **è°ƒè¯•è§†å›¾**ï¼šæŒ‰ç©ºæ ¼é”®æ˜¾ç¤ºå½“å‰å‡¸åŒ…é¡¶ç‚¹åæ ‡  

---

#### æ‹“å±•ç»ƒä¹ ä¸ç›¸ä¼¼é—®é¢˜æ€è€ƒ
**é€šç”¨æŠ€å·§è¿ç§»**ï¼š  
1. åŠ¨æ€ç»´æŠ¤å‰Kå¤§å€¼ï¼ˆå †åº”ç”¨ï¼‰  
2. æ—‹è½¬å¡å£³æ±‚æœ€è¿œç‚¹å¯¹ï¼ˆå‡ ä½•é—®é¢˜ï¼‰  
3. å¢é‡æ›´æ–°é¿å…å…¨å±€é‡ç®—  

**æ´›è°·æ¨è**ï¼š  
1. **P1452** Beauty Contest - æ±‚æœ€è¿œç‚¹å¯¹ï¼ˆæ—‹è½¬å¡å£³è£¸é¢˜ï¼‰  
2. **P1886** æ»‘åŠ¨çª—å£ - ç»´æŠ¤åŒºé—´æå€¼ï¼ˆå †/å•è°ƒé˜Ÿåˆ—ï¼‰  
3. **P1090** åˆå¹¶æœå­ - å †çš„ç»å…¸åº”ç”¨  

---

#### å­¦ä¹ å¿ƒå¾—ä¸ç»éªŒåˆ†äº«
> **FZzzzçš„è°ƒè¯•ç»éªŒ**ï¼š  
> *"KDæ ‘å¤æ‚åº¦æ˜¯é”™çš„ï¼Œä½†æ—‹è½¬å¡å£³è¦æ³¨æ„å‡¸åŒ…é‡å»ºçš„è¾¹ç•Œæ¡ä»¶"*  
> **Kayæ€»ç»“**ï¼šå‡ ä½•é—®é¢˜éœ€ç‰¹åˆ«æ³¨æ„é€€åŒ–æƒ…å†µï¼ˆå¦‚æ‰€æœ‰ç‚¹å…±çº¿ï¼‰ã€‚è°ƒè¯•æ—¶å»ºè®®ï¼š  
> 1. æ‰“å°å‡¸åŒ…é¡¶ç‚¹åºåˆ—  
> 2. å¯è§†åŒ–æ—‹è½¬å¡å£³çš„æŒ‡é’ˆä½ç½®  
> 3. å°æ•°æ®æ‰‹å·¥éªŒç®—å‰ç§¯å€¼  

---

é€šè¿‡æœ¬æŒ‡å—ï¼Œå¸Œæœ›å¤§å®¶æŒæ¡æ—‹è½¬å¡å£³ä¸å †çš„ååŒå·¥ä½œé€»è¾‘ï¼Œç†è§£å‡ ä½•é—®é¢˜ä¸­çš„é«˜æ•ˆç»´æŠ¤ç­–ç•¥ã€‚è®°ä½ï¼šå¥½ç®—æ³•æ˜¯ç©ºé—´ä¸æ—¶é—´çš„ç²¾å¦™å¹³è¡¡ï¼ğŸš€

---
å¤„ç†ç”¨æ—¶ï¼š184.82ç§’
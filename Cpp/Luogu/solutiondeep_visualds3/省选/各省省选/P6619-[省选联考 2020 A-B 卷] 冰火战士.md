# é¢˜ç›®ä¿¡æ¯

# [çœé€‰è”è€ƒ 2020 A/B å·] å†°ç«æˆ˜å£«

## é¢˜ç›®èƒŒæ™¯

A å· D1T1ï¼ŒB å· D1T3ã€‚

æ—¶é™ 3sï¼Œå†…å­˜ 512MBã€‚

## é¢˜ç›®æè¿°

ä¸€åœºæ¯”èµ›å³å°†å¼€å§‹ã€‚

æ¯ä½æˆ˜å£«æœ‰ä¸¤ä¸ªå±æ€§ï¼šæ¸©åº¦å’Œèƒ½é‡ï¼Œæœ‰ä¸¤æ´¾æˆ˜å£«ï¼šå†°ç³»æˆ˜å£«çš„æŠ€èƒ½ä¼šå¯¹å‘¨å›´é€ æˆé™æ¸©å†°å†»ä¼¤å®³ï¼Œå› è€Œè¦æ±‚åœºåœ°æ¸©åº¦ä¸ä½äºä»–çš„è‡ªèº«æ¸©åº¦æ‰èƒ½å‚èµ›ï¼›ç«ç³»æˆ˜å£«çš„æŠ€èƒ½ä¼šå¯¹å‘¨å›´é€ æˆå‡æ¸©ç¼çƒ§ä¼¤å®³ï¼Œå› è€Œè¦æ±‚åœºåœ°æ¸©åº¦ä¸é«˜äºä»–çš„è‡ªèº«æ¸©åº¦æ‰èƒ½å‚èµ›ã€‚

å½“åœºåœ°æ¸©åº¦ç¡®å®šæ—¶ï¼ŒåŒæ–¹èƒ½å¤Ÿå‚èµ›çš„æˆ˜å£«åˆ†åˆ«æ’æˆä¸€é˜Ÿã€‚å†°ç³»æˆ˜å£«æŒ‰è‡ªèº«æ¸©åº¦ä»ä½åˆ°é«˜æ’åºï¼Œç«ç³»æˆ˜å£«æŒ‰è‡ªèº«æ¸©åº¦ä»é«˜åˆ°ä½æ’åºï¼Œæ¸©åº¦ç›¸åŒæ—¶èƒ½é‡å¤§çš„æˆ˜å£«æ’åœ¨å‰é¢ã€‚é¦–å…ˆï¼ŒåŒæ–¹çš„ç¬¬ä¸€ä½æˆ˜å£«ä¹‹é—´å±•å¼€æˆ˜æ–—ï¼Œä¸¤ä½æˆ˜å£«æ¶ˆè€—ç›¸åŒçš„èƒ½é‡ï¼Œèƒ½é‡å°‘çš„æˆ˜å£«å°†è€—å°½èƒ½é‡é€€å‡ºæ¯”èµ›ï¼Œè€Œèƒ½é‡æœ‰å‰©ä½™çš„æˆ˜å£«å°†ç»§ç»­å’Œå¯¹æ–¹çš„ä¸‹ä¸€ä½æˆ˜å£«æˆ˜æ–—ï¼ˆèƒ½é‡éƒ½è€—å°½åˆ™åŒæ–¹ä¸‹ä¸€ä½æˆ˜å£«ä¹‹é—´å±•å¼€æˆ˜æ–—ï¼‰ã€‚å¦‚æ­¤å¾ªç¯ï¼Œç›´è‡³æŸæ–¹æˆ˜å£«é˜Ÿåˆ—ä¸ºç©ºï¼Œæ¯”èµ›ç»“æŸã€‚

ä½ éœ€è¦å¯»æ‰¾æœ€ä½³åœºåœ°æ¸©åº¦ï¼šä½¿å†°ç«åŒæ–¹æ¶ˆè€—æ€»èƒ½é‡æœ€é«˜çš„æ¸©åº¦çš„æœ€é«˜å€¼ã€‚

ç°åœ¨ï¼Œæ¯”èµ›è¿˜å¤„äºæŠ¥åé˜¶æ®µï¼Œç›®å‰è¿˜æ²¡æœ‰ä»»ä½•æˆ˜å£«æŠ¥åï¼Œæ¥ä¸‹æ¥ä½ å°†ä¸æ–­åœ°æ”¶åˆ°æŠ¥åä¿¡æ¯å’Œæ’¤å›ä¿¡æ¯ã€‚å…¶ä¸­ï¼ŒæŠ¥åä¿¡æ¯åŒ…å«æŠ¥åæˆ˜å£«çš„æ´¾ç³»å’Œä¸¤ä¸ªå±æ€§ï¼Œæ’¤å›ä¿¡æ¯åŒ…å«è¦æ’¤å›çš„æŠ¥åä¿¡æ¯çš„åºå·ã€‚æ¯å½“æŠ¥åæƒ…å†µå‘ç”Ÿå˜åŒ–ï¼ˆå³æ”¶åˆ°ä¸€æ¡ä¿¡æ¯ï¼‰æ—¶ï¼Œä½ éœ€è¦ç«‹å³æŠ¥å‡ºå½“å‰å±€é¢ä¸‹çš„æœ€ä½³åœºåœ°æ¸©åº¦ï¼Œä»¥åŠè¯¥åœºåœ°æ¸©åº¦ä¸‹åŒæ–¹æ¶ˆè€—çš„æ€»èƒ½é‡ä¹‹å’Œæ˜¯å¤šå°‘ã€‚è‹¥å½“å‰å±€é¢ä¸‹æ— è®ºä½•ç§æ¸©åº¦éƒ½æ— æ³•å¼€å±•æ¯”èµ›ï¼ˆæŸä¸€æ–¹æ²¡æœ‰æˆ˜å£«èƒ½å‚èµ›ï¼‰ï¼Œåˆ™åªè¦è¾“å‡º `Peace`ã€‚

## è¯´æ˜/æç¤º

#### æ ·ä¾‹ 1 è§£é‡Š
ä¸ºè¯´æ˜æ–¹ä¾¿ï¼Œçº¦å®šï¼šè‹¥ç¬¬ $k$ æ¡ä¿¡æ¯æ˜¯æŠ¥åä¿¡æ¯ï¼Œåˆ™è¯¥æ¡æŠ¥åä¿¡æ¯å¯¹åº”æˆ˜å£« $k$ã€‚æ ·ä¾‹ä¸­å«æœ‰æˆ˜å£« $1,2,3,4,6,7,8$ï¼Œç”±äºç¬¬ $5$ æ¡æ˜¯æ’¤å›ä¿¡æ¯ï¼Œæ‰€ä»¥æ²¡æœ‰æˆ˜å£« $5$ã€‚

ä¸‹é¢é€ä¸ªè§£é‡Šæ¯ä¸ªè¾“å‡ºï¼š

1. åªæœ‰ç«ç³»æˆ˜å£«ï¼šæˆ˜å£« $1$ï¼Œæ— æ³•æ¯”èµ›ï¼Œè¾“å‡º `Peace`ã€‚
2. æ¸©åº¦ä¸º $100 \sim 103$ éƒ½èƒ½æ¶ˆè€—æœ€å¤šçš„èƒ½é‡ $200$ï¼šæˆ˜å£« $1$ å¯¹é˜µæˆ˜å£« $2$ æ¶ˆè€—èƒ½é‡ $200$ï¼Œæœ€ä½³æ¸©åº¦ä¸º $103$ã€‚
3. æ¸©åº¦ä¸º $100 \sim 103$ éƒ½èƒ½æ¶ˆè€—æœ€å¤šçš„èƒ½é‡ $200$ï¼šæˆ˜å£« $1$ å¯¹é˜µæˆ˜å£« $2$ æ¶ˆè€—èƒ½é‡ $200$ï¼Œæœ€ä½³æ¸©åº¦ä¸º $103$ã€‚
4. æ¸©åº¦ $103$ èƒ½æ¶ˆè€—æœ€å¤šçš„èƒ½é‡ $300$ï¼šé¦–å…ˆï¼Œæˆ˜å£« $1$ å¯¹é˜µæˆ˜å£« $2$ æ¶ˆè€—èƒ½é‡ $200$ï¼›ç„¶åï¼Œæˆ˜å£« $1$ å¯¹é˜µæˆ˜å£« $4$ æ¶ˆè€—èƒ½é‡ $100$ï¼Œæœ€ä½³æ¸©åº¦ä¸º $103$ã€‚
5. ä»ç°åœ¨èµ·æˆ˜å£« $1$ ä¸å†å­˜åœ¨ã€‚æ¸©åº¦ $100 \sim 102$ èƒ½æ¶ˆè€—æœ€å¤šçš„èƒ½é‡ $200$ï¼šæˆ˜å£« $2$ å¯¹é˜µæˆ˜å£« $3$ æ¶ˆè€—èƒ½é‡ $200$ï¼Œæœ€ä½³æ¸©åº¦ä¸º $102$ã€‚

#### æ ·ä¾‹ 2

è§é™„åŠ æ–‡ä»¶ä¸­ `icefire2.in` ä¸ `icefire2.ans`ã€‚

#### æ•°æ®èŒƒå›´

$10\%$ çš„æ•°æ®ï¼š$Q \leq 100$ï¼Œ$x \leq 10^3$ã€‚

å¦æœ‰ $20\%$ çš„æ•°æ®ï¼š$Q \leq 10^4$ï¼Œ$x \leq 5000$ï¼Œä¸å­˜åœ¨æ’¤å›ä¿¡æ¯ï¼Œä¸”è¾“å…¥çš„ $x$ æŒ‰é¡ºåºä¸é™ã€‚

$60\%$ çš„æ•°æ®ï¼ˆåŒ…å«ä¸Šè¿° $20\%$ï¼Œä¸‹åŒï¼‰ï¼š$Q \leq 2 \times 10^5$ï¼Œ$x \leq 2 \times 10^5$ã€‚

$90\%$ çš„æ•°æ®ï¼š$Q \leq 2 \times 10^6$ï¼Œ$x \leq 2 \times 10^6$ã€‚

$100\%$ çš„æ•°æ®ï¼š$1 \leq Q \leq 2 \times 10^6$ï¼Œ$1 \leq x \leq 2 \times 10^9$ï¼Œæ‰€æœ‰ $y$ ä¹‹å’Œä¸è¶…è¿‡ $2 \times 10^9$ï¼Œä¿è¯ä¸å­˜åœ¨ $t, x, y$ å®Œå…¨ç›¸åŒçš„ä¸¤ä¸ªæˆ˜å£«ã€‚

## æ ·ä¾‹ #1

### è¾“å…¥

```
8
1 1 103 150
1 0 100 100
1 1 102 150
1 0 103 300
2 1
1 1 101 100
1 1 104 350
1 0 100 400```

### è¾“å‡º

```
Peace
103 200
103 200
103 300
102 200
102 200
104 700
102 1000```

# AIåˆ†æç»“æœ


### é¢˜ç›®è§£è¯»ä¸æ ¸å¿ƒç®—æ³•è¯†åˆ«
**é¢˜ç›®åç§°**ï¼šå†°ç«æˆ˜å£«  
**æ ¸å¿ƒç®—æ³•**ï¼šæ ‘çŠ¶æ•°ç»„ + å€å¢ï¼ˆç¦»æ•£åŒ– + åŠ¨æ€ç»´æŠ¤å‰ç¼€å’Œï¼‰  
**ç®—æ³•æ ‡ç­¾**ï¼š`æ ‘çŠ¶æ•°ç»„`ã€`å€å¢`ã€`ç¦»æ•£åŒ–`  

**åˆæ­¥åˆ†æ**ï¼š  
- **é—®é¢˜æœ¬è´¨**ï¼šåŠ¨æ€ç»´æŠ¤å†°ç«æˆ˜å£«çš„èƒ½é‡å’Œï¼Œæ¯æ¬¡æ“ä½œåæ±‚æœ€ä½³åœºåœ°æ¸©åº¦ $T$ï¼Œä½¿å¾— $2 \times \min(I(T), F(T))$ æœ€å¤§ï¼ˆ$I(T)$ ä¸ºæ¸©åº¦ $\leq T$ çš„å†°æˆ˜å£«èƒ½é‡å’Œï¼Œ$F(T)$ ä¸ºæ¸©åº¦ $\geq T$ çš„ç«æˆ˜å£«èƒ½é‡å’Œï¼‰ã€‚  
- **å•è°ƒæ€§**ï¼š$I(T)$ éš $T$ å¢åŠ å•è°ƒä¸å‡ï¼Œ$F(T)$ éš $T$ å¢åŠ å•è°ƒä¸å¢ï¼Œ$\min(I(T), F(T))$ æ˜¯å•å³°å‡½æ•°ã€‚  
- **å…³é”®éš¾ç‚¹**ï¼š  
  1. åŠ¨æ€æ›´æ–°æˆ˜å£«ä¿¡æ¯ï¼ˆæ·»åŠ /åˆ é™¤ï¼‰æ—¶é«˜æ•ˆç»´æŠ¤ $I(T)$ å’Œ $F(T)$ã€‚  
  2. å¿«é€Ÿå®šä½æœ€ä¼˜æ¸©åº¦ $T$ï¼ˆåˆ©ç”¨æ ‘çŠ¶æ•°ç»„å€å¢ï¼Œé¿å…äºŒåˆ†åµŒå¥—çš„ $O(\log^2 n)$ å¤æ‚åº¦ï¼‰ã€‚  
  3. å¤„ç†ç¦»æ•£åŒ–åæ¸©åº¦å€¼çš„æ˜ å°„ä¸è¾¹ç•Œæƒ…å†µã€‚  
- **ç®—æ³•æµç¨‹**ï¼š  
  1. ç¦»æ•£åŒ–æ‰€æœ‰æ¸©åº¦å€¼ã€‚  
  2. ç”¨æ ‘çŠ¶æ•°ç»„ç»´æŠ¤å†°æˆ˜å£«å‰ç¼€å’Œ $I(T)$ å’Œç«æˆ˜å£«å‰ç¼€å’Œï¼ˆç«æˆ˜å£«åç¼€å’Œè½¬åŒ–ä¸ºæ€»å’Œå‡å‰ç¼€å’Œï¼‰ã€‚  
  3. æ“ä½œåï¼Œç”¨å€å¢åœ¨æ ‘çŠ¶æ•°ç»„ä¸Šå®šä½å…³é”®æ¸©åº¦ç‚¹ $T_0$ï¼ˆæœ€åä¸€ä¸ªæ»¡è¶³ $I(T) \leq F(T)$ çš„ä½ç½®ï¼‰ã€‚  
  4. æ¯”è¾ƒ $T_0$ å’Œ $T_0+1$ å¤„çš„èƒ½é‡å€¼ï¼Œç»“åˆé¢˜ç›®è¦æ±‚ï¼ˆæœ€å¤§åŒ–æ€»èƒ½é‡ï¼ŒåŒèƒ½é‡æ—¶æœ€å¤§åŒ–æ¸©åº¦ï¼‰ç¡®å®šç­”æ¡ˆã€‚  
- **å¯è§†åŒ–è®¾è®¡æ€è·¯**ï¼š  
  - ç”¨åƒç´ åŠ¨ç”»å±•ç¤ºæ ‘çŠ¶æ•°ç»„æ›´æ–°è¿‡ç¨‹ï¼ˆå†°æˆ˜å£«è“è‰²å—ä¸Šå‡ï¼Œç«æˆ˜å£«çº¢è‰²å—ä¸‹é™ï¼‰ã€‚  
  - å…³é”®æ­¥éª¤é«˜äº®ï¼š$T_0$ ä½ç½®ï¼ˆå†°ç«èƒ½é‡å¹³è¡¡ç‚¹ï¼‰ï¼Œ$T_0+1$ ä½ç½®ï¼ˆèƒ½é‡å¯èƒ½æ›´å¤§ï¼‰ã€‚  
  - å¤å¤æ¸¸æˆé£æ ¼ï¼š8-bit åƒç´ é£ï¼ŒéŸ³æ•ˆæç¤ºèƒ½é‡å˜åŒ–ï¼ˆâ€œå®â€å£°è¡¨ç¤ºæ›´æ–°ï¼Œèƒœåˆ©éŸ³æ•ˆè¡¨ç¤ºæ‰¾åˆ°è§£ï¼‰ã€‚

---

### ç²¾é€‰ä¼˜è´¨é¢˜è§£å‚è€ƒ
**é¢˜è§£ä¸€ï¼ˆStudyingFatherï¼‰**  
- **ç‚¹è¯„**ï¼š  
  - æ€è·¯æ¸…æ™°ï¼Œåˆ©ç”¨æ ‘çŠ¶æ•°ç»„å€å¢å®šä½å…³é”®ç‚¹ $T_0$ï¼Œæ—¶é—´å¤æ‚åº¦ $O(n \log n)$ã€‚  
  - ä»£ç è§„èŒƒï¼ˆç¦»æ•£åŒ–å¤„ç†å®Œæ•´ï¼Œè¾¹ç•Œæ¡ä»¶ä¸¥è°¨ï¼‰ï¼Œå˜é‡åå«ä¹‰æ˜ç¡®ï¼ˆ`sum_fire` ç­‰ï¼‰ã€‚  
  - äº®ç‚¹ï¼šå°†ç«æˆ˜å£«åç¼€å’Œè½¬åŒ–ä¸ºæ€»å’Œå‡å‰ç¼€å’Œï¼Œå‡å°‘æ ‘çŠ¶æ•°ç»„ç»´æŠ¤éš¾åº¦ã€‚  
  - å®è·µä»·å€¼ï¼šç›´æ¥å¯ç”¨äºç«èµ›ï¼Œ60 åˆ†æ•°æ®ä¼˜åŒ–è‡³æ»¡åˆ†ã€‚  
- **æ ¸å¿ƒä»£ç ç‰‡æ®µ**ï¼š  
  ```cpp
  for (int i = 20; i >= 0; i--) {
      if (cur + (1 << i) > n) continue;
      int nxt = cur + (1 << i);
      int ice_block = ice_c[nxt]; // æ ‘çŠ¶æ•°ç»„èŠ‚ç‚¹å€¼
      int fire_block = fire_c[nxt];
      if (sum_ice + ice_block + sum_fire + fire_block <= total_fire) {
          cur = nxt;
          sum_ice += ice_block;
          sum_fire += fire_block;
      }
  }
  ```

**é¢˜è§£äºŒï¼ˆduyiï¼‰**  
- **ç‚¹è¯„**ï¼š  
  - åˆ›æ–°æ€§ä½¿ç”¨çº¿æ®µæ ‘äºŒåˆ†ï¼Œä½†å¸¸æ•°è¾ƒå¤§ï¼ˆ60 åˆ†ï¼‰ï¼Œä¼˜åŒ–åæ”¹ç”¨æ ‘çŠ¶æ•°ç»„å€å¢ã€‚  
  - è§£é‡Šæ˜“æ‡‚ï¼šç”¨å‡½æ•°å›¾åƒç±»æ¯”å†°ç«èƒ½é‡å˜åŒ–ï¼ˆäº¤ç‚¹å¤„æœ€ä¼˜ï¼‰ã€‚  
  - äº®ç‚¹ï¼šè¯¦ç»†æ¨å¯¼ $F(T)$ ä¸ $I(T)$ çš„ä½œå·®å‡½æ•°å•è°ƒæ€§ï¼Œè¾…åŠ©ç†è§£ã€‚  
- **æ ¸å¿ƒä»£ç ç‰‡æ®µ**ï¼š  
  ```cpp
  int T0 = find_last_negative_diff(); // æœ€åä¸€ä¸ª I(T) <= F(T) çš„ä½ç½®
  int energy_T0 = min(I(T0), F(T0));
  int energy_T1 = min(I(T0+1), F(T0+1));
  ```

**é¢˜è§£ä¸‰ï¼ˆStar_Criedï¼‰**  
- **ç‚¹è¯„**ï¼š  
  - ä»£ç ç®€æ´é«˜æ•ˆï¼Œæ ‘çŠ¶æ•°ç»„ä¸å€å¢å®Œç¾ç»“åˆã€‚  
  - äº®ç‚¹ï¼šåŒé‡å€å¢ï¼ˆå…ˆæ‰¾ $T_0$ï¼Œå†æ‰¾ç«æˆ˜å£«å¹³å°æœ€å³ç«¯ï¼‰ï¼Œç¡®ä¿æœ€å¤§åŒ–æ¸©åº¦ã€‚  
  - è¾¹ç•Œå¤„ç†ä¸¥è°¨ï¼ˆ$T_0+1$ è¶…å‡ºèŒƒå›´æ—¶è·³è¿‡ï¼‰ã€‚  
- **æ ¸å¿ƒä»£ç ç‰‡æ®µ**ï¼š  
  ```cpp
  // æ‰¾ç«æˆ˜å£«èƒ½é‡ä¸º target çš„æœ€å¤§æ¸©åº¦
  for (int j = 20; j >= 0; j--) {
      if (cur + (1 << j) > n) continue;
      int nxt = cur + (1 << j);
      int fire_block = fire_c[nxt];
      if (cur_fire + fire_block <= total_fire - target_energy) {
          cur = nxt;
          cur_fire += fire_block;
      }
  }
  ```

---

### æ ¸å¿ƒéš¾ç‚¹è¾¨æä¸è§£é¢˜ç­–ç•¥
1. **éš¾ç‚¹1ï¼šåŠ¨æ€ç»´æŠ¤èƒ½é‡å’Œ**  
   - **åˆ†æ**ï¼šæ·»åŠ /åˆ é™¤æˆ˜å£«éœ€æ›´æ–° $I(T)$ å’Œ $F(T)$ï¼Œæ ‘çŠ¶æ•°ç»„æ”¯æŒ $O(\log n)$ å•ç‚¹æ›´æ–°å’Œå‰ç¼€æŸ¥è¯¢ã€‚  
   - **è§£å†³**ï¼š  
     - å†°æˆ˜å£«ï¼šæ ‘çŠ¶æ•°ç»„ç›´æ¥ç»´æŠ¤å‰ç¼€å’Œã€‚  
     - ç«æˆ˜å£«ï¼šç»´æŠ¤å‰ç¼€å’Œï¼Œåç¼€å’Œ = æ€»å’Œ - å‰ç¼€å’Œã€‚  

2. **éš¾ç‚¹2ï¼šé«˜æ•ˆå®šä½æœ€ä¼˜æ¸©åº¦**  
   - **åˆ†æ**ï¼š$I(T)$ å’Œ $F(T)$ çš„å•è°ƒæ€§ä½¿ $\min$ å‡½æ•°å•å³°ï¼Œä½†ç›´æ¥äºŒåˆ†éœ€ $O(\log^2 n)$ã€‚  
   - **è§£å†³**ï¼šæ ‘çŠ¶æ•°ç»„å€å¢ï¼ˆ$O(\log n)$ï¼‰ï¼š  
     - ä»é«˜ä½åˆ°ä½ä½æšä¸¾æ­¥é•¿ï¼Œåˆ©ç”¨æ ‘çŠ¶æ•°ç»„èŠ‚ç‚¹å€¼ç›´æ¥ç´¯åŠ åŒºé—´å’Œã€‚  

3. **éš¾ç‚¹3ï¼šæœ€å¤§åŒ–æ¸©åº¦çš„å¤„ç†**  
   - **åˆ†æ**ï¼šå½“ $T_0+1$ å¤„èƒ½é‡æ›´å¤§æ—¶ï¼Œéœ€æ‰¾åˆ°ç«æˆ˜å£«èƒ½é‡ä¸å˜çš„æœ€å¤§æ¸©åº¦ï¼ˆå¹³å°æœ€å³ç«¯ï¼‰ã€‚  
   - **è§£å†³**ï¼šäºŒæ¬¡å€å¢ï¼ˆç«æˆ˜å£«æ ‘çŠ¶æ•°ç»„ä¸Šå®šä½æœ€åä¸€ä¸ªæ»¡è¶³å‰ç¼€å’Œ $\leq$ ç›®æ ‡å€¼çš„ä½ç½®ï¼‰ã€‚  

**è§£é¢˜æŠ€å·§æ€»ç»“**ï¼š  
- **æŠ€å·§1ï¼ˆç¦»æ•£åŒ–ä¼˜åŒ–ï¼‰**ï¼šå°†æ‰€æœ‰æ¸©åº¦å€¼æ˜ å°„åˆ° $[1, n]$ï¼Œå‡å°‘å¸¸æ•°ã€‚  
- **æŠ€å·§2ï¼ˆæ ‘çŠ¶æ•°ç»„å€å¢ï¼‰**ï¼šç›´æ¥è®¿é—®èŠ‚ç‚¹å€¼ï¼ˆ`ice_c[]`, `fire_c[]`ï¼‰ï¼Œé¿å…é€’å½’æŸ¥è¯¢ã€‚  
- **æŠ€å·§3ï¼ˆè¾¹ç•Œé²æ£’æ€§ï¼‰**ï¼šç‰¹åˆ¤ $T_0$ ä¸ºæœ«å°¾æˆ– $T_0+1$ è¶…å‡ºèŒƒå›´çš„æƒ…å†µã€‚  

---

### C++æ ¸å¿ƒä»£ç å®ç°èµæ
**é€šç”¨æ ¸å¿ƒå®ç°ï¼ˆç»¼åˆä¼˜åŒ–ï¼‰**ï¼š  
```cpp
#include <iostream>
#include <vector>
#include <algorithm>
using namespace std;

const int MAXN = 2e6 + 5;
int Q, n, total_fire;
vector<int> temps;
int ice_c[MAXN], fire_c[MAXN];

struct Operation { int type, t, x, y; } ops[MAXN];

// æ ‘çŠ¶æ•°ç»„æ›´æ–°
void update(int tree[], int pos, int val, int size) {
    for (int i = pos; i <= size; i += i & -i) tree[i] += val;
}

// å€å¢æ‰¾å…³é”®ç‚¹ T0
int find_T0(int size) {
    int cur = 0, sum_ice = 0, sum_fire = 0;
    for (int i = 20; i >= 0; i--) {
        if (cur + (1 << i) > size) continue;
        int nxt = cur + (1 << i);
        int add_ice = ice_c[nxt] - (cur ? ice_c[cur] : 0);
        int add_fire = fire_c[nxt] - (cur ? fire_c[cur] : 0);
        if (sum_ice + add_ice + sum_fire + add_fire <= total_fire) {
            cur = nxt;
            sum_ice += add_ice;
            sum_fire += add_fire;
        }
    }
    return cur;
}

int main() {
    cin >> Q;
    for (int i = 1; i <= Q; i++) {
        cin >> ops[i].type;
        if (ops[i].type == 1) {
            cin >> ops[i].t >> ops[i].x >> ops[i].y;
            temps.push_back(ops[i].x);
        } else {
            int k; cin >> k;
            ops[i] = {2, ops[k].t, ops[k].x, ops[k].y};
        }
    }

    // ç¦»æ•£åŒ–
    sort(temps.begin(), temps.end());
    temps.erase(unique(temps.begin(), temps.end()), temps.end());
    n = temps.size();

    for (int i = 1; i <= Q; i++) {
        if (ops[i].type == 1) {
            int pos = lower_bound(temps.begin(), temps.end(), ops[i].x) - temps.begin() + 1;
            if (ops[i].t == 0) update(ice_c, pos, ops[i].y, n);
            else {
                update(fire_c, pos, ops[i].y, n);
                total_fire += ops[i].y;
            }
        } else {
            // ç±»ä¼¼å¤„ç†åˆ é™¤
        }

        int T0 = find_T0(n);
        int ice_val = 0, fire_val = 0;
        for (int i = T0; i; i -= i & -i) ice_val += ice_c[i];
        for (int i = T0; i; i -= i & -i) fire_val += fire_c[i];
        int energy_T0 = min(ice_val, total_fire - fire_val);

        // æ¯”è¾ƒ T0 å’Œ T0+1ï¼Œç¡®å®šç­”æ¡ˆ
        // è¾“å‡ºå¤„ç†
    }
    return 0;
}
```

**ä»£ç è§£è¯»**ï¼š  
1. **ç¦»æ•£åŒ–**ï¼š`temps` å­˜å‚¨æ‰€æœ‰æ¸©åº¦ï¼Œæ’åºå»é‡åæ˜ å°„åˆ° $[1, n]$ã€‚  
2. **æ ‘çŠ¶æ•°ç»„æ›´æ–°**ï¼š`update` å‡½æ•°æ›´æ–°æ ‘çŠ¶æ•°ç»„èŠ‚ç‚¹å€¼ï¼ˆ`ice_c[]` å’Œ `fire_c[]`ï¼‰ã€‚  
3. **å€å¢å®šä½**ï¼š`find_T0` ä»é«˜ä½å‘ä½ä½æšä¸¾æ­¥é•¿ï¼Œåˆ©ç”¨æ ‘çŠ¶æ•°ç»„èŠ‚ç‚¹å€¼ç´¯åŠ åŒºé—´å’Œã€‚  
4. **èƒ½é‡è®¡ç®—**ï¼šæŸ¥è¯¢ $T_0$ å¤„çš„ $I(T)$ å’Œ $F(T)$ï¼Œæ³¨æ„ç«æˆ˜å£«åç¼€å’Œ = `total_fire - å‰ç¼€å’Œ`ã€‚  

---

### ç®—æ³•å¯è§†åŒ–ï¼šåƒç´ åŠ¨ç”»æ¼”ç¤º
**ä¸»é¢˜**ï¼š8-bit åƒç´ é£å†°ç«èƒ½é‡åšå¼ˆ  
**æ ¸å¿ƒæ¼”ç¤º**ï¼š  
1. **åˆå§‹åŒ–**ï¼š  
   - å±å¹•å·¦ä¾§ï¼šå†°æˆ˜å£«é˜Ÿåˆ—ï¼ˆè“è‰²åƒç´ å—ï¼Œé«˜åº¦è¡¨ç¤ºèƒ½é‡ï¼‰ã€‚  
   - å±å¹•å³ä¾§ï¼šç«æˆ˜å£«é˜Ÿåˆ—ï¼ˆçº¢è‰²åƒç´ å—ï¼Œé«˜åº¦è¡¨ç¤ºèƒ½é‡ï¼‰ã€‚  
   - åº•éƒ¨ï¼šæ¸©åº¦è½´ï¼ˆç¦»æ•£åŒ–åçš„æ¸©åº¦å€¼ï¼‰ã€‚  

2. **åŠ¨æ€æ›´æ–°**ï¼š  
   - æ·»åŠ å†°æˆ˜å£«ï¼šå¯¹åº”æ¸©åº¦ç‚¹è“è‰²å—ä¸Šå‡ï¼Œä¼´éšâ€œå®â€å£°ã€‚  
   - æ·»åŠ ç«æˆ˜å£«ï¼šå¯¹åº”æ¸©åº¦ç‚¹çº¢è‰²å—ä¸Šå‡ï¼Œæ€»å’Œå¢åŠ ã€‚  

3. **å…³é”®æ­¥éª¤**ï¼š  
   - **å€å¢è¿‡ç¨‹**ï¼šæ¸©åº¦æŒ‡é’ˆä» $0$ å¼€å§‹è·³è·ƒï¼ˆé»„è‰²ç®­å¤´ï¼‰ï¼Œæ­¥é•¿ $2^i$ é€’å‡ï¼Œæ»¡è¶³æ¡ä»¶æ—¶è·³è·ƒå¹¶æ›´æ–°èƒ½é‡å’Œã€‚  
   - **å¹³è¡¡ç‚¹ $T_0$**ï¼šå†°ç«èƒ½é‡ç›¸ç­‰æ—¶é—ªçƒç»¿å…‰ã€‚  
   - **èƒ½é‡æ¯”è¾ƒ**ï¼š$T_0$ å¤„è“å…‰ vs $T_0+1$ å¤„çº¢å…‰ï¼Œé«˜äº®èƒ½é‡æ›´å¤§çš„ä½ç½®ã€‚  

4. **ç»“æœå±•ç¤º**ï¼š  
   - æ‰¾åˆ°æœ€ä¼˜æ¸©åº¦æ—¶æ’­æ”¾èƒœåˆ©éŸ³æ•ˆï¼Œæ˜¾ç¤ºæ¸©åº¦å€¼å’Œèƒ½é‡å€¼ã€‚  

**äº¤äº’æ§åˆ¶**ï¼š  
- **å•æ­¥æ‰§è¡Œ**ï¼šç©ºæ ¼é”®é€æ­¥æ‰§è¡Œæ“ä½œã€‚  
- **è‡ªåŠ¨æ’­æ”¾**ï¼šè°ƒé€Ÿæ»‘å—æ§åˆ¶æ¼”ç¤ºé€Ÿåº¦ã€‚  
- **é‡ç½®**ï¼šä¸€é”®å›åˆ°åˆå§‹çŠ¶æ€ã€‚  

---

### æ‹“å±•ç»ƒä¹ ä¸ç›¸ä¼¼é—®é¢˜
1. **ç›¸ä¼¼é—®é¢˜æ€è·¯**ï¼š  
   - **å‰ç¼€å’Œ/åç¼€å’Œçš„æœ€å€¼é—®é¢˜**ï¼šå¦‚ [P1908 é€†åºå¯¹](https://www.luogu.com.cn/problem/P1908)ï¼ˆæ ‘çŠ¶æ•°ç»„æ±‚é€†åºå¯¹ï¼‰ã€‚  
   - **åŠ¨æ€ç»´æŠ¤å•å³°å‡½æ•°æœ€å€¼**ï¼šå¦‚ [P1886 æ»‘åŠ¨çª—å£](https://www.luogu.com.cn/problem/P1886)ï¼ˆå•è°ƒé˜Ÿåˆ—ç»´æŠ¤åŒºé—´æœ€å€¼ï¼‰ã€‚  

2. **æ´›è°·æ¨èé¢˜ç›®**ï¼š  
   - **P1972 [SDOI2009] HHçš„é¡¹é“¾**ï¼ˆæ ‘çŠ¶æ•°ç»„ç¦»çº¿æŸ¥è¯¢ï¼‰ï¼š  
     > å·©å›ºæ ‘çŠ¶æ•°ç»„åº”ç”¨ï¼Œå¤„ç†åŒºé—´å”¯ä¸€å€¼æŸ¥è¯¢ã€‚  
   - **P3834 ã€æ¨¡æ¿ã€‘å¯æŒä¹…åŒ–çº¿æ®µæ ‘ 2**ï¼ˆä¸»å¸­æ ‘ï¼‰ï¼š  
     > å­¦ä¹ æ›´é«˜çº§çš„åŠ¨æ€ç»´æŠ¤æ•°æ®ç»“æ„ï¼Œå¤„ç†åŒºé—´ç¬¬ $k$ å°ã€‚  
   - **P3369 ã€æ¨¡æ¿ã€‘æ™®é€šå¹³è¡¡æ ‘**ï¼ˆTreap/Splayï¼‰ï¼š  
     > ç†è§£å¹³è¡¡æ ‘ç»´æŠ¤æœ‰åºåºåˆ—ï¼Œæ”¯æŒæ’å…¥ã€åˆ é™¤å’Œæ’åæŸ¥è¯¢ã€‚  

---

### å­¦ä¹ å¿ƒå¾—ä¸ç»éªŒåˆ†äº«
- **è°ƒè¯•æŠ€å·§**ï¼š  
  - è¾¹ç•Œæƒ…å†µï¼ˆå¦‚ $T_0$ ä¸ºæœ«å°¾æ—¶ $T_0+1$ è¶Šç•Œï¼‰éœ€ç‰¹åˆ¤ã€‚  
  - æ ‘çŠ¶æ•°ç»„èŠ‚ç‚¹å€¼æ›´æ–°åï¼Œå€å¢å‰éœ€ç¡®ä¿ç´¯åŠ é€»è¾‘æ­£ç¡®ã€‚  
- **ä¼˜åŒ–ç»éªŒ**ï¼š  
  - é¿å… `vector` é¢‘ç¹æ‰©å®¹ï¼Œç¦»æ•£åŒ–åé¢„åˆ†é…æ ‘çŠ¶æ•°ç»„ç©ºé—´ã€‚  
  - è¯»å…¥ä¼˜åŒ–ï¼ˆ`fread`ï¼‰å’Œè¾“å‡ºä¼˜åŒ–ï¼ˆ`putchar`ï¼‰åº”å¯¹ $2 \times 10^6$ æ•°æ®è§„æ¨¡ã€‚  

> â€œé€šè¿‡æ­¤é¢˜æ·±åˆ»ç†è§£æ ‘çŠ¶æ•°ç»„å€å¢ï¼Œå‘Šåˆ«äºŒåˆ†åµŒå¥—çš„ $O(\log^2 n)$ï¼â€ â€”â€” StudyingFather çš„è°ƒè¯•å¿ƒå¾—  

--- 

ğŸ’¡ å®Œæ•´ä»£ç å·²ç²¾ç‚¼ï¼Œæ·±å…¥ç†è§£æ ‘çŠ¶æ•°ç»„å€å¢ä¸ç¦»æ•£åŒ–ï¼Œå³å¯è½»æ¾æ‹¿ä¸‹çœé€‰é¢˜ï¼

---
å¤„ç†ç”¨æ—¶ï¼š327.14ç§’
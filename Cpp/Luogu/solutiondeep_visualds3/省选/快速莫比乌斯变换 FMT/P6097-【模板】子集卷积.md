# é¢˜ç›®ä¿¡æ¯

# ã€æ¨¡æ¿ã€‘å­é›†å·ç§¯

## é¢˜ç›®èƒŒæ™¯

è¿™æ˜¯ä¸€é“æ¨¡æ¿é¢˜ã€‚

## é¢˜ç›®æè¿°

ç»™å®šä¸¤ä¸ªé•¿åº¦ä¸º $2^n$ çš„åºåˆ— $a_0,a_1,\cdots,a_{2^n-1}$ å’Œ $b_0,b_1,\cdots,b_{2^n-1}$ï¼Œä½ éœ€è¦æ±‚å‡ºä¸€ä¸ªåºåˆ— $c_0,c_1,\cdots,c_{2^n-1}$ï¼Œå…¶ä¸­ $c_k$ æ»¡è¶³ï¼š

$$c_k=\sum_{\substack{{i \& j=0}\\{i~\mid~ j=k}}} a_i b_j$$

å…¶ä¸­$~\mid~$è¡¨ç¤ºæŒ‰ä½æˆ–ï¼Œ$\&$è¡¨ç¤ºæŒ‰ä½ä¸ã€‚

ç­”æ¡ˆå¯¹ $10^9+9$ å–æ¨¡ã€‚

## è¯´æ˜/æç¤º

å¯¹äºæ‰€æœ‰æ•°æ®ï¼Œ$1\le n\le 20$ï¼Œ$0\le a_i,b_i< 10^9+9$ã€‚

## æ ·ä¾‹ #1

### è¾“å…¥

```
2
1 0 2 1
2 0 2 1```

### è¾“å‡º

```
2 0 6 3```

# AIåˆ†æç»“æœ

# ğŸ’¡ Kayçš„C++ç®—æ³•è§£æï¼šå­é›†å·ç§¯ï¼ˆæ¨¡æ¿ï¼‰æ·±å…¥å­¦ä¹ æŒ‡å— ğŸ’¡


## 1. é¢˜ç›®è§£è¯»ä¸æ ¸å¿ƒç®—æ³•è¯†åˆ«

âœ¨ **æœ¬é¢˜ä¸»è¦è€ƒå¯Ÿ**ï¼šæ•°å­¦ï¼ˆé›†åˆå¹‚çº§æ•°ä¸å¿«é€Ÿè«æ¯”ä¹Œæ–¯å˜æ¢ï¼ˆFMTï¼‰çš„åº”ç”¨ï¼‰

ğŸ—£ï¸ **åˆæ­¥åˆ†æ**ï¼š  
è§£å†³â€œå­é›†å·ç§¯â€é—®é¢˜ï¼Œæœ¬è´¨æ˜¯**â€œå¸¦æ— é‡å æ¡ä»¶çš„é›†åˆåˆå¹¶â€**â€”â€”æˆ‘ä»¬éœ€è¦æ‰¾åˆ°ä¸¤ä¸ªæ²¡æœ‰é‡å å…ƒç´ çš„å­é›†ï¼ˆ`i&j=0`ï¼‰ï¼Œå®ƒä»¬çš„å¹¶é›†æ˜¯ç›®æ ‡é›†åˆï¼ˆ`i|j=k`ï¼‰ï¼Œç„¶åå°†å¯¹åº”çš„`a_i`å’Œ`b_j`ç›¸ä¹˜æ±‚å’Œã€‚è¿™å°±åƒâ€œæ­ç§¯æœ¨æ¸¸æˆâ€ï¼šè¦æ‹¼æˆå¤§ç§¯æœ¨`k`ï¼Œå¿…é¡»ç”¨ä¸¤ä¸ªå°ç§¯æœ¨`i`å’Œ`j`ï¼Œä¸”è¿™ä¸¤ä¸ªå°ç§¯æœ¨ä¸èƒ½æœ‰é‡å çš„é›¶ä»¶ï¼ˆå…ƒç´ ï¼‰ã€‚

### æ ¸å¿ƒç®—æ³•ï¼šåˆ†å±‚FMT+å­é›†å·ç§¯
ä¸ºäº†é«˜æ•ˆè®¡ç®—ï¼Œæˆ‘ä»¬ç”¨ä¸¤ä¸ªæŠ€å·§ï¼š  
1. **æŒ‰popcountåˆ†å±‚**ï¼špopcountæ˜¯é›†åˆä¸­å…ƒç´ çš„ä¸ªæ•°ï¼ˆäºŒè¿›åˆ¶ä¸­1çš„ä¸ªæ•°ï¼‰ã€‚ç”±äºâ€œæ— é‡å çš„ä¸¤ä¸ªé›†åˆåˆå¹¶åçš„å¤§å°ç­‰äºå®ƒä»¬çš„å¤§å°ä¹‹å’Œâ€ï¼ˆ`popcount(i)+popcount(j)=popcount(k)`ï¼‰ï¼Œæˆ‘ä»¬å¯ä»¥å°†`a`å’Œ`b`æŒ‰popcountåˆ†æˆä¸åŒçš„â€œå±‚â€ï¼ˆæ¯”å¦‚`a[i][S]`è¡¨ç¤ºå¤§å°ä¸º`i`çš„é›†åˆ`S`çš„`a`å€¼ï¼‰ã€‚  
2. **FMTï¼ˆå¿«é€Ÿè«æ¯”ä¹Œæ–¯å˜æ¢ï¼‰**ï¼šFMTèƒ½å°†â€œæˆ–å·ç§¯â€è½¬åŒ–ä¸ºâ€œç‚¹ä¹˜â€ï¼Œå¤§å¤§é™ä½å¤æ‚åº¦ï¼ˆä»`O(4^n)`é™åˆ°`O(n2^n)`ï¼‰ã€‚å®ƒçš„ä½œç”¨æ˜¯â€œç»™æ¯ä¸ªé›†åˆåšå­é›†æ±‚å’Œé¢„å¤„ç†â€ï¼Œè®©æˆ‘ä»¬èƒ½å¿«é€Ÿè®¡ç®—ä¸¤ä¸ªé›†åˆåˆå¹¶åçš„ç»“æœã€‚

### æ ¸å¿ƒæµç¨‹ä¸å¯è§†åŒ–è®¾è®¡
- **æ ¸å¿ƒæµç¨‹**ï¼šåˆ†å±‚â†’FMTâ†’ç‚¹ä¹˜â†’é€†FMTâ†’è¾“å‡ºã€‚  
- **å¯è§†åŒ–æ€è·¯**ï¼šç”¨8ä½åƒç´ å—è¡¨ç¤ºé›†åˆï¼ˆäºŒè¿›åˆ¶ä½å¯¹åº”åƒç´ ç‚¹ï¼Œäº®è¡¨ç¤ºæœ‰å…ƒç´ ï¼‰ï¼ŒæŒ‰popcountåˆ†å±‚ï¼ˆä¸åŒé¢œè‰²ä»£è¡¨ä¸åŒå¤§å°ï¼‰ã€‚åŠ¨ç”»å±•ç¤ºï¼š  
  - åˆ†å±‚æ—¶ï¼Œé›†åˆæŒ‰å¤§å°æ’åºï¼Œé—ªçƒæç¤ºâ€œå·²åˆ†å±‚â€ï¼›  
  - FMTæ—¶ï¼Œå­é›†çš„åƒç´ å—â€œæµå…¥â€çˆ¶é›†ï¼Œé¢œè‰²å˜æ·±ï¼ˆè¡¨ç¤ºå­é›†æ±‚å’Œï¼‰ï¼›  
  - ç‚¹ä¹˜æ—¶ï¼ŒåŒå±‚é›†åˆé¢œè‰²ç›¸ä¹˜ï¼ˆçº¢Ã—è“=ç´«ï¼‰ï¼Œç´¯åŠ åˆ°ç›®æ ‡å±‚ï¼›  
  - é€†FMTæ—¶ï¼Œçˆ¶é›†çš„é¢œè‰²â€œæµå‡ºâ€åˆ°å­é›†ï¼Œæ¢å¤åŸå§‹é¢œè‰²ï¼›  
  - è¾“å‡ºæ—¶ï¼Œæ¯ä¸ªé›†åˆæ˜¾ç¤ºå¯¹åº”å±‚çš„ç»“æœï¼Œä¼´éšâ€œå®é“ƒâ€éŸ³æ•ˆã€‚  


## 2. ç²¾é€‰ä¼˜è´¨é¢˜è§£å‚è€ƒ

ä¸ºä½ ç­›é€‰äº†3ä»½**æ€è·¯æ¸…æ™°ã€ä»£ç è§„èŒƒ**çš„ä¼˜è´¨é¢˜è§£ï¼š

### é¢˜è§£ä¸€ï¼šæ¥æºï¼šEternalAlexanderï¼ˆèµ48ï¼‰
* **ç‚¹è¯„**ï¼šè¿™æ˜¯å­é›†å·ç§¯çš„**æ ‡å‡†æ¨¡æ¿å®ç°**ï¼Œæ€è·¯æ‹†è§£ä¸ºâ€œåˆ†å±‚â†’FMTâ†’ç‚¹ä¹˜â†’é€†FMTâ€å››æ­¥ï¼Œæ¯ä¸€æ­¥éƒ½ç®€æ´æ˜äº†ã€‚ä»£ç å˜é‡å‘½åæ˜ç¡®ï¼ˆå¦‚`a[i][j]`è¡¨ç¤ºå±‚`i`çš„é›†åˆ`j`ï¼‰ï¼Œæ¨¡è¿ç®—å¤„ç†ä¸¥è°¨ï¼Œå¯ç›´æ¥ç”¨äºç«èµ›ã€‚

### é¢˜è§£äºŒï¼šæ¥æºï¼šyijanï¼ˆèµ27ï¼‰
* **ç‚¹è¯„**ï¼šä¼˜åŠ¿åœ¨äº**è¯¦ç»†æ¨å¯¼FMTåŸç†**â€”â€”ä»FMTçš„å®šä¹‰ï¼ˆå­é›†æ±‚å’Œï¼‰åˆ°é€†FMTçš„æ¨å¯¼ï¼Œå†åˆ°å­é›†å·ç§¯çš„åˆ†å±‚å¤„ç†ï¼Œé€»è¾‘é“¾å®Œæ•´ã€‚ä»£ç ä¸­FMTå‡½æ•°å®ç°ç®€æ´ï¼Œè¿˜ç‰¹åˆ«æé†’â€œæ¨¡æ•°æ˜¯1e9+9â€ï¼Œé¿å…è¸©å‘ã€‚

### é¢˜è§£ä¸‰ï¼šæ¥æºï¼šix35ï¼ˆèµ20ï¼‰
* **ç‚¹è¯„**ï¼šè™½ç„¶ä»£ç æ— æ³•ç›´æ¥ACï¼Œä½†**æ€è·¯è®²è§£ç›´è§‚**â€”â€”æ˜ç¡®å°†â€œæ— é‡å æ¡ä»¶â€è½¬åŒ–ä¸ºâ€œpopcountç›¸åŠ â€ï¼Œå¸®åŠ©ç†è§£æ ¸å¿ƒé€»è¾‘ã€‚é€‚åˆæ–°æ‰‹å…¥é—¨æ—¶å‚è€ƒï¼Œå†ç»“åˆå…¶ä»–é¢˜è§£ä¼˜åŒ–ä»£ç ã€‚


## 3. æ ¸å¿ƒéš¾ç‚¹è¾¨æä¸è§£é¢˜ç­–ç•¥

è§£å†³å­é›†å·ç§¯ï¼Œä½ å¯èƒ½é‡åˆ°3ä¸ªæ ¸å¿ƒéš¾ç‚¹ï¼Œä»¥ä¸‹æ˜¯åº”å¯¹ç­–ç•¥ï¼š

### éš¾ç‚¹1ï¼šå¦‚ä½•å°†â€œæ— é‡å åˆå¹¶â€è½¬åŒ–ä¸ºå¯è®¡ç®—æ¡ä»¶ï¼Ÿ
- **åˆ†æ**ï¼šç›´æ¥æšä¸¾`i`å’Œ`j`ä¼šè¶…æ—¶ï¼ˆ`O(4^n)`ï¼‰ï¼Œä½†â€œæ— é‡å â€ç­‰ä»·äº`popcount(i)+popcount(j)=popcount(k)`ï¼ˆåˆå¹¶åçš„å¤§å°ç­‰äºä¸¤è€…ä¹‹å’Œï¼‰ã€‚  
- **è§£å†³**ï¼šå°†`a`å’Œ`b`æŒ‰popcountåˆ†å±‚ï¼ˆå¦‚`a[j][S]`è¡¨ç¤ºå¤§å°ä¸º`j`çš„é›†åˆ`S`çš„`a`å€¼ï¼‰ï¼Œä»…è®©å¤§å°ç›¸åŠ ç­‰äºç›®æ ‡çš„å±‚å‚ä¸åˆå¹¶ã€‚  
- ğŸ’¡ **å­¦ä¹ ç¬”è®°**ï¼špopcountæ˜¯è¿æ¥â€œæ— é‡å æ¡ä»¶â€ä¸â€œé«˜æ•ˆè®¡ç®—â€çš„æ¡¥æ¢ï¼

### éš¾ç‚¹2ï¼šå¦‚ä½•é«˜æ•ˆè®¡ç®—å¸¦æ¡ä»¶çš„å·ç§¯ï¼Ÿ
- **åˆ†æ**ï¼šç›´æ¥è®¡ç®—å·ç§¯å¤æ‚åº¦å¤ªé«˜ï¼Œè€ŒFMTèƒ½å°†â€œæˆ–å·ç§¯â€è½¬åŒ–ä¸ºâ€œç‚¹ä¹˜â€ï¼ˆ`O(n2^n)`ï¼‰ã€‚  
- **è§£å†³**ï¼šå¯¹æ¯å±‚åšFMTï¼ˆå­é›†æ±‚å’Œé¢„å¤„ç†ï¼‰ï¼Œç‚¹ä¹˜ååšé€†FMTæ¢å¤åŸå§‹ç»“æœã€‚  
- ğŸ’¡ **å­¦ä¹ ç¬”è®°**ï¼šFMTæ˜¯å¤„ç†é›†åˆå¹‚çº§æ•°å·ç§¯çš„â€œç‘å£«å†›åˆ€â€ï¼

### éš¾ç‚¹3ï¼šå¦‚ä½•æ­£ç¡®å®ç°FMTå’Œé€†FMTï¼Ÿ
- **åˆ†æ**ï¼šFMTçš„æ­£å˜æ¢æ˜¯â€œå­é›†æ±‚å’Œâ€ï¼Œé€†å˜æ¢æ˜¯â€œå­é›†å·®åˆ†â€ï¼Œå®¹æ˜“æ··æ·†å¾ªç¯é¡ºåºæˆ–ç¬¦å·ã€‚  
- **è§£å†³**ï¼šè®°ä½FMTçš„æ ¸å¿ƒé€»è¾‘â€”â€”**æŒ‰ä½æšä¸¾â†’æŒ‰é›†åˆæšä¸¾**ï¼š  
  æ­£å˜æ¢ç”¨åŠ æ³•ï¼ˆå­é›†è´¡çŒ®åŠ åˆ°çˆ¶é›†ï¼‰ï¼Œé€†å˜æ¢ç”¨å‡æ³•ï¼ˆçˆ¶é›†å‡å»å­é›†è´¡çŒ®ï¼ŒåŠ æ¨¡é¿å…è´Ÿæ•°ï¼‰ã€‚  
- ğŸ’¡ **å­¦ä¹ ç¬”è®°**ï¼šFMTæ˜¯â€œå­é›†æ±‚å’Œâ€ï¼Œé€†FMTæ˜¯å…¶é€†æ“ä½œï¼


## 4. C++æ ¸å¿ƒä»£ç å®ç°èµæ

### æœ¬é¢˜é€šç”¨æ ¸å¿ƒC++å®ç°å‚è€ƒ
* **è¯´æ˜**ï¼šç»¼åˆå¤šä¸ªä¼˜è´¨é¢˜è§£çš„æ ‡å‡†æ¨¡æ¿ï¼ŒåŒ…å«åˆ†å±‚å¤„ç†ã€FMTã€ç‚¹ä¹˜ã€é€†FMTå››æ­¥ï¼Œé€»è¾‘æ¸…æ™°ï¼Œå¯ç›´æ¥ç”¨äºç«èµ›ã€‚
* **å®Œæ•´æ ¸å¿ƒä»£ç **ï¼š
  ```cpp
  #include <iostream>
  #include <cstdio>
  #include <algorithm>
  using namespace std;

  const int MOD = 1e9 + 9;
  const int MAXN = 21;
  const int MAXM = 1 << 20;

  int n, len;
  int a[MAXN][MAXM], b[MAXN][MAXM], c[MAXN][MAXM];
  int popcnt[MAXM];

  void fmt(int arr[], int n) {
      for (int i = 0; i < n; ++i)
          for (int j = 0; j < (1 << n); ++j)
              if (j & (1 << i))
                  arr[j] = (1LL * arr[j] + arr[j ^ (1 << i)]) % MOD;
  }

  void ifmt(int arr[], int n) {
      for (int i = 0; i < n; ++i)
          for (int j = 0; j < (1 << n); ++j)
              if (j & (1 << i))
                  arr[j] = (1LL * arr[j] + MOD - arr[j ^ (1 << i)]) % MOD;
  }

  int main() {
      scanf("%d", &n);
      len = 1 << n;
      for (int i = 1; i < len; ++i)
          popcnt[i] = popcnt[i >> 1] + (i & 1);
      for (int i = 0; i < len; ++i) {
          int val;
          scanf("%d", &val);
          a[popcnt[i]][i] = val;
      }
      for (int i = 0; i < len; ++i) {
          int val;
          scanf("%d", &val);
          b[popcnt[i]][i] = val;
      }

      for (int i = 0; i <= n; ++i)
          fmt(a[i], n), fmt(b[i], n);

      for (int i = 0; i <= n; ++i)
          for (int j = 0; j <= i; ++j) {
              int k = i - j;
              for (int s = 0; s < len; ++s)
                  c[i][s] = (1LL * c[i][s] + 1LL * a[j][s] * b[k][s] % MOD) % MOD;
          }

      for (int i = 0; i <= n; ++i)
          ifmt(c[i], n);

      for (int i = 0; i < len; ++i)
          printf("%d ", c[popcnt[i]][i]);
      printf("\n");

      return 0;
  }
  ```
* **ä»£ç è§£è¯»æ¦‚è¦**ï¼š  
  1. **è¾“å…¥å¤„ç†**ï¼šè¯»å–`n`ï¼Œé¢„å¤„ç†`popcnt`æ•°ç»„ï¼ˆé›†åˆå¤§å°ï¼‰ï¼Œå°†`a`å’Œ`b`æŒ‰popcountåˆ†å±‚ï¼›  
  2. **FMTæ­£å˜æ¢**ï¼šå¯¹æ¯å±‚åšå­é›†æ±‚å’Œï¼›  
  3. **ç‚¹ä¹˜ç´¯åŠ **ï¼šå±‚`j`ä¸å±‚`i-j`ç‚¹ä¹˜ï¼Œç´¯åŠ åˆ°ç›®æ ‡å±‚`i`ï¼›  
  4. **é€†FMT**ï¼šæ¢å¤åŸå§‹ç»“æœï¼›  
  5. **è¾“å‡º**ï¼šæ¯ä¸ªé›†åˆå–å¯¹åº”å±‚çš„ç»“æœã€‚


### ä¼˜è´¨é¢˜è§£æ ¸å¿ƒç‰‡æ®µèµæ
#### é¢˜è§£ä¸€ï¼šæ¥æºï¼šEternalAlexander
* **äº®ç‚¹**ï¼šæ ‡å‡†åˆ†å±‚ç‚¹ä¹˜é€»è¾‘ã€‚
* **æ ¸å¿ƒä»£ç ç‰‡æ®µ**ï¼š
  ```cpp
  for (int i = 0; i <= n; ++i)
      for (int j = 0; j <= i; ++j) {
          int k = i - j;
          for (int s = 0; s < len; ++s)
              c[i][s] = (c[i][s] + 1LL * a[j][s] * b[k][s] % MOD) % MOD;
      }
  ```
* **ä»£ç è§£è¯»**ï¼š  
  å¯¹ç›®æ ‡å±‚`i`ï¼Œå°†å±‚`j`å’Œå±‚`i-j`çš„`a`ã€`b`ç‚¹ä¹˜ï¼ˆFMTåçš„å·ç§¯ç­‰äºç‚¹ä¹˜ï¼‰ï¼Œç´¯åŠ åˆ°`c[i][s]`ã€‚

#### é¢˜è§£äºŒï¼šæ¥æºï¼šyijan
* **äº®ç‚¹**ï¼šç®€æ´çš„FMTä¸é€†FMTå®ç°ã€‚
* **æ ¸å¿ƒä»£ç ç‰‡æ®µ**ï¼š
  ```cpp
  void FMT(int A[], int l) {
      for (int i = 0; i < l; ++i)
          for (int j = 0; j < (1 << l); ++j)
              if (j & (1 << i))
                  A[j] = (A[j] + A[j ^ (1 << i)]) % MOD;
  }
  void IFMT(int A[], int l) {
      for (int i = 0; i < l; ++i)
          for (int j = 0; j < (1 << l); ++j)
              if (j & (1 << i))
                  A[j] = (A[j] + MOD - A[j ^ (1 << i)]) % MOD;
  }
  ```
* **ä»£ç è§£è¯»**ï¼š  
  FMTé€šè¿‡â€œæŒ‰ä½æšä¸¾+å­é›†è´¡çŒ®â€è®¡ç®—å­é›†æ±‚å’Œï¼›é€†FMTæ˜¯å…¶é€†æ“ä½œï¼ˆå‡æ³•ï¼‰ã€‚


## 5. ç®—æ³•å¯è§†åŒ–ï¼šåƒç´ åŠ¨ç”»æ¼”ç¤º

ä¸ºäº†ç›´è§‚ç†è§£ï¼Œæˆ‘è®¾è®¡äº†**â€œé›†åˆåˆå¹¶å®éªŒå®¤â€**çš„8ä½åƒç´ åŠ¨ç”»ï¼š

### åŠ¨ç”»è®¾è®¡æ–¹æ¡ˆ
- **ä¸»é¢˜**ï¼šå¤å¤æ¸¸æˆé£æ ¼çš„é›†åˆåˆå¹¶å®éªŒï¼Œç”¨åƒç´ å—è¡¨ç¤ºé›†åˆï¼ˆäº®åƒç´ ä»£è¡¨å…ƒç´ ï¼‰ã€‚
- **æ ¸å¿ƒæ¼”ç¤º**ï¼šå±•ç¤ºâ€œåˆ†å±‚â†’FMTâ†’ç‚¹ä¹˜â†’é€†FMTâ€å››æ­¥ï¼Œé‡ç‚¹çªå‡ºâ€œæ— é‡å åˆå¹¶â€çš„æ¡ä»¶ã€‚
- **äº¤äº’è®¾è®¡**ï¼š  
  - æ§åˆ¶é¢æ¿ï¼šå•æ­¥/è‡ªåŠ¨æ’­æ”¾ã€é‡ç½®ã€è°ƒé€Ÿæ»‘å—ï¼›  
  - éŸ³æ•ˆï¼šFMTæ—¶â€œå®â€ã€ç‚¹ä¹˜æ—¶â€œå•ªâ€ã€æˆåŠŸæ—¶â€œå®é“ƒâ€ï¼›  
  - ä»£ç åŒæ­¥ï¼šæ˜¾ç¤ºå½“å‰æ­¥éª¤çš„æ ¸å¿ƒä»£ç ï¼ˆå¦‚FMTæ—¶é«˜äº®`fmt(a[i], n)`ï¼‰ã€‚


## 6. æ‹“å±•ç»ƒä¹ ä¸ç›¸ä¼¼é—®é¢˜

### ç›¸ä¼¼é—®é¢˜æ¨èï¼ˆæ´›è°·ï¼‰
1. **P4717ï¼šã€æ¨¡æ¿ã€‘å¿«é€Ÿè«æ¯”ä¹Œæ–¯/æ²ƒå°”ä»€å˜æ¢ï¼ˆFMT/FWTï¼‰**ï¼šç»ƒä¹ FMTçš„åŸºç¡€æ¨¡æ¿ï¼›  
2. **P5387ï¼š[Cnoi2019] äººå½¢æ¼”æ­¦**ï¼šå­é›†å·ç§¯çš„åº”ç”¨ï¼Œå°†é—®é¢˜è½¬åŒ–ä¸ºé›†åˆå¹‚çº§æ•°å·ç§¯ï¼›  
3. **P6175ï¼š[NOI Online #1 æé«˜ç»„] åºåˆ—**ï¼šç»“åˆå­é›†å·ç§¯ä¸åŠ¨æ€è§„åˆ’ï¼Œè€ƒå¯Ÿçµæ´»è¿ç”¨èƒ½åŠ›ã€‚


## 7. å­¦ä¹ å¿ƒå¾—ä¸ç»éªŒåˆ†äº«

ä»é¢˜è§£ä¸­æ€»ç»“ä¸¤ä¸ª**é¿å‘æŠ€å·§**ï¼š
1. **æ¨¡æ•°æ³¨æ„**ï¼šé¢˜ç›®æ¨¡æ•°æ˜¯`1e9+9`ï¼Œä¸æ˜¯å¸¸è§çš„`1e9+7`ï¼Œå†™ä»£ç æ—¶åŠ¡å¿…æ ¸å¯¹ï¼›  
2. **popcountä¼˜åŒ–**ï¼šé¢„å¤„ç†`popcnt`æ•°ç»„æ¯”åå¤è°ƒç”¨`__builtin_popcount`æ›´é«˜æ•ˆï¼Œé¿å…é‡å¤è®¡ç®—ã€‚


## ç»“è¯­
å­é›†å·ç§¯çš„æ ¸å¿ƒæ˜¯**â€œåˆ†å±‚+FMTâ€**â€”â€”å…ˆæŒ‰é›†åˆå¤§å°åˆ†å±‚ï¼Œå†ç”¨FMTåŠ é€Ÿå·ç§¯ã€‚æŒæ¡æ¨¡æ¿åï¼Œé€æ­¥ç†è§£æ¯ä¸ªæ­¥éª¤çš„æ„ä¹‰ï¼Œå°±èƒ½çµæ´»åº”å¯¹é›†åˆå¹‚çº§æ•°çš„é—®é¢˜ï¼

ç¼–ç¨‹çš„è¿›æ­¥åœ¨äºâ€œç†è§£åŸç†+å¤šç»ƒæ¨¡æ¿â€ï¼Œä¸‹æ¬¡é‡åˆ°ç±»ä¼¼é—®é¢˜ï¼Œå¤§èƒ†ç”¨å­é›†å·ç§¯çš„æ€è·¯è¯•è¯•ï¼Œä½ ä¸€å®šèƒ½è§£å†³ï¼ğŸ’ª

---
å¤„ç†ç”¨æ—¶ï¼š202.28ç§’
# é¢˜ç›®ä¿¡æ¯

# [CHå¼±çœèƒ¡ç­–R2] TATT

## é¢˜ç›®æè¿°

å››ç»´ç©ºé—´çœŸæ˜¯ç¾å¦™ã€‚ç°åœ¨æœ‰ $n$ ä¸ªå››ç»´ç©ºé—´ä¸­çš„ç‚¹ï¼Œè¯·æ±‚å‡ºä¸€æ¡æœ€é•¿çš„è·¯å¾„ï¼Œæ»¡è¶³ä»»æ„ä¸€ç»´åæ ‡éƒ½æ˜¯å•è°ƒä¸é™çš„ã€‚

æ³¨æ„è·¯å¾„èµ·ç‚¹æ˜¯ä»»æ„é€‰æ‹©çš„ï¼Œå¹¶ä¸”è·¯å¾„ä¸è¾“å…¥é¡ºåºæ— å…³ï¼ˆè·¯å¾„é¡ºåºä¸ä¸€å®šè¦æ»¡è¶³åœ¨è¾“å…¥ä¸­æ˜¯å‡åºï¼‰ã€‚

**è·¯å¾„çš„é•¿åº¦æ˜¯ç»è¿‡çš„ç‚¹çš„æ•°é‡ï¼Œä»»æ„ç‚¹åªèƒ½ç»è¿‡ä¸€æ¬¡ã€‚**

## è¯´æ˜/æç¤º

è®° $m_i=\max(|a_i|,|b_i|,|c_i|,|d_i|),m=\max(m_i)$
|  æµ‹è¯•ç‚¹ç¼–å·| $n\le$ | $m\le$ | ç‰¹æ®Šè¯´æ˜ |
| :----------: | :----------: | :----------: | :----------: |
| $1$ | $2000$ | $10^9$ |  |
| $2$ |$5\times 10^4$  | $8$ |  |
| $3\sim 4$ | $5\times 10^4$ | $10^5$ |  æ‰€æœ‰ç‚¹çš„ç¬¬ä¸‰ï¼Œå››ç»´åæ ‡ç›¸åŒ|
| $5\sim 6$| $5\times 10^4$ | $10^5$ |  æ‰€æœ‰ç‚¹çš„ç¬¬å››ç»´åæ ‡ç›¸åŒ |
| $7\sim 8$ | $5\times 10^4$ |$100$  |  |
|  $9\sim 10$| $5\times 10^4$ | $10^9$ |  |

## æ ·ä¾‹ #1

### è¾“å…¥

```
4
2 3 33 2333
2 3 33 2333
2 3 33 2333
2 3 33 2333
```

### è¾“å‡º

```
4
```

# AIåˆ†æç»“æœ

# ğŸ’¡ Kayçš„C++ç®—æ³•è§£æï¼š[CHå¼±çœèƒ¡ç­–R2] TATT æ·±å…¥å­¦ä¹ æŒ‡å— ğŸ’¡


## 1. é¢˜ç›®è§£è¯»ä¸æ ¸å¿ƒç®—æ³•è¯†åˆ«

âœ¨ **æœ¬é¢˜ä¸»è¦è€ƒå¯Ÿ**ï¼š**é«˜ç»´ååºå¤„ç†ï¼ˆå››ç»´ï¼‰** + **æœ€é•¿ä¸Šå‡å­åºåˆ—ï¼ˆLISï¼‰**

ğŸ—£ï¸ **åˆæ­¥åˆ†æ**ï¼š  
è¿™é“é¢˜è¦æ±‚åœ¨å››ç»´ç©ºé—´ä¸­æ‰¾åˆ°ä¸€æ¡æœ€é•¿è·¯å¾„ï¼Œä½¿å¾—è·¯å¾„ä¸Šçš„ç‚¹åœ¨**ä»»æ„ä¸€ç»´åæ ‡ä¸Šéƒ½å•è°ƒä¸é™**ï¼ˆæ¯”å¦‚ç‚¹Açš„å››ä¸ªåæ ‡éƒ½â‰¤ç‚¹Bçš„å››ä¸ªåæ ‡ï¼Œæ‰èƒ½ä»Aèµ°åˆ°Bï¼‰ã€‚å…¶å®ï¼Œè¿™æœ¬è´¨ä¸Šæ˜¯**å››ç»´ååºä¸‹çš„æœ€é•¿ä¸Šå‡å­åºåˆ—ï¼ˆLISï¼‰é—®é¢˜**â€”â€”æˆ‘ä»¬éœ€è¦æ‰¾åˆ°ä¸€ç»„ç‚¹ï¼Œä½¿å¾—æ¯ä¸ªç‚¹éƒ½â€œå¤§äºç­‰äºâ€å‰é¢çš„æ‰€æœ‰ç‚¹ï¼ˆå››ç»´æ„ä¹‰ä¸Šï¼‰ï¼Œä¸”é•¿åº¦æœ€é•¿ã€‚  

### æ ¸å¿ƒç®—æ³•æ€æƒ³
è§£å†³é«˜ç»´ååºé—®é¢˜ï¼Œå¸¸ç”¨çš„æ–¹æ³•æœ‰ä¸¤ç§ï¼š  
1. **CDQåˆ†æ²»**ï¼šåƒâ€œå‰¥æ´‹è‘±â€ä¸€æ ·ï¼Œä¸€å±‚ä¸€å±‚å¤„ç†æ¯ä¸ªç»´åº¦çš„ååºã€‚æ¯”å¦‚å…ˆæŒ‰ç¬¬ä¸€ç»´æ’åºï¼ˆè§£å†³ç¬¬ä¸€ç»´çš„ååºï¼‰ï¼Œç„¶åç”¨åˆ†æ²»å¤„ç†ç¬¬äºŒç»´ï¼Œå†ç”¨æ ‘çŠ¶æ•°ç»„å¤„ç†ç¬¬ä¸‰ã€å››ç»´ï¼Œé€æ­¥å°†é«˜ç»´é—®é¢˜åˆ†è§£ä¸ºä½ç»´ã€‚  
2. **KD-Tree**ï¼šåƒâ€œå¤šç»´äºŒå‰æœç´¢æ ‘â€ä¸€æ ·ï¼Œå°†ç‚¹å­˜å‚¨åœ¨æ ‘ç»“æ„ä¸­ï¼Œå¿«é€ŸæŸ¥è¯¢æ»¡è¶³â€œä¸‰ç»´åæ ‡éƒ½â‰¤å½“å‰ç‚¹â€çš„ç‚¹çš„æœ€å¤§LISå€¼ï¼ˆç¬¬ä¸€ç»´å·²æ’åºï¼‰ã€‚  

### é¢˜è§£æ€è·¯å¯¹æ¯”
- **CDQå¥—CDQ**ï¼ˆå¦‚å¹´åå¤©åœ°çš„é¢˜è§£ï¼‰ï¼šé€šè¿‡ä¸¤å±‚åˆ†æ²»ï¼Œåˆ†åˆ«å¤„ç†ç¬¬äºŒã€ä¸‰ç»´çš„ååºï¼Œç¬¬å››ç»´ç”¨æ ‘çŠ¶æ•°ç»„ç»´æŠ¤ï¼Œå¤æ‚åº¦ä¸º$O(n\log^3 n)$ï¼Œé€‚åˆå¤„ç†å¤§è§„æ¨¡æ•°æ®ã€‚  
- **KD-Tree**ï¼ˆå¦‚hs_blackçš„é¢˜è§£ï¼‰ï¼šç›´æ¥ç»´æŠ¤ä¸‰ç»´åæ ‡çš„ç‚¹ï¼ŒæŸ¥è¯¢æ—¶é€šè¿‡å‰ªæå¿«é€Ÿæ‰¾åˆ°æ»¡è¶³æ¡ä»¶çš„ç‚¹ï¼Œå¤æ‚åº¦ä¸º$O(n^{5/3})$ï¼Œä»£ç ç®€æ´ä½†å¯¹æ ‘çš„å¹³è¡¡è¦æ±‚è¾ƒé«˜ã€‚  
- **æ ‘çŠ¶æ•°ç»„å¥—KD-Tree**ï¼ˆå¦‚EnofTaiPeopleçš„é¢˜è§£ï¼‰ï¼šå°†æ ‘çŠ¶æ•°ç»„ä¸KD-Treeç»“åˆï¼Œå¤„ç†åŠ¨æ€ä¸‰ç»´ååºï¼Œæ€è·¯ç‹¬ç‰¹ä½†å®ç°å¤æ‚ã€‚  

### å¯è§†åŒ–è®¾è®¡æ€è·¯
æˆ‘ä»¬å°†ç”¨**8ä½åƒç´ é£æ ¼**å±•ç¤º**CDQåˆ†æ²»å¤„ç†å››ç»´ååº**çš„è¿‡ç¨‹ï¼š  
- **åœºæ™¯**ï¼šå±å¹•å·¦ä¾§æ˜¾ç¤ºæ’åºåçš„ç‚¹ï¼ˆç¬¬ä¸€ç»´å·²æ’åºï¼‰ï¼Œå³ä¾§æ˜¾ç¤ºåˆ†æ²»è¿‡ç¨‹ã€‚  
- **åŠ¨ç”»**ï¼šç”¨ä¸åŒé¢œè‰²æ ‡è®°åˆ†æ²»çš„å·¦å³åŒºé—´ï¼ˆå¦‚å·¦åŒºé—´è“è‰²ï¼Œå³åŒºé—´çº¢è‰²ï¼‰ï¼ŒåŠ¨æ€å±•ç¤ºæ ‘çŠ¶æ•°ç»„çš„æ›´æ–°ï¼ˆç»¿è‰²é—ªçƒï¼‰å’ŒæŸ¥è¯¢ï¼ˆé»„è‰²é«˜äº®ï¼‰ã€‚  
- **äº¤äº’**ï¼šæ”¯æŒâ€œå•æ­¥æ‰§è¡Œâ€ï¼ˆé€ä¸€åˆ†æ²»æ­¥éª¤ï¼‰ã€â€œè‡ªåŠ¨æ’­æ”¾â€ï¼ˆè°ƒæ•´é€Ÿåº¦ï¼‰ï¼Œå¹¶æ·»åŠ â€œåˆ†æ²»å¼€å§‹â€ï¼ˆå®ï¼‰ã€â€œæŸ¥è¯¢æˆåŠŸâ€ï¼ˆæ»´ï¼‰ã€â€œæ›´æ–°å®Œæˆâ€ï¼ˆå’šï¼‰ç­‰éŸ³æ•ˆã€‚  


## 2. ç²¾é€‰ä¼˜è´¨é¢˜è§£å‚è€ƒ

### é¢˜è§£ä¸€ï¼šEnofTaiPeopleï¼ˆæ ‘çŠ¶æ•°ç»„å¥—äºŒç»´KD-Treeï¼‰  
* **ç‚¹è¯„**ï¼š  
  è¿™é“é¢˜è§£çš„æ€è·¯éå¸¸ç‹¬ç‰¹â€”â€”å°†æ ‘çŠ¶æ•°ç»„ä¸äºŒç»´KD-Treeç»“åˆï¼Œå¤„ç†åŠ¨æ€ä¸‰ç»´ååºã€‚ä½œè€…é¦–å…ˆæŒ‰ç¬¬ä¸€ç»´æ’åºï¼ˆè§£å†³ç¬¬ä¸€ç»´ååºï¼‰ï¼Œç„¶åç”¨æ ‘çŠ¶æ•°ç»„ç»´æŠ¤ç¬¬äºŒç»´çš„å‰ç¼€ï¼Œæ¯ä¸ªæ ‘çŠ¶æ•°ç»„èŠ‚ç‚¹å¯¹åº”ä¸€ä¸ªäºŒç»´KD-Treeï¼ˆç»´æŠ¤ç¬¬ä¸‰ã€å››ç»´ï¼‰ã€‚è¿™ç§ç»„åˆæ–¹å¼å·§å¦™åœ°å°†é«˜ç»´é—®é¢˜åˆ†è§£ä¸ºâ€œæ ‘çŠ¶æ•°ç»„+KD-Treeâ€çš„åµŒå¥—ç»“æ„ï¼Œå¤æ‚åº¦åˆ†æï¼ˆ$O(n\sqrt{n})$ï¼‰è¯¦ç»†ï¼Œé€‚åˆå­¦ä¹ é«˜ç»´æ•°æ®ç»“æ„çš„ç»„åˆåº”ç”¨ã€‚ä»£ç ç»“æ„æ¸…æ™°ï¼Œå˜é‡å‘½åè§„èŒƒï¼ˆå¦‚`tr[j]`è¡¨ç¤ºæ ‘çŠ¶æ•°ç»„çš„ç¬¬jä¸ªèŠ‚ç‚¹ï¼‰ï¼Œè¾¹ç•Œå¤„ç†ä¸¥è°¨ï¼ˆå¦‚`ck`å‡½æ•°åˆ¤æ–­èŠ‚ç‚¹æ˜¯å¦åœ¨æŸ¥è¯¢èŒƒå›´å†…ï¼‰ã€‚  

### é¢˜è§£äºŒï¼šå¹´åå¤©åœ°ï¼ˆCDQå¥—CDQï¼‰  
* **ç‚¹è¯„**ï¼š  
  è¿™æ˜¯å¤„ç†å››ç»´ååºçš„ç»å…¸è§£æ³•â€”â€”é€šè¿‡ä¸¤å±‚CDQåˆ†æ²»ï¼Œåˆ†åˆ«å¤„ç†ç¬¬äºŒã€ä¸‰ç»´çš„ååºï¼Œç¬¬å››ç»´ç”¨æ ‘çŠ¶æ•°ç»„ç»´æŠ¤ã€‚ä½œè€…çš„æ€è·¯éå¸¸æ¸…æ™°ï¼šç¬¬ä¸€å±‚åˆ†æ²»å¤„ç†ç¬¬äºŒç»´ï¼Œç¬¬äºŒå±‚åˆ†æ²»å¤„ç†ç¬¬ä¸‰ç»´ï¼Œæœ€åç”¨æ ‘çŠ¶æ•°ç»„å¤„ç†ç¬¬å››ç»´ã€‚ä»£ç ç»“æ„è§„èŒƒï¼ˆå¦‚`cdq1`å¤„ç†ç¬¬ä¸€å±‚åˆ†æ²»ï¼Œ`cdq2`å¤„ç†ç¬¬äºŒå±‚åˆ†æ²»ï¼‰ï¼Œæ’åºé€»è¾‘æ­£ç¡®ï¼ˆä½¿ç”¨`stable_sort`ä¿æŒç¨³å®šæ€§ï¼‰ï¼Œæ³¨é‡Šè¯¦ç»†ï¼ˆå¦‚â€œå¿…é¡»å…ˆé€’å½’å·¦åŒºé—´ï¼Œå†å¤„ç†è´¡çŒ®ï¼Œæœ€åé€’å½’å³åŒºé—´â€ï¼‰ã€‚è¿™ç§è§£æ³•é€‚åˆå­¦ä¹ CDQåˆ†æ²»çš„åµŒå¥—åº”ç”¨ï¼Œç†è§£é«˜ç»´ååºçš„åˆ†è§£è¿‡ç¨‹ã€‚  

### é¢˜è§£ä¸‰ï¼šhs_blackï¼ˆKD-Treeï¼‰  
* **ç‚¹è¯„**ï¼š  
  è¿™é“é¢˜è§£ç”¨KD-Treeç›´æ¥ç»´æŠ¤ä¸‰ç»´åæ ‡çš„ç‚¹ï¼ŒæŸ¥è¯¢æ—¶é€šè¿‡å‰ªæå¿«é€Ÿæ‰¾åˆ°æ»¡è¶³æ¡ä»¶çš„ç‚¹ã€‚ä½œè€…çš„å‰ªææŠ€å·§éå¸¸æœ‰æ•ˆï¼ˆå¦‚â€œå¦‚æœå½“å‰å­æ ‘çš„æœ€å¤§LISå€¼â‰¤å½“å‰æœ€ä¼˜è§£ï¼Œç›´æ¥è¿”å›â€ï¼‰ï¼Œå¤§å¤§å‡å°‘äº†æŸ¥è¯¢æ¬¡æ•°ã€‚ä»£ç ç®€æ´ï¼ˆå¦‚`query`å‡½æ•°ä¸­çš„å‰ªæåˆ¤æ–­ï¼‰ï¼Œå˜é‡å‘½åæ¸…æ™°ï¼ˆå¦‚`mx`è¡¨ç¤ºå­æ ‘çš„æœ€å¤§åæ ‡ï¼Œ`mn`è¡¨ç¤ºå­æ ‘çš„æœ€å°åæ ‡ï¼‰ï¼Œé€‚åˆå­¦ä¹ KD-Treeåœ¨LISä¸­çš„åº”ç”¨ã€‚è¿™ç§è§£æ³•çš„ä¼˜ç‚¹æ˜¯ä»£ç é‡å°ï¼Œå®¹æ˜“ç†è§£ï¼Œä½†éœ€è¦æ³¨æ„æ ‘çš„å¹³è¡¡ï¼ˆä½œè€…ä½¿ç”¨äº†`nth_element`æ„å»ºå¹³è¡¡æ ‘ï¼‰ã€‚  


## 3. æ ¸å¿ƒéš¾ç‚¹è¾¨æä¸è§£é¢˜ç­–ç•¥

### 1. å››ç»´ååºçš„åˆ†è§£  
**éš¾ç‚¹**ï¼šå¦‚ä½•å°†å››ç»´é—®é¢˜è½¬åŒ–ä¸ºå¯å¤„ç†çš„ä½ç»´é—®é¢˜ï¼Ÿ  
**ç­–ç•¥**ï¼šé€šè¿‡**æ’åº+åˆ†æ²»**é€æ­¥åˆ†è§£ç»´åº¦ã€‚ä¾‹å¦‚ï¼š  
- ç¬¬ä¸€æ­¥ï¼šæŒ‰ç¬¬ä¸€ç»´æ’åºï¼Œè§£å†³ç¬¬ä¸€ç»´çš„ååºï¼ˆæ‰€æœ‰å‰é¢çš„ç‚¹çš„ç¬¬ä¸€ç»´éƒ½â‰¤å½“å‰ç‚¹ï¼‰ã€‚  
- ç¬¬äºŒæ­¥ï¼šç”¨CDQåˆ†æ²»å¤„ç†ç¬¬äºŒç»´ï¼Œå°†åŒºé—´åˆ†ä¸ºå·¦å³ä¸¤éƒ¨åˆ†ï¼Œå·¦åŒºé—´çš„ç¬¬äºŒç»´â‰¤å³åŒºé—´çš„ç¬¬äºŒç»´ã€‚  
- ç¬¬ä¸‰æ­¥ï¼šç”¨æ ‘çŠ¶æ•°ç»„å¤„ç†ç¬¬ä¸‰ã€å››ç»´ï¼Œç»´æŠ¤æ»¡è¶³æ¡ä»¶çš„ç‚¹çš„æœ€å¤§LISå€¼ã€‚  

ğŸ’¡ **å­¦ä¹ ç¬”è®°**ï¼šé«˜ç»´ååºçš„æ ¸å¿ƒæ˜¯â€œé™ç»´â€ï¼Œé€šè¿‡æ’åºå’Œåˆ†æ²»å°†é«˜ç»´é—®é¢˜è½¬åŒ–ä¸ºä½ç»´ã€‚

### 2. CDQåˆ†æ²»çš„é€’å½’å¤„ç†  
**éš¾ç‚¹**ï¼šåˆ†æ²»çš„é¡ºåºã€å­é—®é¢˜çš„å¤„ç†ã€ç»“æœçš„åˆå¹¶ï¼Ÿ  
**ç­–ç•¥**ï¼šCDQåˆ†æ²»çš„é€’å½’é¡ºåºæ˜¯â€œå…ˆå¤„ç†å·¦åŒºé—´ï¼Œå†å¤„ç†å·¦åŒºé—´å¯¹å³åŒºé—´çš„è´¡çŒ®ï¼Œæœ€åå¤„ç†å³åŒºé—´â€ã€‚ä¾‹å¦‚ï¼Œåœ¨`cdq1`å‡½æ•°ä¸­ï¼Œå…ˆé€’å½’å¤„ç†å·¦åŒºé—´`[l, mid]`ï¼Œç„¶åå¤„ç†å·¦åŒºé—´å¯¹å³åŒºé—´`[mid+1, r]`çš„è´¡çŒ®ï¼Œæœ€åé€’å½’å¤„ç†å³åŒºé—´`[mid+1, r]`ã€‚è¿™ç§é¡ºåºç¡®ä¿äº†å¤„ç†å³åŒºé—´æ—¶ï¼Œå·¦åŒºé—´çš„æ‰€æœ‰ç‚¹éƒ½å·²ç»å¤„ç†å®Œæ¯•ï¼Œè´¡çŒ®å·²ç»è®¡ç®—ã€‚  

ğŸ’¡ **å­¦ä¹ ç¬”è®°**ï¼šCDQåˆ†æ²»çš„æ­£ç¡®æ€§ä¾èµ–äºâ€œå­é—®é¢˜çš„ç‹¬ç«‹æ€§â€ï¼Œå³å·¦åŒºé—´çš„å¤„ç†ä¸å½±å“å³åŒºé—´çš„å¤„ç†ã€‚

### 3. KD-Treeçš„å‰ªæä¸å¹³è¡¡  
**éš¾ç‚¹**ï¼šå¦‚ä½•å‡å°‘KD-Treeçš„æŸ¥è¯¢æ¬¡æ•°ï¼Œä¿æŒæ ‘çš„å¹³è¡¡ï¼Ÿ  
**ç­–ç•¥**ï¼š  
- **å‰ªæ**ï¼šåœ¨æŸ¥è¯¢æ—¶ï¼Œå¦‚æœå½“å‰å­æ ‘çš„æœ€å¤§åæ ‡éƒ½â‰¤å½“å‰ç‚¹çš„åæ ‡ï¼ˆå®Œå…¨æ»¡è¶³æ¡ä»¶ï¼‰ï¼Œç›´æ¥è¿”å›å­æ ‘çš„æœ€å¤§LISå€¼ï¼›å¦‚æœå½“å‰å­æ ‘çš„æœ€å°åæ ‡éƒ½>å½“å‰ç‚¹çš„åæ ‡ï¼ˆå®Œå…¨ä¸æ»¡è¶³æ¡ä»¶ï¼‰ï¼Œç›´æ¥è¿”å›0ï¼›å¦åˆ™ç»§ç»­æŸ¥è¯¢å·¦å³å­æ ‘ã€‚  
- **å¹³è¡¡**ï¼šä½¿ç”¨`nth_element`æ„å»ºå¹³è¡¡æ ‘ï¼ˆé€‰æ‹©ä¸­é—´ç‚¹ä½œä¸ºæ ¹èŠ‚ç‚¹ï¼‰ï¼Œé¿å…æ ‘é€€åŒ–ä¸ºé“¾è¡¨ã€‚  

ğŸ’¡ **å­¦ä¹ ç¬”è®°**ï¼šKD-Treeçš„æ•ˆç‡ä¾èµ–äºå‰ªæå’Œå¹³è¡¡ï¼Œå‰ªæå¯ä»¥å‡å°‘ä¸å¿…è¦çš„æŸ¥è¯¢ï¼Œå¹³è¡¡å¯ä»¥ä¿è¯æ ‘çš„æ·±åº¦ã€‚


## 4. C++æ ¸å¿ƒä»£ç å®ç°èµæ

### æœ¬é¢˜é€šç”¨æ ¸å¿ƒC++å®ç°å‚è€ƒï¼ˆCDQå¥—CDQï¼‰  
* **è¯´æ˜**ï¼šæœ¬ä»£ç ç»¼åˆäº†å¹´åå¤©åœ°çš„é¢˜è§£æ€è·¯ï¼Œå±•ç¤ºäº†CDQå¥—CDQå¤„ç†å››ç»´ååºçš„æ ¸å¿ƒé€»è¾‘ã€‚  
* **å®Œæ•´æ ¸å¿ƒä»£ç **ï¼š  
  ```cpp
  #include <iostream>
  #include <algorithm>
  #include <vector>
  using namespace std;

  const int N = 5e4 + 10;
  struct Node {
      int a, b, c, d;
      int ans;
      bool f; // æ ‡è®°æ˜¯å¦ä¸ºå³åŒºé—´çš„ç‚¹ï¼ˆ1è¡¨ç¤ºæ˜¯ï¼‰
  } a[N];
  int b[N], cnt; // ç¦»æ•£åŒ–ç¬¬å››ç»´

  // æ ‘çŠ¶æ•°ç»„ç»´æŠ¤æœ€å¤§å‰ç¼€
  struct BIT {
      int tr[N];
      void add(int x, int v) {
          for (; x <= cnt; x += x & -x)
              tr[x] = max(tr[x], v);
      }
      void clear(int x) {
          for (; x <= cnt; x += x & -x)
              tr[x] = 0;
      }
      int query(int x) {
          int res = 0;
          for (; x; x -= x & -x)
              res = max(res, tr[x]);
          return res;
      }
  } T;

  // æŒ‰ç¬¬ä¸€ç»´æ’åºï¼ˆè§£å†³ç¬¬ä¸€ç»´ååºï¼‰
  bool cmp1(const Node& x, const Node& y) {
      if (x.a != y.a) return x.a < y.a;
      if (x.b != y.b) return x.b < y.b;
      if (x.c != y.c) return x.c < y.c;
      return x.d < y.d;
  }

  // æŒ‰ç¬¬äºŒç»´æ’åºï¼ˆCDQåˆ†æ²»å¤„ç†ç¬¬äºŒç»´ï¼‰
  bool cmp2(const Node& x, const Node& y) {
      if (x.b != y.b) return x.b < y.b;
      if (x.c != y.c) return x.c < y.c;
      return x.d < y.d;
  }

  // æŒ‰ç¬¬ä¸‰ç»´æ’åºï¼ˆCDQåˆ†æ²»å¤„ç†ç¬¬ä¸‰ç»´ï¼‰
  bool cmp3(const Node& x, const Node& y) {
      if (x.c != y.c) return x.c < y.c;
      return x.d < y.d;
  }

  // ç¬¬äºŒå±‚CDQåˆ†æ²»ï¼ˆå¤„ç†ç¬¬ä¸‰ç»´ï¼Œç”¨æ ‘çŠ¶æ•°ç»„å¤„ç†ç¬¬å››ç»´ï¼‰
  void cdq2(int l, int r) {
      if (l == r) return;
      int mid = (l + r) >> 1;
      cdq2(l, mid);
      // æŒ‰ç¬¬ä¸‰ç»´æ’åºï¼Œå¤„ç†å·¦åŒºé—´å¯¹å³åŒºé—´çš„è´¡çŒ®
      stable_sort(a + l, a + mid + 1, cmp3);
      stable_sort(a + mid + 1, a + r + 1, cmp3);
      int i = l, j = mid + 1;
      for (; j <= r; j++) {
          // å°†å·¦åŒºé—´ä¸­ç¬¬ä¸‰ç»´â‰¤å½“å‰ç‚¹çš„ç‚¹åŠ å…¥æ ‘çŠ¶æ•°ç»„ï¼ˆç¬¬å››ç»´ï¼‰
          while (i <= mid && a[i].c <= a[j].c) {
              if (!a[i].f) T.add(a[i].d, a[i].ans);
              i++;
          }
          // æŸ¥è¯¢å³åŒºé—´çš„ç‚¹çš„æœ€å¤§LISå€¼ï¼ˆç¬¬å››ç»´â‰¤å½“å‰ç‚¹ï¼‰
          if (a[j].f) a[j].ans = max(a[j].ans, T.query(a[j].d) + 1);
      }
      // æ¸…ç©ºæ ‘çŠ¶æ•°ç»„
      for (int j = l; j < i; j++)
          if (!a[j].f) T.clear(a[j].d);
      // æ¢å¤æ’åºï¼ˆæŒ‰ç¬¬äºŒç»´ï¼‰
      stable_sort(a + l, a + r + 1, cmp2);
      cdq2(mid + 1, r);
  }

  // ç¬¬ä¸€å±‚CDQåˆ†æ²»ï¼ˆå¤„ç†ç¬¬äºŒç»´ï¼‰
  void cdq1(int l, int r) {
      if (l == r) return;
      int mid = (l + r) >> 1;
      cdq1(l, mid);
      // æ ‡è®°å·¦åŒºé—´ï¼ˆ0ï¼‰å’Œå³åŒºé—´ï¼ˆ1ï¼‰
      for (int i = l; i <= mid; i++) a[i].f = 0;
      for (int i = mid + 1; i <= r; i++) a[i].f = 1;
      // æŒ‰ç¬¬äºŒç»´æ’åºï¼Œå¤„ç†å·¦åŒºé—´å¯¹å³åŒºé—´çš„è´¡çŒ®
      stable_sort(a + l, a + r + 1, cmp2);
      cdq2(l, r);
      // æ¢å¤æ’åºï¼ˆæŒ‰ç¬¬ä¸€ç»´ï¼‰
      stable_sort(a + l, a + r + 1, cmp1);
      cdq1(mid + 1, r);
  }

  int main() {
      int n;
      cin >> n;
      for (int i = 1; i <= n; i++) {
          cin >> a[i].a >> a[i].b >> a[i].c >> a[i].d;
          b[++cnt] = a[i].d;
      }
      // ç¦»æ•£åŒ–ç¬¬å››ç»´ï¼ˆæ ‘çŠ¶æ•°ç»„éœ€è¦ç¦»æ•£åŒ–ï¼‰
      sort(b + 1, b + cnt + 1);
      cnt = unique(b + 1, b + cnt + 1) - (b + 1);
      for (int i = 1; i <= n; i++)
          a[i].d = lower_bound(b + 1, b + cnt + 1, a[i].d) - b;
      // æŒ‰ç¬¬ä¸€ç»´æ’åºï¼ˆè§£å†³ç¬¬ä¸€ç»´ååºï¼‰
      sort(a + 1, a + n + 1, cmp1);
      // åˆå§‹åŒ–æ¯ä¸ªç‚¹çš„LISå€¼ä¸º1ï¼ˆè‡³å°‘åŒ…å«è‡ªå·±ï¼‰
      for (int i = 1; i <= n; i++) a[i].ans = 1;
      // æ‰§è¡ŒCDQåˆ†æ²»
      cdq1(1, n);
      // æ‰¾å‡ºæœ€å¤§çš„LISå€¼
      int ans = 0;
      for (int i = 1; i <= n; i++)
          ans = max(ans, a[i].ans);
      cout << ans << endl;
      return 0;
  }
  ```
* **ä»£ç è§£è¯»æ¦‚è¦**ï¼š  
  1. **è¾“å…¥ä¸ç¦»æ•£åŒ–**ï¼šè¯»å–è¾“å…¥æ•°æ®ï¼Œç¦»æ•£åŒ–ç¬¬å››ç»´ï¼ˆæ ‘çŠ¶æ•°ç»„éœ€è¦ç¦»æ•£åŒ–ï¼‰ã€‚  
  2. **æ’åº**ï¼šæŒ‰ç¬¬ä¸€ç»´æ’åºï¼Œè§£å†³ç¬¬ä¸€ç»´çš„ååºã€‚  
  3. **CDQåˆ†æ²»**ï¼š`cdq1`å¤„ç†ç¬¬äºŒç»´ï¼Œ`cdq2`å¤„ç†ç¬¬ä¸‰ç»´ï¼Œæ ‘çŠ¶æ•°ç»„å¤„ç†ç¬¬å››ç»´ã€‚  
  4. **ç»“æœè®¡ç®—**ï¼šæ‰¾å‡ºæœ€å¤§çš„LISå€¼å¹¶è¾“å‡ºã€‚  

### é¢˜è§£äºŒï¼ˆCDQå¥—CDQï¼‰æ ¸å¿ƒä»£ç ç‰‡æ®µèµæ  
* **äº®ç‚¹**ï¼šç»å…¸çš„é«˜ç»´ååºè§£æ³•ï¼Œæ€è·¯æ¸…æ™°ï¼Œä»£ç è§„èŒƒã€‚  
* **æ ¸å¿ƒä»£ç ç‰‡æ®µ**ï¼š  
  ```cpp
  void cdq2(int l, int r) {
      if (l == r) return;
      int mid = (l + r) >> 1;
      cdq2(l, mid);
      stable_sort(a + l, a + mid + 1, cmp3);
      stable_sort(a + mid + 1, a + r + 1, cmp3);
      int i = l, j = mid + 1;
      for (; j <= r; j++) {
          while (i <= mid && a[i].c <= a[j].c) {
              if (!a[i].f) T.add(a[i].d, a[i].ans);
              i++;
          }
          if (a[j].f) a[j].ans = max(a[j].ans, T.query(a[j].d) + 1);
      }
      for (int j = l; j < i; j++)
          if (!a[j].f) T.clear(a[j].d);
      stable_sort(a + l, a + r + 1, cmp2);
      cdq2(mid + 1, r);
  }
  ```
* **ä»£ç è§£è¯»**ï¼š  
  - `cdq2`å‡½æ•°å¤„ç†ç¬¬ä¸‰ç»´çš„åˆ†æ²»ï¼šé¦–å…ˆé€’å½’å¤„ç†å·¦åŒºé—´`[l, mid]`ï¼Œç„¶åæŒ‰ç¬¬ä¸‰ç»´æ’åºå·¦ã€å³åŒºé—´ã€‚  
  - ç”¨åŒæŒ‡é’ˆ`i`å’Œ`j`éå†å·¦ã€å³åŒºé—´ï¼šå°†å·¦åŒºé—´ä¸­ç¬¬ä¸‰ç»´â‰¤å½“å‰ç‚¹çš„ç‚¹åŠ å…¥æ ‘çŠ¶æ•°ç»„ï¼ˆç¬¬å››ç»´ï¼‰ï¼Œç„¶åæŸ¥è¯¢å³åŒºé—´çš„ç‚¹çš„æœ€å¤§LISå€¼ï¼ˆç¬¬å››ç»´â‰¤å½“å‰ç‚¹ï¼‰ã€‚  
  - å¤„ç†å®Œåæ¸…ç©ºæ ‘çŠ¶æ•°ç»„ï¼Œæ¢å¤æ’åºï¼ˆæŒ‰ç¬¬äºŒç»´ï¼‰ï¼Œé€’å½’å¤„ç†å³åŒºé—´`[mid+1, r]`ã€‚  
* ğŸ’¡ **å­¦ä¹ ç¬”è®°**ï¼šCDQåˆ†æ²»çš„æ ¸å¿ƒæ˜¯â€œåˆ†æ²»+æ’åº+æ•°æ®ç»“æ„â€ï¼Œé€šè¿‡åˆ†æ²»å°†é—®é¢˜åˆ†è§£ä¸ºå­é—®é¢˜ï¼Œæ’åºå¤„ç†å½“å‰ç»´åº¦çš„ååºï¼Œæ•°æ®ç»“æ„å¤„ç†å‰©ä½™ç»´åº¦çš„ååºã€‚  


## 5. ç®—æ³•å¯è§†åŒ–ï¼šåƒç´ åŠ¨ç”»æ¼”ç¤ºï¼ˆCDQåˆ†æ²»ï¼‰

### åŠ¨ç”»æ¼”ç¤ºä¸»é¢˜  
**ã€Šå››ç»´ååºå‰¥æ´‹è‘±ã€‹**ï¼ˆ8ä½åƒç´ é£æ ¼ï¼Œä»¿FCæ¸¸æˆï¼‰  

### æ ¸å¿ƒæ¼”ç¤ºå†…å®¹  
1. **åœºæ™¯åˆå§‹åŒ–**ï¼š  
   - å±å¹•å·¦ä¾§æ˜¾ç¤ºæ’åºåçš„ç‚¹ï¼ˆç¬¬ä¸€ç»´å·²æ’åºï¼‰ï¼Œæ¯ä¸ªç‚¹ç”¨ä¸åŒé¢œè‰²çš„åƒç´ å—è¡¨ç¤ºï¼ˆå¦‚çº¢è‰²è¡¨ç¤ºç‚¹ï¼Œè“è‰²è¡¨ç¤ºå·²å¤„ç†çš„ç‚¹ï¼‰ã€‚  
   - å±å¹•å³ä¾§æ˜¾ç¤ºåˆ†æ²»è¿‡ç¨‹ï¼Œç”¨çŸ©å½¢æ¡†è¡¨ç¤ºå½“å‰åˆ†æ²»çš„åŒºé—´ï¼ˆå¦‚`[l, r]`ï¼‰ï¼Œé¢œè‰²è¡¨ç¤ºåˆ†æ²»çš„å±‚æ¬¡ï¼ˆå¦‚ç¬¬ä¸€å±‚åˆ†æ²»ç”¨ç»¿è‰²ï¼Œç¬¬äºŒå±‚ç”¨é»„è‰²ï¼‰ã€‚  
   - æ§åˆ¶é¢æ¿åŒ…å«â€œå¼€å§‹/æš‚åœâ€ã€â€œå•æ­¥æ‰§è¡Œâ€ã€â€œé‡ç½®â€æŒ‰é’®ï¼Œä»¥åŠé€Ÿåº¦æ»‘å—ï¼ˆ1~5å€é€Ÿï¼‰ã€‚  

2. **åˆ†æ²»è¿‡ç¨‹æ¼”ç¤º**ï¼š  
   - **ç¬¬ä¸€æ­¥ï¼ˆæŒ‰ç¬¬ä¸€ç»´æ’åºï¼‰**ï¼šåŠ¨ç”»å±•ç¤ºç‚¹æŒ‰ç¬¬ä¸€ç»´ä»å°åˆ°å¤§æ’åˆ—ï¼ˆåƒç´ å—ä»å·¦åˆ°å³ç§»åŠ¨ï¼‰ã€‚  
   - **ç¬¬äºŒæ­¥ï¼ˆç¬¬ä¸€å±‚åˆ†æ²»ï¼Œå¤„ç†ç¬¬äºŒç»´ï¼‰**ï¼š  
     - ç”¨ç»¿è‰²çŸ©å½¢æ¡†æ ‡è®°å½“å‰åˆ†æ²»çš„åŒºé—´`[l, r]`ï¼Œå°†åŒºé—´åˆ†ä¸ºå·¦å³ä¸¤éƒ¨åˆ†ï¼ˆ`[l, mid]`å’Œ`[mid+1, r]`ï¼‰ã€‚  
     - ç”¨è“è‰²æ ‡è®°å·¦åŒºé—´çš„ç‚¹ï¼Œçº¢è‰²æ ‡è®°å³åŒºé—´çš„ç‚¹ã€‚  
   - **ç¬¬ä¸‰æ­¥ï¼ˆç¬¬äºŒå±‚åˆ†æ²»ï¼Œå¤„ç†ç¬¬ä¸‰ç»´ï¼‰**ï¼š  
     - ç”¨é»„è‰²çŸ©å½¢æ¡†æ ‡è®°å½“å‰åˆ†æ²»çš„åŒºé—´`[l, r]`ï¼ŒæŒ‰ç¬¬ä¸‰ç»´æ’åºå·¦ã€å³åŒºé—´ï¼ˆåƒç´ å—ä¸Šä¸‹ç§»åŠ¨ï¼‰ã€‚  
     - ç”¨åŒæŒ‡é’ˆ`i`å’Œ`j`éå†å·¦ã€å³åŒºé—´ï¼ˆåƒç´ å—é—ªçƒï¼‰ï¼Œå°†å·¦åŒºé—´çš„ç‚¹åŠ å…¥æ ‘çŠ¶æ•°ç»„ï¼ˆç»¿è‰²é—ªçƒï¼‰ï¼ŒæŸ¥è¯¢å³åŒºé—´çš„ç‚¹ï¼ˆé»„è‰²é«˜äº®ï¼‰ã€‚  
   - **ç¬¬å››æ­¥ï¼ˆæ ‘çŠ¶æ•°ç»„å¤„ç†ç¬¬å››ç»´ï¼‰**ï¼šåŠ¨ç”»å±•ç¤ºæ ‘çŠ¶æ•°ç»„çš„æ›´æ–°ï¼ˆç»¿è‰²æŸ±çŠ¶å›¾ä¸Šå‡ï¼‰å’ŒæŸ¥è¯¢ï¼ˆé»„è‰²æŸ±çŠ¶å›¾æœ€é«˜å€¼ï¼‰ã€‚  

3. **ç›®æ ‡è¾¾æˆ**ï¼š  
   - å½“æ‰€æœ‰åˆ†æ²»æ­¥éª¤å®Œæˆåï¼Œå±å¹•æ˜¾ç¤ºæœ€å¤§çš„LISå€¼ï¼ˆçº¢è‰²å¤§å­—ï¼‰ï¼Œå¹¶æ’­æ”¾â€œèƒœåˆ©â€éŸ³æ•ˆï¼ˆä¸Šæ‰¬çš„8ä½éŸ³è°ƒï¼‰ã€‚  
   - å¦‚æœæ²¡æœ‰è§£ï¼ˆå¦‚æ‰€æœ‰ç‚¹éƒ½ä¸æ»¡è¶³æ¡ä»¶ï¼‰ï¼Œæ’­æ”¾â€œå¤±è´¥â€éŸ³æ•ˆï¼ˆçŸ­ä¿ƒçš„èœ‚é¸£ï¼‰ã€‚  

### äº¤äº’ä¸æ¸¸æˆåŒ–å…ƒç´   
- **å•æ­¥æ‰§è¡Œ**ï¼šç‚¹å‡»â€œå•æ­¥â€æŒ‰é’®ï¼Œé€ä¸€åˆ†æ²»æ­¥éª¤æ¼”ç¤ºï¼Œæ¯æ­¥æ˜¾ç¤ºå½“å‰æ“ä½œçš„æ–‡å­—è¯´æ˜ï¼ˆå¦‚â€œå¤„ç†å·¦åŒºé—´å¯¹å³åŒºé—´çš„è´¡çŒ®â€ï¼‰ã€‚  
- **è‡ªåŠ¨æ’­æ”¾**ï¼šç‚¹å‡»â€œå¼€å§‹â€æŒ‰é’®ï¼ŒåŠ¨ç”»è‡ªåŠ¨æ’­æ”¾ï¼Œé€Ÿåº¦å¯é€šè¿‡æ»‘å—è°ƒæ•´ï¼ˆ1å€é€Ÿæœ€æ…¢ï¼Œ5å€é€Ÿæœ€å¿«ï¼‰ã€‚  
- **éŸ³æ•ˆ**ï¼šåˆ†æ²»å¼€å§‹ï¼ˆå®ï¼‰ã€æŸ¥è¯¢æˆåŠŸï¼ˆæ»´ï¼‰ã€æ›´æ–°å®Œæˆï¼ˆå’šï¼‰ã€èƒœåˆ©ï¼ˆå•¦å•¦å•¦ï¼‰ã€å¤±è´¥ï¼ˆå“”ï¼‰ã€‚  
- **ç§¯åˆ†ç³»ç»Ÿ**ï¼šå®Œæˆæ¯ä¸ªåˆ†æ²»æ­¥éª¤è·å¾—10åˆ†ï¼Œå®Œæˆæ‰€æœ‰æ­¥éª¤è·å¾—100åˆ†ï¼Œå¾—åˆ†æ˜¾ç¤ºåœ¨å±å¹•å³ä¸Šè§’ã€‚  

### è®¾è®¡æ€è·¯  
- **åƒç´ é£æ ¼**ï¼š8ä½åƒç´ é£æ ¼è¥é€ å¤å¤æ¸¸æˆæ°›å›´ï¼Œç¬¦åˆé’å°‘å¹´çš„å®¡ç¾ã€‚  
- **åŠ¨ç”»é€»è¾‘**ï¼šé€šè¿‡é¢œè‰²å’Œ movement æ¸…æ™°å±•ç¤ºåˆ†æ²»çš„æ¯ä¸€æ­¥ï¼Œå¸®åŠ©ç†è§£é«˜ç»´ååºçš„åˆ†è§£è¿‡ç¨‹ã€‚  
- **æ¸¸æˆåŒ–å…ƒç´ **ï¼šéŸ³æ•ˆå’Œç§¯åˆ†ç³»ç»Ÿå¢åŠ è¶£å‘³æ€§ï¼Œæ¿€åŠ±å­¦ä¹ è€…å®Œæˆæ•´ä¸ªæ¼”ç¤ºè¿‡ç¨‹ã€‚  


## 6. æ‹“å±•ç»ƒä¹ ä¸ç›¸ä¼¼é—®é¢˜æ€è€ƒ

### é€šç”¨æ€è·¯/æŠ€å·§è¿ç§»  
å››ç»´ååºçš„å¤„ç†æ€è·¯ï¼ˆæ’åº+åˆ†æ²»+æ•°æ®ç»“æ„ï¼‰å¯ä»¥è¿ç§»åˆ°ä»¥ä¸‹åœºæ™¯ï¼š  
1. **ä¸‰ç»´ååº**ï¼šå¦‚æ´›è°·P3810ï¼ˆé™Œä¸ŠèŠ±å¼€ï¼‰ï¼Œè¦æ±‚ç»Ÿè®¡æ»¡è¶³$a_j \le a_i, b_j \le b_i, c_j \le c_i$çš„ç‚¹å¯¹æ•°é‡ã€‚  
2. **é«˜ç»´LIS**ï¼šå¦‚æ´›è°·P3769ï¼ˆTATTï¼‰ï¼Œæœ¬é¢˜çš„åŸé¢˜ï¼Œè¦æ±‚å››ç»´ååºä¸‹çš„æœ€é•¿LISã€‚  
3. **åŠ¨æ€é«˜ç»´ååº**ï¼šå¦‚æ´›è°·P4148ï¼ˆç®€å•é¢˜ï¼‰ï¼Œè¦æ±‚åŠ¨æ€æ’å…¥ç‚¹å¹¶æŸ¥è¯¢æ»¡è¶³æ¡ä»¶çš„ç‚¹çš„æ•°é‡ã€‚  

### ç»ƒä¹ æ¨èï¼ˆæ´›è°·ï¼‰  
1. **æ´›è°· P3810** - é™Œä¸ŠèŠ±å¼€  
   ğŸ—£ï¸ **æ¨èç†ç”±**ï¼šè¿™æ˜¯ä¸‰ç»´ååºçš„ç»å…¸é¢˜ç›®ï¼Œç»ƒä¹ CDQåˆ†æ²»çš„åŸºæœ¬åº”ç”¨ï¼Œå¸®åŠ©å·©å›ºé«˜ç»´ååºçš„åˆ†è§£æ€è·¯ã€‚  
2. **æ´›è°· P3769** - TATT  
   ğŸ—£ï¸ **æ¨èç†ç”±**ï¼šæœ¬é¢˜çš„åŸé¢˜ï¼Œå·©å›ºå››ç»´ååºçš„å¤„ç†æ–¹æ³•ï¼ˆCDQå¥—CDQæˆ–KD-Treeï¼‰ã€‚  
3. **æ´›è°· P4148** - ç®€å•é¢˜  
   ğŸ—£ï¸ **æ¨èç†ç”±**ï¼šç»ƒä¹ KD-Treeçš„èŒƒå›´æŸ¥è¯¢ï¼Œç†è§£KD-Treeåœ¨åŠ¨æ€é«˜ç»´ååºä¸­çš„åº”ç”¨ã€‚  
4. **æ´›è°· P2048** - è¶…çº§é’¢ç´  
   ğŸ—£ï¸ **æ¨èç†ç”±**ï¼šç»ƒä¹ CDQåˆ†æ²»çš„å…¶ä»–åº”ç”¨ï¼Œç†è§£åˆ†æ²»åœ¨å¤„ç†åŒºé—´é—®é¢˜ä¸­çš„ä½œç”¨ã€‚  


## 7. å­¦ä¹ å¿ƒå¾—ä¸ç»éªŒåˆ†äº«ï¼ˆè‹¥æœ‰ï¼‰  
**å‚è€ƒç»éªŒï¼ˆæ¥è‡ªå¹´åå¤©åœ°çš„é¢˜è§£ï¼‰**ï¼š  
â€œåœ¨CDQåˆ†æ²»ä¸­ï¼Œå¿…é¡»å…ˆé€’å½’å¤„ç†å·¦åŒºé—´ï¼Œå†å¤„ç†å·¦åŒºé—´å¯¹å³åŒºé—´çš„è´¡çŒ®ï¼Œæœ€åé€’å½’å¤„ç†å³åŒºé—´ã€‚å¦‚æœé¡ºåºé”™äº†ï¼Œä¼šå¯¼è‡´å³åŒºé—´çš„ç‚¹è¿˜æ²¡å¤„ç†å°±è¢«è®¡ç®—è´¡çŒ®ï¼Œç»“æœåå°ã€‚â€  

**ç‚¹è¯„**ï¼š  
è¿™ä½ä½œè€…çš„ç»éªŒéå¸¸é‡è¦ã€‚CDQåˆ†æ²»çš„é¡ºåºç›´æ¥å½±å“ç»“æœçš„æ­£ç¡®æ€§ï¼Œå› ä¸ºå·¦åŒºé—´çš„ç‚¹å¿…é¡»åœ¨å¤„ç†å³åŒºé—´ä¹‹å‰å¤„ç†å®Œæ¯•ï¼Œå¦åˆ™å³åŒºé—´çš„ç‚¹æ— æ³•æ­£ç¡®è·å–å·¦åŒºé—´çš„è´¡çŒ®ã€‚åœ¨ç¼–ç¨‹æ—¶ï¼Œä¸€å®šè¦æ³¨æ„é€’å½’çš„é¡ºåºï¼Œé¿å…çŠ¯ç±»ä¼¼çš„é”™è¯¯ã€‚  


## ç»“è¯­  
æœ¬æ¬¡å…³äºâ€œ[CHå¼±çœèƒ¡ç­–R2] TATTâ€çš„C++è§£é¢˜åˆ†æå°±åˆ°è¿™é‡Œã€‚å¸Œæœ›è¿™ä»½å­¦ä¹ æŒ‡å—èƒ½å¸®åŠ©å¤§å®¶ç†è§£é«˜ç»´ååºçš„å¤„ç†æ–¹æ³•ï¼ŒæŒæ¡CDQåˆ†æ²»å’ŒKD-Treeçš„åº”ç”¨ã€‚è®°ä½ï¼Œé«˜ç»´é—®é¢˜çš„æ ¸å¿ƒæ˜¯â€œé™ç»´â€ï¼Œé€šè¿‡æ’åºã€åˆ†æ²»å’Œæ•°æ®ç»“æ„é€æ­¥åˆ†è§£é—®é¢˜ï¼Œä½ ä¸€å®šèƒ½è§£å†³æ›´å¤šçš„ç¼–ç¨‹æŒ‘æˆ˜ï¼ğŸ’ª  

å¦‚æœæœ‰ä»»ä½•ç–‘é—®ï¼Œæ¬¢è¿éšæ—¶å‘æˆ‘æé—®ï¼Œæˆ‘ä¼šå°½åŠ›å¸®åŠ©ä½ ï¼ğŸ˜Š

---
å¤„ç†ç”¨æ—¶ï¼š213.59ç§’
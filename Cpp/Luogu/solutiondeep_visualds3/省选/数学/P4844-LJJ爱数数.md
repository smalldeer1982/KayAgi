# é¢˜ç›®ä¿¡æ¯

# LJJçˆ±æ•°æ•°

## é¢˜ç›®èƒŒæ™¯

é¢˜è§£è¯·æŸ¥çœ‹ <https://www.cnblogs.com/Blog-of-Eden/p/9367521.html>ã€‚

## é¢˜ç›®æè¿°

PJY æŸæ¬¡ç¿»é˜…æ‚å¿—æ—¶ï¼Œçœ‹åˆ°ä¸€é“é¢˜ï¼š

æ±‚å‡ºæ‰€æœ‰çš„ **æ­£æ•´æ•°** ä¸‰å…ƒç»„ $(a,b,c)$ï¼Œæ»¡è¶³ $a,b,c \leq n$ï¼Œ**$\bold{a,b,c}$ ä¸‰ä¸ªæ•°çš„æœ€å¤§å…¬çº¦æ•°ä¸º $\bold{1}$**ï¼Œä¸” **$\bold{\frac{1}{a}+\frac{1}{b}=\frac{1}{c}}$**ã€‚

PJY å«Œè¿™é“é¢˜å¤ªæ°´ï¼Œäºæ˜¯æŠŠå®ƒç”©ç»™äº†çˆ±æ•°æ•°çš„ LJJï¼Œå¹¶åŠ ä¸Šäº†æ•°æ®èŒƒå›´ $\bold{n \leq 10^{12}}$ï¼Œè®© LJJ æ•°å‡º **æœ‰å¤šå°‘ç»„æ»¡è¶³æ¡ä»¶çš„ä¸‰å…ƒç»„ $\bold{(a,b,c)}$**
ï¼ˆæ³¨æ„å½“ $a \not= b$ æ—¶ï¼Œ$(a,b,c)$ å’Œ $(b,a,c)$ æ˜¯ä¸åŒçš„ä¸‰å…ƒç»„ï¼Œè¦ç®—ä¸¤æ¬¡ï¼‰

LJJ æ•°åˆ°ä¸€åŠï¼Œå‘ç°è¿™ä¸ªæ•°é‡å¤ªå¤§äº†ï¼Œäºæ˜¯ä»–æŠŠé—®é¢˜æŠ›ç»™äº†ä½ ã€‚è¯·ä½ è¾“å‡ºè¿™ä¸ªæ•°é‡ã€‚

## è¯´æ˜/æç¤º

å¯¹äº $20\%$ çš„æ•°æ®ï¼Œ$n \leq 2 \times 10^{3}$ã€‚

å¯¹äº $40\%$ çš„æ•°æ®ï¼Œ$n \leq 10^{5}$ã€‚

å¯¹äº $60\%$ çš„æ•°æ®ï¼Œ$n \leq 10^{7}$ã€‚

å¯¹äº $80\%$ çš„æ•°æ®ï¼Œ$n \leq 10^{9}$ã€‚

å¯¹äº $100\%$ çš„æ•°æ®ï¼Œ$n \leq 10^{12}$ã€‚

## æ ·ä¾‹ #1

### è¾“å…¥

```
10```

### è¾“å‡º

```
3```

## æ ·ä¾‹ #2

### è¾“å…¥

```
100```

### è¾“å‡º

```
43```

## æ ·ä¾‹ #3

### è¾“å…¥

```
100000```

### è¾“å‡º

```
42139
```

# AIåˆ†æç»“æœ


### é¢˜ç›®è§£è¯»ä¸æ ¸å¿ƒç®—æ³•è¯†åˆ«
âœ¨ **æœ¬é¢˜ä¸»è¦è€ƒå¯Ÿ**ï¼š`æ•°å­¦æ¨å¯¼ä¸è«æ¯”ä¹Œæ–¯åæ¼”` 

ğŸ—£ï¸ **åˆæ­¥åˆ†æ**ï¼š
> è§£å†³"LJJçˆ±æ•°æ•°"çš„å…³é”®åœ¨äºå°†åˆ†æ•°æ–¹ç¨‹è½¬åŒ–ä¸ºæ•´æ•°å…³ç³»ï¼Œå¹¶é€šè¿‡è´¨å› æ•°åˆ†è§£å’Œäº’è´¨æ¡ä»¶ç®€åŒ–é—®é¢˜ã€‚è¿™ç±»ä¼¼äºåœ¨è¿·å®«ä¸­å¯»æ‰¾éšè—çš„æ•°å­¦è·¯å¾„â€”â€”æˆ‘ä»¬éœ€è¦é€šè¿‡ä»£æ•°å˜å½¢ï¼ˆå¦‚$(a-c)(b-c)=c^2$ï¼‰æ‰“å¼€éšè—çš„ç®—æ³•ä¹‹é—¨ã€‚æ ¸å¿ƒæ­¥éª¤åŒ…æ‹¬ï¼š
> 1. **å…³ç³»è½¬åŒ–**ï¼šç”±$\frac{1}{a}+\frac{1}{b}=\frac{1}{c}$å¯¼å‡º$(a-c)(b-c)=c^2$  
> 2. **å˜é‡æ›¿æ¢**ï¼šè®¾$a-c=x^2, b-c=y^2$ï¼Œåˆ™$c=xy$ï¼Œä¸”$\gcd(x,y)=1$  
> 3. **çº¦æŸåŒ–ç®€**ï¼š$a,b,câ‰¤n$ è½¬åŒ–ä¸º $yâ‰¤\min(\frac{n-x^2}{x}, \frac{-x+\sqrt{x^2+4n}}{2})$  
> 4. **è«æ¯”ä¹Œæ–¯åæ¼”**ï¼šè®¡ç®—$\sum_{x=1}^{\sqrt{n}} \sum_{y=1}^{U(x)} [\gcd(x,y)=1]$ï¼Œå…¶ä¸­$U(x)$ä¸º$y$çš„ä¸Šç•Œ

> **å¯è§†åŒ–è®¾è®¡æ€è·¯**ï¼šé‡‡ç”¨8ä½åƒç´ é£æ ¼è¿·å®«ï¼Œä¸»è§’ä¸ºåƒç´ å°äºº"æ•°æ•°ä¾ "ï¼š  
> - è¿·å®«ç½‘æ ¼è¡¨ç¤º$x,y$çš„æœç´¢ç©ºé—´ï¼Œ$x$è½´æ ‡è®°$1$åˆ°$\sqrt{n}$  
> - æ¯æ­¥é«˜äº®å½“å‰$x$å€¼ï¼ŒåŠ¨æ€ç»˜åˆ¶$y$çš„å¯è¡ŒåŸŸè¾¹ç•Œï¼ˆçº¢è‰²åƒç´ çº¿ï¼‰  
> - å½“$\gcd(x,y)=1$æ—¶ï¼Œè§¦å‘ç»¿è‰²é—ªå…‰å’Œ"å®"éŸ³æ•ˆï¼Œåœ¨å³ä¾§é¢æ¿ç´¯ç§¯è®¡æ•°  
> - æ§åˆ¶é¢æ¿å«è°ƒé€Ÿæ»‘å—ï¼ˆ1x-10xï¼‰ã€å•æ­¥æ‰§è¡Œå’Œé‡ç½®æŒ‰é’®

---

### ç²¾é€‰ä¼˜è´¨é¢˜è§£å‚è€ƒ
**é¢˜è§£ä¸€ï¼ˆä½œè€…ï¼šlnzwzï¼‰**
* **ç‚¹è¯„**ï¼šæ€è·¯æ¸…æ™°ç›´å‡»æ ¸å¿ƒï¼Œå°†é—®é¢˜è½¬åŒ–ä¸º$\sum_{i=1}^{\sqrt{n}} \sum_{j=1}^{R_i}[\gcd(i,j)=1]$ï¼Œå¹¶åˆ›æ–°æ€§åœ°å‘ç°$R_i=\min(i-1,n/i-i)$çš„ç®€åŒ–å½¢å¼ã€‚ä»£ç è§„èŒƒï¼ˆå¦‚å˜é‡å`R[i]`å«ä¹‰æ˜ç¡®ï¼‰ï¼Œè«æ¯”ä¹Œæ–¯å‡½æ•°é¢„å¤„ç†å®Œæ•´ï¼Œè¾¹ç•Œå¤„ç†ä¸¥è°¨ï¼ˆ$i>\sqrt{n}$æ—¶è·³è¿‡ï¼‰ã€‚äº®ç‚¹åœ¨äºç©ºé—´å¤æ‚åº¦ä¼˜åŒ–åˆ°$O(\sqrt{n})$ï¼Œç›´æ¥ç»™å‡º$ansÃ—2+1$çš„å¯¹ç§°è®¡æ•°æŠ€å·§ã€‚

**é¢˜è§£äºŒï¼ˆä½œè€…ï¼šHSY666ï¼‰**
* **ç‚¹è¯„**ï¼šæ¨å¯¼ä¸¥è°¨ï¼Œå®Œæ•´ä¿ç•™åŒçº¦æŸæ¡ä»¶$U=\min(U_1,U_2)$ï¼Œè™½å¢åŠ è®¡ç®—é‡ä½†ä¿è¯æ­£ç¡®æ€§ã€‚é‡‡ç”¨äºŒåˆ†æ³•ç²¾ç¡®è®¡ç®—å¹³æ–¹æ ¹é¿å…æµ®ç‚¹è¯¯å·®ï¼Œå±•ç°å·¥ç¨‹æ€ç»´ã€‚ä»£ç ä¸­`L(d)/R(d)`å‡½æ•°å°è£…å¢å¼ºå¯è¯»æ€§ï¼Œå¤æ‚åº¦$O(\sqrt{n}\log n)$åœ¨$n=10^{12}$ä¸‹ä»é«˜æ•ˆã€‚

**é¢˜è§£ä¸‰ï¼ˆä½œè€…ï¼šæ»‘å¤§ç¨½ï¼‰**
* **ç‚¹è¯„**ï¼šæ•™å­¦ä»·å€¼çªå‡ºï¼Œé€šè¿‡å®ä¾‹æ¼”ç¤ºçº¦æŸæ¡ä»¶æ¯”è¾ƒï¼ˆå¦‚$n=100,x=5$æ—¶$U_2<U_1$ï¼‰ã€‚å¯è§†åŒ–æ€ç»´å¼ºï¼Œæ‰‹ç»˜å‡½æ•°å›¾åƒè¾…åŠ©ç†è§£è¾¹ç•Œï¼Œå¹¶ç»™å‡ºæµ®ç‚¹ä¸æ•´æ•°å¹³æ–¹æ ¹çš„ç²¾åº¦å¯¹æ¯”ã€‚ä»£ç ä¸­`while(l<=r)`äºŒåˆ†æ¨¡æ¿å¯å¤ç”¨æ€§é«˜ã€‚

---

### æ ¸å¿ƒéš¾ç‚¹è¾¨æä¸è§£é¢˜ç­–ç•¥
1. **çº¦æŸæ¡ä»¶èåˆ**  
   * **éš¾ç‚¹**ï¼š$y$éœ€åŒæ—¶æ»¡è¶³$x^2+xyâ‰¤n$å’Œ$y^2+xyâ‰¤n$ï¼Œç›´æ¥æ±‚å¹¶é›†å¤æ‚  
   * **ç­–ç•¥**ï¼šç‹¬ç«‹è®¡ç®—$U_1=\lfloor\frac{n-x^2}{x}\rfloor$å’Œ$U_2=\lfloor\frac{-x+\sqrt{x^2+4n}}{2}\rfloor$åå–$\min$  
   * ğŸ’¡ **å­¦ä¹ ç¬”è®°**ï¼šåŒçº¦æŸå–äº¤æ—¶ï¼Œç‹¬ç«‹è®¡ç®—å†å–$min$æ¯”è”ç«‹ä¸ç­‰å¼æ›´å¯è¡Œ

2. **å¹³æ–¹æ ¹ç²¾åº¦æ§åˆ¶**  
   * **éš¾ç‚¹**ï¼š$x^2+4n$å¯è¾¾$5Ã—10^{12}$ï¼Œæµ®ç‚¹å¼€æ–¹æ˜“ä¸¢å¤±ç²¾åº¦  
   * **ç­–ç•¥**ï¼šæ•´æ•°äºŒåˆ†æ±‚$\lfloor\sqrt{x^2+4n}\rfloor$ï¼Œ$r$åˆå€¼è®¾ä¸º$3Ã—10^6$  
   * ğŸ’¡ **å­¦ä¹ ç¬”è®°**ï¼šå€¼åŸŸ$â‰¤10^{12}$æ—¶ï¼ŒäºŒåˆ†æ¬¡æ•°$<50$ï¼Œæ¯”æµ®ç‚¹å¼€æ–¹+æ ¡æ­£æ›´å¯é 

3. **å¯¹ç§°è®¡æ•°å¤„ç†**  
   * **éš¾ç‚¹**ï¼š$(x,y)$ä¸$(y,x)$å¯¹åº”ä¸åŒä¸‰å…ƒç»„ï¼Œä½†$x=y$æ—¶ä»…ä¸€ç§  
   * **ç­–ç•¥**ï¼š$x$éå†$[1,\sqrt{n}]$æ‰€æœ‰$y$ï¼Œæœ€ç»ˆç»“æœè‡ªç„¶åŒ…å«å¯¹ç§°æ€§  
   * ğŸ’¡ **å­¦ä¹ ç¬”è®°**ï¼šé¿å…å¤–éƒ¨$Ã—2$çš„è¡¥å¿å¼æ€ç»´ï¼Œç›´æ¥æšä¸¾æ›´ä¸æ˜“å‡ºé”™

### âœ¨ è§£é¢˜æŠ€å·§æ€»ç»“
- **ä»£æ•°ç»“æ„è§£æ**ï¼šå°†åˆ†å¼$\frac{1}{a}+\frac{1}{b}=\frac{1}{c}$å˜ä¸º$(a-c)(b-c)=c^2$ï¼Œæ¿€æ´»å› å­åˆ†è§£  
- **è¾¹ç•Œé¢„è®¡ç®—**ï¼š$x$ä»…éœ€æšä¸¾åˆ°$\sqrt{n}$ï¼Œ$U_1/U_2$ä¸ºè´Ÿæ—¶ç«‹å³å‰ªæ  
- **å­˜å‚¨æ¢æ•ˆç‡**ï¼šé¢„å¤„ç†$[1,10^6]$çš„è«æ¯”ä¹Œæ–¯å‡½æ•°å’Œçº¦æ•°è¡¨ï¼Œ$O(1)$æŸ¥è¯¢  
- **å¾ªç¯ç»“æ„ä¼˜åŒ–**ï¼šå¤–å±‚éå†$x$ï¼Œå†…å±‚ç”¨é¢„å­˜çš„çº¦æ•°è¡¨æ›¿ä»£$d$çš„é‡å¤æšä¸¾

---

### C++æ ¸å¿ƒä»£ç å®ç°èµæ
**é€šç”¨æ ¸å¿ƒå®ç°ï¼ˆç»¼åˆé¢˜è§£ï¼‰**
```cpp
#include <iostream>
#include <vector>
#include <cmath>
using namespace std;
typedef long long ll;

vector<int> mu, primes;
vector<bool> is_prime;
vector<vector<int>> divisors;

void init_mu(int n) {
    mu.resize(n+1, 1);
    is_prime.resize(n+1, true);
    is_prime[0] = is_prime[1] = false;
    for (int i = 2; i <= n; ++i) {
        if (is_prime[i]) {
            primes.push_back(i);
            mu[i] = -1;
        }
        for (int p : primes) {
            if (i * p > n) break;
            is_prime[i * p] = false;
            if (i % p == 0) {
                mu[i * p] = 0;
                break;
            } else {
                mu[i * p] = -mu[i];
            }
        }
    }
}

void init_divisors(int n) {
    divisors.resize(n+1);
    for (int i = 1; i <= n; ++i) {
        for (int j = i; j <= n; j += i) {
            divisors[j].push_back(i);
        }
    }
}

int main() {
    ll n; cin >> n;
    int m = sqrt(n);
    init_mu(m);
    init_divisors(m);

    ll ans = 0;
    for (int x = 1; x <= m; ++x) {
        ll U1 = (n - (ll)x*x) / x;
        if (U1 <= 0) continue;

        ll s = (ll)x*x + 4*n;
        ll L = 1, R = min((ll)3e6, (ll)sqrt(n)*3);
        ll t = 0;
        while (L <= R) {
            ll mid = (L+R)/2;
            (mid*mid <= s) ? (t=mid, L=mid+1) : (R=mid-1);
        }
        ll U2 = (t - x) / 2;
        ll U = min(U1, U2);
        if (U < 1) continue;

        for (int d : divisors[x]) {
            ans += (ll)mu[d] * (U / d);
        }
    }
    cout << ans;
}
```
**ä»£ç è§£è¯»æ¦‚è¦**ï¼š  
1. é¢„è®¡ç®—è«æ¯”ä¹Œæ–¯å‡½æ•°$Î¼$ï¼ˆ$O(n)$ç­›æ³•ï¼‰  
2. é¢„å­˜å‚¨$[1,\sqrt{n}]$çš„çº¦æ•°è¡¨ï¼ˆ$O(n\log n)$ç©ºé—´ï¼‰  
3. ä¸»å¾ªç¯æšä¸¾$x$ï¼ŒäºŒåˆ†æ±‚$U_2$ç¡®ä¿ç²¾åº¦  
4. å†…å±‚ç”¨çº¦æ•°è¡¨å¿«é€Ÿè®¡ç®—$\sum_{d|x} Î¼(d)\lfloor\frac{U}{d}\rfloor$

---

### ç®—æ³•å¯è§†åŒ–ï¼šåƒç´ åŠ¨ç”»æ¼”ç¤º
**ä¸»é¢˜**ï¼š8ä½åƒç´ è¿·å®«æ¢é™©  
**æ ¸å¿ƒæµç¨‹**ï¼š  
1. **åœºæ™¯åˆå§‹åŒ–**ï¼š  
   - 16è‰²åƒç´ ç½‘æ ¼ï¼Œ$x$è½´èŒƒå›´$[1,\sqrt{n}]$ï¼Œ$y$è½´åŠ¨æ€ç¼©æ”¾  
   - æ§åˆ¶é¢æ¿ï¼šé€Ÿåº¦æ»‘å—ï¼ˆ1x-10xï¼‰ã€å•æ­¥/è‡ªåŠ¨/é‡ç½®æŒ‰é’®  
   - ä¿¡æ¯æ¿ï¼šæ˜¾ç¤ºå½“å‰$(x,y,U_1,U_2,\gcd)$

2. **åæ ‡æ¢ç´¢**ï¼š  
   ```python
   for x in range(1, sqrt(n)+1):  # åƒç´ å°äººæ¨ªå‘ç§»åŠ¨
     ç»˜åˆ¶ç«–çº¿x, æ’­æ”¾éŸ³æ•ˆ"move_x" (8-bitçŸ­éŸ³)
     U1 = (n-xÂ²)/x, ç»˜åˆ¶çº¢è‰²ä¸Šè¾¹ç•Œ
     U2 = (-x+sqrt(xÂ²+4n))//2, ç»˜åˆ¶è“è‰²ä¸Šè¾¹ç•Œ
     U = min(U1, U2), é«˜äº®é‡å åŒºåŸŸ
   ```

3. **äº’è´¨æ£€æµ‹**ï¼š  
   ```python
   for y in range(1, U+1):  # çºµè½´åƒç´ ç‚¹æ‰«æ
     è®¡ç®—gcd = gcd(x, y)
     if gcd == 1:  # å‘ç°æœ‰æ•ˆè§£
        è§¦å‘ç»¿è‰²é—ªå…‰ï¼Œæ’­æ”¾"ding"éŸ³æ•ˆ
        å³ä¾§è®¡æ•°å™¨+1ï¼Œæ˜¾ç¤ºä¸‰å…ƒç»„(xÂ²+xy, yÂ²+xy, xy)
   ```

4. **è‡ªåŠ¨æ¼”ç¤ºæ¨¡å¼**ï¼š  
   - å¼€å¯å"æ•°æ•°ä¾ "è‡ªåŠ¨éå†ï¼Œé€Ÿåº¦å¯è°ƒï¼ˆé»˜è®¤5xï¼‰  
   - å®Œæˆæ—¶æ’­æ”¾èƒœåˆ©æ—‹å¾‹ï¼Œæ˜¾ç¤º$ans$ç»Ÿè®¡é¢æ¿  
   - æ”¯æŒåŒç®—æ³•å¯¹æ¯”ï¼šç®€çº¦æŸ($U_1$) vs åŒçº¦æŸ($\min(U_1,U_2)$)

**è®¾è®¡æ„ä¹‰**ï¼šåƒç´ å—ç§»åŠ¨å…·è±¡åŒ–æšä¸¾è¿‡ç¨‹ï¼ŒåŒè‰²è¾¹ç•Œçº¿ç›´è§‚å±•ç¤ºçº¦æŸå…³ç³»ï¼ŒéŸ³æ•ˆå¼ºåŒ–å…³é”®æ“ä½œè®°å¿†ç‚¹ã€‚

---

### æ‹“å±•ç»ƒä¹ ä¸ç›¸ä¼¼é—®é¢˜
1. **æŠ€å·§è¿ç§»**ï¼š  
   - **è´¨å› æ•°åˆ†è§£**ï¼šCF1295D - Same GCDsï¼ˆæ±‚$\gcd(a,m)=k$çš„è§£æ•°ï¼‰  
   - **è«æ¯”ä¹Œæ–¯åæ¼”**ï¼šæ´›è°·P2522 - Problem bï¼ˆåŒºé—´$\gcd$è®¡æ•°ï¼‰  
   - **æ•´æ•°æ–¹ç¨‹è½¬åŒ–**ï¼šProject Euler 153ï¼ˆç ”ç©¶$\frac{1}{x}+\frac{1}{y}=\frac{1}{n}$è§£æ•°ï¼‰

2. **æ´›è°·æ¨è**ï¼š  
   - **P5253 ä¸¢ç•ªå›¾**ï¼šåŒæºåˆ†æ•°æ–¹ç¨‹å˜å½¢ï¼Œå¼ºåŒ–ä»£æ•°è½¬åŒ–èƒ½åŠ›  
   - **P2260 æ¨¡ç§¯å’Œ**ï¼šèåˆå–æ¨¡ä¸è«æ¯”ä¹Œæ–¯åæ¼”ï¼Œæå‡çº¦æŸå¤„ç†  
   - **P6156 ç®€å•é¢˜**ï¼šå°èŒƒå›´$n$ä½†éœ€é«˜ç»´åæ¼”ï¼Œè®­ç»ƒå¤æ‚æƒ…å½¢æ€ç»´

---

### å­¦ä¹ å¿ƒå¾—ä¸ç»éªŒåˆ†äº«
> **å‚è€ƒç»éªŒï¼ˆæ¥è‡ªæ»‘å¤§ç¨½ï¼‰**ï¼š  
> "è®¡ç®—$U=\min(U_1,U_2)$æ—¶ï¼Œ$U_2$çš„æµ®ç‚¹å¼€æ–¹åœ¨$n=10^{12}$ä¸‹äº§ç”Ÿ100+é”™è¯¯è§£ï¼Œæ”¹ç”¨æ•´æ•°äºŒåˆ†åACã€‚è¿™æé†’æˆ‘ä»¬ï¼šå¤§æ•°å¼€æ–¹å¿…é¡»ç”¨æ•´æ•°ç®—æ³•ï¼"  
>   
> **ç‚¹è¯„**ï¼šè¯¥ç»éªŒç›´å‡»ç®—æ³•ç«èµ›æ ¸å¿ƒç—›ç‚¹â€”â€”æµ®ç‚¹ç²¾åº¦é™·é˜±ã€‚åœ¨å€¼åŸŸ$>10^{10}$çš„é—®é¢˜ä¸­ï¼Œä¼˜å…ˆé‡‡ç”¨äºŒåˆ†/ç‰›é¡¿è¿­ä»£ç­‰æ•´æ•°ç®—æ³•å¯é¿å…ä¸å¯æŸ¥é”™è¯¯ã€‚

---
å¤„ç†ç”¨æ—¶ï¼š507.32ç§’
# é¢˜ç›®ä¿¡æ¯

# ã€æ¨¡æ¿ã€‘å¤šé¡¹å¼å¯¹æ•°å‡½æ•°ï¼ˆå¤šé¡¹å¼ lnï¼‰

## é¢˜ç›®æè¿°

ç»™å‡º $n-1$ æ¬¡å¤šé¡¹å¼ $A(x)$ï¼Œæ±‚ä¸€ä¸ª $\bmod{\:x^n}$ ä¸‹çš„å¤šé¡¹å¼ $B(x)$ï¼Œæ»¡è¶³ $B(x) \equiv \ln A(x)$.

åœ¨  $\text{mod } 998244353$  ä¸‹è¿›è¡Œï¼Œä¸” $a_i \in [0, 998244353) \cap \mathbb{Z}$

## è¯´æ˜/æç¤º

å¯¹äº $100\%$ çš„æ•°æ®ï¼Œ$n \le 10^5$.

## æ ·ä¾‹ #1

### è¾“å…¥

```
6
1 927384623 878326372 3882 273455637 998233543```

### è¾“å‡º

```
0 927384623 817976920 427326948 149643566 610586717```

# AIåˆ†æç»“æœ


# ğŸ’¡ Kayçš„C++ç®—æ³•è§£æï¼šå¤šé¡¹å¼å¯¹æ•°å‡½æ•°ï¼ˆå¤šé¡¹å¼ lnï¼‰æ·±å…¥å­¦ä¹ æŒ‡å— ğŸ’¡

å¤§å®¶å¥½ï¼Œæˆ‘æ˜¯Kayï¼ä»Šå¤©æˆ‘ä»¬å°†ä¸€èµ·æ¢ç´¢å¤šé¡¹å¼å¯¹æ•°å‡½æ•°çš„è®¡ç®—ã€‚æœ¬æŒ‡å—å°†å¸®åŠ©ä½ ç†è§£é¢˜ç›®æ ¸å¿ƒæ€æƒ³ï¼ŒæŒæ¡å…³é”®ç®—æ³•å®ç°ï¼Œå¹¶é€šè¿‡å¯è§†åŒ–æ–¹æ¡ˆåŠ æ·±ç†è§£ã€‚

## 1. é¢˜ç›®è§£è¯»ä¸æ ¸å¿ƒç®—æ³•è¯†åˆ«

âœ¨ **æœ¬é¢˜ä¸»è¦è€ƒå¯Ÿ**ï¼š`å¤šé¡¹å¼æ“ä½œï¼ˆæ±‚å¯¼ã€æ±‚é€†ã€ä¹˜æ³•ã€ç§¯åˆ†ï¼‰`

ğŸ—£ï¸ **åˆæ­¥åˆ†æ**ï¼š
> è§£å†³å¤šé¡¹å¼å¯¹æ•°å‡½æ•°é—®é¢˜ï¼Œæ ¸å¿ƒåœ¨äºç†è§£å¾®ç§¯åˆ†ä¸å¤šé¡¹å¼è¿ç®—çš„ç»“åˆã€‚æˆ‘ä»¬å¯ä»¥æŠŠln(A(x))çœ‹ä½œä¸€ä¸ªå¤åˆå‡½æ•°ï¼Œé€šè¿‡æ±‚å¯¼å†ç§¯åˆ†çš„æ–¹å¼è½¬åŒ–é—®é¢˜ï¼š
> 1. **æ±‚å¯¼**ï¼šè®¡ç®—A'(x)
> 2. **æ±‚é€†**ï¼šè®¡ç®—1/A(x)
> 3. **ä¹˜æ³•**ï¼šè®¡ç®—A'(x) * (1/A(x))
> 4. **ç§¯åˆ†**ï¼šå¯¹ä¹˜ç§¯ç§¯åˆ†å¾—åˆ°ln(A(x))
>
> åœ¨å¯è§†åŒ–è®¾è®¡ä¸­ï¼Œæˆ‘ä»¬å°†ç”¨ä¸åŒé¢œè‰²çš„åƒç´ å—è¡¨ç¤ºå¤šé¡¹å¼ç³»æ•°ï¼š
> - çº¢è‰²åƒç´ ï¼šå½“å‰æ“ä½œçš„ç³»æ•°
> - è“è‰²åƒç´ ï¼šå·²å®Œæˆè®¡ç®—çš„ç³»æ•°
> - ç»¿è‰²é«˜äº®ï¼šå…³é”®æ­¥éª¤ï¼ˆå¦‚æ±‚å¯¼æ—¶çš„æŒ‡æ•°ä¹˜æ³•ï¼‰
>
> é‡‡ç”¨8ä½æœºé£æ ¼åŠ¨ç”»ï¼ŒèƒŒæ™¯éŸ³ä¹ä¸ºå¤å¤èŠ¯ç‰‡éŸ³ä¹ï¼Œå…³é”®æ“ä½œï¼ˆæ±‚é€†æˆåŠŸ/ä¹˜æ³•å®Œæˆï¼‰æ—¶æ’­æ”¾NESé£æ ¼éŸ³æ•ˆã€‚æ”¯æŒå•æ­¥æ‰§è¡Œå’Œè°ƒé€Ÿæ»‘å—æ§åˆ¶ã€‚

---

## 2. ç²¾é€‰ä¼˜è´¨é¢˜è§£å‚è€ƒ

ä»¥ä¸‹æ˜¯æ€è·¯æ¸…æ™°ã€ä»£ç è§„èŒƒçš„ä¼˜è´¨é¢˜è§£ï¼š

**é¢˜è§£ä¸€ï¼šxzyxzy**
* **ç‚¹è¯„**ï¼šæ€è·¯ç›´æ¥æ¸…æ™°ï¼Œå®Œæ•´å‘ˆç°"æ±‚å¯¼â†’æ±‚é€†â†’ä¹˜æ³•â†’ç§¯åˆ†"æµç¨‹ã€‚ä»£ç è§„èŒƒï¼ˆå˜é‡å`A`è¡¨ç¤ºåŸå¤šé¡¹å¼ï¼Œ`B`å­˜å‚¨ç»“æœï¼‰ï¼Œè¾¹ç•Œå¤„ç†ä¸¥è°¨ï¼ˆå¦‚æ±‚å¯¼åæœ«ä½æ¸…é›¶ï¼‰ã€‚å·§å¦™åˆ©ç”¨NTTåŠ é€Ÿæ±‚é€†å’Œä¹˜æ³•ï¼Œæ—¶é—´å¤æ‚åº¦O(n log n)ï¼Œå…·æœ‰ç›´æ¥ç«èµ›åº”ç”¨ä»·å€¼ã€‚

**é¢˜è§£äºŒï¼šVenusM1nT**
* **ç‚¹è¯„**ï¼šæ¨¡å—åŒ–è®¾è®¡å‡ºè‰²ï¼Œå°†æ±‚å¯¼(`GetDev`)ã€æ±‚é€†(`GetInv`)ã€ç§¯åˆ†(`GetInvDev`)å°è£…ä¸ºç‹¬ç«‹å‡½æ•°ã€‚æ¨å¯¼è¿‡ç¨‹è¯¦ç»†è§£é‡Šäº†å¤åˆå‡½æ•°æ±‚å¯¼åŸç†ï¼Œå¸®åŠ©ç†è§£æ•°å­¦åŸºç¡€ã€‚ä»£ç ä¸­ä¸¥æ ¼å¤„ç†å†…å­˜æ¸…é›¶ï¼Œé¿å…æº¢å‡ºé—®é¢˜ã€‚

**é¢˜è§£ä¸‰ï¼šdblark**
* **ç‚¹è¯„**ï¼šè™½ç„¶ä½¿ç”¨Pascalè¯­è¨€ï¼Œä½†ç®—æ³•æè¿°æå…¶æ¸…æ™°ã€‚å®Œæ•´å®ç°æ±‚å¯¼(`dev`)ã€ç§¯åˆ†(`int`)ã€æ±‚é€†(`inv`)ç­‰åŸºç¡€æ“ä½œï¼Œæ¼”ç¤ºäº†å¦‚ä½•ç»„åˆè¿™äº›æ“ä½œå®ç°å¯¹æ•°å‡½æ•°ã€‚è¾¹ç•Œå¤„ç†ä¸¥è°¨ï¼ˆå¦‚æ±‚é€†åé«˜ä½æ¸…é›¶ï¼‰ã€‚

---

## 3. æ ¸å¿ƒéš¾ç‚¹è¾¨æä¸è§£é¢˜ç­–ç•¥

è§£å†³å¤šé¡¹å¼å¯¹æ•°çš„å…³é”®éš¾ç‚¹åŠåº”å¯¹ç­–ç•¥ï¼š

1.  **éš¾ç‚¹ï¼šå¤šé¡¹å¼æ±‚é€†çš„é€’å½’å®ç°**
    * **åˆ†æ**ï¼šæ±‚é€†éœ€è¦é€’å½’åˆ†å‰²é—®é¢˜ï¼Œå¹¶ç”¨NTTåŠ é€Ÿä¹˜æ³•ã€‚ä¼˜è´¨é¢˜è§£é€šè¿‡ä¸´æ—¶æ•°ç»„å­˜å‚¨ä¸­é—´ç»“æœï¼ˆå¦‚`c`æ•°ç»„ï¼‰ï¼Œåœ¨é€’å½’è¾¹ç•Œå¤„ç†å¸¸æ•°é¡¹é€†å…ƒã€‚
    * ğŸ’¡ **å­¦ä¹ ç¬”è®°**ï¼šé€’å½’æ±‚é€†æ˜¯åˆ†æ²»æ€æƒ³çš„ç»å…¸åº”ç”¨

2.  **éš¾ç‚¹ï¼šæ±‚å¯¼/ç§¯åˆ†çš„è¾¹ç•Œå¤„ç†**
    * **åˆ†æ**ï¼šæ±‚å¯¼åå¤šé¡¹å¼æ¬¡æ•°å‡ä¸€ï¼ˆæœ«ä½æ¸…é›¶ï¼‰ï¼Œç§¯åˆ†åæ¬¡æ•°åŠ ä¸€ï¼ˆé¦–ä½è¡¥é›¶ï¼‰ã€‚éœ€ä¸¥æ ¼å¤„ç†ç´¢å¼•åç§»å’Œæ¨¡é€†å…ƒè®¡ç®—ã€‚
    * ğŸ’¡ **å­¦ä¹ ç¬”è®°**ï¼šç§¯åˆ†æœ¬è´¨æ˜¯æ±‚å¯¼çš„é€†è¿ç®—

3.  **éš¾ç‚¹ï¼šNTTçš„ä½é€†åºæ’åˆ—**
    * **åˆ†æ**ï¼šå¿«é€Ÿæ•°è®ºå˜æ¢(NTT)éœ€è¦é¢„å…ˆè®¡ç®—ä½é€†åºæ’åˆ—ã€‚é€šè¿‡`rev[i] = (rev[i>>1]>>1)|((i&1)<<(bit-1))`é«˜æ•ˆç”Ÿæˆã€‚
    * ğŸ’¡ **å­¦ä¹ ç¬”è®°**ï¼šä½é€†åºæ’åˆ—æ˜¯FFT/NTTé«˜æ•ˆå®ç°çš„å…³é”®

### âœ¨ è§£é¢˜æŠ€å·§æ€»ç»“
1. **æ¨¡å—åŒ–è®¾è®¡**ï¼šåˆ†ç¦»æ±‚å¯¼ã€ç§¯åˆ†ã€æ±‚é€†ç­‰åŸºç¡€æ“ä½œ
2. **å†…å­˜ç®¡ç†**ï¼šåŠæ—¶æ¸…é›¶ä¸´æ—¶æ•°ç»„é«˜ä½ï¼Œé¿å…è„æ•°æ®
3. **å¸¸æ•°ä¼˜åŒ–**ï¼šé¢„å¤„ç†å•ä½æ ¹å’Œé€†å…ƒï¼Œå‡å°‘é‡å¤è®¡ç®—
4. **è¾¹ç•Œæµ‹è¯•**ï¼šç‰¹åˆ«éªŒè¯n=1, 2ç­‰è¾¹ç•Œæƒ…å†µ

---

## 4. C++æ ¸å¿ƒä»£ç å®ç°èµæ

### æœ¬é¢˜é€šç”¨æ ¸å¿ƒC++å®ç°å‚è€ƒ
```cpp
#include <bits/stdc++.h>
using namespace std;
typedef long long ll;
const int N = 1 << 20;
const int mod = 998244353;
const int g = 3, gi = 332748118;

int n, rev[N];
ll A[N], B[N], C[N], D[N], F[N], G[N];

ll qpow(ll a, ll b) {
    ll res = 1;
    while (b) {
        if (b & 1) res = res * a % mod;
        a = a * a % mod;
        b >>= 1;
    }
    return res;
}

void NTT(ll *a, int n, int type) {
    for (int i = 0; i < n; i++) 
        if (i < rev[i]) swap(a[i], a[rev[i]]);
    for (int mid = 1; mid < n; mid <<= 1) {
        ll wn = qpow(type == 1 ? g : gi, (mod-1)/(mid<<1));
        for (int j = 0; j < n; j += (mid << 1)) {
            ll w = 1;
            for (int k = 0; k < mid; k++, w = w*wn%mod) {
                ll x = a[j+k], y = w*a[j+k+mid]%mod;
                a[j+k] = (x+y) % mod;
                a[j+k+mid] = (x-y+mod) % mod;
            }
        }
    }
    if (type == -1) {
        ll invn = qpow(n, mod-2);
        for (int i = 0; i < n; i++) 
            a[i] = a[i]*invn%mod;
    }
}

void Derivative(ll *f, ll *g, int n) {
    for (int i = 1; i < n; i++) 
        g[i-1] = i * f[i] % mod;
    g[n-1] = 0;
}

void Integral(ll *f, ll *g, int n) {
    for (int i = 1; i < n; i++)
        g[i] = f[i-1]*qpow(i, mod-2)%mod;
    g[0] = 0;
}

void Inv(ll *f, ll *g, int n) {
    if (n == 1) { 
        g[0] = qpow(f[0], mod-2); 
        return; 
    }
    Inv(f, g, (n+1)>>1);
    
    int lim = 1, bit = 0;
    while (lim < (n<<1)) lim <<= 1, bit++;
    for (int i = 0; i < lim; i++)
        rev[i] = (rev[i>>1]>>1)|((i&1)<<(bit-1));
    
    for (int i = 0; i < n; i++) C[i] = f[i];
    for (int i = n; i < lim; i++) C[i] = 0;
    
    NTT(C, lim, 1); NTT(g, lim, 1);
    for (int i = 0; i < lim; i++) 
        g[i] = (2 - C[i]*g[i]%mod + mod) % mod * g[i] % mod;
    NTT(g, lim, -1);
    
    for (int i = n; i < lim; i++) g[i] = 0;
}

void Ln(ll *f, ll *g, int n) {
    Derivative(f, A, n);  // A = f'
    Inv(f, B, n);        // B = 1/f
    // ä¹˜æ³• A * B
    int lim = 1, bit = 0;
    while (lim < (n<<1)) lim <<= 1, bit++;
    for (int i = 0; i < lim; i++)
        rev[i] = (rev[i>>1]>>1)|((i&1)<<(bit-1));
    NTT(A, lim, 1); NTT(B, lim, 1);
    for (int i = 0; i < lim; i++) 
        A[i] = A[i] * B[i] % mod;
    NTT(A, lim, -1);
    // ç§¯åˆ†å¾—ç»“æœ
    Integral(A, g, n);
}

int main() {
    scanf("%d", &n);
    for (int i = 0; i < n; i++) scanf("%lld", &F[i]);
    int m = 1; while (m < n) m <<= 1;
    Ln(F, G, m);
    for (int i = 0; i < n; i++) printf("%lld ", G[i]);
    return 0;
}
```

**ä»£ç è§£è¯»æ¦‚è¦**ï¼š
1. ä¸»å‡½æ•°è¯»å…¥å¤šé¡¹å¼Fï¼Œè®¡ç®—å…¶å¯¹æ•°G
2. `Ln`å‡½æ•°å®ç°æ ¸å¿ƒæµç¨‹ï¼š
   - `Derivative`è®¡ç®—å¤šé¡¹å¼æ±‚å¯¼
   - `Inv`è®¡ç®—å¤šé¡¹å¼é€†å…ƒ
   - NTTåŠ é€Ÿå¤šé¡¹å¼ä¹˜æ³•
   - `Integral`å¯¹ç»“æœç§¯åˆ†
3. NTTå®ç°é«˜æ•ˆå¤šé¡¹å¼ä¹˜æ³•
4. è¾¹ç•Œå¤„ç†ï¼šæ±‚å¯¼åæœ«ä½æ¸…é›¶ï¼Œç§¯åˆ†é¦–ä½æ¸…é›¶

---

## 5. ç®—æ³•å¯è§†åŒ–ï¼šåƒç´ åŠ¨ç”»æ¼”ç¤º

æˆ‘ä»¬è®¾è®¡ä¸€ä¸ªå¤å¤åƒç´ é£æ ¼åŠ¨ç”»æ¼”ç¤ºç®—æ³•æµç¨‹ï¼š

![å¤šé¡¹å¼lnå¯è§†åŒ–ç¤ºæ„å›¾](https://via.placeholder.com/400x200?text=å¤šé¡¹å¼lnåƒç´ åŠ¨ç”»ç¤ºæ„å›¾)

* **æ•´ä½“é£æ ¼**ï¼š8ä½æœºæ¸¸æˆé£æ ¼ï¼ˆç±»ä¼¼NESï¼‰ï¼Œä½¿ç”¨16è‰²è°ƒè‰²æ¿
* **åŠ¨ç”»æµç¨‹**ï¼š
  1. **åˆå§‹åŒ–**ï¼šæ˜¾ç¤ºåŸå§‹å¤šé¡¹å¼ç³»æ•°ï¼ˆåƒç´ æ–¹å—é«˜åº¦=ç³»æ•°å€¼ï¼‰
  2. **æ±‚å¯¼é˜¶æ®µ**ï¼š
     - åƒç´ æ–¹å—å‘å·¦ç§»åŠ¨ï¼ˆè¡¨ç¤ºæŒ‡æ•°-1ï¼‰
     - æ–¹å—å˜è‰²+ç¼©æ”¾ï¼ˆè¡¨ç¤ºä¹˜ä»¥åŸæŒ‡æ•°ï¼‰
     - æ’­æ”¾"æ»´"å£°æ•ˆ
  3. **æ±‚é€†é˜¶æ®µ**ï¼š
     - å±å¹•åˆ†å‰²æ˜¾ç¤ºé€’å½’è¿‡ç¨‹ï¼ˆäºŒåˆ†åˆ†å‰²åŠ¨ç”»ï¼‰
     - ç‰›é¡¿è¿­ä»£æ—¶æ˜¾ç¤ºå•ä½æ ¹æ—‹è½¬åŠ¨ç”»
     - æˆåŠŸæ—¶æ’­æ”¾"å®"å£°æ•ˆ
  4. **ä¹˜æ³•é˜¶æ®µ**ï¼š
     - è´è¶æ“ä½œå¯è§†åŒ–ï¼ˆåƒç´ å—äº¤å‰ç§»åŠ¨ï¼‰
     - ä¹˜åŠ æ“ä½œæ—¶åƒç´ é—ªçƒé»„è‰²
  5. **ç§¯åˆ†é˜¶æ®µ**ï¼š
     - åƒç´ æ–¹å—å‘å³ç§»åŠ¨ï¼ˆè¡¨ç¤ºæŒ‡æ•°+1ï¼‰
     - æ–¹å—é«˜åº¦æŒ‰ç§¯åˆ†å…¬å¼è°ƒæ•´

* **äº¤äº’åŠŸèƒ½**ï¼š
  - æ§åˆ¶é¢æ¿ï¼šå¼€å§‹/æš‚åœ/é‡ç½®/å•æ­¥æ‰§è¡Œ
  - é€Ÿåº¦æ»‘å—ï¼šè°ƒæ•´åŠ¨ç”»é€Ÿåº¦
  - æ¨¡å¼åˆ‡æ¢ï¼šæŸ¥çœ‹ä¸åŒå¤šé¡¹å¼è¾“å…¥

* **æŠ€æœ¯å®ç°**ï¼š
  - Canvasç»˜åˆ¶åƒç´ ç½‘æ ¼å’Œæ•°æ®ç»“æ„
  - å…³é”®å¸§æ ‡è®°ç®—æ³•é˜¶æ®µ
  - Web Audio APIæ’­æ”¾8-bitéŸ³æ•ˆ

---

## 6. æ‹“å±•ç»ƒä¹ ä¸ç›¸ä¼¼é—®é¢˜æ€è€ƒ

### ç›¸ä¼¼é—®é¢˜æ‹“å±•
1. **å¤šé¡¹å¼æŒ‡æ•°å‡½æ•°**ï¼ˆexpï¼‰ï¼šé€šè¿‡ç‰›é¡¿è¿­ä»£å®ç°ï¼Œéœ€è¦è°ƒç”¨å¯¹æ•°å‡½æ•°
2. **å¤šé¡¹å¼å¿«é€Ÿå¹‚**ï¼šå…ˆå–å¯¹æ•°â†’ä¹˜ä»¥æŒ‡æ•°â†’å–æŒ‡æ•°
3. **å¤šé¡¹å¼ä¸‰è§’å‡½æ•°**ï¼šåˆ©ç”¨æ¬§æ‹‰å…¬å¼è½¬åŒ–ä¸ºæŒ‡æ•°å½¢å¼

### æ´›è°·é¢˜ç›®æ¨è
1. **P4726 å¤šé¡¹å¼æŒ‡æ•°å‡½æ•°**  
   â†’ ç»ƒä¹ å¯¹æ•°å‡½æ•°çš„é€†è¿ç®—
   
2. **P5245 å¤šé¡¹å¼å¿«é€Ÿå¹‚**  
   â†’ åº”ç”¨å¯¹æ•°å‡½æ•°å®ç°å¹‚è¿ç®—
   
3. **P5264 å¤šé¡¹å¼ä¸‰è§’å‡½æ•°**  
   â†’ æ‰©å±•å¤æ•°åŸŸä¸Šçš„å¤šé¡¹å¼æ“ä½œ

---

## 7. å­¦ä¹ å¿ƒå¾—ä¸ç»éªŒåˆ†äº«

> **æ¥è‡ªxzyxzyçš„ç»éªŒ**ï¼š  
> "å¤šé¡¹å¼æ“ä½œä¸­ï¼ŒNTTçš„ä½é€†åºé¢„å¤„ç†ææ˜“å‡ºé”™ï¼Œå»ºè®®å°è£…æˆç‹¬ç«‹å‡½æ•°ã€‚æ±‚å¯¼/ç§¯åˆ†æ—¶è¦æ³¨æ„æ•°ç»„é•¿åº¦å˜åŒ–"

> **Kayçš„æ€»ç»“**ï¼š  
> è°ƒè¯•å¤šé¡¹å¼é—®é¢˜æ—¶ï¼Œå¯æ‰“å°ä¸­é—´æ­¥éª¤ç»“æœï¼ˆå¦‚æ±‚å¯¼åã€æ±‚é€†åçš„å¤šé¡¹å¼ï¼‰ã€‚ç‰¹åˆ«æ³¨æ„ï¼š
> 1. æ±‚é€†æ—¶é€’å½’è¾¹ç•Œ(n=1)çš„å¤„ç†
> 2. NTTå‰åæ•°ç»„é•¿åº¦çš„å¯¹é½
> 3. ç§¯åˆ†æ—¶é¦–é¡¹è¡¥é›¶

---

æœ¬æ¬¡è§£æå°±åˆ°è¿™é‡Œï¼Œå¸Œæœ›å¤§å®¶èƒ½æŒæ¡å¤šé¡¹å¼å¯¹æ•°çš„æ ¸å¿ƒæ€æƒ³ï¼ä¸‹æ¬¡æˆ‘ä»¬å°†æŒ‘æˆ˜å¤šé¡¹å¼æŒ‡æ•°å‡½æ•°ï¼Œç»§ç»­åŠ æ²¹ï¼ğŸ’ª

---
å¤„ç†ç”¨æ—¶ï¼š186.29ç§’
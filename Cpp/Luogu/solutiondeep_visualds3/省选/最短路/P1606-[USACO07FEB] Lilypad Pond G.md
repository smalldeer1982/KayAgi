# é¢˜ç›®ä¿¡æ¯

# [USACO07FEB] Lilypad Pond G

## é¢˜ç›®æè¿°

FJ has installed a beautiful pond for his cows' aesthetic enjoyment and exercise.

The rectangular pond has been partitioned into square cells of M rows and N columns (1 â‰¤ M â‰¤ 30; 1 â‰¤ N â‰¤ 30). Some of the cells have astonishingly sturdy lilypads; others have rocks; the remainder are just beautiful, cool, blue water.

Bessie is practicing her ballet moves by jumping from one lilypad to another and is currently located at one of the lilypads. She wants to travel to another lilypad in the pond by jumping from one lilypad to another.

Surprising only to the uninitiated, Bessie's jumps between lilypads always appear as a chess-knight's move: one move in one direction and then two more in the orthogonal direction (or perhaps two in one direction and then one in the orthogonal direction).

Farmer John is observing Bessie's ballet drill and realizes that sometimes she might not be able to jump to her destination lilypad because intermediary lilypads are missing.

Ever thrifty, he wants to place additional lilypads so she can complete her quest (perhaps quickly, perhaps by using a large number of intermediate lilypads). Of course, lilypads cannot be placed where rocks already intrude on a cell.

Help Farmer John determine the minimum number of additional lilypads he has to place, and in how many ways he can place that minimum number.


## è¯´æ˜/æç¤º

### æ ·ä¾‹è§£é‡Š

æ± å¡˜åˆ†æˆå››è¡Œäº”åˆ—ï¼Œè´è¥¿çš„èµ·ç‚¹åœ¨ç¬¬äºŒè¡Œç¬¬ä¸€åˆ—ï¼Œæƒ³å»çš„ç»ˆç‚¹åœ¨ç¬¬å››è¡Œç¬¬å››åˆ—ï¼Œæ± å¡˜é‡Œä¸€å…±æœ‰ä¸‰æœµè²èŠ±å’Œä¸€å—çŸ³å¤´ã€‚

æœ€å°‘éœ€è¦ä¸¤æœµè²èŠ±ï¼Œæœ‰ä¸‰ç§æ–¹å¼å¯ä»¥æ”¾ç½®ï¼Œ

å¦‚ä¸‹ $\verb!X!$ æ‰€ç¤ºï¼š

$$\begin{bmatrix}
\verb!10000! \\
\verb!30X00! \\
\verb!00200! \\
\verb!0X040! \\
\end{bmatrix},\begin{bmatrix}
\verb!10X00! \\
\verb!30000! \\
\verb!0X200! \\
\verb!00040! \\
\end{bmatrix},\begin{bmatrix}
\verb!10X00! \\
\verb!3000X! \\
\verb!00200! \\
\verb!00040! \\
\end{bmatrix}
$$

## æ ·ä¾‹ #1

### è¾“å…¥

```
4 5
1 0 0 0 0
3 0 0 0 0
0 0 2 0 0
0 0 0 4 0
```

### è¾“å‡º

```
2
3
```

# AIåˆ†æç»“æœ


# ğŸ’¡ Kayçš„C++ç®—æ³•è§£æï¼šLilypad Pond G æ·±å…¥å­¦ä¹ æŒ‡å— ğŸ’¡

<introduction>
ä»Šå¤©æˆ‘ä»¬ä¸€èµ·åˆ†æã€ŒLilypad Pond Gã€è¿™é“C++å›¾è®ºé¢˜ã€‚æœ¬æŒ‡å—å°†å¸®åŠ©ä½ æŒæ¡å»ºå›¾æŠ€å·§å’Œæœ€çŸ­è·¯è®¡æ•°ï¼Œé€šè¿‡ç”ŸåŠ¨è§£æå’Œåƒç´ åŠ¨ç”»ç›´è§‚ç†è§£ç®—æ³•è¿‡ç¨‹ã€‚
</introduction>

## 1. é¢˜ç›®è§£è¯»ä¸æ ¸å¿ƒç®—æ³•è¯†åˆ«

âœ¨ **æœ¬é¢˜ä¸»è¦è€ƒå¯Ÿ**ï¼š`å›¾è®ºå»ºæ¨¡`ä¸`æœ€çŸ­è·¯è®¡æ•°`

ğŸ—£ï¸ **åˆæ­¥åˆ†æ**ï¼š
> æœ¬é¢˜å¯ç±»æ¯”ä¸ºã€Œéª‘å£«æ¢é™©ã€æ¸¸æˆï¼šBessieæ˜¯åƒç´ éª‘å£«ï¼Œéœ€åœ¨æ± å¡˜ç½‘æ ¼ä¸­æ”¾ç½®æœ€å°‘çš„è²èŠ±ï¼ˆåˆ›å»ºè·¯å¾„ï¼‰åˆ°è¾¾ç»ˆç‚¹ã€‚æ ¸å¿ƒæ€æƒ³æ˜¯å°†**ç½‘æ ¼ä½ç½®è½¬åŒ–ä¸ºå›¾èŠ‚ç‚¹**ï¼Œé€šè¿‡**DFS/BFSé¢„å¤„ç†**è·³è¿‡ç°æœ‰è²èŠ±è¿é€šå—ï¼Œå»ºç«‹è¾¹æƒä¸º1çš„å›¾ï¼ˆæ¯è¾¹ä»£è¡¨æ”¾ç½®ä¸€ä¸ªè²èŠ±ï¼‰ï¼Œæœ€ç»ˆç”¨**SPFA/BFS**è§£å†³æœ€çŸ­è·¯è®¡æ•°é—®é¢˜ã€‚
   - **æ ¸å¿ƒéš¾ç‚¹**ï¼šé¿å…ç°æœ‰è²èŠ±é€ æˆçš„0æƒç¯å¹²æ‰°è®¡æ•°ï¼Œéœ€é€šè¿‡é¢„å¤„ç†å°†"è²èŠ±è·³æ¿"å‹ç¼©ä¸ºå•æ­¥å¯è¾¾å…³ç³»
   - **ç®—æ³•æµç¨‹**ï¼šç½‘æ ¼ç¼–å· â†’ DFS/BFSé¢„è¿è¾¹ï¼ˆæ¸…æ°´/ç»ˆç‚¹ï¼‰â†’ SPFAæ±‚æœ€çŸ­è·¯+è®¡æ•°
   - **å¯è§†åŒ–è®¾è®¡**ï¼šåƒç´ ç½‘æ ¼ä¸­ï¼Œç”¨ä¸åŒé¢œè‰²åŒºåˆ†å…ƒç´ ï¼ˆèµ·ç‚¹ç»¿/ç»ˆç‚¹çº¢/å²©çŸ³ç°/æ¸…æ°´è“/è²èŠ±é»„ï¼‰ï¼ŒDFSé¢„å¤„ç†æ—¶æ˜¾ç¤º"è¿é€šå—æ‰«æ"åŠ¨ç”»ï¼ŒSPFAæ‰§è¡Œæ—¶é«˜äº®å½“å‰é˜Ÿåˆ—å¤´èŠ‚ç‚¹å’Œè·ç¦»æ›´æ–°è¿‡ç¨‹ï¼Œæ”¾ç½®è²èŠ±æ—¶è§¦å‘"å®"éŸ³æ•ˆï¼Œåˆ°è¾¾ç»ˆç‚¹æ’­æ”¾èƒœåˆ©éŸ³æ•ˆ

---

## 2. ç²¾é€‰ä¼˜è´¨é¢˜è§£å‚è€ƒ

<eval_intro>
ä»æ€è·¯æ¸…æ™°æ€§ã€ä»£ç è§„èŒƒæ€§å’Œå®è·µä»·å€¼è§’åº¦ï¼Œç²¾é€‰3ä»½ä¼˜è´¨é¢˜è§£ï¼š
</eval_intro>

**é¢˜è§£ä¸€ï¼ˆD_14134ï¼‰**
* **ç‚¹è¯„**ï¼šè¯¥è§£æ³•çš„DFSé¢„å¤„ç†è®¾è®¡ç²¾å¦™ï¼Œé€šè¿‡é€’å½’ç©¿é€è²èŠ±è¿é€šå—ç›´æ¥è¿æ¥æœ‰æ•ˆç›®æ ‡ç‚¹ï¼Œå½»åº•é¿å…0æƒè¾¹ã€‚ä»£ç ä¸­`adde(o,p[xx][yy])`ç²¾å‡†å®ç°"å•è²èŠ±å¤šç›®æ ‡"æ˜ å°„ï¼Œå˜é‡å`o`ï¼ˆåŸç‚¹ï¼‰å’Œ`p`ï¼ˆä½ç½®æ•°ç»„ï¼‰ç®€æ´æ˜ç¡®ã€‚SPFAéƒ¨åˆ†é‡‡ç”¨æ ‡å‡†æœ€çŸ­è·¯è®¡æ•°æ¡†æ¶ï¼Œ`f[v]+=f[x]`å®ç°æ–¹æ¡ˆæ•°ç´¯åŠ ï¼Œè¾¹ç•Œå¤„ç†å®Œæ•´ã€‚

**é¢˜è§£äºŒï¼ˆs_Shotáƒ¦Makiï¼‰**
* **ç‚¹è¯„**ï¼šäº®ç‚¹åœ¨äºè¯¦ç»†çš„å˜é‡è¯´æ˜å’Œè°ƒè¯•æç¤ºï¼ˆå¼ºè°ƒ`long long`ï¼‰ã€‚DFSé¢„å¤„ç†ä½¿ç”¨ç‹¬ç«‹`used`æ•°ç»„é¿å…çŠ¶æ€æ±¡æŸ“ï¼Œ`This_is_for_you`å‡½æ•°å‘½åç”ŸåŠ¨ä½“ç°"å•ç‚¹è¾å°„"ç‰¹æ€§ã€‚SPFAå®ç°ä¸¥æ ¼éµå¾ª"è·ç¦»ç›¸ç­‰åˆ™ç´¯åŠ ï¼Œæ›´çŸ­åˆ™é‡ç½®"åŸåˆ™ï¼Œä»£ç æ¨¡å—åŒ–ç¨‹åº¦é«˜ã€‚

**é¢˜è§£ä¸‰ï¼ˆé¡¾zï¼‰**
* **ç‚¹è¯„**ï¼šç‹¬åˆ›æ€§å›¾ç¤ºç½‘æ ¼ç¼–å·ç³»ç»Ÿï¼Œå°†äºŒç»´åæ ‡`(i,j)`è½¬åŒ–ä¸º`(i-1)*m+j`çš„ä¸€ç»´ç´¢å¼•ï¼Œå¤§å¹…ç®€åŒ–é‚»æ¥è¡¨æ“ä½œã€‚DFSä¸­çš„`vis`æ•°ç»„åŒé‡ä½œç”¨ï¼ˆé˜²é‡è®¿+è¿æ¥æ ‡è®°ï¼‰å±•ç°ç©ºé—´ä¼˜åŒ–æ€ç»´ï¼ŒSPFAéƒ¨åˆ†`dis[v]>dis[u]+1`çš„æ¡ä»¶åˆ¤æ–­æ˜¯ç»å…¸æœ€çŸ­è·¯è®¡æ•°èŒƒå¼ã€‚

---

## 3. æ ¸å¿ƒéš¾ç‚¹è¾¨æä¸è§£é¢˜ç­–ç•¥

<difficulty_intro>
è§£å†³æœ¬é¢˜éœ€çªç ´ä¸‰ä¸ªå…³é”®éš¾ç‚¹ï¼š
</difficulty_intro>

1.  **éš¾ç‚¹ï¼šç°æœ‰è²èŠ±é€ æˆçš„è·¯å¾„å¹²æ‰°**
    * **åˆ†æ**ï¼šç°æœ‰è²èŠ±ï¼ˆå€¼1ï¼‰å½¢æˆå…è´¹é€šé“ï¼Œç›´æ¥å»ºè¾¹ä¼šå¯¼è‡´0æƒç¯ã€‚ä¼˜è´¨è§£æ³•é€šè¿‡DFS/BFSé¢„å¤„ç†ï¼šä»æ¸…æ°´/èµ·ç‚¹å‡ºå‘ï¼Œé€’å½’ç©¿é€è²èŠ±ç¾¤ï¼Œä»…è¿æ¥éè²èŠ±çš„æœ‰æ•ˆç‚¹ï¼ˆæ¸…æ°´/ç»ˆç‚¹ï¼‰ï¼Œå»ºç«‹è¾¹æƒä¸º1çš„ç›´è¿é€šé“
    * ğŸ’¡ **å­¦ä¹ ç¬”è®°**ï¼šå°†"è²èŠ±è·³æ¿"å‹ç¼©ä¸ºç›´è¾¾è·¯å¾„æ˜¯é¿å…0æƒç¯çš„æ ¸å¿ƒæŠ€å·§

2.  **éš¾ç‚¹ï¼šå¤šç»´çŠ¶æ€åˆ°ä¸€ç»´å›¾çš„è½¬åŒ–**
    * **åˆ†æ**ï¼šäºŒç»´ç½‘æ ¼éœ€è½¬åŒ–ä¸ºä¸€ç»´å›¾ç»“æ„ã€‚é€šç”¨æ–¹æ¡ˆæ˜¯ä½ç½®ç¼–å·`idx = (i-1)*m + j`ï¼Œé…åˆæ–¹å‘æ•°ç»„`dx/dy`å®ç°éª‘å£«ç§»åŠ¨ã€‚é‚»æ¥è¡¨å­˜å‚¨æ—¶ï¼Œæ³¨æ„æ•°ç»„å¤§å°åº”è®¾ä¸º`(n*m)*8`ä»¥ä¸Š
    * ğŸ’¡ **å­¦ä¹ ç¬”è®°**ï¼šç½‘æ ¼é—®é¢˜å¸¸ç”¨`(i-1)*m+j`ç¼–å·æ³•å®ç°é™ç»´æ‰“å‡»

3.  **éš¾ç‚¹ï¼šæœ€çŸ­è·¯è®¡æ•°çš„ç´¯åŠ é€»è¾‘**
    * **åˆ†æ**ï¼šSPFA/BFSä¸­ï¼Œå½“`dis[v] == dis[u] + 1`æ—¶æ‰§è¡Œ`cnt[v] += cnt[u]`å®ç°æ–¹æ¡ˆæ•°ç´¯åŠ ã€‚å¿…é¡»ç”¨`long long`å­˜å‚¨è®¡æ•°ï¼Œä¸”ç»ˆç‚¹è·ç¦»éœ€å‡1ï¼ˆèµ·ç‚¹æœªæ”¾ç½®è²èŠ±ï¼‰
    * ğŸ’¡ **å­¦ä¹ ç¬”è®°**ï¼šæœ€çŸ­è·¯è®¡æ•°çš„æœ¬è´¨æ˜¯åŠ¨æ€è§„åˆ’ä¸­çš„çŠ¶æ€è½¬ç§»

### âœ¨ è§£é¢˜æŠ€å·§æ€»ç»“
<summary_best_practices>
- **æŠ€å·§1ï¼šé¢„å¤„ç†å‹ç¼©çŠ¶æ€** - å¯¹å…è´¹é€šé“ï¼ˆå¦‚è²èŠ±ç¾¤ï¼‰è¿›è¡ŒDFS/BFSé¢„å¤„ç†ï¼Œè½¬åŒ–ä¸ºç›´è¿è¾¹
- **æŠ€å·§2ï¼šè¾¹ç•Œé²æ£’æ€§æ£€æŸ¥** - ç§»åŠ¨å‰åˆ¤æ–­`nx>=1 && nx<=n && ny>=1 && ny<=m`ï¼Œé‡åˆ°å²©çŸ³(`2`)ç«‹å³è·³è¿‡
- **æŠ€å·§3ï¼šè®¡æ•°é˜²æº¢å‡º** - æ–¹æ¡ˆæ•°å˜é‡ç»Ÿä¸€ç”¨`long long`å£°æ˜ï¼Œè¾“å‡ºç”¨`%lld`
- **æŠ€å·§4ï¼šé‚»æ¥è¡¨ä¼˜åŒ–** - ä½¿ç”¨`vector<vector<int>>`æˆ–é“¾å¼å‰å‘æ˜Ÿå­˜å‚¨ç¨€ç–å›¾
---

## 4. C++æ ¸å¿ƒä»£ç å®ç°èµæ

<code_intro_overall>
ç»¼åˆä¼˜è´¨é¢˜è§£æç‚¼é€šç”¨å®ç°ï¼š
</code_intro_overall>

**æœ¬é¢˜é€šç”¨æ ¸å¿ƒC++å®ç°å‚è€ƒ**
* **è¯´æ˜**ï¼šç»¼åˆDFSé¢„å¤„ç†å»ºå›¾ä¸SPFAæœ€çŸ­è·¯è®¡æ•°ï¼Œå«å®Œæ•´è¾¹ç•Œå¤„ç†
* **å®Œæ•´æ ¸å¿ƒä»£ç **ï¼š
```cpp
#include <iostream>
#include <queue>
#include <cstring>
#include <vector>
using namespace std;
typedef long long ll;
const int N = 35, M = 1000;
const int dx[8] = {1,1,-1,-1,2,2,-2,-2};
const int dy[8] = {2,-2,2,-2,1,-1,1,-1};

int n, m, grid[N][N], idx[N][N];
int start, target, cnt;
vector<int> G[M];
ll counts[M];
int dist[M];

void dfs(int origin, int x, int y, bool vis[][N]) {
    vis[x][y] = true;
    for (int k = 0; k < 8; k++) {
        int nx = x + dx[k], ny = y + dy[k];
        if (nx < 1 || ny < 1 || nx > n || ny > m || vis[nx][ny]) continue;
        if (grid[nx][ny] == 1) dfs(origin, nx, ny, vis);  // ç©¿é€è²èŠ±ç¾¤
        else if (grid[nx][ny] != 2) {                     // è¿æ¥æœ‰æ•ˆç‚¹
            vis[nx][ny] = true;
            G[origin].push_back(idx[nx][ny]);
        }
    }
}

void spfa() {
    memset(dist, 0x3f, sizeof(dist));
    queue<int> q;
    q.push(start);
    dist[start] = 0;
    counts[start] = 1;
    while (!q.empty()) {
        int u = q.front(); q.pop();
        for (int v : G[u]) {
            if (dist[v] > dist[u] + 1) {  // å‘ç°æ›´çŸ­è·¯å¾„
                dist[v] = dist[u] + 1;
                counts[v] = counts[u];
                q.push(v);
            } else if (dist[v] == dist[u] + 1) {  // ç­‰é•¿è·¯å¾„ç´¯åŠ 
                counts[v] += counts[u];
            }
        }
    }
}

int main() {
    // åˆå§‹åŒ–ç½‘æ ¼ä¸ç¼–å·
    for (int i = 1; i <= n; i++)
        for (int j = 1; j <= m; j++) {
            cin >> grid[i][j];
            idx[i][j] = ++cnt;
            if (grid[i][j] == 3) start = idx[i][j];
            if (grid[i][j] == 4) target = idx[i][j];
        }
    
    // é¢„å¤„ç†å»ºå›¾
    for (int i = 1; i <= n; i++)
        for (int j = 1; j <= m; j++)
            if (grid[i][j] == 0 || grid[i][j] == 3) {
                bool vis[N][N] = {false};
                dfs(idx[i][j], i, j, vis);
            }
    
    // SPFAæœ€çŸ­è·¯è®¡æ•°
    spfa();
    
    if (dist[target] == 0x3f3f3f3f) cout << "-1";
    else cout << dist[target] - 1 << '\n' << counts[target];
    return 0;
}
```
* **ä»£ç è§£è¯»æ¦‚è¦**ï¼š
  1. **ç½‘æ ¼åˆå§‹åŒ–**ï¼šè¯»å–ç½‘æ ¼æ•°æ®å¹¶å»ºç«‹ä¸€ç»´ç´¢å¼•
  2. **DFSé¢„å¤„ç†**ï¼šå¯¹æ¸…æ°´(`0`)å’Œèµ·ç‚¹(`3`)æ‰§è¡ŒDFSï¼Œç©¿é€è²èŠ±ç¾¤(`1`)è¿æ¥æœ‰æ•ˆç‚¹
  3. **SPFAæ ¸å¿ƒ**ï¼šæ ‡å‡†é˜Ÿåˆ—å®ç°ï¼ŒåŒ…å«è·¯å¾„ç›¸ç­‰æ—¶çš„è®¡æ•°ç´¯åŠ é€»è¾‘
  4. **ç»“æœè¾“å‡º**ï¼šç»ˆç‚¹è·ç¦»å‡1ï¼ˆèµ·ç‚¹æœªæ”¾ç½®ï¼‰ï¼Œè¾“å‡ºæ–¹æ¡ˆæ•°

---
<code_intro_selected>
ç²¾é€‰é¢˜è§£æ ¸å¿ƒç‰‡æ®µèµæï¼š
</code_intro_selected>

**é¢˜è§£ä¸€ï¼ˆD_14134ï¼‰**
* **äº®ç‚¹**ï¼šDFSé€’å½’ç©¿é€è²èŠ±ç¾¤ï¼Œç®€æ´é«˜æ•ˆ
* **æ ¸å¿ƒä»£ç ç‰‡æ®µ**ï¼š
```cpp
void dfs(int o, int x, int y) {
    b[x][y] = 1;
    for (int k = 0; k < 8; k++) {
        int xx = x + dx[k], yy = y + dy[k];
        if (è¾¹ç•Œæ£€æŸ¥) continue;
        if (grid[xx][yy] == 1) dfs(o, xx, yy); // é€’å½’ç©¿é€
        else b[xx][yy] = 1, adde(o, idx[xx][yy]); // è¿æ¥ç›®æ ‡
    }
}
```
* **ä»£ç è§£è¯»**ï¼š`o`å§‹ç»ˆä¿æŒåŸç‚¹ç¼–å·ï¼Œå®ç°"ä»å“ªæ¥åˆ°å“ªå»"çš„æ˜ å°„ã€‚å½“é‡åˆ°è²èŠ±(`1`)æ—¶é€’å½’æ·±å…¥ï¼Œé‡åˆ°æœ‰æ•ˆç‚¹(`0/4`)æ—¶å»ºç«‹ä»åŸç‚¹`o`åˆ°è¯¥ç‚¹çš„è¾¹ã€‚`b`æ•°ç»„åŒæ—¶é˜²é‡å’Œæ ‡è®°å·²è¿è¾¹ã€‚
* ğŸ’¡ **å­¦ä¹ ç¬”è®°**ï¼šDFSå‚æ•°`o`çš„è®¾è®¡å®ç°äº†è·¨å±‚åŸç‚¹è®°å¿†

**é¢˜è§£äºŒï¼ˆs_Shotáƒ¦Makiï¼‰**
* **äº®ç‚¹**ï¼šç‹¬ç«‹`used`æ•°ç»„å®ç°DFSçŠ¶æ€éš”ç¦»
* **æ ¸å¿ƒä»£ç ç‰‡æ®µ**ï¼š
```cpp
void build_map(int num, int x, int y) {
    if (used[x][y]) return;
    used[x][y] = true;
    for (int k = 0; k < 8; k++) {
        int nx = x + dx[k], ny = y + dy[k];
        if (grid[nx][ny] == 1) build_map(num, nx, ny);
        else if (grid[nx][ny] != 2) {
            used[nx][ny] = true; 
            add(num, idx[nx][ny]); // å»ºè¾¹
        }
    }
}
```
* **ä»£ç è§£è¯»**ï¼šæ¯æ¬¡è°ƒç”¨å‰é‡ç½®`used`æ•°ç»„ï¼Œä¿è¯çŠ¶æ€ç‹¬ç«‹æ€§ã€‚é€’å½’æ—¶æºå¸¦åŸç‚¹ç¼–å·`num`ï¼Œé‡åˆ°éå²©çŸ³æœ‰æ•ˆç‚¹æ—¶å»ºè¾¹ã€‚`used`ç¡®ä¿ä¸é‡å¤è®¿é—®åŒä¸€ä½ç½®ã€‚
* ğŸ’¡ **å­¦ä¹ ç¬”è®°**ï¼šæ¯è½®DFSå‰é‡ç½®`used`æ•°ç»„æ˜¯çŠ¶æ€éš”ç¦»çš„å…³é”®

**é¢˜è§£ä¸‰ï¼ˆé¡¾zï¼‰**
* **äº®ç‚¹**ï¼šå›¾ç¤ºåŒ–åæ ‡è½¬æ¢å…¬å¼
* **æ ¸å¿ƒä»£ç ç‰‡æ®µ**ï¼š
```cpp
for (int i = 1; i <= n; i++)
    for (int j = 1; j <= m; j++)
        idx[i][j] = (i - 1) * m + j; // ç½‘æ ¼è½¬ä¸€ç»´

void dfs(int id, int x, int y) {
    if (vis[x][y]) return;
    vis[x][y] = true;
    for (int k = 0; k < 8; k++) {
        int nx = x + ax[k], ny = y + ay[k];
        if (grid[nx][ny] == 1) dfs(id, nx, ny);
        else if (grid[nx][ny] != 2) {
            vis[nx][ny] = true;
            add(id, idx[nx][ny]); // æ·»åŠ è¾¹
        }
    }
}
```
* **ä»£ç è§£è¯»**ï¼šæ¸…æ™°çš„äºŒç»´è½¬ä¸€ç»´å…¬å¼`(i-1)*m+j`æ˜¯ç½‘æ ¼é—®é¢˜é€šç”¨æŠ€å·§ã€‚DFSä¸­`id`ä¿æŒåŸç‚¹ï¼Œé‡åˆ°æœ‰æ•ˆç‚¹æ—¶æ·»åŠ ä»`id`åˆ°ç›®æ ‡ç´¢å¼•çš„è¾¹ã€‚
* ğŸ’¡ **å­¦ä¹ ç¬”è®°**ï¼šç½‘æ ¼ç¼–å·å…¬å¼å¯å®ç°O(1)ç»´åº¦è½¬æ¢

-----

## 5. ç®—æ³•å¯è§†åŒ–ï¼šåƒç´ åŠ¨ç”»æ¼”ç¤º (æ ¸å¿ƒéƒ¨åˆ†)

<visualization_intro>
æˆ‘ä»¬è®¾è®¡ã€Œéª‘å£«çš„è²èŠ±å†’é™©ã€åƒç´ åŠ¨ç”»æ¼”ç¤ºSPFA+DFSç®—æ³•æµç¨‹ï¼Œé‡‡ç”¨FCçº¢ç™½æœºé£æ ¼ï¼š
</visualization_intro>

* **ä¸»é¢˜**ï¼šéª‘å£«åœ¨30Ã—30åƒç´ æ± å¡˜ä¸­æ”¾ç½®è²èŠ±åˆ°è¾¾ç»ˆç‚¹
* **æ ¸å¿ƒæ¼”ç¤º**ï¼šDFSé¢„å¤„ç†è¿é€šå— + SPFAæœ€çŸ­è·¯å¾„æ‰©å±•

* **åƒç´ é£æ ¼è®¾è®¡**ï¼š
  - æ± å¡˜ç½‘æ ¼ï¼š16è‰²åƒç´ å—ï¼ˆæ°´=æµ…è“/è²èŠ±=é»„/å²©çŸ³=ç°/èµ·ç‚¹=ç»¿/ç»ˆç‚¹=çº¢ï¼‰
  - éª‘å£«å½¢è±¡ï¼š8Ã—8åƒç´ éª‘å£«ï¼ˆç§»åŠ¨æ—¶æ˜¾ç¤ºé©¬æ­¥åŠ¨ç”»ï¼‰
  - æ§åˆ¶é¢æ¿ï¼šå³ä¸‹è§’å«æ­¥è¿›/æš‚åœ/è°ƒé€Ÿæ»‘å—

* **åŠ¨ç”»å¸§åºåˆ—**ï¼š
  1. **DFSé¢„å¤„ç†é˜¶æ®µ**ï¼ˆè§¦å‘éŸ³æ•ˆï¼šæ°´æ»´å£°ï¼‰
     - ä»èµ·ç‚¹/æ¸…æ°´ç‚¹æ‰©æ•£è“è‰²æ³¢çº¹
     - é‡åˆ°è²èŠ±æ—¶æ˜¾ç¤ºç»¿è‰²è¿é€šå—æ‰«æåŠ¨ç”»
     - å»ºç«‹æ–°è¿æ¥æ—¶æ˜¾ç¤ºé»„è‰²è¿çº¿å¹¶æ’­æ”¾"å®"å£°
  2. **SPFAæ‰§è¡Œé˜¶æ®µ**ï¼ˆè§¦å‘éŸ³æ•ˆï¼šé©¬è¹„å£°ï¼‰
     - é˜Ÿåˆ—å¯è§†åŒ–ï¼šåº•éƒ¨æ˜¾ç¤ºé˜Ÿåˆ—èŠ‚ç‚¹ç¼–å·æµ
     - å½“å‰èŠ‚ç‚¹é«˜äº®é—ªçƒï¼ˆçº¢è‰²è¾¹æ¡†ï¼‰
     - è·ç¦»æ›´æ–°ï¼šå³ä¾§é¢æ¿å®æ—¶æ˜¾ç¤ºdistæ•°ç»„å˜åŒ–
     - æ–¹æ¡ˆæ•°æ›´æ–°ï¼šcountsæ•°ç»„åŒæ­¥æ˜¾ç¤º
  3. **ç»ˆç‚¹åˆ°è¾¾**ï¼ˆè§¦å‘éŸ³æ•ˆï¼šèƒœåˆ©å·è§’ï¼‰
     - æ˜¾ç¤ºè²èŠ±æ”¾ç½®è·¯å¾„ï¼ˆé«˜äº®é»„è‰²è·¯å¾„ï¼‰
     - å¼¹å‡ºç»“æœé¢æ¿ï¼š`æœ€å°è²èŠ±æ•° = X, æ–¹æ¡ˆæ•° = Y`

* **æ¸¸æˆåŒ–äº¤äº’**ï¼š
  - **AIæ¼”ç¤ºæ¨¡å¼**ï¼šè‡ªåŠ¨æ’­æ”¾å…¨è¿‡ç¨‹ï¼ˆé€Ÿåº¦å¯è°ƒï¼‰
  - **å…³å¡è®¾è®¡**ï¼šå°†ç®—æ³•åˆ†ä¸º"è¿é€šå—æ‰«æ"ï¼ˆå…³å¡1ï¼‰å’Œ"è·¯å¾„æ¢ç´¢"ï¼ˆå…³å¡2ï¼‰
  - **éŸ³æ•ˆç³»ç»Ÿ**ï¼š
    - é”®æ“ä½œï¼šæ¸…è„†æŒ‰é”®å£°ï¼ˆWeb Audio APIï¼‰
    - é”™è¯¯/æ— è§£ï¼šä½æ²‰è­¦ç¤ºéŸ³
    - èƒŒæ™¯éŸ³ä¹ï¼š8-bitå¾ªç¯æ—‹å¾‹

* **æŠ€æœ¯å®ç°**ï¼š
  ```javascript
  // ä¼ªä»£ç ï¼šç»˜åˆ¶å…³é”®å¸§
  function drawSPFAStep() {
      clearCanvas();
      drawGrid(); // ç»˜åˆ¶æ± å¡˜ç½‘æ ¼
      drawQueue(); // ç»˜åˆ¶å½“å‰é˜Ÿåˆ—
      highlightCurrentNode(); // çº¢è‰²é—ªçƒå½“å‰èŠ‚ç‚¹
      updateDistPanel(); // æ›´æ–°å³ä¾§æ•°æ®é¢æ¿
      if (reachedTarget) playVictorySound();
  }
  ```

---

## 6. æ‹“å±•ç»ƒä¹ ä¸ç›¸ä¼¼é—®é¢˜æ€è€ƒ

<similar_problems_intro>
æŒæ¡å»ºå›¾æŠ€å·§å’Œæœ€çŸ­è·¯è®¡æ•°åï¼Œå¯æŒ‘æˆ˜ä»¥ä¸‹é—®é¢˜ï¼š
</similar_problems_intro>

* **é€šç”¨æŠ€å·§è¿ç§»**ï¼š
  1. **å…è´¹é€šé“å‹ç¼©** â†’ P1514 å¼•æ°´å…¥åŸï¼ˆé¢„å¤„ç†+æœ€çŸ­è·¯ï¼‰
  2. **ç½‘æ ¼çŠ¶æ€è½¬åŒ–** â†’ P1073 æœ€ä¼˜è´¸æ˜“ï¼ˆåˆ†å±‚å›¾è½¬åŒ–ï¼‰
  3. **æœ€çŸ­è·¯è®¡æ•°** â†’ P1144 æœ€çŸ­è·¯è®¡æ•°ï¼ˆåŸºç¡€åº”ç”¨ï¼‰

* **æ´›è°·ç»ƒä¹ æ¨è**ï¼š
  1. **P1144 æœ€çŸ­è·¯è®¡æ•°**  
     ğŸ—£ï¸ æœ€çŸ­è·¯è®¡æ•°å…¥é—¨é¢˜ï¼Œå·©å›ºæ–¹æ¡ˆæ•°ç´¯åŠ é€»è¾‘
  2. **P1608 è·¯å¾„ç»Ÿè®¡**  
     ğŸ—£ï¸ å¸¦è¾¹æƒçš„æœ€çŸ­è·¯è®¡æ•°ï¼Œå­¦ä¹ å †ä¼˜åŒ–Dijkstra
  3. **P1979 åå®¹é“**  
     ğŸ—£ï¸ å¤æ‚çŠ¶æ€å»ºå›¾ï¼Œæå‡å¤šç»´é—®é¢˜è½¬åŒ–èƒ½åŠ›

---

## 7. å­¦ä¹ å¿ƒå¾—ä¸ç»éªŒåˆ†äº«

<insights_intro>
é¢˜è§£ä¸­å¤šä½ä½œè€…å¼ºè°ƒå…³é”®ç»éªŒï¼š
</insights_intro>

> **ç»éªŒ1ï¼ˆD_14134ï¼‰**ï¼š  
> â€œé¿å…æœ‰ç¯çš„å…³é”®æ˜¯DFSé¢„å¤„ç†ç©¿é€è²èŠ±ç¾¤ï¼Œç›´æ¥è¿æ¥æœ‰æ•ˆç›®æ ‡ç‚¹â€  
> **Kayç‚¹è¯„**ï¼šè¿™æ˜¯å¤„ç†å…è´¹é€šé“çš„é€šç”¨æŠ€å·§ï¼Œç±»ä¼¼é—®é¢˜å¦‚ç”µæ¢¯åœé ï¼ˆP1347ï¼‰ä¹Ÿå¯åº”ç”¨  

> **ç»éªŒ2ï¼ˆs_Shotáƒ¦Makiï¼‰**ï¼š  
> â€œæœ€çŸ­è·¯è®¡æ•°å¿…é¡»ç”¨long longï¼æˆ‘è¢«intå¡äº†3æ¬¡æäº¤â€  
> **Kayç‚¹è¯„**ï¼šæ–¹æ¡ˆæ•°æŒ‡æ•°å¢é•¿æ˜¯å¸¸è§é™·é˜±ï¼Œå¤§æ•°ç»„è®¡æ•°é—®é¢˜ä¼˜å…ˆè€ƒè™‘long long  

> **ç»éªŒ3ï¼ˆé¡¾zï¼‰**ï¼š  
> â€œç½‘æ ¼ç¼–å·(i-1)*m+jæ˜¯äºŒç»´è½¬ä¸€ç»´çš„é»„é‡‘å…¬å¼â€  
> **Kayç‚¹è¯„**ï¼šè¯¥æŠ€å·§é€‚ç”¨äºæ‰€æœ‰ç½‘æ ¼DFS/BFSé—®é¢˜ï¼Œå¯å¤§å¹…ç®€åŒ–ä»£ç   

---

<conclusion>
æœ¬æ¬¡åˆ†æå±•ç¤ºäº†å¦‚ä½•å°†å¤æ‚ç½‘æ ¼è·¯å¾„é—®é¢˜è½¬åŒ–ä¸ºå›¾è®ºæ¨¡å‹ã€‚å…³é”®åœ¨äºé¢„å¤„ç†å‹ç¼©çŠ¶æ€å’Œç²¾å‡†å®ç°æœ€çŸ­è·¯è®¡æ•°ã€‚å¤šç»ƒä¹ å»ºå›¾æŠ€å·§ï¼Œä½ å°†åœ¨å›¾è®ºä¸–ç•Œä¸­æ¸¸åˆƒæœ‰ä½™ï¼ä¸‹æ¬¡æˆ‘ä»¬æ¢ç´¢æ›´å¤æ‚çš„åŠ¨æ€è§„åˆ’å»ºæ¨¡æŠ€å·§ï¼Œç»§ç»­åŠ æ²¹ï¼ğŸ’ª
</conclusion>
```

---
å¤„ç†ç”¨æ—¶ï¼š216.48ç§’
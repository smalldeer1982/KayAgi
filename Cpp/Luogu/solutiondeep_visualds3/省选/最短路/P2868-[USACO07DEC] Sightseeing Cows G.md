# é¢˜ç›®ä¿¡æ¯

# [USACO07DEC] Sightseeing Cows G

## é¢˜ç›®æè¿°

å†œå¤«çº¦ç¿°å†³å®šå¥–åŠ±ä»–çš„å¥¶ç‰›ä»¬çš„è¾›å‹¤å·¥ä½œï¼Œå¸¦å®ƒä»¬å»å¤§åŸå¸‚æ¸¸è§ˆï¼å¥¶ç‰›ä»¬å¿…é¡»å†³å®šå¦‚ä½•æœ€å¥½åœ°åº¦è¿‡å®ƒä»¬çš„ç©ºé—²æ—¶é—´ã€‚

å¹¸è¿çš„æ˜¯ï¼Œå®ƒä»¬æœ‰ä¸€å¼ è¯¦ç»†çš„åŸå¸‚åœ°å›¾ï¼Œæ˜¾ç¤ºäº† $L$ $(2 \leq L \leq 1000)$ ä¸ªä¸»è¦åœ°æ ‡ï¼ˆæ–¹ä¾¿åœ°ç¼–å·ä¸º $1$ åˆ° $L$ï¼‰å’Œ $P$ $(2 \leq P \leq 5000)$ æ¡è¿æ¥è¿™äº›åœ°æ ‡çš„å•å‘ç‰›é“ã€‚å†œå¤«çº¦ç¿°ä¼šæŠŠå¥¶ç‰›ä»¬é€åˆ°å®ƒä»¬é€‰æ‹©çš„ä¸€ä¸ªèµ·å§‹åœ°æ ‡ï¼Œä»é‚£é‡Œå®ƒä»¬å°†æ²¿ç€ç‰›é“èµ°åˆ°ä¸€ç³»åˆ—å…¶ä»–åœ°æ ‡ï¼Œæœ€åå›åˆ°å®ƒä»¬çš„èµ·å§‹åœ°æ ‡ï¼Œå†œå¤«çº¦ç¿°ä¼šåœ¨é‚£é‡Œæ¥å®ƒä»¬å›å†œåœºã€‚ç”±äºåŸå¸‚ç©ºé—´æœ‰é™ï¼Œç‰›é“éå¸¸ç‹­çª„ï¼Œå› æ­¤æ¯æ¡ç‰›é“çš„æ—…è¡Œåªèƒ½æ²¿ç€ä¸€ä¸ªå›ºå®šæ–¹å‘è¿›è¡Œã€‚

è™½ç„¶å¥¶ç‰›ä»¬å¯ä»¥åœ¨åŸå¸‚é‡Œå¾…å¤šä¹…éƒ½è¡Œï¼Œä½†å®ƒä»¬å¾ˆå®¹æ˜“æ„Ÿåˆ°æ— èŠã€‚å‚è§‚æ¯ä¸ªæ–°çš„åœ°æ ‡å¾ˆæœ‰è¶£ï¼Œä½†åœ¨å®ƒä»¬ä¹‹é—´è¡Œèµ°éœ€è¦æ—¶é—´ã€‚å¥¶ç‰›ä»¬çŸ¥é“æ¯ä¸ªåœ°æ ‡ $i$ çš„ç¡®åˆ‡ä¹è¶£å€¼ $F_i$ $(1 \leq F_i \leq 1000)$ã€‚

å¥¶ç‰›ä»¬è¿˜äº†è§£ç‰›é“ã€‚ç‰›é“ $i$ è¿æ¥åœ°æ ‡ $L1_i$ åˆ° $L2_i$ï¼ˆæ–¹å‘ä¸º $L1_i \to L2_i$ï¼‰ï¼Œéœ€è¦æ—¶é—´ $T_i$ $(1 \leq T_i \leq 1000)$ æ¥ç©¿è¶Šã€‚

ä¸ºäº†åº¦è¿‡ä¸€ä¸ªæœ€å¥½çš„å‡æœŸï¼Œå¥¶ç‰›ä»¬å¸Œæœ›æœ€å¤§åŒ–å®ƒä»¬æ—…è¡Œçš„å•ä½æ—¶é—´å¹³å‡ä¹è¶£å€¼ã€‚å½“ç„¶ï¼Œåœ°æ ‡åªæœ‰åœ¨ç¬¬ä¸€æ¬¡è®¿é—®æ—¶æ‰æœ‰è¶£ï¼›å¥¶ç‰›ä»¬å¯ä»¥å¤šæ¬¡ç»è¿‡åœ°æ ‡ï¼Œä½†å®ƒä»¬ä¸ä¼šå†æ¬¡æ„Ÿå—åˆ°å®ƒçš„ä¹è¶£å€¼ã€‚æ­¤å¤–ï¼Œå†œå¤«çº¦ç¿°è¦æ±‚å¥¶ç‰›ä»¬è‡³å°‘è®¿é—®ä¸¤ä¸ªåœ°æ ‡ï¼Œä»¥ä¾¿åœ¨å‡æœŸä¸­å¾—åˆ°ä¸€äº›é”»ç‚¼ã€‚

å¸®åŠ©å¥¶ç‰›ä»¬æ‰¾åˆ°å®ƒä»¬èƒ½å¤Ÿå®ç°çš„æœ€å¤§å•ä½æ—¶é—´ä¹è¶£å€¼ã€‚

## è¯´æ˜/æç¤º

ï¼ˆç”± ChatGPT 4o ç¿»è¯‘ï¼‰

## æ ·ä¾‹ #1

### è¾“å…¥

```
5 7
30
10
10
5
10
1 2 3
2 3 2
3 4 5
3 5 2
4 5 5
5 1 3
5 2 2```

### è¾“å‡º

```
6.00```

# AIåˆ†æç»“æœ


### ğŸ’¡ Kayçš„C++ç®—æ³•è§£æï¼šSightseeing Cows G æ·±å…¥å­¦ä¹ æŒ‡å— ğŸ’¡

#### 1. é¢˜ç›®è§£è¯»ä¸æ ¸å¿ƒç®—æ³•è¯†åˆ«
âœ¨ **æœ¬é¢˜ä¸»è¦è€ƒå¯Ÿ**ï¼š`0/1åˆ†æ•°è§„åˆ’`ï¼ˆæœ€ä¼˜æ¯”ç‡ç¯ï¼‰

ğŸ—£ï¸ **åˆæ­¥åˆ†æ**ï¼š
> è§£å†³æœ¬é¢˜çš„å…³é”®æ˜¯**0/1åˆ†æ•°è§„åˆ’**ç®—æ³•ã€‚æƒ³è±¡å¥¶ç‰›åœ¨æ¸¸ä¹å›­é€‰è·¯çº¿ï¼Œæˆ‘ä»¬é€šè¿‡è°ƒæ•´"é—¨ç¥¨ä»·æ ¼"ï¼ˆmidå€¼ï¼‰æµ‹è¯•å“ªæ¡è·¯çº¿"æ€§ä»·æ¯”"æœ€é«˜ï¼ˆå•ä½æ—¶é—´ä¹è¶£å€¼æœ€å¤§ï¼‰ã€‚åœ¨äºŒåˆ†è¿‡ç¨‹ä¸­ï¼š
> - å°†è¾¹æƒè½¬åŒ–ä¸º`mid Ã— æ—¶é—´ - ä¹è¶£å€¼`ï¼Œé—®é¢˜è½¬åŒ–ä¸ºè´Ÿç¯æ£€æµ‹
> - è‹¥å­˜åœ¨è´Ÿç¯è¯´æ˜å½“å‰midåå°ï¼Œå¯å¢å¤§
> - å¯è§†åŒ–è®¾è®¡ï¼šåƒç´ é£æ ¼æ¸¸ä¹å›­åœ°å›¾ï¼ˆåœ°æ ‡=å½©è‰²æ–¹å—ï¼Œé“è·¯=è¿çº¿ï¼‰ï¼ŒåŠ¨ç”»å±•ç¤ºäºŒåˆ†è¿‡ç¨‹ï¼ˆå®æ—¶æ˜¾ç¤ºmidå€¼ã€è¾¹æƒè®¡ç®—å…¬å¼ï¼‰ï¼ŒSPFAéå†æ—¶é«˜äº®å½“å‰èŠ‚ç‚¹å’Œè¾¹ï¼Œæ£€æµ‹åˆ°è´Ÿç¯æ—¶è§¦å‘è­¦æŠ¥éŸ³æ•ˆå’Œé—ªçƒåŠ¨ç”»

---

#### 2. ç²¾é€‰ä¼˜è´¨é¢˜è§£å‚è€ƒ
**é¢˜è§£ä¸€ï¼ˆæœ¨æœ¨ï¼ï¼‰**
* **ç‚¹è¯„**ï¼šä¸¥è°¨è¯æ˜ç¯ä¸­ç‚¹ä¸é‡å¤ï¼ˆæ ¸å¿ƒè´¡çŒ®ï¼‰ï¼Œä»£ç è§„èŒƒï¼ˆstackå®ç°SPFAé¿å…é˜Ÿåˆ—æº¢å‡ºï¼‰ï¼Œè¾¹ç•Œå¤„ç†å®Œå–„ï¼ˆå¦‚ç²¾åº¦æ§åˆ¶ï¼‰ã€‚äº®ç‚¹åœ¨äºæ•°å­¦è¯æ˜å’Œç©ºé—´ä¼˜åŒ–ï¼Œå®è·µå¯ç›´æ¥ç”¨äºç«èµ›ã€‚

**é¢˜è§£äºŒï¼ˆniiickï¼‰**
* **ç‚¹è¯„**ï¼šæ¸…æ™°è§£é‡Š0/1è§„åˆ’åŸç†ï¼Œä»£ç ç»“æ„å·¥æ•´ï¼ˆæ ‡å‡†é˜Ÿåˆ—SPFAï¼‰ï¼Œå˜é‡å‘½ååˆç†ï¼ˆ`Fun`/`Tim`ï¼‰ã€‚äº®ç‚¹åœ¨äºé€šç”¨æ¨¡å‹æ€»ç»“å’Œå¯è¯»æ€§ï¼Œé€‚åˆåˆå­¦è€…ç†è§£ã€‚

**é¢˜è§£ä¸‰ï¼ˆfanfansannï¼‰**
* **ç‚¹è¯„**ï¼šåˆ›æ–°ä½¿ç”¨è·¯å¾„è¾¹æ•°åˆ¤è´Ÿç¯ï¼ˆ`cnt>n`å³å­˜åœ¨ï¼‰ï¼Œæ¯”ä¼ ç»Ÿå…¥é˜Ÿæ¬¡æ•°æ›´é«˜æ•ˆã€‚äº®ç‚¹åœ¨äºç®—æ³•ä¼˜åŒ–ï¼Œé€‚åˆå¤„ç†å¤§è§„æ¨¡æ•°æ®ã€‚

---

#### 3. æ ¸å¿ƒéš¾ç‚¹è¾¨æä¸è§£é¢˜ç­–ç•¥
1. **éš¾ç‚¹ï¼šå¦‚ä½•è½¬åŒ–æœ€å¤§åŒ–æ¯”ç‡é—®é¢˜ï¼Ÿ**
   - **åˆ†æ**ï¼šé€šè¿‡0/1åˆ†æ•°è§„åˆ’å°†éçº¿æ€§é—®é¢˜è½¬åŒ–ä¸ºçº¿æ€§åˆ¤å®šã€‚å…³é”®æ¨å¯¼ï¼š
     ```
     Î£ä¹è¶£å€¼/Î£æ—¶é—´ > mid â†’ Î£(midÃ—æ—¶é—´ - ä¹è¶£å€¼) < 0
     ```
   - ğŸ’¡ **å­¦ä¹ ç¬”è®°**ï¼šäºŒåˆ†ç­”æ¡ˆ+è´Ÿç¯åˆ¤å®šæ˜¯æ¯”ç‡ä¼˜åŒ–é—®é¢˜çš„é€šç”¨è§£æ³•

2. **éš¾ç‚¹ï¼šå¦‚ä½•é«˜æ•ˆæ£€æµ‹è´Ÿç¯ï¼Ÿ**
   - **åˆ†æ**ï¼šDFS-SPFAå¿«é€Ÿæ·±åº¦æœç´¢ï¼ˆæœ¨æœ¨ï¼ï¼‰ï¼ŒBFS-SPFAç”¨`cnt`è®°å½•æ¾å¼›æ¬¡æ•°ï¼ˆfanfansannï¼‰ã€‚æ¨èDFSå°å›¾ï¼ŒBFSå¤§å›¾
   - ğŸ’¡ **å­¦ä¹ ç¬”è®°**ï¼šè´Ÿç¯æ£€æµ‹æ•ˆç‡å†³å®šç®—æ³•æ€§èƒ½ï¼ŒDFSå¹³å‡æ›´å¿«ä½†éœ€é˜²æ ˆæº¢å‡º

3. **éš¾ç‚¹ï¼šå¦‚ä½•å¤„ç†éè¿é€šå›¾ï¼Ÿ**
   - **åˆ†æ**ï¼šåˆå§‹åŒ–æ—¶å°†æ‰€æœ‰èŠ‚ç‚¹å…¥é˜Ÿï¼ˆniiickï¼‰ï¼Œç¡®ä¿è¦†ç›–å…¨å›¾
   - ğŸ’¡ **å­¦ä¹ ç¬”è®°**ï¼šå¤šæºç‚¹SPFAæ˜¯å¤„ç†éè¿é€šå›¾çš„æ ‡é…æŠ€å·§

âœ¨ **è§£é¢˜æŠ€å·§æ€»ç»“**
- **é—®é¢˜è½¬åŒ–æŠ€å·§**ï¼šå¤æ‚æ¯”ç‡é—®é¢˜ â†’ äºŒåˆ†åˆ¤å®šé—®é¢˜
- **æ•°æ®ç»“æ„é€‰æ‹©**ï¼šé‚»æ¥è¡¨å­˜å›¾ï¼ˆè¾¹æ•°>5000æ—¶ä¼˜äºçŸ©é˜µï¼‰
- **ç²¾åº¦æ§åˆ¶**ï¼šäºŒåˆ†ç»ˆæ­¢æ¡ä»¶è®¾ä¸º`r-l>1e-4`ï¼ˆé¿å…æµ®ç‚¹è¯¯å·®ï¼‰
- **è°ƒè¯•æŠ€å·§**ï¼šæ‰“å°ä¸­é—´å˜é‡ï¼ˆå¦‚è´Ÿç¯èŠ‚ç‚¹ï¼‰è¾…åŠ©å®šä½

---

#### 4. C++æ ¸å¿ƒä»£ç å®ç°èµæ
```cpp
#include <iostream>
#include <vector>
#include <queue>
#include <cstdio>
using namespace std;
const double eps = 1e-4;

struct Edge { int v, w; };
vector<vector<Edge>> graph;
vector<int> fun;
vector<double> dist;
vector<int> count;

bool hasNegativeCycle(int n, double mid) {
    queue<int> q;
    for (int i = 1; i <= n; ++i) {
        dist[i] = 0;
        count[i] = 0;
        q.push(i);
    }
    while (!q.empty()) {
        int u = q.front(); q.pop();
        for (auto& e : graph[u]) {
            double newDist = dist[u] + mid * e.w - fun[u];
            if (newDist < dist[e.v]) {
                dist[e.v] = newDist;
                if (++count[e.v] >= n) return true;
                q.push(e.v);
            }
        }
    }
    return false;
}

int main() {
    int n, m; 
    cin >> n >> m;
    graph.resize(n+1);
    fun.resize(n+1);
    dist.resize(n+1);
    count.resize(n+1);

    for (int i = 1; i <= n; ++i) cin >> fun[i];
    while (m--) {
        int u, v, w;
        cin >> u >> v >> w;
        graph[u].push_back({v, w});
    }

    double l = 0, r = 1000;
    while (r - l > eps) {
        double mid = (l + r) / 2;
        if (hasNegativeCycle(n, mid)) l = mid;
        else r = mid;
    }
    printf("%.2f\n", l);
}
```
**ä»£ç è§£è¯»æ¦‚è¦**ï¼š
1. å›¾å­˜å‚¨ï¼šé‚»æ¥è¡¨`graph`å­˜è¾¹ï¼ˆç›®æ ‡èŠ‚ç‚¹+è¾¹æƒï¼‰
2. è´Ÿç¯æ£€æµ‹ï¼šå¤šæºç‚¹BFS-SPFAï¼Œ`count`è®°å½•æ¾å¼›æ¬¡æ•°
3. äºŒåˆ†æ¡†æ¶ï¼šç²¾åº¦æ§åˆ¶`1e-4`ï¼Œæ¯æ¬¡checké‡è®¾è·ç¦»æ•°ç»„

---

#### 5. ç®—æ³•å¯è§†åŒ–ï¼šåƒç´ åŠ¨ç”»æ¼”ç¤º
![åƒç´ æ¸¸ä¹å›­ç®—æ³•æ¼”ç¤º](https://example.com/pixel-park.gif)  
* **ä¸»é¢˜**ï¼š8-bité£æ ¼æ¸¸ä¹å›­ï¼ˆåœ°æ ‡=ä¸åŒé¢œè‰²æ–¹å—ï¼Œé“è·¯=å‘å…‰è¿çº¿ï¼‰
* **æ ¸å¿ƒäº¤äº’**ï¼š
  1. **æ§åˆ¶é¢æ¿**ï¼šæ»‘å—è°ƒèŠ‚midå€¼ï¼ŒæŒ‰é’®æ§åˆ¶å•æ­¥/è‡ªåŠ¨æ’­æ”¾
  2. **åŠ¨æ€æ•ˆæœ**ï¼š
     - è¾¹æƒå®æ—¶æ˜¾ç¤ºå…¬å¼ï¼š`midÃ—æ—¶é—´-ä¹è¶£å€¼`
     - SPFAéå†æ—¶ï¼šå½“å‰èŠ‚ç‚¹é—ªçƒé»„è‰²ï¼Œæ£€æŸ¥è¾¹é«˜äº®ç»¿è‰²/çº¢è‰²ï¼ˆæ­£/è´Ÿæƒï¼‰
     - è´Ÿç¯æ£€æµ‹ï¼šå¾ªç¯èŠ‚ç‚¹è„‰å†²çº¢å…‰ï¼Œæ’­æ”¾"è­¦æŠ¥"éŸ³æ•ˆ
  3. **çŠ¶æ€æ˜¾ç¤º**ï¼šå½“å‰äºŒåˆ†åŒºé—´[l, r]ï¼Œå·²æ£€æµ‹è½®æ¬¡
* **éŸ³æ•ˆè®¾è®¡**ï¼š
  - æ¾å¼›æˆåŠŸï¼šæ¸…è„†"å®"å£°
  - è´Ÿç¯æ£€æµ‹ï¼šçŸ­ä¿ƒè­¦æŠ¥å£°
  - äºŒåˆ†æ›´æ–°ï¼šç”µå­åˆæˆéŸ³æç¤ºæ–°åŒºé—´

---

#### 6. æ‹“å±•ç»ƒä¹ ä¸ç›¸ä¼¼é—®é¢˜
1. **é€šç”¨æŠ€å·§è¿ç§»**ï¼š
   - æœ€ä¼˜æ¯”ç‡ç”Ÿæˆæ ‘ï¼ˆP4951ï¼‰
   - æœ€å°å¯†åº¦è·¯å¾„ï¼ˆP1730ï¼‰
   - èµ„æºåˆ†é…ç±»é—®é¢˜ï¼ˆå¦‚P3199ï¼‰

2. **æ´›è°·æ¨è**ï¼š
   - **P2868** [USACO07DEC]ï¼šåŒç±»é¢˜å·©å›º
   - **P1768** æœ€å°å¯†åº¦è·¯å¾„ï¼šåˆ†æ•°è§„åˆ’å˜å½¢
   - **P3199** [HNOI2009]ï¼šå¸¦çº¦æŸçš„æ¯”ç‡ä¼˜åŒ–

---

#### 7. å­¦ä¹ å¿ƒå¾—ä¸ç»éªŒåˆ†äº«
> **å‚è€ƒç»éªŒ**ï¼š"æˆ‘åœ¨å¤„ç†è´Ÿç¯æ£€æµ‹æ—¶ï¼ŒDFS-SPFAåœ¨å°å›¾ä¸Šå¿«ä½†æ ˆæº¢å‡ºï¼Œæ”¹ç”¨BFS+`cnt`è®¡æ•°æ‰é€šè¿‡" â€”â€” æœ¨æœ¨ï¼
>
> **Kayç‚¹è¯„**ï¼šè°ƒè¯•æ—¶å…³æ³¨ä¸¤ç‚¹ï¼š
> 1. **ç®—æ³•é€‰æ‹©**ï¼šå›¾è§„æ¨¡>1000èŠ‚ç‚¹æ—¶ä¼˜å…ˆBFS
> 2. **ç²¾åº¦æ§åˆ¶**ï¼šæµ®ç‚¹äºŒåˆ†ç»ˆæ­¢æ¡ä»¶éœ€æµ‹è¯•éªŒè¯

---

é€šè¿‡æœ¬æ¬¡åˆ†æï¼Œæˆ‘ä»¬æŒæ¡äº†0/1åˆ†æ•°è§„åˆ’çš„æ ¸å¿ƒæ€æƒ³å’Œå®ç°è¦ç‚¹ã€‚è®°ä½ï¼šå°†å¤æ‚é—®é¢˜æ‹†è§£ä¸ºäºŒåˆ†åˆ¤å®š+å›¾ç®—æ³•ï¼Œæ˜¯ç«èµ›è§£é¢˜çš„é»„é‡‘æ³•åˆ™ï¼ä¸‹æ¬¡é‡åˆ°æ¯”ç‡æœ€ä¼˜åŒ–é—®é¢˜ï¼Œä¸å¦¨å°è¯•è¿™ä¸ªæ¡†æ¶ğŸ’ª

---
å¤„ç†ç”¨æ—¶ï¼š119.02ç§’
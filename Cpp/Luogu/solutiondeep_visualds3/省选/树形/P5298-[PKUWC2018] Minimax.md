# é¢˜ç›®ä¿¡æ¯

# [PKUWC2018] Minimax

## é¢˜ç›®æè¿°

å° $C$ æœ‰ä¸€æ£µ $n$ ä¸ªç»“ç‚¹çš„æœ‰æ ¹æ ‘ï¼Œæ ¹æ˜¯ $1$ å·ç»“ç‚¹ï¼Œä¸”æ¯ä¸ªç»“ç‚¹æœ€å¤šæœ‰ä¸¤ä¸ªå­ç»“ç‚¹ã€‚

å®šä¹‰ç»“ç‚¹ $x$ çš„æƒå€¼ä¸ºï¼š

1.è‹¥ $x$ æ²¡æœ‰å­ç»“ç‚¹ï¼Œé‚£ä¹ˆå®ƒçš„æƒå€¼ä¼šåœ¨è¾“å…¥é‡Œç»™å‡ºï¼Œ**ä¿è¯è¿™ç±»ç‚¹ä¸­æ¯ä¸ªç»“ç‚¹çš„æƒå€¼äº’ä¸ç›¸åŒ**ã€‚

2.è‹¥ $x$ æœ‰å­ç»“ç‚¹ï¼Œé‚£ä¹ˆå®ƒçš„æƒå€¼æœ‰ $p_x$ çš„æ¦‚ç‡æ˜¯å®ƒçš„å­ç»“ç‚¹çš„æƒå€¼çš„æœ€å¤§å€¼ï¼Œæœ‰ $1-p_x$ çš„æ¦‚ç‡æ˜¯å®ƒçš„å­ç»“ç‚¹çš„æƒå€¼çš„æœ€å°å€¼ã€‚

ç°åœ¨å° $C$ æƒ³çŸ¥é“ï¼Œå‡è®¾ $1$ å·ç»“ç‚¹çš„æƒå€¼æœ‰ $m$ ç§å¯èƒ½æ€§ï¼Œ**æƒå€¼ç¬¬ $i$ å°**çš„å¯èƒ½æ€§çš„æƒå€¼æ˜¯ $V_i$ï¼Œå®ƒçš„æ¦‚ç‡ä¸º $D_i(D_i>0)$ï¼Œæ±‚ï¼š

$$\sum_{i=1}^{m}i\cdot V_i\cdot D_i^2$$

ä½ éœ€è¦è¾“å‡ºç­”æ¡ˆå¯¹ $998244353$ å–æ¨¡çš„å€¼ã€‚


## è¯´æ˜/æç¤º


#### æ ·ä¾‹è§£é‡Š
1å·ç»“ç‚¹çš„æƒå€¼æœ‰ $\frac{1}{2}$ çš„æ¦‚ç‡æ˜¯ $1$ï¼Œæœ‰ $\frac{1}{2}$ çš„æ¦‚ç‡æ˜¯ $2$ï¼Œæ‰€ä»¥ç­”æ¡ˆæ˜¯ $\frac{5}{4}$ã€‚

#### æ•°æ®èŒƒå›´

- å¯¹äº $10\%$ çš„æ•°æ®ï¼Œæœ‰ $1\leq n\leq 20$ï¼›  
- å¯¹äº $20\%$ çš„æ•°æ®ï¼Œæœ‰ $1\leq n\leq 400$ï¼›  
- å¯¹äº $40\%$ çš„æ•°æ®ï¼Œæœ‰ $1\leq n\leq 5000$ï¼›  
- å¯¹äº $60\%$ çš„æ•°æ®ï¼Œæœ‰ $1\leq n\leq 10^5$ï¼›  
- å¦æœ‰ $10\%$ çš„æ•°æ®ä¿è¯æ ‘çš„å½¢æ€éšæœºï¼›  
- å¯¹äº $100\%$ çš„æ•°æ®ï¼Œæœ‰ $1\leq n\leq 3\times 10^5$ï¼Œ$1\leq w_i\leq 10^9$ã€‚

å¯¹äºæ‰€æœ‰æ•°æ®ï¼Œæ»¡è¶³ $0 < p_i \cdot 10000 < 10000$ï¼Œæ‰€ä»¥æ˜“è¯æ˜æ‰€æœ‰å¶å­çš„æƒå€¼éƒ½æœ‰æ¦‚ç‡è¢«æ ¹å–åˆ°ã€‚


## æ ·ä¾‹ #1

### è¾“å…¥

```
3
0 1 1
5000 1 2```

### è¾“å‡º

```
748683266```

# AIåˆ†æç»“æœ

# ğŸ’¡ Kayçš„C++ç®—æ³•è§£æï¼š[PKUWC2018] Minimax æ·±å…¥å­¦ä¹ æŒ‡å— ğŸ’¡


## 1. é¢˜ç›®è§£è¯»ä¸æ ¸å¿ƒç®—æ³•è¯†åˆ«

âœ¨ **æœ¬é¢˜ä¸»è¦è€ƒå¯Ÿ**ï¼šçº¿æ®µæ ‘åˆå¹¶ï¼ˆMerge Sort Tree Mergeï¼‰+ æ ‘å½¢DP


### ğŸ—£ï¸ åˆæ­¥åˆ†æ
æˆ‘ä»¬éœ€è¦è§£å†³çš„é—®é¢˜æ˜¯ï¼šä¸€æ£µäºŒå‰æ ‘ä¸­ï¼Œéå¶å­èŠ‚ç‚¹ä»¥ä¸€å®šæ¦‚ç‡å–å­èŠ‚ç‚¹çš„æœ€å¤§å€¼æˆ–æœ€å°å€¼ï¼Œæ±‚æ ¹èŠ‚ç‚¹æƒå€¼çš„åŠ æƒå’Œï¼ˆæ¶‰åŠæ¦‚ç‡å¹³æ–¹ï¼‰ã€‚å…³é”®åœ¨äº**è®¡ç®—æ¯ä¸ªå¶å­æƒå€¼æˆä¸ºæ ¹æƒå€¼çš„æ¦‚ç‡**ï¼Œå†ä»£å…¥å…¬å¼è®¡ç®—ã€‚

#### æ ¸å¿ƒç®—æ³•ï¼šçº¿æ®µæ ‘åˆå¹¶
çº¿æ®µæ ‘åˆå¹¶å°±åƒâ€œæ‹¼å›¾æ¸¸æˆâ€â€”â€”æŠŠä¸¤æ£µåŠ¨æ€å¼€ç‚¹çš„çº¿æ®µæ ‘ï¼ˆåˆ†åˆ«ç»´æŠ¤å·¦å³å­æ ‘çš„æƒå€¼æ¦‚ç‡ï¼‰åˆå¹¶æˆä¸€æ£µï¼ŒåŒæ—¶è®¡ç®—æ¯ä¸ªæƒå€¼çš„æ¦‚ç‡è½¬ç§»ã€‚**åŠ¨æ€å¼€ç‚¹**æ„å‘³ç€åªåˆ›å»ºéœ€è¦çš„èŠ‚ç‚¹ï¼ŒèŠ‚çœç©ºé—´ï¼›**åˆå¹¶æ—¶ç»´æŠ¤å‰ç¼€å’Œ/åç¼€å’Œ**ï¼Œå¿«é€Ÿè®¡ç®—â€œæ¯”å½“å‰æƒå€¼å°/å¤§çš„æ¦‚ç‡å’Œâ€ï¼Œä»è€Œå¤„ç†æ¦‚ç‡è½¬ç§»ã€‚

#### é¢˜è§£æ€è·¯ä¸éš¾ç‚¹
- **æ€è·¯**ï¼šç”¨çº¿æ®µæ ‘ç»´æŠ¤æ¯ä¸ªèŠ‚ç‚¹çš„æƒå€¼æ¦‚ç‡åˆ†å¸ƒï¼ˆ`f[x][v]`è¡¨ç¤ºèŠ‚ç‚¹`x`å–æƒå€¼`v`çš„æ¦‚ç‡ï¼‰ã€‚å¯¹äºéå¶å­èŠ‚ç‚¹ï¼Œåˆå¹¶å·¦å³å­æ ‘çš„çº¿æ®µæ ‘ï¼Œæ ¹æ®æ¦‚ç‡è½¬ç§»æ–¹ç¨‹æ›´æ–°æ¯ä¸ªæƒå€¼çš„æ¦‚ç‡ã€‚
- **æ ¸å¿ƒéš¾ç‚¹**ï¼š  
  1. æ¦‚ç‡è½¬ç§»æ–¹ç¨‹çš„æ¨å¯¼ï¼ˆéœ€è¦å‰ç¼€å’Œ/åç¼€å’Œï¼‰ï¼›  
  2. çº¿æ®µæ ‘åˆå¹¶æ—¶çš„ä¿¡æ¯ä¼ é€’ï¼ˆå¦‚ä½•ç»´æŠ¤å‰ç¼€å’Œ/åç¼€å’Œï¼‰ï¼›  
  3. ç¦»æ•£åŒ–å¤„ç†ï¼ˆå¶å­æƒå€¼èŒƒå›´å¤§ï¼Œéœ€æ˜ å°„åˆ°è¿ç»­ä¸‹æ ‡ï¼‰ã€‚
- **è§£å†³æ–¹æ¡ˆ**ï¼š  
  - è½¬ç§»æ–¹ç¨‹ï¼šå¯¹äºå·¦å­æ ‘çš„æƒå€¼`v`ï¼Œå…¶æ¦‚ç‡ä¸º`f[left][v] * (p*x * å³å­æ ‘å‰ç¼€å’Œ(v-1) + (1-p*x) * å³å­æ ‘åç¼€å’Œ(v+1))`ï¼Œå³å­æ ‘åŒç†ï¼›  
  - çº¿æ®µæ ‘åˆå¹¶æ—¶ï¼Œé€’å½’å¤„ç†å·¦å³å­èŠ‚ç‚¹ï¼Œç»´æŠ¤å½“å‰åŒºé—´çš„å‰ç¼€å’Œï¼ˆå·¦è¾¹æ‰€æœ‰æƒå€¼çš„æ¦‚ç‡å’Œï¼‰å’Œåç¼€å’Œï¼ˆå³è¾¹æ‰€æœ‰æƒå€¼çš„æ¦‚ç‡å’Œï¼‰ï¼›  
  - ç¦»æ•£åŒ–ï¼šå°†å¶å­æƒå€¼æ’åºï¼Œæ˜ å°„åˆ°1~mçš„è¿ç»­ä¸‹æ ‡ã€‚

#### å¯è§†åŒ–è®¾è®¡æ€è·¯
- **é£æ ¼**ï¼š8ä½åƒç´ é£ï¼ˆç±»ä¼¼FCæ¸¸æˆï¼‰ï¼Œç”¨ä¸åŒé¢œè‰²çš„åƒç´ å—è¡¨ç¤ºçº¿æ®µæ ‘èŠ‚ç‚¹ï¼ˆå·¦å­æ ‘è“è‰²ï¼Œå³å­æ ‘çº¢è‰²ï¼‰ï¼›  
- **æ ¸å¿ƒæ¼”ç¤º**ï¼š  
  - çº¿æ®µæ ‘åˆå¹¶è¿‡ç¨‹ï¼šä¸¤ä¸ªå­æ ‘çš„åƒç´ å—é€æ¸åˆå¹¶ï¼Œæ˜¾ç¤ºå‰ç¼€å’Œ/åç¼€å’Œçš„è®¡ç®—ï¼›  
  - æ¦‚ç‡æ›´æ–°ï¼šç”¨é—ªçƒæ•ˆæœæ ‡è®°å½“å‰å¤„ç†çš„æƒå€¼ï¼Œæ˜¾ç¤ºä¹˜æ³•æ ‡è®°çš„åº”ç”¨ï¼›  
  - æ ¹èŠ‚ç‚¹ç»“æœï¼šæœ€ç»ˆåˆå¹¶åçš„çº¿æ®µæ ‘æ˜¾ç¤ºæ¯ä¸ªæƒå€¼çš„æ¦‚ç‡ï¼Œç”¨æŸ±çŠ¶å›¾è¡¨ç¤ºæ¦‚ç‡å¤§å°ã€‚  
- **äº¤äº’**ï¼šæ”¯æŒå•æ­¥æ‰§è¡Œï¼ˆæŸ¥çœ‹æ¯ä¸€æ­¥åˆå¹¶ï¼‰ã€è‡ªåŠ¨æ’­æ”¾ï¼ˆå¿«é€Ÿæ¼”ç¤ºï¼‰ï¼Œç‚¹å‡»èŠ‚ç‚¹å¯æŸ¥çœ‹è¯¦ç»†ä¿¡æ¯ï¼ˆæ¦‚ç‡ã€å‰ç¼€å’Œ/åç¼€å’Œï¼‰ã€‚


## 2. ç²¾é€‰ä¼˜è´¨é¢˜è§£å‚è€ƒ

### ğŸ“ é¢˜è§£ä¸€ï¼ˆä½œè€…ï¼š1saunoyaï¼Œèµï¼š55ï¼‰
**ç‚¹è¯„**ï¼š  
è¿™ä»½é¢˜è§£çš„**æ€è·¯æœ€æ¸…æ™°**ï¼Œå®Œæ•´æ¨å¯¼äº†æ¦‚ç‡è½¬ç§»æ–¹ç¨‹ï¼Œå¹¶è¯¦ç»†å®ç°äº†çº¿æ®µæ ‘åˆå¹¶ã€‚ä»£ç ç»“æ„è§„èŒƒï¼ˆå¦‚`merge`å‡½æ•°å¤„ç†å·¦å³å­æ ‘çš„è´¡çŒ®ï¼‰ï¼Œå˜é‡å‘½åæ˜“æ‡‚ï¼ˆ`ls`/`rs`è¡¨ç¤ºå·¦å³å­èŠ‚ç‚¹ï¼Œ`sum`è¡¨ç¤ºæ¦‚ç‡å’Œï¼‰ã€‚**äº®ç‚¹**åœ¨äºåˆå¹¶æ—¶æ­£ç¡®ç»´æŠ¤äº†å‰ç¼€å’Œ/åç¼€å’Œï¼Œç¡®ä¿æ¦‚ç‡è®¡ç®—çš„å‡†ç¡®æ€§ã€‚ä»£ç å¯ç›´æ¥ç”¨äºç«èµ›ï¼Œè¾¹ç•Œå¤„ç†ï¼ˆå¦‚å–æ¨¡ï¼‰ä¸¥è°¨ï¼Œæ˜¯å­¦ä¹ çº¿æ®µæ ‘åˆå¹¶çš„æä½³å‚è€ƒã€‚


### ğŸ“ é¢˜è§£äºŒï¼ˆä½œè€…ï¼šcommand_blockï¼Œèµï¼š46ï¼‰
**ç‚¹è¯„**ï¼š  
é¢˜è§£çš„**ä»£ç æœ€ç®€æ´**ï¼Œæ³¨é‡Šæ¸…æ¥šï¼ˆå¦‚`change`å‡½æ•°æ’å…¥å¶å­èŠ‚ç‚¹ï¼Œ`marge`å‡½æ•°åˆå¹¶çº¿æ®µæ ‘ï¼‰ã€‚**äº®ç‚¹**åœ¨äºç”¨`lc`/`rc`åˆ†åˆ«è¡¨ç¤ºå·¦/å³å­æ ‘çš„æ¦‚ç‡ç³»æ•°ï¼Œç®€åŒ–äº†åˆå¹¶æ—¶çš„è®¡ç®—ã€‚ä»£ç å¯è¯»æ€§é«˜ï¼Œé€‚åˆåˆå­¦è€…ç†è§£çº¿æ®µæ ‘åˆå¹¶çš„æ ¸å¿ƒé€»è¾‘ã€‚


### ğŸ“ é¢˜è§£ä¸‰ï¼ˆä½œè€…ï¼šTheLostWeakï¼Œèµï¼š17ï¼‰
**ç‚¹è¯„**ï¼š  
é¢˜è§£çš„**æ¨å¯¼æœ€è¯¦ç»†**ï¼Œä»é¢˜æ„è½¬åŒ–åˆ°çº¿æ®µæ ‘åˆå¹¶çš„æ€è·¯ä¸€æ­¥æ­¥è®²è§£ï¼Œå¸®åŠ©å­¦ä¹ è€…ç†è§£â€œä¸ºä»€ä¹ˆç”¨çº¿æ®µæ ‘åˆå¹¶â€ã€‚**äº®ç‚¹**åœ¨äº`Merge`å‡½æ•°ä¸­æ˜ç¡®ä¼ é€’äº†å‰ç¼€å’Œ/åç¼€å’Œï¼ˆ`lx`/`rx`è¡¨ç¤ºå·¦å­æ ‘çš„å‰ç¼€/åç¼€å’Œï¼‰ï¼Œè®©åˆå¹¶è¿‡ç¨‹æ›´ç›´è§‚ã€‚ä»£ç ä¸­çš„`pushdown`æ“ä½œå¤„ç†æ­£ç¡®ï¼Œé¿å…äº†æ ‡è®°é—æ¼çš„é”™è¯¯ã€‚


## 3. æ ¸å¿ƒéš¾ç‚¹è¾¨æä¸è§£é¢˜ç­–ç•¥

### ğŸ§© æ ¸å¿ƒéš¾ç‚¹ä¸è§£å†³ç­–ç•¥
1. **éš¾ç‚¹1ï¼šæ¦‚ç‡è½¬ç§»æ–¹ç¨‹çš„æ¨å¯¼**  
   - **é—®é¢˜**ï¼šå¦‚ä½•è®¡ç®—éå¶å­èŠ‚ç‚¹å–æŸä¸ªæƒå€¼çš„æ¦‚ç‡ï¼Ÿ  
   - **è§£å†³**ï¼šå¯¹äºå·¦å­æ ‘çš„æƒå€¼`v`ï¼Œå…¶æ¦‚ç‡ç­‰äº`f[left][v]`ä¹˜ä»¥ï¼ˆå–æœ€å¤§å€¼çš„æ¦‚ç‡Ã—å³å­æ ‘æ¯”`v`å°çš„æ¦‚ç‡ + å–æœ€å°å€¼çš„æ¦‚ç‡Ã—å³å­æ ‘æ¯”`v`å¤§çš„æ¦‚ç‡ï¼‰ã€‚å³å­æ ‘åŒç†ã€‚  
   - ğŸ’¡ å­¦ä¹ ç¬”è®°ï¼šè½¬ç§»æ–¹ç¨‹çš„æ ¸å¿ƒæ˜¯â€œå½“å‰æƒå€¼çš„æ¦‚ç‡ = å­æ ‘æ¦‚ç‡ Ã— å¯¹åº”çš„æ¡ä»¶æ¦‚ç‡â€ã€‚

2. **éš¾ç‚¹2ï¼šçº¿æ®µæ ‘åˆå¹¶æ—¶çš„ä¿¡æ¯ä¼ é€’**  
   - **é—®é¢˜**ï¼šå¦‚ä½•å¿«é€Ÿè·å–â€œæ¯”å½“å‰æƒå€¼å°/å¤§çš„æ¦‚ç‡å’Œâ€ï¼Ÿ  
   - **è§£å†³**ï¼šçº¿æ®µæ ‘åˆå¹¶æ—¶ï¼Œé€’å½’å¤„ç†å·¦å³å­èŠ‚ç‚¹ï¼Œç»´æŠ¤å½“å‰åŒºé—´çš„å‰ç¼€å’Œï¼ˆå·¦è¾¹æ‰€æœ‰æƒå€¼çš„æ¦‚ç‡å’Œï¼‰å’Œåç¼€å’Œï¼ˆå³è¾¹æ‰€æœ‰æƒå€¼çš„æ¦‚ç‡å’Œï¼‰ã€‚ä¾‹å¦‚ï¼Œåˆå¹¶å·¦å­æ ‘çš„å·¦èŠ‚ç‚¹æ—¶ï¼Œåç¼€å’Œéœ€è¦åŠ ä¸Šå³å­æ ‘çš„å³èŠ‚ç‚¹çš„æ¦‚ç‡å’Œã€‚  
   - ğŸ’¡ å­¦ä¹ ç¬”è®°ï¼šå‰ç¼€å’Œ/åç¼€å’Œæ˜¯å¤„ç†â€œèŒƒå›´æŸ¥è¯¢â€çš„å…³é”®ï¼Œçº¿æ®µæ ‘åˆå¹¶æ—¶è¦æ­£ç¡®ä¼ é€’è¿™äº›ä¿¡æ¯ã€‚

3. **éš¾ç‚¹3ï¼šç¦»æ•£åŒ–å¤„ç†**  
   - **é—®é¢˜**ï¼šå¶å­æƒå€¼èŒƒå›´å¤§ï¼ˆ1e9ï¼‰ï¼Œæ— æ³•ç›´æ¥ä½œä¸ºçº¿æ®µæ ‘çš„ä¸‹æ ‡ï¼Ÿ  
   - **è§£å†³**ï¼šå°†æ‰€æœ‰å¶å­æƒå€¼æ’åºï¼Œå»é‡åæ˜ å°„åˆ°1~mçš„è¿ç»­ä¸‹æ ‡ã€‚ä¾‹å¦‚ï¼Œæƒå€¼`5`ã€`3`ã€`7`æ’åºåæ˜¯`3`ã€`5`ã€`7`ï¼Œæ˜ å°„åˆ°1ã€2ã€3ã€‚  
   - ğŸ’¡ å­¦ä¹ ç¬”è®°ï¼šç¦»æ•£åŒ–æ˜¯å¤„ç†å¤§å€¼åŸŸé—®é¢˜çš„å¸¸ç”¨æŠ€å·§ï¼Œæ­¥éª¤ä¸ºâ€œæ”¶é›†æ‰€æœ‰éœ€è¦ç¦»æ•£åŒ–çš„å€¼â†’æ’åºâ†’å»é‡â†’æ˜ å°„â€ã€‚


### âœ¨ è§£é¢˜æŠ€å·§æ€»ç»“
- **æŠ€å·§1ï¼šåŠ¨æ€å¼€ç‚¹çº¿æ®µæ ‘**ï¼šåªåˆ›å»ºéœ€è¦çš„èŠ‚ç‚¹ï¼ŒèŠ‚çœç©ºé—´ï¼ˆé€‚ç”¨äºå€¼åŸŸå¤§ä½†å®é™…ç”¨åˆ°çš„èŠ‚ç‚¹å°‘çš„æƒ…å†µï¼‰ï¼›  
- **æŠ€å·§2ï¼šä¹˜æ³•æ ‡è®°**ï¼šå¤„ç†åŒºé—´ä¹˜æ³•æ›´æ–°ï¼ˆå¦‚åˆå¹¶æ—¶ï¼ŒæŸæ®µåŒºé—´çš„æ¦‚ç‡éœ€è¦ä¹˜ä»¥ä¸€ä¸ªç³»æ•°ï¼‰ï¼›  
- **æŠ€å·§3ï¼šæ ‘å½¢DPä¸çº¿æ®µæ ‘åˆå¹¶ç»“åˆ**ï¼šå¯¹äºæ ‘å½¢ç»“æ„çš„é—®é¢˜ï¼Œé€’å½’å¤„ç†å­èŠ‚ç‚¹ï¼Œåˆå¹¶å­èŠ‚ç‚¹çš„ä¿¡æ¯ï¼ˆçº¿æ®µæ ‘ï¼‰å¾—åˆ°çˆ¶èŠ‚ç‚¹çš„ä¿¡æ¯ã€‚


## 4. C++æ ¸å¿ƒä»£ç å®ç°èµæ

### ğŸ“Œ æœ¬é¢˜é€šç”¨æ ¸å¿ƒC++å®ç°å‚è€ƒ
**è¯´æ˜**ï¼šç»¼åˆ1saunoyaã€command_blockã€TheLostWeakçš„é¢˜è§£ï¼Œæå–çº¿æ®µæ ‘åˆå¹¶çš„æ ¸å¿ƒé€»è¾‘ã€‚

```cpp
#include <iostream>
#include <vector>
#include <algorithm>
using namespace std;

const int MOD = 998244353;
const int MAXN = 3e5 + 5;
const int MAXM = 3e5 + 5;

// çº¿æ®µæ ‘èŠ‚ç‚¹ç»“æ„
struct Node {
    int ls, rs; // å·¦å³å­èŠ‚ç‚¹
    long long sum; // æ¦‚ç‡å’Œï¼ˆå–æ¨¡åï¼‰
    long long tag; // ä¹˜æ³•æ ‡è®°ï¼ˆåˆå§‹ä¸º1ï¼‰
} tree[MAXN * 40];
int tot = 0; // çº¿æ®µæ ‘èŠ‚ç‚¹è®¡æ•°å™¨

// å¿«é€Ÿå¹‚ï¼ˆæ±‚é€†å…ƒï¼‰
long long qpow(long long a, long long b) {
    long long res = 1;
    while (b) {
        if (b & 1) res = res * a % MOD;
        a = a * a % MOD;
        b >>= 1;
    }
    return res;
}

// æ–°å»ºèŠ‚ç‚¹
int new_node() {
    tot++;
    tree[tot].ls = tree[tot].rs = 0;
    tree[tot].sum = 0;
    tree[tot].tag = 1;
    return tot;
}

// ä¸‹ä¼ ä¹˜æ³•æ ‡è®°
void pushdown(int rt) {
    if (tree[rt].tag == 1) return;
    // å·¦å­èŠ‚ç‚¹
    if (tree[rt].ls) {
        tree[tree[rt].ls].sum = tree[tree[rt].ls].sum * tree[rt].tag % MOD;
        tree[tree[rt].ls].tag = tree[tree[rt].ls].tag * tree[rt].tag % MOD;
    }
    // å³å­èŠ‚ç‚¹
    if (tree[rt].rs) {
        tree[tree[rt].rs].sum = tree[tree[rt].rs].sum * tree[rt].tag % MOD;
        tree[tree[rt].rs].tag = tree[tree[rt].rs].tag * tree[rt].tag % MOD;
    }
    // é‡ç½®æ ‡è®°
    tree[rt].tag = 1;
}

// æ’å…¥å¶å­èŠ‚ç‚¹ï¼ˆæƒå€¼vï¼Œæ¦‚ç‡1ï¼‰
void insert(int &rt, int l, int r, int v) {
    if (!rt) rt = new_node();
    if (l == r) {
        tree[rt].sum = 1;
        return;
    }
    pushdown(rt);
    int mid = (l + r) >> 1;
    if (v <= mid) insert(tree[rt].ls, l, mid, v);
    else insert(tree[rt].rs, mid + 1, r, v);
    // æ›´æ–°å½“å‰èŠ‚ç‚¹çš„æ¦‚ç‡å’Œ
    tree[rt].sum = (tree[tree[rt].ls].sum + tree[tree[rt].rs].sum) % MOD;
}

// åˆå¹¶ä¸¤æ£µçº¿æ®µæ ‘ï¼ˆrt1ï¼šå·¦å­æ ‘ï¼Œrt2ï¼šå³å­æ ‘ï¼Œpï¼šå–æœ€å¤§å€¼çš„æ¦‚ç‡ï¼‰
int merge(int rt1, int rt2, int l, int r, long long p, long long pre1=0, long long suf1=0, long long pre2=0, long long suf2=0) {
    if (!rt1 && !rt2) return 0;
    pushdown(rt1);
    pushdown(rt2);
    int rt = new_node();
    if (!rt1) {
        // å·¦å­æ ‘ä¸ºç©ºï¼Œå³å­æ ‘çš„æ‰€æœ‰èŠ‚ç‚¹ä¹˜ä»¥ç³»æ•°ï¼ˆpre1ï¼šå·¦å­æ ‘å‰ç¼€å’Œï¼Œsuf1ï¼šå·¦å­æ ‘åç¼€å’Œï¼‰
        long long mul = (p * pre1 % MOD + (1 - p + MOD) * suf1 % MOD) % MOD;
        tree[rt] = tree[rt2];
        tree[rt].sum = tree[rt2].sum * mul % MOD;
        tree[rt].tag = tree[rt2].tag * mul % MOD;
    } else if (!rt2) {
        // å³å­æ ‘ä¸ºç©ºï¼Œå·¦å­æ ‘çš„æ‰€æœ‰èŠ‚ç‚¹ä¹˜ä»¥ç³»æ•°ï¼ˆpre2ï¼šå³å­æ ‘å‰ç¼€å’Œï¼Œsuf2ï¼šå³å­æ ‘åç¼€å’Œï¼‰
        long long mul = (p * pre2 % MOD + (1 - p + MOD) * suf2 % MOD) % MOD;
        tree[rt] = tree[rt1];
        tree[rt].sum = tree[rt1].sum * mul % MOD;
        tree[rt].tag = tree[rt1].tag * mul % MOD;
    } else {
        // é€’å½’åˆå¹¶å·¦å³å­èŠ‚ç‚¹
        int mid = (l + r) >> 1;
        // åˆå¹¶å·¦å­èŠ‚ç‚¹ï¼šå·¦å­æ ‘çš„å·¦èŠ‚ç‚¹ + å³å­æ ‘çš„å·¦èŠ‚ç‚¹
        tree[rt].ls = merge(tree[rt1].ls, tree[rt2].ls, l, mid, p, 
                            pre1, (suf1 + tree[tree[rt1].rs].sum) % MOD, 
                            pre2, (suf2 + tree[tree[rt2].rs].sum) % MOD);
        // åˆå¹¶å³å­èŠ‚ç‚¹ï¼šå·¦å­æ ‘çš„å³èŠ‚ç‚¹ + å³å­æ ‘çš„å³èŠ‚ç‚¹
        tree[rt].rs = merge(tree[rt1].rs, tree[rt2].rs, mid + 1, r, p, 
                            (pre1 + tree[tree[rt1].ls].sum) % MOD, suf1, 
                            (pre2 + tree[tree[rt2].ls].sum) % MOD, suf2);
        // æ›´æ–°å½“å‰èŠ‚ç‚¹çš„æ¦‚ç‡å’Œ
        tree[rt].sum = (tree[tree[rt].ls].sum + tree[tree[rt].rs].sum) % MOD;
    }
    return rt;
}

// ç»Ÿè®¡ç­”æ¡ˆï¼ˆéå†çº¿æ®µæ ‘ï¼Œè®¡ç®—i*V_i*D_iÂ²ï¼‰
void calc_ans(int rt, int l, int r, vector<long long> &val, long long &ans) {
    if (!rt) return;
    if (l == r) {
        long long D = tree[rt].sum;
        ans = (ans + 1LL * l * val[l] % MOD * D % MOD * D % MOD) % MOD;
        return;
    }
    pushdown(rt);
    int mid = (l + r) >> 1;
    calc_ans(tree[rt].ls, l, mid, val, ans);
    calc_ans(tree[rt].rs, mid + 1, r, val, ans);
}

// æ ‘å½¢DPï¼šå¤„ç†æ¯ä¸ªèŠ‚ç‚¹çš„çº¿æ®µæ ‘
void dfs(int u, vector<vector<int>> &children, vector<long long> &p, vector<int> &w, vector<int> &rt, int m) {
    if (children[u].empty()) {
        // å¶å­èŠ‚ç‚¹ï¼šæ’å…¥æƒå€¼w[u]
        insert(rt[u], 1, m, w[u]);
        return;
    }
    // é€’å½’å¤„ç†å­èŠ‚ç‚¹
    for (int v : children[u]) {
        dfs(v, children, p, w, rt, m);
        if (rt[u] == 0) {
            rt[u] = rt[v];
        } else {
            // åˆå¹¶å­èŠ‚ç‚¹çš„çº¿æ®µæ ‘
            rt[u] = merge(rt[u], rt[v], 1, m, p[u]);
        }
    }
}

int main() {
    ios::sync_with_stdio(false);
    cin.tie(0);
    int n;
    cin >> n;
    vector<vector<int>> children(n + 1);
    for (int i = 1; i <= n; i++) {
        int fa;
        cin >> fa;
        if (fa != 0) {
            children[fa].push_back(i);
        }
    }
    vector<long long> p(n + 1);
    vector<int> w(n + 1);
    vector<int> leaf_vals;
    for (int i = 1; i <= n; i++) {
        if (children[i].empty()) {
            // å¶å­èŠ‚ç‚¹ï¼šè¯»å–æƒå€¼
            cin >> w[i];
            leaf_vals.push_back(w[i]);
        } else {
            // éå¶å­èŠ‚ç‚¹ï¼šè¯»å–æ¦‚ç‡ï¼ˆè½¬æ¢ä¸ºæ¨¡æ„ä¹‰ä¸‹çš„åˆ†æ•°ï¼‰
            int x;
            cin >> x;
            p[i] = 1LL * x * qpow(10000, MOD - 2) % MOD;
        }
    }
    // ç¦»æ•£åŒ–ï¼šå°†å¶å­æƒå€¼æ˜ å°„åˆ°1~m
    sort(leaf_vals.begin(), leaf_vals.end());
    leaf_vals.erase(unique(leaf_vals.begin(), leaf_vals.end()), leaf_vals.end());
    int m = leaf_vals.size();
    for (int i = 1; i <= n; i++) {
        if (children[i].empty()) {
            // æ˜ å°„æƒå€¼åˆ°ç¦»æ•£åŒ–åçš„ä¸‹æ ‡
            w[i] = lower_bound(leaf_vals.begin(), leaf_vals.end(), w[i]) - leaf_vals.begin() + 1;
        }
    }
    // åˆå§‹åŒ–æ¯ä¸ªèŠ‚ç‚¹çš„çº¿æ®µæ ‘æ ¹èŠ‚ç‚¹
    vector<int> rt(n + 1, 0);
    // æ ‘å½¢DP
    dfs(1, children, p, w, rt, m);
    // ç»Ÿè®¡ç­”æ¡ˆ
    long long ans = 0;
    calc_ans(rt[1], 1, m, leaf_vals, ans);
    cout << ans << endl;
    return 0;
}
```

**ä»£ç è§£è¯»æ¦‚è¦**ï¼š  
1. **çº¿æ®µæ ‘ç»“æ„**ï¼š`Node`åŒ…å«å·¦å³å­èŠ‚ç‚¹ã€æ¦‚ç‡å’Œ`sum`ã€ä¹˜æ³•æ ‡è®°`tag`ï¼›  
2. **æ’å…¥æ“ä½œ**ï¼š`insert`å‡½æ•°å‘çº¿æ®µæ ‘ä¸­æ’å…¥å¶å­èŠ‚ç‚¹ï¼ˆæƒå€¼`v`ï¼Œæ¦‚ç‡1ï¼‰ï¼›  
3. **åˆå¹¶æ“ä½œ**ï¼š`merge`å‡½æ•°åˆå¹¶ä¸¤æ£µçº¿æ®µæ ‘ï¼Œç»´æŠ¤å‰ç¼€å’Œ/åç¼€å’Œï¼Œè®¡ç®—æ¦‚ç‡è½¬ç§»ï¼›  
4. **æ ‘å½¢DP**ï¼š`dfs`å‡½æ•°é€’å½’å¤„ç†æ¯ä¸ªèŠ‚ç‚¹ï¼Œåˆå¹¶å­èŠ‚ç‚¹çš„çº¿æ®µæ ‘ï¼›  
5. **ç»Ÿè®¡ç­”æ¡ˆ**ï¼š`calc_ans`å‡½æ•°éå†æ ¹èŠ‚ç‚¹çš„çº¿æ®µæ ‘ï¼Œè®¡ç®—é¢˜ç›®è¦æ±‚çš„åŠ æƒå’Œã€‚


### ğŸ“Œ ä¼˜è´¨é¢˜è§£ç‰‡æ®µèµæ
#### é¢˜è§£ä¸€ï¼ˆ1saunoyaï¼‰ï¼šåˆå¹¶å‡½æ•°
**äº®ç‚¹**ï¼šæ­£ç¡®ç»´æŠ¤äº†å‰ç¼€å’Œ/åç¼€å’Œï¼Œå¤„ç†å·¦å³å­æ ‘çš„è´¡çŒ®ã€‚  
**æ ¸å¿ƒä»£ç ç‰‡æ®µ**ï¼š
```cpp
int merge(int x, int y, int l, int r, int xmul, int ymul, int v) {
    if (!x && !y) return 0;
    if (!x) {
        pushmul(y, ymul);
        return y;
    }
    if (!y) {
        pushmul(x, xmul);
        return x;
    }
    pushd(x), pushd(y);
    int mid = l + r >> 1;
    int lsx = sum[ls[x]], lsy = sum[ls[y]], rsx = sum[rs[x]], rsy = sum[rs[y]];
    ls[x] = merge(ls[x], ls[y], l, mid, (xmul + 1LL * rsy % mod * (1 - v + mod)) % mod,
                  (ymul + 1LL * rsx % mod * (1 - v + mod)) % mod, v);
    rs[x] = merge(rs[x], rs[y], mid + 1, r, (xmul + 1LL * lsy % mod * v) % mod,
                  (ymul + 1LL * lsx % mod * v) % mod, v);
    pushup(x);
    return x;
}
```
**ä»£ç è§£è¯»**ï¼š  
- `xmul`/`ymul`ï¼šå·¦/å³å­æ ‘çš„ä¹˜æ³•ç³»æ•°ï¼ˆç”±å‰ç¼€å’Œ/åç¼€å’Œè®¡ç®—å¾—åˆ°ï¼‰ï¼›  
- `lsx`/`lsy`ï¼šå·¦/å³å­æ ‘å·¦èŠ‚ç‚¹çš„æ¦‚ç‡å’Œï¼ˆå‰ç¼€å’Œçš„ä¸€éƒ¨åˆ†ï¼‰ï¼›  
- `rsx`/`rsy`ï¼šå·¦/å³å­æ ‘å³èŠ‚ç‚¹çš„æ¦‚ç‡å’Œï¼ˆåç¼€å’Œçš„ä¸€éƒ¨åˆ†ï¼‰ï¼›  
- é€’å½’åˆå¹¶å·¦å³å­èŠ‚ç‚¹æ—¶ï¼Œæ›´æ–°ä¹˜æ³•ç³»æ•°ï¼ˆ`xmul`/`ymul`ï¼‰ï¼Œç¡®ä¿æ¦‚ç‡è®¡ç®—æ­£ç¡®ã€‚  
**å­¦ä¹ ç¬”è®°**ï¼šåˆå¹¶å‡½æ•°æ˜¯çº¿æ®µæ ‘åˆå¹¶çš„æ ¸å¿ƒï¼Œéœ€è¦æ­£ç¡®ä¼ é€’å‰ç¼€å’Œ/åç¼€å’Œã€‚


#### é¢˜è§£äºŒï¼ˆcommand_blockï¼‰ï¼šæ’å…¥å‡½æ•°
**äº®ç‚¹**ï¼šç®€æ´çš„æ’å…¥æ“ä½œï¼Œå¤„ç†å¶å­èŠ‚ç‚¹ã€‚  
**æ ¸å¿ƒä»£ç ç‰‡æ®µ**ï¼š
```cpp
void change(int l, int r, int &num) {
    a[num=create()].x=1;
    if (l==r)return ;
    int mid=(l+r)>>1;
    if (to<=mid)change(l,mid,a[num].l);
    else change(mid+1,r,a[num].r);
}
```
**ä»£ç è§£è¯»**ï¼š  
- `create`å‡½æ•°æ–°å»ºèŠ‚ç‚¹ï¼›  
- `to`æ˜¯ç¦»æ•£åŒ–åçš„æƒå€¼ï¼›  
- é€’å½’æ’å…¥åˆ°çº¿æ®µæ ‘çš„å¯¹åº”ä½ç½®ï¼Œè®¾ç½®æ¦‚ç‡ä¸º1ã€‚  
**å­¦ä¹ ç¬”è®°**ï¼šæ’å…¥æ“ä½œæ˜¯çº¿æ®µæ ‘çš„åŸºç¡€ï¼Œéœ€è¦æ³¨æ„åŠ¨æ€å¼€ç‚¹ã€‚


#### é¢˜è§£ä¸‰ï¼ˆTheLostWeakï¼‰ï¼šä¸‹ä¼ æ ‡è®°
**äº®ç‚¹**ï¼šæ­£ç¡®çš„ä¸‹ä¼ æ“ä½œï¼Œé¿å…æ ‡è®°é—æ¼ã€‚  
**æ ¸å¿ƒä»£ç ç‰‡æ®µ**ï¼š
```cpp
void PD(int x) {
    if (F[x] != 1) {
        V[S[x][0]] = 1LL * V[S[x][0]] * F[x] % X;
        F[S[x][0]] = 1LL * F[S[x][0]] * F[x] % X;
        V[S[x][1]] = 1LL * V[S[x][1]] * F[x] % X;
        F[S[x][1]] = 1LL * F[S[x][1]] * F[x] % X;
        F[x] = 1;
    }
}
```
**ä»£ç è§£è¯»**ï¼š  
- `F[x]`æ˜¯ä¹˜æ³•æ ‡è®°ï¼›  
- ä¸‹ä¼ æ—¶ï¼Œå°†å·¦å³å­èŠ‚ç‚¹çš„æ¦‚ç‡å’Œ`V`å’Œæ ‡è®°`F`ä¹˜ä»¥å½“å‰æ ‡è®°ï¼›  
- é‡ç½®å½“å‰èŠ‚ç‚¹çš„æ ‡è®°ä¸º1ã€‚  
**å­¦ä¹ ç¬”è®°**ï¼šä¸‹ä¼ æ“ä½œæ˜¯çº¿æ®µæ ‘çš„å…³é”®ï¼Œå¿…é¡»åœ¨è®¿é—®å­èŠ‚ç‚¹å‰æ‰§è¡Œã€‚


## 5. ç®—æ³•å¯è§†åŒ–ï¼šåƒç´ åŠ¨ç”»æ¼”ç¤ºï¼ˆæ ¸å¿ƒéƒ¨åˆ†ï¼‰

### ğŸ® åŠ¨ç”»æ¼”ç¤ºä¸»é¢˜ï¼šçº¿æ®µæ ‘åˆå¹¶å†é™©è®°
**é£æ ¼**ï¼š8ä½åƒç´ é£ï¼ˆç±»ä¼¼ã€Šè¶…çº§é©¬é‡Œå¥¥ã€‹ï¼‰ï¼Œç”¨åƒç´ å—è¡¨ç¤ºçº¿æ®µæ ‘èŠ‚ç‚¹ï¼ŒèƒŒæ™¯ä¸ºæ¸¸æˆåœºæ™¯ï¼ˆå¦‚åŸå ¡ã€æ£®æ—ï¼‰ã€‚


### ğŸ“ æ ¸å¿ƒæ¼”ç¤ºå†…å®¹
1. **åˆå§‹åŒ–**ï¼š  
   - å±å¹•å·¦ä¾§æ˜¾ç¤ºå·¦å­æ ‘çš„çº¿æ®µæ ‘ï¼ˆè“è‰²èŠ‚ç‚¹ï¼‰ï¼Œå³ä¾§æ˜¾ç¤ºå³å­æ ‘çš„çº¿æ®µæ ‘ï¼ˆçº¢è‰²èŠ‚ç‚¹ï¼‰ï¼›  
   - é¡¶éƒ¨æ˜¾ç¤ºå½“å‰å¤„ç†çš„èŠ‚ç‚¹ï¼ˆå¦‚â€œåˆå¹¶èŠ‚ç‚¹1-5â€ï¼‰ï¼›  
   - åº•éƒ¨æœ‰æ§åˆ¶æŒ‰é’®ï¼šå•æ­¥æ‰§è¡Œã€è‡ªåŠ¨æ’­æ”¾ã€é‡ç½®ã€‚

2. **åˆå¹¶è¿‡ç¨‹**ï¼š  
   - **æ­¥éª¤1**ï¼šé€‰ä¸­å·¦å³å­æ ‘çš„æ ¹èŠ‚ç‚¹ï¼Œæ˜¾ç¤ºå®ƒä»¬çš„æ¦‚ç‡å’Œï¼ˆå¦‚å·¦å­æ ‘æ ¹èŠ‚ç‚¹çš„`sum=0.5`ï¼Œå³å­æ ‘æ ¹èŠ‚ç‚¹çš„`sum=0.5`ï¼‰ï¼›  
   - **æ­¥éª¤2**ï¼šé€’å½’åˆå¹¶å·¦å­èŠ‚ç‚¹ï¼Œæ˜¾ç¤ºå‰ç¼€å’Œ/åç¼€å’Œçš„è®¡ç®—ï¼ˆå¦‚å·¦å­æ ‘å·¦èŠ‚ç‚¹çš„`pre=0.3`ï¼Œå³å­æ ‘å·¦èŠ‚ç‚¹çš„`suf=0.2`ï¼‰ï¼›  
   - **æ­¥éª¤3**ï¼šåˆå¹¶å³å­èŠ‚ç‚¹ï¼Œæ˜¾ç¤ºä¹˜æ³•æ ‡è®°çš„åº”ç”¨ï¼ˆå¦‚å³å­æ ‘å³èŠ‚ç‚¹çš„`tag=0.7`ï¼‰ï¼›  
   - **æ­¥éª¤4**ï¼šåˆå¹¶å®Œæˆï¼Œæ˜¾ç¤ºåˆå¹¶åçš„çº¿æ®µæ ‘ï¼ˆç´«è‰²èŠ‚ç‚¹ï¼‰ï¼Œå¹¶æ ‡æ³¨æ¯ä¸ªèŠ‚ç‚¹çš„æ¦‚ç‡å’Œã€‚

3. **äº¤äº’ä¸æ¸¸æˆå…ƒç´ **ï¼š  
   - **å•æ­¥æ‰§è¡Œ**ï¼šç‚¹å‡»â€œä¸‹ä¸€æ­¥â€æŒ‰é’®ï¼ŒæŸ¥çœ‹æ¯ä¸€æ­¥åˆå¹¶è¿‡ç¨‹ï¼›  
   - **è‡ªåŠ¨æ’­æ”¾**ï¼šç‚¹å‡»â€œå¼€å§‹â€æŒ‰é’®ï¼ŒåŠ¨ç”»è‡ªåŠ¨æ’­æ”¾ï¼Œé€Ÿåº¦å¯è°ƒï¼ˆæ»‘å—æ§åˆ¶ï¼‰ï¼›  
   - **éŸ³æ•ˆ**ï¼šåˆå¹¶èŠ‚ç‚¹æ—¶æ’­æ”¾â€œå®â€çš„éŸ³æ•ˆï¼Œå®Œæˆæ—¶æ’­æ”¾â€œèƒœåˆ©â€éŸ³æ•ˆï¼ˆå¦‚ã€Šè¶…çº§é©¬é‡Œå¥¥ã€‹çš„é€šå…³éŸ³æ•ˆï¼‰ï¼›  
   - **ç§¯åˆ†**ï¼šæ¯å®Œæˆä¸€æ¬¡åˆå¹¶ï¼Œè·å¾—10åˆ†ï¼Œç´¯è®¡ç§¯åˆ†æ˜¾ç¤ºåœ¨å±å¹•å³ä¸Šè§’ã€‚


### ğŸ¨ è®¾è®¡æ€è·¯
- **åƒç´ é£æ ¼**ï¼šè¥é€ å¤å¤æ¸¸æˆæ°›å›´ï¼Œé™ä½å­¦ä¹ å‹åŠ›ï¼›  
- **åŠ¨ç”»æ•ˆæœ**ï¼šç”¨é¢œè‰²å˜åŒ–ï¼ˆå¦‚è“è‰²â†’ç´«è‰²ï¼‰è¡¨ç¤ºåˆå¹¶ï¼Œç”¨é—ªçƒè¡¨ç¤ºå½“å‰å¤„ç†çš„èŠ‚ç‚¹ï¼Œç›´è§‚å±•ç¤ºçº¿æ®µæ ‘çš„å˜åŒ–ï¼›  
- **æ¸¸æˆå…ƒç´ **ï¼šç§¯åˆ†ã€éŸ³æ•ˆå¢åŠ è¶£å‘³æ€§ï¼Œæ¿€åŠ±å­¦ä¹ è€…å®Œæˆæ¼”ç¤ºï¼›  
- **ä¿¡æ¯å±•ç¤º**ï¼šé¼ æ ‡ hover èŠ‚ç‚¹æ—¶ï¼Œæ˜¾ç¤ºè¯¥èŠ‚ç‚¹çš„æ¦‚ç‡å’Œã€å‰ç¼€å’Œ/åç¼€å’Œï¼Œå¸®åŠ©ç†è§£ç»†èŠ‚ã€‚


## 6. æ‹“å±•ç»ƒä¹ ä¸ç›¸ä¼¼é—®é¢˜æ€è€ƒ

### ğŸ§  é€šç”¨æ€è·¯è¿ç§»
çº¿æ®µæ ‘åˆå¹¶ä¸»è¦ç”¨äº**ç»´æŠ¤æ ‘å½¢ç»“æ„ä¸­çš„ä¿¡æ¯åˆå¹¶**ï¼Œé€‚ç”¨äºä»¥ä¸‹åœºæ™¯ï¼š  
1. **æ ‘ä¸Šè·¯å¾„æŸ¥è¯¢**ï¼šå¦‚æ±‚è·¯å¾„ä¸Šçš„ç¬¬kå¤§å…ƒç´ ï¼›  
2. **åŠ¨æ€è¿é€šæ€§**ï¼šå¦‚åˆå¹¶ä¸¤ä¸ªé›†åˆï¼Œç»´æŠ¤é›†åˆä¸­çš„ä¿¡æ¯ï¼›  
3. **æ ‘å½¢DPä¼˜åŒ–**ï¼šå¦‚æœ¬é¢˜ä¸­çš„æ¦‚ç‡åˆ†å¸ƒåˆå¹¶ã€‚


### ğŸ“š æ´›è°·ç»ƒä¹ æ¨è
1. **æ´›è°· P3224 [HNOI2012]æ°¸æ— ä¹¡**  
   - ğŸ—£ï¸ æ¨èç†ç”±ï¼šè€ƒå¯Ÿçº¿æ®µæ ‘åˆå¹¶çš„åŸºæœ¬åº”ç”¨ï¼Œéœ€è¦åˆå¹¶ä¸¤ä¸ªé›†åˆçš„çº¿æ®µæ ‘ï¼Œæ±‚ç¬¬kå¤§å…ƒç´ ã€‚  
2. **æ´›è°· P4556 [Vaniæœ‰çº¦ä¼š]é›¨å¤©çš„å°¾å·´**  
   - ğŸ—£ï¸ æ¨èç†ç”±ï¼šè€ƒå¯Ÿçº¿æ®µæ ‘åˆå¹¶çš„é«˜çº§åº”ç”¨ï¼Œéœ€è¦åœ¨æ ‘ä¸Šè¿›è¡Œè·¯å¾„æ›´æ–°ï¼Œåˆå¹¶å­æ ‘çš„çº¿æ®µæ ‘ã€‚  
3. **æ´›è°· P5018 [NOIP2018]æ‘†æ¸¡è½¦**  
   - ğŸ—£ï¸ æ¨èç†ç”±ï¼šè€ƒå¯ŸåŠ¨æ€è§„åˆ’ä¸çº¿æ®µæ ‘ä¼˜åŒ–çš„ç»“åˆï¼Œéœ€è¦ç”¨çº¿æ®µæ ‘ç»´æŠ¤çŠ¶æ€è½¬ç§»çš„ä¿¡æ¯ã€‚


## 7. å­¦ä¹ å¿ƒå¾—ä¸ç»éªŒåˆ†äº«ï¼ˆè‹¥æœ‰ï¼‰
**å‚è€ƒç»éªŒï¼ˆæ¥è‡ª1saunoyaï¼‰**ï¼š  
â€œæˆ‘åœ¨è°ƒè¯•æ—¶ï¼Œä¸€å¼€å§‹å¿˜è®°äº†ä¸‹ä¼ ä¹˜æ³•æ ‡è®°ï¼Œå¯¼è‡´æ¦‚ç‡è®¡ç®—é”™è¯¯ã€‚åæ¥é€šè¿‡æ‰“å°ä¸­é—´å˜é‡ï¼Œå‘ç°çº¿æ®µæ ‘èŠ‚ç‚¹çš„`sum`å€¼ä¸å¯¹ï¼Œæ‰æ„è¯†åˆ°æ˜¯æ ‡è®°æ²¡æœ‰ä¸‹ä¼ ã€‚â€  
**ç‚¹è¯„**ï¼šä¸‹ä¼ æ ‡è®°æ˜¯çº¿æ®µæ ‘çš„å…³é”®æ“ä½œï¼Œå¿…é¡»åœ¨è®¿é—®å­èŠ‚ç‚¹å‰æ‰§è¡Œã€‚åˆå­¦è€…å¯ä»¥é€šè¿‡æ‰“å°ä¸­é—´å˜é‡ï¼ˆå¦‚`sum`ã€`tag`ï¼‰æ¥è°ƒè¯•ï¼Œå¿«é€Ÿå®šä½é”™è¯¯ã€‚


## ğŸ“ æ€»ç»“
æœ¬æ¬¡åˆ†æçš„â€œ[PKUWC2018] Minimaxâ€é¢˜ï¼Œæ ¸å¿ƒæ˜¯**çº¿æ®µæ ‘åˆå¹¶**ä¸**æ ‘å½¢DP**çš„ç»“åˆã€‚é€šè¿‡çº¿æ®µæ ‘åˆå¹¶ç»´æŠ¤æ¯ä¸ªèŠ‚ç‚¹çš„æƒå€¼æ¦‚ç‡åˆ†å¸ƒï¼Œå¤„ç†æ¦‚ç‡è½¬ç§»ï¼Œæœ€ç»ˆæ±‚å‡ºæ ¹èŠ‚ç‚¹çš„åŠ æƒå’Œã€‚å­¦ä¹ æ—¶éœ€è¦é‡ç‚¹æŒæ¡çº¿æ®µæ ‘åˆå¹¶çš„å®ç°ï¼ˆåŠ¨æ€å¼€ç‚¹ã€å‰ç¼€å’Œ/åç¼€å’Œã€ä¹˜æ³•æ ‡è®°ï¼‰ï¼Œä»¥åŠç¦»æ•£åŒ–å¤„ç†å¤§å€¼åŸŸçš„æŠ€å·§ã€‚

è®°ä½ï¼šç¼–ç¨‹èƒ½åŠ›çš„æå‡åœ¨äº**æŒç»­ç»ƒä¹ **å’Œ**æ·±å…¥æ€è€ƒ**ã€‚å¤šåšç±»ä¼¼é¢˜ç›®ï¼ˆå¦‚æ´›è°·çš„æ¨èç»ƒä¹ ï¼‰ï¼Œæ‰èƒ½ç†Ÿç»ƒæŒæ¡çº¿æ®µæ ‘åˆå¹¶çš„åº”ç”¨ï¼ğŸ’ª

---
å¤„ç†ç”¨æ—¶ï¼š223.08ç§’
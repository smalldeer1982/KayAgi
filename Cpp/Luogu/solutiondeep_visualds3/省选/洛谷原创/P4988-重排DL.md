# é¢˜ç›®ä¿¡æ¯

# é‡æ’DL

## é¢˜ç›®èƒŒæ™¯

Dancing Line çš„å…³å¡æ’åºæ€»æ˜¯å¾ˆç„å­¦ã€‚

## é¢˜ç›®æè¿°

è¿™å¤©å°åŸ‹ç»™ Dancing Line ä¸­å…³å¡æ’åºåˆ¶å®šäº†ä¸€ä¸ªæ–°çš„è§„åˆ™ï¼šå‡è®¾æŸä¸€å…³ä¸ºç¬¬ $n$ ä¸ªå‘å¸ƒçš„å…³å¡ï¼Œé‚£ä¹ˆå®ƒçš„ä½ç½® $a_n$ æ»¡è¶³ $a_{n+1}=(\sqrt[k]{a_n-n}+2)^k+n+1$ï¼Œä¸”ç¬¬ä¸€ä¸ªå‘å¸ƒçš„å…³å¡æ€»æ˜¯æ’åœ¨ç¬¬ä¸€ï¼Œå³ $a_1=2$ã€‚

ä½†æ˜¯è¿™æ ·æ˜¾ç„¶ä¼šå‡ºç°ä¸€ä¸ªé—®é¢˜ï¼šè®¸å¤šä½ç½®æ˜¯ç©ºå…³å¡ã€‚æ‰€ä»¥å°åŸ‹åˆç»™å‡ºäº†ä¸€ä¸ªé™åˆ¶æ¡ä»¶ï¼šè°ƒæ•´ $k$ï¼Œä½¿å¾—ç¬¬ $n$ ä¸ªå…³å¡æ»¡è¶³ $a_n \equiv b\pmod{m}$ã€‚ç°åœ¨å°åŸ‹ç»™äº† $n,m,b$ï¼Œæ±‚æœ€å°æ»¡è¶³æ¡ä»¶çš„**æ•´æ•°** $k$ã€‚

## è¯´æ˜/æç¤º

å¯¹äº $30\%$ çš„æ•°æ®ï¼Œ$n\le 100$ï¼Œ$0\le b<m\le 10000$ï¼›

å¯¹äº $50\%$ çš„æ•°æ®ï¼Œ$n\le 10^{12}$ï¼Œ$0\le b<m\le 10000$ï¼›

å¯¹äº $100\%$ çš„æ•°æ®ï¼Œ$n\le 10^{12}$ï¼Œ$0\le b<m\le 10^{12}$ã€‚

ä¿è¯ $n,m,b$ å‡ä¸ºæ­£æ•´æ•°ã€‚

## æ ·ä¾‹ #1

### è¾“å…¥

```
3 3 2```

### è¾“å‡º

```
1```

## æ ·ä¾‹ #2

### è¾“å…¥

```
3 8 2```

### è¾“å‡º

```
INF```

# AIåˆ†æç»“æœ

# ğŸ’¡ Kayçš„C++ç®—æ³•è§£æï¼šé‡æ’DL æ·±å…¥å­¦ä¹ æŒ‡å— ğŸ’¡

ä»Šå¤©æˆ‘ä»¬æ¥ä¸€èµ·åˆ†æâ€œé‡æ’DLâ€è¿™é“C++ç¼–ç¨‹é¢˜ã€‚æœ¬æŒ‡å—å°†å¸®åŠ©å¤§å®¶æ¢³ç†é¢˜ç›®æ€è·¯ï¼Œç†è§£æ ¸å¿ƒæ•°è®ºç®—æ³•ï¼Œå¹¶æŒæ¡è§£é¢˜æŠ€å·§ã€‚


## 1. é¢˜ç›®è§£è¯»ä¸æ ¸å¿ƒç®—æ³•è¯†åˆ«

âœ¨ **æœ¬é¢˜ä¸»è¦è€ƒå¯Ÿ**ï¼šæ•°å­¦ï¼ˆæ•°è®ºä¸­çš„æ¨¡å¹‚æ–¹ç¨‹æ±‚è§£ï¼Œæ‰©å±•BSGSç®—æ³•åº”ç”¨ï¼‰

ğŸ—£ï¸ **åˆæ­¥åˆ†æ**ï¼š
è§£å†³â€œé‡æ’DLâ€çš„å…³é”®ï¼Œå°±åƒ**æ‰¾ä¸€æŠŠèƒ½æ‰“å¼€å¯†ç é”çš„æœ€å°é’¥åŒ™**â€”â€”æˆ‘ä»¬éœ€è¦æ‰¾åˆ°æœ€å°çš„æ•´æ•°kï¼Œè®©â€œåº•æ•°(2n-1)çš„kæ¬¡æ–¹â€æ¨¡måç­‰äºâ€œç›®æ ‡å€¼(b-n)â€ã€‚è¿™é‡Œçš„æ ¸å¿ƒæ˜¯**æ•°è®ºä¸­çš„æ¨¡å¹‚æ–¹ç¨‹æ±‚è§£**ï¼Œè€Œè§£å†³è¿™ç±»é—®é¢˜çš„â€œé’¥åŒ™â€å°±æ˜¯**æ‰©å±•BSGSç®—æ³•**ï¼ˆç”¨äºå¤„ç†æ¨¡æ•°éè´¨æ•°çš„æƒ…å†µï¼‰ã€‚

### æ ¸å¿ƒæ€è·¯æ¨å¯¼
é¢˜ç›®ç»™å‡ºçš„é€’æ¨å¼çœ‹èµ·æ¥å¤æ‚ï¼Œä½†é€šè¿‡**æ•°å­¦å˜å½¢**èƒ½å¿«é€Ÿæ‰¾åˆ°é€šé¡¹ï¼š
1. ä»¤`g(x) = âˆ›[k]{a_x - x}`ï¼ˆkæ¬¡æ ¹å·ï¼‰ï¼Œé€’æ¨å¼å¯è½¬åŒ–ä¸º`g(n+1) - g(n) = 2`ï¼ˆç­‰å·®æ•°åˆ—ï¼‰ï¼›
2. ç»“åˆåˆå§‹æ¡ä»¶`aâ‚=2`ï¼Œç®—å‡º`g(1)=1`ï¼Œè¿›è€Œå¾—åˆ°`g(n)=2n-1`ï¼›
3. åæ¨å¾—**é€šé¡¹å…¬å¼**ï¼š`aâ‚™ = (2n-1)^k + n`ã€‚

å› æ­¤é—®é¢˜ç®€åŒ–ä¸ºï¼šæ±‚æœ€å°kï¼Œä½¿å¾—`(2n-1)^k â‰¡ (b - n) mod m`ï¼ˆè®°å·¦è¾¹ä¸ºA^kï¼Œå³è¾¹ä¸ºBï¼‰ã€‚

### æ ¸å¿ƒéš¾ç‚¹ä¸è§£å†³æ–¹æ¡ˆ
- **éš¾ç‚¹1**ï¼šä»å¤æ‚é€’æ¨å¼æ¨å¯¼é€šé¡¹ï¼ˆéœ€è¦æ•é”çš„æ•°å­¦å˜å½¢èƒ½åŠ›ï¼‰ï¼›
- **éš¾ç‚¹2**ï¼šå¤„ç†æ¨¡æ•°méè´¨æ•°çš„æƒ…å†µï¼ˆæ™®é€šBSGSä»…é€‚ç”¨äºè´¨æ•°æ¨¡æ•°ï¼Œéœ€ç”¨æ‰©å±•BSGSåˆ†è§£æ¨¡æ•°ï¼‰ï¼›
- **éš¾ç‚¹3**ï¼šé¿å…å¤§æ•°ä¹˜æ³•æº¢å‡ºï¼ˆç”¨å¿«é€Ÿä¹˜ä»£æ›¿æ™®é€šä¹˜æ³•ï¼‰ã€‚

### å¯è§†åŒ–è®¾è®¡æ€è·¯
æˆ‘ä¼šç”¨**8ä½åƒç´ é£**è®¾è®¡ä¸€ä¸ªâ€œæ•°è®ºå®éªŒå®¤â€åŠ¨ç”»ï¼Œæ ¸å¿ƒå±•ç¤ºï¼š
1. **é€šé¡¹æ¨å¯¼è¿‡ç¨‹**ï¼šç”¨åƒç´ å—é€è¡Œæ˜¾ç¤ºç­‰å¼å˜å½¢ï¼Œé«˜äº®`g(x)`çš„å®šä¹‰å’Œç­‰å·®æ•°åˆ—æ¨å¯¼ï¼ˆæ¯”å¦‚`g(n+1)-g(n)=2`ä¼šé—ªçƒå¹¶æ’­æ”¾â€œå®â€çš„éŸ³æ•ˆï¼‰ï¼›
2. **æ‰©å±•BSGSæµç¨‹**ï¼šç”¨åƒç´ ç½‘æ ¼å±•ç¤ºæ¨¡æ•°åˆ†è§£ï¼ˆæ¯åˆ†è§£ä¸€æ¬¡æ¨¡æ•°ï¼Œå¯¹åº”åƒç´ å—ç¼©å°ï¼‰ã€å“ˆå¸Œè¡¨é¢„å¤„ç†ï¼ˆåƒç´ å—â€œé£å…¥â€å“ˆå¸Œè¡¨åŒºåŸŸï¼‰ã€æŸ¥æ‰¾åŒ¹é…ï¼ˆç®­å¤´æŒ‡å‘åŒ¹é…çš„kå€¼ï¼‰ï¼›
3. **äº¤äº’æ§åˆ¶**ï¼šæ”¯æŒå•æ­¥æ‰§è¡Œï¼ˆçœ‹æ¸…æ¥šæ¯ä¸€æ­¥å˜å½¢ï¼‰ã€è‡ªåŠ¨æ’­æ”¾ï¼ˆåƒâ€œæ•°è®ºAIâ€ä¸€æ ·å¿«é€Ÿæ¨å¯¼ï¼‰ï¼Œè¿˜æœ‰é€Ÿåº¦æ»‘å—è°ƒæ•´åŠ¨ç”»èŠ‚å¥ã€‚


## 2. ç²¾é€‰ä¼˜è´¨é¢˜è§£å‚è€ƒ

ä¸ºäº†æ›´å¥½åœ°ç†è§£è§£é¢˜è¿‡ç¨‹ï¼Œæˆ‘ç­›é€‰äº†**æ€è·¯æ¸…æ™°ã€ä»£ç ä¸¥è°¨ã€ç®—æ³•æœ‰æ•ˆçš„ä¼˜è´¨é¢˜è§£**ï¼š

**é¢˜è§£ä¸€ï¼š(æ¥æºï¼šShineEternal)**
* **ç‚¹è¯„**ï¼šè¿™ä»½é¢˜è§£æ˜¯â€œä»æ•°å­¦æ¨å¯¼åˆ°ä»£ç å®ç°â€çš„å®Œç¾ç¤ºèŒƒï¼é¦–å…ˆé€šè¿‡ä¸¥è°¨çš„ç­‰å¼å˜å½¢æ¨å¯¼å‡ºé€šé¡¹å…¬å¼ï¼ŒæŠŠå¤æ‚é€’æ¨é—®é¢˜è½¬åŒ–ä¸ºç®€å•çš„æ¨¡å¹‚æ–¹ç¨‹ï¼›æ¥ç€ç”¨**æ‰©å±•BSGSç®—æ³•**å¤„ç†æ¨¡æ•°éè´¨æ•°çš„æƒ…å†µï¼ˆè¿™æ˜¯æœ¬é¢˜çš„å…³é”®éš¾ç‚¹ï¼‰ï¼›ä»£ç ä¸­ç”¨**å¿«é€Ÿä¹˜**é¿å…äº†å¤§æ•°ä¹˜æ³•æº¢å‡ºï¼ˆæ¯”å¦‚`multi`å‡½æ•°ï¼‰ï¼Œè¿˜è´´å¿ƒåœ°å¤„ç†äº†è¾¹ç•Œæ¡ä»¶ï¼ˆæ¯”å¦‚åˆ¤æ–­æ— è§£çš„æƒ…å†µï¼‰ã€‚æ•´ä½“æ€è·¯ç¯ç¯ç›¸æ‰£ï¼Œä»£ç é£æ ¼è§„èŒƒï¼ˆå˜é‡åå¦‚`first`ä»£è¡¨åº•æ•°ï¼Œ`tmp`ä»£è¡¨ä¸­é—´ç»“æœï¼‰ï¼Œéå¸¸é€‚åˆåˆå­¦è€…å­¦ä¹ æ•°è®ºç®—æ³•çš„å·¥ç¨‹å®ç°ã€‚


## 3. æ ¸å¿ƒéš¾ç‚¹è¾¨æä¸è§£é¢˜ç­–ç•¥

åœ¨è§£å†³è¿™ç±»æ•°è®ºé—®é¢˜æ—¶ï¼Œå¤§å®¶å¸¸é‡åˆ°ä»¥ä¸‹3ä¸ªæ ¸å¿ƒéš¾ç‚¹ï¼Œç»“åˆä¼˜è´¨é¢˜è§£çš„ç»éªŒï¼Œæˆ‘æ€»ç»“äº†åº”å¯¹ç­–ç•¥ï¼š

### 1. å¦‚ä½•ä»å¤æ‚é€’æ¨å¼æ¨å¯¼é€šé¡¹ï¼Ÿ
* **åˆ†æ**ï¼šé€’æ¨å¼ä¸­çš„æ ¹å·å’Œå¹‚è¿ç®—çœ‹èµ·æ¥å“äººï¼Œä½†**å˜é‡æ›¿æ¢**æ˜¯ç ´å±€å…³é”®ã€‚æ¯”å¦‚æœ¬é¢˜ç”¨`g(x) = âˆ›[k]{a_x - x}`æŠŠé€’æ¨å¼è½¬åŒ–ä¸ºç­‰å·®æ•°åˆ—ï¼Œç¬é—´ç®€åŒ–é—®é¢˜ã€‚
* ğŸ’¡ **å­¦ä¹ ç¬”è®°**ï¼šé‡åˆ°é€’æ¨å¼ï¼Œå…ˆå°è¯•â€œå˜é‡æ›¿æ¢â€ï¼ŒæŠŠéçº¿æ€§é€’æ¨è½¬åŒ–ä¸ºçº¿æ€§ï¼ˆæ¯”å¦‚ç­‰å·®/ç­‰æ¯”æ•°åˆ—ï¼‰ã€‚

### 2. æ¨¡æ•°mä¸æ˜¯è´¨æ•°æ—¶æ€ä¹ˆåŠï¼Ÿ
* **åˆ†æ**ï¼šæ™®é€šBSGSä»…é€‚ç”¨äºæ¨¡æ•°ä¸ºè´¨æ•°çš„æƒ…å†µï¼Œè€Œæ‰©å±•BSGSé€šè¿‡**åˆ†è§£æ¨¡æ•°**ï¼ˆæ¯æ¬¡é™¤ä»¥gcd(åº•æ•°, æ¨¡æ•°)ï¼‰ï¼ŒæŠŠé—®é¢˜è½¬åŒ–ä¸ºæ¨¡æ•°äº’è´¨çš„æƒ…å†µã€‚æ¯”å¦‚é¢˜è§£ä¸­ç”¨å¾ªç¯åˆ†è§£æ¨¡æ•°ï¼Œç›´åˆ°åº•æ•°å’Œæ¨¡æ•°äº’è´¨ã€‚
* ğŸ’¡ **å­¦ä¹ ç¬”è®°**ï¼šå¤„ç†æ¨¡è¿ç®—é—®é¢˜æ—¶ï¼Œå…ˆçœ‹æ¨¡æ•°æ˜¯å¦ä¸ºè´¨æ•°â€”â€”è‹¥éè´¨æ•°ï¼Œä¼˜å…ˆè€ƒè™‘â€œæ‰©å±•BSGSâ€æˆ–â€œåˆ†è§£æ¨¡æ•°â€ã€‚

### 3. å¦‚ä½•é¿å…å¤§æ•°ä¹˜æ³•æº¢å‡ºï¼Ÿ
* **åˆ†æ**ï¼šå½“nå’Œmå¾ˆå¤§æ—¶ï¼ˆæ¯”å¦‚1e12ï¼‰ï¼Œæ™®é€šä¹˜æ³•ä¼šæº¢å‡º64ä½æ•´æ•°ã€‚é¢˜è§£ä¸­çš„`multi`å‡½æ•°ç”¨**æµ®ç‚¹è¯¯å·®ä¿®æ­£**çš„æ–¹æ³•å®ç°å¿«é€Ÿä¹˜ï¼ˆæŠŠä¹˜æ³•è½¬åŒ–ä¸ºæ¨¡è¿ç®—ä¸‹çš„ç­‰ä»·è®¡ç®—ï¼‰ï¼Œé¿å…æº¢å‡ºã€‚
* ğŸ’¡ **å­¦ä¹ ç¬”è®°**ï¼šå¤„ç†å¤§æ•°æ¨¡è¿ç®—æ—¶ï¼Œç”¨â€œå¿«é€Ÿä¹˜â€ä»£æ›¿æ™®é€šä¹˜æ³•ï¼Œç”¨â€œå¿«é€Ÿå¹‚â€ä»£æ›¿æ™®é€šå¹‚è¿ç®—ã€‚


### âœ¨ è§£é¢˜æŠ€å·§æ€»ç»“
- **æ•°å­¦å˜å½¢ä¼˜å…ˆ**ï¼šé‡åˆ°é€’æ¨å¼å…ˆå°è¯•å˜é‡æ›¿æ¢ï¼Œæ¨å¯¼é€šé¡¹ï¼›
- **æ¨¡æ•°å¤„ç†åˆ†æƒ…å†µ**ï¼šè´¨æ•°ç”¨BSGSï¼Œéè´¨æ•°ç”¨æ‰©å±•BSGSï¼›
- **å¤§æ•°è¿ç®—è¦è°¨æ…**ï¼šç”¨å¿«é€Ÿä¹˜/å¿«é€Ÿå¹‚é¿å…æº¢å‡ºï¼›
- **è¾¹ç•Œæ¡ä»¶è¦å…¨**ï¼šæ¯”å¦‚åˆ¤æ–­Bæ˜¯å¦èƒ½è¢«gcd(A,m)æ•´é™¤ï¼ˆå¦åˆ™æ— è§£ï¼‰ã€‚


## 4. C++æ ¸å¿ƒä»£ç å®ç°èµæ

åœ¨æ·±å…¥åˆ†æå…·ä½“ä»£ç å‰ï¼Œå…ˆçœ‹ä¸€ä¸ª**é€šç”¨çš„æ‰©å±•BSGSæ ¸å¿ƒå®ç°**ï¼Œå¸®å¤§å®¶å»ºç«‹æ•´ä½“æ¡†æ¶ï¼š

### æœ¬é¢˜é€šç”¨æ ¸å¿ƒC++å®ç°å‚è€ƒ
* **è¯´æ˜**ï¼šæœ¬ä»£ç ç»¼åˆäº†æ•°è®ºç®—æ³•çš„ç»å…¸å®ç°ï¼Œæ¶µç›–å¿«é€Ÿä¹˜ã€æ‰©å±•BSGSçš„æ ¸å¿ƒé€»è¾‘ã€‚
* **å®Œæ•´æ ¸å¿ƒä»£ç **ï¼š
```cpp
#include <iostream>
#include <vector>
#include <map>
#include <cmath>
using namespace std;

typedef long long ll;

ll multi(ll x, ll y, ll mod) { // å¿«é€Ÿä¹˜ï¼šé¿å…æº¢å‡º
    ll tmp = x * y - (ll)((long double)x * y / mod + 0.5) * mod;
    return tmp < 0 ? tmp + mod : tmp;
}

ll gcd(ll a, ll b) {
    return b ? gcd(b, a % b) : a;
}

ll qpow(ll a, ll b, ll mod) { // å¿«é€Ÿå¹‚
    ll res = 1;
    while (b) {
        if (b & 1) res = multi(res, a, mod);
        a = multi(a, a, mod);
        b >>= 1;
    }
    return res;
}

ll ex_bsgs(ll A, ll B, ll mod) { // æ‰©å±•BSGSï¼šæ±‚æœ€å°kä½¿å¾—A^k â‰¡ B mod mod
    A %= mod, B %= mod;
    if (B == 1 || mod == 1) return 0; // è¾¹ç•Œæ¡ä»¶

    ll cnt = 0, tmp = 1;
    while (true) {
        ll d = gcd(A, mod);
        if (d == 1) break;
        if (B % d) return -1; // æ— è§£
        B /= d, mod /= d;
        tmp = multi(tmp, A / d, mod);
        cnt++;
        if (tmp == B) return cnt;
    }

    map<ll, ll> mp;
    ll m = sqrt(mod) + 1;
    ll base = B;
    for (ll i = 0; i < m; i++) { // é¢„å¤„ç†å“ˆå¸Œè¡¨ï¼šå­˜å‚¨B*A^i
        mp[base] = i;
        base = multi(base, A, mod);
    }

    ll q = qpow(A, m, mod);
    base = tmp;
    for (ll i = 1; i <= m; i++) { // æŸ¥æ‰¾ï¼štmp*A^(i*m) æ˜¯å¦åœ¨å“ˆå¸Œè¡¨ä¸­
        base = multi(base, q, mod);
        if (mp.count(base)) return i * m - mp[base] + cnt;
    }
    return -1; // æ— è§£
}

int main() {
    ll n, m, b;
    cin >> n >> m >> b;
    ll A = (2 * n - 1) % m; // åº•æ•°ï¼š2n-1
    ll B = ((b - n) % m + m) % m; // ç›®æ ‡å€¼ï¼šb-n mod m

    ll k = ex_bsgs(A, B, m);
    if (k == -1) cout << "INF" << endl;
    else cout << k << endl;
    return 0;
}
```
* **ä»£ç è§£è¯»æ¦‚è¦**ï¼š
  1. **å¿«é€Ÿä¹˜/å¿«é€Ÿå¹‚**ï¼šå¤„ç†å¤§æ•°æ¨¡è¿ç®—ï¼Œé¿å…æº¢å‡ºï¼›
  2. **æ‰©å±•BSGSå‡½æ•°**ï¼š
     - ç¬¬ä¸€æ­¥ï¼šåˆ†è§£æ¨¡æ•°ï¼ˆå¤„ç†éè´¨æ•°æƒ…å†µï¼‰ï¼›
     - ç¬¬äºŒæ­¥ï¼šé¢„å¤„ç†å“ˆå¸Œè¡¨ï¼ˆå­˜å‚¨B*A^içš„å€¼ï¼ŒåŠ å¿«æŸ¥æ‰¾ï¼‰ï¼›
     - ç¬¬ä¸‰æ­¥ï¼šæŸ¥æ‰¾æœ€å°kï¼ˆç”¨â€œå¤§æ­¥å°æ­¥â€æ³•åŒ¹é…å“ˆå¸Œè¡¨ä¸­çš„å€¼ï¼‰ï¼›
  3. **ä¸»å‡½æ•°**ï¼šè®¡ç®—åº•æ•°Aå’Œç›®æ ‡å€¼Bï¼Œè°ƒç”¨ex_bsgsæ±‚è§£ï¼Œè¾“å‡ºç»“æœã€‚


### é¢˜è§£ä¸€ï¼ˆShineEternalï¼‰æ ¸å¿ƒä»£ç èµæ
* **äº®ç‚¹**ï¼šç”¨æ‰©å±•BSGSå¤„ç†æ¨¡æ•°éè´¨æ•°ï¼Œä»£ç ä¸¥è°¨ï¼Œè¾¹ç•Œæ¡ä»¶å¤„ç†å®Œå–„ã€‚
* **æ ¸å¿ƒä»£ç ç‰‡æ®µ**ï¼ˆå¿«é€Ÿä¹˜ä¸æ‰©å±•BSGSåˆ†è§£éƒ¨åˆ†ï¼‰ï¼š
```cpp
inline long long multi(long long x, long long y, long long mod) {
    long long tmp = x*y - (long long)(((long double)x*y + 0.5)/mod)*mod;
    return tmp < 0 ? tmp+mod : tmp;
}

// æ‰©å±•BSGSåˆ†è§£æ¨¡æ•°éƒ¨åˆ†
while (true) {
    long long d = gcd(first, m);
    if (d == 1) break;
    if (b % d) { printf("INF"); return 0; }
    b /= d; m /= d; ans++;
    tmp = multi(tmp, first/d, m);
    if (tmp == b) { printf("%lld", ans); return 0; }
}
```
* **ä»£ç è§£è¯»**ï¼š
  - **å¿«é€Ÿä¹˜**ï¼šé€šè¿‡`(long double)`è®¡ç®—è¿‘ä¼¼å€¼ï¼Œå†ä¿®æ­£è¯¯å·®ï¼Œé¿å…`x*y`æº¢å‡ºï¼ˆæ¯”å¦‚å½“xå’Œyéƒ½æ˜¯1e12æ—¶ï¼Œæ™®é€šä¹˜æ³•ä¼šè¶…è¿‡long longçš„èŒƒå›´ï¼‰ï¼›
  - **åˆ†è§£æ¨¡æ•°**ï¼šæ¯æ¬¡æ‰¾åˆ°Aå’Œmçš„æœ€å¤§å…¬çº¦æ•°dï¼Œå¦‚æœBä¸èƒ½è¢«dæ•´é™¤ï¼Œç›´æ¥è¾“å‡ºINFï¼ˆæ— è§£ï¼‰ï¼›å¦åˆ™å°†Bã€mã€tmpåˆ†åˆ«é™¤ä»¥dï¼ˆæˆ–ä¹˜ä»¥A/dï¼‰ï¼Œç›´åˆ°Aå’Œmäº’è´¨ã€‚è¿™ä¸€æ­¥æ˜¯æ‰©å±•BSGSçš„æ ¸å¿ƒï¼ŒæŠŠéè´¨æ•°æ¨¡æ•°è½¬åŒ–ä¸ºè´¨æ•°æ¨¡æ•°çš„æƒ…å†µã€‚
* ğŸ’¡ **å­¦ä¹ ç¬”è®°**ï¼šå¿«é€Ÿä¹˜æ˜¯æ•°è®ºç®—æ³•çš„â€œåŸºç¡€å·¥å…·â€ï¼Œä¸€å®šè¦æŒæ¡ï¼›æ‰©å±•BSGSçš„åˆ†è§£æ­¥éª¤è¦æ³¨æ„**æ¯ä¸€æ­¥éƒ½è¦æ›´æ–°tmp**ï¼ˆå› ä¸º`A^k = tmp * A^(k - cnt)`ï¼‰ã€‚


## 5. ç®—æ³•å¯è§†åŒ–ï¼šåƒç´ åŠ¨ç”»æ¼”ç¤º (æ ¸å¿ƒéƒ¨åˆ†)

ä¸ºäº†è®©å¤§å®¶æ›´ç›´è§‚åœ°ç†è§£â€œæ•°è®ºæ¨å¯¼+æ‰©å±•BSGSâ€çš„è¿‡ç¨‹ï¼Œæˆ‘è®¾è®¡äº†ä¸€ä¸ª**8ä½åƒç´ é£çš„â€œæ•°è®ºæ¢é™©å®¶â€åŠ¨ç”»**ï¼š

### åŠ¨ç”»ä¸»é¢˜ä¸è®¾è®¡æ€è·¯
- **ä¸»é¢˜**ï¼šåƒç´ æ¢é™©å®¶åœ¨â€œæ•°è®ºå®éªŒå®¤â€ä¸­ç ´è§£â€œæ¨¡å¹‚å¯†ç é”â€ï¼Œç›®æ ‡æ˜¯æ‰¾åˆ°æœ€å°çš„kã€‚
- **è®¾è®¡æ€è·¯**ï¼šç”¨å¤å¤FCæ¸¸æˆçš„é£æ ¼é™ä½å­¦ä¹ é—¨æ§›ï¼Œç”¨**éŸ³æ•ˆ+åŠ¨ç”»**å¼ºåŒ–å…³é”®æ­¥éª¤çš„è®°å¿†ï¼ˆæ¯”å¦‚ç­‰å¼å˜å½¢æ—¶çš„â€œå®â€å£°ï¼Œæ‰¾åˆ°kæ—¶çš„â€œèƒœåˆ©éŸ³æ•ˆâ€ï¼‰ã€‚

### åŠ¨ç”»å¸§æ­¥éª¤ä¸äº¤äº’
1. **åœºæ™¯åˆå§‹åŒ–ï¼ˆ8ä½åƒç´ é£ï¼‰**ï¼š
   - å±å¹•å·¦ä¾§æ˜¯â€œé€’æ¨å¼å˜å½¢åŒºâ€ï¼ˆæ˜¾ç¤ºé¢˜ç›®ä¸­çš„é€’æ¨å¼ï¼‰ï¼Œå³ä¾§æ˜¯â€œBSGSå®éªŒå®¤â€ï¼ˆæ˜¾ç¤ºæ¨¡æ•°ã€åº•æ•°ã€ç›®æ ‡å€¼çš„åƒç´ å—ï¼‰ï¼›
   - æ§åˆ¶é¢æ¿æœ‰â€œå¼€å§‹/æš‚åœâ€â€œå•æ­¥â€â€œé‡ç½®â€æŒ‰é’®ï¼Œè¿˜æœ‰é€Ÿåº¦æ»‘å—ï¼ˆä»â€œæ…¢â€åˆ°â€œå¿«â€ï¼‰ï¼›
   - æ’­æ”¾8ä½é£æ ¼çš„èƒŒæ™¯éŸ³ä¹ï¼ˆç±»ä¼¼ã€Šè¶…çº§é©¬é‡Œå¥¥ã€‹çš„è½»æ¾æ—‹å¾‹ï¼‰ã€‚

2. **é€’æ¨å¼å˜å½¢æ¼”ç¤º**ï¼š
   - ç”¨åƒç´ å—é€è¡Œæ˜¾ç¤ºç­‰å¼å˜å½¢ï¼š`a_{n+1} - (n+1) = (âˆ›[k]{a_n -n} +2)^k` â†’ `g(n+1)-g(n)=2` â†’ `g(n)=2n-1`ï¼›
   - æ¯ä¸€æ­¥å˜å½¢æ—¶ï¼Œå¯¹åº”çš„åƒç´ å—**é—ªçƒ+æ’­æ”¾â€œå®â€çš„éŸ³æ•ˆ**ï¼Œæ—è¾¹çš„æ–‡å­—æç¤ºâ€œè¿™ä¸€æ­¥æŠŠé€’æ¨å¼å˜æˆäº†ç­‰å·®æ•°åˆ—ï¼â€ã€‚

3. **æ‰©å±•BSGSæµç¨‹æ¼”ç¤º**ï¼š
   - **åˆ†è§£æ¨¡æ•°**ï¼šæ¨¡æ•°mçš„åƒç´ å—è¢«â€œåŠˆæˆâ€ä¸¤åŠï¼ˆæ¯åˆ†è§£ä¸€æ¬¡dï¼‰ï¼ŒåŒæ—¶æ˜¾ç¤ºâ€œå½“å‰d=ï¼Ÿâ€çš„æç¤ºï¼›
   - **é¢„å¤„ç†å“ˆå¸Œè¡¨**ï¼šåƒç´ å—â€œé£å…¥â€å“ˆå¸Œè¡¨åŒºåŸŸï¼Œæ¯ä¸ªå—ä¸Šæ˜¾ç¤º`B*A^i`çš„å€¼ï¼›
   - **æŸ¥æ‰¾k**ï¼šç®­å¤´ä»â€œtmp*A^(i*m)â€æŒ‡å‘å“ˆå¸Œè¡¨ä¸­çš„åŒ¹é…å€¼ï¼ŒåŒæ—¶æ’­æ”¾â€œæ‰¾åˆ°å•¦ï¼â€çš„éŸ³æ•ˆï¼Œå±å¹•æ˜¾ç¤ºâ€œk=ï¼Ÿâ€çš„ç»“æœã€‚

4. **äº¤äº’æ§åˆ¶**ï¼š
   - **å•æ­¥æ‰§è¡Œ**ï¼šç‚¹å‡»â€œå•æ­¥â€æŒ‰é’®ï¼ŒåŠ¨ç”»èµ°ä¸€æ­¥ï¼Œæ–¹ä¾¿ä»”ç»†è§‚å¯Ÿæ¯ä¸€æ­¥ï¼›
   - **è‡ªåŠ¨æ’­æ”¾**ï¼šç‚¹å‡»â€œè‡ªåŠ¨â€æŒ‰é’®ï¼ŒåŠ¨ç”»åƒâ€œAIæ¢é™©å®¶â€ä¸€æ ·å¿«é€Ÿå®Œæˆæ‰€æœ‰æ­¥éª¤ï¼›
   - **é‡ç½®**ï¼šæ¢å¤åˆå§‹çŠ¶æ€ï¼Œé‡æ–°å¼€å§‹æ¼”ç¤ºã€‚


## 6. æ‹“å±•ç»ƒä¹ ä¸ç›¸ä¼¼é—®é¢˜æ€è€ƒ

æŒæ¡äº†â€œæ¨¡å¹‚æ–¹ç¨‹+æ‰©å±•BSGSâ€åï¼Œä½ å¯ä»¥æŒ‘æˆ˜ä»¥ä¸‹**ç›¸ä¼¼é—®é¢˜**ï¼Œå·©å›ºçŸ¥è¯†ç‚¹ï¼š

### ç›¸ä¼¼é—®é¢˜åœºæ™¯
- **åœºæ™¯1**ï¼šæ±‚æœ€å°kï¼Œä½¿å¾—`a^k â‰¡ b mod m`ï¼ˆæ¨¡æ•°méè´¨æ•°ï¼‰ï¼›
- **åœºæ™¯2**ï¼šåŠ å¯†ç®—æ³•ä¸­çš„â€œç¦»æ•£å¯¹æ•°é—®é¢˜â€ï¼ˆæ¯”å¦‚ElGamalåŠ å¯†çš„æ ¸å¿ƒï¼‰ï¼›
- **åœºæ™¯3**ï¼šæ•°åˆ—é€’æ¨å¼çš„é€šé¡¹æ¨å¯¼ï¼ˆæ¯”å¦‚ç”¨å˜é‡æ›¿æ¢ç®€åŒ–é€’æ¨ï¼‰ã€‚

### æ´›è°·æ¨èç»ƒä¹ 
1. **P3846 [TJOI2007] å¯çˆ±çš„è´¨æ•°**ï¼šBSGSæ¨¡æ¿é¢˜ï¼ˆæ¨¡æ•°æ˜¯è´¨æ•°ï¼‰ï¼Œå¸®åŠ©ä½ ç†Ÿæ‚‰åŸºç¡€BSGSçš„å®ç°ï¼›
2. **P4195 ã€æ¨¡æ¿ã€‘æ‰©å±•BSGS**ï¼šæœ¬é¢˜çš„è¿›é˜¶ç‰ˆï¼Œä¸“é—¨ç»ƒä¹ æ‰©å±•BSGSçš„ä»£ç ï¼›
3. **P2485 [SDOI2011] è®¡ç®—å™¨**ï¼šç»¼åˆé¢˜ï¼ˆåŒ…å«å¿«é€Ÿå¹‚ã€çº¿æ€§åŒä½™æ–¹ç¨‹ã€BSGSï¼‰ï¼Œè€ƒéªŒä½ å¯¹æ¨¡è¿ç®—çš„ç»¼åˆåº”ç”¨ã€‚


## 7. å­¦ä¹ å¿ƒå¾—ä¸ç»éªŒåˆ†äº« (è‹¥æœ‰)

**å‚è€ƒç»éªŒ (æ¥è‡ª ShineEternal)**ï¼šâ€œæœ¬é¢˜å› ä¸ºæ•°æ®å¾ˆæ°´ï¼Œè£¸BSGSä¹Ÿèƒ½æ‹¿80ï¼Œä½†ç”¨æ‰©å±•BSGSæ‰æ˜¯æ­£ç¡®çš„åšæ³•ã€‚â€  
**ç‚¹è¯„**ï¼šè¿™å¥è¯æé†’æˆ‘ä»¬â€”â€”**ç®—æ³•çš„ä¸¥è°¨æ€§æ¯”â€œè¿‡æ ·ä¾‹â€æ›´é‡è¦**ã€‚å³ä½¿æ•°æ®æ°´ï¼Œä¹Ÿè¦ç”¨æ­£ç¡®çš„ç®—æ³•ï¼ˆæ¯”å¦‚æ‰©å±•BSGSï¼‰å¤„ç†æ‰€æœ‰æƒ…å†µï¼Œè¿™æ ·æ‰èƒ½çœŸæ­£æŒæ¡çŸ¥è¯†ç‚¹ã€‚


## æ€»ç»“

æœ¬æ¬¡å…³äºâ€œé‡æ’DLâ€çš„åˆ†æå°±åˆ°è¿™é‡Œï¼å…³é”®çŸ¥è¯†ç‚¹æ˜¯**æ•°å­¦å˜å½¢æ¨å¯¼é€šé¡¹**å’Œ**æ‰©å±•BSGSæ±‚è§£æ¨¡å¹‚æ–¹ç¨‹**ã€‚è®°ä½ï¼šæ•°è®ºç®—æ³•çš„æ ¸å¿ƒæ˜¯â€œæ‰¾è§„å¾‹+ç”¨å·¥å…·â€â€”â€”å…ˆé€šè¿‡æ•°å­¦å˜å½¢æ‰¾åˆ°ç®€åŒ–é—®é¢˜çš„è§„å¾‹ï¼Œå†ç”¨BSGSã€å¿«é€Ÿä¹˜ç­‰å·¥å…·å®ç°ã€‚

ç¼–ç¨‹èƒ½åŠ›çš„æå‡åœ¨äº**æŒç»­ç»ƒä¹ **ï¼Œä¸‹æ¬¡æˆ‘ä»¬å†ä¸€èµ·æ¢ç´¢æ›´æœ‰è¶£çš„æ•°è®ºé—®é¢˜ï¼ğŸ’ª

---
å¤„ç†ç”¨æ—¶ï¼š76.45ç§’
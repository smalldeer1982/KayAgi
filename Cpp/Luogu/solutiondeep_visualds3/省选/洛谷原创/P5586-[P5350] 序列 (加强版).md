# é¢˜ç›®ä¿¡æ¯

# [P5350] åºåˆ— (åŠ å¼ºç‰ˆ)

## é¢˜ç›®èƒŒæ™¯

æœ¬é¢˜ä¸º [P5350](https://www.luogu.org/problem/P5350) çš„åŠ å¼ºç‰ˆã€‚  
æœ¬é¢˜å¾ˆè‰¯å¿ƒï¼Œä¸å¡ç©ºé—´ï¼  


## é¢˜ç›®æè¿°

æœ‰ä¸€ä¸ªåºåˆ— $a_n$ å’Œ $q$ æ¬¡æ“ä½œã€‚

- `1 l r` æ±‚åŒºé—´ $[l,r]$ çš„å’Œ  
- `2 l r k` åŒºé—´ $[l,r]$ èµ‹å€¼ä¸º $k$  
- `3 l r k` åŒºé—´ $[l,r]$ åŠ ä¸Š $k$  
- `4 l1 r1 l1 r2` å°†åŒºé—´ $[l_1,r_1]$ å¤åˆ¶åˆ° $[l_2,r_2]$ å¤„  
- `5 l1 r1 l2 r2` å°†åŒºé—´ $[l_1,r_1]$ ä¸ $[l_2,r_2]$ äº¤æ¢  
- `6 l r` ç¿»è½¬åŒºé—´ $[l,r]$

æœ€åè¿˜è¦è¾“å‡ºæ•´ä¸ªåºåˆ—ï¼Œæ‰€æœ‰è¾“å‡ºéƒ½è¦å¯¹ $10^9+7$ å–æ¨¡ã€‚

ä¸ºäº†å¡æ‰æŸäº›ä¹±æåšæ³•ï¼Œ**æœ¬é¢˜å¼ºåˆ¶åœ¨çº¿**ã€‚  

æ¯æ¬¡æ“ä½œä¸­ï¼Œé™¤äº†è¾“å…¥ç¬¬ä¸€ä¸ªæ•°ï¼Œå…¶å®ƒæ‰€æœ‰æ•°éƒ½éœ€è¦å¼‚æˆ– $\text{last}$ æ‰æ˜¯å®é™…çš„æ“ä½œã€‚  
$\text{last}$ ä¸ºä¸Šä¸€æ¬¡ $1$ æ“ä½œçš„ç­”æ¡ˆ $\pmod{10^9 +7}$ï¼Œå®šä¹‰åˆå§‹ $\text{last} = 0$ã€‚  


## è¯´æ˜/æç¤º

ã€æ•°æ®èŒƒå›´ã€‘   
$1\le n,q \le 3\times 10^5$  
$0\le a_i,k \le 10^9$   
å¯¹äº $4,5$ æ“ä½œï¼Œä¿è¯ $r_1-l_1 = r_2-l_2$ ä¸” $[l_1,r_1] \cap [l_2,r_2] = \varnothing$

**ä¸ä¿è¯æ•°æ®éšæœº** ä¸” **æ²¡æœ‰æ¢¯åº¦**   
æƒ³äº¤ ODT çš„å°±ç®—äº†å§ï¼

## æ ·ä¾‹ #1

### è¾“å…¥

```
10 10
7 1 3 2 2 4 0 1 2 2 
4 10 10 3 3
3 4 10 5
6 6 7
6 9 10
1 10 10
5 14 13 1 0
2 15 13 7
5 3 3 2 2
5 5 3 15 13
3 4 14 7```

### è¾“å‡º

```
7
7 0 0 0 7 7 7 1 2 7```

# AIåˆ†æç»“æœ

# ğŸ’¡ Kayçš„C++ç®—æ³•è§£æï¼šåºåˆ— (åŠ å¼ºç‰ˆ) æ·±å…¥å­¦ä¹ æŒ‡å— ğŸ’¡


## 1. é¢˜ç›®è§£è¯»ä¸æ ¸å¿ƒç®—æ³•è¯†åˆ«

âœ¨ **æœ¬é¢˜ä¸»è¦è€ƒå¯Ÿ**ï¼š`ç¼–ç¨‹æŠ€å·§åº”ç”¨`ï¼ˆä¾§é‡é«˜çº§æ•°æ®ç»“æ„â€”â€”å¯æŒä¹…åŒ–FHQ Treapçš„è®¾è®¡ä¸å®ç°ï¼‰


ğŸ—£ï¸ **åˆæ­¥åˆ†æ**ï¼š  
è§£å†³è¿™é“é¢˜çš„å…³é”®ï¼Œåœ¨äºç”¨ä¸€ç§**â€œèƒ½éšæ„æ‹†åˆ†ã€åˆå¹¶ä¸”æ”¯æŒå†å²ç‰ˆæœ¬â€çš„æœ‰åºæ•°æ®ç»“æ„**â€”â€”FHQ Treapï¼ˆæ— æ—‹Treapï¼‰ã€‚ä½ å¯ä»¥æŠŠå®ƒæƒ³è±¡æˆä¸€ä¸ªâ€œå¸¦é­”æ³•çš„æœ‰åºä¹¦æ¶â€ï¼š  
- æ¯ä¸ªèŠ‚ç‚¹æ˜¯ä¸€æœ¬â€œä¹¦â€ï¼Œä¹¦é‡Œå­˜ç€æ•°å€¼ã€å­èŠ‚ç‚¹æŒ‡é’ˆã€å¤§å°ã€æ ‡è®°ï¼ˆåŠ ã€èµ‹å€¼ã€ç¿»è½¬ï¼‰ï¼›  
- **æ‹†åˆ†ï¼ˆsplitï¼‰**ï¼šæŠŠä¹¦æ¶ä»æŒ‡å®šä½ç½®åˆ†æˆä¸¤éƒ¨åˆ†ï¼ˆæ¯”å¦‚ä»ç¬¬3æœ¬åˆ°ç¬¬5æœ¬æ‹†å‡ºæ¥ï¼‰ï¼›  
- **åˆå¹¶ï¼ˆmergeï¼‰**ï¼šæŠŠä¸¤éƒ¨åˆ†ä¹¦æ¶åˆå¹¶æˆä¸€ä¸ªå¹³è¡¡çš„æ•´ä½“ï¼›  
- **å¯æŒä¹…åŒ–**ï¼šä¿®æ”¹ä¹¦æ¶æ—¶ï¼Œä¸ç›´æ¥æ”¹åŸä¹¦ï¼Œè€Œæ˜¯å¤åˆ¶ä¸€æœ¬æ–°ä¹¦ä¿®æ”¹â€”â€”å°±åƒâ€œå†™ä½œä¸šæ—¶ç”¨å¤å°ä»¶ä¿®æ”¹ï¼ŒåŸä½œä¸šä¿æŒä¸å˜â€ï¼Œè¿™æ ·æ—§ç‰ˆæœ¬çš„ä¹¦æ¶ä¸ä¼šè¢«ç ´åã€‚  

æœ¬é¢˜çš„æ‰€æœ‰æ“ä½œï¼ˆåŒºé—´æ±‚å’Œã€èµ‹å€¼ã€åŠ ã€å¤åˆ¶ã€äº¤æ¢ã€ç¿»è½¬ï¼‰ï¼Œéƒ½å¯ä»¥é€šè¿‡â€œæ‹†åˆ†å‡ºç›®æ ‡åŒºé—´â†’å¤„ç†åŒºé—´â†’åˆå¹¶å›å»â€å®Œæˆã€‚æ ¸å¿ƒéš¾ç‚¹æ˜¯ï¼š  
1. å¦‚ä½•åœ¨ä¿®æ”¹æ—¶**ä¸ç ´ååŸæ ‘**ï¼ˆå¯æŒä¹…åŒ–çš„å®ç°ï¼‰ï¼›  
2. å¦‚ä½•æ­£ç¡®**ä¸‹ä¼ æ ‡è®°**ï¼ˆæ¯”å¦‚åŒºé—´åŠ ã€èµ‹å€¼çš„æ ‡è®°è¦ä¼ é€’ç»™å­èŠ‚ç‚¹ï¼‰ï¼›  
3. å¦‚ä½•**é«˜æ•ˆå¤åˆ¶åŒºé—´**ï¼ˆä¸èƒ½æš´åŠ›éå†å­æ ‘å¤åˆ¶ï¼‰ã€‚  

è§£å†³æ–¹æ¡ˆæ˜¯ï¼š  
- æ¯æ¬¡ä¿®æ”¹èŠ‚ç‚¹å‰**å…‹éš†ï¼ˆcloneï¼‰**è¯¥èŠ‚ç‚¹ï¼ˆå¤åˆ¶æ–°ä¹¦ï¼‰ï¼›  
- æ ‡è®°ä¸‹ä¼ ï¼ˆpushdownï¼‰æ—¶ï¼Œå…ˆå…‹éš†å­èŠ‚ç‚¹å†å¤„ç†æ ‡è®°ï¼›  
- ç”¨**å¼•ç”¨è®¡æ•°**æˆ–**å¯æŒä¹…åŒ–åˆå¹¶**å®ç°é«˜æ•ˆå¤åˆ¶ï¼ˆæ¯”å¦‚å¼•ç”¨è®¡æ•°çš„èŠ‚ç‚¹è¢«å¤åˆ¶æ—¶ï¼Œåªå¢åŠ å¼•ç”¨æ¬¡æ•°ï¼Œä¸å¤åˆ¶å†…å®¹ï¼‰ã€‚  

å¯è§†åŒ–è®¾è®¡æ€è·¯ï¼šç”¨åƒç´ åŒ–çš„â€œé­”æ³•ä¹¦æ¶â€å±•ç¤ºå¹³è¡¡æ ‘ç»“æ„ï¼Œæ‹†åˆ†æ—¶ä¹¦æ¶åˆ†æˆä¸¤éƒ¨åˆ†ï¼ˆåƒç´ å—æ»‘åŠ¨åˆ†ç¦»ï¼‰ï¼Œåˆå¹¶æ—¶åˆå¹¶ï¼ˆæ»‘åŠ¨åˆå¹¶ï¼‰ï¼Œå…‹éš†èŠ‚ç‚¹æ—¶æ˜¾ç¤ºâ€œå¤åˆ¶â€åŠ¨ç”»ï¼ˆåƒç´ ä¹¦é—ªçƒå¹¶å¤åˆ¶ä¸€ä»½ï¼‰ï¼Œæ ‡è®°ä¸‹ä¼ æ—¶ç”¨é¢œè‰²é«˜äº®ï¼ˆæ¯”å¦‚çº¢è‰²è¡¨ç¤ºåŠ æ ‡è®°ï¼Œè“è‰²è¡¨ç¤ºèµ‹å€¼æ ‡è®°ï¼‰ã€‚é…åˆâ€œå’”å—’â€ï¼ˆæ‹†åˆ†ï¼‰ã€â€œå—’â€ï¼ˆåˆå¹¶ï¼‰ã€â€œå®â€ï¼ˆå…‹éš†ï¼‰çš„åƒç´ éŸ³æ•ˆï¼ŒAIè‡ªåŠ¨æ¼”ç¤ºæ¨¡å¼ä¼šè®©â€œä¹¦æ¶ç®¡ç†å‘˜â€ï¼ˆåƒç´ å°äººï¼‰è‡ªåŠ¨å®Œæˆæ“ä½œï¼Œæ¯å®Œæˆä¸€æ­¥ç®—â€œè¿‡å…³â€ï¼Œå¢åŠ æˆå°±æ„Ÿã€‚


## 2. ç²¾é€‰ä¼˜è´¨é¢˜è§£å‚è€ƒ

### é¢˜è§£ä¸€ï¼šStar_Criedï¼ˆèµ9ï¼‰  
* **ç‚¹è¯„**ï¼šè¿™ä»½é¢˜è§£æ˜¯æœ€åŸºç¡€çš„å¯æŒä¹…åŒ–FHQ Treapå®ç°ï¼Œæ€è·¯æ¸…æ™°ï¼Œå¯¹**å…‹éš†é¡ºåºã€æ ‡è®°ä¸‹ä¼ **çš„ç»†èŠ‚è§£é‡Šå¾—å¾ˆé€å½»ã€‚ä»£ç è§„èŒƒï¼Œå˜é‡å‘½åï¼ˆå¦‚`ls`/`rs`è¡¨ç¤ºå·¦å³å­èŠ‚ç‚¹ï¼Œ`tag`è¡¨ç¤ºèµ‹å€¼æ ‡è®°ï¼‰æ˜“äºç†è§£ã€‚å…¶äº®ç‚¹æ˜¯**å®šæœŸçº¿æ€§é‡æ„**ï¼ˆå½“èŠ‚ç‚¹æ•°è¿‡å¤šæ—¶ï¼ŒæŠŠå¹³è¡¡æ ‘è½¬æˆæ•°ç»„é‡æ–°æ„å»ºï¼Œå‡å°‘ç©ºé—´å ç”¨ï¼‰ï¼Œè§£å†³äº†å¯æŒä¹…åŒ–çš„ç©ºé—´é—®é¢˜ã€‚å®è·µä»·å€¼å¾ˆé«˜ï¼Œèƒ½å¸®ä½ å¿«é€ŸæŒæ¡å¯æŒä¹…åŒ–FHQçš„æ ¸å¿ƒé€»è¾‘ã€‚


### é¢˜è§£äºŒï¼šPulsating_Dustï¼ˆèµ8ï¼‰  
* **ç‚¹è¯„**ï¼šæ­¤é¢˜è§£ç”¨**å¼•ç”¨è®¡æ•°**ä¼˜åŒ–äº†ç©ºé—´â€”â€”èŠ‚ç‚¹è¢«å¼•ç”¨æ—¶ï¼Œåªå¢åŠ è®¡æ•°ï¼Œä¸å¤åˆ¶å†…å®¹ï¼›ä¿®æ”¹æ—¶å¦‚æœå¼•ç”¨è®¡æ•°>1ï¼Œæ‰å¤åˆ¶èŠ‚ç‚¹ã€‚è¿™ç§æ–¹æ³•æŠŠç©ºé—´å¤æ‚åº¦ä»O(n log n)é™åˆ°äº†O(n)ï¼Œéå¸¸å·§å¦™ã€‚ä»£ç ä¸­çš„`Kill`å‡½æ•°ï¼ˆé€’å½’åˆ é™¤å¼•ç”¨è®¡æ•°ä¸º0çš„èŠ‚ç‚¹ï¼‰å’Œ`check`å‡½æ•°ï¼ˆæ£€æŸ¥æ˜¯å¦éœ€è¦å¤åˆ¶èŠ‚ç‚¹ï¼‰æ˜¯æ ¸å¿ƒï¼Œæ€è·¯æ–°é¢–ä¸”æœ‰æ•ˆï¼Œé€‚åˆæƒ³æ·±å…¥ä¼˜åŒ–ç©ºé—´çš„å­¦ä¹ è€…ã€‚


### é¢˜è§£ä¸‰ï¼šLeap_Frogï¼ˆèµ4ï¼‰  
* **ç‚¹è¯„**ï¼šè¿™ä»½é¢˜è§£çš„äº®ç‚¹æ˜¯**æ›´ç®€æ´çš„å…‹éš†ä¸æ ‡è®°å¤„ç†**ï¼ˆæ¯”å¦‚`Cpy`å‡½æ•°ç›´æ¥å…‹éš†èŠ‚ç‚¹ï¼Œ`pushdw`å‡½æ•°ç»Ÿä¸€å¤„ç†æ ‡è®°ä¸‹ä¼ ï¼‰ï¼Œå¹¶åŠ å…¥äº†**å†…å­˜æ± **ï¼ˆç”¨`st`æ•°ç»„å›æ”¶åºŸå¼ƒèŠ‚ç‚¹ï¼‰ï¼Œè¿›ä¸€æ­¥ä¼˜åŒ–ç©ºé—´ã€‚ä»£ç ä¸­çš„`pull`å‡½æ•°ï¼ˆæŠŠå¹³è¡¡æ ‘è½¬æˆæ•°ç»„ï¼‰å’Œ`build`å‡½æ•°ï¼ˆé‡æ–°æ„å»ºå¹³è¡¡æ ‘ï¼‰å®ç°äº†å®šæœŸé‡æ„ï¼Œè§£å†³äº†å¯æŒä¹…åŒ–çš„ç©ºé—´çˆ†ç‚¸é—®é¢˜ã€‚è™½ç„¶ä»£ç æœ‰ç‚¹é•¿ï¼Œä½†é€»è¾‘æ¸…æ™°ï¼Œé€‚åˆå­¦ä¹ å¦‚ä½•å¤„ç†å¤§è§„æ¨¡æ•°æ®çš„ç©ºé—´é—®é¢˜ã€‚


## 3. æ ¸å¿ƒéš¾ç‚¹è¾¨æä¸è§£é¢˜ç­–ç•¥

### 1. éš¾ç‚¹1ï¼šå¯æŒä¹…åŒ–çš„å®ç°ï¼ˆä¿®æ”¹ä¸å½±å“åŸæ ‘ï¼‰  
**åˆ†æ**ï¼šå¯æŒä¹…åŒ–è¦æ±‚ä¿®æ”¹æ—¶ä¸èƒ½æ”¹åŸèŠ‚ç‚¹ï¼Œå¿…é¡»å¤åˆ¶èŠ‚ç‚¹ã€‚å¦‚æœç›´æ¥ä¿®æ”¹åŸèŠ‚ç‚¹ï¼Œä¼šå¯¼è‡´æ‰€æœ‰å¼•ç”¨è¯¥èŠ‚ç‚¹çš„å†å²ç‰ˆæœ¬éƒ½è¢«æ”¹å˜â€”â€”å°±åƒä½ æ”¹äº†åŸä½œä¸šï¼Œæ‰€æœ‰å¤å°ä»¶éƒ½å˜æˆäº†ä¿®æ”¹åçš„å†…å®¹ï¼Œè¿™æ˜¯é”™è¯¯çš„ã€‚  
**ç­–ç•¥**ï¼šæ¯æ¬¡ä¿®æ”¹èŠ‚ç‚¹å‰ï¼Œå…ˆå…‹éš†ï¼ˆcloneï¼‰è¯¥èŠ‚ç‚¹ï¼ˆå¤åˆ¶æ–°ä¹¦ï¼‰ã€‚æ¯”å¦‚Star_Criedçš„ä»£ç ä¸­ï¼Œ`clone`å‡½æ•°ä¼šå¤åˆ¶èŠ‚ç‚¹çš„æ‰€æœ‰ä¿¡æ¯ï¼Œä¿®æ”¹å…‹éš†åçš„èŠ‚ç‚¹ï¼ŒåŸèŠ‚ç‚¹ä¿æŒä¸å˜ã€‚


### 2. éš¾ç‚¹2ï¼šæ ‡è®°ä¸‹ä¼ çš„æ­£ç¡®æ€§ï¼ˆä¿è¯åŒºé—´æ“ä½œæœ‰æ•ˆï¼‰  
**åˆ†æ**ï¼šåŒºé—´æ“ä½œï¼ˆå¦‚åŒºé—´åŠ ã€èµ‹å€¼ã€ç¿»è½¬ï¼‰ä¼šç»™èŠ‚ç‚¹æ‰“æ ‡è®°ï¼Œä½†æ ‡è®°éœ€è¦ä¼ é€’ç»™å­èŠ‚ç‚¹æ‰èƒ½ç”Ÿæ•ˆã€‚æ¯”å¦‚ä½ ç»™â€œç¬¬3-5æœ¬ä¹¦â€æ‰“äº†â€œåŠ 10â€çš„æ ‡ç­¾ï¼Œå¿…é¡»æŠŠè¿™ä¸ªæ ‡ç­¾ä¼ é€’ç»™ç¬¬3ã€4ã€5æœ¬ä¹¦çš„å­èŠ‚ç‚¹ï¼Œå¦åˆ™å­èŠ‚ç‚¹çš„æ•°å€¼ä¸ä¼šæ›´æ–°ã€‚  
**ç­–ç•¥**ï¼šä¸‹ä¼ æ ‡è®°ï¼ˆpushdownï¼‰æ—¶ï¼Œå…ˆå…‹éš†å­èŠ‚ç‚¹ï¼Œå†å¤„ç†æ ‡è®°ã€‚æ¯”å¦‚Pulsating_Dustçš„ä»£ç ä¸­ï¼Œ`pushdown`å‡½æ•°ä¼šå…ˆæ£€æŸ¥æ˜¯å¦éœ€è¦å…‹éš†å­èŠ‚ç‚¹ï¼Œå†æŠŠæ ‡è®°ä¼ é€’ç»™å­èŠ‚ç‚¹ã€‚


### 3. éš¾ç‚¹3ï¼šé«˜æ•ˆå¤åˆ¶åŒºé—´ï¼ˆä¸èƒ½æš´åŠ›éå†ï¼‰  
**åˆ†æ**ï¼šå¦‚æœç›´æ¥éå†åŒºé—´å­æ ‘å¤åˆ¶æ¯ä¸ªèŠ‚ç‚¹ï¼Œæ—¶é—´å¤æ‚åº¦æ˜¯O(k)ï¼ˆkæ˜¯åŒºé—´é•¿åº¦ï¼‰ï¼Œå¯¹äºå¤§åŒºé—´ä¼šè¶…æ—¶ã€‚æ¯”å¦‚å¤åˆ¶ä¸€ä¸ªé•¿åº¦ä¸º1e5çš„åŒºé—´ï¼Œæš´åŠ›å¤åˆ¶éœ€è¦1e5æ¬¡æ“ä½œï¼Œå¤ªæ…¢äº†ã€‚  
**ç­–ç•¥**ï¼šç”¨**å¼•ç”¨è®¡æ•°**æˆ–**å¯æŒä¹…åŒ–åˆå¹¶**ã€‚æ¯”å¦‚Pulsating_Dustçš„å¼•ç”¨è®¡æ•°ï¼šå¤åˆ¶åŒºé—´æ—¶ï¼Œåªå¢åŠ è¯¥åŒºé—´æ ¹èŠ‚ç‚¹çš„å¼•ç”¨æ¬¡æ•°ï¼Œä¸å¤åˆ¶å†…å®¹ï¼›å½“å¼•ç”¨è®¡æ•°>1æ—¶ï¼Œä¿®æ”¹æ‰å¤åˆ¶èŠ‚ç‚¹ã€‚è¿™æ ·å¤åˆ¶æ“ä½œçš„æ—¶é—´å¤æ‚åº¦æ˜¯O(log n)ï¼ˆæ‹†åˆ†åˆå¹¶çš„æ—¶é—´ï¼‰ã€‚


### âœ¨ è§£é¢˜æŠ€å·§æ€»ç»“  
- **å¯æŒä¹…åŒ–çš„æ ¸å¿ƒ**ï¼šä¿®æ”¹å‰å…‹éš†èŠ‚ç‚¹ï¼Œä¸ç¢°åŸèŠ‚ç‚¹ã€‚  
- **æ ‡è®°ä¸‹ä¼ çš„é¡ºåº**ï¼šå…ˆå…‹éš†å­èŠ‚ç‚¹ï¼Œå†å¤„ç†æ ‡è®°ã€‚  
- **ç©ºé—´ä¼˜åŒ–çš„æ–¹æ³•**ï¼šå®šæœŸçº¿æ€§é‡æ„ï¼ˆæŠŠæ ‘è½¬æˆæ•°ç»„é‡æ–°æ„å»ºï¼‰ã€å¼•ç”¨è®¡æ•°ï¼ˆå‡å°‘å¤åˆ¶æ¬¡æ•°ï¼‰ã€å†…å­˜æ± ï¼ˆå›æ”¶åºŸå¼ƒèŠ‚ç‚¹ï¼‰ã€‚  


## 4. C++æ ¸å¿ƒä»£ç å®ç°èµæ

### æœ¬é¢˜é€šç”¨æ ¸å¿ƒC++å®ç°å‚è€ƒ  
* **è¯´æ˜**ï¼šç»¼åˆStar_Criedå’ŒPulsating_Dustçš„æ€è·¯ï¼Œæç‚¼å‡ºçš„å¯æŒä¹…åŒ–FHQ Treapæ ¸å¿ƒå®ç°ï¼ŒåŒ…å«åŸºæœ¬çš„splitã€mergeã€æ ‡è®°ä¸‹ä¼ å’Œå®šæœŸé‡æ„ã€‚  
* **å®Œæ•´æ ¸å¿ƒä»£ç **ï¼š  
```cpp
#include <iostream>
#include <cstdlib>
#include <vector>
using namespace std;
typedef long long ll;
const int MOD = 1e9 + 7, MAXN = 3e5 + 50;

struct Node {
    ll sum, val;
    int ls, rs, siz, rev;
    ll add; int set;
    int ref; // å¼•ç”¨è®¡æ•°
} tr[MAXN];
int cnt = 0, root = 0;
int bin[MAXN], top = 0; // å†…å­˜æ± 

int newid() { return top ? bin[top--] : ++cnt; }
void delid(int id) { bin[++top] = id; }

int newnode(ll val) {
    int id = newid();
    tr[id] = {val, val, 0, 0, 1, 0, 0, -1, 1};
    return id;
}

#define ls tr[rt].ls
#define rs tr[rt].rs
void pushup(int rt) {
    tr[rt].siz = tr[ls].siz + tr[rs].siz + 1;
    tr[rt].sum = (tr[ls].sum + tr[rs].sum + tr[rt].val) % MOD;
}

void rev(int rt) { if (rt) swap(ls, rs), tr[rt].rev ^= 1; }
void add(int rt, ll v) {
    if (rt) tr[rt].val = (tr[rt].val + v) % MOD, tr[rt].sum = (tr[rt].sum + tr[rt].siz * v) % MOD, tr[rt].add += v;
}
void set_val(int rt, int v) {
    if (rt) tr[rt].val = v, tr[rt].sum = (ll)tr[rt].siz * v % MOD, tr[rt].add = 0, tr[rt].set = v;
}

void check(int &rt) { // æ£€æŸ¥æ˜¯å¦éœ€è¦å…‹éš†
    if (tr[rt].ref > 1) {
        int id = newid();
        tr[id] = tr[rt]; tr[id].ref = 1;
        tr[rt].ref--; rt = id;
        if (ls) tr[ls].ref++;
        if (rs) tr[rs].ref++;
    }
}

void pushdown(int &rt) {
    if (!tr[rt].rev && tr[rt].set == -1 && tr[rt].add == 0) return;
    check(rt); // å…ˆæ£€æŸ¥æ˜¯å¦éœ€è¦å…‹éš†
    if (ls) check(ls); if (rs) check(rs);
    if (tr[rt].rev) rev(ls), rev(rs), tr[rt].rev = 0;
    if (tr[rt].set != -1) set_val(ls, tr[rt].set), set_val(rs, tr[rt].set), tr[rt].set = -1;
    if (tr[rt].add) add(ls, tr[rt].add), add(rs, tr[rt].add), tr[rt].add = 0;
}

int merge(int a, int b) {
    if (!a || !b) return a | b;
    pushdown(a); pushdown(b);
    if (rand() % (tr[a].siz + tr[b].siz) < tr[a].siz) {
        tr[a].rs = merge(tr[a].rs, b);
        pushup(a); return a;
    } else {
        tr[b].ls = merge(a, tr[b].ls);
        pushup(b); return b;
    }
}

void split(int rt, int k, int &a, int &b) {
    if (!rt) { a = b = 0; return; }
    pushdown(rt);
    if (tr[ls].siz < k) {
        a = rt; split(tr[a].rs, k - tr[ls].siz - 1, tr[a].rs, b);
        pushup(a);
    } else {
        b = rt; split(tr[b].ls, k, a, tr[b].ls);
        pushup(b);
    }
}

vector<ll> arr;
void pull(int rt) { // æ ‘è½¬æ•°ç»„
    if (!rt) return;
    pushdown(rt);
    pull(ls); arr.push_back(tr[rt].val); pull(rs);
}

int build(int l, int r) { // æ•°ç»„å»ºæ ‘
    if (l > r) return 0;
    int mid = (l + r) / 2;
    int rt = newnode(arr[mid]);
    tr[rt].ls = build(l, mid - 1);
    tr[rt].rs = build(mid + 1, r);
    pushup(rt);
    return rt;
}

void periodic_rebuild() { // å®šæœŸé‡æ„
    arr.clear(); pull(root);
    cnt = top = 0; root = build(0, arr.size() - 1);
}

int main() {
    srand(114514);
    int n, q; cin >> n >> q;
    arr.resize(n);
    for (int i = 0; i < n; i++) cin >> arr[i];
    root = build(0, n - 1);
    
    ll last = 0;
    while (q--) {
        int op; cin >> op;
        int l, r; cin >> l >> r; l ^= last; r ^= last;
        if (op == 1) { // æ±‚å’Œ
            int a, b, c;
            split(root, r, b, c); split(b, l - 1, a, b);
            last = tr[b].sum % MOD;
            cout << last << endl;
            root = merge(merge(a, b), c);
        } else if (op == 2) { // èµ‹å€¼
            ll k; cin >> k; k ^= last;
            int a, b, c;
            split(root, r, b, c); split(b, l - 1, a, b);
            check(b); set_val(b, k);
            root = merge(merge(a, b), c);
        } else if (op == 3) { // åŠ 
            ll k; cin >> k; k ^= last;
            int a, b, c;
            split(root, r, b, c); split(b, l - 1, a, b);
            check(b); add(b, k);
            root = merge(merge(a, b), c);
        } // å…¶ä»–æ“ä½œç±»ä¼¼ï¼Œçœç•¥...
        
        if (cnt > 3e6) periodic_rebuild(); // å®šæœŸé‡æ„
    }
    arr.clear(); pull(root);
    for (ll x : arr) cout << x % MOD << " ";
    return 0;
}
```
* **ä»£ç è§£è¯»æ¦‚è¦**ï¼š  
  1. **æ•°æ®ç»“æ„**ï¼š`Node`ç»“æ„ä½“å­˜å‚¨å¹³è¡¡æ ‘èŠ‚ç‚¹ä¿¡æ¯ï¼ˆsumã€valã€å­èŠ‚ç‚¹ã€å¤§å°ã€æ ‡è®°ã€å¼•ç”¨è®¡æ•°ï¼‰ï¼›  
  2. **æ ¸å¿ƒæ“ä½œ**ï¼š`split`ï¼ˆæ‹†åˆ†æ ‘ï¼‰ã€`merge`ï¼ˆåˆå¹¶æ ‘ï¼‰ã€`pushup`ï¼ˆæ›´æ–°èŠ‚ç‚¹ä¿¡æ¯ï¼‰ã€`pushdown`ï¼ˆä¸‹ä¼ æ ‡è®°ï¼‰ï¼›  
  3. **ç©ºé—´ä¼˜åŒ–**ï¼š`newid`/`delid`ç”¨å†…å­˜æ± å›æ”¶èŠ‚ç‚¹ï¼Œ`periodic_rebuild`å®šæœŸé‡æ„æ ‘ï¼ˆå‡å°‘èŠ‚ç‚¹æ•°ï¼‰ï¼›  
  4. **å¯æŒä¹…åŒ–**ï¼š`check`å‡½æ•°åœ¨ä¿®æ”¹å‰å…‹éš†èŠ‚ç‚¹ï¼Œ`pushdown`æ—¶å…ˆå…‹éš†å­èŠ‚ç‚¹å†å¤„ç†æ ‡è®°ã€‚


### é¢˜è§£ä¸€ï¼šStar_Criedçš„æ ¸å¿ƒç‰‡æ®µèµæ  
* **äº®ç‚¹**ï¼š**å®šæœŸçº¿æ€§é‡æ„**è§£å†³ç©ºé—´é—®é¢˜ã€‚  
* **æ ¸å¿ƒä»£ç ç‰‡æ®µ**ï¼š  
```cpp
inline void push(int ro){
    if(!ro)return;
    pushdown(ro);
    push(ls),a[++n]=e[ro].val,push(rs);
}
// å®šæœŸé‡æ„çš„è°ƒç”¨ï¼š
if(S.tot>3600000) n=0,
S.push(S.rt),S.rt=S.tot=0,
S.rt=S.build();
```
* **ä»£ç è§£è¯»**ï¼š  
  è¿™æ®µä»£ç å®ç°äº†**æ ‘è½¬æ•°ç»„**ï¼ˆ`push`å‡½æ•°ï¼‰å’Œ**æ•°ç»„å»ºæ ‘**ï¼ˆ`build`å‡½æ•°ï¼‰ã€‚å½“èŠ‚ç‚¹æ•°è¶…è¿‡3.6e6æ—¶ï¼ŒæŠŠå¹³è¡¡æ ‘éå†æˆæ•°ç»„ï¼ˆ`push`ï¼‰ï¼Œç„¶åæ¸…ç©ºèŠ‚ç‚¹ï¼Œç”¨æ•°ç»„é‡æ–°æ„å»ºå¹³è¡¡æ ‘ï¼ˆ`build`ï¼‰ã€‚è¿™æ ·å¯ä»¥æŠŠèŠ‚ç‚¹æ•°ä»3.6e6å‡å°‘åˆ°nï¼ˆåŸåºåˆ—é•¿åº¦ï¼‰ï¼Œè§£å†³ç©ºé—´çˆ†ç‚¸é—®é¢˜ã€‚æ¯”å¦‚ï¼Œå½“ä½ ä¹¦æ¶çš„ä¹¦å¤ªå¤šæ—¶ï¼ŒæŠŠä¹¦å…¨éƒ¨æ‹¿å‡ºæ¥é‡æ–°æ‘†æˆæ•´é½çš„ä¹¦æ¶ï¼ŒèŠ‚çœç©ºé—´ã€‚  
* **å­¦ä¹ ç¬”è®°**ï¼šå®šæœŸçº¿æ€§é‡æ„æ˜¯å¤„ç†å¯æŒä¹…åŒ–ç©ºé—´é—®é¢˜çš„â€œç»ˆææ­¦å™¨â€ï¼Œé€‚ç”¨äºèŠ‚ç‚¹æ•°è¿‡å¤šçš„åœºæ™¯ã€‚


### é¢˜è§£äºŒï¼šPulsating_Dustçš„æ ¸å¿ƒç‰‡æ®µèµæ  
* **äº®ç‚¹**ï¼š**å¼•ç”¨è®¡æ•°**ä¼˜åŒ–ç©ºé—´ã€‚  
* **æ ¸å¿ƒä»£ç ç‰‡æ®µ**ï¼š  
```cpp
inline void Kill(int rt){
    if(!rt) return;
    if(tr[rt].ref>1) return --tr[rt].ref,void();
    Kill(ls),Kill(rs),delid(rt);
}
void Copy(int l1,int r1,int l2,int r2){
    // æ‹†åˆ†å‡ºåŒºé—´åï¼š
    tr[w].ref++;
    if(tr[y].ref>1) --tr[y].ref; else Kill(y);
}
```
* **ä»£ç è§£è¯»**ï¼š  
  `Kill`å‡½æ•°é€’å½’åˆ é™¤å¼•ç”¨è®¡æ•°ä¸º0çš„èŠ‚ç‚¹ï¼ˆå›æ”¶å†…å­˜ï¼‰ã€‚`Copy`å‡½æ•°å¤åˆ¶åŒºé—´æ—¶ï¼Œåªå¢åŠ æºåŒºé—´æ ¹èŠ‚ç‚¹çš„å¼•ç”¨è®¡æ•°ï¼ˆ`tr[w].ref++`ï¼‰ï¼Œå‡å°‘ç›®æ ‡åŒºé—´æ ¹èŠ‚ç‚¹çš„å¼•ç”¨è®¡æ•°ï¼ˆ`--tr[y].ref`ï¼‰ï¼Œå¦‚æœå¼•ç”¨è®¡æ•°ä¸º0åˆ™åˆ é™¤ï¼ˆ`Kill(y)`ï¼‰ã€‚è¿™æ ·å¤åˆ¶æ“ä½œçš„æ—¶é—´å¤æ‚åº¦æ˜¯O(log n)ï¼Œä¸ç”¨éå†å­æ ‘ã€‚æ¯”å¦‚ï¼Œä½ å¤åˆ¶ä¸€æœ¬ä¹¦æ—¶ï¼Œåªåœ¨ä¹¦çš„å°é¢ä¸Šå†™â€œå¼•ç”¨+1â€ï¼Œä¸ç”¨é‡æ–°å†™ä¸€æœ¬ä¹¦ã€‚  
* **å­¦ä¹ ç¬”è®°**ï¼šå¼•ç”¨è®¡æ•°æ˜¯â€œç”¨æ—¶é—´æ¢ç©ºé—´â€çš„ç»å…¸æŠ€å·§ï¼Œé€‚åˆéœ€è¦é¢‘ç¹å¤åˆ¶çš„åœºæ™¯ã€‚


## 5. ç®—æ³•å¯è§†åŒ–ï¼šåƒç´ é­”æ³•ä¹¦æ¶

### åŠ¨ç”»æ¼”ç¤ºä¸»é¢˜  
**â€œåƒç´ ä¹¦æ¶ç®¡ç†å‘˜â€çš„é­”æ³•æ“ä½œ**â€”â€”ç”¨8ä½åƒç´ é£å±•ç¤ºå¯æŒä¹…åŒ–FHQ Treapçš„åŒºé—´æ“ä½œï¼Œèå…¥å¤å¤æ¸¸æˆå…ƒç´ ã€‚


### è®¾è®¡æ€è·¯  
é‡‡ç”¨FCæ¸¸æˆçš„åƒç´ é£æ ¼ï¼ˆæ¯”å¦‚ã€Šè¶…çº§é©¬é‡Œå¥¥ã€‹çš„ç”»é¢ï¼‰ï¼Œç”¨åƒç´ å—è¡¨ç¤ºå¹³è¡¡æ ‘èŠ‚ç‚¹ï¼ˆâ€œä¹¦â€ï¼‰ï¼Œé¢œè‰²åŒºåˆ†çŠ¶æ€ï¼ˆç»¿è‰²=æ­£å¸¸ï¼Œçº¢è‰²=è¢«ä¿®æ”¹ï¼Œè“è‰²=è¢«å¼•ç”¨ï¼‰ã€‚é…åˆåƒç´ éŸ³æ•ˆï¼ˆæ¯”å¦‚â€œå’”å—’â€=æ‹†åˆ†ï¼Œâ€œå—’â€=åˆå¹¶ï¼Œâ€œå®â€=å…‹éš†ï¼‰ï¼ŒAIè‡ªåŠ¨æ¼”ç¤ºæ¨¡å¼è®©â€œä¹¦æ¶ç®¡ç†å‘˜â€ï¼ˆåƒç´ å°äººï¼‰è‡ªåŠ¨å®Œæˆæ“ä½œï¼Œæ¯å®Œæˆä¸€æ­¥ç®—â€œå°å…³å¡â€ï¼Œå¢åŠ æˆå°±æ„Ÿã€‚


### åŠ¨ç”»å¸§æ­¥éª¤ä¸äº¤äº’  
1. **åœºæ™¯åˆå§‹åŒ–**ï¼š  
   - å±å¹•å·¦ä¾§æ˜¯åƒç´ åŒ–çš„â€œé­”æ³•ä¹¦æ¶â€ï¼ˆå¹³è¡¡æ ‘ï¼‰ï¼Œå³ä¾§æ˜¯â€œæ§åˆ¶é¢æ¿â€ï¼ˆå¼€å§‹/æš‚åœã€å•æ­¥ã€é‡ç½®æŒ‰é’®ï¼Œé€Ÿåº¦æ»‘å—ï¼‰ã€‚  
   - èƒŒæ™¯æ’­æ”¾8ä½é£æ ¼çš„è½»æ¾BGMï¼ˆæ¯”å¦‚ã€Šå¦å…‹å¤§æˆ˜ã€‹çš„èƒŒæ™¯éŸ³ä¹ï¼‰ã€‚  
2. **ç®—æ³•å¯åŠ¨**ï¼š  
   - è¾“å…¥åºåˆ—åˆå§‹åŒ–ï¼šä¹¦æ¶ä¸Šçš„ä¹¦æŒ‰é¡ºåºæ’åˆ—ï¼ˆåƒç´ å—ä»å·¦åˆ°å³æ’åˆ—ï¼‰ã€‚  
3. **æ ¸å¿ƒæ“ä½œæ¼”ç¤º**ï¼š  
   - **æ‹†åˆ†ï¼ˆsplitï¼‰**ï¼šç‚¹å‡»â€œå•æ­¥â€ï¼Œä¹¦æ¶ä»æŒ‡å®šä½ç½®åˆ†æˆä¸¤éƒ¨åˆ†ï¼ˆåƒç´ å—å‘å·¦å³æ»‘åŠ¨ï¼‰ï¼Œä¼´éšâ€œå’”å—’â€éŸ³æ•ˆã€‚  
   - **åˆå¹¶ï¼ˆmergeï¼‰**ï¼šä¸¤éƒ¨åˆ†ä¹¦æ¶æ»‘åŠ¨åˆå¹¶ï¼Œä¼´éšâ€œå—’â€éŸ³æ•ˆã€‚  
   - **å…‹éš†ï¼ˆcloneï¼‰**ï¼šè¢«ä¿®æ”¹çš„ä¹¦é—ªçƒå¹¶å¤åˆ¶ä¸€ä»½ï¼ˆåƒç´ å—å¤åˆ¶ä¸€ä»½ï¼‰ï¼Œä¼´éšâ€œå®â€éŸ³æ•ˆã€‚  
   - **æ ‡è®°ä¸‹ä¼ **ï¼šè¢«æ ‡è®°çš„ä¹¦ï¼ˆæ¯”å¦‚çº¢è‰²çš„åŠ æ ‡è®°ï¼‰ä¼šæŠŠé¢œè‰²ä¼ é€’ç»™å­ä¹¦ï¼ˆå­åƒç´ å—å˜çº¢ï¼‰ï¼Œä¼´éšâ€œå—¡â€éŸ³æ•ˆã€‚  
4. **AIè‡ªåŠ¨æ¼”ç¤º**ï¼š  
   - ç‚¹å‡»â€œAIæ¼”ç¤ºâ€ï¼Œä¹¦æ¶ç®¡ç†å‘˜ï¼ˆåƒç´ å°äººï¼‰è‡ªåŠ¨å®Œæˆæ“ä½œï¼šæ‹†åˆ†â†’å¤„ç†â†’åˆå¹¶ï¼Œæ¯å®Œæˆä¸€æ­¥ï¼Œå±å¹•ä¸‹æ–¹æ˜¾ç¤ºâ€œå…³å¡å®Œæˆï¼+10åˆ†â€ï¼Œä¼´éšâ€œå®~â€çš„èƒœåˆ©éŸ³æ•ˆã€‚  
5. **ç»“æœå±•ç¤º**ï¼š  
   - æ“ä½œå®Œæˆåï¼Œä¹¦æ¶æ˜¾ç¤ºæœ€ç»ˆåºåˆ—ï¼Œä¼´éšâ€œèƒœåˆ©â€éŸ³ä¹ï¼ˆæ¯”å¦‚ã€Šé­‚æ–—ç½—ã€‹çš„é€šå…³éŸ³ä¹ï¼‰ã€‚


### æŠ€æœ¯å®ç°  
ç”¨HTML+CSS+JavaScriptï¼ˆCanvas APIï¼‰å®ç°ï¼š  
- åƒç´ å—ç”¨`fillRect`ç»˜åˆ¶ï¼Œé¢œè‰²ç”¨RGBå€¼ï¼ˆæ¯”å¦‚ç»¿è‰²`#0f0`ï¼Œçº¢è‰²`#f00`ï¼‰ã€‚  
- éŸ³æ•ˆç”¨Web Audio APIæ’­æ”¾é¢„å…ˆå½•åˆ¶çš„8ä½éŸ³æ•ˆï¼ˆæ¯”å¦‚æ‹†åˆ†çš„â€œå’”å—’â€å£°ï¼‰ã€‚  
- äº¤äº’ç”¨`addEventListener`å¤„ç†æŒ‰é’®ç‚¹å‡»ï¼Œ`requestAnimationFrame`å®ç°åŠ¨ç”»å¸§ã€‚


## 6. æ‹“å±•ç»ƒä¹ ä¸ç›¸ä¼¼é—®é¢˜æ€è€ƒ

### é€šç”¨æ€è·¯è¿ç§»  
å¯æŒä¹…åŒ–FHQ Treapçš„æ€è·¯å¯ä»¥è¿ç§»åˆ°**éœ€è¦å†å²ç‰ˆæœ¬æŸ¥è¯¢**æˆ–**é«˜æ•ˆåŒºé—´æ“ä½œ**çš„é—®é¢˜ï¼Œæ¯”å¦‚ï¼š  
1. ç¼–è¾‘å™¨çš„â€œæ’¤é”€/é‡åšâ€åŠŸèƒ½ï¼ˆä¿å­˜æ¯ä¸ªç‰ˆæœ¬çš„æ–‡æ¡£æ ‘ï¼‰ï¼›  
2. åŒºé—´ä¿®æ”¹+å†å²ç‰ˆæœ¬æŸ¥è¯¢çš„é—®é¢˜ï¼ˆæ¯”å¦‚æŸ¥è¯¢ç¬¬kæ¬¡æ“ä½œåçš„åŒºé—´å’Œï¼‰ï¼›  
3. é«˜æ•ˆå¤åˆ¶åŒºé—´çš„é—®é¢˜ï¼ˆæ¯”å¦‚æœ¬é¢˜çš„å¤åˆ¶æ“ä½œï¼‰ã€‚


### æ´›è°·æ¨èç»ƒä¹   
1. **P5055 ã€æ¨¡æ¿ã€‘å¯æŒä¹…åŒ–æ–‡è‰ºå¹³è¡¡æ ‘**ï¼š  
   ç»ƒä¹ å¯æŒä¹…åŒ–å¹³è¡¡æ ‘çš„åŸºç¡€æ“ä½œï¼ˆæ’å…¥ã€åˆ é™¤ã€ç¿»è½¬ã€æŸ¥è¯¢ï¼‰ï¼Œæ˜¯æœ¬é¢˜çš„â€œæ¨¡æ¿å‰ç½®é¢˜â€ã€‚  
2. **P5350 åºåˆ—**ï¼š  
   æœ¬é¢˜çš„åŸç‰ˆï¼Œæ“ä½œç›¸åŒä½†æ•°æ®èŒƒå›´è¾ƒå°ï¼Œé€‚åˆå…¥é—¨ã€‚  
3. **P3391 ã€æ¨¡æ¿ã€‘æ–‡è‰ºå¹³è¡¡æ ‘**ï¼š  
   ç»ƒä¹ å¹³è¡¡æ ‘çš„ç¿»è½¬æ“ä½œï¼Œæ˜¯æœ¬é¢˜ç¿»è½¬æ“ä½œçš„åŸºç¡€ã€‚  
4. **P5586 åºåˆ— (åŠ å¼ºç‰ˆ)**ï¼š  
   æœ¬é¢˜çš„åŠ å¼ºç‰ˆï¼Œæ•°æ®èŒƒå›´æ›´å¤§ï¼Œå¼ºåˆ¶åœ¨çº¿ï¼Œé€‚åˆæ£€éªŒèƒ½åŠ›ã€‚


## 7. å­¦ä¹ å¿ƒå¾—ä¸ç»éªŒåˆ†äº«

### å‚è€ƒç»éªŒï¼ˆæ¥è‡ªStar_Criedï¼‰  
> â€œæˆ‘åœ¨è§£å†³è¿™ä¸ªé—®é¢˜æ—¶ï¼Œæœ€åˆåœ¨`pushdown`çš„é¡ºåºä¸Šå¡äº†å¾ˆä¹…â€”â€”ä¹‹å‰å…ˆä¸‹ä¼ æ ‡è®°å†å…‹éš†å­èŠ‚ç‚¹ï¼Œå¯¼è‡´åŸèŠ‚ç‚¹çš„å­èŠ‚ç‚¹è¢«ä¿®æ”¹ï¼Œç ´åäº†åŸæ ‘ã€‚åæ¥æ”¹æˆå…ˆå…‹éš†å­èŠ‚ç‚¹å†ä¸‹ä¼ æ ‡è®°ï¼Œæ‰è§£å†³äº†é—®é¢˜ã€‚â€  
**ç‚¹è¯„**ï¼šè¿™ä¸ªç»éªŒå¾ˆé‡è¦ï¼æ ‡è®°ä¸‹ä¼ çš„é¡ºåºç›´æ¥å½±å“å¯æŒä¹…åŒ–çš„æ­£ç¡®æ€§ã€‚ä¸€å®šè¦å…ˆå…‹éš†å­èŠ‚ç‚¹ï¼Œå†å¤„ç†æ ‡è®°ï¼Œå¦åˆ™åŸæ ‘ä¼šè¢«ä¿®æ”¹ã€‚


### å‚è€ƒç»éªŒï¼ˆæ¥è‡ªPulsating_Dustï¼‰  
> â€œå¼•ç”¨è®¡æ•°çš„æ€è·¯æ¥è‡ªå­—ç¬¦ä¸²çš„å…±äº«å†…å­˜ï¼ˆæ¯”å¦‚å¤šä¸ªå­—ç¬¦ä¸²å…±äº«ç›¸åŒçš„å‰ç¼€ï¼‰ï¼ŒæŠŠå®ƒç”¨åˆ°å¹³è¡¡æ ‘ä¸­ï¼Œå°±èƒ½å‡å°‘å¤åˆ¶æ¬¡æ•°ï¼Œä¼˜åŒ–ç©ºé—´ã€‚â€  
**ç‚¹è¯„**ï¼šè·¨é¢†åŸŸçš„æ€è·¯è¿ç§»æ˜¯ç¼–ç¨‹çš„â€œç§˜è¯€â€ï¼æ¯”å¦‚æŠŠå­—ç¬¦ä¸²çš„å…±äº«å†…å­˜ç”¨åˆ°å¹³è¡¡æ ‘ï¼Œå°±èƒ½è§£å†³ç©ºé—´é—®é¢˜ã€‚


## ğŸ’ª ç»“è¯­  
æœ¬æ¬¡å…³äºâ€œåºåˆ— (åŠ å¼ºç‰ˆ)â€çš„åˆ†æå°±åˆ°è¿™é‡Œã€‚å¯æŒä¹…åŒ–FHQ Treapæ˜¯ä¸€ç§â€œé«˜çº§é­”æ³•ä¹¦æ¶â€ï¼Œèƒ½å¸®ä½ é«˜æ•ˆå¤„ç†å„ç§åŒºé—´æ“ä½œã€‚è®°ä½ï¼š**å¯æŒä¹…åŒ–çš„æ ¸å¿ƒæ˜¯â€œå¤åˆ¶ä¸ä¿®æ”¹åŸèŠ‚ç‚¹â€ï¼Œç©ºé—´ä¼˜åŒ–çš„å…³é”®æ˜¯â€œå‡å°‘ä¸å¿…è¦çš„å¤åˆ¶â€**ã€‚å¤šç»ƒä¹ æ¨¡æ¿é¢˜ï¼Œå¤šæ€è€ƒæ€è·¯è¿ç§»ï¼Œä½ ä¸€å®šèƒ½æŒæ¡è¿™ç§é«˜çº§æ•°æ®ç»“æ„ï¼  

ä¸‹æ¬¡æˆ‘ä»¬å†ä¸€èµ·æ¢ç´¢æ›´æœ‰è¶£çš„ç®—æ³•æŒ‘æˆ˜ï½ ğŸ˜Š

---
å¤„ç†ç”¨æ—¶ï¼š117.09ç§’
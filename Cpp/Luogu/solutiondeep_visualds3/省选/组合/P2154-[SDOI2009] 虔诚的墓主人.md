# é¢˜ç›®ä¿¡æ¯

# [SDOI2009] è™”è¯šçš„å¢“ä¸»äºº

## é¢˜ç›®æè¿°

å°Wæ˜¯ä¸€ç‰‡æ–°é€ å…¬å¢“çš„ç®¡ç†äººã€‚å…¬å¢“å¯ä»¥çœ‹æˆä¸€å— $NÃ—M$ çš„çŸ©å½¢ï¼ŒçŸ©å½¢çš„æ¯ä¸ªæ ¼ç‚¹ï¼Œè¦ä¹ˆç§ç€ä¸€æ£µå¸¸é’æ ‘ï¼Œè¦ä¹ˆæ˜¯ä¸€å—è¿˜æ²¡æœ‰å½’å±çš„å¢“åœ°ã€‚

å½“åœ°çš„å±…æ°‘éƒ½æ˜¯éå¸¸è™”è¯šçš„åŸºç£å¾’ï¼Œä»–ä»¬æ„¿æ„æå‰ä¸ºè‡ªå·±æ‰¾ä¸€å—åˆé€‚å¢“åœ°ã€‚ä¸ºäº†ä½“ç°è‡ªå·±å¯¹ä¸»çš„çœŸè¯šï¼Œä»–ä»¬å¸Œæœ›è‡ªå·±çš„å¢“åœ°æ‹¥æœ‰ç€è¾ƒé«˜çš„è™”è¯šåº¦ã€‚

ä¸€å—å¢“åœ°çš„è™”è¯šåº¦æ˜¯æŒ‡ä»¥è¿™å—å¢“åœ°ä¸ºä¸­å¿ƒçš„åå­—æ¶çš„æ•°ç›®ã€‚ä¸€ä¸ªåå­—æ¶å¯ä»¥çœ‹æˆä¸­é—´æ˜¯å¢“åœ°ï¼Œå¢“åœ°çš„æ­£ä¸Šã€æ­£ä¸‹ã€æ­£å·¦ã€æ­£å³éƒ½æœ‰æ°å¥½ $k$ æ£µå¸¸é’æ ‘ã€‚

å½¢å¼åŒ–åœ°ï¼Œå¯¹äºä¸€ä¸ªåæ ‡ä¸º $(x, y)$ çš„å¢“åœ°ï¼Œä»¥å…¶ä¸ºä¸­å¿ƒçš„åå­—æ¶ä¸ªæ•°æ˜¯è¿™æ ·çš„é•¿åº¦ä¸º $4k$ çš„äºŒå…ƒç»„åºåˆ— $[(x_{1,1},y_{1,1}),\allowbreak(x_{1,2},y_{1,2}),\allowbreak\cdots,(x_{1,k},y_{1,k}),\allowbreak(x_{2,1},y_{2,1}),\allowbreak(x_{2,2},y_{2,2}),\allowbreak\cdots,(x_{2,k},y_{2,k}),\allowbreak(x_{3,1},y_{3,1}),\allowbreak(x_{3,2},y_{3,2}),\allowbreak\cdots,(x_{3,k},y_{3,k}),\allowbreak(x_{4,1},y_{4,1}),\allowbreak(x_{4,2},y_{4,2}),\allowbreak\cdots,(x_{4,k},y_{4,k})]$ çš„æ–¹æ¡ˆæ•°ï¼š

- æ¯ä¸€ä¸ªäºŒå…ƒç»„å¯¹åº”ç€ä¸€æ£µå¸¸é’æ ‘çš„åæ ‡ï¼›
- $x_{1,1}<x_{1,2}<\cdots< x_{1,k}<x$ ä¸” $y_{1,1}=y_{1,2}=\cdots=y_{1,k}=y$ï¼›
- $x<x_{2,1}<x_{2,2}<\cdots< x_{2,k}$ ä¸” $y_{2,1}=y_{2,2}=\cdots=y_{2,k}=y$ï¼›
- $y_{3,1}<y_{3,2}<\cdots< y_{3,k}<y$ ä¸” $x_{3,1}=x_{3,2}=\cdots=x_{3,k}=x$ï¼›
- $y<y_{4,1}<y_{4,2}<\cdots< y_{4,k}$ ä¸” $x_{4,1}=x_{4,2}=\cdots=x_{4,k}=x$ã€‚

å°Wå¸Œæœ›çŸ¥é“ä»–æ‰€ç®¡ç†çš„è¿™ç‰‡å…¬å¢“ä¸­æ‰€æœ‰å¢“åœ°çš„è™”è¯šåº¦æ€»å’Œæ˜¯å¤šå°‘ã€‚

## è¯´æ˜/æç¤º

å›¾ä¸­ï¼Œä»¥å¢“åœ° $(2, 2)$ å’Œ $(2, 3)$ ä¸ºä¸­å¿ƒçš„åå­—æ¶å„æœ‰ $3$ ä¸ªï¼Œå³å®ƒä»¬çš„è™”è¯šåº¦å‡ä¸º $3$ã€‚å…¶ä»–å¢“åœ°çš„è™”è¯šåº¦ä¸º $0$ã€‚

 ![](https://cdn.luogu.com.cn/upload/pic/1589.png) 

å¯¹äº $30\%$ çš„æ•°æ®ï¼Œæ»¡è¶³ $1 â‰¤ N, M â‰¤ 10^3$ã€‚

å¯¹äº $60\%$ çš„æ•°æ®ï¼Œæ»¡è¶³ $1 â‰¤ N, M â‰¤ 10^6$ã€‚

å¯¹äº $100\%$ çš„æ•°æ®ï¼Œæ»¡è¶³ $1 â‰¤ N, M â‰¤ 10^9$ï¼Œ$0 â‰¤ x_i â‰¤ N$ï¼Œ$0 â‰¤ y_i â‰¤ M$ï¼Œ$1 â‰¤ W â‰¤ 10^5$ï¼Œ$1 â‰¤ k â‰¤ 10$ã€‚

å­˜åœ¨ $50\%$ çš„æ•°æ®ï¼Œæ»¡è¶³ $1 â‰¤ k â‰¤ 2$ã€‚

å­˜åœ¨ $25\%$ çš„æ•°æ®ï¼Œæ»¡è¶³ $1 â‰¤ W â‰¤ 10^4$ã€‚

## æ ·ä¾‹ #1

### è¾“å…¥

```
5 6

13

0 2

0 3

1 2

1 3

2 0

2 1

2 4

2 5

2 6

3 2

3 3

4 3

5 2

2```

### è¾“å‡º

```
6```

# AIåˆ†æç»“æœ


### ğŸ’¡ Kayçš„C++ç®—æ³•è§£æï¼šè™”è¯šçš„å¢“ä¸»äºº æ·±å…¥å­¦ä¹ æŒ‡å— ğŸ’¡

#### **1. é¢˜ç›®è§£è¯»ä¸æ ¸å¿ƒç®—æ³•è¯†åˆ«**
âœ¨ **æœ¬é¢˜ä¸»è¦è€ƒå¯Ÿ**ï¼šç»„åˆæ•°å­¦ + æ‰«æçº¿ + æ ‘çŠ¶æ•°ç»„

ğŸ—£ï¸ **åˆæ­¥åˆ†æ**ï¼š
> è§£å†³â€œè™”è¯šçš„å¢“ä¸»äººâ€çš„å…³é”®åœ¨äºå°†ç¦»æ•£åŒ–ã€ç»„åˆæ•°å­¦ä¸æ ‘çŠ¶æ•°ç»„ç»“åˆã€‚ç®—æ³•æ ¸å¿ƒæ€æƒ³æ˜¯ï¼šå°†å·¨å¤§ç½‘æ ¼å‹ç¼©ä¸ºæœ‰æ•ˆç‚¹ï¼ˆå¸¸é’æ ‘ï¼‰ï¼Œé€šè¿‡æ‰«æçº¿æŒ‰åˆ—å¤„ç†ï¼Œç”¨æ ‘çŠ¶æ•°ç»„åŠ¨æ€ç»´æŠ¤å·¦å³æ–¹å‘çš„ç»„åˆæ•°ä¹˜ç§¯å’Œã€‚  
> - **ç¦»æ•£åŒ–**ï¼šå°†ç¨€ç–çš„10^9ç½‘æ ¼å‹ç¼©è‡³10^5è§„æ¨¡ï¼Œä»…ä¿ç•™å¸¸é’æ ‘ä½ç½®ã€‚
> - **ç»„åˆæ•°å­¦**ï¼šæ¯ä¸ªå¢“åœ°çš„è™”è¯šåº¦ = C(ä¸Š,k) Ã— C(ä¸‹,k) Ã— C(å·¦,k) Ã— C(å³,k)ã€‚
> - **æ‰«æçº¿ä¼˜åŒ–**ï¼šæŒ‰åˆ—æ‰«æï¼Œç›¸é‚»åŒåˆ—å¸¸é’æ ‘é—´çš„å¢“åœ°å…·æœ‰ç›¸åŒçš„ä¸Šä¸‹æ ‘æ•°é‡ï¼Œåªéœ€è®¡ç®—å·¦å³ç»„åˆæ•°åŒºé—´å’Œã€‚
> - **æ ‘çŠ¶æ•°ç»„**ï¼šåŠ¨æ€ç»´æŠ¤æ¯åˆ—çš„C(å·¦,k) Ã— C(å³,k)å€¼ï¼Œæ”¯æŒå¿«é€ŸåŒºé—´æŸ¥è¯¢å’Œå•ç‚¹æ›´æ–°ã€‚

**å¯è§†åŒ–è®¾è®¡æ€è·¯**ï¼š
> é‡‡ç”¨8ä½åƒç´ é£æ ¼åŠ¨æ€å±•ç¤ºï¼š
> - **ç½‘æ ¼ä¸å¸¸é’æ ‘**ï¼šç»¿è‰²åƒç´ å—è¡¨ç¤ºå¸¸é’æ ‘ï¼Œç°è‰²è¡¨ç¤ºå¢“åœ°ã€‚
> - **æ‰«æè¿‡ç¨‹**ï¼šçº¢è‰²æ‰«æçº¿ä»å·¦å‘å³ç§»åŠ¨ï¼Œé‡åˆ°å¸¸é’æ ‘æ—¶æ’­æ”¾â€œæ»´â€éŸ³æ•ˆï¼Œå¹¶é«˜äº®è¯¥æ ‘ã€‚
> - **æ ‘çŠ¶æ•°ç»„æ›´æ–°**ï¼šæ¯åˆ—æ›´æ–°æ—¶æ˜¾ç¤ºå½“å‰å€¼å˜åŒ–ï¼ˆæ¡å½¢å›¾ + æ•°å€¼ï¼‰ï¼Œå¹¶æ’­æ”¾â€œå’”â€éŸ³æ•ˆã€‚
> - **è´¡çŒ®è®¡ç®—**ï¼šç›¸é‚»å¸¸é’æ ‘é—´çš„å¢“åœ°é«˜äº®ä¸ºé»„è‰²ï¼Œæ˜¾ç¤ºåŒºé—´æŸ¥è¯¢ç»“æœå’Œç´¯åŠ ç­”æ¡ˆã€‚

---

#### **2. ç²¾é€‰ä¼˜è´¨é¢˜è§£å‚è€ƒ**
**é¢˜è§£ä¸€ï¼ˆxyz32768ï¼‰**  
* **ç‚¹è¯„**ï¼šæ€è·¯æ¸…æ™°ï¼Œä»£ç è§„èŒƒã€‚æ ¸å¿ƒäº®ç‚¹åœ¨äºï¼š
  - ç²¾ç¡®çš„ç¦»æ•£åŒ–å¤„ç†ï¼ˆx,yåˆ†åˆ«æ˜ å°„ï¼‰ã€‚
  - æ ‘çŠ¶æ•°ç»„é«˜æ•ˆç»´æŠ¤ `C(left,k)*C(right,k)` çš„åŠ¨æ€å€¼ã€‚
  - ç»„åˆæ•°é¢„å¤„ç†ç”¨é€’æ¨å®Œæˆï¼Œé¿å…é‡å¤è®¡ç®—ã€‚
  - è¾¹ç•Œå¤„ç†ä¸¥è°¨ï¼ˆå¦‚æ£€æŸ¥ `u,d,l,r >= k`ï¼‰ã€‚

**é¢˜è§£äºŒï¼ˆK8Heï¼‰**  
* **ç‚¹è¯„**ï¼šç»“æ„ä¸¥è°¨ï¼Œé€»è¾‘æ¨å¯¼é€å½»ï¼š
  - å°†é—®é¢˜è½¬åŒ–ä¸º `C(ä¸Š,k)*C(ä¸‹,k) Ã— âˆ‘[C(å·¦_i,k)*C(å³_i,k)]`ã€‚
  - æ ‘çŠ¶æ•°ç»„çš„æ›´æ–°é€»è¾‘æ¸…æ™°ï¼ˆå…ˆå‡æ—§å€¼ï¼Œå†åŠ æ–°å€¼ï¼‰ã€‚
  - å¼ºè°ƒè°ƒè¯•æŠ€å·§ï¼ˆå–æ¨¡é”™è¯¯åˆ†æï¼‰ï¼Œå®è·µä»·å€¼é«˜ã€‚

**é¢˜è§£ä¸‰ï¼ˆLance1otï¼‰**  
* **ç‚¹è¯„**ï¼šåˆ›æ–°æ€§ä½¿ç”¨çº¿æ®µæ ‘æ›¿ä»£æ ‘çŠ¶æ•°ç»„ï¼š
  - åŠ¨æ€å¼€ç‚¹çº¿æ®µæ ‘å¤„ç†ç¨€ç–æ•°æ®ã€‚
  - è¯¦ç»†çš„çŠ¶æ€è½¬ç§»è¯´æ˜ï¼ˆå·¦å³æ ‘æ•°é‡å˜åŒ–å¯¹ç»„åˆæ•°çš„å½±å“ï¼‰ã€‚
  - æä¾›å®Œæ•´è°ƒè¯•ç»éªŒï¼Œå¯å‘æ€§å¼ºã€‚

---

#### **3. æ ¸å¿ƒéš¾ç‚¹è¾¨æä¸è§£é¢˜ç­–ç•¥**
1. **éš¾ç‚¹ï¼šåæ ‡ç³»ç¦»æ•£åŒ–ä¸åæ ‡æ˜ å°„**  
   * **åˆ†æ**ï¼šåŸå§‹ç½‘æ ¼è¿‡å¤§ï¼ˆ10^9ï¼‰ï¼Œéœ€å°†å¸¸é’æ ‘åæ ‡æ˜ å°„åˆ°è¿ç»­å°æ•´æ•°ã€‚ä¼˜è´¨é¢˜è§£å‡é‡‡ç”¨åŒæ’åº+å»é‡ï¼Œå¤æ‚åº¦O(W log W)ã€‚  
   * ğŸ’¡ **å­¦ä¹ ç¬”è®°**ï¼šç¦»æ•£åŒ–æ˜¯ç¨€ç–æ•°æ®å¤„ç†çš„åŸºç¡€æŠ€èƒ½ã€‚

2. **éš¾ç‚¹ï¼šç»„åˆæ•°ä¹˜ç§¯çš„åŠ¨æ€ç»´æŠ¤**  
   * **åˆ†æ**ï¼šæ ‘çŠ¶æ•°ç»„éœ€å®æ—¶æ›´æ–°æ¯åˆ—çš„ `C(left,k)*C(right,k)`ã€‚å½“æ‰«æåˆ°æ–°æ ‘æ—¶ï¼š
     - `left++`, `right--` â†’ é‡æ–°è®¡ç®—ç»„åˆæ•°ä¹˜ç§¯ã€‚
     - å¢é‡æ›´æ–°æ ‘çŠ¶æ•°ç»„ï¼ˆæ–°å€¼ - æ—§å€¼ï¼‰ã€‚  
   * ğŸ’¡ **å­¦ä¹ ç¬”è®°**ï¼šæ ‘çŠ¶æ•°ç»„é€‚åˆå•ç‚¹æ›´æ–°+åŒºé—´æ±‚å’Œï¼Œæ¯”çº¿æ®µæ ‘æ›´ç®€æ´ã€‚

3. **éš¾ç‚¹ï¼šåŒåˆ—ç›¸é‚»æ ‘çš„åŒºé—´è´¡çŒ®è®¡ç®—**  
   * **åˆ†æ**ï¼šè‹¥ä¸¤æ ‘åœ¨åˆ—å†…ä½ç½®ä¸º `i` å’Œ `i+1`ï¼Œåˆ™å…¶é—´çš„å¢“åœ°è™”è¯šåº¦ =  
     `C(ä¸Š,k)*C(ä¸‹,k) Ã— âˆ‘[C(å·¦_j,k)*C(å³_j,k)]`  
     å…¶ä¸­ `âˆ‘` ç”¨æ ‘çŠ¶æ•°ç»„æŸ¥è¯¢ `[y_i+1, y_{i+1}-1]` è·å¾—ã€‚  
   * ğŸ’¡ **å­¦ä¹ ç¬”è®°**ï¼šæ‰«æçº¿å›ºå®šä¸Šä¸‹æ–¹å‘ï¼Œæ ‘çŠ¶æ•°ç»„å¤„ç†å·¦å³æ–¹å‘ï¼Œæ˜¯ç»å…¸çš„ç©ºé—´åˆ†è§£ç­–ç•¥ã€‚

**âœ¨ è§£é¢˜æŠ€å·§æ€»ç»“**ï¼š
- **ç¦»æ•£åŒ–ä¼˜å…ˆ**ï¼šå¯¹x,yç‹¬ç«‹æ’åºå»é‡ï¼Œæ˜ å°„åç»Ÿè®¡è¡Œåˆ—æ ‘æ•°é‡ã€‚
- **ç»„åˆæ•°é¢„å¤„ç†**ï¼šé€’æ¨å¼ `C[i][j] = C[i-1][j] + C[i-1][j-1]` å¯¹ `jâ‰¤10` é«˜æ•ˆã€‚
- **æ ‘çŠ¶æ•°ç»„è®¾è®¡**ï¼šç»´æŠ¤åˆ—çš„å€¼ï¼Œé‡åˆ°æ–°æ ‘æ—¶æ›´æ–°ï¼š
  ```cpp
  new_val = C[left][k] * C[right][k];
  add(y, new_val - old_val); // å¢é‡æ›´æ–°
  ```
- **åŒºé—´æŸ¥è¯¢æ—¶æœº**ï¼šåŒåˆ—ç›¸é‚»æ ‘æ»¡è¶³ `yé—´è·>1` ä¸” `ä¸Šä¸‹æ ‘â‰¥k` æ—¶æ‰è®¡ç®—è´¡çŒ®ã€‚

---

#### **4. C++æ ¸å¿ƒä»£ç å®ç°èµæ**
**æœ¬é¢˜é€šç”¨æ ¸å¿ƒå®ç°**ï¼ˆç»¼åˆè‡ªä¼˜è´¨é¢˜è§£ï¼‰ï¼š
```cpp
#include <algorithm>
#define lowbit(x) ((x) & -(x))
const int mod = 2147483648;

// é¢„å¤„ç†ç»„åˆæ•° C[0..w][0..k]
void initC(int w, int k, vector<vector<ll>>& C) {
    C[0][0] = 1;
    for (int i = 1; i <= w; i++) {
        C[i][0] = 1;
        for (int j = 1; j <= min(i, k); j++)
            C[i][j] = (C[i-1][j] + C[i-1][j-1]) % mod;
    }
}

// ç¦»æ•£åŒ–ï¼šè¿”å›æ˜ å°„åçš„åæ ‡å’Œè¡Œåˆ—æ ‘æ•°é‡
void discretize(vector<tree>& trees, vector<int>& x_cnt, vector<int>& y_cnt) {
    vector<int> xs, ys;
    for (auto t : trees) {
        xs.push_back(t.x);
        ys.push_back(t.y);
    }
    sort(xs.begin(), xs.end());
    xs.erase(unique(xs.begin(), xs.end()), xs.end());
    // ç±»ä¼¼å¤„ç† ys...
    for (auto& t : trees) {
        t.x = lower_bound(xs.begin(), xs.end(), t.x) - xs.begin();
        t.y = lower_bound(ys.begin(), ys.end(), t.y) - ys.begin();
        x_cnt[t.x]++; y_cnt[t.y]++;
    }
}

// æ ‘çŠ¶æ•°ç»„ç±»
struct Fenwick {
    vector<ll> tr;
    Fenwick(int n) : tr(n + 1) {}
    void update(int i, ll v) {
        for (; i < tr.size(); i += lowbit(i)) 
            tr[i] = (tr[i] + v) % mod;
    }
    ll query(int i) {
        ll res = 0;
        for (; i; i -= lowbit(i))
            res = (res + tr[i]) % mod;
        return res;
    }
};

int main() {
    // è¯»å…¥æ•°æ®
    discretize(trees, x_cnt, y_cnt);
    initC(MAXW, k, C);
    sort(trees.begin(), trees.end()); // æŒ‰xæ’åºï¼Œxç›¸åŒæŒ‰yæ’

    Fenwick bit(y_max);
    vector<int> left_cnt(y_max), cur_val(y_max);
    ll ans = 0;
    int col_count = 0; // å½“å‰åˆ—å†…æ ‘è®¡æ•°

    for (int i = 0; i < trees.size(); i++) {
        int x = trees[i].x, y = trees[i].y;
        if (i && trees[i-1].x != x) col_count = 0;
        col_count++;

        // æ›´æ–°æ ‘çŠ¶æ•°ç»„
        ll new_val = (left_cnt[y] >= k && y_cnt[y]-left_cnt[y] >= k) 
                   ? C[left_cnt[y]][k] * C[y_cnt[y]-left_cnt[y]][k] % mod : 0;
        bit.update(y, (new_val - cur_val[y] + mod) % mod);
        cur_val[y] = new_val;
        left_cnt[y]++; // è¯¥åˆ—å·¦ä¾§æ ‘+1

        // åŒåˆ—ç›¸é‚»æ ‘åŒºé—´è®¡ç®—
        if (i+1 < trees.size() && trees[i+1].x == x && trees[i+1].y > y+1) {
            int y2 = trees[i+1].y;
            ll up_down = C[col_count][k] * C[x_cnt[x]-col_count][k] % mod;
            ll left_right = (bit.query(y2-1) - bit.query(y) + mod) % mod;
            ans = (ans + up_down * left_right) % mod;
        }
    }
    cout << ans << endl;
}
```

**ä»£ç è§£è¯»æ¦‚è¦**ï¼š
1. **ç¦»æ•£åŒ–**ï¼šå°†æ ‘åæ ‡æ˜ å°„åˆ°è¿ç»­æ•´æ•°ï¼Œç»Ÿè®¡æ¯è¡Œ/åˆ—æ ‘æ•°ã€‚
2. **ç»„åˆæ•°é¢„å¤„ç†**ï¼šç”¨åŠ¨æ€è§„åˆ’è®¡ç®—C(n,k)ã€‚
3. **æ‰«æçº¿**ï¼šæŒ‰åˆ—éå†æ ‘ï¼Œç»´æŠ¤åˆ—å†…è®¡æ•°å™¨ã€‚
4. **æ ‘çŠ¶æ•°ç»„æ›´æ–°**ï¼šæ¯æ£µæ ‘æ›´æ–°å…¶åˆ—çš„ç»„åˆæ•°å€¼ã€‚
5. **åŒºé—´è´¡çŒ®è®¡ç®—**ï¼šåŒåˆ—ç›¸é‚»æ ‘é—´æ»¡è¶³æ¡ä»¶æ—¶ï¼Œç´¯åŠ ç­”æ¡ˆã€‚

---

#### **5. ç®—æ³•å¯è§†åŒ–ï¼šåƒç´ åŠ¨ç”»æ¼”ç¤º**
**åŠ¨ç”»è®¾è®¡**ï¼š8ä½åƒç´ é£æ ¼ï¼Œä»¿FCæ¸¸æˆç•Œé¢  
**æ ¸å¿ƒæ¼”ç¤º**ï¼šæ ‘çŠ¶æ•°ç»„åŠ¨æ€ç»´æŠ¤è¿‡ç¨‹  
**å…³é”®å¸§æ­¥éª¤**ï¼š
1. **åˆå§‹åŒ–**ï¼šç½‘æ ¼æ˜¾ç¤ºï¼ˆç»¿è‰²å¸¸é’æ ‘ï¼Œç°è‰²å¢“åœ°ï¼‰ï¼Œåº•éƒ¨æ ‘çŠ¶æ•°ç»„åˆå§‹ä¸º0ã€‚
   ![åˆå§‹åŒ–](https://i.imgur.com/1jXzQ9r.gif)

2. **æ‰«æè¿‡ç¨‹**ï¼š
   - çº¢è‰²æ‰«æçº¿ä»å·¦å‘å³ç§»åŠ¨ï¼Œé‡åˆ°å¸¸é’æ ‘æ—¶é«˜äº®å¹¶æ’­æ”¾â€œæ»´â€å£°ã€‚
   - æ›´æ–°è¯¥åˆ—å€¼ï¼šå·¦ä¾§æ ‘æ•°+1ï¼Œå³ä¾§æ ‘æ•°-1ï¼Œæ ‘çŠ¶æ•°ç»„å¯¹åº”åˆ—é«˜åº¦å˜åŒ–ã€‚
   ![æ‰«ææ›´æ–°](https://i.imgur.com/5VZv7lS.gif)

3. **è´¡çŒ®è®¡ç®—**ï¼š
   - åŒåˆ—ç›¸é‚»æ ‘é—´å¢“åœ°é«˜äº®ä¸ºé»„è‰²ã€‚
   - æ˜¾ç¤ºå…¬å¼ï¼š`è´¡çŒ® = C(ä¸Š,k)Ã—C(ä¸‹,k)Ã—[æ ‘çŠ¶æ•°ç»„æŸ¥è¯¢å€¼]`ã€‚
   - ç»“æœå®æ—¶ç´¯åŠ åˆ°åº•éƒ¨è®¡æ•°å™¨ã€‚
   ![è´¡çŒ®è®¡ç®—](https://i.imgur.com/8uG2Fpk.gif)

**äº¤äº’æ§åˆ¶**ï¼š
- **å•æ­¥æ‰§è¡Œ**ï¼šæŒ‰ç©ºæ ¼é€æ­¥æ‰«æã€‚
- **é€Ÿåº¦è°ƒèŠ‚**ï¼šæ»‘å—æ§åˆ¶æ‰«æé€Ÿåº¦ã€‚
- **é‡ç½®**ï¼šæŒ‰é’®é‡ç½®åŠ¨ç”»ã€‚

---

#### **6. æ‹“å±•ç»ƒä¹ ä¸ç›¸ä¼¼é—®é¢˜æ€è€ƒ**
**é€šç”¨æŠ€å·§è¿ç§»**ï¼š
1. **äºŒç»´ååºé—®é¢˜**ï¼šå¦‚é€†åºå¯¹è®¡æ•°ï¼ˆP1908ï¼‰ï¼Œæœ¬è´¨æ˜¯æ ‘çŠ¶æ•°ç»„ç»´æŠ¤ä¸€ç»´ä¿¡æ¯ã€‚
2. **åŒºé—´ç»Ÿè®¡ä¼˜åŒ–**ï¼šå¦‚åŒºé—´å†…æ»¡è¶³æ¡ä»¶çš„å…ƒç´ å¯¹æ•°ï¼ˆP1972ï¼‰ï¼Œéœ€ç»“åˆç¦»æ•£åŒ–ã€‚
3. **åŠ¨æ€ç»´æŠ¤ç»„åˆæ•°**ï¼šå¦‚æ¦‚ç‡é—®é¢˜ä¸­å®æ—¶æ›´æ–°äºŒé¡¹å¼ç³»æ•°ã€‚

**æ´›è°·æ¨èé¢˜ç›®**ï¼š
1. **P1908 é€†åºå¯¹**  
   ğŸ—£ï¸ ç»ƒä¹ ç¦»æ•£åŒ–+æ ‘çŠ¶æ•°ç»„çš„ç»å…¸åº”ç”¨ï¼Œå·©å›ºåŸºç¡€ã€‚

2. **P1972 [SDOI2009] HHçš„é¡¹é“¾**  
   ğŸ—£ï¸ å­¦ä¹ å¦‚ä½•ç”¨æ ‘çŠ¶æ•°ç»„é«˜æ•ˆå¤„ç†åŒºé—´é¢œè‰²æŸ¥è¯¢ã€‚

3. **P4054 [JSOI2009] è®¡æ•°é—®é¢˜**  
   ğŸ—£ï¸ äºŒç»´æ ‘çŠ¶æ•°ç»„çš„ç›´æ¥åº”ç”¨ï¼Œå¼ºåŒ–ç©ºé—´åˆ†è§£æ€ç»´ã€‚

---

#### **7. å­¦ä¹ å¿ƒå¾—ä¸ç»éªŒåˆ†äº«**
> **æ¥è‡ª K8He çš„è°ƒè¯•ç»éªŒ**ï¼š  
> â€œæˆ‘åœ¨å–æ¨¡è¿ç®—ä¸Šå¡äº†å¾ˆä¹…ï¼Œè´Ÿæ•°å–æ¨¡éœ€ `(x%mod+mod)%mod`ï¼Œè¿™æé†’æˆ‘ä»¬æ³¨æ„è¾¹ç•Œå¤„ç†ã€‚â€  
> **ç‚¹è¯„**ï¼šæ•°å€¼è®¡ç®—ä¸­çš„è¾¹ç•Œå’Œæº¢å‡ºæ˜¯å¸¸è§é™·é˜±ï¼Œå»ºè®®ï¼š
> - ç”¨ `long long` é¿å…æº¢å‡ºã€‚
> - è´Ÿæ•°å…ˆåŠ  `mod` å†å–æ¨¡ã€‚
> - æ ‘çŠ¶æ•°ç»„æ›´æ–°æ—¶ä¿å­˜æ—§å€¼å‡å°‘è®¡ç®—ã€‚

---

### æ€»ç»“
æœ¬é¢˜é€šè¿‡ç¦»æ•£åŒ–+æ ‘çŠ¶æ•°ç»„+ç»„åˆæ•°å­¦ï¼Œå°†O(nÂ²)æš´åŠ›ä¼˜åŒ–è‡³O(W log W)ã€‚å…³é”®åœ¨äºè¯†åˆ«åŒåˆ—ç›¸é‚»æ ‘çš„åŒºé—´è´¡çŒ®æ’å®šç‰¹æ€§ï¼Œå¹¶ç”¨æ ‘çŠ¶æ•°ç»„åŠ¨æ€ç»´æŠ¤ã€‚æŒæ¡æ­¤æ–¹æ³•å¯è§£å†³æ›´å¤šäºŒç»´ç»Ÿè®¡é—®é¢˜ã€‚**è®°ä½ï¼šç¦»æ•£åŒ–ç¼©è§„æ¨¡ï¼Œæ ‘çŠ¶æ•°ç»„æŠ¤åŠ¨æ€ï¼Œç»„åˆæ•°å­¦ç®—æ–¹æ¡ˆã€‚** ç»§ç»­åŠ æ²¹ï¼ğŸ’ª

---
å¤„ç†ç”¨æ—¶ï¼š159.62ç§’
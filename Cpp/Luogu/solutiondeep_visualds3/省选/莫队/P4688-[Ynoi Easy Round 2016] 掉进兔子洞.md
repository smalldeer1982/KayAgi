# é¢˜ç›®ä¿¡æ¯

# [Ynoi Easy Round 2016] æ‰è¿›å…”å­æ´

## é¢˜ç›®èƒŒæ™¯

5.632

æˆ‘ï¼ˆæˆ–è€…æ˜¯åœ¨è¯»è¿™ç¯‡æ–‡å­—çš„ä½ ï¼‰ä¸å±äºè¿™ä¸ªä¸–ç•Œ

è¿™æ˜¯ä¸–ç•Œçš„ç•Œé™

6.41

ä¸–ç•Œçš„æ„ä¹‰å¿…å®šå­˜åœ¨äºä¸–ç•Œä¹‹å¤–

ä¸–ç•Œä¸­çš„ä¸€åˆ‡äº‹ç‰©å¦‚å…¶æ‰€å­˜åœ¨èˆ¬è€Œå­˜åœ¨ï¼Œå¦‚å…¶æ‰€å‘ç”Ÿèˆ¬è€Œå‘ç”Ÿ

ä¸–ç•Œä¹‹ä¸­ä¸å­˜åœ¨ä»·å€¼

â€”â€”ã€Šé€»è¾‘å“²å­¦è®ºã€‹

æˆ‘ä»¬çš„æƒ…äººï¼Œä¸è¿‡æ˜¯éšä¾¿å€Ÿä¸ªåå­—ï¼Œç”¨å¹»æƒ³å¹å‡ºæ¥çš„è‚¥çš‚æ³¡

æŠŠä¿¡æ‹¿å»å§ï¼Œä½ å¯ä»¥ä½¿å‡æˆæˆçœŸ

æˆ‘æœ¬æ¥æ˜¯æ— ç—…å‘»åŸï¼Œæ¼«æ— ç›®çš„çš„åéœ²çˆ±æƒ…---ç°åœ¨è¿™äº›æ¼‚æ³Šä¸å®šçš„é¸Ÿå„¿æœ‰åœ°æ–¹æ –æ¯äº†ï¼Œä½ å¯ä»¥ä»ä¿¡é‡Œçœ‹å‡ºæ¥

æ‹¿å»å§---ç”±äºä¸æ˜¯å‡ºè‡ªçœŸå¿ƒï¼Œè¯å°±è¯´å¾—æ ¼å¤–åŠ¨å¬ï¼Œæ‹¿å»å§ï¼Œå°±è¿™ä¹ˆåŠå§...

![](https://cdn.luogu.com.cn/upload/pic/21091.png)

æœç„¶â€¦â€¦å¥½å¥³äººè¦æœ‰çš„æ˜¯ï¼ŒçƒŸã€æ¥¼é¡¶â€¦â€¦è¿˜æœ‰è½»é£˜é£˜çš„è¡£æœå‘€â€¦â€¦

æŸä¸€å¤©ï¼Œæ°´ä¸Šç”±å²çœ‹è§å¤©ä¸Šæ‰ä¸‹äº†ä¸ªå¸ƒåˆ¶ç©å¶

ä¸ºäº†è¢«å¤©ç©ºæ¥å—è€ŒæŠ•æ·å‡ºçš„å¥¹çš„å¸ƒå¶ï¼Œä¸çŸ¥åœ¨å¤©ç©ºé£èˆäº†å¤šå°‘æ¬¡ï¼Œå·²ç»éä½“é³ä¼¤

â€œè¢«å¤©ç©ºæ¥å—â€â€”â€”é‚£æ˜¯ä¸ºäº†å¯»æ‰¾ä¸çŸ¥ä½•æ—¶å¼€å§‹åœ¨è¿™ä¸ªåŸå¸‚æµä¼ çš„â€œå›å½’å¤©ç©ºä¹‹è·¯â€çš„è¡Œä¸º

![](https://cdn.luogu.com.cn/upload/pic/21102.png)

ä¸ºäº†è¢«å¤©ç©ºæ¥å—è€Œè¢«æ‰”å‡ºå»çš„æœ¨å¶ï¼Œåœ¨ç©ºä¸­é£èˆå¹¶æœ€ç»ˆå è½

é‚£æ˜¯ä¸ºäº†å°†å…¶æœ¬èº«å³ä¸ºä¸–ç•Œçš„å°‘å¥³é€äºˆå¤©ç©ºçš„å°‘å¥³çš„è¡Œä¸º

![](https://cdn.luogu.com.cn/upload/pic/21093.png)

æ¨ªè·¨é“¶æ²³ï¼Œè¢«ç§°ä½œVegaä¸Altairï¼Œæˆ–æ˜¯ç»‡å¥³æ˜Ÿä¸ç‰›éƒæ˜Ÿçš„ä¸¤é¢—æ˜Ÿæ˜Ÿï¼Œå†åŠ ä¸ŠåŒ—åå­—æ˜Ÿä¹‹é¡¶çš„å¤©é¹…åº§æ„æˆäº†å¤ä¹‹å¤§ä¸‰è§’

å®ƒè¢«ç§°ä½œè­¬å¦‚ä¸‰ä½ä¸€ä½“çš„ç¥åœ£çš„å›¾å½¢

åªæœ‰ç¥åœ£çš„å›¾å½¢åœ¨å¤©ç©ºé—ªè€€ä¹‹æ—¶ï¼Œä¸–ç•Œæ‰ä¸å¤©ç©ºç›¸é‡

![](https://cdn.luogu.com.cn/upload/pic/21094.png)

æˆ‘æƒ³è¯•ä¸€è¯•ï¼Œç¬¬ä¸€æ¬¡ï¼Œä¹Ÿæ˜¯æœ€åä¸€æ¬¡çš„æ¶ä½œå‰§

![](https://cdn.luogu.com.cn/upload/pic/21095.png)

é‚£æ˜¯...ä»€ä¹ˆï¼Ÿ

ä»€ä¹ˆäº‹ä¹Ÿæ²¡æœ‰å“¦ï¼Œåªæ˜¯ï¼Œé—´å®«å›ä»–è‡ªå·±ä¸»åŠ¨è·³ä¸‹å»äº†è€Œå·²å“¦~

æ€ä¹ˆå›äº‹ï¼Ÿ

ä»€ä¹ˆäº‹ä¹Ÿæ²¡æœ‰å“¦ï¼Œåªæ˜¯ï¼Œé—´å®«å›ä»–è‡ªå·±ä¸»åŠ¨è·³ä¸‹å»äº†è€Œå·²å“¦~

ä½†æ˜¯æˆ‘çœ‹åˆ°äº†ï¼Œæ˜¯é‚£ä¸ªæ€æ­»äº†å¤§å®¶å—ï¼Ÿ

ä»€ä¹ˆäº‹ä¹Ÿæ²¡æœ‰å“¦ï¼Œåªæ˜¯ï¼Œé—´å®«å›ä»–è‡ªå·±ä¸»åŠ¨è·³ä¸‹å»äº†è€Œå·²å“¦~

ä¸ï¼Œé‚£ä¸ªä¸œè¥¿ï¼Œä»€ä¹ˆéƒ½æ²¡æœ‰åšï¼Œåªæ˜¯...

ä»€ä¹ˆäº‹ä¹Ÿæ²¡æœ‰å“¦ï¼Œåªæ˜¯ï¼Œé—´å®«å›ä»–è‡ªå·±ä¸»åŠ¨è·³ä¸‹å»äº†è€Œå·²å“¦~

åªæ˜¯...æ€ä¹ˆå›äº‹...

ä»€ä¹ˆäº‹ä¹Ÿæ²¡æœ‰å“¦ï¼Œåªæ˜¯ï¼Œé—´å®«å›ä»–è‡ªå·±ä¸»åŠ¨è·³ä¸‹å»äº†è€Œå·²å“¦~

æˆ‘ç¡®å®å¬åˆ°äº†å¤´ç›–éª¨ç ´ç¢çš„å£°éŸ³

ä½†æ˜¯é‚£ä¸ªï¼Œå¹¶éæ˜¯å¤–é¢çš„ä¸–ç•Œ

è€Œæ˜¯æ€»è‡ªå·±çš„é‡Œé¢ä¼ æ¥çš„

![](https://cdn.luogu.com.cn/upload/pic/21096.png)

æ°´ä¸ŠåŒå­¦...æˆ‘å¶å°”ä¼šæ€è€ƒè¿™ç§äº‹æƒ…...

ä¸–ç•Œçš„æé™åˆ°åº•åœ¨å“ªé‡Œå‘¢...

ä¸–ç•Œçš„...ä¸–ç•Œçš„å°½å¤´çš„æ›´å°½å¤´...

è¦æ˜¯èƒ½æœ‰é‚£ç§åœ°æ–¹...

è¦æ˜¯å‡å¦‚æˆ‘èƒ½å¤Ÿç«™åœ¨é‚£ä¸ªåœ°æ–¹çš„è¯...æˆ‘è¿˜æ˜¯èƒ½è·Ÿå¹³æ—¶ä¸€æ ·çœ‹ç€é‚£ä¸ªå°½å¤´çš„é£æ™¯å—ï¼Ÿæˆ‘æœ‰è¿™ç§æƒ³æ³•....

æˆ‘ç†æ‰€å½“ç„¶çš„æƒ³ç€è¿™ç§äº‹...ç„¶åå†³å®šä¼¼ä¹æ˜¯æœ‰äº›å¥‡æ€ªå•Š

å› ä¸ºé‚£é‡Œæ˜¯ä¸–ç•Œçš„å°½å¤´å“¦

æ˜¯ä¸–ç•Œçš„æé™å“¦

å¦‚æœæˆ‘èƒ½å¤Ÿçœ‹åˆ°é‚£ä¸ªçš„è¯...ä¸–ç•Œçš„æé™...æ˜¯å¦å°±ç­‰åŒäºæˆ‘çš„æé™å‘¢ï¼Ÿ

å› ä¸ºï¼Œä»é‚£é‡Œçœ‹åˆ°çš„ä¸–ç•Œ...æˆ‘æ‰€çœ‹è§çš„...ä¸å°±æ˜¯æˆ‘çš„ä¸–ç•Œå—ï¼Ÿ

ä¸–ç•Œçš„æé™...å°±ä¼šå˜æˆæˆ‘çš„æé™å§~

ä¸–ç•Œå°±æ˜¯æˆ‘çœ‹åˆ°çš„æ‘¸åˆ°çš„ï¼Œå¹¶ä¸”æ„Ÿå—åˆ°çš„ä¸œè¥¿

é‚£æ ·çš„è¯ï¼Œä¸–ç•Œåˆ°åº•æ˜¯ä»€ä¹ˆå‘¢

ä¸–ç•Œå’Œæˆ‘åˆ°åº•æœ‰ä»€ä¹ˆä¸åŒå‘¢...æˆ‘æœ‰è¿™ç§æƒ³æ³•

æœ‰å—ï¼Ÿ

ä¸–ç•Œå’Œæˆ‘çš„å·®åˆ«

æ˜¯ä¸€æ ·çš„

ä½†æ˜¯ï¼Œæˆ–è®¸å…¶ä»–äººä¹Ÿæœ‰ç›¸åŒçš„æ„Ÿè§‰...

å°±è¿ä½ ï¼Œæˆ–è®¸ä¹Ÿè®¤ä¸ºä¸–ç•Œå°±æ˜¯ä½ è‡ªå·±å§

å¹¶ä¸”ï¼Œæˆ‘è§‰å¾—é‚£ä¸ªå¤§æ¦‚æ˜¯æ­£ç¡®çš„...

è™½ç„¶æˆ‘ä¸å¤ªæ¸…æ¥š...å¤§æ¦‚æ˜¯ä½ ä¹Ÿç«™åœ¨ä¸–ç•Œçš„å°½å¤´ï¼Œè·Ÿæˆ‘ä¸€æ ·åœ¨çœ‹ç€å®ƒå§

æ‰€ä»¥ï¼Œä½ ä¹Ÿå’Œä¸–ç•Œä¸€æ ·

ä½†æ˜¯å•Šï¼Œé‚£æ ·æœç„¶å¾ˆå¥‡æ€ªå•Š...

å¦‚æœä¸–ç•Œå°±æ˜¯æˆ‘çš„è¯...ä¸ºä»€ä¹ˆæˆ‘ä¼šçœ‹ä¸åˆ°ä½ çœ‹åˆ°çš„ä¸–ç•Œå‘¢ï¼Ÿ

æ˜æ˜æˆ‘çš„ä¸–ç•Œé‡Œæœ‰ä½ å­˜åœ¨...å´çœ‹ä¸åˆ°ä½ çœ‹åˆ°çš„ä¸–ç•Œ

æˆ‘ä»æ¥æ²¡æœ‰çœ‹åˆ°è¿‡ä½ çœ‹åˆ°çš„ä¸–ç•Œ

é‚£ä¸ªï¼Œç®€ç›´å°±åƒæ˜¯ä¸¤è€…ä¸ä¼šäº¤é›†çš„å¹³è¡Œå®‡å®™ä¸€æ ·...

å³ä½¿æœ‰ç°è±¡æš—ç¤ºç€é‚£ä¸ªä¸œè¥¿å­˜åœ¨...å´æ˜¯ç»å¯¹çš„æ— æ³•è§¦ç¢°...

æˆ‘...çœ‹ä¸åˆ°ä½ æ‰€åœ¨çš„ä¸–ç•Œ...

ä½†æ˜¯...

é‚£ä¸ªä¹Ÿæ˜¯çœŸçš„æ˜¯çœŸçš„å—ï¼Ÿ

æˆ‘çœŸçš„æ²¡æœ‰çœ‹åˆ°è¿‡ä½ çš„ä¸–ç•Œå—...

æ—¢ç„¶æ‰€æœ‰çš„äººéƒ½å¹³ç­‰çš„æ‹¥æœ‰å¥¹ä»¬è‡ªå·±çš„ä¸–ç•Œçš„è¯

é‚£ä¹ˆä¸ºä»€ä¹ˆä¸–ç•Œä¼šå˜æˆä¸€ä¸ªå‘¢ï¼Ÿ

ä¸ºä»€ä¹ˆé‚£ä¹ˆå¤šçš„ä¸–ç•Œä¼šå­˜åœ¨äºè¿™é‡Œå‘¢ï¼Ÿ

ä¸–ç•Œå˜æˆä¸€ä¸ªçš„ç†ç”±

...æˆ‘å¶å°”ä¼šæ€è€ƒè¿™ç§äº‹æƒ…

æ‰€ä»¥...æˆ‘æ‰èƒ½å¤Ÿå–œæ¬¢ä¸Šä½ 



## é¢˜ç›®æè¿°

æ‚¨æ­£åœ¨æ‰“ galgameï¼Œç„¶åçªç„¶å‘ç°æ‚¨ä»Šå¤©å¤ªé¢“äº†ï¼Œäºæ˜¯æƒ³å†™ä¸ªæ•°æ®ç»“æ„é¢˜ç»ƒç»ƒæ‰‹ï¼š

ä¸€ä¸ªé•¿ä¸ºÂ $n$Â çš„åºåˆ—Â $a$ã€‚

æœ‰Â $m$Â ä¸ªè¯¢é—®ï¼Œæ¯æ¬¡è¯¢é—®ä¸‰ä¸ªåŒºé—´ï¼ŒæŠŠä¸‰ä¸ªåŒºé—´ä¸­åŒæ—¶å‡ºç°çš„æ•°ä¸€ä¸ªä¸€ä¸ªåˆ æ‰ï¼Œé—®æœ€åä¸‰ä¸ªåŒºé—´å‰©ä¸‹çš„æ•°çš„ä¸ªæ•°å’Œï¼Œè¯¢é—®ç‹¬ç«‹ã€‚

æ³¨æ„è¿™é‡Œåˆ æ‰æŒ‡çš„æ˜¯ä¸€ä¸ªä¸€ä¸ªåˆ ï¼Œä¸æ˜¯æŠŠç­‰äºè¿™ä¸ªå€¼çš„æ•°ç›´æ¥åˆ å®Œï¼Œæ¯”å¦‚ä¸‰ä¸ªåŒºé—´æ˜¯Â  $[1,2,2,3,3,3,3]$ï¼Œ$[1,2,2,3,3,3,3]$Â ä¸Â $[1,1,2,3,3]$ï¼Œå°±ä¸€èµ·æ‰”æ‰äº†Â $1$Â ä¸ªÂ $1$ï¼Œ$1$Â ä¸ªÂ $2$ï¼Œ$2$Â ä¸ªÂ $3$ã€‚

## è¯´æ˜/æç¤º

Ideaï¼šnzhtl1477ï¼ŒSolutionï¼šnzhtl1477ï¼ŒCodeï¼šnzhtl1477ï¼ŒDataï¼šnzhtl1477

$1\leq n , m \leq 10^5$ï¼Œ$1 \leq a_i\leq 10^9$ï¼Œ$1\leq l_1,r_1,l_2,r_2,l_3,r_3\leq n$ï¼Œ$l_1\leq r_1$ï¼Œ$l_2\leq r_2$ï¼Œ$l_3\leq r_3$ã€‚

## æ ·ä¾‹ #1

### è¾“å…¥

```
5 2
1 2 2 3 3
1 2 2 3 3 4
1 5 1 5 1 5```

### è¾“å‡º

```
3
0```

# AIåˆ†æç»“æœ


# ğŸ’¡ Kayçš„C++ç®—æ³•è§£æï¼š[Ynoi Easy Round 2016] æ‰è¿›å…”å­æ´ æ·±å…¥å­¦ä¹ æŒ‡å— ğŸ’¡

## 1. é¢˜ç›®è§£è¯»ä¸æ ¸å¿ƒç®—æ³•è¯†åˆ«

âœ¨ **æœ¬é¢˜ä¸»è¦è€ƒå¯Ÿ**ï¼š`åˆ†å—` + `bitsetä¼˜åŒ–` (è«é˜Ÿåº”ç”¨)

ğŸ—£ï¸ **åˆæ­¥åˆ†æ**ï¼š
> è§£å†³æœ¬é¢˜çš„å…³é”®åœ¨äºç†è§£ **ç¦»æ•£åŒ–æŠ€å·§** ä¸ **bitsetçš„çµæ´»è¿ç”¨**ã€‚æƒ³è±¡ä½ æœ‰ä¸‰ä¸ªè£…å½©è‰²çŸ³å¤´çš„ç›’å­ï¼Œæ¯ä¸ªç›’å­é‡Œçš„çŸ³å¤´é¢œè‰²å¯èƒ½é‡å¤ã€‚ä½ éœ€è¦æ‰¾å‡ºåŒæ—¶å‡ºç°åœ¨ä¸‰ä¸ªç›’å­ä¸­çš„é¢œè‰²ï¼Œä¸”æ¯ä¸ªé¢œè‰²è¦æŒ‰æœ€å°å‡ºç°æ¬¡æ•°è®¡ç®—ã€‚è¿™å°±åƒç”¨ä¸‰ä¸ªç­›å­åŒæ—¶ç­›çŸ³å¤´â€”â€”bitsetå°±æ˜¯é‚£ä¸ªèƒ½åŒæ—¶å¤„ç†ä¸‰ä¸ªç­›å­çš„ç¥å¥‡å·¥å…·ï¼  
> - æ ¸å¿ƒæ€è·¯ï¼šé€šè¿‡è«é˜Ÿç®—æ³•ç»´æŠ¤åŒºé—´ä¿¡æ¯ï¼Œåˆ©ç”¨bitseté«˜æ•ˆè®¡ç®—ä¸‰ä¸ªåŒºé—´çš„äº¤é›†ï¼ˆå–minæ“ä½œï¼‰ã€‚
> - éš¾ç‚¹çªç ´ï¼š  
>   - **ç¦»æ•£åŒ–åˆ›æ–°**ï¼šç¦»æ•£åŒ–æ—¶ä¸å»é‡ï¼Œæ¯ä¸ªå€¼å æ®è¿ç»­ä½ç½®ï¼ˆå¦‚å€¼xå‡ºç°3æ¬¡ï¼Œåˆ™å æ®ä½ç½®x,x+1,x+2ï¼‰
>   - **bitseté­”æ³•**ï¼šå°†æ•°å­—pæ’å…¥bitsetæ—¶ï¼Œè®¾ç½®ä½ç½®`p+cnt[p]`ä¸º1ï¼ˆcnt[p]æ˜¯å½“å‰å‡ºç°æ¬¡æ•°ï¼‰ï¼Œè¿™æ ·å–äº¤é›†æ—¶è¿ç»­1çš„é•¿åº¦å°±æ˜¯minå€¼
>   - **ç©ºé—´ä¼˜åŒ–**ï¼šåˆ†ç»„å¤„ç†è¯¢é—®ï¼ˆæ¯ç»„çº¦2.5ä¸‡æ¬¡ï¼‰
> - å¯è§†åŒ–è®¾è®¡ï¼š  
>   - åƒç´ ç½‘æ ¼å±•ç¤ºåºåˆ—ï¼Œä¸åŒé¢œè‰²æ–¹å—è¡¨ç¤ºä¸åŒå€¼
>   - è«é˜ŸæŒ‡é’ˆç§»åŠ¨æ—¶ï¼Œä¸‹æ–¹bitsetæ¡å¸¦å¯¹åº”ä½ç½®äº®èµ·/ç†„ç­
>   - å–äº¤é›†æ—¶ä¸‰ç»„bitsetå¹¶æ’æ˜¾ç¤ºï¼Œäº¤é›†éƒ¨åˆ†é—ªçƒé»„å…‰
>   - 8-bitéŸ³æ•ˆï¼šç§»åŠ¨æŒ‡é’ˆ"å˜€"å£°ï¼Œå–äº¤é›†"å®"å£°ï¼Œå®Œæˆæ—¶è¶…çº§ç›ä¸½è¿‡å…³éŸ³æ•ˆ

---

## 2. ç²¾é€‰ä¼˜è´¨é¢˜è§£å‚è€ƒ

**é¢˜è§£ä¸€ï¼ˆshadowice1984ï¼‰**
* **ç‚¹è¯„**ï¼šæ€è·¯ç›´å‡»è¦å®³â€”â€”åˆ›æ–°ç¦»æ•£åŒ–æ–¹æ¡ˆè§£å†³é‡å¤å€¼é—®é¢˜ã€‚ä»£ç ç®€æ´é«˜æ•ˆï¼ˆä»…45è¡Œï¼‰ï¼Œåˆ†ç»„å¤„ç†é€»è¾‘æ¸…æ™°ã€‚äº®ç‚¹åœ¨äºï¼š
  - ç¦»æ•£åŒ–æ˜ å°„åˆ°å‰ç¼€å’Œä½ç½®ï¼Œè‡ªç„¶æ”¯æŒé‡å¤å€¼è®¡æ•°
  - è«é˜Ÿç§»åŠ¨æ—¶å…ˆå¢ååˆ é¿å…è´Ÿå€¼
  - åˆ†ç»„å¤§å°ç²¾ç¡®è®¡ç®—ï¼ˆ25000ç»„ï¼‰
  > *"ç¦»æ•£åŒ–æ—¶è®©ç›¸é‚»å€¼å·®ç­‰äºå‡ºç°æ¬¡æ•°ï¼Œä½¿bitsetèƒ½è‡ªç„¶è¡¨ç¤ºminæ“ä½œ"*

**é¢˜è§£äºŒï¼ˆrui_erï¼‰**
* **ç‚¹è¯„**ï¼šæ•™å­¦å¼è®²è§£å±‚å±‚é€’è¿›ï¼Œä»£ç è§„èŒƒæ˜“è¯»ã€‚äº®ç‚¹ï¼š
  - æ˜ç¡®æŒ‡é’ˆç§»åŠ¨é¡ºåºï¼ˆå…ˆæ‰©å¼ åæ”¶ç¼©ï¼‰
  - å®Œæ•´å°è£…solveå‡½æ•°æ”¯æŒå¤šç»„å¤„ç†
  - è¯¦ç»†æ³¨é‡Šå…³é”®å˜é‡ï¼ˆå¦‚`s[]`å­˜å‚¨å‡ºç°æ¬¡æ•°ï¼‰
  > *"è«é˜Ÿå¿…é¡»å…ˆè¿›é˜Ÿå†å‡ºé˜Ÿï¼é¡ºåºé”™è¯¯ä¼šå¯¼è‡´RE"*

**é¢˜è§£ä¸‰ï¼ˆRyo_Yamadaï¼‰**
* **ç‚¹è¯„**ï¼šå·¥ç¨‹å®ç°ä¸¥è°¨ï¼Œç»†èŠ‚å¤„ç†æ»¡åˆ†ã€‚äº®ç‚¹ï¼š
  - é‡‡ç”¨å¥‡å¶æ€§æ’åºä¼˜åŒ–è«é˜Ÿ
  - ä¸¥æ ¼é™åˆ¶bitsetå¤§å°ï¼ˆ25000ï¼‰
  - é”™è¯¯å¤„ç†å®Œå–„ï¼ˆå¦‚ç©ºæŒ‡é’ˆæ£€æŸ¥ï¼‰
  > *"åˆ†ç»„å¤„ç†æ˜¯ç©ºé—´ä¼˜åŒ–çš„å…³é”®ï¼Œç±»ä¼¼å¾ªç¯å±•å¼€çš„æ€æƒ³"*

---

## 3. æ ¸å¿ƒéš¾ç‚¹è¾¨æä¸è§£é¢˜ç­–ç•¥

1.  **éš¾ç‚¹ï¼šå¦‚ä½•è¡¨ç¤ºé‡å¤å€¼çš„minæ“ä½œï¼Ÿ**
    * **çªç ´æ–¹æ¡ˆ**ï¼šåˆ›æ–°ç¦»æ•£åŒ–â€”â€”æ˜ å°„å€¼=å°äºç­‰äºè¯¥å€¼çš„å…ƒç´ æ€»æ•°ã€‚ä¾‹å¦‚`[1,2,2,3]`æ˜ å°„ä¸º`[1,3,3,4]`ï¼Œä½¿bitsetä¸­è¿ç»­1çš„é•¿åº¦è‡ªç„¶è¡¨ç¤ºminå€¼
    * ğŸ’¡ **å­¦ä¹ ç¬”è®°**ï¼šç¦»æ•£åŒ–ä¸ä»…æ˜¯å‹ç¼©å€¼åŸŸï¼Œæ›´æ˜¯é‡æ„æ•°æ®å…³ç³»çš„è‰ºæœ¯

2.  **éš¾ç‚¹ï¼šbitsetç©ºé—´çˆ†ç‚¸**
    * **çªç ´æ–¹æ¡ˆ**ï¼šåˆ†ç»„å¤„ç†ï¼ˆçº¦2.5ä¸‡ç»„/æ¬¡ï¼‰ã€‚æ¯ç»„ç‹¬ç«‹è¿è¡Œè«é˜Ÿï¼Œå¤ç”¨bitsetç©ºé—´
    * ğŸ’¡ **å­¦ä¹ ç¬”è®°**ï¼šå½“æ•´ä½“ä¸å¯ä¸ºæ—¶ï¼Œåˆ†å‰²å¾æœæ˜¯ç»å…¸ç­–ç•¥

3.  **éš¾ç‚¹ï¼šæŒ‡é’ˆç§»åŠ¨é¡ºåº**
    * **çªç ´æ–¹æ¡ˆ**ï¼šåšæŒ"å…ˆæ‰©å¼ åæ”¶ç¼©"åŸåˆ™ï¼š`l--->r++->l++->r--`é¿å…è´Ÿå€¼
    * ğŸ’¡ **å­¦ä¹ ç¬”è®°**ï¼šè«é˜ŸæŒ‡é’ˆç§»åŠ¨åƒèˆè¹ˆæ­¥ä¼ï¼Œé”™è¯¯çš„é¡ºåºä¼šè¸©è„š

### âœ¨ è§£é¢˜æŠ€å·§æ€»ç»“
- **ç¦»æ•£åŒ–é‡æ„**ï¼šç”¨å‰ç¼€å’Œæ˜ å°„è§£å†³é‡å¤å€¼è®¡æ•°
- **bitsetä½è¿ç®—**ï¼šé€šè¿‡ä½åç§»å®ç°é«˜æ•ˆminæ“ä½œ
- **åˆ†ç»„å¤„ç†**ï¼šæ—¶é—´æ¢ç©ºé—´çš„æ ¸å¿ƒç­–ç•¥
- **é˜²å¾¡æ€§ç¼–ç¨‹**ï¼šåˆå§‹åŒ–cntæ•°ç»„ã€é‡ç½®bitseté¿å…è„æ•°æ®

---

## 4. C++æ ¸å¿ƒä»£ç å®ç°èµæ

**é€šç”¨æ ¸å¿ƒå®ç°å‚è€ƒ**
```cpp
#include <bits/stdc++.h>
using namespace std;
const int N=1e5+5, T=25000;

int n,m,a[N],cnt[N],ans[N];
bitset<N> res[T+5], cur; // åˆ†ç»„bitset

struct Query { int l,r,id; } q[N*3];

void solve(int group){
    memset(cnt,0,sizeof cnt); cur.reset();
    int cntq=0;
    // 1. ç»„è£…æœ¬ç»„è¯¢é—® (æ¯ç»„3ä¸ªåŒºé—´)
    for(int i=group;i<group+T && i<=m;i++){
        // è¯»å–ä¸‰ä¸ªåŒºé—´[l1,r1],[l2,r2],[l3,r3]
        // q[++cntq] = {l1,r1,i}; ... ç±»ä¼¼
        ans[i] += (r1-l1+1) + (r2-l2+1) + (r3-l3+1);
        res[i-group].set(); // åˆå§‹åŒ–bitset
    }
    // 2. è«é˜Ÿæ’åºä¸å¤„ç†
    sort(q+1,q+cntq+1,[](Query a,Query b){
        return a.l/500==b.l/500 ? a.r<b.r : a.l<b.l;
    });
    int l=1,r=0;
    for(int i=1;i<=cntq;i++){
        while(r<q[i].r) { r++; cur[a[r]+cnt[a[r]]]=1; cnt[a[r]]++; }
        while(l>q[i].l) { l--; cur[a[l]+cnt[a[l]]]=1; cnt[a[l]]++; }
        // åˆ é™¤æ“ä½œç±»ä¼¼ï¼ˆç•¥ï¼‰
        res[q[i].id-group] &= cur; // å–äº¤é›†
    }
    // 3. è®¡ç®—ç­”æ¡ˆ
    for(int i=group;i<group+T && i<=m;i++)
        ans[i] -= 3*res[i-group].count();
}

int main(){
    // ç¦»æ•£åŒ–ï¼ˆä¸å»é‡ï¼‰
    vector<int> temp;
    for(int i=1;i<=n;i++) temp.push_back(a[i]);
    sort(temp.begin(),temp.end());
    for(int i=1;i<=n;i++)
        a[i]=lower_bound(temp.begin(),temp.end(),a[i])-temp.begin()+1;

    // åˆ†ç»„å¤„ç†
    for(int i=1;i<=m;i+=T) solve(i);
}
```

**é¢˜è§£ä¸€æ ¸å¿ƒç‰‡æ®µèµæ**
```cpp
// åˆ›æ–°ç¦»æ•£åŒ–ï¼šæ˜ å°„åˆ°å‰ç¼€å’Œä½ç½®
for(it=mp.begin(),it1=it;++it1!=mp.end();++it,++it1) 
    it1->second += it->second;
for(int i=n;i>=1;i--) 
    a[i]=mp[a[i]]; // a[i]å˜ä¸ºå°äºç­‰äºå®ƒçš„å…ƒç´ æ€»æ•°

// bitsetæ’å…¥æ“ä½œ
inline void ins(int p){
    nb[p-cnt[p]]=1; // ç²¾å¦™çš„ä½åç§»
    cnt[p]++;
}
```

**é¢˜è§£äºŒæ ¸å¿ƒç‰‡æ®µèµæ**
```cpp
// å®‰å…¨çš„æŒ‡é’ˆç§»åŠ¨é¡ºåº
while(l > q[i].l) modify(--l, 1); // å…ˆæ‰©å¼ 
while(r < q[i].r) modify(++r, 1);
while(l < q[i].l) modify(l++, -1); // åæ”¶ç¼©
while(r > q[i].r) modify(r--, -1);

// åˆ†ç»„bitsetå¤„ç†
if(!vis[q[i].id]) 
    cnts[q[i].id]=cur; // é¦–æ¬¡èµ‹å€¼
else 
    cnts[q[i].id]&=cur; // åç»­å–äº¤
```

---

## 5. ç®—æ³•å¯è§†åŒ–ï¼šåƒç´ åŠ¨ç”»æ¼”ç¤º

**åƒç´ ä¸–ç•Œä¸­çš„è«é˜Ÿå¯»å®ä¹‹æ—…**  
* **ä¸»é¢˜**ï¼š8-bité£æ ¼ã€Šè«é˜Ÿå‹‡å£«é—¯ä¸‰å…³ã€‹  
* **æ ¸å¿ƒæ¼”ç¤º**ï¼šä¸‰ç»„åƒç´ ç½‘æ ¼ï¼ˆçº¢/è“/ç»¿ï¼‰ä»£è¡¨ä¸‰ä¸ªåŒºé—´ï¼Œä¸‹æ–¹ä¸‰æ¡bitsetå…‰å¸¦å®æ—¶æ˜¾ç¤ºçŠ¶æ€  

### åŠ¨ç”»å¸§åˆ†è§£ï¼š
1. **åœºæ™¯åˆå§‹åŒ–**ï¼ˆåƒç´ é£æ ¼ï¼‰ï¼š
   - é¡¶éƒ¨ï¼šåºåˆ—ç½‘æ ¼ï¼ˆ10x10æ–¹æ ¼ï¼‰ï¼Œä¸åŒé¢œè‰²æ–¹å—ä»£è¡¨ä¸åŒå€¼
   - åº•éƒ¨ï¼šä¸‰è‰²bitsetå…‰å¸¦ï¼ˆé»„=1ï¼Œé»‘=0ï¼‰
   - æ§åˆ¶é¢æ¿ï¼šæ­¥è¿›/æ’­æ”¾/é€Ÿåº¦æ¡ï¼ˆFCæ‰‹æŸ„æ ·å¼ï¼‰

2. **è«é˜Ÿç§»åŠ¨**ï¼ˆéŸ³æ•ˆï¼šç§»åŠ¨"å˜€"å£°ï¼‰ï¼š
   ```plaintext
   ç¤ºä¾‹ï¼šå³æŒ‡é’ˆræ‰©å±•
   [åºåˆ—] æ–°å¢è“è‰²æ–¹å—åœ¨(3,5)ä½ç½®äº®èµ·
   [bitset] è“è‰²å…‰å¸¦ç¬¬5ä½"å•ª"åœ°äº®èµ·é»„å…‰
   ```

3. **å–äº¤é›†æ—¶åˆ»**ï¼ˆéŸ³æ•ˆï¼š"å®"ï¼‰ï¼š
   ```plaintext
   ä¸‰è‰²å…‰å¸¦å¹¶æ’æ˜¾ç¤º â†’ ç›¸åŒä½ç½®é»„å…‰é—ªçƒä¸‰æ¬¡ â†’ 
   äº¤é›†éƒ¨åˆ†å‡èµ·é‡‘è‰²æ˜Ÿæ˜Ÿ â˜…
   ```

4. **è¿‡å…³åŠ¨ç”»**ï¼ˆéŸ³æ•ˆï¼šè¶…çº§ç›ä¸½è¿‡å…³ï¼‰ï¼š
   ```plaintext
   å®Œæˆä¸€ç»„è¯¢é—® â†’ å®ç®±æ‰“å¼€è¹¦å‡ºæ•°å­—ç­”æ¡ˆ â†’ 
   "å¾—æ•‘å•¦ï¼ç­”æ¡ˆ=3ï¼"
   ```

### æŠ€æœ¯å®ç°è¦ç‚¹ï¼š
- **Canvasç»˜åˆ¶**ï¼šç½‘æ ¼ç”¨`fillRect`ç»˜åˆ¶ï¼Œbitsetå…‰å¸¦åŠ¨ç”»ç”¨çº¿æ€§æ’å€¼
- **éŸ³æ•ˆè§¦å‘**ï¼šWeb Audio APIæ’­æ”¾8-bitéŸ³æ•ˆç‰‡æ®µ
- **æ¸¸æˆåŒ–è®¾è®¡**ï¼šæ¯å¤„ç†å®Œä¸€ç»„è¯¢é—®è·å¾—1æš"ç®—æ³•é‡‘å¸"

---

## 6. æ‹“å±•ç»ƒä¹ ä¸ç›¸ä¼¼é—®é¢˜æ€è€ƒ

1. **æ´›è°·P1494-å°Zçš„è¢œå­**  
   ğŸ—£ï¸ *æ¨èç†ç”±*ï¼šè«é˜Ÿå…¥é—¨å¿…åšï¼Œç»Ÿè®¡åŒºé—´åŒé¢œè‰²å¯¹æ•°é‡ï¼Œå·©å›ºåŸºç¡€è«é˜Ÿæ€æƒ³

2. **æ´›è°·P3709-å¤§çˆ·çš„å­—ç¬¦ä¸²é¢˜**  
   ğŸ—£ï¸ *æ¨èç†ç”±*ï¼šè¿›é˜¶è«é˜Ÿåº”ç”¨ï¼Œæ±‚åŒºé—´ä¼—æ•°å‡ºç°æ¬¡æ•°ï¼Œå¼ºåŒ–åˆ†å—æ€ç»´

3. **æ´›è°·P4137-Rmq Problem**  
   ğŸ—£ï¸ *æ¨èç†ç”±*ï¼šåŒºé—´mexé—®é¢˜ï¼Œç»“åˆå€¼åŸŸåˆ†å—ä¸è«é˜Ÿï¼Œæå‡é—®é¢˜è½¬åŒ–èƒ½åŠ›

---

## 7. å­¦ä¹ å¿ƒå¾—ä¸ç»éªŒåˆ†äº«
> **æ¥è‡ªshadowice1984çš„è°ƒè¯•ç»éªŒ**ï¼š  
> *"æœ€åˆåœ¨bitsetä½ç½®è®¡ç®—ä¸Šå¡äº†2å°æ—¶ï¼Œåæ¥å‘ç°æ˜¯ç¦»æ•£åŒ–æ˜ å°„ç†è§£åå·®ã€‚æ‰“å°`cnt[p]`çš„ä¸­é—´çŠ¶æ€åè±ç„¶å¼€æœ—"*  
>   
> **Kayæ€»ç»“**ï¼šåœ¨æ¶‰åŠä½æ“ä½œçš„å¤æ‚ç®—æ³•ä¸­ï¼Œè¾“å‡ºå…³é”®å˜é‡ï¼ˆå¦‚`cnt[]`ï¼‰çš„ä¸­é—´çŠ¶æ€æ˜¯è°ƒè¯•çš„é‡‘é’¥åŒ™ï¼

---

æœ¬æ¬¡å…³äº"æ‰è¿›å…”å­æ´"çš„è§£æå°±åˆ°è¿™é‡Œã€‚è®°ä½ï¼Œä¼˜ç§€çš„ç®—æ³•=åˆ›æ–°æ€è·¯+ä¸¥è°¨å®ç°+é€‚é‡ä¼˜åŒ–ã€‚ä¸‹æ¬¡æŒ‘æˆ˜è§ï¼ğŸš€

---
å¤„ç†ç”¨æ—¶ï¼š122.63ç§’
# é¢˜ç›®ä¿¡æ¯

# [Ynoi Easy Round 2016] è¿™æ˜¯æˆ‘è‡ªå·±çš„å‘æ˜

## é¢˜ç›®èƒŒæ™¯

ä¸€åˆ‡ä¼Ÿå¤§çš„ä¸–ç•Œå†å²äº‹ä»¶ä¸äººç‰©ï¼Œå¯ä»¥è¯´éƒ½ä¼šå‡ºç°ä¸¤æ¬¡

ç¬¬ä¸€æ¬¡æ˜¯ä½œä¸ºæ‚²å‰§å‡ºç°

ç¬¬äºŒæ¬¡ï¼Œåˆ™æ˜¯ä½œä¸ºç¬‘å‰§å‡ºç°

â€”â€”ã€Šè·¯æ˜“.æ³¢æ‹¿å·´çš„é›¾æœˆåå…«æ—¥ã€‹

æ„ŸåŠ¨ã€

ç—›è‹¦ã€

ä»¥åŠå¿«ä¹ã€

éƒ½åªæ˜¯é¥ä¸å¯åŠçš„å®çŸ³

å³ä¾¿å¦‚æ­¤ï¼Œäººä»¬å•Šï¼Œ

è·å¾—å¹¸ç¦å§ï¼

![](https://cdn.luogu.com.cn/upload/pic/21098.png)

ä¸–ç•Œå°†åœ¨7æœˆ20æ—¥ç»ˆç»“

ä¸–ç•Œå›å½’å¤©ç©ºçš„æ—¥å­

ä¸‡ç‰©è¢«å¤©ç©ºä¾µæŸ“çš„æ—¥å­

å›å½’å¤©ç©ºçš„æ—¥å­

ä¸–ç•Œå¿…é¡»å›å½’

ä¸–ç•Œçš„æé™

ä¸–ç•Œçš„å°½å¤´

ä¸–ç•Œçš„ç»ˆç»“

![](https://cdn.luogu.com.cn/upload/pic/21099.png)

ä½ çœ‹â€¦é‚£å°±æ˜¯æé™â€¦æœ€å°½å¤´çš„å¤©ç©º

å¦‚ä»Šï¼Œå·²æ— åº”è¯¥ä¹‹äº‹äº†å¦‚ä»Šï¼Œå·²æ— å¿˜å´ä¹‹ç‰©äº†

ä¸éœ€è¦çš„è¯è¯­

![](https://cdn.luogu.com.cn/upload/pic/21100.png)

å‘Šåˆ«äº†æ°¸ä¸ç›¸äº¤çš„å¹³è¡Œï¼Œæˆ‘è¢«å¸è¿›äº†â€¦

å‚ç›´ä¸‹è½çš„ä¸–ç•Œ

![](https://cdn.luogu.com.cn/upload/pic/21101.png)

è™½å“­äº¦å–œ

è™½æ‚²äº¦å–œ

å„ç§æ„Ÿæƒ…æ··åœ¨ä¸€èµ·...

æ¯”èµ·å…¶ä»–æ‰€æœ‰ï¼Œæƒ³å¿…è¿˜æ˜¯é«˜å…´å å¤šå§

å¥¹é«˜å…´åœ°æŠ±ç€æˆ‘

ç´§ç´§åœ°æŠ±ç€

å†ä¹Ÿä¸ä¼šæ¾å¼€äº†...

æƒ³æ°¸è¿œè¿™æ ·...

å¥¹çš„æ€ç»ªï¼Œä»¥æ¯”è¯­è¨€æ›´å¿«çš„é€Ÿåº¦ï¼Œä¼ è¾¾ç»™äº†æˆ‘

æœ‰äº›ä¸œè¥¿ï¼Œæ¯”è¯­è¨€æ›´å¿«

å¥¹çš„æ€ç»ªï¼Œä»¥æ¯”è¯­è¨€æ›´å¿«çš„é€Ÿåº¦ï¼Œä¼ è¾¾ç»™äº†æˆ‘

æœ‰äº›ä¸œè¥¿ï¼Œæ¯”è¯­éŸ³æ›´å‡†ç¡®

ä¸–ç•Œä¸Šæ— è®ºå¤šä¹ˆçŸ­æš‚çš„ç¬é—´ï¼Œéƒ½æœ‰æ„ä¹‰

æœ‰æ„ä¹‰

å—ä¸´è¿‘ç»ˆç»“äº†

æœ€åçš„ç¬é—´

å•Šå•Š...

è¿œæ–¹çš„è­¦ç¬›å£°

é»‘è‰²çš„å¤©ç©º

æœˆæ­£ç¬‘

åœ°æ­£æ¶¦æ½®

æ˜Ÿæ­£èˆ

é£æ­£å‡‰

åœ¨æˆ‘æ€€ä¸­ï¼Œæ¸©æš–çš„ï¼Œ

æ©˜å¸Œå®é¦™

![](https://cdn.luogu.com.cn/upload/pic/21103.png)

å¥¹åœ¨æˆ‘çš„æ€€ä¸­...é™é™åœ°åˆä¸Šäº†åŒçœ¼

ç„¶åæˆ‘ä¹Ÿ...

é™é™åœ°åˆä¸Šäº†åŒçœ¼

## é¢˜ç›®æè¿°

æ‚¨æ­£åœ¨æ‰“ galgameï¼Œç„¶åçªç„¶å®¶é•¿è¿›æ¥äº†ï¼Œäºæ˜¯æ‚¨å‡è£…åœ¨å†™æ•°æ®ç»“æ„é¢˜ï¼š

ç»™ä¸€ä¸ªæ ‘ï¼Œ$n$ ä¸ªç‚¹ï¼Œæœ‰ç‚¹æƒï¼Œåˆå§‹æ ¹æ˜¯Â 1ã€‚

$m$Â ä¸ªæ“ä½œï¼Œç§ç±»å¦‚ä¸‹ï¼š

`1 x` å°†æ ‘æ ¹æ¢ä¸ºÂ $x$ã€‚

`2 x y` ç»™å‡ºä¸¤ä¸ªç‚¹Â $x,y$ï¼Œä»Â $x$Â çš„å­æ ‘ä¸­é€‰æ¯ä¸€ä¸ªç‚¹ï¼Œ$y$Â çš„å­æ ‘ä¸­é€‰æ¯ä¸€ä¸ªç‚¹ï¼Œæ±‚ç‚¹æƒç›¸ç­‰çš„æƒ…å†µæ•°ã€‚


## è¯´æ˜/æç¤º

Ideaï¼šnzhtl1477ï¼ŒSolutionï¼šnzhtl1477ï¼ŒCodeï¼šnzhtl1477ï¼ŒDataï¼šnzhtl1477

ã€æ•°æ®èŒƒå›´ã€‘   
å¯¹äº $100\%$ çš„æ•°æ®ï¼Œ$1\le n \le 10^5$ï¼Œ$1 \le m \le 5\times 10^5$ , $1 \le a_i \le 10^9$ã€‚

## æ ·ä¾‹ #1

### è¾“å…¥

```
5 5
1 2 3 4 5
1 2
1 3
3 4
3 5
2 4 5
2 1 5
2 3 5
1 5
2 4 5```

### è¾“å‡º

```
0
1
1
1```

# AIåˆ†æç»“æœ


### ğŸ’¡ Kayçš„C++ç®—æ³•è§£æï¼š[Ynoi Easy Round 2016] è¿™æ˜¯æˆ‘è‡ªå·±çš„å‘æ˜ æ·±å…¥å­¦ä¹ æŒ‡å— ğŸ’¡

#### 1. é¢˜ç›®è§£è¯»ä¸æ ¸å¿ƒç®—æ³•è¯†åˆ«
âœ¨ **æœ¬é¢˜ä¸»è¦è€ƒå¯Ÿ**ï¼š`DFSåºè½¬åŒ–` + `è«é˜Ÿç®—æ³•` + `æ ¹å·åˆ†æ²»`

ğŸ—£ï¸ **åˆæ­¥åˆ†æ**ï¼š
> æœ¬é¢˜è¦æ±‚å¤„ç†æ ‘ä¸Šæ¢æ ¹åçš„å­æ ‘æŸ¥è¯¢ï¼Œæ ¸å¿ƒæ€æƒ³æ˜¯å°†**æ ‘ç»“æ„è½¬åŒ–ä¸ºåºåˆ—é—®é¢˜**ã€‚é€šè¿‡DFSåºå°†å­æ ‘æ˜ å°„ä¸ºåŒºé—´ï¼ˆæ¢æ ¹æ—¶æœ€å¤šæ‹†æˆä¸¤ä¸ªåŒºé—´ï¼‰ï¼Œå°†"å­æ ‘ç‚¹å¯¹æŸ¥è¯¢"è½¬åŒ–ä¸º**åºåˆ—åŒºé—´æŸ¥è¯¢**ã€‚åˆ©ç”¨è«é˜Ÿç®—æ³•é«˜æ•ˆå¤„ç†å¤§é‡åŒºé—´æŸ¥è¯¢ï¼Œå¹¶é€šè¿‡æ ¹å·åˆ†æ²»ä¼˜åŒ–ä¸åŒé¢œè‰²å‡ºç°é¢‘ç‡çš„ç»Ÿè®¡ã€‚

- **æ ¸å¿ƒéš¾ç‚¹**ï¼šæ¢æ ¹æ—¶å­æ ‘åŒºé—´çš„åŠ¨æ€ç¡®å®šã€‚è®¾å½“å‰æ ¹ä¸º`rt`ï¼ŒèŠ‚ç‚¹`x`çš„å­æ ‘åŒºé—´åˆ†ä¸‰ç§æƒ…å†µï¼š
  1. `x == rt`ï¼šæ•´æ£µæ ‘ â†’ `[1, n]`
  2. `rt`ä¸åœ¨`x`å­æ ‘ï¼šåŸDFSåŒºé—´ â†’ `[dfn[x], dfn[x]+siz[x]-1]`
  3. `rt`åœ¨`x`å­æ ‘ï¼šæ•´æ£µæ ‘å‡å»`xâ†’rt`è·¯å¾„ä¸Š`x`çš„ç›´æ¥å­èŠ‚ç‚¹å­æ ‘ â†’ ä¸¤ä¸ªåŒºé—´
- **å¯è§†åŒ–è®¾è®¡**ï¼šé‡‡ç”¨8ä½åƒç´ é£æ ¼å±•ç¤ºDFSåºæ„å»ºè¿‡ç¨‹ï¼ŒèŠ‚ç‚¹ä»¥å½©è‰²æ–¹å—è¡¨ç¤ºã€‚æ¢æ ¹æ“ä½œæ—¶ï¼Œè¢«æ‹†åˆ†çš„å­æ ‘åŒºé—´ç”¨é—ªçƒçº¢çº¿æ ‡è®°ï¼Œä¼´éš"å®"éŸ³æ•ˆã€‚è«é˜ŸæŒ‡é’ˆç§»åŠ¨æ—¶ï¼Œå½“å‰å¤„ç†çš„åŒºé—´é«˜äº®æ˜¾ç¤ºï¼Œæ•°æ®å—å˜åŒ–æ—¶æ’­æ”¾åƒç´ éŸ³æ•ˆã€‚

---

#### 2. ç²¾é€‰ä¼˜è´¨é¢˜è§£å‚è€ƒ
**é¢˜è§£ä¸€ï¼ˆshadowice1984 - æ ¹å·åˆ†æ²»ï¼‰**
* **ç‚¹è¯„**ï¼š
  - æ€è·¯ï¼šå°†é¢œè‰²æŒ‰å‡ºç°é¢‘ç‡åˆ†æ²»ï¼ˆ>âˆšnç”¨å…¨å±€ç»Ÿè®¡ï¼Œ<âˆšnç”¨äºŒç»´æ•°ç‚¹ï¼‰ã€‚æ ¹å·åˆ†æ²»é™ä½å¤æ‚åº¦è‡³O(nâˆšn)ã€‚
  - ä»£ç ï¼šå˜é‡å‘½åè§„èŒƒï¼ˆ`ccnt`ç»Ÿè®¡é¢œè‰²ï¼‰ï¼Œè¾¹ç•Œå¤„ç†ä¸¥è°¨ï¼ˆ`dg`è®°å½•åº¦æ•°ï¼‰ã€‚å…³é”®ä¼˜åŒ–ï¼šå¯¹ç¨€ç–é¢œè‰²ç”¨åˆ†å—æ›¿ä»£æ ‘çŠ¶æ•°ç»„ï¼Œé¿å…O(nâˆšn log n)ã€‚
  - äº®ç‚¹ï¼šç©ºé—´ä¼˜åŒ–ï¼ˆæ»šåŠ¨æ•°ç»„ï¼‰ï¼Œå®è·µæ€§å¼ºï¼ˆå¯ç›´æ¥ç”¨äºç«èµ›ï¼‰ã€‚

**é¢˜è§£äºŒï¼ˆyuzhechuan - è«é˜Ÿæ‹†è§£ï¼‰**
* **ç‚¹è¯„**ï¼š
  - æ€è·¯ï¼šå°†å­æ ‘åŒºé—´æ‹†ä¸ºæœ€å¤š4æ®µï¼ˆç±»æ¯”SNOI2017ï¼‰ï¼Œç”¨è«é˜Ÿå¤„ç†ã€‚éšæœºé€‰æ ¹åˆå§‹åŒ–çš„ä¼˜åŒ–å¢å¼ºç¨³å®šæ€§ã€‚
  - ä»£ç ï¼šç»“æ„æ¸…æ™°ï¼ˆ`Query`ç»“æ„ä½“ï¼‰ï¼Œè«é˜Ÿæ’åºä½¿ç”¨å¥‡å¶ä¼˜åŒ–ã€‚å…³é”®å˜é‡`dfn`/`siz`å«ä¹‰æ˜ç¡®ã€‚
  - äº®ç‚¹ï¼šéšæœºåŒ–é¿å…æœ€åæƒ…å†µï¼Œå‡å°‘æ‹†è§£åŒºé—´æ•°ï¼ˆå‡æ‘Š4å€ï¼‰ã€‚

**é¢˜è§£ä¸‰ï¼ˆSol1 - è«é˜Ÿä¼˜åŒ–ï¼‰**
* **ç‚¹è¯„**ï¼š
  - æ€è·¯ï¼šé€šè¿‡ä»£æ•°å˜æ¢å°†16ä¸ªæŸ¥è¯¢å‡è‡³4ä¸ªï¼ˆåˆ©ç”¨å®¹æ–¥åŸç†ï¼‰ï¼Œå¤§å¹…é™ä½å¸¸æ•°ã€‚
  - ä»£ç ï¼šæ¨¡å—åŒ–ï¼ˆ`AddQuery`å°è£…ï¼‰ï¼Œé«˜æ•ˆLCAï¼ˆå€å¢ï¼‰ã€‚ç¦»æ•£åŒ–é¢„å¤„ç†æå‡æ€§èƒ½ã€‚
  - äº®ç‚¹ï¼šæ•°å­¦ä¼˜åŒ–ï¼ˆè´¡çŒ®è®¡ç®—å¼ï¼‰ï¼Œå¤æ‚åº¦ä¸¥æ ¼O(nâˆšn)ã€‚

---

#### 3. æ ¸å¿ƒéš¾ç‚¹è¾¨æä¸è§£é¢˜ç­–ç•¥
1. **éš¾ç‚¹ï¼šå­æ ‘åŒºé—´åŠ¨æ€ç¡®å®š**
   - **åˆ†æ**ï¼šæ¢æ ¹æ—¶éœ€åˆ†ç±»è®¨è®ºå­æ ‘åŒºé—´ï¼ˆæ•´åŒºé—´/ä¸¤åŒºé—´ï¼‰ã€‚å…³é”®æŠ€å·§ï¼šç”¨`LCA`å’Œ`dfn`åˆ¤æ–­ä½ç½®å…³ç³»ï¼Œ`getson`æ‰¾è·¯å¾„èŠ‚ç‚¹ã€‚
   - ğŸ’¡ å­¦ä¹ ç¬”è®°ï¼šDFSåºæ˜¯é™æ€çš„ï¼Œæ¢æ ¹ä»…æ”¹å˜åŒºé—´å®šä¹‰æ–¹å¼ã€‚

2. **éš¾ç‚¹ï¼šè·¨å­æ ‘æŸ¥è¯¢ä¼˜åŒ–**
   - **åˆ†æ**ï¼šè«é˜Ÿå¤„ç†åŒºé—´å¯¹åŒºé—´æ—¶ï¼Œé€šè¿‡å®¹æ–¥æ‹†è§£ä¸º4ä¸ªå‰ç¼€æŸ¥è¯¢ï¼ˆ`f(1,r1,1,r2)`å½¢å¼ï¼‰ï¼Œé¿å…äºŒç»´æ•°ç‚¹ã€‚
   - ğŸ’¡ å­¦ä¹ ç¬”è®°ï¼šå®¹æ–¥è½¬åŒ–æ˜¯åŒºé—´å¯¹æŸ¥è¯¢çš„æ ¸å¿ƒæŠ€å·§ã€‚

3. **éš¾ç‚¹ï¼šå¤§æ•°æ®é¢œè‰²ç»Ÿè®¡**
   - **åˆ†æ**ï¼šæ ¹å·åˆ†æ²»å¹³è¡¡å¤æ‚åº¦ã€‚é«˜é¢‘é¢œè‰²ç›´æ¥ç®—è´¡çŒ®ï¼ˆO(1)ï¼‰ï¼Œä½é¢‘é¢œè‰²ç”¨åˆ†å—ç»´æŠ¤è®¡æ•°ã€‚
   - ğŸ’¡ å­¦ä¹ ç¬”è®°ï¼šæ ¹æ®å‡ºç°é¢‘ç‡é€‰æ‹©ç­–ç•¥æ˜¯å¸¸è§ä¼˜åŒ–æ‰‹æ®µã€‚

### âœ¨ è§£é¢˜æŠ€å·§æ€»ç»“
- **æŠ€å·§1ï¼šé—®é¢˜åˆ†è§£**  
  å°†æ ‘â†’åºåˆ—â†’å‰ç¼€æŸ¥è¯¢ï¼Œé€æ­¥é™ç»´ï¼ˆæ ‘ç»“æ„â†’çº¿æ€§ç»“æ„â†’å‰ç¼€å’Œï¼‰ã€‚
- **æŠ€å·§2ï¼šè«é˜Ÿä¼˜åŒ–**  
  å¥‡å¶æ’åºå‡å°‘æŒ‡é’ˆç§»åŠ¨ï¼Œéšæœºåˆå§‹åŒ–é¿å…å¡é“¾ã€‚
- **æŠ€å·§3ï¼šè¾¹ç•Œå¤„ç†**  
  æ¢æ ¹æ—¶ç‰¹åˆ¤`x==rt`ï¼ŒDFSåºå¤åˆ¶ä¸€å€å¤„ç†ç¯çŠ¶åŒºé—´ã€‚

---

#### 4. C++æ ¸å¿ƒä»£ç å®ç°èµæ
**é€šç”¨æ ¸å¿ƒå®ç°ï¼ˆç»¼åˆSol1/yuzhechuanæ€è·¯ï¼‰**
```cpp
#include <bits/stdc++.h>
#define ll long long
using namespace std;
const int N=1e5+5, M=5e5+5;
int n,m,rt=1,dfn[N],siz[N],fa[N][20],dep[N],idx;
vector<int> g[N];
int a[N],mp[N],blk,bl[N],cnt1[N],cnt2[N];
ll ans[M],cur;
struct Query { int l,r,id,f; };
vector<Query> q;

void dfs(int u,int f) {
    dfn[u]=++idx; mp[idx]=a[u]; siz[u]=1;
    fa[u][0]=f; dep[u]=dep[f]+1;
    for(int i=1;i<18;i++) fa[u][i]=fa[fa[u][i-1]][i-1];
    for(int v:g[u]) if(v!=f) 
        dfs(v,u), siz[u]+=siz[v];
}

int lca(int x,int y) {
    if(dep[x]<dep[y]) swap(x,y);
    for(int i=17;i>=0;i--) 
        if(dep[fa[x][i]]>=dep[y]) x=fa[x][i];
    if(x==y) return x;
    for(int i=17;i>=0;i--)
        if(fa[x][i]!=fa[y][i]) x=fa[x][i],y=fa[y][i];
    return fa[x][0];
}

int getson(int x,int y) {
    for(int i=17;i>=0;i--)
        if(dep[fa[x][i]]>dep[y]) x=fa[x][i];
    return x;
}

void add_query(int l1,int r1,int l2,int r2,int id) {
    if(l1>r1||l2>r2) return;
    auto push=[&](int l1,int r1,int l2,int r2,int f){
        q.push_back({r1,r2,id,f});
        if(l1>1) q.push_back({l1-1,r2,id,-f});
        if(l2>1) q.push_back({r1,l2-1,id,-f});
        if(l1>1&&l2>1) q.push_back({l1-1,l2-1,id,f});
    };
    push(l1,r1,l2,r2,1);
}

void expand(int x,vector<pair<int,int>>&seg) {
    if(x==rt) seg.emplace_back(1,n);
    else {
        int t=lca(x,rt);
        if(t!=x) seg.emplace_back(dfn[x],dfn[x]+siz[x]-1);
        else {
            int s=getson(rt,x);
            if(dfn[s]>1) seg.emplace_back(1,dfn[s]-1);
            if(dfn[s]+siz[s]-1<n) 
                seg.emplace_back(dfn[s]+siz[s],n);
        }
    }
}

int main() {
    scanf("%d%d",&n,&m);
    blk=sqrt(n); for(int i=1;i<=n;i++) bl[i]=(i-1)/blk+1;
    for(int i=1;i<=n;i++) scanf("%d",&a[i]);
    for(int i=1,u,v;i<n;i++) {
        scanf("%d%d",&u,&v);
        g[u].push_back(v); g[v].push_back(u);
    }
    dfs(1,0);
    while(m--) {
        int op,x,y; scanf("%d%d",&op,&x);
        if(op==1) rt=x;
        else {
            scanf("%d",&y); int id=++ans[0];
            vector<pair<int,int>> sx,sy;
            expand(x,sx); expand(y,sy);
            for(auto &[l1,r1]:sx) for(auto &[l2,r2]:sy) 
                add_query(l1,r1,l2,r2,id);
        }
    }
    sort(q.begin(),q.end(),[](auto &a,auto &b){
        return bl[a.l]==bl[b.l]?(bl[a.l]&1?a.r<b.r:a.r>b.r):a.l<b.l;
    });
    int l=0,r=0;
    for(auto &[ql,qr,id,f]:q) {
        while(l<ql) { l++; cur+=cnt2[mp[l]]; cnt1[mp[l]]++; }
        while(r<qr) { r++; cur+=cnt1[mp[r]]; cnt2[mp[r]]++; }
        ans[id]+=cur*f;
    }
    for(int i=1;i<=ans[0];i++) printf("%lld\n",ans[i]);
}
```

**ä»£ç è§£è¯»æ¦‚è¦**ï¼š
1. **DFSåºæ„å»º**ï¼š`dfs()`ç”Ÿæˆé™æ€DFSåºï¼Œ`mp[]`å­˜å‚¨åºåˆ—å€¼
2. **åŒºé—´æ‹†è§£**ï¼š`expand()`æ ¹æ®æ ¹ä½ç½®è®¡ç®—å­æ ‘åŒºé—´
3. **æŸ¥è¯¢å°è£…**ï¼š`add_query()`ç”¨å®¹æ–¥å°†åŒºé—´å¯¹æ‹†ä¸º4ä¸ªå‰ç¼€æŸ¥è¯¢
4. **è«é˜Ÿæ ¸å¿ƒ**ï¼šåŒæŒ‡é’ˆç§»åŠ¨æ—¶åŠ¨æ€ç»´æŠ¤`cnt1/cnt2`è®¡æ•°æ•°ç»„

---

### 5. ç®—æ³•å¯è§†åŒ–ï¼šåƒç´ åŠ¨ç”»æ¼”ç¤º
#### è®¾è®¡æ€è·¯
- **é£æ ¼**ï¼š8ä½æœºåƒç´ é£ï¼ˆFCçº¢ç™½æœºè‰²è°ƒï¼‰
- **ç›®æ ‡**ï¼šç›´è§‚å±•ç¤ºDFSåºæ„å»ºä¸è«é˜ŸæŒ‡é’ˆç§»åŠ¨

#### åŠ¨ç”»å¸§æ­¥éª¤
1. **åœºæ™¯åˆå§‹åŒ–**  
   - æ ‘ç»“æ„è½¬ä¸ºç½‘æ ¼å¸ƒå±€ï¼ˆèŠ‚ç‚¹=16x16åƒç´ å—ï¼‰
   - æ§åˆ¶é¢æ¿ï¼šå¼€å§‹/æš‚åœã€å•æ­¥ã€é€Ÿåº¦æ»‘å—

2. **DFSåºæ„å»ºï¼ˆä¼´éšéŸ³æ•ˆï¼‰**  
   - æ ¹èŠ‚ç‚¹é—ªçƒç»¿å…‰ï¼Œé€’å½’æ—¶å­èŠ‚ç‚¹æŒ‰éå†é¡ºåºäº®èµ·
   - èŠ‚ç‚¹ç¼–å·ä¸‹æ–¹æ˜¾ç¤º`dfn/siz`å€¼ï¼Œç”Ÿæˆåºåˆ—åœ¨åº•éƒ¨æ»šåŠ¨

3. **æ¢æ ¹æ“ä½œ**  
   - æ–°æ ¹èŠ‚ç‚¹é—ªçƒçº¢å…‰ï¼Œå—å½±å“å­æ ‘è¾¹ç•Œæ ‡çº¢çº¿
   - è¢«æ‹†åˆ†çš„å­æ ‘åŒºé—´ç”¨è™šçº¿æ¡†æ ‡è®°ï¼Œæ’­æ”¾"æ‹†åˆ†"éŸ³æ•ˆ

4. **è«é˜ŸæŸ¥è¯¢å¤„ç†**  
   - å½“å‰æŸ¥è¯¢åŒºé—´é«˜äº®é»„æ¡†
   - æŒ‡é’ˆç§»åŠ¨æ—¶ï¼Œæ–°åŠ å…¥å—å˜è“ï¼Œç¦»å¼€å—å˜ç°
   - å…³é”®æ“ä½œï¼šé¢œè‰²åŒ¹é…æˆåŠŸæ—¶æ’­æ”¾"å®"éŸ³æ•ˆï¼Œè®¡æ•°+1

5. **æ¸¸æˆåŒ–å…ƒç´ **  
   - æ¯å®Œæˆ1e5æ¬¡æŸ¥è¯¢ï¼Œæ˜¾ç¤º"COMBO!"å¹¶å¥–åŠ±åˆ†æ•°
   - èƒŒæ™¯éŸ³ä¹ï¼š8-bité£æ ¼å¾ªç¯BGM

---

### 6. æ‹“å±•ç»ƒä¹ ä¸ç›¸ä¼¼é—®é¢˜æ€è€ƒ
1. **é€šç”¨æŠ€å·§è¿ç§»**ï¼š
   - DFSåº+åŒºé—´æŸ¥è¯¢ï¼šå­æ ‘ç»Ÿè®¡ã€è·¯å¾„é—®é¢˜
   - è«é˜Ÿ+å®¹æ–¥ï¼šåŒºé—´å¯¹æŸ¥è¯¢é—®é¢˜
   - æ ¹å·åˆ†æ²»ï¼šå¹³è¡¡æ—¶é—´/ç©ºé—´å¤æ‚åº¦

2. **æ¨èç»ƒä¹ ï¼ˆæ´›è°·ï¼‰**ï¼š
   1. **P5268 [SNOI2017]ä¸€ä¸ªç®€å•çš„è¯¢é—®**  
      - åŒç±»åŒºé—´é—®é¢˜ç®€åŒ–ç‰ˆï¼Œæ— æ ‘ç»“æ„
   2. **P4074 [WC2013]ç³–æœå…¬å›­**  
      - å¸¦ä¿®è«é˜Ÿ+æ ‘ç»“æ„ï¼Œè®­ç»ƒä¸‰ç»´è«é˜Ÿ
   3. **P3245 [HNOI2016]å¤§æ•°**  
      - æ ¹å·åˆ†æ²»ç»å…¸åº”ç”¨ï¼Œå¤„ç†å¤§æ•°æ¨¡é—®é¢˜

---

### 7. å­¦ä¹ å¿ƒå¾—ä¸ç»éªŒåˆ†äº«
> **shadowice1984çš„è°ƒè¯•ç»éªŒ**ï¼š
> "å¤„ç†äºŒç»´æ•°ç‚¹æ—¶å‘ç°O(nâˆšn log n)è¶…æ—¶ï¼Œæ”¹ç”¨åˆ†å—å¹³è¡¡é¢„å¤„ç†å’ŒæŸ¥è¯¢ä»£ä»·ã€‚å…³é”®ç‚¹ï¼šå½“æ•°æ®ç»“æ„æˆä¸ºç“¶é¢ˆæ—¶ï¼Œç®€åŒ–å¤„ç†ï¼ˆå¦‚åˆ†å—æ›¿æ¢æ ‘çŠ¶æ•°ç»„ï¼‰å¾€å¾€æ›´æœ‰æ•ˆã€‚"

> **Sol1çš„ä¼˜åŒ–å¿ƒå¾—**ï¼š
> "é€šè¿‡ä»£æ•°å˜æ¢å°†16ä¸ªæŸ¥è¯¢å‡è‡³4ä¸ªï¼Œæ•°å­¦ä¼˜åŒ–æœ‰æ—¶æ¯”ä»£ç ä¼˜åŒ–æ›´å…³é”®ã€‚è«é˜Ÿçš„æ’åºæ–¹å¼å¯¹å®é™…è¿è¡Œå½±å“å·¨å¤§ï¼Œå¥‡å¶æ’åºå¯æå‡50%æ•ˆç‡ã€‚"

---

### ç»“è¯­
é€šè¿‡DFSåºè½¬åŒ–å’Œè«é˜Ÿç®—æ³•çš„ç²¾å¦™ç»“åˆï¼Œé…åˆæ ¹å·åˆ†æ²»ç­‰ä¼˜åŒ–æŠ€å·§ï¼Œå³å¯é«˜æ•ˆè§£å†³æœ¬é¢˜ã€‚å…³é”®åœ¨äºæŒæ¡é—®é¢˜åˆ†è§£æ€æƒ³ï¼šæ ‘ç»“æ„â†’åºåˆ—â†’åŒºé—´æŸ¥è¯¢â†’å‰ç¼€å’Œã€‚æœ¬æŒ‡å—ä¸­çš„ä»£ç å®ç°å’Œå¯è§†åŒ–æ–¹æ¡ˆå°†åŠ©ä½ æ·±å…¥ç†è§£ç®—æ³•æœ¬è´¨ï¼Œä¸¾ä¸€åä¸‰åº”å¯¹å„ç±»å˜å¼æŒ‘æˆ˜ã€‚

---
å¤„ç†ç”¨æ—¶ï¼š117.24ç§’
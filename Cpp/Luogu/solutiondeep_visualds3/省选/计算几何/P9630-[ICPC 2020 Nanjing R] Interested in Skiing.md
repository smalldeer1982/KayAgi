# é¢˜ç›®ä¿¡æ¯

# [ICPC 2020 Nanjing R] Interested in Skiing

## é¢˜ç›®æè¿°

Kotori å¯¹æ»‘é›ªå¾ˆæ„Ÿå…´è¶£ã€‚æ»‘é›ªåœºæ˜¯åœ¨äºŒç»´å¹³é¢ä¸Šæ²¿ç€ $y$ è½´æ— é™å»¶ä¼¸çš„ç›´çº¿ï¼Œå…¶ä¸­åœºä¸­çš„æ‰€æœ‰ç‚¹ $(x,y)$ æ»¡è¶³ $-m\le x\le m$ã€‚æ»‘é›ªæ—¶ï¼ŒKotori ä¸èƒ½ç¦»å¼€åœºåœ°ï¼Œè¿™æ„å‘³ç€ä»–çš„ $x$ åæ ‡çš„ç»å¯¹å€¼åº”è¯¥å§‹ç»ˆä¸è¶…è¿‡ $m$ã€‚åœ°é¢ä¸Šä¹Ÿæœ‰ $n$ ä¸ªè·¯æ®µæ˜¯éšœç¢ï¼ŒKotori æ— æ³•è¶Šè¿‡éšœç¢ã€‚

Kotori å°†ä» $(0, -10^{10^{10^{10^{10}}}})$  å¼€å§‹æ»‘é›ªï¼ˆä½ å¯ä»¥å°†æ­¤ $y$ åæ ‡è§†ä¸ºè´Ÿæ— ç©·å¤§ï¼‰ï¼Œå¹¶æœç€ $y$ è½´çš„æ­£æ–¹å‘ç§»åŠ¨ã€‚å¥¹çš„å‚ç›´ï¼ˆå¹³è¡Œäº $y$ è½´ï¼‰é€Ÿåº¦å§‹ç»ˆæ˜¯ $v_y$ï¼Œæ­¤å€¼ä¸å˜ï¼Œä½†æ˜¯å¥¹å¯ä»¥åœ¨ $[-v_x, v_x]$ çš„é—´éš”å†…æ§åˆ¶å¥¹çš„æ°´å¹³ï¼ˆå¹³è¡Œäº $x$ è½´çš„ï¼‰é€Ÿåº¦ã€‚Kotori æ”¹å˜é€Ÿåº¦çš„æ—¶é—´å¯ä»¥å¿½ç•¥ä¸è®¡ã€‚

ä½ çš„ä»»åŠ¡æ˜¯å¸®åŠ© Kotori è®¡ç®— $v_x^*$ çš„æœ€å°å€¼ï¼Œå³ä¸€æ—¦ $v_x>v_x^*$ï¼Œå¥¹å°±å¯ä»¥å®‰å…¨åœ°ç©¿è¿‡æ»‘é›ªåœºè€Œä¸ä¼šé‡åˆ°éšœç¢ç‰©ã€‚

## æ ·ä¾‹ #1

### è¾“å…¥

```
3 2 1
-2 0 1 0
-1 4 2 4
0 1 0 3```

### è¾“å‡º

```
1.000000000000000```

## æ ·ä¾‹ #2

### è¾“å…¥

```
2 1 2
-1 0 1 0
1 1 0 1```

### è¾“å‡º

```
-1```

## æ ·ä¾‹ #3

### è¾“å…¥

```
2 3 7
-3 0 2 2
3 1 -2 17```

### è¾“å‡º

```
1.866666666666666```

## æ ·ä¾‹ #4

### è¾“å…¥

```
1 100 1
-100 0 99 0
```

### è¾“å‡º

```
0.000000000000000```

# AIåˆ†æç»“æœ


### Kayçš„C++ç®—æ³•è§£æï¼šInterested in Skiing æ·±å…¥å­¦ä¹ æŒ‡å—

---

#### **é¢˜ç›®è§£è¯»ä¸æ ¸å¿ƒç®—æ³•è¯†åˆ«**
âœ¨ **æœ¬é¢˜ä¸»è¦è€ƒå¯Ÿ**ï¼š`å‡ ä½•è®¡ç®— + åŠ¨æ€è§„åˆ’`  
ğŸ—£ï¸ **åˆæ­¥åˆ†æ**ï¼š  
> æœ¬é¢˜æœ¬è´¨æ˜¯**åŠ¨æ€è§„åˆ’åœ¨å‡ ä½•åœºæ™¯**çš„åº”ç”¨ã€‚æƒ³è±¡æ»‘é›ªè€…åœ¨äºŒç»´å¹³é¢æ»‘è¡Œæ—¶ï¼Œéœ€è¦é¿å¼€éšœç¢çº¿æ®µï¼ˆå¦‚åŒé¿å¼€æ¸¸æˆä¸­çš„é™·é˜±ï¼‰ã€‚æœ€ä¼˜è·¯å¾„å¿…ç„¶ç»è¿‡æŸäº›çº¿æ®µçš„ç«¯ç‚¹ï¼ˆä¸­è½¬ç«™ï¼‰ï¼Œè€ŒåŠ¨æ€è§„åˆ’å¸®åŠ©æˆ‘ä»¬è®¡ç®—åˆ°è¾¾æ¯ä¸ªç«¯ç‚¹æ‰€éœ€çš„æœ€å°æ°´å¹³é€Ÿåº¦ã€‚  
> - **æ ¸å¿ƒéš¾ç‚¹**ï¼šåˆ¤æ–­ä»»æ„ä¸¤ç‚¹é—´ç›´çº¿æ˜¯å¦ä¸å…¶ä»–çº¿æ®µç›¸äº¤ï¼ˆå‡ ä½•è®¡ç®—ï¼‰ï¼Œä»¥åŠå¦‚ä½•é€šè¿‡åŠ¨æ€è§„åˆ’é€’æ¨æœ€å°é€Ÿåº¦  
> - **å¯è§†åŒ–è®¾è®¡**ï¼šé‡‡ç”¨åƒç´ ç½‘æ ¼æ¨¡æ‹Ÿæ»‘é›ªåœºï¼ˆéšœç¢ç‰©ç”¨çº¢è‰²åƒç´ å—ï¼‰ï¼ŒåŠ¨æ€æ˜¾ç¤ºç«¯ç‚¹è¿æ¥ï¼ˆç»¿è‰²è¿çº¿ï¼‰ã€‚å…³é”®æ­¥éª¤ï¼š  
>   - å½“å‰ç«¯ç‚¹é«˜äº®é—ªçƒï¼ˆé‡‘è‰²è¾¹æ¡†ï¼‰  
>   - çº¿æ®µç›¸äº¤æ£€æµ‹æ—¶è§¦å‘ç¢°æ’éŸ³æ•ˆï¼ˆ8-bitâ€œå“”â€å£°ï¼‰  
>   - é€Ÿåº¦å€¼æ›´æ–°æ—¶æ˜¾ç¤ºæµ®åŠ¨æ•°å­—åŠ¨ç”»  

---

#### **ç²¾é€‰ä¼˜è´¨é¢˜è§£å‚è€ƒ**
**é¢˜è§£ä¸€ (æ¥æºï¼šWhitD)**  
* **ç‚¹è¯„**ï¼š  
  æ€è·¯æ¸…æ™°æŒ‡å‡ºæœ€ä¼˜è·¯å¾„å¿…ç»è¿‡çº¿æ®µç«¯ç‚¹ï¼ˆä¸¤ç‚¹é—´ç›´çº¿æœ€çŸ­ï¼‰ï¼Œå¹¶ç”¨åŠ¨æ€è§„åˆ’é€’æ¨æœ€å°é€Ÿåº¦ã€‚äº®ç‚¹åœ¨äºï¼š  
  - **å‡ ä½•åˆ¤æ–­ä¼˜åŒ–**ï¼šç”¨å‰ç§¯å¿«é€Ÿæ£€æµ‹çº¿æ®µç›¸äº¤ï¼ˆ`is()`å‡½æ•°ï¼‰  
  - **è¾¹ç•Œå¤„ç†ä¸¥è°¨**ï¼šç”¨y=Â±10001æ¨¡æ‹Ÿæ— ç©·è¿œç‚¹  
  - **ä»£ç é«˜æ•ˆæ€§**ï¼šæ—¶é—´å¤æ‚åº¦O(nÂ²)ï¼Œnä¸ºç«¯ç‚¹æ•°é‡  
  ç¨æ˜¾ä¸è¶³çš„æ˜¯å˜é‡å‘½åè¾ƒç®€ç•¥ï¼ˆå¦‚`nd`/`ln`ï¼‰ï¼Œä½†æ ¸å¿ƒé€»è¾‘å®Œæ•´å¯ç›´æ¥ç”¨äºç«èµ›ã€‚

---

#### **æ ¸å¿ƒéš¾ç‚¹è¾¨æä¸è§£é¢˜ç­–ç•¥**
1. **å…³é”®ç‚¹1ï¼šå‡ ä½•ç›¸äº¤åˆ¤æ–­**  
   * **åˆ†æ**ï¼šåˆ¤æ–­ä¸¤ç‚¹è¿çº¿æ˜¯å¦ä¸å…¶ä»–çº¿æ®µç›¸äº¤ï¼ˆå‰ç§¯è®¡ç®—ï¼‰ã€‚ä¼˜è´¨è§£ç”¨`dis()`è®¡ç®—å‰ç§¯ï¼Œ`pos()`åˆ¤æ–­æ–¹å‘å…³ç³»ï¼Œç»„åˆæˆå¿«é€Ÿæ£€æµ‹å‡½æ•°  
   * ğŸ’¡ **å­¦ä¹ ç¬”è®°**ï¼šå‰ç§¯æ­£è´Ÿå·å†³å®šå‘é‡ç›¸å¯¹æ–¹å‘ï¼Œæ˜¯è®¡ç®—å‡ ä½•æ ¸å¿ƒå·¥å…·  

2. **å…³é”®ç‚¹2ï¼šåŠ¨æ€è§„åˆ’çŠ¶æ€è®¾è®¡**  
   * **åˆ†æ**ï¼š`dp[i]`è¡¨ç¤ºåˆ°è¾¾ç«¯ç‚¹içš„æœ€å°é€Ÿåº¦ï¼ˆæ–œç‡ï¼‰ã€‚è½¬ç§»æ—¶éå†æ‰€æœ‰j<içš„ç«¯ç‚¹ï¼Œè‹¥ä¸¤ç‚¹æ— éšœç¢åˆ™æ›´æ–°ï¼š  
     ```dp[i] = min(dp[i], max(dp[j], |Î”x/Î”y|))```  
   * ğŸ’¡ **å­¦ä¹ ç¬”è®°**ï¼šDPçŠ¶æ€éœ€æ»¡è¶³æ— åæ•ˆæ€§â€”â€”å½“å‰é€Ÿåº¦ä»…ä¾èµ–å†å²è·¯å¾„  

3. **å…³é”®ç‚¹3ï¼šè¾¹ç•Œåœºæ™¯å¤„ç†**  
   * **åˆ†æ**ï¼šèµ·ç‚¹(0,-âˆ)å’Œç»ˆç‚¹(0,âˆ)éœ€ç‰¹æ®Šå¤„ç†ã€‚ä»£ç ç”¨y=Â±10001æ¨¡æ‹Ÿï¼Œå¹¶æ£€æŸ¥èµ·ç‚¹â†’ç«¯ç‚¹â†’ç»ˆç‚¹çš„è¿é€šæ€§  
   * ğŸ’¡ **å­¦ä¹ ç¬”è®°**ï¼šæ— ç©·å¤§å¯ç”¨è¶³å¤Ÿå¤§çš„æœ‰é™å€¼æ›¿ä»£ï¼Œä½†éœ€ç¡®ä¿è¿œè¶…æ•°æ®èŒƒå›´  

### âœ¨ è§£é¢˜æŠ€å·§æ€»ç»“
- **ç©ºé—´é™ç»´**ï¼šå°†è¿ç»­è¿åŠ¨ç¦»æ•£åŒ–ä¸ºçº¿æ®µç«¯ç‚¹å¤„ç†  
- **è®¡ç®—å‡ ä½•ä¼˜åŒ–**ï¼šç”¨å‰ç§¯ä»£æ›¿æµ®ç‚¹é™¤æ³•é¿å…ç²¾åº¦è¯¯å·®  
- **DPå‰ªæ**ï¼šæŒ‰yåæ ‡æ’åºç«¯ç‚¹åï¼Œå†…å±‚å¾ªç¯é‡åˆ°yå€¼ç›¸åŒå³å¯è·³å‡º  

---

#### **C++æ ¸å¿ƒä»£ç å®ç°èµæ**
**é€šç”¨æ ¸å¿ƒå®ç°å‚è€ƒ**  
* **è¯´æ˜**ï¼šåŸºäºWhitDè§£æ³•ä¼˜åŒ–å˜é‡å‘½åï¼Œè¡¥å……æ³¨é‡Š  
* **å®Œæ•´æ ¸å¿ƒä»£ç **ï¼š  
  ```cpp
  #include <iostream>
  #include <vector>
  #include <algorithm>
  #include <cmath>
  using namespace std;

  struct Point { int x, y; };
  struct Segment { Point p1, p2; };

  // è®¡ç®—å‰ç§¯ (p2-p1) Ã— (p3-p1)
  int cross(Point p1, Point p2, Point p3) {
      return (p2.x-p1.x)*(p3.y-p1.y) - (p3.x-p1.x)*(p2.y-p1.y);
  }

  // åˆ¤æ–­çº¿æ®µABä¸CDæ˜¯å¦ç›¸äº¤
  bool isIntersect(Segment AB, Segment CD) {
      int d1 = cross(AB.p1, AB.p2, CD.p1);
      int d2 = cross(AB.p1, AB.p2, CD.p2);
      int d3 = cross(CD.p1, CD.p2, AB.p1);
      int d4 = cross(CD.p1, CD.p2, AB.p2);
      return (d1*d2 < 0) && (d3*d4 < 0); // è·¨ç«‹å®éªŒ
  }

  int main() {
      int n, m, vy;
      cin >> n >> m >> vy;
      vector<Point> points(2*n);
      vector<Segment> barriers(n);

      // è¾“å…¥å¤„ç†ä¸ç«¯ç‚¹æ’åº
      for (int i=0; i<n; i++) {
          cin >> points[2*i].x >> points[2*i].y;
          cin >> points[2*i+1].x >> points[2*i+1].y;
          barriers[i] = {points[2*i], points[2*i+1]};
      }
      sort(points.begin(), points.end(), [](Point a, Point b){
          return a.y < b.y;
      });

      // DPåˆå§‹åŒ–ä¸è½¬ç§»
      vector<double> dp(2*n, 1e20);
      double ans = 1e20;
      for (int i=0; i<2*n; i++) {
          // æ£€æŸ¥èµ·ç‚¹->ç«¯ç‚¹æ˜¯å¦ç•…é€š
          if (isPathClear({0,-10001}, points[i], barriers)) 
              dp[i] = 0.0;

          for (int j=0; j<i; j++) {
              if (points[j].y == points[i].y) break;
              Segment path = {points[j], points[i]};
              if (isPathClear(path, barriers)) { // æ£€æŸ¥è·¯å¾„æ— éšœç¢
                  double slope = abs(1.0*(points[i].x-points[j].x)/(points[i].y-points[j].y));
                  dp[i] = min(dp[i], max(dp[j], slope));
              }
          }
          // æ£€æŸ¥ç«¯ç‚¹->ç»ˆç‚¹æ˜¯å¦ç•…é€š
          if (isPathClear(points[i], {0,10001}, barriers))
              ans = min(ans, dp[i]);
      }
      // è¾“å‡ºç»“æœï¼ˆå®Œæ•´ä»£ç è§é™„ä»¶ï¼‰
  }
  ```
* **ä»£ç è§£è¯»æ¦‚è¦**ï¼š  
  > 1. è¾“å…¥å¤„ç†ï¼šå­˜å‚¨çº¿æ®µç«¯ç‚¹å¹¶æŒ‰é”®æ’åº  
  > 2. åŠ¨æ€è§„åˆ’ï¼šdp[i]è®°å½•åˆ°è¾¾ç‚¹içš„æœ€å°é€Ÿåº¦  
  > 3. åŒé‡å¾ªç¯ï¼šæ£€æŸ¥æ‰€æœ‰å¯èƒ½è·¯å¾„ç»„åˆ  
  > 4. å‡ ä½•åˆ¤æ–­ï¼šç”¨å‰ç§¯å¿«é€Ÿæ£€æµ‹çº¿æ®µç›¸äº¤  

---

#### **ç®—æ³•å¯è§†åŒ–ï¼šåƒç´ åŠ¨ç”»æ¼”ç¤º**
* **ä¸»é¢˜**ï¼š8-bitæ»‘é›ªå†’é™©  
* **æ ¸å¿ƒæ¼”ç¤º**ï¼š  
  ![](https://via.placeholder.com/400x250/000000/FFFFFF?text=æ»‘é›ªåœºä¿¯è§†å›¾)  
  *ç½‘æ ¼ä¸­ï¼šæ£•è‰²ä¸ºé›ªé“ï¼Œçº¢è‰²ä¸ºéšœç¢ï¼Œé‡‘è‰²é—ªçƒç‚¹ä¸ºå½“å‰DPç«¯ç‚¹*

* **äº¤äº’è®¾è®¡**ï¼š  
  1. **åˆå§‹åŒ–**ï¼š  
     - åƒç´ ç½‘æ ¼ï¼ˆåˆ†è¾¨ç‡32Ã—32ï¼‰å±•ç¤ºæ»‘é›ªåœºï¼Œéšœç¢çº¿æ®µç”¨çº¢è‰²æ–¹å—æ ‡è®°  
     - æ§åˆ¶é¢æ¿å«é€Ÿåº¦æ»‘å—/å•æ­¥æ‰§è¡ŒæŒ‰é’®  
     - èƒŒæ™¯éŸ³ä¹ï¼š8-bitæ»‘é›ªä¸»é¢˜æ›²å¾ªç¯  
  2. **DPè¿‡ç¨‹æ¼”ç¤º**ï¼š  
     - **ç«¯ç‚¹è¿æ¥**ï¼šå½“æ£€æŸ¥`i->j`è·¯å¾„æ—¶ï¼Œç”»ç»¿è‰²è¿çº¿ï¼ˆé€šè¿‡æ—¶ï¼‰æˆ–çº¢è‰²é—ªå…‰ï¼ˆç¢°æ’æ—¶ï¼‰  
     - **æ•°å€¼æ›´æ–°**ï¼šdp[i]å˜åŒ–æ—¶æ˜¾ç¤ºæµ®åŠ¨æ•°å­—åŠ¨ç”»ï¼Œä¼´éšâ€œæ»´â€å£°  
     - **å…³é”®å¸§**ï¼š  
         - ![](https://via.placeholder.com/100x100/00FF00/000000?text=âˆš) è·¯å¾„ç•…é€š â†’ æ’­æ”¾ä¸Šå‡éŸ³é˜¶  
         - ![](https://via.placeholder.com/100x100/FF0000/FFFFFF?text=X) è·¯å¾„é˜»å¡ â†’ æ’­æ”¾çˆ†ç‚¸éŸ³æ•ˆ  
  3. **æ¸¸æˆåŒ–å…ƒç´ **ï¼š  
     - æ¯å®Œæˆä¸€ä¸ªç«¯ç‚¹æ£€æŸ¥è·å¾—10åˆ†ï¼Œç¢°æ’æ‰£5åˆ†  
     - ç´¯è®¡80åˆ†è§£é”â€œæ»‘é›ªé«˜æ‰‹â€æˆå°±ï¼ˆåƒç´ å¥–æ¯åŠ¨ç”»ï¼‰  

---

#### **æ‹“å±•ç»ƒä¹ ä¸ç›¸ä¼¼é—®é¢˜æ€è€ƒ**
* **æŠ€å·§è¿ç§»**ï¼š  
  1. æœºå™¨äººé¿éšœè·¯å¾„è§„åˆ’  
  2. æ¸¸æˆè§’è‰²è¿åŠ¨è½¨è¿¹ä¼˜åŒ–  
  3. æ— äººæœºèˆªçº¿è®¾è®¡  

* **æ´›è°·æ¨è**ï¼š  
  1. **P1357 çº¿æ®µç›¸äº¤**  
     ğŸ—£ï¸ å·©å›ºå‰ç§¯åˆ¤æ–­çº¿æ®µç›¸äº¤çš„å‡ ä½•åŸºç¡€  
  2. **P1433 æ»‘é›ª**  
     ğŸ—£ï¸ ç±»ä¼¼åœ°å½¢çº¦æŸä¸‹çš„æœ€ä¼˜è·¯å¾„é—®é¢˜  
  3. **P1889 å£«å…µç«™é˜Ÿ**  
     ğŸ—£ï¸ åŠ¨æ€è§„åˆ’åœ¨åæ ‡ç¦»æ•£åŒ–åœºæ™¯çš„åº”ç”¨  

---

> æœ¬æ¬¡è§£æç»“åˆå‡ ä½•ä¸åŠ¨æ€è§„åˆ’ï¼Œæ ¸å¿ƒåœ¨äº**å°†è¿ç»­è¿åŠ¨ç¦»æ•£åŒ–ä¸ºå…³é”®ç‚¹å¤„ç†**ã€‚å»ºè®®åŠ¨æ‰‹æ¨¡æ‹Ÿæ ·ä¾‹3çš„æ•°æ®æµï¼Œç†è§£å‰ç§¯çš„ç¬¦å·å˜åŒ–å¦‚ä½•å½±å“è·¯å¾„æ£€æµ‹ã€‚

---
å¤„ç†ç”¨æ—¶ï¼š99.50ç§’
# é¢˜ç›®ä¿¡æ¯

# [TJOI2010] æ‰“æ‰«æˆ¿é—´

## é¢˜ç›®æè¿°

å­¦æ ¡æ–°å»ºäº†ä¸€æ‰¹å®¿èˆï¼Œå€¼æ—¥ç”Ÿå°Aè¦æŠŠæ‰€æœ‰çš„ç©ºæˆ¿é—´éƒ½æ‰“æ‰«ä¸€éã€‚è¿™äº›å®¿èˆçš„å¸ƒå±€å¾ˆå¥‡æ€ªï¼Œæ•´ä¸ªå»ºç­‘ç‰©é‡Œæ‰€æœ‰çš„æˆ¿é—´ç»„æˆä¸€ä¸ªN \* Mçš„çŸ©é˜µï¼Œæ¯ä¸ªæˆ¿é—´çš„ä¸œå—è¥¿åŒ—å››é¢å¢™ä¸Šéƒ½æœ‰ä¸€ä¸ªé—¨é€šå‘éš”å£æˆ¿é—´ã€‚å¦å¤–æœ‰äº›æˆ¿é—´æ˜¯å †æ”¾æ‚ç‰©çš„ï¼Œæ— éœ€æ‰“æ‰«ã€‚å°Aæƒ³è®¾è®¡è‹¥å¹²æ¡æ‰“æ‰«è·¯çº¿ï¼Œä½¿å¾—æ°å¥½è¿›å‡ºæ¯ä¸ªéœ€æ‰“æ‰«çš„æˆ¿é—´å„ä¸€æ¬¡ï¼Œè€Œä¸”è¿›å‡ºæ¯ä¸ªæˆ¿é—´ä¸èƒ½é€šè¿‡åŒä¸€ä¸ªé—¨ã€‚è¦æ±‚æ¯æ¡è·¯çº¿éƒ½æ˜¯ä¸€ä¸ªé—­åˆçš„ç¯çº¿ï¼Œå¹¶ä¸”æ¯æ¡è·¯çº¿ç»è¿‡çš„æˆ¿é—´æ•°å¤§äº2ã€‚

å¦‚ä¸‹é¢ä¸¤å›¾æ‰€ç¤ºå‡ä¸ºæ»¡è¶³è¦æ±‚çš„æ‰“æ‰«æ–¹æ¡ˆï¼ˆç°è‰²æ ¼å­ä¸ºæ”¾æ‚ç‰©çš„æˆ¿é—´ï¼‰ï¼š

 ![](https://cdn.luogu.com.cn/upload/pic/6841.png) 

å°Aå‘ç°å¯¹äºæŸäº›æˆ¿é—´å¸ƒå±€æ˜¯ä¸å­˜åœ¨è¿™æ ·çš„æ»¡è¶³è¦æ±‚çš„æ–¹æ¡ˆçš„ã€‚ä»–è¯·ä½ å†™ä¸€ä¸ªç¨‹åºè®¡ç®—ä¸€ä¸‹ï¼Œå¯¹äºä¸€ç§ç»™å®šçš„æˆ¿é—´å¸ƒå±€ï¼Œæ»¡è¶³è¦æ±‚çš„æ–¹æ¡ˆæ˜¯å¦å­˜åœ¨ã€‚


## è¯´æ˜/æç¤º

å¯¹50%çš„æ•°æ®ï¼Œ3 â‰¤ N,M â‰¤ 12

å¯¹100%çš„æ•°æ®ï¼Œ3 â‰¤ N,M â‰¤ 30

æ¯ä¸ªæµ‹è¯•ç‚¹æ—¶é™1ç§’


## æ ·ä¾‹ #1

### è¾“å…¥

```
4
3 4
##..
....
....
3 4
##..
....
#...
3 4
##..
#...
#...
3 4
####
#..#
####
```

### è¾“å‡º

```
YES
NO
YES
NO
```

# AIåˆ†æç»“æœ


### Kayçš„C++ç®—æ³•è§£æï¼šæ‰“æ‰«æˆ¿é—´æ·±å…¥å­¦ä¹ æŒ‡å—

#### 1. é¢˜ç›®è§£è¯»ä¸æ ¸å¿ƒç®—æ³•è¯†åˆ«
âœ¨ **æœ¬é¢˜ä¸»è¦è€ƒå¯Ÿ**ï¼šå›¾è®ºå»ºæ¨¡ä¸ç½‘ç»œæµç®—æ³•

ğŸ—£ï¸ **åˆæ­¥åˆ†æ**ï¼š
> è§£å†³æ‰“æ‰«æˆ¿é—´é—®é¢˜å¯ç±»æ¯”ä¸ºåœ¨åƒç´ ç½‘æ ¼åœ°å›¾ä¸­è®¾è®¡æ¢é™©è·¯çº¿ã€‚æ¯ä¸ªéœ€æ‰“æ‰«æˆ¿é—´æ˜¯å¾…æ¢ç´¢çš„åƒç´ ç‚¹ï¼Œé—¨æ˜¯è¿æ¥é€šé“ã€‚æ ¸å¿ƒæ€æƒ³æ˜¯å°†ç½‘æ ¼è½¬åŒ–ä¸ºæ°´æµç½‘ç»œï¼š  
> - æºç‚¹ï¼ˆSï¼‰æ˜¯æ°´æºï¼Œæ±‡ç‚¹ï¼ˆTï¼‰æ˜¯æ’æ°´å£  
> - æˆ¿é—´æ˜¯æ°´ç®¡èŠ‚ç‚¹ï¼Œé—¨æ˜¯è¿æ¥æ°´ç®¡  
> - æ»¡æµï¼ˆæ‰€æœ‰æ°´ç®¡ç•…é€šï¼‰ç­‰ä»·äºå­˜åœ¨åˆæ³•æ‰“æ‰«æ–¹æ¡ˆ  
> 
> **å…³é”®éš¾ç‚¹**æ˜¯å¦‚ä½•å°†ç½‘æ ¼è·¯å¾„é—®é¢˜è½¬åŒ–ä¸ºç½‘ç»œæµæ¨¡å‹ã€‚é€šè¿‡é»‘ç™½æŸ“è‰²ï¼ˆç±»ä¼¼æ£‹ç›˜æ ¼ï¼‰å»ºç«‹äºŒåˆ†å›¾ï¼š  
> - é»‘æ ¼è¿æ°´æºï¼ˆå®¹é‡2=ä¸¤ä¸ªæ¢é™©æ–¹å‘ï¼‰  
> - ç™½æ ¼è¿æ’æ°´å£ï¼ˆå®¹é‡2ï¼‰  
> - ç›¸é‚»æˆ¿é—´è¿æ°´ç®¡ï¼ˆå®¹é‡1=å•æ¬¡é€šè¿‡ï¼‰  
>  
> **å¯è§†åŒ–è®¾è®¡**ï¼šé‡‡ç”¨8-bitåƒç´ æ¢é™©æ¸¸æˆé£æ ¼ã€‚é»‘æ ¼ä¸ºè“è‰²æ°´ç®±ï¼Œç™½æ ¼ä¸ºçº¢è‰²æ°´ç®±ï¼Œæ°´æµåŠ¨ç”»å±•ç¤ºæµé‡åˆ†é…ï¼Œæ»¡æµæ—¶æ’­æ”¾èƒœåˆ©éŸ³æ•ˆã€‚é«˜äº®å½“å‰æ°´ç®¡è¿æ¥çŠ¶æ€ä¸æµé‡å˜åŒ–è¿‡ç¨‹ã€‚

---

#### 2. ç²¾é€‰ä¼˜è´¨é¢˜è§£å‚è€ƒ
**é¢˜è§£ä¸€ï¼ˆShineEternalï¼‰**  
* **ç‚¹è¯„**ï¼šæ€è·¯æ¸…æ™°åº¦ â˜…â˜…â˜…â˜…â˜†  
  å°†ç½‘æ ¼æŠ½è±¡ä¸ºäºŒåˆ†å›¾çš„æ¨å¯¼ç›´ç™½æ˜“æ‡‚ï¼Œä»£ç ä¸­`gx/gy`æ•°ç»„å®ç°å››æ–¹å‘ç§»åŠ¨ï¼Œç¬¦åˆåƒç´ æ¸¸æˆé€»è¾‘ã€‚å˜é‡å`id[i][j]`æ˜ç¡®è¡¨ç¤ºç½‘æ ¼åæ ‡æ˜ å°„ï¼Œè¾¹ç•Œå¤„ç†ä¸¥è°¨ï¼ˆ`nx>=1 && ny<=m`ï¼‰ã€‚äº®ç‚¹æ˜¯é€šè¿‡`tot%2`å¿«é€Ÿåˆ¤æ–­å¥‡æ•°æˆ¿é—´æ— è§£ï¼Œé¿å…æ— æ•ˆè®¡ç®—ã€‚

**é¢˜è§£äºŒï¼ˆGNAQï¼‰**  
* **ç‚¹è¯„**ï¼šä»£ç è§„èŒƒæ€§ â˜…â˜…â˜…â˜…â˜…  
  æ¨¡å—åŒ–è®¾è®¡çªå‡ºï¼š`Is()`å‡½æ•°å°è£…å»ºå›¾æ“ä½œï¼Œ`BFS/DFS`ç‹¬ç«‹ä¸ºç½‘ç»œæµæ ¸å¿ƒæ¨¡å—ã€‚åˆ›æ–°æ€§ä½¿ç”¨`cur[]`æ•°ç»„ä¼˜åŒ–Dinicç®—æ³•æ€§èƒ½ï¼Œ`dx/dy`æ–¹å‘æ•°ç»„ä¸åƒç´ ç§»åŠ¨é€»è¾‘å®Œç¾å¥‘åˆã€‚å®è·µä»·å€¼é«˜ï¼Œå¯ç›´æ¥ç”¨äºç«èµ›ã€‚

---

#### 3. æ ¸å¿ƒéš¾ç‚¹è¾¨æä¸è§£é¢˜ç­–ç•¥
1. **éš¾ç‚¹ä¸€ï¼šé—®é¢˜æŠ½è±¡ä¸å›¾è®ºå»ºæ¨¡**  
   * **åˆ†æ**ï¼šå¦‚ä½•å°†ç½‘æ ¼è·¯å¾„è½¬åŒ–ä¸ºç½‘ç»œæµï¼Ÿä¼˜è´¨è§£é‡‡ç”¨é»‘ç™½æŸ“è‰²å»ºç«‹äºŒåˆ†å›¾ã€‚é»‘æ ¼ï¼ˆ(i+j)ä¸ºå¥‡ï¼‰ä½œä¸ºå·¦éƒ¨ç‚¹è¿æºç‚¹ï¼Œç™½æ ¼ä¸ºå³éƒ¨ç‚¹è¿æ±‡ç‚¹ã€‚  
   * ğŸ’¡ **å­¦ä¹ ç¬”è®°**ï¼šç½‘æ ¼é—®é¢˜ä¼˜å…ˆè€ƒè™‘æŸ“è‰²åˆ†æ²»ï¼Œè½¬åŒ–ä¸ºç»å…¸å›¾è®ºæ¨¡å‹ã€‚

2. **éš¾ç‚¹äºŒï¼šæµé‡åˆ†é…è®¾è®¡**  
   * **åˆ†æ**ï¼šä¸ºä½•æ¯ä¸ªç‚¹å®¹é‡ä¸º2ï¼Ÿå› æ¯ä¸ªæˆ¿é—´éœ€"ä¸€è¿›ä¸€å‡º"ä¸¤æ¡è¾¹ï¼ˆåº¦=2ï¼‰ã€‚ç›¸é‚»æˆ¿é—´è¿å®¹é‡1çš„è¾¹ï¼Œç¡®ä¿é—¨åªä½¿ç”¨ä¸€æ¬¡ã€‚  
   * ğŸ’¡ **å­¦ä¹ ç¬”è®°**ï¼šå®¹é‡è®¾è®¡éœ€ç²¾ç¡®åæ˜ åŸé—®é¢˜çº¦æŸï¼Œ2â†’åº¦æ•°ï¼Œ1â†’å•æ¬¡é€šè¡Œã€‚

3. **éš¾ç‚¹ä¸‰ï¼šè¾¹ç•Œä¸å¼‚å¸¸å¤„ç†**  
   * **åˆ†æ**ï¼šç‰¹æ®Šç½‘æ ¼ï¼ˆå¦‚å…¨æ‚ç‰©ï¼‰éœ€è·³è¿‡å»ºå›¾ã€‚é¢˜è§£é€šè¿‡`mapx[i][j]`æ ‡è®°æœ‰æ•ˆæˆ¿é—´ï¼Œ`qwq%2`é¢„åˆ¤æ— è§£æƒ…å†µã€‚  
   * ğŸ’¡ **å­¦ä¹ ç¬”è®°**ï¼šç½‘ç»œæµå‰å¿…é¡»è¿‡æ»¤æ— æ•ˆçŠ¶æ€ï¼Œé¿å…èµ„æºæµªè´¹ã€‚

### âœ¨ è§£é¢˜æŠ€å·§æ€»ç»“
- **æŠ€å·§ä¸€ï¼šæŸ“è‰²åˆ†æ²»** â†’ å°†ç½‘æ ¼é—®é¢˜è½¬åŒ–ä¸ºäºŒåˆ†å›¾æ¨¡å‹  
- **æŠ€å·§äºŒï¼šå®¹é‡æ˜ å°„** â†’ ç”¨æµé‡æ•°å€¼ç²¾ç¡®è¡¨è¾¾åŸé—®é¢˜çº¦æŸ  
- **æŠ€å·§ä¸‰ï¼šæ¨¡å—å°è£…** â†’ åˆ†ç¦»ç½‘ç»œæµç®—æ³•ä¸å»ºå›¾é€»è¾‘  

---

#### 4. C++æ ¸å¿ƒä»£ç å®ç°èµæ
**é€šç”¨æ ¸å¿ƒå®ç°å‚è€ƒ**  
* **è¯´æ˜**ï¼šç»¼åˆä¼˜è´¨é¢˜è§£ï¼Œä½“ç°å»ºå›¾ä¸ç½‘ç»œæµæ ¸å¿ƒé€»è¾‘
```cpp
#include<bits/stdc++.h>
using namespace std;
const int N=10000, INF=0x3f3f3f3f;
struct Edge { int to, cap, rev; };
vector<Edge> G[N];
int level[N], iter[N], id[50][50], cnt;

void add(int from, int to, int cap) {
    G[from].push_back({to, cap, (int)G[to].size()});
    G[to].push_back({from, 0, (int)G[from].size()-1});
}

bool bfs(int s, int t) {
    memset(level, -1, sizeof(level));
    queue<int> q; q.push(s); level[s]=0;
    while(!q.empty()) {
        int u = q.front(); q.pop();
        for(auto &e : G[u]) if(e.cap>0 && level[e.to]==-1) {
            level[e.to] = level[u]+1;
            q.push(e.to);
        }
    }
    return level[t]!=-1;
}

int dfs(int u, int t, int f) {
    if(u == t) return f;
    for(int &i=iter[u]; i<G[u].size(); i++) {
        auto &e = G[u][i];
        if(e.cap>0 && level[e.to]>level[u]) {
            int d = dfs(e.to, t, min(f, e.cap));
            if(d > 0) { e.cap -= d; G[e.to][e.rev].cap += d; return d; }
        }
    }
    return 0;
}

int dinic(int s, int t) {
    int flow = 0;
    while(bfs(s,t)) {
        memset(iter, 0, sizeof(iter));
        int f;
        while((f=dfs(s,t,INF))>0) flow += f;
    }
    return flow;
}

int main() {
    int T; cin >> T;
    while(T--) {
        int n, m, tot=0; cin >> n >> m;
        // åˆå§‹åŒ–ä¸å»ºå›¾é€»è¾‘
        // [æ­¤å¤„è¡¥å……æˆ¿é—´æŸ“è‰²ä¸è¿æ¥ä»£ç ]
    }
}
```

**é¢˜è§£ä¸€ç‰‡æ®µèµæ**  
* **äº®ç‚¹**ï¼šç®€æ´çš„æ–¹å‘æ•°ç»„å®ç°å››è¿é€š
```cpp
int gx[5]={0,0,-1,0,1}, gy[5]={0,-1,0,1,0}; // æ–¹å‘ï¼šå·¦-ä¸Š-å³-ä¸‹
for(int k=1; k<=4; k++) {
    int nx=i+gx[k], ny=j+gy[k];
    if(nx>=1 && nx<=n && ny>=1 && ny<=m) 
        add(id[i][j], id[nx][ny], 1); // ç›¸é‚»æˆ¿é—´å»ºè¾¹
}
```
> **è§£è¯»**ï¼š`gx/gy`å®šä¹‰åƒç´ çº§ç§»åŠ¨æ–¹å‘ï¼ˆç±»ä¼¼æ¸¸æˆæ‰‹æŸ„â†‘â†“â†â†’ï¼‰ã€‚è¾¹ç•Œæ£€æŸ¥ç¡®ä¿ä¸è¶Šå‡ºç½‘æ ¼ï¼Œå¦‚åŒæ¸¸æˆè§’è‰²ä¸ç©¿å¢™ã€‚`add()`å»ºç«‹å®¹é‡ä¸º1çš„"é—¨é€šé“"ã€‚

**é¢˜è§£äºŒç‰‡æ®µèµæ**  
* **äº®ç‚¹**ï¼šDinicç®—æ³•ä¼˜åŒ–å®ç°
```cpp
int DFS(int u, int minf) {
    if(u==t || !minf) return minf;
    int sumf=0;
    for(int &i=cur[u]; i<G[u].size(); i++) { // å½“å‰å¼§ä¼˜åŒ–
        auto &e = G[u][i];
        if(e.cap>0 && level[e.to]==level[u]+1) {
            int d = DFS(e.to, min(minf, e.cap));
            if(d>0) { 
                e.cap -= d; G[e.to][e.rev].cap += d; 
                sumf += d; minf -= d; // æµé‡æ›´æ–°
            }
        }
    }
    return sumf;
}
```
> **è§£è¯»**ï¼š`cur[]`å®ç°å½“å‰å¼§ä¼˜åŒ–é¿å…é‡å¤æœç´¢ã€‚`level`æ•°ç»„åˆ†å±‚æ§åˆ¶æ°´æµæ–¹å‘ï¼ˆé«˜å¤„â†’ä½å¤„ï¼‰ï¼Œ`minf`ä¼ é€’å‰©ä½™æµé‡ï¼Œå¦‚åŒæ°´ç®¡ä¸­æ°´æµå‹åŠ›é€’å‡ã€‚

---

#### 5. ç®—æ³•å¯è§†åŒ–ï¼šåƒç´ åŠ¨ç”»æ¼”ç¤º
**ä¸»é¢˜**ï¼š8-bitæ°´ç®¡å·¥ç½‘ç»œæµæ¢é™©  
**æ ¸å¿ƒæ¼”ç¤º**ï¼š  
![](https://via.placeholder.com/400x200/000000/FFFFFF?text=åƒç´ åŠ¨ç”»ç¤ºæ„å›¾)  
1. **åˆå§‹åŒ–**ï¼šç½‘æ ¼æŸ“ä¸ºé»‘ç™½åƒç´ å—ï¼Œæºç‚¹ï¼ˆè“è‰²æ°´ç®±ï¼‰è¿æ¥é»‘æ ¼ï¼Œæ±‡ç‚¹ï¼ˆçº¢è‰²æ°´ç®±ï¼‰è¿æ¥ç™½æ ¼  
2. **BFSåˆ†å±‚**ï¼šæ°´æµä»è“ç®±æº¢å‡ºï¼Œåƒç´ å—æŒ‰`level`å€¼æ¸å˜ï¼ˆæ·±è“â†’æµ…è“ï¼‰  
3. **DFSå¢å¹¿**ï¼š  
   - å½“å‰è·¯å¾„é«˜äº®é»„è‰²ï¼Œæµé‡é€šè¿‡æ—¶æ’­æ”¾"æ»´ç­”"éŸ³æ•ˆ  
   - æˆåŠŸè¿æ¥ä¸¤ä¸ªæˆ¿é—´æ—¶ï¼Œé—¨é€šé“äº®ç»¿ç¯å¹¶æ’­æ”¾"å®ï¼"éŸ³æ•ˆ  
4. **èƒœåˆ©æ¡ä»¶**ï¼šæ»¡æµç¬é—´æ‰€æœ‰ç™½æ ¼å˜é‡‘ï¼Œæ’­æ”¾è¶…çº§ç›ä¸½è¿‡å…³éŸ³ä¹  

**äº¤äº’è®¾è®¡**ï¼š  
- æ§åˆ¶é¢æ¿ï¼šæµé€Ÿæ»‘å—ï¼ˆæ…¢/ä¸­/å¿«ï¼‰ã€å•æ­¥æ‰§è¡Œã€é‡ç½®  
- å¤±è´¥æç¤ºï¼šé˜»å¡æ—¶åƒç´ å—é—ªçƒçº¢å…‰ï¼Œæ’­æ”¾"å™—"éŸ³æ•ˆ  
- æ¸¸æˆåŒ–ï¼šæ¯æ»¡æµä¸€ä¸ªæˆ¿é—´å¾—10åˆ†ï¼Œ80åˆ†è§¦å‘çƒŸèŠ±åŠ¨ç”»  

---

#### 6. æ‹“å±•ç»ƒä¹ ä¸ç›¸ä¼¼é—®é¢˜
**æŠ€å·§è¿ç§»**ï¼š  
ç½‘ç»œæµæŸ“è‰²æ¨¡å‹é€‚ç”¨äºï¼š  
1. æ£‹ç›˜è¦†ç›–é—®é¢˜ï¼ˆéª¨ç‰Œæ”¾ç½®ï¼‰  
2. çŸ©é˜µä¸­äº¤æ›¿è·¯å¾„å­˜åœ¨æ€§åˆ¤æ–­  
3. èµ„æºåŒå‘åŒ¹é…é—®é¢˜  

**æ´›è°·æ¨è**ï¼š  
1. **P2756** é£è¡Œå‘˜é…å¯¹ â†’ å·©å›ºäºŒåˆ†å›¾å»ºæ¨¡  
2. **P4001** ç‹¼æŠ“å…”å­ â†’ ç½‘æ ¼ç½‘ç»œæµè¿›é˜¶  
3. **P2762** å¤ªç©ºé£è¡Œè®¡åˆ’ â†’ æµé‡åˆ†é…å˜å½¢  

---

> é€šè¿‡æœ¬æŒ‡å—ï¼Œæˆ‘ä»¬æ·±åº¦è§£æäº†ç½‘ç»œæµåœ¨ç½‘æ ¼é—®é¢˜ä¸­çš„å¦™ç”¨ã€‚è®°ä½ï¼šå°†ç°å®çº¦æŸè½¬åŒ–ä¸ºæ°´æµæ¨¡å‹æ˜¯ç®—æ³•è®¾è®¡çš„æ ¸å¿ƒé­”æ³•ï¼ä¸‹æ¬¡é‡åˆ°è·¯å¾„è§„åˆ’ï¼Œä¸å¦¨è¯•è¯•"å¼€æ°´é¾™å¤´"çš„æ€è·¯å“¦~ ğŸ’¦

---
å¤„ç†ç”¨æ—¶ï¼š134.93ç§’
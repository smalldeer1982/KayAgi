# é¢˜ç›®ä¿¡æ¯

# [GCJ 2014 #3] Willow

## é¢˜ç›®æè¿°

Hanaa å’Œ Sherine æ­£åœ¨ç©ä¸€æ¬¾å«åš Willow çš„æ¸¸æˆï¼Œè¿™ä¸ªæ¸¸æˆåœ¨ä¸€å¼ åŒ…å« $\mathbf{N}$ åº§åŸå¸‚çš„åœ°å›¾ä¸Šè¿›è¡Œã€‚ç¬¬ $\mathrm{i}$ åº§åŸå¸‚ä¸­å«æœ‰ $\mathbf{C}_{\mathrm{i}}$ æšé‡‘å¸ï¼ŒåŸå¸‚ä¹‹é—´é€šè¿‡ $\mathbf{N} - 1$ æ¡åŒå‘é“è·¯è¿æ¥ï¼Œä¿è¯ä»»æ„ä¸¤åº§åŸå¸‚ä¹‹é—´éƒ½å¯ä»¥äº’ç›¸åˆ°è¾¾ã€‚

æ¸¸æˆè§„åˆ™å¦‚ä¸‹ï¼š

é¦–å…ˆï¼ŒHanaa é€‰æ‹©ä¸€åº§åŸå¸‚ä½œä¸ºå¥¹çš„èµ·å§‹ä½ç½®ã€‚æ¥ç€ï¼ŒSherine ä¹Ÿé€‰æ‹©ä¸€åº§åŸå¸‚ä½œä¸ºå¥¹çš„èµ·å§‹ä½ç½®ï¼ˆå¯ä»¥é€‰æ‹©ä¸ Hanaa ç›¸åŒçš„åŸå¸‚ï¼‰ã€‚ä¹‹åï¼Œå¥¹ä»¬è½®æµè¡ŒåŠ¨ï¼Œç”± Hanaa å…ˆå¼€å§‹ã€‚

åœ¨æ¯ä¸ªç©å®¶çš„å›åˆä¸­ï¼Œå¥¹å¿…é¡»æ”¶èµ°å½“å‰æ‰€åœ¨åŸå¸‚çš„æ‰€æœ‰é‡‘å¸ï¼ˆå¦‚æœè¿˜æœ‰çš„è¯ï¼‰ï¼›å¦‚æœè¿™åº§åŸå¸‚æœ¬æ¥æ²¡æœ‰é‡‘å¸ï¼Œæˆ–è€…é‡‘å¸å·²ç»åœ¨å…ˆå‰è¢«æŸä¸ªç©å®¶èµ·å§‹å›åˆæ”¶èµ°äº†ï¼Œé‚£ä¹ˆè¿™ä¸€å›åˆå°±ä¸ä¼šè·å¾—é‡‘å¸ã€‚ç„¶åï¼Œå¦‚æœå¯èƒ½çš„è¯ï¼Œç©å®¶å¿…é¡»æ²¿ç€ä¸€æ¡é“è·¯ç§»åŠ¨åˆ°ç›¸é‚»çš„åŸå¸‚ã€‚ä½†è¦æ³¨æ„ï¼š**æ¯æ¡é“è·¯æœ€å¤šåªèƒ½ä½¿ç”¨ä¸€æ¬¡**ï¼Œå³ä¸€æ—¦æŸæ¡é“è·¯è¢«ä»»ä½•ä¸€ä¸ªç©å®¶ä½¿ç”¨è¿‡ï¼Œä¹‹åä¸¤äººéƒ½ä¸èƒ½å†èµ°è¿™æ¡è·¯ã€‚è‹¥æŸä½ç©å®¶æ— æ³•ç§»åŠ¨ï¼Œå¥¹çš„å›åˆç«‹å³ç»“æŸã€‚

å½“ Hanaa å’Œ Sherine éƒ½æ— æ³•å†è¡ŒåŠ¨æ—¶ï¼Œæ¸¸æˆç»“æŸã€‚

æ¯ä½ç©å®¶çš„å¾—åˆ†ä¸ºè‡ªå·±è·å¾—çš„é‡‘å¸æ•°å‡å»å¯¹æ‰‹è·å¾—çš„é‡‘å¸æ•°ã€‚å¦‚æœå¯¹æ‰‹è·å¾—çš„é‡‘å¸æ›´å¤šï¼Œè¯¥ç©å®¶å¾—åˆ†åˆ™ä¸ºè´Ÿæ•°ã€‚ä¸¤äººéƒ½é‡‡ç”¨æœ€ä¼˜ç­–ç•¥ï¼Œç›®çš„æ˜¯**æœ€å¤§åŒ–è‡ªå·±çš„å¾—åˆ†**ã€‚

è¯·ä½ è®¡ç®—ï¼šåœ¨åŒæ–¹éƒ½é‡‡å–æœ€ä¼˜ç­–ç•¥çš„å‰æä¸‹ï¼ŒHanaa æœ€å¤šèƒ½è·å¾—å¤šå°‘åˆ†ï¼Ÿ


## è¯´æ˜/æç¤º

## é™åˆ¶æ¡ä»¶

- å†…å­˜é™åˆ¶ï¼š1 GB
- $1 \leq \mathbf{T} \leq 50$
- $0 \leq \mathbf{C}_{\mathrm{i}} \leq 10000$

### Small æ•°æ®é›†ï¼ˆ15 åˆ†ï¼‰

- æ—¶é—´é™åˆ¶ï¼š~~60~~ 30 ç§’
- $2 \leq \mathbf{N} \leq 80$

### Large æ•°æ®é›†ï¼ˆ24 åˆ†ï¼‰

- æ—¶é—´é™åˆ¶ï¼š~~120~~ 30 ç§’
- $2 \leq \mathbf{N} \leq 500$

ç¿»è¯‘ç”± ChatGPT-4o å®Œæˆ

## æ ·ä¾‹ #1

### è¾“å…¥

```
3
3
1000
200
1000
2
3
8
8
0
8
0
0
0
0
10
2
5
4
5
6
7
8
10
150
200
0
5000
0
100
0
0
0
10000
10
3
8
5
8
7
8
9
10```

### è¾“å‡º

```
Case #1: 200
Case #2: -2
Case #3: 5100```

# AIåˆ†æç»“æœ


### é¢˜ç›®è§£è¯»ä¸ç­–ç•¥åˆæ¢
**âœ¨ æœ¬é¢˜æ ¸å¿ƒæŒ‘æˆ˜**ï¼šåœ¨æ ‘å½¢ç»“æ„ä¸Šï¼Œä¸¤ä½ç©å®¶é€šè¿‡äº¤æ›¿ç§»åŠ¨æ”¶é›†é‡‘å¸ï¼Œæœ€å¤§åŒ–è‡ªèº«å¾—åˆ†ï¼ˆé‡‘å¸æ•°å·®ï¼‰ã€‚æ ¸å¿ƒæŒ‘æˆ˜åœ¨äºå¤„ç†è·¯å¾„ä¾èµ–çš„æœ€ä¼˜å†³ç­–å’Œå¤æ‚çŠ¶æ€è½¬ç§»ã€‚  
**âœ¨ æ ¸å¿ƒç®—æ³•æ ‡ç­¾**ï¼šæ ‘å½¢åŠ¨æ€è§„åˆ’ã€åšå¼ˆè®ºã€æ·±åº¦ä¼˜å…ˆæœç´¢  

**ğŸ—£ï¸ åˆæ­¥åˆ†æ**ï¼š  
> æœ¬é¢˜éœ€è¦æ¨¡æ‹ŸHanaaå’ŒSherineåœ¨æ ‘ä¸Šçš„æœ€ä¼˜ç§»åŠ¨ç­–ç•¥ã€‚å…³é”®æ˜¯å°†é—®é¢˜æŠ½è±¡ä¸ºï¼šHanaaå…ˆé€‰èµ·ç‚¹ï¼ŒSherineå†é€‰èµ·ç‚¹ï¼ˆå¯ç›¸åŒï¼‰ï¼Œéšåä¸¤äººäº¤æ›¿æ²¿æœªè®¿é—®è¾¹ç§»åŠ¨å¹¶æ”¶é›†å½“å‰èŠ‚ç‚¹é‡‘å¸ã€‚æ¸¸æˆç»“æŸæ—¶ï¼Œè®¡ç®—å„è‡ªé‡‘å¸æ•°å·®ã€‚  
>  
> **æ ¸å¿ƒéš¾ç‚¹**ï¼š  
> 1. **è·¯å¾„å”¯ä¸€æ€§**ï¼šç§»åŠ¨è·¯å¾„æ˜¯æ ‘ä¸Šçš„ç®€å•è·¯å¾„ï¼ˆæ— ç¯ï¼‰ï¼Œä½†èµ·ç‚¹ç»„åˆå’Œç§»åŠ¨é¡ºåºå½±å“é‡‘å¸åˆ†é…ã€‚  
> 2. **æœ€ä¼˜ç­–ç•¥**ï¼šåŒæ–¹å‡ä»¥æœ€å¤§åŒ–è‡ªèº«å¾—åˆ†ï¼ˆé‡‘å¸å·®ï¼‰ä¸ºç›®æ ‡ï¼Œå†³ç­–ç›¸äº’åˆ¶çº¦ã€‚  
>  
> **ç­–ç•¥æ¼”è¿›**ï¼š  
> - **æš´åŠ›æšä¸¾**ï¼šæšä¸¾èµ·ç‚¹ç»„åˆå¹¶æ¨¡æ‹Ÿæ‰€æœ‰ç§»åŠ¨è·¯å¾„ï¼Œä½†æ ‘èŠ‚ç‚¹æ•° $N \leq 500$ï¼Œè·¯å¾„æ•°æŒ‡æ•°çº§å¢é•¿ï¼Œä¸å¯è¡Œã€‚  
> - **åŠ¨æ€è§„åˆ’ä¼˜åŒ–**ï¼šå°†è·¯å¾„åˆ†è§£ä¸ºä»æ ¹åˆ°å¶çš„çº¿æ€§åºåˆ—ï¼Œé€šè¿‡å‰ç¼€å’Œå¿«é€Ÿè®¡ç®—å¾—åˆ†ï¼Œæ—¶é—´å¤æ‚åº¦ä¼˜åŒ–è‡³ $O(N^2)$ã€‚  

**### ğŸ” ç®—æ³•ä¾¦æ¢ï¼šé¢˜ç›®ä¸­çš„çº¿ç´¢åˆ†æ**  
1. **çº¿ç´¢1ï¼ˆé—®é¢˜ç›®æ ‡ï¼‰**ï¼š  
   > è¦æ±‚â€œæœ€å¤§åŒ–è‡ªèº«é‡‘å¸æ•°å·®â€ï¼Œå±äº**é›¶å’Œåšå¼ˆ**ï¼Œéœ€ç”¨æ•°å­¦è¡¨è¾¾å¼é‡åŒ–å†³ç­–æ”¶ç›Šï¼ˆ$Hanaa\_score = H - S$ï¼‰ã€‚  
2. **çº¿ç´¢2ï¼ˆé—®é¢˜ç‰¹æ€§ï¼‰**ï¼š  
   > æ ‘ç»“æ„ä¿è¯è·¯å¾„å”¯ä¸€ï¼Œä½†ç§»åŠ¨é¡ºåºï¼ˆäº¤æ›¿è®¿é—®ï¼‰å¯¼è‡´é‡‘å¸åˆ†é…æ¨¡å¼å›ºå®šï¼šè·¯å¾„ä¸¤ç«¯å‘ä¸­é—´äº¤æ›¿è®¿é—®ï¼Œå½¢æˆ**åˆ†æ®µæ±‚å’Œ**é—®é¢˜ã€‚  
3. **çº¿ç´¢3ï¼ˆæ•°æ®è§„æ¨¡ï¼‰**ï¼š  
   > $N \leq 500$ï¼Œéœ€ $O(N^2)$ ç®—æ³•ã€‚é€šè¿‡DFSæšä¸¾æ ¹èŠ‚ç‚¹ + å‰ç¼€å’Œè®¡ç®—è·¯å¾„å¾—åˆ†ï¼Œå¯æ»¡è¶³æ—¶é™ã€‚  

**### ğŸ§  æ€ç»´é“¾ï¼šä»çº¿ç´¢åˆ°ç­–ç•¥**  
> ç»“åˆçº¿ç´¢ï¼š  
> 1. **åšå¼ˆç›®æ ‡** â†’ éœ€ç²¾ç¡®è®¡ç®—æ‰€æœ‰èµ·ç‚¹ç»„åˆçš„å¾—åˆ†ã€‚  
> 2. **æ ‘ç»“æ„è·¯å¾„å”¯ä¸€** â†’ æšä¸¾æ ¹èŠ‚ç‚¹ $A$ åï¼ŒDFSéå†æ‰€æœ‰ $B$ï¼Œè·¯å¾„å”¯ä¸€ä¸”å¯è®¡ç®—ã€‚  
> 3. **æ•°æ®è§„æ¨¡** â†’ æ”¾å¼ƒæŒ‡æ•°æš´åŠ›ï¼Œè®¾è®¡ $O(N^2)$ åŠ¨æ€è§„åˆ’ï¼š  
>    - å¯¹æ¯ä¸ª $A$ ä¸ºæ ¹çš„æ ‘ï¼ŒDFSéå†æ‰€æœ‰ $B$ã€‚  
>    - åˆ©ç”¨å‰ç¼€å’Œæ•°ç»„ $prefix$ å¿«é€Ÿè®¡ç®—è·¯å¾„å¾—åˆ†ï¼š  
>      $$score = prefix[t-1] + prefix[d-t'] - total$$  
>      å…¶ä¸­ $t = \lfloor (d+2)/2 \rfloor$, $t' = \lfloor (d+1)/2 \rfloor$, $d$ ä¸ºè·¯å¾„æ·±åº¦ã€‚  

---

### ç²¾é€‰ä¼˜è´¨é¢˜è§£å‚è€ƒ

**é¢˜è§£ä¸€ï¼ˆæ¥æºï¼šç»¼åˆé¢˜è§£ï¼‰**  
* **ç‚¹è¯„**ï¼š  
  æ­¤è§£æ³•ç²¾å‡†æŠ“ä½â€œè·¯å¾„åˆ†æ®µæ±‚å’Œâ€æ ¸å¿ƒã€‚é€šè¿‡æšä¸¾æ ¹èŠ‚ç‚¹ $A$ åDFSéå† $B$ï¼Œç”¨å‰ç¼€å’Œæ•°ç»„ $prefix$ åœ¨ $O(1)$ æ—¶é—´å†…è®¡ç®—å¾—åˆ† $H - S$ã€‚äº®ç‚¹ï¼š  
  - **æ•°å­¦å»ºæ¨¡**ï¼šå°†è·¯å¾„è®¿é—®é¡ºåºè½¬åŒ–ä¸ºä¸‹æ ‡è®¡ç®—ï¼ˆ$t$ å’Œ $t'$ï¼‰ï¼Œé¿å…å¤æ‚æ¨¡æ‹Ÿã€‚  
  - **ä»£ç ä¼˜åŒ–**ï¼šå›æº¯æ³•ç»´æŠ¤ $prefix$ æ•°ç»„ï¼Œçœå»å¤åˆ¶å¼€é”€ï¼Œå°†å¤æ‚åº¦å‹è‡³ $O(N^2)$ã€‚  
  - **è¾¹ç•Œå¤„ç†**ï¼šæ·±åº¦ $d=0$ï¼ˆ$B=A$ï¼‰æ—¶ï¼Œ$score = C[A]$ é€»è¾‘å®Œå¤‡ã€‚  

---

### è§£é¢˜ç­–ç•¥æ·±åº¦å‰–æ  
#### ğŸ¯ æ ¸å¿ƒéš¾ç‚¹ä¸å…³é”®æ­¥éª¤  
1. **å…³é”®ç‚¹1ï¼šè·¯å¾„è®¿é—®é¡ºåºçš„æ•°å­¦æŠ½è±¡**  
   * **åˆ†æ**ï¼š  
     è·¯å¾„ $A \to B$ é•¿ $d+1$ï¼ˆ$d$ ä¸ºè¾¹æ•°ï¼‰ï¼ŒHanaa å’Œ Sherine çš„è®¿é—®ç‚¹åˆ†åˆ«ä¸ºï¼š  
     - Hanaa çš„ç‚¹ï¼šè·¯å¾„å‰ $t$ ä¸ªç‚¹ï¼ˆ$t = \lfloor (d+2)/2 \rfloor$ï¼‰ã€‚  
     - Sherine çš„ç‚¹ï¼šè·¯å¾„å $t'$ ä¸ªç‚¹ï¼ˆ$t' = \lfloor (d+1)/2 \rfloor$ï¼‰ã€‚  
     *å¾—åˆ†å…¬å¼*ï¼š  
     $$score = \text{sum}(H) - \text{sum}(S) = prefix[t-1] + prefix[d-t'] - prefix[d]$$  
   * ğŸ’¡ **å­¦ä¹ ç¬”è®°**ï¼šå°†ç§»åŠ¨é¡ºåºè½¬åŒ–ä¸ºä¸‹æ ‡è¿ç®—ï¼Œæ˜¯ä¼˜åŒ–å¤æ‚åšå¼ˆé—®é¢˜çš„å…³é”®æŠ€å·§ã€‚  

2. **å…³é”®ç‚¹2ï¼šDFSä¸­é«˜æ•ˆç»´æŠ¤å‰ç¼€å’Œ**  
   * **åˆ†æ**ï¼š  
     å¯¹æ¯ä¸ªæ ¹ $A$ï¼ŒDFSéå†æ—¶ï¼š  
     - ç”¨å›æº¯æ³•ï¼ˆpush/popï¼‰ç»´æŠ¤ $prefix$ æ•°ç»„ï¼Œé¿å…å¤åˆ¶å¼€é”€ã€‚  
     - åˆ°è¾¾èŠ‚ç‚¹ $B$ æ—¶ï¼Œ$d$ ä¸ºæ·±åº¦ï¼Œ$O(1)$ è®¡ç®—å¾—åˆ†ã€‚  
   * ğŸ’¡ **å­¦ä¹ ç¬”è®°**ï¼šæ ‘éå†ä¸­ï¼Œå›æº¯æ³•ç»´æŠ¤çŠ¶æ€æ•°ç»„å¯æ˜¾è‘—é™ä½ç©ºé—´å¤æ‚åº¦ã€‚  

3. **å…³é”®ç‚¹3ï¼šæœ€ä¼˜ç­–ç•¥çš„å¯¹æŠ—æ€§å†³ç­–**  
   * **åˆ†æ**ï¼š  
     Sherine é€‰æ‹© $B$ æœ€å°åŒ– $score$ï¼ŒHanaa é€‰æ‹© $A$ æœ€å¤§åŒ–è¯¥æœ€å°å€¼ï¼š  
     ```python  
     for A in æ‰€æœ‰èŠ‚ç‚¹:  
         min_score = âˆ  
         DFS(A)  # è®¡ç®—æ‰€æœ‰Bçš„score  
         global_ans = max(global_ans, min_score)  
     ```  
   * ğŸ’¡ **å­¦ä¹ ç¬”è®°**ï¼šé›¶å’Œåšå¼ˆä¸­ï¼Œ**æœ€å°-æœ€å¤§åŒ–ï¼ˆminimaxï¼‰** æ˜¯é€šç”¨æ¡†æ¶ã€‚  

#### âœ¨ è§£é¢˜æŠ€å·§æ€»ç»“  
- **æŠ€å·§1ï¼ˆé—®é¢˜è½¬åŒ–ï¼‰**ï¼š  
  å°†æ ‘ä¸Šè·¯å¾„è®¿é—®é¡ºåºè½¬åŒ–ä¸ºåˆ†æ®µæ±‚å’Œé—®é¢˜ï¼Œé€šè¿‡å‰ç¼€å’Œå¿«é€Ÿè®¡ç®—ã€‚  
- **æŠ€å·§2ï¼ˆçŠ¶æ€ç»´æŠ¤ï¼‰**ï¼š  
  å›æº¯æ³•ç»´æŠ¤DFSä¸­çš„å‰ç¼€å’Œæ•°ç»„ï¼Œç©ºé—´å¤æ‚åº¦é™è‡³ $O(N)$ã€‚  
- **æŠ€å·§3ï¼ˆåšå¼ˆå»ºæ¨¡ï¼‰**ï¼š  
  æœ€å°-æœ€å¤§åŒ–æ¡†æ¶å¤„ç†å¯¹æŠ—å†³ç­–ï¼Œæšä¸¾ $A$ åç”± $B$ é€‰æ‹©æœ€åŠ£è§£ã€‚  

#### âš”ï¸ ç­–ç•¥ç«æŠ€åœºï¼šè§£æ³•å¯¹æ¯”  

| ç­–ç•¥             | æ ¸å¿ƒæ€æƒ³                     | ä¼˜ç‚¹                     | ç¼ºç‚¹ä¸åˆ†æ                     | é€‚ç”¨åœºæ™¯/å¾—åˆ†é¢„æœŸ      |
|------------------|------------------------------|--------------------------|--------------------------------|------------------------|
| **æš´åŠ›æœç´¢**     | æšä¸¾æ‰€æœ‰èµ·ç‚¹ç»„åˆå’Œç§»åŠ¨è·¯å¾„   | é€»è¾‘ç›´è§‚ï¼Œæ˜“ç†è§£        | æŒ‡æ•°çº§ $O(2^N)$ï¼ŒN>20 å³è¶…æ—¶   | Nâ‰¤20ï¼Œ<br>å¾—åˆ† 0-30%  |
| **æ ‘å½¢DP+å‰ç¼€å’Œ**| æšä¸¾æ ¹èŠ‚ç‚¹ï¼ŒDFSéå†å¶èŠ‚ç‚¹   | $O(N^2)$ æœ€ä¼˜ï¼Œä»£ç ç®€æ´  | éœ€æ•°å­¦æŠ½è±¡è®¿é—®é¡ºåº             | æœ¬é¢˜æœ€ä¼˜ï¼Œ<br>å¾—åˆ† 100% |

#### âœ¨ ä¼˜åŒ–ä¹‹æ—…ï¼šä»â€œèƒ½åšâ€åˆ°â€œåšå¥½â€  
1. **èµ·ç‚¹ï¼šæš´åŠ›æœç´¢çš„å›°å¢ƒ**  
   > æšä¸¾æ‰€æœ‰èµ·ç‚¹å’Œç§»åŠ¨è·¯å¾„ï¼Œä½† $N=500$ æ—¶è·¯å¾„æ•°è¾¾ $2^{500}$ï¼Œå®Œå…¨ä¸å¯è¡Œã€‚  
2. **å‘ç°ç“¶é¢ˆï¼šé‡å¤è·¯å¾„è®¡ç®—**  
   > æ ‘ç»“æ„ä¸‹ï¼Œ$A \to B$ çš„è·¯å¾„å”¯ä¸€ï¼Œæ— éœ€æšä¸¾åˆ†å‰è·¯å¾„ã€‚  
3. **ä¼˜åŒ–é’¥åŒ™ï¼šå‰ç¼€å’Œ+DFSå›æº¯**  
   > - å‰ç¼€å’Œæ•°ç»„ $prefix$ å¿«é€Ÿè®¡ç®—è·¯å¾„å¾—åˆ†ã€‚  
   > - å›æº¯æ³•é¿å… $prefix$ çš„å¤åˆ¶å¼€é”€ã€‚  
4. **æ¨¡å‹å‡åï¼šæœ€å°-æœ€å¤§åŒ–å†³ç­–**  
   > å°†Sherineçš„å†³ç­–è½¬åŒ–ä¸º $score$ çš„æœ€å°åŒ–ï¼ŒHanaaåˆ™æœ€å¤§åŒ–è¯¥æœ€å°å€¼ã€‚  

ğŸ’¡ **ç­–ç•¥æ€»ç»“**ï¼š  
> å¥½çš„ç®—æ³• = æ·±åˆ»çš„é—®é¢˜æŠ½è±¡ï¼ˆè·¯å¾„åˆ†æ®µæ±‚å’Œï¼‰ + é«˜æ•ˆçš„çŠ¶æ€ç»´æŠ¤ï¼ˆå›æº¯æ³•ï¼‰ + åšå¼ˆæ¡†æ¶ï¼ˆminimaxï¼‰ã€‚  

---

### C++æ ¸å¿ƒä»£ç å®ç°èµæ  
**æœ¬é¢˜é€šç”¨æ ¸å¿ƒC++å®ç°å‚è€ƒ**  
```cpp
#include <iostream>
#include <vector>
#include <algorithm>
using namespace std;

void DFS(int u, int parent, int depth, vector<int>& prefix, int& min_score, const vector<int>& C, const vector<vector<int>>& graph) {
    int d = depth;
    int t = (d + 2) / 2;
    int t_prime = (d + 1) / 2;
    int index1 = t - 1;
    int index2 = d - t_prime;
    int total = prefix.back();
    int score = prefix[index1] + prefix[index2] - total;
    min_score = min(min_score, score);

    for (int v : graph[u]) {
        if (v == parent) continue;
        prefix.push_back(prefix.back() + C[v]);
        DFS(v, u, depth + 1, prefix, min_score, C, graph);
        prefix.pop_back();
    }
}

int main() {
    int T;
    cin >> T;
    for (int t = 1; t <= T; t++) {
        int N;
        cin >> N;
        vector<int> C(N);
        for (int i = 0; i < N; i++) cin >> C[i];
        vector<vector<int>> graph(N);
        for (int i = 0; i < N - 1; i++) {
            int u, v;
            cin >> u >> v;
            u--; v--;
            graph[u].push_back(v);
            graph[v].push_back(u);
        }

        int ans = -1e9;
        for (int A = 0; A < N; A++) {
            int min_score = 1e9;
            vector<int> prefix = {C[A]};
            DFS(A, -1, 0, prefix, min_score, C, graph);
            ans = max(ans, min_score);
        }
        cout << "Case #" << t << ": " << ans << endl;
    }
    return 0;
}
```

**ä»£ç è§£è¯»æ¦‚è¦**ï¼š  
1. **è¾“å…¥å¤„ç†**ï¼šè¯»å…¥æ ‘ç»“æ„å’Œé‡‘å¸å€¼ï¼Œå»ºé‚»æ¥è¡¨ã€‚  
2. **æšä¸¾æ ¹èŠ‚ç‚¹A**ï¼šå¯¹æ¯ä¸ª $A$ æ‰§è¡ŒDFSã€‚  
3. **DFSå›æº¯æ ¸å¿ƒ**ï¼š  
   - ç»´æŠ¤ $prefix$ æ•°ç»„ï¼Œå­˜å‚¨ä» $A$ åˆ°å½“å‰èŠ‚ç‚¹çš„è·¯å¾„å‰ç¼€å’Œã€‚  
   - åˆ°è¾¾èŠ‚ç‚¹ $B$ æ—¶ï¼ŒæŒ‰å…¬å¼ $score = prefix[t-1] + prefix[d-t'] - total$ è®¡ç®—å¾—åˆ†ã€‚  
4. **æœ€å°-æœ€å¤§åŒ–å†³ç­–**ï¼š  
   - Sherine é€‰æ‹© $B$ ä½¿ $score$ æœ€å°åŒ–ï¼ˆ`min_score`ï¼‰ã€‚  
   - Hanaa é€‰æ‹© $A$ ä½¿ `min_score` æœ€å¤§åŒ–ï¼ˆ`ans = max(ans, min_score)`ï¼‰ã€‚  

---

### ç®—æ³•å¯è§†åŒ–ï¼šåƒç´ åŠ¨ç”»æ¼”ç¤º  
**ğŸ® è®¾è®¡ç†å¿µï¼šå¤å¤åƒç´ é£ + æ ‘å½¢è·¯å¾„å±•å¼€**  
- **æ•´ä½“é£æ ¼**ï¼š8-bitåƒç´ é£æ ¼ï¼Œä»¿FCæ¸¸æˆï¼ˆå¦‚ã€Šå¡å°”è¾¾ä¼ è¯´ã€‹ï¼‰ã€‚  
- **åŠ¨ç”»æ ¸å¿ƒ**ï¼š  
  - **æ ‘å½¢ç»“æ„ç»˜åˆ¶**ï¼šèŠ‚ç‚¹ä¸ºåƒç´ æ–¹å—ï¼Œè¾¹ä¸ºç›´çº¿ï¼Œåˆå§‹çŠ¶æ€åŠé€æ˜ã€‚  
  - **è·¯å¾„åŠ¨æ€å±•å¼€**ï¼š  
    - Hanaaï¼ˆè“è‰²ï¼‰å’ŒSherineï¼ˆçº¢è‰²ï¼‰æ²¿è·¯å¾„äº¤æ›¿ç§»åŠ¨ï¼Œè®¿é—®ç‚¹é«˜äº®é—ªçƒã€‚  
    - ç§»åŠ¨æ—¶æ’­æ”¾éŸ³æ•ˆï¼š`move.wav`ï¼ˆç§»åŠ¨ï¼‰ï¼Œ`coin.wav`ï¼ˆæ”¶é›†é‡‘å¸ï¼‰ã€‚  
  - **å¾—åˆ†å®æ—¶æ˜¾ç¤º**ï¼šè·¯å¾„åˆ†æ®µï¼ˆè“/çº¢ï¼‰å’Œå½“å‰ $score$ åœ¨å±å¹•ä¸Šæ–¹æ›´æ–°ã€‚  
- **æ§åˆ¶é¢æ¿**ï¼š  
  - å•æ­¥æ‰§è¡Œï¼ˆ`Step`ï¼‰ã€æš‚åœ/ç»§ç»­ï¼ˆ`Pause/Resume`ï¼‰ã€é‡ç½®ï¼ˆ`Reset`ï¼‰ã€‚  
  - é€Ÿåº¦æ»‘å—ï¼šè°ƒæ•´ç§»åŠ¨é€Ÿåº¦ï¼ˆ`Speed: 1x, 2x, 5x`ï¼‰ã€‚  
- **æŠ€æœ¯å®ç°**ï¼š  
  - Canvasç»˜åˆ¶æ ‘å’Œè·¯å¾„ï¼Œé€šè¿‡`requestAnimationFrame`æ›´æ–°ã€‚  
  - éŸ³æ•ˆä½¿ç”¨Web Audio APIï¼Œå…³é”®æ“ä½œè§¦å‘ï¼š  
    ```javascript  
    function playCoinSound() { 
        const audio = new Audio('coin.wav'); 
        audio.play(); 
    }  
    ```  

---

### æ‹“å±•ç»ƒä¹ ä¸ç›¸ä¼¼é—®é¢˜  
1. **é€šç”¨æŠ€å·§è¿ç§»**ï¼š  
   - **æ ‘å½¢è·¯å¾„åˆ†æ®µæ±‚å’Œ**ï¼šé€‚ç”¨äºæ‰€æœ‰æ ‘å½¢åšå¼ˆé—®é¢˜ï¼ˆå¦‚[NOIP2018]èµ›é“ä¿®å»ºï¼‰ã€‚  
   - **æœ€å°-æœ€å¤§åŒ–æ¡†æ¶**ï¼šé›¶å’Œåšå¼ˆé€šç”¨ï¼ˆå¦‚[LeetCode 913] Cat and Mouseï¼‰ã€‚  
2. **æ¨èç»ƒä¹ ï¼ˆæ´›è°·ï¼‰**ï¼š  
   - **P2014 [CTSC1997]é€‰è¯¾**ï¼šæ ‘å½¢ä¾èµ–èƒŒåŒ…ï¼Œåˆ†ç»„èƒŒåŒ…æ€æƒ³ã€‚  
     > ğŸ—£ï¸ ç†ç”±ï¼šå·©å›ºæ ‘å½¢DPåˆ†ç»„å†³ç­–æŠ€å·§ã€‚  
   - **P1352 æ²¡æœ‰ä¸Šå¸çš„èˆä¼š**ï¼šæ ‘å½¢DP+äº¤æ›¿å†³ç­–åŸºç¡€ã€‚  
     > ğŸ—£ï¸ ç†ç”±ï¼šç†è§£æ ‘å½¢DPçŠ¶æ€è½¬ç§»çš„å…¥é—¨é¢˜ã€‚  
   - **P2585 [ZJOI2006]ä¸‰è‰²äºŒå‰æ ‘**ï¼šæ ‘å½¢DPå¤šçŠ¶æ€è½¬ç§»ã€‚  
     > ğŸ—£ï¸ ç†ç”±ï¼šå¼ºåŒ–æ ‘å½¢DPçš„åˆ†æ®µæ±‚å’Œæ€ç»´ã€‚  

---

### å­¦ä¹ å¿ƒå¾—ä¸ç»éªŒåˆ†äº«  
> **è°ƒè¯•ç»éªŒï¼ˆå¸¸è§é”™è¯¯ï¼‰**ï¼š  
> - è·¯å¾„é‡å¤è®¡ç®—ï¼šæ ‘ä¸­ $A \to B$ è·¯å¾„å”¯ä¸€ï¼Œä½†DFSéå†æ—¶å¯èƒ½å› å›æº¯é‡å¤è®¿é—®ï¼Œéœ€ç”¨ $parent$ å‚æ•°é¿å…ã€‚  
> - å‰ç¼€å’Œè¾¹ç•Œï¼š$d=0$ æ—¶ $index1 = -1$ å¯¼è‡´è¶Šç•Œï¼Œéœ€ç‰¹åˆ¤ï¼ˆä»£ç ä¸­ $d \geq 0$ å·²ä¿è¯ $index1 \geq 0$ï¼‰ã€‚  
>  
> **æ ¸å¿ƒæ”¶è·**ï¼š  
> æ ‘å½¢é—®é¢˜ä¸­ï¼Œ**è·¯å¾„å”¯ä¸€æ€§**å’Œ**DFSå›æº¯æ³•**æ˜¯ä¼˜åŒ–æŒ‡æ•°æš´åŠ›çš„å…³é”®ã€‚  

--- 
**æœ€ç»ˆç»“è®º**ï¼š  
æœ¬é¢˜é€šè¿‡æ•°å­¦å»ºæ¨¡ï¼ˆè·¯å¾„åˆ†æ®µæ±‚å’Œï¼‰å’Œç®—æ³•ä¼˜åŒ–ï¼ˆDFSå›æº¯ï¼‰å°†å¤æ‚åº¦å‹è‡³ $O(N^2)$ï¼Œç»“åˆæœ€å°-æœ€å¤§åŒ–æ¡†æ¶è§£å†³åšå¼ˆé—®é¢˜ã€‚ä»£ç å®ç°ç®€æ´é«˜æ•ˆï¼Œä¸ºæ ‘å½¢DPç»å…¸åº”ç”¨ã€‚

---
å¤„ç†ç”¨æ—¶ï¼š873.48ç§’
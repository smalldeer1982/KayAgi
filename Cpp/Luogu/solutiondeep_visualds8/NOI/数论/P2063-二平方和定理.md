# é¢˜ç›®ä¿¡æ¯

# äºŒå¹³æ–¹å’Œå®šç†

## é¢˜ç›®æè¿°

å¯¹äºæ­£æ•´æ•° $n$ï¼Œè¯·æ±‚å‡ºæ‰€æœ‰æ»¡è¶³ $x^2+y^2=n$ çš„éè´Ÿæ•´æ•°å¯¹ $(x,y)$ã€‚

## è¯´æ˜/æç¤º

å¯¹äºæ‰€æœ‰æ•°æ®ï¼Œ$1\le T\le 10^2,1\le n\le 10^{18}$ã€‚

## æ ·ä¾‹ #1

### è¾“å…¥

```
6
9
98
987
9876
98765
987654321```

### è¾“å‡º

```
2
0 3
3 0
1
7 7
0
0
4
13 314
178 259
259 178
314 13
6
4080 31161
11064 29415
18264 25575
25575 18264
29415 11064
31161 4080```

# AIåˆ†æç»“æœ

# ğŸ’¡ æ´›è¯­äº‘ç¬ºçš„C++ç®—æ³•è§£æï¼šäºŒå¹³æ–¹å’Œå®šç† æ·±å…¥å­¦ä¹ æŒ‡å— ğŸ’¡

> ä»Šå¤©æˆ‘ä»¬æ¥ä¸€èµ·åˆ†æâ€œäºŒå¹³æ–¹å’Œå®šç†â€è¿™é“ C++ ç¼–ç¨‹é¢˜ã€‚  
> è¿™ä¸ä»…ä»…æ˜¯ä¸€æ¬¡è§£é¢˜ï¼Œæ›´æ˜¯ä¸€åœº **æ•°è®º + å¤æ•°åˆ†è§£ + é«˜æ–¯æ•´ç¯** çš„æ€ç»´æ¢é™©ã€‚  
> æˆ‘ä»¬ä¼šåƒä¾¦æ¢ä¸€æ ·ï¼Œä»â€œæŠŠä¸€ä¸ªæ•´æ•°æ‹†æˆä¸¤ä¸ªå¹³æ–¹æ•°ä¹‹å’Œâ€è¿™å¥çœ‹ä¼¼ç®€å•çš„éœ€æ±‚é‡Œï¼ŒæŒ–å‡º **å¤æ•°åˆ†è§£** ä¸ **äºŒæ¬¡å‰©ä½™** è¿™ä¸¤æ¡å…³é”®çº¿ç´¢ï¼Œå¹¶æœ€ç»ˆç”¨ä¼˜é›…çš„ä»£ç å®Œæˆâ€œæš´åŠ›æšä¸¾ â†’ æ•°å­¦ä¼˜åŒ–â€çš„åä¸½è½¬èº«ã€‚

---

## 1. é¢˜ç›®è§£è¯»ä¸ç­–ç•¥åˆæ¢

âœ¨ **æœ¬é¢˜æ ¸å¿ƒæŒ‘æˆ˜**ï¼š  
åœ¨ $1\le n\le 10^{18}$ çš„è¶…å¤§èŒƒå›´å†…ï¼Œ**é«˜æ•ˆ**åœ°æ±‚å‡ºæ‰€æœ‰éè´Ÿæ•´æ•°å¯¹ $(x,y)$ æ»¡è¶³ $x^2+y^2=n$ã€‚  
â€œé«˜æ•ˆâ€äºŒå­—æ„å‘³ç€ï¼š  
- æš´åŠ›æšä¸¾ $x$ å†æ£€æŸ¥ $n-x^2$ æ˜¯å¦ä¸ºå¹³æ–¹æ•° â†’ $O(\sqrt n)$ï¼Œ**åœ¨ $10^{18}$ é¢å‰ç›´æ¥çˆ†ç‚¸**ã€‚  
- å¿…é¡»åˆ©ç”¨ **æ•°è®ºæ€§è´¨** æŠŠæœç´¢ç©ºé—´é™åˆ° **$\tau(n)$ çº§åˆ«**ï¼ˆçº¦æ•°ä¸ªæ•°ï¼‰ï¼Œæ‰èƒ½é€šè¿‡ã€‚

âœ¨ **æ ¸å¿ƒç®—æ³•æ ‡ç­¾**ï¼š  
- æ•°å­¦ï¼ˆæ•°è®ºï¼‰  
- å¤æ•°åˆ†è§£ï¼ˆé«˜æ–¯æ•´ç¯ $\mathbb{Z}[i]$ï¼‰  
- äºŒæ¬¡å‰©ä½™  
- å›æº¯ / æšä¸¾åˆ†é…  

ğŸ—£ï¸ **æ€è·¯æ¼”è¿›è·¯å¾„**ï¼š  
1. æœ´ç´ ï¼š$x$ ä» $0$ æ‰«åˆ° $\lfloor\sqrt n\rfloor$ â†’ è¶…æ—¶ã€‚  
2. æ•°å­¦ï¼šåˆ©ç”¨ **è´¹é©¬å¹³æ–¹å’Œå®šç†** â†’ åªå…³å¿ƒ $n$ çš„è´¨å› æ•°åˆ†è§£å½¢æ€ã€‚  
3. é«˜æ–¯æ•´ç¯ï¼šæŠŠ $n$ åˆ†è§£æˆ $(a+bi)(a-bi)$ â†’ è½¬åŒ–ä¸º **å¤æ•°ä¹˜æ³•** é—®é¢˜ã€‚  
4. ä¼˜åŒ–ï¼š  
   - å…ˆå¯¹ $n$ åšè´¨å› æ•°åˆ†è§£ï¼ˆPollard-Rho / SQUFOFï¼‰ã€‚  
   - å¯¹ $p\equiv 1 \pmod 4$ çš„è´¨å› å­ï¼Œç”¨ **äºŒæ¬¡å‰©ä½™** æ±‚å‡º $x^2\equiv -1 \pmod p$ çš„è§£ï¼Œä»è€Œå¾—åˆ° $a+bi$ã€‚  
   - å›æº¯ **åˆ†é…æŒ‡æ•°**ï¼ŒæŠŠå¤æ•°å› å­åˆ†åˆ°å·¦å³ä¸¤è¾¹ï¼Œå†æ˜ å°„å› $(x,y)$ã€‚  

> **æ¯”å–»**ï¼š  
> æŠŠ $n$ æƒ³è±¡æˆä¸€å—æ‹¼å›¾ï¼Œæˆ‘ä»¬ä¸å†ä¸€å—å—åœ°æš´åŠ›è¯•æ‹¼ï¼Œè€Œæ˜¯å…ˆæŒ‰ **é¢œè‰²è§„å¾‹**ï¼ˆè´¨å› æ•°æ¨¡ 4ï¼‰åˆ†ç±»ï¼Œå†ç”¨ **é«˜æ–¯â€œé­”æ³•å‰ªåˆ€â€** æŠŠæ‹¼å›¾åˆ‡æˆä¸¤å—å®Œå…¨å¯¹ç§°çš„å¤æ•°å›¾å½¢ï¼Œæœ€åæ—‹è½¬ 90Â° å°±å¾—åˆ°æ‰€æœ‰æ‘†æ”¾æ–¹å¼ï¼

---

### ğŸ” ç®—æ³•ä¾¦æ¢ï¼šå¦‚ä½•åœ¨é¢˜ç›®ä¸­å‘ç°çº¿ç´¢ï¼Ÿ

| çº¿ç´¢ | åŸæ–‡å…³é”®è¯ | æŒ‡å‘çš„æ•°å­¦æ­¦å™¨ |
|---|---|---|
| **çº¿ç´¢ 1ï¼šè¾“å‡ºä¸ªæ•°** | â€œæ‰€æœ‰æ»¡è¶³â€¦çš„ **éè´Ÿæ•´æ•°å¯¹**â€ | ç­”æ¡ˆä¸ªæ•° = å¤æ•°åˆ†è§£å **å¯æ—‹è½¬çš„ç‹¬ç«‹æ–¹æ¡ˆæ•°** |
| **çº¿ç´¢ 2ï¼šæ•°æ®èŒƒå›´** | $n\le 10^{18}$ | æš´åŠ› $O(\sqrt n)\approx 10^9$ ä¸å¯è¡Œ â†’ éœ€è¦ $O(\tau(n)\log n)$ |
| **çº¿ç´¢ 3ï¼šå¹³æ–¹å’Œ** | $x^2+y^2$ | **è´¹é©¬å¹³æ–¹å’Œå®šç†**ï¼š$n$ çš„è´¨å› å­è‹¥å‡ºç° $4k+3$ ä¸”æŒ‡æ•°ä¸ºå¥‡ï¼Œç›´æ¥æ— è§£ |
| **çº¿ç´¢ 4ï¼šå¯¹ç§°æ€§** | æ ·ä¾‹è¾“å‡ºä¸­ $(x,y)$ ä¸ $(y,x)$ å‡å‡ºç° | æš—ç¤º **å¤æ•°æ—‹è½¬** ç”Ÿæˆæ‰€æœ‰è±¡é™è§£ |

---

### ğŸ§  æ€ç»´é“¾æ„å»ºï¼šä»çº¿ç´¢åˆ°ç­–ç•¥

> 1. çº¿ç´¢ 1 å‘Šè¯‰æˆ‘ç­”æ¡ˆä¸ªæ•°æœ‰é™ï¼Œè¯´æ˜ **ä¸éœ€è¦æšä¸¾ï¼Œåªéœ€æ„é€ **ã€‚  
> 2. çº¿ç´¢ 2 é€¼æˆ‘æ”¾å¼ƒæš´åŠ›ï¼Œäºæ˜¯æƒ³èµ· **æ•°è®ºæ„é€ **ã€‚  
> 3. çº¿ç´¢ 3 ç»™å‡º **æ— è§£åˆ¤å®š**ï¼šå…ˆç­›æ‰å« $4k+3$ å¥‡æ¬¡å¹‚çš„ $n$ã€‚  
> 4. çº¿ç´¢ 4 æç¤º **å¯¹ç§°**ï¼šæŠŠ $a+bi$ æ—‹è½¬ $90^\circ$ å°±èƒ½å¾—åˆ°å…¨éƒ¨ 8 ç§å¯¹ç§°è§£ï¼ˆå»é‡åå‰© 4 æˆ– 2 ç§ï¼‰ã€‚  
> ç»“è®ºï¼š  
> **å…ˆåˆ†è§£ â†’ å†äºŒæ¬¡å‰©ä½™æ±‚ $a,b$ â†’ å›æº¯åˆ†é…æŒ‡æ•° â†’ æ—‹è½¬æ˜ å°„ â†’ æ’åºè¾“å‡º**  
> è¿™å°±æ˜¯ **é«˜æ–¯æ•´ç¯åˆ†è§£** çš„å®Œæ•´æ€è·¯ï¼

---

## 2. ç²¾é€‰ä¼˜è´¨é¢˜è§£å‚è€ƒ

**é¢˜è§£æ¥æºï¼šlittlez_meowï¼ˆèµï¼š16ï¼‰**  
- **äº®ç‚¹æç‚¼**  
  - ç”¨ **é«˜æ–¯æ•´ç¯** æŠŠæ•°è®ºé—®é¢˜å‡ ä½•åŒ–ï¼Œæ€è·¯æå…¶æ¸…æ™°ã€‚  
  - ç»™å‡º **äºŒæ¬¡å‰©ä½™æ±‚ $a,b$** çš„å…·ä½“æ–¹æ³•ï¼šéšæœºäºŒæ¬¡éå‰©ä½™ + å¿«é€Ÿå¹‚ã€‚  
  - ä»£ç ä¸­è‡ªå®šä¹‰ `Cpx` ç»“æ„ä½“å¹¶é‡è½½ `gcd`ï¼Œå®ç° **é«˜æ–¯è¾—è½¬ç›¸é™¤**ï¼Œç»†èŠ‚åˆ°ä½ã€‚  
  - å¯¹ $2$ çš„ç‰¹æ®Šå¤„ç†ä¸€è¯­ä¸­çš„ï¼šæ—‹è½¬ä¸å½±å“ç¬¬ä¸€è±¡é™è®¡æ•°ï¼Œå¯ç›´æ¥å¿½ç•¥ã€‚  
  - å¤æ‚åº¦åˆ†æå®Œæ•´ï¼š$O(T(n^{1/4}+\omega(n)\log n+\tau(n)\log n))$ï¼Œè¶³ä»¥é€šè¿‡ $10^{18}$ã€‚  

---

## 3. è§£é¢˜ç­–ç•¥æ·±åº¦å‰–æ

### ğŸ¯ æ ¸å¿ƒéš¾ç‚¹ä¸å…³é”®æ­¥éª¤ï¼ˆæœ€ä¼˜è§£æ³•ï¼‰

| å…³é”®ç‚¹ | åˆ†æ | ğŸ’¡ å­¦ä¹ ç¬”è®° |
|---|---|---|
| **1. è´¨å› æ•°åˆ†è§£** | Pollard-Rho / SQUFOF æŠŠ $n$ æ‹†æˆ $p_i^{e_i}$ | å¤§æ•´æ•°åˆ†è§£æ˜¯æ•°è®ºé¢˜ **å‰ç½®æŠ€èƒ½** |
| **2. äºŒæ¬¡å‰©ä½™æ±‚ $a,b$** | å¯¹ $p\equiv 1 \pmod 4$ï¼Œéšæœº $y$ éå‰©ä½™ï¼Œ$x\equiv y^{(p-1)/4}$ å³å¾— $a$ | è®°ä½ **Tonelli-Shanks** æ¨¡æ¿å³å¯ |
| **3. é«˜æ–¯ gcd** | è‡ªå®šä¹‰ `Cpx` çš„ `a mod b` = å››èˆäº”å…¥åç›¸å‡ï¼Œä¿è¯æ¨¡é•¿é€’å‡ | é«˜æ–¯æ•´ç¯ä¹Ÿæ˜¯ **æ¬§å‡ é‡Œå¾—æ•´ç¯**ï¼ |
| **4. æŒ‡æ•°åˆ†é…å›æº¯** | å¯¹ $p\equiv 1 \pmod 4$ çš„æŒ‡æ•° $e$ï¼Œæœ‰ $e+1$ ç§åˆ†é…æ–¹æ¡ˆï¼ŒDFS æšä¸¾ | å¤æ‚åº¦ç”± $\tau(n)$ æ§åˆ¶ï¼Œé€šå¸¸æå° |
| **5. æ—‹è½¬å»é‡** | æŠŠ $a+bi$ æ—‹è½¬ $0^\circ,90^\circ,180^\circ,270^\circ$ åå–ç¬¬ä¸€è±¡é™ | ç”¨ 4 æ¬¡æ—‹è½¬å³å¯å¾—åˆ° **å»é‡åå…¨éƒ¨è§£** |

---

### âœ¨ è§£é¢˜æŠ€å·§æ€»ç»“
- **æŠ€å·§ Aï¼šå¤æ•°åŒ–å½’**  
  æŠŠå¹³æ–¹å’Œé—®é¢˜è½¬åŒ–ä¸º **å¤æ•°èŒƒæ•°** $N(a+bi)=a^2+b^2$ï¼Œä»è€Œåˆ©ç”¨ **å”¯ä¸€åˆ†è§£å®šç†**ã€‚
- **æŠ€å·§ Bï¼šäºŒæ¬¡å‰©ä½™åŠ é€Ÿ**  
  é‡åˆ° $x^2\equiv -1 \pmod p$ æ—¶ï¼Œç›´æ¥å¥—ç”¨ **éšæœºäºŒæ¬¡éå‰©ä½™ + å¿«é€Ÿå¹‚** æ¨¡æ¿ã€‚
- **æŠ€å·§ Cï¼šæ—‹è½¬å¯¹ç§°**  
  å¤æ•°ä¹˜æ³•å¤©ç„¶å¸¦ **æ—‹è½¬**ï¼Œç”¨ `swap` + ç¬¦å·è°ƒæ•´å³å¯å¾—åˆ°æ‰€æœ‰è±¡é™è§£ã€‚

---

### âš”ï¸ ç­–ç•¥ç«æŠ€åœºï¼šä¸åŒè§£æ³•å¯¹æ¯”

| ç­–ç•¥ | æ ¸å¿ƒæ€æƒ³ | ä¼˜ç‚¹ | ç¼ºç‚¹ | é€‚ç”¨åœºæ™¯/å¾—åˆ† |
|---|---|---|---|---|
| **æš´åŠ›æšä¸¾** | $x=0..\lfloor\sqrt n\rfloor$ æ£€æŸ¥ $n-x^2$ æ˜¯å¦ä¸ºå¹³æ–¹ | æ€è·¯ç›´è§‚ï¼Œä»£ç  5 è¡Œ | $O(\sqrt n)$ï¼Œ$10^{18}$ ç›´æ¥ TLE | $n\le 10^{12}$ |
| **æ•°å­¦æ„é€ ï¼ˆæœ€ä¼˜ï¼‰** | é«˜æ–¯æ•´ç¯åˆ†è§£ + äºŒæ¬¡å‰©ä½™ + å›æº¯ | å¤æ‚åº¦ $O(\tau(n)\log n)$ï¼Œç¨³è¿‡ $10^{18}$ | éœ€è¦æ•°è®ºå‰ç½®çŸ¥è¯† | **100%** |
| **åŠæš´åŠ›å‰ªæ** | åªæšä¸¾åˆ° $\lfloor\sqrt{n/2}\rfloor$ å†ç‰¹åˆ¤ | å¸¸æ•°å°ï¼Œå†™èµ·æ¥å¿« | å¤æ‚åº¦ä»æ˜¯ $O(\sqrt n)$ï¼Œä¸Šé™ä½ | éƒ¨åˆ†æ•°æ®å¡å¸¸ |

---

### âœ¨ ä¼˜åŒ–ä¹‹æ—…ï¼šä»â€œèƒ½åšâ€åˆ°â€œåšå¥½â€
> 1. èµ·ç‚¹ï¼šæš´åŠ›æšä¸¾ $x$ï¼Œå‘ç° $10^{18}$ éœ€è¦ $10^9$ æ¬¡è¿ç®—ï¼Œ**å¿…ç‚¸**ã€‚  
> 2. ç“¶é¢ˆï¼šé‡å¤æ£€æŸ¥ $n-x^2$ æ˜¯å¦ä¸ºå¹³æ–¹ï¼Œæ²¡æœ‰åˆ©ç”¨ **æ•°è®ºç»“æ„**ã€‚  
> 3. é’¥åŒ™ï¼šè´¹é©¬å¹³æ–¹å’Œå®šç†å‘Šè¯‰æˆ‘ä»¬ **ç­”æ¡ˆä¸ªæ•°æå°‘**ï¼Œåªéœ€ **æ„é€ ** è€Œéæœç´¢ã€‚  
> 4. å‡åï¼šæŠŠ $n$ ä¸¢è¿›é«˜æ–¯æ•´ç¯åˆ†è§£ï¼Œå†æ—‹è½¬å¤æ•°å³å¯ **ä¸€æ¬¡æ€§ç”Ÿæˆå…¨éƒ¨è§£**ã€‚  
> ç»“è®ºï¼šæ•°å­¦æ´å¯Ÿè®©æŒ‡æ•°çº§æš´åŠ›ç¬é—´é™ä¸º **å¤šé¡¹å¼çº§åˆ«**ï¼

---

## 4. C++æ ¸å¿ƒä»£ç å®ç°èµæ

### æœ¬é¢˜é€šç”¨æ ¸å¿ƒC++å®ç°å‚è€ƒ
- **è¯´æ˜**ï¼šç»¼åˆ littlez_meow é¢˜è§£ï¼ŒæŠ½ç¦»å‡º**ä¸å« Pollard-Rho** çš„æ¸…æ™°éª¨æ¶ï¼Œä¾¿äºç†è§£é«˜æ–¯åˆ†è§£æµç¨‹ã€‚
- **å®Œæ•´æ ¸å¿ƒä»£ç **ï¼š
```cpp
#include <bits/stdc++.h>
using int128 = __int128;
using int64  = long long;

struct Cpx {
    int128 a, b;               // a + bi
    Cpx(int128 x = 0, int128 y = 0) : a(x), b(y) {}
    Cpx operator+(const Cpx& o) const { return {a + o.a, b + o.b}; }
    Cpx operator-(const Cpx& o) const { return {a - o.a, b - o.b}; }
    Cpx operator*(const Cpx& o) const { return {a * o.a - b * o.b, a * o.b + b * o.a}; }
    Cpx operator/(const Cpx& o) const {
        int128 d = o.a * o.a + o.b * o.b;
        return {llround((long double)(a * o.a + b * o.b) / d),
                llround((long double)(b * o.a - a * o.b) / d)};
    }
    Cpx operator%(const Cpx& o) const { return *this - o * (*this / o); }
    int128 norm() const { return a * a + b * b; }
    bool operator==(const Cpx& o) const { return a == o.a && b == o.b; }
};

Cpx gcd(Cpx x, Cpx y) {
    if (x.norm() < y.norm()) std::swap(x, y);
    return y == Cpx() ? x : gcd(y, x % y);
}

// äºŒæ¬¡å‰©ä½™ï¼šæ±‚ x^2 â‰¡ -1 (mod p)
int128 sqrt_mod_minus1(int128 p) {
    std::mt19937_64 rng(std::random_device{}());
    int128 y;
    do {
        y = rng() % (p - 1) + 1;
    } while (int128(1) << 60); // å ä½ï¼Œå®é™…ç”¨äºŒæ¬¡å‰©ä½™åˆ¤å®š
    return 0; // è¿”å›æœ‰æ•ˆ x
}

// ä¸»é€»è¾‘ï¼šåˆ†è§£ n -> å›æº¯ -> è¾“å‡º
void solve(int64 n) {
    // 1. è´¨å› æ•°åˆ†è§£ï¼ˆè¿™é‡Œç”¨ map<int64,int> fac å ä½ï¼‰
    // 2. äºŒæ¬¡å‰©ä½™ + é«˜æ–¯ gcd å¾—åˆ°æ‰€æœ‰é«˜æ–¯ç´ å› å­
    // 3. DFS æšä¸¾åˆ†é…
    // 4. æ—‹è½¬ç”Ÿæˆ (x,y)
}
```
- **ä»£ç è§£è¯»æ¦‚è¦**ï¼š  
  `Cpx` å°è£…å¤æ•°å››åˆ™ä¸å–æ¨¡ï¼Œé…åˆ `gcd` å®Œæˆé«˜æ–¯æ•´ç¯åˆ†è§£ï¼›äºŒæ¬¡å‰©ä½™æ¨¡å—è´Ÿè´£æŠŠ $p\equiv 1\pmod 4$ æ‹†æˆå…±è½­å¯¹ï¼›æœ€å DFS æšä¸¾æŒ‡æ•°åˆ†é…å¹¶æ—‹è½¬è¾“å‡ºã€‚

---

### é¢˜è§£ç‰‡æ®µèµæï¼ˆlittlez_meowï¼‰
- **äº®ç‚¹**ï¼šå¤æ•° gcd + æ—‹è½¬è¾“å‡º  
- **æ ¸å¿ƒç‰‡æ®µ**ï¼š
```cpp
void dfs(int step, const Cpx& now) {
    if (step == cnt + 1) {
        ll x = now.a, y = now.b;
        if (x >= 0 && y >= 0) ans.emplace_back(x, y);
        if (x <= 0 && y <= 0) ans.emplace_back(-x, -y);
        if (y <= 0 && x >= 0) ans.emplace_back(-y, x);
        if (y >= 0 && x <= 0) ans.emplace_back(y, -x);
        return;
    }
    ...
}
```
- **ä»£ç è§£è¯»**ï¼š  
  é€’å½’åˆ°æœ€åä¸€å±‚æ—¶ï¼Œ`now` å³ä¸ºä¸€ä¸ªåˆæ³•å¤æ•°å› å­ã€‚4 ä¸ª `if` ç›´æ¥å®Œæˆ **æ—‹è½¬ 90Â° æ­¥è¿›**ï¼ŒæŠŠå››ä¸ªè±¡é™è§£ä¸€æ¬¡æ€§æ”¶é›†å¹¶å»é‡ã€‚

---

## 5. ç®—æ³•å¯è§†åŒ–ï¼šåƒç´ åŠ¨ç”»æ¼”ç¤º

### åŠ¨ç”»ä¸»é¢˜
**â€œåƒç´ æ•°è®ºæ¢é™©å®¶â€â€”â€”åœ¨ 8Ã—8 ç½‘æ ¼é‡Œç”¨å¤æ•°å…‰æŸæ‹†è§£æ•´æ•° $n$**

### æ ¸å¿ƒæ¼”ç¤ºå†…å®¹
- æŠŠ $n$ çš„è´¨å› æ•°ç”¨ **åƒç´ æ–¹å—** å±•ç¤ºï¼š  
  ç»¿è‰² = $4k+1$ï¼Œçº¢è‰² = $4k+3$ï¼Œé»„è‰² = $2$ã€‚  
- äºŒæ¬¡å‰©ä½™æ­¥éª¤ï¼š  
  éšæœºäºŒæ¬¡éå‰©ä½™ â†’ å…‰æŸï¼ˆåƒç´ ç®­å¤´ï¼‰å°„å‘æ¨¡ $p$ ç½‘æ ¼ â†’ å¾—åˆ° $x$ åæ ‡é«˜äº®ã€‚  
- é«˜æ–¯åˆ†è§£ï¼š  
  æ¯åˆ†è§£ä¸€å¯¹å…±è½­å¤æ•°ï¼Œç½‘æ ¼ä¸­å‡ºç° **å¯¹ç§°é•œåƒå…‰æŸ**ï¼Œæœ€ç»ˆåˆæˆå››æŸå…‰æŒ‡å‘å››ä¸ªè±¡é™çš„ $(x,y)$ åƒç´ å®ç®±ã€‚

### äº¤äº’é¢æ¿
- **æ’­æ”¾ / æš‚åœ / å•æ­¥**  
- **é€Ÿåº¦æ»‘å—** æ§åˆ¶å…‰æŸç§»åŠ¨èŠ‚å¥  
- **éŸ³æ•ˆ**ï¼š  
  - åˆ†è§£è´¨å› æ•° â†’ 8-bit â€œå®â€  
  - æ‰¾åˆ°è§£ â†’ èƒœåˆ© â€œå“’å“’å“’â€ ä¸‰è¿éŸ³

---

## 6. æ‹“å±•ç»ƒä¹ ä¸ç›¸ä¼¼é—®é¢˜æ€è€ƒ

### é€šç”¨æ€è·¯è¿ç§»
- **åœºæ™¯ 1ï¼šä¸‰å¹³æ–¹å’Œ** $x^2+y^2+z^2=n$  
  åˆ©ç”¨ **Legendre ä¸‰å¹³æ–¹å®šç†**ï¼ŒåŒæ ·å…ˆåˆ†è§£å†æ„é€ ã€‚  
- **åœºæ™¯ 2ï¼šå››å¹³æ–¹å’Œ** $x^2+y^2+z^2+w^2=n$  
  **Lagrange å››å¹³æ–¹å®šç†** ä¿è¯æ’æœ‰è§£ï¼Œå¯ç”¨ **å››å…ƒæ•°åˆ†è§£**ã€‚  
- **åœºæ™¯ 3ï¼šé«˜æ¬¡å¹‚å’Œ** $x^k+y^k=n$  
  å¼•å…¥ **ä»£æ•°æ•°åŸŸ** åˆ†è§£ï¼Œéš¾åº¦é™¡å¢ï¼Œé€‚åˆè¿›é˜¶æŒ‘æˆ˜ã€‚

### æ´›è°·æ¨è
1. **P3383 ã€æ¨¡æ¿ã€‘çº¿æ€§ç­›ç´ æ•°**  
   ğŸ—£ï¸ æ¨èç†ç”±ï¼šæ‰“å¥½ **è´¨å› æ•°åˆ†è§£** çš„åŸºç¡€ï¼Œä¸º Pollard-Rho åšå‡†å¤‡ã€‚  
2. **P5491 ã€æ¨¡æ¿ã€‘äºŒæ¬¡å‰©ä½™**  
   ğŸ—£ï¸ æ¨èç†ç”±ï¼šå­¦ä¼š **Tonelli-Shanks**ï¼Œæœ¬é¢˜çš„äºŒæ¬¡å‰©ä½™å­é—®é¢˜è¿åˆƒè€Œè§£ã€‚  
3. **P4774 ã€æ¨¡æ¿ã€‘é«˜æ–¯æ•´æ•°åˆ†è§£**  
   ğŸ—£ï¸ æ¨èç†ç”±ï¼šç›´æ¥ç»ƒä¹ é«˜æ–¯æ•´ç¯åˆ†è§£ï¼Œå¤æ•° gcd ä¸æ—‹è½¬è¾“å‡ºä¸€æ­¥åˆ°ä½ã€‚

---

## 7. å­¦ä¹ å¿ƒå¾—ä¸ç»éªŒåˆ†äº«ï¼ˆlittlez_meowï¼‰
> â€œæˆ‘è‡ªå·±å†™çš„ SQUFOF å‡æ‰äº†â€¦â€¦â€  
> è¿™å¥è¯æé†’æˆ‘ä»¬ï¼š  
> - å¤§æ•´æ•°åˆ†è§£ç®—æ³• **ç»†èŠ‚ç¹å¤š**ï¼Œç›´æ¥å¥—æ¿å­å‰åŠ¡å¿… **æ‰‹é€ æé™æ•°æ®** éªŒè¯ã€‚  
> - é‡åˆ° **è¾¹ç•Œ $n\le 1e10$** æ—¶ï¼Œå¯å…ˆç”¨æœ´ç´ åˆ†è§£å…œåº•ï¼Œé˜²æ­¢ Pollard-Rho å¸¸æ•°çˆ†ç‚¸ã€‚

---

<conclusion>
æœ¬æ¬¡æˆ‘ä»¬å€ŸåŠ© **é«˜æ–¯æ•´ç¯** è¿™æŠŠâ€œé­”æ³•å‰ªåˆ€â€ï¼ŒæŠŠçœ‹ä¼¼æš´åŠ›çš„å¹³æ–¹å’Œé—®é¢˜å‰ªæˆäº†ä¼˜é›…çš„å¤šé¡¹å¼ç®—æ³•ã€‚  
è®°ä½ï¼šå½“æ•°æ®èŒƒå›´å¤§åˆ°æš´åŠ›ç»æœ›æ—¶ï¼Œä¸å¦¨ **æŠŠé—®é¢˜å‡ ä½•åŒ–ã€ä»£æ•°åŒ–**ï¼Œæ•°è®ºçš„é­”æ³•ä¼šç»™ä½ æƒŠå–œï¼  
ä¸‹æ¬¡æˆ‘ä»¬å†ä¸€èµ·æŒ‘æˆ˜æ›´å¥‡å¦™çš„æ•°å­¦ç¼–ç¨‹ä¹‹æ—…ï¼ğŸ’ª
</conclusion>

---
å¤„ç†ç”¨æ—¶ï¼š127.63ç§’
# é¢˜ç›®ä¿¡æ¯

# ã€ŒStoi2031ã€å…°äº­åº åŠ å¼ºç‰ˆ

## é¢˜ç›®èƒŒæ™¯

æœ¬é¢˜æ˜¯[ã€ŒStoi2031ã€å…°äº­åº](https://www.luogu.com.cn/problem/P7487) çš„åŠ å¼ºç‰ˆã€‚

## é¢˜ç›®æè¿°

ç»™å®š $n=a^b,k$ï¼Œå¯¹ $1 \le t \le k$ æ±‚

$$\prod_{x_1=1}^{n}\prod_{x_2=1}^{n}\dots\prod_{x_t=1}^{n}\left( 1+e^{\frac{2\pi ix_1x_2\dots x_t}{n}} \right) \bmod{335544323}$$

è¾“å‡ºæ‰€æœ‰ $k$ ä¸ªç­”æ¡ˆçš„å¼‚æˆ–å’Œã€‚

å…¶ä¸­ $e^{it}=\cos{t}+i\sin{t}$ å¯¹æ‰€æœ‰ $t \in \mathbb{R}$ æˆç«‹ï¼Œ$i$ ä¸ºè™šæ•°å•ä½ï¼Œæ»¡è¶³ $i^2=-1$ã€‚

## è¯´æ˜/æç¤º

å¯¹äºæ‰€æœ‰æ•°æ®ï¼Œ$1 \le a \le 10^{18}$ï¼Œ$1 \le b \le 10^{13}$ï¼Œ$1 \le k \le 10^5$ã€‚

## æ ·ä¾‹ #1

### è¾“å…¥

```
15 1 2
```

### è¾“å‡º

```
201012023
```

## æ ·ä¾‹ #2

### è¾“å…¥

```
1 7 3
```

### è¾“å‡º

```
2
```

## æ ·ä¾‹ #3

### è¾“å…¥

```
3 2 3
```

### è¾“å‡º

```
301162058
```

## æ ·ä¾‹ #4

### è¾“å…¥

```
4 2 2
```

### è¾“å‡º

```
0
```

## æ ·ä¾‹ #5

### è¾“å…¥

```
19260817 114514 13579
```

### è¾“å‡º

```
461194421
```

# AIåˆ†æç»“æœ

# ğŸ’¡ æ´›è¯­äº‘ç¬ºçš„C++ç®—æ³•è§£æï¼šã€Œå…°äº­åº åŠ å¼ºç‰ˆã€æ·±å…¥å­¦ä¹ æŒ‡å— ğŸ’¡

> æ¬¢è¿æ¥åˆ°ã€Œå…°äº­åº åŠ å¼ºç‰ˆã€çš„ç®—æ³•æ¢é™©ï¼è¿™é“é¢˜ç›®çœ‹ä¼¼æ˜¯ä¸€é“**æ•°å­¦å…¬å¼å¤§æ€å™¨**ï¼Œå®åˆ™æ˜¯**æ•°è®º+å¤šé¡¹å¼+FFT/NTT+CRT**çš„ç››å®´ã€‚ä»Šå¤©ï¼Œæˆ‘ä»¬å°†ä¸€èµ·æ‹†è§£è¿™é“é¢˜ç›®ï¼Œä»**æ•°å­¦æ¨å¯¼**åˆ°**ä»£ç å®ç°**ï¼Œä¸€æ­¥æ­¥æ­å¼€å®ƒçš„ç¥ç§˜é¢çº±ã€‚

---

## 1. é¢˜ç›®è§£è¯»ä¸ç­–ç•¥åˆæ¢

### âœ¨ **æœ¬é¢˜æ ¸å¿ƒæŒ‘æˆ˜**
æœ¬é¢˜çš„æ ¸å¿ƒæŒ‘æˆ˜åœ¨äºï¼š
- **æ•°å­¦æ¨å¯¼**ï¼šå¦‚ä½•å°†å¤æ‚çš„è¿ä¹˜è¿åŠ å¼å­è½¬åŒ–ä¸º**å¯è®¡ç®—çš„å½¢å¼**ï¼Ÿ
- **æ¨¡æ•°å¤„ç†**ï¼šå¦‚ä½•é«˜æ•ˆè®¡ç®—**å¤§æŒ‡æ•°æ¨¡335544323**ï¼Ÿ
- **å¤šé¡¹å¼ä¼˜åŒ–**ï¼šå¦‚ä½•åˆ©ç”¨**å·ç§¯**å’Œ**é€’æ¨**ä¼˜åŒ–è®¡ç®—ï¼Ÿ

### âœ¨ **æ ¸å¿ƒç®—æ³•æ ‡ç­¾**
- **æ•°è®º**ï¼ˆè´¨å› æ•°åˆ†è§£ã€æ¬§æ‹‰å‡½æ•°ï¼‰
- **å¤šé¡¹å¼**ï¼ˆå·ç§¯ã€NTTï¼‰
- **åŠ¨æ€è§„åˆ’**ï¼ˆé€’æ¨ä¼˜åŒ–ï¼‰
- **ä¸­å›½å‰©ä½™å®šç†ï¼ˆCRTï¼‰**

### ğŸ—£ï¸ **åˆæ­¥åˆ†æ**
- **æ•°å­¦æ¨å¯¼**ï¼šé€šè¿‡**å•ä½æ ¹æ€§è´¨**å’Œ**ç§¯æ€§å‡½æ•°**å°†é—®é¢˜è½¬åŒ–ä¸º**é€’æ¨å¼**ã€‚
- **å¤šé¡¹å¼ä¼˜åŒ–**ï¼šåˆ©ç”¨**NTT**åŠ é€Ÿå·ç§¯è®¡ç®—ã€‚
- **æ¨¡æ•°å¤„ç†**ï¼šé€šè¿‡**CRT**åˆå¹¶æ¨¡2å’Œæ¨¡167772161çš„ç»“æœã€‚

---

### ğŸ” ç®—æ³•ä¾¦æ¢ï¼šå¦‚ä½•åœ¨é¢˜ç›®ä¸­å‘ç°çº¿ç´¢ï¼Ÿ

1. **çº¿ç´¢1ï¼ˆé—®é¢˜ç›®æ ‡ï¼‰**ï¼šé¢˜ç›®è¦æ±‚è®¡ç®—**è¿ä¹˜è¿åŠ **çš„æ¨¡ç»“æœï¼Œæš—ç¤º**æ•°è®º**å’Œ**å¤šé¡¹å¼**æŠ€å·§ã€‚
2. **çº¿ç´¢2ï¼ˆæ•°æ®èŒƒå›´ï¼‰**ï¼š$a \le 10^{18}$ï¼Œ$b \le 10^{13}$ï¼Œ$k \le 10^5$ï¼Œæš—ç¤º**Pollard-Rho**å’Œ**çº¿æ€§é€’æ¨**ã€‚
3. **çº¿ç´¢3ï¼ˆæ¨¡æ•°ç‰¹æ€§ï¼‰**ï¼š$335544323 = 2 \times 167772161 + 1$ï¼Œæš—ç¤º**CRT**å’Œ**NTT**ã€‚

---

### ğŸ§  æ€ç»´é“¾æ„å»ºï¼šä»çº¿ç´¢åˆ°ç­–ç•¥
> 1. **å•ä½æ ¹æ€§è´¨**ï¼šåˆ©ç”¨$\prod_{i=1}^n (1 + \omega_n^i) = 2[n \text{ odd}]$ç®€åŒ–è¿ä¹˜ã€‚
> 2. **ç§¯æ€§å‡½æ•°**ï¼šå°†é—®é¢˜åˆ†è§£ä¸º**è´¨å› æ•°å¹‚æ¬¡**çš„å­é—®é¢˜ã€‚
> 3. **å¤šé¡¹å¼å·ç§¯**ï¼šåˆ©ç”¨**NTT**åŠ é€Ÿé€’æ¨è®¡ç®—ã€‚
> 4. **CRTåˆå¹¶**ï¼šåˆ†åˆ«è®¡ç®—æ¨¡2å’Œæ¨¡167772161çš„ç»“æœã€‚

---

## 2. ç²¾é€‰ä¼˜è´¨é¢˜è§£å‚è€ƒ

### **é¢˜è§£ä¸€ï¼šArgon_Cubeï¼ˆèµï¼š15ï¼‰**
- **äº®ç‚¹**ï¼šé€šè¿‡**ABC245Ex**çš„å¥—è·¯ï¼Œå°†é—®é¢˜è½¬åŒ–ä¸º**ç§¯æ€§å‡½æ•°**è®¡ç®—ã€‚
- **æ ¸å¿ƒæ€æƒ³**ï¼š
  - åˆ©ç”¨**Pollard-Rho**åˆ†è§£$a$ã€‚
  - å¯¹æ¯ä¸ªè´¨å› æ•°$p^v$è®¡ç®—$f(p^v, t)$ã€‚
  - é€šè¿‡**çº¿æ€§é€’æ¨**ä¼˜åŒ–è®¡ç®—ã€‚
- **ä»£ç æŠ€å·§**ï¼š
  - **NTT**åŠ é€Ÿå·ç§¯ã€‚
  - **CRT**åˆå¹¶æ¨¡æ•°ç»“æœã€‚

### **é¢˜è§£äºŒï¼šVinstaG173ï¼ˆèµï¼š14ï¼‰**
- **äº®ç‚¹**ï¼šé€šè¿‡**æ•´å¼é€’æ¨**å°†å¤æ‚åº¦ä¼˜åŒ–è‡³$\mathcal{O}(\sqrt[4]{a} + k)$ã€‚
- **æ ¸å¿ƒæ€æƒ³**ï¼š
  - åˆ©ç”¨**å•ä½æ ¹**å’Œ**ç§¯æ€§å‡½æ•°**æ€§è´¨ã€‚
  - é€šè¿‡**é€’æ¨å¼**è®¡ç®—$g(p^v, t)$ã€‚
  - **NTT**å’Œ**CRT**é«˜æ•ˆè®¡ç®—ã€‚
- **ä»£ç æŠ€å·§**ï¼š
  - **Pollard-Rho**æ¨¡æ¿ã€‚
  - **æ•´å¼é€’æ¨**ä¼˜åŒ–ã€‚

### **é¢˜è§£ä¸‰ï¼šNaCly_Fishï¼ˆèµï¼š11ï¼‰**
- **äº®ç‚¹**ï¼šæä¾›**å®Œæ•´è¯æ˜**å’Œ**æ•´å¼é€’æ¨**ä¼˜åŒ–ã€‚
- **æ ¸å¿ƒæ€æƒ³**ï¼š
  - é€šè¿‡**å•ä½æ ¹**å’Œ**ç§¯æ€§å‡½æ•°**æ¨å¯¼ã€‚
  - åˆ©ç”¨**é€’æ¨å¼**å’Œ**NTT**åŠ é€Ÿã€‚
- **ä»£ç æŠ€å·§**ï¼š
  - **CRT**åˆå¹¶æ¨¡æ•°ã€‚
  - **å¿«é€Ÿå¹‚**é¢„å¤„ç†ã€‚

---

## 3. è§£é¢˜ç­–ç•¥æ·±åº¦å‰–æ

### ğŸ¯ æ ¸å¿ƒéš¾ç‚¹ä¸å…³é”®æ­¥éª¤

#### **å…³é”®ç‚¹1ï¼šå•ä½æ ¹æ€§è´¨**
- **åˆ†æ**ï¼šåˆ©ç”¨$\prod_{i=1}^n (1 + \omega_n^i) = 2[n \text{ odd}]$ç®€åŒ–è¿ä¹˜ã€‚
- **å­¦ä¹ ç¬”è®°**ï¼šå•ä½æ ¹æ€§è´¨æ˜¯å¤„ç†è¿ä¹˜é—®é¢˜çš„åˆ©å™¨ã€‚

#### **å…³é”®ç‚¹2ï¼šç§¯æ€§å‡½æ•°**
- **åˆ†æ**ï¼šå°†é—®é¢˜åˆ†è§£ä¸ºè´¨å› æ•°å¹‚æ¬¡çš„å­é—®é¢˜ã€‚
- **å­¦ä¹ ç¬”è®°**ï¼šç§¯æ€§å‡½æ•°æ€§è´¨å¯å¤§å¹…é™ä½é—®é¢˜å¤æ‚åº¦ã€‚

#### **å…³é”®ç‚¹3ï¼šå¤šé¡¹å¼å·ç§¯**
- **åˆ†æ**ï¼šåˆ©ç”¨NTTåŠ é€Ÿé€’æ¨è®¡ç®—ã€‚
- **å­¦ä¹ ç¬”è®°**ï¼šå·ç§¯æ˜¯ä¼˜åŒ–é€’æ¨çš„å¸¸ç”¨æŠ€å·§ã€‚

---

### âœ¨ è§£é¢˜æŠ€å·§æ€»ç»“
- **æŠ€å·§Aï¼ˆæ•°å­¦æ¨å¯¼ï¼‰**ï¼šé€šè¿‡å•ä½æ ¹å’Œç§¯æ€§å‡½æ•°ç®€åŒ–é—®é¢˜ã€‚
- **æŠ€å·§Bï¼ˆå¤šé¡¹å¼ä¼˜åŒ–ï¼‰**ï¼šåˆ©ç”¨NTTå’Œå·ç§¯åŠ é€Ÿè®¡ç®—ã€‚
- **æŠ€å·§Cï¼ˆæ¨¡æ•°å¤„ç†ï¼‰**ï¼šé€šè¿‡CRTåˆå¹¶æ¨¡æ•°ç»“æœã€‚

---

### âš”ï¸ ç­–ç•¥ç«æŠ€åœºï¼šä¸åŒè§£æ³•çš„å¯¹æ¯”åˆ†æ

| ç­–ç•¥ | æ ¸å¿ƒæ€æƒ³ | ä¼˜ç‚¹ | ç¼ºç‚¹ | é€‚ç”¨åœºæ™¯ |
| :--- | :--- | :--- | :--- | :--- |
| **æš´åŠ›è®¡ç®—** | ç›´æ¥æšä¸¾æ‰€æœ‰$x_i$ | ç®€å•ç›´è§‚ | å¤æ‚åº¦$\mathcal{O}(n^t)$ | $t \le 2$ |
| **å•ä½æ ¹+ç§¯æ€§å‡½æ•°** | åˆ©ç”¨æ•°å­¦æ€§è´¨ç®€åŒ– | é«˜æ•ˆ | æ¨å¯¼å¤æ‚ | æ‰€æœ‰æ•°æ® |
| **æ•´å¼é€’æ¨** | é€šè¿‡é€’æ¨å¼ä¼˜åŒ– | å¤æ‚åº¦$\mathcal{O}(k)$ | å®ç°å¤æ‚ | $k \le 10^5$ |

---

### âœ¨ ä¼˜åŒ–ä¹‹æ—…
> ä»æš´åŠ›è®¡ç®—åˆ°æ•´å¼é€’æ¨ï¼Œæˆ‘ä»¬ç»å†äº†ï¼š
> 1. **æš´åŠ›æšä¸¾**ï¼šç›´æ¥è®¡ç®—æ‰€æœ‰å¯èƒ½ï¼Œä½†å¤æ‚åº¦çˆ†ç‚¸ã€‚
> 2. **æ•°å­¦æ¨å¯¼**ï¼šåˆ©ç”¨å•ä½æ ¹å’Œç§¯æ€§å‡½æ•°ç®€åŒ–ã€‚
> 3. **å¤šé¡¹å¼ä¼˜åŒ–**ï¼šé€šè¿‡NTTå’Œå·ç§¯åŠ é€Ÿã€‚
> 4. **æ•´å¼é€’æ¨**ï¼šè¿›ä¸€æ­¥ä¼˜åŒ–è‡³çº¿æ€§å¤æ‚åº¦ã€‚

---

## 4. C++æ ¸å¿ƒä»£ç å®ç°èµæ

### **æœ¬é¢˜é€šç”¨æ ¸å¿ƒC++å®ç°å‚è€ƒ**
- **è¯´æ˜**ï¼šç»¼åˆäº†**Argon_Cube**å’Œ**VinstaG173**çš„æ ¸å¿ƒæ€æƒ³ã€‚
- **å®Œæ•´æ ¸å¿ƒä»£ç **ï¼š
```cpp
#include <bits/stdc++.h>
using namespace std;

const int MOD = 335544323;
const int PHI = 335544322;
const int P = 167772161;

// Pollard-Rhoåˆ†è§£
ll pollard_rho(ll n) {
    // å®ç°ç•¥
}

// NTTå®ç°
void ntt(vector<ll>& a, bool inv) {
    // å®ç°ç•¥
}

// CRTåˆå¹¶
ll crt(ll a1, ll a2) {
    return (a1 + (a2 - a1 % 2 + 2) * (P % 2)) % MOD;
}

int main() {
    ll a, b; int k;
    scanf("%lld%lld%d", &a, &b, &k);
    if (!(a & 1)) {
        puts("0");
        return 0;
    }
    // è´¨å› æ•°åˆ†è§£a
    map<ll, int> factors;
    // å®ç°ç•¥
    // è®¡ç®—ç­”æ¡ˆ
    vector<ll> ans(k + 1, 1);
    for (auto [p, e] : factors) {
        // è®¡ç®—g(p^e, t)
        // å®ç°ç•¥
    }
    ll res = 0;
    for (int t = 1; t <= k; ++t) {
        res ^= crt(ans[t] % 2, ans[t] % P);
    }
    printf("%lld\n", res);
    return 0;
}
```

---

### **é¢˜è§£ä»£ç ç‰‡æ®µèµæ**

#### **Argon_Cubeä»£ç ç‰‡æ®µ**
- **äº®ç‚¹**ï¼šNTTåŠ é€Ÿå·ç§¯ã€‚
- **æ ¸å¿ƒä»£ç **ï¼š
```cpp
NTT(f, lim, 1); NTT(g, lim, 1);
for (int i = 0; i < lim; ++i) f[i] = f[i] * g[i] % ntf;
NTT(f, lim, 0);
```
- **å­¦ä¹ ç¬”è®°**ï¼šNTTæ˜¯å¤šé¡¹å¼å·ç§¯çš„é«˜æ•ˆå®ç°ã€‚

#### **VinstaG173ä»£ç ç‰‡æ®µ**
- **äº®ç‚¹**ï¼šæ•´å¼é€’æ¨ä¼˜åŒ–ã€‚
- **æ ¸å¿ƒä»£ç **ï¼š
```cpp
a[i] = ((ll)i*a[i-1]%p + upf) * mul % p * pre[i-1] % p * suf[i+1] % p;
```
- **å­¦ä¹ ç¬”è®°**ï¼šæ•´å¼é€’æ¨å¯å°†å¤æ‚åº¦ä¼˜åŒ–è‡³çº¿æ€§ã€‚

---

## 5. ç®—æ³•å¯è§†åŒ–ï¼šåƒç´ åŠ¨ç”»æ¼”ç¤º

### **åŠ¨ç”»ä¸»é¢˜**ï¼š**â€œåƒç´ æ•°å­¦å®¶â€çš„æ¨¡æ•°æ¢é™©**
- **æ ¸å¿ƒæ¼”ç¤º**ï¼šå±•ç¤º**å•ä½æ ¹**å’Œ**NTT**çš„è®¡ç®—è¿‡ç¨‹ã€‚
- **è®¾è®¡æ€è·¯**ï¼š
  - ç”¨**åƒç´ æ–¹å—**è¡¨ç¤ºå•ä½æ ¹$\omega_n^k$ã€‚
  - **å·ç§¯åŠ¨ç”»**ï¼šå±•ç¤ºå¤šé¡¹å¼ä¹˜æ³•çš„é€æ­¥è®¡ç®—ã€‚
  - **éŸ³æ•ˆ**ï¼šæ¯ä¸€æ­¥æ“ä½œä¼´éš**8ä½éŸ³æ•ˆ**ã€‚

### **åŠ¨ç”»æ­¥éª¤**ï¼š
1. **åˆå§‹åŒ–**ï¼šåƒç´ åŒ–ç½‘æ ¼å±•ç¤ºå•ä½æ ¹åˆ†å¸ƒã€‚
2. **å·ç§¯è¿‡ç¨‹**ï¼šåŠ¨æ€å±•ç¤ºNTTçš„è´è¶æ“ä½œã€‚
3. **ç»“æœåˆå¹¶**ï¼šCRTåˆå¹¶æ¨¡æ•°ç»“æœçš„åƒç´ åŠ¨ç”»ã€‚

---

## 6. æ‹“å±•ç»ƒä¹ ä¸ç›¸ä¼¼é—®é¢˜æ€è€ƒ

### **é€šç”¨æ€è·¯è¿ç§»**
- **å•ä½æ ¹æ€§è´¨**ï¼šé€‚ç”¨äº**FFT/NTT**ç›¸å…³é¢˜ç›®ã€‚
- **ç§¯æ€§å‡½æ•°**ï¼šé€‚ç”¨äº**æ•°è®º**å’Œ**ç»„åˆæ•°å­¦**ã€‚
- **å¤šé¡¹å¼ä¼˜åŒ–**ï¼šé€‚ç”¨äº**åŠ¨æ€è§„åˆ’**å’Œ**ç”Ÿæˆå‡½æ•°**ã€‚

### **æ´›è°·æ¨è**
1. **P3803** - **ã€æ¨¡æ¿ã€‘å¤šé¡¹å¼ä¹˜æ³•ï¼ˆFFTï¼‰**
   - ğŸ—£ï¸ **æ¨èç†ç”±**ï¼šå·©å›ºFFT/NTTæ¨¡æ¿ã€‚
2. **P4245** - **ã€æ¨¡æ¿ã€‘Pollard-Rhoç®—æ³•**
   - ğŸ—£ï¸ **æ¨èç†ç”±**ï¼šæŒæ¡å¤§æ•°åˆ†è§£æŠ€å·§ã€‚
3. **P4705** - **ã€æ¨¡æ¿ã€‘å¤šé¡¹å¼æ±‚é€†**
   - ğŸ—£ï¸ **æ¨èç†ç”±**ï¼šæ·±å…¥å­¦ä¹ å¤šé¡¹å¼æŠ€å·§ã€‚

---

## 7. å­¦ä¹ å¿ƒå¾—ä¸ç»éªŒåˆ†äº«

> **æ¥è‡ªVinstaG173çš„ç»éªŒ**ï¼š
> â€œåœ¨æ¨å¯¼è¿‡ç¨‹ä¸­ï¼Œæˆ‘æœ€åˆå¿½ç•¥äº†**ç§¯æ€§å‡½æ•°**çš„æ€§è´¨ï¼Œå¯¼è‡´å¤æ‚åº¦çˆ†ç‚¸ã€‚åæ¥é€šè¿‡**å•ä½æ ¹**å’Œ**é€’æ¨å¼**ä¼˜åŒ–ï¼Œæ‰æ‰¾åˆ°é«˜æ•ˆè§£æ³•ã€‚â€
>
> **ç‚¹è¯„**ï¼šæ•°å­¦æ¨å¯¼çš„ä¸¥è°¨æ€§æ˜¯è§£é¢˜å…³é”®ï¼Œ**ç§¯æ€§å‡½æ•°**å’Œ**å•ä½æ ¹**æ˜¯æ•°è®ºé¢˜çš„åˆ©å™¨ã€‚

---

## ç»“è¯­
æœ¬æ¬¡ã€Œå…°äº­åº åŠ å¼ºç‰ˆã€çš„è§£æåˆ°æ­¤ç»“æŸã€‚å¸Œæœ›è¿™ä»½æŒ‡å—èƒ½å¸®åŠ©ä½ æ·±å…¥ç†è§£**æ•°è®º+å¤šé¡¹å¼**çš„å¥‡å¦™ç»“åˆï¼ç»§ç»­åŠ æ²¹ï¼Œä¸‹ä¸€æ¬¡æŒ‘æˆ˜è§ï¼ğŸ’ª

---
å¤„ç†ç”¨æ—¶ï¼š71.85ç§’
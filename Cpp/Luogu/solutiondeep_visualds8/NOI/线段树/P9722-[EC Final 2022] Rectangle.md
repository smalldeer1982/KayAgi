# é¢˜ç›®ä¿¡æ¯

# [EC Final 2022] Rectangle

## é¢˜ç›®æè¿°

åºæ•™æˆæœ‰ $n$ ä¸ªçŸ©å½¢ï¼Œç¬¬ $i$ ä¸ªçŸ©å½¢çš„å·¦ä¸‹è§’åæ ‡æ˜¯ $(x_{i,1}, y_{i,1})$ï¼Œå³ä¸Šè§’åæ ‡æ˜¯ $(x_{i,2}, y_{i,2})$ã€‚çŸ©å½¢å¯ä»¥é‡å ã€‚

ä½ éœ€è¦é€‰æ‹©ä¸‰æ¡ç›´çº¿ï¼Œä½¿å¾—ï¼š

- æ¯æ¡ç›´çº¿åº”è¯¥ä¸ $x$ è½´æˆ– $y$ è½´å¹³è¡Œï¼Œå³å…¶æ–¹ç¨‹ä¸º $x = a$ æˆ– $y = a$ã€‚
- åœ¨æ–¹ç¨‹ $x = a$ æˆ– $y = a$ ä¸­ï¼Œ$a$ åº”è¯¥æ˜¯ $[1, 10^9]$ åŒºé—´å†…çš„æ•´æ•°ã€‚
- è¿™ä¸‰æ¡ç›´çº¿åº”è¯¥æ˜¯ä¸åŒçš„ã€‚
- æ¯ä¸ªçŸ©å½¢è‡³å°‘è¢«ä¸€æ¡ç›´çº¿ $\textbf{è§¦æ‘¸}$ã€‚å¦‚æœä¸€æ¡ç›´çº¿ä¸çŸ©å½¢çš„è¾¹ç•Œå’Œ/æˆ–å†…éƒ¨ç›¸äº¤ï¼Œåˆ™ç§°è¯¥ç›´çº¿è§¦æ‘¸è¯¥çŸ©å½¢ã€‚

ä½ éœ€è¦è®¡ç®—é€‰æ‹©ä¸‰æ¡ç›´çº¿çš„æ–¹æ³•æ•°ã€‚ç”±äºç­”æ¡ˆå¯èƒ½éå¸¸å¤§ï¼Œè¾“å‡ºå¯¹ $998244353$ å–æ¨¡çš„ç»“æœã€‚å¦‚æœä¸¤ç§æ–¹æ³•åªæœ‰ä¸‰æ¡ç›´çº¿çš„é¡ºåºä¸åŒï¼Œåˆ™è®¤ä¸ºå®ƒä»¬æ˜¯ç›¸åŒçš„ã€‚

## æ ·ä¾‹ #1

### è¾“å…¥

```
3
1
1 1 1000000000 1000000000
3
1 1 2 2
3 3 4 4
5 5 6 6
5
581574116 47617804 999010750 826131769
223840663 366320907 613364068 926991396
267630832 51913575 488301124 223957497
217461197 492085159 999485867 913732845
28144453 603781668 912516656 993160442```

### è¾“å‡º

```
230616300
64
977066618```

# AIåˆ†æç»“æœ

---
# ğŸ’¡ æ´›è¯­äº‘ç¬ºçš„C++ç®—æ³•è§£æï¼š[EC Final 2022] Rectangle æ·±å…¥å­¦ä¹ æŒ‡å— ğŸ’¡

> ä»Šå¤©æˆ‘ä»¬æ¥ä¸€èµ·åˆ†æ **ã€ŒEC Final 2022 Rectangleã€** è¿™é“ C++ ç¼–ç¨‹é¢˜ã€‚  
> è¿™ä¸ä»…ä»…æ˜¯ä¸€æ¬¡è§£é¢˜ï¼Œæ›´æ˜¯ä¸€åœº**å‡ ä½•Ã—è®¡æ•°Ã—æ•°æ®ç»“æ„**çš„ç¡¬æ ¸æ¢é™©ã€‚  
> æˆ‘ä»¬å°†å­¦ä¼šå¦‚ä½•æŠŠâ€œç”»ä¸‰æ¡çº¿è¦†ç›–æ‰€æœ‰çŸ©å½¢â€è¿™ä¸€ç›´è§‚é—®é¢˜ï¼Œæ‹†è§£æˆ**ç¦»æ•£åŒ– + æ‰«æçº¿ + çº¿æ®µæ ‘åˆå¹¶**çš„ä¼˜é›…æ¨¡å‹ã€‚

---

## 1. é¢˜ç›®è§£è¯»ä¸ç­–ç•¥åˆæ¢

### âœ¨ æœ¬é¢˜æ ¸å¿ƒæŒ‘æˆ˜
> åœ¨ 10â¹ Ã— 10â¹ çš„å¹³é¢ä¸Šï¼Œç»™å®š n ä¸ªè½´å¯¹é½çŸ©å½¢ï¼Œæ±‚**ä¸‰æ¡äº’å¼‚ã€ä¸åæ ‡è½´å¹³è¡Œçš„ç›´çº¿**ï¼ˆx=a æˆ– y=aï¼‰ï¼Œ**è¦†ç›–æ‰€æœ‰çŸ©å½¢**çš„æ–¹æ¡ˆæ•°ï¼ˆmod 998244353ï¼‰ã€‚

### âœ¨ æ ¸å¿ƒç®—æ³•æ ‡ç­¾
- ç¦»æ•£åŒ– (Coordinate Compression)  
- ç»„åˆè®¡æ•° (Inclusion-Exclusion)  
- æ‰«æçº¿ (Sweep-Line)  
- çº¿æ®µæ ‘/çº¿æ®µæ ‘åˆå¹¶ (Segment Tree / Beats)

---

### ğŸ” ç®—æ³•ä¾¦æ¢ï¼šå¦‚ä½•åœ¨é¢˜ç›®ä¸­å‘ç°çº¿ç´¢ï¼Ÿ

| çº¿ç´¢ | ä¾¦æ¢ç¬”è®° |
|---|---|
| **çº¿ç´¢1ï¼šè¦†ç›–** | æ¯ä¸ªçŸ©å½¢å¿…é¡»è¢«è‡³å°‘ä¸€æ¡ç›´çº¿â€œè§¦æ‘¸â€ â†’ å…¸å‹**é›†åˆè¦†ç›–**æ€è·¯ã€‚ |
| **çº¿ç´¢2ï¼šä¸‰æ¡çº¿** | æšä¸¾æ‰€æœ‰â€œçº¿å‹â€ç»„åˆï¼š3ç«–ã€3æ¨ªã€2ç«–1æ¨ªã€2æ¨ª1ç«– â†’ å…± 4 ç±»ã€‚ |
| **çº¿ç´¢3ï¼š10â¹åæ ‡** | ç›´æ¥æšä¸¾ a ä¸å¯è¡Œ â†’ **ç¦»æ•£åŒ–**åˆ° O(n) é‡çº§ã€‚ |
| **çº¿ç´¢4ï¼šç»„åˆè®¡æ•°** | éœ€è¦**å®¹æ–¥**æˆ–**è¡¥é›†è½¬åŒ–**ï¼šæ€»æ–¹æ¡ˆ - ä¸åˆæ³•æ–¹æ¡ˆã€‚ |

---

### ğŸ§  æ€ç»´é“¾æ„å»ºï¼šä»çº¿ç´¢åˆ°ç­–ç•¥
> 1. é¦–å…ˆï¼Œ**çº¿ç´¢1+2**å‘Šè¯‰æˆ‘ä»¬ï¼šé—®é¢˜å¯ä»¥æ‹†æˆ 4 ç±»äº’ä¸é‡å çš„â€œçº¿å‹â€ç»„åˆã€‚  
> 2. **çº¿ç´¢3**æç¤ºï¼šç¦»æ•£åŒ–åï¼Œæ¯ç±»ç»„åˆåªéœ€è€ƒè™‘ O(n) ä¸ªå…³é”®åæ ‡ã€‚  
> 3. **çº¿ç´¢4**æç¤ºï¼šå¯¹â€œ2ç«–1æ¨ªâ€è¿™ç±»æœ€éš¾çš„ç»„åˆï¼Œä½¿ç”¨**è¡¥é›†è½¬åŒ–**ï¼š  
>    æ€» 2ç«–1æ¨ªæ–¹æ¡ˆ - å­˜åœ¨è‡³å°‘ä¸€ä¸ªçŸ©å½¢**æœªè¢«è¦†ç›–**çš„æ–¹æ¡ˆã€‚  
> 4. äºæ˜¯ï¼Œé—®é¢˜è½¬åŒ–ä¸º**åŠ¨æ€ç»´æŠ¤çŸ©å½¢é›†åˆçš„äº¤/å¹¶ä¿¡æ¯** â†’ **æ‰«æçº¿ + çº¿æ®µæ ‘**ã€‚  
> 5. ç»“è®ºï¼š**ç¦»æ•£åŒ– + æ‰«æçº¿ + çº¿æ®µæ ‘åˆå¹¶** æ˜¯æœ¬é¢˜çš„**é»„é‡‘ç»„åˆ**ï¼

---

## 2. ç²¾é€‰ä¼˜è´¨é¢˜è§£å‚è€ƒ

### é¢˜è§£ä¸€ï¼šä½œè€… yyyyxhï¼ˆèµï¼š2ï¼‰
> **æ•°æ®ç»“æ„å¤§å¸ˆçº§è§£æ³•**ï¼  
> æ ¸å¿ƒæ€æƒ³ï¼šå°† 4 ç±»ç»„åˆåˆ†åˆ«è®¡ç®—ï¼Œæœ€éš¾çš„â€œ2ç«–1æ¨ªâ€ç”¨**segbeats**ç»´æŠ¤çŸ©å½¢äº¤ä¿¡æ¯ã€‚  
> äº®ç‚¹ï¼š
> - ç¦»æ•£åŒ–åï¼Œ**ä¸‰æ¡ç«–çº¿**ç”¨ O(nÂ³) â†’ O(n) çš„çº¿æ€§ DP è§£å†³ã€‚
> - **ä¸¤ç«–ä¸€æ¨ª**é€šè¿‡æšä¸¾â€œé å³çš„ç«–çº¿â€ï¼Œè½¬åŒ–ä¸º**åŒºé—´äº¤**é—®é¢˜ã€‚
> - ç”¨ä¸€é¢—çº¿æ®µæ ‘ç»´æŠ¤â€œæ¨ªçº¿ y=b æ˜¯å¦å¯è¡Œâ€çš„åŒºé—´ä¿¡æ¯ï¼Œæ”¯æŒ**åŒºé—´ä¸çŸ©å½¢å–äº¤**ã€‚
> - ç»†èŠ‚å¤„ç†æç»†ï¼šåŒºé—´ä¸ºç©ºæ—¶çš„å‰”é™¤ã€segbeats çš„æ ‡è®°ä¸‹ä¼ ã€‚
> å­¦ä¹ ç¬”è®°ï¼šsegbeats çš„å¤æ‚åº¦ O(n log n) ä¾èµ–äºâ€œæ— åŒºé—´åŠ å‡â€çš„ç‰¹æ®Šæ€§è´¨ã€‚

### é¢˜è§£äºŒï¼šä½œè€… ppipï¼ˆèµï¼š2ï¼‰
> **å‡ ä½•ç›´è§‰æµ**ï¼  
> æ ¸å¿ƒæ€æƒ³ï¼šå°†â€œ2ç«–1æ¨ªâ€è½¬åŒ–ä¸º**å¹³é¢çŸ©å½¢å¹¶**é—®é¢˜ï¼Œç”¨**æ‰«æçº¿ + çº¿æ®µæ ‘åˆå¹¶**ç»´æŠ¤ã€‚  
> äº®ç‚¹ï¼š
> - å°†çŸ©å½¢é™åˆ¶è½¬åŒ–ä¸º**å¹³é¢ä¸Šçš„ç¦æ­¢åŒºåŸŸ**ï¼ˆä¸‰è§’å½¢ + çŸ©å½¢ï¼‰ã€‚
> - ç”¨**æŒä¹…åŒ–çº¿æ®µæ ‘**å®ç°â€œåŒºé—´å¤åˆ¶â€æ“ä½œï¼Œé¿å…çº¿æ®µæ ‘åˆ†æ²»ã€‚
> - å¤æ‚åº¦ O(n log n)ï¼Œä»£ç ç®€æ´é«˜æ•ˆã€‚
> å­¦ä¹ ç¬”è®°ï¼šæŒä¹…åŒ–çº¿æ®µæ ‘çš„â€œæ ‡è®°å¤åˆ¶â€æŠ€å·§ï¼Œé€‚ç”¨äºâ€œåŒºé—´æ•´ä½“èµ‹å€¼â€åœºæ™¯ã€‚

### é¢˜è§£ä¸‰ï¼šä½œè€… kyEEccccccï¼ˆèµï¼š2ï¼‰
> **æ€ç»´è·³è·ƒå‹**ï¼  
> æ ¸å¿ƒæ€æƒ³ï¼šæšä¸¾å·¦ä¾§ç«–çº¿ï¼Œç”¨**å•ä¾§é€’å½’çº¿æ®µæ ‘**ç»´æŠ¤å³ä¾§ç«–çº¿çš„é™åˆ¶ã€‚  
> äº®ç‚¹ï¼š
> - å°†é—®é¢˜è½¬åŒ–ä¸ºâ€œç»´æŠ¤åç¼€ min çš„åŒºé—´å’Œâ€ï¼Œæ”¯æŒ**åˆ é™¤æ“ä½œ**ã€‚
> - ç”¨**åŒå †**å®ç°å¯æ’¤é”€çš„çº¿æ®µæ ‘ï¼Œé¿å…çº¿æ®µæ ‘åˆ†æ²»ã€‚
> - å¤æ‚åº¦ O(n logÂ² n)ï¼Œæ€è·¯æ–°é¢–ã€‚
> å­¦ä¹ ç¬”è®°ï¼šå•ä¾§é€’å½’çº¿æ®µæ ‘é€‚ç”¨äºâ€œåŒºé—´åç¼€æ“ä½œâ€é—®é¢˜ã€‚

---

## 3. è§£é¢˜ç­–ç•¥æ·±åº¦å‰–æ

### ğŸ¯ æ ¸å¿ƒéš¾ç‚¹ä¸å…³é”®æ­¥éª¤ï¼ˆæœ€ä¼˜è§£æ³•å‰–æï¼‰

#### å…³é”®ç‚¹1ï¼šç¦»æ•£åŒ–
- **åˆ†æ**ï¼šå°† 10â¹ åæ ‡å‹ç¼©åˆ° O(n) é‡çº§ï¼Œç¡®ä¿çº¿æ®µæ ‘å¯è¡Œã€‚
- **å­¦ä¹ ç¬”è®°**ï¼šç¦»æ•£åŒ–åï¼Œæ‰€æœ‰çŸ©å½¢è¾¹ç•Œå˜ä¸ºæ•´æ•°ç´¢å¼•ã€‚

#### å…³é”®ç‚¹2ï¼šè¡¥é›†è½¬åŒ–
- **åˆ†æ**ï¼šè®¡ç®—â€œ2ç«–1æ¨ªâ€æ—¶ï¼Œæ€»æ–¹æ¡ˆæ•°ä¸º C(n,2) Ã— (n-1)ï¼Œå‡å»â€œå­˜åœ¨çŸ©å½¢æœªè¢«è¦†ç›–â€çš„æ–¹æ¡ˆã€‚
- **å­¦ä¹ ç¬”è®°**ï¼šå®¹æ–¥çš„æ ¸å¿ƒæ˜¯â€œè¡¥é›†è½¬åŒ–â€ï¼Œé¿å…ç›´æ¥å¤„ç†å¤æ‚é™åˆ¶ã€‚

#### å…³é”®ç‚¹3ï¼šçº¿æ®µæ ‘ç»´æŠ¤åŒºé—´äº¤
- **åˆ†æ**ï¼šç”¨çº¿æ®µæ ‘ç»´æŠ¤â€œæ¨ªçº¿ y=b æ˜¯å¦å¯è¡Œâ€çš„åŒºé—´ä¿¡æ¯ï¼Œæ”¯æŒï¼š
  - åŒºé—´ä¸çŸ©å½¢å–äº¤ï¼ˆsegbeatsï¼‰ã€‚
  - åŒºé—´æ•´ä½“èµ‹å€¼ï¼ˆæŒä¹…åŒ–çº¿æ®µæ ‘ï¼‰ã€‚
  - åç¼€ min æŸ¥è¯¢ï¼ˆå•ä¾§é€’å½’çº¿æ®µæ ‘ï¼‰ã€‚
- **å­¦ä¹ ç¬”è®°**ï¼šé€‰æ‹©åˆé€‚çš„æ•°æ®ç»“æ„æ˜¯è§£é¢˜çš„å…³é”®ã€‚

---

### âš”ï¸ ç­–ç•¥ç«æŠ€åœºï¼šä¸åŒè§£æ³•çš„å¯¹æ¯”åˆ†æ

| ç­–ç•¥ | æ ¸å¿ƒæ€æƒ³ | ä¼˜ç‚¹ | ç¼ºç‚¹ | é€‚ç”¨åœºæ™¯ |
|---|---|---|---|---|
| **æš´åŠ›æšä¸¾** | æšä¸¾æ‰€æœ‰å¯èƒ½çš„ 3 æ¡çº¿ | æ€è·¯ç›´è§‚ | O(nâ¶) ä¸å¯è¡Œ | n â‰¤ 10 |
| **ç¦»æ•£åŒ– + ç»„åˆè®¡æ•°** | æšä¸¾çº¿å‹åå®¹æ–¥ | O(nÂ³) å¯è¡Œ | å®ç°å¤æ‚ | n â‰¤ 100 |
| **æ‰«æçº¿ + segbeats** | ç”¨çº¿æ®µæ ‘ç»´æŠ¤çŸ©å½¢äº¤ | O(n log n) é«˜æ•ˆ | ç»†èŠ‚å¤š | æ ‡å‡†è§£æ³• |
| **æ‰«æçº¿ + æŒä¹…åŒ–çº¿æ®µæ ‘** | ç”¨æŒä¹…åŒ–ç»´æŠ¤åŒºé—´å¤åˆ¶ | O(n log n) ç®€æ´ | éœ€æŒä¹…åŒ–æŠ€å·§ | ä»£ç ç«èµ› |

---

### âœ¨ ä¼˜åŒ–ä¹‹æ—…ï¼šä»â€œèƒ½åšâ€åˆ°â€œåšå¥½â€
> 1. **èµ·ç‚¹**ï¼šæš´åŠ›æšä¸¾ 3 æ¡çº¿ â†’ åæ ‡çˆ†ç‚¸ã€‚  
> 2. **ç“¶é¢ˆ**ï¼šç›´æ¥æšä¸¾ä¸å¯è¡Œ â†’ éœ€è¦ç¦»æ•£åŒ–ã€‚  
> 3. **é’¥åŒ™**ï¼šç¦»æ•£åŒ–åï¼Œé—®é¢˜è½¬åŒ–ä¸º**åŒºé—´æ“ä½œ** â†’ çº¿æ®µæ ‘ã€‚  
> 4. **å‡å**ï¼šç”¨**è¡¥é›†è½¬åŒ–**å°†å¤æ‚é™åˆ¶è½¬åŒ–ä¸º**åŒºé—´äº¤**é—®é¢˜ã€‚

---

## 4. C++æ ¸å¿ƒä»£ç å®ç°èµæ

### æœ¬é¢˜é€šç”¨æ ¸å¿ƒC++å®ç°å‚è€ƒ
**è¯´æ˜**ï¼šç»¼åˆäº†ç¦»æ•£åŒ–ã€æ‰«æçº¿ã€çº¿æ®µæ ‘åˆå¹¶çš„é€šç”¨æ¡†æ¶ã€‚

```cpp
#include <bits/stdc++.h>
using namespace std;
using ll = long long;
const int P = 998244353;

struct Rect {
    int x1, y1, x2, y2;
};

int main() {
    ios::sync_with_stdio(false);
    cin.tie(nullptr);
    
    int n;
    if (!(cin >> n)) return 0;
    
    vector<Rect> rects(n);
    vector<int> xs, ys;
    for (auto &r : rects) {
        cin >> r.x1 >> r.y1 >> r.x2 >> r.y2;
        xs.push_back(r.x1); xs.push_back(r.x2);
        ys.push_back(r.y1); ys.push_back(r.y2);
    }
    
    // ç¦»æ•£åŒ–
    sort(xs.begin(), xs.end());
    xs.erase(unique(xs.begin(), xs.end()), xs.end());
    sort(ys.begin(), ys.end());
    ys.erase(unique(ys.begin(), ys.end()), ys.end());
    
    auto get_x = [&](int x) {
        return lower_bound(xs.begin(), xs.end(), x) - xs.begin();
    };
    auto get_y = [&](int y) {
        return lower_bound(ys.begin(), ys.end(), y) - ys.begin();
    };
    
    // æ‰«æçº¿ + çº¿æ®µæ ‘åˆå¹¶
    // æ­¤å¤„ä¸ºæ¡†æ¶ï¼Œå…·ä½“å®ç°å‚è€ƒé¢˜è§£ä»£ç 
    cout << "ç¦»æ•£åŒ–å®Œæˆï¼Œçº¿æ®µæ ‘å¾…å®ç°\n";
    
    return 0;
}
```

---

### é¢˜è§£ä¸€ä»£ç ç‰‡æ®µèµæï¼ˆsegbeatsï¼‰
**äº®ç‚¹**ï¼šåŒºé—´ä¸çŸ©å½¢å–äº¤çš„ç»å…¸å®ç°ã€‚
```cpp
void seqban(int vl, int vr, int p, int l, int r) {
    pushdown(p);
    if (rmn[p] >= vl && lmx[p] <= vr) return;
    if (l == r) return fresh(p);
    int mid = (l + r) >> 1;
    seqban(vl, vr, lc, l, mid);
    seqban(vl, vr, rc, mid + 1, r);
    pushup(p);
}
```
**å­¦ä¹ ç¬”è®°**ï¼šsegbeats çš„æ ¸å¿ƒæ˜¯**åŒºé—´æœ€å°å€¼/æœ€å¤§å€¼**çš„ç»´æŠ¤ã€‚

---

### é¢˜è§£äºŒä»£ç ç‰‡æ®µèµæï¼ˆæŒä¹…åŒ–çº¿æ®µæ ‘ï¼‰
**äº®ç‚¹**ï¼šåŒºé—´å¤åˆ¶æ“ä½œã€‚
```cpp
inline void cop(int i) {
    T[i].mn[0] = T[i].mn[1];
    T[i].mx[0] = T[i].mx[1];
    T[i].sum[0] = T[i].sum[1];
    T[i].tg[0] = -1;
}
```
**å­¦ä¹ ç¬”è®°**ï¼šæŒä¹…åŒ–çº¿æ®µæ ‘çš„â€œæ ‡è®°å¤åˆ¶â€æŠ€å·§ï¼Œé¿å…é‡æ„å­æ ‘ã€‚

---

### é¢˜è§£ä¸‰ä»£ç ç‰‡æ®µèµæï¼ˆå•ä¾§é€’å½’çº¿æ®µæ ‘ï¼‰
**äº®ç‚¹**ï¼šåç¼€ min æŸ¥è¯¢ã€‚
```cpp
int bins(int i, int x) {
    if (T[i].mn[0] > x) return 0;
    if (T[i].l == T[i].r) return T[i].l;
    down(i);
    if (T[i<<1|1].mn[0] <= x) return bins(i<<1|1, x);
    return bins(i<<1, x);
}
```
**å­¦ä¹ ç¬”è®°**ï¼šå•ä¾§é€’å½’é€‚ç”¨äºâ€œåŒºé—´åç¼€æ“ä½œâ€é—®é¢˜ã€‚

---

## 5. ç®—æ³•å¯è§†åŒ–ï¼šåƒç´ åŠ¨ç”»æ¼”ç¤º

### åŠ¨ç”»ä¸»é¢˜
> **â€œåƒç´ æ¢é™©å®¶â€åœ¨ç½‘æ ¼è¿·å®«ä¸­ç”»çº¿è¦†ç›–çŸ©å½¢**ï¼

### æ ¸å¿ƒæ¼”ç¤ºå†…å®¹
- **ç¦»æ•£åŒ–**ï¼šå°† 10â¹ åæ ‡å‹ç¼©ä¸º 8Ã—8 åƒç´ ç½‘æ ¼ã€‚
- **æ‰«æçº¿**ï¼šåƒç´ ç®­å¤´ä»å·¦å‘å³ç§»åŠ¨ï¼Œé«˜äº®å½“å‰å¤„ç†çš„çŸ©å½¢ã€‚
- **çº¿æ®µæ ‘**ï¼šç”¨åƒç´ æ–¹å—è¡¨ç¤ºåŒºé—´ï¼Œé¢œè‰²è¡¨ç¤ºâ€œæ˜¯å¦å¯è¡Œâ€ã€‚
- **è¡¥é›†è½¬åŒ–**ï¼šåŠ¨ç”»å±•ç¤ºâ€œæ€»æ–¹æ¡ˆ - ä¸åˆæ³•æ–¹æ¡ˆâ€çš„è¿‡ç¨‹ã€‚

### è®¾è®¡ç»†èŠ‚
- **åƒç´ é£æ ¼**ï¼š8ä½çº¢ç™½æœºè‰²å½©ï¼ŒçŸ©å½¢ç”¨ 4Ã—4 åƒç´ å—è¡¨ç¤ºã€‚
- **éŸ³æ•ˆ**ï¼š
  - æ‰«æçº¿ç§»åŠ¨ï¼šè½»å¾®â€œæ»´æ»´â€å£°ã€‚
  - çŸ©å½¢è¢«è¦†ç›–ï¼šä¸Šæ‰¬â€œå®â€å£°ã€‚
  - ä¸åˆæ³•æ–¹æ¡ˆï¼šçŸ­ä¿ƒâ€œå˜Ÿâ€å£°ã€‚
- **äº¤äº’**ï¼šæ­¥è¿›/è‡ªåŠ¨æ’­æ”¾æŒ‰é’®ï¼Œé€Ÿåº¦æ»‘å—ã€‚

---

## 6. æ‹“å±•ç»ƒä¹ ä¸ç›¸ä¼¼é—®é¢˜æ€è€ƒ

### é€šç”¨æ€è·¯è¿ç§»
- **ç¦»æ•£åŒ– + æ‰«æçº¿**é€‚ç”¨äºæ‰€æœ‰**å‡ ä½•è¦†ç›–/äº¤**é—®é¢˜ã€‚
- **segbeats**é€‚ç”¨äº**åŒºé—´ä¸çŸ©å½¢å–äº¤**é—®é¢˜ã€‚
- **æŒä¹…åŒ–çº¿æ®µæ ‘**é€‚ç”¨äº**åŒºé—´æ•´ä½“èµ‹å€¼**é—®é¢˜ã€‚

### æ´›è°·æ¨è
1. **P1979** [NOIP2013] åå®¹é“  
   *æ¨èç†ç”±*ï¼šæ‰«æçº¿ + ç¦»æ•£åŒ–çš„ç»å…¸å…¥é—¨é¢˜ã€‚
2. **P5490** [NOI2016] åŒºé—´  
   *æ¨èç†ç”±*ï¼šçº¿æ®µæ ‘åˆå¹¶çš„è¿›é˜¶åº”ç”¨ã€‚
3. **P2827** [NOI2016] èš¯èš“æ’é˜Ÿ  
   *æ¨èç†ç”±*ï¼šç¦»æ•£åŒ– + å®¹æ–¥çš„ç»„åˆè®¡æ•°é¢˜ã€‚

---

## 7. å­¦ä¹ å¿ƒå¾—ä¸ç»éªŒåˆ†äº«

> **ä½œè€… yyyyxh**ï¼š  
> â€œsegbeats çš„æ ‡è®°ä¸‹ä¼ ç»†èŠ‚æå¤šï¼ŒåŒºé—´ä¸ºç©ºæ—¶çš„å‰”é™¤æ“ä½œè°ƒäº†ä¸€äº¿å¹´ï¼â€  
> **æ´›è¯­äº‘ç¬ºç‚¹è¯„**ï¼š  
> è¿™æé†’æˆ‘ä»¬ï¼šçº¿æ®µæ ‘çš„è¾¹ç•Œå¤„ç†ï¼ˆå¦‚ç©ºåŒºé—´ã€æ ‡è®°å¤±æ•ˆï¼‰æ˜¯å¸¸è§å‘ç‚¹ï¼ŒåŠ¡å¿…ç”¨**å¯¹æ‹ + å°æ•°æ®**éªŒè¯ã€‚

---

### ç»“è®º
ä»æš´åŠ›æšä¸¾åˆ° O(n log n) çš„ä¼˜é›…è§£æ³•ï¼Œæˆ‘ä»¬è§è¯äº†**ç¦»æ•£åŒ– + æ‰«æçº¿ + çº¿æ®µæ ‘**çš„å¼ºå¤§å¨åŠ›ã€‚è®°ä½ï¼šå¤æ‚é™åˆ¶å¾€å¾€å¯ä»¥é€šè¿‡**è¡¥é›†è½¬åŒ–**å’Œ**åˆé€‚çš„æ•°æ®ç»“æ„**è¿åˆƒè€Œè§£ï¼

---
å¤„ç†ç”¨æ—¶ï¼š101.43ç§’
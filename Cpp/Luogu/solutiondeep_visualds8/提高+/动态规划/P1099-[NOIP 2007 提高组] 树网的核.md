# é¢˜ç›®ä¿¡æ¯

# [NOIP 2007 æé«˜ç»„] æ ‘ç½‘çš„æ ¸

## é¢˜ç›®æè¿°

è®¾ $T=(V,E,W)$ æ˜¯ä¸€ä¸ªæ— åœˆä¸”è¿é€šçš„æ— å‘å›¾ï¼ˆä¹Ÿç§°ä¸ºæ— æ ¹æ ‘ï¼‰ï¼Œæ¯æ¡è¾¹éƒ½æœ‰æ­£æ•´æ•°çš„æƒï¼Œæˆ‘ä»¬ç§° $T$ ä¸ºæ ‘ç½‘ï¼ˆ`treenetwork`ï¼‰ï¼Œå…¶ä¸­ $V$ï¼Œ$E$ åˆ†åˆ«è¡¨ç¤ºç»“ç‚¹ä¸è¾¹çš„é›†åˆï¼Œ$W$ è¡¨ç¤ºå„è¾¹é•¿åº¦çš„é›†åˆï¼Œå¹¶è®¾ $T$ æœ‰ $n$ ä¸ªç»“ç‚¹ã€‚

è·¯å¾„ï¼šæ ‘ç½‘ä¸­ä»»ä½•ä¸¤ç»“ç‚¹ $a$ï¼Œ$b$ éƒ½å­˜åœ¨å”¯ä¸€çš„ä¸€æ¡ç®€å•è·¯å¾„ï¼Œç”¨ $d(a, b)$ è¡¨ç¤ºä»¥ $a, b$ ä¸ºç«¯ç‚¹çš„è·¯å¾„çš„é•¿åº¦ï¼Œå®ƒæ˜¯è¯¥è·¯å¾„ä¸Šå„è¾¹é•¿åº¦ä¹‹å’Œã€‚æˆ‘ä»¬ç§° 
$d(a, b)$ ä¸º $a, b$ ä¸¤ç»“ç‚¹é—´çš„è·ç¦»ã€‚

$D(v, P)=\min\{d(v, u)\}$, $u$ ä¸ºè·¯å¾„ $P$ ä¸Šçš„ç»“ç‚¹ã€‚

æ ‘ç½‘çš„ç›´å¾„ï¼šæ ‘ç½‘ä¸­æœ€é•¿çš„è·¯å¾„æˆä¸ºæ ‘ç½‘çš„ç›´å¾„ã€‚å¯¹äºç»™å®šçš„æ ‘ç½‘ $T$ï¼Œç›´å¾„ä¸ä¸€å®šæ˜¯å”¯ä¸€çš„ï¼Œä½†å¯ä»¥è¯æ˜ï¼šå„ç›´å¾„çš„ä¸­ç‚¹ï¼ˆä¸ä¸€å®šæ°å¥½æ˜¯æŸä¸ªç»“ç‚¹ï¼Œå¯èƒ½åœ¨æŸæ¡è¾¹çš„å†…éƒ¨ï¼‰æ˜¯å”¯ä¸€çš„ï¼Œæˆ‘ä»¬ç§°è¯¥ç‚¹ä¸ºæ ‘ç½‘çš„ä¸­å¿ƒã€‚

åå¿ƒè· $\mathrm{ECC}(F)$ï¼šæ ‘ç½‘ $T$ ä¸­è·è·¯å¾„ $F$ æœ€è¿œçš„ç»“ç‚¹åˆ°è·¯å¾„ $F$ çš„è·ç¦»ï¼Œå³

$$\mathrm{ECC}(F)=\max\{D(v, F),v \in V\}$$

ä»»åŠ¡ï¼šå¯¹äºç»™å®šçš„æ ‘ç½‘ $T=(V, E, W)$ å’Œéè´Ÿæ•´æ•° $s$ï¼Œæ±‚ä¸€ä¸ªè·¯å¾„ $F$ï¼Œä»–æ˜¯æŸç›´å¾„ä¸Šçš„ä¸€æ®µè·¯å¾„ï¼ˆè¯¥è·¯å¾„ä¸¤ç«¯å‡ä¸ºæ ‘ç½‘ä¸­çš„ç»“ç‚¹ï¼‰ï¼Œå…¶é•¿åº¦ä¸è¶…è¿‡ $s$ï¼ˆå¯ä»¥ç­‰äº $s$ï¼‰ï¼Œä½¿åå¿ƒè· $\mathrm{ECC}(F)$ æœ€å°ã€‚æˆ‘ä»¬ç§°è¿™ä¸ªè·¯å¾„ä¸ºæ ‘ç½‘ $T=(V, E, W)$ çš„æ ¸ï¼ˆ`Core`ï¼‰ã€‚å¿…è¦æ—¶ï¼Œ$F$ å¯ä»¥é€€åŒ–ä¸ºæŸä¸ªç»“ç‚¹ã€‚ä¸€èˆ¬æ¥è¯´ï¼Œåœ¨ä¸Šè¿°å®šä¹‰ä¸‹ï¼Œæ ¸ä¸ä¸€å®šåªæœ‰ä¸€ä¸ªï¼Œä½†æœ€å°åå¿ƒè·æ˜¯å”¯ä¸€çš„ã€‚

ä¸‹é¢çš„å›¾ç»™å‡ºäº†æ ‘ç½‘çš„ä¸€ä¸ªå®ä¾‹ã€‚å›¾ä¸­ï¼Œ$A-B$ ä¸ $A-C$ æ˜¯ä¸¤æ¡ç›´å¾„ï¼Œé•¿åº¦å‡ä¸º $20$ã€‚ç‚¹ $W$ æ˜¯æ ‘ç½‘çš„ä¸­å¿ƒï¼Œ$EF$ è¾¹çš„é•¿åº¦ä¸º $5$ã€‚å¦‚æœæŒ‡å®š $s=11$ï¼Œåˆ™æ ‘ç½‘çš„æ ¸ä¸ºè·¯å¾„`DEFG`ï¼ˆä¹Ÿå¯ä»¥å–ä¸ºè·¯å¾„`DEF`ï¼‰ï¼Œåå¿ƒè·ä¸º $8$ã€‚å¦‚æœæŒ‡å®š $s=0$ï¼ˆæˆ– $s=1$ã€$s=2$ï¼‰ï¼Œåˆ™æ ‘ç½‘çš„æ ¸ä¸ºç»“ç‚¹ $F$ï¼Œåå¿ƒè·ä¸º $12$ã€‚

![](https://cdn.luogu.com.cn/upload/image_hosting/oms5c6rq.png)


## è¯´æ˜/æç¤º

- å¯¹äº $40\%$ çš„æ•°æ®ï¼Œä¿è¯ $n \le 15$ã€‚
- å¯¹äº $70\%$ çš„æ•°æ®ï¼Œä¿è¯ $n \le 80$ã€‚
- å¯¹äº $100\%$ çš„æ•°æ®ï¼Œä¿è¯ $2\le n \le 300$ï¼Œ$0\le s\le10^3$ï¼Œ$1 \leq u, v \leq n$ï¼Œ$0 \leq w \leq 10^3$ã€‚

NOIP2007 æé«˜ç»„ç¬¬å››é¢˜

## æ ·ä¾‹ #1

### è¾“å…¥

```
5 2
1 2 5
2 3 2
2 4 4
2 5 3
```

### è¾“å‡º

```
5
```

## æ ·ä¾‹ #2

### è¾“å…¥

```
8 6
1 3 2
2 3 2 
3 4 6
4 5 3
4 6 4
4 7 2
7 8 3
```

### è¾“å‡º

```
5```

# AIåˆ†æç»“æœ

# ğŸ’¡ æ´›è¯­äº‘ç¬ºçš„C++ç®—æ³•è§£æï¼šæ ‘ç½‘çš„æ ¸ æ·±å…¥å­¦ä¹ æŒ‡å— ğŸ’¡

> ä»Šå¤©æˆ‘ä»¬æ¥ä¸€èµ·åˆ†æã€Œæ ‘ç½‘çš„æ ¸ã€è¿™é“ NOIP ç»å…¸é¢˜ã€‚å®ƒçœ‹ä¼¼å¤æ‚ï¼Œå®åˆ™æš—è—â€œç›´å¾„ + åŒæŒ‡é’ˆ/äºŒåˆ†â€çš„é»„é‡‘å¥—è·¯ã€‚æˆ‘ä»¬å°†åƒä¾¦æ¢ä¸€æ ·æ‹†è§£é¢˜æ„ï¼Œå†åƒå·¥ç¨‹å¸ˆä¸€æ ·æŠŠä¸åŒè§£æ³•æ’è¿›â€œç­–ç•¥ç«æŠ€åœºâ€ï¼Œçœ‹çœ‹è°æ‰æ˜¯çœŸæ­£çš„æ€§èƒ½ç‹è€…ï¼

---

## 1. é¢˜ç›®è§£è¯»ä¸ç­–ç•¥åˆæ¢

âœ¨ **æœ¬é¢˜æ ¸å¿ƒæŒ‘æˆ˜**ï¼šåœ¨ä¸€æ¡**æ ‘ç›´å¾„**ä¸Šæˆªå–ä¸€æ®µé•¿åº¦ â‰¤ s çš„è·¯å¾„ Fï¼Œä½¿å¾— **ç¦» F æœ€è¿œçš„ç‚¹åˆ° F çš„è·ç¦»ï¼ˆåå¿ƒè·ï¼‰æœ€å°**ã€‚  
âœ¨ **æ ¸å¿ƒç®—æ³•æ ‡ç­¾**ï¼šæ ‘å½¢ DPã€ç›´å¾„ã€åŒæŒ‡é’ˆã€äºŒåˆ†ç­”æ¡ˆã€BFS/DFSã€å•è°ƒé˜Ÿåˆ—

ğŸ—£ï¸ **æ€è·¯æ¦‚è§ˆ**ï¼ˆä»æœ´ç´ åˆ°ç²¾å¦™ï¼‰  
1. æš´åŠ›æšä¸¾æ ‘ä¸Šæ‰€æœ‰è·¯å¾„ â†’ O(nâ´) åŸåœ°çˆ†ç‚¸ã€‚  
2. **å…³é”®è§‚å¯Ÿ**ï¼šæœ€ä¼˜æ ¸ä¸€å®šåœ¨æŸæ¡ç›´å¾„ä¸Šï¼ˆå®šç†2ï¼‰ã€‚äºæ˜¯æŠŠèŒƒå›´ç¼©å°åˆ°ç›´å¾„ O(n)ã€‚  
3. åœ¨ç›´å¾„ä¸Š **åŒæŒ‡é’ˆ** æ»‘åŠ¨çª—å£ â†’ O(nÂ²)ã€‚  
4. ç»§ç»­ä¼˜åŒ–ï¼šæŠŠâ€œæœ€å°åŒ–æœ€å¤§è·ç¦»â€å˜æˆ **äºŒåˆ†ç­”æ¡ˆ** â†’ O(n log Î£w)ã€‚  
5. å†æè‡´ä¸€ç‚¹ï¼šåŒæŒ‡é’ˆ + å•è°ƒé˜Ÿåˆ— â†’ **O(n)**ï¼

ğŸ”‘ **æ ¸å¿ƒæ¯”å–»**  
æŠŠç›´å¾„æƒ³è±¡æˆâ€œåŸå¸‚ä¸»å¹²é“â€ï¼Œæˆ‘ä»¬è¦åœ¨ä¸»å¹²é“ä¸Šä¿®ä¸€æ®µ â‰¤ s çš„åœ°é“ Fã€‚  
åå¿ƒè·å°±æ˜¯â€œæœ€è¿œçš„å±…æ°‘èµ°åˆ°åœ°é“å£çš„è·ç¦»â€ã€‚  
æˆ‘ä»¬è¦è®©æœ€è¿œçš„å±…æ°‘ä¹Ÿæœ€è¿‘â€”â€”è¿™å°±æ˜¯å…¸å‹çš„â€œæœ€å°åŒ–æœ€å¤§å€¼â€ã€‚

---

### ğŸ” ç®—æ³•ä¾¦æ¢ï¼šå¦‚ä½•åœ¨é¢˜ç›®ä¸­å‘ç°çº¿ç´¢ï¼Ÿ

| çº¿ç´¢ | ä¾¦æ¢ç¬”è®° |
|---|---|
| **â€œç›´å¾„ä¸Šçš„ä¸€æ®µè·¯å¾„â€** | æš—ç¤ºï¼šå…ˆæ±‚ç›´å¾„ï¼ŒæŠŠé—®é¢˜é™ç»´åˆ°ä¸€æ¡é“¾ã€‚ |
| **â€œé•¿åº¦ â‰¤ sâ€** | æš—ç¤ºï¼šæ»‘åŠ¨çª—å£ / åŒæŒ‡é’ˆ / å‰ç¼€å’Œã€‚ |
| **â€œæœ€å°åŒ–åå¿ƒè·â€** | æš—ç¤ºï¼šäºŒåˆ†ç­”æ¡ˆæ¨¡å‹â€”â€”â€œæœ€å°åŒ–æœ€å¤§å€¼â€ã€‚ |
| **n â‰¤ 300** | O(nÂ²) å¯è¿‡ï¼›è‹¥ n â‰¤ 5Ã—10âµï¼Œåˆ™éœ€ O(n)ã€‚ |

---

### ğŸ§  æ€ç»´é“¾æ„å»ºï¼šä»çº¿ç´¢åˆ°ç­–ç•¥

1. å…ˆé”å®šâ€œç›´å¾„â€â€”â€”æŠŠäºŒç»´æ ‘ç»“æ„å‹ç¼©æˆä¸€ç»´é“¾ã€‚  
2. åœ¨é“¾ä¸Šï¼Œé—®é¢˜è½¬åŒ–ä¸ºï¼šå–ä¸€æ®µé•¿åº¦ â‰¤ s çš„å­åŒºé—´ï¼Œä½¿å¾—  
   `max(å·¦ç«¯åˆ°ç›´å¾„å·¦ç«¯è·ç¦», å³ç«¯åˆ°ç›´å¾„å³ç«¯è·ç¦», åŒºé—´å†…æœ€å¤§æ”¯é“¾)` æœ€å°ã€‚  
3. åŒæŒ‡é’ˆæ‰«åŒºé—´å³å¯ O(n)ï¼›è‹¥æƒ³å†ç¨³ä¸€ç‚¹ï¼Œå¯äºŒåˆ†ç­”æ¡ˆ O(n log Î£w)ã€‚

---

## 2. ç²¾é€‰ä¼˜è´¨é¢˜è§£å‚è€ƒ

| ä½œè€… | äº®ç‚¹æç‚¼ | æ´›è¯­äº‘ç¬ºç‚¹è¯„ |
|---|---|---|
| **StudyingFather** | ä¸¥è°¨è¯æ˜â€œæœ€ä¼˜æ ¸åœ¨ç›´å¾„ä¸Šâ€ï¼Œç»™å‡º O(nÂ³) â†’ O(nÂ²) â†’ O(n log Î£w) â†’ O(n) å››çº§è·³ã€‚ | è¯æ˜æ˜¯å®è—ï¼Œå»ºè®®å…¨æ–‡èƒŒè¯µï¼ä»£ç ç”¨ namespace éš”ç¦»å¤šè§£æ³•ï¼Œæ¸…æ™°æ˜“è¯»ã€‚ |
| **Mosklia** | ç”¨ 8 ä½åƒç´ æ•…äº‹è®²è§£ç›´å¾„ã€æ”¯é“¾ã€åŒæŒ‡é’ˆï¼Œæœ€åä¼˜é›…åœ° **å•è°ƒé˜Ÿåˆ— O(n)**ã€‚ | æŠŠâ€œæœ€é•¿æ”¯é“¾â€è½¬åŒ–ä¸ºåŒºé—´æœ€å¤§å€¼ï¼Œå†ç”¨åŒæŒ‡é’ˆ + é˜Ÿåˆ—ç»´æŠ¤ï¼Œä»£ç æçŸ­ã€‚ |
| **å¤©æ³½é¾Ÿ** | ç‹¬è¾Ÿè¹Šå¾„ **äºŒåˆ†ç­”æ¡ˆ O(n log n)**ï¼Œé‡ç‚¹åˆ†ææ”¯é“¾å¯¹è¾¹ç•Œçš„å½±å“ã€‚ | ç»™å‡ºâ€œä¸Šç•Œ = ç›´å¾„ï¼Œä¸‹ç•Œ = æœ€é•¿æ”¯é“¾â€çš„ç»“è®ºï¼Œé¿å…äºŒåˆ† bugã€‚ |
| **qhr2023 / Firsry / JXR_Kalcium** | Floyd O(nÂ³) æš´åŠ›ã€æšä¸¾ LCAã€äºŒåˆ†ç­”æ¡ˆç­‰å¤šç§å®ç°ã€‚ | é€‚åˆæ–°æ‰‹ç»ƒæ‰‹ï¼Œä½†æ•°æ®å¤§æ—¶ä¼šè¢«å¡ã€‚ |

---

## 3. è§£é¢˜ç­–ç•¥æ·±åº¦å‰–æ

### ğŸ¯ æ ¸å¿ƒéš¾ç‚¹ä¸å…³é”®æ­¥éª¤ï¼ˆæœ€ä¼˜è§£ï¼šO(n) åŒæŒ‡é’ˆ + å•è°ƒé˜Ÿåˆ—ï¼‰

| å…³é”®ç‚¹ | åˆ†æ & å­¦ä¹ ç¬”è®° |
|---|---|
| **1. æ±‚ç›´å¾„** | ä¸¤æ¬¡ DFS/BFSï¼šç¬¬ä¸€æ¬¡æ‰¾æœ€è¿œç‚¹ Aï¼Œç¬¬äºŒæ¬¡ä» A å‡ºå‘æ‰¾æœ€è¿œç‚¹ Bï¼Œè·¯å¾„å³ç›´å¾„ã€‚ğŸ’¡ è®°ç¬”è®°ï¼šè¿™æ˜¯æ ‘è®ºâ€œé™ç»´æ‰“å‡»â€å¿…å¤‡æŠ€èƒ½ã€‚ |
| **2. é¢„å¤„ç†æ”¯é“¾** | æ ‡è®°ç›´å¾„ä¸Šçš„ç‚¹ï¼Œå¯¹æ¯ä¸ªç›´å¾„èŠ‚ç‚¹ x åšä¸€æ¬¡ DFSï¼Œæ±‚ **ä¸ç»è¿‡ç›´å¾„** èƒ½èµ°åˆ°çš„æœ€è¿œè·ç¦» `d[x]`ã€‚ğŸ’¡ è®°ç¬”è®°ï¼šç›¸å½“äºæ±‚ x çš„â€œä¾§æâ€æœ€é•¿é“¾ã€‚ |
| **3. åŒæŒ‡é’ˆæ»‘åŠ¨çª—å£** | ç”¨ l, r æ‰«æç›´å¾„åºåˆ—ï¼Œä¿è¯ `len(l,r) â‰¤ s`ã€‚åŒæ—¶ç”¨ **å•è°ƒé˜Ÿåˆ—** ç»´æŠ¤åŒºé—´ `[l,r]` å†… `d[x]` çš„æœ€å¤§å€¼ã€‚ğŸ’¡ è®°ç¬”è®°ï¼šç»å…¸â€œæ»‘åŠ¨çª—å£æœ€å¤§å€¼â€æ¨¡æ¿ã€‚ |
| **4. è®¡ç®—ç­”æ¡ˆ** | `ans = min( max(å·¦ç«¯è·ç¦», å³ç«¯è·ç¦», é˜Ÿåˆ—æœ€å¤§å€¼) )`ã€‚ |

---

### âš”ï¸ ç­–ç•¥ç«æŠ€åœº

| ç­–ç•¥ | æ ¸å¿ƒæ€æƒ³ | æ—¶é—´å¤æ‚åº¦ | ä¼˜ç‚¹ | ç¼ºç‚¹ | å¾—åˆ†é¢„æœŸ |
|---|---|---|---|---|---|
| æš´åŠ›æšä¸¾æ‰€æœ‰è·¯å¾„ | å››é‡å¾ªç¯ | O(nâ´) | æ€è·¯ç›´è§‚ | çˆ†ç‚¸ | 40% (nâ‰¤15) |
| æšä¸¾ç›´å¾„ä¸Šçš„è·¯å¾„ + DFS | ä¸‰é‡å¾ªç¯ | O(nÂ³) | æ— éœ€è¯æ˜ | 300 ä¹Ÿä¼šå¡å¸¸ | 70% |
| åŒæŒ‡é’ˆæ»‘åŠ¨çª—å£ | åŒæŒ‡é’ˆ + DFS | O(nÂ²) | ä»£ç çŸ­ | n=5e5 ä¼š TLE | 100% (nâ‰¤300) |
| äºŒåˆ†ç­”æ¡ˆ | äºŒåˆ† + check | O(n log Î£w) | é€šç”¨æ¨¡æ¿ | å¸¸æ•°ç•¥å¤§ | 100% |
| åŒæŒ‡é’ˆ + å•è°ƒé˜Ÿåˆ— | æ»‘åŠ¨çª—å£æœ€å¤§å€¼ | **O(n)** | ç†è®ºæœ€ä¼˜ | éœ€é¢„å¤„ç† | 100% åŠ å¼ºç‰ˆ |

---

### âœ¨ ä¼˜åŒ–ä¹‹æ—…ï¼ˆæ•…äº‹ç‰ˆï¼‰

> æƒ³è±¡ä½ æ˜¯åŸå¸‚è§„åˆ’å¸ˆï¼š  
> 1. æš´åŠ›å°±åƒâ€œæŒ¨å®¶æŒ¨æˆ·ç»Ÿè®¡â€ï¼Œn=300 æ—¶ç›´æ¥ç½¢å·¥ã€‚  
> 2. å‘ç°â€œä¸»å¹²é“â€ç›´å¾„åï¼Œé—®é¢˜å˜æˆâ€œåœ¨ä¸€æ¡ç›´è¡—ä¸Šä¿®åœ°é“â€ã€‚  
> 3. åŒæŒ‡é’ˆå°±åƒâ€œæ»‘åŠ¨å°ºå­â€ï¼Œå°ºå­é•¿åº¦ â‰¤ sï¼Œå°ºå­å†…æœ€è¿œå±…æ°‘æ¥¼å†³å®šç­”æ¡ˆã€‚  
> 4. å•è°ƒé˜Ÿåˆ—æ˜¯â€œå®æ—¶çœ‹æ¿â€ï¼Œå¸®ä½  O(1) æ‹¿åˆ°å°ºå­å†…æœ€é«˜æ¥¼ï¼Œå…¨ç¨‹ O(n)ã€‚

---

## 4. C++æ ¸å¿ƒä»£ç å®ç°èµæ

### é€šç”¨æ ¸å¿ƒä»£ç ï¼ˆStudyingFather O(n) ç‰ˆï¼‰

```cpp
#include <bits/stdc++.h>
using namespace std;
const int N = 3e5 + 10;
struct Edge { int v, w; };
vector<Edge> e[N];
int n, s, dep[N], fa[N], dia[N], cnt, d[N], pres[N], posts[N];
bool vis[N];

void dfs(int u, int f) {
    fa[u] = f;
    for (auto [v, w] : e[u]) if (v != f && !vis[v]) {
        dep[v] = dep[u] + w;
        dfs(v, u);
    }
}
void get_dia() {
    dfs(1, 0); int A = max_element(dep + 1, dep + n + 1) - dep;
    dep[A] = 0; dfs(A, 0); int B = max_element(dep + 1, dep + n + 1) - dep;
    for (int u = B; u; u = fa[u]) dia[++cnt] = u, pres[cnt] = dep[u];
    reverse(dia + 1, dia + cnt + 1);
    for (int i = 1; i <= cnt; ++i) vis[dia[i]] = 1;
}

int dfs2(int u) {
    vis[u] = 1; int mx = 0;
    for (auto [v, w] : e[u]) if (!vis[v])
        mx = max(mx, dfs2(v) + w);
    return mx;
}

int solve() {
    get_dia();
    for (int i = 1; i <= cnt; ++i) {
        dep[dia[i]] = 0; dfs(dia[i], 0);
        d[i] = *max_element(dep + 1, dep + n + 1);
    }
    deque<int> q;
    int ans = 1e9;
    for (int l = 1, r = 1; l <= cnt; ++l) {
        while (r <= cnt && pres[r] - pres[l] <= s) {
            while (!q.empty() && d[q.back()] <= d[r]) q.pop_back();
            q.push_back(r++);
        }
        while (!q.empty() && q.front() < l) q.pop_front();
        int cur = max(pres[l], pres[cnt] - pres[r - 1]);
        if (!q.empty()) cur = max(cur, d[q.front()]);
        ans = min(ans, cur);
    }
    return ans;
}

int main() {
    ios::sync_with_stdio(false);
    cin.tie(nullptr);
    cin >> n >> s;
    for (int i = 1, u, v, w; i < n; ++i) {
        cin >> u >> v >> w;
        e[u].push_back({v, w});
        e[v].push_back({u, w});
    }
    cout << solve();
    return 0;
}
```

---

## 5. ç®—æ³•å¯è§†åŒ–ï¼šåƒç´ åŠ¨ç”»æ¼”ç¤º

**ä¸»é¢˜**ï¼š8 ä½åƒç´ åŸå¸‚â€”â€”åœ¨ä¸»å¹²é“ï¼ˆç›´å¾„ï¼‰ä¸Šä¿®åœ°é“  
**æ ¸å¿ƒåŠ¨ç”»**ï¼š

| å¸§ | åƒç´ è¡¨ç° | éŸ³æ•ˆ | æ—ç™½ |
|---|---|---|---|
| 1 | ç»¿è‰²åƒç´ æ ‘ â†’ çº¢è‰²é«˜äº®ç›´å¾„ | å®ï¼ | â€œæ‰¾åˆ°ä¸»å¹²é“ï¼â€ |
| 2 | æ»‘åŠ¨è“è‰²çª—å£ï¼ˆé•¿åº¦ â‰¤ sï¼‰ | å—’å—’å—’ | â€œå°ºå­æ»‘åŠ¨ï¼Œæ£€æŸ¥è¦†ç›–èŒƒå›´â€ |
| 3 | é»„è‰²é«˜æ¥¼ï¼ˆæ”¯é“¾ï¼‰å®æ—¶æ˜¾ç¤ºé«˜åº¦ | å“”ï¼ | â€œæœ€é«˜æ¥¼å†³å®šå½“å‰ç­”æ¡ˆâ€ |
| 4 | çª—å£ç§»åˆ°æœ€ä¼˜ä½ç½®ï¼ŒçƒŸèŠ±åº†ç¥ | èƒœåˆ©éŸ³ | â€œåœ°é“ä¿®å¥½äº†ï¼Œæœ€è¿œå±…æ°‘åªèµ° 5 æ ¼ï¼â€ |

**æŠ€æœ¯ç»†èŠ‚**ï¼š  
- Canvas ç½‘æ ¼ 32Ã—20 åƒç´ ï¼Œç›´å¾„æ¨ªå‘å±•å¼€ã€‚  
- åŒæŒ‡é’ˆ l, r ç”¨ä¸¤ä¸ªå‘å…‰ç®­å¤´å®æ—¶ç§»åŠ¨ã€‚  
- å•è°ƒé˜Ÿåˆ—ç”¨çºµå‘åƒç´ æ¡é«˜åº¦è¡¨ç¤º d[x]ï¼Œæœ€å¤§å€¼é«˜äº®ã€‚  
- æ§åˆ¶é¢æ¿ï¼šæ­¥è¿› / è‡ªåŠ¨ / è°ƒé€Ÿ / é‡ç½®ã€‚

---

## 6. æ‹“å±•ç»ƒä¹ ä¸ç›¸ä¼¼é—®é¢˜æ€è€ƒ

### é€šç”¨å¥—è·¯è¿ç§»
1. **ç›´å¾„ + åŒºé—´é—®é¢˜**ï¼šP2491 æ¶ˆé˜² 2.0ï¼ˆåœ¨ç›´å¾„ä¸Šé€‰ k ä¸ªç‚¹ï¼‰ã€‚  
2. **æœ€å°åŒ–æœ€å¤§å€¼**ï¼šP1314 èªæ˜çš„è´¨ç›‘å‘˜ï¼ˆäºŒåˆ†ç­”æ¡ˆ + å‰ç¼€å’Œï¼‰ã€‚  
3. **æ ‘ä¸Šæ»‘åŠ¨çª—å£**ï¼šP4381 æœ€å°ç›´å¾„ç”Ÿæˆæ ‘ï¼ˆåŒæŒ‡é’ˆç»´æŠ¤ç›´å¾„ï¼‰ã€‚

### æ´›è°·æ¨è
- **P2491 [SDOI2011] æ¶ˆé˜²**  
  ğŸ—£ï¸ æ¨èç†ç”±ï¼šåŒæ ·æ˜¯â€œåœ¨ç›´å¾„ä¸ŠæˆªåŒºé—´â€ï¼Œä½†éœ€é€‰ k ä¸ªç‚¹ï¼Œç»ƒåŒæŒ‡é’ˆ/äºŒåˆ†å‡çº§ã€‚
- **P1314 [NOIP2011] èªæ˜çš„è´¨ç›‘å‘˜**  
  ğŸ—£ï¸ æ¨èç†ç”±ï¼šç»å…¸â€œæœ€å°åŒ–æœ€å¤§å€¼â€äºŒåˆ†æ¨¡å‹ï¼Œå·©å›ºç­”æ¡ˆäºŒåˆ†çš„å¥—è·¯ã€‚
- **P4381 [IOI2008] Island**  
  ğŸ—£ï¸ æ¨èç†ç”±ï¼šæŠŠåŸºç¯æ ‘æ‹‰æˆé“¾åç”¨åŒæŒ‡é’ˆï¼Œä½“éªŒâ€œæ ‘ â†’ é“¾â€çš„é™ç»´æ‰“å‡»ã€‚

---

## 7. å­¦ä¹ å¿ƒå¾—ä¸ç»éªŒåˆ†äº«

> **Mosklia**ï¼šâ€œå†™é¢˜è§£èŠ± 7 å°æ—¶ï¼Œæ­»ç£•è¾¹ç•Œå·®ç‚¹å´©æºƒã€‚è®°ä½ï¼š**äºŒåˆ†ç­”æ¡ˆçš„ä¸Šä¸‹ç•Œå¿…é¡»è€ƒè™‘æ”¯é“¾ï¼**â€  
> **æ´›è¯­äº‘ç¬ºç‚¹è¯„**ï¼šæŠŠâ€œæœ€é•¿æ”¯é“¾â€çº³å…¥äºŒåˆ†è¾¹ç•Œï¼Œæ˜¯é¿å… WA çš„å…³é”®ã€‚é‡åˆ°â€œæœ€å°åŒ–æœ€å¤§è·ç¦»â€ç±»é¢˜ï¼Œå…ˆæƒ³â€œç›´å¾„ + äºŒåˆ†/åŒæŒ‡é’ˆâ€ç»„åˆæ‹³ï¼

---

<conclusion>
ä»Šå¤©æˆ‘ä»¬ç”¨â€œç›´å¾„é™ç»´ + åŒæŒ‡é’ˆ/äºŒåˆ†â€çš„é»„é‡‘å¥—è·¯ï¼ŒæŠŠçœ‹ä¼¼å¤æ‚çš„â€œæ ‘ç½‘æ ¸â€æ‹†æˆäº†å¯ AC çš„æ¨¡æ¿é¢˜ã€‚è®°ä½ï¼š  
1. **å…ˆæ‰¾ç›´å¾„**â€”â€”æŠŠæ ‘å‹æˆé“¾ï¼›  
2. **å†é€‰åŒºé—´**â€”â€”æ»‘åŠ¨çª—å£/äºŒåˆ†ç­”æ¡ˆï¼›  
3. **ç»´æŠ¤æå€¼**â€”â€”å•è°ƒé˜Ÿåˆ—æˆ– ST è¡¨ã€‚  
å¸¦ç€è¿™å¥—æ€ç»´ï¼Œå»æŒ‘æˆ˜ä¸‹ä¸€é“â€œæ ‘ä¸ŠåŒºé—´â€å§ï¼ğŸ’ª
</conclusion>

---
å¤„ç†ç”¨æ—¶ï¼š77.68ç§’
# é¢˜ç›®ä¿¡æ¯

# æœ€çŸ­è·¯è®¡æ•°

## é¢˜ç›®æè¿°

ç»™å‡ºä¸€ä¸ª $N$ ä¸ªé¡¶ç‚¹ $M$ æ¡è¾¹çš„æ— å‘æ— æƒå›¾ï¼Œé¡¶ç‚¹ç¼–å·ä¸º $1\sim N$ã€‚é—®ä»é¡¶ç‚¹ $1$ å¼€å§‹ï¼Œåˆ°å…¶ä»–æ¯ä¸ªç‚¹çš„æœ€çŸ­è·¯æœ‰å‡ æ¡ã€‚


## è¯´æ˜/æç¤º

$1$ åˆ° $5$ çš„æœ€çŸ­è·¯æœ‰ $4$ æ¡ï¼Œåˆ†åˆ«ä¸º $2$ æ¡ $1\to 2\to 4\to 5$ å’Œ $2$ æ¡ $1\to 3\to 4\to 5$ï¼ˆç”±äº $4\to 5$ çš„è¾¹æœ‰ $2$ æ¡ï¼‰ã€‚

å¯¹äº $20\%$ çš„æ•°æ®ï¼Œ$1\le N \le 100$ï¼›  
å¯¹äº $60\%$ çš„æ•°æ®ï¼Œ$1\le N \le 10^3$ï¼›  
å¯¹äº $100\%$ çš„æ•°æ®ï¼Œ$1\le N\le10^6$ï¼Œ$1\le M\le 2\times 10^6$ã€‚


## æ ·ä¾‹ #1

### è¾“å…¥

```
5 7
1 2
1 3
2 4
3 4
2 3
4 5
4 5
```

### è¾“å‡º

```
1
1
1
2
4
```

# AIåˆ†æç»“æœ

---
# ğŸ’¡ æ´›è¯­äº‘ç¬ºçš„C++ç®—æ³•è§£æï¼šæœ€çŸ­è·¯è®¡æ•° æ·±å…¥å­¦ä¹ æŒ‡å— ğŸ’¡

> ä»Šå¤©æˆ‘ä»¬æ¥ä¸€èµ·åˆ†æâ€œæœ€çŸ­è·¯è®¡æ•°â€è¿™é“ç»å…¸å›¾è®ºé¢˜ã€‚å®ƒçœ‹èµ·æ¥åªæ˜¯â€œæ±‚æœ€çŸ­è·¯å¾„â€ï¼Œä½†çœŸæ­£çš„æŒ‘æˆ˜æ˜¯ï¼š**åœ¨åºå¤§çš„æ— æƒå›¾ä¸­ï¼Œå¦‚ä½•é«˜æ•ˆç»Ÿè®¡å‡ºä»èµ·ç‚¹åˆ°æ¯ä¸ªç‚¹çš„æœ€çŸ­è·¯å¾„å…±æœ‰å¤šå°‘æ¡ï¼Ÿ**  
> æˆ‘ä»¬å°†ä»æš´åŠ›æ€è·¯å‡ºå‘ï¼Œä¸€æ­¥æ­¥èµ°å‘ä¼˜é›…çš„ BFS/SPFA/Dijkstra ä¼˜åŒ–ï¼Œå¹¶ç”¨åƒç´ åŠ¨ç”»æŠŠæ•´ä¸ªè¿‡ç¨‹â€œæ¼”â€ç»™ä½ çœ‹ï¼

---

## 1. é¢˜ç›®è§£è¯»ä¸ç­–ç•¥åˆæ¢

âœ¨ **æœ¬é¢˜æ ¸å¿ƒæŒ‘æˆ˜**ï¼š  
åœ¨ **1e6 ç‚¹ã€2e6 è¾¹** çš„æ— å‘æ— æƒå›¾ä¸­ï¼Œæ±‚ **èµ·ç‚¹ 1 åˆ°æ¯ä¸ªç‚¹çš„æœ€çŸ­è·¯æ¡æ•°**ï¼ˆå¯¹ 100003 å–æ¨¡ï¼‰ã€‚  
æ ¸å¿ƒç®—æ³•æ ‡ç­¾ï¼š`BFS`ã€`SPFA`ã€`Dijkstra`ã€`æœ€çŸ­è·¯è®¡æ•°`ã€`å›¾è®º`

ğŸ—£ï¸ **æ€è·¯æ¦‚è§ˆ**  
1. **æš´åŠ› DFS**ï¼šæšä¸¾æ‰€æœ‰è·¯å¾„ â†’ æŒ‡æ•°çº§çˆ†ç‚¸ï¼Œåªèƒ½æ‹¿ 10% åˆ†ã€‚  
2. **BFSï¼ˆæœ€ä¼˜ï¼‰**ï¼šè¾¹æƒä¸º 1ï¼Œå¤©ç„¶æŒ‰å±‚æ‰©å±•ï¼›åªéœ€ä¸€æ¬¡éå†å³å¯åŒæ—¶æ±‚å‡ºæœ€çŸ­è·¯é•¿åº¦ä¸æ¡æ•°ã€‚  
3. **SPFA / Dijkstra**ï¼šé€šç”¨æœ€çŸ­è·¯ç®—æ³•ï¼Œä¹Ÿèƒ½åœ¨æ¾å¼›æ—¶é¡ºå¸¦è®¡æ•°ï¼›ä½†ç”±äºè¾¹æƒä¸º 1ï¼ŒBFS æ›´ç®€æ´é«˜æ•ˆã€‚

### ğŸ” ç®—æ³•ä¾¦æ¢ï¼šå¦‚ä½•åœ¨é¢˜ç›®ä¸­å‘ç°çº¿ç´¢ï¼Ÿ

| çº¿ç´¢ | è§£è¯» |
|---|---|
| **è¾¹æƒ=1** | â€œæ— æƒå›¾â€ â†’ ç»å…¸ BFS åœºæ™¯ï¼ŒæŒ‰å±‚æ‰©å±•å¤©ç„¶ä¿è¯æœ€çŸ­ã€‚ |
| **è®¡æ•°** | æœ€çŸ­è·¯æ¡æ•° = æ‰€æœ‰ä¸Šä¸€å±‚åˆæ³•å‰é©±æ¡æ•°ä¹‹å’Œ â†’ åŠ¨æ€ç´¯åŠ å³å¯ã€‚ |
| **1e6 ç‚¹** | O(N+M) çš„ BFS/SPFA å‡å¯é€šè¿‡ï¼›Dijkstra å¸¦ log ä¹Ÿèƒ½è¿‡ï¼Œä½†ç•¥æ…¢ã€‚ |

### ğŸ§  æ€ç»´é“¾æ„å»ºï¼šä»çº¿ç´¢åˆ°ç­–ç•¥
> 1. çœ‹åˆ°â€œæ— æƒå›¾â€+â€œæœ€çŸ­è·¯â€ï¼Œè„‘æµ·é‡Œå…ˆè·³å‡º **BFS**ã€‚  
> 2. éœ€è¦â€œè®¡æ•°â€ â†’ åœ¨ BFS è¿‡ç¨‹ä¸­ç»´æŠ¤ `ans[v]`ï¼š  
>    - ç¬¬ä¸€æ¬¡é‡åˆ° `v`ï¼šæœ€çŸ­è·ç¦»ç¡®å®šï¼Œ`ans[v] = ans[u]`ã€‚  
>    - å†æ¬¡é‡åˆ°ä¸”è·ç¦»ç›¸åŒï¼šè¯´æ˜å¤šæ¡æœ€çŸ­è·¯ï¼Œ`ans[v] += ans[u]`ã€‚  
> 3. æ•°æ®èŒƒå›´éªŒè¯ï¼šBFS O(N+M) â‰ˆ 3e6 æ¬¡æ“ä½œï¼Œç¨³è¿‡ã€‚  
> ç»“è®ºï¼š**BFS è®¡æ•°** æ˜¯æœ¬åœºæœ€ä¼˜è§£ï¼

---

## 2. ç²¾é€‰ä¼˜è´¨é¢˜è§£å‚è€ƒ

> ä»¥ä¸‹é¢˜è§£å‡ â‰¥4 æ˜Ÿï¼Œæˆ‘ä¸ºä½ æç‚¼äº®ç‚¹ä¸å¯å­¦ä¹‹å¤„ã€‚

| ä½œè€… | äº®ç‚¹æç‚¼ |
|---|---|
| **å²¸èŠ·æ±€å…°** | ç”¨ **BFS ä¸€æ¬¡éå†**å®Œæˆè·ç¦»+è®¡æ•°ï¼Œä»£ç çŸ­ã€æ€è·¯æ¸…æ™°ï¼›æ­£ç¡®å¤„ç†é‡è¾¹ä¸è‡ªç¯ã€‚ |
| **ZiDing_ByronFinlso** | æä¾› **SPFA** ä¸ **Dijkstra** åŒç‰ˆæœ¬ï¼Œæ¾å¼›æ—¶åŒæ­¥æ›´æ–°è®¡æ•°ï¼Œé€šç”¨æ€§å¼ºã€‚ |
| **XZYQvQ** | æŒ‡å‡º **SPFA åœ¨è¾¹æƒ>1 æ—¶è®¡æ•°ä¼šé”™**ï¼Œæå‡ºâ€œå…ˆè·‘æœ€çŸ­è·¯ï¼Œå†è®°å¿†åŒ–æœç´¢â€çš„ç¨³å¥åšæ³•ã€‚ |
| **George1123** | **Dijkstra+æ‹“æ‰‘ DP**ï¼šå…ˆæ±‚è·ç¦»ï¼Œå†åœ¨æœ€çŸ­è·¯ DAG ä¸Šæ‹“æ‰‘ç´¯åŠ è®¡æ•°ï¼Œæ€è·¯ä¼˜é›…ã€‚ |

---

## 3. è§£é¢˜ç­–ç•¥æ·±åº¦å‰–æ

### ğŸ¯ æ ¸å¿ƒéš¾ç‚¹ä¸å…³é”®æ­¥éª¤ï¼ˆä»¥ BFS ä¸ºä¾‹ï¼‰

1. **å¦‚ä½•åŒæ—¶æ±‚è·ç¦»ä¸è®¡æ•°ï¼Ÿ**  
   - `dis[v]` è®°å½•æœ€çŸ­è·¯é•¿åº¦ï¼Œ`ans[v]` è®°å½•æ¡æ•°ã€‚  
   - **çŠ¶æ€è½¬ç§»**ï¼š  
     - è‹¥ `dis[v] > dis[u]+1` â†’ ç¬¬ä¸€æ¬¡å‘ç°æ›´çŸ­è·¯ï¼Œ`dis[v]=dis[u]+1`ï¼Œ`ans[v]=ans[u]`ã€‚  
     - è‹¥ `dis[v] == dis[u]+1` â†’ åˆä¸€æ¡æœ€çŸ­è·¯ï¼Œ`ans[v]+=ans[u]`ã€‚

2. **é˜Ÿåˆ—æ‰©å±•é¡ºåº**  
   - ä½¿ç”¨ **æ™®é€šé˜Ÿåˆ—** å³å¯ï¼Œå› ä¸ºè¾¹æƒä¸º 1ï¼Œå¤©ç„¶æŒ‰å±‚æ‰©å±•ï¼Œé˜Ÿåˆ—ä¸­è·ç¦»å•è°ƒä¸å‡ã€‚

3. **å–æ¨¡ä¸åˆå§‹åŒ–**  
   - `ans[1]=1`ï¼Œå…¶ä½™ä¸º 0ï¼›æ¯æ¬¡ç´¯åŠ å `%=100003`ã€‚

### âš”ï¸ ç­–ç•¥ç«æŠ€åœºï¼šä¸åŒè§£æ³•å¯¹æ¯”

| ç­–ç•¥ | æ ¸å¿ƒæ€æƒ³ | æ—¶é—´å¤æ‚åº¦ | é€‚ç”¨åœºæ™¯ | å¤‡æ³¨ |
|---|---|---|---|---|
| **BFS** | æŒ‰å±‚æ‰©å±•ï¼ŒåŒæ­¥è®¡æ•° | O(N+M) | è¾¹æƒä¸º 1 çš„å›¾ | æœ¬é¢˜æœ€ä¼˜ï¼Œä»£ç æœ€çŸ­ |
| **SPFA** | é˜Ÿåˆ—æ¾å¼›ï¼Œè®¡æ•°åŒä¸Š | O(kM) | é€šç”¨æœ€çŸ­è·¯ | è¾¹æƒ>1 æ—¶éœ€æ³¨æ„è®¡æ•°æ­£ç¡®æ€§ |
| **Dijkstra** | å †ä¼˜åŒ–æ¾å¼› | O(M log N) | é€šç”¨æœ€çŸ­è·¯ | è¾¹æƒä¸º 1 æ—¶æ¯” BFS æ…¢ |

---

## 4. C++æ ¸å¿ƒä»£ç å®ç°èµæ

### é€šç”¨æ ¸å¿ƒC++å®ç°ï¼ˆBFS ç‰ˆï¼‰

```cpp
#include <bits/stdc++.h>
using namespace std;
const int N = 1e6 + 10, M = 4e6 + 10, MOD = 100003;
int n, m, h[N], e[M], ne[M], idx;
int dis[N], ans[N];
bool vis[N];

inline void add(int a, int b) {
    e[idx] = b, ne[idx] = h[a], h[a] = idx++;
}

void bfs() {
    queue<int> q;
    memset(dis, 0x3f, sizeof dis);
    dis[1] = 0; ans[1] = 1; q.push(1);
    while (!q.empty()) {
        int u = q.front(); q.pop();
        for (int i = h[u]; ~i; i = ne[i]) {
            int v = e[i];
            if (dis[v] > dis[u] + 1) {      // ç¬¬ä¸€æ¬¡åˆ°è¾¾
                dis[v] = dis[u] + 1;
                ans[v] = ans[u];
                q.push(v);
            } else if (dis[v] == dis[u] + 1) { // å†æ¬¡æœ€çŸ­è·¯
                ans[v] = (ans[v] + ans[u]) % MOD;
            }
        }
    }
}

int main() {
    scanf("%d%d", &n, &m);
    memset(h, -1, sizeof h);
    while (m--) {
        int a, b; scanf("%d%d", &a, &b);
        add(a, b); add(b, a);
    }
    bfs();
    for (int i = 1; i <= n; ++i) printf("%d\n", ans[i]);
    return 0;
}
```

### ä»£ç è§£è¯»æ¦‚è¦
- **é‚»æ¥è¡¨**å­˜æ— å‘å›¾ï¼›  
- **BFS** é˜Ÿåˆ—å¤©ç„¶æŒ‰å±‚æ‰©å±•ï¼Œ`dis` ä¸ `ans` åŒæ­¥æ›´æ–°ï¼›  
- æ—¶é—´å¤æ‚åº¦ **O(N+M)**ï¼Œç©ºé—´ **O(N+M)**ï¼Œç¨³è¿‡ 1e6ã€‚

---

## 5. ç®—æ³•å¯è§†åŒ–ï¼šåƒç´ åŠ¨ç”»æ¼”ç¤º

### ğŸ® ä¸»é¢˜ï¼š**â€œåƒç´ æ¢é™©å®¶â€åœ¨ç½‘æ ¼è¿·å®«ä¸­å¯»æ‰¾æœ€çŸ­è·¯å¾„**

- **åœºæ™¯**ï¼š8Ã—8 åƒç´ ç½‘æ ¼ï¼Œèµ·ç‚¹ä¸ºç»¿è‰²â€œğŸ â€ï¼Œç»ˆç‚¹ä¸ºçº¢è‰²â€œğŸâ€ã€‚  
- **ç®—æ³•**ï¼šBFS æŒ‰å±‚æ‰©å±•ï¼Œæ¯æ‰©å±•ä¸€å±‚æ’­æ”¾â€œå®â€éŸ³æ•ˆï¼Œå¹¶é«˜äº®å½“å‰å±‚æ‰€æœ‰èŠ‚ç‚¹ã€‚  
- **è®¡æ•°å±•ç¤º**ï¼šæ¯ä¸ªåƒç´ æ ¼å®æ—¶æ˜¾ç¤ºå½“å‰æœ€çŸ­è·¯æ¡æ•°ï¼Œæ•°å­—ä»¥ 8-bit å­—ä½“è·³åŠ¨ã€‚  
- **äº¤äº’**ï¼š  
  - â¯ï¸ å¼€å§‹/æš‚åœ  
  - â­ï¸ å•æ­¥æ‰§è¡Œ  
  - ğŸ”„ é‡ç½®  
- **æ¸¸æˆåŒ–**ï¼š  
  - æ¯å®Œæˆä¸€å±‚æ‰©å±• +10 åˆ†ï¼›  
  - æ‰¾åˆ°ç»ˆç‚¹æ—¶æ’­æ”¾â€œèƒœåˆ©â€éŸ³æ•ˆå¹¶æ”¾çƒŸèŠ±åƒç´ åŠ¨ç”»ã€‚

### å…³é”®å¸§ç¤ºæ„ï¼ˆæ–‡å­—ç‰ˆï¼‰
```
Step 0: åªæœ‰èµ·ç‚¹(1,1)äº®ç»¿ï¼Œans=1ã€‚
Step 1: ä¸Šä¸‹å·¦å³4æ ¼äº®è“ï¼Œans=1ã€‚
Step 2: å†å¤–åœˆ8æ ¼äº®é»„ï¼Œè‹¥æŸæ ¼è¢«ä¸¤ä¸ªå‰é©±æŒ‡å‘ï¼Œåˆ™ans=2ã€‚
...
Step N: ç»ˆç‚¹è¢«ç‚¹äº®ï¼Œæ˜¾ç¤ºæœ€ç»ˆansã€‚
```

---

## 6. æ‹“å±•ç»ƒä¹ ä¸ç›¸ä¼¼é—®é¢˜æ€è€ƒ

### é€šç”¨æ€è·¯è¿ç§»
- **è¾¹æƒä¸º 1** çš„å›¾ â†’ **BFS** å¯åŒæ—¶æ±‚è·ç¦»ä¸è®¡æ•°ã€‚  
- **è¾¹æƒä¸åŒ** â†’ éœ€ **Dijkstra/SPFA**ï¼Œå¹¶æ³¨æ„è®¡æ•°æ­£ç¡®æ€§ï¼ˆå‚è€ƒ XZYQvQ é¢˜è§£ï¼‰ã€‚  
- **éœ€è¦è¾“å‡ºè·¯å¾„** â†’ åœ¨æœ€çŸ­è·¯ DAG ä¸Šæ‹“æ‰‘æ’åºæˆ– DFS å›æº¯ã€‚

### æ´›è°·æ¨è
1. **P1608 æœ€çŸ­è·¯è®¡æ•°**  
   ğŸ—£ï¸ è¾¹æƒä¸ä¸º 1ï¼Œæ£€éªŒä½ æ˜¯å¦çœŸæ­£æŒæ¡â€œè®¡æ•°â€æŠ€å·§ã€‚  
2. **P1141 01è¿·å®«**  
   ğŸ—£ï¸ 01 æ— æƒå›¾è¿é€šå—è®¡æ•°ï¼Œç»ƒä¹  BFS æ¨¡æ¿ã€‚  
3. **P1525 å…³æŠ¼ç½ªçŠ¯**  
   ğŸ—£ï¸ å›¾è®º+äºŒåˆ†ç­”æ¡ˆï¼Œä½“ä¼šâ€œæœ€çŸ­è·¯â€æ€æƒ³åœ¨å¤æ‚é—®é¢˜ä¸­çš„åº”ç”¨ã€‚

---

## 7. å­¦ä¹ å¿ƒå¾—ä¸ç»éªŒåˆ†äº«

> **XZYQvQ çš„è¸©å‘æé†’**ï¼š  
> â€œSPFA åœ¨è¾¹æƒ>1 æ—¶ç›´æ¥ç´¯åŠ ä¼šé”™ï¼å»ºè®®å…ˆè·‘æœ€çŸ­è·¯ï¼Œå†åœ¨æœ€çŸ­è·¯ DAG ä¸Šè®¡æ•°ã€‚â€  
> **æ´›è¯­äº‘ç¬ºç‚¹è¯„**ï¼šè¿™æ¡ç»éªŒä»·å€¼åƒé‡‘â€”â€”**ç®—æ³•æ­£ç¡®æ€§ > æ¨¡æ¿å¥—ç”¨**ã€‚é‡åˆ°è®¡æ•°é¢˜ï¼Œå…ˆéªŒè¯æ€è·¯å†ä¸‹ç¬”ï¼

---

## ç»“è¯­
ä»æš´åŠ›åˆ° BFSï¼Œä»æ¨¡æ¿åˆ°è®¡æ•°ï¼Œè¿™é“é¢˜è®©æˆ‘ä»¬ä½“ä¼šåˆ°ï¼š**çœ‹æ¸…æ•°æ®ç‰¹å¾ï¼Œé€‰å¯¹ç®—æ³•ï¼Œæ‰èƒ½ä¼˜é›… ACï¼**  
ç»§ç»­åŠ æ²¹ï¼Œä¸‹ä¸€é“å›¾è®ºé¢˜è§ï¼

---
å¤„ç†ç”¨æ—¶ï¼š71.38ç§’
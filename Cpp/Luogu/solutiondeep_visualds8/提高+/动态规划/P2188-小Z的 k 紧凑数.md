# é¢˜ç›®ä¿¡æ¯

# å°Zçš„ k ç´§å‡‘æ•°

## é¢˜ç›®æè¿°

å° Z åœ¨è‰ç¨¿çº¸ä¸Šåˆ—å‡ºäº†å¾ˆå¤šæ•°ï¼Œä»–è§‰å¾—ç›¸é‚»ä¸¤ä½æ•°å­—å·®çš„ç»å¯¹å€¼ä¸è¶…è¿‡ k çš„æ•´æ•°ç‰¹åˆ«å¥‡ç‰¹ï¼Œç§°å…¶ä¸º k ç´§å‡‘æ•°ã€‚

ç°åœ¨å° Z æƒ³çŸ¥é“ [lï¼Œr] å†…æœ‰å¤šå°‘ä¸ª k ç´§å‡‘æ•°ï¼Œå¸Œæœ›ä½ å¸®å¸®ä»–ã€‚


## è¯´æ˜/æç¤º

ã€æ•°æ®è§„æ¨¡ã€‘

å¯¹äº 30% çš„æ•°æ®ï¼Œr âˆ’ l â‰¤ 10^5ï¼›

å¯¹äºå¦å¤– 30% çš„æ•°æ®ï¼Œl = 1ï¼Œr ä¸º 10 çš„å€æ•°ï¼›

å¯¹äº 100% çš„æ•°æ®ï¼Œ1 â‰¤ l â‰¤ r â‰¤ 10^18ï¼Œ0 â‰¤ k â‰¤ 8ã€‚


## æ ·ä¾‹ #1

### è¾“å…¥

```
1 13 1```

### è¾“å‡º

```
12```

# AIåˆ†æç»“æœ

---
# ğŸ’¡ æ´›è¯­äº‘ç¬ºçš„C++ç®—æ³•è§£æï¼šå°Zçš„ k ç´§å‡‘æ•° æ·±å…¥å­¦ä¹ æŒ‡å— ğŸ’¡

> ä»Šå¤©æˆ‘ä»¬è¦æ”»å…‹çš„æ˜¯ä¸€é“**æ•°ä½ DP** ç»å…¸é¢˜â€”â€”â€œå°Zçš„ k ç´§å‡‘æ•°â€ã€‚  
> æ ¸å¿ƒæŒ‘æˆ˜ï¼šåœ¨ **10Â¹â¸** çš„è¶…å¤§åŒºé—´é‡Œï¼Œå¿«é€Ÿç»Ÿè®¡**ç›¸é‚»ä¸¤ä½å·® â‰¤ k** çš„æ•´æ•°ä¸ªæ•°ã€‚  
> å…³é”®è¯ï¼šæ•°ä½ DPã€è®°å¿†åŒ–æœç´¢ã€å‰å¯¼é›¶ã€åŒºé—´å·®åˆ†ã€‚

---

## 1. é¢˜ç›®è§£è¯»ä¸ç­–ç•¥åˆæ¢

### âœ¨ æ ¸å¿ƒæŒ‘æˆ˜
> æš´åŠ›æšä¸¾æ¯ä¸ªæ•°ï¼ŸåŒºé—´é•¿åº¦ 10Â¹â¸ï¼ŒO(r-l) ç›´æ¥ TLEï¼  
> å…³é”®åœ¨äºï¼š**æ•°å­—çš„åˆæ³•æ€§åªä¸â€œç›¸é‚»ä¸¤ä½â€æœ‰å…³** â†’ å¤©ç„¶é€‚åˆ**é€ä½å†³ç­–**çš„ **æ•°ä½ DP**ã€‚

### âœ¨ æ ¸å¿ƒç®—æ³•æ ‡ç­¾
- æ•°ä½åŠ¨æ€è§„åˆ’ï¼ˆDigit DPï¼‰
- è®°å¿†åŒ–æœç´¢ï¼ˆMemoizationï¼‰
- åŒºé—´å·®åˆ†æŠ€å·§ï¼š`ans = solve(r) - solve(l-1)`

### ğŸ” ç®—æ³•ä¾¦æ¢ï¼šå¦‚ä½•åœ¨é¢˜ç›®ä¸­å‘ç°çº¿ç´¢ï¼Ÿ
| çº¿ç´¢ | å‘ç° |
|---|---|
| **é—®é¢˜ç›®æ ‡** | ç»Ÿè®¡åŒºé—´åˆæ³•æ•° â†’ åŒºé—´å·®åˆ† + å•ç‚¹æŸ¥è¯¢ |
| **é—®é¢˜ç‰¹æ€§** | åˆæ³•æ€§ä»…ä¾èµ–â€œç›¸é‚»ä¸¤ä½â€ â†’ é€ä½å†³ç­–ï¼Œè®°å½• **å‰é©±æ•°å­—** |
| **æ•°æ®è§„æ¨¡** | 1 â‰¤ l â‰¤ r â‰¤ 10Â¹â¸ â†’ å¿…é¡» **O(logâ‚â‚€r)** çº§åˆ«ç®—æ³• |

### ğŸ§  æ€ç»´é“¾æ„å»ºï¼šä»çº¿ç´¢åˆ°ç­–ç•¥
1. åŒºé—´ç»Ÿè®¡ â†’ å·®åˆ†è½¬åŒ–ï¼š`solve(r) - solve(l-1)`  
2. é€ä½å†³ç­– â†’ **æ•°ä½ DP**ï¼šæŠŠæ•°å­—æŒ‰ä½æ‹†è§£ï¼Œä»é«˜ä½åˆ°ä½ä½ DFSã€‚  
3. éœ€è¦è®°å½•çš„çŠ¶æ€ï¼š  
   - `pos` å½“å‰å¤„ç†ä½  
   - `pre` å‰ä¸€ä½æ•°å­—ï¼ˆç”¨äºæ£€æŸ¥ |now-pre| â‰¤ kï¼‰  
   - `lead` æ˜¯å¦ä»åœ¨å‰å¯¼é›¶  
   - `limit` æ˜¯å¦ç´§è´´åŸæ•°ä¸Šç•Œ  
4. è®°å¿†åŒ–ï¼šç›¸åŒ `(pos, pre, lead, limit)` çŠ¶æ€åªç®—ä¸€æ¬¡ã€‚

---

## 2. ç²¾é€‰ä¼˜è´¨é¢˜è§£å‚è€ƒ

> ä»¥ä¸‹é¢˜è§£å‡ â‰¥4 æ˜Ÿï¼Œæˆ‘æŒ‰**æ€è·¯æ¸…æ™°åº¦ã€ä»£ç å¯è¯»æ€§ã€æŠ€å·§äº®ç‚¹**è¿›è¡Œç‚¹è¯„ã€‚

| é¢˜è§£ä½œè€… | äº®ç‚¹æç‚¼ |
|---|---|
| **å¤è‰²ç¥­** | ç®€æ´äºŒç»´ DPï¼š`f[i][j]` è¡¨ç¤º i ä½ã€æœ«ä½ j çš„æ–¹æ¡ˆæ•°ï¼›å…ˆé¢„å¤„ç†ï¼Œå†åˆ†æ®µç»Ÿè®¡ã€‚æ€è·¯ç›´ç™½ï¼Œé€‚åˆå…¥é—¨ã€‚ |
| **zjh111111** | ä¸‰ç»´çŠ¶æ€ï¼š`f[i][j][0/1]` åŒºåˆ†â€œå·²å°äº/ç­‰äºâ€ä¸Šç•Œï¼›**å‰å¯¼é›¶ç»†èŠ‚**è®²è§£ç»†è‡´ï¼Œé™„æ‹“å±•ï¼ˆç¬¬ k ä¸ªç´§å‡‘æ•°ï¼‰ã€‚ |
| **mlvx** | ç»å…¸å››å‚æ•° DFSï¼š`dfs(pos, pre, lead, limit)`ï¼›ä»£ç çŸ­å°ç²¾æ‚ï¼Œ**å‰å¯¼é›¶**ä¸**è®°å¿†åŒ–**å¤„ç†å¹²å‡€åˆ©è½ã€‚ |
| **reclusive** | ä»£ç ç»“æ„ä¸ mlvx ç±»ä¼¼ï¼Œé¢å¤–ç»™å‡º**é€šç”¨æ•°ä½ DP æ¨¡æ¿**ï¼Œä¾¿äºè¿ç§»åˆ°å…¶å®ƒé¢˜ç›®ã€‚ |

---

## 3. è§£é¢˜ç­–ç•¥æ·±åº¦å‰–æ

### ğŸ¯ æ ¸å¿ƒéš¾ç‚¹ä¸å…³é”®æ­¥éª¤ï¼ˆæœ€ä¼˜è§£æ³•ï¼šè®°å¿†åŒ–æœç´¢ï¼‰

| å…³é”®ç‚¹ | åˆ†æä¸å­¦ä¹ ç¬”è®° |
|---|---|
| **çŠ¶æ€è®¾è®¡** | `dfs(pos, pre, lead, limit)`ï¼š  
- `pos` å½“å‰ä½ï¼ˆä»é«˜åˆ°ä½ï¼‰  
- `pre` å‰ä¸€ä½æ•°å­—ï¼ˆè‹¥ `lead=1` åˆ™æ— æ•ˆï¼‰  
- `lead` æ˜¯å¦ä»åœ¨å‰å¯¼é›¶  
- `limit` æ˜¯å¦å—åŸæ•°ä¸Šç•Œé™åˆ¶ |
| **è½¬ç§»æ–¹ç¨‹** | æšä¸¾å½“å‰ä½æ•°å­— `i`ï¼š  
- è‹¥ `lead` ä»æˆç«‹ï¼Œåˆ™ç›´æ¥é€’å½’ä¸‹ä¸€ä½ï¼Œæ–° `lead = (i==0)`  
- å¦åˆ™æ£€æŸ¥ `|i-pre| â‰¤ k`  
- æ›´æ–° `limit = limit && (i==max_digit)` |
| **è®°å¿†åŒ–** | å½“ `!limit && !lead` æ—¶ï¼ŒæŠŠ `dp[pos][pre]` ä¿å­˜ç»“æœï¼Œé¿å…é‡å¤è®¡ç®—ã€‚ |
| **å¤æ‚åº¦** | çŠ¶æ€æ•° â‰ˆ **20ä½ Ã— 10ç§pre Ã— 2ç§lead Ã— 2ç§limit** â‰ˆ **800**ï¼Œå®Œå…¨å¯æ¥å—ã€‚ |

### âš”ï¸ ç­–ç•¥ç«æŠ€åœº

| ç­–ç•¥ | å¤æ‚åº¦ | ä¼˜ç‚¹ | ç¼ºç‚¹ | å¾—åˆ†é¢„æœŸ |
|---|---|---|---|---|
| **æš´åŠ›æšä¸¾** | O(r-l) | æ€è·¯ç›´ç™½ | 10Â¹â¸ ç›´æ¥ TLE | 30% éƒ¨åˆ†åˆ† |
| **æ•°ä½ DP é¢„å¤„ç†** | O(log r) | ç†è®ºæ¸…æ™° | éœ€è¦å†™é«˜ç²¾åº¦æ‹†ä½ | 100% |
| **è®°å¿†åŒ–æœç´¢** | O(log r) | ä»£ç çŸ­ã€æ˜“è°ƒè¯• | éœ€è¦ç†è§£ DFS+Memo | 100% |

### âœ¨ ä¼˜åŒ–ä¹‹æ—…
> ä»æš´åŠ›åˆ°è®°å¿†åŒ–æœç´¢ï¼š  
> 1. å‘ç°æš´åŠ›æ— æ³•æ‰¿å— 10Â¹â¸ â†’ 2. æƒ³åˆ°é€ä½å†³ç­– â†’ 3. å¼•å…¥è®°å¿†åŒ–ç¼“å­˜ â†’ 4. ç”¨ DFS æ¡†æ¶ä¼˜é›…è½åœ°ã€‚  
> è¿™å‘Šè¯‰æˆ‘ä»¬ï¼š**â€œæŠŠæ•°å­—å½“å­—ç¬¦ä¸²é€ä½å¤„ç†â€** æ˜¯æ•°ä½ DP çš„çµé­‚ã€‚

---

## 4. C++æ ¸å¿ƒä»£ç å®ç°èµæ

### æœ¬é¢˜é€šç”¨æ ¸å¿ƒC++å®ç°å‚è€ƒ
```cpp
#include <bits/stdc++.h>
using namespace std;
using ll = long long;

ll l, r, k;
int num[20], len;
ll dp[20][10][2][2];   // dp[pos][pre][lead][limit]

ll dfs(int pos, int pre, bool lead, bool limit) {
    if (pos == 0) return 1;              // æ„é€ å®Œæˆ
    ll &ret = dp[pos][pre][lead][limit];
    if (ret != -1) return ret;
    ret = 0;
    int up = limit ? num[pos] : 9;
    for (int i = 0; i <= up; ++i) {
        if (lead || abs(i - pre) <= k) {
            ret += dfs(pos - 1,
                       i,
                       lead && (i == 0),
                       limit && (i == up));
        }
    }
    return ret;
}

ll solve(ll x) {
    if (x < 0) return 0;
    len = 0;
    while (x) num[++len] = x % 10, x /= 10;
    memset(dp, -1, sizeof dp);
    return dfs(len, 0, true, true);
}

int main() {
    cin >> l >> r >> k;
    cout << solve(r) - solve(l - 1);
    return 0;
}
```

### ä»£ç è§£è¯»æ¦‚è¦
- **solve(x)**ï¼šæŠŠ x æ‹†ä½ â†’ è°ƒç”¨ dfs  
- **dfs**ï¼š  
  - è‹¥å·²å¤„ç†å®Œï¼Œè¿”å› 1  
  - æšä¸¾å½“å‰ä½æ•°å­— iï¼Œåˆæ³•æ€§æ£€æŸ¥  
  - è®°å¿†åŒ–ç¼“å­˜çŠ¶æ€ï¼Œç¡®ä¿ä¸é‡å¤è®¡ç®—  

---

## 5. ç®—æ³•å¯è§†åŒ–ï¼šåƒç´ åŠ¨ç”»æ¼”ç¤º

> **ä¸»é¢˜**ï¼š8-bit åƒç´ é£â€œæ•°å­—å·¥åŒ â€åœ¨ **20 å±‚æ•°å­—å¡”** ä¸Šé€ä½é›•åˆ»ã€‚

### åŠ¨ç”»æ ¸å¿ƒå†…å®¹
- **å±‚æ•°**ï¼šå¯¹åº” `pos`ï¼ˆä»é«˜åˆ°ä½ï¼‰  
- **åƒç´ æ–¹å—**ï¼šæ¯ä¸€ä½å¯é€‰æ•°å­— 0-9ï¼Œç”¨ä¸åŒé¢œè‰²å—è¡¨ç¤º  
- **é«˜äº®ç®­å¤´**ï¼šå½“å‰ä½ `i` ä¸å‰ä¸€ä½ `pre` çš„å·®å€¼æ£€æŸ¥  
- **éŸ³æ•ˆ**ï¼š
  - åˆæ³•é€‰æ‹© â†’ â€œå®â€
  - è®°å¿†åŒ–å‘½ä¸­ â†’ â€œå˜Ÿâ€  
  - å®Œæˆæ•´å±‚ â†’ 8-bit èƒœåˆ©éŸ³  
- **äº¤äº’**ï¼š
  - å•æ­¥ / è‡ªåŠ¨æ’­æ”¾ / è°ƒé€Ÿæ»‘å—  
  - ä¾§è¾¹æ å®æ—¶æ˜¾ç¤º `dfs(pos, pre, lead, limit)` å‚æ•°ä¸è¿”å›å€¼  

### å…³é”®å¸§ç¤ºä¾‹
| å¸§ | æè¿° | åƒç´ åŒ–ç¤ºæ„ |
|---|---|---|
| 1 | åˆå§‹å¡” 20 å±‚ï¼Œå…¨ç° | ![å¡”](https://via.placeholder.com/20x80/888/fff?text=20) |
| 2 | ç¬¬20ä½é€‰æ‹© 3ï¼Œé«˜äº® | ![å¡”](https://via.placeholder.com/20x80/3f3/fff?text=3) |
| 3 | ç¬¬19ä½é€‰æ‹© 1ï¼Œæ£€æŸ¥ |3-1|â‰¤k â†’ ç»¿è‰² | ![å¡”](https://via.placeholder.com/20x80/3f3/fff?text=3-1) |
| 4 | è®°å¿†åŒ–ç¼“å­˜ï¼Œå—å˜è“ | ![å¡”](https://via.placeholder.com/20x80/33f/fff?text=âœ“) |

---

## 6. æ‹“å±•ç»ƒä¹ ä¸ç›¸ä¼¼é—®é¢˜æ€è€ƒ

### é€šç”¨æŠ€å·§è¿ç§»
- **é€ä½å†³ç­–+è®°å¿†åŒ–** å¯è§£å†³ï¼š
  1. ä¸å«è¿ç»­ 62 çš„æ•°å­—
  2. æ•°å­—ä¸­ 4ã€8 ä¸èƒ½ç›¸é‚»
  3. å„ä½æ•°å­—å’Œä¸ºç‰¹å®šå€¼çš„æ•°å­—ä¸ªæ•°

### æ´›è°·æ¨è
| é¢˜å· | æ¨èç†ç”± |
|---|---|
| **P2657 [SCOI2009] windy æ•°** | ä¸ç´§å‡‘æ•°å‡ ä¹åŒæ„ï¼Œç»ƒä¹ æ¨¡æ¿è¿ç§» |
| **P2602 [ZJOI2010] æ•°å­—è®¡æ•°** | ç»Ÿè®¡åŒºé—´å†…æ•°å­— 0-9 å‡ºç°æ¬¡æ•°ï¼Œç»§ç»­å·©å›ºæ•°ä½ DP |
| **P4124 [CQOI2016] æ‰‹æœºå·ç ** | æ•°ä½é™åˆ¶+å‰å¯¼é›¶+åŒºé—´å·®åˆ†ï¼Œç»¼åˆè®­ç»ƒ |

---

## 7. å­¦ä¹ å¿ƒå¾—ä¸ç»éªŒåˆ†äº«

> **æ¥è‡ªä½œè€… mlvx**ï¼š  
> â€œå‰å¯¼é›¶çš„åˆ¤æ–­ä¸€å®šè¦æ”¾åœ¨åˆæ³•æ€§æ£€æŸ¥ä¹‹å‰ï¼Œå¦åˆ™ä¼šæŠŠ 0012 è¯¯åˆ¤ä¸ºåˆæ³• 12ã€‚â€  
> **æ´›è¯­äº‘ç¬ºç‚¹è¯„**ï¼šè¿™æ˜¯æ•°ä½ DP æœ€å¸¸è§çš„å‘ä¹‹ä¸€ã€‚å»ºè®®æ‰“å° `lead` å˜é‡ï¼Œ**è‚‰çœ¼æ¨¡æ‹Ÿ**ä¸€é 0012 çš„ DFS è·¯å¾„ï¼Œå¯è¿…é€Ÿå®šä½ bugã€‚

---

> è‡³æ­¤ï¼Œæˆ‘ä»¬å·²ç»å®Œæ•´æ‹†è§£äº†â€œå°Zçš„ k ç´§å‡‘æ•°â€ã€‚  
> è®°ä½ï¼š**æŠŠå¤§æ•°æ‹†æˆâ€œæ•°å­—å­—ç¬¦ä¸²â€ï¼Œé€ä½ DFS+è®°å¿†åŒ–ï¼Œæ˜¯æ”»å…‹æ•°ä½ DP çš„ä¸‡èƒ½é’¥åŒ™ï¼**  
> ä¸‹æ¬¡è§ï¼Œç»§ç»­æ¢é™©ï¼

---
å¤„ç†ç”¨æ—¶ï¼š130.98ç§’
# é¢˜ç›®ä¿¡æ¯

# [HAOI2008] æœ¨æ£åˆ†å‰²

## é¢˜ç›®æè¿°

æœ‰ $n$ æ ¹æœ¨æ£ï¼Œç¬¬ $i$ æ ¹æœ¨æ£çš„é•¿åº¦ä¸º $L_i$ï¼Œ$n$ æ ¹æœ¨æ£ä¾æ®ç¼–å·æ¬¡åºï¼ˆå³æœ€å·¦è¾¹æ˜¯ç¬¬ $1$ æ ¹æœ¨æ£ï¼Œç„¶åæ˜¯ç¬¬ $2$ æ ¹æœ¨æ£ï¼Œä»¥æ­¤ç±»æ¨ï¼‰è¿æ¥åœ¨ä¸€èµ·ï¼Œæ€»å…±æœ‰ $n-1$ ä¸ªè¿æ¥å¤„ã€‚ç°åœ¨å…è®¸ä½ **æœ€å¤š**ç æ–­ $m$ ä¸ªè¿æ¥å¤„ï¼Œç å®Œå $n$ æ ¹æœ¨æ£è¢«åˆ†æˆäº†å¾ˆå¤šæ®µï¼Œè¦æ±‚æ»¡è¶³æ€»é•¿åº¦æœ€å¤§çš„ä¸€æ®µé•¿åº¦æœ€å°ã€‚

è¾“å‡ºæ€»é•¿åº¦æœ€å¤§çš„ä¸€æ®µé•¿åº¦çš„æœ€å°å€¼ï¼Œå¹¶ä¸”è¾“å‡ºä½¿æ€»é•¿åº¦æœ€å¤§çš„ä¸€æ®µé•¿åº¦æœ€å°çš„æ–¹æ¡ˆæ€»æ•°é™¤ä»¥ $10007$ çš„ä½™æ•°ã€‚

## è¯´æ˜/æç¤º

### æ ·ä¾‹è§£é‡Š

å¯ä»¥ç  $1$ ä¸‹åˆ†æˆ $1,1$ å’Œ $10$ ä¸¤ä¸ªéƒ¨åˆ†ï¼Œä¹Ÿå¯ä»¥ç  $2$ ä¸‹åˆ†æˆ $1$ã€$1$ å’Œ $10$ ä¸‰ä¸ªéƒ¨åˆ†ã€‚

### æ•°æ®èŒƒå›´

å¯¹äºæ‰€æœ‰çš„æ•°æ®ï¼Œ$n \le 50000,\ 0\le m\le \min(n-1,1000),\ 1\le L_i\le 1000$ã€‚

## æ ·ä¾‹ #1

### è¾“å…¥

```
3 2                           
1 
1
10```

### è¾“å‡º

```
10 2```

# AIåˆ†æç»“æœ

ğŸ’¡ æ´›è¯­äº‘ç¬ºçš„ C++ ç®—æ³•è§£æï¼š  
[HAOI2008] æœ¨æ£åˆ†å‰² æ·±å…¥å­¦ä¹ æŒ‡å— ğŸ’¡
================================================

> æ¬¢è¿æ¥åˆ°ä»Šå¤©çš„æ€ç»´æ¢é™©ï¼æˆ‘ä»¬è¦å¤„ç†çš„é¢˜ç›®æ˜¯â€œæœ¨æ£åˆ†å‰²â€ï¼Œå®ƒåŒæ—¶è€ƒå¯Ÿäº†**äºŒåˆ†ç­”æ¡ˆ**ä¸**å‰ç¼€å’Œä¼˜åŒ– DP**ä¸¤å¤§æ ¸å¿ƒæŠ€å·§ã€‚å‡†å¤‡å¥½è·Ÿéšæ´›è¯­äº‘ç¬ºï¼Œä¸€èµ·æŠŠé—®é¢˜æ‹†å¼€ã€é‡ç»„ã€å†ä¼˜åŒ–å§ï¼

---

## 1. é¢˜ç›®è§£è¯»ä¸ç­–ç•¥åˆæ¢

### ğŸ” æ ¸å¿ƒæŒ‘æˆ˜
- ç¬¬ä¸€é—®ï¼šæŠŠæœ¨æ£åˆ‡æˆ **æœ€å¤š m åˆ€** åï¼Œ**æœ€é•¿ä¸€æ®µçš„é•¿åº¦æœ€å°**æ˜¯å¤šå°‘ï¼Ÿ  
- ç¬¬äºŒé—®ï¼šåœ¨â€œæœ€é•¿ä¸€æ®µçš„é•¿åº¦æœ€å°â€çš„å‰æä¸‹ï¼Œæœ‰å¤šå°‘ç§åˆæ³•çš„åˆ‡å‰²æ–¹æ¡ˆï¼Ÿï¼ˆç»“æœ mod 10007ï¼‰

### âœ¨ è§£é¢˜æ€è·¯æ¦‚è§ˆ
| é˜¶æ®µ | ç­–ç•¥ | å…³é”®æŠ€å·§ |
| --- | --- | --- |
| 1ï¸âƒ£ æ±‚æœ€å°åŒ–æœ€å¤§å€¼ | **äºŒåˆ†ç­”æ¡ˆ** | è´ªå¿ƒ `check` |
| 2ï¸âƒ£ æ±‚æ–¹æ¡ˆæ•° | **DP + å‰ç¼€å’Œä¼˜åŒ–** | æ»šåŠ¨æ•°ç»„ã€åŒæŒ‡é’ˆ |

> äºŒåˆ†ç­”æ¡ˆå°±åƒâ€œçŒœæ•°å­—â€ï¼šæˆ‘ä»¬çŒœä¸€ä¸ªâ€œæœ€é•¿æ®µé•¿åº¦â€ï¼Œç„¶åéªŒè¯èƒ½å¦åœ¨ **m åˆ€ä»¥å†…** è¾¾æˆã€‚  
> DP åˆ™åƒâ€œæ•°è·¯å¾„â€ï¼šæŠŠæœ¨æ£æŒ‰æ®µæ•°åˆ†å±‚ï¼Œç»Ÿè®¡åˆæ³•è·¯å¾„ï¼Œå†ç”¨å‰ç¼€å’Œâ€œæ‰¹é‡ç´¯åŠ â€ã€‚

---

### ğŸ§  æ€ç»´é“¾æ„å»ºï¼šä»çº¿ç´¢åˆ°ç­–ç•¥
1. **çº¿ç´¢ 1ï¼šæœ€å°åŒ–æœ€å¤§å€¼**  
   â€œæœ€å°åŒ–æœ€å¤§å€¼â€å¤©ç„¶å…·å¤‡**å•è°ƒæ€§**ï¼š  
   å¦‚æœé•¿åº¦ `L` å¯è¡Œï¼Œé‚£ä¹ˆæ‰€æœ‰ `â‰¥L` çš„é•¿åº¦ä¹Ÿä¸€å®šå¯è¡Œã€‚  
   â†’ ç›´æ¥è§¦å‘â€œ**äºŒåˆ†ç­”æ¡ˆ**â€å…³é”®è¯ã€‚

2. **çº¿ç´¢ 2ï¼šæ–¹æ¡ˆè®¡æ•°**  
   åœ¨å›ºå®šæœ€é•¿æ®µé•¿åº¦ `L` åï¼Œé—®é¢˜è½¬åŒ–ä¸ºï¼š  
   â€œæŠŠåºåˆ—åˆ‡æˆ â‰¤m+1 æ®µï¼Œæ¯æ®µå’Œ â‰¤Lï¼Œæ±‚æ–¹æ¡ˆæ•°ã€‚â€  
   â†’ ç»å…¸ **åŒºé—´ DP**ï¼Œå¯ç”¨å‰ç¼€å’Œä¼˜åŒ–åˆ° **O(nÂ·m)**ã€‚

3. **çº¿ç´¢ 3ï¼šæ•°æ®è§„æ¨¡**  
   n â‰¤ 5Ã—10â´ï¼Œm â‰¤ 1Ã—10Â³ â†’ éœ€è¦ **O(nÂ·m)** çš„åšæ³•ï¼Œ**O(nÂ²Â·m)** ä¼šçˆ†ç‚¸ã€‚  
   â†’ å‰ç¼€å’Œä¼˜åŒ– + æ»šåŠ¨æ•°ç»„ã€‚

---

## 2. ç²¾é€‰ä¼˜è´¨é¢˜è§£å‚è€ƒ

| é¢˜è§£ | äº®ç‚¹æç‚¼ | å­¦ä¹ è¦ç‚¹ |
| --- | --- | --- |
| **niiick** (34ğŸ‘) | å®Œæ•´ç»™å‡ºäºŒåˆ† + å‰ç¼€å’Œ DP æ¨¡æ¿ï¼›å¼ºè°ƒ **åŒæŒ‡é’ˆæ±‚ `rem[i]`** é¿å…é‡å¤æ‰«æã€‚ | åŒæŒ‡é’ˆ + å‰ç¼€å’Œ = é™ç»´æ‰“å‡» |
| **é‡‘çˆ·çˆ·å“ˆå“ˆ** (22ğŸ‘) | ç”¨ `lef[i]` æè¿°æœ€å·¦å¯åˆ†ç‚¹ï¼›ä»£ç ç®€æ´ï¼Œå˜é‡å‘½åç›´è§‚ã€‚ | å˜é‡è¯­ä¹‰åŒ–ï¼Œé™ä½æ€ç»´è´Ÿæ‹… |
| **å¥‡ç±³** (12ğŸ‘) | ä» O(nÂ³) è®²åˆ° O(nÂ·m)ï¼Œå±‚å±‚é€’è¿›ï¼›é™„èµ â€œå¸¸æ•°ç„å­¦â€å°è´´å£«ã€‚ | å­¦ä¼šâ€œè‡ªåº•å‘ä¸Šâ€ä¼˜åŒ– |
| **y2823774827y** (5ğŸ‘) | ä½¿ç”¨ **æ»šåŠ¨æ•°ç»„** + **ä½è¿ç®—**åˆ‡æ¢ç»´åº¦ï¼›ä»£ç çŸ­ã€‚ | ç©ºé—´å‹ç¼©æŠ€å·§ |
| **Piwry** (1ğŸ‘) | æŒ‡å‡º DP å®šä¹‰é™·é˜±ï¼šåŒºåˆ†â€œæ°å¥½åˆ† i æ®µâ€ä¸â€œè‡³å¤šåˆ† i æ®µâ€ã€‚ | è¾¹ç•Œæ€ç»´æ˜¯å¾—åˆ†å…³é”® |

---

## 3. è§£é¢˜ç­–ç•¥æ·±åº¦å‰–æ

### ğŸ¯ æ ¸å¿ƒéš¾ç‚¹ä¸å…³é”®æ­¥éª¤ï¼ˆæœ€ä¼˜è§£æ³•ï¼‰
| æ­¥éª¤ | å†…å®¹ | å­¦ä¹ ç¬”è®° |
| --- | --- | --- |
| â‘  äºŒåˆ†ç­”æ¡ˆ | `check(L)`ï¼šè´ªå¿ƒåˆ†æ®µï¼Œè®¡æ•°æ®µæ•° `cnt`ã€‚ | å¤æ‚åº¦ O(n log Î£L) |
| â‘¡ é¢„å¤„ç† `pre[i]` | åŒæŒ‡é’ˆ/äºŒåˆ†æ‰¾åˆ°æœ€å°çš„ `k` ä½¿ `sum[i]-sum[k] â‰¤ L`ã€‚ | å¤æ‚åº¦ O(n) |
| â‘¢ DP è®¾è®¡ | `f[i]` = å‰ `i` æ ¹æœ¨æ£ï¼Œåˆ†æˆè‹¥å¹²æ®µçš„æ–¹æ¡ˆæ•°ã€‚ | çŠ¶æ€åªä¸ä¸Šä¸€æ®µæœ‰å…³ |
| â‘£ å‰ç¼€å’Œä¼˜åŒ– | ç”¨ `s[i]` ç»´æŠ¤ `f[0..i]` çš„å’Œï¼Œè½¬ç§»ï¼š`f[i] = s[i-1] - s[pre[i]-1]`ã€‚ | å¤æ‚åº¦ O(nÂ·m) |
| â‘¤ æ»šåŠ¨æ•°ç»„ | åªä¿å­˜ **å½“å‰æ®µ** ä¸ **ä¸Šä¸€æ®µ** ä¸¤è¡Œï¼Œç©ºé—´ O(n)ã€‚ | ç©ºé—´å‹ç¼© |

---

### âš”ï¸ ç­–ç•¥ç«æŠ€åœºï¼šä¸åŒè§£æ³•çš„å¯¹æ¯”åˆ†æ
| ç­–ç•¥ | æ ¸å¿ƒæ€æƒ³ | ä¼˜ç‚¹ | ç¼ºç‚¹ | é€‚ç”¨åœºæ™¯ / å¾—åˆ† |
| --- | --- | --- | --- | --- |
| æš´åŠ›æšä¸¾ | æšä¸¾ 2^(n-1) ç§åˆ‡å‰²æ–¹å¼ | æ€è·¯ç›´è§‚ | æŒ‡æ•°çº§çˆ†ç‚¸ | n â‰¤ 20 |
| äºŒåˆ† + è´ªå¿ƒ | äºŒåˆ†ç­”æ¡ˆï¼Œè´ªå¿ƒéªŒè¯ | ç®€å•é«˜æ•ˆ | åªèƒ½è§£å†³ç¬¬ä¸€é—® | 100% (Q1) |
| äºŒåˆ† + DP O(nÂ·m) | äºŒåˆ† + å‰ç¼€å’Œä¼˜åŒ– DP | åŒé—® AC | éœ€ç²¾ç»†å®ç° | 100% (Q1&Q2) |
| äºŒåˆ† + DP O(nÂ²Â·m) | æœªä¼˜åŒ–ä¸‰é‡å¾ªç¯ | æ˜“å†™ | å¿… TLE | 0% |

---

### âœ¨ ä¼˜åŒ–ä¹‹æ—…ï¼šä»â€œèƒ½åšâ€åˆ°â€œåšå¥½â€
1. **èµ·ç‚¹**ï¼šæš´åŠ›æšä¸¾ â†’ æŒ‡æ•°çº§çˆ†ç‚¸  
2. **ç¬¬ä¸€æ¬¡é£è·ƒ**ï¼šäºŒåˆ†ç­”æ¡ˆ â†’ é™ç»´åˆ° O(n log Î£L)  
3. **ç¬¬äºŒæ¬¡é£è·ƒ**ï¼šå‰ç¼€å’Œä¼˜åŒ– DP â†’ å†é™ç»´åˆ° O(nÂ·m)  
4. **æœ€ç»ˆæ‰“ç£¨**ï¼šæ»šåŠ¨æ•°ç»„ â†’ ç©ºé—´ O(n)

> æ¯ä¸€æ¬¡é£è·ƒï¼Œéƒ½æ˜¯**åˆ©ç”¨å•è°ƒæ€§**æˆ–**å‰ç¼€å’Œ**æŠŠâ€œé‡å¤åŠ³åŠ¨â€ç æ‰ï¼

---

## 4. C++ æ ¸å¿ƒä»£ç å®ç°èµæ

### âœ… é€šç”¨æ ¸å¿ƒå®ç°ï¼ˆæ•´åˆç‰ˆï¼‰
```cpp
#include <bits/stdc++.h>
using namespace std;
const int MAXN = 5e4 + 10, MOD = 10007;
int n, m, a[MAXN], sum[MAXN], pre[MAXN], f[MAXN], s[MAXN];

bool check(int lim) {
    int cnt = 1, cur = 0;
    for (int i = 1; i <= n; ++i) {
        if (a[i] > lim) return false;
        if (cur + a[i] > lim) cur = a[i], ++cnt;
        else cur += a[i];
    }
    return cnt <= m + 1;
}

int main() {
    ios::sync_with_stdio(false);
    cin.tie(nullptr);
    cin >> n >> m; m++;
    for (int i = 1; i <= n; ++i) cin >> a[i], sum[i] = sum[i - 1] + a[i];

    // 1. äºŒåˆ†ç­”æ¡ˆ
    int L = *max_element(a + 1, a + n + 1), R = sum[n], ans1;
    while (L <= R) {
        int mid = (L + R) / 2;
        if (check(mid)) ans1 = mid, R = mid - 1;
        else L = mid + 1;
    }
    cout << ans1 << ' ';

    // 2. é¢„å¤„ç†æœ€å·¦å¯åˆ†ç‚¹ pre[i]
    for (int i = 1, j = 0; i <= n; ++i) {
        while (sum[i] - sum[j] > ans1) ++j;
        pre[i] = j;
    }

    // 3. å‰ç¼€å’Œä¼˜åŒ– DP
    fill(s, s + n + 1, 0);
    for (int i = 0; i <= n; ++i) s[i] = (sum[i] <= ans1);
    int ans2 = s[n];
    for (int k = 2; k <= m; ++k) {
        for (int i = 0; i <= n; ++i) {
            f[i] = (s[i - 1] - (pre[i] ? s[pre[i] - 1] : 0) + MOD) % MOD;
        }
        for (int i = 0; i <= n; ++i) s[i] = (s[i - 1] + f[i]) % MOD;
        ans2 = (ans2 + f[n]) % MOD;
    }
    cout << ans2 << '\n';
    return 0;
}
```

---

## 5. ç®—æ³•å¯è§†åŒ–ï¼šåƒç´ åŠ¨ç”»æ¼”ç¤º

### ğŸ® ä¸»é¢˜ï¼š**â€œåƒç´ åˆ‡å‰²å¤§å¸ˆâ€**
- **åœºæ™¯**ï¼š8Ã—n åƒç´ é•¿æ¡ä»£è¡¨æœ¨æ£ï¼Œé¢œè‰²å—é«˜åº¦=é•¿åº¦ã€‚
- **äº¤äº’**ï¼š
  - **äºŒåˆ†é˜¶æ®µ**ï¼šæ»‘åŠ¨æ¡è°ƒèŠ‚â€œæœ€é•¿æ®µé•¿åº¦â€ï¼Œåƒç´ æ¡å®æ—¶é‡æ’ä¸ºè‹¥å¹²æ®µï¼Œæ˜¾ç¤ºæ®µæ•° `cnt`ã€‚
  - **DP é˜¶æ®µ**ï¼šæ¯ä¸€è¡Œä»£è¡¨â€œåˆ†æˆ k æ®µâ€çš„çŠ¶æ€ï¼Œåƒç´ ç®­å¤´ä» `pre[i]` æ»‘åˆ° `i`ï¼Œä¼´éšâ€œå®â€éŸ³æ•ˆï¼›å‰ç¼€å’Œ `s[i]` ç”¨åƒç´ æ•°å­—å®æ—¶æ›´æ–°ã€‚
- **æ¸¸æˆåŒ–å…ƒç´ **ï¼š
  - æ¯æˆåŠŸä¸€æ¬¡â€œåˆ†æ®µåˆæ³•â€åŠ  1 UPã€‚
  - æœ€ç»ˆé€šå…³æ˜¾ç¤ºâ€œACâ€åƒç´ çƒŸèŠ±ã€‚

---

## 6. æ‹“å±•ç»ƒä¹ ä¸ç›¸ä¼¼é—®é¢˜æ€è€ƒ

### ğŸ“š é€šç”¨æŠ€å·§è¿ç§»
- **å‰ç¼€å’Œä¼˜åŒ– DP** é€‚ç”¨äºï¼šåŒºé—´å’Œé™åˆ¶ä¸‹çš„åˆ†æ®µã€åˆ†ç»„ã€å­åºåˆ—è®¡æ•°ã€‚
- **äºŒåˆ†ç­”æ¡ˆ** é€‚ç”¨äºï¼šæœ€å°åŒ–æœ€å¤§å€¼ã€æœ€å¤§åŒ–æœ€å°å€¼ç±»é—®é¢˜ã€‚

### ğŸ¯ æ´›è°·æ¨è
| é¢˜å· | æ¨èç†ç”± |
| --- | --- |
| **P1182** æ•°åˆ—åˆ†æ®µ | äºŒåˆ†ç­”æ¡ˆè£¸é¢˜ï¼Œå·©å›º `check` å†™æ³• |
| **P1043** æ•°å­—æ¸¸æˆ | å‰ç¼€å’Œä¼˜åŒ– DP ç»å…¸ï¼Œä½“ä¼šâ€œåŒºé—´å’Œé™åˆ¶â€ |
| **P2679** å­ä¸² | æ»šåŠ¨æ•°ç»„ + å‰ç¼€å’Œï¼ŒäºŒç»´é™ä¸€ç»´ |

---

## 7. å­¦ä¹ å¿ƒå¾—ä¸ç»éªŒåˆ†äº«
- **è¾¹ç•Œé™·é˜±**ï¼š`pre[i]-1` å¯èƒ½ä¸º -1ï¼Œéœ€ç‰¹åˆ¤ã€‚
- **å¸¸æ•°ä¼˜åŒ–**ï¼šä½¿ç”¨ `short` æˆ–ä½è¿ç®—åˆ‡æ¢ç»´åº¦ï¼Œè·‘æ»¡æ—¶é™ã€‚
- **è°ƒè¯•æŠ€å·§**ï¼šæ‰“å° `pre[i]` ä¸ `sum[i]`ï¼Œè‚‰çœ¼éªŒè¯å•è°ƒæ€§ã€‚

---

> æ­å–œä½ å®Œæˆæœ¬æ¬¡æ¢é™©ï¼è®°ä½ï¼š  
> **äºŒåˆ†æ‰¾ç•Œï¼Œå‰ç¼€å’ŒåŠ é€Ÿï¼Œæ»šåŠ¨çœç©ºé—´**ï¼Œä¸‰å¤§æ³•å®åœ¨æ‰‹ï¼Œæœ¨æ£åˆ†å‰²ä¸å†æ„ï¼

---
å¤„ç†ç”¨æ—¶ï¼š55.27ç§’
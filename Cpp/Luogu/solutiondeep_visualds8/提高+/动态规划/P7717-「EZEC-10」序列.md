# é¢˜ç›®ä¿¡æ¯

# ã€ŒEZEC-10ã€åºåˆ—

## é¢˜ç›®èƒŒæ™¯

> ç²¾å‡†çš„è§£æåˆ»ç”»ï¼Œæ˜¯åº”è¯¥é¦–å…ˆå°è¯•çš„çªç ´å£ã€‚

â€”â€”command_block ã€Šè€ƒå‰å°è´´å£«ã€‹

## é¢˜ç›®æè¿°

è¯·é—®æœ‰å¤šå°‘ä¸ªä¸åŒçš„åºåˆ— $a$ï¼Œæ»¡è¶³ï¼š
1. $a$ çš„é•¿åº¦ä¸º $n$ã€‚
2. $a$ ä¸­çš„å…ƒç´ å‡ä¸ºä¸å¤§äº $k$ çš„éè´Ÿæ•´æ•°ã€‚
3. æ»¡è¶³ $m$ ç»„å½¢å¦‚ $(x_i,y_i,z_i)$ ä¸” $x_i<y_i$ çš„é™åˆ¶ï¼Œæ¯ç»„é™åˆ¶çš„æ„ä¹‰ä¸º $a_{x_i} \oplus a_{y_i} = z_i$ ï¼ˆ$\oplus$ è¡¨ç¤ºæŒ‰ä½å¼‚æˆ–è¿ç®—ï¼‰ã€‚

ä¸¤ä¸ªåºåˆ—ç›¸åŒï¼Œå½“ä¸”ä»…å½“å®ƒä»¬æ‰€æœ‰å…ƒç´ å‡ç›¸åŒã€‚

è¯·è¾“å‡ºç­”æ¡ˆå¯¹ $10^9+7$ []($114514\times(114\times5\times14+((1+145)\times(1+4)+(1\times14+5-1+4)))+(114\times514+(11\times(451+4)+(-1+145+14)))$)å–æ¨¡çš„ç»“æœã€‚

## è¯´æ˜/æç¤º

ã€æ ·ä¾‹ $1$ è¯´æ˜ã€‘

å…±æœ‰ $6$ ç§åºåˆ—ï¼š$\{0,1,0\},\{0,1,1\},\{0,1,2\},\{1,0,0\},\{1,0,1\},\{1,0,2\}$ã€‚

ã€æ•°æ®è§„æ¨¡ä¸çº¦å®šã€‘

**æœ¬é¢˜é‡‡ç”¨æ†ç»‘æµ‹è¯•ã€‚**

- Subtask 1ï¼ˆ1 pointï¼‰ï¼š$n=1$ã€‚
- Subtask 2ï¼ˆ5 pointsï¼‰ï¼š$m=0$ã€‚
- Subtask 3ï¼ˆ15 pointsï¼‰ï¼š$n,m,k\le 5$ã€‚
- Subtask 4ï¼ˆ10 pointsï¼‰ï¼š$z_i=0$ã€‚
- Subtask 5ï¼ˆ20 pointsï¼‰ï¼š$k\le 16$ã€‚
- Subtask 6ï¼ˆ2 pointsï¼‰ï¼šæ•°æ®éšæœºã€‚
- Subtask 7ï¼ˆ47 pointsï¼‰ï¼šæ— ç‰¹æ®Šé™åˆ¶ã€‚

å¯¹äº $100\%$ çš„æ•°æ®ï¼Œ$1 \leq n \leq 5 \times 10^5$ï¼Œ$0 \le m \le 5 \times 10^5$ï¼Œ$0 \le z_i<2^{30}$ï¼Œ$1 \leq k< 2^{30}$ï¼Œ$1\le x_i,y_i\le n$ã€‚

ã€æç¤ºã€‘

å¦‚æœä½ ä¸çŸ¥é“ä»€ä¹ˆæ˜¯å¼‚æˆ–ï¼Œè¯·ç‚¹å‡»[è¿™é‡Œ](https://baike.baidu.com/item/%E5%BC%82%E6%88%96#:~:text=%E5%BC%82%E6%88%96%E4%B9%9F%E5%8F%AB%E5%8D%8A,%E8%AE%A4%E4%BD%9C%E4%B8%8D%E8%BF%9B%E4%BD%8D%E5%8A%A0%E6%B3%95%E3%80%82&text=%E7%A8%8B%E5%BA%8F%E4%B8%AD%E6%9C%89%E4%B8%89%E7%A7%8D%E6%BC%94%E7%AE%97%E5%AD%90%EF%BC%9AXOR%E3%80%81eor%E3%80%81%E2%8A%95%E3%80%82)ã€‚

## æ ·ä¾‹ #1

### è¾“å…¥

```
3 1 2
1 2 1```

### è¾“å‡º

```
6```

## æ ·ä¾‹ #2

### è¾“å…¥

```
5 1 12
1 2 3
```

### è¾“å‡º

```
26364```

# AIåˆ†æç»“æœ

# ğŸ’¡ æ´›è¯­äº‘ç¬ºçš„C++ç®—æ³•è§£æï¼šã€ŒEZEC-10ã€åºåˆ— æ·±å…¥å­¦ä¹ æŒ‡å— ğŸ’¡

> å„ä½å°‘å¹´æ¢é™©å®¶ä»¬ï¼Œä»Šå¤©æˆ‘ä»¬é¢å¯¹çš„æ˜¯ä¸€é“â€œçœ‹ä¼¼æšä¸¾ã€å®åˆ™å›¾è®ºã€æš—è—æ•°ä½â€çš„ä¸‰é‡åµŒå¥—è°œé¢˜ã€‚é¢˜ç›®è¦æ±‚æˆ‘ä»¬ç»Ÿè®¡æ»¡è¶³è‹¥å¹²â€œå¼‚æˆ–æ–¹ç¨‹â€çš„åºåˆ—ä¸ªæ•°ï¼Œè€ŒçœŸæ­£çš„é’¥åŒ™ï¼Œè—åœ¨**å›¾çš„è¿é€šæ€§**ä¸**01-Trie ä¸Šçš„æ•°ä½ DP**é‡Œã€‚å‡†å¤‡å¥½ä¸€èµ·æ‹†è§£è¿™åº§â€œå¼‚æˆ–è¿·å®«â€äº†å—ï¼Ÿ

---

## 1. é¢˜ç›®è§£è¯»ä¸ç­–ç•¥åˆæ¢

âœ¨ **æœ¬é¢˜æ ¸å¿ƒæŒ‘æˆ˜**ï¼š  
â€œç»™å®š n ä¸ªå˜é‡ã€è‹¥å¹²å½¢å¦‚ a[x] âŠ• a[y] = z çš„æ–¹ç¨‹ï¼Œæ±‚æ‰€æœ‰å˜é‡å–å€¼åœ¨ [0,k] å†…çš„åˆæ³•åºåˆ—æ•°ã€‚â€  
çœŸæ­£çš„éš¾ç‚¹åœ¨äºï¼š**æ–¹ç¨‹ä¹‹é—´äº’ç›¸ç‰µè¿**ï¼Œå½¢æˆ**æ— å‘å›¾ä¸Šçš„çº¦æŸ**ï¼›æˆ‘ä»¬éœ€è¦åœ¨ O(n log k) æ—¶é—´å†…ï¼Œå¯¹æ¯ä¸ªè¿é€šå—ç®—å‡ºâ€œæ ¹å˜é‡â€çš„å¯è¡Œå–å€¼ä¸ªæ•°ã€‚

âœ¨ **æ ¸å¿ƒç®—æ³•æ ‡ç­¾**ï¼šå›¾è®ºè¿é€šå— + 01-Trie + æ•°ä½ DPï¼ˆæ ‘ä¸Š DFSï¼‰

ğŸ—£ï¸ **æ€è·¯æ¼”è¿›è·¯å¾„**  
1. **æš´åŠ›æšä¸¾**ï¼ˆSubtask 3ï¼‰ï¼šO(kâ¿) ç›´æ¥çˆ†ç‚¸ã€‚  
2. **å›¾è®ºè½¬åŒ–**ï¼šæŠŠæ¯æ¡é™åˆ¶çœ‹æˆä¸€æ¡æ— å‘è¾¹ï¼Œx ä¸ y è¿è¾¹æƒ zã€‚  
3. **è¿é€šå—ç‹¬ç«‹**ï¼šæ¯ä¸ªè¿é€šå—åªéœ€ç¡®å®šä¸€ä¸ªâ€œæ ¹å˜é‡â€ï¼Œå…¶ä½™å˜é‡éšä¹‹ç¡®å®šã€‚  
4. **01-Trie ä¼˜åŒ–**ï¼šæŠŠè¿é€šå—å†…æ‰€æœ‰ç‚¹åˆ°æ ¹çš„å¼‚æˆ–å’Œä¸¢è¿› Trieï¼Œç”¨**æ•°ä½ DP**å¿«é€Ÿç»Ÿè®¡â€œæœ‰å¤šå°‘æ ¹å˜é‡ valï¼Œä½¿å¾— val âŠ• w â‰¤ k å¯¹æ‰€æœ‰ w æˆç«‹â€ã€‚

### ğŸ” ç®—æ³•ä¾¦æ¢ï¼šå¦‚ä½•åœ¨é¢˜ç›®ä¸­å‘ç°çº¿ç´¢ï¼Ÿ

| çº¿ç´¢ç¼–å· | å…³é”®è¯­å¥ | å¯¹åº”ç®—æ³•ä¿¡å· |
|---|---|---|
| 1 | â€œa[x] âŠ• a[y] = zâ€ | æ— å‘å›¾è¾¹æƒï¼›è¿é€šå—å†…å˜é‡äº’ç›¸çº¿æ€§è¡¨ç¤º |
| 2 | â€œæ±‚åºåˆ—ä¸ªæ•°â€ | ä¹˜æ³•åŸç†ï¼šå„è¿é€šå—æ–¹æ¡ˆæ•°ç›¸ä¹˜ |
| 3 | n,m â‰¤ 5Ã—10âµ | O(n log k) æ˜¯å¯è¡Œå¤æ‚åº¦ï¼Œæš—ç¤º**log k**çº§æ•°æ®ç»“æ„ |

### ğŸ§  æ€ç»´é“¾æ„å»ºï¼šä»çº¿ç´¢åˆ°ç­–ç•¥
> 1. çœ‹åˆ°â€œå¼‚æˆ–æ–¹ç¨‹â€ï¼Œæˆ‘ç«‹åˆ»æƒ³åˆ°**çº¿æ€§åŸº**æˆ–**å›¾ä¸Šçº¿æ€§å…³ç³»**ã€‚  
> 2. ä½†çº¿æ€§åŸºåªèƒ½åˆ¤æ˜¯å¦æœ‰è§£ï¼Œæ— æ³•è®¡æ•°ï¼›äºæ˜¯è½¬å‘**è¿é€šå—ç‹¬ç«‹**ã€‚  
> 3. æ¯ä¸ªè¿é€šå—å†…ï¼Œæ‰€æœ‰å˜é‡éƒ½å¯å†™æˆ `a[root] âŠ• path_xor`ï¼Œäºæ˜¯é—®é¢˜è½¬åŒ–ä¸ºï¼š  
>    **æœ‰å¤šå°‘ä¸ª val âˆˆ [0,k] æ»¡è¶³ val âŠ• w_i â‰¤ k å¯¹æ‰€æœ‰ w_i æˆç«‹ï¼Ÿ**  
> 4. è¿™æ­£æ˜¯**01-Trie ä¸Šæ•°ä½ DP**çš„ç»å…¸æ¨¡å‹ï¼Œå¤æ‚åº¦ O(log k) æ¯è¿é€šå—ã€‚  
> 5. ç»¼ä¸Šï¼Œç®—æ³•æ¡†æ¶ï¼š**å»ºå›¾ â†’ DFS åˆ¤ç¯ â†’ 01-Trie ç»Ÿè®¡ç­”æ¡ˆ**ã€‚

---

## 2. ç²¾é€‰ä¼˜è´¨é¢˜è§£å‚è€ƒ

> ä»¥ä¸‹é¢˜è§£å‡ â‰¥ 4 æ˜Ÿï¼Œé‡ç‚¹ç‚¹è¯„å…¶**å›¾è®ºå»ºæ¨¡ + Trie æ•°ä½ DP**çš„å®ç°äº®ç‚¹ã€‚

| é¢˜è§£æ¥æº | äº®ç‚¹æç‚¼ | ç‚¹è¯„ |
|---|---|---|
| lndjy (èµ 24) | æ¸…æ™°åˆ† Subtaskï¼Œæœ€ç»ˆç»™å‡º Trie DFS å…¬å¼åŒ–æ¨å¯¼ | æŠŠâ€œå¼‚æˆ–æœ€å¤§å€¼ â‰¤ kâ€æ‹†æˆ**ä¸‰ç§èŠ‚ç‚¹æƒ…å†µ**ï¼Œé€»è¾‘ä¸¥è°¨ã€‚ |
| ç»é¡¶æˆ‘ä¸ºå³° (èµ 12) | ç”¨â€œæ ¹å˜é‡ + å¼‚æˆ–è·¯å¾„â€ç»Ÿä¸€è¡¨ç¤ºï¼Œä»£ç ç®€æ´ | ä»£ç ä¸­ `query` å‡½æ•°**åŒæ—¶å¤„ç†é¡¶ä¸Šç•Œæ ‡è®°**ï¼ŒæŠ€å·§ä¼˜é›…ã€‚ |
| äº‘æµ…çŸ¥å¤„ (èµ 7) | ç”¨ `dis[i]` å­˜æ ¹åˆ° i çš„å¼‚æˆ–å’Œï¼ŒTrie èŠ‚ç‚¹å›æ”¶ | å±•ç¤º**è¿é€šå—ä¹‹é—´äº’ä¸å¹²æ‰°**çš„ä¹˜æ³•åŸç†å®ç°ã€‚ |
| lnwzy (èµ 12) | é€’å½’å‡½æ•° `update/ dfs2` å‘½åç›´è§‚ï¼Œæ³¨é‡Šä¸°å¯Œ | æŠŠ Trie éå†å†™æˆ**â€œå¡«æ•°é—¯å…³â€**ï¼Œé’å°‘å¹´å‹å¥½ã€‚ |

---

## 3. è§£é¢˜ç­–ç•¥æ·±åº¦å‰–æ

### ğŸ¯ æ ¸å¿ƒéš¾ç‚¹ä¸å…³é”®æ­¥éª¤ï¼ˆæœ€ä¼˜è§£æ³•ï¼‰

| å…³é”®ç‚¹ | åˆ†æ | ğŸ’¡ å­¦ä¹ ç¬”è®° |
|---|---|---|
| **1. å»ºå›¾ä¸åˆ¤ç¯** | æ¯æ¡é™åˆ¶ (x,y,z) è§†ä¸ºæ— å‘è¾¹ x â†” yï¼Œæƒ zã€‚DFS æ—¶è‹¥å‡ºç° `dis[u] ^ w != dis[v]` åˆ™æ— è§£ã€‚ | å¼‚æˆ–è·¯å¾„å…·æœ‰**å¯é€†æ€§**ï¼Œç¯ä¸Šå¼‚æˆ–å’Œå¿…é¡»ä¸º 0ã€‚ |
| **2. è¿é€šå—ç‹¬ç«‹ä¹˜æ³•** | ä¸åŒè¿é€šå—äº’ä¸å½±å“ï¼Œç­”æ¡ˆ = âˆ(è¿é€šå—å¯è¡Œæ ¹å˜é‡æ•°)ã€‚ | ä¹˜æ³•åŸç†æ˜¯**æ¨¡å—åŒ–æ€è€ƒ**çš„å…¸èŒƒã€‚ |
| **3. 01-Trie æ•°ä½ DP** | æŠŠå—å†…æ‰€æœ‰ `dis[i]` æ’å…¥ Trieï¼Œç„¶å DFSï¼šè‹¥å½“å‰ä½å¡« 0/1 åæœ€å¤§å€¼ä» â‰¤ kï¼Œåˆ™ç´¯åŠ æ–¹æ¡ˆã€‚ | å¤æ‚åº¦ O(log k) æ¯å—ï¼Œå¸¸æ•°æå°ã€‚ |

### âœ¨ è§£é¢˜æŠ€å·§æ€»ç»“
- **æŠ€å·§Aï¼šå›¾è®ºå»ºæ¨¡**â€”â€”æŠŠä»£æ•°æ–¹ç¨‹è½¬åŒ–ä¸ºå›¾è¾¹ï¼Œè¿é€šå—å³ç‹¬ç«‹å­é—®é¢˜ã€‚  
- **æŠ€å·§Bï¼šTrie ä¸Šæ•°ä½ DP**â€”â€”åˆ©ç”¨ä½ç‹¬ç«‹æ€§ï¼Œé€ä½å†³ç­–ï¼Œå‰ªææ— æ•ˆåˆ†æ”¯ã€‚  
- **æŠ€å·§Cï¼šç©ºé—´å›æ”¶**â€”â€”æ¯å¤„ç†å®Œä¸€ä¸ªè¿é€šå—ï¼Œæ¸…ç©º Trie èŠ‚ç‚¹ï¼Œé˜²æ­¢ MLEã€‚

### âš”ï¸ ç­–ç•¥ç«æŠ€åœºï¼šä¸åŒè§£æ³•å¯¹æ¯”

| ç­–ç•¥ | æ ¸å¿ƒæ€æƒ³ | ä¼˜ç‚¹ | ç¼ºç‚¹ | é€‚ç”¨åœºæ™¯ / å¾—åˆ† |
|---|---|---|---|---|
| **æš´åŠ›æšä¸¾** | æšä¸¾æ¯ä¸ªå˜é‡ 0..k | æ€è·¯ç›´è§‚ | O(kâ¿) çˆ†ç‚¸ | nâ‰¤5 ä¸” kâ‰¤5 |
| **å›¾è®º + æš´åŠ›æ ¹å€¼** | æ¯è¿é€šå—æšä¸¾æ ¹å˜é‡ 0..k | é€»è¾‘æ­£ç¡® | O(nk) æ— æ³•æ¥å— | kâ‰¤1e4 |
| **å›¾è®º + Trie æ•°ä½ DP**ï¼ˆæœ€ä¼˜ï¼‰ | ç”¨ Trie ç»Ÿè®¡å¯è¡Œæ ¹å€¼ | O(n log k) é€šè¿‡ | éœ€è¦æŒæ¡ Trie | 100% æ•°æ® |

### âœ¨ ä¼˜åŒ–ä¹‹æ—…ï¼šä»â€œèƒ½åšâ€åˆ°â€œåšå¥½â€
> 1. **èµ·ç‚¹ï¼šæš´åŠ›æšä¸¾**  
>    æˆ‘ä»¬å°è¯•æŠŠæ¯ä¸ªå˜é‡ä» 0 è¯•åˆ° kï¼Œä½†æŒ‡æ•°çº§çˆ†ç‚¸ã€‚  
> 2. **å‘ç°ç“¶é¢ˆï¼šé‡å¤çº¦æŸ**  
>    å˜é‡ä¹‹é—´å¹¶éç‹¬ç«‹ï¼Œæ–¹ç¨‹å½¢æˆ**çº¿æ€§å…³ç³»**ï¼Œåªéœ€ç¡®å®šä¸€ä¸ªæ ¹å˜é‡ã€‚  
> 3. **ä¼˜åŒ–é’¥åŒ™ï¼šå›¾è®º + Trie**  
>    æŠŠçº¿æ€§å…³ç³»è½¬åŒ–ä¸ºå›¾è·¯å¾„ï¼Œå†ç”¨ Trie åœ¨ log k æ—¶é—´å†…å®Œæˆâ€œæ ¹å˜é‡ç­›é€‰â€ã€‚  
> 4. **æ¨¡å‹å‡åï¼šè¿é€šå—ä¹˜æ³•**  
>    ä¸åŒè¿é€šå—äº’ä¸å¹²æ‰°ï¼Œç­”æ¡ˆç›´æ¥ç›¸ä¹˜ï¼Œæå¤§é™ä½å¤æ‚åº¦ã€‚

---

## 4. C++æ ¸å¿ƒä»£ç å®ç°èµæ

### æœ¬é¢˜é€šç”¨æ ¸å¿ƒC++å®ç°å‚è€ƒ
> ç»¼åˆå¤šä½ä½œè€…æ€è·¯ï¼Œæç‚¼å‡º**æœ€ç®€æ´ã€æ˜“è¯»**çš„å®Œæ•´æ¡†æ¶ã€‚

```cpp
#include <bits/stdc++.h>
using namespace std;
using int64 = long long;
const int64 MOD = 1e9 + 7;

struct Trie {
    int ch[500000 * 31][2], tot = 1;
    void clear() { tot = 1; ch[1][0] = ch[1][1] = 0; }
    void insert(int x) {
        int p = 1;
        for (int i = 30; i >= 0; --i) {
            int c = (x >> i) & 1;
            if (!ch[p][c]) {
                ch[++tot][0] = ch[tot][1] = 0;
                ch[p][c] = tot;
            }
            p = ch[p][c];
        }
    }
    int64 query(int p, int dep, int64 limit, int64 maxVal) {
        if (maxVal > limit) return 0;
        if (dep < 0) return 1;
        if (!ch[p][0] && !ch[p][1]) return 1;
        int64 res = 0;
        if (ch[p][0] && ch[p][1]) {
            int64 newMax = maxVal + (1LL << dep);
            if (newMax > limit) return 0;
            res += query(ch[p][0], dep - 1, limit, newMax);
            res += query(ch[p][1], dep - 1, limit, newMax);
        } else {
            int c = ch[p][0] ? 0 : 1;
            if (maxVal + (1LL << dep) <= limit) {
                res += (1LL << dep) % MOD;
                res += query(ch[p][c], dep - 1, limit, maxVal + (1LL << dep));
            } else {
                res += query(ch[p][c], dep - 1, limit, maxVal);
            }
        }
        return res % MOD;
    }
} trie;

const int N = 5e5 + 10;
vector<pair<int, int>> G[N];
int64 dis[N];
bool vis[N];

void dfs(int u, int64 d) {
    vis[u] = true;
    dis[u] = d;
    trie.insert(d);
    for (auto [v, w] : G[u]) {
        if (vis[v]) {
            if ((dis[v] ^ dis[u]) != w) {
                cout << 0 << '\n';
                exit(0);
            }
        } else {
            dfs(v, d ^ w);
        }
    }
}

int main() {
    ios::sync_with_stdio(false);
    cin.tie(nullptr);
    int n, m, k;
    cin >> n >> m >> k;
    for (int i = 1; i <= m; ++i) {
        int x, y, z;
        cin >> x >> y >> z;
        G[x].emplace_back(y, z);
        G[y].emplace_back(x, z);
    }
    int64 ans = 1;
    for (int i = 1; i <= n; ++i) {
        if (!vis[i]) {
            trie.clear();
            dfs(i, 0);
            ans = ans * trie.query(1, 30, k, 0) % MOD;
        }
    }
    cout << ans << '\n';
    return 0;
}
```

**ä»£ç è§£è¯»æ¦‚è¦**ï¼š  
- **å»ºå›¾**ï¼šæŠŠé™åˆ¶è½¬åŒ–ä¸ºæ— å‘è¾¹ã€‚  
- **DFS åˆ¤ç¯**ï¼šè‹¥å‘ç°çŸ›ç›¾ç«‹å³è¾“å‡º 0ã€‚  
- **Trie æ’å…¥**ï¼šæŠŠè¿é€šå—å†…æ‰€æœ‰ `dis[i]` æ’å…¥ Trieã€‚  
- **Trie æŸ¥è¯¢**ï¼š`query(p, dep, limit, maxVal)` è¡¨ç¤ºå½“å‰èŠ‚ç‚¹ã€å‰©ä½™ä½æ•°ã€æœ€å¤§å…è®¸å€¼ã€å½“å‰æœ€å¤§å€¼ï¼Œè¿”å›åˆæ³•æ ¹å˜é‡æ•°ã€‚

---

## 5. ç®—æ³•å¯è§†åŒ–ï¼šåƒç´ åŠ¨ç”»æ¼”ç¤º

### ä¸»é¢˜ï¼šåƒç´ æ¢é™©å®¶å‹‡é—¯â€œå¼‚æˆ–è¿·å®«â€
- **åœºæ™¯**ï¼š8Ã—8 åƒç´ ç½‘æ ¼ä»£è¡¨ 3 ä½äºŒè¿›åˆ¶ï¼ˆ0-7ï¼‰ï¼Œèµ·ç‚¹æ˜¯æ ¹å˜é‡ valã€‚  
- **äº¤äº’**ï¼š  
  - å·¦ä¾§æ˜¾ç¤º Trie æ ‘ï¼Œæ¯ä¸ªèŠ‚ç‚¹æ˜¯ 8Ã—8 åƒç´ æ–¹å—ï¼Œ0/1 è¾¹ç”¨çº¢/è“ç®­å¤´ã€‚  
  - å³ä¾§æ˜¾ç¤ºå½“å‰è¿é€šå—çš„â€œå¼‚æˆ–è·¯å¾„å€¼â€åˆ—è¡¨ã€‚  
- **åŠ¨ç”»æ­¥éª¤**ï¼š
  1. **æ’å…¥é˜¶æ®µ**ï¼šæ¯ä¸ª `dis[i]` åƒç¡¬å¸ä¸€æ ·è½å…¥ Trieï¼ŒèŠ‚ç‚¹é—ªçƒç»¿å…‰ã€‚  
  2. **æŸ¥è¯¢é˜¶æ®µ**ï¼šåƒç´ æ¢é™©å®¶ï¼ˆé»„è‰²æ–¹å—ï¼‰ä»æ ¹å‡ºå‘ï¼Œé€ä½é€‰æ‹© 0/1ï¼š  
     - è‹¥é€‰ 0 åæœ€å¤§å€¼ä» â‰¤ kï¼Œè·¯å¾„å˜ç»¿ï¼›å¦åˆ™å˜çº¢å¹¶å‰ªæã€‚  
  3. **éŸ³æ•ˆ**ï¼š  
     - æ’å…¥æˆåŠŸï¼šâ€œå®ï¼â€ï¼ˆ8-bit é«˜éŸ³ï¼‰ã€‚  
     - å‰ªæå¤±è´¥ï¼šâ€œå’šï¼â€ï¼ˆä½éŸ³ï¼‰ã€‚  
  4. **é€šå…³**ï¼šå½“æ¢é™©å®¶åˆ°è¾¾å¶å­ä¸”æœ€å¤§å€¼åˆæ³•ï¼Œå±å¹•å‡ºç°åƒç´ ç¤¼èŠ±â€œ+1â€ã€‚

---

## 6. æ‹“å±•ç»ƒä¹ ä¸ç›¸ä¼¼é—®é¢˜æ€è€ƒ

| é€šç”¨æŠ€å·§è¿ç§»åœºæ™¯ | è¯´æ˜ |
|---|---|
| **è¯¾ç¨‹å†²çª** | æ¯é—¨è¯¾åªèƒ½é€‰ä¸€æ¬¡ï¼Œç”¨åˆ†ç»„èƒŒåŒ…ã€‚ |
| **äº’æ–¥ä»»åŠ¡** | ä»»åŠ¡é—´æœ‰ä¾èµ–ï¼Œç”¨å›¾ + è¿é€šå—ç‹¬ç«‹è®¡æ•°ã€‚ |
| **æœ€å¤§å¼‚æˆ–é™åˆ¶** | ä¸ Trie æ•°ä½ DP ç±»ä¼¼ï¼Œå¦‚ P4551 æœ€å¤§å¼‚æˆ–è·¯å¾„ã€‚ |

### æ´›è°·æ¨è
1. **P4551** - æœ€å¤§å¼‚æˆ–è·¯å¾„  
   ğŸ—£ï¸ æ¨èç†ç”±ï¼šå·©å›º Trie + å¼‚æˆ–è·¯å¾„æ€æƒ³ã€‚  
2. **P3292** - å¹¸è¿æ•°å­—  
   ğŸ—£ï¸ æ¨èç†ç”±ï¼šæ•°ä½ DP åœ¨ Trie ä¸Šçš„ç»å…¸å˜å½¢ã€‚  
3. **P4151** - æœ€å¤§å¼‚æˆ–å’Œ  
   ğŸ—£ï¸ æ¨èç†ç”±ï¼šçº¿æ€§åŸºä¸ Trie çš„å¯¹æ¯”ç»ƒä¹ ã€‚  
4. **P5024** - ä¿å«ç‹å›½  
   ğŸ—£ï¸ æ¨èç†ç”±ï¼šå›¾è®ºè¿é€šå— + ä¹˜æ³•åŸç†çš„è¿›é˜¶åº”ç”¨ã€‚

---

## 7. å­¦ä¹ å¿ƒå¾—ä¸ç»éªŒåˆ†äº«

> å¤šä½ä½œè€…æåˆ°ï¼š**â€œæŠŠå¼‚æˆ–æ–¹ç¨‹çœ‹ä½œå›¾è¾¹â€**æ˜¯ç ´é¢˜å…³é”®ï¼›  
> è€Œ**â€œTrie ä¸Šæ•°ä½ DPâ€**åˆ™æ˜¯ä» O(nk) ä¼˜åŒ–åˆ° O(n log k) çš„çµé­‚è·³è·ƒã€‚  
> è°ƒè¯•æ—¶ï¼Œå¯æ‰“å°æ¯ä¸ªè¿é€šå—çš„ `dis[i]` åˆ—è¡¨ï¼Œå†æ‰‹æ¨¡ Trie æŸ¥è¯¢ï¼Œå¿«é€Ÿå®šä½é”™è¯¯ã€‚

---

<conclusion>
ä»Šå¤©æˆ‘ä»¬ç”¨**å›¾è®ºè¿é€šæ€§**+**01-Trie æ•°ä½ DP**çš„ç»„åˆæ‹³ï¼Œä¼˜é›…åœ°ç ´è§£äº†çœ‹ä¼¼æš´åŠ›çš„å¼‚æˆ–åºåˆ—è®¡æ•°ã€‚è®°ä½ï¼š  
- **æ–¹ç¨‹è½¬å›¾è¾¹**æ˜¯åŒ–ç¹ä¸ºç®€çš„ç¬¬ä¸€æ­¥ï¼›  
- **Trie é€ä½å†³ç­–**æ˜¯é«˜æ•ˆç»Ÿè®¡çš„ç»ˆææ­¦å™¨ã€‚  
ä¸‹æ¬¡å†é‡åˆ°â€œå¼‚æˆ–é™åˆ¶â€ï¼Œä¸å¦¨å…ˆç”»ä¸€å¼ å›¾ï¼Œå†è®©åƒç´ æ¢é™©å®¶èµ°è¿› Trie è¿·å®«ï¼
</conclusion>

---
å¤„ç†ç”¨æ—¶ï¼š75.62ç§’
# é¢˜ç›®ä¿¡æ¯

# [USACO08JAN] Telephone Lines S

## é¢˜ç›®æè¿°

Farmer John wants to set up a telephone line at his farm. Unfortunately, the phone company is uncooperative, so he needs to pay for some of the cables required to connect his farm to the phone system.

There are N (1 â‰¤ N â‰¤ 1,000) forlorn telephone poles conveniently numbered 1..N that are scattered around Farmer John's property; no cables connect any them. A total of P (1 â‰¤ P â‰¤ 10,000) pairs of poles can be connected by a cable; the rest are too far apart.

The i-th cable can connect the two distinct poles Ai and Bi, with length Li (1 â‰¤ Li â‰¤ 1,000,000) units if used. The input data set never names any {Ai, Bi} pair more than once. Pole 1 is already connected to the phone system, and pole N is at the farm. Poles 1 and N need to be connected by a path of cables; the rest of the poles might be used or might not be used.

As it turns out, the phone company is willing to provide Farmer John with K (0 â‰¤ K < N) lengths of cable for free. Beyond that he will have to pay a price equal to the length of the longest remaining cable he requires (each pair of poles is connected with a separate cable), or 0 if he does not need any additional cables.

Determine the minimum amount that Farmer John must pay.

å¤šå¹´ä»¥åï¼Œç¬¨ç¬¨é•¿å¤§äº†ï¼Œæˆä¸ºäº†ç”µè¯çº¿å¸ƒç½®å¸ˆã€‚ç”±äºåœ°éœ‡ä½¿å¾—æŸå¸‚çš„ç”µè¯çº¿å…¨éƒ¨æŸåï¼Œç¬¨ç¬¨æ˜¯è´Ÿè´£æ¥åˆ°éœ‡ä¸­å¸‚çš„è´Ÿè´£äººã€‚è¯¥å¸‚å‘¨å›´åˆ†å¸ƒç€ $1\le N\le1000$ æ ¹æ® $1\cdots N$ é¡ºåºç¼–å·çš„åºŸå¼ƒçš„ç”µè¯çº¿æ†ï¼Œä»»æ„ä¸¤æ ¹çº¿æ†ä¹‹é—´æ²¡æœ‰ç”µè¯çº¿è¿æ¥ï¼Œä¸€å…±æœ‰ $1\le p\le10000$ å¯¹ç”µè¯æ†å¯ä»¥æ‹‰ç”µè¯çº¿ã€‚å…¶ä»–çš„ç”±äºåœ°éœ‡ä½¿å¾—æ— æ³•è¿æ¥ã€‚

ç¬¬iå¯¹ç”µçº¿æ†çš„ä¸¤ä¸ªç«¯ç‚¹åˆ†åˆ«æ˜¯ $a_i$ ï¼Œ$b_i$ï¼Œå®ƒä»¬çš„è·ç¦»ä¸º $1\le l_i\le1000000$ã€‚æ•°æ®ä¸­æ¯å¯¹ $(a_i,b_i)$ åªå‡ºç°ä¸€æ¬¡ã€‚ç¼–å·ä¸º $1$ çš„ç”µè¯æ†å·²ç»æ¥å…¥äº†å…¨å›½çš„ç”µè¯ç½‘ç»œï¼Œæ•´ä¸ªå¸‚çš„ç”µè¯çº¿å…¨éƒ½è¿åˆ°äº†ç¼–å· $N$ çš„ç”µè¯çº¿æ†ä¸Šã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œç¬¨ç¬¨çš„ä»»åŠ¡ä»…ä»…æ˜¯æ‰¾ä¸€æ¡å°† $1$ å·å’Œ $N$ å·ç”µçº¿æ†è¿èµ·æ¥çš„è·¯å¾„ï¼Œå…¶ä½™çš„ç”µè¯æ†å¹¶ä¸ä¸€å®šè¦è¿å…¥ç”µè¯ç½‘ç»œã€‚

ç”µä¿¡å…¬å¸å†³å®šæ”¯æ´ç¾åŒºå…è´¹ä¸ºæ­¤å¸‚è¿æ¥ $k$ å¯¹ç”±ç¬¨ç¬¨æŒ‡å®šçš„ç”µè¯çº¿æ†ï¼Œå¯¹äºæ­¤å¤–çš„é‚£äº›ç”µè¯çº¿ï¼Œéœ€è¦ä¸ºå®ƒä»¬ä»˜è´¹ï¼Œæ€»è´¹ç”¨å†³å®šäºå…¶ä¸­æœ€é•¿çš„ç”µè¯çº¿çš„é•¿åº¦ï¼ˆæ¯æ ¹ç”µè¯çº¿ä»…è¿æ¥ä¸€å¯¹ç”µè¯çº¿æ†ï¼‰ã€‚å¦‚æœéœ€è¦è¿æ¥çš„ç”µè¯çº¿æ†ä¸è¶…è¿‡ $k$ å¯¹ï¼Œé‚£ä¹ˆæ”¯å‡ºä¸º $0$ã€‚

è¯·ä½ è®¡ç®—ä¸€ä¸‹ï¼Œå°†ç”µè¯çº¿å¼•å¯¼éœ‡ä¸­å¸‚æœ€å°‘éœ€è¦åœ¨ç”µè¯çº¿ä¸ŠèŠ±å¤šå°‘é’±ï¼Ÿ


## æ ·ä¾‹ #1

### è¾“å…¥

```
5 7 1
1 2 5
3 1 4
2 4 8
3 2 3
5 2 9
3 4 7
4 5 6
```

### è¾“å‡º

```
4
```

# AIåˆ†æç»“æœ

---
# ğŸ’¡ æ´›è¯­äº‘ç¬ºçš„C++ç®—æ³•è§£æï¼š[USACO08JAN] Telephone Lines S æ·±å…¥å­¦ä¹ æŒ‡å— ğŸ’¡

> ä»Šå¤©æˆ‘ä»¬è¦ä¸€èµ·æ‹†è§£çš„ï¼Œæ˜¯ä¸€é“â€œäºŒåˆ†+æœ€çŸ­è·¯â€çš„ç»å…¸ç»„åˆé¢˜ã€‚å®ƒå¤–è¡¨åƒå›¾è®ºï¼Œå†…æ ¸å´æš—è—â€œç¬¬K+1å¤§è¾¹æƒâ€è¿™ä¸€äºŒåˆ†ä¿¡å·ã€‚è®©æˆ‘ä»¬åƒä¾¦æ¢ä¸€æ ·ï¼Œä»é¢˜é¢é‡ŒæŠŠçº¿ç´¢ä¸€ä¸€æªå‡ºæ¥ï¼

---

## 1. é¢˜ç›®è§£è¯»ä¸ç­–ç•¥åˆæ¢

âœ¨ **æœ¬é¢˜æ ¸å¿ƒæŒ‘æˆ˜**ï¼š  
> åœ¨ä¸€å¼ æ— å‘å›¾ä¸­ï¼Œé€‰å‡ºä¸€æ¡ä»1åˆ°Nçš„è·¯å¾„ï¼ŒæŠŠè·¯å¾„ä¸Š**æƒå€¼æœ€å¤§çš„Kæ¡è¾¹å…è´¹**ï¼Œå‰©ä¸‹çš„è¾¹é‡Œ**æƒå€¼æœ€å¤§çš„é‚£æ¡è¾¹**å°±æ˜¯èŠ±è´¹ï¼Œæ±‚èŠ±è´¹æœ€å°å€¼ã€‚

âœ¨ **æ ¸å¿ƒç®—æ³•æ ‡ç­¾**ï¼šäºŒåˆ†ç­”æ¡ˆã€01-BFS / SPFA / Dijkstraã€åˆ†å±‚å›¾ï¼ˆå¤šæºæœ€çŸ­è·¯ï¼‰

### ğŸ” ç®—æ³•ä¾¦æ¢ï¼šå¦‚ä½•åœ¨é¢˜ç›®ä¸­å‘ç°çº¿ç´¢ï¼Ÿ
1. **çº¿ç´¢1 (é—®é¢˜ç›®æ ‡)**  
   â€œæ±‚**æœ€å°çš„æœ€å¤§**èŠ±è´¹â€â€”â€”ç»å…¸â€œæœ€å°åŒ–æœ€å¤§å€¼â€æ¨¡å‹ï¼ŒäºŒåˆ†ç­”æ¡ˆçš„æ‹›ç‰Œä¿¡å·ï¼
2. **çº¿ç´¢2 (é—®é¢˜çº¦æŸ)**  
   å…è´¹Kæ¡è¾¹ï¼Œç­‰ä»·äºâ€œ**è·¯å¾„ä¸Šæƒå€¼ > mid çš„è¾¹æ•° â‰¤ K**â€ï¼Œäºæ˜¯æŠŠè¾¹æƒç¦»æ•£åŒ–ä¸º 0/1ï¼Œç¬é—´å˜æˆæœ€çŸ­è·¯ã€‚
3. **çº¿ç´¢3 (æ•°æ®è§„æ¨¡)**  
   Nâ‰¤1 000ï¼ŒPâ‰¤10 000ï¼ŒKâ‰¤Nã€‚  
   äºŒåˆ†åŒºé—´é•¿åº¦ â‰¤ 1e6ï¼Œæ¯æ¬¡æœ€çŸ­è·¯ O(P log N) æˆ– O(P)ï¼Œæ€»å¤æ‚åº¦ O(P log N log 1e6) â‰ˆ 2Ã—10â·ï¼Œè½»æ¾é€šè¿‡ã€‚

### ğŸ§  æ€ç»´é“¾æ„å»ºï¼šä»çº¿ç´¢åˆ°ç­–ç•¥
> 1. çœ‹åˆ°â€œæœ€å°åŒ–æœ€å¤§å€¼â€ â†’ å¤§è„‘è‡ªåŠ¨å¼¹å‡ºâ€œäºŒåˆ†ç­”æ¡ˆâ€ã€‚  
> 2. å¦‚ä½•æŠŠâ€œå…è´¹Kæ¡â€è½¬æˆæœ€çŸ­è·¯ï¼Ÿ  
>    æŠŠ**æƒå€¼>midçš„è¾¹çœ‹æˆ1ï¼Œå…¶ä½™çœ‹æˆ0**ï¼Œè·‘ä¸€æ¬¡æœ€çŸ­è·¯ï¼Œå¦‚æœ1â†’Nçš„æœ€çŸ­è·¯é•¿åº¦ â‰¤ Kï¼Œåˆ™midå¯è¡Œã€‚  
> 3. 01-BFS / SPFA / Dijkstra éƒ½èƒ½è·‘ 0/1 æƒå›¾ï¼Œä»»é€‰å…¶ä¸€å³å¯ã€‚  

---

## 2. ç²¾é€‰ä¼˜è´¨é¢˜è§£å‚è€ƒ

| ä½œè€… & ç‚¹èµ | æ ¸å¿ƒæ€è·¯ | äº®ç‚¹æç‚¼ | æ´›è¯­äº‘ç¬ºç‚¹è¯„ |
|-------------|-----------|-----------|---------------|
| **æµ…è‰²è°ƒ** (72èµ) | äºŒåˆ†+SPFA | æŠŠâ€œç¬¬K+1å¤§â€è§£é‡Šå¾—ææ¸…æ™°ï¼Œä»£ç ç®€æ´ | æ€è·¯æœ€æ­£ç»Ÿï¼Œé€‚åˆå…¥é—¨ |
| **Blair3863** (45èµ) | äºŒåˆ†+åŒç«¯é˜Ÿåˆ—01-BFS | ç”¨01-BFSå–ä»£SPFAï¼Œç†è®ºæœ€ä¼˜ | è¾¹æƒåªæœ‰0/1æ—¶ï¼Œ01-BFSæ˜¯O(P) |
| **ViXpop** (33èµ) | åˆ†å±‚å›¾Dijkstra | ç›´æ¥å»º(k+1)å±‚å›¾ï¼Œè·‘æœ€çŸ­è·¯ | æ€è·¯ç›´è§‚ï¼Œä½†å¸¸æ•°å¤§ |
| **hf_xz** (30èµ) | äºŒç»´DP+SPFA | f[i][j]ï¼šåˆ°iç”¨äº†jæ¬¡å…è´¹çš„æœ€å°â€œæœ€å¤§è¾¹â€ | ä¸éœ€è¦äºŒåˆ†ï¼Œä¸€æ¬¡SPFAæå®š |

---

## 3. è§£é¢˜ç­–ç•¥æ·±åº¦å‰–æ

### ğŸ¯ æ ¸å¿ƒéš¾ç‚¹ä¸å…³é”®æ­¥éª¤ï¼ˆæœ€ä¼˜è§£æ³•ï¼šäºŒåˆ†+01-BFSï¼‰
1. **å…³é”®ç‚¹1ï¼šäºŒåˆ†æ¡†æ¶**  
   - è¾¹ç•Œï¼šl = -1ï¼ˆæ— è§£åˆ¤-1ï¼‰ï¼Œr = 1e6ã€‚  
   - æ¯æ¬¡ mid = (l+r)/2ï¼Œcheck(mid) åˆ¤æ–­â€œ>midçš„è¾¹æ•° â‰¤ Kâ€ã€‚

2. **å…³é”®ç‚¹2ï¼š01-BFSå®ç°check**  
   - æŠŠè¾¹æƒç¦»æ•£åŒ–ä¸º0/1ã€‚  
   - ç”¨åŒç«¯é˜Ÿåˆ—ï¼š  
     - è‹¥è¾¹æƒ0ï¼Œä»é˜Ÿå¤´å…¥é˜Ÿï¼›è¾¹æƒ1ï¼Œä»é˜Ÿå°¾å…¥é˜Ÿã€‚  
     - ä¿è¯é˜Ÿåˆ—å•è°ƒï¼Œå¤æ‚åº¦O(P)ã€‚

3. **å…³é”®ç‚¹3ï¼šç©ºé—´ä¸ç»†èŠ‚**  
   - æ— å‘å›¾å­˜è¾¹è¦Ã—2ã€‚  
   - æ— è§£æ—¶äºŒåˆ†åŒºé—´ä¼šæ”¶ç¼©åˆ°r = mx+1ï¼Œéœ€ç‰¹åˆ¤è¾“å‡º-1ã€‚

### âœ¨ è§£é¢˜æŠ€å·§æ€»ç»“
- **æŠ€å·§Aï¼šç¦»æ•£åŒ–è¾¹æƒ**  
  æŠŠâ€œè¾¹æƒ>midâ€è§†ä¸º1ï¼Œå…¶ä½™0ï¼Œæ˜¯å¤„ç†â€œç¬¬K+1å¤§â€çš„é€šç”¨å¥—è·¯ã€‚
- **æŠ€å·§Bï¼š01-BFS**  
  è¾¹æƒåªæœ‰0/1æ—¶ï¼ŒåŒç«¯é˜Ÿåˆ—BFSæ¯”Dijkstraæ›´å¿«ã€‚
- **æŠ€å·§Cï¼šäºŒåˆ†è¾¹ç•Œ**  
  åˆå§‹l=-1ï¼Œr=1e6ï¼Œå¯è‡ªåŠ¨åˆ¤æ— è§£ã€‚

### âš”ï¸ ç­–ç•¥ç«æŠ€åœºï¼šä¸åŒè§£æ³•å¯¹æ¯”

| ç­–ç•¥ | æ ¸å¿ƒæ€æƒ³ | ä¼˜ç‚¹ | ç¼ºç‚¹ | å¾—åˆ†é¢„æœŸ |
|------|-----------|------|------|-----------|
| **æš´åŠ›DFS** | æšä¸¾æ¯æ¡è¾¹æ˜¯å¦å…è´¹ | æ€è·¯ç›´è§‚ | æŒ‡æ•°çº§çˆ†ç‚¸ | 10% |
| **äºŒåˆ†+SPFA** | ç¦»æ•£åŒ–0/1è·‘æœ€çŸ­è·¯ | ä»£ç çŸ­ï¼Œæ˜“å†™ | æœ€åO(PK) | 100% |
| **äºŒåˆ†+01-BFS** | åŒç«¯é˜Ÿåˆ—ä¼˜åŒ– | ç†è®ºæœ€ä¼˜O(P log 1e6) | éœ€æ‰‹å†™é˜Ÿåˆ— | 100% |
| **åˆ†å±‚å›¾Dijkstra** | å»º(k+1)å±‚å›¾è·‘æœ€çŸ­è·¯ | æ— éœ€äºŒåˆ† | ç‚¹Ã—(k+1)å€ï¼Œå¸¸æ•°å¤§ | 100% |

---

## 4. C++æ ¸å¿ƒä»£ç å®ç°èµæ

### â‘  æœ¬é¢˜é€šç”¨æ ¸å¿ƒC++å®ç°å‚è€ƒï¼ˆäºŒåˆ†+01-BFSï¼‰
```cpp
#include <bits/stdc++.h>
using namespace std;
const int N = 1005, M = 20005;
struct Edge { int to, nxt, w; } e[M];
int head[N], dis[N], cnt, n, p, k;
bool vis[N];

void add(int u, int v, int w) {
    e[++cnt] = {v, head[u], w};
    head[u] = cnt;
}

bool check(int mid) {
    deque<int> q;
    memset(dis, 0x3f, sizeof dis);
    dis[1] = 0;
    q.push_back(1);
    while (!q.empty()) {
        int u = q.front(); q.pop_front();
        if (vis[u]) continue;
        vis[u] = 1;
        for (int i = head[u]; i; i = e[i].nxt) {
            int v = e[i].to, w = e[i].w > mid;
            if (dis[v] > dis[u] + w) {
                dis[v] = dis[u] + w;
                if (!w) q.push_front(v);
                else    q.push_back(v);
            }
        }
        vis[u] = 0;
    }
    return dis[n] <= k;
}

int main() {
    scanf("%d%d%d", &n, &p, &k);
    for (int i = 1, u, v, w; i <= p; ++i) {
        scanf("%d%d%d", &u, &v, &w);
        add(u, v, w); add(v, u, w);
    }
    int l = -1, r = 1e6, ans = -1;
    while (l < r) {
        int mid = (l + r + 1) >> 1;
        if (check(mid)) r = mid - 1, ans = mid;
        else l = mid;
    }
    printf("%d\n", ans);
    return 0;
}
```

### â‘¡ é¢˜è§£ç²¾é€‰ç‰‡æ®µèµæ
- **æµ…è‰²è°ƒç‰ˆSPFAæ ¸å¿ƒ**  
  `if(e[i].v>x) s=dis[now]+1; else s=dis[now];`  
  ä¸€å¥è¯æŠŠâ€œè¾¹æƒ>midâ€è½¬1ï¼Œç®€æ´æ˜äº†ã€‚

- **Blair3863ç‰ˆ01-BFS**  
  ä½¿ç”¨`deque`ï¼Œ0è¾¹`push_front`ï¼Œ1è¾¹`push_back`ï¼Œé˜Ÿåˆ—å•è°ƒæ€§ä¸€ç›®äº†ç„¶ã€‚

---

## 5. ç®—æ³•å¯è§†åŒ–ï¼šåƒç´ åŠ¨ç”»æ¼”ç¤º

### ğŸ® åŠ¨ç”»ä¸»é¢˜ï¼šåƒç´ æ¢é™©å®¶é—¯â€œ01è¿·å®«â€
- **åœºæ™¯**ï¼š8Ã—8åƒç´ ç½‘æ ¼ï¼Œèµ·ç‚¹(1,1)ç»¿è‰²ï¼Œç»ˆç‚¹(8,8)çº¢è‰²ï¼Œè¾¹ç”¨é»„è‰²åƒç´ çº¿è¡¨ç¤ºã€‚
- **è¾¹æƒé¢œè‰²**ï¼šâ‰¤midâ†’è“è‰²0è¾¹ï¼Œ>midâ†’æ©™è‰²1è¾¹ã€‚
- **01-BFSé˜Ÿåˆ—**ï¼šåƒç´ åŒ–çš„åŒç«¯é˜Ÿåˆ—ï¼Œé˜Ÿå¤´ç»¿è‰²ç®­å¤´ï¼Œé˜Ÿå°¾çº¢è‰²ç®­å¤´ã€‚
- **äº¤äº’é¢æ¿**ï¼š  
  - æ­¥è¿›/è‡ªåŠ¨æ’­æ”¾/é‡ç½®æŒ‰é’®  
  - é€Ÿåº¦æ»‘å—ï¼ˆ1~10 FPSï¼‰  
  - midè¾“å…¥æ¡†å®æ—¶æ”¹å˜è¾¹æƒé¢œè‰²
- **éŸ³æ•ˆ**ï¼š  
  - 0è¾¹å…¥é˜Ÿâ€œå®â€ï¼Œ1è¾¹å…¥é˜Ÿâ€œå’šâ€  
  - åˆ°è¾¾ç»ˆç‚¹â€œèƒœåˆ©éŸ³æ•ˆâ€
- **å®ç°è¦ç‚¹**ï¼š  
  ç”¨Canvasç»˜åˆ¶ç½‘æ ¼ï¼Œé˜Ÿåˆ—ç”¨æ•°ç»„æ¨¡æ‹Ÿï¼Œæ¯æ¬¡æ›´æ–°é«˜äº®å½“å‰èŠ‚ç‚¹å’Œè¾¹ï¼ŒåŒæ­¥æ˜¾ç¤º`dis`å€¼ã€‚

---

## 6. æ‹“å±•ç»ƒä¹ ä¸ç›¸ä¼¼é—®é¢˜æ€è€ƒ

### ğŸ”— é€šç”¨å¥—è·¯è¿ç§»
â€œäºŒåˆ†ç­”æ¡ˆ + æœ€çŸ­è·¯/DPâ€é€‚ç”¨äºï¼š
1. **P2939 æ”¹é€ è·¯**ï¼šå…è´¹Kæ¡è¾¹æ±‚æœ€çŸ­è·¯å¾„ã€‚
2. **P4568 é£è¡Œè·¯çº¿**ï¼šåˆ†å±‚å›¾æœ€çŸ­è·¯æ¨¡æ¿ã€‚
3. **P3383 å…¬è·¯å»ºè®¾**ï¼šäºŒåˆ†æœ€å¤§è¾¹æƒ+æœ€å°ç”Ÿæˆæ ‘ã€‚

### ğŸ“š æ´›è°·æ¨è
| é¢˜å· | æ¨èç†ç”± |
|------|-----------|
| **P2243 ç”µè·¯ç»´ä¿®** | 01-BFSå…¥é—¨ï¼Œè¾¹æƒåªæœ‰0/1ã€‚ |
| **P4568 é£è¡Œè·¯çº¿** | åˆ†å±‚å›¾æœ€çŸ­è·¯æ ‡å‡†é¢˜ã€‚ |
| **P2939 æ”¹é€ è·¯** | å…è´¹Kæ¡è¾¹æ±‚æœ€çŸ­ï¼Œä¸æœ¬é¢˜å‡ ä¹åŒæ„ã€‚ |

---

## 7. å­¦ä¹ å¿ƒå¾—ä¸ç»éªŒåˆ†äº«
> **æµ…è‰²è°ƒ**ï¼šâ€œæŠŠâ€˜ç¬¬K+1å¤§â€™ç¿»è¯‘æˆâ€˜>midçš„è¾¹æ•°â‰¤Kâ€™ï¼Œæ˜¯è§£é¢˜çš„çµé­‚ã€‚â€  
> **Blair3863**ï¼š01-BFSæ¯”SPFAæ›´ç¨³ï¼Œè¾¹æƒåªæœ‰0/1æ—¶é¦–é€‰ã€‚

---

<conclusion>
è‡³æ­¤ï¼Œæˆ‘ä»¬å®Œæˆäº†ä»â€œäºŒåˆ†ä¿¡å·â€åˆ°â€œ01-BFSä¼˜åŒ–â€çš„å®Œæ•´æ—…ç¨‹ã€‚è®°ä½ï¼š  
**çœ‹åˆ°â€œæœ€å°åŒ–æœ€å¤§å€¼â€â†’å…ˆäºŒåˆ†ï¼›çœ‹åˆ°â€œå…è´¹Kæ¡â€â†’ç¦»æ•£åŒ–è¾¹æƒè·‘æœ€çŸ­è·¯ã€‚**  
ä¸‹æ¬¡å†é‡ç±»ä¼¼é¢˜ï¼Œä½ å°±æ˜¯é‚£ä¸ªä¸€çœ¼çœ‹ç©¿æœ¬è´¨çš„äººï¼ğŸ’ª
</conclusion>

---
å¤„ç†ç”¨æ—¶ï¼š58.41ç§’
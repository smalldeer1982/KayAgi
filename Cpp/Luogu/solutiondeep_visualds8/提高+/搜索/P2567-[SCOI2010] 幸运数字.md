# é¢˜ç›®ä¿¡æ¯

# [SCOI2010] å¹¸è¿æ•°å­—

## é¢˜ç›®èƒŒæ™¯

å››å· NOI çœé€‰ 2010ã€‚


## é¢˜ç›®æè¿°

åœ¨ä¸­å›½ï¼Œå¾ˆå¤šäººéƒ½æŠŠ $6$ å’Œ $8$ è§†ä¸ºæ˜¯å¹¸è¿æ•°å­—ï¼lxhgww ä¹Ÿè¿™æ ·è®¤ä¸ºï¼Œäºæ˜¯ä»–å®šä¹‰è‡ªå·±çš„â€œå¹¸è¿å·ç â€æ˜¯åè¿›åˆ¶è¡¨ç¤ºä¸­åªåŒ…å«æ•°å­— $6$ å’Œ $8$ çš„é‚£äº›å·ç ï¼Œæ¯”å¦‚ $68$ï¼Œ$666$ï¼Œ$888$ éƒ½æ˜¯â€œå¹¸è¿å·ç â€ï¼ä½†æ˜¯è¿™ç§â€œå¹¸è¿å·ç â€æ€»æ˜¯å¤ªå°‘äº†ï¼Œæ¯”å¦‚åœ¨ $[1,100]$ çš„åŒºé—´å†…å°±åªæœ‰ $6$ ä¸ªï¼ˆ$6$ï¼Œ$8$ï¼Œ$66$ï¼Œ$68$ï¼Œ$86$ï¼Œ$88$ï¼‰ï¼Œäºæ˜¯ä»–åˆå®šä¹‰äº†ä¸€ç§â€œè¿‘ä¼¼å¹¸è¿å·ç â€ã€‚lxhgww è§„å®šï¼Œå‡¡æ˜¯â€œå¹¸è¿å·ç â€çš„å€æ•°éƒ½æ˜¯â€œè¿‘ä¼¼å¹¸è¿å·ç â€ï¼Œå½“ç„¶ï¼Œä»»ä½•çš„â€œå¹¸è¿å·ç â€ä¹Ÿéƒ½æ˜¯â€œè¿‘ä¼¼å¹¸è¿å·ç â€ï¼Œæ¯”å¦‚ $12$ï¼Œ$16$ï¼Œ$666$ éƒ½æ˜¯â€œè¿‘ä¼¼å¹¸è¿å·ç â€ã€‚

ç°åœ¨ lxhgww æƒ³çŸ¥é“åœ¨ä¸€æ®µé—­åŒºé—´ $[a, b]$ å†…ï¼Œâ€œè¿‘ä¼¼å¹¸è¿å·ç â€çš„ä¸ªæ•°ã€‚

## è¯´æ˜/æç¤º

å¯¹äº $30\%$ çš„æ•°æ®ï¼Œä¿è¯ $1\le a\le b\le10^6$ã€‚

å¯¹äº $100\%$ çš„æ•°æ®ï¼Œä¿è¯ $1\le a\le b\le10^{10}$ã€‚


## æ ·ä¾‹ #1

### è¾“å…¥

```
1 10```

### è¾“å‡º

```
2```

# AIåˆ†æç»“æœ

```markdown
# ğŸ’¡ æ´›è¯­äº‘ç¬ºçš„C++ç®—æ³•è§£æï¼š  
SCOI2010ã€Šå¹¸è¿æ•°å­—ã€‹æ·±å…¥å­¦ä¹ æŒ‡å— ğŸ’¡

> ä»Šå¤©æˆ‘ä»¬ä¸€èµ·æ‹†è§£ä¸€é“â€œçœ‹ä¼¼ç„å­¦ã€å®åˆ™ä¼˜é›…â€çš„æ•°ä½-å®¹æ–¥ç»¼åˆé¢˜ã€‚  
> åªè¦æŠ“ä½â€œå¹¸è¿æ•°å­— â†’ å€æ•° â†’ å®¹æ–¥â€è¿™æ¡ä¸»çº¿ï¼Œå°±èƒ½æŠŠ 10Â¹â° çš„åºå¤§æ•°æ®èŒƒå›´ç©å¼„äºè‚¡æŒä¹‹é—´ï¼

---

## 1. é¢˜ç›®è§£è¯»ä¸ç­–ç•¥åˆæ¢

âœ¨ **æ ¸å¿ƒæŒ‘æˆ˜**  
> åœ¨ [a, b] åŒºé—´ï¼ˆ1 â‰¤ a â‰¤ b â‰¤ 10Â¹â°ï¼‰å†…ç»Ÿè®¡â€œè¿‘ä¼¼å¹¸è¿å·ç â€ä¸ªæ•°ã€‚  
> è¿‘ä¼¼å¹¸è¿å·ç  = ä»…å«æ•°å­— 6 æˆ– 8 çš„â€œå¹¸è¿æ•°å­—â€çš„æ‰€æœ‰å€æ•°ï¼ˆå«è‡ªèº«ï¼‰ã€‚

âœ¨ **æ ¸å¿ƒç®—æ³•æ ‡ç­¾**  
`å®¹æ–¥åŸç†`â€ƒ`DFS å‰ªæ`â€ƒ`å»é‡ä¼˜åŒ–`â€ƒ`__int128 / æµ®ç‚¹é˜²æº¢å‡º`

### ğŸ—£ï¸ æ€è·¯æ¦‚è§ˆï¼ˆç”±æœ´ç´ åˆ°ç²¾å¦™ï¼‰
1. æœ´ç´ æšä¸¾ï¼šé€ä¸ªæ£€æŸ¥åŒºé—´å†…æ¯ä¸ªæ•° â†’ æ—¶é—´ O(b) çˆ†ç‚¸ã€‚  
2. å€æ•°ç»Ÿè®¡ï¼šå…ˆæšä¸¾æ‰€æœ‰å¹¸è¿æ•°å­— Xï¼Œå†ç®— [a,b] å†… X çš„å€æ•°ä¸ªæ•° â†’ éœ€è¦å¤„ç†â€œäº¤é›†â€å³å®¹æ–¥ã€‚  
3. å®¹æ–¥ + å‰ªæï¼š  
   - é¢„ç”Ÿæˆæ‰€æœ‰ â‰¤ b çš„å¹¸è¿æ•°å­—ï¼ˆDFS/BFSï¼‰ã€‚  
   - å»æ‰â€œè¢«å…¶å®ƒå¹¸è¿æ•°å­—æ•´é™¤â€çš„å†—ä½™æ•°å­—ã€‚  
   - ç”¨ DFS æšä¸¾å¹¸è¿æ•°å­—å­é›†ï¼Œå®æ—¶è®¡ç®— LCM å¹¶å‰ªæã€‚  
4. åˆ†å—æ‰“è¡¨ï¼ˆè¿›é˜¶ï¼‰ï¼šæŠŠåŒºé—´åˆ‡æˆå—ï¼Œç¦»çº¿é¢„å¤„ç†ï¼Œåœ¨çº¿æŸ¥è¡¨ã€‚

### ğŸ” ç®—æ³•ä¾¦æ¢ï¼šå¦‚ä½•åœ¨é¢˜ç›®ä¸­å‘ç°çº¿ç´¢ï¼Ÿ
| çº¿ç´¢ | ä¾¦æ¢ç¬”è®° |
|---|---|
| **é—®é¢˜ç›®æ ‡** | åŒºé—´è®¡æ•° â†’ å€æ•°è®¡æ•° â†’ å®¹æ–¥åŸç† |
| **æ•°æ®èŒƒå›´** | 10Â¹â° â†’ O(b) ä¸å¯è¡Œ â†’ å¿…é¡»â€œæšä¸¾æ•°å­—è€Œéæšä¸¾åŒºé—´â€ |
| **æ•°å­—ç‰¹å¾** | ä»…å« 6/8 â†’ æ•°ä½ DFS ç”Ÿæˆï¼Œæ•°é‡ â‰ˆ 2Â¹Â¹ = 2046 ä¸ªï¼Œå¯æ¥å— |
| **å€æ•°å…³ç³»** | è‹¥ X | Yï¼Œåˆ™ Y çš„å€æ•°ä¸€å®šè¢« X è¦†ç›– â†’ å»æ‰ Y ä¸å½±å“ç­”æ¡ˆ |

### ğŸ§  æ€ç»´é“¾æ„å»º
> â€œå…ˆæŠŠæ‰€æœ‰â€˜å¹¸è¿æ•°å­—â€™æŠ“å‡ºæ¥ï¼Œå†å»æ‰â€˜è¢«è¦†ç›–â€™çš„ï¼Œ  
> æœ€åç”¨å®¹æ–¥ç»Ÿè®¡å®ƒä»¬çš„å€æ•°äº¤é›†â€”â€”è¿™å°±æ˜¯åŒ–ç¹ä¸ºç®€çš„é’¥åŒ™ã€‚â€

---

## 2. ç²¾é€‰ä¼˜è´¨é¢˜è§£å‚è€ƒ

| ä½œè€… | äº®ç‚¹æç‚¼ |
|---|---|
| **yybyyb**ï¼ˆ69ğŸ‘ï¼‰ | æå‡ºâ€œ> r/3 çš„å¹¸è¿æ•°å­—å•ç‹¬å¤„ç†â€è¿™ä¸€ç²¾å¦™å‰ªæï¼›ä»£ç çŸ­å°ç²¾æ‚ã€‚ |
| **xyz32768**ï¼ˆ39ğŸ‘ï¼‰ | æ¨¡æ¿åŒ– DFS ç”Ÿæˆ + å»é‡ + é™åºæ’åºï¼Œæ€è·¯æ¸…æ™°ï¼Œé€‚åˆåˆå­¦ã€‚ |
| **critnos**ï¼ˆ35ğŸ‘ï¼‰ | æ¼”ç¤ºâ€œåˆ†å—æ‰“è¡¨â€é»‘ç§‘æŠ€ï¼šç¦»çº¿ç­›åŒºé—´å—ï¼Œåœ¨çº¿ O(1) æŸ¥è¯¢ï¼Œå®æˆ˜åˆ©å™¨ã€‚ |
| **pengzy___**ï¼ˆ5ğŸ‘ï¼‰ | å®Œæ•´å±•ç¤º __int128 é˜²æº¢å‡ºæŠ€å·§ï¼›æ³¨é‡Šè¯¦å°½ï¼Œè°ƒè¯•å¿ƒå¾—ä¸°å¯Œã€‚ |

---

## 3. è§£é¢˜ç­–ç•¥æ·±åº¦å‰–æ

### ğŸ¯ æ ¸å¿ƒéš¾ç‚¹ä¸å…³é”®æ­¥éª¤
| å…³é”®ç‚¹ | åˆ†æ | å­¦ä¹ ç¬”è®° |
|---|---|---|
| **1. ç”Ÿæˆå¹¸è¿æ•°å­—** | ç”¨ 6/8 åšâ€œå­—ç¬¦é›†â€è¿›è¡Œ 0-1 Trie/DFSï¼Œé•¿åº¦ â‰¤ 11 ä½å³å¯ | DFS é€’å½’ï¼š`dfs(x) { if(x>b) return; a[++cnt]=x; dfs(x*10+6); dfs(x*10+8); }` |
| **2. å»é‡ä¼˜åŒ–** | è‹¥ a[i] | a[j]ï¼Œåˆ™åˆ æ‰è¾ƒå¤§çš„ a[j] | æ’åºååŒé‡å¾ªç¯æˆ–æ ‡è®°æ•°ç»„ O(nÂ²) å³å¯ï¼Œnâ‰ˆ2046 |
| **3. å®¹æ–¥ DFS** | æšä¸¾å­é›† + è®¡ç®— LCMï¼Œå®æ—¶å‰ªæ `if(lcm>b) return;` | é™åºæ’åºå¹¸è¿æ•°å­— â†’ æ›´å¿«è§¦å‘å‰ªæ |
| **4. æº¢å‡ºå¤„ç†** | LCM å¯èƒ½çˆ† long long â†’ ç”¨ `__int128` æˆ–å…ˆè½¬æµ®ç‚¹æ¯”è¾ƒ | `if(1.0*lcm*a[i] > b) return;` |

### âœ¨ è§£é¢˜æŠ€å·§æ€»ç»“
- **é—®é¢˜è½¬åŒ–**ï¼šæŠŠåŒºé—´è®¡æ•° â†’ å€æ•°è®¡æ•° â†’ å®¹æ–¥å­é›†ã€‚  
- **å‰ªæè‰ºæœ¯**ï¼š  
  - æ•°å€¼å‰ªæï¼šlcm>b ç«‹å³é€€å‡ºã€‚  
  - è§„æ¨¡å‰ªæï¼š>r/2 æˆ– >r/3 çš„å¹¸è¿æ•°å­—å•ç‹¬å¤„ç†ã€‚  
- **æ•°æ®ç»“æ„**ï¼švector å­˜å¹¸è¿æ•°å­—ï¼Œç®€å•é«˜æ•ˆï¼›__int128 é˜²æº¢å‡ºã€‚

### âš”ï¸ ç­–ç•¥ç«æŠ€åœº
| ç­–ç•¥ | æ—¶é—´å¤æ‚åº¦ | ä¼˜ç‚¹ | ç¼ºç‚¹ | å¾—åˆ†é¢„æœŸ |
|---|---|---|---|---|
| æš´åŠ›æšä¸¾ | O(b) | æ€è·¯ç›´è§‚ | 10Â¹â° çˆ†ç‚¸ | 10% |
| å®¹æ–¥ + å‰ªæ | O(2â¿) (nâ‰ˆ900) | é€šç”¨ã€å¥½å†™ | æœ€åä»å¯èƒ½ TLE | 100% |
| åˆ†å—æ‰“è¡¨ | O(b/blocks + 2â¿) | æœ€é€Ÿé€šå…³ | éœ€è¦ç¦»çº¿é¢„å¤„ç† | 100% |

---

## 4. C++æ ¸å¿ƒä»£ç å®ç°èµæ

### æœ¬é¢˜é€šç”¨æ ¸å¿ƒå‚è€ƒï¼ˆæ•´åˆç‰ˆï¼‰
```cpp
#include <bits/stdc++.h>
using namespace std;
typedef long long ll;
const ll MAX = 1e10;

ll a, b;
vector<ll> num;

/* 1. ç”Ÿæˆæ‰€æœ‰å¹¸è¿æ•°å­— */
void dfsGen(ll x) {
    if (x > b) return;
    if (x) num.push_back(x);
    dfsGen(x * 10 + 6);
    dfsGen(x * 10 + 8);
}

/* 2. å»é‡ï¼šå»æ‰èƒ½è¢«å…¶ä»–å¹¸è¿æ•°å­—æ•´é™¤çš„æ•° */
void uniqueLucky() {
    vector<ll> tmp;
    sort(num.begin(), num.end());
    for (size_t i = 0; i < num.size(); ++i) {
        bool ok = true;
        for (size_t j = 0; j < i; ++j)
            if (num[i] % num[j] == 0) { ok = false; break; }
        if (ok) tmp.push_back(num[i]);
    }
    num.swap(tmp);
    sort(num.rbegin(), num.rend());   // é™åºåŠ é€Ÿå‰ªæ
}

/* 3. å®¹æ–¥ DFS */
ll ans;
void dfsInc(int pos, ll lcm, int cnt) {
    if (lcm > b) return;
    if (pos == (int)num.size()) {
        if (cnt == 0) return;
        ll delta = b / lcm - (a - 1) / lcm;
        ans += (cnt & 1) ? delta : -delta;
        return;
    }
    dfsInc(pos + 1, lcm, cnt);
    ll g = __gcd(lcm, num[pos]);
    if (1.0 * lcm / g * num[pos] <= 1.0 * b)
        dfsInc(pos + 1, lcm / g * num[pos], cnt + 1);
}

ll solve() {
    dfsGen(0);
    uniqueLucky();
    ans = 0;
    dfsInc(0, 1, 0);
    return ans;
}

int main() {
    cin >> a >> b;
    cout << solve() << endl;
    return 0;
}
```

### ä»£ç ç‰‡æ®µèµæ
- **å»é‡å¾ªç¯**ï¼ˆxyz32768ï¼‰ï¼š  
  ```cpp
  for(int i=1;i<=cnt;i++)
      for(int j=i+1;j<=cnt;j++)
          if(num[j]%num[i]==0) mark[j]=true;
  ```
  ç®€æ´åŒé‡å¾ªç¯å®Œæˆâ€œç­›å€â€ä»»åŠ¡ã€‚

- **__int128 é˜²æº¢å‡º**ï¼ˆpengzy___ï¼‰ï¼š  
  ```cpp
  __int128 gcd=GCD(lcm,v[pos]);
  if(lcm/gcd*v[pos]<=x) ...
  ```
  ä¿è¯ä¸­é—´ä¹˜æ³•ä¸æº¢å‡ºã€‚

---

## 5. ç®—æ³•å¯è§†åŒ–ï¼šåƒç´ åŠ¨ç”»æ¼”ç¤º

### ä¸»é¢˜
â€œåƒç´ æ¢é™©å®¶â€åœ¨ 8 ä½æœºä¸–ç•Œå¯»æ‰¾â€œå¹¸è¿å€æ•°å­—ç¬¦â€ï¼

### åœºæ™¯è®¾å®š
- å±å¹•ï¼šå¤å¤ 256Ã—144 åƒç´ ç”»å¸ƒã€‚  
- å…ƒç´ ï¼š  
  - å¹¸è¿æ•°å­— â†’ ç»¿è‰²åƒç´ å—ï¼Œå¸¦æ•°å­— 6/8ã€‚  
  - LCM è®¡ç®— â†’ è“è‰²èƒ½é‡æ¡é€æ¸å¡«æ»¡ã€‚  
  - å‰ªæè§¦å‘ â†’ çº¢è‰²â€œXâ€é—ªçƒå¹¶æ’­æ”¾â€œå®â€éŸ³æ•ˆã€‚

### äº¤äº’æ§åˆ¶
- **å•æ­¥/è‡ªåŠ¨**ï¼šFamicom æ‰‹æŸ„æŒ‰é’®å›¾æ ‡ã€‚  
- **é€Ÿåº¦æ»‘å—**ï¼šåƒç´ é£æ ¼â€œFAST / SLOWâ€ã€‚  
- **ä¿¡æ¯é¢æ¿**ï¼šå½“å‰å­é›†ã€LCM å€¼ã€å·²å‰ªææ¬¡æ•°ã€‚

### å…³é”®å¸§ç¤ºä¾‹
1. ç”Ÿæˆé˜¶æ®µï¼šDFS æ ‘å½¢å±•å¼€ï¼Œç»¿è‰²å—é€å±‚å‡ºç°ã€‚  
2. å»é‡é˜¶æ®µï¼šè¢«æ•´é™¤çš„å—å˜çº¢å¹¶æ¶ˆå¤±ã€‚  
3. å®¹æ–¥é˜¶æ®µï¼š  
   - æ¯é€‰/ä¸é€‰ä¸€ä¸ªå¹¸è¿æ•°å­— â†’ å·¦å³ä¸¤æ¡è·¯å¾„å¹¶è¡Œã€‚  
   - è·¯å¾„ä¸Š LCM å€¼å®æ—¶æ›´æ–°ï¼Œ>b ç«‹å³é—ªçº¢å¹¶å‰ªæ‰ã€‚  
4. ç»“æœï¼šåŒºé—´ [a,b] å†…æ‰€æœ‰â€œè¿‘ä¼¼å¹¸è¿â€æ•°å­—é«˜äº®é‡‘è‰²ï¼Œæ’­æ”¾èƒœåˆ©éŸ³æ•ˆã€‚

---

## 6. æ‹“å±•ç»ƒä¹ ä¸ç›¸ä¼¼é—®é¢˜æ€è€ƒ

### é€šç”¨æŠ€å·§è¿ç§»
| åœºæ™¯ | å¦‚ä½•å¥—ç”¨ |
|---|---|
| åŒºé—´ç»Ÿè®¡â€œåªå« 1/3/9â€çš„å€æ•° | åŒæ ·ç”Ÿæˆ â†’ å»é‡ â†’ å®¹æ–¥ |
| æ±‚ [L,R] å†…èƒ½è¢«è‡³å°‘ä¸€ä¸ªç»™å®šç´ æ•°æ•´é™¤çš„æ•° | æŠŠâ€œå¹¸è¿æ•°å­—â€æ¢æˆç´ æ•°é›†åˆå³å¯ |
| æ•°ä½ DP + å®¹æ–¥æ··åˆé¢˜ | å…ˆç”¨æ•°ä½ DP ç”Ÿæˆæ»¡è¶³æ¡ä»¶çš„æ•°ï¼Œå†åšå®¹æ–¥ |

### æ´›è°·æ¨è
- **P1835** â€“ åŒºé—´èƒ½è¢«ç»™å®šé›†åˆæ•´é™¤çš„æ•°çš„ä¸ªæ•°ï¼ˆå®¹æ–¥è£¸é¢˜ï¼‰  
- **P2527** â€“ æ•°å­—è®¡æ•°ï¼ˆæ•°ä½ DP ç»ƒæ‰‹ï¼‰  
- **P2657** â€“ Windy æ•°ï¼ˆæ•°ä½ DP + åŒºé—´ç»Ÿè®¡ï¼‰  

---

## 7. å­¦ä¹ å¿ƒå¾—ä¸ç»éªŒåˆ†äº«

> â€œæˆ‘æœ€åˆåœ¨ `__gcd` è¿”å› int ä¸Šå¡äº†ä¸€ä¸‹åˆï¼Œ  
> åæ¥æŠŠ gcd å‚æ•°å…¨éƒ¨æ”¹æˆ `__int128` æ‰ ACã€‚â€  
> â€”â€” pengzy___

**æ´›è¯­äº‘ç¬ºç‚¹è¯„**  
- **æ•™è®­**ï¼šä»»ä½•ä¸­é—´å€¼éƒ½å¯èƒ½æº¢å‡ºï¼Œç»Ÿä¸€ä½¿ç”¨ 128 ä½æˆ–æµ®ç‚¹æ¯”è¾ƒã€‚  
- **è°ƒè¯•æŠ€å·§**ï¼š  
  - åœ¨å®¹æ–¥ DFS é‡Œæ‰“å° `(pos, lcm, cnt)` ä¸‰å…ƒç»„ï¼Œå¯å¿«é€Ÿå®šä½å‰ªæå¤±æ•ˆã€‚  
  - ç”¨ `assert(lcm <= (__int128)b)` æ–­è¨€é˜²æ­¢æº¢å‡ºã€‚

---

### ğŸ’¡ ç»“è¯­
ä»â€œæš´åŠ›æšä¸¾â€åˆ°â€œå®¹æ–¥å‰ªæâ€ï¼Œå†åˆ°â€œåˆ†å—æ‰“è¡¨â€ï¼Œ  
æˆ‘ä»¬åœ¨ 10Â¹â° çš„å°ºåº¦ä¸Šå®Œæˆäº†ä¸€æ¬¡ä¼˜é›…çš„é™ç»´æ‰“å‡»ã€‚  
å¸Œæœ›è¿™ä»½æŒ‡å—èƒ½å¸®ä½ æŠŠâ€œå®¹æ–¥ + å‰ªæâ€åˆ»è¿›è‚Œè‚‰è®°å¿†ï¼Œ  
ä¸‹æ¬¡é‡åˆ°åŒºé—´ç»Ÿè®¡ç±»éš¾é¢˜ï¼Œä¹Ÿèƒ½åƒåƒç´ æ¢é™©å®¶ä¸€æ ·ï¼Œ  
ç²¾å‡†ã€é«˜æ•ˆã€å¿«ä¹åœ°é€šå…³ï¼
```

---
å¤„ç†ç”¨æ—¶ï¼š55.09ç§’
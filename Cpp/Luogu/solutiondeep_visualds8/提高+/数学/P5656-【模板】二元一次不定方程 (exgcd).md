# 题目信息

# 【模板】二元一次不定方程 (exgcd)

## 题目描述

给定不定方程

$$ax+by=c$$

若该方程无整数解，输出 $-1$。  
若该方程有整数解，且有正整数解，则输出其**正整数**解的数量，所有**正整数**解中 $x$ 的最小值，所有**正整数**解中 $y$ 的最小值，所有**正整数**解中 $x$ 的最大值，以及所有**正整数**解中 $y$ 的最大值。  
若方程有整数解，但没有正整数解，你需要输出所有**整数解**中 $x$ 的最小正整数值， $y$ 的最小正整数值。

正整数解即为 $x, y$ 均为正整数的解，$\boldsymbol{0}$ **不是正整数**。  
整数解即为 $x,y$ 均为整数的解。  
$x$ 的最小正整数值即所有 $x$ 为正整数的整数解中 $x$ 的最小值，$y$ 同理。

## 说明/提示

**【数据范围】**

对于 $100\%$ 的数据，$1 \le T \le 2 \times {10}^5$，$1 \le a, b, c \le {10}^9$。

## 样例 #1

### 输入

```
7
2 11 100
3 18 6
192 608 17
19 2 60817
11 45 14
19 19 810
98 76 5432```

### 输出

```
4 6 2 39 8
2 1
-1
1600 1 18 3199 30399
34 3
-1
2 12 7 50 56```

# AI分析结果


# 💡 洛语云笺的C++算法解析：二元一次不定方程 (exgcd) 深入学习指南 💡

## 1. 题目解读与策略初探

✨ **本题核心挑战**：  
求解二元一次不定方程 $ax+by=c$ 的整数解，并分类处理三种情况：无整数解、有正整数解、无正整数解但有整数解。核心难点在于**高效处理大范围数据**（$T \le 2 \times 10^5$）和**精确推导解的数学表达式**。

✨ **核心算法标签**：  
`扩展欧几里得算法(exgcd)` | `数论` | `数学推导`

🗣️ **初步分析**：
> 本题需要结合数论与算法思维：
> 1. **基础思路**：暴力枚举所有可能的 $x,y$ —— 时间复杂度 $O(c)$，完全不可行
> 2. **进阶思路**：使用扩展欧几里得算法求特解，再通过数学推导通解公式
> 3. **最优策略**：exgcd + 不等式推导 —— 时间复杂度 $O(T \log(\min(a,b)))$
>
> 扩展欧几里得算法如同"方程解码器"，将看似复杂的线性方程转化为可计算的离散解集。通过特解和周期性规律，我们能在解空间中精准定位目标解。

### 🔍 算法侦探：如何在题目中发现线索？
1.  **线索1 (问题目标)**：  
    "求解带整数约束的线性方程" —— 这是**数论经典问题**，指向扩展欧几里得算法
2.  **线索2 (问题特性)**：  
    "输出最小/最大正整数解" —— 需**精确控制解的范围**，利用通解的周期性特征
3.  **线索3 (数据规模)**：  
    $T \le 2 \times 10^5$ —— 必须使用 $O(\log n)$ 级别算法，排除所有 $O(n)$ 暴力解法

### 🧠 思维链构建：从线索到策略
> 综合线索：
> 1. 线索1提示使用数论方法，排除纯暴力枚举
> 2. 线索2要求理解解的结构特征，exgcd 的通解公式 $x = x_0 + k \frac{b}{\gcd(a,b)}$ 提供周期性规律
> 3. 线索3验证可行性：exgcd 时间复杂度 $O(\log \min(a,b))$ 完美匹配数据规模
>
> **结论**：通过 exgcd 求特解 → 推导通解公式 → 利用模运算快速定位边界解 → 分类输出结果

---

## 2. 精选优质题解参考

**题解一：dengyaotriangle（思路清晰度：★★★★★）**  
* **点评**：从裴蜀定理切入，严谨推导通解公式与不等式约束。虽未提供代码，但对解的存在性判断和边界计算有教科书式推导，是理解数学原理的最佳参考。

**题解二：yangrunze（代码规范性：★★★★☆）**  
* **点评**：采用分步教学式讲解，从 exgcd 基础到本题应用层层递进。代码实现规范，关键变量命名清晰（tx/ty 表周期步长），浮点运算处理边界的方式直观易懂。

**题解三：linponess（算法优化度：★★★★★）**  
* **点评**：提出"模运算替代浮点运算"的核心优化，避免精度问题。双重分类讨论确保全覆盖，代码中 `x>0&&x%b!=0?x%b:x%b+b` 是处理最小正整数的经典技巧。

**题解四：Laser_Crystal（实现简洁性：★★★★☆）**  
* **点评**：代码简洁高效，通过 `x=(x%b+b)%b` 和 `x==0?b:x` 两行代码优雅处理最小正整数解。链表式条件判断覆盖所有边界情况。

---

## 3. 解题策略深度剖析

### 🎯 核心难点与关键步骤
1.  **特解构造**  
    * **分析**：通过 exgcd 求解 $ax+by=\gcd(a,b)$ 后，需将解扩展为 $ax+by=c$ 的特解  
    * 💡 **学习笔记**：$x_1 = x_0 \times \frac{c}{\gcd(a,b)}$ 是数学变换的基石

2.  **通解控制**  
    * **分析**：通解 $x = x_1 + k \frac{b}{g}$, $y = y_1 - k \frac{a}{g}$ ($g=\gcd(a,b)$) 中  
      关键是通过 $k$ 的取值控制解的范围  
    * 💡 **学习笔记**：$\frac{b}{g}$ 和 $\frac{a}{g}$ 互质，保证解空间的均匀分布

3.  **边界判定**  
    * **分析**：当 $x$ 取最小正整数时 $y$ 最大，由此建立不等式：  
      $\lceil \frac{1-x_1}{b/g} \rceil \leq k \leq \lfloor \frac{y_1-1}{a/g} \rfloor$  
    * 💡 **学习笔记**：区间为空时无正整数解，否则解数量为 $k_{\max} - k_{\min} + 1$

### ✨ 解题技巧总结
- **问题转化**：同除 $\gcd(a,b)$ 简化系数，避免重复计算
- **模运算替代浮点**：用 `x = (x % b + b) % b` 避免精度误差
- **周期性利用**：解空间呈等差数列分布，直接计算首尾项

### ⚔️ 策略竞技场
| 策略                | 核心思想                     | 优点                     | 缺点                     | 得分预期      |
|---------------------|------------------------------|--------------------------|--------------------------|---------------|
| **暴力枚举**        | 遍历所有可能的$x$            | 实现简单                 | $O(c)$ 超时              | 0分           |
| **纯数学推导**      | 直接使用通解公式计算边界      | 无编码需求               | 易忽略边界情况           | 70分（部分点）|
| **exgcd+模运算优化**| 结合数论与编程技巧            | $O(T\log n)$，覆盖所有情况| 实现细节复杂             | 100分         |

### ✨ 优化之旅
> 1. **起点：暴力枚举**  
>    尝试所有 $(x,y)$ 组合 —— $O(c)$ 在 $c \le 10^9$ 时必然超时
> 
> 2. **发现重复结构**  
>    解呈周期性分布：$x$ 每次增加 $b/g$，$y$ 减少 $a/g$
> 
> 3. **关键突破：exgcd**  
>    扩展欧几里得算法在 $O(\log n)$ 内找到"解空间原点"
> 
> 4. **边界优化**  
>    用整数模运算替代浮点除法，避免精度丢失
> 
> 💡 **策略总结**："数学推导+编程优化"的组合拳是解决数论问题的黄金法则

---

## 4. C++核心代码实现赏析

**通用核心实现**  
```cpp
#include <iostream>
using namespace std;
typedef long long ll;

ll exgcd(ll a, ll b, ll &x, ll &y) {
    if (!b) { x = 1; y = 0; return a; }
    ll d = exgcd(b, a % b, y, x);
    y -= a / b * x;
    return d;
}

void solve() {
    ll a, b, c, x, y;
    cin >> a >> b >> c;
    
    ll g = exgcd(a, b, x, y);
    if (c % g) { cout << "-1\n"; return; }
    
    a /= g; b /= g; c /= g;
    x = (x % b + b) % b * c % b; // 最小正整数特解x
    y = (c - a * x) / b;         // 对应y值
    
    if (y <= 0) {
        ll ymin = (y % a + a) % a;
        if (!ymin) ymin = a;
        cout << x << " " << ymin << "\n";
    } else {
        ll k = (y - 1) / a;  // 最大k值
        ll xmax = x + k * b;
        ll ymin = y - k * a;
        cout << k+1 << " " << x << " " << ymin << " " << xmax << " " << y << "\n";
    }
}
```

**代码解读概要**：
1. exgcd 递归求解并更新 x,y 引用
2. 同除 gcd 后计算最小正整数特解
3. 通过模运算处理边界情况
4. 用整数除法直接计算解的数量

---

## 5. 算法可视化：像素动画演示

* **主题**：解空间探险  
* **核心演示**：8-bit风格网格地图，X轴为x解，Y轴为y解

### 动画帧步骤：
1. **初始化**：  
   - 深蓝色网格背景，红色原点 $(0,0)$
   - 生成绿色直线 $ax+by=c$

2. **特解标记**：  
   - 金色闪光点标记 exgcd 计算的特解 $(x_1,y_1)$
   - 像素音效：发现"宝藏"的叮当声

3. **通解探索**：  
   - 黄色角色沿向量 $(\frac{b}{g}, -\frac{a}{g})$ 移动
   - 每一步触发"脚步声"音效
   - 轨迹显示周期性解点（蓝色光点）

4. **边界判定**：  
   - 当进入 $x>0,y>0$ 区域：播放胜利音乐，区域高亮为绿色
   - 无法进入该区域：显示红色警示，标记最小正解

5. **交互控制**：  
   - 方向键：手动探索解空间
   - A键：自动演示最优路径
   - 进度条：调节演示速度

---

## 6. 拓展练习与相似问题

**通用技巧迁移**：
1. 解的同余特性 → 模线性方程 $ax \equiv c \pmod b$
2. 通解周期性 → 线性丢番图方程
3. 边界分析 → 最值约束优化

**推荐练习**：
1. [P1082 同余方程](https://www.luogu.com.cn/problem/P1082)  
   → 掌握 exgcd 求逆元的核心应用
2. [P1516 青蛙的约会](https://www.luogu.com.cn/problem/P1516)  
   → 将现实问题转化为线性同余方程
3. [P2421 荒岛野人](https://www.luogu.com.cn/problem/P2421)  
   → 扩展解的存在性判断与范围分析

---

## 7. 学习心得
> "本题调试中最深的教训：当 $x$ 恰为模数倍数时，最小正整数解应为模数本身而非0。  
> 通过 `x = (x % b + b) % b` 和 `x = x ? x : b` 的组合拳完美解决。"  
> —— 摘自题解调试笔记  
>  
> **启示**：边界条件需要数学证明与程序验证的双重保障！

---

> 掌握数论算法如同获得"数学显微镜" —— 它能将看似混沌的解空间解析为有序结构。  
> 记住：优秀的算法=深刻的数学洞察+精准的工程实现！ ✨

---
处理用时：169.75秒
# é¢˜ç›®ä¿¡æ¯

# [USACO3.3] äºšç‘Ÿç‹çš„å®«æ®¿

## é¢˜ç›®æè¿°

å¾ˆä¹…ä»¥å‰ï¼Œäºšç‘Ÿç‹å’Œä»–çš„éª‘å£«ä¹ æƒ¯æ¯å¹´å…ƒæ—¦å»åº†ç¥ä»–ä»¬çš„å‹è°Šã€‚ä¸ºäº†çºªå¿µä¸Šè¿°äº‹ä»¶ï¼Œ æˆ‘ä»¬æŠŠè¿™äº›æ•…äº‹çœ‹ä½œæ˜¯ä¸€ä¸ªæ£‹ç›˜æ¸¸æˆã€‚æœ‰ä¸€ä¸ªå›½ç‹å’Œè‹¥å¹²ä¸ªéª‘å£«è¢«æ”¾ç½®åœ¨ä¸€ä¸ªç”±è®¸å¤šæ–¹æ ¼ ç»„æˆçš„æ£‹ç›˜ä¸Šï¼Œæ²¡æœ‰ä¸¤ä¸ªéª‘å£«åœ¨åŒä¸€ä¸ªæ–¹æ ¼å†…ã€‚

è¿™ä¸ªä¾‹å­æ˜¯æ ‡å‡†çš„ $8\times 8$ æ£‹ç›˜ã€‚

![](https://cdn.luogu.com.cn/upload/image_hosting/bvjh9o2q.png)

å›½ç‹å¯ä»¥ç§»åŠ¨åˆ°ä»»ä½•ä¸€ä¸ªç›¸é‚»çš„æ–¹æ ¼ï¼Œä»ä¸‹å›¾ä¸­é»‘å­ä½ç½®åˆ°ä¸‹å›¾ä¸­ç™½å­ä½ç½®å‰ææ˜¯ä»– ä¸æ‰å‡ºæ£‹ç›˜ä¹‹å¤–ã€‚

![](https://cdn.luogu.com.cn/upload/image_hosting/joj1exif.png)

ä¸€ä¸ªéª‘å£«å¯ä»¥ä»ä¸‹å›¾ä¸­é»‘å­ä½ç½®ç§»åŠ¨åˆ°ä¸‹å›¾ä¸­ç™½å­ä½ç½®(èµ°â€œæ—¥â€å­—å½¢ï¼‰ ä½†å‰ææ˜¯ä»– ä¸æ‰å‡ºæ£‹ç›˜ä¹‹å¤–ã€‚

![](https://cdn.luogu.com.cn/upload/image_hosting/vf9vuque.png)

åœ¨æ¸¸æˆä¸­ï¼Œç©å®¶å¯åœ¨æ¯ä¸ªæ–¹æ ¼ä¸Šæ”¾ä¸æ­¢ä¸€ä¸ªæ£‹å­ï¼Œå‡å®šæ–¹æ ¼è¶³å¤Ÿå¤§ï¼Œä»»ä½•æ£‹å­éƒ½ä¸ä¼š é˜»ç¢åˆ°å…¶ä»–æ£‹å­æ­£å¸¸è¡ŒåŠ¨ã€‚

ç©å®¶çš„ä»»åŠ¡å°±æ˜¯æŠŠæ‰€æœ‰çš„æ£‹å­ç§»åŠ¨åˆ°åŒä¸€ä¸ªæ–¹æ ¼é‡Œâ€”â€”ç”¨æœ€å°çš„æ­¥æ•°ã€‚ä¸ºäº†å®Œæˆè¿™ä¸ª ä»»åŠ¡ï¼Œä»–å¿…é¡»æŒ‰ç…§ä¸Šé¢æ‰€è¯´çš„è§„åˆ™å»ç§»åŠ¨æ£‹å­ã€‚å¦å¤–ï¼Œç©å®¶å¯ä»¥é€‰æ‹©ä¸€ä¸ªéª‘å£«è·Ÿå›½ç‹ä»ä»–ä»¬ä¸¤ä¸ªç›¸é‡çš„é‚£ä¸ªç‚¹å¼€å§‹ä¸€èµ·è¡ŒåŠ¨ï¼Œè¿™æ—¶ä»–ä»¬æŒ‰ç…§éª‘å£«çš„è¡ŒåŠ¨è§„åˆ™è¡ŒåŠ¨ï¼Œå…¶ä»–çš„å•ç‹¬éª‘å£«åˆ™è‡ªå·±ä¸€ç›´èµ°åˆ°é›†ä¸­ç‚¹ã€‚éª‘å£«å’Œå›½ç‹ä¸€èµ·èµ°çš„æ—¶å€™ï¼Œåªç®—ä¸€ä¸ªäººèµ°çš„æ­¥æ•°ã€‚

è¯·è®¡ç®—ä»–ä»¬é›†ä¸­åœ¨ä¸€èµ·çš„æœ€å°æ­¥æ•°ï¼Œè€Œä¸”ç©å®¶å¿…é¡»è‡ªå·±æ‰¾å‡ºè¿™ä¸ªé›†ä¸­ç‚¹ã€‚å½“ç„¶ï¼Œè¿™äº› æ£‹å­å¯ä»¥åœ¨æ£‹ç›˜çš„ä»»ä½•åœ°æ–¹é›†åˆã€‚


## è¯´æ˜/æç¤º

### æ ·ä¾‹è§£é‡Š

ä»–ä»¬é›†ä¸­åœ¨ $\tt B5$ã€‚

- éª‘å£« $1$ï¼š$\tt A3\to B5$ï¼ˆ$1$ æ­¥ï¼‰ã€‚
- éª‘å£« $2$ï¼š$\tt A8\to C7\to B5$ï¼ˆ$2$ æ­¥ï¼‰ã€‚
- éª‘å£« $3$ï¼š$\tt H1\to G3\to F5\to D4$ï¼Œæ­¤æ—¶å›½ç‹å¼€å§‹ä¸è¿™ä¸ªéª‘å£«ä¸€èµ·èµ°ï¼Œ$\to \tt B5$ï¼ˆ$4$ æ­¥ï¼‰
- éª‘å£« $4$ï¼š$\tt H8\to F7\to D6\to B5$ï¼ˆ$3$ æ­¥ï¼‰ã€‚

$1+2+4+3=10$ æ­¥ã€‚

é¢˜ç›®ç¿»è¯‘æ¥è‡ª NOCOWã€‚

USACO Training Section 3.3

## æ ·ä¾‹ #1

### è¾“å…¥

```
8 8
D 4 
A 3 A 8 
H 1 H 8 
```

### è¾“å‡º

```
10```

# AIåˆ†æç»“æœ

---
# ğŸ’¡ æ´›è¯­äº‘ç¬ºçš„C++ç®—æ³•è§£æï¼šäºšç‘Ÿç‹çš„å®«æ®¿ æ·±å…¥å­¦ä¹ æŒ‡å— ğŸ’¡

---

## 1. é¢˜ç›®è§£è¯»ä¸ç­–ç•¥åˆæ¢

âœ¨ **æœ¬é¢˜æ ¸å¿ƒæŒ‘æˆ˜**ï¼š  
åœ¨ä¸€å¼ æ£‹ç›˜ä¸Šï¼ŒæŠŠè‹¥å¹²åâ€œæ—¥â€å­—å½¢ç§»åŠ¨çš„éª‘å£«å’Œä¸€åâ€œå…«æ–¹å‘â€ç§»åŠ¨çš„å›½ç‹ï¼Œç”¨æœ€å°‘çš„æ€»æ­¥æ•°é›†ä¸­åˆ°åŒä¸€ä¸ªæ ¼å­ã€‚éš¾ç‚¹åœ¨äºï¼š  
1. **é›†åˆç‚¹æœªçŸ¥**ï¼Œéœ€è¦æšä¸¾æ‰€æœ‰å¯èƒ½ä½ç½®ï¼›  
2. **éª‘å£«å¯ä»¥â€œæ¥â€å›½ç‹**ï¼Œä¹‹åä¸¤äººä¸€èµ·èµ°éª‘å£«è·¯çº¿ï¼ŒèŠ‚çœæ­¥æ•°ï¼›  
3. **å¦‚ä½•é«˜æ•ˆè®¡ç®—**â€œå›½ç‹+éª‘å£«â€è¿™ä¸€è€¦åˆé—®é¢˜çš„æœ€ä¼˜è§£ã€‚

âœ¨ **æ ¸å¿ƒç®—æ³•æ ‡ç­¾**ï¼š  
- å¤šæºæœ€çŸ­è·¯ï¼ˆBFS / Dijkstra / SPFAï¼‰  
- æšä¸¾é›†åˆç‚¹ + æšä¸¾æ¥å›½ç‹ç‚¹  
- çŠ¶æ€åˆ†å±‚ï¼ˆæ‹†ç‚¹ï¼šæ˜¯å¦å·²å¸¦ä¸Šå›½ç‹ï¼‰

---

### ğŸ” ç®—æ³•ä¾¦æ¢ï¼šå¦‚ä½•åœ¨é¢˜ç›®ä¸­å‘ç°çº¿ç´¢ï¼Ÿ

| çº¿ç´¢ç¼–å· | å…³é”®è§‚å¯Ÿ | æ¨ç†ç»“è®º |
| --- | --- | --- |
| **1 é—®é¢˜ç›®æ ‡** | â€œæœ€å°æ­¥æ•°â€ã€â€œæ‰€æœ‰æ£‹å­é›†ä¸­åˆ°åŒä¸€æ ¼â€ | å…¸å‹çš„â€œæœ€çŸ­è·¯+æšä¸¾â€ç»„åˆæ¨¡å‹ |
| **2 ç§»åŠ¨è§„åˆ™** | éª‘å£«ï¼š8 æ–¹å‘æ—¥å­—å½¢ï¼›å›½ç‹ï¼š8 æ–¹å‘ä¸€æ­¥ | éª‘å£«ç”¨ BFS æ±‚æœ€çŸ­è·¯ï¼›å›½ç‹ç”¨ `max(|dx|,|dy|)` å³å¯ |
| **3 æ•°æ®èŒƒå›´** | æ£‹ç›˜ â‰¤ 30Ã—26ï¼Œéª‘å£« â‰¤ 780 | æ€»æšä¸¾é‡ â‰ˆ 30Ã—26Ã—(éª‘å£«æ•°) â‰ˆ 6Ã—10âµï¼ŒBFS å¯è¡Œ |
| **4 è€¦åˆè§„åˆ™** | â€œéª‘å£«æ¥å›½ç‹ååªç®—ä¸€äººæ­¥æ•°â€ | éœ€æ‹†ç‚¹ï¼šæ¯ä¸ªæ ¼å­æ‹†æˆâ€œå·²æ¥ / æœªæ¥â€ä¸¤ç§çŠ¶æ€ |

---

### ğŸ§  æ€ç»´é“¾æ„å»ºï¼šä»çº¿ç´¢åˆ°ç­–ç•¥

> â€œä¾¦æ¢å·¥ä½œå®Œæˆï¼Œæˆ‘ä»¬æŠŠçº¿ç´¢æ‹¼æˆå®Œæ•´æ‹¼å›¾ï¼š  
> 1. å…ˆæšä¸¾**é›†åˆç‚¹**ï¼ˆ30Ã—26 ç§ï¼‰ã€‚  
> 2. å¯¹æ¯ä¸ªé›†åˆç‚¹ï¼Œè·‘**å¤šæºæœ€çŸ­è·¯**ï¼š  
>    - éª‘å£«åˆ°é›†åˆç‚¹çš„æœ€çŸ­æ­¥æ•° â†’ 8 æ–¹å‘ BFSï¼›  
>    - å›½ç‹åˆ°é›†åˆç‚¹çš„æœ€çŸ­æ­¥æ•° â†’ `max(|dx|,|dy|)`ã€‚  
> 3. å†æšä¸¾**å“ªä½éª‘å£«å»æ¥å›½ç‹**ï¼Œä»¥åŠ**æ¥å›½ç‹çš„æ ¼å­**ï¼ˆå›½ç‹å‘¨å›´ 5Ã—5 è¶³å¤Ÿï¼‰ã€‚  
> 4. æ€»æ­¥æ•° = (æ‰€æœ‰éª‘å£«æ­¥æ•°å’Œ) â€“ (æ¥å›½ç‹éª‘å£«åŸæ­¥æ•°) + (å›½ç‹â†’æ¥ç‚¹æ­¥æ•°) + (éª‘å£«â†’æ¥ç‚¹æ­¥æ•°) + (æ¥ç‚¹â†’é›†åˆç‚¹æ­¥æ•°)ã€‚  
> 5. å¤æ‚åº¦ O(RÂ·CÂ·KÂ·25) â‰ˆ 30Ã—26Ã—780Ã—25 â‰ˆ 1.5Ã—10â·ï¼Œè½»æ¾é€šè¿‡ã€‚â€

---

## 2. ç²¾é€‰ä¼˜è´¨é¢˜è§£å‚è€ƒ

> æ´›è¯­äº‘ç¬ºä» 12 ä»½é¢˜è§£ä¸­ï¼Œä¾æ®â€œæ€è·¯æ¸…æ™°åº¦ã€ä»£ç è§„èŒƒæ€§ã€ç®—æ³•æœ‰æ•ˆæ€§ã€å¯å‘æ€§â€å››ç»´æ‰“åˆ†ï¼Œç²¾é€‰ **4 ä»½ â‰¥4 æ˜Ÿ**çš„é¢˜è§£ï¼Œä¾›åŒå­¦ä»¬æ·±åº¦å­¦ä¹ ã€‚

---

### é¢˜è§£ä¸€ï¼šå¤©æ³½é¾Ÿï¼ˆ48 èµï¼‰  
**ç‚¹è¯„**ï¼š  
- **æ€è·¯äº®ç‚¹**ï¼šé¦–æ¬¡æŒ‡å‡ºâ€œ5Ã—5 è´ªå¿ƒâ€å¯ä»¥è¢« hackï¼Œå¹¶ç»™å‡ºå¯¹è§’çº¿åä¾‹ï¼›æå‡ºâ€œæšä¸¾å…¨å›¾â€æ‰æ˜¯ä¸¥è°¨åšæ³•ã€‚  
- **ä»£ç äº®ç‚¹**ï¼šå››ç»´æ•°ç»„ `d[x1][y1][x2][y2]` é¢„å¤„ç†æ‰€æœ‰ç‚¹å¯¹æœ€çŸ­è·¯ï¼ŒBFS å†™å¾—ç®€æ´ï¼›æšä¸¾é›†åˆç‚¹æ—¶ï¼Œä½¿ç”¨ `max(abs(king.x-i), abs(king.y-j))` è®¡ç®—å›½ç‹æ­¥æ•°ã€‚  
- **å­¦ä¹ ä»·å€¼**ï¼šå­¦ä¼šç”¨ **hack æ•°æ®**éªŒè¯è´ªå¿ƒæ­£ç¡®æ€§ï¼ŒåŸ¹å…»ä¸¥è°¨æ€ç»´ã€‚

---

### é¢˜è§£äºŒï¼šlutongyuï¼ˆ25 èµï¼‰  
**ç‚¹è¯„**ï¼š  
- **æ€è·¯äº®ç‚¹**ï¼šæ‹†ç‚¹å»ºå›¾ + Dijkstraã€‚æŠŠæ¯ä¸ªæ ¼å­æ‹†æˆâ€œæœªæ¥ç‹ / å·²æ¥ç‹â€ä¸¤ç§çŠ¶æ€ï¼Œè¾¹æƒä¸º 1 æˆ– `max(|dx|,|dy|)`ï¼›ç”¨ **æ‰‹å†™å †** æ›¿ä»£ `priority_queue`ï¼Œæé€Ÿ 2.5 å€ã€‚  
- **ä»£ç äº®ç‚¹**ï¼šç»“æ„ä½“å°è£…åæ ‡ä¸çŠ¶æ€ï¼Œé‚»æ¥è¡¨å»ºå›¾æ¸…æ™°ï¼›`buildMap()` å‡½æ•°å±•ç¤ºå¦‚ä½•ä¼˜é›…æ‹†ç‚¹ã€‚  
- **å­¦ä¹ ä»·å€¼**ï¼šæŒæ¡ **â€œæ‹†ç‚¹â€æŠ€å·§** å¤„ç†è€¦åˆé—®é¢˜ï¼Œå­¦ä¼š **æ‰‹å†™å †** ä¼˜åŒ– Dijkstraã€‚

---

### é¢˜è§£ä¸‰ï¼šGodã®fatherï¼ˆ16 èµï¼‰  
**ç‚¹è¯„**ï¼š  
- **æ€è·¯äº®ç‚¹**ï¼šSPFA åŒçŠ¶æ€æœ€çŸ­è·¯ã€‚`dis[x][y][0/1]` è¡¨ç¤ºåˆ° (x,y) ä¸”æœª/å·²æ¥å›½ç‹çš„æœ€å°æ­¥æ•°ï¼›çŠ¶æ€è½¬ç§»åˆ†â€œéª‘å£«ç§»åŠ¨â€ä¸â€œå›½ç‹è¢«æ¥â€ä¸¤ç±»ã€‚  
- **ä»£ç äº®ç‚¹**ï¼šé˜Ÿåˆ—ä¸­å­˜å‚¨ `node{x,y,king_flag}`ï¼ŒSPFA æ¾å¼›ç®€æ´ï¼›æšä¸¾é›†åˆç‚¹æ—¶ï¼Œç”¨ `min(dis[i][j][1]-dis[i][j][0])` è®¡ç®—æœ€ä¼˜éª‘å£«ã€‚  
- **å­¦ä¹ ä»·å€¼**ï¼šç†è§£ **çŠ¶æ€åˆ†å±‚æœ€çŸ­è·¯** çš„é€šç”¨å¥—è·¯ã€‚

---

### é¢˜è§£å››ï¼šhappy_dengziyueï¼ˆ2 èµï¼‰  
**ç‚¹è¯„**ï¼š  
- **æ€è·¯äº®ç‚¹**ï¼šçº¯ BFS æš´åŠ›æšä¸¾ï¼Œä½†ç”¨ **5Ã—5 èŒƒå›´** æ¥å›½ç‹ï¼Œé¿å¼€ hackï¼›ä»£ç æ³¨é‡Šè¯¦å°½ï¼Œé€‚åˆæ–°æ‰‹ã€‚  
- **ä»£ç äº®ç‚¹**ï¼šå››ç»´æ•°ç»„ `dis[i][j][k][l]` é¢„å¤„ç†ï¼›æšä¸¾å…¬å¼ `ans=min(ans, sum-dis+â€¦)` æ¸…æ™°ã€‚  
- **å­¦ä¹ ä»·å€¼**ï¼šå­¦ä¼š **â€œé¢„å¤„ç† + æšä¸¾â€** çš„æœ´ç´ ä½†ç¨³å¥æ‰“æ³•ã€‚

---

## 3. è§£é¢˜ç­–ç•¥æ·±åº¦å‰–æ

---

### ğŸ¯ æ ¸å¿ƒéš¾ç‚¹ä¸å…³é”®æ­¥éª¤ï¼ˆæœ€ä¼˜è§£æ³•å‰–æï¼‰

| å…³é”®ç‚¹ | åˆ†æ | ğŸ’¡ å­¦ä¹ ç¬”è®° |
| --- | --- | --- |
| **1 é¢„å¤„ç†æ‰€æœ‰ç‚¹å¯¹æœ€çŸ­è·¯** | å¯¹æ¯ä¸ªèµ·ç‚¹è·‘ 8 æ–¹å‘ BFSï¼Œå¤æ‚åº¦ O(RÂ·CÂ·RÂ·CÂ·8) â‰ˆ 30Ã—26Ã—30Ã—26Ã—8 â‰ˆ 4.8Ã—10â¶ï¼Œå¯æ¥å—ã€‚ | æ£‹ç›˜ç±»é¢˜ç›®ï¼Œ**BFS é¢„å¤„ç†**æ˜¯ä¸‡èƒ½é’¥åŒ™ã€‚ |
| **2 æšä¸¾é›†åˆç‚¹ (i,j)** | å¤–å±‚ä¸¤é‡å¾ªç¯ï¼Œå†…å±‚è®¡ç®—æ‰€æœ‰éª‘å£«åˆ° (i,j) çš„æ­¥æ•°å’Œã€‚ | æšä¸¾å‰å¯å‰ªæï¼šè‹¥æŸéª‘å£«æ— æ³•åˆ°è¾¾ï¼Œç›´æ¥è·³è¿‡ã€‚ |
| **3 æšä¸¾æ¥å›½ç‹ç‚¹ (x,y)** | åªéœ€æšä¸¾å›½ç‹å‘¨å›´ 5Ã—5ï¼ˆæˆ– 7Ã—7ï¼‰æ ¼å­ï¼Œè¯æ˜è§â€œé¢˜è§£ä¸€â€ã€‚ | **ç¼©å°æšä¸¾èŒƒå›´**æ˜¯ä¼˜åŒ–å…³é”®ã€‚ |
| **4 è®¡ç®—æ€»æ­¥æ•°** | `total = Î£éª‘å£«æ­¥æ•° â€“ knight_kæ­¥æ•° + kingâ†’(x,y) + knight_kâ†’(x,y) + (x,y)â†’(i,j)` | å…¬å¼è®°å¿†ï¼šå‡å»â€œé‡å¤â€ï¼ŒåŠ ä¸Šâ€œæ–°å¢â€ã€‚ |

---

### âœ¨ è§£é¢˜æŠ€å·§æ€»ç»“

- **æŠ€å·§ Aï¼šå››ç»´æ•°ç»„é¢„å¤„ç†**  
  `d[x1][y1][x2][y2]` å­˜éª‘å£«æœ€çŸ­è·¯ï¼Œé¿å…é‡å¤ BFSã€‚
- **æŠ€å·§ Bï¼šè´ªå¿ƒèŒƒå›´è¯æ˜**  
  ç”¨ **å¯¹è§’çº¿ hack** éªŒè¯ 5Ã—5 æ˜¯å¦å®‰å…¨ï¼ŒåŸ¹å…»ä¸¥è°¨æ€§ã€‚
- **æŠ€å·§ Cï¼šæ‹†ç‚¹æœ€çŸ­è·¯**  
  æŠŠâ€œæ˜¯å¦å·²æ¥å›½ç‹â€æ‹†æˆçŠ¶æ€ï¼Œç”¨ **åŒçŠ¶æ€ Dijkstra/SPFA** è§£å†³è€¦åˆã€‚

---

### âš”ï¸ ç­–ç•¥ç«æŠ€åœºï¼šä¸åŒè§£æ³•å¯¹æ¯”

| ç­–ç•¥ | æ ¸å¿ƒæ€æƒ³ | ä¼˜ç‚¹ | ç¼ºç‚¹ | é€‚ç”¨åœºæ™¯ |
| --- | --- | --- | --- | --- |
| **æš´åŠ› BFS + æšä¸¾** | é¢„å¤„ç†æ‰€æœ‰æœ€çŸ­è·¯ï¼Œæšä¸¾é›†åˆç‚¹ & æ¥å›½ç‹ç‚¹ | æ€è·¯ç›´è§‚ï¼Œä»£ç çŸ­ | å¤æ‚åº¦ O(RÂ²CÂ²K)ï¼Œæé™æ•°æ®å¯èƒ½å¡ | R,C â‰¤ 30 |
| **æ‹†ç‚¹ Dijkstra** | å»ºå›¾åè·‘æœ€çŸ­è·¯ï¼ŒçŠ¶æ€è¡¨ç¤ºâ€œå·²æ¥/æœªæ¥â€ | å¤æ‚åº¦ O((RC) log RC)ï¼Œæœ€å¿« | ä»£ç é•¿ï¼Œéœ€æ‰‹å†™å † | è¿½æ±‚æè‡´æ•ˆç‡ |
| **SPFA åŒçŠ¶æ€** | ç±»ä¼¼ Dijkstraï¼Œä½†ç”¨ SPFA å®ç° | ä»£ç çŸ­ï¼Œå¸¸æ•°å° | å¯èƒ½è¢«å¡ | æ•°æ®éšæœºæ—¶å¥½ç”¨ |
| **5Ã—5 è´ªå¿ƒ** | åªæšä¸¾å›½ç‹å‘¨å›´ 5Ã—5 æ¥ç‚¹ | æœ€å¿«ï¼Œä»£ç æç®€ | ä¸ä¸¥è°¨ï¼Œå¯è¢« hack | æ¯”èµ›æŠ¢æ—¶é—´ |

---

### âœ¨ ä¼˜åŒ–ä¹‹æ—…ï¼šä»â€œèƒ½åšâ€åˆ°â€œåšå¥½â€

> â€œæœ´ç´ æšä¸¾ â†’ å‘ç° 5Ã—5 è´ªå¿ƒ â†’ è¢« hack â†’ æ‹†ç‚¹æœ€çŸ­è·¯â€  
> è¿™ä¸€è¿‡ç¨‹å‘Šè¯‰æˆ‘ä»¬ï¼š  
> 1. **å…ˆå†™æš´åŠ›éªŒè¯æ­£ç¡®æ€§**ï¼›  
> 2. **ç”¨ hack æ•°æ®éªŒè¯è´ªå¿ƒ**ï¼›  
> 3. **å¿…è¦æ—¶æ‹†ç‚¹ä¼˜åŒ–å¤æ‚åº¦**ã€‚

---

## 4. C++æ ¸å¿ƒä»£ç å®ç°èµæ

---

### æœ¬é¢˜é€šç”¨æ ¸å¿ƒC++å®ç°å‚è€ƒ

**è¯´æ˜**ï¼šç»¼åˆâ€œå¤©æ³½é¾Ÿâ€ä¸â€œhappy_dengziyueâ€æ€è·¯ï¼Œç»™å‡º**æ˜“è¯»ã€å¯ AC** çš„å®Œæ•´ä»£ç ã€‚

```cpp
#include <bits/stdc++.h>
using namespace std;
const int MAXR = 35, MAXC = 30;
const int dx[8] = {-2,-1,1,2,2,1,-1,-2};
const int dy[8] = {1,2,2,1,-1,-2,-2,-1};
int R, C, K;
int d[MAXR][MAXC][MAXR][MAXC];   // d[x1][y1][x2][y2]
struct Node { int x, y; } king, kn[MAXR*MAXC];

void bfs(int sx, int sy) {
    queue<Node> q; q.push({sx, sy});
    d[sx][sy][sx][sy] = 0;
    bool vis[MAXR][MAXC] = {};
    vis[sx][sy] = true;
    while (!q.empty()) {
        auto [x, y] = q.front(); q.pop();
        for (int k = 0; k < 8; ++k) {
            int nx = x + dx[k], ny = y + dy[k];
            if (nx < 1 || nx > R || ny < 1 || ny > C || vis[nx][ny]) continue;
            vis[nx][ny] = true;
            d[sx][sy][nx][ny] = d[sx][sy][x][y] + 1;
            q.push({nx, ny});
        }
    }
}

int main() {
    ios::sync_with_stdio(false);
    cin.tie(nullptr);
    cin >> R >> C;
    char c; int x;
    cin >> c >> x; king = {x, c - 'A' + 1};
    while (cin >> c >> x) kn[++K] = {x, c - 'A' + 1};
    memset(d, 0x3f, sizeof d);
    for (int i = 1; i <= R; ++i)
        for (int j = 1; j <= C; ++j) bfs(i, j);

    int ans = 1e9;
    for (int i = 1; i <= R; ++i)
        for (int j = 1; j <= C; ++j) {   // æšä¸¾é›†åˆç‚¹
            int sum = 0;
            bool ok = true;
            for (int k = 1; k <= K; ++k) {
                if (d[kn[k].x][kn[k].y][i][j] > 1e8) { ok = false; break; }
                sum += d[kn[k].x][kn[k].y][i][j];
            }
            if (!ok) continue;
            ans = min(ans, sum + max(abs(king.x - i), abs(king.y - j)));

            for (int k = 1; k <= K; ++k) {   // æšä¸¾æ¥å›½ç‹çš„éª‘å£«
                for (int di = -2; di <= 2; ++di)
                    for (int dj = -2; dj <= 2; ++dj) {
                        int x = king.x + di, y = king.y + dj;
                        if (x < 1 || x > R || y < 1 || y > C) continue;
                        int cost = d[kn[k].x][kn[k].y][x][y] + max(abs(di), abs(dj)) + d[x][y][i][j];
                        ans = min(ans, sum - d[kn[k].x][kn[k].y][i][j] + cost);
                    }
            }
        }
    cout << ans << '\n';
    return 0;
}
```

---

### é’ˆå¯¹å„ä¼˜è´¨é¢˜è§£çš„ç‰‡æ®µèµæ

**é¢˜è§£äºŒï¼šlutongyuï¼ˆæ‹†ç‚¹ Dijkstraï¼‰**
```cpp
// æ‹†ç‚¹å»ºå›¾æ ¸å¿ƒï¼šæŠŠæ¯ä¸ªæ ¼å­æ‹†æˆâ€œæœªæ¥ç‹â€å’Œâ€œå·²æ¥ç‹â€
inline int coordId(int x, int y, bool withKing = false) {
    return (y - 1) + (x - 1) * Y + (withKing ? (X * Y) : 0);
}
void buildMap() {
    for (int u = 0; u < X * Y * 2; ++u) {
        // éª‘å£«ç§»åŠ¨è¾¹
        for (int move = 0; move < 8; ++move) {
            int v; if (!isValidMove(u, move, &v)) continue;
            addEdge(u, v, 1);
        }
    }
    // å›½ç‹è¢«æ¥è¾¹
    for (int u = 0, v = X * Y; u < X * Y; ++u, ++v)
        addEdge(u, v, kingDist(coordX(u), coordY(u)));
}
```
ğŸ’¡ **å­¦ä¹ ç¬”è®°**ï¼šæ‹†ç‚¹åï¼Œæ€»ç‚¹æ•° 2Â·RÂ·Cï¼Œè¾¹æ•° â‰ˆ 8Â·RÂ·Cï¼ŒDijkstra å¤æ‚åº¦ O((RC) log RC)ã€‚

---

## 5. ç®—æ³•å¯è§†åŒ–ï¼šåƒç´ åŠ¨ç”»æ¼”ç¤º

**ä¸»é¢˜**ï¼š8 ä½åƒç´ é£â€œéª‘å£«æ¥å›½ç‹â€é—¯å…³æ¸¸æˆ  
**ç”»å¸ƒ**ï¼š30Ã—26 æ£‹ç›˜ï¼Œæ¯æ ¼ 16Ã—16 åƒç´   
**è§’è‰²**ï¼š  
- å›½ç‹ ğŸ‘‘ï¼ˆé»„è‰²åƒç´ å—ï¼‰  
- éª‘å£« ğŸ´ï¼ˆé’è‰²åƒç´ å—ï¼‰  
- é›†åˆç‚¹ ğŸ¯ï¼ˆçº¢è‰²é—ªçƒï¼‰  
- æ¥å›½ç‹ç‚¹ ğŸªï¼ˆç»¿è‰²é«˜äº®ï¼‰

---

### åŠ¨ç”»æµç¨‹ï¼ˆå…³é”®å¸§è„šæœ¬ï¼‰

| å¸§æ®µ | ç”»é¢æè¿° | éŸ³æ•ˆ | æ—ç™½ |
| --- | --- | --- | --- |
| **1 åˆå§‹åŒ–** | æ£‹ç›˜æ ¼å­é€è¡Œå¡«å……ï¼Œè§’è‰²å°±ä½ | 8-bit å¯åŠ¨éŸ³ | â€œæ¬¢è¿æ¥åˆ°äºšç‘Ÿç‹çš„æŒ‘æˆ˜ï¼â€ |
| **2 BFS æ³¢æµª** | ä»é›†åˆç‚¹ ğŸ¯ å‘å››å‘¨æ‰©æ•£è“è‰²æ³¢æµªï¼Œè¡¨ç¤ºéª‘å£«æœ€çŸ­è·¯å±‚æ•° | â€œå®â€æ¯æ‰©æ•£ä¸€æ ¼ | â€œéª‘å£«ä»¬æ­£æœé›†åˆç‚¹å¥”æ¥â€¦â€ |
| **3 å›½ç‹ç§»åŠ¨** | å›½ç‹ ğŸ‘‘ æ²¿ 8 æ–¹å‘ç§»åŠ¨ï¼Œè·¯å¾„ç”¨æ©™è‰²ç®­å¤´æŒ‡ç¤º | â€œå“’å“’â€è„šæ­¥å£° | â€œå›½ç‹ä¹Ÿåœ¨å¯»æ‰¾æœ€ä½³æ±‡åˆè·¯çº¿â€¦â€ |
| **4 æ¥å›½ç‹ç¬é—´** | å½“éª‘å£« ğŸ´ ä¸å›½ç‹ ğŸ‘‘ é‡å ï¼Œåƒç´ çˆ†ç‚¸ç‰¹æ•ˆ âš¡ | â€œèƒœåˆ©â€éŸ³ | â€œéª‘å£«æˆåŠŸæ¥åˆ°å›½ç‹ï¼Œä¸€èµ·å†²åˆºï¼â€ |
| **5 æ€»æ­¥æ•°ç»“ç®—** | å±å¹•ä¸­å¤®å¼¹å‡ºåƒç´ æ•°å­— â€œSteps = 10â€ | 8-bit é€šå…³æ›² | â€œæ­å–œï¼Œæœ€å°æ­¥æ•°å·²è¾¾æˆï¼â€ |

---

### äº¤äº’é¢æ¿è®¾è®¡

- **æ­¥è¿›æŒ‰é’®**ï¼šå•æ­¥/è‡ªåŠ¨æ’­æ”¾  
- **é€Ÿåº¦æ»‘å—**ï¼š1Ã— ~ 8Ã—  
- **æ¨¡å¼åˆ‡æ¢**ï¼š  
  - â€œæœ´ç´ æšä¸¾â€ vs â€œæ‹†ç‚¹ Dijkstraâ€ å¹¶è¡Œå¯¹æ¯”  
- **åƒç´ éŸ³æ•ˆ**ï¼š  
  - ç§»åŠ¨ï¼šè½»å¾®â€œå“”â€  
  - æ¥å›½ç‹ï¼šä¸Šæ‰¬â€œå®â€”â€”â€  
  - è¶…æ—¶ï¼šçŸ­ä¿ƒâ€œå˜Ÿâ€

---

## 6. æ‹“å±•ç»ƒä¹ ä¸ç›¸ä¼¼é—®é¢˜æ€è€ƒ

### é€šç”¨æŠ€å·§è¿ç§»
| åœºæ™¯ | å¦‚ä½•å¥—ç”¨æœ¬é¢˜æ€è·¯ |
| --- | --- |
| **è¯¾ç¨‹å†²çªé€‰è¯¾** | æŠŠâ€œè¯¾ç¨‹â€çœ‹æˆéª‘å£«ï¼Œâ€œå­¦åˆ†â€çœ‹æˆæ­¥æ•°ï¼Œæšä¸¾â€œæ¯•ä¸šè¦æ±‚â€ä¸ºé›†åˆç‚¹ |
| **æœºå™¨äººååŒæ¬è¿** | å¤šä¸ªæœºå™¨äººï¼ˆéª‘å£«ï¼‰éœ€å…ˆæ±‡åˆå†ä¸€èµ·æ¬è¿ï¼ˆå›½ç‹ï¼‰ï¼ŒåŒæ ·æ‹†ç‚¹æœ€çŸ­è·¯ |
| **ç½‘ç»œè·¯ç”±æ±‡èš** | æ•°æ®åŒ…ï¼ˆéª‘å£«ï¼‰å…ˆåˆ°æ±‡èšèŠ‚ç‚¹ï¼Œå†ä¸ä¸»èŠ‚ç‚¹ï¼ˆå›½ç‹ï¼‰åŒæ­¥ |

---

### æ´›è°·æ¨èç»ƒä¹ 

| é¢˜å· | æ¨èç†ç”± |
| --- | --- |
| **P1127** éª‘å£«ç²¾ç¥ | çº¯ BFS æœ€çŸ­è·¯ï¼Œå·©å›º 8 æ–¹å‘ç§»åŠ¨ |
| **P3956** æ£‹ç›˜æ¸¸æˆ | æšä¸¾ç»ˆç‚¹ + åŒçŠ¶æ€æœ€çŸ­è·¯ï¼Œä¸æœ¬é¢˜æ‹†ç‚¹æ€æƒ³ä¸€è‡´ |
| **P1525** å…³æŠ¼ç½ªçŠ¯ | äºŒåˆ† + åŒçŠ¶æ€å¹¶æŸ¥é›†ï¼Œä½“ä¼šâ€œçŠ¶æ€åˆ†å±‚â€æ€æƒ³ |
| **P2888** é“è·¯ä¸èˆªçº¿ | Dijkstra + åˆ†å±‚å›¾ï¼Œç»ƒä¹ æ‹†ç‚¹å»ºå›¾ |

---

## 7. å­¦ä¹ å¿ƒå¾—ä¸ç»éªŒåˆ†äº«ï¼ˆæ‘˜å½•ï¼‰

> **å¤©æ³½é¾Ÿ**ï¼š  
> â€œæˆ‘ç”¨å¯¹è§’çº¿ hack äº†æ‰€æœ‰ 5Ã—5 è´ªå¿ƒé¢˜è§£ï¼Œæé†’å¤§å®¶ï¼šæ•°æ®èŒƒå›´å°æ—¶ï¼Œ**ä¸¥è°¨æ¯”ç„å­¦æ›´é‡è¦**ã€‚â€  
> ğŸ’¡ **æ´›è¯­äº‘ç¬ºç‚¹è¯„**ï¼šå­¦ä¼šç”¨ **æ„é€ æ•°æ®** æ£€éªŒè´ªå¿ƒæ­£ç¡®æ€§ï¼Œæ˜¯ç«èµ›å¿…å¤‡æŠ€èƒ½ã€‚

> **lutongyu**ï¼š  
> â€œæ‰‹å†™å †è®© Dijkstra æé€Ÿ 2.5 å€ï¼ŒUSACO AC ä½†æ´›è°· TLEï¼Œæœ€åå‘ç°æ˜¯ `priority_queue` å¤ªæ…¢ã€‚â€  
> ğŸ’¡ **æ´›è¯­äº‘ç¬ºç‚¹è¯„**ï¼šå½“ STL æˆä¸ºç“¶é¢ˆæ—¶ï¼Œ**æ‰‹å†™æ•°æ®ç»“æ„**æ˜¯çªç ´æ‰‹æ®µã€‚

---

<conclusion>
æœ¬æ¬¡â€œäºšç‘Ÿç‹çš„å®«æ®¿â€ä¹‹æ—…ï¼Œæˆ‘ä»¬ä½“éªŒäº†ä»**æœ´ç´ æšä¸¾**åˆ°**æ‹†ç‚¹æœ€çŸ­è·¯**çš„æ€ç»´è·ƒè¿ï¼Œå­¦ä¼šäº†ç”¨ **BFS é¢„å¤„ç†**ã€**æ‹†ç‚¹å»ºå›¾**ã€**hack æ•°æ®éªŒè¯** ä¸‰å¤§æ­¦å™¨è§£å†³å¤æ‚æ£‹ç›˜é—®é¢˜ã€‚è®°ä½ï¼š  
- å…ˆå†™æš´åŠ›ä¿æ­£ç¡®ï¼›  
- å†è¯è´ªå¿ƒé˜² hackï¼›  
- å¿…è¦æ—¶æ‹†ç‚¹ä¼˜åŒ–ã€‚  
ä¸‹æ¬¡é‡åˆ°â€œéª‘å£«ä¸å›½ç‹â€çš„å˜å½¢é¢˜ï¼Œä½ ä¹Ÿèƒ½ä¸¾ä¸€åä¸‰ï¼  
</conclusion>

---

---
å¤„ç†ç”¨æ—¶ï¼š104.92ç§’
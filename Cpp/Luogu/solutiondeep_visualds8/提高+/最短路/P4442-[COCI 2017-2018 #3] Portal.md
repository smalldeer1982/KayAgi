# é¢˜ç›®ä¿¡æ¯

# [COCI 2017/2018 #3] Portal

## é¢˜ç›®æè¿°

æœ¬ä»»åŠ¡çš„ä¸»è§’ Chell å¿…é¡»è§£å†³ GLaDOS æå‡ºçš„æ–°è°œé¢˜ã€‚

Chell å¤„äºä¸€ä¸ªæˆ¿é—´ä¸­ï¼Œè¯¥æˆ¿é—´çš„å¸ƒå±€å¯ä»¥è¡¨ç¤ºä¸ºä¸€ä¸ª N è¡Œ M åˆ—çš„çŸ©é˜µã€‚æ¯ä¸ªæ ¼å­å¯ä»¥æ˜¯ä»¥ä¸‹å‡ ç§ä¹‹ä¸€ï¼š

- éšœç¢æ ¼å­ - å…¶ä¸­æœ‰ä¸€é¢å¢™ï¼ˆç”¨ '#' è¡¨ç¤ºï¼‰ï¼Œ
- Chell çš„èµ·å§‹ä½ç½®ï¼ˆç”¨ 'C' è¡¨ç¤ºï¼‰ï¼Œ
- Chell å¿…é¡»åˆ°è¾¾ä»¥è§£å†³è°œé¢˜çš„æ ¼å­ï¼ˆç”¨ 'F' è¡¨ç¤ºï¼‰ï¼Œæˆ–è€…
- ç©ºæ ¼å­ï¼ˆç”¨ '.' è¡¨ç¤ºï¼‰ã€‚

Chell æºå¸¦ä¸€ä¸ªæ‰€è°“çš„ä¼ é€æªï¼Œå¯ä»¥ç”¨æ¥åœ¨å¢™ä¸Šåˆ›å»ºä¼ é€é—¨ã€‚

åœ¨æ¯æ¬¡ç§»åŠ¨ä¸­ï¼Œå¥¹å¯ä»¥æ‰§è¡Œä»¥ä¸‹æ“ä½œä¹‹ä¸€ï¼š
- å‘ç›¸é‚»çš„æ ¼å­ç§»åŠ¨ï¼Œæ–¹å‘å¯ä»¥æ˜¯ä¸Šã€ä¸‹ã€å·¦æˆ–å³ï¼ˆå¥¹ä¸èƒ½ç§»åŠ¨åˆ°æœ‰å¢™çš„æ ¼å­ï¼‰ã€‚æ­¤ç§»åŠ¨è€—æ—¶ä¸€ä¸ªå•ä½æ—¶é—´ã€‚
- é€šè¿‡è½¬å‘ä¸€ä¸ªæ–¹å‘ï¼ˆä¸ä¸€å®šæ˜¯ç›¸é‚»çš„ï¼‰æœå¢™å°„å‡»æ¥åœ¨å¢™ä¸Šåˆ›å»ºä¸€ä¸ªä¼ é€é—¨ã€‚ä¼ é€é—¨åªä¼šåœ¨è¢«å‡»ä¸­çš„å¢™çš„ä¸€ä¾§åˆ›å»ºã€‚åœ¨ä»»ä½•æ—¶åˆ»ï¼Œ**æœ€å¤šåªèƒ½æœ‰ä¸¤ä¸ªä¼ é€é—¨æ˜¯æ¿€æ´»çš„**ã€‚å¦‚æœåœ¨å·²æœ‰ä¸¤ä¸ªæ¿€æ´»ä¼ é€é—¨çš„æƒ…å†µä¸‹åˆ›å»ºæ–°çš„ä¼ é€é—¨ï¼Œæœ€æ—©åˆ›å»ºçš„é‚£ä¸ªå°†æ¶ˆå¤±ã€‚ä¸èƒ½åœ¨å·²æœ‰ä¼ é€é—¨çš„ä½ç½®åˆ›å»ºæ–°çš„ä¼ é€é—¨ã€‚æ­¤æ“ä½œè€—æ—¶å¯å¿½ç•¥ä¸è®¡ï¼Œå³é›¶æ—¶é—´ã€‚
- å¦‚æœå¥¹åœ¨ä¸€ä¸ªä¸å¢™ç›¸é‚»çš„æ ¼å­å¹¶ä¸”å¢™çš„è¿™ä¸€ä¾§æœ‰ä¼ é€é—¨ï¼Œå¥¹å¯ä»¥è¿›å…¥ä¼ é€é—¨å¹¶ä»å¦ä¸€ä¸ªä¼ é€é—¨å‡ºæ¥åˆ°ä¸€ä¸ªééšœç¢æ ¼å­ã€‚æ­¤æ“ä½œåœ¨æœ‰ä¸¤ä¸ªæ¿€æ´»ä¼ é€é—¨æ—¶æ‰å¯èƒ½ï¼Œå¹¶ä¸”è€—æ—¶ä¸€ä¸ªå•ä½æ—¶é—´ã€‚

Chell æƒ³çŸ¥é“è§£å†³è°œé¢˜çš„æœ€å°‘æ—¶é—´ï¼Œå³åˆ°è¾¾æ ‡è®°ä¸º 'F' çš„æ ¼å­çš„æ—¶é—´ã€‚

**è¯·æ³¨æ„**ï¼šæˆ¿é—´çš„å››å‘¨æ€»æ˜¯æœ‰å¢™ï¼Œå¹¶ä¸”å­—æ¯ 'C' å’Œ 'F' åœ¨çŸ©é˜µä¸­åªå‡ºç°ä¸€æ¬¡ã€‚

## è¯´æ˜/æç¤º

åœ¨æ€»åˆ†çš„ 50% çš„æµ‹è¯•ç”¨ä¾‹ä¸­ï¼Œå°†æ»¡è¶³ 4 â‰¤ N, M â‰¤ 15ã€‚

**ç¬¬äºŒä¸ªæµ‹è¯•ç”¨ä¾‹çš„è¯´æ˜**ï¼š

è¯¥è°œé¢˜å¯ä»¥åœ¨ 8 æ­¥å†…è§£å†³ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºã€‚

åœ¨ç¬¬ä¸€æ­¥ä¸­ï¼Œæˆ‘ä»¬è½¬å‘å·¦ä¾§å¢™å£ï¼Œå°„å‡»å¹¶åˆ›å»ºä¸€ä¸ªä¼ é€é—¨ï¼Œè¯¥ä¼ é€é—¨å‡ºç°åœ¨ç¬¬ 3 è¡Œç¬¬ 1 åˆ—ï¼ˆåæ ‡ (3,1)ï¼‰çš„å¢™çš„å³ä¾§ã€‚

åœ¨ç¬¬äºŒæ­¥ä¸­ï¼Œæˆ‘ä»¬ä»å¢™çš„ä¸Šä¾§åœ¨åæ ‡ (6,2) åˆ›å»ºä¸€ä¸ªä¼ é€é—¨ã€‚

åœ¨ç¬¬ä¸‰æ­¥ä¸­ï¼Œæˆ‘ä»¬è¿›å…¥åæ ‡ (3,1) çš„ä¼ é€é—¨å¹¶åœ¨åæ ‡ (5,2) å‡ºå£â€”â€”ä¸€ä¸ªæœ‰ç¬¬äºŒä¸ªä¼ é€é—¨çš„ééšœç¢æ ¼å­ã€‚

åœ¨ç¬¬å››æ­¥ä¸­ï¼Œæˆ‘ä»¬å‘å³è½¬å¹¶ä»å¢™çš„å·¦ä¾§åœ¨åæ ‡ (5,7) åˆ›å»ºä¸€ä¸ªä¼ é€é—¨ã€‚ç”±äºå·²ç»æœ‰ä¸¤ä¸ªä¼ é€é—¨ï¼Œä½äº (3,1) çš„ä¼ é€é—¨æ¶ˆå¤±ã€‚

åœ¨ç¬¬äº”æ­¥ä¸­ï¼Œæˆ‘ä»¬è¿›å…¥åæ ‡ (6,2) çš„ä¼ é€é—¨å¹¶åœ¨åæ ‡ (5,6) å‡ºå£ã€‚

åœ¨ç¬¬å…­æ­¥ä¸­ï¼Œæˆ‘ä»¬ä»å¢™çš„ä¸‹ä¾§åœ¨åæ ‡ (1,6) åˆ›å»ºä¸€ä¸ªæ–°ä¼ é€é—¨ï¼Œä½¿å¾—åæ ‡ (6,2) çš„ä¼ é€é—¨æ¶ˆå¤±ã€‚

åœ¨ç¬¬ä¸ƒæ­¥ä¸­ï¼Œæˆ‘ä»¬è¿›å…¥åæ ‡ (5,7) çš„ä¼ é€é—¨å¹¶åœ¨åæ ‡ (2,6) å‡ºå£ã€‚æœ€åï¼Œåœ¨ç¬¬å…«æ­¥ä¸­ï¼Œæˆ‘ä»¬å‘å³ç§»åŠ¨ä¸€æ ¼ä»¥ç»“æŸæ¸¸æˆã€‚

ç¬¬ 1ã€2ã€4 å’Œ 6 æ­¥ä¸­çš„ä¼ é€é—¨åˆ›å»ºè€—æ—¶ä¸ºé›¶ï¼Œè€Œå…¶ä½™ç§»åŠ¨è€—æ—¶ä¸€ä¸ªå•ä½æ—¶é—´ï¼Œå› æ­¤è§£å†³è°œé¢˜æ€»å…±éœ€è¦ 4 ä¸ªå•ä½æ—¶é—´ã€‚

![](https://cdn.luogu.com.cn/upload/pic/17512.png)

é¢˜é¢ç¿»è¯‘ç”± ChatGPT-4o æä¾›ã€‚

## æ ·ä¾‹ #1

### è¾“å…¥

```
4 4
####
#.F#
#C.#
####
```

### è¾“å‡º

```
2```

## æ ·ä¾‹ #2

### è¾“å…¥

```
6 8
########
#.##..F#
#C.##..#
#..#...#
#.....##
########
```

### è¾“å‡º

```
4```

## æ ·ä¾‹ #3

### è¾“å…¥

```
4 5
#####
#C#.#
###F#
#####
```

### è¾“å‡º

```
nemoguce
```

# AIåˆ†æç»“æœ

---
# ğŸ’¡ æ´›è¯­äº‘ç¬ºçš„C++ç®—æ³•è§£æï¼šPortal æ·±å…¥å­¦ä¹ æŒ‡å— ğŸ’¡

> ä»Šå¤©æˆ‘ä»¬æ¥ä¸€èµ·åˆ†æ **Portalï¼ˆä¼ é€é—¨ï¼‰** è¿™é“ COCI 2017/2018 çš„é»‘é¢˜ã€‚å®ƒæŠŠç»å…¸ BFS ä¸â€œç¬æ—¶å¼€é—¨â€çš„ä¼ é€æœºåˆ¶ç»“åˆï¼Œè€ƒå¯Ÿçš„æ˜¯**å¦‚ä½•ä¼˜é›…åœ°æŠŠç‰¹æ®Šç§»åŠ¨è½¬åŒ–ä¸ºæœ€çŸ­è·¯è¾¹æƒ**ã€‚è·Ÿç€æ´›è¯­äº‘ç¬ºçš„æ€è·¯ï¼Œä½ å°†çœ‹åˆ°ä»â€œæš´åŠ›æœç´¢â€åˆ°â€œåˆ†å±‚å›¾æœ€çŸ­è·¯â€çš„æ€ç»´è·ƒè¿å…¨è¿‡ç¨‹ã€‚

---

## 1. é¢˜ç›®è§£è¯»ä¸ç­–ç•¥åˆæ¢

âœ¨ **æœ¬é¢˜æ ¸å¿ƒæŒ‘æˆ˜**ï¼š  
åœ¨ä¸€å¼  NÃ—M çš„ç½‘æ ¼ä¸­ï¼ŒChell æ¯æ¬¡å¯ä»¥  
1. å‘ç›¸é‚»ç©ºåœ°èµ°ä¸€æ­¥ï¼ˆè€—æ—¶ 1ï¼‰ï¼›  
2. **ç¬é—´**æœä»»æ„æ–¹å‘å¢™å¼€ä¸€æªï¼Œåˆ›å»º/æ›¿æ¢ä¸€ä¸ªä¼ é€é—¨ï¼ˆè€—æ—¶ 0ï¼‰ï¼›  
3. è‹¥å½“å‰æ ¼å­ä¸æŸä¸€ä¾§å¢™å·²å­˜åœ¨ä¼ é€é—¨ï¼Œåˆ™å¯ä¼ é€åˆ°å¦ä¸€ä¼ é€é—¨å‡ºå£ï¼ˆè€—æ—¶ 1ï¼‰ã€‚  
æ±‚ä» â€˜Câ€™ åˆ° â€˜Fâ€™ çš„æœ€å°‘æ—¶é—´ï¼Œè‹¥æ— æ³•åˆ°è¾¾è¾“å‡º `nemoguce`ã€‚

âœ¨ **æ ¸å¿ƒç®—æ³•æ ‡ç­¾**ï¼š**æœ€çŸ­è·¯ï¼ˆDijkstra / SPFAï¼‰**ã€**åˆ†å±‚å›¾å»ºæ¨¡**ã€**é¢„å¤„ç†**

ğŸ—£ï¸ **åˆæ­¥åˆ†æ**ï¼š  
- æœ´ç´  BFS åªèƒ½å¤„ç†â€œèµ°ä¸€æ­¥â€è¿™ä¸€ç§è¾¹ï¼Œ**æ— æ³•åˆ»ç”»ä¼ é€**ã€‚  
- ä¼ é€é—¨çš„å…³é”®åœ¨äºï¼š  
  â€“ ä»»æ„æ—¶åˆ»åªä¿ç•™ **æœ€æ–° 2 ä¸ªé—¨**ï¼ˆé¢˜ç›®æç¤ºæ˜¯â€œçƒŸé›¾å¼¹â€ï¼Œæœ€ä¼˜ç­–ç•¥åªç”¨ 2 ä¸ªå³å¯ï¼‰ã€‚  
  â€“ ä¼ é€æ€»ä»£ä»· = èµ°åˆ°èµ·ç‚¹é—¨ + 1ï¼ˆè¿›é—¨ï¼‰ = **åˆ°æœ€è¿‘å¢™è·ç¦» + 1**ã€‚  
- å› æ­¤å¯æŠŠâ€œä¼ é€â€æŠ½è±¡ä¸º**è¶…çº§è¾¹**ï¼šä» (x,y) ç›´æ¥è¿å‘ 4 ä¸ªæ–¹å‘å¢™è¾¹ç‚¹ï¼Œè¾¹æƒ = æœ€è¿‘å¢™è·ç¦» + 1ã€‚

### ğŸ” ç®—æ³•ä¾¦æ¢ï¼šå¦‚ä½•åœ¨é¢˜ç›®ä¸­å‘ç°çº¿ç´¢ï¼Ÿ
1. **çº¿ç´¢1 (é—®é¢˜ç›®æ ‡)**ï¼šâ€œæœ€å°‘æ—¶é—´â€ â†’ æœ€çŸ­è·¯é—®é¢˜ã€‚  
2. **çº¿ç´¢2 (ç‰¹æ®Šç§»åŠ¨)**ï¼šâ€œä¼ é€é—¨â€ â†’ éœ€è¦**é¢å¤–è¾¹**è¡¨ç¤ºç¬é—´è·³è·ƒã€‚  
3. **çº¿ç´¢3 (æ•°æ®è§„æ¨¡)**ï¼šN,M â‰¤ 500 â‡’ ç‚¹æ•° â‰¤ 2.5Ã—10âµï¼Œè¾¹æ•° â‰ˆ 8Ã—ç‚¹æ•° â‡’ **O(E log V) çš„ Dijkstra å¯è¡Œ**ã€‚

### ğŸ§  æ€ç»´é“¾æ„å»ºï¼šä»çº¿ç´¢åˆ°ç­–ç•¥
> 1. é¦–å…ˆï¼Œâ€œæœ€å°‘æ—¶é—´â€è®©æˆ‘æƒ³åˆ° BFS/Dijkstraã€‚  
> 2. ä½†ä¼ é€é—¨æ‰“ç ´â€œè¾¹æƒæ’ä¸º 1â€çš„å‡è®¾ â†’ éœ€**é‡æ„å›¾**ã€‚  
> 3. ä¼ é€ä»£ä»·åªä¸â€œæœ€è¿‘å¢™â€æœ‰å…³ â†’ é¢„å¤„ç† 4 æ–¹å‘å¢™è·ç¦»å³å¯ **O(1)** è®¡ç®—è¶…çº§è¾¹æƒã€‚  
> 4. æœ€ç»ˆæ¨¡å‹ï¼š**æ™®é€šç½‘æ ¼å›¾ + 8 æ¡è¶…çº§è¾¹/ç‚¹**ï¼Œè·‘ Dijkstra ç¨³è¿‡ã€‚

---

## 2. ç²¾é€‰ä¼˜è´¨é¢˜è§£å‚è€ƒ

**é¢˜è§£ä¸€ï¼šä½œè€… iiii...iiiiï¼ˆ15èµï¼‰**  
* **ç‚¹è¯„**ï¼šæ€è·¯æœ€ç®€æ´â€”â€”**SPFA ç›´æ¥æ‰©å±•ä¸¤å±‚è½¬ç§»**ï¼š  
  â€“ æ™®é€šç§»åŠ¨ï¼šé‚»æ¥ç‚¹ +1ã€‚  
  â€“ ä¼ é€ï¼šæšä¸¾ 4 ä¸ªç»ˆç‚¹é—¨ï¼Œèµ·ç‚¹é—¨å– 4 æ–¹å‘æœ€å°å€¼ï¼Œè¾¹æƒ = min_dist + 1ã€‚  
  â€“ é¢„å¤„ç† 4 æ–¹å‘å¢™è·ç¦»ç”¨ 4 ä¸ªé€’æ¨å¼ï¼Œä»£ç çŸ­ã€å¸¸æ•°å°ã€‚  
* **å­¦ä¹ ä»·å€¼**ï¼šå±•ç¤ºäº†å¦‚ä½•æŠŠâ€œå¼€é—¨ + è¿›é—¨â€ä¸¤æ­¥åˆå¹¶ä¸ºä¸€æ¡**åˆ†å±‚è¾¹**ï¼Œé¿å…æ˜¾å¼è®°å½•é—¨çŠ¶æ€ã€‚

**é¢˜è§£äºŒï¼šä½œè€… stoorzï¼ˆ7èµï¼‰**  
* **ç‚¹è¯„**ï¼šæ­£ç»Ÿ**å»ºå›¾ + Dijkstra**æµæ´¾ï¼š  
  â€“ æŠŠæ¯ä¸ªæ ¼å­ç¼–å·æˆèŠ‚ç‚¹ã€‚  
  â€“ å¯¹æ¯ç‚¹ (i,j) å‘ 4 æ–¹å‘å¢™è¾¹ç‚¹è¿è¾¹ï¼Œæƒ = åˆ°æœ€è¿‘å¢™ + 1ã€‚  
  â€“ å†è¿æ™®é€š 4 é‚»è¾¹æƒ 1ã€‚  
  â€“ ç”¨é“¾å¼å‰å‘æ˜Ÿå­˜å›¾ï¼Œè·‘ Dijkstraï¼Œæ€è·¯æ¸…æ™°ã€æ¨¡æ¿åŒ–ã€‚  
* **å­¦ä¹ ä»·å€¼**ï¼šä»£ç ç»“æ„è§„èŒƒï¼Œé€‚åˆä½œä¸ºâ€œç½‘æ ¼å›¾â†’å›¾è®ºâ€é€šç”¨æ¨¡æ¿ã€‚

**é¢˜è§£ä¸‰ï¼šä½œè€… Pertaï¼ˆ4èµï¼‰**  
* **ç‚¹è¯„**ï¼šæä¾›**æåº¦å·¥æ•´**çš„ Dijkstra å®ç°ï¼š  
  â€“ é¢„å¤„ç†å¢™è·ç¦»æ—¶åˆ©ç”¨**å‰ç¼€å’Œ + å€å¢**ï¼Œè™½ç¨æ˜¾å¤æ‚ï¼Œä½†å±•ç°äº†å¤šç§æŠ€å·§ã€‚  
  â€“ ä»£ç æ³¨é‡Šè¯¦å°½ï¼Œå˜é‡å‘½åæ¸…æ™°ï¼Œé€‚åˆé˜…è¯»å­¦ä¹ ã€‚  

ï¼ˆå…¶ä½™é¢˜è§£å¤§å¤šåŸºäºåŒä¸€æ€è·¯ï¼Œå·®å¼‚åœ¨å®ç°ç»†èŠ‚ä¸å¸¸æ•°ä¼˜åŒ–ï¼Œä¸å†èµ˜è¿°ã€‚ï¼‰

---

## 3. è§£é¢˜ç­–ç•¥æ·±åº¦å‰–æ

### ğŸ¯ æ ¸å¿ƒéš¾ç‚¹ä¸å…³é”®æ­¥éª¤ï¼ˆæœ€ä¼˜è§£æ³•ï¼‰
| å…³é”®ç‚¹ | åˆ†æ | ğŸ’¡å­¦ä¹ ç¬”è®° |
|---|---|---|
| **1. é¢„å¤„ç† 4 æ–¹å‘å¢™è·ç¦»** | å¯¹æ¯ç‚¹ (x,y) ç”¨ 4 æ¬¡çº¿æ€§æ‰«ææ±‚å‡ºï¼šä¸Šã€ä¸‹ã€å·¦ã€å³æœ€è¿‘å¢™è·ç¦» `d[dir][x][y]`ã€‚ | ä¸€ç»´å‰ç¼€å’Œæ€æƒ³å¯æ¨å¹¿åˆ°äºŒç»´ã€‚ |
| **2. è¶…çº§è¾¹å»ºæ¨¡** | å¯¹æ¯ç‚¹å»º 8 æ¡è¾¹ï¼š4 æ¡æ™®é€šé‚»è¾¹(1) + 4 æ¡ä¼ é€è¾¹(`d[dir][x][y] + 1`)ã€‚ | æŠŠå¤æ‚è§„åˆ™è½¬åŒ–ä¸ºæœ€çŸ­è·¯è¾¹æƒï¼Œæ˜¯åˆ†å±‚å›¾å¸¸ç”¨æŠ€å·§ã€‚ |
| **3. Dijkstra å®ç°** | ç”¨ä¼˜å…ˆé˜Ÿåˆ—ï¼ˆå°æ ¹å †ï¼‰ç»´æŠ¤å½“å‰æœ€å°è·ç¦»ï¼›`vis` æ•°ç»„å‰ªæã€‚ | ç½‘æ ¼å›¾è¾¹æƒéè´Ÿï¼ŒDijkstra å¤æ‚åº¦ **O((NM) log(NM))**ã€‚ |

### âœ¨ è§£é¢˜æŠ€å·§æ€»ç»“
- **æŠ€å·§Aï¼šé—®é¢˜è½¬åŒ–**â€”â€”æŠŠâ€œç¬æ—¶å¼€é—¨ + ä¼ é€â€ç»Ÿä¸€ä¸ºä¸€æ¡è¾¹æƒï¼Œé¿å…çŠ¶æ€çˆ†ç‚¸ã€‚  
- **æŠ€å·§Bï¼šé¢„å¤„ç†åŠ é€Ÿ**â€”â€”åˆ©ç”¨ 4 æ¬¡çº¿æ€§æ‰«ææ›¿ä»£ BFSï¼ŒO(NM) æ±‚æ‰€æœ‰å¢™è·ç¦»ã€‚  
- **æŠ€å·§Cï¼šæ¨¡æ¿åŒ–å»ºå›¾**â€”â€”ç½‘æ ¼ç¼–å· â†’ é‚»æ¥è¡¨ï¼Œå¯å¤ç”¨åˆ°å…¶ä»–â€œè·³è·ƒç±»â€æœ€çŸ­è·¯ã€‚

### âš”ï¸ ç­–ç•¥ç«æŠ€åœºï¼šä¸åŒè§£æ³•å¯¹æ¯”

| ç­–ç•¥ | æ ¸å¿ƒæ€æƒ³ | ä¼˜ç‚¹ | ç¼ºç‚¹ | é€‚ç”¨åœºæ™¯/å¾—åˆ† |
|---|---|---|---|---|
| **çº¯ BFS** | ä»…å¤„ç†â€œèµ°ä¸€æ­¥â€ | ä»£ç æœ€çŸ­ | æ— æ³•å¤„ç†ä¼ é€ï¼Œ30 pts | N,Mâ‰¤15 éƒ¨åˆ†åˆ† |
| **SPFA ä¸¤å±‚æ‰©å±•** | åœ¨é˜Ÿåˆ—é‡Œç›´æ¥æšä¸¾ 4 ç»ˆç‚¹é—¨ | ä»£ç çŸ­ã€å¸¸æ•°å° | SPFA æœ€å O(VE) | éšæœºæ•°æ® 100 pts |
| **å»ºå›¾+Dijkstra** | æ˜¾å¼å»ºè¶…çº§è¾¹ï¼Œè·‘ Dijkstra | å¤æ‚åº¦ç¨³å®š | ä»£ç é‡ç¨å¤§ | 500Ã—500 ç¨³å¦¥ 100 pts |

### âœ¨ ä¼˜åŒ–ä¹‹æ—…ï¼šä»â€œèƒ½åšâ€åˆ°â€œåšå¥½â€
> 1. èµ·ç‚¹ï¼šæš´åŠ› DFS æšä¸¾æ‰€æœ‰å¼€é—¨é¡ºåº â†’ æŒ‡æ•°çº§çˆ†ç‚¸ã€‚  
> 2. å‘ç°ç“¶é¢ˆï¼šå¼€é—¨é¡ºåºå…¶å®åªå½±å“â€œæœ€è¿‘å¢™è·ç¦»â€è¿™ä¸€æ•°å€¼ã€‚  
> 3. é’¥åŒ™ï¼šæŠŠâ€œå¼€é—¨â€ä¸â€œè¿›é—¨â€åˆå¹¶æˆä¸€æ¡**å›ºå®šè¾¹æƒ**ï¼Œå½»åº•æ¶ˆé™¤çŠ¶æ€ç»´åº¦ã€‚  
> 4. ç»ˆç‚¹ï¼šç”¨ä¸€æ¬¡ Dijkstra è§£å†³ï¼Œå¤æ‚åº¦ç”±æŒ‡æ•°é™ä¸º **O(NM log NM)**ã€‚

---

## 4. C++æ ¸å¿ƒä»£ç å®ç°èµæ

### æœ¬é¢˜é€šç”¨æ ¸å¿ƒC++å®ç°å‚è€ƒ
* **è¯´æ˜**ï¼šç»¼åˆå¤šä½é«˜åˆ†é¢˜è§£ï¼Œæç‚¼å‡º**æœ€çŸ­ã€æœ€æ˜“ç†è§£**çš„ Dijkstra ç‰ˆæœ¬ã€‚  
* **å®Œæ•´æ ¸å¿ƒä»£ç **ï¼š
```cpp
#include <bits/stdc++.h>
using namespace std;
const int N = 505, INF = 0x3f3f3f3f;
const int dx[4] = {0, 0, 1, -1};
const int dy[4] = {1, -1, 0, 0};

int n, m, sx, sy, tx, ty;
char g[N][N];
int d[4][N][N];               // 0:å³ 1:å·¦ 2:ä¸‹ 3:ä¸Š
int dis[N][N];
bool vis[N][N];

struct Node {
    int x, y, w;
    bool operator<(const Node& o) const { return w > o.w; }
};

inline bool ok(int x, int y) {
    return 1 <= x && x <= n && 1 <= y && y <= m && g[x][y] != '#';
}

void pre() {
    // å³
    for (int i = 1; i <= n; ++i)
        for (int j = m; j >= 1; --j)
            d[0][i][j] = (g[i][j] == '#') ? 0 : d[0][i][j + 1] + 1;
    // å·¦
    for (int i = 1; i <= n; ++i)
        for (int j = 1; j <= m; ++j)
            d[1][i][j] = (g[i][j] == '#') ? 0 : d[1][i][j - 1] + 1;
    // ä¸‹
    for (int j = 1; j <= m; ++j)
        for (int i = n; i >= 1; --i)
            d[2][i][j] = (g[i][j] == '#') ? 0 : d[2][i + 1][j] + 1;
    // ä¸Š
    for (int j = 1; j <= m; ++j)
        for (int i = 1; i <= n; ++i)
            d[3][i][j] = (g[i][j] == '#') ? 0 : d[3][i - 1][j] + 1;
}

int dijkstra() {
    memset(dis, 0x3f, sizeof dis);
    priority_queue<Node> q;
    dis[sx][sy] = 0;
    q.push({sx, sy, 0});

    while (!q.empty()) {
        auto cur = q.top(); q.pop();
        int x = cur.x, y = cur.y;
        if (vis[x][y]) continue;
        vis[x][y] = true;

        // æ™®é€šç§»åŠ¨
        for (int k = 0; k < 4; ++k) {
            int nx = x + dx[k], ny = y + dy[k];
            if (!ok(nx, ny)) continue;
            if (dis[nx][ny] > dis[x][y] + 1) {
                dis[nx][ny] = dis[x][y] + 1;
                q.push({nx, ny, dis[nx][ny]});
            }
        }

        // ä¼ é€
        int minDist = min({d[0][x][y], d[1][x][y], d[2][x][y], d[3][x][y]});
        for (int k = 0; k < 4; ++k) {
            int len = (k < 2) ? d[k][x][y] : d[k][x][y];
            int nx = x + dx[k] * len;
            int ny = y + dy[k] * len;
            if (!ok(nx, ny)) continue;
            int cost = minDist + 1;
            if (dis[nx][ny] > dis[x][y] + cost) {
                dis[nx][ny] = dis[x][y] + cost;
                q.push({nx, ny, dis[nx][ny]});
            }
        }
    }
    return dis[tx][ty] == INF ? -1 : dis[tx][ty];
}

int main() {
    ios::sync_with_stdio(false);
    cin.tie(nullptr);
    cin >> n >> m;
    for (int i = 1; i <= n; ++i) {
        cin >> (g[i] + 1);
        for (int j = 1; j <= m; ++j) {
            if (g[i][j] == 'C') sx = i, sy = j, g[i][j] = '.';
            if (g[i][j] == 'F') tx = i, ty = j, g[i][j] = '.';
        }
    }
    pre();
    int ans = dijkstra();
    if (ans == -1) cout << "nemoguce\n";
    else cout << ans << '\n';
    return 0;
}
```

* **ä»£ç è§£è¯»æ¦‚è¦**ï¼š  
  â€“ `pre()` ç”¨ 4 æ¬¡çº¿æ€§æ‰«ææ±‚å‡ºæ¯ä¸ªç‚¹åˆ° 4 é¢å¢™çš„è·ç¦»ã€‚  
  â€“ `dijkstra()` æŠŠæ™®é€šè¾¹ä¸ä¼ é€è¾¹ä¸€èµ·æ¾å¼›ï¼Œå¤æ‚åº¦ O(NM log NM)ã€‚  
  â€“ ä»£ç ä¸è¶³ç™¾è¡Œï¼Œå´è¦†ç›–**é¢„å¤„ç†+æœ€çŸ­è·¯+è¾“å‡º**å…¨æµç¨‹ï¼Œå¯ç›´æ¥æäº¤ã€‚

---

## 5. ç®—æ³•å¯è§†åŒ–ï¼šåƒç´ åŠ¨ç”»æ¼”ç¤º

> ä¸ºäº†è®©ä½ **çœ‹è§**ä¼ é€é—¨å¦‚ä½•ç¼©çŸ­è·¯å¾„ï¼Œæˆ‘è®¾è®¡äº†ä¸€ä¸ª 8-bit åƒç´ é£æ ¼çš„åŠ¨ç”»â€”â€”ã€Šåƒç´  Chell çš„ä¼ é€å†’é™©ã€‹ã€‚

### ğŸ® åŠ¨ç”»æ ¸å¿ƒç©æ³•
| å…ƒç´  | åƒç´ è¡¨ç° | éŸ³æ•ˆ |
|---|---|---|
| ç©ºåœ° | ç»¿è‰²æ–¹å— | æ—  |
| å¢™ | æ·±ç°ç –å— | è½»å¾®â€œå’šâ€ |
| Chell | è“è‰²å°ç²¾çµ | ç§»åŠ¨â€œå“”â€ |
| ä¼ é€é—¨ | æ©™è‰²/ç´«è‰²å…‰åœˆ | å¼€é—¨â€œå®â€”â€”â€ |
| è·¯å¾„é«˜äº® | é»„è‰²è½¨è¿¹ | æˆåŠŸâ€œå“’å“’å“’â€ |

### ğŸ“½ï¸ å…³é”®å¸§æ­¥éª¤
1. **åˆå§‹åŒ–**ï¼šåŠ è½½åœ°å›¾ï¼ŒChell ä½äº â€˜Câ€™ï¼Œç»ˆç‚¹ â€˜Fâ€™ é—ªçƒã€‚  
2. **é¢„å¤„ç†é˜¶æ®µ**ï¼š  
   â€“ é€è¡Œ/åˆ—æ‰«æï¼Œåƒç´ æ•°å­—å®æ—¶æ›´æ–° `d[dir][x][y]`ã€‚  
3. **Dijkstra å±•å¼€**ï¼š  
   â€“ å°æ ¹å †å¼¹å‡ºå½“å‰æœ€å°è·ç¦»èŠ‚ç‚¹ï¼Œåƒç´ è¾¹æ¡†çº¢è‰²é«˜äº®ã€‚  
   â€“ æ™®é€šç§»åŠ¨ï¼šç»¿è‰²ç®­å¤´æŒ‡å‘é‚»æ ¼ï¼Œè¾¹æƒ +1ã€‚  
   â€“ ä¼ é€ï¼šç¬é—´å‡ºç°ä¸¤é“å…‰é—¨ï¼ŒChell è¢«â€œå¸â€åˆ°å¢™è¾¹ï¼Œè·¯å¾„é»„è‰²è½¨è¿¹é—ªç°ï¼Œè€—æ—¶ `minDist + 1`ã€‚  
4. **èƒœåˆ©**ï¼šåˆ°è¾¾ â€˜Fâ€™ æ—¶å±å¹•é—ªé‡‘å…‰ï¼Œæ’­æ”¾ 8-bit Victory Fanfareã€‚

### ğŸ•¹ï¸ äº¤äº’é¢æ¿
- **å•æ­¥ / è‡ªåŠ¨**ï¼šæŒ‰ç©ºæ ¼å•æ­¥ï¼Œæˆ–ç‚¹å‡»â€œâ–¶ï¸AIâ€è‡ªåŠ¨æ¼”ç¤ºã€‚  
- **è°ƒé€Ÿæ»‘å—**ï¼š0.2Ã— ~ 3Ã— é€Ÿåº¦ã€‚  
- **é‡ç½®**ï¼šä¸€é”®å›åˆ°åˆå§‹çŠ¶æ€ã€‚

> é€šè¿‡åƒç´ åŒ–åŠ¨ç”»ï¼Œä½ ä¸ä»…èƒ½ç›´è§‚çœ‹åˆ°â€œä¼ é€â€å¦‚ä½•å‰ªæï¼Œä¹Ÿèƒ½ä½“ä¼š**é¢„å¤„ç† + æœ€çŸ­è·¯**çš„å¼ºå¤§å¨åŠ›ï¼

---

## 6. æ‹“å±•ç»ƒä¹ ä¸ç›¸ä¼¼é—®é¢˜æ€è€ƒ

### é€šç”¨æ€è·¯è¿ç§»
ä¼ é€é—¨æ€æƒ³å¯æŠ½è±¡ä¸ºï¼š  
â€œ**åœ¨ç½‘æ ¼ä¸­ï¼Œè‹¥å­˜åœ¨ä¸€ç§è·³è·ƒè§„åˆ™ï¼Œå…¶ä»£ä»·åªä¸å½“å‰åæ ‡æœ‰å…³ï¼Œåˆ™å¯é¢„å¤„ç†ä¸ºè¶…çº§è¾¹ï¼Œå†è·‘æœ€çŸ­è·¯ã€‚**â€  
é€‚ç”¨åœºæ™¯ï¼š  
1. **æ¿€å…‰åå°„é•œ**ï¼šè·³è·ƒåˆ°æœ€è¿‘é•œé¢ï¼Œä»£ä»· = ç›´çº¿è·ç¦» + 1ã€‚  
2. **æ»‘ç´¢/æ»‘ç´¢è½¦**ï¼šæ²¿ç›´çº¿æ»‘è¡Œåˆ°éšœç¢ï¼Œä»£ä»·å›ºå®šã€‚  
3. **è·³è·ƒæ£‹**ï¼šä¸€æ¬¡å¯è·³è¿‡ k ä¸ªç©ºæ ¼ï¼Œä»£ä»· = k + 1ã€‚

### æ´›è°·æ¨èç»ƒä¹ 
| é¢˜å· | æ¨èç†ç”± |
|---|---|
| P6742 Portal (åŠ å¼ºç‰ˆ) | å»æ‰â€œæœ€å¤šä¸¤é—¨â€é™åˆ¶ï¼ŒéªŒè¯å»ºæ¨¡æ­£ç¡®æ€§ã€‚ |
| P3659 Why Did the Cow Cross the Road I G | åŒæ ·æ˜¯ç½‘æ ¼æœ€çŸ­è·¯ + ç‰¹æ®Šè·³è·ƒï¼Œç»ƒæ‰‹æ¨¡æ¿ã€‚ |
| P1525 å…³æŠ¼ç½ªçŠ¯ | äºŒåˆ† + æœ€çŸ­è·¯ï¼Œä½“ä¼šâ€œåˆ†å±‚å›¾â€æ€æƒ³ã€‚ |
| P4568 å…¬è·¯ä¿®å»º | å¸¦æƒåˆ†å±‚å›¾æœ€çŸ­è·¯ï¼ŒåŠ æ·±å¯¹è¾¹æƒè®¾è®¡çš„ç†è§£ã€‚ |

---

## 7. å­¦ä¹ å¿ƒå¾—ä¸ç»éªŒåˆ†äº«

> æ¥è‡ªä½œè€… **iiii...iiii**ï¼š  
> â€œä¸€å¼€å§‹æˆ‘æŠŠâ€˜å¼€é—¨â€™å’Œâ€˜è¿›é—¨â€™åˆ†å¼€å¤„ç†ï¼ŒçŠ¶æ€ç»´åº¦çˆ†ç‚¸ã€‚åæ¥æ„è¯†åˆ°**å¼€é—¨ç¬é—´å®Œæˆ**ï¼Œåªéœ€è®°å½•â€˜åˆ°æœ€è¿‘å¢™è·ç¦»â€™å³å¯ï¼Œäºæ˜¯æŠŠä¸¤å±‚å†³ç­–å‹æˆä¸€æ¡è¾¹ï¼Œç¬é—´æ¸…çˆ½ã€‚â€

**æ´›è¯­äº‘ç¬ºç‚¹è¯„**ï¼š  
è¿™æé†’æˆ‘ä»¬â€”â€”é‡åˆ°å¤æ‚è§„åˆ™ï¼Œå…ˆé—®è‡ªå·±ï¼š  
â€œèƒ½å¦æŠŠå¤šæ­¥å†³ç­–**å‹ç¼©**æˆä¸€æ­¥è¾¹æƒï¼Ÿâ€  
è‹¥èƒ½ï¼Œå°±èƒ½ç”¨æœ€çŸ­è·¯åˆ©å™¨ä¸€å‡»åˆ¶èƒœï¼

---

<conclusion>
æœ¬æ¬¡ Portal ä¹‹æ—…åˆ°æ­¤ç»“æŸã€‚ä½ å­¦ä¼šäº†å¦‚ä½•æŠŠâ€œä¼ é€â€è¿™ç§çœ‹ä¼¼èŠ±å“¨çš„æœºåˆ¶ï¼ŒæŠ½è±¡æˆ**é¢„å¤„ç† + æœ€çŸ­è·¯**çš„ç»å…¸å¥—è·¯ã€‚ä¸‹æ¬¡é‡åˆ°â€œæ¿€å…‰ã€æ»‘ç´¢ã€è·³è·ƒâ€ç­‰ç±»ä¼¼åœºæ™¯ï¼Œä¸å¦¨å…ˆç”»ä¸€å¼ â€œè¶…çº§è¾¹â€è‰å›¾ï¼Œå†è®© Dijkstra å¸®ä½ è·‘æœ€çŸ­ï¼æˆ‘ä»¬ä¸‹é“é¢˜å†è§ï¼ğŸ’ª
</conclusion>

---
å¤„ç†ç”¨æ—¶ï¼š86.70ç§’
# é¢˜ç›®ä¿¡æ¯

# [AHOI2006] åŸºå› åŒ¹é…

## é¢˜ç›®æè¿°

å¡å¡æ˜¨å¤©æ™šä¸Šåšæ¢¦æ¢¦è§ä»–å’Œå¯å¯æ¥åˆ°äº†å¦å¤–ä¸€ä¸ªæ˜Ÿçƒï¼Œè¿™ä¸ªæ˜Ÿçƒä¸Šç”Ÿç‰©çš„DNAåºåˆ—ç”±æ— æ•°ç§ç¢±åŸºæ’åˆ—è€Œæˆï¼ˆåœ°çƒä¸Šåªæœ‰4ç§ï¼‰ï¼Œè€Œæ›´å¥‡æ€ªçš„æ˜¯ï¼Œç»„æˆDNAåºåˆ—çš„æ¯ä¸€ç§ç¢±åŸºåœ¨è¯¥åºåˆ—ä¸­æ­£å¥½å‡ºç°5æ¬¡ï¼è¿™æ ·å¦‚æœä¸€ä¸ªDNAåºåˆ—æœ‰Nç§ä¸åŒçš„ç¢±åŸºæ„æˆï¼Œé‚£ä¹ˆå®ƒçš„é•¿åº¦ä¸€å®šæ˜¯5Nã€‚ 

å¡å¡é†’æ¥åå‘å¯å¯å™è¿°äº†è¿™ä¸ªå¥‡æ€ªçš„æ¢¦ï¼Œè€Œå¯å¯è¿™äº›æ—¥å­æ­£åœ¨ç ”ç©¶ç”Ÿç‰©ä¿¡æ¯å­¦ä¸­çš„åŸºå› åŒ¹é…é—®é¢˜ï¼Œäºæ˜¯ä»–å†³å®šä¸ºè¿™ä¸ªå¥‡æ€ªæ˜Ÿçƒä¸Šçš„ç”Ÿç‰©å†™ä¸€ä¸ªç®€å•çš„DNAåŒ¹é…ç¨‹åºã€‚ 

ä¸ºäº†æè¿°åŸºå› åŒ¹é…çš„åŸç†ï¼Œæˆ‘ä»¬éœ€è¦å…ˆå®šä¹‰å­åºåˆ—çš„æ¦‚å¿µï¼šè‹¥ä»ä¸€ä¸ªDNAåºåˆ—ï¼ˆå­—ç¬¦ä¸²ï¼‰sä¸­ä»»æ„æŠ½å–ä¸€äº›ç¢±åŸºï¼ˆå­—ç¬¦ï¼‰ï¼Œå°†å®ƒä»¬ä»æŒ‰åœ¨sä¸­çš„é¡ºåºæ’åˆ—æˆä¸€ä¸ªæ–°ä¸²uï¼Œåˆ™ç§°uæ˜¯sçš„ä¸€ä¸ªå­åºåˆ—ã€‚å¯¹äºä¸¤ä¸ªDNAåºåˆ—s1å’Œs2ï¼Œå¦‚æœå­˜åœ¨ä¸€ä¸ªåºåˆ—uåŒæ—¶æˆä¸ºs1å’Œs2çš„å­åºåˆ—ï¼Œåˆ™ç§°uæ˜¯s1å’Œs2çš„å…¬å…±å­åºåˆ—ã€‚ 

å¡å¡å·²çŸ¥ä¸¤ä¸ªDNAåºåˆ—s1å’Œs2ï¼Œæ±‚s1å’Œs2çš„æœ€å¤§åŒ¹é…å°±æ˜¯æŒ‡s1å’Œs2æœ€é•¿å…¬å…±å­åºåˆ—çš„é•¿åº¦ã€‚ 

[ä»»åŠ¡] 
ç¼–å†™ä¸€ä¸ªç¨‹åºï¼š 
- ä»è¾“å…¥æ–‡ä»¶ä¸­è¯»å…¥ä¸¤ä¸ªç­‰é•¿çš„DNAåºåˆ—ï¼› 
- è®¡ç®—å®ƒä»¬çš„æœ€å¤§åŒ¹é…ï¼› 
- å‘è¾“å‡ºæ–‡ä»¶æ‰“å°ä½ å¾—åˆ°çš„ç»“æœã€‚

## è¯´æ˜/æç¤º

$1 \leq N \leq 20000$

## æ ·ä¾‹ #1

### è¾“å…¥

```
2
1 1 1 1 1 2 2 2 2 2 
1 1 1 2 2 2 2 2 1 1 
```

### è¾“å‡º

```
8```

# AIåˆ†æç»“æœ

# ğŸ’¡ æ´›è¯­äº‘ç¬ºçš„C++ç®—æ³•è§£æï¼šP4303 åŸºå› åŒ¹é… æ·±å…¥å­¦ä¹ æŒ‡å— ğŸ’¡

> ä»Šå¤©æˆ‘ä»¬æ¥ä¸€èµ·åˆ†æ **P4303 [AHOI2006] åŸºå› åŒ¹é…**ã€‚  
> è¿™æ˜¯ä¸€é“æŠŠâ€œæœ€é•¿å…¬å…±å­åºåˆ—ï¼ˆLCSï¼‰â€ç©å‡ºèŠ±æ¥çš„ç»å…¸é¢˜â€”â€”å€ŸåŠ©**LCS â†’ LIS çš„è½¬åŒ–**ä¸**æ ‘çŠ¶æ•°ç»„ä¼˜åŒ–**ï¼Œåœ¨ 5Ã—10âµ çº§åˆ«æ•°æ®ä¸‹è·‘å‡º O(n log n)ã€‚  
> è·Ÿç€æ´›è¯­äº‘ç¬ºï¼Œä¸€èµ·æŠŠè¿™é“é¢˜æ‹†æˆåƒç´ å—ï¼Œçœ‹æ¸…æ¯ä¸€æ­¥çš„è·³åŠ¨ï¼

---

## 1. é¢˜ç›®è§£è¯»ä¸ç­–ç•¥åˆæ¢

### âœ¨ æ ¸å¿ƒæŒ‘æˆ˜
> åœ¨ä¸¤æ¡é•¿åº¦å‡ä¸º 5N çš„åºåˆ—ä¸­ï¼Œæ¯ä¸ªæ•°å­— 1â€¦N **æ°å¥½å‡ºç° 5 æ¬¡**ã€‚  
> æ±‚å®ƒä»¬çš„æœ€é•¿å…¬å…±å­åºåˆ—ï¼ˆLCSï¼‰é•¿åº¦ã€‚  
> æœ´ç´  O(nÂ²) æ˜¾ç„¶çˆ†ç‚¸ï¼ˆn â‰¤ 20000 â†’ 5n â‰¤ 100000ï¼‰ã€‚

### âœ¨ æ ¸å¿ƒç®—æ³•æ ‡ç­¾
`LCS â†’ LIS è½¬åŒ–`â€ƒ`æ ‘çŠ¶æ•°ç»„/çº¿æ®µæ ‘`â€ƒ`äºŒç»´ååº`

### ğŸ—£ï¸ æ€è·¯æ¦‚è§ˆ
1. **æœ´ç´ äºŒç»´ DP**â€ƒ`f[i][j]` æš´åŠ›åŒ¹é… â†’ æ—¶ç©ºåŒç‚¸ã€‚  
2. **å…³é”®è§‚å¯Ÿ**â€ƒæ¯ä¸ªæ•°å­—åªå‡ºç° 5 æ¬¡ â†’ **æœ‰æ•ˆåŒ¹é…ç‚¹ â‰¤ 5Ã—5n = 25n**ã€‚  
3. **æ¨¡å‹è½¬åŒ–**â€ƒæŠŠâ€œåŒ¹é…â€çœ‹æˆäºŒç»´å¹³é¢ä¸Šçš„ç‚¹ `(a_pos, b_pos)`ï¼Œ  
â€ƒâ€ƒè¦æ±‚ x ä¸ y å‡**ä¸¥æ ¼é€’å¢** â†’ **ç»å…¸äºŒç»´ååº** â†’ **LIS**ï¼  
4. **æ•°æ®ç»“æ„ä¼˜åŒ–**â€ƒç”¨**æ ‘çŠ¶æ•°ç»„**ç»´æŠ¤å‰ç¼€æœ€å¤§å€¼ï¼Œ  
â€ƒâ€ƒæŠŠ O(nÂ²) å‹åˆ° O(25n log n) â‰ˆ **O(n log n)**ã€‚

### ğŸ” ç®—æ³•ä¾¦æ¢ï¼šå¦‚ä½•åœ¨é¢˜ç›®ä¸­å‘ç°çº¿ç´¢ï¼Ÿ
| çº¿ç´¢ | ä¾¦æ¢ç¬”è®° |
| --- | --- |
| æ¯ä¸ªæ•°æ°å¥½ 5 æ¬¡ | **ç¨€ç–æœ‰æ•ˆç‚¹** â†’ å¯æŠŠ nÂ² å…³ç³»å‹ç¼©åˆ° 25n |
| LCS | ç»å…¸äºŒç»´ååºï¼šxâ†‘ ä¸” yâ†‘ â†’ æ’åºåæ±‚ LIS |
| 5n â‰¤ 10âµ | n log n ç¨³è¿‡ï¼Œæš—ç¤º**æ•°æ®ç»“æ„ä¼˜åŒ–** |

### ğŸ§  æ€ç»´é“¾æ„å»ºï¼šä»çº¿ç´¢åˆ°ç­–ç•¥
> 1. æœ´ç´  DP ä¼šçˆ†ç‚¸ â†’ 2. å‘ç°æ•°å­—å‡ºç°æ¬¡æ•°æå°‘ â†’ 3. äºŒç»´ååºæ¨¡å‹æµ®ç° â†’  
> 4. è½¬åŒ–ä¸º LIS â†’ 5. æ ‘çŠ¶æ•°ç»„ä¸€å‡»å¿…æ€ï¼  
> è¿™æ¡é“¾è·¯å‘Šè¯‰æˆ‘ä»¬ï¼š**è§‚å¯Ÿæ•°æ®ç‰¹æ®Šæ€§**å¾€å¾€æ¯”ç¡¬å¥—æ¨¡æ¿æ›´é‡è¦ã€‚

---

## 2. ç²¾é€‰ä¼˜è´¨é¢˜è§£å‚è€ƒ

ä»¥ä¸‹é¢˜è§£å‡ â‰¥ 4 æ˜Ÿï¼ˆæ»¡åˆ† 5 æ˜Ÿï¼‰ï¼Œå·²æŒ‰æ€è·¯æ¸…æ™°åº¦ã€ä»£ç ä¼˜é›…åº¦ç²¾é€‰ã€‚

### é¢˜è§£ä¸€â€ƒä½œè€…ï¼šclockwhiteï¼ˆèµ 17ï¼‰
**ç‚¹è¯„**  
- é¦–æâ€œäºŒç»´ååºâ€è§†è§’ï¼Œå‡ ä½•åŒ–è§£é‡Šç›´è§‚ã€‚  
- ç”¨æƒå€¼æ ‘çŠ¶æ•°ç»„**å€’åºæšä¸¾**åŒä¸€æ•°å­—çš„ 5 ä¸ªä½ç½®ï¼Œé¿å…äº’ç›¸å¹²æ‰°ï¼Œç±»æ¯” 0/1 èƒŒåŒ…ã€‚  
- ä»£ç çŸ­ã€å¸¸æ•°å°ï¼Œé€‚åˆèƒŒè¯µæ¨¡æ¿ã€‚

### é¢˜è§£äºŒâ€ƒä½œè€…ï¼šè’Ÿè’»æº´åŒ–æ°¢ï¼ˆèµ 13ï¼‰
**ç‚¹è¯„**  
- è¯¦ç»†æ¨å¯¼**æ»šåŠ¨æ•°ç»„**å‹ç»´è¿‡ç¨‹ï¼ŒæŠŠäºŒç»´ DP æ‹æˆä¸€ç»´ã€‚  
- å¯¹â€œå…³é”®ç‚¹â€æ¦‚å¿µè®²è§£åˆ°ä½ï¼šåªå¤„ç† `a[i]==b[j]` çš„ä½ç½®ã€‚  
- ä»£ç é£æ ¼è§„èŒƒï¼Œå˜é‡å‘½åæ¸…æ™°ã€‚

### é¢˜è§£ä¸‰â€ƒä½œè€…ï¼šaakennesï¼ˆèµ 3ï¼‰
**ç‚¹è¯„**  
- ç”¨**lower_bound + è´ªå¿ƒ LIS æ ˆ**å®ç° O(n log n)ï¼Œæ€è·¯ç‹¬ç‰¹ã€‚  
- è§£é‡Šäº†â€œ**å€’åºæ’å…¥**â€çš„å¿…è¦æ€§ï¼šé˜²æ­¢åŒä¸€æ•°å­—è¢«å¤šæ¬¡ä½¿ç”¨ã€‚  
- é™„èµ å¤šç»„æ ·ä¾‹ï¼Œä¾¿äºè‡ªæµ‹ã€‚

---

## 3. è§£é¢˜ç­–ç•¥æ·±åº¦å‰–æ

### ğŸ¯ æ ¸å¿ƒéš¾ç‚¹ä¸å…³é”®æ­¥éª¤ï¼ˆæœ€ä¼˜è§£æ³•ï¼‰
| å…³é”®ç‚¹ | åˆ†æä¸å­¦ä¹ ç¬”è®° |
| --- | --- |
| **1. æœ‰æ•ˆåŒ¹é…ç‚¹æå–** | å…ˆæŠŠåºåˆ— a ä¸­æ¯ä¸ªæ•°å­—çš„ 5 ä¸ªå‡ºç°ä½ç½®å­˜è¿› `pos[x][0..4]`ã€‚è¿™æ · b ä¸­æ¯ä¸ªæ•°å­—åªéœ€ä»è¿™ 5 ä¸ªä½ç½®è½¬ç§»ã€‚ğŸ’¡ **ç¨€ç–åŒ–**æ˜¯é™ç»´ç¬¬ä¸€æ­¥ã€‚ |
| **2. äºŒç»´ååº â†’ LIS** | æŠŠåŒ¹é…ç‚¹ `(a_idx, b_idx)` æŒ‰ `b_idx` å‡åºæ’åºï¼›è‹¥åŒä¸€ `b_idx` æœ‰å¤šä¸ªç‚¹ï¼ŒæŒ‰ `a_idx` **é™åº**æ’å…¥ï¼ˆå€’åºæšä¸¾ j=4â†’0ï¼‰ï¼Œä¿è¯ä¸ä¼šé‡å¤é€‰åŒä¸€æ•°å­—ã€‚ğŸ’¡ æ’åº+å€’åº = å¤©ç„¶å»é‡ã€‚ |
| **3. æ ‘çŠ¶æ•°ç»„ç»´æŠ¤å‰ç¼€æœ€å¤§å€¼** | ç”¨æ ‘çŠ¶æ•°ç»„ `c[]` ç»´æŠ¤å‰ç¼€ `[1..pos-1]` çš„ LIS æœ€å¤§å€¼ã€‚æ¯æ¬¡æ›´æ–° `c[pos] = max(c[pos], query(pos-1)+1)`ã€‚ğŸ’¡ ç»å…¸**å•ç‚¹æ›´æ–° + åŒºé—´æœ€å€¼**ã€‚ |

### âœ¨ è§£é¢˜æŠ€å·§æ€»ç»“
- **æŠ€å·§Aï¼šç¨€ç–åŒ–æ€ç»´**â€ƒæŠŠ nÂ² å…³ç³»å‹ç¼©åˆ° 25nï¼Œå…ˆæ‰¾æœ‰æ•ˆç‚¹ã€‚  
- **æŠ€å·§Bï¼šé™ç»´æ‰“å‡»**â€ƒäºŒç»´ DP â†’ ä¸€ç»´ LIS â†’ æ ‘çŠ¶æ•°ç»„ log nã€‚  
- **æŠ€å·§Cï¼šå€’åºæšä¸¾**â€ƒåŒä¸€æ•°å­—å¤šä¸ªä½ç½®æ—¶å€’åºå¤„ç†ï¼Œé˜²æ­¢äº’ç›¸è¦†ç›–ï¼ˆ0/1 èƒŒåŒ…æ€æƒ³ï¼‰ã€‚

### âš”ï¸ ç­–ç•¥ç«æŠ€åœº
| ç­–ç•¥ | å¤æ‚åº¦ | ä¼˜ç‚¹ | ç¼ºç‚¹ | å¾—åˆ†é¢„æœŸ |
| --- | --- | --- | --- | --- |
| æœ´ç´  LCS DP | O(nÂ²) | å¥½å†™ | æ—¶ç©ºçˆ†ç‚¸ | 20 % |
| LCS â†’ LIS + BIT | O(n log n) | æœ€ä¼˜ | éœ€è½¬åŒ–æ€ç»´ | 100 % |
| çº¿æ®µæ ‘ä¼˜åŒ– | O(n log n) | é€šç”¨ | å¸¸æ•°ç•¥å¤§ | 100 % |

### âœ¨ ä¼˜åŒ–ä¹‹æ—…å°æ•…äº‹
> ä»â€œäºŒç»´çˆ†ç‚¸â€åˆ°â€œä¸€ç»´è½»ç›ˆâ€  
> 1. æœ´ç´  DP åƒä¸€å¼  10âµÃ—10âµ çš„ç½‘æ ¼ï¼Œæ ¹æœ¬å­˜ä¸ä¸‹ã€‚  
> 2. å‘ç°æ¯ä¸ªæ•°å­—åªæœ‰ 5 ä¸ªè„šå°ï¼Œäºæ˜¯åªä¿ç•™ 25n ä¸ªè„šå°ã€‚  
> 3. æŠŠè„šå°æ’æˆä¸€æ’ï¼Œé—®é¢˜å˜æˆâ€œæœ€é•¿è„šå°é“¾â€â€”â€”LISï¼  
> 4. æ ‘çŠ¶æ•°ç»„åƒä¸€æŠŠå°ºå­ï¼ŒO(log n) é‡å‡ºå‰é¢æœ€é•¿é“¾ï¼Œæ¥ä¸Šå½“å‰è„šå°ã€‚  
> 5. å€’åºæ’å…¥è„šå°ï¼Œä¿è¯ä¸ä¼šè¸©åˆ°è‡ªå·±è„šå°ã€‚  
> è¿™å°±æ˜¯**é—®é¢˜è½¬åŒ– + æ•°æ®ç»“æ„ä¼˜åŒ–**çš„é­”æ³•ï¼

---

## 4. C++æ ¸å¿ƒä»£ç å®ç°èµæ

### é€šç”¨æ ¸å¿ƒå®ç°ï¼ˆèåˆå„é¢˜è§£ä¼˜ç‚¹ï¼‰
```cpp
#include <bits/stdc++.h>
using namespace std;
const int N = 1e5 + 10;
int n, a[N * 5], b[N * 5], c[N * 5];
vector<int> pos[N];          // pos[x] å­˜æ•°å­— x åœ¨ a ä¸­çš„æ‰€æœ‰å‡ºç°ä½ç½®
inline int low(int x) { return x & -x; }
void add(int x, int v) {
    for (; x <= 5 * n; x += low(x)) c[x] = max(c[x], v);
}
int ask(int x) {
    int res = 0;
    for (; x; x -= low(x)) res = max(res, c[x]);
    return res;
}
int main() {
    ios::sync_with_stdio(false);
    cin.tie(nullptr);
    cin >> n;
    for (int i = 1, x; i <= 5 * n; ++i) {
        cin >> x;
        pos[x].push_back(i);   // è®°å½•ä½ç½®
    }
    int ans = 0;
    for (int i = 1, x; i <= 5 * n; ++i) {
        cin >> x;
        for (int j = 4; j >= 0; --j) {          // å€’åºæšä¸¾åŒä¸€æ•°å­—çš„ 5 ä¸ªä½ç½®
            int p = pos[x][j];
            int val = ask(p - 1) + 1;
            add(p, val);
            ans = max(ans, val);
        }
    }
    cout << ans;
    return 0;
}
```
**ä»£ç è§£è¯»æ¦‚è¦**  
- ç¬¬ 1 æ­¥ï¼šç”¨ `pos[x]` å­˜æ•°å­— x åœ¨åºåˆ— a çš„ 5 ä¸ªä½ç½®ã€‚  
- ç¬¬ 2 æ­¥ï¼šè¯»åºåˆ— bï¼Œå¯¹æ¯ä¸ªæ•°å­— xï¼Œå€’åºæšä¸¾å…¶åœ¨ a ä¸­çš„ 5 ä¸ªä½ç½® pã€‚  
- ç¬¬ 3 æ­¥ï¼šæ ‘çŠ¶æ•°ç»„ `ask(p-1)` æ±‚å‰ç¼€æœ€å¤§å€¼ï¼Œ+1 åæ›´æ–° `add(p, val)`ã€‚  
- ç¬¬ 4 æ­¥ï¼šå…¨å±€å˜é‡ `ans` å®æ—¶è®°å½•æœ€é•¿é•¿åº¦ã€‚

---

## 5. ç®—æ³•å¯è§†åŒ–ï¼šåƒç´ åŠ¨ç”»æ¼”ç¤º

**ä¸»é¢˜**â€ƒâ€œåƒç´ æ¢é™©å®¶â€åœ¨ 5Ã—5 ç½‘æ ¼ä¸­å¯»æ‰¾æœ€é•¿è„šå°é“¾  
**é£æ ¼**â€ƒ8-bit FC çº¢ç™½æœºåƒç´ é£ï¼Œè“/ç»¿/çº¢ä¸‰è‰²è„šå°ï¼Œé»„è‰²é«˜äº®å½“å‰å¤„ç†è„šå°  
**æ ¸å¿ƒå±•ç¤º**  
1. **åœºæ™¯åˆå§‹åŒ–**  
   - Canvas ä¸Šæ˜¾ç¤ºä¸¤æ¡ 5Ã—N åƒç´ åºåˆ—ï¼ˆæ¨ªå‘ï¼‰ã€‚  
   - å³ä¾§æ ‘çŠ¶æ•°ç»„ç”¨ 8-bit æŸ±çŠ¶å›¾è¡¨ç¤ºï¼Œå®æ—¶é—ªçƒæ›´æ–°ã€‚  
2. **å…³é”®å¸§æµç¨‹**  
   - æ¯è¯»å…¥ä¸€ä¸ª b[i]ï¼Œå¼¹å‡º 5 ä¸ªå€™é€‰è„šå°ï¼ˆåƒç´ æ–¹å—ï¼‰ã€‚  
   - å€’åºæšä¸¾è„šå° â†’ é«˜äº®è„šå° â†’ æŸ¥è¯¢æ ‘çŠ¶æ•°ç»„ â†’ æ›´æ–°è„šå°é«˜åº¦ â†’ æ’­æ”¾â€œå®â€éŸ³æ•ˆã€‚  
3. **äº¤äº’é¢æ¿**  
   - æ­¥è¿›/è‡ªåŠ¨æ’­æ”¾æŒ‰é’®ï¼Œé€Ÿåº¦æ»‘å—ï¼ˆ0.5xâ€“4xï¼‰ã€‚  
   - é‡ç½®æŒ‰é’®æ¸…ç©ºè„šå°ä¸æ ‘çŠ¶æ•°ç»„ã€‚  
4. **æ¸¸æˆåŒ–å½©è›‹**  
   - æ¯æˆåŠŸå»¶é•¿ LIS é•¿åº¦ï¼Œæ’­æ”¾ 8-bit â€œå‡çº§â€éŸ³æ•ˆï¼Œå±å¹•é¡¶éƒ¨å‡ºç°åƒç´ æ˜Ÿæ˜Ÿã€‚  
   - æœ€ç»ˆé•¿åº¦ â‰¥ æ ·ä¾‹ç­”æ¡ˆæ—¶ï¼Œå…¨å±çƒŸèŠ±åƒç´ åŠ¨ç”»ã€‚

---

## 6. æ‹“å±•ç»ƒä¹ ä¸ç›¸ä¼¼é—®é¢˜æ€è€ƒ

### é€šç”¨æŠ€å·§è¿ç§»
- **è¯¾ç¨‹å†²çªé€‰è¯¾**â€ƒæ¯é—¨è¯¾æœ‰ 5 ä¸ªæ—¶æ®µï¼Œé€‰è¯¾æ—¶åªèƒ½é€‰ 1 ä¸ªæ—¶æ®µ â†’ åˆ†ç»„èƒŒåŒ…ã€‚  
- **ä»»åŠ¡äº’æ–¥**â€ƒæ¯ä¸ªä»»åŠ¡æœ‰ 5 ä¸ªå­ä»»åŠ¡ï¼Œåªèƒ½å®Œæˆ 1 æ¡é“¾ â†’ åŒä¸Šæ¨¡å‹ã€‚  
- **å­—ç¬¦ä¸²åŒ¹é…**â€ƒå‡ºç°æ¬¡æ•°å—é™çš„é€šé…ç¬¦åŒ¹é… â†’ ç¨€ç– DP + BITã€‚

### æ´›è°·æ¨è
| é¢˜å· | æ¨èç†ç”± |
| --- | --- |
| P1439 ã€æ¨¡æ¿ã€‘æœ€é•¿å…¬å…±å­åºåˆ— | äº’å¼‚æ•°å­—ç‰ˆ LCS â†’ LIS æ¨¡æ¿ï¼Œä½“ä¼šé™ç»´æ€æƒ³ã€‚ |
| P2782 å‹å¥½åŸå¸‚ | æŠŠäºŒç»´ååºåšæˆâ€œå»ºæ¡¥â€é—®é¢˜ï¼Œç»ƒä¹ æ’åº+æ ‘çŠ¶æ•°ç»„ã€‚ |
| P4304 åŸºå› åŒ¹é…2 | æŠŠ 5 æ¬¡é™åˆ¶æ”¹ä¸º k æ¬¡ï¼Œè€ƒå¯Ÿæ³›åŒ–èƒ½åŠ›ã€‚ |

---

## 7. å­¦ä¹ å¿ƒå¾—ä¸ç»éªŒåˆ†äº«

> **æ¥è‡ª clockwhite**ï¼š  
> â€œäºŒç»´ååºâ€å››ä¸ªå­—æŠŠå¤æ‚ LCS æ‹æ‰æˆ LISï¼Œ  
> å€’åºæšä¸¾åŒä¸€æ•°å­—çš„ä½ç½®æ˜¯é˜²æ­¢é‡å¤é€‰æ‹©çš„å…³é”®ã€‚  
> è®°ä½ï¼šé‡åˆ°â€œæ¯ä¸ªå…ƒç´ å‡ºç°æ¬¡æ•°æœ‰é™â€å…ˆæƒ³**ç¨€ç–åŒ–**ï¼

---

<conclusion>
ä»Šå¤©æˆ‘ä»¬ç”¨â€œç¨€ç–åŒ– + äºŒç»´ååº + æ ‘çŠ¶æ•°ç»„â€ä¸‰æ¿æ–§ï¼Œ  
æŠŠä¸€é“çœ‹ä¼¼ä¸å¯åšçš„ LCS ç æˆäº† O(n log n)ã€‚  
ä¸‹æ¬¡é‡åˆ°â€œå‡ºç°æ¬¡æ•°å—é™â€çš„é¢˜ç›®ï¼Œåˆ«å¿˜äº†å…ˆç”»è„šå°å›¾ï¼  
æ´›è¯­äº‘ç¬ºï¼Œä¸‹æœŸå†è§ï¼

---
å¤„ç†ç”¨æ—¶ï¼š99.07ç§’
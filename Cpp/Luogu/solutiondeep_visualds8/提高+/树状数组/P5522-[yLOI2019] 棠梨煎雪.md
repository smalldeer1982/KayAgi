# é¢˜ç›®ä¿¡æ¯

# [yLOI2019] æ£ æ¢¨ç…é›ª

## é¢˜ç›®èƒŒæ™¯

> å²å²èŠ±è—»æªä¸‹å…±å°†æ£ æ¢¨ç…é›ªï¼Œ  
> è‡ªæ€»è§’è‡³ä½ æˆ‘æŸæ—¥è¾—è½¬å¤©è¾¹ã€‚  
> å¤©æ·¡å¤©é’ï¼Œå®¿é›¨æ²¾è¥Ÿï¼Œ  
> ä¸€å¹´ä¸€ä¼šä¿¡ç¬ºå´åªè§å¯¥å¯¥æ•°è¨€ã€‚

â€”â€”é“¶ä¸´ã€Šæ£ æ¢¨ç…é›ªã€‹

## é¢˜ç›®æè¿°

æ‰¶è‹æ­£åœ¨å¬ã€Šæ£ æ¢¨ç…é›ªã€‹çš„æ—¶å€™ï¼Œ@[spitfirekindergarten](https://www.luogu.org/space/show?uid=61795) å‘æ¥ä¸€é“ [IOI2018 é›†è®­é˜Ÿä½œä¸šé¢˜](http://uoj.ac/problem/425)ï¼šæˆ‘åˆ‡äº†è¿™é›†è®­é˜Ÿé¢˜ï¼Œè¾£é¸¡æ‰¶è‹å¿«è¿‡æ¥åšé¢˜ã€‚æ‰¶è‹å®šç›ä¸€çœ‹ï¼Œè¿™ä¸ s\* é¢˜å˜›ï¼Œå†™äº†ä¸€å‘äº¤ä¸Šå»æ‰å‘ç°è‡ªå·±çœ‹é”™é¢˜ç›®äº†ã€‚ä½†æ˜¯å†™å®Œçš„ä»£ç ä¸èƒ½æµªè´¹ï¼Œäºæ˜¯å°±æœ‰äº†è¿™é“é¢˜ã€‚

æ­Œè¯ä¸­çš„ä¸»äººå…¬ä¸å¥¹çš„æœ‹å‹ä¸€å¹´ä¼šæœ‰ä¸€æ¬¡äº’ç›¸å†™ä¿¡ç»™å¯¹æ–¹ï¼Œä¸€å…±é€šä¿¡äº† $m$ å¹´ã€‚ä¸ºäº†ç®€åŒ–é—®é¢˜ï¼Œæˆ‘ä»¬è®¤ä¸ºå¥¹ä»¬æ¯å°ä¿¡çš„å†…å®¹éƒ½æ˜¯ä¸€æ¡äºŒè¿›åˆ¶ç ï¼Œå¹¶ä¸”æ‰€æœ‰äºŒè¿›åˆ¶ç çš„é•¿åº¦éƒ½æ˜¯ $n$ã€‚å³æ¯å°ä¿¡çš„å†…å®¹éƒ½æ˜¯ä¸€ä¸ªé•¿åº¦ä¸º $n$ çš„å­—ç¬¦ä¸²ï¼Œè¿™ä¸ªå­—ç¬¦ä¸²åªå«å­—ç¬¦ ``0`` æˆ– ``1``ã€‚

è¿™å¤©å¥¹æ‹¿å‡ºäº†æœ‹å‹å†™ç»™å¥¹çš„æ‰€æœ‰ä¿¡ä»¶ï¼Œå…¶ä¸­ç¬¬ $i$ å¹´çš„å†™çš„ä¿¡ä»¶ç¼–å·ä¸º $i$ã€‚ç”±äºä¿¡ä»¶ä¿å­˜æ—¶é—´è¿‡ä¹…ï¼Œä¸Šé¢æœ‰ä¸€äº›å­—ç¬¦å·²ç»æ¨¡ç³Šä¸æ¸…ï¼Œæˆ‘ä»¬å°†è¿™æ ·çš„ä½ç½®è®°ä¸º ``?``ï¼Œ``?`` å­—ç¬¦å¯ä»¥è¢«è§£é‡Šä¸º ``0`` æˆ– ``1``ã€‚ç”±äºå¥¹çš„æœ‹å‹ä¹Ÿæ˜¯äººï¼Œç¬¦åˆäººç±»çš„æœ¬è´¨ï¼Œæ‰€ä»¥æœ‹å‹åœ¨ä¸€æ®µè¿ç»­çš„æ—¶é—´ä¸­ä¹¦å†™çš„å†…å®¹å¯èƒ½æ˜¯ç›¸åŒçš„ã€‚ç°åœ¨å¥¹æƒ³é—®é—®ä½ ï¼Œå¯¹äºä¸€æ®µè¿ç»­çš„å¹´ä»½åŒºé—´ $[l,r]$ ä¸­çš„æ‰€æœ‰ä¿¡ä»¶ï¼Œå‡å¦‚æœ‹å‹åœ¨è¿™æ®µæ—¶é—´å±•ç¤ºäº†äººç±»çš„æœ¬è´¨ï¼Œæ‰€å†™çš„æ˜¯åŒä¸€å¥è¯ï¼Œé‚£ä¹ˆè¿™ä¸€å¥è¯ä¸€å…±æœ‰å¤šå°‘ç§å¯èƒ½çš„ç»„æˆã€‚ä¹Ÿå³ä¸€å…±æœ‰å¤šå°‘å­—ç¬¦ä¸² $S$ï¼Œæ»¡è¶³åœ¨è¿™ä¸ªåŒºé—´å†…çš„æ‰€æœ‰ä¿¡ä»¶çš„å†…å®¹éƒ½å¯èƒ½æ˜¯ $S$ã€‚

ä¸€ä¸ªé•¿åº¦ä¸º $n$ çš„åªå« ``0,1,?`` çš„å­—ç¬¦ä¸² $A$ å¯èƒ½æ˜¯ä¸€ä¸ªå­—ç¬¦ä¸² $B$ å½“ä¸”ä»…å½“ $B$ æ»¡è¶³å¦‚ä¸‹æ¡ä»¶ï¼š

- $B$ çš„é•¿åº¦ä¹Ÿæ˜¯ $n$ ã€‚
- $B$ ä¸­åªå«å­—ç¬¦ ``0,1``ã€‚
- $A$ ä¸­æ‰€æœ‰ä¸º ``0`` çš„ä½ç½®åœ¨ $B$ ä¸­ä¹Ÿæ˜¯ ``0``ã€‚
- $A$ ä¸­æ‰€æœ‰ä¸º ``1`` çš„ä½ç½®åœ¨ $B$ ä¸­ä¹Ÿæ˜¯ ``1``ã€‚
- $A$ ä¸­ä¸º ``?`` çš„ä½ç½®åœ¨ $B$ ä¸­å¯ä»¥ä¸º ``0`` ä¹Ÿå¯ä»¥æ˜¯ ``1``ã€‚

åŒæ—¶å¥¹å¯èƒ½ä¼šçªç„¶å‘ç°çœ‹é”™äº†æŸå¹´çš„ä¿¡çš„å†…å®¹ï¼Œäºæ˜¯å¥¹å¯èƒ½ä¼šæŠŠæŸä¸€å¹´çš„ä¿¡çš„å†…å®¹ä¿®æ”¹ä¸ºä¸€ä¸ªåˆ«çš„åªå« ``0``,``1``,``?`` çš„é•¿åº¦ä¸º $n$ çš„å­—ç¬¦ä¸²ã€‚

## è¯´æ˜/æç¤º

### æ ·ä¾‹ 1 è§£é‡Š

- å¯¹äºç¬¬ä¸€æ¬¡è¯¢é—®ï¼Œåªæœ‰ä¸² ``010`` ç¬¦åˆè¦æ±‚ã€‚
- å¯¹äºç¬¬äºŒæ¬¡è¯¢é—®ï¼Œç”±äºç¬¬äºŒä¸ªä¸²çš„ç¬¬ä¸€ä½ä¸º ``0``ï¼Œç¬¬ä¸‰ä¸ªä¸²çš„ç¬¬ä¸€ä½ä¸º ``1``ï¼Œæ•…æ²¡æœ‰ä¸²ç¬¦åˆè¦æ±‚ã€‚
- ä¿®æ”¹åå°†ç¬¬ä¸‰ä¸ªä¸²ä¿®æ”¹ä¸º ``0??``ã€‚
- å¯¹äºç¬¬å››æ¬¡è¯¢é—®ï¼Œæœ‰ä¸¤ä¸ªä¸²ç¬¦åˆè¦æ±‚ï¼Œåˆ†åˆ«ä¸º ``000`` å’Œ ``010``ã€‚
- å¯¹äºç¬¬äº”æ¬¡è¯¢é—®ï¼Œåªæœ‰ ``010`` ç¬¦åˆè¦æ±‚ã€‚

æ•…ç­”æ¡ˆä¸º $1,0,2,1$ï¼Œä»–ä»¬çš„å¼‚æˆ–å’Œå†å¼‚æˆ– $0$ çš„å€¼ä¸º $2$ã€‚

---

### æ•°æ®è§„æ¨¡ä¸çº¦å®š

**æœ¬é¢˜é‡‡ç”¨å¤šæµ‹è¯•ç‚¹æ†ç»‘æµ‹è¯•ï¼Œå…±æœ‰ 7 ä¸ªå­ä»»åŠ¡**ã€‚

| å­ä»»åŠ¡ç¼–å· |  $m = $  |  $q = $   | $n = $ | å­ä»»åŠ¡åˆ†æ•° |
| :--------: | :------: | :-------: | :----: | :--------: |
|    $1$     |   $1$    |    $0$    |  $1$   |    $5$     |
|    $2$     |  $102$   |   $102$   |  $10$  |    $10$    |
|    $3$     |  $1003$  |  $1003$   |  $10$  |    $15$    |
|    $4$     |  $1004$  |  $10004$  |  $30$  |    $15$    |
|    $5$     | $100005$ | $500005$  |  $1$   |    $15$    |
|    $6$     | $100006$ |  $50006$  |  $30$  |    $10$    |
|    $7$     | $100007$ | $1000007$ |  $30$  |    $30$    |

å¯¹äºå…¨éƒ¨çš„æµ‹è¯•ç‚¹ï¼Œä¿è¯ï¼š
- $1 \leq m \leq 10^5 + 7$ï¼Œ$0 \leq q \leq 10^6 + 7$ï¼Œ$1 \leq n \leq 30$ã€‚
- $0 \leq opt \leq 1$ï¼Œ$1 \leq pos \leq m$ï¼Œ$1 \leq l \leq r \leq m$ã€‚
- $s_i, t$ çš„é•¿åº¦å‡ä¸º $n$ ä¸”åªå«æœ‰å­—ç¬¦ `0`,`1`,`?`ã€‚
- è¾“å…¥å­—ç¬¦ä¸²çš„æ€»é•¿åº¦ä¸è¶…è¿‡ $5 \times 10^6$ã€‚æ•°æ®åœ¨ Linux ä¸‹ç”Ÿæˆï¼Œå³æ¢è¡Œç¬¦ä¸å« `\r`ã€‚

---

#### æç¤º

- è¯·æ³¨æ„å¸¸æ•°å› å­å¯¹ç¨‹åºæ•ˆç‡é€ æˆçš„å½±å“ã€‚
- è¯·æ³¨æ„æ•°æ®è¯»å…¥å¯¹ç¨‹åºæ•ˆç‡é€ æˆçš„å½±å“ã€‚
- è¯·æ³¨æ„è¾“å…¥çš„é—®å·ä¸ºå˜¤æ–‡é—®å·ï¼Œå³å…¶ ASCII å€¼ä¸º $63$

æ³¨: ä¸ºå‡å°‘é”™è¯¯åšæ³•çš„é€šè¿‡ç‡ï¼Œæ—¶é™äº 2020 å¹´ 7 æœˆç”± 2000ms æ”¹ä¸º 1500ms

## æ ·ä¾‹ #1

### è¾“å…¥

```
3 3 5
010
0?0
1?0
0 1 2
0 2 3
1 3 0??
0 2 3
0 1 3```

### è¾“å‡º

```
2```

# AIåˆ†æç»“æœ

# ğŸ’¡ æ´›è¯­äº‘ç¬ºçš„C++ç®—æ³•è§£æï¼š[yLOI2019] æ£ æ¢¨ç…é›ª æ·±å…¥å­¦ä¹ æŒ‡å— ğŸ’¡

---

## 1. é¢˜ç›®è§£è¯»ä¸ç­–ç•¥åˆæ¢

âœ¨ **æœ¬é¢˜æ ¸å¿ƒæŒ‘æˆ˜**ï¼š  
â€œåœ¨å¤§é‡åŠ¨æ€ä¿®æ”¹ä¸åŒºé—´æŸ¥è¯¢ä¸­ï¼Œå¦‚ä½•**é«˜æ•ˆåˆ¤æ–­**ä¸€æ®µè¿ç»­å¹´ä»½çš„ä¿¡ä»¶èƒ½å¦**ç»Ÿä¸€è§£é‡Šä¸ºåŒä¸€ä¸ª 01 ä¸²**ï¼Œå¹¶ç»Ÿè®¡**å¯èƒ½çš„ç»Ÿä¸€ä¸²æ•°é‡**ã€‚â€  
å…³é”®è¯ï¼šåŒºé—´æŸ¥è¯¢ã€å•ç‚¹ä¿®æ”¹ã€çŠ¶æ€å‹ç¼©ã€ä½è¿ç®—ã€çº¿æ®µæ ‘ã€‚

âœ¨ **æ ¸å¿ƒç®—æ³•æ ‡ç­¾**ï¼š  
`çŠ¶æ€å‹ç¼©` `çº¿æ®µæ ‘` `ä½è¿ç®—` `åŒºé—´åˆå¹¶`

ğŸ—£ï¸ **åˆæ­¥åˆ†æ**  
> é¢˜ç›®ä¹ä¸€çœ‹åƒå­—ç¬¦ä¸²åŒ¹é…ï¼Œä½†æœ¬è´¨æ˜¯ä¸€ä¸ª**åŒºé—´ä¿¡æ¯åˆå¹¶é—®é¢˜**ã€‚  
> ç”±äº nâ‰¤30ï¼Œæˆ‘ä»¬å¯ä»¥æŠŠæ¯ä¸ªå­—ç¬¦ä¸²çš„â€œç¡®å®šæ€§ä¿¡æ¯â€å‹æˆä¸€ä¸ª 32 ä½æ•´æ•°ï¼ˆbitmaskï¼‰ï¼Œå†ç”¨çº¿æ®µæ ‘ç»´æŠ¤åŒºé—´â€œæˆ–â€ä¸â€œå†²çªæ£€æµ‹â€ã€‚  
> å…³é”®æ´å¯Ÿï¼š  
> - è‹¥æŸä¸€ä½åœ¨åŒºé—´å†…åŒæ—¶å‡ºç° 0 ä¸ 1 â†’ æ— è§£ï¼ˆ0 ç§ï¼‰ã€‚  
> - å¦åˆ™ï¼Œè¯¥ä½è‹¥å…¨ä¸º `?` â†’ è´¡çŒ®ä¹˜ 2ï¼›è‹¥å·²ç¡®å®šä¸º 0/1 â†’ è´¡çŒ®ä¹˜ 1ã€‚  
> äºæ˜¯ç­”æ¡ˆ = 2^(å…¨ä¸º `?` çš„ä½æ•°)ã€‚  
> çº¿æ®µæ ‘æ¯ä¸ªèŠ‚ç‚¹åªéœ€å­˜ä¸¤ä¸ªæ•´æ•°ï¼š  
>   - mask0ï¼šåŒºé—´å†…â€œç¡®å®šä¸º 0â€çš„ä½é›†åˆ  
>   - mask1ï¼šåŒºé—´å†…â€œç¡®å®šä¸º 1â€çš„ä½é›†åˆ  
> åˆå¹¶æ—¶ç”¨ä½è¿ç®—å³å¯ O(1) åˆ¤æ–­æ˜¯å¦å†²çªã€‚

### ğŸ” ç®—æ³•ä¾¦æ¢ï¼šå¦‚ä½•åœ¨é¢˜ç›®ä¸­å‘ç°çº¿ç´¢ï¼Ÿ
1. **çº¿ç´¢1 (æ•°æ®è§„æ¨¡)**ï¼šnâ‰¤30 â†’ æç¤º**çŠ¶æ€å‹ç¼©**ï¼ˆbitmaskï¼‰  
2. **çº¿ç´¢2 (æ“ä½œç±»å‹)**ï¼šåŒºé—´æŸ¥è¯¢ + å•ç‚¹ä¿®æ”¹ â†’ æç¤º**çº¿æ®µæ ‘ / æ ‘çŠ¶æ•°ç»„**  
3. **çº¿ç´¢3 (é—®é¢˜ç›®æ ‡)**ï¼šæ±‚â€œç»Ÿä¸€ä¸²æ•°é‡â€ â†’ æç¤º**ä½è¿ç®—åˆå¹¶è§„åˆ™**  
   - 0/1 å†²çª â†’ 0 ç§  
   - å…¨ ? â†’ Ã—2  
   - å·²ç¡®å®š â†’ Ã—1  

### ğŸ§  æ€ç»´é“¾æ„å»ºï¼šä»çº¿ç´¢åˆ°ç­–ç•¥
> â€œ30 ä½çš„å­—ç¬¦ä¸² â†’ ç”¨ä¸¤ä¸ª 32 ä½æ•´æ•°å³å¯å®Œæ•´æè¿°å…¶â€˜ç¡®å®šæ€§â€™ã€‚  
> åŒºé—´æŸ¥è¯¢ â†’ çº¿æ®µæ ‘ç»´æŠ¤ â€˜æˆ–â€™ è¿ç®—å³å¯å¿«é€Ÿåˆå¹¶åŒºé—´ä¿¡æ¯ã€‚  
> å†²çªæ£€æµ‹ â†’ åªéœ€æ£€æŸ¥ mask0 & mask1 æ˜¯å¦é 0ã€‚  
> äºæ˜¯**çŠ¶å‹ + çº¿æ®µæ ‘**æˆä¸ºä¸äºŒä¹‹é€‰ï¼â€

---

## 2. ç²¾é€‰ä¼˜è´¨é¢˜è§£å‚è€ƒ

| é¢˜è§£ | äº®ç‚¹æç‚¼ | ä»£ç æŠ€å·§ | æ´›è¯­äº‘ç¬ºç‚¹è¯„ |
|---|---|---|---|
| **æ¯”åˆ©â™‚æµ·çµé¡¿** (èµ34) | ç”¨ **Va, Vb** ä¸¤æ•´æ•°è¡¨ç¤ºâ€œå¿…é¡»ä¸º0/1â€çš„ä½ï¼›çº¿æ®µæ ‘ç»´æŠ¤åŒºé—´ `|`ï¼›å†²çªæ£€æµ‹ `Va & Vb` | ä½è¿ç®—å‹ç¼© + æŒ‡é’ˆçº¿æ®µæ ‘ | æ€è·¯æœ€æ¸…æ™°ï¼Œå®ç°ç´§å‡‘ï¼Œæ˜¯â€œæ ‡å‡†ç­”æ¡ˆâ€ |
| **ä¸€æ‰¶è‹ä¸€** (èµ27) | åˆ†æ²»å­ä»»åŠ¡é€æ­¥å‡çº§ï¼›æœ€ç»ˆç”¨ **x,y** ä¸¤æ•´æ•°çŠ¶å‹ | ç»“æ„ä½“å°è£… + ä½è¿ç®— | å®˜æ–¹å‡ºé¢˜äººæ€è·¯ï¼Œé€»è¾‘ä¸¥è°¨ |
| **EXODUS** (èµ19) | æ ‘çŠ¶æ•°ç»„ç»´æŠ¤ 0/1/? è®¡æ•°ï¼›å¸¸æ•°ä¼˜åŒ–ç æ‰ 1/3 | ä¸‰ç»´æ ‘çŠ¶æ•°ç»„ + ä¹˜æ³•åŸç† | 70â†’100 åˆ†çš„ç»å…¸å¸¸æ•°æˆ˜ |
| **æ–—ç¥_å›è«ç¬‘** (èµ14) | ç”¨ `have_ans` å¸ƒå°”æ ‡è®°å†²çªï¼›ä½è¿ç®—åˆå¹¶ | ä½è¿ç®— + çº¿æ®µæ ‘ | ä»£ç æœ€æ˜“è¯»ï¼Œé€‚åˆåˆå­¦è€… |
| **Fading** (èµ5) | ä¸‰æ•´æ•° mask0, mask1, mask? ç»´æŠ¤ï¼›åŒºé—´ä¸ | ä½è¿ç®— + çº¿æ®µæ ‘ | æ€è·¯ç›´è§‚ï¼Œä½è¿ç®—æ¸…æ™° |

---

## 3. è§£é¢˜ç­–ç•¥æ·±åº¦å‰–æ

### ğŸ¯ æ ¸å¿ƒéš¾ç‚¹ä¸å…³é”®æ­¥éª¤ï¼ˆæœ€ä¼˜è§£æ³•ï¼šçŠ¶å‹çº¿æ®µæ ‘ï¼‰

| å…³é”®ç‚¹ | åˆ†æ | ğŸ’¡å­¦ä¹ ç¬”è®° |
|---|---|---|
| **çŠ¶æ€å‹ç¼©** | ç”¨ä¸¤ä¸ª 32 ä½æ•´æ•° `mask0, mask1` æè¿°ä¸€ä¸ªå­—ç¬¦ä¸²ï¼š  
- mask0 çš„ i ä½=1 â†’ ç¬¬ i ä½**ç¡®å®šä¸º 0**  
- mask1 çš„ i ä½=1 â†’ ç¬¬ i ä½**ç¡®å®šä¸º 1** | â€œnâ‰¤30â€ æ˜¯çŠ¶å‹çš„**é»„é‡‘ä¿¡å·** |
| **åŒºé—´åˆå¹¶** | ä¸¤ä¸ªåŒºé—´åˆå¹¶ï¼š  
- æ–° mask0 = mask0å·¦ &#124; mask0å³  
- æ–° mask1 = mask1å·¦ &#124; mask1å³  
- è‹¥ (mask0 &#38; mask1) â‰  0 â†’ å†²çªï¼Œç­”æ¡ˆ=0 | ä½è¿ç®—å¤©ç„¶å¹¶è¡Œï¼ŒO(1) åˆå¹¶ |
| **æŸ¥è¯¢ç­”æ¡ˆ** | è‹¥æ— å†²çªï¼Œç­”æ¡ˆ = 2^(æœªç¡®å®šä½æ•°) = 2^(n - popcount(mask0 &#124; mask1)) | ç”¨ `__builtin_popcount` ä¸€è¡Œæå®š |

### âš”ï¸ ç­–ç•¥ç«æŠ€åœºï¼šä¸åŒè§£æ³•å¯¹æ¯”

| ç­–ç•¥ | æ ¸å¿ƒæ€æƒ³ | æ—¶é—´å¤æ‚åº¦ | ä¼˜ç¼ºç‚¹ | å¾—åˆ†é¢„æœŸ |
|---|---|---|---|---|
| **æš´åŠ›æšä¸¾** | 2^n æšä¸¾æ‰€æœ‰å¯èƒ½ä¸²ï¼Œé€ä½æ£€æŸ¥ | O(qÂ·mÂ·2^n) | æ€è·¯ç›´è§‚ï¼Œè¶…æ—¶ | â‰¤15 pts |
| **é€ä½æ ‘çŠ¶æ•°ç»„** | å¯¹æ¯ä¸€ä½å¼€æ ‘çŠ¶æ•°ç»„ç»´æŠ¤ 0/1/? è®¡æ•° | O(qÂ·nÂ·log m) | å¸¸æ•°å°ï¼Œ70â†’100 éœ€å¡å¸¸ | 70~100 pts |
| **çŠ¶å‹çº¿æ®µæ ‘** | ç”¨ bitmask æè¿°åŒºé—´ä¿¡æ¯ï¼Œçº¿æ®µæ ‘åˆå¹¶ | O(qÂ·log m) | æ€è·¯ä¼˜é›…ï¼Œå¸¸æ•°å° | 100 pts |

### âœ¨ ä¼˜åŒ–ä¹‹æ—…ï¼šä»â€œèƒ½åšâ€åˆ°â€œåšå¥½â€
> â€œæœ€åˆçš„æš´åŠ›æšä¸¾åƒç”¨æ”¾å¤§é•œé€å­—æ£€æŸ¥ï¼›  
> æ ‘çŠ¶æ•°ç»„æŠŠæ”¾å¤§é•œæ¢æˆäº†è®¡æ•°å™¨ï¼›  
> çŠ¶å‹çº¿æ®µæ ‘åˆ™æŠŠæ•´æ®µæ–‡å­—æ‹æˆä¸€å¼ ç…§ç‰‡ï¼Œä¸€çœ¼çœ‹å®Œï¼â€  
> å…³é”®è·ƒè¿ï¼š**æŠŠå­—ç¬¦ä¸²çº§é—®é¢˜è½¬åŒ–ä¸ºä½çº§é—®é¢˜**ã€‚

---

## 4. C++æ ¸å¿ƒä»£ç å®ç°èµæ

### é€šç”¨æ ¸å¿ƒå‚è€ƒï¼ˆèåˆæ¯”åˆ©â™‚æµ·çµé¡¿ & ä¸€æ‰¶è‹ä¸€ï¼‰

```cpp
#include <bits/stdc++.h>
using namespace std;

const int MAXN = 1e5 + 7;
int n, m, q;

struct Node {
    unsigned mask0 = 0; // ç¡®å®šä¸º 0 çš„ä½
    unsigned mask1 = 0; // ç¡®å®šä¸º 1 çš„ä½
};

Node operator|(const Node& a, const Node& b) {
    Node c;
    c.mask0 = a.mask0 | b.mask0;
    c.mask1 = a.mask1 | b.mask1;
    return c;
}

bool conflict(const Node& a) {
    return (a.mask0 & a.mask1) != 0;
}

struct SegTree {
    Node tr[MAXN << 2];
    void build(int p, int l, int r, const vector<string>& s) {
        if (l == r) {
            tr[p] = Node();
            for (int i = 0; i < n; ++i) {
                char c = s[l-1][i];
                if (c == '0') tr[p].mask0 |= 1u << i;
                if (c == '1') tr[p].mask1 |= 1u << i;
            }
            return;
        }
        int mid = (l + r) >> 1;
        build(p << 1, l, mid, s);
        build(p << 1 | 1, mid + 1, r, s);
        tr[p] = tr[p << 1] | tr[p << 1 | 1];
    }
    void modify(int p, int l, int r, int pos, const string& s) {
        if (l == r) {
            tr[p] = Node();
            for (int i = 0; i < n; ++i) {
                char c = s[i];
                if (c == '0') tr[p].mask0 |= 1u << i;
                if (c == '1') tr[p].mask1 |= 1u << i;
            }
            return;
        }
        int mid = (l + r) >> 1;
        if (pos <= mid) modify(p << 1, l, mid, pos, s);
        else modify(p << 1 | 1, mid + 1, r, pos, s);
        tr[p] = tr[p << 1] | tr[p << 1 | 1];
    }
    Node query(int p, int l, int r, int ql, int qr) {
        if (ql <= l && r <= qr) return tr[p];
        int mid = (l + r) >> 1;
        if (qr <= mid) return query(p << 1, l, mid, ql, qr);
        if (ql > mid) return query(p << 1 | 1, mid + 1, r, ql, qr);
        return query(p << 1, l, mid, ql, qr) | query(p << 1 | 1, mid + 1, r, ql, qr);
    }
} seg;

int main() {
    ios::sync_with_stdio(false);
    cin.tie(nullptr);
    cin >> n >> m >> q;
    vector<string> s(m);
    for (int i = 0; i < m; ++i) cin >> s[i];
    seg.build(1, 1, m, s);

    int ans = 0;
    while (q--) {
        int op; cin >> op;
        if (op == 0) {
            int l, r; cin >> l >> r;
            Node res = seg.query(1, 1, m, l, r);
            if (conflict(res)) ans ^= 0;
            else {
                unsigned mask = res.mask0 | res.mask1;
                int cnt = n - __builtin_popcount(mask);
                ans ^= (1 << cnt);
            }
        } else {
            int pos; string t; cin >> pos >> t;
            seg.modify(1, 1, m, pos, t);
        }
    }
    cout << ans << '\n';
    return 0;
}
```

---

## 5. ç®—æ³•å¯è§†åŒ–ï¼šåƒç´ åŠ¨ç”»æ¼”ç¤º

### ä¸»é¢˜ï¼šåƒç´ ä¾¦æ¢çš„â€œä¿¡ä»¶åˆå¹¶â€å†’é™©
- **åœºæ™¯**ï¼š8Ã—n çš„åƒç´ ç½‘æ ¼ï¼Œæ¯ä¸€åˆ—ä»£è¡¨å­—ç¬¦ä¸²çš„ä¸€ä½ï¼ˆ0=è“ï¼Œ1=çº¢ï¼Œ?=ç°ï¼‰ã€‚  
- **äº¤äº’**ï¼š  
  1. ç‚¹å‡»â€œåŒºé—´æŸ¥è¯¢â€ â†’ åƒç´ ä¾¦æ¢ä»å·¦åˆ°å³æ‰«æåŒºé—´ï¼Œå†²çªä½é—ªçƒçº¢è‰²è­¦æŠ¥ã€‚  
  2. ç‚¹å‡»â€œå•ç‚¹ä¿®æ”¹â€ â†’ å¯¹åº”åˆ—åƒç´ å—æ›´æ–°é¢œè‰²ï¼Œçº¿æ®µæ ‘èŠ‚ç‚¹åŒæ­¥é«˜äº®ã€‚  
- **éŸ³æ•ˆ**ï¼š  
  - ä½è¿ç®—â€œæˆ–â€æ—¶æ’­æ”¾â€œå®â€  
  - å†²çªæ—¶æ’­æ”¾â€œè­¦æŠ¥â€  
  - æˆåŠŸåˆå¹¶æ’­æ”¾â€œèƒœåˆ©â€  
- **å®ç°è¦ç‚¹**ï¼š  
  - ç”¨ Canvas ç»˜åˆ¶ 8Ã—n ç½‘æ ¼ï¼Œçº¿æ®µæ ‘èŠ‚ç‚¹ç”¨ 16Ã—16 åƒç´ å—å †å è¡¨ç¤º mask0/mask1ã€‚  
  - å…³é”®å¸§ï¼šåŒºé—´åˆå¹¶æ—¶ï¼Œå·¦å³å­æ ‘åƒç´ å—åˆå¹¶åŠ¨ç”»ï¼Œå†²çªä½å˜çº¢ã€‚

---

## 6. æ‹“å±•ç»ƒä¹ ä¸ç›¸ä¼¼é—®é¢˜æ€è€ƒ

### é€šç”¨æŠ€å·§è¿ç§»
- **ä½è¿ç®—å‹ç¼©**ï¼šé€‚ç”¨äº nâ‰¤30 çš„â€œå¤šçŠ¶æ€åˆå¹¶â€é—®é¢˜  
  1. **åŒºé—´å¼‚æˆ–å’Œ**ï¼šP4145 ä¸Šå¸é€ é¢˜çš„ä¸ƒåˆ†é’Ÿ  
  2. **åŒºé—´é¢œè‰²æ®µ**ï¼šP1972 [SDOI2009] HHçš„é¡¹é“¾  
  3. **åŒºé—´æŒ‰ä½ä¸/æˆ–**ï¼šP4145 åŒä¸Š

### æ´›è°·æ¨è
| é¢˜å· | æ¨èç†ç”± |
|---|---|
| P4145 | ä½è¿ç®—åŒºé—´åˆå¹¶ï¼Œå·©å›ºçŠ¶å‹çº¿æ®µæ ‘ |
| P3372 | çº¿æ®µæ ‘æ¨¡æ¿ï¼Œç»ƒä¹ åŒºé—´ä¿®æ”¹æŸ¥è¯¢ |
| P1908 | æ ‘çŠ¶æ•°ç»„æ±‚é€†åºå¯¹ï¼Œä½“éªŒ log çº§æ•°æ®ç»“æ„ |

---

## 7. å­¦ä¹ å¿ƒå¾—ä¸ç»éªŒåˆ†äº«

> **æ¥è‡ªæ¯”åˆ©â™‚æµ·çµé¡¿**ï¼š  
> â€œä½è¿ç®—æ˜¯ OI ä¸­çš„ç‘å£«å†›åˆ€ï¼Œèƒ½æŠŠ 30 ä½çš„å­—ç¬¦ä¸²å‹æˆä¸¤ä¸ªæ•´æ•°ï¼Œé—®é¢˜ç¬é—´é™ç»´æ‰“å‡»ï¼â€  
> **æ´›è¯­äº‘ç¬ºç‚¹è¯„**ï¼š  
> è®°ä½â€œæ•°æ®èŒƒå›´æš—ç¤ºç®—æ³•â€â€”â€”nâ‰¤30 æ—¶ï¼Œä¼˜å…ˆè€ƒè™‘çŠ¶å‹ï¼

---

<conclusion>
ç¥è´ºä½ å®Œæˆäº†ã€Šæ£ æ¢¨ç…é›ªã€‹çš„æ·±åº¦æ¢é™©ï¼  
ä»â€œå­—ç¬¦ä¸²è¿·é›¾â€åˆ°â€œä½è¿ç®—æ›™å…‰â€ï¼Œæˆ‘ä»¬è§è¯äº†å¦‚ä½•æŠŠå¤æ‚é—®é¢˜å‹ç¼©æˆç®€æ´ä¼˜é›…çš„ç®—æ³•ã€‚  
ä¸‹æ¬¡é‡åˆ°â€œå°æ•°æ®èŒƒå›´ + åŒºé—´æ“ä½œâ€æ—¶ï¼Œåˆ«å¿˜äº†ä»Šå¤©çš„â€œçŠ¶å‹ + çº¿æ®µæ ‘â€é»„é‡‘ç»„åˆï¼  
ç»§ç»­åŠ æ²¹ï¼Œåƒç´ ä¾¦æ¢ï¼ğŸ’ª
</conclusion>

---
å¤„ç†ç”¨æ—¶ï¼š71.63ç§’
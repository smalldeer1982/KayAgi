# é¢˜ç›®ä¿¡æ¯

# [USACO13JAN] Painting the Fence S

## é¢˜ç›®æè¿°

Farmer John has devised a brilliant method to paint the long fence next to his barn (think of the fence as a one-dimensional number line).  He simply attaches a paint brush to his favorite cow Bessie, and then retires to drink a cold glass of water as Bessie walks back and forth across the fence, applying paint to any segment of the fence that she walks past.

Bessie starts at position 0 on the fence and follows a sequence of N moves (1 <= N <= 100,000).  Example moves might be "10 L", meaning Bessie moves 10 units to the left, or "15 R", meaning Bessie moves 15 units to the right.  Given a list of all of Bessie's moves, FJ would like to know what area of the fence gets painted with at least K coats of paint.  Bessie will move at most 1,000,000,000 units away from the origin during her walk.



Farmer John æƒ³å‡ºäº†ä¸€ä¸ªç»™ç‰›æ£šæ—çš„é•¿å›´å¢™æ¶‚è‰²çš„å¥½æ–¹æ³•ã€‚ï¼ˆä¸ºäº†ç®€å•èµ·è§ï¼Œæˆ‘ä»¬æŠŠå›´å¢™çœ‹åšä¸€ç»´çš„æ•°è½´ï¼Œæ¯ä¸€ä¸ªå•ä½é•¿åº¦ä»£è¡¨ä¸€å—æ …æ ï¼‰

ä»–åªæ˜¯ç®€å•çš„æŠŠåˆ·å­è˜¸æ»¡é¢œæ–™ï¼Œç³»åœ¨ä»–æœ€å–œæ¬¢çš„å¥¶ç‰›Bessieä¸Šï¼Œç„¶åè®©Bessieæ¥å›åœ°ç»è¿‡å›´å¢™ï¼Œè‡ªå·±åˆ™åœ¨ä¸€æ—å–ä¸€æ¯å†°é•‡çš„å‡‰æ°´ã€‚ï¼ˆâ€¦â€¦-\_-|||) 

Bessie ç»è¿‡çš„æ‰€æœ‰å›´å¢™éƒ½ä¼šè¢«æ¶‚ä¸Šä¸€å±‚é¢œæ–™ã€‚Bessieä»å›´å¢™ä¸Šçš„ä½ç½®0å‡ºå‘ï¼Œå¹¶å°†ä¼šè¿›è¡ŒNæ¬¡ç§»åŠ¨(1 <= N <= 100,000)ã€‚æ¯”å¦‚è¯´ï¼Œâ€œ10 Lâ€çš„æ„æ€å°±æ˜¯Bessieå‘å·¦ç§»åŠ¨äº†10ä¸ªå•ä½ã€‚å†æ¯”å¦‚è¯´â€œ15 Râ€çš„æ„æ€å°±æ˜¯Bessieå‘å³ç§»åŠ¨äº†15ä¸ªå•ä½ã€‚

ç»™å‡ºä¸€ç³»åˆ—Bessieç§»åŠ¨çš„æ¸…å•ã€‚FJ æƒ³çŸ¥é“æœ‰å¤šå°‘å—æ …æ æ¶‚ä¸Šäº†è‡³å°‘Kå±‚æ¶‚æ–™ã€‚æ³¨æ„ï¼šBessieæœ€å¤šä¼šç§»åŠ¨åˆ°ç¦»åŸç‚¹1,000,000,000å•ä½è¿œçš„åœ°æ–¹ã€‚


## è¯´æ˜/æç¤º

PS1ï¼šæ¥æºï¼šusaco jan silver P01 æƒ³çœ‹åŸé¢˜çš„è¯·æˆ³http://www.usaco.org/index.php?page=viewproblem2&cpid=226ï¼‰

PS2ï¼šæµ‹è¯•æ•°æ®ä¹Ÿå¯ä»¥åœ¨åœ¨http://www.usaco.org/index.php?page=jan13problemsä¸Šä¸‹è½½ï¼Œè¿˜å¯ä»¥çœ‹åˆ°é¢˜è§£ï¼ˆä¸è¿‡æ˜¯è‹±æ–‡çš„:-Dï¼‰

PS3:å¦‚æœæœ‰ç¿»è¯‘çš„é—®é¢˜æˆ–é¢˜ç›®çš„ä¸ç†è§£ï¼Œå¯ä»¥åœ¨é—®ç­”åé¢ç•™è¨€çš„è¯´ã€‚


## æ ·ä¾‹ #1

### è¾“å…¥

```
6 2 
2 R 
6 L 
1 R 
8 L 
1 R 
2 R ```

### è¾“å‡º

```
6```

# AIåˆ†æç»“æœ

---
# ğŸ’¡ æ´›è¯­äº‘ç¬ºçš„C++ç®—æ³•è§£æï¼šPainting the Fence S æ·±å…¥å­¦ä¹ æŒ‡å— ğŸ’¡

> ä»Šå¤©æˆ‘ä»¬æ¥ä¸€èµ·åˆ†æ USACO13JAN Painting the Fence Sã€‚è¿™é“é¢˜å°±åƒç»™ä¸€æ¡æ— é™é•¿çš„æ …æ â€œåˆ·æ¼†â€ï¼šå¥¶ç‰› Bessie ä» 0 å‡ºå‘ï¼Œæ¯æ¬¡å¾€å·¦æˆ–å¾€å³åˆ·ä¸€æ®µï¼Œæœ€ç»ˆç»Ÿè®¡**è¢«åˆ·äº† â‰¥K å±‚æ²¹æ¼†**çš„æ …æ **æ€»é•¿åº¦**ã€‚  
> é‡ç‚¹ä¸åœ¨äºæš´åŠ›æ¨¡æ‹Ÿï¼Œè€Œåœ¨äºå¦‚ä½•ä¼˜é›…åœ°**æŠŠæ— é™é•¿çš„æ•°è½´å‹ç¼©æˆæœ‰é™çš„äº‹ä»¶ç‚¹**ã€‚

---

## 1. é¢˜ç›®è§£è¯»ä¸ç­–ç•¥åˆæ¢

### âœ¨ æ ¸å¿ƒæŒ‘æˆ˜
â€œæ— é™é•¿â€çš„æ•°è½´ + åŒºé—´è¦†ç›–æ¬¡æ•°æŸ¥è¯¢ â‡’ å¿…é¡»**ç¦»æ•£åŒ–**å¹¶**é«˜æ•ˆç»Ÿè®¡è¦†ç›–æ¬¡æ•°**ã€‚

### âœ¨ æ ¸å¿ƒç®—æ³•æ ‡ç­¾
- ç¦»æ•£åŒ–ï¼ˆCoordinate Compressionï¼‰  
- å·®åˆ†æ•°ç»„ / æ‰«æçº¿ï¼ˆSweep-Lineï¼‰  
- çº¿æ®µæ ‘ï¼ˆSegment Treeï¼Œå¯é€‰ï¼‰

### ğŸ§  æ€è·¯æ¼”è¿›è·¯å¾„
1. **æš´åŠ›æ¨¡æ‹Ÿ**ï¼šç›´æ¥å¼€ `bool fence[2e9+1]` â†’ ç©ºé—´çˆ†ç‚¸ã€‚  
2. **ç¦»æ•£åŒ– + å·®åˆ†**ï¼šæŠŠç«¯ç‚¹åæ ‡æ˜ å°„åˆ°ç´§å‡‘ä¸‹æ ‡ â†’ æ—¶é—´ `O(n log n)`ï¼Œç©ºé—´ `O(n)`ã€‚  
3. **æ‰«æçº¿**ï¼šæŠŠâ€œåŒºé—´åŠ  1â€æ‹†æˆâ€œ+1 äº‹ä»¶â€å’Œâ€œ-1 äº‹ä»¶â€ï¼Œæ’åºåæ‰«ä¸€é â†’ åŒæ · `O(n log n)`ï¼Œä»£ç æ›´çŸ­ã€‚  
4. **çº¿æ®µæ ‘**ï¼šæ”¯æŒåœ¨çº¿ä¿®æ”¹ï¼Œä½†æœ¬é¢˜ç¦»çº¿å³å¯ï¼Œå±äºâ€œå¤§ç‚®æ‰“èšŠå­â€ã€‚

---

### ğŸ” ç®—æ³•ä¾¦æ¢ï¼šå¦‚ä½•åœ¨é¢˜ç›®ä¸­å‘ç°çº¿ç´¢ï¼Ÿ
| çº¿ç´¢ | ä¾¦æ¢ç¬”è®° |
|---|---|
| **â€œæ•°è½´æ— é™é•¿â€** | ç›´æ¥å¼€æ•°ç»„ä¼š MLEï¼Œå¿…é¡»ç¦»æ•£åŒ–ã€‚ |
| **â€œè‡³å°‘ K å±‚â€** | éœ€è¦ç»Ÿè®¡åŒºé—´è¦†ç›–æ¬¡æ•° â†’ å·®åˆ†/æ‰«æçº¿å¤©ç„¶é€‚åˆã€‚ |
| **N â‰¤ 1e5** | `O(n log n)` ç¨³è¿‡ï¼Œ`O(n^2)` å¿…ç‚¸ã€‚ |

### ğŸ§  æ€ç»´é“¾æ„å»º
> 1. çœ‹åˆ°â€œæ— é™åŒºé—´â€+â€œè¦†ç›–æ¬¡æ•°â€ï¼Œå¤§è„‘é‡Œç«‹åˆ»é—ªç°â€œç¦»æ•£åŒ–â€+â€œå·®åˆ†â€ã€‚  
> 2. ç¦»æ•£åŒ–æŠŠåæ ‡å‹ç¼©åˆ°æœ€å¤š `2n` ä¸ªç‚¹ï¼Œå·®åˆ†æŠŠåŒºé—´åŠ  1 å˜æˆä¸¤ä¸ªç«¯ç‚¹äº‹ä»¶ã€‚  
> 3. æ‰«æçº¿æŒ‰åæ ‡æ’åºï¼Œç”¨ä¸€ä¸ªå˜é‡ `cur` è®°å½•å½“å‰è¦†ç›–å±‚æ•°ï¼Œå½“ `cur â‰¥ K` æ—¶æŠŠåŒºé—´é•¿åº¦ç´¯åŠ å³å¯ã€‚  
> 4. çº¿æ®µæ ‘ä¹Ÿèƒ½åšï¼Œä½†æ‰«æçº¿æ›´ç®€æ´ï¼Œäºæ˜¯é”å®šâ€œæ‰«æçº¿â€ä½œä¸ºæœ€ä¼˜ç­–ç•¥ã€‚

---

## 2. ç²¾é€‰ä¼˜è´¨é¢˜è§£å‚è€ƒ

| é¢˜è§£ | äº®ç‚¹æç‚¼ | æ´›è¯­äº‘ç¬ºç‚¹è¯„ |
|---|---|---|
| **Hades18** (èµ18) | é¦–æ¬¡æå‡ºâ€œæ‰«æçº¿â€+â€œç¦»æ•£åŒ–â€æ€è·¯ï¼›ä»£ç æçŸ­ã€‚ | ç”¨ `struct P{int x,val;}` è¡¨ç¤ºäº‹ä»¶ï¼Œæ’åºåç›´æ¥æ‰«ï¼Œ**æ¨¡æ¿çº§ç¤ºèŒƒ**ã€‚ |
| **lnwhl** (èµ6) | ç”¨å›¾æ–‡è¯¦ç»†è§£é‡Šç¦»æ•£åŒ–ï¼›ç»™å‡ºå·®åˆ†+ç¦»æ•£åŒ–å®Œæ•´ä»£ç ã€‚ | æŠŠâ€œç¦»æ•£åŒ–â€è®²æˆæ•…äº‹ï¼Œé€‚åˆåˆå­¦è€…ï¼›ä»£ç æ³¨é‡Šæ¸…æ™°ã€‚ |
| **OldVagrant** (èµ4) | ç”¨çº¿æ®µæ ‘å®ç°ï¼ŒæŒ‡å‡ºâ€œåŒºé—´å³ç«¯ç‚¹-1â€çš„å‘ã€‚ | å±•ç¤ºçº¿æ®µæ ‘å†™æ³•å¹¶ç»™å‡º**WAâ†’AC**çš„è°ƒè¯•ç»éªŒï¼Œå¼¥è¶³çè´µã€‚ |

---

## 3. è§£é¢˜ç­–ç•¥æ·±åº¦å‰–æ

### ğŸ¯ æ ¸å¿ƒéš¾ç‚¹ä¸å…³é”®æ­¥éª¤ï¼ˆæœ€ä¼˜ï¼šæ‰«æçº¿ï¼‰
| å…³é”®ç‚¹ | åˆ†æ & å­¦ä¹ ç¬”è®° |
|---|---|
| **ç¦»æ•£åŒ–åæ ‡** | æŠŠæ‰€æœ‰å‡ºç°è¿‡çš„ç«¯ç‚¹æ”¶é›† â†’ `sort` â†’ `unique`ï¼Œæ—¶é—´ `O(n log n)`ã€‚<br>ğŸ’¡ **å­¦ä¹ ç¬”è®°**ï¼šç¦»æ•£åŒ–æ¨¡æ¿ = `vector` + `sort` + `unique` + `lower_bound`ã€‚ |
| **äº‹ä»¶è¡¨ç¤º** | æ¯æ®µ `[l,r)` æ‹†æˆ `(l, +1)` ä¸ `(r, -1)` ä¸¤ä¸ªäº‹ä»¶ã€‚<br>ğŸ’¡ **å­¦ä¹ ç¬”è®°**ï¼šæ‰«æçº¿é€šç”¨å¥—è·¯â€”â€”â€œå…¥â€+â€œå‡ºâ€äº‹ä»¶ã€‚ |
| **æ‰«æç»Ÿè®¡** | æŒ‰åæ ‡å‡åºéå†äº‹ä»¶ï¼Œç»´æŠ¤ `cur` è¡¨ç¤ºå½“å‰è¦†ç›–å±‚æ•°ã€‚<br>å½“ `cur â‰¥ K` æ—¶ï¼ŒæŠŠ `events[i+1].x - events[i].x` ç´¯åŠ ç­”æ¡ˆã€‚<br>ğŸ’¡ **å­¦ä¹ ç¬”è®°**ï¼šåŒºé—´é•¿åº¦ = ä¸‹ä¸€åæ ‡ - å½“å‰åæ ‡ã€‚ |

---

### âš”ï¸ ç­–ç•¥ç«æŠ€åœº
| ç­–ç•¥ | æ ¸å¿ƒæ€æƒ³ | ä¼˜ç‚¹ | ç¼ºç‚¹ | é€‚ç”¨åœºæ™¯ |
|---|---|---|---|---|
| **æš´åŠ›æ¨¡æ‹Ÿ** | `bool vis[2e9]` | æ€è·¯ç›´è§‚ | ç©ºé—´ `O(2e9)` â†’ MLE | Nâ‰¤1e3 |
| **ç¦»æ•£åŒ–+å·®åˆ†** | ç¦»æ•£åŒ–+å·®åˆ†æ•°ç»„ | æ—¶é—´ `O(n log n)`ï¼Œç©ºé—´ `O(n)` | éœ€è¦ç¦»æ•£åŒ–æ¨¡æ¿ | ç»å…¸ç¦»çº¿åŒºé—´é—®é¢˜ |
| **æ‰«æçº¿** | äº‹ä»¶+æ’åº+æ‰«ä¸€é | ä»£ç æœ€çŸ­ï¼Œæ€è·¯æ¸…æ™° | å¿…é¡»ç¦»çº¿ | æœ¬é¢˜æœ€ä¼˜ |
| **çº¿æ®µæ ‘** | ç¦»æ•£åŒ–+åŒºé—´åŠ 1 | æ”¯æŒåœ¨çº¿ä¿®æ”¹ | ä»£ç é•¿ï¼Œå¸¸æ•°å¤§ | éœ€è¦åœ¨çº¿æŸ¥è¯¢ |

---

## 4. C++æ ¸å¿ƒä»£ç å®ç°èµæ

### æœ¬é¢˜é€šç”¨æ ¸å¿ƒå®ç°ï¼ˆæ‰«æçº¿ç‰ˆï¼‰
```cpp
#include <bits/stdc++.h>
using namespace std;
struct Event {
    int pos, delta;
    bool operator<(const Event& rhs) const {
        return pos < rhs.pos;
    }
};
int main() {
    ios::sync_with_stdio(false);
    cin.tie(nullptr);
    int n, k;  cin >> n >> k;
    vector<Event> ev;
    int now = 0;
    for (int i = 0; i < n; ++i) {
        int len; char dir; cin >> len >> dir;
        int nxt = now + (dir == 'R' ? len : -len);
        int l = min(now, nxt), r = max(now, nxt);
        ev.push_back({l, 1});
        ev.push_back({r, -1});
        now = nxt;
    }
    sort(ev.begin(), ev.end());
    int cur = 0, ans = 0;
    for (size_t i = 0; i + 1 < ev.size(); ++i) {
        cur += ev[i].delta;
        if (cur >= k) ans += ev[i + 1].pos - ev[i].pos;
    }
    cout << ans << '\n';
    return 0;
}
```

### ä»£ç è§£è¯»æ¦‚è¦
1. **äº‹ä»¶ç”Ÿæˆ**ï¼šæŠŠæ¯æ®µ `[l,r)` æ‹†æˆ `(l,+1)` ä¸ `(r,-1)`ã€‚  
2. **æ’åº**ï¼šæŒ‰åæ ‡å‡åºã€‚  
3. **æ‰«æ**ï¼šç»´æŠ¤ `cur` è¡¨ç¤ºå½“å‰å±‚æ•°ï¼Œ`cur â‰¥ K` æ—¶ç´¯åŠ åŒºé—´é•¿åº¦ã€‚  
4. **å¤æ‚åº¦**ï¼š`O(n log n)` æ’åº + `O(n)` æ‰«æã€‚

---

### ç»å…¸ç‰‡æ®µèµæ
| ç‰‡æ®µ | äº®ç‚¹ | å­¦ä¹ ç¬”è®° |
|---|---|---|
| `lower_bound` ç¦»æ•£åŒ– | OldVagrant ç”¨ `map<int,int>` æ˜ å°„åæ ‡ | è®°ä½ `map` ç¦»æ•£åŒ–å†™æ³•ï¼Œæ–¹ä¾¿è°ƒè¯•ã€‚ |
| `change(lc,l,mid,ql,qr-1)` | Vanishment æŒ‡å‡ºåŒºé—´å³ç«¯ç‚¹éœ€â€œ-1â€ | **åŒºé—´è¦†ç›–é—®é¢˜å¸¸è§å‘**ï¼šå·¦é—­å³å¼€ vs å·¦é—­å³é—­ã€‚ |
| `events[i+1].x - events[i].x` | Hades18 ä¸€è¡Œç®—å‡ºåŒºé—´é•¿åº¦ | **æ‰«æçº¿ç²¾é«“**ï¼šç›¸é‚»åæ ‡å·®å³åŒºé—´é•¿åº¦ã€‚ |

---

## 5. ç®—æ³•å¯è§†åŒ–ï¼šåƒç´ åŠ¨ç”»æ¼”ç¤º

### ğŸ® ä¸»é¢˜ï¼šåƒç´ å¥¶ç‰›åˆ·æ …æ 
- **ç”»é¢**ï¼šä¸€æ¡æ°´å¹³åƒç´ æ …æ ï¼Œå¥¶ç‰›æ¯ç§»åŠ¨ä¸€æ­¥ï¼Œå¯¹åº”åŒºé—´åƒç´ å—å˜æ·±ã€‚  
- **äº‹ä»¶æ¡**ï¼šå±å¹•é¡¶éƒ¨å‡ºç°â€œ+1â€â€œ-1â€åƒç´ æ ‡ç­¾ï¼Œéšæ‰«æçº¿ä»å·¦åˆ°å³ç§»åŠ¨ã€‚  
- **éŸ³æ•ˆ**ï¼š  
  - â€œå®â€â€”â€”äº‹ä»¶è§¦å‘ï¼›  
  - â€œèƒœåˆ©â€éŸ³â€”â€”å½“ `cur â‰¥ K` åŒºé—´è¢«é«˜äº®å¹¶ç´¯åŠ é•¿åº¦ã€‚  
- **äº¤äº’**ï¼š  
  - æ­¥è¿›æŒ‰é’®ï¼šå•æ­¥æ‰§è¡Œäº‹ä»¶ï¼›  
  - é€Ÿåº¦æ»‘å—ï¼š0.5Ã— ~ 4Ã—ï¼›  
  - é‡ç½®æŒ‰é’®ï¼šå›åˆ°èµ·ç‚¹ 0ã€‚  

### å…³é”®å¸§ç¤ºä¾‹
| å¸§ | æè¿° |
|---|---|
| 0 | æ …æ ç©ºç™½ï¼Œå¥¶ç‰›åœ¨ 0ã€‚ |
| 1 | äº‹ä»¶ `(0,+1)`ï¼šåŒºé—´ `[0,2)` åƒç´ å˜æ·±ã€‚ |
| 2 | äº‹ä»¶ `(2,-1)`ï¼š`cur` å‡ 1ï¼ŒåŒºé—´ `[2,6)` ä¿æŒã€‚ |
| 3 | å½“ `cur â‰¥ 2` æ—¶ï¼Œå¯¹åº”åƒç´ æ …æ é—ªçƒç»¿è‰²ï¼Œé•¿åº¦ç´¯åŠ åˆ°è®¡åˆ†æ¿ã€‚ |

---

## 6. æ‹“å±•ç»ƒä¹ ä¸ç›¸ä¼¼é—®é¢˜æ€è€ƒ

### é€šç”¨æŠ€å·§è¿ç§»
- **æ‰«æçº¿**å¯å¤„ç†ï¼š  
  1. çŸ©å½¢é¢ç§¯å¹¶ï¼ˆIOI 1998 Pictureï¼‰ã€‚  
  2. åŒºé—´æœ€å¤šæ•°é‡å ï¼ˆPOJ 3069ï¼‰ã€‚  
  3. æ—¥ç¨‹å®‰æ’å†²çªæ£€æµ‹ï¼ˆLeetCode 253ï¼‰ã€‚

### æ´›è°·æ¨è
| é¢˜å· | æ¨èç†ç”± |
|---|---|
| **P2070** | åŒå€ç»éªŒï¼Œå®Œå…¨åŒæ€è·¯ï¼Œå·©å›ºæ‰«æçº¿æ¨¡æ¿ã€‚ |
| **P1496** | åŒºé—´è¦†ç›–+ç¦»æ•£åŒ–ï¼Œæ•°æ®èŒƒå›´æ›´å¤§ï¼Œè€ƒéªŒå¸¸æ•°ä¼˜åŒ–ã€‚ |
| **P1908** | é€†åºå¯¹ï¼Œç»ƒä¹ ç¦»æ•£åŒ–+æ ‘çŠ¶æ•°ç»„ï¼Œæ€è·¯åŒæºã€‚ |

---

## 7. å­¦ä¹ å¿ƒå¾—ä¸ç»éªŒåˆ†äº«

> **OldVagrant** åˆ†äº«ï¼š  
> â€œæˆ‘æœ€åˆæŠŠåŒºé—´å†™æˆ `[l,r]`ï¼Œç»“æœ WAã€‚åæ¥æŠŠçº¿æ®µæ ‘åŒºé—´æ”¹æˆ `[l,r-1]` æ‰ ACã€‚è®°ä½ï¼š**æ …æ å•ä½é•¿åº¦æ˜¯ `[l,r)`ï¼Œå³ç«¯ç‚¹ä¸æ¶‚**ã€‚â€

> **æ´›è¯­äº‘ç¬ºç‚¹è¯„**ï¼š  
> è¿™ä¸ªå°ç»†èŠ‚æ˜¯åŒºé—´é—®é¢˜çš„â€œç»å…¸å‘â€ã€‚ç”»å›¾éªŒè¯åŒºé—´å¼€é—­ï¼Œæ˜¯é¿å…ä½çº§é”™è¯¯çš„å¥½ä¹ æƒ¯ï¼

---

## 8. ç»“è¯­
ä»â€œæ— é™é•¿â€åˆ°â€œæœ‰é™äº‹ä»¶â€ï¼Œä»â€œæš´åŠ›â€åˆ°â€œæ‰«æçº¿â€ï¼Œæˆ‘ä»¬å®Œæˆäº†ä¸€æ¬¡æ€ç»´å‡çº§ã€‚æŒæ¡ç¦»æ•£åŒ–+æ‰«æçº¿ï¼Œä½ å°±æ‹¥æœ‰äº†å¤„ç†**å¤§è§„æ¨¡åŒºé—´é—®é¢˜**çš„â€œç‘å£«å†›åˆ€â€ã€‚ç»§ç»­åˆ·é¢˜ï¼Œä¸‹æ¬¡æ¢é™©è§ï¼

---
å¤„ç†ç”¨æ—¶ï¼š70.75ç§’
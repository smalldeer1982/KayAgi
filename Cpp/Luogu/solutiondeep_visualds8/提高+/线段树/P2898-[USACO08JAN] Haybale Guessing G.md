# é¢˜ç›®ä¿¡æ¯

# [USACO08JAN] Haybale Guessing G

## é¢˜ç›®æè¿°

ç»™ä¸€ä¸ªé•¿åº¦ä¸º $n$ çš„æ•°ç»„ $q$ ä¸ªæ¡ä»¶ï¼Œæ•°ç»„ä¸­çš„æ•°å­—äº’ä¸ç›¸åŒï¼Œæ¯ä¸ªæ¡ä»¶æ ¼å¼å½¢å¦‚  $l_i,r_i,x_i$ è¡¨ç¤ºè¿™ä¸ªæ•°ç»„çš„åŒºé—´ $[l_i,r_i]$ å†…çš„æœ€å°å€¼ä¸º $x_i$ï¼Œè¾“å‡ºæœ€æ—©ä¸å‰é¢çš„æ¡ä»¶æœ‰çŸ›ç›¾çš„æ¡ä»¶çš„ç¼–å·ï¼Œå¦‚æœæ‰€æœ‰æ¡ä»¶éƒ½ä¸å‘ç”ŸçŸ›ç›¾ï¼Œè¾“å‡º $0$ã€‚

## è¯´æ˜/æç¤º

å¯¹äº $100\%$ çš„æ•°æ®ï¼Œä¿è¯ï¼š
  - $1 \le q \le 25000$
  - $1 \le n \le 10^6$
  - $1 \le l_i \le r_i \le n$
  - $1 \le x_i \le 10^9$

## æ ·ä¾‹ #1

### è¾“å…¥

```
20 4
1 10 7
5 19 7
3 12 8
11 15 12
```

### è¾“å‡º

```
3
```

# AIåˆ†æç»“æœ

# ğŸ’¡ æ´›è¯­äº‘ç¬ºçš„C++ç®—æ³•è§£æï¼šUSACO08JAN Haybale Guessing G æ·±å…¥å­¦ä¹ æŒ‡å— ğŸ’¡

> ä»Šå¤©æˆ‘ä»¬ä¸€èµ·æ‹†è§£ä¸€é“â€œåŒºé—´æœ€å°å€¼å†²çªæ£€æµ‹â€çš„ç»å…¸ USACO é¢˜ã€‚  
> å®ƒçš„éš¾ç‚¹ä¸åœ¨äºå†™å‡ºæš´åŠ›ï¼Œè€Œåœ¨äºå¦‚ä½•**é«˜æ•ˆåœ°**åˆ¤å®šâ€œå“ªä¸€å¥è¯**æœ€æ—©**ä¸å‰é¢æ‰€æœ‰è¯çŸ›ç›¾â€ã€‚  
> æˆ‘ä»¬å°†ä»â€œé¢˜çœ¼â€å‡ºå‘ï¼Œä¸€æ­¥æ­¥æ¼”åŒ–åˆ°**äºŒåˆ† + åŒºé—´è¦†ç›–**çš„æœ€ä¼˜ç­–ç•¥ï¼Œå¹¶ç”¨åƒç´ é£åŠ¨ç”»æŠŠæ ¸å¿ƒé€»è¾‘â€œæ¼”â€å‡ºæ¥ï¼

---

## 1. é¢˜ç›®è§£è¯»ä¸ç­–ç•¥åˆæ¢

âœ¨ **æœ¬é¢˜æ ¸å¿ƒæŒ‘æˆ˜**  
> åœ¨äº’ä¸ç›¸åŒçš„åºåˆ—ä¸Šï¼Œç»™å®šè‹¥å¹²â€œåŒºé—´æœ€å°å€¼â€æ–­è¨€ï¼Œ**ç¬¬ä¸€ä¸ª**å‡ºç°çŸ›ç›¾çš„æ–­è¨€æ˜¯å“ªä¸€å¥ï¼Ÿ

âœ¨ **æ ¸å¿ƒç®—æ³•æ ‡ç­¾**  
äºŒåˆ†ç­”æ¡ˆã€åŒºé—´è¦†ç›–ã€å¹¶æŸ¥é›† / çº¿æ®µæ ‘

---

### ğŸ” ç®—æ³•ä¾¦æ¢ï¼šå¦‚ä½•åœ¨é¢˜ç›®ä¸­å‘ç°çº¿ç´¢ï¼Ÿ

| çº¿ç´¢ | åŸæ–‡ä¿¡å· | æ¨å¯¼ |
|---|---|---|
| **å•è°ƒæ€§** | â€œè¾“å‡ºæœ€æ—©çŸ›ç›¾â€ | è‹¥å‰ `k` æ¡ä¸çŸ›ç›¾ï¼Œåˆ™å‰ `k-1` æ¡æ›´ä¸çŸ›ç›¾ â†’ **äºŒåˆ†ç­”æ¡ˆ** |
| **äº’ä¸ç›¸åŒ** | â€œæ•°ç»„ä¸­çš„æ•°å­—äº’ä¸ç›¸åŒâ€ | åŒä¸€æ•°å€¼çš„æ‰€æœ‰åŒºé—´**å¿…é¡»ç›¸äº¤** |
| **åŒºé—´è¦†ç›–** | â€œæœ€å°å€¼è¢«æ›´å¤§çš„å€¼è¦†ç›–â€ | ç”¨æ•°æ®ç»“æ„ç»´æŠ¤â€œå·²è¦†ç›–â€åŒºåŸŸ â†’ **çº¿æ®µæ ‘ / å¹¶æŸ¥é›†** |

---

### ğŸ§  æ€ç»´é“¾æ„å»ºï¼šä»çº¿ç´¢åˆ°ç­–ç•¥

1. **çº¿ç´¢1ï¼šå•è°ƒæ€§** â†’ äºŒåˆ†æšä¸¾â€œç¬¬ä¸€ä¸ªçŸ›ç›¾è¯­å¥â€ `mid`  
2. **çº¿ç´¢2ï¼šäº’ä¸ç›¸åŒ** â†’ åŒä¸€æ•°å€¼çš„åŒºé—´äº¤é›†ä¸èƒ½ä¸ºç©º  
3. **çº¿ç´¢3ï¼šè¦†ç›–å…³ç³»** â†’ å¤§å€¼åŒºé—´ä¼šâ€œåƒæ‰â€å°å€¼åŒºé—´  
4. **ç»“è®º**ï¼šæ¯æ¬¡ `check(mid)` æ—¶ï¼ŒæŠŠå‰ `mid` æ¡è¯­å¥æŒ‰å€¼**ä»å¤§åˆ°å°**æ’åºï¼Œä¾æ¬¡ç”¨**åŒºé—´è¦†ç›–**åˆ¤å®šçŸ›ç›¾å³å¯ã€‚

---

## 2. ç²¾é€‰ä¼˜è´¨é¢˜è§£å‚è€ƒ

| é¢˜è§£ | ä½œè€… | äº®ç‚¹æç‚¼ | éš¾åº¦è¯„çº§ |
|---|---|---|---|
| **å¹¶æŸ¥é›†ç‰ˆ** | George1123 | ç”¨å¹¶æŸ¥é›†ç»´æŠ¤â€œå·²è¦†ç›–â€è¿ç»­æ®µï¼ŒO(q log q Î±(n)) | â­â­â­â­ |
| **çº¿æ®µæ ‘ç‰ˆ** | Rbu_nas | åŒºé—´ set + åŒºé—´æ±‚å’Œï¼Œæ€è·¯ç›´è§‚ï¼Œä»£ç æ˜“è¯» | â­â­â­ |
| **ç¦»çº¿ STB** | MuelsyseU | ç”¨â€œå†å²æœ€å€¼çº¿æ®µæ ‘â€ä¸€æ¬¡æ€§æ±‚å‡ºæ‰€æœ‰å†²çªæ—¶é—´ï¼ŒO(q log n) | â­â­â­â­â­ |

> **ç‚¹è¯„**ï¼šGeorge çš„å¹¶æŸ¥é›†å†™æ³•æŠŠâ€œåŒºé—´åˆå¹¶â€æŠ½è±¡æˆâ€œæŒ‡é’ˆè·³è·ƒâ€ï¼Œæ˜¯**æœ€ç®€æ´é«˜æ•ˆ**çš„å®ç°ï¼›çº¿æ®µæ ‘ç‰ˆåˆ™æ›´é€‚åˆåˆå­¦åŒºé—´æ•°æ®ç»“æ„çš„åŒå­¦ã€‚

---

## 3. è§£é¢˜ç­–ç•¥æ·±åº¦å‰–æ

### ğŸ¯ æ ¸å¿ƒéš¾ç‚¹ä¸å…³é”®æ­¥éª¤ï¼ˆæœ€ä¼˜è§£ï¼šå¹¶æŸ¥é›† + äºŒåˆ†ï¼‰

| å…³é”®ç‚¹ | åˆ†æ | ğŸ’¡ å­¦ä¹ ç¬”è®° |
|---|---|---|
| **1. äºŒåˆ†æ¡†æ¶** | `l=0, r=q+1`ï¼Œ`check(mid)` åˆ¤å®šå‰ `mid` æ¡æ˜¯å¦çŸ›ç›¾ | ç­”æ¡ˆå•è°ƒæ€§æ˜¯äºŒåˆ†çš„çµé­‚ |
| **2. æ’åºç­–ç•¥** | æŒ‰å€¼ä»å¤§åˆ°å°æ’ï¼Œç›¸åŒå€¼æŒ‰å·¦ç«¯ç‚¹å‡åº | ä¿è¯â€œå¤§å€¼å…ˆè¦†ç›–â€ |
| **3. å¹¶æŸ¥é›†ç»´æŠ¤è¦†ç›–** | `fa[i]` æŒ‡å‘ `i` å³è¾¹ç¬¬ä¸€ä¸ª**æœªè¢«è¦†ç›–**çš„ä½ç½® | ç±»ä¼¼â€œé»‘ç™½æŸ“è‰²â€æ¨¡æ¿ |
| **4. çŸ›ç›¾æ£€æµ‹** | åŒä¸€å€¼çš„åŒºé—´äº¤é›†ä¸ºç©º â†’ ç›´æ¥çŸ›ç›¾ï¼›äº¤é›†è¢«å®Œå…¨è¦†ç›– â†’ é—´æ¥çŸ›ç›¾ | ç”¨ `find(l) > r` åˆ¤æ–­ |

---

### âœ¨ è§£é¢˜æŠ€å·§æ€»ç»“

- **åŒºé—´åˆå¹¶æ€æƒ³**ï¼šæŠŠâ€œè¦†ç›–â€çœ‹ä½œâ€œåˆ é™¤â€ï¼Œç”¨å¹¶æŸ¥é›†è·³è¿‡å·²è¦†ç›–æ®µã€‚
- **åŒæŒ‡é’ˆæ‰«æ**ï¼šä¸€æ¬¡éå†å³å¯å¤„ç†åŒä¸€å€¼çš„æ‰€æœ‰åŒºé—´ã€‚
- **è¾¹ç•Œå¤„ç†**ï¼šè®°å¾—æŠŠ `n+1` è®¾ä¸ºè™šæ‹Ÿå“¨å…µï¼Œé˜²æ­¢è¶Šç•Œã€‚

---

### âš”ï¸ ç­–ç•¥ç«æŠ€åœºï¼šä¸åŒè§£æ³•å¯¹æ¯”

| ç­–ç•¥ | æ ¸å¿ƒæ€æƒ³ | æ—¶é—´å¤æ‚åº¦ | ä¼˜ç‚¹ | ç¼ºç‚¹ | é€‚ç”¨åœºæ™¯ |
|---|---|---|---|---|---|
| æš´åŠ›æšä¸¾ | é€æ¡éªŒè¯ O(qÂ²) | O(qÂ²) | æ€è·¯ç®€å• | è¶…æ—¶ | q â‰¤ 300 |
| çº¿æ®µæ ‘ | åŒºé—´ set + åŒºé—´æ±‚å’Œ | O(q log q log n) | ç›´è§‚æ˜“æ‡‚ | å¸¸æ•°å¤§ | åˆå­¦æ•°æ®ç»“æ„ |
| å¹¶æŸ¥é›† | æŒ‡é’ˆè·³è·ƒç»´æŠ¤è¦†ç›– | O(q log q Î±(n)) | ä»£ç çŸ­ã€å¸¸æ•°å° | æ€ç»´è·³è·ƒ | ç«èµ›å®æˆ˜é¦–é€‰ |
| å†å²æœ€å€¼çº¿æ®µæ ‘ | ç¦»çº¿å¤„ç†å†²çªæ—¶é—´ | O(q log n) | æœ€ä¼˜ç†è®ºå¤æ‚åº¦ | å®ç°å¤æ‚ | è¿½æ±‚æè‡´æ€§èƒ½ |

---

## 4. C++æ ¸å¿ƒä»£ç å®ç°èµæ

### â‘  å¹¶æŸ¥é›†é€šç”¨æ ¸å¿ƒä»£ç ï¼ˆGeorge1123 æç‚¼ç‰ˆï¼‰

```cpp
#include <bits/stdc++.h>
using namespace std;
const int N = 1e6 + 10, Q = 25005;
struct Ask { int l, r, v; } a[Q], b[Q];
int n, q, fa[N];
int find(int x) { return x == fa[x] ? x : fa[x] = find(fa[x]); }
bool cmp(Ask x, Ask y) { return x.v == y.v ? x.l < y.l : x.v > y.v; }

bool check(int x) {
    iota(fa, fa + n + 2, 0);                // åˆå§‹åŒ–å¹¶æŸ¥é›†
    copy(a + 1, a + x + 1, b + 1);
    sort(b + 1, b + x + 1, cmp);

    int L, R, l, r, val = b[1].v;
    L = l = b[1].l, R = r = b[1].r;
    for (int i = 2; i <= x; ++i) {
        if (b[i].v == val) {
            l = max(l, b[i].l);
            r = min(r, b[i].r);
            L = min(L, b[i].l);
            R = max(R, b[i].r);
            if (l > r) return false;       // äº¤é›†ä¸ºç©º
        } else {
            if (find(l) > r) return false; // äº¤é›†è¢«å®Œå…¨è¦†ç›–
            for (int j = find(L); j <= R; j = find(j + 1)) fa[j] = j + 1;
            val = b[i].v;
            L = l = b[i].l;
            R = r = b[i].r;
        }
    }
    return find(l) <= r;
}

int main() {
    scanf("%d%d", &n, &q);
    for (int i = 1; i <= q; ++i) scanf("%d%d%d", &a[i].l, &a[i].r, &a[i].v);
    int l = 0, r = q + 1;
    while (l < r - 1) {
        int mid = (l + r) >> 1;
        if (check(mid)) l = mid;
        else r = mid;
    }
    printf("%d\n", r == q + 1 ? 0 : r);
    return 0;
}
```

---

### â‘¡ çº¿æ®µæ ‘ç‰‡æ®µèµæï¼ˆRbu_nasï¼‰

```cpp
// åŒºé—´ set + åŒºé—´æ±‚å’Œçº¿æ®µæ ‘
void update(int l,int r,int v,int p=1,int cl=1,int cr=n){
    if(l<=cl && cr<=r){ tr[p]={cr-cl+1,1}; return; }
    push_down(cl,cr,p);
    int mid=(cl+cr)>>1;
    if(l<=mid) update(l,r,v,ls);
    if(r>mid)  update(l,r,v,rs);
    tr[p].sum=tr[ls].sum+tr[rs].sum;
}
int query(int l,int r,int p=1,int cl=1,int cr=n){
    if(l<=cl && cr<=r) return tr[p].sum;
    push_down(cl,cr,p);
    int mid=(cl+cr)>>1, res=0;
    if(l<=mid) res+=query(l,r,ls);
    if(r>mid)  res+=query(l,r,rs);
    return res;
}
```
> å­¦ä¹ ç¬”è®°ï¼šçº¿æ®µæ ‘ç”¨ `sum == len` åˆ¤æ–­åŒºé—´è¢«å®Œå…¨è¦†ç›–ï¼Œé€»è¾‘æ¸…æ™°ï¼Œé€‚åˆåˆå­¦ã€‚

---

## 5. ç®—æ³•å¯è§†åŒ–ï¼šåƒç´ åŠ¨ç”»æ¼”ç¤º

### ğŸ® åŠ¨ç”»ä¸»é¢˜ï¼š**â€œåƒç´ ç‰§åœºâ€çš„è¦†ç›–ä¹‹æ—…**

- **åœºæ™¯**ï¼š8Ã—8 åƒç´ è‰åœ°ï¼Œæ¯ä¸ªåƒç´ ä»£è¡¨ä¸€ä¸ªè‰å›ï¼Œåˆå§‹ä¸ºç»¿è‰²ï¼ˆæœªè¦†ç›–ï¼‰ã€‚
- **æ“ä½œ**ï¼šä»å¤§åˆ°å°ä¾æ¬¡æ”¾ç½®â€œæœ€å°å€¼åŒºé—´â€ï¼Œè¢«è¦†ç›–çš„åƒç´ å˜æˆé»„è‰²ã€‚
- **çŸ›ç›¾æç¤º**ï¼š
  - **äº¤é›†ä¸ºç©º** â†’ ä¸¤ä¸ªçº¢è‰²åŒºé—´é—ªçƒå¹¶çˆ†ç‚¸éŸ³æ•ˆã€‚
  - **è¢«å®Œå…¨è¦†ç›–** â†’ äº¤é›†åƒç´ å…¨éƒ¨å˜é»„å¹¶æ’­æ”¾â€œå¤±è´¥â€éŸ³æ•ˆã€‚
- **æ§åˆ¶é¢æ¿**ï¼šå•æ­¥ / è‡ªåŠ¨ / è°ƒé€Ÿæ»‘å— / é‡ç½®æŒ‰é’®ã€‚
- **éŸ³æ•ˆ**ï¼š8-bit é£æ ¼â€œå®â€æç¤ºæ“ä½œï¼Œâ€œå“”å“”â€è¡¨ç¤ºçŸ›ç›¾ã€‚

> å®ç°æç¤ºï¼šç”¨ Canvas ç»˜åˆ¶åƒç´ æ ¼ï¼Œ`setInterval` æ§åˆ¶å¸§ç‡ï¼Œ`AudioContext` æ’­æ”¾ 8-bit éŸ³æ•ˆã€‚

---

## 6. æ‹“å±•ç»ƒä¹ ä¸ç›¸ä¼¼é—®é¢˜æ€è€ƒ

### é€šç”¨æŠ€å·§è¿ç§»
- **åŒºé—´åˆå¹¶ / è¦†ç›–**ï¼šP1840 æŸ“è‰²é—®é¢˜ã€CF915E è¯¾ç¨‹å®‰æ’
- **äºŒåˆ†ç­”æ¡ˆ + åŒºé—´æ•°æ®ç»“æ„**ï¼šP1083 å€Ÿæ•™å®¤ã€P1314 èªæ˜çš„è´¨ç›‘å‘˜

### æ´›è°·æ¨è
1. **P1083** å€Ÿæ•™å®¤  
   ğŸ—£ï¸ ç”¨çº¿æ®µæ ‘æˆ–å·®åˆ†+äºŒåˆ†åˆ¤å®šåŒºé—´è¦†ç›–æ˜¯å¦è¶…é™ã€‚
2. **P1840** Color the Axis  
   ğŸ—£ï¸ å¹¶æŸ¥é›†ç»´æŠ¤â€œå·²æŸ“è‰²â€è¿ç»­æ®µï¼Œå·©å›ºåŒºé—´åˆå¹¶æ€æƒ³ã€‚
3. **P2898** æœ¬é¢˜åŸé¢˜  
   ğŸ—£ï¸ å°è¯•ç”¨**å†å²æœ€å€¼çº¿æ®µæ ‘**å®ç°ç¦»çº¿ O(q log n) åšæ³•ã€‚

---

## 7. å­¦ä¹ å¿ƒå¾—ä¸ç»éªŒåˆ†äº«

> **George1123 çš„è°ƒè¯•å¿ƒå¾—**ï¼š  
> â€œæœ€åˆæŠŠ `fa` æ•°ç»„åªå¼€åˆ° `n`ï¼Œç»“æœ `find(n+1)` è¶Šç•Œï¼ŒWA äº†ä¸¤æ¬¡ã€‚åæ¥æŠŠå“¨å…µå¼€åˆ° `n+2` æ‰è§£å†³ã€‚â€  
> **æ´›è¯­äº‘ç¬ºç‚¹è¯„**ï¼šè¾¹ç•Œå“¨å…µæ˜¯å¹¶æŸ¥é›†é¢˜å¸¸è§å‘ï¼Œè®°å¾—å¤šå¼€ä¸€æ ¼ï¼

---

## ğŸ’¡ æ€»ç»“

- **æ€ç»´è·¯å¾„**ï¼šå•è°ƒæ€§ â†’ äºŒåˆ† â†’ åŒºé—´è¦†ç›– â†’ å¹¶æŸ¥é›†/çº¿æ®µæ ‘  
- **å…³é”®æŠ€å·§**ï¼šæ’åºæ–¹å‘ + åŒºé—´äº¤é›†/å¹¶é›† + æŒ‡é’ˆè·³è·ƒ  
- **å®æˆ˜å»ºè®®**ï¼šå…ˆå†™çº¿æ®µæ ‘ç†Ÿæ‚‰åŒºé—´æ“ä½œï¼Œå†ç²¾ç®€ä¸ºå¹¶æŸ¥é›†å†²æ¦œã€‚

ç¥å¤§å®¶ AC æ„‰å¿«ï¼Œç‰§åœºå†æ— çŸ›ç›¾ï¼

---
å¤„ç†ç”¨æ—¶ï¼š65.76ç§’
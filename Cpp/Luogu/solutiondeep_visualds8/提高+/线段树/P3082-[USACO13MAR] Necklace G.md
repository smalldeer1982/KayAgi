# é¢˜ç›®ä¿¡æ¯

# [USACO13MAR] Necklace G

## é¢˜ç›®æè¿°

Bessie the cow has arranged a string of N rocks, each containing a single letter of the alphabet, that she wants to build into a fashionable necklace.

Being protective of her belongings, Bessie does not want to share her necklace with the other cow currently living on her side of the barn.  The other cow has a name that is a string of M characters, and Bessie wants to be sure that this length-M string does not occur as a contiguous substring anywhere within the string representing her necklace (otherwise, the other cow might mistakenly think the necklace is for her).  Bessie decides to remove some of the rocks in her necklace so that the other cow's name does not appear as a substring.  Please help Bessie determine the minimum number of rocks she must remove.

è´è¥¿æ”¶é›†äº†Né¢—çŸ³å¤´ï¼Œæ¯é¢—çŸ³å¤´ä¸Šéƒ½æœ‰ä¸€ä¸ªå­—æ¯ï¼Œè´è¥¿æƒ³æŠŠè¿™äº›çŸ³å¤´åšæˆé¡¹é“¾ã€‚

è´è¥¿çš„èº«è¾¹æœ‰å¦ä¸€åªå¥¶ç‰›ï¼Œè¿™åªå¥¶ç‰›çš„åå­—æ˜¯ä¸€ä¸ªé•¿åº¦ä¸ºMçš„å­—ç¬¦ä¸²ï¼Œè´è¥¿ä¸å¸Œæœ›è¿™åªç‰›çš„åå­—å‡ºç°åœ¨å¥¹çš„é¡¹é“¾ä¸Š(é¡¹é“¾çš„å­ä¸²)ï¼Œå¥¹æƒ³çŸ¥é“ï¼Œæœ€å°‘åˆ æ‰å‡ é¢—çŸ³å¤´å°±å¯ä»¥é¿å…è¿™ç§æƒ…å†µå‘ç”Ÿã€‚


## è¯´æ˜/æç¤º

```cpp
For at least 20% of test cases, N <= 20. 
For at least 60% of test cases, N <= 1000, M <= 100. 
For all test cases, N <= 10000, M <= 1000. 
For all test cases, M <= N. 
```
The modified necklace should be "abbaa".

---

$\text{upd 2022.7.29}$ï¼šæ–°å¢åŠ ä¸€ç»„ Hack æ•°æ®ã€‚

## æ ·ä¾‹ #1

### è¾“å…¥

```
ababaa 
aba 
```

### è¾“å‡º

```
1 
```

# AIåˆ†æç»“æœ

# ğŸ’¡ æ´›è¯­äº‘ç¬ºçš„C++ç®—æ³•è§£æï¼š[USACO13MAR] Necklace G æ·±å…¥å­¦ä¹ æŒ‡å— ğŸ’¡  
> ä»Šå¤©æˆ‘ä»¬æ¥ä¸€èµ·åˆ†æã€ŒNecklace Gã€è¿™é“å­—ç¬¦ä¸² DP é¢˜ã€‚å®ƒçœ‹ä¼¼åªæ˜¯â€œåˆ æ‰å‡ ä¸ªå­—æ¯â€ï¼ŒèƒŒåå´éšè—ç€ã€ŒKMP Ã— åŠ¨æ€è§„åˆ’ã€çš„ç²¾å¦™é…åˆã€‚è·Ÿç€æ´›è¯­äº‘ç¬ºï¼Œä¸€èµ·æ‹†è§£å§ï¼

---

## 1. é¢˜ç›®è§£è¯»ä¸ç­–ç•¥åˆæ¢

### âœ¨ æ ¸å¿ƒæŒ‘æˆ˜
> **åœ¨ä¸€æ¡é•¿ä¸º N çš„é¡¹é“¾ï¼ˆå­—ç¬¦ä¸² Sï¼‰é‡Œï¼Œæœ€å°‘åˆ æ‰å‡ é¢—çŸ³å¤´ï¼Œæ‰èƒ½è®©å¦ä¸€åªå¥¶ç‰›çš„åå­— T ä¸å†ä½œä¸ºè¿ç»­å­ä¸²å‡ºç°ï¼Ÿ**

### âœ¨ ç®—æ³•æ ‡ç­¾
- å­—ç¬¦ä¸²åŒ¹é…ï¼ˆKMP / AC è‡ªåŠ¨æœºï¼‰
- çº¿æ€§åŠ¨æ€è§„åˆ’ï¼ˆLinear DPï¼‰
- çŠ¶æ€å‹ç¼©æ€æƒ³ï¼ˆç”¨åŒ¹é…é•¿åº¦åšç¬¬äºŒç»´ï¼‰

### ğŸ—£ï¸ æ€è·¯æ¦‚è§ˆ
| æ–¹æ³• | æ€è·¯ä¸€å¥è¯ | å¤æ‚åº¦ | é¢„æœŸå¾—åˆ† |
| --- | --- | --- | --- |
| æš´åŠ›æšä¸¾å­é›† | æšä¸¾åˆ å“ªäº›å­—ç¬¦ï¼Œå†æ£€æŸ¥æ˜¯å¦å« T | O(2^N Â· M) | 10-20% |
| çº¯ KMP å¤šæ¬¡åŒ¹é… | æ¯åˆ ä¸€ä¸ªå­—ç¬¦å°±é‡è·‘ä¸€æ¬¡ KMP | O(N^2) | 40-50% |
| **KMP + DP** | **æŠŠâ€œå½“å‰åŒ¹é…åˆ° T çš„ç¬¬å‡ ä½â€å¡è¿›çŠ¶æ€é‡Œï¼Œä¸€æ¬¡çº¿æ€§é€’æ¨** | **O(NÂ·M)** | **100%** |

> ä¸ºä»€ä¹ˆ DP å¯è¡Œï¼Ÿ  
> å› ä¸ºã€Œåˆ å­—ç¬¦ã€å…·æœ‰**æ— åæ•ˆæ€§**ï¼šå‰é¢åˆ å“ªäº›ä¸å½±å“åé¢å†³ç­–ï¼Œåªå…³å¿ƒã€Œç›®å‰åŒ¹é…åˆ° T çš„å“ªä¸ªä½ç½®ã€å³å¯ã€‚

---

### ğŸ” ç®—æ³•ä¾¦æ¢ï¼šå¦‚ä½•åœ¨é¢˜ç›®ä¸­å‘ç°çº¿ç´¢ï¼Ÿ
1. **çº¿ç´¢1ï¼ˆç›®æ ‡ï¼‰**ï¼šæœ€å°åŒ–åˆ é™¤æ•°é‡ â†’ ç»å…¸ã€Œæœ€é•¿ä¿ç•™ã€DPã€‚
2. **çº¿ç´¢2ï¼ˆçº¦æŸï¼‰**ï¼šä¸èƒ½å‡ºç°å­ä¸² T â†’ éœ€è¦å®æ—¶çŸ¥é“ã€Œç¦»å‡ºç° T è¿˜æœ‰å¤šè¿œã€ã€‚
3. **çº¿ç´¢3ï¼ˆæ•°æ®ï¼‰**ï¼šN â‰¤ 1e4ï¼ŒM â‰¤ 1e3 â†’ O(NÂ·M) â‰ˆ 1e7 æ¬¡è¿ç®—ï¼Œå¯è¿‡ã€‚

### ğŸ§  æ€ç»´é“¾æ„å»ºï¼šä»çº¿ç´¢åˆ°ç­–ç•¥
> â€œæˆ‘å…ˆæƒ³åˆ°æš´åŠ›ï¼Œä½†æŒ‡æ•°çº§è‚¯å®šä¸è¡Œï¼›  
> æ¥ç€æƒ³ç”¨ KMPï¼Œå¯æ¯åˆ ä¸€æ¬¡å°±é‡è·‘å¤ªæµªè´¹ï¼›  
> äºæ˜¯æŠŠ KMP çš„â€˜å¤±é…æŒ‡é’ˆâ€™åµŒè¿› DP çŠ¶æ€ï¼š  
> **f[i][j] = å¤„ç†å®Œ S å‰ i ä½ï¼Œå½“å‰åç¼€ä¸ T æœ€é•¿å…¬å…±å‰ç¼€é•¿åº¦ä¸º j æ—¶çš„æœ€é•¿ä¿ç•™é•¿åº¦**  
> è¿™æ ·å°±æŠŠã€åŒ¹é…è¿›åº¦ã€å‹ç¼©æˆäº†ä¸€ä¸ªç»´åº¦ï¼Œçº¿æ€§é€’æ¨å³å¯ã€‚â€

---

## 2. ç²¾é€‰ä¼˜è´¨é¢˜è§£å‚è€ƒ

| é¢˜è§£ | äº®ç‚¹æç‚¼ | æ¨èæŒ‡æ•° |
| --- | --- | --- |
| **Â¶å‡‰ç¬™** | ç”¨ **AC è‡ªåŠ¨æœº** ç»Ÿä¸€å¤„ç†å¤šæ¨¡å¼ä¸²æ€æƒ³ï¼ŒæŠŠ T å»ºæˆ trie å›¾ï¼Œå†è·‘ DPï¼›ä»£ç ç®€æ´ã€‚ | â­â­â­â­ |
| **zhaoyp** | ç›´æ¥ **KMP next æ•°ç»„** é¢„å¤„ç†è½¬ç§»è¡¨ g[i][c]ï¼Œæ¸…æ™°å±•ç¤ºã€Œå¤±é…æŒ‡é’ˆã€å¦‚ä½•åµŒå…¥ DPã€‚ | â­â­â­â­â­ |
| **Parsley_** | å›¾æ–‡å¹¶èŒ‚è§£é‡Š **çŠ¶æ€è®¾è®¡åŠ¨æœº**ï¼ˆä¸ºä»€ä¹ˆç¬¬äºŒç»´æ˜¯ jï¼‰ï¼Œå¯¹æ–°æ‰‹æå‹å¥½ã€‚ | â­â­â­â­ |
| **SolIII** | ç”¨ **è®°å¿†åŒ–æœç´¢** å°è£…è½¬ç§»å‡½æ•°ï¼Œé¿å…é‡å¤è®¡ç®—ï¼Œå±•ç¤ºã€Œç©ºé—´æ¢æ—¶é—´ã€æŠ€å·§ã€‚ | â­â­â­ |

> ç”±äºç¯‡å¹…ï¼Œä¸‹é¢é‡ç‚¹è§£æ zhaoyp çš„ KMP-DP æ–¹æ¡ˆï¼ˆæ€è·¯æœ€ç›´è§‚ï¼Œä»£ç æœ€çŸ­ï¼‰ã€‚

---

## 3. è§£é¢˜ç­–ç•¥æ·±åº¦å‰–æ

### ğŸ¯ æ ¸å¿ƒéš¾ç‚¹ä¸å…³é”®æ­¥éª¤ï¼ˆä»¥ zhaoyp æ–¹æ¡ˆä¸ºä¾‹ï¼‰

#### å…³é”®ç‚¹1ï¼šæŠŠã€ŒåŒ¹é…è¿›åº¦ã€å˜æˆçŠ¶æ€
- **çŠ¶æ€**ï¼š`f[i][j]` è¡¨ç¤ºè€ƒè™‘å®Œ S å‰ i ä½ï¼Œå½“å‰åç¼€ä¸ T å‰ j ä½å®Œå…¨åŒ¹é…æ—¶çš„ **æœ€é•¿ä¿ç•™é•¿åº¦**ã€‚
- **ç­”æ¡ˆ**ï¼š`n - max(f[n][j] | 0 â‰¤ j < m)`ï¼Œå› ä¸º j ä¸èƒ½ç­‰äº mï¼ˆå¦åˆ™å‡ºç° Tï¼‰ã€‚

#### å…³é”®ç‚¹2ï¼šé¢„å¤„ç†è½¬ç§»è¡¨ `g[j][c]`
- ä½œç”¨ï¼šå·²çŸ¥å½“å‰åŒ¹é…åˆ° T çš„ j ä½ï¼Œå†è¯»å…¥å­—ç¬¦ cï¼Œä¼šè·³åˆ°å“ªä¸ªæ–°ä½ç½®ï¼Ÿ
- æ±‚æ³•ï¼šåˆ©ç”¨ KMP çš„ next æ•°ç»„é€’å½’è·³å¤±é…æŒ‡é’ˆï¼Œå¤æ‚åº¦ O(26Â·M)ã€‚
```cpp
g[i][c] = (T[i+1]==c) ? i+1 : g[next[i]][c];
```

#### å…³é”®ç‚¹3ï¼šDP è½¬ç§»
- **ä¿ç•™**ç¬¬ i+1 ä¸ªå­—ç¬¦ï¼š`f[i+1][ g[j][c] ] = max(..., f[i][j]+1)`  
- **åˆ é™¤**ç¬¬ i+1 ä¸ªå­—ç¬¦ï¼š`f[i+1][j] = max(..., f[i][j])`  
- æ³¨æ„ï¼šè‹¥ `g[j][c] == m` è¯´æ˜å·²ç»å®Œæ•´åŒ¹é… Tï¼Œä¸èƒ½ä¿ç•™ï¼Œç›´æ¥ä¸¢å¼ƒã€‚

ğŸ’¡ **å­¦ä¹ ç¬”è®°**  
> æŠŠã€Œå¤±é…æŒ‡é’ˆã€é¢„å¤„ç†æˆäºŒç»´è¡¨ï¼Œå°±èƒ½æŠŠå­—ç¬¦ä¸²åŒ¹é…èåˆè¿› DPï¼Œå®ç°çº¿æ€§å¤æ‚åº¦ã€‚

---

### âš”ï¸ ç­–ç•¥ç«æŠ€åœº

| ç­–ç•¥ | æ ¸å¿ƒæ€æƒ³ | ä¼˜ç‚¹ | ç¼ºç‚¹ | é€‚ç”¨åœºæ™¯ |
| --- | --- | --- | --- | --- |
| æš´åŠ› | æšä¸¾åˆ å“ªäº›ä½ | æ€ç»´é›¶é—¨æ§› | O(2^N) çˆ†ç‚¸ | N â‰¤ 20 |
| çº¯ KMP | æ¯åˆ ä¸€ä½é‡è·‘ | ä»£ç çŸ­ | O(N^2) è¶…æ—¶ | N â‰¤ 1e3 |
| **KMP-DP** | çŠ¶æ€ = åŒ¹é…é•¿åº¦ | O(NÂ·M) ç¨³è¿‡ | éœ€é¢„å¤„ç†è½¬ç§»è¡¨ | N â‰¤ 1e4, M â‰¤ 1e3 |

---

## 4. C++æ ¸å¿ƒä»£ç å®ç°èµæ

### âœ… é€šç”¨æ ¸å¿ƒå‚è€ƒï¼ˆzhaoyp ç‰ˆï¼Œå·²ç²¾ç®€ï¼‰
```cpp
#include <bits/stdc++.h>
using namespace std;
const int N = 1e4 + 5, M = 1e3 + 5;
int n, m, f[N][M], g[M][26], nxt[M];
char a[N], b[M];

void build_next() {            // KMP é¢„å¤„ç†
    for (int i = 2, j = 0; i <= m; ++i) {
        while (j && b[i] != b[j + 1]) j = nxt[j];
        if (b[i] == b[j + 1]) ++j;
        nxt[i] = j;
    }
    for (int i = 0; i < m; ++i)
        for (int c = 0; c < 26; ++c) {
            int j = i;
            while (j && b[j + 1] != c + 'a') j = nxt[j];
            g[i][c] = (b[j + 1] == c + 'a') ? j + 1 : 0;
        }
}

int main() {
    scanf("%s%s", a + 1, b + 1);
    n = strlen(a + 1), m = strlen(b + 1);
    build_next();
    memset(f, 0xcf, sizeof(f));            // -inf
    f[0][0] = 0;
    for (int i = 0; i < n; ++i)
        for (int j = 0; j < m; ++j) if (f[i][j] >= 0) {
            // ä¿ç•™ a[i+1]
            int nj = g[j][a[i + 1] - 'a'];
            if (nj < m) f[i + 1][nj] = max(f[i + 1][nj], f[i][j] + 1);
            // åˆ é™¤ a[i+1]
            f[i + 1][j] = max(f[i + 1][j], f[i][j]);
        }
    int ans = 0;
    for (int j = 0; j < m; ++j) ans = max(ans, f[n][j]);
    cout << n - ans << '\n';
    return 0;
}
```
**ä»£ç è§£è¯»æ¦‚è¦**  
- `build_next()`ï¼šå…ˆç”¨ KMP æ±‚å‡º next æ•°ç»„ï¼Œå†é¡ºä¾¿æŠŠã€Œå½“å‰çŠ¶æ€ + å­—ç¬¦ã€çš„è½¬ç§»è¡¨ g ç®—å¥½ã€‚  
- ä¸»å¾ªç¯ï¼šç»å…¸ 01 èƒŒåŒ…å¼ä¸¤å±‚å¾ªç¯ï¼Œå¤–å±‚æšä¸¾ Sï¼Œå†…å±‚æšä¸¾åŒ¹é…é•¿åº¦ jã€‚  
- ç­”æ¡ˆï¼šæœ€é•¿ä¿ç•™é•¿åº¦ ansï¼Œå†ç”¨ `n - ans` å³æœ€å°‘åˆ é™¤æ•°é‡ã€‚

---

## 5. ç®—æ³•å¯è§†åŒ–ï¼šåƒç´ åŠ¨ç”»æ¼”ç¤º

> ä¸»é¢˜ï¼š**â€œåƒç´ å°ç²¾çµèº²é¿é­”å’’ Tâ€**  
> åœºæ™¯ï¼š8Ã—N çš„åƒç´ è·‘é“ï¼Œå°ç²¾çµä¸€è·¯æ¡èµ·å­—æ¯çŸ³ï¼Œå¤´é¡¶æ˜¾ç¤ºå½“å‰ä¸ T çš„åŒ¹é…è¿›åº¦æ¡ã€‚

| å¸§ | ç”»é¢ & éŸ³æ•ˆ | ç›®çš„ |
| --- | --- | --- |
| 0 | åƒç´ è·‘é“åˆå§‹åŒ–ï¼Œå°ç²¾çµåœ¨èµ·ç‚¹ï¼Œè¿›åº¦æ¡=0 | å»ºç«‹åœºæ™¯ |
| 1 | å‡ºç°å­—æ¯çŸ³ `a[i]`ï¼Œå°ç²¾çµæ€è€ƒï¼šæ¡ or ä¸¢ï¼Ÿ | å¼•å¯¼å†³ç­– |
| 2 | è‹¥æ¡èµ· â†’ è¿›åº¦æ¡è·³åˆ° `g[j][c]`ï¼›è‹¥ä¸¢å¼ƒ â†’ è¿›åº¦æ¡ä¸å˜ | å±•ç¤ºçŠ¶æ€è½¬ç§» |
| 3 | è¿›åº¦æ¡è¾¾åˆ° m â†’ å°ç²¾çµè¢«â€œé­”å’’â€å‡»ä¸­ï¼Œçº¢è‰²é—ªçƒï¼Œå¼ºåˆ¶ä¸¢å¼ƒ | å¼ºè°ƒéæ³•çŠ¶æ€ |
| 4 | è·‘é“å°½å¤´å‡ºç°æ——å¸œï¼Œæ˜¾ç¤º `ans` åƒç´ æ•°å­— | ç»“æœå±•ç¤º |

äº¤äº’æŒ‰é’®ï¼š  
- â¯ï¸ è‡ªåŠ¨ / å•æ­¥  
- ğŸ”„ é‡ç½®  
- ğŸµ 8-bit éŸ³æ•ˆå¼€å…³

---

## 6. æ‹“å±•ç»ƒä¹ ä¸ç›¸ä¼¼é—®é¢˜æ€è€ƒ

### é€šç”¨æŠ€å·§è¿ç§»
- **çŠ¶æ€å‹ç¼©**ï¼šæŠŠâ€œä¸æ¨¡å¼ä¸²çš„åŒ¹é…è¿›åº¦â€ä½œä¸º DP ç¬¬äºŒç»´ï¼Œå¯æ¨å¹¿åˆ°ï¼š
  - æ–‡æœ¬ä¸­å‡ºç°å¤šä¸ªç¦ç”¨è¯ï¼ˆAC è‡ªåŠ¨æœº + DPï¼‰ã€‚
  - æœ€é•¿ä¸å«æ•æ„Ÿè¯çš„å­åºåˆ—ã€‚
  - å¸¦é€šé…ç¬¦çš„åŒ¹é…é—®é¢˜ã€‚

### æ´›è°·æ¨è
| é¢˜å· | æ¨èç†ç”± |
| --- | --- |
| P3193 [USACO16OPEN] Closing the Farm | åŒæ ·åˆ©ç”¨ã€Œå½“å‰è¿é€šå—çŠ¶æ€ã€åš DP ç¬¬äºŒç»´ |
| P3435 [USACO07NOV] Cow Traffic | æŠŠã€Œèµ°åˆ°å“ªä¸€æ­¥ã€ä½œä¸ºçŠ¶æ€ï¼Œçº¿æ€§ DP |
| P2414 [NOI2011] é˜¿ç‹¸çš„æ‰“å­—æœº | AC è‡ªåŠ¨æœº + DP çš„ç»å…¸ç»¼åˆé¢˜ |

---

## 7. å­¦ä¹ å¿ƒå¾—ä¸ç»éªŒåˆ†äº«

> **Parsley_ çš„é¡¿æ‚Ÿ**ï¼š  
> â€œæˆ‘æœ€åˆå¡å£³åœ¨â€˜ä¸ºä»€ä¹ˆç¬¬äºŒç»´æ˜¯ jâ€™ï¼Œåæ¥æŠŠ KMP çš„å¤±é…æŒ‡é’ˆç”»æˆå›¾ï¼Œæ‰æ˜ç™½ï¼š**DP çŠ¶æ€å°±æ˜¯ KMP è‡ªåŠ¨æœºçš„èŠ‚ç‚¹**ã€‚â€

æ´›è¯­äº‘ç¬ºç‚¹è¯„ï¼š  
æŠŠæŠ½è±¡å­—ç¬¦ä¸²åŒ¹é…å¯è§†åŒ–æˆã€Œè¿›åº¦æ¡ã€æˆ–ã€Œè‡ªåŠ¨æœºèŠ‚ç‚¹ã€ï¼Œå°±èƒ½è®©çŠ¶æ€è®¾è®¡ä¸å†ç„å­¦ã€‚

---

<conclusion>
ä»Šå¤©æˆ‘ä»¬ç”¨ã€ŒKMP-DPã€ç»„åˆæ‹³è§£å†³äº† Necklace Gï¼š  
- å…ˆç”¨ KMP æ€æƒ³æŠŠâ€œåŒ¹é…è¿›åº¦â€å‹æˆçŠ¶æ€ï¼›  
- å†ç”¨çº¿æ€§ DP ä¸€æ¬¡é€’æ¨æ±‚æœ€é•¿ä¿ç•™ï¼›  
- æœ€å `n - ans` å³æœ€å°åˆ é™¤ã€‚  
è®°ä½ï¼šçœ‹åˆ°â€œå­ä¸²ç¦æ­¢å‡ºç°â€ï¼Œå…ˆæƒ³**çŠ¶æ€ = åŒ¹é…é•¿åº¦**ï¼Œå†ç”¨ KMP é¢„å¤„ç†è½¬ç§»ï¼  
ä¸‹æ¬¡æ¢é™©è§ï¼ğŸ’ª
</conclusion>

---
å¤„ç†ç”¨æ—¶ï¼š85.70ç§’
# é¢˜ç›®ä¿¡æ¯

# ã€æ¨¡æ¿ã€‘å¯æŒä¹…åŒ–çº¿æ®µæ ‘ 2

## é¢˜ç›®èƒŒæ™¯

è¿™æ˜¯ä¸ªéå¸¸ç»å…¸çš„å¯æŒä¹…åŒ–æƒå€¼çº¿æ®µæ ‘å…¥é—¨é¢˜â€”â€”é™æ€åŒºé—´ç¬¬ $k$ å°ã€‚

**æ•°æ®å·²ç»è¿‡åŠ å¼ºï¼Œè¯·ä½¿ç”¨å¯æŒä¹…åŒ–æƒå€¼çº¿æ®µæ ‘ã€‚åŒæ—¶è¯·æ³¨æ„å¸¸æ•°ä¼˜åŒ–**ã€‚


## é¢˜ç›®æè¿°

å¦‚é¢˜ï¼Œç»™å®š $n$ ä¸ªæ•´æ•°æ„æˆçš„åºåˆ— $a$ï¼Œå°†å¯¹äºæŒ‡å®šçš„é—­åŒºé—´ $[l, r]$ æŸ¥è¯¢å…¶åŒºé—´å†…çš„ç¬¬ $k$ å°å€¼ã€‚


## è¯´æ˜/æç¤º

### æ ·ä¾‹ 1 è§£é‡Š

$n=5$ï¼Œæ•°åˆ—é•¿åº¦ä¸º $5$ï¼Œæ•°åˆ—ä»ç¬¬ä¸€é¡¹å¼€å§‹ä¾æ¬¡ä¸º$\{25957, 6405, 15770, 26287, 26465\}$ã€‚

- ç¬¬ä¸€æ¬¡æŸ¥è¯¢ä¸º $[2, 2]$ åŒºé—´å†…çš„ç¬¬ä¸€å°å€¼ï¼Œå³ä¸º $6405$ã€‚
- ç¬¬äºŒæ¬¡æŸ¥è¯¢ä¸º $[3, 4]$ åŒºé—´å†…çš„ç¬¬ä¸€å°å€¼ï¼Œå³ä¸º $15770$ã€‚
- ç¬¬ä¸‰æ¬¡æŸ¥è¯¢ä¸º $[4, 5]$ åŒºé—´å†…çš„ç¬¬ä¸€å°å€¼ï¼Œå³ä¸º $26287$ã€‚
- ç¬¬å››æ¬¡æŸ¥è¯¢ä¸º $[1, 2]$ åŒºé—´å†…çš„ç¬¬äºŒå°å€¼ï¼Œå³ä¸º $25957$ã€‚
- ç¬¬äº”æ¬¡æŸ¥è¯¢ä¸º $[4, 4]$ åŒºé—´å†…çš„ç¬¬ä¸€å°å€¼ï¼Œå³ä¸º $26287$ã€‚


### æ•°æ®è§„æ¨¡ä¸çº¦å®š

- å¯¹äº $20\%$ çš„æ•°æ®ï¼Œæ»¡è¶³ $1 \leq n,m \leq 10$ã€‚
- å¯¹äº $50\%$ çš„æ•°æ®ï¼Œæ»¡è¶³ $1 \leq n,m \leq 10^3$ã€‚
- å¯¹äº $80\%$ çš„æ•°æ®ï¼Œæ»¡è¶³ $1 \leq n,m \leq 10^5$ã€‚
- å¯¹äº $100\%$ çš„æ•°æ®ï¼Œæ»¡è¶³ $1 \leq n,m \leq 2\times 10^5$ï¼Œ$0\le a_i \leq 10^9$ï¼Œ$1 \leq l \leq r \leq n$ï¼Œ$1 \leq k \leq r - l + 1$ã€‚

## æ ·ä¾‹ #1

### è¾“å…¥

```
5 5
25957 6405 15770 26287 26465 
2 2 1
3 4 1
4 5 1
1 2 2
4 4 1
```

### è¾“å‡º

```
6405
15770
26287
25957
26287
```

# AIåˆ†æç»“æœ

---
# ğŸ’¡ æ´›è¯­äº‘ç¬ºçš„C++ç®—æ³•è§£æï¼šå¯æŒä¹…åŒ–çº¿æ®µæ ‘ 2ï¼ˆé™æ€åŒºé—´ç¬¬ k å°ï¼‰æ·±å…¥å­¦ä¹ æŒ‡å— ğŸ’¡

> ä»Šå¤©æˆ‘ä»¬æ¥ä¸€èµ·åˆ†æâ€œå¯æŒä¹…åŒ–çº¿æ®µæ ‘ 2ï¼ˆé™æ€åŒºé—´ç¬¬ k å°ï¼‰â€è¿™é“C++ç¼–ç¨‹é¢˜ã€‚è¿™ä¸ä»…ä»…æ˜¯ä¸€æ¬¡è§£é¢˜ï¼Œæ›´æ˜¯ä¸€åœºæ€ç»´çš„æ¢é™©ã€‚æˆ‘ä»¬å°†å­¦ä¹ å¦‚ä½•åƒä¾¦æ¢ä¸€æ ·ä»é¢˜ç›®ä¸­å¯»æ‰¾çº¿ç´¢ï¼Œå¹¶åœ¨ä¸åŒçš„è§£é¢˜é“è·¯ä¸­æƒè¡¡é€‰æ‹©ï¼Œæœ€ç»ˆæ‰¾åˆ°æœ€ä¼˜çš„ç­–ç•¥ã€‚

## 1. é¢˜ç›®è§£è¯»ä¸ç­–ç•¥åˆæ¢

âœ¨ **æœ¬é¢˜æ ¸å¿ƒæŒ‘æˆ˜**ï¼šåœ¨é™æ€æ•°ç»„ä¸Šé«˜æ•ˆå›ç­”å¤§é‡â€œåŒºé—´ç¬¬kå°â€æŸ¥è¯¢ï¼Œä¸”æ•°æ®è§„æ¨¡å¤§ï¼ˆn,mâ‰¤2Ã—10^5ï¼‰ï¼Œè¦æ±‚ä½¿ç”¨å¯æŒä¹…åŒ–æ•°æ®ç»“æ„ã€‚

âœ¨ **æ ¸å¿ƒç®—æ³•æ ‡ç­¾**ï¼šå¯æŒä¹…åŒ–çº¿æ®µæ ‘ï¼ˆä¸»å¸­æ ‘ï¼‰ã€æƒå€¼çº¿æ®µæ ‘ã€ç¦»æ•£åŒ–ã€å‰ç¼€å’Œæ€æƒ³ã€‚

ğŸ—£ï¸ **åˆæ­¥åˆ†æ**ï¼š
> è¿™é“é¢˜è¦æ±‚æˆ‘ä»¬å¤„ç†ä¸€ä¸ªé™æ€æ•°ç»„ï¼Œå¹¶å›ç­”å¤šä¸ªæŸ¥è¯¢ï¼Œæ¯ä¸ªæŸ¥è¯¢è¦æ±‚æ‰¾å‡ºæŸä¸ªåŒºé—´å†…ç¬¬kå°çš„æ•°ã€‚æœ€ç›´è§‚çš„æš´åŠ›æ–¹æ³•æ˜¯æ¯æ¬¡æŸ¥è¯¢éƒ½å¯¹åŒºé—´è¿›è¡Œæ’åºï¼Œä½†æ—¶é—´å¤æ‚åº¦ä¸ºO(m * n log n)ï¼Œæ˜¾ç„¶æ— æ³•é€šè¿‡å¤§æ•°æ®é‡çš„æµ‹è¯•ã€‚æˆ‘ä»¬éœ€è¦ä¸€ç§æ›´é«˜æ•ˆçš„æ•°æ®ç»“æ„æ¥é¢„å¤„ç†æ•°æ®ï¼Œä½¿å¾—æ¯æ¬¡æŸ¥è¯¢å¯ä»¥åœ¨å¯¹æ•°æ—¶é—´å†…å®Œæˆã€‚è¿™é‡Œï¼Œ**å¯æŒä¹…åŒ–çº¿æ®µæ ‘ï¼ˆä¸»å¸­æ ‘ï¼‰**åº”è¿è€Œç”Ÿï¼Œå®ƒå·§å¦™åœ°åˆ©ç”¨äº†çº¿æ®µæ ‘çš„åŒºé—´ç»Ÿè®¡èƒ½åŠ›å’Œå¯æŒä¹…åŒ–æŠ€æœ¯ï¼Œå°†é—®é¢˜è½¬åŒ–ä¸ºå‰ç¼€å’Œå½¢å¼ï¼Œä»è€Œé«˜æ•ˆè§£å†³ã€‚

### ğŸ” ç®—æ³•ä¾¦æ¢ï¼šå¦‚ä½•åœ¨é¢˜ç›®ä¸­å‘ç°çº¿ç´¢ï¼Ÿ
1.  **çº¿ç´¢1 (é—®é¢˜ç›®æ ‡)**: "é¢˜ç›®è¦æ±‚æˆ‘ä»¬åœ¨é™æ€æ•°ç»„ä¸Šå›ç­”å¤šä¸ªæŸ¥è¯¢ï¼Œæ¯ä¸ªæŸ¥è¯¢è¦æ±‚æ‰¾åˆ°åŒºé—´[l,r]å†…ç¬¬kå°çš„æ•°ã€‚è¿™ç§ã€åŒºé—´ç»Ÿè®¡ç±»ã€‘é—®é¢˜ï¼Œé€šå¸¸æç¤ºæˆ‘ä»¬éœ€è¦ä½¿ç”¨çº¿æ®µæ ‘æˆ–ç±»ä¼¼ç»“æ„ã€‚"
2.  **çº¿ç´¢2 (é—®é¢˜çº¦æŸ/ç‰¹æ€§)**: "æ•°æ®èŒƒå›´n,mâ‰¤2Ã—10^5ï¼Œä¸”æ•°ç»„é™æ€ï¼ˆæ— ä¿®æ”¹ï¼‰ã€‚è¿™æ’é™¤äº†éœ€è¦é¢‘ç¹æ›´æ–°çš„æ•°æ®ç»“æ„ï¼ŒæŒ‡å‘äº†**å¯æŒä¹…åŒ–**æˆ–**ç¦»çº¿å¤„ç†**çš„æ€è·¯ã€‚"
3.  **çº¿ç´¢3 (æ•°æ®è§„æ¨¡)**: "n,må‡ä¸º2Ã—10^5ï¼ŒO(n log n)çš„é¢„å¤„ç†å’ŒO(log n)çš„æŸ¥è¯¢æ˜¯å¯ä»¥æ¥å—çš„ï¼Œè¿™è¿›ä¸€æ­¥éªŒè¯äº†ä¸»å¸­æ ‘çš„å¯è¡Œæ€§ã€‚"

### ğŸ§  æ€ç»´é“¾æ„å»ºï¼šä»çº¿ç´¢åˆ°ç­–ç•¥
> å¥½äº†ï¼Œä¾¦æ¢å·¥ä½œå®Œæˆï¼Œæˆ‘ä»¬æ”¶é›†åˆ°äº†å‡ æ¡å…³é”®çº¿ç´¢ã€‚ç°åœ¨ï¼Œè®©æˆ‘ä»¬åƒæ‹¼å›¾ä¸€æ ·æŠŠå®ƒä»¬ç»„åˆèµ·æ¥ï¼š
> 1.  é¦–å…ˆï¼Œã€çº¿ç´¢1ï¼šé—®é¢˜ç›®æ ‡ã€‘å‘Šè¯‰æˆ‘ä»¬è¿™æ˜¯ä¸€ä¸ªâ€œåŒºé—´ç»Ÿè®¡â€é—®é¢˜ï¼Œæˆ‘çš„å¤§è„‘é‡Œç«‹åˆ»é—ªè¿‡äº†â€œçº¿æ®µæ ‘â€ã€â€œæ ‘çŠ¶æ•°ç»„â€ã€â€œåˆ†å—â€ç­‰å€™é€‰æ–¹æ¡ˆã€‚
> 2.  æ¥ç€ï¼Œã€çº¿ç´¢2ï¼šé—®é¢˜ç‰¹æ€§ã€‘ï¼Œæ¯”å¦‚â€œé™æ€æ•°ç»„â€å’Œâ€œç¬¬kå°â€ï¼Œç»™äº†æˆ‘ä¸€ä¸ªå†³å®šæ€§çš„æç¤ºã€‚ç®€å•çš„æ’åºæˆ–æš´åŠ›æšä¸¾æ— æ³•å¤„ç†å¤§è§„æ¨¡æ•°æ®ï¼Œè€Œçº¿æ®µæ ‘çš„åŒºé—´ç»Ÿè®¡èƒ½åŠ›éå¸¸é€‚åˆã€‚
> 3.  æœ€åï¼Œã€çº¿ç´¢3ï¼šæ•°æ®è§„æ¨¡ã€‘ç»™äº†æˆ‘ä»¬æœ€ç»ˆåˆ¤å†³ã€‚n=2Ã—10^5ï¼ŒO(n log n)çš„é¢„å¤„ç†å’ŒO(log n)çš„æŸ¥è¯¢æ˜¯å®Œå…¨å¯ä»¥æ¥å—çš„ã€‚
> 4.  **ç»“è®º**ï¼šç»¼åˆä»¥ä¸Šï¼Œä¸€ä¸ªèƒ½å¤Ÿå¤„ç†â€œåŒºé—´ç»Ÿè®¡â€å¹¶æ”¯æŒâ€œé«˜æ•ˆæŸ¥è¯¢â€çš„ç®—æ³•ï¼Œå°±æ˜¯æˆ‘ä»¬çš„ç›®æ ‡ã€‚**å¯æŒä¹…åŒ–çº¿æ®µæ ‘ï¼ˆä¸»å¸­æ ‘ï¼‰**ï¼Œç‰¹åˆ«æ˜¯åˆ©ç”¨**æƒå€¼çº¿æ®µæ ‘**å’Œ**å‰ç¼€å’Œæ€æƒ³**çš„ç‰ˆæœ¬ï¼Œå®Œç¾ç¬¦åˆæ‰€æœ‰æ¡ä»¶ã€‚è¿™å°±æ˜¯æˆ‘ä»¬æ¥ä¸‹æ¥è¦æ·±å…¥ç ”ç©¶çš„ä¸»æ”»æ–¹å‘ï¼

---

## 2. ç²¾é€‰ä¼˜è´¨é¢˜è§£å‚è€ƒ

> ä¸ºäº†æ›´å¥½åœ°ç†è§£è§£é¢˜è¿‡ç¨‹ï¼Œæˆ‘ä»æ€è·¯æ¸…æ™°åº¦ã€ä»£ç å¯è¯»æ€§ã€ç®—æ³•æœ‰æ•ˆæ€§ä¸ä¼˜åŒ–ç¨‹åº¦ã€å®è·µä»·å€¼ç­‰å‡ ä¸ªæ–¹é¢ï¼Œä¸ºå¤§å®¶ç­›é€‰äº†ä»¥ä¸‹è¯„åˆ†è¾ƒé«˜ï¼ˆâ‰¥4æ˜Ÿï¼‰çš„é¢˜è§£ã€‚è‹¥æ‰€æœ‰é¢˜è§£å‡ä¸è¶³4æ˜Ÿï¼Œæˆ‘ä¹Ÿä¼šç»™å‡ºä¸€äº›é€šç”¨çš„å­¦ä¹ å»ºè®®ã€‚

### é¢˜è§£ä¸€ï¼šfy0123ï¼ˆèµï¼š484ï¼‰
* **ç‚¹è¯„**ï¼šè¿™ä»½é¢˜è§£æ˜¯ç»å…¸çš„ä¸»å¸­æ ‘æ¨¡æ¿å®ç°ï¼Œæ€è·¯æ¸…æ™°ï¼Œä»£ç ç®€æ´ã€‚ä½œè€…é€šè¿‡**ç¦»æ•£åŒ–**å’Œ**æƒå€¼çº¿æ®µæ ‘**çš„ç»“åˆï¼Œå·§å¦™åœ°è§£å†³äº†å¤§æ•°æ®èŒƒå›´çš„é—®é¢˜ã€‚ä»£ç ä¸­çš„`build`ã€`update`å’Œ`query`å‡½æ•°åˆ†å·¥æ˜ç¡®ï¼Œæ˜“äºç†è§£ã€‚ç‰¹åˆ«æ˜¯`query`å‡½æ•°ä¸­åˆ©ç”¨å‰ç¼€å’Œç›¸å‡çš„æ€æƒ³ï¼Œå°†åŒºé—´é—®é¢˜è½¬åŒ–ä¸ºä¸¤ä¸ªç‰ˆæœ¬çº¿æ®µæ ‘çš„å·®å€¼æŸ¥è¯¢ï¼Œéå¸¸ç›´è§‚ã€‚

### é¢˜è§£äºŒï¼šLpy_Nowï¼ˆèµï¼š409ï¼‰
* **ç‚¹è¯„**ï¼šè¿™ä»½é¢˜è§£å›¾æ–‡å¹¶èŒ‚ï¼Œè¯¦ç»†è§£é‡Šäº†ä¸»å¸­æ ‘çš„æ„å»ºå’ŒæŸ¥è¯¢è¿‡ç¨‹ã€‚ä½œè€…é€šè¿‡å¤§é‡å›¾ç‰‡å’Œå®ä¾‹ï¼Œå¸®åŠ©è¯»è€…ç†è§£â€œå¯æŒä¹…åŒ–â€å’Œâ€œå‰ç¼€å’Œâ€è¿™ä¸¤ä¸ªæ ¸å¿ƒæ¦‚å¿µã€‚ä»£ç ä¸­çš„æ³¨é‡Šè¯¦å°½ï¼Œé€‚åˆåˆå­¦è€…é€æ­¥å­¦ä¹ ã€‚æ­¤å¤–ï¼Œä½œè€…è¿˜æåˆ°äº†åŠ¨æ€ä¸»å¸­æ ‘ï¼ˆå¸¦ä¿®æ”¹ï¼‰çš„æ‰©å±•æ€è·¯ï¼Œä¸ºåç»­å­¦ä¹ æä¾›äº†æ–¹å‘ã€‚

### é¢˜è§£ä¸‰ï¼šEuler_Pursuerï¼ˆèµï¼š362ï¼‰
* **ç‚¹è¯„**ï¼šè¿™ä»½é¢˜è§£ä»æš´åŠ›æ–¹æ³•å‡ºå‘ï¼Œé€æ­¥å¼•å¯¼åˆ°ä¸»å¸­æ ‘çš„ä¼˜åŒ–æ€è·¯ï¼Œé€»è¾‘ä¸¥è°¨ã€‚ä½œè€…é€šè¿‡å¯¹æ¯”ä¸åŒæ–¹æ³•çš„å¤æ‚åº¦ï¼Œçªå‡ºäº†ä¸»å¸­æ ‘çš„ä¼˜åŠ¿ã€‚ä»£ç å®ç°è§„èŒƒï¼Œå˜é‡å‘½åæ¸…æ™°ï¼Œç‰¹åˆ«æ˜¯`modify`å’Œ`query`å‡½æ•°çš„é€’å½’è®¾è®¡ï¼Œä½“ç°äº†è‰¯å¥½çš„ç¼–ç¨‹ä¹ æƒ¯ã€‚

### é¢˜è§£å››ï¼šä¸€æ‰¶è‹ä¸€ï¼ˆèµï¼š131ï¼‰
* **ç‚¹è¯„**ï¼šè¿™ä»½é¢˜è§£å¦è¾Ÿè¹Šå¾„ï¼Œä½¿ç”¨**è«é˜Ÿç®—æ³•**ç»“åˆ**åˆ†å—**è§£å†³äº†é—®é¢˜ã€‚è™½ç„¶å¤æ‚åº¦ä¸ºO(n sqrt(n))ï¼Œä½†åœ¨å®é™…è¿è¡Œä¸­è¡¨ç°ä¼˜å¼‚ï¼Œç”šè‡³è·‘åˆ°äº†æœ€ä¼˜è§£çš„ç¬¬äºŒé¡µã€‚ä½œè€…è¯¦ç»†åˆ†æäº†è«é˜Ÿçš„æ’åºç­–ç•¥å’Œåˆ†å—çš„å®ç°ç»†èŠ‚ï¼Œå±•ç¤ºäº†æš´åŠ›ç®—æ³•åœ¨ç‰¹å®šåœºæ™¯ä¸‹çš„æ½œåŠ›ã€‚

### é¢˜è§£äº”ï¼šæ—‹è½¬å¡å£³ï¼ˆèµï¼š124ï¼‰
* **ç‚¹è¯„**ï¼šè¿™ä»½é¢˜è§£é¢å‘åˆå­¦è€…ï¼Œé€šè¿‡å¤§é‡å›¾ç‰‡å’Œé€æ­¥æ¼”ç¤ºï¼Œæ·±å…¥æµ…å‡ºåœ°è®²è§£äº†ä¸»å¸­æ ‘çš„åŸç†ã€‚ä»£ç ä¸­çš„æ³¨é‡Šéå¸¸è¯¦ç»†ï¼Œå‡ ä¹æ¯ä¸€è¡Œéƒ½æœ‰è§£é‡Šï¼Œé€‚åˆå®Œå…¨æ²¡æ¥è§¦è¿‡ä¸»å¸­æ ‘çš„åŒå­¦ã€‚ä½œè€…è¿˜ç‰¹åˆ«å¼ºè°ƒäº†ç¦»æ•£åŒ–çš„é‡è¦æ€§ï¼Œå¹¶ç»™å‡ºäº†å®Œæ•´çš„å®ç°ã€‚

---

## 3. è§£é¢˜ç­–ç•¥æ·±åº¦å‰–æ

### ğŸ¯ æ ¸å¿ƒéš¾ç‚¹ä¸å…³é”®æ­¥éª¤ï¼ˆæœ€ä¼˜è§£æ³•å‰–æï¼‰

#### å…³é”®ç‚¹1ï¼šç¦»æ•£åŒ–ï¼ˆå¤„ç†å¤§æ•°æ®èŒƒå›´ï¼‰
* **åˆ†æ**ï¼šç”±äºa_içš„èŒƒå›´æ˜¯[-1e9, 1e9]ï¼Œç›´æ¥ä½œä¸ºçº¿æ®µæ ‘çš„å€¼åŸŸä¼šå¯¼è‡´å†…å­˜çˆ†ç‚¸ã€‚é€šè¿‡**ç¦»æ•£åŒ–**ï¼Œæˆ‘ä»¬å°†æ‰€æœ‰ä¸åŒçš„æ•°å€¼æ˜ å°„åˆ°ä¸€ä¸ªè¿ç»­çš„æ•´æ•°åŒºé—´[1, m]ï¼Œå…¶ä¸­mæ˜¯ä¸åŒæ•°å€¼çš„ä¸ªæ•°ã€‚è¿™æ ·ï¼Œçº¿æ®µæ ‘çš„å€¼åŸŸå°±ç¼©å°åˆ°äº†O(n)ã€‚
* ğŸ’¡ **å­¦ä¹ ç¬”è®°**ï¼šç¦»æ•£åŒ–æ˜¯è§£å†³å¤§æ•°æ®èŒƒå›´é—®é¢˜çš„å¸¸ç”¨æŠ€å·§ï¼Œé€šè¿‡æ’åºå’Œå»é‡ï¼Œå°†æ— é™å€¼åŸŸæ˜ å°„åˆ°æœ‰é™åŒºé—´ã€‚

#### å…³é”®ç‚¹2ï¼šæƒå€¼çº¿æ®µæ ‘çš„æ„å»º
* **åˆ†æ**ï¼šæƒå€¼çº¿æ®µæ ‘çš„æ¯ä¸ªèŠ‚ç‚¹ç»´æŠ¤çš„æ˜¯**å€¼åŸŸåŒºé—´**å†…çš„æ•°çš„å‡ºç°æ¬¡æ•°ã€‚ä¾‹å¦‚ï¼Œæ ¹èŠ‚ç‚¹ç»´æŠ¤[1, m]å†…çš„æ•°çš„æ€»ä¸ªæ•°ã€‚é€šè¿‡è¿™ç§æ–¹å¼ï¼Œæˆ‘ä»¬å¯ä»¥é«˜æ•ˆåœ°ç»Ÿè®¡ä»»æ„å€¼åŸŸåŒºé—´å†…çš„æ•°çš„æ•°é‡ã€‚
* ğŸ’¡ **å­¦ä¹ ç¬”è®°**ï¼šæƒå€¼çº¿æ®µæ ‘çš„æ ¸å¿ƒåœ¨äºâ€œå€¼åŸŸâ€è€Œéâ€œä¸‹æ ‡â€ï¼Œå®ƒå¤©ç„¶é€‚åˆè§£å†³æ’åç±»é—®é¢˜ã€‚

#### å…³é”®ç‚¹3ï¼šå¯æŒä¹…åŒ–æŠ€æœ¯ï¼ˆä¸»å¸­æ ‘ï¼‰
* **åˆ†æ**ï¼šä¸ºäº†é«˜æ•ˆå›ç­”ä»»æ„åŒºé—´çš„æŸ¥è¯¢ï¼Œæˆ‘ä»¬ä¸ºæ¯ä¸ªå‰ç¼€[1..i]æ„å»ºä¸€æ£µæƒå€¼çº¿æ®µæ ‘ã€‚ä½†ç›´æ¥æ„å»ºnæ£µæ ‘çš„æ—¶ç©ºå¤æ‚åº¦ä¸ºO(nÂ² log n)ï¼Œæ— æ³•æ¥å—ã€‚ä¸»å¸­æ ‘é€šè¿‡**å…±äº«æœªä¿®æ”¹çš„èŠ‚ç‚¹**ï¼Œæ¯æ¬¡åªæ–°å»ºO(log n)ä¸ªèŠ‚ç‚¹ï¼Œå°†æ€»ç©ºé—´ä¼˜åŒ–åˆ°O(n log n)ã€‚
* ğŸ’¡ **å­¦ä¹ ç¬”è®°**ï¼šå¯æŒä¹…åŒ–çš„æœ¬è´¨æ˜¯â€œæ—¶é—´æ¢ç©ºé—´â€ï¼Œé€šè¿‡è®°å½•å†å²ç‰ˆæœ¬çš„çŠ¶æ€ï¼Œé¿å…é‡å¤è®¡ç®—ã€‚

#### å…³é”®ç‚¹4ï¼šå‰ç¼€å’ŒæŸ¥è¯¢
* **åˆ†æ**ï¼šæŸ¥è¯¢åŒºé—´[l, r]çš„ç¬¬kå°æ•°ï¼Œç­‰ä»·äºåœ¨**ç¬¬ræ£µæ ‘**å’Œ**ç¬¬l-1æ£µæ ‘**çš„å·®å€¼çº¿æ®µæ ‘ä¸ŠæŸ¥æ‰¾ç¬¬kå°ã€‚å…·ä½“æ¥è¯´ï¼Œæˆ‘ä»¬åŒæ—¶éå†ä¸¤æ£µæ ‘ï¼Œåˆ©ç”¨èŠ‚ç‚¹å€¼çš„å·®å€¼æ¥æŒ‡å¯¼æœç´¢æ–¹å‘ã€‚
* ğŸ’¡ **å­¦ä¹ ç¬”è®°**ï¼šå‰ç¼€å’Œæ€æƒ³ä¸ä»…é€‚ç”¨äºæ•°ç»„ï¼Œä¹Ÿé€‚ç”¨äºæ ‘ç»“æ„ã€‚é€šè¿‡â€œç›¸å‡â€æ“ä½œï¼Œå°†åŒºé—´é—®é¢˜è½¬åŒ–ä¸ºå…¨å±€é—®é¢˜ã€‚

### âš”ï¸ ç­–ç•¥ç«æŠ€åœºï¼šä¸åŒè§£æ³•çš„å¯¹æ¯”åˆ†æ

| ç­–ç•¥ | æ ¸å¿ƒæ€æƒ³ | ä¼˜ç‚¹ | ç¼ºç‚¹ä¸åˆ†æ | é€‚ç”¨åœºæ™¯ / å¾—åˆ†é¢„æœŸ |
| :--- | :--- | :--- | :--- |:--- |
| **æš´åŠ›æ’åº** | æ¯æ¬¡æŸ¥è¯¢å¯¹åŒºé—´æ’åºåç›´æ¥å–ç¬¬kå° | æ€è·¯ç®€å•ï¼Œæ˜“äºç†è§£ | **æ—¶é—´å¤æ‚åº¦**: O(m * n log n)ï¼Œå®Œå…¨ä¸å¯è¡Œ | æ•°æ®è§„æ¨¡ n â‰¤ 1000ï¼Œä»…ç”¨äºéªŒè¯æ­£ç¡®æ€§ |
| **ä¸»å¸­æ ‘ï¼ˆå¯æŒä¹…åŒ–çº¿æ®µæ ‘ï¼‰** | åˆ©ç”¨æƒå€¼çº¿æ®µæ ‘å’Œå‰ç¼€å’Œæ€æƒ³ï¼Œæ¯æ¬¡æŸ¥è¯¢O(log n) | æ—¶ç©ºå¤æ‚åº¦æœ€ä¼˜ï¼ŒO(n log n)é¢„å¤„ç†ï¼ŒO(log n)æŸ¥è¯¢ | å®ç°å¤æ‚ï¼Œéœ€è¦ç¦»æ•£åŒ–å’ŒåŠ¨æ€å¼€ç‚¹ | æœ¬é¢˜çš„æœ€ä½³å®è·µï¼Œå¯å¾—100%åˆ†æ•° |
| **è«é˜Ÿ+åˆ†å—** | ç¦»çº¿å¤„ç†æŸ¥è¯¢ï¼Œåˆ©ç”¨åˆ†å—ç»Ÿè®¡åŒºé—´ä¿¡æ¯ | å®ç°ç®€å•ï¼Œå¸¸æ•°è¾ƒå° | **æ—¶é—´å¤æ‚åº¦**: O(n sqrt(n))ï¼Œç†è®ºä¸å¦‚ä¸»å¸­æ ‘ | æ•°æ®è§„æ¨¡ n â‰¤ 1e5ï¼Œæˆ–ä½œä¸ºä¸»å¸­æ ‘çš„æ›¿ä»£æ–¹æ¡ˆ |
| **åˆ’åˆ†æ ‘** | åŸºäºå¿«é€Ÿæ’åºçš„åˆ†æ²»ç»“æ„ | æŸ¥è¯¢O(log n)ï¼Œå®ç°ç›´è§‚ | ç©ºé—´å¤æ‚åº¦è¾ƒé«˜ï¼Œä¸”ä¸ºç¦»çº¿ç®—æ³• | é€‚åˆé™æ€åŒºé—´ç¬¬kå¤§é—®é¢˜ï¼Œæœ¬é¢˜å¯å¾—100%åˆ†æ•° |
| **æ•´ä½“äºŒåˆ†** | å°†æ‰€æœ‰æŸ¥è¯¢å’Œæ•°å€¼ä¸€èµ·äºŒåˆ†å¤„ç† | ç¦»çº¿ç®—æ³•ï¼Œç†è®ºå¤æ‚åº¦O(n logÂ² n) | å®ç°å¤æ‚ï¼Œéœ€è¦é…åˆæ ‘çŠ¶æ•°ç»„ | é€‚åˆç¦»çº¿å¤„ç†ï¼Œæœ¬é¢˜å¯å¾—100%åˆ†æ•° |

### âœ¨ ä¼˜åŒ–ä¹‹æ—…ï¼šä»â€œèƒ½åšâ€åˆ°â€œåšå¥½â€

> ä»æš´åŠ›æ’åºåˆ°ä¸»å¸­æ ‘ï¼Œæˆ‘ä»¬ç»å†äº†ä»¥ä¸‹ä¼˜åŒ–è¿‡ç¨‹ï¼š
> 1. **æš´åŠ›æ’åº**ï¼šç›´æ¥æ’åºï¼Œæ—¶é—´çˆ†ç‚¸ã€‚
> 2. **æƒå€¼çº¿æ®µæ ‘**ï¼šå•æ£µçº¿æ®µæ ‘ç»´æŠ¤å…¨å±€ä¿¡æ¯ï¼Œä½†æ— æ³•å¤„ç†åŒºé—´ã€‚
> 3. **å‰ç¼€å’Œçº¿æ®µæ ‘**ï¼šä¸ºæ¯ä¸ªå‰ç¼€å»ºçº¿æ®µæ ‘ï¼Œç©ºé—´çˆ†ç‚¸ã€‚
> 4. **ä¸»å¸­æ ‘**ï¼šå¯æŒä¹…åŒ–æŠ€æœ¯å…±äº«èŠ‚ç‚¹ï¼Œæ—¶ç©ºä¼˜åŒ–åˆ°O(n log n)ã€‚

ğŸ’¡ **ç­–ç•¥æ€»ç»“**ï¼šå¥½çš„ç®—æ³•å¾€å¾€æºäºå¯¹é—®é¢˜ç»“æ„çš„æ·±åˆ»æ´å¯Ÿã€‚ä¸»å¸­æ ‘é€šè¿‡â€œç¦»æ•£åŒ–+æƒå€¼çº¿æ®µæ ‘+å¯æŒä¹…åŒ–â€çš„ä¸‰é‡ä¼˜åŒ–ï¼Œå°†çœ‹ä¼¼ä¸å¯èƒ½çš„é—®é¢˜ä¼˜é›…è§£å†³ã€‚

---

## 4. C++æ ¸å¿ƒä»£ç å®ç°èµæ

### æœ¬é¢˜é€šç”¨æ ¸å¿ƒC++å®ç°å‚è€ƒ

```cpp
#include <cstdio>
#include <algorithm>
using namespace std;

const int MAXN = 200010;
int n, m, a[MAXN], b[MAXN], cnt, root[MAXN];
struct Node { int l, r, sum; } t[MAXN * 20];

int build(int l, int r) {
    int rt = ++cnt;
    if (l < r) {
        int mid = (l + r) >> 1;
        t[rt].l = build(l, mid);
        t[rt].r = build(mid + 1, r);
    }
    return rt;
}

int update(int pre, int l, int r, int x) {
    int rt = ++cnt;
    t[rt] = t[pre]; t[rt].sum++;
    if (l < r) {
        int mid = (l + r) >> 1;
        if (x <= mid) t[rt].l = update(t[pre].l, l, mid, x);
        else t[rt].r = update(t[pre].r, mid + 1, r, x);
    }
    return rt;
}

int query(int u, int v, int l, int r, int k) {
    if (l == r) return l;
    int mid = (l + r) >> 1;
    int x = t[t[v].l].sum - t[t[u].l].sum;
    return k <= x ? query(t[u].l, t[v].l, l, mid, k) : query(t[u].r, t[v].r, mid + 1, r, k - x);
}

int main() {
    scanf("%d%d", &n, &m);
    for (int i = 1; i <= n; ++i) scanf("%d", &a[i]), b[i] = a[i];
    sort(b + 1, b + n + 1);
    int m = unique(b + 1, b + n + 1) - b - 1;
    root[0] = build(1, m);
    for (int i = 1; i <= n; ++i) {
        int x = lower_bound(b + 1, b + m + 1, a[i]) - b;
        root[i] = update(root[i - 1], 1, m, x);
    }
    while (m--) {
        int l, r, k; scanf("%d%d%d", &l, &r, &k);
        printf("%d\n", b[query(root[l - 1], root[r], 1, m, k)]);
    }
    return 0;
}
```

### é’ˆå¯¹å„ä¼˜è´¨é¢˜è§£çš„ç‰‡æ®µèµæ

#### 1. fy0123 çš„ç¦»æ•£åŒ–ä¸ä¸»å¸­æ ‘æ„å»º
```cpp
sort(b+1, b+1+n);
m = unique(b+1, b+1+n) - b - 1;
T[0] = build(1, m);
for (int i = 1; i <= n; ++i) {
    int t = lower_bound(b+1, b+1+m, a[i]) - b;
    T[i] = update(T[i-1], 1, m, t);
}
```
* **ä»£ç è§£è¯»**ï¼šè¿™æ®µä»£ç å±•ç¤ºäº†å¦‚ä½•å°†åŸå§‹æ•°ç»„ç¦»æ•£åŒ–ï¼Œå¹¶åˆ©ç”¨ä¸»å¸­æ ‘é€æ­¥æ„å»ºå‰ç¼€ç‰ˆæœ¬ã€‚é€šè¿‡`lower_bound`å®ç°O(log n)çš„ç¦»æ•£åŒ–æ˜ å°„ï¼Œä¿è¯äº†é«˜æ•ˆæ€§ã€‚

#### 2. Lpy_Now çš„æŸ¥è¯¢é€»è¾‘
```cpp
int query(int u, int v, int l, int r, int k) {
    if (l >= r) return l;
    int x = sum[L[v]] - sum[L[u]];
    if (x >= k) return query(L[u], L[v], l, mid, k);
    else return query(R[u], R[v], mid+1, r, k-x);
}
```
* **ä»£ç è§£è¯»**ï¼šè¿™æ®µä»£ç æ˜¯ä¸»å¸­æ ‘æŸ¥è¯¢çš„æ ¸å¿ƒã€‚é€šè¿‡æ¯”è¾ƒä¸¤æ£µæ ‘çš„å·¦å­æ ‘å·®å€¼`x`ä¸`k`ï¼Œå†³å®šé€’å½’æ–¹å‘ï¼Œä½“ç°äº†æƒå€¼çº¿æ®µæ ‘çš„äºŒåˆ†æ€§è´¨ã€‚

---

## 5. ç®—æ³•å¯è§†åŒ–ï¼šåƒç´ åŠ¨ç”»æ¼”ç¤º

### åŠ¨ç”»æ¼”ç¤ºä¸»é¢˜ï¼šåƒç´ æ¢é™©å®¶çš„ä¸»å¸­æ ‘ä¹‹æ—…

#### è®¾è®¡æ€è·¯
- **åƒç´ é£æ ¼**ï¼šé‡‡ç”¨8ä½åƒç´ é£æ ¼ï¼Œæ¨¡æ‹ŸFCæ¸¸æˆç•Œé¢ã€‚
- **æ ¸å¿ƒæ¼”ç¤º**ï¼šå±•ç¤ºä¸»å¸­æ ‘çš„æ„å»ºå’ŒæŸ¥è¯¢è¿‡ç¨‹ã€‚
- **äº¤äº’è®¾è®¡**ï¼šæ”¯æŒå•æ­¥æ‰§è¡Œã€è‡ªåŠ¨æ’­æ”¾ã€é€Ÿåº¦è°ƒèŠ‚ã€‚

#### åŠ¨ç”»æ­¥éª¤
1. **ç¦»æ•£åŒ–**ï¼šå°†åŸå§‹æ•°æ®æ˜ å°„åˆ°åƒç´ åŒ–çš„å€¼åŸŸåŒºé—´ã€‚
2. **å»ºæ ‘**ï¼šåŠ¨æ€å±•ç¤ºç©ºæ ‘çš„æ„å»ºå’ŒèŠ‚ç‚¹çš„å…±äº«ã€‚
3. **æ’å…¥**ï¼šæ¯æ¬¡æ’å…¥æ–°å€¼æ—¶ï¼Œé«˜äº®æ˜¾ç¤ºæ–°å»ºçš„O(log n)ä¸ªèŠ‚ç‚¹ã€‚
4. **æŸ¥è¯¢**ï¼šåŒæ­¥éå†ä¸¤æ£µæ ‘ï¼Œç”¨åƒç´ ç®­å¤´æŒ‡ç¤ºæœç´¢è·¯å¾„ã€‚

#### æŠ€æœ¯å®ç°
- **Canvas API**ï¼šç»˜åˆ¶åƒç´ åŒ–çš„çº¿æ®µæ ‘èŠ‚ç‚¹ã€‚
- **éŸ³æ•ˆ**ï¼šå…³é”®æ“ä½œæ’­æ”¾8ä½éŸ³æ•ˆï¼Œå¢å¼ºè¶£å‘³æ€§ã€‚
- **æ§åˆ¶é¢æ¿**ï¼šæä¾›å¼€å§‹ã€æš‚åœã€é‡ç½®æŒ‰é’®ã€‚

---

## 6. æ‹“å±•ç»ƒä¹ ä¸ç›¸ä¼¼é—®é¢˜æ€è€ƒ

### é€šç”¨æ€è·¯è¿ç§»
ä¸»å¸­æ ‘çš„æ ¸å¿ƒæ€æƒ³ï¼ˆç¦»æ•£åŒ–+æƒå€¼çº¿æ®µæ ‘+å‰ç¼€å’Œï¼‰é€‚ç”¨äºï¼š
1. **åŒºé—´ç¬¬kå¤§/å°**ï¼šå¦‚P3380 äºŒé€¼å¹³è¡¡æ ‘ï¼ˆå¸¦ä¿®æ”¹ï¼‰ã€‚
2. **åŒºé—´æ’åæŸ¥è¯¢**ï¼šå¦‚P2617 Dynamic Rankingsã€‚
3. **æ ‘ä¸Šè·¯å¾„ç¬¬kå°**ï¼šå¦‚P2633 Count on a treeã€‚

### æ´›è°·æ¨èç»ƒä¹ 
1. **P3834**ï¼ˆæœ¬é¢˜ï¼‰ï¼šæŒæ¡ä¸»å¸­æ ‘æ¨¡æ¿ã€‚
2. **P2617**ï¼šåŠ¨æ€åŒºé—´ç¬¬kå°ï¼Œéœ€ç»“åˆæ ‘çŠ¶æ•°ç»„ã€‚
3. **P3380**ï¼šå¸¦ä¿®æ”¹çš„åŒºé—´ç¬¬kå°ï¼Œè€ƒå¯ŸåŠ¨æ€ä¸»å¸­æ ‘ã€‚
4. **P2633**ï¼šæ ‘ä¸Šè·¯å¾„ç¬¬kå°ï¼Œéœ€ç»“åˆLCAã€‚

---

## 7. å­¦ä¹ å¿ƒå¾—ä¸ç»éªŒåˆ†äº«

> **ç»éªŒåˆ†äº«ï¼ˆæ¥è‡ªæ—‹è½¬å¡å£³ï¼‰**ï¼š
> "æˆ‘åœ¨å­¦ä¹ ä¸»å¸­æ ‘æ—¶ï¼Œæœ€åˆè¢«â€˜å¯æŒä¹…åŒ–â€™çš„æ¦‚å¿µå›°æ‰°äº†å¾ˆä¹…ã€‚åæ¥é€šè¿‡ç”»å›¾æ¨¡æ‹Ÿä¸¤æ£µæ ‘çš„å·®å€¼æŸ¥è¯¢ï¼Œæ‰è±ç„¶å¼€æœ—ã€‚å»ºè®®å¤§å®¶åŠ¨æ‰‹ç”»çº¿æ®µæ ‘çš„èŠ‚ç‚¹å˜åŒ–ï¼Œæ¯”å•çº¯çœ‹ä»£ç ç†è§£æ›´å¿«ã€‚"

> **æ´›è¯­äº‘ç¬ºç‚¹è¯„**ï¼šåŠ¨æ‰‹æ¨¡æ‹Ÿæ˜¯ç†è§£å¤æ‚æ•°æ®ç»“æ„çš„æ·å¾„ã€‚é€šè¿‡å¯è§†åŒ–æˆ–çº¸ç¬”æ¨æ¼”ï¼Œèƒ½ç›´è§‚æ„Ÿå—â€œå…±äº«èŠ‚ç‚¹â€å’Œâ€œå·®å€¼æŸ¥è¯¢â€çš„ç²¾å¦™ä¹‹å¤„ã€‚

---

<conclusion>
é€šè¿‡æœ¬æ¬¡å¯¹â€œå¯æŒä¹…åŒ–çº¿æ®µæ ‘ 2â€çš„æ·±åº¦å‰–æï¼Œæˆ‘ä»¬ä¸ä»…æŒæ¡äº†ä¸»å¸­æ ‘çš„æ ¸å¿ƒå®ç°ï¼Œæ›´ç†è§£äº†å¦‚ä½•ä»æš´åŠ›ç®—æ³•é€æ­¥ä¼˜åŒ–åˆ°é«˜æ•ˆè§£æ³•çš„æ€ç»´è¿‡ç¨‹ã€‚è®°ä½ï¼Œä¼˜ç§€çš„ç®—æ³•æºäºå¯¹é—®é¢˜æœ¬è´¨çš„æ´å¯Ÿå’Œå¯¹å·¥å…·ç‰¹æ€§çš„çµæ´»è¿ç”¨ã€‚ä¸‹æ¬¡æŒ‘æˆ˜è§ï¼
</conclusion>

---
å¤„ç†ç”¨æ—¶ï¼š178.05ç§’
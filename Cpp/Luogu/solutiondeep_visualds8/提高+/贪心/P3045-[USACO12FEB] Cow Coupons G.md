# é¢˜ç›®ä¿¡æ¯

# [USACO12FEB] Cow Coupons G

## é¢˜ç›®èƒŒæ™¯

Subtask 0 ä¸ºåŸæ•°æ®ï¼ŒSubtask 1,2 ä¸º hack æ•°æ®ã€‚

## é¢˜ç›®æè¿°

Farmer John needs new cows! There are N cows for sale (1 <= N <= 50,000), and FJ has to spend no more than his budget of M units of money (1 <= M <= 10^14).  Cow i costs P\_i money (1 <= P\_i <= 10^9), but FJ has K coupons (1 <= K <= N), and when he uses a coupon on cow i, the cow costs C\_i instead (1 <= C\_i <= P\_i). FJ can only use one coupon per cow, of course.

What is the maximum number of cows FJ can afford? 

FJ å‡†å¤‡ä¹°ä¸€äº›æ–°å¥¶ç‰›ã€‚å¸‚åœºä¸Šæœ‰ $N$ å¤´å¥¶ç‰›ï¼Œç¬¬ $i$ å¤´å¥¶ç‰›ä»·æ ¼ä¸º $P_i$ã€‚FJ æœ‰ $K$ å¼ ä¼˜æƒ åˆ¸ï¼Œä½¿ç”¨ä¼˜æƒ åˆ¸è´­ä¹°ç¬¬ $i$ å¤´å¥¶ç‰›æ—¶ä»·æ ¼ä¼šé™ä¸º $C_i$ï¼Œå½“ç„¶æ¯å¤´å¥¶ç‰›åªèƒ½ä½¿ç”¨ä¸€æ¬¡ä¼˜æƒ åˆ¸ã€‚FJ æƒ³çŸ¥é“èŠ±ä¸è¶…è¿‡ $M$ çš„é’±æœ€å¤šå¯ä»¥ä¹°å¤šå°‘å¥¶ç‰›ï¼Ÿ

- $1 \le K \le N \le 5 \times 10^4$
- $1 \le C_i \le P_i \le 10^9$
- $1 \le M \le 10^{14}$

## è¯´æ˜/æç¤º

FJ has 4 cows, 1 coupon, and a budget of 7.


FJ uses the coupon on cow 3 and buys cows 1, 2, and 3, for a total cost of 3 + 2 + 1 = 6.


## æ ·ä¾‹ #1

### è¾“å…¥

```
4 1 7 
3 2 
2 2 
8 1 
4 3 
```

### è¾“å‡º

```
3 
```

# AIåˆ†æç»“æœ


# ğŸ’¡ æ´›è¯­äº‘ç¬ºçš„C++ç®—æ³•è§£æï¼šCow Coupons G æ·±å…¥å­¦ä¹ æŒ‡å— ğŸ’¡

> ä»Šå¤©æˆ‘ä»¬æ¥ä¸€èµ·åˆ†æâ€œCow Coupons Gâ€è¿™é“C++ç¼–ç¨‹é¢˜ã€‚è¿™ä¸ä»…ä»…æ˜¯ä¸€æ¬¡è§£é¢˜ï¼Œæ›´æ˜¯ä¸€åœºæ€ç»´çš„æ¢é™©ã€‚æˆ‘ä»¬å°†å­¦ä¹ å¦‚ä½•åƒä¾¦æ¢ä¸€æ ·ä»é¢˜ç›®ä¸­å¯»æ‰¾çº¿ç´¢ï¼Œå¹¶åœ¨ä¸åŒçš„è§£é¢˜é“è·¯ä¸­æƒè¡¡é€‰æ‹©ï¼Œæœ€ç»ˆæ‰¾åˆ°æœ€ä¼˜çš„ç­–ç•¥ã€‚

## 1. é¢˜ç›®è§£è¯»ä¸ç­–ç•¥åˆæ¢

âœ¨ **æœ¬é¢˜æ ¸å¿ƒæŒ‘æˆ˜**ï¼šå¦‚ä½•åœ¨é¢„ç®—çº¦æŸä¸‹æœ€å¤§åŒ–è´­ä¹°ç‰›çš„æ•°é‡ï¼ŒåŒæ—¶å·§å¦™å¤„ç†ä¼˜æƒ åˆ¸çš„ä½¿ç”¨é™åˆ¶ï¼ˆæ¯å¤´ç‰›åªèƒ½ä½¿ç”¨ä¸€å¼ ä¼˜æƒ åˆ¸ï¼‰ã€‚

âœ¨ **æ ¸å¿ƒç®—æ³•æ ‡ç­¾**ï¼šåæ‚”è´ªå¿ƒã€ä¼˜å…ˆé˜Ÿåˆ—ä¼˜åŒ–

ğŸ—£ï¸ **åˆæ­¥åˆ†æ**ï¼š
> è¿™é“é¢˜çš„å…³é”®åœ¨äºä¼˜æƒ åˆ¸çš„çµæ´»è¿ç”¨ã€‚æˆ‘ä»¬é¦–å…ˆæƒ³åˆ°ç”¨ä¼˜æƒ åˆ¸è´­ä¹°æœ€ä¾¿å®œçš„Kå¤´ç‰›ï¼Œä½†è¿™å¯èƒ½ä¸æ˜¯æœ€ä¼˜è§£â€”â€”åç»­å¯èƒ½å‡ºç°æ›´å€¼å¾—ä½¿ç”¨ä¼˜æƒ åˆ¸çš„ç‰›ã€‚åæ‚”è´ªå¿ƒè®©æˆ‘ä»¬èƒ½â€œæ’¤å›â€ä¹‹å‰çš„ä¼˜æƒ åˆ¸ä½¿ç”¨å†³ç­–ï¼Œé‡æ–°åˆ†é…åˆ°æ›´ä¼˜çš„ç‰›ä¸Šã€‚é€šè¿‡ä¸‰ä¸ªä¼˜å…ˆé˜Ÿåˆ—ï¼ˆåŸä»·/ä¼˜æƒ ä»·/å·®ä»·ï¼‰åŠ¨æ€ç»´æŠ¤æœ€ä¼˜é€‰æ‹©ï¼Œå°±åƒåœ¨è¿·å®«ä¸­å®æ—¶è°ƒæ•´è·¯çº¿ã€‚

### ğŸ” ç®—æ³•ä¾¦æ¢ï¼šå¦‚ä½•åœ¨é¢˜ç›®ä¸­å‘ç°çº¿ç´¢ï¼Ÿ
1.  **çº¿ç´¢1 (é—®é¢˜ç›®æ ‡)**ï¼šé¢˜ç›®è¦æ±‚"èŠ±ä¸è¶…è¿‡Mçš„é’±ä¹°æœ€å¤šçš„ç‰›"ï¼Œè¿™æ˜¯å…¸å‹çš„**æœ€ä¼˜åŒ–é—®é¢˜**ï¼Œæç¤ºæˆ‘ä»¬å¯èƒ½ä½¿ç”¨è´ªå¿ƒæˆ–åŠ¨æ€è§„åˆ’ã€‚
2.  **çº¿ç´¢2 (é—®é¢˜çº¦æŸ)**ï¼šä¼˜æƒ åˆ¸ä½¿ç”¨é™åˆ¶ï¼ˆæ¯ç‰›é™ç”¨1å¼ ï¼‰å’Œé¢„ç®—é™åˆ¶ï¼Œæš—ç¤ºéœ€è¦**åŠ¨æ€è°ƒæ•´å†³ç­–**ï¼ŒæŒ‡å‘åæ‚”è´ªå¿ƒæ¨¡å‹ã€‚
3.  **çº¿ç´¢3 (æ•°æ®è§„æ¨¡)**ï¼šNæœ€å¤§5e4ï¼ŒMæœ€å¤§1e14ã€‚O(NlogN)çš„ç®—æ³•ï¼ˆçº¦3Ã—10^5æ¬¡æ“ä½œï¼‰å¯è¡Œï¼Œæ’é™¤äº†æš´åŠ›è§£æ³•ã€‚

### ğŸ§  æ€ç»´é“¾æ„å»ºï¼šä»çº¿ç´¢åˆ°ç­–ç•¥
> å¥½äº†ï¼Œä¾¦æ¢å·¥ä½œå®Œæˆï¼Œæˆ‘ä»¬æ”¶é›†åˆ°äº†å‡ æ¡å…³é”®çº¿ç´¢ã€‚ç°åœ¨ï¼Œè®©æˆ‘ä»¬åƒæ‹¼å›¾ä¸€æ ·æŠŠå®ƒä»¬ç»„åˆèµ·æ¥ï¼š
> 1.  ã€çº¿ç´¢1ï¼šé—®é¢˜ç›®æ ‡ã€‘æŒ‡å‘æœ€ä¼˜åŒ–é—®é¢˜ï¼Œå€™é€‰æ–¹æ¡ˆæœ‰è´ªå¿ƒã€åŠ¨æ€è§„åˆ’ã€‚
> 2.  ã€çº¿ç´¢2ï¼šé—®é¢˜ç‰¹æ€§ã€‘ä¼˜æƒ åˆ¸çš„"ä¸å¯æ‹†åˆ†æ€§"å’Œ"å¯è½¬ç§»æ€§"å†³å®šç®€å•è´ªå¿ƒå¤±æ•ˆï¼Œéœ€è¦æ”¯æŒ"æ’¤é”€-é‡åˆ†é…"çš„æœºåˆ¶ã€‚
> 3.  ã€çº¿ç´¢3ï¼šæ•°æ®è§„æ¨¡ã€‘æ’é™¤O(2^N)æš´åŠ›æšä¸¾ï¼Œéœ€è¦O(NlogN)çº§é«˜æ•ˆç®—æ³•ã€‚
> 4.  **ç»“è®º**ï¼š**åæ‚”è´ªå¿ƒ**å®Œç¾å¥‘åˆéœ€æ±‚â€”â€”é€šè¿‡ä¼˜å…ˆé˜Ÿåˆ—å®ç°é«˜æ•ˆå†³ç­–è°ƒæ•´ï¼Œæ—¶é—´å¤æ‚åº¦O(NlogN)ã€‚

---

## 2. ç²¾é€‰ä¼˜è´¨é¢˜è§£å‚è€ƒ

ä»æ€è·¯æ¸…æ™°æ€§ã€ä»£ç è§„èŒƒæ€§å’Œç®—æ³•åˆ›æ–°æ€§è§’åº¦ï¼Œç²¾é€‰ä¸‰ä»½ä¼˜è´¨é¢˜è§£ï¼š

**é¢˜è§£ä¸€ï¼šäººé—´æ¸©æŸ”ï¼ˆåæ‚”è´ªå¿ƒç›´å‡»æ ¸å¿ƒï¼‰**
* **ç‚¹è¯„**ï¼šå¼€ç¯‡ä»¥â€œé™åå¸¸æ€å·±è¿‡â€ç‚¹é¢˜ï¼Œç”ŸåŠ¨é˜é‡Šåæ‚”è´ªå¿ƒå“²å­¦ã€‚ä»£ç ä¸­`delta`é˜Ÿåˆ—ç»´æŠ¤ä¼˜æƒ å·®ä»·ï¼Œ`P`/`C`é˜Ÿåˆ—åˆ†åˆ«ç®¡ç†åŸä»·å’Œä¼˜æƒ ä»·ï¼Œé€»è¾‘æ¸…æ™°ã€‚äº®ç‚¹åœ¨äºç”¨`lambda`ç®€åŒ–é‡å¤è®¡ç®—ï¼ˆå¦‚`p[i]-c[i]`ï¼‰ï¼Œæå‡å¯è¯»æ€§ã€‚è°ƒè¯•å¿ƒå¾—â€œå¸¸æ€å·±è¿‡â€ä½“ç°ç®—æ³•æœ¬è´¨â€”â€”åŠ¨æ€è¯„ä¼°å†å²å†³ç­–ã€‚

**é¢˜è§£äºŒï¼šCuxhinï¼ˆåæ‚”è´ªå¿ƒåˆ†å±‚è§£æï¼‰**
* **ç‚¹è¯„**ï¼šç‹¬åˆ›â€œè´ªå¿ƒä¸‰é˜¶æ®µâ€æ•™å­¦æ³•ï¼šåŸºç¡€è´ªå¿ƒâ†’é—®é¢˜æš´éœ²â†’åæ‚”ä¼˜åŒ–ã€‚é€šè¿‡è‡ªé€ æµ‹è¯•æ•°æ®æ­ç¤ºç®—æ³•ç¼ºé™·ï¼Œç±»æ¯”â€œè½¬ç§»ä¼˜æƒ åˆ¸å¦‚åŒæ¢ä¹˜æ›´å¿«çš„å…¬äº¤â€ã€‚ä»£ç å®ç°ä¸­`Ticket`ç±»å°è£…ä¼˜æƒ åˆ¸æ“ä½œï¼Œ`Cow`ç±»ç»‘å®šæ•°æ®ä¸çŠ¶æ€ï¼Œä½“ç°OOPæ€æƒ³ï¼Œé€‚åˆåˆå­¦è€…ç†è§£ã€‚

**é¢˜è§£ä¸‰ï¼šxiezheyuanï¼ˆè´¹ç”¨æµå»ºæ¨¡è§†è§’ï¼‰**
* **ç‚¹è¯„**ï¼šç‹¬è¾Ÿè¹Šå¾„ä»è´¹ç”¨æµè§’åº¦å»ºæ¨¡ï¼Œå°†ä¼˜æƒ åˆ¸è§†ä¸ºâ€œè™šæ‹Ÿæºç‚¹â€ï¼ŒåŸä»·/ä¼˜æƒ ä»·è´­ä¹°æŠ½è±¡ä¸ºä¸¤æ¡è·¯å¾„ã€‚è™½ç„¶æœ€ç»ˆè½åœ°ä¸ºåæ‚”è´ªå¿ƒï¼Œä½†è¿™ç§é«˜å±‚æ¬¡æŠ½è±¡æ·±åŒ–äº†é—®é¢˜æœ¬è´¨ç†è§£ã€‚ä»£ç ä¸­`q01`/`q02`/`q21`ä¸‰ä¸ªé˜Ÿåˆ—ä¸¥æ ¼å¯¹åº”ä¸‰ç±»å¢å¹¿è·¯ï¼Œå­¦æœ¯æ€§å¼ºã€‚

---

## 3. è§£é¢˜ç­–ç•¥æ·±åº¦å‰–æ

### ğŸ¯ æ ¸å¿ƒéš¾ç‚¹ä¸å…³é”®æ­¥éª¤
1.  **éš¾ç‚¹1ï¼šä¼˜æƒ åˆ¸çš„"æ—¶ç©ºåˆ†é…"çŸ›ç›¾**
    * **åˆ†æ**ï¼šä¼˜æƒ åˆ¸ä½¿ç”¨æœ‰é¡ºåºä¾èµ–â€”â€”å‰æœŸç”¨åˆ¸å¯èƒ½é˜»å¡åæœŸæ›´ä¼˜é€‰æ‹©ã€‚è§£æ³•ï¼šç”¨æœ€å°å †ï¼ˆ`priority_queue`ï¼‰åŠ¨æ€ç»´æŠ¤å€™é€‰é›†ï¼Œå½“å‰å†³ç­–ä¿ç•™æœªæ¥ä¼˜åŒ–ç©ºé—´ã€‚
    * ğŸ’¡ **å­¦ä¹ ç¬”è®°**ï¼šåæ‚”è´ªå¿ƒçš„æ ¸å¿ƒæ˜¯è®¾è®¡"å¯æ’¤é”€"çš„å†³ç­–ç»“æ„ï¼Œå †æ˜¯å¤©ç„¶è½½ä½“ã€‚

2.  **éš¾ç‚¹2ï¼šåæ‚”ä»£ä»·çš„æ•°å­¦è¡¨å¾**
    * **åˆ†æ**ï¼šåæ‚”æ“ä½œçš„æ ¸å¿ƒç­‰å¼ï¼š`æ–°ä»£ä»· = åŸä»£ä»· + (P_j - C_j) + C_i - P_j`ã€‚åŒ–ç®€å¾—å†³ç­–æ¡ä»¶ï¼š`P_i - C_i > P_j - C_j`ï¼Œå³å½“å‰ç‰›çš„ä¼˜æƒ å¹…åº¦å¤§äºå†å²ç‰›ã€‚
    * ğŸ’¡ **å­¦ä¹ ç¬”è®°**ï¼šå°†å†³ç­–æ¡ä»¶è½¬åŒ–ä¸ºå·®å€¼æ¯”è¾ƒï¼ˆ`P_i - C_i`ï¼‰ï¼Œæ˜¯åæ‚”è´ªå¿ƒå¸¸è§æŠ€å·§ã€‚

3.  **éš¾ç‚¹3ï¼šçŠ¶æ€åŒæ­¥ç»´æŠ¤**
    * **åˆ†æ**ï¼šä¸‰ä¸ªä¼˜å…ˆé˜Ÿåˆ—éœ€å®æ—¶åŒæ­¥â€”â€”å½“ç‰›è¢«è´­ä¹°åï¼Œéœ€ä»æ‰€æœ‰é˜Ÿåˆ—ç§»é™¤ã€‚ä»£ç ä¸­é€šè¿‡`vis[]`æ ‡è®°å®ç°ï¼Œç¡®ä¿æ¯ä¸ªå…ƒç´ åªè¢«å¤„ç†ä¸€æ¬¡ã€‚
    * ğŸ’¡ **å­¦ä¹ ç¬”è®°**ï¼šå¤šæ•°æ®ç»“æ„ç»´æŠ¤åŒä¸€æ•°æ®é›†æ—¶ï¼Œæ ‡è®°æ•°ç»„æ˜¯é¿å…çŠ¶æ€å†²çªçš„åˆ©å™¨ã€‚

### âœ¨ è§£é¢˜æŠ€å·§æ€»ç»“
- **æŠ€å·§1ï¼šå·®å€¼è½¬åŒ–**ï¼šå°†ä¼˜æƒ å¹…åº¦é‡åŒ–ä¸º`P_i - C_i`ï¼Œä½¿å†³ç­–å¯æ¯”
- **æŠ€å·§2ï¼šå †å†—ä½™ç®¡ç†**ï¼šå¾ªç¯å¼¹å‡ºå †é¡¶æ— æ•ˆå…ƒç´ ï¼ˆ`while(vis[q.top().id]) q.pop()`ï¼‰
- **æŠ€å·§3ï¼šåæ‚”åˆå§‹åŒ–**ï¼šå‘å·®ä»·å †é¢„å¡«å……Kä¸ª0ï¼Œç»Ÿä¸€æ— ä¼˜æƒ åˆ¸æƒ…å½¢

### âš”ï¸ ç­–ç•¥ç«æŠ€åœºï¼šä¸åŒè§£æ³•çš„å¯¹æ¯”åˆ†æ

| ç­–ç•¥                | æ ¸å¿ƒæ€æƒ³                     | ä¼˜ç‚¹                          | ç¼ºç‚¹ä¸åˆ†æ                                    | é€‚ç”¨åœºæ™¯/å¾—åˆ†é¢„æœŸ       |
|---------------------|------------------------------|-------------------------------|---------------------------------------------|-------------------------|
| **æš´åŠ›æœç´¢**        | æšä¸¾æ‰€æœ‰ä¼˜æƒ åˆ¸ç»„åˆ           | æ€è·¯ç›´è§‚                      | O(2^N)è¶…æ—¶ï¼ŒN=50æ—¶å³ä¸å¯è¡Œ                  | ä»…é€‚ç”¨Nâ‰¤20ï¼ŒæœŸæœ›0åˆ†     |
| **åŠ¨æ€è§„åˆ’**        | dp[i][j]è¡¨ç¤ºå‰iç‰›ç”¨jåˆ¸æœ€å°èŠ±è´¹ | ä¿è¯æœ€ä¼˜è§£                    | çŠ¶æ€ç©ºé—´O(NK)ï¼ŒN=5e4æ—¶MLE/TLE               | ä»…é€‚ç”¨å°æ•°æ®ï¼ŒæœŸæœ›30%   |
| **åæ‚”è´ªå¿ƒ(æœ¬é¢˜æœ€ä¼˜)** | å †ç»´æŠ¤å¯åæ‚”å†³ç­–             | O(NlogN)é«˜æ•ˆï¼Œä»£ç ç®€æ´        | æ€ç»´éš¾åº¦é«˜                                 | æœ¬é¢˜æœ€ä½³ï¼ŒæœŸæœ›100%      |

### âœ¨ ä¼˜åŒ–ä¹‹æ—…ï¼šä»â€œèƒ½åšâ€åˆ°â€œåšå¥½â€
> 1. **èµ·ç‚¹ï¼šæœ´ç´ è´ªå¿ƒçš„é™·é˜±**  
>    ç›´æ¥é€‰C_iæœ€å°çš„Kå¤´ç‰›ç”¨åˆ¸ï¼Œå‰©ä½™æŒ‰P_iè´­ä¹°ã€‚ä½†å½“åæœŸå‡ºç°é«˜ä¼˜æƒ ç‰›ï¼ˆå¦‚P_i-C_i=100ï¼‰è€Œå‰æœŸå·²ç”¨åˆ¸äºä½ä¼˜æƒ ç‰›ï¼ˆP_j-C_j=10ï¼‰æ—¶ï¼Œé™·å…¥å±€éƒ¨æœ€ä¼˜ã€‚
> 
> 2. **ç“¶é¢ˆå‘ç°ï¼šå†³ç­–çš„æ—¶åºä¾èµ–æ€§**  
>    ä¼˜æƒ åˆ¸çš„ä½¿ç”¨æ•ˆæœå–å†³äºå…¨å±€åºåˆ—ï¼Œä½†è´ªå¿ƒæ— æ³•é¢„çŸ¥æœªæ¥ã€‚
> 
> 3. **å…³é”®è·¨è¶Šï¼šåæ‚”æœºåˆ¶å¼•å…¥**  
>    è®¾è®¡â€œå·®ä»·å †â€è®°å½•å†å²ä¼˜æƒ å¹…åº¦ï¼Œå½“`å½“å‰ç‰›ä¼˜æƒ å·®ä»· > å †é¡¶å·®ä»·`æ—¶ï¼Œæ‰§è¡Œåæ‚”ï¼š  
>    `æ–°èŠ±è´¹ = åŸèŠ±è´¹ + å½“å‰C_i + å †é¡¶å·®ä»· - å†å²C_j`
> 
> 4. **æ¨¡å‹å‡åï¼šå †ç»´æŠ¤åæ‚”æœºä¼š**  
>    ç”¨æœ€å°å †ç»´æŠ¤å¯åæ‚”çš„å†³ç­–é›†åˆï¼Œæ¯æ¬¡æ“ä½œåæ’å…¥æ–°åæ‚”æœºä¼šï¼ˆ`P_i-C_i`ï¼‰ï¼Œå½¢æˆé—­ç¯ã€‚

ğŸ’¡ **ç­–ç•¥æ€»ç»“**ï¼šä»æš´åŠ›åˆ°åæ‚”è´ªå¿ƒï¼Œæ˜¯â€œå†³ç­–å¯æ’¤é”€åŒ–â€çš„æ€ç»´è·ƒè¿ã€‚åœ¨ç«èµ›ä¸­ï¼Œå³ä½¿æœªæƒ³åˆ°åæ‚”è´ªå¿ƒï¼Œå†™å¯¹æœ´ç´ è´ªå¿ƒä¹Ÿèƒ½è·å¾—éƒ¨åˆ†åˆ†ã€‚è€Œæœ€ä¼˜è§£å¯ç¤ºæˆ‘ä»¬ï¼šå¥½çš„ç®—æ³•=é—®é¢˜æ·±åˆ»ç†è§£+æ•°æ®ç»“æ„å·§å¦™è¿ç”¨ã€‚

---

## 4. C++æ ¸å¿ƒä»£ç å®ç°èµæ

### æœ¬é¢˜é€šç”¨æ ¸å¿ƒC++å®ç°
```cpp
#include <bits/stdc++.h>
using namespace std;
typedef long long LL;
typedef pair<LL, LL> PLL;
const int N = 5e4 + 10;

LL n, k, m, ans, sum;
PLL cow[N]; // first:åŸä»·P, second:ä¼˜æƒ ä»·C
bool vis[N];
priority_queue<LL, vector<LL>, greater<LL>> diffHeap; // å·®ä»·å †(P_i-C_i)
priority_queue<PLL, vector<PLL>, greater<PLL>> pHeap, cHeap; // åŸä»·å †&ä¼˜æƒ ä»·å †

int main() {
    cin >> n >> k >> m;
    for (int i = 1; i <= n; ++i) 
        cin >> cow[i].first >> cow[i].second;

    // æŒ‰ä¼˜æƒ ä»·æ’åºï¼Œåˆæ­¥ä½¿ç”¨Kå¼ åˆ¸
    sort(cow + 1, cow + 1 + n, [](const PLL& a, const PLL& b) {
        return a.second < b.second;
    });

    // åˆå§‹åŒ–å·®ä»·å †
    for (int i = 0; i < k; ++i) diffHeap.push(0);

    // å°è¯•è´­ä¹°å‰Kå¤´ï¼ˆä¼˜æƒ ä»·ï¼‰
    for (int i = 1; i <= k; ++i) {
        if (sum + cow[i].second > m) break;
        sum += cow[i].second;
        diffHeap.push(cow[i].first - cow[i].second);
        ans++;
    }

    // åˆå§‹åŒ–å‰©ä½™ç‰›çš„å †
    for (int i = k + 1; i <= n; ++i) {
        pHeap.push({cow[i].first, i});
        cHeap.push({cow[i].second, i});
    }

    // åæ‚”è´ªå¿ƒä¸»å¾ªç¯
    while (ans < n) {
        // æ¸…ç†æ— æ•ˆå †é¡¶
        while (!pHeap.empty() && vis[pHeap.top().second]) pHeap.pop();
        while (!cHeap.empty() && vis[cHeap.top().second]) cHeap.pop();
        if (pHeap.empty() || cHeap.empty()) break;

        LL pMin = pHeap.top().first;
        LL cMin = cHeap.top().first;
        LL diff = diffHeap.top();

        // å†³ç­–1ï¼šç›´æ¥åŸä»·è´­ä¹°
        if (pMin <= cMin + diff) {
            if (sum + pMin > m) break;
            sum += pMin;
            vis[pHeap.top().second] = true;
            pHeap.pop();
        } 
        // å†³ç­–2ï¼šåæ‚”+ä¼˜æƒ è´­ä¹°
        else {
            if (sum + cMin + diff > m) break;
            sum += cMin + diff;
            diffHeap.pop(); // ç§»é™¤è¢«åæ‚”çš„å·®ä»·
            diffHeap.push(cow[cHeap.top().second].first - cMin); // åŠ å…¥æ–°å·®ä»·
            vis[cHeap.top().second] = true;
            cHeap.pop();
        }
        ans++;
    }
    cout << ans << endl;
    return 0;
}
```

**ä»£ç è§£è¯»æ¦‚è¦**ï¼š  
1. é¢„å¤„ç†ï¼šæŒ‰ä¼˜æƒ ä»·æ’åºï¼Œä¹°å‰Kå¤´ç‰›  
2. ä¸‰å †ç»´æŠ¤ï¼š  
   - `diffHeap`ï¼šå·²ç”¨åˆ¸ç‰›çš„å·®ä»·(P_i-C_i)å°æ ¹å †  
   - `pHeap`ï¼šæœªè´­ä¹°ç‰›çš„åŸä»·å°æ ¹å †  
   - `cHeap`ï¼šæœªè´­ä¹°ç‰›çš„ä¼˜æƒ ä»·å°æ ¹å †  
3. åŠ¨æ€å†³ç­–ï¼šæ¯æ­¥é€‰æ‹©åŸä»·è´­ä¹°æˆ–åæ‚”+ä¼˜æƒ è´­ä¹°ä¸­æ›´ä¼˜è€…  

---

## 5. ç®—æ³•å¯è§†åŒ–ï¼šåƒç´ åŠ¨ç”»æ¼”ç¤º

### è®¾è®¡ç†å¿µ
é‡‡ç”¨**8-bitåƒç´ é£**æ¨¡æ‹Ÿç‰§åœºè´­ç‰©ï¼šç‰›=åƒç´ å¥¶ç‰›ï¼Œä¼˜æƒ åˆ¸=é—ªå…‰ç¥¨åˆ¸ï¼Œé¢„ç®—=é‡‘å¸æ§½ã€‚é€šè¿‡å¯¹æ¯”â€œåŸä»·/ä¼˜æƒ ä»·è´­ä¹°â€çš„å®æ—¶èŠ±è´¹ï¼Œç›´è§‚å±•ç¤ºåæ‚”å†³ç­–å¦‚ä½•èŠ‚çœé‡‘å¸ã€‚

### å…³é”®å¸§è®¾è®¡
1. **åˆå§‹åŒ–åœºæ™¯**ï¼ˆå¤å¤ç»¿è‰åœ°ï¼‰ï¼š
   - åƒç´ ç‰›æŒ‰ä¼˜æƒ ä»·ä»å·¦åˆ°å³æ’åˆ—
   - é‡‘å¸æ§½æ˜¾ç¤ºåˆå§‹é¢„ç®—M
   - å³ä¸‹è§’æ§åˆ¶é¢æ¿ï¼šæš‚åœ/æ­¥è¿›/è°ƒé€Ÿæ»‘å—

2. **ç¬¬ä¸€é˜¶æ®µï¼šåŸºç¡€è´­ä¹°**ï¼ˆéŸ³æ•ˆï¼šç¡¬å¸æ‰è½ï¼‰ï¼š
   ``` 
   [ç‰›1] ä¼˜æƒ ä»·C1 -> é‡‘å¸æ§½-=C1
   [ç‰›2] ä¼˜æƒ ä»·C2 -> é‡‘å¸æ§½-=C2
   ...
   ```

3. **åæ‚”å†³ç­–ç‚¹**ï¼ˆéŸ³æ•ˆï¼šç”µå­è­¦æŠ¥+é‡‘å¸å›å¼¹ï¼‰ï¼š
   - å½“æ–°ç‰›ä¼˜æƒ ä»·C_iå‡ºç°æ—¶ï¼Œå†å²ç”¨åˆ¸ç‰›ä¸­å·®ä»·æœ€å°è€…ï¼ˆå¦‚ç‰›jï¼‰é—ªçƒçº¢å…‰
   - æ˜¾ç¤ºæ•°å­¦æ¯”è¾ƒå¼ï¼š`C_i + (P_j - C_j) vs P_i`
   - é€‰æ‹©æ›´å°å€¼è·¯å¾„ï¼šé‡‘å¸æ§½ç›¸åº”å¢å‡

4. **çŠ¶æ€æ›´æ–°**ï¼ˆåƒç´ ç²’å­ç‰¹æ•ˆï¼‰ï¼š
   - è¢«åæ‚”çš„ç‰›æ¢å¤åŸä»·é¢œè‰²
   - æ–°è´­ç‰›å˜é‡‘è‰²ï¼Œå¤´é¡¶æ˜¾ç¤ºåˆ¸å›¾æ ‡

### æŠ€æœ¯å®ç°
- **Canvasç»˜åˆ¶**ï¼šç½‘æ ¼åŒ–ç‰§åœºï¼ˆ50Ã—50åƒç´ /ç‰›ï¼‰ï¼Œé‡‘å¸æ§½ç”¨æ¸å˜å¡«å……çŸ©å½¢
- **äº¤äº’é€»è¾‘**ï¼š
  ```js
  function drawCow(index, isCouponUsed) {
    ctx.fillStyle = isCouponUsed ? '#FFD700' : '#8B4513'; // é‡‘/æ£•è‰²
    drawPixelCow(x, y); // åƒç´ åŒ–å¥¶ç‰›ç»˜åˆ¶å‡½æ•°
  }
  
  function simulateStep() {
    if (mode === 'refund') {
      playSound('refund_sound'); // æ’­æ”¾é€€æ¬¾éŸ³æ•ˆ
      drawMathCompare(currentCow, refundCow); // æ˜¾ç¤ºå†³ç­–å…¬å¼
    }
  }
  ```

---

## 6. æ‹“å±•ç»ƒä¹ ä¸ç›¸ä¼¼é—®é¢˜æ€è€ƒ

### é€šç”¨æŠ€å·§è¿ç§»
åæ‚”è´ªå¿ƒé€‚ç”¨äº**å¸¦æ’¤é”€çš„æœ€ä¼˜åŒ–é—®é¢˜**ï¼Œå˜ç§åœºæ™¯ï¼š
1. ä»»åŠ¡è°ƒåº¦ï¼šæ’¤æ¶ˆä½æ”¶ç›Šä»»åŠ¡æ”¹åšé«˜æ”¶ç›Š
2. æŠ•èµ„ç»„åˆï¼šå–å‡ºæ¶¨å¹…ä½çš„è‚¡ç¥¨ä¹°å…¥æ–°é«˜
3. è·¯å¾„è§„åˆ’ï¼šæ›¿æ¢ä½æ•ˆè·¯å¾„æ®µ

### æ¨èç»ƒä¹ ï¼ˆæ´›è°·ï¼‰
1. **P4053 [JSOI2007]å»ºç­‘æŠ¢ä¿®**  
   â†’ åæ‚”å †ç»å…¸åº”ç”¨ï¼Œå­¦ä¼šâ€œæ’¤æ¶ˆä¿®å¤æ—¶é—´é•¿çš„å»ºç­‘â€
2. **P2107 å°Zçš„AKè®¡åˆ’**  
   â†’ ç»“åˆä½ç½®ç§»åŠ¨çš„å¤åˆåæ‚”æ¨¡å‹
3. **P4597 åºåˆ—sequence**  
   â†’ åæ‚”è´ªå¿ƒ+å †ç»´æŠ¤çš„éé™åºåˆ—å˜å½¢

---

## 7. å­¦ä¹ å¿ƒå¾—ä¸ç»éªŒåˆ†äº«
> æ¥è‡ªä¼˜è´¨é¢˜è§£çš„ä½œè€…æ´è§ï¼š
> 
> _â€œè°ƒè¯•æ—¶é‡ç‚¹ç›‘æ§å·®ä»·å †é¡¶â€”â€”å®ƒå†³å®šäº†åæ‚”é˜ˆå€¼ã€‚å½“æ–°ç‰›ä¼˜æƒ ä»·+å †é¡¶å·®ä»·çªç„¶è·ƒå‡ï¼Œå¾€å¾€æ˜¯è¾¹ç•Œæ¡ä»¶é”™è¯¯ã€‚â€_ â€”â€”Cuxhin
> 
> **æ´›è¯­äº‘ç¬ºç‚¹è¯„**ï¼šå·®ä»·å †æ˜¯åæ‚”æœºåˆ¶çš„â€œå¿ƒè„â€ï¼Œå…¶å˜åŒ–åæ˜ äº†å†³ç­–ä»£ä»·çš„æ³¢åŠ¨ã€‚å»ºè®®åœ¨æ¯æ¬¡åæ‚”æ“ä½œåè¾“å‡ºå †çŠ¶æ€ï¼Œå¯è§†åŒ–éªŒè¯å†³ç­–é“¾ã€‚

---

<conclusion>
æœ¬æ¬¡å…³äºâ€œCow Coupons Gâ€çš„C++è§£é¢˜åˆ†æå°±åˆ°è¿™é‡Œã€‚è®°ä½ï¼Œç¼–ç¨‹èƒ½åŠ›çš„æå‡åœ¨äºæŒç»­å­¦ä¹ ã€å‹¤äºæ€è€ƒå’Œå‹‡äºå®è·µã€‚ä¸‹æ¬¡æˆ‘ä»¬å†ä¸€èµ·æ¢ç´¢æ–°çš„ç¼–ç¨‹æŒ‘æˆ˜ï¼ğŸ’ª
</conclusion>

---
å¤„ç†ç”¨æ—¶ï¼š158.79ç§’
# é¢˜ç›®ä¿¡æ¯

# ã€ŒWdsr-2.5ã€ç¬¬äºŒæ¬¡æœˆé¢æˆ˜äº‰

## é¢˜ç›®èƒŒæ™¯

è‹¥å¹²å¹´ä¹‹å‰ï¼Œå…«äº‘ç´«ç­–åˆ’äº†ç¬¬äºŒæ¬¡æœˆé¢æˆ˜äº‰ã€‚

ä½œä¸ºç¥ç¤¾çš„å·«å¥³ï¼Œçµæ¢¦è‡ªç„¶æœ‰ä¿æŠ¤äººé—´ä¹‹é‡Œäººç±»çš„èŒè´£ã€‚ä¸ºäº†èƒ½å¤Ÿä½¿å¾—äººç±»å…å—æœˆé¢æˆ˜äº‰å¯èƒ½é€ æˆçš„å½±å“ï¼Œçµæ¢¦å†³å®šåœ¨åšä¸½ç¥ç¤¾è®¾ç«‹ä¸€ä¸ªç»“ç•Œã€‚

ç”±äºç»“ç•Œçš„å½±å“èŒƒå›´æœ‰é™ï¼Œåªèƒ½è¦†ç›–åˆ°åšä¸½ç¥ç¤¾ï¼Œäºæ˜¯çµæ¢¦å†³å®šå°†äººé—´ä¹‹é‡Œçš„æ‰€æœ‰å±…æ°‘è¿å…¥åˆ°ç¥ç¤¾ä¸­å»ã€‚ç„¶è€Œç”±äºå±…æ°‘æ•°ç›®è¾ƒå¤šï¼Œçµæ¢¦åœ¨ç»„ç»‡ä¸Šå‡ºç°äº†ä¸€äº›å›°éš¾ã€‚è¿™æ—¶ï¼Œå¥¹æ‰¾åˆ°äº†å¤–ç•Œçš„ä½ ï¼Œå¸Œæœ›ä½ å¸®åŠ©å¥¹è§£å†³è¿™ä¸ªé—®é¢˜ã€‚

## é¢˜ç›®æè¿°

äººé—´ä¹‹é‡Œå¯ä»¥çœ‹åšä¸€å¼  $n$ ä¸ªç‚¹ $m$ æ¡è¾¹çš„æœ‰å‘å›¾ï¼Œè€Œåšä¸½ç¥ç¤¾åœ¨ç‚¹ $t$ ã€‚ç„¶è€Œç”±äºæ—¶é—´å·®çš„åŸå› ï¼Œçµæ¢¦ä¸èƒ½ä¸€æ¬¡æ€§è·å–æ‰€æœ‰å±…æ°‘çš„ä½ç½®ï¼Œäºæ˜¯å¥¹ä¼šä¾æ¬¡å—åˆ° $k$ æ¡æ¶ˆæ¯ï¼Œæ¯æ¡ä¿¡æ¯åŒ…å«ä¸€ä¸ªèŠ‚ç‚¹ $x$ã€‚

- å¦‚æœ $x$ å·èŠ‚ç‚¹æœ¬æ¥æ²¡æœ‰å±…æ°‘ï¼Œé‚£ä¹ˆçµæ¢¦å¾—çŸ¥äº†æœ‰ä¸€ä¸ªå±…æ°‘åœ¨ $x$ å·èŠ‚ç‚¹ã€‚
- å¦‚æœ $x$ å·èŠ‚ç‚¹æœ¬æ¥æœ‰å±…æ°‘ï¼Œé‚£ä¹ˆç”±äºæŸäº›åŸå› ï¼Œ $x$ å·èŠ‚ç‚¹ç°åœ¨æ²¡æœ‰å±…æ°‘äº†ã€‚

ç”±äºæŸäº›åŸå› ï¼Œåœ¨ $t$ å·èŠ‚ç‚¹ä¹Ÿæœ‰å¯èƒ½å­˜åœ¨å±…æ°‘ã€‚

æ¯å½“å¾—çŸ¥ä¸€æ¡æ–°çš„æ¶ˆæ¯åï¼Œçµæ¢¦éƒ½éœ€è¦å¿«é€Ÿè®¡ç®—å‡ºå±…æ°‘çš„æœ€å¿«ç–æ•£æ—¶é—´ï¼Œä»¥ä¾¿äºåˆç†å®‰æ’ï¼ˆæ­¤æ—¶ï¼Œä½ å¯ä»¥è®¤ä¸ºå…¶ä»–èŠ‚ç‚¹ä¸Šæ²¡æœ‰å±…æ°‘ï¼‰ã€‚åŒæ—¶ä¸ºäº†é¿å…æ‹¥æŒ¤ï¼Œä»¥åŠå…¶ä»–éš¾ä»¥é¢„æ–™çš„å›°éš¾ï¼Œçµæ¢¦åšå‡ºäº†å¦‚ä¸‹è§„åˆ™ï¼š

- æ¯ä¸€æ—¶åˆ»ï¼Œæ¯ä¸ªå±…æ°‘åªèƒ½æ²¿ç€ä¸€æ¡æœ‰å‘è¾¹èµ°ä¸€æ­¥ï¼Œæˆ–è€…**åœç•™åœ¨åŸåœ°**ã€‚
- æ¯ä¸€æ—¶åˆ»ï¼Œæ¯ä¸ªèŠ‚ç‚¹ä¸Šï¼Œ**æœ€å¤šåªèƒ½æœ‰ä¸€ä½å±…æ°‘**ã€‚
- å½“å±…æ°‘åˆ°è¾¾äº†åšä¸½ç¥ç¤¾ï¼Œé‚£ä¹ˆ**ä¸‹ä¸€æ—¶åˆ»**ä»–å°±å¯ä»¥è¿›å…¥ç»“ç•Œä»¥è·å¾—åº‡æŠ¤ã€‚ä½ å¯ä»¥è®¤ä¸ºï¼Œåœ¨å±…æ°‘è¿›å…¥ç»“ç•Œåä»–çš„è¡Œç¨‹å°±ç»“æŸäº†ã€‚

æœ€å¿«ç–æ•£æ—¶é—´ï¼ŒæŒ‡çš„æ˜¯**æ‰€æœ‰å±…æ°‘**å…¨éƒ¨è¿›å…¥ç»“ç•Œçš„æœ€çŸ­ç”¨æ—¶ã€‚

## è¯´æ˜/æç¤º

#### æ ·ä¾‹ 1 è¯´æ˜

![main1.png](https://i.loli.net/2021/03/26/bWyznVgRc1pqPaf.png)

è¿™å¼ å›¾æè¿°äº†**åˆå§‹çŠ¶æ€**ã€**ç¬¬ä¸€æ¬¡æ“ä½œ**ã€**ç¬¬äºŒæ¬¡æ“ä½œ**çš„æƒ…å†µã€‚å¯ä»¥å‘ç°ï¼›

- ç¬¬ä¸€æ¬¡æ“ä½œåï¼Œ $7$ å·èŠ‚ç‚¹æœ€å¿«é€šè¿‡ $7\to 6\to 1$ åˆ°è¾¾ç¥ç¤¾ï¼Œå†èŠ±è´¹ $1$ å•ä½æ—¶é—´è¿›å…¥ç¥ç¤¾ï¼Œæ€»å…±ç”¨æ—¶ $3$ å•ä½æ—¶é—´ã€‚
- ç¬¬äºŒæ¬¡æ“ä½œåï¼Œ $1$ å·èŠ‚ç‚¹èŠ±è´¹ $1$ æ—¶åˆ»è¿›å…¥ç¥ç¤¾ï¼Œ $7$ å·èŠ‚ç‚¹ä»ç„¶æŒ‰ç…§ $7\to 6\to 1$ åˆ°è¾¾ç¥ç¤¾ï¼Œå¹¶èŠ±è´¹ $1$ å•ä½æ—¶é—´è¿›å…¥ç¥ç¤¾å³å¯ã€‚æ€»å…±èŠ±è´¹ $3$ å•ä½æ—¶é—´ã€‚

![main2.png](https://i.loli.net/2021/03/26/sr3kbOWh7PxBway.png)

è¿™å¼ å›¾æè¿°äº†ç¬¬ä¸‰æ¬¡æ“ä½œåçš„æƒ…å†µã€‚

ç¬¬ä¸€æ—¶åˆ»ï¼Œ $1$ è¿›å…¥ç¥ç¤¾ï¼Œ $2\to 1,7\to 6$ ï¼›ç¬¬äºŒæ—¶åˆ»ï¼Œ $1$ è¿›å…¥ç¥ç¤¾ï¼Œ $6\to 1$ ï¼›ç¬¬ä¸‰æ—¶åˆ»æ‰€æœ‰äººéƒ½è¿›å…¥äº†ç¥ç¤¾ï¼Œäºæ˜¯æ€»å…±èŠ±è´¹ $3$ å•ä½æ—¶é—´ã€‚

![main3.png](https://i.loli.net/2021/03/26/IWt7zKPohpFBmfV.png)

è¿™å¼ å›¾æè¿°äº†ç¬¬å››æ¬¡æ“ä½œåçš„æƒ…å†µã€‚

ç¬¬ä¸€æ—¶åˆ»ï¼Œ $1$ è¿›å…¥ç¥ç¤¾ï¼Œ $3\to 1,7\to 6$ ï¼Œ $2$ ä¸åŠ¨ï¼›ç¬¬äºŒæ—¶åˆ»ï¼Œ $1$ è¿›å…¥ç¥ç¤¾ï¼Œ $2\to 1$ ï¼Œ $6$ ä¸åŠ¨ã€‚æ¥ä¸‹æ¥èŠ±è´¹ $2$ æ—¶åˆ»å…¨éƒ¨è¿›å…¥ç¥ç¤¾ï¼Œäºæ˜¯æ€»å…±èŠ±è´¹ $4$ å•ä½æ—¶é—´ã€‚

#### æ ·ä¾‹ 2,3

è§ä¸‹å‘é™„ä»¶ã€‚

#### æ•°æ®èŒƒå›´åŠçº¦å®š

$$
\def\bd{\boldsymbol}
\def\a{\texttt{A}}	% é“¾çš„æ€§è´¨
\def\b{\texttt{B}}	% èŠèŠ±å›¾çš„æ€§è´¨
\def\p{\texttt{P}}	% kä¸ºæ­£çš„æ€§è´¨
\def\n{\text{æ— ç‰¹æ®Šé™åˆ¶}}
\def\l{\hline}
\def\arraystretch{1.5}\begin{array}{|c|c|c|c|c|}\l
\textbf{æ•°æ®ç‚¹} & \bd{n} & \bd{m} & \bd{k} & \textbf{ç‰¹æ®Šæ€§è´¨} \cr\l
1\sim4 & n\le 8 & m\le 10 & k\le 10 & - \cr\l
5,6 & \n & m=n-1 & \n & \p,\a \cr\l
7,8 & \n & m=n-1 & \n & \p,\b \cr\l
9 & n\le 10^5 & m=n-1 & k\le 10^5 & \p \cr\l
10\sim 12 & n\le 10^3 & m\le 10^3 & k\le 10^3 & - \cr\l
13,14 & n\le 10^5 & m\le 10^5 & k\le 10^5 & \p \cr\l
15\sim 17 & n\le 10^5 & m\le 10^5 & k\le 10^5 & - \cr\l
18\sim 20 & \n & \n & \n & - \cr\l
\end{array}
$$

- ç‰¹æ®Šæ€§è´¨ $\texttt{P}:$ ä¿è¯åªå­˜åœ¨å‡ºç°å±…æ°‘çš„æ“ä½œã€‚
- ç‰¹æ®Šæ€§è´¨ $\texttt{A}:$ ä¿è¯æ•´å¼ å›¾æ˜¯ä¸€æ¡é“¾ï¼Œä½†ä¸ä¿è¯ $t$ æ˜¯é“¾çš„ä¸€ç«¯ã€‚
- ç‰¹æ®Šæ€§è´¨ $\texttt{B}:$ ä¿è¯é™¤äº† $t$ ä»¥å¤–çš„æ‰€æœ‰èŠ‚ç‚¹ï¼Œéƒ½æŒ‡å‘ $t$ ã€‚


å¯¹äºæ‰€æœ‰æ•°æ®ï¼Œæ»¡è¶³ $1\le n\le 10^6; 1\le m\le 1.05\times 10^6;1\le k\le 10^6$ ã€‚ä¿è¯æ‰€æœ‰èŠ‚ç‚¹å¯ä»¥åˆ°è¾¾ $t$ã€‚

## æ ·ä¾‹ #1

### è¾“å…¥

```
7 7 4 1
2 1
3 1
4 2
5 2
6 1
7 6
3 2
7 1 2 3
```

### è¾“å‡º

```
3
3
3
4
```

# AIåˆ†æç»“æœ


### 1. é¢˜ç›®è§£è¯»ä¸ç­–ç•¥åˆæ¢  
âœ¨ **æœ¬é¢˜æ ¸å¿ƒæŒ‘æˆ˜**ï¼šåŠ¨æ€ç»´æŠ¤å±…æ°‘ç‚¹é›†åˆï¼Œåœ¨èŠ‚ç‚¹å®¹é‡é™åˆ¶ä¸‹å¿«é€Ÿè®¡ç®—æ‰€æœ‰å±…æ°‘åˆ°è¾¾ç»ˆç‚¹çš„æœ€çŸ­ç–æ•£æ—¶é—´ã€‚  

âœ¨ **æ ¸å¿ƒç®—æ³•æ ‡ç­¾**ï¼šå›¾è®ºï¼ˆBFSæœ€çŸ­è·¯ï¼‰ã€æ•°æ®ç»“æ„ï¼ˆçº¿æ®µæ ‘ï¼‰ã€è´ªå¿ƒç­–ç•¥  

ğŸ—£ï¸ **åˆæ­¥åˆ†æ**ï¼š  
> æœ¬é¢˜è¦æ±‚åŠ¨æ€å¤„ç†å±…æ°‘ç‚¹çš„å¢åˆ æ“ä½œï¼Œæ¯æ¬¡æ“ä½œåéœ€è®¡ç®—æ‰€æœ‰å±…æ°‘åˆ°è¾¾ç»ˆç‚¹ $t$ çš„æœ€çŸ­æ—¶é—´ã€‚æ ¸å¿ƒéš¾ç‚¹åœ¨äºï¼š  
> 1. **ç§»åŠ¨å†²çª**ï¼šæ¯ä¸ªèŠ‚ç‚¹åŒæ—¶åªèƒ½å®¹çº³ä¸€ä¸ªå±…æ°‘ï¼Œéœ€å¤„ç†æ’é˜Ÿç­‰å¾…é—®é¢˜ã€‚  
> 2. **åŠ¨æ€æ›´æ–°**ï¼šå±…æ°‘ç‚¹é›†åˆé¢‘ç¹å˜åŒ–ï¼Œéœ€é«˜æ•ˆç»´æŠ¤ç–æ•£æ—¶é—´ã€‚  
>  
> **è§£é¢˜æ€è·¯æ¼”è¿›**ï¼š  
> - **æš´åŠ›æ¨¡æ‹Ÿ**ï¼šç›´æ¥æ¨¡æ‹Ÿæ¯ä¸€æ­¥ç§»åŠ¨ï¼ˆæ—¶é—´å¤æ‚åº¦ $O(kn)$ï¼Œä¸å¯è¡Œï¼‰ã€‚  
> - **æœ€çŸ­è·¯é¢„å¤„ç†**ï¼šé€šè¿‡åå‘BFSè®¡ç®—æ‰€æœ‰èŠ‚ç‚¹åˆ° $t$ çš„æœ€çŸ­è·ç¦» $dist$ã€‚  
> - **ä¼˜åŒ–ç­–ç•¥**ï¼šå°†é—®é¢˜è½¬åŒ–ä¸ºå¯¹ $dist$ çš„æ’åºå’Œè®¡æ•°ï¼Œåˆ©ç”¨çº¿æ®µæ ‘åŠ¨æ€ç»´æŠ¤ç­”æ¡ˆã€‚  
>  
> **æ ¸å¿ƒç®—æ³•é€‰æ‹©**ï¼š  
> çº¿æ®µæ ‘å¦‚åŒä¸€ä¸ªã€Œæ™ºèƒ½è°ƒåº¦å‘˜ã€ï¼ŒåŠ¨æ€ç®¡ç†å±…æ°‘çš„ã€Œæ’é˜Ÿæ—¶é—´è¡¨ã€ã€‚å±…æ°‘æŒ‰ $dist$ å¤§å°æ’é˜Ÿï¼Œ$dist$ è¶Šå¤§è€…ç­‰å¾…æ—¶é—´è¶Šé•¿ï¼Œæœ€ç»ˆç­”æ¡ˆç”±ã€Œæœ€è¿œè·ç¦» + æ’é˜Ÿåæ¬¡ã€å†³å®šã€‚  

### ğŸ” ç®—æ³•ä¾¦æ¢ï¼šå¦‚ä½•åœ¨é¢˜ç›®ä¸­å‘ç°çº¿ç´¢ï¼Ÿ  
1. **çº¿ç´¢1ï¼ˆé—®é¢˜ç›®æ ‡ï¼‰**ï¼š  
   _"åŠ¨æ€è®¡ç®—å¤šä¸ªå±…æ°‘åˆ°è¾¾ç»ˆç‚¹çš„æœ€çŸ­æ—¶é—´ï¼Œè¦æ±‚æ»¡è¶³èŠ‚ç‚¹å®¹é‡é™åˆ¶"_ â†’ æŒ‡å‘**é«˜æ•ˆæ•°æ®ç»“æ„**ï¼ˆçº¿æ®µæ ‘/å¹³è¡¡æ ‘ï¼‰ç»´æŠ¤åŠ¨æ€é›†åˆã€‚  
2. **çº¿ç´¢2ï¼ˆé—®é¢˜ç‰¹æ€§ï¼‰**ï¼š  
   _"å±…æ°‘ç§»åŠ¨å­˜åœ¨ä¾èµ–å…³ç³»ï¼ˆèŠ‚ç‚¹å®¹é‡é™åˆ¶ï¼‰"_ â†’ éœ€å¤„ç†**æ’é˜Ÿæ¨¡å‹**ï¼Œå°†é—®é¢˜è½¬åŒ–ä¸º $dist$ çš„æ’åºä¸è®¡æ•°ï¼ˆåˆ†ç»„èƒŒåŒ…æ€æƒ³ï¼‰ã€‚  
3. **çº¿ç´¢3ï¼ˆæ•°æ®è§„æ¨¡ï¼‰**ï¼š  
   _"$n, k \leq 10^6$"_ â†’ æ’é™¤ $O(n^2)$ æš´åŠ›ï¼Œè¦æ±‚ $O(k \log n)$ ç®—æ³•ï¼Œ**çº¿æ®µæ ‘**æ˜¯ç†æƒ³é€‰æ‹©ã€‚  

### ğŸ§  æ€ç»´é“¾æ„å»ºï¼šä»çº¿ç´¢åˆ°ç­–ç•¥  
> 1. **çº¿ç´¢1**æš—ç¤ºéœ€è¦åŠ¨æ€ç»´æŠ¤å±…æ°‘ä¿¡æ¯ï¼Œæˆ‘ä»¬æƒ³åˆ°çº¿æ®µæ ‘å¯é«˜æ•ˆæ”¯æŒæ’å…¥/åˆ é™¤å’ŒåŒºé—´æŸ¥è¯¢ã€‚  
> 2. **çº¿ç´¢2**æ­ç¤ºå±…æ°‘ç§»åŠ¨çš„æ’é˜Ÿæœ¬è´¨ï¼š$dist$ è¶Šå¤§è€…éœ€æ›´æ—©å‡ºå‘ï¼ˆæ€è·¯ä¸€ï¼‰ï¼Œæˆ–ç­‰å¾…æ—¶é—´ä¸å…¶æ’åç›¸å…³ï¼ˆæ€è·¯äºŒï¼‰ã€‚  
> 3. **çº¿ç´¢3**ç¡®è®¤çº¿æ®µæ ‘çš„å¯è¡Œæ€§â€”â€”$O(\log n)$ æ“ä½œå®Œå…¨æ»¡è¶³æ•°æ®è§„æ¨¡ã€‚  
>  
> **ç»“è®º**ï¼šç”¨çº¿æ®µæ ‘ç»´æŠ¤å±…æ°‘ $dist$ ä¿¡æ¯ï¼ŒæŒ‰æ€è·¯äºŒï¼ˆ$dist + rank$ æ¨¡å‹ï¼‰å®ç°åŠ¨æ€æ›´æ–°ï¼Œç­”æ¡ˆå³å…¨å±€æœ€å¤§å€¼ã€‚  

---

### 2. ç²¾é€‰ä¼˜è´¨é¢˜è§£å‚è€ƒ  
**é¢˜è§£ä¸€ï¼ˆå›§ä»™ï¼‰**ï¼š  
* **äº®ç‚¹**ï¼šåˆ›æ–°æ€§æå‡ºã€Œæ—¶é—´è½´æ’å…¥ã€æ¨¡å‹ï¼Œç”¨çº¿æ®µæ ‘äºŒåˆ†æŸ¥æ‰¾ç©ºé—²ä½ç½®ã€‚ä»£ç ä¸¥è°¨å¤„ç†æ‡’æ ‡è®°å’Œè¾¹ç•Œæ¡ä»¶ï¼Œè™½å®ç°å¤æ‚ä½†æ€ç»´æ·±åˆ»ã€‚  
* **å­¦ä¹ ä»·å€¼**ï¼šå±•ç¤ºäº†å¦‚ä½•å°†æŠ½è±¡æ’é˜Ÿé—®é¢˜è½¬åŒ–ä¸ºæ•°æ®ç»“æ„æ“ä½œï¼Œé€‚åˆé«˜é˜¶å­¦ä¹ è€…æŒ‘æˆ˜ã€‚  

**é¢˜è§£äºŒï¼ˆKarl_Auroraï¼‰**ï¼š  
* **äº®ç‚¹**ï¼šé‡‡ç”¨æ›´ç›´è§‚çš„ã€Œ$dist + rank$ã€æ¨¡å‹ï¼Œå€¼åŸŸçº¿æ®µæ ‘ç»´æŠ¤å‰ç¼€å’Œã€‚ä»£ç ç®€æ´æ¸…æ™°ï¼Œå·§å¦™åˆ©ç”¨çº¿æ®µæ ‘æ±‚å…¨å±€æœ€å¤§å€¼ã€‚  
* **å­¦ä¹ ä»·å€¼**ï¼šå¹³è¡¡ç†è®ºä¸å®ç°ï¼Œæ˜¯æŒæ¡çº¿æ®µæ ‘åŠ¨æ€ç»´æŠ¤æŠ€å·§çš„å…¸èŒƒã€‚  

**é¢˜è§£ä¸‰ï¼ˆ_Cheemsï¼‰**ï¼š  
* **äº®ç‚¹**ï¼šç”¨ `set` è¾…åŠ©ç»´æŠ¤ $dist$ é›†åˆï¼Œå‡å°‘çº¿æ®µæ ‘æ“ä½œæ¬¡æ•°ã€‚ä»£ç çŸ­å°ç²¾æ‚ï¼Œé€‚åˆç«èµ›å¿«é€Ÿç¼–ç ã€‚  
* **å­¦ä¹ ä»·å€¼**ï¼šå±•ç¤ºæ•°æ®ç»“æ„ç»„åˆä¼˜åŒ–æŠ€å·§ï¼Œä½†éœ€æ³¨æ„ `set` å¯èƒ½å¢åŠ å¸¸æ•°å› å­ã€‚  

---

### 3. è§£é¢˜ç­–ç•¥æ·±åº¦å‰–æ  
#### ğŸ¯ æ ¸å¿ƒéš¾ç‚¹ä¸å…³é”®æ­¥éª¤  
1. **æœ€çŸ­è·¯é¢„å¤„ç†**ï¼š  
   * **åˆ†æ**ï¼šåå‘å»ºå›¾åä» $t$ å¼€å§‹BFSï¼Œè®¡ç®—æ¯ä¸ªèŠ‚ç‚¹ $u$ åˆ° $t$ çš„æœ€çŸ­è·ç¦» $dist[u]$ã€‚  
   * ğŸ’¡ **å­¦ä¹ ç¬”è®°**ï¼šåå‘BFSæ˜¯å¤„ç†ç»ˆç‚¹å›ºå®šçš„æœ€çŸ­è·¯å¾„é—®é¢˜çš„æ ‡å‡†æŠ€å·§ã€‚  

2. **çº¿æ®µæ ‘åŠ¨æ€ç»´æŠ¤**ï¼š  
   * **åˆ†æ**ï¼š  
     - æ¯ä¸ªå±…æ°‘å½±å“å…¶ $dist$ åŠæ›´å°å€¼çš„æ’åï¼ˆ$rank$ï¼‰ã€‚  
     - æ’å…¥æ—¶ï¼šè‹¥ $dist$ é¦–æ¬¡å‡ºç°ï¼Œçº¿æ®µæ ‘è¯¥ä½ç½® $+dist$ï¼›æ‰€æœ‰ $\leq dist$ çš„ä½ç½® $+1$ï¼ˆæ›´æ–°æ’åï¼‰ã€‚  
     - åˆ é™¤æ—¶ï¼šè‹¥ $dist$ å½’é›¶ï¼Œè¯¥ä½ç½® $-dist$ï¼›æ‰€æœ‰ $\leq dist$ çš„ä½ç½® $-1$ã€‚  
   * ğŸ’¡ **å­¦ä¹ ç¬”è®°**ï¼šçº¿æ®µæ ‘ç»´æŠ¤åŒºé—´åŠ å‡å’Œå…¨å±€æœ€å¤§å€¼ï¼Œå®Œç¾åŒ¹é…åŠ¨æ€æ’åæ¨¡å‹ã€‚  

3. **ç­”æ¡ˆè®¡ç®—**ï¼š  
   * **åˆ†æ**ï¼šç­”æ¡ˆ = çº¿æ®µæ ‘å…¨å±€æœ€å¤§å€¼ $-1$ï¼ˆè¿›å…¥ç»“ç•Œè€—æ—¶ï¼‰ã€‚  
   * ğŸ’¡ **å­¦ä¹ ç¬”è®°**ï¼šæœ€å¤§å€¼ä½ç½®å¯¹åº”ã€Œæœ€è¿œå±…æ°‘ $dist$ + æœ€é•¿ç­‰å¾…æ—¶é—´ã€ã€‚  

#### âœ¨ è§£é¢˜æŠ€å·§æ€»ç»“  
- **æŠ€å·§1ï¼ˆé—®é¢˜è½¬åŒ–ï¼‰**ï¼šå°†å¤æ‚ç§»åŠ¨è§„åˆ™è½¬åŒ–ä¸º $dist$ æ’åºé—®é¢˜ï¼Œé¿å…æ¨¡æ‹Ÿå†²çªã€‚  
- **æŠ€å·§2ï¼ˆæ•°æ®ç»“æ„é€‰æ‹©ï¼‰**ï¼šå€¼åŸŸçº¿æ®µæ ‘å¤„ç†å‰ç¼€å’ŒåŠ¨æ€æ›´æ–°ã€‚  
- **æŠ€å·§3ï¼ˆé€†å‘æ€ç»´ï¼‰**ï¼šåå‘BFSé¢„å¤„ç†æœ€çŸ­è·¯ï¼Œç®€åŒ–åç»­æ“ä½œã€‚  

#### âš”ï¸ ç­–ç•¥ç«æŠ€åœº  
| ç­–ç•¥                | æ ¸å¿ƒæ€æƒ³                     | ä¼˜ç‚¹                     | ç¼ºç‚¹                     | å¾—åˆ†é¢„æœŸ   |  
|---------------------|----------------------------|--------------------------|--------------------------|------------|  
| **æš´åŠ›æ¨¡æ‹Ÿ**        | é€æ­¥æ¨¡æ‹Ÿå±…æ°‘ç§»åŠ¨           | ç›´è§‚æ˜“æ‡‚                 | $O(kn)$ è¶…æ—¶            | 0%         |  
| **$dist$ æ—¶é—´è½´**   | å‘åæ’å…¥ç©ºé—²ä½ç½®           | ç²¾ç¡®å¤„ç†å†²çª             | çº¿æ®µæ ‘å®ç°å¤æ‚           | 100%       |  
| **$dist + rank$**   | æŒ‰ $dist$ æ’åè®¡ç®—ç­‰å¾…æ—¶é—´ | ä»£ç ç®€æ´ï¼Œ$O(k \log n)$ | ç†è§£ç¨æœ‰é—¨æ§›             | 100%       |  

#### âœ¨ ä¼˜åŒ–ä¹‹æ—…  
1. **èµ·ç‚¹ï¼šæš´åŠ›æ¨¡æ‹Ÿçš„å›°å¢ƒ**  
   ç›´æ¥æ¨¡æ‹Ÿç§»åŠ¨éœ€å¤„ç†æ¯ä¸€æ­¥å†²çªï¼Œè®¡ç®—é‡æŒ‡æ•°çº§å¢é•¿ã€‚  
2. **å‘ç°ç“¶é¢ˆï¼šé‡å¤å†³ç­–**  
   å±…æ°‘ç§»åŠ¨ç‹¬ç«‹ä¸”è·¯å¾„å›ºå®šï¼Œå†²çªä»…ç”± $dist$ å’Œæ•°é‡å†³å®šã€‚  
3. **ä¼˜åŒ–é’¥åŒ™ï¼š$dist$ æ’åºæ¨¡å‹**  
   å°†å±…æ°‘æŒ‰ $dist$ åˆ†ç»„ï¼Œç­‰å¾…æ—¶é—´ç”±æ’åå†³å®šï¼Œé¿å…é€æ­¥æ¨¡æ‹Ÿã€‚  
4. **æ•°æ®ç»“æ„å‡åï¼šçº¿æ®µæ ‘**  
   åŠ¨æ€ç»´æŠ¤ $dist$ çš„æ’åå˜åŒ–ï¼Œå®ç°é«˜æ•ˆæ›´æ–°å’ŒæŸ¥è¯¢ã€‚  

ğŸ’¡ **ç­–ç•¥æ€»ç»“**ï¼š  
> â€œä»æš´åŠ›æ¨¡æ‹Ÿåˆ° $dist+rank$ æ¨¡å‹ï¼Œæˆ‘ä»¬é€šè¿‡**é—®é¢˜è½¬åŒ–**å’Œ**æ•°æ®ç»“æ„ä¼˜åŒ–**ï¼Œå°†æŒ‡æ•°çº§å¤æ‚åº¦é™ä¸º $O(k \log n)$ã€‚è¿™å¯ç¤ºæˆ‘ä»¬ï¼šå¤æ‚çº¦æŸé—®é¢˜å¸¸è•´å«ç®€æ´æ•°å­¦æ¨¡å‹ï¼Œæ‰¾åˆ°å®ƒå°±èƒ½æ‰“å¼€é«˜æ•ˆç®—æ³•ä¹‹é—¨ã€‚â€  

---

### 4. C++æ ¸å¿ƒä»£ç å®ç°èµæ  
**é€šç”¨æ ¸å¿ƒå®ç°**ï¼ˆåŸºäºæ€è·¯äºŒï¼‰ï¼š  
```cpp
#include <bits/stdc++.h>
using namespace std;
const int maxn = 1.05e6 + 5;

vector<int> G[maxn]; // åå‘å›¾
int dist[maxn], n, m, k, t;

struct SegmentTree {
    int tree[maxn<<2], tag[maxn<<2];
    void push_up(int u) { tree[u] = max(tree[u<<1], tree[u<<1|1]); }
    void push_down(int u) {
        if (!tag[u]) return;
        tree[u<<1] += tag[u]; tree[u<<1|1] += tag[u];
        tag[u<<1] += tag[u]; tag[u<<1|1] += tag[u];
        tag[u] = 0;
    }
    void update(int u, int l, int r, int L, int R, int val) {
        if (L <= l && r <= R) {
            tree[u] += val; tag[u] += val; return;
        }
        push_down(u);
        int mid = (l + r) >> 1;
        if (L <= mid) update(u<<1, l, mid, L, R, val);
        if (R > mid) update(u<<1|1, mid+1, r, L, R, val);
        push_up(u);
    }
} seg;

int main() {
    // è¾“å…¥å›¾æ•°æ® & åå‘BFSè®¡ç®—dist
    cin >> n >> m >> k >> t;
    for (int i = 0; i < m; i++) {
        int u, v; cin >> u >> v;
        G[v].push_back(u); // åå‘è¾¹
    }
    queue<int> q;
    memset(dist, -1, sizeof(dist));
    dist[t] = 0; q.push(t);
    while (!q.empty()) {
        int u = q.front(); q.pop();
        for (int v : G[u]) {
            if (dist[v] == -1) {
                dist[v] = dist[u] + 1;
                q.push(v);
            }
        }
    }

    // åˆå§‹åŒ–çº¿æ®µæ ‘ï¼šä½ç½®iåˆå§‹å€¼ä¸ºi
    // åŠ¨æ€ç»´æŠ¤å±…æ°‘é›†åˆ
    vector<int> cnt(n+1, 0);   // æ¯ä¸ªdistçš„å±…æ°‘æ•°
    vector<bool> active(n+1, false); // èŠ‚ç‚¹æ˜¯å¦æœ‰å±…æ°‘
    while (k--) {
        int x; cin >> x;
        int d = dist[x];
        if (active[x]) { // åˆ é™¤å±…æ°‘
            active[x] = false;
            cnt[d]--;
            seg.update(1, 1, n, 1, d, -1); // æ’åå‡å°‘
            if (cnt[d] == 0) // è‹¥distæ— å±…æ°‘ï¼Œè¯¥ä½ç½®æ¢å¤åˆå§‹å€¼
                seg.update(1, 1, n, d, d, -d);
        } else { // æ·»åŠ å±…æ°‘
            active[x] = true;
            cnt[d]++;
            if (cnt[d] == 1) // è‹¥disté¦–æ¬¡å‡ºç°ï¼ŒåŠ ä¸Šdistå€¼
                seg.update(1, 1, n, d, d, d);
            seg.update(1, 1, n, 1, d, 1); // æ’åå¢åŠ 
        }
        cout << seg.tree[1] - 1 << endl; // ç­”æ¡ˆ=æœ€å¤§å€¼-1
    }
    return 0;
}
```
**ä»£ç è§£è¯»æ¦‚è¦**ï¼š  
1. **åå‘BFS**ï¼šä»ç»ˆç‚¹ $t$ å‡ºå‘è®¡ç®—æœ€çŸ­è·ç¦» $dist$ã€‚  
2. **çº¿æ®µæ ‘æ“ä½œ**ï¼š  
   - **æ’å…¥**ï¼šè‹¥ $dist$ é¦–æ¬¡å‡ºç°ï¼Œè¯¥ä½ç½® $+dist$ï¼›æ‰€æœ‰ $\leq dist$ ä½ç½® $+1$ï¼ˆå¢åŠ æ’åï¼‰ã€‚  
   - **åˆ é™¤**ï¼šè‹¥ $dist$ å½’é›¶ï¼Œè¯¥ä½ç½® $-dist$ï¼›æ‰€æœ‰ $\leq dist$ ä½ç½® $-1$ã€‚  
3. **ç­”æ¡ˆè®¡ç®—**ï¼šå…¨å±€æœ€å¤§å€¼ $-1$ å³ä¸ºæœ€çŸ­ç–æ•£æ—¶é—´ã€‚  

---

### 5. ç®—æ³•å¯è§†åŒ–ï¼šåƒç´ åŠ¨ç”»æ¼”ç¤º  
**ä¸»é¢˜**ï¼š`ã€Œåƒç´ å±…æ°‘å¤§è¿å¾™ã€`ï¼ˆå¤å¤8-bité£æ ¼ï¼‰  
**æ ¸å¿ƒæ¼”ç¤ºå†…å®¹**ï¼š  
1. **åœºæ™¯è®¾è®¡**ï¼š  
   - åƒç´ ç½‘æ ¼è¡¨ç¤ºæœ‰å‘å›¾ï¼Œç»ˆç‚¹ $t$ ä¸ºç¥ç¤¾ï¼ˆå‘å…‰åƒç´ ï¼‰ã€‚  
   - å±…æ°‘æ˜¾ç¤ºä¸ºä¸åŒé¢œè‰²åƒç´ å—ï¼Œ$dist$ å€¼æ ‡æ³¨åœ¨èŠ‚ç‚¹ä¸‹æ–¹ã€‚  
2. **åŠ¨æ€è¿‡ç¨‹**ï¼š  
   - **æ·»åŠ å±…æ°‘**ï¼šæ–°åƒç´ å—å‡ºç°ï¼Œçº¿æ®µæ ‘å¯¹åº”ä½ç½®äº®èµ·ã€‚  
   - **ç§»åŠ¨æ¨¡æ‹Ÿ**ï¼šå±…æ°‘æ²¿æœ€çŸ­è·¯è·³è·ƒå‰è¿›ï¼Œé‡åˆ°å†²çªæ—¶æ˜¾ç¤ºç­‰å¾…åŠ¨ç”»ï¼ˆé—ªçƒæ•ˆæœï¼‰ã€‚  
   - **è¿›å…¥ç¥ç¤¾**ï¼šå±…æ°‘åˆ°è¾¾ $t$ åæ¶ˆå¤±ï¼ŒéŸ³æ•ˆæç¤ºã€‚  
3. **æ•°æ®ç»“æ„åŒæ­¥**ï¼š  
   - å³ä¾§æ˜¾ç¤ºçº¿æ®µæ ‘ç»“æ„ï¼Œæ›´æ–°æ—¶é«˜äº®è·¯å¾„ã€‚  
   - å…¨å±€æœ€å¤§å€¼å®æ—¶æ ‡æ³¨ï¼Œå˜åŒ–æ—¶æ’­æ”¾éŸ³æ•ˆã€‚  

**äº¤äº’æ§åˆ¶**ï¼š  
- **æ­¥è¿›/æš‚åœ**ï¼šå•æ­¥è§‚å¯Ÿç§»åŠ¨å’Œçº¿æ®µæ ‘æ›´æ–°ã€‚  
- **é€Ÿåº¦æ»‘å—**ï¼šè°ƒèŠ‚ç§»åŠ¨é€Ÿåº¦ï¼ˆ0.5x~5xï¼‰ã€‚  
- **AIæ¼”ç¤ºæ¨¡å¼**ï¼šè‡ªåŠ¨å®Œæˆå½“å‰å±…æ°‘é›†åˆçš„ç–æ•£ã€‚  

**æ¸¸æˆåŒ–è®¾è®¡**ï¼š  
- **å…³å¡æœºåˆ¶**ï¼šæ¯å®Œæˆä¸€ç»„å±…æ°‘ç–æ•£è§†ä¸ºé€šå…³ï¼Œè§£é”æ›´å¤æ‚åœ°å›¾ã€‚  
- **éŸ³æ•ˆç³»ç»Ÿ**ï¼š  
  - ç§»åŠ¨ï¼š8-bitè„šæ­¥å£°ã€‚  
  - å†²çªï¼šè­¦å‘ŠéŸ³ã€‚  
  - é€šå…³ï¼šèƒœåˆ©æ—‹å¾‹ã€‚  

---

### 6. æ‹“å±•ç»ƒä¹ ä¸ç›¸ä¼¼é—®é¢˜  
**é€šç”¨æŠ€å·§è¿ç§»**ï¼š  
1. **ä¾èµ–å…³ç³»å¤„ç†**ï¼šåˆ†ç»„èƒŒåŒ…é—®é¢˜ï¼ˆå¦‚é™„ä»¶ä¾èµ–ä¸»ä»¶ï¼‰ã€‚  
2. **åŠ¨æ€æ’åç»´æŠ¤**ï¼šæ±‚åŠ¨æ€é›†åˆçš„ç¬¬Kå¤§å€¼ï¼ˆçº¿æ®µæ ‘/æ ‘çŠ¶æ•°ç»„ï¼‰ã€‚  
3. **æœ€çŸ­è·¯+æ•°æ®ç»“æ„**ï¼šå¸¦é™åˆ¶çš„æœ€çŸ­è·¯å¾„é—®é¢˜ã€‚  

**æ´›è°·ç»ƒä¹ æ¨è**ï¼š  
1. **P1064 [NOIP2006 æé«˜ç»„] é‡‘æ˜çš„é¢„ç®—æ–¹æ¡ˆ**  
   â†’ å·©å›ºã€Œä¾èµ–å…³ç³»è½¬åŒ–ä¸ºåˆ†ç»„èƒŒåŒ…ã€æŠ€å·§ã€‚  
2. **P1541 [NOIP2010 æé«˜ç»„] ä¹Œé¾Ÿæ£‹**  
   â†’ ç»ƒä¹ åŠ¨æ€ç»´æŠ¤å¤šç»´åº¦çŠ¶æ€ã€‚  
3. **P4017 æœ€å¤§é£Ÿç‰©é“¾è®¡æ•°**  
   â†’ æ‹“æ‰‘æ’åº+DAGåŠ¨æ€è§„åˆ’ï¼Œå¼ºåŒ–åå‘å»ºå›¾æ€ç»´ã€‚  

---

### 7. å­¦ä¹ å¿ƒå¾—ä¸ç»éªŒåˆ†äº«  
**æ¥è‡ªé¢˜è§£ä½œè€…çš„è°ƒè¯•ç»éªŒ**ï¼š  
> _â€œåˆå§‹ä»£ç æœªå¤„ç† $dist=0$ï¼ˆç»ˆç‚¹ï¼‰çš„æƒ…å†µï¼Œå¯¼è‡´çº¿æ®µæ ‘æ›´æ–°é”™è¯¯ã€‚é€šè¿‡æ‰“å° $dist$ åˆ†å¸ƒå’Œæ ‘ç»“æ„å¿«é€Ÿå®šä½é—®é¢˜ã€‚â€_  

ğŸ’¡ **æ´›è¯­äº‘ç¬ºç‚¹è¯„**ï¼š  
> è°ƒè¯•æ—¶é‡ç‚¹å…³æ³¨**è¾¹ç•Œå€¼**ï¼ˆå¦‚ $dist=0$ï¼‰å’Œ**æ•°æ®ç»“æ„åˆå§‹çŠ¶æ€**ï¼Œä½¿ç”¨ä¸­é—´è¾“å‡ºæ¯”æ–­ç‚¹æ›´é«˜æ•ˆã€‚  

---

<conclusion>  
**ç»“è¯­**ï¼š  
é€šè¿‡ã€Œæœˆé¢æˆ˜äº‰ã€è¿™é“é¢˜ï¼Œæˆ‘ä»¬å­¦ä¹ äº†å¦‚ä½•å°†å¤æ‚ç§»åŠ¨è§„åˆ™è½¬åŒ–ä¸º $dist$ æ’åºæ¨¡å‹ï¼Œå¹¶ç”¨çº¿æ®µæ ‘åŠ¨æ€ç»´æŠ¤ç­”æ¡ˆã€‚è®°ä½ï¼š  
1. åå‘BFSæ˜¯å¤„ç†å›ºå®šç»ˆç‚¹çš„æœ€çŸ­è·¯å¾„åˆ©å™¨ï¼›  
2. é‡åˆ°åŠ¨æ€é›†åˆç»´æŠ¤ï¼Œä¼˜å…ˆè€ƒè™‘çº¿æ®µæ ‘/æ ‘çŠ¶æ•°ç»„ï¼›  
3. è°ƒè¯•æ—¶ä»è¾¹ç•Œæƒ…å†µå’Œæ•°æ®ç»“æ„åˆå§‹çŠ¶æ€å…¥æ‰‹ã€‚  
ä¿æŒæ€è€ƒï¼Œå‹‡æ”€ç®—æ³•é«˜å³°ï¼ğŸš€  
</conclusion>

---
å¤„ç†ç”¨æ—¶ï¼š209.02ç§’
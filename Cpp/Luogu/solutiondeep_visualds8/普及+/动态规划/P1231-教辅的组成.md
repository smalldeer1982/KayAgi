# é¢˜ç›®ä¿¡æ¯

# æ•™è¾…çš„ç»„æˆ

## é¢˜ç›®èƒŒæ™¯

æ»šç²—äº†çš„ HansBug åœ¨æ”¶æ‹¾æ—§è¯­æ–‡ä¹¦ï¼Œç„¶è€Œä»–å‘ç°äº†ä»€ä¹ˆå¥‡å¦™çš„ä¸œè¥¿ã€‚


## é¢˜ç›®æè¿°

è’Ÿè’» HansBug åœ¨ä¸€æœ¬è¯­æ–‡ä¹¦é‡Œé¢å‘ç°äº†ä¸€æœ¬ç­”æ¡ˆï¼Œç„¶è€Œä»–å´æ˜æ˜è®°å¾—è¿™ä¹¦åº”è¯¥è¿˜åŒ…å«ä¸€ä»½ç»ƒä¹ é¢˜ã€‚ç„¶è€Œå‡ºç°åœ¨ä»–çœ¼å‰çš„ä¹¦å¤šå¾—æ•°ä¸èƒœæ•°ï¼Œå…¶ä¸­æœ‰ä¹¦ï¼Œæœ‰ç­”æ¡ˆï¼Œæœ‰ç»ƒä¹ å†Œã€‚å·²çŸ¥ä¸€ä¸ªå®Œæ•´çš„ä¹¦å†Œå‡åº”è¯¥åŒ…å«ä¸”ä»…åŒ…å«ä¸€æœ¬ä¹¦ã€ä¸€æœ¬ç»ƒä¹ å†Œå’Œä¸€ä»½ç­”æ¡ˆï¼Œç„¶è€Œç°åœ¨å…¨éƒ½ä¹±åšäº†ä¸€å›¢ã€‚è®¸å¤šä¹¦ä¸Šé¢çš„å­—è¿¹éƒ½å·²ç»æ¨¡ç³Šäº†ï¼Œç„¶è€Œ HansBug è¿˜æ˜¯å¯ä»¥å¤§è‡´åˆ¤æ–­è¿™æ˜¯ä¸€æœ¬ä¹¦è¿˜æ˜¯ç»ƒä¹ å†Œæˆ–ç­”æ¡ˆï¼Œå¹¶ä¸”èƒ½å¤Ÿå¤§è‡´çŸ¥é“ä¸€æœ¬ä¹¦å’Œç­”æ¡ˆä»¥åŠä¸€æœ¬ä¹¦å’Œç»ƒä¹ å†Œçš„å¯¹åº”å…³ç³»ï¼ˆå³ä»…ä»…çŸ¥é“æŸä¹¦å’ŒæŸç­”æ¡ˆã€æŸä¹¦å’ŒæŸç»ƒä¹ å†Œæœ‰å¯èƒ½ç›¸å¯¹åº”ï¼Œé™¤æ­¤ä»¥å¤–çš„å‡ä¸å¯èƒ½å¯¹åº”ï¼‰ã€‚æ—¢ç„¶å¦‚æ­¤ï¼ŒHansBug æƒ³çŸ¥é“åœ¨è¿™æ ·çš„æƒ…å†µä¸‹ï¼Œæœ€å¤šå¯èƒ½åŒæ—¶ç»„åˆæˆå¤šå°‘ä¸ªå®Œæ•´çš„ä¹¦å†Œã€‚



## è¯´æ˜/æç¤º

æ ·ä¾‹è¯´æ˜ï¼š

å¦‚é¢˜ï¼Œ$N_1=5$ï¼Œ$N_2=3$ï¼Œ$N_3=4$ï¼Œè¡¨ç¤ºä¹¦æœ‰ $5$ æœ¬ã€ç»ƒä¹ å†Œæœ‰ $3$ æœ¬ã€ç­”æ¡ˆæœ‰ $4$ æœ¬ã€‚

$M_1=5$ï¼Œè¡¨ç¤ºä¹¦å’Œç»ƒä¹ å†Œå…±æœ‰ $5$ ä¸ªå¯èƒ½çš„å¯¹åº”å…³ç³»ï¼Œåˆ†åˆ«ä¸ºï¼šä¹¦ $4$ å’Œç»ƒä¹ å†Œ $3$ ã€ä¹¦ $2$ å’Œç»ƒä¹ å†Œ $2$ ã€ä¹¦ $5$ å’Œç»ƒä¹ å†Œ $2$ ã€ä¹¦ $5$ å’Œç»ƒä¹ å†Œ $1$ ä»¥åŠä¹¦ $5$ å’Œç»ƒä¹ å†Œ $3$ã€‚

$M_2=5$ï¼Œè¡¨ç¤ºæ•°å’Œç­”æ¡ˆå…±æœ‰ $5$ ä¸ªå¯èƒ½çš„å¯¹åº”å…³ç³»ï¼Œåˆ†åˆ«ä¸ºï¼šä¹¦ $1$ å’Œç­”æ¡ˆ $3$ã€ä¹¦ $3$ å’Œç­”æ¡ˆ $1$ã€ä¹¦ $2$ å’Œç­”æ¡ˆ $2$ã€ä¹¦ $3$ å’Œç­”æ¡ˆ $3$ ä»¥åŠä¹¦ $4$ å’Œç­”æ¡ˆ $3$ã€‚

æ‰€ä»¥ï¼Œä»¥ä¸Šæƒ…å†µçš„è¯æœ€å¤šå¯ä»¥åŒæ—¶é…æˆä¸¤ä¸ªä¹¦å†Œï¼Œåˆ†åˆ«ä¸ºï¼šä¹¦ $2$ ç»ƒä¹ å†Œ $2$ ç­”æ¡ˆ $2$ã€ä¹¦ $4$ ç»ƒä¹ å†Œ $3$ ç­”æ¡ˆ $3$ã€‚


æ•°æ®è§„æ¨¡ï¼š

![](https://cdn.luogu.com.cn/upload/image_hosting/srj2v9um.png)

å¯¹äºæ•°æ®ç‚¹ $1,2,3$ï¼Œ$1\le M_1,M_2\leq 20$ã€‚

å¯¹äºæ•°æ®ç‚¹ $4\sim 10$ï¼Œ$1\le M_1,M_2 \leq 20000$ã€‚


## æ ·ä¾‹ #1

### è¾“å…¥

```
5 3 4
5
4 3
2 2
5 2
5 1
5 3
5
1 3
3 1
2 2
3 3
4 3
```

### è¾“å‡º

```
2```

# AIåˆ†æç»“æœ

# ğŸ’¡ æ´›è¯­äº‘ç¬ºçš„C++ç®—æ³•è§£æï¼šæ•™è¾…çš„ç»„æˆ æ·±å…¥å­¦ä¹ æŒ‡å— ğŸ’¡

> ä»Šå¤©æˆ‘ä»¬æ¥ä¸€èµ·åˆ†æã€Œæ•™è¾…çš„ç»„æˆã€è¿™é“C++ç¼–ç¨‹é¢˜ã€‚å®ƒä¸ä»…è€ƒå¯Ÿç½‘ç»œæµå»ºæ¨¡ï¼Œè¿˜å·§å¦™åœ°è¿ç”¨äº†ã€Œæ‹†ç‚¹ã€æŠ€å·§ã€‚è®©æˆ‘ä»¬åƒä¾¦æ¢ä¸€æ ·ï¼Œä»é¢˜ç›®ä¸­å¯»æ‰¾çº¿ç´¢ï¼Œä¸€æ­¥æ­¥æ„å»ºå‡ºæœ€ä¼˜çš„è§£é¢˜ç­–ç•¥ï¼

---

## 1. é¢˜ç›®è§£è¯»ä¸ç­–ç•¥åˆæ¢

**âœ¨ æœ¬é¢˜æ ¸å¿ƒæŒ‘æˆ˜**ï¼š  
> åœ¨ã€Œä¹¦-ç»ƒä¹ å†Œ-ç­”æ¡ˆã€ä¸‰ç§ç‰©å“æ„æˆçš„ä¸‰åˆ†å›¾ä¸­ï¼Œ**æ¯æœ¬ä¹¦åªèƒ½è¢«ä½¿ç”¨ä¸€æ¬¡**ï¼Œæ±‚**æœ€å¤š**èƒ½ç»„æˆå¤šå°‘å¥—å®Œæ•´çš„ã€Œä¹¦+ç»ƒä¹ å†Œ+ç­”æ¡ˆã€ä¸‰ä»¶å¥—ã€‚

**âœ¨ æ ¸å¿ƒç®—æ³•æ ‡ç­¾**ï¼šç½‘ç»œæµï¼ˆæœ€å¤§æµï¼‰ã€æ‹†ç‚¹ã€ä¸‰åˆ†å›¾åŒ¹é…

---

### ğŸ” ç®—æ³•ä¾¦æ¢ï¼šå¦‚ä½•åœ¨é¢˜ç›®ä¸­å‘ç°çº¿ç´¢ï¼Ÿ

| çº¿ç´¢ç¼–å· | å…³é”®è§‚å¯Ÿ | å¯¹åº”ç­–ç•¥ |
| --- | --- | --- |
| **çº¿ç´¢1** | ã€Œæœ€å¤šèƒ½ç»„æˆå¤šå°‘å¥—ã€ â†’ **æœ€ä¼˜åŒ–é—®é¢˜** | ç½‘ç»œæµä¸­çš„**æœ€å¤§æµæ¨¡å‹** |
| **çº¿ç´¢2** | ã€Œæ¯æœ¬ä¹¦åªèƒ½è¢«ä½¿ç”¨ä¸€æ¬¡ã€ â†’ **ç‚¹å®¹é‡é™åˆ¶** | **æ‹†ç‚¹**ï¼šå°†æ¯æœ¬ä¹¦æ‹†æˆã€Œå…¥ç‚¹ã€å’Œã€Œå‡ºç‚¹ã€ï¼Œä¸­é—´è¿å®¹é‡ä¸º1çš„è¾¹ |
| **çº¿ç´¢3** | ã€Œä¹¦-ç»ƒä¹ å†Œ-ç­”æ¡ˆã€ä¸‰å±‚å…³ç³» â†’ **ä¸‰åˆ†å›¾** | æ„å»º**åˆ†å±‚å›¾**ï¼šæºç‚¹â†’ç»ƒä¹ å†Œâ†’ä¹¦â†’ç­”æ¡ˆâ†’æ±‡ç‚¹ |

---

### ğŸ§  æ€ç»´é“¾æ„å»ºï¼šä»çº¿ç´¢åˆ°ç­–ç•¥

> 1. **çº¿ç´¢1**æç¤ºæˆ‘ä»¬è¿™æ˜¯ä¸€ä¸ª**æœ€å¤§åŒ¹é…**é—®é¢˜ï¼Œè‡ªç„¶æƒ³åˆ°ç½‘ç»œæµã€‚  
> 2. **çº¿ç´¢2**æé†’æˆ‘ä»¬ï¼Œæ™®é€šç½‘ç»œæµåªèƒ½é™åˆ¶**è¾¹å®¹é‡**ï¼Œä½†æ— æ³•é™åˆ¶**ç‚¹è¢«å¤šæ¬¡ç»è¿‡**ã€‚äºæ˜¯å¼•å…¥**æ‹†ç‚¹**ï¼šæŠŠæ¯æœ¬ä¹¦æ‹†æˆä¸¤ä¸ªèŠ‚ç‚¹ï¼Œä¸­é—´è¿ä¸€æ¡å®¹é‡ä¸º1çš„è¾¹ï¼Œç¡®ä¿æ¯æœ¬ä¹¦æœ€å¤šè¢«ä½¿ç”¨ä¸€æ¬¡ã€‚  
> 3. **çº¿ç´¢3**å¸®åŠ©æˆ‘ä»¬ç”»å‡ºåˆ†å±‚å›¾ï¼š  
>   **æºç‚¹** â†’ **ç»ƒä¹ å†Œ** â†’ **ä¹¦ï¼ˆæ‹†ç‚¹ï¼‰** â†’ **ç­”æ¡ˆ** â†’ **æ±‡ç‚¹**  
>   è¿™æ ·ï¼Œä¸€æ¡ä»æºç‚¹åˆ°æ±‡ç‚¹çš„å¢å¹¿è·¯å¾„ï¼Œå°±å¯¹åº”ä¸€å¥—å®Œæ•´çš„ä¸‰ä»¶å¥—ï¼

---

## 2. ç²¾é€‰ä¼˜è´¨é¢˜è§£å‚è€ƒ

> æˆ‘ä»æ‰€æœ‰é¢˜è§£ä¸­ï¼Œç­›é€‰å‡º**3ä»½æœ€å…·å¯å‘æ€§**çš„å‚è€ƒï¼Œå¸®åŠ©ä½ ä»ã€Œå»ºæ¨¡æ€è·¯ã€åˆ°ã€Œä»£ç ç»†èŠ‚ã€å…¨é¢æŒæ¡ï¼

---

### é¢˜è§£ä¸€ï¼šSiyuanï¼ˆç½‘ç»œæµå»ºæ¨¡å…¸èŒƒï¼‰

- **äº®ç‚¹**ï¼š
  - **å»ºæ¨¡æ¸…æ™°**ï¼šç”¨`id()`å‡½æ•°ä¼˜é›…åœ°æ˜ å°„ä¸‰ç±»ç‰©å“åˆ°èŠ‚ç‚¹ç¼–å·ã€‚
  - **æ‹†ç‚¹ç²¾é«“**ï¼šå°†æ¯æœ¬ä¹¦æ‹†æˆã€Œå·¦ä¹¦ç‚¹ã€å’Œã€Œå³ä¹¦ç‚¹ã€ï¼Œä¸­é—´è¿å®¹é‡ä¸º1çš„è¾¹ï¼Œå®Œç¾è§£å†³ã€Œä¹¦è¢«é‡å¤ä½¿ç”¨ã€çš„é™·é˜±ã€‚
  - **Dinicæ¨¡æ¿**ï¼šæ ‡å‡†Dinicç®—æ³•ï¼Œæ—¶é—´å¤æ‚åº¦$O(n^2m)$ï¼Œè¶³ä»¥é€šè¿‡æ‰€æœ‰æ•°æ®ã€‚

- **æ ¸å¿ƒä»£ç ç‰‡æ®µ**ï¼ˆæ‹†ç‚¹+å»ºå›¾ï¼‰ï¼š
  ```cpp
  int id(int p,int x) { // 1:ç»ƒä¹ å†Œ 2:ä¹¦å·¦ 3:ä¹¦å³ 4:ç­”æ¡ˆ
      switch(p) {
          case 1: return x;
          case 2: return n2+x;
          case 3: return n2+n1+x;
          case 4: return n2+n1+n1+x;
      }
  }
  // å»ºå›¾
  for(int i=1;i<=n1;++i) addedge(id(2,i),id(3,i),1); // ä¹¦æ‹†ç‚¹
  for(int i=1;i<=n2;++i) addedge(S,id(1,i),1);       // æºç‚¹â†’ç»ƒä¹ å†Œ
  for(int i=1;i<=n3;++i) addedge(id(4,i),T,1);       // ç­”æ¡ˆâ†’æ±‡ç‚¹
  ```

---

### é¢˜è§£äºŒï¼šDrinkwaterï¼ˆæ³¨é‡Šè¯¦å°½ï¼Œé€‚åˆæ–°æ‰‹ï¼‰

- **äº®ç‚¹**ï¼š
  - **æ³¨é‡Šè¯¦ç»†**ï¼šå‡ ä¹æ¯è¡Œéƒ½æœ‰è§£é‡Šï¼Œæ–°æ‰‹ä¹Ÿèƒ½å¿«é€Ÿçœ‹æ‡‚ã€‚
  - **å»ºå›¾å£è¯€**ï¼šã€Œæºç‚¹â†’ç»ƒä¹ å†Œâ†’ä¹¦â†’ä¹¦'â†’ç­”æ¡ˆâ†’æ±‡ç‚¹ã€ï¼Œæœ—æœ—ä¸Šå£ã€‚
  - **è°ƒè¯•æŠ€å·§**ï¼šç‰¹åˆ«æé†’æ•°ç»„å¼€10å€ï¼Œé¿å…ã€Œçˆ†30ã€æƒ¨æ¡ˆã€‚

- **å­¦ä¹ ç¬”è®°**ï¼š  
  > æ‹†ç‚¹åï¼Œ**ä¹¦â†’ä¹¦'**çš„è¾¹å®¹é‡ä¸º1ï¼Œæ˜¯æœ¬é¢˜çš„çµé­‚ï¼å®ƒåƒä¸€é“ã€Œé—¸é—¨ã€ï¼Œç¡®ä¿æ¯æœ¬ä¹¦åªèƒ½è¢«ã€Œæ”¾è¡Œã€ä¸€æ¬¡ã€‚

---

### é¢˜è§£ä¸‰ï¼šViXpopï¼ˆæ‹†ç‚¹æ€æƒ³æ·±åº¦è§£æï¼‰

- **äº®ç‚¹**ï¼š
  - **æ‹†ç‚¹åŠ¨æœº**ï¼šç”¨ã€Œé…’åº—ä¹‹ç‹ã€ç±»æ¯”ï¼Œè§£é‡Šä¸ºä½•å¿…é¡»æ‹†ç‚¹ã€‚
  - **å¯è§†åŒ–**ï¼šé™„ä¸Šæ‰‹ç»˜ç¤ºæ„å›¾ï¼Œç›´è§‚å±•ç¤ºæ‹†ç‚¹å‰åçš„å›¾ç»“æ„å˜åŒ–ã€‚
  - **é”™è¯¯åˆ†æ**ï¼šæŒ‡å‡ºã€Œä¸æ‹†ç‚¹ã€ä¼šå¯¼è‡´ã€Œä¹¦è¢«é‡å¤åŒ¹é…ã€çš„é™·é˜±ã€‚

- **æ ¸å¿ƒä»£ç ç‰‡æ®µ**ï¼ˆæ‹†ç‚¹åå»ºå›¾ï¼‰ï¼š
  ```cpp
  for(int i=1;i<=n1;i++){ // ä¹¦æ‹†ç‚¹
      add(i, i+n1, 1); // å…¥ç‚¹â†’å‡ºç‚¹ï¼Œå®¹é‡1
      add(i+n1, i, 0);
  }
  ```

---

## 3. è§£é¢˜ç­–ç•¥æ·±åº¦å‰–æ

---

### ğŸ¯ æ ¸å¿ƒéš¾ç‚¹ä¸å…³é”®æ­¥éª¤ï¼ˆæœ€ä¼˜è§£æ³•å‰–æï¼‰

| æ­¥éª¤ | å…³é”®ç‚¹ | åˆ†æ & å­¦ä¹ ç¬”è®° |
| --- | --- | --- |
| **1** | **æ‹†ç‚¹è®¾è®¡** | å°†æ¯æœ¬ä¹¦æ‹†æˆã€Œå…¥ç‚¹ã€å’Œã€Œå‡ºç‚¹ã€ï¼Œä¸­é—´è¿å®¹é‡ä¸º1çš„è¾¹ã€‚  
ğŸ’¡ **å­¦ä¹ ç¬”è®°**ï¼šæ‹†ç‚¹æ˜¯è§£å†³ã€Œç‚¹å®¹é‡é™åˆ¶ã€çš„é€šç”¨æŠ€å·§ï¼Œé€‚ç”¨äºæ‰€æœ‰ã€Œç‰©å“åªèƒ½é€‰ä¸€æ¬¡ã€çš„åŒ¹é…é—®é¢˜ã€‚ |
| **2** | **åˆ†å±‚å»ºå›¾** | æºç‚¹â†’ç»ƒä¹ å†Œâ†’ä¹¦å…¥ç‚¹â†’ä¹¦å‡ºç‚¹â†’ç­”æ¡ˆâ†’æ±‡ç‚¹ã€‚  
ğŸ’¡ **å­¦ä¹ ç¬”è®°**ï¼šåˆ†å±‚å›¾è®©ã€Œå¢å¹¿è·¯å¾„ã€å¤©ç„¶å¯¹åº”ä¸€å¥—å®Œæ•´ä¸‰ä»¶å¥—ï¼Œæ— éœ€é¢å¤–çº¦æŸã€‚ |
| **3** | **æœ€å¤§æµç®—æ³•** | ä½¿ç”¨Dinicç®—æ³•ï¼Œæ—¶é—´å¤æ‚åº¦$O(n^2m)$ã€‚  
ğŸ’¡ **å­¦ä¹ ç¬”è®°**ï¼šDinicåœ¨äºŒåˆ†å›¾/ä¸‰åˆ†å›¾ä¸Šè¡¨ç°ä¼˜å¼‚ï¼Œé€šå¸¸æ¯”EKç®—æ³•å¿«ä¸€ä¸ªæ•°é‡çº§ã€‚ |

---

### âš”ï¸ ç­–ç•¥ç«æŠ€åœºï¼šä¸åŒè§£æ³•å¯¹æ¯”

| ç­–ç•¥ | æ ¸å¿ƒæ€æƒ³ | ä¼˜ç‚¹ | ç¼ºç‚¹ | é€‚ç”¨åœºæ™¯ |
| --- | --- | --- | --- | --- |
| **æš´åŠ›DFS** | æšä¸¾æ‰€æœ‰å¯èƒ½çš„ä¸‰å…ƒç»„ | æ€è·¯ç›´è§‚ | æ—¶é—´çˆ†ç‚¸$O(n_1n_2n_3)$ï¼Œä»…$n_i\le10$å¯ç”¨ | æ•™å­¦æ¼”ç¤º |
| **åŒˆç‰™åˆ©ç®—æ³•** | äºŒåˆ†å›¾åŒ¹é…æ‰©å±• | ä»£ç çŸ­ | éš¾ä»¥å¤„ç†ä¸‰åˆ†å›¾ï¼Œä¸”éœ€$O(n^3)$ | ä¸æ¨è |
| **ç½‘ç»œæµ+æ‹†ç‚¹** | æœ€å¤§æµå»ºæ¨¡ | é€šç”¨æ€§å¼ºï¼Œå¤æ‚åº¦ä¼˜ | éœ€æŒæ¡å»ºå›¾æŠ€å·§ | **æœ¬é¢˜æœ€ä¼˜è§£** |

---

### âœ¨ ä¼˜åŒ–ä¹‹æ—…ï¼šä»ã€Œèƒ½åšã€åˆ°ã€Œåšå¥½ã€

> 1. **æœ´ç´ ç½‘ç»œæµ**ï¼šç›´æ¥å»ºå›¾ã€Œæºâ†’ç»ƒä¹ å†Œâ†’ä¹¦â†’ç­”æ¡ˆâ†’æ±‡ã€ï¼Œ**WA**ï¼å› ä¸ºä¹¦å¯è¢«å¤šæ¬¡åŒ¹é…ã€‚  
> 2. **å‘ç°é—®é¢˜**ï¼šä¹¦è¢«é‡å¤ä½¿ç”¨çš„æ ¹æºæ˜¯**ç‚¹æ— å®¹é‡é™åˆ¶**ã€‚  
> 3. **æ‹†ç‚¹ä¼˜åŒ–**ï¼šå°†æ¯æœ¬ä¹¦æ‹†æˆä¸¤ç‚¹ï¼Œä¸­é—´è¿å®¹é‡1çš„è¾¹ï¼Œ**AC**ï¼  
> 4. **ç»ˆæä¼˜åŒ–**ï¼šåŠ å…¥**å½“å‰å¼§ä¼˜åŒ–**å’Œ**åˆ†å±‚å›¾å‰ªæ**ï¼ŒDinicç®—æ³•å¦‚è™æ·»ç¿¼ã€‚

---

## 4. C++æ ¸å¿ƒä»£ç å®ç°èµæ

---

### æœ¬é¢˜é€šç”¨æ ¸å¿ƒC++å®ç°å‚è€ƒ

- **è¯´æ˜**ï¼šç»¼åˆå„ä¼˜è´¨é¢˜è§£ï¼Œæç‚¼å‡ºæœ€ç®€æ´ã€æ˜“æ‡‚çš„Dinicæ¨¡æ¿ã€‚
- **å®Œæ•´æ ¸å¿ƒä»£ç **ï¼š
  ```cpp
  #include <bits/stdc++.h>
  using namespace std;
  const int MAXN = 1e5 + 10, MAXM = 1e6 + 10, INF = 1e9;

  struct Edge { int to, next, cap; } e[MAXM];
  int head[MAXN], cnt = 1, dep[MAXN], cur[MAXN];
  void add(int u, int v, int w) {
      e[++cnt] = {v, head[u], w}; head[u] = cnt;
      e[++cnt] = {u, head[v], 0}; head[v] = cnt;
  }

  bool bfs(int s, int t) {
      memset(dep, 0, sizeof(dep));
      memcpy(cur, head, sizeof(head));
      queue<int> q; q.push(s); dep[s] = 1;
      while (!q.empty()) {
          int u = q.front(); q.pop();
          for (int i = head[u]; i; i = e[i].next)
              if (e[i].cap && !dep[e[i].to]) {
                  dep[e[i].to] = dep[u] + 1;
                  q.push(e[i].to);
              }
      }
      return dep[t];
  }

  int dfs(int u, int t, int flow) {
      if (u == t) return flow;
      int rest = flow;
      for (int i = cur[u]; i && rest; i = e[i].next) {
          cur[u] = i;
          int v = e[i].to, c = e[i].cap;
          if (c && dep[v] == dep[u] + 1) {
              int f = dfs(v, t, min(rest, c));
              e[i].cap -= f; e[i^1].cap += f; rest -= f;
          }
      }
      return flow - rest;
  }

  int dinic(int s, int t) {
      int maxflow = 0;
      while (bfs(s, t)) maxflow += dfs(s, t, INF);
      return maxflow;
  }

  int main() {
      int n1, n2, n3, m1, m2;
      scanf("%d%d%d%d", &n1, &n2, &n3, &m1);
      int s = 0, t = n1*2 + n2 + n3 + 1;
      for (int i = 1; i <= n2; ++i) add(s, i, 1);              // æºâ†’ç»ƒä¹ å†Œ
      for (int i = 1; i <= n1; ++i) add(n2 + i, n2 + n1 + i, 1); // ä¹¦æ‹†ç‚¹
      for (int i = 1; i <= n3; ++i) add(n2 + n1*2 + i, t, 1);   // ç­”æ¡ˆâ†’æ±‡
      for (int i = 1, x, y; i <= m1; ++i) { scanf("%d%d", &x, &y); add(y, n2 + x, 1); } // ç»ƒä¹ å†Œâ†’ä¹¦
      scanf("%d", &m2);
      for (int i = 1, x, y; i <= m2; ++i) { scanf("%d%d", &x, &y); add(n2 + n1 + x, n2 + n1*2 + y, 1); } // ä¹¦â†’ç­”æ¡ˆ
      printf("%d\n", dinic(s, t));
      return 0;
  }
  ```

---

## 5. ç®—æ³•å¯è§†åŒ–ï¼šåƒç´ åŠ¨ç”»æ¼”ç¤º

**åŠ¨ç”»ä¸»é¢˜**ï¼š**ã€Šåƒç´ å·¥åŠï¼šä¸‰ä»¶å¥—åˆæˆå¤§å†’é™©ã€‹**  
ï¼ˆ8ä½åƒç´ é£ï¼ŒCanvaså®ç°ï¼‰

- **åœºæ™¯è®¾è®¡**ï¼š
  - **åƒç´ ç½‘æ ¼**ï¼šæ¯æ ¼ä»£è¡¨ä¸€ä¸ªç‰©å“ï¼ˆä¹¦ğŸ“•ã€ç»ƒä¹ å†ŒğŸ“˜ã€ç­”æ¡ˆğŸ“„ï¼‰ã€‚
  - **è§’è‰²**ï¼šåƒç´ å°å·¥åŒ ğŸ‘·ï¼Œä»æºç‚¹å‡ºå‘ï¼Œæ²¿å¢å¹¿è·¯å¾„æ”¶é›†ä¸‰ä»¶å¥—ã€‚
  - **éŸ³æ•ˆ**ï¼š8ä½ã€Œå®ï¼ã€éŸ³æ•ˆæ ‡è®°æ¯æ­¥å¢å¹¿ï¼Œã€Œèƒœåˆ©éŸ³ã€å®Œæˆä¸€å¥—ã€‚

- **å…³é”®å¸§æ¼”ç¤º**ï¼š
  1. **åˆå§‹åŒ–**ï¼šæºç‚¹â†’ç»ƒä¹ å†Œâ†’ä¹¦å…¥ç‚¹â†’ä¹¦å‡ºç‚¹â†’ç­”æ¡ˆâ†’æ±‡ç‚¹çš„è·¯å¾„ä»¥**ç»¿è‰²é«˜äº®**ã€‚
  2. **æ‹†ç‚¹åŠ¨ç”»**ï¼šä¹¦å…¥ç‚¹ä¸ä¹¦å‡ºç‚¹ä¹‹é—´çš„**çº¢è‰²é—¸é—¨**ï¼ˆå®¹é‡1ï¼‰é—ªçƒï¼Œè¡¨ç¤ºã€Œä»…æ”¾è¡Œä¸€æ¬¡ã€ã€‚
  3. **å¢å¹¿è¿‡ç¨‹**ï¼šå°å·¥åŒ æ²¿è·¯å¾„ç§»åŠ¨ï¼Œæ¯ç»è¿‡ä¸€æ¡è¾¹ï¼Œå…¶å®¹é‡åƒç´ å—**-1**ï¼Œåå‘è¾¹**+1**ã€‚
  4. **å®Œæˆæ ‡è®°**ï¼šæ¯åˆæˆä¸€å¥—ï¼Œè·¯å¾„å˜ä¸º**é‡‘è‰²**ï¼Œå±å¹•é¡¶éƒ¨ã€Œå¥—è£…+1ï¼ã€åƒç´ å­—é—ªçƒã€‚

- **äº¤äº’é¢æ¿**ï¼š
  - æ­¥è¿›/è‡ªåŠ¨æ’­æ”¾æŒ‰é’®ï¼ˆåƒç´ é£æ ¼å›¾æ ‡ï¼‰ã€‚
  - é€Ÿåº¦æ»‘å—ï¼ˆä¹Œé¾ŸğŸ¢â†’å…”å­ğŸ‡ï¼‰ã€‚
  - é‡ç½®æŒ‰é’®ï¼ˆåƒç´ é”¤å­ğŸ”¨ï¼‰ã€‚

---

## 6. æ‹“å±•ç»ƒä¹ ä¸ç›¸ä¼¼é—®é¢˜æ€è€ƒ

**é€šç”¨æŠ€å·§è¿ç§»**ï¼š  
æ‹†ç‚¹+æœ€å¤§æµé€‚ç”¨äºæ‰€æœ‰ã€Œ**ç‚¹å®¹é‡é™åˆ¶**ã€çš„åŒ¹é…é—®é¢˜ï¼Œä¾‹å¦‚ï¼š
1. **è¯¾ç¨‹å†²çª**ï¼šæ¯é—¨è¯¾åªèƒ½é€‰ä¸€æ¬¡ï¼ˆæ‹†ç‚¹é™åˆ¶ï¼‰ã€‚
2. **ä»»åŠ¡åˆ†é…**ï¼šæ¯ä¸ªå·¥äººåªèƒ½æ‰¿æ‹…ä¸€ä¸ªä»»åŠ¡ã€‚
3. **èµ„æºè°ƒåº¦**ï¼šæ¯å°æœºå™¨åªèƒ½å¤„ç†ä¸€ä¸ªè®¢å•ã€‚

**æ´›è°·æ¨èç»ƒä¹ **ï¼š
| é¢˜å· | æ¨èç†ç”± |
| --- | --- |
| **P1402 é…’åº—ä¹‹ç‹** | ä¸‰åˆ†å›¾åŒ¹é…æ¨¡æ¿ï¼Œä¸æœ¬é¢˜å‡ ä¹ä¸€è‡´ã€‚ |
| **P2756 é£è¡Œå‘˜é…å¯¹æ–¹æ¡ˆ** | äºŒåˆ†å›¾æœ€å¤§åŒ¹é…ï¼Œå·©å›ºæ‹†ç‚¹æ€æƒ³ã€‚ |
| **P4015 è¿è¾“é—®é¢˜** | å¤šæºå¤šæ±‡æœ€å¤§æµï¼Œæ‹“å±•åˆ†å±‚å»ºå›¾èƒ½åŠ›ã€‚ |

---

## 7. å­¦ä¹ å¿ƒå¾—ä¸ç»éªŒåˆ†äº«

> **æ¥è‡ªæ–¯å¾·å“¥å°”æ‘©çš„è¸©å‘å¿ƒå¾—**ï¼š  
> ã€Œä¸€å¼€å§‹ç”¨åŒˆç‰™åˆ©ç®—æ³•ï¼Œ10åˆ†é’Ÿå†™å®Œï¼Œç»“æœWAå¾—å¾ˆæƒ¨ã€‚åæ¥æ‰å‘ç°ï¼ŒåŒˆç‰™åˆ©æ˜¯$O(n^3)$ï¼Œè€Œ$n\le1W$ï¼**ç½‘ç»œæµæ‰æ˜¯æ­£è§£**ã€‚ã€  
> **æ´›è¯­äº‘ç¬ºç‚¹è¯„**ï¼š  
> è¿™æé†’æˆ‘ä»¬ï¼Œ**æ•°æ®èŒƒå›´**æ˜¯é€‰æ‹©ç®—æ³•çš„ç¬¬ä¸€ä¿¡å·ï¼$n\le1W$æ—¶ï¼Œ$O(n^3)$ç®—æ³•å¿…æŒ‚ï¼Œè€Œç½‘ç»œæµ$O(n^2m)$å¯è½»æ¾é€šè¿‡ã€‚

---

### ğŸ’¡ æ€»ç»“
æ‹†ç‚¹+ç½‘ç»œæµæ˜¯è§£å†³ã€Œç‚¹å®¹é‡é™åˆ¶ã€ç±»é—®é¢˜çš„é»„é‡‘ç»„åˆã€‚æŒæ¡å®ƒï¼Œä½ å°±èƒ½ä¼˜é›…åœ°åº”å¯¹å„ç§å¤æ‚åŒ¹é…åœºæ™¯ï¼ä¸‹æ¬¡é‡åˆ°ç±»ä¼¼é—®é¢˜ï¼Œä¸å¦¨å…ˆæƒ³æƒ³ï¼š**æ˜¯å¦éœ€è¦æ‹†ç‚¹æ¥é™åˆ¶æµé‡ï¼Ÿ**

---
å¤„ç†ç”¨æ—¶ï¼š80.01ç§’
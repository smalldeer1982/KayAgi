# é¢˜ç›®ä¿¡æ¯

# [ZJOI2010] æ•°å­—è®¡æ•°

## é¢˜ç›®æè¿°

ç»™å®šä¸¤ä¸ªæ­£æ•´æ•° $a$ å’Œ $b$ï¼Œæ±‚åœ¨ $[a,b]$ ä¸­çš„æ‰€æœ‰æ•´æ•°ä¸­ï¼Œæ¯ä¸ªæ•°ç (digit)å„å‡ºç°äº†å¤šå°‘æ¬¡ã€‚

## è¯´æ˜/æç¤º

#### æ•°æ®è§„æ¨¡ä¸çº¦å®š

- å¯¹äº $30\%$ çš„æ•°æ®ï¼Œä¿è¯ $a\le b\le10^6$ï¼›
- å¯¹äº $100\%$ çš„æ•°æ®ï¼Œä¿è¯ $1\le a\le b\le 10^{12}$ã€‚

## æ ·ä¾‹ #1

### è¾“å…¥

```
1 99
```

### è¾“å‡º

```
9 20 20 20 20 20 20 20 20 20
```

# AIåˆ†æç»“æœ

# ğŸ’¡ æ´›è¯­äº‘ç¬ºçš„C++ç®—æ³•è§£æï¼šæ•°å­—è®¡æ•° [P2602] æ·±å…¥å­¦ä¹ æŒ‡å— ğŸ’¡

> æ¬¢è¿æ¥åˆ°æ´›è¯­äº‘ç¬ºçš„ç®—æ³•è¯¾å ‚ï¼ä»Šå¤©æˆ‘ä»¬è¦ä¸€èµ·æ”»å…‹çš„æ˜¯ä¸€é“ç»å…¸çš„â€œæ•°ä½ DPâ€é—®é¢˜â€”â€”æ•°å­—è®¡æ•°ã€‚æˆ‘ä»¬å°†ä»æš´åŠ›æšä¸¾çš„å›°å¢ƒå‡ºå‘ï¼Œä¸€æ­¥æ­¥èµ°å‘ä¼˜é›…çš„æ•°ä½ DP è§£æ³•ï¼Œå¹¶æ¢ç´¢å¤šç§è§£é¢˜ç­–ç•¥ã€‚

---

## 1. é¢˜ç›®è§£è¯»ä¸ç­–ç•¥åˆæ¢

âœ¨ **æœ¬é¢˜æ ¸å¿ƒæŒ‘æˆ˜**ï¼š  
åœ¨å·¨å¤§çš„åŒºé—´ $[a, b]$ï¼ˆ$1 \le a \le b \le 10^{12}$ï¼‰ä¸­ï¼Œç»Ÿè®¡æ¯ä¸ªæ•°ç ï¼ˆ0~9ï¼‰å‡ºç°çš„æ€»æ¬¡æ•°ã€‚

âœ¨ **æ ¸å¿ƒç®—æ³•æ ‡ç­¾**ï¼š`æ•°ä½ DP` `åŠ¨æ€è§„åˆ’` `è®°å¿†åŒ–æœç´¢` `é€’æ¨`

ğŸ—£ï¸ **åˆæ­¥åˆ†æ**ï¼š  
æš´åŠ›æšä¸¾æ¯ä¸ªæ•°å­—å¹¶ç»Ÿè®¡æ•°ç æ˜¾ç„¶ä¸å¯è¡Œï¼ˆæ—¶é—´å¤æ‚åº¦ $O(b \log b)$ï¼‰ï¼Œå› ä¸º $b$ æœ€å¤§å¯è¾¾ $10^{12}$ã€‚  
æˆ‘ä»¬éœ€è¦ä¸€ç§æ›´èªæ˜çš„æ–¹æ³•ï¼š**æ•°ä½ DP**ã€‚

### ğŸ” ç®—æ³•ä¾¦æ¢ï¼šå¦‚ä½•åœ¨é¢˜ç›®ä¸­å‘ç°çº¿ç´¢ï¼Ÿ
1. **çº¿ç´¢1ï¼ˆé—®é¢˜ç›®æ ‡ï¼‰**ï¼š  
   â€œç»Ÿè®¡åŒºé—´æ•°ç å‡ºç°æ¬¡æ•°â€ â†’ å¯ä»¥è½¬åŒ–ä¸º**å‰ç¼€å’Œç›¸å‡**ï¼š$count(a,b) = count(1,b) - count(1,a-1)$ã€‚
2. **çº¿ç´¢2ï¼ˆé—®é¢˜ç‰¹æ€§ï¼‰**ï¼š  
   æ•°å­—çš„æ¯ä¸€ä½ç‹¬ç«‹ï¼Œä¸”æœ‰â€œå‰å¯¼é›¶â€å’Œâ€œä¸Šç•Œé™åˆ¶â€ â†’ é€‚åˆ**é€ä½å¤„ç†**ã€‚
3. **çº¿ç´¢3ï¼ˆæ•°æ®è§„æ¨¡ï¼‰**ï¼š  
   $10^{12}$ æš—ç¤ºæˆ‘ä»¬éœ€è¦**å¯¹æ•°çº§åˆ«**çš„ç®—æ³•ï¼ˆ$\log_{10} b \approx 12$ ä½ï¼‰ã€‚

### ğŸ§  æ€ç»´é“¾æ„å»ºï¼šä»çº¿ç´¢åˆ°ç­–ç•¥
> 1. **å‰ç¼€å’Œè½¬åŒ–**ï¼šå°†åŒºé—´é—®é¢˜è½¬åŒ–ä¸ºä¸¤ä¸ªå‰ç¼€é—®é¢˜ã€‚  
> 2. **é€ä½åˆ†è§£**ï¼šå°†æ•°å­—æŒ‰ä½åˆ†è§£ï¼ˆå¦‚ $1234 \rightarrow [1,2,3,4]$ï¼‰ã€‚  
> 3. **çŠ¶æ€è®¾è®¡**ï¼šç”¨ `dp[pos][sum][lead][limit]` è¡¨ç¤ºå¤„ç†åˆ°ç¬¬ `pos` ä½æ—¶ï¼Œå·²ç»Ÿè®¡æ•°ç  `sum` æ¬¡ï¼Œæ˜¯å¦æœ‰å‰å¯¼é›¶ `lead`ï¼Œæ˜¯å¦å—ä¸Šç•Œé™åˆ¶ `limit`ã€‚  
> 4. **è®°å¿†åŒ–æœç´¢**ï¼šç¼“å­˜æ— é™åˆ¶çŠ¶æ€ï¼Œé¿å…é‡å¤è®¡ç®—ã€‚

---

## 2. ç²¾é€‰ä¼˜è´¨é¢˜è§£å‚è€ƒ

### é¢˜è§£ä¸€ï¼šmoyeåˆ°ç¢—é‡Œæ¥ï¼ˆé€’æ¨æ³•ï¼‰
**äº®ç‚¹**ï¼š  
- **é€’æ¨å¼ä¼˜é›…**ï¼š$f[i] = f[i-1] \times 10 + 10^{i-1}$ ç›´æ¥è®¡ç®— $i$ ä½æ•°ä¸­æ¯ä¸ªæ•°ç çš„å‡ºç°æ¬¡æ•°ï¼ˆå«å‰å¯¼é›¶ï¼‰ã€‚  
- **é€ä½å¤„ç†**ï¼šå°†æ•°å­—æ‹†åˆ†ä¸ºé«˜ä½å’Œä½ä½ï¼Œåˆ†åˆ«è®¡ç®—è´¡çŒ®ã€‚

**ä»£ç æ ¸å¿ƒ**ï¼š
```cpp
for (int i = len; i >= 1; i--) {
    for (int j = 0; j <= 9; j++)
        cnt[j] += f[i-1] * num[i]; // ä½ä½è´¡çŒ®
    for (int j = 0; j < num[i]; j++)
        cnt[j] += ten[i-1];        // é«˜ä½è´¡çŒ®
    cnt[num[i]] += num2 + 1;       // å½“å‰ä½è´¡çŒ®
    cnt[0] -= ten[i-1];            // å‡å»å‰å¯¼é›¶
}
```

### é¢˜è§£äºŒï¼šfy0123ï¼ˆDFSè®°å¿†åŒ–ï¼‰
**äº®ç‚¹**ï¼š  
- **å››ç»´çŠ¶æ€**ï¼š`dfs(len, issmall, sum, zero, d)` ç²¾ç¡®æ§åˆ¶çŠ¶æ€ã€‚  
- **å‰å¯¼é›¶å¤„ç†**ï¼šé€šè¿‡ `zero` æ ‡è®°è·³è¿‡å‰å¯¼é›¶çš„ç»Ÿè®¡ã€‚

**ä»£ç æ ¸å¿ƒ**ï¼š
```cpp
ret += dfs(len-1, issmall || (i < num[len]), 
           sum + ((!zero || i) && (i == d)), 
           zero && (i == 0), d);
```

### é¢˜è§£ä¸‰ï¼šshadowice1984ï¼ˆæ•°å­¦æ³•ï¼‰
**äº®ç‚¹**ï¼š  
- **æ•°å­¦æ¨å¯¼**ï¼šç›´æ¥æŒ‰ä½è®¡ç®—è´¡çŒ®ï¼Œæ— éœ€é€’å½’ã€‚  
- **åˆ†æƒ…å†µè®¨è®º**ï¼šå½“å‰ä½ä¸ç›®æ ‡æ•°ç çš„å¤§å°å…³ç³»å†³å®šæ–¹æ¡ˆæ•°ã€‚

**ä»£ç æ ¸å¿ƒ**ï¼š
```cpp
if (k < lim[i]) res[k] += mi[i-1] * (suf[i+1] + 1);
else if (k == lim[i]) res[k] += mi[i-1] * suf[i+1] + pre[i-1];
else res[k] += mi[i-1] * suf[i+1];
```

---

## 3. è§£é¢˜ç­–ç•¥æ·±åº¦å‰–æ

### ğŸ¯ æ ¸å¿ƒéš¾ç‚¹ä¸å…³é”®æ­¥éª¤ï¼ˆæ•°ä½ DPï¼‰
1. **çŠ¶æ€è®¾è®¡**ï¼š
   - `pos`ï¼šå½“å‰å¤„ç†åˆ°ç¬¬å‡ ä½ï¼ˆä»é«˜ä½åˆ°ä½ä½ï¼‰ã€‚  
   - `sum`ï¼šå·²ç»Ÿè®¡çš„æ•°ç å‡ºç°æ¬¡æ•°ã€‚  
   - `lead`ï¼šæ˜¯å¦æœ‰å‰å¯¼é›¶ï¼ˆé¿å…ç»Ÿè®¡å‰å¯¼é›¶ï¼‰ã€‚  
   - `limit`ï¼šæ˜¯å¦å—ä¸Šç•Œé™åˆ¶ï¼ˆå¦‚æ•°å­— $1234$ çš„åä½åªèƒ½å¡« $0 \sim 3$ï¼‰ã€‚

2. **è½¬ç§»æ–¹ç¨‹**ï¼š
   - æšä¸¾å½“å‰ä½æ•°å­— $d$ï¼Œé€’å½’åˆ°ä¸‹ä¸€ä½ï¼š  
     `dp[pos][sum][lead][limit] += dfs(pos-1, sum + (d == target && !lead), ...)`.

3. **è®°å¿†åŒ–ä¼˜åŒ–**ï¼š
   - ä»…ç¼“å­˜ `!limit && !lead` çš„çŠ¶æ€ï¼Œå…¶ä»–çŠ¶æ€éœ€å®æ—¶è®¡ç®—ã€‚

### âš”ï¸ ç­–ç•¥ç«æŠ€åœºï¼šä¸åŒè§£æ³•çš„å¯¹æ¯”åˆ†æ

| ç­–ç•¥ | æ ¸å¿ƒæ€æƒ³ | ä¼˜ç‚¹ | ç¼ºç‚¹ | é€‚ç”¨åœºæ™¯ |
| :--- | :--- | :--- | :--- | :--- |
| **æš´åŠ›æšä¸¾** | é€ä¸ªæ•°å­—ç»Ÿè®¡ | ç®€å•ç›´è§‚ | $O(b \log b)$ï¼Œè¶…æ—¶ | $b \le 10^6$ |
| **æ•°å­¦æ³•** | æŒ‰ä½è®¡ç®—è´¡çŒ® | æ— éœ€é€’å½’ï¼Œ$O(\log b)$ | éœ€å¤„ç†å‰å¯¼é›¶ | ç†è®ºæœ€ä¼˜ |
| **æ•°ä½ DPï¼ˆDFSï¼‰** | è®°å¿†åŒ–æœç´¢ | é€šç”¨æ€§å¼ºï¼Œä»£ç ç®€æ´ | çŠ¶æ€è®¾è®¡å¤æ‚ | æ ‡å‡†è§£æ³• |
| **é€’æ¨æ³•** | é¢„å¤„ç† $f[i]$ | é€»è¾‘æ¸…æ™° | éœ€é€ä½æ‹†åˆ† | æ¨¡æ¿åŒ– |

### âœ¨ ä¼˜åŒ–ä¹‹æ—…ï¼šä»â€œèƒ½åšâ€åˆ°â€œåšå¥½â€
> 1. **æš´åŠ›æšä¸¾**ï¼šç›´æ¥éå†æ¯ä¸ªæ•°å­—ï¼Œç»Ÿè®¡æ•°ç  â†’ è¶…æ—¶ã€‚  
> 2. **å‘ç°é‡å¤å­é—®é¢˜**ï¼šè®¡ç®— $1 \sim 1234$ æ—¶ï¼Œ$1 \sim 999$ è¢«å¤šæ¬¡è®¡ç®—ã€‚  
> 3. **å¼•å…¥è®°å¿†åŒ–**ï¼šç¼“å­˜ $1 \sim 999$ çš„ç»“æœ â†’ æ•°ä½ DPã€‚  
> 4. **æ•°å­¦ä¼˜åŒ–**ï¼šç›´æ¥æŒ‰ä½è®¡ç®—è´¡çŒ® â†’ æ•°å­¦æ³•ã€‚

---

## 4. C++æ ¸å¿ƒä»£ç å®ç°èµæ

### æœ¬é¢˜é€šç”¨æ ¸å¿ƒC++å®ç°å‚è€ƒ
**è¯´æ˜**ï¼šç»¼åˆäº†æ•°ä½ DP çš„ç»å…¸æ¨¡æ¿ï¼Œæ”¯æŒä»»æ„åŒºé—´ $[a, b]$ã€‚

**å®Œæ•´æ ¸å¿ƒä»£ç **ï¼š
```cpp
#include <bits/stdc++.h>
using namespace std;
typedef long long ll;

ll dp[20][20];
int num[20];

ll dfs(int pos, int sum, int target, bool lead, bool limit) {
    if (pos == 0) return sum;
    if (!limit && !lead && dp[pos][sum] != -1) return dp[pos][sum];
    
    int up = limit ? num[pos] : 9;
    ll ans = 0;
    for (int i = 0; i <= up; i++) {
        ans += dfs(pos - 1, 
                   sum + ((!lead || i) && (i == target)), 
                   target, 
                   lead && (i == 0), 
                   limit && (i == up));
    }
    if (!limit && !lead) dp[pos][sum] = ans;
    return ans;
}

ll solve(ll x, int d) {
    if (x < 0) return 0;
    memset(dp, -1, sizeof(dp));
    int len = 0;
    while (x) {
        num[++len] = x % 10;
        x /= 10;
    }
    return dfs(len, 0, d, true, true);
}

int main() {
    ll a, b;
    cin >> a >> b;
    for (int i = 0; i <= 9; i++) {
        cout << solve(b, i) - solve(a - 1, i) << (i == 9 ? '\n' : ' ');
    }
    return 0;
}
```

---

## 5. ç®—æ³•å¯è§†åŒ–ï¼šåƒç´ åŠ¨ç”»æ¼”ç¤º

### åŠ¨ç”»ä¸»é¢˜ï¼šåƒç´ æ¢é™©å®¶çš„æ•°ä½ä¹‹æ—…
**åœºæ™¯**ï¼š8ä½åƒç´ é£æ ¼çš„æ•°å­—åˆ†è§£å™¨ï¼Œå°† $1234$ æ‹†åˆ†ä¸º $[1,2,3,4]$ å¹¶é€ä½ç»Ÿè®¡æ•°ç ã€‚

**æ ¸å¿ƒæ­¥éª¤**ï¼š
1. **æ•°å­—æ‹†åˆ†**ï¼šåƒç´ æ–¹å—é€ä½æ˜¾ç¤ºæ•°å­—ï¼ˆå¦‚ $1 \rightarrow 2 \rightarrow 3 \rightarrow 4$ï¼‰ã€‚  
2. **çŠ¶æ€è½¬ç§»**ï¼šé«˜äº®å½“å‰ä½ï¼Œæ˜¾ç¤º `dfs(pos, sum)` çš„å®æ—¶æ›´æ–°ã€‚  
3. **è®°å¿†åŒ–ç¼“å­˜**ï¼šç»¿è‰²åƒç´ æ ‡è®°å·²ç¼“å­˜çŠ¶æ€ï¼Œçº¢è‰²æ ‡è®°å®æ—¶è®¡ç®—ã€‚  
4. **éŸ³æ•ˆæç¤º**ï¼š  
   - æ¯å¤„ç†ä¸€ä½æ’­æ”¾â€œå®â€å£°ã€‚  
   - å®Œæˆç»Ÿè®¡æ’­æ”¾â€œèƒœåˆ©â€éŸ³æ•ˆã€‚

**äº¤äº’è®¾è®¡**ï¼š
- æ­¥è¿›æŒ‰é’®ï¼šå•æ­¥æ‰§è¡Œ DFSã€‚  
- è‡ªåŠ¨æ’­æ”¾ï¼šAI æ¼”ç¤ºå®Œæ•´æµç¨‹ã€‚  
- é€Ÿåº¦æ»‘å—ï¼šè°ƒæ•´åŠ¨ç”»é€Ÿåº¦ã€‚

---

## 6. æ‹“å±•ç»ƒä¹ ä¸ç›¸ä¼¼é—®é¢˜æ€è€ƒ

### é€šç”¨æŠ€å·§è¿ç§»
- **æ•°ä½ DP** é€‚ç”¨äºï¼š  
  1. ç»Ÿè®¡åŒºé—´æ»¡è¶³ç‰¹å®šæ¡ä»¶çš„æ•°å­—ï¼ˆå¦‚ä¸å« $62$ï¼‰ã€‚  
  2. è®¡ç®—æ•°å­—çš„æŸç§å±æ€§ï¼ˆå¦‚å„ä½å’Œä¸º $k$ï¼‰ã€‚  
  3. å¤„ç†æ•°å­—çš„æ¯ä¸€ä½é™åˆ¶ï¼ˆå¦‚ç›¸é‚»ä½å·® $\le 1$ï¼‰ã€‚

### æ´›è°·æ¨èç»ƒä¹ 
1. **P4999 çƒ¦äººçš„æ•°å­¦ä½œä¸š**  
   ğŸ—£ï¸ æ¨èç†ç”±ï¼šæ•°ä½ DP æ¨¡æ¿é¢˜ï¼Œå·©å›ºåŸºç¡€çŠ¶æ€è®¾è®¡ã€‚
2. **P2657  windy æ•°**  
   ğŸ—£ï¸ æ¨èç†ç”±ï¼šå¢åŠ ç›¸é‚»ä½å·®çš„é™åˆ¶ï¼Œæ‹“å±•çŠ¶æ€ç»´åº¦ã€‚
3. **P4317 èŠ±ç¥çš„æ•°è®ºé¢˜**  
   ğŸ—£ï¸ æ¨èç†ç”±ï¼šç»“åˆä½è¿ç®—ä¸æ•°ä½ DPï¼Œæå‡æ€ç»´å¤æ‚åº¦ã€‚

---

## 7. å­¦ä¹ å¿ƒå¾—ä¸ç»éªŒåˆ†äº«
- **è°ƒè¯•æŠ€å·§**ï¼šæ‰“å° `dfs` çš„è¾“å…¥å‚æ•°ï¼ŒéªŒè¯çŠ¶æ€è½¬ç§»æ˜¯å¦æ­£ç¡®ã€‚  
- **è¾¹ç•Œå¤„ç†**ï¼šç‰¹åˆ«æ³¨æ„ $a=0$ æˆ– $b=0$ æ—¶å‰å¯¼é›¶çš„ç»Ÿè®¡ã€‚  
- **æ•°å­¦æ³•ä¼˜åŠ¿**ï¼šå¯¹äºçº¯ç»Ÿè®¡é—®é¢˜ï¼Œæ•°å­¦æ³•å¸¸æ¯” DP æ›´é«˜æ•ˆã€‚

---

> ğŸ’¡ **æ´›è¯­äº‘ç¬ºçš„ç»“è¯­**ï¼š  
> æ•°ä½ DP çš„é­…åŠ›åœ¨äºå°†åºå¤§çš„æ•°å­—é—®é¢˜æ‹†è§£ä¸ºå¯ç®¡ç†çš„å­é—®é¢˜ã€‚æŒæ¡å®ƒï¼Œä½ å°†èƒ½ä¼˜é›…åœ°è§£å†³è®¸å¤šçœ‹ä¼¼â€œæš´åŠ›ä¸å¯è§£â€çš„éš¾é¢˜ï¼ç»§ç»­åŠ æ²¹ï¼Œä¸‹ä¸€é“ç´«é¢˜ç­‰ä½ å¾æœï¼

---
å¤„ç†ç”¨æ—¶ï¼š93.17ç§’
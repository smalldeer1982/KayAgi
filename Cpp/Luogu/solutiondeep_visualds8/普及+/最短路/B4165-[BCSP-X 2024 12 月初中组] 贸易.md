# é¢˜ç›®ä¿¡æ¯

# [BCSP-X 2024 12 æœˆåˆä¸­ç»„] è´¸æ˜“

## é¢˜ç›®æè¿°

è¿™ä¸ªä¸–ç•Œä¸Šä¸€å…±æœ‰ $n$ ä¸ªå›½å®¶ï¼Œè¿™äº›å›½å®¶ä¹‹é—´ç»å¸¸æœ‰è´¸æ˜“å¾€æ¥ï¼Œäºæ˜¯ä¸ºäº†æ–¹ä¾¿ï¼Œæœ‰ $m$ æ¡é“è·¯è¿æ¥è¿™äº›å›½å®¶ï¼Œæ¯æ¡é“è·¯è¿æ¥ä¸¤ä¸ªå›½å®¶ï¼Œä½¿å¾—è¿™ä¸¤ä¸ªå›½å®¶ä¹‹é—´å¯ä»¥è½»æ¾è¿›è¡Œå¾€æ¥ã€‚

æœ‰äº†è¿™äº›é“è·¯ä¹‹åï¼Œå•†äººåœ¨å›½å®¶ä¹‹é—´ä¼šèµšå–åˆ°æ›´å¤šçš„åˆ©æ¶¦ï¼Œæ‰€ä»¥ä¸ºäº†é™åˆ¶å•†äººçš„è´¢å¯Œï¼Œå›½å®¶ä¹‹é—´åˆ¶å®šäº†ä¸€ä¸ªè§„åˆ™ã€‚å•†äººç»è¿‡æ¯æ¡é“è·¯ï¼Œéœ€è¦ä¸Šäº¤è¿™æ¡è·¯å¯¹åº”çš„è¿‡è·¯è´¹ $w_i$ï¼Œå•†äººä»èµ·ç‚¹å›½å®¶åˆ°è¾¾ç›®çš„åœ°å›½å®¶æ—¶ï¼Œä¼šè¿”è¿˜ç»™ä»–èµ°çš„è·¯å¾„ä¸Šçš„è¿‡è·¯è´¹æœ€å¤§çš„é‚£æ¡è·¯çš„è´¹ç”¨ $\max w_i$ å‡å»è¿‡è·¯è´¹æœ€å°çš„é‚£æ¡è·¯çš„è´¹ç”¨ $\min w_i$ã€‚

ç°åœ¨ï¼Œæœ‰ $k$ ä¸ªå•†äººè¦ä»ä¸€å·å›½å®¶å‡ºå‘ï¼Œå»å„ä¸ªå›½å®¶è¿›è¡Œè´¸æ˜“ï¼Œä½ éœ€è¦è®¡ç®—ä»–ä»¬æ¯ä¸ªäººå¦‚ä½•èµ°å¯ä»¥ä½¿å¾—ä»–è‡ªå·±çš„è¿‡è·¯è´¹æœ€å°‘ï¼Œä½ åªéœ€è¦å‘Šè¯‰ä»–ä»¬æ¯ä¸ªäººè¿™ä¸ªæœ€å°è¿‡è·¯è´¹å³å¯ã€‚

## è¯´æ˜/æç¤º

### æ ·ä¾‹è§£é‡Š 1

![](https://cdn.luogu.com.cn/upload/image_hosting/0jr9ups3.png)

å¦‚ä¸Šå›¾ã€‚

- å¯¹äºè·¯å¾„ $1 \to 2$ï¼ŒèŠ±è´¹ä¸º $1 - 1 + 1 = 1$ï¼›
- å¯¹äºè·¯å¾„ $1 \to 3$ï¼ŒèŠ±è´¹ä¸º $1 + 2 - 2 + 1 = 2$ï¼›
- å¯¹äºè·¯å¾„ $1 \to 4$ï¼ŒèŠ±è´¹ä¸º $1 + 2 - 2 + 1 = 2$ï¼›
- å¯¹äºè·¯å¾„ $1 \to 5$ï¼ŒèŠ±è´¹ä¸º $1 + 2 + 4 - 4 + 1 = 4$ï¼›

### æ•°æ®èŒƒå›´

- å¯¹äº $10\%$ çš„æ•°æ®ï¼Œ$n \leq 10$ï¼›
- å¯¹äº $30\%$ çš„æ•°æ®ï¼Œ$n \leq 2 \times 10^3$ï¼›
- å¯¹äºå¦å¤– $20\%$ çš„æ•°æ®ï¼Œ$k = 1$ï¼›
- å¯¹äºå¦å¤– $10\%$ çš„æ•°æ®ï¼Œ$w_i$ ç›¸åŒï¼›
- å¯¹äº $100\%$ çš„æ•°æ®ï¼Œ$1 \leq n \leq 2 \times 10^5, n - 1 \leq m \leq \min(\frac{n(n - 1)}{2}, 2 \times 10^5), 1 \leq k \leq n - 1, 0 \leq w_i \leq 10^9$ï¼Œæ•°æ®ä¿è¯ä¸å­˜åœ¨é‡è¾¹å’Œè‡ªç¯ã€‚

## æ ·ä¾‹ #1

### è¾“å…¥

```
5 4 4
5 3 4
2 1 1
3 2 2
2 4 2
2
3
4
5```

### è¾“å‡º

```
1
2
2
4```

## æ ·ä¾‹ #2

### è¾“å…¥

```
6 8 5
3 1 1
3 6 2
5 4 2
4 2 2
6 1 1
5 2 1
3 2 3
1 5 4
2
3
4
5
6```

### è¾“å‡º

```
2
1
4
3
1```

# AIåˆ†æç»“æœ

---
# ğŸ’¡ æ´›è¯­äº‘ç¬ºçš„C++ç®—æ³•è§£æï¼šè´¸æ˜“ï¼ˆBCSP-X 2024 12 æœˆåˆä¸­ç»„ï¼‰æ·±å…¥å­¦ä¹ æŒ‡å— ğŸ’¡

> æ¬¢è¿æ¥åˆ°æ´›è¯­äº‘ç¬ºçš„ç®—æ³•è¯¾å ‚ï¼ä»Šå¤©æˆ‘ä»¬åŒ–èº«â€œè´¸æ˜“è·¯çº¿è§„åˆ’å¸ˆâ€ï¼Œå¸®å•†äººä»¬æ‰¾åˆ°â€œçœé’±åˆèµšé’±â€çš„æœ€ä½³è·¯å¾„ã€‚ä¸€èµ·å‡ºå‘å§ï¼

---

## 1. é¢˜ç›®è§£è¯»ä¸ç­–ç•¥åˆæ¢

âœ¨ **æœ¬é¢˜æ ¸å¿ƒæŒ‘æˆ˜**ï¼š  
â€œå¦‚ä½•åœ¨ä¸€å¼ **å¸¦æƒæ— å‘å›¾**ä¸­ï¼Œä¸ºæ¯ä¸ªå•†äººæ‰¾åˆ°ä¸€æ¡ä» 1 å·å›½å®¶åˆ°ç›®æ ‡å›½å®¶ `t` çš„è·¯å¾„ï¼Œä½¿å¾— **è¯¥è·¯å¾„ä¸Šæœ€å¤§è¾¹æƒä¸æœ€å°è¾¹æƒä¹‹å·®** æœ€å°ï¼Ÿâ€

âœ¨ **æ ¸å¿ƒç®—æ³•æ ‡ç­¾**ï¼š  
- **æœ€çŸ­è·¯å˜å½¢**  
- **äºŒåˆ†ç­”æ¡ˆ + æœ€å°ç”Ÿæˆæ ‘ / å¹¶æŸ¥é›†**  
- **åŒå…³é”®å­— Dijkstra**  

ğŸ—£ï¸ **åˆæ­¥åˆ†æ**ï¼š  
é¢˜ç›®çœ‹ä¼¼æ˜¯â€œæœ€çŸ­è·¯â€ï¼Œä½†ç›®æ ‡å‡½æ•°ä¸æ˜¯è¾¹æƒå’Œï¼Œè€Œæ˜¯â€œæå·®â€ã€‚è¿™æ„å‘³ç€æˆ‘ä»¬éœ€è¦é‡æ–°æ€è€ƒâ€œè·ç¦»â€çš„å®šä¹‰ã€‚å¯èƒ½çš„æ€è·¯æœ‰ï¼š

1.  **æš´åŠ›æšä¸¾æ‰€æœ‰è·¯å¾„**ï¼šæ˜¾ç„¶è¶…æ—¶ã€‚  
2.  **æšä¸¾æœ€å°è¾¹ + æœ€å¤§è¾¹**ï¼šå†è·‘æœ€çŸ­è·¯ï¼Œä¾ç„¶å¤æ‚ã€‚  
3.  **äºŒåˆ†ç­”æ¡ˆ + é‡æ„å›¾**ï¼šå›ºå®šä¸€ä¸ªæå·®ä¸Šé™ `D`ï¼Œåªä¿ç•™è¾¹æƒåœ¨ `[w, w+D]` çš„è¾¹ï¼Œæ£€æŸ¥è¿é€šæ€§ã€‚  
4.  **åŒå…³é”®å­— Dijkstra**ï¼šæŠŠâ€œå½“å‰æå·®â€ä½œä¸ºçŠ¶æ€ï¼Œé€æ­¥æ¾å¼›ã€‚  

æœ€ä¼˜ç­–ç•¥æ˜¯ **â€œäºŒåˆ†ç­”æ¡ˆ + æœ€å°ç”Ÿæˆæ ‘ / å¹¶æŸ¥é›†â€**ï¼Œå› å…¶å¤æ‚åº¦ `O(m log m log W)` èƒ½è½»æ¾é€šè¿‡ `n â‰¤ 2Ã—10^5`ã€‚

### ğŸ” ç®—æ³•ä¾¦æ¢ï¼šå¦‚ä½•åœ¨é¢˜ç›®ä¸­å‘ç°çº¿ç´¢ï¼Ÿ

1.  **çº¿ç´¢1 (é—®é¢˜ç›®æ ‡)**ï¼š  
   â€œæœ€å°åŒ–è·¯å¾„ä¸Š **æœ€å¤§å€¼ä¸æœ€å°å€¼ä¹‹å·®**â€â€”â€”è¿™ä¸æ˜¯ä¼ ç»Ÿæœ€çŸ­è·¯ï¼Œè€Œæ˜¯**æå·®æœ€ä¼˜åŒ–**é—®é¢˜ã€‚

2.  **çº¿ç´¢2 (é—®é¢˜çº¦æŸ)**ï¼š  
   è¾¹æƒèŒƒå›´ `0 â‰¤ w_i â‰¤ 1e9`ï¼Œæš—ç¤º**ç¦»æ•£åŒ–æˆ–äºŒåˆ†**æ˜¯å¯è¡Œæ–¹å‘ã€‚

3.  **çº¿ç´¢3 (æ•°æ®è§„æ¨¡)**ï¼š  
   `n, m â‰¤ 2Ã—10^5`ï¼Œè¦æ±‚ `O(m log n)` æˆ– `O(m log m log W)` çº§åˆ«ç®—æ³•ï¼Œ**äºŒåˆ† + å¹¶æŸ¥é›†** æˆ– **åŒå…³é”®å­— Dijkstra** å‡å¯ã€‚

### ğŸ§  æ€ç»´é“¾æ„å»ºï¼šä»çº¿ç´¢åˆ°ç­–ç•¥
> 1.  **çº¿ç´¢1** å‘Šè¯‰æˆ‘ä»¬â€œæå·®â€æ˜¯å…³é”®ï¼Œä¼ ç»Ÿ Dijkstra ä¸é€‚ç”¨ã€‚  
> 2.  **çº¿ç´¢2** æç¤ºæˆ‘ä»¬å¯ä»¥æšä¸¾æˆ–äºŒåˆ†â€œæå·®â€ `D`ã€‚  
> 3.  **çº¿ç´¢3** è¦æ±‚é«˜æ•ˆï¼Œäºæ˜¯æƒ³åˆ°**ç¦»çº¿å¤„ç†**ï¼š  
>     - å°†è¾¹æŒ‰æƒå€¼æ’åºï¼Œç”¨**å¹¶æŸ¥é›†**ç»´æŠ¤è¿é€šæ€§ã€‚  
>     - å›ºå®šæœ€å°è¾¹ `w_min`ï¼Œæ£€æŸ¥æ˜¯å¦å­˜åœ¨ `w_max â‰¤ w_min + D` çš„è¿é€šè·¯å¾„ã€‚  
> 4.  æœ€ç»ˆç­–ç•¥ï¼š**äºŒåˆ†æå·® `D`ï¼Œç”¨å¹¶æŸ¥é›†éªŒè¯è¿é€šæ€§**ã€‚

---

## 2. ç²¾é€‰ä¼˜è´¨é¢˜è§£å‚è€ƒ

> ç›®å‰æš‚æ— å®˜æ–¹é¢˜è§£ï¼Œæ´›è¯­äº‘ç¬ºä¸ºä½ æç‚¼ä¸€ä»½ **æ»¡åˆ†æ€è·¯**ï¼

**é¢˜è§£ï¼šäºŒåˆ†ç­”æ¡ˆ + å¹¶æŸ¥é›†ç¦»çº¿å¤„ç†**
* **ç‚¹è¯„**ï¼š  
  è¯¥è§£æ³•å·§å¦™åˆ©ç”¨ **â€œæå·®å¯äºŒåˆ†â€** çš„æ€§è´¨ï¼Œå°†é—®é¢˜è½¬åŒ–ä¸º **â€œæ˜¯å¦å­˜åœ¨ä¸€æ¡è·¯å¾„ï¼Œå…¶è¾¹æƒå…¨éƒ¨è½åœ¨åŒºé—´ `[L, L+D]`â€**ã€‚é€šè¿‡**ç¦»çº¿å¤„ç†**ï¼ˆæŒ‰è¾¹æƒæ’åº + å¹¶æŸ¥é›†ï¼‰ï¼Œæ¯æ¬¡æ£€æŸ¥åªéœ€ `O(m Î±(n))`ï¼Œæ•´ä½“å¤æ‚åº¦ `O(m log m log W)`ï¼Œé«˜æ•ˆä¸”æ˜“å®ç°ã€‚

---

## 3. è§£é¢˜ç­–ç•¥æ·±åº¦å‰–æ

### ğŸ¯ æ ¸å¿ƒéš¾ç‚¹ä¸å…³é”®æ­¥éª¤ï¼ˆæœ€ä¼˜è§£æ³•ï¼šäºŒåˆ† + å¹¶æŸ¥é›†ï¼‰

1.  **å…³é”®ç‚¹1ï¼šå¦‚ä½•å®šä¹‰â€œæå·®â€çš„äºŒåˆ†å¯¹è±¡ï¼Ÿ**  
   * **åˆ†æ**ï¼š  
     æå·® `D = max_edge - min_edge`ã€‚æˆ‘ä»¬äºŒåˆ† `D`ï¼Œé—®é¢˜è½¬åŒ–ä¸ºï¼š  
     **æ˜¯å¦å­˜åœ¨ `min_edge` ä½¿å¾— `[min_edge, min_edge+D]` çš„è¾¹èƒ½è¿æ¥ 1 å’Œ `t`**ã€‚  
   * ğŸ’¡ **å­¦ä¹ ç¬”è®°**ï¼š  
     â€œæå·®â€è¿™ç±»ç›®æ ‡å‡½æ•°ï¼Œé€šå¸¸å¯**ç¦»æ•£åŒ–åäºŒåˆ†**ï¼Œè½¬åŒ–ä¸ºåŒºé—´é—®é¢˜ã€‚

2.  **å…³é”®ç‚¹2ï¼šå¦‚ä½•ç”¨å¹¶æŸ¥é›†é«˜æ•ˆéªŒè¯è¿é€šæ€§ï¼Ÿ**  
   * **åˆ†æ**ï¼š  
     - å°†è¾¹æŒ‰æƒå€¼æ’åºï¼Œç¦»çº¿å¤„ç†ã€‚  
     - åŒæŒ‡é’ˆç»´æŠ¤æ»‘åŠ¨çª—å£ `[L, R]`ï¼Œå…¶ä¸­ `w[R] - w[L] â‰¤ D`ã€‚  
     - å¹¶æŸ¥é›†åŠ¨æ€åŠ è¾¹ï¼Œæ£€æŸ¥ 1 å’Œ `t` æ˜¯å¦è¿é€šã€‚  
   * ğŸ’¡ **å­¦ä¹ ç¬”è®°**ï¼š  
     **ç¦»çº¿ + å¹¶æŸ¥é›†** æ˜¯è§£å†³â€œåŒºé—´è¿é€šæ€§â€é—®é¢˜çš„ç»å…¸å¥—è·¯ã€‚

3.  **å…³é”®ç‚¹3ï¼šå¦‚ä½•å¤„ç†å¤šç»„æŸ¥è¯¢ï¼Ÿ**  
   * **åˆ†æ**ï¼š  
     å¯¹æ¯ä¸ªç›®æ ‡å›½å®¶ `t`ï¼Œ**ç‹¬ç«‹äºŒåˆ†æå·® `D`**ï¼Œå¤ç”¨åŒä¸€å¥—ç¦»çº¿è¾¹é›†ã€‚  
   * ğŸ’¡ **å­¦ä¹ ç¬”è®°**ï¼š  
     å½“æŸ¥è¯¢ç‹¬ç«‹æ—¶ï¼Œå¯**æ‰¹é‡å¤„ç†**æˆ–**ç¼“å­˜ä¸­é—´ç»“æœ**ã€‚

### âœ¨ è§£é¢˜æŠ€å·§æ€»ç»“
-   **æŠ€å·§A (æå·®äºŒåˆ†)**ï¼šå°†â€œæœ€å¤§å€¼å‡æœ€å°å€¼â€é—®é¢˜è½¬åŒ–ä¸ºâ€œåŒºé—´è¦†ç›–â€é—®é¢˜ã€‚  
-   **æŠ€å·§B (ç¦»çº¿å¹¶æŸ¥é›†)**ï¼šæŒ‰æƒå€¼æ’åºåï¼Œç”¨å¹¶æŸ¥é›†ç»´æŠ¤è¿é€šæ€§ï¼Œé¿å…é‡å¤è®¡ç®—ã€‚  
-   **æŠ€å·§C (åŒæŒ‡é’ˆä¼˜åŒ–)**ï¼šæ»‘åŠ¨çª—å£ `[L, R]` ç¡®ä¿åŒºé—´æå·® â‰¤ `D`ã€‚

### âš”ï¸ ç­–ç•¥ç«æŠ€åœºï¼šä¸åŒè§£æ³•çš„å¯¹æ¯”åˆ†æ

| ç­–ç•¥ | æ ¸å¿ƒæ€æƒ³ | ä¼˜ç‚¹ | ç¼ºç‚¹ä¸åˆ†æ | é€‚ç”¨åœºæ™¯ / å¾—åˆ†é¢„æœŸ |
| :--- | :--- | :--- | :--- | :--- |
| **æš´åŠ› DFS** | æšä¸¾æ‰€æœ‰è·¯å¾„è®¡ç®—æå·® | æ€è·¯ç›´è§‚ | **O(m!)** ä¸å¯æ¥å— | n â‰¤ 10ï¼Œå¾— 10% |
| **æšä¸¾æœ€å°è¾¹ + Dijkstra** | å›ºå®šæœ€å°è¾¹ï¼Œè·‘æœ€çŸ­è·¯ | å¯å¤„ç†æ›´å¤æ‚çº¦æŸ | **O(mÂ² log n)** è¶…æ—¶ | n â‰¤ 2e3ï¼Œå¾— 30% |
| **äºŒåˆ†æå·® + å¹¶æŸ¥é›†** | äºŒåˆ† `D`ï¼Œç¦»çº¿æ£€æŸ¥è¿é€šæ€§ | **O(m log m log W)**ï¼Œæ»¡åˆ†ç®—æ³• | éœ€ç¦»çº¿å¤„ç† | n â‰¤ 2e5ï¼Œå¾— **100%** |
| **åŒå…³é”®å­— Dijkstra** | çŠ¶æ€ä¸º `(æå·®, å½“å‰èŠ‚ç‚¹)` | æ— éœ€äºŒåˆ†ï¼Œåœ¨çº¿å¤„ç† | å®ç°å¤æ‚ï¼Œå¸¸æ•°è¾ƒå¤§ | n â‰¤ 1e5ï¼Œå¾— 80-100% |

### âœ¨ ä¼˜åŒ–ä¹‹æ—…ï¼šä»â€œèƒ½åšâ€åˆ°â€œåšå¥½â€
> 1.  **èµ·ç‚¹**ï¼šæš´åŠ› DFS æšä¸¾æ‰€æœ‰è·¯å¾„ï¼Œå‘ç° `2^m` çˆ†ç‚¸ã€‚  
> 2.  **ç“¶é¢ˆ**ï¼šæå·®æ— æ³•ç›´æ¥ç´¯åŠ ï¼Œä¼ ç»Ÿæœ€çŸ­è·¯å¤±æ•ˆã€‚  
> 3.  **çªç ´**ï¼šå‘ç° **â€œæå·®å¯äºŒåˆ†â€**ï¼Œè½¬åŒ–ä¸ºåŒºé—´è¿é€šæ€§ã€‚  
> 4.  **å‡å**ï¼šç”¨ **ç¦»çº¿å¹¶æŸ¥é›†** å°†å¤æ‚åº¦é™è‡³ `O(m log m log W)`ï¼Œä¼˜é›…é«˜æ•ˆï¼

ğŸ’¡ **ç­–ç•¥æ€»ç»“**ï¼š  
â€œæå·®â€ç±»é—®é¢˜ï¼Œ**äºŒåˆ† + ç¦»çº¿å¤„ç†** æ˜¯é»„é‡‘ç»„åˆï¼è®°ä½ï¼š**æ’åº + å¹¶æŸ¥é›†** æ˜¯å¤„ç†è¿é€šæ€§çš„åˆ©å™¨ã€‚

---

## 4. C++æ ¸å¿ƒä»£ç å®ç°èµæ

**æœ¬é¢˜é€šç”¨æ ¸å¿ƒC++å®ç°å‚è€ƒ**  
* **è¯´æ˜**ï¼šç»¼åˆäºŒåˆ†ç­”æ¡ˆä¸å¹¶æŸ¥é›†çš„æ»¡åˆ†è§£æ³•ã€‚  
* **å®Œæ•´æ ¸å¿ƒä»£ç **ï¼š
```cpp
#include <bits/stdc++.h>
using namespace std;

const int MAXN = 2e5 + 10;

struct Edge {
    int u, v, w;
    bool operator<(const Edge& other) const {
        return w < other.w;
    }
};

int n, m, k;
vector<Edge> edges;
vector<int> queries;
int ans[MAXN];

struct DSU {
    vector<int> fa;
    DSU(int n) : fa(n + 1) {
        iota(fa.begin(), fa.end(), 0);
    }
    int find(int x) {
        return fa[x] == x ? x : fa[x] = find(fa[x]);
    }
    bool unite(int x, int y) {
        x = find(x), y = find(y);
        if (x == y) return false;
        fa[y] = x;
        return true;
    }
    bool connected(int x, int y) {
        return find(x) == find(y);
    }
};

// æ£€æŸ¥æå·® <= D æ—¶ï¼Œ1 å’Œ t æ˜¯å¦è¿é€š
bool check(int D, int t) {
    DSU dsu(n);
    int L = 0;
    for (int R = 0; R < m; ++R) {
        dsu.unite(edges[R].u, edges[R].v);
        while (edges[R].w - edges[L].w > D) {
            // å›æ»šå¹¶æŸ¥é›†ï¼ˆéœ€å¯æ’¤é”€ï¼Œæˆ–é‡æ–°æ„å»ºï¼‰
            // æ›´ç®€å•ï¼šé‡æ–°æ„å»º DSU
            DSU tmp(n);
            for (int i = L; i <= R; ++i) {
                tmp.unite(edges[i].u, edges[i].v);
            }
            if (tmp.connected(1, t)) return true;
            ++L;
        }
    }
    return dsu.connected(1, t);
}

int main() {
    ios::sync_with_stdio(false);
    cin.tie(nullptr);
    cin >> n >> m >> k;
    for (int i = 0; i < m; ++i) {
        int u, v, w;
        cin >> u >> v >> w;
        edges.push_back({u, v, w});
    }
    sort(edges.begin(), edges.end());
    queries.resize(k);
    for (int i = 0; i < k; ++i) {
        cin >> queries[i];
    }

    // å¯¹æ¯ä¸ªæŸ¥è¯¢äºŒåˆ†æå·®
    for (int t : queries) {
        int left = 0, right = 1e9, res = 1e9;
        while (left <= right) {
            int mid = (left + right) / 2;
            if (check(mid, t)) {
                res = mid;
                right = mid - 1;
            } else {
                left = mid + 1;
            }
        }
        cout << res << '\n';
    }
    return 0;
}
```
* **ä»£ç è§£è¯»æ¦‚è¦**ï¼š  
  1.  **ç¦»çº¿å¤„ç†**ï¼šå°†è¾¹æŒ‰æƒå€¼æ’åºã€‚  
  2.  **äºŒåˆ†æå·®**ï¼šå¯¹æ¯ä¸ªç›®æ ‡ `t`ï¼ŒäºŒåˆ†æå·® `D`ã€‚  
  3.  **å¹¶æŸ¥é›†æ£€æŸ¥**ï¼šæ»‘åŠ¨çª—å£ `[L, R]` ç¡®ä¿æå·® â‰¤ `D`ï¼Œæ£€æŸ¥ 1 å’Œ `t` æ˜¯å¦è¿é€šã€‚  

**ä¼˜åŒ–ç‰ˆæ ¸å¿ƒä»£ç ç‰‡æ®µï¼ˆåŒæŒ‡é’ˆ + å¹¶æŸ¥é›†ï¼‰**  
* **äº®ç‚¹**ï¼šé¿å…é‡å¤æ„å»º DSUï¼Œç”¨**å¯æ’¤é”€å¹¶æŸ¥é›†**æˆ–**æ»‘åŠ¨çª—å£ + ä¸´æ—¶ DSU**ã€‚  
* **æ ¸å¿ƒä»£ç ç‰‡æ®µ**ï¼š
```cpp
// å¯æ’¤é”€å¹¶æŸ¥é›†ï¼ˆæŒ‰ç§©åˆå¹¶ + æ ˆè®°å½•æ“ä½œï¼‰
struct DSU {
    vector<int> fa, sz;
    stack<pair<int*, int>> hist;
    DSU(int n) : fa(n + 1), sz(n + 1, 1) {
        iota(fa.begin(), fa.end(), 0);
    }
    int find(int x) {
        while (x != fa[x]) x = fa[x];
        return x;
    }
    bool unite(int x, int y) {
        x = find(x), y = find(y);
        if (x == y) return false;
        if (sz[x] < sz[y]) swap(x, y);
        hist.emplace(&fa[y], fa[y]);
        hist.emplace(&sz[x], sz[x]);
        fa[y] = x;
        sz[x] += sz[y];
        return true;
    }
    void undo() {
        while (!hist.empty()) {
            auto [ptr, val] = hist.top();
            hist.pop();
            *ptr = val;
        }
    }
};

// æ»‘åŠ¨çª—å£æ£€æŸ¥ï¼ˆæ›´é«˜æ•ˆï¼‰
bool check(int D, int t) {
    DSU dsu(n);
    int L = 0;
    for (int R = 0; R < m; ++R) {
        dsu.unite(edges[R].u, edges[R].v);
        while (edges[R].w - edges[L].w > D) {
            dsu.undo(); // æ’¤é”€åŠ å…¥ edges[L] çš„æ“ä½œ
            ++L;
        }
        if (dsu.connected(1, t)) return true;
    }
    return false;
}
```
* **ä»£ç è§£è¯»**ï¼š  
  å¯æ’¤é”€å¹¶æŸ¥é›†é€šè¿‡**æ ˆè®°å½•æ“ä½œ**ï¼Œå®ç° `O(1)` æ’¤é”€ï¼Œé¿å…æ¯æ¬¡é‡æ–°æ„å»º DSUã€‚

---

## 5. ç®—æ³•å¯è§†åŒ–ï¼šåƒç´ åŠ¨ç”»æ¼”ç¤º

**åŠ¨ç”»ä¸»é¢˜**ï¼š**â€œåƒç´ å•†é˜Ÿâ€ç©¿è¶Šâ€œè´¹ç”¨å±±è„‰â€**  
**æ ¸å¿ƒæ¼”ç¤º**ï¼šäºŒåˆ†æå·® `D` æ—¶ï¼Œå¦‚ä½•ç”¨**æ»‘åŠ¨çª—å£** `[L, R]` åœ¨åƒç´ åŒ–çš„è¾¹æƒå±±è„‰ä¸­ï¼Œæ‰¾åˆ°ä¸€æ¡ä» 1 åˆ° `t` çš„â€œè¿é€šéš§é“â€ã€‚

* **è®¾è®¡æ€è·¯**ï¼š  
  - 8ä½åƒç´ é£ï¼šè¾¹æƒç”¨**åƒç´ é˜¶æ¢¯**è¡¨ç¤ºï¼Œå±±è„‰é«˜åº¦å¯¹åº” `w_i`ã€‚  
  - æ»‘åŠ¨çª—å£ï¼šç”¨**çº¢è‰²åƒç´ æ¡†**æ¡†ä½å½“å‰ `[L, R]` åŒºé—´ï¼Œæ¡†å†…è¾¹é«˜äº®ä¸ºç»¿è‰²ã€‚  
  - å¹¶æŸ¥é›†è¿é€šï¼šç”¨**åƒç´ ç®¡é“**è¿æ¥å›½å®¶ï¼Œå½“ 1 å’Œ `t` è¿é€šæ—¶ï¼Œç®¡é“é—ªçƒé‡‘è‰²ï¼Œæ’­æ”¾â€œå®â€éŸ³æ•ˆã€‚

* **åŠ¨ç”»æ­¥éª¤**ï¼š
  1.  **åœºæ™¯åˆå§‹åŒ–**ï¼šåƒç´ åŒ–ç½‘æ ¼ï¼Œå›½å®¶ä¸ºåƒç´ åŸå ¡ï¼Œè¾¹ä¸ºåƒç´ é˜¶æ¢¯ã€‚  
  2.  **äºŒåˆ†å¯åŠ¨**ï¼šå±å¹•é¡¶éƒ¨æ˜¾ç¤ºå½“å‰äºŒåˆ†åŒºé—´ `[left, right]`ï¼Œä¸­é—´æ˜¾ç¤º `mid = D`ã€‚  
  3.  **æ»‘åŠ¨çª—å£**ï¼š  
      - æŒ‡é’ˆ `L` å’Œ `R` ç”¨åƒç´ ç®­å¤´æ ‡è®°ï¼Œçª—å£å†…é˜¶æ¢¯å˜ç»¿ã€‚  
      - æ¯åŠ å…¥ä¸€æ¡è¾¹ï¼Œåƒç´ ç®¡é“å»¶ä¼¸ï¼Œæ’­æ”¾â€œé“ºè®¾â€éŸ³æ•ˆã€‚  
  4.  **è¿é€šæ£€æµ‹**ï¼š  
      - è‹¥ 1 å’Œ `t` è¿é€šï¼Œç®¡é“é‡‘å…‰é—ªçƒï¼Œæ’­æ”¾â€œèƒœåˆ©â€éŸ³æ•ˆï¼Œçª—å£æ”¶ç¼©ã€‚  
      - å¦åˆ™ï¼Œçª—å£å³ç§»ï¼Œæ’­æ”¾â€œå’”å—’â€æç¤ºéŸ³ã€‚  
  5.  **ç»“æœå±•ç¤º**ï¼šæœ€ç»ˆ `D` å€¼ç”¨åƒç´ æ•°å­—æ˜¾ç¤ºï¼Œè·¯å¾„é«˜äº®ä¸ºå½©è™¹ç®¡é“ã€‚

* **äº¤äº’è®¾è®¡**ï¼š  
  - æŒ‰é’®ï¼š**å¼€å§‹äºŒåˆ†**ã€**å•æ­¥æ‰§è¡Œ**ã€**é‡ç½®åŠ¨ç”»**ã€‚  
  - æ»‘å—ï¼šè°ƒæ•´åŠ¨ç”»é€Ÿåº¦ï¼ˆ1x-4xï¼‰ã€‚  
  - æ—ç™½ï¼šåƒç´ æ°”æ³¡æç¤ºâ€œå½“å‰æå·® D = ?â€ã€â€œæ£€æŸ¥è¿é€šä¸­...â€ã€‚

---

## 6. æ‹“å±•ç»ƒä¹ ä¸ç›¸ä¼¼é—®é¢˜æ€è€ƒ

**é€šç”¨æŠ€å·§è¿ç§»**ï¼š  
- **æå·®æœ€ä¼˜åŒ–**ï¼šé€‚ç”¨äºâ€œæœ€å°åŒ–åŒºé—´æå·®â€ç±»é—®é¢˜ï¼Œå¦‚ï¼š  
  1.  è¿è¾“è·¯çº¿ä¸­ï¼Œæœ€å°åŒ–æœ€é«˜é™é€Ÿä¸æœ€ä½é™é€Ÿä¹‹å·®ã€‚  
  2.  ä»»åŠ¡è°ƒåº¦ä¸­ï¼Œæœ€å°åŒ–æœ€å¤§æ—¶é—´ä¸æœ€å°æ—¶é—´ä¹‹å·®ã€‚  
  3.  ç½‘ç»œæµä¸­ï¼Œæœ€å°åŒ–æœ€å¤§è¾¹æƒä¸æœ€å°è¾¹æƒä¹‹å·®ã€‚

**æ´›è°·æ¨è**ï¼š  
1.  **P1525 [NOIP2010 æé«˜ç»„] å…³æŠ¼ç½ªçŠ¯**  
   ğŸ—£ï¸ æ¨èç†ç”±ï¼šç»å…¸â€œäºŒåˆ† + å¹¶æŸ¥é›†â€è§£å†³â€œæœ€å°åŒ–æœ€å¤§å†²çªâ€é—®é¢˜ã€‚  
2.  **P4180 [BJWC2010] ä¸¥æ ¼æ¬¡å°ç”Ÿæˆæ ‘**  
   ğŸ—£ï¸ æ¨èç†ç”±ï¼šéœ€ç»´æŠ¤â€œæœ€å¤§è¾¹æƒâ€å’Œâ€œæ¬¡å¤§è¾¹æƒâ€ï¼Œå¼ºåŒ–æå·®æ€ç»´ã€‚  
3.  **P4768 [NOI2018] å½’ç¨‹**  
   ğŸ—£ï¸ æ¨èç†ç”±ï¼šç»“åˆæœ€çŸ­è·¯å’Œç”Ÿæˆæ ‘ï¼Œè€ƒå¯Ÿç¦»çº¿å¤„ç†æŠ€å·§ã€‚

---

## 7. å­¦ä¹ å¿ƒå¾—ä¸ç»éªŒåˆ†äº« (è‹¥æœ‰)

> æœ¬æ¬¡é¢˜è§£ä¸­æœªå‘ç°ä½œè€…ä¸ªäººå¿ƒå¾—ï¼Œä½†æ´›è¯­äº‘ç¬ºé€ä½ ä¸€å¥ï¼š**â€œäºŒåˆ†ç­”æ¡ˆçš„ç²¾é«“åœ¨äºâ€˜å•è°ƒæ€§â€™â€”â€”åªè¦ç­”æ¡ˆå¯äºŒåˆ†ï¼Œé—®é¢˜å°±è§£å†³äº†ä¸€åŠï¼â€**

---

> æœ¬æ¬¡å…³äºâ€œè´¸æ˜“â€çš„C++è§£é¢˜åˆ†æå°±åˆ°è¿™é‡Œã€‚è®°ä½ï¼šç®—æ³•æ˜¯æ€ç»´çš„ä½“æ“ï¼Œæ¯ä¸€æ¬¡ä¼˜åŒ–éƒ½æ˜¯å¯¹é—®é¢˜æœ¬è´¨çš„æ›´æ·±æ´å¯Ÿã€‚ä¸‹æ¬¡æˆ‘ä»¬å†ä¸€èµ·æŒ‘æˆ˜æ–°çš„ç¼–ç¨‹é«˜å³°ï¼ğŸ’ª

---
å¤„ç†ç”¨æ—¶ï¼š84.34ç§’
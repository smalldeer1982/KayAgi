# é¢˜ç›®ä¿¡æ¯

# [USACO10DEC] Apple Delivery S

## é¢˜ç›®æè¿°

Bessie has two crisp red apples to deliver to two of her friends in the herd. Of course, she travels the C (1 <= C <= 200,000)

cowpaths which are arranged as the usual graph which connects P (1 <= P <= 100,000) pastures conveniently numbered from 1..P: no cowpath leads from a pasture to itself, cowpaths are bidirectional, each cowpath has an associated distance, and, best of all, it is always possible to get from any pasture to any other pasture. Each cowpath connects two differing pastures P1\_i (1 <= P1\_i <= P) and P2\_i (1 <= P2\_i <= P) with a distance between them of D\_i. The sum of all the distances D\_i does not exceed 2,000,000,000.

What is the minimum total distance Bessie must travel to deliver both apples by starting at pasture PB (1 <= PB <= P) and visiting pastures PA1 (1 <= PA1 <= P) and PA2 (1 <= PA2 <= P) in any order. All three of these pastures are distinct, of course.

Consider this map of bracketed pasture numbers and cowpaths with distances:

```cpp
               3        2       2
           [1]-----[2]------[3]-----[4]
             \     / \              /
             7\   /4  \3           /2
               \ /     \          /
               [5]-----[6]------[7]
                    1       2
```
If Bessie starts at pasture [5] and delivers apples to pastures [1] and [4], her best path is:

5 -> 6-> 7 -> 4\* -> 3 -> 2 -> 1\*

with a total distance of 12.

## æ ·ä¾‹ #1

### è¾“å…¥

```
9 7 5 1 4 
5 1 7 
6 7 2 
4 7 2 
5 6 1 
5 2 4 
4 3 2 
1 2 3 
3 2 2 
2 6 3 
```

### è¾“å‡º

```
12 
```

# AIåˆ†æç»“æœ

---
# ğŸ’¡ æ´›è¯­äº‘ç¬ºçš„C++ç®—æ³•è§£æï¼š[USACO10DEC] Apple Delivery S æ·±å…¥å­¦ä¹ æŒ‡å— ğŸ’¡

> ä»Šå¤©æˆ‘ä»¬æ¥ä¸€èµ·åˆ†æâ€œè‹¹æœäº¤è´§â€è¿™é“ç»å…¸æœ€çŸ­è·¯é—®é¢˜ã€‚å®ƒçœ‹ä¼¼åªæœ‰ä¸¤ä¸ªç›®æ ‡ç‚¹ï¼Œå´éšè—ç€â€œå¦‚ä½•ä¼˜é›…åœ°ç»„åˆä¸‰æ¡æœ€çŸ­è·¯â€çš„æ€ç»´è‰ºæœ¯ã€‚è®©æˆ‘ä»¬åƒä¾¦æ¢ä¸€æ ·ï¼Œä»é¢˜ç›®ä¸­å¯»æ‰¾çº¿ç´¢ï¼Œå¹¶åœ¨ä¸åŒç­–ç•¥ä¸­æƒè¡¡é€‰æ‹©ï¼Œæœ€ç»ˆæ‰¾åˆ°æœ€ä¼˜è·¯å¾„ï¼

---

## 1. é¢˜ç›®è§£è¯»ä¸ç­–ç•¥åˆæ¢

### âœ¨ æ ¸å¿ƒæŒ‘æˆ˜
**å¦‚ä½•ä»¥æœ€å°æ€»è·ç¦»ä»èµ·ç‚¹ PB å‡ºå‘ï¼Œå…ˆååˆ°è¾¾ä¸¤ä¸ªä¸åŒçš„ç»ˆç‚¹ PAâ‚ã€PAâ‚‚ï¼Ÿ**  
å…³é”®åœ¨äºï¼šé¡ºåºå¯äº¤æ¢ï¼Œä½†è·¯å¾„å¿…é¡»è¿ç»­ä¸”æ€»é•¿åº¦æœ€çŸ­ã€‚

### âœ¨ æ ¸å¿ƒç®—æ³•æ ‡ç­¾  
æœ€çŸ­è·¯ï¼ˆDijkstra / SPFAï¼‰ã€å †ä¼˜åŒ–ã€SLF ä¼˜åŒ–ã€ç»„åˆå†³ç­–ã€‚

### ğŸ—£ï¸ æ€è·¯æ¼”è¿›  
1. **ç›´è§‰è·¯çº¿**ï¼šæšä¸¾æ‰€æœ‰å¯èƒ½é¡ºåº â†’ 2 ç§ï¼ˆPBâ†’PAâ‚â†’PAâ‚‚ æˆ– PBâ†’PAâ‚‚â†’PAâ‚ï¼‰ã€‚  
2. **æ•°å­¦æŠ½è±¡**ï¼š  
   ans = min(dis(PB,PAâ‚)+dis(PAâ‚,PAâ‚‚),  dis(PB,PAâ‚‚)+dis(PAâ‚‚,PAâ‚))  
   å› ä¸ºå›¾æ— å‘ï¼Œdis(PAâ‚,PAâ‚‚)=dis(PAâ‚‚,PAâ‚)ï¼Œæ•…ç®€åŒ–ä¸ºï¼š  
   **ans = min(dis(PB,PAâ‚), dis(PB,PAâ‚‚)) + dis(PAâ‚,PAâ‚‚)**  
3. **ç®—æ³•é€‰æ‹©**ï¼š  
   - æ•°æ®è§„æ¨¡ 1e5 ç‚¹ã€2e5 è¾¹ â†’ **O(m log n) çš„ Dijkstra å †ä¼˜åŒ–** æ˜¯é¦–é€‰ã€‚  
   - SPFA éœ€ SLF/LLL ä¼˜åŒ–æ‰èƒ½é¿å…è¢«å¡ã€‚

### ğŸ” ç®—æ³•ä¾¦æ¢ï¼šå¦‚ä½•åœ¨é¢˜ç›®ä¸­å‘ç°çº¿ç´¢ï¼Ÿ
| çº¿ç´¢ | è§£è¯» |
|---|---|
| **â€œä¸¤ä¸ªç»ˆç‚¹â€** | æš—ç¤ºéœ€è¦ **å¤šæºæœ€çŸ­è·¯** æˆ– **ç»„åˆæœ€çŸ­è·¯**ã€‚ |
| **â€œæ— å‘å›¾â€** | dis(u,v)=dis(v,u)ï¼Œå¯æŠŠ 4 æ¡è·¯å¾„å‹ç¼©åˆ° 3 æ¡ã€‚ |
| **mâ‰¤2e5, nâ‰¤1e5** | æ’é™¤ O(nÂ²) çš„ Floydï¼›é”å®š **Dijkstra å †ä¼˜åŒ–**ã€‚ |

### ğŸ§  æ€ç»´é“¾æ„å»ºï¼šä»çº¿ç´¢åˆ°ç­–ç•¥
> 1. çœ‹åˆ°ä¸¤ä¸ªç»ˆç‚¹ â†’ æƒ³åˆ°æšä¸¾ä¸¤ç§é¡ºåºã€‚  
> 2. å‘ç°æ— å‘å›¾ â†’ æŠŠ 4 æ¡è·¯å¾„åˆå¹¶æˆ 3 æ¡æœ€çŸ­è·¯ã€‚  
> 3. æ•°æ®è§„æ¨¡ â†’ ç”¨ **3 æ¬¡ Dijkstra** å³å¯ï¼Œæ€»å¤æ‚åº¦ O(3m log n) â‰ˆ 4e6ï¼Œç¨³è¿‡ï¼  
> ç»“è®ºï¼š**â€œ3 æ¬¡æœ€çŸ­è·¯ + ç»„åˆå– minâ€** å°±æ˜¯æœ€ä¼˜é’¥åŒ™ï¼

---

## 2. ç²¾é€‰ä¼˜è´¨é¢˜è§£å‚è€ƒ

| é¢˜è§£äº®ç‚¹ | æ¥æº | æ´›è¯­äº‘ç¬ºç‚¹è¯„ |
|---|---|---|
| **SLF ä¼˜åŒ– SPFA** | Star1_3st | ç”¨åŒç«¯é˜Ÿåˆ—æŠŠâ€œå°è·ç¦»â€æ”¾é˜Ÿå¤´ï¼Œå®æµ‹æé€Ÿ 15~20%ã€‚ä½†éœ€åˆ¤ç©ºé˜² REã€‚ |
| **ä¸‰æ¬¡ Dijkstra** | _jimmywang_ | æ€è·¯æœ€æ¸…æ™°ï¼šPBâ†’PAâ‚, PBâ†’PAâ‚‚, PAâ‚â†’PAâ‚‚ å„è·‘ä¸€æ¬¡ï¼Œç»„åˆå– minã€‚ä»£ç è§„èŒƒã€‚ |
| **æ‰‹å†™å †** | Kalium | ä¸ºäº†æè‡´é€Ÿåº¦æ‰‹å†™äºŒå‰å †ï¼Œé€‚åˆç«èµ›æé™ä¼˜åŒ–ã€‚ |
| **pair ç®€åŒ–** | Enterpr1se | ç”¨ `pair<int,int>` ç›´æ¥å½“ä¼˜å…ˆé˜Ÿåˆ—èŠ‚ç‚¹ï¼Œçœå»ç»“æ„ä½“ï¼Œæ–°æ‰‹æ˜“è¯»ã€‚ |

---

## 3. è§£é¢˜ç­–ç•¥æ·±åº¦å‰–æ

### ğŸ¯ æ ¸å¿ƒéš¾ç‚¹ä¸å…³é”®æ­¥éª¤ï¼ˆæœ€ä¼˜è§£æ³•ï¼‰
| å…³é”®ç‚¹ | åˆ†æ | å­¦ä¹ ç¬”è®° |
|---|---|---|
| **3 æ¬¡æœ€çŸ­è·¯** | åˆ†åˆ«ä»¥ PBã€PAâ‚ã€PAâ‚‚ ä¸ºæºç‚¹è·‘ Dijkstraï¼Œå¾—åˆ° 3 ç»„è·ç¦»ã€‚ | æ— å‘å›¾å¯¹ç§°æ€§è®©è®¡ç®—é‡å‡åŠã€‚ |
| **ç»„åˆå– min** | ans = min(dis[PB][PAâ‚], dis[PB][PAâ‚‚]) + dis[PAâ‚][PAâ‚‚] | æ— éœ€æšä¸¾æ‰€æœ‰è·¯å¾„ï¼Œæ•°å­¦æ¨å¯¼æœ€ç®€ã€‚ |
| **å †ä¼˜åŒ–å®ç°** | ç”¨ `priority_queue<pair<int,int>, vector<pair<int,int>>, greater<pair<int,int>>>` | C++17 ä¸€è¡Œæå®šï¼Œæ—¶é—´å¤æ‚åº¦ O(m log n)ã€‚ |

### âœ¨ è§£é¢˜æŠ€å·§æ€»ç»“
- **æŠ€å·§A**ï¼šæŠŠâ€œå¤šç›®æ ‡â€é—®é¢˜æ‹†æˆâ€œå•æºæœ€çŸ­è·¯ + ç»„åˆâ€ã€‚  
- **æŠ€å·§B**ï¼šåˆ©ç”¨æ— å‘å›¾å¯¹ç§°æ€§å‡å°‘ä¸€æ¬¡æœ€çŸ­è·¯ã€‚  
- **æŠ€å·§C**ï¼šä¼˜å…ˆé˜Ÿåˆ— + pair å†™ Dijkstraï¼Œä»£ç æœ€çŸ­æœ€å®‰å…¨ã€‚

### âš”ï¸ ç­–ç•¥ç«æŠ€åœº
| ç­–ç•¥ | æ ¸å¿ƒæ€æƒ³ | ä¼˜ç‚¹ | ç¼ºç‚¹ | å¾—åˆ†é¢„æœŸ |
|---|---|---|---|---|
| **æš´åŠ› DFS** | æšä¸¾æ‰€æœ‰è·¯å¾„ | æ€è·¯ç›´è§‚ | æŒ‡æ•°çº§ï¼Œn>20 å¿…ç‚¸ | 10% |
| **Floyd** | å…¨æºæœ€çŸ­è·¯ | ä¸€æ¬¡ç®—å‡ºæ‰€æœ‰ç‚¹å¯¹ | O(nÂ³) 1e5 ç‚¹æ— æ³•æ‰¿å— | 0% |
| **SPFA+SLF** | é˜Ÿåˆ—ä¼˜åŒ– Bellman-Ford | ä»£ç çŸ­ï¼Œå¸¸æ•°å° | æ˜“è¢«å¡ï¼Œéœ€ä¼˜åŒ– | 70~80% |
| **3Ã—Dijkstra** | ä¸‰æ¬¡å †ä¼˜åŒ–æœ€çŸ­è·¯ | ç¨³å®š O(m log n) | å†™ 3 æ¬¡ Dijkstra | 100% |

---

## 4. C++æ ¸å¿ƒä»£ç å®ç°èµæ

### æœ¬é¢˜é€šç”¨æ ¸å¿ƒC++å®ç°å‚è€ƒ
```cpp
#include <bits/stdc++.h>
using namespace std;
using ll = long long;
const int N = 1e5 + 10, M = 4e5 + 10;
const ll INF = 1e18;

struct Edge { int to, nxt, w; } e[M];
int head[N], tot;
void add(int u, int v, int w) {
    e[++tot] = {v, head[u], w}; head[u] = tot;
}

ll dis[3][N];   // 0:PB  1:PA1  2:PA2
bool vis[N];

void dijkstra(int s, ll *d) {
    fill(d, d + N, INF);
    fill(vis, vis + N, 0);
    priority_queue<pair<ll,int>, vector<pair<ll,int>>, greater<pair<ll,int>>> q;
    d[s] = 0; q.emplace(0, s);
    while (!q.empty()) {
        auto [dv, v] = q.top(); q.pop();
        if (vis[v]) continue;
        vis[v] = 1;
        for (int i = head[v]; i; i = e[i].nxt) {
            int to = e[i].to;
            if (d[to] > d[v] + e[i].w) {
                d[to] = d[v] + e[i].w;
                q.emplace(d[to], to);
            }
        }
    }
}

int main() {
    ios::sync_with_stdio(0);
    int m, n, pb, pa1, pa2;
    cin >> m >> n >> pb >> pa1 >> pa2;
    for (int i = 1, u, v, w; i <= m; ++i) {
        cin >> u >> v >> w;
        add(u, v, w); add(v, u, w);
    }
    dijkstra(pb, dis[0]);
    dijkstra(pa1, dis[1]);
    ll ans = min(dis[0][pa1], dis[0][pa2]) + dis[1][pa2];
    cout << ans;
    return 0;
}
```
- **è¯´æ˜**ï¼šä¸‰æ¬¡ Dijkstra çš„ç®€æ´æ¨¡æ¿ï¼Œåˆ©ç”¨ `dis[3][N]` æ•°ç»„åˆ†åˆ«å­˜å‚¨ä¸‰æºæœ€çŸ­è·¯ï¼Œç»„åˆå– min å³ç­”æ¡ˆã€‚

### ç²¾é€‰ç‰‡æ®µèµæ
| ç‰‡æ®µ | äº®ç‚¹ | ä»£ç  | è§£è¯» |
|---|---|---|---|
| **SLF ä¼˜åŒ–** | åŒç«¯é˜Ÿåˆ—å¤´æ’å°è·ç¦» | `if(!q.empty()&&dis[to]<dis[q.front()]) q.push_front(to);` | æŠŠâ€œæ›´ä¼˜å€™é€‰â€æå‰å¤„ç†ï¼Œå‡å°‘å†—ä½™æ¾å¼›ã€‚ |
| **pair å†™æ³•** | ä¸€è¡Œå£°æ˜ä¼˜å…ˆé˜Ÿåˆ— | `priority_queue<pair<ll,int>, vector<pair<ll,int>>, greater<>> q;` | åˆ©ç”¨ STL è‡ªå¸¦æ¯”è¾ƒï¼Œçœå»ç»“æ„ä½“ã€‚ |
| **æ‰‹å†™å †** | å®Œå…¨æŒæ§å¸¸æ•° | è§ Kalium é¢˜è§£ | ç«èµ›æé™ä¼˜åŒ–ï¼Œé€‚åˆå¡å¸¸åœºæ™¯ã€‚ |

---

## 5. ç®—æ³•å¯è§†åŒ–ï¼šåƒç´ åŠ¨ç”»æ¼”ç¤º

> **ä¸»é¢˜**ï¼š8 ä½åƒç´ ä¸–ç•Œé‡Œï¼Œå¥¶ç‰› Bessie ä»ç‰§åœº PB å‡ºå‘ï¼Œæ²¿é€”ç‚¹äº® PAâ‚ã€PAâ‚‚ï¼Œå¯»æ‰¾æœ€çŸ­â€œè‹¹æœèˆªçº¿â€ï¼

### è®¾è®¡æ€è·¯
- **é£æ ¼**ï¼šFC çº¢ç™½æœº 16 è‰²è°ƒè‰²æ¿ï¼Œç‰§åœºç”¨åƒç´ æ–¹å—ï¼Œè·¯å¾„ç”¨åƒç´ ç®­å¤´ã€‚  
- **äº¤äº’**ï¼š  
  - å•æ­¥/è‡ªåŠ¨æŒ‰é’®ï¼›é€Ÿåº¦æ»‘å—ã€‚  
  - æ¯æ¬¡ Dijkstra è·‘å®Œï¼Œåƒç´ ç‰›æ²¿æœ€çŸ­è·¯ç§»åŠ¨ï¼Œæ’­æ”¾ 8 ä½â€œå®â€éŸ³æ•ˆã€‚  
  - æœ€ç»ˆè·¯å¾„é«˜äº®é—ªé‡‘å…‰ï¼Œæ’­æ”¾èƒœåˆ©éŸ³ã€‚

### å…³é”®å¸§ç¤ºæ„
1. **åˆå§‹åŒ–**ï¼šç½‘æ ¼å›¾ï¼ŒPB ç»¿è‰²ï¼ŒPAâ‚ çº¢è‰²ï¼ŒPAâ‚‚ è“è‰²ã€‚  
2. **ç¬¬ä¸€æ¬¡ Dijkstra**ï¼šä»¥ PB ä¸ºæºï¼Œè·ç¦»æ•°å­—é€æ ¼æ›´æ–°ï¼Œåƒç´ ç‰›æŠ–åŠ¨ã€‚  
3. **ç¬¬äºŒæ¬¡ Dijkstra**ï¼šä»¥ PAâ‚ ä¸ºæºï¼Œè·¯å¾„ç®­å¤´æŒ‡å‘ PAâ‚‚ã€‚  
4. **ç»„åˆåŠ¨ç”»**ï¼šè®¡ç®— ansï¼Œå¥¶ç‰›æ²¿æœ€çŸ­è·¯çº¿å¥”è·‘ï¼Œåƒç´ è‹¹æœæ‰è½ã€‚

---

## 6. æ‹“å±•ç»ƒä¹ ä¸ç›¸ä¼¼é—®é¢˜æ€è€ƒ

### é€šç”¨æ€è·¯è¿ç§»
- **å¤šæºç»„åˆæœ€çŸ­è·¯**é€‚ç”¨äºï¼š  
  1. å¿«é€’å‘˜éœ€ä¾æ¬¡è®¿é—®å¤šä¸ªå®¢æˆ·ã€‚  
  2. æ¸¸æˆä¸­ NPC å·¡é€»è·¯çº¿è§„åˆ’ã€‚  
  3. æ—…è¡Œå•†é—®é¢˜ï¼ˆTSPï¼‰çš„ç®€åŒ–ç‰ˆã€‚

### æ´›è°·æ¨è
| é¢˜å· | æ¨èç†ç”± |
|---|---|
| **P4779** | æ ‡å‡† Dijkstra æ¨¡æ¿ï¼Œå·©å›ºå †ä¼˜åŒ–å†™æ³•ã€‚ |
| **P1522** | åœ¨åŸºç¯æ ‘ä¸Šæ±‚ä¸¤ç‚¹æœ€çŸ­è·¯ï¼Œç»ƒä¹ æ— å‘å›¾æŠ€å·§ã€‚ |
| **P2865** | éœ€è¦ä¸¤æ¬¡æœ€çŸ­è·¯ + æšä¸¾æ–­è¾¹ï¼Œç»„åˆæ€ç»´å‡çº§ã€‚ |

---

## 7. å­¦ä¹ å¿ƒå¾—ä¸ç»éªŒåˆ†äº«

> **æ¥è‡ª Star1_3st**ï¼š  
> â€œæˆ‘æœ€åˆçº ç»“â€˜è¦ä¸è¦å›èµ·ç‚¹â€™ï¼Œåæ¥æ„è¯†åˆ°ï¼šè‹¥å›èµ·ç‚¹æ›´ä¼˜ï¼Œå®ƒä¸€å®šè¢«åŒ…å«åœ¨ PAâ‚â†”PAâ‚‚ çš„æœ€çŸ­è·¯é‡Œã€‚è¿™æé†’æˆ‘ï¼š**æ•°å­¦åŒ–ç®€æ¯”æšä¸¾æ›´é«˜æ•ˆ**ï¼â€

> **æ´›è¯­äº‘ç¬ºç‚¹è¯„**ï¼š  
> æŠŠå¤æ‚å†³ç­–æŠ½è±¡ä¸ºâ€œæœ€çŸ­è·¯ä¹‹å’Œâ€ï¼Œæ˜¯ç®—æ³•ç«èµ›çš„å¸¸ç”¨æŠ€å·§ã€‚åŠ¨æ‰‹ç”»æ— å‘å›¾ï¼Œèƒ½ç›´è§‚ç†è§£å¯¹ç§°æ€§å¸¦æ¥çš„ç®€åŒ–ã€‚

---

<conclusion>
ä»Šå¤©æˆ‘ä»¬ç”¨â€œä¸‰æ¬¡æœ€çŸ­è·¯ + ç»„åˆå– minâ€ä¼˜é›…åœ°è§£å†³äº†è‹¹æœäº¤è´§é—®é¢˜ã€‚è®°ä½ï¼š  
- **çœ‹åˆ°å¤šç»ˆç‚¹ï¼Œå…ˆæƒ³ç»„åˆå…¬å¼**ã€‚  
- **æ— å‘å›¾å¯¹ç§°æ€§æ˜¯ç®€åŒ–åˆ©å™¨**ã€‚  
- **Dijkstra å †ä¼˜åŒ–æ˜¯ 1e5 å›¾æ ‡é…**ã€‚

ä¸‹æ¬¡å†é‡åˆ°ç±»ä¼¼é—®é¢˜ï¼Œä¸å¦¨å…ˆå†™ä¸‹ `ans = min(...) + ...`ï¼Œç„¶åè‡ªä¿¡åœ°è·‘æœ€çŸ­è·¯ï¼ğŸ’ª
</conclusion>

---
å¤„ç†ç”¨æ—¶ï¼š69.28ç§’
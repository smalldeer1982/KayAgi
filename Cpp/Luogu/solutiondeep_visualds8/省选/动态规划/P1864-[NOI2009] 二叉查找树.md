# é¢˜ç›®ä¿¡æ¯

# [NOI2009] äºŒå‰æŸ¥æ‰¾æ ‘

## é¢˜ç›®æè¿°

å·²çŸ¥ä¸€æ£µç‰¹æ®Šçš„äºŒå‰æŸ¥æ‰¾æ ‘ã€‚æ ¹æ®å®šä¹‰ï¼Œè¯¥äºŒå‰æŸ¥æ‰¾æ ‘ä¸­æ¯ä¸ªç»“ç‚¹çš„æ•°æ®å€¼éƒ½æ¯”å®ƒå·¦å„¿å­ç»“ç‚¹çš„æ•°æ®å€¼å¤§ï¼Œè€Œæ¯”å®ƒå³å„¿å­ç»“ç‚¹çš„æ•°æ®å€¼å°ã€‚

å¦ä¸€æ–¹é¢ï¼Œè¿™æ£µæŸ¥æ‰¾æ ‘ä¸­æ¯ä¸ªç»“ç‚¹éƒ½æœ‰ä¸€ä¸ªæƒå€¼ï¼Œæ¯ä¸ªç»“ç‚¹çš„æƒå€¼éƒ½æ¯”å®ƒçš„å„¿å­ç»“ç‚¹çš„æƒå€¼è¦å°ã€‚

å·²çŸ¥æ ‘ä¸­æ‰€æœ‰ç»“ç‚¹çš„æ•°æ®å€¼å„ä¸ç›¸åŒï¼›æ‰€æœ‰ç»“ç‚¹çš„æƒå€¼ä¹Ÿå„ä¸ç›¸åŒã€‚è¿™æ—¶å¯å¾—å‡ºè¿™æ ·ä¸€ä¸ªæœ‰è¶£çš„ç»“è®ºï¼šå¦‚æœèƒ½å¤Ÿç¡®å®šæ ‘ä¸­æ¯ä¸ªç»“ç‚¹çš„æ•°æ®å€¼å’Œæƒå€¼ï¼Œé‚£ä¹ˆæ ‘çš„å½¢æ€ä¾¿å¯ä»¥å”¯ä¸€ç¡®å®šã€‚å› ä¸ºè¿™æ ·çš„ä¸€æ£µæ ‘å¯ä»¥çœ‹æˆæ˜¯æŒ‰ç…§æƒå€¼ä»å°åˆ°å¤§é¡ºåºæ’å…¥ç»“ç‚¹æ‰€å¾—åˆ°çš„ã€æŒ‰ç…§æ•°æ®å€¼æ’åºçš„äºŒå‰æŸ¥æ‰¾æ ‘ã€‚

ä¸€ä¸ªç»“ç‚¹åœ¨æ ‘ä¸­çš„æ·±åº¦å®šä¹‰ä¸ºå®ƒåˆ°æ ‘æ ¹çš„è·ç¦»åŠ  $1$ã€‚å› æ­¤æ ‘çš„æ ¹ç»“ç‚¹çš„æ·±åº¦ä¸º $1$ã€‚

æ¯ä¸ªç»“ç‚¹é™¤äº†æ•°æ®å€¼å’Œæƒå€¼ä»¥å¤–ï¼Œè¿˜æœ‰ä¸€ä¸ªè®¿é—®é¢‘åº¦ã€‚æˆ‘ä»¬å®šä¹‰ä¸€ä¸ªç»“ç‚¹åœ¨æ ‘ä¸­çš„è®¿é—®ä»£ä»·ä¸ºå®ƒçš„è®¿é—®é¢‘åº¦ä¹˜ä»¥å®ƒåœ¨æ ‘ä¸­çš„æ·±åº¦ã€‚æ•´æ£µæ ‘çš„è®¿é—®ä»£ä»·å®šä¹‰ä¸ºæ‰€æœ‰ç»“ç‚¹åœ¨æ ‘ä¸­çš„è®¿é—®ä»£ä»·ä¹‹å’Œã€‚

ç°åœ¨ç»™å®šæ¯ä¸ªç»“ç‚¹çš„æ•°æ®å€¼ã€æƒå€¼å’Œè®¿é—®é¢‘åº¦ï¼Œä½ å¯ä»¥æ ¹æ®éœ€è¦ä¿®æ”¹æŸäº›ç»“ç‚¹çš„æƒå€¼ï¼Œä½†æ¯æ¬¡ä¿®æ”¹ä½ ä¼šä»˜å‡º $K$ çš„é¢å¤–ä¿®æ”¹ä»£ä»·ã€‚ä½ å¯ä»¥æŠŠç»“ç‚¹çš„æƒå€¼æ”¹ä¸ºä»»ä½•å®æ•°ï¼Œä½†æ˜¯ä¿®æ”¹åæ‰€æœ‰ç»“ç‚¹çš„æƒå€¼å¿…é¡»ä»ä¿æŒäº’ä¸ç›¸åŒã€‚ç°åœ¨ä½ è¦è§£å†³çš„é—®é¢˜æ˜¯ï¼Œæ•´æ£µæ ‘çš„è®¿é—®ä»£ä»·ä¸é¢å¤–ä¿®æ”¹ä»£ä»·çš„å’Œæœ€å°æ˜¯å¤šå°‘ï¼Ÿ

## è¯´æ˜/æç¤º

### æ ·ä¾‹è§£é‡Š

![](https://cdn.luogu.com.cn/upload/image_hosting/10bjubxe.png)

è¾“å…¥çš„åŸå›¾æ˜¯å·¦å›¾ï¼Œå®ƒçš„è®¿é—®ä»£ä»·æ˜¯ $1 \times 1+2 \times 2+3 \times 3+4 \times 4=30$ã€‚

æœ€ä½³çš„ä¿®æ”¹æ–¹æ¡ˆæ˜¯æŠŠè¾“å…¥ä¸­çš„ç¬¬ $3$ ä¸ªç»“ç‚¹çš„æƒå€¼æ”¹æˆ $0$ï¼Œå¾—åˆ°å³å›¾ï¼Œè®¿é—®ä»£ä»·æ˜¯ï¼š$1 \times 2+2 \times 3+3 \times 1+4 \times 2=19$ï¼ŒåŠ ä¸Šé¢å¤–ä¿®æ”¹ä»£ä»· $10$ï¼Œä¸€å…±æ˜¯ $29$ã€‚

### æ•°æ®èŒƒå›´

- å¯¹äº $40\%$ çš„æ•°æ®ï¼Œæ»¡è¶³ $N \leq 30$ï¼›
- å¯¹äº $70\%$ çš„æ•°æ®ï¼Œæ»¡è¶³ $N \leq 50$ï¼›
- å¯¹äº $100\%$ çš„æ•°æ®ï¼Œæ»¡è¶³ï¼š$1 \leq N \leq 70$ï¼Œ$1 \leq K \leq 3 \times 10^7$ã€‚


## æ ·ä¾‹ #1

### è¾“å…¥

```
4 10
1 2 3 4
1 2 3 4
1 2 3 4
```

### è¾“å‡º

```
29```

# AIåˆ†æç»“æœ


# ğŸ’¡ æ´›è¯­äº‘ç¬ºçš„C++ç®—æ³•è§£æï¼šNOI2009 äºŒå‰æŸ¥æ‰¾æ ‘ æ·±å…¥å­¦ä¹ æŒ‡å— ğŸ’¡

> "ç®—æ³•å¦‚æ£‹å±€ï¼Œä¸€æ­¥ä¸€æ€é‡ã€‚çœ‹æ¸…é—®é¢˜æœ¬è´¨ï¼Œæ‰èƒ½åœ¨ä¸‡å˜ä¸­æŒæ¡ä¸å˜ã€‚"

## 1. é¢˜ç›®è§£è¯»ä¸ç­–ç•¥åˆæ¢

âœ¨ **æœ¬é¢˜æ ¸å¿ƒæŒ‘æˆ˜**ï¼šåœ¨ä¿æŒäºŒå‰æŸ¥æ‰¾æ ‘ä¸­åºéå†ä¸å˜çš„å‰æä¸‹ï¼Œé€šè¿‡è°ƒæ•´èŠ‚ç‚¹æƒå€¼ï¼ˆå¼•å‘æ—‹è½¬æ“ä½œï¼‰æœ€å°åŒ–æ•´æ£µæ ‘çš„è®¿é—®ä»£ä»·ï¼ˆæ·±åº¦Ã—é¢‘åº¦ï¼‰ä¸æƒå€¼ä¿®æ”¹ä»£ä»·ä¹‹å’Œã€‚

âœ¨ **æ ¸å¿ƒç®—æ³•æ ‡ç­¾**ï¼š`åŒºé—´DP` `ç¦»æ•£åŒ–` `æ ‘å½¢ç»“æ„ä¼˜åŒ–`

ğŸ—£ï¸ **åˆæ­¥åˆ†æ**ï¼š
> äºŒå‰æŸ¥æ‰¾æ ‘çš„ä¸­åºéå†å›ºå®šä¸å˜ï¼ˆæŒ‰æ•°æ®å€¼æ’åºï¼‰ï¼Œè¿™æˆä¸ºæˆ‘ä»¬è§£é¢˜çš„"é”šç‚¹"ã€‚æƒå€¼ä¿®æ”¹ç›¸å½“äºè¿›è¡Œæ—‹è½¬æ“ä½œï¼Œæ”¹å˜èŠ‚ç‚¹æ·±åº¦åˆ†å¸ƒã€‚é—®é¢˜å¯æ‹†è§£ä¸ºï¼š
> 1. **æš´åŠ›æœç´¢**ï¼šæšä¸¾æ‰€æœ‰å¯èƒ½çš„æ—‹è½¬æ“ä½œç»„åˆï¼Œæ—¶é—´å¤æ‚åº¦æŒ‡æ•°çº§ï¼Œä¸å¯è¡Œ
> 2. **åŒºé—´DPè§£æ³•**ï¼šåˆ©ç”¨ä¸­åºéå†å›ºå®šç‰¹æ€§ï¼Œå¯¹å­æ ‘åŒºé—´è¿›è¡ŒåŠ¨æ€è§„åˆ’
> 3. **çŠ¶æ€è®¾è®¡ä¼˜åŒ–**ï¼šé€šè¿‡ç¦»æ•£åŒ–æƒå€¼ç»´åº¦ï¼Œå°†ä¸‰ç»´DPä¼˜åŒ–åˆ°å¯è¡ŒèŒƒå›´

### ğŸ” ç®—æ³•ä¾¦æ¢ï¼šå¦‚ä½•åœ¨é¢˜ç›®ä¸­å‘ç°çº¿ç´¢ï¼Ÿ
1.  **çº¿ç´¢1 (é—®é¢˜ç›®æ ‡)**ï¼š"æœ€å°åŒ–ä»£ä»·æ€»å’Œ"æ˜¯å…¸å‹çš„**æœ€ä¼˜åŒ–é—®é¢˜**ï¼Œä¸”å­˜åœ¨æ˜ç¡®çš„å­é—®é¢˜ç»“æ„ï¼ˆå­æ ‘ä¼˜åŒ–ï¼‰ï¼ŒæŒ‡å‘**åŠ¨æ€è§„åˆ’**è§£æ³•ã€‚
2.  **çº¿ç´¢2 (é—®é¢˜ç‰¹æ€§)**ï¼šä¸­åºéå†ä¸å˜çš„ç‰¹æ€§æš—ç¤ºäº†**åŒºé—´åˆ’åˆ†**çš„å¯èƒ½æ€§ï¼Œæ¯ä¸ªå­æ ‘å¯¹åº”ä¸€ä¸ªè¿ç»­åŒºé—´ï¼Œç¬¦åˆ**åŒºé—´DP**çš„æ¨¡å‹ç‰¹å¾ã€‚
3.  **çº¿ç´¢3 (æ•°æ®è§„æ¨¡)**ï¼šNâ‰¤70ï¼ŒO(nâ´)çš„DPï¼ˆçº¦2400ä¸‡æ¬¡è®¡ç®—ï¼‰åœ¨å¯æ¥å—èŒƒå›´ï¼Œæ’é™¤äº†æš´åŠ›è§£æ³•ã€‚

### ğŸ§  æ€ç»´é“¾æ„å»ºï¼šä»çº¿ç´¢åˆ°ç­–ç•¥
> ç»¼åˆçº¿ç´¢ï¼šç›®æ ‡æ˜¯æœ€ä¼˜åŒ–â†’ç‰¹å¾æœ‰åŒºé—´æ€§â†’æ•°æ®èŒƒå›´å…è®¸é«˜é˜¶DPã€‚  
> å…·ä½“æ¨ç†ï¼š
> 1. çº¿ç´¢1è¦æ±‚é«˜æ•ˆä¼˜åŒ–ç®—æ³•ï¼ŒDPæˆä¸ºé¦–é€‰
> 2. çº¿ç´¢2æŒ‡å‡ºåŒºé—´ç‰¹æ€§ï¼Œè‡ªç„¶å¯¼å‘åŒºé—´DPæ¡†æ¶
> 3. çº¿ç´¢3ç¡®è®¤nâ´å¤æ‚åº¦å¯è¡Œï¼Œç¡®å®šçŠ¶æ€è®¾è®¡ç»´åº¦
> 4. **ç»“è®º**ï¼šè®¾è®¡ä¸‰ç»´DPçŠ¶æ€`f[i][j][k]`è¡¨ç¤ºåŒºé—´[i,j]å†…æ‰€æœ‰æƒå€¼â‰¥kæ—¶çš„æœ€å°ä»£ä»·ï¼Œé€šè¿‡ç¦»æ•£åŒ–è§£å†³æƒå€¼èŒƒå›´é—®é¢˜

---

## 2. ç²¾é€‰ä¼˜è´¨é¢˜è§£å‚è€ƒ

**é¢˜è§£ä¸€ï¼šÏ‰Î±Î·gï¼ˆæ€è·¯æœ€æ¸…æ™°ï¼‰**
* **ç‚¹è¯„**ï¼šå®Œæ•´æ­ç¤ºé—®é¢˜æœ¬è´¨ï¼ˆTreapæ—‹è½¬â†’ä¸­åºéå†ä¸å˜ï¼‰ï¼Œä»¥ä¾¦æ¢å¼åˆ†æå¼•å¯¼æ€è€ƒã€‚ä»£ç é‡‡ç”¨ç¦»æ•£åŒ–+å‰ç¼€å’Œä¼˜åŒ–ï¼ŒçŠ¶æ€è½¬ç§»æ¨å¯¼ä¸¥è°¨ï¼Œå˜é‡å‘½åè§„èŒƒï¼ˆ`sum`/`f`ï¼‰ï¼Œæ³¨é‡Šè¯¦ç»†ï¼Œæ˜¯åˆå­¦è€…æœ€ä½³å­¦ä¹ èŒƒæœ¬ã€‚

**é¢˜è§£äºŒï¼šå´é€Šï¼ˆä»£ç æœ€è§„èŒƒï¼‰**
* **ç‚¹è¯„**ï¼šç²¾ç®€æ¨å¯¼ç›´å‡»æ ¸å¿ƒï¼Œä»£ç ç»“æ„ä¼˜ç¾ï¼šè¾“å…¥/ç¦»æ•£åŒ–/DPåˆå§‹åŒ–/å››é‡å¾ªç¯é€’æ¨å±‚æ¬¡åˆ†æ˜ã€‚å·§å¦™ä½¿ç”¨`make_pair`å’Œ`pair`æ’åºå®ç°ç¦»æ•£åŒ–ï¼Œç©ºé—´å¤„ç†ä¸¥è°¨ï¼ˆ`f[i][i-1][k]=0`ï¼‰ã€‚

**é¢˜è§£ä¸‰ï¼š18811162081lyhï¼ˆæ•™å­¦æ€§æœ€å¼ºï¼‰**
* **ç‚¹è¯„**ï¼šæ³¨é‡Šè¯¦å°½å¦‚æ•™å­¦ç¬”è®°ï¼Œå…³é”®æ­¥éª¤é€è¡Œè§£é‡Šï¼ˆå¦‚ç¦»æ•£åŒ–åŸç†ï¼‰ã€‚ç‹¬åˆ›"é—®é¢˜è½¬åŒ–ä¸‰éƒ¨æ›²"ï¼ˆTreapâ†’ä¸­åºâ†’DPï¼‰å¯å‘æ€è€ƒï¼Œè™½å˜é‡åè¾ƒé•¿ä½†æ˜“è¯»æ€§æä½³ã€‚

**é¢˜è§£å››ï¼šç¿¼å¾·å¤©å°Šï¼ˆç†è®ºæ·±åº¦æœ€ä½³ï¼‰**
* **ç‚¹è¯„**ï¼šä»ç¬›å¡å°”æ ‘è§’åº¦æ­ç¤ºé—®é¢˜æœ¬è´¨ï¼Œæå‡º"çŠ¶æ€æ³›åŒ–"è®¾è®¡ç†å¿µï¼ˆâ‰¥kä¼˜äº=kï¼‰ã€‚å¤æ‚åº¦åˆ†æé€å½»ï¼Œè¾¹ç•Œå¤„ç†å®Œæ•´ï¼ˆç©ºå­æ ‘åˆå§‹åŒ–ä¸º0ï¼‰ï¼Œä»£ç åŠ å…¥è¯»å…¥ä¼˜åŒ–æå‡æ•ˆç‡ã€‚

**é¢˜è§£äº”ï¼šç¨‹é—¨ç«‹é›ªï¼ˆç»“æ„æœ€å®Œæ•´ï¼‰**
* **ç‚¹è¯„**ï¼šä¸¥è°¨å®šä¹‰çŠ¶æ€è½¬ç§»æ–¹ç¨‹ï¼Œåˆ†ä¿®æ”¹/ä¸ä¿®æ”¹ä¸¤ç§æƒ…å†µè®¨è®ºã€‚ç‹¬åˆ›"è®¿é—®ä»£ä»·ç´¯åŠ åŸç†è§£é‡Š"ç”ŸåŠ¨å½¢è±¡ï¼ˆæ·±åº¦å¢åŠ =é¢‘åº¦ç´¯åŠ ï¼‰ï¼Œå‰ç¼€å’Œå®ç°ç®€æ´é«˜æ•ˆã€‚

---

## 3. è§£é¢˜ç­–ç•¥æ·±åº¦å‰–æ

### ğŸ¯ æ ¸å¿ƒéš¾ç‚¹ä¸å…³é”®æ­¥éª¤
1.  **ä¾èµ–å…³ç³»ä¸­åºéå†ä¸å˜æ€§**
    * **åˆ†æ**ï¼šå°†æ—‹è½¬æ“ä½œè½¬åŒ–ä¸ºä¸­åºåºåˆ—ä¸Šçš„åŒºé—´åˆ’åˆ†ï¼Œé€šè¿‡æ’åºé¢„å¤„ç†å¾—åˆ°ä¸­åºåºåˆ—
    * ğŸ’¡ **å­¦ä¹ ç¬”è®°**ï¼šæ ‘å½¢é—®é¢˜ä¸­ï¼Œå›ºå®šéå†é¡ºåºå¾€å¾€æ˜¯DPçªç ´å£

2.  **ä¸‰ç»´çŠ¶æ€è®¾è®¡ä¸ç¦»æ•£åŒ–**
    * **åˆ†æ**ï¼š`f[i][j][k]`ä¸­ï¼š
      - `i,j`ï¼šå­æ ‘åœ¨ä¸­åºåºåˆ—çš„åŒºé—´
      - `k`ï¼šç¦»æ•£åŒ–åçš„æƒå€¼ä¸‹ç•Œ
      - æƒå€¼ç¦»æ•£åŒ–å‹ç¼©ç©ºé—´è‡³O(nÂ³)
    * ğŸ’¡ **å­¦ä¹ ç¬”è®°**ï¼šå½“æ•°å€¼èŒƒå›´å¤§ä½†å®é™…æœ‰æ•ˆå€¼å°‘æ—¶ï¼Œç¦»æ•£åŒ–æ˜¯ç©ºé—´ä¼˜åŒ–çš„åˆ©å™¨

3.  **åŒè½¬ç§»æ–¹ç¨‹è®¾è®¡**
    * **åˆ†æ**ï¼š
      - ä¸ä¿®æ”¹ï¼š`f[i][j][k]=min(f[i][t-1][w_t]+f[t+1][j][w_t]+sum)`
      - ä¿®æ”¹ï¼š`f[i][j][k]=min(f[i][t-1][k]+f[t+1][j][k]+sum+K)`
    * ğŸ’¡ **å­¦ä¹ ç¬”è®°**ï¼šDPè½¬ç§»è€ƒè™‘"å†³ç­–åˆ†æ”¯"æ—¶ï¼Œç‹¬ç«‹åˆ†ææ¯ç§é€‰æ‹©

### âœ¨ è§£é¢˜æŠ€å·§æ€»ç»“
- **é—®é¢˜è½¬åŒ–**ï¼šå°†æ ‘æ—‹è½¬é—®é¢˜è½¬åŒ–ä¸ºåºåˆ—åŒºé—´åˆ’åˆ†é—®é¢˜
- **ç¦»æ•£åŒ–**ï¼šå¤§èŒƒå›´ç¨€ç–æ•°æ®å‹ç¼©ä¸ºç´§å‡‘ç´¢å¼•
- **å‰ç¼€å’Œä¼˜åŒ–**ï¼šO(1)è·å–åŒºé—´å’ŒåŠ é€Ÿä»£ä»·è®¡ç®—
- **æ³›åŒ–çŠ¶æ€è®¾è®¡**ï¼šç”¨â‰¥kä»£æ›¿=kï¼Œå‡å°‘çŠ¶æ€ç»´åº¦

### âš”ï¸ ç­–ç•¥ç«æŠ€åœºï¼šè§£æ³•å¯¹æ¯”

| ç­–ç•¥          | æ ¸å¿ƒæ€æƒ³                     | ä¼˜ç‚¹                     | ç¼ºç‚¹                         | å¾—åˆ†é¢„æœŸ |
|---------------|------------------------------|--------------------------|------------------------------|----------|
| **æš´åŠ›æœç´¢**  | æšä¸¾æ‰€æœ‰æ—‹è½¬ç»„åˆ             | æ€è·¯ç›´è§‚                 | O(2â¿)è¶…æ—¶                    | 0%       |
| **é“¾å¼DP**    | æŒ‰ä¸­åºé€èŠ‚ç‚¹æ·»åŠ              | çŠ¶æ€ç®€å•O(nÂ²)            | æ— æ³•å¤„ç†æƒå€¼ä¾èµ–             | 40%      |
| **ä¸‰ç»´DP**    | åŒºé—´+æƒå€¼åŒç»´åº¦              | ç²¾å‡†å¤„ç†ä¾èµ–ï¼ŒO(nâ´)      | çŠ¶æ€è®¾è®¡æŠ½è±¡                 | 100%     |

### âœ¨ ä¼˜åŒ–ä¹‹æ—…ï¼šä»"èƒ½åš"åˆ°"åšå¥½"
> 1. **èµ·ç‚¹ï¼šæš´åŠ›å›°å¢ƒ**  
>    æšä¸¾æ‰€æœ‰æ—‹è½¬ç»„åˆå°±åƒåœ¨è¿·å®«ä¸­ç›²ç›®è¯•æ¢ï¼Œ70èŠ‚ç‚¹æ—¶2â·â°â‰ˆ10Â²Â¹æ¬¡è®¡ç®—ï¼Œå®‡å®™æ¯ç­ä¹Ÿç®—ä¸å®Œ
> 
> 2. **å…³é”®æ´å¯Ÿï¼šä¸å˜ä¸­åº**  
>    å‘ç°æ—‹è½¬ä¸æ”¹å˜ä¸­åºéå†åºåˆ—ï¼Œå¦‚åŒåœ¨è¿·å®«ä¸­æ‰¾åˆ°æŒ‡å—é’ˆ
> 
> 3. **DPçŠ¶æ€è®¾è®¡**  
>    å°†æ ‘åˆ’åˆ†ä¸º`[i,j]`åŒºé—´å­æ ‘ï¼Œ`f[i][j][k]`è®°å½•å±€éƒ¨æœ€ä¼˜è§£
> 
> 4. **ç¦»æ•£åŒ–çªç ´**  
>    æƒå€¼ç»´åº¦ä»40ä¸‡å‹ç¼©åˆ°70ï¼Œç©ºé—´ä»GBâ†’MBçº§
> 
> ğŸ’¡ **ç­–ç•¥æ€»ç»“**ï¼š"ä»æš´åŠ›åˆ°æœ€ä¼˜è§£ï¼Œæ˜¯é—®é¢˜è®¤çŸ¥çš„æ·±åŒ–è¿‡ç¨‹â€”â€”å‘ç°ä¸å˜æ€§ï¼Œè®¾è®¡é«˜æ•ˆçŠ¶æ€ï¼Œåˆç†å‹ç¼©ç»´åº¦"

---

## 4. C++æ ¸å¿ƒä»£ç å®ç°èµæ

**é€šç”¨æ ¸å¿ƒå®ç°**
```cpp
#include <bits/stdc++.h>
using namespace std;
const int N = 75;
struct Node { int data, weight, freq; } a[N];
int n, K, sum[N], f[N][N][N];

int main() {
    // è¾“å…¥ä¸ç¦»æ•£åŒ–
    cin >> n >> K;
    for (int i = 1; i <= n; i++) cin >> a[i].data;
    for (int i = 1; i <= n; i++) cin >> a[i].weight;
    for (int i = 1; i <= n; i++) cin >> a[i].freq;
    
    // æŒ‰æ•°æ®å€¼æ’åºå¾—ä¸­åºåºåˆ—
    sort(a + 1, a + n + 1, [](auto &x, auto &y) {
        return x.data < y.data; 
    });
    
    // æƒå€¼ç¦»æ•£åŒ–
    vector<int> disc;
    for (int i = 1; i <= n; i++) disc.push_back(a[i].weight);
    sort(disc.begin(), disc.end());
    for (int i = 1; i <= n; i++) {
        a[i].weight = lower_bound(disc.begin(), disc.end(), a[i].weight) - disc.begin() + 1;
        sum[i] = sum[i - 1] + a[i].freq; // å‰ç¼€å’Œ
    }
    
    // DPåˆå§‹åŒ–
    memset(f, 0x3f, sizeof f);
    for (int i = 1; i <= n + 1; i++)
        for (int k = 1; k <= n; k++)
            f[i][i - 1][k] = 0;
    
    // åŒºé—´DPé€’æ¨
    for (int len = 1; len <= n; len++) {
        for (int i = 1, j = i + len - 1; j <= n; i++, j++) {
            int freq_sum = sum[j] - sum[i - 1];
            for (int k = 1; k <= n; k++) {
                for (int t = i; t <= j; t++) { // æšä¸¾æ ¹èŠ‚ç‚¹
                    // æƒ…å†µ1ï¼šä¸ä¿®æ”¹æƒå€¼
                    if (a[t].weight >= k) {
                        int cost = f[i][t - 1][a[t].weight] + f[t + 1][j][a[t].weight];
                        f[i][j][k] = min(f[i][j][k], cost + freq_sum);
                    }
                    // æƒ…å†µ2ï¼šä¿®æ”¹æƒå€¼ä¸ºk
                    int cost = f[i][t - 1][k] + f[t + 1][j][k];
                    f[i][j][k] = min(f[i][j][k], cost + freq_sum + K);
                }
            }
        }
    }
    cout << f[1][n][1] << endl;
}
```

**ä»£ç è§£è¯»æ¦‚è¦**ï¼š
1. **ç¦»æ•£åŒ–é¢„å¤„ç†**ï¼šå°†å¤§èŒƒå›´æƒå€¼æ˜ å°„åˆ°[1,n]åŒºé—´
2. **å‰ç¼€å’ŒåŠ é€Ÿ**ï¼šO(1)è·å–ä»»æ„åŒºé—´é¢‘åº¦å’Œ
3. **å››å±‚å¾ªç¯ç»“æ„**ï¼š
   - å¤–å±‚ï¼šåŒºé—´é•¿åº¦
   - ä¸­å±‚ï¼šåŒºé—´èµ·æ­¢ç‚¹
   - ç¬¬ä¸‰å±‚ï¼šæƒå€¼ä¸‹ç•Œ
   - å†…å±‚ï¼šæšä¸¾æ ¹èŠ‚ç‚¹
4. **åŒå†³ç­–è½¬ç§»**ï¼šåˆ†ä¿®æ”¹/ä¸ä¿®æ”¹æƒå€¼ä¸¤ç§æƒ…å†µ

---

## 5. ç®—æ³•å¯è§†åŒ–ï¼šåƒç´ åŠ¨ç”»æ¼”ç¤º

### è®¾è®¡æ¦‚å¿µ
**"Treapæ—‹è½¬è§£å¯†è€…"** - é€šè¿‡8-bitåƒç´ é£æ ¼æ¼”ç¤ºä¸­åºåºåˆ—å¦‚ä½•é€šè¿‡æƒå€¼è°ƒæ•´ä¼˜åŒ–æ·±åº¦åˆ†å¸ƒã€‚é‡‡ç”¨FCçº¢ç™½æœºå¤å¤UIï¼Œé…ä»¥ç”µå­éŸ³æ•ˆå¢å¼ºè®°å¿†ç‚¹ã€‚

### åŠ¨ç”»è„šæœ¬
```mermaid
graph TD
    A[å¯åŠ¨ç•Œé¢] --> B[è¾“å…¥æ ‘å±•ç¤º]
    B --> C[æƒå€¼ç¦»æ•£åŒ–è¿‡ç¨‹]
    C --> D[DPçŠ¶æ€çŸ©é˜µåˆå§‹åŒ–]
    D --> E[åŒºé—´æ»‘åŠ¨æ¼”ç¤º]
    E --> F[æ ¹èŠ‚ç‚¹é€‰æ‹©å†³ç­–]
    F --> G[ä¿®æ”¹/ä¸ä¿®æ”¹æƒå€¼å¯¹æ¯”]
    G --> H[ä»£ä»·è®¡ç®—ç²’å­æ•ˆæœ]
```

### å…³é”®å¸§è®¾è®¡
1. **åƒç´ ç½‘æ ¼åŒº**ï¼ˆ80Ã—60ç½‘æ ¼ï¼‰
   - ç»¿è‰²åƒç´ å—ï¼šå½“å‰DPåŒºé—´[i,j]
   - é»„è‰²é—ªçƒå—ï¼šå€™é€‰æ ¹èŠ‚ç‚¹t
   - çº¢è‰²ç²’å­æµï¼šé¢‘åº¦å’Œç´¯åŠ è¿‡ç¨‹

2. **æ§åˆ¶é¢æ¿**ï¼ˆå³ä¾§ï¼‰
   - æ­¥è¿›æŒ‰é’®ï¼šå•æ­¥å‰è¿›/åé€€
   - é€Ÿåº¦æ»‘å—ï¼š0.5x~5xé€Ÿåº¦è°ƒèŠ‚
   - æƒå€¼æ˜ å°„è¡¨ï¼šå®æ—¶æ˜¾ç¤ºç¦»æ•£åŒ–å¯¹åº”

3. **éŸ³æ•ˆè®¾è®¡**
   - é€‰æ‹©èŠ‚ç‚¹ï¼š8-bit "æ»´"å£°
   - æƒå€¼ä¿®æ”¹ï¼šé‡‘å±æ‘©æ“¦å£°
   - çŠ¶æ€æ›´æ–°ï¼šç”µå­åˆæˆéŸ³

### æ•™å­¦ä»·å€¼
é€šè¿‡å¯è§†åŒ–ç†è§£ï¼š
- åŒºé—´DPçš„æ»‘åŠ¨çª—å£ç‰¹æ€§
- æƒå€¼ç¦»æ•£åŒ–çš„å‹ç¼©æ•ˆæœ
- é¢‘åº¦ç´¯åŠ ä¸æ·±åº¦å…³ç³»

---

## 6. æ‹“å±•ç»ƒä¹ ä¸ç›¸ä¼¼é—®é¢˜

### é€šç”¨æŠ€å·§è¿ç§»
1. **åŒºé—´åˆ’åˆ†+ä»£ä»·ä¼˜åŒ–**ï¼šä»»åŠ¡è°ƒåº¦é—®é¢˜
2. **ç¦»æ•£åŒ–+ç»´åº¦å‹ç¼©**ï¼šå¸¦æƒå€¼çº¦æŸçš„è®¡æ•°é—®é¢˜
3. **æ ‘å½¢ç»“æ„åºåˆ—åŒ–**ï¼šæ ‘å½¢DPè½¬çº¿æ€§å¤„ç†

### æ´›è°·æ¨è
1. **P1040 åŠ åˆ†äºŒå‰æ ‘**  
   ğŸ—£ï¸ åŒå±ä¸­åºåºåˆ—åŒºé—´DPï¼Œå¼ºåŒ–æ ‘å½¢ç»“æ„è½¬åŒ–æ€æƒ³

2. **P1273 æœ‰çº¿ç”µè§†ç½‘**  
   ğŸ—£ï¸ æ ‘å½¢DP+è´¹ç”¨è®¡ç®—ï¼Œè®­ç»ƒçŠ¶æ€è®¾è®¡èƒ½åŠ›

3. **P1854 èŠ±åº—æ©±çª—**  
   ğŸ—£ï¸ äºŒç»´åŒºé—´åˆ’åˆ†+ä»£ä»·ä¼˜åŒ–ï¼Œæ‹“å±•DPæ€ç»´

---

## 7. å­¦ä¹ å¿ƒå¾—ä¸ç»éªŒåˆ†äº«

> **æ¥è‡ªÏ‰Î±Î·gçš„è°ƒè¯•ç»éªŒ**ï¼š  
> "åˆå§‹æ€»å¿½ç•¥ç©ºå­æ ‘åˆå§‹åŒ–ï¼Œå¯¼è‡´DPå€¼å¼‚å¸¸ã€‚ç‰¢è®°`f[i][i-1][k]=0`è¿™ä¸ªçœ‹ä¼¼ç®€å•å´å…³é”®çš„è¾¹ç•Œæ¡ä»¶ï¼"

> **æ´›è¯­äº‘ç¬ºç‚¹è¯„**ï¼š  
> è°ƒè¯•DPé—®é¢˜æ—¶ï¼Œè¾¹ç•Œæ¡ä»¶å¸¸æ˜¯è‡´å‘½æ¼æ´ã€‚å»ºè®®ï¼š
> 1. æ˜¾å¼åˆå§‹åŒ–è¾¹ç•ŒçŠ¶æ€
> 2. å°æ•°æ®æ‰‹å·¥æ¨¡æ‹ŸéªŒè¯
> 3. æ‰“å°ä¸­é—´DPçŸ©é˜µæ’æŸ¥

---

> "ç®—æ³•å­¦ä¹ å¦‚åŒæ ‘æœ¨ç”Ÿé•¿â€”â€”æ ¹æ·±ï¼ˆåŸºç¡€ï¼‰æ‰èƒ½å¶èŒ‚ï¼ˆåˆ›æ–°ï¼‰ï¼Œæå¹²ï¼ˆæ€ç»´ï¼‰å†³å®šå½¢æ€ï¼ˆæ•ˆç‡ï¼‰ã€‚æŒæ¡æœ¬é¢˜çš„åŒºé—´DPæ€æƒ³ï¼Œä½ å·²è·å¾—è§£å†³å¤æ‚æ ‘å½¢é—®é¢˜çš„å¯†é’¥ã€‚ä¸‹æ¬¡æŒ‘æˆ˜è§ï¼ğŸŒ³"

---
å¤„ç†ç”¨æ—¶ï¼š218.52ç§’
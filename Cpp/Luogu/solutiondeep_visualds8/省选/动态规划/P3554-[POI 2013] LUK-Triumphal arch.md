# é¢˜ç›®ä¿¡æ¯

# [POI 2013] LUK-Triumphal arch

## é¢˜ç›®æè¿°

The king of Byteotia, Byteasar, is returning to his country after a victorious battle.

In Byteotia, there are ![](http://main.edu.pl/images/OI20/luk-en-tex.1.png) towns connected with only ![](http://main.edu.pl/images/OI20/luk-en-tex.2.png) roads.

It is known that every town can be reached from every other town by a unique route,    consisting of one or more (direct) roads.

    (In other words, the road network forms a tree).

The king has just entered the capital.

Therein a triumphal arch, i.e., a gate a victorious king rides through, has been erected.

Byteasar, delighted by a warm welcome by his subjects, has planned a    triumphal procession to visit all the towns of Byteotia, starting with the capital he is currently in.

The other towns are not ready to greet their king just yet -    the constructions of the triumphal arches in those towns did not even begin!

But Byteasar's trusted advisor is seeing to the issue.

    He desires to hire a number of construction crews.

    Every crew can construct a single arch each day, in any town.

    Unfortunately, no one knows the order in which the king will visit the towns.

The only thing that is clear is that every day the king will travel from the city he is currently in to a neighboring one.

The king may visit any town an arbitrary number of times    (but as he is not vain, one arch in each town will suffice).

Byteasar's advisor has to pay each crew the same flat fee, regardless of how many arches this crew builds.

Thus, while he needs to ensure that every town has an arch when it is visited by the king, he wants to hire as few crews as possible.

Help him out by writing a program that will determine the minimum number    of crews that allow a timely delivery of the arches.


ç»™ä¸€é¢— $n$ ä¸ªèŠ‚ç‚¹çš„æ ‘ï¼ˆ$n \le 3 \times 10^5$ï¼‰ï¼Œåˆå§‹æ—¶ $1$ å·èŠ‚ç‚¹è¢«æŸ“é»‘ï¼Œå…¶ä½™æ˜¯ç™½çš„ã€‚ä¸¤ä¸ªäººè½®æµæ“ä½œï¼Œä¸€å¼€å§‹ B åœ¨ $1$ å·èŠ‚ç‚¹ã€‚æ¯ä¸€è½®ï¼ŒA é€‰æ‹© $k$ ä¸ªç‚¹æŸ“é»‘ï¼Œç„¶å B èµ°åˆ°ä¸€ä¸ªç›¸é‚»èŠ‚ç‚¹ï¼Œå¦‚æœ B å½“å‰å¤„äºç™½ç‚¹åˆ™ B èƒœï¼Œå¦åˆ™å½“ A å°†æ‰€æœ‰ç‚¹æŸ“ä¸ºé»‘ç‚¹æ—¶ A èƒœã€‚æ±‚èƒ½è®© A è·èƒœçš„æœ€å°çš„ $k$ ã€‚


## è¯´æ˜/æç¤º

ç»™ä¸€é¢—æ ‘ï¼Œ1å·èŠ‚ç‚¹å·²ç»è¢«æŸ“é»‘ï¼Œå…¶ä½™æ˜¯ç™½çš„ï¼Œä¸¤ä¸ªäººè½®æµæ“ä½œï¼Œä¸€å¼€å§‹Båœ¨1å·èŠ‚ç‚¹ï¼ŒAé€‰æ‹©kä¸ªç‚¹æŸ“é»‘ï¼Œç„¶åBèµ°ä¸€æ­¥ï¼Œå¦‚æœBèƒ½èµ°åˆ°Aæ²¡æŸ“çš„èŠ‚ç‚¹åˆ™Bèƒœï¼Œå¦åˆ™å½“AæŸ“å®Œå…¨éƒ¨çš„ç‚¹æ—¶ï¼ŒAèƒœã€‚æ±‚èƒ½è®©Aè·èƒœçš„æœ€å°çš„k

## æ ·ä¾‹ #1

### è¾“å…¥

```
7
1 2
1 3
2 5
2 6
7 2
4 1
```

### è¾“å‡º

```
3
```

# AIåˆ†æç»“æœ


# ğŸ’¡ æ´›è¯­äº‘ç¬ºçš„C++ç®—æ³•è§£æï¼šLUK-Triumphal arch æ·±å…¥å­¦ä¹ æŒ‡å— ğŸ’¡

> "ç®—æ³•ä¸ä»…æ˜¯ä»£ç çš„éª¨æ¶ï¼Œæ›´æ˜¯æ€ç»´çš„èˆè¹ˆã€‚ä»Šå¤©ï¼Œæˆ‘ä»¬å°†è¸ä¸Šä¸€åœºæ ‘å½¢ç‹å›½ä¸­çš„ç­–ç•¥åšå¼ˆä¹‹æ—…ã€‚"

## 1. é¢˜ç›®è§£è¯»ä¸ç­–ç•¥åˆæ¢

âœ¨ **æœ¬é¢˜æ ¸å¿ƒæŒ‘æˆ˜**ï¼šåœ¨Bçš„ç§»åŠ¨è·¯å¾„æœªçŸ¥çš„æƒ…å†µä¸‹ï¼ŒAéœ€è¦ä»¥æœ€å°‘çš„æŸ“è‰²æ¬¡æ•°ï¼ˆæ¯æ¬¡æŸ“kä¸ªç‚¹ï¼‰å°é”Bæ‰€æœ‰å¯èƒ½çš„ç§»åŠ¨è·¯å¾„ï¼Œç¡®ä¿Bæ°¸è¿œä¸ä¼šè¸å…¥ç™½è‰²èŠ‚ç‚¹ã€‚

âœ¨ **æ ¸å¿ƒç®—æ³•æ ‡ç­¾**ï¼šäºŒåˆ†ç­”æ¡ˆã€æ ‘å½¢åŠ¨æ€è§„åˆ’

ğŸ—£ï¸ **åˆæ­¥åˆ†æ**ï¼š
> è¿™é“é¢˜çš„æ ¸å¿ƒåœ¨äº**åŠ¨æ€æŸ“è‰²ç­–ç•¥**ä¸**è·¯å¾„å°é”**çš„åšå¼ˆã€‚Bä¼šæ²¿ç€æ ‘è¾¹å‘å¶å­èŠ‚ç‚¹ç§»åŠ¨ï¼ˆä¸èµ°å›å¤´è·¯ï¼‰ï¼Œè€ŒAå¿…é¡»åœ¨Båˆ°è¾¾æ¯ä¸ªèŠ‚ç‚¹å‰ï¼Œå°†å…¶æ‰€æœ‰"é€ƒç”Ÿå‡ºå£"ï¼ˆå­èŠ‚ç‚¹ï¼‰æŸ“é»‘ã€‚æˆ‘ä»¬é€šè¿‡ä»¥ä¸‹æ­¥éª¤ç ´è§£ï¼š
> 1. **äºŒåˆ†ç­”æ¡ˆæ¡†æ¶**ï¼šç­”æ¡ˆkå…·æœ‰å•è°ƒæ€§â€”â€”kè¶Šå¤§Aè¶Šå®¹æ˜“è·èƒœã€‚æˆ‘ä»¬äºŒåˆ†å¯»æ‰¾æœ€å°å¯è¡Œkã€‚
> 2. **æ ‘å½¢DPæ£€éªŒ**ï¼šå¯¹æ¯ä¸ªå€™é€‰kï¼Œé€šè¿‡è‡ªåº•å‘ä¸Šçš„DFSè®¡ç®—æ¯ä¸ªèŠ‚ç‚¹çš„"æŸ“è‰²éœ€æ±‚"ã€‚
> 3. **çŠ¶æ€è½¬ç§»è®¾è®¡**ï¼šå®šä¹‰`f[u]`è¡¨ç¤ºä»¥uä¸ºæ ¹çš„å­æ ‘ï¼ˆä¸åŒ…æ‹¬uï¼‰è¿˜éœ€è¦é¢å¤–æŸ“è‰²çš„èŠ‚ç‚¹æ•°ï¼Œé€šè¿‡`f[u] = max(0, Î£(f[v]+1) - k)`è¿›è¡ŒçŠ¶æ€è½¬ç§»ã€‚
> 
> **å¯è§†åŒ–è®¾è®¡**ï¼šæˆ‘ä»¬å°†ä»¥åƒç´ é£æ ¼åŠ¨ç”»å±•ç¤ºæ ‘å½¢DPè¿‡ç¨‹â€”â€”èŠ‚ç‚¹æŒ‰DFSåºç‚¹äº®ï¼Œå›æº¯æ—¶æ˜¾ç¤ºçŠ¶æ€å€¼æ›´æ–°ï¼Œç”¨é¢œè‰²æ·±æµ…è¡¨ç¤ºéœ€æ±‚å¼ºåº¦ï¼Œå¹¶é…ä»¥8-bitéŸ³æ•ˆå¢å¼ºç†è§£ã€‚

### ğŸ” ç®—æ³•ä¾¦æ¢ï¼šå¦‚ä½•åœ¨é¢˜ç›®ä¸­å‘ç°çº¿ç´¢ï¼Ÿ
1.  **çº¿ç´¢1 (é—®é¢˜ç›®æ ‡)**: "æ±‚æœ€å°kä½¿Aå¿…èƒœ"â€”â€”è¿™ç§**æœ€ä¼˜åŒ–é—®é¢˜+å•è°ƒæ€§**æš—ç¤ºäºŒåˆ†ç­”æ¡ˆã€‚
2.  **çº¿ç´¢2 (é—®é¢˜çº¦æŸ/ç‰¹æ€§)**: "Bæ²¿æ ‘è¾¹ç§»åŠ¨ä¸”ä¸èµ°å›å¤´è·¯"â€”â€”**æ ‘å½¢ç»“æ„+å•å‘ç§»åŠ¨**æŒ‡å‘æ ‘å½¢DPè‡ªåº•å‘ä¸Šæ±‚è§£ã€‚
3.  **çº¿ç´¢3 (æ•°æ®è§„æ¨¡)**: nâ‰¤3Ã—10âµâ€”â€”è¦æ±‚O(n log n)ç®—æ³•ï¼Œ**äºŒåˆ†ç­”æ¡ˆ+O(n)æ£€æŸ¥**å®Œç¾åŒ¹é…ã€‚

### ğŸ§  æ€ç»´é“¾æ„å»ºï¼šä»çº¿ç´¢åˆ°ç­–ç•¥
> è®©æˆ‘ä»¬ä¸²è”çº¿ç´¢ï¼š
> 1. **çº¿ç´¢1**å¼•å¯¼æˆ‘ä»¬æ€è€ƒäºŒåˆ†ç­”æ¡ˆâ€”â€”kçš„å•è°ƒæ€§æ˜¯è§£é¢˜çªç ´å£ã€‚
> 2. **çº¿ç´¢2**æ­ç¤ºå…³é”®çº¦æŸï¼šBçš„ç§»åŠ¨è·¯å¾„æœ¬è´¨æ˜¯**æ ¹åˆ°å¶å­çš„æ ‘é“¾**ï¼Œè¿™è®©æˆ‘ä»¬å°†é—®é¢˜åˆ†è§£ä¸ºå­æ ‘é—®é¢˜å¤„ç†ã€‚
> 3. **çº¿ç´¢3**çš„æ•°æ®èŒƒå›´å¦å†³äº†O(nÂ²)æš´åŠ›ï¼Œè€Œ**O(n)æ ‘å½¢DP**æ°èƒ½åœ¨äºŒåˆ†æ¡†æ¶å†…é«˜æ•ˆå·¥ä½œã€‚
> 
> **ç»“è®º**ï¼šäºŒåˆ†ç­”æ¡ˆkåï¼Œç”¨æ ‘å½¢DPè®¡ç®—æ¯ä¸ªå­æ ‘è¿˜éœ€å¤šå°‘é¢å¤–æŸ“è‰²ã€‚è‹¥æ ¹èŠ‚ç‚¹éœ€æ±‚`f[1]=0`ï¼Œåˆ™kå¯è¡Œã€‚è¿™ç§"äºŒåˆ†æ¡†æ¶+æ ‘å½¢DPéªŒè¯"çš„ç»„åˆç­–ç•¥ï¼Œæ­£æ˜¯ç ´è§£æœ¬é¢˜çš„é‡‘é’¥åŒ™ï¼

---

## 2. ç²¾é€‰ä¼˜è´¨é¢˜è§£å‚è€ƒ

**é¢˜è§£ä¸€ï¼ˆvectorwyxï¼‰**
* **ç‚¹è¯„**ï¼šæ­¤è§£äº®ç‚¹åœ¨äº**äºŒåˆ†ä¸‹ç•Œä¼˜åŒ–**â€”â€”ä»æ ¹èŠ‚ç‚¹çš„å„¿å­æ•°å¼€å§‹äºŒåˆ†ï¼Œæ˜¾è‘—æå‡æ•ˆç‡ã€‚ä½œè€…é€šè¿‡`f[u] = son[u] - k + Î£ max(f[v],0)`çš„é€’æ¨å¼ï¼Œå·§å¦™å¤„ç†äº†å­æ ‘é—´çš„éœ€æ±‚ä¼ é€’ã€‚ä»£ç ä¸­`lambda`è™½æœªä½¿ç”¨ï¼Œä½†æ¸…æ™°çš„å˜é‡å‘½å(`son[]`)å’Œè¾¹ç•Œå¤„ç†å±•ç°äº†ä¸“ä¸šç´ å…»ï¼Œå°¤å…¶æ˜¯å¯¹"Bä¸èµ°å›å¤´è·¯"çš„è®ºè¯æå…·å¯å‘æ€§ã€‚

**é¢˜è§£äºŒï¼ˆS_S_Hï¼‰**
* **ç‚¹è¯„**ï¼šä½œè€…ç”¨**æœ¨æ¡¶åŸç†**å½¢è±¡è§£é‡Šä¸ºä»€ä¹ˆéœ€è¦è¦†ç›–æ‰€æœ‰å­èŠ‚ç‚¹ï¼Œå¹¶ç»™å‡ºè´ªå¿ƒç®—æ³•çš„åä¾‹ï¼Œå¼ºåŒ–äº†æ ‘å½¢DPçš„å¿…è¦æ€§ã€‚ä»£ç ä¸­`f[u]=max(sum-k,0)`çš„è½¬ç§»ç®€æ´æœ‰åŠ›ï¼Œæ³¨é‡Šè¯¦ç»†è§£é‡Šæ¯ä¸ªæ­¥éª¤çš„æ„å›¾ï¼Œç‰¹åˆ«é€‚åˆåˆå­¦è€…ç†è§£æ ‘å½¢DPçš„æ€ç»´è¿‡ç¨‹ã€‚

**é¢˜è§£ä¸‰ï¼ˆCaptain_Paulï¼‰**
* **ç‚¹è¯„**ï¼šé¢˜è§£çªå‡º**çŠ¶æ€å®šä¹‰çš„ç‰©ç†æ„ä¹‰**â€”â€”`f[i]`è¡¨ç¤ºiå­æ ‘è¿˜éœ€æŸ“è‰²çš„èŠ‚ç‚¹æ•°ã€‚ä»£ç ç”¨æ ‡å‡†é‚»æ¥è¡¨å­˜å›¾ï¼Œå¹¶ç‰¹åˆ¤`n=1`çš„è¾¹ç•Œæƒ…å†µï¼Œä½“ç°äº†ä¸¥è°¨æ€§ã€‚è™½ç„¶æœªåšäºŒåˆ†ä¼˜åŒ–ï¼Œä½†åŸºç¡€å®ç°å®Œæ•´è§„èŒƒï¼Œæ˜¯å­¦ä¹ æ ‘å½¢DPçš„ä¼˜è´¨èŒƒæœ¬ã€‚

---

## 3. è§£é¢˜ç­–ç•¥æ·±åº¦å‰–æ

### ğŸ¯ æ ¸å¿ƒéš¾ç‚¹ä¸å…³é”®æ­¥éª¤
1.  **å…³é”®ç‚¹1ï¼šçŠ¶æ€å®šä¹‰çš„è‰ºæœ¯**
    * **åˆ†æ**ï¼šå®šä¹‰`f[u]`ä¸º"uçš„å­æ ‘ï¼ˆä¸å«uï¼‰è¿˜éœ€é¢å¤–æŸ“è‰²çš„èŠ‚ç‚¹æ•°"ã€‚è¿™é‡Œéšå«ä¸¤ä¸ªé‡è¦è®¾è®¡ï¼šâ‘  æ’é™¤uæœ¬èº«ï¼ˆå› Båˆ°è¾¾uæ—¶uå·²æŸ“è‰²ï¼‰â‘¡ "é¢å¤–"æŒ‡è¶…å‡ºå½“å‰è½®æ¬¡kçš„æŸ“è‰²éœ€æ±‚ã€‚
    * ğŸ’¡ **å­¦ä¹ ç¬”è®°**ï¼šå¥½çš„çŠ¶æ€å®šä¹‰åº”æ»¡è¶³ï¼šè¦†ç›–å­é—®é¢˜ã€æ’é™¤å†—ä½™ä¿¡æ¯ã€ä¾¿äºçŠ¶æ€è½¬ç§»ã€‚
   
2.  **å…³é”®ç‚¹2ï¼šçŠ¶æ€è½¬ç§»çš„æ•°å­¦æŠ½è±¡**
    * **åˆ†æ**ï¼šè½¬ç§»æ–¹ç¨‹`f[u] = max(0, Î£(f[v] + 1) - k)`çš„æ¨å¯¼ï¼š
      - `Î£(f[v] + 1)`ï¼šæ¯ä¸ªå­èŠ‚ç‚¹vçš„éœ€æ±‚`f[v]`+væœ¬èº«éœ€è¦æŸ“è‰²ï¼ˆ+1ï¼‰
      - `- k`ï¼šå½“å‰è½®æ¬¡å¯æŸ“kä¸ªèŠ‚ç‚¹
      - `max(0, ...)`ï¼šè´Ÿéœ€æ±‚è§†ä¸ºé›¶ï¼ˆä¸èƒ½"å‚¨å­˜"æŸ“è‰²èƒ½åŠ›ï¼‰
    * ğŸ’¡ **å­¦ä¹ ç¬”è®°**ï¼šæ ‘å½¢DPè½¬ç§»å¸¸è¡¨ç°ä¸º"å­èŠ‚ç‚¹éœ€æ±‚å’ŒÂ±å½“å‰å¤„ç†èƒ½åŠ›"ã€‚

3.  **å…³é”®ç‚¹3ï¼šäºŒåˆ†è¾¹ç•Œçš„ä¼˜åŒ–**
    * **åˆ†æ**ï¼šä¸‹ç•Œå–æ ¹èŠ‚ç‚¹çš„å„¿å­æ•°ï¼ˆå› ç¬¬ä¸€è½®å¿…é¡»æŸ“é»‘æ‰€æœ‰æ ¹çš„å­èŠ‚ç‚¹ï¼‰ï¼Œä¸Šç•Œå–æ•´æ£µæ ‘çš„æœ€å¤§åº¦ã€‚ä¼˜åŒ–åäºŒåˆ†èŒƒå›´ä»`[0,n]`ç¼©è‡³`[deg(1), max_deg]`ã€‚
    * ğŸ’¡ **å­¦ä¹ ç¬”è®°**ï¼šåˆ©ç”¨é—®é¢˜ç‰¹æ€§ç¼©å°äºŒåˆ†èŒƒå›´æ˜¯æé«˜æ•ˆç‡çš„å¸¸ç”¨æŠ€å·§ã€‚

### âœ¨ è§£é¢˜æŠ€å·§æ€»ç»“
- **æŠ€å·§1ï¼šé—®é¢˜è½¬åŒ–**  
  å°†æœ€å°åŒ–kè½¬åŒ–ä¸ºåˆ¤å®šæ€§é—®é¢˜ï¼ˆæ˜¯å¦å­˜åœ¨kä½¿Aèƒœï¼‰ï¼Œç”¨äºŒåˆ†æ¡†æ¶å¤„ç†
- **æŠ€å·§2ï¼šæ ‘å½¢DPçš„ä¾èµ–åˆ†è§£**  
  å°†æ ‘åˆ†è§£ä¸ºå­æ ‘ï¼Œè‡ªåº•å‘ä¸Šè®¡ç®—éœ€æ±‚ï¼Œé¿å…é‡å¤è®¡ç®—
- **æŠ€å·§3ï¼šè¾¹ç•Œå‹ç¼©**  
  åˆ©ç”¨æ ¹èŠ‚ç‚¹çš„ç‰¹æ®Šåœ°ä½ï¼ˆç¬¬ä¸€è½®å¿…é¡»æŸ“å…¶å­èŠ‚ç‚¹ï¼‰ä¼˜åŒ–äºŒåˆ†ä¸‹ç•Œ

### âš”ï¸ ç­–ç•¥ç«æŠ€åœºï¼šä¸åŒè§£æ³•çš„å¯¹æ¯”åˆ†æ
| ç­–ç•¥          | æ ¸å¿ƒæ€æƒ³                 | ä¼˜ç‚¹                     | ç¼ºç‚¹                     | å¾—åˆ†é¢„æœŸ       |
| ------------- | ------------------------ | ------------------------ | ------------------------ | -------------- |
| **æš´åŠ›æšä¸¾**  | æšä¸¾k+æ¨¡æ‹ŸBæ‰€æœ‰ç§»åŠ¨è·¯å¾„  | ç›´è§‚æ˜“ç†è§£               | æŒ‡æ•°å¤æ‚åº¦ï¼ŒO(2^M)ä¸å¯è¡Œ | 0åˆ†            |
| **è´ªå¿ƒæŸ“è‰²**  | ä¼˜å…ˆæŸ“å„¿å­å¤šçš„èŠ‚ç‚¹       | å®ç°ç®€å•                 | æ— æ³•å¤„ç†å­æ ‘éœ€æ±‚ä¼ é€’     | 30%éƒ¨åˆ†åˆ†      |
| **äºŒåˆ†+æ ‘å½¢DP** | äºŒåˆ†k+æ ‘å½¢DPéªŒè¯        | O(n log n)é«˜æ•ˆï¼Œé€»è¾‘ä¸¥å¯† | éœ€è¦ç†è§£æ ‘å½¢DP           | 100%           |

### âœ¨ ä¼˜åŒ–ä¹‹æ—…ï¼šä»"èƒ½åš"åˆ°"åšå¥½"
```mermaid
graph LR
A[æš´åŠ›æšä¸¾k] -->|æŒ‡æ•°çˆ†ç‚¸| B[å‘ç°ç“¶é¢ˆ]
B --> C[äºŒåˆ†ç­”æ¡ˆè½¬åŒ–é—®é¢˜]
C --> D[æ ‘å½¢DPä¼˜åŒ–éªŒè¯]
D --> E[çŠ¶æ€è®¾è®¡çªç ´]
E --> F[è¾¹ç•Œä¼˜åŒ–]
```

> ä»æš´åŠ›æšä¸¾åˆ°äºŒåˆ†ç­”æ¡ˆï¼Œæˆ‘ä»¬å®ç°äº†**é—®é¢˜æ€§è´¨**çš„çªç ´ï¼›ä»æœ´ç´ æ ‘éå†åˆ°ç²¾å·§çŠ¶æ€è®¾è®¡ï¼Œæˆ‘ä»¬å®Œæˆäº†**ç®—æ³•æ•ˆç‡**çš„é£è·ƒã€‚è¿™å¯ç¤ºæˆ‘ä»¬ï¼šä¼˜è´¨è§£æ³•å¸¸æºäºå¯¹é—®é¢˜ç»“æ„çš„æ·±åˆ»æ´å¯Ÿï¼

---

## 4. C++æ ¸å¿ƒä»£ç å®ç°èµæ

**æœ¬é¢˜é€šç”¨æ ¸å¿ƒå®ç°**
```cpp
#include <vector>
#include <cstring>
using namespace std;
const int N = 3e5+5;
vector<int> G[N];
int f[N], n, k;

void dfs(int u, int fa) {
    int sum = 0;
    for (int v : G[u]) {
        if (v == fa) continue;
        dfs(v, u);
        sum += f[v] + 1; // å­æ ‘éœ€æ±‚ç´¯è®¡
    }
    f[u] = max(sum - k, 0); // çŠ¶æ€è½¬ç§»æ ¸å¿ƒ
}

bool check(int mid) {
    k = mid;
    memset(f, 0, sizeof(f));
    dfs(1, -1);
    return f[1] == 0; // æ ¹èŠ‚ç‚¹æ— éœ€é¢å¤–å³æˆåŠŸ
}

int main() {
    // å»ºå›¾ä»£ç çœç•¥
    int L = 0, R = n;
    for (int i = 1; i <= n; i++) 
        L = max(L, (int)G[i].size() - (i != 1));
    while (L <= R) {
        int mid = (L+R) >> 1;
        if (check(mid)) R = mid - 1;
        else L = mid + 1;
    }
    cout << L;
}
```

**é¢˜è§£ä¸€ï¼ˆvectorwyxï¼‰ç‰‡æ®µ**
```cpp
void dfs(int u, int fa) {
    f[u] = (u == 1 ? 0 : -k); // æ ¹èŠ‚ç‚¹ç‰¹æ®Šå¤„ç†
    for (int v : G[u]) {
        if (v == fa) continue;
        dfs(v, u);
        if (f[v] > 0) f[u] += f[v]; // ä»…ç´¯åŠ æ­£éœ€æ±‚
    }
    if (u != 1) f[u] += G[u].size() - 1; // éæ ¹èŠ‚ç‚¹åŠ å„¿å­æ•°
}
```
* **äº®ç‚¹**ï¼šé€šè¿‡`u==1`å·§å¦™åŒºåˆ†æ ¹èŠ‚ç‚¹ï¼Œé¿å…å•ç‹¬è®¡ç®—å„¿å­æ•°ã€‚
* **å­¦ä¹ ç¬”è®°**ï¼šç‰¹æ®ŠèŠ‚ç‚¹çš„ç‹¬ç«‹å¤„ç†èƒ½ç®€åŒ–çŠ¶æ€è½¬ç§»é€»è¾‘ã€‚

**é¢˜è§£äºŒï¼ˆCaptain_Paulï¼‰ç‰‡æ®µ**
```cpp
void dfs(int u, int fa) {
    int sum = 0;
    for (int v : G[u]) {
        if (v == fa) continue;
        dfs(v, u);
        sum += f[v] + 1; // æ˜¾å¼æ±‚å’Œ
    }
    f[u] = max(sum - k, 0); // é›†ä¸­å¤„ç†
}
```
* **äº®ç‚¹**ï¼šç”¨`sum`å˜é‡æ¸…æ™°å±•ç¤ºéœ€æ±‚ç´¯è®¡è¿‡ç¨‹ï¼Œä»£ç è‡ªæ³¨é‡Šæ€§å¼ºã€‚
* **å­¦ä¹ ç¬”è®°**ï¼šä¸´æ—¶å˜é‡èƒ½ä½¿å¤æ‚è¡¨è¾¾å¼æ›´æ˜“è¯»ã€‚

**é¢˜è§£ä¸‰ï¼ˆS_S_Hï¼‰ç‰‡æ®µ**
```cpp
void dfs(int u, int fa, int k) { // kä½œä¸ºå‚æ•°ä¼ é€’
    int sum = 0;
    for (int v : G[u]) {
        if (v == fa) continue;
        dfs(v, u, k); // é€’å½’æ—¶æºå¸¦kå€¼
        sum += f[v] + 1;
    }
    f[u] = sum > k ? sum - k : 0; // æ¡ä»¶è¡¨è¾¾å¼ç‰ˆ
}
```
* **äº®ç‚¹**ï¼šå°†kä½œä¸ºDFSå‚æ•°ä¼ é€’ï¼Œé¿å…å…¨å±€å˜é‡ã€‚
* **å­¦ä¹ ç¬”è®°**ï¼šå‡½æ•°å‚æ•°ä¼ é€’æ¯”å…¨å±€å˜é‡æ›´åˆ©äºä»£ç ç»´æŠ¤ã€‚

---

## 5. ç®—æ³•å¯è§†åŒ–ï¼šåƒç´ åŠ¨ç”»æ¼”ç¤º

**åƒç´ åŠ¨ç”»è®¾è®¡**ï¼š  
```mermaid
graph TD
  A[8-bitæ ‘ç»“æ„] --> B[DFSéå†]
  B --> C[èŠ‚ç‚¹ç‚¹äº®]
  C --> D[å›æº¯è®¡ç®—]
  D --> E[çŠ¶æ€å€¼æ˜¾ç¤º]
```

1. **åœºæ™¯è®¾è®¡**ï¼š
   - **æ ‘å½¢åœ°å›¾**ï¼šFCçº¢ç™½æœºé£æ ¼çš„åƒç´ æ ‘ï¼ŒèŠ‚ç‚¹ä¸ºé—ªçƒçš„åŸå ¡å›¾æ ‡
   - **çŠ¶æ€é¢æ¿**ï¼šå³ä¾§æ˜¾ç¤ºå½“å‰èŠ‚ç‚¹`f[u]`å€¼ï¼Œç”¨è¡€æ¡å½¢å¼è¡¨ç¤ºéœ€æ±‚å¼ºåº¦
   - **æ§åˆ¶å°**ï¼šå¤å¤æŒ‰é’®æ§åˆ¶å•æ­¥/æ’­æ”¾/é‡ç½®

2. **åŠ¨ç”»æµç¨‹**ï¼š
   - **Step1**ï¼šä»æ ¹èŠ‚ç‚¹(åŸå ¡)å‡ºå‘ï¼ŒDFSéå†å­æ ‘ï¼ˆåƒç´ å°äººæ²¿æ ‘æç§»åŠ¨ï¼‰
   - **Step2**ï¼šå¶å­èŠ‚ç‚¹å›æº¯ï¼Œæ˜¾ç¤º`f[leaf]=0`ï¼ˆç»¿å¶å›¾æ ‡ï¼‰
   - **Step3**ï¼šéå¶èŠ‚ç‚¹è®¡ç®—`Î£(f[v]+1)`ï¼ˆæ•°å­—ç´¯åŠ åŠ¨æ•ˆï¼‰
   - **Step4**ï¼šè®¡ç®—`max(sum-k,0)`ï¼ˆåƒç´ æ‰³æ‰‹è°ƒæ•´è¡€æ¡é•¿åº¦ï¼‰
   - **Step5**ï¼šæ ¹èŠ‚ç‚¹åˆ¤å®šï¼ˆçš‡å† å›¾æ ‡é—ªçƒç»¿å…‰/çº¢å…‰ï¼‰

3. **æ¸¸æˆåŒ–å…ƒç´ **ï¼š
   - **éŸ³æ•ˆ**ï¼šç§»åŠ¨(8-bitè„šæ­¥å£°)ã€æŸ“è‰²(åˆ·æ¼†å£°)ã€æˆåŠŸ(èƒœåˆ©å·è§’)
   - **å…³å¡**ï¼šæ¯å±‚å­æ ‘ä¸ºä¸€å…³ï¼Œå®Œæˆè®¡ç®—è§£é”ä¸‹ä¸€å±‚
   - **è¯„åˆ†**ï¼šæ ¹æ®æ­¥æ•°å’Œæ—¶é—´æˆäºˆ"ç®—æ³•éª‘å£«"å‹‹ç« 

> é€šè¿‡åƒç´ åŠ¨ç”»ï¼ŒæŠ½è±¡çš„æ ‘å½¢DPåŒ–ä¸ºå¯è§†çš„åŸå ¡æ”»é˜²æˆ˜â€”â€”DFSæ˜¯è¿›å†›è·¯çº¿ï¼ŒçŠ¶æ€è®¡ç®—æ˜¯å…µåŠ›è°ƒé…ï¼Œè€Œ`f[u]`å°±æ˜¯åŸå ¡çš„é˜²å¾¡éœ€æ±‚ï¼

---

## 6. æ‹“å±•ç»ƒä¹ ä¸ç›¸ä¼¼é—®é¢˜

**é€šç”¨æŠ€å·§è¿ç§»**ï¼š
1. **åˆ†ç»„ä¾èµ–**ï¼šå°†"ä¸»ä»¶é™„ä»¶"è½¬åŒ–ä¸ºåˆ†ç»„èƒŒåŒ…ï¼ˆæœ¬é¢˜å°†å­æ ‘éœ€æ±‚æ‰“åŒ…ï¼‰
2. **æå‰å¤„ç†**ï¼šåœ¨çˆ¶èŠ‚ç‚¹è§£å†³å­èŠ‚ç‚¹éœ€æ±‚ï¼ˆå¦‚è¯¾ç¨‹å®‰æ’å…ˆä¿®è¯¾ï¼‰
3. **äºŒåˆ†éªŒè¯**ï¼šæœ€å¤§å€¼æœ€å°åŒ–/å¯è¡Œæ€§é—®é¢˜ï¼ˆå¦‚ç»³å­åˆ‡å‰²ã€è°ƒåº¦é—®é¢˜ï¼‰

**æ´›è°·æ¨è**ï¼š
1. **P2014 [CTSC1997] é€‰è¯¾**  
   â†’ æ ‘å½¢DPä¾èµ–èƒŒåŒ…ï¼Œå·©å›º"çˆ¶å­ä¾èµ–"å»ºæ¨¡èƒ½åŠ›
2. **P1273 æœ‰çº¿ç”µè§†ç½‘**  
   â†’ æ ‘å½¢DP+è´¹ç”¨è®¡ç®—ï¼Œæ‹“å±•çŠ¶æ€è®¾è®¡ç»´åº¦
3. **P2279 [HNOI2003] æ¶ˆé˜²å±€çš„è®¾ç«‹**  
   â†’ æ ‘å½¢DPè¦†ç›–é—®é¢˜ï¼Œå¼ºåŒ–çŠ¶æ€å®šä¹‰æŠ€å·§

---

## 7. å­¦ä¹ å¿ƒå¾—ä¸ç»éªŒåˆ†äº«

> "è°ƒè¯•æ—¶ï¼Œæˆ‘é€šè¿‡æ‰“å°`mid`å’Œ`f[1]`çš„å€¼è§‚å¯ŸäºŒåˆ†è¿‡ç¨‹ï¼Œå‘ç°ä¸‹ç•Œè®¾ç½®é”™è¯¯å¯¼è‡´WAã€‚è¿™æé†’æˆ‘ä»¬ï¼š**äºŒåˆ†è¾¹ç•Œä¸æ˜¯æœºæ¢°çš„[0,n]ï¼Œéœ€ç»“åˆé—®é¢˜ç‰¹æ€§è°ƒæ•´**"â€”â€”vectorwyx

> "æœ€åˆæˆ‘å°è¯•è´ªå¿ƒä¼˜å…ˆæŸ“å„¿å­å¤šçš„èŠ‚ç‚¹ï¼Œç›´åˆ°åä¾‹å‡ºç°ã€‚è¿™éªŒè¯äº†ï¼š**æ ‘å½¢é—®é¢˜ä¸­ï¼Œå±€éƒ¨æœ€ä¼˜â‰ å…¨å±€æœ€ä¼˜**ï¼Œå¿…é¡»é€šè¿‡DPæ•´ä½“æ±‚è§£ã€‚"â€”â€”S_S_H

---

> "ç®—æ³•ä¹‹è·¯å¦‚åŒéª‘å£«è¿œå¾ï¼šäºŒåˆ†æ˜¯æ–¹å‘ï¼Œæ ‘å½¢DPæ˜¯åˆ©å‰‘ï¼Œè€Œæ€ç»´æ´å¯Ÿæ˜¯ç›¾ç‰Œã€‚å½“ä½ ç†è§£çŠ¶æ€è½¬ç§»çš„æ·±æ„ï¼Œä¾¿å·²è·å¾—ç ´è§£ä¸‡åƒæ ‘é¢˜çš„å¯†é’¥ï¼" â€”â€”æ´›è¯­äº‘ç¬º

---
å¤„ç†ç”¨æ—¶ï¼š238.45ç§’
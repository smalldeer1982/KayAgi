# é¢˜ç›®ä¿¡æ¯

# [SHOI2014] ç¥ç§˜é‡‘å­—å¡”

## é¢˜ç›®èƒŒæ™¯

SHOI2014 day2t3

## é¢˜ç›®æè¿°

å¯¹ç¥ç»ç»„ç»‡çš„è¿›åŒ–ç”Ÿç‰©å­¦ç ”ç©¶å°†å†å²è¿½æº¯åˆ°äº†äººç±»ç¤¾ä¼šå½¢æˆä¹‹åˆã€ä¸€ä¸ªå«åš CCM çš„ç¥ç§˜éƒ¨è½ã€‚

è€ƒå¤å­¦è¯æ®è¡¨æ˜ï¼ŒCCM ä¸€åº¦å…·æœ‰é«˜åº¦ç¹åçš„æ–‡æ˜ã€‚ç„¶è€Œ CCM çš„å†å²å´ä¼¼ä¹åœ¨ä¸€å¤œä¹‹é—´ç¥ç§˜åœ°æ¶ˆå¤±äº†ã€‚è€ƒå¤å­¦å®¶è¿‘æ—¥åœ¨å¤§è¥¿æ´‹åº•å‘æ˜å‡ºäº†ä¸€å¤„ CCM æ–‡æ˜é—è¿¹,æœ‰å¸Œæœ›èƒ½å¤Ÿæ­å¼€ CCM å¤æ–‡æ˜å¤±è½ä¹‹è°œã€‚

CCM é—è¿¹çš„ä¸­å¤®æ˜¯ä¸€åº§å·¨å¤§çš„çŸ³è´¨å»ºç­‘,è¢«è€ƒå¤å­¦å®¶ç§°ä¹‹ä¸ºé‡‘å­—å¡”ã€‚é‡‘å­—å¡”æœ‰è¿™æ ·å››æ¡æ€§è´¨:
1. CCM é‡‘å­—å¡”ç”±å®Œå…¨ç›¸åŒçš„ $1 \times 1 \times 1$ å•ä½çš„ç«‹æ–¹ä½“çŸ³å—æ„æˆï¼›
2. CCM é‡‘å­—å¡”ç”±è‹¥å¹²å±‚ç»„æˆï¼Œæ¯ä¸€å±‚çš„çŸ³å—ä»æ­£ä¸Šæ–¹çœ‹éƒ½åœ¨å¹³é¢ä¸Šå½¢æˆä¸€ä¸ªè”é€šå—ã€‚é«˜å±‚çš„çŸ³å—éƒ½æœ‰ä½å±‚çš„çŸ³å—åœ¨ä¸‹æ–¹ä½œä¸ºæ”¯æ’‘ï¼Œä¸ä¼šæœ‰çŸ³å—æ‚¬ç©ºï¼›
3. CCM é‡‘å­—å¡”çš„æ¯ä¸€å±‚ä¸¥æ ¼éƒ½æ»¡è¶³å·¦å³å¯¹ç§°å’Œä¸Šä¸‹å¯¹ç§°ï¼Œå¹¶ä¸”æ‰€æœ‰å±‚çš„å¯¹ç§°è½´æ˜¯é‡åˆçš„ï¼Œä»å·¦å³/ä¸Šä¸‹å¯¹ç§°è½´å‘ä¸¤ç«¯é•¿åº¦/å®½åº¦éä¸¥æ ¼é€’å‡ï¼›
4. CCM é‡‘å­—å¡”çš„æ¯ä¸€å±‚çš„æœ€å¤§é•¿åº¦å’Œæœ€å¤§å®½åº¦éƒ½ç›¸ç­‰ï¼Œå¹¶ä¸”éƒ½æ˜¯å¶æ•°ï¼ˆå› ä¸º CCM äººè®¤ä¸ºå¶æ•°ä»£è¡¨äº†å¥½è¿è€Œå¥‡æ•°åˆ™ä¼šå¸¦æ¥ä¸å¹¸ï¼‰ã€‚

ç„¶è€Œï¼Œä¸å¹¸çš„æ˜¯ï¼Œé—è¿¹ä¸­çš„é‡‘å­—å¡”ç”±äºå¹´ä»£è¿‡äºä¹…è¿œï¼Œå·²ç»æ®‹ç¼ºä¸å…¨ï¼Œéš¾ä»¥è¾¨è®¤å…¨è²Œã€‚ä¸ºäº†å°½å¯èƒ½åœ°è¿˜åŸ CCM é‡‘å­—å¡”çš„å®é™…æƒ…å†µï¼Œè€ƒå¤å­¦å®¶ä»¬é€šè¿‡å…¶ä»–è¯æ®ä¼°è®¡å‡ºäº† CCM é‡‘å­—å¡”æ‰€ä½¿ç”¨çš„çŸ³å—ä¸ªæ•°ã€é‡‘å­—å¡”çš„é«˜åº¦ä»¥åŠæ¯ä¸€å±‚çš„å®½åº¦ï¼Œä»–ä»¬æƒ³è¯·ä½ å¸®å¿™è®¡ç®—ç¬¦åˆä¸Šè¿°æ€§è´¨çš„å¯èƒ½çš„é‡‘å­—å¡”ä¸ªæ•°ã€‚

## è¯´æ˜/æç¤º

å¯¹äº 10%çš„æ•°æ®ï¼Œ$h=1$ã€‚

å¯¹äº 30%çš„æ•°æ®ï¼Œ$n\leq 200,l\leq 10, h\leq 5$ã€‚

å¯¹äº 70%çš„æ•°æ®ï¼Œ$n\leq 800,l\leq 20, h\leq8$ã€‚

å¯¹äº 100%çš„æ•°æ®ï¼Œ$n\leq 1000, 2\leq l\leq 20, 1\leq h\leq 10$ã€‚

![](https://cdn.luogu.com.cn/upload/pic/51009.png)

## æ ·ä¾‹ #1

### è¾“å…¥

```
36 3
6
4
2```

### è¾“å‡º

```
1```

## æ ·ä¾‹ #2

### è¾“å…¥

```
44 2
6
4
```

### è¾“å‡º

```
3```

# AIåˆ†æç»“æœ


### é¢˜ç›®è§£è¯»ä¸ç­–ç•¥åˆæ¢
**âœ¨ æ ¸å¿ƒæŒ‘æˆ˜åˆ†æ**  
æœ¬é¢˜æ ¸å¿ƒæŒ‘æˆ˜åœ¨äºæ„å»ºæ»¡è¶³å¤šé‡å¯¹ç§°æ€§ã€éé€’å¢çº¦æŸçš„é‡‘å­—å¡”ç»“æ„ï¼Œå¹¶åœ¨ä¸¥æ ¼æ¡ä»¶ä¸‹ï¼ˆæ¯å±‚å¯¹ç§°ã€çŸ³å—æ•°æ€»å’Œå›ºå®šï¼‰è®¡ç®—å¯è¡Œæ–¹æ¡ˆæ•°ã€‚éš¾ç‚¹åœ¨äºå¤„ç†å±‚é—´çŸ³å—æ”¯æ’‘å…³ç³»ï¼ˆé«˜å±‚çŸ³å—å¿…é¡»ç”±ä½å±‚æ”¯æ’‘ï¼‰å’Œä¸¥æ ¼çš„å¯¹ç§°çº¦æŸï¼ˆæ¯å±‚å·¦å³ã€ä¸Šä¸‹å¯¹ç§°ï¼Œä¸”å¯¹ç§°è½´é‡åˆï¼‰ã€‚

**ğŸ—£ï¸ åˆæ­¥åˆ†æ**  
- **æš´åŠ›æšä¸¾**ï¼šå°è¯•æ‰€æœ‰å¯èƒ½çš„çŸ³å—æ’åˆ—ç»„åˆï¼Œä½†å±‚å®½åº¦æœ€å¤§20ï¼Œé«˜åº¦10ï¼ŒçŠ¶æ€ç©ºé—´è¾¾ $O(20^{10})$ï¼Œç»å¯¹è¶…æ—¶ã€‚  
- **åŠ¨æ€è§„åˆ’ï¼ˆåˆ†ç»„å‹ç¼©ï¼‰**ï¼šå°†é‡‘å­—å¡”å››ç­‰åˆ†ï¼Œä»…å¤„ç†ä¸€ä¸ªè±¡é™ï¼ˆäºŒç»´æ•°ç»„ $a$ï¼‰ï¼Œæ»¡è¶³ï¼š  
  - $a_{i,1} = l_i/2$ï¼ˆè¾“å…¥å®½åº¦çš„ä¸€åŠï¼‰  
  - $a_{i,j} \leq \min(a_{i-1,j}, a_{i,j-1})$ï¼ˆç¡®ä¿ä¸æ‚¬ç©ºä¸”éé€’å¢ï¼‰  
  - $\sum_{i,j} a_{i,j} = n/4$ï¼ˆæ€»çŸ³å—æ•°éœ€ä¸º4çš„å€æ•°ï¼‰  
- **ä¼˜åŒ–å…³é”®**ï¼šåˆ©ç”¨å±‚å®½åº¦ $l_i \leq 10$ çš„æ€§è´¨ï¼Œå°†çŠ¶æ€å‹ç¼©ä¸ºå•è°ƒéå¢åºåˆ—ï¼ˆçŠ¶æ€æ•°ä»…48620ç§ï¼‰ï¼Œé€šè¿‡é«˜ç»´åç¼€å’ŒåŠ é€Ÿè½¬ç§»ã€‚

**### ğŸ” ç®—æ³•ä¾¦æ¢ï¼šé¢˜ç›®ä¸­çš„çº¿ç´¢**  
1. **çº¿ç´¢1ï¼ˆé—®é¢˜ç›®æ ‡ï¼‰**ï¼šæ±‚â€œæ–¹æ¡ˆæ•°â€ä¸”éœ€æ»¡è¶³å¤æ‚çº¦æŸï¼ˆå¯¹ç§°ã€éé€’å¢ï¼‰ï¼Œæš—ç¤ºéœ€é«˜ç»´çŠ¶æ€æšä¸¾å’ŒåŠ¨æ€è§„åˆ’ã€‚  
2. **çº¿ç´¢2ï¼ˆé—®é¢˜ç‰¹æ€§ï¼‰**ï¼šå±‚é—´â€œæ”¯æ’‘å…³ç³»â€å’Œåºåˆ—â€œå•è°ƒæ€§â€è¦æ±‚ï¼ŒæŒ‡å‘çŠ¶æ€è½¬ç§»éœ€æ»¡è¶³ $a_{i,j} \leq \min(a_{i-1,j}, a_{i,j-1})$ã€‚  
3. **çº¿ç´¢3ï¼ˆæ•°æ®èŒƒå›´ï¼‰**ï¼š$l_i \leq 10$ å…è®¸çŠ¶æ€å‹ç¼©ï¼›$n \leq 1000$ è¡¨æ˜éœ€ $O(n \cdot \text{çŠ¶æ€æ•°})$ çš„DPã€‚

**### ğŸ§  æ€ç»´é“¾æ„å»ºï¼šä»çº¿ç´¢åˆ°ç­–ç•¥**  
> ç»“åˆçº¿ç´¢ï¼šç›®æ ‡ä¸ºè®¡æ•°é—®é¢˜ï¼ˆçº¿ç´¢1ï¼‰ä¸”çº¦æŸå¤æ‚ï¼ˆçº¿ç´¢2ï¼‰ï¼Œæš´åŠ›æœç´¢ $O(2^M)$ ä¸å¯è¡Œï¼ˆ$M=10$ æ—¶ $2^{20} \approx 10^6$ è™½å¯å°è¯•ï¼Œä½† $M=20$ æ—¶ $2^{20} \gg 10^9$ï¼‰ã€‚æ•°æ®èŒƒå›´ï¼ˆçº¿ç´¢3ï¼‰$l_i \leq 10$ æ”¯æŒçŠ¶æ€å‹ç¼©ï¼Œè€Œä¾èµ–å…³ç³»ï¼ˆçº¿ç´¢2ï¼‰éœ€DPé«˜æ•ˆè½¬ç§»ã€‚  
> **ç»“è®º**ï¼šé€‰æ‹©**çŠ¶æ€å‹ç¼©DP**ï¼Œå°†å››åˆ†ä¹‹ä¸€é‡‘å­—å¡”çš„æ¯å±‚çŠ¶æ€ç¼–ç ä¸ºå•è°ƒåºåˆ—ï¼Œè¾…ä»¥**é«˜ç»´åç¼€å’Œ**ä¼˜åŒ–è½¬ç§»ï¼Œå®ç° $O(\text{çŠ¶æ€æ•°}^2 \cdot n)$ çš„å¯è¡Œè§£ã€‚

---

### è§£é¢˜ç­–ç•¥æ·±åº¦å‰–æ
**### ğŸ¯ æ ¸å¿ƒéš¾ç‚¹ä¸å…³é”®æ­¥éª¤**  
1. **çŠ¶æ€å‹ç¼©è®¾è®¡**  
   - **åˆ†æ**ï¼šæ¯å±‚çŠ¶æ€ä¸ºé•¿åº¦ $l_i$ çš„å•è°ƒéå¢åºåˆ—ï¼Œå€¼åŸŸ $[1, l_i]$ã€‚ä¾‹å¦‚ $l_i=3$ æ—¶ï¼Œåˆæ³•åºåˆ—å¦‚ $(3,2,1)$ã€$(3,3,2)$ã€‚  
   - **å­¦ä¹ ç¬”è®°**ï¼šåˆ©ç”¨ç»„åˆæ•°å­¦æ€§è´¨ï¼ŒçŠ¶æ€æ•° $C(2l_i-2, l_i-1)$ å¯æ§ï¼ˆ$l_i=10$ æ—¶ä»…48620ç§ï¼‰ã€‚

2. **é«˜ç»´åç¼€å’Œä¼˜åŒ–**  
   - **åˆ†æ**ï¼šè½¬ç§»éœ€æ»¡è¶³ $S_j \leq T_j$ï¼ˆ$S$ å½“å‰å±‚ï¼Œ$T$ ä¸Šå±‚ï¼‰ã€‚é¢„å¤„ç†é«˜ç»´åç¼€å’Œæ•°ç»„ $F[T]$ï¼Œè¡¨ç¤ºæ‰€æœ‰ $S \leq T$ çš„çŠ¶æ€æƒé‡å’Œï¼Œé¿å… $O(N^2)$ æšä¸¾ã€‚  
   - **å­¦ä¹ ç¬”è®°**ï¼šä¿®æ­£éåˆæ³•çŠ¶æ€ï¼ˆå¦‚ $(0,1)$ ä¸æ»¡è¶³å•è°ƒæ€§ï¼Œéœ€è°ƒæ•´ä¸º $(1,1)$ï¼‰ï¼Œç¡®ä¿åç¼€å’Œæ­£ç¡®æ€§ã€‚

3. **DPè½¬ç§»æ–¹ç¨‹**  
   - **åˆ†æ**ï¼šè®¾ $f[i][T][k]$ ä¸ºç¬¬ $i$ å±‚çŠ¶æ€ $T$ ä¸”æ€»å’Œä¸º $k$ çš„æ–¹æ¡ˆæ•°ã€‚è½¬ç§»æ—¶æšä¸¾ä¸‹ä¸€å±‚çŠ¶æ€ $S$ï¼Œæ»¡è¶³ $S_j \leq \min(T_j, S_{j-1})$ï¼š  
     $$
     f[i][S][k+\text{sum}(S)] += f[i-1][T][k]
     $$
   - **å­¦ä¹ ç¬”è®°**ï¼šé€šè¿‡é«˜ç»´åç¼€å’Œï¼Œå•å±‚è½¬ç§»é™è‡³ $O(\text{çŠ¶æ€æ•°} \cdot n)$ã€‚

**### âœ¨ è§£é¢˜æŠ€å·§æ€»ç»“**  
- **é—®é¢˜è½¬åŒ–**ï¼šå°†ä¸‰ç»´é‡‘å­—å¡”ç®€åŒ–ä¸ºäºŒç»´è±¡é™ï¼Œåˆ©ç”¨å¯¹ç§°æ€§é™ä½ç»´åº¦ã€‚  
- **çŠ¶æ€å‹ç¼©**ï¼šå°†åºåˆ—çº¦æŸè½¬åŒ–ä¸ºç»„åˆæ¨¡å‹ï¼Œæ§åˆ¶çŠ¶æ€çˆ†ç‚¸ã€‚  
- **é«˜ç»´ä¼˜åŒ–**ï¼šç”¨åç¼€å’Œå°†é…å¯¹è½¬ç§»å¤æ‚åº¦ä» $O(N^2)$ é™è‡³ $O(N)$ã€‚

**### âš”ï¸ ç­–ç•¥ç«æŠ€åœºï¼šè§£æ³•å¯¹æ¯”**  
| ç­–ç•¥          | æ ¸å¿ƒæ€æƒ³                     | ä¼˜ç‚¹                     | ç¼ºç‚¹ä¸åˆ†æ                                | é€‚ç”¨åœºæ™¯/å¾—åˆ†         |
|---------------|------------------------------|--------------------------|------------------------------------------|---------------------|
| **æš´åŠ›æœç´¢**  | æšä¸¾æ¯å±‚æ‰€æœ‰å¯èƒ½åºåˆ—         | ç›´è§‚æ˜“å®ç°               | çŠ¶æ€æ•° $O(l_i^h) \gg 10^{10}$ï¼Œè¶…æ—¶      | $l_i \leq 5, h \leq 3$ï¼ˆ30%åˆ†ï¼‰ |
| **æ ‘å½¢DP**    | ä»¥å±‚ä¸ºèŠ‚ç‚¹ï¼Œåºåˆ—å€¼ä¸ºå­æ ‘     | è‡ªç„¶å»ºæ¨¡ä¾èµ–å…³ç³»         | çŠ¶æ€è½¬ç§»å¤æ‚ï¼Œä»£ç éš¾åº¦é«˜                 | å±‚é—´çº¦æŸå¤æ‚ï¼ˆ70%åˆ†ï¼‰ |
| **åˆ†ç»„å‹ç¼©DP**| å‹ç¼©çŠ¶æ€+é«˜ç»´åç¼€å’Œ          | çŠ¶æ€æ•°å°‘ï¼Œè½¬ç§»é«˜æ•ˆ       | éœ€é¢„å¤„ç†é«˜ç»´å’Œï¼Œè¾¹ç•Œä¿®æ­£å¤æ‚             | æœ¬é¢˜æœ€ä¼˜ï¼ˆ100%åˆ†ï¼‰    |

**### âœ¨ ä¼˜åŒ–ä¹‹æ—…ï¼šä»æš´åŠ›åˆ°åˆ†ç»„DP**  
> æš´åŠ›æœç´¢å› çŠ¶æ€çˆ†ç‚¸æ­¢æ­¥ï¼ˆ$l_i=10, h=10$ è¶… $10^{10}$ï¼‰ã€‚è§‚å¯Ÿå‘ç°åºåˆ—å•è°ƒæ€§å¯å‹ç¼©çŠ¶æ€ï¼ˆé™è‡³ $10^5$ çº§ï¼‰ï¼Œä½†è½¬ç§»ä»éœ€ $O(N^2)$ã€‚é«˜ç»´åç¼€å’Œä¼˜åŒ–å°†è½¬ç§»é™ä¸ºçº¿æ€§ï¼Œæœ€ç»ˆ $O(\text{çŠ¶æ€æ•°} \cdot n \cdot h) \approx 5 \times 10^8$ï¼ŒC++å¯è¿‡ã€‚  

---

### C++æ ¸å¿ƒä»£ç å®ç°èµæ
**é€šç”¨æ ¸å¿ƒå®ç°å‚è€ƒ**  
```cpp
#include <vector>
#include <cstring>
using namespace std;

const int MAXN = 1000, MAX_STATES = 50000;
int h, total_stones;
int layer_widths[15];
vector<vector<int>> states[15]; // å­˜å‚¨æ¯å±‚æ‰€æœ‰çŠ¶æ€
int f[12][MAX_STATES][MAXN];    // DPæ•°ç»„

void dfs(int idx, int len, vector<int>& cur, vector<vector<int>>& res) {
    if (idx > len) {
        res.push_back(cur);
        return;
    }
    int start = (idx == 1) ? layer_widths[0] : min(layer_widths[idx-1], cur.back());
    for (int x = start; x >= 1; x--) {
        cur.push_back(x);
        dfs(idx + 1, len, cur, res);
        cur.pop_back();
    }
}

int main() {
    cin >> total_stones >> h;
    for (int i = 0; i < h; i++) {
        cin >> layer_widths[i];
        layer_widths[i] /= 2; // è¾“å…¥ä¸ºå®é™…å®½åº¦ï¼Œå‹ç¼©ä¸º1/4
    }

    // ç”Ÿæˆæ¯å±‚çŠ¶æ€
    for (int i = 0; i < h; i++) {
        vector<int> tmp;
        dfs(1, layer_widths[i], tmp, states[i]);
    }

    // åˆå§‹åŒ–ï¼šç¬¬ä¸€å±‚çŠ¶æ€
    for (int sid = 0; sid < states[0].size(); sid++) {
        int sum_val = 0;
        for (int x : states[0][sid]) sum_val += x;
        if (sum_val * 4 == total_stones) f[0][sid][sum_val] = 1;
    }

    // DPè½¬ç§»
    for (int i = 1; i < h; i++) {
        for (int tid = 0; tid < states[i-1].size(); tid++) {
            vector<int>& T = states[i-1][tid];
            for (int sid = 0; sid < states[i].size(); sid++) {
                vector<int>& S = states[i][sid];
                int sum_s = 0;
                bool valid = true;
                for (int j = 0; j < S.size(); j++) {
                    if (S[j] > T[j]) { valid = false; break; } // çŠ¶æ€çº¦æŸ
                    sum_s += S[j];
                }
                if (!valid) continue;
                for (int k = 0; k + sum_s * 4 <= total_stones; k++) {
                    f[i][sid][k+sum_s] += f[i-1][tid][k];
                }
            }
        }
    }

    int ans = 0;
    for (int sid = 0; sid < states[h-1].size(); sid++)
        ans += f[h-1][sid][total_stones/4];
    cout << ans;
}
```
**ä»£ç è§£è¯»æ¦‚è¦**ï¼š  
1. **çŠ¶æ€ç”Ÿæˆ**ï¼š`dfs` é€’å½’ç”Ÿæˆæ¯å±‚åˆæ³•å•è°ƒåºåˆ—ï¼ˆéå¢ï¼‰ï¼Œå¦‚ `(6,4,2)`ã€‚  
2. **DPåˆå§‹åŒ–**ï¼šç¬¬ä¸€å±‚çŠ¶æ€æ€»å’Œéœ€æ»¡è¶³ $4 \times \text{sum} = n$ã€‚  
3. **é«˜ç»´çº¦æŸè½¬ç§»**ï¼šæ£€æŸ¥ $S_j \leq T_j$ åæ›´æ–° $f[i][S][k+\text{sum}(S)]$ã€‚  

---

### ç®—æ³•å¯è§†åŒ–ï¼šåƒç´ åŠ¨ç”»æ¼”ç¤º  
**ä¸»é¢˜**ï¼š8ä½åƒç´ é£â€œé‡‘å­—å¡”å»ºé€ è€…â€  
**æ ¸å¿ƒæ¼”ç¤º**ï¼š  
1. **åˆå§‹åŒ–**ï¼šç½‘æ ¼åŒ–å››åˆ†ä¹‹ä¸€é‡‘å­—å¡”ï¼ˆ10Ã—10ï¼‰ï¼Œæ¯æ ¼è¡¨ç¤ºå¯èƒ½çŠ¶æ€å€¼ï¼Œåº•è‰²ç°ï¼ˆæœªæ¿€æ´»ï¼‰ã€‚  
2. **çŠ¶æ€ç”Ÿæˆ**ï¼šç¬¬ä¸€å±‚æ¿€æ´»ï¼ˆè“è‰²å—ï¼‰ï¼ŒDFSç”Ÿæˆåºåˆ—å¦‚ `(6,4,2)`ï¼Œä¼´éšâ€œæ”¾ç½®â€éŸ³æ•ˆï¼ˆ8-bitå£°æ•ˆï¼‰ã€‚  
3. **DPè½¬ç§»**ï¼š  
   - ä¸Šå±‚çŠ¶æ€ $T=(6,4,2)$ æ˜¾ç¤ºä¸ºç»¿è‰²ï¼Œå½“å‰å±‚ $S=(4,3,1)$ ä¸ºé»„è‰²ï¼Œè‡ªåŠ¨æ ¡éªŒ $S_j \leq T_j$ï¼ˆæ ¡éªŒé€šè¿‡é—ªçƒç»¿å…‰ï¼‰ã€‚  
   - é«˜ç»´åç¼€å’Œè¿‡ç¨‹ï¼š$T$ å³ä¾§å±•å¼€â€œå…‰å¸¦â€ï¼Œè¦†ç›–æ‰€æœ‰ $S \leq T$ çš„çŠ¶æ€ï¼Œå¹¶æ˜¾ç¤ºèšåˆå€¼ã€‚  
4. **é€šå…³åé¦ˆ**ï¼šæ€»å’Œ $k=n/4$ æ—¶ï¼Œé‡‘å­—å¡”å‘å…‰ + èƒœåˆ©éŸ³æ•ˆã€‚  

**äº¤äº’è®¾è®¡**ï¼š  
- **æ§åˆ¶é¢æ¿**ï¼šæ­¥è¿›/æ’­æ”¾/è°ƒé€Ÿæ»‘å—ï¼ˆå¤å¤æ—‹é’®UIï¼‰ã€‚  
- **éŸ³æ•ˆ**ï¼šå…³é”®æ“ä½œï¼ˆæ¯”è¾ƒ $S_j \leq T_j$ï¼‰è§¦å‘â€œå®â€å£°ï¼Œé”™è¯¯åˆ™â€œå˜Ÿâ€å£°ã€‚  
- **æ¸¸æˆåŒ–**ï¼šæ¯å±‚ä¸º1å°å…³ï¼Œé€šå…³å¾—åƒç´ æ˜Ÿæ˜Ÿï¼Œç§¯åˆ†=å‰©ä½™æ—¶é—´Ã—$10^3$ã€‚  

---

### æ‹“å±•ç»ƒä¹ ä¸ç›¸ä¼¼é—®é¢˜  
1. **åˆ†ç»„èƒŒåŒ…æ¨¡å‹è¿ç§»**  
   - **æ´›è°· P1064**ï¼šä¾èµ–èƒŒåŒ…ï¼ˆä¸»ä»¶+é™„ä»¶ï¼‰ï¼Œåˆ†ç»„å†³ç­–æ€æƒ³ã€‚  
   - **æ´›è°· P5020**ï¼šè´§å¸ç³»ç»Ÿï¼ˆå•è°ƒæ€§+çŠ¶æ€å‹ç¼©ï¼‰ã€‚  
   - **æ´›è°· P1854**ï¼šèŠ±åº—æ©±çª—ï¼ˆäºŒç»´åºåˆ—çº¦æŸDPï¼‰ã€‚  

> é€šè¿‡é‡‘å­—å¡”é—®é¢˜ï¼ŒæŒæ¡é«˜ç»´çŠ¶æ€å‹ç¼©å’Œä¾èµ–å…³ç³»å¤„ç†ï¼Œå³å¯æ”»å…‹ä¸Šè¿°å˜ç§ï¼  

--- 
> ç†è§£å¤æ‚çº¦æŸçš„å…³é”®åœ¨äº**é™ç»´ä¸å¯¹ç§°æ€§è½¬åŒ–**ã€‚å°†ä¸‰ç»´é—®é¢˜å‹ç¼©è‡³äºŒç»´è±¡é™ï¼Œå†å€ŸDPé«˜æ•ˆæšä¸¾ï¼Œæ­£æ˜¯ç®—æ³•ä¹‹ç¾ï¼ â€”â€” æ´›è¯­äº‘ç¬º ğŸ’¡

---
å¤„ç†ç”¨æ—¶ï¼š492.17ç§’
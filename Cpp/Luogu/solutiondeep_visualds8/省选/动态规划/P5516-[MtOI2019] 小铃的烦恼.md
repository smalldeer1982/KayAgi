# é¢˜ç›®ä¿¡æ¯

# [MtOI2019] å°é“ƒçš„çƒ¦æ¼

## é¢˜ç›®èƒŒæ™¯

åœ¨å¹»æƒ³ä¹¡ä¸­ï¼Œæœ¬å±… å°é“ƒ(Motoori Kosuzu)ä¸ä»…ç»å¸¸è¢«äººæ’ï¼Œè¿˜è¦æ•´ç†é“ƒå¥ˆåºµçš„ä¹¦ç±ï¼Œå¥¹æœ‰å¾ˆå¤šçƒ¦æ¼ã€‚

## é¢˜ç›®æè¿°

å°é“ƒæ¯å¤©éƒ½ä¼šæ•´ç†ä¸€æ¬¡é“ƒå¥ˆåºµçš„ä¹¦ç±ã€‚è¿™æ¬¡æ¡Œå­ä¸Šæœ‰ $n$ æœ¬é­”æ³•ä¹¦ï¼Œè¿™äº›ä¹¦ä¸€æ¬¡æ’æˆä¸€æ’ï¼Œæ¯æœ¬ä¹¦æœ‰ä¸€ä¸ªé­”æ³•å±æ€§å’Œç¼–å·ã€‚

æœ€å¼€å§‹è¿™äº›ä¹¦çš„é­”æ³•å±æ€§éƒ½æ˜¯ä¸€æ ·çš„ï¼Œä½†æ˜¯å› ä¸ºè¢«äººå¤šæ¬¡ä½¿ç”¨ï¼Œé­”æ³•å±æ€§å‘ç”Ÿäº†å˜åŒ–ï¼Œå°é“ƒæƒ³è®©æ‰€æœ‰ä¹¦çš„é­”æ³•å±æ€§é‡æ–°å…¨éƒ¨ç›¸åŒã€‚

è¿™æ¬¡å°é“ƒæ‰¾åˆ°äº†é›¾é›¨ é­”ç†æ²™(Kirisame Marisa)å¸®å¿™æ•´ç†ä¹¦ç±ï¼Œæ¯æ¬¡é­”ç†æ²™å¯ä»¥é‡Šæ”¾é€‰å®šé­”æ³•ï¼Œé­”æ³•ä¼šéšæœºé€‰æ‹©ä¸¤æœ¬ä¹¦ $a,b$ ( $a$ ä¸ç­‰äº $b$ )ã€‚

é€‰å®šè¿™ä¸¤æœ¬ä¹¦åï¼Œé­”ç†æ²™ä¼šé‡Šæ”¾è½¬ç§»é­”æ³•ï¼Œä½¿å¾—æœ‰ $p_{a,b}\ (p_{a,b}\in (0,1])$ çš„æ¦‚ç‡ï¼Œç¬¬ $b$ æœ¬ä¹¦çš„é­”æ³•å±æ€§å˜æˆç¬¬ $a$ æœ¬ä¹¦çš„é­”æ³•å±æ€§ã€‚ä¹Ÿå°±æ˜¯è¯´æœ‰ $1-p_{a,b}$ çš„æ¦‚ç‡ï¼Œä½¿å¾—ä½ **å³ä½¿é€‰å®šäº† $a,b$ ä¸¤æœ¬ä¹¦ï¼Œä½†æ˜¯é­”æ³•å±æ€§çš„è½¬ç§»ä¸æˆåŠŸï¼Œæ„å‘³ç€è¿™æ¬¡æ“ä½œæ˜¯æ— æ•ˆçš„** ã€‚

æ³¨æ„ $p_{a,b}$ æ˜¯å¯¹äº**è½¬ç§»æ˜¯å¦æˆåŠŸçš„æ¦‚ç‡**ï¼Œå’Œéšæœºé€‰æ‹©ä¸¤æœ¬ä¹¦çš„æ“ä½œäº’ä¸å½±å“ã€‚

ç°åœ¨å°é“ƒæƒ³çŸ¥é“ï¼Œæ±‚æœŸæœ›æ“ä½œå¤šå°‘æ¬¡ï¼Œæ‰èƒ½ä½¿æ‰€æœ‰çš„ä¹¦é­”æ³•å±æ€§éƒ½ä¸€æ ·ï¼Ÿç”±äºæ—¶é—´ç´§è¿«ï¼Œå°é“ƒæ‰¾åˆ°äº†ä½ ï¼Œå¸Œæœ›ä½ å¯ä»¥å¸®å…¶è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œä¸ç„¶å°é“ƒå°±ä¸ä¼šç»™ä½ è¿™é¢˜çš„åˆ†äº†ã€‚

## è¯´æ˜/æç¤º

å¯¹äºå‰ $10\%$ çš„æ•°æ®ï¼Œ$n\leq 10$ï¼Œä¸”æœ€å¤šæœ‰ä¸€ç§ä¸åŒçš„é­”æ³•å±æ€§ã€‚

å¯¹äºå¦å¤– $20\%$ çš„æ•°æ®ï¼Œ$n\leq10$ï¼Œä¸”æœ€å¤šæœ‰ä¸¤ç§ä¸åŒçš„é­”æ³•å±æ€§ï¼Œå¹¶ä¸”å…¶ä¸­ä¸€ç§çš„é­”æ³•å±æ€§çš„ä¸ªæ•°å°äºç­‰äº $1$  ã€‚

å¯¹äº $100\%$ çš„æ•°æ®ï¼Œ$n\leq2\times 10^3$ ã€‚

å¯¹äºæ‰€æœ‰æ•°æ®ï¼Œæ»¡è¶³ $\left(\sum\limits_{a=1}^{n}\sum\limits_{b=1}^{n}p_{a,b}\right) = n^2$ ã€‚

### é¢˜ç›®æ¥æº

[è¿·é€”ä¹‹å®¶2019è”èµ›](https://www.luogu.org/contest/20135)(MtOI2019) T3

å‡ºé¢˜äººï¼šQiuly 


## æ ·ä¾‹ #1

### è¾“å…¥

```
NACLYFISHAKIOI
1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0
1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0
1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0
1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0
1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0
1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0
1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0
1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0
1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0
1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0
1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0
1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0
1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0
1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0```

### è¾“å‡º

```
164.9```

## æ ·ä¾‹ #2

### è¾“å…¥

```
DSGAY
1.0 1.0 1.0 1.0 1.0
1.0 1.0 1.0 1.0 1.0
1.0 1.0 1.0 1.0 1.0
1.0 1.0 1.0 1.0 1.0
1.0 1.0 1.0 1.0 1.0

```

### è¾“å‡º

```
16.0```

# AIåˆ†æç»“æœ


# ğŸ’¡ æ´›è¯­äº‘ç¬ºçš„C++ç®—æ³•è§£æï¼š[MtOI2019] å°é“ƒçš„çƒ¦æ¼ æ·±å…¥å­¦ä¹ æŒ‡å— ğŸ’¡

## 1. é¢˜ç›®è§£è¯»ä¸ç­–ç•¥åˆæ¢

âœ¨ **æœ¬é¢˜æ ¸å¿ƒæŒ‘æˆ˜**ï¼šå¤„ç†éšæœºæ“ä½œä¸‹çš„æœŸæœ›æ­¥æ•°è®¡ç®—ï¼Œæ ¸å¿ƒåœ¨äºå»ºç«‹çŠ¶æ€è½¬ç§»æ¨¡å‹å¹¶é«˜æ•ˆæ±‚è§£ä¸‰å¯¹è§’çº¿æ€§æ–¹ç¨‹ç»„ã€‚  
âœ¨ **æ ¸å¿ƒç®—æ³•æ ‡ç­¾**ï¼šæ¦‚ç‡æœŸæœ›ã€åŠ¨æ€è§„åˆ’ã€çº¿æ€§ä»£æ•°ï¼ˆä¸‰å¯¹è§’çŸ©é˜µæ±‚è§£ï¼‰

ğŸ—£ï¸ **åˆæ­¥åˆ†æ**ï¼š  
> æœ¬é¢˜è¦æ±‚è®¡ç®—ä½¿æ‰€æœ‰ä¹¦ç±é­”æ³•å±æ€§ç›¸åŒçš„æœŸæœ›æ“ä½œæ¬¡æ•°ã€‚å…³é”®çº¦æŸ $\sum p_{i,j}=n^2$ æ¨å‡º $p_{i,j}\equiv1$ï¼Œç®€åŒ–äº†æ¦‚ç‡æ¨¡å‹ã€‚æ ¸å¿ƒæ€è·¯æ˜¯ï¼š
> 1. æšä¸¾æœ€ç»ˆå±æ€§ $c$ï¼Œè®¾ $f_i$ è¡¨ç¤ºå½“å‰ $i$ æœ¬ä¹¦å±æ€§ä¸º $c$ æ—¶è¾¾æˆç›®æ ‡çš„æœŸæœ›æ­¥æ•°
> 2. æ¨å¯¼ $f_i$ çš„è½¬ç§»æ–¹ç¨‹ï¼š$f_i = \frac{n(n-1)}{2i(n-i)} + \frac{i-1}{2i}f_{i-1} + \frac{i+1}{2i}f_{i+1}$
> 3. åˆ©ç”¨ä¸‰å¯¹è§’çŸ©é˜µç‰¹æ€§ $O(n)$ æ±‚è§£æ–¹ç¨‹ç»„
>
> å¯è§†åŒ–è®¾è®¡ï¼šé‡‡ç”¨åƒç´ é£çŠ¶æ€æœºå±•ç¤ºçŠ¶æ€è½¬ç§»è¿‡ç¨‹ï¼Œç”¨é¢œè‰²åŒºåˆ†å½“å‰å±æ€§åˆ†å¸ƒï¼ŒéŸ³æ•ˆæ ‡è®°å…³é”®æ“ä½œã€‚

### ğŸ” ç®—æ³•ä¾¦æ¢ï¼šå¦‚ä½•åœ¨é¢˜ç›®ä¸­å‘ç°çº¿ç´¢ï¼Ÿ
1.  **çº¿ç´¢1 (é—®é¢˜ç›®æ ‡)**ï¼šé¢˜ç›®è¦æ±‚"æœŸæœ›æ“ä½œæ¬¡æ•°ä½¿æ‰€æœ‰ä¹¦å±æ€§ç›¸åŒ"ï¼Œè¿™æ˜¯å…¸å‹çš„**é©¬å°”å¯å¤«è¿‡ç¨‹æœŸæœ›è®¡ç®—**é—®é¢˜ã€‚
2.  **çº¿ç´¢2 (çº¦æŸç‰¹æ€§)**ï¼š$\sum p_{i,j}=n^2$ æš—ç¤º $p_{i,j}\equiv1$ï¼Œæ’é™¤æ¦‚ç‡å¹²æ‰°ï¼Œ**ç®€åŒ–çŠ¶æ€è½¬ç§»æ¨¡å‹**ã€‚
3.  **çº¿ç´¢3 (æ•°æ®è§„æ¨¡)**ï¼š$n\leq 2000$ è¦æ±‚ $O(n)$ è§£æ³•ï¼ŒæŒ‡å‘**ä¸‰å¯¹è§’çŸ©é˜µä¼˜åŒ–**è€Œéæš´åŠ›é«˜æ–¯æ¶ˆå…ƒã€‚

### ğŸ§  æ€ç»´é“¾æ„å»ºï¼šä»çº¿ç´¢åˆ°ç­–ç•¥
> "è®©æˆ‘ä»¬ä¸²è”çº¿ç´¢ï¼š
> 1. ã€çº¿ç´¢1ã€‘æç¤ºä½¿ç”¨æœŸæœ›DPï¼Œä½†çŠ¶æ€ç©ºé—´è¿ç»­éœ€ä»£æ•°å»ºæ¨¡
> 2. ã€çº¿ç´¢2ã€‘æ¶ˆé™¤æ¦‚ç‡å¤æ‚åº¦ï¼Œèšç„¦çŠ¶æ€è½¬ç§»æœ¬è´¨
> 3. ã€çº¿ç´¢3ã€‘$n=2000$ è¦æ±‚é«˜æ•ˆè§£æ³•ï¼Œè§‚å¯Ÿæ–¹ç¨‹å½¢å¼å‘ç°**ä¸‰å¯¹è§’ç³»æ•°çŸ©é˜µ**
> 4. **ç»“è®º**ï¼šé‡‡ç”¨é€’æ¨ç³»æ•°æ³•ï¼ˆScarlet_Hypocè§£æ³•ï¼‰æˆ–æ‰©åŸŸæ³•ï¼ˆZillionXè§£æ³•ï¼‰ï¼Œå°† $O(n^3)$ ä¼˜åŒ–ä¸º $O(n)$"

---

## 2. ç²¾é€‰ä¼˜è´¨é¢˜è§£å‚è€ƒ

**é¢˜è§£ä¸€ï¼šScarlet_Hypocï¼ˆé€’æ¨ç³»æ•°æ³•ï¼‰**  
* **ç‚¹è¯„**ï¼š  
  æ€è·¯æ¸…æ™°æŠ“ä½ä¸‰å¯¹è§’çŸ©é˜µç‰¹æ€§ï¼Œåˆ›æ–°æ€§ä½¿ç”¨ $f_i=a_if_{i+1}+b_i$ é€’æ¨å…³ç³»ã€‚ä»£ç å®ç°ç®€æ´ï¼ˆä»…20è¡Œï¼‰ï¼Œå…³é”®åœ¨ï¼š
  - ç³»æ•°é€’æ¨ï¼š`a[i]=(-1-i)*inv/p` å·§å¦™å¤„ç†è´Ÿç³»æ•°
  - è¾¹ç•Œå¤„ç†ï¼š`f[n]=0` çš„é€†å‘å›ä»£
  - å¤æ‚åº¦ï¼šä¸¥æ ¼ $O(n)$ ç¢¾å‹é«˜æ–¯æ¶ˆå…ƒ

**é¢˜è§£äºŒï¼šå¯’é¸½å„¿ï¼ˆçŸ©é˜µä¼˜åŒ–æ³•ï¼‰**  
* **ç‚¹è¯„**ï¼š  
  ä¸¥è°¨æ¨å¯¼æ¦‚ç‡æœŸæœ›å…¬å¼ï¼Œå¯è§†åŒ–å±•ç¤ºä¸‰å¯¹è§’çŸ©é˜µç»“æ„ã€‚äº®ç‚¹ï¼š
  - çŸ©é˜µå›¾ç¤ºæ¸…æ™°å±•ç¤ºæ¶ˆå…ƒè·¯å¾„
  - å¼ºè°ƒ $f_0$ æœªå®šä¹‰çš„ç‰¹æ®Šå¤„ç†
  - ç¨³å®šæ€§ï¼šè™½åŒä¸º $O(n)$ ä½†ä»£ç ç¨é•¿ï¼Œæ•™å­¦ä»·å€¼é«˜

**é¢˜è§£ä¸‰ï¼šZillionXï¼ˆæ‰©åŸŸæ³•ï¼‰**  
* **ç‚¹è¯„**ï¼š  
  åˆ›æ–°é‡‡ç”¨ $f_i=A_if_1+B_i$ çš„æ‰©åŸŸæŠ€å·§ï¼š
  - çªç ´æ€§æ€è·¯ï¼šå°†æ–¹ç¨‹ç»„è½¬ä¸ºçº¿æ€§å‡½æ•°
  - ä»£ç ç®€æ´æ€§ï¼š15è¡Œæ ¸å¿ƒä»£ç åŒ…å«å®Œæ•´æ±‚è§£
  - æ•°å­¦ç¾æ„Ÿï¼šä»£æ•°å˜æ¢å±•ç°ä¼˜é›…è§£æ³•

---

## 3. è§£é¢˜ç­–ç•¥æ·±åº¦å‰–æ

### ğŸ¯ æ ¸å¿ƒéš¾ç‚¹ä¸å…³é”®æ­¥éª¤
1.  **éš¾ç‚¹1ï¼šæ¦‚ç‡ä¸æœŸæœ›çš„è€¦åˆ**
    - **åˆ†æ**ï¼šéœ€å…ˆæ±‚ $p_i$ï¼ˆ$i$ ä¸ªç›®æ ‡å±æ€§æ—¶æˆåŠŸæ¦‚ç‡ï¼‰ï¼Œæ¨å¯¼ $p_i=\frac{i}{n}$ ä¸ºæœŸæœ›è®¡ç®—å¥ åŸº
    - ğŸ’¡ **å­¦ä¹ ç¬”è®°**ï¼š*"æ¦‚ç‡æ˜¯æœŸæœ›çš„æƒé‡ï¼Œåˆ†ç¦»è®¡ç®—å†èåˆæ˜¯æœŸæœ›DPæ ¸å¿ƒæŠ€å·§"*
2.  **éš¾ç‚¹2ï¼šçŠ¶æ€è½¬ç§»è®¾è®¡**
    - **åˆ†æ**ï¼šæ“ä½œåˆ†ä¸‰ç§æƒ…å†µï¼ˆå±æ€§+1/-1/ä¸å˜ï¼‰ï¼Œéœ€è½¬åŒ–ä¸ºä¸¥è°¨æ–¹ç¨‹ï¼š
      $$f_i=\frac{n(n-1)}{2i(n-i)}+\frac{i-1}{2i}f_{i-1}+\frac{i+1}{2i}f_{i+1}$$
    - ğŸ’¡ **å­¦ä¹ ç¬”è®°**ï¼š*"å½“è½¬ç§»å«è‡ªç¯æ—¶ï¼Œè§£æ–¹ç¨‹ç§»é¡¹æ˜¯ç ´å±€å…³é”®"*
3.  **éš¾ç‚¹3ï¼šç¨€ç–çŸ©é˜µæ±‚è§£**
    - **åˆ†æ**ï¼šç³»æ•°çŸ©é˜µä¸‰å¯¹è§’ï¼ˆæ¯è¡Œä»…3éé›¶å…ƒï¼‰ï¼Œé€‚ç”¨è¿½èµ¶æ³•ï¼š
      ```python
      for i in range(2, n):
          inv = 0.5 / i
          p = 1 - (1-i)*inv*a[i-1]  # æ¶ˆå…ƒå› å­
          a[i] = (-1-i)*inv / p     # é€’æ¨ç³»æ•°
      ```
    - ğŸ’¡ **å­¦ä¹ ç¬”è®°**ï¼š*"ç¨€ç–çŸ©é˜µçš„æ¶ˆå…ƒé¡ºåºå†³å®šå¤æ‚åº¦"*

### âœ¨ è§£é¢˜æŠ€å·§æ€»ç»“
- **æŠ€å·§1ï¼ˆé—®é¢˜è½¬åŒ–ï¼‰**ï¼šå°†å±æ€§ä¾èµ–è½¬åŒ–ä¸ºåˆ†ç»„èƒŒåŒ…æ¨¡å‹
- **æŠ€å·§2ï¼ˆä»£æ•°é‡æ„ï¼‰**ï¼šæ‰©åŸŸæ³• $f_i=A_if_1+B_i$ è§£çº¿æ€§æ–¹ç¨‹ç»„
- **æŠ€å·§3ï¼ˆè¾¹ç•Œè‰ºæœ¯ï¼‰**ï¼š$f_n=0$ çš„åˆ›é€ æ€§åˆ©ç”¨ç®€åŒ–å›ä»£

### âš”ï¸ ç­–ç•¥ç«æŠ€åœºï¼šä¸åŒè§£æ³•å¯¹æ¯”

| ç­–ç•¥          | æ ¸å¿ƒæ€æƒ³                     | ä¼˜ç‚¹                     | ç¼ºç‚¹                                   | é€‚ç”¨åœºæ™¯           |
|---------------|------------------------------|--------------------------|----------------------------------------|--------------------|
| **æš´åŠ›æœç´¢**  | æšä¸¾æ‰€æœ‰æ“ä½œåºåˆ—             | é€»è¾‘ç›´è§‚                 | $O(2^n)$ ä¸å¯è¡Œ                        | $n\leq 20$        |
| **é«˜æ–¯æ¶ˆå…ƒ**  | ç›´æ¥è§£çº¿æ€§æ–¹ç¨‹ç»„             | å®ç°ç®€å•                 | $O(n^3)$ è¶…æ—¶                         | $n\leq 500$       |
| **é€’æ¨ç³»æ•°**  | $f_i=a_i f_{i+1}+b_i$        | $O(n)$ æœ€ä¼˜ï¼Œä»£ç ç®€æ´    | éœ€è¦é€†å‘æ€ç»´                           | ç«èµ›æ ‡å‡†è§£æ³•       |
| **æ‰©åŸŸæ³•**    | $f_i=A_i f_1+B_i$            | æ­£å‘é€’æ¨ï¼Œæ•°å­¦ç¾æ„Ÿå¼º     | éœ€å¤„ç†è¾¹ç•Œæ–¹ç¨‹                         | ç†è®ºåˆ†æé¦–é€‰       |

### âœ¨ ä¼˜åŒ–ä¹‹æ—…ï¼šä»"èƒ½åš"åˆ°"åšå¥½"
> 1. **èµ·ç‚¹ï¼šæš´åŠ›æœç´¢çš„å›°å¢ƒ**  
>    å°è¯• $2^M$ è·¯å¾„åœ¨ $M=60$ æ—¶è¶…æ—¶ï¼ˆ$2^{60}\approx 10^{18}$ï¼‰
> 2. **å‘ç°é‡å¤å­é—®é¢˜**  
>    $f_i$ è®¡ç®—ä¾èµ– $f_{i-1},f_{i+1}$ å½¢æˆæœ‰ç¯DP
> 3. **ä»£æ•°è½¬åŒ–ç ´å±€**  
>    æ¶ˆå…ƒå¾— $f_{i+1}=2f_i-f_{i-1}-\frac{s-1}{s-i}$ å¼€å¯é€’æ¨ä¹‹è·¯
> 4. **ç³»æ•°é€’æ¨å‡å**  
>    Scarlet_Hypoc è§£æ³•å®ç° $O(n)$ é£è·ƒ

ğŸ’¡ **ç­–ç•¥æ€»ç»“**ï¼š*"ä»æš´åŠ›åˆ°é€’æ¨ç³»æ•°ï¼Œæ˜¯é—®é¢˜æŠ½è±¡èƒ½åŠ›ä¸ç®—æ³•ä¼˜åŒ–èƒ½åŠ›çš„å®Œç¾å…±èˆ"*

---

## 4. C++æ ¸å¿ƒä»£ç èµæ

**æœ¬é¢˜é€šç”¨æ ¸å¿ƒå®ç°ï¼ˆé€’æ¨ç³»æ•°æ³•ï¼‰**
```cpp
#include <cstdio>
#include <cstring>
#define maxn 2010

int n, cnt[26];
char s[maxn];
double a[maxn], b[maxn], f[maxn], ans;

int main() {
    scanf("%s", s); n = strlen(s);
    for(int i = 0; i < n; i++) cnt[s[i]-'A']++;
    
    if(n == 1) { printf("0.0"); return 0; } // è¾¹ç•Œå¤„ç†
    
    a[1] = -1; b[1] = 0.5 * n; // åˆå§‹åŒ–
    
    for(int i = 2; i < n; i++) {
        double inv = 0.5 / i;
        double p = 1 - (1-i)*inv*a[i-1];
        a[i] = (-1-i)*inv / p;
        b[i] = (n*(n-1)*inv/(n-i) - (1-i)*inv*b[i-1]) / p;
    }
    
    f[n] = 0;
    for(int i = n-1; i >= 1; i--) 
        f[i] = b[i] - a[i] * f[i+1]; // é€†å‘å›ä»£
    
    for(int i = 0; i < 26; i++)
        if(cnt[i]) ans += 1.0 * cnt[i] / n * f[cnt[i]];
    
    printf("%.1lf", ans);
    return 0;
}
```

**ä»£ç è§£è¯»æ¦‚è¦**ï¼š  
1. ç»Ÿè®¡å­—ç¬¦é¢‘ç‡ `cnt[]`
2. åˆå§‹åŒ–é€’æ¨ç³»æ•° `a[1]`, `b[1]`
3. $O(n)$ é€’æ¨ç³»æ•°ï¼ˆæ ¸å¿ƒå¾ªç¯ï¼‰
4. é€†å‘å›ä»£æ±‚è§£ $f_i$
5. åŠ æƒå¹³å‡å¾—æœŸæœ›

---

## 5. ç®—æ³•å¯è§†åŒ–ï¼šåƒç´ åŠ¨ç”»æ¼”ç¤º

* **ä¸»é¢˜**ï¼š`åƒç´ é£æœŸæœ›ä¹‹æ—…`  
* **æ ¸å¿ƒæ¼”ç¤º**ï¼šçŠ¶æ€è½¬ç§»è¿‡ç¨‹çš„ç½‘æ ¼åŒ–å±•ç¤º
  - **8-bité£æ ¼è®¾è®¡**ï¼š
    - ä¹¦ç±ï¼š16x16åƒç´ æ–¹å—ï¼Œç›®æ ‡å±æ€§ä¹¦=ç»¿è‰²ï¼Œéç›®æ ‡=çº¢è‰²
    - çŠ¶æ€æ ï¼šæ˜¾ç¤ºå½“å‰ $i$ï¼ˆç›®æ ‡å±æ€§æ•°é‡ï¼‰å’Œ $f_i$
  - **æ“ä½œåŠ¨ç”»**ï¼š
    - é€‰ä¹¦ï¼šä¸¤ä¹¦é—ªçƒ + "å®"éŸ³æ•ˆ
    - å±æ€§è½¬æ¢ï¼šçº¢è‰²â†’ç»¿è‰²ï¼ˆä¸Šå‡éŸ³é˜¶ï¼‰æˆ–ç»¿è‰²â†’çº¢è‰²ï¼ˆä¸‹é™éŸ³é˜¶ï¼‰
  - **æ§åˆ¶é¢æ¿**ï¼š
    - æ­¥è¿›æ§åˆ¶ï¼šç©ºæ ¼å•æ­¥æ‰§è¡Œ
    - é€Ÿåº¦æ»‘å—ï¼šè°ƒæ•´è‡ªåŠ¨æ¼”ç¤ºé€Ÿåº¦
    - é‡ç½®æŒ‰é’®ï¼šå›åˆå§‹çŠ¶æ€

* **å…³é”®å¸§ç¤ºæ„**ï¼š
  ```plaintext
  åˆå§‹: [çº¢][çº¢][ç»¿][çº¢][ç»¿]  i=2, fâ‚‚=13.5
  æ“ä½œ: é€‰æ‹©çº¢(1)å’Œç»¿(3) â†’ çº¢å˜ç»¿
  æ–°æ€: [ç»¿][çº¢][ç»¿][çº¢][ç»¿]  i=3, fâ‚ƒ=10.4
  ```

* **æ¸¸æˆåŒ–è®¾è®¡**ï¼š
  - æˆå°±ç³»ç»Ÿï¼šæ¯å®Œæˆä¸€ä¸ªçŠ¶æ€è½¬ç§»ç‚¹äº®æ˜Ÿæ ‡
  - BGMï¼š8-bit èŠ¯ç‰‡éŸ³ä¹å¾ªç¯
  - éŸ³æ•ˆè®¾è®¡ï¼š
    - æ­£ç¡®è½¬ç§»ï¼šä¸Šå‡éŸ³é˜¶
    - æ— æ•ˆæ“ä½œï¼šä½éŸ³æç¤º
    - å®Œæˆï¼š16-bit èƒœåˆ©æ—‹å¾‹

---

## 6. æ‹“å±•ç»ƒä¹ ä¸ç›¸ä¼¼é—®é¢˜

**æŠ€å·§è¿ç§»åº”ç”¨**ï¼š
1. è®¾å¤‡æ•…éšœæ¢å¤ï¼ˆçŠ¶æ€è½¬ç§»æœŸæœ›ï¼‰
2. ç§ç¾¤æ‰©æ•£æ¨¡å‹ï¼ˆæ¦‚ç‡æœŸæœ›ï¼‰
3. ç½‘ç»œä¼ æ’­é¢„æœŸï¼ˆéšæœºè¿‡ç¨‹ï¼‰

**æ´›è°·æ¨è**ï¼š
1. **P1850 [NOIP2016] æ¢æ•™å®¤**  
   ğŸ—£ï¸ å¼ºåŒ–æœŸæœ›DPå»ºæ¨¡èƒ½åŠ›
2. **P1654 OSU!**  
   ğŸ—£ï¸ ç»ƒä¹ è¿ç»­å‹æœŸæœ›è®¡ç®—
3. **P4550 å½©ç¥¨**  
   ğŸ—£ï¸ æ·±å…¥æ¡ä»¶æœŸæœ›åº”ç”¨

---

## 7. å­¦ä¹ å¿ƒå¾—åˆ†äº«
> **å¯’é¸½å„¿é¢˜è§£å¯ç¤º**ï¼š  
> *"è°ƒè¯•æ—¶é‡ç‚¹éªŒè¯ $i=1$ å’Œ $i=2$ çš„è¾¹ç•Œç³»æ•°ï¼Œè¿™æ˜¯å…¨ç³»ç»Ÿç¨³å®šçš„åŸºçŸ³"*  
> ğŸ’¡ **æ´›è¯­äº‘ç¬ºç‚¹è¯„**ï¼šè¾¹ç•Œæ¡ä»¶å†³å®šç®—æ³•å¥å£®æ€§ï¼Œå»ºè®®ï¼š
> 1. å•ç‹¬æµ‹è¯• $n=1,2$ çš„è¾¹ç•Œæƒ…å†µ
> 2. ç”¨æ ·ä¾‹2ï¼ˆn=5ï¼‰ä½œä¸ºå•å…ƒæµ‹è¯•åŸºå‡†

---

> ç®—æ³•å­¦ä¹ çš„ç²¾é«“åœ¨äºï¼š  
> **ä»æš´åŠ›èµ°å‘ä¼˜é›…ï¼Œä»ç›´è§‰èµ°å‘ä¸¥è°¨ï¼Œ  
> åœ¨æ•°å­¦ä¸ä»£ç çš„äº¤ç•Œå¤„å¯»æ‰¾æœ€ä¼˜è§£**  
> å…±å‹‰ï¼â€”â€” æ´›è¯­äº‘ç¬º âœ¨

---
å¤„ç†ç”¨æ—¶ï¼š385.42ç§’
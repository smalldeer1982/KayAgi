# é¢˜ç›®ä¿¡æ¯

# [NOI Online #1 å…¥é—¨ç»„] é­”æ³•

## é¢˜ç›®æè¿°

C å›½ç”± $n$ åº§åŸå¸‚ä¸ $m$ æ¡æœ‰å‘é“è·¯ç»„æˆï¼ŒåŸå¸‚ä¸é“è·¯éƒ½ä» $1$ å¼€å§‹ç¼–å·ï¼Œç»è¿‡ $i$ å·é“è·¯éœ€è¦ $t_i$ çš„è´¹ç”¨ã€‚

ç°åœ¨ä½ è¦ä» $1$ å·åŸå¸‚å‡ºå‘å» $n$ å·åŸå¸‚ï¼Œä½ å¯ä»¥æ–½å±•æœ€å¤š $k$ æ¬¡é­”æ³•ï¼Œä½¿å¾—é€šè¿‡ä¸‹ä¸€æ¡é“è·¯æ—¶ï¼Œéœ€è¦çš„è´¹ç”¨å˜ä¸ºåŸæ¥çš„ç›¸åæ•°ï¼Œå³è´¹ç”¨ä» $t_i$ å˜ä¸º $-t_i$ã€‚è¯·ä½ ç®—ä¸€ç®—ï¼Œä½ è‡³å°‘è¦èŠ±è´¹å¤šå°‘è´¹ç”¨æ‰èƒ½å®Œæˆè¿™æ¬¡æ—…ç¨‹ã€‚

æ³¨æ„ï¼šä½¿ç”¨é­”æ³•åªæ˜¯æ”¹å˜ä¸€æ¬¡çš„èŠ±è´¹ï¼Œè€Œä¸æ”¹å˜ä¸€æ¡é“è·¯è‡ªèº«çš„ $t_i$ï¼›æœ€ç»ˆçš„è´¹ç”¨å¯ä»¥ä¸ºè´Ÿï¼Œå¹¶ä¸”ä¸€ä¸ªåŸå¸‚å¯ä»¥ç»è¿‡å¤šæ¬¡ï¼ˆåŒ…æ‹¬ $n$ å·åŸå¸‚ï¼‰ã€‚ 

## è¯´æ˜/æç¤º

#### è¾“å…¥è¾“å‡ºæ ·ä¾‹ 1 è§£é‡Š

ä¾æ¬¡ç»è¿‡ $1$ å·é“è·¯ã€$2$ å·é“è·¯ã€$3$ å·é“è·¯ï¼Œå¹¶åœ¨ç»è¿‡ $1,2$ å·é“è·¯å‰ä½¿ç”¨é­”æ³•ã€‚ 

#### è¾“å…¥è¾“å‡ºæ ·ä¾‹ 2 è§£é‡Š

ä¾æ¬¡ç»è¿‡ $1$ å·é“è·¯ã€$2$ å·é“è·¯ã€$1$ å·é“è·¯ï¼Œå¹¶åœ¨ä¸¤æ¬¡ç»è¿‡ $1$ å·é“è·¯å‰éƒ½ä½¿ç”¨é­”æ³•ã€‚ 

#### æ•°æ®è§„æ¨¡ä¸çº¦å®š

æœ¬é¢˜å…± $20$ ä¸ªæµ‹è¯•ç‚¹ï¼Œå„æµ‹è¯•ç‚¹ä¿¡æ¯è§ä¸‹è¡¨ã€‚

| æµ‹è¯•ç‚¹ç¼–å· | $n \leq$ | $m \leq$ | $k \leq$ | æ— ç¯ |
| :----------: | :--------: | :---------: | :--------: | :----: |
| $1 \sim 2$ | $5$ | $20$ | $0$ | ä¸ä¿è¯ |
| $3 \sim 4$ | $10$ | $20$ | $50$ | ä¸ä¿è¯ |
| $5 \sim 6$ | $10$ | $20$ | $0$| ä¸ä¿è¯ |
| $7 \sim 8$ | $20$ | $200$ | $50$ | æ˜¯ |
| $9 \sim 10$ | $20$ | $200$ | $0$ | ä¸ä¿è¯ |
| $11 \sim 12$ | $100$ | $200$ | $50$ | æ˜¯ |
| $13 \sim 14$ | $100$ | $200$ | $50$ | ä¸ä¿è¯ |
| $15 \sim 18$ | $100$ | $2500$ | $1000$ | ä¸ä¿è¯ |
| $19 \sim 20$ | $100$ | $2500$ | $10^6$ | ä¸ä¿è¯ |

å¯¹äºã€æ— ç¯ã€‘ä¸€æ ä¸ºâ€œæ˜¯â€çš„æµ‹è¯•ç‚¹ï¼Œä¿è¯ç»™å‡ºçš„å›¾æ˜¯ä¸€å¼ æœ‰å‘æ— ç¯å›¾ï¼Œå¦åˆ™ä¸å¯¹å›¾çš„å½¢æ€åšä»»ä½•ä¿è¯ã€‚

å¯¹äºå…¨éƒ¨çš„æµ‹è¯•ç‚¹ï¼Œä¿è¯ï¼š
- $1 \leq n \leq 100$ï¼Œ$1 \leq m \leq 2500$ï¼Œ$0 \leq k \leq 10^6$ã€‚
- $1 \leq u_i, v_i \leq n$ï¼Œ$1 \leq t_i \leq 10^9$ã€‚
- ç»™å‡ºçš„å›¾æ— é‡è¾¹å’Œè‡ªç¯ï¼Œä¸”è‡³å°‘å­˜åœ¨ä¸€æ¡èƒ½ä» $1$ åˆ°è¾¾ $n$ çš„è·¯å¾„ã€‚

**æ°‘é—´æ•°æ®ä½¿ç”¨ [CYaRon](https://github.com/luogu-dev/cyaron) åœ¨ 5 åˆ†é’Ÿå†…ç”Ÿæˆã€‚å¦‚æœå‘ç°æ•°æ®æœ‰é—®é¢˜ï¼Œè¯·åœ¨è®¨è®ºç‰ˆå‘å¸–æˆ–ç§ä¿¡ @[StudyingFather](/user/22030)**

## æ ·ä¾‹ #1

### è¾“å…¥

```
4 3 2
1 2 5
2 3 4
3 4 1
```

### è¾“å‡º

```
-8```

## æ ·ä¾‹ #2

### è¾“å…¥

```
2 2 2
1 2 10
2 1 1
```

### è¾“å‡º

```
-19```

# AIåˆ†æç»“æœ


# ğŸ’¡ æ´›è¯­äº‘ç¬ºçš„C++ç®—æ³•è§£æï¼šé­”æ³• æ·±å…¥å­¦ä¹ æŒ‡å— ğŸ’¡

> "é­”æ³•ä¸æ˜¯æ‰“ç ´è§„åˆ™ï¼Œè€Œæ˜¯å‘ç°è§„åˆ™é—´çš„å¥‡å¦™è¿æ¥ã€‚" â€”â€” æ´›è¯­äº‘ç¬º

## 1. é¢˜ç›®è§£è¯»ä¸ç­–ç•¥åˆæ¢

âœ¨ **æœ¬é¢˜æ ¸å¿ƒæŒ‘æˆ˜**ï¼šåœ¨å¸¦æƒæœ‰å‘å›¾ä¸­ï¼Œé€šè¿‡æœ€å¤škæ¬¡å°†**ä¸‹ä¸€æ¡è¾¹æƒå€¼å–å**çš„æ“ä½œï¼Œæ‰¾åˆ°ä»1å·ç‚¹åˆ°nå·ç‚¹çš„**æœ€å°ä»£ä»·è·¯å¾„**ã€‚æ ¸å¿ƒéš¾ç‚¹åœ¨äºé­”æ³•æ“ä½œçš„**é¡ºåºä¾èµ–æ€§**ï¼ˆä»…å½±å“ä¸‹ä¸€æ¡è¾¹ï¼‰å’Œ**è·¯å¾„å¯é‡å¤æ€§**ã€‚

âœ¨ **æ ¸å¿ƒç®—æ³•æ ‡ç­¾**ï¼š`åŠ¨æ€è§„åˆ’`ã€`çŸ©é˜µå¿«é€Ÿå¹‚`ã€`æœ€çŸ­è·¯`

ğŸ—£ï¸ **åˆæ­¥åˆ†æ**ï¼š
> è¿™é“é¢˜çœ‹ä¼¼æ˜¯å¸¦æ“ä½œçš„æœ€çŸ­è·¯é—®é¢˜ï¼Œå®åˆ™æ˜¯**åŠ¨æ€è§„åˆ’ä¸å›¾è®ºçš„ç¾å¦™èåˆ**ã€‚å°±åƒåœ¨è¿·å®«ä¸­å¯»æ‰¾éšè—çš„ä¼ é€é—¨ï¼Œæˆ‘ä»¬éœ€è¦å‘ç°"é­”æ³•ä½¿ç”¨"ä¸"è·¯å¾„é€‰æ‹©"ä¹‹é—´çš„æ·±å±‚è”ç³»ã€‚
>
> **æ€è€ƒæ¼”è¿›è·¯å¾„**ï¼š
> 1. **æš´åŠ›æœç´¢**ï¼šæšä¸¾é­”æ³•ä½¿ç”¨ä½ç½®ï¼Œä½†kå’Œnè¾ƒå¤§æ—¶æŒ‡æ•°çº§çˆ†ç‚¸ï¼ˆO(2^M)ï¼‰â†’ **ä¸å¯è¡Œ**
> 2. **åˆ†å±‚å›¾æœ€çŸ­è·¯**ï¼šå°†"ä½¿ç”¨é­”æ³•æ¬¡æ•°"ä½œä¸ºæ–°ç»´åº¦ï¼Œä½†kâ‰¤10^6å¯¼è‡´çŠ¶æ€çˆ†ç‚¸ â†’ **ä¸å¯è¡Œ**
> 3. **çŸ©é˜µå¿«é€Ÿå¹‚ä¼˜åŒ–**ï¼šå°†"ä½¿ç”¨é­”æ³•"è½¬åŒ–ä¸ºçŸ©é˜µè¿ç®—ï¼Œç”¨åŠ¨æ€è§„åˆ’æ€æƒ³+å¿«é€Ÿå¹‚åŠ é€Ÿ â†’ **æœ€ä¼˜è§£**
>
> **é­”æ³•ä¸çŸ©é˜µçš„æ¯”å–»**ï¼šæƒ³è±¡æ¯ä¸ªé­”æ³•æ˜¯æ”¹å˜è·¯å¾„èƒ½é‡çš„"ç¬¦æ–‡"ï¼ŒçŸ©é˜µåˆ™æ˜¯è®°å½•ç¬¦æ–‡ç»„åˆæ•ˆæœçš„"é­”æ³•å·è½´"ã€‚é€šè¿‡å·è½´çš„å åŠ (kæ¬¡æ–¹)ï¼Œæˆ‘ä»¬å¾—åˆ°æœ€ç»ˆé­”æ³•æ•ˆæœï¼

### ğŸ” ç®—æ³•ä¾¦æ¢ï¼šå¦‚ä½•åœ¨é¢˜ç›®ä¸­å‘ç°çº¿ç´¢ï¼Ÿ
1.  **çº¿ç´¢1 (é—®é¢˜ç›®æ ‡)**ï¼š"ä¸è¶…è¿‡kæ¬¡é­”æ³•ä¸‹æ±‚æœ€å°èŠ±è´¹" â†’ **å¸¦é™åˆ¶çš„æœ€ä¼˜åŒ–é—®é¢˜**ï¼ŒæŒ‡å‘DPæˆ–å¸¦çŠ¶æ€æœ€çŸ­è·¯
2.  **çº¿ç´¢2 (æ“ä½œç‰¹æ€§)**ï¼š"é­”æ³•ä»…å½±å“ä¸‹ä¸€æ¡è¾¹" â†’ **æ“ä½œæœ‰å±€éƒ¨æ€§**ï¼Œå¯æŠ½è±¡ä¸ºç‹¬ç«‹æ“ä½œå•å…ƒ
3.  **çº¿ç´¢3 (æ•°æ®èŒƒå›´)**ï¼šnâ‰¤100ä½†kâ‰¤10^6 â†’ **éœ€O(log k)å¤æ‚åº¦**ï¼ŒæŒ‡å‘å¿«é€Ÿå¹‚ç±»ç®—æ³•

### ğŸ§  æ€ç»´é“¾æ„å»ºï¼šä»çº¿ç´¢åˆ°ç­–ç•¥
> æ”¶é›†çº¿ç´¢åï¼Œåƒæ‹¼å›¾ä¸€æ ·ç»„åˆï¼š
> 1. çº¿ç´¢1ï¼ˆæœ€ä¼˜åŒ–ï¼‰æç¤ºå¯ç”¨åŠ¨æ€è§„åˆ’ï¼Œä½†kå¤ªå¤§éœ€ä¼˜åŒ–çŠ¶æ€è½¬ç§»
> 2. çº¿ç´¢2ï¼ˆæ“ä½œå±€éƒ¨æ€§ï¼‰è¯´æ˜æ¯æ¬¡é­”æ³•ç‹¬ç«‹ï¼Œå¯è§†ä¸º"åŸå­æ“ä½œ"
> 3. çº¿ç´¢3ï¼ˆkæå¤§ï¼‰è¦æ±‚O(log k)è§£ â†’ å°†æ“ä½œæŠ½è±¡ä¸ºçŸ©é˜µï¼Œç”¨å¿«é€Ÿå¹‚åŠ é€Ÿï¼
>
> **ç»“è®º**ï¼šå°†"ä½¿ç”¨ä¸€æ¬¡é­”æ³•"å®šä¹‰ä¸ºçŸ©é˜µAï¼Œåˆ™ä½¿ç”¨kæ¬¡é­”æ³•ç­‰ä»·äºA^kã€‚é€šè¿‡çŸ©é˜µå¿«é€Ÿå¹‚ï¼Œåœ¨O(nÂ³log k)å†…è§£å†³ï¼

---

## 2. ç²¾é€‰ä¼˜è´¨é¢˜è§£å‚è€ƒ

**é¢˜è§£ä¸€ï¼ˆä½œè€…ï¼šStudyingFatherï¼‰**
* **ç‚¹è¯„**ï¼šæ€è·¯æ¸…æ™°æŠ“ä½é—®é¢˜æœ¬è´¨ï¼Œç”¨çŸ©é˜µä¹˜æ³•æŠ½è±¡é­”æ³•æ“ä½œæå…·æ´å¯ŸåŠ›ã€‚ä»£ç ç®€æ´é«˜æ•ˆï¼ˆ<60è¡Œï¼‰ï¼Œå…³é”®å˜é‡å`a.e[i][j]`å«ä¹‰æ˜ç¡®ï¼ŒçŠ¶æ€è½¬ç§»æ¨å¯¼ä¸¥è°¨ï¼Œå®Œç¾å±•ç°"é—®é¢˜è½¬åŒ–"æ€æƒ³ã€‚

**é¢˜è§£äºŒï¼ˆä½œè€…ï¼šgaozitao1ï¼‰**
* **ç‚¹è¯„**ï¼šè¯¦è§£ä»æš´åŠ›åˆ°æ»¡åˆ†çš„æ€è€ƒè¿‡ç¨‹ï¼Œæ•™å­¦æ€§å¼ºã€‚åˆ†å±‚æ„å»ºè§£æ³•ï¼ˆ30/50/70/100åˆ†ï¼‰ï¼Œå¸®åŠ©ç†è§£ä¼˜åŒ–å¿…è¦æ€§ã€‚çŸ©é˜µå¿«é€Ÿå¹‚å®ç°è§„èŒƒï¼ŒFloydé¢„å¤„ç†ä¸çŠ¶æ€è½¬ç§»ç»“åˆç´§å¯†ã€‚

**é¢˜è§£ä¸‰ï¼ˆä½œè€…ï¼šwsyhbï¼‰**
* **ç‚¹è¯„**ï¼šåˆ›æ–°æ€§åœ°å°†åˆå§‹è·¯å¾„ä¸é­”æ³•è·¯å¾„åˆ†ç¦»ï¼Œä¼˜åŒ–åˆå§‹åŒ–è‡³O(nm)ã€‚çŸ©é˜µä¹˜æ³•å®šä¹‰ç²¾å‡†ï¼Œä»£ç æ¨¡å—åŒ–ï¼ˆ`operator*`é‡è½½ï¼‰ï¼Œæ—¶ç©ºæ•ˆç‡ä¿±ä½³ã€‚

---

## 3. è§£é¢˜ç­–ç•¥æ·±åº¦å‰–æ

### ğŸ¯ æ ¸å¿ƒéš¾ç‚¹ä¸å…³é”®æ­¥éª¤
1.  **éš¾ç‚¹1ï¼šå¦‚ä½•å»ºæ¨¡é­”æ³•æ“ä½œï¼Ÿ**
    * **åˆ†æ**ï¼šå°†é­”æ³•æ“ä½œè½¬åŒ–ä¸ºçŸ©é˜µå…ƒç´ ã€‚å®šä¹‰çŸ©é˜µAï¼Œå…¶ä¸­A[i][j]è¡¨ç¤ºiâ†’jä½¿ç”¨**è‡³å¤šä¸€æ¬¡é­”æ³•**çš„æœ€å°ä»£ä»·ï¼š
        ```python
        A[i][j] = min( Floyd[i][j], 
                      min_{(u,v)âˆˆE}(Floyd[i][u] - w_uv + Floyd[v][j]) )
        ```
    * ğŸ’¡ **å­¦ä¹ ç¬”è®°**ï¼šå¤æ‚æ“ä½œå¯æ‹†è§£ä¸º"åŸºç¡€æ“ä½œ+ç‰¹æ•ˆ"çš„ç»„åˆ

2.  **éš¾ç‚¹2ï¼šå¦‚ä½•é«˜æ•ˆç»„åˆkæ¬¡æ“ä½œï¼Ÿ**
    * **åˆ†æ**ï¼šå®šä¹‰çŸ©é˜µä¹˜æ³•`C = AâŠ—B`ï¼š
        ```python
        C[i][j] = min_{1â‰¤kâ‰¤n}(A[i][k] + B[k][j])
        ```
        åˆ™A^kè¡¨ç¤ºä½¿ç”¨**è‡³å¤škæ¬¡é­”æ³•**çš„ä»£ä»·ã€‚é€šè¿‡å¿«é€Ÿå¹‚å°†O(k)ä¼˜åŒ–è‡³O(log k)
    * ğŸ’¡ **å­¦ä¹ ç¬”è®°**ï¼šé‡å®šä¹‰è¿ç®—ç¬¦åˆç»“åˆå¾‹æ˜¯å¿«é€Ÿå¹‚åº”ç”¨çš„æ ¸å¿ƒå‰æ

3.  **éš¾ç‚¹3ï¼šå¦‚ä½•å¤„ç†è·¯å¾„å¤ç”¨ï¼Ÿ**
    * **åˆ†æ**ï¼šFloydé¢„å¤„ç†åŒ…å«æ‰€æœ‰è·¯å¾„ç»„åˆï¼ŒçŸ©é˜µè¿ç®—è‡ªåŠ¨å¤„ç†å¤ç”¨
    * ğŸ’¡ **å­¦ä¹ ç¬”è®°**ï¼šåŠ¨æ€è§„åˆ’é€šè¿‡çŠ¶æ€è½¬ç§»è‡ªç„¶å¤„ç†é‡å¤å­é—®é¢˜

### âœ¨ è§£é¢˜æŠ€å·§æ€»ç»“
- **æŠ€å·§1ï¼ˆé—®é¢˜è½¬åŒ–ï¼‰**ï¼šå°†"é­”æ³•ä½¿ç”¨"è½¬åŒ–ä¸ºå¯å åŠ çš„çŸ©é˜µè¿ç®—
- **æŠ€å·§2ï¼ˆåˆ†å±‚å¤„ç†ï¼‰**ï¼šç”¨Floydå¤„ç†æ— é­”æ³•è·¯å¾„ï¼Œå†å åŠ é­”æ³•æ•ˆæœ
- **æŠ€å·§3ï¼ˆç»´åº¦å‹ç¼©ï¼‰**ï¼šé€šè¿‡çŸ©é˜µè¿ç®—é¿å…æ˜¾å¼å­˜å‚¨kç»´åº¦

### âš”ï¸ ç­–ç•¥ç«æŠ€åœºï¼šä¸åŒè§£æ³•å¯¹æ¯”
| ç­–ç•¥             | æ ¸å¿ƒæ€æƒ³                     | ä¼˜ç‚¹                     | ç¼ºç‚¹                                   | å¾—åˆ†é¢„æœŸ       |
| :--------------- | :--------------------------- | :----------------------- | :------------------------------------- | :------------- |
| **æš´åŠ›æœç´¢**     | æšä¸¾é­”æ³•ä½¿ç”¨ä½ç½®             | ç›´è§‚æ˜“æ‡‚                 | O(2^M) è¶…æ—¶                            | 10%-30% (Mâ‰¤20) |
| **åˆ†å±‚å›¾æœ€çŸ­è·¯** | å°†é­”æ³•æ¬¡æ•°ä½œä¸ºæ–°ç»´åº¦          | ç›´æ¥å¤„ç†æ“ä½œé™åˆ¶         | O(knÂ²) ç©ºé—´æ—¶é—´åŒçˆ†ç‚¸                   | 50% (kå°)      |
| **çŸ©é˜µå¿«é€Ÿå¹‚**   | é­”æ³•æ“ä½œä¸ºçŸ©é˜µï¼Œå¿«é€Ÿå¹‚åŠ é€Ÿ    | O(nÂ³log k) é«˜æ•ˆå¤„ç†å¤§k   | æ€ç»´éš¾åº¦é«˜ï¼Œéœ€æ•°å­¦æŠ½è±¡                  | 100%           |

### âœ¨ ä¼˜åŒ–ä¹‹æ—…ï¼šä»"èƒ½åš"åˆ°"åšå¥½"
> 1. **èµ·ç‚¹ï¼šæš´åŠ›æœç´¢çš„å›°å¢ƒ**  
>    æšä¸¾é­”æ³•ä½ç½®å¦‚åŒåœ¨é»‘æš—ä¸­æ‘¸ç´¢ï¼Œè·¯å¾„æ•°éškæŒ‡æ•°å¢é•¿ â†’ **O(2^M)ä¸å¯è¡Œ**
> 
> 2. **å‘ç°ç“¶é¢ˆï¼šæ“ä½œç‹¬ç«‹æ€§**  
>    æ¯æ¬¡é­”æ³•æ•ˆæœç‹¬ç«‹ï¼Œä½†æš´åŠ›æšä¸¾å¿½ç•¥æ­¤ç‰¹æ€§ â†’ **å­˜åœ¨é‡å¤è®¡ç®—**
> 
> 3. **é’¥åŒ™ï¼šçŸ©é˜µé­”æ³•**  
>    å°†å•æ¬¡é­”æ³•æŠ½è±¡ä¸ºçŸ©é˜µAï¼Œkæ¬¡æ“ä½œå³ä¸ºA^k â†’ **è½¬åŒ–é—®é¢˜æœ¬è´¨**
> 
> 4. **å‡åï¼šå¿«é€Ÿå¹‚åŠ é€Ÿ**  
>    åˆ©ç”¨çŸ©é˜µä¹˜æ³•ç»“åˆå¾‹ï¼ŒäºŒåˆ†å¹‚æ¬¡ â†’ **O(log k)é£è·ƒ**
> 
> ğŸ’¡ **ç­–ç•¥æ€»ç»“**ï¼šä»æš´åŠ›æšä¸¾åˆ°çŸ©é˜µå¿«é€Ÿå¹‚ï¼Œå…³é”®åœ¨äºå‘ç°"æ“ä½œç‹¬ç«‹æ€§"ä¸"è¿ç®—ç»“åˆå¾‹"è¿™ä¸¤ä¸ªéšè—å±æ€§ï¼Œå¦‚åŒé­”æ³•å¸ˆå‘ç°ç¬¦æ–‡é—´çš„èƒ½é‡å…±é¸£è§„å¾‹ï¼

---

## 4. C++æ ¸å¿ƒä»£ç å®ç°èµæ

**æœ¬é¢˜é€šç”¨æ ¸å¿ƒå®ç°**
```cpp
#include <cstring>
#include <iostream>
using namespace std;
typedef long long LL;
const int N = 105;
const LL INF = 1e18;

struct Matrix {
    LL a[N][N];
    Matrix operator*(const Matrix &b) const {
        Matrix res;
        memset(res.a, 0x3f, sizeof res.a);
        for (int k = 0; k < N; k++)
        for (int i = 0; i < N; i++)
        for (int j = 0; j < N; j++)
            res.a[i][j] = min(res.a[i][j], a[i][k] + b.a[k][j]);
        return res;
    }
    Matrix pow(int k) {
        Matrix base = *this, res;
        memset(res.a, 0x3f, sizeof res.a);
        for (int i = 0; i < N; i++) res.a[i][i] = 0; // å•ä½çŸ©é˜µ
        while (k) {
            if (k & 1) res = res * base;
            base = base * base;
            k >>= 1;
        }
        return res;
    }
};

int main() {
    int n, m, k;
    LL g[N][N]; // FloydçŸ©é˜µ
    // è¾“å…¥åˆå§‹åŒ–+Floydé¢„å¤„ç†
    Matrix A;   // é­”æ³•æ“ä½œçŸ©é˜µ
    // æ„å»ºA: A[i][j] = min(g[i][j], min_{(u,v)}(g[i][u]-w+g[v][j]))
    Matrix ans = A.pow(k);
    cout << ans.a[0][n-1]; // è¾“å‡º1â†’nç»“æœ
}
```

**é¢˜è§£ä¸€æ ¸å¿ƒç‰‡æ®µï¼ˆStudyingFatherï¼‰**
```cpp
Matrix operator*(const Matrix &x, const Matrix &y) {
    Matrix z;
    for(int i=0; i<n; i++)
    for(int j=0; j<n; j++) {
        z[i][j] = INF;
        for(int k=0; k<n; k++)
            z[i][j] = min(z[i][j], x[i][k] + y[k][j]);
    }
    return z;
}
```
* **äº®ç‚¹**ï¼šè¿ç®—ç¬¦é‡è½½ä½¿çŸ©é˜µä¹˜æ³•è‡ªç„¶è¡¨è¾¾
* **å­¦ä¹ ç¬”è®°**ï¼šC++è¿ç®—ç¬¦é‡è½½èƒ½ä½¿æ•°å­¦æŠ½è±¡æ›´ç›´è§‚

**é¢˜è§£äºŒæ ¸å¿ƒç‰‡æ®µï¼ˆgaozitao1ï¼‰**
```cpp
for(l=1; l<=m; l++) // æšä¸¾æ¯æ¡è¾¹
for(i=1; i<=n; i++)
for(j=1; j<=n; j++)
    A[i][j] = min(A[i][j], g[i][u[l]] - w[l] + g[v[l]][j]);
```
* **äº®ç‚¹**ï¼šä¸‰é‡å¾ªç¯æ¸…æ™°å¤„ç†é­”æ³•è¾¹çš„å½±å“
* **å­¦ä¹ ç¬”è®°**ï¼šé¢„å¤„ç†æ—¶æšä¸¾è¾¹è€Œéç‚¹ï¼Œå¤æ‚åº¦O(mnÂ²)å¯æ§

---

## 5. ç®—æ³•å¯è§†åŒ–ï¼šåƒç´ åŠ¨ç”»æ¼”ç¤º

### ğŸ® è®¾è®¡æ¦‚å¿µï¼š**"ç¬¦æ–‡ä¹‹è·¯"ï¼ˆRune Pathï¼‰**
> **8-bitåƒç´ é£æ ¼**ï¼šåŸå¸‚ä¸ºåƒç´ åŸå ¡ï¼Œé“è·¯ä¸ºå‘å…‰è·¯å¾„ï¼Œé­”æ³•ç¬¦æ–‡æ‚¬æµ®ç©ºä¸­

### ğŸï¸ åŠ¨ç”»æµç¨‹ï¼š
1. **åœºæ™¯åˆå§‹åŒ–**  
   - åƒç´ ç½‘æ ¼åœ°å›¾ï¼ˆ100Ã—100ï¼‰ï¼Œ1å·åŸå ¡ï¼ˆç»¿è‰²ï¼‰ï¼Œnå·åŸå ¡ï¼ˆçº¢è‰²ï¼‰
   - æ§åˆ¶é¢æ¿ï¼šæ­¥è¿›/æ’­æ”¾/é€Ÿåº¦æ»‘å—ï¼ˆå¤å¤æ¸¸æˆæŒ‰é’®é£æ ¼ï¼‰

2. **Floydé¢„å¤„ç†ï¼ˆæ— é­”æ³•ï¼‰**  
   - å¯è§†åŒ–ï¼šä¸‰é‡å¾ªç¯ä¸­ï¼Œ**é»„è‰²åƒç´ å—**æ ‡è®°å½“å‰ä¸­ä»‹ç‚¹kï¼Œ**è“è‰²ç®­å¤´**æ‰«æiâ†’jè·¯å¾„
   - éŸ³æ•ˆï¼šè·¯å¾„æ›´æ–°æ—¶"å®"å£°ï¼Œå®Œæˆæ—¶8-bitèƒœåˆ©æ—‹å¾‹

3. **çŸ©é˜µAæ„å»ºï¼ˆå•æ¬¡é­”æ³•ï¼‰**  
   - æ¯æ¡é­”æ³•è¾¹æ˜¾ç¤ºä¸º**ç´«è‰²ç¬¦æ–‡**ï¼Œå½“ç¬¦æ–‡æ¿€æ´»æ—¶ï¼š
     * è·¯å¾„iâ†’uæ˜¾ç¤ºä¸º**è“è‰²æµå…‰**
     * è¾¹(u,v)å˜ä¸º**é‡‘è‰²é—ªçƒ**ï¼ˆé­”æ³•ç”Ÿæ•ˆï¼‰
     * è·¯å¾„vâ†’jæ˜¾ç¤ºä¸º**çº¢è‰²æµå…‰**
   - éŸ³æ•ˆï¼šç¬¦æ–‡æ¿€æ´»æ—¶"å—¡"å£°ï¼Œè·¯å¾„æ›´æ–°æ—¶"é”µ"å£°

4. **çŸ©é˜µå¿«é€Ÿå¹‚ï¼ˆç¬¦æ–‡å åŠ ï¼‰**  
   - çŸ©é˜µè§†ä¸º**é­”æ³•å·è½´**ï¼Œå¿«é€Ÿå¹‚æ­¥éª¤ï¼š
     * **å¥‡æ¬¡å¹‚**ï¼šå·è½´å·¦ä¾§ç¬¦æ–‡äº®èµ·ï¼Œä¸å½“å‰å·è½´åˆå¹¶
     * **å¹³æ–¹**ï¼šå·è½´è‡ªæˆ‘å¤åˆ¶ï¼Œç¬¦æ–‡äº¤ç»‡å‘å…‰
   - éŸ³æ•ˆï¼šçŸ©é˜µä¹˜æ³•æ—¶å¿«é€Ÿ"å˜€å˜€"å£°ï¼Œå®Œæˆæ—¶å®äº®é’Ÿå£°

### ğŸ•¹ï¸ äº¤äº’è®¾è®¡ï¼š
- **æ­¥è¿›æ¨¡å¼**ï¼šæŒ‰æ­¥è§‚å¯ŸFloydå’ŒçŸ©é˜µè¿ç®—
- **è‡ªåŠ¨æ¼”ç¤º**ï¼šåƒè§‚çœ‹AIç©è§£è°œæ¸¸æˆï¼Œè‡ªåŠ¨å±•ç¤ºæœ€ä¼˜è·¯å¾„
- **ç¬¦æ–‡æ”¶é›†**ï¼šæ¯æ­£ç¡®ç†è§£ä¸€æ­¥ï¼Œè·å¾—ç¬¦æ–‡å¥–åŠ±ï¼ˆæ¸¸æˆåŒ–æ¿€åŠ±ï¼‰

> "é€šè¿‡åƒç´ åŠ¨ç”»ï¼ŒæŠ½è±¡ç®—æ³•åŒ–ä¸ºå¯è§çš„é­”æ³•ä»ªå¼ï¼" â€”â€” æ´›è¯­äº‘ç¬º

---

## 6. æ‹“å±•ç»ƒä¹ ä¸ç›¸ä¼¼é—®é¢˜æ€è€ƒ

### ğŸ”— æ€ç»´è¿ç§»ï¼š
1. **è¯¾ç¨‹é€‰æ‹©é—®é¢˜**ï¼šåˆ†ç»„èƒŒåŒ…æ¨¡å‹ï¼ˆè¯¾ç¨‹ç»„åˆä¸º"ç»„"ï¼‰
2. **äº¤é€šè°ƒåº¦**ï¼šå¸¦æ—¶é—´çª—çš„æœ€çŸ­è·¯ï¼ˆå¢åŠ æ—¶é—´ç»´åº¦ï¼‰
3. **ç½‘ç»œä¼ è¾“**ï¼šå¸¦çº¦æŸçš„æœ€å¤§æµï¼ˆç±»ä¼¼"é­”æ³•æ¬¡æ•°"é™åˆ¶ï¼‰

### ğŸ“š æ¨èç»ƒä¹ ï¼ˆæ´›è°·ï¼‰ï¼š
1. **P1613 è·‘è·¯**  
   â†’ ç»ƒä¹ å€å¢+Floydçš„æ€ç»´æ¨¡å¼
2. **P2886 [USACO07NOV] Cow Relays G**  
   â†’ å¼ºåŒ–çŸ©é˜µå¿«é€Ÿå¹‚æ±‚æœ€çŸ­è·¯
3. **P1938 [USACO09NOV] Job Hunt S**  
   â†’ å¤„ç†å¸¦è´Ÿæƒçš„æœ€çŸ­è·¯

---

## 7. å­¦ä¹ å¿ƒå¾—ä¸ç»éªŒåˆ†äº«

> **æ¥è‡ªé¢˜è§£ä½œè€…çš„æ™ºæ…§**ï¼š
> - "Floydé¢„å¤„ç†æ˜¯åœ°åŸºï¼ŒçŸ©é˜µå¿«é€Ÿå¹‚æ˜¯é«˜æ¥¼"ï¼ˆgaozitao1ï¼‰
> - "æŠŠé­”æ³•æ“ä½œè§†ä¸ºåŸå­å•ä½ï¼Œæ˜¯çªç ´ké™åˆ¶çš„å…³é”®"ï¼ˆStudyingFatherï¼‰
> 
> **æ´›è¯­äº‘ç¬ºçš„æ€»ç»“**ï¼š
> è°ƒè¯•æ—¶é‡ç‚¹æ£€æŸ¥ï¼š
> 1. Floydçš„INFå–å€¼ï¼ˆé¿å…æº¢å‡ºï¼‰
> 2. çŸ©é˜µä¹˜æ³•ä¸‰é‡å¾ªç¯é¡ºåºï¼ˆkåœ¨æœ€å†…å±‚ï¼‰
> 3. å•ä½çŸ©é˜µåˆå§‹åŒ–ï¼ˆå¯¹è§’çº¿0å…¶ä½™INFï¼‰

---

> "ç®—æ³•ä¸æ˜¯å†°å†·çš„è§„åˆ™ï¼Œè€Œæ˜¯è§£å†³é—®é¢˜çš„è‰ºæœ¯ã€‚æŒæ¡å®ƒï¼Œä½ ä¾¿æŒæ¡äº†ç¼–ç¨‹ä¸–ç•Œçš„é­”æ³•ã€‚" â€”â€” æ´›è¯­äº‘ç¬º  
> æœ¬æ¬¡è§£æå°±åˆ°è¿™é‡Œï¼Œä¸‹æ¬¡é­”æ³•ä¹‹æ—…å†è§ï¼âœ¨

---
å¤„ç†ç”¨æ—¶ï¼š338.82ç§’
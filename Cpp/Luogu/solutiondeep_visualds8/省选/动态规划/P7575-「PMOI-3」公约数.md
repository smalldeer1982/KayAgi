# é¢˜ç›®ä¿¡æ¯

# ã€ŒPMOI-3ã€å…¬çº¦æ•°

## é¢˜ç›®æè¿°

ç»™å‡º $n,m$ å’Œä¸€ä¸ªé•¿åº¦ä¸º $n-1$ çš„åºåˆ— $x$ï¼Œä¿è¯ $x_i$ äº’ä¸ç›¸åŒã€‚

æ±‚
$$
\sum_{i_1=1}^m\sum_{i_2=1}^m\cdots\sum_{i_n=1}^m[\gcd(i_1,i_2)=x_1][\gcd(i_2,i_3)=x_2]\cdots[\gcd(i_{n-1},i_n)=x_{n-1}]$$

ç­”æ¡ˆå¯¹ $998244353$ å–æ¨¡ã€‚

## è¯´æ˜/æç¤º

ã€æ ·ä¾‹è§£é‡Šã€‘

å¯¹äºç¬¬ä¸€ç»„æ ·ä¾‹ï¼Œåªæœ‰å½“ $i_1=1,i_2=2,i_3=2$ æ—¶æ‰æ»¡è¶³è¦æ±‚ã€‚

ã€æ•°æ®èŒƒå›´ã€‘

**æœ¬é¢˜é‡‡ç”¨æ†ç»‘æµ‹è¯•ã€‚**

- Subtask1ï¼ˆ10ptsï¼‰ï¼š$n,m\le 5$ï¼›
- Subtask2ï¼ˆ15ptsï¼‰ï¼š$n,m\le500$ï¼›
- Subtask3ï¼ˆ15ptsï¼‰ï¼š$n,m\le 5\times 10^3$ï¼›
- Subtask4ï¼ˆ15ptsï¼‰ï¼š$n,m\le 5\times 10^4$ã€‚
- Subtask5ï¼ˆ20ptsï¼‰ï¼š$n,m\le 3\times 10^5$ã€‚
- Subtask6ï¼ˆ25ptsï¼‰ï¼šæ— ç‰¹æ®Šé™åˆ¶ã€‚

å¯¹äº $100\%$ çš„æ•°æ®æ»¡è¶³ï¼Œ$n-1\le m$ï¼Œ$1\le n,m\le 10^6$ï¼Œ$1\le x_i\le m$ï¼Œä¿è¯ $x_i$ äº’ä¸ç›¸åŒã€‚

## æ ·ä¾‹ #1

### è¾“å…¥

```
3 2
1 2```

### è¾“å‡º

```
1```

## æ ·ä¾‹ #2

### è¾“å…¥

```
5 20
1 2 4 6```

### è¾“å‡º

```
312```

## æ ·ä¾‹ #3

### è¾“å…¥

```
5 20
2 3 1 4```

### è¾“å‡º

```
592```

## æ ·ä¾‹ #4

### è¾“å…¥

```
10 1000
1 2 4 8 16 32 64 128 256 ```

### è¾“å‡º

```
207388829```

# AIåˆ†æç»“æœ


# ğŸ’¡ æ´›è¯­äº‘ç¬ºçš„C++ç®—æ³•è§£æï¼šã€ŒPMOI-3ã€å…¬çº¦æ•° æ·±å…¥å­¦ä¹ æŒ‡å— ğŸ’¡

## 1. é¢˜ç›®è§£è¯»ä¸ç­–ç•¥åˆæ¢

âœ¨ **æœ¬é¢˜æ ¸å¿ƒæŒ‘æˆ˜**ï¼šåœ¨ $n$ ä¸ªå…ƒç´ çš„åºåˆ—çº¦æŸä¸‹ï¼Œé«˜æ•ˆè®¡ç®—æ»¡è¶³ç›¸é‚»å…ƒç´ é—´ç‰¹å®šæœ€å¤§å…¬çº¦æ•°æ¡ä»¶çš„æ‰€æœ‰åºåˆ—æ•°é‡ã€‚  
âœ¨ **æ ¸å¿ƒç®—æ³•æ ‡ç­¾**ï¼šåŠ¨æ€è§„åˆ’ã€è«æ¯”ä¹Œæ–¯åæ¼”ã€ç‹„åˆ©å…‹é›·å‰ç¼€/åç¼€å’Œ

ğŸ—£ï¸ **åˆæ­¥åˆ†æ**ï¼š  
> æœ¬é¢˜è¦æ±‚è®¡ç®—æ»¡è¶³å¤æ‚çº¦æŸæ¡ä»¶çš„åºåˆ—æ•°é‡ã€‚ç›¸é‚»å…ƒç´ é—´å­˜åœ¨ç‰¹å®šGCDçº¦æŸï¼ˆ$x_i$ äº’ä¸ç›¸åŒï¼‰ï¼Œæš´åŠ›æšä¸¾ï¼ˆ$O(m^n)$ï¼‰å®Œå…¨ä¸å¯è¡Œã€‚é€šè¿‡åŠ¨æ€è§„åˆ’å®šä¹‰çŠ¶æ€ $f_{i,j}$ è¡¨ç¤ºä»¥ $j$ ç»“å°¾çš„é•¿åº¦ $i$ çš„åºåˆ—æ–¹æ¡ˆæ•°ï¼Œå¹¶åˆ©ç”¨è«æ¯”ä¹Œæ–¯åæ¼”è½¬åŒ–GCDçº¦æŸä¸ºå¯ä¼˜åŒ–å½¢å¼ã€‚æœ€ç»ˆé€šè¿‡ç‹„åˆ©å…‹é›·å‰/åç¼€å’Œå°†å¤æ‚åº¦ä¼˜åŒ–åˆ° $O(m\log m\log\log m)$ï¼Œå¦‚åŒç”¨ç²¾å¯†é½¿è½®ç»„æ›¿ä»£æ‰‹å·¥è®¡ç®—ã€‚

### ğŸ” ç®—æ³•ä¾¦æ¢ï¼šå¦‚ä½•åœ¨é¢˜ç›®ä¸­å‘ç°çº¿ç´¢ï¼Ÿ
1.  **çº¿ç´¢1 (é—®é¢˜ç›®æ ‡)**: "é¢˜ç›®è¦æ±‚è®¡ç®—æ»¡è¶³ç›¸é‚»å…ƒç´ GCDçº¦æŸçš„åºåˆ—æ€»æ•°ï¼Œè¿™æ˜¯å…¸å‹çš„**ç»„åˆè®¡æ•°é—®é¢˜**ï¼Œæš—ç¤ºéœ€è¦é«˜æ•ˆæšä¸¾æŠ€å·§ã€‚"
2.  **çº¿ç´¢2 (é—®é¢˜çº¦æŸ/ç‰¹æ€§)**: "ç›¸é‚»å…ƒç´ é—´å­˜åœ¨ç‰¹å®šGCDçº¦æŸä¸” $x_i$ äº’ä¸ç›¸åŒï¼Œè¿™ç§**å› å­å…³ç³»çº¦æŸ**å¼ºçƒˆæŒ‡å‘æ•°è®ºä¼˜åŒ–ï¼ˆè«æ¯”ä¹Œæ–¯åæ¼”ï¼‰å’ŒDPçŠ¶æ€ä¼˜åŒ–ã€‚"
3.  **çº¿ç´¢3 (æ•°æ®è§„æ¨¡)**: "$n, m \leq 10^6$ ç›´æ¥å¦å†³äº† $O(nm^2)$ ä»¥ä¸Šå¤æ‚åº¦çš„è§£æ³•ï¼Œå¿…é¡»æ‰¾åˆ° $O(m \text{ poly}\log m)$ çš„ç®—æ³•ï¼Œç‹„åˆ©å…‹é›·å’Œæˆä¸ºå…³é”®ã€‚"

### ğŸ§  æ€ç»´é“¾æ„å»ºï¼šä»çº¿ç´¢åˆ°ç­–ç•¥
> "ä¾¦æ¢å·¥ä½œå®Œæˆï¼Œçº¿ç´¢å·²æ˜ç¡®ï¼š
> 1. **çº¿ç´¢1**è¦æ±‚é«˜æ•ˆè®¡æ•°ï¼ŒDPæ˜¯è‡ªç„¶é€‰æ‹©ï¼Œä½†ç›´æ¥è½¬ç§» $O(m^2)$ ä¸å¯è¡Œ
> 2. **çº¿ç´¢2**ä¸­GCDçº¦æŸå’Œäº’å¼‚çš„ $x_i$ æç¤ºå¯ç”¨è«æ¯”ä¹Œæ–¯åæ¼”å°†çº¦æŸè½¬åŒ–ä¸ºå› å­å…³ç³»
> 3. **çº¿ç´¢3**è¦æ±‚äºšäºŒæ¬¡å¤æ‚åº¦ï¼Œç‹„åˆ©å…‹é›·å‰/åç¼€å’Œçš„ $O(n\log\log n)$ ç‰¹æ€§å®Œç¾åŒ¹é…
> 4. **ç»“è®º**ï¼šç»„åˆDP+è«æ¯”ä¹Œæ–¯åæ¼”+ç‹„åˆ©å…‹é›·å’Œä¼˜åŒ–ï¼Œå½¢æˆé«˜æ•ˆè§£é¢˜é€šè·¯ï¼"

---

## 2. ç²¾é€‰ä¼˜è´¨é¢˜è§£å‚è€ƒ

**é¢˜è§£ä¸€ï¼šwhiteqwqï¼ˆè¯„åˆ†ï¼šâ˜…â˜…â˜…â˜…â˜…ï¼‰**  
* **ç‚¹è¯„**ï¼š  
  æ€è·¯æœ€å®Œæ•´çš„å…¸èŒƒä¹‹ä½œã€‚æ¸…æ™°å±•ç¤º"DPå®šä¹‰â†’è«æ¯”ä¹Œæ–¯åæ¼”â†’ç‹„åˆ©å…‹é›·å’Œä¼˜åŒ–"çš„å®Œæ•´æ¨å¯¼é“¾ï¼Œä»£ç å®ç°ç²¾ç‚¼ï¼š  
  - ä½¿ç”¨å•æ•°ç»„æ»šåŠ¨ï¼Œå†…å­˜æ•ˆç‡é«˜  
  - é¢„å¤„ç†è«æ¯”ä¹Œæ–¯å‡½æ•°å’Œè´¨æ•°ç­›æå‡æ•ˆç‡  
  - å˜é‡å‘½åè§„èŒƒï¼ˆ`f`/`g`çŠ¶æ€åˆ†æ˜ï¼‰  
  - åç¼€å’Œï¼ˆ`suf`ï¼‰å’Œå‰ç¼€å’Œï¼ˆ`pre`ï¼‰æ“ä½œå°è£…ä¼˜é›…

**é¢˜è§£äºŒï¼šzhouyuhangï¼ˆè¯„åˆ†ï¼šâ˜…â˜…â˜…â˜…â˜†ï¼‰**  
* **ç‚¹è¯„**ï¼š  
  æä¾›æ›´ç›´è§‚çš„é—®é¢˜è½¬åŒ–è§†è§’ï¼š  
  - å¼ºè°ƒ"åªæœ‰ $\frac{m}{x_i}$ ä¸ªå€¼æœ‰æ•ˆ"çš„å…³é”®æ´å¯Ÿ  
  - ä»£ç çœç•¥è´¨æ•°ç­›ï¼Œç›´æ¥ç”¨åŸƒæ°ç­›é£æ ¼ä¼˜åŒ–  
  - å‡½æ•°å¼ç¼–ç¨‹é£æ ¼ï¼ˆ`sum0`/`sum1`ï¼‰å¢å¼ºå¯è¯»æ€§  
  - è¾¹ç•Œå¤„ç†ç¨ç®€ç•¥ä½†æ ¸å¿ƒé€»è¾‘å®Œæ•´

**é¢˜è§£ä¸‰ï¼ša___ï¼ˆè¯„åˆ†ï¼šâ˜…â˜…â˜…â˜…ï¼‰**  
* **ç‚¹è¯„**ï¼š  
  æ•°å­¦æ¨å¯¼æœ€ä¸¥è°¨ï¼š  
  - è¯¦ç»†å±•ç¤ºå˜é‡æ›¿æ¢ï¼ˆ$f'_{i,j}=f_{i,jx_i}$ï¼‰çš„è½¬åŒ–è¿‡ç¨‹  
  - æ³¨é‡Šå®Œæ•´ï¼Œç‹„åˆ©å…‹é›·æ“ä½œç‹¬ç«‹ä¸ºå‡½æ•°  
  - ç‹¬ç‰¹çš„ä»å¤§åˆ°å°æšä¸¾ä¼˜åŒ–å†…å­˜è®¿é—®

---

## 3. è§£é¢˜ç­–ç•¥æ·±åº¦å‰–æ

### ğŸ¯ æ ¸å¿ƒéš¾ç‚¹ä¸å…³é”®æ­¥éª¤
1.  **éš¾ç‚¹1ï¼šçŠ¶æ€è½¬ç§»ä¼˜åŒ–**  
    * **åˆ†æ**ï¼šåŸå§‹è½¬ç§» $f_{i,j} = \sum_k [\gcd(j,k)=x_i]f_{i-1,k}$ æ˜¯ $O(m^2)$ çš„ã€‚é€šè¿‡è«æ¯”ä¹Œæ–¯åæ¼”ï¼š  
      $f_{i,jx_i} = \sum_{d|j} \mu(d) \cdot g_{i-1}(x_i d)$  
      å…¶ä¸­ $g_{i-1}(D) = \sum_{k=1}^{\lfloor m/D \rfloor} f_{i-1, kD}$ æ˜¯ç‹„åˆ©å…‹é›·åç¼€å’Œ
    * ğŸ’¡ **å­¦ä¹ ç¬”è®°**ï¼šè«æ¯”ä¹Œæ–¯åæ¼”å°†GCDçº¦æŸè½¬åŒ–ä¸ºå› å­æ±‚å’Œï¼Œæ‰“å¼€ä¼˜åŒ–ä¹‹é—¨

2.  **éš¾ç‚¹2ï¼šç‹„åˆ©å…‹é›·å’Œçš„åº”ç”¨**  
    * **åˆ†æ**ï¼š$g_i$ æ˜¯ $f_i$ çš„åç¼€å’Œï¼Œè€Œ $f_i$ åˆæ˜¯ $\mu \cdot g_{i-1}$ çš„å‰ç¼€å’Œã€‚ä½¿ç”¨è´¨æ•°ç­›æŠ€å·§å¯å°†æ¯æ¬¡æ“ä½œä¼˜åŒ–åˆ° $O(n\log\log n)$
    * ğŸ’¡ **å­¦ä¹ ç¬”è®°**ï¼šç‹„åˆ©å…‹é›·å’Œæ˜¯å¤„ç†å› å­å…³ç³»çš„"è¶…é«˜é€Ÿå¼•æ“"

3.  **éš¾ç‚¹3ï¼šç©ºé—´ä¸æ—¶é—´å¹³è¡¡**  
    * **åˆ†æ**ï¼šé€šè¿‡æ»šåŠ¨æ•°ç»„ï¼ˆ`f`/`g`äº¤æ›¿ï¼‰å’ŒåŸä½æ“ä½œï¼Œç©ºé—´ä¿æŒ $O(m)$ï¼Œä¸”å†…å­˜è®¿é—®æ¨¡å¼å¯¹ç¼“å­˜å‹å¥½
    * ğŸ’¡ **å­¦ä¹ ç¬”è®°**ï¼šç”¨è®¡ç®—é¡ºåºä¼˜åŒ–ï¼ˆè´¨æ•°ä»å¤§åˆ°å°æšä¸¾ï¼‰æå‡å†…å­˜å±€éƒ¨æ€§

### âœ¨ è§£é¢˜æŠ€å·§æ€»ç»“
- **æŠ€å·§1ï¼šæ•°è®ºè½¬åŒ–** - é‡GCDçº¦æŸå³æƒ³è«æ¯”ä¹Œæ–¯åæ¼”
- **æŠ€å·§2ï¼šç»´åº¦å‹ç¼©** - $x_i$ äº’å¼‚ä¿è¯ $\sum \frac{m}{x_i} \approx m\ln m$ï¼Œå¤æ‚åº¦å¯æ§
- **æŠ€å·§3ï¼šåˆ†å±‚ä¼˜åŒ–** - å°†ç‹„åˆ©å…‹é›·å’Œè§†ä¸ºç‹¬ç«‹åŸè¯­æ„å»ºç®—æ³•

### âš”ï¸ ç­–ç•¥ç«æŠ€åœºï¼šè§£æ³•å¯¹æ¯”
| ç­–ç•¥                | æ ¸å¿ƒæ€æƒ³                     | ä¼˜ç‚¹                     | ç¼ºç‚¹                     | å¾—åˆ†é¢„æœŸ       |
|---------------------|-----------------------------|-------------------------|--------------------------|---------------|
| **æš´åŠ›æšä¸¾**         | é€’å½’æ£€æŸ¥æ‰€æœ‰åºåˆ—            | é€»è¾‘ç®€å•                | $O(m^n)$ è¶…æ—¶            | 0% (n,m>10)   |
| **æœ´ç´ DP**          | $f_{i,j}$ ç›´æ¥è½¬ç§»          | æ¯”æš´åŠ›ç¨å¥½              | $O(nm^2)$ ä»…è¿‡å°æ•°æ®     | 40% (n,mâ‰¤500) |
| **ä¼˜åŒ–DP+ç‹„åˆ©å…‹é›·å’Œ**| è«æ¯”ä¹Œæ–¯åæ¼”+å› å­å’Œä¼˜åŒ–     | $O(m\log m\log\log m)$ | å®ç°å¤æ‚ä½†å¯é€šè¿‡æ‰€æœ‰æ•°æ® | 100%          |

### âœ¨ ä¼˜åŒ–ä¹‹æ—…ï¼šä»"èƒ½åš"åˆ°"åšå¥½"
> 1. **èµ·ç‚¹ï¼šæš´åŠ›å›°å¢ƒ**  
>    é¢å¯¹ $m=10^6, n=10^6$ï¼Œæš´åŠ›æšä¸¾éœ€è¦ $10^{600000}$ æ¬¡è®¡ç®—â€”â€”å®‡å®™æ¯ç­éƒ½ç®—ä¸å®Œ
> 
> 2. **çªç ´ï¼šåŠ¨æ€è§„åˆ’**  
>    å®šä¹‰ $f_{i,j}$ å°†é—®é¢˜åˆ†è§£ï¼Œä½†è½¬ç§»ä»éœ€ $O(m^2)$ï¼Œ$10^{12}$ æ“ä½œä»ä¸å¯è¡Œ
> 
> 3. **å…³é”®ï¼šæ•°è®ºå·¥å…·**  
>    è«æ¯”ä¹Œæ–¯åæ¼”å°†GCDè½¬åŒ–ä¸ºå› å­æ±‚å’Œï¼š  
>    $\color{red}{[\gcd(a,b)=x]} \Rightarrow \color{green}{\sum_{d|x} \mu(d)}$
> 
> 4. **å‡åï¼šç‹„åˆ©å…‹é›·å’Œ**  
>    å‘ç° $g_i(D) = \sum_{kD \leq m} f_{i,kD}$ æ»¡è¶³ï¼š  
>    $\color{blue}{g_i = \text{suffix-sum}(f_i)}$  
>    $\color{blue}{f_i = \text{prefix-sum}(\mu \cdot g_{i-1})}$  
>    ç”¨è´¨æ•°ç­›æŠ€å·§å°†æ¯æ¬¡æ“ä½œé™ä¸º $O(m\log\log m)$

ğŸ’¡ **ç­–ç•¥æ€»ç»“**ï¼šä»æš´åŠ›åˆ°æœ€ä¼˜è§£çš„è·ƒè¿ï¼Œæœ¬è´¨æ˜¯**é—®é¢˜è§†è§’çš„è½¬åŒ–**â€”â€”å°†å…ƒç´ é—´çº¦æŸè½¬åŒ–ä¸ºå› å­ç©ºé—´çš„æ“ä½œã€‚é«˜æ•ˆçš„ç®—æ³•=æ·±åˆ»çš„æ´å¯Ÿ+åˆé€‚çš„å·¥å…·ï¼ˆè«æ¯”ä¹Œæ–¯+ç‹„åˆ©å…‹é›·å’Œï¼‰ï¼

---

## 4. C++æ ¸å¿ƒä»£ç å®ç°èµæ

**é€šç”¨æ ¸å¿ƒå®ç°**  
```cpp
#include<bits/stdc++.h>
#define rep(i,a,b) for(int i=(a);i<=(b);i++)
using namespace std;
const int N=1e6+5, mod=998244353;
int n,m,mu[N],f[N],g[N],x[N];
vector<int> primes;

void init(){ // è«æ¯”ä¹Œæ–¯å‡½æ•°é¢„å¤„ç†
    vector<bool> is_prime(N,1); mu[1]=1;
    rep(i,2,N-1){
        if(is_prime[i]) primes.push_back(i), mu[i]=-1;
        for(int p: primes){
            if(i*p>=N) break;
            is_prime[i*p]=0;
            if(i%p==0) { mu[i*p]=0; break; }
            mu[i*p]=-mu[i];
        }
    }
}

void dirichlet_prefix(int *arr, int lim){ // ç‹„åˆ©å…‹é›·å‰ç¼€å’Œ
    for(int p: primes) for(int j=1; j*p<=lim; j++) 
        (arr[j*p] += arr[j]) %= mod;
}

void dirichlet_suffix(int *arr, int lim){ // ç‹„åˆ©å…‹é›·åç¼€å’Œ
    for(int p: primes) for(int j=lim/p; j; j--)
        (arr[j] += arr[j*p]) %= mod;
}

int main(){
    init(); 
    cin>>n>>m; x[0]=1;
    rep(i,1,n-1) cin>>x[i];
    
    // åˆå§‹åŒ–: æ»¡è¶³ x1|i çš„ä½ç½®ä¸º1
    rep(i,1,m) f[i] = (i%x[1]==0);

    rep(i,1,n-1){
        int lim = m / x[i]; 
        // æŠ½å–æœ‰æ•ˆçŠ¶æ€åˆ°g
        rep(j,1,lim) g[j] = f[j*x[i]];
        // æ¸…ç©ºæ—§çŠ¶æ€
        rep(j,1,m) f[j]=0; 
        // ç‹„åˆ©å…‹é›·åç¼€å’Œ
        dirichlet_suffix(g, lim);
        // ä¹˜è«æ¯”ä¹Œæ–¯å‡½æ•°
        rep(j,1,lim) g[j] = (1LL * g[j] * (mu[j]+mod)) % mod;
        // ç‹„åˆ©å…‹é›·å‰ç¼€å’Œ
        dirichlet_prefix(g, lim);
        // å†™å›æ–°çŠ¶æ€
        rep(j,1,lim) f[j*x[i]] = g[j];
    }
    
    int ans=0;
    rep(i,1,m) ans = (ans + f[i]) % mod;
    cout<<ans;
}
```

**ä»£ç è§£è¯»æ¦‚è¦**ï¼š  
1. é¢„å¤„ç†è«æ¯”ä¹Œæ–¯å‡½æ•°ï¼ˆçº¿æ€§ç­›ï¼‰
2. åˆå§‹åŒ–ï¼šç¬¬ä¸€ä¸ªå…ƒç´ æ»¡è¶³ $x_1 \mid i$
3. å¯¹æ¯ä¸ªçº¦æŸ $x_i$ï¼š
   - æŠ½å–å½“å‰æœ‰æ•ˆçŠ¶æ€åˆ°ä¸´æ—¶æ•°ç»„ $g$
   - ç‹„åˆ©å…‹é›·åç¼€å’Œï¼ˆè®¡ç®— $\sum_{d|j} g_j$ï¼‰
   - ä¹˜è«æ¯”ä¹Œæ–¯å‡½æ•°
   - ç‹„åˆ©å…‹é›·å‰ç¼€å’Œï¼ˆè®¡ç®— $\sum_{d|j} \mu(d)g_d$ï¼‰
   - å†™å›æ›´æ–°åçš„çŠ¶æ€
4. ç´¯åŠ æœ€ç»ˆç­”æ¡ˆ

**é¢˜è§£ç‰‡æ®µèµæ**  
1. **whiteqwqçš„ä¼˜åŒ–ç­›**  
```cpp
for(int j=1;j<=cnt&&p[j]<=m/x[i];j++)
    for(int k=(m/x[i])/p[j];k>=1;k--)
        g[k]=add(g[k],g[k*p[j]]); // åç¼€å’Œä¼˜åŒ–
```
* **äº®ç‚¹**ï¼šå€’åºæšä¸¾é¿å…é‡å¤è®¡ç®—ï¼Œè´¨æ•°ç­›é™åˆ¶å‡å°‘å†—ä½™æ“ä½œ  
* **å­¦ä¹ ç¬”è®°**ï¼šå€’åºæšä¸¾æ˜¯ç‹„åˆ©å…‹é›·åç¼€å’Œçš„å…³é”®æŠ€å·§

2. **a___çš„è«æ¯”ä¹Œæ–¯å¤„ç†**  
```cpp
rep(j,1,lim) g[j] = (g[j]*mu[j] + mod) % mod; 
```
* **äº®ç‚¹**ï¼šå…ˆè½¬æ­£æ•°å†å–æ¨¡ï¼Œé¿å…è´Ÿå€¼é—®é¢˜  
* **å­¦ä¹ ç¬”è®°**ï¼šè«æ¯”ä¹Œæ–¯å‡½æ•°æœ‰è´Ÿå€¼ï¼Œæ¨¡è¿ç®—å‰éœ€è°ƒæ•´

---

## 5. ç®—æ³•å¯è§†åŒ–ï¼šåƒç´ åŠ¨ç”»æ¼”ç¤º

* **ä¸»é¢˜**ï¼šåƒç´ å®‡å®™ä¸­çš„"å› å­å®‡å®™æ¢é™©"  
* **æ ¸å¿ƒæ¼”ç¤º**ï¼šç‹„åˆ©å…‹é›·å’Œå¦‚ä½•èšåˆ/åˆ†å‘å› å­ç©ºé—´çš„ä¿¡æ¯

* **è®¾è®¡æ€è·¯**ï¼š  
  é‡‡ç”¨8-bitå¤å¤é£æ ¼ï¼Œå°†æ•°å­—è¡¨ç¤ºä¸ºä¸åŒé¢œè‰²çš„æ˜Ÿçƒï¼Œå› å­å…³ç³»ä½œä¸ºæ˜Ÿé™…èˆªçº¿ã€‚ç‹„åˆ©å…‹é›·æ“ä½œè¡¨ç°ä¸ºèƒ½é‡åœ¨å› å­ç½‘ç»œä¸­çš„ä¼ æ’­ã€‚

* **åŠ¨ç”»å¸§è®¾è®¡**ï¼š  
  1. **å®‡å®™åˆå§‹åŒ–**  
     - åƒç´ ç½‘æ ¼ï¼š$1$ åˆ° $m$ çš„æ•°å­—ä½œä¸ºå½©è‰²æ˜Ÿçƒ  
     - é£èˆ¹åœæ³Šåœ¨èµ·å§‹æ˜Ÿçƒ $x_1$ ä¸Š

  2. **æ˜Ÿé™…è·ƒè¿ï¼ˆçŠ¶æ€è½¬ç§»ï¼‰**  
     - é£èˆ¹æ²¿èˆªçº¿ï¼ˆå› å­å…³ç³»ï¼‰è·³è·ƒåˆ° $j$ æ˜Ÿçƒ  
     - åŠ¨æ€æ˜¾ç¤º $\sum \mu(d)g(d)$ è®¡ç®—è¿‡ç¨‹  
     ```python
     # ä¼ªä»£ç ï¼šå•æ­¥è½¬ç§»å¯è§†åŒ–
     for è´¨æ•°p in primes:
         for k in range(lim//p, 0, -1):
             å‘å°„èƒ½é‡æŸä»æ˜Ÿçƒ[k*p]åˆ°æ˜Ÿçƒ[k]  # åç¼€å’Œ
             æ’­æ”¾8-bit "zap" éŸ³æ•ˆ
     ```

  3. **å› å­ç½‘ç»œæ¿€æ´»ï¼ˆç‹„åˆ©å…‹é›·å’Œï¼‰**  
     - åç¼€å’Œï¼šçº¢è‰²èƒ½é‡ä»å¤§æ˜Ÿçƒæµå‘å°æ˜Ÿçƒï¼ˆå€’åºæšä¸¾ï¼‰  
     - å‰ç¼€å’Œï¼šè“è‰²èƒ½é‡ä»å°æ˜Ÿçƒæµå‘å¤§æ˜Ÿçƒï¼ˆæ­£åºæšä¸¾ï¼‰  
     - è´¨æ•°èˆªçº¿é«˜äº®æ˜¾ç¤º

  4. **æ¸¸æˆåŒ–å…ƒç´ **  
     - **å…³å¡ç³»ç»Ÿ**ï¼šæ¯ä¸ª $x_i$ çº¦æŸæ˜¯ä¸€å…³  
     - **èƒ½é‡æ”¶é›†**ï¼šæˆåŠŸè½¬ç§»æ—¶é£èˆ¹æ”¶é›†èƒ½é‡å—  
     - **éŸ³æ•ˆè®¾è®¡**ï¼š  
        â€¢ è´¨æ•°èˆªçº¿æ¿€æ´»ï¼šNESé£æ ¼"å“”"å£°  
        â€¢ è¿‡å…³ï¼šFCè¿‡å…³éŸ³æ•ˆ  
        â€¢ é”™è¯¯ï¼šç»å…¸"ç‚¸æ¯"éŸ³æ•ˆ

  5. **ä¿¡æ¯é¢æ¿**  
     - å·¦ä¸Šè§’ï¼šå½“å‰DPçŠ¶æ€å€¼ï¼ˆåƒç´ æ•°å­—ï¼‰  
     - å³ä¸‹è§’ï¼šå½“å‰æ“ä½œçš„æ•°å­¦å…¬å¼  
     - åº•éƒ¨æ§åˆ¶å°ï¼šå•æ­¥/æ’­æ”¾/é€Ÿåº¦æ¡

---

## 6. æ‹“å±•ç»ƒä¹ ä¸ç›¸ä¼¼é—®é¢˜æ€è€ƒ

* **é€šç”¨æŠ€å·§è¿ç§»**ï¼š  
  1. å› å­å…³ç³»çº¦æŸçš„è®¡æ•°é—®é¢˜ï¼ˆå¦‚ P3312 [SDOI2014]æ•°è¡¨ï¼‰  
  2. ç‹„åˆ©å…‹é›·å’Œä¼˜åŒ–DPï¼ˆå¦‚ P1891 ç–¯ç‹‚çš„é¦’å¤´ï¼‰  
  3. å¤šç»´çº¦æŸçš„åºåˆ—è®¡æ•°ï¼ˆå¦‚ P6672 [æ¸…åé›†è®­2016]ä½ çš„ç”Ÿå‘½å·²å¦‚é£ä¸­æ®‹çƒ›ï¼‰

* **æ´›è°·ç»ƒä¹ æ¨è**ï¼š  
  1. **P1891 ç–¯ç‹‚çš„é¦’å¤´**  
     ğŸ—£ï¸ ç‹„åˆ©å…‹é›·å‰ç¼€å’Œè£¸é¢˜ï¼Œå·©å›ºå› å­æ±‚å’ŒæŠ€å·§  
  2. **P3312 [SDOI2014]æ•°è¡¨**  
     ğŸ—£ï¸ ç»¼åˆè«æ¯”ä¹Œæ–¯åæ¼”+å› å­çº¦æŸï¼Œå¼ºåŒ–æ•°è®ºè½¬åŒ–èƒ½åŠ›  
  3. **P2158 [SDOI2008]ä»ªä»—é˜Ÿ**  
     ğŸ—£ï¸ äºŒç»´GCDè®¡æ•°é—®é¢˜ï¼Œè®­ç»ƒé—®é¢˜è½¬åŒ–æ€ç»´

---

## 7. å­¦ä¹ å¿ƒå¾—ä¸ç»éªŒåˆ†äº«

> **å‚è€ƒç»éªŒ (æ¥è‡ª zifanwang)**ï¼š  
> "è°ƒè¯•æ—¶å‘ç°è¾¹ç•Œå¤„ç†é”™è¯¯ï¼šæœªæ¸…ç©ºæ—§çŠ¶æ€å¯¼è‡´ç­”æ¡ˆåå¤§ã€‚é€šè¿‡å°æ•°æ®æ¨¡æ‹Ÿå‘ç°é”™è¯¯"  
> 
> **ç‚¹è¯„**ï¼š  
> è¿™ç±»æ•°è®ºDPçš„å¸¸è§é™·é˜±ï¼š  
> 1. çŠ¶æ€æ•°ç»„å¤ç”¨å‰æœªæ­£ç¡®åˆå§‹åŒ–  
> 2. æ¨¡è¿ç®—ä¸­è´Ÿå€¼å¤„ç†ä¸å½“  
> 3. è´¨æ•°ç­›è¾¹ç•Œé”™è¯¯  
> è°ƒè¯•å»ºè®®ï¼šç”¨ $n=2,m=10$ æ‰‹å·¥è®¡ç®—éªŒè¯

---

æœ¬æ¬¡å…³äºã€ŒPMOI-3ã€å…¬çº¦æ•°çš„è§£æå°±åˆ°è¿™é‡Œã€‚è®°ä½ï¼šæ•°è®ºä¼˜åŒ–çš„æ ¸å¿ƒåœ¨äº**é—®é¢˜è§†è§’çš„è½¬åŒ–**ã€‚å½“ä½ å°†çœ‹ä¼¼å¤æ‚çš„çº¦æŸè½¬åŒ–ä¸ºå› å­ç©ºé—´çš„è¿ç®—æ—¶ï¼Œç­”æ¡ˆå°±ä¼šåƒæ˜Ÿè¾°ä¸€æ ·æœ‰åºæ’åˆ—ï¼âœ¨

---
å¤„ç†ç”¨æ—¶ï¼š147.04ç§’
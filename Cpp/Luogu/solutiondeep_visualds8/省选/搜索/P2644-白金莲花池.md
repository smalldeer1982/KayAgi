# é¢˜ç›®ä¿¡æ¯

# ç™½é‡‘è²èŠ±æ± 

## é¢˜ç›®èƒŒæ™¯

ä¸ºäº†è®©å¥¶ç‰›ä»¬å¨±ä¹å’Œé”»ç‚¼ï¼Œå†œå¤«çº¦ç¿°å»ºé€ äº†ä¸€ä¸ªç¾ä¸½çš„æ± å¡˜ã€‚è¿™ä¸ªé•¿æ–¹å½¢çš„æ± å­è¢«åˆ†æˆäº† $M$ è¡Œ $N$ åˆ—ä¸ªæ–¹æ ¼ï¼ˆ$1â‰¤M,Nâ‰¤30$ï¼‰ã€‚ä¸€äº›æ ¼å­æ˜¯åšå›ºå¾—ä»¤äººæƒŠè®¶çš„è²èŠ±ï¼Œè¿˜æœ‰ä¸€äº›æ ¼å­æ˜¯å²©çŸ³ï¼Œå…¶ä½™çš„åªæ˜¯ç¾ä¸½ã€çº¯å‡€ã€æ¹›è“è¿˜å¯èƒ½æ©è—ç€å®è—çš„æ°´ã€‚

è´è¥¿æ­£åœ¨ç»ƒä¹ èŠ­è•¾èˆï¼Œå¥¹ç«™åœ¨ä¸€æœµè²èŠ±ä¸Šï¼Œæƒ³è·³åˆ°å¦ä¸€æœµè²èŠ±ä¸Šå»ï¼Œå¥¹åªèƒ½ä»ä¸€æœµè²èŠ±è·³åˆ°å¦ä¸€æœµè²èŠ±ä¸Šï¼Œæ—¢ä¸èƒ½è·³åˆ°æ°´é‡Œï¼Œä¹Ÿä¸èƒ½è·³åˆ°å²©çŸ³ä¸Šã€‚

è´è¥¿çš„èˆæ­¥å¾ˆåƒè±¡æ£‹ä¸­çš„é©¬æ­¥ï¼šæ¯æ¬¡æ€»æ˜¯å…ˆæ¨ªå‘ç§»åŠ¨ä¸€æ ¼ï¼Œå†çºµå‘ç§»åŠ¨ä¸¤æ ¼ï¼Œæˆ–å…ˆçºµå‘ç§»åŠ¨ä¸¤æ ¼ï¼Œå†æ¨ªå‘ç§»åŠ¨ä¸€æ ¼ã€‚æœ€å¤šæ—¶ï¼Œè´è¥¿ä¼šæœ‰å…«ä¸ªç§»åŠ¨æ–¹å‘å¯ä¾›é€‰æ‹©ã€‚

çº¦ç¿°ä¸€ç›´åœ¨è§‚çœ‹è´è¥¿çš„èŠ­è•¾ç»ƒä¹ ï¼Œå‘ç°å¥¹æœ‰æ—¶å€™ä¸èƒ½è·³åˆ°ç»ˆç‚¹ï¼Œå› ä¸ºä¸­é—´ç¼ºäº†ä¸€äº›è·å¶ã€‚äºæ˜¯ä»–æƒ³è¦æ·»åŠ å‡ æœµè²èŠ±æ¥å¸®åŠ©è´è¥¿å®Œæˆä»»åŠ¡ï¼Œå½“ç„¶è²èŠ±ä¸èƒ½ç§åœ¨å²©çŸ³ä¸Šã€‚


## é¢˜ç›®æè¿°

ä½†æ˜¯ï¼çº¦ç¿°åœ¨ç§æ¤è²èŠ±çš„æ—¶å€™å‘ç°äº†ä¸€ä»¶å¾ˆæœ‰è¶£çš„äº‹ï¼Œæœ‰äº›æ ¼å­æ˜¯ä¸èƒ½ç›´æ¥ç§æ¤è²èŠ±çš„ï¼ŒåŸå› æ˜¯â€¦â€¦å®ä¸ç›¸ç’ï¼Œæ— æ³•ç›´æ¥ç§æ¤è²èŠ±çš„æ ¼å­çš„æ³¥åœŸä¸­å¤§éƒ¨åˆ†éƒ½æ˜¯è´§çœŸä»·å®çš„é“‚é‡‘ï¼Œæ­£æ˜¯å®ƒä»¬å¦¨ç¢äº†è²èŠ±çš„æ­£å¸¸ç”Ÿé•¿ï¼è€Œæ°å¥½çº¦ç¿°åˆšåˆšå­¦åˆ°äº†é“‚é‡‘çš„å¼€é‡‡æ–¹æ³•ï¼Œä¹Ÿæœ‰ç›¸å…³çš„å¼€é‡‡å·¥å…·ï¼Œè€Œä¸”ä»–è¿˜å‘ç°å¼€é‡‡é“‚é‡‘åçš„æ ¼å­å°±å¯ä»¥æ­£å¸¸åœ°ç§æ¤è²èŠ±ï¼Œä¸å¿…æ‹…å¿ƒæ³¥åœŸç¼ºå¤±çš„é—®é¢˜ã€‚ï¼ˆç”±äºè´è¥¿è¿«åˆ‡åœ°æƒ³ç»ƒä¹ ï¼Œæ‰€ä»¥çº¦ç¿°ä¸ä¼šå¼€é‡‡ä¸æ‰“ç®—ç§è²èŠ±çš„é“‚é‡‘æ ¼å­ï¼‰

å¼€é‡‡é“‚é‡‘å¾ˆç´¯ï¼Œå°±åƒæ˜¯ç§æ¤è²èŠ±ä¸€æ ·ç´¯ï¼Œå®ƒä»¬éƒ½ä¼šæ¶ˆè€—æ‰çº¦ç¿° $1$ ç‚¹ä½“åŠ›ï¼ˆä¹Ÿå°±æ˜¯è¯´æƒ³æŠŠé“‚é‡‘æ ¼å­å˜æˆè²èŠ±æ ¼å­éœ€è¦ $2$ ç‚¹ä½“åŠ›ï¼‰ï¼Œçº¦ç¿°æœ€åˆæœ‰ $P$ ç‚¹ä½“åŠ›æ¥ç§æ¤è²èŠ±æˆ–å¼€é‡‡é“‚é‡‘ã€‚

è¯·å¸®åŠ©çº¦ç¿°è®¡ç®—è‡³å°‘éœ€è¦æ¶ˆè€—å¤šå°‘ä½“åŠ›æ‰èƒ½å¸®åŠ©è´è¥¿å®Œæˆä»»åŠ¡ï¼Œè¿™ä¸ªæ•°å­—è®°ä½œ $S$ï¼Œä»¥åŠæœ‰å¤šå°‘ç§æ¶ˆè€—è¿™äº›ä½“åŠ›çš„æ–¹æ³•èƒ½å¸®åŠ©è´è¥¿å®Œæˆä»»åŠ¡ï¼Œè¿™ä¸ªæ•°å­—è®°ä½œ $W_S$ï¼›é“‚é‡‘å½“ç„¶æ˜¯è¶Šå¤šè¶Šå¥½ï¼Œè¯·è®¡ç®—åœ¨æ¶ˆè€— $S$ ç‚¹ä½“åŠ›å¸®åŠ©è´è¥¿å®Œæˆä»»åŠ¡çš„åŒæ—¶æœ€å¤šèƒ½å¼€é‡‡å¤šå°‘é“‚é‡‘ï¼Œè¿™ä¸ªæ•°å­—è®°ä½œ $G$ï¼Œä»¥åŠæ¶ˆè€— $S$ ç‚¹ä½“åŠ›å¼€é‡‡ $G$ å—é“‚é‡‘å¸®åŠ©è´è¥¿å®Œæˆä»»åŠ¡çš„æ–¹æ³•æ•°ï¼Œè¿™ä¸ªæ•°å­—è®°ä½œ $W_G$ã€‚

è‹¥åœ¨ $P$ ç‚¹ä½“åŠ›å†…æ— æ³•å¸®åŠ©åˆ°è´è¥¿ï¼Œé‚£ä¹ˆåªè¾“å‡º `-1`ã€‚

è‹¥åœ¨ $S$ ç‚¹ä½“åŠ›å†…æ— æ³•å¼€é‡‡é“‚é‡‘ï¼Œé‚£ä¹ˆç¬¬äºŒè¡Œåªè¾“å‡º `-1`ã€‚

## è¯´æ˜/æç¤º

çº¦ç¿°å¯ä»¥ç”¨å¼€é‡‡åˆ°çš„é“‚é‡‘å°èµšä¸€ç¬”ï¼Œä½†å¦‚æœç”¨å¤šä½™çš„ä½“åŠ›å¼€é‡‡é“‚é‡‘è€Œä¸å¾€ä¸Šç§è²èŠ±çš„è¯è´è¥¿ä¼šå¾ˆç”Ÿæ°”ï¼


## æ ·ä¾‹ #1

### è¾“å…¥

```
4 5 6
0 0 0 1 0 0
2 0 0 2 0 0
0 0 5 0 0 0
3 0 0 0 4 0
0 0 2 0 0 0```

### è¾“å‡º

```
2 2
1 1```

## æ ·ä¾‹ #2

### è¾“å…¥

```
3 3 2
3 5
4 2
0 1```

### è¾“å‡º

```
-1```

# AIåˆ†æç»“æœ

# ğŸ’¡ æ´›è¯­äº‘ç¬ºçš„C++ç®—æ³•è§£æï¼šç™½é‡‘è²èŠ±æ±  æ·±å…¥å­¦ä¹ æŒ‡å— ğŸ’¡

> åŒå­¦ä»¬å¥½ï¼ä»Šå¤©æˆ‘ä»¬è¦ä¸€èµ·æ½œå…¥ä¸€ä¸ª 8Ã—8 åƒç´ çš„æ± å¡˜ï¼Œå¸®å¥¶ç‰›è´è¥¿å®Œæˆä¸€åœºâ€œèŠ­è•¾èˆå¤§å†’é™©â€ã€‚é¢˜ç›®çœ‹èµ·æ¥åƒåœ¨ç§è²èŠ±ã€æŒ–é“‚é‡‘ï¼Œä½†çœŸæ­£çš„æˆ˜åœºå…¶å®æ˜¯ä¸€å¼  **æœ‰å‘å¸¦æƒå›¾** å’Œä¸€æ¬¡ **å¤šç›®æ ‡æœ€çŸ­è·¯** ä¹‹æ—…ã€‚å‡†å¤‡å¥½åƒç´ æ¢é™©äº†å—ï¼Ÿ

---

## 1. é¢˜ç›®è§£è¯»ä¸ç­–ç•¥åˆæ¢

âœ¨ **æ ¸å¿ƒæŒ‘æˆ˜**  
æŠŠâ€œé©¬æ­¥è·³æ ¼å­ + è²èŠ±/å²©çŸ³/é“‚é‡‘ + ä½“åŠ›é™åˆ¶â€ç¿»è¯‘æˆå›¾è®ºè¯­è¨€ï¼š  
> **åœ¨ä¸€å¼ æœ€å¤š 30Ã—30=900 ä¸ªç‚¹çš„å›¾ä¸Šï¼Œæ±‚ä»èµ·ç‚¹åˆ°ç»ˆç‚¹çš„æœ€çŸ­è·¯é•¿åº¦ Sï¼Œå¹¶åœ¨æ‰€æœ‰ S çš„æ–¹æ¡ˆä¸­ç»Ÿè®¡ï¼š  
> â‘  æ€»æ–¹æ¡ˆæ•° W_Sï¼›â‘¡ æ²¿æœ€çŸ­è·¯å¼€é‡‡é“‚é‡‘çš„å—æ•°æœ€å¤§å€¼ Gï¼›â‘¢ å¼€é‡‡ G å—é“‚é‡‘çš„æ–¹æ¡ˆæ•° W_Gã€‚**  
ä½“åŠ› P åªæ˜¯å¯¹æœ€çŸ­è·¯é•¿åº¦ S çš„ä¸€ä¸ªä¸Šé™ã€‚

âœ¨ **æ ¸å¿ƒç®—æ³•æ ‡ç­¾**  
æœ€çŸ­è·¯ (Dijkstra) + å¤šç»´åº¦çŠ¶æ€é™„åŠ ä¿¡æ¯ï¼ˆæ–¹æ¡ˆæ•°ã€é“‚é‡‘æ•°ï¼‰

ğŸ—£ï¸ **æ€è·¯æ¼”è¿›è·¯å¾„**  
1. æœ´ç´  BFSï¼šåªè€ƒè™‘ 0/1 è¾¹æƒå¯è¡Œï¼Œä½†é“‚é‡‘è¾¹æƒä¸º 2ï¼Œç›´æ¥å¤±æ•ˆã€‚  
2. 0-1 BFSï¼šè¾¹æƒåªæœ‰ 0 æˆ– 1ï¼Œå¯ O(V+E)ã€‚æœ¬é¢˜æœ‰ 0/1/2 ä¸‰ç§è¾¹æƒï¼Œä»ä¸é€‚ç”¨ã€‚  
3. **Dijkstra å¤šç›®æ ‡æ‰©å±•**ï¼šè¾¹æƒä»»æ„æ­£æ•´æ•°ï¼Œå¤©ç„¶æ”¯æŒé™„åŠ ç»´åº¦ï¼ˆæ–¹æ¡ˆæ•°ã€é“‚é‡‘æ•°ï¼‰ã€‚  
   â†’ è¿™å°±æ˜¯æˆ‘ä»¬çš„â€œåƒç´ æ¢é™©èˆ¹â€ï¼

ğŸ” ç®—æ³•ä¾¦æ¢ï¼šå¦‚ä½•åœ¨é¢˜ç›®ä¸­å‘ç°çº¿ç´¢ï¼Ÿ  
| çº¿ç´¢ | å‘ç° | ä½œç”¨ |
|---|---|---|
| æ£‹ç›˜æ ¼ + 8 æ–¹å‘é©¬æ­¥ | éšå¼å›¾ï¼Œæœ€å¤š 900 ç‚¹ | å›¾è®ºæ¨¡å‹ |
| â€œæœ€å°‘ä½“åŠ›â€ | æœ€ä¼˜åŒ–é—®é¢˜ï¼Œè¾¹æƒ 1 æˆ– 2 | æœ€çŸ­è·¯ |
| â€œå¤šå°‘ç§æ–¹æ³•â€ | è®¡æ•°é—®é¢˜ | åœ¨æ¾å¼›æ—¶åŒæ­¥ç´¯åŠ  |
| â€œæœ€å¤šé“‚é‡‘â€ | ç¬¬äºŒç»´æœ€ä¼˜åŒ– | å†æ¬¡æ¾å¼›å¹¶ç»´æŠ¤ |

ğŸ§  æ€ç»´é“¾æ„å»º  
> æŠŠæ¯ä¸ªæ ¼å­çœ‹ä½œå›¾èŠ‚ç‚¹ï¼›ä»æ¯æœµå¯ç«‹è¶³çš„è²èŠ±/é“‚é‡‘å‡ºå‘ï¼ŒDFS æšä¸¾ 8 æ–¹å‘èƒ½è·³åˆ°çš„æ ¼å­ï¼Œå»ºç«‹æœ‰å‘è¾¹ï¼š  
> - è·³åˆ°æ°´ â†’ è¾¹æƒ 1ï¼ˆç§è²èŠ± 1 ä½“åŠ›ï¼‰  
> - è·³åˆ°å²©çŸ³ â†’ ä¸å»ºè¾¹ï¼ˆä¸å¯è¾¾ï¼‰  
> - è·³åˆ°é“‚é‡‘ â†’ è¾¹æƒ 2ï¼ˆå¼€é‡‡ 1 + ç§è²èŠ± 1 å…± 2 ä½“åŠ›ï¼‰  
> å»ºå¥½å›¾åï¼Œè·‘ **Dijkstra**ï¼ŒåŒæ—¶ç»´æŠ¤ 3 ä¸ªé™„åŠ æ•°ç»„ï¼š  
> - `f[u]`ï¼šåˆ° u çš„æœ€çŸ­è·¯æ–¹æ¡ˆæ•°  
> - `pt[u]`ï¼šåœ¨åŒæ ·æœ€çŸ­è·¯é•¿åº¦ä¸‹ï¼Œèƒ½å¼€é‡‡çš„æœ€å¤§é“‚é‡‘æ•°  
> - `g[u]`ï¼šå¼€é‡‡ `pt[u]` å—é“‚é‡‘çš„æ–¹æ¡ˆæ•°  

---

## 2. ç²¾é€‰ä¼˜è´¨é¢˜è§£å‚è€ƒ

**é¢˜è§£æ¥æºï¼š251Sec (èµï¼š6)**  
* **ç‚¹è¯„**ï¼š  
  è¿™ç¯‡é¢˜è§£æ€è·¯æå…¶ç²¾ç‚¼â€”â€”æŠŠå¤æ‚æ£‹ç›˜è½¬åŒ–ä¸ºå›¾åï¼Œç›´æ¥å¥—ç”¨æœ€çŸ­è·¯æ¨¡æ¿ã€‚  
  - **å»ºå›¾æŠ€å·§**ï¼šç”¨ DFS ä»æ¯ä¸ªå¯ç«‹è¶³ç‚¹å‘å¤–â€œè·³é©¬æ­¥â€ï¼Œä¸€æ¬¡æ€§æŠŠæ‰€æœ‰å¯è¾¾è¾¹å»ºå¥½ï¼Œé¿å…é‡å¤ BFSã€‚  
  - **å¤šç»´åº¦æ¾å¼›**ï¼šåœ¨ Dijkstra çš„ `if (d[v] == d[u] + w)` åˆ†æ”¯é‡Œï¼ŒåŒæ—¶ç´¯åŠ æ–¹æ¡ˆæ•°ã€æ›´æ–°æœ€å¤§é“‚é‡‘æ•°ï¼Œå®ç°â€œä¸€æ¬¡éå†ï¼Œä¸‰ä¸ªç­”æ¡ˆâ€ã€‚  
  - **ä»£ç è§„èŒƒ**ï¼šå® `pid(x,y)` ä¼˜é›…åœ°æŠŠäºŒç»´åæ ‡å‹æˆä¸€ç»´ï¼Œé™ä½å‡ºé”™ç‡ï¼›ä¼˜å…ˆé˜Ÿåˆ—é‡è½½ `<` å®ç°æœ€å°å †ã€‚  
  è¿™ä»½ä»£ç å¯ç›´æ¥ç”¨äºç«èµ›ï¼Œå¯¹ 900 ç‚¹ã€æ•°åƒæ¡è¾¹çš„ç¨€ç–å›¾å®Œå…¨æ— å‹åŠ›ã€‚

---

## 3. è§£é¢˜ç­–ç•¥æ·±åº¦å‰–æ

### ğŸ¯ æ ¸å¿ƒéš¾ç‚¹ä¸å…³é”®æ­¥éª¤

| å…³é”®ç‚¹ | åˆ†æ | ğŸ’¡å­¦ä¹ ç¬”è®° |
|---|---|---|
| 1. å»ºå›¾ï¼šéšå¼å›¾è½¬æ˜¾å¼ | æ¯æ ¼å½“èŠ‚ç‚¹ï¼Œ8 æ–¹å‘ DFS è¿è¾¹ï¼›æ°´=1ï¼Œé“‚é‡‘=2 | æŠŠæ£‹ç›˜é¢˜å…ˆâ€œæ‹å¹³â€æˆé‚»æ¥è¡¨ï¼Œåç»­ç®—æ³•æ‰èƒ½å¤ç”¨æ¨¡æ¿ |
| 2. å¤šç›®æ ‡æ¾å¼› | ç»å…¸ Dijkstra ä¸­ï¼Œé™¤äº†æ›´æ–°æœ€çŸ­è·¯é•¿åº¦ï¼Œè¿˜è¦ï¼š <br> - é•¿åº¦ç›¸ç­‰ â†’ ç´¯åŠ æ–¹æ¡ˆæ•° <br> - é•¿åº¦ç›¸ç­‰ä¸”é“‚é‡‘æ›´å¤š â†’ æ›´æ–°æœ€å¤§é“‚é‡‘å¹¶é‡ç½®æ–¹æ¡ˆæ•° <br> - é•¿åº¦æ›´çŸ­ â†’ å…¨éƒ¨è¦†ç›– | ä¸€æ¬¡æ¾å¼›è§£å†³â€œæœ€å€¼+è®¡æ•°â€ç»„åˆé—®é¢˜ï¼Œæ˜¯å›¾è®ºå¸¸è§å¥—è·¯ |
| 3. ç©ºé—´ä¸æ—¶é—´ | æ€»ç‚¹æ•° â‰¤ 900ï¼Œæ€»è¾¹æ•° â‰¤ 900Ã—8 â‰ˆ 7.2Ã—10Â³ï¼ŒDijkstra O((V+E)logV) è½»æ¾è¿‡ | 30Ã—30 æ£‹ç›˜é¢˜ç»å¸¸å¯ä»¥ç”¨â€œæš´åŠ›å»ºå›¾ + æœ€çŸ­è·¯â€ç§’æ€ |

### âš”ï¸ ç­–ç•¥ç«æŠ€åœº

| ç­–ç•¥ | æ ¸å¿ƒæ€æƒ³ | ä¼˜ç‚¹ | ç¼ºç‚¹ | é€‚ç”¨åœºæ™¯/å¾—åˆ† |
|---|---|---|---|---|
| å¤šæº BFSï¼ˆ0-1 æƒï¼‰ | è¾¹æƒåªæœ‰ 0/1 æ—¶ç”¨åŒç«¯é˜Ÿåˆ— | O(V+E) | æœ¬é¢˜æœ‰ 0/1/2 ä¸‰ç§æƒå€¼ï¼Œä¸é€‚ç”¨ | è¾¹æƒåªæœ‰ 0/1 |
| **Dijkstra + é™„åŠ ç»´åº¦** | ç»å…¸æœ€çŸ­è·¯ï¼Œé¢å¤–ç»´æŠ¤è®¡æ•° & æœ€å€¼ | é€šç”¨ã€ç®€æ´ã€æ˜“æ‰©å±• | log å› å­ç•¥æ…¢ | æœ¬é¢˜æœ€ä¼˜ï¼Œ100% |
| SPFA | é˜Ÿåˆ—ä¼˜åŒ–çš„ Bellman-Ford | å¹³å‡å¿« | æœ€å O(VE)ï¼Œæ£‹ç›˜å›¾æ˜“è¢«å¡ | ä¸æ¨è |

### âœ¨ ä¼˜åŒ–ä¹‹æ—…  
> ä»â€œæš´åŠ›æšä¸¾æ¯æ¡è·¯å¾„â€åˆ°â€œDijkstra ä¸€æ¬¡æå®šâ€ï¼Œæˆ‘ä»¬ç»å†äº†ï¼š  
> 1. å‘ç°æ£‹ç›˜è½¬å›¾ â†’ 2. å‘ç°è¾¹æƒé 0/1 â†’ 3. é€‰æ‹© Dijkstra â†’ 4. é™„åŠ ç»´åº¦åŒæ­¥ç»´æŠ¤ã€‚  
> è¿™å‘Šè¯‰æˆ‘ä»¬ï¼šå…ˆå»ºæ¨¡ï¼Œå†é€‰ç®—æ³•ï¼Œæœ€åæ‰è°ˆä¼˜åŒ–ã€‚

---

## 4. C++æ ¸å¿ƒä»£ç å®ç°èµæ

**é€šç”¨æ ¸å¿ƒå®ç°å‚è€ƒ**  
*è¯´æ˜*ï¼šç»¼åˆ 251Sec ä»£ç ï¼Œå»æ‰å†—ä½™æ³¨é‡Šï¼Œä¿ç•™æœ€æ¸…æ™°çš„æ ¸å¿ƒé€»è¾‘ã€‚  
```cpp
#include <bits/stdc++.h>
using namespace std;
using ll = long long;

const int MAXN = 35, MAXV = 905;
const int dx[8] = {2,2,-2,-2,1,1,-1,-1};
const int dy[8] = {1,-1,1,-1,2,-2,2,-2};

int m, n, P;
int mp[MAXV], id(int x,int y){ return (x-1)*n + (y-1); }

struct Edge { int v, w, nxt; } e[20005];
int head[MAXV], tot = 0;
void add(int u,int v,int w){
    e[++tot] = {v,w,head[u]}; head[u] = tot;
}

int sx, sy, tx, ty;
bool vis[MAXV], mkd[MAXV];

// å»ºå›¾ï¼šä»(rx,ry)å‡ºå‘ï¼ŒæŠŠæ‰€æœ‰å¯è¾¾ç‚¹è¿è¾¹
void dfs(int x,int y,int rx,int ry){
    vis[id(x,y)] = true;
    for(int k=0;k<8;k++){
        int nx = x + dx[k], ny = y + dy[k];
        if(nx<1||nx>m||ny<1||ny>n) continue;
        int nid = id(nx,ny);
        if(mp[nid]==0){                // æ°´
            if(!mkd[nid]) add(id(rx,ry), nid, 1);
        }else if(mp[nid]==4){          // å²©çŸ³
            if(!mkd[nid]) add(id(rx,ry), nid, 0);
        }else if(mp[nid]==5){          // é“‚é‡‘
            if(!mkd[nid]) add(id(rx,ry), nid, 2);
        }else if(mp[nid]==1){          // è²èŠ±
            if(!vis[nid]) dfs(nx,ny,rx,ry);
        }
        mkd[nid] = true;
    }
}

int d[MAXV], pt[MAXV];          // d:æœ€çŸ­è·¯é•¿åº¦  pt:æœ€å¤§é“‚é‡‘
ll  f[MAXV], g[MAXV];           // f:æœ€çŸ­è·¯æ–¹æ¡ˆæ•° g:æœ€å¤§é“‚é‡‘æ–¹æ¡ˆæ•°
struct Node{ int u, dis; bool operator<(const Node&o)const{ return dis>o.dis; } };

void dijkstra(){
    priority_queue<Node> pq;
    memset(d, 0x3f, sizeof d);
    int sid = id(sx,sy);
    d[sid] = 0; f[sid] = 1; g[sid] = 1; pt[sid] = 0;
    pq.push({sid,0});
    while(!pq.empty()){
        int u = pq.top().u; pq.pop();
        for(int i=head[u]; i; i=e[i].nxt){
            int v = e[i].v, w = e[i].w;
            if(d[v] == d[u]+w){
                f[v] += f[u];
                int npt = pt[u] + (w==2);
                if(npt == pt[v]) g[v] += g[u];
                else if(npt > pt[v]){ pt[v] = npt; g[v] = g[u]; }
            }else if(d[v] > d[u]+w){
                d[v] = d[u]+w;
                f[v] = f[u];
                pt[v] = pt[u] + (w==2);
                g[v] = g[u];
                pq.push({v,d[v]});
            }
        }
    }
}

int main(){
    scanf("%d%d%d",&P,&m,&n);
    for(int i=1;i<=m;i++)
        for(int j=1;j<=n;j++){
            scanf("%d",&mp[id(i,j)]);
            if(mp[id(i,j)]==3){ sx=i; sy=j; mp[id(i,j)]=0; }
            if(mp[id(i,j)]==4){ tx=i; ty=j; }
        }
    // å»ºå›¾
    for(int i=1;i<=m;i++)
        for(int j=1;j<=n;j++){
            memset(vis,0,sizeof vis);
            memset(mkd,0,sizeof mkd);
            if(mp[id(i,j)]==0 || mp[id(i,j)]==5) dfs(i,j,i,j);
        }
    dijkstra();
    int tid = id(tx,ty);
    if(d[tid] > P){ puts("-1"); return 0; }
    printf("%d %lld\n", d[tid], f[tid]);
    if(pt[tid]==0){ puts("-1"); return 0; }
    printf("%d %lld\n", pt[tid], g[tid]);
    return 0;
}
```

---

## 5. ç®—æ³•å¯è§†åŒ–ï¼šåƒç´ åŠ¨ç”»æ¼”ç¤º

* **ä¸»é¢˜**ï¼š8-bit â€œè²èŠ±è·³è·ƒå¤§å†’é™©â€  
* **åœºæ™¯**ï¼š30Ã—30 åƒç´ ç½‘æ ¼ï¼Œè“=æ°´ï¼Œç»¿=è²èŠ±ï¼Œç°=å²©çŸ³ï¼Œé‡‘=é“‚é‡‘ï¼Œå¥¶ç‰›åƒç´ å°äººåœ¨èµ·ç‚¹ã€‚  
* **æ¼”ç¤ºæ ¸å¿ƒ**ï¼šDijkstra çš„â€œåƒç´ ä¼˜å…ˆé˜Ÿåˆ—â€å¦‚ä½•ä¸€æ­¥æ­¥æ‰©å±•æœ€çŸ­è·¯å¾„ã€‚  

**åŠ¨ç”»æ­¥éª¤è®¾è®¡**  
1. **åˆå§‹åŒ–**ï¼šç½‘æ ¼åŠ è½½ï¼Œå¥¶ç‰›åœ¨ `(sx,sy)` é—ªçƒã€‚  
2. **å»ºå›¾é—ªå…‰**ï¼šä»å¥¶ç‰›è„šä¸‹å°„å‡º 8 æ–¹å‘åƒç´ ç®­å¤´ï¼Œç¢°åˆ°æ°´â†’è“ç®­å¤´(è¾¹æƒ1)ï¼Œç¢°åˆ°é“‚é‡‘â†’é‡‘ç®­å¤´(è¾¹æƒ2)ã€‚  
3. **Dijkstra é˜Ÿåˆ—**ï¼šå³ä¾§ç«–æ¡æ˜¾ç¤ºâ€œåƒç´ å †â€ï¼ŒèŠ‚ç‚¹æŒ‰è·ç¦»å‡åºæ’é˜Ÿï¼Œå½“å‰å¼¹å‡ºèŠ‚ç‚¹é«˜äº®çº¢æ¡†ã€‚  
4. **æ¾å¼›åŠ¨ç”»**ï¼š  
   - è‹¥ `d[v]` æ›´æ–° â†’ èŠ‚ç‚¹ v é—ªç™½å…‰ï¼Œè·ç¦»æ•°å­—æ»šåŠ¨åˆ°æ›´å°å€¼ï¼Œä¼´éšâ€œå®â€éŸ³æ•ˆã€‚  
   - è‹¥ `f[v]` ç´¯åŠ  â†’ èŠ‚ç‚¹ v å‡ºç°åƒç´ â€œ+1â€æ°”æ³¡ã€‚  
   - è‹¥ `pt[v]` æ›´æ–° â†’ èŠ‚ç‚¹ v å˜æˆé‡‘è‰²è¾¹æ¡†ï¼Œä¼´éšâ€œé‡‘å¸â€éŸ³æ•ˆã€‚  
5. **ç»ˆç‚¹è¾¾æˆ**ï¼šå¥¶ç‰›åƒç´ å°äººè·³åˆ° `(tx,ty)`ï¼Œå±å¹•å‡ºç° 8-bit â€œVictory!â€ æ¨ªå¹…ï¼ŒåŒæ—¶å±•ç¤ºç­”æ¡ˆå››å…ƒç»„ã€‚  

* **äº¤äº’**ï¼šæä¾›â€œå•æ­¥ / è‡ªåŠ¨ / è°ƒé€Ÿâ€æŒ‰é’®ï¼›æ”¯æŒâ€œæ˜¾ç¤ºè·¯å¾„å›æº¯â€æ¨¡å¼ï¼Œç”¨é»„è‰²åƒç´ è½¨è¿¹é«˜äº®æœ€çŸ­è·¯å¾„ã€‚

---

## 6. æ‹“å±•ç»ƒä¹ ä¸ç›¸ä¼¼é—®é¢˜æ€è€ƒ

* **é€šç”¨å¥—è·¯è¿ç§»**ï¼š  
  1. **æ£‹ç›˜ â†’ å›¾**ï¼šé©¬æ­¥ã€è±¡æ­¥ã€è½¦æ­¥ç­‰æ£‹ç›˜ç§»åŠ¨ï¼Œéƒ½å¯å…ˆå»ºå›¾å†ç”¨æœ€çŸ­è·¯ / ç½‘ç»œæµã€‚  
  2. **å¤šç›®æ ‡æœ€çŸ­è·¯**ï¼šæ±‚æœ€çŸ­ + è®¡æ•° + é™„åŠ æœ€å€¼ï¼ˆå¦‚æœ€å¤§æ”¶ç›Šã€æœ€å°‘è½¬å¼¯ï¼‰ï¼Œç»Ÿä¸€åœ¨æ¾å¼›é˜¶æ®µç»´æŠ¤é¢å¤–ç»´åº¦å³å¯ã€‚  
  3. **åˆ†å±‚å›¾æ€æƒ³**ï¼šæŠŠâ€œå¼€é‡‡åå†èµ°â€çœ‹ä½œä¸¤å±‚èŠ‚ç‚¹ï¼Œè¾¹æƒè·¨å±‚ï¼›æœ¬é¢˜ç”¨è¾¹æƒ 2 å³å¯ç­‰ä»·å®ç°ã€‚

* **æ´›è°·æ¨è**  
  1. **P1606 è²èŠ±æ± ** â€”â€” æœ¬é¢˜å¼±åŒ–ç‰ˆï¼Œç»ƒæ‰‹å»ºå›¾ + æœ€çŸ­è·¯ã€‚  
  2. **P1144 æœ€çŸ­è·¯è®¡æ•°** â€”â€” çº¯è®¡æ•°ï¼Œæ— é™„åŠ ç»´åº¦ï¼Œé€‚åˆå·©å›ºæ¾å¼›æ—¶ç´¯åŠ æ–¹æ¡ˆæ•°ã€‚  
  3. **P4568 æ—…è¡Œè·¯çº¿** â€”â€” åˆ†å±‚å›¾æœ€çŸ­è·¯ï¼Œä½“ä¼šâ€œåˆ†å±‚â€ä¸â€œé™„åŠ ç»´åº¦â€å¼‚æ›²åŒå·¥ä¹‹å¦™ã€‚

---

## 7. å­¦ä¹ å¿ƒå¾—ä¸ç»éªŒåˆ†äº«

251Sec åœ¨é¢˜è§£ä¸­è½»ææ·¡å†™ä¸€å¥ *â€œæ‰€ä»¥æˆ‘æ˜¨å¤©ä¸ºä»€ä¹ˆé—²çš„æ²¡äº‹åœ¨é‚£é‡Œæ•² A*â€* â€”â€” è¿™æé†’æˆ‘ä»¬ï¼š  
> é¢å¯¹ 30Ã—30 å°å›¾ï¼Œ**ä¼˜å…ˆé€‰æ‹©å¤æ‚åº¦æ­£ç¡®ä¸”å®ç°ç®€æ´çš„ç®—æ³•**ï¼ˆDijkstraï¼‰ï¼Œè€Œéç›²ç›®ä¸Šé«˜çº§æœç´¢ã€‚  
> å…ˆæŠŠé—®é¢˜å»ºæ¨¡å‡†ç¡®ï¼Œå†è°ˆä¼˜åŒ–ï¼Œæ‰æ˜¯é«˜æ•ˆå¤‡èµ›çš„æ­£ç¡®å§¿åŠ¿ã€‚

---

<conclusion>
ä»Šå¤©æˆ‘ä»¬ä»â€œåƒç´ æ± å¡˜â€ä¸€è·¯è·³åˆ°â€œæœ€çŸ­è·¯ä¹‹å·…â€ã€‚è®°ä½ï¼š  
1. æ£‹ç›˜é¢˜å…ˆæ‹å¹³æˆå›¾ï¼›2. æœ€çŸ­è·¯å¯æºå¸¦â€œå¤–æŒ‚ç»´åº¦â€ï¼›3. é€‰å¯¹ç®—æ³•ï¼Œå†è°ˆèŠ±å¼ä¼˜åŒ–ã€‚  
ä¸‹æ¬¡æ¢é™©è§ï¼ğŸ’ª
</conclusion>

---
å¤„ç†ç”¨æ—¶ï¼š69.66ç§’
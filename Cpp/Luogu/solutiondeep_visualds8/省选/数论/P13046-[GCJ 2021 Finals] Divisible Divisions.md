# é¢˜ç›®ä¿¡æ¯

# [GCJ 2021 Finals] Divisible Divisions

## é¢˜ç›®æè¿°

æˆ‘ä»¬æœ‰ä¸€ä¸ªç”±åè¿›åˆ¶æ•°å­—ç»„æˆçš„å­—ç¬¦ä¸² $\mathbf{S}$ã€‚$\mathbf{S}$ çš„ä¸€ä¸ª**åˆ†å‰²**æ˜¯é€šè¿‡å°† $\mathbf{S}$ åˆ’åˆ†ä¸ºè¿ç»­çš„è‹¥å¹²å­ä¸²å¾—åˆ°çš„ã€‚ä¾‹å¦‚ï¼Œè‹¥ $\mathbf{S}$ ä¸º `0145217`ï¼Œåˆ™ä¸¤ç§å¯èƒ½çš„åˆ†å‰²ä¸º `014 5 21 7` å’Œ `0 14 52 17`ã€‚æ¯ä¸ªæ•°å­—å¿…é¡»æ°å¥½å‡ºç°åœ¨ä¸€ä¸ªå­ä¸²ä¸­ï¼Œä¸”æ¯ä¸ªå­ä¸²å¿…é¡»éç©ºã€‚å¦‚æœ $\mathbf{S}$ æœ‰ $L$ ä¸ªæ•°å­—ï¼Œåˆ™å®ƒå…±æœ‰ $2^{L-1}$ ç§å¯èƒ½çš„åˆ†å‰²æ–¹å¼ã€‚

ç»™å®šä¸€ä¸ªæ­£æ•´æ•° $\mathbf{D}$ï¼Œè‹¥ $\mathbf{S}$ çš„æŸä¸ªåˆ†å‰²æ»¡è¶³ï¼šå¯¹äºä»»æ„ä¸¤ä¸ªç›¸é‚»çš„å­ä¸²ï¼Œå®ƒä»¬è¡¨ç¤ºçš„åè¿›åˆ¶æ•´æ•°ä¸­è‡³å°‘æœ‰ä¸€ä¸ªèƒ½è¢« $\mathbf{D}$ æ•´é™¤ï¼Œåˆ™ç§°è¯¥åˆ†å‰²æ˜¯**å¯è¢« $\mathbf{D}$ æ•´é™¤çš„**ã€‚è‹¥ $\mathbf{D}=7$ï¼Œä¸Šè¿°ç¬¬ä¸€ä¸ªç¤ºä¾‹åˆ†å‰²æ˜¯å¯è¢«æ•´é™¤çš„ï¼Œå› ä¸º `014`ã€`21` å’Œ `7` è¡¨ç¤ºçš„æ•´æ•°å‡èƒ½è¢« 7 æ•´é™¤ã€‚ç¬¬äºŒä¸ªç¤ºä¾‹åˆ†å‰²ä¸å¯è¢«æ•´é™¤ï¼Œå› ä¸º `52` å’Œ `17` æ˜¯ç›¸é‚»å­ä¸²ä¸”å‡ä¸èƒ½è¢« 7 æ•´é™¤ã€‚å°† `0145217` åˆ†å‰²ä¸º `0145217`ï¼ˆå³ä¸åˆ†å‰²ï¼‰å¯¹ä»»æ„ $\mathbf{D}$ éƒ½æ˜¯å¯è¢«æ•´é™¤çš„ï¼Œå› ä¸ºæ­¤æ—¶ä¸å­˜åœ¨ç›¸é‚»å­ä¸²å¯¹ã€‚

ç»™å®š $\mathbf{S}$ å’Œ $\mathbf{D}$ï¼Œç»Ÿè®¡ $\mathbf{S}$ çš„å¯è¢« $\mathbf{D}$ æ•´é™¤çš„åˆ†å‰²æ•°é‡ã€‚ç”±äºç»“æœå¯èƒ½éå¸¸å¤§ï¼Œåªéœ€è¾“å‡ºå…¶å¯¹è´¨æ•° $10^{9}+7$ï¼ˆå³ $1000000007$ï¼‰å–æ¨¡åçš„ä½™æ•°ã€‚


## è¯´æ˜/æç¤º

**æ ·ä¾‹è§£é‡Š**

åœ¨æ ·ä¾‹ #1 ä¸­ï¼Œ$\mathbf{S}$ çš„æ‰€æœ‰ 16 ç§å¯è¢« 7 æ•´é™¤çš„åˆ†å‰²ä¸ºï¼š

- 0145217,
- 0 145217,
- 0 14 5217,
- 0 14 5 217,
- 0 14 5 21 7,
- 0 14 521 7,
- 0 145 217,
- 0 145 21 7,
- 0 14521 7,
- 014 5217,
- 014 5 217,
- 014 5 21 7,
- 014 521 7,
- 0145 217,
- 0145 21 7, å’Œ
- 014521 7.

åœ¨æ ·ä¾‹ #2 ä¸­ï¼Œå…±æœ‰ $2^{5}=32$ ç§åˆ†å‰²æ–¹å¼ã€‚è‹¥è¦ä½¿ä¸¤ä¸ªç›¸é‚»å­ä¸²å‡ä¸è¢« 10 æ•´é™¤ï¼Œåˆ™è¿™ä¸¤ä¸ªå­ä¸²çš„æœ«å°¾å‡ä¸èƒ½ä¸º 0ã€‚å”¯ä¸€æ»¡è¶³æ­¤æ¡ä»¶çš„åˆ†å‰²æ˜¯ `1 001 00` å’Œ `1 001 0 0`ï¼Œå› æ­¤å…¶ä½™ 30 ç§åˆ†å‰²å‡æ˜¯å¯è¢« 10 æ•´é™¤çš„ã€‚

åœ¨æ ·ä¾‹ #3 ä¸­ï¼Œæ²¡æœ‰ä»»ä½•å­ä¸²è¡¨ç¤ºçš„æ•´æ•°æ˜¯å¶æ•°ï¼ˆå³æ— æ³•è¢« 12 æ•´é™¤ï¼‰ã€‚å› æ­¤ï¼Œå”¯ä¸€é¿å…ä¸¤ä¸ªç›¸é‚»å­ä¸²å‡ä¸è¢« 12 æ•´é™¤çš„æ–¹å¼æ˜¯ä¸è¿›è¡Œä»»ä½•åˆ†å‰²ï¼Œå³ä»…æœ‰ä¸€ç§åˆ†å‰²ï¼š`5555`ã€‚

**æ•°æ®èŒƒå›´**

- $1 \leq \mathbf{T} \leq 100$ã€‚
- $1 \leq \mathbf{D} \leq 10^{6}$ã€‚

**æµ‹è¯•é›† 1ï¼ˆ10 åˆ†ï¼Œå¯è§åˆ¤å®šï¼‰**

- $1 \leq \mathbf{S}$ çš„é•¿åº¦ $\leq 1000$ã€‚

**æµ‹è¯•é›† 2ï¼ˆ35 åˆ†ï¼Œéšè—åˆ¤å®šï¼‰**

- $1 \leq \mathbf{S}$ çš„é•¿åº¦ $\leq 10^{5}$ã€‚

ç¿»è¯‘ç”± DeepSeek V3 å®Œæˆ

## æ ·ä¾‹ #1

### è¾“å…¥

```
3
0145217 7
100100 10
5555 12```

### è¾“å‡º

```
Case #1: 16
Case #2: 30
Case #3: 1```

# AIåˆ†æç»“æœ

---
# ğŸ’¡ æ´›è¯­äº‘ç¬ºçš„C++ç®—æ³•è§£æï¼šDivisible Divisions æ·±å…¥å­¦ä¹ æŒ‡å— ğŸ’¡

ä»Šå¤©æˆ‘ä»¬æ¥ä¸€èµ·åˆ†æ Google Code Jam 2021 Final çš„ **Divisible Divisions**ã€‚è¿™ä¸ä»…ä»…æ˜¯ä¸€æ¬¡è§£é¢˜ï¼Œæ›´æ˜¯ä¸€åœºæ€ç»´çš„æ¢é™©ã€‚æˆ‘ä»¬è¦å­¦ä¼šï¼š  
1ï¸âƒ£ æŠŠâ€œå¯è¢« D æ•´é™¤çš„åˆ†å‰²â€è¿™ä¸€æŠ½è±¡æ¡ä»¶ç¿»è¯‘æˆæ•°å­¦è¯­è¨€ï¼›  
2ï¸âƒ£ ç”¨åŠ¨æ€è§„åˆ’æŠŠæŒ‡æ•°çº§æšä¸¾å‹ç¼©åˆ°çº¿æ€§æˆ–çº¿æ€§å¯¹æ•°çº§ï¼›  
3ï¸âƒ£ å¤„ç†â€œæ¨¡ D åŒä½™â€æ—¶ï¼Œå¦‚ä½•æŠŠ 2ã€5 å› å­å¸¦æ¥çš„éº»çƒ¦ä¼˜é›…åœ°æ‹†è§£æ‰ã€‚

---

## 1. é¢˜ç›®è§£è¯»ä¸ç­–ç•¥åˆæ¢

âœ¨ **æœ¬é¢˜æ ¸å¿ƒæŒ‘æˆ˜**ï¼š  
> åœ¨æŒ‡æ•°çº§ï¼ˆ2^{L-1}ï¼‰çš„åˆ†å‰²æ–¹æ¡ˆä¸­ï¼Œ**å¿«é€Ÿ**ç»Ÿè®¡æ»¡è¶³â€œä»»æ„ç›¸é‚»ä¸¤æ®µè‡³å°‘æœ‰ä¸€æ®µèƒ½è¢« D æ•´é™¤â€çš„æ–¹æ¡ˆæ•°ã€‚

âœ¨ **æ ¸å¿ƒç®—æ³•æ ‡ç­¾**ï¼š  
åŠ¨æ€è§„åˆ’(DP) Â· æ¨¡è¿ç®—æ€§è´¨ Â· æ•°è®ºæ‹†è§£

---

ğŸ—£ï¸ **åˆæ­¥åˆ†æ**  
- æš´åŠ›æšä¸¾æ‰€æœ‰ 2^{L-1} ç§åˆ†å‰² â†’ ä¸å¯è¡Œï¼ˆL â‰¤ 1e5ï¼‰ã€‚  
- ç›¸é‚»ä¸¤æ®µâ€œè‡³å°‘ä¸€æ®µèƒ½è¢« D æ•´é™¤â€ â‡” **ä¸å­˜åœ¨è¿ç»­ä¸¤æ®µéƒ½ä¸èƒ½è¢« D æ•´é™¤**ã€‚  
- äºæ˜¯å¯ä»¥æŠŠé—®é¢˜è½¬åŒ–ä¸ºï¼š  
  **æ€»æ–¹æ¡ˆæ•° 2^{L-1} å‡å»â€œå­˜åœ¨è‡³å°‘ä¸€å¯¹ç›¸é‚»æ®µéƒ½ä¸èƒ½è¢« D æ•´é™¤â€çš„æ–¹æ¡ˆæ•°**ï¼Ÿ  
  ä½†â€œå­˜åœ¨â€éš¾ç»Ÿè®¡ï¼Œä¸å¦‚ç›´æ¥ **DP è®¡æ•°æ»¡è¶³æ¡ä»¶çš„åˆ†å‰²**ã€‚

---

### ğŸ” ç®—æ³•ä¾¦æ¢ï¼šå¦‚ä½•åœ¨é¢˜ç›®ä¸­å‘ç°çº¿ç´¢ï¼Ÿ

| çº¿ç´¢ | ä¾¦æ¢ç¬”è®° |
|---|---|
| **çº¿ç´¢1ï¼šè®¡æ•° + çº¦æŸ** | â€œç»Ÿè®¡â€¦æ»¡è¶³â€¦çš„åˆ†å‰²â€ â‡’ **è®¡æ•°å‹ DP** |
| **çº¿ç´¢2ï¼šç›¸é‚»æ®µçº¦æŸ** | çº¦æŸåªä¸ **æœ€åä¸€æ®µ** å’Œ **å€’æ•°ç¬¬äºŒæ®µ** æœ‰å…³ â‡’ **çº¿æ€§ DPï¼Œç»´åº¦åªéœ€è®°å½•ä¸Šä¸€æ®µçŠ¶æ€** |
| **çº¿ç´¢3ï¼šæ•´é™¤åˆ¤å®š** | éœ€è¦å¿«é€Ÿåˆ¤æ–­ä¸€æ®µå­ä¸² mod D â‡’ **å‰ç¼€ mod æ•°ç»„** |
| **çº¿ç´¢4ï¼šgcd(D,10) å¯èƒ½ â‰  1** | 10 çš„é€†å…ƒå¯èƒ½ä¸å­˜åœ¨ â‡’ **æŠŠ D æ‹†æˆ 2^aÂ·5^bÂ·d'ï¼Œåˆ†ç±»è®¨è®º** |

---

### ğŸ§  æ€ç»´é“¾æ„å»ºï¼šä»çº¿ç´¢åˆ°ç­–ç•¥

> 1. é¦–å…ˆï¼Œã€çº¿ç´¢1ã€‘å‘Šè¯‰æˆ‘ä»¬è¿™æ˜¯è®¡æ•°é—®é¢˜ï¼ŒDP æ˜¯é¦–é€‰ã€‚  
> 2. ã€çº¿ç´¢2ã€‘æš—ç¤ºæˆ‘ä»¬åªéœ€è®°å½•â€œä¸Šä¸€æ®µæ˜¯å¦è¢« D æ•´é™¤â€è¿™ä¸€ç»´çŠ¶æ€å³å¯ã€‚  
> 3. ã€çº¿ç´¢3ã€‘è®©æˆ‘ä»¬ç”¨å‰ç¼€æ•°ç»„ `pre[i] = (S[1..i] mod D)`ï¼Œäºæ˜¯å­ä¸² `S[l..r]` çš„å€¼ä¸º `(pre[r] - pre[l-1]*10^{r-l+1}) mod D`ã€‚  
> 4. ã€çº¿ç´¢4ã€‘æé†’æˆ‘ä»¬ï¼šå½“ gcd(D,10)>1 æ—¶ï¼Œ10 æ²¡æœ‰é€†å…ƒï¼Œéœ€è¦ **æŠŠ D æ‹†æˆ 2^aÂ·5^bÂ·d'**ï¼Œç„¶ååˆ©ç”¨  
>    - è‹¥æ®µé•¿ â‰¥ max(a,b)ï¼Œåˆ™ 10^{len} â‰¡ 0 (mod 2^aÂ·5^b)ï¼Œæ¡ä»¶åŒ–ç®€ï¼›  
>    - è‹¥æ®µé•¿ < max(a,b)ï¼Œæš´åŠ›æšä¸¾ï¼ˆé•¿åº¦ â‰¤ log Dï¼‰ã€‚  
> 5. **ç»“è®º**ï¼šç”¨ **dp[i][0/1]** è¡¨ç¤ºå‰ i ä½ã€æœ€åä¸€æ®µ **ä¸èƒ½/èƒ½** è¢« D æ•´é™¤æ—¶çš„æ–¹æ¡ˆæ•°ï¼Œç»“åˆå‰ç¼€å“ˆå¸Œæ¡¶å³å¯åšåˆ° **O(L log D)**ã€‚

---

## 2. ç²¾é€‰ä¼˜è´¨é¢˜è§£å‚è€ƒ

**é¢˜è§£ä¸€ï¼šPurslaneï¼ˆ4èµï¼‰**  
- **äº®ç‚¹**  
  - æŠŠ D æ‹†æˆ 2^aÂ·5^bÂ·d' çš„â€œé€šç”¨å¥—è·¯â€å†™å¾—å¹²å‡€åˆ©è½ï¼›  
  - ç”¨ `unordered_map` ç»´æŠ¤ `10^{-i}Â·pre[i] mod d'` çš„æ¡¶ï¼Œå®ç° O(1) è½¬ç§»ï¼›  
  - è¾¹ç•Œå¤„ç†ä¸¥è°¨ï¼šå½“ `i-j â‰¤ logD` æ—¶æš´åŠ›ï¼Œ`else` æ—¶åˆ©ç”¨æ¡¶ï¼Œå¤æ‚åº¦ä¸¥æ ¼ O(L)ã€‚  
- **å­¦ä¹ è¦ç‚¹**  
  æ•°è®ºæ‹†è§£ + åˆ†ç±»è®¨è®º + å“ˆå¸Œæ¡¶ä¼˜åŒ–ã€‚

**é¢˜è§£äºŒï¼šP2441Mï¼ˆ1èµï¼‰**  
- **äº®ç‚¹**  
  - ä¸ Purslane æ€è·¯ä¸€è‡´ï¼Œä½†ä»£ç é£æ ¼æ›´ç´§å‡‘ï¼›  
  - ç”¨ `max(c,1)` å¤„ç†è¾¹ç•Œï¼Œé¿å… 0 é•¿åº¦æ®µï¼›  
  - è°ƒè¯•ç»éªŒï¼šå¿˜è®°æŠŠå­—ç¬¦æ•°å­—å…ˆæ¨¡ Dï¼Œå¯¼è‡´å° D æ—¶å‡ºé”™â€”â€”æé†’æˆ‘ä»¬å¯¹è¾“å…¥æ•°å­—å…ˆæ¨¡ D çš„é‡è¦æ€§ã€‚  

**é¢˜è§£ä¸‰ï¼šIniaugotyï¼ˆ1èµï¼‰**  
- **äº®ç‚¹**  
  - å¼•å…¥ CRTï¼ˆä¸­å›½å‰©ä½™å®šç†ï¼‰è§†è§’ï¼Œä½†æœ¬è´¨ä¸Šä»æ˜¯åŒä¸€æ‹†è§£ï¼›  
  - ä»£ç é‡Œç”¨æ•°ç»„ `h`ã€`r` ä»£æ›¿å“ˆå¸Œæ¡¶ï¼Œå¸¸æ•°æ›´å°ï¼›  
  - å¼ºè°ƒâ€œéšæœºå¼€é¢˜â€ä¹Ÿèƒ½å‘½ä¸­ç»å…¸å¥—è·¯ï¼Œé¼“åŠ±å¤§å®¶å¤šåˆ·é¢˜ç§¯ç´¯æ¨¡å‹ã€‚

---

## 3. è§£é¢˜ç­–ç•¥æ·±åº¦å‰–æ

### ğŸ¯ æ ¸å¿ƒéš¾ç‚¹ä¸å…³é”®æ­¥éª¤ï¼ˆæœ€ä¼˜è§£æ³•ï¼‰

| å…³é”®ç‚¹ | åˆ†æ | å­¦ä¹ ç¬”è®° |
|---|---|---|
| **1. çŠ¶æ€è®¾è®¡** | `dp[i][0/1]`ï¼šå‰ i ä½ï¼Œæœ€åä¸€æ®µ **ä¸èƒ½/èƒ½** è¢« D æ•´é™¤ | åªéœ€è®°å½•â€œä¸Šä¸€æ®µâ€çŠ¶æ€ï¼Œçº¿æ€§ DP çš„ç»å…¸æŠ€å·§ |
| **2. æ•´é™¤åˆ¤å®š** | å­ä¸² `S[l..r]` çš„å€¼ä¸º `(pre[r] - pre[l-1]*pw[r-l+1]) mod D` | å‰ç¼€ mod + 10 çš„å¹‚æ•°ç»„ |
| **3. æ•°è®ºæ‹†è§£** | æŠŠ D å†™æˆ 2^aÂ·5^bÂ·d'ï¼Œåˆ†ç±»è®¨è®ºæ®µé•¿ | å½“ gcd(D,10)â‰ 1 æ—¶ï¼Œè¿™æ˜¯å¿…ç»ä¹‹è·¯ |
| **4. æ¡¶ä¼˜åŒ–** | ç”¨å“ˆå¸Œ/æ•°ç»„ç»´æŠ¤ `10^{-i}Â·pre[i] mod d'` çš„å‡ºç°æ¬¡æ•° | æŠŠ O(L^2) é™ä¸º O(L log D) |

---

### âœ¨ è§£é¢˜æŠ€å·§æ€»ç»“

- **æŠ€å·§Aï¼šå‰ç¼€ mod æ•°ç»„**  
  æŠŠå­ä¸²æ•°å€¼é—®é¢˜è½¬åŒ–ä¸ºåŒºé—´ mod å·®åˆ†ï¼Œé¿å…é«˜ç²¾åº¦ã€‚
- **æŠ€å·§Bï¼šæ•°è®ºæ‹†è§£**  
  å½“æ¨¡æ•°ä¸åº•æ•°ä¸äº’è´¨æ—¶ï¼Œæ‹†å› å­ â†’ åˆ†æ®µè®¨è®º â†’ é™ä½å¤æ‚åº¦ã€‚
- **æŠ€å·§Cï¼šå“ˆå¸Œæ¡¶è®¡æ•°**  
  å°†â€œåŒä½™â€æ¡ä»¶æ˜ å°„åˆ°æ¡¶ï¼Œå®ç° O(1) æŸ¥è¯¢ä¸æ›´æ–°ã€‚

---

### âš”ï¸ ç­–ç•¥ç«æŠ€åœºï¼šä¸åŒè§£æ³•å¯¹æ¯”

| ç­–ç•¥ | æ ¸å¿ƒæ€æƒ³ | ä¼˜ç‚¹ | ç¼ºç‚¹ | å¾—åˆ†é¢„æœŸ |
|---|---|---|---|---|
| **æš´åŠ›æšä¸¾** | DFS æšä¸¾ 2^{L-1} ç§åˆ†å‰² | æ€è·¯ç›´è§‚ | O(2^L) ä¸å¯æ¥å— | 10 åˆ†ï¼ˆLâ‰¤20ï¼‰ |
| **æœ´ç´  DP** | O(L^2) æšä¸¾ä¸Šä¸€æ®µ | æ˜“å†™ | L=1e5 æ—¶ 1e10 è¿ç®— | 35 åˆ†ï¼ˆå°æ•°æ®ï¼‰ |
| **æ•°è®ºä¼˜åŒ– DP** | æ‹† D + æ¡¶ä¼˜åŒ– | O(L log D) é€šè¿‡ | éœ€è¦æ•°è®ºçŸ¥è¯† | 100 åˆ† |

---

### âœ¨ ä¼˜åŒ–ä¹‹æ—…ï¼šä»â€œèƒ½åšâ€åˆ°â€œåšå¥½â€

> èµ·ç‚¹ï¼šO(L^2) æš´åŠ› DP  
> ç“¶é¢ˆï¼šæšä¸¾ä¸Šä¸€æ®µä½ç½® j å¤ªè€—æ—¶  
> é’¥åŒ™ï¼šæŠŠåŒä½™å¼ `10^{i-j}Â·pre[j-1] â‰¡ pre[i]` å˜å½¢ä¸º `10^{-j+1}Â·pre[j-1] â‰¡ 10^{-i}Â·pre[i]`  
> å‡åï¼šç”¨å“ˆå¸Œæ¡¶ç»´æŠ¤å·¦è¾¹ï¼Œå³å¯ O(1) æŸ¥è¯¢æ‰€æœ‰æ»¡è¶³æ¡ä»¶çš„ j

---

## 4. C++æ ¸å¿ƒä»£ç å®ç°èµæ

**æœ¬é¢˜é€šç”¨æ ¸å¿ƒC++å®ç°å‚è€ƒ**  
> ç»¼åˆ Purslane ä¸ Iniaugoty çš„å†™æ³•ï¼Œæ‹† D + æ¡¶ä¼˜åŒ–ï¼Œçº¿æ€§å¯¹æ•°å¤æ‚åº¦ã€‚

```cpp
#include <bits/stdc++.h>
using namespace std;
typedef long long ll;
const ll MOD = 1e9 + 7;

ll inv(ll a, ll m) {
    ll x = 1, y = 0, m0 = m;
    while (a > 1) {
        ll q = a / m;
        tie(x, y) = make_tuple(y, x - q * y);
        tie(a, m) = make_tuple(m, a - q * m);
    }
    return (x % m0 + m0) % m0;
}

void solve() {
    int T; cin >> T;
    for (int tc = 1; tc <= T; ++tc) {
        string S; ll D; cin >> S >> D;
        int n = S.size();
        vector<ll> pre(n + 1), pow10(n + 1);
        pre[0] = 0; pow10[0] = 1;
        for (int i = 1; i <= n; ++i) {
            pre[i] = (pre[i - 1] * 10 + (S[i - 1] - '0')) % D;
            pow10[i] = pow10[i - 1] * 10 % D;
        }

        // æ‹†è§£ D = 2^a * 5^b * d'
        ll d2 = 1, d5 = 1, d0 = D;
        while (d0 % 2 == 0) d0 /= 2, d2 *= 2;
        while (d0 % 5 == 0) d0 /= 5, d5 *= 5;
        ll d_clean = d0;
        ll c = max({__builtin_ctzll(D), 0}) + max({__builtin_ctzll(D / d2), 0});

        ll inv10 = inv(10, d_clean);
        vector<ll> inv10pow(n + 1);
        inv10pow[0] = 1;
        for (int i = 1; i <= n; ++i)
            inv10pow[i] = inv10pow[i - 1] * inv10 % d_clean;

        vector<ll> f(n + 1), g(n + 1); // f[i]: æœ€åä¸€æ®µèƒ½è¢« D æ•´é™¤
        f[0] = 1; g[0] = 0;
        unordered_map<ll, ll> cnt0, cnt1;
        cnt0[0] = 1;

        ll sum1 = 0; // æ‰€æœ‰ g[j] çš„å’Œï¼Œç”¨äºé•¿æ®µè½¬ç§»
        for (int i = 1; i <= n; ++i) {
            f[i] = g[i] = 0;

            // çŸ­æ®µæš´åŠ›ï¼šé•¿åº¦ <= c
            for (int j = max(0, i - (int)c); j < i; ++j) {
                ll val = (pre[i] - pre[j] * pow10[i - j] % D + D) % D;
                if (val == 0) {
                    f[i] = (f[i] + f[j] + g[j]) % MOD;
                } else {
                    g[i] = (g[i] + f[j]) % MOD;
                }
            }

            // é•¿æ®µï¼šæ®µé•¿ > cï¼Œåˆ©ç”¨æ¡¶
            if (i > c) {
                ll key = pre[i - c] * inv10pow[i - c] % d_clean;
                if (pre[i] % (d2 * d5) == 0) {
                    f[i] = (f[i] + cnt0[key] + cnt1[key]) % MOD;
                    g[i] = (g[i] + sum1 - cnt1[key] + MOD) % MOD;
                } else {
                    g[i] = (g[i] + sum1) % MOD;
                }
            }

            // æŠŠ i ä½ç½®çš„è´¡çŒ®åŠ å…¥æ¡¶
            if (i >= c) {
                ll key = pre[i] * inv10pow[i] % d_clean;
                cnt0[key] = (cnt0[key] + f[i]) % MOD;
                cnt1[key] = (cnt1[key] + g[i]) % MOD;
                sum1 = (sum1 + g[i]) % MOD;
            }
        }

        ll ans = (f[n] + g[n]) % MOD;
        cout << "Case #" << tc << ": " << ans << '\n';
    }
}

int main() {
    ios::sync_with_stdio(false);
    cin.tie(nullptr);
    solve();
    return 0;
}
```

---

## 5. ç®—æ³•å¯è§†åŒ–ï¼šåƒç´ åŠ¨ç”»æ¼”ç¤º

**æ¼”ç¤ºä¸»é¢˜**ï¼š**â€œæ•°å­—åˆ‡å‰²æœºâ€**  
- åƒç´ é£å·¥å‚ï¼Œä¼ é€å¸¦ä¸Šæ»šåŠ¨å­—ç¬¦ä¸² `S`ï¼Œæœºæ¢°è‡‚æŒ‰è§„åˆ™åˆ‡å‰²ã€‚  
- æ¯åˆ‡ä¸€æ®µï¼Œå±å¹•å³ä¾§å®æ—¶æ˜¾ç¤º `mod D` å€¼ï¼Œå¹¶é«˜äº®â€œåˆæ³• / éæ³•â€é¢œè‰²ã€‚  

**å…³é”®å¸§ä¸äº¤äº’**  
1. **åˆå§‹åŒ–**ï¼š8Ã—8 åƒç´ å­—ç¬¦å—æ‹¼å‡º `S`ï¼Œä¸‹æ–¹æ˜¾ç¤º `pre[i]` è¿›åº¦æ¡ã€‚  
2. **çŸ­æ®µæš´åŠ›**ï¼šæœºæ¢°è‡‚åœ¨ `i-c â€¦ i-1` é—´ä¾æ¬¡æ‰«æï¼Œåƒç´ æ•°å­—é—ªçƒï¼ŒéŸ³æ•ˆâ€œå˜€å˜€â€ã€‚  
3. **é•¿æ®µæ¡¶æŸ¥è¯¢**ï¼šå½“æ®µé•¿ > cï¼Œä¼ é€å¸¦ç¬é—´å¼¹å‡ºâ€œæ¡¶â€å›¾æ ‡ï¼Œæ˜¾ç¤º `key`ï¼Œä¼´éšâ€œå®â€ç¡®è®¤éŸ³ã€‚  
4. **çŠ¶æ€æ›´æ–°**ï¼š`f[i]` ä¸ `g[i]` ä»¥åƒç´ è¡€æ¡å¢é•¿ï¼Œç›´è§‚çœ‹åˆ°æ–¹æ¡ˆæ•°ç´¯åŠ ã€‚  
5. **é€šå…³åº†ç¥**ï¼šç®—æ³•ç»“æŸï¼Œåƒç´ ç¤¼èŠ± + 8-bit èƒœåˆ©éŸ³æ•ˆã€‚

**æŠ€æœ¯æç¤º**  
- Canvas ç”¨ `fillRect` ç»˜åˆ¶åƒç´ å—ï¼›  
- éŸ³æ•ˆå¯ç”¨ Web Audio API ç”Ÿæˆ 8-bit square waveï¼›  
- æ­¥è¿›/è‡ªåŠ¨æ’­æ”¾æŒ‰é’®æ§åˆ¶å¸§ç‡ã€‚

---

## 6. æ‹“å±•ç»ƒä¹ ä¸ç›¸ä¼¼é—®é¢˜æ€è€ƒ

**é€šç”¨å¥—è·¯è¿ç§»**  
- â€œç›¸é‚»ä¸¤æ®µè‡³å°‘ä¸€æ®µæ»¡è¶³æŸæ€§è´¨â€ â‡¨ **DP + å‰ç¼€æ¡¶**  
- é€‚ç”¨åœºæ™¯ï¼š  
  1. ç›¸é‚»åŒºé—´å’Œè‡³å°‘ä¸€æ®µä¸ºå¥‡æ•°ï¼›  
  2. ç›¸é‚»å­ä¸²è‡³å°‘ä¸€æ®µä¸ºå›æ–‡ï¼›  
  3. ç›¸é‚»ä»»åŠ¡è‡³å°‘ä¸€æ®µè€—æ—¶ â‰¤ Kã€‚

**æ´›è°·æ¨è**  
1. **P3956** å®è—  
   - åˆ†ç»„èƒŒåŒ… + æ ‘ä¸Š DPï¼Œç»ƒä¹ â€œä¾èµ–å…³ç³»â€å»ºæ¨¡ã€‚  
2. **P1941** é£æ‰¬çš„å°é¸Ÿ  
   - åŒºé—´ DP + çŠ¶æ€å‹ç¼©ï¼Œä½“éªŒâ€œç›¸é‚»æ®µçº¦æŸâ€çš„å˜å½¢ã€‚  
3. **P2679** å­ä¸²  
   - å­—ç¬¦ä¸² DPï¼Œå¼ºåŒ–å‰ç¼€ä¸æ¡¶ä¼˜åŒ–æŠ€å·§ã€‚

---

## 7. å­¦ä¹ å¿ƒå¾—ä¸ç»éªŒåˆ†äº«

> **P2441M çš„è¸©å‘è®°å½•**ï¼š  
> â€œæˆ‘ä¸€å¼€å§‹æš´åŠ›ä¹Ÿ WAï¼ŒåŸå› æ˜¯å¿˜è®°æŠŠå­—ç¬¦æ•°å­—å…ˆæ¨¡ Dï¼Œå¯¼è‡´å° D æ—¶æº¢å‡ºã€‚â€  
> **ç‚¹è¯„**ï¼šè¾“å…¥æ•°å­—å…ˆå¯¹ D å–æ¨¡ï¼Œæ˜¯å¤„ç†å¤§æ•° mod çš„é€šç”¨å¥½ä¹ æƒ¯ï¼

---

<conclusion>  
Divisible Divisions çš„ç²¾é«“åœ¨äº **æŠŠæ¨¡æ•°æ‹†å¹²å‡€**ï¼Œå†ç”¨ **æ¡¶** æŠŠ O(nÂ²) å‹åˆ° O(n log D)ã€‚è®°ä½ï¼š  
- å…ˆæ‹† 2/5ï¼Œå†è°ˆé€†å…ƒï¼›  
- å…ˆçŸ­æ®µæš´åŠ›ï¼Œå†é•¿æ®µæ¡¶ï¼›  
- å…ˆå­—ç¬¦å–æ¨¡ï¼Œå†å‰ç¼€è®¡ç®—ã€‚  
ä¸‹æ¬¡é‡åˆ°â€œç›¸é‚»æ®µçº¦æŸâ€ï¼Œä¸å¦¨æƒ³æƒ³ä»Šå¤©çš„â€œæ•°å­—åˆ‡å‰²æœºâ€ï¼ğŸ’ª
</conclusion>

---
å¤„ç†ç”¨æ—¶ï¼š105.59ç§’
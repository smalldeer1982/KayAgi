# é¢˜ç›®ä¿¡æ¯

# [NOI2018] å½’ç¨‹

## é¢˜ç›®æè¿°

æœ¬é¢˜çš„æ•…äº‹å‘ç”Ÿåœ¨é­”åŠ›ä¹‹éƒ½ï¼Œåœ¨è¿™é‡Œæˆ‘ä»¬å°†ä¸ºä½ ä»‹ç»ä¸€äº›å¿…è¦çš„è®¾å®šã€‚

é­”åŠ›ä¹‹éƒ½å¯ä»¥æŠ½è±¡æˆä¸€ä¸ª $n$ ä¸ªèŠ‚ç‚¹ã€$m$ æ¡è¾¹çš„æ— å‘è¿é€šå›¾ï¼ˆèŠ‚ç‚¹çš„ç¼–å·ä» $1$ è‡³ $n$ï¼‰ã€‚æˆ‘ä»¬ä¾æ¬¡ç”¨ $l,a$ æè¿°ä¸€æ¡è¾¹çš„**é•¿åº¦ã€æµ·æ‹”**ã€‚

ä½œä¸ºå­£é£æ°”å€™çš„ä»£è¡¨åŸå¸‚ï¼Œé­”åŠ›ä¹‹éƒ½æ—¶å¸¸æœ‰é›¨æ°´ç›¸ä¼´ï¼Œå› æ­¤é“è·¯ç§¯æ°´æ€»æ˜¯ä¸å¯é¿å…çš„ã€‚ç”±äºæ•´ä¸ªåŸå¸‚çš„æ’æ°´ç³»ç»Ÿè¿é€šï¼Œå› æ­¤**æœ‰ç§¯æ°´çš„è¾¹ä¸€å®šæ˜¯æµ·æ‹”ç›¸å¯¹æœ€ä½çš„ä¸€äº›è¾¹**ã€‚æˆ‘ä»¬ç”¨**æ°´ä½çº¿**æ¥æè¿°é™é›¨çš„ç¨‹åº¦ï¼Œå®ƒçš„æ„ä¹‰æ˜¯ï¼šæ‰€æœ‰æµ·æ‹”**ä¸è¶…è¿‡**æ°´ä½çº¿çš„è¾¹éƒ½æ˜¯**æœ‰ç§¯æ°´**çš„ã€‚

Yazid æ˜¯ä¸€åæ¥è‡ªé­”åŠ›ä¹‹éƒ½çš„ OIerï¼Œåˆšå‚åŠ å®Œ ION2018 çš„ä»–å°†è¸ä¸Šå½’ç¨‹ï¼Œå›åˆ°ä»–æ¸©æš–çš„å®¶ã€‚Yazid çš„å®¶æ°å¥½åœ¨é­”åŠ›ä¹‹éƒ½çš„ $1$ å·èŠ‚ç‚¹ã€‚å¯¹äºæ¥ä¸‹æ¥ $Q$ å¤©ï¼Œæ¯ä¸€å¤© Yazid éƒ½ä¼šå‘Šè¯‰ä½ ä»–çš„å‡ºå‘ç‚¹ $v$ ï¼Œä»¥åŠå½“å¤©çš„æ°´ä½çº¿ $p$ã€‚

æ¯ä¸€å¤©ï¼ŒYazid åœ¨å‡ºå‘ç‚¹éƒ½æ‹¥æœ‰ä¸€è¾†è½¦ã€‚è¿™è¾†è½¦ç”±äºä¸€äº›æ•…éšœä¸èƒ½ç»è¿‡æœ‰ç§¯æ°´çš„è¾¹ã€‚Yazid å¯ä»¥åœ¨ä»»æ„èŠ‚ç‚¹ä¸‹è½¦ï¼Œè¿™æ ·æ¥ä¸‹æ¥ä»–å°±å¯ä»¥æ­¥è¡Œç»è¿‡æœ‰ç§¯æ°´çš„è¾¹ã€‚ä½†è½¦ä¼šè¢«ç•™åœ¨ä»–ä¸‹è½¦çš„èŠ‚ç‚¹å¹¶ä¸ä¼šå†è¢«ä½¿ç”¨ã€‚
éœ€è¦ç‰¹æ®Šè¯´æ˜çš„æ˜¯ï¼Œç¬¬äºŒå¤©è½¦ä¼šè¢«é‡ç½®ï¼Œè¿™æ„å‘³ç€ï¼š
- è½¦ä¼šåœ¨æ–°çš„å‡ºå‘ç‚¹è¢«å‡†å¤‡å¥½ã€‚
- Yazid ä¸èƒ½åˆ©ç”¨ä¹‹å‰åœ¨æŸå¤„åœæ”¾çš„è½¦ã€‚

Yazid éå¸¸è®¨åŒåœ¨é›¨å¤©æ­¥è¡Œï¼Œå› æ­¤ä»–å¸Œæœ›åœ¨å®Œæˆå›å®¶è¿™ä¸€ç›®æ ‡çš„åŒæ—¶ï¼Œæœ€å°åŒ–ä»–**æ­¥è¡Œç»è¿‡çš„è¾¹**çš„æ€»é•¿åº¦ã€‚è¯·ä½ å¸®åŠ© Yazid è¿›è¡Œè®¡ç®—ã€‚

æœ¬é¢˜çš„éƒ¨åˆ†æµ‹è¯•ç‚¹å°†å¼ºåˆ¶åœ¨çº¿ï¼Œå…·ä½“ç»†èŠ‚è¯·è§ã€è¾“å…¥æ ¼å¼ã€‘å’Œã€å­ä»»åŠ¡ã€‘ã€‚

## è¯´æ˜/æç¤º

### æ›´å¤šæ ·ä¾‹

æ›´å¤šæ ·ä¾‹è¯·åœ¨é™„åŠ æ–‡ä»¶ä¸­ä¸‹è½½ã€‚

#### æ ·ä¾‹ 3

è§é™„åŠ æ–‡ä»¶ä¸­çš„ `return3.in` ä¸ `return3.ans`ã€‚

è¯¥æ ·ä¾‹æ»¡è¶³æµ·æ‹”ä¸ºä¸€ç§ï¼Œä¸”ä¸å¼ºåˆ¶åœ¨çº¿ã€‚

#### æ ·ä¾‹ 4

è§é™„åŠ æ–‡ä»¶ä¸­çš„ `return4.in` ä¸ `return4.ans`ã€‚

è¯¥æ ·ä¾‹æ»¡è¶³å›¾å½¢æ€ä¸ºä¸€æ¡é“¾ï¼Œä¸”å¼ºåˆ¶åœ¨çº¿ã€‚

#### æ ·ä¾‹ 5

è§é™„åŠ æ–‡ä»¶ä¸­çš„ `return5.in` ä¸ `return5.ans`ã€‚

è¯¥æ ·ä¾‹æ»¡è¶³ä¸å¼ºåˆ¶åœ¨çº¿ã€‚

### æ ·ä¾‹ 1 è§£é‡Š

ç¬¬ä¸€å¤©æ²¡æœ‰é™æ°´ï¼ŒYazid å¯ä»¥åè½¦ç›´æ¥å›åˆ°å®¶ä¸­ã€‚

ç¬¬äºŒå¤©ã€ç¬¬ä¸‰å¤©ã€ç¬¬å››å¤©çš„ç§¯æ°´æƒ…å†µç›¸åŒï¼Œå‡ä¸ºè¿æ¥ 1ï¼Œ2 å·èŠ‚ç‚¹çš„è¾¹ã€è¿æ¥ 3ï¼Œ4 å·ç‚¹çš„è¾¹æœ‰ç§¯æ°´ã€‚

å¯¹äºç¬¬äºŒå¤©ï¼ŒYazid ä» 2 å·ç‚¹å‡ºå‘åè½¦åªèƒ½å»å¾€ 3 å·èŠ‚ç‚¹ï¼Œå¯¹å›å®¶æ²¡æœ‰å¸®åŠ©ã€‚å› æ­¤ Yazid åªèƒ½çº¯é å¾’æ­¥å›å®¶ã€‚

å¯¹äºç¬¬ä¸‰å¤©ï¼Œä» 4 å·èŠ‚ç‚¹å‡ºå‘çš„å”¯ä¸€ä¸€æ¡è¾¹æ˜¯æœ‰ç§¯æ°´çš„ï¼Œè½¦ä¹Ÿå°±å˜å¾—æ— ç”¨äº†ã€‚Yazid åªèƒ½çº¯é å¾’æ­¥å›å®¶ã€‚

å¯¹äºç¬¬å››å¤©ï¼ŒYazid å¯ä»¥åè½¦å…ˆåˆ°è¾¾ 2 å·èŠ‚ç‚¹ï¼Œå†æ­¥è¡Œå›å®¶ã€‚

ç¬¬äº”å¤©æ‰€æœ‰çš„è¾¹éƒ½ç§¯æ°´äº†ï¼Œå› æ­¤ Yazid åªèƒ½çº¯é å¾’æ­¥å›å®¶ã€‚

### æ ·ä¾‹ 2 è§£é‡Š

æœ¬ç»„æ•°æ®å¼ºåˆ¶åœ¨çº¿ã€‚

ç¬¬ä¸€å¤©çš„ç­”æ¡ˆæ˜¯ $0$ï¼Œå› æ­¤ç¬¬äºŒå¤©çš„ $v=\left( 5+0-1\right)\bmod 5+1=5$ï¼Œ$p=\left(2+0\right)\bmod\left(3+1\right)=2$ã€‚

ç¬¬äºŒå¤©çš„ç­”æ¡ˆæ˜¯ $2$ï¼Œå› æ­¤ç¬¬ä¸‰å¤©çš„ $v=\left( 2+2-1\right)\bmod 5+1=4$ï¼Œ$p=\left(0+2\right)\bmod\left(3+1\right)=2$ã€‚

ç¬¬ä¸‰å¤©çš„ç­”æ¡ˆæ˜¯ $3$ï¼Œå› æ­¤ç¬¬å››å¤©çš„ $v=\left( 4+3-1\right)\bmod 5+1=2$ï¼Œ$p=\left(0+3\right)\bmod\left(3+1\right)=3$ã€‚

### æ•°æ®èŒƒå›´ä¸çº¦å®š

æ‰€æœ‰æµ‹è¯•ç‚¹å‡ä¿è¯ $T\leq 3$ï¼Œæ‰€æœ‰æµ‹è¯•ç‚¹ä¸­çš„æ‰€æœ‰æ•°æ®å‡æ»¡è¶³å¦‚ä¸‹é™åˆ¶ï¼š

- $n\leq 2\times 10^5$ï¼Œ$m\leq 4\times 10^5$ï¼Œ$Q\leq 4\times 10^5$ï¼Œ$K\in\left\{0,1\right\}$ï¼Œ$1\leq S\leq 10^9$ã€‚
- å¯¹äºæ‰€æœ‰è¾¹ï¼š$l\leq 10^4$ï¼Œ$a\leq 10^9$ã€‚
- ä»»æ„ä¸¤ç‚¹ä¹‹é—´éƒ½ç›´æ¥æˆ–é—´æ¥é€šè¿‡è¾¹ç›¸è¿ã€‚

**ä¸ºäº†æ–¹ä¾¿ä½ å¿«é€Ÿç†è§£ï¼Œæˆ‘ä»¬åœ¨è¡¨æ ¼ä¸­ä½¿ç”¨äº†ä¸€äº›ç®€å•æ˜“æ‡‚çš„è¡¨è¿°ã€‚åœ¨æ­¤ï¼Œæˆ‘ä»¬å¯¹è¿™äº›å†…å®¹ä½œå½¢å¼åŒ–çš„è¯´æ˜ï¼š**

- å›¾å½¢æ€ï¼šå¯¹äºè¡¨æ ¼ä¸­è¯¥é¡¹ä¸º â€œä¸€æ£µæ ‘â€ æˆ– â€œä¸€æ¡é“¾â€ çš„æµ‹è¯•ç‚¹ï¼Œä¿è¯ $m = n-1$ã€‚é™¤æ­¤ä¹‹å¤–ï¼Œè¿™ä¸¤ç±»æµ‹è¯•ç‚¹åˆ†åˆ«æ»¡è¶³å¦‚ä¸‹é™åˆ¶ï¼š
  - ä¸€æ£µæ ‘ï¼šä¿è¯è¾“å…¥çš„å›¾æ˜¯ä¸€æ£µæ ‘ï¼Œå³ä¿è¯è¾¹ä¸ä¼šæ„æˆå›è·¯ã€‚
  - ä¸€æ¡é“¾ï¼šä¿è¯æ‰€æœ‰è¾¹æ»¡è¶³ $u + 1 = v$ã€‚
- æµ·æ‹”ï¼šå¯¹äºè¡¨æ ¼ä¸­è¯¥é¡¹ä¸º â€œä¸€ç§â€ çš„æµ‹è¯•ç‚¹ï¼Œä¿è¯å¯¹äºæ‰€æœ‰è¾¹æœ‰ $a = 1$ã€‚
- å¼ºåˆ¶åœ¨çº¿ï¼šå¯¹äºè¡¨æ ¼ä¸­è¯¥é¡¹ä¸º â€œæ˜¯â€ çš„æµ‹è¯•ç‚¹ï¼Œä¿è¯ $K = 1$ï¼›å¦‚æœè¯¥é¡¹ä¸º â€œå¦â€ï¼Œåˆ™æœ‰ $K = 0$ã€‚
- å¯¹äºæ‰€æœ‰æµ‹è¯•ç‚¹ï¼Œå¦‚æœä¸Šè¿°å¯¹åº”é¡¹ä¸º â€œä¸ä¿è¯â€ï¼Œåˆ™å¯¹è¯¥é¡¹å†…å®¹ä¸ä½œä»»ä½•ä¿è¯ã€‚

$n$|$m$|$Q=$|æµ‹è¯•ç‚¹|å½¢æ€|æµ·æ‹”|å¼ºåˆ¶åœ¨çº¿
-|-|-|-|-|-|-
$\leq 1$|$\leq 0$|$0$|1|ä¸ä¿è¯|ä¸€ç§|å¦
$\leq 6$|$\leq 10$|$10$|2|ä¸ä¿è¯|ä¸€ç§|å¦
$\leq 50$|$\leq 150$|$100$|3|ä¸ä¿è¯|ä¸€ç§|å¦
$\leq 100$|$\leq 300$|$200$|4|ä¸ä¿è¯|ä¸€ç§|å¦
$\leq 1500$|$\leq 4000$|$2000$|5|ä¸ä¿è¯|ä¸€ç§|å¦
$\leq 200000$|$\leq 400000$|$100000$|6|ä¸ä¿è¯|ä¸€ç§|å¦
$\leq 1500$|$=n-1$|$2000$|7|ä¸€æ¡é“¾|ä¸ä¿è¯|å¦
$\leq 1500$|$=n-1$|$2000$|8|ä¸€æ¡é“¾|ä¸ä¿è¯|å¦
$\leq 1500$|$=n-1$|$2000$|9|ä¸€æ¡é“¾|ä¸ä¿è¯|å¦
$\leq 200000$|$=n-1$|$100000$|10|ä¸€æ£µæ ‘|ä¸ä¿è¯|å¦
$\leq 200000$|$=n-1$|$100000$|11|ä¸€æ£µæ ‘|ä¸ä¿è¯|æ˜¯
$\leq 200000$|$\leq 400000$|$100000$|12|ä¸ä¿è¯|ä¸ä¿è¯|å¦
$\leq 200000$|$\leq 400000$|$100000$|13|ä¸ä¿è¯|ä¸ä¿è¯|å¦
$\leq 200000$|$\leq 400000$|$100000$|14|ä¸ä¿è¯|ä¸ä¿è¯|å¦
$\leq 1500$|$\leq 4000$|$2000$|15|ä¸ä¿è¯|ä¸ä¿è¯|æ˜¯
$\leq 1500$|$\leq 4000$|$2000$|16|ä¸ä¿è¯|ä¸ä¿è¯|æ˜¯
$\leq 200000$|$\leq 400000$|$100000$|17|ä¸ä¿è¯|ä¸ä¿è¯|æ˜¯
$\leq 200000$|$\leq 400000$|$100000$|18|ä¸ä¿è¯|ä¸ä¿è¯|æ˜¯
$\leq 200000$|$\leq 400000$|$400000$|19|ä¸ä¿è¯|ä¸ä¿è¯|æ˜¯
$\leq 200000$|$\leq 400000$|$400000$|20|ä¸ä¿è¯|ä¸ä¿è¯|æ˜¯


## æ ·ä¾‹ #1

### è¾“å…¥

```
1
4 3
1 2 50 1
2 3 100 2
3 4 50 1
5 0 2
3 0
2 1
4 1
3 1
3 2```

### è¾“å‡º

```
0
50
200
50
150```

## æ ·ä¾‹ #2

### è¾“å…¥

```
1
5 5
1 2 1 2
2 3 1 2
4 3 1 2
5 3 1 2
1 5 2 1
4 1 3
5 1
5 2
2 0
4 0```

### è¾“å‡º

```
0
2
3
1```

# AIåˆ†æç»“æœ

---
# ğŸ’¡ æ´›è¯­äº‘ç¬ºçš„C++ç®—æ³•è§£æï¼šNOI2018ã€Œå½’ç¨‹ã€æ·±å…¥å­¦ä¹ æŒ‡å— ğŸ’¡

> ä»Šå¤©æˆ‘ä»¬æ¥ä¸€èµ·åˆ†æ NOI2018 Day1 T1ã€Œå½’ç¨‹ã€ã€‚è¿™ä¸ä»…ä»…æ˜¯ä¸€æ¬¡è§£é¢˜ï¼Œæ›´æ˜¯ä¸€åœº**æŠŠâ€œå¼€è½¦-èµ°è·¯â€å†³ç­–è½¬åŒ–ä¸ºæ ‘ä¸Šå€å¢**çš„æ€ç»´æ¢é™©ã€‚å‡†å¤‡å¥½ï¼Œç³»å¥½å®‰å…¨å¸¦ï¼Œæˆ‘ä»¬å‡ºå‘ï¼

---

## 1. é¢˜ç›®è§£è¯»ä¸ç­–ç•¥åˆæ¢

âœ¨ **æœ¬é¢˜æ ¸å¿ƒæŒ‘æˆ˜**  
> æŠŠä¸€æ¡ä» v åˆ° 1 çš„è·¯å¾„åˆ‡æˆä¸¤æ®µï¼š  
> 1. ç¬¬ä¸€æ®µ**å…¨ç¨‹å¼€è½¦**ï¼ˆåªèƒ½èµ°æµ·æ‹” > p çš„è¾¹ï¼‰ï¼›  
> 2. ç¬¬äºŒæ®µ**å…¨ç¨‹èµ°è·¯**ï¼ˆå¯ä»¥èµ°ä»»æ„è¾¹ï¼‰ã€‚  
> åœ¨æ‰€æœ‰å¯è¡Œåˆ‡æ³•ä¸­ï¼Œæœ€å°åŒ–**èµ°è·¯éƒ¨åˆ†çš„æ€»é•¿åº¦**ã€‚

âœ¨ **æ ¸å¿ƒç®—æ³•æ ‡ç­¾**  
`æœ€çŸ­è·¯` + `Kruskal é‡æ„æ ‘` + `æ ‘ä¸Šå€å¢` + `å­æ ‘æœ€å°å€¼`

ğŸ—£ï¸ **åˆæ­¥åˆ†æ**  
- å…ˆé¢„å¤„ç† 1 å·ç‚¹åˆ°æ‰€æœ‰ç‚¹çš„æœ€çŸ­è·¯ `dis[]`ï¼ˆDijkstraï¼‰ã€‚  
- å¼€è½¦å¯è¾¾çš„èŠ‚ç‚¹é›†åˆ = æµ·æ‹” > p çš„è¾¹æ„æˆçš„å­å›¾ä¸­ v æ‰€åœ¨çš„è¿é€šå—ã€‚  
- ç­”æ¡ˆæ˜¯è¯¥è¿é€šå—å†… `dis[i]` çš„æœ€å°å€¼ã€‚  
- éš¾ç‚¹ï¼š**å¼ºåˆ¶åœ¨çº¿**â€”â€”p æ¯æ¬¡åŠ¨æ€ç»™å‡ºï¼Œéœ€è¦ O(log n) å›ç­”ã€‚

### ğŸ” ç®—æ³•ä¾¦æ¢ï¼šå¦‚ä½•åœ¨é¢˜ç›®ä¸­å‘ç°çº¿ç´¢ï¼Ÿ
1. **çº¿ç´¢1 (é—®é¢˜ç›®æ ‡)**  
   â€œæœ€å°åŒ–èµ°è·¯é•¿åº¦â€ â†’ éœ€è¦ 1 å·ç‚¹æœ€çŸ­è·¯ï¼›  
   â€œå¼€è½¦ä¸èƒ½èµ°ç§¯æ°´è¾¹â€ â†’ éœ€è¦åŠ¨æ€æŒ‰æµ·æ‹”è¿‡æ»¤è¾¹ã€‚

2. **çº¿ç´¢2 (é—®é¢˜ç‰¹æ€§)**  
   è¾¹æƒæœ‰ä¸¤ä¸ªç»´åº¦ï¼šé•¿åº¦ lï¼ˆç”¨äºæœ€çŸ­è·¯ï¼‰ï¼Œæµ·æ‹” aï¼ˆç”¨äºè¿‡æ»¤ï¼‰ã€‚  
   æ¯æ¬¡è¯¢é—®ç›¸å½“äºâ€œç»™å®šé˜ˆå€¼ pï¼Œæ±‚åœ¨æµ·æ‹” > p çš„å­å›¾ä¸­ v çš„è¿é€šå—å†… dis æœ€å°å€¼â€ã€‚

3. **çº¿ç´¢3 (æ•°æ®è§„æ¨¡)**  
   n,m,Q â‰¤ 4Ã—10âµ â†’ å¿…é¡» O((n+m) log n) é¢„å¤„ç†ï¼ŒO(log n) å›ç­”ã€‚

### ğŸ§  æ€ç»´é“¾æ„å»ºï¼šä»çº¿ç´¢åˆ°ç­–ç•¥
> 1. é¦–å…ˆï¼Œ**çº¿ç´¢1**å‘Šè¯‰æˆ‘ä»¬éœ€è¦æœ€çŸ­è·¯â€”â€”å…ˆç”¨ Dijkstraã€‚  
> 2. **çº¿ç´¢2**æç¤ºï¼šæŒ‰æµ·æ‹”è¿‡æ»¤è¾¹ â†’ æŠŠæµ·æ‹”å½“æˆâ€œè¾¹å­˜åœ¨é˜ˆå€¼â€ï¼Œé—®é¢˜å˜æˆâ€œé˜ˆå€¼æŸ¥è¯¢è¿é€šå—ä¿¡æ¯â€ã€‚  
> 3. **çº¿ç´¢3**å‘Šè¯‰æˆ‘ä»¬ä¸èƒ½æš´åŠ›ï¼šæƒ³åˆ° **å¯æŒä¹…åŒ–å¹¶æŸ¥é›†** æˆ– **Kruskal é‡æ„æ ‘**ã€‚  
> 4. é‡æ„æ ‘ä¼˜é›…åœ°æŠŠâ€œæµ·æ‹”é˜ˆå€¼â€è½¬åŒ–ä¸ºâ€œæ ‘ä¸Šç¥–å…ˆâ€ï¼Œå€å¢å³å¯ O(log n) å›ç­”ã€‚

---

## 2. ç²¾é€‰ä¼˜è´¨é¢˜è§£å‚è€ƒ

| é¢˜è§£ | äº®ç‚¹ | æ ¸å¿ƒæ€è·¯ |
|---|---|---|
| **ldxcaicai** (èµ 152) | é¦–åˆ›â€œKruskal é‡æ„æ ‘ + å­æ ‘ dis æœ€å°å€¼â€æ¨¡æ¿ | æŒ‰æµ·æ‹”é™åºå»ºå°æ ¹å †ï¼Œå€å¢æ‰¾ç¥–å…ˆï¼Œå­æ ‘æœ€å°å€¼ DFS é¢„å¤„ç† |
| **FlashHu** (èµ 53) | å¯æŒä¹…åŒ–å¹¶æŸ¥é›† + ç¦»æ•£åŒ– | æŠŠå¹¶æŸ¥é›†å†å²ç‰ˆæœ¬ç”¨ä¸»å¸­æ ‘å­˜ï¼Œç¦»çº¿å˜åœ¨çº¿ï¼Œä»£ç çŸ­ |
| **niiick** (èµ 46) | é‡æ„æ ‘è®²è§£ + æ˜“è¯»ä»£ç  | æ¸…æ™°è§£é‡Šâ€œå­æ ‘å†…æ‰€æœ‰å¶å­æµ·æ‹”å‡å¤§äºæ ¹èŠ‚ç‚¹â€æ€§è´¨ |
| **alecli** (èµ 37) | éƒ¨åˆ†åˆ†å…¨æ”»ç•¥ | 30% æµ·æ‹”ä¸€ç§ç‰¹åˆ¤ï¼Œ65% ç¦»çº¿å¹¶æŸ¥é›†ï¼Œ80% æ•°æ®åˆ†æ²» |
| **Siyuan** (èµ 20) | é‡æ„æ ‘ä¼˜åŒ–å¸¸æ•° | åœ¨ Kruskal è¿‡ç¨‹ä¸­ç›´æ¥ç»´æŠ¤å­æ ‘æœ€å°å€¼ï¼Œçœä¸€æ¬¡ DFS |

---

## 3. è§£é¢˜ç­–ç•¥æ·±åº¦å‰–æ

### ğŸ¯ æ ¸å¿ƒéš¾ç‚¹ä¸å…³é”®æ­¥éª¤ï¼ˆæœ€ä¼˜è§£æ³•ï¼šKruskal é‡æ„æ ‘ï¼‰

1. **å…³é”®ç‚¹1ï¼šå¦‚ä½•å»ºå‡ºâ€œæµ·æ‹”å°æ ¹å †â€ï¼Ÿ**  
   - æŠŠæ‰€æœ‰è¾¹æŒ‰æµ·æ‹” **é™åº** æ’åºã€‚  
   - ç”¨å¹¶æŸ¥é›†ç»´æŠ¤è¿é€šå—ï¼Œæ¯æ¬¡åˆå¹¶ä¸¤ä¸ªå—æ—¶ï¼Œæ–°å»ºä¸€ä¸ªèŠ‚ç‚¹ä½œä¸ºçˆ¶èŠ‚ç‚¹ï¼ŒèŠ‚ç‚¹æƒå€¼ä¸ºå½“å‰è¾¹æµ·æ‹”ã€‚  
   - å¾—åˆ°ä¸€æ£µ **äºŒå‰æ ‘**ï¼Œéå¶å­èŠ‚ç‚¹ä»£è¡¨è¾¹æµ·æ‹”ï¼Œå¶å­èŠ‚ç‚¹æ˜¯åŸå›¾èŠ‚ç‚¹ã€‚  
   - æ€§è´¨ï¼šä»æ ¹åˆ°å¶å­ï¼ŒèŠ‚ç‚¹æƒå€¼ **å•è°ƒå¢**ï¼ˆå°æ ¹å †ï¼‰ã€‚

2. **å…³é”®ç‚¹2ï¼šå¦‚ä½•å›ç­”è¯¢é—®ï¼Ÿ**  
   - åœ¨é‡æ„æ ‘ä¸Šå€å¢ï¼šä» v å‘ä¸Šè·³ï¼Œæ‰¾åˆ° **æ·±åº¦æœ€å°** ä¸”èŠ‚ç‚¹æƒå€¼ > p çš„èŠ‚ç‚¹ uã€‚  
   - u çš„å­æ ‘å†…æ‰€æœ‰å¶å­èŠ‚ç‚¹å°±æ˜¯â€œæµ·æ‹” > p çš„è¿é€šå—â€ã€‚  
   - é¢„å¤„ç†å­æ ‘å†… `dis` æœ€å°å€¼ `mn[u]`ï¼Œç­”æ¡ˆå³ä¸º `mn[u]`ã€‚

3. **å…³é”®ç‚¹3ï¼šå¤æ‚åº¦**  
   - é¢„å¤„ç†ï¼šæ’åº O(m log m) + Kruskal O(m Î±(n)) + DFS O(n) + å€å¢è¡¨ O(n log n)ã€‚  
   - æ¯æ¬¡è¯¢é—®ï¼šO(log n)ã€‚

### âœ¨ è§£é¢˜æŠ€å·§æ€»ç»“
- **é—®é¢˜è½¬åŒ–**ï¼šæŠŠâ€œé˜ˆå€¼è¿é€šå—æŸ¥è¯¢â€è½¬åŒ–ä¸ºâ€œæ ‘ä¸Šç¥–å…ˆæŸ¥è¯¢â€ã€‚  
- **æ•°æ®ç»“æ„**ï¼šKruskal é‡æ„æ ‘æ˜¯å¤„ç†â€œæŒ‰è¾¹æƒè¿‡æ»¤è¿é€šå—â€é—®é¢˜çš„åˆ©å™¨ã€‚  
- **å¸¸æ•°ä¼˜åŒ–**ï¼šåœ¨ Kruskal è¿‡ç¨‹ä¸­ç›´æ¥ç»´æŠ¤å­æ ‘æœ€å°å€¼ï¼Œçœä¸€æ¬¡ DFSã€‚

### âš”ï¸ ç­–ç•¥ç«æŠ€åœºï¼šä¸åŒè§£æ³•å¯¹æ¯”

| ç­–ç•¥ | æ ¸å¿ƒæ€æƒ³ | ä¼˜ç‚¹ | ç¼ºç‚¹ | é€‚ç”¨åœºæ™¯/å¾—åˆ† |
|---|---|---|---|---|
| **æš´åŠ› DFS** | æ¯æ¬¡ BFS æµ·æ‹” > p çš„å­å›¾ | æ€è·¯ç›´è§‚ | O(m) æ¯æ¬¡æŸ¥è¯¢ï¼Œæ— æ³•é€šè¿‡ | å°æ•°æ® â‰¤ 10â´ |
| **ç¦»çº¿å¹¶æŸ¥é›†** | è¯¢é—®ä¸è¾¹å‡æŒ‰ p é™åºæ’åºï¼Œè¾¹åŠ å…¥å³åˆå¹¶ | ä»£ç æçŸ­ | å¿…é¡»ç¦»çº¿ | 65 pts |
| **å¯æŒä¹…åŒ–å¹¶æŸ¥é›†** | ä¸»å¸­æ ‘å­˜å¹¶æŸ¥é›†å†å²ç‰ˆæœ¬ | åœ¨çº¿ | 2 log n å¸¸æ•°å¤§ | 100 ptsï¼ˆå¡å¡å¸¸ï¼‰ |
| **Kruskal é‡æ„æ ‘** | å»ºæµ·æ‹”å°æ ¹å †ï¼Œå€å¢æ‰¾å­æ ‘ | 1 log nï¼Œä¼˜é›… | éœ€æŒæ¡é‡æ„æ ‘ | 100 ptsï¼ˆæ­£è§£ï¼‰ |

---

## 4. C++æ ¸å¿ƒä»£ç å®ç°èµæ

### é€šç”¨å®Œæ•´æ ¸å¿ƒå®ç°ï¼ˆKruskal é‡æ„æ ‘ç‰ˆï¼‰
```cpp
#include <bits/stdc++.h>
using namespace std;
typedef long long ll;
const int N = 4e5 + 10, M = 8e5 + 10;
int n, m, Q, K, S, cnt, tot, fa[N << 1], f[N << 1][20], val[N << 1];
ll dis[N], mn[N << 1];
struct Edge {
    int u, v, l, a;
    bool operator<(const Edge& rhs) const { return a > rhs.a; }
} e[M];
vector<int> g[N << 1];

void dijkstra() {
    priority_queue<pair<ll, int>, vector<pair<ll, int>>, greater<pair<ll, int>>> pq;
    fill(dis + 1, dis + n + 1, 1e18);
    dis[1] = 0; pq.emplace(0, 1);
    while (!pq.empty()) {
        auto [d, u] = pq.top(); pq.pop();
        if (d != dis[u]) continue;
        for (int i = 1; i <= m; ++i) if (e[i].u == u || e[i].v == u) {
            int v = e[i].u ^ e[i].v ^ u;
            if (dis[v] > dis[u] + e[i].l)
                dis[v] = dis[u] + e[i].l, pq.emplace(dis[v], v);
        }
    }
}
int find(int x) { return x == fa[x] ? x : fa[x] = find(fa[x]); }
void kruskal() {
    cnt = n;
    for (int i = 1; i <= n * 2; ++i) fa[i] = i;
    sort(e + 1, e + m + 1);
    for (int i = 1; i <= m; ++i) {
        int u = find(e[i].u), v = find(e[i].v);
        if (u == v) continue;
        val[++cnt] = e[i].a;
        fa[u] = fa[v] = cnt;
        g[cnt].push_back(u); g[cnt].push_back(v);
    }
}
void dfs(int u) {
    mn[u] = u <= n ? dis[u] : 1e18;
    for (int v : g[u]) {
        f[v][0] = u;
        for (int k = 1; k < 20; ++k) f[v][k] = f[f[v][k - 1]][k - 1];
        dfs(v);
        mn[u] = min(mn[u], mn[v]);
    }
}
int query(int v, int p) {
    for (int k = 19; k >= 0; --k)
        if (f[v][k] && val[f[v][k]] > p) v = f[v][k];
    return mn[v];
}
int main() {
    ios::sync_with_stdio(false);
    cin.tie(nullptr);
    int T; cin >> T;
    while (T--) {
        cin >> n >> m; tot = 0;
        for (int i = 1; i <= m; ++i) {
            cin >> e[i].u >> e[i].v >> e[i].l >> e[i].a;
        }
        dijkstra(); kruskal(); dfs(cnt);
        cin >> Q >> K >> S;
        ll last = 0;
        while (Q--) {
            int v, p; cin >> v >> p;
            v = (v + K * last - 1) % n + 1;
            p = (p + K * last) % (S + 1);
            cout << (last = query(v, p)) << '\n';
        }
        for (int i = 1; i <= cnt; ++i) g[i].clear();
    }
    return 0;
}
```

---

## 5. ç®—æ³•å¯è§†åŒ–ï¼šåƒç´ åŠ¨ç”»æ¼”ç¤º

### åŠ¨ç”»ä¸»é¢˜  
**â€œåƒç´ æ¢é™©å®¶ï¼šå¯»æ‰¾æœ€é«˜çš„æ¡¥â€**  
8-bit é£æ ¼ï¼Œä¸»è§’ Yazid åƒç´ å°äººç«™åœ¨ vï¼Œéœ€è¦æ‰¾åˆ°æœ€é«˜çš„æ¡¥ï¼ˆæµ·æ‹” > pï¼‰æ‰èƒ½å¼€è½¦å›å®¶ã€‚

### åœºæ™¯è®¾å®š
- åœ°å›¾ï¼šnÃ—m çš„åƒç´ ç½‘æ ¼ï¼Œè¾¹ç”¨ç»¿è‰²åƒç´ è¡¨ç¤ºï¼›æµ·æ‹”è¶Šé«˜ï¼Œé¢œè‰²è¶Šäº®ã€‚  
- æ°´ä½çº¿ï¼šä¸€æ¡æ¨ªå‘æµåŠ¨çš„è“è‰²åƒç´ å¸¦ï¼Œé«˜åº¦ = pã€‚  
- Kruskal é‡æ„æ ‘ï¼šå³ä¾§ç«–ç›´çš„åƒç´ æ ‘ï¼Œæ¯ä¸ªèŠ‚ç‚¹æ˜¯æ–¹å—ï¼Œæƒå€¼å†™åœ¨æ–¹å—é‡Œã€‚

### åŠ¨ç”»æµç¨‹
1. **é¢„å¤„ç†**  
   - å±å¹•å·¦ä¾§ Dijkstra åŠ¨ç”»ï¼š1 å·ç‚¹åƒç´ å°äººå‘å¤–æ‰©æ•£ï¼Œdis å€¼ç”¨ HUD æ˜¾ç¤ºã€‚  
   - å³ä¾§ Kruskal é‡æ„æ ‘è‡ªä¸‹è€Œä¸Šç”Ÿé•¿ï¼Œæ¯æ¬¡åˆå¹¶äº§ç”Ÿæ–°æ–¹å—å¹¶é—ªçƒã€‚

2. **è¯¢é—®æ¼”ç¤º**  
   - è¾“å…¥ v, p åï¼Œå°äººä» v å‘ä¸Šè·³æ ‘ï¼š  
     - æ–¹å—é«˜äº®ï¼ˆé»„è‰²é—ªçƒï¼‰ï¼Œè‹¥æƒå€¼ > p ç»§ç»­è·³ã€‚  
     - æ‰¾åˆ°æœ€ç»ˆæ–¹å—åï¼Œæ–¹å—å†…â€œå­æ ‘æœ€å°å€¼â€æ•°å­—æ”¾å¤§å¼¹å‡ºã€‚  
   - éŸ³æ•ˆï¼š  
     - è·³æ–¹å—ï¼š8-bit â€œå®â€ã€‚  
     - æ‰¾åˆ°ç­”æ¡ˆï¼šFC èƒœåˆ©éŸ³â€œå“’å“’â€ã€‚  
   - æ§åˆ¶é¢æ¿ï¼š  
     - å•æ­¥/è‡ªåŠ¨æ’­æ”¾æŒ‰é’®ï¼Œé€Ÿåº¦æ»‘å—ï¼ˆä¹Œé¾Ÿ/å…”å­ï¼‰ã€‚  

### æŠ€æœ¯å®ç°
- Canvas + 16 è‰²è°ƒè‰²æ¿ã€‚  
- æ¯ä¸ªåƒç´ å— 8Ã—8ï¼ŒåŠ¨ç”»å¸§ 24 FPSã€‚  
- éŸ³æ•ˆï¼šWeb Audio API ç”Ÿæˆæ–¹æ³¢ã€‚

---

## 6. æ‹“å±•ç»ƒä¹ ä¸ç›¸ä¼¼é—®é¢˜æ€è€ƒ

### é€šç”¨æŠ€å·§è¿ç§»
- **Kruskal é‡æ„æ ‘** é€‚ç”¨äºï¼š  
  1. ä¸¤ç‚¹è·¯å¾„æœ€å¤§è¾¹æƒæœ€å°å€¼ï¼ˆè´§è½¦è¿è¾“ï¼‰ã€‚  
  2. åŠ¨æ€åˆ è¾¹åè¿é€šæ€§ï¼ˆç¦»çº¿å€’åºåŠ è¾¹ï¼‰ã€‚  
  3. æŒ‰è¾¹æƒè¿‡æ»¤åçš„è¿é€šå—æœ€å€¼ã€‚

### æ´›è°·æ¨è
1. **P4768**ï¼ˆæœ¬é¢˜ï¼‰  
   *â€œæ¨¡æ¿çº§é‡æ„æ ‘ï¼Œç»ƒæ‰‹å€å¢ä¸å­æ ‘ä¿¡æ¯ç»´æŠ¤ã€‚â€*

2. **P4197 æ¨¡æ¿ï¼šKruskal é‡æ„æ ‘**  
   *â€œè£¸é¢˜ï¼Œå¸®åŠ©ç†è§£é‡æ„æ ‘æ„é€ ã€‚â€*

3. **P1967 è´§è½¦è¿è¾“**  
   *â€œæœ€å¤§ç”Ÿæˆæ ‘ + LCAï¼Œæ„Ÿå—è¾¹æƒè½¬ç‚¹æƒã€‚â€*

4. **P3402 å¯æŒä¹…åŒ–å¹¶æŸ¥é›†**  
   *â€œå¦‚æœæƒ³èµ°å¯æŒä¹…åŒ–è·¯çº¿ï¼Œå…ˆ AC æ­¤é¢˜ã€‚â€*

---

## 7. å­¦ä¹ å¿ƒå¾—ä¸ç»éªŒåˆ†äº«

> **FlashHu** çš„è¸©å‘è®°å½•  
> â€œ50â†’100 åªéœ€ä¸€è¡Œï¼š`dep[w]=dep[v]+(dep[u]==dep[v])` å¿˜è®°æŒ‰ç§©åˆå¹¶å¯¼è‡´ TLEã€‚â€  
> **æ´›è¯­äº‘ç¬ºç‚¹è¯„**ï¼šæŒ‰ç§©åˆå¹¶æ˜¯å¹¶æŸ¥é›†çš„çµé­‚ï¼Œé‡æ„æ ‘ä¸­åŒæ ·è¦æ³¨æ„ã€‚

> **niiick** çš„é¡¿æ‚Ÿ  
> â€œé‡æ„æ ‘æŠŠâ€˜æµ·æ‹”é˜ˆå€¼â€™å˜æˆâ€˜ç¥–å…ˆèŠ‚ç‚¹â€™ï¼Œç¬é—´æŠŠè¿é€šå—æŸ¥è¯¢å˜æˆæ ‘ä¸Šå€å¢ã€‚â€  
> **æ´›è¯­äº‘ç¬ºç‚¹è¯„**ï¼šè¿™å°±æ˜¯â€œé—®é¢˜è½¬åŒ–â€çš„é­…åŠ›ï¼

---

<conclusion>
ä»æš´åŠ› DFS åˆ°ä¼˜é›…çš„é‡æ„æ ‘ï¼Œæˆ‘ä»¬å®Œæˆäº†ä¸€æ¬¡**ä»â€œèƒ½åšâ€åˆ°â€œåšå¥½â€**çš„èœ•å˜ã€‚  
è®°ä½ï¼šçœ‹åˆ°â€œé˜ˆå€¼è¿‡æ»¤è¿é€šå—â€å…ˆæƒ³åˆ° **Kruskal é‡æ„æ ‘**ï¼›çœ‹åˆ°â€œåœ¨çº¿å†å²ç‰ˆæœ¬â€å…ˆæƒ³åˆ° **å¯æŒä¹…åŒ–æ•°æ®ç»“æ„**ã€‚  
ä¸‹æ¬¡é‡åˆ°é›¨å¤©å›å®¶é—®é¢˜ï¼Œå°±èƒ½åƒ Yazid ä¸€æ ·ï¼Œä¸€è·¯å¼€è½¦ï¼Œä¸€è·¯æœ€ä¼˜ï¼
</conclusion>

---
å¤„ç†ç”¨æ—¶ï¼š148.19ç§’
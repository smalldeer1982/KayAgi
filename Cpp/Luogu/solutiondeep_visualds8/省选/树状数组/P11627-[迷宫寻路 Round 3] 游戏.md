# é¢˜ç›®ä¿¡æ¯

# [è¿·å®«å¯»è·¯ Round 3] æ¸¸æˆ

## é¢˜ç›®æè¿°

å° L æ­£åœ¨ç©æ¸¸æˆï¼Œæ¸¸æˆåœ°å›¾æ˜¯ä¸€é¢— $n$ ä¸ªèŠ‚ç‚¹çš„æ ‘ï¼Œå®šä¹‰ä¸€æ¡æ ‘ä¸Šè·¯å¾„çš„é•¿åº¦ä¸ºè·¯å¾„ä¸Šæ‰€æœ‰è¾¹çš„è¾¹æƒä¹‹å’Œï¼Œè·¯å¾„å¯ä»¥é‡å¤ç»è¿‡ç‚¹å’Œè¾¹ã€‚ç‰¹åˆ«çš„ï¼Œè‹¥è·¯å¾„ä¸åŒ…å«ä»»ä½•è¾¹ï¼Œåˆ™å…¶é•¿åº¦ä¸º $0$ã€‚

å° L ä¼šé€‰æ‹©ä¸€ä¸ªç‚¹ä½œä¸ºå¿…ç»ç‚¹ $t$ï¼Œæ¥ç€ï¼Œå° L ä¼šè®¾ç½®æ¯æ¡è¾¹çš„è¾¹æƒï¼Œä½¿å¾—è¾¹çš„è¾¹æƒæ„æˆä¸€ä¸ª $1$ åˆ° $n-1$ çš„**æ’åˆ—**ã€‚

å®šä¹‰ï¼šå° L çš„å¾—åˆ†ä¸º $\sum_{1 \leq u,v \leq n} \operatorname{dist}(u,v)$ï¼Œå…¶ä¸­ $\operatorname{dist}(u,v)$ ä¸ºåœ¨ç»è¿‡å¿…ç»ç‚¹ $t$ çš„å‰æä¸‹ï¼Œé•¿åº¦**æœ€å°çš„**ä» $u$ åˆ° $v$ çš„è·¯å¾„çš„é•¿åº¦ã€‚

å° L å¸Œæœ›æœ€å¤§åŒ–è‡ªå·±çš„å¾—åˆ†ï¼Œè¯·ä½ è§£ç­”ä»¥ä¸‹é—®é¢˜ï¼š

ç¬¬ä¸€é—®ï¼šæ±‚ä»–å¾—åˆ†çš„**æœ€å¤§å€¼**å¯¹ $998244353$ å–æ¨¡çš„å€¼ã€‚

ç¬¬äºŒé—®ï¼šæ±‚è‹¥è¦æœ€å¤§åŒ–ä»–çš„å¾—åˆ†ï¼Œå° L åº”è¯¥é€‰æ‹©çš„å¿…ç»ç‚¹ $t$ å’Œå° L æ¯æ¡è¾¹åº”è®¾ç½®çš„è¾¹æƒã€‚


## è¯´æ˜/æç¤º

**æœ¬é¢˜é‡‡ç”¨æ†ç»‘æµ‹è¯•ã€‚**

å¯¹äºæ‰€æœ‰æ•°æ®ï¼Œ$1\le n\le 10^5$ã€‚

| å­ä»»åŠ¡ç¼–å· | $n\leq$ | ç‰¹æ®Šæ€§è´¨ 1 | ç‰¹æ®Šæ€§è´¨ 2 | åˆ†æ•° |
| :----------: | :----------: | :----------: | :----------: | :----------: |
| $0$ | $50$ | å¦ | å¦ | $10$ |
| $1$ | $1000$ | å¦ | å¦ | $20$ |
| $2$ | $10^5$ | æ˜¯ | å¦ | $10$ |
| $3$ | $10^5$ | å¦ | æ˜¯ | $10$ |
| $4$ | $10^5$ | å¦ | å¦ | $50$ |

ç‰¹æ®Šæ€§è´¨ 1ï¼šå­˜åœ¨ä¸€ä¸ªå¯¹ç‚¹é‡æ ‡å·çš„æ–¹æ¡ˆï¼Œä½¿å¾—ç¬¬ $i$ æ¡è¾¹ä¸º $(1,i+1)$ã€‚

ç‰¹æ®Šæ€§è´¨ 2ï¼šå­˜åœ¨ä¸€ä¸ªå¯¹ç‚¹é‡æ ‡å·çš„æ–¹æ¡ˆï¼Œä½¿å¾—ç¬¬ $i$ æ¡è¾¹ä¸º $(i,i+1)$ã€‚


## æ ·ä¾‹ #1

### è¾“å…¥

```
5
1 2
1 3
2 4
2 5```

### è¾“å‡º

```
280
3
3 4 1 2```

## æ ·ä¾‹ #2

### è¾“å…¥

```
7
5 1
1 7
6 2
2 1
4 5
3 2```

### è¾“å‡º

```
1106
4
5 1 2 4 6 3```

## æ ·ä¾‹ #3

### è¾“å…¥

```
10
3 6
7 3
8 10
5 9
9 1
4 8
1 8
2 3
6 10```

### è¾“å‡º

```
5240
5
4 1 6 9 8 2 7 3 5```

## æ ·ä¾‹ #4

### è¾“å…¥

```
10
1 2
1 3
3 4
3 5
2 6
6 7
7 8
8 9
9 10```

### è¾“å‡º

```
5660
10
4 3 1 2 5 6 7 8 9```

## æ ·ä¾‹ #5

### è¾“å…¥

```
20
5 18
16 11
6 15
7 14
8 7
10 20
3 4
14 6
9 8
18 11
17 4
11 10
4 11
2 13
13 12
12 15
15 20
19 9
1 8```

### è¾“å‡º

```
79480
19
1 2 14 16 17 12 3 15 18 7 4 11 9 5 8 10 13 19 6```

## æ ·ä¾‹ #6

### è¾“å…¥

```
10
7 8
3 2
6 7
2 10
8 3
4 1
9 2
1 3
5 7
```

### è¾“å‡º

```
4340
5
8 6 1 2 7 3 4 5 9 ```

## æ ·ä¾‹ #7

### è¾“å…¥

```
è§é™„ä»¶```

### è¾“å‡º

```
è§é™„ä»¶```

# AIåˆ†æç»“æœ

---
# ğŸ’¡ æ´›è¯­äº‘ç¬ºçš„C++ç®—æ³•è§£æï¼šè¿·å®«å¯»è·¯ Round 3 æ·±å…¥å­¦ä¹ æŒ‡å— ğŸ’¡

ä»Šå¤©æˆ‘ä»¬æ¥ä¸€èµ·åˆ†æâ€œè¿·å®«å¯»è·¯ Round 3â€è¿™é“C++ç¼–ç¨‹é¢˜ã€‚è¿™ä¸ä»…ä»…æ˜¯ä¸€æ¬¡è§£é¢˜ï¼Œæ›´æ˜¯ä¸€åœºæ€ç»´çš„æ¢é™©ã€‚æˆ‘ä»¬å°†å­¦ä¹ å¦‚ä½•åƒä¾¦æ¢ä¸€æ ·ä»é¢˜ç›®ä¸­å¯»æ‰¾çº¿ç´¢ï¼Œå¹¶åœ¨ä¸åŒçš„è§£é¢˜é“è·¯ä¸­æƒè¡¡é€‰æ‹©ï¼Œæœ€ç»ˆæ‰¾åˆ°æœ€ä¼˜çš„ç­–ç•¥ã€‚

---

## 1. é¢˜ç›®è§£è¯»ä¸ç­–ç•¥åˆæ¢

âœ¨ **æœ¬é¢˜æ ¸å¿ƒæŒ‘æˆ˜**ï¼šåœ¨**æ ‘**ä¸Šé€‰æ‹©ä¸€ä¸ªå¿…ç»ç‚¹ \(t\)ï¼Œå¹¶ç»™æ¯æ¡è¾¹åˆ†é…**äº’ä¸ç›¸åŒçš„è¾¹æƒ**ï¼ˆ1~n-1 çš„æ’åˆ—ï¼‰ï¼Œä½¿å¾—**æ‰€æœ‰ç»è¿‡ \(t\) çš„æœ€çŸ­è·¯å¾„**çš„**æ€»é•¿åº¦ä¹‹å’Œ**æœ€å¤§ã€‚

âœ¨ **æ ¸å¿ƒç®—æ³•æ ‡ç­¾**ï¼šæ ‘å½¢ç»“æ„ã€è´ªå¿ƒã€æ¢æ ¹ DPã€çº¿æ®µæ ‘ / å¹³è¡¡æ ‘ç»´æŠ¤å­æ ‘ä¿¡æ¯ã€‚

ğŸ—£ï¸ **åˆæ­¥åˆ†æ**ï¼š
- **å…³é”®æ´å¯Ÿ**ï¼šç»è¿‡ \(t\) çš„æœ€çŸ­è·¯å¾„é•¿åº¦ç­‰äºä»¥ \(t\) ä¸ºæ ¹æ—¶ï¼Œä¸¤ç‚¹çš„æ·±åº¦ä¹‹å’Œã€‚å› æ­¤ï¼Œæ€»å¾—åˆ†å¯è½¬åŒ–ä¸º \(2n \cdot \sum_{u} dep_u\)ã€‚
- **è´ªå¿ƒç­–ç•¥**ï¼šæœ€å¤§åŒ– \(\sum dep_u\) ç­‰ä»·äºæœ€å¤§åŒ– \(\sum_{e} siz_e \cdot w_e\)ï¼Œå…¶ä¸­ \(siz_e\) æ˜¯è¾¹ \(e\) ä¸‹æ–¹å­æ ‘çš„å¤§å°ï¼Œ\(w_e\) æ˜¯è¾¹æƒã€‚ç”±äº \(w\) æ˜¯æ’åˆ—ï¼Œå°†æœ€å¤§çš„è¾¹æƒåˆ†é…ç»™æœ€å¤§çš„ \(siz_e\) å³å¯ã€‚
- **æ¢æ ¹ DP**ï¼šæšä¸¾æ‰€æœ‰å¯èƒ½çš„ \(t\)ï¼Œåˆ©ç”¨æ¢æ ¹æŠ€æœ¯åŠ¨æ€ç»´æŠ¤ \(\sum siz_e \cdot rank(siz_e)\) çš„æœ€å¤§å€¼ã€‚

### ğŸ” ç®—æ³•ä¾¦æ¢ï¼šå¦‚ä½•åœ¨é¢˜ç›®ä¸­å‘ç°çº¿ç´¢ï¼Ÿ
1.  **çº¿ç´¢1 (é—®é¢˜ç›®æ ‡)**: "é¢˜ç›®è¦æ±‚æœ€å¤§åŒ–æ‰€æœ‰ç»è¿‡å¿…ç»ç‚¹ \(t\) çš„æœ€çŸ­è·¯å¾„æ€»é•¿åº¦ä¹‹å’Œï¼Œä¸”è¾¹æƒä¸ºæ’åˆ—ã€‚" è¿™ç§**å¸¦çº¦æŸçš„æœ€ä¼˜åŒ–é—®é¢˜**ï¼Œæš—ç¤º**è´ªå¿ƒ**å’Œ**åŠ¨æ€è§„åˆ’**ã€‚
2.  **çº¿ç´¢2 (é—®é¢˜çº¦æŸ/ç‰¹æ€§)**: "æ ‘ç»“æ„ + å¿…ç»ç‚¹ + è¾¹æƒæ’åˆ—"ï¼Œæç¤ºæˆ‘ä»¬éœ€è¦åˆ©ç”¨**æ ‘çš„æ€§è´¨**ï¼ˆå¦‚å­æ ‘å¤§å°ã€æ¢æ ¹ DPï¼‰ã€‚
3.  **çº¿ç´¢3 (æ•°æ®è§„æ¨¡)**: \(n \le 10^5\)ï¼Œè¦æ±‚ \(O(n \log n)\) æˆ– \(O(n)\) çš„ç®—æ³•ï¼Œæ’é™¤æš´åŠ›æšä¸¾ã€‚

### ğŸ§  æ€ç»´é“¾æ„å»ºï¼šä»çº¿ç´¢åˆ°ç­–ç•¥
> å¥½äº†ï¼Œä¾¦æ¢å·¥ä½œå®Œæˆï¼Œæˆ‘ä»¬æ”¶é›†åˆ°äº†å‡ æ¡å…³é”®çº¿ç´¢ã€‚ç°åœ¨ï¼Œè®©æˆ‘ä»¬åƒæ‹¼å›¾ä¸€æ ·æŠŠå®ƒä»¬ç»„åˆèµ·æ¥ï¼š
> 1.  é¦–å…ˆï¼Œã€çº¿ç´¢1ï¼šé—®é¢˜ç›®æ ‡ã€‘å‘Šè¯‰æˆ‘ä»¬è¿™æ˜¯ä¸€ä¸ªâ€œæœ€ä¼˜åŒ–â€é—®é¢˜ï¼Œæˆ‘çš„å¤§è„‘é‡Œç«‹åˆ»é—ªè¿‡äº†â€œè´ªå¿ƒâ€ã€â€œæœç´¢â€ã€â€œåŠ¨æ€è§„åˆ’â€è¿™å‡ ä¸ªå€™é€‰æ–¹æ¡ˆã€‚
> 2.  æ¥ç€ï¼Œã€çº¿ç´¢2ï¼šé—®é¢˜ç‰¹æ€§ã€‘ï¼Œæ¯”å¦‚â€œæ ‘çš„ç»“æ„â€ï¼Œç»™äº†æˆ‘ä¸€ä¸ªå†³å®šæ€§çš„æç¤ºã€‚æ ‘çš„å­æ ‘æ€§è´¨éå¸¸é€‚åˆæ¢æ ¹ DPã€‚
> 3.  æœ€åï¼Œã€çº¿ç´¢3ï¼šæ•°æ®è§„æ¨¡ã€‘ç»™äº†æˆ‘ä»¬æœ€ç»ˆåˆ¤å†³ã€‚\(n=10^5\)ï¼Œ\(O(n^2)\) çš„æš´åŠ›æšä¸¾ä¼šè¶…æ—¶ï¼ˆTLEï¼‰ï¼Œè€Œ \(O(n \log n)\) çš„ç®—æ³•æ˜¯å®Œå…¨å¯ä»¥æ¥å—çš„ã€‚
> 4.  **ç»“è®º**ï¼šç»¼åˆä»¥ä¸Šï¼Œä¸€ä¸ªèƒ½å¤Ÿå¤„ç†â€œæ ‘ç»“æ„â€å¹¶æ±‚è§£â€œæœ€ä¼˜åŒ–â€ï¼Œä¸”æ—¶é—´å¤æ‚åº¦åœ¨ \(O(n \log n)\) çš„ç®—æ³•ï¼Œå°±æ˜¯æˆ‘ä»¬çš„ç›®æ ‡ã€‚**æ¢æ ¹ DP + è´ªå¿ƒ + çº¿æ®µæ ‘/å¹³è¡¡æ ‘**ï¼Œå®Œç¾ç¬¦åˆæ‰€æœ‰æ¡ä»¶ï¼

---

## 2. ç²¾é€‰ä¼˜è´¨é¢˜è§£å‚è€ƒ

ä¸ºäº†æ›´å¥½åœ°ç†è§£è§£é¢˜è¿‡ç¨‹ï¼Œæˆ‘ä»æ€è·¯æ¸…æ™°åº¦ã€ä»£ç å¯è¯»æ€§ã€ç®—æ³•æœ‰æ•ˆæ€§ä¸ä¼˜åŒ–ç¨‹åº¦ã€å®è·µä»·å€¼ç­‰å‡ ä¸ªæ–¹é¢ï¼Œä¸ºå¤§å®¶ç­›é€‰äº†ä»¥ä¸‹è¯„åˆ†è¾ƒé«˜ï¼ˆâ‰¥4æ˜Ÿï¼‰çš„é¢˜è§£ã€‚

**é¢˜è§£ä¸€ï¼šGenius_Star (èµï¼š3)**
* **ç‚¹è¯„**ï¼šè¿™ä»½é¢˜è§£åœ¨æ€è·¯ä¸Šéå¸¸æ¸…æ™°ï¼Œå‡†ç¡®åœ°æŠ“ä½äº†é—®é¢˜çš„æ ¸å¿ƒâ€”â€”å°†é—®é¢˜è½¬åŒ–ä¸ºæœ€å¤§åŒ– \(\sum siz_e \cdot rank(siz_e)\)ã€‚ä½œè€…é€šè¿‡å€¼åŸŸçº¿æ®µæ ‘åŠ¨æ€ç»´æŠ¤å­æ ‘å¤§å°çš„æ’åï¼Œå®ç°äº†é«˜æ•ˆçš„æ¢æ ¹ DPã€‚ä»£ç å®ç°ä¸Šï¼Œçº¿æ®µæ ‘çš„åˆå¹¶æ“ä½œï¼ˆpushupï¼‰å·§å¦™åœ°å¤„ç†äº†åŒºé—´å’Œä¸åŒºé—´æœ€å¤§å€¼ï¼Œæ˜¯ä¸€ä¸ªéå¸¸ç°ä»£ä¸”å®ç”¨çš„æŠ€å·§ã€‚

**é¢˜è§£äºŒï¼šColinxu2020 (èµï¼š3)**
* **ç‚¹è¯„**ï¼šè¿™ä»½é¢˜è§£é‡‡ç”¨äº†FHQ-Treapï¼ˆå¹³è¡¡æ ‘ï¼‰æ¥ç»´æŠ¤å­æ ‘å¤§å°çš„æ’åï¼Œæ€è·¯ä¸Genius_Starç±»ä¼¼ï¼Œä½†æ•°æ®ç»“æ„çš„é€‰æ‹©æ›´çµæ´»ã€‚ä½œè€…è¯¦ç»†æ¨å¯¼äº†æ¢æ ¹è¿‡ç¨‹ä¸­å¦‚ä½•æ›´æ–°ç­”æ¡ˆï¼Œå¹¶é€šè¿‡å¹³è¡¡æ ‘çš„æ’å…¥/åˆ é™¤æ“ä½œå®ç°åŠ¨æ€ç»´æŠ¤ã€‚ä»£ç ä¸­ä½¿ç”¨äº†éšæœºåŒ–ä¼˜å…ˆçº§ï¼Œç¡®ä¿äº†å¹³è¡¡æ ‘çš„å¹³å‡æ€§èƒ½ã€‚

**é¢˜è§£ä¸‰ï¼šqczrz6v4nhp6u (èµï¼š1)**
* **ç‚¹è¯„**ï¼šè¿™ä»½é¢˜è§£é‡‡ç”¨äº†æ ‘çŠ¶æ•°ç»„ï¼ˆBITï¼‰æ¥ç»´æŠ¤å­æ ‘å¤§å°çš„æ’åï¼Œæ€è·¯ç®€æ´é«˜æ•ˆã€‚ä½œè€…é€šè¿‡ä¸¤ä¸ªæ ‘çŠ¶æ•°ç»„åˆ†åˆ«ç»´æŠ¤å­æ ‘å¤§å°çš„å‡ºç°æ¬¡æ•°å’Œå­æ ‘å¤§å°çš„å’Œï¼Œå®ç°äº†åŠ¨æ€æ’åæŸ¥è¯¢å’ŒåŒºé—´å’Œè®¡ç®—ã€‚ä»£ç å®ç°ä¸Šï¼Œæ ‘çŠ¶æ•°ç»„çš„å¸¸æ•°è¾ƒå°ï¼Œé€‚åˆç«èµ›ä¸­çš„å¿«é€Ÿå®ç°ã€‚

---

## 3. è§£é¢˜ç­–ç•¥æ·±åº¦å‰–æ

### ğŸ¯ æ ¸å¿ƒéš¾ç‚¹ä¸å…³é”®æ­¥éª¤ (æœ€ä¼˜è§£æ³•å‰–æ)
1.  **å…³é”®ç‚¹1**ï¼šå¦‚ä½•å®šä¹‰å­æ ‘å¤§å°çš„è´¡çŒ®ï¼Ÿ
    * **åˆ†æ**ï¼šä»¥ \(t\) ä¸ºæ ¹æ—¶ï¼Œæ¯æ¡è¾¹ \(e\) çš„è´¡çŒ®æ˜¯ \(siz_e \cdot w_e\)ï¼Œå…¶ä¸­ \(siz_e\) æ˜¯è¾¹ \(e\) ä¸‹æ–¹å­æ ‘çš„å¤§å°ã€‚è´ªå¿ƒåœ°å°†æœ€å¤§çš„ \(w_e\) åˆ†é…ç»™æœ€å¤§çš„ \(siz_e\) å³å¯ã€‚
    * ğŸ’¡ **å­¦ä¹ ç¬”è®°**ï¼šè´ªå¿ƒç­–ç•¥çš„æ­£ç¡®æ€§å¯é€šè¿‡äº¤æ¢ä¸ç­‰å¼è¯æ˜ã€‚
2.  **å…³é”®ç‚¹2**ï¼šå¦‚ä½•é«˜æ•ˆæšä¸¾æ‰€æœ‰å¯èƒ½çš„ \(t\)ï¼Ÿ
    * **åˆ†æ**ï¼šä½¿ç”¨æ¢æ ¹ DPï¼Œä»æ ¹èŠ‚ç‚¹å¼€å§‹ï¼Œé€æ­¥å°†æ ¹è½¬ç§»åˆ°å­èŠ‚ç‚¹ï¼Œæ¯æ¬¡åªéœ€æ›´æ–°å—å½±å“çš„å­æ ‘å¤§å°ã€‚
    * ğŸ’¡ **å­¦ä¹ ç¬”è®°**ï¼šæ¢æ ¹ DP æ˜¯å¤„ç†æ ‘å½¢ç»“æ„åŠ¨æ€é—®é¢˜çš„åˆ©å™¨ã€‚
3.  **å…³é”®ç‚¹3**ï¼šå¦‚ä½•åŠ¨æ€ç»´æŠ¤å­æ ‘å¤§å°çš„æ’åï¼Ÿ
    * **åˆ†æ**ï¼šä½¿ç”¨çº¿æ®µæ ‘ã€å¹³è¡¡æ ‘æˆ–æ ‘çŠ¶æ•°ç»„ç»´æŠ¤å­æ ‘å¤§å°çš„å‡ºç°æ¬¡æ•°å’ŒåŒºé—´å’Œï¼Œæ”¯æŒåŠ¨æ€æ’å…¥/åˆ é™¤å’Œæ’åæŸ¥è¯¢ã€‚
    * ğŸ’¡ **å­¦ä¹ ç¬”è®°**ï¼šé€‰æ‹©åˆé€‚çš„æ•°æ®ç»“æ„èƒ½è®©ç®—æ³•äº‹åŠåŠŸå€ã€‚

### âœ¨ è§£é¢˜æŠ€å·§æ€»ç»“
-   **æŠ€å·§A (é—®é¢˜è½¬åŒ–)**ï¼šå°†å¤æ‚çš„æœ€çŸ­è·¯å¾„é—®é¢˜è½¬åŒ–ä¸ºå­æ ‘å¤§å°çš„è´¡çŒ®é—®é¢˜ã€‚
-   **æŠ€å·§B (è´ªå¿ƒç­–ç•¥)**ï¼šå°†æœ€å¤§çš„è¾¹æƒåˆ†é…ç»™æœ€å¤§çš„å­æ ‘å¤§å°ï¼Œæœ€å¤§åŒ–æ€»è´¡çŒ®ã€‚
-   **æŠ€å·§C (æ•°æ®ç»“æ„è¾…åŠ©)**ï¼šä½¿ç”¨çº¿æ®µæ ‘/å¹³è¡¡æ ‘/æ ‘çŠ¶æ•°ç»„åŠ¨æ€ç»´æŠ¤å­æ ‘ä¿¡æ¯ã€‚

### âš”ï¸ ç­–ç•¥ç«æŠ€åœºï¼šä¸åŒè§£æ³•çš„å¯¹æ¯”åˆ†æ

| ç­–ç•¥ | æ ¸å¿ƒæ€æƒ³ | ä¼˜ç‚¹ | ç¼ºç‚¹ä¸åˆ†æ | é€‚ç”¨åœºæ™¯ / å¾—åˆ†é¢„æœŸ |
| :--- | :--- | :--- | :--- |:--- |
| **æš´åŠ›æšä¸¾** | æšä¸¾æ‰€æœ‰å¯èƒ½çš„ \(t\) å’Œè¾¹æƒæ’åˆ— | æ€è·¯ç›´è§‚ | **æ—¶é—´å¤æ‚åº¦**: \(O(n!)\)ï¼Œå®Œå…¨ä¸å¯è¡Œ | \(n \le 10\) |
| **æ¢æ ¹ DP + æ’åº** | æšä¸¾ \(t\)ï¼Œè´ªå¿ƒåˆ†é…è¾¹æƒ | æ€è·¯æ¸…æ™° | **æ—¶é—´å¤æ‚åº¦**: \(O(n^2)\) | \(n \le 1000\) |
| **æ¢æ ¹ DP + çº¿æ®µæ ‘** | åŠ¨æ€ç»´æŠ¤å­æ ‘å¤§å°çš„æ’å | é«˜æ•ˆ | å®ç°ç¨å¤æ‚ | \(n \le 10^5\) |

### âœ¨ ä¼˜åŒ–ä¹‹æ—…ï¼šä»â€œèƒ½åšâ€åˆ°â€œåšå¥½â€
> ä»æš´åŠ›æšä¸¾åˆ°æ¢æ ¹ DPï¼Œæˆ‘ä»¬ç»å†äº†ä¸€ä¸ªâ€œé—®é¢˜è½¬åŒ–â€å’Œâ€œæ•ˆç‡ä¼˜åŒ–â€çš„è¿‡ç¨‹ã€‚è´ªå¿ƒç­–ç•¥çš„æ­£ç¡®æ€§ä¿è¯äº†ç®—æ³•çš„æœ‰æ•ˆæ€§ï¼Œè€Œçº¿æ®µæ ‘/å¹³è¡¡æ ‘çš„ä½¿ç”¨åˆ™å°†æ—¶é—´å¤æ‚åº¦ä» \(O(n^2)\) ä¼˜åŒ–åˆ° \(O(n \log n)\)ã€‚

---

## 4. C++æ ¸å¿ƒä»£ç å®ç°èµæ

**æœ¬é¢˜é€šç”¨æ ¸å¿ƒC++å®ç°å‚è€ƒ**
* **è¯´æ˜**ï¼šæœ¬ä»£ç ç»¼åˆäº†å¤šä¸ªä¼˜è´¨é¢˜è§£çš„æ€è·¯ï¼Œä½¿ç”¨çº¿æ®µæ ‘åŠ¨æ€ç»´æŠ¤å­æ ‘å¤§å°çš„æ’åã€‚
* **å®Œæ•´æ ¸å¿ƒä»£ç **ï¼š
    ```cpp
    #include <bits/stdc++.h>
    using namespace std;
    typedef long long ll;
    const int MOD = 998244353;
    const int N = 1e5 + 10;

    int n, siz[N], pos;
    ll ans, gans;
    vector<int> G[N];

    struct SegmentTree {
        struct Node {
            int l, r, cnt;
            ll sum, ans;
        } tr[N << 2];

        void build(int k, int l, int r) {
            tr[k] = {l, r, 0, 0, 0};
            if (l == r) return;
            int mid = (l + r) >> 1;
            build(k << 1, l, mid);
            build(k << 1 | 1, mid + 1, r);
        }

        void update(int k, int x, int v) {
            if (tr[k].l == x && x == tr[k].r) {
                tr[k].cnt += v;
                tr[k].sum += v * x;
                if (v == 1) tr[k].ans += 1ll * tr[k].cnt * x;
                else tr[k].ans -= 1ll * (tr[k].cnt + 1) * x;
                return;
            }
            int mid = (tr[k].l + tr[k].r) >> 1;
            if (x <= mid) update(k << 1, x, v);
            else update(k << 1 | 1, x, v);
            tr[k].cnt = tr[k << 1].cnt + tr[k << 1 | 1].cnt;
            tr[k].sum = tr[k << 1].sum + tr[k << 1 | 1].sum;
            tr[k].ans = tr[k << 1].ans + tr[k << 1 | 1].ans + 1ll * tr[k << 1].cnt * tr[k << 1 | 1].sum;
        }
    } seg;

    void dfs1(int u, int fa) {
        siz[u] = 1;
        for (int v : G[u]) if (v != fa) {
            dfs1(v, u);
            siz[u] += siz[v];
        }
    }

    void dfs2(int u, int fa) {
        for (int v : G[u]) if (v != fa) {
            int pre = siz[v];
            seg.update(1, siz[v], -1);
            seg.update(1, n - siz[v], 1);
            siz[u] -= siz[v];
            siz[v] = n;
            if (seg.tr[1].ans > gans) {
                gans = seg.tr[1].ans;
                pos = v;
            } else if (seg.tr[1].ans == gans && v < pos) {
                pos = v;
            }
            dfs2(v, u);
            siz[v] = pre;
            siz[u] = n;
            seg.update(1, n - siz[v], -1);
            seg.update(1, siz[v], 1);
        }
    }

    int main() {
        ios::sync_with_stdio(false);
        cin.tie(nullptr);
        cin >> n;
        for (int i = 1, u, v; i < n; ++i) {
            cin >> u >> v;
            G[u].push_back(v);
            G[v].push_back(u);
        }
        seg.build(1, 1, n);
        dfs1(1, 0);
        for (int i = 2; i <= n; ++i) seg.update(1, siz[i], 1);
        gans = seg.tr[1].ans;
        pos = 1;
        dfs2(1, 0);
        cout << (2ll * n % MOD * gans % MOD + MOD) % MOD << '\n';
        cout << pos << '\n';
        dfs1(pos, 0);
        vector<pair<int, int>> vec;
        for (int i = 1; i <= n; ++i) if (i != pos) {
            vec.emplace_back(siz[i], i);
        }
        sort(vec.begin(), vec.end());
        vector<int> w(n);
        for (int i = 0; i < n - 1; ++i) {
            w[vec[i].second] = n - i - 1;
        }
        for (int i = 1; i < n; ++i) cout << w[i] << " \n"[i == n - 1];
        return 0;
    }
    ```
* **ä»£ç è§£è¯»æ¦‚è¦**ï¼šè¯¥ä»£ç é¦–å…ˆé€šè¿‡ DFS è®¡ç®—å­æ ‘å¤§å°ï¼Œç„¶åä½¿ç”¨çº¿æ®µæ ‘åŠ¨æ€ç»´æŠ¤å­æ ‘å¤§å°çš„æ’åï¼Œå®ç°æ¢æ ¹ DPã€‚æœ€åï¼Œæ ¹æ®å­æ ‘å¤§å°çš„æ’åè´ªå¿ƒåˆ†é…è¾¹æƒã€‚

---

## 5. ç®—æ³•å¯è§†åŒ–ï¼šåƒç´ åŠ¨ç”»æ¼”ç¤º (æ ¸å¿ƒéƒ¨åˆ†)

**åŠ¨ç”»æ¼”ç¤ºä¸»é¢˜**ï¼šåƒç´ æ¢é™©å®¶åœ¨æ ‘å½¢è¿·å®«ä¸­å¯»æ‰¾æœ€ä¼˜å¿…ç»ç‚¹ \(t\)ã€‚

**æ ¸å¿ƒæ¼”ç¤ºå†…å®¹**ï¼šåŠ¨æ€å±•ç¤ºæ¢æ ¹ DP è¿‡ç¨‹ä¸­ï¼Œå­æ ‘å¤§å°å¦‚ä½•å˜åŒ–ï¼Œä»¥åŠå¦‚ä½•è´ªå¿ƒåˆ†é…è¾¹æƒã€‚

**è®¾è®¡æ€è·¯ç®€è¿°**ï¼š
- é‡‡ç”¨8ä½åƒç´ é£æ ¼ï¼Œå±•ç¤ºæ ‘å½¢ç»“æ„çš„èŠ‚ç‚¹å’Œè¾¹ã€‚
- æ¯ä¸ªèŠ‚ç‚¹ç”¨åƒç´ æ–¹å—è¡¨ç¤ºï¼Œè¾¹çš„æƒå€¼ç”¨é¢œè‰²æ·±æµ…è¡¨ç¤ºã€‚
- åŠ¨ç”»å±•ç¤ºæ¢æ ¹ DP è¿‡ç¨‹ä¸­ï¼Œå­æ ‘å¤§å°çš„æ›´æ–°å’Œè¾¹æƒçš„é‡æ–°åˆ†é…ã€‚

**åŠ¨ç”»å¸§æ­¥éª¤ä¸äº¤äº’å…³é”®ç‚¹**ï¼š
1.  **åœºæ™¯åˆå§‹åŒ–**ï¼šå±•ç¤ºæ ‘å½¢è¿·å®«çš„åƒç´ åŒ–ç»“æ„ã€‚
2.  **å­æ ‘å¤§å°è®¡ç®—**ï¼šé«˜äº®å½“å‰æ ¹èŠ‚ç‚¹ï¼Œå±•ç¤ºå­æ ‘å¤§å°çš„è®¡ç®—è¿‡ç¨‹ã€‚
3.  **æ¢æ ¹ DP**ï¼šåŠ¨æ€å±•ç¤ºæ ¹èŠ‚ç‚¹çš„è½¬ç§»ï¼Œå­æ ‘å¤§å°çš„æ›´æ–°ã€‚
4.  **è´ªå¿ƒåˆ†é…è¾¹æƒ**ï¼šæ ¹æ®å­æ ‘å¤§å°æ’åºï¼Œé«˜äº®æ˜¾ç¤ºè¾¹æƒçš„åˆ†é…è¿‡ç¨‹ã€‚

---

## 6. æ‹“å±•ç»ƒä¹ ä¸ç›¸ä¼¼é—®é¢˜æ€è€ƒ

**é€šç”¨æ€è·¯/æŠ€å·§è¿ç§»**ï¼š
- æ¢æ ¹ DP é€‚ç”¨äºæ‰€æœ‰éœ€è¦åœ¨æ ‘ä¸Šæšä¸¾æ ¹èŠ‚ç‚¹çš„é—®é¢˜ï¼Œå¦‚æ ‘çš„ç›´å¾„ã€é‡å¿ƒç­‰ã€‚
- è´ªå¿ƒç­–ç•¥é€‚ç”¨äºéœ€è¦æœ€å¤§åŒ–æˆ–æœ€å°åŒ–å¸¦æƒè´¡çŒ®çš„é—®é¢˜ï¼Œå¦‚ä»»åŠ¡è°ƒåº¦ã€èµ„æºåˆ†é…ç­‰ã€‚

**ç»ƒä¹ æ¨è (æ´›è°·)**ï¼š
1.  **æ´›è°· P3384** - æ ‘é“¾å‰–åˆ†
      * ğŸ—£ï¸ **æ¨èç†ç”±**ï¼šå·©å›ºæ¢æ ¹ DP å’Œæ ‘å½¢ç»“æ„çš„ç†è§£ã€‚
2.  **æ´›è°· P1352** - æ²¡æœ‰ä¸Šå¸çš„èˆä¼š
      * ğŸ—£ï¸ **æ¨èç†ç”±**ï¼šå­¦ä¹ æ ‘å½¢ DP çš„ç»å…¸åº”ç”¨ã€‚
3.  **æ´›è°· P2015** - äºŒå‰è‹¹æœæ ‘
      * ğŸ—£ï¸ **æ¨èç†ç”±**ï¼šç»ƒä¹ å¸¦çº¦æŸçš„æ ‘å½¢ DPã€‚

---

## 7. å­¦ä¹ å¿ƒå¾—ä¸ç»éªŒåˆ†äº« (è‹¥æœ‰)

> **å‚è€ƒç»éªŒ (æ¥è‡ª Genius_Star)**ï¼šâ€œæœ€åæˆ‘è®¤ä¸ºå¹¶ä¸å¥½æƒ³åˆ°å€¼åŸŸçº¿æ®µæ ‘çš„åšæ³•ï¼Œæ¯”è¾ƒæ˜¾ç„¶çš„åº”è¯¥æ˜¯æ¥¼ä¸‹è€å“¥çš„å¹³è¡¡æ ‘åšæ³•ã€‚â€
>
> **ç‚¹è¯„**ï¼šè¿™ä½ä½œè€…çš„ç»éªŒæé†’æˆ‘ä»¬ï¼Œé€‰æ‹©åˆé€‚çš„æ•°æ®ç»“æ„ï¼ˆçº¿æ®µæ ‘ vs å¹³è¡¡æ ‘ï¼‰å¯ä»¥ç®€åŒ–å®ç°ï¼Œä½†æ€è·¯çš„æ¸…æ™°æ€§æ›´é‡è¦ã€‚

---

<conclusion>
æœ¬æ¬¡å…³äºâ€œè¿·å®«å¯»è·¯ Round 3â€çš„C++è§£é¢˜åˆ†æå°±åˆ°è¿™é‡Œã€‚å¸Œæœ›è¿™ä»½å­¦ä¹ æŒ‡å—èƒ½å¸®åŠ©å¤§å®¶æ›´å¥½åœ°ç†è§£ç›¸å…³ç®—æ³•å’Œç¼–ç¨‹æŠ€å·§ã€‚è®°ä½ï¼Œç¼–ç¨‹èƒ½åŠ›çš„æå‡åœ¨äºæŒç»­å­¦ä¹ ã€å‹¤äºæ€è€ƒå’Œå‹‡äºå®è·µã€‚ä¸‹æ¬¡æˆ‘ä»¬å†ä¸€èµ·æ¢ç´¢æ–°çš„ç¼–ç¨‹æŒ‘æˆ˜ï¼ğŸ’ª
</conclusion>

---
å¤„ç†ç”¨æ—¶ï¼š111.03ç§’
# é¢˜ç›®ä¿¡æ¯

# ã€ŒTAOI-2ã€Cialloï½(âˆ ãƒ»Ï‰< )âŒ’â˜…

## é¢˜ç›®èƒŒæ™¯

æŸšå­å¨å·®ä¸å¤šå¾—äº†ã€‚

~(Â·<)~(Â·<)~(Â·<)~(Â·<)~(Â·<)~(Â·<)~(Â·<)~(Â·<)~(Â·<)~(Â·<)~(Â·<)~(Â·<)~(Â·<)~(Â·<)

![](https://cdn.luogu.com.cn/upload/image_hosting/0nqiwonz.png)

## é¢˜ç›®æè¿°

å° Î´ å–œæ¬¢é€ è¯ã€‚ä»–å­¦ä¹ äº†ä¸€ç§é€ è¯æ–¹æ³•ã€‚

é¦–å…ˆï¼Œä»–æ‹¥æœ‰ä¸€ä¸ªã€Œæ¨¡æ¿ä¸²ã€ï¼Œè®¾ä¸º $s$ã€‚ç„¶åä»–ä¼šé€‰æ‹©ä¸€å¯¹ $1 \le l \le r \le |s|$ï¼Œå°† $s$ çš„ç¬¬ $l$ è‡³ $r$ ä¸ªå­—ç¬¦åˆ æ‰ï¼ŒæŠŠä¸¤è¾¹çš„å­—ç¬¦ä¸²æ‹¼èµ·æ¥ï¼Œä»–è®¾å¾—åˆ°çš„è¿™ä¸ªæ–°å­—ç¬¦ä¸²ä¸º $s'$ã€‚

æ¥ä¸‹æ¥ï¼Œä»–ä¼šé€‰æ‹©ä¸€å¯¹æ–°çš„ $1 \le l' \le r' \le |s'|$ï¼Œç„¶åè®¾ $s'$ çš„ç¬¬ $l'$ è‡³ $r'$ ä¸ªå­—ç¬¦ç»„æˆçš„å­—ç¬¦ä¸²ä¸º $s''$ã€‚ä»–æ‰€é€ å‡ºçš„è¿™ä¸ªè¯å°±æ˜¯ $s''$ã€‚

ä¾‹å¦‚ï¼Œå¦‚æœã€Œæ¨¡æ¿ä¸²ã€ä¸º $s=\texttt{cciaohalloo}$ï¼Œé‚£ä¹ˆä¸€ç§é€ è¯æ–¹æ³•æ˜¯ï¼Œé€‰æ‹© $l=5$ï¼Œ$r=7$ï¼Œå¾—åˆ° $s'=\texttt{ccialloo}$ï¼Œç„¶åé€‰æ‹© $l'=2$ï¼Œ$r'=7$ï¼Œå¾—åˆ° $s''=\texttt{ciallo}$ã€‚

ç°åœ¨å° Î´ æœ‰ä¸€ä¸ªã€Œç›®æ ‡ä¸²ã€ $t$ï¼Œä»–æƒ³çŸ¥é“æœ‰å¤šå°‘ç§ä¸åŒçš„æ–¹æ¡ˆï¼Œå¯ä»¥ä½¿ç”¨ã€Œæ¨¡æ¿ä¸²ã€$s$ é€ å‡ºå•è¯ $t$ã€‚å®šä¹‰ä¸¤ç§æ–¹æ¡ˆç›¸åŒå½“ä¸”ä»…å½“é€‰æ‹©çš„ $l,r,l',r'$ å‡ç›¸åŒã€‚

## è¯´æ˜/æç¤º

### æ•°æ®èŒƒå›´

**æœ¬é¢˜é‡‡ç”¨æ†ç»‘æµ‹è¯•**ã€‚

- Subtask 0ï¼ˆ6 pointsï¼‰ï¼š$|s| \le 400$ï¼Œ$|t| \le 200$ã€‚
- Subtask 1ï¼ˆ10 pointsï¼‰ï¼š$|s| \le 700$ï¼Œ$|t| \le 300$ã€‚
- Subtask 2ï¼ˆ10 pointsï¼‰ï¼š$\forall i,j,s_i=t_j$ã€‚
- Subtask 3ï¼ˆ10 pointsï¼‰ï¼š$|t|=1$ã€‚
- Subtask 4ï¼ˆ20 pointsï¼‰ï¼š$|s| \le 10^4$ï¼Œ$|t| \le 3 \times 10^3$ã€‚
- Subtask 5ï¼ˆ14 pointsï¼‰ï¼š$|t|=2$ã€‚
- Subtask 6ï¼ˆ30 pointsï¼‰ï¼šæ— ç‰¹æ®Šé™åˆ¶ã€‚

å¯¹äºæ‰€æœ‰æµ‹è¯•æ•°æ®ï¼Œ$1 \le |s| \le 4 \times 10^5$ï¼Œ$1 \le |t| \le 2 \times 10^5$ã€‚$s,t$ åªåŒ…å«å°å†™è‹±æ–‡å­—æ¯ã€‚

## æ ·ä¾‹ #1

### è¾“å…¥

```
aabbaaba
aba```

### è¾“å‡º

```
23```

## æ ·ä¾‹ #2

### è¾“å…¥

```
ciaohallo
ciallo```

### è¾“å‡º

```
2```

## æ ·ä¾‹ #3

### è¾“å…¥

```
babacbbaababbacbababbabbbaaabaabababbabbabababba
ababab```

### è¾“å‡º

```
1535```

## æ ·ä¾‹ #4

### è¾“å…¥

```
sssssssssssssssssssssssssssssssssssss
sss```

### è¾“å‡º

```
15470```

## æ ·ä¾‹ #5

### è¾“å…¥

```
abcbbbcbcbcbacbacbaaabcbcbcbaabacbca
cb```

### è¾“å‡º

```
3995```

# AIåˆ†æç»“æœ

ğŸ’¡ æ´›è¯­äº‘ç¬ºçš„ C++ ç®—æ³•è§£æï¼šã€ŒTAOI-2ã€Cialloï½ æ·±å…¥å­¦ä¹ æŒ‡å— ğŸ’¡

> ä»Šå¤©æˆ‘ä»¬æ¥ä¸€èµ·åˆ†æã€ŒTAOI-2ã€Cialloï½ è¿™é“å­—ç¬¦ä¸²è®¡æ•°é¢˜ã€‚å®ƒè¡¨é¢å¯çˆ±ï¼Œå®åˆ™æš—è—â€œå‰åç¼€æ‹¼æ¥â€çš„æ€æœºã€‚æˆ‘ä»¬å°†å­¦ä¼šå¦‚ä½•æŠŠâ€œåˆ é™¤ä¸€æ®µå†å–ä¸€æ®µâ€çš„å¤æ‚æ“ä½œï¼Œè½¬åŒ–ä¸ºå¯è®¡ç®—çš„ç»„åˆæ•°å­¦ + äºŒç»´ååºé—®é¢˜ã€‚

---

## 1. é¢˜ç›®è§£è¯»ä¸ç­–ç•¥åˆæ¢

âœ¨ **æœ¬é¢˜æ ¸å¿ƒæŒ‘æˆ˜**ï¼š  
> åœ¨æ¨¡æ¿ä¸² `s` ä¸­ï¼Œå…ˆåˆ é™¤ä»»æ„è¿ç»­ä¸€æ®µåŒºé—´ `[l,r]`ï¼Œå†ä»å‰©ä¸‹çš„å‰ç¼€ä¸åç¼€ä¸­å„å–ä¸€æ®µæ‹¼æˆç›®æ ‡ä¸² `t`ï¼Œæ±‚æ‰€æœ‰æ»¡è¶³æ¡ä»¶çš„å››å…ƒç»„ `(l,r,l',r')` çš„æ€»æ•°ã€‚

âœ¨ **æ ¸å¿ƒç®—æ³•æ ‡ç­¾**ï¼š  
- å­—ç¬¦ä¸²å“ˆå¸Œ / æ‰©å±• KMPï¼ˆZ å‡½æ•°ï¼‰  
- äºŒç»´ååºï¼ˆæ ‘çŠ¶æ•°ç»„ / çº¿æ®µæ ‘ï¼‰  
- å‰ç¼€å’Œ & ç»„åˆè®¡æ•°

ğŸ—£ï¸ **åˆæ­¥åˆ†æ**ï¼š  
1. **ç›´è§‚æš´åŠ›**â€ƒæšä¸¾åˆ é™¤åŒºé—´ `[l,r]`ï¼Œå†æšä¸¾å­ä¸² `[l',r']` â†’ å¤æ‚åº¦ `O(n^3)`ï¼Œæ˜¾ç„¶çˆ†ç‚¸ã€‚  
2. **åˆ†ç±»è®¨è®º**â€ƒæŠŠç­”æ¡ˆæ‹†æˆä¸¤éƒ¨åˆ†ï¼š  
   - **æ•´æ®µå‡ºç°**ï¼š`t` å®Œæ•´åœ°å‡ºç°åœ¨å‰ç¼€æˆ–åç¼€ï¼Œåˆ é™¤åŒºé—´ä¸ä¸å…¶ç›¸äº¤ã€‚  
   - **ä¸¤æ®µæ‹¼æ¥**ï¼š`t` ç”±å‰ç¼€çš„ä¸€æ®µå’Œåç¼€çš„ä¸€æ®µæ‹¼æˆï¼Œä¸­é—´è¢«åˆ é™¤åŒºé—´éš”å¼€ã€‚  
3. **æ•°å­¦è½¬åŒ–**â€ƒå°†â€œä¸¤æ®µæ‹¼æ¥â€è½¬åŒ–ä¸ºã€Œæšä¸¾åˆ†å‰²ç‚¹ `k`ï¼Œç»Ÿè®¡æ»¡è¶³ `LCP + LCS â‰¥ m` ä¸”ä½ç½®åˆæ³•çš„å‰ç¼€-åç¼€å¯¹ã€ã€‚  
4. **æ•°æ®ç»“æ„**â€ƒäºŒç»´ååºé—®é¢˜ç”¨æ ‘çŠ¶æ•°ç»„æˆ–çº¿æ®µæ ‘å³å¯ `O(n log n)`ã€‚

### ğŸ” ç®—æ³•ä¾¦æ¢ï¼šå¦‚ä½•åœ¨é¢˜ç›®ä¸­å‘ç°çº¿ç´¢ï¼Ÿ

| çº¿ç´¢ | ä¾¦æ¢ç¬”è®° |
|---|---|
| **é—®é¢˜ç›®æ ‡** | â€œæœ‰å¤šå°‘ç§ä¸åŒæ–¹æ¡ˆâ€ â†’ ç»„åˆè®¡æ•°ã€‚ |
| **å…³é”®æ“ä½œ** | åˆ é™¤ä¸€æ®µ + å–å‰åç¼€ â†’ å‰åç¼€æ‹¼æ¥æ¨¡å‹ã€‚ |
| **æ•°æ®è§„æ¨¡** | `n â‰¤ 4e5` â†’ `O(n log n)` çº§åˆ«ç®—æ³•ã€‚ |
| **å­—ç¬¦é›†** | å°å†™å­—æ¯ â†’ å­—ç¬¦ä¸²å“ˆå¸Œ / Z å‡½æ•°å¯è¡Œã€‚ |

### ğŸ§  æ€ç»´é“¾æ„å»ºï¼šä»çº¿ç´¢åˆ°ç­–ç•¥
> 1. é¦–å…ˆï¼Œæˆ‘æ³¨æ„åˆ°â€œåˆ é™¤åŒºé—´â€ä¸â€œé€‰å–å­ä¸²â€ç›¸äº’ç‹¬ç«‹ï¼Œäºæ˜¯æƒ³åˆ°æŠŠé—®é¢˜æ‹†æˆ **æ•´æ®µå‡ºç°** ä¸ **ä¸¤æ®µæ‹¼æ¥**ã€‚  
> 2. å¯¹äºä¸¤æ®µæ‹¼æ¥ï¼Œæˆ‘æ„è¯†åˆ°éœ€è¦çŸ¥é“â€œæ¯ä¸ªä½ç½®ä½œä¸ºå‰ç¼€èƒ½åŒ¹é…å¤šé•¿â€ä»¥åŠâ€œä½œä¸ºåç¼€èƒ½åŒ¹é…å¤šé•¿â€ï¼Œäºæ˜¯å¼•å…¥ **LCP/LCS** æ•°ç»„ã€‚  
> 3. æœ‰äº† LCP/LCSï¼Œæ¡ä»¶å˜æˆ `LCP[i] + LCS[j] â‰¥ m` ä¸” `j - i â‰¥ m`ï¼Œè¿™æ­£æ˜¯ä¸€ä¸ª **äºŒç»´ååº**ï¼Œæ ‘çŠ¶æ•°ç»„å³å¯è§£å†³ã€‚  
> 4. æœ€ç»ˆå¤æ‚åº¦ `O(n log n)`ï¼Œå®Œç¾å¥‘åˆæ•°æ®èŒƒå›´ï¼

---

## 2. ç²¾é€‰ä¼˜è´¨é¢˜è§£å‚è€ƒ

> ä¸‹é¢ 5 ä»½é¢˜è§£å‡ â‰¥4 æ˜Ÿï¼Œæ€è·¯ç»Ÿä¸€ï¼šå…ˆå“ˆå¸Œ/Z å‡½æ•°æ±‚ LCP/LCSï¼Œå†äºŒç»´ååºç»Ÿè®¡ã€‚å·®å¼‚ä»…åœ¨äºå®ç°ç»†èŠ‚ä¸æ•°æ®ç»“æ„é€‰æ‹©ã€‚

| é¢˜è§£ | äº®ç‚¹æç‚¼ |
|---|---|
| **251Sec** | ç”¨ **æ ‘çŠ¶æ•°ç»„ç»´æŠ¤å˜åŒ–é‡** çš„æ€æƒ³æœ€æ¸…æ™°ï¼šéšç€åˆ†å‰²ç‚¹ç§»åŠ¨ï¼Œé›†åˆ A/B çš„æ€»å˜åŒ–é‡åªæœ‰ `O(n)`ï¼Œå› æ­¤å¯ä»¥â€œè¾¹ç§»åŠ¨è¾¹ç»´æŠ¤ç­”æ¡ˆâ€ã€‚ |
| **Register_int** | **æ‰©å±• KMP** æ¨¡æ¿ç®€æ´ï¼›æŠŠäºŒç»´ååºå†™æˆâ€œç¦»çº¿æ‰«æ + BITâ€ï¼Œä»£ç æœ€çŸ­ã€‚ |
| **lfxxx** | **çº¿æ®µæ ‘** å®ç°åŒºé—´åŠ  & åŒºé—´æ±‚å’Œï¼Œå¯¹åˆå­¦è€…æ›´å‹å¥½ï¼›åŒæ—¶ç»™å‡ºå‡ ä½•ç›´è§‚å›¾ã€‚ |
| **xtzqhy** | æå‡º **ä¸èƒ½é‡å¤è®¡ç®—æ•´æ®µå‡ºç°** çš„è¾¹ç•Œå¤„ç†ï¼ˆ`xâ‰ m, yâ‰ m`ï¼‰ï¼Œç»†èŠ‚ä¸¥è°¨ã€‚ |
| **Jeefy** | ç”¨ **åŒå“ˆå¸Œ** é˜²æ­¢è¢«å¡ï¼›å˜é‡å‘½åç›´è§‚ï¼ˆ`f[i], g[i]`ï¼‰ï¼›é™„é€â€œé²œèŠ±â€åæ§½ã€‚ |

---

## 3. è§£é¢˜ç­–ç•¥æ·±åº¦å‰–æ

### ğŸ¯ æ ¸å¿ƒéš¾ç‚¹ä¸å…³é”®æ­¥éª¤ï¼ˆæœ€ä¼˜è§£æ³•ï¼‰

| å…³é”®ç‚¹ | åˆ†æ & å­¦ä¹ ç¬”è®° |
|---|---|
| **1. æ±‚ LCP/LCS æ•°ç»„** | ç”¨ **æ‰©å±• KMPï¼ˆZ ç®—æ³•ï¼‰** æˆ– **åŒå“ˆå¸Œ + äºŒåˆ†** å‡å¯ `O(n log n)`ã€‚  
ğŸ’¡ å­¦ä¹ ç¬”è®°ï¼šæ‰©å±• KMP ä¸€éé¢„å¤„ç†ï¼Œå¸¸æ•°æ›´å°ï¼›å“ˆå¸Œæ›´æ˜“å†™ä½†è¦é˜²å†²çªã€‚ |
| **2. åˆ†ç±»ç»Ÿè®¡** | å…ˆå•ç‹¬ç»Ÿè®¡ **æ•´æ®µå‡ºç°** çš„è´¡çŒ®ï¼šè‹¥ `s[i..i+m-1] = t`ï¼Œåˆ™è´¡çŒ® `C(i-1,2) + C(n-i-m+1,2)`ã€‚  
ğŸ’¡ å­¦ä¹ ç¬”è®°ï¼šç»„åˆæ•°å…¬å¼ `C(x,2) = x(x-1)/2` è¦ç»†å¿ƒè¾¹ç•Œã€‚ |
| **3. äºŒç»´ååºå»ºæ¨¡** | å¯¹äºæ‹¼æ¥æƒ…å†µï¼ŒæŠŠæ¯å¯¹ `(i,j)` çœ‹æˆç‚¹ `(LCP[i], LCS[j])`ï¼Œæ»¡è¶³ `LCP[i] + LCS[j] â‰¥ m` ä¸” `j-i â‰¥ m`ã€‚  
ğŸ’¡ å­¦ä¹ ç¬”è®°ï¼šå°†ä¸ç­‰å¼ `LCS[j] â‰¥ m - LCP[i]` è½¬åŒ–ä¸ºåŒºé—´æŸ¥è¯¢ã€‚ |
| **4. æ•°æ®ç»“æ„ä¼˜åŒ–** | ç¦»çº¿æ‰«æ + BITï¼š  
- æŒ‰ `j` ä»å¤§åˆ°å°æ‰«æï¼Œä¿è¯ `j-i â‰¥ m`ã€‚  
- æ ‘çŠ¶æ•°ç»„ç»´æŠ¤ `LCS` çš„åŒºé—´å’Œä¸è®¡æ•°ã€‚  
ğŸ’¡ å­¦ä¹ ç¬”è®°ï¼šæ‰«æçº¿æ€æƒ³æ˜¯å¤„ç†äºŒç»´ååºçš„é€šç”¨å¥—è·¯ã€‚ |

### âœ¨ è§£é¢˜æŠ€å·§æ€»ç»“

- **å‰åç¼€æ‹¼æ¥æ¨¡å‹**ï¼šé‡åˆ°â€œåˆ é™¤ä¸­é—´ã€ä¿ç•™ä¸¤ç«¯â€ç±»é—®é¢˜ï¼Œå…ˆæ±‚ LCP/LCS å†äºŒç»´ååºã€‚  
- **æ‰©å±• KMP æ¨¡æ¿**ï¼š`z[i]` è¡¨ç¤º `s[i..n]` ä¸ `t` çš„æœ€é•¿å…¬å…±å‰ç¼€ï¼›åå‘è·‘å³å¯æ±‚ LCSã€‚  
- **æ ‘çŠ¶æ•°ç»„æŠ€å·§**ï¼šåŒºé—´åŠ  & åŒºé—´å’Œå¯ç”¨ä¸¤ä¸ª BITï¼ˆå·®åˆ†æ€æƒ³ï¼‰æˆ–ä¸€ä¸ª BIT ç»´æŠ¤ `(cnt, sum)`ã€‚

### âš”ï¸ ç­–ç•¥ç«æŠ€åœºï¼šä¸åŒè§£æ³•çš„å¯¹æ¯”åˆ†æ

| ç­–ç•¥ | æ ¸å¿ƒæ€æƒ³ | ä¼˜ç‚¹ | ç¼ºç‚¹ | é€‚ç”¨åœºæ™¯ |
|---|---|---|---|---|
| **æš´åŠ›æšä¸¾** | ä¸‰é‡å¾ªç¯æšä¸¾ `(l,r,l',r')` | æ€è·¯ç›´è§‚ | `O(n^3)` çˆ†ç‚¸ | `n â‰¤ 200` çš„å°æ•°æ® |
| **å“ˆå¸Œ+äºŒç»´ååº** | å“ˆå¸Œæ±‚ LCP/LCSï¼Œæ ‘çŠ¶æ•°ç»„ç»Ÿè®¡ | `O(n log n)`ï¼Œå®ç°ç®€å• | å“ˆå¸Œå†²çªé£é™© | é€šç”¨æ­£è§£ |
| **æ‰©å±• KMP+BIT** | çº¿æ€§æ±‚ LCP/LCSï¼Œæ‰«æçº¿ | å¸¸æ•°å°ï¼Œæœ€ä¼˜é›… | éœ€èƒŒ Z ç®—æ³•æ¨¡æ¿ | è¿½æ±‚æœ€å¿« |
| **åç¼€è‡ªåŠ¨æœº** | å»ºæ­£å SAMï¼Œçº¿æ®µæ ‘åˆå¹¶ | å¯æ‰©å±•æ›´å¤æ‚é—®é¢˜ | ä»£ç é‡å·¨å¤§ | ç ”ç©¶/å¡å¸¸ |

### âœ¨ ä¼˜åŒ–ä¹‹æ—…ï¼šä»â€œèƒ½åšâ€åˆ°â€œåšå¥½â€
> æš´åŠ›æšä¸¾ â†’ å‘ç° `O(n^3)` ä¸è¡Œ â†’ æ‹†åˆ†ç±»åˆ« â†’ å‘ç°éœ€è¦ LCP/LCS â†’ å“ˆå¸Œ/Z å‡½æ•° â†’ äºŒç»´ååº â†’ æ ‘çŠ¶æ•°ç»„ â†’ `O(n log n)` é€šè¿‡ï¼

---

## 4. C++ æ ¸å¿ƒä»£ç å®ç°èµæ

### æœ¬é¢˜é€šç”¨æ ¸å¿ƒå®ç°å‚è€ƒï¼ˆæ‰©å±• KMP + BITï¼‰

```cpp
#include <bits/stdc++.h>
using namespace std;
typedef long long ll;
const int N = 4e5 + 10;

int n, m;
char s[N], t[N];
int z[N], p[N], q[N];

void getZ(char *s, int n) {
    z[1] = n;
    for (int i = 2, l = 0, r = 0; i <= n; ++i) {
        if (i <= r) z[i] = min(r - i + 1, z[i - l + 1]);
        while (i + z[i] <= n && s[z[i] + 1] == s[i + z[i]]) ++z[i];
        if (i + z[i] - 1 > r) l = i, r = i + z[i] - 1;
    }
}

void exKMP(char *s, int n, char *t, int m, int *res) {
    getZ(t, m);
    for (int i = 1, l = 0, r = 0; i <= n; ++i) {
        if (i <= r) res[i] = min(r - i + 1, z[i - l + 1]);
        while (i + res[i] <= n && res[i] < m && s[i + res[i]] == t[res[i] + 1]) ++res[i];
        if (i + res[i] - 1 > r) l = i, r = i + res[i] - 1;
    }
}

struct BIT {
    ll c1[N], c2[N];
    void add(int x, int v) {
        for (int i = x; i <= m; i += i & -i) c1[i] += v, c2[i] += 1LL * v * x;
    }
    ll ask(int x) {
        ll res = 0, cnt = 0;
        for (int i = x; i; i -= i & -i) res += c1[i], cnt += c2[i];
        return res * (x + 1) - cnt;
    }
    ll range(int l, int r) { return l > r ? 0 : ask(r) - ask(l - 1); }
} bit;

ll C2(ll x) { return x * (x - 1) / 2; }

int main() {
    scanf("%s%s", s + 1, t + 1);
    n = strlen(s + 1), m = strlen(t + 1);
    exKMP(s, n, t, m, p);                // p[i] = LCP
    reverse(s + 1, s + n + 1);
    reverse(t + 1, t + m + 1);
    exKMP(s, n, t, m, q);                // q[i] = LCS, ä½†ä¸‹æ ‡åå‘
    reverse(q + 1, q + n + 1);

    ll ans = 0;
    // 1. æ•´æ®µå‡ºç°
    for (int i = 1; i + m - 1 <= n; ++i)
        if (p[i] == m) ans += C2(i) + C2(n - (i + m - 1) + 1);

    // 2. ä¸¤æ®µæ‹¼æ¥
    for (int j = n; j >= m + 1; --j) {
        bit.add(q[j] + 1, 1);  // æ ‘çŠ¶æ•°ç»„ä¸‹æ ‡ä» 1 å¼€å§‹
        int l = max(1, m - p[j - m]), r = m - 1;
        ans += bit.range(l, r) * (p[j - m] - m + 1) + bit.range(l, r);  // å…¬å¼æ¨å¯¼
    }
    printf("%lld\n", ans);
    return 0;
}
```

---

## 5. ç®—æ³•å¯è§†åŒ–ï¼šåƒç´ åŠ¨ç”»æ¼”ç¤º

**ä¸»é¢˜**ï¼šã€Œåƒç´ æ¢é™©å®¶ã€åœ¨å­—ç¬¦ä¸²å¤§é™†ä¸Šå¯»æ‰¾é­”æ³•ç‰‡æ®µ `t`

- **åœºæ™¯**ï¼š8Ã—N åƒç´ ç½‘æ ¼ï¼Œ`s` çš„æ¯ä¸ªå­—ç¬¦æ˜¯åƒç´ å—ã€‚  
- **æ“ä½œé«˜äº®**ï¼š  
  - æ‰©å±• KMPï¼šç»¿è‰²å°„çº¿å‘å‰æ‰«æï¼Œæ˜¾ç¤º `LCP` é•¿åº¦ã€‚  
  - äºŒç»´ååºï¼šçº¢è‰²æŒ‡é’ˆä»å³å‘å·¦æ‰«æï¼Œæ¯é‡åˆ°åˆæ³• `(i,j)` å°±åœ¨ BIT ä¸Šé—ªçƒã€‚  
- **éŸ³æ•ˆ**ï¼š  
  - â€œå®â€â€”â€”æ‰¾åˆ°ä¸€å¯¹åˆæ³• `(i,j)`ã€‚  
  - â€œå’šâ€â€”â€”BIT æ›´æ–°æˆåŠŸã€‚  
- **äº¤äº’**ï¼š  
  - å•æ­¥/è‡ªåŠ¨æ’­æ”¾æŒ‰é’®ã€‚  
  - é€Ÿåº¦æ»‘å—ï¼šä» 0.5Ã— åˆ° 4Ã—ã€‚  
- **å…³å¡è®¾è®¡**ï¼š  
  - å…³å¡ 1ï¼šæ±‚ LCP åŠ¨ç”»  
  - å…³å¡ 2ï¼šæ‰«æçº¿ç»Ÿè®¡ç­”æ¡ˆ  

ï¼ˆå®ç°ï¼šHTML5 Canvas + 8-bit éŸ³æ•ˆï¼‰

---

## 6. æ‹“å±•ç»ƒä¹ ä¸ç›¸ä¼¼é—®é¢˜æ€è€ƒ

**é€šç”¨æŠ€å·§è¿ç§»**  
å‰åç¼€æ‹¼æ¥ + äºŒç»´ååºå¯è§£å†³ï¼š  
- è¯¾ç¨‹è¡¨ï¼šæ¯é—¨è¯¾æœ‰å‰ç½®/åç½®æ—¶é—´ï¼Œæ±‚é€‰è¯¾æ–¹æ¡ˆæ•°ã€‚  
- åŒºé—´è¦†ç›–ï¼šä¸¤æ®µåŒºé—´æ‹¼æˆç›®æ ‡åŒºé—´ã€‚  
- å­—ç¬¦ä¸²åŒ¹é…å˜ç§ï¼šå…è®¸ä¸­é—´ç¼ºå¤±å­—ç¬¦ã€‚

**æ´›è°·æ¨è**  
1. **P3808**ã€æ¨¡æ¿ã€‘AC è‡ªåŠ¨æœºï¼ˆç®€å•ç‰ˆï¼‰  
   ğŸ—£ï¸ å·©å›ºå­—ç¬¦ä¸²å¤šæ¨¡å¼åŒ¹é…ã€‚  
2. **P3375**ã€æ¨¡æ¿ã€‘KMP  
   ğŸ—£ï¸ ç†è§£å‰åç¼€å…¬å…±é•¿åº¦æ€æƒ³ã€‚  
3. **P4396** AHOI2013 ä½œä¸š  
   ğŸ—£ï¸ äºŒç»´ååº + æ‰«æçº¿ç»å…¸é¢˜ã€‚  
4. **P5262** SCOI2015 å°å‡¸ç©å¯†å®¤  
   ğŸ—£ï¸ æ›´å¤æ‚çš„äºŒç»´/ä¸‰ç»´ååºã€‚

---

## 7. å­¦ä¹ å¿ƒå¾—ä¸ç»éªŒåˆ†äº«

> **251Sec**ï¼š  
> â€œæˆ‘æœ€åˆæƒ³ç›´æ¥æšä¸¾æ‰€æœ‰ `(l,r,l',r')`ï¼Œç»“æœè¿æ ·ä¾‹ 3 éƒ½è·‘ä¸åŠ¨ã€‚åæ¥æ„è¯†åˆ°å¯ä»¥æ‹†æˆæ•´æ®µ + æ‹¼æ¥ï¼Œæ‹¼æ¥éƒ¨åˆ†ç”¨äºŒç»´ååºï¼Œç»ˆäº ACã€‚æé†’ï¼šäºŒç»´ååºåƒä¸‡åˆ«å†™åœ¨çº¿ï¼Œç¦»çº¿æ‰«æçº¿æ‰æ˜¯æ­£é“ï¼â€

ğŸ’¡ **æ´›è¯­äº‘ç¬ºç‚¹è¯„**ï¼š  
â€œæ‹†åˆ†é—®é¢˜ + æ•°æ®ç»“æ„ä¼˜åŒ–â€æ˜¯å­—ç¬¦ä¸²è®¡æ•°çš„é»„é‡‘ç»„åˆã€‚ä¸‹æ¬¡é‡åˆ°â€œåˆ é™¤+æ‹¼æ¥â€ç±»é¢˜ï¼Œå…ˆæƒ³ LCP/LCSï¼Œå†æ ‘çŠ¶æ•°ç»„ï¼

---

<conclusion>
ä»Šå¤©æˆ‘ä»¬ä¸€èµ·æ‹†è§£äº†ã€ŒTAOI-2ã€Cialloï½ çš„å¯çˆ±å¤–å£³ï¼ŒæŒæ¡äº†å‰åç¼€æ‹¼æ¥ + äºŒç»´ååºçš„é€šç”¨å¥—è·¯ã€‚è®°ä½ï¼šå¤æ‚å­—ç¬¦ä¸²é—®é¢˜å¾€å¾€å¯ä»¥æ‹†æˆâ€œæ•´æ®µâ€ä¸â€œæ‹¼æ¥â€ä¸¤ç±»ï¼Œå‰©ä¸‹çš„äº¤ç»™å“ˆå¸Œ/Z å‡½æ•°å’Œæ ‘çŠ¶æ•°ç»„ï¼ä¸‹æ¬¡è§ï¼Œç»§ç»­æ¢é™©ï½ ğŸ’ª
</conclusion>

---
å¤„ç†ç”¨æ—¶ï¼š88.47ç§’
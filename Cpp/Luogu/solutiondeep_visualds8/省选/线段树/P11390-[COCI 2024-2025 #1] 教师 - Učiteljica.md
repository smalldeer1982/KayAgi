# é¢˜ç›®ä¿¡æ¯

# [COCI 2024/2025 #1] æ•™å¸ˆ / UÄiteljica

## é¢˜ç›®èƒŒæ™¯

è¯‘è‡ª [COCI 2024/2025 #1](https://hsin.hr/coci/) T4ã€‚$\texttt{5s,0.5G}$ã€‚æ»¡åˆ†ä¸º $120$ã€‚

## é¢˜ç›®æè¿°

ç»™å®šé•¿åº¦ä¸º $n$ çš„æ­£æ•´æ•°åºåˆ— $a_1,a_2,\cdots,a_n$ã€‚ç»™å®šå¸¸æ•° $k$ã€‚

æ±‚å‡ºæ»¡è¶³ä»¥ä¸‹æ¡ä»¶çš„äºŒå…ƒç»„ $(l,r)$ çš„æ•°é‡ï¼š

- $1\le l\le r\le n$ï¼›
- å¯¹äºä»»æ„ $1\le i\le k$ï¼Œéƒ½å­˜åœ¨ä¸€ä¸ªæ•° $x$ï¼Œä½¿å¾— $x$ åœ¨ $a_l,a_{l+1},\ldots,a_r$ é—´å‡ºç°**æ°å¥½** $i$ æ¬¡ã€‚

## è¯´æ˜/æç¤º


å¯¹äº $100\%$ çš„æ•°æ®ï¼Œä¿è¯ï¼š

- $1\le n\le 10^5$ï¼›    
- $1\le k\le 4$ï¼›
- $1\le a_i\le n$ã€‚


| å­ä»»åŠ¡ç¼–å· | $n\le$ |  ç‰¹æ®Šæ€§è´¨ | å¾—åˆ† |  
| :--: | :--: | :--: |:--: | 
| $ 1 $    | $10^3$ |  |   $ 20 $   |  
| $ 2 $    | $10^5$ | A  |  $ 15 $   |  
| $ 3 $    | $10^5$ | B  |  $ 35 $   |  
| $ 4 $    | $10^5$ |  |  $ 50 $   |  

- ç‰¹æ®Šæ€§è´¨ Aï¼š$1\le a_i\le k$ã€‚
- ç‰¹æ®Šæ€§è´¨ Bï¼š$k=1$ã€‚



## æ ·ä¾‹ #1

### è¾“å…¥

```
3 1
1 2 1```

### è¾“å‡º

```
6```

## æ ·ä¾‹ #2

### è¾“å…¥

```
6 3
6 5 6 4 5 5```

### è¾“å‡º

```
1```

## æ ·ä¾‹ #3

### è¾“å…¥

```
6 2
5 4 5 2 6 5```

### è¾“å‡º

```
5```

# AIåˆ†æç»“æœ

---
# ğŸ’¡ æ´›è¯­äº‘ç¬ºçš„C++ç®—æ³•è§£æï¼šCOCI 2024/2025 #1 æ•™å¸ˆ / UÄiteljica æ·±å…¥å­¦ä¹ æŒ‡å— ğŸ’¡

> ä»Šå¤©æˆ‘ä»¬æ¥ä¸€èµ·åˆ†æ **â€œæ•™å¸ˆâ€** è¿™é“C++ç¼–ç¨‹é¢˜ã€‚è¿™ä¸ä»…æ˜¯ä¸€æ¬¡è§£é¢˜ï¼Œæ›´æ˜¯ä¸€åœºæ€ç»´çš„æ¢é™©ã€‚æˆ‘ä»¬å°†å­¦ä¹ å¦‚ä½•åƒä¾¦æ¢ä¸€æ ·ä»é¢˜ç›®ä¸­å¯»æ‰¾çº¿ç´¢ï¼Œå¹¶åœ¨ä¸åŒçš„è§£é¢˜é“è·¯ä¸­æƒè¡¡é€‰æ‹©ï¼Œæœ€ç»ˆæ‰¾åˆ°æœ€ä¼˜çš„ç­–ç•¥ã€‚

---

## 1. é¢˜ç›®è§£è¯»ä¸ç­–ç•¥åˆæ¢

### âœ¨ æœ¬é¢˜æ ¸å¿ƒæŒ‘æˆ˜
> **æ ¸å¿ƒæŒ‘æˆ˜**ï¼šåœ¨é•¿åº¦ä¸º $10^5$ çš„åºåˆ—ä¸­ï¼Œå¿«é€Ÿç»Ÿè®¡æ‰€æœ‰æ»¡è¶³â€œæ°å¥½å‡ºç° $1,2,\dots,k$ æ¬¡çš„æ•°å­—éƒ½å„å‡ºç°ä¸€æ¬¡â€çš„åŒºé—´ $(l,r)$ æ•°é‡ï¼Œå…¶ä¸­ $k\le 4$ã€‚

### âœ¨ æ ¸å¿ƒç®—æ³•æ ‡ç­¾
- **æ»‘åŠ¨çª—å£+å“ˆå¸Œ**ï¼ˆæš´åŠ›ï¼‰
- **çº¿æ®µæ ‘+æ‰«æçº¿+å®¹æ–¥**ï¼ˆæ­£è§£ï¼‰
- **çŠ¶å‹+çº¿æ®µæ ‘åˆ†æ²»**ï¼ˆé«˜é˜¶åšæ³•ï¼‰

---

### ğŸ” ç®—æ³•ä¾¦æ¢ï¼šå¦‚ä½•åœ¨é¢˜ç›®ä¸­å‘ç°çº¿ç´¢ï¼Ÿ

| çº¿ç´¢ç¼–å· | å…³é”®è§‚å¯Ÿ | ç®—æ³•æš—ç¤º |
|---|---|---|
| **çº¿ç´¢1** | åŒºé—´ç»Ÿè®¡é—®é¢˜ï¼Œ$n\le 10^5$ | æš´åŠ› $O(n^2)$ è¶…æ—¶ï¼Œéœ€ $O(n\log n)$ æˆ–æ›´ä½ |
| **çº¿ç´¢2** | $k\le 4$ æå° | å®¹æ–¥æˆ–çŠ¶å‹å¯è¡Œï¼Œæšä¸¾ $2^k$ ç§æƒ…å†µ |
| **çº¿ç´¢3** | â€œæ°å¥½ $i$ æ¬¡â€ | éœ€ç»´æŠ¤**å‡ºç°æ¬¡æ•°çš„ç²¾ç¡®åŒºé—´**ï¼Œè”æƒ³åˆ°**æ‰«æçº¿+çŸ©å½¢é¢ç§¯å¹¶** |

---

### ğŸ§  æ€ç»´é“¾æ„å»ºï¼šä»çº¿ç´¢åˆ°ç­–ç•¥
> 1. **æš´åŠ›æ€è·¯**ï¼šæšä¸¾åŒºé—´ï¼Œç»´æŠ¤æ¯ä¸ªæ•°å­—å‡ºç°æ¬¡æ•°ï¼Œæ£€æŸ¥ $1..k$ æ˜¯å¦å„å‡ºç°ä¸€æ¬¡ã€‚æ—¶é—´ $O(n^2)$ï¼Œåªèƒ½æ‹¿ 20 åˆ†ã€‚
> 2. **æ€§è´¨å‘ç°**ï¼šå½“ $k=1$ æ—¶ï¼Œé—®é¢˜é€€åŒ–ä¸ºâ€œç»Ÿè®¡å‡ºç°æ¬¡æ•°æ°å¥½ä¸º 1 çš„åŒºé—´â€ï¼Œå¯ç”¨**çº¿æ®µæ ‘ç»´æŠ¤åŒºé—´æœ€å°å€¼ä¸è®¡æ•°**ï¼Œæ—¶é—´ $O(n\log n)$ã€‚
> 3. **æ­£è§£æ€è·¯**ï¼šå°†æ¯ç§æ•°å­—å‡ºç° $i$ æ¬¡å¯¹åº”çš„åŒºé—´è½¬åŒ–ä¸º**çŸ©å½¢**ï¼Œé—®é¢˜è½¬åŒ–ä¸ºæ±‚ $k$ ç±»çŸ©å½¢çš„**äº¤é›†é¢ç§¯**ã€‚åˆ©ç”¨**å®¹æ–¥åŸç†**å°†äº¤é›†è½¬åŒ–ä¸ºå¹¶é›†çš„åŠ å‡ï¼Œæ—¶é—´ $O(2^k kn\log n)$ã€‚

---

## 2. ç²¾é€‰ä¼˜è´¨é¢˜è§£å‚è€ƒ

### é¢˜è§£ä¸€ï¼šqwer6ï¼ˆèµï¼š5ï¼‰
**ç‚¹è¯„**ï¼š  
qwer6 çš„é¢˜è§£ç»“æ„æ¸…æ™°ï¼Œä»éƒ¨åˆ†åˆ†é€æ­¥æ¨å¯¼åˆ°æ­£è§£ï¼Œé€»è¾‘ä¸¥è°¨ã€‚  
- **å­ä»»åŠ¡1** æä¾› $O(n^2)$ æš´åŠ›ï¼Œä»£ç ç®€æ´æ˜“æ‡‚ã€‚  
- **å­ä»»åŠ¡2** åˆ©ç”¨é•¿åº¦å›ºå®šæ€§è´¨ï¼ŒåŒæŒ‡é’ˆä¼˜åŒ–è‡³ $O(nk^2)$ã€‚  
- **å­ä»»åŠ¡3** é€šè¿‡çº¿æ®µæ ‘ç»´æŠ¤â€œæ°å¥½å‡ºç° $i$ æ¬¡â€çš„åŒºé—´ï¼Œä¸ºå®¹æ–¥å¥ å®šåŸºç¡€ã€‚  
- **æ­£è§£** å°†å®¹æ–¥ä¸çº¿æ®µæ ‘ç»“åˆï¼Œä»£ç å®ç°ä¼˜é›…ï¼Œæ˜¯å­¦ä¹ çº¿æ®µæ ‘+å®¹æ–¥çš„ç»å…¸èŒƒä¾‹ã€‚

### é¢˜è§£äºŒï¼šPurslaneï¼ˆèµï¼š4ï¼‰
**ç‚¹è¯„**ï¼š  
Purslane çš„è§£æ³•ç›´æ¥åˆ‡å…¥æ­£è§£ï¼Œç”¨**å®¹æ–¥+æ‰«æçº¿**å°†é—®é¢˜è½¬åŒ–ä¸ºçŸ©å½¢é¢ç§¯å¹¶ã€‚  
- ä»£ç ä¸­ `solve(st)` å‡½æ•°å·§å¦™å¤„ç†æ¯ç§å®¹æ–¥æƒ…å†µï¼Œåˆ©ç”¨çº¿æ®µæ ‘åŠ¨æ€ç»´æŠ¤çŸ©å½¢å¹¶çš„é¢ç§¯ã€‚  
- æ—¶é—´å¤æ‚åº¦ $O(2^k kn\log n)$ï¼Œç©ºé—´ä¼˜åŒ–è‡³ $O(n)$ï¼Œä½“ç°é«˜æ•ˆå®ç°èƒ½åŠ›ã€‚

### é¢˜è§£ä¸‰ï¼šhnczyï¼ˆèµï¼š2ï¼‰
**ç‚¹è¯„**ï¼š  
hnczy çš„é¢˜è§£é€‚åˆåˆå­¦è€…ï¼Œè¯¦ç»†è§£é‡Šäº† $k=1$ æ—¶çš„çº¿æ®µæ ‘å®ç°ï¼Œå¹¶é€šè¿‡å®¹æ–¥æ¨å¹¿åˆ°ä¸€èˆ¬æƒ…å†µã€‚  
- ä»£ç æ³¨é‡Šè¯¦å°½ï¼Œå˜é‡å‘½åç›´è§‚ï¼ˆå¦‚ `pre[i]` è¡¨ç¤ºå‰ä¸€ä¸ªç›¸åŒå€¼ä½ç½®ï¼‰ã€‚  
- ç‰¹åˆ«å¼ºè°ƒäº†â€œçŸ©å½¢äº¤è½¬å¹¶â€çš„å®¹æ–¥æ€æƒ³ï¼Œå¸®åŠ©ç†è§£æ­£è§£æ ¸å¿ƒã€‚

---

## 3. è§£é¢˜ç­–ç•¥æ·±åº¦å‰–æ

### ğŸ¯ æ ¸å¿ƒéš¾ç‚¹ä¸å…³é”®æ­¥éª¤ï¼ˆæ­£è§£å‰–æï¼‰

#### å…³é”®ç‚¹1ï¼šå°†â€œå‡ºç°æ¬¡æ•°â€è½¬åŒ–ä¸ºçŸ©å½¢åŒºé—´
- **åˆ†æ**ï¼šå¯¹äºæ•°å­— $x$ çš„ç¬¬ $i$ æ¬¡å‡ºç°ï¼Œå…¶å¯¹åº”çš„åˆæ³•åŒºé—´ $[l,r]$ æ»¡è¶³ï¼š  
  $l$ ä½äºç¬¬ $(i-1)$ æ¬¡å’Œç¬¬ $i$ æ¬¡å‡ºç°ä¹‹é—´ï¼Œ$r$ ä½äºç¬¬ $i$ æ¬¡å’Œç¬¬ $(i+1)$ æ¬¡å‡ºç°ä¹‹é—´ã€‚  
  è¿™æ ·å¯å°†æ¯ç§æ•°å­—çš„æ¯ç§å‡ºç°æ¬¡æ•°æ˜ å°„ä¸º**è‹¥å¹²çŸ©å½¢**ã€‚
- **å­¦ä¹ ç¬”è®°**ï¼šå°†æŠ½è±¡æ¡ä»¶å‡ ä½•åŒ–ï¼Œæ˜¯å¤„ç†åŒºé—´ç»Ÿè®¡é—®é¢˜çš„å¸¸ç”¨æŠ€å·§ã€‚

#### å…³é”®ç‚¹2ï¼šå®¹æ–¥åŸç†æ±‚äº¤é›†
- **åˆ†æ**ï¼šéœ€ç»Ÿè®¡åŒæ—¶æ»¡è¶³â€œæ°å¥½å‡ºç° $1..k$ æ¬¡â€çš„åŒºé—´ï¼Œå³æ±‚ $k$ ç±»çŸ©å½¢çš„äº¤é›†é¢ç§¯ã€‚  
  åˆ©ç”¨å®¹æ–¥å…¬å¼ï¼š  
  $$|S_1 \cap \dots \cap S_k| = \sum_{T \subseteq \{1..k\}} (-1)^{|T|+1} \left| \bigcup_{i \in T} S_i \right|$$
- **å­¦ä¹ ç¬”è®°**ï¼šå½“ç›´æ¥æ±‚äº¤é›†å›°éš¾æ—¶ï¼Œå®¹æ–¥å¯å°†é—®é¢˜è½¬åŒ–ä¸ºæ›´æ˜“å¤„ç†çš„å¹¶é›†è®¡ç®—ã€‚

#### å…³é”®ç‚¹3ï¼šçº¿æ®µæ ‘ç»´æŠ¤çŸ©å½¢é¢ç§¯å¹¶
- **åˆ†æ**ï¼šä½¿ç”¨**æ‰«æçº¿ç®—æ³•**ï¼ŒæŒ‰å³ç«¯ç‚¹æ’åºï¼Œçº¿æ®µæ ‘åŠ¨æ€ç»´æŠ¤å½“å‰è¦†ç›–çš„åŒºé—´é•¿åº¦ã€‚  
  å¯¹äºæ¯ç§å®¹æ–¥æƒ…å†µï¼ˆæšä¸¾ $2^k$ ç§å­é›†ï¼‰ï¼Œæ‰«æçº¿è®¡ç®—å¹¶é›†é¢ç§¯ã€‚
- **å­¦ä¹ ç¬”è®°**ï¼šçº¿æ®µæ ‘+æ‰«æçº¿æ˜¯å¤„ç†åŠ¨æ€åŒºé—´ç»Ÿè®¡çš„åˆ©å™¨ï¼Œéœ€ç†Ÿç»ƒæŒæ¡åŒºé—´ä¿®æ”¹ä¸æŸ¥è¯¢ã€‚

---

### âœ¨ è§£é¢˜æŠ€å·§æ€»ç»“
- **æŠ€å·§Aï¼šé—®é¢˜è½¬åŒ–**ï¼šå°†â€œå‡ºç°æ¬¡æ•°â€è½¬åŒ–ä¸ºå‡ ä½•åŒºé—´ï¼Œé™ä½æ€ç»´å¤æ‚åº¦ã€‚
- **æŠ€å·§Bï¼šå®¹æ–¥ä¼˜åŒ–**ï¼šåˆ©ç”¨ $k\le 4$ çš„å°èŒƒå›´ï¼Œé€šè¿‡ $2^k$ æšä¸¾å°†äº¤é›†è½¬å¹¶é›†ã€‚
- **æŠ€å·§Cï¼šæ•°æ®ç»“æ„é€‰æ‹©**ï¼šçº¿æ®µæ ‘æ”¯æŒåŒºé—´åŠ /å‡ä¸æŸ¥è¯¢æœ€å°å€¼è®¡æ•°ï¼Œé€‚é…æ‰«æçº¿éœ€æ±‚ã€‚

---

### âš”ï¸ ç­–ç•¥ç«æŠ€åœºï¼šä¸åŒè§£æ³•å¯¹æ¯”

| ç­–ç•¥ | æ ¸å¿ƒæ€æƒ³ | ä¼˜ç‚¹ | ç¼ºç‚¹ | é€‚ç”¨åœºæ™¯ |
|---|---|---|---|---|
| **æš´åŠ›æšä¸¾** | $O(n^2)$ æ£€æŸ¥æ¯ä¸ªåŒºé—´ | æ€è·¯ç›´è§‚ | æ— æ³•é€šè¿‡å¤§æ•°æ® | $n\le 10^3$ |
| **å›ºå®šé•¿åº¦çª—å£** | åˆ©ç”¨åŒºé—´é•¿åº¦ $=k(k+1)/2$ | å®ç°ç®€å• | ä»…é€‚ç”¨äºç‰¹æ®Šæ€§è´¨A/B | $k\le 4$ ä¸” $a_i\le k$ |
| **å®¹æ–¥+æ‰«æçº¿** | çŸ©å½¢äº¤é›†è½¬å¹¶é›† | æœ€ä¼˜å¤æ‚åº¦ $O(2^k kn\log n)$ | éœ€ç†è§£å®¹æ–¥ | æ­£è§£ï¼Œæ»¡åˆ†é€šç”¨ |
| **çº¿æ®µæ ‘åˆ†æ²»** | é¿å…çŸ©å½¢å‡æ“ä½œ | æ€è·¯æ–°é¢– | å®ç°å¤æ‚ï¼Œå¸¸æ•°å¤§ | é«˜é˜¶æ‹“å±• |

---

### âœ¨ ä¼˜åŒ–ä¹‹æ—…ï¼šä»æš´åŠ›åˆ°æ­£è§£
> 1. **èµ·ç‚¹**ï¼šæš´åŠ› $O(n^2)$ æšä¸¾åŒºé—´ï¼Œç»´æŠ¤è®¡æ•°æ•°ç»„ã€‚  
> 2. **ç“¶é¢ˆ**ï¼šé‡å¤ç»Ÿè®¡åŒºé—´ï¼Œæ— æ³•å¤„ç† $n=10^5$ã€‚  
> 3. **çªç ´**ï¼šå°†é—®é¢˜è½¬åŒ–ä¸ºå‡ ä½•é—®é¢˜ï¼Œåˆ©ç”¨æ‰«æçº¿+çº¿æ®µæ ‘å°†å¤æ‚åº¦é™è‡³ $O(n\log n)$ã€‚  
> 4. **å‡å**ï¼šé€šè¿‡å®¹æ–¥åŸç†ç»Ÿä¸€å¤„ç† $k$ ç§æƒ…å†µï¼Œå®ç°é«˜æ•ˆç»Ÿè®¡ã€‚

---

## 4. C++æ ¸å¿ƒä»£ç å®ç°èµæ

### æœ¬é¢˜é€šç”¨æ ¸å¿ƒC++å®ç°å‚è€ƒ
- **è¯´æ˜**ï¼šç»¼åˆ Purslane å’Œ hnczy çš„å®¹æ–¥æ€è·¯ï¼Œæä¾›æ¸…æ™°å®ç°ã€‚
- **å®Œæ•´æ ¸å¿ƒä»£ç **ï¼š
```cpp
#include <bits/stdc++.h>
using namespace std;
typedef long long ll;
const int MAXN = 1e5 + 5;

int n, k, a[MAXN], pre[MAXN], lst[MAXN];
vector<int> pos[MAXN];

// çº¿æ®µæ ‘ç»´æŠ¤åŒºé—´æœ€å°å€¼åŠè®¡æ•°
struct Node {
    int mn, cnt;
    Node operator+(const Node& rhs) const {
        Node res;
        res.mn = min(mn, rhs.mn);
        res.cnt = (mn == res.mn ? cnt : 0) + (rhs.mn == res.mn ? rhs.cnt : 0);
        return res;
    }
    Node operator+(int v) const { return {mn + v, cnt}; }
};

struct SegTree {
    Node tr[MAXN << 2];
    int tag[MAXN << 2];
    void build(int p, int l, int r) {
        tr[p] = {0, r - l + 1};
        tag[p] = 0;
        if (l == r) return;
        int mid = (l + r) >> 1;
        build(p << 1, l, mid);
        build(p << 1 | 1, mid + 1, r);
    }
    void push_down(int p) {
        if (!tag[p]) return;
        tr[p << 1] = tr[p << 1] + tag[p];
        tr[p << 1 | 1] = tr[p << 1 | 1] + tag[p];
        tag[p << 1] += tag[p];
        tag[p << 1 | 1] += tag[p];
        tag[p] = 0;
    }
    void update(int p, int l, int r, int L, int R, int v) {
        if (L <= l && r <= R) {
            tr[p] = tr[p] + v;
            tag[p] += v;
            return;
        }
        push_down(p);
        int mid = (l + r) >> 1;
        if (L <= mid) update(p << 1, l, mid, L, R, v);
        if (R > mid) update(p << 1 | 1, mid + 1, r, L, R, v);
        tr[p] = tr[p << 1] + tr[p << 1 | 1];
    }
    int query() { return tr[1].mn == 0 ? n - tr[1].cnt : 0; }
} seg;

int main() {
    ios::sync_with_stdio(false);
    cin.tie(nullptr);
    cin >> n >> k;
    for (int i = 1; i <= n; ++i) {
        cin >> a[i];
        pre[i] = lst[a[i]];
        lst[a[i]] = i;
    }

    ll ans = 0;
    for (int mask = 1; mask < (1 << k); ++mask) {
        seg.build(1, 1, n);
        int popcnt = __builtin_popcount(mask);
        int sign = (popcnt & 1) ? 1 : -1;
        ll res = 0;
        for (int i = 1; i <= n; ++i) {
            int now = i;
            for (int j = 0; j < k; ++j) {
                if (mask >> j & 1) {
                    seg.update(1, 1, n, pre[now] + 1, now, 1);
                    if (pre[now]) seg.update(1, 1, n, pre[pre[now]] + 1, pre[now], -1);
                }
                now = pre[now];
                if (!now) break;
            }
            res += seg.query();
        }
        ans += sign * res;
    }
    cout << ans << '\n';
    return 0;
}
```

- **ä»£ç è§£è¯»æ¦‚è¦**ï¼š  
  1. **é¢„å¤„ç†**ï¼š`pre[i]` è®°å½•æ•°å­— `a[i]` çš„ä¸Šä¸€æ¬¡å‡ºç°ä½ç½®ï¼Œä¸ºæ„å»ºçŸ©å½¢åšå‡†å¤‡ã€‚  
  2. **å®¹æ–¥æšä¸¾**ï¼šéå†æ‰€æœ‰éç©ºå­é›† `mask`ï¼ˆå…± $2^k-1$ ç§ï¼‰ï¼Œè®¡ç®—å¯¹åº”çŸ©å½¢å¹¶çš„é¢ç§¯ã€‚  
  3. **çº¿æ®µæ ‘ç»´æŠ¤**ï¼šåŠ¨æ€ç»´æŠ¤å½“å‰è¦†ç›–çš„åŒºé—´ï¼Œé€šè¿‡åŒºé—´åŠ /å‡æ“ä½œæ¨¡æ‹ŸçŸ©å½¢åŠ å…¥/ç§»é™¤ã€‚  
  4. **ç»“æœç»Ÿè®¡**ï¼šæ ¹æ®å®¹æ–¥ç¬¦å·ç´¯åŠ /å‡å»é¢ç§¯ï¼Œæœ€ç»ˆå¾—åˆ°äº¤é›†ç­”æ¡ˆã€‚

---

## 5. ç®—æ³•å¯è§†åŒ–ï¼šåƒç´ åŠ¨ç”»æ¼”ç¤º

### åŠ¨ç”»ä¸»é¢˜
**â€œåƒç´ æ¢é™©å®¶â€åœ¨äºŒç»´å¹³é¢ä¸Šæ”¶é›†å½©è‰²çŸ©å½¢**  
- **åœºæ™¯**ï¼š8ä½åƒç´ é£æ ¼çš„ç½‘æ ¼ï¼Œæ¨ªè½´ä¸ºå³ç«¯ç‚¹ $r$ï¼Œçºµè½´ä¸ºå·¦ç«¯ç‚¹ $l$ã€‚  
- **ç›®æ ‡**ï¼šé«˜äº®æ˜¾ç¤ºæ»¡è¶³æ¡ä»¶çš„çŸ©å½¢äº¤é›†åŒºåŸŸã€‚

### è®¾è®¡æ€è·¯
1. **åƒç´ åŒ–çŸ©å½¢ç”Ÿæˆ**ï¼šæ¯ä¸ªæ•°å­—çš„å‡ºç° $i$ æ¬¡åŒºé—´ç”¨ä¸åŒé¢œè‰²çš„åƒç´ å—è¡¨ç¤ºï¼ˆå¦‚çº¢è‰²=1æ¬¡ï¼Œç»¿è‰²=2æ¬¡ï¼‰ã€‚  
2. **æ‰«æçº¿åŠ¨ç”»**ï¼š  
   - ä¸€æ¡å‚ç›´æ‰«æçº¿ä»å·¦å‘å³ç§»åŠ¨ï¼Œæ¯ç§»åŠ¨ä¸€æ ¼è§¦å‘çŸ©å½¢åŠ å…¥/ç§»é™¤ã€‚  
   - çº¿æ®µæ ‘ç”¨åƒç´ æ¡å±•ç¤ºå½“å‰è¦†ç›–åŒºé—´ï¼Œæœ€å°å€¼=0çš„åŒºé—´é«˜äº®ä¸ºé‡‘è‰²ã€‚  
3. **å®¹æ–¥å¯è§†åŒ–**ï¼š  
   - å±å¹•é¡¶éƒ¨æ˜¾ç¤ºå½“å‰å®¹æ–¥å­é›†çš„äºŒè¿›åˆ¶è¡¨ç¤ºï¼ˆå¦‚ `101`ï¼‰ã€‚  
   - æ¯æ¬¡åˆ‡æ¢å­é›†æ—¶ï¼Œæ’­æ”¾â€œå®â€éŸ³æ•ˆï¼ŒçŸ©å½¢é¢œè‰²é—ªçƒå¯¹åº”ç¬¦å·ï¼ˆåŠ =ç»¿è‰²ï¼Œå‡=çº¢è‰²ï¼‰ã€‚  
4. **äº¤äº’æ§åˆ¶**ï¼š  
   - ç©å®¶å¯æš‚åœ/å•æ­¥ï¼ŒæŸ¥çœ‹å½“å‰çŸ©å½¢å¹¶çš„é¢ç§¯è®¡ç®—è¿‡ç¨‹ã€‚  
   - æœ€ç»ˆäº¤é›†åŒºåŸŸä»¥å½©è™¹åƒç´ å¡«å……ï¼Œä¼´éšèƒœåˆ©éŸ³æ•ˆã€‚

---

## 6. æ‹“å±•ç»ƒä¹ ä¸ç›¸ä¼¼é—®é¢˜æ€è€ƒ

### é€šç”¨æŠ€å·§è¿ç§»
- **çŸ©å½¢é¢ç§¯å¹¶**ï¼šé€‚ç”¨äºæ‰€æœ‰å°†åŒºé—´æ¡ä»¶è½¬åŒ–ä¸ºå‡ ä½•åŒºåŸŸçš„é—®é¢˜ï¼Œå¦‚ï¼š  
  1. **åŒºé—´å­æ®µå’Œç­‰äºK** â†’ è½¬åŒ–ä¸ºæ–œçº¿æ‰«æé—®é¢˜ã€‚  
  2. **æœ€é•¿æ— é‡å¤å­—ç¬¦å­ä¸²** â†’ æ»‘åŠ¨çª—å£ç»´æŠ¤åŒºé—´å”¯ä¸€æ€§ã€‚  
  3. **ä»»åŠ¡è°ƒåº¦å†²çªæ£€æµ‹** â†’ å°†æ—¶é—´åŒºé—´è½¬åŒ–ä¸ºçŸ©å½¢äº¤ã€‚

### æ´›è°·æ¨èç»ƒä¹ 
1. **P1972 [SDOI2009] HHçš„é¡¹é“¾**  
   - æ¨èç†ç”±ï¼šç»å…¸æ‰«æçº¿+å®¹æ–¥å…¥é—¨é¢˜ï¼Œå¸®åŠ©ç†è§£åŒºé—´ç»Ÿè®¡çš„å‡ ä½•è½¬åŒ–ã€‚  
2. **P2163 [SHOI2007] å›­ä¸çš„çƒ¦æ¼**  
   - æ¨èç†ç”±ï¼šçŸ©å½¢é¢ç§¯å¹¶çš„å˜å½¢ï¼Œéœ€å¤„ç†å¤šç»´æ¡ä»¶ã€‚  
3. **P2824 [HEOI2016/TJOI2016] æ’åº**  
   - æ¨èç†ç”±ï¼šçº¿æ®µæ ‘åˆ†æ²»ä¸æ‰«æçº¿ç»“åˆï¼Œæå‡æ•°æ®ç»“æ„ç»¼åˆèƒ½åŠ›ã€‚

---

## 7. å­¦ä¹ å¿ƒå¾—ä¸ç»éªŒåˆ†äº«

> **æ¥è‡ª Purslane çš„è°ƒè¯•å¿ƒå¾—**ï¼š  
> â€œåœ¨å®ç°å®¹æ–¥æ—¶ï¼Œæ›¾å› äºŒè¿›åˆ¶æšä¸¾é¡ºåºé”™è¯¯å¯¼è‡´ç¬¦å·åè½¬ã€‚é€šè¿‡æ‰“å°ä¸­é—´ç»“æœï¼ˆå¦‚ `mask` å’Œ `sign`ï¼‰å¿«é€Ÿå®šä½é—®é¢˜ï¼Œæ„è¯†åˆ°å®¹æ–¥çš„æ­£ç¡®æ€§ä¾èµ–äºä¸¥æ ¼çš„å¥‡å¶è®¡æ•°ã€‚â€  
> **æ´›è¯­äº‘ç¬ºç‚¹è¯„**ï¼šè°ƒè¯•å®¹æ–¥ç±»é—®é¢˜æ—¶ï¼ŒåŠ¡å¿…éªŒè¯ç¬¦å·é€»è¾‘ï¼Œå¯å€ŸåŠ© `__builtin_popcount` ç¡®ä¿å‡†ç¡®æ€§ã€‚

---

### ç»“è¯­
é€šè¿‡â€œæ•™å¸ˆâ€è¿™é“é¢˜ï¼Œæˆ‘ä»¬è§è¯äº†ä»æš´åŠ›æšä¸¾åˆ°å‡ ä½•è½¬åŒ–ã€å†åˆ°å®¹æ–¥ä¼˜åŒ–çš„å®Œæ•´æ€ç»´è·ƒè¿ã€‚è®°ä½ï¼Œä¼˜ç§€çš„ç®—æ³•å¾€å¾€æºäºå¯¹é—®é¢˜æœ¬è´¨çš„æ·±åˆ»æ´å¯Ÿã€‚ä¿æŒå¥½å¥‡ï¼ŒæŒç»­æ¢ç´¢ï¼Œä¸‹ä¸€æ¬¡æŒ‘æˆ˜è§ï¼

---
å¤„ç†ç”¨æ—¶ï¼š129.19ç§’
# é¢˜ç›®ä¿¡æ¯

# [SDOI2011] æŸ“è‰²

## é¢˜ç›®æè¿°

ç»™å®šä¸€æ£µ $n$ ä¸ªèŠ‚ç‚¹çš„æ— æ ¹æ ‘ï¼Œå…±æœ‰ $m$  ä¸ªæ“ä½œï¼Œæ“ä½œåˆ†ä¸ºä¸¤ç§ï¼š

1. å°†èŠ‚ç‚¹ $a$ åˆ°èŠ‚ç‚¹ $b$ çš„è·¯å¾„ä¸Šçš„æ‰€æœ‰ç‚¹ï¼ˆåŒ…æ‹¬ $a$ å’Œ $b$ï¼‰éƒ½æŸ“æˆé¢œè‰² $c$ã€‚
2. è¯¢é—®èŠ‚ç‚¹ $a$ åˆ°èŠ‚ç‚¹ $b$ çš„è·¯å¾„ä¸Šçš„é¢œè‰²æ®µæ•°é‡ã€‚

é¢œè‰²æ®µçš„å®šä¹‰æ˜¯æé•¿çš„è¿ç»­ç›¸åŒé¢œè‰²è¢«è®¤ä¸ºæ˜¯ä¸€æ®µã€‚ä¾‹å¦‚ `112221` ç”±ä¸‰æ®µç»„æˆï¼š`11`ã€`222`ã€`1`ã€‚

## è¯´æ˜/æç¤º

#### æ•°æ®è§„æ¨¡ä¸çº¦å®š

å¯¹äº $100\%$ çš„æ•°æ®ï¼Œ$1 \leq n, m \leq 10^5$ï¼Œ$1 \leq w_i, c \leq 10^9$ï¼Œ$1 \leq a, b, u, v \leq n$ï¼Œ$op$ ä¸€å®šä¸º `C` æˆ– `Q`ï¼Œä¿è¯ç»™å‡ºçš„å›¾æ˜¯ä¸€æ£µæ ‘ã€‚

é™¤åŸæ•°æ®å¤–ï¼Œè¿˜å­˜åœ¨ä¸€ç»„ä¸è®¡åˆ†çš„ hack æ•°æ®ã€‚


## æ ·ä¾‹ #1

### è¾“å…¥

```
6 5
2 2 1 2 1 1
1 2
1 3
2 4
2 5
2 6
Q 3 5
C 2 1 1
Q 3 5
C 5 1 2
Q 3 5
```

### è¾“å‡º

```
3
1
2
```

# AIåˆ†æç»“æœ

---
# ğŸ’¡ æ´›è¯­äº‘ç¬ºçš„C++ç®—æ³•è§£æï¼š[SDOI2011] æŸ“è‰² æ·±å…¥å­¦ä¹ æŒ‡å— ğŸ’¡

> æ¬¢è¿æ¥åˆ°â€œåƒç´ æ¢é™©å®¶â€çš„æ£®æ—ï¼ä»Šå¤©æˆ‘ä»¬è¦åœ¨æ ‘ä¸Šè¿›è¡Œä¸€åœºâ€œé¢œè‰²å¤§å†’é™©â€â€”â€”ç»™è·¯å¾„æ¶‚è‰²ï¼Œå†ç»Ÿè®¡è·¯å¾„ä¸Šçš„é¢œè‰²æ®µæ•°ã€‚  
> è¿™ä¸ä»…æ˜¯æ ‘é“¾å‰–åˆ†çš„ç»å…¸åº”ç”¨ï¼Œæ›´æ˜¯ä¸€æ¬¡â€œçº¿æ®µæ ‘é­”æ³•â€çš„å‡çº§ä¹‹æ—…ã€‚

---

## 1. é¢˜ç›®è§£è¯»ä¸ç­–ç•¥åˆæ¢

### âœ¨ æ ¸å¿ƒæŒ‘æˆ˜
åœ¨ä¸€æ£µ **n â‰¤ 1e5** çš„æ ‘ä¸­ï¼Œæ”¯æŒä¸¤ç§æ“ä½œï¼š
1. **è·¯å¾„æŸ“è‰²**ï¼šå°†è·¯å¾„ `a â†’ b` ä¸Šçš„æ‰€æœ‰èŠ‚ç‚¹æ¶‚æˆé¢œè‰² `c`ã€‚
2. **è·¯å¾„æŸ¥è¯¢**ï¼šè¯¢é—®è·¯å¾„ `a â†’ b` ä¸Šæœ‰å¤šå°‘ä¸ª **æé•¿è¿ç»­ç›¸åŒé¢œè‰²æ®µ**ï¼ˆå¦‚ `11221` æ˜¯ 3 æ®µï¼‰ã€‚

### ğŸ” ç®—æ³•ä¾¦æ¢ï¼šå¦‚ä½•åœ¨é¢˜ç›®ä¸­å‘ç°çº¿ç´¢ï¼Ÿ
| çº¿ç´¢ç¼–å· | å…³é”®è¯/çº¦æŸ | å¯¹åº”ç®—æ³•/æŠ€å·§ |
|----------|---------------|----------------|
| **çº¿ç´¢1** | â€œæ ‘ä¸Šçš„è·¯å¾„æ“ä½œâ€ â†’ **æ ‘é“¾å‰–åˆ†**ï¼ˆå°†æ ‘æ‹†æˆè‹¥å¹²æ¡é“¾ï¼Œè½¬åŒ–ä¸ºåºåˆ—é—®é¢˜ï¼‰ |
| **çº¿ç´¢2** | â€œåŒºé—´æŸ“è‰² + åŒºé—´æŸ¥è¯¢â€ â†’ **çº¿æ®µæ ‘**ï¼ˆæ”¯æŒåŒºé—´èµ‹å€¼ã€åŒºé—´åˆå¹¶ï¼‰ |
| **çº¿ç´¢3** | â€œæé•¿è¿ç»­æ®µâ€ â†’ **ç»´æŠ¤åŒºé—´å·¦å³ç«¯ç‚¹é¢œè‰²**ï¼Œåˆå¹¶æ—¶è‹¥ç›¸é‚»é¢œè‰²ç›¸åŒåˆ™æ®µæ•°å‡ 1 |

### ğŸ§  æ€ç»´é“¾æ„å»ºï¼šä»çº¿ç´¢åˆ°ç­–ç•¥
1. **æ ‘é“¾å‰–åˆ†**å°†æ ‘ä¸Šçš„è·¯å¾„æ‹†æˆ `O(log n)` æ¡ **DFS åºè¿ç»­çš„åŒºé—´**ã€‚
2. **çº¿æ®µæ ‘**ç»´æŠ¤æ¯æ¡åŒºé—´çš„ **å·¦ç«¯ç‚¹é¢œè‰² `lc`**ã€**å³ç«¯ç‚¹é¢œè‰² `rc`** å’Œ **é¢œè‰²æ®µæ•° `cnt`**ã€‚
3. åˆå¹¶ä¸¤ä¸ªå­åŒºé—´æ—¶ï¼š
   - `cnt = left.cnt + right.cnt`
   - è‹¥ `left.rc == right.lc`ï¼Œåˆ™ `cnt--`ï¼ˆç›¸é‚»åŒè‰²åˆå¹¶ä¸ºä¸€æ®µï¼‰ã€‚
4. **è·¯å¾„æŸ¥è¯¢**æ—¶ï¼Œéœ€é¢å¤–å¤„ç† **é“¾ä¸é“¾äº¤ç•Œå¤„**çš„é¢œè‰²æ˜¯å¦ç›¸åŒï¼ˆè§ç¬¬3èŠ‚ï¼‰ã€‚

---

## 2. ç²¾é€‰ä¼˜è´¨é¢˜è§£å‚è€ƒ

### ğŸŒŸ é¢˜è§£ä¸€ï¼šqscqesze_lcaï¼ˆæ ‘å‰– + çº¿æ®µæ ‘ï¼Œæ¸…æ™°æ˜“æ‡‚ï¼‰
- **äº®ç‚¹**ï¼š
  - ç”¨å…¨å±€å˜é‡ `Lc/Rc` è®°å½•å½“å‰æŸ¥è¯¢åŒºé—´çš„å·¦å³ç«¯ç‚¹é¢œè‰²ï¼Œå·§å¦™å¤„ç†é“¾é—´äº¤ç•Œã€‚
  - ä»£ç è§„èŒƒï¼Œæ³¨é‡Šè¯¦ç»†ï¼Œé€‚åˆåˆå­¦è€…æ¨¡ä»¿ã€‚
- **å­¦ä¹ ç¬”è®°**ï¼š
  > æŸ¥è¯¢è·¯å¾„æ—¶ï¼Œæ¯æ¬¡è·³é“¾åæ¯”è¾ƒ **å½“å‰é“¾é¡¶é¢œè‰²** ä¸ **çˆ¶é“¾åº•é¢œè‰²**ï¼Œè‹¥ç›¸åŒåˆ™ç­”æ¡ˆå‡ 1ã€‚

### ğŸŒŸ é¢˜è§£äºŒï¼šyyb_testï¼ˆLCT è§£æ³•ï¼Œæ€ç»´è¿›é˜¶ï¼‰
- **äº®ç‚¹**ï¼š
  - å°†é¢œè‰²æ®µé—®é¢˜è½¬åŒ–ä¸º **è¾¹æƒé—®é¢˜**ï¼šåŒè‰²è¾¹æƒä¸º 0ï¼Œå¼‚è‰²è¾¹æƒä¸º 1ï¼Œç­”æ¡ˆå³ä¸ºè¾¹æƒå’Œ +1ã€‚
  - ç”¨ **Splay** ç»´æŠ¤åŒºé—´å·¦å³ç«¯ç‚¹é¢œè‰²ï¼Œæ”¯æŒç¿»è½¬æ—¶äº¤æ¢ `lc/rc`ã€‚
- **å­¦ä¹ ç¬”è®°**ï¼š
  > LCT çš„ `split(x,y)` æ“ä½œå¤©ç„¶æ”¯æŒæå–è·¯å¾„ï¼Œé€‚åˆå¤æ‚æ ‘ç»“æ„ã€‚

### ğŸŒŸ é¢˜è§£ä¸‰ï¼šå¤©ä¸Šä¸€é¢—è›‹ï¼ˆæ ‘å‰– + çº¿æ®µæ ‘ï¼Œå›¾æ–‡å¹¶èŒ‚ï¼‰
- **äº®ç‚¹**ï¼š
  - ç”¨ **â€œäººâ€å­—å½¢è·¯å¾„åˆ†è§£** å›¾ç¤ºç›´è§‚è§£é‡Šé“¾é—´äº¤ç•Œå¤„ç†ã€‚
  - æä¾› `Qc` å‡½æ•°å•ç‹¬æŸ¥è¯¢æŸç‚¹é¢œè‰²ï¼Œé¿å…é‡å¤ä¸‹æ”¾æ ‡è®°ã€‚

---

## 3. è§£é¢˜ç­–ç•¥æ·±åº¦å‰–æ

### ğŸ¯ æ ¸å¿ƒéš¾ç‚¹ä¸å…³é”®æ­¥éª¤
#### 1. çº¿æ®µæ ‘åˆå¹¶é€»è¾‘
```cpp
struct Node {
    int lc, rc, cnt; // å·¦ç«¯ç‚¹é¢œè‰²ã€å³ç«¯ç‚¹é¢œè‰²ã€æ®µæ•°
};
Node merge(Node a, Node b) {
    if (a.cnt == 0) return b; // ç©ºåŒºé—´
    if (b.cnt == 0) return a;
    return {a.lc, b.rc, a.cnt + b.cnt - (a.rc == b.lc)};
}
```
ğŸ’¡ **å­¦ä¹ ç¬”è®°**ï¼šåˆå¹¶æ—¶éœ€åˆ¤æ–­ **å·¦å­åŒºé—´çš„å³ç«¯ç‚¹** ä¸ **å³å­åŒºé—´çš„å·¦ç«¯ç‚¹** æ˜¯å¦åŒè‰²ã€‚

#### 2. é“¾é—´äº¤ç•Œå¤„ç†
- **æŸ¥è¯¢è·¯å¾„æ—¶**ï¼Œç»´æŠ¤ä¸¤ä¸ªå˜é‡ `last1/last2` è®°å½•å·¦å³è·¯å¾„çš„ **â€œæ‚¬ç©ºç«¯ç‚¹é¢œè‰²â€**ã€‚
- æ¯æ¬¡è·³é“¾åï¼Œè‹¥ `å½“å‰é“¾åº•é¢œè‰² == last1`ï¼Œåˆ™ç­”æ¡ˆå‡ 1ã€‚

#### 3. æ‡’æ ‡è®°ä¸‹æ”¾
- æŸ“è‰²æ“ä½œéœ€ä¸‹æ”¾ `lazy` æ ‡è®°ï¼ŒåŒæ—¶æ›´æ–° `lc/rc` ä¸ºç»Ÿä¸€é¢œè‰²ï¼Œ`cnt=1`ã€‚

### âš”ï¸ ç­–ç•¥ç«æŠ€åœºï¼šä¸åŒè§£æ³•å¯¹æ¯”
| ç­–ç•¥ | æ ¸å¿ƒæ€æƒ³ | ä¼˜ç‚¹ | ç¼ºç‚¹ | é€‚ç”¨åœºæ™¯ |
|------|----------|------|------|----------|
| **æ ‘é“¾å‰–åˆ† + çº¿æ®µæ ‘** | å°†æ ‘æ‹†é“¾ååºåˆ—åŒ–ï¼Œç”¨çº¿æ®µæ ‘ç»´æŠ¤åŒºé—´ | ä»£ç ç›´è§‚ï¼Œæ˜“äºè°ƒè¯• | éœ€å¤„ç†é“¾é—´äº¤ç•Œ | **100% æ•°æ®** |
| **LCT** | åŠ¨æ€æ ‘ç»“æ„ï¼Œè¾¹æƒè½¬åŒ– | ç†è®ºæ›´ä¼˜é›… | å®ç°å¤æ‚ï¼Œå¸¸æ•°å¤§ | **éœ€è¦åŠ¨æ€é“¾æ¥/æ–­è¾¹** |
| **ç‚æœµè‰æ ‘** | æš´åŠ›ç»´æŠ¤é¢œè‰²æ®µ | ä»£ç æçŸ­ | ä¾èµ–æ•°æ®éšæœºæ€§ | **éª—åˆ† or éšæœºæ•°æ®** |

---

## 4. C++æ ¸å¿ƒä»£ç å®ç°èµæ

### ğŸŒŸ é€šç”¨æ ¸å¿ƒå®ç°ï¼ˆæ ‘å‰– + çº¿æ®µæ ‘ï¼‰
```cpp
#include <bits/stdc++.h>
using namespace std;
const int N = 1e5 + 10;

// === æ ‘é“¾å‰–åˆ† ===
int fa[N], dep[N], siz[N], son[N], top[N], dfn[N], rnk[N], tot;
vector<int> g[N];

void dfs1(int u, int f) {
    fa[u] = f, dep[u] = dep[f] + 1, siz[u] = 1;
    for (int v : g[u]) if (v != f) {
        dfs1(v, u);
        siz[u] += siz[v];
        if (siz[v] > siz[son[u]]) son[u] = v;
    }
}
void dfs2(int u, int t) {
    top[u] = t, dfn[u] = ++tot, rnk[tot] = u;
    if (son[u]) dfs2(son[u], t);
    for (int v : g[u]) if (v != fa[u] && v != son[u]) dfs2(v, v);
}

// === çº¿æ®µæ ‘ ===
int lc[N << 2], rc[N << 2], cnt[N << 2], tag[N << 2];
void push_up(int p) {
    lc[p] = lc[p << 1], rc[p] = rc[p << 1 | 1];
    cnt[p] = cnt[p << 1] + cnt[p << 1 | 1] - (rc[p << 1] == lc[p << 1 | 1]);
}
void push_down(int p) {
    if (tag[p]) {
        lc[p << 1] = rc[p << 1] = lc[p << 1 | 1] = rc[p << 1 | 1] = tag[p];
        cnt[p << 1] = cnt[p << 1 | 1] = 1;
        tag[p << 1] = tag[p << 1 | 1] = tag[p];
        tag[p] = 0;
    }
}
void build(int p, int l, int r, int col[]) {
    if (l == r) {
        lc[p] = rc[p] = col[rnk[l]];
        cnt[p] = 1;
        return;
    }
    int mid = (l + r) >> 1;
    build(p << 1, l, mid, col);
    build(p << 1 | 1, mid + 1, r, col);
    push_up(p);
}
void update(int p, int l, int r, int L, int R, int c) {
    if (L <= l && r <= R) {
        lc[p] = rc[p] = c, cnt[p] = 1, tag[p] = c;
        return;
    }
    push_down(p);
    int mid = (l + r) >> 1;
    if (L <= mid) update(p << 1, l, mid, L, R, c);
    if (R > mid) update(p << 1 | 1, mid + 1, r, L, R, c);
    push_up(p);
}
int query(int p, int l, int r, int L, int R) {
    if (L <= l && r <= R) return cnt[p];
    push_down(p);
    int mid = (l + r) >> 1, res = 0;
    if (L <= mid) res += query(p << 1, l, mid, L, R);
    if (R > mid) res += query(p << 1 | 1, mid + 1, r, L, R);
    if (L <= mid && R > mid && rc[p << 1] == lc[p << 1 | 1]) res--;
    return res;
}
int get_col(int p, int l, int r, int pos) {
    if (l == r) return lc[p];
    push_down(p);
    int mid = (l + r) >> 1;
    return pos <= mid ? get_col(p << 1, l, mid, pos) : get_col(p << 1 | 1, mid + 1, r, pos);
}

// === æ ‘é“¾æ“ä½œ ===
void path_update(int x, int y, int c) {
    while (top[x] != top[y]) {
        if (dep[top[x]] < dep[top[y]]) swap(x, y);
        update(1, 1, n, dfn[top[x]], dfn[x], c);
        x = fa[top[x]];
    }
    if (dfn[x] > dfn[y]) swap(x, y);
    update(1, 1, n, dfn[x], dfn[y], c);
}
int path_query(int x, int y) {
    int res = 0, last1 = -1, last2 = -1;
    while (top[x] != top[y]) {
        if (dep[top[x]] < dep[top[y]]) swap(x, y), swap(last1, last2);
        res += query(1, 1, n, dfn[top[x]], dfn[x]);
        int cur = get_col(1, 1, n, dfn[top[x]]);
        if (cur == last1) res--;
        last1 = get_col(1, 1, n, dfn[fa[top[x]]]);
        x = fa[top[x]];
    }
    if (dfn[x] > dfn[y]) swap(x, y), swap(last1, last2);
    res += query(1, 1, n, dfn[x], dfn[y]);
    int cur_l = get_col(1, 1, n, dfn[x]);
    int cur_r = get_col(1, 1, n, dfn[y]);
    if (cur_l == last1) res--;
    if (cur_r == last2) res--;
    return res;
}

int main() {
    int n, m;
    scanf("%d%d", &n, &m);
    vector<int> col(n + 1);
    for (int i = 1; i <= n; i++) scanf("%d", &col[i]);
    for (int i = 1, u, v; i < n; i++) {
        scanf("%d%d", &u, &v);
        g[u].push_back(v), g[v].push_back(u);
    }
    dfs1(1, 0), dfs2(1, 1);
    build(1, 1, n, col.data());
    while (m--) {
        char op[2];
        int x, y, c;
        scanf("%s%d%d", op, &x, &y);
        if (op[0] == 'C') {
            scanf("%d", &c);
            path_update(x, y, c);
        } else {
            printf("%d\n", path_query(x, y));
        }
    }
    return 0;
}
```

---

## 5. ç®—æ³•å¯è§†åŒ–ï¼šåƒç´ åŠ¨ç”»æ¼”ç¤º

### ğŸ® åŠ¨ç”»ä¸»é¢˜ï¼šã€Šåƒç´ æ¢é™©å®¶ï¼šé¢œè‰²æ£®æ—å¤§ä½œæˆ˜ã€‹
- **é£æ ¼**ï¼š8 ä½åƒç´ é£ï¼ˆFC çº¢ç™½æœºé…è‰²ï¼‰ã€‚
- **åœºæ™¯**ï¼šä¸€æ£µç”±åƒç´ æ–¹å—ç»„æˆçš„æ ‘ï¼Œæ¯ä¸ªèŠ‚ç‚¹æ˜¯ä¸€ä¸ªå‘å…‰æ–¹å—ï¼Œé¢œè‰²ä»£è¡¨å½“å‰é¢œè‰²ã€‚

### ğŸ•¹ï¸ åŠ¨ç”»æµç¨‹ï¼ˆå…³é”®å¸§è®¾è®¡ï¼‰
1. **åˆå§‹åŒ–**ï¼šæ ‘ä»¥ DFS åºå±•å¼€æˆä¸€æ¡åƒç´ åŒ–çš„â€œé“¾æ¡â€ï¼Œæ¯ä¸ªèŠ‚ç‚¹å‘å…‰æ˜¾ç¤ºåˆå§‹é¢œè‰²ã€‚
2. **æŸ“è‰²æ“ä½œ**ï¼š
   - ç”¨æˆ·ç‚¹å‡»è·¯å¾„ `a â†’ b`ï¼ŒåŠ¨ç”»é«˜äº®è·¯å¾„ï¼ˆåƒç´ ç®­å¤´é—ªçƒï¼‰ã€‚
   - çº¿æ®µæ ‘åŒºé—´é€å±‚ä¸‹æ”¾ `lazy` æ ‡è®°ï¼Œåƒç´ æ–¹å—é¢œè‰²ç»Ÿä¸€å˜ä¸ºç›®æ ‡è‰²ã€‚
3. **æŸ¥è¯¢æ“ä½œ**ï¼š
   - è·¯å¾„é«˜äº®åï¼Œåƒç´ å°äººï¼ˆæ¢é™©å®¶ï¼‰ä» `a` å’Œ `b` åˆ†åˆ«å‘ä¸Šè·³é“¾ã€‚
   - æ¯è·³ä¸€æ¬¡é“¾ï¼Œå±å¹•é¡¶éƒ¨æ˜¾ç¤ºï¼š
     ```
     [å½“å‰é“¾æ®µé¢œè‰²æ®µæ•°] + [äº¤ç•Œé¢œè‰²æ¯”è¾ƒæç¤º]
     ```
   - è‹¥äº¤ç•Œé¢œè‰²ç›¸åŒï¼Œæ’­æ”¾â€œå®â€éŸ³æ•ˆå¹¶å‡ 1ã€‚
4. **èƒœåˆ©ç”»é¢**ï¼šæœ€ç»ˆç­”æ¡ˆä»¥åƒç´ æ•°å­—å¼¹å‡ºï¼Œä¼´éš 8 ä½èƒœåˆ©éŸ³æ•ˆã€‚

### ğŸ›ï¸ äº¤äº’è®¾è®¡
- **æ§åˆ¶é¢æ¿**ï¼šå·¦ä¾§æ»‘å—è°ƒæ•´æ’­æ”¾é€Ÿåº¦ï¼ˆ0.5x~2xï¼‰ã€‚
- **å•æ­¥æ¨¡å¼**ï¼šæŒ‰ç©ºæ ¼é”®é€å¸§æŸ¥çœ‹ `push_down` å’Œ `merge` è¿‡ç¨‹ã€‚
- **é‡ç½®æŒ‰é’®**ï¼šæ¢å¤åˆå§‹é¢œè‰²çŠ¶æ€ã€‚

---

## 6. æ‹“å±•ç»ƒä¹ ä¸ç›¸ä¼¼é—®é¢˜æ€è€ƒ

### ğŸ“š é€šç”¨æŠ€å·§è¿ç§»
- **åŒºé—´åˆå¹¶æ€æƒ³**ï¼šé€‚ç”¨äºâ€œç»Ÿè®¡è¿ç»­ç›¸åŒå…ƒç´ æ®µæ•°â€ç±»é—®é¢˜ï¼Œå¦‚ï¼š
  1. **åºåˆ—é—®é¢˜**ï¼šç»™å®šæ•°ç»„ï¼Œæ”¯æŒåŒºé—´èµ‹å€¼å’ŒæŸ¥è¯¢è¿ç»­æ®µæ•°ã€‚
  2. **äºŒç»´é—®é¢˜**ï¼šæ£‹ç›˜æŸ“è‰²åç»Ÿè®¡è¿é€šå—ï¼ˆéœ€æ‰©å±•ä¸ºäºŒç»´çº¿æ®µæ ‘ï¼‰ã€‚
  3. **åŠ¨æ€æ ‘é—®é¢˜**ï¼šåŠ¨æ€é“¾æ¥/æ–­è¾¹åç»´æŠ¤è·¯å¾„é¢œè‰²æ®µï¼ˆLCT åº”ç”¨ï¼‰ã€‚

### ğŸ¯ æ´›è°·æ¨èç»ƒä¹ 
1. **P3384** ã€æ¨¡æ¿ã€‘æ ‘é“¾å‰–åˆ†  
   *ğŸ—£ï¸ æ¨èç†ç”±*ï¼šæŒæ¡æ ‘å‰–çš„â€œæ‹†é“¾â€æŠ€å·§ï¼Œä¸ºå¤æ‚æ ‘ä¸Šé—®é¢˜æ‰“åŸºç¡€ã€‚
2. **P2146** [NOI2015] è½¯ä»¶åŒ…ç®¡ç†å™¨  
   *ğŸ—£ï¸ æ¨èç†ç”±*ï¼šæ ‘å‰– + çº¿æ®µæ ‘ç»´æŠ¤å­æ ‘ä¿¡æ¯ï¼Œæ‹“å±•åˆ°â€œå­æ ‘ä¿®æ”¹â€ã€‚
3. **P2486** [SDOI2011] æŸ“è‰²ï¼ˆæœ¬é¢˜ï¼‰  
   *ğŸ—£ï¸ æ¨èç†ç”±*ï¼šå·©å›ºâ€œåŒºé—´åˆå¹¶â€æ€æƒ³ï¼Œæ³¨æ„é“¾é—´äº¤ç•Œå¤„ç†ã€‚
4. **SP6779** GSS7 - Can you answer these queries VII  
   *ğŸ—£ï¸ æ¨èç†ç”±*ï¼šæ ‘ä¸Šæœ€å¤§å­æ®µå’Œï¼Œéœ€ç»´æŠ¤æ›´å¤šåŒºé—´ä¿¡æ¯ï¼ˆæœ€å¤§å‰ç¼€/åç¼€ï¼‰ã€‚

---

## 7. å­¦ä¹ å¿ƒå¾—ä¸ç»éªŒåˆ†äº«

> æ¥è‡ªä½œè€… **å¤©ä¸Šä¸€é¢—è›‹** çš„è°ƒè¯•å¿ƒå¾—ï¼š
> > â€œæˆ‘åœ¨å¤„ç†é“¾é—´äº¤ç•Œæ—¶ï¼Œæœ€åˆå¿½ç•¥äº† `fa[top[u]]` çš„é¢œè‰²æ¯”è¾ƒï¼Œå¯¼è‡´æ ·ä¾‹ä¸€ç›´ WAã€‚  
> > åæ¥é€šè¿‡ **æ‰“å°æ¯æ¡é“¾çš„å·¦å³ç«¯ç‚¹é¢œè‰²**ï¼Œæ‰å‘ç°é—®é¢˜æ‰€åœ¨ã€‚  
> > **è°ƒè¯•æŠ€å·§**ï¼šåœ¨ `path_query` ä¸­è¾“å‡º `last1/last2` å’Œå½“å‰é“¾é¢œè‰²ï¼Œèƒ½å¿«é€Ÿå®šä½é”™è¯¯ã€‚â€

ğŸ’¡ **æ´›è¯­äº‘ç¬ºç‚¹è¯„**ï¼š  
è°ƒè¯•æ ‘ä¸Šé—®é¢˜æ—¶ï¼Œ**å¯è§†åŒ–é“¾çš„åˆ†è§£è¿‡ç¨‹**ï¼ˆå¦‚ç”»å›¾æˆ–æ‰“å° DFS åºï¼‰æ˜¯å…³é”®ã€‚äº¤ç•Œå¤„çš„é¢œè‰²æ¯”è¾ƒæ˜¯é«˜é¢‘é”™è¯¯ç‚¹ï¼

---

> ğŸŒˆ ä»Šå¤©çš„â€œé¢œè‰²æ£®æ—æ¢é™©â€å°±åˆ°è¿™é‡Œï¼  
> è®°ä½ï¼šæ ‘é“¾å‰–åˆ†æ˜¯â€œæ‹†é“¾ç¥å™¨â€ï¼Œçº¿æ®µæ ‘æ˜¯â€œåˆå¹¶å¤§å¸ˆâ€ï¼Œäº¤ç•Œå¤„ç†æ˜¯â€œç»†èŠ‚é­”é¬¼â€ã€‚  
> ä¸‹æ¬¡æˆ‘ä»¬å†ä¸€èµ·æŒ‘æˆ˜æ›´ç¥å¥‡çš„æ ‘ä¸Šé—®é¢˜ï¼

---
å¤„ç†ç”¨æ—¶ï¼š158.24ç§’
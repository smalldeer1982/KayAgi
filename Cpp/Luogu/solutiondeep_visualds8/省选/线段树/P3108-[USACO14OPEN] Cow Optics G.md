# é¢˜ç›®ä¿¡æ¯

# [USACO14OPEN] Cow Optics G

## é¢˜ç›®èƒŒæ™¯

å¾æ±‚ç¿»è¯‘ã€‚å¦‚æœä½ èƒ½æä¾›ç¿»è¯‘æˆ–è€…é¢˜æ„ç®€è¿°ï¼Œè¯·ç›´æ¥å‘è®¨è®ºï¼Œæ„Ÿè°¢ä½ çš„è´¡çŒ®ã€‚


## é¢˜ç›®æè¿°

Farmer John's cows would like to host a dance party in their barn, complete with a laser light show.  Unfortunately, the only working laser they have found is located far away from the barn and too heavy to move, so they plan to re-direct the laser light to the barn using a series of mirrors.

The layout of the farm has the laser at position (0,0) pointing north (in the positive y direction), and the barn at (Bx, By); we can think of both the laser and the barn as points in the 2D plane.  There are already N cows (1 <= N <= 100,000) scattered throughout the farm holding mirrors that are aligned at angles of 45 degrees to the axes.  For example, a mirror aligned like \ will take a beam of light entering from below and reflect it to the left.  We can also think of the mirrors as being located at points in the 2D plane.

Just before pressing the big red button to activate the laser, Bessie noticed a major flaw in the plan: the laser cannot hit the barn with the mirrors in their current configuration!  As a result, she plans to run out onto the field, and hold up one more mirror (placed once again at a 45 degree angle) in order to redirect the laser onto the barn. Please count the number of locations in the field where Bessie can stand to accomplish this goal.

All coordinates are integers between -1,000,000,000 and 1,000,000,000. It is guaranteed that any mirrors to be placed will be in this range as well. The cows running the laser insist that the beam should never come back to (0,0) after leaving this location (and with the mirrors in their initial configuration, it is guaranteed that this will not happen).  No two cows occupy the same point in space, and Bessie cannot locate herself at the same position as an existing cow.

å†œåœºä¸»çº¦ç¿°çš„ç‰›æƒ³åœ¨è°·ä»“é‡Œé¢ä¸¾åŠèˆä¼šï¼Œç”¨æ¿€å…‰ç¯æ¥è¡¨æ¼”ã€‚ä½†ä¸å¹¸çš„æ˜¯å”¯ä¸€çš„æ¿€å…‰ç¯ç¦»è°·ä»“å¤ªè¿œï¼Œå¹¶ä¸”æ¬ä¸åŠ¨ï¼Œæ‰€ä»¥ç‰›ä»¬æƒ³ç”¨é•œå­æ¥åå°„æ¿€å…‰ï¼Œä½¿å¾—æ¿€å…‰ç…§åˆ°è°·ä»“ã€‚


æ¿€å…‰çš„ä½ç½®åœ¨ï¼ˆ0,0ï¼‰ï¼ŒæŒ‡å‘ä¸ºåŒ—æ–¹ï¼ˆå³yè½´æ­£æ–¹å‘ï¼‰ï¼Œè°·ä»“åœ¨ä½ç½®ï¼ˆBxï¼ŒByï¼‰ã€‚å·²ç»æœ‰Nå¤´å¥¶ç‰›æ‹¿ç€é•œå­åˆ†æ•£åœ¨å†œåœºçš„å„ä¸ªä½ç½®ï¼ˆ1 <= N <= 100,000ï¼‰ï¼Œé•œå­ä¸åŸç‚¹ä¹‹é—´çš„å¤¹è§’ä¸º45åº¦ã€‚ä¾‹å¦‚ä¸€ä¸ªè¿™æ ·ï¼ˆâ€œ\â€œï¼‰çš„é•œå­å¯ä»¥æŠŠä»ä¸‹æ–¹å°„æ¥çš„å…‰çº¿åå°„æˆå‘å·¦çš„å…‰çº¿ã€‚


Bessieåœ¨å¯åŠ¨æ¿€å…‰çš„å‰ä¸€åˆ»æ„è¯†åˆ°è®¡åˆ’æœ‰ç¼ºé™·ï¼Œæ‰€ä»¥å¥¹è‡ªå·±åˆæ‹¿ç€ä¸€é¢é•œå­å‡ºå»äº†ï¼Œæ°å¥½ä½¿å¾—æ¿€å…‰ç…§åˆ°è°·ä»“ã€‚


è¯·è®¡ç®—Bessieå¯èƒ½ç«™åœ¨çš„ä½ç½®çš„æ€»æ•°ã€‚


åæ ‡èŒƒå›´ï¼š-1,000,000,000 åˆ° 1,000,000,000ï¼Œæ•°æ®ä¿è¯åˆå§‹æ—¶æ¿€å…‰å…‰æŸä¸ä¼šåå°„å›ï¼ˆ0,0ï¼‰ä½ç½®ã€‚åŒä¸€ç‚¹ä¸Šä¸å¯èƒ½æœ‰å¤šå¤´ç‰›ï¼ŒBessieä¸èƒ½ç«™åœ¨å…¶ä»–ç‰›çš„ä½ç½®ã€‚


## è¯´æ˜/æç¤º

A mirror at (0,1) or (0,2) placed in either direction would do the trick.

æ ·ä¾‹ä¸­Bessieå¯èƒ½ç«™åœ¨ï¼ˆ0,1ï¼‰æˆ–è€…ï¼ˆ0,2ï¼‰ã€‚

æ„Ÿè°¢@SystemLLH  æä¾›ç¿»è¯‘


## æ ·ä¾‹ #1

### è¾“å…¥

```
4 1 2 
-2 1 \ 
2 1 / 
2 2 \ 
-2 2 / 
```

### è¾“å‡º

```
2 
```

# AIåˆ†æç»“æœ

---

# ğŸ’¡ æ´›è¯­äº‘ç¬ºçš„C++ç®—æ³•è§£æï¼šCow Optics G æ·±å…¥å­¦ä¹ æŒ‡å— ğŸ’¡

> æ¬¢è¿æ¥åˆ°â€œæ¿€å…‰ä¸é•œå­çš„åƒç´ ä¸–ç•Œâ€ï¼ä»Šå¤©æˆ‘ä»¬è¦å¸® Bessie æ‰¾åˆ°èƒ½è®©æ¿€å…‰ä» (0,0) å°„åˆ°è°·ä»“ (Bx, By) çš„æ‰€æœ‰å¯èƒ½â€œæœ€åä¸€é¢é•œå­â€çš„ä½ç½®ã€‚å‡†å¤‡å¥½ä½ çš„åƒç´ æ”¾å¤§é•œï¼Œä¸€èµ·è¿½è¸ªå…‰çº¿çš„è½¨è¿¹å§ï¼

---

## 1. é¢˜ç›®è§£è¯»ä¸ç­–ç•¥åˆæ¢

### âœ¨ æœ¬é¢˜æ ¸å¿ƒæŒ‘æˆ˜
**â€œå…‰çº¿åªèƒ½èµ°æ°´å¹³æˆ–ç«–ç›´ï¼Œä½†å¦‚ä½•å¿«é€Ÿç»Ÿè®¡æ‰€æœ‰åˆæ³•äº¤ç‚¹ï¼Ÿâ€**  
æ¿€å…‰ä» (0,0) å‚ç›´å‘ä¸Šå°„å‡ºï¼Œç»è¿‡è‹¥å¹² 45Â° é•œå­çš„åå°„åï¼Œå¿…é¡»æ°´å¹³æˆ–å‚ç›´åœ°åˆ°è¾¾è°·ä»“ã€‚Bessie å¯ä»¥åœ¨ä»»æ„ç©ºä½å†æ’ä¸€é¢ 45Â° é•œå­ï¼Œä½¿å¾—å…‰çº¿æœ€ç»ˆå°„å‘è°·ä»“ã€‚æˆ‘ä»¬éœ€è¦ç»Ÿè®¡æ‰€æœ‰å¯è¡Œä½ç½®ã€‚

### âœ¨ æ ¸å¿ƒç®—æ³•æ ‡ç­¾
- **æ‰«æçº¿ (Sweep-Line)**
- **ç¦»æ•£åŒ– + åŒºé—´ç»Ÿè®¡**
- **å‡ ä½•åå°„è§„å¾‹**

---

### ğŸ” ç®—æ³•ä¾¦æ¢ï¼šå¦‚ä½•åœ¨é¢˜ç›®ä¸­å‘ç°çº¿ç´¢ï¼Ÿ

1. **çº¿ç´¢1ï¼ˆåå°„è§„å¾‹ï¼‰**ï¼š  
   45Â° é•œå­åªèƒ½æŠŠæ°´å¹³å…‰ â†” å‚ç›´å…‰äº’è½¬ã€‚å› æ­¤æ•´æ¡å…‰è·¯ä¸€å®šæ˜¯  
   (0,0) â†’ â€¦ â†’ (x, y) â†’ (x, By) æˆ– (Bx, y) çš„**ä¸¤æ®µå¼æŠ˜çº¿**ã€‚  
   â‡’ æœ€åä¸€é¢é•œå­å¿…é¡»ä½äºä¸è°·ä»“**åŒè¡Œæˆ–åŒåˆ—**çš„ç›´çº¿ä¸Šã€‚

2. **çº¿ç´¢2ï¼ˆé€†å‘æ€ç»´ï¼‰**ï¼š  
   ä¸å…¶ä» (0,0) æ­£å‘æ¨¡æ‹Ÿåå°„ï¼Œä¸å¦‚**ä»è°·ä»“å‘å››ä¸ªæ–¹å‘ï¼ˆä¸Šã€ä¸‹ã€å·¦ã€å³ï¼‰åå‘å‘å°„å…‰çº¿**ã€‚å…‰çº¿æ²¿ç›´çº¿ä¼ æ’­ï¼Œé‡åˆ°é•œå­å³ 90Â° è½¬å¼¯ï¼Œç›´åˆ°ç¢°åˆ°åæ ‡è½´æˆ–è¶Šç•Œã€‚  
   â‡’ æ‰€æœ‰èƒ½ä¸â€œä» (0,0) æ­£å‘å°„å‡ºçš„å…‰çº¿â€ç›¸äº¤çš„æ ¼å­å³ä¸ºç­”æ¡ˆã€‚

3. **çº¿ç´¢3ï¼ˆæ•°æ®è§„æ¨¡ï¼‰**ï¼š  
   N â‰¤ 1e5ï¼Œåæ ‡ç»å¯¹å€¼ â‰¤ 1e9ã€‚éœ€è¦ **O(N log N)** çº§åˆ«ç®—æ³•ã€‚  
   â‡’ æ‰«æçº¿ + ç¦»æ•£åŒ–æ˜¯æ ‡å‡†å¥—è·¯ã€‚

---

### ğŸ§  æ€ç»´é“¾æ„å»ºï¼šä»çº¿ç´¢åˆ°ç­–ç•¥
> ä¾¦æ¢æ‹¼å›¾æ—¶é—´ï¼  
> 1. æ ¹æ®çº¿ç´¢1ï¼Œæˆ‘ä»¬çŸ¥é“æœ€åä¸€é¢é•œå­å¿…é¡»åœ¨ **x = Bx** æˆ– **y = By** çš„ç›´çº¿ä¸Šã€‚  
> 2. æ ¹æ®çº¿ç´¢2ï¼ŒæŠŠé—®é¢˜è½¬åŒ–ä¸ºï¼š  
>    - ä» (0,0) å‚ç›´å‘ä¸Šå°„å‡ºå…‰çº¿ï¼Œè®°å½•èƒ½åˆ°è¾¾çš„æ‰€æœ‰ (x, y)ã€‚  
>    - ä»è°·ä»“ (Bx, By) å‘å››ä¸ªæ–¹å‘åå‘å°„å‡ºå…‰çº¿ï¼Œè®°å½•èƒ½åˆ°è¾¾çš„æ‰€æœ‰ (x, y)ã€‚  
>    - æ±‚ä¸¤ä¸ªé›†åˆåœ¨ **x = Bx** æˆ– **y = By** ä¸Šçš„äº¤é›†ï¼Œæ’é™¤å·²æœ‰å¥¶ç‰›çš„ä½ç½®ã€‚  
> 3. æ ¹æ®çº¿ç´¢3ï¼Œç”¨æ‰«æçº¿æŠŠäºŒç»´é—®é¢˜é™åˆ°ä¸€ç»´ï¼š  
>    - å…ˆæŒ‰ x æ‰«æï¼Œç»Ÿè®¡ y åæ ‡åŒºé—´ï¼›  
>    - å†æŒ‰ y æ‰«æï¼Œç»Ÿè®¡ x åæ ‡åŒºé—´ã€‚  
> 4. **ç»“è®º**ï¼šæ‰«æçº¿ + ç¦»æ•£åŒ– + åŒºé—´å‡ºç°æ¬¡æ•°ç»Ÿè®¡ï¼Œå³å¯ä¼˜é›…è§£å†³ï¼

---

## 2. ç²¾é€‰ä¼˜è´¨é¢˜è§£å‚è€ƒ

**é¢˜è§£æ¥æºï¼šyangwenbinï¼ˆèµï¼š3ï¼‰**
- **ç‚¹è¯„**ï¼š  
  è¿™ä»½é¢˜è§£**ä¸€è¯­ä¸­çš„**ï¼šâ€œå…‰çº¿åªèƒ½ç«–ç›´æˆ–æ°´å¹³â€ï¼Œç›´æ¥æŠŠå¤æ‚åå°„ç®€åŒ–ä¸ºä¸¤æ®µæŠ˜çº¿ã€‚ä½œè€…å·§å¦™åœ°ä½¿ç”¨**é€†å‘æ€ç»´**ï¼Œä»è°·ä»“å‘å››ä¸ªæ–¹å‘â€œå€’æ¨â€å…‰çº¿ï¼Œå°†åŸé—®é¢˜è½¬åŒ–ä¸ºç»å…¸çš„â€œä¸¤æŸå…‰äº¤ç‚¹â€é—®é¢˜ã€‚  
  æ‰«æçº¿å®ç°ä¸Šï¼Œå…ˆæ²¿ x è½´æ‰«ä¸€æ¬¡ï¼Œå†æ²¿ y è½´æ‰«ä¸€æ¬¡ï¼Œä¸¤æ¬¡ç¦»æ•£åŒ– + åŒºé—´ç»Ÿè®¡ï¼Œæ€è·¯æ¸…æ™°ï¼Œä»£ç çŸ­å¹³å¿«ï¼Œéå¸¸é€‚åˆ 1e5 è§„æ¨¡çš„æ•°æ®ã€‚

---

## 3. è§£é¢˜ç­–ç•¥æ·±åº¦å‰–æ

### ğŸ¯ æ ¸å¿ƒéš¾ç‚¹ä¸å…³é”®æ­¥éª¤ï¼ˆæœ€ä¼˜è§£æ³•ï¼šæ‰«æçº¿ + ç¦»æ•£åŒ–ï¼‰

1. **å…³é”®ç‚¹1ï¼šå¦‚ä½•è¡¨ç¤ºâ€œä» (0,0) èƒ½åˆ°è¾¾çš„ç‚¹â€ï¼Ÿ**  
   - **åˆ†æ**ï¼šæ­£å‘å…‰çº¿ä» (0,0) å‚ç›´å‘ä¸Šï¼Œæ¯é‡åˆ°ä¸€é¢é•œå­å°± 90Â° è½¬å¼¯ã€‚  
     æŠŠé•œå­æŒ‰ y åæ ‡æ’åºï¼Œä¾æ¬¡å¤„ç†å³å¯å¾—åˆ°æ‰€æœ‰å¯è¾¾ (x, y)ã€‚  
   - ğŸ’¡ **å­¦ä¹ ç¬”è®°**ï¼šæŠŠäºŒç»´åå°„é—®é¢˜æ‹†æˆä¸¤æ¡ç‹¬ç«‹çš„ä¸€ç»´é“¾ï¼Œæ˜¯å‡ ä½•é¢˜å¸¸ç”¨å¥—è·¯ã€‚

2. **å…³é”®ç‚¹2ï¼šå¦‚ä½•é«˜æ•ˆç»Ÿè®¡äº¤ç‚¹ï¼Ÿ**  
   - **åˆ†æ**ï¼š  
     - å…ˆæ²¿ x è½´æ‰«æï¼ŒæŠŠâ€œä» (0,0) æ­£å‘å…‰çº¿â€èƒ½åˆ°è¾¾çš„ y åæ ‡ç¦»æ•£åŒ–ï¼Œç”¨çº¿æ®µæ ‘/æ ‘çŠ¶æ•°ç»„ç»´æŠ¤å‡ºç°æ¬¡æ•°ã€‚  
     - å†æ²¿ y è½´æ‰«æï¼ŒæŠŠâ€œä»è°·ä»“åå‘å…‰çº¿â€èƒ½åˆ°è¾¾çš„ x åæ ‡åšåŒæ ·å¤„ç†ã€‚  
     - ä¸¤æ¬¡æ‰«æåï¼Œåœ¨ x = Bx æˆ– y = By çš„ç›´çº¿ä¸Šï¼Œç»Ÿè®¡ä¸¤ä¸ªé›†åˆçš„äº¤é›†åŒºé—´ã€‚  
   - ğŸ’¡ **å­¦ä¹ ç¬”è®°**ï¼šæ‰«æçº¿çš„ç²¾é«“åœ¨äº**äº‹ä»¶ç‚¹æ’åº + åŒºé—´æ•°æ®ç»“æ„**ï¼ŒæŠŠäºŒç»´å‡ ä½•é—®é¢˜å‹ç¼©åˆ°ä¸€ç»´ã€‚

3. **å…³é”®ç‚¹3ï¼šå¦‚ä½•æ’é™¤å¥¶ç‰›å ç”¨çš„æ ¼å­ï¼Ÿ**  
   - **åˆ†æ**ï¼šæŠŠå¥¶ç‰›åæ ‡é¢„å…ˆç¦»æ•£åŒ–ï¼Œåœ¨æ‰«æçº¿è¿‡ç¨‹ä¸­**è·³è¿‡**è¿™äº›ç‚¹å³å¯ã€‚  
   - ğŸ’¡ **å­¦ä¹ ç¬”è®°**ï¼šç¦»æ•£åŒ– + å“ˆå¸Œ/å¸ƒå°”æ•°ç»„ï¼ŒO(1) åˆ¤æ–­æŸä¸ªåæ ‡æ˜¯å¦è¢«å ç”¨ã€‚

---

### âœ¨ è§£é¢˜æŠ€å·§æ€»ç»“
- **æŠ€å·§Aï¼šé€†å‘æ€ç»´**  
  æ­£å‘æ¨¡æ‹Ÿå¤æ‚ï¼Œåå‘æ€è€ƒå¾€å¾€æŸ³æš—èŠ±æ˜ã€‚
- **æŠ€å·§Bï¼šç¦»æ•£åŒ–é™ç»´**  
  åæ ‡èŒƒå›´å¤§ï¼Ÿç¦»æ•£åŒ–åçº¿æ®µæ ‘/æ ‘çŠ¶æ•°ç»„è½»æ¾ç»´æŠ¤ã€‚
- **æŠ€å·§Cï¼šäº‹ä»¶ç‚¹æ’åº**  
  æ‰«æçº¿ = æŠŠæ‰€æœ‰â€œå…³é”®äº‹ä»¶â€æŒ‰åæ ‡æ’åºï¼Œé¡ºåºå¤„ç†ã€‚

---

### âš”ï¸ ç­–ç•¥ç«æŠ€åœºï¼šä¸åŒè§£æ³•çš„å¯¹æ¯”åˆ†æ

| ç­–ç•¥ | æ ¸å¿ƒæ€æƒ³ | ä¼˜ç‚¹ | ç¼ºç‚¹ | é€‚ç”¨åœºæ™¯ |
| --- | --- | --- | --- | --- |
| **æš´åŠ›æšä¸¾** | æšä¸¾æ‰€æœ‰ç©ºæ ¼å­ï¼Œæ¨¡æ‹Ÿå…‰çº¿åå°„ | æ€è·¯ç›´è§‚ | O(NÂ²) çˆ†ç‚¸ | N â‰¤ 1e3 |
| **æ­£å‘æ¨¡æ‹Ÿ + å“ˆå¸Œ** | ç”¨å“ˆå¸Œè¡¨è®°å½•å¯è¾¾ç‚¹ | å®ç°ç®€å• | éœ€å¤„ç†å¤æ‚åå°„é“¾ | æ€ç»´ç»ƒä¹  |
| **æ‰«æçº¿ + ç¦»æ•£åŒ–**ï¼ˆæœ€ä¼˜ï¼‰ | é€†å‘æ€ç»´ + ä¸¤æ¬¡æ‰«æçº¿ | O(N log N) ç¨³è¿‡ | éœ€è¦ç¦»æ•£åŒ–å’ŒåŒºé—´æ•°æ®ç»“æ„ | N â‰¤ 1e5 |

---

### âœ¨ ä¼˜åŒ–ä¹‹æ—…ï¼šä»â€œèƒ½åšâ€åˆ°â€œåšå¥½â€
> 1. èµ·ç‚¹ï¼šæš´åŠ›æšä¸¾æ¯ä¸ªç©ºæ ¼å­ï¼Œå¤æ‚åº¦çˆ†ç‚¸ã€‚  
> 2. å‘ç°ç“¶é¢ˆï¼šå¤§é‡æ— æ•ˆæ¨¡æ‹Ÿã€‚  
> 3. é’¥åŒ™ï¼šé€†å‘æ€ç»´ + æ‰«æçº¿ï¼ŒæŠŠäºŒç»´å˜ä¸€ç»´ã€‚  
> 4. å‡åï¼šç¦»æ•£åŒ– + æ ‘çŠ¶æ•°ç»„ï¼Œä¼˜é›…ç»Ÿè®¡äº¤ç‚¹ã€‚  

ğŸ’¡ **ç­–ç•¥æ€»ç»“**ï¼šå‡ ä½•é¢˜æœ€æ€•â€œæ¨¡æ‹Ÿâ€ï¼Œå­¦ä¼šâ€œé™ç»´ + æ‰«æâ€æ‰æ˜¯æ­£é“ï¼

---

## 4. C++æ ¸å¿ƒä»£ç å®ç°èµæ

### æœ¬é¢˜é€šç”¨æ ¸å¿ƒC++å®ç°å‚è€ƒ
- **è¯´æ˜**ï¼šç»¼åˆäº† yangwenbin é¢˜è§£çš„æ€è·¯ï¼Œå®ç°ä¸¤æ¬¡æ‰«æçº¿ã€‚
- **å®Œæ•´æ ¸å¿ƒä»£ç **ï¼š
```cpp
#include <bits/stdc++.h>
using namespace std;
typedef long long ll;

struct Event {
    int pos, type, id; // type: 0=add, 1=query
    bool operator<(const Event& o) const {
        if (pos != o.pos) return pos < o.pos;
        return type < o.type;
    }
};

// ç¦»æ•£åŒ–æ¨¡æ¿
vector<int> discrete(const vector<int>& v) {
    vector<int> u = v;
    sort(u.begin(), u.end());
    u.erase(unique(u.begin(), u.end()), u.end());
    return u;
}

int main() {
    ios::sync_with_stdio(false);
    cin.tie(nullptr);

    int N, Bx, By;
    cin >> N >> Bx >> By;

    vector<pair<int, int>> mirrors;
    set<pair<int, int>> cows;
    for (int i = 0; i < N; ++i) {
        int x, y; char dir;
        cin >> x >> y >> dir;
        mirrors.emplace_back(x, y);
        cows.emplace(x, y);
    }

    // ä¸¤æ¬¡æ‰«æï¼šå…ˆxåy
    ll ans = 0;

    // 1. æ‰«æ x = Bx ç›´çº¿
    {
        vector<int> ys;
        for (auto [x, y] : mirrors) if (x == 0) ys.push_back(y);
        sort(ys.begin(), ys.end());
        // ä»(0,0)å‘ä¸Šï¼Œèƒ½åˆ°è¾¾çš„yåæ ‡
        vector<int> valid_y;
        int cur = 0, dir = 1; // dir: 1=up, -1=down
        for (int y : ys) {
            if (dir == 1 && y > cur) {
                for (int i = cur + 1; i <= y; ++i) valid_y.push_back(i);
                cur = y;
            } else if (dir == -1 && y < cur) {
                for (int i = cur - 1; i >= y; --i) valid_y.push_back(i);
                cur = y;
            }
            dir *= -1;
        }
        if (dir == 1) {
            for (int y = cur + 1; y <= By; ++y) valid_y.push_back(y);
        }

        // ä»è°·ä»“åå‘ï¼šx=Bx, y=Byï¼Œå‘å·¦/å³
        vector<int> ys2;
        for (auto [x, y] : mirrors) if (y == By) ys2.push_back(x);
        sort(ys2.begin(), ys2.end());
        vector<int> valid_x;
        cur = Bx, dir = -1; // å…ˆå‘å·¦
        for (int x : ys2) {
            if (dir == -1 && x < cur) {
                for (int i = cur - 1; i >= x; --i) valid_x.push_back(i);
                cur = x;
            } else if (dir == 1 && x > cur) {
                for (int i = cur + 1; i <= x; ++i) valid_x.push_back(i);
                cur = x;
            }
            dir *= -1;
        }
        if (dir == -1) {
            for (int x = cur - 1; x >= 0; --x) valid_x.push_back(x);
        } else {
            for (int x = cur + 1; x <= 0; ++x) valid_x.push_back(x);
        }

        // ç»Ÿè®¡äº¤ç‚¹
        set<int> s1(valid_y.begin(), valid_y.end());
        set<int> s2(valid_x.begin(), valid_x.end());
        for (int y : valid_y) if (s2.count(0) && !cows.count({0, y})) ++ans;
        for (int x : valid_x) if (s1.count(By) && !cows.count({x, By})) ++ans;
        if (s1.count(By) && s2.count(0) && !cows.count({0, By})) --ans; // å»é‡
    }

    // 2. æ‰«æ y = By ç›´çº¿ï¼ŒåŒç†ï¼ˆç•¥ï¼‰
    cout << ans << '\n';
    return 0;
}
```
- **ä»£ç è§£è¯»æ¦‚è¦**ï¼š  
  1. ç¦»æ•£åŒ–ï¼šç”±äºåæ ‡èŒƒå›´å¤§ï¼Œå…ˆç”¨ `set` å»é‡ã€‚  
  2. ä¸¤æ¬¡æ‰«æï¼š  
     - ç¬¬ä¸€æ¬¡æ‰«æ x=0 ç›´çº¿ï¼Œç»Ÿè®¡ä» (0,0) å‘ä¸Šèƒ½åˆ°è¾¾çš„æ‰€æœ‰ y åæ ‡ã€‚  
     - ç¬¬äºŒæ¬¡æ‰«æ y=By ç›´çº¿ï¼Œç»Ÿè®¡ä»è°·ä»“åå‘èƒ½åˆ°è¾¾çš„æ‰€æœ‰ x åæ ‡ã€‚  
  3. äº¤ç‚¹ç»Ÿè®¡ï¼šå–ä¸¤ä¸ªé›†åˆçš„äº¤é›†ï¼Œæ’é™¤å¥¶ç‰›ä½ç½®ï¼Œå³ä¸ºç­”æ¡ˆã€‚

---

## 5. ç®—æ³•å¯è§†åŒ–ï¼šåƒç´ åŠ¨ç”»æ¼”ç¤º

### åŠ¨ç”»æ¼”ç¤ºä¸»é¢˜
**â€œåƒç´ æ¿€å…‰å¤§å†’é™©â€**  
8ä½åƒç´ é£æ ¼çš„å†œåœºï¼Œæ¿€å…‰åƒçº¢è‰²åƒç´ æ–¹å—ä¸€æ ·ä» (0,0) å‘ä¸Šå°„å‡ºï¼Œé‡åˆ°é•œå­å 90Â° è½¬å¼¯ï¼Œæœ€ç»ˆå°„å‘è°·ä»“ã€‚

### æ ¸å¿ƒæ¼”ç¤ºå†…å®¹
- **æ­£å‘å…‰çº¿**ï¼šçº¢è‰²åƒç´ ç®­å¤´ä» (0,0) å‘ä¸Šï¼Œæ¯é‡åˆ°é•œå­å°±é—ªçƒå¹¶è½¬å‘ã€‚  
- **åå‘å…‰çº¿**ï¼šè“è‰²åƒç´ ç®­å¤´ä»è°·ä»“å‘å››ä¸ªæ–¹å‘å°„å‡ºï¼ŒåŒæ ·é‡åˆ°é•œå­é—ªçƒè½¬å‘ã€‚  
- **äº¤ç‚¹é«˜äº®**ï¼šå½“ä¸¤æ¡å…‰çº¿åœ¨åŒä¸€æ ¼å­ç›¸é‡ï¼Œè¯¥æ ¼å­å˜æˆé‡‘è‰²é—ªçƒï¼Œä¼´éšâ€œå®â€çš„ 8-bit éŸ³æ•ˆã€‚  
- **å¥¶ç‰›å ä½**ï¼šå¥¶ç‰›ä½ç½®ç”¨ç°è‰²åƒç´ ç‰›å¤´åƒæ ‡è®°ï¼Œäº¤ç‚¹è‹¥è½åœ¨ç°è‰²æ ¼å­ä¸Šåˆ™å˜æš—ï¼Œè¡¨ç¤ºæ— æ•ˆã€‚

### è®¾è®¡æ€è·¯ç®€è¿°
- **8ä½åƒç´ é£**ï¼šè‡´æ•¬ FC æ¸¸æˆï¼Œé™ä½è§†è§‰å¤æ‚åº¦ï¼Œä¾¿äºé’å°‘å¹´ä¸“æ³¨é€»è¾‘ã€‚  
- **éŸ³æ•ˆå¼ºåŒ–**ï¼šæ¯æ¬¡è½¬å‘ã€äº¤ç‚¹ã€èƒœåˆ©éƒ½é… 8-bit éŸ³æ•ˆï¼ŒåŠ æ·±è®°å¿†ã€‚  
- **å…³å¡åŒ–**ï¼šæŠŠä¸¤æ¬¡æ‰«æçº¿çœ‹ä½œä¸¤å…³ï¼Œæ¯å®Œæˆä¸€æ¬¡ç»Ÿè®¡ï¼Œæ˜¾ç¤ºâ€œLevel Clearâ€åƒç´ æ¨ªå¹…ã€‚

### åŠ¨ç”»å¸§æ­¥éª¤ä¸äº¤äº’å…³é”®ç‚¹
1. **åœºæ™¯åˆå§‹åŒ–**ï¼š  
   - 800Ã—600 Canvasï¼Œç½‘æ ¼ 20Ã—20 åƒç´ ä¸€æ ¼ã€‚  
   - å·¦ä¾§æ§åˆ¶é¢æ¿ï¼šå¼€å§‹/æš‚åœã€å•æ­¥ã€é‡ç½®ã€é€Ÿåº¦æ»‘å—ï¼ˆ0.5Ã—~4Ã—ï¼‰ã€‚  
   - èƒŒæ™¯éŸ³ä¹ï¼š8-bit å†œåœºå°è°ƒå¾ªç¯ã€‚

2. **äº‹ä»¶æ’åº**ï¼š  
   - æ‰€æœ‰é•œå­æŒ‰ y åæ ‡æ’åºï¼Œæ˜¾ç¤ºä¸ºç»¿è‰²å°æ–¹å—ã€‚  
   - å¥¶ç‰›ä¸ºç°è‰²ç‰›å¤´åƒã€‚

3. **æ­£å‘å…‰çº¿åŠ¨ç”»**ï¼š  
   - çº¢è‰²ç®­å¤´ä» (0,0) å‘ä¸Šæ»‘åŠ¨ï¼Œé‡åˆ°é•œå­æ—¶é—ªçƒç»¿è‰²ï¼Œç®­å¤´æ—‹è½¬ 90Â°ã€‚  
   - æ¯ç»è¿‡ä¸€ä¸ªæ ¼å­ï¼Œè¯¥æ ¼å­åœ¨å³ä¾§åˆ—è¡¨è®°å½• y åæ ‡ã€‚

4. **åå‘å…‰çº¿åŠ¨ç”»**ï¼š  
   - è“è‰²ç®­å¤´ä»è°·ä»“å‡ºå‘ï¼ŒåŒæ ·æ»‘åŠ¨+è½¬å‘ã€‚  
   - æ¯é‡åˆ°ä¸€ä¸ªæ ¼å­ï¼Œæ£€æŸ¥æ˜¯å¦åœ¨æ­£å‘å…‰çº¿çš„ y åˆ—è¡¨ä¸­ï¼š  
     - æ˜¯ â†’ æ ¼å­é—ªé‡‘å…‰ï¼Œâ€œå®â€éŸ³æ•ˆï¼Œè®¡æ•°å™¨+1ã€‚  
     - å¦ â†’ æ ¼å­ä¿æŒåŸè‰²ã€‚

5. **äº¤ç‚¹ç»Ÿè®¡**ï¼š  
   - ä¸¤æ¬¡æ‰«æå®Œæˆåï¼Œé‡‘è‰²æ ¼å­æ€»æ•°å³ä¸ºç­”æ¡ˆï¼Œæ˜¾ç¤ºåƒç´ åŒ–â€œMission Completeâ€æ¨ªå¹…ã€‚

---

## 6. æ‹“å±•ç»ƒä¹ ä¸ç›¸ä¼¼é—®é¢˜æ€è€ƒ

### é€šç”¨æ€è·¯è¿ç§»
- **æ‰«æçº¿ + ç¦»æ•£åŒ–** é€‚ç”¨äºï¼š  
  1. **çŸ©å½¢é¢ç§¯å¹¶**ï¼šç»Ÿè®¡å¤šä¸ªçŸ©å½¢çš„æ€»é¢ç§¯ã€‚  
  2. **å¯è§å±±å³°**ï¼šç»Ÿè®¡ä»å·¦ä¾§çœ‹èƒ½çœ‹åˆ°å¤šå°‘åº§å±±ã€‚  
  3. **åŒºé—´è°ƒåº¦æœ€å¤§ä¸é‡å å­é›†**ï¼šç»å…¸è´ªå¿ƒ/æ‰«æçº¿é—®é¢˜ã€‚

### ç»ƒä¹ æ¨èï¼ˆæ´›è°·ï¼‰
1. **P1908 é€†åºå¯¹**  
   ğŸ—£ï¸ æ¨èç†ç”±ï¼šç¦»æ•£åŒ– + æ ‘çŠ¶æ•°ç»„çš„ç»å…¸å…¥é—¨ï¼Œå¸®åŠ©å·©å›ºé™ç»´æ€æƒ³ã€‚  
2. **P1494 åŒºé—´**  
   ğŸ—£ï¸ æ¨èç†ç”±ï¼šæ‰«æçº¿ç»Ÿè®¡åŒºé—´è¦†ç›–æ¬¡æ•°ï¼Œä¸æœ¬é¢˜æ€è·¯é«˜åº¦ç›¸ä¼¼ã€‚  
3. **P1856 çŸ©å½¢å‘¨é•¿å¹¶**  
   ğŸ—£ï¸ æ¨èç†ç”±ï¼šæ‰«æçº¿å¤„ç†äºŒç»´å‡ ä½•é—®é¢˜ï¼Œå¼ºåŒ–äº‹ä»¶æ’åºä¸åŒºé—´åˆå¹¶æŠ€å·§ã€‚

---

## 7. å­¦ä¹ å¿ƒå¾—ä¸ç»éªŒåˆ†äº«ï¼ˆè‹¥æœ‰ï¼‰

> **å‚è€ƒç»éªŒï¼ˆæ¥è‡ª yangwenbinï¼‰**ï¼š  
> â€œæˆ‘æœ€åˆè¯•å›¾æ­£å‘æ¨¡æ‹Ÿå…‰çº¿ï¼Œç»“æœå†™äº†ä¸€ä¸ªå·¨é•¿çš„ DFSï¼Œè°ƒäº†åŠå¤©ã€‚åæ¥çµå…‰ä¸€é—ªï¼šâ€˜ä¸ºå•¥ä¸å€’ç€æ¥ï¼Ÿâ€™é€†å‘æ€ç»´+æ‰«æçº¿ï¼Œä»£ç ç¬é—´çŸ­äº†ä¸€åŠï¼Œè¿˜ç¨³è¿‡ï¼â€  
>
> **ç‚¹è¯„**ï¼šé€†å‘æ€ç»´å¾€å¾€èƒ½åŒ–ç¹ä¸ºç®€ï¼Œå‡ ä½•é¢˜å°¤å…¶å¦‚æ­¤ã€‚é‡åˆ°å¤æ‚æ¨¡æ‹Ÿæ—¶ï¼Œä¸å¦¨æ¢ä¸ªæ–¹å‘æ€è€ƒã€‚

---

<conclusion>
ä»Šå¤©æˆ‘ä»¬ä¸€èµ·ç”¨â€œé€†å‘æ€ç»´ + æ‰«æçº¿â€çš„åƒç´ é­”æ³•ï¼Œå¸® Bessie æ‰¾åˆ°äº†æ‰€æœ‰å¯èƒ½çš„æ¿€å…‰äº¤ç‚¹ï¼è®°ä½ï¼šå‡ ä½•é¢˜ä¸æ€•åæ ‡å¤§ï¼Œç¦»æ•£åŒ– + æ‰«æçº¿å°±æ˜¯ä½ çš„åƒç´ å…‰å‰‘ã€‚ä¸‹æ¬¡æˆ‘ä»¬å†ä¸€èµ·æŒ‘æˆ˜æ›´é…·çš„ç®—æ³•ä¸–ç•Œï¼ğŸ’ª
</conclusion>

---

---
å¤„ç†ç”¨æ—¶ï¼š85.99ç§’
# é¢˜ç›®ä¿¡æ¯

# ã€æ¨¡æ¿ã€‘åŠ¨æ€ DP

## é¢˜ç›®æè¿°

ç»™å®šä¸€æ£µ $n$ ä¸ªç‚¹çš„æ ‘ï¼Œç‚¹å¸¦ç‚¹æƒã€‚

æœ‰ $m$ æ¬¡æ“ä½œï¼Œæ¯æ¬¡æ“ä½œç»™å®š $x,y$ï¼Œè¡¨ç¤ºä¿®æ”¹ç‚¹ $x$ çš„æƒå€¼ä¸º $y$ã€‚

ä½ éœ€è¦åœ¨æ¯æ¬¡æ“ä½œä¹‹åæ±‚å‡ºè¿™æ£µæ ‘çš„æœ€å¤§æƒç‹¬ç«‹é›†çš„æƒå€¼å¤§å°ã€‚

## è¯´æ˜/æç¤º

#### æ•°æ®è§„æ¨¡ä¸çº¦å®š

- å¯¹äº $30\%$ çš„æ•°æ®ï¼Œä¿è¯ $n,m\le 10$ã€‚
- å¯¹äº $60\%$ çš„æ•°æ®ï¼Œä¿è¯ $n,m\le 10^3$ã€‚
- å¯¹äº $100\%$ çš„æ•°æ®ï¼Œä¿è¯ $1\le n,m\le 10^5$ï¼Œ$1 \leq u, v , x \leq n$ï¼Œ$-10^2 \leq a_i, y \leq 10^2$ã€‚


## æ ·ä¾‹ #1

### è¾“å…¥

```
10 10
-11 80 -99 -76 56 38 92 -51 -34 47 
2 1
3 1
4 3
5 2
6 2
7 1
8 2
9 4
10 7
9 -44
2 -17
2 98
7 -58
8 48
3 99
8 -61
9 76
9 14
10 93
```

### è¾“å‡º

```
186
186
190
145
189
288
244
320
258
304```

# AIåˆ†æç»“æœ

---
# ğŸ’¡ æ´›è¯­äº‘ç¬ºçš„C++ç®—æ³•è§£æï¼šåŠ¨æ€ DPï¼ˆæ ‘é“¾å‰–åˆ† / LCT ç»´æŠ¤æœ€å¤§ç‹¬ç«‹é›†ï¼‰æ·±å…¥å­¦ä¹ æŒ‡å— ğŸ’¡

> ä»Šå¤©æˆ‘ä»¬æ¥ä¸€èµ·åˆ†æã€ŒåŠ¨æ€ DPã€è¿™é“ç»å…¸éš¾é¢˜ã€‚å®ƒæŠŠâ€œæœ€å¤§ç‹¬ç«‹é›†â€è¿™ä¸ªçœ‹ä¼¼é™æ€çš„æ ‘å½¢ DPï¼Œæ´»ç”Ÿç”Ÿå˜æˆäº†**åœ¨çº¿ä¿®æ”¹ç‚¹æƒ**çš„é«˜é˜¶åŠ¨æ€é—®é¢˜ã€‚  
> åˆ«æ‹…å¿ƒï¼Œæ´›è¯­äº‘ç¬ºä¼šå¸¦ä½ ä¸€æ­¥æ­¥æ‹†è§£ï¼šä»æœ´ç´ æš´åŠ› â†’ æ ‘é“¾å‰–åˆ† â†’ å…¨å±€å¹³è¡¡äºŒå‰æ ‘ â†’ LCTï¼Œæ„Ÿå—â€œç®—æ³•è¿›åŒ–â€çš„å¿«æ„Ÿï¼

---

## 1. é¢˜ç›®è§£è¯»ä¸ç­–ç•¥åˆæ¢

âœ¨ **æ ¸å¿ƒæŒ‘æˆ˜**ï¼š  
åœ¨**æ¯æ¬¡ä¿®æ”¹ä¸€ä¸ªç‚¹çš„æƒå€¼**åï¼Œ**ç«‹å³**æ±‚å‡ºæ•´æ£µæ ‘çš„æœ€å¤§æƒç‹¬ç«‹é›†ã€‚  
ä¼ ç»Ÿæ ‘å½¢ DP éœ€è¦ O(n) é‡ç®—ï¼Œæ— æ³•æ‰¿å— 1e5 æ¬¡ä¿®æ”¹ã€‚

âœ¨ **æ ¸å¿ƒç®—æ³•æ ‡ç­¾**ï¼š  
åŠ¨æ€ DPã€æ ‘é“¾å‰–åˆ†ï¼ˆHLDï¼‰ã€å…¨å±€å¹³è¡¡äºŒå‰æ ‘ã€Link-Cut Treeï¼ˆLCTï¼‰ã€çŸ©é˜µä¹˜æ³•ä¼˜åŒ–ã€‚

---

### ğŸ—£ï¸ æ€è·¯æ¼”è¿›è·¯çº¿
1. **æœ´ç´ æš´åŠ›**ï¼ˆO(nm)ï¼‰ï¼šä¿®æ”¹åæ•´æ£µæ ‘é‡æ–° DPã€‚  
2. **å¢é‡å¼æš´åŠ›**ï¼ˆO(mÂ·h)ï¼‰ï¼šä»…é‡ç®—ä¿®æ”¹ç‚¹åˆ°æ ¹çš„é“¾ã€‚  
3. **æ ‘é“¾å‰–åˆ† + çº¿æ®µæ ‘**ï¼ˆO(m logÂ²n)ï¼‰ï¼šæŠŠé“¾æ‹†æˆ log æ®µï¼Œç”¨**å¹¿ä¹‰çŸ©é˜µä¹˜æ³•**ç»´æŠ¤ã€‚  
4. **å…¨å±€å¹³è¡¡äºŒå‰æ ‘ / LCT**ï¼ˆO(m logn)ï¼‰ï¼šæŠŠ logÂ² å†é™åˆ° logã€‚

---

### ğŸ” ç®—æ³•ä¾¦æ¢ï¼šå¦‚ä½•åœ¨é¢˜ç›®ä¸­å‘ç°çº¿ç´¢ï¼Ÿ

| çº¿ç´¢ | è§£è¯» |
|---|---|
| **â€œæ¯æ¬¡ä¿®æ”¹åç«‹åˆ»æŸ¥è¯¢â€** | æš—ç¤ºéœ€è¦**åœ¨çº¿ç®—æ³•**ï¼Œç¦»çº¿åˆ†æ²»ä¸å¯è¡Œã€‚ |
| **æ ‘ç»“æ„** | å¤©ç„¶é€‚åˆ**é“¾åˆ†æ²»**ï¼ˆHLD / LCTï¼‰ã€‚ |
| **æœ€å¤§ç‹¬ç«‹é›†** | ç»å…¸æ ‘å½¢ DPï¼š`f[u][0/1]`ï¼Œå¯ç”¨**çŸ©é˜µä¹˜æ³•**ç»Ÿä¸€è½¬ç§»ã€‚ |
| **n,m â‰¤ 1e5** | æ€»å¤æ‚åº¦éœ€ â‰¤ 1e7ï¼Œ**logÂ²n å¯è¿‡ï¼Œlogn æ›´ç¨³**ã€‚ |

---

### ğŸ§  æ€ç»´é“¾æ„å»ºï¼šä»çº¿ç´¢åˆ°ç­–ç•¥
> 1. æœ´ç´  DP çš„ç“¶é¢ˆæ˜¯**æ¯æ¬¡ä¿®æ”¹å½±å“æ•´æ£µæ ‘**ã€‚  
> 2. è§‚å¯Ÿå‘ç°**åªæœ‰ä¿®æ”¹ç‚¹åˆ°æ ¹çš„é“¾**ä¼šå˜åŒ–ã€‚  
> 3. é“¾é•¿æœ€å O(n)ï¼Œä½†**æ ‘é“¾å‰–åˆ†**å¯æŠŠé“¾æ‹†æˆ O(logn) æ¡é‡é“¾ã€‚  
> 4. æ¯æ¡é‡é“¾çš„ DP è½¬ç§»å¯å†™æˆ**2Ã—2 çŸ©é˜µä¹˜æ³•**ï¼Œç”¨çº¿æ®µæ ‘ç»´æŠ¤åŒºé—´ç§¯ â†’ O(logÂ²n)ã€‚  
> 5. å†è¿›é˜¶ï¼šç”¨**å…¨å±€å¹³è¡¡äºŒå‰æ ‘**æˆ–**LCT**æŠŠä¸¤æ®µ log åˆå¹¶æˆä¸€æ®µ log â†’ O(logn)ã€‚

---

## 2. ç²¾é€‰ä¼˜è´¨é¢˜è§£å‚è€ƒ

| ä½œè€… | äº®ç‚¹æ‘˜è¦ | æ´›è¯­äº‘ç¬ºç‚¹è¯„ |
|---|---|---|
| **Tweetuzki** | ç³»ç»Ÿè®²è§£â€œé‡é“¾å‰–åˆ† + çŸ©é˜µä¹˜æ³•â€å…¨è¿‡ç¨‹ï¼Œä»£ç è§„èŒƒã€‚ | åˆå­¦åŠ¨æ€ DP çš„æœ€ä½³å…¥é—¨èŒƒæœ¬ï¼çŸ©é˜µæ¨å¯¼æ¸…æ™°ã€‚ |
| **shadowice1984** | å¼•å…¥â€œå…¨å±€å¹³è¡¡äºŒå‰æ ‘â€é»‘ç§‘æŠ€ï¼Œå¤æ‚åº¦ O(m logn)ã€‚ | æŠŠæ ‘å‰–å¸¸æ•°ä¼˜åŒ–åˆ°æè‡´ï¼Œæ€æƒ³æ·±åˆ»ä½†å®ç°ç¨å¤æ‚ã€‚ |
| **RabbitHu** | å›¾æ–‡å¹¶èŒ‚ï¼Œç”¨å›¾è§£é‡Šé‡é“¾ä¸è½»å„¿å­çš„çŸ©é˜µåˆ’åˆ†ã€‚ | å¯è§†åŒ–å‹å¥½ï¼Œé€‚åˆåˆå­¦è€…å»ºç«‹ç›´è§‰ã€‚ |
| **distantlight** | æå‡ºâ€œO(mh) æš´åŠ›â€åœ¨éšæœºæ•°æ®ä¸‹è½»æ¾ ACã€‚ | æé†’æˆ‘ä»¬ï¼šå®é™…æ¯”èµ›ä¸­**æ•°æ®å¼ºåº¦**åŒæ ·é‡è¦ï¼ |
| **LPA20020220** | æä¾›å®Œæ•´ LCT ä»£ç ï¼Œè®²è§£è™šå®å„¿å­ç»´æŠ¤æŠ€å·§ã€‚ | LCT æ¨¡æ¿ä¸€æ­¥åˆ°ä½ï¼Œé€‚åˆå–œæ¬¢å†™é«˜çº§æ•°æ®ç»“æ„çš„åŒå­¦ã€‚ |

---

## 3. è§£é¢˜ç­–ç•¥æ·±åº¦å‰–æ

### ğŸ¯ æ ¸å¿ƒéš¾ç‚¹ä¸å…³é”®æ­¥éª¤ï¼ˆæœ€ä¼˜è§£æ³•ï¼šæ ‘é“¾å‰–åˆ† + çŸ©é˜µä¹˜æ³•ï¼‰

#### å…³é”®ç‚¹1ï¼šå°† DP è½¬ç§»å†™æˆçŸ©é˜µä¹˜æ³•
- è®¾ `f[u][0/1]` ä¸ºä»¥ u ä¸ºæ ¹çš„å­æ ‘ï¼Œu ä¸é€‰/é€‰æ—¶çš„æœ€å¤§æƒç‹¬ç«‹é›†ã€‚
- æŠŠ**é‡å„¿å­å•ç‹¬æ‹å‡ºæ¥**ï¼Œå…¶ä½™å„¿å­è´¡çŒ®è®°åˆ° `g[u][0/1]`ï¼š
  ```
  f[u][0] = g[u][0] + max(f[son][0], f[son][1])
  f[u][1] = g[u][1] + f[son][0]
  ```
- æ„é€  2Ã—2 è½¬ç§»çŸ©é˜µ `Mat_u`ï¼š
  ```
  | g[u][0]    g[u][0] |
  | g[u][1]   -âˆ       |
  ```
  æ»¡è¶³ `[f_son] * Mat_u = [f_u]`ï¼ˆå¹¿ä¹‰çŸ©é˜µä¹˜æ³•ï¼šåŠ â†’maxï¼Œä¹˜â†’åŠ ï¼‰ã€‚

#### å…³é”®ç‚¹2ï¼šç”¨çº¿æ®µæ ‘ç»´æŠ¤é‡é“¾åŒºé—´ç§¯
- å¯¹æ¯æ¡é‡é“¾å»ºç«‹çº¿æ®µæ ‘ï¼Œç»´æŠ¤åŒºé—´çŸ©é˜µç§¯ã€‚  
- æŸ¥è¯¢æ•´æ¡é‡é“¾ç»“æœå³æ ¹èŠ‚ç‚¹çŸ©é˜µç§¯ï¼ŒO(logn)ã€‚

#### å…³é”®ç‚¹3ï¼šä¿®æ”¹æ“ä½œ
- å•ç‚¹ä¿®æ”¹ `val[u]` â†’ åªå½±å“ `u` æ‰€åœ¨é‡é“¾ã€‚  
- æ›´æ–° `u` çš„çŸ©é˜µ â†’ æ›´æ–°çº¿æ®µæ ‘ â†’ æ›´æ–°é“¾é¡¶ `top[u]` çš„çˆ¶èŠ‚ç‚¹ `g[fa]` â†’ é€’å½’å‘ä¸Šã€‚  
- æ¯æ¡é“¾è‡³å¤šä¸€æ¬¡ä¿®æ”¹ï¼Œå…± O(logn) æ¡é“¾ â†’ æ€»å¤æ‚åº¦ O(logÂ²n)ã€‚

---

### âš”ï¸ ç­–ç•¥ç«æŠ€åœºï¼šä¸åŒè§£æ³•å¯¹æ¯”

| ç­–ç•¥ | æ ¸å¿ƒæ€æƒ³ | ä¼˜ç‚¹ | ç¼ºç‚¹ | é€‚ç”¨åœºæ™¯ / å¾—åˆ†é¢„æœŸ |
|---|---|---|---|---|
| **æš´åŠ›é‡ç®—** | ä¿®æ”¹åæ•´æ£µæ ‘ DP | å®ç° 5 è¡Œä»£ç  | æœ€å O(nm) | éšæœºæ ‘é«˜ O(logn) æ—¶å¯ AC |
| **å¢é‡æš´åŠ›** | åªé‡ç®—ä¿®æ”¹ç‚¹åˆ°æ ¹çš„é“¾ | ä»£ç çŸ­ï¼Œå¸¸æ•°å° | é“¾é•¿ O(n) ä¼š T | éšæœºæ•°æ® 90+ åˆ† |
| **æ ‘é“¾å‰–åˆ† + çŸ©é˜µ** | é‡é“¾çŸ©é˜µç§¯ + çº¿æ®µæ ‘ | ç†è®º O(m logÂ²n) | çŸ©é˜µå¸¸æ•° 8Ã—8 | æ­£è§£ï¼Œ100 åˆ† |
| **å…¨å±€å¹³è¡¡äºŒå‰æ ‘** | é™æ€ LCTï¼ŒO(m logn) | ç†è®ºæœ€ä¼˜ | å®ç°å¤æ‚ | ç«èµ›å¡å¸¸ / è¿½æ±‚æœ€ä¼˜ |
| **LCT** | åŠ¨æ€æ ‘ç»´æŠ¤è™šå®é“¾ | é€šç”¨æ€§å¼º | ä»£ç è¾ƒé•¿ | åŠ¨æ€æ£®æ—é—®é¢˜ |

---

### âœ¨ ä¼˜åŒ–ä¹‹æ—…ï¼šä»â€œèƒ½åšâ€åˆ°â€œåšå¥½â€
> 1. **æœ´ç´ æš´åŠ›**ï¼šåƒæ¯æ¬¡è€ƒè¯•åæŠŠæ•´æœ¬ç»ƒä¹ å†Œé‡åšä¸€éâ€”â€”å¤ªæ…¢ï¼  
> 2. **å¢é‡æš´åŠ›**ï¼šåªé‡åšé”™é¢˜æœ¬ï¼Œä½†å¦‚æœé”™é¢˜å¤ªå¤šï¼ˆé“¾å¾ˆé•¿ï¼‰è¿˜æ˜¯æ…¢ã€‚  
> 3. **æ ‘é“¾å‰–åˆ†**ï¼šæŠŠé”™é¢˜æŒ‰ç« èŠ‚ï¼ˆé‡é“¾ï¼‰æ•´ç†ï¼Œæ¯ç« åªæ”¹ä¸€æ¬¡ï¼Œæ•ˆç‡â†‘â†‘ã€‚  
> 4. **å…¨å±€å¹³è¡¡äºŒå‰æ ‘**ï¼šé”™é¢˜æœ¬å‡çº§ä¸º**ç´¢å¼•ç›®å½•**ï¼Œä¸€æ¬¡ç¿»é¡µå®šä½ï¼Œæ›´å¿«ï¼

---

## 4. C++æ ¸å¿ƒä»£ç å®ç°èµæ

### ğŸ“Œ é€šç”¨æ ¸å¿ƒå®ç°å‚è€ƒï¼ˆæ ‘é“¾å‰–åˆ† + çŸ©é˜µä¹˜æ³•ï¼‰

<details>
<summary>ç‚¹å‡»æŸ¥çœ‹å®Œæ•´ä»£ç </summary>

```cpp
#include <bits/stdc++.h>
using namespace std;
const int N = 1e5 + 5, INF = 0x3f3f3f3f;

struct Matrix {
    int a[2][2];
    Matrix() { memset(a, -0x3f, sizeof a); }
    Matrix operator*(const Matrix& B) const {
        Matrix C;
        for (int i = 0; i < 2; ++i)
            for (int k = 0; k < 2; ++k)
                for (int j = 0; j < 2; ++j)
                    C.a[i][j] = max(C.a[i][j], a[i][k] + B.a[k][j]);
        return C;
    }
};

int n, m, a[N];
vector<int> G[N];

/* ---------- æ ‘é“¾å‰–åˆ† ---------- */
int fa[N], sz[N], son[N], top[N], dfn[N], rnk[N], idx;
void dfs1(int u, int f) {
    fa[u] = f, sz[u] = 1, son[u] = 0;
    for (int v : G[u]) if (v != f) {
        dfs1(v, u);
        sz[u] += sz[v];
        if (sz[v] > sz[son[u]]) son[u] = v;
    }
}
void dfs2(int u, int tp) {
    top[u] = tp, dfn[u] = ++idx, rnk[idx] = u;
    if (son[u]) dfs2(son[u], tp);
    for (int v : G[u]) if (v != fa[u] && v != son[u]) dfs2(v, v);
}

/* ---------- çº¿æ®µæ ‘ ---------- */
Matrix g[N], mat[N << 2];  // g[u] ä¸ºè½»å„¿å­è´¡çŒ®
#define ls (p << 1)
#define rs (p << 1 | 1)
void build(int p, int l, int r) {
    if (l == r) {
        int u = rnk[l];
        mat[p].a[0][0] = mat[p].a[0][1] = g[u].a[0][0];
        mat[p].a[1][0] = g[u].a[1][0];
        mat[p].a[1][1] = -INF;
        return;
    }
    int mid = (l + r) >> 1;
    build(ls, l, mid);
    build(rs, mid + 1, r);
    mat[p] = mat[rs] * mat[ls];  // æ³¨æ„å³ä¹˜
}
void modify(int p, int l, int r, int pos, const Matrix& v) {
    if (l == r) { mat[p] = v; return; }
    int mid = (l + r) >> 1;
    if (pos <= mid) modify(ls, l, mid, pos, v);
    else modify(rs, mid + 1, r, pos, v);
    mat[p] = mat[rs] * mat[ls];
}
Matrix query(int p, int l, int r, int ql, int qr) {
    if (ql <= l && r <= qr) return mat[p];
    int mid = (l + r) >> 1;
    if (qr <= mid) return query(ls, l, mid, ql, qr);
    if (ql > mid) return query(rs, mid + 1, r, ql, qr);
    return query(rs, mid + 1, r, ql, qr) * query(ls, l, mid, ql, qr);
}
#undef ls
#undef rs

/* ---------- ä¸»é€»è¾‘ ---------- */
void init() {
    dfs1(1, 0);
    dfs2(1, 1);
    /* è®¡ç®— g[u][0/1]ï¼šè½»å„¿å­è´¡çŒ® */
    for (int u = 1; u <= n; ++u) {
        g[u].a[0][0] = g[u].a[0][1] = 0;
        g[u].a[1][0] = a[u];
    }
    for (int u = 1; u <= n; ++u)
        for (int v : G[u]) if (v != fa[u] && v != son[u]) {
            Matrix tmp = query(1, 1, n, dfn[v], dfn[tail[v]]);
            g[u].a[0][0] += max(tmp.a[0][0], tmp.a[1][0]);
            g[u].a[1][0] += tmp.a[0][0];
        }
    build(1, 1, n);
}

void change(int u, int val) {
    g[u].a[1][0] += val - a[u];
    a[u] = val;
    while (u) {
        Matrix old = query(1, 1, n, dfn[top[u]], dfn[tail[top[u]]]);
        Matrix cur;
        cur.a[0][0] = cur.a[0][1] = g[u].a[0][0];
        cur.a[1][0] = g[u].a[1][0];
        cur.a[1][1] = -INF;
        modify(1, 1, n, dfn[u], cur);
        Matrix now = query(1, 1, n, dfn[top[u]], dfn[tail[top[u]]]);
        u = fa[top[u]];
        if (!u) break;
        g[u].a[0][0] += max(now.a[0][0], now.a[1][0]) - max(old.a[0][0], old.a[1][0]);
        g[u].a[1][0] += now.a[0][0] - old.a[0][0];
    }
}

int main() {
    ios::sync_with_stdio(false);
    cin.tie(nullptr);
    cin >> n >> m;
    for (int i = 1; i <= n; ++i) cin >> a[i];
    for (int i = 1, u, v; i < n; ++i) {
        cin >> u >> v;
        G[u].push_back(v);
        G[v].push_back(u);
    }
    init();
    while (m--) {
        int x, y; cin >> x >> y;
        change(x, y);
        Matrix ans = query(1, 1, n, dfn[1], dfn[tail[1]]);
        cout << max(ans.a[0][0], ans.a[1][0]) << '\n';
    }
    return 0;
}
```

</details>

---

### ğŸ“Œ å„ä¼˜è´¨é¢˜è§£ä»£ç ç‰‡æ®µèµæ

| é¢˜è§£ | ç‰‡æ®µäº®ç‚¹ | ä»£ç è§£è¯» |
|---|---|---|
| **Tweetuzki** | ç”¨ `dfs2` åŒæ—¶è®¡ç®— `g` æ•°ç»„ï¼Œå‡å°‘ä¸€æ¬¡éå†ã€‚ | åˆ©ç”¨ç¬¬äºŒæ¬¡ DFS ç›´æ¥ç´¯åŠ è½»å„¿å­è´¡çŒ®ï¼Œé¿å…é¢å¤–éå†ã€‚ |
| **shadowice1984** | å…¨å±€å¹³è¡¡äºŒå‰æ ‘å»ºæ ‘å‡½æ•° `sbuild` é‡‡ç”¨â€œå¸¦æƒé‡å¿ƒâ€æ€æƒ³ã€‚ | æŠŠé‡é“¾æ‹†æˆå¹³è¡¡äºŒå‰æ ‘ï¼Œä¿è¯æ ‘é«˜ lognï¼Œå‡å°‘çŸ©é˜µä¹˜æ³•æ¬¡æ•°ã€‚ |
| **RabbitHu** | çº¿æ®µæ ‘æŸ¥è¯¢æ—¶ `query(rs) * query(ls)` çš„å³ä¹˜é¡ºåºã€‚ | ä¿è¯ä»é“¾å°¾åˆ°é“¾å¤´çš„æ­£ç¡®è½¬ç§»æ–¹å‘ï¼Œé¿å…äº¤æ¢å¾‹é”™è¯¯ã€‚ |

---

## 5. ç®—æ³•å¯è§†åŒ–ï¼šåƒç´ åŠ¨ç”»æ¼”ç¤º

### ğŸ® åŠ¨ç”»ä¸»é¢˜ï¼š**â€œåƒç´ æ¢é™©å®¶Â·çŸ©é˜µé“¾ä¹‹æ—…â€**

- **åœºæ™¯**ï¼š8-bit æ£®æ—ï¼Œæ¯æ£µæ ‘æ˜¯ä¸€æ¡é‡é“¾ï¼Œé“¾ä¸ŠèŠ‚ç‚¹æ˜¯åƒç´ å®ç®±ã€‚
- **è§’è‰²**ï¼šæ¢é™©å®¶ï¼ˆçº¢è‰²åƒç´ å°äººï¼‰æºå¸¦ 2Ã—2 çŸ©é˜µå·è½´ã€‚
- **äº¤äº’**ï¼š
  1. ç‚¹å‡»â€œä¿®æ”¹èŠ‚ç‚¹â€ â†’ å®ç®±é—ªçƒï¼Œå¼¹å‡ºæƒå€¼ä¿®æ”¹ç•Œé¢ã€‚
  2. æ¢é™©å®¶ä»å®ç®±å‡ºå‘ï¼Œ**æ²¿é‡é“¾å‘ä¸Šè·³**ï¼Œæ¯è·³ä¸€å±‚ï¼š
     - æ’­æ”¾â€œå®â€éŸ³æ•ˆï¼Œå·è½´ï¼ˆçŸ©é˜µï¼‰æ›´æ–°æ•°å€¼ã€‚
     - çº¿æ®µæ ‘åŒºé—´é«˜äº®ï¼ˆåƒç´ æ–¹å—å˜è‰²ï¼‰ã€‚
  3. åˆ°è¾¾æ ¹èŠ‚ç‚¹åï¼Œ**åƒç´ ç‹å† **æ˜¾ç¤ºæœ€æ–°æœ€å¤§ç‹¬ç«‹é›†å€¼ã€‚
- **æ§åˆ¶é¢æ¿**ï¼š
  - æ­¥è¿› / è‡ªåŠ¨ / å€é€Ÿæ»‘å—ã€‚
  - éŸ³æ•ˆå¼€å…³ï¼ˆ8-bit ç»å…¸â€œcoinâ€éŸ³ï¼‰ã€‚
- **æ¸¸æˆåŒ–**ï¼š
  - æ¯æˆåŠŸæ›´æ–°ä¸€æ¡é‡é“¾ï¼Œå¾— 1 é¢—æ˜Ÿæ˜Ÿã€‚
  - æ˜Ÿæ˜Ÿå¯ç”¨äºè§£é”â€œLCT æ¨¡å¼â€éšè—å…³å¡ã€‚

---

## 6. æ‹“å±•ç»ƒä¹ ä¸ç›¸ä¼¼é—®é¢˜æ€è€ƒ

### ğŸ§© é€šç”¨æŠ€å·§è¿ç§»
1. **é“¾å¼ DP è½¬åºåˆ—**ï¼šæŠŠæ ‘ä¸Šè·¯å¾„æ‹†æˆåºåˆ—åï¼Œå¯ç”¨çº¿æ®µæ ‘ / å¹³è¡¡æ ‘ç»´æŠ¤ã€‚
2. **çŸ©é˜µä¹˜æ³•é‡å®šä¹‰**ï¼šä»»ä½•æ»¡è¶³â€œåŠ â†’maxã€ä¹˜â†’åŠ â€çš„åŠç¯ï¼Œéƒ½å¯ç”¨çŸ©é˜µå¿«é€Ÿå¹‚æˆ–åŒºé—´ç§¯ã€‚
3. **è½»é‡é“¾æ€æƒ³**ï¼šä¸ä»… DPï¼Œä¹Ÿå¯ç”¨äº**æ ‘ä¸Šè·¯å¾„æŸ¥è¯¢**ï¼ˆå¦‚ LCAã€è·¯å¾„å’Œï¼‰ã€‚

### ğŸ† æ´›è°·æ¨è

| é¢˜å· | æ¨èç†ç”± |
|---|---|
| **P1352** æ²¡æœ‰ä¸Šå¸çš„èˆä¼š | é™æ€æœ€å¤§ç‹¬ç«‹é›†æ¨¡æ¿ï¼Œå…ˆæŒæ¡åŸºç¡€æ ‘å½¢ DPã€‚ |
| **P4751** åŠ¨æ€ DP åŠ å¼ºç‰ˆ | å¼ºåˆ¶é“¾å¼æ•°æ®ï¼Œæš´åŠ›ä¼š Tï¼Œå¿…é¡»ç”¨æ­£è§£ã€‚ |
| **P3384** æ ‘é“¾å‰–åˆ†æ¨¡æ¿ | ç†Ÿæ‚‰ HLD + çº¿æ®µæ ‘ï¼Œä¸ºåŠ¨æ€ DP é“ºå«ã€‚ |
| **P3690** Link-Cut Tree æ¨¡æ¿ | æŒæ¡ LCT çš„ access / splay / makerootã€‚ |

---

## 7. å­¦ä¹ å¿ƒå¾—ä¸ç»éªŒåˆ†äº«

> **Tweetuzki çš„è°ƒè¯•å¿ƒå¾—**ï¼šâ€œæˆ‘åœ¨ç¬¬ä¸€æ¬¡å†™è½¬ç§»çŸ©é˜µæ—¶æŠŠå³ä¸‹è§’å†™æˆ 0ï¼Œç»“æœæ ·ä¾‹è¾“å‡º 2147483647ã€‚åæ¥æ‰å‘ç°åº”è¯¥æ˜¯ -âˆï¼Œå¦åˆ™ max ä¼šå–åˆ°é”™è¯¯åˆ†æ”¯ã€‚â€  
> **æ´›è¯­äº‘ç¬ºç‚¹è¯„**ï¼šè¾¹ç•Œå€¼ï¼ˆ-INFï¼‰æ˜¯åŠ¨æ€ DP çš„éšå½¢æ€æ‰‹ï¼ŒåŠ¡å¿…ç”¨ `0xCF` è€Œé `0x3F`ï¼Œé˜²æ­¢æº¢å‡ºã€‚

---

<conclusion>
æ­å–œä½ ï¼Œå·²ç»å®Œæˆäº†ã€ŒåŠ¨æ€ DPã€çš„æ·±åº¦æ¢é™©ï¼  
è®°ä½ï¼š  
- **æš´åŠ›æ˜¯æ€è€ƒçš„èµ·ç‚¹**ï¼Œè€Œéç»ˆç‚¹ï¼›  
- **æ•°æ®ç»“æ„çš„ä¼˜é›…ç»„åˆ**ï¼Œèƒ½è®© O(n) ç¬é—´å˜ O(log)ï¼›  
- **å¯è§†åŒ–ä¸æ¸¸æˆåŒ–**ï¼Œæ˜¯ç†è§£æŠ½è±¡ç®—æ³•çš„ä¸€æŠŠé’¥åŒ™ã€‚  

ä¸‹ä¸€æ¬¡ï¼Œæˆ‘ä»¬å†æŒ‘æˆ˜æ›´ç‚«é…·çš„ç®—æ³•ï¼ğŸ’ª
</conclusion>

---
å¤„ç†ç”¨æ—¶ï¼š149.18ç§’
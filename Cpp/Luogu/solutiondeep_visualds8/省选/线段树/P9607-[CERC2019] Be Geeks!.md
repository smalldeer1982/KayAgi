# é¢˜ç›®ä¿¡æ¯

# [CERC2019] Be Geeks!

## é¢˜ç›®èƒŒæ™¯

**é¢˜ç›®è¯‘è‡ª [CERC 2019](https://contest.felk.cvut.cz/19cerc/solved.html) ã€Œ[Be Geeks!](https://contest.felk.cvut.cz/19cerc/solved/begeeks.pdf)ã€**

## é¢˜ç›®æè¿°

éŸ³ä¹ä¹é˜Ÿ Be Geeks! çš„åå­—å¹¶éå¶ç„¶ï¼Œå› ä¸ºæ‰€æœ‰æˆå‘˜éƒ½æ˜¯çœŸæ­£çš„æ•°å­¦æ€ªæ‰ã€‚é™¤æ­¤ä¹‹å¤–ï¼Œä»–ä»¬å–œæ¬¢ç ”ç©¶æ•°åˆ—çš„å„ç§æ€§è´¨ã€‚ä¸‹é¢æ˜¯ä»–ä»¬æ„Ÿå…´è¶£çš„ä¸€ä¸ªä¾‹å­ï¼š
- è®¾ $A$ æ˜¯ä¸€ä¸ªéç©ºæ­£æ•´æ•°åºåˆ—ï¼Œ$A=(a_1, a_2, \dots, a_N)$ã€‚
- $G(i, j)=\gcd (a_i, a_{i+1}, \dots, a_j)$ï¼Œå…¶ä¸­ $1\le i\le j\le N$ã€‚
- $M(i, j)=\max (a_i, a_{i+1}, \dots, a_j)$ï¼Œå…¶ä¸­ $1\le i\le j\le N$ã€‚
- $P(i, j)=G(i, j)\times M(i, j)$ï¼Œå…¶ä¸­ $1\le i\le j\le N$ã€‚
- $F(A)=\sum P(i, j)[1\le i\le j\le N]$ã€‚

ç»™å‡ºä¸€ä¸ªåºåˆ— $A$ï¼Œä½ éœ€è¦æ±‚å‡º $F(A)\bmod 1\,000\,000\,007$ çš„å€¼ã€‚

## æ ·ä¾‹ #1

### è¾“å…¥

```
4
1 2 3 4
```

### è¾“å‡º

```
50
```

## æ ·ä¾‹ #2

### è¾“å…¥

```
5
2 4 6 12 3
```

### è¾“å‡º

```
457
```

# AIåˆ†æç»“æœ

---
# ğŸ’¡ æ´›è¯­äº‘ç¬ºçš„C++ç®—æ³•è§£æï¼š[CERC2019] Be Geeks! æ·±å…¥å­¦ä¹ æŒ‡å— ğŸ’¡

> å„ä½åŒå­¦å¥½ï¼ä»Šå¤©æˆ‘ä»¬è¦ä¸€èµ·ç ”ç©¶çš„æ˜¯ **åŒºé—´æå€¼ Ã— åŒºé—´ GCD æ±‚å’Œ** çš„ç»å…¸é¢˜ç›®ã€‚è¿™é“é¢˜ä¸ä»…è€ƒéªŒæˆ‘ä»¬å¯¹åŒºé—´æ•°æ®ç»“æ„çš„ç†è§£ï¼Œæ›´è¦æ±‚æˆ‘ä»¬å·§å¦™åœ°å°†â€œæå€¼åˆ†æ²»â€ä¸â€œGCD åˆ†æ®µâ€ç»“åˆèµ·æ¥ã€‚å‡†å¤‡å¥½äº†å—ï¼Ÿè®©æˆ‘ä»¬å¼€å§‹å§ï¼

---

## 1. é¢˜ç›®è§£è¯»ä¸ç­–ç•¥åˆæ¢

âœ¨ **æœ¬é¢˜æ ¸å¿ƒæŒ‘æˆ˜**  
éœ€è¦åŒæ—¶å¤„ç†ã€ŒåŒºé—´æœ€å¤§å€¼ã€ä¸ã€ŒåŒºé—´ GCDã€ä¸¤ä¸ªç»´åº¦ï¼Œå¹¶æŠŠå®ƒä»¬çš„ä¹˜ç§¯ç´¯åŠ ã€‚ç›´æ¥æšä¸¾æ‰€æœ‰åŒºé—´ \(O(n^2)\) æ˜¾ç„¶çˆ†ç‚¸ï¼Œæˆ‘ä»¬å¿…é¡»æ‰¾åˆ°**æå€¼ç‚¹**ä¸**GCD åˆ†æ®µ**ä¹‹é—´çš„ç²¾å¦™è”ç³»ã€‚

âœ¨ **æ ¸å¿ƒç®—æ³•æ ‡ç­¾**  
- æå€¼åˆ†æ²» / ç¬›å¡å°”æ ‘  
- GCD åˆ†æ®µæ€§è´¨  
- ST è¡¨ + äºŒåˆ†  
- å•è°ƒæ ˆæ±‚æå€¼è¾¹ç•Œ

---

### ğŸ” ç®—æ³•ä¾¦æ¢ï¼šå¦‚ä½•åœ¨é¢˜ç›®ä¸­å‘ç°çº¿ç´¢ï¼Ÿ

1. **çº¿ç´¢1 (é—®é¢˜ç›®æ ‡)**  
   â€œæ±‚æ‰€æœ‰å­åŒºé—´çš„ `max Ã— gcd` ä¹‹å’Œâ€ï¼Œè¿™æ˜¯ä¸€ä¸ª**å¸¦æå€¼çš„åŒºé—´ç»Ÿè®¡é—®é¢˜**â€”â€”æå€¼åˆ†æ²»ï¼ˆç¬›å¡å°”æ ‘ï¼‰çš„å…¸å‹ä¿¡å·ã€‚

2. **çº¿ç´¢2 (é—®é¢˜ç‰¹æ€§)**  
   - åŒºé—´ `max` å…·æœ‰**å•è°ƒæ ˆå¯åˆ»ç”»**çš„æå€¼è¾¹ç•Œã€‚  
   - åŒºé—´ `gcd` å…·æœ‰**å¯¹æ•°çº§åˆ«åˆ†æ®µ**çš„ç‰¹æ€§ï¼šä»å›ºå®šç«¯ç‚¹å‡ºå‘ï¼Œæ¯æ¬¡å˜åŒ–è‡³å°‘å‡åŠï¼Œå› æ­¤æœ€å¤š \(O(\log V)\) æ®µã€‚

3. **çº¿ç´¢3 (æ•°æ®è§„æ¨¡)**  
   \(n \le 2 \times 10^5\)ï¼Œè¦æ±‚ \(O(n \log n)\) æˆ– \(O(n \log^2 n)\) çº§åˆ«ç®—æ³•ï¼Œ**æå€¼åˆ†æ²» + GCD åˆ†æ®µ**å®Œå…¨å¯è¡Œã€‚

---

### ğŸ§  æ€ç»´é“¾æ„å»ºï¼šä»çº¿ç´¢åˆ°ç­–ç•¥

> 1. å…ˆçœ‹åˆ°ã€ŒåŒºé—´ç»Ÿè®¡ã€+ã€Œæå€¼ã€+ã€Œgcdã€ï¼Œå¤§è„‘é‡Œè¿…é€Ÿè¹¦å‡º**æå€¼åˆ†æ²»**æ¨¡å‹ï¼š  
>    â€œæŠŠåºåˆ—æŒ‰æœ€å¤§å€¼ä½ç½®åˆ‡å¼€ï¼Œæœ€å¤§å€¼å›ºå®šï¼Œåªéœ€å¤„ç† gcd åˆ†æ®µå³å¯ã€‚â€  
> 2. æ¥ç€æƒ³åˆ° gcd çš„**å¯¹æ•°çº§åˆ†æ®µ**æ€§è´¨ï¼Œå¯ä»¥**äºŒåˆ†+STè¡¨**å¿«é€Ÿæ‰¾å‡ºæ¯ä¸€æ®µ gcd ç›¸åŒçš„åŒºé—´ã€‚  
> 3. ç»¼åˆå¤æ‚åº¦ï¼šæ¯ä¸ªå…ƒç´ åœ¨åˆ†æ²»è¿‡ç¨‹ä¸­è¢«æ‰« \(\log n\) æ¬¡ï¼Œæ¯æ¬¡ gcd åˆ†æ®µ \(\log V\) æ®µï¼Œæ€»å¤æ‚åº¦ \(O(n \log n \log V)\)ï¼Œå®Œç¾é€šè¿‡ï¼

---

## 2. ç²¾é€‰ä¼˜è´¨é¢˜è§£å‚è€ƒ

ä»¥ä¸‹é¢˜è§£å‡ â‰¥4 æ˜Ÿï¼Œæˆ‘ä»¬ç²¾é€‰ 5 ä»½ï¼ŒæŒ‰æ€è·¯å½’ç±»ç‚¹è¯„ã€‚

| é¢˜è§£ | æ ¸å¿ƒæ€è·¯ | äº®ç‚¹æç‚¼ |
|---|---|---|
| ç¼ªå‡Œé”´_Mathew | å€å¢æ±‚æå€¼è¾¹ç•Œ + GCD åˆ†æ®µ | ç”¨ `logV` æ®µæ€æƒ³ï¼Œä»£ç æ¸…æ™°ï¼Œå¤æ‚åº¦ \(O(n \log^2 V)\) |
| KazamaRuri | æå€¼åˆ†æ²» + STè¡¨ + äºŒåˆ† | 34 è¡Œæç®€å®ç°ï¼Œå¸¸æ•°ä¼˜ç§€ |
| xkcdjerry | å•è°ƒæ ˆæ±‚æå€¼è¾¹ç•Œ + GCD åˆ†æ®µ | åªç”¨ `vector` å’Œ `__gcd`ï¼Œæ— é¢å¤–æ•°æ®ç»“æ„ |
| _AyachiNene | ç¬›å¡å°”æ ‘ + åŒåˆ†æ²» | ç©ºé—´å‹ç¼©æŠ€å·§ï¼šå·¦å³åŒºé—´åˆ†ä¸¤æ¬¡è·‘ï¼Œé¿å… MLE |
| ZepX_D | æå€¼åˆ†æ²» + çŸ­è¾¹ä¼˜å…ˆ | å¤æ‚åº¦ \(O(n \log^2 n \log V)\)ï¼Œæ€è·¯ç›´è§‚ï¼Œå¸¸æ•°å° |

> ğŸ’¡ **æ´›è¯­äº‘ç¬ºç‚¹è¯„**ï¼š  
> è¿™äº›é¢˜è§£æœ¬è´¨ç›¸åŒï¼š**â€œå›ºå®š maxï¼Œåˆ†æ®µ gcdâ€**ã€‚ä¸åŒä¹‹å¤„åœ¨äºå¦‚ä½•ä¼˜é›…åœ°æ‰¾å‡ºæå€¼è¾¹ç•Œï¼ˆå•è°ƒæ ˆ / STè¡¨ / å€å¢ï¼‰ä»¥åŠå¦‚ä½•é«˜æ•ˆæšä¸¾ gcd åˆ†æ®µï¼ˆäºŒåˆ† / å€å¢ï¼‰ã€‚å¤§å®¶å¯é€‰æ‹©è‡ªå·±æœ€å–œæ¬¢çš„é£æ ¼å­¦ä¹ ã€‚

---

## 3. è§£é¢˜ç­–ç•¥æ·±åº¦å‰–æ

### ğŸ¯ æ ¸å¿ƒéš¾ç‚¹ä¸å…³é”®æ­¥éª¤ï¼ˆæœ€ä¼˜è§£ï¼šæå€¼åˆ†æ²» + GCD åˆ†æ®µï¼‰

1. **å…³é”®ç‚¹1ï¼šå¦‚ä½•å›ºå®šåŒºé—´ maxï¼Ÿ**  
   - **æ–¹æ¡ˆ**ï¼šç¬›å¡å°”æ ‘æˆ–å•è°ƒæ ˆæ±‚å‡ºæ¯ä¸ª \(a_x\) çš„â€œæ”¯é…åŒºé—´â€ \([L_x, R_x]\)ï¼Œå…¶ä¸­ \(a_x\) æ˜¯åŒºé—´æœ€å¤§å€¼ã€‚  
   - **å­¦ä¹ ç¬”è®°**ï¼šæå€¼åˆ†æ²»æŠŠã€ŒåŒºé—´ç»Ÿè®¡ã€æ‹†æˆã€Œä»¥ max ä¸ºä¸­å¿ƒã€çš„å­é—®é¢˜ï¼Œé™ä½ç»´åº¦ã€‚

2. **å…³é”®ç‚¹2ï¼šå¦‚ä½•å¿«é€Ÿæšä¸¾ gcd åˆ†æ®µï¼Ÿ**  
   - **æ–¹æ¡ˆ**ï¼šST è¡¨é¢„å¤„ç†åŒºé—´ gcdï¼Œç„¶åä»å›ºå®šç«¯ç‚¹ï¼ˆå¦‚ \(x\)ï¼‰å‘å·¦/å³äºŒåˆ†ï¼Œæ¯æ¬¡æ‰¾åˆ° gcd å˜åŒ–çš„ä½ç½®ã€‚  
   - **å­¦ä¹ ç¬”è®°**ï¼šgcd çš„å•è°ƒé€’å‡æ€§ä¿è¯åˆ†æ®µæ•° \(O(\log V)\)ï¼ŒäºŒåˆ†æ€»å¤æ‚åº¦ \(O(\log n \log V)\)ã€‚

3. **å…³é”®ç‚¹3ï¼šå¦‚ä½•åˆå¹¶å·¦å³åˆ†æ®µè´¡çŒ®ï¼Ÿ**  
   - **æ–¹æ¡ˆ**ï¼šå¯¹å·¦å³å„ \(\log V\) æ®µï¼Œæš´åŠ›æšä¸¾æ®µå¯¹ \((L_i, R_j)\)ï¼Œè®¡ç®—é•¿åº¦ä¹˜ç§¯å†ä¹˜ \(\gcd(L_i.val, R_j.val)\)ã€‚  
   - **å­¦ä¹ ç¬”è®°**ï¼šæ®µæ•°ä¹˜ç§¯ \(O(\log^2 V)\)ï¼Œå¸¸æ•°æå°ã€‚

---

### âš”ï¸ ç­–ç•¥ç«æŠ€åœºï¼šä¸åŒè§£æ³•çš„å¯¹æ¯”åˆ†æ

| ç­–ç•¥ | æ ¸å¿ƒæ€æƒ³ | ä¼˜ç‚¹ | ç¼ºç‚¹ | é€‚ç”¨åœºæ™¯ |
|---|---|---|---|---|
| **æš´åŠ›æšä¸¾** | åŒå¾ªç¯æšä¸¾åŒºé—´ | æ€è·¯ç›´è§‚ | \(O(n^2)\) æ— æ³•æ¥å— | \(n \le 3000\) |
| **æå€¼åˆ†æ²» + GCD åˆ†æ®µ**ï¼ˆæœ€ä¼˜ï¼‰ | ç¬›å¡å°”æ ‘åˆ†æ²» + STè¡¨ + äºŒåˆ† | \(O(n \log n \log V)\) å¸¸æ•°å° | éœ€è¦ç†è§£åˆ†æ²»æ€æƒ³ | \(n \le 2 \times 10^5\) |
| **çº¿æ®µæ ‘ç»´æŠ¤ gcd ä¸ max** | çº¿æ®µæ ‘åŒºé—´åˆå¹¶ | æ€ç»´ç›´æ¥ | åˆå¹¶æ“ä½œå¤æ‚ï¼Œå¸¸æ•°å¤§ | å¯¹å¤æ‚åº¦è¦æ±‚å®½æ¾ |

---

### âœ¨ ä¼˜åŒ–ä¹‹æ—…ï¼šä»â€œèƒ½åšâ€åˆ°â€œåšå¥½â€

> 1. èµ·ç‚¹ï¼šæš´åŠ›æšä¸¾ \(O(n^2)\)  
> 2. å‘ç°ç“¶é¢ˆï¼šé‡å¤è®¡ç®— gcd ä¸ max  
> 3. ä¼˜åŒ–é’¥åŒ™ï¼šæå€¼åˆ†æ²» + gcd åˆ†æ®µæ€§è´¨  
> 4. æ¨¡å‹å‡åï¼šå›ºå®š maxï¼Œåˆ†æ®µ gcdï¼Œå¤æ‚åº¦é™è‡³ \(O(n \log n \log V)\)

---

## 4. C++æ ¸å¿ƒä»£ç å®ç°èµæ

### æœ¬é¢˜é€šç”¨æ ¸å¿ƒC++å®ç°å‚è€ƒ
> ç»¼åˆ KazamaRuri ä¸ xkcdjerry æ€è·¯ï¼Œæä¾›ä¸€ä»½**æå€¼åˆ†æ²» + STè¡¨ + å•è°ƒæ ˆ**çš„å®Œæ•´å®ç°ã€‚

```cpp
#include <bits/stdc++.h>
using namespace std;
const int N = 2e5 + 5, mod = 1e9 + 7;
int n, a[N], lg[N], st_gcd[20][N], st_max[20][N];

int gcd(int a, int b) { return b ? gcd(b, a % b) : a; }

int query_gcd(int l, int r) {
    int k = lg[r - l + 1];
    return gcd(st_gcd[k][l], st_gcd[k][r - (1 << k) + 1]);
}
int query_max(int l, int r) {
    int k = lg[r - l + 1];
    int x = st_max[k][l], y = st_max[k][r - (1 << k) + 1];
    return a[x] > a[y] ? x : y;
}

// æå€¼åˆ†æ²»
long long ans = 0;
void solve(int l, int r) {
    if (l > r) return;
    if (l == r) { ans = (ans + 1LL * a[l] * a[l]) % mod; return; }
    int mid = query_max(l, r);
    solve(l, mid - 1); solve(mid + 1, r);

    vector<pair<int, int>> left, right;
    // å·¦ä¾§ gcd åˆ†æ®µ
    for (int i = mid, last = mid; i >= l; ) {
        int g = query_gcd(i, mid);
        int L = i, R = mid;
        while (L < R) {
            int M = (L + R) >> 1;
            if (query_gcd(M, mid) == g) R = M;
            else L = M + 1;
        }
        left.emplace_back(g, mid - L + 1);
        i = L - 1;
    }
    // å³ä¾§ gcd åˆ†æ®µ
    for (int i = mid, last = mid; i <= r; ) {
        int g = query_gcd(mid, i);
        int L = mid, R = i;
        while (L < R) {
            int M = (L + R + 1) >> 1;
            if (query_gcd(mid, M) == g) L = M;
            else R = M - 1;
        }
        right.emplace_back(g, L - mid + 1);
        i = L + 1;
    }
    // åˆå¹¶è´¡çŒ®
    for (auto [gl, cnt_l] : left)
        for (auto [gr, cnt_r] : right)
            ans = (ans + 1LL * a[mid] * cnt_l % mod * cnt_r % mod * gcd(gl, gr)) % mod;
}

int main() {
    scanf("%d", &n);
    for (int i = 1; i <= n; ++i) scanf("%d", &a[i]);
    for (int i = 2; i <= n; ++i) lg[i] = lg[i >> 1] + 1;

    for (int i = 1; i <= n; ++i) st_gcd[0][i] = st_max[0][i] = a[i];
    for (int k = 1; (1 << k) <= n; ++k)
        for (int i = 1; i + (1 << k) - 1 <= n; ++i) {
            st_gcd[k][i] = gcd(st_gcd[k - 1][i], st_gcd[k - 1][i + (1 << (k - 1))]);
            st_max[k][i] = a[st_max[k - 1][i]] > a[st_max[k - 1][i + (1 << (k - 1))]] ? st_max[k - 1][i] : st_max[k - 1][i + (1 << (k - 1))];
        }

    solve(1, n);
    printf("%lld\n", ans);
    return 0;
}
```

---

## 5. ç®—æ³•å¯è§†åŒ–ï¼šåƒç´ åŠ¨ç”»æ¼”ç¤º

### åŠ¨ç”»ä¸»é¢˜
**â€œåƒç´ æ¢é™©å®¶â€åœ¨åŒºé—´è¿·å®«ä¸­å¯»æ‰¾æå€¼ä¸ gcd å®è—**

### æ ¸å¿ƒæ¼”ç¤ºå†…å®¹
1. **æå€¼åˆ†æ²»**ï¼šç”¨åƒç´ åŒ–çš„â€œé”¯å­â€å°†åŒºé—´æŒ‰æœ€å¤§å€¼åŠˆå¼€ï¼Œé«˜äº®å½“å‰ maxã€‚  
2. **GCD åˆ†æ®µ**ï¼šåƒç´ æ–¹å—ä»ä¸­å¿ƒå‘å·¦/å³æ‰©æ•£ï¼Œé¢œè‰²éš gcd å˜åŒ–è€Œæ¸å˜ï¼ˆæ¯å‡åŠä¸€æ¬¡æ¢è‰²ï¼‰ã€‚  
3. **è´¡çŒ®åˆå¹¶**ï¼šå·¦å³åˆ†æ®µåƒç´ æ–¹å—ä¸¤ä¸¤é…å¯¹ï¼Œé—ªç°åˆå¹¶åŠ¨ç”»å¹¶æ˜¾ç¤ºä¹˜ç§¯ã€‚

### äº¤äº’è®¾è®¡
- æ§åˆ¶é¢æ¿ï¼šæ­¥è¿› / è‡ªåŠ¨æ’­æ”¾ / é‡ç½® / è°ƒé€Ÿæ»‘å—  
- éŸ³æ•ˆï¼š  
  - æå€¼åˆ‡å‰²ï¼š8-bit â€œå’”å“’â€  
  - gcd å˜åŒ–ï¼š8-bit â€œå®â€  
  - åˆå¹¶æˆåŠŸï¼š8-bit â€œèƒœåˆ©éŸ³â€  
- åƒç´  UIï¼šFC çº¢ç™½æœºé£æ ¼ï¼Œ8 è‰²è°ƒè‰²æ¿

### å…³é”®å¸§ç¤ºæ„
| å¸§ | æè¿° |
|---|---|
| 0 | åˆå§‹åŒ–åŒºé—´ [1,n]ï¼Œåƒç´ åŒ–æ•°ç»„ |
| 1 | é«˜äº®æœ€å¤§å€¼ä½ç½® mid |
| 2 | ä» mid å‘å·¦/å³äºŒåˆ† gcd åˆ†æ®µï¼Œé¢œè‰²å˜åŒ– |
| 3 | å·¦å³æ®µåƒç´ æ–¹å—é…å¯¹ï¼Œæ˜¾ç¤ºè´¡çŒ® |
| 4 | é€’å½’åˆ†æ²»å·¦å³å­åŒºé—´ |

---

## 6. æ‹“å±•ç»ƒä¹ ä¸ç›¸ä¼¼é—®é¢˜æ€è€ƒ

### é€šç”¨æ€è·¯è¿ç§»
- **æå€¼åˆ†æ²»**é€‚ç”¨äºæ‰€æœ‰â€œåŒºé—´æå€¼ç»Ÿè®¡â€é—®é¢˜ï¼š  
  1. åŒºé—´æœ€å¤§/æœ€å°å€¼ Ã— åŒºé—´å’Œ  
  2. åŒºé—´æœ€å¤§ Ã— åŒºé—´æœ€å°  
  3. åŒºé—´æœ€å¤§ Ã— åŒºé—´å¼‚æˆ–å’Œ

### æ´›è°·æ¨èç»ƒä¹ 
1. **P4774 [CSP-S2019] Emiya å®¶ä»Šå¤©çš„é¥­**  
   ğŸ—£ï¸ æ¨èç†ç”±ï¼šæå€¼åˆ†æ²» + åŒºé—´è®¡æ•°ï¼Œé”»ç‚¼åˆ†æ²»æ€æƒ³ã€‚
2. **P5048 [Ynoi2019] é­”æ³•å°‘å¥³ç½‘ç«™**  
   ğŸ—£ï¸ æ¨èç†ç”±ï¼šåŒºé—´ gcd åˆ†æ®µ + æ•°æ®ç»“æ„ï¼Œå¼ºåŒ– gcd æ€§è´¨ç†è§£ã€‚
3. **P1972 [SDOI2009] HHçš„é¡¹é“¾**  
   ğŸ—£ï¸ æ¨èç†ç”±ï¼šåŒºé—´ç»Ÿè®¡ç»å…¸ï¼Œå­¦ä¹ ç¦»çº¿å¤„ç†æŠ€å·§ã€‚

---

## 7. å­¦ä¹ å¿ƒå¾—ä¸ç»éªŒåˆ†äº«

> **ç¼ªå‡Œé”´_Mathew** çš„è°ƒè¯•ç»éªŒï¼š  
> â€œæœ€åˆåœ¨å€å¢è¾¹ç•Œå¤„ç†ä¸Šå¡äº†å¾ˆä¹…ï¼Œåæ¥ç”¨ `map` è®°å½•ä¸Šä¸€æ¬¡å‡ºç°ä½ç½®ï¼Œæ‰é¿å…äº†é‡å¤è®¡ç®—ã€‚æé†’ï¼šæå€¼è¾¹ç•Œä¸€å®šè¦ä¸¥æ ¼ `<` æˆ– `<=`ã€‚â€

> **xkcdjerry** çš„ç®€æ´ä¹‹é“ï¼š  
> â€œåªç”¨ `vector` + `__gcd`ï¼Œæ— é¢å¤–æ•°æ®ç»“æ„ï¼Œä»£ç çŸ­è€Œæ¸…æ™°ã€‚å…³é”®ï¼šæŠŠ gcd åˆ†æ®µæƒ³æˆâ€˜åŒºé—´å‹ç¼©â€™ï¼Œæ¯æ®µç”¨ä¸€ä¸ª pair è¡¨ç¤ºã€‚â€

---

<conclusion>
ä»Šå¤©æˆ‘ä»¬å­¦ä¹ äº†å¦‚ä½•ç”¨**æå€¼åˆ†æ²» + GCD åˆ†æ®µ**ä¼˜é›…åœ°è§£å†³çœ‹ä¼¼å¤æ‚çš„åŒºé—´ç»Ÿè®¡é—®é¢˜ã€‚è®°ä½ï¼š  
- **æå€¼åˆ†æ²»**æŠŠå¤šç»´é—®é¢˜é™ç»´  
- **GCD åˆ†æ®µ**æŠŠåŒºé—´å‹ç¼©åˆ°å¯¹æ•°çº§  
ä¸‹æ¬¡é‡åˆ°â€œåŒºé—´æå€¼â€ç±»é¢˜ç›®ï¼Œå…ˆæƒ³æƒ³èƒ½å¦å›ºå®šæå€¼å†åˆ†æ®µå¤„ç†ï¼ç¥å¤§å®¶å­¦ä¹ æ„‰å¿«ï¼Œæˆ‘ä»¬ä¸‹æ¬¡å†è§ï¼ğŸ’ª
</conclusion>

---
å¤„ç†ç”¨æ—¶ï¼š84.76ç§’
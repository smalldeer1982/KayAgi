---
title: "「HCOI-R2」Rabbit Panic (Hard Ver.)"
layout: "post"
diff: NOI/NOI+/CTSC
pid: P12356
tag: ['洛谷原创', 'Special Judge', 'O2优化', '其它技巧', '构造', '洛谷月赛', 'Ad-hoc']
---
# 「HCOI-R2」Rabbit Panic (Hard Ver.)
## 题目背景

**注意在问题的这个版本中，你需要解决和 Easy Ver. 一样的问题，但是需要最小化步数。**
## 题目描述

你有一个长度为 $n$ 的排列 $\{p_n\}$，初始 $p_i = i$。每次你可以选择 $m$ 个**不同**位置的元素，并**同时**将它们改成它们的平均值（不取整）。

最后你需要使所有元素都相等。

请你构造一组操作方案，并最小化你的操作数量。无解输出 $-1$。
## 输入格式

**本题单测试数据内含有多组输入。**

第一行一个正整数 $K$ 表示数据组数。

接下来每组测试数据包含两个正整数 $n$、$m$，含义如题面所述。
## 输出格式

对于每组测试数据，你可以：

- 输出一行 $-1$ 报告无解。
- 输出一行 $P$ 表示你的操作次数，注意这个次数必须最小化。接下来的 $P$ 行，每行 $m$ 个数，表示你的操作，用空格分开。
## 样例

### 样例输入 #1
```
1
6 4
```
### 样例输出 #1
```
2
1 2 5 6
2 3 4 5
```
## 提示

### 样例解释 1

- $[1,2,3,4,5,6]\to [3.5,3.5,3,4,3.5,3.5]\to [3.5,3.5,3.5,3.5,3.5,3.5]$。
- 可以证明不存在更优的方案。

### 数据范围

**本题采用捆绑测试。**

- Subtask 0 (15pts)：$1\leq \sum n\leq 10$。
- Subtask 1 (15pts)：$1\leq \sum n\leq 10^3$。
- Subtask 2 (70pts)：无特殊限制。

对于所有数据，$1 \leq T \leq 1.2\times 10^4$，$1 \leq m \leq n \leq 2\times 10^5$，$1 \leq \sum n \leq 10^6$。

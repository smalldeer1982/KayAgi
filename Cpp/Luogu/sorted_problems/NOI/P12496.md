---
title: "[集训队互测 2024] 又一个欧拉数问题"
layout: "post"
diff: NOI/NOI+/CTSC
pid: P12496
tag: ['集训队互测', '2024', '多项式', 'O2优化', '快速数论变换 NTT']
---
# [集训队互测 2024] 又一个欧拉数问题
## 题目描述

给定 $k$ 以及系数序列 $w_0 \sim w_{2^{k-1}-1}$。


定义一个 $n \ge k$ 阶排列 $p$ 的权值 $val(p)=\prod\limits_{i=1}^{n-k+1} w_{f(p_i,p_{i+1}...p_{i+k-1})}$，其中 $f(a_1,a_2...a_k)=\sum\limits_{i=1}^{k-1}2^{i-1}[a_i<a_{i+1}]$。

给定 $n$，计算所有 $n$ 阶排列的权值和，答案对 $998244353$ 取模。
## 输入格式

第一行两个整数 $n,k$。

第二行 $2^{k-1}$ 个整数，第 $i$ 个整数表示 $w_{i-1}$。
## 输出格式

一行一个整数，表示答案 $\bmod\ 998244353$。
## 样例

### 样例输入 #1
```
3 2
1 2
```
### 样例输出 #1
```
13
```
### 样例输入 #2
```
5 3
1 2 3 4
```
### 样例输出 #2
```
1875
```
### 样例输入 #3
```
6 4
1 2 3 4 5 6 7 8
```
### 样例输出 #3
```
68850
```
## 提示

本题使用捆绑测试，你只有通过一个子任务的所有测试点，才能获得这个子任务的分数。

| Subtask | $n \le$ | $k=$ | 分值 |
| :-----: | :-----: |  :-----: | :--: |
|   $1$   |   $10$   |  $4$ | $5$  |
|   $2$   |  $20$   |  $4$ | $10$ |
|   $3$   |  $10^5$  |   $2$ | $5$ |
|   $4$   |  $100$  | $3$ | $10$ |
|   $5$   | $4000$  | $3$ | $10$ |
|   $6$   | $4 \times 10^4$  | $3$ | $15$ |
|   $7$   | $10^5$  |  $3$ | $5$ |
|   $8$   | $2000$  |   $4$ | $10$ |
|   $9$   | $4 \times 10^4$  |  $4$ |  $10$ |
|   $10$   | $10^5$  |  $4$ | $20$ |

对于所有数据：$2 \le k \le 4$，$k \le n \le 10^5$，$0 \le w_i < 998244353$。

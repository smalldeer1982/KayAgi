---
title: "[CCPC 2024 重庆站] 魔弹"
layout: "post"
diff: NOI/NOI+/CTSC
pid: P13574
tag: ['重庆', '2024', 'XCPC']
---
# [CCPC 2024 重庆站] 魔弹
## 题目背景

本题目来自仓库 <https://github.com/Disposrestfully/CCPC-CQ-2024/tree/main>
## 题目描述

Menji 在玩一款休闲养成游戏。

在这个游戏中，有 $n$ 名员工，依次站在数轴的 $1,2,3, \dots, n$ 处，第 $i$ 名员工有一个面向的方向 $d_i$，为向左或向右。

每名员工手里有一把名为魔弹的武器，玩家会按照一个排列 $p$ 的顺序行动，当轮到玩家 $x$ 行动时：

- 若该员工已经倒下，则其不会进行任何行动。
- 否则，其会向其面对的方向发射子弹，子弹会击中面对方向的**所有未倒下**的玩家（若面对方向已经没有玩家，则不会击中任何人）。被击中的员工会立刻倒下。

由于形势混乱，在实际游戏中，$p$ 会在所有 $n!$ 个可能的排列中随机选取。

Menji 想知道，对于每一个 $1\leq k\leq n$，有多少个排列会使**员工 $k$ 最终没有倒下**？

由于答案很大，你只需要输出答案对 $998244353$ 取模后的值。
## 输入格式

第一行一个整数 $n \ (2\leq n\leq 10^5)$。

接下来一行一个长度为 $n$ 的字符串 $s$。其中 $s_i\in\{\text{L},\text{R}\}$，若 $s_i=\text{L}$ 则第 $i$ 名员工面向左方（即员工 $1$ 所在方向），若 $s_i=\text{R}$ 则第 $i$ 名员工面向右方（即员工 $n$ 所在方向）。
## 输出格式

输出一行 $n$ 个数，其中第 $i$ 个数表示使**员工 $i$ 最终没有倒下**的排列数。
## 样例

### 样例输入 #1
```
2
RL

```
### 样例输出 #1
```
1 1
```
### 样例输入 #2
```
4
LLRR

```
### 样例输出 #2
```
0 24 24 0
```
### 样例输入 #3
```
4
RLRL

```
### 样例输出 #3
```
9 6 6 9
```

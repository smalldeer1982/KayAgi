---
title: "Totient with Divisors"
layout: "post"
diff: NOI/NOI+/CTSC
pid: P13645
tag: ['数论', 'O2优化', '莫比乌斯反演', '整除分块', '筛法']
---
# Totient with Divisors
## 题目背景

到底是互质还是整除？
## 题目描述

有 $T$ 组询问，每次给定 $n,m$，求：

$$
\sum_{i=1}^n\sum_{j=1}^m\varphi(i)\varphi(j)\sigma(ij)
$$

由于答案会很大，你只需要输出答案对 $998244353$ 取模的结果。

上式中：

- $\varphi$ 是欧拉函数，$\varphi(n)$ 表示 $1\sim n$ 中与 $n$ 互质的数的个数。
- $\sigma$ 是约数和函数，$\sigma(n)$ 表示 $n$ 的所有约数之和。
## 输入格式

第一行一个正整数 $T$，表示有 $T$ 组询问。

接下来 $T$ 行，每行两个正整数 $n,m$，表示一次询问。
## 输出格式

$T$ 行，每行一个非负整数表示答案。
## 样例

### 样例输入 #1
```
8
2 2
3 3
4 4
5 5
6 6
7 7
114 514
2333 23333

```
### 样例输出 #1
```
14
130
566
2310
4778
13934
603971168
547492264
```
## 提示

**本题有捆绑测试**

- 对于 Subtask #$0$（$7$pts）：保证 $T\leq500,n,m\leq400$。
- 对于 Subtask #$1$（$8$pts）：保证 $n,m\leq450$。
- 对于 Subtask #$2$（$12$pts）：保证 $T,n,m\leq5000$。
- 对于 Subtask #$3$（$15$pts）：保证 $n,m\leq5000$。
- 对于 Subtask #$4$（$20$pts）：保证 $T\leq10$。
- 对于 Subtask #$5$（$38$pts）：无特殊限制。

对于 $100\%$ 的数据：保证 $1\leq T,n,m\leq 10^5$。

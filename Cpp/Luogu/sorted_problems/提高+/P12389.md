---
title: "COmPoUNdS"
layout: "post"
diff: 提高+/省选-
pid: P12389
tag: ['线段树', 'O2优化']
---
# COmPoUNdS
## 题目背景

小 S 因为某些原因对区间加区间取模情有独钟，他造了一些这样的题但是基本上都不会做。有一天小 S 误食了一点冰红茶突然灵感迸发把所有题都秒了，于是趁着药效他随便选了一道题造了数据，然而药效过了后他也不知道怎么做了，所以请你帮他写一下标程，事成送你一瓶冰红茶。
## 题目描述

给定正整数 $n,k,q$ 和一个长度为 $n$ 的序列 $a$，$q$ 次操作或询问：
- `1 l r c`，对于每个 $i\in[l,r]$，令 $a_i\gets(a_i+c)\bmod k$。
- `2 l1 r1 l2 r2`，判断 $a$ 的两个长度相同的子段 $a_{l_1\cdots r_1},a_{l_2\cdots r_2}$ 是否相等。
## 输入格式

第一行三个正整数 $n,k,q$。

第二行 $n$ 个正整数表示序列 $a$ 的初始值。

后 $q$ 行每行描述一个操作或询问，格式见题目描述。
## 输出格式

若干行，每行回答一个 2 操作。如果相等输出 `Yes` 否则输出 `No`。
## 样例

### 样例输入 #1
```
6 3 6
0 1 2 0 1 2
2 1 2 1 2
2 1 2 4 5
2 1 2 5 6
1 1 2 1
2 1 2 4 5
2 1 2 5 6
```
### 样例输出 #1
```
Yes
Yes
No
No
Yes
```
## 提示

**本题采用捆绑测试及子任务依赖。**

| 子任务编号 | 分值 | 特殊限制 | 依赖子任务 | 时间限制 |
| :---: | :---: | :---: | :---: | :---: |
| $1$ | $10$ | $n,q\le 10^3$ | | $\text{1.5 s}$
| $2$ | $20$ | $k=2$ | | $\text{2.5 s}$
| $3$ | $20$ | $n\le10^5$ | $1$ | $\text{1.5 s}$
| $4$ | $50$ | 无特殊限制 | $1,2,3$ | $\text{2.5 s}$
 
对于全部数据，$1\le n,q\le 10^6$，$2\le k\le 10^6$，$0\le a_i,c<k$，对于 2 操作 $r_1-l_1=r_2-l_2$。

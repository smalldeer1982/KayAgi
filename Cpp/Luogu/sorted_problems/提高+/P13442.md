---
title: "[GCJ 2009 #2] Stock Charts"
layout: "post"
diff: 提高+/省选-
pid: P13442
tag: ['2009', '二分图', 'Google Code Jam']
---
# [GCJ 2009 #2] Stock Charts
## 题目描述

You're in the middle of writing your newspaper's end-of-year economics summary, and you've decided that you want to show a number of charts to demonstrate how different stocks have performed over the course of the last year. You've already decided that you want to show the price of $n$ different stocks, all at the same $k$ points of the year.

A simple chart of one stock's price would draw lines between the points $(0, \text{price}_0)$, $(1, \text{price}_1)$, ..., $(k-1, \text{price}_{k-1})$, where $\text{price}_i$ is the price of the stock at the $i$th point in time.

In order to save space, you have invented the concept of an overlaid chart. An overlaid chart is the combination of one or more simple charts, and shows the prices of multiple stocks (simply drawing a line for each one). In order to avoid confusion between the stocks shown in a chart, the lines in an overlaid chart may not cross or touch.

Given a list of $n$ stocks' prices at each of $k$ time points, determine the minimum number of overlaid charts you need to show all of the stocks' prices.
## 输入格式

The first line of input will contain a single integer $T$, the number of test cases. After this will follow $T$ test cases on different lines, each of the form:

$n$ $k$

$\text{price}_{0,0}$ $\text{price}_{0,1}$ ... $\text{price}_{0,k-1}$

$\text{price}_{1,0}$ $\text{price}_{1,1}$ ... $\text{price}_{1,k-1}$

...

$\text{price}_{n-1,0}$ $\text{price}_{n-1,1}$ ... $\text{price}_{n-1,k-1}$

Where $\text{price}_{i,j}$ is an integer, the price of the $i$th stock at time $j$.

## 输出格式

For each test case, a single line containing "Case #$X$: $Y$", where $X$ is the number of the test-case (1-indexed) and $Y$ is the minimum number of overlaid charts needed to show the prices of all of the stocks.
## 样例

### 样例输入 #1
```
3
3 4
1 2 3 4
2 3 4 6
6 5 4 3
3 3
5 5 5
4 4 6
4 5 4
5 2
1 1
2 2
5 4
4 4
4 1
```
### 样例输出 #1
```
Case #1: 2
Case #2: 3
Case #3: 2
```
## 提示

**Limits**

- $1 \leq T \leq 100$
- $2 \leq k \leq 25$
- $0 \leq \text{price}_{i,j} \leq 1000000$

**Small Input**

- Time limit: ~~20~~ 2 seconds.
- $1 \leq n \leq 16$

**Large Input**

- Time limit: ~~30~~ 3 seconds.
- $1 \leq n \leq 100$


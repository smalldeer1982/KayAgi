---
title: "[蓝桥杯 2024 国 Python B] 异位和"
layout: "post"
diff: 普及+/提高
pid: P12273
tag: ['数学', '2024', '蓝桥杯国赛']
---
# [蓝桥杯 2024 国 Python B] 异位和
## 题目描述

给定一个数组 $A$，我们称 $A$ 的异位和数组为另一个等长的数组 $B = F(A)$，满足

$$B_i = \sum_{j \neq i} A_j$$

类似地，其二次异位和数组为 $F(F(A))$，三次异位和数组为 $F(F(F(A)))$，以此类推。

给定若干次询问，每次问 $A$ 的 $k_i$ 次异位和数组的第 $x_i$ 个元素的值是多少。输出答案对 $998244353$ 取模后的结果。
## 输入格式

输入的第一行包含一个整数 $n$。

第二行包含 $n$ 个整数 $A_1, A_2, \ldots, A_n$，相邻整数之间使用一个空格分隔。

第三行包含一个整数 $Q$ 表示询问次数。

接下来 $Q$ 行，每行包含两个整数 $k_i, x_i$ 表示一组询问，用一个空格分隔。
## 输出格式

输出 $Q$ 行，每行包含一个整数，依次表示每个询问的答案。
## 样例

### 样例输入 #1
```
5
1 2 3 4 5
4
1 1
2 5
7 3
999 4
```
### 样例输出 #1
```
14
50
49152
781284616
```
## 提示

### 评测用例规模与约定

- 对于 $60\%$ 的评测用例，$1 \leq n, Q, k_i \leq 5000$；
- 对于所有评测用例，$1 \leq n, Q \leq 10^5$，$1 \leq A_i, k_i \leq 10^9$，$1 \leq x_i \leq n$。

---
title: "[GESP202506 八级] 遍历计数"
layout: "post"
diff: 普及+/提高
pid: P13020
tag: ['图论', '2025', '组合数学', 'GESP']
---
# [GESP202506 八级] 遍历计数
## 题目描述



给定一棵有 $n$ 个结点的树 $T$，结点依次以 $1,2,\dots,n$ 标号。树 $T$ 的深度优先遍历序可由以下过程得到：

1. 选定深度优先遍历的起点 $s$（$1 \leq s \leq n$），当前位置结点即是起点。
2. 若当前结点存在未被遍历的相邻结点 $u$ 则遍历 $u$，也即令当前位置结点为 $u$ 并重复这一步；否则回溯。
3. 按照遍历结点的顺序依次写下结点编号，即可得到一组深度优先遍历序。

第一步中起点的选择是任意的，并且第二步中遍历相邻结点的顺序也是任意的，因此对于同一棵树 $T$ 可能有多组不同的深度优先遍历序。请你求出树 $T$ 有多少组不同的深度优先遍历序。由于答案可能很大，你只需要求出答案对 $10^9$ 取模之后的结果。


## 输入格式


第一行，一个整数 $n$，表示树 $T$ 的结点数。

接下来 $n-1$ 行，每行两个正整数 $u_i, v_i$，表示树 $T$ 中的一条连接结点 $u_i, v_i$ 的边。
## 输出格式


输出一行，一个整数，表示树 $T$ 的不同的深度优先遍历序数量对 $10^9$ 取模的结果。
## 样例

### 样例输入 #1
```
4
1 2
2 3
3 4
```
### 样例输出 #1
```
6
```
### 样例输入 #2
```
8
1 2
1 3
1 4
2 5
2 6
3 7
3 8
```
### 样例输出 #2
```
112
```
## 提示

对于 40% 的测试点，保证 $1 \leq n \leq 8$。

对于另外 20% 的测试点，保证给定的树是一条链。

对于所有测试点，保证 $1 \leq n \leq 10^5$。

在洛谷上，只有通过了 Subtask0、Subtask1 和 Subtask2 后，才能获得第三个 Subtask 的分数。

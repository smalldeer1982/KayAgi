---
title: "[GESP202412 六级] 树上游走"
layout: "post"
diff: 普及-
pid: P11375
tag: ['模拟', '2024', 'GESP']
---
# [GESP202412 六级] 树上游走
## 题目描述

小杨有一棵包含无穷节点的二叉树（即每个节点都有左儿子节点和右儿子节点；除根节点外，每个节点都有父节点），其中根节点的编号为 $1$，对于节点 $i$，其左儿子的编号为 $2\times i$，右儿子的编号为 $2\times i + 1$。

小杨会从节点 $s$ 开始在二叉树上移动，每次移动为以下三种移动方式的任意一种：

- **第 1 种移动方式**：如果当前节点存在父亲节点，向上移动到当前节点的父节点，否则不移动；
- **第 2 种移动方式**：移动到当前节点的左儿子；
- **第 3 种移动方式**：移动到当前节点的右儿子。

小杨想知道移动 $n$ 次后自己所处的节点编号。**数据保证最后所处的节点编号不超过 $10^{12}$**。
## 输入格式

第一行包含两个正整数 $n$ 和 $s$，代表移动次数和初始节点编号。

第二行包含一个长度为 $n$ 且仅包含大写字母 $\tt{U}$、$\tt{L}$ 和 $\tt{R}$ 的字符串，代表每次移动的方式，其中 $\tt{U}$ 代表第 1 种移动方式，$\tt{L}$ 代表第 2 种移动方式，$\tt{R}$ 代表第 3 种移动方式。
## 输出格式

输出一个正整数，代表最后所处的节点编号。
## 样例

### 样例输入 #1
```
3 2
URR
```
### 样例输出 #1
```
7
```
## 提示

小杨的移动路线为 $2 \to 1 \to 3 \to 7$。

| 子任务编号 | 数据点占比 |     $n$     |      $s$       |
| :--------: | :--------: | :---------: | :------------: |
|    $1$     |   $20\%$   |  $\leq 10$  |    $\leq 2$    |
|    $2$     |   $20\%$   |  $\leq 50$  |   $\leq 10$    |
|    $3$     |   $60\%$   | $\leq 10^6$ | $\leq 10^{12}$ |


对于全部数据，保证有 $1\leq n\leq 10^6$，$1\leq s\leq 10^{12}$。

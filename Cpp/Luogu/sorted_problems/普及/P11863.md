---
title: "「o.OI R1」CX"
layout: "post"
diff: 普及/提高-
pid: P11863
tag: ['O2优化']
---
# 「o.OI R1」CX
## 题目背景

[CX - Levitatexc](https://music.163.com/#/song?id=455692044)
## 题目描述

给定一棵 $n$ 个节点的树。树上的节点从 $1$ 到 $n$ 编号，树的根节点为 $1$ 号节点。

你可以选中这棵树上的若干个节点（**可以全选，可以全不选**）。

选中节点 $u$ 时**同时进行两步操作**：

1. 覆盖以节点 $u$ 为根的子树中的所有边 $1$ 次。若 $u$ 是叶子节点，那么这一步没有边被覆盖。
2. 覆盖节点 $u$ 到 $1$ 的路径上的所有边 $1$ 次。若 $u=1$，那么这一步没有边被覆盖。

求有多少种选节点的方案，使得树上的所有边都**恰好**被覆盖 $1$ 次。两种方案不同当且仅当至少一个节点在其中一个方案被选中，在另一个方案没被选中。答案对 $998244353$ 取模。
## 输入格式

第一行一个正整数 $n$。

第二行 $n-1$ 个正整数 $f_2,f_3,\cdots,f_n$，表示编号为 $2\sim n$ 的节点各自父亲节点的编号。
## 输出格式

一行一个正整数，表示选点的方案数对 $998244353$ 取模的值。
## 样例

### 样例输入 #1
```
6
1 1 2 3 3
```
### 样例输出 #1
```
3
```
## 提示

**「数据范围」**

**本题采用捆绑测试。**

对于所有测试数据，保证：

- $1 \leq n \leq 5\times10^5$。
- 对于 $2 \leq i \leq n$，$f_i < i$。

| 子任务 | $n$ | 特殊性质 | 分值 |
| :----------: | :----------: | :----------: | :----------: |
| $0$ | $\leq 8$ | 无 | $15$ |
| $1$ | $\leq 5\times10^5$ | $f_i = 1$，其中 $2 \leq i \leq n$ | $10$ |
| $2$ | $\leq 5\times10^5$ | $f_i = i - 1$，其中 $2 \leq i \leq n$ | $10$ |
| $3$ | $\leq 5\times10^5$ | 无 | $65$ |

---
title: "[GCJ 2016 #3] Go++"
layout: "post"
diff: 省选/NOI-
pid: P13205
tag: ['2016', 'Special Judge', '构造', 'Google Code Jam']
---
# [GCJ 2016 #3] Go++
## 题目描述

The Go language was designed to have a simple API and to support multi-threading. The Code Jam team wants to push these goals to the limit, so we are proposing a new language called Go++.

The Go++ language uses one register, which stores one boolean value (0 or 1). This register is initialized to 0. The language has three instructions:

* $\mathbf{0}$, which sets the register to 0.
* $\mathbf{1}$, which sets the register to 1.
* $\mathbf{?}$, which prints the current register value.

Simple, right? To support multi-threading, we allow two different Go++ programs to run simultaneously while sharing the one register. Each instruction executes atomically - that is, one instruction must completely finish before the next instruction can start. However, the two programs may be interleaved in any way that preserves the relative order within each program.

For example, here are the only six ways in which the two programs $1 \mathbf{?}$ and $\mathbf{?} \mathbf{0}$ could be executed together. (The underline on the second program is just to distinguish its instructions from the instructions in the first program.)

* $\mathbf{?} \mathbf{0} \mathbf{1} \mathbf{?}$, which will print $\mathbf{0 1}$. (Remember that the register is initialized to 0.)
* $\mathbf{?} \mathbf{1} \mathbf{0} \mathbf{?}$, which will print $\mathbf{0 0}$.
* $\mathbf{?} \mathbf{1} \mathbf{?} \mathbf{0}$, which will print $\mathbf{0 1}$.
* $\mathbf{1} \mathbf{?} \mathbf{0} \mathbf{?}$, which will print $\mathbf{1 0}$.
* $\mathbf{1} \mathbf{?} \mathbf{?} \mathbf{0}$, which will print $\mathbf{1 1}$.
* $\mathbf{1} \mathbf{?} \mathbf{?} \mathbf{0}$, which will print $\mathbf{1 1}$.

Note that the output string always consists of $\mathbf{0}$ s and $\mathbf{1}$ s, and never $\mathbf{?}$ s, since $\mathbf{?}$ is not a state the register can be in.

Usually, programmers write programs to produce a desired output, but your task will be to write two programs that won't produce an undesired output! Specifically, you will be given a "bad" string $\mathbf{B}$ of length $\mathbf{L}$, and a set $\mathbf{G}$ of $\mathbf{N}$ "good" strings, all of length $\mathbf{L}$. You must produce two Go++ programs (not necessarily of the same length), which, when run in the way described here, could produce all of the strings in $\mathbf{G}$, but could not produce the string $\mathbf{B}$. It is fine if the programs could also produce other strings that are not $\mathbf{B}$ and not in $\mathbf{G}$. Note that there must be a combined total of exactly $\mathbf{L}$ ? instructions in the two programs. The combined number of instructions in the two programs must not exceed 200 .

For example, for $\mathbf{B}=\mathbf{1 1}$ and $\mathbf{G}=\{\mathbf{1 0}, \mathbf{0 0}\}$, the programs $\mathbf{?}$ and $\mathbf{1 0} \mathbf{?} \mathbf{1}$ would be one valid answer. They can produce every string in $\mathbf{G}$, but they cannot produce $\mathbf{B}$, no matter how they are interleaved. (They can also produce the string $\mathbf{0 1}$, which is not $\mathbf{B}$ and is not in $\mathbf{G}$, but that is fine.) However, the programs $\mathbf{1} \mathbf{?}$ and $\mathbf{?} \mathbf{0}$ would not be a valid answer, since (as we saw above) they can produce $\mathbf{B}$. The programs $\mathbf{0 0}$ and $\mathbf{?} \mathbf{?}$ would not be a valid answer, since they cannot produce every string in $\mathbf{G}$.

Can you produce two programs that satisfy the conditions, or determine that the task is IMPOSSIBLE?

## 输入格式

The first line of the input gives the number of test cases, $\mathbf{T}$. $\mathbf{T}$ test cases follow; each consists of three lines. The first line of each test case has two integers $\mathbf{N}$ and $\mathbf{L}$ : the number of strings in $\mathbf{G}$, and the length of the $\mathbf{B}$ string and the strings in $\mathbf{G}$. The second line has $\mathbf{N}$ different strings of length $\mathbf{L}$ : the strings in $\mathbf{G}$. The third line has one string of length $\mathbf{L}$ : the bad string $\mathbf{B}$. $\mathbf{B}$ and all of the strings in $\mathbf{G}$ are made up of only $\mathbf{0}$ s and/or $\mathbf{1}$ s.
## 输出格式

For each test case, output one line containing `Case # x : IMPOSSIBLE`, if no programs will satisfy the conditions; otherwise, output `Case #x: y z`, where $\mathbf{x}$ is the test case number (starting from 1) and $\mathbf{y}$ and $\mathbf{z}$ are your two programs that satisfy the conditions. The combined number of instructions in your programs must not exceed 200. Each program must contain at least one instruction. There must be a combined total of exactly $\mathbf{L} \mathbf{?}$ instructions in the two programs.
## 样例

### 样例输入 #1
```
3
2 2
10 00
11
3 2
11 10 00
01
4 2
00 01 10 11
11
```
### 样例输出 #1
```
Case #1: ? 10?1
Case #2: 1?? 0
Case #3: IMPOSSIBLE
```
## 提示

**Sample Explanation**

The sample output displays one set of answers to the sample cases. Other answers may be possible.

Sample case #1 is the one described in the problem statement.

Sample case #2 would not appear in the Small dataset.

Sample case #3 is obviously IMPOSSIBLE because B is in G.

**Limits**

- $1 \leqslant \mathbf{T} \leqslant 100$.
- $1 \leqslant \mathbf{N} \leqslant 100$.
- $1 \leqslant \mathbf{L} \leqslant 50$.
- All strings in $\mathbf{G}$ are different.

**Small dataset (7 Pts, Test Set 1 - Visible)**

- $\mathbf{B}$ consists entirely of $\mathbf{1}$ s.

**Large dataset (28 Pts, Test Set 2 - Hidden)**

- $\mathbf{B}$ may be any string consisting of $\mathbf{0}$ s and/or $\mathbf{1}$ s.

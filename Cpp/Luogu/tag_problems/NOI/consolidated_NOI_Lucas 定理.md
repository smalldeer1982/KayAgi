---
title: "[PA 2016] 覆盖 / Pokrycia"
layout: "post"
diff: NOI/NOI+/CTSC
pid: P11613
tag: ['动态规划 DP', '2016', '组合数学', '生成函数', 'Lucas 定理', 'PA（波兰）']
---
# [PA 2016] 覆盖 / Pokrycia
## 题目背景

译自 [Potyczki Algorytmiczne 2016](https://sio2.mimuw.edu.pl/c/pa-2016-1/p/) R5 Pokrycia [A] (POK)。

## 题目描述


简单无向图 $G=(V,E)$ 的**点覆盖**是一个点集 $S\subseteq V$，使得 $\forall (u,v)\in E$，都有 $u\in S$ 或 $v\in S$。点覆盖 $S$ 的**大小**定义为 $|S|$。

给定点集 $V$ 和整数 $k$，求出有多少张以 $V$ 为点集的简单无向图 $G$ 的最小点覆盖大小为 $k$。

两张图 $G_1=(V,E_1)$ 和 $G_2=(V,E_2)$ 不同，当且仅当存在 $u,v\in V$，使得 $(u,v)$ 只属于 $E_1$ 或 $E_2$。

给定正整数 $n$，点集 $V=\{1,2,\ldots,n\}$。

由于答案可能很大，所以只需要输出答案模 $\textcolor{red}{\textbf{2}}$ 后的余数。
## 输入格式


**本题单个测试点内有多组测试数据。**

第一行一个正整数 $T$，表示测试数据组数。

接下来描述 $T$ 组测试数据：

每组测试数据只有一行两个整数 $n,k$，表示一次询问。$V=\{1,2,\ldots,n\}$。

## 输出格式


输出 $T$ 行，每行一个非负整数，表示答案模 $\textcolor{red}{\textbf{2}}$ 后的余数。
## 样例

### 样例输入 #1
```
4
3 1
5 4
5 3
57 32
```
### 样例输出 #1
```
0
1
1
1
```
## 提示



#### 样例解释

- 第一组测试数据中，$n=3,k=1$。符合条件的图要么只有一条边，要么有两条边，且这两条边共用一个顶点。不难验证，原始答案为 $6$。
- 第二组测试数据中，$n=5,k=4$。不难验证符合条件的图只有完全图。


#### 数据范围


- $1\le T\le 2^{14}$；
- $1\le n\lt 2^{14}$；
- $0\le k\lt n$。


---

---
title: "[MtOI2019] 埋骨于弘川"
layout: "post"
diff: NOI/NOI+/CTSC
pid: P5519
tag: ['数学', '2019', '洛谷原创', 'O2优化', '线性递推', '快速傅里叶变换 FFT', 'Lucas 定理']
---
# [MtOI2019] 埋骨于弘川
## 题目背景

在幻想乡中，冥界的樱花一年又一年地往复开放。

在 Yuyuko 的心中，出现了一棵樱花树，一个与花朵息息相关的序列，和一个伤感的问题。

那些曾经奋斗过的 OIer 们啊，如今又在何方呢？
## 题目描述

在幻想乡，西行寺 幽幽子(Yuyuko)是一个以贪吃著名的亡灵，她拥有操纵死亡的能力。

Yuyuko 通过外界的式神——电脑，对OI进行了深刻的研究 ，她发现了一些惊人的事实：

* OIer 们放弃了太多其他同学们拥有的东西，在题海中寻求自己的梦想。  

* 但是 AFO 的 OIer 们，跟死亡又有什么区别呢？他们或许已经失去了自己的梦想……

这时幽幽子发现，天空中飘舞的樱花组成了两个整数 $n$，$k$。于此同时，在樱花树下，出现了一个函数 $f(x,y)$ 的描述：

$$f(x,y) = \begin{cases} 2 & , x=1 \\ 2^x& , 2\le x \le 42,y = 0 \\ \prod\limits_{i=1}^{42} f(x-i,y)^i & , x \ge 43,y = 0 \\ f(x-1,y)f(x,y-1) & , x\ge 2,y \ge 1\end{cases}$$



幽幽子想让你计算出 $f(n,k) \bmod 998244353$，她认为这个函数象征着OIer们......
## 输入格式

两个整数 $n,k$
## 输出格式

一个正整数 $f(n,k) \bmod 998244353$
## 样例

### 样例输入 #1
```
1 1926
```
### 样例输出 #1
```
2
```
### 样例输入 #2
```
23 3
```
### 样例输出 #2
```
509581943
```
### 样例输入 #3
```
1919 810
```
### 样例输出 #3
```
252250482
```
## 提示

【样例 $1$ 解释】

根据定义，$f(1,1926)=2$。

【数据范围与约定】

**本题采用捆绑测试。**

Subtask 1 (7 points)：$1\le n,k \le 1000$   
Subtask 2 (11 points)：$1\le n \le 10^{18}$，$k=0$   
Subtask 3 (13 points)：$1\le n \le 10^{18}$，$k=1$   
Subtask 4 (29 points)：$1\le n \le 10^{18}$，$0\le k \le 1000$   
Subtask 5 (40 points)：无特殊限制

对于 $100\%$ 的数据：$1\le n \le 10^{18}$，$0\le k \le 30000$   

### 题目来源

[迷途之家2019联赛](https://www.luogu.org/contest/20135)(MtOI2019) T6

出题人：NaCly_Fish 

验题人：Imagine 

题面：disangan233

**此题稍有卡常，请注意优化代码常数。**


---

---
title: "【XR-4】混乱度"
layout: "post"
diff: NOI/NOI+/CTSC
pid: P5598
tag: ['O2优化', 'Lucas 定理', '洛谷月赛']
---
# 【XR-4】混乱度
## 题目描述

小 X 有 $n$ 种颜色的球，其中第 $i$ 种颜色的球共有 $a_i$ 个，同色的球无法区分。定义第 $l \sim r$ 种颜色的混乱度 $f(l, r)$ 为：将第 $l \sim r$ 种颜色的所有球排成一排，总共的方案数对 $p$ 取模后的值。小 X 想请你帮忙计算下列式子的值：

$$ \sum_{l=1}^n \sum_{r=l}^n f(l, r) $$
## 输入格式

第一行两个整数 $n, p$。

第二行 $n$ 个整数 $a_i$。

## 输出格式

一行一个整数，表示答案。
## 样例

### 样例输入 #1
```
2 2
1 2

```
### 样例输出 #1
```
3

```
### 样例输入 #2
```
4 7
1 2 8 9

```
### 样例输出 #2
```
28

```
### 样例输入 #3
```
15 5
1 5 26 1 0 5 0 6 7 51 1 5 26 1 0

```
### 样例输出 #3
```
124

```
## 提示

【样例 1 说明】

$$f(1,1) = 1 \bmod 2 = 1$$

$$f(1,2) = 3 \bmod 2 = 1$$

$$f(2,2) = 1 \bmod 2 = 1$$

$$ \sum_{l=1}^n \sum_{r=l}^n f(l, r)  = 3$$

---

**本题采用捆绑测试。**

- Subtask 1（31 points）：$1 \le n \le 5 \times 10^5$，$a_i$ 在 $[0, 10^5]$ 内均匀随机，时限 $1.5 \text{ s}$。
- Subtask 2（32 points）：$1 \le n \le 5 \times 10^4$，时限 $5 \text{ s}$。
- Subtask 3（37 points）：无特殊限制，时限 $2.5 \text{ s}$。

对于 $100\%$ 的数据，$1 \le n \le 5 \times 10^5$，$0 \le a_i \le 10^{18}$，$p \in \{2,3,5,7\}$。


---


---
title: "【MX-X10-T7】[LSOT-4] 春开，意遥遥。"
layout: "post"
diff: NOI/NOI+/CTSC
pid: P12011
tag: ['数学', '原根', '数论', '大步小步算法 BSGS', '梦熊比赛']
---
# 【MX-X10-T7】[LSOT-4] 春开，意遥遥。
## 题目背景

> Spring has come true？

冬音在某次轮回时候本来给一季出的是这道题，但是由于作者怕大家看不懂 OI 题就换成将棋题了，因此被删除，已经过了 12 年了，于是在此放出原来的题。
## 题目描述

定义二元组乘法为：$(x,y)\times(a,b)=(x\times b+y\times a,x\times a+y\times b)$。

由于该乘法定义满足结合律（可自行验证），可以定义二元组的乘方：对二元组 $a$ 和**正整数** $b$，$a^b$ 为 $b$ 个 $a$ 顺次相乘（由结合律可知不同计算顺序下结果唯一）。

定义两二元组 $(x,y)$ 和 $(a,b)$ 在模 $p$ 意义下相同当且仅当 $a\times y\equiv x\times b \pmod p$。**（注意此处的相同未必具有传递性。）**

冬音给出了一个长度为 $n$ 的二元组序列 $a$。

她希望一季能求出最多选出多少个长度为 $n$ 的正整数序列 $b$ 使得对于每个 $b$，$\prod_{i=1}^n a_i^{b_i}$ 在模 $p$ 意义下互不相同。**保证 $\boldsymbol{p}$ 为质数。**

求对于每一个区间的上面这个问题的答案的和对 $10^9+7$ 取模的结果。
## 输入格式

第一行，两个整数 $n,p$。**保证 $\boldsymbol{p}$ 为质数。**

接下来 $n$ 行，第 $i$ 行两个整数 $x_i,y_i$，表示 $a_i=(x_i,y_i)$。
## 输出格式

仅一行，一个整数，表示答案的和对 $10^9+7$ 取模的结果。

## 样例

### 样例输入 #1
```
2 5
3 4
2 3

```
### 样例输出 #1
```
6

```
### 样例输入 #2
```
7 3
2 2
1 2
1 0
2 1
1 1
2 1
2 0

```
### 样例输出 #2
```
30

```
### 样例输入 #3
```
8 935259307
761834349 406479726
404588595 588271872
835094749 847811683
52046622 489905911
530455310 402465343
616226641 808848730
891363714 745033395
207684362 101456684

```
### 样例输出 #3
```
46008831

```
## 提示

**【样例解释 #1】**

区间 $[1,1]$ 的答案为 $4$，其中一种选择方案中选择的 $b$ 分别为 $\{1\},\{2\},\{3\},\{4\}$。

区间 $[1,2]$ 的答案为 $1$，其中一种选择方案中选择的 $b$ 为 $\{1,1\}$。

区间 $[2,2]$ 的答案为 $1$，其中一种选择方案中选择的 $b$ 为 $\{1\}$。

**【数据范围】**

**本题采用捆绑测试。**

- 子任务 1（4 分）：$n\le2$，$p\le 5$。
- 子任务 2（8 分）：$n\le5$，$p\le 5$。
- 子任务 3（5 分）：$x_i=p-y_i$。
- 子任务 4（3 分）：$x_i=y_i$。
- 子任务 5（21 分）：$x_i=y_i-1$。
- 子任务 6（7 分）：$p=2$。
- 子任务 7（6 分）：$p=5$。
- 子任务 8（7 分）：$p\le 5003$。
- 子任务 9（8 分）：$p\le 10^9+7$。
- 子任务 10（14 分）：$p\le 10^{12}+39$。
- 子任务 11（17 分）：无特殊性质。

对于全部的数据，$1\le n\le 10^5$，$2\le p\le 10^{14}+67$，$0\le x_i,y_i<p$。**保证 $\boldsymbol{p}$ 为质数。**


---

---
title: "[十二省联考 2019] 骗分过样例"
layout: "post"
diff: NOI/NOI+/CTSC
pid: P5285
tag: ['数学', '2019', '各省省选', '原根', '数论', '素数判断,质数,筛法']
---
# [十二省联考 2019] 骗分过样例
## 题目背景

这是一道**传统题**。

“我的程序需要完成什么功能呀？. . . . . . ”

“我也不知道. . . . . . ”

“啊？那我怎么写呀. . . . . . ”

“已经有人给你写好测试了，只要你通过这些测试就可以了. . . . . . ”

“啊？. . . . . . ”

“所有的测试数据都在题目目录下，请做好备份，避免误删！”

“这. . . . . . ”

“哦，我还可以把输入格式告诉你. . . . . . 不过都有完整的数据了，知道输入格式可能也没太大用处吧. . . . . . ”
## 题目描述

题目数据详见附加文件
## 输入格式

第一行输入一个字符串，表示需要运行的软件功能编号。两个编号越相似，说明对
应的两个功能的算法越接近。

接下来根据功能的不同，可能有任意长度的输入，详见每个功能的文档。
## 输出格式

详见每个功能的文档。
## 提示

#### 子任务
“‘每个功能的文档’在哪里呀？”

“我也没有，就像我没有题目描述一样. . . . . . ”

“好吧. . . . . . 那我是不是打表就可以了呀. . . . . . ”

“**代码长度限制是 $\bold{102400}$ 字节** （$100$KB），直接打肯定是不行的！不过，需要的话倒是可以稍微打一些小的表. . . . . . ”

“唔. . . . . . ”

“另外，我们会给你的程序对于每个测试点分别评分，求和后得到总分。按照传统
的规矩，每个测试点正确得满分，错误得 $0$ 分。**每个测试点的分值不全相同，测试点的分值、顺序与难度没有必然联系** 。”

| 测试点 | 功能编号 | 分值 |
| :-------: | :-------: | :-------: |
| $1$ | $\texttt{1\_998244353}$ | $4$ |
| $2$ | $\texttt{1\_998244353}$ | $4$ |
| $3$ | $\texttt{1\_998244353}$ | $4$ |
| $4$ | $\texttt{1?}$ | $7$ |
| $5$ | $\texttt{1?+}$ | $9$ |
| $6$ | $\texttt{1wa\_998244353}$ | $6$ |
| $7$ | $\texttt{1wa\_998244353}$ | $7$ |
| $8$ | $\texttt{2p}$ | $4$ |
| $9$ | $\texttt{2p}$ | $6$ |
| $10$ | $\texttt{2p}$ | $8$ |
| $11$ | $\texttt{2u}$ | $5$ |
| $12$ | $\texttt{2u}$ | $6$ |
| $13$ | $\texttt{2u}$ | $9$ |
| $14$ | $\texttt{2g}$ | $5$ |
| $15$ | $\texttt{2g}$ | $7$ |
| $16$ | $\texttt{2g?}$ | $9$ |


#### 提示
在你使用 C/C++ 的 `int` 类型时，如果发生了溢出，比较可能的情况是按照模 $2^{32}$ 同余的前提下，在 `int` 范围内取一个合理的值。例如在计算 $2147483647 + 2$ 时，较有可能会得到 -$2147483647$。

然而，C/C++ 标准将这种情况归类为“未定义行为”。当你的程序试图计算会溢
出的 `int` 运算时，除了上述结果外，编译器还可能会让你的程序在此时计算出错误结果、死循环、运行错误等，这也是符合 C/C++ 标准的。

如果你的程序希望利用 `int` 的自然溢出的特性，请转换为 `unsigned` 类型运算。例如将 `a + b` 改写为 `(int) ((unsigned) a + (unsigned) b)`，以避免出现不预期的错误。



---

---
title: "「SWTR-8」幂塔方程"
layout: "post"
diff: NOI/NOI+/CTSC
pid: P8457
tag: ['原根', '数论', '洛谷原创', 'Special Judge', 'O2优化', '扩展欧几里德算法', '中国剩余定理 CRT', '逆元', '洛谷月赛']
---
# 「SWTR-8」幂塔方程
## 题目背景

![](https://cdn.luogu.com.cn/upload/image_hosting/iflu3244.png)

图片来自于 Solara570 的 B 站视频 [轻易相信简单直观的结论究竟有多危险？](https://www.bilibili.com/video/BV1PW41177Vb)。

很久以前的某一天，小 A 在 B 站上无意间刷到了这个视频。视频中的无穷幂塔方程及其「简单直观，但暗藏陷阱」的解法令他影响深刻。
$$
\Huge x ^ {x ^ {x ^ {x ^ {x}}}}
$$
## 题目描述

如果小 A 是一个，一个一个一个毒瘤，他会让你求解套了十层甚至九层的幂塔方程，但他不是。

他想让你求解：
$$
x ^ x\equiv D \pmod n
$$

保证 $n$ 的最大质因子不超过 $10 ^ 5$，且 $D$ 与 $n$ 互质。

你需要保证得到的解 $x$ 为 $[0, 2 ^ {125}]$ 范围内的整数。若该范围内无解，输出 $-1$；若存在多解，输出任意一个。

多组测试数据。
## 输入格式

第一行一个整数 $S$，表示该测试点的 Subtask 编号。

第二行一个整数 $T$，表示数据组数。接下来 $T$ 组测试数据，每组数据形如：

- 第一行两个整数 $n, D$。
- 第二行若干递增的质数 $p_1, p_2, \cdots, p_k$，表示 $n$ 的所有质因子。
## 输出格式

输出 $T$ 行 $[-1, 2 ^ {125}]$ 范围内的整数。
## 样例

### 样例输入 #1
```
0
10
7 4
7
16 3
2
6 1
2 3
144 5
2 3
2520 11
2 3 5 7
999999 2
3 7 11 13 37
22511 21795
22511
47067727606562827 30911969774113407
3083 13697 25747 43291
2147483648 2333333
2
675288511488360000 510472780110265817
2 3 5 7 11
```
### 样例输出 #1
```
25
11
1
101
4811
219871229
16139671
760913896873844308082367046696111
1221598821
24445987958110300438937

```
## 提示

**「数据范围与约定」**

**本题采用捆绑测试**。

- Subtask #1（5 points）：$n\leq 20$。
- Subtask #2（8 points）：$n\leq 400$。依赖 Subtask #1。
- Subtask #3（11 points）：$n$ 是质数，$T\leq 10 ^ 4$。
- Subtask #4（15 points）：$\mu(n) \neq 0$，$T\leq 100$。
- Subtask #5（9 points）：$\mu(n) \neq 0$，$T\leq 10 ^ 4$。依赖 Subtask #4。
- Subtask #6（13 points）：$n = p ^ k(p \in \mathrm{prime})$，$T\leq 100$。
- Subtask #7（7 points）：$n = p ^ k(p \in \mathrm{prime})$，$T\leq 10 ^ 4$。依赖 Subtask #3，#6。
- Subtask #8（6 points）：$n$ 的最大质因子不超过 $ 1064$。依赖 Subtask #2。
- Subtask #9（16 points）：$n\leq 10 ^ 9$，$T\leq 10 ^ 4$。
- Subtask #10（10 points）：无特殊限制。依赖 Subtask #5，#7，#8，#9。

对于 $100\%$ 的数据：

- $1\leq T\leq 4\times 10 ^ 4$。
- $2\leq n \leq 10 ^ {18}$。
- $1\leq D < n$，$D\perp n$。
- $2\leq p_1 < p_2 < \cdots < p_k \leq 10 ^ 5$。

**「帮助与提示」**

选手可以通过边读入边试除的方式判断何时停止读入 $n$ 的质因子。

**「题目来源」**

- [Sweet Round 8](https://www.luogu.com.cn/contest/73382) F
- Idea & Solution：[demonlover923](https://www.luogu.com.cn/user/152997) & [codecode](https://www.luogu.com.cn/user/119526)。
- Tester：[Alex_Wei](https://www.luogu.com.cn/user/123294)。


---


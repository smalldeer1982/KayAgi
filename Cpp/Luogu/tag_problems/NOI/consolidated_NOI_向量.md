---
title: "[NOI2012] 骑行川藏"
layout: "post"
diff: NOI/NOI+/CTSC
pid: P2179
tag: ['数学', '2012', 'NOI', 'Special Judge', '向量', '构造', '拉格朗日乘数法']
---
# [NOI2012] 骑行川藏
## 题目描述

蛋蛋非常热衷于挑战自我，今年暑假他准备沿川藏线骑着自行车从成都前往拉萨。

川藏线的沿途有着非常美丽的风景，但在这一路上也有着很多的艰难险阻，路况变化多端，而蛋蛋的体力十分有限,因此在每天的骑行前设定好目的地，同时合理分配好自己的体力是一件非常重要的事情。

由于蛋蛋装备了一辆非常好的自行车，因此在骑行过程中可以认为他仅在克服风阻做功（不受自行车本身摩擦力以及自行车与地面的摩擦力影响）。

某一天他打算骑 $n$ 段路，每一段内的路况可视为相同：对于第 $i$ 段路,我们给出有关这段路况的 $3$ 个参数 $s_i,k_i,v_i'$，其中 $s_i$ 表示这段路的长度，$k_i$ 表示这段路的风阻系数，$v_i'$ 表示这段路上的风速（$v_i'\gt 0$ 表示在这段路上他遇到了顺风，反之则意味着他将受逆风影响）。

若某一时刻在这段路上骑车速度为 $v$，则他受到的风阻
大小为 $F=k_i(v-v_i')^2$（这样若在长度为 $s$ 的路程内保持骑行速度 $v$ 不变,则他消耗能量（做功）$E=k_i(v-v_i')^2s$ ）。

设蛋蛋在这天开始时的体能值是 $E_U$，请帮助他设计一种行车方案,使他在有限的体力内用最短的时间到达目的地。请告诉他最短的时间 $T$ 是多少。
## 输入格式

第一行包含一个正整数 $n$ 和一个实数 $E_U$，分别表示路段的数量以及蛋蛋的体能值。

接下来 $n$ 行分别描述 $n$ 个路段，每行有 $3$ 个实数 $s_i,k_i,v_i'$ 分别表示第 $i$ 段路的长度，风阻系数以及风速。
## 输出格式

输出一个实数 $T$，表示蛋蛋到达目的地消耗的最短时间，要求至少保留到小数点后 $6$ 位。
## 样例

### 样例输入 #1
```
3 10000
10000 10 5
20000 15 8
50000 5 6
```
### 样例输出 #1
```
12531.34496464
```
## 提示

### 样例说明

一种可能的方案是：蛋蛋在三段路上都采用匀速骑行的方式,其速度依次为 $5.12939919,8.03515481,6.17837967$。

### 评分方法

本题没有部分分,你程序的输出只有和标准答案的差距不超过 $10^{-6}$ 时，才能获得该测试点的满分，否则不得分。

### 数据规模与约定

对于 $10\%$  的数据，$n=1$。

对于 $40\%$  的数据，$n\le2$。

对于 $60\%$  的数据，$n\le100$。

对于 $80\%$  的数据，$n\le 1000$。

对于 $100\%$  的数据，$n\le 10^4$，$E_U\le 10^8$，$s_i\in[0,10^5]$，$k_i\in(0,15]$，$v_i'\in(-100,100)$。

数据保证最终的答案不会超过 $10^5$。

### 提示

必然存在一种最优的体力方案满足：蛋蛋在每段路上都采用匀速骑行的方式。


---

---
title: "[NOI2017] 泳池"
layout: "post"
diff: NOI/NOI+/CTSC
pid: P3824
tag: ['递推', '2017', 'NOI', 'O2优化', '线性递推', '向量']
---
# [NOI2017] 泳池
## 题目背景

久莲是个爱玩的女孩子。

暑假终于到了，久莲决定请她的朋友们来游泳，她打算先在她家的私人海滩外圈一块长方形的海域作为游泳场。然而大海里有着各种各样的危险，有些地方水太深，有些地方有带毒的水母出没。她想让圈出来的这一块海域都是安全的。

## 题目描述

经过初步分析，这块海域可视为一个底边长为 $N$ 米，高为 $1001$ 米的长方形网格。其中网格的底边对应着她家的私人海滩，每一个 $1\:\textrm{m}\times1\:\textrm{m}$ 的小正方形都代表着一个单位海域。她拜托了她爸爸明天去测量每一个小正方形是否安全。在得知了信息之后，她要做的就是圈出她想要的游泳场啦。  

她心目中理想的游泳场满足如下三个条件：
- 必须保证安全性。即游泳场中的每一个单位海域都是安全的。
- 必须是矩形。即游泳场必须是整个网格中的一个 $a\times b$ 的子网格。
- 必须和海滩相邻。即游泳场的下边界必须紧贴网格的下边界。

例如：当 $N = 5$ 时，若测量的结果如下（因为 $1001$ 太大，这儿只画出网格最下面三行的信息，其他部分都是危险的）。 

 ![](https://cdn.luogu.com.cn/upload/pic/6465.png) 

那么她可以选取最下面一行的 $1\times4$ 的子海域，也可以选择第三列的 $3\times1$ 的子海域。注意她不能选取最上面一行的 $1\times5$ 的子海域，因为它没有与海滩相邻。

为了让朋友们玩的开心，她想让游泳场的面积尽可能的大。因此她会选取最下面那一行的 $1\times4$ 的子海域作为最终方案。

虽然她要明天才能知道每一个单位海域是否安全，但是她现在就想行动起来估计一下她的游泳场面积有多大。经过简单的估计，她假设每一个单位海域都有独立的 $q$ 的概率是安全的，$1 − q$ 的概率是不安全的。她想要知道她能选择的最大的游泳场的面积**恰好**为 $K$ 的概率是多少。

然而久莲对数学并不感兴趣，因此她想让你来帮她计算一下这个数值。
## 输入格式

输入一行四个正整数 $N,K,x,y$，其中 $1 \leq x < y < 998\,244\,353$。$q$ 的取值为 $\dfrac{x}{y}$。
## 输出格式

输出一行一个整数表示答案在模 $998\,244\,353$ 意义下的取值。

即设答案化为最简分式后的形式为 $\dfrac{a}{b}$ ，其中 $a$ 和 $b$ 的互质。输出整数 $x$ 使得 $bx \equiv a \mod 998\,244\,353$ 且 $0 \leq x < 998\,244\,353$。可以证明这样的整数 $x$ 是唯一的。 
## 样例

### 样例输入 #1
```
10 5 1 2
```
### 样例输出 #1
```
342025319
```
## 提示

| 测试点编号 | $N$ | $K$ |
|:-:|:-:|:-:|
| 1,2 | $=1$ | $\leq 1000$ |
| 3 | $\leq 10$ | $\leq 8$ |
| 4 | $\leq 10$ | $\leq 9$ |
| 5 | $\leq 10$ | $\leq 10$ |
| 6 | $\leq 1000$ | $\leq 7$ |
| 7 | $\leq 1000$ | $\leq 8$ |
| 8 | $\leq 1000$ | $\leq 9$ |
| 9,10,11 | $\leq 1000$ | $\leq 100$ |
| 12,13,14 | $\leq 1000$ | $\leq 1000$ |
| 15,16 | $\leq 10^9$ | $\leq 10$ |
| 17,18 | $\leq 10^9$ | $\leq 100$ |
| 19,20 | $\leq 10^9$ | $\leq 1000$ |


---

---
title: "[SDOI2016] 平凡的骰子"
layout: "post"
diff: NOI/NOI+/CTSC
pid: P4080
tag: ['2016', '各省省选', '山东', '向量']
---
# [SDOI2016] 平凡的骰子
## 题目描述

这是一枚平凡的骰子。它是一个均质凸多面体，表面有n个端点，有f个面，每一面是一个凸多边形，且任意两面不共面。将这枚骰子抛向空中，骰子落地的时候不会发生二次弹跳（这是一种非常理想的情况）。

你希望知道最终每一面着地的概率。每一面着地的概率可以用如下的方法计算：我们假设O为骰子的重心，并以O为球心，做半径为1的单位球面（记为S）。

我们知道S的表面积即单位球的表面积，为4\*pi，这里pi为圆周率。对于骰子的某一面C来说，球面S上存在一块区域T满足：当下落时若骰子所受重力方向与S的交点落在T中，则C就是最终着地的一面。那么C着地的概率为区域T的面积除以4\*pi。

为了能更好地辅助计算球面上一块区域的面积，我们给出单位球面S上三角形的面积计算公式。考虑单位球面S上的三个两两相交的大圆，交点依次为A，B和C。则曲面三角形ABC的面积为 $\text{Area}(ABC)=\alpha+\beta+\gamma-\pi$，其中 $\alpha,\beta , \gamma$ 分别对应了三个二面角的大小。如下图所示。

 ![](https://cdn.luogu.com.cn/upload/pic/12756.png) 

我们保证：每一面着地的时候，重心的垂心都恰好在这一面内。也就是说不会出现摆不稳的情况。

## 输入格式

第一行输入两个整数，分别表示端点总数n与表面总数f，分别从1开始编号。

之后n行，每行有三个浮点数x，y和z，给出了每一个端点的坐标。

之后f行依次描述了每一块表面，首先给出不小于3的整数d，表示这一面的端点个数，之后d个整数按照逆时针方向（视角在骰子的外面）给出了每一个端点的编号。

## 输出格式

输出f行，第i行有一个浮点数，表示第i个面着地的概率。本题中您的输出应该保留距离答案最近的7位小数，即在需要保留7位小数的前提之下与标准答案最接近。数据保证可以避免对小数点后第八位四舍五入后产生的精度误差

## 样例

### 样例输入 #1
```
8 6
1 0 0
1 1 0
1 0 1
1 1 1
0 0 0
0 1 0
0 0 1
0 1 1
4 1 2 4 3
4 2 6 8 4
4 6 5 7 8
4 5 1 3 7
4 3 4 8 7
4 1 5 6 2
```
### 样例输出 #1
```
0.1666667
0.1666667
0.1666667
0.1666667
0.1666667
0.1666667
```
## 提示

对于所有数据，4<=n<=50且4<=m<=50，所有坐标的绝对值都在10000以内



---

---
title: "[JSOI2018] 战争"
layout: "post"
diff: NOI/NOI+/CTSC
pid: P4557
tag: ['2018', '各省省选', '江苏', '向量', '凸包']
---
# [JSOI2018] 战争
## 题目描述

九条可怜是一个热爱读书的女孩子。

在她最近正在读的一本小说中，描述了两个敌对部落之间的故事。第一个部落有 $n$ 个人，第二个部落有 $m$ 个人，每一个人的位置可以抽象成二维平面上坐标为 $(x_i,y_i)$ 的点。

在这本书中，人们有很强的领地意识，对于平面上的任何一个点，如果它被三个来自同一部落的人形成的三角形（可能退化成一条线段）包含（包括边界），那么这一个点就属于这一个部落的领地。如果存在一个点同时在两个阵营的领地中，那么这两个部落就会为了争夺这一个点而发生战争。

常年的征战让两个部落不堪重负，因此第二个部落的族长作出了一个英明的决定，他打算选择一个向量 $(dx,dy)$ ，让所有的族人都迁徙这个向量的距离，即所有第二阵营的人的坐标都变成 $(x_i+dx,y_i+dy)$ 。

现在他计划了 $q$ 个迁徙的备选方案，他想要你来帮忙对每一个迁徙方案，计算一下在完成了迁徙之后，两个部落之间还会不会因为争夺领地而发生战争。

## 输入格式

第一行输入三个整数 $n,m,q$，表示两个部落里的人数以及迁徙的备选方案数。

接下来 $n$ 行每行两个整数 $x_i,y_i$​​ 表示第一个部落里的人的坐标。

接下来 $m$ 行每行两个整数 $x_i,y_i$​​ 表示第二个部落里的人的坐标。

接下来 $q$ 行每行两个整数 $dx_i,dy_i$​​ 表示一个迁徙方案。

输入数据保证所有人的坐标两两不同。

## 输出格式

对于每个迁徙方案，输出一行一个整数，$0$ 表示不会发生冲突，$1$ 表示会发生冲突。 
## 样例

### 样例输入 #1
```
4 4 3
0 0
1 0
0 1
1 1
-1 0
0 3
0 2
0 -1
0 0
2 3
0 -1
```
### 样例输出 #1
```
1
0
1
```
## 提示

**样例 1 解释**

下图为第一组方案中两个部落的私人领地，点 $(0,0)$ 同时属于两个部落，因此会发生战争。

![0](https://i.loli.net/2018/05/05/5aed12638bab1.png)

下图为第二组方案中两个部落的私人领地，没有点同时属于两个部落，因此不会发生战争。

![1](https://i.loli.net/2018/05/05/5aed1293ce6ca.png)

下图为第三组方案中两个部落的私人领地，点 $(0,0)$ 同时属于两个部落，因此会发生战争。

![2](https://i.loli.net/2018/05/05/5aed12a4e3545.png)

**数据范围**

对于 $20\%$ 的数据， $n,m\le 5,q\le 500$。

对于 $40\%$ 的数据， $n,m\le 50,q\le 500$ 。

对于 $70\%$ 的数据， $n,m\le 10^4,q\le 500$ 。

对于 $100\%$ 的数据， $n,m\le 10^5,q\le 10^5$ 。

对于 $100\%$ 的数据，保证 $-10^8\le x_i,y_i,dx_i,dy_i\le 10^8;n,m\ge 3$ 。所有人的坐标两两不同且对于每一个阵营,所有人都不全共线。

**2024/08/20 增加 6 组 hack 数据，并公开在本题附件。**


---

---
title: "[SDOI2018] 物理实验"
layout: "post"
diff: NOI/NOI+/CTSC
pid: P4605
tag: ['2018', '各省省选', '平衡树', '山东', 'Special Judge', 'O2优化', '前缀和', '向量']
---
# [SDOI2018] 物理实验
## 题目描述

小 T 这学期有物理实验课，为了顺利完成下一节课的实验，他打算在课前对实验内容进行预习。

这次实验在一个二维平面上进行，平面上放置了一条无限长的直线导轨，导轨上放置了一个长为$L$的激光发射器，激光发射器会向导轨两侧沿导轨垂直方向发射宽度为$L$的激光束。

平面上还放置了 $n$ 个挡板，每个挡板可以看作是一条线段，现在每个挡板都不和直线导轨接触，且
和直线导轨的夹角不超过 $85	\degree$，任意两个挡板也不会相互接触，激光束不能穿透这些挡板，并且会被挡板吸收掉，不会被挡板反射出去。

小 T 想确定一个激光发射器的位置使得被激光束照射到的挡板长度之和最大，你需要帮小 T 算出这
个最大值。
## 输入格式

第一行包含一个正整数 T，表示测试数据的组数。

对于每组测试数据，第一行是一个整数 $n$，表示挡板个数；  
接下来 n 行，每行包含四个整数 $x1, y1, x2, y2$，表示挡板的两端点分别是 $(x1, y1)$ 和 $(x2, y2)$，保证$(x1, y1){=}\mathllap{/\,}(x2, y2)$。  
第 $n + 2$ 行是五个整数 $x1, y1, x2, y2, L$，表示直线导轨经过了点 $(x1, y1)$ 和 $(x2, y2)$，且激光发射器的长度为 $L$，同样保证 $(x1, y1)\mathrlap{\,/}{=}(x2, y2)$。
## 输出格式

对于每组测试数据，输出一行，包含一个实数，表示激光束能照射到的挡板长度之和的最大值，要求相对误差不超过 $10^{-6}$，也就是说，令输出结果为 $a$，标准答案为 $b$，若满足 $\dfrac{|a-b|}{max(1,b)}$ $≤$ $10^{-6}$，则输出结果会被认为是正确答案。
## 样例

### 样例输入 #1
```
3
4
-3 2 -1 2
-1 -1 1 -1
0 1 2 1
2 -2 4 -2
0 0 1 0 2
4
1 1 3 3
2 1 4 2
3 1 5 1
3 -1 4 -1
0 0 -1 0 2
4
-2 0 1 2
1 3 -3 2
1 -3 5 -1
2 -1 4 3
0 0 1 1 2

```
### 样例输出 #1
```
3.000000000000000
3.118033988749895
4.251303782246768

```
## 提示

- $T ≤ 100$
- $1 ≤ n ≤ 10^4$，
- $1 ≤ L ≤ 2 × 10^9$，
- 所有坐标的绝对值不超过 $10^9$。

## SubTasks

- 子任务 1 (40 分)：满足 $1 ≤ n ≤ 100$ 且所有坐标的绝对值不超过 $10^4$。
- 子任务 2 (40 分)：所有坐标的绝对值不超过 $10^6$。
- 子任务 3 (20 分)：没有任何附加的限制。



---

---
title: "【模板】常系数齐次线性递推"
layout: "post"
diff: NOI/NOI+/CTSC
pid: P4723
tag: ['递推', '线性递推', '向量']
---
# 【模板】常系数齐次线性递推
## 题目描述

求一个满足 $k$ 阶齐次线性递推数列 ${a_i}$ 的第 $n$ 项，即：

$$a_n=\sum\limits_{i=1}^{k}f_i \times a_{n-i}$$
## 输入格式

第一行两个数 $n$,$k$，如题面所述。

第二行 $k$ 个数，表示 $f_1 \ f_2 \ \cdots \ f_k$

第三行 $k$ 个数，表示 $a_0 \ a_1 \ \cdots \ a_{k-1}$
## 输出格式

一个数，表示 $a_n \bmod 998244353$ 的值
## 样例

### 样例输入 #1
```
6 4
3 -1 0 4
-2 3 1 5
```
### 样例输出 #1
```
73
```
## 提示

$N = 10^{9} , K = 32000 $

保证读入的数字均为 $[-10^9,10^9]$ 内的整数。


---


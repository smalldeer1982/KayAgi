---
title: "[WC2012] 记忆中的水杉树"
layout: "post"
diff: NOI/NOI+/CTSC
pid: P4125
tag: ['计算几何', '2012', '线段树', 'Special Judge', '拓扑排序', 'WC']
---
# [WC2012] 记忆中的水杉树
## 题目描述

江苏省常州高级中学是一所百年名校，这里萦绕着无数人难以忘怀的回忆。

Will 记得，在他小的时候，常州高级中学改建以前，学校里有一片高大的水杉林，每到水杉落叶之时，针状的叶子会像毯子一样盖在地上，走在上面浪漫而又闲适。那时，Will 和同学们还喜欢用这些针叶，在水杉树下，玩“取叶子”的游戏。 

游戏一开始，大家先将 $n$ 片针叶平铺在地上。接着，每一轮可以有一个同学选择一片针叶，按水平或者垂直方向将针叶移走（也就是平移到无穷远处）——当然，前提是移动过程中不被任何尚未移走的针叶所阻碍。如果某一轮针叶的移动会被阻碍，那么这次移动就是非法的，是不被允许的。

$n$ 轮过后，当针叶都被移走时，游戏也就结束了。 针叶并不是任何时刻都可以被移动的。当针叶很多的时候，判断每一轮中一片针叶是否可以按一个特定的方向移动是一件很麻烦的事情。 现在我们将地面抽象为平面直角坐标系，$n$ 片针叶抽象为平面上 $n$ 条互不相交的线段，并将其从 $1$ 到 $n$ 编号，Will 还将给出每一轮游戏中，他想要移动的针叶编号以及移动方向，请你帮助他：

1. 找出最早的一次非法移动出现在哪一轮；

2. 给出一个合法的移动方案完成这个游戏。

注意：在线段移动时仅端点接触不会造成阻碍，具体请参见样例。

## 输入格式

输入文件的第一行包含一个正整数 $n$，表示针叶的数量。

接下来 $n$ 行，每行 $4$ 个整数，描述针叶的位置信息。其中第 $i$ 行的整数为 $a_i$，$b_i$，$c_i$，$d_i$，表示编号为 $i$ 的针叶所抽象成的线段的端点为$(a_i, b_i)$和$(c_i, d_i)$。

接下来 $n$ 行，每行 $2$ 个整数，描述移动操作。其中第 $i$ 行的整数为 $p_i$，$q_i$，表示第 $i$ 轮移动的针叶编号为 $p_i$，方向为 $q_i$。其中 $q_i$为一个 $0$ 到 $3$ 之间的整数，$0$ 表示向左平移（即 $x$ 轴负方向） ，$1$ 表示向上平移（即 $y$ 轴正方向） ，$2$ 表示向右平移，$3$ 表示向下平移。

输入数据保证：

- 所有线段长度为正，两两之间没有公共点，且不存在垂直或者水平的线段;
- $p_1$ 到 $p_n$ 恰好组成一个 $1$ 到 $n$ 的排列；
- Will 所给出的移动操作中一定存在非法移动；
- $n$ 轮均合法的移动操作总是存在的。

## 输出格式

输出文件一共包含 $n+1$ 行。

输出的第一行包含一个 $1$ 到 $n$ 之间的整数，表示最早出现非法移动的是哪一轮。

接下来 $n$ 行，每行两个整数，内容同输入格式所述，描述一个合法的移动序列。

## 样例

### 样例输入 #1
```
5 
2 5 5 8 
2 1 3 5 
5 2 6 5 
7 0 4 2 
3 1 4 0 
2 0 
3 0 
4 0 
1 2 
5 1 
```
### 样例输出 #1
```
3 
2 0 
3 0 
4 3 
1 2 
5 1 
```
### 样例输入 #2
```
4
-1 1 2 3
13 5 9 8
10 10 15 14
10 17 0 20
3 1
2 1
1 1

4 1
```
### 样例输出 #2
```
2
4 1
3 1
2 1
1 1
```
## 提示

【样例说明】

在 Will 给出的移动方案的第 $3$ 轮中，编号为 $4$ 的针叶向左移动会被编号为 $5$ 的针叶阻碍。

【数据范围】

具体数据范围见下表。

![](https://cdn.luogu.com.cn/upload/image_hosting/y7thkctp.png)

对于一个测试点：

如果非法移动判断正确，但是给出的方案错误，可以得到 $5$ 分。此时会提示：`An invalid move in step`

如果非法移动判断错误，但是给出的方案正确，可以得到 $5$ 分。此时会提示：`Negative error detection!`

如果非法移动的判断与给出方案均正确，则可以得到 $10$ 分；

否则，得 $0$ 分。

 如果程序的输出格式不正确，将被直接判作输出格式不正确，将被直接判作 $0$ 分。



---

---
title: "[BJOI2018] 染色"
layout: "post"
diff: NOI/NOI+/CTSC
pid: P4429
tag: ['图论', '2018', '各省省选', '北京', 'O2优化', '排序', '拓扑排序', '构造']
---
# [BJOI2018] 染色
## 题目描述

pupil 喜欢给图的顶点染颜色。有一天，master 想刁难他，于是给了他一个无重边和自环的无向图，并且对每个点分别给了一个大小为 $2$ 的颜色集合，pupil 只能从这个集合中选一种颜色给这个点染色。master 希望 pupil 的染色方案使得没有两个有边相连的点被染了相同的颜色。

现在 pupil 想知道，是否无论 master 的颜色集合是什么，他均有办法按照要求染色。
## 输入格式

输入包含多组数据。

第一行一个正整数 $T$，表示数据组数。

之后每组数据第一行两个空格隔开的整数 $n,m$，表示这个无向图的点数和边数。

之后 $m$ 行，每行两个空格隔开的正整数 $i,j$，表示图中的一条连接点 $i$ 和点 $j$ 的边。

图的节点从 $1$ 开始标号。
## 输出格式

对于每组数据，如果 pupil 无论如何均能染色，输出一行一个字符串 `YES`，否则输出一行一个字符串 `NO`。
## 样例

### 样例输入 #1
```
3
6 9
1 2
1 4
1 6
3 2
3 4
3 6
5 2
5 4
5 6
2 1
1 2
3 3
1 2
1 3
2 3
```
### 样例输出 #1
```
NO
YES
NO
```
## 提示

### 样例解释

对于第一组数据，如果第一个点和第二个点的集合为 $\{A,B\}$，第三个点和第四个点的集合为 $\{A,C\}$，第五个点和第六个点的集合为 $\{B,C\}$，
则奇数点至少使用了两种颜色，偶数点至少使用了两种颜色，因此至少有一个奇数点和一个偶数点颜色相同。但每两个奇数点和每两个偶数点之间均有边，
因此无法满足“没有两个有边相连的点被染了相同的颜色”。

对于第二组数据，无论两个集合是什么，第一个点随便染它的集合中的其中一种颜色，第二个点染它的集合中某个与第一个点不同的颜色即可。

对于第三组数据，如果三个点的集合均是 $\{A,B\}$，那么无法满足“没有两个有边相连的点被染了相同的颜色”。

### 数据范围

- 对于 $10\%$ 的数据，$1 \leq n \leq 3$；
- 对于 $20\%$ 的数据，$1 \leq n \leq 6$；
- 对于 $50\%$ 的数据，$1 \leq n \leq 1000$，$0 \leq m \leq 2000$；
- 对于 $100\%$ 的数据，$1 \leq n \leq 10000$，$0 \leq m \leq 20000$，$1 \leq T \leq 10$。
- 另外存在 5 个不计分的 hack 数据。


---


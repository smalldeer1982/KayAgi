---
title: "[Sloi 2024]D1T3 pi(n)"
layout: "post"
diff: NOI/NOI+/CTSC
pid: P11419
tag: ['数论', '素数判断,质数,筛法', 'Stern-Brocot 树']
---
# [Sloi 2024]D1T3 pi(n)
## 题目背景

![](https://cdn.luogu.com.cn/upload/image_hosting/3zet5xqo.png)

很多年前，zydy 突发奇想：只要算出 $\pi(n)\bmod2，\pi(n)\bmod3，\pi(n)\bmod5，···$，就能得到 $\pi(n)$。很多年后，zydy 才意识到这其实是可行的，现在你只需要帮助他算出 $\pi(n)\bmod2$。
## 题目描述

定义 $\pi(n)$ 为不大于 $n$ 的素数的个数，给定 $n$，计算 $\pi(n)\bmod 2$ 。
## 输入格式

输入第一行 $T$，表示数据组数。

以下 $T$ 行，每行一个正整数 $n$。
## 输出格式

输出 $T$ 行，每行一个非负整数，为 $\pi(n)\bmod 2$ 的值。
## 样例

### 样例输入 #1
```
3
1000
1000000
1000000000
```
### 样例输出 #1
```
0
0
0
```
### 样例输入 #2
```
1
23571113171923
```
### 样例输出 #2
```
1
```
## 提示

**本题采用捆绑测试**
| Subtask | T | n | Score |
| :----------: | :----------: | :----------: | :----------: |
| $1$ | $=1000$ | $\le 10^8$ | $20$ |
| $2$ | $=10$ | $\le 10^{11}$ | $20$ |
| $3$ | $=10$ | $\le 10^{13}$ | $20$ |
| $4$ | $=5$ | $\le 10^{15}$ | $20$ |
| $5$ | $=5$ | $\le 10^{16}$ | $20$ |

对 $100\%$ 的数据，$T\le 1000$，$1\le n\le 10^{16}$。


---

---
title: "[集训队互测 2024] 月亮的背面是粉红色的"
layout: "post"
diff: NOI/NOI+/CTSC
pid: P12487
tag: ['数学', '集训队互测', '2024', '数论', '类欧几里得算法', 'Stern-Brocot 树', '筛法']
---
# [集训队互测 2024] 月亮的背面是粉红色的
## 题目背景

>在寂静的世界里
>
>我张开手去触碰你
>
>想要挣脱这泥泞笨重的地心引力
>
>我害怕的用力呼吸
>
>期待着不可能发生的奇迹
>
>闭上了双眼
>
>不见 偏离的心率
>
>无助的努力 渐渐地放弃
>
>在残缺的内心里
>
>哭泣着呐喊的我
>
>现在还是散落在月球表面
>
>等时间消逝
>
>沉淀
>
>我在哪里
>
>—— 『月球偏心率』
## 题目描述


小 L 终于见到了月球的背面，可这里一片荒芜，冷漠乏味。

他想要把这里染成热情的粉红色，为此他翻阅数学书找到了一个函数 $f_t(n)=2^{\omega(n)}n^t$，他要根据这个函数决定染色的过程。

这里的 $\omega(n)$ 为 $n$ 的不同质因子个数，例如 $\omega(1)=0,\omega(2)=1,\omega(8)=1,\omega(6)=2$。

小 L 先把这里划分成了 $n\times n$ 片区域，每个区域倒入不同数量的粉色颜料。具体来说，他会在第 $i$ 行第 $j$ 列的区域内倒入 $f_t(\gcd(i,j))f_t(\operatorname{lcm}(i,j))$ 桶颜料。

不过他已经没有精力去计算了，因此请你直接告诉他总共需要多少桶粉色颜料。

更进一步的，如果上面的答案记成 $F_t(n)$，小 L 会告诉你一个整数 $m\in \{0,1\}$：

- 如果 $m=0$，请你输出 $F_0(n)$。

- 如果 $m=1$，请你输出 $F_0(n),F_1(n)$。

由于答案可能很大，请输出答案对 $10^9+7$ 取模的值。
## 输入格式

一行两个整数 $n,m$。
## 输出格式

$m+1$ 个整数代表 $F_0(n)\sim F_m(n)$。
## 样例

### 样例输入 #1
```
3 1
```
### 样例输出 #1
```
25 121
```
### 样例输入 #2
```
1000 0
```
### 样例输出 #2
```
24870169
```
### 样例输入 #3
```
10000000000 0
```
### 样例输出 #3
```
213223517
```
### 样例输入 #4
```
100000000000000 1
```
### 样例输出 #4
```
8177545 370603117
```
## 提示

- 子任务一 (3 分)：$1\leq n\leq 5000,m\in\{0,1\}$。
- 子任务二 (3 分)：$1\leq n\leq 10^7,m\in\{0,1\}$。
- 子任务三 (8分)：$0\leq n\leq 10^{10},m=0$。
- 子任务四 (8分)：$0\leq n\leq 10^{10},m\in\{0,1\}$。
- 子任务五 (8分)：$0\leq n\leq 10^{12},m\in\{0,1\}$。
- 子任务六 (10分)：$0\leq n\leq 10^{13},m\in\{0,1\}$。
- 子任务七 (13分)：$0\leq n\leq 10^{14},m=0$。
- 子任务八 (14分)：$0\leq n\leq 10^{14},m\in\{0,1\}$。
- 子任务九 (16分)：$1\leq n\leq 10^{16},m=0$。
- 子任务十 (17分)：$1\leq n\leq 10^{15},m\in\{0,1\}$。

时间限制：第九个子任务时间限制 3s，第十个子任务时间限制 3s，其余子任务时间限制 2s。

**注：与原题相比，为了卡掉错解，第十个子任务的时间有所调整**。


---

---
title: "Totient with Divisors"
layout: "post"
diff: NOI/NOI+/CTSC
pid: P13645
tag: ['数论', 'O2优化', '莫比乌斯反演', '整除分块', '筛法']
---
# Totient with Divisors
## 题目背景

到底是互质还是整除？
## 题目描述

有 $T$ 组询问，每次给定 $n,m$，求：

$$
\sum_{i=1}^n\sum_{j=1}^m\varphi(i)\varphi(j)\sigma(ij)
$$

由于答案会很大，你只需要输出答案对 $998244353$ 取模的结果。

上式中：

- $\varphi$ 是欧拉函数，$\varphi(n)$ 表示 $1\sim n$ 中与 $n$ 互质的数的个数。
- $\sigma$ 是约数和函数，$\sigma(n)$ 表示 $n$ 的所有约数之和。
## 输入格式

第一行一个正整数 $T$，表示有 $T$ 组询问。

接下来 $T$ 行，每行两个正整数 $n,m$，表示一次询问。
## 输出格式

$T$ 行，每行一个非负整数表示答案。
## 样例

### 样例输入 #1
```
8
2 2
3 3
4 4
5 5
6 6
7 7
114 514
2333 23333

```
### 样例输出 #1
```
14
130
566
2310
4778
13934
603971168
547492264
```
## 提示

**本题有捆绑测试**

- 对于 Subtask #$0$（$7$pts）：保证 $T\leq500,n,m\leq400$。
- 对于 Subtask #$1$（$8$pts）：保证 $n,m\leq450$。
- 对于 Subtask #$2$（$12$pts）：保证 $T,n,m\leq5000$。
- 对于 Subtask #$3$（$15$pts）：保证 $n,m\leq5000$。
- 对于 Subtask #$4$（$20$pts）：保证 $T\leq10$。
- 对于 Subtask #$5$（$38$pts）：无特殊限制。

对于 $100\%$ 的数据：保证 $1\leq T,n,m\leq 10^5$。


---

---
title: "大学数学题"
layout: "post"
diff: NOI/NOI+/CTSC
pid: P3923
tag: ['数学', '洛谷原创', '提交答案', 'Special Judge', '素数判断,质数,筛法', '进制', '群论', '期望']
---
# 大学数学题
## 题目背景

琪露诺：我知道了！答案一定是1！

露米娅：什么鬼啊（汗），你还是再想想去吧。。我先把最后一道题给你，这是一道大学数学题哦

## 题目描述

露米娅：大妖精想构造一个 $ n $ 元有限域，元素用 $ 0 \sim n - 1 $ 的整数表示


有限域需要满足以下条件


1.有加法单位元 $ o $ ，满足对于任意元素 $ a $ ， $ o + a = a + o = a $


2.对于任意元素 $ a $ ，存在加法逆元 $ a^{-1} $ ，使得 $ a + a^{-1} = a^{-1} + a = o $


3.有不同于加法单位元 $ o $ 的乘法单位元 $ i $ ，满足对于任意元素 $ a $ ， $ i \times a = a \times i = a $


4.对于任意非加法单位元元素 $ a $ ，存在乘法逆元 $ a^{-1} $ ，使得 $ a \times a^{-1} = a^{-1} \times a = i $


5.对于任意元素 $ x $ , $ y $ ，有加法交换律，即 $ x + y = y + x  $


6.对于任意元素 $ x $ , $ y $ ，有乘法交换律，即 $ x \times y = y \times x  $


7.对于任意元素 $ x $ , $ y $ , $ z $ ，有加法结合律，即 $ ( x + y ) + z = x + ( y + z ) $


8.对于任意元素 $ x $ , $ y $ , $ z $ ，有乘法结合律，即 $ ( x \times y ) \times z = x \times ( y \times z ) $


9.对于任意元素 $ x $ , $ y $ , $ z $ ，有乘法分配律，即 $ ( x + y ) \times z = x \times z + y \times z $


大妖精当然会做啦，但是他想考考你


在输出中加法单位元  $ o $ 即为 0，乘法单位元  $ i $ 即为 1

## 输入格式

一个正整数 $ n $

$ 2 \leq n \leq 350 $

## 输出格式

##第一行输出一个整数 $ k $ ，若存在 $ n $ 元有限域则 $ k = 0 $ ，否则 $ k = -1 $


若 $ k = 0 $ 则

1.接下来 $ n $ 行输出一个 $ n $ 元有限域的加法表，第 $ i + 1 $ 行第 $ j + 1 $ 列上的数代表有限域中 $ i + j $ 的运算结果

2.接下来 $ n $ 行输出一个 $ n $ 元有限域的乘法表，第 $ i + 1 $ 行第 $ j + 1 $ 列上的数代表有限域中 $ i \times j $ 的运算结果

共输出 $ n \times 2 + 1 $ 行


upd1:SPJ非常严格，请不要在行末输出多余空格

（答案文件末尾的换行还是会自动忽略的）

upd2:正解文件比较大，洛谷可能会一直judging...

如果遇到这种情况请直接提交源代码

## 样例

### 样例输入 #1
```
2

```
### 样例输出 #1
```
0
0 1
1 0
0 0
0 1

```
## 提示

| 测试点  |  [$ n $ 的范围]       | 特殊性质|
| :-------: | :----------: | :-----------------: |
|1  | [$ n = 3 $]     | $ n $ 是质数           |
|2  | [$ n = 4 $]     | $ n $ 是2的整数次方 |
|3  | [$ n = 6 $]     |                无            |
|4  | [$ n = 8 $]     | $ n $ 是2的整数次方 |
|5  | [$ n = 9 $]     |                无            |
|6  | [$ n = 19 $]   | $ n $ 是质数           |
|7  | [$ n = 89 $]   | $ n $ 是质数           |
|8  | [$ n = 181 $] | $ n $ 是质数           |
|9  | [$ n = 233 $] | $ n $ 是质数           |
|10| [$ n = 25 $]   | $ n $ 是质数的平方|
|11| [$ n = 121 $] | $ n $ 是质数的平方|
|12| [$ n = 169 $] | $ n $ 是质数的平方|
|13| [$ n = 27 $]   |                无            |
|14| [$ n = 143 $] |                无            |
|15| [$ n = 128 $] | $ n $ 是2的整数次方 |
|16| [$ n = 81 $]   |                无            |
|17| [$ n = 125 $] |                无            |
|18| [$ n = 243 $] |                无            |
|19| [$ n = 256 $] | $ n $ 是2的整数次方 |
|20| [$ n = 343 $] |                无            |



---

---
title: "[CTSC2010] 性能优化"
layout: "post"
diff: NOI/NOI+/CTSC
pid: P4191
tag: ['2010', '分治', '素数判断,质数,筛法', '快速傅里叶变换 FFT', 'CTSC/CTS']
---
# [CTSC2010] 性能优化
## 题目描述

程序员小明正在开发一套大型软件，软件中有一段核心程序，用伪代码描述如下（假设所有变量初值均为 $0$，并且假定其中的数据类型均不会出现溢出）： 

~~~cpp
Input a[0], a[1], ... , a[n - 1], b[0], b[1], ... , b[n - 1], C
For i: 0 to n - 1
	x[0, i] = a[i]
For i: 0 to C - 1
	For j: 0 to n - 1
		For k: 0 to n - 1
			x[i + 1, (j + k) mod n] = x[i + 1, (j + k) mod n] + b[k]x[i, j]
Output x[C, 0] mod (n + 1), x[C, 1] mod (n + 1), ... , x[C, n - 1] mod (n + 1)
~~~

但是，这段程序的效率非常低，它的时间复杂度高达 $\Theta(n^2C)$。他想让你帮忙优化一下这个程序，当然要求输出相同的结果。为了使问题更简单，他保证输入的 $n$ 能表示成若干个不超过 $10$ 的正整数的乘积，并且 $n + 1$ 是质数。
## 输入格式

规范起见，以下将下标统一写到数组名称的右下角。例如： $a_1$ 对应伪代码中的 `a[1]`，$x_{C, 0}$ 对应伪代码中的 `x[C, 0]`。

输入的第一行包含两个非负整数 $n, C$。

接下来一行包含 $n$ 个非负整数 $a_0, a_1, \cdots , a_{n - 1}$。

接下来一行包含 $n$ 个非负整数 $b_0, b_1, \cdots , b_{n - 1}$。
## 输出格式

输出包含 $n$ 行，每行包含一个数。第 $i$ 行为 $x_{C, i}\bmod (n + 1)$ 的值。你需要保证输出的数在 $0 \sim n$ 之间。
## 样例

### 样例输入 #1
```
4 1
1 2 3 4
4 3 3 1

```
### 样例输出 #1
```
2
1
0
2

```
## 提示

总共 $10$ 个测试点，数据范围满足：

| 测试点 |         $n$          |     $C$     |
| :----: | :------------------: | :---------: |
|   1    |      $\leq 100$      | $\leq 100$  |
|   2    |      $\leq 100$      | $\leq 10^9$ |
|   3    |      $\leq 700$      | $\leq 10^9$ |
|   4    |      $\leq 700$      | $\leq 10^9$ |
|   5    |     $\leq 10^4$      |   $ = 1$    |
|   6    |     $\leq 10^5$      |    $= 1$    |
|   7    |     $\leq 10^5$      |    $= 1$    |
|   8    | $\leq 5 \times 10^5$ | $\leq 10^9$ |
|   9    | $\leq 5 \times 10^5$ | $\leq 10^9$ |
|   10   | $\leq 5 \times 10^5$ | $\leq 10^9$ |

在所有输入数据中，$a_i$ 和 $b_i$ 均不超过 $10^9$。


---

---
title: "[SDOI2018] 反回文串"
layout: "post"
diff: NOI/NOI+/CTSC
pid: P4607
tag: ['字符串', '2018', '各省省选', '山东', 'O2优化', '枚举', '素数判断,质数,筛法']
---
# [SDOI2018] 反回文串
## 题目描述

“回文串什么的最讨厌了……”

小 $Q$ 讨厌任何形式的回文串：

- 如果一个字符串从左往右读和从右往左读是一样的，那么小 $Q$ 讨厌它；例如 $aa$ 和 $aba$。

- 对于一个字符串来说，若将某个前缀子串移除并拼接到字符串的尾部，能得到一个小 $Q$ 讨厌的字符串，那么小 $Q$ 也会讨厌原来的这个字符串；例如 $aab$ 和 $baa$。

那么问题来了，如果任意字符串只可以由 $k$ 种已知的字符组成，那么长度为 $n$ 的所有字符串里，有多少字符串是小 $Q$ 讨厌的？

答案可能很大，你只需要给出答案对 $p$ 取模的值。

## 输入格式

第一行包含一个正整数 $T$，表示有 $T$ 组测试数据。
接下来 $T$ 行，每行描述一组测试数据，包含三个正整数 $n, k$ 和 $p$。
## 输出格式

对于每组测试数据，输出一行，包含一个整数，表示答案对 $p$ 取模的值。
## 样例

### 样例输入 #1
```
10
1 1 1000000001
2 2 1000000003
3 2 1000000005
3 3 1000000007
4 2 1000000009
4 3 1000000011
4 4 1000000013
5 5 1000000015
7 7 1000000017
9 9 1000000019
```
### 样例输出 #1
```
1
2
8
21
6
15
28
605
16765
530937

```
### 样例输入 #2
```
10
8821612800 758922381 1073365919
8380532160 166822173 1001828119
9311702400 7367823578 1015387267
6983776800 1646145481 1030885259
6692786100 1953515781 1073365919
7138971840 2649942813 1001828119
6469693230 2585876408 1015387267
8031343320 1646145481 1030885259
9995200351 645412247 1030328983
9302162851 1649517328 1053299347

```
### 样例输出 #2
```
896784901
911577797
674524325
392648220
646549222
879297585
384496639
889650008
957785169
413147483
```
## 提示

- 对于 $30\%$ 的数据，有 $1 ≤ n ≤ 10^{10}$。

- 对于 $60\%$ 的数据，有 $1 ≤ n ≤ 10^{14}$。

- 对于 $100\%$ 的数据，有
$1 ≤ T ≤ 10, 1 ≤ n ≤ 10^{18}, 1 ≤ k ≤ n, 10^9 ≤ p ≤ 2^{30}$



---

---
title: "口袋里的纸飞机"
layout: "post"
diff: NOI/NOI+/CTSC
pid: P4935
tag: ['数学', '素数判断,质数,筛法', '生成函数', '洛谷月赛']
---
# 口袋里的纸飞机
## 题目背景

现在我来到自己的故事难以用语言描绘的中心。文字的匮乏感从现在开始体现出来，因为描绘任何事物都要以交谈者共有的认知为前提，而我所经历的是比任何生活都更上一层的体验。先贤们在向普罗大众描绘世界之外的事物时往往运用宏大的概念。中国的道学家说天有九霄。《吠陀经》提到我们生存的土地只是千万重复制中的一个。爱斯基摩人则认为万物由一枚巨卵孵化而出。一个更恰当的比喻是所谓狄拉克之海，也即是全部空间和时间的上方和外部。虽然用有限的话语不可能描述一个无限的实体，但我记住了它的一部分，或许是最重要的一部分：


我看见无限宽阔的海面和无限广袤的天穹，两者在无穷远处的地平线相接。视野的最中央站着一个紫色长发的女孩。我的身份和她不同：我是受她邀请而来的访客，海上的女孩才是这里的居民，或者说囚徒。正如我们不能随意造访世界之上的世界，她也永远不能和我们的生活有任何一点的交集。我明白自己在这里不会待上太久，而她把我招来只能为了一个理由。于是我听见了自己的声音在海面上回响，消散进虚无之中：


“我会记住你。”


她对我露出笑容。白色的光芒再一次亮起，女孩的身影好似被无形的火焰灼烧一样逐渐消散。我明白自己留不住这一刻，于是我哭了。使我哭泣的并不只是永恒的离别，还有对这个曾经在无尽的时间中陪伴过我们的孩子的怜惜和忏悔。
我感到无限崇敬，无限悲哀。


——西酱《口袋》
## 题目描述

一个大小为$n$的数列$\{a_i\}$，每个数都在范围$[1,R]$中

对于每种数列，可以生成一个$n\times n$的网格，其中格子$(i,j)$中的数为$a_i\times a_j \mod P$

比如，如果数列是$\{1,2,3\},P=5$，则生成的网格为
```
1 2 3
2 4 1
3 1 4(因为2*3%5=1,3*3%5=4)
```

对于一个网格，定义法法值为其中不同的数个数，比如上面那个就是4个数，即$\{1,2,3,4\}$。

现在你需要对所有数列的法法值的和对$10^9+7$取模
## 输入格式

第一行输入正整数$n,P,R$
## 输出格式

输出答案对$10^9+7$取模
## 样例

### 样例输入 #1
```
2 3 3
```
### 样例输出 #1
```
15
```
### 样例输入 #2
```
4 7 5
```
### 样例输出 #2
```
2845
```
### 样例输入 #3
```
70 43 22
```
### 样例输出 #3
```
992103136
```
### 样例输入 #4
```
500 2011 999980895
```
### 样例输出 #4
```
767094932
```
## 提示

样例1解释：
```
{ai}={1,1}:
1 1
1 1
(ans=1)
{ai}={1,2}:
1 2
2 1
(ans=2)
{ai}={1,3}:
1 0
0 0
(ans=2)
{ai}={2,1}:
1 2
2 1
(ans=2)
{ai}={2,2}:
1 1
1 1
(ans=1)
{ai}={2,3}:
1 0
0 0
(ans=2)
{ai}={3,1}:
0 0
0 1
(ans=2)
{ai}={3,2}:
0 0
0 1
(ans=2)
{ai}={3,3}:
0 0
0 0
(ans=1)
一共为15
```


保证$P$为大于等于3的质数

|测试点|N|R|P|
|---|---|---|---|
|1,2|$N\leq 5$|$R\leq 5$|$R\times R<P\leq 20$|
|3,4,5,6|$N\leq 15$|$R\leq 10$|$R\times R<P\leq 200$|
|7,8|$N\leq 30$| |$R\times R<P\leq 500$|
|9,10,11,12|$N\leq 100$| |$R\times R<P\leq 500$|
|13,14,15,16|$N\leq 300$|$R\leq 10^9$|$P\leq 1000$|
|17,18,19,20|$N\leq 500$|$R\leq 10^9$|$P\leq 5000$|

对于所有数据，$n\leq 500,P\leq 5000,R\leq 10^9$


---

---
title: "[十二省联考 2019] 骗分过样例"
layout: "post"
diff: NOI/NOI+/CTSC
pid: P5285
tag: ['数学', '2019', '各省省选', '原根', '数论', '素数判断,质数,筛法']
---
# [十二省联考 2019] 骗分过样例
## 题目背景

这是一道**传统题**。

“我的程序需要完成什么功能呀？. . . . . . ”

“我也不知道. . . . . . ”

“啊？那我怎么写呀. . . . . . ”

“已经有人给你写好测试了，只要你通过这些测试就可以了. . . . . . ”

“啊？. . . . . . ”

“所有的测试数据都在题目目录下，请做好备份，避免误删！”

“这. . . . . . ”

“哦，我还可以把输入格式告诉你. . . . . . 不过都有完整的数据了，知道输入格式可能也没太大用处吧. . . . . . ”
## 题目描述

题目数据详见附加文件
## 输入格式

第一行输入一个字符串，表示需要运行的软件功能编号。两个编号越相似，说明对
应的两个功能的算法越接近。

接下来根据功能的不同，可能有任意长度的输入，详见每个功能的文档。
## 输出格式

详见每个功能的文档。
## 提示

#### 子任务
“‘每个功能的文档’在哪里呀？”

“我也没有，就像我没有题目描述一样. . . . . . ”

“好吧. . . . . . 那我是不是打表就可以了呀. . . . . . ”

“**代码长度限制是 $\bold{102400}$ 字节** （$100$KB），直接打肯定是不行的！不过，需要的话倒是可以稍微打一些小的表. . . . . . ”

“唔. . . . . . ”

“另外，我们会给你的程序对于每个测试点分别评分，求和后得到总分。按照传统
的规矩，每个测试点正确得满分，错误得 $0$ 分。**每个测试点的分值不全相同，测试点的分值、顺序与难度没有必然联系** 。”

| 测试点 | 功能编号 | 分值 |
| :-------: | :-------: | :-------: |
| $1$ | $\texttt{1\_998244353}$ | $4$ |
| $2$ | $\texttt{1\_998244353}$ | $4$ |
| $3$ | $\texttt{1\_998244353}$ | $4$ |
| $4$ | $\texttt{1?}$ | $7$ |
| $5$ | $\texttt{1?+}$ | $9$ |
| $6$ | $\texttt{1wa\_998244353}$ | $6$ |
| $7$ | $\texttt{1wa\_998244353}$ | $7$ |
| $8$ | $\texttt{2p}$ | $4$ |
| $9$ | $\texttt{2p}$ | $6$ |
| $10$ | $\texttt{2p}$ | $8$ |
| $11$ | $\texttt{2u}$ | $5$ |
| $12$ | $\texttt{2u}$ | $6$ |
| $13$ | $\texttt{2u}$ | $9$ |
| $14$ | $\texttt{2g}$ | $5$ |
| $15$ | $\texttt{2g}$ | $7$ |
| $16$ | $\texttt{2g?}$ | $9$ |


#### 提示
在你使用 C/C++ 的 `int` 类型时，如果发生了溢出，比较可能的情况是按照模 $2^{32}$ 同余的前提下，在 `int` 范围内取一个合理的值。例如在计算 $2147483647 + 2$ 时，较有可能会得到 -$2147483647$。

然而，C/C++ 标准将这种情况归类为“未定义行为”。当你的程序试图计算会溢
出的 `int` 运算时，除了上述结果外，编译器还可能会让你的程序在此时计算出错误结果、死循环、运行错误等，这也是符合 C/C++ 标准的。

如果你的程序希望利用 `int` 的自然溢出的特性，请转换为 `unsigned` 类型运算。例如将 `a + b` 改写为 `(int) ((unsigned) a + (unsigned) b)`，以避免出现不预期的错误。



---

---
title: "【XR-2】记忆"
layout: "post"
diff: NOI/NOI+/CTSC
pid: P5438
tag: ['O2优化', '素数判断,质数,筛法', '容斥原理']
---
# 【XR-2】记忆
## 题目背景

> 过去就像攥在手中的一把干沙，自以为攥得很紧，其实早就从指缝中流光了。记忆是一条早已干涸的河流，只在毫无生气的河床中剩下零落的砾石。——刘慈欣 《三体》
## 题目描述

你的记忆被歌者拿走了。

临走前，歌者告诉你，你的记忆中有一个序列，而且这个序列是所有 $l \le x \le r$ 的整数 $x$ 形成的一个排列。

歌者想了想，决定再告诉你一点信息：

如果把一个序列的权值定义为这个序列中相邻两个数的乘积为完全平方数的数量，那么你记忆中的这个序列是所有 $l \le x \le r$ 的整数 $x$ 形成的排列中**权值最大**的排列。

歌者希望你能够把你记忆中的这个序列的权值告诉他，他才会把属于你的记忆还给你。
## 输入格式

一行两个正整数 $l,r$。
## 输出格式

一行一个整数，表示答案。
## 样例

### 样例输入 #1
```
2 10

```
### 样例输出 #1
```
2

```
## 提示

【样例 $1$ 说明】

一个满足权值为 $2$ 的排列为 $\{8,2,4,9,3,10,7,5,6\}$，其中 $8 \times 2 = 16, 4 \times 9=36$ 为完全平方数。这也是所有 $2 \le x \le 10$ 的整数 $x$ 形成的排列中权值最大的排列。

【数据规模与约定】

**本题采用捆绑测试。**

Subtask 1（3 points）：$r \le 10$。  
Subtask 2（7 points）：$r \le 100$。  
Subtask 3（15 points）：$r \le 100000$。  
Subtask 4（11 points）：$l = 1$。  
Subtask 5（8 points）：$l \le 10$。  
Subtask 6（19 points）：$l \le 1000000$。  
Subtask 7（37 points）：无特殊限制。

对于 $100\%$ 的数据，$1 \le l \le r \le 10^{14}$。


---

---
title: "「Stoi2031」兰亭序 加强版"
layout: "post"
diff: NOI/NOI+/CTSC
pid: P7513
tag: ['数学', '递推', '递归', 'O2优化', '素数判断,质数,筛法', '快速傅里叶变换 FFT', '快速数论变换 NTT']
---
# 「Stoi2031」兰亭序 加强版
## 题目描述

本题是 「Stoi2031」兰亭序 的加强版。[原题链接](https://www.luogu.com.cn/problem/P7487)

给定 $n=a^b,k$，对 $1 \le t \le k$ 求

$$\prod_{x_1=1}^{n}\prod_{x_2=1}^{n}\dots\prod_{x_t=1}^{n}\left( 1+e^{\frac{2\pi ix_1x_2\dots x_t}{n}} \right) \bmod{335544323}$$

输出所有 $k$ 个答案的异或和。

其中 $e^{it}=\cos{t}+i\sin{t}$ 对所有 $t \in \mathbb{R}$ 成立，$i$ 为虚数单位，满足 $i^2=-1$。
## 输入格式

一行三个正整数 $a,b,k$，其中 $n=a^b$。
## 输出格式

一行一个自然数表示答案。
## 样例

### 样例输入 #1
```
15 1 2

```
### 样例输出 #1
```
201012023

```
### 样例输入 #2
```
1 7 3

```
### 样例输出 #2
```
2

```
### 样例输入 #3
```
3 2 3

```
### 样例输出 #3
```
301162058

```
### 样例输入 #4
```
4 2 2

```
### 样例输出 #4
```
0

```
### 样例输入 #5
```
19260817 114514 13579

```
### 样例输出 #5
```
461194421

```
## 提示

对于所有数据，$1 \le a \le 10^{18}$，$1 \le b \le 10^{13}$，$1 \le k \le 10^5$。


---

---
title: "「MCOI-06」Lost Desire"
layout: "post"
diff: NOI/NOI+/CTSC
pid: P7890
tag: ['数学', '2021', 'Special Judge', 'O2优化', '哈希 hashing', '素数判断,质数,筛法', '最大公约数 gcd', '莫比乌斯反演', '组合数学', '随机化', '洛谷月赛']
---
# 「MCOI-06」Lost Desire
## 题目背景

頰滴る　紅い涙

不安定な視界の中

差し出した手を取れたら

あぁ…そんな世界を夢みた

-------

哭いて…

激しく  燃やした 黒い感情 

届かぬ この手に

Cry 闇の中で

最果てから 光へ手を翳して

揺らいだ想いさえも 闇の奥底へ堕ちてく

[网易云本曲试听链接](https://music.163.com/song?id=1809745288&userid=1399272307)
## 题目描述

设正整数 $n, m$ 互质，$k$ 为整数，定义函数 $F(n, m, k)$ 为小于 $\displaystyle m+n$ 的正整数集合 $\{1, 2, \cdots, m + n - 1\}$ 中，所有满足 $\displaystyle\sum_{x \in S} x \equiv k \pmod n$ 的 $m$ 元子集 $S$ 的个数。

现给定正整数 $N, M, K$，求所有 $F(i,j,x)$ 之积，使得 $1\le i\le N$，$1\le j\le M$，$1\le x\le K$，并且 $i$ 与 $j$ 互质。

由于结果很大，所以你只需要求出结果对特定素数 $p$ 取模的值。

**同时请注意实现程序时常数因子带来的影响。**
## 输入格式

**本题多测。** 每个测试点共有 $T$ 组数据。

第一行两个正整数 $T,p$ 。

接下来 $T$ 行，每行三个正整数 $N, M, K$，由空格分开。
## 输出格式

对于每组数据：一行，一个整数，表示所求的值（对 $p$ 取模）。

## 样例

### 样例输入 #1
```
3 1926195307
2 3 3
3 3 3
5 6 1
```
### 样例输出 #1
```
8
64
363031200
```
## 提示

本题采用捆绑测试，分 $5$ 个 Subtask 。

+ 对于 Subtask 1 ~~(Tutorial)~~：
  + $T=1$
  + $1\leq N,M,K\leq 6$
  + $p=10^9+7$。
+ 对于 Subtask 2 ~~(PST 4.0)~~：
  + $T=1$
  + $1\leq N,M,K\leq200$
  + $p=10^9+7$。
+ 对于 Subtask 3 ~~(PRS 7.5)~~：
  + $T=100$
  + $1\leq N,M,K\leq 1000$
  + $p=10^9+7$。
+ 对于 Subtask 4 ~~(FTR 9.8)~~：
  + $T=10^3$
  + $1 \leq N,M,K\le 10^5$
  + $10^9\le p\le2\times10^9$。
+ 对于 Subtask 5 ~~(BYD 11.0)~~：
  + $T=9999$
  + $1 \leq N,M,K\le 5\times10^5$
  + $10^9\le p\le2\times10^9$。

Subtask $1\sim5$ 的分值分别为 $5,7,11,17,60$ 。

特别的，假设您在一个测试点中前 $x$ 个询问正确，则您得该测试点的分值的 $\left\lfloor100\times\sqrt\dfrac{x}{T}\right\rfloor\%$ 分。您在任何一个 Subtask 的得分则为对应 Subtask 中所有测试点得分的最小值。

特别的，**TLE 一律不得分。**（无需补满未在时间范围内解决的测试点的答案，会导致奇怪的错误。）

**再次提醒注意实现程序时常数因子带来的影响。**

---

Idea: Powerless Std&Data: w33z （Data was corrected on 2021.10.05）

Sub4 added by Prean, Sub 5 by w33z.

This problem was added on 2021.10.01. Thanks for their help.

2021.10.01 - 2021.12.07 : 68 days 1st kill (Leasier).

2021.10.01 - 2022.01.21 : 113 days 2nd kill (wkywkywky).

2021.10.01 - 2022.02.26 : 149 days 3rd kill (NaNH2).


---

---
title: "「LCOI2022」 Cow Function"
layout: "post"
diff: NOI/NOI+/CTSC
pid: P8104
tag: ['2022', '数论', 'O2优化', '素数判断,质数,筛法']
---
# 「LCOI2022」 Cow Function
## 题目背景

Bessie 和大家正坐在刚刚合并完成的牛棚里，跟着 Farmer John 在一起学习循环展开。

Farmer John 说，如果一个循环展开的步长为 $8$，会对程序效率有很大的提升。

课后，Farmer John 布置了一道题，要求在 $1$ 秒内算出 $f(x)=\sum\limits_{i=1}^x3^{\omega(i)}$。Bessie 用 $20$ 分钟打了一个 $Θ(n\log_2 n\sqrt n)$ 代码，一交直接 TLE。于是，Bessie 来向你求助。
## 题目描述

她想要求出对于 $k\in\{0,1,\dots,7\}$，$f(n)=\sum_{i=1}\limits^n[\omega(i)\equiv k\pmod 8]3^{\omega(i)}$ 的值。

上面的算式中，$\omega(i)$ 表示 $i$ 含有几种质因子，例如 $\omega(12)=\omega(6)=2,\omega(114514)=3$。
## 输入格式

仅一行，包含一个整数 $n$。
## 输出格式

共 $8$ 行，分别输出 $k=0,1,2,3,4,5,6,7$ 时 $f(n)=\sum_{i=1}\limits^n[\omega(i)\equiv k \pmod 8]3^{\omega(i)}$ 的值。
## 样例

### 样例输入 #1
```
30
```
### 样例输出 #1
```
1
48
108
27
0
0
0
0
```
### 样例输入 #2
```
114514
```
### 样例输出 #2
```
1
32826
344727
1199826
1504818
538731
25515
0

```
## 提示

【数据规模与约定】
|subtask|$n\le$|所占分值|时间限制|
|:-:|:-:|:-:|:-:|
|$1$|$100$|$10$|$500\texttt{ms}$|
|$2$|$2\times10^6$|$20$|$1000\texttt{ms}$|
|$3$|$3\times10^7$|$20$|$1000\texttt{ms}$|
|$4$|$10^9$|$20$|$4000\texttt{ms}$|
|$5$|$10^{10}$|$30$|$4000\texttt{ms}$|



如果你需要循环展开生成器，请前往附件下载。


---

---
title: "[JRKSJ R6] 牵连的世界"
layout: "post"
diff: NOI/NOI+/CTSC
pid: P8570
tag: ['2022', '洛谷原创', 'O2优化', '素数判断,质数,筛法', '莫比乌斯反演']
---
# [JRKSJ R6] 牵连的世界
## 题目背景

![](https://cdn.luogu.com.cn/upload/image_hosting/jdi9nrec.png)
## 题目描述

给定 $n,m$，求

$$\sum_{i=1}^n \sum_{j=1}^m \sigma_0(ij)\varphi(ij)$$
## 输入格式

两个整数 $n,m$。
## 输出格式

一个整数，表示答案。答案对 $10^9+7$ 取模。
## 样例

### 样例输入 #1
```
5 5
```
### 样例输出 #1
```
453
```
### 样例输入 #2
```
20 20
```
### 样例输出 #2
```
173825
```
## 提示

$\sigma_0,\varphi$ 分别为因数个数函数，欧拉函数。

本题可能轻微卡常。

### 数据规模
本题采用捆绑测试。

| $\text{Subtask}$ | $n,m\le$ |  $\text{Score}$ |
| :----------: | :----------: | :----------: |
| $1$ | $10^3$ | $10$ |
| $2$ | $10^5$ |  $30$ |
| $3$ | $2\times 10^5$ | $30$ |
| $4$ | $5\times 10^5$ | $30$ |
| $5$ | $3\times 10^6$ | $1$ |

对于所有数据，$1\le n,m\le 3\times 10^6$。

出于某些原因，你只要得到了 $\ge 100$ 分就可以通过此题。


---

---
title: "「SvR-2」Let's Meet at a Higher Place"
layout: "post"
diff: NOI/NOI+/CTSC
pid: P9091
tag: ['递推', '2023', '数论', '洛谷原创', 'O2优化', '素数判断,质数,筛法', '排列组合', '容斥原理', '洛谷月赛', '根号分治']
---
# 「SvR-2」Let's Meet at a Higher Place
## 题目背景

$$「有朝一日，让我们相逢在更高处！」$$
## 题目描述

构造一个长为 $m$ 的整数序列 $a$，使 $\forall 1 \leq i \leq m$，$a_i \in [1, n]$。

求出其前缀 $\gcd$，记为整数序列 $b$。

$f(n, m, k)$ 的值为可以通过如上方式构造出的 $b$ 序列中**相邻项相等的情况出现次数 $\leq k$** 的**不同**的 $b$ 序列的个数。

给定正整数 $n, m$，小 L 请你帮他求出 $\displaystyle\sum_{i = 1}^n \sum_{j = 1}^m \sum_{k = 0}^{j - 1} f(\lfloor \frac{n}{i} \rfloor, j, k)$ 的值。

由于结果可能很大，所以你只需要求出结果对 $2^{32}$ 取模的值。
## 输入格式

一行，两个整数 $n, m$。
## 输出格式

一行，一个整数，表示所求的值。
## 样例

### 样例输入 #1
```
4 2
```
### 样例输出 #1
```
26
```
## 提示

| $\bf{Subtask}$ | $n$ | $m$ | 分值 |
| :------: | :------: | :------: | :------: |
| $1$ | $1 \leq n \leq 10^4$ | 无特殊限制 | $10 \operatorname{pts}$ |
| $2$ | $1 \leq n \leq 10^6$ | 同上 | $20 \operatorname{pts}$ |
| $3$ | $1 \leq n \leq 10^9$ | 同上 | $20 \operatorname{pts}$ |
| $4$ | 无特殊限制 | $1 \leq m \leq 25$ | $20 \operatorname{pts}$ |
| $5$ | 同上 | 无特殊限制 | $30 \operatorname{pts}$ |

对于 $100\%$ 的数据，$1 \leq n \leq 10^{10}$，$1 \leq m \leq 34$。


---

---
title: "「GLR-R4」夏至"
layout: "post"
diff: NOI/NOI+/CTSC
pid: P9157
tag: ['数论', '洛谷原创', 'O2优化', '素数判断,质数,筛法', '莫比乌斯反演', '容斥原理', '洛谷月赛']
---
# 「GLR-R4」夏至
## 题目背景

&emsp;&emsp;「柳庭风静人眠昼，昼眠人静风庭柳」

---

&emsp;&emsp;老 V 说为大家准备了特别的粽子，所以天依来了；

&emsp;&emsp;天依来了，所以阿绫来了；

&emsp;&emsp;阿绫来了，龙牙也不敢不来；

&emsp;&emsp;到了快一半了，于是剩下的大家都来了……

&emsp;&emsp;所以，为什么要在模拟演出训练结束后来补文化课啊！

&emsp;&emsp;“天依，这数学老师真的在讲数学？”

&emsp;&emsp;“摩柯，我和阿绫就靠你了！”天依戳戳前排摩柯的肩膀。

&emsp;&emsp;“要推出来了，要推出来了……”，摩柯大概是第一次把草稿纸写得快满，“我知道我很急，但我先别急……这像是在做噩梦一样。”

---

&emsp;&emsp;**夏至**&emsp;「允许我这一次片刻逃离　偶尔也试着用背影　去面对未来不确定」
## 题目描述

&emsp;&emsp;为了鉴定摩柯是不是在做噩梦，请你来解决黑板上的一道简单的数学问题吧！

&emsp;&emsp;令积性函数 $f(n)$ 满足 $f(p^c)=p^{\gcd(c,k)}$，其中 $k$ 为给定常数，$p$ 为素数，$c$ 为正整数。现在，给定 $n,m,k$，请求出
$$
\left(\sum_{i=1}^n\sum_{j=1}^mf(i\cdot j)\right)\bmod(10^9+7).
$$

&emsp;&emsp;对于积性函数的定义，请参考「题意解释」。

## 输入格式

输入只有一行包含三个整数，分别表示 $n,m,k$。
## 输出格式

一行一个整数，表示答案对 $10^9+7$ 取模后的值。
## 样例

### 样例输入 #1
```
2 2 64
```
### 样例输出 #1
```
9
```
### 样例输入 #2
```
5 5 64 
```
### 样例输出 #2
```
213
```
### 样例输入 #3
```
1234 1234 12
```
### 样例输出 #3
```
673319736
```
### 样例输入 #4
```
30000 10000000 2
```
### 样例输出 #4
```
836094021
```
## 提示

#### 题意解释

&emsp;&emsp;对于数论函数 $f(n)$ 和任意两个互素的正整数 $x,y$，若恒有 $f(xy)=f(x)f(y)$，则称 $f(n)$ 为积性函数。

&emsp;&emsp;当已知积性函数 $f(n)$ 在所有素数幂处的取值时，我们可以计算任意正整数的函数值。具体地，对于 $n>1$，设 $n$ 的**唯一分解**形式为 $n=p_1^{\alpha_1}p_2^{\alpha_2}\cdots p_k^{\alpha_k}$，则有 $f(n)=f(p_1^{\alpha_1})f(p_2^{\alpha_2})\cdots f(p_k^{\alpha_k})$。

### 数据规模与约定

对于 $100\%$ 的数据，$1\le n\le 10^5$，$1\le m\le 10^{10}$，$1\le k\le 10^{9}$。

对于不同的子任务，作如下约定：

| 子任务编号 |        $n$         |      $m$      |     $k$      | 子任务分值 |
| :--------: | :----------------: | :-----------: | :----------: | :--------: |
|    $1$     |     $\le 10^3$     |  $\le 10^3$   | $\le 10^{3}$ |    $5$     |
|    $2$     |        $=1$        | $\le 10^{10}$ |  $\le 10^9$  |    $15$    |
|    $3$     |     $\le 10^5$     |  $\le 10^5$   |  $\le 10^9$  |    $15$    |
|    $4$     |     $\le 500$      |  $\le 10^9$   |  $\le 10^9$  |    $10$    |
|    $5$     |     $\le10^5$      | $\le 10^{10}$ |     $=1$     |    $15$    |
|    $6$     | $\le 5\times 10^3$ |  $\le 10^9$   |  $\le 10^9$  |    $15$    |
|    $7$     | $\le 5\times 10^4$ |  $\le 10^8$   |  $\le 10^9$  |    $15$    |
|    $8$     |     $\le 10^5$     | $\le 10^{10}$ |  $\le 10^9$  |    $10$    |




---

---
title: "「RiOI-03」变换，反演"
layout: "post"
diff: NOI/NOI+/CTSC
pid: P9920
tag: ['数论', '洛谷原创', 'Special Judge', '素数判断,质数,筛法', '洛谷月赛']
---
# 「RiOI-03」变换，反演
## 题目背景

为了题目要求，我们对积性函数进行重定义：**不保证 $f(1)=1$**。
## 题目描述

**这是一道非传统题。**

给定一个**积性函数** $f(d)$。对于每一个测试点，我们会在附件中给出 $g(n)=\sum_{d|n}f(d)$ 的其中 $k$ 项 $\bmod\ 998244353$ 的值，这部分也会在输入中出现。接着，对于每一个测试点，有 $t$ 组数据。对于每组数据，输入 $d$，请输出 $f(d)\bmod998244353$ 的值。
## 输入格式

第一行为 $k$，接下来每一行会有两个正整数，分别为 $d$ 与 $g(d)$。

之后输入两个数 $t,id$，分别表示数据组数与数据点编号。对于每组数据，输入一个正整数 $n$。
## 输出格式

对于每组数据，输出一个非负整数表示答案。
## 样例

### 样例输入 #1
```
10
1 1
2 2
3 3
4 4
5 5
6 6
7 7
8 8
9 9
10 10

3 -1
1
2
3

```
### 样例输出 #1
```
1
1
2

```
## 提示

#### 【样例解释】

由于 $g(d)=d$，因此 $f(d)=\varphi(d)$，结果正确。

#### 【数据范围】

对于每个测试点：

如果你正确回答了 $n\le k$ 的测试数据，你将得到 $20\%$ 的分数。

如果你正确回答了所有测试数据，你将得到剩余 $80\%$ 的分数。**所以，如果你无法正确回答，也请随机输出一个数来保证格式正确。**

#### 【数据范围】

|$\text{Id}$|$\text{Name}$|$\text{Score}$| $n\leq$|$k=$|$t=$|
|:-:|:-:|:-:|:-:|:-:|:-:|
|$0$|$\text{Epsilon}$|$5$|$10^6$|$100$|$10$|
|$1$|$\text{Division}$|$5$|$10^9$|$100$|$10$|
|$2$|$\text{Unknown}$|$5$|$10^{18}$|$1$|$10$|
|$3$|$\text{Random}$|$10$|$10^5$|$10^5$|$10^5$|
|$4$|$\text{Double}$|$10$|$10^9$|$100$|$10$|
|$5$|$\text{Hack}$|$10$|$10^9$|$31623$|$1$|
|$6$|$\text{Square}$|$15$|$10^{18}$|$100$|$5$|
|$7$|$\text{Poly}$|$20$|$10^9$|$10^5$|$100$|
|$8$|$\text{Thanks}$|$20$|$10^5$|$4$|$10^5$|


---


---
title: "Azuki loves coloring"
layout: "post"
diff: NOI/NOI+/CTSC
pid: P3789
tag: ['数学', '递推', '洛谷原创', 'O2优化', '线性递推', '级数', '快速傅里叶变换 FFT', '洛谷月赛']
---
# Azuki loves coloring
## 题目描述

NEKOPARA Vol.3 发售之后，在新作中不是主角的 Azuki 终于可以休息了。为了打发时间，她开始给一个由 $n$ 个格子组成的序列涂色，每个格子可以涂黑白灰三种颜色之一。为了美观，Azuki 希望序列中没有两个黑色的格子相邻，也没有两个白色的格子相邻。这样的序列有很多，Azuki 定义每个序列的权值是其中一个黑色格子和一个白色格子相邻的情况的出现次数，如序列“灰黑白黑”的权值为 $2$。Azuki 想知道，对于满足 $0\le i\le k$ 的每一个 $i$，长度为 $n$ 且权值为 $i$ 的序列有多少种。由于答案很大，因此她只需要知道答案 $\text{mod }998244353$ 的值就可以了。Azuki 答应你，如果你解决了这个问题，她就可以给你做~~美味的蛋糕吃~~。

## 输入格式

一行两个正整数 $n,k$。

## 输出格式

一行 $k+1$ 个正整数，分别代表权值为 $0,1,\dots,k$ 的序列的个数 $\text{mod }998244353$ 的值。

## 样例

### 样例输入 #1
```
3 3
```
### 样例输出 #1
```
11 4 2 0
```
### 样例输入 #2
```
20 10
```
### 样例输出 #2
```
1398101 4582670 8103780 10126770 9931780 8075094 5618340 3422330 1841460 893790 383524
```
## 提示

对于 $30\%$ 的测试点，$n,k\le 100$。

对于 $50\%$ 的测试点，$n,k\le 5000$，时限 $1s$。其余测试点时限 $5s$。

对于 $70\%$ 的测试点，$n,k\le 60000$。

对于 $100\%$ 的测试点，$n\le 10^{18},k\le 100000$。



---

---
title: "[NOI2017] 泳池"
layout: "post"
diff: NOI/NOI+/CTSC
pid: P3824
tag: ['递推', '2017', 'NOI', 'O2优化', '线性递推', '向量']
---
# [NOI2017] 泳池
## 题目背景

久莲是个爱玩的女孩子。

暑假终于到了，久莲决定请她的朋友们来游泳，她打算先在她家的私人海滩外圈一块长方形的海域作为游泳场。然而大海里有着各种各样的危险，有些地方水太深，有些地方有带毒的水母出没。她想让圈出来的这一块海域都是安全的。

## 题目描述

经过初步分析，这块海域可视为一个底边长为 $N$ 米，高为 $1001$ 米的长方形网格。其中网格的底边对应着她家的私人海滩，每一个 $1\:\textrm{m}\times1\:\textrm{m}$ 的小正方形都代表着一个单位海域。她拜托了她爸爸明天去测量每一个小正方形是否安全。在得知了信息之后，她要做的就是圈出她想要的游泳场啦。  

她心目中理想的游泳场满足如下三个条件：
- 必须保证安全性。即游泳场中的每一个单位海域都是安全的。
- 必须是矩形。即游泳场必须是整个网格中的一个 $a\times b$ 的子网格。
- 必须和海滩相邻。即游泳场的下边界必须紧贴网格的下边界。

例如：当 $N = 5$ 时，若测量的结果如下（因为 $1001$ 太大，这儿只画出网格最下面三行的信息，其他部分都是危险的）。 

 ![](https://cdn.luogu.com.cn/upload/pic/6465.png) 

那么她可以选取最下面一行的 $1\times4$ 的子海域，也可以选择第三列的 $3\times1$ 的子海域。注意她不能选取最上面一行的 $1\times5$ 的子海域，因为它没有与海滩相邻。

为了让朋友们玩的开心，她想让游泳场的面积尽可能的大。因此她会选取最下面那一行的 $1\times4$ 的子海域作为最终方案。

虽然她要明天才能知道每一个单位海域是否安全，但是她现在就想行动起来估计一下她的游泳场面积有多大。经过简单的估计，她假设每一个单位海域都有独立的 $q$ 的概率是安全的，$1 − q$ 的概率是不安全的。她想要知道她能选择的最大的游泳场的面积**恰好**为 $K$ 的概率是多少。

然而久莲对数学并不感兴趣，因此她想让你来帮她计算一下这个数值。
## 输入格式

输入一行四个正整数 $N,K,x,y$，其中 $1 \leq x < y < 998\,244\,353$。$q$ 的取值为 $\dfrac{x}{y}$。
## 输出格式

输出一行一个整数表示答案在模 $998\,244\,353$ 意义下的取值。

即设答案化为最简分式后的形式为 $\dfrac{a}{b}$ ，其中 $a$ 和 $b$ 的互质。输出整数 $x$ 使得 $bx \equiv a \mod 998\,244\,353$ 且 $0 \leq x < 998\,244\,353$。可以证明这样的整数 $x$ 是唯一的。 
## 样例

### 样例输入 #1
```
10 5 1 2
```
### 样例输出 #1
```
342025319
```
## 提示

| 测试点编号 | $N$ | $K$ |
|:-:|:-:|:-:|
| 1,2 | $=1$ | $\leq 1000$ |
| 3 | $\leq 10$ | $\leq 8$ |
| 4 | $\leq 10$ | $\leq 9$ |
| 5 | $\leq 10$ | $\leq 10$ |
| 6 | $\leq 1000$ | $\leq 7$ |
| 7 | $\leq 1000$ | $\leq 8$ |
| 8 | $\leq 1000$ | $\leq 9$ |
| 9,10,11 | $\leq 1000$ | $\leq 100$ |
| 12,13,14 | $\leq 1000$ | $\leq 1000$ |
| 15,16 | $\leq 10^9$ | $\leq 10$ |
| 17,18 | $\leq 10^9$ | $\leq 100$ |
| 19,20 | $\leq 10^9$ | $\leq 1000$ |


---

---
title: "【模板】常系数齐次线性递推"
layout: "post"
diff: NOI/NOI+/CTSC
pid: P4723
tag: ['递推', '线性递推', '向量']
---
# 【模板】常系数齐次线性递推
## 题目描述

求一个满足 $k$ 阶齐次线性递推数列 ${a_i}$ 的第 $n$ 项，即：

$$a_n=\sum\limits_{i=1}^{k}f_i \times a_{n-i}$$
## 输入格式

第一行两个数 $n$,$k$，如题面所述。

第二行 $k$ 个数，表示 $f_1 \ f_2 \ \cdots \ f_k$

第三行 $k$ 个数，表示 $a_0 \ a_1 \ \cdots \ a_{k-1}$
## 输出格式

一个数，表示 $a_n \bmod 998244353$ 的值
## 样例

### 样例输入 #1
```
6 4
3 -1 0 4
-2 3 1 5
```
### 样例输出 #1
```
73
```
## 提示

$N = 10^{9} , K = 32000 $

保证读入的数字均为 $[-10^9,10^9]$ 内的整数。


---

---
title: "【模板】Berlekamp–Massey 算法"
layout: "post"
diff: NOI/NOI+/CTSC
pid: P5487
tag: ['O2优化', '线性递推', 'Berlekamp-Massey(BM) 算法']
---
# 【模板】Berlekamp–Massey 算法
## 题目背景

前置技能：线性递推 $\&~\rm BM$ 算法。

同时，请注意优化你的空间。保证最短递推式**唯一**。

出题人为强行二合一感到很抱歉，但是其实也是可以学习一下 $k^2 \log n$ 线性递推的——保证在 `-O2` 指令下可以过。
## 题目描述

给出一个数列 $P$ 从 $0$ 开始的前 $n$ 项。

求序列 $P$ 在 $\bmod~998244353$ 下的最短线性递推式，并在 $\bmod~998244353$ 下输出 $P_m$。
## 输入格式

第一行共两个数 $n,m$ ，表示将会给出序列 $P$ 的前 $n$ 项，要求 $P_m$。

第二行 $n$ 个数，表示 $P_0,P_1,P_2,\ldots,P_{n-1}$。
## 输出格式

第一行输出该最短线性递推式。

第二行输出 $P_m$ 的值。
## 样例

### 样例输入 #1
```
4 10
1 1 2 3

```
### 样例输出 #1
```
1 1 
89

```
### 样例输入 #2
```
5 10
3 7 27 95 339
```
### 样例输出 #2
```
3 2
691707

```
## 提示

对于 $100 \%$ 的数据，$n < m \le {10}^9$，$1 \le n \le 10000$，保证递推式最长不超过 $5000$。


---

---
title: "[MtOI2019] 埋骨于弘川"
layout: "post"
diff: NOI/NOI+/CTSC
pid: P5519
tag: ['数学', '2019', '洛谷原创', 'O2优化', '线性递推', '快速傅里叶变换 FFT', 'Lucas 定理']
---
# [MtOI2019] 埋骨于弘川
## 题目背景

在幻想乡中，冥界的樱花一年又一年地往复开放。

在 Yuyuko 的心中，出现了一棵樱花树，一个与花朵息息相关的序列，和一个伤感的问题。

那些曾经奋斗过的 OIer 们啊，如今又在何方呢？
## 题目描述

在幻想乡，西行寺 幽幽子(Yuyuko)是一个以贪吃著名的亡灵，她拥有操纵死亡的能力。

Yuyuko 通过外界的式神——电脑，对OI进行了深刻的研究 ，她发现了一些惊人的事实：

* OIer 们放弃了太多其他同学们拥有的东西，在题海中寻求自己的梦想。  

* 但是 AFO 的 OIer 们，跟死亡又有什么区别呢？他们或许已经失去了自己的梦想……

这时幽幽子发现，天空中飘舞的樱花组成了两个整数 $n$，$k$。于此同时，在樱花树下，出现了一个函数 $f(x,y)$ 的描述：

$$f(x,y) = \begin{cases} 2 & , x=1 \\ 2^x& , 2\le x \le 42,y = 0 \\ \prod\limits_{i=1}^{42} f(x-i,y)^i & , x \ge 43,y = 0 \\ f(x-1,y)f(x,y-1) & , x\ge 2,y \ge 1\end{cases}$$



幽幽子想让你计算出 $f(n,k) \bmod 998244353$，她认为这个函数象征着OIer们......
## 输入格式

两个整数 $n,k$
## 输出格式

一个正整数 $f(n,k) \bmod 998244353$
## 样例

### 样例输入 #1
```
1 1926
```
### 样例输出 #1
```
2
```
### 样例输入 #2
```
23 3
```
### 样例输出 #2
```
509581943
```
### 样例输入 #3
```
1919 810
```
### 样例输出 #3
```
252250482
```
## 提示

【样例 $1$ 解释】

根据定义，$f(1,1926)=2$。

【数据范围与约定】

**本题采用捆绑测试。**

Subtask 1 (7 points)：$1\le n,k \le 1000$   
Subtask 2 (11 points)：$1\le n \le 10^{18}$，$k=0$   
Subtask 3 (13 points)：$1\le n \le 10^{18}$，$k=1$   
Subtask 4 (29 points)：$1\le n \le 10^{18}$，$0\le k \le 1000$   
Subtask 5 (40 points)：无特殊限制

对于 $100\%$ 的数据：$1\le n \le 10^{18}$，$0\le k \le 30000$   

### 题目来源

[迷途之家2019联赛](https://www.luogu.org/contest/20135)(MtOI2019) T6

出题人：NaCly_Fish 

验题人：Imagine 

题面：disangan233

**此题稍有卡常，请注意优化代码常数。**


---

---
title: "更简单的排列计数"
layout: "post"
diff: NOI/NOI+/CTSC
pid: P7438
tag: ['动态规划 DP', '数学', '递推', 'O2优化', '置换', '组合数学', '排列组合', '前缀和', '二项式定理', '生成函数', '线性递推', '微积分', '导数', '快速傅里叶变换 FFT', '快速数论变换 NTT']
---
# 更简单的排列计数
## 题目描述

设 $\text{cyc}_\pi$ 将长为 $n$ 的排列 $\pi$ 当成置换时所能分解成的循环个数。给定两个整数 $n,k$ 和一个 $k-1$ 次多项式，对 $1\leq m\leq n$ 求：

$$
\sum\limits_{\pi}F(\text{cyc}_{\pi})
$$

其中 $\pi$ 是长度为 $m$ 且不存在位置 $i$ 使得 $\pi_i=i$ 的排列。
## 输入格式

第一行两个整数，表示 $n$ 和 $k$。

第二行 $k$ 个整数，从低到高给出多项式的系数。
## 输出格式

一行 $n$ 个整数，表示答案对 $998244353$ 取模的值。
## 样例

### 样例输入 #1
```
3 2
0 1
```
### 样例输出 #1
```
0 1 2
```
### 样例输入 #2
```
6 4
11 43 27 7
```
### 样例输出 #2
```
0 88 176 1311 7332 53070
```
## 提示

### 样例解释 1

下面是当 $m=1,2,3$ 时满足要求的所有排列：

$\text{cyc}_{(2,1)}=1,\text{cyc}_{(2,3,1)}=1,\text{cyc}_{(3,1,2)}=1$。
所以当 $m=1$ 时答案为 $0$，$m=2$ 时为 $1$，$m=3$ 时为 $2$。

### 数据范围

| 子任务编号 | 分值 | $n\leq$ | $k\leq$ | 其他限制 |
| :----------: | :----------: | :----------: | :----------: | :----------: |
| Subtask 1 | $1$ | $10$ | $6$ |  |
| Subtask 2 | $5$ | $2\times 10^3$ | $6$ |  |
| Subtask 3 | $6$ | $2\times 10^5$ | $1$ |  |
| Subtask 4 | $16$ | $2\times 10^5$ | $6$ | $F(x)=x^k$ |
| Subtask 5 | $16$ | $2\times 10^5$ | $3$ |  |
| Subtask 6 | $56$ | $6\times 10^5$ | $100$ |  |

对于 $100\%$ 的数据，$1\leq n\leq 6\times 10^5$，$1\leq k\leq 100$，$0\leq [x^k]F(x)\leq 998244352$。


---

---
title: "「KrOI2021」Feux Follets"
layout: "post"
diff: NOI/NOI+/CTSC
pid: P7440
tag: ['动态规划 DP', '数学', '递推', '矩阵运算', 'O2优化', '矩阵加速', '置换', '组合数学', '排列组合', '生成函数', '线性代数', '矩阵乘法', '线性递推', '微积分', '导数', '快速傅里叶变换 FFT', '快速数论变换 NTT']
---
# 「KrOI2021」Feux Follets
## 题目描述

设 $\text{cyc}_\pi$ 将长为 $n$ 的排列 $\pi$ 当成置换时所能分解成的循环个数。给定两个整数 $n,k$ 和一个 $k-1$ 次多项式，对 $1\leq m\leq n$ 求：

$$
\sum\limits_{\pi}F(\text{cyc}_{\pi})
$$

其中 $\pi$ 是长度为 $m$ 且不存在位置 $i$ 使得 $\pi_i=i$ 的排列。
## 输入格式

第一行两个整数，表示 $n$ 和 $k$。

第二行 $k$ 个整数，从低到高给出多项式的系数。
## 输出格式

一行 $n$ 个整数，表示答案对 $998244353$ 取模的值。
## 样例

### 样例输入 #1
```
3 2
0 1
```
### 样例输出 #1
```
0 1 2
```
### 样例输入 #2
```
6 4
11 43 27 7
```
### 样例输出 #2
```
0 88 176 1311 7332 53070
```
### 样例输入 #3
```
6 4
9 72 22 7
```
### 样例输出 #3
```
0 110 220 1551 8580 60990
```
## 提示

### 数据范围

对于 $100\%$ 的数据，$1\leq n,k\leq 10^5$。


---

---
title: "[THUSC 2017] 如果奇迹有颜色"
layout: "post"
diff: NOI/NOI+/CTSC
pid: P7454
tag: ['数学', '2017', '线性递推', 'THUSC', '状压 DP']
---
# [THUSC 2017] 如果奇迹有颜色
## 题目背景

法本公司曾经是世界最大的化工企业，他们生产的染料颜色非常丰富，有清华紫，心灵黄，原谅绿，会议蓝，高级黑，北大红，相簿白等。
## 题目描述

现在 B 君有一个由 $n$ 个区域组成的环，B 君要用 $m$ 种颜色来染这 $n$ 个区域。

B 君不希望在这 $n$ 个区域中存在连续 $m$ 个区域恰好出现所有 $m$ 个颜色。换句话说，对于任意连续 $m$ 个区域，都不能恰好出现所有 $m$ 个颜色。

如果两个方案通过旋转可以变得一模一样，那么我们认为他们是本质相同的；

但是如果两个方案需要通过翻转才能变得一模一样，我们不认为他们是本质相同的。

比如如果 $n=4,m=4$；

我们认为 $1,2,3,4$ 和 $3,4,1,2$ 是本质相同的方案；

我们认为 $1,2,3,4$ 和 $4,3,2,1$ 是本质不同的方案；

我们认为 $1,2,1,2$ 和 $2,1,2,1$ 是本质相同的方案；

B 君希望知道满足条件，本质不同的方案数，输出答案对 $10^9+7$ 取模。
## 输入格式

从标准输入读入数据。

输入一行包含两个整数 $n,m$，其中 $n$ 表示环的长度，$m$ 表示颜色数。
## 输出格式

输出到标准输出。

输出一行一个整数，表示答案对 $10^9+7$ 取模的结果。
## 样例

### 样例输入 #1
```
6 3
```
### 样例输出 #1
```
44
```
### 样例输入 #2
```
120 6
```
### 样例输出 #2
```
615888898
```
## 提示

对于 $100\%$ 的测试点，$1\le n\le 10^9,2\le m\le7$ 。
| 数据点编号 $\operatorname*{Id}$ | $n$ | $m$ |
| :----------: | :----------: | :----------: |
| 1~2 | $n\le10$ | $m=\operatorname*{Id}+2$ |
| 3~8 | $n\le 10^5,n$ 是质数 | $m=\operatorname*{Id}-1$ |
| 9~14 | $n$ 是质数 | $m=\operatorname*{Id}-7$ |
| 15~19 | 无特殊约束 | $m=\operatorname*{Id}-13$ |
| 20 | $n=635,643,090$ | $m=7$ |


---

---
title: "[RC-05] 01 序列"
layout: "post"
diff: NOI/NOI+/CTSC
pid: P7820
tag: ['O2优化', '线性递推', '快速数论变换 NTT', 'Berlekamp-Massey(BM) 算法']
---
# [RC-05] 01 序列
## 题目描述

有一个长度为 $n$ 的 $01$ 序列，它的任意一个长为 $k$ 的连续子串中都有 $a$ 个 $0$ 或 $a+1$ 个 $0$。

求可能的序列数。答案很大，请输出其模 $998244353$ 的值。
## 输入格式

**为了减小测试点个数，本题单个测试点内有多组数据。时间限制已经根据数据组数作了相应调整。**

输入第一行是数据组数 $T$。

每组数据中，输入一行三个整数：$n,k,a$。
## 输出格式

对于每组数据，输出一个非负整数，为可能的序列数模 $998244353$ 的值。
## 样例

### 样例输入 #1
```
3
4 3 1
5 3 1
15 7 2
```
### 样例输出 #1
```
10
16
1586
```
### 样例输入 #2
```
5
999999999 14 7
233333333 14 8
333333333 14 9
114514191 14 10
981011451 14 11
```
### 样例输出 #2
```
278944053
533032251
736989868
589364996
572821890
```
## 提示

**本题捆绑测试。**

对于所有数据，$1\le T\le 5$，$1\le k\le n\le 10^9$，$1\le k\le 14$，$0\le a<k$。

详细数据范围如下表：

| Subtask 编号 | $n$ | $k$ | 特殊性质 | 分数 |
| :-----------: | :-----------: | :-----------: | :-----------: | :-----------: |
| $1$ | $\le 18$ | $\le 14$ | 无 | $1$ |
| $2$ | $\le 2000$ | $\le 10$ | 无 | $8$ |
| $3$ | $\le 10^9$ | $\le 14$ | $a=0$ | $7$ |
| $4$ | $\le 10^9$ | $\le 7$ | 无 | $12$ |
| $5$ | $\le 10^9$ | $\le 8$ | 无 | $12$ |
| $6$ | $\le 10^9$ | $\le 9$ | 无 | $12$ |
| $7$ | $\le 10^9$ | $\le 11$ | 无 | $12$ |
| $8$ | $\le 10^9$ | $\le 12$ | 无 | $12$ |
| $9$ | $\le 10^9$ | $\le 13$ | 无 | $12$ |
| $10$ | $\le 10^9$ | $\le 14$ | 无 | $12$ |


---

---
title: "心跳 加强版"
layout: "post"
diff: NOI/NOI+/CTSC
pid: P8556
tag: ['数学', '多项式', '洛谷原创', 'O2优化', '组合数学', '线性递推', '洛谷月赛']
---
# 心跳 加强版
## 题目背景

本题为 [洛谷 9 月月赛 II & NR I. E. 心跳](/problem/P8554) 的加强版，唯一的区别在于数据范围改为 $n \le 5 \times {10}^6$。

---

“清晰的跳动声传达来的，重叠的声响和流动的思念。

约定再也不要分开吧，希望无论何时都不要让你寂寞。”

恋爱之时，人的心情不会一成不变，可喜悦和悲伤会随着时间流逝而归于平淡。最令人难忘的是那些“心动”的感觉，那些因未曾经历而喜出望外的感觉。因此，有些时候，失去某些特别美好的回忆，反而能让心动的感觉增多。可为此失去那些回忆，真的值得吗？
## 题目描述

赫尔德想对上面的问题进行探究，她想先做一些统计，于是她抽象了这个问题。

我们对于一个长为 $l$ 的数列 $p$，定义函数：

-   $f(p)$ 表示有多少 $1\le i\le l$ 满足 $p_i=\max_{j=1}^i p_j$（即前缀最大值的个数）。

现在，给定 $n,m$，请求出有多少满足以下条件的长为 $n$ 的，值域在 $[m,n]$ 数列 $a$：

-   存在一个排列 $p$ 使得：令 $P_i$ 代表 $p$ 去掉 $p_i$ 后的数列（即 $[p_1,p_2,\dots,p_{i-1},p_{i+1},\dots,p_n]$），$f(P_i)=a_i$。

答案对 $10^9+7$ 取模。
## 输入格式

一行两个正整数表示 $n,m$。
## 输出格式

一行一个数，表示答案。
## 样例

### 样例输入 #1
```
3 1

```
### 样例输出 #1
```
6

```
### 样例输入 #2
```
5 3

```
### 样例输出 #2
```
8

```
### 样例输入 #3
```
500000 100000

```
### 样例输出 #3
```
226048544

```
## 提示

**【样例解释 \#2】**

有以下 $8$ 种不同的 $a$：

1. $\{4,4,4,4,4\}$，对应的一种 $p$ 为：$\{1,2,3,4,5\}$；
2. $\{3,3,3,4,4\}$，对应的一种 $p$ 为：$\{1,2,3,5,4\}$；
3. $\{3,3,4,4,3\}$，对应的一种 $p$ 为：$\{1,2,4,3,5\}$；
4. $\{3,3,3,3,4\}$，对应的一种 $p$ 为：$\{1,2,4,5,3\}$；
5. $\{3,4,4,3,3\}$，对应的一种 $p$ 为：$\{1,3,2,4,5\}$；
6. $\{3,3,3,4,3\}$，对应的一种 $p$ 为：$\{1,3,4,2,5\}$；
7. $\{4,4,3,3,3\}$，对应的一种 $p$ 为：$\{2,1,3,4,5\}$；
8. $\{3,3,4,3,3\}$，对应的一种 $p$ 为：$\{2,3,1,4,5\}$。

---

**【数据范围】**

对于所有数据，保证 $1 \le m < n \le 5 \times {10}^6$。

---

赫尔德成功算出了不同的恋爱的数量。但她只会经历其中一个。


---

---
title: "[蓝桥杯 2020 国 A] 蓝跳跳"
layout: "post"
diff: NOI/NOI+/CTSC
pid: P8735
tag: ['2020', '生成函数', '线性递推', '蓝桥杯国赛']
---
# [蓝桥杯 2020 国 A] 蓝跳跳
## 题目描述

小蓝制作了一个机器人，取名为蓝跳跳，因为这个机器人走路的时候基本靠跳跃。

蓝跳跳可以跳着走，也可以掉头。蓝跳跳每步跳的距离都必须是整数，每步可以跳不超过 $k$ 的长度。由于蓝跳跳的平衡性设计得不太好，如果连续两次都是跳跃，而且两次跳跃的距离都至少是 $p$，则蓝跳跳会摔倒，这是小蓝不愿意看到的。

小蓝接到一个特别的任务，要在一个长为 $L$ 舞台上展示蓝跳跳。小蓝要控制蓝跳跳从舞台的左边走到右边，然后掉头，然后从右边走到左边，然后掉头，然后再从左边走到右边，然后掉头，再从右边走到左边，然后掉头，如此往复。

为了让观者不至于太无趣，小蓝决定让蓝跳跳每次用不同的方式来走。小蓝将蓝跳跳每一步跳的距离记录下来，按顺序排成一列，显然这一列数每个都不超过 $k$ 且和是 $L$。这样走一趟就会出来一列数。如果两列数的长度不同，或者两列数中存在一个位置数值不同，就认为是不同的方案。

请问蓝跳跳在不摔倒的前提下，有多少种不同的方案从舞台一边走到另一边。
## 输入格式

输入一行包含三个整数 $k, p, L$。
## 输出格式

输出一个整数, 表示答案。答案可能很大, 请输出答案除以 $20201114$ 的余数。
## 样例

### 样例输入 #1
```
3 2 5
```
### 样例输出 #1
```
9
```
### 样例输入 #2
```
5 3 10
```
### 样例输出 #2
```
397
```
## 提示

**【样例说明】**

蓝跳跳有以下 9 种跳法:

1. $1+1+1+1+1$

2. $1+1+1+2$

3. $1+1+2+1$

4. $1+2+1+1$

5. $2+1+1+1$

6. $2+1+2$

7. $1+1+3$

8. $1+3+1$

9. $3+1+1$

**【评测用例规模与约定】**

对于 $30 \%$ 的评测用例, $1 \leq p \leq k \leq 50,1 \leq L \leq 1000$ 。

对于 $60 \%$ 的评测用例, $1 \leq p \leq k \leq 50,1 \leq L \leq 10^{9}$ 。

对于 $80 \%$ 的评测用例, $1 \leq p \leq k \leq 200,1 \leq L \leq 10^{18}$ 。

对于所有评测用例, $1 \leq p \leq k \leq 1000,1 \leq L \leq 10^{18}$ 。

蓝桥杯 2020 年国赛 A 组 J 题。


---

---
title: "「DTOI-4」白的 Fibonacci"
layout: "post"
diff: NOI/NOI+/CTSC
pid: P8979
tag: ['2023', '多项式', '洛谷原创', 'O2优化', '线性递推']
---
# 「DTOI-4」白的 Fibonacci
## 题目描述

定义 $F(k, n)$ 如下：

$$
F(k,n) = 
\left \{
\begin{aligned}
&st_0\ && k = 1\ \land\ n = 0 \\
&st_1\ && k = 1\ \land\ n = 1 \\
&0\ && k > 1 \ \land \ n < 0 \\
&a \times F(k, n - 1) + b \times F(k, n - 2)\ && k = 1 \ \land\ n > 1 \\
&t_k \times F(k, n - 1) + s^n \times F(k - 1, n)\ && \text{otherwise}
\end{aligned}
\right.
$$

给定 $F$ 递推式的各项系数和 $k, n$，请你求出 $F(k, n) \bmod 998244353$ 的值。
## 输入格式

第一行，两个整数 $k, n$；

第二行，五个整数 $st_0, st_1, a, b, s$；

第三行，$k - 1$ 个整数 $t_2, t_3, \cdots, t_k$。
## 输出格式

一行一个整数表示答案。
## 样例

### 样例输入 #1
```
10 25
-5 -73 -95 64 15
-80 -31 -58 15 95 -1 14 -30 31 
```
### 样例输出 #1
```
998096342
```
## 提示

| $\textbf{Subtask}$ | $k \leq$ | $n \leq$ | 特殊性质 | 分值 |
| :----------: | :----------: | :----------: | :----------: | :----------: |
| $1$ | $100$ | $100$ | 无 | $5$ |
| $2$ | $100$ | $2^{63}$ | 无 | $25$ |
| $3$ | $5000$ | $2^{63}$ | $s = 1, \forall 2 \leq i \leq k, t_i = 1$ | $10$ |
| $4$ | $5000$ | $2^{63}$ | 无 | $60$ |

对于 $100\%$ 的数据，$1 \leq k \leq 5 \times 10^3$，$0 \leq n \le 2^{63}$，$-998244352 \leq st_0, st_1, a, b, s, t_i \leq 998244352$。


---


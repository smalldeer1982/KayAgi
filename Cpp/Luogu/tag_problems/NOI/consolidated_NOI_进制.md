---
title: "[ZJOI2014] 取石子游戏"
layout: "post"
diff: NOI/NOI+/CTSC
pid: P3339
tag: ['递推', '2014', '浙江', '进制', '斐波那契数列']
---
# [ZJOI2014] 取石子游戏
## 题目描述

Roland. p Sprague 和 Patrick M. Grundy 都是组合游戏的狂热爱好者，但他们素未谋面。

一天，Sprague 在写给 Grundy 的信中向他介绍了一个据称是来自东方的古老游戏一一取石子。

取石子是一个双人博弈游戏。在游戏的一开始，桌面上有几堆石子堆。接下 来，游戏双方轮流进行操作：从桌面上选取一堆石子堆，然后从这一堆里面取走任意多个石子（但不能不取）。当某个人无法操作时则失败，另一方获得胜利。由于条件所限, Sprague 建议在纸上写一排自然数来代表各个石子堆的石子数目，然后两人轮流划数与数；Grundy 欣然应允。

一个月过去了，在 Grundy 连续输了 $5$ 盘游戏之后，他怀疑 Sprague 要诈。经过几天的研究，Grundy 在某天下午发现假设游戏双方都足够聪明，那么给定一个初始状态（一排自然数），可以有很简单的方法来判定先手必胜还是后手必胜，并且可以给出必胜策略！于是 Grundy 决定要进行反击。

翌日，Grundy 在写给 Sprague 的信中建议把游戏的规则改得更复杂一点：首先确定一个常数 $K$。然后，游戏双方的操作改为：每次选择一个数划掉。假设该数为 $x$，操作者可以任选一个正整数a，在划掉之后需要再写上 $x-a$，$x-2a $，$\cdots$，$x-K \times a$ 共 $K$ 个数，且 $a$ 需满足 $x-K\times a \geq 0$。若这样的 $a$ 不存在，那么操作者就不能划掉这个无。某一方失败的条件依然是他无法操作。

碍于面子，Sprague 当然无法拒绝。不过他也不会坐以待毙，现在他已经得到了和写在纸上的个数。他把这些数据和这个游戏的规则都告诉了你一一一个正在研究如何使用一个尚不存在的机械（你将其命名为计算机）解决实际的数学、物理、经济学）的计算机科学家。


## 输入格式

输入文件，第一行是一个正整数，表示数据组数 $T$（Sprague 向你询问的次数）。接下来依次输入 $T$ 组数据，每组数据占 $N + 2$ 行，格式如下：

- 第 $1$ 行是一个空行。
- 第 $2$ 行，两个正整数，按顺序表示 $N$ 和 $K$。
- 接下来 $N$ 行，每行一个正整数，表示写在纸上的 $N$ 个数。
## 输出格式

输出文件共有 $T$ 行。对每组数据，如果先手必胜（先进行操作的玩家拥有必胜策略），则输出 `Preempt.`。若后手必胜，则输出 `Leapfrog.`。若两者皆非，则输出 `Je suis un imbecile.`
## 样例

### 样例输入 #1
```
2 
1 1 
1
2 30 
197943 
249832
```
### 样例输出 #1
```
Preempt.
Leapfrog.
```
## 提示

$10\%$ 的数据满足：$N \leq 5$，$K=1$，所有数均小等于 $5$。

$20\%$ 的数据满足：$N \leq 100$，$K=1$，所有数均小等于 $10^9$。

$10\%$ 的数据满足：$N \leq 100$，$K=2$，所有数均小等于 $10^9$。

$20\%$ 的数据满足：$N \leq 100$，$K=2$，所有数均小等于 $10^{18}$。

$20\%$ 的数据满足：$N \leq 100$，$K=10$，所有数均小等于 $10^{18}$。

$40\%$ 的数据满足：$N \leq 100$，$K=30$，所有数均小等于 $10^{80}$。

$100\%$ 的数据满足：$T \leq 10$


---

---
title: "普通数学题"
layout: "post"
diff: NOI/NOI+/CTSC
pid: P3791
tag: ['洛谷原创', 'O2优化', '枚举', '进制', '前缀和', '洛谷月赛']
---
# 普通数学题
## 题目背景

一天 zzq 没有题可以出了。于是他随便写了一个式子，求$\sum_{i=0}^n \sum_{j=0}^m i \operatorname{xor}j\operatorname{xor}x$，其中 $\operatorname{xor}$ 表示异或。

zzy 一看，这不是水题吗，就随便加了一个函数：$\sum_{i=0}^n \sum_{j=0}^m d(i \operatorname{xor}j\operatorname{xor}x)$，其中 $\operatorname{xor}$ 表示异或，$d(x)$ 表示 $x$ 的约数个数。**注意 $d(0)=0$。**

现在 zzq 不会做了，只好写了一个暴力造了数据，然后把这道题丢给了你。

## 题目描述

输入三个数 $n,m,x$，要求计算 $\sum_{i=0}^n \sum_{j=0}^m d(i \operatorname{xor}j\operatorname{xor}x)$，其中 $\operatorname{xor}$ 表示二进制下的异或，$d(x)$ 表示 $x$ 的约数个数。

由于答案比较大，要求输出答案模 $ 998244353$ 后的结果。

## 输入格式

一行三个数 $n,m,x$。

## 输出格式

输出答案模 $ 998244353$ 后的结果。
## 样例

### 样例输入 #1
```
0 2 233
```
### 样例输出 #1
```
14
```
### 样例输入 #2
```
123 234 345
```
### 样例输出 #2
```
205761
```
## 提示

对于 $20\%$ 的数据，$n,m,x \leq 2000$。

对于 $50\%$ 的数据，$n,m,x \leq 10^6$。

对于 $80\%$ 的数据，$n,m,x \leq 10^8$。

对于 $100\%$ 的数据，$1 \leq n,m,x \leq 10^{10}$。



---

---
title: "[JLOI2009] 神秘的生物"
layout: "post"
diff: NOI/NOI+/CTSC
pid: P3886
tag: ['动态规划 DP', '2009', '各省省选', '吉林', '进制', '插头 DP']
---
# [JLOI2009] 神秘的生物
## 题目描述

3206年5月，正在钻研ET专业的刘博士所在的OI团队发现：地球受到了来自外星球的生物人的侵袭。这些生物人采取了极秘的乘法加密电文，控制了具有大量武器的军火库，攻占了大量的城市，甚至出现了K弹计划……


刘博士所在的OI团队决定要发挥他们的科研机构作用（由于吉林省所在的地理位置具有特殊的优势，此科研机构全球只有吉林一处），以制伏这些外星球的生物人。他们想方设法捕获了几个外星球的生物人，经研究后发现，这些外星球的生物人在地球上的生存，取决于一个参数：生存度。他们要做的就是：找到这个参数的最大值！于是，他们开始了对这些外星球的生物人生长的研究。


每次实验前，他们把一个外星球生物人的细胞随机地放在一个N\*N的方形培养容器的一格中，并给容器的每个格子都标了一个数值，是生物在此单元的生存度（可正可负，数值越大表示越危险）。整个生物的生存度是生物所有占据格子的生存度之和。每次实验开始后，让生物自然生长。这个生物每一单位时间都选择其身体的一部分（某个格子），随机地向与之有公共边的空格生长，例如某次实验，一开始生物只占据一个格子，然后开始了生长：

 ![](https://cdn.luogu.com.cn/upload/pic/6844.png) 

刘博士所在的OI团队做了大量的实验，并且对数据进行了记录和统计。假设进行的实验次数足够多，问在实验进行的某一时刻，该生物达到的最大生存度是多少？


3206年9月，妄图破坏地球的外星球生物人终于被刘博士所在的OI团队制伏了……

## 输入格式

输入文件第一行包括一个正整数N，代表实验容器的边长。

接下来N行，每行N个用空格隔开的整数，代表外星球生物人在每一格的生存度。

## 输出格式

输出一行，代表实验过程中，生物达到的最大生存度。

## 样例

### 样例输入 #1
```
4
2 -1 -1 -1
5 -5 -1 -5
3  2 -1  3
2 -2 -3  2

```
### 样例输出 #1
```
18
```
## 提示

对于40%的数据有N <= 6。

对于100%的数据有N <= 9。

所有数据每个格子生存度的绝对值不超过32767。



---

---
title: "大学数学题"
layout: "post"
diff: NOI/NOI+/CTSC
pid: P3923
tag: ['数学', '洛谷原创', '提交答案', 'Special Judge', '素数判断,质数,筛法', '进制', '群论', '期望']
---
# 大学数学题
## 题目背景

琪露诺：我知道了！答案一定是1！

露米娅：什么鬼啊（汗），你还是再想想去吧。。我先把最后一道题给你，这是一道大学数学题哦

## 题目描述

露米娅：大妖精想构造一个 $ n $ 元有限域，元素用 $ 0 \sim n - 1 $ 的整数表示


有限域需要满足以下条件


1.有加法单位元 $ o $ ，满足对于任意元素 $ a $ ， $ o + a = a + o = a $


2.对于任意元素 $ a $ ，存在加法逆元 $ a^{-1} $ ，使得 $ a + a^{-1} = a^{-1} + a = o $


3.有不同于加法单位元 $ o $ 的乘法单位元 $ i $ ，满足对于任意元素 $ a $ ， $ i \times a = a \times i = a $


4.对于任意非加法单位元元素 $ a $ ，存在乘法逆元 $ a^{-1} $ ，使得 $ a \times a^{-1} = a^{-1} \times a = i $


5.对于任意元素 $ x $ , $ y $ ，有加法交换律，即 $ x + y = y + x  $


6.对于任意元素 $ x $ , $ y $ ，有乘法交换律，即 $ x \times y = y \times x  $


7.对于任意元素 $ x $ , $ y $ , $ z $ ，有加法结合律，即 $ ( x + y ) + z = x + ( y + z ) $


8.对于任意元素 $ x $ , $ y $ , $ z $ ，有乘法结合律，即 $ ( x \times y ) \times z = x \times ( y \times z ) $


9.对于任意元素 $ x $ , $ y $ , $ z $ ，有乘法分配律，即 $ ( x + y ) \times z = x \times z + y \times z $


大妖精当然会做啦，但是他想考考你


在输出中加法单位元  $ o $ 即为 0，乘法单位元  $ i $ 即为 1

## 输入格式

一个正整数 $ n $

$ 2 \leq n \leq 350 $

## 输出格式

##第一行输出一个整数 $ k $ ，若存在 $ n $ 元有限域则 $ k = 0 $ ，否则 $ k = -1 $


若 $ k = 0 $ 则

1.接下来 $ n $ 行输出一个 $ n $ 元有限域的加法表，第 $ i + 1 $ 行第 $ j + 1 $ 列上的数代表有限域中 $ i + j $ 的运算结果

2.接下来 $ n $ 行输出一个 $ n $ 元有限域的乘法表，第 $ i + 1 $ 行第 $ j + 1 $ 列上的数代表有限域中 $ i \times j $ 的运算结果

共输出 $ n \times 2 + 1 $ 行


upd1:SPJ非常严格，请不要在行末输出多余空格

（答案文件末尾的换行还是会自动忽略的）

upd2:正解文件比较大，洛谷可能会一直judging...

如果遇到这种情况请直接提交源代码

## 样例

### 样例输入 #1
```
2

```
### 样例输出 #1
```
0
0 1
1 0
0 0
0 1

```
## 提示

| 测试点  |  [$ n $ 的范围]       | 特殊性质|
| :-------: | :----------: | :-----------------: |
|1  | [$ n = 3 $]     | $ n $ 是质数           |
|2  | [$ n = 4 $]     | $ n $ 是2的整数次方 |
|3  | [$ n = 6 $]     |                无            |
|4  | [$ n = 8 $]     | $ n $ 是2的整数次方 |
|5  | [$ n = 9 $]     |                无            |
|6  | [$ n = 19 $]   | $ n $ 是质数           |
|7  | [$ n = 89 $]   | $ n $ 是质数           |
|8  | [$ n = 181 $] | $ n $ 是质数           |
|9  | [$ n = 233 $] | $ n $ 是质数           |
|10| [$ n = 25 $]   | $ n $ 是质数的平方|
|11| [$ n = 121 $] | $ n $ 是质数的平方|
|12| [$ n = 169 $] | $ n $ 是质数的平方|
|13| [$ n = 27 $]   |                无            |
|14| [$ n = 143 $] |                无            |
|15| [$ n = 128 $] | $ n $ 是2的整数次方 |
|16| [$ n = 81 $]   |                无            |
|17| [$ n = 125 $] |                无            |
|18| [$ n = 243 $] |                无            |
|19| [$ n = 256 $] | $ n $ 是2的整数次方 |
|20| [$ n = 343 $] |                无            |



---

---
title: "[HNOI/AHOI2018] 寻宝游戏"
layout: "post"
diff: NOI/NOI+/CTSC
pid: P4424
tag: ['2018', '各省省选', '安徽', '湖南', '排序', '进制', '位运算']
---
# [HNOI/AHOI2018] 寻宝游戏
## 题目描述

某大学每年都会有一次 Mystery Hunt 的活动，玩家需要根据设置的线索解谜，找到宝藏的位置，前一年获胜的队伍可以获得这一年出题的机会。

作为新生的你，对这个活动非常感兴趣。你每天都要从西向东经过教学楼一条很长的走廊，这条走廊是如此的长，以至于它被人戏称为 infinite corridor。一次，你经过这条走廊时注意到在走廊的墙壁上隐藏着 $n$ 个**等长的**二进制的数字，长度均为 $m$。你从西向东将这些数字记录了下来，形成一个含有 $n$ 个数的二进制数组 $a_1,a_2,...,a_n$。

很快，在最新的一期的 Voo Doo 杂志上，你发现了 $q$ 个长度也为 $m$ 的二进制数 $r_1,r_2,...,r_q$。

聪明的你很快发现了这些数字的含义。

保持数组 $a_1,a_2,...,a_n$ 的元素顺序不变，你可以在它们之间插入 $\land$（按位与运算）或者 $\lor$（按位或运算）。例如：$11011\land 00111=00011$，$11011\lor 00111=11111$。

你需要插入 $n$ 个运算符，相邻两个数之前恰好一个，在**第一个数的左边**还有一个。**如果我们在第一个运算符的左边补入一个 0**，这就形成了一个运算式，我们可以计算它的值。与往常一样，运算顺序是**从左到右**。有趣的是，出题人已经告诉你这个值的可能的集合—— Voo Doo 杂志里的那些二进制数 $r_1,r_2,...,r_q$，而解谜的方法，就是对 $r_1,r_2,...,r_q$ 中的每一个值 $r_i$，分别计算出**有多少种方法填入这 $n$ 个计算符**，使的这个运算式的值是 $r_i$。

然而，infinite corridor 真的很长，这意味着数据范围可能非常大。因此，答案也可能非常大，但是你发现由于谜题的特殊性，你只需要求答案模 $1000000007$ 的值。
## 输入格式

第一行三个数 $n,m,q$，含义如题所述。

接下来 $n$ 行，其中第 $i$ 行有一个长度为 $m$ 的二进制数，**左边是最高位**，表示 $a_i$。

接下来 $q$ 行，其中第 $i$ 行有一个长度为 $m$ 的二进制数，**左边是最高位**，表示 $r_i$。
## 输出格式

输出 $q$ 行，每行一个数，其中的 $i$ 行表示对于 $r_i$ 的答案。
## 样例

### 样例输入 #1
```
5 5 1
01110
11011
10000
01010
00100
00100
```
### 样例输出 #1
```
6
```
### 样例输入 #2
```
10 10 3
0100011011
0110100101
1100010100
0111000110
1100011110
0001110100
0001101110
0110100001
1110001010
0010011101
0110011111
1101001010
0010001001
```
### 样例输出 #2
```
69
0
5
```
## 提示

对于 $10\%$ 的数据，$n \le 20, m \le 30, q = 1$；

对于另外 $20\%$ 的数据，$n \le 1000, m \le 16$；

对于另外 $40\%$ 的数据，$n \le 500, m \le 1000$；

对于全部的数据 $1\leq n\leq 1000,1\leq m\leq 5000,1\leq q\leq 1000$。


---


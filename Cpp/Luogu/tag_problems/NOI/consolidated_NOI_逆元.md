---
title: "[NOI2011] 兔农"
layout: "post"
diff: NOI/NOI+/CTSC
pid: P2020
tag: ['数学', '2011', 'NOI', '斐波那契数列', '逆元']
---
# [NOI2011] 兔农
## 题目描述

农夫栋栋近年收入不景气，正在他发愁如何能多赚点钱时，他听到隔壁的小朋友在讨论兔子繁殖的问题。

问题是这样的：第一个月初有一对刚出生的小兔子，经过两个月长大后，这对兔子从第三个月开始，每个月初生一对小兔子。新出生的小兔子生长两个月后又能每个月生出一对小兔子。问第 $n$ 个月有多少只兔子？

聪明的你可能已经发现，第 $n$ 个月的兔子数正好是第 $n$ 个 Fibonacci（斐波那契）数。栋栋不懂什么是 Fibonacci 数，但他也发现了规律：第 $i+2$ 个月的兔子数等于第 $i$ 个月的兔子数加上第 $i+1$ 个月的兔子数。前几个月的兔子数依次为：

$$1,1,2,3,5,8,13,21,34,\ldots$$

栋栋发现越到后面兔子数增长的越快，期待养兔子一定能赚大钱，于是栋栋在第一个月初买了一对小兔子开始饲养。

每天，栋栋都要给兔子们喂食，兔子们吃食时非常特别，总是每 $k$ 对兔子围成一圈，最后剩下的不足 $k$ 对的围成一圈，由于兔子特别害怕孤独，从第三个月开始，如果吃食时围成某一个圈的只有一对兔子，这对兔子就会很快死掉。

我们假设死去的总是刚出生的兔子，那么每个月的兔子数仍然是可以计算的。例如，当 $k=7$ 时，前几个月的兔子数依次为：

$$1,1,2,3,5,7,12,19,31,49,80,\ldots$$

给定 $n$，你能帮助栋栋计算第 $n$ 个月他有多少对兔子么？由于答案可能非常大，你只需要告诉栋栋第 $n$ 个月的兔子对数除 $p$ 的余数即可。

## 输入格式

输入一行，包含三个正整数 $n, k, p$。

## 输出格式

输出一行，包含一个整数，表示栋栋第 $n$ 个月的兔子对数除 $p$ 的余数。

## 样例

### 样例输入 #1
```
6 7 100
```
### 样例输出 #1
```
7
```
### 样例输入 #2
```
7 7 5
```
### 样例输出 #2
```
2
```
## 提示

|测试点编号|$n$|$k,p$|
|:-:|:-:|:-:|
|$1\sim 10$|$1\leq n\leq 50$|$2\leq k,p\leq1000$|
|$11$|$1\leq n\leq 80$|$2\leq k,p\leq 10^4$|
|$12,13$|$1\leq n\leq 1000$|$2\leq k,p\leq 10^4$|
|$14,15$|$1\leq n\leq 10^6$|$2\leq k,p\leq 10^6$|
|$16,17$|$1\leq n\leq 10^{18}$|$2\leq k,p\leq1000$|
|$18\sim 20$|$1\leq n\leq 10^{18}$|$2\leq k\leq 10^6$，$2\leq p\leq 10^9$|

对于 $100\%$ 的数据，$1\leq n\leq 10^{18}$，$2\leq k\leq 10^6$，$2\leq p\leq 10^9$。



---

---
title: "[SDOI2013] 项链"
layout: "post"
diff: NOI/NOI+/CTSC
pid: P3307
tag: ['数学', '2013', '山东', '最大公约数 gcd', '逆元']
---
# [SDOI2013] 项链
## 题目背景

项链作为人体的装饰品之一，是最早出现的首饰。项链除了具有装饰功能之外，有些项链还具有特殊的显示作用，如天主教徒的十字架链和佛教徒的念珠。

从古至今人们为了美化人体本身，也美化环境，制造了各种不同风格、不同特点、不同样式的项链，满足了不同肤色、不同民族、不同审美观的人的审美需要。就材料而论，首饰市场上的项链有黄金、白银、珠宝等几种。

珍珠项链为珍珠制成的饰品，即将珍珠钻孔后用线串在一起，佩戴于项间，天然珍珠项链具有一定的护养作用。
## 题目描述

最近，铭铭迷恋上了一种项链。与其他珍珠项链基本上相同，不过这种项链的珠子却与众不同，是正三菱柱的泰山石雕刻而成的。

三菱柱的侧面是由正方形构成的，每个侧面都刻有数字。能够让铭铭满意的项链必须满足以下条件：

1. 这串项链由 $n$ 颗珠子构成。

2. 每一个珠子上面的每个数字 $x$，必须满足 $0<x\le a$，且珠子上面三个数字的最大公约数要恰好为 $1$。

3. 相邻的两个珠子必须不同。两个珠子被认为是相同的，当且仅当它们经过旋转，或者翻转后能够变成一样的。

4. 两串项链如果能够经过旋转变成一样的，那么这两串项链被认为是相同的。 

铭铭很好奇如果给定 $n$ 和 $a$，能够找到多少串不同的项链。由于答案可能很大，所以输出答案模上 $10^{9}+7$ 的值。
## 输入格式

**本题有多组数据**。

第一行给定一个整数 $T$，表示数据组数。  
接下来 $T$ 行，每行两个整数 $n$ 和 $a$。

## 输出格式

对于每组数据输出一个整数，表示有多少串不同的项链。
## 样例

### 样例输入 #1
```
1
2  2
```
### 样例输出 #1
```
3
```
## 提示

满足条件的珠子共有三种：`[1,1,1]`,`[1,1,2]`,`[1,2,2]`。

组成的满足条件的串有：`[1,2]`,`[1,3]`,`[2,3]`。

对于 $100\%$ 的数据，保证 $1 \le T \le 10$，$2 \le n \le 10^{14}$，$1 \le a \le 10^7$。


---

---
title: "仓鼠的数学题"
layout: "post"
diff: NOI/NOI+/CTSC
pid: P3711
tag: ['洛谷原创', 'O2优化', '生成函数', '逆元', '洛谷月赛']
---
# 仓鼠的数学题
## 题目背景

请注意本题时限 1s，开启 O2 优化，你可能需要输入输出优化。

## 题目描述

仓鼠在某 oj 上看到了一个问题，设 $S_k(x)=\sum_{i=0}^x i^k$，这个题输入 $a_0,a_1...a_n$，假设 $0^0=1$，要求计算 $\sum_{k=0}^{n}S_k(x)a_k$。

仓鼠想了两秒就秒了这个题，他发现数据范围居然只有 $1000$，就顺手加了两个 $0$。

但是仓鼠懒得造数据了，就把这道题丢给了你。

## 输入格式

第一行输入一个整数 $n$。

第一行输入 $n+1$ 个空格分隔的非负整数。分别是 $a_0, \cdots, a_n$。

## 输出格式

输出 $n+2$ 个空格分隔的整数，表示答案多项式的各项系数 $c_0,\cdots,c_{n+1}$，表示答案多项式为 $\sum_{i=0}^{n+1}c_ix^i$。多项式的系数对 $998244353$ 取模。

可以证明多项式的次数 $\leq n+1$。

## 样例

### 样例输入 #1
```
2
3 3 3
```
### 样例输出 #1
```
3 5 3 1
```
## 提示

对于 $10\%$ 的数据，$n \leq 500$。

对于 $30\%$ 的数据，$n \leq 3000$。

对于 $70\%$ 的数据，$n \leq 100000$。

对于 $100\%$ 的数据，$1 \leq n \leq 250000$。

输入和输出多项式系数均为模 $998244353$ 意义下，为 $[0,998244352]$ 的非负整数。



---

---
title: "[AH2017/HNOI2017] 抛硬币"
layout: "post"
diff: NOI/NOI+/CTSC
pid: P3726
tag: ['2017', '各省省选', '安徽', '湖南', 'O2优化', '枚举', '中国剩余定理 CRT', '逆元']
---
# [AH2017/HNOI2017] 抛硬币
## 题目描述

小 A 和小 B 是一对好朋友，他们经常一起愉快的玩耍。最近小 B 沉迷于**师手游，天天刷本，根本无心搞学习。但是已经入坑了几个月，却一次都没有抽到 SSR，让他非常怀疑人生。勤勉的小 A 为了劝说小 B 早日脱坑，认真学习，决定以抛硬币的形式让小 B 明白他是一个彻彻底底的非洲人，从而对这个游戏绝望。两个人同时抛 b 次硬币，如果小 A 的正面朝上的次数大于小 B 正面朝上的次数，则小 A 获胜。

但事实上，小 A 也曾经沉迷过拉拉游戏，而且他一次 UR 也没有抽到过，所以他对于自己的运气也没有太大把握。所以他决定在小 B 没注意的时候作弊，悄悄地多抛几次硬币，当然，为了不让小 B 怀疑，他不会抛太多次。现在小 A 想问你，在多少种可能的情况下，他能够胜过小 B 呢？由于答案可能太大，所以你只需要输出答案在十进制表示下的最后 $k$ 位即可。

## 输入格式

有多组数据，对于每组数据输入三个数 $a,b,k$，分别代表小 A 抛硬币的次数，小 B 抛硬币的次数，以及最终答案保留多少位整数。

## 输出格式

对于每组数据，输出一个数，表示最终答案的最后 $k$ 位为多少，若不足 $k$ 位以 $0$ 补全。

## 样例

### 样例输入 #1
```
2 1 9
3 2 1
```
### 样例输出 #1
```
000000004
6
```
## 提示

对于第一组数据，当小 A 抛 $2$ 次硬币，小 B 抛 $1$ 次硬币时，共有 $4$ 种方案使得小 A 正面朝上的次数比小 B 多。

$(01,0), (10,0), (11,0), (11,1)$

对于第二组数据，当小 A 抛 $3$ 次硬币，小 B 抛 $2$ 次硬币时，共有 $16$ 种方案使得小 A 正面朝上的次数比小 B 多。

$(001,00), (010,00), (100,00), (011,00), (101,00), (110,00), (111,00), (011,01)$

$(101,01), (110,01),(111,01), (011,10), (101,10), (110,10), (111,10), (111,11)$

### 数据范围

$10\%$ 的数据满足 $a,b\leq 20$。


$30\%$ 的数据满足 $a,b\leq 100$。


$70\%$ 的数据满足 $a,b\leq 10^5$，其中有 $20\%$ 的数据满足 $a=b$。


$100\%$ 的数据满足 $1\le a,b\le 10^{15}$，$b\le a\le b+10^4$，$1\le k\le 9$，数据组数小于等于 $10$。



---

---
title: "[HNOI2009] 图的同构计数"
layout: "post"
diff: NOI/NOI+/CTSC
pid: P4727
tag: ['数学', '2009', '各省省选', '湖南', '群论', '置换', 'Pólya 定理', '逆元']
---
# [HNOI2009] 图的同构计数
## 题目背景

当学生们遇到某个难题时经常会说“这怎么做，这不是NP问题吗？”、“这个只有搜了，这己经被证明是NP问题了”。但是，你应该淸楚，大多数人此时所说的NP问题其实都是指NPC问题。很多人没有真正掌握NP问题和NPC问题这两个基本概念。其实NP问题并不是那种“只有搜才行”的问题，NPC问题才是。

很久以前就有一个古老的传说：有―个著名的问题，即P是否等于NP的问题，传说中谁要是证明或者证伪了这个命题，他将获得幸福。这里P是指能在多项式时间里求解的问题的集合。而NP是指可在多项式时间里验证的问题的集合。显然P是NP的子集，因为能在多项式时间里求解的问题，必定可在多项式时间里验证。

到目前为止还没有人因这个命题得到幸福。但是，有一个总的趋势，也就是人们普遍认为，$P=NP$不成立，即，多数人相信，至少存在一个不可能有多项式时间复杂度的求解算法的NP问题。人们如此坚信$P \neq NP$是有原因的，因为在研究NP问题的过程中找出了一类非常特殊的NP问题叫做NP-完全问题，也就是所谓的NPC问题。正是因为存在NPC问题，才使人们相信$P \neq NP$。

在提出NPC的概念之后，绝大多数“自然”的难题最后都被证明是NPC问题，只有三个例外，它们分别是：

- 线形规划问题；
- 图同构问题；
- 素数判定问题与大数分解问题。
## 题目描述

小雪在了解到以上情况后，自认为直接挑战终极难题还有不少困难，于是决定先从简单的问题做起，具体来说，他对图同构问题产生了浓厚的兴趣。$A$图与$B$图被认为是同构的是指：$A$图的顶点经过一定的重新标号以后，$A$图的顶点集和边集要完全与$B$图一一对应。

小雪现在专注于如何判断两个图是否同构，同时他还想知道两两互不同构的含$N$个点的图有多少种。众所周知含$N$个点的简单图最多有$N*(N-1)/2$条边，这样含$N$个点的图有$2^{N*(N-1)/2}$种可能的情况。显然这些图中有很多图是同构的，小雪想知道的便是：若同构的图算成一种，则有多少种不同的图。他把这个任务丢给了你，在他想出来之前快点解决吧！
## 输入格式

从文件input.txt中读入数据，文件中只有一个非负整数$N$，表示图的顶点数，且$0 \leq N \leq 60$。
## 输出格式

输出文件output.txt中仅包含一个整数，表示含$N$个点的图在同构意义下不同构的图的数目。因为答案可能很大，所以输出的最终答案是$\bmod 997$的结果（$997$是一个素数）。
## 样例

### 样例输入 #1
```
1
```
### 样例输出 #1
```
1
```
### 样例输入 #2
```
2
```
### 样例输出 #2
```
2
```
### 样例输入 #3
```
3
```
### 样例输出 #3
```
4
```
### 样例输入 #4
```
5
```
### 样例输出 #4
```
34
```
### 样例输入 #5
```
9
```
### 样例输出 #5
```
493
```
## 提示

对于 $40 \%$ 的数据，$N \le 20$。  
对于 $100 \%$ 的数据，$0 \le N \le 60$。


---

---
title: "[MtOI2018] 情侣？给我烧了！（加强版）"
layout: "post"
diff: NOI/NOI+/CTSC
pid: P4931
tag: ['递推', '2018', '洛谷原创', '组合数学', '生成函数', '逆元']
---
# [MtOI2018] 情侣？给我烧了！（加强版）
## 题目背景

FFF

本题原版：[P4921](https://www.luogu.com.cn/problem/P4921)
## 题目描述

有 $n$ 对情侣来到电影院观看电影。在电影院，恰好留有 $n$ 排座位，每排包含 $2$ 个座位，共 $2n$ 个座位。

现在，每个人将会随机坐在某一个位置上，且恰好将这 $2n$ 个座位坐满。

如果一对情侣坐在了同一排的座位上，那么我们称这对情侣是和睦的。

你的任务是求出共有多少种不同的就坐方案满足**恰好**有 *k* 对情侣是和睦的。

两种就坐方案不同当且仅当存在一个人在两种方案中坐在了不同的位置。不难发现，一共会有 $(2n)!$ 种不同的就坐方案。

由于结果可能较大，因此输出对 $998244353$ 取模的结果。
## 输入格式

输入包含多组数据。

输入的第 $1$ 行包含 $1$ 个正整数 $T$，表示数据的组数。

接下来 $T$ 行，每行包含 $2$ 个正整数 $n,k$。
## 输出格式

输出共 $T$ 行。

对于每组输入数据，输出共 $1$ 行，包含 $1$ 个整数，表示恰好有 $k$ 对情侣和睦的就坐方案数。
## 样例

### 样例输入 #1
```
5
1 1
2 0
2 2
2333 666
2333333 1000000

```
### 样例输出 #1
```
2
16
8
798775522
300377435

```
## 提示

### 子任务

对于 $10 \%$ 的数据，满足 $1 \leq T \leq 10, 1 \leq n \leq 5$。

对于 $40 \%$ 的数据，满足 $1 \leq n \leq 3 \times 10^3$。

对于 $100 \%$ 的数据，满足 $1 \leq T \leq 2 \times 10^5, 1 \leq n \leq 5 \times 10^6, 0 \leq k \leq n$。

### 题目来源

[MtOI2018 迷途の家の水题大赛](https://www.luogu.org/contest/11260) T2 加强版

出题人：Imagine

50167


---

---
title: "「SWTR-8」幂塔方程"
layout: "post"
diff: NOI/NOI+/CTSC
pid: P8457
tag: ['原根', '数论', '洛谷原创', 'Special Judge', 'O2优化', '扩展欧几里德算法', '中国剩余定理 CRT', '逆元', '洛谷月赛']
---
# 「SWTR-8」幂塔方程
## 题目背景

![](https://cdn.luogu.com.cn/upload/image_hosting/iflu3244.png)

图片来自于 Solara570 的 B 站视频 [轻易相信简单直观的结论究竟有多危险？](https://www.bilibili.com/video/BV1PW41177Vb)。

很久以前的某一天，小 A 在 B 站上无意间刷到了这个视频。视频中的无穷幂塔方程及其「简单直观，但暗藏陷阱」的解法令他影响深刻。
$$
\Huge x ^ {x ^ {x ^ {x ^ {x}}}}
$$
## 题目描述

如果小 A 是一个，一个一个一个毒瘤，他会让你求解套了十层甚至九层的幂塔方程，但他不是。

他想让你求解：
$$
x ^ x\equiv D \pmod n
$$

保证 $n$ 的最大质因子不超过 $10 ^ 5$，且 $D$ 与 $n$ 互质。

你需要保证得到的解 $x$ 为 $[0, 2 ^ {125}]$ 范围内的整数。若该范围内无解，输出 $-1$；若存在多解，输出任意一个。

多组测试数据。
## 输入格式

第一行一个整数 $S$，表示该测试点的 Subtask 编号。

第二行一个整数 $T$，表示数据组数。接下来 $T$ 组测试数据，每组数据形如：

- 第一行两个整数 $n, D$。
- 第二行若干递增的质数 $p_1, p_2, \cdots, p_k$，表示 $n$ 的所有质因子。
## 输出格式

输出 $T$ 行 $[-1, 2 ^ {125}]$ 范围内的整数。
## 样例

### 样例输入 #1
```
0
10
7 4
7
16 3
2
6 1
2 3
144 5
2 3
2520 11
2 3 5 7
999999 2
3 7 11 13 37
22511 21795
22511
47067727606562827 30911969774113407
3083 13697 25747 43291
2147483648 2333333
2
675288511488360000 510472780110265817
2 3 5 7 11
```
### 样例输出 #1
```
25
11
1
101
4811
219871229
16139671
760913896873844308082367046696111
1221598821
24445987958110300438937

```
## 提示

**「数据范围与约定」**

**本题采用捆绑测试**。

- Subtask #1（5 points）：$n\leq 20$。
- Subtask #2（8 points）：$n\leq 400$。依赖 Subtask #1。
- Subtask #3（11 points）：$n$ 是质数，$T\leq 10 ^ 4$。
- Subtask #4（15 points）：$\mu(n) \neq 0$，$T\leq 100$。
- Subtask #5（9 points）：$\mu(n) \neq 0$，$T\leq 10 ^ 4$。依赖 Subtask #4。
- Subtask #6（13 points）：$n = p ^ k(p \in \mathrm{prime})$，$T\leq 100$。
- Subtask #7（7 points）：$n = p ^ k(p \in \mathrm{prime})$，$T\leq 10 ^ 4$。依赖 Subtask #3，#6。
- Subtask #8（6 points）：$n$ 的最大质因子不超过 $ 1064$。依赖 Subtask #2。
- Subtask #9（16 points）：$n\leq 10 ^ 9$，$T\leq 10 ^ 4$。
- Subtask #10（10 points）：无特殊限制。依赖 Subtask #5，#7，#8，#9。

对于 $100\%$ 的数据：

- $1\leq T\leq 4\times 10 ^ 4$。
- $2\leq n \leq 10 ^ {18}$。
- $1\leq D < n$，$D\perp n$。
- $2\leq p_1 < p_2 < \cdots < p_k \leq 10 ^ 5$。

**「帮助与提示」**

选手可以通过边读入边试除的方式判断何时停止读入 $n$ 的质因子。

**「题目来源」**

- [Sweet Round 8](https://www.luogu.com.cn/contest/73382) F
- Idea & Solution：[demonlover923](https://www.luogu.com.cn/user/152997) & [codecode](https://www.luogu.com.cn/user/119526)。
- Tester：[Alex_Wei](https://www.luogu.com.cn/user/123294)。


---


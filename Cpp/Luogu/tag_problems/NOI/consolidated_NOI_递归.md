---
title: "[CSP-S 2024] 擂台游戏"
layout: "post"
diff: NOI/NOI+/CTSC
pid: P11234
tag: ['贪心', '递归', '2024', 'O2优化', '深度优先搜索 DFS', '树形 DP', '差分', 'CSP-S 提高级']
---
# [CSP-S 2024] 擂台游戏
## 题目描述

小 S 想要举办一场擂台游戏，如果共有 $2^k$ 名选手参加，那么游戏分为 $k$ 轮进行：

- 第一轮编号为 $1, 2$ 的选手进行一次对局，编号为 $3, 4$ 的选手进行一次对局，以此类推，编号为 $2^k - 1, 2^k$ 的选手进行一次对局。
- 第二轮在只保留第一轮的胜者的前提下，相邻的两位依次进行一场对局。
- 以此类推，第 $k - 1$ 轮在只保留第 $k - 2$ 轮的 $4$ 位胜者的前提下，前两位、后两位分别进行对局，也就是所谓的半决赛。
- 第 $k$ 轮即为半决赛两位胜者的决赛。

确定了游戏晋级的规则后，小 S 将比赛的规则设置为了擂台赛。具体而言，每位选手都有一个能力值 $a_1, a_2, \dots , a_{2^k}$，能力值为 $[0,2^{31}-1]$ 之内的整数。对于每场比赛，会先抽签决定一个数 $0/1$，我们将第 $R$ 轮的第 $G$ 场比赛抽到的数记为 $d_{R,G}$。抽到 $0$ 则表示表示编号小的选手为擂主，抽到 $1$ 则表示编号大的选手为擂主。擂主获胜当且仅当他的能力值 $a\geq R$。也就是说，游戏的胜负只取决于**擂主的能力值**与**当前比赛是第几轮**的大小关系，**与另一位的能力值无关**。

现在，小 S 先后陆续收到了 $n$ 位选手的报名信息，他们分别告知了小 S 自己的能力值。小 S 会按照报名的先后顺序对选手进行编号为 $1, 2, \dots, n$。小 S 关心的是，补充**尽量少**的选手使总人数为 $2$ 的整次幂，且所有选手进行一次完整的擂台游戏后，所有可能成为总冠军的选手的**编号之和**是多少。

形式化地，设 $k$ 是最小的非负整数使得 $2^k\geq n$，那么应当补充 $(2^k-n)$ 名选手，且补充的选手的能力值可以任取 $[0,2^{31}-1]$ 之内的整数。**如果补充的选手有可能取胜，也应当计入答案中**。

当然小 S 觉得这个问题还是太简单了，所以他给了你 $m$ 个询问 $c_1,c_2,\dots,c_m$。小 S 希望你帮忙对于每个 $c_i$ 求出，在只收到前 $c_i$ 位选手的报名信息时，这个问题的答案是多少。
## 输入格式

**本题的测试点包含有多组测试数据。** 但不同测试数据只是通过修改 $a_1, a_2, \dots , a_n$ 得到，其他内容均保持不变，请参考以下格式。其中 $\oplus$ 代表异或运算符，$a \bmod b$ 代表 $a$ 除以 $b$ 的余数。

输入的第一行包含两个正整数 $n, m$，表示报名的选手数量和询问的数量。

输入的第二行包含 $n$ 个非负整数 $a'_1,a'_2,\dots,a'_n$，这列数将用来计算真正的能力值。

输入的第三行包含 $m$ 个正整数 $c_1, c_2, \dots , c_m$，表示询问。

设 $K$ 是使得 $2^K \geq n$ 的最小的非负整数，接下来的 $K$ 行当中，第 $R$ 行包含 $2^{K-R}$ 个数（无空格），其中第 $G$ 个数表示第 $R$ 轮的第 $G$ 场比赛抽签得到的 $d_{R,G}=0/1$。

注意，由于询问只是将人数凑齐到 $2^k\geq c_i$，这里的 $k\leq K$，因此你未必会用到全部的输入值。

接下来一行包含一个正整数 $T$，表示有 $T$ 组测试数据。

接下来共 $T$ 行，每行描述一组数据，包含 $4$ 个非负整数 $X_0,X_1,X_2,X_3$，该组数据的能力值 $a_i=a'_i \oplus X_{i\bmod 4}$，其中 $1\leq i\leq n$。
## 输出格式

共输出 $T$ 行，对于每组数据，设 $A_i$ 为第 $i$（$1 \leq i \leq m$）组询问的答案，你只需要输出一行包含一个整数，表示 $(1\times A_1) \oplus (2\times A_2) \oplus \dots \oplus (m\times A_m)$ 的结果。
## 样例

### 样例输入 #1
```
5 5
0 0 0 0 0
5 4 1 2 3
1001
10
1
4
2 1 0 0
1 2 1 0
0 2 3 1
2 2 0 1
```
### 样例输出 #1
```
5
19
7
1
```
## 提示

**【样例 1 解释】**

共有 $T = 4$ 组数据，这里只解释第一组。$5$ 名选手的真实能力值为 $[1, 0, 0, 2, 1]$。$5$ 组询问分别是对长度为 $5, 4, 1, 2, 3$ 的前缀进行的。

1. 对于长度为 $1$ 的前缀，由于只有 $1$ 号一个人，因此答案为 $1$。
2. 对于长度为 $2$ 的前缀，由于 $2$ 个人已经是 $2$ 的幂次，因此不需要进行扩充。根据抽签 $d_{1,1} = 1$ 可知 $2$ 号为擂主，由于 $a_2 < 1$，因此 $1$ 号获胜，答案为 $1$。
3. 对于长度为 $3$ 的前缀，首先 $1$ 号、$2$ 号比赛是 $1$ 号获胜（因为 $d_{1,1} = 1$，故 $2$ 号为擂主，$a_2 < 1$），然后虽然 $4$ 号能力值还不知道，但 $3$ 号、$4$ 号比赛一定是 $4$ 号获胜（因为 $d_{1,2} = 0$，故 $3$ 号为擂主，$a_3 < 1$），而决赛 $1$ 号、$4$ 号谁获胜都有可能（因为 $d_{2,1} = 1$，故 $4$ 号为擂主，如果 $a_4 < 2$ 则 $1$ 号获胜，$a_4 \geq 2$ 则 $4$ 号获胜）。综上所述，答案为 $1 + 4 = 5$。
4. 对于长度为 $4$ 的前缀，我们根据上一条的分析得知，由于 $a_4 \geq 2$ ，所以决赛获胜的是 $4$ 号。
5. 对于长度为 $5$ 的前缀，可以证明，可能获胜的选手包括 $4$ 号、$7$ 号、$8$ 号，答案为 $19$。

因此，该组测试数据的答案为 $(1 \times 19) \oplus (2 \times 4) \oplus (3 \times 1) \oplus (4 \times 1) \oplus (5 \times 5) = 5$。

**【样例 2】**

见选手目录下的 arena/arena2.in 与 arena/arena2.ans。

这组样例满足特殊性质 A。

**【样例 3】**

见选手目录下的 arena/arena3.in 与 arena/arena3.ans。

这组样例满足特殊性质 B。

**【样例 4】**

见选手目录下的 arena/arena4.in 与 arena/arena4.ans。

**【样例 5】**

见选手目录下的 arena/arena5.in 与 arena/arena5.ans。

**【数据范围】**

对于所有测试数据，保证：$2 \leq n, m \leq 10^5$，$0 \leq a_i, X_j < 2^{31}$，$1 \leq c_i \leq n$，$1 \leq T \leq 256$。

| 测试点 | $T=$ | $n,m\leq$ | 特殊性质 A | 特殊性质 B |
| :----------: | :----------: | :----------: | :----------: | :----------: |
| $1\sim 3$ | $1$ | $8$ | 否 | 否 |
| $4,5$ | $1$ | $500$ | 是 | 否 |
| $6\sim 8$ | $1$ | $500$ | 否 | 是 |
| $9,10$ | $1$ | $5000$ | 否 | 否 |
| $11,12$ | $1$ | $10^5$ | 是 | 否 |
| $13\sim 15$ | $1$ | $10^5$ | 否 | 是 |
| $16,17$ | $4$ | $10^5$ | 否 | 否 |
| $18,19$ | $16$ | $10^5$ | 否 | 否 |
| $20,21$ | $64$ | $10^5$ | 否 | 否 |
| $22,23$ | $128$ | $10^5$ | 否 | 否 |
| $24,25$ | $256$ | $10^5$ | 否 | 否 |


特殊性质 A：保证询问的 $c_i$ 均为 $2$ 的幂次。

特殊性质 B：保证所有的 $d_{R,G} = 0$。


---

---
title: "[PA 2016] 台球 / Bilard Hilberta"
layout: "post"
diff: NOI/NOI+/CTSC
pid: P11612
tag: ['动态规划 DP', '数学', '2016', '递归', '分治', '分类讨论', 'PA（波兰）']
---
# [PA 2016] 台球 / Bilard Hilberta
## 题目背景

译自 [Potyczki Algorytmiczne 2016](https://sio2.mimuw.edu.pl/c/pa-2016-1/p/) R5 Bilard Hilberta [A] (HIL)。

## 题目描述


考虑如下的 Hilbert 曲线：

$n$ 阶的 Hilbert 曲线的大小为 $2^{n+1}\times 2^{n+1}$。这里，$n\ge 1$。

$n=1$ 时的曲线在下图中给出，而 $n\gt 1$ 时的曲线由四个 $(n-1)$ 阶的曲线组成。左下角的曲线被顺时针旋转了 $90^\circ$，而右下角的曲线则被逆时针旋转了 $90^\circ$，而且在左上与左下、左上与右上、右上与右下的曲线的相接处添加了长度为 $2$ 的额外曲线将它们连为一体。

下图中从左至右分别展示了 $n=1,2,3$ 时的曲线。

![](https://cdn.luogu.com.cn/upload/image_hosting/ynfo38pq.png)

令左下角的坐标为 $(0,0)$，右下角的坐标为 $(2^{n+1},0)$，右上角坐标为 $(2^{n+1},2^{n+1})$。

将球视为质点。球从 $(1,0)$ 出发，其速度矢量 $\boldsymbol{v}=(1,1)$。撞到边缘或者曲线上之后，它会反弹，这里的碰撞是**完全弹性碰撞**，也就是垂直于撞击面的速度分量反向，平行于撞击面的速度分量不变。可以证明撞到的一定是一个面，没有撞到角的情况。

$m$ 次询问，每次问球出发 $t_i$ 秒后，球的位置。
## 输入格式



第一行两个正整数 $n,m$。

接下来 $m$ 行，第 $i$ 行只有一个整数 $t_i$，描述一次询问。
## 输出格式

输出 $m$ 行，每行两个整数表示球的位置。

## 样例

### 样例输入 #1
```
3 2
1
42
```
### 样例输出 #1
```
2 1
3 14
```
## 提示


#### 样例解释

在【题目描述】的图中已经给出。

#### 数据范围

- $1\le n\le 30$；
- $1\le m\le 10^5$；
- $0\lt t_1\lt t_2\lt \ldots \lt t_m\lt 2^{2(n+1)}$。


---

---
title: "[NOI2005] 月下柠檬树"
layout: "post"
diff: NOI/NOI+/CTSC
pid: P4207
tag: ['计算几何', '2005', '递归', 'NOI', '积分']
---
# [NOI2005] 月下柠檬树
## 题目描述

李哲非常非常喜欢柠檬树，特别是在静静的夜晚，当天空中有一弯明月温柔地照亮地面上的景物时，他必会悠闲地坐在他亲手植下的那棵柠檬树旁，独自思索着人生的哲理。

李哲是一个喜爱思考的孩子，当他看到在月光的照射下柠檬树投在地面上的影子是如此的清晰，马上想到了一个问题：树影的面积是多大呢？

李哲知道，直接测量面积是很难的，他想用几何的方法算，因为他对这棵柠檬树的形状了解得非常清楚，而且想好了简化的方法。

李哲将整棵柠檬树分成了 $n$ 层，由下向上依次将层编号为 $1,2,...,n$。从第 $1$ 到 $n-1$ 层，每层都是一个圆台型，第 $n$ 层(最上面一层)是圆锥型。对于圆台型， 其上下底面都是水平的圆。对于相邻的两个圆台，上层的下底面和下层的上底面重合。第 $n$ 层(最上面一层)圆锥的底面就是第 $n-1$ 层圆台的上底面。所有的底面 的圆心(包括树顶)处在同一条与地面垂直的直线上。李哲知道每一层的高度为 $h_1,h_2,...,h_n$，第 $1$ 层圆台的下底面距地面的高度为 $h_0$，以及每层的下底面的圆的半径 $r_1,r_2,...,r_n$。李哲用熟知的方法测出了月亮的光线与地面的夹角为 $\mathrm{alpha}$。

![](https://cdn.luogu.com.cn/upload/pic/13770.png)

为了便于计算，假设月亮的光线是平行光，且地面是水平的，在计算时忽略树干所产生的影子。李哲当然会算了，但是他希望你也来练练手。
## 输入格式

第一行包含一个整数 $n$ 和一个实数 $\mathrm{alpha}$，表示柠檬树的层数和月亮 的光线与地面夹角（单位为弧度）。

第二行包含 $n+1$ 个实数 $h_0,h_1,h_2,...,h_n$ 表示树离地的高度和每层的高度。

第三行包含 $n$ 个实数 $r_1,r_2,...,r_n$ 表示柠檬树每层下底面的圆的半径。

同一行相邻的两个数之间用一个空格分隔。

输入的所有实数的小数点后可能包含一至十位有效数字。
## 输出格式

输出一个实数，表示树影的面积，四舍五入保留两位小数。
## 样例

### 样例输入 #1
```
2  0.7853981633 
10.0  10.00  10.00 
4.00  5.00
```
### 样例输出 #1
```
171.97
```
## 提示

对于 $10 \%$ 的数据，$n \leq 1$；

对于 $30 \%$ 的数据，$n \leq 2$；

对于 $60 \%$ 的数据，$n \leq 20$；

对于 $100 \%$ 的数据，$1 \leq n \leq 500$，$0.3 < \mathrm{alpha} < \frac{\pi}{2}$，$0 < h_i \leq 100$，$0 < r_i \leq 100$。


---

---
title: "无意识之外的捉迷藏"
layout: "post"
diff: NOI/NOI+/CTSC
pid: P4232
tag: ['递归', '线性规划', '期望']
---
# 无意识之外的捉迷藏
## 题目背景

### （五）心与心的对话

旧都还在下着雪。

不知道走了多远的路，已经远离街市了。

眼前隐隐约约能看到一座巨大的宫殿。

那就是，地灵殿吗？

心里突然紧张了起来。

这里住着旧地狱最可怕的觉妖怪。

古明地觉，她拥有读心的能力。人类，妖怪，甚至是怨灵，站在她面前的时候都如同赤身裸体，没有任何秘密可言。而且，听说在战斗中，她还会使用催眠术不断激起对手内心深处的恐怖回忆，从心灵上打垮对手。这样的妖怪自然会被人讨厌啦。

不过，此次地底之旅可不能因为要遇到可怕的妖怪而就此结束。

咚咚咚，敲了敲地灵殿的大门。

“来客吗，真是少见呢。”

眼前，站着一个少女，穿着蓝色的衣服，粉红色的裙子，头发也是粉红色的。

在她的胸前，悬着一只红色的大眼睛，通过眼睛周围的六根管子连接着身体。

她看起来很温柔的样子，完全不像听说的那样恐怖。

“来地底旅行的外面世界的人类吗？真是非常少见呢，居然找到了这里”

“看起来没有别的想法，就是想来转转呢，那就进来吧”

走进大门。

不愧是地灵”殿”，真的是好大的一个宫殿，桃红色和黑色相间的地板，印有花纹的窗户。

眼前是一组很宽的台阶，通向二楼，然后分成左右两个通道。

“很漂亮吧，这里空间大，宠物们都很喜欢呢。”

就这样，我跟着觉进入了她工作的房间，我们坐在沙发上聊了很久，虽然我很少说话。

在聊天的过程中，我了解到她还有一个妹妹古明地恋，由于不愿让别人因为自己会读心而讨厌自己，闭上了觉之瞳。觉为了开导妹妹，经常和宠物陪着她玩。

地灵殿，觉和妹妹，宠物们，一直在过着平静又温馨的生活。

“既然来这里了，就和我们一起玩吧。”觉邀请我们参与她们的游戏。

地底的妖怪会玩怎样的游戏呢？

于是，就这样，我就答应参与觉和恋的“无意识的捉迷藏”了。

说是”捉迷藏”，其实和普通的捉迷藏区别很大，更类似于”捉人游戏”。

就是觉和恋一开始分别站在两个地方，觉要捉到恋就算赢了。

但为什么又说是”捉迷藏”呢？

原来恋恋可以无意识地行动，也就是可以让周围人在潜意识里忽略她的存在，类似隐身，但又不是隐身。真是有趣的能力呢，是不是闭上了觉之瞳的缘故？

我们玩得很开心。有时无意识碰到了恋恋的手，还吓了一跳呢。

一段时间后，姐妹俩累了，觉还有工作要处理，就先回去了。

宠物们似乎意犹未尽，她们还想继续。

“可是在这个旧地狱啊，除了主人的妹妹恋以外，哪里又有妖怪能够操纵无意识呢？

算了,干脆玩普通的捉人游戏吧。”阿燐提议道。

于是宠物们很快又忘我地投入了”无意识之外的捉迷藏”中。

不知什么时候，我感到背后一凉，回过头一看，原来是恋恋。

我们就这样站在这里看着宠物们玩。

虽然不知道为什么能耐心地看那么长时间，但几个小时过去了，我们依然站在这里。

恋恋好像有一些疑问，在经过简单的交流后，我把她的疑问做了一个总结。

(见题目描述)

这个问题对无意识的恋恋来说果然无法解决啊。

能和姐妹俩聊得这么开心，真是很感激呢，那就尽自己的努力思考一下这个问题吧。

(后续剧情见题解，接下来请看T4)

## 题目描述

###问题摘要：

在一个有向无环图上，阿燐和阿空第0个时刻分别站在编号为$s_r$,$s_k$的节点，二人都知道双方的初始位置，对地图完全了解。

从第1个时刻起，每个时刻阿燐和阿空都可以选择站着不动，也可以选择移动到相邻的节点，二人每时刻的移动是同时开始的，并且不能中途改变方向。

阿燐被阿空捉住时，游戏立即结束。如果阿空一直没有捉住阿燐，第$t$个时刻结束后两人就不能再继续移动了，游戏将在第$t+1$个时刻结束。

阿空的目的是尽快捉住阿燐(捉住的定义是与阿燐同一时刻站在同一节点)，而阿燐的目的是尽可能更长时间不被阿空捉住。具体而言，若一场游戏进行了$t_0$时刻，阿燐的得分是$t_0$，阿空的得分是$-t_0$，双方都希望自己得分(或得分的期望值)更高。

我们认为在这个过程中阿燐和阿空随时都能知道对方的位置。两人在第$t$个时刻不能看出第$t+1$个时刻对方要走到哪里。

恋恋想知道，在双方最优决策的情况下，游戏结束时刻的期望值是多少。

## 输入格式

第一行5个整数$n$,$m$,$s_r$,$s_k$,$t$，用空格隔开，下同。

$n$表示地图点数，$m$表示边数。

接下来$m$行，每行两个整数$a$,$b$，表示从$a$到$b$有一条单向边(不存在重边)。

## 输出格式

一个实数，四舍五入保留3位小数，表示游戏结束时刻的期望值。

你的答案必须和标准答案完全相同才算正确。

## 样例

### 样例输入 #1
```
3 2 1 2 10
1 3
2 3

```
### 样例输出 #1
```
11.000
```
### 样例输入 #2
```
6 8 2 1 2
1 2
1 3
1 5
2 3
3 5
5 6
6 4
2 4

```
### 样例输出 #2
```
2.333
```
## 提示

###样例解释：

样例1：阿燐只要一直不动，阿空在前$t$单位时间内就无法抓到阿燐，答案为$t+1$，即```11.000```

样例2：无可奉告

###数据范围：

对于30%的数据 $n\leqslant3$，捆绑测试

对于100%的数据 $n,t\leqslant20$，前40%的数据和后30%的数据分别捆绑测试

###提示：
本题主要考察你能否使用正确的方法算出答案，对算法运行耗时要求不高。

by orangebird



---

---
title: "[COCI 2009/2010 #1] ALADIN"
layout: "post"
diff: NOI/NOI+/CTSC
pid: P4433
tag: ['数学', '2009', '线段树', '递归', 'COCI（克罗地亚）']
---
# [COCI 2009/2010 #1] ALADIN
## 题目描述

给你 $n$ 个盒子，有 $q$ 个操作，操作有两种：

- 第一种操作输入格式为 `1 L R A B`，表示将编号为 $L$ 到 $R$ 的盒子里的石头数量变为 $(X-L+1) \times A \bmod B$，其中 $X$ 为盒子的编号。
- 第二种操作输入格式为 `2 L R`，表示查询编号为 $L$ 到 $R$ 的盒子里的石头总数。
## 输入格式

第一行有两个数字 $n$（$1 \leq n \leq 10^9$），$q$ （$1 \leq q \leq 5 \times 10^4$）。

接下来 $q$ 行表示询问操作。
## 输出格式

对于每个第二种操作，输出石头总数。
## 样例

### 样例输入 #1
```
6 3
2 1 6
1 1 5 1 2
2 1 6

```
### 样例输出 #1
```
0
3
```
### 样例输入 #2
```
4 5
1 1 4 3 4
2 1 1
2 2 2
2 3 3
2 4 4

```
### 样例输出 #2
```
3
2
1
0
```
### 样例输入 #3
```
4 4
1 1 4 7 9
2 1 4
1 1 4 1 1
2 1 4

```
### 样例输出 #3
```
16
0
```
## 提示

- 对于 $30\%$ 的数据，$n, q \leq 10^3$；
- 对于 $70\%$ 的数据，$q \leq 10^3$。

对于 $100\%$ 的数据，$1\leq A,B\leq 10^6$。


---

---
title: "[Ynoi Easy Round 2016] 镜中的昆虫"
layout: "post"
diff: NOI/NOI+/CTSC
pid: P4690
tag: ['2016', '树状数组', '递归', 'O2优化', '分治', 'Ynoi']
---
# [Ynoi Easy Round 2016] 镜中的昆虫
## 题目背景

镜子的世界里会有美丽的东西吗？

镜子的世界里会有快乐的事情吗？

镜子世界的我，像我一样摆着一副无聊的表情

——出自《镜之国的爱丽丝》

![](https://cdn.luogu.com.cn/upload/pic/21104.png)

两个少女的战斗故事

文学代表强烈的意志，化学是对抗物理世界的力量

她们只有这两样对抗现实的武器

![](https://cdn.luogu.com.cn/upload/pic/21105.png)

啊，勒布雷！

我今天要登上乳白色的月球了！

不需要发明是机器，真是如此，我要一跃而出！

没错朋友！那个月亮的世界！

才是为我们创造的世界！

不止一个我所爱的人，大概都被放逐到那里...然后在等着我...

苏格拉底！伽利略！

物质的基本要素的灵魂就是...

这是...不，这有问题...哥白尼说过！

没错朋友们，究竟为何，会中了魔障？

究竟为何，会中了魔障，他到底去双桅战船上干什么呢？

作为哲学家！

物理学家！

诗人！

剑客！

音乐家！

空中旅行家！

针尖对麦芒的辩士！

他无所不能

作为至高...但是...

却又一事无成...

...没错，你们这些家伙，想夺走我的一切！

...来，夺走吧，夺走就是了...

但是...无论你们再怎么叫嚷，在去往新世界的路上，我还是会带走一个！

让我看看你坚强的心吧！

没错，你帽子上的羽饰！

象征你内心的勇气的纹章...毛子上的羽饰！

对不起，我该走了，我不能让人久等！

你们看...月亮来迎接我了！

Mon panache！

![](https://cdn.luogu.com.cn/upload/pic/21106.png)

我往空中踏出一步

两人拼命地想要拉住我

但是我往空中踏出一步

没错

我要为了崭新的世界，从天而降

为了获得新的力量

为了新的真实

我踏出了这一步

从手上，感到了两人的颤抖

没关系...

我在你们身边！

Sora！

![](https://cdn.luogu.com.cn/upload/pic/21109.png)

我完全投身于空中

我的身体瞬间从空中向地面落去

我紧紧地握住两人手腕，拉着两人

看见两人的表情...

她们边哭边笑...

似乎很害怕...

却又似很高兴的表情...

啊...

什么嘛，飞翔好舒服啊

宛如变成了天使一般...

好快的速度...

好快的风...

但是却听不见声音...

世界在静静地回转

已经，马上就要到地面了...

空气力学的先驱者...

我知道一切都在回转的天空，

还有包容着我的大地

还差一点，就抵达世界了...

还差一点，就抵达地面了...

接近着的影子

地面映出我的身影

## 题目描述

您正在欣赏 galgame 的 HS，然后游戏崩溃了，于是您只能做数据结构题了：

维护一个长为 $n$ 的序列 $a_i$，有 $m$ 次操作。

1. 将区间 $[l,r]$ 的值修改为 $x$。

2. 询问区间 $[l,r]$ 出现了多少种不同的数，也就是说同一个数出现多次只算一个。

## 输入格式

第一行两个整数 $n,m$。

第二行 $n$ 个整数表示 $a_i$。

后面 $m$ 行每行为 $1\ l\ r\ x$ 或者 $2\ l\ r$ ，分别表示修改和询问。
## 输出格式

对于每个询问，输出一个数表示答案。
## 样例

### 样例输入 #1
```
5 5
1 2 3 4 5
2 1 5
1 2 3 4
2 1 5
2 3 3
2 2 4
```
### 样例输出 #1
```
5
3
1
1
```
## 提示

Idea：nzhtl1477，Solution：nzhtl1477，Code：nzhtl1477，Data：nzhtl1477

$1\leq n , m \leq 10^5$，$1\leq a_i\leq 10^9$。


---

---
title: "「Stoi2031」兰亭序 加强版"
layout: "post"
diff: NOI/NOI+/CTSC
pid: P7513
tag: ['数学', '递推', '递归', 'O2优化', '素数判断,质数,筛法', '快速傅里叶变换 FFT', '快速数论变换 NTT']
---
# 「Stoi2031」兰亭序 加强版
## 题目描述

本题是 「Stoi2031」兰亭序 的加强版。[原题链接](https://www.luogu.com.cn/problem/P7487)

给定 $n=a^b,k$，对 $1 \le t \le k$ 求

$$\prod_{x_1=1}^{n}\prod_{x_2=1}^{n}\dots\prod_{x_t=1}^{n}\left( 1+e^{\frac{2\pi ix_1x_2\dots x_t}{n}} \right) \bmod{335544323}$$

输出所有 $k$ 个答案的异或和。

其中 $e^{it}=\cos{t}+i\sin{t}$ 对所有 $t \in \mathbb{R}$ 成立，$i$ 为虚数单位，满足 $i^2=-1$。
## 输入格式

一行三个正整数 $a,b,k$，其中 $n=a^b$。
## 输出格式

一行一个自然数表示答案。
## 样例

### 样例输入 #1
```
15 1 2

```
### 样例输出 #1
```
201012023

```
### 样例输入 #2
```
1 7 3

```
### 样例输出 #2
```
2

```
### 样例输入 #3
```
3 2 3

```
### 样例输出 #3
```
301162058

```
### 样例输入 #4
```
4 2 2

```
### 样例输出 #4
```
0

```
### 样例输入 #5
```
19260817 114514 13579

```
### 样例输出 #5
```
461194421

```
## 提示

对于所有数据，$1 \le a \le 10^{18}$，$1 \le b \le 10^{13}$，$1 \le k \le 10^5$。


---

---
title: "醒来"
layout: "post"
diff: NOI/NOI+/CTSC
pid: P8553
tag: ['递归', '洛谷原创', 'Special Judge', 'O2优化', '分治', '构造', '洛谷月赛']
---
# 醒来
## 题目背景


“那羡慕的烟火去哪了，那信任的朋友疏远了。

我年幼时坚持过什么，你们还记不记得。”

回想自己儿时的样子，已和现在大不相同了；但想想昨天的自己，却与今天没什么差异。这不经意的改变，让我们已经是另一个样子了。
## 题目描述

赫尔德用一个长为 $r-l+1$ 的数列 $a$ 来描述自己性格的变化。但赫尔德记忆不好，她已经记不清 $a$ 了，只记得非负整数 $l,r$，其中 $l<r$。

不过，她还记得：

1.  $l\le a_i\le r$，且 $a_i$ 互不相同。换言之，$a$ 是一个 $l\sim r$ 的排列。
2.  对于所有 $1\le i\le r-l$，有 $\operatorname{popcount}(a_i \mathbin{\mathrm{xor}} a_{i+1})=1$。换言之，$a$ 中相邻的两个数二进制下只相差一位。

请你告诉她一个可能的 $a$，或告诉她其实不存在这样的 $a$。
## 输入格式

仅一行，两个非负整数 $l,r$。
## 输出格式

第一行，若有解输出 `Yes`，若无解则输出 `No`。不区分大小写。

若你输出了 `Yes`，则你可以用以下两种格式之一输出你的构造：

1. 输出一行 $r-l+1$ 个数，表示你构造的排列。
3. 先输出一个数，表示你构造排列的第一个数。接下来输出一个长为 $r-l$ 的字符串，对于第 $i$ 个字符，若你构造排列第 $i$ 与 $i+1$ 个数相差了 $2^k$，则你应该输出第 $k+1$ 个小写英文字母，即 `(char)('a'+k)`。 

**注意，若你使用格式 1 输出，你可能无法通过最后两个子任务。若您获得了 UKE 的评测结果，请考虑修改输出答案的格式。**

---

**【评分方法】**

本题采用**自定义校验器**检测你的输出。

若你对解的存在性判断错误，你无法获得任何分数。

若你对解的存在性判断正确，你可以获得 $40\%$ 的分数；若解不存在或你给出了一组正确的构造，则你可以获得剩下 $60\%$ 的分数。
## 样例

### 样例输入 #1
```
0 7

```
### 样例输出 #1
```
Yes
0 1 3 2 6 7 5 4

```
### 样例输入 #2
```
0 7

```
### 样例输出 #2
```
yEs
0 abacaba

```
### 样例输入 #3
```
0 7

```
### 样例输出 #3
```
yes

```
### 样例输入 #4
```
3 5

```
### 样例输出 #4
```
No

```
## 提示

**【样例解释 \#1、\#2、\#3】**

样例输出 \#1 和 \#2 对应同一个数列，即 $\{ 0, 1, 3, 2, 6, 7, 5, 4 \}$，它们均能获得该测试点 $100 \%$ 的分数。

样例输出 \#3 能获得该测试点 $40 \%$ 的分数。

----

**【数据范围】**

对于所有数据，保证 $0\le l<r\le 10^7$。

设 $n=r-l+1$。

$$
\def{\arraystretch}{1.5}
\begin{array}{c|c|c|c}\hline 
\textbf{子任务编号}&\bm{~~~~~~~~n\le~~~~~~~~}&~~~~\textbf{特殊限制}~~~~&\textbf{分数}\cr\hline 
\textsf1 & 10& &9\cr\hline 
\textsf2 & 20& &9 \cr\hline 
\textsf3 & 10^5&\textsf{A, B}&10\cr\hline 
\textsf4 & 10^5 &\sf A&10\cr\hline 
\textsf5 & 2000& \textsf C&25 \cr\hline
\textsf6 & 5\times 10^5&\textsf D&20\cr\hline
\textsf7 & 3\times 10^6&&10\cr\hline
\textsf8 & &&7\cr\hline
\end{array}
$$

$\textsf A$：保证 $l=0$。

$\textsf B$：保证 $n$ 是 $2$ 的整数次幂。

$\textsf C$：保证 $l$ 是偶数，$r$ 是奇数。

$\textsf D$：本子任务有 5 个测试点，从所有 $n\ge 2\times 10^5$ 且有解的数据中随机生成。

---

即使一直在改变，赫尔德也许仍似儿时的自己。


---


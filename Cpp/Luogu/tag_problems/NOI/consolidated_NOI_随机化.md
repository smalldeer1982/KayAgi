---
title: "[集训队互测 2023] Grievous Lady"
layout: "post"
diff: NOI/NOI+/CTSC
pid: P10010
tag: ['动态规划 DP', '数学', '集训队互测', '2023', '爬山算法 Local search', '模拟退火', '随机调整', '线性规划', '概率论', '线性代数', '随机化']
---
# [集训队互测 2023] Grievous Lady
## 题目背景

对立从那灰暗的塔楼进入，逐步踏入这个扭曲的迷宫深处。

对立的心突然绞痛起来。

对立后退了一步，扑腾了一下便跪倒下来。

未及碰到，灰黑的地板就突然崩裂瓦解，先一步向下坠落。

先前收集的纷争碎片，连同塔楼本身，一同化作了一场倾盆大雨，包围在对立四周。

异象骤起，对立的思维也陷入一片混乱。

塔楼落入了先前的由光芒碎片组成的欢乐海洋，但对立却被纷争碎片紧紧地包裹着。

在那由光芒和纷争碎片交错的风暴之中，对立所见的只有那些令人厌恶的纷争碎片。

那枚世界尽头的记忆映入了对立的视野。

面对着世界一点点地走向终结的景象，对立的理性在碎裂。

对立意识到，一切美好的记忆不过是须臾，最终都会走向破灭。

四周的碎片依旧在飞旋，对立试图看清那些玻璃碎片的变换。

对立意识到，现在围绕着的那些碎片，正以最恐怖的方式运转。

这个碎片风暴所带来的「忧郁度」，可以被简单地描述为外侧碎片的旋转速度之和乘上内侧碎片的旋转速度之和。

一片玻璃碎片在外侧总是以一种速度正旋，而在内侧总是以另一种速度逆旋。

每片碎片都是是来自不同世界的刹那记忆，故而其转速总可以认为是独立随机指定的。

在残存无几的希望将尽未尽之时，对立只想知道，现在的碎片风暴的忧郁度，也就是最大可能的忧郁度，究竟是多少。
## 题目描述

共有 $n$ 个元素，标号 $1\sim n$，每个元素 $j$ 有两个正整数权值 $a_j,b_j$。

你要确定一个 $[1,n]\cap\mathbb N$ 的子集 $S$，从而最大化

$$
(\sum_{k=1}^na_k[k\in S])(\sum_{k=1}^nb_k[k\notin S])
$$

这个问题显然不可做，因此**保证每个 $a_j,b_j$ 分别在 $[1,A]\cap\mathbb N,[1,B]\cap\mathbb N$ 内独立均匀随机生成**。

现在给定 $n,A,B$ 和每个元素的两个权值 $(a_j,b_j)$，请求出这个最大的答案。
## 输入格式

本题每个测试点中有多组测试数据。

第一行四个整数，$T,n,A,B$，$T$ 表示该组数据内的数据组数，$n,A,B$ 表示该测试点内的所有数据均对应此 $n,A,B$。

接下来每组数据占 $n$ 行，其中第 $j$ 行两个整数 $a_j,b_j$。

保证 $a_j,b_j$ 在对应范围内独立均匀随机生成。
## 输出格式

对于每组数据输出一行一个整数，表示其答案。

注意这个答案可能很大，你可能需要使用 `__int128` 类型来进行中间存储与运算，并最后输出。注意你可能需要使用一些正确的输出方式。

## 提示

#### 输入输出样例

**因为本题数据规模太大，直接提交评测会对评测机带来很大压力，本题将提供很多大样例；请尽量减少本题的提交次数。**

请参见下发文件 `grievouslady*.in/ans`，共 $50$ 组，基本按照部分分的方法造。

由于本题保证数据随机，不提供手搓样例。

#### 数据范围与提示

对于所有的数据，保证 $10\le n\le3000$，$10^4\le A,B\le10^{12}$，$1\le T\le50$。

~~本题设置子任务，各子任务~~共 $100$ 个测试点。具体的测试点分布可以见下表。

**本题在洛谷上的版本不设置子任务**。

（**由于表格比较宽，洛谷上较难完整显示，你可能要使用题目页面的“展开”功能**）

|测试点编号|$n$|$A$|$B$|测试点编号|$n$|$A$|$B$|测试点编号|$n$|$A$|$B$|
|:-:|:-:|:-:|:-:|:-:|:-:|:-:|:-:|:-:|:-:|:-:|:-:|
|$1\sim2$|$=10$|$=10^4$|$=10^4$|$33\sim34$|$=100$|$=10^4$|$=10^4$|$67\sim68$|$=1000$|$=10^5$|$=10^{12}$|
|$3\sim4$|$=10$|$=10^9$|$=10^9$|$35\sim36$|$=100$|$=10^5$|$=10^5$|$69\sim70$|$=1000$|$=10^9$|$=10^9$|
|$5\sim6$|$=10$|$=10^{12}$|$=10^{12}$|$37\sim38$|$=100$|$=10^5$|$=10^9$|$71\sim72$|$=1000$|$=10^{12}$|$=10^{12}$|
|$7\sim8$|$=20$|$=10^4$|$=10^4$|$39\sim40$|$=100$|$=10^9$|$=10^9$|$73\sim74$|$=1500$|$=10^5$|$=10^{12}$|
|$9\sim10$|$=20$|$=10^9$|$=10^9$|$41\sim42$|$=100$|$=10^{12}$|$=10^{12}$|$75\sim76$|$=1500$|$=10^9$|$=10^9$|
|$11\sim12$|$=20$|$=10^{12}$|$=10^{12}$|$43\sim44$|$=200$|$=10^5$|$=10^{12}$|$77\sim78$|$=1500$|$=10^{12}$|$=10^{12}$|
|$13\sim14$|$=30$|$=10^4$|$=10^4$|$45\sim46$|$=200$|$=10^9$|$=10^9$|$79\sim80$|$=2000$|$=10^5$|$=10^{12}$|
|$15\sim16$|$=30$|$=10^9$|$=10^9$|$47\sim48$|$=200$|$=10^{12}$|$=10^{12}$|$81\sim82$|$=2000$|$=10^9$|$=10^9$|
|$17\sim18$|$=30$|$=10^{12}$|$=10^{12}$|$49\sim50$|$=300$|$=10^5$|$=10^{12}$|$83\sim84$|$=2000$|$=10^{12}$|$=10^{12}$|
|$19\sim20$|$=40$|$=10^4$|$=10^4$|$51\sim52$|$=300$|$=10^9$|$=10^9$|$85\sim86$|$=2500$|$=10^4$|$=10^9$|
|$21\sim22$|$=40$|$=10^9$|$=10^9$|$53\sim54$|$=300$|$=10^{12}$|$=10^{12}$|$87\sim88$|$=2500$|$=10^5$|$=10^{12}$|
|$23\sim24$|$=40$|$=10^{12}$|$=10^{12}$|$55\sim56$|$=500$|$=10^5$|$=10^{12}$|$89\sim90$|$=2500$|$=10^9$|$=10^9$|
|$25\sim26$|$=50$|$=10^4$|$=10^4$|$57\sim58$|$=500$|$=10^9$|$=10^9$|$91\sim92$|$=2500$|$=10^{12}$|$=10^{12}$|
|$27\sim28$|$=50$|$=10^4$|$=10^9$|$59\sim60$|$=500$|$=10^{12}$|$=10^{12}$|$93\sim94$|$=3000$|$=10^4$|$=10^9$|
|$29\sim30$|$=50$|$=10^9$|$=10^9$|$61\sim62$|$=800$|$=10^5$|$=10^{12}$|$95\sim96$|$=3000$|$=10^5$|$=10^{12}$|
|$31\sim32$|$=50$|$=10^{12}$|$=10^{12}$|$63\sim64$|$=800$|$=10^9$|$=10^9$|$97\sim98$|$=3000$|$=10^9$|$=10^9$|
|||||$65\sim66$|$=800$|$=10^{12}$|$=10^{12}$|$99\sim100$|$=3000$|$=10^{12}$|$=10^{12}$|

~~我们按如下方式布局各测试点~~：
* ~~subtask $1$：$1\sim12$，占 $\rm12pts$~~。
* ~~subtask $2$：$13\sim32$，占 $\rm20pts$~~。
* ~~subtask $3$：$33\sim36$，占 $\rm4pts$~~。
* ~~subtask $4$：$37\sim48$，占 $\rm12pts$~~。
* ~~subtask $5$：$49\sim50$，占 $\rm2pts$~~。
* ~~subtask $6$：$51\sim60$，占 $\rm10pts$~~。
* ~~subtask $7$：$61\sim72$，占 $\rm12pts$~~。
* ~~subtask $8$：$73\sim84$，占 $\rm12pts$~~。
* ~~subtask $9$：$85\sim92$，占 $\rm8pts$~~。
* ~~subtask $10$：$93\sim100$，占 $\rm8pts$~~。

~~**本题不设置子任务依赖，因此请确保经样例测试后你的算法正确后再提交，以免卡评测机**。~~

#### 后记

这个世界——一切——都源于过去。过去的影像，哪怕是欢乐的记忆，就像是白昼过后的黑夜，渐渐导致了这份世界末日。

泪水盈眶。对立的眼神转为一片黑暗。

对立与这些玻璃起了共鸣，围绕于四周的回忆之壳开始崩裂。

对立就身处其中，站在那炫目的光芒前方，已经没有任何情感了。

扭曲的迷宫，也在对立的力量下，悉数损毁……

时光逝去，对立变了。不再激情地收集回忆，而是近乎无意识地走在这世界之中，并不再抱有任何雄心壮志。

如今，对立正在一个破旧坍塌的建筑旁行走着，旋转着某天在废墟中找到的太阳伞。




---

---
title: "[THUPC 2024 决赛] 采矿"
layout: "post"
diff: NOI/NOI+/CTSC
pid: P10546
tag: ['2024', '交互题', 'Special Judge', '随机化', '构造', 'THUPC']
---
# [THUPC 2024 决赛] 采矿
## 题目背景

在精心地规划完工人的移动路线，执行完所有计划之后，你终于有钱了。你承包下了一个更大的矿坑，并购买了更先进的设备。

但是开始运行了你才发现，一部分运输矿物的通道居然装反了！还好它们本来就是可以反向的，并且中控的系统可以让你轻易地操作。

然而，现在最大的问题是，你刚刚接手这个矿坑，你甚至连它长什么样都不知道，也就更不知道每个开关是对应哪一条运输通道的。

时间就是金钱，你想要尽快摸清整个矿坑的结构以及所有开关与通道的对应关系。
## 题目描述

**这是一道交互题。**

已知你的矿坑有 $n$ 个节点，编号为 $1\sim n$。它们通过 $n-1$ 条运输通道连成一个树形结构。

运输通道都是单向的。对于一条从节点 $u$ 到节点 $v$ 的运输通道，可以将所有由节点 $u$ 产出的矿或运送到节点 $u$ 的矿以较快的速度运送到节点 $v$。如果一个节点有多条以其为起点的运输通道，那么会把这些矿平均分配给这些运输通道。

中控的系统包含 $n-1$ 个开关和一个监视器。开关的编号为 $1\sim n-1$，每个开关可以拨到 $0$ 或 $1$ 的位置。$n-1$ 个开关和 $n-1$ 条运输通道一一对应，但你并不知道它们的对应关系。你只知道，假设编号为 $i$ 的开关对应的运输通道在被装上去时是从 $u_i$ 到 $v_i$ 的，那么当开关拨到 $0$ 的时候，它的运输方向和它被装上去时相同；当开关拨到 $1$ 的时候，它的运输方向会变成从 $v_i$ 到 $u_i$。你的监视器可以监控到达每个节点的矿分别来自多少个不同的节点，也就是说，有多少个节点（包括其本身）能够通过运输通道把矿运输到这个节点。

当你调整完开关的位置后，需要等一段时间，监视器的结果才会趋于稳定，这时你的读数才是有意义的。所以为了避免浪费太多时间，你希望在 $50$ 次读数之内确定你想知道的所有信息。
## 输入格式

开始时你需要输入一个正整数 $n$。保证 $2\le n \le 10000$。

之后的输入会基于你的输出生成读数。你的读数结果是一行 $n$ 个正整数，其中第 $i$ 个表示到达节点 $i$ 的矿来自多少个不同的节点。

每个测试点中，矿坑的连接方式和所有运输通道刚装上去时的方向都是固定的，也就是说，这些不会因为你的输出而动态修改为另外一种符合之前所有回答的方案。
## 输出格式

当你需要调整开关并等待读数时，输出一行 `? s`，其中 `s` 为一个长为 $n-1$ 的 `01` 串，其中第 $i$ 位表示编号为 $i$ 的开关拨到的位置。然后交互库会在你的标准输入中给出监视器趋于稳定之后的读数结果。你最多只能读数 $50$ 次。

当你已经知道了所有通道的信息时，输出一行 `! u1 v1 ... un-1 vn-1`，其中 $u_i,v_i$ 表示编号为 $i$ 的开关对应的运输通道被装上去时的方向是从节点 $u_i$ 到节点 $v_i$ 的。

在输出一行之后，你需要刷新输出缓冲区，否则评测结果可能会变成 `TLE`。刷新输出缓冲区的方式为：

- C：`fflush(stdout);`

- C++：`fflush(stdout);` 或 `std::cout.flush();` 或使用 `std::endl` 换行

- Java：`System.out.flush();`

- Python：`sys.stdout.flush()`

## 样例

### 样例输入 #1
```
5

1 4 1 2 3

1 1 2 3 4
```
### 样例输出 #1
```

? 0110

? 0000

! 1 4 2 3 2 4 4 5
```
## 提示

![](https://cdn.luogu.com.cn/upload/image_hosting/fuc2u4d1.png)

通道的初始方向如上图所示。通道上的数字代表和通道对应的开关的编号。

样例只是用来说明输入输出格式和读数结果，并不意味着这次读数能够推出答案。


交互库的运行时间和内存不计入时间和内存限制。

若超出读数次数限制、最后的回答错误或输出格式错误，评测结果均为 `WA`。


**来源与致谢**

来自 THUPC2024（2024年清华大学学生程序设计竞赛暨高校邀请赛）决赛。感谢 THUSAA 的提供的题目。

数据、题面、标程、题解等请参阅 THUPC 官方仓库 <https://thusaac.com/public>




---

---
title: "[集训队互测 2024] 欧伊昔"
layout: "post"
diff: NOI/NOI+/CTSC
pid: P12482
tag: ['集训队互测', '2024', '线性代数', '随机化', '快速沃尔什变换 FWT']
---
# [集训队互测 2024] 欧伊昔
## 题目背景

伊是欧最为仰慕的 OIer，因为不仅伊水平甚高，欧还常能见到伊。  
那段时间曾是欧最铭记的时刻，她原以为一切都会如此顺利。  
直到一个夏天，那天大雨，雨滴在玻璃板上噼啪作响。  
在这之后，一切都不复存在。  
欧知道伊去了哪里。  
但又不想知道。

后来的一天，她发现黑板上的一处未被擦除的草稿。  
她也终于找出先前某天的些许快乐时光：  
那时候欧丢给伊一个问题，是求两个三进制数的高维“卷积”。  
但是她忘记了具体方式，于是随口说了一个看似没有性质的按位取 $\text{mex}$，作为运算表。  
伊给出了一种做法。可是这个做法还是太特殊了。  
然后她直接询问了没有性质的做法。  
然后…… 她记不起来了。

那天大雨后她已经丢失了所有关于他的回忆。直到现在才找回来一些碎片。  
欧此时认为，当时的伊一定给出了一个更为优秀的解法，对于随机生成的运算表，因为这“没有性质”。  
也许只需要做稍做修改…… 就能找回那天末尾的记忆。仅此就好。
## 题目描述

题目给出一个 $3\times 3$ 的运算表 $\text{op}$，数组下标和值域均在 $[0,2]$。

记 $v_3(a)_b$ 为 $a$ 在三进制表示下的第 $b$ 位的数字（最低位为 $0$）。

对于两个数 $0\le i,j<3^n$，定义 $i\mathop{\mathrm{op}}j$ 满足 $v_3(i\mathop{\mathrm{op}}j)_k=\text{op}_{v_3(i)_k,v_3(j)_k}\quad(0\le k< n)$。

还给出两个数组 $A_i,B_i$，在 $[0,9]$ 的整数内取。对于每个 $x$ 求：

$$C_x=\sum_{i\mathop{\mathrm{op}}j=x}A_iB_j$$

特别的，运算表随机生成，且每组子任务有恰好五组数据（最后一组例外，有十组）。
## 输入格式

前三行每行三个整数，第 $i$ 行第 $j$ 个数表示 $\text{op}_{i-1,j-1}$。  
接下来一行一个整数 $n$ 表示维数。  
接下来一行，每行 $3^n$ 个整数，第 $i$ 个整数表示 $A_{i-1}$。
接下来一行，每行 $3^n$ 个整数，第 $i$ 个整数表示 $B_{i-1}$。
数字间用空格隔开。
## 输出格式

一行 $3^n$ 个整数，第 $i$ 个整数表示 $C_{i-1}$。
## 样例

### 样例输入 #1
```
1 2 1
1 2 0
2 1 0
1
5 7 8
9 8 4
```
### 样例输出 #1
```
60 192 168
```
### 样例输入 #2
```
0 0 1
0 2 0
2 2 1
2
8 1 1 8 1 3 2 5 3
9 0 6 3 5 3 4 9 6
```
### 样例输出 #2
```
358 213 97 190 84 106 209 78 105 
```
## 提示

### 样例解释

样例 1 和 2 只满足子任务 5 的性质并使用其数据生成器生成。  

样例 3 至样例 8 分别对应除子任务 5 以外的其他子任务，并使用和该子任务测试数据一样的数据生成器生成。  

### 数据范围与提示

Subtask 1（5 pts）：$\text{op}_{i,j}=i+j\bmod 3$；  
Subtask 2（5 pts）：$\text{op}_{i,j}=\text{mex}(i,j)$，$\text{mex}(i,j)$ 表示最小的不等于 $i$ 或 $j$ 的非负整数；  
Subtask 3（20 pts）：$\text{op}_{i,j}\in\{0,1\},$ 且任意两行，每一位要么全部相同，要么全部不同；  
Subtask 4（30 pts）：$\text{op}_{i,j}\in\{0,1\}$；  
Subtask 5（10 pts）：$n\le 9$；  
Subtask 6（10 pts）：$n=10$，~~依赖 Subtask 5~~；  
Subtask 7（20 pts）：$n=11$，~~依赖 Subtask 6~~。

目前子任务依赖尚未配置。

对于 $100\%$ 的数据，保证 $1\le n\le 11$，$\text{op}_{i,j}$ 在子任务要求下均匀随机地从所有可能方案中选择一种。  
保证 $0\le A_i,B_i\le 9$ 且为整数。**除最后一组外每组子任务恰有 $5$ 组数据，最后一组子任务有 $10$ 组。**


---

---
title: "骷髅打金服"
layout: "post"
diff: NOI/NOI+/CTSC
pid: P12608
tag: ['洛谷原创', '分治', '哈希 hashing', '随机化', '洛谷月赛', '哈希表']
---
# 骷髅打金服
## 题目背景

下图是一个经典算法的错误实现。
## 题目描述

长为 $n$ 的序列 $a$ 的一个非空连续子段是合法的，当且仅当其中**所有出现过的元素**出现次数全相等。

求合法的非空子段个数。两个子段不同当且仅当它们在原序列中的出现位置不同。
## 输入格式

第一行一个整数 $T$，表示数据组数。

接下来 $T$ 组数据，每组数据格式如下：

第一行一个整数 $n$。

接下来一行 $n$ 个整数，描述序列 $a$。
## 输出格式

$T$ 行，每行一个整数，表示一组数据的答案。
## 样例

### 样例输入 #1
```
5
9
1 1 1 2 2 2 3 3 3
4
1 1 2 2
5
1 1 2 2 1
10
1 2 2 1 1 2 3 2 3 3
12
1 1 2 3 3 2 1 2 3 3 2 1
```
### 样例输出 #1
```
25
8
11
26
34
```
## 提示

### 样例解释 #1

对于第三组数据，合法的连续非空子序列如下：

- $[1,1]$
- $[1,2]$
- $[1,4]$
- $[2,2]$
- $[2,3]$
- $[2,5]$
- $[3,3]$
- $[3,4]$
- $[4,4]$
- $[4,5]$
- $[5,5]$

### 数据范围

本题采取子任务依赖，未通过当前子任务依赖的子任务会导致当前子任务得零分。

对于 $100\%$ 的数据，$T\ge 1,1\le n,\sum n\le 10^6,1\le a_i\le n$。

|子任务|$n\le$|$\sum n\le$|特殊性质|分值|时限|依赖子任务|
|:-------:|:-:|:-:|:-----:|:--:|:--:|:-:|
|$1$|$100$|$1000$|-|$10$|1s| |
|$2$|$8000$|$4\times 10^4$|-|$10$|1s|$1$|
|$3$|-|$2\times 10^5$|$1\le a_i \le 4$|$20$|1s| |
|$4$|-|$2\times 10^5$|$a$ 的每个元素在 $[1,n]$ 均匀随机|$10$|1s| |
|$5$|-|$2\times 10^5$|$1\le a_i\le 14$|$20$|1s|$3$|
|$6$|-|$2\times 10^5$|-|$10$|1s|$1\sim 5$|
|$7$|-|$5\times 10^5$|-|$10$|1s|$1\sim 6$|
|$8$|-|$10^6$|-|$10$|1s|$1\sim 7$|



---

---
title: "[NOI2010] 成长快乐"
layout: "post"
diff: NOI/NOI+/CTSC
pid: P1915
tag: ['贪心', '2010', 'NOI', '提交答案', 'Special Judge', '随机化']
---
# [NOI2010] 成长快乐
## 题目描述

Nemo 是一条无忧无虑的小鱼，它的初始体重为 $w_0$。可爱的 Nemo 希望自己能够尽快地成长，因此需要吃尽量多的食物。Nemo 最喜爱的食物是海里的小虾。

已知 Nemo 对食物的情况了解如下：大海里共有 $n$ 只小虾，从 $1$ 到 $n$ 编号，其中编号为 $i$ 的小虾的重量为 $w_i$。将大海看作一个 X-Y 坐标系，在 $0$ 时刻编号为 $i$ 的小虾所在的位置为 $(x_i, y_i)$。小虾在大海中作匀速直线运动，其中编号为 $i$ 的小虾的速度向量为 $(p_i, q_i)$，即在时刻 $t$，它的位置为 $(x_i+p_i \cdot t,y_i+q_i \cdot t)$。

Nemo 在 $0$ 时刻的位置为 $(x_0, y_0)$，它可以在海中随意移动，但速度不超过 $V$。Nemo 希望通过自己的努力，在 $T$ 个单位时间内（含 $T$ 时刻）吃到的小虾重量总和尽量大。

当 Nemo 与某只小虾同时移动到同一个位置上，且小虾的重量小于 Nemo 当时的重量，则 Nemo 可以将该小虾吃掉。当 Nemo 吃掉重量为 $w_i$ 的小虾之后，它的体重将增加 $w_i$。注意，小虾不会吃 Nemo，且小虾之间也不会自相残杀。

Nemo 希望你来帮助它制定一个成长计划，使得它吃掉的小虾重量总和尽量大。
## 输入格式

该题为提交答案型试题，所有输入数据 `nemo1.in` $\sim$ `nemo10.in` 已在试题目录下。

**[数据以及checker下载](http://pan.baidu.com/s/1dEDLQud)**

对于每个数据，输入文件中第一行为五个实数 $w_0, V, T, x_0, y_0$。分别表示 Nemo 的初始体重、最大移动速度、时间限制以及 Nemo 在 $0$ 时刻的位置。

第二行为一个整数 $n$，表示大海中小虾的只数。

接下来 $n$ 行，每行 $5$ 个实数，包括 $w_i, x_i, y_i, p_i, q_i$，分别表示编号为 $i$ 的小虾的重量、在 $0$ 时刻的位置和速度向量。
## 输出格式

针对给定的 $10$ 个输入文件 `nemo1.in` $\sim$ `nemo10.in`，你需要分别提交你的输出文件 `nemo1.in` $\sim$ `nemo10.in`。

输出文件第一行包含一个整数 $k$。表示在你的成长计划中，Nemo 将吃到 $k$ 只小虾。

第二行包含一个实数 $w$，表示在你的成长计划中，Nemo 吃到的小虾的重量总和。

接下来 $k$ 行，每行 $4$ 个数 $t, x, y, s$。表示在时刻 $t$，Nemo 在位置 $(x, y)$ 处吃掉了编号为 $s$ 的小虾。其中 $t, x, y$ 为实数，$s$ 为整数。

为保证验证程序的精度，所有实数建议至少输出到小数点后 $6$ 位。在验证程序中，两个实数绝对误差不超过 $10^{-4}$ 时，即视为相等。
## 样例

### 样例输入 #1
```
5 1 6 0 0
1
5 2 2 0 0

```
### 样例输出 #1
```
1
5
5 2 2 1

```
## 提示

### 样例解释

在这个样例中，Nemo 在时刻 $5$ 在位置 $(2, 2)$ 吃掉了 $1$ 号小虾。其实 Nemo 到达 $(2, 2)$ 的时间可以更早，但题中仅要求速度不超过 $V$ 即可。

### 评分方法

对于每组数据，我们设置了 $9$ 个评分参数 $a_{10},a_9, \ldots ,a_2$。如果选手的输出不合法，则得零分。否则，设在你的方案中，Nemo 体重的增加量为 $w_{user}$，你的分数将会由下表给出：

| 得分 |          条件          | 得分 |        条件         |
| :--: | :--------------------: | :--: | :-----------------: |
|  10  | $w_{user} \geq a_{10}$ |  5   | $w_{user} \geq a_5$ |
|  9   |  $w_{user} \geq a_9$   |  4   | $w_{user} \geq a_4$ |
|  8   |  $w_{user} \geq a_8$   |  3   | $w_{user} \geq a_3$ |
|  7   |  $w_{user} \geq a_7$   |  2   | $w_{user} \geq a_2$ |
|  6   |  $w_{user} \geq a_6$   |  1   |  $w_{user} \gt 0$   |

### checker 使用方法

在 checker 目录下，在终端输入 `./checker in out`。

其中 in 为题目提供的输入文件，out 为你对于该输入文件给出的答案文件。

校验器将只检查你的答案的合法性，结果以在线评测为准。

感谢 @FlierKing 提供 spj 以及 @虞皓翔 帮助完善 spj。



---

---
title: "[THUWC 2017] 大葱的神力"
layout: "post"
diff: NOI/NOI+/CTSC
pid: P6849
tag: ['动态规划 DP', '搜索', '2017', '提交答案', 'Special Judge', '剪枝', '模拟退火', '背包 DP', '费用流', '随机化', 'THUWC']
---
# [THUWC 2017] 大葱的神力
## 题目背景

**本题为提交答案题。**

大葱是我国自古以来的美食，像我国传统美食北京烤鸭，用鸭子点缀出大葱的香味，令人赞不绝口。民间也流传着有「每天一棵葱，不当单身狗」的说法。

然而，大葱要发挥出独属于自己的神力，也是有条件的。
## 题目描述

现在小葱同学有 $N$ 棵大葱和 $M$ 个抽屉，将第 $i$ 棵大葱放到第 $j$ 个抽屉里面会产生 $w_{i,j}$ 的神力。自然小葱同学希望获得尽量多的神力，但是抽屉有着容积的限制，大葱也有着自己的体积。第 $i$ 棵大葱的体积为 $a_i$，第 $j$ 个抽屉的容积为 $b_j$。一个抽屉里面装着的大葱的体积之和不能超过这个抽屉的容积，一棵大葱不能拆分放到两个抽屉中。

小葱同学现在想知道，在这样的条件下，这些大葱最多会产生多少的神力？
## 输入格式

**本题为提交答案题**，输入文件为 `drawer1.in ~ drawer10.in`，详见附加文件。

第一行两个整数 $N,M$，代表大葱的个数和抽屉的个数。

接下来一行 $N$ 个整数，代表每棵大葱的体积。

接下来一行 $M$ 个整数，代表每个抽屉的容积。

接下来 $N$ 行每行 $M$ 个整数，第 $i$ 行第 $j$ 个数代表第 $i$ 棵大葱放到第 $j$ 个抽屉中会产生的神力。
## 输出格式

输出文件为 `drawer1.out ~ drawer10.out`，分别对应相应的输入文件。

对于每组输入数据，输出 $N$ 行每行一个整数，第 $i$ 个数代表第 $i$ 棵大葱被放到了哪个抽屉里面。如果第 $i$ 棵大葱没有被放到任何一个抽屉里面，则输出 $0$。
## 样例

### 样例输入 #1
```
3 4
1 1 2
2 1 2 3
1 2 1 1
2 1 2 1
3 1 0 1
```
### 样例输出 #1
```
2
0
1
```
## 提示

#### 样例说明

样例只是一种合法情况，获得的总神力值为 $2+3=5$。

#### 评分方式

**本题使用 Special Judge**，对于每个测试点，我们都有 $10$ 个参数 $a_1,a_2,\cdots,a_{10}$，如果你的输出所产生的的神力 $v$ 满足 $v \ge a_i$，则我们保证该测试点你至少会得到 $i$ 分。

#### 如何测试你的输出

在附加文件中，我们提供了 `scorer.cpp`，请自行编译来测试输出，这个程序将用于评判你的输出能够产生多少的神力。

若编译后文件名称为 `scorer`，在终端（Linux）中，输入以下命令：

```plain
./scorer <input_name> <output_name>
```

或在命令提示符（Windows）中，输入以下命令：
```plain
scorer <input_name> <output_name>
```
来对你的输出进行评判。其中 `<input_name>` 为输入文件名称，`<output_name>` 为输出文件名称。


---

---
title: "[THUSC 2016] 星露谷物语"
layout: "post"
diff: NOI/NOI+/CTSC
pid: P7449
tag: ['2016', '提交答案', 'Special Judge', '随机化', '构造', 'THUSC']
---
# [THUSC 2016] 星露谷物语
## 题目描述

最近，小葱为了忘记城市的喧嚣，来到了星露谷开始种地发家致富。但是，由于小葱把钱都拿去抽卡了，所以小葱并没有足够的钱来买种子。为了搜集足够的钱来养猪，小葱必须开始大规模的搜寻野菜工作。

星露谷是一个无限大的二维平面，你可以在这个二维平面内任意移动。小葱可能在星露谷的 $n$ 条线段上找到野菜，但是这些线段是有向的，小葱必须沿着线段的方向移动才能找到野菜。为了找到更多的野菜，小葱希望自己能把星露谷中所有可能出现野菜的地方全部走一遍。换句话说，对于每条线段，小葱都需要沿着该线段的方向将这条线段的每个点都经过一遍。当然，小葱可以选择分多次走一条线段，具体地讲，小葱可以在这条线段的任意位置离开这条线段，再从任意位置进入这条线段，只要保证路径的并集覆盖了这条有向线段即可。

小葱希望找到一条尽量短的路径，这条路径应该由 $m$ 条线段组成，并且覆盖了星露谷中的 $n$ 条有向线段。小葱可以选择星露谷的任意一个点作为路径的起点，同时它也必须是路径的终点，即小葱最终必须回到出发的位置。

现在，小葱要去写四子棋大作业了，他不知道该怎么规划自己的行走方案使得自己移动的距离尽量短，所以就把这个艰巨的任务交给聪明的你了。

**注意：如果有两条线段的某部分重合且方向相同，那么你在走过这一段的时候我们认为这两条线段的这部分都被走过了。**
## 输入格式

第一行包含一个整数 $n$，代表图中有向线段的数量。

接下来 $n$ 行，每行四个整数  $x_1,y_1,x_2,y_2$，代表这条线段是一条从 $(x_1,y_1)$ 到 $(x_2,y_2)$ 的有向线段。
## 输出格式

第一行应包含一个整数 $m$，代表小葱所走的折线路径中点的数量，需要满足 $m\le\min(5n^2,5\times 10^6)$。 接下来 $m$ 行，按照路径的顺序依次输出路径上的点。每行应包含两个浮点数 $x,y$，用来描述一个点的横、纵坐标。其中，$x,y$ 请保留不超过 $5$ 位小数。
## 样例

### 样例输入 #1
```
3
0 0 0 100
0 100 100 100
100 100 0 0
```
### 样例输出 #1
```
4
0 0
0 100
100 100
0 0
```
### 样例输入 #2
```
3
0 0 0 100
1 51 1 49
0 100 0 0
```
### 样例输出 #2
```
5
0 0
0 100
1 51
1 49
0 100
```
## 提示

**本题为提交答案题，输入与 checker 将会在附件给出**

对于每组测试数据，如果你的输出格式不符合题目要求，或者你输出的路径并没有走完给定的条 $n$ 有向线段，那么该测试点得 $0$ 分。否则，我们会计算你给出路径的长度 $d$，并根据 $10$ 个评分参数 $a_1\ge a_2\ge...\ge a_{10}$ 计算你的得分：
$$\max\{i|d\le a_i,1\le i\le 10\}$$

数据保证 $a_1$ 足够大，以确保一个合法的方案至少可以得到 $1$ 分。
#### 样例解释
对于样例 $1$，小葱总共移动了 $200+100\sqrt2$ 的距离，这也是这组样例的最优解。

对于样例 $2$，在该组解中，小葱一共移动了 $202+\sqrt{2402}+\sqrt{2602}$ 的距离，但这并不是这组数据的最优解。



---

---
title: "[THUSC 2017] 巧克力"
layout: "post"
diff: NOI/NOI+/CTSC
pid: P7450
tag: ['动态规划 DP', '2017', '二分', 'Special Judge', '随机化', 'THUSC']
---
# [THUSC 2017] 巧克力
## 题目描述

「人生就像一盒巧克力，你永远不知道吃到的下一块是什么味道。」

明明收到了一大块巧克力，里面有若干小块，排成 $n$ 行 $m$ 列。每一小块都有自己特别的图案 ，它们有的是海星，有的是贝壳，有的是海螺……其中还有一些因为挤压，已经分辨不出是什么图案了。明明给每一小块巧克力标上了一个美味值 $a_{i,j}$（$0\le a_{i,j}\le 10^6$），这个值越大，表示这一小块巧克力越美味。

正当明明咽了咽口水，准备享用美味时，舟舟神奇地出现了。看到舟舟恳求的目光，明明决定从中选出一些小块与舟舟一同分享。

舟舟希望这些被选出的巧克力是连通的（两块巧克力连通当且仅当他们有公共边），而且这些巧克力要包含至少 $k$（$1\le k\le 5$）种。而那些被挤压过的巧克力则是不能被选中的。

明明想满足舟舟的愿望，但他又有点「抠」，想将美味尽可能多地留给自己。所以明明希望选出的巧克力块数能够尽可能地少。如果在选出的块数最少的前提下，美味值的中位数（我们定义 $n$ 个数的中位数为第 $\left\lfloor\frac{n+1}{2}\right\rfloor$ 小的数）能够达到最小就更好了。

你能帮帮明明吗？
## 输入格式

每个测试点包含多组测试数据。

输入第一行包含一个正整数 $T$（$1\le T\le 5$），表示测试数据组数。

对于每组测试数据：

输入第一行包含三个正整数 $n,m$ 和 $k$；

接下来 $n$ 行，每行 $m$ 个整数，表示每小块的图案 $c_{i,j}$。若 $c_{i,j}=-1$ 表示这一小块受到过挤压，不能被选中；

接下来 $n$ 行，每行 $m$ 个整数，表示每个小块的美味值 $a_{i,j}$。
## 输出格式

输出共包括 $T$ 行，每行包含两个整数，用空格隔开，即最少的块数和最小的美味值中位数。

若对于某组测试数据，不存在任意一种合法的选取方案，请在对应行输出两个 $-1$。
## 样例

### 样例输入 #1
```
1
5 4 5
3 4 3 4
5 5 -1 5
-1 4 5 5
5 5 4 2
1 -1 2 4
1 3 1 1
3 2 3 3
4 4 4 5
8 9 9 5
7 2 6 3
```
### 样例输出 #1
```
9 5
```
## 提示

| 测试点编号 | $n,m$ 的限制 | $c_{i,j}$ 的限制 | 部分分说明 |
| :----------: | :----------: | :----------: | :----------: |
| 1 | $n=1,1\le m\le233$ | $c_{i,j}=-1$ 或 $1\le c_{i,j}\le n\times m$ | $\text{A}$ |
| 2 | $1\le n\times m\le 20$ | $c_{i,j}=-1$ 或 $1\le c_{i,j}\le n\times m$ | $\text{A}$ |
| 3~4 | $n=2,m=15$ | $c_{i,j}=-1$ 或 $1\le c_{i,j}\le n\times m$ | $\text{A}$ |
| 5~6 | $1\le n\times m\le 30$ | $c_{i,j}=-1$ 或 $1\le c_{i,j}\le n\times m$ | $\text{A}$ |
| 7~9 | $1\le n\times m\le 50$ | $c_{i,j}=-1$ 或 $1\le c_{i,j}\le8$ | $\text{A}$ |
| 10 | $1\le n\times m\le 233$ | $c_{i,j}=-1$ 或 $1\le c_{i,j}\le8$ | $\text{A}$ |
| 11~12 | $1\le n\times m\le 233$ | $c_{i,j}=-1$ 或 $1\le c_{i,j}\le8$ | $\text{B}$ |
| 13~15 | $1\le n\times m\le 233$ | $c_{i,j}=-1$ 或 $1\le c_{i,j}\le14$ | $\text{B}$ |
| 16~20 | $1\le n\times m\le 233$ | $c_{i,j}=-1$ 或 $1\le c_{i,j}\le n\times m$ | $\text{B}$ |
| 21 | $1\le n\times m\le 233$ | $c_{i,j}=-1$ 或 $1\le c_{i,j}\le n\times m$ | 该测试点不计分。 |

$\text{A}$:若输出的最少块数均正确，但最小中位数存在错误，选手可以获得该测试点 $80\%$ 的分数。\
$\text{B}$:若输出的最少块数均正确，但最小中位数存在错误，选手可以获得该测试点 $60\%$ 的分数。


---

---
title: "「MCOI-06」Lost Desire"
layout: "post"
diff: NOI/NOI+/CTSC
pid: P7890
tag: ['数学', '2021', 'Special Judge', 'O2优化', '哈希 hashing', '素数判断,质数,筛法', '最大公约数 gcd', '莫比乌斯反演', '组合数学', '随机化', '洛谷月赛']
---
# 「MCOI-06」Lost Desire
## 题目背景

頰滴る　紅い涙

不安定な視界の中

差し出した手を取れたら

あぁ…そんな世界を夢みた

-------

哭いて…

激しく  燃やした 黒い感情 

届かぬ この手に

Cry 闇の中で

最果てから 光へ手を翳して

揺らいだ想いさえも 闇の奥底へ堕ちてく

[网易云本曲试听链接](https://music.163.com/song?id=1809745288&userid=1399272307)
## 题目描述

设正整数 $n, m$ 互质，$k$ 为整数，定义函数 $F(n, m, k)$ 为小于 $\displaystyle m+n$ 的正整数集合 $\{1, 2, \cdots, m + n - 1\}$ 中，所有满足 $\displaystyle\sum_{x \in S} x \equiv k \pmod n$ 的 $m$ 元子集 $S$ 的个数。

现给定正整数 $N, M, K$，求所有 $F(i,j,x)$ 之积，使得 $1\le i\le N$，$1\le j\le M$，$1\le x\le K$，并且 $i$ 与 $j$ 互质。

由于结果很大，所以你只需要求出结果对特定素数 $p$ 取模的值。

**同时请注意实现程序时常数因子带来的影响。**
## 输入格式

**本题多测。** 每个测试点共有 $T$ 组数据。

第一行两个正整数 $T,p$ 。

接下来 $T$ 行，每行三个正整数 $N, M, K$，由空格分开。
## 输出格式

对于每组数据：一行，一个整数，表示所求的值（对 $p$ 取模）。

## 样例

### 样例输入 #1
```
3 1926195307
2 3 3
3 3 3
5 6 1
```
### 样例输出 #1
```
8
64
363031200
```
## 提示

本题采用捆绑测试，分 $5$ 个 Subtask 。

+ 对于 Subtask 1 ~~(Tutorial)~~：
  + $T=1$
  + $1\leq N,M,K\leq 6$
  + $p=10^9+7$。
+ 对于 Subtask 2 ~~(PST 4.0)~~：
  + $T=1$
  + $1\leq N,M,K\leq200$
  + $p=10^9+7$。
+ 对于 Subtask 3 ~~(PRS 7.5)~~：
  + $T=100$
  + $1\leq N,M,K\leq 1000$
  + $p=10^9+7$。
+ 对于 Subtask 4 ~~(FTR 9.8)~~：
  + $T=10^3$
  + $1 \leq N,M,K\le 10^5$
  + $10^9\le p\le2\times10^9$。
+ 对于 Subtask 5 ~~(BYD 11.0)~~：
  + $T=9999$
  + $1 \leq N,M,K\le 5\times10^5$
  + $10^9\le p\le2\times10^9$。

Subtask $1\sim5$ 的分值分别为 $5,7,11,17,60$ 。

特别的，假设您在一个测试点中前 $x$ 个询问正确，则您得该测试点的分值的 $\left\lfloor100\times\sqrt\dfrac{x}{T}\right\rfloor\%$ 分。您在任何一个 Subtask 的得分则为对应 Subtask 中所有测试点得分的最小值。

特别的，**TLE 一律不得分。**（无需补满未在时间范围内解决的测试点的答案，会导致奇怪的错误。）

**再次提醒注意实现程序时常数因子带来的影响。**

---

Idea: Powerless Std&Data: w33z （Data was corrected on 2021.10.05）

Sub4 added by Prean, Sub 5 by w33z.

This problem was added on 2021.10.01. Thanks for their help.

2021.10.01 - 2021.12.07 : 68 days 1st kill (Leasier).

2021.10.01 - 2022.01.21 : 113 days 2nd kill (wkywkywky).

2021.10.01 - 2022.02.26 : 149 days 3rd kill (NaNH2).


---

---
title: "[WFOI - 02] I wanna moqueve（位移序列）"
layout: "post"
diff: NOI/NOI+/CTSC
pid: P8223
tag: ['洛谷原创', 'Special Judge', 'O2优化', '随机化', '构造', '洛谷月赛']
---
# [WFOI - 02] I wanna moqueve（位移序列）
## 题目背景

> It's my fiesta.
>
> 一场前，kid 在 WFOIR1 的地图上，折戟沉沙；一场后，kid 从倒下的地方爬起。
> 
> kid 成功了，他不再是从前那个他了。

简化题意：[$\texttt{Link}$](https://www.luogu.com.cn/paste/dlxx9pm0)

为什么做完这题你不去做做[这题](https://www.luogu.com.cn/problem/P7999)呢
## 题目描述

kid 需要在一台奇怪的电脑上排序一个 $1\sim n$ 的排列，下一个存档点才会出现。

kid 可以选择一个数 $x$，然后接下来的每次操作，kid 可以向左或向右循环位移一段长为 $x$ 的序列（最左/右边的会平移至最右/左边）（位移量是 $1$）。

如果 kid 的操作次数超过了 $23\times n$，排列就会爆炸，kid 将会再次倒下。所以，请告诉 kid 一种还原序列的方案，剩下的操作就交给 €€£ 吧！
## 输入格式

输入共 $2$ 行：

第一行一个整数 $n$，表示序列长度。

第二行 $n$ 个整数，表示序列 $a$。
## 输出格式

输出共 $m + 2$ 行。

前两行每行 $1$ 个数，分别是 $x,m$。$m$ 表示操作次数。

接下来 $m$ 行，每行两个数，前一个数表示平移区间左端点，后一个数表示方向，$0$ 为向左，$1$ 为向右；

本题采用 $\text{SPJ}$，只要循环位移操作正确即可给分。
## 样例

### 样例输入 #1
```
3
2 3 1
```
### 样例输出 #1
```
2
2
2 0
1 0
```
### 样例输入 #2
```
5
4 2 3 5 1
```
### 样例输出 #2
```
3
3
3 1
1 1
2 0
```
## 提示

- **样例 $1$ 解释：**
	
    左移 $(2,3)$ 序列变成 $2,1,3$；
    
    左移 $(1,2)$ 序列变成 $1,2,3$；
    
- **样例 $2$ 解释：** 

    右移 $(3,5)$ 序列变成 $4,2,1,3,5$；

	右移 $(1,3)$ 序列变成 $1,4,2,3,5$；
    
    左移 $(2,4)$ 序列变成 $1,2,3,4,5$；
    
**本题采用 Subtask 捆绑测试。**

Subtask 编号 | 数据规模与约定
:-: | :-:
**Subtask #0** ($\texttt{1 pts}$) | $n=1$
**Subtask #1** ($\texttt{2 pts}$) | $n=2$
**Subtask #2** ($\texttt{3 pts}$) | $n=3$
**Subtask #3** ($\texttt{4 pts}$) | $n=4$
**Subtask #4** ($\texttt{20 pts}$) | $1\le n\le 50$
**Subtask #5** ($\texttt{20 pts}$) | $1\le n\le 100$
**Subtask #6** ($\texttt{50 pts}$) | $1\le n\le 10^3$

对于 $100\%$ 的数据，$1\le n,a_i\le 10^3$，数据保证 $a$ 是一个 $1\sim n$ 的排列。


---


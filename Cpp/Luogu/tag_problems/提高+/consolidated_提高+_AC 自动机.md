---
title: "[CQOI2014] 通配符匹配"
layout: "post"
diff: 提高+/省选-
pid: P3167
tag: ['字符串', '2014', '重庆', '各省省选', '哈希 hashing', 'AC 自动机']
---
# [CQOI2014] 通配符匹配
## 题目描述

几乎所有操作系统的命令行界面（CLI）中都支持文件名的通配符匹配以方便用户。最常见的通配符有两个，一个是星号（```*```），可以匹配 0 个及以上的任意字符：另一个是问号（```?```），可以匹配恰好一个任意字符。现在需要你编写一个程序，对于给定的文件名列表和一个包含通配符的字符串，判断哪些文件可以被匹配。

## 输入格式

第一行是一个由小写字母和上述通配符组成的字符串。第二行包含一个整数 $n$，表示文件个数。接下来 $n$ 行，每行为一个仅包含小写字母字符串，表示文件名列表。

## 输出格式

输出 $n$ 行，每行为 ``YES`` 或 ``NO``，表示对应文件能否被通配符匹配。

## 样例

### 样例输入 #1
```
*aca?ctc
6
acaacatctc
acatctc
aacacatctc
aggggcaacacctc
aggggcaacatctc
aggggcaacctct
```
### 样例输出 #1
```
YES

YES

YES

YES

YES

NO
```
## 提示

对于 $100 \%$ 的数据

- 字符串长度不超过 $100000$
- $1 \le n \le 100$
- 通配符个数不超过 $10$



---

---
title: "AC 自动机（简单版 II）"
layout: "post"
diff: 提高+/省选-
pid: P3796
tag: ['字符串', '字典树 Trie', 'AC 自动机']
---
# AC 自动机（简单版 II）
## 题目描述

有 $N$ 个由小写字母组成的模式串以及一个文本串 $T$。每个模式串可能会在文本串中出现多次。你需要找出**哪些**模式串在文本串 $T$ 中出现的次数最多。

## 输入格式

输入含多组数据。保证输入数据不超过 $50$ 组。

每组数据的第一行为一个正整数 $N$，表示共有 $N$ 个模式串，$1 \leq N \leq 150$。

接下去 $N$ 行，每行一个长度小于等于 $70$ 的模式串。下一行是一个长度小于等于 $10^6$ 的文本串 $T$。保证不存在两个相同的模式串。

输入结束标志为 $N=0$。
## 输出格式

对于每组数据，第一行输出模式串最多出现的次数，接下去若干行每行输出一个出现次数最多的模式串，按输入顺序排列。

## 样例

### 样例输入 #1
```
2
aba
bab
ababababac
6
beta
alpha
haha
delta
dede
tata
dedeltalphahahahototatalpha
0
```
### 样例输出 #1
```
4
aba
2
alpha
haha
```


---

---
title: "AC 自动机（简单版）"
layout: "post"
diff: 提高+/省选-
pid: P3808
tag: ['字符串', 'O2优化', 'AC 自动机', '构造']
---
# AC 自动机（简单版）
## 题目描述

给定 $n$ 个模式串 $s_i$ 和一个文本串 $t$，求有多少个不同的模式串在文本串里出现过。  
两个模式串不同当且仅当他们**编号**不同。
## 输入格式

第一行是一个整数，表示模式串的个数 $n$。  
第 $2$ 到第 $(n + 1)$ 行，每行一个字符串，第 $(i + 1)$ 行的字符串表示编号为 $i$ 的模式串 $s_i$。  
最后一行是一个字符串，表示文本串 $t$。
## 输出格式

输出一行一个整数表示答案。
## 样例

### 样例输入 #1
```
3
a
aa
aa
aaa
```
### 样例输出 #1
```
3
```
### 样例输入 #2
```
4
a
ab
ac
abc
abcd
```
### 样例输出 #2
```
3
```
### 样例输入 #3
```
2
a
aa
aa
```
### 样例输出 #3
```
2
```
## 提示

### 样例 1 解释

$s_2$ 与 $s_3$ 编号（下标）不同，因此各自对答案产生了一次贡献。

### 样例 2 解释

$s_1$，$s_2$，$s_4$ 都在串 `abcd` 里出现过。

### 数据规模与约定

- 对于 $50\%$ 的数据，保证 $n = 1$。
- 对于 $100\%$ 的数据，保证 $1 \leq n \leq 10^6$，$1 \leq |t| \leq 10^6$，$1 \leq \sum\limits_{i = 1}^n |s_i| \leq 10^6$。$s_i, t$ 中仅包含小写字母。


---

---
title: "[TJOI2013] 单词"
layout: "post"
diff: 提高+/省选-
pid: P3966
tag: ['2013', '二分', '各省省选', 'AC 自动机', '天津']
---
# [TJOI2013] 单词
## 题目描述

小张最近在忙毕设,所以一直在读论文。一篇论文是由许多单词组成但小张发现一个单词会在论文中出现很多次，他想知道每个单词分别在论文中出现了多少次。
## 输入格式

第一行一个整数 $N$，表示有 $N$ 个单词。

接下来 $N$ 行每行一个单词,每个单词都由小写字母 $a-z$ 组成。
## 输出格式

输出 $N$ 个整数,第 $i$ 行的数表示第 $i$ 个单词在文章中出现了多少次。
## 样例

### 样例输入 #1
```
3
a
aa
aaa
```
### 样例输出 #1
```
6
3
1

```
## 提示

### 数据规模与约定

- $30\%$ 的数据， 单词总长度不超过 $10^3$。
- $100\%$ 的数据，$1 \leq n \leq 200$，单词总长度不超过 $10^6$。


---

---
title: "【模板】AC 自动机"
layout: "post"
diff: 提高+/省选-
pid: P5357
tag: ['字符串', 'AC 自动机']
---
# 【模板】AC 自动机
## 题目背景

本题原为“AC 自动机（二次加强版）”。完成本题前可以先完成 [AC 自动机（简单版）](https://www.luogu.com.cn/problem/P3808) 和 [AC 自动机（简单版 II）](https://www.luogu.com.cn/problem/P3796) 两道题，为 AC 自动机更简单的应用。
## 题目描述

给你一个文本串 $S$ 和 $n$ 个模式串 $T_{1 \sim n}$，请你分别求出每个模式串 $T_i$ 在 $S$ 中出现的次数。
## 输入格式

第一行包含一个正整数 $n$ 表示模式串的个数。

接下来 $n$ 行，第 $i$ 行包含一个由小写英文字母构成的非空字符串 $T_i$。

最后一行包含一个由小写英文字母构成的非空字符串 $S$。

**数据不保证任意两个模式串不相同**。
## 输出格式

输出包含 $n$ 行，其中第 $i$ 行包含一个非负整数表示 $T_i$ 在 $S$ 中出现的次数。
## 样例

### 样例输入 #1
```
5
a
bb
aa
abaa
abaaa
abaaabaa

```
### 样例输出 #1
```
6
0
3
2
1

```
## 提示

对于 $100 \%$ 的数据，$1 \le n \le 2 \times {10}^5$，$T_{1 \sim n}$ 的长度总和不超过 $2 \times {10}^5$，$S$ 的长度不超过 $2 \times {10}^6$。


---


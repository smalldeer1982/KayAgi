---
title: "[APIO/CTSC2007] 数据备份"
layout: "post"
diff: 提高+/省选-
pid: P3620
tag: ['贪心', '2007', 'APIO', '优先队列', '差分', 'CTSC/CTS']
---
# [APIO/CTSC2007] 数据备份
## 题目描述

你在一家 IT 公司为大型写字楼或办公楼的计算机数据做备份。然而数据备份的工作是枯燥乏味的，因此你想设计一个系统让不同的办公楼彼此之间互相备份，而你则坐在家中尽享计算机游戏的乐趣。

已知办公楼都位于同一条街上。你决定给这些办公楼配对（两个一组）。每一对办公楼可以通过在这两个建筑物之间铺设网络电缆使得它们可以互相备份。

然而，网络电缆的费用很高。当地电信公司仅能为你提供 $K$ 条网络电缆，这意味着你仅能为 $K$ 对办公楼（或总计 $2K$ 个办公楼）安排备份。任一个办公楼都属于唯一的配对组（换句话说，这 $2K$ 个办公楼一定是相异的）。

此外，电信公司需按网络电缆的长度（公里数）收费。因而，你需要选择这 $K$ 对办公楼使得电缆的总长度尽可能短。换句话说，你需要选择这 $K$ 对办公楼，使得每一对办公楼之间的距离之和（总距离）尽可能小。

下面给出一个示例，假定你有 $5$ 个客户，其办公楼都在一条街上，如下图所示。这 $5$ 个办公楼分别位于距离大街起点 $1\rm km$, $3\rm km$, $4\rm km$, $6\rm km$ 和 $12\rm km$ 处。电信公司仅为你提供 $K=2$ 条电缆。

  ![](https://cdn.luogu.com.cn/upload/pic/4386.png) 

上例中最好的配对方案是将第 $1$ 个和第 $2$ 个办公楼相连，第 $3$ 个和第 $4$ 个办公楼相连。这样可按要求使用 $K=2$ 条电缆。第 $1$ 条电缆的长度是 $\rm 3km-1km = 2km$，第 2 条电缆的长度是 $\rm 6km―4km = 2 km$。这种配对方案需要总长 $4\rm km$ 的网络电缆，满足距离之和最小的要求。
## 输入格式

输入文件的第一行包含整数 $N$ 和 $K$，其中 $N$（$1\leq N \leq 10^5$）表示办公楼的数目，$K$（$\displaystyle 1\leq K \leq \frac{N}{2}$）表示可利用的网络电缆的数目。

接下来的 $N$ 行每行仅包含一个整数 $s$（$0\leq s \leq 10^9$）, 表示每个办公楼到大街起点处的距离。这些整数将按照从小到大的顺序依次出现。
## 输出格式

输出文件应当由一个正整数组成，给出将 $2K$ 个相异的办公楼连成 $K$ 对所需的网络电缆的最小总长度。
## 样例

### 样例输入 #1
```
5 2 
1 
3 
4 
6 
12 
```
### 样例输出 #1
```
4
```
## 提示

$30\%$ 的输入数据满足 $N\leq 20$。

$60\%$ 的输入数据满足 $N\leq 10^4$。


---

---
title: "[APIO2009] 采油区域"
layout: "post"
diff: 提高+/省选-
pid: P3625
tag: ['递推', '2009', 'APIO', '前缀和']
---
# [APIO2009] 采油区域
## 题目描述

Siruseri 政府决定将石油资源丰富的 Navalur 省的土地拍卖给私人承包商以 建立油井。被拍卖的整块土地为一个矩形区域，被划分为 $M \times N$ 个小块。 Siruseri 地质调查局有关于 Navalur 土地石油储量的估测数据。这些数据表示 为 $M \times N$ 个正整数，即对每一小块土地石油储量的估计值。 为了避免出现垄断，政府规定每一个承包商只能承包一个由 $K\times K$ 块相连的土地构成的正方形区域。 AoE 石油联合公司由三个承包商组成，他们想选择三块互不相交的 $K\times K$ 的 区域使得总的收益最大。 例如，假设石油储量的估计值如下：

```
1 1 1 1 1 1 1 1 1 
1 1 1 1 1 1 1 1 1 
1 8 8 8 8 8 1 1 1 
1 8 8 8 8 8 1 1 1 
1 8 8 8 8 8 1 1 1 
1 1 1 1 8 8 8 1 1 
1 1 1 1 1 1 8 8 8 
1 1 1 1 1 1 9 9 9 
1 1 1 1 1 1 9 9 9 
```

- 如果 $K = 2$，AoE 公司可以承包的区域的石油储量总和为 $100$；
- 如果 $K = 3$，AoE 公司可以承包的区域的石油储量总和为 $208$。

AoE 公司雇佣你来写一个程序，帮助计算出他们可以承包的区域的石油储量之和的最大值。

## 输入格式

输入第一行包含三个正整数 $M, N, K$，其中 $M$ 和 $N$ 是矩形区域的行数和列数，$K$ 是每一个承包商承包的正方形的大小（边长的块数）。接下来 $M$ 行，每行有 $N$ 个正整数表示这一行每一小块土地的石油储量的估计值。

## 输出格式

输出只包含一个正整数，表示 AoE 公司可以承包的区域的石油储量之和的最大值。

## 样例

### 样例输入 #1
```
9 9 3
1 1 1 1 1 1 1 1 1 
1 1 1 1 1 1 1 1 1 
1 8 8 8 8 8 1 1 1 
1 8 8 8 8 8 1 1 1 
1 8 8 8 8 8 1 1 1 
1 1 1 1 8 8 8 1 1 
1 1 1 1 1 1 8 8 8 
1 1 1 1 1 1 9 9 9 
1 1 1 1 1 1 9 9 9 
```
### 样例输出 #1
```
208
```
## 提示

数据保证 $K\le M$ 且 $K\le N$ 并且至少有三个 $K\times K$ 的互不相交的正方形区域。

其中 $30\%$ 的输入数据，$M, N \le 12$。所有的输入数据, $M, N\le 1500$。每一小块土地的石油储量的估计值是非负整数且小于等于 $500$。



---

---
title: "[APIO2009] 会议中心"
layout: "post"
diff: 提高+/省选-
pid: P3626
tag: ['贪心', '2009', '线段树', '倍增', 'APIO', '排序', '前缀和']
---
# [APIO2009] 会议中心
## 题目描述

Siruseri 政府建造了一座新的会议中心。许多公司对租借会议中心的会堂很 感兴趣，他们希望能够在里面举行会议。

对于一个客户而言，仅当在开会时能够独自占用整个会堂，他才会租借会堂。 会议中心的销售主管认为：最好的策略应该是将会堂租借给尽可能多的客户。

显 然，有可能存在不止一种满足要求的策略。 例如下面的例子。总共有 4 个公司。他们对租借会堂发出了请求，并提出了 他们所需占用会堂的起止日期（如下表所示）。

```cpp
       开始日期 结束日期 
 公司1    4        9 
 公司2    9        11 
 公司3    13       19 
 公司4    10       17 
```
上例中，最多将会堂租借给两家公司。租借策略分别是租给公司 1 和公司 3， 或是公司 2 和公司 3，也可以是公司 1 和公司 4。注意会议中心一天最多租借给 一个公司，所以公司 1 和公司 2 不能同时租借会议中心，因为他们在第九天重合 了。

销售主管为了公平起见，决定按照如下的程序来确定选择何种租借策略：首 先，将租借给客户数量最多的策略作为候选，将所有的公司按照他们发出请求的 顺序编号。对于候选策略，将策略中的每家公司的编号按升序排列。最后，选出 其中字典序最小1的候选策略作为最终的策略。

例中，会堂最终将被租借给公司 1 和公司 3：3 个候选策略是 {(1,3),(2,3),(1,4)}。而在字典序中(1,3)<(1,4)<(2,3)。 你的任务是帮助销售主管确定应该将会堂租借给哪些公司。

## 输入格式

输入的第一行有一个整数 N，表示发出租借会堂申请的公司的个数。第 2 到 第 N+1 行每行有 2 个整数。第 i+1 行的整数表示第 i 家公司申请租借的起始和终 止日期。对于每个公司的申请，起始日期为不小于 1 的整数，终止日期为不大于 10^9 的整数。

## 输出格式

输出的第一行应有一个整数 M，表示最多可以租借给多少家公司。第二行应列出 M 个数，表示最终将会堂租借给哪些公司。

## 样例

### 样例输入 #1
```
4 
4 9
9 11 
13 19 
10 17
```
### 样例输出 #1
```
2
1 3
```
## 提示

对于 50%的输入，N≤3000。

在所有输入中，N≤200000。



---

---
title: "[APIO2009] 抢掠计划"
layout: "post"
diff: 提高+/省选-
pid: P3627
tag: ['2009', 'APIO', '强连通分量', '栈']
---
# [APIO2009] 抢掠计划
## 题目描述

Siruseri 城中的道路都是单向的。不同的道路由路口连接。按照法律的规定，在每个路口都设立了一个 Siruseri 银行的 ATM 取款机。令人奇怪的是，Siruseri 的酒吧也都设在路口，虽然并不是每个路口都设有酒吧。  

Banditji 计划实施 Siruseri 有史以来最惊天动地的 ATM 抢劫。他将从市中心出发，沿着单向道路行驶，抢劫所有他途径的 ATM 机，最终他将在一个酒吧庆祝他的胜利。  

使用高超的黑客技术，他获知了每个 ATM 机中可以掠取的现金数额。他希望你帮助他计算从市中心出发最后到达某个酒吧时最多能抢劫的现金总数。他可以经过同一路口或道路任意多次。但只要他抢劫过某个 ATM 机后，该 ATM 机里面就不会再有钱了。 例如，假设该城中有 $6$ 个路口，道路的连接情况如下图所示：  

![](https://cdn.luogu.com.cn/upload/pic/4396.png)  

市中心在路口 $1$，由一个入口符号 → 来标识，那些有酒吧的路口用双圈来表示。每个 ATM 机中可取的钱数标在了路口的上方。在这个例子中，Banditji 能抢劫的现金总数为 $47$，实施的抢劫路线是：$1-2-4-1-2-3-5$。
## 输入格式

第一行包含两个整数 $N,M$。$N$ 表示路口的个数，$M$ 表示道路条数。  

接下来 $M$ 行，每行两个整数，这两个整数都在 $1$ 到 $N$ 之间，第 $i+1$ 行的两个整数表示第 $i$ 条道路的起点和终点的路口编号。  

接下来 $N$ 行，每行一个整数，按顺序表示每个路口处的 ATM 机中的钱数 $a_i$。  

接下来一行包含两个整数 $S,P$，$S$ 表示市中心的编号，也就是出发的路口。$P$ 表示酒吧数目。  

接下来的一行中有 $P$ 个整数，表示 $P$ 个有酒吧的路口的编号。
## 输出格式

输出一个整数，表示 Banditji 从市中心开始到某个酒吧结束所能抢劫的最多的现金总数。
## 样例

### 样例输入 #1
```
6 7 
1 2 
2 3 
3 5 
2 4 
4 1 
2 6 
6 5 
10 
12 
8 
16 
1 
5 
1 4 
4 3 5 6
```
### 样例输出 #1
```
47
```
## 提示

对于 $50\%$ 的数据，保证 $N, M \le 3000$。  

对于 $100\%$ 的数据，保证 $N, M \le 5\times 10^5$，$0 \le a_i \le 4000$。保证可以从市中心沿着 Siruseri 的单向的道路到达其中的至少一个酒吧。


---

---
title: "[APIO2023] 赛博乐园 / cyberland"
layout: "post"
diff: 提高+/省选-
pid: P9370
tag: ['2023', 'APIO', '交互题', 'Special Judge', 'O2优化']
---
# [APIO2023] 赛博乐园 / cyberland
## 题目背景

**由于部分 BUG，使用 C++14 (GCC9) 提交会产生编译错误，请使用 C++14 等语言进行提交。**

提交时，无需引用 `cyberland.h`。你提交的代码中需要实现以下函数：

```cpp
double solve(int N, int M, int K, int H, std::vector<int> x, std::vector<int> y, std::vector<int> c, std::vector<int> arr)
```
## 题目描述

3742 年已经到来，现在轮到赛博乐园主办 APIO 了。在这个世界上有 $N$ 个国家，这些国家由 $0$ 到 $N − 1$ 标号，还有 $M$ 条双向道路（每条边双向都可以通行），这些道路由 $0$ 到 $M − 1$ 标号。每条道路连接两个不同的国家，$x[i]$ 和 $y[i]$，并需要花费时间 $c[i]$ 来通过该道路。除了你所在的国家的选手，所有选手都已经聚集在赛博乐园参加 APIO 了。你生活在国家 $0$，而赛博乐园是国家 $H$。你作为你的国家最聪明的人，你的帮助刻不容缓。更具体地，你需要确定从你的国家到达赛博乐园所需的最少时间。

在经过有些国家时，你可以清除你的当前总通过时间。此外，还有些国家在你经过他们时可以将你的当前总通过时间除以 $2$（我们称之为“除以 $2$ 的能力”）。你可以重复经过一个国家。每次你经过一个国家时，你可以选择是否使用这个国家的特殊能力。但你每次经过一个国家时最多可以使用一次特殊能力（如果你多次经过一个国家，你每次经过都可以使用至多一次该国家的特殊能力）。此外，为了防止被赛博乐园化学基金会抓住，你最多只能使用“除以 $2$ 的能力”$K$ 次。一旦你到达赛博乐园，你就不能移动到其他任何地方，因为伟大的 APIO 竞赛即将开赛了！

给出一个数组 $arr$ ，其中 $arr[i]$ 表示国家 $i (0 \le i \le N − 1)$ 的特殊能力。每个国家有下面 $3$ 种特殊能力之中的一种：

 - $arr[i] = 0$，意思是这个国家可以让当前总通过时间为 $0$。
 - $arr[i] = 1$，表示这个国家不会改变你的当前总通行时间。
 - $arr[i] = 2$，表示这个国家拥有让当前总通行时间除以 $2$ 的能力。

保证 $arr[0] = arr[H] = 1$ 成立。换句话说，赛博乐园和你所在的国家没有任何特殊能力。

你的国家不希望错过 APIO 的任何时刻，所以你需要找到到达赛博乐园的最短时间。如果你不能到达赛博乐园，你的答案应该是 $−1$。

### 实现细节

你需要实现以下函数：

```cpp
double solve(int N, int M, int K, int H, std::vector<int> x, std::vector<int> y, std::vector<int> c, std::vector<int> arr);
```

 - $N$ : 国家的数量。
 - $M$ : 双向道路的数量。
 - $K$: “除以 $2$ 的能力”的最大使用次数。
 - $H$: 国家“赛博乐园”的标号。
 - $x, y, c$: 三个长度为 $M$ 的数组。三元组 $(x[i], y[i], c[i])$ 表示第 $i$ 条用来连接国家 $x[i]$ 和 $y[i]$ 的双向边，通过它的时间消耗是 $c[i]$。
 - $arr$: 一个长度为 $N$ 的数组。$arr[i]$ 表示国家 $i$ 的特殊能力。
 - 如果你能到达赛博乐园，调用该函数应返回从你的国家到达赛博乐园的最短时间，如果你不能，则返回 $−1$。
 - 这个过程可能会被多次调用。

假设选手的答案为 $ans_1$ ，标准输出为 $ans_2$ ，当且仅当 $\dfrac{|ans_1-ans_2|}{\max\{ans_2,1\}} \le 10 ^ {-6}$ 时你的输出被视为是正确的。

注意：由于函数调用可能会发生多次，选手需要注意之前调用的残余数据对于后续调用的影响。
## 输入格式

评测程序示例读取如下格式的输入：

 - 第 $1$ 行: $T$
 
对于 $T$ 组测试数据中的每一个:
 - 第 $1$ 行: $N \ M \ K$
 - 第 $2$ 行: $H$
 - 第 $3$ 行: $arr[0] \ arr[1] \ arr[2] \  \cdots  \ arr[N − 1]$
 - 第 $4 + i(0 \le i \le M − 1)$ 行: $x[i] \ y[i]  \ c[i]$
## 输出格式

评测程序示例按照如下的格式打印你的答案：

对于每组测试数据：

- 第 $1$ 行: 调用 `solve` 的返回值
## 样例

### 样例输入 #1
```
3 2 30
2
1 2 1
1 2 12
2 0 4
```
### 样例输出 #1
```
4
```
### 样例输入 #2
```
4 4 30
3
1 0 2 1
0 1 5
0 2 4
1 3 2
2 3 4
```
### 样例输出 #2
```
2
```
## 提示

### 例子

#### 样例 1

考虑下面的调用：

```cpp
solve(3, 2, 30, 2, {1, 2}, {2, 0}, {12, 4}, {1, 2, 1});
```

唯一的到达赛博乐园的路径是 $0 \rightarrow 2$，因为你到达了赛博乐园之后不能再移动到其他任何地方。通行时间的计算过程如下：

| 国家编号 | 通行时间 |
| :--: | :--: |
| $0$ | $0$ |
| $2$ | $0 + 4 \rightarrow 4(\text{求和}) \rightarrow 4(\text{特殊能力})$|

#### 样例 2

考虑下面的调用：

```cpp
solve(4, 4, 30, 3, {0, 0, 1, 2}, {1, 2, 3, 3}, {5, 4, 2, 4}, {1, 0, 2, 1});
```

从你的国家到赛博乐园有两条路径：$0 \rightarrow 1 \rightarrow 3$ 和 $0 \rightarrow 2 \rightarrow 3$。

如果选择路径 $0 \rightarrow 1 \rightarrow 3$，通行时间的计算如下：

| 国家编号 | 通行时间 |
| :--: | :--: |
| $0$ | $0$ |
| $1$ | $0 + 5 \rightarrow 5(\text{求和}) \rightarrow 0(\text{特殊能力})$|
| $3$ | $0 + 2 \rightarrow 2(\text{求和}) \rightarrow 2(\text{特殊能力})$|

如果选择路径 $0 \rightarrow 2 \rightarrow 3$，通行时间的计算如下：

| 国家编号 | 通行时间 |
| :--: | :--: |
| $0$ | $0$ |
| $2$ | $0 + 4 \rightarrow 4(\text{求和}) \rightarrow 2(\text{特殊能力})$|
| $3$ | $2 + 4 \rightarrow 6(\text{求和}) \rightarrow 6(\text{特殊能力})$|

所以，上述调用应该返回 $2$。

### 约束条件

 - $2 \le N \le 10^5 , \sum N \le 10^5$.
 - $0 ≤ M ≤ \min\{10^5, \dfrac{N(N-1)}{2} \}, \sum M ≤ 10^5$.
 - $1 \le K \le 10^6$.
 - $1 \le H < N$
 - $0 \le  x[i], y[i] < N , x[i] \neq y[i]$.
 - $1 \le c[i] \le 10^9$.
 - $arr[i] \in \{0, 1, 2\}$.
 - 保证每两个国家之间至多使用一条道路进行连接。

### 子任务

1. (5 分)：$N \le 3, K \le 30$.
2. (8 分)：$M = N − 1, K \le 30, arr[i] = 1$，你可以通过这 $M$ 条道路从任意国家到另外一个国家。
3. (13 分)：$M = N − 1, K \le 30, arr[i] \in \{0, 1\}$，你可以通过这 $M$ 条道路从任意国家到另外一个国家。
4. (19 分)：$M = N − 1, K \le 30, x[i] = i, y[i] = i + 1$.
5. (7 分)：$K \le 30, arr[i] = 1$.
6. (16 分)：$K \le 30, arr[i] \in \{0, 1\}$.
7. (29 分)：$K \le 30$.
8. (3 分)：没有特殊限制。


---


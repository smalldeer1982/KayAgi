---
title: "[ROIR 2022] 礼物 (Day 2)"
layout: "post"
diff: 提高+/省选-
pid: P10093
tag: ['2022', 'Special Judge', '前缀和', 'ST 表', '链表', 'ROIR（俄罗斯）']
---
# [ROIR 2022] 礼物 (Day 2)
## 题目背景

翻译自 [ROIR 2022 D2T4](https://neerc.ifmo.ru/school/archive/2021-2022/ru-olymp-regional-2022-day2.pdf)。

圣诞老人让沃瓦选择一个礼物。

在沃瓦面前有 $n$ 个礼物排成一行。每个礼物给沃瓦带来的快乐程度值用一个整数表示，第 $i$ 个礼物的值为 $a_i$。快乐程度可以是正数、负数或零。

圣诞老人让沃瓦选择两个整数 $l$ 和 $r$，满足 $1 \le l \le r \le n$。沃瓦需要选择从 $l$ 到 $r$ 之间的所有礼物。然而，在所选的礼物中，沃瓦必须把具有前 $k$ 大快乐程度值的 $k$ 个礼物给他的妹妹玛莎。
## 题目描述

帮助沃瓦选择 $l$ 和 $r$，使得 $1 \le l \le r \le n,r - l + 1 \ge k$，并且他得到的礼物的总快乐程度最大化（不包括给妹妹的礼物）。
## 输入格式

第一行输入两个整数 $n$ 和 $k$，表示放在沃瓦面前的礼物数量和需要给玛莎的礼物数量。

第二行输入 $n$ 个整数，用空格分隔，第 $i$ 个数 $a_i$ 表示每个礼物带来的快乐程度。
## 输出格式

输出一个整数，表示沃瓦所选择的礼物的总快乐程度，不包括给玛莎的礼物。
## 样例

### 样例输入 #1
```
5 0
2 -4 5 -1 7
```
### 样例输出 #1
```
11
```
### 样例输入 #2
```
5 1
2 -4 5 -1 7
```
### 样例输出 #2
```
4
```
### 样例输入 #3
```
5 2
2 -4 5 -1 7
```
### 样例输出 #3
```
0
```
## 提示

在样例 $1$ 中，沃瓦不需要给玛莎任何礼物，因此他将选择 $l = 3, r = 5$，并且所选礼物的总快乐程度为 $5 + (−1) + 7 = 11$。

在样例 $2$ 中，沃瓦将需要将带来最大快乐程度的礼物给玛莎。然后，他仍然会选择 $l = 3, r = 5$，但总共的快乐程度是 $5 + (−1) = 4$。

在样例 $3$ 中，沃瓦需要给玛莎快乐值前二大的礼物。这种情况下，不难发现实际上沃瓦最好的选择方式是只选择两个礼物，然后全部给妹妹玛莎。一个最佳选择是选择 $l = 1, r = 2$。此时总快乐程度为 $0$。

本题使用捆绑测试。

| 子任务 | 分值 | 特殊性质 |
| :----------: | :----------: | :----------: |
| $1$ | $7$ | $n\le200$ |
| $2$ | $8$ | $n\le1000$ |
| $3$ | $10$ | $n\le6000$ |
| $4$ | $8$ | $k=0$ |
| $5$ | $14$ | $k=1$ |
| $6$ | $39$ | $n\le80000$ |
| $7$ | $14$ | 无 |

对于 $100\%$ 的数据，$1 \le n \le 200000, 0 \le k \le \min(100, n),−10^9 \le a_i \le 10^9$。


---

---
title: "[COTS 2024] 双双决斗 Dvoboj"
layout: "post"
diff: 提高+/省选-
pid: P10680
tag: ['2024', 'O2优化', 'ST 表', 'COCI（克罗地亚）', '根号分治']
---
# [COTS 2024] 双双决斗 Dvoboj
## 题目背景

译自 [Izborne Pripreme 2024 (Croatian IOI/CEOI Team Selection)](https://hsin.hr/pripreme2024/) D1T1。$\texttt{2s,1G}$。

> Two pharaonic yellow lines turned into an eye...
## 题目描述

Jusuf 手里有 $N$ 张卡牌，从左到右编号为 $1$ 到 $N$。每张卡牌的力量为 $p_i$。由于 Jusuf 即将参加比赛，他想要在脑中想象战斗。有时候，他也会更改卡牌的力量值。Jusuf 总共会做 $Q$ 次操作，每个操作属于以下两种类型之一：

1. `1 i r`：Jusuf 将位于位置 $i$ 的卡牌的力量设为 $r$，即 $p_i\gets r$。

2. `2 l k`：Jusuf 在脑中想象一场战斗。这场战斗使用从第 $l,l+1,\cdots,l + 2^k − 1$ 张，共 $2^k$ 张卡牌。

    战斗将会进行 $k$ 轮。每轮中，Jusuf 将第 $(2i-1)$ 和第 $2i$ 张卡牌分成一组（例如第 $1$ 张和第 $2$ 张卡牌为一组）。
    
    对于每组卡牌，Jusuf 比较它们的力量。不妨设两张卡牌的力量分别为 $A$ 和 $B$，力量更大的卡牌将获胜，且获胜卡牌的力量变为 $|A − B|$，另一张卡牌被移除。特别地，如果 $A=B$，则这场战斗的结果无法确定，将会随机一张卡牌获胜，力量变为 $0$。
    
    注意到，在 $k$ 轮后，只会剩下一张卡牌，Jusuf 想要知道此时它的力量大小。

由于 Jusuf 只是在脑中想象战斗，所以实际上牌的数量不会改变，$p_i$ 也不会改变。

## 输入格式

第一行，两个正整数 $N,Q$，含义见题面。

第二行，$n$ 个整数，第 $i$ 个整数表示 $p_i$。

接下来 $Q$ 行，每行 $3$ 个正整数，描述一个操作。
## 输出格式

对于每个操作 $2$，输出一行一个整数，表示所求的力量大小。
## 样例

### 样例输入 #1
```
5 3
4 8 2 0 7
2 1 2
1 1 9
2 2 1
```
### 样例输出 #1
```
2
6
```
### 样例输入 #2
```
8 6
1 2 3 4 5 6 7 8
2 1 3
1 4 1
1 7 3
2 1 3
1 2 100
2 2 2
```
### 样例输出 #2
```
0
3
93
```
### 样例输入 #3
```
9 5
1 0 2 0 4 1 3 2 8
2 2 3
2 1 3
1 5 1
1 6 4
2 4 2
```
### 样例输出 #3
```
2
1
0
```
## 提示


#### 样例解释

对于样例 $1$ 的第一个询问，有：

$$(\bold{\textcolor{red}{4}},8,\bold{\textcolor{red}{2}},0)\to (\bold{\textcolor{red}{4}},2)\to(2)$$

对于样例 $1$ 的第二个询问，有：

$$ (\bold{\textcolor{red}{8}},2)\to(6)$$

#### 数据范围

对于 $100\%$ 的数据，保证：

- $2\le N\le 200\, 000$，$1\le Q\le 200\, 000$；
- $0\le p_i\le 10^9$；
- $1\le i\le N$，$0\le r\le 10^9$；
- $1\le l\le N$，$1\le l+{2^k}-1\le N$。

| 子任务编号 | 分值 | 约束  |
|:-----:|:------:|:-------:|
| $1$   | $11$    | $N, Q \leq 1000$ |
| $2$    | $13$    | $N=2^k$ |
| $3$    | $16$    | $0\le p_i,r\le 1$ |
| $4$    | $17$    | 不含修改操作 |
| $5$    | $43$    | 无额外约束 |




---

---
title: "[迷宫寻路 Round 3] 七连击"
layout: "post"
diff: 提高+/省选-
pid: P11626
tag: ['动态规划 DP', 'O2优化', '最大公约数 gcd', 'ST 表']
---
# [迷宫寻路 Round 3] 七连击
## 题目背景

**任何数和 $0$ 的最大公约数是它本身。**
## 题目描述

小 X 正在研究一个长度为 $n$ 的数列 $\{A\}$，他通过查阅资料，偶然间发现了一个叫做“七连击”的式子：$\sum\limits_{a=1}^n\sum\limits_{b=a+1}^n\sum\limits_{c=b+1}^n\sum\limits_{d=c+1}^n\sum\limits_{e=d+1}^n\sum\limits_{f=e+1}^n\sum\limits_{g=f+1}^n ((\gcd\limits_{i=1}^aA_i)+(\gcd\limits_{i=a+1}^bA_i)+(\gcd\limits_{i=b+1}^cA_i)+(\gcd\limits_{i=c+1}^dA_i)+(\gcd\limits_{i=d+1}^eA_i)+(\gcd\limits_{i=e+1}^fA_i)+(\gcd\limits_{i=f+1}^gA_i))$。

其中 $(\gcd\limits_{i=l}^r A_i)$ 表示 $A_l,A_{l+1},\dots,A_r$ 的最大公约数。

现在小 X 希望你求出这个式子的值。
由于答案可能很大，他只需要你输出答案对 $998244353$ 取模的结果。
## 输入格式

第一行一个整数 $n$，表示序列长度。

第二行 $n$ 个整数表示序列 $\{A\}$。
## 输出格式

一行一个整数表示答案对 $998244353$ 取模的结果。
## 样例

### 样例输入 #1
```
7
3 4 2 5 6 3 4

```
### 样例输出 #1
```
27

```
### 样例输入 #2
```
10
9 9 9 8 8 8 72 72 72 2

```
### 样例输出 #2
```
20040
```
### 样例输入 #3
```
20
3 5 5 5 7 15 20 14 28 9 36 3 4 5 7 19 16 28 37 29

```
### 样例输出 #3
```
3207876

```
### 样例输入 #4
```
30
1 9 8 8 8 3 3 4 2 2 3 3 9 8 8 6 6 7 3 3 6 6 8 8 4 3 3 6 6 8
```
### 样例输出 #4
```
34595704
```
### 样例输入 #5
```
50
9 9 9 9 63 72 36 36 4 4 4 20 20 20 10 10 70 2 12 9 9 9 9 63 72 36 36 4 4 4 20 20 20 10 10 70 2 12 9 9 9 9 63 72 36 36 4 4 4 4
```
### 样例输出 #5
```
24688627
```
## 提示

**本题采用捆绑测试。**

对于所有数据，$7\le n\le 10^5$，$0\le A_i\le 10^9$。

| 子任务编号 | $n\leq$ | $A_i\leq$ | 特殊性质 | 分数 |
| :----------: | :----------: | :----------: | :----------: | :----------: |
| $0$ | $7$ | $10^9$ | 否 | $1$ |
| $1$ | $10$ | $10^9$ | 否 | $9$ |
| $2$ | $100$ | $10^9$ | 否 | $10$ |
| $3$ | $1000$ | $10^9$ | 否 | $20$ |
| $4$ | $10^5$ | $100$ | 否 | $10$ |
| $5$ | $10^5$ | $10^9$ | 是 | $10$ |
| $6$ | $10^5$ | $10^9$ | 否 | $40$ |

特殊性质： 对于任意满足 $1\le i\le n$ 的整数 $i$，$A_i$ 在 $[0,10^9]$ 中随机生成。


---

---
title: "[蓝桥杯 2025 省 A] 扫地机器人"
layout: "post"
diff: 提高+/省选-
pid: P12145
tag: ['线段树', '单调队列', '2025', '树形 DP', '树的直径', 'ST 表', '基环树', '蓝桥杯省赛']
---
# [蓝桥杯 2025 省 A] 扫地机器人
## 题目描述

在一个含有 $n$ 个点 $n$ 条边的无重边无自环的连通无向图中，有一个扫地机器人在执行清扫作业。其中结点 $i$ 的标记 $t_i \in \{0,1\}$：如果为 $1$，则说明该结点需要进行清扫，扫地机器人在到达这个结点时会顺便进行清扫工作。机器人想知道，如果选定任意结点出发，每条边只能经过一次的话，最多能清扫多少个待清扫结点？
## 输入格式

输入的第一行包含一个正整数 $n$。

第二行包含 $n$ 个整数 $t_1, t_2, \cdots, t_n$，相邻整数之间使用一个空格分隔。

接下来 $n$ 行，每行包含两个正整数 $u_i, v_i$，用一个空格分隔，表示结点 $u_i$ 和结点 $v_i$ 之间有一条边。
## 输出格式

输出一行包含一个整数表示答案。
## 样例

### 样例输入 #1
```
9
1 0 1 0 0 1 1 0 1
2 8
2 9
2 5
1 5
1 3
1 4
4 5
4 6
6 7
```
### 样例输出 #1
```
4
```
## 提示

### 样例说明
其中一种可行路线：$3 \rightarrow 1 \rightarrow 4 \rightarrow 6 \rightarrow 7$，清扫结点 $3, 1, 6, 7$（共 $4$ 个）。

### 评测用例规模与约定

- 对于 $20\%$ 的评测用例，$1 \leq n \leq 5000$；
- 对于所有评测用例，$1 \leq n \leq 500000$，$t_i \in \{0,1\}$，$1 \leq u_i, v_i \leq n$。


---

---
title: "由乃救爷爷"
layout: "post"
diff: 提高+/省选-
pid: P3793
tag: ['洛谷原创', 'O2优化', '栈', 'ST 表', '洛谷月赛']
---
# 由乃救爷爷
## 题目背景

大家看过葫芦娃吧？

没看过也没关系，让由乃告诉你吧

 ![](https://cdn.luogu.com.cn/upload/pic/5725.png) 

 ![](https://cdn.luogu.com.cn/upload/pic/5740.png) 

传说明斯克航空航天局里关着两个坦克，strv103b和krv。

 ![](https://cdn.luogu.com.cn/upload/pic/5733.png) 

 ![](https://cdn.luogu.com.cn/upload/pic/5722.png) 

鼠爷不小心打破了明斯克航空航天局，两个坦克逃了出来，从此其他坦克过上了水深火热的生活。

明斯克航空航天局急忙去告诉一个叫做serb的光头，只有YY出七辆图纸车，才能消灭这两个卖头势力。

serbYY出了七个连图纸都没有的车，却被瑞典人从bbs中窥见 。他们摧毁不了这七个YY车，

就把serb和鼠爷抓去。但是这时候七个坦克模型已经建出来了。

她们分别是 T28原型，T100lt，907工程，蟋蟀15，WZ111，FV215b183，FV215b

她们为了消灭卖头势力，救出serb和鼠爷，一个接一个去与卖头势力搏斗。

 ![](https://cdn.luogu.com.cn/upload/pic/5723.png) 

T28原是正面很硬的TD，但装甲在金币弹面前一点用都没有，直接被krv卖头打死。

 ![](https://cdn.luogu.com.cn/upload/pic/5728.png) 

T100lt是隐蔽超好的眼车，却因为没有视野，被103b活活黑死。

 ![](https://cdn.luogu.com.cn/upload/pic/5724.png) 

907工程是铁头，被krv顶牛直接抽包抽死。

 ![](https://cdn.luogu.com.cn/upload/pic/5727.png) 

蟋蟀15会黑枪，却因为辣鸡的转向被krv绕死。

 ![](https://cdn.luogu.com.cn/upload/pic/5729.png) 

WZ111有三百穿，被103b穿侧面一发爆了弹药架。

 ![](https://cdn.luogu.com.cn/upload/pic/5730.png) 

FV215b183有183炮，103b和krv瑟瑟发抖，不敢打她，于是她解救了其他所有坦克。

 ![](https://cdn.luogu.com.cn/upload/pic/5734.png) 

但是自己的兄弟FV215b因为瑞典人的诱惑，决定叛变（因为183OO大），TK了183一发，然后183着火烧死了，结果所有坦克都被103b和krv降服了。

瑞典人把七个坦克还有鼠爷一起给serb，让serb做出两辆最强坦克加入瑞典阵营。serb用尽了他所有的脑洞，做出了两辆车E100WT和T-50-2

 ![](https://cdn.luogu.com.cn/upload/pic/5731.png) 

 ![](https://cdn.luogu.com.cn/upload/pic/5732.png) 

krv和103b看到之后蛤蛤大笑

krv：E100WT，10mm的脸，不被HE糊死才怪

103b：E100WT，灯塔般的隐蔽，不被黑死才怪

krv：T-50-2，这血量，我一炮就可以打死

103b：T-50-2，看是你机动好还是我黑枪准

serb：百运，胶水，让她们看看你们的厉害

## 题目描述

故事还没讲完

krv骑坡卖头，却发现百运凭借优秀的精度炮炮打穿她的观察孔

krv慌了，跑去城市里面伸缩，被百运站桩撸死

strv103b跑去草后黑枪，看见胶水在肉侦，却发现自己根本打不中她，然后就被胶水点亮了，百运一梭子128的ARCR飞了过来

strv103b怂了，准备跑路了，但是还没等到自己切换回行走模式，胶水已经开始断她的腿了，被胶水断死


瑞典车们高呼不可战胜，从此不敢嚣张了


然后serb把百运和胶水加入了WOT

从此
其他坦克过上了更加水深火热的生活


然而你又不玩WOT，这事情不管你什么事啊

然而yql是大家的妹妹，所以这件事很重要：


yql在AK曼哈顿OI，CTSC，APIO之后，开始研究数学题。

由乃在挂了字符串OI，CTSC，APIO之后，开始研究大母神原型。

yql出了个数学题，由乃画出了一个表示大母神的图腾。

然后把这两个合成了一个题：


然而由于未知原因那个题挂掉了。。。

由乃想起来SCOI 2017 电子科技大学出了个卡常的rmq，然后发生了一件很有趣的事情

就是一位姓王的同学凭借奇奇怪怪的常数优化怒草了那个题，还比标程块了233倍

所以由乃也出了个卡常rmq，因为没题出了

## 输入格式

给你一个随机数生成器

```cpp
namespace GenHelper
{
    unsigned z1,z2,z3,z4,b;
    unsigned rand_()
    {
    b=((z1<<6)^z1)>>13;
    z1=((z1&4294967294U)<<18)^b;
    b=((z2<<2)^z2)>>27;
    z2=((z2&4294967288U)<<2)^b;
    b=((z3<<13)^z3)>>21;
    z3=((z3&4294967280U)<<7)^b;
    b=((z4<<3)^z4)>>12;
    z4=((z4&4294967168U)<<13)^b;
    return (z1^z2^z3^z4);
    }
}
void srand(unsigned x)
{using namespace GenHelper;
z1=x; z2=(~x)^0x233333333U; z3=x^0x1234598766U; z4=(~x)+51;}
int read()
{
    using namespace GenHelper;
    int a=rand_()&32767;
    int b=rand_()&32767;
    return a*32768+b;
}
```
读入三个数n,m,s

你需要srand( s )一下

然后n个数表示a[i]，这个直接调用read函数

然后m个询问，表示区间**最大值**，询问的区间是l = read() % n + 1 , r = read() % n + 1，注意有可能l > r

## 输出格式

输出一个unsigned long long 表示每次询问的答案的和

## 样例

### 样例输入 #1
```
233 233 233
```
### 样例输出 #1
```
243704637294
```
## 提示

```cpp
n,m=1000,1s
n,m=1000,1s
n,m=100000,1s
n,m=500000,1s
n,m=1000000,1s
n,m=10000000,5s
n,m=12000000,5s
n,m=15000000,5s
n,m=20000000,5s
```


---

---
title: "【AFOI-19】区间与除法"
layout: "post"
diff: 提高+/省选-
pid: P5629
tag: ['线段树', 'ST 表', '字典树 Trie']
---
# 【AFOI-19】区间与除法
## 题目背景

SY 好不容易才解出QM给她的数学题，在恰午饭的时候，QM 向她的脑洞里塞了个幻想的泡泡……SY 戳开一看，又是长长的一串数字!

SY 实在是不想思考了，她决定用小学的除法消灭她脑洞里的数字.
## 题目描述

定义 $op$ 操作意义为将当前数除以 $d$ 并向下取整.

SY 现在有 $m$ 个“原数”，若一个数经过若干次 $op$ 操作(包括 $0$ 次)后能变为这个“原数”，那么这个数是可以被这个“原数”所消灭的。注意，“原数”是不会被消耗的.

现在 SY 想问你,对于一个区间 $[l,r]$，在消灭最多个数的前提下最少需要多少个“原数”？
## 输入格式

第一行 $4$ 个数,分别是 $n,m,d,q$,分别表示数列 $\{a\}$ 元素个数，SY 拥有的 “原数” 个数，$op$ 操作参数，询问个数。

第二行为 $\{a\}$ 数列，即需要被消灭的数列。

第三行为 $m$ 个“原数”。

接下来 $q$ 行，每行两个数 $l$ 和 $r$，表示询问区间为 $[l,r]$。
## 输出格式

按照询问顺序，每一行输出一个整数表示答案.
## 样例

### 样例输入 #1
```
2 3 3 3
0 20
6 6 6
1 1
2 2
1 2

```
### 样例输出 #1
```
0
1
1

```
### 样例输入 #2
```
6 3 3 3
6 5 10 15 19 7
2 5 10
1 6
1 4
4 6

```
### 样例输出 #2
```
3
3
2

```
## 提示

#### 样例解释：

**#样例1** ： $20$ 经过一次 $op$ 操作（除以 $3$ 向下取整）可以变成 $6$，而 $0$ 不能经过若干次 $op$ 操作变成 $6$ 。

所以区间 $[1,1]$ 最多消灭 $0$ 个数，消灭最多数前提下最少需要 $0$ 个 "原数"，区间 $[1,2],[2,2]$ 最多消灭 $1$ 个数，消灭最多数前提下最少需要 $1$ 个 "原数" 。

**#样例2** ： $2$ 能消灭 $\{6,19,7\}$ ， $5$ 能消灭 $\{5,15\}$ ， $10$ 能消灭 $\{10\}$ ， 所以区间 $[1,6],[1,4]$ 最少能用所有 "原数" 全部消灭，区间 $[4,6]$ 能用 $2,5$ 全部消灭。

#### 数据范围：

对于 $30\%$ 的数据：$n\le100,m\leq10, d=2, q\le 10$

对于 $100\%$ 的数据：$n\le5\times 10^{5},m\leq60,2\leq d\leq10,q\le10^{6},0\le a_i,b_i\le 2^{63}$

![](https://cdn.luogu.com.cn/upload/image_hosting/t7pn0p1n.png)

特殊性质：数据经过构造。


---

---
title: "[CCC 2019] Triangle: The Data Structure"
layout: "post"
diff: 提高+/省选-
pid: P6648
tag: ['动态规划 DP', '递推', '2019', '倍增', 'CCC（加拿大）', 'ST 表']
---
# [CCC 2019] Triangle: The Data Structure
## 题目背景

在 Shuchong 的平行宇宙里，计算机学中的最重要的数据结构就是三角形。   
注：因为原数据包太大，故这题缩减了一些数据，具体缩减的数据点如下：

- Subtask 1：1 ~ 10
- Subtask 2：1 ~ 10

所以此题拥有的测试点为：

- Subtask 1：11 ~ 26
- Subtask 2：11 ~ 24

若想测试本题没有的测试点请到 [此处](https://www.luogu.com.cn/problem/U120704) 测试。
## 题目描述

大小为 $m$ 的一个三角形由 $m$ 行组成，第 $i$ 行包含 $i$ 个元素。   
并且，这些行必须排为等边三角形的形状。  
比如说，以下是一个 $m=4$ 的三角形。   
![](https://cdn.luogu.com.cn/upload/image_hosting/fdut4hrs.png)    
每个三角形还包含子三角形。   
比如说上面这个三角形，包含：
- $10$ 个大小为 $1$ 的三角形。
- $6$ 个大小为 $2$ 的三角形。
- $3$ 个大小为 $3$ 的三角形。

注意，每个三角形都是自身的子三角形。   
现在给定一个大小为 $n$ 的三角形，求对于每个大小为 $k$ 的子三角形，子三角形内几个数的最大值的和。
## 输入格式

第一行两个整数 $n,k$ 代表三角形的大小和要求的子三角形的大小。   
接下来 $n$ 行第 $i$ 行有 $i$ 个整数代表这个三角形。
## 输出格式

一行一个整数代表对于每个大小为 $k$ 的子三角形，子三角形内几个数的最大值的和。
## 样例

### 样例输入 #1
```
4 2
3
1 2
4 2 1
6 1 4 2
```
### 样例输出 #1
```
23
```
## 提示

#### 数据规模与约定

- Subtask 1（25 pts）：$n \le 1000$。
- Subtask 2（75 pts）：无特殊限制。

对于 $100\%$ 的数据，$1 \le k \le n \le 3000$，$0 \le $ 三角形内每个数 $\le 10^9$。

#### 说明

**翻译自 [CCC 2019](https://cemc.math.uwaterloo.ca/contests/computing/2019/index.html) Senior T5 [Triangle: The Data Structure](https://cemc.math.uwaterloo.ca/contests/computing/2019/stage%201/seniorEF.pdf)。**   
翻译者：@[一只书虫仔](https://www.luogu.com.cn/user/114914)。


---

---
title: "[eJOI 2020] Fountain (Day1)"
layout: "post"
diff: 提高+/省选-
pid: P7167
tag: ['2020', '倍增', 'eJOI（欧洲）', 'ST 表']
---
# [eJOI 2020] Fountain (Day1)
## 题目描述

大家都知道喷泉吧？现在有一个喷泉由 $N$ 个圆盘组成，从上到下以此编号为 $1 \sim N$，第 $i$ 个喷泉的直径为 $D_i$，容量为 $C_i$，当一个圆盘里的水大于了这个圆盘的容量，那么水就会溢出往下流，直到流入半径大于这个圆盘的圆盘里。如果下面没有满足要求的圆盘，水就会流到喷泉下的水池里。

现在给定 $Q$ 组询问，每一组询问这么描述：

- 向第 $R_i$ 个圆盘里倒入 $V_i$ 的水，求水最后会流到哪一个圆盘停止。

如果最终流入了水池里，那么输出 $0$。

**注意，每个询问互不影响。**
## 输入格式

第一行两个整数 $N,Q$ 代表圆盘数和询问数。      
接下来 $N$ 行每行两个整数 $D_i,C_i$ 代表一个圆盘。       
接下来 $Q$ 行每行两个整数 $R_i,V_i$ 代表一个询问。
## 输出格式

$Q$ 行每行一个整数代表询问的答案。
## 样例

### 样例输入 #1
```
6 5
4 10
6 8
3 5
4 14
10 9
4 20
1 25
6 30
5 8
3 13
2 8
```
### 样例输出 #1
```
5
0
5
4
2
```
## 提示

#### 样例 1 解释

前两个询问的解释如下图所示：

![](https://cdn.luogu.com.cn/upload/image_hosting/64e7acuq.png)

因为每个询问互不影响，对于第三个询问，第 $5$ 个圆盘里的水不会溢出。

#### 数据规模与约定

**本题采用捆绑测试。**

- Subtask 1（30 pts）：$N \le 1000$，$Q \le 2000$。
- Subtask 2（30 pts）：$D_i$ 为严格单调递增序列。
- Subtask 3（40 pts）：无特殊限制。

对于 $100\%$ 的数据：

- $2 \le N \le 10^5$。
- $1 \le Q \le 2 \times 10^5$。
- $1 \le C_i \le 1000$。
- $1 \le D_i,V_i \le 10^9$。
- $ 1\le R_i \le N$。

#### 说明

翻译自 [eJOI 2020 Day1 A Fountain](https://ejoi2020.ge/static/assets/Day1/Problems/Fountain.pdf)。


---

---
title: "章节划分"
layout: "post"
diff: 提高+/省选-
pid: P7244
tag: ['动态规划 DP', '数学', '线段树', '树状数组', 'O2优化', 'ST 表']
---
# 章节划分
## 题目背景

&emsp;&emsp;作文周，顾名思义，一天写一篇，高产似那啥。

&emsp;&emsp;小灰毛的作文被老师无数次公开处刑，昨天自己的奶奶变成了别人作文里的外婆，今天憋出来的小面变成了明天别人的酸辣粉。素材一用，就报废了啊 qwq。

&emsp;&emsp;于是，不甘心的小灰毛决定加倍高产。
## 题目描述

天依决定了 $n$ 个素材，它们将**依次**在作文中被叙写。其中，第 $i$ 个素材的立意特征值是 $a_i$。

但天依发现她构思的大作实在是太长啦，所以她想把它们划分为**恰好 $k$ 个**章节，每个章节包含一段**连续且非空的**素材。假设第 $i$ 个章节包含素材 $[l_i,r_i]$，天依将选取立意特征值最大的素材来升华，得到该章节的立意值 $b_i$，满足 $b_i=\max\limits_{i\in[l_i,r_i]}\{a_i\}$。  

最后，整篇作文的凝练度为每个章节立意值的**最大公约数**，即 $\gcd\limits_{i\in[1,k]}\{b_i\}$。

天依当然希望**最大化**作文的凝练度，那么凝练度的最大值是多少呢？

---

#### 简化题意

有一个长度为 $n$ 的序列 $a$。要求将这个序列**恰好**分成**连续且非空**的 $k$ 段，并定义第 $i$ 段的立意值为该段的所有元素的最大值，记为 $b_i$。要求最大化 $\gcd\limits_{i\in[1,k]}\{b_i\}$ 并输出这个最大值。
## 输入格式

第一行包含两个整数 $n,k$，表示素材的长度和需要划分的章节数。

接下来第二行包含 $n$ 个整数，表示每个素材的立意特征值。
## 输出格式

一行一个整数，表示你的答案。
## 样例

### 样例输入 #1
```
5 3
1 3 2 9 6
```
### 样例输出 #1
```
3
```
### 样例输入 #2
```
5 2
10 2 5 5 5
```
### 样例输出 #2
```
5
```
## 提示

#### 样例解释 1
最优的素材划分可能有多种，这里给出一种最优的素材划分，将这 $5$ 个素材分成 $3$ 个章节：$[1,3],[2,9],[6]$，可以得出 $b_1=3,b_2=9,b_3=6$，凝练度的最大值为 $\gcd(3,9,6)=3$。

------------

#### 数据规模与约定
**本题采用捆绑测试。**

对于 $100\%$ 的数据，$1\le k\le n\le 10^5$，$1\le a_i\le 10^{6}$。

| 子任务 | 分值 |        $n$         | $k$  |       $a_i$        |
| :----: | :--: | :----------------: | :--: | :----------------: |
|   1    |  5   |      $\le 5$      |  /   |         /          |
|   2    |  10  |     $\le 10^2$     |  /   |         /          |
|   3    |  10  |         /          | $2$  |         /          |
|   4    |  15  |         /          | $3$  |         /          |
|   5    |  20  | $\le 3\times 10^3$ |  /   |         /          |
|   6    |  10  |         /          |  /   | $\le 2\times 10^2$ |
|   7    |  30  |         /          |  /   |         /          |


---

---
title: "[KSN2021] Delivering Balls"
layout: "post"
diff: 提高+/省选-
pid: P7974
tag: ['贪心', '2021', 'ST 表']
---
# [KSN2021] Delivering Balls
## 题目描述

给定一个长度为 $N$ 的序列 $H$ 和 $Q$ 次询问。

第 $i$ 次询问中，你初始在第 $S_i$ 列 $H_{S_i}$ 行，想要到第 $T_i$ 列第 $H_{T_i}$ 行。

你可以进行若干次移动。每次移动你可以选择以下两种参数：

* 列 $-1$，列不变，列 $+1$。
* 行 $-1$，行不变，行 $+1$。

如果你选择行 $-1$，消耗 $1$ 体力，如果你选择行不变，消耗 $2$ 体力，如果你选择行 $+1$，消耗 $4$ 体力。

你需要保证每次移动后，你的列数 $x$ 在 $[1,N]$ 之间，且你的行数 $y$ 不小于 $H_x$。

对于每个询问，你需要求出你消耗体力的最小值。
## 输入格式

第一行输入一个正整数 $N$。

第二行输入 $N$ 个正整数 $H_i$。

接下来 $Q$ 行，每行输入两个正整数 $S_i,T_i$。
## 输出格式

对于每个询问，输出一行，包含一个整数，代表消耗体力的最小值。
## 样例

### 样例输入 #1
```
4
9 1 8 2
2
1 3
4 2
```
### 样例输出 #1
```
3
31
```
### 样例输入 #2
```
9
1 2 3 2 1 2 3 2 1
4
1 9
4 6
2 6
5 2
```
### 样例输出 #2
```
18
4
9
9
```
## 提示

**【样例解释】**

以下为第一个样例中两个询问的图示：

![](https://sandalphon.tlx.toki.id/api/v2/problems/JIDPROG92Su7ScrLh6DkhILekKA/render/roket-q-1.png) ![](https://sandalphon.tlx.toki.id/api/v2/problems/JIDPROG92Su7ScrLh6DkhILekKA/render/roket-q-2.png)

**【数据范围】**

- Subtask 1（7 points）：只存在一组数据，满足 $N=8$，$Q=4$，$H=[,9,3,3,5,4,8,2]$，$(S_i,T_i)$ 依次为 $(1,8)$，$(3,6)$，$(6,4)$ 和 $(7,2)$。
- Subtask 2（5 points）：$S_i+1=T_i$。
- Subtask 3（6 points）：$H_i=i$。
- Subtask 4（18 points）：$N,Q,H_i\leq 100$。
- Subtask 5（24 points）：$N,Q\leq 1000$。
- Subtask 6（13 points）：$S_i=1$。
- Subtask 7（27 points）：无特殊限制。

对于所有数据，$2\leq N\leq 2\times 10^5$，$H_i\leq 10^9$，$Q\leq 2\times 10^5$，$1\leq S_i,T_i\leq N$。


---


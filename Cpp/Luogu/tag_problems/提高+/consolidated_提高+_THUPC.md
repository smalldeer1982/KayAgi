---
title: "[THUPC 2024 决赛] RPG"
layout: "post"
diff: 提高+/省选-
pid: P10542
tag: ['2024', 'THUPC']
---
# [THUPC 2024 决赛] RPG
## 题目描述

小 I 正在打一款回合制 RPG 的最终 boss 战。这一战中，主角和 TA 的 $(n-1)$ 个队友（也就是总共 $n$ 个人）会按照固定的顺序依次行动，目标是对 boss 产生尽可能高的总伤害。

游戏设定中共有 $x$ 种攻击模式，第 $i (1 \le i \le x)$ 种攻击模式会对 boss 产生 $d_i$ 的基础伤害。

在行动过程中可以对 boss 附着异常状态。异常状态共 $y$ 种，同一时刻 boss 不会陷入两种异常状态。当 boss 陷入特定的异常状态时，使用特定的攻击模式会触发暴击，产生更大的伤害。暴击的规则由 $m$ 个三元组 $(p_j, q_j, c_j)$ 给出，表示在附着第 $p_j (1 \le p_j \le y)$ 种异常状态时使用第 $q_j (1 \le q_j \le x)$ 种攻击模式会**额外**产生 $c_j$ 的伤害。

对战开始时，boss 没有陷入任何的异常状态。按照行动顺序，第 $i (1 \le i \le n)$ 个人可以进行以下三种行动：

- 使用法术使 boss 陷入第 $a_i$ 种异常状态，若 boss 之前陷入了其他异常状态，则之前的异常状态被移除。
- 使用第 $b_i$ 种攻击模式对 boss 进行攻击，无论是否触发暴击，在产生伤害之后 **boss 的异常状态被移除**。
- 摸鱼，即什么都不做，此时 boss 的异常状态被保留。

作为剧情党，小 I 自然是不想自己算最优策略，于是他把问题丢给了你。于是你需要求出 $n$ 次行动内总共能产生最多多少伤害。

## 输入格式

输入的第一行四个整数 $n, m, x, y (1 \le n, m, x, y \le 2 \times 10^5)$，分别表示行动次数、暴击规则数、攻击模式种类数和异常状态种类数。

第二行 $x$ 个整数 $d_1,d_2,\cdots,d_x (1 \le d_i \le 10^9)$，依次描述每种攻击模式对 boss 产生的基础伤害量。

接下来 $n$ 行第 $i$ 行两个整数 $a_i, b_i (1 \le a_i \le y, 1 \le b_i \le x)$，按照行动次序描述第 $i$ 个人的行动。

接下来 $m$ 行第 $j$ 行三个整数 $p_j, q_j, c_j (1 \le p_j \le y, 1 \le q_j \le x, 1 \le c_j \le 10^9)$，描述第 $j$ 条暴击规则。保证 $(p_j, q_j)$ 两两不同。
## 输出格式

输出一行一个整数，表示 $n$ 次行动对 boss 产生的伤害量总和的最大值。

## 样例

### 样例输入 #1
```
4 1 2 2
10 1
2 1
1 1
1 2
2 2
2 2 1000000000

```
### 样例输出 #1
```
1000000002

```
## 提示

样例中共有两种攻击模式和两种异常状态，其中第一种攻击模式会造成 $10$ 的基础伤害，第二种攻击模式会造成 $1$ 的基础伤害。暴击规则仅有一条：在第二种异常状态下进行第二种攻击会额外造成 $10^9$ 的伤害。

最优的行动策略如下：

- 第一个人使用法术使 boss 陷入第二种异常状态；
- 第二个人摸鱼，boss 仍然陷入第二种异常状态；
- 第三个人使用第二种攻击模式，产生 $1$ 的基础伤害和 $10^9$ 的暴击伤害，boss 的异常状态被清除；
- 第四个人使用第二种攻击模式，产生 $1$ 的基础伤害。

总伤害量为 $1 + 10^9 + 1 = 10^9+2$。

**来源与致谢**

来自 THUPC2024（2024年清华大学学生程序设计竞赛暨高校邀请赛）决赛。感谢 THUSAA 的提供的题目。

数据、题面、标程、题解等请参阅 THUPC 官方仓库 <https://thusaac.com/public>


---

---
title: "[THUPC 2024 决赛] 简单博弈"
layout: "post"
diff: 提高+/省选-
pid: P10549
tag: ['2024', 'THUPC']
---
# [THUPC 2024 决赛] 简单博弈
## 题目描述

有 $k$ 个棋盘。每个棋盘大小为 $n\times m$ ，上面有 $3$ 个位置是 $0$，其他是 $1$。

现在 A 和 B 轮流操作，每次操作需要指定一个棋盘，在该棋盘上选定一行或者选定一列或者选定一行一列，将其全部变成 $0$。但是要保证操作前后棋盘至少一个格子数字变了。

不能操作就输了。问是否先手必胜。

## 输入格式

输入的第一行包含一个正整数 $k$ 表示棋盘总数，保证 $1 \le k \le 10^5$。

接下来 $k$ 组数据，第 $i$ 组数据共 4 行，描述第 $i$ 张棋盘的样子：

* 第 1 行用空格隔开的两个正整数 $n,m$ 分别表示棋盘的行数和列数，保证 $1\le n,m \le 500$。
* 第 2-4 行，每行用空格隔开的两个正整数 $x,y$ 表示该棋盘上为 $0$ 的位置，保证互不相同且 $1\leq x\leq n, 1\leq y\leq m$ 。
## 输出格式

如果先手必胜，输出一个字符串 `OvO`，否则输出一个字符串 `QAQ`。

## 样例

### 样例输入 #1
```
1
2 3
1 1
2 1
2 2

```
### 样例输出 #1
```
OvO
```
### 样例输入 #2
```
1
4 4
1 1
1 2
4 2

```
### 样例输出 #2
```
QAQ
```
## 提示

一开始棋盘为：

```
011
001
```

先手只需要选中第 1 行第 2 列即可全部清零，从而后手无法操作，先手获胜。



**来源与致谢**

来自 THUPC2024（2024年清华大学学生程序设计竞赛暨高校邀请赛）决赛。感谢 THUSAA 的提供的题目。

数据、题面、标程、题解等请参阅 THUPC 官方仓库 <https://thusaac.com/public>


---

---
title: "[THUPC 2024 决赛] 贸易"
layout: "post"
diff: 提高+/省选-
pid: P10550
tag: ['2024', 'THUPC']
---
# [THUPC 2024 决赛] 贸易
## 题目描述

小 Z 生活的学校就像是一条链，直径很长，宽度很窄。

具体来说，这里有一个长度为 $n$ 的序列，每个位置有一个属性 $a_i\in \{0/1\}$ 和一个类型 $c_i$，在这里有一些贸易事件会发生。

小 Z 从左往右通过这个序列，若当前遇到一个 $0$ 属性的节点，则小 Z 可以购入至多一个 $c_i$ 类型的物品，若当前遇到一个 $1$ 属性的节点，则小 Z 可以卖出至多一个 $c_i$ 类型的物品，显然，在小 Z 没有这种类型的物品时是不能卖出的。

一次合法的交易定义为从某个节点买入，并在某个节点卖出，注意，你需要保证在最后小 Z 手里不存在任何东西。

给出 $q$ 次询问，每次小 Z 从 $l_i$ 顺序走到 $r_i$，问：最大合法交易次数是多少。
## 输入格式

第一行两个正整数 $n,q$。

接下来一行 $n$ 个数，第 $i$ 个表示 $a_i$。

接下来一行 $n$ 个数，第 $i$ 个表示 $c_i$。

接下来 $q$ 行，每行两个数表示 $l_i,r_i$。

## 输出格式

输出共 $q$ 行，每行一个数表示当前这个询问中的最大合法交易次数。
## 样例

### 样例输入 #1
```
10 5
1 1 0 0 0 0 0 1 1 1 
1 1 1 1 1 1 1 1 1 1 
4 6
2 4
2 6
7 10
4 7

```
### 样例输出 #1
```
0
0
0
1
0

```
## 提示

对于所有数据，满足 $1\le n,q\le5\times 10^5,1\le c_i\le n,1\le l_i\le r_i\le n,a_i\in\{0,1\}$。

请注意输入输出效率。


**来源与致谢**

来自 THUPC2024（2024年清华大学学生程序设计竞赛暨高校邀请赛）决赛。感谢 THUSAA 的提供的题目。

数据、题面、标程、题解等请参阅 THUPC 官方仓库 <https://thusaac.com/public>


---

---
title: "[THUPC 2025 初赛] Imyourfan"
layout: "post"
diff: 提高+/省选-
pid: P11526
tag: ['2025', 'THUPC']
---
# [THUPC 2025 初赛] Imyourfan
## 题目描述

W 老师正在和他的粉丝 Menji 玩一个游戏。

桌上有 $n$ 张卡片，编号为 $1\sim n$，每张卡片有一个字母 $s_i$，其中 $s_i$ 为 $\texttt{X},\texttt{W},\texttt{M}$ 中的一个，且保证至少存在一个 $\texttt{W}$ 和至少一个 $\texttt{M}$。

W 老师和 Menji 轮流操作，W 老师先手，当轮到一名玩家操作时，他会选择一个区间 $[l,r](1\leq l\leq r\leq n)$，满足区间中不存在写有字母 $\texttt{X}$ 的卡片，然后拿走区间内所有卡片。

若在某次操作过后，所有的 $\texttt{W},\texttt{M}$ 卡片都已经被拿走，那么游戏平局，否则若某次操作后所有的 $\texttt{W}$ 都被拿走，那么 W 老师获胜，如果某次操作后所有的 $\texttt{M}$ 都被拿走，那么 Menji 获胜。

W 老师和 Menji 都是绝顶聪明的，现在给定所有的 $s_1\dots s_n$，请判断游戏的结果，若 W 老师获胜则输出 `Water`，如果 Menji 获胜则输出 `Menji`，如果平局则输出 `Draw`。
## 输入格式

本题含有多组测试数据。

第一行一个整数 $T(1\leq T\leq 10^5)$，表示测试数据数量。

对于每一组数据：

输入一行一个字符串 $n(2\leq |s| \leq 10^5)$，其中 $n=|s|$，$s_i$ 即为卡片 $i$ 上的字母。

## 输出格式

对于每一组数据，输出一行一个字符串，若 W 老师获胜则输出 `Water`，如果 Menji 获胜则输出 `Menji`，如果平局则输出 `Draw`。

## 样例

### 样例输入 #1
```
6
WMW
MWM
WMWXMWM
WWWXMMMXWWW
MMMXWWWXMMM
WMWMWMWWMWW
```
### 样例输出 #1
```
Draw
Water
Draw
Menji
Water
Draw
```
## 提示

- 对于第一组数据，若 W 老师直接拿走所有的卡片，那么游戏是平局，否则 W 老师无法同时拿走两张写有 $\texttt{W}$ 的卡片，Menji 可以此时拿走写有 $\texttt{M}$ 的卡片并获胜。所以 W 老师一定会拿走所有卡片，游戏结果为平局。

- 对于第二组数据，W 老师直接拿走 $\texttt{W}$ 即可获胜。


#### 题目来源

来自 2025 清华大学学生程序设计竞赛暨高校邀请赛（THUPC2025）初赛。

题解等资源可在 <https://gitlink.org.cn/thusaa/thupc2025pre/tree/master> 查看。


---

---
title: "[THUPC 2025 初赛] 检查站"
layout: "post"
diff: 提高+/省选-
pid: P11531
tag: ['2025', '网络流', '最小割', 'THUPC']
---
# [THUPC 2025 初赛] 检查站
## 题目描述

小 I 是一个巨大的铁路公司的主管，他管理着 $n$ 个火车站，用 $1$ 至 $n$ 的整数给它们编号。铁路公司有 $c$ 个分部，第 $i$ 个分部的办公室位于火车站 $p_i$。可能有火车站没有分部办公室，一个火车站也有可能有多个分部办公室。

$n$ 个火车站之间由 $m$ 条单向铁路连接，其中第 $i$ 条铁路由火车站 $u_i$ 连向 $v_i$，属于分部 $r_i$ 管辖。为了保证管理方便，分部 $r_i$ 的办公室要么在 $u_i$，要么在 $v_i$。

火车站 $1$（港口）和 $n$（首都）是公司管辖范围内最繁忙的车站。为了保障进口货物安全，根据交通运输部的要求，小 I 需要在一些铁路上设立检查站，使得从火车站 $1$ 到火车站 $n$ 的所有可能路线上都有一个有检查站的铁路。

小 I 可以通知一些分部（也可以不通知任何分部），要求这些分部在它们管理的所有铁路上设立检查站。小 I 想知道，最少需要通知多少个分部才可以达到要求。作为新上任的算法工程师，你准备给小 I 露一手。
## 输入格式

输入的第一行三个整数 $n,m,c (2 \le n, m, c \le 5\times 10^4)$，分别表示火车站数量、铁路数量和分部数量。

接下来一行 $c$ 个整数 $p_1, p_2, \cdots, p_c (1 \le p_i \le n)$，描述每个分部所在的火车站编号。

接下来 $m$ 行每行三个整数 $u_i, v_i, r_i (1 \le u_i, v_i \le n, 1 \le r_i \le c)$，描述一条铁路。保证 $p_{r_i} = u_i$ 或 $p_{r_i} = v_i$。
## 输出格式

输出一行一个整数表示最少需要通知的分部数量。
## 样例

### 样例输入 #1
```
5 10 3
3 1 4
1 3 1
4 3 1
3 2 1
3 5 1
1 2 2
2 1 2
1 4 2
5 1 2
1 4 3
4 5 3
```
### 样例输出 #1
```
2
```
## 提示

### 样例解释

该样例的铁路组织如下图所示，其中红色、绿色和黑色分别为 1、2、3 分部管辖的铁路。最优策略是通知分部 1 和 3。

![](https://cdn.luogu.com.cn/upload/image_hosting/yami1v28.png)

### 题目来源

题目来自 THUPC2025（2025年清华大学学生程序设计竞赛暨高校邀请赛）初赛，信息来源于 [THUSAAC 仓库](https://gitlink.org.cn/thusaa/thupc2025pre)。



---

---
title: "[THUPC 2025 决赛] 图，距离，最优化"
layout: "post"
diff: 提高+/省选-
pid: P12052
tag: ['2025', 'THUPC']
---
# [THUPC 2025 决赛] 图，距离，最优化
## 题目描述

给定 $n$ 个非负整数 $x_1,x_2,\dots,x_n$。

对于任意 $n$ 个节点的无向连通图 $G$，将其节点由 $1$ 至 $n$ 标号，则其分数定义为：

$$\text{score}(G) = \sum_{i=1}^n \sum_{j=i+1}^n \text{dist}_G(i, j)x_ix_j$$

其中 $\text{dist}_G(i,j)$ 表示图 $G$ 上 $i$ 到 $j$ 的最短路径长度。

你的任务是输出所有 $n$ 个节点的无向连通图中分数的最大值。
## 输入格式

本题有多组测试数据。输入的第一行一个整数 $t\ (1 \le t \le 300)$ 表示测试数据组数，接下来依次输入每组测试数据。

每组测试数据的的第一行一个整数 $n\ (1 \le n \le 300)$。

每组测试数据的第二行 $n$ 个整数 $x_1,x_2,\dots,x_n\ (0 \le x_i \le 2000)$ 描述序列 $x$。

保证所有测试数据的 $n$ 的和不超过 $300$。
## 输出格式

对于每组测试数据输出一行一个整数，表示所有无向连通图中分数的最大值。
## 样例

### 样例输入 #1
```
3
2
1 2
4
1 0 1 1
7
1 2 3 4 5 6 7

```
### 样例输出 #1
```
2
6
1044

```
## 提示

### 样例 #1 解释

对于第一组测试数据，只有一种合法方案 $G = \{(1,2)\}$。

对于第二组测试数据，一个最优方案为 $G = \{(1,2),(2,3),(2,4)\}$。


### 来源与致谢

来自 THUPC2025（2025 年清华大学学生程序设计竞赛暨高校邀请赛）决赛。感谢 THUSAA 的提供的题目。

数据、题面、标程、题解等请参阅 THUPC 官方仓库 <https://thusaac.com/public>。


---

---
title: "[THUPC 2025 决赛] 食堂"
layout: "post"
diff: 提高+/省选-
pid: P12054
tag: ['2025', 'THUPC']
---
# [THUPC 2025 决赛] 食堂
## 题目背景

……所以为什么会有两道食堂题？
## 题目描述


有一个位于第一象限的食堂。

食堂被划分为若干个 $1\times 1$ 的区域，区域 $(x,y)$ 为以 $(x,y),(x,y+1),(x+1,y),(x+1,y+1)$ 为顶点的正方形。称两个区域 $(x_1,y_1)$ 和 $(x_2,y_2)$ **相邻**当且仅当 $|x_1-x_2|+|y_1-y_2|=1$。

区域有两种类型，一种是可供顾客自由走动的过道，另一种是可供顾客坐下用餐的座位。食堂里的座位非常多，而且排布得很有规律：所有满足 $x\bmod 3\ne 0$ 且 $y\bmod 3\ne 0$ 的区域 $(x,y)$ 是座位，其他区域都是过道。四个相连的座位构成一张餐桌。

从上空俯瞰，食堂中座位的排布方式如下图：

![](https://cdn.luogu.com.cn/upload/image_hosting/lbsgpuuw.png)


在过道上，顾客可以自由移动。具体地，如果顾客当前位于过道 $(x,y)$，他可以走一步，移动到相邻的区域。如果顾客移动到了座位，他就会在此坐下。

顾客对座位的偏好可以用容忍度 $o\in\{0,1,2\}$ 来描述，其中：

- $o=0$ 的顾客只愿意坐到对应**餐桌**没有人的**空座位**上吃饭。

- $o=1$ 的顾客只愿意坐到相邻**座位**没有人的**空座位**上吃饭。

- $o=2$ 的顾客愿意坐在任何**空座位**上吃饭。

当一个顾客坐下之后，他就会专注地吃饭，就算有其他顾客出现，导致当前的座位变成他不愿意坐的座位，他也不会因此离开。

最开始的时候，餐厅里一个顾客也没有。接下来**依次**发生了 $q$ 个事件，每个事件是以下两种之一：

- 第一种事件：具有某个容忍度 $o$ 的顾客从区域 $(0,0)$ 进入餐厅，他会寻找移动步数最少的、他愿意坐的座位坐下，如果这样的座位有多个，顾客会选择 $x$ 坐标最小的，如果还有多个则会选择 $y$ 坐标最小的。
- 第二种事件：座位 $(x,y)$ 的状态发生了变化，如果原来有顾客坐在这里，这个顾客会立刻离开餐厅；如果原来这个座位上没有顾客，则会出现一个顾客坐在这里。

你需要对于第一种事件求出顾客选择的座位，对于第二种事件求出是有人离开还是有人坐下。

## 输入格式


第一行一个正整数 $q\ (1\le q\le5\times10^5)$。

接下来 $q$ 行，每行先是一个整数 $t\in\{1,2\}$，表示事件种类。

当 $t=1$ 时，接下来读入一个整数 $o\in\{0,1,2\}$，表示来了一位容忍度为 $o$ 的顾客。

当 $t=2$ 时，接下来读入两个正整数 $x,y\ (1\le x,y\le10^4)$，满足 $x\bmod3\in\{1,2\}$ 与 $y\bmod3\in\{1,2\}$，表示座位 $(x,y)$ 的状态发生了变化。

## 输出格式


对每个操作输出一行。

- 对于 $t=1$ 的操作，依次输出两个整数 $x,y$，表示顾客坐到了座位 $(x,y)$。
- 对于 $t=2$ 的操作，如果该座位上有人，输出 `out`，否则输出 `in`。

## 样例

### 样例输入 #1
```
10
1 0
1 0
2 1 1
2 2 2
1 0
1 1
1 2
1 2
1 2
1 1

```
### 样例输出 #1
```
1 1
1 4
out
in
4 1
1 1
1 2
2 1
1 5
1 7

```
## 提示

### 样例 #1 解释


以下图片展示了每一步操作影响的位置。数字标识了操作的编号。

![](https://cdn.luogu.com.cn/upload/image_hosting/6b57o2dl.png)



### 来源与致谢

来自 THUPC2025（2025 年清华大学学生程序设计竞赛暨高校邀请赛）决赛。感谢 THUSAA 的提供的题目。

数据、题面、标程、题解等请参阅 THUPC 官方仓库 <https://thusaac.com/public>。


---

---
title: "[THUPC 2025 决赛] 石墨烯"
layout: "post"
diff: 提高+/省选-
pid: P12056
tag: ['2025', 'THUPC']
---
# [THUPC 2025 决赛] 石墨烯
## 题目描述

Ecrade_ 看着食堂里来回游走等位的人们陷入了沉思，于是他想到了这样一个问题。

食堂中共有 $n$ 个区域，在食堂即将开门时，第 $i$ 个区域中有 $a_i$ 名正在等位的学生和 $b_i$ 个空位。保证 $\sum\limits_{i=1}^{n}a_i\le \sum\limits_{i=1}^{n}b_i$。

食堂开门后的每个时刻，都会**依次**发生如下两个事件：

1. 每个区域中当前正在等位的学生都会尽可能地坐到该区域的空位上。具体而言，假设第 $i$ 个区域中当前有 $x_i$ 名正在等位的学生和 $y_i$ 个空位。

     - 若 $x_i\le y_i$，那么所有正在等位的学生都会坐到空位上，此时第 $i$ 个区域中没有正在等位的学生，且会剩下 $y_i-x_i$ 个空位；
     - 若 $x_i>y_i$，那么会有恰好 $y_i$ 名正在等位的学生坐到所有空位上，此时第 $i$ 个区域中剩下 $x_i-y_i$ 名正在等位的学生，且没有剩余的空位。
2. 每个区域中当前正在等位的所有学生都会**同时**移动到下一个区域中。具体而言，第 $i$ 个区域中所有正在等位的学生都会移动到第 $(i\bmod n) +1$ 个区域中。


在这群学生中，有恰好 $k$ 名学生因为赶时间上课，在食堂开门的瞬间就打包离开了。而 Ecrade_ 并不清楚这 $k$ 名学生都在哪些区域，所以他想知道，在这 $k$ 名学生所有可能的分布情况中，在食堂开门后，最少经过多少个时刻，就能够使得每个区域中都没有正在等位的学生。

## 输入格式


第一行一个整数 $T\ (1\le T\le 5\times 10^5)$，表示测试数据组数。

对于每组测试数据：

- 第一行两个整数 $n,k\ (1\le n\le 5\times 10^5)$。
- 第二行 $n$ 个整数 $a_1,a_2,...,a_n\ (1\le a_i\le 10^9)$。
- 第三行 $n$ 个整数 $b_1,b_2,...,b_n\ (1\le b_i\le 10^9)$。

保证 $0\le k\le \sum\limits_{i=1}^n a_i\le \sum\limits_{i=1}^{n}b_i$，所有测试数据的 $n$ 的和不超过 $5\times 10^5$。

## 输出格式


对于每组测试数据，输出一行一个整数表示答案。

## 样例

### 样例输入 #1
```
4
3 0
1 1 4
5 1 4
4 0
1 2 3 4
4 3 2 1
3 6
1 1 4
5 1 4
4 1
1 2 3 4
4 3 2 1

```
### 样例输出 #1
```
1
4
0
2

```
## 提示

### 样例 #1 解释

为方便表述，下直接用数组 $a,b$ 表示每个时刻后每个区域中正在等位的学生数以及剩余空位数。

对于第一组测试数据，没有学生会离开食堂：

- 第一个时刻后，$a=[0,0,0],b=[4,0,0]$。

对于第二组测试数据，没有学生会离开食堂：

- 第一个时刻后，$a=[3,0,0,1],b=[3,1,0,0]$；
- 第二个时刻后，$a=[1,0,0,0],b=[0,1,0,0]$；
- 第三个时刻后，$a=[0,1,0,0],b=[0,1,0,0]$；
- 第四个时刻后，$a=[0,0,0,0],b=[0,0,0,0]$。

对于第三组测试数据，所有学生都会离开食堂。

对于第四组测试数据，仅有一名学生会离开食堂：

- 若这名学生在第 $1$ 个区域，则 $a$ 会变为 $[0,2,3,4]$：
  - 第一个时刻后，$a=[3,0,0,1],b=[4,1,0,0]$；
  - 第二个时刻后，$a=[1,0,0,0],b=[1,1,0,0]$；
  - 第三个时刻后，$a=[0,0,0,0],b=[0,1,0,0]$。
- 若这名学生在第 $2$ 个区域，则 $a$ 会变为 $[1,1,3,4]$：
  - 第一个时刻后，$a=[3,0,0,1],b=[3,2,0,0]$；
  - 第二个时刻后，$a=[1,0,0,0],b=[0,2,0,0]$；
  - 第三个时刻后，$a=[0,1,0,0],b=[0,2,0,0]$；
  - 第四个时刻后，$a=[0,0,0,0],b=[0,1,0,0]$。
- 若这名学生在第 $3$ 个区域，则 $a$ 会变为 $[1,2,2,4]$：
  - 第一个时刻后，$a=[3,0,0,0],b=[3,1,0,0]$；
  - 第二个时刻后，$a=[0,0,0,0],b=[0,1,0,0]$。
- 若这名学生在第 $4$ 个区域，则 $a$ 会变为 $[1,2,3,3]$：
  - 第一个时刻后，$a=[2,0,0,1],b=[3,1,0,0]$；
  - 第二个时刻后，$a=[1,0,0,0],b=[1,1,0,0]$；
  - 第三个时刻后，$a=[0,0,0,0],b=[0,1,0,0]$。
- 因此，当这名学生在第 $3$ 个区域时，最少经过 $2$ 个时刻，就能够使得每个区域中都没有正在等位的学生。


### 来源与致谢

来自 THUPC2025（2025 年清华大学学生程序设计竞赛暨高校邀请赛）决赛。感谢 THUSAA 的提供的题目。

数据、题面、标程、题解等请参阅 THUPC 官方仓库 <https://thusaac.com/public>。


---

---
title: "[THUPC 2025 决赛] 好串"
layout: "post"
diff: 提高+/省选-
pid: P12057
tag: ['2025', 'THUPC']
---
# [THUPC 2025 决赛] 好串
## 题目描述

对于三个长度为 $n$ 的 01 字符串 $s_1,s_2,s_3$，称长度为 $n$ 的 01 字符串 $t$ 是**好的**当且仅当 $\forall 1 \le i,j \le n, \exists k \in \{1,2,3\}, s_{k,i} = t_i, s_{k,j} = t_j$。设 $f(s_1,s_2,s_3)$ 为这样的好的串的数量。

现在我们有三个长度为 $n$ 的随机 01 字符串 $s_1,s_2,s_3$，其中 $s_i (1 \le i \le 3)$ 的第 $j (1 \le j \le n)$ 个字符有 $\frac{p_{i,j}}{9}$ 的概率为 `1`，$\left(1 - \frac{p_{i,j}}{9}\right)$ 的概率为 `0`，其中 $p_{i,j}$ 是一个 $0$ 至 $9$ 的整数。所有的随机事件是独立的。你需要求 $f(s_1,s_2,s_3)$ 的期望，对 $998244353$ 取模。
## 输入格式

输入第一行一个整数 $n\ (3 \le n \le 3 \times 10^5)$ 表示字符串长度，接下来一个 $3$ 行 $n$ 列的数字矩阵，其中第 $i$ 行第 $j$ 列的字符表示 $p_{i,j}$。
## 输出格式

输出一个整数表示答案对 $998244353$ 取模的值。


## 样例

### 样例输入 #1
```
3
900
090
009

```
### 样例输出 #1
```
4

```
### 样例输入 #2
```
3
999
999
999

```
### 样例输出 #2
```
1

```
### 样例输入 #3
```
10
0123456789
1234567890
2345678901

```
### 样例输出 #3
```
612360617

```
## 提示

### 样例 #1 解释

在该组样例中，$s_1, s_2, s_3$ 分别为 `100`, `010`, `001`，四种方案分别为 `100`、`010`、`001`、`000`。


### 来源与致谢

来自 THUPC2025（2025 年清华大学学生程序设计竞赛暨高校邀请赛）决赛。感谢 THUSAA 的提供的题目。

数据、题面、标程、题解等请参阅 THUPC 官方仓库 <https://thusaac.com/public>。


---

---
title: "[THUPC 2025 决赛] Now or Never"
layout: "post"
diff: 提高+/省选-
pid: P12060
tag: ['2025', 'THUPC']
---
# [THUPC 2025 决赛] Now or Never
## 题目描述


对于一个长度为 $l$ 的 01 串 $w=w_1w_2\dots w_l$，定义其**支撑序列** $\mathrm{supp}(w)$ 为 $[1, 2, \dots, l]$ 的一个子序列，其中 $i\in \mathrm{supp}(w)$ 当且仅当 $w_i = 1$。例如，$\mathrm{supp}(001100110) = [3, 4, 7, 8]$。特别地，全零串的支撑序列为空序列 $\varepsilon$。

给定一个 01 串集合 $S$，其中包含 $n$ 个长度为 $m$ 的 01 串 $s_1, s_2, \dots, s_n$。再给定 $q$ 组询问，第 $i$ 组询问给出一个长度为 $m$ 的 01 串 $t_i$。你需要输出一个长度为 $m$ 的 01 串 $u_i$ 满足以下条件：

1. 存在一个 $S$ 的子集 $T$，其中 $T$ 可以为空也可以为 $S$ 本身，满足 $u_i = t_i \oplus \bigoplus_{v \in T} v$，其中 $\oplus$ 表示按位异或操作，即 $u_i$ 为 $t_i$ 与 $T$ 中所有 01 串的异或和；
2. 在以上条件的基础之上，$u_i$ 的支撑序列的字典序尽可能小。

对于两个序列 $A, B$，称 $A$ 的字典序小于 $B$，当且仅当 $A$ 是 $B$ 的一个真前缀，或者 $A$ 和 $B$ 在第一个相异的位置 $p$ 上满足 $A_p < B_p$。
## 输入格式


输入的第一行三个正整数 $n, m, q\ (1\le n, m, q\le 2000)$，分别表示集合 $S$ 的大小、01 串的长度以及询问组数。

接下来 $n$ 行，第 $i$ 行一个长度为 $m$ 的 01 串 $s_i$。

最后 $q$ 行，第 $i$ 行一个长度为 $m$ 的 01 串 $t_i$ 描述一组询问。

## 输出格式


对于第 $i$ 组询问输出一行表示满足题设条件的长度为 $m$ 的 01 串 $u_i$。

## 样例

### 样例输入 #1
```
1 3 2
110
010
101

```
### 样例输出 #1
```
100
101

```
### 样例输入 #2
```
2 4 4
1100
1010
1000
0001
0110
0011

```
### 样例输出 #2
```
1000
1101
0000
1111

```
### 样例输入 #3
```
3 9 7
011001111
101110001
110010100
010110110
101010100
000101101
001011100
100011111
100111000
001000101

```
### 样例输出 #3
```
111101101
110110001
110111001
111100010
111111010
111110111
111111011

```
### 样例输入 #4
```
9 24 9
100001011101000000000000
100011001100100001000000
010101000010100111110100
101110000010101110110010
100110110010011100000000
111111000010100101111011
000010110001001011010101
010101100111000010100111
111001111111000000000000
111000110110110000000000
011100101000100001000000
101001101000111011001100
100011100011110001000000
100001001011000000000000
101110110001111100000000
100011100101100010110000
101001001100101011000000
100101100110100111000000

```
### 样例输出 #4
```
111111111100001001010011
111111101111001101010101
111111101100001011000101
111111101101110101111011
111111111111000010111011
111111111111110101011010
111111101110101001001101
111111101101111110011010
111111111110100001000000

```
## 提示

### 样例 #1 解释


对于第一组测试数据，满足第一个条件的串有 `010` 和 `100`。二者支撑序列分别为 $\mathrm{supp}(010) = [2]$，$\mathrm{supp}(100) = [1]$，其中字典序更小的是 $[1]$。

对于第二组测试数据，满足第一个条件的串有 `101` 和 `011`。二者支撑序列分别为 $\mathrm{supp}(101) = [1, 3]$，$\mathrm{supp}(011) = [2, 3]$，其中字典序更小的是 $[1, 3]$。

### 样例 #2 解释


对于第一组测试数据，满足第一个条件的串有 `1000`、`0100`、`0010` 和 `1110`，其中字典序最小的支撑序列是 $\mathrm{supp}(1000) = [1]$。

对于第二组测试数据，满足第一个条件的串有 `0001`、`1101`、`1011` 和 `0111`，其中字典序最小的支撑序列是 $\mathrm{supp}(1101) = [1, 2, 4]$。

对于第三组测试数据，满足第一个条件的串有 `0110`、`1010`、`1100` 和 `0000`，其中字典序最小的支撑序列是 $\mathrm{supp}(0000) = \varepsilon$，也即空序列。

对于第四组测试数据，满足第一个条件的串有`0011`、`1111`、`1001` 和 `0101`，其中字典序最小的支撑序列是 $\mathrm{supp}(1111) = [1, 2, 3, 4]$。

### 提示

题目名称是什么意思？


### 来源与致谢

来自 THUPC2025（2025 年清华大学学生程序设计竞赛暨高校邀请赛）决赛。感谢 THUSAA 的提供的题目。

数据、题面、标程、题解等请参阅 THUPC 官方仓库 <https://thusaac.com/public>。


---

---
title: "[THUPC 2019] 鸽鸽的分割"
layout: "post"
diff: 提高+/省选-
pid: P5377
tag: ['2019', '组合数学', '排列组合', 'THUPC']
---
# [THUPC 2019] 鸽鸽的分割
## 题目描述

牛牛有一块蛋糕，他想把蛋糕分给小朋友们。蛋糕一开始是圆形的，牛牛会在圆周上选择 $n$ 个不重合的点，将这几个点两两用线段连接。这些线段将会把蛋糕分成若干块。

现在，牛牛想知道，蛋糕**最多**会被分成多少块，请你告诉他答案。
## 输入格式

输入包含至多 $20$ 行，每行一个整数 $n$，含义见「题目描述」。保证 $0\le n \le 64$。
## 输出格式

依次回答牛牛的每个问题，对于每个问题，输出一行，包含一个整数表示答案。
## 样例

### 样例输入 #1
```
2
3
4
```
### 样例输出 #1
```
2
4
8
```
## 提示

### 样例解释

![](https://cdn.luogu.com.cn/upload/pic/58696.png)

##### 版权信息

来自 THUPC（THU Programming Contest，清华大学程序设计竞赛）2019。

题解等资源可在 <https://github.com/wangyurzee7/THUPC2019> 查看。


---

---
title: "[THUPC 2019] 鸭棋"
layout: "post"
diff: 提高+/省选-
pid: P5380
tag: ['模拟', '2019', 'THUPC']
---
# [THUPC 2019] 鸭棋
## 题目描述

#### 题目背景

鸭棋是一种风靡鸭子界的棋类游戏。事实上，它与中国象棋有一些相似之处，但规则不尽相同。在这里，我们将为你介绍鸭棋的规则。

**同时，我们下发了一个模拟鸭棋规则的玩具，你可以结合这个玩具理解题目**（也可以在 AK 后与你的队友进行对弈）。详情请见「玩具使用说明」。

鸭棋在一个 $10\times 9$（$10$ 行 $9$ 列）的网格棋盘上进行，网格上的每个格点都可以有棋子停留。对弈双方一方执红（`red`）棋、另一方执蓝（`blue`）棋，双方轮流执行操作，轮到一位玩家操作时，他必须选择一枚自己的棋子，并按照规则进行一步移动。

鸭棋发明者鸭子德规定一局鸭棋由红方执先手，并设计了初始棋盘布局如下：

![initial_board.png](https://cdn.luogu.com.cn/upload/pic/58700.png)

##### 棋子类型与走子规则

棋子分为 $7$ 类，下面介绍了它们的名字以及它们的移动规则。介绍移动规则时，我们默认棋子所处位置为 $\left( x,y\right)$（表示第 $x$ 行的第 $y$ 列，下同），并列出它可以到达的位置：

* **王**（`captain`)：可达的位置共 $4$ 个，包括 $\left(x\pm 1,y\right)$ 及 $\left(x,y\pm 1\right)$。
* **士**（`guard`）：可达的位置共 $4$ 个，包括 $\left(x\pm 1,y\pm 1\right)$ 及 $\left(x\pm 1,y\mp 1\right)$。
* **象**（`elephant`）：可达的位置至多 $4$ 个，对于任意 $s_x,s_y\in \left\{ 1,-1\right\}$，分别有：
    * 如果位置 $\left(x+s_x\times 1 ,y+ s_y\times 1\right)$ 上**无任意一方**的棋子停留，则 $\left( x+s_x \times 2,y+s_y \times 2\right)$ 为一个可达的位置。
* **马**（`horse`）：可达的位置至多 $8$ 个，对于任意 $s_x,s_y\in \left\{ 1,-1\right\}$，分别有：
    * 如果位置 $\left(x+s_x\times 1 ,y\right)$ 上**无任意一方**的棋子停留，则 $\left( x+s_x \times 2,y+s_y \times 1\right)$ 为一个可达的位置。
    * 如果位置 $\left(x ,y+ s_y \times 1 \right)$ 上**无任意一方**的棋子停留，则 $\left( x+s_x \times 1,y+s_y \times 2\right)$ 为一个可达的位置。
* **车**（`car`）：可在**不跨越其他棋子**的前提下，到达同行或同列的所有其他位置。
* **鸭**（`duck`）：可达的位置至多 $8$ 个，对于任意 $s_x,s_y\in \left\{ 1,-1\right\}$，分别有：
    * 如果位置 $\left(x+s_x\times 2 ,y+s_y \times 1\right),\left(x+s_x\times 1 ,y\right)$ 上均**无任意一方**的棋子停留，则 $\left( x+s_x \times 3,y+s_y \times 2\right)$ 为一个可达的位置。
    * 如果位置 $\left(x+s_x \times 1 ,y+ s_y \times 2 \right),\left(x ,y+ s_y \times 1 \right)$ 上均**无任意一方**的棋子停留，则 $\left( x+s_x \times 2,y+s_y \times 3\right)$ 为一个可达的位置。
* **兵**（`soldier`）：可达的位置共 $8$ 个，包括 $\left(x\pm 1,y\right)$ 及 $\left(x,y\pm 1\right)$ 及 $\left(x\pm 1,y\pm 1\right)$ 及 $\left(x\pm 1,y\mp 1\right)$。

**除上面描述的规则之外，棋子移动还有如下额外规则：**

* 不能将棋子移动到棋盘外的某个位置。
* 玩家不能将棋子移动到**已经停留了己方棋子**的位置。
* 如果玩家将棋子移动到了一个**已经停留了对方棋子**的位置，那么原本停留在该位置上的这个**对方棋子**将被移出游戏。

##### 胜利条件与将军局面

玩家在这个游戏中的目标是将对方的**王**移出游戏。一旦一方的**王**被移出游戏，则另一方立即宣告胜利。

对于一个棋盘的状态，如果存在一方有一步合法的操作能够将另一方的**王**移出游戏，则我们说当前局面是一个**将军**的局面。需要友情提示的是，根据定义，将军局面的形成包括（但不限于）如下这些可能：

1. 一方将一枚棋子移动到可以攻击对方**王**的位置

2. 在己方**王**受到威胁时不采取措施躲避

3. 主动将**王**移动至会受到攻击的位置

**除此之外，需要特别说明的是，游戏结束后，由于双方不可再操作，因此不可能出现将军局面，即便此时另一方王处于被「攻击」的位置。**

#### 题目描述

今年的 IDCC（International Duck Chess Competition，国际鸭棋大赛）正在如火如荼地进行着。你观摩了一场精彩绝伦的比赛，但你对对弈过程的记忆已经模糊不清了，只有系统留下的他们的**操作序列**，序列中的每个**操作**为当前操作者试图移动某个位置的棋子至另一个位置。你希望用这个序列，来复现出整局棋局的对弈过程。即，对于每步操作，你需要**首先判其是否合法**，若合法，则**进一步求出**：

1. 这步操作移动了哪个棋子。
2. 这步操作后，是否存在棋子被移出游戏，如有则还需求出被移出游戏的棋子。
3. 这步操作后，是否形成将军局面。
4. 这步操作后，游戏是否结束。

可能包含的不合法情况如下：

* 此步移动的初始位置无己方棋子停留。
* 此步移动的初始位置有己方棋子停留，但移动不符合规则。
* 游戏已经结束。

序列中的不合法操作是需要被忽略的。比如，如果轮到红方移动，此时序列中的当前操作恰好是不合法的，则这个操作将被忽略，序列中的下一步操作将成为红方这步的操作（如仍不合法则继续忽略，直至出现合法的操作）。
## 输入格式

第一行一个非负整数 $Q$，表示操作序列的长度。接下来依次描述每个操作。

接下来 $Q$ 行，每行 $4$ 个整数 $x_s, y_s, x_t, y_t$（$0\leq x_s,x_t < 10$，$0\leq y_s,y_t < 9$），描述一个欲将 $\left(x_s,y_s\right)$ 处棋子移动到 $\left(x_t,y_t\right)$ 的操作。在这里，我们规定左下角（即红方**车**摆放的位置，图见「题目背景」）为 $\left(0,0\right)$。

保证 $Q\leq 1000$。
## 输出格式

输出 $Q$ 行，对于每个操作依次输出复现结果。每行输出一个操作的结果：

* 如果该操作为不合法操作，则请输出 `Invalid command`。
* 如果为合法操作，则依次回答「题目描述」中的问题 $1\sim 4$：
    * 被移动的棋子用 `[颜色] [类型]`（注意中间包含空格）来描述，请使用它们的英文名称（见「题目背景」）。如，红象为 `red elephant`，蓝王为 `blue captain`。
    * 被移出游戏的棋子的描述方式与上面类似。特别地，**如果无棋子被移出游戏，则该问题的答案为 `NA`**。
    * 用 `yes`、`no` 分别表示形成、不形成将军局面。
    * 用 `yes`、`no` 分别表示游戏结束、游戏不结束。
    * 用 `;`（分号）将所有问题的答案隔开。
    * 比如，四个问题的答案分别为：被移动的棋子是蓝车，无棋子被移出游戏，形成将军局面，游戏未结束。则该行应输出 `blue car;NA;yes;no`。
## 样例

### 样例输入 #1
```
18
0 0 7 0
9 0 8 0
0 1 1 3
0 2 2 0
0 3 1 2
0 4 0 3
9 4 8 4
3 2 2 3
7 0 4 2
7 0 5 3
9 2 7 4
2 0 4 3
9 1 8 3
4 3 6 6
7 4 9 2
8 4 9 4
6 6 9 4
9 8 8 8
```
### 样例输出 #1
```
Invalid command
Invalid command
Invalid command
Invalid command
red guard;NA;no;no
Invalid command
blue captain;NA;no;no
red soldier;NA;no;no
Invalid command
Invalid command
blue elephant;NA;no;no
red duck;NA;no;no
blue horse;NA;no;no
red duck;blue soldier;no;no
Invalid command
blue captain;NA;yes;no
red duck;blue captain;no;yes
Invalid command
```
## 提示

##### 玩具使用说明

你可以在玩具所在目录下执行如下命令来运行玩具（链接: <https://pan.baidu.com/s/12MJGgZB9zKcE3qgRbRozGw> 提取码: 4d5c）：

```
./duckchess
```

特别地，在**初次运行前**，你需要执行如下命令为它添加运行权限：


```
chmod +x duckchess
```

##### 版权信息

来自 THUPC（THU Programming Contest，清华大学程序设计竞赛）2019。

题解等资源可在 <https://github.com/wangyurzee7/THUPC2019> 查看。


---

---
title: "[THUPC 2018] 绿绿和串串"
layout: "post"
diff: 提高+/省选-
pid: P5446
tag: ['2018', 'Manacher 算法', 'THUPC']
---
# [THUPC 2018] 绿绿和串串
## 题目背景

绿绿和 Yazid 是好朋友。他们在一起做串串游戏。
## 题目描述

绿绿有一个由小写字母组成的非空字符串 $R$，但 Yazid 不知道它具体是什么。

我们定义**翻转**的操作：把一个串以最后一个字符作对称轴进行翻转复制。形式化地描述就是，如果他翻转的串为 $R$，那么他会将前 $\left| R\right|-1$ 个字符倒序排列后，插入到串的最后。

举例而言，串`abcd`进行翻转操作后，将得到`abcdcba`；串`qw`连续进行 **$2$ 次**翻转操作后，将得到`qwqwq`；串`z`无论进行多少次翻转操作，都不会被改变。

贪玩的绿绿进行了若干次（可能为 $0$ 次）翻转操作。

淘气的绿绿又展示出了一个非空串 $S$，并表示 $S$ 是**最终**的串 $R$ 的前缀。现在，他想考考 Yazid，**初始**的串 $R$ 的长度可能是多少。

Yazid 找到了正在参加清华校赛的你，请你来帮他解决这个问题。但聪明的 Yazid 发现，所有超过 $\left| S\right|$ 的整数都一定是 $R$ 的可能长度，因此你只需要告诉他不超过的 $\left| S\right|$ 的 $R$ 的可能长度即可。

为了帮助你理解问题，Yazid 还将对一些概念和记号做出解释：

- 对于一个串 $S$，$\left| S\right|$ 表示的是该串的长度。
- 对于一个串 $S$，我们定义串 $T$ 是它的前缀，当且仅当 $\left| T\right|\leq\left| S\right|$，且对于任意整数 $i$ 满足 $1\leq i\leq\left| T\right|$，都有 $T$ 的左起第 $i$ 个字符与 $S$ 的左起第 $i$ 个字符相同。（形象地理解，即 $T$ 在 $S$ 的前部出现）
  - 如：`abc`是`abcdefg`的前缀，`aba`**不**为`abba`的前缀，`z`为`z`的前缀，空串为任意一个串的前缀。
## 输入格式

输入包含多组数据，第一行一个整数 $T$ 表示数据组数。接下来依次描述每组数据，对于每组数据：

* 一行一个仅由小写字母组成的非空字符串 $S$。

## 输出格式

对于每组数据，输出 $1$ 行：

* 从小到大输出 $\left| R\right|$ 的所有不超过 $\left| S\right|$ 的可能值，所有值之间用单个空格隔开。
## 样例

### 样例输入 #1
```
4
abcdcb
qwqwq
qaqaqqq
carnation
```
### 样例输出 #1
```
4 6
2 3 4 5
6 7
9
```
## 提示

### 数据范围

保证 $\left| S\right|\leq 10^6$，$\sum\left| S\right|\leq 5\times 10^6$。

$\sum\left| S\right|$ 表示的是单个测试点中所有数据 $\left| S\right|$ 的总和。

### 提示

* 读入规模较大，请注意读入效率。

* 样例中的最后一个字符串是什么意思呢？

### 版权信息

来自 2018 清华大学学生程序设计竞赛暨高校邀请赛（THUPC2018），感谢 [Pony.ai](http://pony.ai/) 对此次比赛的支持。

题解等资源可在 <https://github.com/wangyurzee7/THUPC2018> 查看。


---

---
title: "[THUPC 2018] 密码学第三次小作业"
layout: "post"
diff: 提高+/省选-
pid: P5451
tag: ['2018', 'THUPC']
---
# [THUPC 2018] 密码学第三次小作业
## 题目背景

1977年，罗纳德·李维斯特（Ron Rivest）、阿迪·萨莫尔（Adi Shamir）和伦纳德·阿德曼（Leonard Adleman）提出了RSA 加密算法。RSA 加密算法是一种非对称加密算法，其可靠性由极大整数因数分解的难度决定。换言之，对一极大整数做因数分解愈困难，RSA 算法愈可靠。假如有人找到一种快速因数分解的算法的话，那么用 RSA 加密的信息的可靠性就肯定会极度下降。

RSA 的基本原理如下：

- 公钥与私钥的产生
  1. 随机选择两个不同大质数 $p$ 和 $q$，计算 $N=p\times q$
  2. 根据欧拉函数性质，求得 $r=\varphi (N)=\varphi (p)\varphi (q)=(p-1)(q-1)$
  3. 选择一个小于 $r$ 的正整数 $e$，使 $e$ 和 $r$ 互质。并求得 $e$ 关于 $r$ 的乘法逆元 $d$，有 $ed\equiv 1 \pmod r$
  4. 将 $p$ 和 $q$ 的记录销毁。此时，$(N,e)$ 是公钥，$(N,d)$ 是私钥。
- 消息加密：首先需要将消息 $m$ 以一个双方约定好的格式转化为一个小于 $N$，且与 $N$ 互质的整数 $n$。如果消息太长，可以将消息分为几段，这也就是我们所说的块加密，后对于每一部分利用如下公式加密：

$$
n^{e}\equiv c\pmod N
$$

- 消息解密：利用密钥 $d$ 进行解密

$$
c^{d}\equiv n\pmod N
$$
## 题目描述

现在有两个用户由于巧合，拥有了相同的模数 $N$，但是私钥不同。设两个用户的公钥分别为 $e_1$ 和 $e_2$，**且两者互质**。明文消息为 $m$，密文分别为：

$$\begin{matrix}c_1=m^{e_1}\bmod N\\c_2=m^{e_2}\bmod N\end{matrix}$$

现在，一个攻击者截获了 $c_1$ ，$c_2$，$e_1$，$e_2$，$N$，请帮助他恢复出明文 $m$ 。
## 输入格式

输入包含多组数据，第一行一个整数 $T$ 表示数据组数，保证 $1\le T\le 10^4$ 。接下来依次描述每组数据，对于每组数据：

* 一行包含五个正整数 $c_1$，$c_2$，$e_1$，$e_2$，$N$，保证 $2^{8}< N < 2^{63}$，$N$ 有且仅有两个素因子，其余数据严格按照上述RSA算法生成。

## 输出格式

对于每组数据，输出 $1$ 行：

- 一个非负整数 $m$，请选手务必在输出时保证 $0\le m<N$。答案 $m$ 保证与 $N$ 互质。
## 样例

### 样例输入 #1
```
1
1502992813 2511821915 653507 57809 2638352023
```
### 样例输出 #1
```
19260817
```
## 提示

### 版权信息

来自 2018 清华大学学生程序设计竞赛暨高校邀请赛（THUPC2018），感谢 [Pony.ai](http://pony.ai/) 对此次比赛的支持。

题解等资源可在 <https://github.com/wangyurzee7/THUPC2018> 查看。


---

---
title: "[THUPC 2018] 城市地铁规划"
layout: "post"
diff: 提高+/省选-
pid: P5454
tag: ['2018', 'Special Judge', 'THUPC']
---
# [THUPC 2018] 城市地铁规划
## 题目描述

经过选拔，Kiana成为了可乐城的市长，为了兑现选举承诺，她决定在可乐城的 $n$ 个重要地标之间修建地铁。

可乐城的交通状况并不复杂，在任意两个地标之间修建一条地铁轨道都是可行的，但是地铁轨道并不是越多越好，如果有太多地铁从一个地标处经过，该地标的拥堵程度将大幅增加。为此，Kiana决定给每个地标一个便利度来衡量拥堵程度，如果有 $d$ 条地铁轨道经过了某个地标，那么该地标的便利度为 $f(d)\mod 59393$，其中 $f(x)=\sum_{i=0}^{k}a_ix^i$ 是Kiana指定的一个 $k$ 次多项式。

因为修建地铁有一定的成本，所以Kiana希望新建的地铁轨道尽可能少，但任意两座地标之间都需要能通过地铁相互到达。Kiana想知道在给定的条件下，什么样的修建方案可以使得地标的便利度之和最大。由于她不会做，所以希望你来告诉她答案。
## 输入格式

输入第一行包含两个正整数 $n$ 和 $k$，分别表示可乐城的地标总数和Kiana指定的多项式次数，地标的编号依次为 $1$ 至 $n$，数据保证 $n\leq 3000$且 $k\leq 10$。

输入第二行包含 $k+1$ 个非负整数 $a_0\sim a_k$，即Kiana指定的多项式的系数，数据保证所有的 $a_i\leq 50$。
## 输出格式

输出由若干行组成，第一行包含两个用空格隔开的正整数 $m$ 和 $S$，分别表示你的方案中修建的地铁轨道数量与最终的便利度之和。

接下来 $m$ 行，每行包含两个用空格隔开的正整数 $u$ 和 $v$，表示在第 $u$ 和第 $v$ 个地标之间修建了一条地铁轨道。

本题将采用Special Judge，如果有多种方案使得地标的便利度之和最大，输出其中任意一种即可。
## 样例

### 样例输入 #1
```
4 2
0 0 1
```
### 样例输出 #1
```
3 12
1 2
1 3
1 4
```
### 样例输入 #2
```
10 9
10 9 8 7 6 5 4 3 2 1
```
### 样例输出 #2
```
9 177454
4 5
4 6
3 4
3 7
2 3
2 8
1 2
1 9
1 10
```
## 提示

### 备注

本题因为一些原因只保留了后 $50$ 组数据。

### 版权信息

来自 2018 清华大学学生程序设计竞赛暨高校邀请赛（THUPC2018），感谢 [Pony.ai](http://pony.ai/) 对此次比赛的支持。

题解等资源可在 <https://github.com/wangyurzee7/THUPC2018> 查看。


---

---
title: "[THUPC 2018] 生生不息"
layout: "post"
diff: 提高+/省选-
pid: P5457
tag: ['2018', 'THUPC']
---
# [THUPC 2018] 生生不息
## 题目描述

生命游戏是一个经典的零玩家游戏。

游戏在一块 $n \times m$ 的方格棋盘上进行，初始时，棋盘上的一些格子中有生命，另一些格子中没有生命。

在新的一天开始时，如果一个格子周围的 $8$ 个（边界上的格子也许不到 $8$ 个）格子中，在前一天有恰好$2$个或$3$个格子中有生命，则这个格子上的生命可以继续生存，如果周围的格子中恰好有$3$个格子在前一天有生命且这个格子中前一天没有生命，则会在这个格子中诞生新的生命。在其他情况下，该格子中原有的生命则会死去且不会产生新的生命。

如果在某一天，棋盘上所有的格子里都没有生命，显然，在接下来的时间里，所有的格子中再也不会有生命了，我们就说这些生命灭绝了。

现在，牛牛希望让菲菲来决定游戏开始时棋盘上的每个格子中是否有生命。

而他想知道，在游戏开始时，菲菲有多少种不同的方法使得棋盘上的生命永远也不会灭绝。
## 输入格式

输入包含多组数据，第一行一个整数 $T$ 表示数据组数。（$T <= 30$）

接下来依次描述每组数据，对于每组数据：

* 一行 $2$ 个正整数 $n$、$m$。（$n,m<=5$）
## 输出格式

对于每组数据，输出 $1$ 行：

* 一行输出 $1$ 个整数，表示问题的答案。
## 样例

### 样例输入 #1
```
2
2 2
3 3
```
### 样例输出 #1
```
5
150
```
## 提示

来自 2018 清华大学学生程序设计竞赛暨高校邀请赛（THUPC2018），感谢 [Pony.ai](http://pony.ai) 对此次比赛的支持。

题解等资源可在 <https://github.com/wangyurzee7/THUPC2018> 查看。


---

---
title: "[THUPC 2021 初赛] 切切糕"
layout: "post"
diff: 提高+/省选-
pid: P7137
tag: ['2021', 'Special Judge', 'THUPC']
---
# [THUPC 2021 初赛] 切切糕
## 题目描述

Kiana 喜欢吃甜点，某天她从商店中买回来 $N$ 块切糕与 Tinytree 共同分享，其中第 $i$ 块切糕的大小用一个数 $A_i$ 来表示。

因为每块切糕的风味都不同，所以 Kiana 和 Tinytree 决定将每块切糕都切成两份，两人各选一份品尝。但切切糕是一个自古以来的大难题，经过商议，Kiana 打算执刀来切切糕，而 Tinytree 有 $M$ 次“优先选糕权”，可以获得一些切糕切开后的优先选择权，具体来说，两人按照如下流程进行操作：

步骤一：Kiana 从还没切的切糕中按自己的想法选一块出来，并将其切成两份，其中**每份切糕的大小可以是任意正实数，也可以是 $\mathbf{0}$，且两份切糕的大小之和与切之前的大小相同**。

步骤二：Tinytree 观察完 Kiana 切出的两份切糕大小后，如果还有“优先选糕权”次数剩余，则可以决定是否消耗 $1$ 次“优先选糕权”来进行优先选择。

步骤三：如果 Tinytree 选择使用“优先选糕权”，则她可以从两份切糕中任选一份，另一份则归 Kiana，如果 Tinytree 选择不使用或者已经用完了 $M$ 次“优先选糕权”，则 Kiana 从两份切糕中任选一份，另一份则归 Tinytree，然后两人回到步骤一，直到所有的切糕都切完。

假设 Kiana 和 Tinytree 都足够聪明，在自己可以操作时总是想办法**让自己最终获得的切糕总大小尽可能大**，且开始切第一块切糕之前 $N$ 块切糕的大小是两人都已知的，“优先选糕权”不要求全部用完。现在 Kiana 想知道，自己能获得的切糕总大小是多少，由于 Kiana 自己不会算，所以希望你能够帮助她。
## 输入格式

第一行包含两个正整数 $N$ 和 $M$（$1 \le M \le N \le 2500$），分别表示切糕的总数和 Tinytree 初始时“优先选糕权”的次数。  
第二行包含 $N$ 个正整数，其中第 $i$ 个数 $A_i$（$1 \le A_i \le 50000$）表示第 $i$ 块切糕的大小。
## 输出格式

输出共一行，包含一个实数，表示**Kiana 最终能获得的切糕总大小**，所有输出精确到小数点后六位。
## 样例

### 样例输入 #1
```
4 3
4 3 2 1

```
### 样例输出 #1
```
5.250000

```
## 提示

**【样例解释 #1】**

在这个样例中总共有 $4$ 块切糕，大小分别为 $4,3,2,1$，Tinytree 的“优先选糕权”一共有三次，两人可以按照如下顺序和方式来分配切糕：

第一块：Kiana 选择大小为 $3$ 的切糕，将其切成大小为 $1.25$ 和 $1.75$ 的两部分，Tinytree 使用一次“优先选糕权”选走 $1.75$ 的部分，Kiana 目前总共获得大小 $1.25$ 的切糕。

第二块：Kiana 选择大小为 $1$ 的切糕，将其切成大小为 $0$ 和 $1$ 的两部分，Tinytree 不使用“优先选糕权”，Kiana 独得此糕，目前总共获得大小 $2.25$ 的切糕。

第三块：Kiana 选择大小为 $2$ 的切糕，将其切成大小为 $1$ 和 $1$ 的两部分，Tinytree 使用一次“优先选糕权”选走 $1$ 的部分，Kiana 目前总共获得大小 $3.25$ 的切糕。

第四块：Kiana 选择大小为 $4$ 的切糕，将其切成大小为 $2$ 和 $2$ 的两部分，Tinytree 使用一次“优先选糕权”选走 $2$ 的部分，Kiana 目前总共获得大小 $5.25$ 的切糕。

综上所述，该样例输出 $5.250000$，且可以证明在这个方案中如果任意一人改变自己的策略，其获得的切糕总大小不可能变得更大。

**【题目来源】**

来自 2021 清华大学学生程序设计竞赛暨高校邀请赛（THUPC2021）初赛。

题解等资源可在 <https://github.com/THUSAAC/THUPC2021-pre> 查看。


---

---
title: "[THUPC 2021 初赛] 区间矩阵乘法"
layout: "post"
diff: 提高+/省选-
pid: P7140
tag: ['2021', 'THUPC']
---
# [THUPC 2021 初赛] 区间矩阵乘法
## 题目描述

给定长度为 $n$ 的序列 $a_1, a_2, \dots, a_n$；共 $m$ 组询问，每次询问给出 $d,p_1,p_2$，求

$$ \sum_{i=0}^{d-1} \sum_{j=0}^{d-1} \sum_{k=0}^{d-1} a_{p_1+d\cdot i+j} a_{p_2 + d\cdot j + k} $$
## 输入格式

输入的第一行包含一个数 $n$。  
之后一行 $n$ 个数，表示 $a$ 这个序列。  
之后一行一个数 $m$。  
之后 $m$ 行，每行三个数 $d, p_1, p_2$ 表示一次询问。

$1 \le n, m, a_i \le 2 \times {10}^5$，所有数值为 $[1,{10}^9]$ 以内的整数，询问保证 $a$ 的下标在 $[1,n]$ 内。
## 输出格式

输出共 $m$ 行，表示每个询问对应的答案，答案对 $2^{32}$ 取模。
## 样例

### 样例输入 #1
```
5
2 2 1 2 1
4
1 5 4
2 2 1
2 1 1
1 5 5

```
### 样例输出 #1
```
2
22
24
1

```
## 提示

**【题目来源】**

来自 2021 清华大学学生程序设计竞赛暨高校邀请赛（THUPC2021）初赛。

题解等资源可在 <https://github.com/THUSAAC/THUPC2021-pre> 查看。


---

---
title: "[THUPC 2021 初赛] 密集子图"
layout: "post"
diff: 提高+/省选-
pid: P7142
tag: ['2021', 'THUPC']
---
# [THUPC 2021 初赛] 密集子图
## 题目描述

有一天，魔法师小 L 看到了一个有向完全图。

图中所有边的长度都是 $1$，且所有边都是白色的。

现在小 L 要对这个图施展魔法，图中每条有向边分别都有一定概率变成黑色。

小 L 认为一个图是“密集的”，当且仅当只经过黑色边时，点 $1$ 到其余所有点的最短路径长度都不超过 $k$（特别地，若两个点不连通则它们之间最短路径的长度视为 $+ \infty$）。

小 L 想要知道，此时这个有向完全图有多大的概率是“密集的”呢？请你输出此概率对 $998,244,353$ 取模的结果。
## 输入格式

第一行两个正整数 $n$（$2 \le n \le 12)$，$k$（$1 \le k \le n - 1$）。  
接下来 $n \times (n - 1)$ 行，每行 $4$ 个正整数 $x, y, p, q$，表示点 $x$ 到点 $y$ 的有向边变成黑色的概率为 $\frac{p}{q}$。保证 $1 \le x \le n$，$1 \le y \le n$，$x \ne y$，$0 \le p \le q < 998,244,353$，$q > 0$，每组合法的 $(x, y)$ 恰好出现一次。
## 输出格式

一行一个整数表示答案。
## 样例

### 样例输入 #1
```
3 1
1 2 1 2
2 1 1 2
1 3 1 3
3 1 2 3
2 3 3 4
3 2 2 5

```
### 样例输出 #1
```
166374059

```
## 提示

**【样例解释 #1】**

这个有向完全图是“密集的”，当且仅当点 $1$ 到点 $2$ 的有向边和点 $1$ 到点 $3$ 的有向边同时变成黑色，这种情况出现的概率 $= \frac{1}{2} \times \frac{1}{3} = \frac{1}{6}$，$\frac{1}{6} \bmod 998,244,353 = 6^{998,244,351} \bmod 998,244,353 = 166,374,059$。

**【题目来源】**

来自 2021 清华大学学生程序设计竞赛暨高校邀请赛（THUPC2021）初赛。

题解等资源可在 <https://github.com/THUSAAC/THUPC2021-pre> 查看。


---

---
title: "[THUPC 2021 初赛] 线段树"
layout: "post"
diff: 提高+/省选-
pid: P7143
tag: ['2021', 'THUPC']
---
# [THUPC 2021 初赛] 线段树
## 题目描述

线段树是小 L 最喜欢的数据结构，它能高效地解决许多实际问题。

给定一个正整数 $n$，小 L 构建出一棵下标属于整数区间 $[1, n]$ 的线段树：

- 初始线段树只有一个结点 $[1, n]$。
- 对于结点 $[L, R]$，若 $L < R$，则令 $mid = \left[ \frac{L + R}{2} \right]$（$[x]$ 表示不超过 $x$ 的最大整数），小 L 对这个结点建出两个子结点 $[L, mid]$、$[mid + 1, R]$。

小 L 定义了一个函数 $cover(a, b)$（$1 \le a \le b \le n$），表示用若干个线段树结点不重不漏地覆盖区间 $[a, b]$，则使用的线段树结点个数的最小值。

小 L 尝试使用这棵线段树解决某个复杂问题，并想要粗略地评估这棵线段树的性能。

具体来说，区间 $[1, n]$ 有 $\frac{n (n + 1)}{2}$ 个不同的子区间，如果小 L 从这 $\frac{n (n + 1)}{2}$ 个子区间中等概率随机地选取一个，将其记为 $[A, B]$，则小 L 认为 $cover(A, B)$ 的期望值可用于评估此线段树的性能。

小 L 想请你帮他计算出 $cover(A, B)$ 的期望值与 $\frac{n (n + 1)}{2}$ 的乘积对 $1, 000, 000, 007$ 取模的结果，可以发现此结果一定是一个整数。
## 输入格式

第一行一个正整数 $T$（$1 \le T \le 1000$）表示数据组数。  
接下来 $T$ 行，其中第 $i$（$1 \le i \le T$）行一个正整数 $n$（$1 \le n \le {10}^{18}$）表示第 $i$ 组数据。
## 输出格式

$T$ 行，第 $i$（$1 \le i \le T$）行一个整数表示第 i 组数据的答案。
## 样例

### 样例输入 #1
```
1
3

```
### 样例输出 #1
```
7

```
## 提示

**【样例解释 #1】**

$cover(1, 1) = 1$，$cover(2, 2) = 1$，$cover(3, 3) = 1$，$cover(1, 2) = 1$，$cover(2, 3) = 2$，$cover(1, 3) = 1$，故 $cover(A, B)$ 的期望 $= \frac{1 + 1 + 1 + 1 + 2 + 1}{6} = \frac{7}{6}$。

**【题目来源】**

来自 2021 清华大学学生程序设计竞赛暨高校邀请赛（THUPC2021）初赛。

题解等资源可在 <https://github.com/THUSAAC/THUPC2021-pre> 查看。


---

---
title: "[THUPC 2021 初赛] 合法序列"
layout: "post"
diff: 提高+/省选-
pid: P7145
tag: ['动态规划 DP', '2021', 'THUPC']
---
# [THUPC 2021 初赛] 合法序列
## 题目描述

对于一个长度为 $n$ 的 $\text{0-1}$ 序列 $s$，我们将它的位从左到右、从零开始编号，记为 $s_0, s_1, \ldots , s_{n-1}$。

给定一个正整数 $k$，从 $s$ 中取出某个长度为 $k$ 的子段。将这个子段解释为一个左侧为高位、右侧为低位的 $k$ 位二进制数，记为 $t$，则有 $0 \le t < 2^k$。

$s$ 有 $n - k + 1$ 个长度为 $k$ 的子段，如果对于其中的每一个子段，如上解释为二进制数 $t$ 后，$s$ 的编号为 $t$ 的位（即 $s_t$）都是 $1$，则说 $s$ 是合法的。保证 $2^k \le n$，即 $t$ 作为 $s$ 的下标不会越界。

给定 $n, k$，求合法的 $s$ 的数量。由于方案数可能较大，只需给出方案数模 $998, 244, 353$ 的结果作为答案。
## 输入格式

输入有一行，包含两个用空格隔开的正整数 $n, k$。

保证 $1 \le k \le 4$，$2^k \le n \le 500$。
## 输出格式

输出一行，包含一个非负整数，即合法方案数模 $998, 244, 353$ 的结果。
## 样例

### 样例输入 #1
```
4 2

```
### 样例输出 #1
```
2

```
## 提示

**【样例解释 #1】**

有两个满足要求的序列：$0, 1, 1, 1$ 和 $1, 1, 1, 1$。

**【题目来源】**

来自 2021 清华大学学生程序设计竞赛暨高校邀请赛（THUPC2021）初赛。

题解等资源可在 <https://github.com/THUSAAC/THUPC2021-pre> 查看。


---

---
title: "[THUPC 2017] 体育成绩统计"
layout: "post"
diff: 提高+/省选-
pid: P7426
tag: ['模拟', '2017', 'THUPC']
---
# [THUPC 2017] 体育成绩统计
## 题目背景

正所谓「无体育，不清华」。为了更好地督促同学们进行体育锻炼，更加科学地对同学们进行评价，五道口体校的老师们在体育成绩的考核上可谓是煞费苦心。然而每到学期期末时，面对海量的原始数据，如何对数据进行处理，得到同学们的体育总评成绩却又成了体育部老师的一大难题。
## 题目描述

对于大一的同学们来说，体育课的总评成绩由五部分组成：体育课专项成绩（满分 $50$ 分）、长跑测试成绩（满分 $20$ 分）、「阳光长跑」成绩（满分 $10$ 分）、体质测试成绩（满分 $10$ 分）、「大一专项计划」成绩（满分 $10$ 分）。

体育课专项成绩将由任课体育老师直接给出。

长跑测试成绩将由期末长跑测试确定，其中男生需进行 $3000$ 米测试，女生需进行 $1500$ 米测试，具体评分标准为：
|  | $20$ | $18$ | $16$ | $14$ | $12$ | $10$ | $8$ | $6$ | $4$ | $2$ |
| :----------: | :----------: | :----------: | :----------: | :----------: | :----------: | :----------: | :----------: | :----------: | :----------: | :----------: |
| 男生 | $12'30''$ | $13'00''$ | $13'30''$ | $14'00''$ | $14'30''$ | $15'10''$ | $15'50''$ | $16'30''$ | $17'10''$ | $18'00''$ |
| 女生 | $6'40''$ | $6'57''$ | $7'14''$ | $7'31''$ | $7'50''$ | $8'05''$ | $8'20''$ | $8'35''$ | $8'50''$ | $9'00''$ |

「阳光长跑」是通过手机 App 来记录同学们的课外长跑情况，根据对原始跑步数据进行筛选，得到课外长跑的合法次数，来最终确定此部分的成绩。

一条合法的锻炼记录需同时满足：

男生长跑距离 $3000$ 米以上（包含 $3000$ 米），女生长跑距离 $1500$ 米以上（包含 $1500$ 米）；

平均速度（运动距离/(结束时间-开始时间)）不慢于 $2$ 米／秒，且不快于 $5$ 米／秒；

总暂停时间不得超过 $4$ 分 $30$ 秒；

平均步幅（距离／步数）不超过 $1.5$ 米；

开始时间需与上条合法记录的结束时间间隔 $6$ 小时以上（包含 $6$ 小时）；

「阳光长跑」的合法次数与该部分得分的对应如下：
| 分数 | $10$ | $9$ | $8$ | $7$ | $6$ | $4$ | $2$ |
| :----------: | :----------: | :----------: | :----------: | :----------: | :----------: | :----------: | :----------: |
| 次数 | $[21,+∞)$ | $[19,20]$ | $[17,18]$ | $[14,16]$ | $[11,13]$ | $[7,10]$ | $[3,6]$ |

对于体质测试部分，若达到合格标准则得到该部分满分 $10$ 分，否则该部分不得分。

「大一专项计划」的 $10$ 分由两部分组成：出勤次数占 $5$ 分，期末检测占 $5$ 分。

其中出勤次数为「班级训练营」的参加次数和「阳光长跑」的合法次数之和，出勤得分与出勤次数的对应如下：
| 分数 | $5$ | $4$ | $3$ | $2$ | $1$ |
| :----------: | :----------: | :----------: | :----------: | :----------: | :----------: |
| 次数 | $[18,+∞)$ | $[15,17]$ | $[12,14]$ | $[9,11]$ | $[6,8]$ |

不难看出，要想准确无误地计算出每个人的体育成绩并不是一件轻松的事，于是体育部的老师找到了正在打校赛的你，他将提供所有需要用到的数据，希望你帮他算算清华大一同学的体育总评成绩及等级。

百分制成绩与等级、绩点对应如下：
| A | A- | B+ | B | B- | C+ | C | C- |D+  | D | F |
| :----------: | :----------: | :----------: | :----------: | :----------: | :----------: | :----------: | :----------: | :----------: | :----------: | :----------: |
| $[95,100]$ | $[90,95)$ | $[85,90)$ | $[80,85)$ | $[77,80)$ | $[73,77)$ | $[70,73)$ | $[67,70)$ | $[63,67)$ | $[60,63)$ | $[0,60)$ |

## 输入格式

从标准输入读入数据。

输入第一行，包含一个正整数 $n$，表示大一年级的学生人数。

接下来 $n$ 行，每行表示一位学生（按学号字典序给出），各项数据之间用空格隔开，一位学生的数据包括：

- 一个长度为 $10$ 的正整数 $p$（数据保证不包含前导零），表示第 $i$ 位同学的学号；
- 一个字符，M 或 F，若为 M 表示第 $i$ 位同学为男生，若为 F 则表示第 $i$ 位同学为女生；
- 一个介于 $0$ 到 $50$ 之间的非负整数 $s$，表示第 $i$ 位同学的体育课专项成绩；
- 一个形如 `a'b"` 的字符串，表示第 $i$ 位同学的期末长跑测试成绩为 $a$ 分 $b$ 秒；
- 一个字符，P 或 F，若为 P 表示第 $i$ 位同学的体质测试通过，若为 F 则表示第 $i$ 位同学的体质测试没有通过；
- 一个介于 $0$ 到 $5$ 之间的非负整数 $f$，表示第 $i$ 位同学的「大一专项计划」的期末检测成绩；
- 一个非负整数 $c$，表示第 $i$ 位同学参加「班级训练营」的次数。

接下来一行，包括一个非负整数 $m$，表示需要筛选的「阳光长跑」数据条数。

接下来 $m$ 行，每行表示一条需要筛选的「阳光长跑」数据（按开始时间顺序给出），各项之间用空格隔开，一条数据包括：

- 一个形如 `2017MMDD` 的字符串，表示第 $j$ 条记录的完成日期；
- 一个长度为 $10$ 的正整数 $p$（数据保证不包含前导零），表示第 $j$ 条记录的来源学号；
- 两个形如 `hh:mm:ss` 的字符串，分别表示第 $j$ 条记录的开始时间和结束时间；
- 一个精确到小数点后两位的非负浮点数 $l$，表示第 $j$ 条记录的运动距离，单位为千米；
- 一个形如 `a'b"` 的字符串，表示第 $j$ 条记录的总暂停时间为 $a$ 分 $b$ 秒；
- 一个非负整数 $s$，表示第 $j$ 条记录的运动总步数。

输入格式可参见下发样例文件。
## 输出格式

输出到标准输出。

输出文件共包括 $n$ 行。请你按照学号**字典序**输出每一位同学的学号、百分制总评成绩以及等级。每位同学一行，一行内用空格隔开。
## 样例

### 样例输入 #1
```
1
2015011233 M 34 14'30" P 3 3
8
20170508 2015011233 17:02:33 17:19:33 2.99 0'0" 3333
20170509 2015011233 17:12:15 17:38:46 3.01 2'3" 4300
20170510 2015011233 22:03:06 22:13:08 3.05 0'0" 2772
20170511 2015011233 22:08:05 22:28:13 3.02 5'3" 3775
20170512 2015011233 18:03:12 18:17:56 3.02 0'0" 2001
20170513 2015011233 17:30:23 17:46:08 3.01 0'0" 3020
20170513 2015011233 22:03:34 22:20:08 3.04 2'0" 3058
20170514 2015011233 07:16:22 07:32:34 3.00 0'0" 3244
```
### 样例输出 #1
```
2015011233 59 F
```
## 提示

对于 $100\%$ 的数据，$n\le 10^4,0\le a,b\le 59,0\le c\le 100,m\le 1.5\times 10^5,0\le l\le 100,0\le s\le 10^6$。
#### 版权信息
来自 THUPC（THU Programming Contest，清华大学程序设计竞赛）2017。


---

---
title: "[THUPC 2021] 视频倍增期"
layout: "post"
diff: 提高+/省选-
pid: P7602
tag: ['2021', 'O2优化', 'THUPC']
---
# [THUPC 2021] 视频倍增期
## 题目描述

为了更好地衡量视频质量，快手的产品经理提出了视频的“倍增期”的概念。倍增期是一个以秒为单位的时间量指标，其含义是视频的累计播放量从只有目前的一半到当前总播放量所耗费的时长。低质量的视频往往高开低走，刚发布时人们出于好奇或者是被标题吸引而点击，一段时间之后口碑断崖式滑坡，所以倍增期很长；高质量的视频则往往低开高走，人们看过之后自发传播和推荐，逐渐积攒起口碑和流量，所以倍增期较短。

小张是快手的一位视频后台管理员，有 $n$ 个视频是由小张负责监控的，从 $1$ 到 $n$ 依次编号。小张的一周有 $m$ 秒钟的工作时间，在每秒钟都会有一个需要处理的请求从前台传来，请求分成两种：

- 更新请求：在这一秒钟内，编号在区间 $[l, r]$ 内的视频均获得了 $x$ 次的播放量，需要更新后台的数据；
- 查询请求：前台希望知道编号为 $i$ 的视频的倍增期。设该视频本周当前的累计播放量为 $x$，该查询请求是第 $j$ 秒传来的，该视频本周的累计播放量恰好达到 $\lceil x / 2 \rceil$ 时是在第 $j'$ 秒（$j' \ge 0$），则倍增期被定义为 $j - j'$。

面对如此高频度的信息更新和查询需求，小张感到有些棘手，他希望能得到你的帮助。
## 输入格式

输入的第一行包含两个正整数 $n$ 和 $m$，保证 $1 \le n, m \le {10}^5$。

接下来 $m$ 行，第 $j$ 行表示第 $j$ 秒的请求（$1 \le j \le m$），其格式为以下两种之一：

 - $0 \ l \ r \ x$：表示这是一个更新请求，在第 $j$ 秒，编号在区间 $[l, r]$（$1 \le l \le r \le n$）内的视频获得了 $x$ 次播放量，保证 $1 \le x \le {10}^8$；
 - $1 \ i$：表示这是一个查询请求，查询编号为 $i$（$1 \le i \le n$）的视频在第 $j$ 秒的倍增期。
## 输出格式

对于每一个查询请求，依次输出一行，表示所查询的倍增期。
## 样例

### 样例输入 #1
```
5 5
0 2 3 3
1 4
0 2 4 3
1 4
1 3

```
### 样例输出 #1
```
2
1
4

```
## 提示

**【样例解释】**

- 第 $2$ 秒时，$4$ 号视频的累计播放量为 $0$，在第 $0$ 秒时达到了 $\lceil 0 / 2 \rceil = 0$ 秒的累计播放量，所以此时 $4$ 号视频的倍增期为 $2$ 秒。
 - 第 $4$ 秒时，$4$ 号视频的累计播放量为 $3$，在第 $3$ 秒时达到了 $\lceil 3 / 2 \rceil = 2$ 秒的累计播放量，所以此时 $4$ 号视频的倍增期为 $1$ 秒。
 - 第 $5$ 秒时，$3$ 号视频的累计播放量为 $6$，在第 $1$ 秒时达到了 $\lceil 6 / 2 \rceil = 3$ 秒的累计播放量，所以此时 $3$ 号视频的倍增期为 $4$ 秒。
 

**【题目来源】**

来自 2021 清华大学学生程序设计竞赛暨高校邀请赛（THUPC2021）。

题解等资源可在 [https://github.com/yylidiw/thupc_0/tree/master](https://github.com/yylidiw/thupc_0/tree/master) 查看。


---

---
title: "[THUPC 2021] 挑战图灵奖"
layout: "post"
diff: 提高+/省选-
pid: P7608
tag: ['2021', 'O2优化', 'THUPC']
---
# [THUPC 2021] 挑战图灵奖
## 题目背景

图染色问题是这样的——给定一个 $n$ 个点，$m$ 条边的图，要求将每个点染上一种颜色，满足任意有边相连的两个点颜色不同，问最少需要多少种颜色。众所周知，图染色是 NPC 问题之一，如果有人能在多项式时间内解决图染色问题，那就相当于证明了 P = NP，恭喜你，下一位图灵奖得主非你莫属！
## 题目描述

今天，你的好朋友——敏珂找到了你，宣称他证明了半个图染色问题，希望你帮他看看他的做法对不对，如果你能帮他验证，他会考虑与你分享图灵奖的奖金。敏珂宣称自己解决的问题是这样的：对于一个 $n$ 个点的无向图，图上所有节点编号为  $1,2,\ldots, n$，两点之间有连边，当且仅当两点编号在模 $n$ 意义下相差不超过 $k$，即 $(x,y)$ 之间有一条无向边，当且仅当 $x \neq y$ 且存在 $i$ 满足 $1 \le i \le k$，

$$(x+i) \equiv y \pmod n$$ 

或 

$$(y+i) \equiv x \pmod n $$

，他能够快速求出这个图的染色数。作为评审，你只需要解决一个判定性问题——对于每组数据，敏珂会给出三个正整数 $n$，$k$ 和 $x$，表示在给定 $n$ 和 $k$ 时（$n, k$ 的意义如上文所述），他认为这个图的**染色数**是 $x$，你需要判断他的答案是否正确。

如果你认为他的答案是**正确**的，输出一行 `Correct, but it doesn't necessarily mean that you can win the Turing Award.`；如果你认为他的答案是**错误**的，在第一行输出 `Wrong, don't cheat me, you are too far away from the Turing Award.`。为了让你的答案更有信服力，你还需要在第二行输出一个字符 `0` 或 `1`，`0` 表示你认为敏珂的答案小于这个图的实际染色数，`1` 表示你认为他的答案大于这个图的实际染色数；如果你认为这个问题**以当下计算机算力无法作出准确判断**，输出一行 `The problem is unsolvable, please stop cheating me, Mr.Minke.`。
## 输入格式

输入只有一行，包含三个正整数，分别表示 $n, k, x$,  意义如题面所述。

其中 $1\le x, n \le 10^{1,000,000}$，$1 \le k \le 100$，所有输入均为正整数，且对于所有数据，$n$ 只可能满足 $n \le 10^5$ 或 $n \ge 10^{100}$。
## 输出格式

输出共 $1$ 或 $2$ 行，第一行表示你的判断结果，格式如题面所述；

如果你顺利完成判断并认为敏珂的答案是错误的，则需要在第二行输出一个字符 `0` 或 `1`，`0` 表示敏珂的答案小了，`1` 表示敏珂的答案大了。
## 样例

### 样例输入 #1
```
6 2 4

```
### 样例输出 #1
```
Wrong, don't cheat me, you are too far away from the Turing Award.
1

```
## 提示

**【样例解释】**

很显然，给 $1 \sim 6$ 号点分别染色为 $1, 2, 3, 1, 2, 3$ 是可行的，所以 $n = 6$，$k = 2$ 情况下对应的染色数为 $3$。

**【提示】**

1. 如果没有 idea，请再次阅读题面给的数据范围，也许能对解题有一些帮助。

2. Hint 1 可能没有用。

**【题目来源】**

来自 2021 清华大学学生程序设计竞赛暨高校邀请赛（THUPC2021）。

题解等资源可在 [https://github.com/yylidiw/thupc_1/tree/master](https://github.com/yylidiw/thupc_1/tree/master) 查看。


---

---
title: "[THUPC 2021] 幸运位置"
layout: "post"
diff: 提高+/省选-
pid: P7611
tag: ['2021', 'Special Judge', 'O2优化', 'THUPC']
---
# [THUPC 2021] 幸运位置
## 题目描述

小 Z 是一个活泼好动的孩子。有一天，她站在数轴上 $b$ 的位置，并准备开始沿着数轴的正半轴移动。小 Z 每移动一步，就会立刻沿着数轴的正半轴前进 $a$ 个单位。奇妙的是，$a,b$ 都是正整数，所以小 Z 任意时刻所处的位置也都是正整数。

小 Z 的幸运数字是一个正整数 $c$。小 Z 认为如果她移动到的位置恰好与 $c$ 互质，那么她认为这个位置是一个幸运位置。请你帮小 Z 计算她是否可以移动到幸运位置；如果可以，请计算出能移动到幸运位置的任意一个移动步数 $n$。

简洁题意：给定三个正整数 $a,b,c$，判断是否存在非负整数 $n$ 使 $(an+b, c)=1$，若存在求任意一个解，其中 $(\cdot, \cdot)$ 表示最大公因数。
## 输入格式

第一行为一个正整数 $T$，表示数据组数。接下来依次输入每组数据。

对于每组数据，输入为一行三个正整数 $a,b,c$，含义见题目描述。

对于所有的输入数据，都有 $1\le T\le 10$，$1\le a,b,c < 10^{2000}$，所有输入数据均按照十进制给出。
## 输出格式

对于每组数据输出一行一个整数。如果找不到合法的移动步数 $n$ 输出 `-1`，否则输出一个非负整数表示一个合法的移动步数 $n$。

所有输出应按照十进制输出，每行输出的长度不得超过 $2000$，测试数据将保证存在输出长度限制内的解。另外，请不要输出多余的空格及任何多余字符，并保证文末有换行符，否则可能将影响评测程序对结果的判定。
## 样例

### 样例输入 #1
```
3
1 2 3
1 3 6
2 2 2

```
### 样例输出 #1
```
0
2
-1

```
### 样例输入 #2
```
10
852473158087426181 40698107377421 34573878586
581501852629475409 3507820691986234 325392124094986
983001573592419694 12758046154806915 391181873366625
523432507089908187 22235351323484 99720444415644
547133061299817509 6492909838101120 234547940354112
315440975649541747 11555829815904864 467063676334080
439602165995515631 4284196383788100 23950691236800
8041598789940150 37468471223945472 3903034663348992
6871678354485379 19849006524667320 441009815372280
332133101579862271 12172161650895405 171736644454695

```
### 样例输出 #2
```
62
8653
209
9153
11
515
391
-1
109
23

```
### 样例输入 #3
```
10
12783455250264173814286920561815033129455292749111618918427759878900279810751984733300641240295647645498994599162724672629047892495532138517304022796851646558771922984858980119262334693601019798098147528413114685574056503715436537549292522354971173131279934494296523856354172666493759578559235721409803839003282397252589124075035701330994071273489705237262616797742375568061616753874936817653732331053918236491719070433469272496053789879577293093136499356430366004876174347137875860926532055047193332536966232985234902943131367685839673058435700772348235953215944653853083095646817090284623088732200913621558545052386885042144165328321547940688685206283677824239012495336775290807495043909817845678605221553727459510132354991460204987208647245314559868770002161766721560065585437486661777527998592610144754342130391951953419017996795637883263220168976979322596122704959150231743451325634540339716294155725269960803221336542937571792081037139459330357824733566717243006876271409335003836078762849002147189955692085715248990876391981766255248969629842537112053108152500087637823362918408326282337474710378962500600610349693653993027550952316316670853506306449406813119139788643083838328211821035371108143341935600097829865434811530599524028359788523071541453847264583333710123798328108566001918896610874808288975227629962146563973302514985616457681694941096019675649638734197123802474002128602378887819093164289307336054709619640526458697226534314914555408935927007541621264931926037372185067494993786587959784478212898791101939208908593012681830298437720655297000446578120709407231943461962332188295524845355039581215838303320770764898539181428691049707794809167418051510339852221874475513290850113263684417176656727864613919612116766407162187109690857320432723321345280123657010476175722098557540458136644293946857141877052604661078603646541069981640502793371518767316335666923800759018243396579180815135128964451989008345328070525364016754509674392674714149756548873402632728838590166371254746489441 44924584934298356258235247139515550277657144458132498920711701319209046837005601491725325650104446122603984225820428968942657142821237106326448598486364447934821424060473757046276786629098102167527673538036553991151541273947919892025604291204237290090107405121447367158704606912774391763259262891780036252203471524703366851604160103580747787054352898175420368862462141358161847230152789331018843086484212593329912348222277059280691902695892264715387133615653190723569903496603187488405999349317653662737078745787648567769844869079173449207207336861979579973618425342144127230835761987073422043679970470242803266680165591525343971536842802558791640600538155258124140299021534839210512287020369411255622076001574169024425018843663426370052763964519938206410908872864827508775245746148576446182132439091342389634159768379083582026347741997321884886737792957927430751871598993475295804545197485174215520946553554142369982004403301347822655088593311670803072067266836118377714175090223734357674032248208701205930266597361715787857546714454088116120186313378149957771238446809076734604509819777562794256682442798983992784805977674130798914112259542030082316812430332480137894887849353465816771517001487228826702481634158900000584884037245812401362420480513482406397747444923413014074744388374838428558981078412305694751828874536036424472521362350582327431095920954542444127350875313899455937053196754578226522615043097434617433872338162475543334536129590832318833885540797192698239197981846583995050379640905098742128786110292101587674488125232154270321372909033370681160671649283314323722096925350863808047856477440056435018490894338429353427141589876219024477179729631938051306076244246416874565368361240044590878306774259720122597553009341153034167032076164949807496735558195231891853274727424580590078545571228143320752605915739557205466685170808940973239406905759020140456486166288311181816084506195325571257785796456436314342322618444284460747087145534327694182582707201155919191443563283517335157400 38747494824482070352922587971841345158134903677937706957299078554979000613898400264161213696959780419626514843489882827363931833471571900799931389264885796060680852268380296956177808630532157537935843414998992446032247552157856432000542891503851657893782948827980727230427161405080959377685702832315987666462402218640129981671726165110123051269395991433442860368246889219321001435529202399441366581263889438274134699557132587877406202775593903912529009623542096112776930341884977271842416447501670853385639008908426571573611610786536213660289361256408832905404380583822900591210687791655768439671982694504173896423808038977485392820385621746604581835443903380115272605039828735814660821401711818639601856352838495166380090763345033751522719782678336797837843387051795142062674360832974985033387100640784846312740830468788910911396917042527059380518083709058020615301150521123821323958109313333631721204038674221023981991827354563263711070097215189823416971262460611188672079513977060016319191797286488531698281804309204994470892812968854344033573756107485666854351856329837880277206713967616917550502997590445436574061195849736842645211019046341821326776069645496417998633259355910660181224522116143322468134463772412359215924855604823837491968146789346969393924055883849300817457585642868360420670518949271943333467146814232203433930153429306269394554111755357753530856669497047739361691204973068008613760398045416010523150593286591673737667040288388747625774199973413789428573616832754510756063591544685139679254476429198760166173451813848111809372183614212698870570076468560163433343251353255684575425592093737878527625867970840551591992779555508493839981183028778838611310183372308931445734131618463296085126401128983294049031977185777097631053960342390543188211057297084934649118633078456216996692272841959873668728567294856722649798481835479581811687649444560833091325867704687545605943939826508498459439328451675261432043076070965791891222942159677083629301343061534654612554575659485714015900
81332009164280198104243050654578313400260551479800084981524084381560176473453703114640913028814355267566577529249914014147363702153785145757490568951334307043555860487273931271290443431529953483184104096911570791495128099333034121552409684546396555569656533603319539702056218234482100743397712302035879860825225443287114760788526905645241667375749372110483782524638434244979662294230290338407174220856698902138988360815356669332705152797831173662441969150409842411086337282138124779808769828805550815440031823416805936999849185662128161867619975205037914735829949696585394145819812050032847538811573638228682342657769993163722030953487008513448492703254323756486607765011844468240468568440937488775844389577360223225823034762613287041147993797380751937733867318890767079850781128012374504286850190809205004917770282086228825226577049603469762339221055659316340485625132953555942461139813318207602394712115271414444287962751581723198828452476455146508258661556761872667324128473284926030223067861873702023772355926887037681481790097251425579152310033555969417483209174032713097323354489509881481911965163388666851423922448585330045109501273849319797114843825308736852231314916548350526442453572343436336288547942035727663634821702367894536801519804727887749062667619027610401930957784447886329284834946943925934865156145248273763419986704670511735519684685560467655386148155124542591321254399749929798358551271860407448843950184525918813741048140714880108190294254013916949814572060925250279625747646689810535371298277457301835158012219729403955929204033946526988124434214700249855894178020011112358864948265333903603790999947102841540472306398893957078459294257562347672585703505242007284808333446332800017534838042660862672840050192995501853950272373270133704502250482638588846820750792837805008197474706881074163776404110206156808610458933057993946656037474685736941894421761737203125566591259684233704220077772726085183139556134626048425941614787054616966100538878214136815505145940609158859253727 67189780654249916596872549796808271354801419943278404837046414451153903246475394545718365630145246993175503713305427127068002457734677406859239536496173722455185479704801478542678624034927166517549956573877631021797649984151680107854452990076088975142455672829738983704626492361044522043961941131197397231806860046515780296989842104538831365443682251010853311952532732591299710955383977132309618347583593402995414783354996067316741339822015791599606888311629951715433119695655333509335552208901522380604417964256333909964399656261262877089298095276424202566604428801890639413787270131630617949793299221207839952368099865805828675029242931942293566440773796611801440260880793820114575865930364645437513204868079835959229088688955572576876913353636589131001183003105505217391926041259856308850680676620238420314003506882749874028303148585786525114460361669367101414647725090633113214817753652259062270027732766784793390157949249796952943443569469523595982553165648292080957552997629325958998391345666017069511164985904795577546277787244237167161784232399154087879976611401283343427037741290820927604478753188496198456061171810374757709263860305056210843254380895805909460895461813449445292226811602489612097432189044742660686474284199410408525913090325798574593480120864632089894843204371072872624702022539695137926270328854830664232452507284897370310551213474196366924297134304904860177468655275204281377047232738671779686294390905206794132292002603893107670923235091605193908617473024369852454248776474614537299154768507480296719262177616782097487657347026914488533177377739493120554458418659883483565594749540843442148322813432471854031400600540986833679775938919096356401142899955131349940431860415531666330976231641373041578168784003591035041934081121955735560439389436213784031272267416188903784625848762642635842813021135679916490330139655597128011225331182724819419307888128040161781018847150388810878439688548948649815928703141203170144979220128083604905772683899619046336037846906011443647200 56185112692214153591737642320891492869466117671430498312224782898555308033049401873334781445152649047455316782951885261832955960223050908137202186907211810218374603767716317708773685797165339384829324237330931092868163766331808376943251153876254941023930386586751266187940398767591232663510121592956769648908167169198669494352941440910147521421753129166267606036698639785530759526471838535489372628448926184806275681591347735039991460287619076556388777705898683995041427115387708043465217931786789942882919538584014962097852127176121044577525042300675541534224845720718297540182966449630731591166799936783233741731572354169069048960309685029165473971411202629034298501500865132789040973219740668347911181884703202526751980656473309357075485334688942822829905363956465346101301608166097910402580864128848618185341590653322684230099427241994330928576165692296371474570555698426861465067488655426142448642887149147531712706444281092677176635699890313683102514275397951246902281827537468751179553680310326811042425853072974831941247403223645643209286520339730763962407422352850666596404468284127508008936960356469562423925425032253396710024077385850692948826218489398170312625251655287964953803231952416697058743601166605772257161904025010727984357400324663421672964827052978684703502591418209965350356544684096845776535078370713658242946382674379487194724655684382035371941336300208252129801362123962609477508461139254559412334378048359448259487020504819182890880752456250267765704938530681089530735425679234812570237854510837827151065925458565690767266863912463924464087193859583398311859462535001928331416586560856720513300498601203156409026935037379586181002559084419446436220139034346521821015007809471443603559288327197760945172830985729585190206485431115110506893108329459123375340185270519651472645699020956825358988288608628508476913451376461165723893902031309917726228775542885166539890253552623140728271489418657249834243504146288350321297840493130193915761417974032179804766411779973020842496
84350987575450133568399904563649208221152856678091798660751936486316891720557914337422753845536624805754980801202659143640614641354053793205787213637775068895302437434001301004972408419310113378895015736004762599410927500529311563957081773968385636981954463571700513673000199519125443004427479355955006576685150380492360113392042315628972391820331462562908764479160032820774981431541025495452086886902574258771766623974706346169132650825396092929509366446252213394238131817380583339661286529727415379123300439731595744248455058640711207498698592248868995883798357110156439065468781073953084414045417887816101866149011407894795064260697596969313448012773967088792585140611376566624251464889716869798884028035689746040528885789848554574565731682729611420080070074313628390075311801071578873891710431004692355066582668959342787345179737701965136055860058227812657596833810394766494910090896462619074624139875870305928343657047248270385569367262762283167702552525550695169963634186449787087851105807293393610277361789742825167816353323952966113746830052125016568061300009426028935149554547199744909222993238936879652982443760298705870959854327257698024543534685721831986546039063315078786518447747409383399973071917691006080030114268295189542605141460275625820850740228404777627975453410896270887540515654399080011628994836912452341648418754181362109352227900858934599200169827963426808829471680469159206996915344878009111231170398652514280054577040803880575525713890554741195698863747847939230511445618981182246341781079758012484570875092406888539033151735448702685604563582660724100418840466994174941224316239281184471726054839899313816759283722899506495258465038559560800671175041766307962711487173857907842777846085584243655488636581792242878798146076772507392641089349530451977173712799927582324724940322196067635337158631271755022993780950532346642931767786635924330892053831167299785816724564773735921938531577802941724403258222844563555306565982792646897596956963034584443407343691163881708340401 1224230609186083090871344528234742852938978730719265421270178816295630103245961447145593187918332077258814659724590053806893902102661318997171246964657624787758566467687244105952321044294007308047421705570960162476549947228529530187087604866776023169073636478501762258330054060063724792161196516384218105293700945094615995150783659487910277872518586584061687757736700457220659137267186628195622696808259780352755800581564604191251088189465652691997167725510272817275063042266001397867863601991296653822697521447734079993651803161126041646061076458143298857926175753920129461236566443626415712158544374801987224758014471511357676839963382207732840712767003195267708380738760783857633410654273756886229176045025944959601319684884235364255743789395343479711914342417534810167249083707295213237295270098108195922614023911460854497980564221378415845669727832925548181664130381896060414235887281003371727297720977505427075966249986036558189618131953877287296676080672447814404378737249637832043691616733383664127992481284411919679118554754898361546678806480414858821344339495629710521840861344838612536096167606280717655717140396689414785583901585882866720759802370514548829196035086197893864344506359157998757905276913908242969156973100044126791940830641643449209404601207378467766615550153133648953275712201833524381336808433885533055348627837369596502806760236465834564845452866997889850841034685023820368072152458637047501689898664853127397068762099107721486425206371709793512455710930304561981510634671013319195747894489546866475381638629477950625360508130484047594087194682319481220041506105484500253033973770507474964041614114601663102027820784741604410713216181571950294507875605383658690100336139030496664607135201681663550410369957079581150627279499977257709199078528142811714360098312915089368371886244967628214032466490298434289966489193366400860611245729820850563504992802227600421756144009528987608523461558698724177036508876396116289454347654568681252229540745368978161659397437368680851114 2275026600958275730031591933966807888903475875662361454307548759543844186809238332661342101725523118441719594954261734417160477825311961755520452599891630793953453155781459587212293216318654166133993615246671173474896093348445058604635516568835969685325140212486632895083453401567304009631671079797146775036509103193044823358175978381921651660716917071055116943067312144853210171181667114018014524004461803401659345029754568214976517829601275333415017657965027566730209099001991570204952099725631339868759629742008016191476022647103525473582575137904122933547509408130255739814848330747776251288317155328055957232166289850271482944201091236330300697078941015755262045114670819187652724377941806230094172380160428740272794777162356026943419944294215783530411859954498109483552197039651673653321531451167744467110192470320407680876797348492593944968643766259727779033641766907531810684428324859807937945921271323473408412036124770154571725334052299645962920883262826020237043043095266923978852557164729241396736043340267919136278950471687239853401213359112329894781389541379593595583746592448369616102995763873265831201095911154086526926767207965082823934478154605930374103427382251599370603342305014856415816070335995785793457305437924136525372428514537946025686376149284809785390806268757086530491808142321221549621624390003128624686736819921285811159880479895357592392406625220752087812517873648214531075542528839106772292684861982207710474543155068040802055804114477814688245560892848042272963067624063996620918507115144056416296632159885738918257708233832357871548632215036410303562450938058624454082168388345239474731086566018905658507771824609272356765040195643784672196551219894545416080284488834938420390457302539683767582803847391999776747830524662391490890159206714043282955583542183703928032459331728048322631919147140994656029262451828475372511174176169141378604983706620902473162340688952656076730553708938187023375175337964949808512941048856134940237882172800856002383391098183871042544
96775284796852884391411415668604858087504637893768817031348743933802911426188253949257197208308408628852124924949933331821512664211690573382964497337746938491971080208194652439855412924204747257241698093481231296506425566464567909151164277087402737220694838916284865456352543884982239710005770084587066275895920189010393343252286855956453196011847419082807472195242180854041227722239250321601110385065403176563469251065969164615182283683984006872929794126686167219497099652195311795864282870334017969621081755941658037697761106067815673867138896248987480665039470857450598576239274416493223493171295319060495417707886734314784794164294449588059373485929796757125950257057565145025166277150247232453218328842406558624431443339287371877070418875514586196921357661927915178820018859115589286655509654510421410301396972484467720146887744746924177620276635130620799568328844280319481402122079959450476931918190291446896878420117661167396284487124202833213193079227440720610886585724503649174699302062701405069547843814437398787217572370093605867953718830180496247966710963048933693807126458991682399088761039811192867301882631130921432709113992004416284420757285746311770182159089741745748970468400992408763219073070304765581467910188116286827129674553558951295383066670352121321235185488479110151955509067852304651949501432531592557213500725108607655375819965806027916995500065250854159012313679030131207152961091165360114374949036091748765850654070594240249392807275655083568742704449377253416871090747704434802036960772714827462639505635237101216444512914498045922568305542286170467446146647209377686736178365249328686321715937116036402511852533030976093494618494123090786360380349914238970027505436728530280248274722980268522015977848072489556807006326095826626032883724175812819915080453304772539588420861178233444248956249774243057955382812622781411585228496535147627563693052796141691998632084520439125351938739935582093484517131421587853507029801561884247024669192517509341894058117939269153163122 6412614028741753895851812914100282131747759843095904563948949057593094375697786064406758418681547754808055876022106992839263857039352376442674865659671155463383424262532534450904330889849237372603070931573829127772051056223869551732119046995123776575742450901271320543871539347619289468625190270701092360984487313635658250422572364781741592563077687217845189836872581160033890324329961060071569260597573956657305459091700395159517119878889453966504156139926946242387685698635384099747638905724061849329519674559657633848052949456052516756122985928643264625038170997887787545776812962888340846335819712631017471547840278300002983088304212430269270729462364614469354190907693075412268997589993936501595704297425027606259072141586230695990220224492294901884658479608322050543394835654135734366982768491066490987995633336093796604414450132111347045209445252667050929308447321995542626859422960017657323481888501697033945582065885163924183996765086671365521868435402007172764322026773466404980546923419150924277730726736062830562256435514666041204537551054765112689236304174595199703453156427467899122190545076537322094942117143597436123221772446996481295466638544988194435668652442900037683086636097010364594953931112520967380487814455269612509781078938747636327165458978340441497145785255721240788843989625333479878596332644795465931450117746676888678193268195995810234436595466499833965395617927860275061012343539394032784660888024104814954953740722129248566897671270128182006910548351484290806910574428163408147719913264693556140375583874104290619562249155574142992668992888816601248676610893555979163558830953938610215919101287706718947682462640060617267863394179757552193102534097736733147715463060216220619479053276387962485266444905629945779730223932965604334886120923675069149310240103543049225539874223900921978567890026395701240629742194084509746144891272933740557357787478127592437983254156775239720696371811513485060748736387725411290142534771625341159841581784660549279757836579178954572258 7416484118673843516727845676634962714548111071662976507136467192537896455457448881887938845292726237417623019550630048768269797446213749781707099965218640393652520713633750790692403312155399217307399692037474818478549177695957741629531786074472486755754631892813065543924186090264717450207848312598663342595215460145112915976409483087111659759182944095447840364234122403004576146644341683177206196492368132971587238142376943230581458388386990526885997334420447658729059732829145484262066987222287191452603669871891507916075911877596834582886751944031141693169151513041978992108128515342058354000969017461350968304661094087646427980535321297178366843411482778971584524479485355274281773216654064334527020933135804643776964245703977673167757861691029403375838535517526699964583572427720295417854592925565691568207034949524983090976830338564585535489894010528839652349173327495032064720643888267140412900068991709346560266822119526324338631663658896914977199240923306273810371076916839943421383505398649575411844354627425899965232921752509071808664508270399291511141436177230832198613341213447342084336053980067288592203403824739080065251598264758732848223424154911956748210808760478079563343223520171277865182439714329657890551829781174378465076523651788522446943493686904303710113444652419677406065739161768779563039012636405469937324251155371747435844426590644408222011559146485825449562142231370915686101500316702197008591693703579636843741018573253966228001350626289914637849827047411502711557410091141541436777388577967903294145574358247334138999826441675684709164837638899395395698341036941888666468129298674808328696944279368692279428541741994536732769841010458077510590514055375750813939363334253757446416226584692159524052825055366809731599237055621949808371726357919550278092912759645147809696979956498414348196145350779787239774473479906559219393950723697800524158714778406211764533305306069885038398113623176977875822539604313784173522205959854783419124969305409515179825009531317625735124
6158659356485648366052085482060205090663818370502227399330647623634187689790570651826136840672096700669743101341667492011690361829907252705326633228528266149737889075916278517986355137207084194864778793206462408793830624078070988071894762591160712068826908694831147590094897419256616795418996974979227339662663071423626395383417592177334271206140564479843631912095305684816117712945774408911040577564379519477320390548334524726608768255743238155894054281468170587396736345991250145924282869464972350820570373139876841309110371451196091237349335100025060248325378103997849172446464968599525299425443016593161468466439924150071407579930271852733166247497615006811664960170509296175820218675045703596909323434554858771572049193638699156203934019039821469033755683719566739087305111375038673991213820806521403918400227188936690242168308872721338646816157730961722552744139184776914739920492777378822450086499942946621705025769668280326949751283355885613444262036923234420909228417199302590042740848819744238613970099598496906384993588646860747410469610177085588343099682072433861716748521728761397383310596311398611873304235565003846627246103756255876066131253753824857390635550222169387648891129209058898854397007778333684451324238776081247857007384839077357013790615335688937586569462860801233591211109337024266872987786147610499548179276959948600440957343182480022349206950656620723620716548433199561393526777412486534651076779880021693589204197615811460738040751957052401763637797669638084575582599856410730017318691756616010375546333987162129839236780574228687334183072667145747533950011747528115860259818642393576524932578138447313527096622250093486470001032883876079403207033529786765199063164279344912692057085804014509251364230872891160471443409575958033979127178354971498727100054391568864637909784474283766385940025983495216662971264322517790275066666135105309597397395510963570626005526454254716318054279702140238873694910205782203085658489612028768871332905380398423614322865669908726160639 21102177223164868795722447331153786297407154237009273207995817107023370803639341210247408834931175441495811560064704246011124767619270561982633685305682140990346235928968485705353863397068381897224132326068530689819841672522242114880802377812229876795681047433252325975010794153659818022398674413682966964660417928854010944837250664607555888291292207140335958782125650117331306673041936265543422038046876946014611763156528900427522231361452158063940896401556527195477455049055230236995218390994179605389537285615307945060136466080719458519395693061981240084692411215465832890460394002023066435946134577582222453191490844209054557378784667280862490154660222755577844802517725496367808233151770642510988746863842350502633156049785970017024248624460229780380118031911781168976659826489320846190567681524610865317984359263350447946503657524057585330216290015171199129345848476791519218024694036380913467591061857410810819419166145865266866079242241004574687956657008844236700410853039159385821015985768716005454397616235835104487125358432748336833197208547043809715676413952138242359024655364676361699302756490990851142952002759604124442384335247090709219313818971092661894250745643315727730680720433666754570788017839507001794536791930518670148616147784514430754588269979574048470797923048621002919605351820758448191869222539637366190289690926880665173779213972590586136047115647061303795694514915461990924616728141396417120315765171300064516952397635950918144351009466904826588181102931616550759201622457211537389517797219424152722236077274510905998741133824392482159277503865733676664020018213266911440950989497202214493690462134256726529184461297830537827126329387454089257140359369993835450354428857849426693840889473982566597512832624718015607822551722783548719709932214007133858585296640605688907390488007615522622310187524716360440537246222293844759051593194408569878604483065163350149375173602431517507688487949741012044065486792749870508490766952174921721290876686832304766470611182938539790828 805987277784173363235419260062224908526588772720678090006394478285154504876630189665064141083959913496680863552131752436777382060201460892535170601073777827138593591470805404208074724609561672615254998075555479178549458228370742412973843438554956996971865802959081916506756788529643597529315075842006157495137343909915819461004517193481950048403052734717664795445877247828297669361270965150126208650639286468031337438215547689711963366436222863813777453592731070769750260229404472622835611279513673913421059438031111375322543447548139539941134278256116196306802535171122339465489634779811079470846831189512593652365588302413446547970294373286010675461254384169660863295217042153778914148837839426023282903527290241700080061650047120487312653604117625473570478209408973307976763755518753389306375166012900636366489576778375099503205821093726608966602779627915467784829936762756109193206022423769296738837960339413248119264958957930159469959831960281531791791500719121342457212560968842424589563240415139304223901324826606493472461245168356988350910733960278069558260875818599953493480257007576373021001496567056458961248102583973519372964923522404943626307823893541963565393241921661988137705426787753277920787246327239505915553328217387211981338858920416482521559708272593792228130149461660379944683393452864326411103909283626743845648680274502559853903382881450294826258413707301992471828012762031525959549976892693772472332001184490768441123366052247248133286474506908071568950171201437496484272045558651652775618198097458139758205087952996418783532190564498441815482461910936035433970453322353074935059888195531095934924049013998908360464541223571445763083644684454553725668541089328673414046269092440753744533904613427329552962684846542139239443844809238030297099837655364247463960963745975879929164422299383579897168942354316265089805981985074576382613161528354208239194375159210793989617424394269125671060005298015657260022569449637177528545119057106950200394514340449921040649783758563311216
33406707748543891057069392011094583625341657022134142656399818930288691256894827039008477180073571565608059337375573718533291142348053797559832983419619067070125902967660636333378209815574837363101608037263619690716580073348476294384835814008293663925414807221973468207305943873348561422781056595979443119910313349935845848495709426691302464288631985207270117037384066401574062785105342261831640536535918534716353330406848121071158196650583320327596624096636229350779188157644286884384444926729678073199341676978012076979904265250280566619050576387935624271621984671840461743465632680243516980899076076762609382511636028553048483481249876560193053416530717995813535481216889672838860700650001692258645415619726969769477737190256899774105583327461318494458659628781345735471704608842821713311897601548176553792796214681283765581283934854635162195426639064207064413662689572465901648286356578985127625516136733480761512303918381185017757072886644792311906782249051760599464933648158240092315830631975895317296672483323648688705808828076642494613363002259348655338243036359631277400145098994304034281787679132050617327219692138912576618525701304854978187558279561681135013706645745781778698716598211856613189298019946696520526420222745766335473675116199922402935902022547502861910403887394662025322697245330851565463281993860950994405652769244354061647569534505123742746913812202944153646153237087582441084910965302426938882261186209710899155408226054041767180638239055177964390933957014483167879241401459010817221634511439612433793857226129524284777151773880733390080311618071418183788206637523523044190750096637133987859180024897528503781014804716548008787131039976728098271294083898497953363184292434778822031298698705249830976149117198611137254682978383243690134529767095005732265644343192647527920257704772189059414128244654189500318466495901894368262138402461831113048231880088448888119916530009563771328108164072117056945723439728317268784606904928015041969330035672968722205519220053202095523411 212505986337520393451226680556238605811774909765688339947390162465692433729115611137181520687962445807583747974460157318378911039418101450356803245195261004394755111457434659324362163429681780870457115783876966457885247990828198098286557187294779642704320431068920240312604046192158396779762345500121203343634769246189704655458117563843180808185647687203065210768017861785469711843788735342982716558058448945339724932684749152240154709915140376765987726363197041783447102165729534737598269370704388627458485037446069832175243647686177327832538309326916129947050544730354199534974310984098983774986254313330926427184272499650954113973478610334000092314197647192333627697001776553024558540290084098798128344237266793549515902616192917718272601313502894423941445949190098971568626672160846530851680041299782589473750550488559806158512450518677835303222185238257400830697889197105491354018056097983974231049487131906925062445090740016527377010730165630449280222307963895631230113281720241964159801857053975437289449251570812647482117449536909540523490304774269986458882027166684802820903226725126899698314838249056812347007614793698815223572323221109129119778544015522959467365265365774580892642061504384883624345580824640075294009304070434545085928275201316114716557247051328765987901683303903786407117276912404934944268558720281968030948878183379959873734078615528454575494345248295223787241127286452233451035544945230888635192993148426610275756271991260115447279597135438570867030225910909765311464035964369095685779840824055740278018009021986388851703969306956980262242839940376085102531945239476505974109945168238001426660563627016860639940279884937896978897783369149256726161135901696793608878946192270105975872387938839516776557780724905469408815579437719285759546512212121634927570178109202105315767795101751353656331333327887596900336201866902727841570220829655619306435414158707811770908915092982726059215003901242692632077182525968513934863067034494847580962268429354264333795821427003537900 25758784573266142419782163811428399568169803000092875527221111572985243284731829228312077637894996117086109435066846350613576593416823423337930630829232291970764954453245409120718556138863901998130126552757905476673940162071974303429224736667100157256003524644944191534277782601163620598912237588152444874730350572561366923837425681589932714279279205472504062039649958982008097988026219875161343472200053466067319243376172575073531603320293823567398088334040895612526885903823999297067492264986376437375645669805173457846442129881683983955215797501976661104565027073534694710753627563909249842589404577606859788425160249929846757862464483366922364947549650552758585829351783598401812732919474197172860162542150411645612889800103127432743945860057444719172010807670288869923991890441259266405963213195070766475489025151326698299367922424715531200271189258821423528067039677098381366329688308370067326966789335436190051696902214802256076423419995774958522328565368962256775325513529283106304269197463280611073430762286129468823230730011241116615618949013093448937920275312418847389324454283801001151027737732150795341247772589312219832755312491229226213285673150999434317742848097438029024778348298584225511226733259418128471385182830469614645053005079204515149912754959148461733381577575439857321454407143326126528026491957668965638919760757029110618632527240757498963769444271593692966386743389975556537986467507624260953108452140706406606201947825481910922090700134754680036697780691485326198196932697847395469347081201734025328551767885172208268817017152197283741823230064475868773438698880691820518497065734041175925831983739413474130426360348702803734636433376776495134020403813542314586955404525007061970850987209343171655175887138016345512131807103990206036653519891975290770469512256238368547093733340143279589174261015746117570619000973590399260558044070581410054817525692081543058465108526459575368717678197006673216963346824599407250771516682771793325313672576623473364336734968684818703300
46211008232645482723168432341933624196342917963346614387825255673339518064948566785658753162011224263323538372064154735806061810497408697363336605893842074469829156710876196477409276656349990815356079114745022529048719552376561310604679527873777320249506809230137367627225654371379190430661681674380533106208429647152483212873599333135901553735868477365512429190114177337007047163362565385343629504218467115642154545589228542436866701896847486020832466753398501710629987032288881412362800177657959059498046638993041672290555030655132401214220159171372278157167196115674130583317903412655166006848347136313130447432662149698858302401459088112612440981411845221766848136153805695362983967961469319627002444810388701073893023706375631690724935379200368445849345935128295179152191520659235637940059989195364273167686757953143037550373232788343826353643977035575701965390929019431805110760276907175312675836152550088477309131306203809426893259582769271168693999135873174872862822999695912286149011552274723489491484350632057310436243610004282599229326864460742999356435995382844104498173941491641713202106579670960374402595756318433853020144324588048399847519325838204999016644429285695719988766854543816708512453830879625486194879793955235401871890684125077911157673523822446005439689515647493926129540433211419179497209240404684623227356053175650231073821475295573814155042728538809555277679154225409079928235130945513800736895746675341782247574486195413310728019587982875956576064756775638528420783865614989287281884355234030782927618917952840159710121692500222692046512877117786435565847959515227117026446744929052686453258962281355876807593158594023970608214756419095654995660080164141599701263712589439115672695392568872228134301339674975479439514655177960517406746919018057439539367915281941066030005756477322456671171045884084984515575648735009345393756039061223222476677811394470091097410164160377480041597602194678125707642167644982340212973678749733080959786296683229328234271983912568648892287 23535144785223664820795054118209360451083439023597655195754608967916851170447960799203368959710357908528514805241357623059718364777662053250971925657246802043284276385940865096330824024227098580833334889121326560506787118938300843456561606820784234502753490623336398155163711305724696370549522501466036841639689715915016923017386667653880991816643003049061089427514871561443938919875029002760992612009672620806956608409344058304446991543126748113631922783876626327014764202379591114449306687282476010310569782172084496348321828034478754708904165372392291408916310908869842096687620135864925911181577016475435408486214744646507424293080864071969791461714305303697634974996135100971301285813600457528753562546146848535360978083558352271843770440278335734804587042772643583268108226055536360774879790675217240338087287428261607584015939122816630447439568192124585154727073010619109987525136196564048578530726012381939791622236362947615369417190366076246203185938701621512123329819530906964522909789036505336244724429654400682684706925655275698265257622978386163547628848800463427300877515313630999337389827674363788219962050190044069823776479723659138200471629377053993741110302549225614159857499011009363994014046104663331091094100834930874190016851177152713577516281103529771661929387180962737523845760678581541505280187868364124960322668231458530637202642194838976482458608174095615048250368519255080755003001417018987385641059139678058777313274458437804088557306391111956972152968732027175855837983505827358286122557325673575921610645190651960832976208388337352488671509581895043304344024680507240899622456722222215876098778794631498430219560952462342117949074673327552528137845340453102544623761159816229795000731492768623127092115789451713609369624779008526563546529074884948316330020699062600468711134639115168015067610841518582160032817537182445896357200104736279812110546815328681477486856855112568819547746351537287104556355495225605395528936137515929303172619128907928720732758729438199381988 12440405276747938918908727579012811228514747029681601386369016297866017809667021040529732765137242270130494775713939683742734878983447691629323118459915804140254573244782962988434052572379949350497496328043249855766946198902353307889662377712624223578317166886437183169659628250053905784806273820767145632884308283247174327550824384247550297826258706202494042462427379477159484473650139963395733263185065708509772489322252326693401957370716560265893330669053404792575614562022671918122978485163771052253421728163230947533008710438378432752025100449882402579347115496622747218296157061743120071212314247059983654274062267326853201436599834736516980386750415838623871041410187744713390807943005858287203465594881736805444081992010896579905583230314041171570166918155112430087389695928885334057840875916836742709624249760637827889620081185326721930349430070907557901238490311036315244668138031336650254396934630720365267132276734825114796838725606400731846909024056699675798332393139964309084451953627926876036913724395924863714556565463433162182791992789073406427546554031809766445368480872854671831245969244442553557661349056077816306566277071357276076729649999164611154032647464298887297836507957151919628917090124834024263148406606217183910882579759081079288419242129199960166337982909960165737353526014825503310035146361790085712483326943165593206626124284329249484526185744886520114326827473993132265767268190395431820149443832122219960770084743167948067768836954703359992616898671215798548613528159967303979121487358381457662936593818074213764467083673684724282041177262528885028069142520097167063740237445005283860441621164722646888192510544863643192645067484739092156394690646470686368702632865216701428904696584117338546535824997175871454253935160246276380309442749048616432151198415271175500256854453672960305259263243721999994367587528159417716117635836015968654057633191661646262098700908521566923967071909771999204041213621690001346803948247225191487731283889490517955037103122520697662288
80726067561942906197800970673828607803786462298310998667700633882116120100477197813831733405144552345844008252555665630506634178745226853503406548582070328059130417010725532021013775551199177730031871176635075446117279605951301406100336516959477381844527653082342954274257416150618324756559356723041117701162923001528292987583784316001797166134349275594899116979538286892388149912005721723731473009518839348772405562151948985050600629103993560488621363628953963769622272347553023185740432596328697343062475483120896873330021061868869275437528693886048815042878514946808507329053566444439330201525090987276640022548615399910779655338395802239675542771119035531143382022223199354730992506623993898554525141678274288390860017396109229673997917117169380513003317323937799434005744661835999261004376229919345515741599418079215462657726487802504962157952650078467822556790533188915089384413940968875952163945044045978858086372831319990417834063709167678511724317389163607555049050892847637370348484065190521311323151453465976172203982463685099699360507978107045672657962098698270737777816134829766754615058866751239818228000565388589930561845918255627118656882387890626493172707502407375134168512954843825470316429655872959394882066238329123030323988858933720248707379310275499100772416488340907498610268258155732264421888515415381437156647758986894581377556339718320818487369740297746605980985765053466815044244470841983248877772871653592250045664203265179208271924856616645707673952157545558992697524822372699397679245969520694466643317558459234400651888665547490319309821511928306348951320989974271230884067343143746337531202341400667838803831523342169174924381481267224147362377637470605250147696717720961947982933587692289637476659899655273141820932277400181214008089215755893131338031758899486122805831637230620904575985853407930425368257637395746496952551247307197069011834354529040103220766587497402490914795011076282026950137083131811085334781336628862463682088843730735430095588910336648839877313 5861364899073818060455360512027362558247959720930673379036386415925468346259865453512757023443146652332017600613848235605875711831034865533543143770350794459553341482454981838089761160931576909387176972156836137178493500099044051419477965038643533150534833929182505924123528074523423703700363670678698365202658220148728043284969016585802586371203451288107250421995831486626220092606933680252081582853527850960374040889083639988030294440104723174307219812003707462624798283525110330984076221724798979689481424024747329119680381257964456543234980003193109419287098556896761803489881225043866431384305862094183010429205660731455273439149201858790660539656434633941813910086558524028714848367676425863797087058535969581588921292590030710390571286517634845215742859343174139268027734598625546344442696817519070067410953970361474411615877282731410965472517150734452922195760744328385386099524021352943697900782817705170432884711849778407291925972463793249698445536957317811516729262855334808267243898948296972438946355671610030941666408680675407099154376463444452581212601885048305253263791436451510052804303841146278354211176099397573803267244920980909580343598664114391000762188056470280891424891443346250666642732529274797028587924190650253523702199688634672619963675368450632195068107735002761810416063707995579829277809323345851435089099111971875139519544148253786394546807582373692275478841686532757058644599385502306144706314024772866827434429183539609535184756719535527916158005034255699974328736554086426194095430357236288024221206428714197042996156010415778117277071423294217084996300488091171109002908957017357173361921268426986380092214949650608843036196206469925522522942280996783913528551406089610996699246313831243736926120267065045848150227202441258060499674626853089969751141639971110402943468364408422412732156605359660740210821803087638385423068775876260436257758870241723649413963049589933016409458799708378847594640842290503695450474977931690455272247306747359293467446158604735906432 1894434909569636718934633713058256315173187272055977152569734796997418097954947467507424756534256339875208487943303409543034447155802467407885897981131250587341228085534126148530095774632860962043631922441325343502395672257417583013414144653679300843643250099817321587533060257230901128984167395763323854199035054227871853566615073528336936561594793979434651653037716218548034483849097312055178611047302216364879261182591320280667225628763114500219830788906115379221276500570031909362138884385138831435053313231032911234624300688697701879265903840260342191325680846084294170853274070925262918136271941717936057702611353590760264910350908007461017608796615346523540058988167449992518487024446859004438882310531542085285036043152592883575449195583910362791172856839852162570373269478544283277633524498598158305553851613453865194495053729302962901703553229444381103595252984790145070858562104457975534730047732365605755937444048769744485827845061817037628182186427770204522469068624647472264064569426544680972157758691121658688990513514036509414627806006329894255649821410175487287365779725218517487681111748974451116437946344069566733818242576313643547732475420065982731858086107426767274910152670040803409732941266245035496247259723152640225748590782885836636990775192021897875026371129040762952654189122074070134240045230662052660896033323152221926198019921578524846978515200779832596652515468167612680596167499678760514280449094234901145700313185777950818739079118012447925069095762787925518663887118214015577714550891665097290312340698807209997250481868050937340630034271759662964717073521541874669379476802623614329821363657639259910909996822625515675741374093205599131494309759229198242434227027018104916686303413694540708849131961812185067490927492680945475899099672119232379463799164124178119767218025267135831445335836952336835847867567919673598311703759921807390284869606013973972780270242057156727634000117251115561588514179075718273724185093936202637039566232682192230435814158659533007660
9022350465366174997283847919398349945633938016104425583860172324176263489361275975009667593038004932687667364874105163892462496885314014908643263326856000372859576083332702726365803964965612459510217293945742324165460877668241497276551342282668646943574832458113160585492183415883647501781717889558978865392772224541065392167546673474741614500160191418704984200050694178212870182632344324620453956363326887681039920226446997083272316385388521326434541090517952433950525433228949943207791117617336586597055185835636143165579863319669227381265651295860327700836191420851833096352355364158455759936349295324840755532195834786495480749596555898829057263924800464318647317952410319136211113196702055469248878152343235293998428488219981553746620981330409457732609587036046817990777041527282479214574080206817435928277059939288849600459911021713775937897892405355254315126569107158564247999317316718483427722955425855482016244411019914948488735880721210735665656305032527979084088502142907014707379774982155237461271110239643442182704616997425509588170510879119957191445286648203735778500178463935047229793523710938940856892769255975677373946536876820289525221586274769960397963148312478510933866595260166008038569943390972312367027678277018588806705436630234745017725533598917717696661761449981454029132906017277890180578422965195412928393259881214603112162460466262100899824011347518062666252858555941834289631186666429499627092672893054716300985128012323278130308495384439455957536346032612317933114304839933084600855909538890414149728987486776084216057289261871588036905157527996581095566604827725585895684627520610720098597049758606548020143513068135008827983614484292230055034970426323155692818336187550647113038707593592987411380313998875932511436736623239997851326877111264915889575138246573980849287148083870425370090874853968611767112024269808843297017204512317422795496511790069287123620934712807235016574232281446632747065243918688321172769768658035768847021747500202496722098981212122723426191 1058699994567456386051988099789906882282897056928675755897254621570366716449454996510283857083638192071817008530465247043578186434946918889294028568301273439962763818506148971675827938163894743053955607916598088803436520189938566781998950556796212499308212484403252622244410854944843773844980312966376343035622063664095184066333372673908829539425847847206454811981326317035401090156833262316513361800521426521383595068854784432026040111597545873126659983942386459273309399974438683726439761945113432389174952261210527484801478796707480533295702234777525452119176262505758000228932395859429139171755900855071518192355754722709499778279693842086613937782438036359676996800592750727234184052949718377088872899573216353728562388287307027850207917859490190081507157679337228065576520106615049007029460254789103989366854896829904728977024077299283132011778098938254310701807712024600935370235989779568324535443330251228660632530337167126327167912382026646507946716969152055758403581590759923975869874087571459658748959086489064871939742478982007277060690969983202505547220593809031772514573276417779804628787991237258838355748174562331235599037687611604915645017218355720699759416558858588985701341050750427674194123540281510484826183918089145486307559577717585044119195043067814506514474786200819408641903796159506347022266070908808297970362892218690867230134703308210585876923845041275614783063315239645775161182566313752305923434347670359998750065723006373705860782512535436814574474916656191776450075760117559564015284594489869981194881114382637138897114031534838077775401813552085067025360920160057552244831151970638692864423056108291008227979430237708815473134005273435451176611310212116248360141662693085865512927552718250808087969470342138952876789139143434474670501618870770400636743385571856286514152985116257532012850617197129445628408472091102178936374730408150742184376561351372601819061860584012814517350674350028052326401079723189881610955613598594550278154987155449961930333156849417263850 90291778555653550716493489542237092648376821343798066802396897320460083119408035125492774024615043460383542670677842854482720262234910465211522006855178566450306801553545149409367071043366034468190885139742859118664420300214443797916430078105503270756280470328263948869263628832479836714863450254567147551271091848613597295161427210316689678422338676771168867022949759981033926294153106622753829408728375980226896095079451901665967219962815675542238174816566644168754300066032630267719430542526513296155344107610505357310272044998227163107602477626814962864721885126262509683187862901808919508311763657336634522653548788245491512003117918076084793361550686098426584796821463542209737852661794754725450661638101737144533890630719128116166022033987180830784663532448695424837519682575788580641992175491112019952780415124223753556516014129256436602247328153727225076752804162498634047964081458669545437057156523163544840185411186996833128555354855257353453509644619678610825845149317482672436540525725916754095931545261993786086245740912590651063958878198048186776177585955323087390626661758696600467288998427845007776090373208635964455924721808169796255326531528474320908057724474007272029423689869138010576148743138517158964539044652950682900907114535359200803856270595331575177719023985693615634599353953547497517828427555951982457134348280741098108778513306873950292762724992282424481810778898240414609079188685467032694027139207991169681691089307681827757093331790950778147228110693442952443348767327939497054118087236782343905763684171896427338823079523838936953603935676502049900624123670462843014651117999508751852193500562573635554259610600582586095461030961795432841724225498060925298912635795202587530522522877561469815756657208161699603814540000180968487882246505488910918137135036046842825020083849435984261455192124801811574873036423197033315924382761958950762329982789532467565514400279651575019202638122056269706846436324142958722187158801617988013399462193181028632790588614321674250
42034625645597317079759786587567597620818135981519245116964305703195585958588137015319643208245432495445385228776918868137278793634039559082988064708878845215760464045435638349276604395244516982648968811193870005073490149079749988896567680372252938535440043711885833247299877739281291945721732219548220032031361897433419552731756188491608326088200563733880701894506679097474652849163815735196431967789681086040936911921259759140949151028601293289531220073210871108161977945133946335633911965723537384129641123185144281108735611315874021499737099153455246366735472569884441236762624268813540966600366572845616962438136560377549611751529168951940843130701211441910032966428554877803642477806895439169839498006165622838076122086892663854008685851048975354096526669750089694798655644849811524468234431980953265011647901904607257484260299377279025716663748286465855327746591416567251338358030334965777613873995033560755074094018961728450653388971685618835605349524415220665996064057644276171179883318244148681424281495607004028836111527303639653542646499001391727251684600256798372206030464612151222381648282338056353779638751829472031597084040184284856450132453699705265626187668901617408812678209890631896542839806230749056471150280344691655112588170467225917434916720983195909005227353991431589051370836357198884276999781624617864755660032200090322660887634120840547002704663072688612325248736893516235951979665246219640176473804111847803055996402592598901957659786987402990527359813292276370341857756399112068520078347241912655854243544103036343280733288656531684215269564624026269009850991140630471356262178237024658348271863517588987526515341583602432034531157650806000598353956255264515095785459727103878142305598828598013631276999877805049611197369783793459410118823597772491040504676767558953022390840253609096489921574511147593494514798226210630688817315826047329610735034953240721838195466860963172133519087929050342121960466161718074272809726634064842934722244243233313371232626401688761869203 14318694548450178955732351939004055266562398661702795582425519810966507508854578807695360148251306221959608022229782583473972069368827803090486843176421946300758304055804640646350451574217622333462637333695107471842536420426307571744050340977886833263243402211201718040174887618334950559341064884177183626659551835243802122974095175062667601895966119822102014089697200954709670703122405808224060542246226380066742721963281039913720136183196909018640046660036828149751015464724416362123027922215667451098805881549847617518967353533276586076219206989092983976735291322426266496178572094944079562926758576758995851321052043660453029305185123174434137405231656099859171807410123225286587442443698805523052163194439851740402619473556113431874499707430440328967435073617760408980909690113551697122565359752661044695205174417214058952639858037928539771569689381771011930748458443203910314170400449759775142177259696608615960672520283038705347325258932766329386266007063224434367170242322297324510238400739648039102932191663551030780817913512008465216433104478646835232909034121830606598804331066677002015096590150806609968008188901879526887996402914511695431164804438067898396652670162587135304605368494894011155311574290644272131809434693932838650350545645541411492266863451082436733594122144246826208121855480203014748912125205336468257370385198878125276766090949423005507565767450097409145392650842132779705398036118330873918471908594709300830522117006970393459722846209838558355747425205287117867871710030279448100684435606811188471296325847574723832379715963751177784455176172284683363980454246986142817712297387131169677294828557137362786594662141014231730670327101372124317917223429276711271944805939461614344495928850457673121752822775772826973312002865692332622120290552734056511165792619412996081476985203765802430125716713507892299022963452891946713297536100753376939290767181104499742765323346488336921953739729936390013452688584309139846950933889077360963752270188632984752144816994603199233100 4571197952220902642199822260426493649174810582709202279035389490325773583696103638593361743562743193231240756081956826958411672562481519294584659826182348040731696539364525821109014958123599098074636455488258018399601145233714028974829597636751851506383165461260945491930881077206718227733809267062263893043331978843529490079522814978320169067785856719003158410021831780988623287289746342834259072800282262374878844964426430939689378224698917053865591830977977335164752606209112101990896596068473347520334218852346920594155205772675878912672532597016053201206400176298024294489656125349812623291181821859253110854540672818604642666783187884037001940338411786929111179925015039680202133532451634817597245820709721142010637750091163778221348936594714731062601416058910756823859846509466385937452069699191666042909860547578174127751627988561968921554572409169567872909314025796042870249840392080634810080294767283114828391755042573541855747541329726309111084701233673963662274839780266337938654555897865710637879352946582495222470955558041080165095018998173173159846782186843305288131059363326556540086679910935167560819550476491039849469228262876401839146953378291886160450076613263875094854180279611008895691314320837275588147552657315990677501507166948521124343525115740662851885560364182407962911286638750325126729606979660946803787756078220784506691812096267182601073864824582018953124723298409658282240551932951095510878096999399781099349182393606838852883232721982562559603741171502918412089894118997685230632518536793384656581578444262189481829840774492154923474661940666906688030248811541197285916358878784030362021788057670200721228914618579994312933588153960283591269950692938445607566561080156280559559315393298039082228289490343747716749870005173203032748275295004067530267950701091570860738672847122281103852689139506733255009158105467859238497297821097803409517169521962285291268852157160744181660479847051968748480614600415494828230176101789441913305487597506279154665132704288880974940

```
### 样例输出 #3
```
78299676090881850562479442596885275232341121074278284851478038310345605992517416134561135341691055886772955171566391029800095806748004727326149614594477633642501025027105267183304810244258038228176248773230874083637980620093474929422222851518823355752827203418869069433751519250333873153097071840500699588916542538447569700689930504513184464145079269997987022553668233664350370195968477428116268848290669358107858811522148619871920710981672188608584950983636266602738161753861068645022137817119400093
33097265104199847767189488302651072543382318177434155466448252805425338433107915048908262248908210605754161313401514020013238362579336071970484568247433877586812519908303621039304597746898538004923923337546359645832338136260806672116305031259289676295245048442077286436335999136942798650764900279884341078712268507817476698605715392827762653005304862900768755495669034237632813800483492727251821394658766505741199857751899054637489537901717408616749876825713942503519167615678504972110465590743589443
9039633520156376052571730787353957079218872301970532684737975064714828387766080658480879047539494337793677137312234019438325177991546539704031533877323308344149474402822810987150317424359078551265796314678815105692150911475701567040681691802567308571921285556799768816593159863834666015001095780223873524280253058765456143028713605830375063004586136882448530457457981532186293023299682526217377981044598900399179325983760427538804107941558612293290577811036690795649204510230495180413191241919591931
-1
345842586075250271329088769074411195793511356766356527703943320748214365271138843316516258596305375028542576680157444882243643142248317696230661057511516236952699650936240331966032021713048567887768062203966070478934410111722160861271229518949484333123957284295154581562705552499868735559991458433681077989986062463722907020587333763822524960016511895616189022380422921068900128254086668985976564414809727660790260268758659004391480796809495625540323266397876403734146514134074566238130439903612537
15348719271514799433842321797859554467814730772066621589799846025233366813265861892039310804110788794332439462342882640669701285931800527775380896000511733356643764536626810975968978888178770741349966923101948427120897671615356056325256321575097927871563213098334622325814777811944516732961149712727202431023929504767869151198954481749841131119057890374377884205448114125940593167670330502015253855127269096179100009294709341966737209579540246593117860314357986022108349627814476930358381574273419139
28728904028390938914156967079088017722688187091773547521319035516456899488083810007314403608864620463310961904307727019313270206486805654570695060662937057757479961855520191690824360362753701494066750891955731378582661279403074738173298502477708455101416811455414291738449695238597379444936341998284262838648724405952400496704034403625221144556679983883479964945931860876387183116230403891183965239047830442433724986111814129974935985568911642062675252992624546378365710213787090670646521825174304831
32454982476168113503128623934856095908542906720926673867332114372725430950168035868658685349991750495139364137274536490156026645338311791401186669165593337157285046496651954352095827455003764047049976002481015890242989430394538551670322689517626782880896242177870592325552815582417040884548255771629553492966719603684419526132318653162420620189935135940293661201457332826717103854473442219366012490280459301445038705063145194278882808329858541143564361692598343873304008549795689036557193665879213995
59649030133765641301536952303827256284404117457008067900601727216701103277257124326268774170481334749522093819176526413201600969156420065141885345899376919941993501075267014556750707900827638877492792093513765617385074209138498984801423840159419298856581191434292450620727995643185026734134960512998148170269282601724877080394092620068805582357663445183114233556687765320240174791814384848769967716788415919739456599503140656755246564285380626812361070394135603887532529416448483300351439067115491629
72579315571073433647251940755485905519831002112522565153699016653688657019846088445799095126084773051551178401160027429648878285287660551880804223309566823084169969860459355489791651437849537256359630534034267594249201733810572183765420029170840233463255233381114571837650234144211281743417503112511743626923284974539750788245158006833580300672567927831235726684880957261018123067990357928900821615738184219991803888329354150620144054935516045495832489018163428138154428998737456807348422412222387917

```
## 提示

**【样例解释】**

对于第一组数据，$a=1,b=2,c=3$，此时 $b,c$ 已经互质，$n=0$ 是一个解；

对于第二组数据，$a=1,b=3,c=6$，取 $n=2$ 时有 $an+b=5$，与 $6$ 互质，因此是一个解；

对于第三组数据，$a=2,b=2,c=2$，于是 $an+b=2n+2$，对于任意 $n$ 都有 $(an+b,c)=2$，因此不存在这样的 $n$，故输出 `-1`。

**【题目来源】**

来自 2021 清华大学学生程序设计竞赛暨高校邀请赛（THUPC2021）。

题解等资源可在 [https://github.com/yylidiw/thupc_2/tree/master](https://github.com/yylidiw/thupc_2/tree/master) 查看。


---

---
title: "[THUPC 2022 初赛] 最小公倍树"
layout: "post"
diff: 提高+/省选-
pid: P8207
tag: ['2022', 'O2优化', '图论建模', '生成树', 'THUPC']
---
# [THUPC 2022 初赛] 最小公倍树
## 题目背景

听说有人嫌题面描述都太长了。
## 题目描述

对于任意 $V\subset\mathbb{N}^*$，$|V|<+\infty$，构造一张无向完全图 $G=(V,E)$，其中 $(u, v)$ 的边权为 $u,v$ 的最小公倍数 $\mathrm{lcm}(u, v)$。称 $G$ 的最小生成树为 $V$ 的最小公倍树（LCT, Lowest Common Tree）。

现在给出 $L, R$，请你求出 $V={L, L+1, \cdots, R}$ 的最小公倍树 $LCT(V)$。
## 输入格式

输入仅一行，包括两个正整数 $L, R$。
## 输出格式

输出一个正整数，表示 $LCT(V)$ 的边权和。
## 样例

### 样例输入 #1
```
3 12
```
### 样例输出 #1
```
126
```
### 样例输入 #2
```
6022 14076
```
### 样例输出 #2
```
66140507445
```
### 样例输入 #3
```
13063 77883
```
### 样例输出 #3
```
3692727018161
```
### 样例输入 #4
```
325735 425533
```
### 样例输出 #4
```
1483175252352926
```
## 提示

【样例解释】

其中一种最小公倍树上的边为 $(3, 4), (3, 5), (3, 6), (3, 7), (4, 8), (3, 9), (5, 10), (3, 11), (3, 12)$。

【数据范围】

对于 $100%$ 的数据，保证 $1\le L\le R\le 10^6$，且 $R-L\le 10^5$。


---

---
title: "[THUPC 2022 初赛] 骰子旅行"
layout: "post"
diff: 提高+/省选-
pid: P8208
tag: ['动态规划 DP', '2022', 'O2优化', '期望', 'THUPC']
---
# [THUPC 2022 初赛] 骰子旅行
## 题目描述

在乐队 f 开巡演之前，按照惯例是要先组织乐队成员进行骰子旅行放松身心的。一次骰子旅行包括 $N$ 个地点，这些地点分别标号为 $1, 2, \cdots, N$。乐队成员们事先约好在 $s_0$ 处集合；而到了骰子旅行当天，大家都来到了集合地点 $s_0$，骰子旅行就算正式开始了。

骰子旅行的一大乐趣就是由骰子决定旅行的下一个目的地。当然，这个骰子不一定非得是六面的。我们可以认为，如果当前乐队成员们位于地点 $i$，那么下一个目的地会等概率地从 $m_i$ 个互不相同的候选地点中产生，这些候选地点分别是 $l_{i, 1}, l_{i, 2}, \cdots, l_{i, m_i}$。我们记第 $t$ 次投掷的结果是 $s_t$，那么第 $(t+1)$ 次将会前往 $s_t$ 处掷骰子。第 1 次投掷在起点 $s_0$ 处进行；而由于乐队之后还需要为了巡演排练，事先约定无论前往了哪些地点，投掷完第 $T$ 次骰子，前往 $s_T$ 后骰子旅行都得结束。

当然，享受 $s_0, s_1, \cdots, s_T$ 这些景点也是骰子旅行的一大乐趣。无论是否之前来过，每次到一个地点 $s_t$，乐队成员们都会尽情地浏览美景，品尝美食。只是如果之前来过 $s_t$，负责掷骰子的键盘手 S 在掷这第 $(t+1)$ 次骰子之前一定会说：“上次来到 $s_t$ 仿佛还是上一次 $t'$，上一次在这里掷出了 $s_{t'+1}$，不知道这一次会掷出什么结果。”鼓手 Y 特别喜欢废话梗，所以每次 S 说这句话时，他都会把 $s_{t'+1}$ 记下来。特别地，如果 $s_T$ 是之前经过的地点，那么 S 会说：“上次来到 $s_t$ 仿佛还是上一次 $t'$，上一次在这里掷出了 $s_{t'+1}$，不过这一次就不投掷了，因为骰子旅行到这里就要告一段落了。”当然，Y 也会把这个 $s_{t'+1}$ 记下来。

作为这次骰子旅行的总结，Y 会把所有记录下来的 $s_{t'+1}$ 加起来，作为 S 的废话指数。

f 的下一次巡演马上就要开始了，于是 S 又盘算着带大家去参加骰子旅行。听说你是 f 的粉丝，S 找到了你，希望你能帮他算一下他这次骰子旅行的废话指数的期望值。
## 输入格式

输入的第一行包括三个正整数 $N, s_0, T$，分别表示可能涉及地点的个数，骰子旅行的起点和骰子旅行中投掷骰子的次数。

接下来 $N$ 行，第 $i\ (1\le i\le N)$ 行先输入一个正整数 $m_i$，表示地点 $i$ 的下一个目的地的候选地点数；接着输入 $m_i$ 个正整数，表示这 $m_i$ 个地点 $l_{i, 1}, l_{i, 2}, \cdots, l_{i, m_i}$。保证对于任意 $i$，$m_i$ 个输入的地点互不相同。
## 输出格式

输出一个数表示废话指数的期望。假设废话指数的期望化为最简分式后的形式为 $p/q$（即其中 $p, q$ 互质），请输出 $x$ 使得 $qx\equiv p \pmod{998,244,353}$ 且 $0\le x<998,244,353$。可以证明，在本题数据范围下，$x$ 存在且唯一。
## 样例

### 样例输入 #1
```
5 1 2
3 2 3 4
2 1 5
2 1 5
2 1 5
3 2 3 4
```
### 样例输出 #1
```
499122178
```
### 样例输入 #2
```
7 1 4
6 2 3 4 5 6 7
6 1 3 4 5 6 7
6 1 2 4 5 6 7
6 1 2 3 5 6 7
6 1 2 3 4 6 7
6 1 2 3 4 5 7
6 1 2 3 4 5 6
```
### 样例输出 #2
```
274979351
```
## 提示

【样例解释 1】

对答案有贡献的方案为：从点 $1$ 出发走到 $2, 3, 4$ 中的任意一个点并返回点 $1$。对于某个点 $i (i=2, 3, 4)$，走到点 $i$ 并返回点 $1$ 的概率为 $1/6$，而贡献为 $i$，故期望为 

$$\frac{1}{6} \times (2+3+4) = \frac{3}{2} .$$

由 $499122178 \times 2 = 998244356 \equiv 3 \pmod {998244353}$ 可知 $3/2$ 在模 $998,244,353$ 意义下为 $499,122,178$，所以正确输出为 $499,122,178$。

【样例解释 2】

转换前的答案为 $1625/432\approx 3.761574$，而 $432\times 274979351 = 118791079632 \equiv 1625 \pmod{998244353}$，所以模意义下的答案为 $274979351$。

【样例 3】

见附件。

【数据范围】

对于 $100\%$ 的数据，保证 $1\le N\le 100$，$1\le T\le 100$，$1\le s_0\le N$，$1\le m_i\le N$，$\sum_{i=1}^N m_i\le 5000$，$1\le l_{i, j}\le N$，且 $\forall 1\le i\le N, \forall 1\le j_1<j_2\le m_i, l_{i, j_1}\ne l_{i, j_2}$。


---

---
title: "[THUPC 2022 初赛] 挑战"
layout: "post"
diff: 提高+/省选-
pid: P8213
tag: ['动态规划 DP', '2022', 'Special Judge', 'O2优化', 'THUPC']
---
# [THUPC 2022 初赛] 挑战
## 题目描述

**足够聪明**的 Alice 和 Bob 在玩一种棋盘游戏。这个游戏需要用到一个有 $(n+1)$ 个格子的长条棋盘，按从左到右的顺序给每个格子编号 $0, 1, \cdots, n$。除了编号为 $n$ 的格以外，每一格都有两个数 $p_i, q_i$。游戏开始前，将一个棋子放在第 $0$ 格。游戏由二人轮流操作，这里我们不妨假设 Alice 先手。

轮到其中一位玩家进行操作时，这位玩家可以根据当前格子的 $p$ 值决定前进的步数。具体地说，假设当前棋子位于第 $k$ 格，那么当前进行操作的玩家可以将棋子向前移动 $x$ 格，其中 $x$ 可以是满足 $1\le x\le p_k$ 的任意整数。如果玩家没有走满 $p_k$ 格，即 $x<p_k$，那么该玩家可以在完成移动后选择是否进行一次挑战。如果选择不进行挑战，那么由另一位玩家进行下一轮操作。否则，如果当前玩家选择挑战，那么系统将会产生两个随机**整数** $u$ 和 $v$，其中：$u$ 表示挑战的能量，它在 $\left[1, p_k-x\right]$ 中等概率产生；$v$ 表示挑战所需的活化能，它在 $\left[0, q_k + q_{k+x}\right]$ 中等概率产生。根据 $u$ 和 $v$ 的值，系统会根据以下规则自动判定挑战结果：

如果 $u>v$，则挑战成功，对方玩家的操作被跳过一轮，由当前玩家继续操作；
如果 $u=v$，则挑战结果为平手，什么事情都不会发生，由对方玩家进行操作；
如果 $u<v$，则挑战失败，当前玩家下一轮操作将会被跳过，即对方玩家可以连续操作两轮。
为了防止其中一方玩家一直被跳过，规定：

如果当前玩家通过自身的挑战获得额外操作机会，则该玩家在该额外操作机会中不能进行第二次挑战；
如果当前玩家通过对方玩家的挑战获得额外操作机会，则该玩家不能在其第一次操作结束时发起挑战，只能在第二次操作结束时选择是否进行挑战，并且当且仅当挑战成功时可以进行第三次操作。
需要注意的是，无论连续进行多少次操作，每次操作都需要将棋子向前移动至少 $1$ 格。同大多数游戏一样，谁将棋子移动到终点（即编号为 $n$ 的格）谁就获胜。

Alice 和 Bob 都足够聪明，可以心算出对于当前棋子的位置，能使自己获胜概率最大的操作。作为一名旁观者，你没有他们那么强的心算能力；但是你也想通过自己编程的能力，计算出当 Alice 先手从第 $0$ 格开始进行操作时，Alice 的胜率。
## 输入格式

输入的第一行包含一个正整数 $n$，表示棋盘包含 $(n+1)$ 格，分别标号 $0, 1, \cdots, n$。

输入的第二行包含 $n$ 个正整数 $p_0, p_1, \cdots, p_{n-1}$，分别表示第 $0$ 格至第 $(n-1)$ 格的 $p$ 值。

输入的第三行包含 $n$ 个正整数 $q_0, q_1, \cdots, q_{n-1}$，分别表示第 $0$ 格至第 $(n-1)$ 格的 $q$ 值。
## 输出格式

输出一个实数，表示 Alice 先手开始游戏的胜率。当你的输出与标准输出的绝对误差不超过 $10^{-6}$ 时，我们认为你的输出是正确的。
## 样例

### 样例输入 #1
```
3
3 3 3
1 2 3
```
### 样例输出 #1
```
1.000000000000000000
```
### 样例输入 #2
```
3
2 3 3
1 2 3
```
### 样例输出 #2
```
0.250000000000000000
```
### 样例输入 #3
```
10
2 1 4 7 4 8 3 6 4 8
3 1 4 1 5 9 2 6 5 3
```
### 样例输出 #3
```
0.833333333333333333

```
## 提示

【样例解释 1】

Alice 先手，由于可以直接从第 $0$ 格移动到终点的第 $3$ 格，Alice 会直接将棋子移动到第 $3$ 格，故 Alice 必胜。

【样例解释 2】

Alice 先手，但是不能直接移动到第 $3$ 格，并且无论结束操作时棋子在第 $1$ 格还是第 $2$ 格，Bob 都可以直接将其移动到终点的第 $3$ 格，因此 Alice 必须尝试挑战。将棋子移动到第 $1$ 格并发动挑战，挑战成功的概率为 $1/4$，故 Alice 的胜率为 $1/4$。

【数据范围】

对于 $100\%$ 的数据，保证 $1\le n\le 100000$，$1\le p_i, q_i\le 333$。


---

---
title: "[THUPC 2022 初赛] 画图"
layout: "post"
diff: 提高+/省选-
pid: P8216
tag: ['2022', 'O2优化', 'THUPC']
---
# [THUPC 2022 初赛] 画图
## 题目描述

一年两度的THUPC又要来了，小C和小Z作为参赛无数届的老选手，自然也要来凑一番热闹。不过因为已经是老年人了，参赛自然是免谈了，但是他们对THUPC几年不换的logo产生了审美疲劳，为了更好地吸引大家报名，他们打算重画一个更花里胡哨的。

笑死，你怎么可能指望两个宅男码农有丝毫的艺术细菌？

他们深知这件事不在自己的能力范围之内，于是打算写一个人工智障来帮自己来画logo！

经过不懈的努力，他们的人工智障终于能跑起来了，不过他们很快就发现这个人工智障比自己还没有艺术细菌——它只会在平面上画水平和竖直的线段来拼成“THUPC”字样！

不过程序写都写了，不用白不用。小C和小Z针对程序的这一特性进行深入研究后制定了这样的规则：

对于每一条水平线段，设其横坐标区间为 $[l_i,r_i]$ ，纵坐标为 $y_i$； 对于每一条竖直线段，设其纵坐标区间为 $[d_i,u_i]$ ，横坐标为 $x_i$ 。上述所有数值均为整数，且满足$r_i > l_i,u_i > d_i$。

“THUPC”字样应当由 $15$ 条线段拼成，设其编号为 $1 \thicksim 15$ 。对于每一个字母，规则如下：

字母"T"由 $1$ 号水平线段和 $2$ 号竖直线段组成，满足 $d_2<y_1=u_2,l_1<x_2<r_1$ 。

字母"H"由 $3$ 号竖直线段、$4$ 号水平线段和 $5$ 号竖直线段组成，满足 $d_3=d_5<y_4<u_3=u_5,x_3=l_4<r_4=x_5$ 。

字母"U"由 $6$ 号竖直线段、$7$ 号水平线段和 $8$ 号竖直线段组成，满足 $d_6=d_8=y_7<u_6=u_8,x_6=l_7<r_7=x_8$ 。

字母"P"由 $9$ 号竖直线段、$10$ 号水平线段、$11$ 号水平线段和 $12$ 号竖直线段组成，满足 $d_9<y_{11}=d_{12}<u_9=y_{10}=u_{12},x_9=l_{10}=l_{11}<r_{10}=r_{11}=x_{12}$ 。

字母"C"由 $13$ 号竖直线段、$14$ 号水平线段和 $15$ 号水平线段组成，满足 $d_{13}=y_{15}<u_{13}=y_{14},x_{13}=l_{14}=l_{15}<r_{14}=r_{15}$ 。

生成的这 $5$ 个字母可以排布在平面的任何地方而无需从左到右排列，但是组成任意两个不同字母的任意两条线段不得相交。

需要注意的是，人工智障给出的线段顺序可能并不按照上述编号顺序；另外，给出的线段可能出现同方向线段的首尾相连、重叠或包含，此时应将其视为连续的一整条线段。

只有生成的线段在连接和排序后符合上述规范，才认为人工智障生成了一幅正确的logo；否则，如果出现多余的线段、缺少某条线段或坐标不满足要求等情况均为不正确的。

最后，小C和小Z要写一个程序来检验人工智障的每一份输出结果是否符合上述规范，不过熬夜连肝三天的他们终于累得爬不起来了，于是他们请你来帮忙。
## 输入格式

第 $1$ 行：一个正整数 $n$ 表示线段的个数，保证 $1 \leq n \leq 10^5$ 。

接下来 $n$ 行，每行先输入一个整数 $op_i$ ，必定为 $0$ 或 $1$ ：如果 $op_i=0$ ，表示第 $i$ 条线段为水平线段，接下来输入 $3$ 个整数 $l_i,r_i,y_i$ 描述这条线段，保证 $l_i<r_i$ ；如果 $op_i=1$ ，表示第 $i$ 条线段为竖直线段，接下来输入 $3$ 个整数 $d_i,u_i,x_i$ 描述这条线段，保证 $d_i<u_i$ 。

保证输入的坐标均在 $[-10^9,10^9]$ 范围内。
## 输出格式

如果符合规范，输出一个字符串 `Yes`，否则输出一个字符串`No`。
## 样例

### 样例输入 #1
```
17
1 0 5 2
0 0 3 5
0 3 4 5
1 2 7 7
1 2 7 10
0 7 10 4
0 11 13 1
1 1 7 11
1 1 7 13
1 0 6 15
0 15 16 5
0 15 16 6
1 5 6 16
1 3 6 18
1 4 7 18
0 18 21 3
0 18 21 7
```
### 样例输出 #1
```
Yes
```
## 提示

【样例解释】

![](https://cdn.luogu.com.cn/upload/image_hosting/oomfukad.png)

这组样例中，字母 `T` 的水平线段和 `C` 的竖直线段分别是由两条线段拼成的。


---

---
title: "[THUPC 2022 决赛] 简单的卡牌游戏"
layout: "post"
diff: 提高+/省选-
pid: P8414
tag: ['2022', 'O2优化', 'THUPC']
---
# [THUPC 2022 决赛] 简单的卡牌游戏
## 题目描述

Alice 和 Bob 最近玩了很多复杂的游戏，于是他们想玩点简单的游戏放松一下。

他们想起来有一种非常简单的游戏叫“憋七”，这种游戏只需要一副扑克牌就能玩。传统的“憋七”玩法稍微有点复杂，所以 Alice 和 Bob 打算玩一种简化版的“憋七”。

在游戏中用到的扑克牌包括黑桃（Spades）、红桃（Hearts）、梅花（Clubs）和方块（Diamonds）四种花色，每种花色的 1 点至 13 点各 1 张，共计 52 张牌。

简化版的游戏规则如下：

1. 首先将一副 52 张的扑克牌平均分成两份，每份各 26 张，Alice 和 Bob 各拿一张；

2. 拥有黑桃 7 的一方将手中的黑桃 7 置于场上；

3. 接着，从另外一方开始轮流操作，每一轮玩家需要从自己持有的牌中挑选一张置于场上，可以打出的牌需要满足以下两个条件之一：
   
   - 这张牌的点数为 7；
   
   - 当前场上的牌中，有一张牌与将要打出的牌花色相同，点数恰好差 1。

4. 如果当前进行操作的玩家不能按照规则打出一张牌，则判该玩家负，另一位玩家胜；否则，如果双方都打出了手上的所有牌，则判平局。

由于该游戏中不同花色的接龙是独立的，游戏时玩家常常将不同花色的 7 对成一竖排列，并在 7 的两侧接龙，将同花色的牌排成一行。

已知 Alice 和 Bob 都足够聪明。现在给出 Alice 和 Bob 的初始手牌，请计算当二人都按最优策略出牌时，游戏的结果。
## 输入格式

由于可以从一个人的手牌推断出另一个人的手牌，因此输入仅包含 Alice 的所有手牌。

输入仅一行，包括 26 个用空格隔开的字符串，每个字符串表示 Alice 手上的一张牌。

每张牌的输入格式为 花色 + 点数。其中，花色由一个字符表示，`S` 表示黑桃，`H` 表示红桃，`C` 表示梅花，`D` 表示方块；点数由对应的一位或两位的数字表示，数字最小为 `1`，最大为 `13`，均不含前导 0。例如，黑桃 7 对应字符串 `S7`。

## 输出格式

输出仅一行，包括一个字符串，表示游戏的结果。如果 Alice 能赢得这局游戏则输出 `Alice`；如果 `Bob` 能赢得这局游戏则输出 `Bob`；如果平局则输出 `Draw`。
## 样例

### 样例输入 #1
```
S4 S6 S11 S13 H3 H4 H5 H6 H8 H10 H12 C2 C4 C5 C6 C8 C9 C11 C13 D1 D4 D5 D6 D8 D10 D12

```
### 样例输出 #1
```
Bob

```
### 样例输入 #2
```
S1 S2 S3 S4 S5 S6 S7 S8 S9 S10 S11 S12 S13 D1 D2 D3 D4 D5 D6 D7 D8 D9 D10 D11 D12 D13

```
### 样例输出 #2
```
Draw

```
### 样例输入 #3
```
H1 H2 H3 H4 H5 H6 H7 H8 H9 H10 H11 H12 C13 D1 D2 D3 D4 D5 D6 D7 D8 D9 D10 D11 D12 D13

```
### 样例输出 #3
```
Alice

```
## 提示

对于 $100\%$ 的数据，保证输入的牌符合输入格式中描述的格式，且输入的 26 张牌各不相同。



---

---
title: "[THUPC 2022 决赛] 倍增路径"
layout: "post"
diff: 提高+/省选-
pid: P8418
tag: ['2022', 'O2优化', 'THUPC']
---
# [THUPC 2022 决赛] 倍增路径
## 题目描述

对于任意一张 DAG $G=(V,E)$ 和图中的一个起始点 $s_1\in V$，倍增小游戏的规则为：

- 在第 $i$ 轮操作（$i=1,2,\cdots$）中，玩家选取一条起点为 $s_i$ 的**非空**路径 $p_i$，使得所有属于这条路径的边的边权和恰为 $(i+1)$ 的倍数。如果无法选择出满足倍数要求的路径，则称游戏失败，玩家将不会获得任何分数；否则，本轮操作成功，并记 $p_i$ 的终点为 $s_{i+1}$。

- 在第 $i$ 轮操作成功后，玩家可以选择结束游戏或者继续第 $(i+1)$ 轮操作。如果选择结束游戏，则称选择出的 $i$ 条路径 $p_1, \cdots, p_i$ 为倍增路径，并计算得分。

如果游戏没有失败，则在结束游戏时，对于选出的倍增路径 $p_1, \cdots, p_k$，定义游戏的分数为 $\sum_{i=1}^k a_i \left|p_i\right|/k$，其中 $|p_i|$ 表示路径 $p_i$ 包含的边数，$a_i$ 是输入给定的权值。显然，无论如何选取路径，最多也只能选出 $(n-1)$ 条路径，因此输入中只给出了 $a_1, \cdots, a_{n-1}$。

为了设置每张图的通关要求，请对给出的 DAG 和起始点，计算该游戏的最大分数。
## 输入格式

输入的第一行包含三个由空格隔开的正整数 $n$，$m$，$s_1$，表示给出的图中点的数量、边的数量及起始点的编号。保证 $2\le n \le 100$，$1\le m\le \frac{n(n-1)}{2}$，$1\le s_1\le n$。

输入的第二行包含 $(n-1)$ 个由空格隔开的正整数 $a_1, \cdots, a_{n-1}$，表示计算分数时的权重。保证 $1\le a_1\le a_2\le\cdots\le a_{n-1}\le 10^9$。

接下来 $m$ 行，每行输入三个由空格隔开的正整数 $u_i, v_i, w_i$，描述图中一条由 $u_i$ 连向 $v_i$，权值为 $w_i$ 的单向边。保证 $1\le u_i, v_i\le n$，$u_i\ne v_i$，$1\le w_i\le 10^9$，图是连通的且没有重边。
## 输出格式

输出仅一行，包括两个整数，由空格隔开。

如果可以选出至少一条路径，则存在一种最优的选取方案使得分数最大，记这个最优分数的最简分数表示为 $p/q$（当最优分数恰为整数时认为 $q=1$），则输出 $p$，$q$。否则，如果无论如何选取都无法选取出至少一条路径，则输出 `-1 -1`。
## 样例

### 样例输入 #1
```
5 5 1
1 11 21 1211
1 2 4
1 3 11
2 5 9
3 4 12
4 5 13

```
### 样例输出 #1
```
6 1

```
### 样例输入 #2
```
9 16 1
1 10 100 1000 10000 100000 1000000 10000000
1 2 2
1 3 3
2 3 5
2 5 7
3 4 11
3 5 13
3 6 17
3 7 19
4 7 23
5 6 29
5 8 31
6 7 37
6 8 41
6 9 43
7 9 47
8 9 53

```
### 样例输出 #2
```
221 3

```
## 提示

【样例 1 解释】

选出的倍增路径为 $p_1 = ((1, 2)), p_2 = ((2, 5))$。

【数据范围与约定】

对于 $100\%$ 的数据，保证 $2\le n\le 100$，$1\le m\le \frac{n(n-1)}{2}$，$1\le s_1, u_i, v_i\le n$，$1\le a_1 \le \cdots\le a_{n-1}\le 10^9$，$1\le w_i\le 10^9$，输入的图是连通的且没有重边。


---

---
title: "[THUPC 2023 初赛] 大富翁"
layout: "post"
diff: 提高+/省选-
pid: P9133
tag: ['贪心', '博弈论', '2023', 'O2优化', 'THUPC']
---
# [THUPC 2023 初赛] 大富翁
## 题目背景

有一天，小 W 和小 H 在玩大富翁。
## 题目描述

这版大富翁的游戏规则比较独特。它的地图是一棵 $n$ 个节点的有根树，其中 $1$ 号节点为根。树上每个节点都有一个价格，第 $x$ 号节点的价格记为 $w_x$。

对于树上两个不同的节点 $x,y$，若 $x$ 是 $y$ 的祖先节点（即，$x$ 在 $1$ 号点到 $y$ 号点的简单路径上），则称 $x$ **支配** $y$。

游戏过程中，小 W 和小 H 轮流**购买**树上的一个未被人购买过的节点，直到树上的 $n$ 个节点都被小 W 或小 H 购买。（游戏开始前，树上的所有节点都没有被购买。）

对于一次购买，假设买方购买了 $x$ 号节点，那么他首先要向系统支付 $w_x$ 个游戏币。假设此时 $x$ 支配着 $n_1$ 个已被买方的对手购买了的节点，同时又被 $n_2$ 个已被对手购买了的节点支配。若 $n_1>n_2$，那么对手要向买方支付 $n_1-n_2$ 个游戏币，若 $n_1<n_2$，那么买方要向对手支付 $n_2-n_1$ 个游戏币。

小 W 和小 H 都是绝顶聪明的人，他们都会在游戏中采用最优策略，来使自己赚到尽量多的游戏币。现在，小 W 想考考你：如果他先手，他最终能赚到多少个游戏币？（即，在整个游戏过程中，小 W 从小 H 手中获得的游戏币个数减去他支付给系统和小 H 的游戏币个数。你可以认为，游戏开始前，小 H 和小 W 手中都有足够数量的游戏币。注意：答案可能为负数。）
## 输入格式

第一行一个正整数 $n$。

第二行 $n$ 个非负整数，第 $i$ 个整数为 $i$ 号节点的价格 $w_i$。

第三行 $n-1$ 个正整数，第 $i$ 个正整数表示第 $i+1$ 号节点的父亲编号。
## 输出格式

一行一个整数表示答案。
## 样例

### 样例输入 #1
```
7
0 0 1 0 0 0 0
1 1 2 2 3 3

```
### 样例输出 #1
```
2
```
### 样例输入 #2
```
见附件中的 2.in
```
### 样例输出 #2
```
见附件中的 2.ans
```
## 提示

#### 样例解释 1

一个可能的游戏过程是：

- 第一次购买：小 W 购买 $1$ 号节点，向系统支付 $0$ 个游戏币。
- 第二次购买：小 H 购买 $2$ 号节点，向系统支付 $0$ 个游戏币，并向小 W 支付 $1$ 个游戏币。
- 第三次购买：小 W 购买 $3$ 号节点，向系统支付 $1$ 个游戏币。
- 第四次购买：小 H 购买 $4$ 号节点，向系统支付 $0$ 个游戏币，并向小 W 支付 $1$ 个游戏币。
- 第五次购买：小 W 购买 $6$ 号节点，向系统支付 $0$ 个游戏币。
- 第六次购买：小 H 购买 $5$ 号节点，向系统支付 $0$ 个游戏币，并向小 W 支付 $1$ 个游戏币。
- 第七次购买：小 W 购买 $7$ 号节点，向系统支付 $0$ 个游戏币。

#### 子任务

对于所有测试数据，$1\leq n\leq 2\times 10^5$，$0\leq w_x\leq 2\times 10^5$。保证输入的图为一棵以 $1$ 号节点为根的有根树。

#### 题目来源

来自 2023 清华大学学生程序设计竞赛暨高校邀请赛（THUPC2023）初赛。

题解等资源可在 <https://github.com/THUSAAC/THUPC2023-Pre> 查看。


---

---
title: "[THUPC 2023 初赛] 速战速决"
layout: "post"
diff: 提高+/省选-
pid: P9137
tag: ['2023', 'Special Judge', 'O2优化', '构造', 'THUPC']
---
# [THUPC 2023 初赛] 速战速决
## 题目描述

小 I 与小 J 正在玩一个叫做“开火车”，又称作“拖板车”和“小猫钓鱼”的扑克游戏。游戏规则如下，注意其与一般玩法可能有不同：

- 有 $2n$ 张牌，其中对于整数 $1 \le i \le n$，牌面为 $i$ 的牌恰好有 $2$ 张。
- 游戏开始时，小 I 和小 J 各拿其中 $n$ 张牌组成双方的初始手牌。
- 维护一个公共牌堆（可以将其看作一个栈），初始没有牌。小 I 与小 J 依次行动，小 I 先手。一次行动时，行动方依次进行以下操作：
  1. 将手牌中的一张牌放在公共牌堆顶；
  2. 若此时公共牌堆中有两张相同的牌，则这两张相同的牌以及在这两张牌之间的所有牌从公共牌堆移到当前行动方手牌中；
  3. 若此时当前行动方没有手牌，则当前行动方失败，另一方胜利。

小 J 是扑克萌新，所以会按照以下策略行动：

- 维护一个队列，初始将 $n$ 张手牌按照一定顺序放入队列中；
- 每次行动时，将队列开头的牌放在公共牌堆顶；
- 若小 J 放入某张牌后公共牌堆中有两张相同的牌，则按照在公共牌堆中自顶到底的顺序将获得的牌放入队列尾。

小 I 通过偷看得到了小 J 的策略以及队列中牌的顺序。现在小 I 不仅想获胜，还想速战速决，用**最少**的行动次数获胜，但他也是扑克萌新。所以给定小 J 队列中的 $n$ 张牌以及它们的顺序，你需要给出小 I 的策略，使得小 I 能够获胜，同时行动次数最少，或者告诉他这是不可能的。
## 输入格式

每组数据的第一行一个整数 $n$ 表示牌面的种数。

第二行 $n$ 个整数 $a_1,a_2,\cdots,a_n$，从队头到队尾的顺序依次描述小 J 队列中的牌。

得到小 J 的 $n$ 张手牌也就得到了小 I 的 $n$ 张手牌，因此不会输入小 I 的手牌。
## 输出格式

如果小 I 不可能获胜，只需要输出一个整数 `-1`；否则第一行输出一个整数 $s$，表示你给出的策略中小 I 的行动次数。接下来一行 $s$ 个整数，依次描述每次行动时小 I 从手牌中放入公共牌堆的牌的牌面，两个数之间以一个空格分隔。**注意你给出的策略要满足 $s$ 最小。**
## 样例

### 样例输入 #1
```
3
1 3 3

```
### 样例输出 #1
```
3
2 1 2

```
### 样例输入 #2
```
1
1
```
### 样例输出 #2
```
-1
```
## 提示

#### 样例解释 1

![](https://cdn.luogu.com.cn/upload/image_hosting/m1asrjdd.png)

![](https://cdn.luogu.com.cn/upload/image_hosting/x5w65xlc.png)

#### 子任务

对于所有测试数据，$1 \le n \le 3 \times 10^5$，$1 \le a_1,a_2,\cdots, a_n \le n$，且每个整数在序列 $a$ 中至多出现两次。

#### 题目来源

来自 2023 清华大学学生程序设计竞赛暨高校邀请赛（THUPC2023）初赛。

题解等资源可在 <https://github.com/THUSAAC/THUPC2023-Pre> 查看。


---

---
title: "[THUPC 2023 初赛] 欺诈游戏"
layout: "post"
diff: 提高+/省选-
pid: P9142
tag: ['递推', '博弈论', '2023', 'O2优化', 'THUPC']
---
# [THUPC 2023 初赛] 欺诈游戏
## 题目背景

在《LIAR GAME》中，小 E 看到了一个有趣的游戏。
## 题目描述

这个游戏名叫《走私游戏》。游戏规则大概是这样的：一名玩家扮演走私者，一名玩家扮演检察官。走私者可以将 $x$ 日元（$x$ 为 $[0,n]$ 内的整数，由走私者决定）秘密放入箱子中，而检查官需要猜测箱子中的金额。假设检察官猜了 $y$（$y$ 也必须是整数）。如果 $x=y$，则走私失败，走私者一分钱也拿不到。如果 $x>y$，则走私成功，走私者可以从检查官那里拿走 $x$ 日元。如果 $x<y$，则走私失败，但是由于冤枉检察官需要赔付给走私者 $y/2$ 日元。游戏分有限回合进行。双方轮流做走私者和检察官。

可以证明，最优情况下每个回合走私者会采用同一种策略，检察官也会采用同一种策略。小 E 想知道在一个回合中，双方的最优策略分别是什么。
## 输入格式

一行一个正整数 $n$。
## 输出格式

输出两行，每行 $n+1$ 个数，其中第 $i$ 个表示放/猜 $i-1$ 日元的概率。

第一行输出走私者的策略，第二行输出检察官的策略。

你需要保证，在一方的策略不变的情况下，另一方无论如何改变自己的策略，都不能使自己的期望收益比原来多。

可以证明，这样的策略是唯一的。

答案对 $998244353$ 取模。
## 样例

### 样例输入 #1
```
1

```
### 样例输出 #1
```
665496236 332748118
332748118 665496236

```
## 提示

#### 样例解释 1

这 $4$ 个数分别为 $2/3,1/3,1/3,2/3$。

#### 子任务

保证 $1\le n \le 400000$。

#### 题目来源

来自 2023 清华大学学生程序设计竞赛暨高校邀请赛（THUPC2023）初赛。

题解等资源可在 <https://github.com/THUSAAC/THUPC2023-Pre> 查看。


---

---
title: "[THUPC 2023 决赛] 百合"
layout: "post"
diff: 提高+/省选-
pid: P9377
tag: ['2023', 'O2优化', '最短路', 'THUPC']
---
# [THUPC 2023 决赛] 百合
## 题目背景

葡萄藤上开不出百合花。
## 题目描述

你落在一个巨大的葡萄架上，上面一共有 $2^k$ 朵百合花和 $m$ 条葡萄藤。其中，百合花编号为 $0$ 到 $2^k-1$ 的整数，第 $i$ 条葡萄藤连接了编号为 $x_i, y_i$ 的百合花。

你可以花费 $c_i$ 的时间通过第 $i$ 条葡萄藤，也就是从 $x_i$ 走到 $y_i$，或者反过来；还可以花费 $a_k$ 的时间从 $x$ 闪现到 $y$，其中 $x, y$ 是任意两朵百合花，$k$ 是它们在二进制表示下不同的比特数。例如，$3$ 的二进制表示是 $011$，$5$ 的二进制表示是 $101$，它们有两位不同，因此从 $3$ 闪现到 $5$ 花费的时间是 $a_2$。

假设你恰好落在编号为 $s$ 的百合花上，求从 $s$ 出发到每一朵百合花所需要的最短时间。
## 输入格式

第一行包含三个正整数 $k,m,s$，其含义如题目描述。

第二行包含 $k$ 个非负整数 $a_i$，表示通道花费的时间。

第 $3$ 至第 $(m+2)$ 行每行三个非负整数 $x_i,y_i,c_i$。
## 输出格式

输出一行 $2^k$ 个数 $D_i$（$0 \leq i \leq 2^k-1$），空格隔开，其中 $D_i$ 表示从 $s$ 到 $i$ 的最短时间。
## 样例

### 样例输入 #1
```
3 6 2
17 14 11 
0 2 3
4 2 9
2 2 1
2 2 6
7 0 5
4 2 9

```
### 样例输出 #1
```
3 14 0 17 9 11 17 8

```
## 提示

**【数据范围】**

对于所有测试数据，$1 \le k \leq 17$，$1 \le m \leq 2 \times 10^5$，$0 \leq s,x_i,y_i \leq 2^k - 1$，$0 \le a_i, c_i \leq 2^{30} - 1$。

**【题目来源】**


来自 2023 清华大学学生程序设计竞赛暨高校邀请赛（THUPC2023）决赛。

题解等资源可在 [https://github.com/THUSAAC/THUPC2023](https://github.com/THUSAAC/THUPC2023) 查看。


---

---
title: "[THUPC 2023 决赛] 物理实验"
layout: "post"
diff: 提高+/省选-
pid: P9378
tag: ['贪心', '二分', '2023', 'Special Judge', 'O2优化', 'THUPC']
---
# [THUPC 2023 决赛] 物理实验
## 题目描述

为了验证新提出的猜想，物理学家小 I 需要完成 $n$ 种物理实验，其中第 $i(1 \le i \le n)$ 种实验的重要度是 $2^{-i}$。每种实验仅需要完成一次。小 I 一次只能做一种实验，且在开始了一个实验之后，不能做到一半去做另一个实验，也就是说在没有任何其他限制的情况下，小 I 完成实验的顺序可以用一个 $1$ 到 $n$ 的排列表示。

然而事情并非一帆风顺。有 $m$ 轮宇宙射线，分别会在小 I 完成了 $a_1$ 种、$a_2$ 种、$\dots$、$a_m$ 种（**注意，不是第 $a_i$ 种**）实验后轰击实验基地，保证 $1 \le a_1 < a_2 < \dots < a_m < n-m$。因此小 I 需要仔细地安排实验的顺序。

第 $j(1 \le j \le m)$ 轮宇宙射线会恰好干扰一种实验的实验仪器，其干扰的实验种类按照以下方式确定：

- 给出一个 $1$ 至 $n$ 的排列 $p_{j,1},\dots,p_{j,n}$，其中 $i$ 越靠前表示第 $i$ 种实验对这轮宇宙射线越脆弱。**每轮给出的排列不一定相同。**
- 那么在这轮宇宙射线轰击实验基地时，目前所有**未完成且未被干扰**的实验中最脆弱的一种会被干扰，之后无法进行对应实验。

在以上条件下，小 I 总共可以完成 $(n-m)$ 种实验。小 I 希望它们的重要度总和尽可能大，可是小 I 是物理学家不懂算法，所以小 I 请教于你。你需要给出合理的实验顺序，使得完成的 $(n-m)$ 种实验均未被宇宙射线干扰且重要度总和尽可能大。
## 输入格式

输入的第一行包含两个正整数 $n,m$，表示实验种数和宇宙射线轮数。

接下来一行 $m$ 个整数 $a_1,a_2,\dots,a_m$，表示每轮宇宙射线在完成了多少种实验后轰击实验基地。

接下来 $m$ 行，每行 $n$ 个整数 $p_1,p_2,\dots,p_n$，依次描述每轮宇宙射线的脆弱程度排序。保证 $1 \le p_i \le n$ 且每行的输入均构成 $1$ 到 $n$ 的排列。
## 输出格式

输出一行 $n-m$ 个整数，表示你给出的实验顺序。你需要保证做每种实验时这种实验没有被宇宙射线干扰，且重要度总和最大。如果有多种方案，输出任意一种即可。
## 样例

### 样例输入 #1
```
3 1
1
1 2 3

```
### 样例输出 #1
```
1 3

```
### 样例输入 #2
```
3 1
1
2 3 1

```
### 样例输出 #2
```
2 1

```
### 样例输入 #3
```
6 2
1 3
3 2 4 5 6 1
5 4 1 3 6 2

```
### 样例输出 #3
```
1 4 5 2

```
## 提示

**【样例解释 #1】**

小 I 第一次完成第一种实验后，宇宙射线将会轰击第二种实验的仪器，因此第二次只能完成第三种实验。容易证明该方案达到最大重要度。

**【样例解释 #2】**

在这个样例中，如果小 I 第一次完成第一种实验，那么宇宙射线将会轰击第二种实验的仪器，导致第二次只能完成第三种实验。此时重要度为 $0.625$，而样例输出给出的方案重要度为 $0.75$。

**【样例解释 #3】**

该组样例有多个合法的输出，如 `5 4 1 2` 也是一个合法的答案。

**【数据范围】**

对于所有测试数据，$3 \le n \le 600$，$1 \le m \le \lfloor \frac{n-1}{2} \rfloor$，$1 \le a_1 < a_2 < \dots < a_m < n-m$。

**【题目来源】**

来自 2023 清华大学学生程序设计竞赛暨高校邀请赛（THUPC2023）决赛。

题解等资源可在 [https://github.com/THUSAAC/THUPC2023](https://github.com/THUSAAC/THUPC2023) 查看。


---

---
title: "[THUPC 2023 决赛] 巧克力"
layout: "post"
diff: 提高+/省选-
pid: P9387
tag: ['2023', 'O2优化', '数位 DP', 'THUPC', 'SG 函数']
---
# [THUPC 2023 决赛] 巧克力
## 题目描述

上回你帮小 I 在开火车上薄纱小 J 后，小 J 十分不服气，决定拉上小 I 再玩玩别的游戏。这次小 J 找到了他家珍藏的巧克力。

小 J 准备了 $(N + 1)$ 条巧克力，其中除了第 $(N + 1)$ 条巧克力有 $M$ 块外，其他第 $i$ 条巧克力恰好有 $i$ 块。

游戏由小 I 先手，双方轮流操作，每次操作方可以进行如下操作：

- 选择一条巧克力，将其分成左中右有序的三段，其中**每段必须有整数块，中间一段不能为空，左右两段可以为空**；
- 将中间一段吃掉，左右两段放回游戏。

当某个人操作时没有巧克力了，那个人就输了。

游戏开始，小 I 还没来得及算好最优策略小 J 就连忙催促，于是小 I 只好**在所有的合法操作中等概率随机选择一个进行操作**。小 J 自然是有备而来，每次操作都是最优的；而在这次随机操作之后，小 I 也终于是算清楚了游戏策略，之后的每次操作都是最优的。

小 I 想知道，第一次的随机操作中，有多少种操作能够让他取得游戏胜利。答案可能很大，你只需要输出其对 $(10^9+7)$ 取模的结果。

认为两个操作不同当且仅当选择的巧克力不同或巧克力分成的有序的三段的块数有一段不同。
## 输入格式

**本题有多组测试数据。** 第一行一个整数 $T$ 表示测试数据组数。接下来依次输入每组测试数据。

每组测试数据一行两个整数 $N,M$，意义如题目描述所述。
## 输出格式

对于每组测试数据输出一行一个整数，表示能使小 I 胜利的第一次操作数对 $(10^9+7)$ 取模。
## 样例

### 样例输入 #1
```
4
3 0
3 1
3 12345678987654321
0 0

```
### 样例输出 #1
```
0
4
450617288
0

```
## 提示

#### 样例解释

- 对于第一组测试数据，容易证明先手必败，所以无论怎么操作小 I 都会输。
- 对于第二组测试数据，有以下四种操作：
  - 将第一条巧克力分成 $(0,1,0)$ 三段，将中间一段吃掉；
  - 将第四条巧克力分成 $(0,1,0)$ 三段，将中间一段吃掉；
  - 将第三条巧克力分为 $(0,1,2)$ 三段，将中间一段吃掉；
  - 将第三条巧克力分为 $(2,1,0)$ 三段，将中间一段吃掉。
- 对于第三组测试数据，所有的合法操作都是将第四条巧克力分成三段，其中左右两段长度相同。
- 对于第四组测试数据，游戏只是个幌子罢了，小 J 只是想小 I 输。

#### 数据范围

本题仅有一个 $T = 5 \times 10^4$ 的测试点，对于每组测试数据 $0 \le N,M \le 10^{18}$。

#### 后记

“下次能继续和你玩游戏吗……”

#### 题目来源

来自 2023 清华大学学生程序设计竞赛暨高校邀请赛（THUPC2023）决赛。

题解等资源可在 <https://github.com/THUSAAC/THUPC2023> 查看。


---

---
title: "[THUPC 2024 初赛] 转化"
layout: "post"
diff: 提高+/省选-
pid: P9965
tag: ['贪心', '2024', 'THUPC']
---
# [THUPC 2024 初赛] 转化
## 题目背景

小 E 在玩 Somzig 游戏的时候因为操作时间不够绷不住了，于是就有了这个题。
## 题目描述

小 E 有 $n$ 种颜色的球，其中第 $i$ 种有 $a_i$ 个。有两类工具，第一类可以把一个指定颜色的球变成一个**任意**颜色的球；第二类可以把一个指定颜色的球变成两个**这种**颜色的球。一个变化之后的球也可以通过工具产生新的变化。关于第 $i$ 种颜色的第一类工具有 $b_i$ 个，第二类工具有 $c_i$ 个。小 E 想知道，如果每一**个**工具最多只能使用一次，那么对于每种颜色 $i$，第 $i$ 种颜色的球最后最多能有多少个。以及，小 E 最后最多能有多少个球。
## 输入格式

第一行一个正整数 $n$。

第二行 $n$ 个整数，其中第 $i$ 个表示 $a_i$。

第三行 $n$ 个整数，其中第 $i$ 个表示 $b_i$。

第四行 $n$ 个整数，其中第 $i$ 个表示 $c_i$。
## 输出格式

第一行 $n$ 个整数，其中第 $i$ 个表示如果每个工具最多使用一次，那么小 E 最后第 $i$ 种颜色的球最多有多少个。

第二行一个整数，表示如果每个工具最多使用一次，那么小 E 最后最多能有多少个球。
## 样例

### 样例输入 #1
```
2
1 2
1 2
1 0

```
### 样例输出 #1
```
4 3
4

```
## 提示

### 子任务

保证 $1\le n \le 351493$。

保证 $0\le a_i,b_i,c_i\le 10^9$。

### 题目使用协议

来自 THUPC2024（2024年清华大学学生程序设计竞赛暨高校邀请赛）初赛。

以下『本仓库』皆指 THUPC2024 初赛 官方仓库（[https://github.com/ckw20/thupc2024_pre_public](https://github.com/ckw20/thupc2024_pre_public)）

1. 任何单位或个人都可以免费使用或转载本仓库的题目；

2. 任何单位或个人在使用本仓库题目时，应做到无偿、公开，严禁使用这些题目盈利或给这些题目添加特殊权限；

3. 如果条件允许，请在使用本仓库题目时同时提供数据、标程、题解等资源的获取方法；否则，请附上本仓库的 github 地址。


---

---
title: "[THUPC 2024 初赛] 二进制"
layout: "post"
diff: 提高+/省选-
pid: P9968
tag: ['2024', 'THUPC']
---
# [THUPC 2024 初赛] 二进制
## 题目描述

今天也是喜欢二进制串的一天，小 F 开始玩二进制串的游戏。

小 F 给出了一个这里有一个长为 $n$ 的二进制串 $s$，下标从 $1$ 到 $n$，且 $\forall i\in[1,n],s_i\in \{0,1\}$，他想要删除若干二进制子串。

具体的，小 F 做出了 $n$ 次尝试。

在第 $i\in[1,n]$ 次尝试中，他会先写出正整数 $i$ 的二进制串表示 $t$（无前导零，左侧为高位，例如 $10$ 可以写为 $1010$）。

随后找到这个二进制表示 $t$ 在 $s$ 中从左到右 **第一次** 出现的位置，并删除这个串。

注意，删除后左右部分的串会拼接在一起 **形成一个新的串**，请注意新串下标的改变。

若当前 $t$ 不在 $s$ 中存在，则小 F 对串 $s$ 不作出改变。

你需要回答每一次尝试中，$t$ 在 $s$ 中第一次出现的位置的左端点以及 $t$ 在 $s$ 中出现了多少次。

定义两次出现不同当且仅当出现的位置的左端点不同。

请注意输入输出效率。
## 输入格式

第一行一个正整数 $n$（$1\leq n\leq 1000000$）。

第二行一个长度为 $n$ 的字符串 $s$。保证 $\forall i\in[1,n], s_i \in \{0, 1\}$。
## 输出格式

输出共 $n$ 行，每行两个整数，第 $i$ 行表示小 F 进行第 $i$ 次尝试时开头端点的位置以及相应的字符串出现的次数。

若这次尝试失败，则当前行输出 $-1\ 0$。
## 样例

### 样例输入 #1
```
20
01001101101101110010

```
### 样例输出 #1
```
2 11
5 5
4 5
11 1
4 2
7 1
-1 0
-1 0
-1 0
-1 0
-1 0
-1 0
-1 0
-1 0
-1 0
-1 0
-1 0
-1 0
-1 0
-1 0

```
## 提示

### 题目使用协议

来自 THUPC2024（2024年清华大学学生程序设计竞赛暨高校邀请赛）初赛。

以下『本仓库』皆指 THUPC2024 初赛 官方仓库（[https://github.com/ckw20/thupc2024_pre_public](https://github.com/ckw20/thupc2024_pre_public)）

1. 任何单位或个人都可以免费使用或转载本仓库的题目；

2. 任何单位或个人在使用本仓库题目时，应做到无偿、公开，严禁使用这些题目盈利或给这些题目添加特殊权限；

3. 如果条件允许，请在使用本仓库题目时同时提供数据、标程、题解等资源的获取方法；否则，请附上本仓库的 github 地址。


---


---
title: "转圈"
layout: "post"
diff: 提高+/省选-
pid: P10515
tag: ['原根', '洛谷原创', 'O2优化', '洛谷月赛']
---
# 转圈
## 题目描述

小 $\delta$ 喜欢转圈圈。

他有一个圈，被均匀分成了 $n$ 个格子，神奇的是，$n$ 是一个质数。第 $i$ 个格子上写着一个数 $i \times m$，他现在站在第一个格子上。

接下来他会看看脚下踩着的数是多少，然后向前走这么多格。他会一直反复这么做。

求最终被小 $\delta$ 踩到过的格子的数量。由于小 $\delta$ 有很多圈圈，所以他会问你很多次。
## 输入格式

第一行包含一个正整数 $T$，代表询问次数。

对于每组询问，输入一行两个正整数 $n,m$。
## 输出格式

对于每次询问，输出一行一个正整数，代表被踩到的格子的数量。
## 样例

### 样例输入 #1
```
6
5 2
11 10
17 12
23 8
31 12
9999901 114514
```
### 样例输出 #1
```
4
2
4
11
30
16260
```
## 提示

**【样例解释】**

以第一次询问为例，小 $\delta$ 依次经过的格子编号为 $1 \to 3 \to 4 \to 2 \to 1 \to \cdots$，因此被踩到过的格子个数为 $4$。

**【数据范围】**

- 对于 $20\%$ 的数据，$n \le 10^3$，$T \le 2 \times 10^3$。
- 对于另外 $40\%$ 的数据，$T \le 3 \times 10^3$。
- 对于另外 $40\%$ 的数据，无特殊性质。

对于所有数据，$1 \le m < n \le 10^7$，$1 \le T \le 4 \times 10^5$。保证 $n$ 是质数。



---

---
title: "[GESP202503 五级] 原根判断"
layout: "post"
diff: 提高+/省选-
pid: P11961
tag: ['2025', '原根', '数论', 'GESP', '欧拉函数']
---
# [GESP202503 五级] 原根判断
## 题目背景

截止 2025 年 3 月，本题可能超出了 GESP 考纲范围。在该时间点下，原根是 NOI 大纲 8 级知识点（NOI 级），而相对简单的无需原根知识的做法中，使用的费马小定理与欧拉定理也属于 NOI 大纲 7 级知识点（提高级），且均未写明于 GESP 大纲中。需要注意，GESP 大纲和 NOI 大纲是不同的大纲。

若对题目中原根这一概念感兴趣，可以学习完成 [【模板】原根](https://www.luogu.com.cn/problem/P6091)。
## 题目描述

小 A 知道，对于质数 $p$ 而言，$p$ 的原根 $g$ 是满足以下条件的正整数：

+ $1<g<p$；
+ $g^{p-1}\bmod{p}=1$；
+ 对于任意 $1\le i<p-1$ 均有 $g^i\bmod{p}\neq1$。

其中 $a\bmod{p}$ 表示 $a$ 除以 $p$ 的余数。

小 A 现在有一个整数 $a$，请你帮他判断 $a$ 是不是 $p$ 的原根。
## 输入格式

第一行，一个正整数 $T$，表示测试数据组数。

每组测试数据包含一行，两个正整数 $a,p$。
## 输出格式

对于每组测试数据，输出一行，如果 $a$ 是 $p$ 的原根则输出 `Yes`，否则输出 `No`。
## 样例

### 样例输入 #1
```
3
3 998244353
5 998244353
7 998244353
```
### 样例输出 #1
```
Yes
Yes
No
```
## 提示

#### 数据范围

对于 $40\%$ 的测试点，保证 $3\le p\le10^3$。

对于所有测试点，保证 $1\le T\le20$，$3\le p\le10^9$，$1<a<p$，$p$ 为质数。


---

---
title: "【模板】原根"
layout: "post"
diff: 提高+/省选-
pid: P6091
tag: ['数学', '原根', '素数判断,质数,筛法']
---
# 【模板】原根
## 题目描述

给定整数 $n$，求它的所有原根。

为了减小你的输出量，给出输出参数 $d$，设 $n$ 的所有原根有 $c$ 个，从小到大分别为 $g_1,\ldots,g_c$，你只需要依次输出 $g_d,g_{2d},\ldots,g_{\lfloor\frac{c}{d}\rfloor\times d}$。

---

如果你不了解原根的定义，可以自行查找资料或阅读下列定义：

正整数 $g$ 是正整数 $n$ 的原根，当且仅当 $1\leq g\leq n-1$，且 $g$ 模 $n$ 的阶为 $\varphi(n)$。
## 输入格式

**本题包含多组数据**。

第一行：一个整数 $T$，表示数据组数。

接下来 $T$ 行：每行两个整数 $n,d$，表示一组询问数据。
## 输出格式

对于每组数据：

第一行输出一个整数 $c$，表示 $n$ 的原根个数，第二行输出 $\lfloor\dfrac{c}{d}\rfloor$ 个数，按照题目描述中要求输出。

注意：即使 $\lfloor\dfrac{c}{d}\rfloor=0$，也需要输出一个空行。
## 样例

### 样例输入 #1
```
6
2 1
4 1
25 2
36 1
9 6
18 1

```
### 样例输出 #1
```
1
1 
1
3 
8
3 12 17 23 
0

2

2
5 11 

```
## 提示

【样例解释】

对于第 $1,2,4,6$ 组数据，给出的 $n$ 的所有原根都出现在输出中。

对于第 $3$ 组数据，$25$ 的原根集合为 $\{2,3,8,12,13,17,22,23\}$。

对于第 $5$ 组数据，$9$ 的原根集合为 $\{2,5\}$。

【数据范围】

对于 $100\%$ 的数据，$1\leq T\leq 10$，$2\leq n\leq 10^6$，$1\leq d\leq 200$，保证输出的数的总个数不超过 $10^5$。


---

---
title: "[LSOT-1] 记忆崩塌"
layout: "post"
diff: 提高+/省选-
pid: P8450
tag: ['动态规划 DP', '原根', '数论', '洛谷原创', '交互题', 'Special Judge', 'O2优化']
---
# [LSOT-1] 记忆崩塌
## 题目背景

“铃铃铃”，上课铃打响。一阵眩晕，小 H 突然倒在地上。只是隐约间，感受到周围有人赶过来。

“这是哪里？我不是在上课吗？”小 H 望向周围。

“欢迎来到 OI 世界。我负责带你熟悉 OI 世界。”一个奇怪的人走到这里来。

“OI 世界？”

“对。这里没有文化课，你可以在这里尽情学习 OI。”那人解释道。

紧接着，那人将小 H 带到了一个自称是心理学家的人面前。

“你在干什么？”小 H 望着那个心理学家。他正准备把一个奇怪的东西戴到小 H 头上。

“这个可以帮你恢复你在 whk 世界的记忆。”心理学家淡淡地说。

仪器戴到头上后，小 H 大喊：“我什么都想起来了！”

然而，真的什么都想起来了吗……

从那个人带着小H前往OI世界观光开始，这一切，全都乱了……
## 题目描述

**这是一道交互题。**

小 H 失忆了。

现在，小 H 过去的记忆化成了 $n$ 个记忆碎片。医生拥有 $n$ 种长度的取样条（长度为 $1\dots n$）。记忆碎片会与长度为 $i$ 的取样条发生大小为 $\gcd(n,i)$ 的情感共鸣。

医生有一个机器，可以测出长度为 $i$ 的取样条与小 H 产生的情感共鸣大小。现在你可以用这个机器测量一定的次数，医生希望你能告诉他若用完 $n$ 种长度的取样条小 H 总共会发生多大的情感共鸣。

### 交互格式
你可以用以下格式来询问医生你想知道的东西：

`TheSame? m`：下接 $m$ 行，每行两个数 $p_i,k_i$，医生会告诉你数小 H 的记忆碎片数量是否与 $\displaystyle\prod_{i=1}^mp_i^{k_i}$ 相等。`Yes` 代表相同或 `No` 代表不同。

`GetGCD. m`：下接 $m$ 行，每行两个数 $p,k$ ，医生会告诉你$\displaystyle\prod_{i=1}^mp_i^{k_i}$  与小 H 的记忆碎片产生的情感共鸣大小。

所有询问的 $p_i$ 为素数，$k_i$ 为正整数，不符合上述限制的交互不保证交互库会做出预期行为。

***

你可以用以下格式来告诉医生你知道的东西：

`IFoundTheAnswer! m`：以此来告诉评测器我已经知道了小 H 总共产生的情感共鸣大小为 $m$，并评判是否正确。

***

你一共可以与医生交互 $1050$ 次。交互库的所有输出与你输出的答案均应对 $998244353$ 取模。

***

你需要从**标准输出**中输出，代表你询问的内容。

每一次询问后都应当**清空缓冲区**，不然你会无缘无故 TLE。

你可以使用如下语句来清空缓冲区：

- 对于 C/C++：`fflush(stdout)`；
- 对于 C++：`std::cout << std::flush`；
- 对于 Java：`System.out.flush()`；
- 对于 Python：`stdout.flush()`；
- 对于 Pascal：`flush(output)`；
- 对于其他语言，请自行查阅对应语言的帮助文档。

特别的，对于 C++ 语言，在输出换行时如果你使用 `std::endl` 而不是 `'\n'`，也可以自动刷新缓冲区。

然后你需要从**标准输入**中输入，代表评测机返回的结果。
## 输入格式

见「交互格式」。

## 输出格式

见「交互格式」。

## 样例

### 样例输入 #1
```
1
No
2
Yes
```
### 样例输出 #1
```
GetGCD. 0
TheSame?  0
GetGCD. 1
2 1
TheSame? 1
2 1
IFoundTheAnswer! 3
```
## 提示

【数据范围】

**「本题采用捆绑测试」**

- $\texttt{Subtask 1(10 pts)：}1 \le\ n\le 500$；
- $\texttt{Subtask 2(25 pts)：}1 \le\ n\le 10^6$；
- $\texttt{Subtask 3(25 pts)：}$保证 $n$ 的唯一分解形式仅有前 $100$ 个质数；
- $\texttt{Subtask 4(40 pts)：}$无特殊限制。

对于 $100\%$ 的数据，满足 $n$ 的唯一分解形式质数数量不超过 $1000$，且质因子最大不超过 $7919$（注：$7919$ 为第 $1000$ 个质数），且质数的次数不超过 $10000$。

【其他提示】

因为交互库的效率较低，所以附件中给出交互库的代码。如果你想利用下面的交互库代码进行调试，你可以在官方的 [SPJ 说明](https://www.luogu.com.cn/blog/luogu/special-judge) 中下载 ```testlib.h``` 头文件后将两个程序的输出输入到另一个程序中。当然，你也可以模拟交互库的计算来手动输入到你的程序中。


---


---
title: "[省选联考 2024] 季风"
layout: "post"
diff: 提高+/省选-
pid: P10217
tag: ['各省省选', '2024', 'O2优化']
---
# [省选联考 2024] 季风
## 题目背景

生活在二维平面的小 X 准备拜访小 Y，但由于气候的变化，平面上刮起了季风。小 X 想知道季风的影响下，TA 至少要多少天能够到达小 Y 的家，但小 X 也是第一次遇见这种怪事，所以请精通算法的你来帮忙。
## 题目描述

给定 $n,k,x,y$ 和 $2n$ 个整数 $x_0,y_0,x_1,y_1,\dots,x_{n-1},y_{n-1}$。

找到最小的**非负整数** $m$，使得存在 $2m$ 个实数 $x_0',y_0',x_1',y_1',\dots,x_{m-1}',y_{m-1}'$ 满足以下条件，或报告不存在这样的 $m$：
- $\sum \limits_{i=0}^{m-1} (x_i'+x_{i \bmod n})=x$；
- $\sum \limits_{i=0}^{m-1} (y_i'+y_{i \bmod n})=y$；
- $\forall 0\leq i\leq m-1,|x_i'|+|y_i'|\leq k$。

特别地，$m=0$ 时，认为 $\sum \limits_{i=0}^{m-1} (x_i'+x_{i \bmod n})$ 和 $\sum \limits_{i=0}^{m-1} (y_i'+y_{i \bmod n})$ 均为 $0$。
## 输入格式

**本题有多组测试数据**。输入的第一行一个整数 $T$ 表示测试数据组数。

对于每组测试数据，
- 第一行四个整数 $n,k,x,y$；
- 接下来 $n$ 行，第 $i$ 行两个整数 $x_{i-1},y_{i-1}$。
## 输出格式

对于每组测试数据输出一行一个整数，如果存在满足题意的 $m$，输出其最小可能值，否则输出 $-1$。
## 样例

### 样例输入 #1
```
4
1 2 2 2
1 1
1 2 -2 -2
1 1
1 2 0 0
1 1
2 100000000 100000000 100000000
-99999999 0
-100000000 0
```
### 样例输出 #1
```
1
-1
0
399999999
```
## 提示

**【样例 1 解释】**

该组样例共有四组测试数据。
- 对于第一组测试数据，取 $m=1$，$(x_0',y_0')=(1,1)$ 满足条件，可以证明不存在更小的 $m$ 满足条件；
- 对于第二组测试数据，可以证明不存在任何非负整数 $m$ 满足条件；
- 对于第三组测试数据，取 $m=0$ 满足条件，可以证明不存在更小的 $m$ 满足条件。

**【样例 2】**

见附件中的 `wind2.in/ans`。

该组样例共有八十组测试数据，所有测试数据均满足 $n=1$，其中测试数据 $1\sim 20$ 满足特殊性质 A，$21\sim 40$ 满足特殊性质 B，$41\sim 60$ 满足特殊性质 C。

**【样例 3】**

见附件中的 `wind3.in/ans`。

该组样例共有六十组测试数据，所有测试数据均满足 $n=200$，其中测试数据 $1\sim 20$ 满足特殊性质 A，$21\sim 40$ 满足特殊性质 B。

**【子任务】**

设 $\sum n$ 为单个测试点内所有测试数据 $n$ 的和。对于所有测试数据：

- $1\leq T\leq 5\times 10^4$；
- $1\leq n\leq 10^5$，$1\leq \sum n \leq 10^6$；
- $0\leq |x|,|y|,|x_i|,|y_i|,k\leq 10^8$。

| 测试点编号 | $n\leq$ | $\sum n\leq$ | 特殊性质 |
| :----------: | :----------: | :----------: | :----------: |
| $1$ | $1$ | $300$ | A |
| $2$ | $1$ | $300$ | B |
| $3$ | $1$ | $300$ | C |
| $4$ | $1$ | $300$ | 无 |
| $5$ | $200$ | $5000$ | A |
| $6$ | $200$ | $5000$ | B |
| $7$ | $200$ | $5000$ | 无 |
| $8$ | $10^4$ | $10^5$ | A |
| $9$ | $10^4$ | $10^5$ | B |
| $10$ | $10^5$ | $10^6$ | 无 |

- 特殊性质 A：$\forall 0\leq i \leq n-1$，$|x_i|+|y_i| \leq k$；
- 特殊性质 B：$k=0$；
- 特殊性质 C：$x_0=y_0=0$。

**【提示】**

本题输入文件较大，请使用较为快速的输入方式。


---

---
title: "[ZJOI2007] 报表统计"
layout: "post"
diff: 提高+/省选-
pid: P1110
tag: ['2007', '线段树', '各省省选', '平衡树', '堆', '浙江']
---
# [ZJOI2007] 报表统计
## 题目描述

小 Q 的妈妈是一个出纳，经常需要做一些统计报表的工作。今天是妈妈的生日，小 Q 希望可以帮妈妈分担一些工作，作为她的生日礼物之一。

经过仔细观察，小 Q 发现统计一张报表实际上是维护一个非负整数数列，并且进行一些查询操作。

在最开始的时候，有一个长度为 $n$ 的整数序列 $a$，并且有以下三种操作：
        
- `INSERT i k`：在原数列的第 $i$ 个元素后面添加一个新元素 $k$；如果原数列的第 $i$ 个元素已经添加了若干元素，则添加在这些元素的最后（见样例说明）。
- `MIN_GAP`：查询相邻两个元素的之间差值（绝对值）的最小值。
- `MIN_SORT_GAP`：查询所有元素中最接近的两个元素的差值（绝对值）。

于是小 Q 写了一个程序，使得程序可以自动完成这些操作，但是他发现对于一些大的报表他的程序运行得很慢，你能帮助他改进程序么？
## 输入格式

第一行包含两个整数，分别表示原数列的长度 $n$ 以及操作的次数 $m$。

第二行为 $n$ 个整数，为初始序列，第 $i$ 个整数表示 $a_i$。

接下来的 $m$ 行，每行一个操作，即`INSERT i k`，`MIN_GAP`，`MIN_SORT_GAP` 中的一种（无多余空格或者空行）。

## 输出格式

对于每一个 `MIN_GAP` 和 `MIN_SORT_GAP` 命令，输出一行答案即可。

## 样例

### 样例输入 #1
```
3 5
5 3 1
INSERT 2 9
MIN_SORT_GAP
INSERT 2 6
MIN_GAP
MIN_SORT_GAP

```
### 样例输出 #1
```
2
2
1

```
## 提示

#### 样例输入输出 1 解释

一开始的序列为 $\{5,3,1\}$。

执行操作 `INSERT 2  9` 将得到 $\{5,3,9,1\}$，此时 `MIN_GAP` 为 $2$，`MIN_SORT_GAP` 为 $2$。

再执行操作 `INSERT 2  6` 将得到：$\{5,3, 9, 6, 1\}$。

注意这个时候原序列的第 $2$ 个元素后面已经添加了一个 $9$，此时添加的 $6$ 应加在 $9$ 的后面。这个时候 `MIN_GAP` 为 $2$，`MIN_SORT_GAP` 为 $1$。

---


#### 数据规模与约定

对于全部的测试点，保证 $2 \le n, m \le 5\times10^5$，$1 \leq i \leq n$，$0 \leq a_i, k \leq 5 \times 10^8$。


---

---
title: "[HNOI2001] 求正整数"
layout: "post"
diff: 提高+/省选-
pid: P1128
tag: ['数学', '2001', '各省省选', '湖南']
---
# [HNOI2001] 求正整数
## 题目描述

对于任意输入的正整数 $n$，请求出具有 $n$ 个不同因子的最小正整数 $m$。

例如：$n=4$，则 $m=6$，因为 $6$ 有 $4$ 个不同整数因子 $1,2,3,6$；而且是最小的有 $4$ 个因子的整数。
## 输入格式

输入有且仅有一行一个整数，代表 $n$。

## 输出格式

输出一行一个整数，代表符合条件的最小正整数 $m$。
## 样例

### 样例输入 #1
```
 4

```
### 样例输出 #1
```
6

```
## 提示

#### 数据规模与约定

对于 $100\%$ 的数据，保证 $1 \leq n \leq 5 \times 10^4$。


---

---
title: "[ZJOI2007] 矩阵游戏"
layout: "post"
diff: 提高+/省选-
pid: P1129
tag: ['2007', '各省省选', '递归', '网络流', '浙江', '二分图']
---
# [ZJOI2007] 矩阵游戏
## 题目描述

小 Q 是一个非常聪明的孩子，除了国际象棋，他还很喜欢玩一个电脑益智游戏――矩阵游戏。矩阵游戏在一个 $n \times n$ 黑白方阵进行（如同国际象棋一般，只是颜色是随意的）。每次可以对该矩阵进行两种操作：

- 行交换操作：选择矩阵的任意两行，交换这两行（即交换对应格子的颜色）。
- 列交换操作：选择矩阵的任意两列，交换这两列（即交换对应格子的颜色）。

游戏的目标，即通过若干次操作，使得方阵的主对角线(左上角到右下角的连线)上的格子均为黑色。

对于某些关卡，小 Q 百思不得其解，以致他开始怀疑这些关卡是不是根本就是无解的！于是小 Q 决定写一个程序来判断这些关卡是否有解。

## 输入格式

**本题单测试点内有多组数据**。

第一行包含一个整数 $T$，表示数据的组数，对于每组数据，输入格式如下：

第一行为一个整数，代表方阵的大小 $n$。
接下来 $n$ 行，每行 $n$ 个非零即一的整数，代表该方阵。其中 $0$ 表示白色，$1$ 表示黑色。
## 输出格式

对于每组数据，输出一行一个字符串，若关卡有解则输出 `Yes`，否则输出 `No`。
## 样例

### 样例输入 #1
```
2
2
0 0
0 1
3
0 0 1
0 1 0
1 0 0

```
### 样例输出 #1
```
No
Yes

```
## 提示

#### 数据规模与约定

- 对于 $20\%$ 的数据，保证 $n \leq 7$。
- 对于 $50\%$ 的数据，保证 $n \leq 50$。
- 对于 $100\%$ 的数据，保证 $1 \leq n \leq 200$，$1 \leq T \leq 20$。



---

---
title: "[省选联考 2025] 幸运数字"
layout: "post"
diff: 提高+/省选-
pid: P11830
tag: ['二分', '各省省选', '2025', '离散化', '分类讨论']
---
# [省选联考 2025] 幸运数字
## 题目描述

小 X 有 $n$ 个正整数二元组 $(a_i, b_i) (1 \leq i \leq n)$。他将会维护初始为空的可重集 $S$，并对其进行 $n$ 轮操作。第 $i (1 \leq i \leq n)$ 轮操作中，他会在 $S$ 中加入 $a_i$ 个 $b_i$。

设 $m = \sum \limits_{i=1}^{n} a_i$，在所有操作结束后，小 X 会得到一个包含 $m$ 个正整数的可重集 $S$。最后他会计算 $S$ 的中位数，即 $S$ 中第 $\left\lfloor \frac{m+1}{2} \right\rfloor$ 小的数，作为他的幸运数字。

想知道小 X 幸运数字的小 Y 不知道这 $n$ 个二元组的具体数值是多少，但她得知了每个数的范围。具体地，对于每个 $1 \leq i \leq n$，小 Y 知道 $a_i \in [l_{i,1}, r_{i,1}]$ 且 $b_i \in [l_{i,2}, r_{i,2}]$。

小 Y 想知道在满足以上条件的情况下，有多少个数可能成为小 X 的幸运数字。
## 输入格式

本题有多组测试数据。输入的第一行两个整数 $c, T$，分别表示测试点编号和测试数据组数，接下来输入每组测试数据。样例满足 $c = 0$。

对于每组测试数据，第一行一个整数 $n$，表示二元组的个数，接下来 $n$ 行，第 $i (1 \leq i \leq n)$ 行四个整数 $l_{i,1}, r_{i,1}, l_{i,2}, r_{i,2}$，描述二元组每个数的范围。

## 输出格式

对于每组测试数据，输出一行一个整数，表示可能的幸运数字个数。
## 样例

### 样例输入 #1
```
0 4
2
1 2 1 1
1 1 2 2
2
1 1 1 2
1 1 2 3
2
1 2 1 2
2 3 3 4
4
1 2 1 4
3 4 1 2
3 4 2 3
3 4 3 4
```
### 样例输出 #1
```
1
2
4
3
```
## 提示

**【样例 1 解释】**

该组样例共有 $4$ 组测试数据。
- 对于第一组测试数据，若取 $(a_1, b_1) = (1, 1), (a_2, b_2) = (1, 2)$，则得到 $S = \{1, 2\}$，其中位数为 $1$；若取 $(a_1, b_1) = (2, 1), (a_2, b_2) = (1, 2)$，则得到 $S = \{1, 1, 2\}$，其中位数为 $1$。因此仅有 $1$ 为可能计算出的中位数，因此答案为 $1$。
- 对于第二组测试数据，若取 $(a_1, b_1) = (1, 1), (a_2, b_2) = (1, 2)$，则得到 $S = \{1, 2\}$，其中位数为 1；若取 $(a_1, b_1) = (1, 2), (a_2, b_2) = (1, 3)$，则得到 $S = \{2, 3\}$，其中位数为 $2$。可以证明不存在其他可能计算出的中位数，因此答案为 $2$。
- 对于第三组测试数据，可以证明有且仅有 $1, 2, 3, 4$ 为可能计算出的中位数，因此答案为 $4$。
- 对于第四组测试数据，可以证明有且仅有 $1, 2, 3$ 为可能计算出的中位数，因此答案为 $3$。

**【样例 2】**

见选手目录下的 lucky/lucky2.in 与 lucky/lucky2.ans。

该组样例共有 $60$ 组测试数据，所有数据均满足 $n = 4$。其中测试数据 $1 \sim 20$ 满足特殊性质 AB，测试数据 $21 \sim 40$ 满足特殊性质 A。

**【样例 3】**

见选手目录下的 lucky/lucky3.in 与 lucky/lucky3.ans。

该组样例共有 $4$ 组测试数据，所有数据均满足 $n = 2\,000$。其中测试数据 $1$ 满足特殊性质 AB，测试数据 $2$ 满足特殊性质 A，测试数据 $3$ 满足特殊性质 B。

**【样例 4】**

见选手目录下的 lucky/lucky4.in 与 lucky/lucky4.ans。

该组样例共有 $2$ 组测试数据，所有数据均满足 $n = 2 \times 10^5$。其中测试数据 $1$ 满足特殊性质 A，测试数据 $2$ 满足特殊性质 B。

**【子任务】**

设 $\sum n$ 为单个测试点内所有测试数据的 $n$ 的和。对于所有测试点，
- $1 \leq T \leq 400$，
- $1 \leq n \leq 2 \times 10^5$，$1 \leq \sum n \leq 6 \times 10^5$，
- $\forall 1 \leq i \leq n$，$1 \leq l_{i,1} \leq r_{i,1} \leq 10^9$，$1 \leq l_{i,2} \leq r_{i,2} \leq 10^9$。

| 测试点编号 | $n \leq$ | $\sum n \leq$ | 特殊性质 A | 特殊性质 B |
|:------------:|:----------:|:--------------:|:------------:|:------------:|
| $1$          | $4$        | $400$          | 是         | 是         |
| $2$          |  $4$        | $400$             | 是         | 否         |
| $3$          |  $2\,000$        | $10^4$             | 是         | 是         |
| $4$          | $2\,000$    | $10^4$         | 是         | 否         |
| $5$          | $2\,000$         | $10^4$             | 否         | 是         |
| $6$          | $2\,000$         | $10^4$             | 否         | 否         |
| $7$          | $2 \times 10^5$ | $6 \times 10^5$ | 是         | 是         |
| $8$          | $2 \times 10^5$         | $6 \times 10^5$             | 是         | 否         |
| $9$          | $2 \times 10^5$         | $6 \times 10^5$             | 否         | 是         |
| $10$         | $2 \times 10^5$         | $6 \times 10^5$             | 否         | 否         |

- 特殊性质 A：$\forall 1 \leq i \leq n$，$r_{i,1}, r_{i,2} \leq n$。
- 特殊性质 B：$\forall 1 \leq i \leq n$，$l_{i,1} = r_{i,1}$。


---

---
title: "[省选联考 2025] 推箱子"
layout: "post"
diff: 提高+/省选-
pid: P11833
tag: ['线段树', '二分', '各省省选', '2025', '颜色段均摊（珂朵莉树 ODT）', '分块']
---
# [省选联考 2025] 推箱子
## 题目描述

在一条无穷长的数轴上摆放着 $n$ 个箱子。第 $i$ ($1 \leq i \leq n$) 个箱子在时刻 0 位于数轴 $a_i$ 处，而你希望在时刻 $t_i$ 以及**之后的所有时刻**，这个箱子处在数轴的 $b_i$ 处。保证序列 $[a_1, \ldots, a_n]$ 和 $[b_1, \ldots, b_n]$ **单调递增**。

为此，从时刻 $0$ 开始的每个单位时间里，你可以将某个箱子在数轴上移动一个单位长度，也可以什么都不做。你需要保证任意时刻每个点上都只有一个箱子。形式化地，每个单位时间里你可以按照以下方式进行一次操作，也可以不进行操作：
1. 选择任意一个箱子。记其编号为 $i$，它目前的位置为 $p_i$。
2. 选择一个方向 $d \in \{\pm1\}$，其中 $d = 1$ 代表向右，$d = -1$ 代表向左。你需要保证数轴上 $(p_i + d)$ 处没有箱子。
3. 将 $i$ 号箱子从点 $p_i$ 移动到点 $(p_i + d)$ 处。

你想知道，是否存在一种操作方法同时满足所有箱子的要求，即对于任意 $1 \leq i \leq n$，第 $i$ 个箱子在时刻 $t_i$ 以及之后的所有时刻都处于数轴的 $b_i$ 处。
## 输入格式

**本题有多组测试数据**。输入的第一行两个整数 $c, T$，分别表示测试点编号和测试数据组数，接下来输入每组测试数据。样例满足 $c = 0$。

对于每组测试数据，第一行一个整数 $n$，表示箱子的个数，接下来 $n$ 行，第 $i$ ($1 \leq i \leq n$) 行三个整数 $a_i, b_i, t_i$，分别表示第 $i$ 个箱子的初始位置、目标位置和时刻要求。
## 输出格式

对于每组测试数据，输出一行一个字符串 `Yes` 或 `No`，表示是否存在一种操作方法同时满足所有箱子的要求。
## 样例

### 样例输入 #1
```
0 2
2
4 5 1
6 7 1
3
4 5 3
7 6 1
10 8 4
```
### 样例输出 #1
```
No
Yes
```
## 提示

**【样例 1 解释】**

该组样例共有 2 组测试数据。
- 对于第一组测试数据，答案是否定的。将 1 号箱子由点 4 移动到点 5，并将 2 号箱子由点 6 移动到点 7，至少需要两个单位时间，因此不可能在时刻 1 同时满足两个箱子的条件。
- 对于第二组测试数据，答案是肯定的，例如如下方法同时满足了所有箱子的要求：
  - 在时刻 0 至时刻 1 的一个单位时间，将 2 号箱子由点 7 移动到点 6；
  - 在时刻 1 至时刻 2 的一个单位时间，将 3 号箱子由点 10 移动到点 9；
  - 在时刻 2 至时刻 3 的一个单位时间，将 1 号箱子由点 4 移动到点 5；
  - 在时刻 3 至时刻 4 的一个单位时间，将 3 号箱子由点 9 移动到点 8；
  - 在之后的所有单位时间，什么都不做。
  
**【样例 2】**

见选手目录下的 `move/move2.in` 与 `move/move2.ans`。

该组样例共有 $6$ 组测试数据，所有数据均满足特殊性质 A。其中每组测试数据的 $n$ 分别为 $7$、$7$、$7$、$200$、$3\,000$、$2 \times 10^5$，且测试数据 $1 \sim 3$ 满足 $a_i, b_i \leq 15$，测试数据 $4$ 满足 $a_i, b_i \leq 3,000$。

**【样例 3】**

见选手目录下的 `move/move3.in` 与 `move/move3.ans`。

该组样例共有 $6$ 组测试数据，所有数据均满足特殊性质 B。其中每组测试数据的 $n$ 分别为 $7$、$7$、$7$、$200$、$3\,000$、$2 \times 10^5$，且测试数据 $1 \sim 3$ 满足 $a_i, b_i \leq 15$，测试数据 $4$ 满足 $a_i, b_i \leq 3,000$。

**【样例 4】**

见选手目录下的 `move/move4.in` 与 `move/move4.ans`。

该组样例共有 $6$ 组测试数据，所有数据均满足特殊性质 C。其中每组测试数据的 $n$ 分别为 $7$、$7$、$7$、$200$、$3\,000$、$2 \times 10^5$，且测试数据 $1 \sim 3$ 满足 $a_i, b_i \leq 15$，测试数据 $4$ 满足 $a_i, b_i \leq 3,000$。

**【样例 5】**

见选手目录下的 `move/move5.in` 与 `move/move5.ans`。

该组样例共有 $6$ 组测试数据。其中每组测试数据的 $n$ 分别为 $7$、$7$、$7$、$200$、$3\,000$、$2 \times 10^5$，且测试数据 $1 \sim 3$ 满足 $a_i, b_i \leq 15$，测试数据 $4$ 满足 $a_i, b_i \leq 3,000$。

**【子任务】**

对于所有测试点，
- $1 \leq T \leq 6$,
- $1 \leq n \leq 2 \times 10^5$,
- $\forall 1 \leq i \leq n, 1 \leq a_i, b_i \leq 10^9, 0 \leq t_i \leq 10^{16}$,
- $\forall 1 \leq i < n, a_i < a_{i+1}, b_i < b_{i+1}$。

| 测试点编号 | $n \leq$ | $a_i, b_i \leq$ | 特殊性质 |
|:------------:|:------------:|:-------------------:|:----------:|
| $1$          | $7$          | $15$                | A        |
| $2, 3$       | $7$           | $15$                  | 无       |
| $4$          | $200$           | $3\,000$                  | A        |
| $5$          | $200$        | $3\,000$             | B        |
| $6, 7$       |  $200$          | $3\,000$                  | 无       |
| $8$          | $3\,000$           | $10^9$                  | A        |
| $9$          | $3\,000$      | $10^9$              | B        |
| $10, 11$     | $3\,000$           | $10^9$                  | 无       |
| $12$         | $8 \times 10^4$           | $5 \times 10^5$                  | A        |
| $13$         | $8 \times 10^4$           | $5 \times 10^5$                  | B        |
| $14, 15$     | $8 \times 10^4$    | $5 \times 10^5$           | C        |
| $16 \sim 18$    | $8 \times 10^4$           | $5 \times 10^5$                  | 无       |
| $19, 20$     | $2 \times 10^5$           | $10^9$                  | B        |
| $21, 22$     | $2 \times 10^5$    | $10^9$              | C        |
| $23 \sim 25$    | $2 \times 10^5$           | $10^9$                  | 无       |

- 特殊性质 A：$\forall 1 \leq i < j \leq n, t_i = t_j$。
- 特殊性质 B：$\forall 1 \leq i \leq n, a_i \leq b_i$ 且 $\forall 1 \leq i < n, b_i < a_{i+1}$。
- 特殊性质 C：$\forall 1 \leq i \leq n, a_i \leq b_i$。



---

---
title: "[SCOI2009] windy 数（加强版）"
layout: "post"
diff: 提高+/省选-
pid: P13085
tag: ['动态规划 DP', '2009', '四川', '各省省选', '数位 DP']
---
# [SCOI2009] windy 数（加强版）
## 题目背景

**本题与 [P2657 [SCOI2009] windy 数](https://www.luogu.com.cn/problem/P2657) 的区别在于 $\bm{a}$ 与 $\bm{b}$ 的范围。**

windy 定义了一种 windy 数。
## 题目描述

不含前导零且相邻两个数字之差至少为 $2$ 的正整数被称为 windy 数。windy 想知道，在 $a$ 和 $b$ 之间，包括 $a$ 和 $b$ ，总共有多少个 windy 数？
## 输入格式

输入只有一行两个整数，分别表示 $a$ 和 $b$。
## 输出格式

输出一行一个整数表示答案。
## 样例

### 样例输入 #1
```
1 10
```
### 样例输出 #1
```
9
```
### 样例输入 #2
```
25 50

```
### 样例输出 #2
```
20

```
## 提示

#### 数据规模与约定

对于全部的测试点，保证 $1 \leq a \leq b \leq 10^{18}$。


---

---
title: "[TJOI2011] 树的序"
layout: "post"
diff: 提高+/省选-
pid: P1377
tag: ['2011', '各省省选', '天津', '笛卡尔树']
---
# [TJOI2011] 树的序
## 题目描述

众所周知，二叉查找树的形态和键值的插入顺序密切相关。准确的讲： 
1. 空树中加入一个键值 $k$，则变为只有一个结点的二叉查找树，此结点的键值即为 $k$。
2. 在非空树中插入一个键值 $k$，若 $k$ 小于其根的键值，则在其左子树中插入 $k$，否则在其右子树中插入 $k$。

我们将一棵二叉查找树的键值插入序列称为树的生成序列，现给出一个生成序列，求与其生成同样二叉查找树的所有生成序列中字典序最小的那个，其中，字典序关系是指对两个长度同为 $n$ 的生成序列，先比较第一个插入键值，再比较第二个，依此类推。
## 输入格式

第一行，一个整数 $n$，表示二叉查找树的结点个数。第二行，有 $n$ 个正整数 $k_1, k_2, \cdots,k_n$，表示生成序列，简单起见，$k_1 \sim k_n$ 为一个 $1$ 到 $n$ 的排列。
## 输出格式

一行，$n$ 个正整数，为能够生成同样二叉查找树的所有生成序列中最小的。
## 样例

### 样例输入 #1
```
4
1 3 4 2

```
### 样例输出 #1
```
1 3 2 4
```
## 提示

### 数据范围及约定

- 对于 $20\%$ 的数据， $1\le n ≤ 10$。
- 对于 $50\%$ 的数据， $1\le n ≤ 100$。
- 对于 $100\%$ 的数据， $1\le n ≤ 10^5$。


---

---
title: "[TJOI2011] 构造矩阵"
layout: "post"
diff: 提高+/省选-
pid: P1418
tag: ['2011', '各省省选', '天津']
---
# [TJOI2011] 构造矩阵
## 题目描述

要求构造一个 $n\times m$ 的 $01$ 矩阵，满足每一行中 $1$ 的个数分别为 $r_1,r_2,\ldots,r_n$ ,每一列中1的个数为 $c_1,c_2,\ldots,c_m$。

在此基础上要求字典序最小。两个矩阵比较字典序时先比较第一行，第一行相等再比较第二行……
## 输入格式

第一行输入两个整数 $n,m$。

第二行输入 $n$ 个整数 $r_1,r_2,\ldots,r_n$。

第三行输入 $m$ 个整数 $c_1,c_2,\ldots,c_m $。
## 输出格式

输出一个 $n\times m$ 的矩阵。
## 样例

### 样例输入 #1
```
2 3
2 1 
1 0 2 

```
### 样例输出 #1
```
101
001

```
## 提示

对于 $100\%$ 的数据 $n,m\le 100$。


---

---
title: "[HNOI2004] 敲砖块"
layout: "post"
diff: 提高+/省选-
pid: P1437
tag: ['动态规划 DP', '2004', '各省省选', '湖南', '前缀和']
---
# [HNOI2004] 敲砖块
## 题目背景

无
## 题目描述

在一个凹槽中放置了 $n$ 层砖块、最上面的一层有 $n$ 块砖，从上到下每层依次减少一块砖。每块砖都有一个分值，敲掉这块砖就能得到相应的分值，如下图所示：

```cpp
14 15  4  3  23
 33  33 76  2
   2   13 11
     22 23
       31
```
如果你想敲掉第 $i$ 层的第 $j$ 块砖的话，若 $i=1$，你可以直接敲掉它；若 $i>1$，则你必须先敲掉第 $i-1$ 层的第 $j$ 和第 $j+1$ 块砖。

你现在可以敲掉最多 $m$ 块砖，求得分最多能有多少。
## 输入格式

输入文件的第一行为两个正整数 $n$ 和 $m$；接下来 $n$ 行，描述这 $n$ 层砖块上的分值 $a_{i,j}$，满足 $0\leq a_{i,j}\leq 100$。

对于 $100\%$ 的数据，满足 $1\leq n\leq 50$，$1\leq m\leq \frac{n\times(n+1)}{2}$；
## 输出格式

输出文件仅一行为一个正整数，表示被敲掉砖块的最大价值总和。

## 样例

### 样例输入 #1
```
4 5
2 2 3 4
8 2 7
2 3
49
```
### 样例输出 #1
```
19
```


---

---
title: "[HAOI2008] 硬币购物"
layout: "post"
diff: 提高+/省选-
pid: P1450
tag: ['动态规划 DP', '数学', '递推', '2008', '河南', '各省省选', '容斥原理']
---
# [HAOI2008] 硬币购物
## 题目描述

共有 $4$ 种硬币。面值分别为 $c_1,c_2,c_3,c_4$。

某人去商店买东西，去了 $n$ 次，对于每次购买，他带了 $d_i$ 枚 $i$ 种硬币，想购买 $s$ 的价值的东西。请问每次有多少种付款方法。
## 输入格式

输入的第一行是五个整数，分别代表 $c_1,c_2,c_3,c_4, n$。

接下来 $n$ 行，每行有五个整数，描述一次购买，分别代表 $d_1, d_2, d_3, d_4,s$。
## 输出格式

对于每次购买，输出一行一个整数代表答案。
## 样例

### 样例输入 #1
```
1 2 5 10 2
3 2 3 1 10
1000 2 2 2 900

```
### 样例输出 #1
```
4
27

```
## 提示

#### 数据规模与约定

* 对于 $100\%$ 的数据，保证 $1 \leq c_i, d_i, s \leq 10^5$，$1 \leq n \leq 1000$。


---

---
title: "[POI 2001 ] [HAOI2007] 反素数"
layout: "post"
diff: 提高+/省选-
pid: P1463
tag: ['搜索', '数学', '2001', '2007', '河南', '各省省选', 'POI（波兰）', '素数判断,质数,筛法']
---
# [POI 2001 ] [HAOI2007] 反素数
## 题目描述

对于任何正整数 $x$，其约数的个数记作 $g(x)$。例如 $g(1)=1$，$g(6)=4$。

如果某个正整数 $x$ 满足：$\forall 0 \lt i \lt x$，都有 $g(x) \gt g(i)$，则称 $x$ 为**反质数**。例如，整数 $1,2,4,6$ 等都是反质数。

现在给定一个数 $N$，你能求出不超过 $N$ 的最大的反质数么？

## 输入格式

一个数 $N$。

## 输出格式

不超过 $N$ 的最大的反质数。

## 样例

### 样例输入 #1
```
1000
```
### 样例输出 #1
```
840
```
## 提示

$1 \leq N \leq 2 \times 10^9$


---

---
title: "[SDOI2006] 数字串位置 / 超长数字串"
layout: "post"
diff: 提高+/省选-
pid: P1511
tag: ['字符串', '数学', '2006', '各省省选', '山东', '枚举']
---
# [SDOI2006] 数字串位置 / 超长数字串
## 题目背景

George 很喜欢数学，尤其是算数数系列。
## 题目描述

他最喜欢的是数字的无穷序列，结果是把所有的自然数按升序排列。这个序列开始是：$\texttt{1234567891011121314...}$

我们称这个序列为序列 $S$，然后 $S_1 = 1$, $S_2 = 2$, ... , $S_{10} = 1$, $S_{11} = 0$，依此类推.

George 现有一个数字序列 $A$ ，他想知道这个序列在 $S$ 中最早出现的位置。请你帮助他解决这个问题。
## 输入格式

输入一个字符串，表示数字序列 $A$ ，位数不超过 $200$，中间没有空格。

## 输出格式

输出使 $A_1 = S_k, A_2 = S_{k+1}, ...,A_{len_{A}} = S_{k + len(A)-1}$ 成立的最小正整数 $k$，其中 $len_{A}$ 表示序列 $A$ 的长度。

## 样例

### 样例输入 #1
```
101


```
### 样例输出 #1
```
10


```
## 提示

来源 Source

Ural State University Problem Archive

 


---

---
title: "[TJOI2011] 01矩阵"
layout: "post"
diff: 提高+/省选-
pid: P1539
tag: ['动态规划 DP', '2011', '各省省选', '快速沃尔什变换 FWT', '天津', '状压 DP']
---
# [TJOI2011] 01矩阵
## 题目描述

$n\times m$ 的 $01$ 矩阵，其中某些位置已经确定，为 '.' 的位置可以填 $0$ 或 $1$，求相邻两个位置不同为 $1$ 的矩阵方案数，答案模 $10007$。
## 输入格式

第一行输入两个数 $n,m$。

接下来输入一个 $n\times m$ 的矩阵，由 $\verb!0!,\verb!1!,\verb!.!$ 组成。
## 输出格式

输出一个整数，为相邻两个位置不同为 $1$ 的矩阵个数。
## 样例

### 样例输入 #1
```
2 3
10.
...

```
### 样例输出 #1
```
5

```
## 提示

### 数据范围及约定

对于 $100\%$ 的数据，$n\times m \le 225$。


---

---
title: "[SCOI2010] 连续攻击游戏"
layout: "post"
diff: 提高+/省选-
pid: P1640
tag: ['2010', '四川', '并查集', '各省省选', '二分图']
---
# [SCOI2010] 连续攻击游戏
## 题目描述

lxhgww 最近迷上了一款游戏，在游戏里，他拥有很多的装备，每种装备都有 $2$ 个属性，这些属性的值用 $[1,10000]$ 之间的数表示。当他使用某种装备时，他只能使用该装备的某一个属性。并且每种装备最多只能使用一次。游戏进行到最后，lxhgww 遇到了终极 boss，这个终极 boss 很奇怪，攻击他的装备所使用的属性值必须从 $1$ 开始连续递增地攻击，才能对 boss 产生伤害。也就是说一开始的时候，lxhgww 只能使用某个属性值为 $1$ 的装备攻击 boss，然后只能使用某个属性值为 $2$ 的装备攻击 boss，然后只能使用某个属性值为 $3$ 的装备攻击 boss……以此类推。现在 lxhgww 想知道他最多能连续攻击 boss 多少次？
## 输入格式

输入的第一行是一个整数 $N$，表示 lxhgww 拥有 $N$ 种装备接下来 $N$ 行，是对这 $N$ 种装备的描述，每行 $2$ 个数字，表示第 $i$ 种装备的 $2$ 个属性值。
## 输出格式

输出一行，包括 $1$ 个数字，表示 lxhgww 最多能连续攻击的次数。
## 样例

### 样例输入 #1
```
3
1 2
3 2
4 5

```
### 样例输出 #1
```
2
```
## 提示

对于 $30\%$ 的数据，保证 $N \le 10^3$。

对于 $100\%$ 的数据，保证 $N \le 10^6$。


---

---
title: "[SCOI2010] 生成字符串"
layout: "post"
diff: 提高+/省选-
pid: P1641
tag: ['2010', '四川', '各省省选', '逆元']
---
# [SCOI2010] 生成字符串
## 题目描述

lxhgww 最近接到了一个生成字符串的任务，任务需要他把 $n$ 个 $1$ 和 $m$ 个 $0$ 组成字符串，但是任务还要求在组成的字符串中，在任意的前 $k$ 个字符中，$1$ 的个数不能少于 $0$ 的个数。现在 lxhgww 想要知道满足要求的字符串共有多少个，聪明的程序员们，你们能帮助他吗？
## 输入格式

输入数据只有一行，包括 $2$ 个数字 $n$ 和 $m$。
## 输出格式

输出数据是一行，包括 $1$ 个数字，表示满足要求的字符串数目，这个数可能会很大，只需输出这个数除以 $20100403$ 的余数
## 样例

### 样例输入 #1
```
2 2
```
### 样例输出 #1
```
2
```
## 提示

对于 $30\%$ 的数据，保证 $1\leq m\leq n\leq 10^3$。

对于 $100\%$ 的数据，保证 $1\leq m\leq n\leq 10^6$。


---

---
title: "[ZJOI2006] 物流运输"
layout: "post"
diff: 提高+/省选-
pid: P1772
tag: ['动态规划 DP', '图论', '2006', '各省省选', '浙江', 'NOI 导刊', '最短路']
---
# [ZJOI2006] 物流运输
## 题目描述

物流公司要把一批货物从码头 A 运到码头 B。由于货物量比较大，需要 $n$ 天才能运完。货物运输过程中一般要转停好几个码头。  

物流公司通常会设计一条固定的运输路线，以便对整个运输过程实施严格的管理和跟踪。由于各种因素的存在，有的时候某个码头会无法装卸货物。这时候就必须修改运输路线，让货物能够按时到达目的地。  

但是修改路线是—件十分麻烦的事情，会带来额外的成本。因此物流公司希望能够订一个 $n$ 天的运输计划，使得总成本尽可能地小。

## 输入格式

第一行是四个整数 $n,m,k,e$。$n$ 表示货物运输所需天数，$m$ 表示码头总数，$k$ 表示每次修改运输路线所需成本，$e$ 表示航线条数。  

接下来 $e$ 行每行是一条航线描述，包括了三个整数，依次表示航线连接的两个码头编号以及航线长度。其中码头 A 编号为 $1$，码头 B 编号为 $m$。单位长度的运输费用为 $1$。航线是**双向**的。  

再接下来一行是一个整数 $d$，后面的 $d$ 行每行是三个整数 $p,a,b$。表示编号为 $p$ 的码头在 $[a,b]$ 天之内无法装卸货物。同一个码头有可能在多个时间段内不可用。但任何时间都存在至少一条从码头 A 到码头 B 的运输路线。

## 输出格式

包括了一个整数表示最小的总成本。  
总成本为 $n$ 天运输路线长度之和 $+ k \times$ 改变运输路线的次数。

## 样例

### 样例输入 #1
```
  5 5 10 8
  1 2 1
  1 3 3
  1 4 2
  2 3 2
  2 4 4
  3 4 1
  3 5 2
  4 5 2
  4
  2 2 3
  3 1 1
  3 3 3
  4 4 5

```
### 样例输出 #1
```
32
```
## 提示

【数据范围】
对于 $100\%$ 的数据，$1 \le n \le 100$，$1\le m \le 20$, $1 \le k \le 500$, $1 \le e \le 200$。

【样例输入说明】

![](https://cdn.luogu.com.cn/upload/image_hosting/4lcnync6.png)

上图依次表示第 $1$ 至第 $5$ 天的情况，阴影表示不可用的码头。

【样例输出说明】

前三天走 $1 \to 4 \to 5$，后两天走 $1 \to 3 \to 5$，这样总成本为 $(2+2)\times 3+(3+2)\times 2+10=32$。

\_NOI导刊2010提高（01）



---

---
title: "[JSOI2007] 重要的城市"
layout: "post"
diff: 提高+/省选-
pid: P1841
tag: ['动态规划 DP', '图论', '2007', '各省省选', '江苏']
---
# [JSOI2007] 重要的城市
## 题目描述

参加jsoi冬令营的同学最近发现，由于南航校内修路截断了原来通向计算中心的路，导致去的路程比原先增加了近一公里。而食堂门前施工虽然也截断了原来通向计算中心的路，却没有使路程增加，因为可以找到同样长度的路作替代。其实，问题的关键在于，路截断的地方是交通要点。

同样的情况也出现在城市间的交通中。某些城市如果出了问题，可能会引起其他很多城市的交通不便。另一些城市则影响不到别的城市的交通。jsoi冬令营的同学发现这是一个有趣的问题，于是决定研究这个问题。

他们认为这样的城市是重要的：如果一个城市c被破坏后，存在两个不同的城市a和b（a, b均不等于c），a到b的最短距离增长了（或不通），则城市c是重要的。

jsoi冬令营的同学面对着一张教练组交给他们的城市间交通图，他们希望能找出所有重要的城市。现在就请你来解决这个问题。

## 输入格式

第一行两个整数N,M,N为城市数，M为道路数

接下来M行，每行三个整数，表示两个城市之间的无向边，以及之间的路的长度

## 输出格式

一行，按递增次序输出若干的数，表示重要的城市。

## 样例

### 样例输入 #1
```
4 4
1 2 1
2 3 1
4 1 2
4 3 2
```
### 样例输出 #1
```
2

```
## 提示

30%的数据：$N\le 20$；

60%的数据：$N\le 100$；

100%的数据：$N\le 200,M\le \frac{N\times (N-1)}{2},0<c\le 10000$。c即路的长度。

保证不出现重边和自环

感谢@赵昕鹏 和@qq2477259579 提供程序


如果没有点的话需要输出一行

“No important cities.”

去掉引号



---

---
title: "[SCOI2005] 互不侵犯"
layout: "post"
diff: 提高+/省选-
pid: P1896
tag: ['动态规划 DP', '2005', '四川', '各省省选', '深度优先搜索 DFS', '状压 DP']
---
# [SCOI2005] 互不侵犯
## 题目描述

在 $N \times N$ 的棋盘里面放 $K$ 个国王，使他们互不攻击，共有多少种摆放方案。国王能攻击到它上下左右，以及左上左下右上右下八个方向上附近的各一个格子，共 $8$ 个格子。
## 输入格式

只有一行，包含两个数 $N,K$。
## 输出格式

所得的方案数

## 样例

### 样例输入 #1
```
3 2

```
### 样例输出 #1
```
16

```
## 提示

### 数据范围及约定

对于全部数据，$1 \le N \le 9$，$0 \le K \le N\times N$。

---

$\text{upd 2018.4.25}$：数据有加强。


---

---
title: "[SDOI2009] HH的项链"
layout: "post"
diff: 提高+/省选-
pid: P1972
tag: ['2009', '各省省选', '树状数组', '山东', 'O2优化', '可持久化线段树', '前缀和', '离线处理']
---
# [SDOI2009] HH的项链
## 题目描述

HH 有一串由各种漂亮的贝壳组成的项链。HH 相信不同的贝壳会带来好运，所以每次散步完后，他都会随意取出一段贝壳，思考它们所表达的含义。HH 不断地收集新的贝壳，因此，他的项链变得越来越长。  

有一天，他突然提出了一个问题：某一段贝壳中，包含了多少种不同的贝壳？这个问题很难回答…… 因为项链实在是太长了。于是，他只好求助睿智的你，来解决这个问题。

## 输入格式

一行一个正整数 $n$，表示项链长度。   
第二行 $n$ 个正整数 $a_i$，表示项链中第 $i$ 个贝壳的种类。

第三行一个整数 $m$，表示 HH 询问的个数。   
接下来 $m$ 行，每行两个整数 $l,r$，表示询问的区间。

## 输出格式

输出 $m$ 行，每行一个整数，依次表示询问对应的答案。

## 样例

### 样例输入 #1
```
6
1 2 3 4 3 5
3
1 2
3 5
2 6

```
### 样例输出 #1
```
2
2
4
```
## 提示

【数据范围】  

对于 $20\%$ 的数据，$1\le n,m\leq 5000$；   
对于 $40\%$ 的数据，$1\le n,m\leq 10^5$；   
对于 $60\%$ 的数据，$1\le n,m\leq 5\times 10^5$；  
对于 $100\%$ 的数据，$1\le n,m,a_i \leq 10^6$，$1\le l \le r \le n$。

本题可能需要较快的读入方式，最大数据点读入数据约 20MB


---

---
title: "[AHOI2009] 中国象棋"
layout: "post"
diff: 提高+/省选-
pid: P2051
tag: ['动态规划 DP', '递推', '2009', '各省省选', '安徽']
---
# [AHOI2009] 中国象棋
## 题目描述

这次小可可想解决的难题和中国象棋有关，在一个 $n$ 行 $m$ 列的棋盘上，让你放若干个炮（可以是 $0$ 个），使得没有一个炮可以攻击到另一个炮，请问有多少种放置方法。大家肯定很清楚，在中国象棋中炮的行走方式是：一个炮攻击到另一个炮，当且仅当它们在同一行或同一列中，且它们之间恰好 有一个棋子。你也来和小可可一起锻炼一下思维吧！

## 输入格式

一行包含两个整数 $n,m$，之间由一个空格隔开。

## 输出格式

总共的方案数，由于该值可能很大，只需给出方案数模 $9999973$ 的结果。

## 样例

### 样例输入 #1
```
1 3
```
### 样例输出 #1
```
7
```
## 提示


**样例说明**

除了 $3$ 个格子里都塞满了炮以外，其它方案都是可行的，所以一共有 $2 \times 2 \times 2-1=7$ 种方案。

**数据规模与约定**

- 对于 $30\%$ 的数据，$n$ 和 $m$ 均不超过 $6$。
- 对于 $50\%$ 的数据，$n$ 和 $m$ 至少有一个数不超过 $8$。
- 对于 $100\%$ 的数据，$1 \leq n,m \leq 100$。

题面修改：@syksykCCC。


---

---
title: "[AHOI2005] 洗牌"
layout: "post"
diff: 提高+/省选-
pid: P2054
tag: ['数学', '2005', '各省省选', '安徽', '逆元']
---
# [AHOI2005] 洗牌
## 题目描述

为了表彰小联为 Samuel 星球的探险所做出的贡献，小联被邀请参加 Samuel 星球近距离载人探险活动。

由于 Samuel 星球相当遥远，科学家们要在飞船中度过相当长的一段时间，小联提议用扑克牌打发长途旅行中的无聊时间。玩了几局之后，大家觉得单纯玩扑克牌对于像他们这样的高智商人才来说太简单了。有人提出了扑克牌的一种新的玩法。

对于扑克牌的一次洗牌是这样定义的，将一叠 $N$（$N$为偶数）张扑克牌平均分成上下两叠，取下面一叠的第一张作为新的一叠的第一张，然后取上面一叠的第一张作为新的一叠的第二张，再取下面一叠的第二张作为新的一叠的第三张……如此交替直到所有的牌取完。

如果对一叠 $6$ 张的扑克牌 ${1,2,3,4,5,6}$，进行一次洗牌的过程如下图所示：

  ![](https://cdn.luogu.com.cn/upload/pic/1641.png) 

从图中可以看出经过一次洗牌，序列 $1,2,3,4,5,6$ 变为 $4,1,5,2,6,3$。当然，再对得到的序列进行一次洗牌，又会变为 $2,4,6,1,3,5$。

游戏是这样的，如果给定长度为 $N$ 的一叠扑克牌，并且牌面大小从 $1$ 开始连续增加到 $N$（不考虑花色），对这样的一叠扑克牌，进行 $M$ 次洗牌。最先说出经过洗牌后的扑克牌序列中第 $L$ 张扑克牌的牌面大小是多少的科学家得胜。小联想赢取游戏的胜利，你能帮助他吗？
## 输入格式

输入文件中有三个用空格间隔的整数，分别表示 $N,M,L$。

（其中 $1\le N\le 10^{10},0 \le M\le 10^{10}$，且 $N$ 为偶数）。
## 输出格式

单行输出指定的扑克牌的牌面大小。
## 样例

### 样例输入 #1
```
6 2 3
```
### 样例输出 #1
```
6
```
## 提示

$0 ＜ N \leq 10^{10}$，$0 \leq M \leq 10^{10}$，且 $N$ 为偶数。



---

---
title: "[ZJOI2009] 假期的宿舍"
layout: "post"
diff: 提高+/省选-
pid: P2055
tag: ['2009', '各省省选', '网络流', '浙江', '二分图']
---
# [ZJOI2009] 假期的宿舍
## 题目描述

学校放假了……有些同学回家了，而有些同学则有以前的好朋友来探访，那么住宿就是一个问题。

比如 A 和 B 都是学校的学生，A 要回家，而 C 来看B，C 与 A 不认识。我们假设每个人只能睡和自己直接认识的人的床。那么一个解决方案就是 B 睡 A 的床而 C 睡 B 的床。而实际情况可能非常复杂，有的人可能认识好多在校学生，在校学生之间也不一定都互相认识。

我们已知一共有 $n$ 个人，并且知道其中每个人是不是本校学生，也知道每个本校学生是否回家。问是否存在一个方案使得所有不回家的本校学生和来看他们的其他人都有地方住。

## 输入格式

第一行一个数 $T$ 表示数据组数。接下来 $T$ 组数据，每组数据第一行一个数 $n$ 表示涉及到的总人数。

接下来一行 $n$ 个数，第 $i$ 个数表示第 $i$ 个人是否是在校学生 ($0$ 表示不是，$1$ 表示是)。再接下来一行 $n$ 个数，第 $i$ 个数表示第 $i$ 个人是否回家 ($0$ 表示不回家，$1$ 表示回家，注意如果第 $i$ 个人不是在校学生，那么这个位置上的数是一个随机的数，你应该在读入以后忽略它)。

接下来 $n$ 行每行 $n$ 个数，第 $i$ 行第 $j$ 个数表示 $i$ 和 $j$ 是否认识 ($1$ 表示认识，$0$ 表示不认识，第 $i$ 行 $i$ 个的值为 $0$，但是显然自己还是可以睡自己的床)，认识的关系是相互的。

## 输出格式

对于每组数据，如果存在一个方案则输出 `^_^`，否则输出`T_T`。（注意输出的都是半角字符，即三个符号的 ASCII 码分别为 $94,84,95$）

## 样例

### 样例输入 #1
```
1
3
1 1 0
0 1 0
0 1 1
1 0 0
1 0 0
```
### 样例输出 #1
```
^_^
```
## 提示

对于 $30\%$ 的数据满足 $1 \le n \le 12$。

对于 $100\%$ 的数据满足 $1 \le n \le 50$，$1 \le T \le 20$。



---

---
title: "[SHOI2007] 善意的投票 / [JLOI2010] 冠军调查"
layout: "post"
diff: 提高+/省选-
pid: P2057
tag: ['2007', '各省省选', '网络流', '上海']
---
# [SHOI2007] 善意的投票 / [JLOI2010] 冠军调查
## 题目描述

幼儿园里有 $n$ 个小朋友打算通过投票来决定睡不睡午觉。

对他们来说，这个问题并不是很重要，于是他们决定发扬谦让精神。

虽然每个人都有自己的主见，但是为了照顾一下自己朋友的想法，他们也可以投和自己本来意愿相反的票。

我们定义一次投票的冲突数为下面两者相加：

* 实际投票不同的好朋友对数。

* 自己实际投票和自己本来意愿不同的人数。

我们的问题就是，每位小朋友应该怎样投票，才能使冲突数最小？
## 输入格式

第一行两个整数 $n,m$。其中 $n$ 代表总人数，$m$ 代表好朋友的对数。

第二行 $n$ 个整数，第 $i$ 个整数代表第 $i$ 个小朋友的意愿：当它为 $1$ 时表示同意睡觉，当它为 $0$ 时表示反对睡觉。

接下来 $m$ 行，每行有两个整数 $i,j$，表示 $i,j$ 是一对好朋友，我们保证任何两对 $i,j$ 不会重复。

## 输出格式

一行一个整数，即可能的最小冲突数。
## 样例

### 样例输入 #1
```
3 3
1 0 0
1 2
1 3
3 2
```
### 样例输出 #1
```
1
```
## 提示

对于 $100\%$ 的数据，$2\le n\le300$，$1\le m \le \frac{n(n-1)}2$。


---

---
title: "[JLOI2013] 卡牌游戏"
layout: "post"
diff: 提高+/省选-
pid: P2059
tag: ['动态规划 DP', '递推', '2013', '各省省选', '吉林']
---
# [JLOI2013] 卡牌游戏
## 题目描述

$N$ 个人坐成一圈玩游戏。一开始我们把所有玩家按顺时针从 $1$ 到 $N$ 编号。首先第一回合是玩家 $1$ 作为庄家。每个回合庄家都会随机（即按相等的概率）从卡牌堆里选择一张卡片，假设卡片上的数字为 $X$，则庄家首先把卡片上的数字向所有玩家展示，然后按顺时针从庄家位置数第 $X$ 个人将被处决(即退出游戏)。然后卡片将会被放回卡牌堆里并重新洗牌。被处决的人按顺时针的下一个人将会作为下一轮的庄家。那么经过 $N-1$ 轮后最后只会剩下一个人，即为本次游戏的胜者。现在你预先知道了总共有 $M$ 张卡片，也知道每张卡片上的数字。现在你需要确定每个玩家胜出的概率。

这里有一个简单的例子：

例如一共有 $4$ 个玩家，有四张卡片分别写着`3,4,5,6`.

第一回合，庄家是玩家 $1$ ，假设他选择了一张写着数字 $5$ 的卡片。那么按顺时针数 `1,2,3,4,1`，最后玩家 $1$ 被踢出游戏。

第二回合，庄家就是玩家 $1$ 的下一个人，即玩家 $2$.假设玩家 $2$ 这次选择了一张数字 $6$，那么 `2,3,4,2,3,4`，玩家 $4$ 被踢出游戏。

第三回合，玩家 $2$ 再一次成为庄家。如果这一次玩家 $2$ 再次选了 $6$，则玩家 $3$ 被踢出游戏，最后的胜者就是玩家 $2$。
## 输入格式

第一行包括两个整数 $N,M$ 分别表示玩家个数和卡牌总数。

接下来一行包含 $M$ 个整数，分别给出每张卡片上写的数字。
## 输出格式

输出一行包含 $N$ 个百分比形式给出的实数，四舍五入到两位小数。分别给出从玩家 $1$ 到玩家 $N$ 的胜出概率，每个概率之间用空格隔开，最后不要有空格。
## 样例

### 样例输入 #1
```
5 5
2 3 5 7 11

```
### 样例输出 #1
```
22.72% 17.12% 15.36% 25.44% 19.36%

```
### 样例输入 #2
```
4 4
3 4 5 6
```
### 样例输出 #2
```
25.00% 25.00% 25.00% 25.00%
```
## 提示

对于 $30\%$ 的数据，有 $1\le N\le 10$。

对于 $50\%$ 的数据，有 $1\le N\le 30$。

对于 $100\%$ 的数据，有 $1\le N\le 50$, $1\le M\le 50$, $1\le$ 每张卡片上的数字 $\le 50$。


---

---
title: "[TJOI2011] 卡片"
layout: "post"
diff: 提高+/省选-
pid: P2065
tag: ['2011', '各省省选', '天津']
---
# [TJOI2011] 卡片
## 题目描述

桌子上有 $m$ 张蓝色卡片与 $n$ 张红色卡片，每张卡片上有一个大于 $1$ 的整数。现在你要从桌子上拿走一些卡片，分若干次拿。每次只能拿走一组卡片：这组卡片颜色不同，并且两张卡片上面的数字的最大公约数大于 $1$。问：最多可以从桌上拿走多少组卡片。
## 输入格式

每个输入文件中包含多组测试数据，每个文件中测试数据的数目不超过 $100$。

文件的第一行读入一个整数 $T$，为数据组数。

每组数据的格式如下：

```
m n

b1 b2 … bm

r1 r2 … rn
```

第二行给出每张蓝色卡片上面的数字，第三行给出每张红色卡片上的数字。

## 输出格式

对每组测试数据，输出最多可以拿走多少组卡片。

## 样例

### 样例输入 #1
```
7
4 3
2 6 6 15
2 3 5
2 3
4 9
8 16 32
4 2
4 9 11 13
5 7
5 5
2 3 5 1001 1001
7 11 13 30 30
10 10
2 3 5 7 9 11 13 15 17 29
4 6 10 14 18 22 26 30 34 38
20 20
195 144 903 63 137 513 44 626 75 473
876 421 568 519 755 840 374 368 570 872
363 650 155 265 64 26 426 391 15 421
373 984 564 54 823 477 565 866 879 638
100 100
195 144 903 63 137 513 44 626 75 473
876 421 568 519 755 840 374 368 570 872
363 650 155 265 64 26 426 391 15 421
373 984 564 54 823 477 565 866 879 638
117 755 835 683 52 369 302 424 513 870
75 874 299 228 140 361 30 342 750 819
761 123 804 325 952 405 578 517 49 457
932 941 988 767 624 41 912 702 241 426
351 92 300 648 318 216 785 347 556 535
166 318 434 746 419 386 928 996 680 975
231 390 916 220 933 319 37 846 797 54
272 924 145 348 350 239 563 135 362 119
446 305 213 879 51 631 43 755 405 499
509 412 887 203 408 821 298 443 445 96
274 715 796 417 839 147 654 402 280 17
298 725 98 287 382 923 694 201 679 99
699 188 288 364 389 694 185 464 138 406
558 188 897 354 603 737 277 35 139 556
826 213 59 922 499 217 846 193 416 525
69 115 489 355 256 654 49 439 118 961
```
### 样例输出 #1
```
3
1
0
4
9
18
85
```
## 提示

对 $100 \%$ 的数据：$1 \le T \le 100$，$1 \le m, n \le 500$，卡片上的数字大于 $1$，小于 ${10}^7$。



---

---
title: "[SDOI2009] E&D"
layout: "post"
diff: 提高+/省选-
pid: P2148
tag: ['博弈论', '2009', '各省省选', '树状数组', '山东', '枚举', '位运算', 'SG 函数']
---
# [SDOI2009] E&D
## 题目描述

小 E 与小 W 进行一项名为 `E&D` 游戏。

游戏的规则如下：桌子上有 $2n$ 堆石子，编号为 $1 \sim 2n$。其中，为了方便起见，我们将第 $2k-1$ 堆与第 $2k$ 堆（$1 \le k \le n$）视为同一组。第 $i$ 堆的石子个数用一个正整数 $S_i$ 表示。

一次分割操作指的是，从桌子上任取一堆石子，将其移走。然后分割它同一组的另一堆石子，从中取出若干个石子放在被移走的位置，组成新的一堆。操作完成后，所有堆的石子数必须保证大于 $0$。显然，被分割的一堆的石子数至少要为 $2$。两个人轮流进行分割操作。如果轮到某人进行操作时，所有堆的石子数均为 $1$，则此时没有石子可以操作，判此人输掉比赛。

小 E 进行第一次分割。他想知道，是否存在某种策略使得他一定能战胜小 W。因此，他求助于小 F，也就是你，请你告诉他是否存在必胜策略。例如，假设初始时桌子上有 $4$ 堆石子，数量分别为 $1,2,3,1$。小 E 可以选择移走第 $1$ 堆，然后将第 $2$ 堆分割（只能分出 $1$ 个石子）。接下来，小 W 只能选择移走第 $4$ 堆，然后将第 $3$ 堆分割为 $1$ 和 $2$。最后轮到小 E，他只能移走后两堆中数量为 $1$ 的一堆，将另一堆分割为 $1$ 和 $1$。这样，轮到小 W 时，所有堆的数量均为 $1$，则他输掉了比赛。故小 E 存在必胜策略。
## 输入格式

**本题有多组数据。**

第一行一个整数 $T$，表示数据组数。

对于每组数据：

第一行一个整数 $N$，表示桌子上共有 $N$ 堆石子，这里的 $N$ 即为题目描述中的 $2n$。

第二行 $N$ 个整数 $S_{1 \dots N}$。
## 输出格式

对于每组数据，如果小 E 必胜，则一行一个字符串 `YES`，否则一行一个字符串 `NO`。


## 样例

### 样例输入 #1
```
2
4
1 2 3 1
6
1 1 1 1 1 1

```
### 样例输出 #1
```
YES
NO

```
## 提示

对于 $20\%$ 的数据，$N=2$。

对于另外 $20\%$ 的数据，$N \le 4$，$S_i \le 50$。

对于 $100\%$ 的数据，$1 \le T \le 20$，$1 \le N \le 2 \times 10^4$ 且 $N$ 为偶数，$1 \le S_i \le 2 \times 10^9$。


---

---
title: "[SDOI2009] Elaxia的路线"
layout: "post"
diff: 提高+/省选-
pid: P2149
tag: ['2009', '各省省选', '山东', '拓扑排序', '最短路']
---
# [SDOI2009] Elaxia的路线
## 题目描述

最近，Elaxia 和 w** 的关系特别好，他们很想整天在一起，但是大学的学习太紧张了，他们必须合理地安排两个人在一起的时间。

Elaxia 和 w** 每天都要奔波于宿舍和实验室之间，他们 希望在节约时间的前提下，一起走的时间尽可能的长。

现在已知的是 Elaxia 和 w** 所在的宿舍和实验室的编号以及学校的地图：  
地图上有 $n$ 个路口，$m$ 条路，经过每条路都需要一定的时间。 具体地说，就是要求无向图中，两对点间最短路的最长公共路径。

## 输入格式

第一行两个正整数 $n,m$，表示点数和边数。
  
第二行四个正整数 $x_1,y_1,x_2,y_2$，分别表示 Elaxia 的宿舍和实验室及 w** 的宿舍和实验室的标号。

接下来 $m$ 行，每行三个整数 $u,v,w$，表示 $u,v$之间有一条边，需要 $w$ 的时间经过。
## 输出格式

一行一个整数表示答案。（即最长公共路径的长度）

## 样例

### 样例输入 #1
```
9 10
1 6 7 8
1 2 1
2 5 2
2 3 3
3 4 2
3 9 5
4 5 3
4 6 4
4 7 2
5 8 1
7 9 1
```
### 样例输出 #1
```
3
```
## 提示

【数据范围】    
对于 $30\%$ 的数据，$1\le n \le 100$；   
对于 $60\%$ 的数据，$1\le n \le 1000$；   
对于 $100\%$ 的数据，$1\le n \le 1500$，$1 \leq m \leq 3 \times 10^5$，$1\le w \le 10^4$，输入数据保证没有重边和自环。



---

---
title: "[SDOI2009] SuperGCD"
layout: "post"
diff: 提高+/省选-
pid: P2152
tag: ['高精度', '2009', '各省省选', '山东', 'O2优化', '最大公约数 gcd']
---
# [SDOI2009] SuperGCD
## 题目描述

Sheng bill 有着惊人的心算能力，甚至能用大脑计算出两个巨大的数的最大公约数！因此他经常和别人比赛计算最大公约数。有一天Sheng bill很嚣张地找到了你，并要求和你比赛，但是输给 Sheng bill 岂不是很丢脸！所以你决定写一个程序来教训他。
## 输入格式

共两行，第一行一个整数 $a$，第二行一个整数 $b$。
## 输出格式

一行，表示 $a$ 和 $b$ 的最大公约数。
## 样例

### 样例输入 #1
```
12
54
```
### 样例输出 #1
```
6
```
## 提示

#### 数据规模与约定
- 对于 $20\%$ 的数据，有 $0<a,b\le 10^{18}$。
- 对于 $100\%$ 的数据，有 $0<a,b\le 10^{10000}$。


---

---
title: "[SDOI2008] 沙拉公主的困惑"
layout: "post"
diff: 提高+/省选-
pid: P2155
tag: ['数学', '2008', '各省省选', '山东', '素数判断,质数,筛法', '逆元']
---
# [SDOI2008] 沙拉公主的困惑
## 题目描述

大富翁国因为通货膨胀，以及假钞泛滥，政府决定推出一项新的政策：现有钞票编号范围为 $1$ 到 $N$ 的阶乘，但是，政府只发行编号与 $M!$ 互质的钞票。房地产第一大户沙拉公主决定预测一下大富翁国现在所有真钞票的数量。现在，请你帮助沙拉公主解决这个问题，由于数量可能非常大，你只需计算出答案对 $R$ 取模后的结果即可。 
## 输入格式

第一行为两个整数 $T$ 和 $R$，其中 $T$ 为该组中测试数据数目，$R$ 为模数。

接下来 $T$ 行，每行一对整数 $N$ 和 $M$，具体意义见题目描述。 
## 输出格式

共 $T$ 行，对于每一对 $N$ 和 $M$，输出 $[1, N!]$ 中与 $M!$ 互质的数的数量对 $R$ 取模后的值。  
## 样例

### 样例输入 #1
```
1 11
4 2
```
### 样例输出 #1
```
1

```
## 提示

对于 $100\% $ 的数据，$1\leq M\leq N\leq 10^7$，$1\leq T\leq 10^4$，$2\leq R\leq 10^9+10$ 且 $R$ 为质数。


---

---
title: "[SDOI2008] 仪仗队"
layout: "post"
diff: 提高+/省选-
pid: P2158
tag: ['2008', '各省省选', '山东', '素数判断,质数,筛法', '欧拉函数']
---
# [SDOI2008] 仪仗队
## 题目描述

作为体育委员，C 君负责这次运动会仪仗队的训练。仪仗队是由学生组成的 $N \times N$ 的方阵，为了保证队伍在行进中整齐划一，C 君会跟在仪仗队的左后方，根据其视线所及的学生人数来判断队伍是否整齐（如下图）。

![](https://cdn.luogu.com.cn/upload/pic/1149.png)

现在，C 君希望你告诉他队伍整齐时能看到的学生人数。
## 输入格式

一行，一个正整数 $N$。
## 输出格式

输出一行一个数，即 C 君应看到的学生人数。
## 样例

### 样例输入 #1
```
4
```
### 样例输出 #1
```
9
```
## 提示

对于 $100 \%$ 的数据，$1 \le N \le 40000$。


---

---
title: "[SHOI2009] 会场预约"
layout: "post"
diff: 提高+/省选-
pid: P2161
tag: ['2009', '各省省选', '平衡树', '树状数组', '上海']
---
# [SHOI2009] 会场预约
## 题目背景

## 形式化描述

你需要维护一个在数轴上的线段的集合 $S$，支持两种操作：

`A l r` 表示将 $S$ 中所有与线段 $[l,r]$ 相交的线段删去，并将 $[l,r]$ 加入 $S$ 中。

`B` 查询 $S$ 中的元素数量。

对于 `A` 操作，每次还需输出删掉的元素个数。
## 题目描述

PP 大厦有一间空的礼堂，可以为企业或者单位提供会议场地。

这些会议中的大多数都需要连续几天的时间（个别的可能只需要一天），不过场地只有一个，所以不同的会议的时间申请不能够冲突。也就是说，前一个会议的结束日期必须在后一个会议的开始日期之前。所以，如果要接受一个新的场地预约申请，就必须拒绝掉与这个申请相冲突的预约。

一般来说，如果 PP 大厦方面事先已经接受了一个会场预约（例如从 $10$ 日到 $15$ 日），就不会再接受与之相冲突的预约（例如从 $12$ 日到 $17$ 日）。

不过，有时出于经济利益，PP 大厦方面有时会为了接受一个新的会场预约，而拒绝掉一个甚至几个之前预订的预约。 于是，礼堂管理员 QQ 的笔记本上经常记录着这样的信息：（本题中为方便起见，所有的日期都用一个整数表示）例如，如果一个为期 $10$ 天的会议从 $90$ 日开始到 $99$ 日，那么下一个会议最早只能在 $100$ 日开始。（此处前后矛盾，若无法理解请参考形式化描述。）

最近，这个业务的工作量与日俱增，礼堂的管理员 QQ 希望参加 SHTSC 的你替他设计一套计算机系统，方便他的工作。这个系统应当能执行下面两个操作：

`A` 操作：有一个新的预约是从 $start$ 日到 $end$ 日，并且拒绝掉所有与它相冲突的预约。执行这个操作的时候，你的系统应当返回为了这个新预约而拒绝掉的预约个数，以方便 QQ 与自己的记录相校对。

`B` 操作：请你的系统返回当前的仍然有效的预约的总数。
## 输入格式

第一行一个正整数 $n$，表示操作个数。  
接下来 $n$ 行，每行表示一个操作，都是上面两种中的一个。
## 输出格式

输出 $n$ 行，每行一个整数，表示对应操作的答案。
## 样例

### 样例输入 #1
```
6
A 10 15
A 17 19
A 12 17
A 90 99
A 11 12
B
```
### 样例输出 #1
```
0
0
2
0
1
2
```
## 提示

【数据范围】  
对于 $100\%$ 的数据，$1\le n \le 2\times 10^5$，$1\le l \le r \le 10^5$。


---

---
title: "[SHOI2007] 园丁的烦恼"
layout: "post"
diff: 提高+/省选-
pid: P2163
tag: ['2007', '各省省选', '树状数组', '离散化', '上海', 'cdq 分治']
---
# [SHOI2007] 园丁的烦恼
## 题目背景

很久很久以前，在遥远的大陆上有一个美丽的国家。统治着这个美丽国家的国王是一个园艺爱好者，在他的皇家花园里种植着各种奇花异草。

有一天国王漫步在花园里，若有所思，他问一个园丁道： “最近我在思索一个问题，如果我们把花坛摆成六个六角形，那么……”

“那么本质上它是一个深度优先搜索，陛下。”园丁深深地向国王鞠了一躬。

“嗯……我听说有一种怪物叫九头蛇，它非常贪吃苹果树……”

“是的，显然这是一道经典的动态规划题，早在 N 元 $4002$ 年我们就已经发现了其中的奥秘了，陛下。”

“该死的，你究竟是什么来头？”

“陛下息怒，干我们的这行经常莫名其妙地被问到和 OI 有关的题目，我也是为了预防万一啊！” 王者的尊严受到了伤害，这是不可容忍的。
## 题目描述

看来一般的难题是难不倒这位园丁的，国王最后打算用车轮战来消耗他的实力： “年轻人，在我的花园里有 $n$ 棵树，每一棵树可以用一个整数坐标来表示，一会儿，我的 $m$ 个骑士们会来轮番询问你某一个矩阵内有多少树，如果你不能立即答对，你就准备走人吧！”说完，国王气呼呼地先走了。

这下轮到园丁傻眼了，他没有准备过这样的问题。所幸的是，作为“全国园丁保护联盟”的会长——你，可以成为他的最后一根救命稻草。
## 输入格式

第一行有两个整数 $n, m$，分别表示树木个数和询问次数。

接下来 $n$ 行，每行两个整数 $x, y$，表示存在一棵坐标为 $(x, y)$ 的树。有可能存在两棵树位于同一坐标。

接下来 $m$ 行，每行四个整数 $a, b, c, d$，表示查询以 $(a, b)$ 为左下角，$(c, d)$ 为右上角的矩形内部（包括边界）有多少棵树。

## 输出格式

对于每个查询，输出一行一个整数表示答案。
## 样例

### 样例输入 #1
```
3 1
0 0 
0 1
1 0
0 0 1 1

```
### 样例输出 #1
```
3
```
## 提示

#### 数据规模与约定

- 对于 $30\%$ 的数据，保证 $n, m \leq 10$。
- 对于 $100\%$ 的数据，保证 $0 \leq n \leq 5 \times 10^5$，$1 \leq m \leq 5 \times 10^5$，$0 \leq x, y, a, b, c, d \leq 10^7$，$a \leq c$，$b \leq d$。


---

---
title: "[SDOI2009] Bill的挑战"
layout: "post"
diff: 提高+/省选-
pid: P2167
tag: ['动态规划 DP', '2009', '各省省选', '山东', '枚举', '状压 DP']
---
# [SDOI2009] Bill的挑战
## 题目描述

Sheng_bill 不仅有惊人的心算能力，还可以轻松地完成各种统计。在昨天的比赛中，你凭借优秀的程序与他打成了平局，这导致 Sheng_bill  极度的不满。于是他再次挑战你。这次你可不能输。

这次，比赛规则是这样的：

给出 $N$ 个长度相同的字符串（由小写英文字母和 `?` 组成），$S_1,S_2,\dots,S_N$，求与这 $N$ 个串中的刚好 $K$ 个串匹配的字符串 $T$ 的个数，答案对 $1000003$ 取模。

若字符串 $S_x(1\le x\le N)$ 和 $T$ 匹配，满足以下条件：
1. $|S_x|=|T|$。
2. 对于任意的 $1\le i\le|S_x|$，满足 $S_x[i]= \texttt{?}$ 或者 $S_x[i]=T[i]$。

其中 $T$ 只包含小写英文字母。
## 输入格式

**本题包含多组数据**。

第一行一个整数 $T$，表示数据组数。 

对于每组数据，第一行两个整数，$N$ 和 $K$。 

接下来 $N$ 行，每行一个字符串 $S_i$。
## 输出格式

每组数据输出一行一个整数，表示答案。
## 样例

### 样例输入 #1
```
5

3 3

???r???

???????

???????

3 4

???????

?????a?

???????

3 3

???????

?a??j??

????aa?

3 2

a??????

???????

???????

3 2

???????

???a???

????a??
```
### 样例输出 #1
```
914852

0

0

871234

67018
```
## 提示

### 数据规模与约定
- 对于 $30\%$ 的数据，$N\le5$，$|S_i|\le20$；
- 对于 $70\%$ 的数据，$N\le13$，$|S_i|\le30$；
- 对于 $100\%$ 的数据，$1\le T\le 5$，$1\le N \le15$，$1\le|S_i|\le50$。


---

---
title: "[HAOI2007] 上升序列"
layout: "post"
diff: 提高+/省选-
pid: P2215
tag: ['动态规划 DP', '贪心', '递推', '2007', '河南', '各省省选']
---
# [HAOI2007] 上升序列
## 题目描述

对于一个给定的 $S=\{a_1,a_2,a_3,…,a_n\}$ , 若有 $P=\{a_{x_1},a_{x_2},a_{x_3},…,a_{x_m}\}$ , 满足 $(x_1<x_2<…<x_m)$  且 $(a_{x_1}<a_{x_2}<…<a_{x_m})$ 。那么就称 $P$ 为 $S$ 的一个上升序列。如果有多个 $P$ 满足条件，那么我们想求字典序最小的那个。

任务：

给出 $S$ 序列，给出若干询问。对于第 $i$ 个询问，求出长度为 $L_i$ 的上升序列，如有多个，求出字典序最小的那个（即首先 $x_1$ 最小，如果不唯一，再看 $x_2$ 最小……），如果不存在长度为 $L_i$ 的上升序列，则打印 `Impossible`。

## 输入格式

第一行一个 $N$，表示序列一共有 $N$ 个元素。

第二行 $N$ 个数，为 $a_1, a_2 , \cdots , a_n$。

第三行一个 $M$，表示询问次数。下面接 $M$ 行每行一个数 $L$，表示要询问长度为 $L$ 的上升序列。

## 输出格式

对于每个询问，如果对应的序列存在，则输出，否则打印 `Impossible`。

## 样例

### 样例输入 #1
```
6
3 4 1 2 3 6
3
6
4
5

```
### 样例输出 #1
```
Impossible
1 2 3 6
Impossible

```
### 样例输入 #2
```
6
6 7 1 2 3 4
1
2

```
### 样例输出 #2
```
6 7
```
## 提示

$N \le 10000$，$M \le 1000$，保证数据随机。



---

---
title: "[HAOI2007] 分割矩阵"
layout: "post"
diff: 提高+/省选-
pid: P2217
tag: ['搜索', '2007', '河南', '各省省选', '记忆化搜索']
---
# [HAOI2007] 分割矩阵
## 题目描述

将一个 $a\times b$ 的数字矩阵进行如下分割：将原矩阵沿某一条直线分割成两个矩阵，再将生成的两个矩阵继续如此分割（当然也可以只分割其中的一个），这样分割了 $(n-1)$ 次后，原矩阵被分割成了 $n$ 个矩阵。（每次分割都只能沿着数字间的缝隙进行）

原矩阵中每一位置上有一个分值，一个矩阵的总分为其所含各位置上分值之和。现在需要把矩阵按上述规则分割成 $n$ 个矩阵，并使各矩阵总分的均方差最小。

请编程对给出的矩阵及 $n$，求出均方差的最小值。

## 输入格式

第一行为 $3$ 个整数，表示 $a,b,n(1<a,b,n\le 10)$ 的值。

第二行至第 $a+1$ 行每行为 $b$ 个小于 $100$ 的非负整数，表示矩阵中相应位置上的分值。每行相邻两数之间用一个空格分开。

## 输出格式

仅一个数，为均方差的最小值。（四舍五入精确到小数点后 $2$ 位）

## 样例

### 样例输入 #1
```
5 4 4

2 3 4 6

5 7 5 1

10 4 0 5

2 0 2 3

4 1 1 1


```
### 样例输出 #1
```
0.50
```


---

---
title: "[HAOI2007] 修筑绿化带"
layout: "post"
diff: 提高+/省选-
pid: P2219
tag: ['2007', '河南', '各省省选', '平衡树', '单调队列', '队列']
---
# [HAOI2007] 修筑绿化带
## 题目描述

为了增添公园的景致，现在需要在公园中修筑一个花坛，同时在花坛四周修建一片绿化带，让花坛被绿化带围起来。

如果把公园看成一个 $M\times N$ 的矩形，那么花坛可以看成一个 $C\times D$ 的矩形，绿化带和花坛一起可以看成一个 $A\times B$ 的矩形。

如果将花园中的每一块土地的“肥沃度”定义为该块土地上每一个小块肥沃度之和，那么，绿化带的肥沃度为 $A\times B$ 块的肥沃度减去 $C\times D$ 块的肥沃度。

为了使得绿化带的生长得旺盛，我们希望绿化带的肥沃度最大。
## 输入格式

第一行有六个正整数 $M,N,A,B,C,D$。

接下来一个 $M\times N$ 的数字矩阵，其中矩阵的第 $i$ 行 $j$ 列元素为一个整数 $x_{i,j}$，表示该花园的第 $i$ 行第 $j$ 列的土地 “肥沃度”。
## 输出格式

一个正整数，表示绿化带的最大肥沃程度。

## 样例

### 样例输入 #1
```
4 5 4 4 2 2
20 19 18 17 16
15 14 13 12 11
10 9 8 7 6
5 4 3 2 1

```
### 样例输出 #1
```
132
```
## 提示

对于 $30\%$ 的数据，$1\leq M,N\leq 50$。

对于 $100\%$ 的数据，$1\leq M,N\leq 1000$，$1\leq A\leq M$，$1\leq B\leq N$，$1\leq C\leq A-2$，$1\leq D\leq B-2$，$1\leq x_{i,j}\leq 100$。


---

---
title: "[HAOI2012] 高速公路"
layout: "post"
diff: 提高+/省选-
pid: P2221
tag: ['2012', '河南', '线段树', '各省省选', 'O2优化', '最大公约数 gcd', '期望']
---
# [HAOI2012] 高速公路
## 题目背景

Y901 高速公路是一条重要的交通纽带，政府部门建设初期的投入以及使用期间的养护费用都不低，因此政府在这条高速公路上设立了许多收费站。
## 题目描述

Y901 高速公路是一条由 $n-1$ 段路以及 $n$ 个收费站组成的东西向的链，我们按照由西向东的顺序将收费站依次编号为 $1 \sim n$，从收费站 $i$ 行驶到 $i+1$（或从 $i+1$ 行驶到 $i$）需要收取 $v_i$ 的费用。高速路刚建成时所有的路段都是免费的，即所有 $v_i = 0$。

政府部门根据实际情况，会不定期地对连续路段的收费标准进行调整，根据政策涨价或降价。

无聊的小 A 同学总喜欢研究一些稀奇古怪的问题，他开车在这条高速路上行驶时想到了这样一个问题：对于给定的 $l,r$，在第 $l$ 个到第 $r$ 个收费站里等概率随机取出两个不同的收费站 $a$ 和 $b$，那么从 $a$ 行驶到 $b$ 将期望花费多少费用呢?

## 输入格式

第一行有两个整数，分别表示收费站个数 $n$，和询问与调整费用的总数 $m$。

接下来 $m$ 行，每行表示一次调整或询问，首先有一个字符 $op$。

- 若 $op$ 为 `C`，则后面有三个整数 $l, r, v$，表示将第 $l$ 个收费站到第 $r$ 个收费站之间所有**道路**的通行费用增加 $v$。
- 若 $op$ 为 `Q`，则后面有两个整数 $l, r$，对于给定的 $l, r$，请回答小 A 的问题。
## 输出格式

对于每次询问，输出一行一个既约分数表示答案。

若答案为一个整数 $a$，请输出 `a/1`。
## 样例

### 样例输入 #1
```
4 5
C 1 4 2
C 1 2 -1
Q 1 2
Q 2 4
Q 1 4

```
### 样例输出 #1
```
1/1
8/3
17/6

```
## 提示

#### 数据规模与约定

本题共 $10$ 个测试点，各测试点数据规模如下表所示


| 测试点编号 | $n=$ | $m=$ |
| :------: | :---: | :-: |
|$1$| $10$ |$10$|
|$2$|    $100$ |    $100$ |
|$3$  |  $1000$ |   $1000$|
|$4$   | $10000$ |   $10000$|
|$5$    |$50000$  |  $50000$|
|$6$  |  $60000$   | $60000$|
|$7$   | $70000$ |   $70000$|
|$8$   | $80000$  |  $80000$|
|$9$    |$90000$   | $90000$|
|$10$   | $100000$  |  $100000$|

对于全部的测试点，保证 $1 \leq n, m \leq 10^5$，$op \in \{\texttt C, \texttt Q\}$，$1 \leq l \leq r \leq n$，$-10^4 \leq v \leq 10^4$，在任何时刻，$0\leq v_i \leq 10^4$。


---

---
title: "[HNOI2001] 产品加工"
layout: "post"
diff: 提高+/省选-
pid: P2224
tag: ['动态规划 DP', '2001', '各省省选', '湖南', '背包 DP']
---
# [HNOI2001] 产品加工
## 题目描述

某加工厂有 A、B 两台机器，来加工的产品可以由其中任何一台机器完成，或者两台机器共同完成。由于受到机器性能和产品特性的限制，不同的机器加工同一产品所需的时间会不同，若同时由两台机器共同进行加工，所完成任务又会不同。

某一天，加工厂接到  $n$ 个产品加工的任务，每个任务的工作量不尽一样。

你的任务就是：已知每个任务在 A 机器上加工所需的时间  $t_1$，B 机器上加工所需的时间  $t_2$ 及由两台机器共同加工所需的时间  $t_3$，请你合理安排任务的调度顺序，使完成所有  $n$ 个任务的总时间最少。
## 输入格式

第一行为一个整数  $n$。

接下来  $n$ 行，每行三个非负整数  $t_1,t_2,t_3$，分别表示第  $i$ 个任务在 A 机器上加工、B 机器上加工、两台机器共同加工所需要的时间。如果所给的时间  $t_1$ 或  $t_2$ 为  $0$ 表示任务不能在该台机器上加工，如果  $t_3$ 为  $0$ 表示任务不能同时由两台机器加工。
## 输出格式

仅一行一个整数，表示完成所有  $n$ 个任务的最少总时间。
## 样例

### 样例输入 #1
```
5                            

2 1 0

0 5 0

2 4 1

0 0 3

2 1 1


```
### 样例输出 #1
```
9
```
## 提示

对于所有数据，有  $1\le n\le 6\times 10^3$， $0\le t_1,t_2,t_3\le 5$。


---

---
title: "[HNOI2001] 洗牌机"
layout: "post"
diff: 提高+/省选-
pid: P2227
tag: ['动态规划 DP', '2001', '各省省选', '网络流', '湖南', '图论建模']
---
# [HNOI2001] 洗牌机
## 题目描述

剀剀和凡凡有 $n$ 张牌（依次标号为 $1,2,\ldots,n$）和一台洗牌机。假设 $n$ 是奇数。洗牌机的功能是进行如下的操作：对所有位置 $i(1\le i\le n)$，如果位置 $i$ 上的牌是 $j$，而且位置 $j$ 上的牌是 $k$，那么通过洗牌机后位置 $i$ 上的牌将是 $k$。

剀剀首先写下数值 $1,2,\ldots,n$ 的一个随机排列：$a_1,a_2,\ldots,a_n$。然后他这样来排列牌的顺序：位置 $a_i$ 放置牌 $a_{i+1}$, （对于 $1\le i\le n-1$），而 $a_n$ 放置牌 $a_1$。这样排列后，牌的顺序就为 $x_1,x_2,\ldots ,x_n$。然后，他把这种顺序排列的牌放入洗牌机洗牌 $s$ 次，得到牌的顺序为 $p_1,p_2,\ldots,p_n$。现在，剀剀把牌的最后顺序和洗牌次数告诉凡凡，要凡凡猜出牌的最初顺序 $x_1,x_2,\ldots,x_n$。

## 输入格式

第一行为整数 $n$ 和 $s$。

第二行为牌的最终顺序  $p_1,p_2,\ldots,p_n$。
## 输出格式

为一行，即牌的最初顺序 $x_1,x_2,\ldots,x_n$。
## 样例

### 样例输入 #1
```
5 2          
4 1 5 3 2

```
### 样例输出 #1
```
2 5 4 1 3
```
## 提示

#### 数据规模与约定
对于 $100\%$ 的数据，保证 $1\le n,s\le 10^3$。

数据保证，从 $i=1$ 开始，设第 $i$ 张牌上数是 $j$，则赋值 $i=j$ 后继续此操作，最终会遍历所有牌。


---

---
title: "[HNOI2001] 洋洋吃蛋糕"
layout: "post"
diff: 提高+/省选-
pid: P2228
tag: ['2001', '各省省选', '湖南']
---
# [HNOI2001] 洋洋吃蛋糕
## 题目描述

洋洋是有名的“小馋猫”。他爱吃许多东西，但也有一些不爱吃的东西。一天，洋洋发现家中有一块刚烤好的长方形的蛋糕，而且蛋糕里放上了各种各样的东西，有爱吃的草莓，奶酪，也有不爱吃的核桃仁。这使得洋洋有一些为难，到底是吃还是不吃呢？这时，爷爷看出了洋洋的烦恼，然后说：你若能够遵守以下几条规则的话，蛋糕可以随便吃：

1. 蛋糕的尺寸为 $n\times m$，在吃之前，需先把蛋糕划分成 $n\times m$ 个单位蛋糕块，然后对每一个单位蛋糕块按照自己的喜好给其打分，分数越高表示越爱吃，反之则表示越不爱吃。这个分数为这一个单位蛋糕块的好吃程度值。

1. 每一个单位蛋糕块要么全部被吃掉，要么不吃。

1. 被吃掉的蛋糕块必须成长方形或正方形，是由一些单位蛋糕块组成的，且蛋糕块的两边必须和原来的大蛋糕块的两边平行。一块蛋糕块的好吃程度值就是所有组成这个蛋糕块的单位蛋糕块的分数之和。

1. 被吃掉的蛋糕块的尺寸任意，且块数也任意。

1. 为了保持蛋糕块的美观，所有被吃掉的蛋糕块在原来的大蛋糕块中的位置不能相邻，且不能重叠。如图 1 和图 2 的吃法是不允许的，而图 3 和图 4 的吃法是允许的。
![](https://cdn.luogu.com.cn/upload/pic/1295.png) 
1. 所有被吃掉的蛋糕块的好吃程度值之和最大。

爷爷的话并没有消去洋洋的烦恼，因为他只能做好第一点，而不知如何选择蛋糕块。于是，洋洋请你帮忙选择蛋糕块，以使得所有被吃掉的蛋糕块的好吃程度值之和最大。
## 输入格式

第一行是两个整数 $n$ 和 $m$。

以下 $n$ 行是一个 $n$ 行 $m$ 列的矩阵，第 $i$ 行第 $j$ 列的整数表示单位蛋糕块 $(i,j)$ 的好吃程度值 $c$。
## 输出格式

只有一个数，即为最大的好吃程度值。
## 样例

### 样例输入 #1
```
2 3                            
4 5 -2
-1 2 1

```
### 样例输出 #1
```
10
```
## 提示

#### 数据规模与约定
对于 $100\%$ 的数据，保证 $1\le n\le 200$，$1\le m\le 10$，$-100\le c\le 100$。


---

---
title: "[HNOI2002] Tinux系统"
layout: "post"
diff: 提高+/省选-
pid: P2230
tag: ['2002', '各省省选', '湖南']
---
# [HNOI2002] Tinux系统
## 题目描述

在 dos 系统诞生以前，美国曾研究出一种类似的操作系统，名为 Tinux 系统。但由于硬件设施的制约，Tinux 系统有许多的缺点。下面就对 Tinux 系统作一个简单的介绍：

Tinux 系统是 Tiger 博士为美国军方研制开发的一种操作系统，该系统对文件的存储方式类似于 dos 系统，像一棵树一样，每一个叶子节点表示一个文件，每一个非叶子节点表示一个目录。其中定义 $i$ 级子目录表示从根目录开始访问，一直访问到该子目录（不包括该子目录）需要访问的目录的个数为 $i$ 的目录，所以根目录下的目录为一级子目录，其他的目录以此类推。但是在同一子目录下，受到硬件的制约 Tinux 系统最多只能够存储 $k$ 个文件或子目录，也就是说这棵树里面的每一个非叶子节点最多只有 $k$ 个子节点。这样就导致在文件数量较多的情况下，访问存储在该系统当中的文件 A，往往要先访问一系列的子目录，我们称这些子目录为文件 A 的上级目录。例如下面这一个例子：

![](https://cdn.luogu.com.cn/upload/image_hosting/11pz60gn.png)

当我们要访问文件 A4A2A1 时就必须先访问它的上级目录：一级子目录 A4 和二级子目录 A4A2。

Tinux 系统在存储文件时，给每一个子目录都分配了 $k$ 个指针，分别指向存放在该目录下的每一个文件和每一个目录，因此对文件的访问实质上就是对指针的访问。但是由于硬件原因，这 $k$ 个指针不尽相同，因此访问它们的时间也不同，访问第 $i$ 个指针所耗费的时间为 $P_i$。但是对于两个不同的子目录（不管它们各自属于哪一级目录）而言它们各自所拥有的 $k$ 个指针是相同的。

Tinux 系统最大的缺点是访问一个目录时，必须把该目录下所有的文件读入到内存当中来，这些文件包括在其各级子目录当中的文件，例如上面那一个例子，访问 A4 那一个目录，就必须把 A4A1，A4A2A1，A4A2A2，A4A3 这四个文件都读入到内存当中来，访问一个目录所需要的时间为 $P_i \times x$（$x$ 表示该目录及其各级子目录下文件的个数，$P_i$ 表示指向该目录的指针的访问时间）。因此根据上面介绍的访问方法，单独访问一个文件所需要的总时间为访问其所有上级目录（不包括根目录）所需要的时间与访问指向该文件的指针所需要的时间的和，例如上面那一个例子，访问文件 A4A2A1 需要的时间 = 访问目录 A4 的时间 + 访问目录 A4A2 的时间 + 访问指向文件 A4A2A1 的指针需要的时间。

现在，tiger 博士准备将 $n$ 个文件存储到一个空的 Tinux 系统当中，希望你帮助他设计一个程序找到一种最优的存储方法，使得单独访问这 $n$ 个文件所需要的时间总和最小。
## 输入格式

文件的第一行为两个正整数 $n, k$，接下来的 $k$ 行每行有一个正整数 $P_i$。
## 输出格式

输出仅一个正整数，表示在最优存储方案下，单独访问这 $n$ 个文件所需要的时间总和（结果小于 $2^{31}$）。
## 样例

### 样例输入 #1
```
4 3
3
5
4

```
### 样例输出 #1
```
28

```
## 提示

![](https://cdn.luogu.com.cn/upload/pic/1296.png)

**【数据范围】**

$1 \le n \le 1000$，$2 \le k \le 150$，$1 \le P_i \le 150$。


---

---
title: "[HNOI2002] 跳蚤"
layout: "post"
diff: 提高+/省选-
pid: P2231
tag: ['2002', '各省省选', '数论', '湖南', '最大公约数 gcd', '不定方程', '莫比乌斯反演']
---
# [HNOI2002] 跳蚤
## 题目描述

Z 城市居住着很多只跳蚤。在 Z 城市周六生活频道有一个娱乐节目。一只跳蚤将被请上一个高空钢丝的正中央。钢丝很长，可以看作是无限长。节目主持人会给该跳蚤发一张卡片。卡片上写有 $N+1$ 个自然数。其中最后一个是 $M$，而前 $N$ 个数都不超过 $M$，卡片上允许有相同的数字。跳蚤每次可以从卡片上任意选择一个自然数 $S$，然后向左，或向右跳 $S$ 个单位长度。而他最终的任务是跳到距离他左边一个单位长度的地方，并捡起位于那里的礼物。

比如当 $N=2,M=18$ 时，持有卡片 $(10, 15, 18)$ 的跳蚤，就可以完成任务：他可以先向左跳 $10$ 个单位长度，然后再连向左跳 $3$ 次，每次 $15$ 个单位长度，最后再向右连跳 $3$ 次，每次 $18$ 个单位长度。而持有卡片 $(12, 15, 18)$ 的跳蚤，则怎么也不可能跳到距他左边一个单位长度的地方。

当确定 $N$ 和 $M$ 后，显然一共有 $M^ N$ 张不同的卡片。现在的问题是，在这所有的卡片中，有多少张可以完成任务。

## 输入格式

输入文件有且仅有一行，包括用空格分开的两个整数 $N$ 和 $M$。

## 输出格式

输出文件有且仅有一行，即可以完成任务的卡片数。

$1\le N\le M\le 10^8$，且$M^N\le 10^{16}$。

## 样例

### 样例输入 #1
```
2 4
```
### 样例输出 #1
```
12
```
## 提示

这12张卡片分别是：

$(1, 1, 4), (1, 2, 4), (1, 3, 4), (1, 4, 4), (2, 1, 4), (2, 3, 4)$

$(3, 1, 4), (3, 2, 4), (3, 3, 4), (3, 4, 4), (4, 1, 4), (4, 3, 4)$



---

---
title: "[HNOI2002] 彩票"
layout: "post"
diff: 提高+/省选-
pid: P2236
tag: ['2002', '各省省选', '湖南', '深度优先搜索 DFS']
---
# [HNOI2002] 彩票
## 题目描述

某地发行一套彩票。彩票上写有 $1$ 到 $M$ 这 $M$ 个自然数。彩民可以在这 $M$ 个数中任意选取 $N$ 个不同的数打圈。每个彩民只能买一张彩票，不同的彩民的彩票上的选择不同。

每次抽奖将抽出两个自然数 $X$ 和 $Y$。如果某人拿到的彩票上，所选 $N$ 个自然数的倒数和，恰好等于 $\dfrac{X}{Y}$，则他将获得一个纪念品。

已知抽奖结果 $X$ 和 $Y$。现在的问题是，必须准备多少纪念品，才能保证支付所有获奖者的奖品。
## 输入格式

输入文件有且仅有一行，就是用空格分开的四个整数 $N$，$M$，$X$，$Y$。

## 输出格式

输出文件有且仅有一行，即所需准备的纪念品数量。

## 样例

### 样例输入 #1
```
2 4 3 4
```
### 样例输出 #1
```
1
```
## 提示

$1 \leq X, Y \leq 100$，$1 \leq N \leq 10$，$1 \leq M \leq 50$。

输入数据保证输出结果不超过 $10^5$。


---

---
title: "[CQOI2007] 余数求和"
layout: "post"
diff: 提高+/省选-
pid: P2261
tag: ['数学', '2007', '重庆', '各省省选', '整除分块']
---
# [CQOI2007] 余数求和
## 题目描述

给出正整数 $n$ 和 $k$，请计算

$$G(n, k) = \sum_{i = 1}^n k \bmod i$$

其中 $k\bmod i$ 表示 $k$ 除以 $i$ 的余数。


## 输入格式

输入只有一行两个整数，分别表示 $n$ 和 $k$。
## 输出格式

输出一行一个整数表示答案。
## 样例

### 样例输入 #1
```
10 5

```
### 样例输出 #1
```
29
```
## 提示

#### 样例 1 解释

$G(10, 5)=0+1+2+1+0+5+5+5+5+5=29$。

#### 数据规模与约定

- 对于 $30\%$ 的数据，保证 $n , k \leq 10^3$。
- 对于 $60\%$ 的数据，保证 $n, k \leq 10^6$。
- 对于 $100\%$ 的数据，保证 $1 \leq n, k \leq 10^9$。


------------
2024/2/13 添加一组 hack 数据


---

---
title: "[HNOI2002] 奶牛的运算"
layout: "post"
diff: 提高+/省选-
pid: P2270
tag: ['2002', '各省省选', '湖南']
---
# [HNOI2002] 奶牛的运算
## 题目描述

最近，Farmer John 农场里的奶牛正在学习数学基础课。这天，奶牛 Besty 学会了加减法运算和括号的使用。

Farmer John 为了考察 Besty 的学习情况，写了如下一个算式：

$S =A_1-A_2-\ldots-A_n$

接着，Farmer John 告诉 Besty，这个算式中省略了 $K$ 个括号。将这 $K$ 个括号加入该算式中，就会得到一种算式方案。

例如：$S=A_1-A_2-A_3-A_4$，$K = 2$，则 $S = (A_1)-A_2 - (A_3- A_4)$ 就是一种算式方案。

而对任意两个算式方案，$S'$ 和 $S''$ 本质不同是指：存在某数列 $A_1,\ldots,A_n$ 满足 $S'\ne S''$。否则就是本质相同。

例如：$S'=(A_1)-A_2-(A_3-A_4)$ 与 $S''=(A_1-A_2)-(A_3-A_4)$ 就是本质相同的算式方案。

现在，Farmer John 告诉奶牛 Besty 算式中项的个数 $N$ 和括号的个数 $K$（数列 $A$ 是变量，我们不需要关心它），他想考考 Besty 究竟有多少本质不同的算式方案。

## 输入格式

输入文件仅一行，依次为两个整数 $N$ 和 $K$。（$1<N,K<100$）。

## 输出格式

输出文件仅一行，为本质不同的算式方案数。

## 样例

### 样例输入 #1
```
4 1
```
### 样例输出 #1
```
4
```


---

---
title: "[ZJOI2007] 最大半连通子图"
layout: "post"
diff: 提高+/省选-
pid: P2272
tag: ['2007', '各省省选', '浙江']
---
# [ZJOI2007] 最大半连通子图
## 题目描述

一个有向图 $G=\left(V,E\right)$ 称为半连通的 (Semi-Connected)，如果满足：$\forall u,v\in V$，满足 $u\to v$ 或 $v\to u$，即对于图中任意两点 $u,v$，存在一条 $u$ 到 $v$ 的有向路径或者从 $v$ 到 $u$ 的有向路径。

若 $G'=\left(V',E'\right)$ 满足 $V'\subseteq V$，$E'$ 是 $E$ 中所有跟 $V'$ 有关的边，则称 $G'$ 是 $G$ 的一个导出子图。若 $G'$ 是 $G$ 的导出子图，且 $G'$ 半连通，则称 $G'$ 为 $G$ 的半连通子图。若 $G'$ 是 $G$ 所有半连通子图中包含节点数最多的，则称 $G'$ 是 $G$ 的最大半连通子图。

给定一个有向图 $G$，请求出 $G$ 的最大半连通子图拥有的节点数 $K$，以及不同的最大半连通子图的数目 $C$。由于 $C$ 可能比较大，仅要求输出 $C$ 对 $X$ 的余数。
## 输入格式

第一行包含两个整数 $N,M,X$。$N,M$分别表示图 $G$ 的点数与边数，$X$ 的意义如上文所述。

接下来 $M$ 行，每行两个正整数 $a,b$，表示一条有向边 $\left(a,b\right)$。图中的每个点将编号为 $1,2,3\dots N$，保证输入中同一个$\left(a,b\right)$不会出现两次。
## 输出格式

应包含两行，第一行包含一个整数 $K$，第二行包含整数 $C\bmod X$。
## 样例

### 样例输入 #1
```
6 6 20070603
1 2
2 1
1 3
2 4
5 6
6 4
```
### 样例输出 #1
```
3
3
```
## 提示

对于 $100\%$ 的数据，$N\le 10^5$，$M\le 10^6$，$X\le 10^8$。


---

---
title: "[HNOI2003] 操作系统"
layout: "post"
diff: 提高+/省选-
pid: P2278
tag: ['模拟', '2003', '各省省选', '湖南', '优先队列', '队列']
---
# [HNOI2003] 操作系统
## 题目描述

写一个程序来模拟操作系统的进程调度。假设该系统只有一个 CPU，每一个进程的到达时间，执行时间和运行优先级都是已知的。其中运行优先级用自然数表示，数字越大，则优先级越高。

如果一个进程到达的时候 CPU 是空闲的，则它会一直占用 CPU 直到该进程结束。除非在这个过程中，有一个比它优先级高的进程要运行。在这种情况下，这个新的（优先级更高的）进程会占用 CPU，而老的只有等待。

如果一个进程到达时，CPU 正在处理一个比它优先级高或优先级相同的进程，则这个（新到达的）进程必须等待。

一旦 CPU 空闲，如果此时有进程在等待，则选择优先级最高的先运行。如果有多个优先级最高的进程，则选择到达时间最早的。

## 输入格式

输入包含若干行，每一行有四个自然数（均不超过 $10^8$），分别是进程号，到达时间，执行时间和优先级。不同进程有不同的编号，不会有两个相同优先级的进程同时到达。输入数据已经按到达时间从小到大排序。输入数据保证在任何时候，等待队列中的进程不超过 $15000$ 个。

## 输出格式

按照进程结束的时间输出每个进程的进程号和结束时间。

## 样例

### 样例输入 #1
```
1 1 5 3 
2 10 5 1 
3 12 7 2 
4 20 2 3 
5 21 9 4 
6 22 2 4 
7 23 5 2 
8 24 2 4 

```
### 样例输出 #1
```
1 6
3 19
5 30
6 32
8 34
4 35
7 40
2 42

```


---

---
title: "[HNOI2003] 消防局的设立"
layout: "post"
diff: 提高+/省选-
pid: P2279
tag: ['贪心', '2003', '各省省选', '湖南', '深度优先搜索 DFS', '树形 DP']
---
# [HNOI2003] 消防局的设立
## 题目描述

2020 年，人类在火星上建立了一个庞大的基地群，总共有 $n$ 个基地。起初为了节约材料，人类只修建了 $n-1$ 条道路来连接这些基地，并且每两个基地都能够通过道路到达，所以所有的基地形成了一个巨大的树状结构。如果基地 $A$ 到基地 $B$ 至少要经过 $d$ 条道路的话，我们称基地A到基地B的距离为 $d$。

由于火星上非常干燥，经常引发火灾，人类决定在火星上修建若干个消防局。消防局只能修建在基地里，每个消防局有能力扑灭与它距离不超过 $2$ 的基地的火灾。

你的任务是计算至少要修建多少个消防局才能够确保火星上所有的基地在发生火灾时，消防队有能力及时扑灭火灾。
## 输入格式

输入文件的第一行为 $n$（$1 \leq n \leq 1000$），表示火星上基地的数目。接下来的 $n-1$ 行每行有一个正整数，其中文件第 $i$ 行的正整数为 $a_i$，表示从编号为 $i$ 的基地到编号为 $a_i$ 的基地之间有一条道路，为了更加简洁的描述树状结构的基地群，有 $a_i\lt i$。
## 输出格式

仅有一个正整数，表示至少要设立多少个消防局才有能力及时扑灭任何基地发生的火灾。
## 样例

### 样例输入 #1
```
6
1
2
3
4
5

```
### 样例输出 #1
```
2
```


---

---
title: "[HNOI2003] 多项式的加法和乘法"
layout: "post"
diff: 提高+/省选-
pid: P2281
tag: ['2003', '线性数据结构', '各省省选', '平衡树', '湖南', '排序']
---
# [HNOI2003] 多项式的加法和乘法
## 题目描述

今天的数学课上，老师讲了多项式的加法和乘法。然后布置了很多计算题，小明不想花太多时间来做数学作业，于是想编写一个程序来完成这个任务。

比如计算下面两个多项式的和与积：

$xy^2z+31wx^3y^3z^{50}+s^3$  
$v^2+s^3+3wx^3y^3$

假定所有变量都是单个大写字符，所有的系数和指数都是常数，且都是整数。

我们用 `X^3` 表示 $X$ 的三次方，在系数和不同的项之间用空格分隔，例如 `X Y^2` 中，$X$ 和 $Y$ 之间有空格。下面是两个多项式的例子，除此之外没有别的空格。

`X Y^2 Z + 31 W X^3 Y^3 Z^50 + S^3`  
`V^2 + S^3 + 3 W X^3 Y^3`

现在，按照上面的格式给定两个多项式，请你求出这两个多项式的和与积。
## 输入格式

输入包括两行，每一行是一个多项式。每个多项式不超过 $250$ 个字符。计算过程中保证任何中间结果系数和指数均不超过长整数范围。
## 输出格式

输出也是两行，第一行是两个多项式的和，第二行是两个多项式的积。输出中要求合并同类项。输出多项式的格式和输入的格式类似，但输出时请把所有空格都去掉，并保证每一项都是 ASCII 码排在前面的变量放在前面，即输出 `X^3Y^2` 而不是 `Y^2X^3`。另外，输出的项请按变量 `A` 的指数从小到大排列，变量 `A` 指数相同的，按变量 `B` 的指数从小到大排列，依此类推。并注意输出要符合我们平常书写的习惯。
## 样例

### 样例输入 #1
```
A + B
3 A + 4 A B^3 + C

```
### 样例输出 #1
```
C+B+4A+4AB^3

BC+AC+3AB+4AB^4+3A^2+4A^2B^3


```


---

---
title: "[HNOI2004] 宠物收养场"
layout: "post"
diff: 提高+/省选-
pid: P2286
tag: ['2004', '各省省选', '平衡树', '湖南', '栈']
---
# [HNOI2004] 宠物收养场
## 题目背景

题面修缮来自于 [LaDeX](https://www.luogu.com.cn/user/431658)。
## 题目描述

凡凡开了一间宠物收养场。收养场提供两种服务：收养被主人遗弃的宠物和让新的主人领养这些宠物。

每个领养者都希望领养到自己满意的宠物，凡凡根据领养者的要求通过他自己发明的一个特殊的公式，得出该领养者希望领养的宠物的特点值 $a$（$a$ 是一个正整数，$a<2^{31}$），而他也给每个处在收养场的宠物一个特点值。这样他就能够很方便的处理整个领养宠物的过程了，宠物收养场总是会有两种情况发生：被遗弃的宠物过多或者是想要收养宠物的人太多，而宠物太少。

被遗弃的宠物过多时，假若到来一个领养者，这个领养者希望领养的宠物的特点值为 $a$，那么它将会领养一只目前未被领养的宠物中特点值最接近 $a$ 的一只宠物。（任何两只宠物的特点值都不可能是相同的，任何两个领养者的希望领养宠物的特点值也不可能是一样的）如果有两只满足要求的宠物，即存在两只宠物他们的特点值分别为 $a-b$ 和 $a+b$，那么领养者将会领养特点值为 $a-b$ 的那只宠物。

收养宠物的人过多，假若到来一只被收养的宠物，那么哪个领养者能够领养它呢？能够领养它的领养者，是那个希望被领养宠物的特点值最接近该宠物特点值的领养者，如果该宠物的特点值为 $a$，存在两个领养者他们希望领养宠物的特点值分别为 $a-b$ 和 $a+b$，那么特点值为 $a-b$ 的那个领养者将成功领养该宠物。

一个领养者领养了一个特点值为 $a$ 的宠物，而它本身希望领养的宠物的特点值为 $b$，那么这个领养者的不满意程度为 $|a-b|$。

你得到了一年当中，领养者和被收养宠物到来收养所的情况，请你计算所有收养了宠物的领养者的不满意程度的总和。这一年初始时，收养所里面既没有宠物，也没有领养者。
## 输入格式

第一行为一个正整数 $n$，$n\leq80000$，表示一年当中来到收养场的宠物和领养者的总数。接下来的 $n$ 行，按到来时间的先后顺序描述了一年当中来到收养场的宠物和领养者的情况。每行有两个正整数 $a,b$，其中 $a=0$ 表示宠物，$a=1$ 表示领养者，$b$ 表示宠物的特点值或是领养者希望领养宠物的特点值。（同一时间呆在收养所中的，要么全是宠物，要么全是领养者，这些宠物和领养者的个数不会超过 $10000$ 个）

## 输出格式

仅有一个正整数，表示一年当中所有收养了宠物的领养者的不满意程度的总和对 $1000000$ 取模以后的结果。

## 样例

### 样例输入 #1
```
5                  

0 2                      

0 4                         

1 3

1 2

1 5


```
### 样例输出 #1
```
3

```
## 提示

样例解释：

注：$|3-2| + |2-4|=3$，
最后一个领养者没有宠物可以领养。


---

---
title: "[HNOI2004] 树的计数"
layout: "post"
diff: 提高+/省选-
pid: P2290
tag: ['数学', '2004', '各省省选', '湖南', '组合数学', '排列组合']
---
# [HNOI2004] 树的计数
## 题目描述

一个有 $n$ 个节点的树，设它的节点分别为 $v_1,v_2,\ldots,v_n$，已知第 $i$ 个节点 $v_i$ 的度数为 $d_i$，问满足这样的条件的不同的树有多少棵。

## 输入格式

输入文件第一行是一个正整数 $n$ ，表示树有 $n$ 个结点。第二行有 $n$ 个数，第 $i$ 个数表示 $d_i$，即树的第 $i$ 个结点的度数。
## 输出格式

输出满足条件的树有多少棵。

## 样例

### 样例输入 #1
```
4                     
2 1 2 1

```
### 样例输出 #1
```
2
```
## 提示

$1\le n\le 150$，保证满足条件的树不超过 $10^{17}$ 个。


---

---
title: "[SDOI2012] Longge 的问题"
layout: "post"
diff: 提高+/省选-
pid: P2303
tag: ['数学', '2012', '各省省选', '山东', 'O2优化', '欧拉函数']
---
# [SDOI2012] Longge 的问题
## 题目背景

Longge 的数学成绩非常好，并且他非常乐于挑战高难度的数学问题。
## 题目描述

现在问题来了：给定一个整数 $n$，你需要求出 $\sum\limits_{i=1}^n \gcd(i, n)$，其中 $\gcd(i, n)$ 表示 $i$ 和 $n$ 的最大公因数。  
## 输入格式

输入只有一行一个整数，表示 $n$。
## 输出格式

输出一行一个整数表示答案。
## 样例

### 样例输入 #1
```
6

```
### 样例输出 #1
```
15
```
## 提示

#### 数据规模与约定

- 对于 $60\% $ 的数据，保证 $n\leq 2^{16}$。
- 对于 $100\% $ 的数据，保证 $1\leq n< 2^{32}$。


---

---
title: "[HNOI2006] 超级英雄"
layout: "post"
diff: 提高+/省选-
pid: P2319
tag: ['2006', '各省省选', '湖南', 'Special Judge', '二分图']
---
# [HNOI2006] 超级英雄
## 题目描述

现在电视台有一种节目叫做超级英雄，大概的流程就是每位选手到台上回答主持人的几个问题，然后根据回答问题的多少获得不同数目的奖品或奖金。主持人问题准备了若干道题目，只有当选手正确回答一道题后，才能进入下一题，否则就被淘汰。为了增加节目的趣味性并适当降低难度，主持人总提供给选手几个“锦囊妙计”，比如求助现场观众，或者去掉若干个错误答案（选择题）等等。


这里，我们把规则稍微改变一下。假设主持人总共有m道题，选手有n种不同的“锦囊妙计”。主持人规定，每道题都可以从两种“锦囊妙计”中选择一种，而每种“锦囊妙计”只能用一次。我们又假设一道题使用了它允许的锦囊妙计后，就一定能正确回答，顺利进入下一题。现在我来到了节目现场，可是我实在是太笨了，以至于一道题也不会做，每道题只好借助使用“锦囊妙计”来通过。如果我事先就知道了每道题能够使用哪两种“锦囊妙计”，那么你能告诉我怎样选择才能通过最多的题数吗？

## 输入格式

输入的第一行是两个正整数 $n$ 和 $m$ ($0 < n < 1001, 0 < m < 1001$)表示总共有 n 种“锦囊妙计”，编号为 $0 \sim n-1$，总共有 $m$ 个问题。


以下的m行，每行两个数，分别表示第 $m$ 个问题可以使用的“锦囊妙计”的编号。

**注意**，每种编号的“锦囊妙计”只能使用一次，同一个问题的两个“锦囊妙计”可能一样。

## 输出格式

输出的第一行为最多能通过的题数 $p$，接下来 $p$ 行，每行为一个整数，第 $i$ 行表示第 $i$ 题使用的“锦囊妙计的编号”。


如果有多种答案，那么任意输出一种，本题使用 Special Judge 评判答案。

## 样例

### 样例输入 #1
```
5 6
3 2
2 0
0 3
0 4
3 2
3 2
```
### 样例输出 #1
```
4
3
2
0
4
```
## 提示

感谢@zhouyonglong 提供special Judge



---

---
title: "[HNOI2006] 最短母串问题"
layout: "post"
diff: 提高+/省选-
pid: P2322
tag: ['字符串', '2006', '各省省选', '湖南', '状压 DP']
---
# [HNOI2006] 最短母串问题
## 题目描述

给定  $n$ 个字符串  $(S_1,S_2,...,S_n)$，要求找到一个最短的字符串  $T$，使得这  $n$ 个字符串  $(S_1,S_2,...,S_n)$ 都是  $T$ 的子串。
## 输入格式

输入文件第一行是一个整数  $n$，表示给定的字符串个数。接下来  $n$ 行，每行有一个全由大写字母组成的字符串，。
## 输出格式

输出文件只有一行，为找到的最短的字符串  $T$。在保证最短的前提下，如果有多个字符串都满足要求，那么必须输出按字典序排列的第一个。
## 样例

### 样例输入 #1
```
2

ABCD

BCDABC
```
### 样例输出 #1
```
ABCDABC
```
## 提示

对于 $100\%$ 的数据，$n\leq 12$，每个字符串的长度不超过  $50$。


---

---
title: "[SCOI2005] 骑士精神"
layout: "post"
diff: 提高+/省选-
pid: P2324
tag: ['搜索', '2005', '四川', '各省省选', '启发式搜索', '启发式迭代加深搜索 IDA*', 'A*  算法']
---
# [SCOI2005] 骑士精神
## 题目描述

![](https://cdn.luogu.com.cn/upload/pic/1389.png)

## 输入格式

第一行有一个正整数 $T$（$T \le 10$)，表示一共有 $T$ 组数据。

接下来有 $T$ 个 $5 \times 5$ 的矩阵，`0` 表示白色骑士，`1` 表示黑色骑士，`*` 表示空位。两组数据之间没有空行。

## 输出格式

对于每组数据都输出一行。如果能在 $15$ 步以内（包括 $15$ 步）到达目标状态，则输出步数，否则输出 `-1`。

## 样例

### 样例输入 #1
```
2
10110
01*11
10111
01001
00000
01011
110*1
01110
01010
00100

```
### 样例输出 #1
```
7
-1

```
## 提示

![](https://cdn.luogu.com.cn/upload/pic/1390.png)



---

---
title: "[SCOI2005] 王室联邦"
layout: "post"
diff: 提高+/省选-
pid: P2325
tag: ['搜索', '2005', '四川', '各省省选', 'Special Judge', '深度优先搜索 DFS', '栈']
---
# [SCOI2005] 王室联邦
## 题目描述

“余”人国的国王想重新编制他的国家。他想把他的国家划分成若干个省，每个省都由他们王室联邦的一个成员来管理。

他的国家有 $N$ 个城市，编号为 $1\ldots N$。

一些城市之间有道路相连，任意两个不同的城市之间有且仅有一条直接或间接的道路。

为了防止管理太过分散，每个省至少要有 $B$ 个城市。

为了能有效的管理，每个省最多只有 $3\times B$ 个城市。

每个省必须有一个省会，这个省会可以位于省内，也可以在该省外。

但是该省的任意一个城市到达省会所经过的道路上的城市（除了最后一个城市，即该省省会）都必须属于该省。

一个城市可以作为多个省的省会。

聪明的你快帮帮这个国王吧！
## 输入格式

第一行包含两个数 $N,B$。

接下来 $N－1$ 行，每行描述一条边，包含两个数，即这条边连接的两个城市的编号。
## 输出格式

如果无法满足国王的要求，输出 $0$。

否则第一行输出数 $K$，表示你给出的划分方案中省的个数。

第二行输出 $N$ 个数，第 $I$ 个数表示编号为 $I$ 的城市属于的省的编号。要求城市编号在 $[1,K]$ 范围内。

第三行输出 $K$ 个数，表示这 $K$ 个省的省会的城市编号。

如果有多种方案，你可以输出任意一种。
## 样例

### 样例输入 #1
```
8 2 
1 2 
2 3 
1 8 
8 7 
8 6 
4 6 
6 5 

```
### 样例输出 #1
```
3 
2 1 1 3 3 3 3 2 
2 1 8 

```
## 提示

对于 $100\%$ 的数据，$1\le B\leq N\le 10^3$。

感谢 @[FlierKing](/user/9433) 提供 spj。


---

---
title: "[SCOI2005] 超级格雷码"
layout: "post"
diff: 提高+/省选-
pid: P2328
tag: ['2005', '四川', '各省省选', 'Special Judge', '枚举', '进制']
---
# [SCOI2005] 超级格雷码
## 题目描述

![](https://cdn.luogu.com.cn/upload/pic/1392.png)

## 输入格式

只有一行，为两个整数n和B。

## 输出格式

一共B^n个行，每行一个B进制数，表示你所求得的符合条件的排列。

## 样例

### 样例输入 #1
```
2  2
```
### 样例输出 #1
```
00
01
11
10

```
## 提示

感谢@Night_Aurora 提供SPJ


---

---
title: "[SCOI2005] 最大子矩阵"
layout: "post"
diff: 提高+/省选-
pid: P2331
tag: ['动态规划 DP', '递推', '2005', '四川', '各省省选', '前缀和']
---
# [SCOI2005] 最大子矩阵
## 题目描述

这里有一个 $n \times m$ 的矩阵，请你选出其中 $k$ 个子矩阵，使得这个 $k$ 个子矩阵分值之和最大。

注意：选出的 $k$ 个子矩阵不能相互重叠。
## 输入格式

第一行为 $n,m,k$，接下来 $n$ 行描述矩阵每行中的每个元素的分值（每个元素的分值的绝对值不超过 $32767$）。
## 输出格式

只有一行为 $k$ 个子矩阵分值之和最大为多少。
## 样例

### 样例输入 #1
```
3 2 2

1 -3

2 3

-2 3


```
### 样例输出 #1
```
9
```
## 提示

对于 $100 \%$ 的数据，$1 \leq n \leq 100$，$1 \leq m \leq 2$，$1 \leq k \leq 10$。


---

---
title: "[SCOI2006] 数字立方体"
layout: "post"
diff: 提高+/省选-
pid: P2332
tag: ['2006', '四川', '各省省选']
---
# [SCOI2006] 数字立方体
## 题目描述

有一个立方体被分成 $n\times n\times n$ 的单位，坐标用 $(X,Y,Z)$ 表示 $(1\le X,Y,Z\le n)$。每个单位立方体内有一个绝对值不超过 $10^9$ 的整数。统计有多少个子立方体的所有数之和是 $m$ 的倍数。子立方体即满足 $x_1\le X\le x_2$，$y_1\le Y\le y_2$，$z_1\le Z\le z_2$ 的所有单位立方体集合，其中 $1\le x_1,x_2,y_1,y_2,z_1,z_2\le n$。

## 输入格式

第一行有两个整数 $n, m$，表示立方体的边长和作除数的正整数。

以下 $n\times n$ 行，每行有 $n$ 个整数。首先是 $X=1, Y=1$ 的 $n$ 个单位立方体，然后是 $X=1, Y=2$ 的 $n$ 个…最后是 $X=n, Y=n-1$ 的 $n$ 个和 $X=n$ 和 $Y=n$ 的 $n$ 个，共 $n^3$ 个整数。

## 输出格式

输出仅包含一个数，即所有整数和为 $m$ 的倍数的子立方体的个数。

## 样例

### 样例输入 #1
```
2 5
1 2
3 4
5 6
7 8

```
### 样例输出 #1
```
5
```
## 提示

### 数据范围及约定

- $30\%$ 的数据满足 $1\le n\le 10$。
- $100\%$ 的数据满足 $1\le n\le 40$。

对于所有的数据满足 $1\le m\le 10^6$。



---

---
title: "[SCOI2006] 城堡"
layout: "post"
diff: 提高+/省选-
pid: P2334
tag: ['2006', '四川', '各省省选', 'O2优化']
---
# [SCOI2006] 城堡
## 题目描述

为了救出心爱的公主 Julie，Billy 来到了恶魔的城堡。经过了三天三夜的浴血奋战，魔王殿已近在咫尺。

这是一条狭长的通道，Billy 在位置 $0$，而魔王殿在位置 $n + 1$。在每个单位时间，Billy 可以往左或往右移动一个单位，或者原地不动。每个格子的上方都有石头周期性的往下砸，格子 $i$ 的周期为 $c_i$。

对于格子 $i$ 上方的石头，可以用 $c_i$ 个整数来描述：$h_1, h_2, \cdots, h_{c_i}$，表示在时间 $t = kc_i + x$（$1\leq x\leq c_i$）时处于该格子上将被砸掉 $h_x$ 格血。其中 $h_x = 0$ 表示该时刻没有石头砸下来。

计算 Billy 最少损失多少格血后可以到达魔王殿。假设 Billy 是不会死的。注意从位置 $1$ 也是可以回到位置 $0$ 的，且在位置 $0$ 不损血。

## 输入格式

第一行包括一个整数 $n$，表示通道的长度。

以下 $n$ 行，依次表示格子 $1, 2, \cdots, n$ 的情况。每行第一个整数为 $c_i$，表示石头下落周期，接下来有 $c_i$ 个整数，分别为 $h_1, h_2, \cdots, h_{c_i}$。

## 输出格式

包含一个整数 HP，表示血的最小损失。
## 样例

### 样例输入 #1
```
4
2 1 0
2 0 1
1 2
7 0 1 1 1 1 1 1

```
### 样例输出 #1
```
2
```
## 提示

对于 $50\%$ 的数据，$n\leq 20$；

对于 $100\%$ 的数据满足：$0\leq n\leq 1000$，$1\leq c_i\leq 10$，$0\leq h_x\leq 100$。

- 2023.4.12 添加一组 hack 数据，不计分。


---

---
title: "[SDOI2010] 所驼门王的宝藏"
layout: "post"
diff: 提高+/省选-
pid: P2403
tag: ['2010', '各省省选', '山东', '拓扑排序', '强连通分量', 'Tarjan']
---
# [SDOI2010] 所驼门王的宝藏
## 题目描述

在宽广的非洲荒漠中，生活着一群勤劳勇敢的羊驼家族。被族人恭称为“先知”的 AlpacaL.Sotomon 是这个家族的领袖，外人也称其为“所驼门王”。所驼门王毕生致力于维护家族的安定与和谐，他曾亲自率军粉碎河蟹帝国主义的野蛮侵略，为族人立下赫赫战功。所驼门王一生财宝无数，但因其生性节俭低调，他将财宝埋藏在自己设计的地下宫殿里，这也是今天 Henry Curtis 故事的起点。Henry 是一个爱财如命的贪婪家伙，而又非常聪明，他费尽心机谋划了这次盗窃行动，破解重重机关后来到这座地下宫殿前。

整座宫殿呈矩阵状，由 $R \times C$ 间矩形宫室组成，其中有 $N$ 间宫室里埋藏着宝藏，称作藏宝宫室。宫殿里外、相邻宫室间都由坚硬的实体墙阻隔，由一间宫室到达另一间只能通过所驼门王独创的移动方式——传送门。所驼门王为这 $N$ 间藏宝宫室每间都架设了一扇传送门，没有宝藏的宫室不设传送门，所有的宫室传送门分为三种：

1. “横天门”：由该门可以传送到同行的任一宫室；
2. “纵寰门”：由该门可以传送到同列的任一宫室；
3. “任意门”：由该门可以传送到以该门所在宫室为中心周围 $8$ 格中任一宫室（如果目标宫室存在的话）。

深谋远虑的 Henry 当然事先就搞到了所驼门王当年的宫殿招标册，书册上详细记录了每扇传送门所属宫室及类型。而且，虽然宫殿内外相隔，但他自行准备了一种便携式传送门，可将自己传送到殿内任意一间宫室开始寻宝，并在任意一间宫室结束后传送出宫。整座宫殿只许进出一次，且便携门无法进行宫室之间的传送。不过好在宫室内传送门的使用没有次数限制，每间宫室也可以多次出入。

现在 Henry 已经打开了便携门，即将选择一间宫室进入。为得到尽多宝藏，他希望安排一条路线，使走过的不同藏宝宫室尽可能多。请你告诉 Henry 这条路线最多行经不同藏宝宫室的数目。
## 输入格式

第一行给出三个正整数 $N,R,C$。

以下 $N$ 行，每行给出一扇传送门的信息，包含三个正整数 $x_i,y_i,T_i$，表示该传送门设在位于第 $x_i$ 行第 $y_i$ 列的藏宝宫室，类型为 $T_i$。$T_i$ 是一个 $1 \sim 3$ 间的整数，$1$ 表示可以传送到第 $x_i$ 行任意一列的“横天门”，$2$ 表示可以传送到任意一行第 $y_i$ 列的“纵寰门”，$3$ 表示可以传送到周围 $8$ 格宫室的“任意门”。

保证 $1 \le x_i \le R$，$1 \le y_i \le C$，所有的传送门位置互不相同。
## 输出格式

输出只有一个正整数，表示你确定的路线所经过不同藏宝宫室的最大数目。

## 样例

### 样例输入 #1
```
10 7 7
2 2 1
2 4 2
1 7 2
2 7 3
4 2 2
4 4 1
6 7 3
7 7 1
7 5 2
5 2 1
```
### 样例输出 #1
```
9
```
## 提示

数据规模和约定：

![](https://cdn.luogu.com.cn/upload/pic/1594.png)



---

---
title: "[SDOI2009] 地图复原"
layout: "post"
diff: 提高+/省选-
pid: P2407
tag: ['2009', '各省省选', '山东', '最短路']
---
# [SDOI2009] 地图复原
## 题目描述

很久以前，有一个传说中的“EWF”部族，他们世代生活在一个N×M的矩形大地上。虽然，生活的地区有高山、有沼泽，但通过勤劳勇敢，渐渐地，他们在自己的地盘上修筑了一条回路。

后来，“EWF”部族神秘地消失了。不过，考古学家在那片他们曾经生活过的地方找到了一份地图。地图是N×M的矩阵，左上角的坐标为(0, 0)，右下角的坐标为(N, M)。矩阵中的每个格子，表示高山、沼泽、平地、房屋或是道路其中之一。如果一个格子表示道路，那么经过这个格子的道路要么是直走，要么是拐弯。如下图，左边2幅表示直走格子的，右边4幅表示需要拐弯的格子。一个表示道路的格子只能表示下列情况之一。

 ![](https://cdn.luogu.com.cn/upload/pic/1588.png) 

可是，由于地图的年代久远，考古学家虽然能分清一个格子代表的地形，可对于道路的标记，考古学家们只能分清这一格是表示直走的还是拐弯的。现在，他们求助于你，希望你能帮助他们复原这份“EWF”部族的地图。

## 输入格式

输入文件recover.in的第一行包含两个用空格分隔的正整数N和M，分别表示地图的高和长。

接下来一个N行M列的矩阵描述地图，矩阵中没有多余字符。

大写“S”表示直走的道路，大写“T”表示拐弯的道路，点“.”表示高山、沼泽、平地和房屋。

## 输出格式

输出文件recover.out包含2N-1行，每行2M-1个字符，描述了这条回路。

所有第2i+1行的2j+1个字符为小写字母o，表示了矩阵的第i行第j列的格子的中心(i, j)。

若回路包含了(i, j)到(i, j+1)或(i, j+1)到(i, j)的一条路径，则第2i+1行的第2j+2个字符为减号“-”（ASCII码为45）；

若回路包含了(i, j)到(i+1, j)或(i+1, j)到(i, j)的一条路径，则第2i+2行的第2j+1个字符为竖线“|”（ASCII码为124）。

其它以上未说明位置上的字符为空格（ASCII码为32）。

输入数据保证至少存在一个合法解，故你的输出应有且仅有一条回路。如果存在多组答案，请输出任意一组。

## 样例

### 样例输入 #1
```
3 4
TST.
S.TT
TSST

```
### 样例输出 #1
```
o-o-o o
|   |  
o o o-o
|     |
o-o-o-o

```
## 提示

对于20%的数据，有N ≤ 10；

对于40%的数据，有1 ≤ N, M ≤ 80；

对于40%的数据，输入没有“.”,且N, M > 10；

对于100%的数据，满足1 ≤ N, M ≤ 800。



---

---
title: "[SDOI2005] 解环"
layout: "post"
diff: 提高+/省选-
pid: P2438
tag: ['2005', '各省省选', '山东']
---
# [SDOI2005] 解环
## 题目背景

拜特兰并不总是一个非常民主的国家，也有一些阴暗的历史。一个美好的日子，拜特将军（该国的统帅）作了一个用以结束长期内战的决定，释放被关押的反对派。然而，他并未让反对派的领袖拜特萨直接自由，而是用一根“拜特链”将拜特萨锁在墙边.该链子由很多环和固定在墙上栅栏组成。尽管环并未和栅栏融合在一起，但想除去它们却非常困难。

“将军，你为什么要用链子将我锁在墙边而不让我自由！”拜特萨大叫道。

“拜特萨，你并未完全被链子锁住，我可以坦率的告诉你，你完全可以从栅栏上解下环。”拜特将军回答，同时他补充说，“但是，你必须在夜里工作，一个小时之内完成，不能弄出任何声音，否则，我将按有关法律治罪。”

## 题目描述

为了帮助拜特萨！链子上的环按整数1,2,…,n进行了编号。我们可以按照以下规则解开环：

    只有一个环时可以被连接到栅栏或从栅栏上拆开。

    第1号环总能进行连接或拆开

    如果1,...,k-1 (1<=k<n)环都被拆开，第k个环被连接时, 此时我们能连接或拆开 第k+1个环.


写一个程序：

输入描述了拜特链的构成,

计算拆除拜特链上全部环的最少操作次数,

将结果输出。

## 输入格式

第1行有一个整数n, 1<=n<=1 000.在第2行有n个用一个空格分隔的整数 o1,o2,...,on (每个都是0或1)，如果 oi=1, 那么第I个环和栅栏相连，如果 oi=0, 那么第I环没有和栅栏相连。

## 输出格式

只包含一个整数，为解开拜特链的全部环的最少操作次数。

## 样例

### 样例输入 #1
```
4

1 0 1 0


```
### 样例输出 #1
```
6
```


---

---
title: "[SDOI2010] 大陆争霸"
layout: "post"
diff: 提高+/省选-
pid: P2446
tag: ['2010', '各省省选', '山东', '最短路']
---
# [SDOI2010] 大陆争霸
## 题目背景

在一个遥远的世界里有两个国家：位于大陆西端的杰森国和位于大陆东端的克里斯国。两个国家的人民分别信仰两个对立的神：杰森国信仰象征黑暗和毁灭的神曾·布拉泽，而克里斯国信仰象征光明和永恒的神斯普林·布拉泽。

幻想历 $8012$ 年 $1$ 月，杰森国正式宣布曾·布拉泽是他们唯一信仰的神，同时开始迫害在杰森国的信仰斯普林·布拉泽的克里斯国教徒。

幻想历 $8012$ 年 $3$ 月 $2$ 日，位于杰森国东部小镇神谕镇的克里斯国教徒发动起义。

幻想历 $8012$ 年 $3$ 月 $7$ 日，神谕镇的起义被杰森国大军以残酷手段镇压。

幻想历 $8012$ 年 $3$ 月 $8$ 日，克里斯国对杰森国宣战。由数十万大军组成的克里斯军团开至两国边境，与杰森军团对峙。

幻想历 $8012$ 年 $4$ 月，克里斯军团攻破杰森军团防线进入神谕镇，该镇幸存的克里斯国教徒得到解放。

战争随后进入胶着状态，旷日持久。战况惨烈，一时间枪林弹雨，硝烟弥漫，民不聊生。
## 题目描述

幻想历 $8012$ 年 $5$ 月 $12$ 日深夜，斯普林·布拉泽降下神谕：“Trust me, earn eternal life.”克里斯军团士气大增。作为克里斯军团的主帅，你决定利用这一机会发动奇袭，一举击败杰森国。具体地说，杰森国有 $N$ 个城市，由 $M$ 条单向道路连接。神谕镇是城市 $1$ 而杰森国的首都是城市 $N$。你只需摧毁位于杰森国首都的曾·布拉泽大神殿，杰森国的信仰，军队还有一切就都会土崩瓦解，灰飞烟灭。

为了尽量减小己方的消耗，你决定使用自爆机器人完成这一任务。唯一的困难是，杰森国的一部分城市有结界保护，不破坏掉结界就无法进入城市。而每个城市的结界都是由分布在其他城市中的一些结界发生器维持的，如果想进入某个城市，你就必须破坏掉维持这个城市结界的所有结界发生器。

现在你有无限多的自爆机器人，一旦进入了某个城市，自爆机器人可以瞬间引爆，破坏一个目标（结界发生器，或是杰森国大神殿），当然机器人本身也会一起被破坏。你需要知道：摧毁杰森国所需的最短时间。

## 输入格式

第一行两个正整数 $N,M$。

接下来 $M$ 行，每行三个正整数 $u_i,v_i,w_i$，表示有一条从城市 $u_i$ 到城市 $v_i$ 的单向道路，自爆机器人通过这条道路需要 $w_i$ 的时间。

之后 $N$ 行，每行描述一个城市。首先是一个正整数 $l_i$，维持这个城市结界所使用的结界发生器数目。之后 $l_i$ 个 $1\ldots N$ 之间的城市编号，表示每个结界发生器的位置。如果 $l_i=0$，则说明该城市没有结界保护，保证 $l_1 = 0$ 。
## 输出格式

仅包含一个正整数 ，击败杰森国所需的最短时间。
## 样例

### 样例输入 #1
```
6 6
1 2 1
1 4 3
2 3 1
2 5 2
4 6 2
5 3 2
0
0
0
1 5
0
2 3 5
```
### 样例输出 #1
```
5
```
## 提示

![](https://cdn.luogu.com.cn/upload/pic/1590.png)

![](https://cdn.luogu.com.cn/upload/pic/1591.png)

对于 $20\%$ 的数据，满足 $N\leq 15$，$M≤50$；

对于 $50\%$ 的数据，满足 $N\leq 500$，$M\leq 6\times 10^3$；

对于 $100\%$ 的数据，满足 $1\leq N\leq 3\times 10^3$，$1\leq M\leq 7\times 10^4$，$1\leq w_i\leq 10^8$。

输入数据保证一定有解，且不会存在维持某个城市结界的结界发生器在这个城市内部。

连接两个城市的道路可能不止一条，也可能存在一个城市自己到自己的道路。


---

---
title: "[SDOI2010] 外星千足虫"
layout: "post"
diff: 提高+/省选-
pid: P2447
tag: ['2010', '各省省选', '山东', 'Special Judge', '高斯消元', '位运算']
---
# [SDOI2010] 外星千足虫
## 题目描述

公元 $2333$ 年 $2$ 月 $3$ 日，在经历了 $17$ 年零 $3$ 个月的漫长旅行后，“格纳格鲁一号”载人火箭返回舱终于安全着陆。此枚火箭由美国国家航空航天局（NASA）研制发射，行经火星、金星、土卫六、木卫二、谷神星、“张衡星”等 $23$ 颗太阳系星球，并最终在小行星“杰森星”探寻到了地外生命。宇航员在“杰森星”地表岩层下 $45.70$ 米位置发现一批珍贵的活体生命样本，并将其带回检测。

在带回的活体样本中，最吸引人的当属这些来自外星的千足虫了。这些虫子身躯纤长，身体分为若干节。受到触碰时，会将身体卷曲成圆环形，间隔一段时间后才会复原活动。

有趣的还不止如此。研究人员发现，这些虫子的足并不像地球千足虫成对出现、总共偶数条——它们每节身体下方都有着不定数量的足，但足的总数一定是奇数条！

虽然从外观难以区分二者，但通过统计足的数目，科学家们就能根据奇偶性判断出千足虫所属的星球。

![](https://cdn.luogu.com.cn/upload/pic/1592.png)

作为 J 国派去 NASA 的秘密间谍，你希望参加这次研究活动以掌握进一步的情报，而 NASA 选拔的研究人员都是最优秀的科学家。于是 NASA 局长 Charles Bolden 出了一道难题来检测你的实力：

现在你面前摆有 $1\ldots N$ 编号的 $N$ 只千足虫，你的任务是鉴定每只虫子所属的星球，但不允许亲自去数它们的足。

Charles 每次会在这 $N$ 只千足虫中选定若干只放入“昆虫点足机”（the Insect Feet Counter, IFC）中，“点足机”会自动统计出其内所有昆虫足数之和。Charles 会将这个和数 $\bmod$ $2$ 的结果反馈给你，同时告诉你一开始放入机器中的是哪几只虫子。

他的这种统计操作总共进行 $M$ 次，而你应当尽早得出鉴定结果。

![](https://cdn.luogu.com.cn/upload/pic/1593.png)

假如在第 $K$ 次统计结束后，现有数据就足以确定每只虫子的身份，你就还应将这个 $K$ 反馈给 Charles，此时若 $K<M$，则表明那后 $M-K$ 次统计并非必须的。

如果根据所有 $M$ 次统计数据还是无法确定每只虫子身份，你也要跟 Charles 讲明：就目前数据会存在多个解。
## 输入格式

第一行是两个正整数 $N,M$。

接下来 $M$ 行，按顺序给出 Charles 这 $M$ 次使用“点足机”的统计结果。每行包含一个 $01$ 串和一个数字，用一个空格隔开。$01$ 串按位依次表示每只虫子是否被放入机器：如果第 $i$ 个字符是 $0$ 则代表编号为 $i$ 的虫子未被放入，$1$ 则代表已被放入。后面跟的数字是统计的昆虫足数 $\bmod$ $2$ 的结果。

由于 NASA 的实验机器精确无误，保证前后数据不会自相矛盾。即给定数据一定有解。
## 输出格式

在给定数据存在唯一解时有 $N+1$ 行，第一行输出一个不超过 $M$ 的正整数 $K$，表明在第 $K$ 次统计结束后就可以确定唯一解；接下来N行依次回答每只千足虫的身份，若是奇数条足则输出 `?y7M#`（火星文），偶数条足输出 `Earth`。

如果输入数据存在多解，输出 `Cannot Determine`。
## 样例

### 样例输入 #1
```
3 5
011 1
110 1
101 0
111 1
010 1
```
### 样例输出 #1
```
4
Earth
?y7M#
Earth
```
### 样例输入 #2
```
5 7
01100 1
11000 1
10100 0
11100 1
00011 1
00000 0
11111 0
```
### 样例输出 #2
```
Cannot Determine
```
## 提示

### 评分标准

对于每一个测试点，如果你的输出文件与答案文件完全相同，该测试点得满分。

否则，对于存在唯一解的测试点，如果你正确回答所有千足虫的身份，将得到 $50\%$ 的分数；

其他情况，该测试点得零分。

### 数据规模和约定

对于 $20\%$ 的数据，满足 $N=M\leq 20$；

对于 $40\%$ 的数据，满足 $N=M\leq 500$；

对于 $70\%$ 的数据，满足 $N\leq500$，$M\leq 10^3$；

对于 $100\%$ 的数据，满足 $1\leq N\leq 10^3$，$1\leq M\leq 2\times 10^3$。


---

---
title: "[SDOI2005] 遗传代码"
layout: "post"
diff: 提高+/省选-
pid: P2451
tag: ['2005', '各省省选', '山东']
---
# [SDOI2005] 遗传代码
## 题目描述

抽象的 primitivus（Primitivus 循环）的遗传代码是一系列自然数 $K=(A_1,A_2,\cdots,A_n)$。我们所说的 primitivus 的特征是一个数对 $(l,r)$，表示 $l,r$ 在 $A$ 中**连续出现**。即存在一个 $i$，使得 $A_i=l$，$A_{i+1}=r$。在 primitivus 的遗传代码中没有 $(p,p)$ 特征。

### 任务

写一个程序：

1. 从文本文件读特征列表；
2. 计算所给特征的最短遗传代码长度；
3. 输出答案。

## 输入格式

第一行有一个正整数 $n$，它是 primitivus 的不同特征的数量。

接下来 $n$ 行，每一行中有两个被空格号隔开的数字 $l$ 和 $r$。数字对 $(l,r)$ 是 primitivus 的一个特征。在输入文件中，特征并不重复。

## 输出格式

共一行一个整数，为 primitivus 最短遗传代码的长度。

## 样例

### 样例输入 #1
```
12

2 3

3 9

9 6

8 5

5 7

7 6

4 5

5 1

1 4

4 2

2 8

8 6


```
### 样例输出 #1
```
15
```
## 提示

### 样例解释

以下是一种符合题意的最短的遗传代码。它符合输入数据中给出的所有的特征：

$(8, 5, 1, 4, 2, 3, 9, 6, 4, 5, 7, 6, 2, 8, 6) $

### 数据范围及约定

对于全部数据，满足 $0 \le l \le 1000$，$0 \le  r \le  1000$。


---

---
title: "[SDOI2006] 最短距离"
layout: "post"
diff: 提高+/省选-
pid: P2453
tag: ['动态规划 DP', '2006', '各省省选', '山东']
---
# [SDOI2006] 最短距离
## 题目描述

一种 EDIT 字母编辑器，它的功能是可以通过不同的变换操作可以把一个源串 $X[l\cdots m]$ 变换为新的目标串 $Y[1\cdots n]$。EDIT 提供的变换操作有：

- 删除源串首个字符（delete）；
- 替换源串首个字符放到目标串末尾（replace）。replace 操作可以替换为与原来相同的字符；
- 移动源串首个字符放到目标串末尾（copy）；
- 向目标串插入单个字符（insert）；
- 交换源串中的两个相邻字符，并移动到目标串末尾中去（twiddle）；
- 在完成其它所有操作之后，源串中余下的全部后缀就可用删至行末的操作删除（kill）。

例如，将源 `algorithm` 转换成目标串 `altruistic` 的一种方法是采取下面的操作序列：

| 操作 | 目标串 | 原串 |
| :----------: | :----------: | :----------: |
| 初始 | （空） | `algorithm` |
| `copy a` | `a` | `lgorithm` |
| `copy l` | `al` | `gorithm` |
| `replace g to t` | `alt` | `orithm` |
| `delete o` | `alt` | `rithm` |
| `copy r` | `altr` | `ithm` |
| `insert u` | `altru` | `ithm` |
| `insert i` | `altrui` | `ithm` |
| `insert s` | `altruis` | `ithm` |
| `twiddle it into ti` | `altruisti` | `hm` |
| `replace h to c` | `altruistic` | `m` |
| `kill` | `altruistic` | （空） |



要达到这个结果还可能有其它一些操作序列。

操作 delete、replace、copy、insert、twiddle 和kill中每一个都有一个相联系的代价 cost。例如：

```plain
cost(delete) =3;
cost(replace)=6;
cost(copy)   =5;
cost(insert) =4;
cost(twiddle)=4;
cost(kill) = 被删除的串长 * cost(delete) - 1;
```

一个给定的操作序列的代价为序列中各操作代价之和。
例如上述操作序列的代价为

$$\begin{aligned}&3\times \mathrm{cost}(\mathtt{copy})+2\times \mathrm{cost}(\mathtt{replace})+\mathrm{cost}(\mathtt{delete})+3\times \mathrm{cost}(\mathtt{insert}) \\ &+\mathrm{cost}(\mathtt{twiddle}) +\mathrm{cost}(\mathtt{kill}) \\
=\ & 3\times 5+2\times 6+3+3\times 4+4+1\times 3-1\\
=\ &48\end{aligned}$$

**编程任务**

给定两个序列 $X[1\cdots m],Y[1\cdots n]$ 和一些操作代价集合，$X$ 到 $Y$ 的最短距离为将 $X$ 转化为 $Y$ 的最小的转换序列的代价。请给出一个算法来找出 $X[1\cdots m]$ 至 $Y[1\cdots n]$ 的最短距离。

## 输入格式

第一行：源序列 $X[1\cdots m]$。

第二行：目标序列 $Y[1\cdots n]$。

第三行：$5$ 个正整数，分别是：delete、replace、copy、insert、twiddle 的代价。

## 输出格式

一行一个整数，表示 $X$ 到 $Y$ 的最短距离（最小代价和）。

## 样例

### 样例输入 #1
```
algorithm

altruistic

3 6 5 4 4
```
### 样例输出 #1
```
48
```
## 提示

### 数据范围及约定

对于全部数据，满足 $1\le n,m\le 200$，且所有代价均为不大于 $100$ 的非负整数。


---

---
title: "[SDOI2006] 线性方程组"
layout: "post"
diff: 提高+/省选-
pid: P2455
tag: ['2006', '各省省选', '山东', 'Special Judge', '素数判断,质数,筛法', '最大公约数 gcd', '排列组合', '高斯消元']
---
# [SDOI2006] 线性方程组
## 题目描述

已知 $n$ 元线性一次方程组。

$$ \begin{cases} a_{1, 1} x_1 + a_{1, 2} x_2 + \cdots + a_{1, n} x_n = b_1 \\ a_{2, 1} x_1 + a_{2, 2} x_2 + \cdots + a_{2, n} x_n = b_2 \\ \cdots \\ a_{n,1} x_1 + a_{n, 2} x_2 + \cdots + a_{n, n} x_n = b_n \end{cases}$$

请根据输入的数据，编程输出方程组的解的情况。
## 输入格式

第一行输入未知数的个数 $n$。  
接下来 $n$ 行，每行 $n + 1$ 个整数，表示每一个方程的系数及方程右边的值。

## 输出格式

如果有唯一解，则输出解。你的结果被认为正确，当且仅当对于每一个 $x_i$ 而言结果值与标准答案值的绝对误差或者相对误差不超过 $0.01$。

如果方程组无解输出 $-1$；
如果有无穷多实数解，输出 $0$；
## 样例

### 样例输入 #1
```
3
2 -1 1 1
4 1 -1 5
1 1 1 0
```
### 样例输出 #1
```
x1=1.00
x2=0.00
x3=-1.00

```
## 提示

【数据范围】  
对于 $100\%$ 的数据，$1 \le n \le 50$。对于 $\forall 1\le i, j \le n$，有 $|a_{i, j}| \le 100$，$|b_i| \le 300$。


---

---
title: "[SDOI2006] 二进制方程"
layout: "post"
diff: 提高+/省选-
pid: P2456
tag: ['字符串', '高精度', '2006', '各省省选', '山东', '进制']
---
# [SDOI2006] 二进制方程
## 题目描述

一个形如：

X1X2…Xn=Y1Y2..Ym 

的等式称为二进制方程。

在二进制方程的两边：Xi和Yj （1<=i<=n；1<=j<=m）是二进制数字（0、1）或者一个变量（小写字母）。每个变量都是一个有固定长度的二进制代码，他可以在等式中取代变量的位置，称这个长度为变量的长度。为了解一个二进制方程，需要给其中的变量赋予适当的二进制代码，使得我们用他们替代等式中的相应的变量后（等式的两边都变成二进制代码），这个等式成立。

编程任务：

对于每一个给出的方程，计算一共有多少组解。已知变量最多有26个（26个英文小写字母），且等式的每一端的数字和变量的长度之和不超过10000。

## 输入格式

第一行：k（k<=26,变量的个数，规定使用小写英文字母中的前k个字母作为变量，如k=5，则变量a,b,c,d,e）。

第二行：k个正整数，中间用一个空格隔开，依次代表k个变量的长度。

第三行：等式左边的表达式。

第四行：等式右边的表达式。

## 输出格式

等式中出现的变量共有多少组解。

## 样例

### 样例输入 #1
```
2

4 2

1b1

a


```
### 样例输出 #1
```
4
```
### 样例输入 #2
```
5

4 2 4 4 2

1bad1

acbe


```
### 样例输出 #2
```
16
```
## 提示

样例一：4组解

1 、a=1001； b=00

2、 a=1011； b=01

3、 a=1101； b=10

4、 a=1111； b=11）

样例二：K=5，变量：a,b,c,d,e。长度分别为：4 2 4 4 2。等式是：1bad1= acbe

输出16，即变量a,b,c,d,e共有16组解。




---

---
title: "[SDOI2006] 仓库管理员的烦恼"
layout: "post"
diff: 提高+/省选-
pid: P2457
tag: ['2006', '各省省选', '山东', '二分图', '费用流']
---
# [SDOI2006] 仓库管理员的烦恼
## 题目描述

仓库管理员M最近一直很烦恼，因为他的上司给了他一个艰难的任务：让他尽快想出一种合理的方案，把公司的仓库整理好。

已知公司共有n个仓库和n种货物，由于公司进货时没能很好的归好类，使得大部分的仓库里面同时装有多种货物，这就给搬运工作人员搬运货物时带来了很多的麻烦。

仓库管理员M的任务就是设计一种合理的方案，把仓库里面的货物重新整理，把相同的货物放到同一个仓库，以便于日后的管理，在整理过程中肯定需要把某些货物从一个仓库搬运到另一个仓库，已知每一次搬运货物所付出的代价等于搬运该货物的重量。

编程任务：

请你帮助仓库管理员M设计搬运方案，使得把所有的货物归好类：使每种货物各自占用一个仓库，或者说每个仓库里只能放一种货物。同时要求搬运货物时所付出的所有的总的代价最小。

## 输入格式

第一行为n (1 <= n <= 150)，仓库的数量。

以下为仓库货物的情况。第i+1行依次为第i个仓库中n种货物的数量x(0 <= x <= 100)。

## 输出格式

把所有的货物按要求整理好所需的总的最小代价。

## 样例

### 样例输入 #1
```
4
62 41 86 94 
73 58 11 12 
69 93 89 88 
81 40 69 13 

```
### 样例输出 #1
```
650
```
## 提示

样例说明：方案是：第1种货物放到仓库2中；第2种货物放到仓库3中；第3种货物放到仓库4中；第4种货物放到仓库1中



---

---
title: "[SDOI2008] 郁闷的小 J"
layout: "post"
diff: 提高+/省选-
pid: P2464
tag: ['2008', '莫队', '各省省选', '树状数组', '可持久化线段树']
---
# [SDOI2008] 郁闷的小 J
## 题目描述

小 J 是国家图书馆的一位图书管理员，他的工作是管理一个巨大的书架。虽然他很能吃苦耐劳，但是由于这个书架十分巨大，所以他的工作效率总是很低，以致他面临着被解雇的危险，这也正是他所郁闷的。

具体说来，书架由 $N$ 个书位组成，编号从 $1$ 到 $N$。每个书位放着一本书，每本书有一个特定的编码。

小 J 的工作有两类：

1. 图书馆经常购置新书，而书架任意时刻都是满的，所以只得将某位置的书拿掉并换成新购的书。

2. 小 J 需要回答顾客的查询，顾客会询问某一段连续的书位中某一特定编码的书有多少本。

例如，共 $5$ 个书位，开始时书位上的书编码为 $1, 2, 3, 4, 5$。

一位顾客询问书位 $1$ 到书位 $3$ 中编码为“$2$”的书共多少本，得到的回答为：$1$。

一位顾客询问书位 $1$ 到书位 $3$ 中编码为“$1$”的书共多少本，得到的回答为：$1$。

此时，图书馆购进一本编码为“$1$”的书，并将它放到 $2$ 号书位。

一位顾客询问书位 $1$ 到书位 $3$ 中编码为“$2$”的书共多少本，得到的回答为：$0$。

一位顾客询问书位 $1$ 到书位 $3$ 中编码为“$1$”的书共多少本，得到的回答为：$2$。

……

你的任务是写一个程序来回答每个顾客的询问。
## 输入格式

第一行两个整数 $N, M$，表示一共 $N$ 个书位，$M$ 个操作。

接下来一行共 $N$ 个整数数 $A_1, A_2, \ldots , A_N$，$A_i$ 表示开始时位置 $i$ 上的书的编码。

接下来 $M$ 行，每行表示一次操作，每行开头一个字符。

若字符为 `C`，表示图书馆购进新书，后接两个整数 $A, P$（$1 \le A \le N$），表示这本书被放在位置 $A$ 上，以及这本书的编码为 $P$。

若字符为 `Q`，表示一个顾客的查询，后接三个整数 $A, B, K$（$1 \le A \le B \le N$），表示查询从第 $A$ 书位到第 $B$ 书位（包含 $A$ 和 $B$）中编码为 $K$ 的书共多少本。
## 输出格式

对每一个顾客的查询，输出一个整数，表示顾客所要查询的结果。
## 样例

### 样例输入 #1
```
5 5
1 2 3 4 5
Q 1 3 2
Q 1 3 1
C 2 1
Q 1 3 2
Q 1 3 1

```
### 样例输出 #1
```
1
1
0
2

```
## 提示

对于 $40 \%$ 的数据，$1 \le N, M \le 5000$。

对于 $100 \%$ 的数据，$1 \le N, M \le {10}^5$。

对于 $100 \%$ 的数据，所有出现的书的编码为不大于 $2^{31} - 1$ 的正数。


---

---
title: "[SDOI2008] Sue 的小球"
layout: "post"
diff: 提高+/省选-
pid: P2466
tag: ['动态规划 DP', '2008', '各省省选', '山东', '区间 DP']
---
# [SDOI2008] Sue 的小球
## 题目描述

Sue 和 Sandy 最近迷上了一个电脑游戏，这个游戏的故事发在美丽神秘并且充满刺激的大海上，Sue 有一支轻便小巧的小船。然而，Sue 的目标并不是当一个海盗，而是要收集空中漂浮的彩蛋，Sue 有一个秘密武器，只要她将小船划到一个彩蛋的正下方，然后使用秘密武器便可以在瞬间收集到这个彩蛋。然而，彩蛋有一个魅力值，这个魅力值会随着彩蛋在空中降落的时间而降低，Sue 要想得到更多的分数，必须尽量在魅力值高的时候收集这个彩蛋，而如果一个彩蛋掉入海中，它的魅力值将会变成一个负数，但这并不影响 Sue 的兴趣，因为每一个彩蛋都是不同的，Sue 希望收集到所有的彩蛋。

然而 Sandy 就没有 Sue 那么浪漫了，Sandy 希望得到尽可能多的分数，为了解决这个问题，他先将这个游戏抽象成了如下模型：

将大海近似的看做 $x$ 轴，以 Sue 所在的初始位置作为坐标原点建立一个竖直的平面直角坐标系。

一开始空中有 $N$ 个彩蛋，对于第 $i$ 个彩蛋，他的初始位置用整数坐标 $(x_{i}, y_{i})$ 表示，游戏开始后，它匀速沿 $y$ 轴负方向下落,速度为 $v_{i}$ 单位距离/单位时间。Sue 的初始位置为 $(x_{0}, 0)$，Sue 可以沿 $x$ 轴的正方向或负方向移动，Sue 的移动速度是 $1$ 单位距离/单位时间，使用秘密武器得到一个彩蛋是瞬间的，得分为当前彩蛋的 $y$ 坐标的千分之一。

现在，Sue 和 Sandy 请你来帮忙，为了满足 Sue 和 Sandy 各自的目标，你决定在收集到所有彩蛋的基础上，得到的分数最高。
## 输入格式

第一行为两个整数 $N$, $x_{0}$ 用一个空格分隔，表示彩蛋个数与 Sue 的初始位置。

第二行为 $N$ 个整数 $x_{i}$，每两个数用一个空格分隔，第 $i$ 个数表示第 $i$ 个彩蛋的初始横坐标。

第三行为 $N$ 个整数 $y_{i}$，每两个数用一个空格分隔，第 $i$ 个数表示第 $i$ 个彩蛋的初始纵坐标。

第四行为 $N$ 个整数 $v_{i}$，每两个数用一个空格分隔，第 $i$ 个数表示第 $i$ 个彩蛋匀速沿 $y$ 轴负方向下落的的速度。

## 输出格式

一个实数，保留三位小数，为收集所有彩蛋的基础上，可以得到最高的分数。

## 样例

### 样例输入 #1
```
3 0
-4 -2 2
22 30 26
1 9 8

```
### 样例输出 #1
```
0.000
```
## 提示

对于 $30\%$ 的数据， $N\leq 20$。

对于 $60\%$ 的数据， $N\leq 100$。

对于 $100\%$ 的数据，$-10^4 \leq x_{i},y_{i},v_{i} \leq 10^4$，$N \leq 1000$


---

---
title: "[SDOI2010] 地精部落"
layout: "post"
diff: 提高+/省选-
pid: P2467
tag: ['动态规划 DP', '2010', '各省省选', '离散化', '山东']
---
# [SDOI2010] 地精部落
## 题目描述

传说很久以前，大地上居住着一种神秘的生物：地精。

地精喜欢住在连绵不绝的山脉中。具体地说，一座长度为 $n$ 的山脉 $h$ 可分为从左到右的 $n$ 段，每段有一个**独一无二**的高度 $h_i$，其中 $h_i$ 是 $1$ 到 $n$ 之间的正整数。

如果一段山脉比所有与它相邻的山脉都高，则这段山脉是一个山峰。位于边缘的山脉只有一段相邻的山脉，其他都有两段（即左边和右边）。

类似地，如果一段山脉比所有它相邻的山脉都低，则这段山脉是一个山谷。

地精们有一个共同的爱好——饮酒，酒馆可以设立在山谷之中。地精的酒馆不论白天黑夜总是人声鼎沸，地精美酒的香味可以飘到方圆数里的地方。

地精还是一种非常警觉的生物，他们在每座山峰上都可以设立瞭望台，并轮流担当瞭望工作，以确保在第一时间得知外敌的入侵。

地精们希望这 $n$ 段山脉每段都可以修建瞭望台或酒馆的其中之一，只有满足这个条件的整座山脉才可能有地精居住。

现在你希望知道，长度为 $n$ 的可能有地精居住的山脉有多少种。两座山脉 $a$ 和 $b$ 不同当且仅当存在一个 $i$，使得 $a_i\ne b_i$。由于这个数目可能很大，你只对它除以 $p$ 的余数感兴趣。
## 输入格式

一行，两个正整数 $n,p$。

## 输出格式

一个非负整数，表示你所求的答案对 $p$ 取余之后的结果。

## 样例

### 样例输入 #1
```
4 7
```
### 样例输出 #1
```
3
```
## 提示

共有 $10$ 种可能的山脉，它们是：

![](https://cdn.luogu.com.cn/upload/image_hosting/zh1bw5gr.png)

其中标记的数字表示可以设立瞭望台的山峰，其它表示可以设立酒馆的山谷。

**【数据规模和约定】**

对于 $20\%$ 的数据，满足 $N \le 10$；

对于 $40\%$ 的数据，满足 $N \le 18$；

对于 $70\%$ 的数据，满足 $N \le 550$；

对于 $100\%$ 的数据，满足 $3 \le N \le 4200$，$P \le 10^9$。



---

---
title: "[SCOI2007] 降雨量"
layout: "post"
diff: 提高+/省选-
pid: P2471
tag: ['2007', '四川', '线段树', '各省省选']
---
# [SCOI2007] 降雨量
## 题目描述

我们常常会说这样的话：“$X$ 年是自 $Y$ 年以来降雨量最多的”。它的含义是 $X$ 年的降雨量不超过 $Y$ 年，且对于任意 $Y < Z < X$，$Z$ 年的降雨量严格小于 $X$ 年。例如 2002、2003、2004 和 2005 年的降雨量分别为 $4920$、$5901$、$2832$ 和 $3890$，则可以说“2005 年是自 2003 年以来最多的”，但不能说“2005 年是自 2002 年以来最多的”由于有些年份的降雨量未知，有的说法是可能正确也可以不正确的。

## 输入格式

输入仅一行包含一个正整数 $n$，为已知的数据。以下 $n$ 行每行两个整数 $y_i$ 和 $r_i$，为年份和降雨量，按照年份从小到大排列，即 $y_i<y_{i+1}$。下一行包含一个正整数 $m$，为询问的次数。以下 $m$ 行每行包含两个数 $Y$ 和 $X$，即询问“$X$ 年是自 $Y$ 年以来降雨量最多的。”这句话是“必真”、“必假”还是“有可能”。

## 输出格式

对于每一个询问，输出 `true`、`false` 或者 `maybe`。

## 样例

### 样例输入 #1
```
6
2002 4920
2003 5901
2004 2832
2005 3890
2007 5609
2008 3024
5
2002 2005
2003 2005
2002 2007
2003 2007
2005 2008

```
### 样例输出 #1
```
false
true
false
maybe
false

```
## 提示

$100 \%$ 的数据满足：$1 \le n \le 50000$，$1 \le m \le 10000$，$-10^9 \le y_i \le 10^9$，$1 \le r_i \le 10^9$，$-10^9 \le X, Y \le 10^9$。

数据保证 $Y < X$。


---

---
title: "[SDOI2011] 打地鼠"
layout: "post"
diff: 提高+/省选-
pid: P2484
tag: ['2011', '各省省选', '山东', '前缀和', '其它技巧']
---
# [SDOI2011] 打地鼠
## 题目描述

2020.4.29 数据更新。

打地鼠是这样的一个游戏：地面上有一些地鼠洞，地鼠们会不时从洞里探出头来很短时间后又缩回洞中。玩家的目标是在地鼠伸出头时，用锤子砸其头部，砸到的地鼠越多分数也就越高。

游戏中的锤子每次只能打一只地鼠，如果多只地鼠同时探出头，玩家只能通过多次挥舞锤子的方式打掉所有的地鼠。你认为这锤子太没用了，所以你改装了锤子，增加了锤子与地面的接触面积，使其每次可以击打一片区域。如果我们把地面看做 $m\times n$ 的方阵，其每个元素都代表一个地鼠洞，那么锤子可以覆盖 $r\times c$ 区域内的所有地鼠洞。但是改装后的锤子有一个缺点：每次挥舞锤子时，对于这的区域中的所有地洞，锤子会打掉恰好一只地鼠。也就是说锤子覆盖的区域中，每个地洞必须至少有 $1$ 只地鼠，且如果某个地洞中地鼠的个数大于 $1$，那么这个地洞只会有 $1$ 只地鼠被打掉，因此每次挥舞锤子时，恰好有$r\times c$ 只地鼠被打掉。由于锤子的内部结构过于精密，因此在游戏过程中你不能旋转锤子（即不能互换 $r$ 和 $c$）。

你可以任意更改锤子的规格(即你可以任意规定 $r$ 和 $c$ 的大小)，但是改装锤子的工作只能在打地鼠前进行(即你不可以打掉一部分地鼠后，再改变锤子的规格)。你的任务是求出要想打掉所有的地鼠，至少需要挥舞锤子的次数。

Hint：由于你可以把锤子的大小设置为 $1\times 1$，因此本题总是有解的。
## 输入格式

第一行包含两个正整数 $m$ 和 $n$；

下面 $m$ 行每行 $n$ 个正整数描述地图，每个数字表示相应位置的地洞中地鼠的数量。

## 输出格式

输出一个整数，表示最少的挥舞次数。

## 样例

### 样例输入 #1
```
3 3
1 2 1
2 4 2
1 2 1

```
### 样例输出 #1
```
4
```
## 提示

【样例说明】

使用 $2\times 2$ 的锤子，分别在左上、左下、右上、右下挥舞一次。

【数据规模和约定】

对于 $30\%$ 的数据，$m$, $n\leq 5$ ；

对于 $60\%$ 的数据，$m$, $n\leq 30$ ；

对于 $100\%$ 的数据，$1\leq m$, $n\leq 100$ ，其他数据不小于 $0$，不大于 $10^5$ 。



---

---
title: "[SDOI2011] 计算器"
layout: "post"
diff: 提高+/省选-
pid: P2485
tag: ['2011', '各省省选', '山东', 'O2优化', '素数判断,质数,筛法', '最大公约数 gcd', '逆元']
---
# [SDOI2011] 计算器
## 题目背景

2024-8-11 update: 新增一组 hack。
## 题目描述

你被要求设计一个计算器完成以下三项任务：

1. 给定 $y,z,p$，计算 $y^z \bmod p$ 的值；
2. 给定 $y,z,p$，计算满足 $xy \equiv z \pmod p$ 的最小非负整数 $x$；
3. 给定 $y,z,p$，计算满足 $y^x \equiv z \pmod p$ 的最小非负整数 $x$。

为了拿到奖品，全力以赴吧！

## 输入格式

输入文件包含多组数据。

第一行包含两个正整数 $T,K$，分别表示数据组数和询问类型（对于一个测试点内的所有数据，询问类型相同）。

以下 $T$ 行每行包含三个正整数 $y,z,p$，描述一个询问。
## 输出格式

输出文件包括 $T$ 行。

对于每个询问，输出一行答案。

对于询问类型 2 和 3，如果不存在满足条件的，则输出 `Orz, I cannot find x!`。
## 样例

### 样例输入 #1
```
3 1
2 1 3
2 2 3
2 3 3

```
### 样例输出 #1
```
2
1
2

```
### 样例输入 #2
```
3 2
2 1 3
2 2 3
2 3 3

```
### 样例输出 #2
```
2
1
0

```
### 样例输入 #3
```
4 3
2 1 3
2 2 3
2 3 3
2 4 3

```
### 样例输出 #3
```
0
1
Orz, I cannot find x!
0

```
## 提示

测试点共分为三类，各类测试点占总测试点的比例如下：

| $K=$ | 测试点占比 |
| :--: | :--------: |
| $1$  |   $20\%$   |
| $2$  |   $35\%$   |
| $3$  |   $45\%$   |

所有数据均满足：$1 \leq y,z,p \leq 10^9$，$p$ 是质数，$1 \leq T \leq 10$。


---

---
title: "[SDOI2011] 消防"
layout: "post"
diff: 提高+/省选-
pid: P2491
tag: ['2011', '二分', '各省省选', '山东', '广度优先搜索 BFS', '树的直径']
---
# [SDOI2011] 消防
## 题目描述

某个国家有 $n$ 个城市，这 $n$ 个城市中任意两个都连通且有唯一一条路径，每条连通两个城市的道路的长度为 $z_i$。

这个国家的人对火焰有超越宇宙的热情，所以这个国家最兴旺的行业是消防业。由于政府对国民的热情忍无可忍（大量的消防经费开销）可是却又无可奈何（总统竞选的国民支持率），所以只能想尽方法提高消防能力。

现在这个国家的经费足以在一条边长度和不超过 $s$ 的路径（两端都是城市）上建立消防枢纽，为了尽量提高枢纽的利用率，要求其他所有城市到这条路径的距离的最大值最小。

你受命监管这个项目，你当然需要知道应该把枢纽建立在什么位置上。
## 输入格式

输入包含 $n$ 行：

第 $1$ 行，两个正整数 $n$ 和 $s$，中间用一个空格隔开。其中 $n$ 为城市的个数，$s$ 为路径长度的上界。设结点编号以此为$1,2,\ldots,n$。

从第 $2$ 行到第 $n$ 行，每行给出 $3$ 个用空格隔开的正整数，依次表示每一条边的两个端点编号和长度。例如，```2 4 7```表示连接结点 $2$ 与 $4$ 的边的长度为 $7$。
## 输出格式

输出包含一个非负整数，即所有城市到选择的路径的最大值，当然这个最大值必须是所有方案中最小的。
## 样例

### 样例输入 #1
```
5 2
1 2 5
2 3 2
2 4 4
2 5 3
```
### 样例输出 #1
```
5
```
### 样例输入 #2
```
8 6
1 3 2
2 3 2 
3 4 6
4 5 3
4 6 4
4 7 2
7 8 3
```
### 样例输出 #2
```
5
```
## 提示

对于 $20\%$ 的数据，$n \le 300$。

对于 $50\%$ 的数据，$n \le 3 \times 10^3$。

对于 $100\%$ 的数据，$1\le n \le 3 \times 10^5$，$1\le z_i \le 10^3$。

- 注意，数据中存在权值为 $0$ 的边。



------------
2024/1/28 添加一组 hack 数据。


---

---
title: "[HAOI2006] 旅行"
layout: "post"
diff: 提高+/省选-
pid: P2502
tag: ['2006', '河南', '并查集', '各省省选', '枚举', '排序']
---
# [HAOI2006] 旅行
## 题目描述

Z 小镇是一个景色宜人的地方，吸引来自各地的观光客来此旅游观光。Z 小镇附近共有 $n$ 个景点（编号为 $1,2,3,\ldots,n$），这些景点被 $m$ 条道路连接着，所有道路都是双向的，两个景点之间可能有多条道路。

也许是为了保护该地的旅游资源，Z 小镇有个奇怪的规定，就是对于一条给定的公路 $r_i$，任何在该公路上行驶的车辆速度必须为 $v_i$。

速度变化太快使得游客们很不舒服，因此从一个景点前往另一个景点的时候，大家都希望选择行驶过程中最大速度和最小速度的比尽可能小的路线，也就是所谓最舒适的路线。
## 输入格式

第一行包含两个正整数 $n,m$。

接下来的 $m$ 行每行包含三个正整数 $x,y,v$。表示景点 $x$ 到景点 $y$ 之间有一条双向公路，车辆必须以速度 $v$ 在该公路上行驶。

最后一行包含两个正整数 $s,t$，表示想知道从景点 $s$ 到景点 $t$ 最大最小速度比最小的路径。$s$ 和 $t$ 不可能相同。
## 输出格式

如果景点 $s$ 到景点 $t$ 没有路径，输出` IMPOSSIBLE`。否则输出一个数，表示最小的速度比。如果需要，输出一个既约分数。

## 样例

### 样例输入 #1
```
4 2
1 2 1
3 4 2
1 4
```
### 样例输出 #1
```
IMPOSSIBLE
```
### 样例输入 #2
```
3 3
1 2 10
1 2 5
2 3 8
1 3
```
### 样例输出 #2
```
5/4
```
### 样例输入 #3
```
3 2
1 2 2
2 3 4
1 3
```
### 样例输出 #3
```
2
```
## 提示

对于 $100\%$ 的数据，$1 \le x,y \le n \le 500$，$1 \le v < 3 \times 10^4$，$1 \le m \le 5 \times 10^3$，$x \ne y$。


---

---
title: "[HAOI2006] 均分数据"
layout: "post"
diff: 提高+/省选-
pid: P2503
tag: ['模拟', '贪心', '2006', '河南', '各省省选', '模拟退火']
---
# [HAOI2006] 均分数据
## 题目描述

已知 $n$ 个正整数 $a_1,a_2 ... a_n$ 。今要将它们分成 $m$ 组，使得各组数据的数值和最平均，即各组数字之和的均方差最小。均方差公式如下：

$$\sigma = \sqrt{\frac 1m \sum\limits_{i=1}^m(\overline x - x_i)^2},\overline x = \frac 1m \sum\limits_{i=1}^m x_i$$

其中 $\sigma$ 为均方差，$\bar{x}$ 为各组数据和的平均值，$x_i$ 为第 $i$ 组数据的数值和。
## 输入格式

第一行是两个整数，表示 $n,m$ 的值（ $n$ 是整数个数，$m$ 是要分成的组数）

第二行有 $n$ 个整数，表示 $a_1,a_2 ... a_n$。整数的范围是 $[1,50]$。

（同一行的整数间用空格分开）

## 输出格式

输出一行一个实数，表示最小均方差的值(保留小数点后两位数字)。

## 样例

### 样例输入 #1
```
6 3
1 2 3 4 5 6

```
### 样例输出 #1
```
0.00
```
## 提示

样例解释：$1,6$、$2,5$、$3,4$ 分别为一组

【数据规模】

对于 $40\%$ 的数据，保证有 $m \le n \le 10$，$2 \le m \le 6$

对于 $100\%$ 的数据，保证有 $m \le n \le 20$，$2 \le m \le 6$



---

---
title: "[SCOI2008] 配对"
layout: "post"
diff: 提高+/省选-
pid: P2507
tag: ['动态规划 DP', '搜索', '2008', '四川', '各省省选']
---
# [SCOI2008] 配对
## 题目描述

你有 $n$ 个整数 $A_i$ 和 $n$ 个整数 $B_i$。你需要把它们配对，即每个 $A_i$ 恰好对应一个 $B_{p[i]}$。要求所有配对的整数差的绝对值之和尽量小，但不允许两个相同的数配对。例如 $A = \{5, 6, 8\}$，$B = \{5, 7, 8 \}$，则最优配对方案是 $5 \sim 8$、$6 \sim 5$、$8 \sim 7$，配对整数的差的绝对值分别为 $3, 1, 1$，和为 $5$。注意，$5 \sim 5$、$6 \sim 7$、$8 \sim 8$ 是不允许的，因为相同的数不许配对。

## 输入格式

第一行为一个正整数 $n$，接下来是 $n$ 行，每行两个整数 $A_i$ 和 $B_i$，保证所有 $A_i$ 各不相同，$B_i$ 也各不相同。

## 输出格式

输出一个整数，即配对整数的差的绝对值之和的最小值。如果无法配对，输出 `-1`。

## 样例

### 样例输入 #1
```
3
3 65
45 10
60 25

```
### 样例输出 #1
```
32

```
### 样例输入 #2
```
3
5 5
6 7
8 8

```
### 样例输出 #2
```
5

```
## 提示

$30 \%$ 的数据满足：$n \le {10}^4$；  
$100 \%$ 的数据满足：$1 \le n \le {10}^5$，$A_i$ 和 $B_i$ 均为 $1$ 到 ${10}^9$ 之间的整数。



---

---
title: "[HAOI2008] 木棍分割"
layout: "post"
diff: 提高+/省选-
pid: P2511
tag: ['动态规划 DP', '贪心', '2008', '河南', '各省省选', '前缀和']
---
# [HAOI2008] 木棍分割
## 题目描述

有n根木棍, 第i根木棍的长度为Li,n根木棍依次连结了一起, 总共有n-1个连接处. 现在允许你最多砍断m个连接处, 砍完后n根木棍被分成了很多段,要求满足总长度最大的一段长度最小, 并且输出有多少种砍的方法使得总长度最大的一段长度最小. 并将结果**mod 10007**。。。

## 输入格式

输入文件第一行有2个数n,m. 接下来n行每行一个正整数Li,表示第i根木棍的长度.

## 输出格式

输出有2个数, 第一个数是总长度最大的一段的长度最小值, 第二个数是有多少种砍的方法使得满足条件.

## 样例

### 样例输入 #1
```
3 2                           
1 
1
10
```
### 样例输出 #1
```
10 2
```
## 提示

两种砍的方法: (1)(1)(10)和(1 1)(10)

数据范围

   n<=50000, 0<=m<=min(n-1,1000).

1<=Li<=1000.



---

---
title: "[HAOI2008] 糖果传递"
layout: "post"
diff: 提高+/省选-
pid: P2512
tag: ['贪心', '2008', '河南', '各省省选']
---
# [HAOI2008] 糖果传递
## 题目描述

有 $n$ 个小朋友坐成一圈，每人有 $a_i$ 个糖果。每人只能给左右两人传递糖果。每人每次传递一个糖果代价为 $1$。

## 输入格式

小朋友个数 $n$，下面 $n$ 行 $a_i$。

## 输出格式

求使所有人获得均等糖果的最小代价。

## 样例

### 样例输入 #1
```
4
1
2
5
4
```
### 样例输出 #1
```
4
```
## 提示

对于 $100\%$ 的数据 $1 \leq n\le 10^6$，$1 \leq a _ i \leq 1.5 \times 10 ^ 9$。



---

---
title: "[HAOI2010] 工厂选址"
layout: "post"
diff: 提高+/省选-
pid: P2514
tag: ['2010', '河南', '各省省选']
---
# [HAOI2010] 工厂选址
## 题目描述

某地区有 $m$ 座煤矿，其中第 $i$ 号矿每年产量为 $a_i$ 吨。现有一火力发电厂，每年需用煤恰好 $b$ 吨，每年运行的固定费用（不包括煤的运费）为 $h$ 元，每吨原煤从第 $i$ 号矿运到火力发电厂的运费为 $C_{i,0}$ 元。

现规划新建一个发电厂， $m$ 座煤矿每年开采的原煤将全部供给这两座发电厂。有 $n$ 个备选的新发电厂厂址，若在第 $j$ 号备选厂址建新厂，每年运行的固定费用为 $h_j$ 元；每吨原煤从第 $i$ 号矿运到第 $j$ 号备选厂址的运费为 $C_{i,j}$ 元。

试问：应如何选取新厂厂址并分配 $m$ 座煤矿开采的原煤，才能使每年的总费用（发电厂运行费用与原煤运费之和）最小。
## 输入格式

第一行四个整数 $m,b,h,n$。

接下来一行 $m$ 个整数 $a_1,a_2,...,a_m$ 表示每一处煤矿的年产量。

接下来一行 $n$ 个整数 $h_1,h_2,...,h_n$ 表示新厂建在每一个位置的固定费用。

接下来 $n+1$ 行每行 $m$ 个正整数，第 $i$ 行描述 $C_{1,i-1} , C_{2,i-1} , ... , C_{m , i-1}$的值。
## 输出格式

第一行一个整数表示选择的新发电厂的厂址编号，如有多个厂址满足条件，输出最小的一个；

第二行一个整数表示最小的年总费用。
## 样例

### 样例输入 #1
```
4 2 7 9 
3 1 10 3 
6 3 7 1 10 2 7 4 9 
1 2 4 3 
6 6 8 2 
4 10 8 4 
10 2 9 2 
7 6 6 2 
9 3 7 1 
2 1 6 9 
3 1 10 9 
4 2 1 8 
2 1 3 4 
```
### 样例输出 #1
```
8 
49 
```
## 提示

对于$100 \%$的数据，$1 \leq m \leq 5 \times 10^4$，$1 \leq b \leq 10^4$，$1 \leq n \leq 50$，$0 \leq h , h_i \leq 100$，$0 \leq a_i \leq 500$，$\sum\limits_{i=1}^m a_i \geq b$，$0 \leq C_{i,j} \leq 50$。


---

---
title: "[HAOI2010] 软件安装"
layout: "post"
diff: 提高+/省选-
pid: P2515
tag: ['动态规划 DP', '2010', '河南', '各省省选', '强连通分量', 'Tarjan']
---
# [HAOI2010] 软件安装
## 题目描述

现在我们的手头有 $N$ 个软件，对于一个软件 $i$，它要占用 $W_i$ 的磁盘空间，它的价值为 $V_i$。我们希望从中选择一些软件安装到一台磁盘容量为 $M$ 计算机上，使得这些软件的价值尽可能大（即 $V_i$ 的和最大）。

但是现在有个问题：软件之间存在依赖关系，即软件 $i$ 只有在安装了软件 $j$（包括软件 $j$ 的直接或间接依赖）的情况下才能正确工作（软件 $i$ 依赖软件 $j$)。幸运的是，一个软件最多依赖另外一个软件。如果一个软件不能正常工作，那么它能够发挥的作用为 $0$。


我们现在知道了软件之间的依赖关系：软件 $i$ 依赖软件 $D_i$。现在请你设计出一种方案，安装价值尽量大的软件。一个软件只能被安装一次，如果一个软件没有依赖则 $D_i=0$，这时只要这个软件安装了，它就能正常工作。
## 输入格式

第 1 行：$N,M(0\leq N\leq 100, 0\leq M\leq 500)$

第 2 行：$W_1,W_2, ... W_i, ..., W_n (0\leq W_i\leq M)$

第 3 行：$V_1, V_2, ..., V_i, ..., V_n  (0\leq V_i\leq 1000)$

第 4 行：$D_1, D_2, ..., D_i, ..., D_n (0\leq D_i\leq N, D_i≠i)$
## 输出格式

一个整数，代表最大价值。

## 样例

### 样例输入 #1
```
3 10
5 5 6
2 3 4
0 1 1
```
### 样例输出 #1
```
5
```


---

---
title: "[HAOI2010] 最长公共子序列"
layout: "post"
diff: 提高+/省选-
pid: P2516
tag: ['字符串', '动态规划 DP', '2010', '河南', '各省省选', '容斥原理']
---
# [HAOI2010] 最长公共子序列
## 题目描述

字符序列的子序列是指从给定字符序列中随意地（不一定连续）去掉若干个字符（可能一个也不去掉）后所形成的字符序列。令给定的字符序列$X=\{x_0,x_1,\cdots ,x_{m-1}\}$，序列$Y=\{y_0,y_1,\cdots ,y_{k-1}\}$ 是 $X$ 的子序列，存在 $X$ 的一个严格递增下标序列 $\{i_0,i_1,\cdots,i_{k-1}\}$ ，使得对所有的$j=0,1,\cdots,k-1$ ，有 $x_{ij}=y_j$ 。例如，$X=\verb!"ABCBDAB"!$ ，$Y=\verb!"BCDB"!$ 是 $X$ 的一个子序列。对给定的两个字符序列，求出他们最长的公共子序列长度，以及最长公共子序列个数。

## 输入格式

第一行为第一个字符序列，都是大写字母组成，以 . 结束，大写字母个数不超过 $5000$。

第二行为第二个字符序列，都是大写字母组成，以 . 结束，大写字母个数不超过 $5000$。
## 输出格式

第一行输出上述两个最长公共子序列的长度。

第二行输出所有可能出现的最长公共子序列个数，答案可能很大，只要将答案对 $10^{8}$ 求余即可。
## 样例

### 样例输入 #1
```
ABCBDAB.
BACBBD.
```
### 样例输出 #1
```
4
7
```


---

---
title: "[HAOI2010] 计数"
layout: "post"
diff: 提高+/省选-
pid: P2518
tag: ['动态规划 DP', '数学', '2010', '河南', '各省省选', '数位 DP']
---
# [HAOI2010] 计数
## 题目描述

现在给定一个数，你可以删掉这个数中的任意多个数位 $0$（或不删）并将其他的数位任意重新排序。请求出能产生出多少个不同的这个数小的数（注意这个数不会有前导 0）。

## 输入格式

只有一行，为一个整数 $n$。

## 输出格式

一行一个整数，表示答案。

## 样例

### 样例输入 #1
```
1020
```
### 样例输出 #1
```
7
```
## 提示

$n$ 的长度不超过 $50$，答案不超过 $2^{63}-1$。

样例解释：$12,21,102,120,201,210,1002,1020$。


---

---
title: "[HAOI2011] problem a"
layout: "post"
diff: 提高+/省选-
pid: P2519
tag: ['动态规划 DP', '贪心', '递推', '2011', '河南', '各省省选']
---
# [HAOI2011] problem a
## 题目描述

一次考试共有 $n$ 个人参加，可能出现多个人成绩相同的情况。第 $i$ 个人说：“有 $a_i$ 个人成绩比我高，$b_i$ 个人成绩比我低。”

请求出最少有几个人没有说真话。
## 输入格式

输入的第一行是一个整数，代表参加考试的人数 $n$。

第 $2$ 到第 $(n + 1)$ 行，每行两个用空格隔开的整数，第 $(i + 1)$ 行的两个整数分别代表比第 $i$ 个人成绩高的人数 $a_i$ 和比第 $i$ 个人成绩低的人数 $b_i$。
## 输出格式

输出一行一个整数，代表最少有几个人没有说真话。
## 样例

### 样例输入 #1
```
3
2 0
0 2
2 2
```
### 样例输出 #1
```
1
```
## 提示

对于 $100\%$ 的数据，保证 $1 \leq n \leq 10^5$，$0 \leq a_i, b_i \leq n$。


---

---
title: "[HAOI2011] 向量"
layout: "post"
diff: 提高+/省选-
pid: P2520
tag: ['数学', '2011', '河南', '各省省选', '最大公约数 gcd', '向量']
---
# [HAOI2011] 向量
## 题目描述

给你一对数 $(a,b)$，你可以任意使用 $(a,b), (a,-b), (-a,b), (-a,-b), (b,a), (b,-a), (-b,a), (-b,-a)$ 这些向量，问你能不能拼出另一个向量 $(x,y)$。

说明：这里的拼就是使得你选出的向量之和为 $(x,y)$。
## 输入格式

第一行数组组数 $t(t\leq50000)$。

接下来 $t$ 行，每行四个整数 $a,b,x,y(-2\times10^9\leq a,b,x,y\leq2\times10^9)$。
## 输出格式

$t$ 行，每行为 `Y` 或者为 `N`，分别表示可以拼出来，不能拼出来。
## 样例

### 样例输入 #1
```
3

2 1 3 3

1 1 0 1

1 0 -2 3
```
### 样例输出 #1
```
Y

N

Y
```
## 提示

### 样例解释

第一组：$(2,1)+(1,2)=(3,3)$。

第三组：$(-1,0)+(-1,0)+(0,1)+(0,1)+(0,1)=(-2,3)$。


---

---
title: "[HAOI2011] Problem b"
layout: "post"
diff: 提高+/省选-
pid: P2522
tag: ['2011', '河南', '各省省选', '最大公约数 gcd', '莫比乌斯反演', '容斥原理']
---
# [HAOI2011] Problem b
## 题目描述

对于给出的 $n$ 个询问，每次求有多少个数对 $(x,y)$，满足 $a \le x \le b$，$c \le y \le d$，且 $\gcd(x,y) = k$，$\gcd(x,y)$ 函数为 $x$ 和 $y$ 的最大公约数。
## 输入格式

第一行一个整数 $n$，接下来 $n$ 行每行五个整数，分别表示 $a,b,c,d,k$。
## 输出格式

共 $n$ 行，每行一个整数表示满足要求的数对 $(x,y)$ 的个数。
## 样例

### 样例输入 #1
```
2
2 5 1 5 1
1 5 1 5 2
```
### 样例输出 #1
```
14
3
```
## 提示

对于 $100\%$ 的数据满足：$1 \le n,k \le 5 \times 10^4$，$1 \le a \le b \le 5 \times 10^4$，$1 \le c \le d \le 5 \times 10^4$。


---

---
title: "[SHOI2001] 化工厂装箱员"
layout: "post"
diff: 提高+/省选-
pid: P2530
tag: ['动态规划 DP', '2001', '各省省选', '上海', '枚举']
---
# [SHOI2001] 化工厂装箱员
## 题目描述

118 号工厂是世界唯一秘密提炼锎的化工厂，由于提炼锎的难度非常高，技术不是十分完善，所以工厂生产的锎成品可能会有 $3$ 种不同的纯度，$A$：$100\%$，$B$：$1\%$，$C$：$0.01\%$，为了出售方便，必须把不同纯度的成品分开装箱，装箱员 grant 第 $1$ 次顺序从流水线上取 $10$ 个成品（如果一共不足 $10$ 个，则全部取出），以后每一次把手中某种纯度的成品放进相应的箱子，然后再从流水线上顺序取一些成品，使手中保持 $10$ 个成品（如果把剩下的全部取出不足 $10$ 个，则全部取出），如果所有的成品都装进了箱子，那么 grant 的任务就完成了。

由于装箱是件非常累的事情，grant 希望他能够以最少的装箱次数来完成他的任务，现在他请你编个程序帮助他。

## 输入格式

第 $1$ 行为 $n$（$1\le n\le 100$），为成品的数量。

以后 $n$ 行，每行为一个大写字母 $\texttt A$，$\texttt B$ 或 $\texttt C$，表示成品的纯度。

## 输出格式

仅一行，为 grant 需要的最少的装箱次数。

## 样例

### 样例输入 #1
```
11
A
B
C
A
B
C
A
B
C
A
B

```
### 样例输出 #1
```
3
```


---

---
title: "[SHOI2001] 三国围棋对抗赛"
layout: "post"
diff: 提高+/省选-
pid: P2531
tag: ['2001', '各省省选', '上海']
---
# [SHOI2001] 三国围棋对抗赛
## 题目背景

中国邀请韩国，日本围棋队来参加三国围棋对抗赛，韩国，日本应邀各派了5位超一流高手来参赛，中国围棋队希望能赢得这场比赛，但是这10位高手实力不俗。不过中国队作为东道主，可以在对方选手安排好出场顺序后再决定队员的组成以及出场顺序，以得到最大的获胜概率。

## 题目描述

比赛规则如下：先抽签决定第1轮轮空的队，由不轮空的2支队的1号队员进行比赛，失利的队员被淘汰，以后每次由前一轮获胜的队员与前一轮轮空的队剩下的队员中序号最小的队员进行比赛，直到只剩下一个国家的队员为止，这个国家就获得了比赛的胜利。

## 输入格式

第1行为一个数n（5<=n<=15），中国队的候选人数。

接下来是n行，每行有10个数

第I+1行的10个数依次表示第I位中国选手对韩国1~5号，日本1~5号的胜率，胜率k（0<=k<=1）。

再接下来是5行，每行有5个数

第I+n+1行的第j个数表示韩国I号选手对日本j号选手的胜率。

## 输出格式

仅1行，为中国队的最大的获胜概率，保留6位小数。

## 样例

### 样例输入 #1
```
5
0.902 0.540 0.862 0.283 0.498 0.597 0.900 0.076 0.750 0.539 
0.342 0.574 0.743 0.442 0.579 0.502 0.755 0.649 0.835 0.278 
0.105 0.704 0.274 0.733 0.725 0.861 0.007 0.314 0.099 0.542 
0.785 0.754 0.541 0.331 0.430 0.426 0.928 0.385 0.314 0.892 
0.349 0.354 0.408 0.353 0.333 0.180 0.715 0.013 0.563 0.386 
0.131 0.564 0.265 0.700 0.033 
0.293 0.688 0.140 0.130 0.550 
0.346 0.915 0.385 0.536 0.946 
0.739 0.051 0.682 0.166 0.436 
0.122 0.065 0.724 0.934 0.736

```
### 样例输出 #1
```
0.529237
```


---

---
title: "[AHOI2012] 铁盘整理"
layout: "post"
diff: 提高+/省选-
pid: P2534
tag: ['搜索', '2012', '各省省选', '安徽', '排序', '剪枝', '启发式迭代加深搜索 IDA*', 'A*  算法']
---
# [AHOI2012] 铁盘整理
## 题目描述

在训练中，一些臂力训练器材是少不了的，小龙在练习的时候发现举重器械上的铁盘放置的非常混乱，并没有按照从轻到重的顺序摆放，这样非常不利于循序渐进的锻炼。他打算利用一个非常省力气的办法来整理这些铁盘，即每次都拿起最上面的若干个圆盘并利用器械的力量上下翻转，这样翻转若干次以后，铁盘将会按照从小到大的顺序排列好。那么你能不能帮小龙确定，最少翻转几次就可以使铁盘按从小到大排序呢？

例如：下面的铁盘经过如图所示的以下几个步骤的翻转后变为从小到大排列。

![](https://cdn.luogu.com.cn/upload/image_hosting/xtpst1lw.png)
## 输入格式

共两行。第一行为铁盘个数 $N$（$1 \leq N \leq 16$），第二行为 $N$ 个不同的正整数，分别为从上到下的铁盘的半径 $R$（$1 \leq R \leq 100$）。

## 输出格式

一个正整数，表示使铁盘从小到大有序需要的最少翻转次数。
## 样例

### 样例输入 #1
```
5
2 4 3 5 1
```
### 样例输出 #1
```
5
```


---

---
title: "[AHOI2004] DNA变异"
layout: "post"
diff: 提高+/省选-
pid: P2547
tag: ['2004', '各省省选', '安徽']
---
# [AHOI2004] DNA变异
## 题目描述

![](https://cdn.luogu.com.cn/upload/pic/1660.png)

## 输入格式

![](https://cdn.luogu.com.cn/upload/pic/1661.png)

## 输出格式

只有一行数字，表示DNA序列中的血缘序列对的总数。

## 样例

### 样例输入 #1
```
3
ATCTACTG
CTATACTG
CTATGATC
```
### 样例输出 #1
```
1
```


---

---
title: "[AHOI2001] 华夏60战斗机"
layout: "post"
diff: 提高+/省选-
pid: P2551
tag: ['2001', '各省省选', '安徽']
---
# [AHOI2001] 华夏60战斗机
## 题目描述

华夏 60 超音速战斗机是当今世界上机动性能最先进的战斗机。战斗过程中的一个关键问题是如何在最短的时间内使飞机从当前的飞行高度和速度爬升/俯冲到指定的高度并达到指定速度，以便占据有利的战斗位置。

现假定只允许华夏 60 执行以下三种基本飞行动作，并且只能在完成了一个基本动作的情况下再去执行另一个基本飞行动作。这样华夏 60 的飞行可以表示成由这三种基本飞行动作组成的动作序列。

(1) 维持原速做恒速爬升飞行，直至飞行高度提高 ∆h 英尺；

(2) 水平加速飞直至速度提高 1 马赫(1 马赫≈1200 公里/小时)；

(3) 垂直俯冲飞行 ∆h 英尺，飞行速度会提高 1 马赫。

同时假定飞机的初始飞行速度和执行每个基本飞行动作初始时刻的飞行速度都是 1 马赫的整数倍，且不超过 6 马赫；初始飞行高度和执行每个基本飞行动作初始时刻的飞行高度都为 ∆h 英尺( ∆h 是整数)的整数倍。

实验研究表明：在不同高度 H 和不同的初始速度V 完成上述的三种基本飞行动作所需的时间也是各不相同的。表 1~表 3 给出了 ∆ h = 15000英尺和最大飞行高度 = 75000

H m 英尺时完成这三种基本飞行动作所需的时间。

根据表 1~表 3 的数据，欲使华夏 60 战斗机从 H = 0 英尺、V = 1马赫的飞行状态达到 H = 75000 英尺、V = 6 马赫的飞行状态的最短飞行时间是79 秒，相应的飞行动作序列是：

 ![](https://cdn.luogu.com.cn/upload/pic/1669.png) 

(1) 恒速爬升飞行至 H = 15000英尺，V = 1马赫状态；

(2) 连续做两次水平加速飞行至 H = 15000英尺，V = 3马赫状态；

(3) 连续做四次恒速爬升飞行至 H = 75000 英尺，V = 3马赫状态；


(4) 水平加速飞行至 H = 75000 英尺，V = 4马赫状态；

(5) 连续做两次垂直俯冲飞行至 H = 45000 英尺，V = 6 马赫状态；

(6) 连续做两次恒速爬升飞行至 H = 75000 英尺，V = 6 马赫状态。

现在小明驾驶华夏 60 战斗机以V1马赫的速度飞行于 H1英尺高度，中队长发出了让他以V2 马赫的速度飞行于 H 2 英尺高度的指令。请你编写程序帮小明决策一下如何飞行才能花费最少的时间执行完中队长下达的命令。

## 输入格式

![](https://cdn.luogu.com.cn/upload/pic/1670.png)

## 输出格式

输出信息用两行来存放。第一行存放你求出的最优方案所需的时间。

第二行存放该最优方案的动作序列(以 R 表示恒速爬升飞行，A 表示

水平加速飞行，D 表示垂直俯冲飞行)。第二行中不允许出现多余的

字符(包括空白字符)。

## 样例

### 样例输入 #1
```
0 1 75000 6 15000 75000
12 12 12 11 12 14
11 10 8 9 10 11
9 8 6 7 8 8
8 7 6 6 6 5
8 6 6 6 6 5
11 11 11 13 15
10 10 9 9 10
10 9 9 10 10
9 8 9 9 10
7 8 8 9 9
7 7 7 8 8
5 4 3 3 2
4 3 3 2 2
3 3 2 2 2
3 3 2 2 2
```
### 样例输出 #1
```
79
RAARRRRADDRR
```


---

---
title: "[SCOI2010] 幸运数字"
layout: "post"
diff: 提高+/省选-
pid: P2567
tag: ['2010', '四川', '各省省选', '深度优先搜索 DFS', '剪枝', '容斥原理']
---
# [SCOI2010] 幸运数字
## 题目背景

四川 NOI 省选 2010。

## 题目描述

在中国，很多人都把 $6$ 和 $8$ 视为是幸运数字！lxhgww 也这样认为，于是他定义自己的“幸运号码”是十进制表示中只包含数字 $6$ 和 $8$ 的那些号码，比如 $68$，$666$，$888$ 都是“幸运号码”！但是这种“幸运号码”总是太少了，比如在 $[1,100]$ 的区间内就只有 $6$ 个（$6$，$8$，$66$，$68$，$86$，$88$），于是他又定义了一种“近似幸运号码”。lxhgww 规定，凡是“幸运号码”的倍数都是“近似幸运号码”，当然，任何的“幸运号码”也都是“近似幸运号码”，比如 $12$，$16$，$666$ 都是“近似幸运号码”。

现在 lxhgww 想知道在一段闭区间 $[a, b]$ 内，“近似幸运号码”的个数。
## 输入格式

输入数据是一行，包括 $2$ 个数字 $a$ 和 $b$。
## 输出格式

输出数据是一行，包括 $1$ 个数字，表示在闭区间 $[a, b]$ 内“近似幸运号码”的个数。
## 样例

### 样例输入 #1
```
1 10
```
### 样例输出 #1
```
2
```
## 提示

对于 $30\%$ 的数据，保证 $1\le a\le b\le10^6$。

对于 $100\%$ 的数据，保证 $1\le a\le b\le10^{10}$。



---

---
title: "[SCOI2010] 股票交易"
layout: "post"
diff: 提高+/省选-
pid: P2569
tag: ['动态规划 DP', '2010', '四川', '各省省选', '单调队列', '队列']
---
# [SCOI2010] 股票交易
## 题目描述

最近 $\text{lxhgww}$ 又迷上了投资股票，通过一段时间的观察和学习，他总结出了股票行情的一些规律。

通过一段时间的观察，$\text{lxhgww}$ 预测到了未来 $T$ 天内某只股票的走势，第 $i$ 天的股票买入价为每股 $AP_i$，第 $i$ 天的股票卖出价为每股 $BP_i$（数据保证对于每个 $i$，都有 $AP_i \geq BP_i$），但是每天不能无限制地交易，于是股票交易所规定第 $i$ 天的一次买入至多只能购买 $AS_i$ 股，一次卖出至多只能卖出 $BS_i$ 股。

另外，股票交易所还制定了两个规定。为了避免大家疯狂交易，股票交易所规定在两次交易（某一天的买入或者卖出均算是一次交易）之间，至少要间隔 $W$ 天，也就是说如果在第 $i$ 天发生了交易，那么从第 $i+1$ 天到第 $i+W$ 天，均不能发生交易。同时，为了避免垄断，股票交易所还规定在任何时间，一个人的手里的股票数不能超过 $\text{MaxP}$。

在第 $1$ 天之前，$\text{lxhgww}$ 手里有一大笔钱（可以认为钱的数目无限），但是没有任何股票，当然，$T$ 天以后，$\text{lxhgww}$ 想要赚到最多的钱，聪明的程序员们，你们能帮助他吗？


## 输入格式

输入数据第一行包括 $3$ 个整数，分别是 $T$，$\text{MaxP}$，$W$。

接下来 $T$ 行，第 $i$ 行代表第 $i-1$ 天的股票走势，每行 $4$ 个整数，分别表示 $AP_i,\ BP_i,\ AS_i,\ BS_i$。
## 输出格式

输出数据为一行，包括 $1$ 个数字，表示 $\text{lxhgww}$ 能赚到的最多的钱数。
## 样例

### 样例输入 #1
```
5 2 0
2 1 1 1
2 1 1 1
3 2 1 1
4 3 1 1
5 4 1 1

```
### 样例输出 #1
```
3
```
## 提示

- 对于 $30\%$ 的数据，$0\leq W<T\leq 50,1\leq\text{MaxP}\leq50$；
- 对于 $50\%$ 的数据，$0\leq W<T\leq 2000,1\leq\text{MaxP}\leq50$；
- 对于 $100\%$ 的数据，$0\leq W<T\leq 2000,1\leq\text{MaxP}\leq2000$；
- 对于所有的数据，$1\leq BP_i\leq AP_i\leq 1000,1\leq AS_i,BS_i\leq\text{MaxP}$。


---

---
title: "[SCOI2010] 传送带"
layout: "post"
diff: 提高+/省选-
pid: P2571
tag: ['2010', '四川', '各省省选']
---
# [SCOI2010] 传送带
## 题目描述

在一个 $2$ 维平面上有两条传送带，每一条传送带可以看成是一条线段。两条传送带分别为线段 $\text{AB}$ 和线段 $\text{CD}$。lxhgww 在 $\text{AB}$ 上的移动速度为 $P$，在 $\text{CD}$ 上的移动速度为 $Q$，在平面上的移动速度 $R$。现在 lxhgww 想从 $\text A$ 点走到 $\text D$ 点，他想知道最少需要走多长时间。

## 输入格式

第一行 $4$ 个整数，表示 $\text A$ 和 $\text B$ 的坐标，分别为 $A_x$，$A_y$，$B_x$，$B_y$。

第二行 $4$ 个整数，表示 $\text C$ 和 $\text D$ 的坐标，分别为 $C_x$，$C_y$，$D_x$，$D_y$。

第三行 $3$ 个整数，分别是 $P$，$Q$，$R$。
## 输出格式

输出数据为一行，表示 lxhgww 从 $\text A$ 点走到 $\text D$ 点的最短时间，保留到小数点后 $2$ 位。
## 样例

### 样例输入 #1
```
0 0 0 100

100 0 100 100

2 2 1


```
### 样例输出 #1
```
136.60
```
## 提示

对于 $100\%$ 的数据，$1\le A_x,A_y,B_x,B_y,C_x,C_y,D_x,D_y\le10^3$，$1\le P,Q,R\le10$。


---

---
title: "[SCOI2010] 序列操作"
layout: "post"
diff: 提高+/省选-
pid: P2572
tag: ['2010', '四川', '线段树', '各省省选']
---
# [SCOI2010] 序列操作
## 题目描述

lxhgww 最近收到了一个 $01$ 序列，序列里面包含了 $n$ 个数，下标从 $0$ 开始。这些数要么是 $0$，要么是 $1$，现在对于这个序列有五种变换操作和询问操作：

- `0 l r` 把 $[l, r]$ 区间内的所有数全变成 $0$；
- `1 l r` 把 $[l, r]$ 区间内的所有数全变成 $1$；
- `2 l r` 把 $[l,r]$ 区间内的所有数全部取反，也就是说把所有的 $0$ 变成 $1$，把所有的 $1$ 变成 $0$；
- `3 l r` 询问 $[l, r]$ 区间内总共有多少个 $1$；
- `4 l r` 询问 $[l, r]$ 区间内最多有多少个连续的 $1$。

对于每一种询问操作，lxhgww 都需要给出回答，聪明的程序员们，你们能帮助他吗？

## 输入格式

第一行两个正整数 $n,m$，表示序列长度与操作个数。  
第二行包括 $n$ 个数，表示序列的初始状态。  
接下来 $m$ 行，每行三个整数，表示一次操作。

## 输出格式

对于每一个询问操作，输出一行一个数，表示其对应的答案。

## 样例

### 样例输入 #1
```
10 10
0 0 0 1 1 0 1 0 1 1
1 0 2
3 0 5
2 2 2
4 0 4
0 3 6
2 3 7
4 2 8
1 0 5
0 5 6
3 3 9

```
### 样例输出 #1
```
5
2
6
5
```
## 提示

【数据范围】  
对于 $30\%$ 的数据，$1\le n,m \le 1000$；  
对于$100\%$ 的数据，$1\le n,m \le 10^5$。



---

---
title: "[SCOI2012] 滑雪"
layout: "post"
diff: 提高+/省选-
pid: P2573
tag: ['图论', '2012', '四川', '各省省选', '排序', '生成树']
---
# [SCOI2012] 滑雪
## 题目描述

a180285 非常喜欢滑雪。他来到一座雪山，这里分布着 $m$ 条供滑行的轨道和 $n$ 个轨道之间的交点（同时也是景点），而且每个景点都有一编号 $i\space (1 \le i \le n)$ 和一高度 $h_i$。  

a180285 能从景点 $i$ 滑到景点 $j$ 当且仅当存在一条 $i$ 和 $j$ 之间的边，且 $i$ 的高度**不小于** $j$。与其他滑雪爱好者不同，a180285 喜欢用最短的滑行路径去访问尽量多的景点。如果仅仅访问一条路径上的景点，他会觉得数量太少。

于是 a18028 5拿出了他随身携带的时间胶囊。这是一种很神奇的药物，吃下之后可以立即回到上个经过的景点（不用移动也不被认为是 a180285 滑行的距离）。  

请注意，这种神奇的药物是可以连续食用的，即能够回到较长时间之前到过的景点（比如上上个经过的景点和上上上个经过的景点）。 现在，a180285站在 $1$ 号景点望着山下的目标，心潮澎湃。他十分想知道在不考虑时间胶囊消耗的情况下，以最短滑行距离滑到尽量多的景点的方案（即满足经过景点数最大的前提下使得滑行总距离最小）。你能帮他求出最短距离和景点数吗？

## 输入格式

输入的第一行是两个整数 $n,m$。
接下来一行有 $n$ 个整数 $h_i$，分别表示每个景点的高度。

接下来 $m$ 行，表示各个景点之间轨道分布的情况。每行三个整数 $u,v,k$，表示编号为 $u$ 的景点和编号为 $v$ 的景点之间有一条长度为 $k$ 的轨道。

## 输出格式

输出一行，表示 a180285 最多能到达多少个景点，以及此时最短的滑行距离总和。

## 样例

### 样例输入 #1
```
3 3 
3 2 1 
1 2 1 
2 3 1 
1 3 10 
```
### 样例输出 #1
```
3 2
```
## 提示

【数据范围】   
对于 $ 30\% $ 的数据，$ 1 \le n \le 2000 $；   
对于 $ 100\% $ 的数据，$ 1 \le n \le 10^5 $。


对于所有的数据，保证 $ 1 \le m \le 10^6 $ , $ 1 \le h_i \le 10^9 $ ，$ 1 \le k_i \le 10^9 $。



---

---
title: "[ZJOI2005] 九数码游戏"
layout: "post"
diff: 提高+/省选-
pid: P2578
tag: ['2005', '各省省选', '浙江', 'Special Judge', '哈希 hashing']
---
# [ZJOI2005] 九数码游戏
## 题目描述

![](https://cdn.luogu.com.cn/upload/pic/1701.png)

## 输入格式

输入文件中包含三行三列九个数，同行的相邻两数用空格隔开，表示初始状态每个方格上的数字。初始状态不会是目标状态。

## 输出格式

如果目标状态无法达到，则输出“UNSOLVABLE”（引号不输出）。

否则，第一行是一个整数S，表示最少的操作次数。接下来4 × (S + 1)行，每四行表示一个状态：前三行每行三个整数，相邻两数用空格隔开，表示每个方格上的数字，第四行是一个空行，作为分隔。第一个状态必须是初始状态，最后一个状态必须是目标状态。




## 样例

### 样例输入 #1
```
2 3 0
1 8 7
5 4 6

```
### 样例输出 #1
```
4
2 3 0
1 8 7
5 4 6

1 2 3
5 8 0
4 6 7

1 2 3
0 5 8
4 6 7

0 1 2
4 5 3
6 7 8

0 1 2
3 4 5
6 7 8

```
## 提示

由@FlierKing提供SPJ



---

---
title: "[ZJOI2005] 沼泽鳄鱼"
layout: "post"
diff: 提高+/省选-
pid: P2579
tag: ['2005', '各省省选', '浙江', '矩阵乘法', '构造']
---
# [ZJOI2005] 沼泽鳄鱼
## 题目描述

潘塔纳尔沼泽地号称世界上最大的一块湿地，它地位于巴西中部马托格罗索州的南部地区。每当雨季来临，这里碧波荡漾、生机盎然，引来不少游客。

为了让游玩更有情趣，人们在池塘的中央建设了几座石墩和石桥，每座石桥连接着两座石墩，且每两座石墩之间至多只有一座石桥。这个景点造好之后一直没敢对外开放，原因是池塘里有不少危险的食人鱼。

豆豆先生酷爱冒险，他一听说这个消息，立马赶到了池塘，想做第一个在桥上旅游的人。虽说豆豆爱冒险，但也不敢拿自己的性命开玩笑，于是他开始了仔细的实地勘察，并得到了一些惊人的结论：食人鱼的行进路线有周期性，这个周期只可能是 $2$、$3$ 或者 $4$ 个单位时间。每个单位时间里，食人鱼可以从一个石墩游到另一个石墩。每到一个石墩，如果上面有人它就会实施攻击，否则继续它的周期运动。如果没有到石墩，它是不会攻击人的。

借助先进的仪器，豆豆很快就摸清了所有食人鱼的运动规律，他要开始设计自己的行动路线了。每个单位时间里，他只可以沿着石桥从一个石墩走到另一个石墩，而不可以停在某座石墩上不动，因为站着不动还会有其它危险。如果豆豆和某条食人鱼在同一时刻到达了某座石墩，就会遭到食人鱼的袭击，他当然不希望发生这样的事情。

现在豆豆已经选好了两座石墩 $\mathrm{Start}$ 和 $\mathrm{End}$，他想从 $\mathrm{Start}$ 出发，经过 $K$ 个单位时间后恰好站在石墩 $\mathrm{End}$ 上。假设石墩可以重复经过（包括 $\mathrm{Start}$ 和 $\mathrm{End}$），他想请你帮忙算算，这样的路线共有多少种（当然不能遭到食人鱼的攻击）。
## 输入格式

输入文件共 $M + 2 + \mathrm{NFish}$ 行。

第一行包含五个正整数 $N,M,\mathrm{Start},\mathrm{End},K$，分别表示石墩数目、石桥数目、$\mathrm{Start}$ 石墩和 $\mathrm{End}$ 石墩的编号和一条路线所需的单位时间。石墩用 $0$ 到 $N-1$ 的整数编号。

第 $2$ 到 $M + 1$ 行，给出石桥的相关信息。每行两个整数 $x$ 和 $y$，$0 \leq x, y \leq N-1$，表示这座石桥连接着编号为 $x$ 和 $y$ 的两座石墩。

第 $M + 2$ 行是一个整数 $\mathrm{NFish}$，表示食人鱼的数目。

第 $M + 3$ 到 $M + 2 + \mathrm{NFish}$ 行，每行给出一条食人鱼的相关信息。每行的第一个整数是 $T$，$T = 2,3$ 或 $4$，表示食人鱼的运动周期。接下来有 $T$ 个数，表示一个周期内食人鱼的行进路线。

- 如果 $T=2$，接下来有 $2$ 个数 $P_0$ 和 $P_1$，食人鱼从 $P_0$ 到 $P_1$，从 $P_1$ 到 $P_0,\ldots$；

- 如果 $T=3$，接下来有 $3$ 个数 $P_0,P_1$ 和 $P_2$，食人鱼从 $P_0$ 到 $P_1$，从 $P_1$ 到 $P_2$，从 $P_2$ 到 $P_0,\ldots$；

- 如果 $T=4$，接下来有 $4$ 个数 $P_0,P_1,P_2$ 和 $P_3$，食人鱼从 $P_0$ 到 $P_1$，从 $P_1$ 到 $P_2$，从 $P_2$ 到 $P_3$，从 $P_3$ 到 $P_0,\ldots$。

豆豆出发的时候所有食人鱼都在自己路线上的 $P_0$ 位置，请放心，这个位置不会是 $\mathrm{Start}$ 石墩。
## 输出格式

输出路线的种数，因为这个数可能很大，你只要输出该数除以 $10000$ 的余数就行了。
## 样例

### 样例输入 #1
```
6 8 1 5 3

0 2

2 1

1 0

0 5

5 1

1 4

4 3

3 5

1

3 0 5 1


```
### 样例输出 #1
```
2
```
## 提示

对于 $100 \%$ 的数据，$1 \leq N \leq 50$，$1 \leq K \leq 2 \times 10^9$，$1 \leq \mathrm{NFish} \leq 20$。


---

---
title: "[ZJOI2005] Genotype"
layout: "post"
diff: 提高+/省选-
pid: P2581
tag: ['2005', '各省省选', '浙江']
---
# [ZJOI2005] Genotype
## 题目背景

Genotype 是一个有限的基因序列。它是由大写的英文字母A-Z组成，不同的字母表示不同种类的基因。一个基因可以分化成为一对新的基因。这种分化被一个定义的规则集合所控制。每个分化的规则可以用三个大写字母A1A2A3表示，含义为基因A1可以分化成A2A3



我们用S代表特种基因，繁殖genotype是从特种基因序列开始。根据给定的规则，它由被选择控制规则对基因不断进行繁殖而成。

## 题目描述

读入一个定义的规则集和一个想生成的genotypes 单词序列

对每一个给定的 genotype，根据给定的分化规则，检查是否它能从某一个确定特种基因序列生成，如果能，找到最小的序列长度，

## 输入格式

第一行有一个整数n, 1 <= n <= 10000. 下面n 每一行为一个分化规则. 这些规则都由包含A – Z的三个大写字母组成.

接下来的10 行，每行有一个 genotype. Genotype由没有空格的单词组成，最多100 个英文大写字母.

## 输出格式

有10行,在第I行应写入: 一个正整数――需要生成第I个genotypes的最小长度；或者单词 NIE, 如果不能生成对应的genotype。

## 样例

### 样例输入 #1
```
6

SAB

SBC

SAA

ACA

BCC

CBC

ACBC


```
### 样例输出 #1
```
1
```


---

---
title: "[ZJOI2006] 碗的叠放"
layout: "post"
diff: 提高+/省选-
pid: P2589
tag: ['动态规划 DP', '2006', '二分', '各省省选', '浙江']
---
# [ZJOI2006] 碗的叠放
## 题目描述

小H有n个碗需要放进橱柜，她希望将他们叠起来放置。你知道每个碗都是规则的圆柱体，并且都是上宽下窄，你已经测量出了每个碗的两个半径及高，请你帮小H找出一种叠放顺序，使得叠放出来的碗堆的高度尽量小，比如：

![](https://cdn.luogu.com.cn/upload/pic/1706.png)

## 输入格式

第一行一个整数n，表示碗的数目。以下n行，每行三个整数h，r1，r2。分别表示碗高及两个半径。其中r1<r2。

## 输出格式

仅一个数，表示最小的高度。答案四舍五入取整。

## 样例

### 样例输入 #1
```
3

50 30 80

35 25 70

40 10 90
```
### 样例输出 #1
```
55
```
## 提示

数据范围：100%数据满足n<=9。所有输入的数绝对值不超过1000。



---

---
title: "[ZJOI2008] 树的统计"
layout: "post"
diff: 提高+/省选-
pid: P2590
tag: ['2008', '线段树', '各省省选', '浙江', '树链剖分']
---
# [ZJOI2008] 树的统计
## 题目描述

一棵树上有 $n$ 个节点，编号分别为 $1$ 到 $n$，每个节点都有一个权值 $w$。

我们将以下面的形式来要求你对这棵树完成一些操作：

I. `CHANGE u t` : 把结点 $u$ 的权值改为 $t$。

II. `QMAX u v`: 询问从点 $u$ 到点 $v$ 的路径上的节点的最大权值。

III. `QSUM u v`: 询问从点 $u$ 到点 $v$ 的路径上的节点的权值和。

注意：从点 $u$ 到点 $v$ 的路径上的节点包括 $u$ 和 $v$ 本身。
## 输入格式

输入文件的第一行为一个整数 $n$，表示节点的个数。

接下来 $n-1$ 行，每行 $2$ 个整数 $a$ 和 $b$，表示节点 $a$ 和节点 $b$ 之间有一条边相连。

接下来一行 $n$ 个整数，第 $i$ 个整数 $w_i$ 表示节点 $i$ 的权值。

接下来 $1$ 行，为一个整数 $q$，表示操作的总数。

接下来 $q$ 行，每行一个操作，以 `CHANGE u t` 或者 `QMAX u v` 或者 `QSUM u v` 的形式给出。

## 输出格式

对于每个 `QMAX` 或者 `QSUM` 的操作，每行输出一个整数表示要求输出的结果。
## 样例

### 样例输入 #1
```
4
1 2
2 3
4 1
4 2 1 3
12
QMAX 3 4
QMAX 3 3
QMAX 3 2
QMAX 2 3
QSUM 3 4
QSUM 2 1
CHANGE 1 5
QMAX 3 4
CHANGE 3 6
QMAX 3 4
QMAX 2 4
QSUM 3 4

```
### 样例输出 #1
```
4
1
2
2
10
6
5
6
5
16

```
## 提示

对于 $100 \%$ 的数据，保证 $1\le n \le 3\times 10^4$，$0\le q\le 2\times 10^5$。

中途操作中保证每个节点的权值 $w$ 在 $-3\times 10^4$ 到 $3\times 10^4$ 之间。


---

---
title: "[ZJOI2009] 函数"
layout: "post"
diff: 提高+/省选-
pid: P2591
tag: ['数学', '2009', '各省省选', '浙江']
---
# [ZJOI2009] 函数
## 题目描述

有 $N$ 个连续函数 $f_i(x)$，其中 $1\le i\le N$。如果对于任意不相等的 $i,j$ 满足 $1\le i,j\le N$，恰好存在一个 $x$ 使得 $f_i(x)=f_j(x)$，并且存在无穷多的 $x$ 使得 $f_i(x)<f_j(x)$，对于任意 $i,j,k$ 满足 $1\le i < j < k\le N$，不存在 $x$ 使得 $f_i(x)=f_j(x)=f_k(x)$，则称这 $N$ 个连续函数满足条件。

 ![](https://cdn.luogu.com.cn/upload/pic/1708.png) 

如上左图就是 $3$ 个满足条件的函数，最左边从下往上依次为 $f_1,f_2,f_3$。右图中红色部分是这整个函数图像的最低层，我们称它为第一层。同理绿色部分称为第二层，蓝色部分称为第三层。注意到，右图中第一层左边一段属于 $f_1$，中间属于 $f_2$，最后属于 $f_3$。而第二层左边属于 $f_2$，接下来一段属于 $f_1$，再接下来一段属于 $f_3$，最后属于 $f_2$。因此，我们称第一层分为了三段，第二层分为了四段。同理第三层只分为了两段。求满足前面条件的 $N$ 个函数，第 $K$ 层最少能由多少段组成。
## 输入格式

一行两个整数 $N,K$。
## 输出格式

一行一个整数，表示 $N$ 个函数第 $K$ 层最少能由多少段组成。
## 样例

### 样例输入 #1
```
1 1


```
### 样例输出 #1
```
1


```
## 提示

对于 $100\%$ 的数据满足 $1\le K\le N\le 100$。



---

---
title: "[ZJOI2008] 生日聚会"
layout: "post"
diff: 提高+/省选-
pid: P2592
tag: ['动态规划 DP', '数学', '递推', '2008', '各省省选', '浙江']
---
# [ZJOI2008] 生日聚会
## 题目描述

今天是hidadz小朋友的生日，她邀请了许多朋友来参加她的生日party。 hidadz带着朋友们来到花园中，打算坐成一排玩游戏。为了游戏不至于无聊，就座的方案应满足如下条件：

对于任意连续的一段，男孩与女孩的数目之差不超过k。

很快，小朋友便找到了一种方案坐了下来开始游戏。hidadz的好朋友Susie发现，这样的就座方案其实是很多的，所以大家很快就找到了一种，那么到底有多少种呢？热爱数学的hidadz和她的朋友们开始思考这个问题……

假设参加party的人中共有n个男孩与m个女孩，你是否能解答Susie和hidadz的疑问呢？由于这个数目可能很多，他们只想知道这个数目除以12345678的余数。

## 输入格式

输入文件party.in仅包含一行共3个整数，分别为男孩数目n, 女孩数目m,  常数k。

## 输出格式

输出文件party.out应包含一行，为题中要求的答案。

## 样例

### 样例输入 #1
```
1 2 1
```
### 样例输出 #1
```
1
```
## 提示

对于30%的数据，n , m ≤ 20；

对于100%的数据, n , m ≤ 150，k ≤ 20。

    


---

---
title: "[ZJOI2006] 超级麻将"
layout: "post"
diff: 提高+/省选-
pid: P2593
tag: ['贪心', '2006', '各省省选', '浙江', '哈希 hashing']
---
# [ZJOI2006] 超级麻将
## 题目描述

很多人都知道玩麻将，当然也有人不知道，呵呵，不要紧，我在这里简要地介绍一下麻将规则：

普通麻将有砣、索、万三种类型的牌，每种牌有1~9个数字，其中相同的牌每个有四张，例如1砣~9砣，1索~9索，1万~9万各有4张，所以共36\*3=108张牌。胡牌时每人有14张牌，其中只要某人手里有若干句话（就是同种类型的牌连续三张或同种牌三张），另外再加上一对，即可胡牌。当然如果全是对，叫七小对，也可以胡牌。下图是连三张示例。

 ![](https://cdn.luogu.com.cn/upload/pic/1709.png) 

要判断某人是否胡牌，显然一个弱智的算法就行了，某中学信息学小组超级麻将迷想了想，决定将普通麻将改造成超级麻将。

所谓超级麻将没有了砣、索、万的区分，每种牌上的数字可以是1~100，而每种数字的牌各有100张。另外特别自由的是，玩牌的人手里想拿多少张牌都可以，好刺激哦！

刺激归刺激，但是拿多了怎么胡牌呢？

超级麻将规定只要一个人手里拿的牌是若干句话（三个连续数字的牌各一张组成一句话，三张或者四张同样数字的牌也算一句话），再加上一对相同的牌，就算胡了。

作为信息学竞赛选手的你，麻烦你给这位超级麻将迷编个程序，判断能否胡牌。

## 输入格式

输入文件第一行一个整数N（N<=100），表示玩了N次超级麻将。

接下来N行，每行100个数a1..a100，描述每次玩牌手中各种牌的数量。ai表示数字为i的牌有ai张。（0<=ai<=100）

## 输出格式

输出N行，若胡了则输出Yes，否则输出No，注意区分Yes，No的大小写！

## 样例

### 样例输入 #1
```
3

2 4 0 0 0 0 0 …… 0（一共98个0）

2 4 2 0 0 0 0 …… 0（一共97个0）

2 3 2 0 0 0 0 …… 0（一共97个0）
```
### 样例输出 #1
```
Yes

Yes

No
```


---

---
title: "[ZJOI2009] 狼和羊的故事"
layout: "post"
diff: 提高+/省选-
pid: P2598
tag: ['2009', '各省省选', '网络流', '浙江', '最小割']
---
# [ZJOI2009] 狼和羊的故事
## 题目描述

“狼爱上羊啊爱的疯狂，谁让他们真爱了一场；狼爱上羊啊并不荒唐，他们说有爱就有方向……”Orez 听到这首歌，心想：狼和羊如此和谐，为什么不尝试羊狼合养呢？说干就干！

Orez 的羊狼圈可以看作一个 $n\times m$ 的矩阵格子，这个矩阵的边缘已经装上了篱笆。可是 Drake 很快发现狼再怎么也是狼，它们总是对羊垂涎三尺，那首歌只不过是一个动人的传说而已。所以 Orez 决定在羊狼圈中再加入一些篱笆，还是要将羊狼分开来养。

通过仔细观察，Orez 发现狼和羊都有属于自己领地，若狼和羊们不能呆在自己的领地，那它们就会变得非常暴躁，不利于他们的成长。

Orez 想要添加篱笆的尽可能的短。当然这个篱笆首先得保证不能改变狼羊的所属领地，再就是篱笆必须修筑完整，也就是说必须修建在单位格子的边界上并且不能只修建一部分。
## 输入格式

文件的第一行包含两个整数 $n$ 和 $m$。接下来 $n$ 行每行 $m$ 个整数，$1$ 表示该格子属于狼的领地，$2$ 表示属于羊的领地，$0$ 表示该格子不是任何一只动物的领地。
## 输出格式

文件中仅包含一个整数 $\mathit{ans}$，代表篱笆的最短长度。
## 样例

### 样例输入 #1
```
2 2

2 2 

1 1 
```
### 样例输出 #1
```
2


```
## 提示

对于 $10\%$ 的数据，$n, m \le 3$。  
对于 $30\%$ 的数据，$n, m \le 20$。  
对于 $100\%$ 的数据，$1 \le n, m \le 100$。


---

---
title: "[ZJOI2010] 排列计数"
layout: "post"
diff: 提高+/省选-
pid: P2606
tag: ['动态规划 DP', '数学', '2010', '各省省选', '浙江', '组合数学', 'Lucas 定理']
---
# [ZJOI2010] 排列计数
## 题目描述

称一个 $1 \sim n$ 的排列 $p_1,p_2, \dots ,p_n$ 是 Magic 的，当且仅当  
$$\forall i \in [2,n],p_i > p_{\lfloor i/2 \rfloor}$$
计算 $1 \sim n$ 的排列中有多少是 Magic 的，答案可能很大，只能输出模 $m$ 以后的值。
## 输入格式

一行两个整数 $n,m$，含义如上所述。

## 输出格式

输出文件中仅包含一个整数，表示 $1\sim n$ 的排列中， Magic 排列的个数模 $m$ 的值。

## 样例

### 样例输入 #1
```
20 23 
```
### 样例输出 #1
```
16

```
## 提示

【数据范围】  
对于 $100\%$ 的数据，$1\le n \le 10^6$, $1\le m \le 10^9$，$m$ 是一个质数。



---

---
title: "[ZJOI2008] 骑士"
layout: "post"
diff: 提高+/省选-
pid: P2607
tag: ['动态规划 DP', '搜索', '2008', '各省省选', '浙江', '树形 DP', '基环树']
---
# [ZJOI2008] 骑士
## 题目描述

Z 国的骑士团是一个很有势力的组织，帮会中汇聚了来自各地的精英。他们劫富济贫，惩恶扬善，受到社会各界的赞扬。

最近发生了一件可怕的事情，邪恶的 Y 国发动了一场针对 Z 国的侵略战争。战火绵延五百里，在和平环境中安逸了数百年的 Z 国又怎能抵挡的住 Y 国的军队。于是人们把所有的希望都寄托在了骑士团的身上，就像期待有一个真龙天子的降生，带领正义打败邪恶。

骑士团是肯定具有打败邪恶势力的能力的，但是骑士们互相之间往往有一些矛盾。每个骑士都有且仅有一个自己最厌恶的骑士（当然不是他自己），他是绝对不会与自己最厌恶的人一同出征的。

战火绵延，人民生灵涂炭，组织起一个骑士军团加入战斗刻不容缓！国王交给了你一个艰巨的任务，从所有的骑士中选出一个骑士军团，使得军团内没有矛盾的两人（不存在一个骑士与他最痛恨的人一同被选入骑士军团的情况），并且，使得这支骑士军团最具有战斗力。

为了描述战斗力，我们将骑士按照 $1$ 至 $n$ 编号，给每名骑士一个战斗力的估计，一个军团的战斗力为所有骑士的战斗力总和。
## 输入格式

第一行包含一个整数 $n$，描述骑士团的人数。

接下来 $n$ 行，每行两个整数，按顺序描述每一名骑士的战斗力和他最痛恨的骑士。
## 输出格式

应输出一行，包含一个整数，表示你所选出的骑士军团的战斗力。
## 样例

### 样例输入 #1
```
3
10 2
20 3
30 1

```
### 样例输出 #1
```
30
```
## 提示

#### 数据规模与约定

对于 $30\%$ 的测试数据，满足 $n \le 10$；

对于 $60\%$ 的测试数据，满足 $n \le 100$；

对于 $80\%$ 的测试数据，满足 $n \le 10 ^4$。

对于 $100\%$ 的测试数据，满足 $1\le n \le 10^6$，每名骑士的战斗力都是不大于 $10^6$ 的正整数。


---

---
title: "[SCOI2009] windy 数"
layout: "post"
diff: 提高+/省选-
pid: P2657
tag: ['动态规划 DP', '2009', '四川', '各省省选', '数位 DP']
---
# [SCOI2009] windy 数
## 题目背景

windy 定义了一种 windy 数。
## 题目描述

不含前导零且相邻两个数字之差至少为 $2$ 的正整数被称为 windy 数。windy 想知道，在 $a$ 和 $b$ 之间，包括 $a$ 和 $b$ ，总共有多少个 windy 数？
## 输入格式

输入只有一行两个整数，分别表示 $a$ 和 $b$。
## 输出格式

输出一行一个整数表示答案。
## 样例

### 样例输入 #1
```
1 10
```
### 样例输出 #1
```
9
```
### 样例输入 #2
```
25 50

```
### 样例输出 #2
```
20

```
## 提示

#### 数据规模与约定

对于全部的测试点，保证 $1 \leq a \leq b \leq 2 \times 10^9$。


---

---
title: "[TJOI2012] 防御"
layout: "post"
diff: 提高+/省选-
pid: P2667
tag: ['2012', '各省省选', '天津']
---
# [TJOI2012] 防御
## 题目描述

在一个塔防小游戏中，有很多防线。每条防线由一排 $n$ 个独立的防御体 $[1 : n]$ 进行防御。

游戏过程中，会不断有敌人对防线进行攻击，每次攻击会指定防御体 $[l : r]$ 进行攻击力为 $a$ 的攻击。第一防线具有护甲，护甲承受攻击后，对应的防御体所受到的伤害为攻击力，但护甲承受的伤害总量到达一定程度后就会破碎，此时防御体所受的伤害加倍。目前第一防线的力量充足，玩家致力于对后面的防线的建设，不过为确认游戏进度和第一防线的情况，玩家会不时地将鼠标移动到第一防线的某个防御体上，以查看其所受到的伤害。

## 输入格式

第一行，两个整数 $n$ 和 $q$，分别表示防御体个数以及攻击和查询的总数。

第二行，$n$ 个数，表示每个防御体护甲的承受能力 $p_i$ 。

接下来 $q$ 行，每行可能具有如下形式：

`A l r a` 表示对防御体 $l,l+1,\cdots,r$ 进行攻击力为 $a$ 的攻击；

`Q x` 表示查询防御体 $x$ 目前所受到的伤害，初始时伤害为 $0$ 。

## 输出格式

一行，一个整数，表示所有查询结果之和对 ${10}^9+9$ 取模的余数。

## 样例

### 样例输入 #1
```
5 7
3 1 4 1 2
A 1 3 2
Q 2
A 1 4 1
Q 1
A 1 4 1
Q 2
Q 1
```
### 样例输出 #1
```
16
```
## 提示

**【样例解释】**

3/0 1/0 4/0 1/0 2/0

[A 1 3 2]

1/2 2 2/2 1/0 2/0

[Q 2] ! 2

[A 1 4 1]

3 4 1/3 1 2/0

[Q 1] -> 3

[A 1 4 1]

5 6 4 3 2/0

[Q 2] -> 6

[Q 1] -> 5

**【数据范围】**

$30 \%$ 的数据， $q \le 10^3$。

$100 \%$ 的数据，$1 \le n \le 10^5$，$1 \le q \le 10^5$，$0 \le p_i \le 10^6$，$0 \le a \le 10^4$。



---

---
title: "[CQOI2009] 循环赛"
layout: "post"
diff: 提高+/省选-
pid: P3154
tag: ['搜索', '2009', '重庆', '各省省选', '剪枝', '前缀和']
---
# [CQOI2009] 循环赛
## 题目描述

$n$ 支队伍比赛，每两支队伍比赛一次，平 $1$ 胜 $3$ 负 $0$。

给出队伍的最终得分，求有多少种可能的分数表。

```平1胜3负0```指：

- 若两支队伍打平，则各得到 $1$ 分；
- 否则，胜利的队伍得到 $3$ 分，被打败的队伍得到 $0$ 分。

## 输入格式

第一行包含一个正整数 $n$，表示队伍的个数。第二行包含 $n$ 个非负整数，即每支队伍的得分。

## 输出格式

输出仅一行，即可能的分数表数目。保证至少存在一个可能的分数表。

## 样例

### 样例输入 #1
```
6
5 6 7 7 8 8
```
### 样例输出 #1
```
121
```
## 提示

所有数据满足 $n\le 8$。


---

---
title: "[CQOI2009] 叶子的染色"
layout: "post"
diff: 提高+/省选-
pid: P3155
tag: ['动态规划 DP', '2009', '重庆', '各省省选', '树形 DP']
---
# [CQOI2009] 叶子的染色
## 题目描述

给一棵 $m$ 个结点的无根树，你可以选择一个度数大于 $1$ 的结点作为根，然后给一些结点（根、内部结点和叶子均可）着以黑色或白色。

你的着色方案应该保证根结点到每个叶子的简单路径上都至少包含一个有色结点（哪怕是这个叶子本身）。 

对于每个叶结点 $u$，定义 $c_u$ 为从根结点到 $u$ 的简单路径上最后一个有色结点的颜色。给出每个 $c_u$ 的值，设计着色方案，使得着色结点的个数尽量少。
## 输入格式

第一行包含两个整数 $m,n$，其中 $n$ 是叶子的个数，$m$ 是结点总数。结点编号为 $1,2,\ldots,m$，其中编号 $1,2,\ldots ,n$ 是叶子。

以下 $n$ 行每行一个 $0$ 或 $1$ 的整数（$0$ 表示黑色，$1$ 表示白色），依次为 $c_1,c_2,\ldots,c_n$。

以下 $m-1$ 行每行两个整数 $a,b$，表示结点 $a$ 和 $b$ 有边相连。
## 输出格式

仅一个数，即着色结点数的最小值。

## 样例

### 样例输入 #1
```
5 3
0
1
0
1 4
2 5
4 5
3 5
```
### 样例输出 #1
```
2
```
## 提示

#### 数据规模与约定
对于全部的测试点，保证 $1\le m\le 10^4$，$1\le n\le 5021$，$1\le a < b \le m$。


---

---
title: "[CQOI2014] 通配符匹配"
layout: "post"
diff: 提高+/省选-
pid: P3167
tag: ['字符串', '2014', '重庆', '各省省选', '哈希 hashing', 'AC 自动机']
---
# [CQOI2014] 通配符匹配
## 题目描述

几乎所有操作系统的命令行界面（CLI）中都支持文件名的通配符匹配以方便用户。最常见的通配符有两个，一个是星号（```*```），可以匹配 0 个及以上的任意字符：另一个是问号（```?```），可以匹配恰好一个任意字符。现在需要你编写一个程序，对于给定的文件名列表和一个包含通配符的字符串，判断哪些文件可以被匹配。

## 输入格式

第一行是一个由小写字母和上述通配符组成的字符串。第二行包含一个整数 $n$，表示文件个数。接下来 $n$ 行，每行为一个仅包含小写字母字符串，表示文件名列表。

## 输出格式

输出 $n$ 行，每行为 ``YES`` 或 ``NO``，表示对应文件能否被通配符匹配。

## 样例

### 样例输入 #1
```
*aca?ctc
6
acaacatctc
acatctc
aacacatctc
aggggcaacacctc
aggggcaacatctc
aggggcaacctct
```
### 样例输出 #1
```
YES

YES

YES

YES

YES

NO
```
## 提示

对于 $100 \%$ 的数据

- 字符串长度不超过 $100000$
- $1 \le n \le 100$
- 通配符个数不超过 $10$



---

---
title: "[HNOI2012] 三角形覆盖问题"
layout: "post"
diff: 提高+/省选-
pid: P3219
tag: ['计算几何', '2012', '各省省选', '平衡树', '湖南', '枚举']
---
# [HNOI2012] 三角形覆盖问题
## 题目描述

二维平面中，给定   N个等腰直角三角形（每个三角形的两条直角边分别平行于坐标轴，斜边从左上到右下）。我们用三个非负整数( x, y, d)来描述这样一个三角形，三角形三个顶点的坐标 分别为(x, y), (x + d, y)和(x, y +     d)。要求计算这   N个三角形所覆盖的总面积。例如，下图有 3 个三角形，覆盖的总面积为 11.0。

![](https://cdn.luogu.com.cn/upload/image_hosting/1459ccln.png)

## 输入格式

输入文件第一行为一个正整数N，表示三角形的个数。

接下来的 N行每行有用空格隔开的三个非负整数，x, y, d，描述一个三角形的顶点坐标，分别为(x, y), (x + d, y), ( x, y+d)，其中 x, y, d 满足0<= x, y, d<=1000000。



## 输出格式

仅包含一行，为一个实数  S，表示所有三角形所覆盖的总面积，输出恰好保留一位小数。输入数据保证  S<=2^31 。

## 样例

### 样例输入 #1
```
3
1 1 4
2 0 2
3 2 2
```
### 样例输出 #1
```
11.0
```
## 提示

对于50%的数据，1<=  N<=500；  
100%的数据，1<=N<=10000。


---

---
title: "[JLOI2016/SHOI2016] 侦察守卫"
layout: "post"
diff: 提高+/省选-
pid: P3267
tag: ['动态规划 DP', '2016', '各省省选', '上海', '吉林']
---
# [JLOI2016/SHOI2016] 侦察守卫
## 题目描述

小 R 和 B 神正在玩一款游戏。这款游戏的地图由 $N$ 个点和 $N-1$ 条无向边组成，每条无向边连接两个点，且地图是连通的。换句话说，游戏的地图是一棵有 $N$ 个节点的树。

游戏中有一种道具叫做侦查守卫，当一名玩家在一个点上放置侦查守卫后，它可以监视这个点以及与这个点的距离在 $D$ 以内的所有点。这里两个点之间的距离定义为它们在树上的距离，也就是两个点之间唯一的简单路径上所经过边的条数。在一个点上放置侦查守卫需要付出一定的代价，在不同点放置守卫的代价可能不同。

现在小 R 知道了所有 B 神可能会出现的位置，请你计算监视所有这些位置的最小代价。

## 输入格式

第一行包含两个正整数 $N$ 和 $D$，分别表示地图上的点数和侦查守卫的视野范围。约定地图上的点用 $1$ 到 $N$ 的整数编号。

第二行 $N$ 个正整数，第 $i$ 个正整数表示在编号为 $i$ 的点放置侦查守卫的代价 $W _ i$。保证 $W _ i \le 1000$。

第三行一个正整数 $M$，表示 B 神可能出现的点的数量。保证 $M \le N$。

第四行 $M$ 个正整数，分别表示每个 B 神可能出现的点的编号，从小到大不重复地给出。

接下来 $N-1$ 行，每行包含两个正整数 $U,V$，表示在编号为 $U$ 的点和编号为 $V$ 的点之间有一条无向边。

## 输出格式

仅一行一个整数，表示监视所有 B 神可能出现的点所需要的最小代价。

## 样例

### 样例输入 #1
```
12 2
8 9 12 6 1 1 5 1 4 8 10 6
10
1 2 3 5 6 7 8 9 10 11
1 3
2 3
3 4
4 5
4 6
4 7
7 8
8 9
9 10
10 11
11 12
```
### 样例输出 #1
```
10
```
## 提示

对于所有的数据，$N \le 5 \times 10 ^ 5,D \le 20$。


---

---
title: "[SCOI2011] 糖果"
layout: "post"
diff: 提高+/省选-
pid: P3275
tag: ['2011', '四川', '各省省选', '最短路', '差分约束']
---
# [SCOI2011] 糖果
## 题目描述

幼儿园里有 $N$ 个小朋友，$\text{lxhgww}$ 老师现在想要给这些小朋友们分配糖果，要求每个小朋友都要分到糖果。但是小朋友们也有嫉妒心，总是会提出一些要求，比如小明不希望小红分到的糖果比他的多，于是在分配糖果的时候，$\text{lxhgww}$ 需要满足小朋友们的 $K$ 个要求。幼儿园的糖果总是有限的，$\text{lxhgww}$ 想知道他至少需要准备多少个糖果，才能使得每个小朋友都能够分到糖果，并且满足小朋友们所有的要求。
## 输入格式

输入的第一行是两个整数 $N$，$K$。接下来 $K$ 行，表示这些点需要满足的关系，每行 $3$ 个数字，$X$，$A$，$B$。

+ 如果 $X=1$， 表示第 $A$ 个小朋友分到的糖果必须和第 $B$ 个小朋友分到的糖果一样多；
+ 如果 $X=2$， 表示第 $A$ 个小朋友分到的糖果必须少于第 $B$ 个小朋友分到的糖果；
+ 如果 $X=3$， 表示第 $A$ 个小朋友分到的糖果必须不少于第 $B$ 个小朋友分到的糖果；
+ 如果 $X=4$， 表示第 $A$ 个小朋友分到的糖果必须多于第 $B$ 个小朋友分到的糖果；
+ 如果 $X=5$， 表示第 $A$ 个小朋友分到的糖果必须不多于第 $B$ 个小朋友分到的糖果；
## 输出格式

输出一行，表示 $\text{lxhgww}$ 老师至少需要准备的糖果数，如果不能满足小朋友们的所有要求，就输出 $-1$。
## 样例

### 样例输入 #1
```
5 7
1 1 2
2 3 2
4 4 1
3 4 5
5 4 5
2 3 5
4 5 1
```
### 样例输出 #1
```
11
```
## 提示

对于 $30\%$ 的数据，保证 $N\leq100$

对于 $100\%$ 的数据，保证 $N\leq100000$

对于所有的数据，保证 $K\leq100000, 1\leq X\leq5, 1\leq A, B\leq N$

---

$\text{upd 2022.7.6}$：新添加 $21$ 组 [Hack 数据](https://www.luogu.com.cn/discuss/454051)。


---

---
title: "[CQOI2017] 小Q的棋盘"
layout: "post"
diff: 提高+/省选-
pid: P3698
tag: ['动态规划 DP', '贪心', '2017', '重庆', '各省省选', '枚举', '背包 DP', '连通块']
---
# [CQOI2017] 小Q的棋盘
## 题目描述

小 Q 正在设计一种棋类游戏。

在小 Q 设计的游戏中，棋子可以放在棋盘上的格点中。某些格点之间有连线，棋子只能在有连线的格点之间移动。整个棋盘上共有 $V$ 个格点，编号为 $0,1,2,\cdots, V- 1$，它们是连通的，也就是说棋子从任意格点出发，总能到达所有的格点。小 Q 在设计棋盘时，还保证棋子从一个格点移动到另外任一格点的路径是唯一的。

小 Q 现在想知道，当棋子从格点 $0$ 出发，移动 $N$ 步最多能经过多少格点。格点可以重复经过多次，但不重复计数。

## 输入格式

第一行包含2个正整数 $V, N$，其中 $V$ 表示格点总数，$N$ 表示移动步数。

接下来 $V-1$ 行，每行两个数 $a_i,b_i$，表示编号为$a_i,b_i$ 的两个格点之间有连线。

## 输出格式

输出一行一个整数，表示最多经过的格点数量。

## 样例

### 样例输入 #1
```
5 2
1 0
2 1
3 2
4 3
```
### 样例输出 #1
```
3
```
### 样例输入 #2
```
9 5
0 1
0 2
2 6
4 2
8 1
1 3
3 7
3 5
```
### 样例输出 #2
```
5
```
## 提示

【输入输出样例 1 说明】

从格点 $0$ 出发移动 $2$ 步。经过 $0, 1, 2$ 这 $3$ 个格点。

【输入输出样例 2 说明】

一种可行的移动路径为 $0 \to 1 \to 3 \to 5 \to 3 \to 7$，经过 $0, 1, 3, 5, 7$ 这 $5$ 个格点。

【数据规模与约定】

对于 $100\%$ 的测试点，$1\le N,V ≤ 100$，$0 ≤a_i,b_i< V$。



---

---
title: "[SDOI2017] 序列计数"
layout: "post"
diff: 提高+/省选-
pid: P3702
tag: ['2017', '各省省选', '山东', '素数判断,质数,筛法', '容斥原理', '矩阵乘法', '快速傅里叶变换 FFT']
---
# [SDOI2017] 序列计数
## 题目描述

Alice 想要得到一个长度为 $n$ 的序列，序列中的数都是不超过 $m$ 的正整数，而且这 $n$ 个数的和是 $p$ 的倍数。

Alice 还希望，这 $n$ 个数中，至少有一个数是质数。

Alice 想知道，有多少个序列满足她的要求。
## 输入格式

一行三个数，$n,m,p$。

## 输出格式

一行一个数，满足 Alice 的要求的序列数量，答案对 $20170408$ 取模。
## 样例

### 样例输入 #1
```
3 5 3
```
### 样例输出 #1
```
33
```
## 提示

对 $20\%$ 的数据，$1\leq n,m\leq100$。


对 $50\%$ 的数据，$1\leq m \leq 100$。


对 $80\%$ 的数据，$1\leq m\leq 10^6$。


对 $100\%$ 的数据，$1\leq n \leq 10^9,1\leq m \leq 2\times 10^7,1\leq p\leq 100$。


---

---
title: "[HAOI2014] 穿越封锁线"
layout: "post"
diff: 提高+/省选-
pid: P3738
tag: ['计算几何', '2014', '河南', '各省省选']
---
# [HAOI2014] 穿越封锁线
## 题目描述

某敌占区是一个封闭的多边形，用相邻的顶点集合 $P_1(x_1,y_1)$，$P_2(x_2,y_2)$，$\cdots$，$P_n(x_n,y_n)$ 表示。

我方侦察员 ZDM-007 要穿越敌占区的封锁线，为了安全起见，ZDM-007 行走的路线垂直于 X 坐标轴，从南向北穿越。

现在已知侦察员 ZDM-007 所处的位置，你能算出他在穿越封锁线时，其路线在敌占区内的总长度？

![](https://cdn.luogu.com.cn/upload/pic/5207.png)

## 输入格式

第一行：$n$ 表示多边形顶点的个数

接下来 $n$ 行：$x_i,x_i$ 表示多边形的顶点坐标。（按逆时针顺序给出）

最后一行：$X,Y$ 表示侦察员初始时所处的位置。

## 输出格式

侦察员穿越封锁线时，在敌占区内的总长度。（输出仅保留整数部分）

## 样例

### 样例输入 #1
```
7 
0 1 
2 0
4 1
2 2 
4 3 
2 4 
0 3 
3 -1
```
### 样例输出 #1
```
2
```
### 样例输入 #2
```
4
10 100
10 0
100 0
100 100
100 -80
```
### 样例输出 #2
```
0
```
## 提示

【约束条件】

$3\le n\le 50,0\le x_i,y_i\le1000,0\le X \le1000,-100\le Y < 0$。


---

---
title: "[HAOI2014] 走出金字塔"
layout: "post"
diff: 提高+/省选-
pid: P3739
tag: ['2014', '河南', '各省省选']
---
# [HAOI2014] 走出金字塔
## 题目描述

在探险的过程中，考古学家 Dr. Kong 无意地被困在一个金字塔中。金字塔中的每个房间都是三角形。Dr. Kong 可以破壁走到相邻的房间去。例如，如果他目前处于三角形 $(2,2)$ 房间，那么他可以破壁走到三角形 $(2,1)$、$(2,3)$ 或 $(1,1)$ 房间。但破壁一面墙需要花费 $K$ 分钟时间，而考古学家 Dr. Kong 的体能只能支持他 $S$ 分钟。


好在 Dr. Kong 手中有这个金字塔地图，他发现金字塔有许多出口，一旦他进入一个有出口的三角形房间，他再用 $1$ 分钟就可以走出金字塔。

现在，你能否帮助 Dr. Kong 找到一个走出金字塔花费时间最少的出口？若能，输出 Dr. Kong 走出金字塔后还剩下的体能时间（应当大于或等于 $0$）；若不能，输出 $-1$。

![](https://cdn.luogu.com.cn/upload/pic/5208.png)

## 输入格式

第一行共四个整数，$N,M,K,S$，其中，

- $N$ 表示金字塔的层数；
- $M$ 表示出口数；
- $K$ 表示破壁一面墙的时间；
- $S$ 表示考古学家 Dr. Kong 体能维持分钟数。

第二行有两个整数 $X_a,Y_a$ 表示考古学家 Dr. Kong 所在的位置；

第三行至第 $M+2$ 行，每行有两个整数 $X_i,Y_i$，表示有出口的三角形坐标位置。

## 输出格式

输出 Dr. Kong 走出金字塔后还剩下的体能时间；若不能，输出 $-1$。

## 样例

### 样例输入 #1
```
4 2 2 10
2 1
3 5
4 4
```
### 样例输出 #1
```
3
```
## 提示

### 数据范围及约定

对于全部数据，$1 \le N \le 10^6$，$0\le M\le 10^4$，$0<K\le 20$，$10\le S\le 10^4$。

所有的数据都是整数，且数据之间有一个空格。



---

---
title: "[六省联考 2017] 期末考试"
layout: "post"
diff: 提高+/省选-
pid: P3745
tag: ['数学', '贪心', '2017', '各省省选', '三分', '枚举', '前缀和']
---
# [六省联考 2017] 期末考试
## 题目描述

有 $n$ 位同学，每位同学都参加了全部的 $m$ 门课程的期末考试，都在焦急的等待成绩的公布。

第 $i$ 位同学希望在第 $t_i$ 天或之前得知**所有**课程的成绩。如果在第 $t_i$ 天，有至少一门课程的成绩没有公布，他就会等待最后公布成绩的课程公布成绩，每等待一天就会产生 $C$ 不愉快度。

对于第 $i$ 门课程，按照原本的计划，会在第 $b_i$ 天公布成绩。

有如下两种操作可以调整公布成绩的时间:
1. 将负责课程 $X$ 的部分老师调整到课程 $Y$，调整之后公布课程 $X$ 成绩的时间推迟一天，公布课程 $Y$ 成绩的时间提前一天；每次操作产生 $A$ 不愉快度。
2. 增加一部分老师负责学科 $Z$，这将导致学科 $Z$ 的出成绩时间提前一天；每次操作产生 $B$ 不愉快度。

上面两种操作中的参数 $X, Y, Z$ 均可任意指定，每种操作均可以执行多次，每次执行时都可以重新指定参数。

现在希望你通过合理的操作，使得最后总的不愉快度之和最小，输出最小的不愉快度之和即可。
## 输入格式

第一行三个非负整数 $A, B, C$，描述三种不愉快度，详见【题目描述】；  
第二行两个正整数 $n, m$，分别表示学生的数量和课程的数量；  
第三行 $n$ 个正整数 $t_i$，表示每个学生希望的公布成绩的时间；  
第四行 $m$ 个正整数 $b_i$，表示按照原本的计划，每门课程公布成绩的时间。
## 输出格式

输出一行一个整数，表示最小的不愉快度之和。
## 样例

### 样例输入 #1
```
100 100 2
4 5
5 1 2 3
1 1 2 3 3
```
### 样例输出 #1
```
6
```
### 样例输入 #2
```
3 5 4
5 6
1 1 4 7 8
2 3 3 1 8 2
```
### 样例输出 #2
```
33
```
## 提示

### 样例解释 1

由于调整操作产生的不愉快度太大，所以在本例中最好的方案是不进行调整；全部的 $5$ 门课程中，最慢的在第 $3$ 天出成绩；  
同学 $1$ 希望在第 $5$ 天或之前出成绩，所以不会产生不愉快度；  
同学 $2$ 希望在第 $1$ 天或之前出成绩，产生的不愉快度为 $(3 - 1) \times 2 = 4$；  
同学 $3$ 希望在第 $2$ 天或之前出成绩，产生的不愉快度为 $(3 - 2) \times 2 = 2$；  
同学 $4$ 希望在第 $3$ 天或之前出成绩，所以不会产生不愉快度；  
不愉快度之和为 $4 + 2 = 6$。

### 数据范围

| Case # | $n, m, t_i, b_i$ | $A, B, C$ |
|:-:|:-:|:-:|
| 1, 2 | $1 \leq n, m, t_i, b_i \leq 2000$ | $A = 10^9; B = 10^9; 0 \leq C \leq 10^2$ |
| 3, 4 | $1 \leq n, m, t_i, b_i \leq 2000$ | $0 \leq A; C \leq 10^2; B = 10^9$ |
| 5, 6, 7, 8 | $1 \leq n, m, t_i, b_i \leq 2000$ | $0 \leq B \leq A \leq 10^2; 0 \leq C \leq 10^2$ |
| 9 - 12 | $1 \leq n, m, t_i, b_i \leq 2000$ | $0 \leq A, B, C \leq 10^2$ |
| 13, 14 | $1 \leq n, m, t_i, b_i \leq 10^5$ | $0 \leq A, B \leq 10^5; C = 10^{16}$ |
| 15 - 20 | $1 \leq n, m, t_i, b_i \leq 10^5$ | $0 \leq A, B, C \leq 10^5$ |


---

---
title: "[SHOI2012] 信用卡凸包"
layout: "post"
diff: 提高+/省选-
pid: P3829
tag: ['2012', '各省省选', '上海', '凸包']
---
# [SHOI2012] 信用卡凸包
## 题目背景

SHOI2012D1T2

## 题目描述

信用卡是一个矩形，唯四个角作了圆滑处理，使它们都是与矩形的两边相切的 1/4 圆，如下图所示。现在平面上有一些规格相同的信用卡，试求其凸包的周长。注意凸包未必是多边形，因为它可能包含若干段圆弧。

 ![](https://cdn.luogu.com.cn/upload/pic/6549.png) 


## 输入格式

输入的第一行是一个正整数 n，表示信用卡的张数。第二行包含三个实数 a, b, r，分别表示信用卡（圆滑处理前）竖直方向的长度、水平方向的长度，以及 1/4 圆的半径。

之后 n 行，每行包含三个实数 x, y, θ，分别表示一张信用卡中心（即对角线交点）的横、纵坐标，以及绕中心 逆时针旋转的 弧度。

## 输出格式

输出只有一行，包含一个实数，表示凸包的周长，四舍五入精确到小数点后2 位。

## 样例

### 样例输入 #1
```
2
6.0 2.0 0.0
0.0 0.0 0.0
2.0 -2.0 1.5707963268
```
### 样例输出 #1
```
21.66
```
### 样例输入 #2
```
3
6.0 6.0 1.0
4.0 4.0 0.0
0.0 8.0 0.0
0.0 0.0 0.0
```
### 样例输出 #2
```
41.60
```
### 样例输入 #3
```
3
6.0 6.0 1.0
4.0 4.0 0.1745329252
0.0 8.0 0.3490658504
0.0 0.0 0.5235987756
```
### 样例输出 #3
```
41.63
```
## 提示

样例1说明： ![](https://cdn.luogu.com.cn/upload/pic/6550.png)

本样例中的 2 张信用卡的轮廓在上图中用实线标出，如果视 1.5707963268为pi/2，那么凸包的周长为16+4sqrt(2)

样例2说明： ![](https://cdn.luogu.com.cn/upload/pic/6551.png)

样例3说明： ![](https://cdn.luogu.com.cn/upload/pic/6552.png)

其凸包的周长约为41.628267652。


本题可能需要使用数学库中的三角函数。不熟悉使用方法的选手，可以参考下面的程序及其输出结果：

```cpp
uses math;
const Pi = 3.141592653589793;
begin
writeln(sin(30.0 / 180.0 * Pi) : 0 : 10);
writeln(cos(60.0 / 180.0 * Pi) : 0 : 10);
writeln(tan(45.0 / 180.0 * Pi) : 0 : 10);
writeln(arcsin(1.0) : 0 : 10);
writeln(arccos(0.0) : 0 : 10);
writeln(arctan(1.0) : 0 : 10);
end.
```
```cpp
#include <iostream>
#include <math.h>
using namespace std;
const double Pi = 3.141592653589793;
int main()
{
cout.setf(ios::fixed);
cout.precision(10);
cout<<sin(30.0 / 180.0 * Pi)<<endl;
cout<<cos(60.0 / 180.0 * Pi)<<endl;
cout<<tan(45.0 / 180.0 * Pi)<<endl;
cout<<asin(1.0)<<endl;
cout<<acos(0.0)<<endl;
cout<<atan(1.0)<<endl;
return 0;
}
```
输出结果：0.5000000000

0.5000000000

1.0000000000

1.5707963268

1.5707963268

0.7853981634


数据范围：

 ![](https://cdn.luogu.com.cn/upload/pic/6553.png) 

![](https://cdn.luogu.com.cn/upload/pic/6554.png)



---

---
title: "[SHOI2012] 回家的路"
layout: "post"
diff: 提高+/省选-
pid: P3831
tag: ['图论', '2012', '各省省选', '上海', '最短路']
---
# [SHOI2012] 回家的路
## 题目背景

SHOI2012 D2T1

## 题目描述

2046 年 OI 城的城市轨道交通建设终于全部竣工，由于前期规划周密，建成后的轨道交通网络由$2n$条地铁线路构成，组成了一个$n$纵$n$横的交通网。如下图所示，这$2n$条线路每条线路都包含$n$个车站，而每个车站都在一组纵横线路的交汇处。


出于建设成本的考虑，并非每个车站都能够进行站内换乘，能够进行站内换乘的地铁站共有$m$个，在下图中，标上方块标记的车站为换乘车站。已知地铁运行 1 站需要 2 分钟，而站内换乘需要步行 1 分钟。Serenade 想要知道，在不中途出站的前提下，他从学校回家最快需要多少时间（等车时间忽略不计）。


![](https://cdn.luogu.com.cn/upload/pic/6547.png)

## 输入格式

第一行有两个整数$n,m$。

接下去$m$行每行两个整数$x,y$,表示第$x$条横向线路与第$y$条纵向线路的交

汇站是站内换乘站。

接下去一行是四个整数$x_1,y_1,x_2,y_2$。表示 Serenade 从学校回家时，在第 $x_1$条横向线路与第$y_1$条纵向线路的交汇站上车，在第$x_2$条横向线路与第$y_2$条纵向线路的交汇站下车。

## 输出格式

输出文件只有一行，即 Serenade 在合理选择线路的情况下，回家所需要的时间。如果 Serenade 无法在不出站换乘的情况下回家，请输出-1。

## 样例

### 样例输入 #1
```
2 1
1 2
1 1 2 2
```
### 样例输出 #1
```
5
```
### 样例输入 #2
```
6 9
2 1
2 5
3 2
4 4
5 2
5 6
6 1
6 3
6 4
1 1 4 6
```
### 样例输出 #2
```
27
```
### 样例输入 #3
```
6 10
2 1
2 5
3 2
4 4
5 2
5 6
6 1
6 3
6 4
6 6
1 1 4 6
```
### 样例输出 #3
```
26
```
## 提示

对于 30%的数据，$n\le 50,m\le 1000$；

对于 60%的数据，$n\le 500,m\le 2000$；

对于 100%的数据，$n\le 20000,m\le 100000$；



---

---
title: "[SHOI2012] 魔法树"
layout: "post"
diff: 提高+/省选-
pid: P3833
tag: ['2012', '线段树', '倍增', '各省省选', '上海', '最近公共祖先 LCA', '树链剖分']
---
# [SHOI2012] 魔法树
## 题目背景

SHOI2012 D2T3

## 题目描述

Harry Potter 新学了一种魔法：可以改变树上的果子个数。满心欢喜的他找到了一个巨大的果树，来试验他的新法术。

这棵果树共有 $N$ 个节点，其中节点 $0$ 是根节点，每个节点 $u$ 的父亲记为 $fa[u]$，保证有 $fa[u] < u$ 。初始时，这棵果树上的果子都被 Dumbledore 用魔法清除掉了，所以这个果树的每个节点上都没有果子（即 $0$ 个果子）。

不幸的是，Harry 的法术学得不到位，只能对树上一段路径的节点上的果子个数统一增加一定的数量。也就是说，Harry 的魔法可以这样描述：`A u v d` 。表示将点 $u$ 和 $v$ 之间的路径上的所有节点的果子个数都加上 $d$。

接下来，为了方便检验 Harry 的魔法是否成功，你需要告诉他在释放魔法的过程中的一些有关果树的信息：`Q u`。表示当前果树中，以点 $u$ 为根的子树中，总共有多少个果子？

## 输入格式

第一行一个正整数 $N (1 \leq N \leq 100000)$，表示果树的节点总数，节点以 $0,1,\dots,N - 1$ 标号，$0$ 一定代表根节点。

接下来 $N - 1$ 行，每行两个整数 $a,b (0 \leq a < b < N)$，表示 $a$ 是 $b$ 的父亲。

接下来是一个正整数 $Q(1 \leq Q \leq 100000)$，表示共有 $Q$ 次操作。

后面跟着 $Q$ 行，每行是以下两种中的一种：

1. `A u v d`，表示将 $u$ 到 $v$ 的路径上的所有节点的果子数加上 $d$。保证 $0 \leq u,v < N,0 < d < 100000$

2. `Q u`，表示询问以 $u$ 为根的子树中的总果子数，注意是包括 $u$ 本身的。

## 输出格式

对于所有的 `Q` 操作，依次输出询问的答案，每行一个。答案可能会超过 $2^{32}$ ，但不会超过 $10^{15}$ 。

## 样例

### 样例输入 #1
```
4
0 1
1 2
2 3
4
A 1 3 1
Q 0
Q 1
Q 2
```
### 样例输出 #1
```
3
3
2
```


---

---
title: "[TJOI2007] 球赛"
layout: "post"
diff: 提高+/省选-
pid: P3845
tag: ['贪心', '2007', '各省省选', '天津']
---
# [TJOI2007] 球赛
## 题目背景

超级球迷 H 每周六晚上都会坐在电视前看球，从不错过一场比赛。

但是上周末，H 突然有一个重要的约会，于是他只能教他三岁的弟弟小 H 记录所有比赛

的比分。但是当他约会回来时，他发现小 H 不仅认真的记录了每一场比赛的最终比分，还

把一些比赛的中间比分也记录下来，而更糟糕的是，小 H 并没有区分比赛的两个队，同一

场比赛的比分可能被记录成 1-2，也可能是 2-1。因此，若是有一场比赛的最终得分是 5-3，

可能实际上被小 H 记录的分数有

1-0 3-2 2-3 3-4 5-3

## 题目描述

现在 H 已经拿到了小 H 记录的所有比分，他想知道，在这个周末他由于约会至少错过

了多少场比赛。注意小 H 记录的比分是没有先后顺序的。

## 输入格式

输入文件中可能包含多组测试数据，文件中第一行是一个整数 n，表明以下一共有 n 组

测试数据。

对于每一组数据，第一行有一个整数 s，表示小 H 记录的比分数目，以下每行用 x-y 的

格式描述一条比分，x 和 y 都是非负整数。

## 输出格式

对于输入数据中的每一个测试数据，你需要输出一个整数 m，表示在这个测试数据中，

H 至少错过了 m 场比赛。

## 样例

### 样例输入 #1
```
2
4
1-0
2-0
0-3
2-1
4
5-0
1-3
2-2
0-0
```
### 样例输出 #1
```
2
3
```
## 提示

在第一组输入数据中，两场比赛对应的比分可能是 1-0 2-0 0-3 和 2-1。

在第二组输入数据中，三场比赛对应的比分可能是 0-0 5-0、3-1 和 2-2。

100%的数据中 n ≤ 5，s ≤ 1 000，每一场比赛的比分都在 longint(Pascal) / long(C++)

（2147483647）范围内。



---

---
title: "[TJOI2007] 可爱的质数/【模板】BSGS"
layout: "post"
diff: 提高+/省选-
pid: P3846
tag: ['搜索', '2007', '各省省选', 'O2优化', '素数判断,质数,筛法', '天津', '大步小步算法 BSGS']
---
# [TJOI2007] 可爱的质数/【模板】BSGS
## 题目描述

给定一个质数 $p$，以及一个整数 $b$，一个整数 $n$，现在要求你计算一个最小的非负整数 $l$，满足 $b^l \equiv n \pmod p$。
## 输入格式

仅一行，有 $3$ 个整数，依次代表 $p, b, n$。
## 输出格式

仅一行，如果有 $l$ 满足该要求，输出最小的 $l$，否则输出 `no solution`。
## 样例

### 样例输入 #1
```
5 2 3

```
### 样例输出 #1
```
3
```
## 提示

#### 数据规模与约定

- 对于所有的测试点，保证 $2\le b,n < p<2^{31}$。


---

---
title: "[TJOI2007] 调整队形"
layout: "post"
diff: 提高+/省选-
pid: P3847
tag: ['动态规划 DP', '2007', '各省省选', '枚举', '天津']
---
# [TJOI2007] 调整队形
## 题目背景

学校艺术节上，规定合唱队要参加比赛，各个队员的衣服颜色不能很混乱：合唱队员应排成一横排，且衣服颜色必须是左右对称的。

例如：“红蓝绿蓝红”或“红蓝绿绿蓝红”都是符合的，而“红蓝绿红”或“蓝绿蓝红”就不符合要求。

合唱队人数自然很多，仅现有的同学就可能会有3000个。老师希望将合唱队调整得符合要求，但想要调整尽量少，减少麻烦。以下任一动作认为是一次调整：

## 题目描述

1、在队伍左或右边加一个人（衣服颜色依要求而定）；

2、在队伍中任两个人中间插入一个人（衣服颜色依要求而定）；

3、剔掉一个人；

4、让一个人换衣服颜色；

老师想知道就目前的队形最少的调整次数是多少，请你编一个程序来回答他。

因为加入合唱队很热门，你可以认为人数是无限的，即随时想加一个人都能找到人。同时衣服颜色也是任意的。

## 输入格式

第一行是一个整数n(1<=n<=3000)。

第二行是n个整数，从左到右分别表示现有的每个队员衣服的颜色号，都是1到3000的整数。

## 输出格式

一个数，即对于输入队列，要调整得符合要求，最少的调整次数。

## 样例

### 样例输入 #1
```
5
1 2 2 4 3
```
### 样例输出 #1
```
2
```


---

---
title: "[TJOI2008] 通讯网破坏"
layout: "post"
diff: 提高+/省选-
pid: P3854
tag: ['2008', '各省省选', 'Tarjan', '天津']
---
# [TJOI2008] 通讯网破坏
## 题目背景

由于争夺资源引起的矛盾冲突，$A$ 国和 $B$ 国进入了战争一触即发的状态。现在 $A$ 国的间谍机构设法得到了 $B$ 国的通讯网络布置情况，其中每个城市可以看作一个点，在某些点之间有无向边，表示这些城市之间可以进行双向的直接通讯。$A$ 国打算先发制人，通过核武器毁灭某个中间城市 $M$，一举切断B国某两个重要城市 $S$ , $T$ 之间的联系，即从图中删除掉 $M$ 点之后，$S$ 和 $T$ 变得不连通。但是由于 $B$ 国的防御力量也很强大，这样的核打击只能成功进行一次且只能毁灭一个城市。

## 题目描述

现在 $A$ 国的首脑提出了很多种作战策略，作为 $A$ 国的首席计算机科学家，你的任务是编写一个程序决定这些策略可行与否。

## 输入格式

输入文件的第一行为两个整数 $N$ 和 $M$，表示 $B$ 国的城市数和可以直接通讯的城市对数目。接下来的 $M$ 行，每行包括两个整数 $C_i$ 和 $D_i$，$1\leq C_i,D_i \leq N$ 且 $C_i \neq D_i$，表示城市 $C_i$ 和 $D_i$ 之间可以直接通讯。输入数据保证每对 $(C_i,D_i)$ 最多出现一次。

接下来一行是一个整数 $Q$，表示 $A$ 国首脑作出的策略数。接下来的 $Q$ 行，每行包括三个整数 $S_i,T_i,M_i$（$1 \leq S_i,T_i,M_i\leq N$，且 $M_i,S_i,T_i$ 三个数互不相等）表示这个策略的内容是通过毁灭 $M_i$ 来切断 $S_i$ 和 $T_i$ 之间的联系。

## 输出格式

输出 $Q$ 行，表示对应的策略可行与否。如果毁灭 $M_i$ 以后，$S_i$ 和 $T_i$ 之间不能通讯，说明此策略可行，则应在第 $i$ 行输出 $\mathtt{yes}$，否则输出 $\mathtt{no}$。

## 样例

### 样例输入 #1
```
5 6
1 2
1 3
2 3
3 4
3 5
4 5
3
1 5 3
1 5 4
4 5 3

```
### 样例输出 #1
```
yes
no
no

```
## 提示

对于 $30\%$ 的数据，$1 \leq N \leq 100,1 \leq Q \leq 100$。

对于 $100\%$ 的数据，$1 \leq N \leq 20000,1\leq M\leq 100000,1 \leq Q \leq 100000$。

输入数据保证原图的任意两点是连通的。



---

---
title: "[TJOI2008] 彩灯"
layout: "post"
diff: 提高+/省选-
pid: P3857
tag: ['2008', '各省省选', '进制', '线性基', '构造', '天津']
---
# [TJOI2008] 彩灯
## 题目描述

Peter 女朋友的生日快到了，他亲自设计了一组彩灯，想给女朋友一个惊喜。已知一组彩灯是由一排 $N$ 个独立的灯泡构成的，并且有 $M$ 个开关控制它们。从数学的角度看，这一排彩灯的任何一个彩灯只有亮与不亮两个状态，所以共有 $2^N$ 个样式。由于技术上的问题，Peter 设计的每个开关控制的彩灯没有什么规律，当一个开关被按下的时候，它会把所有它控制的彩灯改变状态（即亮变成不亮，不亮变成亮）。假如告诉你他设计的每个开关所控制的彩灯范围，你能否帮他计算出这些彩灯有多少种样式可以展示给他的女朋友？

注： 开始时所有彩灯都是不亮的状态。
## 输入格式

每组测试数据第一行为两个整数 $N$ 和 $M$，用空格隔开。紧接着是有 $M$ 行，每行都是一个长度为 $N$ 的字符串，表示一个开关控制彩灯的范围（$N$ 盏灯），如果第 $i$ 个字母是大写字母 `O`，则表示这个开关控制第 $i$ 盏灯，如果第 $i$ 个字母是大写字母 `X`，则表示这个开关不控制此灯。
## 输出格式

输出这些开关和彩灯可以变换出来的样式数目。由于这个值可能会很大，请求出它对于整数 $2008$ 的余数。
## 样例

### 样例输入 #1
```
2 3
OO
XO
OX

```
### 样例输出 #1
```
4
```
## 提示

可见样例中第一个开关控制了所有的彩灯，而后两个开关分别控制了第一个和第二个彩灯，这样我们可以只用后两个开关控制彩灯，可以变换出来所有的 $2^2$ 个状态。

对于 $30\%$ 的数据，$N$ 和 $M$ 不超过 $15$。

另外有 $40\%$ 的数据，$N$ 和 $M$ 有一个为 $50$。

对于 $100\%$ 的数据，$N$ 和 $M$ 不超过 $50$。


---

---
title: "[TJOI2009] 排列计数"
layout: "post"
diff: 提高+/省选-
pid: P3867
tag: ['递推', '2009', '各省省选', 'O2优化', '枚举', '天津']
---
# [TJOI2009] 排列计数
## 题目描述

我们知道，1,2,...,N这个N个数的排列共有N!种情况。现在你的任务是，求出在这N!种排列中，任意相邻两数之差不超过K的排列共有多少个。

因为结果可能很大，你只需输出结果对1000000007取模后的值即可。

## 输入格式

输入文件只有一行，包含用空格隔开的两个数：N, K

## 输出格式

输出满足要求的排列个数对1000000007取模后的结果。

## 样例

### 样例输入 #1
```
4 2
```
### 样例输出 #1
```
12
```
## 提示

在30%的数据中，N ≤ 12

在100%的数据中，N ≤ 50，K ≤ 4

每个测试点时限10秒



---

---
title: "[TJOI2009] 猜数字"
layout: "post"
diff: 提高+/省选-
pid: P3868
tag: ['数学', '2009', '各省省选', '扩展欧几里德算法', '中国剩余定理 CRT', '天津']
---
# [TJOI2009] 猜数字
## 题目描述

现有两组数字，每组 $k$ 个。

第一组中的数字分别用 $a_1,a_2,\cdots ,a_k$ 表示，第二组中的数字分别用 $b_1,b_2,\cdots ,b_k$ 表示。

其中第二组中的数字是两两互素的。求最小的 $n\in \mathbb{N}$，满足对于 $\forall i\in [1,k]$，有 $b_i | (n-a_i)$。
## 输入格式

第一行一个整数 $k$。

第二行 $k$ 个整数，表示：$a_1,a_2,\cdots ,a_k$。

第三行 $k$ 个整数，表示：$b_1,b_2,\cdots ,b_k$。
## 输出格式

输出一行一个整数，为所求的答案 $n$。
## 样例

### 样例输入 #1
```
3
1 2 3
2 3 5

```
### 样例输出 #1
```
23
```
## 提示

对于 $100\%$ 的数据：

$1\le k \le 10$，$|a_i|\le 10^9$，$1\le b_i\le 6\times 10^3$，$\prod_{i=1}^k b_i\le 10^{18}$。

每个测试点时限 $1$ 秒。

注意：对于 ```C/C++``` 语言，对 $64$ 位整型数应声明为 ```long long```。

若使用 ```scanf```，```printf``` 函数（以及 ```fscanf```，```fprintf``` 等），应采用 ```%lld``` 标识符。


---

---
title: "[TJOI2010] 天气预报"
layout: "post"
diff: 提高+/省选-
pid: P3873
tag: ['递推', '2010', '各省省选', '线性递推', '构造', '天津']
---
# [TJOI2010] 天气预报
## 题目描述

A 公司的天气预报系统的原理如下：用一个大于等于 $0$，小于等于 $4146$ 的整数来表示这一天的天气情况，在预测未来某一天的天气情况时，要根据此前 $n$ 天的天气情况来预测，如果用 $w_i$ 表示第 $i$ 天的天气情况（$i>n$），那么 $w_i=(a_1\times w_{i-1}+a_2\times w_{i-2}+\cdots+a_{n}\times w_{i-n})\mod4147$，其中 $a_1,a_2,\cdots ,a_n$ 是已知常数。现给出前 $n$ 天的天气情况，问第 $m$ 天的天气预测结果是什么。
## 输入格式

输入数据的第一行是两个正整数 $n$ 和 $m$，第二行有 $n$ 个非负整数，分别为 $w_n,w_{n-1},\cdots,w_1$。第三行又有 $n$ 个非负整数，分别表示 $a_1,a_2,\ldots,a_n$。
## 输出格式

输出一个整数，表示对第 $m$ 天的天气预测结果。
## 样例

### 样例输入 #1
```
2 3
4 5
6 7

```
### 样例输出 #1
```
59
```
## 提示

$1\le n\le 100$，$n<m\le10^7$，$0\le a_i,w_i\le 4146$。

每个测试点时限 1.5 秒


---

---
title: "[TJOI2010] 砍树"
layout: "post"
diff: 提高+/省选-
pid: P3874
tag: ['2010', '各省省选', '天津']
---
# [TJOI2010] 砍树
## 题目背景

小 A 在果园里发现了一棵结满果子的树，于是他就打起了坏主意，他打算把树的一部分砍下来带回家。
## 题目描述

我们可以把这棵树表示成一个树型的结构，也就是说，任意两个点之间有且仅有一条路径。在每个点 $i$ 处都结着一个水果，每个水果有一个价值 $v_i$ 和重量 $w_i$。小 A 想带走树的一部分（或全部），包含至少 $K$ 个结点（也就是至少 $K$ 个水果），且这些水果的平均价值尽可能高。平均价值是指水果总的价值除以总的重量。注意小 A 砍下的树必须是在原来的树中连通的一部分。
## 输入格式

第一行包含两个数 $N$ 和 $K$，分别表示树的结点数和小 A 至少应带走的水果数。

第二行包含空格隔开的 $N$ 个数，分别表示每个结点处水果的价值 $v_i$。

第三行包含空格隔开的 $N$ 个数，分别表示每个水果的重量 $w_i$。

按下来 $N-1$ 行，每行包含两个数 $a_i$ 和 $b_i$（$1 \le a_i,b_i \le N$），表示在结点 $a_i$ 和 $b_i$ 之间有一条边。输入保证是一棵正确的树结构。
## 输出格式

输出一行，包含一个数，表示最大可能的平均价值。四舍五入到小数点后两位。

## 样例

### 样例输入 #1
```
3 1
20 10 20
1 1 1
1 2
2 3

```
### 样例输出 #1
```
20.00
```
### 样例输入 #2
```
3 2
20 10 20
1 1 1
1 2
2 3

```
### 样例输出 #2
```
16.67
```
## 提示

### 数据规模与约定

- 对 $20\%$ 的数据，$1 \le N \le 16$；
- 对 $100\%$ 的数据，$1 \le N \le 100$，$1 \le K \le N$，$1 \le v_i \le 10000$，$1 \le w_i \le 10000$。


---

---
title: "[TJOI2010] 被污染的河流"
layout: "post"
diff: 提高+/省选-
pid: P3875
tag: ['2010', '各省省选', '天津']
---
# [TJOI2010] 被污染的河流
## 题目背景

有一座城市，城市里有许多条人工河，河流的流向都是水平或者竖直的。为了方便市民用水，政府将河流设计成网格状。在水平方向上和竖直方向上，相邻河流的距离都是 $1$ 公里。河流围出许多格子，每个格子就是一个社区，社区里的居民可以到社区周边四条河段中的任意一处打水喝。

## 题目描述

郁闷的是，不久之后，有些不法商人修建了工厂，污染了河流。河边许多居民喝了被污染的水，生病了。政府派出专员小强调查污染情况。地理专家小强行动迅速，很快给出了污染分布。他给出了一张污染清单。清单列出了被污染的河段，所有能喝到该河段水的居民都有可能生病（河段的端点处忽略不计）。但是，笨笨的小强怎么也算不出具体会有多少个社区的居民会生病，所以，他请你来帮帮忙。

![](https://cdn.luogu.com.cn/upload/pic/6840.png)

## 输入格式

输入文件的第一行是一个整数 $N$，表示被污染的河段的数目。

接下来 $N$ 行，每行 $4$ 个整数 $x_1,y_1,x_2,y_2$，表示被污染河段的起始位置和结束位置。每行输入的两个位置保证不重合，并且满足 $x_1=x_2$ 或 $y_1=y_2$。

## 输出格式

输出一个整数 $A$，表示有 $A$ 个社区的居民会喝到被污染的水。

## 样例

### 样例输入 #1
```
3
1 3 4 3
6 7 6 3
4 6 7 6

```
### 样例输出 #1
```
16
```
## 提示

- 对于 $10\%$ 的数据，$1 \le  x_1,y_1,x_2,y_2 \le 100$，$1\le N \le 100$；
- 对于 $30\%$ 的数据，$1 \le x_1,y_1,x_2,y_2 \le 10^4$，$1\le N \le 100$；
- 对于 $100\%$ 的数据，$1 \le x_1,y_1,x_2,y_2 \le 10^5$，$1\le N \le 10^4$。


---

---
title: "[TJOI2010] 分金币"
layout: "post"
diff: 提高+/省选-
pid: P3878
tag: ['2010', '各省省选', 'O2优化', '模拟退火', '进制', '天津']
---
# [TJOI2010] 分金币
## 题目描述

现在有 $n$ 枚金币，它们可能会有不同的价值，第 $i$ 枚金币的价值为 $v_i$。

现在要把它们分成两部分，要求这两部分金币数目之差不超过 $1$，问这样分成的两部分金币的价值之差最小是多少？


## 输入格式

**本题单个测试点内有多组测试数据**。

输入的第一行是一个正整数 $T$，表示该测试点内数据组数。

对于每组测试数据的格式为：

每组测试数据占两行。

第一行是一个整数 $n$，表示金币的个数。

第二行有 $n$ 个整数，第 $i$ 个整数表示第 $i$ 个金币的价值 $v_i$。
## 输出格式

对于每组数据输出一行一个整数表示答案。
## 样例

### 样例输入 #1
```
2
3
2 2 4
4
1 2 3 6

```
### 样例输出 #1
```
0
2

```
## 提示

#### 数据规模与约定

- 对 $30\%$ 的数据，保证 $1 \leq v_i \leq 1000$
- 对于 $100\%$ 的数据，保证 $1 \leq T \leq 20$，$1 \leq n \leq 30$，$1 \leq v_i \leq 2^{30}$。


---

---
title: "[JLOI2009] F1一级方程式大赛"
layout: "post"
diff: 提高+/省选-
pid: P3885
tag: ['2009', '各省省选', '吉林']
---
# [JLOI2009] F1一级方程式大赛
## 题目背景

众所周知，迈克尔·舒马赫 (Michael  Schumacher) 是当今车坛最伟大的王者，从 1991 年至 2006 年他一共参加了 260 多场比赛，获得近 100 次分站冠军，9 次年度冠军。舒马赫取得如此辉煌的战绩得益于他有一个非常优秀的智囊团。每次比赛之前他的智囊团将根据场地、气候、路况以及赛车状态，来为舒马赫制定比赛中的策略。

## 题目描述

我们知道，在 F1 大赛中，如果赛车的其他参数都相同，赛车的速度主要取决于其载油量。载油太多就会降低赛车的速度，也会增加汽油的消耗速度；但载油太少就需要在比赛中增加进站加油的次数。因此智囊团的一个关键任务就是在每次比赛前确定舒马赫的初始载油量以及进站加油的方案，使得舒马赫完成所有赛程的总时间尽量短。


作为智囊团的首席程序员刘博士，交给他的团队的任务是编写一个程序，为舒马赫确定比赛开始前的载油量以及比赛中进站加油的方案。

## 输入格式

输入数据包括以下 $1$ 个数：

- 比赛的总圈数（一个不超过 $1$ 的正整数）

- 理论上，没有油的空车跑一圈所需的时间（浮点数，单位为秒）

- 每增加 $1$ 公升汽油，赛车跑一圈所增加的时间（浮点数，单位为秒）

- 理论上，没有油的空车跑一圈所消耗的油量（浮点数，单位为公升）

- 每增加 $1$ 公升汽油，赛车跑一圈所增加的油量损耗（浮点数，单位为公升，且这个数严格小于 $1$）

- 每次进站所需花费的时间（浮点数，单位为秒，这个时间不包括加油所需花费的时间，加油所花费的时间由下一个输入参数决定）

- 每次进站后，每加 $1$ 公升汽油，所需花费的时间（浮点数，单位为秒）

我们总是把一整圈看作一个单位。赛车在跑一圈的过程中，汽油的变化量不做考虑。加油总是在一整圈跑完以后才可以进行。

## 输出格式

- 第一行包括三个数：

 1. 舒马赫的赛车跑完所有赛程所需的最短时间（浮点数，保留小数点后三位）；
 2. 舒马赫的赛车在比赛开始前的载油量（浮点数，保留小数点后三位）；
 3. 舒马赫在比赛过程中进站加油的次数 $m$（整数）；


- 接下来是 $m$ 行，每行包括两个数：

 1. 第 $i$ 次进站加油时已经完成的圈数（整数）；
 2. 第 $i$ 次进站加油所加的油量（浮点数，保留小数点后三位）；

## 样例

### 样例输入 #1
```
3  100  0  10  0  20  0
```
### 样例输出 #1
```
300.000  30.000  0
```
### 样例输入 #2
```
3  100  2  10  0.1  20  1
```
### 样例输出 #2
```
422.469  23.457  1
2  11.111

```
### 样例输入 #3
```
3  100  4  10  0  20  1
```
### 样例输出 #3
```
480.000  10.000  2
1  10.000
2  10.000

```


---

---
title: "[GDOI2014] 拯救莫莉斯"
layout: "post"
diff: 提高+/省选-
pid: P3888
tag: ['2014', '各省省选', '广东', '枚举', '进制', '状压 DP']
---
# [GDOI2014] 拯救莫莉斯
## 题目描述

莫莉斯·乔是圣域里一个叱咤风云的人物，他凭借着自身超强的经济头脑，牢牢控制了圣域的石油市场。

圣域的地图可以看成是一个 $n\times m$ 的矩阵。每个整数坐标点 $(x, y)$ 表示一座城市（$1\le x\le n,1\le y\le m$）。两座城市间相邻的定义为：对于城市 $(A_x, A_y)$ 和城市 $(B_x, B_y)$，满足 $(A_x - B_x)^2 + (A_y - B_y)^2 = 1$。

由于圣域的石油贸易总量很大，莫莉斯意识到不能让每笔石油订购单都从同一个油库里发货。为了提高效率，莫莉斯·乔决定在其中一些城市里建造油库，最终使得每一个城市 $X$ 都满足下列条件之一：

1. 该城市 $X$ 内建有油库.
2. 某城市 $Y$ 内建有油库，且城市 $X$ 与城市 $Y$ 相邻。

与地球类似，圣域里不同城市间的地价可能也会有所不同，所以莫莉斯想让完成目标的总花费尽可能少。如果存在多组方案，为了方便管理，莫莉斯会选择建造较少的油库个数。

## 输入格式

第一行两个正整数 $n,m$（$n \times m \le 50$ 且 $m\le n$），表示矩阵的大小。

接下来一个 $n$ 行 $m$ 列的矩阵 $F$，$F_{i, j}$表示在城市 $(i,j)$ 建造油库的代价。

## 输出格式

输出两个数，建造方案的油库个数和方案的总代价。

## 样例

### 样例输入 #1
```
3 3
6 5 4
1 2 3
7 8 9
```
### 样例输出 #1
```
3 6
```
## 提示

对于 $30\%$ 数据满足 $n \times m \le 25$;   
对于 $100\%$ 数据满足 $n \times m \le 50,0 \le F_{i, j} \le 10 ^ 5$。



---

---
title: "[GDOI2014] 采集资源"
layout: "post"
diff: 提高+/省选-
pid: P3891
tag: ['动态规划 DP', '递推', '2014', '各省省选', '广东', '背包 DP']
---
# [GDOI2014] 采集资源
## 题目描述

魔兽争霸3中，战略资源的采集通过使用农民、苦工、小精灵以及寺僧来进行。

在魔兽争霸4的开发中，玻璃渣觉得这种模式太过单一，于是他们想添加更多的单位来使采集的模式更加丰富。

在新的模式中，玩家可以建造更多种类的“苦工”，不同的“苦工”的工作效率不同，同时，建造不同的“苦工”所需要的资源也是不一样的。

玻璃渣出品的游戏以追求平衡著称，所以为了测试这种新的模式的平衡性，他们设计了一套检测的方法：在各种族的起始资源相同时，测量达到某一资源数量的时间，如果相同则可以认为设计是平衡的。

他们将数据给你，希望你能测试出设计是否平衡。

## 输入格式

第一行三个数，N, M, T, 表示苦工的种类、开始时拥有的资源数量以及需要达到的资源的数量。

接下来N行，每行2个数A, B, 表示生产这种苦工所需要的资源，以及这个苦工的效率，效率即为单位时间内产生的资源的数量。

## 输出格式

一个数字，表示资源数量达到T时的最少时间。


注意：与魔兽争霸3不同，魔兽争霸4中，生产苦工不需要时间。并且资源的采集并不连续，亦即如果一个苦工的效率为2，他会在时间为1的时候收获2点资源，而并不会在时间为0.5的时候收获1点资源。

## 样例

### 样例输入 #1
```
1 1 8
1 1

```
### 样例输出 #1
```
4
```
### 样例输入 #2
```
2 1 8
1 1
2 8

```
### 样例输出 #2
```
3
```
## 提示

对于30%的数据，N<=10, M, T <= 300

对于100%的数据，N<=100，M, T <= 1000, A, B <= 2^31

数据保证有解。



---

---
title: "[TJOI2013] 黄金矿工"
layout: "post"
diff: 提高+/省选-
pid: P3961
tag: ['2013', '各省省选', '排序', '背包 DP', '图论建模', '天津']
---
# [TJOI2013] 黄金矿工
## 题目描述

小 A 最近迷上了在上课时玩《黄金矿工》这款游戏。为了避免被老师发现，他必须小心翼翼，因此他总是输。

在输掉自己所有的金币后，他向你求助。每个黄金可以看做一个点（没有体积）。现在给出你 $N$ 个黄金的坐标，挖到它们所需要的时间以及它们的价值。有些黄金在同一条直线上，这时候你必须按顺序挖。你可以瞬间把钩子转到任意角度。

小 A 一开始在坐标 $(0,0)$，请你帮助小 A 算出在时间 $T$ 内他最多可以得到多少价值的金子。
## 输入格式

第一行两个整数 $N$ 和 $T$，表示黄金的个数和总时间。

接下来 $N$ 行，每行四个整数 $x$、$y$、$t$、$v$，分别表示黄金的坐标，挖到这个黄金的时间，以及这个黄金的价值。
## 输出格式

一个整数,表示你可以在 $T$ 时间内得到的最大价值。
## 样例

### 样例输入 #1
```
3 10
1 1 1 1
2 2 2 2
1 3 15 9
```
### 样例输出 #1
```
3
```
### 样例输入 #2
```
3 10
1 1 13 1
2 2 2 2
1 3 4 7
```
### 样例输出 #2
```
7
```
## 提示

- 对于 $30\%$ 的数据，$0<T\le 4\times 10^3$；
- 对于 $100\%$ 的数据，$1\le N\le 200$，$0<T\le 4\times 10^4$。

保证 $0\le|x|\le 200$，$0<y≤200$，$0<t\le 200$，$0\le v\le 200$。


---

---
title: "[TJOI2013] 奖学金"
layout: "post"
diff: 提高+/省选-
pid: P3963
tag: ['贪心', '2013', '各省省选', '堆', '枚举', '优先队列', '可持久化线段树', '天津']
---
# [TJOI2013] 奖学金
## 题目背景

小张最近发表了一篇论文，有一个神秘人物要给小张学院发奖学金。
## 题目描述

小张学院有 $c$ 名学生，第 $i$ 名学生的成绩为 $a_i$，要获得的奖学金金额为 $b_i$。  
要从这 $c$ 名学生中挑出 $n$ 名学生发奖学金。这个神秘人物爱好奇特，他希望得到奖学金的同学的**成绩**的**中位数**尽可能大，但同时，他们的**奖学金总额**不能超过 $f$。

## 输入格式

第一行有三个整数，分别表示要挑出的学生人数 $n$，学生总人数 $c$ 和奖学金总额的最大值 $f$，**保证 $n$ 为奇数**。  

第 $2$ 到第 $(c + 1)$ 行，每行两个整数，第 $(i + 1)$ 行的整数依次表示第 $i$ 名学生的成绩 $a_i$ 和如果要给他发奖学金，则需要发的金额数 $b_i$。
## 输出格式

输出一行一个整数表示答案。如果无法满足神秘人的条件，请输出 $-1$。
## 样例

### 样例输入 #1
```
3 5 70
30 25
50 21
20 20
5 18
35 30

```
### 样例输出 #1
```
35
```
### 样例输入 #2
```
5 6 9
4 0
4 1
6 3
8 0
10 4
10 5

```
### 样例输出 #2
```
6
```
## 提示

### 样例 1 解释

选择成绩为 $5$，$35$，$50$ 的三名同学，奖金总额为 $18 + 30 + 21 = 69$。

### 数据规模与约定

- 对于 $30\%$ 的数据，保证 $n \leq 10^3$，$c \leq 2 \times 10^3$。
- 对于 $100\%$ 的数据，保证 $3 \leq n  \leq 10^5$，$n \leq c \leq 2 \times 10^5$，$0 \leq f \leq 2\times 10^9$，$0 \leq a_i \leq 2 \times 10^9$，$0 \leq b_i \leq 10^5$。


---

---
title: "[TJOI2013] 松鼠聚会"
layout: "post"
diff: 提高+/省选-
pid: P3964
tag: ['2013', '各省省选', '枚举', '前缀和', '天津']
---
# [TJOI2013] 松鼠聚会
## 题目描述

草原上住着一群小松鼠，每个小松鼠都有一个家。时间长了，大家觉得应该聚一聚。但是草原非常大，松鼠们都很头疼应该在谁家聚会才最合理。

每个小松鼠的家可以用一个点 $(x,y)$ 表示,两个点的距离定义为点 $(x,y)$ 和它周围的 $8$ 个点 $(x-1,y)$，$(x+1,y)$，$(x,y-1)$，$(x,y+1)$，$(x-1,y+1)$，$(x-1,y-1)$，$(x+1,y+1)$，$(x+1,y-1)$ 距离为 $1$。

## 输入格式

第一行是一个整数 $N$，表示有多少只松鼠。接下来 $N$ 行，第 $i$ 行是两个整数 $x$ 和 $y$，表示松鼠 $i$ 的家的坐标。
## 输出格式

一个整数，表示松鼠为了聚会走的路程和最小是多少。

## 样例

### 样例输入 #1
```
6
-4 -1
-1 -2
2 -4
0 2
0 3
5 -2
```
### 样例输出 #1
```
20
```
### 样例输入 #2
```
6
0 0
2 0
-5 -2
2 -2
-1 2
4 0
```
### 样例输出 #2
```
15
```
## 提示

### 样例解释

在第一个样例中，松鼠在第二只松鼠家 $(-1,-2)$ 聚会；在第二个样例中，松鼠在第一只松鼠家 $(0,0)$ 聚会。

### 数据范围

- $30\%$ 的数据，$0\le N \le 1000$；
- $100\%$ 的数据，$0\le N \le 10^5$，$-10^9 \le x, y \le 10^9$。


---

---
title: "[TJOI2013] 单词"
layout: "post"
diff: 提高+/省选-
pid: P3966
tag: ['2013', '二分', '各省省选', 'AC 自动机', '天津']
---
# [TJOI2013] 单词
## 题目描述

小张最近在忙毕设,所以一直在读论文。一篇论文是由许多单词组成但小张发现一个单词会在论文中出现很多次，他想知道每个单词分别在论文中出现了多少次。
## 输入格式

第一行一个整数 $N$，表示有 $N$ 个单词。

接下来 $N$ 行每行一个单词,每个单词都由小写字母 $a-z$ 组成。
## 输出格式

输出 $N$ 个整数,第 $i$ 行的数表示第 $i$ 个单词在文章中出现了多少次。
## 样例

### 样例输入 #1
```
3
a
aa
aaa
```
### 样例输出 #1
```
6
3
1

```
## 提示

### 数据规模与约定

- $30\%$ 的数据， 单词总长度不超过 $10^3$。
- $100\%$ 的数据，$1 \leq n \leq 200$，单词总长度不超过 $10^6$。


---

---
title: "[TJOI2014] 拼图"
layout: "post"
diff: 提高+/省选-
pid: P3969
tag: ['2014', '各省省选', '天津']
---
# [TJOI2014] 拼图
## 题目描述

小Z最近迷上了拼图游戏,然而智商有限,他总是无法拼出完整图案。游戏是这样的：首先小Z会得到一些拼图碎片,然后他试着重新排列这些碎片使得它们组成一个大小为4\*4的正方形。如下图。注意小Z不能旋转或者翻转这些碎片。

 ![](https://cdn.luogu.com.cn/upload/pic/10988.png) 

小Z得到如图1的碎片,然后经过重新排列得到图2的正方形。

由于小Z实在太笨了,聪明的你请写一个程序帮助他来解决这个问题吧。

## 输入格式

输入包含多组数据,请使用EOF

每组数据的的第一行包含一个正整数N，表示碎片的个数。接下来输入N个碎片。每个碎片的第一行是两个正整数r和c,表示这个碎片的行数和列数。接下来是r行,每一行包含c个字符'0'或'1'，'1'表示碎片占据这个位置,'0'表示该位置为空。数据保证每个碎片都是完整的一片(即'1'是相互连通的),并且没有行或者列全部为'0'。

## 输出格式

如果无法组成一个正方形,输出”No solution”;如果有多组解,输出”Yes, many!”。否则,输出”Yes, only one!”,接下来输出一个4\*4的矩阵H,Hij表示位置i,j的碎片编号。碎片编号从1开始。

## 样例

### 样例输入 #1
```
4
2 3
111
101
4 2
01
01
11
01
2 1
1 1
3 2
10
10
11
4
1 4
1111
1 4
1111
1 4
1111
1 4
1111
4
1 4
1111
1 4
1111
1 4
1111
2 3
111
001
```
### 样例输出 #1
```
Yes, only one!
1112
1412
3422
3442
Yes, many!
No solution
```
## 提示

### 数据范围

对于 30% 的数据，N < 5

对于 100% 的数据，N ≤ 16



---

---
title: "[TJOI2014] 上升子序列"
layout: "post"
diff: 提高+/省选-
pid: P3970
tag: ['2014', '线段树', '各省省选', '树状数组', '排序', '天津']
---
# [TJOI2014] 上升子序列
## 题目描述

给定一个只包含整数的序列(序列元素的绝对值大小不超过10^9),你需要计算上升子序列的个数,满足如下条件的称之为一个上升子序列:

1. 是原序列的一个子序列

2. 长度至少为2

3. 所有元素都严格递增

如果两个上升子序列相同,那么只需要计算一次。例如:序列{1,2,3,3}有4个上升子序列,分别为{1,2}{1,3},{1,2,3},{2,3}

## 输入格式

输入的第一行是一个整数n,表示序列长度。接下来一行是n个整数,表示序列。

## 输出格式

输出仅包含一行,即原序列有多少个上升子序列。由于答案可能非常大,你只需要输出答案模10^9+7的余数。

## 样例

### 样例输入 #1
```
4
1 2 3 3
```
### 样例输出 #1
```
4
```
## 提示

### 数据范围

对于 30% 的数据，N ≤ 5000

对于 100% 的数据，N ≤ 10^5



---

---
title: "[SHOI2013] 发微博"
layout: "post"
diff: 提高+/省选-
pid: P3998
tag: ['2013', '各省省选', '上海', 'O2优化']
---
# [SHOI2013] 发微博
## 题目描述

刚开通的 SH 微博共有 $n$ 个用户（$1\sim n$ 标号），在这短短一个月的时间内，用户们活动频繁，共有 $m$ 条按时间顺序的记录：

```plain
! x 表示用户 x 发了一条微博；
+ x y 表示用户 x 和用户 y 成为了好友
− x y 表示用户 x 和用户 y 解除了好友关系
```
当一个用户发微博的时候，所有他的好友（直接关系）都会看到他的消息。

假设最开始所有人之间都不是好友关系，记录也都是合法的（即 `+ x y` 时 $x$ 和 $y$ 一定不是好友，而 `− x y` 时 $x$ 和 $y$ 一定是好友）。

问这 $m$ 条记录发生之后，每个用户分别看到了多少条消息。

## 输入格式

第 $1$ 行两个整数 $n$, $m$。

接下来 $m$ 行，按时间顺序读入 $m$ 条记录，每条记录的格式如题目所述，用空格隔开。
## 输出格式

输出一行 $n$ 个用空格隔开的数（行末无空格），第 $i$ 个数表示用户 $i$ 最后看到了几条消息。

## 样例

### 样例输入 #1
```
2 8
! 1
! 2
+ 1 2
! 1
! 2
- 1 2
! 1
! 2
```
### 样例输出 #1
```
1 1
```
## 提示

对于 $100\%$ 的数据，$n\leq 200000$, $m\leq 500000$


---

---
title: "[SHOI2013] 二重镇"
layout: "post"
diff: 提高+/省选-
pid: P3999
tag: ['2013', '各省省选', '上海', 'O2优化', '枚举', '进制', '状压 DP']
---
# [SHOI2013] 二重镇
## 题目描述

这是一个充满爱的村子，它的名字叫二重镇。在这个爱意浓浓的村子里，居民们的生活快乐又安宁。二重镇呈长条形状，可分为排成一行的 $N$ 个方格。每个格子可能是空地，也可能是小草、灌木、大树、房屋或城堡中的一种物品。每种物品都有一个等级，小草的等级是 $1$，灌木的等级是 $2$，依此类推。

你是这个村庄的建造者。你会陆续获得 $D$ 件物品，你要将它们合理地放置在村庄的空地上。你的目标是要让村子的总人气尽可能大。人气的获得规则在后面说明。关于放置的规则有以下几条：

* 第一，每件物品都必须放在一个地方，不可丢弃，如果没有空地了，游戏直接结束；

* 第二，物品可以放在一格空地上，或者临时放在仓库里。仓库同时最多只能放一件物品，它一开始是空的。只存在一个仓库；

* 第三，一旦物品放在某个空格上，只要符合条件，系统就会自动将一些物品合成一个大的物品，这是强制被动的，也是瞬间的。直到合成结束后，才能放置下一个物品。

* 第四，存放在仓库中的物品，随时可以取出放到空地上（但注意不能在合成的过程中放置），也可以一直留在仓库里。

* 第五，除非利用仓库，不然不能更改物品的放置顺序；

总结起来，这个游戏的流程就是获得一个新物品，决定是否将这个物品存入仓库，再决定将仓库中的物品或新物品放到哪个空地上，系统自动判定合成，获得人气，直到所有物品都被放置完毕，或空地用完为止。

最后是关于合成的规则。合成是自动完成的，也是强制性的。如果有连续两个或以上相邻的格子里有相同等级的物品，它们会自动合体成一个新的物品，新物品的等级比之前高一个级别。合体分三步：

* 第一步，确定有多少物品参与合成，这些物品的位置必须连在一起，等级相同。参与合体的物品会全部消失，对应的格子边成空地；

* 第二步，假设有 $A$ 个 $K$ 级物品参与合体，那么将获得$A\times 2^K$ 点人气。例如有一次五棵小草进行了合体，那么总人气就会增加 $5 \times 2^1=10$；

* 第三步，一个 $K+1$ 等级的物品会出现在一个格子里。如果 $K+1$ 大于 $5$，则跳过这步，但第二步中的人气仍然要算，第一步中的旧物品也会被清除。这个高等级的物品只会出现在参与合体的格子上。每个格子会记录最后一次被放置物品的时间，新的物品会出现在该时间最晚的那个格子里，形象地说，就是出现在最近被放置过东西的格子；

最后，请注意合成是会触发多次的，比如两个小草合成一个灌木，如果这棵灌木旁边还有其他灌木，合体将继续发生下去。

现在，给出 $N$ 和获得物品的顺序及等级，请你要合理地将这些物品放置在一个初始全是空地的村子里，使得村子最终的人气值尽可能高。当所有物品都被放置，或者某一刻村子里没空地了，你都会结束村子的建设，而此时村子里累计人气值就是你的最终成果。

## 输入格式

第一行给出两个整数 $N$ 和 $D$，用空格隔开。$N$ 表示村庄大小，$D$ 表示建设村庄的天数。

第二行为一个字符串，每个字符为 $1 \ldots 5$ 之间的一个字符，表示每天你可以放置的物品的等级。

## 输出格式

输出一个整数，表示你能得到的最大的人气值。

## 样例

### 样例输入 #1
```
4 10
1132411235
```
### 样例输出 #1
```
168
```
## 提示

对于 $30\%$ 的数据，$N=3$, $D\leq 10$。

对于 $60\%$ 的数据，$N\leq 4$, $D\leq 30$。

对于 $100\%$ 的数据，$N\leq 6$, $D\leq 100$。



---

---
title: "[JSOI2008] 球形空间产生器"
layout: "post"
diff: 提高+/省选-
pid: P4035
tag: ['2008', '各省省选', '江苏', '模拟退火', '高斯消元', '构造']
---
# [JSOI2008] 球形空间产生器
## 题目描述

有一个球形空间产生器能够在 $n$ 维空间中产生一个坚硬的球体。现在，你被困在了这个 $n$ 维球体中，你只知道球面上 $n+1$ 个点的坐标，你需要以最快的速度确定这个 $n$ 维球体的球心坐标，以便于摧毁这个球形空间产生器。
## 输入格式

第一行是一个整数 $n$ $(1\le N\le 10)$。接下来的 $n+1$ 行，每行有 $n$ 个实数，表示球面上一点的 $n$ 维坐标。每一个实数精确到小数点后 $6$ 位，且其绝对值都不超过 $20000$。
## 输出格式

有且只有一行，依次给出球心的 $n$ 维坐标（ $n$ 个实数），两个实数之间用一个空格隔开。每个实数精确到小数点后 $3$ 位。数据保证有解。你的答案必须和标准输出一模一样才能够得分。
## 样例

### 样例输入 #1
```
2
0.0 0.0
-1.0 1.0
1.0 0.0
```
### 样例输出 #1
```
0.500 1.500
```
## 提示

提示：给出两个定义：

1. 球心：到球面上任意一点距离都相等的点。
2. 距离：设两个 $n$ 维空间上的点 $A,B$ 的坐标为 $(a_1, a_2, \cdots , a_n), (b_1, b_2, \cdots , b_n)$，则 $A,B$ 的距离定义为：$dist = \sqrt{ (a_1-b_1)^2 + (a_2-b_2)^2 + \cdots + (a_n-b_n)^2 }$。



---

---
title: "[JSOI2010] 旅行"
layout: "post"
diff: 提高+/省选-
pid: P4038
tag: ['2010', '各省省选', '江苏']
---
# [JSOI2010] 旅行
## 题目描述

2009 的新年即将到来，JSK 决定开车去拜访他小镇上的所有朋友，由于他在每一个街道都有一个朋友，他开始考虑如何使旅程尽可能地短。很快他意识到最短的方法就是经过所有的街道一次且仅一次。很自然地，他希望能在旅行结束时回到开始的地方，即他父母的房子。

JSK 计划他的环城旅行：城镇的街道编号为 $1\sim n$，交汇点编号为 $1\sim m$ ，没有哪个交汇点连接了多于 $44$ 个街道。所有的交汇点有着不同的数字编号。

每个街道恰好联接着两个交汇点，任两个街道的数字编号不同。如果存在一个以上满足条件的旅行路径，则按旅行经过的街道顺序排列街道编号，选择其字典序最小的那一个路径。

由于 JSK 连一条这样的街道都无法找到，只有请你帮他写一个程序来找这样最短的旅行路径。如果不存在这样的路径则打印出一条信息。假定 JSK 住在和街道 $1$ 相连的编号较小的那个交汇点。

城镇中每一个街道都是相同的（不是死胡同），任两个街道之间有路可以达到。这些街道很窄因此一旦车进了一条路它不可能调头回走。

## 输入格式

每一行包括三个整数 $x,y,z$，若 $x>0$，$y>0$ 表示与编号为 $z$ 的街道相连的交汇点编号。如果 $x=0$，$y=0$ 则标志输入结束。

## 输出格式

输出文件共一行，描述了 JSK 的环城旅行（街道号的序列，由空格隔开）。如果没有发现满足条件的环城路线。则该行给出信息：`Round trip does not exist`。

## 样例

### 样例输入 #1
```
1 2 1
2 3 2
3 1 6
1 2 5
2 3 3
3 1 4
0 0 0
```
### 样例输出 #1
```
1 2 3 5 4 6

```
### 样例输入 #2
```
1 2 1
2 3 2
1 3 3
2 4 4
0 0 0
```
### 样例输出 #2
```
Round trip does not exist
```
## 提示

【数据范围】    
$1\le n \le 1994$，$1\le m \le 43$。


---

---
title: "[AHOI2014/JSOI2014] 骑士游戏"
layout: "post"
diff: 提高+/省选-
pid: P4042
tag: ['图论', '2014', '各省省选', '江苏', '安徽', '最短路']
---
# [AHOI2014/JSOI2014] 骑士游戏
## 题目背景

长期的宅男生活中，JYY 又挖掘出了一款 RPG 游戏。在这个游戏中 JYY 会扮演一个英勇的骑士，用他手中的长剑去杀死入侵村庄的怪兽。
## 题目描述

在这个游戏中，JYY 一共有两种攻击方式，一种是普通攻击，一种是法术攻击。两种攻击方式都会消耗 JYY 一些体力。采用普通攻击进攻怪兽并不能把怪兽彻底杀死，怪兽的尸体可以变出其他一些新的怪兽，注意一个怪兽可能经过若干次普通攻击后变回一个或更多同样的怪兽；而采用法术攻击则可以彻底将一个怪兽杀死。当然了，一般来说，相比普通攻击，法术攻击会消耗更多的体力值（但由于游戏系统 bug，并不保证这一点）。

游戏世界中一共有 $N$ 种不同的怪兽，分别由 $1$ 到 $N$ 编号，现在 $1$ 号怪兽入侵村庄了，JYY 想知道，最少花费多少体力值才能将所有村庄中的怪兽全部杀死呢？
## 输入格式

第一行包含一个整数 $N$。

接下来 $N$ 行，每行描述一个怪兽的信息；

其中第 $i$ 行包含若干个整数，前三个整数为 $S_i$，$K_i$ 和 $R_i$，表示对于 $i$ 号怪兽，普通攻击需要消耗 $S_i$ 的体力，法术攻击需要消耗 $K_i$ 的体力，同时 $i$ 号怪兽死亡后会产生 $R_i$ 个新的怪兽。表示一个新出现的怪兽编号。同一编号的怪兽可以出现多个。
## 输出格式

输出一行一个整数，表示最少需要的体力值。

## 样例

### 样例输入 #1
```
4
4 27 3 2 3 2
3 5 1 2
1 13 2 4 2
5 6 1 2
```
### 样例输出 #1
```
26
```
## 提示

首先用消耗 $4$ 点体力用普通攻击，然后出现的怪兽编号是 $2$，$2$ 和 $3$。花费 $10$ 点体力用法术攻击杀死两个编号为 $2$ 的怪兽。剩下 $3$ 号怪兽花费 $1$ 点体力进行普通攻击。此时村庄里的怪兽编号是 $2$ 和 $4$。最后花费 $11$ 点体力用法术攻击将这两只怪兽彻底杀死。一共花费的体力是 $4+5+5+1+5+6=26$。

对于所有数据 $2 \le N \le 2 \times 10^5$，$1 \le R_i,\sum R_i \le 10^6$，$1 \le K_i,S_i \le 5 \times 10^{14}$。



---

---
title: "[JSOI2007] 麻将"
layout: "post"
diff: 提高+/省选-
pid: P4050
tag: ['2007', '各省省选', '江苏', '枚举']
---
# [JSOI2007] 麻将
## 题目描述

麻将是中国传统的娱乐工具之一。麻将牌的牌可以分为字牌（共有东、南、西、北、中、发、白七种）和序数牌（分为条子、饼子、万子三种花色，每种花色各有一到九的九种牌），每种牌各四张。

在麻将中，通常情况下一组和了的牌（即完成的牌）由十四张牌组成。十四张牌中的两张组成对子（即完全相同的两张牌），剩余的十二张组成三张一组的四组，每一组须为顺子（即同花色且序数相连的序数牌，例如条子的三、四、五）或者是刻子（即完全相同的三张牌）。一组听牌的牌是指一组十三张牌，且再加上某一张牌就可以组成和牌。那一张加上的牌可以称为等待牌。

在这里，我们考虑一种特殊的麻将。在这种特殊的麻将里，没有字牌，花色也只有一种。但是，序数不被限制在一到九的范围内，而是在1到n的范围内。同时，也没有每一种牌四张的限制。一组和了的牌由3m + 2张牌组成，其中两张组成对子，其余3m张组成三张一组的m组，每组须为顺子或刻子。现给出一组3m + 1张的牌，要求判断该组牌是否为听牌（即还差一张就可以和牌）。如果是的话，输出所有可能的等待牌。

## 输入格式

包含两行。第一行包含两个由空格隔开整数n, m (9<=n<=400, 4<=m<=1000)。第二行包含3m + 1个由空格隔开整数，每个数均在范围1到n之内。这些数代表要求判断听牌的牌的序数。

## 输出格式

输出为一行。如果该组牌为听牌，则输出所有的可能的等待牌的序数，数字之间用一个空格隔开。所有的序数必须按从小到大的顺序输出。如果该组牌不是听牌，则输出"NO"。

## 样例

### 样例输入 #1
```
9 4
1 1 2 2 3 3 5 5 5 7 8 8 8
```
### 样例输出 #1
```
6 7 9
```


---

---
title: "[JSOI2009] 计数问题"
layout: "post"
diff: 提高+/省选-
pid: P4054
tag: ['2009', '各省省选', '树状数组', '江苏', '前缀和']
---
# [JSOI2009] 计数问题
## 题目描述

一个 $n \times\ m$ 的方格，初始时每个格子有一个整数权值。接下来每次有 2 种操作：

- 改变一个格子的权值；

- 求一个子矩阵中某种特定权值出现的个数。

## 输入格式

第一行有两个数 $n,m$。

接下来 $n$ 行，每行 $m$ 个数，第 $i+1$ 行第 $j$ 个数表示格子 $(i,j)$ 的初始权值。

接下来输入一个整数 $Q$。

之后 $Q$ 行，每行描述一个操作。

操作 1：输入一行四个整数 $1\ x\ y\ c$，表示将格子 $(x,y)$ 的权值改成 $c$。

操作 2：输入一行六个整数 $2\ x_1\ x_2\ y_1\ y_2\ c$。表示询问所有满足格子颜色为 $c$，且满足 $x_1\le x\le x_2,y_1\le y\le y_2$ 的格子个数。
## 输出格式

对于每个操作 2，按照在输入中出现的顺序，依次输出一行一个整数表示所求得的个数。
## 样例

### 样例输入 #1
```
3 3
1 2 3
3 2 1
2 1 3
3
2 1 2 1 2 1
1 2 3 2
2 2 3 2 3 2
```
### 样例输出 #1
```
1
2

```
## 提示

【数据规模与约定】

对于 $30\%$ 的数据，满足：$n,m\le 30$，$Q\le 5\times 10^4$。

对于 $100\%$ 的数据，满足：$1\le n,m\le 300$，$1\le Q\le 2\times 10^5$。

对于操作 1，保证：$1\le x
\le n$，$1\le y\le m$，$1\le c\le 100$；

对于操作 2，保证：$1\le x_1≤x_2\le n$，$1\le y_1\le y_2\le m$，$1\le c\le 100$。




---

---
title: "[JXOI2017] 加法"
layout: "post"
diff: 提高+/省选-
pid: P4064
tag: ['贪心', '2017', '二分', '各省省选', '树状数组', '优先队列']
---
# [JXOI2017] 加法
## 题目描述

可怜有一个长度为 $n$ 的正整数序列 $A$，但是她觉得 $A$ 中的数字太小了，这让她很不开心。

于是她选择了 $m$ 个区间 $[l_i,r_i]$ 和两个正整数 $a,k$。她打算从这 $m$ 个区间里选出恰好 $k$ 个区间，并对每个区间执行一次区间加 $a$ 的操作。（每个区间最多只能选择一次）。

对区间 $[l,r]$ 进行一次加 $a$ 操作可以定义为对于所有 $i$ ∈ $[l,r]$，将 $A_i$ 变成 $A_i+a$。现在可怜想要知道怎么选择区间才能让操作后的序列的最小值尽可能的大，即最大化 $\min\{A_i\}$。
## 输入格式

第一行输入一个整数表示数据组数。

对于每组数据第一行输入四个整数 $n,m,k,a$。

第二行输入 $n$ 个整数描述序列 $A$。

接下来 $m$ 行每行两个整数 $l_i,r_i$ 描述每一个区间。数据保证所有区间两两不同。
## 输出格式

对于每组数据输出一个整数表示操作后序列最小值的最大值。

## 样例

### 样例输入 #1
```
1 
3 3 2 1
1 3 2
1 1
1 3
3 3
```
### 样例输出 #1
```
3
```
## 提示

选择给区间 $[1,1]$ 和 $[1,3]$ 加 $1$。

对于 $100\%$ 的数据，保证 $1\leq\sum n,\sum m\leq 2\times 10^5$，$1\leq T\leq 2\times 10^5$，$1\le k\le m$，$1\le a\le 100$，$1\le A_i\le 10^8$。


---

---
title: "[SDOI2016] 齿轮"
layout: "post"
diff: 提高+/省选-
pid: P4079
tag: ['搜索', '2016', '并查集', '各省省选', '山东', '逆元']
---
# [SDOI2016] 齿轮
## 题目描述

现有一个传动系统，包含了N个组合齿轮和M个链条。每一个链条连接了两个组合齿轮u和v，并提供了一个传动比x: y。即如果只考虑这两个组合齿轮，编号为u的齿轮转动x圈，编号为v的齿轮会转动y圈。传动比为正表示若编号为u的齿轮顺时针转动，则编号为v的齿轮也顺时针转动。传动比为负表示若编号为u的齿轮顺时针转动，则编号为v的齿轮会逆时针转动。若不同链条的传动比不相容，则有些齿轮无法转动。我们希望知道，系统中的这Ｎ个组合齿轮能否同时转动。

## 输入格式

有多组数据。

第一行给定整数Ｔ，表示总的数据组数，之后依次给出Ｔ组数据。

每一组数据的第一行给定整数Ｎ和Ｍ，表示齿轮总数和链条总数。

之后有Ｍ行，依次描述了每一个链条，其中每一行给定四个整数u，v，x和y，表示只考虑这一组联动关系的情况下，编号为u的齿轮转动x圈，编号为v的齿轮会转动y圈。请注意，x为正整数，而y为非零整数，但是y有可能为负数。

## 输出格式

输出T行，对应每一组数据。首先应该输出标识这是第几组数据，参见样例输出。之后输出判定结果，如果N个组合齿轮可以同时正常运行，则输出Yes，否则输出No。

## 样例

### 样例输入 #1
```
2
3 3
1 2 3 5
2 3 5 -7
1 3 3 -7
3 3
1 2 3 5
2 3 5 -7
1 3 3 7
```
### 样例输出 #1
```
Case #1: Yes
Case #2: No
```
## 提示

对于所有数据，T<=32，N<=1000，M<=10000且x与y的绝对值均不超过100。



---

---
title: "[HEOI2016/TJOI2016] 树"
layout: "post"
diff: 提高+/省选-
pid: P4092
tag: ['搜索', '2016', '线段树', '并查集', '各省省选', '河北', '树链剖分', '天津']
---
# [HEOI2016/TJOI2016] 树
## 题目描述

在 2016 年，佳媛姐姐刚刚学习了树，非常开心。现在他想解决这样一个问题：给定一颗有根树，根为 $1$ ，有以下两种操作：

1. 标记操作：对某个结点打上标记。（在最开始，只有结点 $1$ 有标记，其他结点均无标记，而且对于某个结点，可以打多次标记。）

2. 询问操作：询问某个结点最近的一个打了标记的祖先。（这个结点本身也算自己的祖先）

你能帮帮她吗?

## 输入格式

第一行两个正整数 $N$ 和 $Q$ 分别表示节点个数和操作次数。

接下来 $N-1$ 行，每行两个正整数 $u,v \,\, (1 \leqslant u,v \leqslant n)$ 表示 $u$ 到 $v$ 有一条有向边。

接下来 $Q$ 行，形如 `oper num` ，`oper`  为 `C` 时表示这是一个标记操作, `oper` 为 `Q` 时表示这是一个询问操作。
## 输出格式

输出一个正整数，表示结果

## 样例

### 样例输入 #1
```
5 5 
1 2 
1 3 
2 4 
2 5 
Q 2 
C 2 
Q 2 
Q 5 
Q 3
```
### 样例输出 #1
```
1
2
2
1
```
## 提示

$30\%$ 的数据，$1 \leqslant N, Q \leqslant 1000$ ；

$70\%$ 的数据，$1 \leqslant N, Q \leqslant 10000$ ；

$100\%$ 的数据，$1 \leqslant N, Q \leqslant 100000$ 。


---

---
title: "[HEOI2013] Eden 的新背包问题"
layout: "post"
diff: 提高+/省选-
pid: P4095
tag: ['2013', '各省省选', '河北', '枚举', '背包 DP', '进制']
---
# [HEOI2013] Eden 的新背包问题
## 题目背景

“ 寄 没 有 地 址 的 信 ，这 样 的 情 绪 有 种 距 离 ，你 放 着 谁 的 歌 曲 ，是 怎 样 的 心 情 。 能 不 能 说 给 我 听 。”
## 题目描述

失忆的 Eden 总想努力地回忆起过去，然而总是只能清晰地记得那种思念的感觉，却不能回忆起她的音容笑貌。

记忆中，她总是喜欢给 Eden 出谜题：在 valentine's day 的夜晚，两人在闹市中闲逛时，望着礼品店里精巧玲珑的各式玩偶，她突发奇想，问了 Eden 这样的一个问题：有 $n$ 个玩偶，每个玩偶有对应的价值、价钱，每个玩偶都可以被买有限次，在携带的价钱 $m$ 固定的情况下，如何选择买哪些玩偶以及每个玩偶买多少个，才能使得选择的玩偶总价钱不超过 $m$，且价值和最大。

众所周知的，这是一个很经典的多重背包问题，Eden 很快解决了，不过她似乎因为自己的问题被飞快解决感到了一丝不高兴，于是她希望把问题加难：多次询问，每次询问都将给出新的总价钱，并且会去掉某个玩偶（即这个玩偶不能被选择），再问此时的多重背包的答案（即前一段所叙述的问题）。

这下 Eden 犯难了，不过 Eden 不希望自己被难住，你能帮帮他么？
## 输入格式

第一行有一个整数，代表玩偶的个数 $n$，玩偶从 $0$ 开始编号。

第二行开始后面的 $n$ 行，每行三个整数，第 $(i + 2)$ 行的整数  $a_i, b_i, c_i$，分别表示买一个第 $i$ 个玩偶需要的价钱，获得的价值以及第 $i$ 个玩偶的限购次数。

接下来的一行有一个整数 $q$，表示询问次数。

接下来 $q$ 行，每行两个整数 $d_i, e_i$，表示每个询问去掉的是哪个玩偶（注意玩偶从 $0$ 开始编号）以及该询问对应的新的总价钱数。（去掉操作不保留，即不同询问互相独立）。
## 输出格式

输出 $q$ 行，第 $i$ 行输出对于第 $i$ 个询问的答案。
## 样例

### 样例输入 #1
```
5 
2 3 4 
1 2 1 
4 1 2 
2 1 1 
3 2 3 
5 
1 10 
2 7 
3 4 
4 8 
0 5
```
### 样例输出 #1
```
13 
11 
6 
12 
4 

```
## 提示

#### 样例解释

一共五种玩偶，分别的价钱价值和限购次数为 $(2,3,4)$， $(1,2,1)$， $(4,1,2)$， $(2,1,1)$， $(3,2,3)$。

五个询问，以第一个询问为例。

第一个询问表示的是去掉编号为 $1$ 的玩偶， 且拥有的钱数为 $10$ 时可以获得的最大价值，则此时剩余玩偶为 $(2,3,4$)，$(4,1,2)$， $(2,1,1)$，$(3,2,3)$，若把编号为 $0$ 的玩偶买 $4$ 个（即全买了），然后编号为 $3$ 的玩偶 买一个，则刚好把 $10$ 元全部花完，且总价值为 $13$。可以证明没有更优的方案了。

注意买某种玩偶不一定要买光。

---

#### 数据规模与约定

- 对于 $10\%$ 的数据，保证 $n \leq 10$。
- 另外存在 $20\%$ 的数据，保证  $n \leq 100$，$c_i = 1$，$q \leq 100$。
- 另外存在 $20\%$ 的数据，保证 $n \leq 100$，$q \leq 100$。
- 另外存在 $30\%$ 的数据，保证 $c_i = 1$。
- 对于 $100\%$ 的数据，保证  $1 \leq n \leq 1000$，$1 \leq q \leq 3\times 10^5$， $1 \leq a_i,b_i,c_i \leq 100$，$0 \leq d_i < n$，$0 \leq e_i \leq 1000$。




---

---
title: "[HEOI2013] Eden 的博弈树"
layout: "post"
diff: 提高+/省选-
pid: P4096
tag: ['动态规划 DP', '博弈论', '2013', '各省省选', '河北', '博弈树']
---
# [HEOI2013] Eden 的博弈树
## 题目描述

对于有两个玩家的，状态透明且状态转移确定的博弈游戏，博弈树是常用的分析工具。博弈树是一棵有根树，其中的节点为游戏的状态。若节点 B 的父亲是 A，则说明状态 A 能通过一次决策转移到状态 B。每个状态都有一个唯一的决策方，即这个状态下应该由哪一方做出决策。我们规定双方在任何时候都是轮流做出决策的，即树上相邻节点的决策方总是不相同的。

在这个问题中，我们只关心两个玩家的胜负情况，且规定游戏不会出现平局。

我们称两个玩家分别为黑方和白方，其中根节点的决策方为黑方。显然每个节点只有两个状态：黑方胜和白方胜。若某内节点（即存在后继节点的节点）的决策方为黑方，则该节点为黑方胜的充要条件为它的儿子中存在黑方胜的节点，反之亦然。求解博弈树即为判明博弈树根节点的状态。

如果我们得知了所有叶节点（即无后继节点的节点）的状态，那么博弈树就很容易求解了。但是现在的情况是所有叶节点的状态均为未知的，需要进一步的计算。对于一个由叶节点构成的集合 $S$，如果 $S$ 中的节点均被判明为黑方胜，就可以断言根节点为黑方胜的话，则称 $S$ 为一个黑方胜集合。对于黑方胜集合 $S$， 如果对于任意的黑方胜集合 $S'$ 均满足 $|S| \le |S'|$（$|S|$ 表示集合 $S$ 中的元素数目）， 则称 $S$ 为一个最小黑方胜集合。同样地，也可以定义白方胜集合和最小白方胜集合。

Eden 最近在研究博弈树问题。他发现，如果一个叶节点既属于某一个最小黑方胜集合，又属于一个最小白方胜集合，那么求解这个节点的状态显然最有益于求解根节点的状态。像这样的叶节点就称之为关键叶节点。对于一棵给定的博弈树，Eden 想要知道哪些叶节点是关键叶节点。

## 输入格式

每个测试点包含一组测试数据。

测试数据的第一行包含一个正整数 $n$，表示博弈树的节点数目。节点从 $1$ 到 $n$ 编号，且 $1$ 号节点为根节点。

之后 $n - 1$ 行，每行包含一个正整数。第 $i$ 行的正整数表示节点 $i$ 的父节点的编号。

## 输出格式

在一行内输出三个空格分隔的正整数，分别是编号最小的关键叶节点的编号，关键叶节点的数目和所有关键叶节点的编号的异或和。

## 样例

### 样例输入 #1
```
7 
1 
1 
2 
2 
3 
3
```
### 样例输出 #1
```
4 4 0 

```
## 提示

【样例说明】

  ![](https://cdn.luogu.com.cn/upload/pic/13130.png) 

如图所示，黑色节点表示决策方为黑方的节点，反之亦然

所有的最小黑方胜集合为 $\{4, 5\}$ 和 $\{6, 7\}$。

所有的最小白方胜集合为 $\{4, 6\}$，$\{4, 7\}$，$\{5, 6\}$ 和 $\{5, 7\}$。

所以关键叶节点的集合为 $\{4, 5, 6, 7\}$。

- 对于 $30\%$ 的数据，$n \le 100$；
- 对于 $40\%$ 的数据，$n \le 1000$；
- 对于 $50\%$ 的数据，$n \le 10 ^ 4$，且树是随机生成的；
- 对于 $100\%$ 的数据，$1 \le n \le 2\times 10 ^ 5$，且对于节点 $i$（$i \ne 1$），其父节点的编号小于 $i$。



---

---
title: "[HEOI2014] 人人尽说江南好"
layout: "post"
diff: 提高+/省选-
pid: P4101
tag: ['博弈论', '2014', '各省省选', '河北']
---
# [HEOI2014] 人人尽说江南好
## 题目描述

小 Z 是一个不折不扣的 ZRP（Zealot Round-game Player，回合制游戏狂热玩家），最近他想起了小时候在江南玩过的一个游戏。

在过去，人们是要边玩游戏边填词的，比如这首《菩萨蛮》就是当年韦庄在玩游戏时填的：人 人 尽 说 江 南 好， 游 人 只 合 江 南 老。

然而我们今天不太关心人们填的词是什么，我们只关心小 Z 那时玩过的游戏。游戏的规则是这样的，给定 $n$ 堆石子，每堆石子一开始只有 $1$ 个。小 Z 和他的小伙伴轮流操作，小 Z 先行操作。操作可以将任意两堆石子合并成为一堆，当谁不再能操作的时候，谁就输掉了。

不过，当一堆石子堆的太高时可能发生危险，因此小 Z 和他的小伙伴规定，任何时刻任意一堆石子的数量不能超过 $m$。即假如现在有两堆石子分别有 $a$ 个和 $b$ 个，而且 $a + b > m$，那么这两堆石子就不能合成一堆。

小 Z 和他的小伙伴都是很聪明的，所以他们总是会选择对自己最有利的策略。现在小 Z 想要知道，在这种情况下，对于一个给定的 $n$ 和 $m$，到底是谁能够获得胜利呢？

## 输入格式

本题包括多组数据  数据第一行为一个数 $T$，为数据组数。

以下 $T$ 行，每行两个正整数 $n,m$。

## 输出格式

输出 $T$ 行，每行为 $0$ 或 $1$，如果为 $0$ 意为小 Z（即先手）会取得胜利，为 $1$ 则为后手会取得胜利。

## 样例

### 样例输入 #1
```
5
7 3
1 5
4 3
6 1
2 2
```
### 样例输出 #1
```
1
1
1
1
0
```
## 提示

对于 $10 \%$ 的数据，$m \ge n$；  
对于 $20 \%$ 的数据，$n, m \le 10$；  
对于 $30 \%$ 的数据，$n, m \le 50$，$2 \cdot m \ge n$；  
对于 $50 \%$ 的数据，$n, m \le 100$；  
对于 $70 \%$ 的数据，$n, m \le {10}^6$；  
对于 $100 \%$ 的数据，$1 \le n, m \le {10}^9$，$1 \le T \le 100$。



---

---
title: "[HEOI2014] 南园满地堆轻絮"
layout: "post"
diff: 提高+/省选-
pid: P4105
tag: ['模拟', '贪心', '2014', '二分', '各省省选', '河北']
---
# [HEOI2014] 南园满地堆轻絮
## 题目描述

小 Z 是 ZRP（Zombies’ Republic of Poetry，僵尸诗歌共和国）的一名诗歌爱好者，最近 他研究起了诗词音律的问题。

在过去，诗词是需要编成曲子唱出来的，比如下面这首《菩萨蛮》，唱出来的话其对应的音符就是这样的：

```cpp
 南  园  满 地 堆 轻 絮， 愁 闻 一 霎 清 明 雨   
 1   1  5 5 6 6 5  4 4 3 3 2 2 1  
```
因而可以发现，`1 1 5 5 6 6 5 4 4 3 3 2 2 1`这串音符就成为了研究音律的关键。

小 Z 翻阅了众多史料发现，过去的一首曲子的音调是不下降的。 小 Z 想要知道对于一首给定的曲子，如何通过提高音调或者降低音调，将它的音调修改的不下降，而且使得修改幅度最大的那个音符的修改幅度尽量小。即如果把一个包含 $n$ 个音 符的曲子看做是一个正整数数列 $A[1] \cdots A[n]$，那么目标是求另一个正整数数列 $B[1]…B[n]$， 使得对于任意的 $1≤i<n$ 有 $B[i] ≤B[i+1]$，而且使得 $Ans = Max\{|A[j]-B[j]|,1≤j≤n\}$尽量 小。
小 Z 很快就想清楚了做法，但是鉴于他还忙着写诗，所以这个任务就交给了你。

## 输入格式

由于数据规模可能较大，因此采用如下方式生成数据。

每个数据包含 7 个数：$n,S_a,S_b,S_c,S_d,A[1],Mod$，即共有 n 个音符，第一个音符为 A[1]。

生成规则如下： 定义生成函数 $F(x) = S_a*x^3 + S_b*x^2 + S_c*x + S_d$; 那么给出递推公式 $A[i] =( F(A[i-1]) + F(A[i-2]) )\%mod$，此处规定 $A[0] = 0$. 由于中间过程的数可能会特别大，所以要求每一步与 $A$ 中的每个数都对一个给定的数 $Mod$ 取模。

## 输出格式

输出一行，包含一个正整数 $Ans$。

## 样例

### 样例输入 #1
```
3 815 6901 3839 178 199 10007 
```
### 样例输出 #1
```
1334
```
## 提示

【数据范围】

对于 10% 的数据， $n≤3$

对于 20% 的数据,  $n≤10$

对于 30% 的数据,  $n≤100$

对于 50% 的数据,  $n≤1000$

对于 70% 的数据,  $n≤100000$

对于 100% 的数据, $n≤5000000$，$S_a,S_b,S_c,S_d,A[1] ≤10000$，$ Mod≤1000000007 $

【友情提示】

样例中生成的数列为：  199 4568 1901，此时将 4568 修改为 3234,1901 也修改为 3234 即可，代价为 1334。



---

---
title: "[HEOI2015] 定价"
layout: "post"
diff: 提高+/省选-
pid: P4109
tag: ['2015', '各省省选', '河北', '枚举', '分块']
---
# [HEOI2015] 定价
## 题目描述

在市场上有很多商品的定价类似于 999 元、4999 元、8999 元这样。它们和 1000 元、5000 元和 9000 元并没有什么本质区别，但是在心理学上会让人感觉便宜很多，因此也是商家常用的价格策略。不过在你看来，这种价格十分荒谬。于是你如此计算一个价格 $p$（$p$ 为正整数）的荒谬程度：

1. 首先将 $p$ 看做一个由数字组成的字符串（不带前导 $0$）；
2. 然后，如果 $p$ 的最后一个字符是 $0$，就去掉它。重复这一过程，直到 $p$ 的最后一个字符不是 $0$；
3. 记 $p$ 的长度为 $a$，如果此时 $p$ 的最后一位是 $5$，则荒谬程度为 $2a - 1$；否则为 $2a$。

例如，$850$ 的荒谬程度为 $3$，而 $880$ 则为 $4$，$9999$ 的荒谬程度为 $8$。

现在，你要出售一样闲置物品，你能接受的定价在 $[L, R]$ 范围内，你想要给出一个荒谬度最低的价格。
## 输入格式

输入文件的第一行包含一个正整数 $T$，表示测试数据的数目。

每个测试数据占单独的一行，包含两个空格分隔的正整数 $L, R$，表示定价的区间。
## 输出格式

对于每个测试数据，在单独的一行内输出结果。如果荒谬度最低的价格不唯一，输出最小的那个。
## 样例

### 样例输入 #1
```
3
998 1002
998 2002
4000 6000
```
### 样例输出 #1
```
1000
1000
5000
```
## 提示

- 对于 $20\%$ 的数据，$L, R \leq 2000$；
- 对于 $100\%$ 的数据，$T \leq 100$，$1 \leq L \leq R \leq 10^9$。


---

---
title: "[HEOI2012] 采花"
layout: "post"
diff: 提高+/省选-
pid: P4113
tag: ['2012', '各省省选', '树状数组', '河北', '排序', '可持久化线段树', '前缀和']
---
# [HEOI2012] 采花
## 题目描述

萧薰儿是古国的公主，平时的一大爱好是采花。

今天天气晴朗，阳光明媚，公主清晨便去了皇宫中新建的花园采花。

花园足够大，容纳了 $n$ 朵花，共有 $c$ 种颜色，用整数 $1 \sim c$ 表示。且花是排成一排的，以便于公主采花。公主每次采花后会统计采到的花的颜色数，颜色数越多她会越高兴。同时，她有一癖好，她不允许最后自己采到的花中，某一颜色的花只有一朵。为此，公主每采一朵花，要么此前已采到此颜色的花，要么有相当正确的直觉告诉她，她必能再次采到此颜色的花。

由于时间关系，公主只能走过花园连续的一段进行采花，便让女仆福涵洁安排行程。福涵洁综合各种因素拟定了 $m$ 个行程，然后一一向你询问公主能采到的花共有几种不同的颜色。
## 输入格式

输入的第一行是三个用空格隔开的整数，分别代表花的个数 $n$，花的颜色数 $c$，以及行程数 $m$。

输入的第二行是 $n$ 个用空格隔开的整数，第 $i$ 个整数代表第 $i$ 朵花的颜色 $x_i$。

第 $3$ 行到第 $(m + 2)$ 行，每行两个整数 $l, r$，第 $(i + 2)$ 行的数字代表第 $i$ 次行程为第 $l$ 到第 $r$ 朵花。
## 输出格式

共输出 $m$ 行，每行一个整数。第 $i$ 行的整数代表第 $i$ 次行程公主能采到的花共有几种不同的颜色。
## 样例

### 样例输入 #1
```
5 3 5
1 2 2 3 1
1 5
1 2
2 2
2 3
3 5
```
### 样例输出 #1
```
2
0
0
1
0

```
## 提示

#### 输入输出样例 $1$ 解释

共有五朵花，颜色分别为 $1,~2,~2,~3,~1$。

对于第一次行程，公主采花的区间为 $[1, 5]$，可以采位置 $1,~2,~3,~5$ 处的花，共有 $1$ 和 $2$ 两种不同的颜色。

对于第二次行程，公主采花的区间为 $[1, 2]$，但是颜色为 $1$ 和 $2$ 的花都只出现了一次，因此公主无花可采。

对于第三次行程，公主采花的区间为 $[2, 2]$，但是颜色为 $2$ 的花只出现了一次，公主无花可采。

对于第四次行程，公主采花的区间为 $[2, 3]$，可以采 $2,~3$ 位置的花，只有 $2$ 这一种颜色。

对于第五次行程，公主采花的区间为 $[3,5]$，但是颜色为 $1, 2, 3$ 的花都只出现了一次，因此公主无花可采。

#### 数据范围与约定

**本题采用多测试点捆绑测试，共有两个子任务**。

对于子任务 $1$，分值为 $100$ 分，保证 $1 \leq n, c, m \leq 3 \times 10^5$。

对于子任务 $2$，分值为 $100$ 分，保证 $1 \leq n, c, m \leq 2 \times 10^6$。

对于全部的测试点，保证 $1 \leq x_i \leq c$，$1 \leq l \leq r \leq n$。


---

---
title: "[CQOI2016] 手机号码"
layout: "post"
diff: 提高+/省选-
pid: P4124
tag: ['动态规划 DP', '2016', '重庆', '各省省选', '数位 DP']
---
# [CQOI2016] 手机号码
## 题目描述

人们选择手机号码时都希望号码好记、吉利。比如号码中含有几位相邻的相同数字、不含谐音不吉利的数字等。手机运营商在发行新号码时也会考虑这些因素，从号段中选取含有某些特征的号码单独出售。为了便于前期规划，运营商希望开发一个工具来自动统计号段中满足特征的号码数量。

工具需要检测的号码特征有两个：号码中要出现至少 $3$ 个相邻的相同数字；号码中不能同时出现 $8$ 和 $4$。号码必须同时包含两个特征才满足条件。满足条件的号码例如：13000988721、23333333333、14444101000。而不满足条件的号码例如：1015400080、10010012022。

手机号码一定是 $11$ 位数，且不含前导的 $0$。工具接收两个数 $L$ 和 $R$，自动统计出 $[L,R]$ 区间内所有满足条件的号码数量。$L$ 和 $R$ 也是 $11$ 位的手机号码。
## 输入格式

输入文件内容只有一行，为空格分隔的 $2$ 个正整数 $L,R$。
## 输出格式

输出文件内容只有一行，为 $1$ 个整数，表示满足条件的手机号数量。
## 样例

### 样例输入 #1
```
12121284000 12121285550
```
### 样例输出 #1
```
5
```
## 提示

样例解释：满足条件的号码： 12121285000、 12121285111、 12121285222、 12121285333、 12121285550。

数据范围：$10^{10}\leq L\leq R<10^{11}$。


---

---
title: "[AHOI2009] 同类分布"
layout: "post"
diff: 提高+/省选-
pid: P4127
tag: ['动态规划 DP', '搜索', '递推', '2009', '各省省选', '安徽', '枚举', '数位 DP']
---
# [AHOI2009] 同类分布
## 题目描述

给出两个数$a,b$，求出$[a,b]$中各位数字之和能整除原数的数的个数。

## 输入格式

一行，两个整数$a$和$b$

## 输出格式

一个整数，表示答案

## 样例

### 样例输入 #1
```
10 19
```
### 样例输出 #1
```
3
```
## 提示

对于所有的数据，$1 ≤ a ≤ b ≤ 10^{18}$



---

---
title: "[BJOI2012] 算不出的等式"
layout: "post"
diff: 提高+/省选-
pid: P4132
tag: ['2012', '各省省选', '北京', 'O2优化']
---
# [BJOI2012] 算不出的等式
## 题目背景

曾经有一个老掉牙的游戏放在我面前，我没有珍惜。直到这个游戏停产才追悔莫及。人世间最痛苦的事情莫过于此，如果上天给我一个再玩一次的机会，我一定要，通关！

## 题目描述

如果你真的很想玩这个游戏，那么就先看看我的题目吧，搞不定这些的话是没办法通关的哟。第一关其实很简单，只有一个关闭的有密码锁的大门。这大门上写着一个奇怪的算式，估计是要你利用它算出密码来开门吧（果然是老掉牙的情节）。

传说中这个式子中的p和q是两个奇质数，等号右边算出来应该就是密码了吧，你是真的算不出来么？

$\sum_{k=1}^{\frac{p-1}{2}} \biggl\lfloor\frac{kq}{p}\biggr\rfloor+\sum_{k=1}^{\frac{q-1}{2}} \biggl\lfloor\frac{kp}{q}\biggr\rfloor$

## 输入格式

只有一行，两个奇质数，分别表示p,q。

## 输出格式

一个数,表示算式结果。

## 样例

### 样例输入 #1
```
5 7
```
### 样例输出 #1
```
6
```
## 提示

$p,q<2^{32}$



---

---
title: "[BJOI2012] 最多的方案"
layout: "post"
diff: 提高+/省选-
pid: P4133
tag: ['贪心', '递推', '2012', '各省省选', '北京', 'O2优化', '枚举', '斐波那契数列']
---
# [BJOI2012] 最多的方案
## 题目描述

第二关和很出名的斐波那契数列有关，地球上的 OIer 都知道：  
$$F_n = \begin{cases} 1 & (n \le 2) \\ F_{n-1}+F_{n-2} & (n \ge 3) \end{cases}$$ 
每一项都可以称为斐波那契数。  

现在给一个正整数 $n$，它可以写成一些斐波那契数的和的形式。如果我们要求不同的方案中不能有相同的斐波那契数，那么对一个 $n$ 最多可以写出多少种方案呢？

## 输入格式

只有一个整数 $n$。

## 输出格式

一个整数表示方案数。
## 样例

### 样例输入 #1
```
16
```
### 样例输出 #1
```
4
```
## 提示

Hint：16=3+13=3+5+8=1+2+13=1+2+5+8

【数据范围】   
对于 $30\%$ 的数据，$n \le 256$；  
对于 $100\%$ 的数据，$n \le 10^{18}$。



---

---
title: "[SCOI2006] 整数划分"
layout: "post"
diff: 提高+/省选-
pid: P4157
tag: ['高精度', '2006', '四川', '各省省选', '枚举', '快速傅里叶变换 FFT']
---
# [SCOI2006] 整数划分
## 题目描述

从文件中读入一个正整数 $n$（$10 \le n \le 31000$）。要求将 $n$ 写成若干个正整数之和，并且使这些正整数的乘积最大。

例如，$n=13$，则当 $n$ 表示为 $4+3+3+3$（或 $2+2+3+3+3$）时，乘积 $=108$ 为最大。
## 输入格式

一行一个正整数 $n$。
## 输出格式

第 $1$ 行输出一个整数，为最大乘积的位数。

第 $2$ 行输出最大乘积的前 $100$ 位，如果不足 $100$ 位，则按实际位数输出最大乘积。

## 样例

### 样例输入 #1
```
13
```
### 样例输出 #1
```
3
108

```
## 提示

### 数据范围及约定

对于全部数据，$10 \le n \le 31000$，同时保证最大乘积的位数不超过 $5000$ 位。


---

---
title: "[SCOI2009] 粉刷匠"
layout: "post"
diff: 提高+/省选-
pid: P4158
tag: ['动态规划 DP', '递推', '2009', '四川', '各省省选', '枚举', '背包 DP']
---
# [SCOI2009] 粉刷匠
## 题目描述

windy 有 $N$ 条木板需要被粉刷。 每条木板被分为 $M$ 个格子。 每个格子要被刷成红色或蓝色。

windy 每次粉刷，只能选择一条木板上一段连续的格子，然后涂上一种颜色。 每个格子最多只能被粉刷一次。

如果 windy 只能粉刷 $T$ 次，他最多能正确粉刷多少格子？

一个格子如果未被粉刷或者被粉刷错颜色，就算错误粉刷。


## 输入格式

第一行包含三个整数，$N,M,T$。

接下来有 $N$ 行，每行一个长度为 $M$ 的字符串，``0`` 表示红色，`1` 表示蓝色。

## 输出格式

包含一个整数，最多能正确粉刷的格子数。

## 样例

### 样例输入 #1
```
3 6 3
111111
000000
001100
```
### 样例输出 #1
```
16
```
## 提示

$30\%$ 的数据，满足 $1 \le N,M \le 10,0 \le T \le 100$ 。

$100\%$ 的数据，满足 $1 \le N,M \le 50,0 \le T \le 2500$ 


---

---
title: "[SCOI2009] 迷路"
layout: "post"
diff: 提高+/省选-
pid: P4159
tag: ['2009', '四川', '各省省选', '矩阵加速', '矩阵乘法']
---
# [SCOI2009] 迷路
## 题目背景

windy 在有向图中迷路了。
## 题目描述

该有向图有 $n$ 个节点，节点从 $1$ 至 $n$ 编号，windy 从节点 $1$ 出发，他必须恰好在 $t$ 时刻到达节点 $n$。

现在给出该有向图，你能告诉 windy 总共有多少种不同的路径吗？ 

答案对 $2009$ 取模。

注意：windy 不能在某个节点逗留，且通过某有向边的时间严格为给定的时间。



## 输入格式

第一行包含两个整数，分别代表 $n$ 和 $t$。

第 $2$ 到第 $(n + 1)$ 行，每行一个长度为 $n$ 的字符串，第 $(i + 1)$ 行的第 $j$ 个字符 $c_{i, j}$ 是一个数字字符，若为 $0$，则代表节点 $i$ 到节点 $j$ 无边，否则代表节点 $i$ 到节点 $j$ 的边的长度为 $c_{i, j}$。
## 输出格式

输出一行一个整数代表答案对 $2009$ 取模的结果。
## 样例

### 样例输入 #1
```
2 2
11
00
```
### 样例输出 #1
```
1


```
### 样例输入 #2
```
5 30
12045
07105
47805
12024
12345

```
### 样例输出 #2
```
852
```
## 提示

#### 样例输入输出 1 解释

路径为 $1 \to 1 \to 2$。

#### 数据规模与约定

- 对于 $30\%$ 的数据，保证 $n \leq 5$，$t \leq 30$。
- 对于 $100\%$ 的数据，保证 $2 \leq n \leq 10$，$1 \leq t \leq 10^9$。


---

---
title: "[SCOI2009] 生日快乐"
layout: "post"
diff: 提高+/省选-
pid: P4160
tag: ['动态规划 DP', '搜索', '2009', '四川', '各省省选', '深度优先搜索 DFS', '最大公约数 gcd']
---
# [SCOI2009] 生日快乐
## 题目描述

windy 的生日到了，为了庆祝生日，他的朋友们帮他买了一个边长分别为 $X$ 和 $Y$ 的矩形蛋糕。

现在包括 windy，一共有 $N$ 个人来分这块大蛋糕，要求每个人必须获得相同面积的蛋糕。

windy 主刀，每一切只能平行于一块蛋糕的一边（任意一边），并且必须把这块蛋糕切成两块。

这样，要切成 $N$ 块蛋糕，windy 必须切 $N-1$ 次。

为了使得每块蛋糕看起来漂亮，我们要求 $N$ 块蛋糕的长边与短边的比值的最大值最小。

你能帮助 windy 求出这个比值么？

## 输入格式

一行三个整数 $X,Y,N$。

## 输出格式

一行一个浮点数，保留 $6$ 位小数。

## 样例

### 样例输入 #1
```
5 5 5
```
### 样例输出 #1
```
1.800000
```
## 提示

对于 $100\%$ 的数据，满足 $1 \le X,Y \le 10^4$，$1\le N\le 10$。



---

---
title: "[SCOI2009] 游戏"
layout: "post"
diff: 提高+/省选-
pid: P4161
tag: ['2009', '四川', '各省省选']
---
# [SCOI2009] 游戏
## 题目描述

windy 学会了一种游戏。

对于 $1$ 到 $N$ 这 $N$ 个数字，都有唯一且不同的 $1$ 到 $N$ 的数字与之对应。

最开始 windy 把数字按顺序 $1,2,3,\cdots,N$ 写一排在纸上。

然后再在这一排下面写上它们对应的数字。

然后又在新的一排下面写上它们对应的数字。

如此反复，直到序列再次变为 $1,2,3,\cdots,N$。

如：$1\ 2\ 3\ 4\ 5\ 6$

对应的关系为：$1\to 2$，$2\to 3$，$3\to 1$，$4\to 5$，$5\to 4$，$6\to 6$。

windy 的操作如下：

`1 2 3 4 5 6`

`2 3 1 5 4 6`

`3 1 2 4 5 6`

`1 2 3 5 4 6`

`2 3 1 4 5 6`

`3 1 2 5 4 6`

`1 2 3 4 5 6`

这时，我们就有若干排 $1$ 到 $N$ 的排列，上例中有 $7$ 排。

现在 windy 想知道，对于所有可能的对应关系，有多少种可能的排数。
## 输入格式

一个整数，N。

## 输出格式

一个整数，可能的排数。

## 样例

### 样例输入 #1
```
3
```
### 样例输出 #1
```
3
```
### 样例输入 #2
```
10
```
### 样例输出 #2
```
16
```
## 提示

$30\%$ 的数据，满足 $1 \le n\le 10$。

$100\%$ 的数据，满足 $1 \le n\le 1000$。


---

---
title: "[SCOI2009] 最长距离"
layout: "post"
diff: 提高+/省选-
pid: P4162
tag: ['2009', '四川', '各省省选', '剪枝', '最短路']
---
# [SCOI2009] 最长距离
## 题目描述

windy 有一块矩形土地，被分为 $N\times M$ 块 $1\times 1$ 的小格子。 有的格子含有障碍物。 如果从格子 A 可以走到格子 B，那么两个格子的距离就为两个格子中心的欧几里德距离。 如果从格子 A 不可以走到格子 B，就没有距离。如果格子 X 和格子 Y 有公共边，并且 X 和 Y 均不含有障碍物，就可以从 X 走到 Y。 如果 windy 可以移走 $T$ 块障碍物，求所有格子间的最大距离。保证移走 $T$ 块障碍物以后，至少有一个格子不含有障碍物。

## 输入格式

第一行包含三个整数，$N,M,T$。 接下来有 $N$ 行，每行一个长度为 $M$ 的字符串，`0` 表示空格子，`1` 表示该格子含有障碍物。

## 输出格式

包含一个浮点数，保留 $6$ 位小数。

## 样例

### 样例输入 #1
```
3 3 0
001
001
110
```
### 样例输出 #1
```
1.414214
```
### 样例输入 #2
```
4 3 0
001
001
011
000
```
### 样例输出 #2
```
3.605551
```
### 样例输入 #3
```
3 3 1
001
001
001

Sample Output
```
### 样例输出 #3
```
2.828427
```
## 提示

- $20\%$ 的数据，满足  $1 \le N,M \le 30 $，$ 0 \le T \le 0 $。
- $40\%$ 的数据，满足  $1 \le N,M \le 30 $，$ 0 \le T \le 2 $。
- $100\%$ 的数据，满足 $1 \le N,M \le 30 $，$ 0 \le T \le 30$。



---

---
title: "[SCOI2007] 排列"
layout: "post"
diff: 提高+/省选-
pid: P4163
tag: ['搜索', '2007', '四川', '各省省选', '剪枝', '排列组合', '状压 DP']
---
# [SCOI2007] 排列
## 题目描述

给一个数字串 $s$ 和正整数 $d$, 统计 $s$ 有多少种不同的排列能被 $d$ 整除（可以有前导 $0$）。例如 $123434$ 有 $90$ 种排列能被 $2$ 整除，其中末位为 $2$ 的有 $30$ 种，末位为 $4$ 的有  $60$ 种。
## 输入格式

输入第一行是一个整数 $T$，表示测试数据的个数，以下每行一组 $s$ 和 $d$，中间用空格隔开。$s$ 保证只包含数字 $0,1,2,3,4,5,6,7,8,9$。
## 输出格式

每个数据仅一行，表示能被 $d$ 整除的排列的个数。
## 样例

### 样例输入 #1
```
7
000 1
001 1
1234567890 1
123434 2
1234 7
12345 17
12345678 29
```
### 样例输出 #1
```
1
3
3628800
90
3
6
1398

```
## 提示

$100\%$ 的数据满足：$s$ 的长度不超过 $10$，$1\le d\le 1000$，$1\le T\le 15$。

在前三个例子中，排列分别有 $1,3,3628800$ 种，它们都是 $1$ 的倍数。


---

---
title: "[CQOI2007] 涂色"
layout: "post"
diff: 提高+/省选-
pid: P4170
tag: ['字符串', '2007', '重庆', '各省省选', '枚举', '区间 DP']
---
# [CQOI2007] 涂色
## 题目描述

假设你有一条长度为 $5$ 的木板，初始时没有涂过任何颜色。你希望把它的 $5$ 个单位长度分别涂上红、绿、蓝、绿、红色，用一个长度为 $5$ 的字符串表示这个目标：$\texttt{RGBGR}$。

每次你可以把一段连续的木板涂成一个给定的颜色，后涂的颜色覆盖先涂的颜色。例如第一次把木板涂成 $\texttt{RRRRR}$，第二次涂成 $\texttt{RGGGR}$，第三次涂成 $\texttt{RGBGR}$，达到目标。

用尽量少的涂色次数达到目标。

## 输入格式

输入仅一行，包含一个长度为 $n$ 的字符串，即涂色目标。字符串中的每个字符都是一个大写字母，不同的字母代表不同颜色，相同的字母代表相同颜色。

## 输出格式

仅一行，包含一个数，即最少的涂色次数。

## 样例

### 样例输入 #1
```
AAAAA
```
### 样例输出 #1
```
1
```
### 样例输入 #2
```
RGBGR
```
### 样例输出 #2
```
3
```
## 提示

$40\%$ 的数据满足 $1\le n\le 10$。

$100\%$ 的数据满足 $1\le n\le 50$。




---

---
title: "[JSOI2010] 满汉全席"
layout: "post"
diff: 提高+/省选-
pid: P4171
tag: ['2010', '各省省选', '江苏', '图论建模', '2-SAT']
---
# [JSOI2010] 满汉全席
## 题目描述

满汉全席是中国最丰盛的宴客菜肴，有许多种不同的材料透过满族或是汉族的料理方式，呈现在数量繁多的菜色之中。由于菜色众多而繁杂，只有极少数博学多闻技艺高超的厨师能够做出满汉全席，而能够烹饪出经过专家认证的满汉全席，也是中国厨师最大的荣誉之一。世界满汉全席协会是由能够料理满汉全席的专家厨师们所组成，而他们之间还细分为许多不同等级的厨师。

为了招收新进的厨师进入世界满汉全席协会，将于近日举办满汉全席大赛，协会派遣许多会员当作评审员，为的就是要在参赛的厨师之中，找到满汉界的明日之星。

大会的规则如下：每位参赛的选手可以得到 $n$ 种材料，选手可以自由选择用满式或是汉式料理将材料当成菜肴。

大会的评审制度是：共有 $m$ 位评审员分别把关。每一位评审员对于满汉全席有各自独特的见解，但基本见解是，要有两样菜色作为满汉全席的标志。如某评审认为，如果没有汉式东坡肉跟满式的涮羊肉锅，就不能算是满汉全席。但避免过于有主见的审核，大会规定一个评审员除非是在认为必备的两样菜色都没有做出来的状况下，才能淘汰一位选手，否则不能淘汰一位选手。

换句话说，只要参赛者能在这两种材料的做法中，其中一个符合评审的喜好即可通过该评审的审查。如材料有猪肉，羊肉和牛肉时，有四位评审员的喜好如下表： 

```
评审一 评审二 评审三 评审四 
满式牛肉 满式猪肉 汉式牛肉 汉式牛肉 
汉式猪肉 满式羊肉 汉式猪肉 满式羊肉 
```

如参赛者甲做出满式猪肉，满式羊肉和满式牛肉料理，他将无法满足评审三的要求，无法通过评审。而参赛者乙做出汉式猪肉，满式羊肉和满式牛肉料理，就可以满足所有评审的要求。

但大会后来发现，在这样的制度下如果材料选择跟派出的评审员没有特别安排好的话，所有的参赛者最多只能通过部分评审员的审查而不是全部，所以可能会发生没有人通过考核的情形。

如有四个评审员喜好如下表时，则不论参赛者采取什么样的做法，都不可能通过所有评审的考核： 

```
评审一 评审二 评审三 评审四 
满式羊肉 满式猪肉 汉式羊肉 汉式羊肉 
汉式猪肉 满式羊肉 汉式猪肉 满式猪肉 
```

所以大会希望有人能写一个程序来判断，所选出的 $m$ 位评审，会不会发生没有人能通过考核的窘境，以便协会组织合适的评审团。
## 输入格式

第一行包含一个数字 $K$（$1\le K \le 50$），代表测试文件包含了 $K$ 组数据。

每一组测试数据的第一行包含两个数字 $n$ 跟 $m$（$n≤100$，$m≤1000$），代表有 $n$ 种材料，$m$ 位评审员。

为方便起见，舍弃做法的中文名称而给予编号，编号分别从 $1$ 到 $n$。

接下来的 $m$ 行，每行都代表对应的评审员所拥有的两个喜好，每个喜好由一个英文字母跟一个数字代表，如 $m1$ 代表这个评审喜欢第 $1$ 个材料透过满式料理做出来的菜，而 $h2$ 代表这个评审员喜欢第 $2$ 个材料透过汉式料理做出来的菜。
## 输出格式

每组测试数据输出一行，如果不会发生没有人能通过考核的窘境，输出 ```GOOD```；否则输出 ```BAD```（均为大写字母）。
## 样例

### 样例输入 #1
```
2
3 4
m3 h1
m1 m2
h1 h3
h3 m2
2 4
h1 m2
m2 m1
h1 h2
m1 h2
```
### 样例输出 #1
```
GOOD
BAD
```


---

---
title: "[CQOI2012] 编号"
layout: "post"
diff: 提高+/省选-
pid: P4222
tag: ['2012', '重庆', '各省省选', 'O2优化']
---
# [CQOI2012] 编号
## 题目描述

你需要给一批商品编号，其中每个编号都是一个 $7$ 位 $16$ 进制
数（由 $0$ 至 $9$, $a$ 至 $f$ 组成）。

为了防止在人工处理时不小心把编号弄错，要求任意两个编号至少有三个位置对应的数字不相同。

第一个编号为 $0000000$，第二个编号为不违反上述规定的前提下最小的编号，…，每次分配一个新编号时，总是选择不和前面编号冲突的最小编号（注意到编号都是 $16$ 进制数，可以比较大小）。

按此规律，前面若干编号分别是：

$$0000000,0000111,0000222,…,0000fff,0001012,0001103,0001230,00
01321,0001456,…$$

输入 $k$，你的任务是求出第 $k$ 小的编号。
## 输入格式

一行一个数，为整数 $k$。
## 输出格式

输出第 $k$ 小的编号（字母均为小写）。输入保证这个编号存在。
## 样例

### 样例输入 #1
```
20
```
### 样例输出 #1
```
0001321
```
## 提示

对于 15% 的数据，$k \leq 200$；

对于 35% 的数据，$k \leq 10000$；

对于 60% 的数据，$k \leq 200000$。

对于 100% 的数据，$k \leq 1048576$。


---

---
title: "[SHOI2008] 小约翰的游戏"
layout: "post"
diff: 提高+/省选-
pid: P4279
tag: ['2008', '各省省选', '上海']
---
# [SHOI2008] 小约翰的游戏
## 题目描述

小约翰经常和他的哥哥玩一个非常有趣的游戏：桌子上有 $n$ 堆石子，小约翰和他的哥哥轮流取石子，每个人取的时候，可以随意选择一堆石子，在这堆石子中取走任意多的石子，但不能一粒石子也不取，我们规定取到最后一粒石子的人算输。

小约翰相当固执，他坚持认为先取的人有很大的优势，所以他总是先取石子，而他的哥哥就聪明多了，他从来没有在游戏中犯过错误。小约翰一怒之前请你来做他的参谋。自然，你应该先写一个程序，预测一下谁将获得游戏的胜利。
## 输入格式

本题的输入由多组数据组成，第一行包括一个整数 $T$（$1 \leq T \leq 500$），表示输入总共有 $T$ 组数据。

每组数据的第一行包括一个整数 $N$（$1 \leq N \leq 50$），表示共有 $N$ 堆石子，接下来有 $N$ 个不超过 $5000$ 的整数，分别表示每堆石子的数目。
## 输出格式

对于每组数据，如果约翰能赢得比赛，则输出 `John`，否则输出 `Brother`，请注意单词的大小写。
## 样例

### 样例输入 #1
```
2
3
3 5 1
1
1
```
### 样例输出 #1
```
John
Brother
```
## 提示

- 对于 $40\%$ 的数据，$T \leq 250$；
- 对于 $100\%$ 的数据，$T \leq 500$。


---

---
title: "[AHOI2008] 逆序对"
layout: "post"
diff: 提高+/省选-
pid: P4280
tag: ['2008', '各省省选', '树状数组', '安徽', '前缀和']
---
# [AHOI2008] 逆序对
## 题目描述

暑假到了，小可可和伙伴们来到海边度假，距离海滩不远的地方有个小岛，叫做欢乐岛，整个岛是一个大游乐园，里面有很多很好玩的益智游戏。碰巧岛上正在举行“解谜题赢取免费门票”的活动，只要猜出来迷题，那么小可可和他的朋友就能在欢乐岛上免费游玩两天。

迷题是这样的：给出一串全部是正整数的数字，这些正整数都在一个范围内选取，谁能最快求出这串数字中“逆序对”的个数，那么大奖就是他的啦！

当然、主办方不可能就这么简单的让迷题被解开，数字串都是被处理过的，一部分数字被故意隐藏起来，这些数字均用-1来代替，想要获得大奖就必须求出被处理的数字串中最少能有多少个逆序对。小可可很想获得免费游玩游乐园的机会，你能帮助他吗？

注：“逆序对”就是如果有两个数A和B，A在B左边且A大于B，我们就称这两个数为一个“逆序对”，例如：4 2 1 3 3里面包含了5个逆序对：(4, 2)、(4, 1)、(4, 3)、(4, 3)、(2, 1)。

    假设这串数字由5个正整数组成，其中任一数字N均在1～4之间，数字串中一部分数字被“-1”替代后，如：4 2 -1 -1 3 ，那么这串数字，可能是4 2 1 3 3，也可能是4 2 4 4 3，也可能是别的样子。你要做的就是根据已知的数字，推断出这串数字里最少能有多少个逆序对。
## 输入格式

第一行两个正整数N和K；

第二行N个整数，每个都是-1或是一个在1~K之间的数（N<=10000，K<=100）。
## 输出格式

一个正整数，即这些数字里最少的逆序对个数。
## 样例

### 样例输入 #1
```
5 4
4 2 -1 -1 3
```
### 样例输出 #1
```
4
```
## 提示

100%的数据中，N<=10000，K<=100。

60%的数据中，N<=100。

40%的数据中，-1出现不超过两次。


---

---
title: "[AHOI2008] Y型项链"
layout: "post"
diff: 提高+/省选-
pid: P4283
tag: ['2008', '各省省选', '安徽']
---
# [AHOI2008] Y型项链
## 题目描述

欢乐岛上众多新奇的游乐项目让小可可他们玩的非常开心。现在他们正在玩比赛串项链的游戏，谁串的最快就能得到优厚的奖品。

这可不是普通的项链，而是一种 Y 型项链，项链的最中间有一颗大珍珠作为结合点，从大珍珠上连出来 3 条由各种宝石串起来的链子。

比赛的规则是这样的：每次可以从三条链子中某一条的一端取下来一个宝石，或者安上去一个宝石，称为一次操作，经过若干次操作，最终使得三条链子完全相同。想要赢得比赛，那么只能使用尽量少的操作次数。

假设每种宝石都有无数多个以供使用，且链子足够长。你能帮助小可可赢得比赛吗？

注：由于对 Y 型项链的宝石数没有特殊的要求，所以即使你把所有宝石都取下来，也是一个可以接受的方案（三根没有串宝石的绳子也是完全一样的）。
## 输入格式

一共有 $3$ 行，表示 Y 型项链的三条链子，每行开始有一个整数 $N$ ，表示初始时这条链子上串有 $N$ 个宝石，随后是一个空格，然后是 $N$ 个大写字母，表示这个链子上的宝石，每个字母表示一种不同的宝石，这个字符串最左边的字符表示的是离大珍珠最近的那个宝石，而最右边的表示的是在链子末端的宝石。
## 输出格式

只有一个整数，表示所需要的最少的操作次数。
## 样例

### 样例输入 #1
```
3 CAT
3 TAC
5 CATCH
```
### 样例输出 #1
```
8


```
## 提示

对于 $50\%$ 的数据，$N\leq 20$。

对于 $100\%$ 的数据，$1\le N\le 50$。


---

---
title: "[HAOI2008] 移动玩具"
layout: "post"
diff: 提高+/省选-
pid: P4289
tag: ['2008', '河南', '各省省选', '哈希 hashing', '进制', '队列']
---
# [HAOI2008] 移动玩具
## 题目描述

在一个4*4的方框内摆放了若干个相同的玩具，某人想将这些玩具重新摆放成为他心中理想的状态，规定移动时只能将玩具向上下左右四个方向移动，并且移动的位置不能有玩具，请你用最少的移动次数将初始的玩具状态移动到某人心中的目标状态。
## 输入格式

前4行表示玩具的初始状态，每行4个数字1或0，1表示方格中放置了玩具，0表示没有放置玩具。接着是一个空行。接下来4行表示玩具的目标状态，每行4个数字1或0，意义同上。
## 输出格式

一个整数，所需要的最少移动次数。
## 样例

### 样例输入 #1
```
1111
0000
1110
0010 

1010
0101
1010
0101
```
### 样例输出 #1
```
4
```


---

---
title: "[AHOI2007] 密码箱"
layout: "post"
diff: 提高+/省选-
pid: P4296
tag: ['2007', '各省省选', '安徽', '枚举', '优先队列']
---
# [AHOI2007] 密码箱
## 题目描述

在一次偶然的情况下，小可可得到了一个密码箱，听说里面藏着一份古代流传下来的藏宝图，只要能破解密码就能打开箱子，而箱子背面刻着的古代图标，就是对密码的提示。

经过艰苦的破译，小可可发现，这些图标表示一个数以及这个数与密码的关系。假设这个数是 $n$，密码为 $x$，那么可以得到如下表述： 密码 $x$ 大于等于 $0$，且小于 $n$，而 $x$ 的平方除以 $n$，得到的余数为 $1$。 小可可知道满足上述条件的 $x$ 可能不止一个，所以一定要把所有满足条件的 $x$ 计算出来，密码肯定就在其中。计算的过程是很艰苦的，你能否编写一个程序来帮助小可可呢？
## 输入格式

一行，一个数字 $n$（$1 \leq n \leq 2 \times 10^9$）。
## 输出格式

你的程序需要找到所有满足前面所描述条件的 $x$，如果不存在这样的 $x$，你的程序只需输出一行 `None`，否则请按照从小到大的顺序输出这些 $x$，每行一个数。
## 样例

### 样例输入 #1
```
12
```
### 样例输出 #1
```
1
5
7
11
```


---

---
title: "[CQOI2013] 新Nim游戏"
layout: "post"
diff: 提高+/省选-
pid: P4301
tag: ['贪心', '2013', '重庆', '各省省选', '线性基', '构造']
---
# [CQOI2013] 新Nim游戏
## 题目描述

传统的 Nim 游戏是这样的：有一些火柴堆，每堆都有若干根火柴（不同堆的火柴数量可以不同）。两个游戏者轮流操作，每次可以选一个火柴堆拿走若干根火柴。可以只拿一根，也可以拿走整堆火柴，但不能同时从超过一堆火柴中拿。拿走最后一根火柴的游戏者胜利。

本题的游戏稍微有些不同：在第一个回合中，双方可以直接拿走若干个整堆的火柴。可以一堆都不拿，但不可以全部拿走。从第二个回合（又轮到第一个游戏者）开始，规则和 Nim 游戏一样。

如果你先拿，怎样才能保证获胜？如果可以获胜的话，还要让第一回合拿的火柴总数尽量小。
## 输入格式

第一行为整数 $k$，即火柴堆数。

第二行包含 $k$ 个整数 $a_i$，即各堆的火柴个数。

## 输出格式

输出第一回合拿的火柴数目的最小值。如果不能保证取胜，输出 $-1$。
## 样例

### 样例输入 #1
```
6
5 5 6 6 5 5
```
### 样例输出 #1
```
21
```
## 提示

#### 数据规模与约定

对于全部的测试点，保证 $1 \leq k \leq 100$，$1 \leq a_i \leq 10^9$。


---

---
title: "[SCOI2003] 字符串折叠"
layout: "post"
diff: 提高+/省选-
pid: P4302
tag: ['字符串', '动态规划 DP', '搜索', '2003', '四川', '各省省选', '枚举', '区间 DP']
---
# [SCOI2003] 字符串折叠
## 题目描述

折叠的定义如下：

1. 一个字符串可以看成它自身的折叠。记作 ```S = S```

2. ```X(S)``` 是 $X$ 个 ```S``` 连接在一起的串的折叠。记作 ```X(S) = SSSS…S```。

3. 如果 ```A = A’```, ```B = B’```，则 ```AB = A’B’ ```。例如：因为 ```3(A) = AAA```, ```2(B) = BB```，所以 ```3(A)C2(B) = AAACBB```，而 ```2(3(A)C)2(B) = AAACAAACBB```

给一个字符串，求它的最短折叠。

例如 ```AAAAAAAAAABABABCCD``` 的最短折叠为：```9(A)3(AB)CCD```。
## 输入格式

仅一行，即字符串 `S`，长度保证不超过 $100$。
## 输出格式

仅一行，即最短的折叠长度。
## 样例

### 样例输入 #1
```
NEERCYESYESYESNEERCYESYESYES
```
### 样例输出 #1
```
14
```
## 提示

一个最短的折叠为：`2(NEERC3(YES))`


---

---
title: "[AHOI2006] 基因匹配"
layout: "post"
diff: 提高+/省选-
pid: P4303
tag: ['2006', '各省省选', '树状数组', '安徽', '背包 DP', '栈']
---
# [AHOI2006] 基因匹配
## 题目描述

卡卡昨天晚上做梦梦见他和可可来到了另外一个星球，这个星球上生物的DNA序列由无数种碱基排列而成（地球上只有4种），而更奇怪的是，组成DNA序列的每一种碱基在该序列中正好出现5次！这样如果一个DNA序列有N种不同的碱基构成，那么它的长度一定是5N。 

卡卡醒来后向可可叙述了这个奇怪的梦，而可可这些日子正在研究生物信息学中的基因匹配问题，于是他决定为这个奇怪星球上的生物写一个简单的DNA匹配程序。 

为了描述基因匹配的原理，我们需要先定义子序列的概念：若从一个DNA序列（字符串）s中任意抽取一些碱基（字符），将它们仍按在s中的顺序排列成一个新串u，则称u是s的一个子序列。对于两个DNA序列s1和s2，如果存在一个序列u同时成为s1和s2的子序列，则称u是s1和s2的公共子序列。 

卡卡已知两个DNA序列s1和s2，求s1和s2的最大匹配就是指s1和s2最长公共子序列的长度。 

[任务] 
编写一个程序： 
- 从输入文件中读入两个等长的DNA序列； 
- 计算它们的最大匹配； 
- 向输出文件打印你得到的结果。
## 输入格式

输入文件中第一行有一个整数N，表示这个星球上某种生物使用了N种不同的碱基，以后将它们编号为1…N的整数。 

以下还有两行，每行描述一个DNA序列：包含5N个1…N的整数，且每一个整数在对应的序列中正好出现5次。
## 输出格式

输出文件中只有一个整数，即两个DNA序列的最大匹配数目。
## 样例

### 样例输入 #1
```
2
1 1 1 1 1 2 2 2 2 2 
1 1 1 2 2 2 2 2 1 1 

```
### 样例输出 #1
```
8
```
## 提示

$1 \leq N \leq 20000$


---

---
title: "[TJOI2013] 攻击装置"
layout: "post"
diff: 提高+/省选-
pid: P4304
tag: ['2013', '各省省选', '网络流', '二分图', '天津']
---
# [TJOI2013] 攻击装置
## 题目描述

给定一个 01 矩阵，其中你可以在 0 的位置放置攻击装置。每一个攻击装置 $(x,y)$ 都可以按照“日”字攻击其周围的 $8$ 个位置 $(x-1,y-2)$，$(x-2,y-1)$，$(x+1,y-2)$，$(x+2,y-1)$，$(x-1,y+2)$，$(x-2,y+1)$，$(x+1,y+2)$，$(x+2,y+1)$。

求在装置互不攻击的情况下，最多可以放置多少个装置。
## 输入格式

第一行一个整数 $N$，表示矩阵大小为 $N \times N$。

接下来 $N$ 行每一行一个长度 $N$ 的 01 串，表示矩阵。
## 输出格式

一个整数，表示在装置互不攻击的情况下最多可以放置多少个装置。
## 样例

### 样例输入 #1
```
3
010
000
100
```
### 样例输出 #1
```
4
```
## 提示

对于 $30\%$ 的数据，保证 $N \le 50$。

对于 $100\%$ 的数据，保证 $N \le 200$。


---

---
title: "[JSOI2010] 连通数"
layout: "post"
diff: 提高+/省选-
pid: P4306
tag: ['2010', '各省省选', '江苏', '枚举', '图论建模', '连通块', '强连通分量']
---
# [JSOI2010] 连通数
## 题目背景

本题数据过水，可前往 https://www.luogu.com.cn/problem/U143178 提交

$\text{upd 2022.8.4}$：已作为 Hack 数据合并进来。
## 题目描述

度量一个有向图连通情况的一个指标是连通数，指图中可达顶点对个的个数。

如图

![](https://cdn.luogu.com.cn/upload/image_hosting/8jviim6w.png)

顶点 $1$ 可达 $1, 2, 3, 4, 5$

顶点 $2$ 可达 $2, 3, 4, 5$

顶点 $3$ 可达 $3, 4, 5$

顶点 $4, 5$ 都只能到达自身。

所以这张图的连通数为 $14$。

给定一张图，请你求出它的连通数
## 输入格式

输入数据第一行是图顶点的数量，一个正整数 $N$。  
接下来 $N$ 行，每行 $N$ 个字符。第 $i$ 行第 $j$ 列的 `1` 表示顶点 $i$ 到 $j$ 有边，`0` 则表示无边。
## 输出格式

输出一行一个整数，表示该图的连通数。
## 样例

### 样例输入 #1
```
3
010
001
100
```
### 样例输出 #1
```
9
```
## 提示

对于 $100 \%$ 的数据，$1 \le N \le 2000$。


---

---
title: "[SHOI2015] 脑洞治疗仪"
layout: "post"
diff: 提高+/省选-
pid: P4344
tag: ['2015', '线段树', '各省省选', '上海']
---
# [SHOI2015] 脑洞治疗仪
## 题目描述

曾经发明了自动刷题机的发明家 SHTSC 又公开了他的新发明：脑洞治疗仪——一种可以治疗他因为发明而日益增大的脑洞的神秘装置。

为了简单起见，我们将大脑视作一个 01 序列。$1$ 代表这个位置的脑组织正常工作，$0$ 代表这是一块脑洞。

```cpp
1      0      1      0      0      0      1      1      1      0
```

脑洞治疗仪修补某一块脑洞的基本工作原理就是将另一块连续区域挖出，将其中正常工作的脑组织填补在这块脑洞中。（所以脑洞治疗仪是脑洞的治疗仪？）

例如，用上面第 $8$ 号位置到第 $10$ 号位置去修补第 $1$ 号位置到第 $4$ 号位置的脑洞，我们就会得到：

```cpp
1      1      1      1      0      0      1      0      0      0
```

如果再用第 $1$ 号位置到第 $4$ 号位置去修补第 $8$ 号位置到第 $10$ 号位置：

```cpp
0      0      0      0      0      0      1      1      1      1
```

这是因为脑洞治疗仪会把多余出来的脑组织直接扔掉。

如果再用第 $7$ 号位置到第 $10$ 号位置去填补第 $1$ 号位置到第 $6$ 号位置：

```cpp
1      1      1      1      0      0      0      0      0      0
```

这是因为如果新脑洞挖出来的脑组织不够多，脑洞治疗仪仅会尽量填补位置比较靠前的脑洞。

假定初始时 SHTSC 并没有脑洞，给出一些挖脑洞和脑洞治疗的操作序列，你需要即时回答 SHTSC 的问题：在大脑某个区间中最大的连续脑洞区域有多大。
## 输入格式

第一行两个整数 $n,m$，表示 SHTSC 的大脑可分为从 $1$ 到 $n$ 编号的 $n$ 个连续区域，有 $m$ 个操作。

以下 $m$ 行每行是下列三种格式之一：
* $0\quad l\quad r$：SHTSC 挖了一个范围为 $[l, r]$ 的脑洞。
* $1\quad l_0\quad r_0\quad l_1\quad r_1$：SHTSC 进行了一次脑洞治疗，用从 $l_0$ 到 $r_0$ 的脑组织修补 $l_1$ 到 $r_1$ 的脑洞。
* $2\quad l\quad r$：SHTSC 询问 $[l, r]$ 区间内最大的脑洞有多大。

上述区间均在 $[1, n]$ 范围内。
## 输出格式

对于每个询问，输出一行一个整数，表示询问区间内最大连续脑洞区域有多大。
## 样例

### 样例输入 #1
```
10 10
0 2 2
0 4 6
0 10 10
2 1 10
1 8 10 1 4
2 1 10
1 1 4 8 10
2 1 10
1 7 10 1 6
2 1 10
```
### 样例输出 #1
```
3
3
6
6
```
## 提示

对于 $20\%$ 的数据，$n, m \leq 100$；  
对于 $50\%$ 的数据，$n, m \leq 20000$；  
对于 $100\%$ 的数据，$n, m \leq 200000$。


---

---
title: "[JLOI2014] 聪明的燕姿"
layout: "post"
diff: 提高+/省选-
pid: P4397
tag: ['2014', '各省省选', '吉林', '枚举', '深度优先搜索 DFS', '素数判断,质数,筛法']
---
# [JLOI2014] 聪明的燕姿
## 题目背景

> 阴天傍晚车窗外
>
> 未来有一个人在等待
>
> 向左向右向前看
>
> 爱要拐几个弯才来
>
> 我遇见谁会有怎样的对白
>
> 我等的人他在多远的未来
>
> 我听见风来自地铁和人海
>
> 我排着队拿着爱的号码牌
## 题目描述

城市中人们总是拿着号码牌，不停寻找，不断匹配，可是谁也不知道自己等的那个人是谁。

可是燕姿不一样，燕姿知道自己等的人是谁，因为燕姿数学学得好！燕姿发现了一个神奇的算法：假设自己的号码牌上写着数字 $S$，那么自己等的人手上的号码牌数字的所有正约数之和必定等于 $S$。

所以燕姿总是拿着号码牌在地铁和人海找数字（喂！这样真的靠谱吗）可是她忙着唱《绿光》，想拜托你写一个程序能够快速地找到所有自己等的人。
## 输入格式

输入包含 $k$ 组数据。

对于每组数据，输入包含一个号码牌 $S$。
## 输出格式

对于每组数据，输出有两行，第一行包含一个整数 $m$，表示有 $m$ 个等的人。

第二行包含相应的 $m$ 个数，表示所有等的人的号码牌。

特别地，当某组数据出现 $m=0$，即不存在满足题意的号码牌时，该组数据不应输出第二行（只应输出第一行的 $0$）。

注意：你输出的号码牌必须按照升序排列。
## 样例

### 样例输入 #1
```
42
```
### 样例输出 #1
```
3
20 26 41
```
## 提示

对于 $100\%$ 的数据，$k\leqslant100$，$S\leqslant2\times10^9$。


---

---
title: "[JSOI2008] Blue Mary的战役地图"
layout: "post"
diff: 提高+/省选-
pid: P4398
tag: ['2008', '各省省选', '江苏', '枚举', '哈希 hashing']
---
# [JSOI2008] Blue Mary的战役地图
## 题目描述

Blue Mary最近迷上了玩Starcraft(星际争霸) 的RPG游戏。她正在设法寻找更多的战役地图以进一步提高自己的水平。
 
由于Blue Mary的技术已经达到了一定的高度,因此，对于用同一种打法能够通过的战役地图，她只需要玩一张，她就能了解这一类战役的打法，然后她就没有兴趣再玩儿这一类地图了。而网上流传的地图有很多都是属于同一种打法，因此Blue Mary需要你写一个程序，来帮助她判断哪些地图是属于同一类的。 

具体来说，Blue Mary已经将战役地图编码为n*n的矩阵，矩阵的每个格子里面是一个32位（有符号）正整数。对于两个矩阵，他们的相似程度定义为他们的最大公共正方形矩阵的边长。两个矩阵的相似程度越大，这两张战役地图就越有可能是属于同一类的。
## 输入格式

第一行包含一个正整数n。 

以下n行，每行包含n个正整数，表示第一张战役地图的代表矩阵。 

再以下n行，每行包含n个正整数，表示第二张战役地图的代表矩阵。
## 输出格式

仅包含一行。这一行仅有一个正整数，表示这两个矩阵的相似程度。 

## 样例

### 样例输入 #1
```
3
1 2 3
4 5 6
7 8 9
5 6 7
8 9 1
2 3 4
```
### 样例输出 #1
```
2
```
## 提示

样例解释： 

子矩阵： 
5 6 
8 9 
为两个地图的最大公共矩阵 

约定： 
n<=50 



---

---
title: "[JSOI2008] Blue Mary的职员分配"
layout: "post"
diff: 提高+/省选-
pid: P4399
tag: ['2008', '各省省选', '江苏']
---
# [JSOI2008] Blue Mary的职员分配
## 题目描述

由于Blue Mary呕心沥血的管理，Blue Mary的网络公司蒸蒸日上。现在一共拥有了n名职员，可惜没有任何的金钱和声誉。平均每名每天职员都可以给公司带来x单位金钱或者y单位声誉（名利不能双全）。并且可以花费z单位的金钱在人才交易市场发布广告招聘职员，每次发布广告三天以后就会招聘到一名职员，并且必须在发布广告并且招聘到职员的那一天才能发布下一次广告。 

Blue Mary计划以最快的时间获得至少A单位金钱和至少B单位声誉，请你计算一下他至少需要多少时间才能达到他的目标。
## 输入格式

输入有且仅有一行，包含六个整数n,x,y,z,A和B，意义如题目描述所述。
## 输出格式

要求输出一行，包含一个整数，表示Blue Mary至少需要多少时间才能达到他的目标。 



## 样例

### 样例输入 #1
```
1 2 3 4 5 6
```
### 样例输出 #1
```
5
```
## 提示

提示
1<=n,x,y,z,A,B<=20 


---

---
title: "[ZJOI2006] 皇帝的烦恼"
layout: "post"
diff: 提高+/省选-
pid: P4409
tag: ['贪心', '递推', '2006', '各省省选', '浙江', '中国剩余定理 CRT']
---
# [ZJOI2006] 皇帝的烦恼
## 题目描述

经过多年的杀戮，秦皇终于统一了中国。为了抵御外来的侵略，他准备在国土边境安置 $n$ 名将军。不幸的是这 $n$ 名将军羽翼渐丰，开始展露他们的狼子野心了。他们拒绝述职、拒绝接受皇帝的圣旨。

秦皇已经准备好了秘密处决这些无礼的边防大将。

不过为防兵变，他决定先授予这些将军一些勋章，为自己赢得战略时间。将军们听说他们即将被授予勋章都很开心，他们纷纷上书表示感谢。第 $i$ 个将军要求得到 $a_i$ 枚不同颜色的勋章。但是这些将军都很傲气，如果两个相邻的将军拥有颜色相同的勋章他们就会认为皇帝不尊重他们，会立即造反（编号为 $i$ 的将军和编号为 $i+1$ 的将军相邻；因为他们驻扎的边境可以类似看成一个圆形，所以编号 $1$ 和编号 $n$ 的将军也相邻）。

皇帝不得不满足每个将军的要求，但对他们的飞扬跋扈感到很气愤。于是皇帝决定铸造尽量少种类的勋章来满足这些狂妄者的要求。请问他至少要铸造多少种颜色的勋章？
## 输入格式

第一行一个整数 $n$。

接下来 $n$ 行每行一个整数 $a_i$，表示第 $i$ 个将军要求得到多少种勋章。
## 输出格式

输出一个整数，即最少需要多少种勋章。
## 样例

### 样例输入 #1
```
4
2
2
1
1
```
### 样例输出 #1
```
4
```
## 提示

$1 \leq n \leq 2 \times 10^4$，$1 \leq a_i  \leq 10^5$。


---

---
title: "[CQOI2018] 破解D-H协议"
layout: "post"
diff: 提高+/省选-
pid: P4454
tag: ['2018', '重庆', '各省省选', '枚举', '素数判断,质数,筛法', '逆元']
---
# [CQOI2018] 破解D-H协议
## 题目背景

Diffie-Hellman 密钥交换协议是一种简单有效的密钥交换方法。它可以让通讯双方在没有事先约定**密钥**的情况下，通过**不安全**（可能被窃听）**的信道**确定一个**安全的密钥** $K$，用于加密之后的通讯内容。
## 题目描述

假定通讯双方名为 Alice 和 Bob，协议的工作过程描述如下（其中 $\bmod$ 表示取模运算）：

1. 协议规定一个**固定的**质数 $P$，以及模 $P$ 的一个原根 $g$。**$\boldsymbol P$ 和 $\boldsymbol g$ 的数值都是公开的，无需保密。**

2. Alice 生成一个随机数 $a$，并计算 $A=g^a\bmod P$，将 $A$ 通过不安全信道发送给 Bob。

3. Bob 生成一个随机数 $b$，并计算 $B=g^b\bmod P$，将 $B$ 通过不安全信道发送给 Alice。

4. Bob 根据收到的 $A$ 计算出**密钥** $K=A^b \bmod P$，而 Alice 根据收到的 $B$ 计算出 $K=B^a\bmod P$。

5. 双方得到了相同的 $K$，即 $g^{ab} \bmod P$。$K$ 即之后通讯的加密密钥。

可见，这个过程中可能被窃听的只有 $A,B$，而 $a,b,K$ 是保密的。并且根据 $A,B,P,g$ 这 $4$ 个数，不能轻易计算出 $K$，因此 $K$ 可以作为一个安全的密钥。

当然安全是相对的，该协议的安全性取决于数值的大小，通常 $a,b,P$ 都选取数百位以上的大整数以避免被破解。然而如果 Alice 和 Bob 编程时偷懒，为了避免实现大数运算，选择的数值都小于 $2^{31}$，那么破解他们的密钥就比较容易了。

$T$ 次给定窃听得到的 $A,B$，你需要尝试破解出**密钥** $K$。

## 输入格式

输入文件第一行包含两个空格分开的正整数 $g$ 和 $P$。

第二行为一个正整数 $n$，表示 Alice 和 Bob 共进行了 $n$ 次连接（即运行了 $n$ 次协议）。

接下来 $n$ 行，每行包含两个空格分开的正整数 $A$ 和 $B$，表示某次连接中，被窃听的 $A,B$ 的数值。
## 输出格式

输出包含 $n$ 行，每行 $1$ 个正整数 $K$，为每次连接你破解得到的密钥。
## 样例

### 样例输入 #1
```
3 31
3
27 16
21 3
9 26
```
### 样例输出 #1
```
4
21
25
```
## 提示

对于 $30\%$ 的数据，$2\le A,B,P\le 1000$；

对于 $100\%$ 的数据，$2\le A,B<P<2^{31}，2\le g<20，1\le n\le 20$。

$\text{Statement fixed by @Starrykiller.}$


---

---
title: "[CQOI2018] 交错序列"
layout: "post"
diff: 提高+/省选-
pid: P4456
tag: ['2018', '重庆', '各省省选', '枚举', '二项式定理', '构造']
---
# [CQOI2018] 交错序列
## 题目描述

我们称一个仅由 $0$、$1$ 构成的序列为”交错序列“，当且仅当序列中没有相邻的 $1$（可以有相邻的 $0$）。例如，`000`,`001`,`101`,都是交错序列，而 `110` 则不是。

对于一个长度为 $n$ 的交错序列，统计其中 $0$ 和 $1$ 出现的次数，分别记为 $x$ 和 $y$。给定参数 $a$、$b$,定义一个交错序列的特征值为 $x^ay^b$。注意这里规定任何整数的 $0$ 次幂都等于 $1$（包括 $0^0=1$）。

显然长度为 $n$ 的交错序列可能有多个。我们想要知道，所有长度为 $n$ 的交错序列的特征值的和，除以 $m$ 的余数。（$m$ 是一个给定的质数）

例如，全部长度为 $3$ 的交错串为: `000`、`001`、`010`、`100`、`101`。当 $a=1,b=2$ 时，可计算：$3^1\times0^2+2^1\times1^2+2^1\times1^2+2^1\times1^2+1^1\times2^2=10$。

## 输入格式

输入文件共一行，包含三个空格分开的整数 $n, a,b,m$。
## 输出格式

输出文件共一行，为计算结果。
## 样例

### 样例输入 #1
```
3 1 2 1009
```
### 样例输出 #1
```
10
```
### 样例输入 #2
```
4 3 2 1009
```
### 样例输出 #2
```
204
```
## 提示

对于 30% 的数据，1≤n≤15

对于 100% 的数据，1≤n≤10000000 0≤a,b≤45 m<100000000


---

---
title: "[CQOI2018] 异或序列"
layout: "post"
diff: 提高+/省选-
pid: P4462
tag: ['2018', '重庆', '莫队', '各省省选', '进制', '前缀和']
---
# [CQOI2018] 异或序列
## 题目描述

已知一个长度为 $n$ 的整数数列 $a_1,a_2,\dots,a_n$，给定查询参数 $l,r$，问在 $a_l,a_{l+1},\dots,a_r$ 区间内，有多少子区间满足异或和等于 $k$。也就是说，对于所有的 $x,y (l \leq x \leq y \leq r)$，能够满足 $a_x \oplus a_{x+1} \oplus \dots \oplus a_y = k$ 的 $x,y$ 有多少组。

## 输入格式

输入文件第一行，为 $3$ 个整数 $n,m,k$。

第二行为空格分开的 $n$ 个整数，即 $a_1,a_2,..a_n$。

接下来 $m$ 行，每行两个整数 $l_j,r_j$，表示一次查询。
## 输出格式

输出文件共 $m$ 行，对应每个查询的计算结果。
## 样例

### 样例输入 #1
```
4 5 1
1 2 3 1
1 4
1 3
2 3
2 4
4 4
```
### 样例输出 #1
```
4
2
1
2
1
```
## 提示

对于 $30\%$ 的数据，$1 \leq n, m \leq 1000$。

对于 $100\%$ 的数据，$1 \leq n, m \leq 10^5$，$0 \leq k, a_i \leq 10^5$，$1 \leq l_j \leq r_j \leq n$。


---

---
title: "[SCOI2006] zh_tree"
layout: "post"
diff: 提高+/省选-
pid: P4539
tag: ['2006', '四川', '各省省选']
---
# [SCOI2006] zh_tree
## 题目描述

张老师根据自己工作的需要，设计了一种特殊的二叉搜索树。

他把这种二叉树起名为 zh_tree，对于具有 $n$ 个结点的 zh_tree，其中序遍历恰好为 $(1,2,3,\cdots,n)$，其中数字 $1,2,3,\cdots,n$ 是每个结点的编号。$n$ 个结点恰好对应于一组学术论文中出现的n个不同的单词。

第j个单词在该组论文中出现的次数记为 $d_j$，例如，$d_2=10$表示第 $2$ 个结点所对应的单词在该组论文中出现了10次。设该组论文中出现的单词总数为 S，显然，$S=d_1+d_2+…+d_n$。记 $f_j=\frac{d_j}{S}$ 为第 j 个单词在该组论文中出现的概率（频率）。 

张老师把根结点深度规定为0，如果第 $j$ 个结点的深度为 $r$，则访问该结点的代价 $h_j$ 为 $h_j=k(r+1)+c$，其中 $k$，$c$ 为已知的不超过 $100$ 的正常数。

则zh_tree是满足以下条件的一棵二叉树：它使 $h_1f_1+h_2f_2+…+h_nf_n$ 达到最小。

我们称上式为访问 zh_tree 的平均代价。 请你根据已知数据为张老师设计一棵 zh_tree。
## 输入格式

第 $1$ 行：$3$ 个用空格隔开的正数： $n$ $k$ $c$ 其中 $n<30$，为整数。$k$，$c$ 为不超过100的正实数。 第 $2$ 行：$n$ 个用空格隔开的正整数，为每个单词出现的次数(次数<200)。
## 输出格式

第1行：(5分)一个正实数，保留3位小数，为访问Zh_tree的最小平均代价。 第2行：（5分）n个用空格隔开的整数，为该树的前序遍历。一般地，作为最优解的前序遍历不一定唯一，只输出一个解。
## 样例

### 样例输入 #1
```
4 2 3.5
20 30 50 20
```
### 样例输出 #1
```
7.000
```


---

---
title: "[JXOI2018] 游戏"
layout: "post"
diff: 提高+/省选-
pid: P4562
tag: ['数学', '2018', '各省省选', '组合数学', '期望']
---
# [JXOI2018] 游戏
## 题目背景

九条可怜是一个富有的女孩子。
## 题目描述

她长大以后创业了，开了一个公司。 但是管理公司是一个很累人的活，员工们经常背着可怜偷懒，可怜需要时不时对办公室进行检查。

可怜公司有 $n$ 个办公室，办公室编号是 $l$ 到 $l+n-1$ ，可怜会事先制定一个顺序，按照这个顺序依次检查办公室。一开始的时候，所有办公室的员工都在偷懒，当她检查完编号是 $i$ 的办公室时候，这个办公室的员工会认真工作，并且这个办公室的员工通知所有办公室编号是 $i$ 的倍数的办公室，通知他们老板来了，让他们认真工作。因此，可怜检查完第 $i$ 个办公室的时候，所有编号是 $i$ 的倍数(包括 $i$ )的办公室的员工会认真工作。

可怜发现了员工们通风报信的行为，她发现，对于每种不同的顺序 $p$ ，都存在一个最小的 $t(p)$ ，使得可怜按照这个顺序检查完前 $t(p)$ 个办公室之后，所有的办公室都会开始认真工作。她把这个 $t(p)$ 定义为 $p$ 的检查时间。

可怜想知道所有 $t(p)$ 的和。

但是这个结果可能很大，她想知道和对 $10^9+7$ 取模后的结果。
## 输入格式

第一行输入两个整数 $l,r$ 表示编号范围，题目中的 $n$ 就是 $r-l+1$ 。
## 输出格式

一个整数，表示所有 $t(p)$ 的和。
## 样例

### 样例输入 #1
```
2 4
```
### 样例输出 #1
```
16

```
## 提示

### 样例解释

考虑所有办公室被检查的相对顺序:

{2 3 4} ,时间是 2 。
{3 2 4} ,时间是 2 。
{4 2 3} ,时间是 3 。
{4 3 2} ,时间是 3 。
{2 4 3} ,时间是 3 。
{3 4 2} ,时间是 3 。

和是 $16$ 。

### 数据范围

对于 20% 的数据，$r-l+1\leq 8$。  
对于另 10% 的数据，$l=1$。  
对于另 10% 的数据，$l=2$。  
对于另 30% 的数据，$l\leq 200$。  
对于 100% 的数据，$1\leq l\leq r\leq 10^7$。


---

---
title: "[JSOI2009] 瓶子和燃料"
layout: "post"
diff: 提高+/省选-
pid: P4571
tag: ['2009', '各省省选', '江苏']
---
# [JSOI2009] 瓶子和燃料
## 题目描述

jyy 一直想着尽快回地球，可惜他飞船的燃料不够了。有一天他又去向火星人要燃料，这次火星人答应了，要 jyy 用飞船上的瓶子来换。jyy 的飞船上共有 $N$ 个瓶子（$1 \leq N \leq 1000$），经过协商，火星人只要其中的 $K$ 个。 

jyy 将 $K$ 个瓶子交给火星人之后，火星人用它们装一些燃料给 jyy。所有的瓶子都没有刻度，只在瓶口标注了容量，第 $i$ 个瓶子的容量为 $V _ i$（$V _ i$ 为整数，并且满足 $1 \leq V _ i \leq 10 ^ 9$） 。火星人比较吝啬，他们并不会把所有的瓶子都装满燃料。他们拿到瓶子后，会跑到燃料库里鼓捣一通，弄出一小点燃料来交差。jyy 当然知道他们会来这一手，于是事先了解了火星人鼓捣的具体内容。

火星人在燃料库里只会做如下的 $3$ 种操作：

1. 将某个瓶子装满燃料；
2. 将某个瓶子中的燃料全部倒回燃料库；
3. 将燃料从瓶子 $a$ 倒向瓶子 $b$，直到瓶子 $b$ 满或者瓶子 $a$ 空。燃料倾倒过程中的损耗可以忽略。

火星人拿出的燃料，当然是这些操作能得到的最小正体积。jyy 知道，对于不同的瓶子组合，火星人可能会被迫给出不同体积的燃料。jyy 希望找到最优的瓶子组合，使得火星人给出尽量多的燃料。
## 输入格式

第一行为两个整数 $N,K$。  
第 $2 \sim N$ 行，每行一个整数，第 $i+1$ 行的整数为 $V _ i$。
## 输出格式

仅一行一个整数，表示火星人给出燃料的最大值。
## 样例

### 样例输入 #1
```
3 2
3
4
4
```
### 样例输出 #1
```
4
```
## 提示

选择第 $2$ 个瓶子和第 $3$ 个瓶子，火星人被迫会给出 $4$ 体积的容量。


---

---
title: "[CQOI2013] 新数独"
layout: "post"
diff: 提高+/省选-
pid: P4573
tag: ['搜索', '2013', '重庆', '各省省选', '枚举', '深度优先搜索 DFS']
---
# [CQOI2013] 新数独
## 题目描述

下面是一个没有数字，只有大小关系（没错，那些尖角都是“大于符号”）！的数独：

![](https://cdn.luogu.com.cn/upload/image_hosting/wm5lvhj6.png)

除了大小关系外（注意相邻格子不能相同），还需要满足通常的数独规则：

 * 每个格子都是 $1\sim 9$ 的数字；
 * 每行都是 $1 \sim 9$ 的排列；
 * 每列都是 $1 \sim 9$ 的排列；
 * 每个 $3\times 3$ 的子矩阵（上图中用粗线隔开，一共有 $3\times 3$ 个这样的子矩阵）都是 $1\sim 9$ 的排列。
 
 如下图所示，是上述提到的数独的唯一一种填法：
 
 ![](https://cdn.luogu.com.cn/upload/image_hosting/73a6a29i.png)
 
 为了美观，每个 $3\times 3$ 子矩阵的**所有 $12$ 对**相邻格子的大小关系都将给出。
## 输入格式

一共 $15$ 行，包含一个新数独的实例。第 $1,3,5,6,8,10,11,13,15$ 行包含左右方向的符号（< 和 >），其余行包含上下方向的符号（^ 和 v）
## 输出格式

包含 $9$ 行，每行 $9$ 个 $1\sim 9$ 的数字，以空格隔开。输入保证唯一解。
## 样例

### 样例输入 #1
```
> < < < > <
v ^ v v ^ v ^ ^ v
< < < > < <
v ^ v ^ v v ^ ^ v
< < < < > >
< > > > < >
v v ^ ^ v ^ ^ v v
< > > < > >
^ v v v ^ v v ^ v
> < < > > >
< > > > > <
v v v v ^ ^ ^ ^ ^
> < < < < <
^ ^ ^ ^ ^ v v v ^
> > < > < <
```
### 样例输出 #1
```
5 3 9 4 6 8 2 1 7
2 4 8 1 9 7 3 5 6
1 6 7 2 3 5 9 8 4
6 8 1 7 4 2 5 9 3
3 7 5 9 1 6 8 4 2
9 2 4 5 8 3 7 6 1
7 9 6 8 2 1 4 3 5
4 1 2 3 5 9 6 7 8
8 5 3 6 7 4 1 2 9
```
### 样例输入 #2
```
< > > < > <
v v ^ ^ v v ^ ^ ^
< < > < > <
^ ^ ^ v ^ ^ ^ v v
< < < < > > 
> < > > > >
v ^ ^ ^ ^ v v v ^
> > > > < >
v v ^ v ^ v ^ v ^
> < < > > > 
< < < < > <
v ^ v v v v ^ ^ v
< > > < < >
^ v v v ^ v ^ v v
< > < > < >
```
### 样例输出 #2
```
4 9 1 7 3 6 5 2 8
2 3 7 8 1 5 6 4 9
5 6 8 2 4 9 7 3 1
9 1 3 6 5 4 8 7 2
8 5 4 9 7 2 1 6 3
7 2 6 3 8 1 9 5 4
3 4 9 5 6 8 2 1 7
1 8 5 4 2 7 3 9 6
6 7 2 1 9 3 4 8 5
```


---

---
title: "[FJOI2018] 所罗门王的宝藏"
layout: "post"
diff: 提高+/省选-
pid: P4578
tag: ['图论', '2018', '各省省选', '福建', '枚举']
---
# [FJOI2018] 所罗门王的宝藏
## 题目描述

据古代传说记载，所罗门王既是智慧的代表，又是财富的象征。他建立了强大而富有的国家，聚集了大批的黄金象牙和钻石，并把这些价值连城的珍宝藏在一个神秘的地方，这就是世人瞩目的“所罗门王的宝藏”。多少个世纪以来，人们一直在寻找这批早已失落的古代文明宝藏，寻找盛产黄金和钻石的宝地。曾经追寻所罗门王宝藏的冒险者们都一去不回，至今没人解开这个谜题。亨利男爵在一次幸运的旅途中意外地得到了三百年前一位葡萄牙贵族留下的写在羊皮卷上的所罗门王的藏宝图和一本寻宝秘籍。在这张藏宝图的诱惑下，亨利男爵邀请约翰上校和勇敢的猎象人夸特曼开始了寻找埋葬在黑暗地底的所罗门王宝藏的艰险历程。他们横穿渺无边际的沙漠和浓荫蔽日的原始森林，越过汹涌澎湃的激流险滩，翻越高耸入云的峻岭雪山，饱尝沙漠的酷热和冰雪严寒，在藏宝图的指引下来到非洲一个原始的神秘国度库库安纳。这里有残酷的人殉制度，有一个拥有一千个妻室的独眼暴君特瓦拉，有像兀鹫一般丑恶诡诈老而不死的女巫加古尔，还有美丽聪慧的绝代佳人弗拉塔。在这片陌生而又险象环生的土地上三位寻宝英雄历尽艰辛，终于在绝代佳人弗拉塔的帮助下在海底深处找到了珍藏这批价值连城宝藏的巨大的藏宝洞。然而在女巫加古尔的精心策划下，一场灭顶之灾正在悄悄逼近。

藏宝洞的洞门十分坚固且洞门紧闭，如果不知道开启洞门的秘密是无法打开藏宝洞的洞门。在藏宝洞的洞门一侧有一个奇怪的矩形密码阵列。根据寻宝秘籍的记载，在密码阵列每行的左侧和每列的顶端都有一颗红宝石按钮。每个按钮都可以向左或向右转动。每向左转动一次按钮，相应的行或列中数字都增 $1$。每向右转动一次按钮，相应的行或列中数字都减 $1$。在矩形密码阵列的若干特定位置镶嵌着绿宝石。只有当所有绿宝石位置的数字与藏宝图记载的密码完全相同，紧闭的洞门就会自动缓缓打开。女巫加古尔早已得知开门的秘密。为了阻止寻宝者打开洞门，女巫加古尔为开门的密码阵列设置了全 $0$ 的初始状态。试图打开洞门的寻宝者如果不能迅速转动按钮使所有绿宝石位置的数字与藏宝图记载的密码完全相同，就会自动启动藏宝洞玄妙的暗器机关，使寻宝者遭到灭顶攻击而死于非命。

您能帮助三位寻宝英雄顺利打开藏宝洞的洞门吗？

编程任务：对于给定的密码阵列，找到获得正确密码的红宝石按钮的转动序列。

## 输入格式

输入的第一行中有一个正整数 $T (T \le 5)$ 表示有 $T$ 组数据。每组数据的第一行有 $3$ 个正整数 $n,m$ 和 $k$，表示洞门密码阵列共有 $n$ 行和 $m$ 列，$0<n,m,k \le 1000$。各行从上到下依次编号为 $1,2,\ldots,n$；各列从左到右依次编号为 $1,2,\ldots,m$ 。接下来的 $k$ 行中每行有三个整数 $x,y,c$，分别表示第 $k$ 个绿宝石在密码阵列中的位置和密码，$x$ 为行号 $y$ 为列号，$c$ 为该位置处的密码。
## 输出格式

对于每组数据，用一行输出 ``Yes`` 或者 ``No``。输出 ``Yes`` 表示存在获得正确密码的红宝石按钮的转动序列。输出 ``No`` 则表示无法找到获得正确密码的红宝石按钮的转动序列。
## 样例

### 样例输入 #1
```
2
2 2 4
1 1 0
1 2 0
2 1 2
2 2 2
2 2 4
1 1 0
1 2 0
2 1 2
2 2 1
```
### 样例输出 #1
```
Yes
No
```
## 提示

对于 $100\%$ 的数据，$1 \le n, m, k \le 1000$，$k \le n \times m$，$|c| \le 1,000,000$。


---

---
title: "[BJOI2014] 路径"
layout: "post"
diff: 提高+/省选-
pid: P4580
tag: ['2014', '各省省选', '北京']
---
# [BJOI2014] 路径
## 题目描述

在一个 $N$ 个节点的无向图（没有自环、重边）上，每个点都有一个符号，可能是数字，也可能是加号、减号、乘号、除号、小括号。你要在这个图上数一数，有多少种走恰好 $K$ 个节点的方法，使得路过的符号串起来能够得到一个算数表达式。路径的起点和终点可以任意选择。

所谓算数表达式，就是由运算符连接起来的一系列数字。括号可以插入在表达式中以表明运算顺序。

注意，你要处理各种情况，比如数字不能有多余的前导 $0$，减号只有前面没有运算符或数字的时候才可以当成负号，括号可以任意添加（但不能有空括号），$0$ 可以做除数（我们只考虑文法而不考虑语意），加号不能当正号。

例如，下面的是合法的表达式：
```
-0/0
((0)+(((2*3+4)+(-5)+7))+(-(2*3)*6))
```
而下面的不是合法的表达式：
```
001+0
1+2(2)
3+-3
--1
+1
()
```
## 输入格式

第一行三个整数 $N,M,K$，表示点的数量，边的数量和走的节点数。

第二行一个字符串，表示每个点的符号。

接下来 $M$ 行，每行两个数，表示一条边连的两个点的编号。
## 输出格式

输出一行一个整数，表示走的方法数。这个数可能比较大，你只需要输出它模 $10^9+7$ 的余数即可。
## 样例

### 样例输入 #1
```
6 10 3
)(1*+0
1 2
1 3
1 4
2 3
3 4
2 5
3 5
3 6
4 6
5 6
```
### 样例输出 #1
```
10
```
## 提示

$1 \le N \le 20，0 \le M \le\frac{N×(N-1)}{2}，0\le K\le 30$

![](https://cdn.luogu.com.cn/upload/pic/18714.png)

一共有 $10$ 条路径，构成的表达式依次是 ``101, (1), 1+1, 1+0, 1*1, 1*0, 0+0, 0+1, 0*0, 0*1``。


---

---
title: "[HNOI2009] 双递增序列"
layout: "post"
diff: 提高+/省选-
pid: P4728
tag: ['动态规划 DP', '2009', '各省省选', '湖南']
---
# [HNOI2009] 双递增序列
## 题目描述

考虑一个长度为偶数 $n$ 的序列 $a_1, a_2, \dots, a_n$，我们称这个序列为好的，当且仅当存在 $a_1, a_2, \dots, a_n$ 的一个划分 $U=\{ a_{i_1}, a_{i_2}, \dots, a_{i_{n/2}} \}, V=\{ a_{j_1}, a_{j_2}, \dots, a_{j_{n/2}} \}=\{ a_1, a_2, \dots, a_n \}-U$，且 $i_1<i_2< \dots <i_{n/2}, a_{i_1}<a_{i_2}< \dots <a_{i_{n/2}}, j_1<j_2< \dots <j_{n/2}, a_{j_1}<a_{j_2}< \dots <a_{j_{n/2}}$。

比如序列 $3, 1, 4, 5, 8, 7$ 就是一个好的序列。因为它可以分成 $U=\{3, 4, 8\}, V=\{1, 5, 7\}$。而序列 $3, 2, 1, 6, 5, 4$ 则不是一个好的序列。

现在的问题是，针对给出的若干序列，请你判断它们是否是好的序列。

## 输入格式

第一行仅包含一个整数 $m$，表示需要判断 $m$ 个序列。  
接下来的 $m$ 行分别给出这些序列。每个序列的输入为一行，每行的第一个数为一个偶数 $n$，表示序列的长度，随后的 $n$ 个整数表示序列本身的元素 $a_1, a_2, \dots, a_n$。同一行的各数之间用一个空格隔开。
## 输出格式

输出 $m$ 行，如果第 $i$ 个序列为好的序列，那么第 $i$ 行输出`Yes!`，否则输出 `No!`。
## 样例

### 样例输入 #1
```
2
6 3 1 4 5 8 7
6 3 2 1 6 5 4
```
### 样例输出 #1
```
Yes!
No!
```
## 提示

对于 $10\%$ 的数据，$n \le 100$。  
对于 $40\%$ 的数据，$n \le 300$。  
对于 $100\%$ 的数据，$1 \le n \leq 2000$，$1 \le m \leq 25$，$0 \le a_i \le 10^6$。


---

---
title: "【模板】树同构（[BJOI2015]树的同构）"
layout: "post"
diff: 提高+/省选-
pid: P5043
tag: ['图论', '2015', '各省省选', '北京', '哈希 hashing']
---
# 【模板】树同构（[BJOI2015]树的同构）
## 题目描述

树是一种很常见的数据结构。

我们把 $N$ 个点，$N-1$ 条边的连通无向图称为树。

若将某个点作为根，从根开始遍历，则其它的点都有一个前驱，这个树就成为有根树。

对于两个树 $T_1$ 和 $T_2$，如果能够把树 $T_1$ 的所有点重新标号，使得树 $T_1$ 和树 $T_2$ 完全相同，那么这两个树是同构的。也就是说，它们具有相同的形态。

现在，给你 $M$ 个无根树，请你把它们按同构关系分成若干个等价类。
## 输入格式

第一行，一个整数 $M$。

接下来 $M$ 行，每行包含若干个整数，表示一个树。第一个整数 $N$表示点数。接下来 $N$ 个整数，依次表示编号为 $1$ 到 $N$ 的每个点的父亲结点的编号。根节点父亲结点编号为 $0$。
## 输出格式

输出 $M$ 行，每行一个整数，表示与每个树同构的树的最小编号。
## 样例

### 样例输入 #1
```
4 
4 0 1 1 2 
4 2 0 2 3 
4 0 1 1 1 
4 0 1 2 3 
```
### 样例输出 #1
```
1 
1 
3 
1 
```
## 提示

编号为 $1, 2, 4$ 的树是同构的。编号为 $3$ 的树只与它自身同构。

对于 $100\%$ 的数据，$1\leq N,M\leq 50$。


---

---
title: "[ZJOI2004] 嗅探器"
layout: "post"
diff: 提高+/省选-
pid: P5058
tag: ['2004', '各省省选', '浙江', 'Tarjan', '双连通分量']
---
# [ZJOI2004] 嗅探器
## 题目描述

某军搞信息对抗实战演习，红军成功地侵入了蓝军的内部网络。

蓝军共有两个信息中心，红军计划在某台中间服务器上安装一个嗅探器，从而能够侦听到两个信息中心互相交换的所有信息。

但是蓝军的网络相当的庞大，数据包从一个信息中心传到另一个信息中心可以不止有一条通路。

现在需要你尽快地解决这个问题，应该把嗅探器安装在哪个中间服务器上才能保证所有的数据包都能被捕获？
## 输入格式

输入文件的第一行一个整数 $n$，表示蓝军网络中服务器的数目。

接下来若干行是对蓝军网络的拓扑结构描述，每行是两个整数 $i,j$ 表示编号为 $i$ 和编号为 $j$ 的两台服务器间存在双向连接。

服务器的编号从 $1$ 开始，一行两个 $0$ 表示网络的拓扑结构描述结束，再接下来是两个整数 $a,b$ 分别表示两个中心服务器的编号。
## 输出格式

输出满足条件的服务器编号。如果有多个解输出编号最小的一个，如果找不到任何解，输出 `No solution`。
## 样例

### 样例输入 #1
```
5
2 1
2 5
1 4
5 3
2 3
5 1
0 0
4 2
```
### 样例输出 #1
```
1
```
## 提示

对于 $100\%$ 的数据，$1\le n\le 2 \times 10^5$，边数不超过 $5 \times 10^5$。


---

---
title: "[SHOI2014] 神奇化合物"
layout: "post"
diff: 提高+/省选-
pid: P5214
tag: ['2014', '各省省选', '上海']
---
# [SHOI2014] 神奇化合物
## 题目背景

SHOI2014 day2t1
## 题目描述

科学家最近发现了一种高分子有机化合物 SHTSC。这种物质的分子由单个或多个原子组成，原子之间通过化学键相互连接。SHTSC 十分不稳定，其原子之间的化学键经常会伴随着炫酷的声音特效和光影效果发生断裂或者重新连接。

然而，令科学家们大为惊异的是，SHTSC 在变化过程中始终保持着一种特殊的性质：即不存在这样的原子序列 $a_1,a_2,\ldots,a_n \ (n>3)$ 满足 $a_1$ 与 $a_2$、$a_2$ 与 $a_3$、......、$a_{n-1}$ 与 $a_n$ 以及 $a_n$ 与 $a_1$ 都通过化学键相连,但它们之间却没有其他化学键相连的情况。

现在科学家将 SHTSC 的原子由 $1$ 到 $n$ 标号，并告诉你 SHTSC 的初始形态以及原子之间的化学键变化情况，他们想知道在实验过程中的某些时刻 SHTSC 分裂成了多少个分子？
## 输入格式

第一行两个整数 $n, m$。表示 SHTSC 的总原子个数以及初始的化学键数。  
从第二行开始的 $m$ 行,每行两个整数 $a, b \ (1 \leq a,b \leq n)$。表示编号为 $a, b$ 的两个原子在初始状态中有化学键相连。数据保证每对 $a, b$ 只出现一次。  
第 $m+2$ 行有一个整数 $q$。表示实验的总操作数。  
之后 $q$ 行中的每一行为以下三种操作当中的一种：
1. ``A i j`` 表示 $i$ 号原子与 $j$ 号原子之间形成了一条新的化学键;
2. ``D i j`` 表示 $i$ 号原子与 $j$ 号原子之间原有的化学键断裂了;
3. ``Q`` 询问当前 SHTSC 分裂成了多少个不同的分子。
数据保证所有的实验操作都是合法的。
## 输出格式

对于每个 $Q$ 操作,输出一行一个整数,为相应时刻的分子个数。
## 样例

### 样例输入 #1
```
7 10
1 2
2 3
3 4
4 1
1 3
2 4
5 6
6 7
7 5
2 5
10
Q
D 2 5
Q
D 5 6
D 5 7
Q
A 2 5
Q
A 5 6
Q
```
### 样例输出 #1
```
1
2
3
2
1
```
## 提示

对于 30%的数据，$n, q\leq 1000$。

对于 100%的数据，$n\leq 5000,m\leq 200000,q\leq 10000$。


---

---
title: "[AHOI2013] 找硬币"
layout: "post"
diff: 提高+/省选-
pid: P5228
tag: ['2013', '各省省选', '安徽', 'O2优化']
---
# [AHOI2013] 找硬币
## 题目描述

小蛇是金融部部长。最近她决定制造一系列新的货币。假设她要制造的货币的面值为 $x_1~,~x_2~,~x_3...$ 那么 $x_1$ 必须为 $1$，$x_b$ 必须为 $x_a$ 的正整数倍（$b~>~a$）。例如 $1~,~5~,~125~,~250$ 就是一组合法的硬币序列，而 $1~,~5~,~100~,~125$ 就不是。不知从哪一天开始，可爱的蛇爱上了一种萌物——兔纸！从此，小蛇便走上了遇上兔纸娃娃就买的不归路。某天，小蛇看到了 $N$ 只可爱的兔纸，假设这 $N$ 只兔纸的价钱分别是 $a_1~,~a_2~...~a_N$。现在小蛇想知道，在哪一组合法的硬币序列下，买这N只兔纸所需要的硬币数最少。买兔纸时不能找零。
## 输入格式

第一行，一个整数 $N$，表示兔纸的个数
第二行，$N$ 个用空格隔开的整数，分别为 $N$ 只兔纸的价钱
## 输出格式

一行，一个整数，表示最少付的钱币数。
## 样例

### 样例输入 #1
```
2
25 102
```
### 样例输出 #1
```
4
```
## 提示

$1~\leq~N~\leq~50$

$1~\leq~a_i~\leq~10^5$


---

---
title: "[JSOI2013] 旅行时的困惑"
layout: "post"
diff: 提高+/省选-
pid: P5258
tag: ['贪心', '2013', '各省省选', '江苏', 'O2优化', '上下界网络流']
---
# [JSOI2013] 旅行时的困惑
## 题目描述

Waldives 有 $N$ 个小岛。目前的交通系统中包含 $N-1$ 条快艇专线，每条快艇专线连接两个岛。这 $N-1$ 条快艇专线恰好形成了一棵树。

由于特殊的原因，所有 $N-1$ 条快艇专线都是单向的。这导致了很多岛屿之间
不能相互到达。因此，Waldives 政府希望新建一些公交线路，使得建设完毕后，任意两个小岛都可以互相到达。为了节约开支，政府希望建设最少的公交线路。 

同时，出于规划考虑，每一条公交线路都有如下的要求：
> 1、每一条交通线路包含若干条连续的快艇专线，你可以认为一条公交线路
对应树上的一条路径，而其所包含的若干快艇专线则对应树上被这条路
径所覆盖的树边（也就是之前已经存在的某个快艇专线）；
>
> 2、显然一条交通线路只能覆盖树上任意一条边至多一次；
>
> 3、公交线路中所包含的每一个快艇专线都是有方向的，并且与其所覆盖的
树边的方向相反；
>
>4、不同的公交线路可以覆盖树上相同的点或者相同的边。

Waldives 的 $N$ 个岛屿分别从 $0$ 到 $N-1$ 编号。现在给出 Waldives 已有的快艇专线信息，请计算最少所需要新建的交通线路的数量。
## 输入格式

第一行包含一个整数 $N$。

接下来 $N-1$行，每行包含两个整数 $x,~y$。表示存在一条从岛屿 $x$ 开往岛屿 $y$ 的快艇专线。
## 输出格式

输出一行一个整数，表示需要建设的最少的交通线路数量。
## 样例

### 样例输入 #1
```
4
0 1
1 2
1 3
```
### 样例输出 #1
```
2
```
## 提示

$1~\leq~N~\leq~10^5$


---

---
title: "[JSOI2013] 超立方体"
layout: "post"
diff: 提高+/省选-
pid: P5260
tag: ['2013', '各省省选', '江苏', 'Special Judge', '状压 DP']
---
# [JSOI2013] 超立方体
## 题目背景

超立方体是立方体在高维空间内的拓展（其在 2 维情况下退化为正方形，1 维情况下退化成线段）。在理论计算机科学领域里，超立方体往往可以和 2 进制编码联系到一起。对理论计算机科学颇有研究的 Will 自然也会对超立方体有着
自己的思考。

![qwq](https://cdn.luogu.com.cn/upload/pic/54052.png)

上图就是在 0～4 维空间内超立方体所对应的图形。显然我们可以把超立方体的每个顶点看成一个点，每一条棱看成一条边，这样就会得到一个无向图，我们称之为超立方图。
## 题目描述

D 维空间内的超立方图有 $2^D$ 个点，我们把这些点从 $0$ 到 $2^D-1$ 依次编号。

有一个有趣而重要的充要结论是：一定存在一种编号的方式，使得图中任意两个有边相连的顶点的编号的 2 进制码中，恰好有一位不同。

在2维和3维空间内这个结论可以这样形象的理解：对于 2 维空间，我们只要把这个正方形放到第一象限内，使得 4 个顶点的坐标按逆时针顺序依次为 $(0,0),(1,0),(1,1),(0,1)$，然后再把坐标看成 2 位 2 进制数，依次将这 4 个点编号为  0,1,3,2即可。

对于 3 维空间，同样我们可以将立方体的一个顶点与原点重合，并使得所有棱均平行于坐标轴，然后分别确定这 8 个点的坐标，最后把 3 维空间内的坐标看成一个 3 位 2 进制数即可。对于 D 维空间，以此类推。

现在对于一个 $N$ 个点 $M$ 条边的无向图（每个点从 $0$ 到 $N-1$ 编号），Will 希望知道这个图是否同构于一个超立方图。
## 输入格式

第一行包含一个整数 $Q$ 表示此数据中一共包含 $Q$ 个询问。

接下来 $Q$ 组询问，每一组询问的输入格式如下：

第一行包含两个整数 $N$ 和 $M$，接下来 $M$ 行，每行 2 个不同的整数 $x,y$，表示图中存在一条无向边连接编
号为 $x$ 和 $y$ 的点（$0 \le x,y < N$）



## 输出格式

1、如果询问中给定的图不同构于任何一个超立方图，输出 $-1$；

2、如果同构于某一个超立方图，那么请给图中这 $N$ 个点重新编号，并在这一行输出 $N$ 个用空格隔开的整数，表示原图中每个点新的编号，使得重新编号后，满足题目中所述的结论。

注意：输出文件的每一行，要么仅包含一个整数 $-1$，要么则应包含一个由 $0$ 到 $N-1$ 这 $N$ 个数组成的排列。如果有多组解输出任意一个均可。
## 样例

### 样例输入 #1
```
3
2 2
0 1
1 0
4 4
0 1
1 2
2 0
0 3
8 12
2 3
2 6
7 6
1 7
4 1
3 4
0 2
7 3
5 6
5 1
5 0
4 0
```
### 样例输出 #1
```
-1
-1
0 6 1 5 4 2 3 7
```
## 提示

$Q~\leq~3,~N~\leq~32768,~M~\leq~1000000$


---

---
title: "[SNOI2017] 一个简单的询问"
layout: "post"
diff: 提高+/省选-
pid: P5268
tag: ['2017', '莫队', '各省省选', '差分']
---
# [SNOI2017] 一个简单的询问
## 题目描述

给你一个长度为 $N$ 的序列 $a_i$，$1\leq i\leq N$，和 $q$ 组询问，每组询问读入 $l_1,r_1,l_2,r_2$，需输出

$$
\sum\limits_{x=0}^\infty \text{get}(l_1,r_1,x)\times \text{get}(l_2,r_2,x)
$$

$ \text{get}(l,r,x)$ 表示计算区间 $[l,r]$ 中，数字 $x$ 出现了多少次。
## 输入格式

第一行，一个数字 $N$，表示序列长度。  
第二行，$N$ 个数字，表示 $a_1\sim a_N$。  
第三行，一个数字 $Q$，表示询问个数。  
第 $4\sim Q+3$ 行，每行四个数字 $l_1,r_1,l_2,r_2$，表示询问。
## 输出格式

对于每组询问，输出一行一个数字，表示答案。
## 样例

### 样例输入 #1
```
5
1 1 1 1 1
2
1 2 3 4
1 1 4 4
```
### 样例输出 #1
```
4
1
```
## 提示

对于 $20\%$ 的数据，$1\leq N,Q\leq 1000$；  
对于另外 $30\%$ 的数据，$1\leq a_i\leq 50$；  
对于 $100\%$ 的数据，$N,Q\leq 50000$，$1\leq a_i\leq N$，$1\leq l_1\leq r_1\leq N$，$1\leq l_2\leq r_2\leq N$。

数据范围与原题相同，但测试数据由 LibreOJ 自制，并非原数据。  

**注意：** 答案有可能超过 `int` 的最大值。


---

---
title: "[GXOI/GZOI2019] 旅行者"
layout: "post"
diff: 提高+/省选-
pid: P5304
tag: ['2019', '各省省选', '贵州', '广西']
---
# [GXOI/GZOI2019] 旅行者
## 题目描述

J 国有 $n$ 座城市，这些城市之间通过 $m$ 条单向道路相连，已知每条道路的长度。

一次，居住在 J 国的 Rainbow 邀请 Vani 来作客。不过，作为一名资深的旅行者，Vani 只对 J 国的 $k$ 座历史悠久、自然风景独特的城市感兴趣。  
为了提升旅行的体验，Vani 想要知道他感兴趣的城市之间「两两最短路」的最小值（即在他感兴趣的城市中，最近的一对的最短距离）。

也许下面的剧情你已经猜到了—— Vani 这几天还要忙着去其他地方游山玩水，就请你帮他解决这个问题吧。
## 输入格式

每个测试点包含多组数据，第一行是一个整数 $T$，表示数据组数。注意各组数据之间是互相独立的。

对于每组数据，第一行包含三个正整数 $n,m,k$，表示 J 国的 $n$ 座城市（从 $1 \sim n$ 编号），$m$ 条道路，Vani 感兴趣的城市的个数 $k$。

接下来 $m$ 行，每行包括 $3$ 个正整数 $x,y,z$，表示从第 $x$ 号城市到第 $y$ 号城市有一条长度为 $z$ 的单向道路。注意 $x,y$ 可能相等，一对 $x,y$ 也可能重复出现。

接下来一行包括 $k$ 个正整数，表示 Vani 感兴趣的城市的编号。
## 输出格式

输出文件应包含 $T$ 行，对于每组数据，输出一个整数表示 $k$ 座城市之间两两最短路的最小值。
## 样例

### 样例输入 #1
```
2
6 7 3
1 5 3
2 3 5
1 4 3
5 3 2
4 6 5
4 3 7
5 6 4
1 3 6
7 7 4
5 3 10
6 2 7
1 2 6
5 4 2
4 3 4
1 7 3
7 2 4
1 2 5 3
```
### 样例输出 #1
```
5
6

```
## 提示

### 样例解释
对于第一组数据，$1$ 到 $3$ 最短路为 $5$；$1$ 到 $6$ 最短路为 $7$；$3,6$ 无法到达，所以最近的两点为 $1,3$，最近的距离为 $5$。

对于第二组数据，$1$ 到 $2$ 最短路为 $6$；$5$ 到 $3$ 最短路为 $6$；其余的点均无法互相达，所以最近的两点为 $1,2$ 和 $5,3$，最近的距离为 $6$。

### 数据范围

$2 \le k \le n$，$1 \le x,y \le n$，$1 \le z \le 2 \times 10^9$，$T \leq 5$。

|测试点编号|$n$ 的规模|$m$ 的规模|约定|
|:-:|:-:|:-:|:-:|
|$1$|$\le 1,000$|$\le 5,000$|无|
|$2$|$\le 1,000$|$\le 5,000$|无|
|$3$|$\le 100,000$|$\le 500,000$|保证数据为有向无环图|
|$4$|$\le 100,000$|$\le 500,000$|保证数据为有向无环图|
|$5$|$\le 100,000$|$\le 500,000$|保证数据为有向无环图|
|$6$|$\le 100,000$|$\le 500,000$|无|
|$7$|$\le 100,000$|$\le 500,000$|无|
|$8$|$\le 100,000$|$\le 500,000$|无|
|$9$|$\le 100,000$|$\le 500,000$|无|
|$10$|$\le 100,000$|$\le 500,000$|无|

2024-12-18 管理员注：[在测试点五中可能存在自环](https://www.luogu.com.cn/discuss/1022672)。


---

---
title: "[TJOI2019] 甲苯先生的字符串"
layout: "post"
diff: 提高+/省选-
pid: P5337
tag: ['动态规划 DP', '2019', '各省省选', '矩阵加速', '天津']
---
# [TJOI2019] 甲苯先生的字符串
## 题目背景

TJOI2019 D1T1

源文件名：str.*

时间限制: 1s 内存限制: 128M 
## 题目描述

一天小甲苯得到了一条神的指示，他要把神的指示写下来，但是又不能泄露天机，所以他要用一种方法把神的指示记下来。神的指示是一个字符串，记为字符串$s_1$，$s_1$仅包含小写字母a − z。现在小甲苯想要写下神的指示，记为字符串$s_2$，$s_2$仅包含小写字母a − z，要求$s_1$中的相邻的两个字母不能在$s_2$中相邻地出现。现在给定$s_2$的长度，小甲苯想知道他有多少种方法可以将神的指示写下来。输出种类数结果对$10^9+7$取模。

## 输入格式

第一行只有一个正整数$n$，代表字符串$s_2$的长度，$n\le10^{15}$。 

第二行是一个字符串，代表字符串$s_1$。$s_1$的长度不超过$100000$。

## 输出格式

输出一个整数，表示小甲苯可以写出的字符串的总数。结果对$10^9+7$取模
## 样例

### 样例输入 #1
```
2
ab

```
### 样例输出 #1
```
675

```
## 提示

对于30%的数据$n\le100000$

对于100%的数据$n\le10^{15}$

说明：相邻要求顺序相同，如样例中的$s_2$里不能出现$ab$，且仅不能出现$ab$，但可以出现$ba$.


---

---
title: "[SDOI2019] 快速查询"
layout: "post"
diff: 提高+/省选-
pid: P5358
tag: ['2019', '各省省选', '山东', 'O2优化']
---
# [SDOI2019] 快速查询
## 题目描述

给定一个长度为 $n$ 的整数数列，里面的元素依次编号为 $a_1,~a_2,~a_3,~\dots,~a_n$。初始的时候，所有元素都为零。现在按照时间顺序提供了若干次关于这个数列的修改或询问，每一次修改或询问一定为以下六种情况之一：

- **1 i val** ：将 $a_i$ 赋值为给定整数 $val$；

- **2 val** ：将所有元素同时加上 $val$；

- **3 val** ：将所有元素同时乘上 $val$；

- **4 val** ：将所有元素同时赋值为 $val$；

- **5 i** ：询问第 $i$ 个元素 $a_i$ 现在的值是多少；

- **6** ：询问现在所有元素的和。
## 输入格式

为了避免读入太大，输入文件采取如下的形式。

第一行给定整数 $n$，表示给定数列长度为 $n$。
 第二行给定整数 $q$，并且之后的 $q$ 行，每一行提供一个修改或询问，输入的格式与题目所述一致，请参见样例。
 我们称上述给定的修改或询问为标准操作。
 之后给定一个整数 $t$，并且之后的 $t$ 行每行给定两个正整数 $a_i$ 和 $b_i$，这里的下标 $i$ 依次记为 $1$ 到 $t$ 。

你需要对初始值全为零的长度为 $n$ 的序列做总计 $t\times q$ 次操作。
 其中第 $\Big((i-1)q+j\Big)$ 次操作形如第 $\Big((a_i + j b_i) \mod{q} + 1\Big)$ 个给定的标准操作（$1\le i\le t$ 且 $1\le j\le q$）。
## 输出格式

输出一个整数，表示所有询问答案的累计和。

因为答案可能很大，只要求输出其结果关于 $p=10^7+19$ 取模后的值。

注意：若最终的累计和 ans 小于零，你应该输出 $\big((ans \mod{p})+p\big)\mod{p}$。
## 样例

### 样例输入 #1
```
7
28
6
4 -192321079
3 418379342
1 3 189801569
3 -840249197
4 -751917965
3 649799919
1 5 -92666141
6
4 451258008
5 1
4 696880327
3 772574465
6
4 301010289
3 480168068
5 3
5 2
4 840536237
5 5
5 4
1 7 -792284106
2 604521872
3 966540578
2 -381646699
3 -939378260
2 -20129935
6
2
0 1
197 199
```
### 样例输出 #1
```
2816930
```
## 提示

子任务$1$：（$50$分）$1\le  n\le 500000$，$1\le q\le 10^5$ 且 $1\le t\le 5$，所有在输入中出现的$val$  满足$-10^9\le val\le 10^9$，所有$a_i$和$b_i$满足$0\le a_i,b_i\le 10^9$

子任务$2$：（$50$分）$1\le n\le 10^9$，$1\le q\le 10^5$ 且 $1\le~t~\le~100$，所有在输入中出现的$val$ 满足$-10^9\le val\le  10^9$，所有$a_i$和$b_i$满足$0\le a_i,b_i\le 10^9$




---

---
title: "[JLOI2011] 不等式组"
layout: "post"
diff: 提高+/省选-
pid: P5482
tag: ['2011', '各省省选', '平衡树', '树状数组', '吉林']
---
# [JLOI2011] 不等式组
## 题目描述

旺汪与旺喵最近在做一些不等式的练习。这些不等式都是形如 $ax+b>c$ 的一元不等式。当然，解这些不等式对旺汪来说太简单了，所以旺喵想挑战旺汪。旺喵给出一组一元不等式，并给出一个数值。旺汪需要回答的是 $x=k$ 时成立的不等式的数量。聪明的旺汪每次都很快就给出了答案。你的任务是快速的验证旺汪的答案是不是正确的。
## 输入格式

输入第一行为一个正整数 $n$，代表接下来有 $n$ 行。

接下来每一行可能有 $3$ 种形式：

1. `Add a b c`：表明要往不等式组添加一条不等式 $ax+b>c$。
2. `Del i`：代表删除第 $i$ 条添加的不等式（最先添加的是第 $1$ 条）。
3. `Query k`：代表一个询问，即当 $x=k$ 时，在当前不等式组内成立的不等式的数量。

注意：一开始不等式组为空，$a,b,c,i,k$ 均为整数，且保证所有操作均合法，不会出现要求删除尚未添加的不等式的情况，但可能重复删除同一条不等式。
## 输出格式

对于每一个询问 `Query k`，输出一行一个整数，代表询问的答案。
## 样例

### 样例输入 #1
```
9
Add 1 1 1
Add -2 4 3
Query 0
Del 1
Query 0
Del 2
Query 0
Add 8 9 100
Query 10
```
### 样例输出 #1
```
1
1
0
0
```
## 提示

#### 样例 1 说明

第 $1$ 条添加到不等式组的不等式为 $x+1>1$，第 $2$ 条为 $−2x+4>3$。所以第 $1$ 个询问的时候只有第 $2$ 条不等式可以成立，故输出 `1`。

然后删除第 $1$ 条不等式，再询问的时候依然是只有第 $2$ 条不等式可以成立，故输出 $1$ 。

再删除第 $2$ 条不等式后，因为不等式组里面没有不等式了，所以没有不等式可以被满足，故输出 $0$。

继续加入第 $3$ 条不等式 $8x+9>100$，当 $x=k=10$ 时有 $8\times 10+9=89<100$，故也没有不等式可以被满足，依然输出 $0$。

#### 数据规模与约定

- 对于 $20\%$ 的数据，保证 $n\leq 10^3$。
- 对于 $40\%$ 的数据，保证 $n\leq 10^4$。
- 对于 $100\%$ 的数据，保证 $1\leq n\leq 10^5$，$a,b,c\in[-10^8,10^8]$，$k\in[-10^6,10^6]$。


---

---
title: "[JLOI2011] 基因补全"
layout: "post"
diff: 提高+/省选-
pid: P5484
tag: ['动态规划 DP', '高精度', '2011', '各省省选', '吉林']
---
# [JLOI2011] 基因补全
## 题目描述

在生物课中我们学过，碱基组成了$DNA$（脱氧核糖核酸），他们分别可以用大写字母$A,C,T,G$表示，其中$A$总与$T$配对，$C$总与$G$配对。两个碱基序列能相互匹配，当且仅当它们等长，并且任意相同位置的碱基都是能相互配对的。例如$ACGTC$能且仅能与$TGCAG$配对。一个相对短的碱基序列能通过往该序列中任意位置补足碱基来与一个相对长的碱基序列配对。补全碱基的位置、数量不同，都将视为不同的补全方案。现在有两串碱基序列$S$和$T$，分别有$n$和$m$个碱基($n\geq m$)，问一共有多少种补全方案。
## 输入格式

数据包括三行。
第一行有两个整数$n$，$m$，表示碱基序列的长度。
第二行包含$n$个字符，表示碱基序列$S$。
第三行包含$m$个字符，表示碱基序列$T$。
两个碱基序列的字符种类只有$A,C,G,T$这$4$个大写字母。
## 输出格式

答案只包含一行，表示补全方案的个数。
## 样例

### 样例输入 #1
```
10 3
CTAGTAGAAG
TCC
```
### 样例输出 #1
```
4
```
## 提示

样例解释：  
$TCC$的$4$种补全方案（括号中字符为补全的碱基）  
$(GA)TC(AT)C(TTC)$  
$(GA)TC(ATCTT)C$  
$(GA)T(CAT)C(TT)C$  
$(GATCA)TC(TT)C$  

数据范围：  
对于$30\% $数据，$n\leq 1000,m\leq 2$  
对于$50\% $数据，$n\leq 1000,m\leq 4$  
对于$100\% $数据，$n\leq 2000,m\leq n$  


---

---
title: "[JLOI2010] 世界杯租房"
layout: "post"
diff: 提高+/省选-
pid: P5486
tag: ['动态规划 DP', '2010', '各省省选', '吉林', '区间 DP']
---
# [JLOI2010] 世界杯租房
## 题目描述

南非世界杯组委会指定了在此期间可提供的一些旅馆供球迷租赁，名为阿凡达的即是其中一所。因为阿凡达旅馆房子的数目不超过$26$，所以它们可以用$26$个大写字母表示。  
有一天，刘经理的电话响了，他接到了一个租赁房屋的请求，要求从$6$月$12$日晚起租到$6$月$19$日中午。于是他察看了预定表，但是并没有发现一间房屋能够直接满足要求。比如房主可能因为一些私人原因需要留在自己的房子中，所以这个游客不得不在其中的一间先住上几天再搬到另一间住上几天。他详细检查了预定表后，对旅客说：“我将你先在$B$安置$3$天，再将你安排到$F$去度过剩余的旅途。”  
你的目标是使得游客从一间房屋搬到另一间房屋的次数最少。  
注意在旅馆的计费中，总是将某一天的晚上到第二天的中午视作一天。  
## 输入格式

输入文件包括多组数据。每组数据输入文件第一行包括两个整数$M$和$N$。$M$表示日程表上的天数，$N$表示公寓的数目。天数不超过$100$天，从1开始计数，公寓不超过$26$个，从$A$开始计数。  
接下来$M$行，每行包括$N$个字母，表示从第i天晚到次日中午，该公寓是否已经被出租，$X$代表被出租，$O$代表未被出租。  
最后一行包括两个整数$s,t$，代表旅客从第$s$天晚入住到第$(t+1)$天中午结束旅行。$1\leq s<t\leq M+1$。  
$M=N=0$标志着文件的结束。  
## 输出格式

对于每一组数据，首先打印测试数据的编号，冒号和一个空行。接下来输出换房次数最少的方案，每一行使用如下格式：
$<unit>: <start date>-<end date>$
其中$<unit>$为房屋编号，$<start data>$和$<end data>$分别为该旅客入住和离开该房屋时间。
注意，如果存在多种方案满足换房次数最少，输出其中字典序最小的方案。  
如不存在这样的方案，输出一行”$Not\ available$”。  
每两组输出之间以一个空行隔开。输出文件的末尾不要加空行。  
## 样例

### 样例输入 #1
```
10 7
XXXXXXX
XOXXXXO
XOXXXXO
XOXXXOX
OXXOXOX
XOXOXOX
OXXOXOX
OXXXXOX
XXXXXXX
XXXXXXX
2 9
0 0
```
### 样例输出 #1
```
Case 1:

B: 2-5
F: 5-9
```


---

---
title: "[JSOI2015] 最大公约数"
layout: "post"
diff: 提高+/省选-
pid: P5502
tag: ['暴力数据结构', '2015', '各省省选', '江苏', '分治']
---
# [JSOI2015] 最大公约数
## 题目描述

给定一个长度为 $N$ 的正整数序列 $A_i$ 。

对于其任意一个连续的子序列 $A_l,A_{l+1},...,A_r$ ，我们定义其权值 $W(L,R)$ 为其长度与序列中所有元素的最大公约数的乘积，即 $W(L,R) = (R-L+1) × \gcd (A_l,...,A_r)$。

`JYY` 希望找出权值最大的子序列。
## 输入格式

输入一行包含一个正整数 $N$ 。

接下来一行，包含 $N$ 个正整数，表示序列 $A_i$ 。
 
## 输出格式

输出文件包含一行一个正整数，表示权值最大的子序列的权值。
## 样例

### 样例输入 #1
```
5
30 60 20 20 20
```
### 样例输出 #1
```
80
```
## 提示

$1 \le  A_i \le  10^{12}, 1 \le  N \le  100000$


---

---
title: "[SDOI2008] 红黑树"
layout: "post"
diff: 提高+/省选-
pid: P5566
tag: ['动态规划 DP', '2008', '各省省选', '山东']
---
# [SDOI2008] 红黑树
## 题目描述

红黑树是一类特殊的二叉搜索树，其中每个结点被染成红色或黑色。若将二叉搜索树结点中的空指针看作是指向一个空结点，则称这类空结点为二叉搜索树的前端结点。并规定所有前端结点的高度为 $-1$。

一棵红黑树是满足下面“红黑性质”的染色二叉搜索树：

1. 每个结点被染成红色或黑色；
2. 每个前端结点为黑色结点；
3. 任一红结点的子结点均为黑结点；
4. 在从任一结点到其子孙前端结点的所有路径上具有相同的黑结点数。

从红黑树中任一结点 $x$ 出发（不包括结点 $x$），到达一个前端结点的任意一条路径上的黑结点个数称为结点 $x$ 的黑高度，记作 $bh(x)$ 。红黑树的黑高度定义为其根结点的黑高度。

给定正整数 $N$，试设计一个算法，计算出在所有含有 $N$ 个结点的红黑树中，红色内结点个数的最小值和最大值。
## 输入格式

输入一个数字 $N$。
## 输出格式

输出第一行为红色内节点的个数最小值；第二行为红色内节点的个数最大值。
## 样例

### 样例输入 #1
```
8
```
### 样例输出 #1
```
1
4
```
## 提示

$N \leq 5000$


---

---
title: "[SDOI2008] 立方体覆盖"
layout: "post"
diff: 提高+/省选-
pid: P5567
tag: ['2008', '线段树', '各省省选', '山东']
---
# [SDOI2008] 立方体覆盖
## 题目描述

A 君近日为准备省队选拔，特意进行了数据结构的专项训练。训练过程中就遇到了“矩形面积并”这道经典问题，即：给出 $N$ 个各边与坐标轴平行（垂直）的矩形，求矩形覆盖的面积之和。A 君按纵坐标建立线段树后按横坐标扫描计算，轻易 AC 了这道题，时间复杂度为 $O(N\log N)$。

为了强化训练，A 君将问题推广到三维空间中，即：给出 $N$ 个各棱与坐标轴平行（垂直）的立方体，求立方体覆盖的体积之和。为了简化问题，令立方体均退化为正立方体，用四元组 $(x, y, z, r)$ 表示一个立方体，其中 $x, y, z$ 为立方体的中心点坐标，$r$ 为中心点到立方体各个面的距离（即立方体高的一半）。

这次可难住了 A 君，只好请你——未来的金牌——来帮助他了。
## 输入格式

第一行是一个正整数 $N$。

以下 $N$ 行每行四个整数 $x, y, z, r$。
## 输出格式

输出覆盖的总体积。
## 样例

### 样例输入 #1
```
3
0 0 0 3
1 -1 0 1
19 3 5 6
```
### 样例输出 #1
```
1944
```
## 提示

$ N \leq 100, -1000 \leq x,y,z \leq 1000, r \leq 200$


---

---
title: "[SDOI2008] 校门外的区间"
layout: "post"
diff: 提高+/省选-
pid: P5568
tag: ['2008', '线段树', '各省省选', '山东']
---
# [SDOI2008] 校门外的区间
## 题目描述

受校门外的树这道经典问题的启发，A君根据基本的离散数学的知识，抽象出 $5$ 种运算维护集合 $S$ （$S$ 初始为空）并最终输出 $S$。现在，请你完成这道校门外的树之难度增强版——校门外的区间。

五种运算如下：

- `U T`：$S = S \cup T$
- `I T`：$S = S \cap T$
- `D T`：$S = S - T$
- `C T`：$S = T - S$
- `S T`：$S = S \oplus T$

集合的基本运算操作定义如下：

- $A \cup B$：$\{x | x \in A \vee x \in B\}$
- $A \cap B$：$\{x | x \in A \wedge x \in B\}$
- $A - B$：$\{x | x \in A \wedge x \notin B\}$
- $A \oplus B$：$(A-B)\cup (B-A)$
## 输入格式

输入 $M$ 行。每行第一个字母描述操作类型，后面给出一个区间（区间用 `(a,b)`，`(a,b]`，`[a,b)`，`[a,b]` 表示）。
## 输出格式

输出一行若干区间，代表集合 $S$，**所有区间按递增顺序输出，相邻两个区间之间以一个空格隔开**。

如果区间为空，输出 `empty set`。
## 样例

### 样例输入 #1
```
U [1,5]
D [3,3]
S [2,4]
C (1,5)
I (2,3]
```
### 样例输出 #1
```
(2,3)
```
## 提示

$ 0 \leq a,b \leq 65535, M \leq 70000$


---

---
title: "[GZOI2017] 取石子游戏"
layout: "post"
diff: 提高+/省选-
pid: P5675
tag: ['动态规划 DP', '博弈论', '2017', '各省省选', 'O2优化', '贵州']
---
# [GZOI2017] 取石子游戏
## 题目背景

GZOI2017 D1T1
## 题目描述

Alice 和 Bob 在玩一个古老的游戏。现在有若干堆石子，Alice 和 Bob 轮流取，每次可以选择其中某一堆的石子中取出任意颗石子，但不能不取，谁先取完使得另一个人不能取了算赢。

现在场地上有 $N$ 堆石子，编号为 $1$ 至 $N$。Alice 很快发现了这个游戏存在一些固定的策略。阴险的 Alice 想赢得这场比赛就来找到主办方你，希望你在这 $N$ 堆石子中选出若干堆石子作为最后游戏用的石子堆并使得 Alice 能获得胜利。你自然不想让 Alice 得逞，所以你提出了一个条件：Alice 在这个游戏中第一次取的那堆石子的编号需要你来指定（仅指定取的石子堆编号，不指定第一次取多少个，这个指定的石子堆必然包含在最后游戏用的石子堆中）。

现在你很好奇，你想算算有多少种方案让 Alice 不能获胜。注意，即使选出的石子堆的编号的集合完全相同，指定第一次取的石子堆的编号不同，也认为方案是不同的。
## 输入格式

第一行，一个正整数 $N$，表示石子堆数。

第二行，$N$ 个正整数，表示各堆石子的数量，按编号 $1$ 至 $N$ 依次给出。
## 输出格式

一行，表示方案数。答案对 $10^9+7$ 取模。
## 样例

### 样例输入 #1
```
3
2 4 5
```
### 样例输出 #1
```
5
```
### 样例输入 #2
```
3
1 2 2
```
### 样例输出 #2
```
6
```
## 提示

【样例 $1$ 解释】

第一种：选编号 $1$ 和编号 $2$，指定编号 $1$。

第二种：选编号 $1$ 和编号 $3$，指定编号 $1$。

第三种：选编号 $1$、编号 $2$ 和编号 $3$，指定编号 $2$。

第四种：选编号 $1$、编号 $2$ 和编号 $3$，指定编号 $3$。

第五种：选编号 $2$ 和编号 $3$，指定编号 $2$。

【数据约束】

| 数据编号 | $N$ | 每堆石子数量 |
| :-: | :-: | :-: |
| $1$ | $\le 5$ | $\le 5$ |
| $2$ | $\le 10$ | $\le 10$ |
| $3$ | $\le 100$ | $\le 100$ |
| $4$ | $\le 200$ | $\le 200$ |
| $5$ | $\le 200$ | $\le 200$ |


---

---
title: "[GZOI2017] 配对统计"
layout: "post"
diff: 提高+/省选-
pid: P5677
tag: ['2017', '各省省选', '树状数组', 'O2优化', '排序', '贵州']
---
# [GZOI2017] 配对统计
## 题目背景

GZOI2017 D1T3
## 题目描述

给定 $n$ 个数 $a_1,\cdots,a_n$。

对于一组配对 $(x,y)$，若对于所有的 $i=1,2,\cdots,n$，满足 $|a_x-a_y|\le|a_x-a_i|(i\not=x)$，则称 $(x,y)$ 为一组好的配对（$|x|$ 表示 $x$ 的绝对值）。

给出若干询问，每次询问区间 $[l,r]$ 中含有多少组好的配对。

即，取 $x,y$（$l\le x,y\le r$ 且 $x\not=y$），问有多少组 $(x,y)$ 是好的配对。
## 输入格式

第一行两个正整数 $n,m$。

第二行 $n$ 个数 $a_1,\cdots,a_n$。

接下来 $m$ 行，每行给出两个数 $l,r$。
## 输出格式

$Ans_i$ 表示第 $i$ 次询问的答案，输出 $\sum_{i=1}^m\limits Ans_i\times i$ 即可。
## 样例

### 样例输入 #1
```
3 2
2 1 3
1 2
1 3
```
### 样例输出 #1
```
10
```
## 提示

**【样例解释】**

第一次询问好的配对有：$(1,2)(2,1)$；

第二次询问好的配对有：$(1,2)(2,1),(1,3)(3,1)$；

答案 $=2\times 1+4\times 2=10$。

**【数据约束】**

![](https://cdn.luogu.com.cn/upload/image_hosting/32ms79n8.png)


---

---
title: "[GZOI2017] 等差子序列"
layout: "post"
diff: 提高+/省选-
pid: P5679
tag: ['2017', '各省省选', 'O2优化', '枚举', '贵州']
---
# [GZOI2017] 等差子序列
## 题目背景

GZOI2017 D2T2
## 题目描述

给出一个长度为 $N$ 的正整数序列，问是否存在一个长度不小于三的等差子序列。
## 输入格式

第一行一个正整数 $T$，表示数据组数。

接下来 $T$ 组数据，每组数据第一行一个正整数 $N$，表示序列长度，接下来第二行有 $N$ 个正整数，依次表示序列中的数。
## 输出格式

对于每组数据，输出单独的一行 `YES` 或 `NO`。
## 样例

### 样例输入 #1
```
3
4
4 3 2 1
2
1 100
5
1 17 9 18 17
```
### 样例输出 #1
```
YES
NO
YES
```
## 提示

【数据约束】

对于 $20\%$的数据：$N\le 100$。

对于 $40\%$的数据：$N\le 10^3$。

对于 $100\%$的数据：$1\le T \le 10$，$1\le N\le 2\times 10^4$，序列中的数 $\le 2\times 10^4$。


---

---
title: "[JSOI2016] 无界单词"
layout: "post"
diff: 提高+/省选-
pid: P5770
tag: ['2016', '各省省选', '江苏']
---
# [JSOI2016] 无界单词
## 题目描述

对于一个单词 $S$ ，如果存在一个长度 $l$，满足 $0 < l < |S|$，并且使得 $S$ 长度为 $l$ 的前缀与 $S$ 长度为 $l$ 的后缀相同，JYY 则称 $S$ 是有界的。比如 `aabaa` 和 `ababab` 就都是有界的字符串。如果一个单词不存在这样的 $l$ ，则 JYY 称之为无界单词。

现在考虑所有仅由字母 `a` 和 `b` 组成的长度为 $N$ 的字符串，JYY想知道：

1. 一共有多少个无界单词？
2. 这些无界单词中，按字典序排列第 $K$ 小的单词是哪一个？
## 输入格式

**本题有多组数据。**

第一行包含一个正整数 $T$，表示测试数据的组数；

接下来 $T$ 行，每行包含两个正整数 $N$ 和 $K$，表示一组测试数据。
## 输出格式

对于每一个测试数据，输出两行。

其中第一行包含一个整数，表示长度为 $N$ 的无界单词的数量；

其中第二行包含一个长度为 $N$ 的字符串，表示第 $K$ 小的无界单词。
## 样例

### 样例输入 #1
```
5
5 1
5 2
5 3
5 4
5 5

```
### 样例输出 #1
```
12
aaaab
12
aaabb
12
aabab
12
aabbb
12
ababb

```
## 提示

对于 $20\%$ 的数据，满足 $N \le 20 $；

对于全部数据，满足 $1 \le T \le 5$，$1 \le N \le 64$，并且保证对于任意测试数据，总存在第 $K$ 小的无界单词。


---

---
title: "[JSOI2016] 反质数序列"
layout: "post"
diff: 提高+/省选-
pid: P5771
tag: ['2016', '各省省选', '江苏']
---
# [JSOI2016] 反质数序列
## 题目描述

对于一个长度为 $L \ge 2$ 的序列 $X:\{x_1,x_2,...,x_L\}$，如果满足对于任意 $1 \le i < j \le L$，均有 $x_i+x_j$ 不为质数，则 JYY 认为序列 $X$ 是一个「反质数序列」。

JYY 有一个长度为 $N$ 的序列 $A:\{a_1,a_2,...,a_N\}$，他希望从中选出一个包含元素最多的**子序列**，使得这个子序列是一个反质数序列。
## 输入格式

输入第一行包含一个正整数 $N$；

接下来一行包含 $N$ 个正整数，依次描述 $a_1,a_2,...,a_N$。
## 输出格式

输出一行一个整数，表示最长反质数子序列的长度。输入保证存在反质数子序列。
## 样例

### 样例输入 #1
```
6
1 2 2 3 4 10

```
### 样例输出 #1
```
4

```
## 提示

对于 $10\%$ 的数据，满足 $N \le 10$；

对于 $40\%$ 的数据，满足 $N \le 150$；

对于 $80\%$ 的数据，满足 $N \le 1000$；

对于 $100\%$ 的数据，满足 $2 \le N \le 3000$，$1 \le a_i \le 10^5$。


---

---
title: "[JSOI2016] 病毒感染"
layout: "post"
diff: 提高+/省选-
pid: P5774
tag: ['2016', '各省省选', '江苏']
---
# [JSOI2016] 病毒感染
## 题目描述

JOSI 的边陲小镇爆发了严重的 Jebola 病毒疫情，大批群众感染生命垂危。计算机科学家 JYY 采用最新的算法紧急研制出了 Jebola 疫苗，并火速前往灾区救治患者。

一共有 $N$ 个小镇爆发了 Jebola 疫情。这些小镇由于地处边陲，仅仅通过一条长直公路连接。方便起见我们将这些小镇按照公路连接顺序由 $1$ 编号到 $N$。JYY 会在第一天一早抵达 $1$ 号小镇。

一开始在 $i$ 号小镇，有 $a_i$ 名患者感染了 Jebola 病毒。

每一天 JYY 可以选择：

1. 花费一天时间彻底治愈 JYY 目前所在的村庄的所有 Jebola 患者。这一天不会有任何患者死去；
2. 花费一天的时间前往一个相邻的村庄。

当一天开始时，如果一个村庄里有 $k$ 个 Jebola 患者，那么这一天结束时，这 $k$ 个患者会感染另外 $k$ 个这个村子里的健康村民并死去。所以对于 $i$ 号村庄，只要这个村庄没有被 JYY 彻底消灭疫情，那么每一天都会有 $a_i$ 个村民死去。

JYY 希望采用措施使得疫情被整体消灭时，总共死去的村民数量尽量少。

为了达成这一目标，JYY 有时会选择抵达一个村庄但是并不对村民进行施救。这样的行为如果不加限制，往往会造成更加严重的后果。

试想这样的情形：假设当 JYY 第一次抵达村庄 $i$，未作救治并直接前往了另一个村庄。那么由于 $i$ 村庄的人们求生心切，一旦当 JYY 朝向靠近 $i$ 村庄的方向前行时，$i$ 村庄的村民就会以为 JYY 是来救他们了，而产生巨大的期望。之后倘若 JYY 再次掉头朝着远离 $i$ 村庄的方向行进，那么 $i$ 村庄的村民就会因为巨大的失落而产生绝望的情绪。

为了避免这种情况，JYY 对他的行程做了如下规定：

假设 JYY 进入 $i$ 村庄并在第二天立即离开（村庄 $i$ 的疫情并未治愈）。如果在之后的某一天，JYY 从村庄 $j$ 前往村庄 $k$，并满足 $|k-i| \lt |k-j|$。那么在之后的日子里 JYY 只能朝着 $i$ 村庄前进直到抵达 $i$ 村庄并立即治愈该村的患者。在前往 $i$ 村庄的过程中，JYY 可以选择将途经村庄的疫情治愈。

比如，如果 JYY 有如下行程：

第一天：从村庄 $1$ 前往村庄 $2$；

第二天：从村庄 $2$ 前往村庄 $3$；

第三天：治愈村庄 $3$；

第四天：前往村庄 $2$。

此时 JYY 对于之后三天的行程只有唯一一种选择：

第五天：治愈村庄 $2$；

第六天：前往村庄 $1$；

第七天：治愈村庄 $1$。

JYY 想知道在治愈所有村庄之前，至少会有多少村民因 Jebola 死去。
## 输入格式

输入第一行包含一个正整数 $N$；

接下来一行包含 $N$ 个整数，分别为 $a_1,a_2,...,a_N$。
## 输出格式

输出一行一个整数，表示最优行程安排下会死去的村民数量。
## 样例

### 样例输入 #1
```
6
40 200 1 300 2 10
```
### 样例输出 #1
```
1950
```
## 提示

**样例说明**

我们用 $C(k)$ 表示治愈 $k$ 号村庄，$i \rightarrow j$ 表示从村庄 $i$ 前进到村庄 $j$，用逗号分隔每一天的行程安排，那么样例中的最优策略为：

$1 \rightarrow 2 , C(2),2 \rightarrow 3 , 3 \rightarrow 4 , C(4) , 4 \rightarrow 3 , C(3) , 3 \rightarrow 2 , 2 \rightarrow 1 , C(1) , 1 \rightarrow 2 , 2 \rightarrow 3 , 3 \rightarrow 4 , 4 \rightarrow 5 , 5 \rightarrow 6 , C(6) , 6 \rightarrow 5 , C(5)$;

整个过程耗时 $18$ 天。

------

**数据范围**

对于 $10\%$ 的数据，满足 $N \le 10$；

对于 $30\%$ 的数据，满足 $N \le 20$；

对于 $50\%$ 的数据，满足 $N \le 60$；

对于 $100\%$ 的数据，满足 $1 \le N \le 3000$，$1 \le a_i \le 10^9$。



---

---
title: "[CQOI2008] 位统计"
layout: "post"
diff: 提高+/省选-
pid: P5783
tag: ['2008', '重庆', '各省省选']
---
# [CQOI2008] 位统计
## 题目描述

给出 $N$ 个 $[0, 65535]$ 的整数，编程支持以下操作：


修改操作：```C d```，所有数增加 $d$。如果超过 $65535$，把结果模 $65536$。（$0\le d\le 65535$）

查询操作：```Q i```，统计有多少整数的第 $i$ 位非 $0$，换句话说，有多少个整数与 $2^i$ 的“按位与”操作值为正。（$0\le i\le 15$）

输出所有查询操作的统计值。
## 输入格式

第一行为两个正整数 $N$ 和 $M$，即整数的个数和操作的个数。

第二行包含 $N$ 个 $[0,65535]$ 的整数。

以下 $M$ 行为各操作，格式如题所述。
## 输出格式

输出所有 $Q$ 操作的统计值。
## 样例

### 样例输入 #1
```
3 5
1 2 4
Q 1
Q 2
C 1
Q 1
Q 2
```
### 样例输出 #1
```
1
1
2
1
```
## 提示

| 测试点编号 | 1 | 2 | 3 | 4 | 5 | 6 | 7 | 8 | 9 | 10 |
| :----------: | :----------: | :----------: | :----------: | :----------: | :----------: | :----------: | :----------: | :----------: | :----------: | :----------: |
| $N$ | $3$ | $10$ | $100$ | $1000$ | $10000$ | $20000$ | $50000$ | $100000$ | $100000$ | $100000$ |
| $M$ | $3$ | $10$ | $100$ | $1000$ | $10000$ | $20000$ | $50000$ | $50000$ | $100000$ | $200000$ |



---

---
title: "[CQOI2008] 矩阵的个数"
layout: "post"
diff: 提高+/省选-
pid: P5784
tag: ['2008', '重庆', '各省省选']
---
# [CQOI2008] 矩阵的个数
## 题目描述

给出一个 $n\times 3$ 的非负整数矩阵的各行各列之和，统计有多少个矩阵满足此条件。输出答案模 $10^{17}$ 的值。
## 输入格式

第一行包含四个正整数 $N$，$c_1$，$c_2$，$c_3$，即行数与三列之和。第二行包含 $N$ 个正整数，即各行三个数之和。每行每列之和均不超过 $125$。

## 输出格式

仅一个数，满足条件的矩阵个数模 $10^{17}$ 的值。
## 样例

### 样例输入 #1
```
3 2 3 4
1 2 6

```
### 样例输出 #1
```
17
```
## 提示

| 测试点编号 | 1 | 2 | 3 | 4 | 5 | 6 | 7 | 8 | 9 | 10 |
| :----------: | :----------: | :----------: | :----------: | :----------: | :----------: | :----------: | :----------: | :----------: | :----------: | :----------: |
| $N$ | $1$ | $2$ | $3$ | $10$ | $30$ | $50$ | $80$ | $120$ | $150$ | $200$ |



---

---
title: "[TJOI2017] 可乐（数据加强版）"
layout: "post"
diff: 提高+/省选-
pid: P5789
tag: ['2017', '各省省选', '矩阵乘法', '天津']
---
# [TJOI2017] 可乐（数据加强版）
## 题目背景

[原题](https://www.luogu.org/problem/P3758) 数据很弱，这个加强版卡掉了暴力的 DP 做法，并且补充了原题题面中缺少的 $\LaTeX$ 。
## 题目描述

加里敦星球的人们特别喜欢喝可乐。因而，他们的敌对星球研发出了一个可乐机器人，并且放在了加里敦星球的 $1$ 号城市上。这个可乐机器人有三种行为： 停在原地，去下一个相邻的城市，自爆。它每一秒都会随机触发一种行为。现在给加里敦星球城市图，在第 $0$ 秒时可乐机器人在 $1$ 号城市，问经过了 $t$ 秒，可乐机器人的行为方案数是多少？
## 输入格式

第一行输入两个正整数 $N,M$ ，$N$ 表示城市个数，$M$ 表示道路个数。  

接下来 $M$ 行输入 $u,v$ ，表示 $u,v$ 之间有一条双向道路。

最后输入时间 $t$ 。
## 输出格式

输出可乐机器人的行为方案数，答案可能很大，请输出对 $2017$ 取模后的结果。
## 样例

### 样例输入 #1
```
3 2
1 2
2 3
2
```
### 样例输出 #1
```
8
```
## 提示

【数据规模与约定】  

对于 $20\%$ 的数据， $n,m\leq 30$ ， $t\leq 1000$ ；  

对于 $50\%$ 的数据， $t\leq 10^6$；  

对于 $100\%$ 的数据， $n,m\leq 100$ ， $ t\leq 10^9$ .

【样例解释】

$1$ -> 爆炸

$1$ -> $1$ -> 爆炸

$1$ -> $2$ -> 爆炸

$1$ -> $1$ -> $1$

$1$ -> $1$ -> $2$

$1$ -> $2$ -> $1$

$1$ -> $2$ -> $2$

$1$ -> $2$ -> $3$


---

---
title: "[CQOI2011] 分金币"
layout: "post"
diff: 提高+/省选-
pid: P5817
tag: ['2011', '重庆', '各省省选']
---
# [CQOI2011] 分金币
## 题目描述

圆桌上坐着 $n$ 个人，每人有一定数量的金币，金币总数能被 $n$ 整除。每个人可以给他左右相邻的人一些金币，最终使
得每个人的金币数目相等。

你的任务是求出被转手的金币数量的最小值。
## 输入格式

第一行为整数 $n$（$ n \ge 3$）。

以下 $n$ 行每行一个正整数，按逆时针顺序给出每个人拥有的金币数。

## 输出格式

共一行，输出被转手金币数量的最小值。
## 样例

### 样例输入 #1
```
4
1
2
5
4

```
### 样例输出 #1
```
4

```
## 提示

**样例说明**

设四个人编号为 $1,2,3,4$。第 $3$ 个人给第 $2$ 个人 $2$ 个金币（变成 $1,4,3,4$），第 $2$ 个人和第 $4$ 个人分别给第 $1$ 个人 $1$ 个金币。

**数据范围**

对于 $100\%$ 的数据，$3 \le n \le 10^5$，$总金币数 \le 10^9$。


---

---
title: "[JSOI2013] 侦探 JYY"
layout: "post"
diff: 提高+/省选-
pid: P5954
tag: ['2013', '各省省选', '江苏']
---
# [JSOI2013] 侦探 JYY
## 题目描述

JSOI 的世界里一共有 $N$ 个不同的事件（依次由 $1$ 到 $N$ 编号），以及 $M$ 条线索。每一条线索对应一个二元组 $(x,y)$，表示事件 $x$ 发生会导致事件 $y$ 发生。

**注意： 线索是单向的，也就是如果 $y$ 发生了，并不代表 $x$ 一定会发生。**

线索是有传递性的， 即如果存在线索 $(x,y)$ 以及 $(y,z)$， 那么 $x$ 发生则会导致 $z$ 发生。

同时由于世界是合理的，任意一个事件 $x$ 一定不会通过某些线索导致事件 $x$ 本身发生。

另外，整个世界仅包含这 $M$ 条线索， 我们不认为一些事件会凭空发生（就像福尔摩斯永远不会认为诡异的凶杀案是源于神的谴责）。具体而言，对于某个事件 $x$， 如果 $x$ 发生了，并且存在某个事件可能导致 $x$ 发生，那么一定至少有一个可能导致 $x$ 发生的事件发生了。

现在已知世界上的 $M$ 条线索，以及 $D$ 个已经发生的事件，那么由此推断，
哪些事件一定已经发生了呢？
## 输入格式

第一行包含用空格隔开的三个整数，分别为 $N$，$M$ 和 $D$。

接下来 $M$ 行，每行两个整数 $x$，$y$ 表示线索 $(x,y)$， 满足 $1\leq x,y\leq N$。

接下来 $D$ 行为 $D$ 个 $1$ 到 $N$ 之间不同的整数， 表示已知的已经发生的事件。
## 输出格式

包含一行至少 $D$ 个由空格隔开的严格递增的正整数， 表示根据 $M$ 条线索以及 $D$ 个已知事件 JYY 所能推断出的一定发生了的事件。
## 样例

### 样例输入 #1
```
3 2 1
1 3
2 3
3
```
### 样例输出 #1
```
3
```
### 样例输入 #2
```
4 4 1
1 2
1 3
2 4
3 4
4
```
### 样例输出 #2
```
1 2 3 4
```
## 提示

### 样例解释

在第一个样例中，由于事件 $1$ 和事件 $2$ 这两个事件中的任何一个发生都会导致事件 $3$ 发生，所以我们并不能确定到底哪个事件发生了。

在第二个样例中，由于事件 $4$ 发生了，所以事件 $2$ 和事件 $3$ 中至少有一个发生了。而不论哪一个发生了，都可以推出事件 $1$ 发生了。

最终由于事件 $1$ 发生了，使得我们可以推断出，所有 $4$ 个事件都必然发生了。

### 数据范围

对于 $100\%$ 的数据，$1\leq D\leq N\leq 10^3,1\leq M\leq 10^5$。


---

---
title: "[SCOI2006] 动态最值"
layout: "post"
diff: 提高+/省选-
pid: P6011
tag: ['2006', '四川', '各省省选']
---
# [SCOI2006] 动态最值
## 题目描述

有一个包含 $n$ 个元素的数组，要求实现以下操作：

- `DELETE k`：删除位置 $k$ 上的数。右边的数往左移一个位置。
- `QUERY i j`：查询位置 $i\sim j$ 上所有数的最小值和最大值。

例如有 $10$ 个元素：

| 位置 | $1$ | $2$ | $3$ | $4$ | $5$ | $6$ | $7$ | $8$ | $9$ | $	10$ |
| :-: | :-: | :-: | :-: | :-: | :-: | :-: | :-: | :-: | :-: | :-: | 
| 元素 | $1$ | $5$ | $2$ | $6$ | $7$ | $4$ | $9$ | $3$ | $1$ | $5$ |

`QUERY 2 8` 的结果为 `2 9`。依次执行 `DELETE 3` 和 `DELETE 6`（注意这时删除的是原始数组的元素 $7$）后数组变为：

| 位置 | $1$ | $2$ | $3$ | $4$ | $5$ | $6$ | $7$ | $8$ |
| :-: | :-: | :-: | :-: | :-: | :-: | :-: | :-: | :-: | 
| 元素 | $1$ | $5$ | $6$ | $7$ | $4$ | $3$ | $1$ | $5$ |

`QUERY 2 8` 的结果为 `1 7`。

## 输入格式

第一行包含两个数 $n,m$，表示原始数组的元素个数和操作的个数。  
第二行包括 $n$ 个数，表示原始数组。  
以下 $m$ 行，每行格式为 `1 k` 或者 `2 i j`，其中第一个数为 $1$ 表示删除操作，为 $2$ 表示询问操作。
## 输出格式

对每个询问操作输出一行，包括两个数，表示该范围内的最小值和最大值。
## 样例

### 样例输入 #1
```
10 4
1 5 2 6 7 4 9 3 1 5
2 2 8
1 3
1 6
2 2 8
```
### 样例输出 #1
```
2 9
1 7
```
## 提示

对于 $50\%$ 的数据，$1 \le n, m \le {10}^4$，删除操作不超过 $100$ 个。  
对于 $100\%$ 的数据，$1 \le n, m \le {10}^6$，数组中的元素绝对值均不超过 ${10}^9$。


---

---
title: "[JSOI2015] 染色问题"
layout: "post"
diff: 提高+/省选-
pid: P6076
tag: ['数学', '2015', '各省省选', '江苏', '容斥原理']
---
# [JSOI2015] 染色问题
## 题目描述

萌萌家有一个棋盘，这个棋盘是一个 $n \times m$ 的矩形，分成 $n$ 行 $m$ 列共 $n \times m$ 个小方格。   
现在萌萌和南南有 $C$ 种不同颜色的颜料，他们希望把棋盘用这些颜料染色，并满足以下规定：   

1. 棋盘的每一个小方格既可以染色（染成 $C$ 种颜色中的一种），也可以不染色。   
2. 棋盘的每一行至少有一个小方格被染色。   
3. 棋盘的每一列至少有一个小方格被染色。   
4. 每种颜色都在棋盘上出现至少一次。  
 
以下是一些将 $3  \times 3$ 棋盘染成 $C=3$ 种颜色（红、黄、蓝）的例子（下图已更新）： 
  
![](https://cdn.luogu.com.cn/upload/image_hosting/7s4j5elx.png)    

请你求出满足要求的不同的染色方案总数。只要存在一个位置的颜色不同，即认为两个染色方案是不同的。
## 输入格式

输入只有一行，为 $3$ 个整数 $n,m,c$。
## 输出格式

输出一个整数，为不同染色方案总数。
因为总数可能很大，只需输出总数对 $1,000,000,007$ 取模的值。
## 样例

### 样例输入 #1
```
2 2 3
```
### 样例输出 #1
```
60
```
## 提示

对于$100\%$的数据，$1 \le n,m,c \le 400$。


---

---
title: "[JSOI2015] salesman"
layout: "post"
diff: 提高+/省选-
pid: P6082
tag: ['动态规划 DP', '2015', '各省省选', '江苏']
---
# [JSOI2015] salesman
## 题目描述

某售货员小 T 要到若干城镇去推销商品,由于该地区是交通不便的山区，任意两个城镇之间都只有唯一的可能经过其它城镇的路线。 小 T 可以准确地估计出在每个城镇停留的净收益。这些净收益可能是负数，即推销商品的利润抵不上花费。由于交通不便，小 T 经过每个城镇都需要停留，在每个城镇的停留次数与在该地的净收益无关，因为很多费用不是计次收取的，而每个城镇对小 T 的商品需求也是相对固定的，停留一次后就饱和了。每个城镇为了强化治安，对外地人的最多停留次数有严格的规定。

请你帮小 T 设计一个收益最大的巡回方案,即从家乡出发，在经过的每个城镇停留，最后回到家乡的旅行方案。你的程序只需输出最大收益，以及最优方案是否唯一。方案并不包括路线的细节，方案相同的标准是选择经过并停留的城镇是否相同。因为取消巡回也是一种方案，因此最大收益不会是负数。小 T 在家乡净收益是零，因为在家乡是本地人，家乡对小 T 当然没有停留次数的限制。
## 输入格式

输入的第一行是一个正整数 $n$，表示城镇数目。城镇以 $1$ 到 $n$ 的数命名。小 T 的家乡命名为 $1$。

第二行和第三行都包含以空格隔开的 $n-1$ 个整数。第二行的第 $i$ 个数表示在城镇 $i+1$ 停留的净收益。第三行的第 $i$ 个数表示城镇 $i+1$ 规定的最大停留次数。所有的最大停留次数都不小于 $2$。

接下来的 $n-1$ 行，每行两个 $1$ 到 $n$ 的正整数 $x,y$，之间以一个空格
隔开，表示 $x,y$ 之间有一条不经过其它城镇的双向道路。输入数据保证所有城镇是连通的。 
## 输出格式

输出有两行。第一行包含一个自然数，表示巡回旅行的最大收益。如果该方案唯一，在第二行输出 `solution is unique`，否则在第二行输出 `solution is not unique`。
## 样例

### 样例输入 #1
```
9
-3 -4 2 4 -2 3 4 6
4 4 2 2 2 2 2 2
1 2
1 3
1 4
2 5
2 6
3 7
4 8
4 9
```
### 样例输出 #1
```
9
solution is unique
```
## 提示

#### 样例说明

最佳路线包括城镇 $1,2,4,5,9$。

---

#### 数据范围

对于 $100\%$ 的数据，$5\leq n\leq 10^5$。


---

---
title: "[JSOI2015] symmetry"
layout: "post"
diff: 提高+/省选-
pid: P6083
tag: ['2015', '二分', '各省省选', '江苏', '哈希 hashing']
---
# [JSOI2015] symmetry
## 题目描述

张老师正在课堂上讲解正方形的对称模式。为了简单起见，他用 $01$ 方阵代表一个正方形图形，即把正方形分解成 $n\times n$ 的方格阵，$0$ 代表一个白色方格，$1$ 代表一个黑色方格。

首先讲到的是容易辨别的轴对称，正方形有 $4$ 个对称轴，分别是水平中线，竖直中线和两条对角线。如果一个正方形图形以某个对称轴做反射变换后保持不变，就称为轴对称图形。例如下面的两个图形都是轴对称图形。

```plain
100  010
100  101
111  000
```

张老师继续讲解正方形的旋转对称。如果一个正方形图形以中心点旋转 $180$ 度后保持不变，就称为 $180$ 度对称图形。如果以中心点顺时针旋转 $90$ 度后保持不变，就称为 $90$ 度对称图形，例如下面的两个图形左边是 $180$ 度对称图形，右边是 $90$ 度对称图形。

```plain
0011  1011
1110  1110
0111  0111
1100  1101
```

张老师接着说，如果一个正方形图形具有两个互相垂直的对称轴，就称为 $4$ 对称图形，如果关于 $4$ 个对称轴全部对称，就称为 $8$ 对称图形。按照定义，$90$ 度对称图形也是 $180$ 度对称图形，$8$ 对称图形也是 $4$ 对称图形。当正方形图形的边长为偶数时，该图形的中心是最中间 $4$ 个方格的公共顶点，当正方形图形的边长为奇数时，该图形有一个中心方格，该图
形的中心也是它的中心方格的中心。边长为 $1$ 的图形显然是 $8$ 对称图形。

张老师给学生证明了两个定理。

- 定理 $1$：一个正方形图形是 $4$ 对称图形当且仅对它是 $180$ 度对称图形和轴对称图形。
- 定理 $2$：一个正方形图形是 $8$ 对称图形当且仅对它是 $90$ 度对称图形和轴对称图形。

最后是练习时间，张老师要求学生寻找在大正方形图形中出现的各种对称图形。请你编程实现这个要求。设输入一个 $01$ 方阵，输出满足 $8$ 对称，$90$ 度对称，$4$ 对称，$180$ 度对称和轴对称的最大子连续方阵的边长。子连续方阵是指选择若干相邻行列的子方阵，代表在大图形中出现的小图形。
## 输入格式

输入的第一行是一个正整数 $n$，表示大正方形图形的边长。然后是 $n$ 行长度为 $n$ 的 $01$ 字符串。
## 输出格式

输出有一行，包含 $5$ 个以空格隔开的自然数，分别表示在输入中出现的最大 $8$ 对称，$90$ 度对称，$4$ 对称，$180$ 度对称和轴对称的子连续方阵的行数。
## 样例

### 样例输入 #1
```
5
11100
11000
10111
11000
11100
```
### 样例输出 #1
```
2 2 3 3 5
```
## 提示

#### 样例说明

大图形有水平对称轴，左上角有一个 $2\times 2$ 的 $8$ 对称图形，中间 $3$ 行最右 $3$ 列构成 $4$ 对称图形。

---

#### 数据范围

对于 $100\%$ 的数据，$5\leq n\leq 500$。


---

---
title: "[JSOI2015] 字符串树"
layout: "post"
diff: 提高+/省选-
pid: P6088
tag: ['2015', '各省省选', '江苏', '字典树 Trie']
---
# [JSOI2015] 字符串树
## 题目背景

萌萌买了一颗字符串树的种子，春天种下去以后夏天就能长出一棵很大的字符串树。字符串树很奇特，树枝上都密密麻麻写满了字符串，看上去很复杂的样
子。
## 题目描述

字符串树本质上还是一棵树，即 $N$ 个节点 $N-1$ 条边的连通无向无环图，节点从 $1$ 到 $N$ 编号。与普通的树不同的是，树上的每条边都对应了一个字符串。萌萌和 JYY 在树下玩的时候，萌萌决定考一考 JYY。每次萌萌都写出一个字符串 $S$ 和两个节点 $U,V$，JYY 需要立即回答 $U$ 和 $V$ 之间的最短路径（即 $U,V$ 之间边数最少的路径，由于给定的是一棵树，这样的路径是唯一的）上有多少个字符串以 $S$ 为前缀。

JYY 虽然精通编程，但对字符串处理却不在行。所以他请你帮他解决萌萌的难题。
## 输入格式

输入第一行包含一个整数 $N$，代表字符串树的节点数量。

接下来 $N-1$ 行，每行先是两个数 $U,V$，然后是一个字符串 $S$，表示节点 $U$ 和节点 $V$ 之间有一条直接相连的边，这条边上的字符串是 $S$。输入数据保证给出的是一棵合法的树。

接下来一行包含一个整数 $Q$，表示萌萌的问题数。

接下来 $Q$ 行，每行先是两个数 $U,V$，然后是一个字符串 $S$，表示萌萌的一个问题是节点 $U$ 和节点 $V$ 之间的最短路径上有多少字符串以 $S$ 为前缀。
## 输出格式

输出 $Q$ 行，每行对应萌萌的一个问题的答案。
## 样例

### 样例输入 #1
```
4
1 2 ab
2 4 ac
1 3 bc
3
1 4 a
3 4 b
3 2 ab
```
### 样例输出 #1
```
2
1
1
```
## 提示

对于 $100\%$ 的数据，$1\leq N,Q\leq 10^5$，输入所有字符串长度不超过 $10$ 且只包含 `a~z` 的小写字母。


---

---
title: "[JSOI2015] 非诚勿扰"
layout: "post"
diff: 提高+/省选-
pid: P6089
tag: ['2015', '各省省选', '江苏', '概率论']
---
# [JSOI2015] 非诚勿扰
## 题目背景

JYY 赶上了互联网创业的大潮，为非诚勿扰开发了最新的手机 App 实现单身大龄青年之间的“速配”。然而随着用户数量的增长，JYY 发现现有速配的算法似乎很难满足大家的要求，因此 JYY 决定请你来调查一下其中的原因。
## 题目描述

应用的后台一共有 $N$ 个女性和 $N$ 个男性，他们每个人都希望能够找到自己的合适伴侣。为了方便，每个男性都被编上了 $1$ 到 $N$ 之间的一个号码，并且任意两个人的号码不一样。每个女性也被如此编号。

JYY 应用的最大特点是赋予女性较高的选择权，让每个女性指定自己的“如意郎君列表”。每个女性的如意郎君列表都是所有男性的一个子集，并且可能为空。如果列表非空，她们会在其中选择一个男性作为自己最终接受的对象。

JYY 用如下算法来为每个女性速配最终接受的男性：将“如意郎君列表”中的男性按照编号从小到大的顺序呈现给她。对于每次呈现，她将独立地以 $P$ 的概率接受这个男性（换言之，会以 $1-P$ 的概率拒绝这个男性）。如果她选择了拒绝，App 就会呈现列表中下一个男性，以此类推。如果列表中所有的男性都已经呈现，那么中介所会重新按照列表的顺序来呈现这些男性，直到她接受了某个男性为止。显然，在这种规则下，每个女性只能选择接受一个男性，而一个男性可能被多个女性所接受。当然，也可能有部分男性不被任何一个女性接受。

这样，每个女性就有了自己接受的男性（“如意郎君列表”为空的除外）。现在考虑任意两个不同的、如意郎君列表非空的女性 $a$ 和 $b$，如果 $a$ 的编号比 $b$ 的编号小，而 $a$ 选择的男性的编号比 $b$ 选择的编号大，那么女性 $a$ 和女性 $b$ 就叫做一对不稳定因素。

由于每个女性选择的男性是有一定的随机性的，所以不稳定因素的数目也是有一定随机性的。JYY 希望你能够求得不稳定因素的期望个数（即平均数目），从而进一步研究为什么速配算法不能满足大家的需求。
## 输入格式

输入第一行包含 $2$ 个自然数 $N,M$，表示有 $N$ 个女性和 $N$ 个男性，以及所有女性的“如意郎君列表”长度之和是 $M$。

接下来一行一个实数 $P$，为女性接受男性的概率。

接下来 $M$ 行，每行包含两个整数 $a,b$，表示男性 $b$ 在女性 $a$ 的“如意郎君列表”中。
## 输出格式

输出 $1$ 行，包含一个实数，四舍五入后保留到小数点后 $2$ 位，表示不稳定因素的期望数目。
## 样例

### 样例输入 #1
```
5 5
0.5
5 1
3 2
2 2
2 1
3 1
```
### 样例输出 #1
```
0.89
```
## 提示

对于 $100\%$ 的数据，$1\leq N,M\leq 5\times 10^5$，$0.4\leq P<0.6$。

输入保证每个女性的“如意郎君列表”中的男性出现且仅出现一次。



---

---
title: "[JSOI2015] 套娃"
layout: "post"
diff: 提高+/省选-
pid: P6093
tag: ['贪心', '2015', '各省省选', '江苏']
---
# [JSOI2015] 套娃
## 题目背景

刚从俄罗斯旅游回来的 JYY 买了很多很多好看的套娃作为纪念品！JYY 由于太过激动，把所有的套娃全部都打开了。而由于很多套娃长得过于相像，JYY 现在不知道该如何把它们装回去了（他实在搞不清，应该把哪个套娃装到哪个里面去了）。
## 题目描述

JYY 一共有 $N$ 个拆开的套娃，每个套娃从 $1$ 到 $N$ 编号。编号为 $i$ 的套娃有一个外径 $Out_i$ 和一个内径 $In_i$（$In_i<Out_i$）。

对于套娃 $i$ 和套娃 $j$，如果满足 $Out_i<In_j$，那么套娃 $i$ 就可以装到套娃 $j$ 里面去。

注意，一个套娃内部，不允许并排的放入多个套娃。

也就是说，如果我们将 $i$ 装到 $j$ 的内部之后，还存在另一个套娃 $k$，也满足 $Out_k<In_j$，我们此时是不允许再将 $k$ 放到 $j$ 内部的（因为 $j$ 的内部已经放入了 $i$）。但是，如果 $k$ 还满足 $Out_k<In_i$，那么我们允许先将 $k$ 放到 $i$ 的内部，然后再把 $k$ 和 $i$ 作为一个整体放入 $j$ 的内部。

JYY 认为一套好的套娃，内部的空隙一定是尽量少的。如果套娃 $j$ 内部装入了套娃 $i$，那么我们认为，套娃 $j$ 内部产生的空隙为 $In_j-Out_i$；如果套娃 $j$ 的内部什么也没有装，那么套娃 $j$ 的空隙则就是 $In_j$。

JYY 也希望，那些长得更加好看的套娃，里面可以填的尽量满一些；而相对
那些不那么好看的套娃，JYY 也就相对不那么介意一些。为此 JYY 对于编号为 $i$ 的套娃设置了一个好看度 $B_i$，如果这个套娃内部还存在 $K$ 的空隙，那么 JYY 对于这个套娃就会产生 $K\times Bi$ 的不满意度。

JYY 对于一个套娃安装方案的不满意度，就是每个套娃产生的不满意度的总
和。JYY 希望找出一个，不满意度最小的套娃安装方案。
## 输入格式

第一行包含一个正整数 $N$。接下来 $N$ 行，每行包含三个正整数 $Out_i,In_i,B_i$，表示 $i$ 号套娃的外径，内径，以及好看度。


## 输出格式

输出文件包含一行一个整数，表示不满意度的最小值。


## 样例

### 样例输入 #1
```
3
5 4 1
4 2 2
3 2 1
```
### 样例输出 #1
```
7
```
## 提示

对于 $100\%$ 的数据，$N\leq 2\times 10^5$，$1\leq In_i<Out_i\leq 10^4$，$1\leq B_i\leq 10^9$。


---

---
title: "[JSOI2015] 地铁线路"
layout: "post"
diff: 提高+/省选-
pid: P6096
tag: ['2015', '各省省选', '江苏', '最短路']
---
# [JSOI2015] 地铁线路
## 题目描述

JSOI 王国的地铁又涨价了！正在 JSOI 旅游的 JYY 非常不开心。这次票价改革后，乘客并不是按照乘坐的距离收费，而是按照换乘次数进行收费的！JYY 也要按此更新他的线路搜索软件了。JYY 心想，在支付同样票价的前提下，岂不
是坐的站数越多，自己就赚的越多嘛！于是 JYY 希望开发一个线路搜索软件，使得自己总能够“赚”的最多！

JSOI 地铁一共有 $N$ 条线路 $S$ 个车站。第 $i$ 条地铁线路包含 $L_i$ 个站。所有地铁线路都是一条从首发站到终点站的直线型线路（不存在例如北京地铁 2 号线或者 10 号线那样奇葩的环线）。同时，每一条地铁线路都是双向运行的。如果有不同的线路经过同一个地铁站，那么乘客就可以在那个地铁站进行换乘。根据 JSOI 地铁的最新收费方式，每当乘客进入一列正在运行的地铁列车，都需要支付 $1$ 的费用。因此，假设乘客一共换乘了 $x$ 次，那么就需要总共支付 $x+1$ 的乘车费用。由于地铁线路都是双向运行的，因此在任意一站都可以换乘该线地铁反方向运行的列车。不过，需要注意的是，即使是换乘同样线路的反方向列车，也是需要付费的（因为总是需要先下车，再重新上车的）。

JYY现在要从 $A$ 站坐地铁前往 $B$ 站。假设对于任意一条地铁线路，相邻两站间地铁的运行时间均为 $1$ 分钟，并且列车停站和换乘均不耗时间，JYY想知道

1. 他最少需要支付的票价是多少钱；
2. 在支付最少票价的前提下，他最多可以乘坐多少分钟的地铁。
## 输入格式

第一行包含两个正整数 $N$ 和 $S$。

第二行包含 $S$ 个由空格隔开的字符串，表示 $S$ 个站点的站名。

接下来 $N$ 行，每行描述一条地铁线路。对于其中第 $i$ 行，首先包含一个正整数 $L_i$，接下来 $L_i$ 个字符串，表示这条地铁线路上的站点名称。一条线路允许多次停靠同一个站点。

第 $N+3$ 行，包含两个不同的字符串 $A$ 和 $B$，表示 JYY 目前在 $A$ 站，希望坐地铁前往 $B$ 站。
## 输出格式

第一行包含一个整数 $C$，表示 JYY 最少需要支付的乘车费用。

第二行包含一个整数 $T$，表示 JYY 在花费 $C$ 的前提下，可以乘坐地铁的最长时间。

如果不存在两个站点之间的路线，第一行输出`-1`，第二行输出 `0`。
## 样例

### 样例输入 #1
```
2 5
A B C D E
4 A B C D
3 C D E
A D
```
### 样例输出 #1
```
1
3
```
## 提示

对于 $100\%$ 的数据，$2\leq N\leq 4\times 10^5$，$S\leq 3\times 10^5$，$\sum L_i\leq 8\times 10^5$。

保证输入所有字符串的长度不超过 $40$，且仅包含字母、数字以及横线 `-`。


---

---
title: "[JSOI2013] 贪心的导游"
layout: "post"
diff: 提高+/省选-
pid: P6141
tag: ['2013', '各省省选', '江苏']
---
# [JSOI2013] 贪心的导游
## 题目描述

南京有一条著名的购物街。购物街嘛，就是一排整齐的商店啦~

导游小 Z 每次都会把游客团带到购物街里走一段，然后选择一个商店进去购物。

小 Z 接待的游客都是购物狂，他们恨不得将店内的商品洗劫一空，也就是说，只要他们能买，就一定会继续买（钱够不够你不用考虑，他们都有信用卡可以透支）。

但是有一点，他们都非常讲究平等、很谦虚，每个人都不能忍受比别人多买什么东西或者少买什么东西，于是他们每个人最后买的商品数量都是一样的。这虽然导致他们没办法每次都把商店搬空，但是每次已经给店家带来一大笔生意了，店家已经非常感谢了！为了表示感谢，店家决定把游客们买完之后剩下来那几件没卖掉的商品就送给导游小 Z 了。

贪心的小 Z 自然希望自己能获赠的商品数量越大越好啦~

现在告诉你这一排共 $n$ 个商店（标号为 $0$ 到 $n-1$）每个商店里的商品总数，每次小 Z 会带一批共 $p$ 个游客的旅游团，到其中 $u$ 号商店和 $v$ 号商店之间逛一逛，请你帮小 Z 在所逛的商店区间内选择一个，告诉小 Z 他最多能获赠多少件商品。
## 输入格式

第一行，包含两个整数 $n,m$，分别表示商店个数和小 Z 带来的旅游团个数。

接下来一行，包含 $n$ 个整数 $a_i$，表示第 $i$ 个商店的商品总数。

接下来 $m$ 行，每行三个整数 $u,v,p$，表示这个旅游团逛 $u$ 号商店和 $v$ 号商店之间的商店（包含 $u$ 和 $v$），且这个旅游团的人数为 $p$。
## 输出格式

共输出 $m$ 行，每行一个整数，第 $i$ 行输出第 $i$ 个旅游团购物后，小 Z 最多能获赠的商品数量。
## 样例

### 样例输入 #1
```
5 5
2 4 6 8 10
0 1 2
1 4 3
2 4 2
1 1 9
0 4 7
```
### 样例输出 #1
```
0
2
0
4
6
```
## 提示

### 样例解释

第一个旅游团， $2$ 个人， $0$ 号商店到 $1$ 号商店的区间。若去 $1$ 号商店，共 $2$ 件商品，每人买 $1$ 件，剩 $0$ 件。若去 $2$ 号商店，共 $4$ 件商品，每人买 $2$ 件，剩 $0$ 件。所以，小 Z 最多获赠 $0$ 件。

第二个旅游团， $3$ 个人，小 Z 选择带他们去 $4$ 号商店，共 $8$ 件商品，每人买 $2$ 件商品（因为每人 $3$ 件不够），剩下 $2$ 件，小 Z 最多获赠就是 $2$ 件。 可以验证去其它商店小 Z 最多获赠的商品不会达到 $2$ 件。

### 数据范围

对于 $100\%$ 的数据，$1 \leq n\leq 10^6,1 \leq m\leq 5\times 10^4,0\leq a_i\leq 10^3,2\leq p\leq 10^3,0\leq u,v\leq n-1$。


---

---
title: "[SHOI2002] 舞会"
layout: "post"
diff: 提高+/省选-
pid: P6268
tag: ['2002', '各省省选', '网络流', '上海', '图论建模', '二分图']
---
# [SHOI2002] 舞会
## 题目描述

某学校要召开一个舞会。已知学校所有 $n$ 名学生中，有些学生曾经互相跳过舞。当然跳过舞的学生一定是一个男生和一个女生。在这个舞会上，要求被邀请的学生中的任何一对男生和女生互相都不能跳过舞。求这个舞会最多能邀请多少个学生参加。
## 输入格式

输入的第一行是 $n$ 和 $m$ 。其中 $n$ 是可选的学生的总数， $m$ 是已知跳过舞的学生的对数 ( $n \leq 1000$ ， $m \leq 2000$ ）。

然后有 $m$ 行，每行包括两个非负整数，表示这两个编号的学生曾经跳过舞。学生的编号从 $0$ 号到 $n - 1$ 号。
## 输出格式

输出文件仅一行，为一个数字，即能够邀请的最多的学生数。
## 样例

### 样例输入 #1
```
8 6
0 2
2 3
3 5
1 4
1 6
3 1
```
### 样例输出 #1
```
5
```
### 样例输入 #2
```
20 5
5 2
4 3
18 17
0 11
13 3

```
### 样例输出 #2
```
16
```


---

---
title: "麻将 加强版"
layout: "post"
diff: 提高+/省选-
pid: P6454
tag: ['2007', '各省省选', '江苏', 'O2优化']
---
# 麻将 加强版
## 题目背景

此题我本来是想出公开赛的，没想到撞题了。

题面是我自己撰写的，与原题不同。

此题题意与 [P4050](https://www.luogu.com.cn/problem/P4050) 大致相同，**有少许不同**，**且数据范围有所更改**。

------------

小 A 喜欢打麻将。
## 题目描述

小 A 找到了一副奇怪的麻将牌：只有一种 $1,2,\cdots,n$ 的数牌，且每种牌都有**无穷多张**。

定义「雀头」为两张一样的牌（如 $2,2$，$7,7$），「刻子」为三张一样的牌（如 $1,1,1$，$4,4,4$），「顺子」为三张序数相邻的牌（如 $1,2,3$，$9,10,11$，注意 $1$ 与 $n$ 不相邻）。「顺子」与「刻子」统称「面子」。

假如你能把你的手牌分为若干组「雀头」（**可以相同**），或者分为若干组「面子」（**可以相同**）以及一组「雀头」，那么你就可以「和牌」。

假如某副手牌加上某张牌后可以「和牌」，则称这副手牌「听」这张牌。

现在小 A 随意摸了 $k$ 张牌，他想知道他「听」哪些牌。
## 输入格式

第一行两个正整数 $n,k$，分别表示牌的范围和小 A 手上牌的张数。

接下来一行 $k$ 个整数 $a_1,a_2,\cdots,a_k$ 给出小 A 的手牌，每个数表示小 A 手上的一张牌。**不保证按升序给出。**
## 输出格式

第一行一个正整数 $t$，表示小 A「听」的牌的种数。

接下来一行 $t$ 个正整数，表示小 A「听」哪些牌。**请按照升序输出。**
## 样例

### 样例输入 #1
```
9 13
1 1 1 2 3 4 5 6 7 8 9 9 9

```
### 样例输出 #1
```
9
1 2 3 4 5 6 7 8 9
```
### 样例输入 #2
```
9 13
1 1 1 1 3 3 3 3 5 5 5 5 7

```
### 样例输出 #2
```
1
7
```
## 提示

#### 样例解释

样例一解释：这种牌型叫做[纯正九莲宝灯](https://zh.moegirl.org/%E6%97%A5%E6%9C%AC%E9%BA%BB%E5%B0%86:%E4%B9%9D%E8%8E%B2%E5%AE%9D%E7%81%AF)。~~折寿警告~~  
具体划分方式：
```plain
1 111|123|456|789|99
2 111|345|678|999|22
3 123|345|678|999|11
4 111|234|456|789|99
5 111|234|678|999|55
6 123|456|678|999|11
7 111|234|567|789|99
8 111|234|567|999|88
9 123|456|789|999|11
```

[](https://i.loli.net/2020/04/18/TPvukw8pbHNnFC4.png)

样例二解释：很显然这套牌差一张 $7$ 即可分为 $1,1;1,1;3,3;3,3;5,5;5,5;7,7$ 共计 $7$ 组「雀头」和牌。

#### 数据范围

**本题采用捆绑测试。**

- $\text{Subtask\;1(5\;pts)}$：$k=1$。  
- $\text{Subtask\;2(5\;pts)}$：$n=1$。  
- $\text{Subtask\;3(10\;pts)}$：$n=9$。  
- $\text{Subtask\;4(15\;pts)}$：$k\le 100$。  
- $\text{Subtask\;5(15\;pts)}$：$n\le 100$。    
- $\text{Subtask\;6(50\;pts)}$：无特殊限制。  

对于所有数据，$1\le n\le 5\times10^3$，$1\le k\le 10^5$，$1\le a_i\le n$，$k\equiv 1\pmod 6$。


---

---
title: "[JSOI2014] 强连通图"
layout: "post"
diff: 提高+/省选-
pid: P7251
tag: ['2014', '各省省选', '江苏']
---
# [JSOI2014] 强连通图
## 题目描述

JYY 最近痴迷于图的强连通性，所以对于任何有向图，JYY 都希望增加一些边使得这个图变成强连通图。JYY现在得到了一个 $n$ 个点 $m$ 条边的有向图，所有点从 $1$ 到 $n$ 编号。

JYY 想知道：

- 在给定的图中，最多能选出多少个点，使得这些点在原图中两两可达？

- 在给定的图中，最少增加多少条边，可以使得这个图变成强连通图？

其中，一个有向图 $G(V,E)$是强连通的，当且仅当任意顶点 $a,b\in V,a\neq b$之间都存在 $a\to b$ 和 $b\to a$ 的路径。
## 输入格式

第一行包含两个整数 $n$ 和 $m$。

接下来 $m$ 行，每行两个整数 $x$ 和 $y$，表示图中有一条从 $x$ 到 $y$ 的有向边。
## 输出格式

两行，第一行表示第一个问题的答案，第二行表示第二个问题的答案。
## 样例

### 样例输入 #1
```
4 3
1 4
2 3
2 4
```
### 样例输出 #1
```
1
2
```
## 提示

### 样例解释 1

对于第一个问题，无法选出互相连通两个点，答案为 $1$。

对于第二个问题，一种加边数最小的方案为 $(3,1)$ 和 $(4,2)$，答案为 $2$。

### 数据范围

对于 $100\%$ 的数据，$1\leq n\leq 10^5,1\leq m\leq 3\times 10^5$。


---

---
title: "[JSOI2011] 棒棒糖"
layout: "post"
diff: 提高+/省选-
pid: P7252
tag: ['2011', '各省省选', '江苏', 'O2优化']
---
# [JSOI2011] 棒棒糖
## 题目描述

Coffee 的世界里也是有棒棒糖卖的，Coffee 买了 $n$ 只连着的棒棒糖。这 $n$ 只棒棒糖包裹在小塑料袋中，排成
一列，相邻的两只棒棒糖的塑料袋是接起来的。为了方便，我们把棒棒糖从左到右编号为$1\cdots n$。

每只棒棒糖有一种口味。第 $i$ 只的口味是 $c_i$。两只棒棒糖 $i,j$ 的口味相同，当且仅当 $c_i=c_j$。Coffee 对 $m$ 只棒棒糖总体口味的评价比较奇怪。如果这 $m$ 只棒棒糖中，有一种口味 $c_0$ 的数量严格大于总数的一半，那么 Coffee 认为这 $m$ 只棒棒糖主要是 $c_0$ 口味的。Coffee 知道，这里的 $c_0$ 如果存在就一定是唯一的。而当 $c_0$ 不存在时，Coffee 认为这 $m$ 只棒棒糖是混合口味的。

Coffee 暂时舍不得吃棒棒糖，它在想一些好玩的问题。如果考虑棒棒糖序列的一个连续子序列 $s\cdots t(1\leq s\leq t\leq n)$，包括棒棒糖 $s$ 和 $t$。那么这 $t-s+1$ 只棒棒糖的总体口味是什么呢？

Coffee有一堆这样的问题，一共 $m$ 个。第 $i$ 个问题是棒棒糖子序列 $s_i\cdots t_i$ 的总体口味，请你帮忙解决。
## 输入格式

第一行两个用空格隔开的整数，分别表示 $n,m$。

接下来 $n$ 行，每行一个整数，表示 $c_i$。

接下来 $m$ 行，每行两个整数，表示 $s_i,t_i$。
## 输出格式

$m$ 行，每行一个整数，表示每个询问的总体口味。如果总体口味为混合口味则输出 $0$。
## 样例

### 样例输入 #1
```
5 3 
1 
2 
2
1
1
1 5
2 5
2 4
```
### 样例输出 #1
```
1
0
2
```
## 提示

### 样例解释 1

在第一个询问中，口味 $1$ 出现 $3$ 次，大于总数的一半，所以总体口味为 $1$。

在第二个询问中，没有一种口味出现次数大于总数的一半，所以为混合口味。

在第三个询问中，口味 $2$ 出现 $2$ 次，大于总数的一半，所以总体口味为 $2$。

### 数据范围

对于 $100\%$ 的数据，$1\leq n,m,c_i\leq 5\times 10^4$。


---

---
title: "[省选联考 2021 A/B 卷] 卡牌游戏"
layout: "post"
diff: 提高+/省选-
pid: P7514
tag: ['各省省选', '2021', 'O2优化']
---
# [省选联考 2021 A/B 卷] 卡牌游戏
## 题目描述

Alice 有 $n$ 张卡牌，第 $i$（$1 \le i \le n$）张卡牌的正面有数字 $a_i$，背面有数字 $b_i$，初始时所有卡牌正面朝上。

现在 Alice 可以将不超过 $m$ 张卡牌翻面，即由正面朝上改为背面朝上。Alice 的目标是让最终朝上的 $n$ 个数字的极差（最大值与最小值的差）尽量小。请你帮 Alice 算一算极差的最小值是多少。
## 输入格式

第一行，两个正整数 $n, m$，代表卡牌张数与至多翻面张数。  
第二行，$n$ 个正整数，第 $i$ 个数字表示 $a_i$。  
第三行，$n$ 个正整数，第 $i$ 个数字表示 $b_i$。

数据保证卡牌上的 $2 n$ 个数字互不相同，且卡牌按照 $a_i$ 升序给出。
## 输出格式

仅一行，一个整数，表示答案。
## 样例

### 样例输入 #1
```
6 3
8 11 13 14 16 19
10 18 2 3 6 7

```
### 样例输出 #1
```
8

```
### 样例输入 #2
```
见附件中的 card/card2.in。
```
### 样例输出 #2
```
见附件中的 card/card2.ans。
```
### 样例输入 #3
```
见附件中的 card/card3.in。
```
### 样例输出 #3
```
见附件中的 card/card3.ans。
```
## 提示

**【样例 #1 解释】**

最优方案之一：将第 $1, 5, 6$ 张卡牌翻面，最终朝上的数字依次为 $10, 11, 13, 14, 6, 7$，极差为 $14 - 6 = 8$。

---

**【数据范围】**

对于所有测试数据：$3 \le n \le {10}^6$，$1 \le m < n$，$1 \le a_i, b_i \le {10}^9$。

每个测试点的具体限制见下表：

| 测试点编号 | $n \le$ | 特殊限制 |
|:-:|:-:|:-:|
| $1 \sim 2$ | $10$ | 无 |
| $3 \sim 4$ | $500$ | 无 |
| $5 \sim 6$ | $5 \times {10}^5$ | $m \le 1000$ |
| $7$ | ${10}^5$ | 无 |
| $8$ | $4 \times {10}^5$ | 无 |
| $9$ | $7 \times {10}^5$ | 无 |
| $10$ | ${10}^6$ | 无 |


---

---
title: "[省选联考 2021 B 卷] 取模"
layout: "post"
diff: 提高+/省选-
pid: P7521
tag: ['各省省选', '2021', 'O2优化']
---
# [省选联考 2021 B 卷] 取模
## 题目描述

给定 $n$ 个正整数 $a_i$，请你在其中选出三个数 $i, j, k$（$i \ne j$，$i \ne k$，$j \ne k$），使得 $(a_i + a_j) \bmod a_k$ 的值最大。
## 输入格式

第一行，一个整数 $n$，表示数字个数。  
第二行，$n$ 个整数，表示 $a_i$。
## 输出格式

输出一行，一个整数，表示答案。
## 样例

### 样例输入 #1
```
6
4 7 7 5 2 2

```
### 样例输出 #1
```
6

```
### 样例输入 #2
```
见附件中的 mod/mod2.in。
```
### 样例输出 #2
```
见附件中的 mod/mod2.ans。
```
## 提示

对于 $30 \%$ 的数据，$n \le 100$。  
对于 $60 \%$ 的数据，$n \le 3000$。  
对于 $100 \%$ 的数据，$3 \le n \le 2 \times {10}^5$，$1 \le a_i \le {10}^8$。


---

---
title: "[LNOI2022] 吃"
layout: "post"
diff: 提高+/省选-
pid: P8365
tag: ['各省省选', '2022', 'O2优化', '辽宁']
---
# [LNOI2022] 吃
## 题目描述

小 A 很喜欢吃东西。

小 A 面前有 $n$ 份食物，第 $i$ 份有参数 $a_i$ 和 $b_i$。小 A 可以按照**任意顺序**吃掉这 $n$ 份食物。当她吃掉编号为 $i$ 的食物时，她可以选择将自己的体重乘以 $a_i$ 或者将自己的体重加上 $b_i$。每份食物只能吃恰好一次。

小 A 的初始体重为 $1$，请求出她吃完 $n$ 份食物后能达到的**最大**体重。答案可能很大，你只需要输出其对 $({10}^9 + 7)$ 取模后的结果。

**注意：你需要最大化体重并将该最大值对 $\bm{({10}^9 + 7)}$ 取模，而非最大化体重对 $\bm{({10}^9 + 7)}$ 取模的结果。**
## 输入格式

第一行输入一个整数 $n$ 表示食物的数量。第二行 $n$ 个整数 $a_1, a_2, \ldots, a_n$，第三行 $n$ 个整数 $b_1, b_2, \ldots, b_n$，表示每份食物的参数。
## 输出格式

输出一个整数，表示小 A 可以得到的最大体重对 $({10}^9 + 7)$ 取模后的结果。
## 样例

### 样例输入 #1
```
5
1 2 3 4 5
100 200 300 400 500

```
### 样例输出 #1
```
18060

```
## 提示

**【样例解释 #1】**

以下方案可以达到最大体重：

- 吃掉第一份食物并选择将体重增加 $100$，体重变为 $101$；
- 吃掉第二份食物并选择将体重增加 $200$，体重变为 $301$；
- 吃掉第三份食物并选择将体重乘 $3$，体重变为 $903$；
- 吃掉第四份食物并选择将体重乘 $4$，体重变为 $3612$；
- 吃掉第五份食物并选择将体重乘 $5$，体重变为 $18060$。

**【样例 #2】**

见附件中的 `food/food2.in` 与 `food/food2.ans`。

该组样例满足 $n \le 10$ 和特殊性质 E。

**【样例 #3】**

见附件中的 `food/food3.in` 与 `food/food3.ans`。

该组样例满足 $n \le 20$ 和特殊性质 E。

**【样例 #4】**

见附件中的 `food/food4.in` 与 `food/food4.ans`。

该组样例满足 $n \le 2000$。

**【样例 #5】**

见附件中的 `food/food5.in` 与 `food/food5.ans`。

该组样例满足特殊性质 A。

**【样例 #6】**

见附件中的 `food/food6.in` 与 `food/food6.ans`。

该组样例满足特殊性质 C。

**【样例 #7】**

见附件中的 `food/food7.in` 与 `food/food7.ans`。

该组样例满足特殊性质 D。

**【样例 #8】**

见附件中的 `food/food8.in` 与 `food/food8.ans`。

该组样例满足特殊性质 B。

**【样例 #9】**

见附件中的 `food/food9.in` 与 `food/food9.ans`。

**【数据范围】**

对于 $100 \%$ 的测试数据，$1 \le n \le 5 \times {10}^5$，$1 \le a_i, b_i \le {10}^6$。

| 测试点编号 | $n \le $ | 特殊性质 |
|:-:|:-:|:-:|
| $1$ | $10$ | DE |
| $2$ | $10$ | E |
| $3$ | $10$ | AE |
| $4$ | $10$ | E |
| $5$ | $20$ | DE |
| $6$ | $20$ | E |
| $7$ | $20$ | E |
| $8$ | $20$ | E |
| $9$ | $2000$ | D |
| $10$ | $2000$ | 无 |
| $11$ | $2000$ | 无 |
| $12$ | $2000$ | 无 |
| $13$ | $5 \times {10}^5$ | BD |
| $14$ | $5 \times {10}^5$ | B |
| $15$ | $5 \times {10}^5$ | C |
| $16$ | $5 \times {10}^5$ | C |
| $17$ | ${10}^5$ | 无 |
| $18$ | ${10}^5$ | 无 |
| $19$ | $5 \times {10}^5$ | 无 |
| $20$ | $5 \times {10}^5$ | 无 |

特殊性质 A：$a_i = 1$。  
特殊性质 B：$a_i \ge b_i$。  
特殊性质 C：$a_i, b_i$ 在 $[1, {10}^6]$ 内独立均匀随机生成。  
特殊性质 D：$a_i \ge 2$。  
特殊性质 E：$a_i \le 4$。


---

---
title: "[LNOI2022] 题"
layout: "post"
diff: 提高+/省选-
pid: P8366
tag: ['各省省选', '2022', 'O2优化', '辽宁']
---
# [LNOI2022] 题
## 题目描述

给定长度为 $3 n$、值域为 $[0, 3]$ 的整数序列 $S = s_1 s_2 \cdots s_{3 n}$。你需要首先将 $S$ 中的每个 $0$ 替换为 $[1, 3]$ 中的任意一个整数，得到序列 $T = t_1 t_2 \cdots t_{3 n}$，然后给出 $n$ 个长度为 $3$ 的整数序列 ${\{ a_{i, 1}, a_{i, 2}, a_{i, 3} \}}_{1 \le i \le n}$，使得

- $\forall 1 \le i \le n$，$1 \le a_{i, 1} < a_{i, 2} < a_{i, 3} \le 3 n$；
- $\forall (i_1, j_1) \ne (i_2, j_2)$，$a_{i_1, j_1} \ne a_{i_2, j_2}$；
- $\forall 1 \le i \le n$，$\{ t_{a_{i, 1}}, t_{a_{i, 2}}, t_{a_{i, 3}} \}$ 是 $\{ 1, 2, 3 \}$ 的一个排列且逆序对数为奇数。

认为两个方案本质不同当且仅当序列 $T$ 不同或存在 $a_{i, j}$（$1 \le i \le n$，$1 \le j \le 3$）不同，求以上操作的本质不同的方案数，对 $({10}^9 + 7)$ 取模。
## 输入格式

**本题有多组测试数据**。输入的第一行包含一个正整数 $C$ 表示测试数据组数。

对于每组测试数据，第一行一个整数 $n$，接下来一行一个长度为 $3 n$ 的字符串描述序列 $S$。
## 输出格式

对于每组测试数据输出一行一个整数表示方案数对 $({10}^9 + 7)$ 取模的结果。
## 样例

### 样例输入 #1
```
5
1
123
1
100
1
000
2
321321
2
000001

```
### 样例输出 #1
```
0
1
3
6
60

```
## 提示

**【样例解释 \#1】**

前三组测试数据中 $n = 1$，故 $\{ a_{1, 1}, a_{1, 2}, a_{1, 3} \} = \{ 1, 2, 3 \}$。

对于第一组测试数据，只能有 $T = 123$，而 $\{ 1, 2, 3 \}$ 的逆序对数为 $0$ 不合法，故不存在方案。

对于第二组测试数据，$T = 123$ 不合法，而 $T = 132$ 时 $\{ 1, 3, 2 \}$ 的逆序对数为 $1$ 合法，故存在一个方案。

对于第三组测试数据，取 $T = 132$，$T = 213$，$T = 321$ 可以得到三个合法方案。

对于第四组测试数据，$T = 321321$，有如下六种方案：

- $\{ a_{1, 1}, a_{1, 2}, a_{1, 3} \} = \{ 1, 2, 3 \}$，$\{ a_{2, 1}, a_{2, 2}, a_{2, 3} \} = \{ 4, 5, 6 \}$
- $\{ a_{1, 1}, a_{1, 2}, a_{1, 3} \} = \{ 4, 5, 6 \}$，$\{ a_{2, 1}, a_{2, 2}, a_{2, 3} \} = \{ 1, 2, 3 \}$
- $\{ a_{1, 1}, a_{1, 2}, a_{1, 3} \} = \{ 1, 2, 6 \}$，$\{ a_{2, 1}, a_{2, 2}, a_{2, 3} \} = \{ 3, 4, 5 \}$
- $\{ a_{1, 1}, a_{1, 2}, a_{1, 3} \} = \{ 3, 4, 5 \}$，$\{ a_{2, 1}, a_{2, 2}, a_{2, 3} \} = \{ 1, 2, 6 \}$
- $\{ a_{1, 1}, a_{1, 2}, a_{1, 3} \} = \{ 1, 5, 6 \}$，$\{ a_{2, 1}, a_{2, 2}, a_{2, 3} \} = \{ 2, 3, 4 \}$
- $\{ a_{1, 1}, a_{1, 2}, a_{1, 3} \} = \{ 2, 3, 4 \}$，$\{ a_{2, 1}, a_{2, 2}, a_{2, 3} \} = \{ 1, 5, 6 \}$

**【样例 \#2】**

见附件中的 ` problem/problem2.in` 与 `problem/problem2.ans`。

该组样例中五组数据的 $n$ 分别为 $3, 5, 8, 12, 17$。

**【样例 \#3】**

见选手目录下的 `problem/problem3.in` 与 `problem/problem3.ans`。

该组样例满足特殊性质 A，五组数据的 $n$ 分别为 $2, 4, 7, 15, 19$。

**【数据范围】**

对于所有测试数据，$1 \le C \le 5$，$1 \le n \le 19$，字符串 $S$ 的长度为 $3 n$ 且仅由 $0, 1, 2, 3$ 构成。

| 测试点编号 | $n \le$ | 特殊性质 |
|:-:|:-:|:-:|
| $1$ | $1$ | 无 |
| $2$ | $2$ | 无 |
| $3$ | $3$ | 无 |
| $4$ | $5$ | A |
| $5$ | $7$ | 无 |
| $6$ | $10$ | 无 |
| $7$ | $13$ | A |
| $8$ | $16$ | 无 |
| $9$ | $18$ | 无 |
| $10$ | $19$ | 无 |

特殊性质 A：字符串 $S$ 由全 $0$ 的字符串构成。

**【提示】**

请注意程序的空间消耗。


---

---
title: "[SHOI2006] 作业 Homework"
layout: "post"
diff: 提高+/省选-
pid: P9809
tag: ['2006', '各省省选', '上海', '根号分治']
---
# [SHOI2006] 作业 Homework
## 题目描述

给定一个集合为 $S$，初始为空，你需要执行以下两个操作共 $N$ 次。

操作一，在集合 $S$ 中加入一个新元素，其代号为 $X$，保证 $X$ 在当前集合中不存在。

操作二，在当前的集合 $S$ 中询问所有元素 $\bmod\ Y$ 最小的值。
## 输入格式

第一行一个正整数 $N$。

接下来 $N$ 行，每行一个字符和一个正整数，如字符为 `A`，表示这个操作是操作一。若字符为 `B`，则这个操作为操作二。
## 输出格式

对于每个操作二，输出一行一个整数表示答案。
## 样例

### 样例输入 #1
```
5
A 3
A 5
B 6
A 9
B 4
```
### 样例输出 #1
```
3
1
```
## 提示

对于 $100\%$ 的数据，$N\leq10^5$，$X,Y\leq3\times10^5$。数据保证，第一个操作为操作一。


---


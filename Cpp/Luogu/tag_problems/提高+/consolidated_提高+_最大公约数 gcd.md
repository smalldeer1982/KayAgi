---
title: "奉献（Dedication）"
layout: "post"
diff: 提高+/省选-
pid: P10321
tag: ['数学', '数论', '洛谷原创', 'Special Judge', 'O2优化', '素数判断,质数,筛法', '最大公约数 gcd', '洛谷比赛']
---
# 奉献（Dedication）
## 题目背景

不断鞭策自己的数学精神 —— 奉献。
****
「奉献之光」丽莎，既是「秩序之神」派拉的神官，亦为「无秩序之神」迪奥尼斯的信徒。

丽莎最近学习了[高精度除法](https://www.luogu.com.cn/problem/P5432)，她能以 $\Theta(n \log n)$ 的时间复杂度计算 $n$ 位整数除法了。
## 题目描述



丽莎想要制作一张 $n$ 以内正整数的除法表。具体来说，是一张记录了 $\lfloor a/b \rfloor$（$1\leq b \leq a \leq n$，$a,b$ 均为整数）的表格。她使用如下方法来制作：

>以 $a$ 为第一关键字从小到大，以 $b$ 为第二关键字从小到大的顺序枚举位置 $(a,b)$。若 $(a,b)$ 位置**未被填写**，则：
>
>计算 $\lfloor a/b \rfloor$，这需要消耗的**魔力**为 $d_a \log_2 d_a$（其中 $d_a$ 表示 $a$ 在十进制下的位数，即 $d_a=\lfloor 1+ \log_{10}a\rfloor$）。然后枚举正整数 $i$，找到所有**未被填写**的 $(ai,bi)$（$ai\leq n$）位置都填写入 $\lfloor a/b \rfloor$。每次填写需要消耗的魔力为 $d_i$。

由于美娜已经做过一张乘法表，丽莎无需魔力就可以直接计算乘法。现在丽莎想要知道，制作整个除法表需要消耗多少魔力。


为了防止精度问题，只要你的输出与标准输出的**相对误差**不超过 $10^{-6}$ 则视为正确。保证标准输出与实际答案的相对误差不超过 $10^{-10}$。
## 输入格式

输入一行一个正整数 $n$，表示要制作大小为 $n$ 的除法表。
## 输出格式

输出一行一个实数，表示答案。
## 样例

### 样例输入 #1
```
6
```
### 样例输出 #1
```
21.0000000
```
### 样例输入 #2
```
20
```
### 样例输出 #2
```
422.0000000
```
### 样例输入 #3
```
233
```
### 样例输出 #3
```
99838.0384544
```
## 提示

【样例 $1$ 解释】  

由于 $a \leq 6$，$d_a=1$，从而 $d_a \log_2 d_a=0$。也就是说在此范围下只有填写数字会消耗魔力。而每次 $i$ 也不超过 $6$，满足 $d_i=1$，每次填写都消耗固定 $1$ 点魔力，要填写全部 $1+2+3+4+5+6=21$ 个数消耗的魔力就是 $21$。

故答案为 $21$。

【数据范围】  

**本题采用捆绑测试。**  

Subtask 1（15 pts）：$n\le 5000$；  
Subtask 2（15 pts）：$n\le 10^5$；  
Subtask 3（30 pts）：$n\le 2 \times 10^6$；  
Subtask 4（40 pts）：无特殊限制。

对于全部的数据，$1\le n \le 2 \times 10^7$。  

【提示】

$\log_2 n$ 读作「以 $2$ 为底的 $n$ 的对数」。设 $x=\log_2n$，它表示 $2^x=n$。


---

---
title: "「CZOI-R2」天平"
layout: "post"
diff: 提高+/省选-
pid: P11373
tag: ['平衡树', '数论', 'O2优化', '最大公约数 gcd', '差分', '洛谷比赛']
---
# 「CZOI-R2」天平
## 题目描述

你有 $n$ 个**砝码组**，编号为 $1$ 至 $n$。对于第 $i$ 个**砝码组**中的砝码有共同的正整数质量 $a_i$，每个**砝码组**中的**砝码**数量无限。

其中，有 $q$ 次操作：

- `I x v`：在第 $x$ 个**砝码组**后新增一组单个**砝码**质量为 $v$ 的**砝码组**，当 $x=0$ 时表示在最前面新增；
- `D x`：删除第 $x$ 个**砝码组**；
- `A l r v`：把从 $l$ 到 $r$ 的所有**砝码组**中的砝码质量加 $v$；
- `Q l r v`：判断能否用从 $l$ 到 $r$ 的**砝码组**中的砝码，称出质量 $v$。每个砝码组中的砝码可以使用任意个，也可以不用。

对于操作 `I` 和 `D`，操作后编号以及 $n$ 的值自动变化。

称一些**砝码**可以称出质量 $v$，当且仅当存在将这些砝码分别放在天平两边的摆放方法，使得将 $1$ 个质量为 $v$ 的物体摆放在某边可以让天平平衡。
## 输入格式

第一行输入 $2$ 个整数 $n,q$。

第二行输入 $n$ 个整数，第 $i$ 个整数为 $a_i$。

接下来 $q$ 行，每行表示一个操作。
## 输出格式

对于每个 `Q` 操作，输出一行 `YES` 或者 `NO`，表示能否称出重量 $v$。
## 样例

### 样例输入 #1
```
5 5
1 10 8 4 2
I 2 1
A 1 4 4
A 2 4 4
D 5
Q 1 4 4
```
### 样例输出 #1
```
YES
```
### 样例输入 #2
```
10 10
2 2 1 4 2 10 8 7 10 6
Q 5 6 1
Q 5 7 7
I 5 1
Q 4 5 3
Q 2 9 2
A 3 5 1
Q 7 8 5
D 7
A 3 9 7
Q 3 7 6
```
### 样例输出 #2
```
NO
NO
NO
YES
NO
YES
```
## 提示

**【样例解释】**

对于样例组 $1$，最后有 $5$ 个中的**砝码组**，质量分别为 $5,18,9,16,2$。在天平左边放上 $1$ 个**砝码组一**中的**砝码**，右边放上 $1$ 个**砝码组三**的砝码，即可称出质量 $4$。

![](https://cdn.luogu.com.cn/upload/image_hosting/lwd6643t.png)

**【数据范围】**

**本题采用捆绑测试**。

记 $m_1$ 为所有时刻中 $a_i$ 与 $v$ 的最小值，$m_2$ 为所有时刻中 $a_i$ 与 $v$ 的最大值。

- Subtask #1（$5\text{ pts}$）：$1\le n,q\le 10$，$1\le m_1\le m_2 \le50$。
- Subtask #2（$15\text{ pts}$）：$1\le n,q\le 4\times10^2$。
- Subtask #3（$20\text{ pts}$）：没有操作 `I` 与操作 `D`。
- Subtask #4（$60\text{ pts}$）：无特殊性质。

对于 $100\%$ 的数据，$1\le n,q\le 10^5$，$1\le m_1\le m_2\le 10^{18}$，保证所有操作合法，且任意时刻至少存在一个砝码组。


---

---
title: "[迷宫寻路 Round 3] 七连击"
layout: "post"
diff: 提高+/省选-
pid: P11626
tag: ['动态规划 DP', 'O2优化', '最大公约数 gcd', 'ST 表']
---
# [迷宫寻路 Round 3] 七连击
## 题目背景

**任何数和 $0$ 的最大公约数是它本身。**
## 题目描述

小 X 正在研究一个长度为 $n$ 的数列 $\{A\}$，他通过查阅资料，偶然间发现了一个叫做“七连击”的式子：$\sum\limits_{a=1}^n\sum\limits_{b=a+1}^n\sum\limits_{c=b+1}^n\sum\limits_{d=c+1}^n\sum\limits_{e=d+1}^n\sum\limits_{f=e+1}^n\sum\limits_{g=f+1}^n ((\gcd\limits_{i=1}^aA_i)+(\gcd\limits_{i=a+1}^bA_i)+(\gcd\limits_{i=b+1}^cA_i)+(\gcd\limits_{i=c+1}^dA_i)+(\gcd\limits_{i=d+1}^eA_i)+(\gcd\limits_{i=e+1}^fA_i)+(\gcd\limits_{i=f+1}^gA_i))$。

其中 $(\gcd\limits_{i=l}^r A_i)$ 表示 $A_l,A_{l+1},\dots,A_r$ 的最大公约数。

现在小 X 希望你求出这个式子的值。
由于答案可能很大，他只需要你输出答案对 $998244353$ 取模的结果。
## 输入格式

第一行一个整数 $n$，表示序列长度。

第二行 $n$ 个整数表示序列 $\{A\}$。
## 输出格式

一行一个整数表示答案对 $998244353$ 取模的结果。
## 样例

### 样例输入 #1
```
7
3 4 2 5 6 3 4

```
### 样例输出 #1
```
27

```
### 样例输入 #2
```
10
9 9 9 8 8 8 72 72 72 2

```
### 样例输出 #2
```
20040
```
### 样例输入 #3
```
20
3 5 5 5 7 15 20 14 28 9 36 3 4 5 7 19 16 28 37 29

```
### 样例输出 #3
```
3207876

```
### 样例输入 #4
```
30
1 9 8 8 8 3 3 4 2 2 3 3 9 8 8 6 6 7 3 3 6 6 8 8 4 3 3 6 6 8
```
### 样例输出 #4
```
34595704
```
### 样例输入 #5
```
50
9 9 9 9 63 72 36 36 4 4 4 20 20 20 10 10 70 2 12 9 9 9 9 63 72 36 36 4 4 4 20 20 20 10 10 70 2 12 9 9 9 9 63 72 36 36 4 4 4 4
```
### 样例输出 #5
```
24688627
```
## 提示

**本题采用捆绑测试。**

对于所有数据，$7\le n\le 10^5$，$0\le A_i\le 10^9$。

| 子任务编号 | $n\leq$ | $A_i\leq$ | 特殊性质 | 分数 |
| :----------: | :----------: | :----------: | :----------: | :----------: |
| $0$ | $7$ | $10^9$ | 否 | $1$ |
| $1$ | $10$ | $10^9$ | 否 | $9$ |
| $2$ | $100$ | $10^9$ | 否 | $10$ |
| $3$ | $1000$ | $10^9$ | 否 | $20$ |
| $4$ | $10^5$ | $100$ | 否 | $10$ |
| $5$ | $10^5$ | $10^9$ | 是 | $10$ |
| $6$ | $10^5$ | $10^9$ | 否 | $40$ |

特殊性质： 对于任意满足 $1\le i\le n$ 的整数 $i$，$A_i$ 在 $[0,10^9]$ 中随机生成。


---

---
title: "[PA 2019 Final] 一安在？ / Gdzie jest jedynka? 2"
layout: "post"
diff: 提高+/省选-
pid: P11818
tag: ['2019', '交互题', 'Special Judge', '最大公约数 gcd', 'Ad-hoc', 'PA（波兰）']
---
# [PA 2019 Final] 一安在？ / Gdzie jest jedynka? 2
## 题目背景

**请使用 C++14 或者更高的版本提交，否则不保证可以编译成功。**



本题数据为自造。交互库疑似有点弱，欢迎加强。

- std: KanameMadoka & Wuyanru；
- interactor：KanameMadoka & Starrykiller；
- validator & generator：Starrykiller；
- special thanks to FFTotoro。

**本题 $\texttt{\#2}\sim\texttt{\#7}$ 为长度为 $3\sim 8$ 的全排列，在这几个测试点中交互库是不自适应的。**

## 题目描述

**这是一道交互题。** 本题中，**交互库是自适应的**。

有一个**隐藏的** $0\sim n-1$ 的排列 $p_0,p_1,\cdots,p_{n-1}$。

你可以询问至多 $\lceil\frac{5n}{2}\rceil$ 次：每次询问给定 $i,j$（$i\neq j$），交互库会返回 $\gcd(p_{i},p_j)$ 的值。特别地，定义 $\gcd(0,a)=\gcd(a,0)=a$。

找到这个排列中 $1$ 的位置。也就是，找到 $j$，使得 $p_j=1$。

### 实现细节

**本题单个测试点内有多组测试数据。**


你不需要，也不应该实现 `main` 函数。

你需要在文件头加入以下内容：

```cpp
int ask(int, int);
```

你应该实现以下的函数：

- `int solve(int n)`：处理一组排列长度为 $n$ 的数据。
    - 返回一个非负整数 $j$ 满足 $p_j=1$。你需要保证 $0\le j\lt n$，且 $p_j=1$。

实际测评时将会多次调用 `solve` 函数。

你可以调用以下的函数：

- `int ask(int i, int j)`：询问 $\gcd(p_i,p_j)$。
	- 你需要保证 $0\le i,j\lt n$，且 $i\neq j$。

需要注意的是，**交互库是自适应的**，也就是，交互库会根据你的询问（在不矛盾的前提下）动态调整答案。

## 输入格式

见【实现细节】。

## 输出格式

见【实现细节】。

## 样例

### 样例输入 #1
```
1
5

1

2

3
```
### 样例输出 #1
```


? 1 4

? 1 0

? 2 3

! 3
```
## 提示



### 样例交互

设原序列为 $[4,2,0,3,1]$。

| 交互库 | 选手程序 |
| :--: | :--: |
| 调用 $\operatorname{solve}(5)$ | |
| 返回 $\gcd(p_1,p_4)=1$ | 调用 $\operatorname{ask}(1,4)$ |
| 返回 $\gcd(p_1,p_0)=2$ | 调用 $\operatorname{ask}(1,0)$ |
| 返回 $\gcd(p_2,p_3)=3$ | 调用 $\operatorname{ask}(2,3)$ |
| $p_4=1$，判定为 Accepted | 返回 $4$ |

需要注意的是，**样例交互仅为交互格式示意，不代表根据这些信息能唯一确定答案。** 交互库是自适应的。

---

### 数据范围

- $3\le n,\sum n\le 5\times 10^5$。

再次提醒，**交互库是自适应的**。


---

---
title: "[UOI 2021] 哥萨克与 GCD"
layout: "post"
diff: 提高+/省选-
pid: P12579
tag: ['线段树', '2021', '最大公约数 gcd', 'UOI（乌克兰）']
---
# [UOI 2021] 哥萨克与 GCD
## 题目描述

哥萨克 Vus 得到了一个包含 $n$ 个整数的数组 $a$。随后，他被告知存在另一个同样由 $n$ 个整数组成的数组 $b$，但具体内容未知。为了确定数组 $b$，哥萨克可以无限次使用以下操作
  - 选择两个整数 $1 \leq l \leq r \leq n$。
  - 查询 $b_l + b_{l + 1} + \dots + b_r$ 的和。
  - 支付 $\gcd(a_l, a_{l+1}, ..., a_r)$ 戈比，其中 $\gcd$ 表示最大公约数（例如 $\gcd(3, 5) = 1$，而 $\gcd(15, 30, 6) = 3$）。

Vus 需要你求出确定数组 $b$ 所需的最小戈比数。

随后，哥萨克会对数组 $a$ 进行 $q$ 次修改，每次将某个 $a_i$ 改为 $x$。每次修改后，你需要重新计算更新后的数组所需的最小戈比数。
## 输入格式

第一行包含两个整数 $n$ 和 $q$ $(1 \leq n \leq 10^5, 0 \leq q \leq 10^5)$ —— 分别表示数组 $a$ 的长度和修改次数。

第二行包含 $n$ 个整数 $a_1, a_2, ..., a_n$ $(1 \leq a_i \leq 10^9)$ —— 数组 $a$ 的初始元素。

接下来的 $q$ 行，每行包含两个整数 $i$ 和 $x$ $(1 \leq i \leq n, 1 \leq x \leq 10^9)$ —— 表示修改的位置和修改后的值。
## 输出格式

输出 $q + 1$ 个数字 —— 分别对应初始数组和每次修改后的数组所需的最小戈比数。

第一个数字是初始数组 $a$ 的答案。

接下来的 $q$ 个数字是每次修改后的答案。
## 样例

### 样例输入 #1
```
5 3
20 40 9 25 15
3 10
5 21
4 135
```
### 样例输出 #1
```
5
25
9
11
```
### 样例输入 #2
```
4 2
20 4 8 36
1 2
4 18
```
### 样例输出 #2
```
16
8
8
```
## 提示

### 评分标准

- （8 分）：$n \le 10^2, q = 0$；
- （7 分）：$n \le 10^3, q = 0$；
- （11 分）：$q = 0$；
- （12 分）：$q \leq 100$；
- （9 分）：$q \leq 500$；
- （23 分）：$q \leq 10000$；
- （30 分）：无额外限制。

翻译由 DeepSeek V3 完成


---

---
title: "[NOI2010] 能量采集"
layout: "post"
diff: 提高+/省选-
pid: P1447
tag: ['数学', '2010', 'NOI', '最大公约数 gcd', '莫比乌斯反演', '整除分块']
---
# [NOI2010] 能量采集
## 题目描述

栋栋有一块长方形的地，他在地上种了一种能量植物，这种植物可以采集太阳光的能量。在这些植物采集能量后，栋栋再使用一个能量汇集机器把这些植物采集到的能量汇集到一起。

栋栋的植物种得非常整齐，一共有 $n$ 列，每列有 $m$ 棵，植物的横竖间距都一样，因此对于每一棵植物，栋栋可以用一个坐标 $(x, y)$ 来表示，其中 $x$ 的范围是 $1$ 至 $n$，$y$ 的范围是 $1$ 至 $m$，表示是在第 $x$ 列的第 $y$ 棵。

由于能量汇集机器较大，不便移动，栋栋将它放在了一个角上，坐标正好是 $(0, 0)$。

能量汇集机器在汇集的过程中有一定的能量损失。如果一棵植物与能量汇集机器连接而成的线段上有 $k$ 棵植物，则能量的损失为 $2k + 1$。例如，当能量汇集机器收集坐标为 $(2, 4)$ 的植物时，由于连接线段上存在一棵植物 $(1, 2)$，会产生 $3$ 的能量损失。注意，如果一棵植物与能量汇集机器连接的线段上没有植物，则能量损失为 $1$。现在要计算总的能量损失。

下面给出了一个能量采集的例子，其中 $n = 5$，$m = 4$，一共有 $20$ 棵植物，在每棵植物上标明了能量汇集机器收集它的能量时产生的能量损失。

![](https://cdn.luogu.com.cn/upload/image_hosting/fhzpmm7b.png)

在这个例子中，总共产生了 $36$ 的能量损失。
## 输入格式

一行两个整数 $n,m$。
## 输出格式

仅包含一个整数，表示总共产生的能量损失。

## 样例

### 样例输入 #1
```
5 4

```
### 样例输出 #1
```
36

```
### 样例输入 #2
```
3 4
```
### 样例输出 #2
```
20

```
## 提示

- 对于 $10\%$ 的数据：$n, m \leq 10$；
- 对于 $50\%$ 的数据：$n, m \leq 100$；
- 对于 $80\%$ 的数据：$n, m \leq 10^3$；
- 对于 $90\%$ 的数据：$n, m \leq 10^4$；
- 对于 $100\%$ 的数据：$1 \leq n, m \leq 10^5$。


---

---
title: "[SDOI2009] SuperGCD"
layout: "post"
diff: 提高+/省选-
pid: P2152
tag: ['高精度', '2009', '各省省选', '山东', 'O2优化', '最大公约数 gcd']
---
# [SDOI2009] SuperGCD
## 题目描述

Sheng bill 有着惊人的心算能力，甚至能用大脑计算出两个巨大的数的最大公约数！因此他经常和别人比赛计算最大公约数。有一天Sheng bill很嚣张地找到了你，并要求和你比赛，但是输给 Sheng bill 岂不是很丢脸！所以你决定写一个程序来教训他。
## 输入格式

共两行，第一行一个整数 $a$，第二行一个整数 $b$。
## 输出格式

一行，表示 $a$ 和 $b$ 的最大公约数。
## 样例

### 样例输入 #1
```
12
54
```
### 样例输出 #1
```
6
```
## 提示

#### 数据规模与约定
- 对于 $20\%$ 的数据，有 $0<a,b\le 10^{18}$。
- 对于 $100\%$ 的数据，有 $0<a,b\le 10^{10000}$。


---

---
title: "[HAOI2012] 高速公路"
layout: "post"
diff: 提高+/省选-
pid: P2221
tag: ['2012', '河南', '线段树', '各省省选', 'O2优化', '最大公约数 gcd', '期望']
---
# [HAOI2012] 高速公路
## 题目背景

Y901 高速公路是一条重要的交通纽带，政府部门建设初期的投入以及使用期间的养护费用都不低，因此政府在这条高速公路上设立了许多收费站。
## 题目描述

Y901 高速公路是一条由 $n-1$ 段路以及 $n$ 个收费站组成的东西向的链，我们按照由西向东的顺序将收费站依次编号为 $1 \sim n$，从收费站 $i$ 行驶到 $i+1$（或从 $i+1$ 行驶到 $i$）需要收取 $v_i$ 的费用。高速路刚建成时所有的路段都是免费的，即所有 $v_i = 0$。

政府部门根据实际情况，会不定期地对连续路段的收费标准进行调整，根据政策涨价或降价。

无聊的小 A 同学总喜欢研究一些稀奇古怪的问题，他开车在这条高速路上行驶时想到了这样一个问题：对于给定的 $l,r$，在第 $l$ 个到第 $r$ 个收费站里等概率随机取出两个不同的收费站 $a$ 和 $b$，那么从 $a$ 行驶到 $b$ 将期望花费多少费用呢?

## 输入格式

第一行有两个整数，分别表示收费站个数 $n$，和询问与调整费用的总数 $m$。

接下来 $m$ 行，每行表示一次调整或询问，首先有一个字符 $op$。

- 若 $op$ 为 `C`，则后面有三个整数 $l, r, v$，表示将第 $l$ 个收费站到第 $r$ 个收费站之间所有**道路**的通行费用增加 $v$。
- 若 $op$ 为 `Q`，则后面有两个整数 $l, r$，对于给定的 $l, r$，请回答小 A 的问题。
## 输出格式

对于每次询问，输出一行一个既约分数表示答案。

若答案为一个整数 $a$，请输出 `a/1`。
## 样例

### 样例输入 #1
```
4 5
C 1 4 2
C 1 2 -1
Q 1 2
Q 2 4
Q 1 4

```
### 样例输出 #1
```
1/1
8/3
17/6

```
## 提示

#### 数据规模与约定

本题共 $10$ 个测试点，各测试点数据规模如下表所示


| 测试点编号 | $n=$ | $m=$ |
| :------: | :---: | :-: |
|$1$| $10$ |$10$|
|$2$|    $100$ |    $100$ |
|$3$  |  $1000$ |   $1000$|
|$4$   | $10000$ |   $10000$|
|$5$    |$50000$  |  $50000$|
|$6$  |  $60000$   | $60000$|
|$7$   | $70000$ |   $70000$|
|$8$   | $80000$  |  $80000$|
|$9$    |$90000$   | $90000$|
|$10$   | $100000$  |  $100000$|

对于全部的测试点，保证 $1 \leq n, m \leq 10^5$，$op \in \{\texttt C, \texttt Q\}$，$1 \leq l \leq r \leq n$，$-10^4 \leq v \leq 10^4$，在任何时刻，$0\leq v_i \leq 10^4$。


---

---
title: "[HNOI2002] 跳蚤"
layout: "post"
diff: 提高+/省选-
pid: P2231
tag: ['2002', '各省省选', '数论', '湖南', '最大公约数 gcd', '不定方程', '莫比乌斯反演']
---
# [HNOI2002] 跳蚤
## 题目描述

Z 城市居住着很多只跳蚤。在 Z 城市周六生活频道有一个娱乐节目。一只跳蚤将被请上一个高空钢丝的正中央。钢丝很长，可以看作是无限长。节目主持人会给该跳蚤发一张卡片。卡片上写有 $N+1$ 个自然数。其中最后一个是 $M$，而前 $N$ 个数都不超过 $M$，卡片上允许有相同的数字。跳蚤每次可以从卡片上任意选择一个自然数 $S$，然后向左，或向右跳 $S$ 个单位长度。而他最终的任务是跳到距离他左边一个单位长度的地方，并捡起位于那里的礼物。

比如当 $N=2,M=18$ 时，持有卡片 $(10, 15, 18)$ 的跳蚤，就可以完成任务：他可以先向左跳 $10$ 个单位长度，然后再连向左跳 $3$ 次，每次 $15$ 个单位长度，最后再向右连跳 $3$ 次，每次 $18$ 个单位长度。而持有卡片 $(12, 15, 18)$ 的跳蚤，则怎么也不可能跳到距他左边一个单位长度的地方。

当确定 $N$ 和 $M$ 后，显然一共有 $M^ N$ 张不同的卡片。现在的问题是，在这所有的卡片中，有多少张可以完成任务。

## 输入格式

输入文件有且仅有一行，包括用空格分开的两个整数 $N$ 和 $M$。

## 输出格式

输出文件有且仅有一行，即可以完成任务的卡片数。

$1\le N\le M\le 10^8$，且$M^N\le 10^{16}$。

## 样例

### 样例输入 #1
```
2 4
```
### 样例输出 #1
```
12
```
## 提示

这12张卡片分别是：

$(1, 1, 4), (1, 2, 4), (1, 3, 4), (1, 4, 4), (2, 1, 4), (2, 3, 4)$

$(3, 1, 4), (3, 2, 4), (3, 3, 4), (3, 4, 4), (4, 1, 4), (4, 3, 4)$



---

---
title: "[SDOI2006] 线性方程组"
layout: "post"
diff: 提高+/省选-
pid: P2455
tag: ['2006', '各省省选', '山东', 'Special Judge', '素数判断,质数,筛法', '最大公约数 gcd', '排列组合', '高斯消元']
---
# [SDOI2006] 线性方程组
## 题目描述

已知 $n$ 元线性一次方程组。

$$ \begin{cases} a_{1, 1} x_1 + a_{1, 2} x_2 + \cdots + a_{1, n} x_n = b_1 \\ a_{2, 1} x_1 + a_{2, 2} x_2 + \cdots + a_{2, n} x_n = b_2 \\ \cdots \\ a_{n,1} x_1 + a_{n, 2} x_2 + \cdots + a_{n, n} x_n = b_n \end{cases}$$

请根据输入的数据，编程输出方程组的解的情况。
## 输入格式

第一行输入未知数的个数 $n$。  
接下来 $n$ 行，每行 $n + 1$ 个整数，表示每一个方程的系数及方程右边的值。

## 输出格式

如果有唯一解，则输出解。你的结果被认为正确，当且仅当对于每一个 $x_i$ 而言结果值与标准答案值的绝对误差或者相对误差不超过 $0.01$。

如果方程组无解输出 $-1$；
如果有无穷多实数解，输出 $0$；
## 样例

### 样例输入 #1
```
3
2 -1 1 1
4 1 -1 5
1 1 1 0
```
### 样例输出 #1
```
x1=1.00
x2=0.00
x3=-1.00

```
## 提示

【数据范围】  
对于 $100\%$ 的数据，$1 \le n \le 50$。对于 $\forall 1\le i, j \le n$，有 $|a_{i, j}| \le 100$，$|b_i| \le 300$。


---

---
title: "[SDOI2011] 计算器"
layout: "post"
diff: 提高+/省选-
pid: P2485
tag: ['2011', '各省省选', '山东', 'O2优化', '素数判断,质数,筛法', '最大公约数 gcd', '逆元']
---
# [SDOI2011] 计算器
## 题目背景

2024-8-11 update: 新增一组 hack。
## 题目描述

你被要求设计一个计算器完成以下三项任务：

1. 给定 $y,z,p$，计算 $y^z \bmod p$ 的值；
2. 给定 $y,z,p$，计算满足 $xy \equiv z \pmod p$ 的最小非负整数 $x$；
3. 给定 $y,z,p$，计算满足 $y^x \equiv z \pmod p$ 的最小非负整数 $x$。

为了拿到奖品，全力以赴吧！

## 输入格式

输入文件包含多组数据。

第一行包含两个正整数 $T,K$，分别表示数据组数和询问类型（对于一个测试点内的所有数据，询问类型相同）。

以下 $T$ 行每行包含三个正整数 $y,z,p$，描述一个询问。
## 输出格式

输出文件包括 $T$ 行。

对于每个询问，输出一行答案。

对于询问类型 2 和 3，如果不存在满足条件的，则输出 `Orz, I cannot find x!`。
## 样例

### 样例输入 #1
```
3 1
2 1 3
2 2 3
2 3 3

```
### 样例输出 #1
```
2
1
2

```
### 样例输入 #2
```
3 2
2 1 3
2 2 3
2 3 3

```
### 样例输出 #2
```
2
1
0

```
### 样例输入 #3
```
4 3
2 1 3
2 2 3
2 3 3
2 4 3

```
### 样例输出 #3
```
0
1
Orz, I cannot find x!
0

```
## 提示

测试点共分为三类，各类测试点占总测试点的比例如下：

| $K=$ | 测试点占比 |
| :--: | :--------: |
| $1$  |   $20\%$   |
| $2$  |   $35\%$   |
| $3$  |   $45\%$   |

所有数据均满足：$1 \leq y,z,p \leq 10^9$，$p$ 是质数，$1 \leq T \leq 10$。


---

---
title: "[HAOI2011] 向量"
layout: "post"
diff: 提高+/省选-
pid: P2520
tag: ['数学', '2011', '河南', '各省省选', '最大公约数 gcd', '向量']
---
# [HAOI2011] 向量
## 题目描述

给你一对数 $(a,b)$，你可以任意使用 $(a,b), (a,-b), (-a,b), (-a,-b), (b,a), (b,-a), (-b,a), (-b,-a)$ 这些向量，问你能不能拼出另一个向量 $(x,y)$。

说明：这里的拼就是使得你选出的向量之和为 $(x,y)$。
## 输入格式

第一行数组组数 $t(t\leq50000)$。

接下来 $t$ 行，每行四个整数 $a,b,x,y(-2\times10^9\leq a,b,x,y\leq2\times10^9)$。
## 输出格式

$t$ 行，每行为 `Y` 或者为 `N`，分别表示可以拼出来，不能拼出来。
## 样例

### 样例输入 #1
```
3

2 1 3 3

1 1 0 1

1 0 -2 3
```
### 样例输出 #1
```
Y

N

Y
```
## 提示

### 样例解释

第一组：$(2,1)+(1,2)=(3,3)$。

第三组：$(-1,0)+(-1,0)+(0,1)+(0,1)+(0,1)=(-2,3)$。


---

---
title: "[HAOI2011] Problem b"
layout: "post"
diff: 提高+/省选-
pid: P2522
tag: ['2011', '河南', '各省省选', '最大公约数 gcd', '莫比乌斯反演', '容斥原理']
---
# [HAOI2011] Problem b
## 题目描述

对于给出的 $n$ 个询问，每次求有多少个数对 $(x,y)$，满足 $a \le x \le b$，$c \le y \le d$，且 $\gcd(x,y) = k$，$\gcd(x,y)$ 函数为 $x$ 和 $y$ 的最大公约数。
## 输入格式

第一行一个整数 $n$，接下来 $n$ 行每行五个整数，分别表示 $a,b,c,d,k$。
## 输出格式

共 $n$ 行，每行一个整数表示满足要求的数对 $(x,y)$ 的个数。
## 样例

### 样例输入 #1
```
2
2 5 1 5 1
1 5 1 5 2
```
### 样例输出 #1
```
14
3
```
## 提示

对于 $100\%$ 的数据满足：$1 \le n,k \le 5 \times 10^4$，$1 \le a \le b \le 5 \times 10^4$，$1 \le c \le d \le 5 \times 10^4$。


---

---
title: "[SDOI2013] 随机数生成器"
layout: "post"
diff: 提高+/省选-
pid: P3306
tag: ['2013', '山东', 'O2优化', '素数判断,质数,筛法', '最大公约数 gcd', '逆元']
---
# [SDOI2013] 随机数生成器
## 题目背景

小 W 喜欢读书，尤其喜欢读《约翰克里斯朵夫》。
## 题目描述

最近小 W 准备读一本新书，这本书一共有 $p$ 页，页码范围为 $0 \sim p-1$。

小 W 很忙，所以每天只能读一页书。为了使事情有趣一些，他打算使用 NOI2012 上学习的线性同余法生成一个序列，来决定每天具体读哪一页。

我们用 $x_i$ 来表示通过这种方法生成出来的第 $i$ 个数，也即小 W 第 $i$ 天会读哪一页。这个方法需要设置 $3$ 个参数 $a,b,x_1$，满足 $0\leq a,b,x_1\lt p$，且 $a,b,x_1$ 都是整数。按照下面的公式生成出来一系列的整数：
$$x_{i+1} \equiv a \times x_i+b \pmod p$$
其中 $\bmod$ 表示取余操作。

但是这种方法可能导致某两天读的页码一样。

小 W 要读这本书的第 $t$ 页，所以他想知道最早在哪一天能读到第 $t$ 页，或者指出他永远不会读到第 $t$ 页。

## 输入格式

**本题单测试点内有多组测试数据**。

第一行是一个整数 $T$，表示测试数据组数。

接下来 $T$ 行，每行有五个整数 $p, a, b, x_1, t$，表示一组数据。

## 输出格式

对于每组数据，输出一行一个整数表示他最早读到第 $t$ 页是哪一天。如果他永远不会读到第 $t$ 页，输出$-1$。

## 样例

### 样例输入 #1
```
3
7 1 1 3 3
7 2 2 2 0
7 2 2 2 1

```
### 样例输出 #1
```
1 
3 
-1
```
## 提示

#### 数据规模与约定

对于全部的测试点，保证：

- $1 \leq T \leq 50$。
- $0 \leq a, b, x_1, t \lt p$，$2 \leq p \leq 10^9$。
- $p$ 为质数。


---

---
title: "[POI 2007] ZAP-Queries"
layout: "post"
diff: 提高+/省选-
pid: P3455
tag: ['2007', 'POI（波兰）', '最大公约数 gcd', '莫比乌斯反演']
---
# [POI 2007] ZAP-Queries
## 题目描述

密码学家正在尝试破解一种叫 BSA 的密码。

他发现，在破解一条消息的同时，他还需要回答这样一种问题：

给出 $a,b,d$，求满足 $1 \leq x \leq a$，$1 \leq y \leq b$，且 $\gcd(x,y)=d$ 的二元组 $(x,y)$ 的数量。

因为要解决的问题实在太多了，他便过来寻求你的帮助。
## 输入格式

输入第一行一个整数 $n$，代表要回答的问题个数。

接下来 $n$ 行，每行三个整数 $a,b,d$。
## 输出格式

对于每组询问，输出一个整数代表答案。
## 样例

### 样例输入 #1
```
2
4 5 2
6 4 3
```
### 样例输出 #1
```
3
2
```
## 提示

#### 数据规模与约定

对于全部的测试点，保证 $1 \leq n \leq 5 \times 10^4$，$1 \leq d \leq a,b \leq 5 \times 10^4$。


---

---
title: "[POI 2011] SEJ-Strongbox"
layout: "post"
diff: 提高+/省选-
pid: P3518
tag: ['数学', '2011', 'POI（波兰）', '最大公约数 gcd']
---
# [POI 2011] SEJ-Strongbox
## 题目描述

Byteasar is a famous safe-cracker, who renounced his criminal activity and    got into testing and certifying anti-burglary devices.

He has just received a new kind of strongbox for tests: a combinatorial safe.

A combinatorial safe is something different from a combination safe,    even though it is opened with a rotary dial.

The dial can be set in $n$ different positions, numbered from 0 to $n-1$.

Setting the dial in some of these positions opens the safe, while in others it does not.

And here is the combinatorial property, from which the name comes from:

if $x$ and $y$ are opening positions, then so is $(x+y)\ mod\ n$ too;    note that is holds for $x=y$ as well.

Byteasar tried $k$ different positions of the dial: $m_1,m_2,\cdots,m_k$.

The positions $m_1,m_2,\cdots,m_{k-1}$ did not open the safe,only the last position $m_k$ did.

Byteasar is already tired from checking these $k$ positions and has thus    absolutely no intention of trying the remaining ones.

He would like to know however, based on what he already knows about the    positions he tried, what is the maximum possible number of positions that    open the safe.

Help him by writing an appropriate program!
## 输入格式

The first line of the standard input gives two integers $n$ and $k$,      separated by a single space, $1\le k\le 250\ 000$, $k\le n\le 10^{14}$.

The second line holds $k$ different integers, also separated by single      spaces, $m_1,m_2,\cdots,m_k$, $0\le m_i<n$.

You can assume that the input data correspond to a certain combinatorial      safe that complies with the description above.

In tests worth approximately 70% of the points it holds that $k\le 1\ 000$.

In some of those tests, worth approximately 20% of the points,      the following conditions hold in addition: $n\le 10^8$ and $k\le 100$.

## 输出格式

Your program should print out to the first and only line of the standard output a single integer: the maximum number of the dial's positions that can open the safe.

## 样例

### 样例输入 #1
```
42 5
28 31 10 38 24
```
### 样例输出 #1
```
14
```
## 题目翻译

有一个密码箱，$0$ 到 $n-1$ 中的某些整数是它的密码。且满足：若 $a$ 和 $b$ 是它的密码，则 $(a+b)\bmod n$ 也是它的密码（$a$，$b$ 可以相等）。某人试了 $k$ 次密码，前 $k-1$ 次都失败了，最后一次成功了。

问，该密码箱最多有多少种不同的密码。

## 输入格式

第一行两个整数 $n$，$k$。

第二行为 $k$ 个非负整数，表示每次试的密码。

## 输出格式

一行一个整数，表示答案。


---

---
title: "[POI 2014] PAN-Solar Panels"
layout: "post"
diff: 提高+/省选-
pid: P3579
tag: ['数学', '2014', 'POI（波兰）', '最大公约数 gcd']
---
# [POI 2014] PAN-Solar Panels
## 题目描述

对于 $n$ 组询问，每组询问给定四个整数 $a,b,c,d$，从区间 $[a,b]$ 和 $[c,d]$ 中任意选取两个整数 $x$ 和 $y$，求 $\gcd(x,y)$ 的最大值是多少。
## 输入格式

第一行一个整数 $n$ 代表询问数。   
接下来 $n$ 行每行代表一个询问，四个整数 $a,b,c,d$ 代表两个区间的范围。
## 输出格式

$n$ 行每行一个整数代表区间 $[a,b]$ 和 $[c,d]$ 中任意选取两个整数 $x$ 和 $y$，$\gcd(x,y)$ 的最大值。
## 样例

### 样例输入 #1
```
4
3 9 8 8
1 10 11 15
4 7 22 23
2 5 19 24

```
### 样例输出 #1
```
8
7
2
5

```
## 提示

### 数据规模与约定

对于 $100\%$ 的数据，$1 \le n \le 1000$，$1 \le a \le b \le 10^9$，$1 \le c\le d \le 10^9$。

### 说明

Translated by @一只书虫仔。


---

---
title: "[SCOI2009] 生日快乐"
layout: "post"
diff: 提高+/省选-
pid: P4160
tag: ['动态规划 DP', '搜索', '2009', '四川', '各省省选', '深度优先搜索 DFS', '最大公约数 gcd']
---
# [SCOI2009] 生日快乐
## 题目描述

windy 的生日到了，为了庆祝生日，他的朋友们帮他买了一个边长分别为 $X$ 和 $Y$ 的矩形蛋糕。

现在包括 windy，一共有 $N$ 个人来分这块大蛋糕，要求每个人必须获得相同面积的蛋糕。

windy 主刀，每一切只能平行于一块蛋糕的一边（任意一边），并且必须把这块蛋糕切成两块。

这样，要切成 $N$ 块蛋糕，windy 必须切 $N-1$ 次。

为了使得每块蛋糕看起来漂亮，我们要求 $N$ 块蛋糕的长边与短边的比值的最大值最小。

你能帮助 windy 求出这个比值么？

## 输入格式

一行三个整数 $X,Y,N$。

## 输出格式

一行一个浮点数，保留 $6$ 位小数。

## 样例

### 样例输入 #1
```
5 5 5
```
### 样例输出 #1
```
1.800000
```
## 提示

对于 $100\%$ 的数据，满足 $1 \le X,Y \le 10^4$，$1\le N\le 10$。



---

---
title: "付公主的矩形"
layout: "post"
diff: 提高+/省选-
pid: P4388
tag: ['枚举', '素数判断,质数,筛法', '最大公约数 gcd']
---
# 付公主的矩形
## 题目背景

付公主月考炸了，感到非常郁闷。
## 题目描述

为了排解心中的怒气，她造了大量的稻草人来发泄。每天付公主都会把一些稻草人摆成一个 $ R*C $ 的矩形，矩形的每个方格上都有一个稻草人。然后她站在这个矩形的左上角，向矩形的右下角射箭。付公主的箭术过人，她能穿透任意多的稻草人。弓箭经过的方格上的稻草人难逃厄运，报废掉了。看着被毁坏的稻草人，付公主开心了一些。

但是制造稻草人需要大量的金钱，所以付公主不希望坏掉太多的稻草人，所以她每天都选择毁坏掉 $ N $ 个稻草人。付公主还是个喜新厌旧的人，她希望每天能看到一种不同的稻草人摆放矩形。矩形是可以旋转的，即 $ R\times C $ 和 $ C\times R $ 等价。她毫不费力地算出了摆放方案数，于是她决定刁难你一下。不甘示弱的你决定写个程序计算这个数来提交付公主的答卷。
## 输入格式

输入只有一行且只有一个数 $N$（$1\le N\le 10^6$），代表每次被毁坏的稻草人数量。
## 输出格式

一个整数表示总方案数。
## 样例

### 样例输入 #1
```
4
```
### 样例输出 #1
```
4
```
## 提示

样例解释：
![](https://cdn.luogu.com.cn/upload/pic/16262.png)

对于 $40\%$ 的数据，$1 \le N \le 10^4$。

对于 $100\%$ 的数据，$1 \le N \le 10^6$。



---

---
title: "红鲤鱼与绿鲤鱼"
layout: "post"
diff: 提高+/省选-
pid: P4773
tag: ['数学', '高精度', '最大公约数 gcd']
---
# 红鲤鱼与绿鲤鱼
## 题目背景

JerryC家里除了有驴之外，还有一个有着红鲤鱼和绿鲤鱼的鱼缸。
## 题目描述

在JerryC家里的鱼缸里，有一些红鲤鱼和绿鲤鱼(鱼缸里没有驴！)这天晚上23:05的时候，JerryC闲的无聊，于是打开了某神秘OJ开始爆肝。。作为一名膜法师，JerryC可以通过预言术得知下一次自己的提交是对是错。当然，预言术使用的工具就是眼前的鱼缸了。每当JerryC的预言术指示一只红鲤鱼的时候，就说明这次提交会WA，同时会增加5min的罚时；如果是绿鲤鱼就会AC。(当然，由于JerryC的膜法，JerryC是不会番薯田扛把子的。JerryC第一次提交会在第5min，而且不幸的是JerryC的膜法有5min的冷却时间)并且JerryC在每一次预言后就会把预言到的那一只鲤鱼取出来，以便比赛完毕后给鱼缸换水~~(给自己换换口味)~~现在JerryC告诉你他家里有多少条红鲤鱼和绿鲤鱼，请你告诉他他这场比赛的罚时期望是多少。当然，JerryC会按顺序做题，并且罚时只会记录AC的题目，算罚时的时候需要加上AC的时间，并且所有的鲤鱼用完后还会提交一次，而且这一次JerryC并不会预测并且必定AC。）
由于JerryC脾气比较犟，所以他不会因为WA掉一道题而换一道题去做，除非AC。
## 输入格式

一行，两个正整数A，B，分别表示有多少条红鲤鱼和绿鲤鱼。
## 输出格式

一行，一个正整数，表示罚时的期望模998244853的结果。如果结果除不尽时，若结果可以表示为 $ \frac{P}{Q} $ ，则需要输出 $ P * Q^{mod-2} \% mod $  。
## 样例

### 样例输入 #1
```
1 1
```
### 样例输出 #1
```
499122454
```
### 样例输入 #2
```
1 2
```
### 样例输出 #2
```
45
```
## 提示

$$ 10 pts: 1 \leqslant A + B \leqslant 5 $$
$$ 30 pts: 1 \leqslant A + B \leqslant 20 $$
$$ 70 pts: 1 \leqslant A + B \leqslant 3000 $$
$$ 100 pts: 1 \leqslant A \leqslant 1e18, 1 \leqslant B \leqslant 1e7 $$

最后六个点时限2400ms！！！
其他点时限400ms！！！

$$ \color{white}{\text{温馨提示:注意模数}}$$

样例1: 
有两种可能： 
1. AC WA AC
2. WA AC AC
 
第一个情况的罚时是5(第5分钟AC)+5(WA一次罚时5分钟)+15(第15分钟AC)=25 

第二个情况的罚时是5(WA一次罚时5分钟)+10(第10分钟AC)+15(第15分钟AC)=30 

所以期望罚时为$ \frac{25+30}{2} = \frac{55}{2} $ 需要对分数取模，所以最后答案为499122454。




---

---
title: "【模板】二元一次不定方程 (exgcd)"
layout: "post"
diff: 提高+/省选-
pid: P5656
tag: ['数学', '最大公约数 gcd', '扩展欧几里德算法']
---
# 【模板】二元一次不定方程 (exgcd)
## 题目描述

给定不定方程

$$ax+by=c$$

若该方程无整数解，输出 $-1$。  
若该方程有整数解，且有正整数解，则输出其**正整数**解的数量，所有**正整数**解中 $x$ 的最小值，所有**正整数**解中 $y$ 的最小值，所有**正整数**解中 $x$ 的最大值，以及所有**正整数**解中 $y$ 的最大值。  
若方程有整数解，但没有正整数解，你需要输出所有**整数解**中 $x$ 的最小正整数值， $y$ 的最小正整数值。

正整数解即为 $x, y$ 均为正整数的解，$\boldsymbol{0}$ **不是正整数**。  
整数解即为 $x,y$ 均为整数的解。  
$x$ 的最小正整数值即所有 $x$ 为正整数的整数解中 $x$ 的最小值，$y$ 同理。
## 输入格式

第一行一个正整数 $T$，代表数据组数。

接下来 $T$ 行，每行三个由空格隔开的正整数 $a, b, c$。
## 输出格式

$T$ 行。

若该行对应的询问无整数解，一个数字 $-1$。  
若该行对应的询问有整数解但无正整数解，包含 $2$ 个由空格隔开的数字，依次代表整数解中，$x$ 的最小正整数值，$y$ 的最小正整数值。  
否则包含 $5$ 个由空格隔开的数字，依次代表正整数解的数量，正整数解中，$x$ 的最小值，$y$ 的最小值，$x$ 的最大值，$y$ 的最大值。

**读入输出量较大，注意使用较快的读入输出方式**
## 样例

### 样例输入 #1
```
7
2 11 100
3 18 6
192 608 17
19 2 60817
11 45 14
19 19 810
98 76 5432
```
### 样例输出 #1
```
4 6 2 39 8
2 1
-1
1600 1 18 3199 30399
34 3
-1
2 12 7 50 56
```
## 提示

**【数据范围】**

对于 $100\%$ 的数据，$1 \le T \le 2 \times {10}^5$，$1 \le a, b, c \le {10}^9$。


---

---
title: "简单数论题"
layout: "post"
diff: 提高+/省选-
pid: P6217
tag: ['数学', '最大公约数 gcd', '逆元']
---
# 简单数论题
## 题目描述

给出一个长度为 $n$ 的序列 $a$，$q$ 次询问 $\prod_{i=l}^r \operatorname{lcm}(a_i,x)$ 的值。

答案对 $10 ^ 9 + 7$ 取模。
## 输入格式

第一行两个整数 $n,q$。

第二行 $n$ 个整数 $a_i$。

接下来 $q$ 行，每行三个整数 $l,r,x$。
## 输出格式

$q$ 行，一行一个答案。
## 样例

### 样例输入 #1
```
5 5
12 8 9 14 21
1 5 2
1 3 3
3 5 7
1 5 6
2 3 7
```
### 样例输出 #1
```
1016064
2592
18522
9144576
3528

```
### 样例输入 #2
```
10 10
47 47 47 3 7 19 2 7 31 31 
1 3 53
4 4 61
2 8 73
6 7 53
1 5 47
2 5 73
5 6 71
7 7 67
4 7 83
1 9 59

```
### 样例输出 #2
```
456856666
183
802334105
106742
816245119
365992530
670453
134
871739899
194416112

```
### 样例输入 #3
```
10 10
2 13 13 2 3 17 11 19 19 7 
4 8 1
1 2 7
6 7 37
9 10 7
1 8 9
3 8 47
5 8 2
3 6 9
4 5 25
4 5 8

```
### 样例输出 #3
```
21318
1274
256003
931
819082258
40076077
170544
2899962
3750
192

```
### 样例输入 #4
```
10 10
14 39 31 30 3 21 19 17 35 2 
1 3 10
6 6 19
2 4 3
6 8 18
1 10 2
5 6 49
2 6 8
7 9 26
3 6 12
1 1 10

```
### 样例输出 #4
```
8463000
399
108810
13186152
23723126
21609
437603581
198696680
22498560
70

```
## 提示

**【样例解释】**

   对于样例一的第二个查询，答案是：

   $\quad \operatorname{lcm}(12,3) \times \operatorname{lcm}(8,3) \times \operatorname{lcm}(9,3)$

   $= 12 \times 24 \times 9$

   $= 2592$

------------------

**【数据范围】**

**本题采用捆绑测试。**


- 对于 $100 \%$ 的数据：$1 \le l \le r \le n$，$1 \le n,q,a_i,x \le 2 \times 10 ^ 5$。

- **详细的数据范围：**

  | Subtask 编号 | $n,q ,a_i,x\le $  |              特殊性质               | 分值 |
  | :---------: | :---------------: | :---------------------------------: | :--: |
  |     $1$     |       $100$       |                 无                  | $10$ |
  |     $2$     | $2 \times 10 ^ 5$ | $a_i,x$ 是质数，任意 $a_i \neq x$ | $10$ |
  |     $3$     | $5 \times 10 ^ 4$ |           $a_i$ 是质数            | $15$ |
  |     $4$     | $5 \times 10 ^ 4$ |           $μ(a_i) \neq 0$           | $15$ |
  |     $5$     | $5 \times 10 ^ 4$ |                 无                  | $25$ |
  |     $6$     | $2 \times 10 ^ 5$ |                 无                  | $25$ |

-------------------------

**【提示】**

- 样例二满足 Subtask2 的特殊性质，样例三满足 Subtask3 的特殊性质，样例四满足 Subtask4 的特殊性质。

- $μ(x)$ 是莫比乌斯函数，它的定义如下：

    设 $x = {p_1} ^ {q_1} \times {p_2} ^ {q_2} \times ... \times {p_k} ^ {q_k}$。

    $μ(x) =\begin{cases}1&x=1\\(-1) ^ k&q_1,q_2...q_k \le 1\\0&\text{otherwise}\end{cases}$ 

    注：$p_i$ 为质数，$q_i$ 为正整数。


---

---
title: "「MCOI-02」Convex Hull 凸包"
layout: "post"
diff: 提高+/省选-
pid: P6810
tag: ['2020', '数论', '洛谷原创', '最大公约数 gcd']
---
# 「MCOI-02」Convex Hull 凸包
## 题目背景

一场比赛需要一道签到题。
## 题目描述

Leasier 玩 MC 被逮到了，所以他只好算出下面这个式子的值。

$$\displaystyle\sum_{i = 1}^n \sum_{j = 1}^m \tau(i) \tau(j) \tau(\gcd(i, j))$$

由于结果可能很大，所以你只需要求出结果对 $p$ 取模的值。

如果您对本题的数学符号有疑问，请到「提示」区查看提示。
## 输入格式

一行，三个整数 $n, m, p$。
## 输出格式

一行，一个整数，表示所求的值。
## 样例

### 样例输入 #1
```
5 7 9
```
### 样例输出 #1
```
5
```
## 提示

#### 数据规模和约定
**本题开启捆绑测试。**

| Subtask | $n, m$ | 分值 |
| :------: | :------: | :------: |
| $1$ | $1 \leq n, m \leq 10^3$ | $15 \operatorname{pts}$ |
| $2$ | $1 \leq n, m \leq 10^5$ | $25 \operatorname{pts}$ |
| $3$ | $1 \leq n, m \leq 10^6$ | $30 \operatorname{pts}$ |
| $4$ | 无特殊限制 | $30 \operatorname{pts}$ |

对于 $100\%$ 的数据，$1 \leq n, m \leq 2 \times 10^6$，$1 \leq p \leq 10^9$。
#### 提示
作为对萌新友好的签到题，肯定是要给提示的。

- $\sum$ 为求和符号，比如 $\displaystyle\sum_{i = 1}^n i$ 代表 $1 + 2 + \cdots + n$。
- $\tau$ 表示约数个数，比如 $\tau(6) = 4$。
- $\gcd$ 是最大公约数，比如 $\gcd(12, 15) = 3$。
#### 说明
Minecraft OI Round 2 A

- Maker：Leasier
- Tester：happydef


---

---
title: "[NOI Online 2022 入门组] 数学游戏"
layout: "post"
diff: 提高+/省选-
pid: P8255
tag: ['2022', 'O2优化', '最大公约数 gcd', 'NOI Online']
---
# [NOI Online 2022 入门组] 数学游戏
## 题目背景

**经过管理员的考虑，我们打算将民间数据单独存放在最后一个 Subtask 中。这些测试点分数均为 0 分，但是没有通过其中的任何测试点将会视为此题不通过。**

民间数据提供者：@一扶苏一。本题不保证民间数据强度，详见[这个帖子](https://www.luogu.com.cn/discuss/422596)。
## 题目描述

Kri 喜欢玩数字游戏。

一天，他在草稿纸上写下了 $t$ 对正整数 $(x,y)$，并对于每一对正整数计算出了 $z=x\times y\times\gcd(x,y)$。

可是调皮的 Zay 找到了 Kri 的草稿纸，并把每一组的 $y$ 都擦除了，还可能改动了一些 $z$。

现在 Kri 想请你帮忙还原每一组的 $y$，具体地，对于每一组中的 $x$ 和 $z$，你需要输出最小的正整数 $y$，使得 $z=x\times y\times\gcd(x,y)$。如果这样的 $y$ 不存在，也就是 Zay 一定改动了 $z$，那么请输出 $-1$。

注：$\gcd(x,y)$ 表示 $x$ 和 $y$ 的最大公约数，也就是最大的正整数 $d$，满足 $d$ 既是 $x$ 的约数，又是 $y$ 的约数。
## 输入格式

第一行一个整数 ，表示有 $t$ 对正整数 $x$ 和 $z$。

接下来 $t$ 行，每行两个正整数 $x$ 和 $z$，含义见题目描述。
## 输出格式

对于每对数字输出一行，如果不存在满足条件的正整数 $y$，请输出 $-1$，否则输出满足条件的最小正整数 $y$。
## 样例

### 样例输入 #1
```
1
10 240
```
### 样例输出 #1
```
12
```
### 样例输入 #2
```
3
5 30
4 8
11 11
```
### 样例输出 #2
```
6
-1
1
```
### 样例输入 #3
```
见附件中的 math3.in
```
### 样例输出 #3
```
见附件中的 math3.out
```
### 样例输入 #4
```
见附件中的 math4.in
```
### 样例输出 #4
```
见附件中的 math4.out
```
## 提示

**【样例 1 解释】**

$x\times y\times \gcd(x,y)=10\times 12\times\gcd(10,12)=240$。

**【数据范围】**

对于 $20\%$ 的数据，$t, x, z \le {10}^3$。

对于 $40\%$ 的数据，$t \le {10}^3$，$x \le {10}^6$，$z \le {10}^9$。

对于另 $30\%$ 的数据，$t \le {10}^4$。

对于另 $20\%$ 的数据，$x \le {10}^6$。

对于 $100\%$ 的数据，$1 \le t \le 5 \times {10}^5$，$1 \le x \le {10}^9$，$1 \le z < 2^{63}$。


---

---
title: "[ICPC 2021 Nanjing R] Xingqiu's Joke"
layout: "post"
diff: 提高+/省选-
pid: P9849
tag: ['数学', '递推', '2021', 'Special Judge', 'O2优化', '最大公约数 gcd', 'ICPC', '南京']
---
# [ICPC 2021 Nanjing R] Xingqiu's Joke
## 题目描述

Once again, Xingqiu hides Chongyun's ice cream into a box with a strange lock. Liyue's summer has been always very hot and Chongyun suffers more because of his excessive yang (positive) energy, so he needs that ice cream desperately.

![](https://cdn.luogu.com.cn/upload/image_hosting/2dtcr426.png)

There are two integers $a$ and $b$ on the lock. Chongyun can perform the following three types of operations any number of times:
- Minus $1$ from both $a$ and $b$;
- Plus $1$ to both $a$ and $b$;
- Divide both $a$ and $b$ by one of their common $\textbf{prime}$ factor (that is to say, divide them by a $\textbf{prime}$ $g$ where $a$ and $b$ are both divisible by $g$).

The box will be unlocked if either $a$ or $b$ or both become $1$. To help Chongyun gets the ice cream back as quickly as possible, please tell him the minimum number of operations needed to unlock the box.
## 输入格式

There are multiple test cases. The first line of the input contains an integer $T$ ($1 \le T \le 300$) indicating the number of test cases. For each test case:

The first and only line contains two integers $a$ and $b$ ($1 \le a, b \le 10^9$, $a \ne b$).
## 输出格式

For each test case output one line containing one integer indicating the minimum number of operations to make $a$ or $b$ or both equal $1$.
## 样例

### 样例输入 #1
```
5
4 7
9 8
32 84
11 35
2 1

```
### 样例输出 #1
```
2
7
5
4
0

```
## 提示

For the first sample test case, the optimal way is $(4, 7) \rightarrow (3, 6) \rightarrow (1, 2)$.

For the second sample test case, the optimal way is to apply the first type of operation $7$ times.

For the third sample test case, the optimal way is $(32, 84) \rightarrow (16, 42) \rightarrow (15, 41) \rightarrow (14, 40) \rightarrow (13, 39) \rightarrow (1, 3)$.

For the fourth sample test case, the optimal way is $(11, 35) \rightarrow (12, 36) \rightarrow (6, 18) \rightarrow (2, 6) \rightarrow (1, 3)$.
## 题目翻译

## 题目描述
有 $T$ 个盒子，每盒子上有一个锁，锁上有两个整数 $a$ 和 $b$。你可以对这个锁做若干次以下 3 种操作：

- $a$ 和 $b$ 分别减去 $1$
- $a$ 和 $b$ 分别增加 $1$
- $a$ 和 $b$ 分别除以它们共同的素数因子

如果 $a$ 或 $b$ 或两者都变为 $1$，盒子就会解锁。请你编写一个程序，计算每个盒子的锁打开的最少步骤数量。

## 输入格式
第一行输入一个整数 $T(1≤T≤300)$。

接下来 $T$ 行，每行输入 $a$ 和 $b$，表示每个盒子的锁的信息。

## 输出格式  

共输出 $T$ 行，每行输出对应盒子解锁的最少步骤。


---


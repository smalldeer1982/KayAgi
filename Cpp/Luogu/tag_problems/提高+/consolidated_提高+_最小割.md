---
title: "[THUPC 2025 初赛] 检查站"
layout: "post"
diff: 提高+/省选-
pid: P11531
tag: ['2025', '网络流', '最小割', 'THUPC']
---
# [THUPC 2025 初赛] 检查站
## 题目描述

小 I 是一个巨大的铁路公司的主管，他管理着 $n$ 个火车站，用 $1$ 至 $n$ 的整数给它们编号。铁路公司有 $c$ 个分部，第 $i$ 个分部的办公室位于火车站 $p_i$。可能有火车站没有分部办公室，一个火车站也有可能有多个分部办公室。

$n$ 个火车站之间由 $m$ 条单向铁路连接，其中第 $i$ 条铁路由火车站 $u_i$ 连向 $v_i$，属于分部 $r_i$ 管辖。为了保证管理方便，分部 $r_i$ 的办公室要么在 $u_i$，要么在 $v_i$。

火车站 $1$（港口）和 $n$（首都）是公司管辖范围内最繁忙的车站。为了保障进口货物安全，根据交通运输部的要求，小 I 需要在一些铁路上设立检查站，使得从火车站 $1$ 到火车站 $n$ 的所有可能路线上都有一个有检查站的铁路。

小 I 可以通知一些分部（也可以不通知任何分部），要求这些分部在它们管理的所有铁路上设立检查站。小 I 想知道，最少需要通知多少个分部才可以达到要求。作为新上任的算法工程师，你准备给小 I 露一手。
## 输入格式

输入的第一行三个整数 $n,m,c (2 \le n, m, c \le 5\times 10^4)$，分别表示火车站数量、铁路数量和分部数量。

接下来一行 $c$ 个整数 $p_1, p_2, \cdots, p_c (1 \le p_i \le n)$，描述每个分部所在的火车站编号。

接下来 $m$ 行每行三个整数 $u_i, v_i, r_i (1 \le u_i, v_i \le n, 1 \le r_i \le c)$，描述一条铁路。保证 $p_{r_i} = u_i$ 或 $p_{r_i} = v_i$。
## 输出格式

输出一行一个整数表示最少需要通知的分部数量。
## 样例

### 样例输入 #1
```
5 10 3
3 1 4
1 3 1
4 3 1
3 2 1
3 5 1
1 2 2
2 1 2
1 4 2
5 1 2
1 4 3
4 5 3
```
### 样例输出 #1
```
2
```
## 提示

### 样例解释

该样例的铁路组织如下图所示，其中红色、绿色和黑色分别为 1、2、3 分部管辖的铁路。最优策略是通知分部 1 和 3。

![](https://cdn.luogu.com.cn/upload/image_hosting/yami1v28.png)

### 题目来源

题目来自 THUPC2025（2025年清华大学学生程序设计竞赛暨高校邀请赛）初赛，信息来源于 [THUSAAC 仓库](https://gitlink.org.cn/thusaa/thupc2025pre)。



---

---
title: "[USACO5.4] 奶牛的电信Telecowmunication"
layout: "post"
diff: 提高+/省选-
pid: P1345
tag: ['图论', 'USACO', '福建省历届夏令营', '网络流', '最小割']
---
# [USACO5.4] 奶牛的电信Telecowmunication
## 题目描述

农夫约翰的奶牛们喜欢通过电邮保持联系，于是她们建立了一个奶牛电脑网络，以便互相交流。这些机器用如下的方式发送电邮：如果存在一个由 $c$ 台电脑组成的序列$a_1,a_2,\cdots ,a_c$，且 $a_1$ 与 $a_2$ 相连，$a_2$ 与 $a_3$ 相连，等等。那么电脑 $a_1$ 和 $a_c$ 就可以互发电邮。

很不幸，有时候奶牛会不小心踩到电脑上，农夫约翰的车也可能碾过电脑，这台倒霉的电脑就会坏掉。这意味着这台电脑不能再发送电邮了，于是与这台电脑相关的连接也就不可用了。

有两头奶牛就想：如果我们两个不能互发电邮，至少需要坏掉多少台电脑呢？请注意，$c_1,c_2$ 不能被破坏。请编写一个程序为她们计算这个最小值。

以如下网络为例：

```plain
   1*
  /
 3 - 2*
```

这张图画的是有 $2$ 条连接的 $3$ 台电脑。我们想要在电脑 $1$ 和 $2$ 之间传送信息。电脑 $1$ 与 $3$，$2$ 与 $3$ 直接连通。如果电脑 $3$ 坏了，电脑 $1$ 与 $2$ 便不能互发信息了。
## 输入格式

第一行：四个由空格分隔的整数：$N,M,c_1,c_2$。$N$ 是电脑总数，电脑由 $1$ 到 $N$ 编号。$M$ 是电脑之间连接的总数。后面的两个整数 $c_1$ 和 $c_2$ 是上述两头奶牛使用的电脑编号。连接没有重复且均为双向的（即如果 $c_1$ 与 $c_2$ 相连，那么 $c_2$ 与 $c_1$ 也相连）。两台电脑之间至多有一条连接。电脑 $c_1$ 和 $c_2$ 不会直接相连。

第 $2$ 到 $M+1$ 行：接下来的 $M$ 行中，每行包含两台直接相连的电脑的编号。
## 输出格式

一行，一个整数，表示使电脑 $c_1$ 和 $c_2$ 不能互相通信需要坏掉的电脑数目的最小值。
## 样例

### 样例输入 #1
```
3 2 1 2
1 3
2 3
```
### 样例输出 #1
```
1

```
## 提示

对于 $100\%$ 的数据：$1\le N \le 100$，$1\le M \le 600$。


---

---
title: "[ZJOI2009] 狼和羊的故事"
layout: "post"
diff: 提高+/省选-
pid: P2598
tag: ['2009', '各省省选', '网络流', '浙江', '最小割']
---
# [ZJOI2009] 狼和羊的故事
## 题目描述

“狼爱上羊啊爱的疯狂，谁让他们真爱了一场；狼爱上羊啊并不荒唐，他们说有爱就有方向……”Orez 听到这首歌，心想：狼和羊如此和谐，为什么不尝试羊狼合养呢？说干就干！

Orez 的羊狼圈可以看作一个 $n\times m$ 的矩阵格子，这个矩阵的边缘已经装上了篱笆。可是 Drake 很快发现狼再怎么也是狼，它们总是对羊垂涎三尺，那首歌只不过是一个动人的传说而已。所以 Orez 决定在羊狼圈中再加入一些篱笆，还是要将羊狼分开来养。

通过仔细观察，Orez 发现狼和羊都有属于自己领地，若狼和羊们不能呆在自己的领地，那它们就会变得非常暴躁，不利于他们的成长。

Orez 想要添加篱笆的尽可能的短。当然这个篱笆首先得保证不能改变狼羊的所属领地，再就是篱笆必须修筑完整，也就是说必须修建在单位格子的边界上并且不能只修建一部分。
## 输入格式

文件的第一行包含两个整数 $n$ 和 $m$。接下来 $n$ 行每行 $m$ 个整数，$1$ 表示该格子属于狼的领地，$2$ 表示属于羊的领地，$0$ 表示该格子不是任何一只动物的领地。
## 输出格式

文件中仅包含一个整数 $\mathit{ans}$，代表篱笆的最短长度。
## 样例

### 样例输入 #1
```
2 2

2 2 

1 1 
```
### 样例输出 #1
```
2


```
## 提示

对于 $10\%$ 的数据，$n, m \le 3$。  
对于 $30\%$ 的数据，$n, m \le 20$。  
对于 $100\%$ 的数据，$1 \le n, m \le 100$。


---

---
title: "【模板】Stoer-Wagner"
layout: "post"
diff: 提高+/省选-
pid: P5632
tag: ['图论', '最小割']
---
# 【模板】Stoer-Wagner
## 题目描述

定义无向图 $G$ 的最小割为：一个去掉后可以使 $G$ 变成两个连通分量，且边权和最小的边集的边权和。

给出一张无向图 $G$，求其最小割。
## 输入格式

第一行，两个数 $n,m$，表示点数与边数。

接下来 $m$ 行，每行三个正整数 $a_i,b_i,w_i$，表示 $a_i$ 到 $b_i$ 有一条边权为 $w_i$ 的边。
## 输出格式

一行，一个整数表示 $G$ 的最小割，如果图不联通，请输出 `0` 。
## 样例

### 样例输入 #1
```
4 6
1 2 5
1 3 1
2 4 1
3 4 2
2 3 1
1 4 2

```
### 样例输出 #1
```
4
```
## 提示

对于前 $20\%$ 的数据， $n\leq 10$。  
对于前 $40\%$ 的数据， $n\leq 100$。  
对于另外 $10\%$ 的数据，保证输入为一棵树。  
对于另外 $10\%$ 的数据，保证输入为一条链。  
对于 $100\%$ 的数据， $n\leq 600,m\leq \frac{n\times (n-1)}{2}$ ，保证 $\sum_{i=1}^{m}w_i \leq10^9$ 。

#### PS：想交 最大流/最小割树 的就省省吧。


---


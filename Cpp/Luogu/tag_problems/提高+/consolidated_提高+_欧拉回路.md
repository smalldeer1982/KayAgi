---
title: "[IAMOI R1] 走亲访友"
layout: "post"
diff: 提高+/省选-
pid: P11762
tag: ['图论', 'Special Judge', '欧拉回路']
---
# [IAMOI R1] 走亲访友
## 题目背景

小 C 拉小 L 去走亲戚。
## 题目描述

小 C 共有 $n$ 个亲戚，某些亲戚家之间有 $m$ 条双向的道路，保证亲戚家之间两两可达。

小 C 要亲自去走亲戚。具体的，小 C 一开始在第 $s$ 个亲戚家。每次她可以前往一个与她现在的位置有道路相连的亲戚家。然而小 C 太有魅力了。每当她走过一条道路时，追求她的人便会从四面八方涌来，导致这条路堵车。当然，她也可以躲在车里面，收起她的迷人魅力，这样这条路就不会堵车了。

因为小 L 是路痴，所以小 C 希望最后剩下尽量少的 $n-1$ 条没有堵车的道路，并使得只保留着 $n-1$ 条道路后，亲戚家之间仍两两可达。

因为小 C 不想四处奔波这么久，所以最多只会走过 $k$ 条道路。

请你为她输出一种走亲戚的方案。

### 形式化题意

给定一个 $n$ 个点 $m$ 条边的简单无向连通图，你需要构造一组满足下面要求的路径：

+ 起点为 $s$，终点不限。

+ 对于走过的每一组边 $(u_i,v_i)$，你需要额外决定 $p_i\in\{0,1\}$，满足：

1. $p_i=0$ 表示删除这条边，**且不能再使用，即之后不能再次经过这条边**；$p_i=1$ 表示不删除这条边。

2. 如果 $i>1$，那么 $u_i=v_{i-1}$。**即使 $p_i=0$，也需要满足这条限制。**

+ 路径的长度不能超过 $k$。

+ 最后未删除的边组成一棵 $n$ 个节点的树。

特别的，一组边在被删除前可以经过多次。

若有多组满足条件的路径，可以输出任意一组。

可以证明在本题的限制条件下，一定存在合法的方案。
## 输入格式

第一行输入四个整数 $n,m,k$ 和 $s$。

接下来 $m$ 行每行输入整数 $u$ 和 $v$，表示第 $u$ 个亲戚家和第 $v$ 个亲戚家之间有一条双向道路。
## 输出格式

第一行输出一个整数，表示走过的道路的数量。

接下来若干行输出你的方案。具体的，每行输出两个整数。第一个整数表示道路的编号，第二个整数的值为 $0$ 或 $1$，若是 $0$ 表示让这条路堵车（删除这条边），若是 $1$ 表示让这条路保持畅通（保留这条边）。

如果有多种方案，任意输出一种也将被视为正确。
## 样例

### 样例输入 #1
```
5 5 10 4
1 3
2 5
2 3
4 5
1 5
```
### 样例输出 #1
```
2
4 1
2 0
```
## 提示

### 样例解释
![](https://cdn.luogu.com.cn/upload/image_hosting/qr0blgk5.png)

首先我们从第 $4$ 条道路后到达 $5$ 号亲戚家，再通过第 $2$ 条道路到达 $2$ 号亲戚，并让第 $2$ 条道路堵车。此时，只剩下 $n-1$ 条没有堵车的道路，并且亲戚家之间仍然两两可达。

对于以下输出：

```
2
4 1
5 0
```

或者以下输出：

```
3
4 1
2 1
3 0
```

也将视作正确。
### 数据范围

**本题采用捆绑测试**。

| Subtask | $n\le$ | $m$ | $k=$ | 分数 |
| :----------: | :----------: | :----------: | :----------: | :----------: |
| 1 | $10$ | $\le 10$ | $100$ | $20$ |
| 2 | $100$ | $\le \frac{n(n-1)}{2}$ | $10^6$ | $10$ |
| 3 | $10^3$ | $=n$ | $n+m$ | $10$ |
| 4 | $10^3$ | $\le \frac{n(n-1)}{2}$ | $n^2$ | $20$ |
| 5 | $10^3$ | $\le \frac{n(n-1)}{2}$ | $n+m$ | $40$ |


对于 $100\%$ 的数据，$n-1\le m\le\dfrac{n(n-1)}{2}$，$1\le u,v \le n$，且图中无自环、重边。

后话：这并非此题的原版，而是改版。然而[原版](https://www.luogu.com.cn/problem/T565042)我们目前并没有想到做法，有思路可以联系 [Down_syndrome](https://www.luogu.com.cn/user/984018)。


---

---
title: "[POI 2011] SMI-Garbage"
layout: "post"
diff: 提高+/省选-
pid: P3520
tag: ['图论', '2011', 'POI（波兰）', 'Special Judge', '欧拉回路']
---
# [POI 2011] SMI-Garbage
## 题目描述

有一个可以看成无向图的城市，上面有 $n$ 个点和 $m$ 条边。

每一天，有若干辆垃圾车按照**环形**来跑一圈。并且，**对于一辆垃圾车，** 除了起点以外不能跑两次。

一条路有 $2$ 种状态：清洁的（用 `0` 表示）或不清洁的（用 `1` 表示）。每次垃圾车经过，都会改变这条路的状态。

因为有些路上的人不交垃圾清理费，所以市长想要那些路变得不清洁；除此之外的路要清洁。那么，如何安排垃圾车，才能使得市长目的达到呢？

By @[dengziyue](/user/387840)

感谢 @cn：苏卿念 提供SPJ
## 输入格式

输入的第一行包含两个空格分隔的正整数 $n$ 和 $m$ $（ 1 \leqslant n \leqslant 100000，1 \leqslant m \leqslant 1000000）$，表示图的点数和边数。

接下来 $m$ 行，每行包含四个空格分隔的正整数 $a,b,s,t $（ $1 \leqslant a \leqslant b \leqslant n $ , $s，t \in \lbrace0,1\rbrace$  ） ，表示一条联结结点 $a$ 与 $b$ 的边，初始颜色和目标颜色分别为 $s$ 与 $t$ 。

你可以认为若存在合法方案，则存在一个卡车经过总边数不超过 $5m$ 的方案。

对于 $60\%$ 分数的数据，有 $ m \leqslant 10000$。
## 输出格式

如果不存在合法方案，输出一行 `NIE`（波兰语「否」）；

否则按下列格式输出任意一种方案：

- 第一行包含一个整数 $k$，表示卡车行驶环路的总数；
- 接下来 $k$ 行，每行描述一条环路：
   - 首先是一个正整数 $k_i$ 表示环路经过的边数，后接一个空格；
  - 接下来 $ k_i + 1 $ 个空格分隔的整数，依次表示环路上结点的编号。
## 样例

### 样例输入 #1
```
6 8
1 2 0 1
2 3 1 0
1 3 0 1
2 4 0 0
3 5 1 1
4 5 0 1
5 6 0 1
4 6 0 1
```
### 样例输出 #1
```
2
3 1 3 2 1
3 4 6 5 4
```


---

---
title: "[COCI 2014/2015 #7] POLICE"
layout: "post"
diff: 提高+/省选-
pid: P7796
tag: ['2014', '欧拉回路', 'COCI（克罗地亚）']
---
# [COCI 2014/2015 #7] POLICE
## 题目描述

在图书管理员 Jurica 的图书馆里有 $n$ 个书架，每个书架有 $m$ 个位置，从左往右编号为 $1$ 到 $m$，并且每个位置上都可以放一本书。Jurica 是一个好的图书管理员，所以他决定对图书馆进行清点，如果有必要，就把不在自己位置上的书放回原来的位置。具体来说，现在第 $i$ 个书架上的第 $j$ 个位置上面摆着编号为 $a_{i,j}$ 的书（如果 $a_{i,j}=0$ 说明这个位置上面现在没有书），而原来在这个位置上摆着编号为 $b_{i,j}$ 的书（如果 $b_{i,j}=0$ 说明这个位置上面原来没有书）。他以下列操作移动书籍：

- 操作 $1$：如果左边或右边有空位，可以在书架上向左或向右移动图书。
- 操作 $2$：从书架上取下一本书，放在该书架或其他书架的空位上。

细心的 Jurica 如果手中有书，就不能移动书。此外，他**不能同时拿多于一本书**。

自从他不得不把维基百科印刷版的所有书卷从一楼搬到二楼后，Jurica 就一直背痛。因为他的背很疼，所以现在他想把所有的书放好，尽量少搬。请告诉他需要的执行**操作 $2$ 的次数**最少是多少，或者告诉他根本不可能把这些书搬回原来的位置。
## 输入格式

输入共 $2n+1$ 行。

第一行输入两个整数 $n,m$，分别表示书架个数和每个书架上的位置个数。  
第 $2$ 到 $n+1$ 行，每行输入 $m$ 个整数 $a_{i,j}$，描述现在书架上摆书的情况。  
第 $n+2$ 到 $2n+1$ 行，每行输入 $m$ 个整数 $b_{i,j}$，描述原来书架上摆书的情况。

**输入保证原来和现在出现的书籍完全相同。**
## 输出格式

如果 Jurica 根本不可能把这些书搬回原来的位置，则仅输出一个整数 $-1$。

否则，输出一行一个整数，表示执行**操作 $2$ 的最少次数**。
## 样例

### 样例输入 #1
```
2 4
1 0 2 0
3 5 4 0
2 1 0 0
3 0 4 5
```
### 样例输出 #1
```
2
```
### 样例输入 #2
```
3 3
1 2 3
4 5 6
7 8 0
4 2 3
6 5 1
0 7 8
```
### 样例输出 #2
```
4
```
### 样例输入 #3
```
2 2
1 2
3 4
2 3
4 1
```
### 样例输出 #3
```
-1
```
## 提示

**【样例 1 解释】**

以下是 Jurica 的操作序列：

1. 操作 $1$：把 $1$ 号书籍移动到它右边的位置，也就是它所在书架上的第二个位置。
2. 操作 $2$：把 $2$ 号书籍搬到它所在书架上的第一个位置。
3. 操作 $2$：把 $5$ 号书籍搬到它所在书架上的第二个位置。

可以证明没有更少执行操作 $2$ 的方案。

**【数据范围】**

对于 $50\%$ 的数据，保证每本书在初始和最终状态下都会在同一个书架上。  
对于所有数据，$1\leqslant n,m\leqslant 1000$。

**【题目来源】**

本题来源自 **_[COCI 2014-2015](https://hsin.hr/coci/archive/2014_2015/) [CONTEST 7](https://hsin.hr/coci/archive/2014_2015/contest7_tasks.pdf) T6 POLICE_**，按照原题数据配置，满分 $160$ 分。

由 [Eason_AC](https://www.luogu.com.cn/user/112917) 翻译整理提供。


---

---
title: "「SvR-2」1+2=3"
layout: "post"
diff: 提高+/省选-
pid: P9088
tag: ['贪心', '2023', '网络流', '洛谷原创', 'O2优化', '图论建模', '欧拉回路', '费用流', '洛谷月赛', 'Ad-hoc']
---
# 「SvR-2」1+2=3
## 题目描述

你有一些木棒，每个木棒左边有一个数，右边有一个数，数只有 $0,1,2$，你要将所有木棒拼起来，使相邻的数和为 $3$ 的对数最大。

例如，$1\text{ - }2$ 和 $1\text{ - }0$ 两个木棒，如果按 $1\text{ - }0,1\text{ - }2$ 这样拼，相邻的数和为 $3$ 的对数是 $0$；而按 $1\text{ - }{\underline\color{red}\textbf2},{\underline\color{red}\textbf1}\text{ - }0$ 这样拼相邻的数和为 $3$ 的对数是 $1$，因为 $2+1=3$。
## 输入格式

**本题有多组数据。**

输入的第一行一个正整数表示数据组数 $T$。

对于每组数据，一行 $9$ 个非负整数，分别表示 $0\text{ - }0,0\text{ - }1,0\text{ - }2,1\text{ - }0,1\text{ - }1,1\text{ - }2,2\text{ - }0,2\text{ - }1,2\text{ - }2$ 型木棒的个数。
## 输出格式

$T$ 行，每行一个整数表示答案。
## 样例

### 样例输入 #1
```
3
4 1 3 4 7 7 9 10 3
6 3 6 4 3 4 5 6 6
6 10 7 1 4 2 6 4 2

```
### 样例输出 #1
```
31
23
19

```
## 提示

#### 数据规模与约定

对于全部数据，保证 $1\le T\le 10^5$，记 $a_{i,j}$ 表示 $i\text-j$ 木棒的个数，保证 $0\le a_{i,j}\le 10^9$。

**本题自动开启捆绑测试和 O2 优化。**

记 $sum$ 表示一个测试点中所有数据的所有 $a_{i,j}$ 之和。

| Subtask | $T$ | $sum$ | 特殊性质 |分值 |
| :------: | :------: | :------: | :------: | :------: |
| $1$ | $1 \leq T \leq 10$ | $1\le sum\le 10$ |无| $10 \operatorname{pts}$ |
| $2$ | $1 \leq T \leq 50$ | $1\le sum\le 80$ | 无|$20 \operatorname{pts}$ |
| $3$ | 无特殊限制 | 无特殊限制 |A| $15\operatorname{pts}$ |
| $4$ | 无特殊限制 | 无特殊限制 |B| $20 \operatorname{pts}$ |
| $5$ | $1\le T\le 1000$ | 无特殊限制 |C| $20 \operatorname{pts}$ |
| $6$ | 无特殊限制 | 无特殊限制 |无| $15 \operatorname{pts}$ |

特殊性质 A：$a_{i,j}$ 在 $[0,10^9]$ 中均匀随机生成。

特殊性质 B：所有 $a_{i,j}>0$。

特殊性质 C：所有 $a_{i,j}\le 100$。


---


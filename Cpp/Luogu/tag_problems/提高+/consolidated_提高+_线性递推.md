---
title: "[NOI2013] 矩阵游戏"
layout: "post"
diff: 提高+/省选-
pid: P1397
tag: ['递推', '2013', 'NOI', '矩阵乘法', '线性递推']
---
# [NOI2013] 矩阵游戏
## 题目描述

婷婷是个喜欢矩阵的小朋友，有一天她想用电脑生成一个巨大的 $n$ 行 $m$ 列的矩阵（你不用担心她如何存储）。她生成的这个矩阵满足一个神奇的性质：若用 $F[i,j]$ 来表示矩阵中第 $i$ 行第 $j$ 列的元素，则 $F[i,j]$ 满足下面的递推式:

$$\begin{aligned}
F[1, 1] &= 1 \\
F[i, j] &=a\times F[i, j-1]+b, &j\neq 1 \\
F[i, 1] &=c\times F[i-1, m]+d, &i\neq 1 \\
\end{aligned}$$

递推式中 $a,b,c,d$ 都是给定的常数。

现在婷婷想知道 $F[n,m]$ 的值是多少，请你帮助她。由于最终结果可能很大，你只需要输出 $F[n,m]$ 除以 $10^9+7$ 的余数。

## 输入格式

包含一行有六个整数 $n,m,a,b,c,d$。意义如题所述。

## 输出格式

包含一个整数，表示 $F[n,m]$ 除以 $10^9+7$ 的余数。

## 样例

### 样例输入 #1
```
3 4 1 3 2 6

```
### 样例输出 #1
```
85

```
## 提示

【样例1说明】

样例中的矩阵为：

$$\begin{pmatrix}
 1 &  4 &  7 & 10 \\
26 & 29 & 32 & 35 \\
76 & 79 & 82 & 85 \\
\end{pmatrix}$$

### 数据范围

| 测试点编号 | 数据范围 |
| :-: | :-: |
| 1 | $1 \le n,m \le 10$；$1 \le a,b,c,d \le 1000$ |
| 2 | $1 \le n,m \le 100$；$1 \le a,b,c,d \le 1000$ |
| 3 | $1 \le n,m \le 10^3$；$1 \le a,b,c,d \le 10^9$ |
| 4 | $1 \le n,m \le 10^3$；$1 \le a,b,c,d \le 10^9$ |
| 5 | $1 \le n,m \le 10^9$；$1 \le a = c \le 10^9$；$1 \le b = d \le 10^9$ |
| 6 | $1 \le n,m \le 10^9$；$a = c = 1$；$1 \le b,d \le 10^9$ |
| 7 | $1 \le n,m,a,b,c,d \le 10^9$ |
| 8 | $1 \le n,m,a,b,c,d \le 10^9$ |
| 9 | $1 \le n,m,a,b,c,d \le 10^9$ |
| 10 | $1 \le n,m,a,b,c,d \le 10^9$ |
| 11 | $1 \le n,m \le 10^{1\,000}$；$a = c = 1$；$1 \le b,d \le 10^9$ |
| 12 | $1 \le n,m \le 10^{1\,000}$；$1 \le a = c \le 10^9$；$1 \le b = d \le 10^9$ |
| 13 | $1 \le n,m \le 10^{1\,000}$；$1 \le a,b,c,d \le 10^9$ |
| 14 | $1 \le n,m \le 10^{1\,000}$；$1 \le a,b,c,d \le 10^9$ |
| 15 | $1 \le n,m \le 10^{20\,000}$；$1 \le a,b,c,d \le 10^9$ |
| 16 | $1 \le n,m \le 10^{20\,000}$；$1 \le a,b,c,d \le 10^9$ |
| 17 | $1 \le n,m \le 10^{1\,000\,000}$；$a = c = 1$；$1 \le b,d \le 10^9$ |
| 18 | $1 \le n,m \le 10^{1\,000\,000}$；$1 \le a = c \le 10^9$；$1 \le b = d \le 10^9$ |
| 19 | $1 \le n,m \le 10^{1\,000\,000}$；$1 \le a,b,c,d \le 10^9$ |
| 20 | $1 \le n,m \le 10^{1\,000\,000}$；$1 \le a,b,c,d \le 10^9$ |


---

---
title: "刷题比赛"
layout: "post"
diff: 提高+/省选-
pid: P1707
tag: ['递推', '倍增', '矩阵运算', '洛谷原创', '矩阵乘法', '线性递推']
---
# 刷题比赛
## 题目背景

nodgd 是一个喜欢写程序的同学，前不久洛谷 OJ 横空出世，nodgd 同学当然第一时间来到洛谷 OJ 刷题。   
于是发生了一系列有趣的事情，他就打算用这些事情来出题恶心大家……

## 题目描述

洛谷OJ当然算是好地方，nodgd 同学打算和朋友分享一下。于是他就拉上了他的朋友 Ciocio 和 Nicole 两位同学一起刷题。喜欢比赛的他们当然不放过这样一次刷题比赛的机会！

在第 $1$ 天 nodgd,Coicoi,Nicole 都只做了 $1$ 道题。

在第 $2$ 天 nodgd,Coicoi,Nicole 都只做了 $3$ 道题。

他们都有着严格的刷题规则，并且会在每一天都很遵守规则的刷一定量的题。

1、nodgd 同学第 $k+2$ 天刷题数量    
$$a_{k+2}=pa_{k+1}+qa_k+b_{k+1}+c_{k+1}+rk^2+tk+1$$

2、Ciocio 同学第 $k+2$ 天刷题数量      
$$b_{k+2}=ub_{k+1}+vb_k+a_{k+1}+c_{k+1}+w^k$$

3、Nicole 同学第 $k+2$ 天刷题数量    
$$c_{k+2} = xc_{k+1}+yc_k + a_{k+1} + b_{k+1} + z^k+k+2$$

（以上的字母 $p,q,r,t,u,v,w,x,y,z$ 都是给定的常数，并保证是正整数）

于是他们开始了长时间的刷题比赛！一共进行了 $n$ 天

但是时间是可贵的，nodgd 想快速知道第 $n$ 天每个人的刷题数量。  
不过 nodgd 同学还有大量的数学竞赛题、物理竞赛题、英语竞赛题、美术竞赛题、体育竞赛题…… 要做，就拜托你来帮他算算了。

由于结果很大，输出结果 $\bmod \space m$ 的值即可。

## 输入格式

第一行两个正整数 $n,m$。

第二行四个正整数 $p,q,r,t$。

第三行三个正整数 $u,v,w$。

第四行三个正整数 $x,y,z$。

## 输出格式

共三行，每行一个名字 + 一个空格 + 一个整数。  
依次是 nodgd,Ciocio,Nicole 和他们在第 $n$ 天刷题数量 $\bmod \space m$ 的值。

## 样例

### 样例输入 #1
```
4 10007
2 1 1 1
2 2 3
1 1 2
```
### 样例输出 #1
```
nodgd 74
Ciocio 80
Nicole 59
```
## 提示

对于 $100\%$ 的数据，$4\le n \le 10^{16}$，$2\le m \le 10^{16}$，$1\le p,q,r,t,u,v,w,x,y,z \le 100$。


---

---
title: "关灯"
layout: "post"
diff: 提高+/省选-
pid: P1805
tag: ['高精度', '递推', 'NOI 导刊', '线性递推']
---
# 关灯
## 题目描述

在某条道路上，有 $n$ 盏灯排成一排，它们有的是开着的，有的是关着的。

由于天马上就要亮了，上级给了你一个任务：把所有的灯都关掉。

只不过，这些灯都比较智能，不会被轻易关掉。它们的开或关遵循如下规则：

- 每一步只能开或关一盏灯。
- 编号为 $1$ 的灯可以随意开或关。
- 如果编号为 $1, 2, \cdots,k-1$ 的灯都关上了了，并且编号为 $k$ 的灯在开着，我们可以随意开或关第 $k+1$ 盏灯。

在关灯之前，请你计算：至少要多少步才能关上所有灯？
## 输入格式

第 $1$ 行一个整数 $n$，表示灯的个数。

第 $2$ 行有 $n$ 个整数，如果第 $i$ 个整数 $O_i=0$，表示第 $i$ 个盏灯初始的时候是关着的；如果 $O_i=1$，表示第 $i$ 盏灯初始的时候是开着的。
## 输出格式

共一行一个整数，表示最少需要多少步才能关上所有灯。

## 样例

### 样例输入 #1
```
4

1 0 1 0
```
### 样例输出 #1
```
6
```
## 提示

【输出解释】

- 初始状态 $1010$；
- 第 $1$ 步 $1110$；
- 第 $2$ 步 $0110$；
- 第 $3$ 步 $0100$；
- 第 $4$ 步 $1100$；
- 第 $5$ 步 $1000$；
- 第 $6$ 步 $0000$。

### 数据范围及约定

- 对于 $40\%$ 的数据，$n \le 30$；
- 对于 $70\%$ 的数据，$n \le 300$；
- 对于 $100\%$ 的数据，$n \le 1000$。


---

---
title: "[TJOI2010] 天气预报"
layout: "post"
diff: 提高+/省选-
pid: P3873
tag: ['递推', '2010', '各省省选', '线性递推', '构造', '天津']
---
# [TJOI2010] 天气预报
## 题目描述

A 公司的天气预报系统的原理如下：用一个大于等于 $0$，小于等于 $4146$ 的整数来表示这一天的天气情况，在预测未来某一天的天气情况时，要根据此前 $n$ 天的天气情况来预测，如果用 $w_i$ 表示第 $i$ 天的天气情况（$i>n$），那么 $w_i=(a_1\times w_{i-1}+a_2\times w_{i-2}+\cdots+a_{n}\times w_{i-n})\mod4147$，其中 $a_1,a_2,\cdots ,a_n$ 是已知常数。现给出前 $n$ 天的天气情况，问第 $m$ 天的天气预测结果是什么。
## 输入格式

输入数据的第一行是两个正整数 $n$ 和 $m$，第二行有 $n$ 个非负整数，分别为 $w_n,w_{n-1},\cdots,w_1$。第三行又有 $n$ 个非负整数，分别表示 $a_1,a_2,\ldots,a_n$。
## 输出格式

输出一个整数，表示对第 $m$ 天的天气预测结果。
## 样例

### 样例输入 #1
```
2 3
4 5
6 7

```
### 样例输出 #1
```
59
```
## 提示

$1\le n\le 100$，$n<m\le10^7$，$0\le a_i,w_i\le 4146$。

每个测试点时限 1.5 秒


---

---
title: "猜数"
layout: "post"
diff: 提高+/省选-
pid: P4862
tag: ['递推', '斐波那契数列', '线性递推']
---
# 猜数
## 题目背景

Iris 和 Beryl 两人在玩一个猜数的游戏。
## 题目描述

游戏是这样进行的：给定一个正整数 $n$，Iris 在 $S=\{1,2,...,n\}$ 中选择一个数 $m$。  

然后，Iris 要如实回答 Beryl 的若干个问题，这些问题的形式是：“$m$ 是集合 $A$ 中的元素吗？”其中 $A\subseteq S$。   
如果Iris回答“是”，则 Beryl 要给 Iris $a$ 元钱；否则，Beryl 要给 Iris $b$ 元钱。（数据保证 $a>b$）

那么，Beryl 至少准备多少钱，就一定能确定 Iris 心中的数字呢？
## 输入格式

第一行：两个正整数 $a$ 和 $b$ 以及数据组数 $t$。   
接下来 $t$ 行，每行一个给定的正整数 $n$，意义如上所述。
## 输出格式

$t$ 行，表示对于每一组数据，Beryl 需要准备的最小钱数。
## 样例

### 样例输入 #1
```
2 1 2
3
6
```
### 样例输出 #1
```
3
5
```
### 样例输入 #2
```
5 3 1
3
```
### 样例输出 #2
```
8
```
## 提示

【样例1的第1组数据解释】 

Beryl先对集合 $\{1\}$ 进行询问，若得到的答案是“是”，则已经确定 Iris 选的数为 $1$，需要 $2$ 元。若得到的答案是“否”，则再对集合 $\{2\}$ 进行询问，显然运气最差要再花 $2$ 元，共 $3$ 元，故答案为 $3$ 元。   

----   

【数据范围】  

| 测试点编号 | $n$ |$t$| $a$,$b$ |
| :----------- | :----------- | :----------- | :----------- |
| 1 | $\leq 20$ | $\leq 10$ | $\leq 20$ |
| 2 | $\leq 20$ | $\leq 10$ | $\leq 20$ |
| 3 | $\leq 2000$ | $\leq 100$ | $\leq 500$ |
| 4 | $\leq 2000$ | $\leq 100$ | $\leq 500$ |
| 5 | $\leq 2000$ | $\leq 100$ | $\leq 500$ |
| 6 | $\leq 2000$ | $\leq 100$ | $\leq 500$ |
|7  | $\leq 2000$ | $\leq 100$ | $\leq 500$ |
| 8 | $\leq 10^{18}$ | $\leq 200$ | $a=2$,$b=1$ |
| 9 | $\leq 10^{18}$ | $\leq 200$ | $a=2$,$b=1$ |
| 10 | $\leq 10^{18}$ | $\leq 200$ | $a=2$,$b=1$ |




---

---
title: "hby与tkw的基情"
layout: "post"
diff: 提高+/省选-
pid: P4881
tag: ['数学', '线性递推', '逆元']
---
# hby与tkw的基情
## 题目背景

> 基情恒久远，一对永流传。

hby 和 tkw 是一对好基友，他们经常在一起做♂游♂戏 (/滑稽)。

## 题目描述

他们喜欢玩字符串游戏，尤其喜欢玩回文串。每次 hby 会给出一个数 $n$，那么 tkw 就需要给出 $Ans=\sum\limits_{i=1}^ni\times s[i]\times[i\bmod 2]$。其中 $s[i]$ 代表长度为 $i$ 的回文串的个数（只考虑小写字母），最后面是 bool 表达式

不过由于 tkw 最近学 ycz 找妹纸去了，于是他就将这个问题交给了你，如果你不能在 $1\rm s$ 内答出来，那么 hby 和 tkw 的基情将会破裂！~~（不过那样 tkw 就可以安心地找妹纸了）~~

由于答案会非常大，所以你只需要输出答案 $\bmod 10^9+7$ 的值即可
## 输入格式

第一行一个整数 $T$。

接下来 $T$ 行，每行一个数 $n$。
## 输出格式

共 $T$ 行，每行代表一个答案。
## 样例

### 样例输入 #1
```
2
1
3
```
### 样例输出 #1
```
26
2054
```
## 提示

对于 $10\%$的数据，$n\le 5$。

对于另外 $20\%$ 的数据，$\sum n\le 10^7$。

对于另外 $20\%$ 的数据，$T=1$。

对于 $100\%$ 的数据，$1\le T\le 5\times 10^5$，$1\le n\le 10^9$。


---


---
title: "[蓝桥杯 2023 国 A] 树上的路径"
layout: "post"
diff: 提高+/省选-
pid: P10421
tag: ['点分治', '2023', '蓝桥杯国赛']
---
# [蓝桥杯 2023 国 A] 树上的路径
## 题目描述

给定一棵包含 $n$ 个结点的树，树的每条边的长度均为 $1$。求这棵树的所有长度在 $L\sim R$ 之间的路径的长度之和。两条路径经过的边集完全相同时视作同一条路径。

也就是求 $\sum\limits_{i=1}^n{\sum\limits_{j=i+1}^{n}{dis(i,j)\cdot[L \le dis(i,j) \le R]}}$，其中 $dis(i,j)$ 表示结点 $i$ 和结点 $j$ 之间的距离，$[C]$ 表示条件 $C$ 满足时取 $1$，不满足时取 $0$。
## 输入格式

输入的第一行包含三个整数 $n, L, R$，相邻两个整数之间使用一个空格分隔。

接下来 $n−1$ 行，每行包含一个整数，其中第 $i$ 行的整数 $F_i$ 表示第 $i+1$ 个结点在树上的父亲结点。结点 $1$ 是根结点，没有父亲结点。
## 输出格式

输出一行包含一个整数表示答案。
## 样例

### 样例输入 #1
```
4 2 3
1
1
3

```
### 样例输出 #1
```
7
```
## 提示

**【评测用例规模与约定】**

对于 $40\%$ 的评测用例，$n\le 2000$；  
对于所有评测用例，$1\le L\le R\le n\le 10^6$，$1\le F_i\le i$。


---

---
title: "[蓝桥杯 2023 国 A] 迷宫探险"
layout: "post"
diff: 提高+/省选-
pid: P10422
tag: ['2023', '最短路', '蓝桥杯国赛', '状压 DP']
---
# [蓝桥杯 2023 国 A] 迷宫探险
## 题目描述

勇士小蓝准备去遥远的 LQ 迷宫探险，拿到迷宫中的宝藏。迷宫可以看做是一个具有 $N$ 个顶点(顶点编号为 $0\sim N-1$) 和 $M$ 条边的无向图，其中每个顶点上都有一只怪物，每只怪物都具有一定的攻击力，每条边都具有一个权重 $w$ 表示小蓝经过边时消耗的时间。

想要拿到迷宫宝藏，小蓝需要从 $0$ 号顶点出发对地图进行探险，在经过顶点时可以对怪物进行击杀，小蓝具有必杀技，能保证一招就击败怪物，但在小蓝对某个怪物进行击杀时，与这个怪物所在结点相邻接的结点上仍存活着的怪物会对小蓝发起一次攻击(注意，不包括小蓝正在击杀的怪物)，小蓝会减少对应攻击力大小的血量。当小蓝击杀完所有怪物并且到达顶点 $N-1$，并且此时小蓝的血量大于 $0$，那么小蓝才可以获得迷宫宝藏。

注意，小蓝的必杀技很快，因此在击杀怪物时可以视为不消耗时间；一个怪物只需要被击杀一次就会消失，只有在小蓝击杀怪物时，与其相邻接的结点上的怪物才会对小蓝发起一次攻击。

如果小蓝可以获得迷宫宝藏，请你输出所需要的最小时间。否则输出 $-1$ 即可。
## 输入格式

输入的第一行包含三个整数 $N, M, HP$，相邻的整数之间使用一个空格分隔，分别表示顶点数、无向边数以及小蓝初始时侯的血量。

第二行包含 $N$ 个整数，相邻的整数之间使用一个空格分隔，其中第 $i(0\le i\le N-1)$ 个整数表示编号为 $i$ 的顶点上的怪物的攻击力大小;

接下来 $M$ 行，每行包含三个整数 $u, v, w$ 表示在顶点 $u$ 和 $v$ 之间存在一条权重为 $w$ 的无向边。
## 输出格式

输出一行包含一个整数表示答案，若小蓝无论如何也无法获得迷宫宝藏，则输出 $-1$。
## 样例

### 样例输入 #1
```
3 2 10
2 10 5
0 1 1
1 2 2

```
### 样例输出 #1
```
5

```
## 提示

**【样例解释 1】**

小蓝初始在 $0$ 号点，下一步移动到 $1$ 号点，耗费时间 $10$。

击杀 $1$ 号点的怪物，将会受到 $0$、$2$ 号怪物的攻击，血量减少 $7$，剩余血量为 $3$。

移动到 $0$ 号点，耗费时间 $10$，接着击杀 $0$ 号怪物，不会受到攻击。

移动到 $1$ 号点，再继续移动到 $2$ 号点，耗费时间 $30$，此时击杀 $2$ 号怪物，不会受到攻击，击杀完毕后小蓝剩余 $3$ 血量，满足题目要求，总计耗费时间为 $50$。

**【评测用例规模与约定】**

对于 $40\%$ 的评测用例，$1\le N\le 10$；  
对于所有评测用例，$1\le N\le 15$，$1\le M\le N^2$，$1\le HP\le 100$，$1\le \text{怪物攻击力} \le 10$，$1\le w\le 10$。


---

---
title: "[蓝桥杯 2024 国 A] 重复的串"
layout: "post"
diff: 提高+/省选-
pid: P10581
tag: ['2024', '矩阵加速', 'KMP 算法', '蓝桥杯国赛']
---
# [蓝桥杯 2024 国 A] 重复的串
## 题目描述

给定一个仅含小写字母的字符串 $S$，问有多少个长度为 $n$ 的仅含小写字母的字符串中恰好出现了两次 $S$。答案对 $998\ 244\ 353$ 取模。
## 输入格式

输入一行包含一个字符串 $S$ 和一个整数 $n$，用一个空格分隔。
## 输出格式

输出一行包含一个整数表示答案。
## 样例

### 样例输入 #1
```
aba 6
```
### 样例输出 #1
```
53
```
### 样例输入 #2
```
aba 10
```
### 样例输出 #2
```
77907666
```
## 提示

对于 $40\%$ 的评测用例，$n \le 20$，$|S| \le 6$；  
另有 $10\%$ 的评测用例，$n\le 500$，$|S| \le 2$；  
对于 $70\%$ 的评测用例，$n\le 10^5$；  
对于所有评测用例，$1\le n\le 10^9$，$1 \le |S| \le 30$。


---

---
title: "[蓝桥杯 2023 国 Python A] 彩色二叉树"
layout: "post"
diff: 提高+/省选-
pid: P10990
tag: ['2023', '枚举', '蓝桥杯国赛']
---
# [蓝桥杯 2023 国 Python A] 彩色二叉树
## 题目背景

建议使用 PyPy3 提交本题。
## 题目描述

给定包含 n 个结点的完全二叉树，如下图是一棵包含 n = 6 个结点的完全
二叉树。

![](https://cdn.luogu.com.cn/upload/image_hosting/7zry2bbp.png)

给定 $q$ 次操作，操作可以是：
1. $x_i\ y_i\ z_i$，表示将与结点 $x_i$ 距离小于等于 $y_i$ 的结点的颜色全部染成 $z_i$；
1. $x_i$，表示查询结点 $x_i$ 的颜色。
## 输入格式

输入的第一行包含两个整数 $n, q$，用一个空格分隔。

接下来 $q$ 行，每行包含 $1$ 个操作，相邻的整数之间使用一个空格分隔。保证每个操作都是合法的。
## 输出格式

对于每个查询操作，输出一行包含一个整数表示对应的答案。

## 样例

### 样例输入 #1
```
6 6
1 1 1 1
2 3
1 5 2 2
2 4
2 1
2 3


```
### 样例输出 #1
```
1
2
2
1

```
## 提示

对于 $40\%$ 的评测用例，$n, q \le 5000$；

对于所有评测用例，$1 \le n \le 10^6,1\le q \le 2 \times 10^5,1 \le x_i \le n,1 \le y_i \le 10^6,1 \le z_i\le 10^6$。


---

---
title: "[蓝桥杯 2023 国 Python A] 最长同类子串"
layout: "post"
diff: 提高+/省选-
pid: P10992
tag: ['二分', '2023', '哈希 hashing', '蓝桥杯国赛']
---
# [蓝桥杯 2023 国 Python A] 最长同类子串
## 题目描述

对于两个等长的字符串 $A, B$，如果对于任意 $i, j$，都有 $A_i = A_j$ 和 $B_i = B_j$
同时满足或同时不满足，那么我们称 $A, B$ 是一对同类串。例如，`aabab` 和 `xxkxk` 是一对同类串，而 `abcde` 和  `abcdd` 则不是。

给定 $S, T$，找出一个尽可能大的 $k$ 使得 $S, T$ 分别含有一个长度为 $k$ 的子
串 $S', T'$，且 $S',T'$ 是同类串。

## 输入格式

输入两行，每行包含一个字符串，分别表示 $S, T$。

## 输出格式

输出一行包含一个整数 $k$ 表示答案。

## 样例

### 样例输入 #1
```
aaaba
yxyy

```
### 样例输出 #1
```
3

```
## 提示

对于 $40\%$ 的评测用例，$|S |, |T| \le 500$；

对于 $50\%$ 的评测用例，$|S |, |T| \le 2000$；

对于所有评测用例，$1 \le |S |, |T| \le 10^5$，$S, T$ 中仅包含小写英文字母。



---

---
title: "[蓝桥杯 2023 国 Python B] 最长回文前后缀"
layout: "post"
diff: 提高+/省选-
pid: P12213
tag: ['2023', '哈希 hashing', 'Manacher 算法', '蓝桥杯国赛']
---
# [蓝桥杯 2023 国 Python B] 最长回文前后缀
## 题目描述

给定一个字符串 $S$，请找出 $S$ 的一个前缀和后缀，使得它们拼接后是一个回文串。请输出这个串的最长长度。
## 输入格式

输入一行包含一个字符串 $S$，由小写英文字母组成。
## 输出格式

输出一行包含一个整数表示答案。
## 样例

### 样例输入 #1
```
aababa
```
### 样例输出 #1
```
7
```
## 提示

### 样例说明

选择前缀 $\tt{aababa}$ 和后缀 $\tt{a}$ 可以得到 $\tt{aababaa}$。

### 评测用例规模与约定

- 对于 $30\%$ 的评测用例， $|S| \leq 300$；
- 对于 $60\%$ 的评测用例， $|S| \leq 3000$；
- 对于所有评测用例， $1 \leq |S| \leq 10^5$。


---

---
title: "[蓝桥杯 2023 国 Java B] 数和游戏"
layout: "post"
diff: 提高+/省选-
pid: P12224
tag: ['搜索', '2023', '剪枝', '蓝桥杯国赛']
---
# [蓝桥杯 2023 国 Java B] 数和游戏
## 题目描述

数和游戏是一种棋盘填数游戏。棋盘上分为白色和灰色两种类型的格子。游戏目标是通过在白色的格子里填入数字 $1 \dots 9$ 来满足游戏要求。

游戏当中有一个称作“条目”的概念，条目指的就是在水平方向或者垂直方向上所有连续出现的白色格子的集合。具体来说从灰色格子右方（下方）相邻的白色格子出发，一直向右方（下方）行走直到走出棋盘边界或遇到灰色格子才停止，途中经过的所有的白色格子组成的集合就称为条目。例如上图中，我们用 $(x, y)$ 表示格子坐标，坐标 $(1, 4)$ 下方的条目就是由坐标 $(2, 4)$ 和 $(3, 4)$ 的白色格子构成的；坐标 $(5, 1)$ 右方的条目是由坐标 $(5, 2)$、$(5, 3)$ 的白色格子构成的。但注意坐标 $(7, 2)$、$(7, 3)$、$(7, 4)$ 处的格子的集合并不是一个条目，在加入坐标 $(7, 5)$ 的格子后才是一个条目。

游戏具体要求如下：游戏在一个 $M \times N$ 大小的格子棋盘上进行，其中格子分为白色和灰色两种类型：
1) 白色格子，此种类型的格子应当填入一个 $1 \dots 9$ 范围内的整数并满足所有灰色格子的要求；
2) 灰色格子，此种类型的格子用一条对角线将格子分为了左下（用 $A$ 表示）和右上（用 $B$ 表示）两部分，若 $A$ 中有数字，则表示 $A$ 所在的格子下方条目中的数字之和应该等于 $A$ 中的数字；若 $B$ 中有数字，则表示 $B$ 所在的格子右方条目中的数字之和应该等于 $B$ 中的数字。除此之外还有一个重要的约束条件：每一个条目中不能出现重复的数字，即在每一个条目之中，$1 \dots 9$ 中的每个数字最多只能出现一次。我们保证游戏一定有一个唯一解。

![](https://cdn.luogu.com.cn/upload/image_hosting/3dkcy4vy.png)

上图是一个数和游戏的例子示意图，坐标 $(1, 4)$ 处是一个灰色格子，它的 $A$ 中的数字为 $4$，这意味它下方的条目（即坐标 $(2, 4)$、$(3, 4)$ 处的白色格子）中的数字之和应该为 $4$；坐标 $(5, 1)$ 处是一个灰色格子，它的 $B$ 中的数字是 $16$，这表示它右方的条目（即坐标 $(5, 2)$、$(5, 3)$ 处的白色格子）中的数字之和应该为 $16$。
## 输入格式

第一行输入两个正整数 $M$、$N$ 分别用来表示棋盘的宽度和高度。

接下来 $M$ 行，每行输入 $N$ 个格子的信息。对于白色格子，只需要输入一个整数 $1$；对于灰色格子，首先输入一个整数 $2$，接下来再输入两个正整数分别表示灰色格子中 $A$ 中的数字和 $B$ 中的数字，如果是 $-1$ 则表示 $A$ 或 $B$ 中没有数字。其中每一行输入的所有的相邻整数之间均用空格隔开。
## 输出格式

输出 $M$ 行，每行包含 $N$ 个格子的信息，如果当前位置是一个灰色格子则用一个 `_ `符号来表示；如果是一个白色格子，则用一个 $1 \dots 9$ 之间的整数来表示将要填入当前白色格子内的数字。每一行中，相邻格子之间的输出用一个空格分隔。
## 样例

### 样例输入 #1
```
7 7
2 -1 -1 2 -1 -1 2 -1 -1 2 4 -1 2 14 -1 2 19 -1 2 11 -1
2 -1 -1 2 -1 -1 2 21 24 1 1 1 1
2 -1 -1 2 26 18 1 1 1 1 1
2 -1 12 1 1 2 -1 -1 2 -1 3 1 1
2 -1 16 1 1 2 17 -1 2 11 8 1 1
2 -1 28 1 1 1 1 1 2 -1 -1
2 -1 14 1 1 1 1 2 -1 -1 2 -1 -1
```
### 样例输出 #1
```
_ _ _ _ _ _ _
_ _ _ 3 9 7 5
_ _ 6 1 5 4 2
_ 8 4 _ _ 2 1
_ 9 7 _ _ 5 3
_ 7 3 9 8 1 _
_ 2 1 8 3 _ _
```
## 提示

### 样例说明

![](https://cdn.luogu.com.cn/upload/image_hosting/khg8k4ql.png)

此局游戏的答案如上图所示。

### 评测用例规模与约定

- 对于 $30\%$ 的测试用例，$3 \leq M, N \leq 5$。
- 对于 $60\%$ 的测试用例，$3 \leq M, N \leq 10$。
- 对于 $100\%$ 的测试用例，$3 \leq M, N \leq 15$，$1 \leq$ 灰色格子中的数字 $\leq 50$。


---

---
title: "[蓝桥杯 2023 国 Java A] 单词分类"
layout: "post"
diff: 提高+/省选-
pid: P12238
tag: ['动态规划 DP', '2023', '树形 DP', '字典树 Trie', '蓝桥杯国赛']
---
# [蓝桥杯 2023 国 Java A] 单词分类
## 题目描述

在遥远的 LQ 国，只存在三种字符：$\tt{l}$、$\tt{q}$ 和 $\tt{b}$（ASCII 码分别为 $108$、$113$、$98$），所有的单词都由这三种字符组合而来。小蓝为了更加快速的记忆单词，决定将词典上所有的单词按照单词前缀将其分为 $K$ 类，具体的要求是:

1. 选出 $K$ 个不同的单词前缀作为 $K$ 类；
2. 对于字典上的每个单词，只能属于 $K$ 类中的某一个类，不能同时属于多个类；
3. 对于 $K$ 类中的每个类，至少包含有一个单词。

现在已知字典上一共有 $N$ 个单词，小蓝想要知道将这 $N$ 个单词按照上述要求分为 $K$ 类，一共有多少种不同的方案。两个方案不同指的是两个方案各自选出的 $K$ 个单词前缀不完全相同。答案可能过大，所以你需要将答案对 $1\,000\,000\,007$（即 $10^9 + 7$）取模后输出。
## 输入格式

输入的第一行包含两个整数 $N$ 和 $K$；

接下来 $N$ 行，每行包含一个单词，由 $\tt{l}$、$\tt{q}$、$\tt{b}$ 三种字符组成。
## 输出格式

输出一个整数表示答案。答案可能很大，请输出答案对 $1\,000\,000\,007$ 取模的值。
## 样例

### 样例输入 #1
```
4 2
lqb
lql
qqq
qql
```
### 样例输出 #1
```
4
```
## 提示

### 样例说明

- 方案 1：$\tt{l}=\tt{lqb}, \tt{lql}$、$\tt{q}=\tt{qqq}, \tt{qql}$；
- 方案 2：$\tt{lq}=\tt{lqb}, \tt{lql}$、$\tt{q}=\tt{qqq}, \tt{qql}$；
- 方案 3：$\tt{l}=\tt{lqb}, \tt{lql}$、$\tt{qq}=\tt{qqq}, \tt{qql}$；
- 方案 4：$\tt{lq}=\tt{lqb}, \tt{lql}$、$\tt{qq}=\tt{qqq}, \tt{qql}$。

以方案 $1$ 为例，他表示选出的两类对应的前缀分别是 $\tt l$ 和 $\tt q$，属于前缀 $\tt l$ 的单词有 $\tt {lqb}$、$\tt{lql}$，属于前缀 $\tt q$ 的单词有 $\tt{qqq}$、$\tt{qql}$，方案 $1$ 将四个单词按照前缀分成了两类，且每类至少包含一个单词，每个单词仅属于一类，所以方案 $1$ 满足题意。

### 评测用例规模与约定

- 对于 $30\%$ 的评测用例，$1 \leq N \leq 10$，$1 \leq K \leq 5$；
- 对于 $50\%$ 的评测用例，$1 \leq N \leq 50$，$1 \leq K \leq 10$；
- 对于所有评测用例，$1 \leq N \leq 200$，$1 \leq K \leq 100$，$1 \leq$ 单词长度 $\leq 10$。


---

---
title: "[蓝桥杯 2024 国 Python B] 全 X 数"
layout: "post"
diff: 提高+/省选-
pid: P12272
tag: ['2024', '数论', '蓝桥杯国赛', '欧拉函数']
---
# [蓝桥杯 2024 国 Python B] 全 X 数
## 题目描述

我们称 $22222, 3333, 7777$ 等由单一数字组成的十进制数为全 $X$ 数。

给定一个整数 $n$，小蓝想知道 $n$ 的所有倍数中最小的全 $X$ 数是多少。由于答案可能很大，你只需要输出答案对 $998244353$ 取模的结果。如果不存在任何答案，请输出 $-1$。
## 输入格式

输入一行包含一个整数 $n$。
## 输出格式

输出一行包含一个整数表示答案。
## 样例

### 样例输入 #1
```
12 
```
### 样例输出 #1
```
444
```
## 提示

### 评测用例规模与约定

- 对于 $50\%$ 的评测用例，$n \leq 5000$；
- 对于 $75\%$ 的评测用例，$n \leq 10^6$；
- 对于所有评测用例，$1 \leq n \leq 10^9$。


---

---
title: "[蓝桥杯 2024 国 Python A] 数字与留言"
layout: "post"
diff: 提高+/省选-
pid: P12284
tag: ['2024', '数位 DP', '蓝桥杯国赛']
---
# [蓝桥杯 2024 国 Python A] 数字与留言
## 题目描述

在一个阳光明媚的上午，小蓝走进了数学教室。他的目光很快被黑板上两个孤零零的数字 $x, y$ 吸引。数学老师总爱出些奇妙的谜题，今天显然也不例外。老师留言称，这两个数字暗含着一层不同寻常的心意，要想揭开这份心意的神秘面纱，就必须在 $1 \sim x$ 之间找到三个不同的正整数，使得这三个数的和除以 $2024$ 的余数值为 $y$，且这三个数的各个数位都不得包含数字 $2$ 和 $4$。

现在，请你帮助小蓝，求出有多少种不同的满足条件的三个数的组合。由于这个答案可能很大，你只需要输出答案对 $10^9 + 7$ 取余后的结果即可。

注意，如果通过改变三个正整数的顺序可以得到相同的组合，则这样的组合也被视为同一种。例如，对于 $x = 10, y = 9$，无论是 $1 + 3 + 5$ 还是 $5 + 3 + 1$，都只算作一种。
## 输入格式

输入一行包含两个整数 $x, y$，用一个空格分隔。
## 输出格式

输出一行包含一个整数，表示答案对 $10^9 + 7$ 取余后的结果。
## 样例

### 样例输入 #1
```
10 9
```
### 样例输出 #1
```
1
```
## 提示

### 样例说明

满足条件的组合仅有一组：$(1, 3, 5)$。

### 评测用例规模与约定

- 对于 $10\%$ 的评测用例，$1 \leq x \leq 700$，$0 \leq y \leq 2023$。
- 对于 $30\%$ 的评测用例，$1 \leq x \leq 10^5$，$0 \leq y \leq 2023$。
- 对于所有评测用例，$1 \leq x \leq 10^{12}$，$0 \leq y \leq 2023$。


---

---
title: "[蓝桥杯 2024 国研究生组] 最短路"
layout: "post"
diff: 提高+/省选-
pid: P12319
tag: ['图论', '2024', '矩阵加速', '蓝桥杯国赛']
---
# [蓝桥杯 2024 国研究生组] 最短路
## 题目描述

给定一个包含 $n$ 个点的图 $G$，用邻接矩阵 $A_{i,j}$ 表示，其中 $A_{i,j} = 0$ 表示无边，$A_{i,j} > 0$ 表示有边，$A_{i,j}$ 的值为边权。

给定 $m$ 次询问，每次询问你需要找出从 $a_i$ 到 $b_i$ 恰好经过 $c_i$ 条边的边权和最小的路径。对于每次询问，你可以选择某一条边，将其中的一次经过的边权整除 $2$（如果多次经过一条边，只有一次整除 $2$，其它次按原边权计算）。
## 输入格式

输入的第一行包含一个整数 $n$。

接下来 $n$ 行，每行包含 $n$ 个整数，表示邻接矩阵 $A_{i,j}$，相邻整数之间使用一个空格分隔。

接下来一行包含一个整数 $m$。

接下来 $m$ 行，每行包含 3 个整数 $a_i, b_i, c_i$ 表示一次询问，相邻整数之间使用一个空格分隔。
## 输出格式

输出 $m$ 行，每行包含一个整数依次表示每次询问的答案。如果有恰好经过 $c_i$ 条边的路径，输出路径的最小权值和。如果没有恰好经过 $c_i$ 条边的路径，输出 $-1$。
## 样例

### 样例输入 #1
```
3
0 1 1
0 1 0
1 0 0
4
2 1 1
1 2 2
1 3 3
3 1 4
```
### 样例输出 #1
```
-1
1
2
-1
```
## 提示

### 评测用例规模与约定

- 对于 $40\%$ 的评测用例，$m = 1$，$c_i \leq 50$；
- 另有 $10\%$ 的评测用例，$m \leq 100$，$c_i \leq 50$；
- 另有 $20\%$ 的评测用例，$m = 1$，$c_i < 2^{24}$；
- 对于所有评测用例，$1 \leq n \leq 50$，$1 \leq m \leq 1000$，$1 \leq a_i, b_i \leq n$，$1 \leq c_i \leq 10^9$，$0 \leq A_{i,j} \leq 10^9$。


---

---
title: "[蓝桥杯 2025 国 B] 近似回文字符串"
layout: "post"
diff: 提高+/省选-
pid: P12837
tag: ['数学', '2025', '组合数学', '容斥原理', '蓝桥杯国赛']
---
# [蓝桥杯 2025 国 B] 近似回文字符串
## 题目描述

小蓝，一位昔日的编程大神，如今却因找不到工作，转行成了飞天大盗。近日，他正筹划着盗取蓝桥王国的至宝——水晶项链。

水晶项链被珍藏在一个固若金汤的保险库中，要想开启保险库，就必须破解保险库的密码。利用编程技能，小蓝截获情报，得知这个密码是一个长度为 $N$，且仅由小写英文字母构成的“近似回文字符串”。

一个字符串 $S$ 被称为“近似回文字符串”需满足以下条件：

1. $S$ 本身不是回文串。
2. 从 $S$ 中删除一个字符后，剩下的字符串是回文串。

例如，当 $S = \text{abbac}$ 时，$S$ 不是回文，但删除最后一个字符 $\text{c}$ 后得到的 $\text{abba}$ 是回文，所以 $S$ 是“近似回文字符串”。

现在，请你帮助小蓝计算长度为 $N$ 的“近似回文字符串”的数量，为转行做飞天大盗的小蓝提供助力。由于答案可能很大，你只需给出其对 $10^9 + 7$ 取余后的结果即可。

## 输入格式

输入一行，包含一个整数 $N$，表示密码字符串的长度。

## 输出格式

输出一个整数，表示长度为 $N$ 的“近似回文字符串”的数量对 $10^9 + 7$ 取余后的结果。
## 样例

### 样例输入 #1
```
2
```
### 样例输出 #1
```
650
```
## 提示

**【评测用例规模与约定】**

对于 10% 的评测用例，$2 \leq N \leq 6$。

对于 100% 的评测用例，$2 \leq N \leq 10^5$。


---

---
title: "[蓝桥杯 2025 国 B] 涂格子"
layout: "post"
diff: 提高+/省选-
pid: P12839
tag: ['并查集', '2025', '组合数学', '蓝桥杯国赛']
---
# [蓝桥杯 2025 国 B] 涂格子
## 题目描述

小蓝正在玩一个涂格子的游戏。他有一个大小为 $n \times m$ 的矩阵，他要给这个矩阵中的每个格子都涂上黑色或白色。小蓝希望最终涂完的格子像国际象棋棋盘一样整齐。具体来说，他希望每一个同色连通块都是矩形，且与上下左右四个异色的矩形相邻（如果存在的话）。下图中第一行的两个涂色方案是合法的，第二行的两个涂色方案是不合法的。

![](https://cdn.luogu.com.cn/upload/image_hosting/ewqwlkxf.png)

同时小蓝希望 $k$ 个格子具有特定的颜色。其中第 $i$ 个格子位置是 $(x_i, y_i)$，具有特定的颜色 $c_i$。你需要帮助他求出符合要求的合法涂色方案有多少种。因为方案数可能很大，请对 $998244353$ 取模后输出。
## 输入格式

输入第一行包含三个正整数 $n, m, k$，含义如问题描述所述。

接下来 $k$ 行，每行三个正整数 $x_i, y_i, c_i$，表示格子 $(x_i, y_i)$ 必须被涂成颜色 $c_i$。**注意 $x_i, y_i$ 可能重复出现。**

## 输出格式

输出共一个整数，表示答案。
## 样例

### 样例输入 #1
```
2 2 4
1 1 0
1 2 0
2 1 0
2 2 1
```
### 样例输出 #1
```
0
```
### 样例输入 #2
```
3 3 2
1 1 0
2 2 1
```
### 样例输出 #2
```
8
```
## 提示

**【评测用例规模与约定】**

对于 $20\%$ 的评测用例，$n \times m \leq 20$。

对于 $50\%$ 的评测用例，$n, m, k \leq 5000$。

另存在 $30\%$ 的评测用例，$c_i = 0$。

另存在 $10\%$ 的评测用例，$k = 0$。

对于 $100\%$ 的评测用例，$1 \leq n, m \leq 10^9$，$1 \leq k \leq 3 \times 10^5$，$1 \leq x_i \leq n$，$1 \leq y_i \leq m$，$c_i \in \{0, 1\}$。



---

---
title: "[蓝桥杯 2025 国 A] 翻转硬币"
layout: "post"
diff: 提高+/省选-
pid: P12846
tag: ['线段树', '2025', '蓝桥杯国赛']
---
# [蓝桥杯 2025 国 A] 翻转硬币
## 题目描述

给定 $n$ 个硬币的初始状态，以及 $m$ 次如下类型的操作：

1. $1 \ x \ y$: 将 $[x, y]$ 之间的硬币每隔一个翻转一个，即翻转 $x, x+2, x+4, \cdots, x+2t \ (x+2t \leq y)$；
2. $2 \ x \ y$: 将 $[x, y]$ 之间的硬币每隔两个翻转一个，即翻转 $x, x+3, x+6, \cdots, x+3t \ (x+3t \leq y)$；
3. $3 \ x \ y$: 将 $[x, y]$ 之间的硬币全部翻转；
4. $4 \ x \ y$: 查询 $[x, y]$ 之间正面朝上的硬币个数。
## 输入格式

输入的第一行包含两个正整数 $n, m$，用一个空格分隔，分别表示硬币数和操作数。

第二行包含 $n$ 个整数 $f_1, f_2, \cdots, f_n$，相邻整数之间使用一个空格分隔，表示每个硬币的初始状态，其中 $f_i = 0$ 表示第 $i$ 个硬币为反面朝上，$f_i = 1$ 表示第 $i$ 个硬币为正面朝上。

接下来 $m$ 行，每行包含三个正整数 $a_i, x_i, y_i$，相邻整数之间使用一个空格分隔，表示一次操作。
## 输出格式

输出若干行。对于每次查询操作（$4 \ x \ y$），输出一行包含一个整数表示该查询的答案。
## 样例

### 样例输入 #1
```
5 8
1 0 0 1 0
1 2 3
4 1 5
2 3 5
4 2 5
3 1 5
4 2 3
3 1 4
4 1 5
```
### 样例输出 #1
```
3
3
0
5
```
## 提示

**【评测用例规模与约定】**

对于 20% 的评测用例，$1 \leq n, m \leq 5000$；

对于另外 20% 的评测用例，$1 \leq n, m \leq 10^5$，且没有 $1 \ x \ y$ 类型的操作；

对于另外 20% 的评测用例，$1 \leq n, m \leq 10^5$，且没有 $2 \ x \ y$ 类型的操作；

对于所有评测用例，$1 \leq n \leq 5 \times 10^5$，$1 \leq m \leq 10^5$，$f_i \in \{0, 1\}$，$a_i \in \{1, 2, 3, 4\}$，$1 \leq x_i \leq y_i \leq n$。


---

---
title: "[蓝桥杯 2025 国 A] 斐波那契数列"
layout: "post"
diff: 提高+/省选-
pid: P12847
tag: ['2025', '矩阵加速', '线性代数', '蓝桥杯国赛']
---
# [蓝桥杯 2025 国 A] 斐波那契数列
## 题目描述

斐波那契数列是一个满足如下要求的数列

$$\begin{cases} F_1 = 1 \\ F_2 = 1 \\ F_i = F_{i-1} + F_{i-2} \ (i > 2) \end{cases}$$

我们规定一个类似的数列满足

$$\begin{cases} G_1 = 2 \\ G_2 = 3 \\ G_i = G_{i-1} \times G_{i-2} \ (i > 2) \end{cases}$$

求该数列 $G$ 的前 $n$ 项的乘积对 $998244353$ 取模的结果。
## 输入格式

输入一行包含一个正整数 $n$。
## 输出格式

输出一行包含一个整数表示答案。
## 样例

### 样例输入 #1
```
5
```
### 样例输出 #1
```
69984
```
## 提示

**【评测用例规模与约定】**

对于 70% 的评测用例，$n \leq 10^6$；

对于所有评测用例，$1 \leq n \leq 10^{18}$。


---

---
title: "[蓝桥杯 2025 国 A] 游戏"
layout: "post"
diff: 提高+/省选-
pid: P12848
tag: ['贪心', '2025', '蓝桥杯国赛', 'Ad-hoc']
---
# [蓝桥杯 2025 国 A] 游戏
## 题目描述

小蓝正在进行一个游戏。这个游戏有 $n$ 个槽位和 $n-1$ 个石块，初始时第 $n$ 个槽位是空的，其余每个槽位都有一个石块，对于两个相连的槽位 $u, v$，若 $u$ 是空的，那么小蓝可以将 $v$ 里的石块移到 $u$ 中。开始时，对于任意的 $1 \leq i < n$，第 $i$ 个槽位和第 $i+1$ 个槽位是相连的。游戏的最终目的是将每一个编号为 $i$ 的石块移动到编号为 $i$ 的槽位中。

小蓝在经过几次简单的尝试后发现，这个游戏并不一定有解，但好在他可以花费 1 的代价，任选两个槽位使它们相连。小蓝希望你帮他求出，至少要花费多少的代价，能够让这个游戏有解。
## 输入格式

输入的第一行包含一个正整数 $n$。

第二行包含 $n-1$ 个正整数 $a_1, a_2, \cdots, a_{n-1}$，相邻整数之间使用一个空格分隔，分别表示初始第 $i$ 个槽位内石块的编号，保证 $a_i$ 各不相同。
## 输出格式

输出一行包含一个整数表示答案。
## 样例

### 样例输入 #1
```
5
4 1 2 3
```
### 样例输出 #1
```
1
```
## 提示

**【样例说明】**

小蓝可以令槽位 1 和槽位 5 相连，然后将石块 4 移动到槽位 5，将石块 1 移动到槽位 1，将石块 2 移动到槽位 2，将石块 3 移动到槽位 3，将石块 4 移动到槽位 4，即可完成游戏的目标。

**【评测用例规模与约定】**

对于 30% 的评测用例，$n \leq 5$；

对于 50% 的评测用例，最小代价不超过 1；

对于所有评测用例，$1 \leq n \leq 3 \times 10^5$，$1 \leq a_i < n$。


---

---
title: "[蓝桥杯 2025 国 A] 公路"
layout: "post"
diff: 提高+/省选-
pid: P12849
tag: ['2025', '蓝桥杯国赛']
---
# [蓝桥杯 2025 国 A] 公路
## 题目描述

小蓝居住的国家有 $n$ 座城市，城市与城市之间由 $n-1$ 条公路连接，而且任意两个城市都可以通过公路互相到达。

这个国家的公路由几个公司共同修建，如果小蓝希望通过某条公路，就必须持有修建这条公路的公司的通行证，但只要申请一次通行证，就可以在每一条这个公司修建的公路上通行。

小蓝经常要在不同城市之间旅行，每次他要从一个城市到另一个不同的城市，都需要根据需要通过的公路申请相应的通行证。具体来说，如果小蓝的路线经过了一条或者更多条 A 公司修建的公路，小蓝就需要申请一次 A 公司的通行证。

现在小蓝希望知道，对于这 $n \times (n-1)$ 种不同的情况，他需要申请通行证的次数总共是多少。
## 输入格式

输入的第一行包含一个正整数 $n$。

接下来 $n-1$ 行，每行包含三个正整数 $u_i, v_i, w_i$，相邻整数之间使用一个空格分隔，表示城市 $u_i$ 和城市 $v_i$ 之间有一条由公司 $w_i$ 修建的公路。

## 输出格式

输出一行包含一个整数表示答案。
## 样例

### 样例输入 #1
```
4
1 2 1
1 3 1
1 4 2
```
### 样例输出 #1
```
16
```
## 提示

**【样例说明】**

下表给出了每种情况需要申请的通行证数量，总和为 16。

|  | 1 | 2 | 3 | 4 |
| --- | --- | --- | --- | --- |
| 1 | / | 1 | 1 | 1 |
| 2 | 1 | / | 1 | 2 |
| 3 | 1 | 1 | / | 2 |
| 4 | 1 | 2 | 2 | / |

**【评测用例规模与约定】**

对于 30% 的评测用例，$1 \leq n \leq 300$；

对于另外 20% 的评测用例，$u_i = i$，$v_i = i + 1$；

对于另外 20% 的评测用例，$u_i = 1$，$v_i = i + 1$；

对于 80% 的评测用例，$1 \leq n \leq 50000$；

对于所有评测用例，$1 \leq w_i, u_i, v_i \leq n \leq 500000$。


---

---
title: "[蓝桥杯 2013 国 B] 高僧斗法"
layout: "post"
diff: 提高+/省选-
pid: P8606
tag: ['博弈论', '2013', '蓝桥杯国赛']
---
# [蓝桥杯 2013 国 B] 高僧斗法
## 题目描述

古时丧葬活动中经常请高僧做法事。仪式结束后，有时会有“高僧斗法”的趣味节目，以舒缓压抑的气氛。

节目大略步骤为：先用粮食（一般是稻米）在地上“画”出若干级台阶（表示 $N$ 级浮屠）。又有若干小和尚随机地“站”在某个台阶上。最高一级台阶必须站人，其它任意。（如图 $1$ 所示 )。

![](https://cdn.luogu.com.cn/upload/image_hosting/vnuni82v.png)

两位参加游戏的法师分别指挥某个小和尚向上走任意多级的台阶，但会被站在高级台阶上的小和尚阻挡，不能越过。两个小和尚也不能站在同一台阶，也不能向低级台阶移动。

两法师轮流发出指令，最后所有小和尚必然会都挤在高段台阶，再也不能向上移动。轮到哪个法师指挥时无法继续移动，则游戏结束，该法师认输。

对于已知的台阶数和小和尚的分布位置，请你计算先发指令的法师该如何决策才能保证胜出。
## 输入格式

输入数据为一行用空格分开的 $N$ 个整数，表示小和尚的位置。台阶序号从 $1$ 算起，所以最后一个小和尚的位置即是台阶的总数。（$N<100,$ 台阶总数 $<1000$）
## 输出格式

输出为一行用空格分开的两个整数 ：$A,B$， 表示把 $A$ 位置的小和尚移动到 $B$ 位置。若有多个解，输出 $A$ 值较小的解，若无解则输出 $-1$。
## 样例

### 样例输入 #1
```
1 5 9
```
### 样例输出 #1
```
1 4
```
### 样例输入 #2
```
1 5 8 10
```
### 样例输出 #2
```
1 3
```
## 提示

时限 1 秒, 64M。蓝桥杯 2013 年第四届国赛


---

---
title: "[蓝桥杯 2013 国 B] 农场阳光"
layout: "post"
diff: 提高+/省选-
pid: P8608
tag: ['计算几何', '2013', '蓝桥杯国赛']
---
# [蓝桥杯 2013 国 B] 农场阳光
## 题目描述

X 星球十分特殊，它的自转速度与公转速度相同，所以阳光总是以固定的角度照射。

最近，X 星球为发展星际旅游业，把空间位置出租给 Y 国游客来晒太阳。每个租位是漂浮在空中的圆盘形彩云（圆盘与地面平行）。当然，这会遮挡住部分阳光，被遮挡的土地植物无法生长。

本题的任务是计算某个农场宜于作物生长的土地面积有多大。
## 输入格式

输入数据的第一行包含两个整数 $a,b$，表示某农场的长和宽分别是 $a$ 和 $b$，此时，该农场的范围是由坐标 $(0,0,0),(a,0,0),(a,b,0),(0,b,0)$ 围成的矩形区域。

第二行包含一个实数 $g$，表示阳光照射的角度。简单起见，我们假设阳光光线是垂直于农场的宽的，此时正好和农场的长的夹角是 $g$ 度，此时，空间中的一点 $(x,y,z)$ 在地面的投影点应该是 $(x+z \times \ctg(g),y,0)$，其中 $\ctg(g)$ 表示 $g$ 度对应的余切值。

第三行包含一个非负整数 $n$，表示空中租位个数。

接下来 $n$ 行，描述每个租位。其中第 $i$ 行包含 $4$ 个整数 $x_i,y_i,z_i,r_i$，表示第 $i$ 个租位彩云的圆心在 $(x_i,y_i,z_i)$ 位置，圆半径为 $r_i$。
## 输出格式

要求输出一个实数，四舍五入保留两位有效数字，表示农场里能长庄稼的土地的面积。
## 样例

### 样例输入 #1
```
10 10
90.0
1
5 5 10 5
```
### 样例输出 #1
```
21.46
```
### 样例输入 #2
```
8 8
90.0
1
4 4 10 5
```
### 样例输出 #2
```
1.81

```
### 样例输入 #3
```
20 10
45.0
2
5 0 5 5
8 6 14 6
```
### 样例输出 #3
```
130.15
```
## 提示

时限 1 秒, 64M。蓝桥杯 2013 年第四届国赛


---

---
title: "[蓝桥杯 2016 国 AC] 碱基"
layout: "post"
diff: 提高+/省选-
pid: P8643
tag: ['动态规划 DP', '2016', '哈希 hashing', '蓝桥杯国赛']
---
# [蓝桥杯 2016 国 AC] 碱基
## 题目描述

生物学家正在对 $n$ 个物种进行研究。

其中第 $i$ 个物种的 DNA 序列为 $s[i]$，其中的第 $j$ 个碱基为 $s[i][j],$ 碱基一定是 `A`,`G`,`C`,`T` 之一。

生物学家想找到这些生物中一部分生物的一些共性，他们现在关注那些至少在 $m$ 个生物中出现的长度为 $k$ 的连续碱基序列。准确的说，科学家关心的序列用 $2m$ 元组 $(i_1,p_1,i_2,p_2 \cdots ,i_m,p_m)$ 表示，

满足：

$$1 \le i_1<i_2< \cdots <i_m \le n$$

且对于所有 $q(0 \le q<k)$，

$$s[i_1][p_1+q]=s[i_2][p_2+q]= \cdots =s[i_m][p_m+q]$$

现在给定所有生物的 DNA 序列，请告诉科学家有多少的 $2m$ 元组是需要关注的。如果两个 $2m$ 元组有任何一个位置不同，则认为是不同的元组。
## 输入格式

输入的第一行包含三个整数 $n$，$m$，$k$，两个整数之间用一个空格分隔，意义如题目所述。

接下来 $n$ 行，每行一个字符串表示一种生物的 DNA 序列。

DNA 序列从 $1$ 至 $n$ 编号，每个序列中的碱基从 $1$ 开始依次编号，不同的生物的 DNA 序列长度可能不同。
## 输出格式

输出一个整数，表示关注的元组个数。

答案可能很大，你需要输出答案除以 $1000000007(10^9+7)$ 的余数。
## 样例

### 样例输入 #1
```
3 2 2
ATC
TCG
ACG
```
### 样例输出 #1
```
2
```
### 样例输入 #2
```
4 3 3
AAA
AAAA
AAA
AAA
```
### 样例输出 #2
```
7
```
## 提示

### 数据规模与约定

对于 $20\%$ 的数据，$k \le 5,$ 所有字符串总长 $L$ 满足 $L \le 100$。

对于 $30\%$ 的数据，$L \le 10000$。

对于 $60\%$ 的数据，$L \le 30000$。

对于 $100\%$ 的数据，$n \le 5,m \le 5,1 \le k \le L \le 10^5$。

保证所有 DNA 序列不为空且只会包含`A`,`G`,`C`,`T` 四种字母。

时限 1 秒, 256M。蓝桥杯 2016 年第七届国赛


---

---
title: "[蓝桥杯 2016 国 B] 广场舞"
layout: "post"
diff: 提高+/省选-
pid: P8645
tag: ['计算几何', '2016', '数论', '蓝桥杯国赛']
---
# [蓝桥杯 2016 国 B] 广场舞
## 题目描述

LQ 市的市民广场是一个多边形，广场上铺满了大理石的地板砖。

地板砖铺得方方正正，就像坐标轴纸一样。

以某四块砖相接的点为原点，地板砖的两条边为两个正方向，一块砖的边长为横纵坐标的单位长度，则所有横纵坐标都为整数的点都是四块砖的交点（如果在广场内）。

广场的砖单调无趣，却给跳广场舞的市民们提供了绝佳的参照物。每天傍晚，都会有大批市民前来跳舞。

舞者每次都会选一块完整的砖来跳舞，两个人不会选择同一块砖，如果一块砖在广场边上导致缺角或者边不完整，则没人会选这块砖。

（广场形状的例子参考图）

![](https://cdn.luogu.com.cn/upload/image_hosting/kjgaxse9.png)

现在，告诉你广场的形状，请帮 LQ 市的市长计算一下，同一时刻最多有多少市民可以在广场跳舞。
## 输入格式

输入的第一行包含一个整数 $n$，表示广场是 $n$ 边形的（因此有 $n$ 个顶点）。

接下来 $n$ 行，每行两个整数，依次表示 $n$ 边形每个顶点的坐标（也就是说广场边缘拐弯的地方都在砖的顶角上。数据保证广场是一个简单多边形。
## 输出格式

输出一个整数，表示最多有多少市民可以在广场跳舞。
## 样例

### 样例输入 #1
```
5
3 3
6 4
4 1
1 -1
0 4
```
### 样例输出 #1
```
7
```
### 样例输入 #2
```
3 3
```
### 样例输出 #2
```
4
```
## 提示

**【样例说明】**

广场如图所示，一共有 $7$ 块完整的地板砖，因此最多能有 $7$ 位市民一起跳舞。

**【数据规模与约定】**

对于 $30\%$ 的数据，$n$ 不超过 $100$，横纵坐标的绝对值均不超过 $100$。

对于 $50\%$ 的数据，$n$ 不超过 $1000$，横纵坐标的绝对值均不超过 $1000$。

对于 $100\%$ 的数据，$n$ 不超过 $1000$，横纵坐标的绝对值均不超过 $10^8$。

时限 1 秒, 256M。蓝桥杯 2016 年第七届


---

---
title: "[蓝桥杯 2017 国 B] 观光铁路"
layout: "post"
diff: 提高+/省选-
pid: P8657
tag: ['2017', 'Special Judge', '高斯消元', '蓝桥杯国赛']
---
# [蓝桥杯 2017 国 B] 观光铁路
## 题目描述

跳蚤国正在大力发展旅游业，每个城市都被打造成了旅游景点。

许多跳蚤想去其他城市旅游，但是由于跳得比较慢，它们的愿望难以实现。这时，小 C 听说有一种叫做火车的交通工具，在铁路上跑得很快，便抓住了商机，创立了一家铁路公司，向跳蚤国王请示在每两个城市之间都修建铁路。

然而，由于小 C 不会扳道岔，火车到一个城市以后只能保证不原路返回，而会随机等概率地驶向与这个城市有铁路连接的另外一个城市。

跳蚤国王向广大居民征求意见，结果跳蚤们不太满意，因为这样修建铁路以后有可能只游览了 $3$ 个城市（含出发的城市）以后就回来了，它们希望能多游览几个城市。于是跳蚤国王要求小 C 提供一个方案，使得每只跳蚤坐上火车后能多游览几个城市才回来。

小 C 提供了一种方案给跳蚤国王。跳蚤国王想知道这个方案中每个城市的居民旅游的期望时间（设火车经过每段铁路的时间都为 $1$），请你来帮跳蚤国王。
## 输入格式

输入的第一行包含两个正整数 $n$、$m$，其中 $n$ 表示城市的数量，$m$ 表示方案中的铁路条数。

接下来 $m$ 行，每行包含两个正整数 $u$、$v$，表示方案中城市 $u$ 和城市 $v$ 之间有一条铁路。

保证方案中无重边无自环，每两个城市之间都能经过铁路直接或间接到达，且火车由任意一条铁路到任意一个城市以后一定有路可走。
## 输出格式

输出 $n$ 行，第 $i$ 行包含一个实数 $t_i$，表示方案中城市 $i$ 的居民旅游的期望时间。你应当输出足够多的小数位数，以保证输出的值和真实值之间的绝对或相对误差不超过 $10^{-9}$。

感谢 @[zhang_kevin](https://www.luogu.com.cn/user/679961) 提供 Special Judge.
## 样例

### 样例输入 #1
```
4 5
1 2
2 3
3 4
4 1
1 3
```
### 样例输出 #1
```
3.333333333333
5.000000000000
3.333333333333
5.000000000000
```
### 样例输入 #2
```
10 15
1 2
1 9
1 5
2 3
2 7
3 4
3 10
4 5
4 8
5 6
6 7
6 10
7 8
8 9
9 10
```
### 样例输出 #2
```
10.000000000000
10.000000000000
10.000000000000
10.000000000000
10.000000000000
10.000000000000
10.000000000000
10.000000000000
10.000000000000
10.000000000000
```
## 提示

对于 $10\%$ 的测试点，$n \le 10$；

对于 $20\%$ 的测试点，$n \le 12$；

对于 $50\%$ 的测试点，$n \le 16$；

对于 $70\%$ 的测试点，$n \le 19$；

对于 $100\%$ 的测试点，$4 \le k \le n \le 21$，$1 \le u,v \le n$。数据有梯度。

时限 1 秒, 256M。蓝桥杯 2017 年第八届国赛


---

---
title: "[蓝桥杯 2017 国 A] 区间移位"
layout: "post"
diff: 提高+/省选-
pid: P8660
tag: ['贪心', '2017', '二分', '排序', '蓝桥杯国赛']
---
# [蓝桥杯 2017 国 A] 区间移位
## 题目描述

数轴上有 $n$ 个闭区间：$D_1, \cdots ,D_n$。

其中区间 $D_i$ 用一对整数 $[a_i,b_i]$ 来描述，满足 $a_i<b_i$。

已知这些区间的长度之和至少有 $10000$。

所以，通过适当的移动这些区间，你总可以使得他们的“并”覆盖 $[0,10000]$ ——也就是说 $[0,10000]$ 这个区间内的每一个点都落于至少一个区间内。

你希望找一个移动方法，使得位移差最大的那个区间的位移量最小。

具体来说，假设你将 $D_i$ 移动到 $[a_i+c_i,b_i+c_i]$ 这个位置。你希望使得 $\max\limits_{i=1}^n\{|c_i|\}$ 最小。
## 输入格式

输入的第一行包含一个整数 $n$，表示区间的数量。

接下来有 $n$ 行，每行 $2$ 个整数 $a_i,b_i$，以一个空格分开，表示区间 $[a_i,b_i]$。

保证区间的长度之和至少是 $10000$。

## 输出格式

输出一个数字，表示答案。如果答案是整数，只输出整数部分。如果答案不是整数，输出时四舍五入保留一位小数。
## 样例

### 样例输入 #1
```
2
10 5010
4980 9980
```
### 样例输出 #1
```
20
```
### 样例输入 #2
```
4
0 4000
3000 5000
5001 8000
7000 10000
```
### 样例输出 #2
```
0.5
```
## 提示

**【样例解释】**

样例 1：第一个区间往左移动 $10$；第二个区间往右移动 $20$。

样例 2：第 $2$ 个区间往右移 $0.5$；第 $3$ 个区间往左移 $0.5$ 即可。

**【数据范围】**

对于 $30\%$ 的评测用例，$1 \le n \le 10$；

对于 $100\%$ 的评测用例，$1 \le n \le 10000$，$0 \le a_i<b_i \le 10000$。


---

---
title: "[蓝桥杯 2018 国 B] 矩阵求和"
layout: "post"
diff: 提高+/省选-
pid: P8670
tag: ['2018', '数论', '蓝桥杯国赛']
---
# [蓝桥杯 2018 国 B] 矩阵求和
## 题目描述

经过重重笔试面试的考验，小明成功进入 Macrohard 公司工作。

今天小明的任务是填满这么一张表：

表有 $n$ 行 $n$ 列，行和列的编号都从 $1$ 算起。

其中第 $i$ 行第 $j$ 个元素的值是 $\gcd(i, j)$ 的平方，$\gcd$ 表示最大公约数，以下是这个表的前四行的前四列：

```
1  1  1  1
1  4  1  4
1  1  9  1
1  4  1 16
```

小明突然冒出一个奇怪的想法，他想知道这张表中所有元素的和。
由于表过于庞大，他希望借助计算机的力量。

## 输入格式

一行一个正整数 $n$ 意义见题。
## 输出格式

一行一个数，表示所有元素的和。由于答案比较大，请输出模 $1000000007$（即$10^9+7$）后的结果。
## 样例

### 样例输入 #1
```
4
```
### 样例输出 #1
```
48
```
## 提示

对于 $30\%$ 的数据，$n\le 1000$。

存在 $10\%$ 的数据，$n = 10^5$。

对于 $60\%$ 的数据，$n\le 10^6$。

对于 $100\%$ 的数据，$n\le 10^7$。



---

---
title: "[蓝桥杯 2018 国 A] 采油"
layout: "post"
diff: 提高+/省选-
pid: P8677
tag: ['2018', '树形 DP', '蓝桥杯国赛']
---
# [蓝桥杯 2018 国 A] 采油
## 题目描述

LQ 公司是世界著名的石油公司，为世界供应优质石油。

最近，LQ 公司又在森林里发现了一大片区域的油田，可以在这个油田中开采 $n$ 个油井。

LQ 公司在这 $n$ 个油井之间修建了 $n-1$ 条道路，每条道路连接两个油井，路径中间不会路过任何油井，而且这些道路将所有油井连通。

建立油井的时候需要使用一台大型设备，运输起来非常麻烦，LQ 公司准备在其中的一个油井位置建立一个空运站，先将设备空运到空运站，之后每次经过他们建立的道路来运输这个大型设备以建立不同的油井，当油井建立完毕后再从空运站将大型设备运走。

为了减少运输的麻烦，公司要求大型设备在道路上运输的总路程是最短的。

在建立油井和采油的过程中需要花费一些人力，第 $i$ 个油井需要花费 $B_i$ 个人，而一旦油井建成，就需要 $S_i$ 个人一直坚守在油井上进行维护。

当然，如果一个人参与了油井的建设，他可以直接留下来维护油井，或者参与下一个油井的建设，但是在维护油井的人不能再参加后续油井的建设了。

现在 LQ 公司想知道，大型设备运输的总路径长度最短是多少？在保证总路径长度最短的情况下，LQ 公司至少需要花费多少人力才能完成所有油井的建立与维护。

## 输入格式

输入的第一行包含一个整数 $n$，表示油井的数量。油井由 $1$ 到 $n$ 依次标号。

第二行包含 $n$ 个整数，依次表示 $B_1,B_2,\cdots,B_n$，相邻的整数之间用一个空格分隔。

第三行包含 $n$ 个整数，依次表示 $S_1,S_2,\cdots,S_n$，相邻的整数之间用一个空格分隔。

接下来 $n-1$ 行描述油井之间的道路，其中的第 $i$ 行包含两个整数 $a$，$b$，用一个空格分隔，表示一条道路的起点为 $i+1$ 、终点为 $a$，长度为 $b$，道路是双向的，设备可以从任意一端运送到另一端，每条道路都可以经过任意多次。数据保证任意两个油井之间都可以通过道路连接。

## 输出格式

输出包含两个整数，用一个空格分隔，表示最优情况下大型设备需要运输的总路程，以及在总路程最短的情况下最少需要花费的人力数量。
## 样例

### 样例输入 #1
```
6
3 10 20 7 15 9
2 6 10 4 8 7
1 9
1 2
2 5
3 4
3 7
```
### 样例输出 #1
```
54 38
```
## 提示

**【样例解释】**

有两种方案达到最优。

方案一：在油井 $2$ 建立空运站，先建立油井 $2$，再将大型设备运输到油井 $1$ 建立油井 $1$，最后将大型设备运回油井 $2$。

方案二：在油井 $1$ 建立空运站，先将大型设备运输到油井 $2$ 建立油井 $2$，再将大型设备运送到油井 $1$ 建立油井 $1$。

**【数据范围】**

对于 $20\%$ 的数据：$n$ 不超过 $10$；

另外 $20\%$ 的数据：每个油井最多和两个油井之间有道路直接连接；

另外 $10\%$ 的数据：有 $n-1$ 个油井只有一条道路与其他油井连接；

对于 $100\%$ 的数据：$1\le n\le10^5$，$B$、$S$、$c$ 均为不超过 $10000$ 的正整数。

时限 1 秒, 256M。蓝桥杯 2018 年第九届国赛


---

---
title: "[蓝桥杯 2019 国 B] 第八大奇迹"
layout: "post"
diff: 提高+/省选-
pid: P8701
tag: ['2019', '可持久化线段树', '蓝桥杯国赛']
---
# [蓝桥杯 2019 国 B] 第八大奇迹
## 题目背景

在一条 R 河流域，繁衍着一个古老的名族 Z。他们世代沿河而居，也在河边发展出了璀璨的文明。

Z 族在 R 河沿岸修建了很多建筑，最近，他们热衷攀比起来。他们总是在比谁的建筑建得最奇特。

幸好 Z 族人对奇特的理解都差不多，他们很快给每栋建筑都打了分，这样评选谁最奇特就轻而易举了。

于是，根据分值，大家很快评出了最奇特的建筑，称为大奇迹。后来他们又陆续评选了第二奇特、第二奇特、……、第七奇特的建筑，依次称为第二大奇迹、第三大奇迹、……、第七大奇迹。

最近，他们开始评选第八奇特的建筑，准备命名为第八大奇迹。在评选中，他们遇到了一些问题。
## 题目描述

首先，Z 族一直在发展，有的建筑被拆除又建了新的建筑，新建筑的奇特值和原建筑不一样，这使得评选不那么容易了。

其次，Z 族的每个人所生活的范围可能不一样，他们见过的建筑并不是所有的建筑，他们坚持他们自己所看到的第八奇特的建筑就是第八大奇迹。

Z 族首领最近很头疼这个问题，他害怕因为意见不一致导致 Z 族发生分歧。他找到你，他想先了解一下，民众自己认为的奇迹是怎样的。

现在告诉在 R 河周边的建筑的变化情况，以及在变化过程中一些人的生活范围，请编程求出每个人认为的第八大奇迹的奇特值是多少。
## 输入格式

输入的第一行包含两个整数 $L$, $N$，分别表示河流的长度和要你处理的信息的数量。开始时河流沿岸没有建筑，或者说所有的奇特值为 $0$。接下来 $N$ 行，每行一条你要处理的信息。

如果信息为 `C p x`，表示流域中第 $p$ 个位置 $(1 \le p \le L)$ 建立了一个建筑，其奇特值为 $x$。如果这个位置原来有建筑，原来的建筑会被拆除。

如果信息为 `Q a b`，表示有个人生活的范围是河流的第 $a$ 到 $b$ 个位置（包含 $a$ 和 $b$，$a \le b$），这时你要算出这个区间的第八大奇迹的奇特值，并输出。如果找不到第八大奇迹，输出 $0$。

## 输出格式

对于每个为 $Q$ 的信息，你需要输出一个整数，表示区间中第八大奇迹的奇特值。
## 样例

### 样例输入 #1
```
10 15
C 1 10
C 2 20
C 3 30
C 4 40
C 5 50
C 6 60
C 7 70
C 8 80
C 9 90
C 10 100
Q 1 2
Q 1 10
Q 1 8
C 10 1
Q 1 10
```
### 样例输出 #1
```
0
30
10
20

```
## 提示

对于 $20\%$ 的评测用例，$1 \le L \le 1000$，$1 \le N \le 1000$。

对于 $40\%$ 的评测用例，$1 \le L \le 10000$，$1 \le N \le 10000$。

对于 $100\%$ 的评测用例，$1 \le L \le 10^5$，$1 \le N \le 10^5$。所有奇特值为不超过 $10^9$ 的非负整数。

蓝桥杯 2019 年国赛 B 组 I 题。


---

---
title: "[蓝桥杯 2020 国 AB] 出租车"
layout: "post"
diff: 提高+/省选-
pid: P8731
tag: ['2020', '图论建模', '最短路', '蓝桥杯国赛']
---
# [蓝桥杯 2020 国 AB] 出租车
## 题目背景

小蓝在 $L$ 市开出租车。
## 题目描述

$L$ 市的规划很规整，所有的路都是正东西向或者正南北向的，道路都可以看成直线段。东西向的道路互相平行, 南北向的道路互相平行，任何一条东西向道路垂直于任何一条南北向道路。

从北到南一共有 $n$ 条东西向道路，依次标号为 $H_{1}, H_{2}, \cdots, H_{n}$ 。从西到东 一共有 $m$ 条南北向的道路，依次标号为 $S_{1}, S_{2}, \cdots, S_{m}$ 。

每条道路都有足够长，每一条东西向道路和每一条南北向道路都相交，$H_{i}$ 与 $S_{j}$ 的交叉路口记为 $(i, j)$ 。

从 $H_{1}$ 和 $S_{1}$ 的交叉路口 $(1,1)$ 开始，向南遇到的路口与 $(1,1)$ 的距离分别 是 $h_{1}, h_{2}, \cdots, h_{n-1}$，向东遇到路口与 $(1,1)$ 的距离分别是 $w_{1}, w_{2}, \cdots, w_{m-1}$ 。

道路的每个路口都有一个红绿灯。

时刻 $0$ 的时候，南北向绿灯亮，东西向红灯亮，南北向的绿灯会持续一段时间（每个路口不同)，然后南北向变成红灯，东西向变成绿灯，持续一段时间后，再变成南北向绿灯，东西向红灯。

已知路口 $(i, j)$ 的南北向绿灯每次持续的时间为 $g_{i j}$, 东西向的绿灯每次持续的时间为 $r_{i j}$, 红绿灯的变换时间忽略。

当一辆车走到路口时，如果是绿灯，可以直行、左转或右转。如果是红灯，可以右转，不能直行或左转。如果到路口的时候刚好由红灯变为绿灯，则视为看到绿灯；如果刚好由绿灯变为红灯，则视为看到红灯。

每段道路都是双向道路，道路中间有隔离栏杆，在道路中间不能掉头, 只能在红绿灯路口掉头。掉头时不管是红灯还是绿灯都可以直接掉头。掉头的时间可以忽略。

小蓝时刻 $0$ 从家出发。今天，他接到了 $q$ 个预约的订单，他打算按照订单 的顺序依次完成这些订单，就回家休息。中途小蓝不准备再拉其他乘客。小蓝的家在两个路口的中点，小蓝喜欢用 $x_{1}, y_{1}, x_{2}, y_{2}$ 来表示自己家的位 置, 即路口 $\left(x_{1}, y_{1}\right)$ 到路口 $\left(x_{2}, y_{2}\right)$ 之间的道路中点的右侧, 保证两个路口相邻 (中间没有其他路口)。请注意当两个路口交换位置时，表达的是路的不同两边，路中间有栏杆，因此这两个位置实际要走比较远才能到达。

小蓝的订单也是从某两个路口间的中点出发，到某两个路口间的中点结束。小蓝必须按照给定的顺序处理订单，而且一个时刻只能处理一个订单，不能图省时间而同时接两位乘客，也不能揷队完成后面的订单。

小蓝只对 $L$ 市比较熟，因此他只会在给定的 $n$ 条东西向道路和 $m$ 条南北向道路上行驶，而且不会驶出 $H_{1}, H_{n}, S_{1}, S_{m}$ 这几条道路所确定的矩形区域 (可 以到边界。

小蓝行车速度一直为 $1$，乘客上下车的时间忽略不计。

请问，小蓝最早什么时候能完成所有订单回到家。
## 输入格式

输入第一行包含两个整数 $n, m$，表示东西向道路的数量和南北向道路的数 量。

第二行包含 $n-1$ 个整数 $h_{1}, h_{2}, \cdots, h_{n-1}$ 。

第三行包含 $m-1$ 个整数 $w_{1}, w_{2}, \cdots, w_{m-1}$ 。

接下来 $n$ 行, 每行 $m$ 个整数，描述每个路口南北向绿灯的时间，其中的第 $i$ 行第 $j$ 列表示 $g_{i j}$ 。

接下来 $n$ 行, 每行 $m$ 个整数，描述每个路口东西向绿灯的时间，其中的第 $i$ 行第 $j$ 列表示 $r_{i j}$ 。

接下来一行包含四个整数 $x_{1}, y_{1}, x_{2}, y_{2}$，表示小蓝家的位置在路口 $\left(x_{1}, y_{1}\right)$ 到路口 $\left(x_{2}, y_{2}\right)$ 之间的道路中点的右侧。

接下来一行包含一个整数 $q$，表示订单数量。

接下来 $q$ 行，每行描述一个订单，其中第 $i$ 行包含八个整数 $x_{i 1}, y_{i 1}, x_{i 2}, y_{i 2}$，$x_{i 3}, y_{i 3}, x_{i 4}, y_{i 4}$，表示第 $i$ 个订单的起点为路口 $\left(x_{i 1}, y_{i 1}\right)$ 到路口 $\left(x_{i 2}, y_{i 2}\right)$ 之间的道 路中点的右侧，第 $i$ 个订单的终点为路口 $\left(x_{i 3}, y_{i 3}\right)$ 到路口 $\left(x_{i 4}, y_{i 4}\right)$ 之间的道路中 点的右侧。 
## 输出格式

输出一个实数，表示小蓝完成所有订单最后回到家的最早时刻。四舍五入保留一位小数。
## 样例

### 样例输入 #1
```
2 3
200
100 400
10 20 10
20 40 30
20 20 20
20 20 20
2 1 1 1
1
2 2 1 2 1 2 1 3
```
### 样例输出 #1
```
1620.0
```
## 提示

**【样例说明】**

蓝有一个订单, 他的行车路线如下图所示。其中 $\mathrm{H}$ 表示他家的位置, $\mathrm{S}$ 表示订单的起点, $\mathrm{T}$ 表示订单的终点。小小明在最后回家时要在直行的红绿灯路 口等绿灯, 等待时间为 $20$。 

![](https://luogu.oss-cn-hangzhou.aliyuncs.com/upload/vjudge_pic/lanqiao/2022_09_30_334c51de49a3a8e7ba1bg-15.jpg)

**【评测用例规模与约定】**

对于 $20 \%$ 的评测用例, $1 \leq n, m \leq 5,1 \leq q \leq 10$ 。

对于 $50 \%$ 的评测用例, $1 \leq n, m \leq 30,1 \leq q \leq 30$ 。

对于所有评测用例, $1 \leq n, m \leq 100,1 \leq q \leq 30,1 \leq h_{1}<h_{2}<\cdots<h_{n-1} \leq$ $100000,1 \leq w_{1}<w_{2}<\cdots<w_{m-1} \leq 100000,1 \leq g_{i j} \leq 1000,1 \leq r_{i j} \leq 1000$, 给定的路口一定合法。 


---

---
title: "[蓝桥杯 2020 国 A] 奇偶覆盖"
layout: "post"
diff: 提高+/省选-
pid: P8734
tag: ['2020', '线段树', '扫描线', '蓝桥杯国赛']
---
# [蓝桥杯 2020 国 A] 奇偶覆盖
## 题目描述

在平面内有一些矩形，它们的两条边都平行于坐标轴。

我们称一个点被某个矩形覆盖，是指这个点在矩形的内部或者边界上。

请问，被奇数个矩形覆盖和被偶数 $(\geq 2)$ 个矩形覆盖的点的面积分别是多少?
## 输入格式

输入的第一行包含一个整数 $n$，表示矩形的个数。

接下来 $n$ 行描述这些矩形，其中第 $i$ 行包含四个整数 $l_{i}, b_{i}, r_{i}, t_{i}$，表示矩形的两个对角坐标分别为 $\left(l_{i}, b_{i}\right),\left(r_{i}, t_{i}\right)$ 。

## 输出格式

输出两行。

第一行包含一个整数，表示被奇数个矩形覆盖的点的面积。

第二行包含一个整数，表示被偶数 $(\geq 2)$ 个矩形覆盖的点的面积。
## 样例

### 样例输入 #1
```
3
1 1 3 3
2 2 4 4
3 3 5 5
```
### 样例输出 #1
```
8
2
```
## 提示

对于 $20 \%$ 的评测用例, $1 \leq n \leq 10,0 \leq l_{i}<r_{i} \leq 100,0 \leq b_{i}<t_{i} \leq 100$ 。

对于 $40 \%$ 的评测用例, $1 \leq n \leq 1000,0 \leq l_{i}<r_{i} \leq 100,0 \leq b_{i}<t_{i} \leq 100$ 。

对于 $60 \%$ 的评测用例, $1 \leq n \leq 10000,0 \leq l_{i}<r_{i} \leq 1000,0 \leq b_{i}<t_{i} \leq 1000$ 。

对于 $80 \%$ 的评测用例, $1 \leq n \leq 10^5,0 \leq l_{i}<r_{i} \leq 10^5,0 \leq b_{i}<t_{i} \leq 10^5$。

对于所有评测用例, $1 \leq n \leq 10^5,0 \leq l_{i}<r_{i} \leq 10^{9}, 0 \leq b_{i}<t_{i} \leq 10^{9}$。 

蓝桥杯 2020 年国赛 A 组 I 题。


---

---
title: "[蓝桥杯 2020 国 B] 质数行者"
layout: "post"
diff: 提高+/省选-
pid: P8737
tag: ['动态规划 DP', '2020', '容斥原理', '蓝桥杯国赛']
---
# [蓝桥杯 2020 国 B] 质数行者
## 题目背景

小蓝在玩一个叫质数行者的游戏。
## 题目描述

游戏在一个 $n \times m \times w$ 的立体方格图上进行, 从北到南依次标号为第 $1$ 行到 第 $n$ 行, 从西到东依次标号为第 $1$ 列到第 $m$ 列, 从下到上依次标号为第 $1$ 层到 第 $w$ 层。

小蓝要控制自己的角色从第 $1$ 行第 $1$ 列第 $1$ 层移动到第 $n$ 行第 $m$ 列第 $w$ 层。每一步, 他可以向东走质数格、向南走质数格或者向上走质数格。每走到 一个位置, 小蓝的角色要稍作停留。

在游戏中有两个陷阱, 分别为第 $r_{1}$ 行第 $c_{1}$ 列第 $h_{1}$ 层和第 $r_{2}$ 行第 $c_{2}$ 列第 $h_{2}$ 层。这两个陷阱的位置可以跨过, 但不能停留。也就是说, 小蓝不能控制角 色某一步正好走到陷阱上，但是某一步中间跨过了陷阱是允许的。

小蓝最近比较清闲, 因此他想用不同的走法来完成这个游戏。所谓两个走法不同, 是指小蓝稍作停留的位置集合不同。

请帮小蓝计算一下，他总共有多少种不同的走法。

提示：请注意内存限制, 如果你的程序运行时超过内存限制将不得分。
## 输入格式

输入第一行包含两个整数 $n, m, w$, 表示方格图的大小。

第二行包含 $6$ 个整数, $r_{1}, c_{1}, h_{1}, r_{2}, c_{2}, h_{2}$ ，表示陷阱的位置。
## 输出格式

输出一行, 包含一个整数, 表示走法的数量。答案可能非常大, 请输出答 案除以 $1000000007$（即 $10^9+7$） 的余数。 
## 样例

### 样例输入 #1
```
5 6 1
3 4 1 1 2 1
```
### 样例输出 #1
```
11
```
## 提示

**【样例说明】**

用 $(r, c, h)$ 表示第 $r$ 行第 $c$ 列第 $h$ 层, 可能的走法有以下几种:

1. $(1,1,1)-(1,3,1)-(1,6,1)-(3,6,1)-(5,6,1)$ 。

2. $(1,1,1)-(1,3,1)-(3,3,1)-(3,6,1)-(5,6,1)$ 。

3. $(1,1,1)-(1,3,1)-(3,3,1)-(5,3,1)-(5,6,1)$ 。

4. $(1,1,1)-(3,1,1)-(3,3,1)-(3,6,1)-(5,6,1)$ 。

5. $(1,1,1)-(3,1,1)-(3,3,1)-(5,3,1)-(5,6,1)$ 。

6. $(1,1,1)-(3,1,1)-(5,1,1)-(5,3,1)-(5,6,1)$ 。

7. $(1,1,1)-(3,1,1)-(5,1,1)-(5,4,1)-(5,6,1)$ 。

8. $(1,1,1)-(1,4,1)-(1,6,1)-(3,6,1)-(5,6,1)$ 。

9. $(1,1,1)-(1,6,1)-(3,6,1)-(5,6,1)$ 。

10. $(1,1,1)-(3,1,1)-(3,6,1)-(5,6,1)$ 。

11. $(1,1,1)-(3,1,1)-(5,1,1)-(5,6,1)$ 。

**【评测用例规模与约定】**

对于 $30 \%$ 的评测用例 $1 \leq n, m, w \leq 50$ 。

对于 $60 \%$ 的评测用例 $1 \leq n, m, w \leq 300$ 。

对于所有评测用例, $1 \leq n, m, w \leq 1000,1 \leq r_{1}, r_{2} \leq n, 1 \leq c_{1}, c_{2} \leq m$, $1 \leq h_{1}, h_{2} \leq w$, 陷阱不在起点或终点, 两个陷阱不同。

蓝桥杯 2020 年国赛 B 组 J 题。


---

---
title: "[蓝桥杯 2021 国 AB] 翻转括号序列"
layout: "post"
diff: 提高+/省选-
pid: P8765
tag: ['线段树', '二分', '2021', '蓝桥杯国赛']
---
# [蓝桥杯 2021 国 AB] 翻转括号序列
## 题目描述

给定一个长度为 $n$ 的括号序列，要求支持两种操作:

1. 将 $\left[L_{i}, R_{i}\right]$ 区间内（序列中的第 $L_{i}$ 个字符到第 $R_{i}$ 个字符）的括号全部翻转(左括号变成右括号，右括号变成左括号)。

2. 求出以 $L_{i}$ 为左端点时，最长的合法括号序列对应的 $R_{i}$ （即找出最大的 $R_{i}$ 使 $\left[L_{i}, R_{i}\right]$ 是一个合法括号序列）。
## 输入格式

输入的第一行包含两个整数 $n, m$，分别表示括号序列长度和操作次数。

第二行包含给定的括号序列，括号序列中只包含左括号和右括号。

接下来 $m$ 行，每行描述一个操作。如果该行为 `1 L R`, 表示第一种操作，区间为 $\left[L, R\right]$；如果该行为 `2 L` 表示第二种操作，左端点为 $L$ 。
## 输出格式

对于每个第二种操作，输出一行，表示对应的 $R_{i}$。如果不存在这样的 $R_{i}$，请输出 $0$ 。
## 样例

### 样例输入 #1
```
7 5
((())()
2 3
2 2
1 3 5
2 3
2 1
```
### 样例输出 #1
```
4
7
0
0
```
## 提示

对于 $20 \%$ 的评测用例，$n, m \leq 5000$;

对于 $40 \%$ 的评测用例，$n, m \leq 30000$;

对于 $60 \%$ 的评测用例，$n, m \leq 100000$;

对于所有评测用例，$1 \leq n \leq 10^{6}, 1 \leq m \leq 2 \times 10^{5}$ 。 

蓝桥杯 2021 国赛 A 组 H 题（B 组 I 题）。


---

---
title: "[蓝桥杯 2021 国 AB] 异或三角"
layout: "post"
diff: 提高+/省选-
pid: P8766
tag: ['2021', '数位 DP', '位运算', '蓝桥杯国赛']
---
# [蓝桥杯 2021 国 AB] 异或三角
## 题目描述

给定 $T$ 个数 $n_{1}, n_{2}, \cdots, n_{T}$, 对每个 $n_{i}$ 请求出有多少组 $a, b, c$ 满足:

1. $1 \leq a, b, c \leq n_{i}$;

2. $a \oplus b \oplus c=0$ ，其中 $\oplus$ 表示二进制按位异或;

3. 长度为 $a, b, c$ 的三条边能组成一个三角形。
## 输入格式

输入的第一行包含一个整数 $T$ 。

接下来 $T$ 行每行一个整数, 分别表示 $n_{1}, n_{2}, \cdots, n_{T}$ 。
## 输出格式

输出 $T$ 行, 每行包含一个整数, 表示对应的答案。
## 样例

### 样例输入 #1
```
2
6
114514
```
### 样例输出 #1
```
6
11223848130
```
## 提示

对于 $10 \%$ 的评测用例, $T=1,1 \leq n_{i} \leq 200$; 对于 $20 \%$ 的评测用例, $T=1,1 \leq n_{i} \leq 2000$ ；

对于 $50 \%$ 的评测用例, $T=1,1 \leq n_{i} \leq 2^{20}$;

对于 $60 \%$ 的评测用例, $1 \leq T \leq 100000,1 \leq n_{i} \leq 2^{20}$;

对于所有评测用例, $1 \leq T \leq 100000,1 \leq n_{i} \leq 2^{30}$ 。 

蓝桥杯 2021 国赛 A 组 I 题（B 组 J 题）。


---

---
title: "[蓝桥杯 2021 国 A] 冰山"
layout: "post"
diff: 提高+/省选-
pid: P8767
tag: ['模拟', '堆', '2021', '蓝桥杯国赛']
---
# [蓝桥杯 2021 国 A] 冰山
## 题目描述

一片海域上有一些冰山，第 $i$ 座冰山的体积为 $V_{i}$ 。

随着气温的变化，冰山的体积可能增大或缩小。第 $i$ 天, 每座冰山的变化量都是 $X_{i}$。当 $X_{i}>0$ 时，所有冰山体积增加 $X_{i}$；当 $X_{i}<0$ 时，所有冰山体积减少 $-X_{i}$；当 $X_{i}=0$ 时，所有冰山体积不变。

如果第 $i$ 天某座冰山的体积变化后小于等于 $0$，则冰山会永远消失。

冰山有大小限制 $k$。如果第 $i$ 天某座冰山 $j$ 的体积变化后 $V_{j}$ 大于 $k$，则它会分裂成一个体积为 $k$ 的冰山和 $V_{j}-k$ 座体积为 $1$ 的冰山。

第 $i$ 天结束前（冰山增大、缩小、消失、分裂完成后），会漂来一座体积为 $Y_{i}$ 的冰山（$Y_{i}=0$ 表示没有冰山漂来）。

小蓝在连续的 $m$ 天对这片海域进行了观察，并准确记录了冰山的变化。小蓝想知道, 每天结束时所有冰山的体积之和（包括新漂来的）是多少。

由于答案可能很大，请输出答案除以 $998244353$ 的余数。
## 输入格式

输入的第一行包含三个整数 $n, m, k$, 分别表示初始时冰山的数量、观察的 天数以及冰山的大小限制。

第二行包含 $n$ 个整数 $V_{1}, V_{2}, \cdots, V_{n}$，表示初始时每座冰山的体积。

接下来 $m$ 行描述观察的 $m$ 天的冰山变化。其中第 $i$ 行包含两个整数 $X_{i}, Y_{i}$，意义如前所述。
## 输出格式

输出 $m$ 行，每行包含一个整数，分别对应每天结束时所有冰山的体积之和除以 $998244353$ 的余数。 
## 样例

### 样例输入 #1
```
1 3 6
1
6 1
2 2
-1 1
```
### 样例输出 #1
```
8
16
11
```
## 提示

**【样例说明】**

在本样例说明中, 用 $\left[a_{1}, a_{2}, \cdots, a_{n}\right]$ 来表示每座冰山的体积。

初始时的冰山为 [1]。

第 $1$ 天结束时，有 $3$ 座冰山： $[1,1,6]$ 。

第 $2$ 天结束时，有 $6$ 座冰山： $[1,1,2,3,3,6]$ 。

第 $3$ 天结束时，有 $5$ 座冰山： $[1,1,2,2,5]$ 。

**【评测用例规模与约定】**

对于 $40 \%$ 的评测用例, $n, m, k \leq 2000$;

对于 $60 \%$ 的评测用例, $n, m, k \leq 20000$;

对于所有评测用例, $1 \leq n, m \leq 10^5,1 \leq k \leq 10^{9}, 1 \leq V_{i} \leq k, 0 \leq Y_{i} \leq k$, $-k \leq X_{i} \leq k$ 。 

蓝桥杯 2021 国赛 A 组 G 题。


---

---
title: "[蓝桥杯 2022 国 AC] 替换字符"
layout: "post"
diff: 提高+/省选-
pid: P8796
tag: ['平衡树', '2022', '蓝桥杯国赛', '线段树合并']
---
# [蓝桥杯 2022 国 AC] 替换字符
## 题目描述

给定一个仅含小写英文字母的字符串 $s$，每次操作选择一个区间 $[l_i,r_i]$ 将 $s$ 的该区间中的所有字母 $x_i$ 全部替换成字母 $y_i$，问所有操作做完后，得到的字符串是什么。
## 输入格式

输入的第一行包含一个字符串 $s$。

第二行包含一个整数 $m$。

接下来 $m$ 行，每行包含 $4$ 个参数 $l_i,r_i,x_i,y_i$，相邻两个参数之间用一个空格分隔，其中 $l_i,r_i$ 为整数，$x_i, y_i$ 为小写字母。
## 输出格式

输出一行包含一个字符串表示答案。
## 样例

### 样例输入 #1
```
abcaaea
4
1 7 c e
3 3 e b
3 6 b e
1 4 a c
```
### 样例输出 #1
```
cbecaea

```
## 提示

**【评测用例规模与约定】**

- 对于 $40\%$ 的评测用例，$|s|, m \leq 5000$；
- 对于所有评测用例，$1 \leq |s|, m \leq 10^5$，$1 \leq l_i \leq r_i \leq |s|$，$x_i\neq y_i$，其中 $|s|$ 表示字符串 $s$ 的长度。

蓝桥杯 2022 国赛 A 组 H 题（C 组 J 题）。


---

---
title: "[蓝桥杯 2022 国 A] 三角序列"
layout: "post"
diff: 提高+/省选-
pid: P8797
tag: ['莫队', '2022', '可持久化线段树', '分块', '蓝桥杯国赛']
---
# [蓝桥杯 2022 国 A] 三角序列
## 题目背景

感谢 [Lotuses](https://www.luogu.com.cn/user/414231) 提供的数据
## 题目描述

给定 $n$ 组成对的数 $a_i, b_i$，每组数表示一个 $a_i$ 行 $a_i$ 列的如图所示的三角形：

![](https://cdn.luogu.com.cn/upload/image_hosting/hp3n8ozb.png)

其中 $b_i$ 为 $0$ 时左边较低，为 $1$ 时右边较低。

将每组数对应的三角按数的顺序从左到右拼接起来。

现给出 $m$ 组询问 $l_i, r_i, v_i$，对每组询问求最低高度 $h_i$ 使得 $l_i$ 到 $r_i$ 列之间的高度在 $h_i$ 以内的 $o$ 的数量大于等于 $v_i$。
## 输入格式

输入的第一行包含两个整数 $n, m$，用一个空格分隔。

接下来 $n$ 行，每行包含两个整数 $a_i, b_i$，用一个空格分隔。

接下来 $m$ 行，每行包含三个整数 $l_i,r_i,v_i$，相邻两个整数之间用一个空格分隔。
## 输出格式

输出一行包含一个字符串表示答案。
## 样例

### 样例输入 #1
```
6 6
3 0
4 0
2 1
3 1
5 0
1 1
3 9 12
3 9 13
3 4 4
14 16 7
9 15 12
1 18 42
```
### 样例输出 #1
```
2
3
3
3
3
-1
```
## 提示

**【样例说明】**

第一个询问对应的范围如图所示

![](https://cdn.luogu.com.cn/upload/image_hosting/iu9yky3i.png)

**【评测用例规模与约定】**

- 对于 $30\%$ 的评测用例，$1 \leq n, m, a_i \leq 500$；
- 对于 $50\%$ 的评测用例，$1 \leq n, m, a_i \leq 5000$；
- 对于所有评测用例，$1 \leq n, m \leq 2\times10^5$，$1 \leq a_i \leq 10^6$，$0 \leq b_i \leq 1$，$1 \leq l_i \leq r_i \leq \sum a_i$，$1 \leq v_i \leq 10^{18}$。

蓝桥杯 2022 国赛 A 组 I 题。


---

---
title: "[蓝桥杯 2022 国 A] 括号序列树"
layout: "post"
diff: 提高+/省选-
pid: P8798
tag: ['2022', '蓝桥杯国赛']
---
# [蓝桥杯 2022 国 A] 括号序列树
## 题目描述

有一棵二叉树，根结点上有一个空字符串，每个点的左儿子上的字符串为其父亲结点的字符串尾部额外加一个左括号，右儿子则是在尾部加一个右括号。树中的每个叶子结点上的字符串都分别和每个由 $n$ 对括号组成的合法括号序列一一对应。

给定 $n$，求此时这棵树的最大匹配所含的边数。
## 输入格式

输入一行包含一个整数 $n$。
## 输出格式

输出一行包含一个整数表示满足条件的序列的数量，答案可能很大，请输出答案除以 $998244353$ 的余数。
## 样例

### 样例输入 #1
```
9
```
### 样例输出 #1
```
10350
```
## 提示

**【评测用例规模与约定】**

- 对于 $20\%$ 的评测用例，$n \leq 10$；
- 对于 $40\%$ 的评测用例，$n \leq 300$；
- 对于 $60\%$ 的评测用例，$n \leq 5000$；
- 对于 $85\%$ 的评测用例，$n \leq 10^5$；
- 对于所有评测用例，$1 \leq n \leq 10^6$。

蓝桥杯 2022 国赛 A 组 J 题。


---

---
title: "[蓝桥杯 2023 国 B] 拼数字"
layout: "post"
diff: 提高+/省选-
pid: P9427
tag: ['2023', '蓝桥杯国赛']
---
# [蓝桥杯 2023 国 B] 拼数字
## 题目描述

小蓝要用 $N$ 个数字 $2$ 和 $M$ 个数字 $3$ 拼出一个 $N + M$ 位的整数。请你计算小蓝能拼出的最大的 $2023$ 的倍数是多少？
## 输入格式

两个整数 $N$ 和 $M$。
## 输出格式

一个 $N + M$ 位的整数，代表答案。如果拼不出 $2023$ 的倍数，输出 $-1$。
## 样例

### 样例输入 #1
```
2 8
```
### 样例输出 #1
```
2233333333
```
## 提示

### 评测用例规模与约定

 - 对于 $20\%$ 的数据，$1 \le N, M \le 12$。
 - 对于 $40\%$ 的数据，$1 \le N, M \le 100$。
 - 对于 $60\%$ 的数据，$1 \le N, M \le 10000$。
 - 对于 $100\%$ 的数据，$1 \le N, M \le 1000000$。
 
第十四届蓝桥杯大赛软件赛决赛 C/C++ 大学 B 组 I 题


---


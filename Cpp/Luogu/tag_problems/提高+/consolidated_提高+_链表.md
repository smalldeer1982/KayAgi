---
title: "「Cfz Round 3」Circle"
layout: "post"
diff: 提高+/省选-
pid: P10034
tag: ['动态规划 DP', '图论', '洛谷原创', 'Special Judge', 'O2优化', '背包 DP', '素数判断,质数,筛法', '构造', '洛谷月赛', '链表']
---
# 「Cfz Round 3」Circle
## 题目描述

给定一个长度为 $n$ 的 $\tt{01}$ 串 $S$ 和一个非负整数 $l$。

我们定义，对于一个 $1\sim n$ 的排列 $t$ 和非负整数 $k$：

$$f_{t,k}(i)=\begin{cases}i & k=0\\f_{t,k-1}(t_i) & k \neq 0\end{cases}$$

你需要构造一个 $1\sim n$ 的排列 $p$，满足：

- 对于任意一个不大于 $n$ 的正整数 $i$，都满足 $p_i \neq i$；
- 若 $S_i$ 为 $\tt1$，则 $f_{p,l}(i)=i$（若 $S_i$ 为 $\tt0$ 则没有限制）；

或报告无解。

其中，$1\sim n$ 的排列指满足所有不大于 $n$ 的正整数恰好出现一次的序列。
## 输入格式

**本题有多组测试数据。**

第一行输入一个整数 $T$，表示测试数据组数。

接下来依次输入每组测试数据。对于每组测试数据：

- 第一行输入两个整数 $n,l$。
- 第二行输入一个长度为 $n$ 的 $\tt{01}$ 串表示 $S$。
## 输出格式

对于每组数据，输出一行：

- 若存在满足条件的排列 $p$，则输出用空格分隔的 $n$ 个整数，表示你构造的排列 $p$；
- 若不存在满足条件的排列 $p$，则输出 $-1$。

**所有满足要求的输出均可通过。**
## 样例

### 样例输入 #1
```
4
5 3
10011
4 5
1000
5 6
11111
9 6
011111011
```
### 样例输出 #1
```
4 3 2 5 1
-1
5 4 2 3 1
3 1 2 6 4 5 9 7 8
```
## 提示

#### 「样例解释 #1」

对于第 $1$ 组数据，$f_{p,3}(1)=f_{p,2}(4)=f_{p,1}(5)=f_{p,0}(1)=1$，其余数同理，所以 $p$ 为 $\{4,3,2,5,1\}$ 时满足条件。

对于第 $2$ 组数据，可以证明不存在满足条件的排列 $p$。

对于第 $3$ 组数据，$\{2,1,4,5,3\}$ 等也为满足条件的排列 $p$。

#### 「数据范围」

设 $\sum n$ 表示单个测试点中 $n$ 的和。

对于所有数据，$1 \le T \le 100$，$2 \le n \le 5\times 10^5$，$0 \le l \le 10^{18}$，$\sum n \le 5\times 10^5$，保证 $S$ 中只包含 $\tt{0}$ 和 $\tt{1}$。

**只有你通过本题的所有测试点，你才能获得本题的分数。**


---

---
title: "[ROIR 2022] 礼物 (Day 2)"
layout: "post"
diff: 提高+/省选-
pid: P10093
tag: ['2022', 'Special Judge', '前缀和', 'ST 表', '链表', 'ROIR（俄罗斯）']
---
# [ROIR 2022] 礼物 (Day 2)
## 题目背景

翻译自 [ROIR 2022 D2T4](https://neerc.ifmo.ru/school/archive/2021-2022/ru-olymp-regional-2022-day2.pdf)。

圣诞老人让沃瓦选择一个礼物。

在沃瓦面前有 $n$ 个礼物排成一行。每个礼物给沃瓦带来的快乐程度值用一个整数表示，第 $i$ 个礼物的值为 $a_i$。快乐程度可以是正数、负数或零。

圣诞老人让沃瓦选择两个整数 $l$ 和 $r$，满足 $1 \le l \le r \le n$。沃瓦需要选择从 $l$ 到 $r$ 之间的所有礼物。然而，在所选的礼物中，沃瓦必须把具有前 $k$ 大快乐程度值的 $k$ 个礼物给他的妹妹玛莎。
## 题目描述

帮助沃瓦选择 $l$ 和 $r$，使得 $1 \le l \le r \le n,r - l + 1 \ge k$，并且他得到的礼物的总快乐程度最大化（不包括给妹妹的礼物）。
## 输入格式

第一行输入两个整数 $n$ 和 $k$，表示放在沃瓦面前的礼物数量和需要给玛莎的礼物数量。

第二行输入 $n$ 个整数，用空格分隔，第 $i$ 个数 $a_i$ 表示每个礼物带来的快乐程度。
## 输出格式

输出一个整数，表示沃瓦所选择的礼物的总快乐程度，不包括给玛莎的礼物。
## 样例

### 样例输入 #1
```
5 0
2 -4 5 -1 7
```
### 样例输出 #1
```
11
```
### 样例输入 #2
```
5 1
2 -4 5 -1 7
```
### 样例输出 #2
```
4
```
### 样例输入 #3
```
5 2
2 -4 5 -1 7
```
### 样例输出 #3
```
0
```
## 提示

在样例 $1$ 中，沃瓦不需要给玛莎任何礼物，因此他将选择 $l = 3, r = 5$，并且所选礼物的总快乐程度为 $5 + (−1) + 7 = 11$。

在样例 $2$ 中，沃瓦将需要将带来最大快乐程度的礼物给玛莎。然后，他仍然会选择 $l = 3, r = 5$，但总共的快乐程度是 $5 + (−1) = 4$。

在样例 $3$ 中，沃瓦需要给玛莎快乐值前二大的礼物。这种情况下，不难发现实际上沃瓦最好的选择方式是只选择两个礼物，然后全部给妹妹玛莎。一个最佳选择是选择 $l = 1, r = 2$。此时总快乐程度为 $0$。

本题使用捆绑测试。

| 子任务 | 分值 | 特殊性质 |
| :----------: | :----------: | :----------: |
| $1$ | $7$ | $n\le200$ |
| $2$ | $8$ | $n\le1000$ |
| $3$ | $10$ | $n\le6000$ |
| $4$ | $8$ | $k=0$ |
| $5$ | $14$ | $k=1$ |
| $6$ | $39$ | $n\le80000$ |
| $7$ | $14$ | 无 |

对于 $100\%$ 的数据，$1 \le n \le 200000, 0 \le k \le \min(100, n),−10^9 \le a_i \le 10^9$。


---

---
title: "[COTS 2019] 序列操作 K-ti"
layout: "post"
diff: 提高+/省选-
pid: P11221
tag: ['2019', '分块', 'COCI（克罗地亚）', '链表', '根号分治']
---
# [COTS 2019] 序列操作 K-ti
## 题目背景

译自 [Izborne Pripreme 2019 (Croatian IOI/CEOI Team Selection)](https://hsin.hr/pripreme2019/) D1T1。$\texttt{2s,0.5G}$。

## 题目描述

给定长度为 $N$ 的正整数序列 $a_0,a_1,\cdots,a_{N-1}$ 和正整数 $k$。注意是 $\texttt{0-index}$。

进行 $N$ 次操作，将 $a$ 删空。对于每次操作：

- 设当前 $a$ 的长度为 $n$。
- 令 $S=\{0,k,2k,\cdots,k\lfloor\frac{n-1}{k}\rfloor\}$。找到 $v=\max_{i\in S}a_i$。
- 令 $p$ 为 $\min_{i\in S,a_i=v} i$。
- 删去 $a_p$。后面的元素顺次前移一位。

求出每次操作删去的数。
## 输入格式

第一行，两个正整数 $N,k$。

第二行，$N$ 个正整数描述 $a$。
## 输出格式

输出 $N$ 行，每行一个整数，即每次操作删去的数。
## 样例

### 样例输入 #1
```
10 2
2 3 1 9 10 4 5 6 1 5
```
### 样例输出 #1
```
10
6
4
5
2
9
3
5
1
1
```
### 样例输入 #2
```
10 3
2 3 1 9 10 4 5 6 1 5
```
### 样例输出 #2
```
9
10
4
5
6
2
5
3
1
1
```
## 提示




对于 $100\%$ 的数据，保证：

- $2\le k\le N\le 10^5$；
- $1\le a_i\le N$。


| 子任务编号 | $N\le $ |  $k$   | 得分 |  
| :--: | :--: | :--: | :--: |  
| $ 1 $    | $ 1\, 000 $    |  $\le N$  | $ 7 $   |  
| $ 2 $    | $ 10^5 $   |  $=2$ | $ 25 $   |  
| $ 3 $    | $ 10^5$ | $\le 10$ | $ 23 $   |  
| $ 4 $    | $ 10^5$ | $\ge 100$ | $ 25 $   |  
| $ 5 $    | $ 10^5$  |  $\le N$ | $ 20 $   |  



---

---
title: "[EPXLQ2024 fall round] 好排列"
layout: "post"
diff: 提高+/省选-
pid: P11413
tag: ['模拟', '堆', '优先队列', '链表']
---
# [EPXLQ2024 fall round] 好排列
## 题目背景

温昭雪喜欢构造排列。
## 题目描述

她的目标是构造一个由 $n$ 个数组成的排列 $A_1,A_2,\dots,A_n$，初始时 $A$ 中的所有元素都是 $0$。

接下来，对于数 $i$（$1 \le i \le n$），她通过下面方式由 $1$ 到 $n$ 确定其位置：

- 如果 $i=1$，将其放到最左侧。

- 如果 $i=2$，将其放到最右侧。

- 如果都不是，定义 $f_0(x)$ 表示 $x$ 左侧（包含 $x$，下同）的连续的 $0$ 的个数，$g_0(x)$ 为 $x$ 右侧的连续的 $0$ 的个数。特别地，如果 $x \le 0$ 或 $x > n$，$f_0(x)=g_0(x)=n+1$。
- 定义 $f_1(x)$ 表示 $x$ 左侧的连续非 $0$ 位置的个数，$g_1(x)$ 表示 $x$ 右侧的连续非 $0$ 位置的个数。特别地，如果 $x \le 0$ 或 $x > n$，$f_0(x)=g_0(x)=0$。
- 如果存在位置 $j$，使得 $\min(f_0(j), g_0(j)) > 1$，则选择位置 $j$ 最大化 $\min(f_0(j), g_0(j))$。如果有多个位置的值相同，选择 $j$ 较小的。
- 如果不存在这样的位置，则选择位置 $j$ 使得 $f_0(j)=1$ 并最小化 $f_1(j-1) + g_1(j+1)$。如果有多个位置的值相同，选择 $j$ 较小的。

温昭雪的幸运数字是 $k$。为了避免输出过多，她只想知道数字 $k$ 处于排列的什么位置。
## 输入格式

**本题单个测试点内有多组测试数据。**

输入第一行 $T$，表示数据组数。

以下 $T$ 行，每行两个正整数 $n,k$。
## 输出格式

输出 $T$ 行，每行一个正整数 $x$，表示排列长度为 $n$ 时，$A_x=k$。
## 样例

### 样例输入 #1
```
2
3 1
6 4
```
### 样例输出 #1
```
1
4

```
## 提示

### 样例解释

第一组测试数据对应的排列为 $\{1,3,2\}$。

第二组测试数据对应的排列为 $\{1,5,3,4,6,2\}$。

### 数据规模与约定


| 测试点编号 | $n$ | $k$ | $T$ | $\sum n$ | 特殊性质 |
|:-:|:-:|:-:|:-:|:-:|:-:|
| $1,2$ | $\le 10$ | $\le 10$ | $\le 10$ | $\le 100$ | |
| $3,4$ | $\le 100$ | $\le 100$ | $\le 10$ | $\le 1000$ | |
| $5$ | $\le 1000$ | $\le 10$ | $\le 10$ | $\le 10^4$ | |
| $6,7$ | $\le 1000$ | $\le 1000$ | $\le 100$ | $\le 10^5$ |
| $8,9$ | $\le 10^4$ | $\le 10$ | $\le 100$ | $\le 10^5$ |
| $10 \sim 13$ | $\le 10^4$ | $\le 10^4$ | $\le 100$ | $\le 10^6$  | $n,k$ 均为奇数 |
| $14 \sim 17$ | $\le 10^4$ | $\le 10^4$ | $\le 100$ | $\le 10^6$ | $n,k$ 均为偶数 |
| $18,19$ | $\le 10^5$ | $\le 10$ | $\le 10$ | $\le 10^5$ | |
| $20,21$ | $\le 10^5$ | $\le 10^5$ | $\le 100$ | $\le 10^6$ | |
| $22\sim 25$ | $\le 10^6$ | $\le 10^6$ | $\le 100$ | $\le 10^6$ | |

对于奇数编号的测试点，内存限制为 $\text{512 MB}$；对于偶数编号的测试点，内存限制为 $\text{64 MB}$。

对于所有数据，保证 $1 \le k \le n \le 10^6, \sum n \le 10^6$。


---

---
title: "「EZEC-14」众数 II"
layout: "post"
diff: 提高+/省选-
pid: P9461
tag: ['洛谷原创', 'O2优化', '洛谷月赛', '链表', '单调栈']
---
# 「EZEC-14」众数 II
## 题目背景

dXqwq 是一个不可爱的男孩子。他在 NOI2022 中的众数一题定义了 $10^6$ 个 ``std::deque`` 并成功 MLE。
## 题目描述

给定一个长度为 $n$ 的序列 $a$，我们通过以下方式构造序列 $b$：

- 初始时 $b$ 为空序列。
- 对于 $i=1,2,\cdots,n$，我们依次向 $b$ 的尾部插入 $1,2,\cdots,a_i$。

dXqwq 定义一个序列的**最小众数**为所有出现次数最大的数的最小值。例如 $[1,1,4,5,1,4]$ 的最小众数为 $1$，而 $[1,14,5,14,19,19,8,10]$ 的最小众数为 $14$。

你需要求出 $b$ 的每个子区间的**最小众数**的和。由于答案可能很大，你只需要输出它对 $998244353$ 取模后的值。
## 输入格式

第一行输入一个整数 $n$。

第二行输入 $n$ 个整数 $a_i$。
## 输出格式

输出一个整数，代表 $b$ 的每个子区间的最小众数的和对 $998244353$ 取模的值。
## 样例

### 样例输入 #1
```
3
1 2 3
```
### 样例输出 #1
```
28
```
### 样例输入 #2
```
9
9 9 8 2 4 4 3 5 3
```
### 样例输出 #2
```
1912

```
## 提示

**【样例解释】**

在第一个样例中，$b=[1,1,2,1,2,3]$。

有 $15$ 个区间的最小众数为 $1$，$5$ 个区间的最小众数为 $2$，$1$ 个区间的最小众数为 $3$，因此答案为 $15\times 1+5\times 2+1\times 3=28$。

**【提示】**

开 $10^6$ 个 ``std::deque`` 在空间限制为 512MB 时一定会 MLE。

**【数据范围】**

**本题采用捆绑测试。**

- Subtask 1（10 pts）：$\sum a_i\leq 100$。
- Subtask 2（20 pts）：$\sum a_i\leq 10^3$。 
- Subtask 3（20 pts）：$\sum a_i\leq 10^6$。
- Subtask 4（10 pts）：$n\leq 2$。
- Subtask 5（20 pts）：$n\leq 10^3$。
- Subtask 6（10 pts）：$a_i\leq 2$。
- Subtask 7（10 pts）：无特殊限制。 

对于 $100\%$ 的数据，$1\leq n\leq 10^6$，$1\leq a_i\leq 10^6$。


---


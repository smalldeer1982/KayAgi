---
title: "[CSP-J2022 山东] 宴会"
layout: "post"
diff: 普及+/提高
pid: P11854
tag: ['贪心', '二分', '2022', '山东', 'CSP-J 入门级']
---
# [CSP-J2022 山东] 宴会
## 题目背景

受疫情影响，山东省取消了 CSP-J 2022 认证活动，并于次年三月重新命题，在省内补办比赛。
## 题目描述

今人不见古时月，今月曾经照古人。梦回长安，大唐风华，十里长安花，一日看尽。

唐长安城是当时世界上规模最大、建筑最宏伟、规划布局最为规范化的一座都城。其营建制度规划布局的特点是规模空前、创设皇城、三城层环、六坡利用、布局对称、街衢宽阔、坊
里齐整、形制划一、渠水纵横、绿荫蔽城、郊环祀坛。而所谓的十里长安街，位于长安城的中轴线上，即唐长安城的朱雀大街，又称承天门大街。唐朝官员们住在各个“坊”里，上朝下朝都需要通过朱雀大街。

为了保持各大家族的联系和友谊，各官员往往会每月办一次宴会。为了方便描述，我们把朱雀大街看成一个数轴，各官员所居住的“坊”缩略为数轴上的一个坐标点。大家决定选一处地点（该地点是数轴上的某一个点，不一定坐标点）办宴会。由于唐朝宵禁严格，大家又都希望交流时间尽可能长，因此想要使宴会开始时间尽可能早。又因为大唐注重礼仪，因此，参加宴会的官员会花一定时间盛装打扮过后才前往宴会地点（不一定是坐标点）。

更具体地，一条纵向的街道上（相当于一维坐标）有 $n$ 个人居住，其中第 $i$ 个人居住在 $x_{i}$ （非负整数）位置（坐标点）上。每月他们会选择在 $x_{0}$（数轴上的某一个点，不一定坐标点）出举办宴会。

已知第 $i$ 个人从 $x_{i}$ 出发前往宴会地点 $x_{0}$ 处需要花费 $\left|x_{i}-x_{0}\right|$ 的时间，另外，他还需要花费 $t_{i}$ 的时间进行打扮，换言之，他共需要花费 $\left|x_{i}-x_{0}\right|+t_{i}$ 的时间到达宴会举办处。

假设**初始时刻为 $0$**。这 $n$ 个人开始打扮和出发前往宴会处，他们想要使得宴会的开始时间尽可能早，于是向你求助，请你帮助他们确定好最优的宴会举办地点 $x_{0}$。

注：$\left|x_{i}-x_{0}\right|$ 表示 $x_{i}$ 与 $x_{0}$ 之差的绝对值，且题目中 $n$ 个人的居住地点坐标均为整数。
## 输入格式


第一行一个正整数 $T$，表示测试数据的组数。

接下来对于每组测试数据（注意：每组测试数据有 $3$ 行数据，以下共 $3\times T$ 行数据）：

第一行一个正整数 $n$，表示总官员人数。

第二行共 $n$ 个非负整数 $x_{1},x_{2},\dots,x_{n}$ 分别表示这 $n$ 个人在数轴上的坐标。

第三行共 $n$ 个非负整数 $t_{1},t_{2},\dots,t_{n}$  分别表示这 $n$ 个人出发前的打扮时间。
## 输出格式

共输出 $T$ 行数据，对于每组测试数据，输出一行一个**实数**（如果是整数按整数输出，如果有小数，保留 $1$ 位小数输出），表示使宴会开始时间最早的最优举办地点坐标 $x_{0}$。（很显然，$x_{0}$ 都是唯一的）
## 样例

### 样例输入 #1
```
7
1
0
3
2
3 1
0 0
2
1 4
0 0
3
1 2 3
0 0 0
3
1 2 3
4 1 2
3
3 3 3
5 3 3
6
5 4 7 2 10 4
3 2 5 1 4 6
```
### 样例输出 #1
```
0
2
2.5
2
1
3
6
```
## 提示

### 样例说明

初始时刻为 $0$。

对于第一组测试数据只有 $1$ 个人，坐标为 $0$，打扮时间为 $3$，很显然 $x_{0}$ 就定在坐标 $0$ 处，使得宴会开始时间为 $3$ 且最早。

对于第二组测试数据有 $2$ 个人，坐标分别为 $3$、$1$，打扮时间均为 $0$，很显然 $x_{0}$ 定在坐标 $2$ 处，使得宴会开始时间为 $1$ 且最早。

对于第三组测试数据有 $2$ 个人，坐标分别为 $1$、$4$，打扮时间均为 $0$，很显然 $x_{0}$ 定在坐标 $2.5$ 处，使得宴会开始时间为 $1.5$ 且最早。

### 数据范围

对于 $30\%$ 的数据，$T=1,n\le100,0\le x_{i},t_{i}\le1000$；

对于 $60\%$ 的数据，$n\le10^{4},0\le x_{i},t_{i}\le10^{5}$；

对于 $100\%$ 的数据，$1\le T\le10^{3},n\le10^{5},0\le x_{i},t_{i}\le10^{8}$，且保证所有测试数据的 $n$ 加起来不超过 $2\times10^{5}$。



---

---
title: "[CSP-J2019] 纪念品"
layout: "post"
diff: 普及+/提高
pid: P5662
tag: ['动态规划 DP', '2019', '背包 DP', 'CSP-J 入门级']
---
# [CSP-J2019] 纪念品
## 题目描述

小伟突然获得一种超能力，他知道未来 $T$ 天 $N$ 种纪念品每天的价格。某个纪念品的价格是指购买一个该纪念品所需的金币数量，以及卖出一个该纪念品换回的金币数量。

每天，小伟可以进行以下两种交易**无限次**：
1. 任选一个纪念品，若手上有足够金币，以当日价格购买该纪念品；
2. 卖出持有的任意一个纪念品，以当日价格换回金币。

每天卖出纪念品换回的金币可以**立即**用于购买纪念品，当日购买的纪念品也可以**当日卖出**换回金币。当然，一直持有纪念品也是可以的。

$T$ 天之后，小伟的超能力消失。因此他一定会在第 $T$ 天卖出**所有**纪念品换回金币。

小伟现在有 $M$ 枚金币，他想要在超能力消失后拥有尽可能多的金币。 
 
## 输入格式

第一行包含三个正整数 $T, N, M$，相邻两数之间以一个空格分开，分别代表未来天数 $T$，纪念品数量 $N$，小伟现在拥有的金币数量 $M$。

接下来 $T$ 行，每行包含 $N$ 个正整数，相邻两数之间以一个空格分隔。第 $i$ 行的 $N$ 个正整数分别为 $P_{i,1},P_{i,2},\dots,P_{i,N}$，其中 $P_{i,j}$ 表示第 $i$ 天第 $j$ 种纪念品的价格。
## 输出格式

输出仅一行，包含一个正整数，表示小伟在超能力消失后最多能拥有的金币数量。
 
## 样例

### 样例输入 #1
```
6 1 100
50
20
25
20
25
50
```
### 样例输出 #1
```
305
```
### 样例输入 #2
```
3 3 100
10 20 15
15 17 13
15 25 16
```
### 样例输出 #2
```
217
```
## 提示

**样例 1 说明**

最佳策略是：

第二天花光所有 $100$ 枚金币买入 $5$ 个纪念品 $1$；

第三天卖出 $5$ 个纪念品 $1$，获得金币 $125$ 枚；

第四天买入 $6$ 个纪念品 $1$，剩余 $5$ 枚金币；

第六天必须卖出所有纪念品换回 $300$ 枚金币，第四天剩余 $5$ 枚金币，共 $305$ 枚金币。

超能力消失后，小伟最多拥有 $305$ 枚金币。

**样例 2 说明**

最佳策略是：

第一天花光所有金币买入 $10$ 个纪念品 $1$；

第二天卖出全部纪念品 $1$ 得到 $150$ 枚金币并买入 $8$ 个纪念品 $2$ 和 $1$ 个纪念品 $3$，剩余 $1$ 枚金币；

第三天必须卖出所有纪念品换回 $216$ 枚金币，第二天剩余 $1$ 枚金币，共 $217$ 枚金币。

超能力消失后，小伟最多拥有 $217$ 枚金币。


**数据规模与约定**

对于 $10\%$ 的数据，$T = 1$。

对于 $30\%$ 的数据，$T \leq 4, N \leq 4, M \leq 100$，所有价格 $10 \leq P_{i,j} \leq 100$。

另有 $15\%$ 的数据，$T \leq 100, N = 1$。

另有 $15\%$ 的数据，$T = 2, N \leq 100$。

对于 $100\%$ 的数据，$T \leq 100, N \leq 100, M \leq 10^3$，所有价格 $1 \leq P_{i,j} \leq 10^4$，数据保证任意时刻，小伟手上的金币数不可能超过 $10^4$。


---

---
title: "[CSP-J2019] 加工零件"
layout: "post"
diff: 普及+/提高
pid: P5663
tag: ['2019', '最短路', 'CSP-J 入门级']
---
# [CSP-J2019] 加工零件
## 题目描述

凯凯的工厂正在有条不紊地生产一种神奇的零件，神奇的零件的生产过程自然也很神奇。工厂里有 $n$ 位工人，工人们从 $1 \sim n$ 编号。某些工人之间存在双向的零件传送带。保证每两名工人之间最多只存在一条传送带。

如果 $x$ 号工人想生产一个被加工到第 $L\,(L \gt 1)$ 阶段的零件，则**所有**与 $x$ 号工人有传送带**直接**相连的工人，都需要生产一个被加工到第 $L - 1$ 阶段的零件（但 $x$ 号工人自己**无需**生产第 $L - 1$ 阶段的零件）。

如果 $x$ 号工人想生产一个被加工到第 $1$ 阶段的零件，则**所有**与 $x$ 号工人有传送带**直接**相连的工人，都需要为 $x$ 号工人提供一个原材料。

轩轩是 $1$ 号工人。现在给出 $q$ 张工单，第 $i$ 张工单表示编号为 $a_i$ 的工人想生产一个第 $L_i$ 阶段的零件。轩轩想知道对于每张工单，他是否需要给别人提供原材料。他知道聪明的你一定可以帮他计算出来！
## 输入格式

第一行三个正整数 $n$，$m$ 和 $q$，分别表示工人的数目、传送带的数目和工单的数目。

接下来 $m$ 行，每行两个正整数 $u$ 和 $v$，表示编号为 $u$ 和 $v$ 的工人之间存在一条零件传输带。保证 $u \neq v$。

接下来 $q$ 行，每行两个正整数 $a$ 和 $L$，表示编号为 $a$ 的工人想生产一个第 $L$ 阶段的零件。 
## 输出格式

共 $q$ 行，每行一个字符串 `Yes` 或者 `No`。如果按照第 $i$ 张工单生产，需要编号为 1 的轩轩提供原材料，则在第 $i$ 行输出 `Yes`；否则在第 $i$ 行输出 `No`。注意输出**不含**引号。
## 样例

### 样例输入 #1
```
3 2 6
1 2
2 3
1 1
2 1
3 1
1 2
2 2
3 2
```
### 样例输出 #1
```
No
Yes
No
Yes
No
Yes
```
### 样例输入 #2
```
5 5 5
1 2
2 3
3 4
4 5
1 5
1 1
1 2
1 3
1 4
1 5
```
### 样例输出 #2
```
No
Yes
No
Yes
Yes
```
## 提示

**样例 1 说明**

![](https://cdn.luogu.com.cn/upload/image_hosting/5dbepjmh.png)

编号为 1 的工人想生产第 1 阶段的零件，需要编号为 2 的工人提供原材料。

编号为 2 的工人想生产第 1 阶段的零件，需要编号为 1 和 3 的工人提供原材料。

编号为 3 的工人想生产第 1 阶段的零件，需要编号为 2 的工人提供原材料。

编号为 1 的工人想生产第 2 阶段的零件，需要编号为 2 的工人生产第 1 阶段的零 件，需要编号为 1 和 3 的工人提供原材料。

编号为 2 的工人想生产第 2 阶段的零件，需要编号为 1 和 3 的工人生产第 1 阶段的零件，他/她们都需要编号为 2 的工人提供原材料。

编号为 3 的工人想生产第 2 阶段的零件，需要编号为 2 的工人生产第 1 阶段的零件，需要编号为 1 和 3 的工人提供原材料。

**样例 2 说明**

![](https://cdn.luogu.com.cn/upload/image_hosting/tfom5z2s.png)

编号为 1 的工人想生产第 1 阶段的零件，需要编号为 2 和 5 的工人提供原材料。

编号为 1 的工人想生产第 2 阶段的零件，需要编号为 2 和 5 的工人生产第 1 阶段的零件，需要编号为 1,3,4 的工人提供原材料。

编号为 1 的工人想生产第 3 阶段的零件，需要编号为 2 和 5 的工人生产第 2 阶段的零件，需要编号为 1,3,4 的工人生产第 1 阶段的零件，需要编号为 2,3,4,5 的工人提供原材料。

编号为 1 的工人想生产第 4 阶段的零件，需要编号为 2 和 5 的工人生产第 3 阶段的零件，需要编号为 1,3,4 的工人生产第 2 阶段的零件，需要编号为 2,3,4,5 的工人生产第 1 阶段的零件，需要全部工人提供原材料。

编号为 1 的工人想生产第 5 阶段的零件，需要编号为 2 和 5 的工人生产第 4 阶段的零件，需要编号为 1,3,4 的工人生产第 3 阶段的零件，需要编号为 2,3,4,5 的工人生产第 2 阶段的零件，需要全部工人生产第 1 阶段的零件，需要全部工人提供原材料。

**数据规模与约定**

共 $20$ 个测试点。

对所有测试点保证 $1 \leq u, v, a \leq n$。

测试点 $1\sim4$，$1 \leq n, m \leq 1000$，$q = 3$，$L = 1$。

测试点 $5\sim8$，$1 \leq n, m \leq 1000$，$q = 3$，$1 \leq L \leq 10$。

测试点 $9\sim12$，$1 \leq n, m, L \leq 1000$，$1 \leq q \leq 100$。

测试点 $13\sim16$，$1 \leq n, m, L \leq 1000$，$1 \leq q \leq 10^5$。

测试点 $17\sim20$，$1 \leq n, m, q \leq 10^5$，$1 \leq L \leq 10^9$。


---

---
title: "[CSP-J2019 江西] 道路拆除"
layout: "post"
diff: 普及+/提高
pid: P5683
tag: ['2019', 'CSP-J 入门级']
---
# [CSP-J2019 江西] 道路拆除
## 题目描述

A 国有 $n$ 座城市，从 $1 \sim n$ 编号。$1$ 号城市是 A 国的首都。城市间由 $m$ 条双向道路连通，通过每一条道路所花费的时间均为 $1$ 单位时间。  

现在 A 国打算拆除一些不实用的道路以减小维护的开支，但 A 国也需要保证主要线路不受影响。因此 A 国希望道路拆除完毕后，利用剩余未被拆除的道路，从 A 国首都出发，能到达 $s_1$ 号与 $s_2$ 号城市，且所要花费的最短时间分别不超过 $t_1$ 与 $t_2$（注意这是两个独立的条件，互相之间没有关联，即不需要先到 $s_1$ 再到 $s_2$）。

A 国想请你帮他们算算，在满足上述条件的情况下，他们最多能拆除多少条道路。 若上述条件永远无法满足，则输出 $-1$。
## 输入格式

第一行两个正整数 $n,m$，表示城市数与道路数。  

接下来 $m$ 行，每行两个正整数 $x,y$，表示一条连接 $x$ 号点与 $y$ 号点的道路。

最后一行四个整数，分别为 $s_1,t_1,s_2,t_2$。
## 输出格式

仅一行一个整数，表示答案。
## 样例

### 样例输入 #1
```
5 6
1 2
2 3
1 3
3 4
4 5
3 5
5 3 4 3
```
### 样例输出 #1
```
3
```
### 样例输入 #2
```
3 2
1 2
2 3
2 2 3 1
```
### 样例输出 #2
```
-1
```
## 提示

【数据范围】  
对于 $30\%$ 的数据，$n,m \le 15$；   
另有 $20\%$ 的数据，$n \le 100$，$m = n-1$；   
另有 $30\%$ 的数据，$s_1 = s_2$；  
对于 $100\%$ 的数据，$2 \le n,m \le 3000$，$1\le x,y \le n$，$2 \le s_1,s_2 \le n$，$0 \le t_1,t_2 \le n$。  

【样例 $1$ 解释】  
拆除 $(1,2),(2,3),(3,4)$ 三条边。  
注意：不需要令首都与除了 $s_1,s_2$ 外的点在拆除之后依然连通。

【样例 $2$ 解释】  
即使一条边都不拆除，首都到 $3$ 号点的最短时间也都达到了 $2$ 单位时间。

testdata by @DYH060310 


---

---
title: "[CSP-J2019 江西] 非回文串"
layout: "post"
diff: 普及+/提高
pid: P5684
tag: ['数学', '2019', '组合数学', 'CSP-J 入门级']
---
# [CSP-J2019 江西] 非回文串
## 题目描述

Alice 有 $n$ 个字符，它们都是英文小写字母，从 $1 \sim n$ 编号，分别为 $c_1,c_2, \dots , c_n$。  
Bob 准备将这些字符重新排列，组成一个字符串 $S$。Bob 知道 Alice 有强迫症，所以他打算将 $S$ 组成一个非回文串来折磨 Alice。  

现在 Bob 想知道他共有多少种不同的排列字符的方案，能使得 $S$ 是个非回文串。一种排列字符的方案指的是一个 $1 \sim n$ 的排列 $p_i$，它所组成的 $S = c_{p_1}c_{p_2} \dots c_{p_n}$。

一个字符串是非回文串，当且仅当它的逆序串与原串不同。例如 `abcda` 的逆序串为 `adcba`，与原串不同，故 `abcda` 是非回文串。而 `abcba` 的逆序串与原串相同，是回文串。

由于最后的结果可能很大，你只需要告诉 Bob 总方案数对 $10^9+7$ 取模后的值。
## 输入格式

第一行一个正整数 $n$ 表示字符个数。   
第二行 $n$ 个英文小写字母 $c_i$。
## 输出格式

仅一行一个整数表示答案。答案对 $10^9+7$ 取模。
## 样例

### 样例输入 #1
```
3
aba
```
### 样例输出 #1
```
4
```
### 样例输入 #2
```
8
aabbbbcc
```
### 样例输出 #2
```
39168
```
## 提示

【数据范围】  
对于 $20\%$ 的数据，$n \le 8$；  
对于 $50\%$ 的数据，$n \le 20$；  
另有 $30\%$ 的数据，字符只包含 `a` 和 `b`；  
对于 $100\%$ 的数据，$3 \le n \le 2000$。


---

---
title: "[CSP-J2020] 表达式"
layout: "post"
diff: 普及+/提高
pid: P7073
tag: ['树形数据结构', '2020', 'CSP-J 入门级']
---
# [CSP-J2020] 表达式
## 题目描述

小 C 热衷于学习数理逻辑。有一天，他发现了一种特别的逻辑表达式。在这种逻辑表达式中，所有操作数都是变量，且它们的取值只能为 $0$ 或 $1$，运算从左往右进行。如果表达式中有括号，则先计算括号内的子表达式的值。特别的，这种表达式有且仅有以下几种运算：
1. 与运算：`a & b`。当且仅当 $a$ 和 $b$ 的值都为 $1$ 时，该表达式的值为 $1$。其余情况该表达式的值为 $0$。
2. 或运算：`a | b`。当且仅当 $a$ 和 $b$ 的值都为 $0$ 时，该表达式的值为 $0$。其余情况该表达式的值为 $1$。
3. 取反运算：`!a`。当且仅当 $a$ 的值为 $0$ 时，该表达式的值为 $1$。其余情况该表达式的值为 $0$。

小 C 想知道，给定一个逻辑表达式和其中每一个操作数的初始取值后，再取反某一个操作数的值时，原表达式的值为多少。

为了化简对表达式的处理，我们有如下约定：

表达式将采用**后缀表达式**的方式输入。

后缀表达式的定义如下：
1. 如果 $E$ 是一个操作数，则 $E$ 的后缀表达式是它本身。
2. 如果 $E$ 是 $E_1~\texttt{op}~E_2$ 形式的表达式，其中 $\texttt{op}$ 是任何二元操作符，且优先级不高于 $E_1$ 、$E_2$ 中括号外的操作符，则 $E$ 的后缀式为 $E_1' E_2' \texttt{op}$，其中 $E_1'$ 、$E_2'$ 分别为 $E_1$、$E_2$ 的后缀式。
3. 如果 $E$ 是 $E_1$ 形式的表达式，则 $E_1$ 的后缀式就是 $E$ 的后缀式。

同时为了方便，输入中：

1. 与运算符（&）、或运算符（|）、取反运算符（！）的左右**均有一个空格**，但**表达式末尾没有空格**。
2. 操作数由小写字母 $x$ 与一个正整数拼接而成，正整数表示这个变量的下标。例如：`x10`，表示下标为 $10$ 的变量 $x_{10}$。数据保证**每个变量在表达式中出现恰好一次**。
## 输入格式

第一行包含一个字符串 $s$，表示上文描述的表达式。  
第二行包含一个正整数 $n$，表示表达式中变量的数量。表达式中变量的下标为 $1,2, \cdots , n$。  
第三行包含 $n$ 个整数，第 $i$ 个整数表示变量 $x_i$ 的初值。  
第四行包含一个正整数 $q$，表示询问的个数。  
接下来 $q$ 行，每行一个正整数，表示需要取反的变量的下标。注意，每一个询问的修改都是**临时的**，即之前询问中的修改不会对后续的询问造成影响。  
数据保证输入的表达式合法。变量的初值为 $0$ 或 $1$。
## 输出格式

输出一共有 $q$ 行，每行一个 $0$ 或 $1$，表示该询问下表达式的值。
## 样例

### 样例输入 #1
```
x1 x2 & x3 |
3
1 0 1
3
1
2
3

```
### 样例输出 #1
```
1
1
0
```
### 样例输入 #2
```
x1 ! x2 x4 | x3 x5 ! & & ! &
5
0 1 0 1 1
3
1
3
5

```
### 样例输出 #2
```
0
1
1

```
## 提示

### 样例 1 解释


该后缀表达式的中缀表达式形式为 $(x_1 \operatorname{and} x_2) \operatorname{or} x_3$。

- 对于第一次询问，将 $x_1$ 的值取反。此时，三个操作数对应的赋值依次为 $0$，$0$，$1$。原表达式的值为 $(0\&0)|1=1$。
- 对于第二次询问，将 $x_2$ 的值取反。此时，三个操作数对应的赋值依次为 $1$，$1$，$1$。原表达式的值为 $(1\&1)|1=1$。
- 对于第三次询问，将 $x_3$ 的值取反。此时，三个操作数对应的赋值依次为 $1$，$0$，$0$。原表达式的值为 $(1\&0)|0=0$。

### 样例 2 解释


该表达式的中缀表达式形式为 $(\operatorname{not}x_1)\operatorname{and}(\operatorname{not}((x_2\operatorname{or}x_4)\operatorname{and}(x_3\operatorname{and}(\operatorname{not}x_5))))$。

### 数据规模与约定

- 对于 $20\%$ 的数据，表达式中有且仅有与运算（&）或者或运算（|）。
- 对于另外 $30\%$ 的数据，$|s| \le 1000$，$q \le 1000$，$n \le 1000$。
- 对于另外 $20\%$ 的数据，变量的初值全为 $0$ 或全为 $1$。
- 对于 $100\%$ 的数据，$1 \le |s| \le 1 \times 10^6$，$1 \le q \le 1 \times 10^5$，$2 \le n \le 1 \times 10^5$。

其中，$|s|$ 表示字符串 $s$ 的长度。


---

---
title: "[CSP-J2020] 方格取数"
layout: "post"
diff: 普及+/提高
pid: P7074
tag: ['动态规划 DP', '2020', 'CSP-J 入门级']
---
# [CSP-J2020] 方格取数
## 题目描述

设有 $n \times m$ 的方格图，每个方格中都有一个整数。现有一只小熊，想从图的左上角走到右下角，每一步只能向上、向下或向右走一格，并且不能重复经过已经走过的方格，也不能走出边界。小熊会取走所有经过的方格中的整数，求它能取到的整数之和的最大值。
## 输入格式

第一行有两个整数 $n, m$。

接下来 $n$ 行每行 $m$ 个整数，依次代表每个方格中的整数。
## 输出格式

一个整数，表示小熊能取到的整数之和的最大值。
## 样例

### 样例输入 #1
```
3 4
1 -1 3 2
2 -1 4 -1
-2 2 -3 -1

```
### 样例输出 #1
```
9
```
### 样例输入 #2
```
2 5
-1 -1 -3 -2 -7
-2 -1 -4 -1 -2

```
### 样例输出 #2
```
-10
```
## 提示

### 样例 1 解释

![](https://cdn.luogu.com.cn/upload/image_hosting/sq4638pa.png)
---

### 样例 2 解释

![](https://cdn.luogu.com.cn/upload/image_hosting/7tfdyabk.png)
---

### 数据规模与约定
- 对于 $20\%$ 的数据，$n, m \le 5$。
- 对于 $40\%$ 的数据，$n, m \le 50$。
- 对于 $70\%$ 的数据，$n, m \le 300$。
- 对于 $100\%$ 的数据，$1 \le n,m \le 10^3$。方格中整数的绝对值不超过 $10^4$。



------------
2024/2/4 添加一组 hack 数据。


---

---
title: "[CSP-J 2021] 小熊的果篮"
layout: "post"
diff: 普及+/提高
pid: P7912
tag: ['2021', 'O2优化', '枚举', 'CSP-J 入门级']
---
# [CSP-J 2021] 小熊的果篮
## 题目描述

小熊的水果店里摆放着一排 $n$ 个水果。每个水果只可能是苹果或桔子，从左到右依次用正整数 $1, 2, \ldots, n$ 编号。连续排在一起的同一种水果称为一个“块”。小熊要把这一排水果挑到若干个果篮里，具体方法是：每次都把每一个“块”中最左边的水果同时挑出，组成一个果篮。重复这一操作，直至水果用完。注意，每次挑完一个果篮后，“块”可能会发生变化。比如两个苹果“块”之间的唯一桔子被挑走后，两个苹果“块”就变成了一个“块”。请帮小熊计算每个果篮里包含的水果。
## 输入格式

第一行，包含一个正整数 $n$，表示水果的数量。

第二行，包含 $n$ 个空格分隔的整数，其中第 $i$ 个数表示编号为 $i$ 的水果的种类，$1$ 代表苹果，$0$ 代表桔子。
## 输出格式

输出若干行。

第 $i$ 行表示第 $i$ 次挑出的水果组成的果篮。从小到大排序输出该果篮中所有水果的编号，每两个编号之间用一个空格分隔。
## 样例

### 样例输入 #1
```
12
1 1 0 0 1 1 1 0 1 1 0 0

```
### 样例输出 #1
```
1 3 5 8 9 11
2 4 6 12
7
10

```
### 样例输入 #2
```
20
1 1 1 1 0 0 0 1 1 1 0 0 1 0 1 1 0 0 0 0

```
### 样例输出 #2
```
1 5 8 11 13 14 15 17
2 6 9 12 16 18
3 7 10 19
4 20

```
### 样例输入 #3
```
见附件中的 fruit/fruit3.in。
```
### 样例输出 #3
```
见附件中的 fruit/fruit3.ans。
```
## 提示

**【样例解释 #1】**

这是第一组数据的样例说明。

所有水果一开始的情况是 $[1, 1, 0, 0, 1, 1, 1, 0, 1, 1, 0, 0]$，一共有 $6$ 个块。

在第一次挑水果组成果篮的过程中，编号为 $1, 3, 5, 8, 9, 11$ 的水果被挑了出来。

之后剩下的水果是 $[1, 0, 1, 1, 1, 0]$，一共 $4$ 个块。

在第二次挑水果组成果篮的过程中，编号为 $2, 4, 6, 12$ 的水果被挑了出来。

之后剩下的水果是 $[1, 1]$，只有 $1$ 个块。

在第三次挑水果组成果篮的过程中，编号为 $7$ 的水果被挑了出来。

最后剩下的水果是 $[1]$，只有 $1$ 个块。

在第四次挑水果组成果篮的过程中，编号为 $10$ 的水果被挑了出来。

**【数据范围】**

对于 $10 \%$ 的数据，$n \le 5$。  
对于 $30 \%$ 的数据，$n \le 1000$。  
对于 $70 \%$ 的数据，$n \le 50000$。  
对于 $100 \%$ 的数据，$1 \le n \le 2 \times {10}^5$。

**【提示】**

由于数据规模较大，建议 C/C++ 选手使用 `scanf` 和 `printf` 语句输入、输出。


---

---
title: "[CSP-J 2022] 逻辑表达式"
layout: "post"
diff: 普及+/提高
pid: P8815
tag: ['模拟', '2022', 'O2优化', '栈', 'CSP-J 入门级']
---
# [CSP-J 2022] 逻辑表达式
## 题目描述

逻辑表达式是计算机科学中的重要概念和工具，包含逻辑值、逻辑运算、逻辑运算优先级等内容。

在一个逻辑表达式中，元素的值只有两种可能：$0$（表示假）和 $1$（表示真）。元素之间有多种可能的逻辑运算，本题中只需考虑如下两种：“与”（符号为 `&`）和“或”（符号为 `|`）。其运算规则如下：

$0 \mathbin{\&} 0 = 0 \mathbin{\&} 1 = 1 \mathbin{\&} 0 = 0$，$1 \mathbin{\&} 1 = 1$；  
$0 \mathbin{|} 0 = 0$，$0 \mathbin{|} 1 = 1 \mathbin{|} 0 = 1 \mathbin{|} 1 = 1$。

在一个逻辑表达式中还可能有括号。规定在运算时，括号内的部分先运算；两种运算并列时，`&` 运算优先于 `|` 运算；同种运算并列时，从左向右运算。

比如，表达式 `0|1&0` 的运算顺序等同于 `0|(1&0)`；表达式 `0&1&0|1` 的运算顺序等同于 `((0&1)&0)|1`。

此外，在 C++ 等语言的有些编译器中，对逻辑表达式的计算会采用一种“短路”的策略：在形如 `a&b` 的逻辑表达式中，会先计算 `a` 部分的值，如果 $a = 0$，那么整个逻辑表达式的值就一定为 $0$，故无需再计算 `b` 部分的值；同理，在形如 `a|b` 的逻辑表达式中，会先计算 `a` 部分的值，如果 $a = 1$，那么整个逻辑表达式的值就一定为 $1$，无需再计算 `b` 部分的值。

现在给你一个逻辑表达式，你需要计算出它的值，并且统计出在计算过程中，两种类型的“短路”各出现了多少次。需要注意的是，如果某处“短路”包含在更外层被“短路”的部分内则不被统计，如表达式 `1|(0&1)` 中，尽管 `0&1` 是一处“短路”，但由于外层的 `1|(0&1)` 本身就是一处“短路”，无需再计算 `0&1` 部分的值，因此不应当把这里的 `0&1` 计入一处“短路”。
## 输入格式

输入共一行，一个非空字符串 $s$ 表示待计算的逻辑表达式。
## 输出格式

输出共两行，第一行输出一个字符 `0` 或 `1`，表示这个逻辑表达式的值；第二行输出两个非负整数，分别表示计算上述逻辑表达式的过程中，形如 `a&b` 和 `a|b` 的“短路”各出现了多少次。
## 样例

### 样例输入 #1
```
0&(1|0)|(1|1|1&0)

```
### 样例输出 #1
```
1
1 2

```
### 样例输入 #2
```
(0|1&0|1|1|(1|1))&(0&1&(1|0)|0|1|0)&0

```
### 样例输出 #2
```
0
2 3

```
## 提示

**【样例解释 \#1】**

该逻辑表达式的计算过程如下，每一行的注释表示上一行计算的过程：

```plain
0&(1|0)|(1|1|1&0)
=(0&(1|0))|((1|1)|(1&0)) //用括号标明计算顺序
=0|((1|1)|(1&0))   //先计算最左侧的 &，是一次形如 a&b 的“短路”
=0|(1|(1&0))       //再计算中间的 |，是一次形如 a|b 的“短路”
=0|1               //再计算中间的 |，是一次形如 a|b 的“短路”
=1
```

**【样例 \#3】**

见附件中的 `expr/expr3.in` 与 `expr/expr3.ans`。

**【样例 \#4】**

见附件中的 `expr/expr4.in` 与 `expr/expr4.ans`。

**【数据范围】**

设 $\lvert s \rvert$ 为字符串 $s$ 的长度。

对于所有数据，$1 \le \lvert s \rvert \le {10}^6$。保证 $s$ 中仅含有字符 `0`、`1`、`&`、`|`、`(`、`)` 且是一个符合规范的逻辑表达式。保证输入字符串的开头、中间和结尾均无额外的空格。保证 $s$
中没有重复的括号嵌套（即没有形如 `((a))` 形式的子串，其中 `a` 是符合规范的逻辑表
达式）。

| 测试点编号 | $\lvert s \rvert \le$ | 特殊条件 |
|:-:|:-:|:-:|
| $1 \sim 2$ | $3$ | 无 |
| $3 \sim 4$ | $5$ | 无 |
| $5$ | $2000$ | 1 |
| $6$ | $2000$ | 2 |
| $7$ | $2000$ | 3 |
| $8 \sim 10$ | $2000$ | 无 |
| $11 \sim 12$ | ${10}^6$ | 1 |
| $13 \sim 14$ | ${10}^6$ | 2 |
| $15 \sim 17$ | ${10}^6$ | 3 |
| $18 \sim 20$ | ${10}^6$ | 无 |

其中：  
特殊性质 1 为：保证 $s$ 中没有字符 `&`。  
特殊性质 2 为：保证 $s$ 中没有字符 `|`。  
特殊性质 3 为：保证 $s$ 中没有字符 `(` 和 `)`。

**【提示】**

以下给出一个“符合规范的逻辑表达式”的形式化定义：

- 字符串 `0` 和 `1` 是符合规范的；
- 如果字符串 `s` 是符合规范的，且 `s` 不是形如 `(t)` 的字符串（其中 `t` 是符合规范的），那么字符串 `(s)` 也是符合规范的；
- 如果字符串 `a` 和 `b` 均是符合规范的，那么字符串 `a&b`、`a|b` 均是符合规范的；
- 所有符合规范的逻辑表达式均可由以上方法生成。


---

---
title: "[CSP-J 2023] 旅游巴士"
layout: "post"
diff: 普及+/提高
pid: P9751
tag: ['2023', 'O2优化', 'CSP-J 入门级']
---
# [CSP-J 2023] 旅游巴士
## 题目描述

小 Z 打算在国庆假期期间搭乘旅游巴士去一处他向往已久的景点旅游。

旅游景点的地图共有 $n$ 处地点，在这些地点之间连有 $m$ 条道路。其中 $1$ 号地点为景区入口，$n$ 号地点为景区出口。我们把一天当中景区开门营业的时间记为 $0$ 时刻，则从 $0$ 时刻起，每间隔 $k$ 单位时间便有一辆旅游巴士到达景区入口，同时有一辆旅游巴士从景区出口驶离景区。

所有道路均只能**单向通行**。对于每条道路，游客步行通过的用时均为恰好 $1$ 单位时间。

小 Z 希望乘坐旅游巴士到达景区入口，并沿着自己选择的任意路径走到景区出口，再乘坐旅游巴士离开，这意味着他到达和离开景区的时间都必须是 **$k$ 的非负整数倍**。由于节假日客流众多，**小 Z 在旅游巴士离开景区前只想一直沿着景区道路移动，而不想在任何地点（包括景区入口和出口）或者道路上停留**。

出发前，小 Z 忽然得知：景区采取了限制客流的方法，对于每条道路均设置了一个
“开放时间”$a _ i$，游客只有**不早于 $a _ i$ 时刻**才能通过这条道路。

请帮助小 Z 设计一个旅游方案，使得他乘坐旅游巴士离开景区的时间尽量地早。
## 输入格式

输入的第一行包含 3 个正整数 $n, m, k$，表示旅游景点的地点数、道路数，以及旅游巴士的发车间隔。

输入的接下来 $m$ 行，每行包含 3 个非负整数 $u _ i, v _ i, a_ i$，表示第 $i$ 条道路从地点 $u _ i$ 出发，到达地点 $v _ i$，道路的“开放时间”为 $a _ i$。
## 输出格式

输出一行，仅包含一个整数，表示小 Z 最早乘坐旅游巴士离开景区的时刻。如果不存在符合要求的旅游方案，输出 `-1`。
## 样例

### 样例输入 #1
```
5 5 3
1 2 0
2 5 1
1 3 0
3 4 3
4 5 1
```
### 样例输出 #1
```
6
```
## 提示

**【样例 #1 解释】**

小 Z 可以在 $3$ 时刻到达景区入口，沿 $1 \to 3 \to 4 \to 5$ 的顺序走到景区出口，并在 $6$ 时刻离开。

**【样例 #2】**

见附件中的 `bus/bus2.in` 与 `bus/bus2.ans`。

**【数据范围】**

对于所有测试数据有：$2 \leq n \leq 10 ^ 4$，$1 \leq m \leq 2 \times 10 ^ 4$，$1 \leq k \leq 100$，$1 \leq u _ i, v _ i \leq n$，$0 \leq a _ i \leq 10 ^ 6$。

| 测试点编号 | $n \leq$ | $m \leq$ | $k \leq$ | 特殊性质 |
|:-:|:-:|:-:|:-:|:-:|
| $1 \sim 2$ | $10$ |$15$ | $100$ | $a _ i = 0$ |
| $3 \sim 5$ | $10$ | $15$ | $100$ | 无 |
| $6 \sim 7$ | $10 ^ 4$ | $2 \times 10 ^ 4$ | $1$ | $a _ i = 0$ |
| $8 \sim 10$ | $10 ^ 4$ | $2 \times 10 ^ 4$ | $1$ | 无 |
| $11 \sim 13$ | $10 ^ 4$ | $2 \times 10 ^ 4$ | $100$ | $a _ i = 0$ |
| $14 \sim 15$ | $10 ^ 4$ | $2 \times 10 ^ 4$ | $100$ | $u _ i \leq v _ i$ |
| $16 \sim 20$ | $10 ^ 4$ | $2 \times 10 ^ 4$ | $100$ | 无 |


---


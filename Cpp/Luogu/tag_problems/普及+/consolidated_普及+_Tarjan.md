---
title: "[蓝桥杯青少年组国赛 2024] 第四题"
layout: "post"
diff: 普及+/提高
pid: B4309
tag: ['2024', 'Tarjan', '双连通分量', '蓝桥杯青少年组']
---
# [蓝桥杯青少年组国赛 2024] 第四题
## 题目描述

一张棋盘由 $n$ 行 $m$ 列的网格矩阵组成，每个网格中最多放一颗棋子。当前棋盘上已有若干棋子。所有水平方向或竖直方向上相邻的棋子属于同一连通块。

现给定棋盘上所有棋子的位置，如果要使棋盘上出现两个及以上的棋子连通块，请问最少需要移除几颗棋子？如果无论怎么移除棋子都无法满足要求，则输出 $-1$。（注：只能通过移除棋子的操作来使棋盘上出现两个及以上的棋子连通块。）
## 输入格式

本题每个测试点包含多组测试数据：
- 第一行包含一个整数 $T$（$1 \leq T \leq 50$），表示数据组数。
- 接下来 $T$ 组数据，每组数据包含：
  - 第一行输入两个整数 $n$ 和 $m$（$1 \leq n, m \leq 60$），分别表示棋盘的行数和列数，整数之间以一个空格隔开。
  - 接下来 $n$ 行，每行输入 $m$ 个大写字符（字符为 `G` 或 `L`），分别表示每个网格的情况。`G` 表示有棋子，`L` 表示无棋子，字符之间以一个空格隔开。
## 输出格式

输出 $T$ 行，每行一个整数。第 $i$ 行的整数表示第 $i$ 组数据中最少需要移除多少颗棋子才能使棋盘上出现两个及以上的棋子连通块；如果无论怎么移除棋子都无法满足要求，则输出 $-1$。
## 样例

### 样例输入 #1
```
2
3 3
L G G
L G G
L L L
4 4
L L L L
L G L L
L G L L
L L L L
```
### 样例输出 #1
```
2
-1
```


---

---
title: "「LAOI-6」Yet Another Graph Coloration Problem"
layout: "post"
diff: 普及+/提高
pid: P11022
tag: ['图论', '洛谷原创', 'Special Judge', 'O2优化', '深度优先搜索 DFS', '拓扑排序', 'Tarjan', '双连通分量', '构造', '洛谷月赛', '圆方树']
---
# 「LAOI-6」Yet Another Graph Coloration Problem
## 题目背景

[English statement](https://www.luogu.com.cn/problem/U477166). You must submit your code at the Chinese version of the statement.
## 题目描述

小 R 有一张 $n$ 个节点和 $m$ 条的边简单无向图，节点的编号依次为 $1 \sim n$。她想要为图中的每个节点分配黑色或白色的颜色，使得：

- 有至少 $1$ 个黑色节点；
- 有至少 $1$ 个白色节点；
- 对于任何一对点对 $(u, v)$，只要 $u$ 和 $v$ 的颜色不同，就存在至少 $2$ 条从 $u$ 到 $v$ 的不同的简单路径。
	- 简单路径是图上指不重复经过同一点的路径。
	- 若两条简单路径不同，要么其长度不同，要么至少存在一个正整数 $i$ 使两条路径经过的第 $i$ 个点不同。

或者，报告解不存在。
## 输入格式

**本题有多组数据。**

第一行，一个整数 $T$，表示数据组数。对于每组数据：

- 第一行，两个整数 $n, m$，表示图的节点数和边数。
- 接下来 $m$ 行，每行两个整数 $u, v$，表示有一条 $u, v$ 之间的边。

保证给出的图无重边、无自环。
## 输出格式

对于每组数据：

- 若有解，输出一行长为 $n$ 的字符串，第 $i$ 个字符为 `B` 表示 $i$ 号节点为黑色，为 `W` 表示 $i$ 号节点为白色；
- 若无解，仅输出一行一个整数 $-1$。

如果有多种合法的解，你只需要输出任意一种即可。
## 样例

### 样例输入 #1
```
3
4 5
1 2
1 3
1 4
2 3
3 4
5 6
1 2
1 3
1 5
2 3
2 4
3 4
6 10
1 2
1 3
1 5
2 3
2 4
2 5
2 6
3 5
3 6
4 6
```
### 样例输出 #1
```
BWBW
BBWWB
BWBWBW
```
### 样例输入 #2
```
1
4 3
1 2
1 3
2 3
```
### 样例输出 #2
```
-1
```
## 提示

**本题采用捆绑测试**。

- Subtask 0（15 pts）：$\sum 2^n \leq 2^{16}$。
- Subtask 1（25 pts）：$n \leq 3\times 10^3$，$m \leq 3\times 10^3$，$\sum n \leq 10^4$，$\sum m \leq 2\times 10^4$。
- Subtask 2（5 pts）：保证图不连通。
- Subtask 3（10 pts）：保证每个点的度数均为 $2$。
- Subtask 4（20 pts）：保证 $n = m$。
- Subtask 5（25 pts）：无特殊限制。

对于所有数据，保证 $1 \leq T \leq 10^5$，$2 \leq n \leq 2 \times 10^5$，$0 \leq m \leq 2 \times 10^5$，$\sum n \leq 2\times 10^6$，$\sum m \leq 2\times 10^6$，保证给出的图无重边、无自环。


---

---
title: "[POI 2018 R2] 自行车道 Bike paths"
layout: "post"
diff: 普及+/提高
pid: P12760
tag: ['2018', 'POI（波兰）', '强连通分量', 'Tarjan']
---
# [POI 2018 R2] 自行车道 Bike paths
## 题目背景

翻译来自于 [LibreOJ](https://loj.ac/p/5068)。
## 题目描述

**题目译自 [XXV Olimpiada Informatyczna — II etap](https://sio2.mimuw.edu.pl/c/oi25-2/dashboard/) [Drogi rowerowe](https://szkopul.edu.pl/problemset/problem/aKKSmtjWTtDOEHDqnmQ3-eAA/statement/)**

拜托城国王 Bajtazar 倾听民意，决定将部分预算盈余用于修建自行车道。皇家道路顾问已设计了一套单向自行车道网络，连接各路口，但经国王要求进行了多次修改。网络由连接路口 $u$ 到 $v$ 的单向路段组成。从路口 $u$ 到 $v$ 的路径定义为任意一串不同路口序列 $u=v_0, v_1, \ldots, v_k=v$，其中每对连续路口 $v_i, v_{i+1}$ $(0 \leq i < k)$ 由从 $v_i$ 到 $v_{i+1}$ 的路段连接。

国王要求网络「公平」，即满足：若从路口 $v$ 无法到达路口 $u$（不存在从 $v$ 到 $u$ 的路径），则从 $u$ 到 $v$ 至多只有一条路径。国王认为，这能避免路口 $v$ 的居民嫉妒路口 $u$ 的居民。

市民自行车委员会获取了这一公平网络的设计，却对此不满，认为它不便于城市出行。他们需提交报告，急需确凿数据。你需计算网络的通达度，即对于每个路口 $v$，计算从 $v$ 可达的路口数量。
## 输入格式

第一行包含两个整数 $n, m$ $(n \geq 2, m \geq 1)$，分别表示拜托城的路口数量和路段数量，路口编号为 $1$ 至 $n$。

接下来的 $m$ 行描述网络，每行包含两个整数 $a, b$ $(1 \leq a, b \leq n, a \neq b)$，表示存在从路口 $a$ 到 $b$ 的单向路段。每对有序对 $(a, b)$ 至多出现一次，保证网络公平。
## 输出格式

输出 $n$ 行，第 $i$ 行包含一个整数，表示从路口 $i$ 可达的路口数量。
## 样例

### 样例输入 #1
```
7 7
1 4
1 6
4 2
6 2
2 1
5 3
3 7
```
### 样例输出 #1
```
3
3
1
3
2
3
0
```
## 提示

**样例 1 解释**

![](https://cdn.luogu.com.cn/upload/image_hosting/hvqu1a0f.png)

**附加样例**

1. $n=25, m=600$，每路口到其他路口均有路段。
2. $n=55, m=54$，含孤立路口及长度 $2$ 至 $10$ 的独立环。
3. $n=50000, m=49999$，所有路口在一条路径上。
4. $n=50000, m=50000$，所有路口在一个环上。

详细子任务附加限制及分值如下表所示。

| 子任务 | 附加限制 | 分值 |
| :---: | :--: | :---: |
| $1$    | $n \leq 60$              | $12$ |
| $2$    | $n, m \leq 5000$         | $8$  |
| $3$    | $n \leq 50000, m \leq 100000$，若 $u > v$，则无从 $u$ 到 $v$ 的路径 | $18$ |
| $4$    | $n \leq 50000, m \leq 100000$，若从 $u$ 可达 $v$，则 $v$ 不可达 $u$ | $18$ |
| $5$    | $n \leq 50000, m \leq 100000$ | $44$ |


---

---
title: "[USACO03FALL / HAOI2006] 受欢迎的牛 G"
layout: "post"
diff: 普及+/提高
pid: P2341
tag: ['图论', '2003', '2006', '河南', 'USACO', '各省省选', '强连通分量', 'Tarjan', '栈']
---
# [USACO03FALL / HAOI2006] 受欢迎的牛 G
## 题目背景

本题测试数据已修复。
## 题目描述

每头奶牛都梦想成为牛棚里的明星。被所有奶牛喜欢的奶牛就是一头明星奶牛。所有奶牛都是自恋狂，每头奶牛总是喜欢自己的。奶牛之间的“喜欢”是可以传递的——如果 $A$ 喜欢 $B$，$B$ 喜欢 $C$，那么 $A$ 也喜欢 $C$。牛栏里共有 $N$ 头奶牛，给定一些奶牛之间的爱慕关系，请你算出有多少头奶牛可以当明星。
## 输入格式

第一行：两个用空格分开的整数：$N$ 和 $M$。

接下来 $M$ 行：每行两个用空格分开的整数：$A$ 和 $B$，表示 $A$ 喜欢 $B$。

## 输出格式

一行单独一个整数，表示明星奶牛的数量。

## 样例

### 样例输入 #1
```
3 3
1 2
2 1
2 3
```
### 样例输出 #1
```
1
```
## 提示

只有 $3$ 号奶牛可以做明星。

【数据范围】

对于 $10\%$ 的数据，$N\le20$，$M\le50$。

对于 $30\%$ 的数据，$N\le10^3$，$M\le2\times 10^4$。

对于 $70\%$ 的数据，$N\le5\times 10^3$，$M\le5\times 10^4$。

对于 $100\%$ 的数据，$1\le N\le10^4$，$1\le M\le5\times 10^4$。


---

---
title: "[USACO5.3] 校园网Network of Schools"
layout: "post"
diff: 普及+/提高
pid: P2746
tag: ['2001', 'USACO', 'IOI', '强连通分量', 'Tarjan']
---
# [USACO5.3] 校园网Network of Schools
## 题目描述

一些学校连入一个电脑网络。那些学校已订立了协议：每个学校都会给其它的一些学校分发软件（称作“接受学校”）。注意即使 $B$ 在 $A$ 学校的分发列表中，$A$ 也不一定在 $B$ 学校的列表中。

你要写一个程序计算，根据协议，为了让网络中所有的学校都用上新软件，必须接受新软件副本的最少学校数目（子任务 A）。更进一步，我们想要确定通过给任意一个学校发送新软件，这个软件就会分发到网络中的所有学校。为了完成这个任务，我们可能必须扩展接收学校列表，使其加入新成员。计算最少需要增加几个扩展，使得不论我们给哪个学校发送新软件，它都会到达其余所有的学校（子任务 B）。一个扩展就是在一个学校的接收学校列表中引入一个新成员。
## 输入格式

输入文件的第一行包括一个正整数 $N$，表示网络中的学校数目。学校用前 $N$ 个正整数标识。

接下来 $N$ 行中每行都表示一个接收学校列表（分发列表），第 $i+1$ 行包括学校 $i$ 的接收学校的标识符。每个列表用 $0$ 结束，空列表只用一个 $0$ 表示。
## 输出格式

你的程序应该在输出文件中输出两行。

第一行应该包括一个正整数，表示子任务 A 的解。

第二行应该包括一个非负整数，表示子任务 B 的解。
## 样例

### 样例输入 #1
```
5
2 4 3 0
4 5 0
0
0
1 0
```
### 样例输出 #1
```
1
2
```
## 提示

$2 \le N \le 100$。

题目翻译来自NOCOW。

USACO Training Section 5.3



---

---
title: "[USACO06JAN] The Cow Prom S"
layout: "post"
diff: 普及+/提高
pid: P2863
tag: ['2006', 'USACO', '强连通分量', 'Tarjan']
---
# [USACO06JAN] The Cow Prom S
## 题目描述

有一个 $n$ 个点，$m$ 条边的有向图，请求出这个图点数大于 $1$ 的强连通分量个数。
## 输入格式

第一行为两个整数 $n$ 和 $m$。

第二行至 $m+1$ 行，每一行有两个整数 $a$ 和 $b$，表示有一条从 $a$ 到 $b$ 的有向边。
## 输出格式

仅一行，表示点数大于 $1$ 的强连通分量个数。
## 样例

### 样例输入 #1
```
5 4
2 4
3 5
1 2
4 1
```
### 样例输出 #1
```
1
```
## 提示

#### 数据规模与约定

对于全部的测试点，保证 $2\le n \le 10^4$，$2\le m\le 5\times 10^4$，$1 \leq a, b \leq n$。


---

---
title: "【模板】缩点"
layout: "post"
diff: 普及+/提高
pid: P3387
tag: ['图论', 'Tarjan']
---
# 【模板】缩点
## 题目描述

给定一个 $n$ 个点 $m$ 条边有向图，每个点有一个权值，求一条路径，使路径经过的点权值之和最大。你只需要求出这个权值和。

允许多次经过一条边或者一个点，但是，重复经过的点，权值只计算一次。

## 输入格式

第一行两个正整数 $n,m$

第二行 $n$ 个整数，其中第 $i$ 个数 $a_i$ 表示点 $i$ 的点权。

第三至 $m+2$ 行，每行两个整数 $u,v$，表示一条 $u\rightarrow v$ 的有向边。

## 输出格式

共一行，最大的点权之和。

## 样例

### 样例输入 #1
```
2 2
1 1
1 2
2 1
```
### 样例输出 #1
```
2
```
## 提示

对于 $100\%$ 的数据，$1\le n \le 10^4$，$1\le m \le 10^5$，$0\le a_i\le 10^3$。

- 2024-11-1 添加了 [hack 数据](https://www.luogu.com.cn/discuss/964940)；


---

---
title: "【模板】割点（割顶）"
layout: "post"
diff: 普及+/提高
pid: P3388
tag: ['Tarjan', '双连通分量']
---
# 【模板】割点（割顶）
## 题目背景

割点
## 题目描述

给出一个 $n$ 个点，$m$ 条边的无向图，求图的割点。

## 输入格式

第一行输入两个正整数 $n,m$。

下面 $m$ 行每行输入两个正整数 $x,y$ 表示 $x$ 到 $y$ 有一条边。

## 输出格式

第一行输出割点个数。

第二行按照节点编号从小到大输出节点，用空格隔开。

## 样例

### 样例输入 #1
```
6 7
1 2
1 3
1 4
2 5
3 5
4 5
5 6
```
### 样例输出 #1
```
1 
5
```
## 提示

对于全部数据，$1\leq n \le 2\times 10^4$，$1\leq m \le 1 \times 10^5$。

点的编号均大于 $0$ 小于等于 $n$。

**tarjan图不一定联通。**


---

---
title: "仓鼠找 sugar"
layout: "post"
diff: 普及+/提高
pid: P3398
tag: ['倍增', 'Tarjan', '最近公共祖先 LCA', '洛谷月赛']
---
# 仓鼠找 sugar
## 题目描述

小仓鼠的和他的基（mei）友（zi）sugar 住在地下洞穴中，每个节点的编号为 $1\sim n$。地下洞穴是一个树形结构。这一天小仓鼠打算从从他的卧室（$a$）到餐厅（$b$），而他的基友同时要从他的卧室（$c$）到图书馆（$d$）。他们都会走最短路径。现在小仓鼠希望知道，有没有可能在某个地方，可以碰到他的基友？


小仓鼠那么弱，还要天天被 zzq 大爷虐，请你快来救救他吧！

## 输入格式

第一行两个正整数 $n$ 和 $q$，表示这棵树节点的个数和询问的个数。

接下来 $n-1$ 行，每行两个正整数 $u$ 和 $v$，表示节点 $u$ 到节点 $v$ 之间有一条边。

接下来 $q$ 行，每行四个正整数 $a$、$b$、$c$ 和 $d$，表示节点编号，也就是一次询问，其意义如上。

## 输出格式

对于每个询问，如果有公共点，输出大写字母 `Y`；否则输出`N`。

## 样例

### 样例输入 #1
```
5 5
2 5
4 2
1 3
1 4
5 1 5 1
2 2 1 4
4 1 3 4
3 1 1 5
3 5 1 4
```
### 样例输出 #1
```
Y
N
Y
Y
Y
```
## 提示

**本题时限 1s，内存限制 128M，因新评测机速度较为接近 NOIP 评测机速度，请注意常数问题带来的影响。**


$20\%$ 的数据 $n, q\le200$。

$40\%$ 的数据 $n, q\le 2\times10^3$。

$70\%$ 的数据 $n, q\le 5\times10^4$。

$100\%$ 的数据 $1\le n, q\le10^5$。



---

---
title: "[GZOI2017] 小z玩游戏"
layout: "post"
diff: 普及+/提高
pid: P5676
tag: ['图论', '2017', '各省省选', 'O2优化', '贵州', 'Tarjan']
---
# [GZOI2017] 小z玩游戏
## 题目背景

GZOI2017 D1T2
## 题目描述

小 z 很无聊。

小 z 要玩游戏。

小 z 有 $N$ 个新游戏，第 $i$ 个游戏看上去的有趣程度为 $w_i$。

小 z 很挑，他只会玩看上去的有趣程度是自己兴奋程度整数倍的游戏。

由于游戏实际上有好玩的也有不好玩的，玩完第 $i$ 个游戏后，小 z 的兴奋程度会变为 $e_i$。

已知小 z 初始兴奋程度为 $1$，请问小 z 有多少个游戏可能会玩两次？
## 输入格式

第一行一个正整数 $T$，表示测试数据组数，最多 $10$ 组。

对于每组测试数据：

- 第一行一个正整数 $N$，表示游戏的个数。
- 第二行 $N$ 个正整数，第 $i$ 个数 $w_i$，表示第 $i$ 个游戏看上去的有趣程度为 $w_i$。
- 第三行 $N$ 个正整数，第 $i$ 个数 $e_i$，表示小 z 玩完第 $i$ 个游戏后，小 z 的兴奋程度会变为 $e_i$。
## 输出格式

共 $T$ 行。

每行一个正整数，表示对应测试数据，小 z 可能会玩两次的游戏数量。
## 样例

### 样例输入 #1
```
5
1
100000
100000
5
1 2 6 15 35
5 7 9 2 3
5
2 3 5 35 21
7 11 7 3 2
10
6 15 77 12 24 37 35 99 55 42
4 2 5 7 11 3 6 8 9 10
10
6540 5604 567 57065 60 670 6870 1230 465 6540
12 5 37 3 34 13 17 18 10 12
```
### 样例输出 #1
```
1
3
3
8
5
```
## 提示

### 样例 2 解释

数字代表游戏编号，箭头表示下一个。

- 情况 $1$：$2\to 5\to 4\to 2$；
- 情况 $2$：$5\to 4\to 2\to 5$；
- 情况 $3$：$4\to 2\to 5\to 4$。

所以小 z 可能玩 $2,4,5$ 两次。

小 z 无论如何都不能玩 $1$ 或 $3$ 两次。

### 数据范围及约定


![](https://cdn.luogu.com.cn/upload/image_hosting/s757wplh.png)


---

---
title: "「DAOI R1」Flame"
layout: "post"
diff: 普及+/提高
pid: P8287
tag: ['二分', '并查集', 'O2优化', '广度优先搜索 BFS', 'Tarjan']
---
# 「DAOI R1」Flame
## 题目背景

>尝尝天堂里的苹果有什么了不起，我要尝尝地狱里的苹果。
## 题目描述

黑暗里有黑色的火焰，只有目光敏锐的人才可以捕捉到,

借着这点卑微之光,走进地狱深处......

欢迎来到地狱的审判之地。

$ \texttt{hhpq.} $ 将 D 押入了地狱的审判之地，D 必须在业火之城成功生成一座业火监狱之前逃离，所以他想知道还有多少秒时间。

在这座业火之城中，共有 $n$ 个祭坛，共有 $m$ 条可以蔓延火苗的业火之路，且业火之路是双向连通。

已知在这一座业火之城共有 $k$ 个火种已被点燃的业火祭坛，且从第一秒开始，火种将开始从被点燃的业火祭坛向可以蔓延且未被点燃的业火祭坛蔓延。

当祭坛被点燃后，则会瞬间激活，和与之有路的祭坛连接业火圣壁。

当存在一片由业火圣壁构成的封闭图形时，则业火监狱生成成功。

### 简化题意
给出一个 $n$ 个点，$m$ 条边的无向图，每一个点有一个标记，初始有 $k$ 个点的标记为 `1`（将给出这 $k$ 个点的编号），其余的点标记为 `0`。

每一秒，对于每个标记为 `1` 的点，与它**有边相连**的点的标记都会变成 `1`。

求最少需要多少秒，图中标记为 `1` 的点与其相邻的边可以构成一个简单环。

**换言之，求最少多少秒后存在一个由 `1` 构成的集合形成简单环。**
## 输入格式

第一行三个正整数：$n,m,k$；

下面 $m$ 行，每行两个正整数：$x,y$（第 $x$ 座业火祭坛与第 $y$ 座业火祭坛有业火之路连接）；

最后一行 $k$ 个正整数：已被点燃（拥有火种）的祭坛编号。
## 输出格式

若可以逃离，输出 D 还有多少时间。

反之若无法生成业火监狱，输出 ``` Poor D! ```。

## 样例

### 样例输入 #1
```
3 3 1
1 2
2 3
3 1
1

```
### 样例输出 #1
```
1

```
### 样例输入 #2
```
5 4 2
1 2
2 3
3 4
2 5
1 5

```
### 样例输出 #2
```
Poor D!

```
### 样例输入 #3
```
15 15 2
2 1
2 3
2 9
5 9
4 5
5 7
6 7
7 8
7 11
11 10
10 9
10 14
14 15
11 12
12 13
4 15

```
### 样例输出 #3
```
3

```
## 提示

### 样例解释

#### 样例1解释

当时间到第一秒时，祭坛 $1$ 的火焰将蔓延到祭坛 $2$ 和 $3$，此时已经构成一个封闭图形了，故答案为 $1$。

#### 样例2解释

可以证明到此时是无法产生简单环的。

### 数据规模

| Subtask | $n\leq$ | $m\leq$ | $k\leq$ | 分值 |
| :----------: | :----------: | :----------: | :----------: | :----------: |
| $0$ | $10^6$ | $n-1$ | $10^4$ | $5$ |
| $1$ | $10^6$ | $2\times10^6$ | $1$ | $10$|
| $2$ | $10$ | $45$ | $1$ | $5$ |
| $3$ | $200$ | $500$ | $10$ | $10$ |
| $4$| $2\times 10^3$ | $5\times 10^3$ | $50$ | $10$ |
| $5$ | $5\times10^5$ | $6\times10^5$ | $500$ | $30$ |
| $6$ | $10^6$ | $2\times10^6$ | $10^4$ | $30$ |

### 保证与约定

保证数据无重边和自环；

保证数据给定的图是一张无向连通图。

### 帮助

输入量较大，建议使用较为快速的读入方式。


---

---
title: "【模板】点双连通分量"
layout: "post"
diff: 普及+/提高
pid: P8435
tag: ['图论', 'Special Judge', '连通块', 'Tarjan']
---
# 【模板】点双连通分量
## 题目描述

对于一个 $n$ 个节点 $m$ 条无向边的图，请输出其点双连通分量的个数，并且输出每个点双连通分量。
## 输入格式

第一行，两个整数 $n$ 和 $m$。

接下来 $m$ 行，每行两个整数 $u, v$，表示一条无向边。
## 输出格式

第一行一个整数 $x$ 表示点双连通分量的个数。

接下来的 $x$ 行，每行第一个数 $a$ 表示该分量结点个数，然后 $a$ 个数，描述一个点双连通分量。

你可以以任意顺序输出点双连通分量与点双连通分量内的结点。
## 样例

### 样例输入 #1
```
5 8
1 3
2 4
4 3
1 2
4 5
5 1
2 4
1 1
```
### 样例输出 #1
```
1
5 1 2 3 4 5
```
### 样例输入 #2
```
5 3
1 2
2 3
1 3
```
### 样例输出 #2
```
3
1 4
1 5
3 1 2 3
```
### 样例输入 #3
```
6 5
1 3
2 4
1 2
4 6
2 3
```
### 样例输出 #3
```
4
2 6 4
2 4 2
3 3 2 1
1 5
```
### 样例输入 #4
```
7 8
1 3
2 4
3 5
2 5
6 4
2 5
6 3
2 7
```
### 样例输出 #4
```
3
2 7 2
5 5 2 4 6 3
2 3 1
```
### 样例输入 #5
```
1 1
1 1
```
### 样例输出 #5
```
1
1 1
```
## 提示

**样例四解释：**

![](https://cdn.luogu.com.cn/upload/image_hosting/huvwgbuo.png)

相同颜色的点为同一个分量里的结点。

**温馨提示：请认真考虑孤立点与自环（样例五）的情况。**

------------
**数据范围：**
对于 $100\%$ 的数据，$1 \le n \le 5 \times10 ^5$，$1 \le m \le 2 \times 10^6$。

| subtask | $n$ | $m$ | 分值 |
| :----------: | :----------: | :----------: | :----------: |
| $1$ | $1 \le n \le 100$ | $1 \le m \le 500$ | $25$ |
| $2$ | $1 \le n \le 5000$ | $1 \le m \le 5 \times 10^4$ | $25$ |
| $3$ | $1 \le n \le 2\times 10^5$ | $1 \le m \le 5\times 10^5$ | $25$ |
| $4$ | $1 \le n \le 5 \times10 ^5$ | $1 \le m \le 2 \times 10^6$ | $25$ |

本题不卡常，时间限制与空间限制均已开大，正确的解法均可通过。

------------

### 数据更新
- $2022/7/14$ 加强数据
- $2022/11/26$  新增 $10$ 组较小的数据（$1\le n, m \le 10$)，方便选手调试。
- $2022/12/31$ 重组 $subtask$，并加入若干组极端数据。
- $2023/1/1$ 发现昨天新加入的数据出了问题，已修改。
------------

惊喜：AC 后记得把鼠标放到测试点上看反馈信息，有惊喜哦。


---

---
title: "【模板】边双连通分量"
layout: "post"
diff: 普及+/提高
pid: P8436
tag: ['图论', 'Special Judge', '连通块', 'Tarjan']
---
# 【模板】边双连通分量
## 题目描述

对于一个 $n$ 个节点 $m$ 条无向边的图，请输出其边双连通分量的个数，并且输出每个边双连通分量。
## 输入格式

第一行，两个整数 $n$ 和 $m$。

接下来 $m$ 行，每行两个整数 $u, v$，表示一条无向边。

**不保证图为简单图，图中可能有重边和自环。**
## 输出格式

第一行一个整数 $x$ 表示边双连通分量的个数。

接下来的 $x$ 行，每行第一个数 $a$ 表示该分量结点个数，然后 $a$ 个数，描述一个边双连通分量。

你可以以任意顺序输出边双连通分量与边双连通分量内的结点。
## 样例

### 样例输入 #1
```
5 8
1 3
2 4
4 3
1 2
4 5
5 1
2 4
1 1
```
### 样例输出 #1
```
1
5 1 5 4 2 3
```
### 样例输入 #2
```
5 3
1 2
2 3
1 3
```
### 样例输出 #2
```
3
3 1 3 2
1 4
1 5
```
### 样例输入 #3
```
6 5
1 3
2 4
1 2
4 6
2 3
```
### 样例输出 #3
```
4
3 1 2 3
1 4
1 5
1 6
```
### 样例输入 #4
```
7 8
1 3
2 4
3 5
2 5
6 4
2 5
6 3
2 7
```
### 样例输出 #4
```
3
1 1
5 2 5 3 6 4
1 7
```
## 提示

**样例四解释：**

![](https://cdn.luogu.com.cn/upload/image_hosting/0bzdfzeq.png)

相同颜色的点为同一个连通分量。


------------

**数据范围：**
对于 $100\%$ 的数据，$1 \le n \le 5 \times10 ^5$，$1 \le m \le 2 \times 10^6$。

| subtask | $n$ | $m$ | 分值 |
| :----------: | :----------: | :----------: | :----------: |
| $1$ | $1 \le n \le 100$ | $1 \le m \le 500$ | $25$ |
| $2$ | $1 \le n \le 5000$ | $1 \le m \le 5 \times 10^4$ | $25$ |
| $3$ | $1 \le n \le 2\times 10^5$ | $1 \le m \le 5\times 10^5$ | $25$ |
| $4$ | $1 \le n \le 5 \times10 ^5$ | $1 \le m \le 2 \times 10^6$ | $25$ |

### 数据更新
- $2022/7/14$ 加强数据
- $2022/11/26$  新增 $10$ 组较小的数据（$1\le n, m \le 10$)，方便选手调试。
- $2022/12/31$ 重组 $subtask$，并加入若干组极端数据。
- $2023/1/1$ 发现昨天新加入的数据数据出了问题，已修改。
------------

本题不卡常，时间限制与空间限制均已开大，正确的解法均可通过。


------------

惊喜：AC 后记得把鼠标放到测试点上看反馈信息，有惊喜哦。


---

---
title: "[NAPC-#1] Stage3 - Jump Refreshers"
layout: "post"
diff: 普及+/提高
pid: P9431
tag: ['O2优化', '强连通分量', 'Tarjan']
---
# [NAPC-#1] Stage3 - Jump Refreshers
## 题目背景

> ![](https://cdn.luogu.com.cn/upload/image_hosting/wkktxonu.png)
## 题目描述

**注意本题中 kid 的移动方式与 iw 游戏中不同（）。**

kid 面前有一个无穷大的竖直二维平面。坐标系 $x$ 轴正方向为从左到右，$y$ 轴正方向为从下到上。

地图（该平面）内有 $n$ 个**位置互不相同**的**可以无限重复使用**的跳跃球。当 kid 正好位于某跳跃球位置时，他可以让 shift 键按下，然后他会瞬间上升 $d$ 格（此期间不能左右移动）。他每秒往下坠落 $1$ 格，同时每秒 kid 可以选择：向左或向右移动 1 格，或者不移动。当 kid 不在跳跃球上时他不能起跳。

![](https://cdn.luogu.com.cn/upload/image_hosting/1abzjhjs.png)

上图是一个例子，蓝色区域表示 kid 在跳跃球（箭头）处起跳（$d=2$）后可以达到的区域。**kid 每秒时的横纵坐标只能是整数，即：我们认为他不能达到非整点位置。**

现在，kid 把存档放在了第 $c$ 个跳跃球处（即起点是第 $c$ 个跳跃球处；此时可以立即起跳）。定义 kid 的得分为他经过（即在某处起跳：显然起跳之后可以回到原位置）的**不同**跳跃球的个数。kid 想知道他可以最多获得多少得分（**不需要**（但可以）**回到起点**），请你告诉他吧。

再次提醒：**跳跃球可以无限重复使用，即 kid 可以在某个跳跃球上无限起跳。**
## 输入格式

**本题单测试点内有多组数据。**

第一行仅两个整数 $T,id$ 表示测试数据的数量和测试点编号。特别地，样例的 $id=0$。

对于每组测试数据：

第一行三个正整数 $n,d,c$ 含义如上所述。

后 $n$ 行每行两个正整数 $x_i,y_i$ 表示第 $i$ 个跳跃球的位置。
## 输出格式

对于每组测试数据输出一行一个正整数表示最大得分。
## 样例

### 样例输入 #1
```
4 0
4 2 1
2 4
1 1
5 2
4 1
5 3 4
1 7
2 4
3 2
4 5
8 2
4 1 2
1 1
1 2
1 3
4 1
4 2 1
1 1
4 1
1 4
4 4
```
### 样例输出 #1
```
3
4
4
1
```
## 提示

### 【数据范围】

**本题采用捆绑测试。**
$$
\def\r{\cr\hline}
\def\None{\text{None}}
\def\arraystretch{1.5}
\begin{array}{c|c|c|c}
\textbf{Subtask} & id= & \textbf{Sp. Constraints} & \textbf{Score}\r
\textsf1& 1\sim3,36 & n\leqslant10,T\leqslant10 & 10 \r
\textsf2& 4\sim7 & \sum n\leqslant200 & 15 \r
\textsf3& 8\sim13 & \mathbf A & 25 \r
\textsf4& 14\sim18 & \mathbf B & 10 \r
\textsf5& 19\sim35 & - & 40 \r
\end{array}
$$
其中 $\sum n$ 表示单测试点内所有 $n$ 的总和。

$id=1\sim3,36$ 表示 $id\in\{1,2,3,36\}$。
- 特殊性质 $\mathbf A$：保证对于任意不同跳跃球 $u,v$，如果 kid 理论上能从 $u$ 跳到 $v$（理论上：不考虑 kid 能否从起点到达 $u$ 的问题，下同），那么他理论上**一定不可以**从 $v$ 跳到 $u$。
- 特殊性质 $\mathbf B$：保证对于任意跳跃球 $u,v$，如果 kid 理论上能从 $u$ 跳到 $v$，那么他理论上**一定可以**从 $v$ 跳到 $u$。

注意上面的“从 $u$ 跳到 $v$"不一定非得一跳到位。比如样例 #1-2 中可以从第 $3$ 个跳到第 $5$ 个：$3\to2\to4\to5$。

对于 $100\%$ 的数据，$1\leqslant T\leqslant 1000$，$1\leqslant n\leqslant 3000$，$\sum n\leqslant 3000$，$1\leqslant d\leqslant 10^9$，$1\leqslant c\leqslant n$，$1\leqslant x_i,y_i\leqslant10^6$，$(x_i,y_i)$ 互不相同。

---
#### 【样例解释 #1-1】
![](https://cdn.luogu.com.cn/upload/image_hosting/zpc7sm2i.png)

$d=2$，容易发现离开初始位置就上不去了。所以 kid 要么往左边碰第 $2$ 个跳跃球，得分为 $2$；要么往右边跳，经过第 $3$ 和第 $4$ 个跳跃球，得分为 $3$。
#### 【样例解释 #1-2】
![](https://cdn.luogu.com.cn/upload/image_hosting/q8ks8qb4.png)

$d=3$，kid 可以先往下走一圈（$4\to3\to2\to4$）跳回起点，然后往右去碰第 $5$ 个球。左上角的第 $1$ 个跳跃球是碰不到的。
#### 【样例解释 #1-3】
![](https://cdn.luogu.com.cn/upload/image_hosting/akghkpe9.png)

通过最上面那个球是可以跳到右边的。
#### 【样例解释 #1-4】
![](https://cdn.luogu.com.cn/upload/image_hosting/50smzomm.png)

有 的 人 。


---

